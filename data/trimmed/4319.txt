Page1一种基于冲突的增量诊断方法王晓宇欧阳丹彤赵剑(吉林大学计算机科学与技术学院长春130012)(符号计算与知识工程教育部重点实验室长春130012)摘要增量诊断是一种在离散事件系统中进行诊断的重要方法,因其能够根据新观测和原有诊断的结果进行进一步诊断,在长时间复杂行为的系统上有着良好的运行效率和诊断特性.文章提出了一种带有回溯的增量诊断方法.在离线定义的自动机链模型上根据在线观测进行局部诊断,用轨迹概率选出最可能诊断的同时,保存可行的候选诊断作为回溯点.若增量过程产生冲突,则回溯并根据新观测动态重新对候选诊断选择排序.既避免了不完全可诊断性条件下,增量诊断所面临的多候选选择,亦避免了由于仅保留最优结果导致的重复诊断.关键词基于模型诊断;动态诊断;增量方法;自动机链;基于冲突1引言故障诊断是现代航空航天业、车辆工业及大型Page2部分的一致性[5],从而得出是否存在故障的结论,如果故障存在,则给出故障的原因[6].基于模型的诊断根据系统的行为建立模型[7-8],随着系统的不断更新,功能的不断增强,与之对应的模型规模也随之急剧扩大,导致基于模型诊断方法在建模、模型修改以及实时监测同步等方面的难度不断增加.为了降低诊断的难度,各研究机构及学者在降低系统规模、增强诊断效率上提出了多种方法,如分层诊断[1,9]、分布式诊断[3,10]等.分层诊断的优点在于将诊断空间缩小到某一层次的抽象范围内,缩小了诊断空间[11].分布式系统诊断则将这种诊断空间降低到子系统规模甚至部件规模.而二者的缺点在于每次在线得到观测序列之后均需要从初始状态开始离线计算诊断,多数时间在扩展冗余的转移函数,这种冗余是不必要且可以消除的.增量诊断可以解决由于每次从初始状态开始同步带来的诊断时间和空间的浪费,在由观测窗口覆盖的系统模型上[12-13],保留当前诊断结果,当新的观测窗口到来时,诊断由前一次的诊断结果和当前的新观测序列共同推理得出[14].因此将诊断空间限制在每个观测窗口覆盖的系统模型范围内,有效地缩减诊断空间[15].增量方法的诊断时间和空间依赖于系统的可诊断性.若系统的可诊断性较低,产生的候选诊断会随之增加.在多个候选诊断结果情况下,增量计算的时间与空间将以指数级增加,最坏将成为全局诊断.因此产生了对候选诊断的选择问题和增量可诊断性问题.文献[15-16]建立了良好的增量诊断模型:自动机链.在自动机链模型上,各自动机模型的边界是严格定义的,令观测窗口很容易被对应,用以根据当前的观测窗口在自动机链中的某一特定自动机上进行诊断.观测窗口是系统短期内的观测序列,更接近连续系统诊断.而窗口长度逐渐趋近于单一事件时,离散事件系统中的诊断可以逐渐趋近于连续系统.文献[17]在自动机链模型的基础上,以诊断结果的完备性为代价取得了进一步的时间优化.虽然诊断结果不完备,甚至有可能丢失诊断解,但是在诊断时间上有数量级幅度的降低.通过文中实验可知,当到达较多的观测窗口时,诊断解丢失的情况也会随之减少.并且,根据文献[18-19]中提出的方法和性质,在观测窗口足够长时,观测的及时序的正确性能够被保证.本文在自动机链模型基础上用增量方法进行诊断,通过保留候选诊断的方法确保诊断的完备性.并且定义轨迹概率对候选诊断进行排序,在诊断时间上与文献[17]的量级接近,同时克服了以诊断完备性作为代价带来的问题.本文第2节将详细介绍增量诊断的模型基础框架;第3节提出在自动机链模型上的增量诊断方法;第4节给出关于窗口长度、诊断完备性及诊断时间的一系列定理并加以证明;第5节将给出实验结果及分析.2增量诊断方法模型框架2.1问题描述机进行描述.离散事件系统的基于模型诊断中,模型用自动定义1.自动机[3].自动机定义为一个五元组:A=(S,E,T,I,F).其中S是状态集合;E是事件集合;T是转移集合,以笛卡尔乘积表示:TS×E×S;I是初始状态集合,IS;F是终止状态集合,FS.自动机的定义比较广泛,既可以应用于整体系统的建模,也可以用于子系统模型的建立,甚至可以详细至部件层对某部件建立模型.每个部件模型与其它部件模型的自动机定义需要有严格的区分,但是部件模型事件集合之间和状态集合的交集未必为空,以便于部件交互定义接口.如图1是两个部件的自动机模型,组成一个简单的自动机链,状态集合交集不为空.自动机A1的终止状态与自动机A2的初始状态相同.为了严格定义这种边界状态相同的自动机,在增量诊断中对增量结果做出区分,给出轨迹和自动机链的定义.定义2.轨迹[15].自动机A中若存在状态和Page3事件序列q=〈s0,e1,s1,e2…em,sm〉.且si∈S,ei∈E,〈si-1,ei,si〉∈T.称q为s0到sm的一条轨迹.轨迹是在自动机内从初始状态到某一状态的事件触发序列.状态改变由事件驱动,每个事件发生的时候会改变状态,因此轨迹记录的是事件发生的顺序和经由的状态.定义3.自动机链[15].设有一组自动机,A1,A2,…,An,i∈[1,n],Ai=(Si,Ei,Ti,Ii,Fi).如果该组自动机符合如下规则:(1)i,j∈[1,n],Ei=Ej;(2)i,j∈[1,n],j>i,s∈Si∩Sjs∈Fi∧s∈Ii+1;(3)i,j∈[1,n],s,s,若{s,s}Si∩Sj,且q是Ai中从s到s的轨迹,则q一定是Aj中从s到s的轨迹.在自动机链的模型结构下,增量诊断可以在观测窗口到达时,在自动机链中相应的自动机上进行诊断[20],而不是全局诊断.而得到的诊断结果就可以作为下次诊断的初始状态,当有新的观测窗口到达时,以该初始状态为开端,在自动机链中的下一个自动机中进行诊断.故称用前次诊断结果和本次观测窗口的诊断方法为增量诊断.增量诊断的诊断空间一般较小,是系统的一个观测窗口所能覆盖的范围.以图1为例:当观测窗口〈o2o4〉到达时,诊断提取出一条轨迹:〈s0o2s2e2s5o4s7〉为本次的诊断结果,终止状态s7可以作为下一次诊断的初始状态.观测窗口〈o5o8〉随后到达时,可以从状态s7开始,继续诊断,得到轨迹〈s7o5s9e3s13o8s15〉作为本次诊断结果.而当需要一条全局诊断的轨迹时,多次诊断结果可以直接拼接成为一条全局的轨迹〈s0o2s2e2s5o4s7o5s9e3s13o8s15〉作为总体的诊断结果.但是在增量诊断中常会存在如下的一个问题:当有观测窗口〈o1o3〉时,诊断将提取出两条候选轨迹〈s0o1s1e1s4o3s7〉和〈s0o1s1f1s3o3s6〉.当没有领域知识或更多传感器来进行探测时,这两条轨迹均是候选诊断结果.当观测到〈o6〉时,允许观测事件缺失时,将会提取出4条轨迹.若模型的可诊断性更低时,也就是说,存在更多有相同观测窗口的轨迹时,这个结果会以指数级增长得更快.文献[17]提出了候选诊断的选择方法,当有多个候选诊断时,选取其中的一个作为唯一的诊断结果,在这个结果上进行增量的诊断,用以保证增量是线性地进行而非指数级.虽然这种诊断是不完备的,但是实验结果可以表明,当观测窗口累加到一定程度时,与前面错误的候选诊断的选择会产生不一致.如图1,当产生两个候选诊断,选择〈s0o1f1s3o3s6〉作为候选诊断,增量窗口是〈o5o8〉时,就会产生不一致.本文在上述工作的基础上,提出了一种基于冲突的诊断方法.用轨迹概率来确定增量诊断过程中每次增量计算的“最可能状态”,在新观测窗口到来时判定冲突并进行增量诊断轨迹提取,相对于含有多条诊断轨迹和多个可能终止状态的增量诊断方法,降低了诊断的时间复杂度.同时保留其余可能终止状态,避免推导错误产生完全回溯带来的高时间及高空间复杂度.在回溯过程中根据当前新观测序列带来的信息,用后验概率方法重新调整诊断轨迹,修改部分“最可能状态”.该方法避免了单纯自动机链诊断时多诊断轨迹和终止状态带来的指数级空间和时间消耗,改进了回溯时在整个状态空间中重新寻找诊断的方法.同时消除了时间窗口对诊断结果完备性的影响,使诊断结果完备.2.2模型定义在自动机链的基本定义上,为了计算诊断冲突,并选择诊断结果,在自动机模型上加入概率信息,因此引入了概率自动机的定义.定义4.概率自动机.定义概率自动机是一个六元组AP=(S,E,P,T,I,F).其中P是事件概率,P={P(e)|e∈E}∪{P(e|e)|e,e∈E∧π(e)=e}.其中π(e)是e在自动机模型中的前驱事件.其余集合定义与定义1相同.定义5.观测窗口.定义Wi=〈o0,o1,…,on〉为一个观测窗口,且oi∈Wi,oi∈E.即所有在一个观测窗口中的可观测事件,限制在一个自动机范围内.当然,在实际的自动机模型中,观测窗口未必恰好包含模型中的自动机.为了化简问题,假设观测窗口与模型自动机中包含的可观测事件是等长的.定义6.相容轨迹.若自动机Ai是自动机链中的一个自动机.若存在轨迹σ=〈s0,e1,s1,e2…em,sm〉,其中s0∈Ii,sj∈Si.若事件序列〈ej,ej+k,ej+k+m,…〉是轨迹σ中存在的有序事件,并且与观测窗口Wt中的观测事件相同且顺序一致.则称σ为一条相容轨迹.定义7.故障轨迹.相容轨迹σi=〈s0,e1,s1,e2…em,sm〉,若ei∈σi,且ei为故障事件,则称σi为一条故障轨迹.若出现多条相容轨迹,如例1中观测到〈o1o3〉Page4时,需要对轨迹进行选择.选择一条轨迹作为本次诊断结果,其余的仅作为候选诊断保留,而不在下一个自动机中扩展.相容轨迹的数目与模型的可诊断性有关,在后面将给予证明.接下来给出选择轨迹的依据.定义8.轨迹概率.若有一条与观测窗口相容的轨迹σ=〈s0,e1,s1,e2…em,sm〉,所有事件的联合分布定义为该轨迹的概率.定义9.优先队列.若自动机Ai在观测窗口Wi下存在多条诊断轨迹,若不存在预定义中的致命故障,则选择轨迹概率最大的诊断轨迹作为优先队列;若存在预定义中的致命故障,则选择含有致命故障的队列.优先队列记作PTraji.其余的诊断轨迹称为保留队列RTraji在一个合适大小的自动机链中,诊断将以较高效率运行.定义10.冲突.自动机Ai和Ai+1是自动机链中两个相邻的自动机,Wi是Ai上的观测窗口,Wi+1是Ai+1中的观测窗口,若Wi+1中由s∈Ii+1所能触发的观测事件o与Ai中根据Wi保留的优先队列PTraji中终止状态在Ai+1的触发事件e存在如下的概率关系:P(oe)=P(o)P(e).则称产生了一个冲突,记作Conf(o,e).直观上看,冲突是指Ai的诊断结果的终止状态在Ai+1中不能得到解释.如果初始状态s在模型中没有触发任何一个观测事件,则触发s的全部转移函数,直到存在观测事件能够判断冲突为止.在图1中,设W1=〈o1o3〉,W2=〈o5o8〉,PTraj1=〈s0o1s1f1s3o3s6〉.s6在A2中能够触发的事件为o6,显然,o5与o6独立,产生了冲突Conf(o5,o6).若初始状态没有触发观测事件,如图1所示中,若A2中的s6能够触发的事件不是o6,而是一个不可观测的事件,则将扩展全部s6的转移函数,直到与扩展的轨迹中的o7或者o9产生冲突为止.定义11.证实.若观测窗口Wi+1与Ai中得到的优先队列无冲突,则称Wi+1是诊断Diai的证实.定义12.回溯.若观测窗口Wi+1与Wi中得到的优先队列存在冲突,则需要根据WiWi+1和保留队列RTraji通过计算冲突选取新的优先队列,称该过程为回溯.通过上述例子可以扩展到自动机的静态建模和动态观测相容判断的过程中去,当自动机Ai的轨迹存在不确定性,是可以通过观测窗口Wi+1与自动机链的冲突计算来消除的.证实也可以通过自动机链中相邻两自动机之间的边界状态所能够触发的事件与观测之间的冲突来判断是否正确选择了轨迹.在诊断过程中,若不存在证实,根据新的观测窗口可以在对前一自动机诊断过程中所取得的保留队列来进行回溯,这个回溯过程可以根据当前的观测窗口对每个保留队列进行冲突运算,根据该观测窗口与上一个自动机的冲突计算,可以选出新的优先队列,并且更新保留的回溯点.自动机模型的链状结构是一个合理大小并有严格边界定义的自动机组,称为自动机链.自动机链中自动机的规模等于观测窗口所覆盖的事件序列规模.即观测窗口必须只在自动机链中某个自动机中运行,而不能超过这个自动机(边界状态除外).当诊断的观测窗口较小时,每次增量诊断过程产生与观测相容的不确定性轨迹数量会随之增加.尽管这种诊断轨迹会随着观测序列的不断增加而最终趋于唯一.但是若考虑全部的不确定性轨迹,诊断空间和诊断时间的复杂度就会呈指数级增加.若仅考虑唯一“最可能”的轨迹,在增量诊断中产生观测与模型不相容时,需要从初始状态开始,与全部观测窗口进行同步运算,最坏情况将在时间与空间上退回到全局诊断.本文提出一种回溯点的方法,保存所有可能的轨迹并按照轨迹概率排序,用于解决完全回溯导致的全局诊断问题.而基于冲突的方法能够在增量观测与模型不相容时,结合回溯点,动态重新选择轨迹,回溯效率较高.图2给出的是本文提出的增量诊断方法的基本框架.自动机链与观测窗口之间是被假设成严格对应的.这种假设存在着一定的局限性.人为定义的自动机链模型上与动态出现的观测窗口同步,在时序混乱的系统中可能会出现无法对应的情况,这点可以通过对全局模型的动态模型重构来解决.而一般情况下,确定运行的系统,可以遵照模型边界来确定观测窗口与自动机的逻辑和时序对应关系,即使存在Page5着环路的边界状态,在有限的时间内也可以通过回溯来解决.自动机链将全局模型与观测窗口的同步降低到局部空间上,建立在自动机链上的增量诊断方法的诊断时间和空间随之降低到局部时间和空间;增量诊断可以仅根据前一个诊断结果和当前观测进行局部诊断,无需全局信息,独立性较高;在增量方法上加入多候选轨迹的排序方法,可以对部件多故障进行处理,并选择最高风险故障;而带有回溯的基于冲突方法,可以消除多候选轨迹的冗余诊断,精确刻画诊断轨迹.3诊断方法3.1诊断算法在离线建立的自动机链模型基础上,在线的系统传感器会动态传回一系列的事件序列.假设传感器事件顺序正常,即每一个到达诊断器的观测事件按照实际发生的顺序来进行.第一个观测窗口到达时,诊断从自动机链的第一个自动机的初始状态开始.根据时序和转移函数,对自动机和观测窗口进行对应.每次在线诊断结束,保留本次结果,当新的观测窗口到来时,以上次诊断结果作为本次诊断的初始状态,开始本次的诊断:找出与观测轨迹相容的全部轨迹,并保存唯一的相容轨迹和轨迹的终止状态作为回溯点.以上是基本的诊断过程.若当前的诊断出现多条轨迹,验证当前是否有致命的故障,若存在致命故障,选择该轨迹并且发出警报.若没有致命性故障,则需要计算轨迹概率,选择联合分布最高的一条轨迹,作为本次的优先队列,将该队列的终止状态作为回溯点其余保存为候选队列,与当前的自动机链一并保存.当出现了诊断冲突,诊断需要进行回溯.设当前自动机为Ai,则回溯到Ai-1的终止状态.若该回溯点没有保留队列,回溯到Ai-2,依此类推,直到回溯到一个有保留队列的回溯点Ai-k为止.此时,观测窗口已经叠加到Ai,当前的观测序列携带更多事件序列的信息,因此在Ai-k上可以重新计算概率分布,得出一个新的、与当前观测窗口没有冲突的诊断结果.接下来给出算法.算法1.增量诊断.输入:自动机链Ai输入:观测窗口Wi1.Ω=2.Obs=3.WhileWi≠4.IfConflict(Ω,Wi)5.Obs=ObsWi6.BackTrack(Obs,Ω)7.Endif8.IfNon-Conflict(Ω,Wi)9.Ω=Dia(Ai,Wi)10.IfΩ=Single(Ai,Wi)11.Ω=ΩΩ12.Pointi=FinalState(Ω)13.Endif14.IfΩ=Muti(Ai,Wi)15.Ω0=List(Ω)16.Ω=ΩPre(Ω)17.Pointi=FinalState(Pre(Ω))18.Endif19.Endif20.Endwhile21.ReturnΩ在图1中,按照算法1,当观测窗口得到事件序列〈o1o3〉时,返回相容的候选轨迹σ1=〈s0o1s1e1s4o3s7〉和σ2=〈s0o1s1f1s3o3s6〉.若通过计算,得到概率分布P(σ1)=P(o1e1o3)=0.6324,P(σ2)=P(o1f1o3)=0.00648.且故障f1不是致命故障.则算法选择轨迹σ1作为优先队列,回溯点保留为s7,σ1作为优先队列,σ2作为保留队列.接下来观测窗口观测到〈o6o7〉,此时与s7产生冲突,产生一个回溯.当前观测窗口合成为〈o1o3o6o7〉,则在自动机A1和A2中,找到相容轨迹〈s0o1s1f1s3o3s6o6s8e6s11o7s14〉.同时将优先队列更新为σ2=〈s0o1f1s3o3s6〉和〈s6o6s8e6s11o7s14〉.回溯点更新为s6和s14.3.2概率分布的计算有限状态自动机转换成概率自动机后,较原有自动机模型中添加了事件的先验概率和事件之间的后验概率信息,增强了模型的表达能力.当在线系统产生了一个观测窗口,其中包含的事件序列必定与当前自动机链中的某一条轨迹相容,而系统的运行是由事件来驱动的.事件序列之间有时序的约束.在事件上附加的概率信息加强了时序的约束关联.若ei,ej∈E.ti,tj∈T.si,sj,sk∈S,ti=sie→jsk,则eiej之间存在相互的影响.即当观测tj=sj到事件ei时,发生ej的概率会比ej的先验概率高,而ej的出现证实了ei的出现.因此在概率自动机中,将这种事件概率明确定义并添加到每个事件中,用于Page6指导搜索的方向以及轨迹选择.一条轨迹出现的概率是由该轨迹上事件的联合分布来构成的.若存在概率自动机中的某条轨迹〈s0e0s1e1…siei…sn〉,则联合分布P(e0e1…ei…en)=P(e0)P(e1|e0)P(e2|e1)…P(ei+1|ei)…P(en|en-1).可以得到该轨迹出现的概率.后验概率P(ei|ei-1)1,则该轨迹越长,求出的后验概率越小,在候选诊断中选择出作为优先队列的可能就越小.在实际的系统情况下,可以理解为当系统行为越复杂,越不会常用.3.3概率分布的简化自动机模型根据相应的概率,可以将自动机的多个元组理解成为由事件驱动的系统,而这些事件相互之间的后验概率联系,将可以化简为仅含有事件及其概率的模型.定义13.简化概率自动机模型.定义简化的概率自动机模型为一个四元组Spa=(Se,Sr,Sp,E0).其中Se是事件集合;Sr是关系集合,SrSe×Se;Sp是事件的概率集合;E0是源事件集合,e∈E0,在Sr中不存在关系r(e,e).当Se中任意两个事件ei、ej存在直接的顺序关系时,在Sr中存在着一个二元关系r(ei,ej),且Sr中存在自反关系,即允许模型中存在环;在Sp中有每个事件存在先验概率P(ei),若Sr中存在二元关系r(ei,ej),则在Sp中存在亦存在二者的后验概率P(ej|ei).为了表示二元关系r与事件之间的关系,便于将事件关系映射到轨迹中去.定义函数(ψ(r(ei,ej))=eiej)∨(ψ(r(ei,ei))=ei).简化的概率自动机模型中,状态被忽略,仅集中考虑事件之间的关系.在已有的事件关系上,考虑观测到的事件序列是否可以被该自动机所接受.自动机元组中概率信息加速了判定接受与否的效率.最关键的是,运算时比较简捷.图3给出的是图1中自动机例中自动机A1的简化概率自动机模型.事件用节点表示,关系用箭头表示.在简化的概率自动机模型上,能够更清楚地表示事件之间的联系.图中可以明确地看到3条轨迹.在诊断过程中,事件关系和概率关系共同作用于诊断轨迹的查找中.在简化自动机模型中,根据观测窗口,可以按照如下方法计算.算法2.基于简化概率自动机的诊断过程.输入:简化概率自动机Spa=(Se,Sr,Sp,E0),观测窗口1.Initial:E=E0,Traj=2.Foreveryoi∈Obs3.Ifei∈E,r(ei|oi)∈Sr4.Distinguishei5.Traj=Trajψ(ei,oi)6.deleteeiinE,deleteoiinObs7.Else8.addejtoE,ejeir(ei,ej)∈Sr9.goto310.IfSingle(Traj)11.ReturnTraj12.Else13.computeP(traji)=P(e1e2…ek),ei∈traj,14.Returnlist(P(traji))当观测窗口到达时,对于当前的观测事件,找到与之直接相关的事件,或者是自反关系,或者是顺序关系.如果不存在直接的关系r,扩展当前事件的关联事件,直到找到相关的事件为止.在诊断过程中,常常出现多条轨迹,所以在加入事件之前需要进行区分.Distinguish将ei区分并添加到不同轨迹中的事件序列,在多诊断结果之间做出划分.当多诊断结果存在时,计算事件的联合分布,形成候选诊断的优先轨迹.最后返回单轨迹或基于联合分布概率的排序轨迹.离散事件系统由事件驱动,简化的概率自动机模型明确了各驱动事件之间的关系.消除了由于隐含给出事件之间驱动关系所引起的在不完备因果条件下的诊断虚警和不完备诊断结果.简化的概率自动机模型将事件之间隐含关系进行显式表达,使事件驱动的系统自动机表达能力得到增强.4相关定理及证明定理1.在无环的有限状态自动机上,若不存在观测事件序列完全相同的轨迹,当观测序列足够长时,能够唯一确定一条诊断轨迹.证明.设无环有限状态机为一个五元组A=Page7是正确且完备的.(S,E,T,I,F),i,j,Obs(traji)≠Obs(trajj),i≠j.假设对同一观测序列存在两条诊断轨迹,记作DiaTraj1和DiaTraj2,DiaTraj1的事件序列为Σ1,DiaTraj2的事件序列为Σ2,定义函数δ,δ(Σi)=〈…ei…〉,ei∈E∩Obs.δ(Σ1)=〈e1e2…ei…〉,δ(Σ2)=〈e1e2e3〉.根据前提,δ(Σ1)≠δ(Σ2).而DiaTraj1与DiaTraj2由同一观测窗口得出,δ(Σ1)=δ(Σ2),导出矛盾,原假设(两条诊断轨迹不存在)是不成立的,因此针对同一观测序列不能存在两条诊断轨迹.证毕定理2.当观测序列及模型确定时,增量方法证明.首先证明正确性.设全局诊断为状态-事件序列SE,观测窗口为Obs.设在增量过程中的局部诊断结果为SiEi,SE是SiEi的简单连接.且根据定理1,当观测窗口足够长时,每一个局部诊断结果是唯一的.因此若局部诊断唯一且正确,全局诊断的正确性也可以保证.即SiEiSE,当所有组成SE的SiEi正确时,SE是正确的.往证局部诊断结果是正确的:诊断是与在线的观测序列相容的模型事件序列,当SiEi是由诊断器选出的与观测序列相容的事件-状态序列.δ(SiEi)=Obsi,这保证诊断器选出的每个SiEi都是正确的,因此SE是正确的.下面证明在观测序列及模型确定下,增量方法是完备的:有自动机模型A=(S,E,T,I,F),观测序列Obs=〈…oi…〉,oi∈Obs,oi∈E.若观测序列确定,则在模型中必存在事件序列traj=〈…ei…〉,δ(traj)=Obs.则traj是与观测相容的事件序列;若存在多个traj,使得δ(traji)=Obs,i=0,1,2,…则诊断结果是这些轨迹集合的子集,根据定理1,当观测序列足够长时,诊断结果唯一,因此增量诊断方法是完备的.模扩大.定理3.模型可诊断度降低导致候选轨迹规定义一条轨迹的观测映射P(traj)=〈o1o2…on〉,oi∈traj.即该轨迹中全部可观测事件的序列.而观测序列的逆映射P-1(Obs)定义为traj(P(traj)=Obs),即在模型定义域上满足该观测的全部轨迹.如果系统是完全可诊断的,P与P-1是一一对应的.当系统不可诊断时,定义|P|列不可诊断的程度,M=在(0,1]上变化,当M趋于1时,可诊断性提高,M趋于0时,可诊断性降低.而在全局系统中,M的平均值可以作为可诊断性的衡量标准,记为珨M.由M的定义可知,1序列来说,|P|=1,则1观测序列相容的轨迹个数,即候选诊断结果个数.在全局系统中,平均候选轨迹个数N=∑|P-1||P|=1时,N=∑|P-1|的个数.珨M=1诊断性的降低,将导致候选轨迹的增加.5实验结果及分析全局结果采用2007年Grastien等人[21]提出的诊断标准测试集合,局部自动机状态规模为6个状态,自动机链由30个局部自动机组成.诊断空间约为630.其中模型是离线的,观测是在线给出的,符合系统实际运行过程的事件序列.采用保留全部诊断结果保证结果完备性,用计算轨迹联合分布的方法来选择一条轨迹,保证效率.截取10个相应的时间点,给出几种方法的诊断时间(以ms计),对比如图4(a)下:其中方法1是完全扩展的方法,方法2是NEDE方法,方法3是本文方法.本文方法与NEDE方法是类似接近的,因此在图4(b)中给出更详细的对比图示.可以看出,在诊断过程中,本文方法和NEDE方法较增量同步的方法时间复杂度更低.而图4(b)中可以看出,除开始的几段自动机链上本文方法需要计算概率而影响了结果给出时间,而在自动机链向后运行的过程中,由于本文方法回溯机制优于NEDE方法,故诊断时间低于NEDE方法.可见,基于冲突的方法在时间上的量级与NEDE方法接近,与完全扩展的方法相比诊断时间有数量级上的改进.在基于冲突的增量方法中,当出现与当前观测序列冲突的诊断结果,则认为当前所选择的轨迹不是正确的诊断轨迹,因此产生了回溯.而NEDE方法在当前观测与轨迹产生冲突时,直接回溯到初始状态.表1对二者的回溯次数、回溯长度及回溯消耗时间给出实验结果.Page8NEDE方法14基于冲突方法14由图4和表1可见,在较小的自动机上独立地进行局部诊断,由于诊断空间较小,诊断消耗时间少.但是全局诊断需要多部件的增量诊断结果,在全局观测窗口下回溯过程、回溯之后的多自动机同步和增量结果拼接上消耗的时间较长.本文方法的空间消耗较NEDE方法高,保留回溯点所消耗的空间与候选诊断的个数有关,但是消耗的空间仅为NEDE方法的线性倍数而非指数倍数.通过实验和定理的证明,可见基于冲突的增量诊断方法在线性倍数增加计算存储空间的代价下,对于诊断得出时间有着数量级上的降低,并且能够保证诊断结果的完备性.
