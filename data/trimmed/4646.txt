Page1面向双层传感网的隐私保护犽-NN查询处理协议彭辉陈红张晓莹曾菊儒吴云乘王珊(中国人民大学数据工程与知识工程教育部重点实验室北京100872)(中国人民大学信息学院北京100872)摘要无线传感器网络作为物联网感知层的核心组成部分,具有广阔的应用前景.然而,隐私泄露问题严重阻碍了传感器网络的发展.目前,传感器网络隐私保护技术已成为研究热点,其中隐私保护k-NN(k-NearestNeighbor)查询协议是富有挑战性的问题.文中提出了面向双层传感器网络的高效的隐私保护k-NN查询协议.首先,为提升查询效率,基于定向存储策略给出了适用于双层传感网的k-NN查询架构.其次,针对管理节点俘获攻击,提出了一种新颖的隐私保护数据编码机制,通过为真实数据附加编码的方式,保证在不泄露数据隐私的同时精确地完成查询处理.再次,针对节点共谋攻击,设计了基于代理节点的单向数据隐藏机制,通过破坏普通节点与管理节点间数据的关联性实现抵御共谋攻击的目标.理论分析和仿真实验验证了协议的安全性和有效性.关键词物联网;无线传感器网络;隐私保护;k-NN查询;节点俘获;共谋攻击1引言无线传感器网络[1](WirelessSensorNetwork,WSN)作为物联网[2]感知层的核心组成部分,在国防军事、医疗卫生、智慧交通、环境监测、智能家居等领域有着广阔的应用前景.传感器网络可以在任何时间、地点和环境下获取大量重要的信息,为人们的科研、工作和生活提供极大的便利.然而,近年来,传感器网络在多个关键性领域的实际应用与部署过程中,也暴露出严重的隐私威胁.例如,在军事领域,传感器网络收集和查询的数据往往携带着重要情报,这些数据一旦泄漏很容易造成重大决策失误;在医疗应用领域,使用便携式无线传感器采集患者实时数据时,容易泄露患者的敏感体征数据;在车载传感网应用中,用户的位置和行动轨迹等隐私信息容易被泄露等.这些在传感器网络查询应用中暴露出的隐私问题会导致用户和监测对象的重要信息泄露,甚至威胁到用户和监测对象的安全,极大地阻碍了传感器网络的应用.研究和解决传感器网络中的隐私保护问题,对传感器网络的大规模应用具有重要意义.目前,无线传感器网络中的隐私保护问题[3]已经成为研究的热点.现有隐私保护技术研究主要面向求和、极值、中位数等数据聚集[4-11]操作以及范围查询[12-21]和Top-k查询[22-26].对传感器网络中另一类重要的查询类型k-NN(k-NearestNeighbor)查询的隐私保护技术研究还很少.k-NN查询要求网络返回距离查询点最近的前k个数据对象值,在传感器网络中有着广泛的应用.例如,在水污染监测网络中,可以通过查询距离标准污染指数最近的前k个监测数据值及其节点来确定具有相同污染水平的区域.根据查询点设置的不同,可以将现有的k-NN查询划分为两种类型:一是基于地理位置的k-NN查询,即给定一个地理位置作为查询点,查找距离该位置最近且满足一定条件的前k个节点;二是基于值的k-NN查询,即用户以一个设定的数值作为查询点,查找离给定值最近且满足一定条件的前k个节点.本文主要关注第2种基于值的k-NN查询.由于单层传感器网络所固有的资源受限等问题,现有的数据查询处理研究大多采用双层传感器网络结构[27].如图1所示,在双层无线传感器网络Page3中,网络的下层由大量能量和计算能力有限的普通节点组成,网络的上层由少量资源充足的管理节点组成.管理节点的引入可以给网络带来明显的优势:(1)延长网络生命周期,普通节点只需要通过一跳或多跳的方式将数据传输到最近的管理节点,而不需要发送给更远的基站,明显地减少了数据包的传输跳数,降低了网络的通信能耗;(2)提高查询效率,管理节点拥有更强的计算和存储能力,能够更好地执行复杂的查询操作,有效地缩短查询响应时延;(3)增强可伸缩性,管理节点可以简化节点的加入/离开以及网络拓扑管理操作,对各种规模的应用场景都有较好的适用性.然而,管理节点在给网络数据存储和查询处理带来便利的同时也导致了严重的隐私泄露风险.传感器网络无线通信的开放性以及部署环境的无人值守等特性使得攻击者可以较为容易地窃听通信链路或者直接俘获网络节点.管理节点由于存储着大量的感知数据,并且在查询处理过程中起着关键作用,因此是攻击者俘获的重点目标.俘获后的管理节点会给网络数据安全带来严重的影响.首先,由于管理节点是不可信的,所有感知数据在发送到管理节点之前都必须进行加密操作.其次,管理节点在无法获得数据真实值的前提下,必须正确高效地在加密数据上完成查询处理操作.再次,简单的端到端加密和逐跳加密都无法适用于管理节点被俘获的双层传感器网络.在端到端加密中,管理节点无法执行网内数据查询操作;在逐跳加密中,攻击者可以通过俘获管理节点来获得密钥,进而获得敏感数据信息.最后,攻击者可以同时俘获管理节点和普通节点,并通过两者的共谋攻击来获得密钥、数据组织格式、数据隐藏机制等关键安全信息,进一步破坏数据的隐私性.因此,针对攻击者的窃听、俘获和共谋攻击,研究既能够保证数据隐私安全又能够高效率低能耗地完成查询的隐私保护k-NN查询处理协议具有很强的必要性.本文研究了双层传感网中的隐私保护k-NN查询处理问题,分别提出了面向俘获攻击的PKN(Privacy-preservingk-NNQuery)协议和面向共谋攻击的CPKN(Collusion-resistantPrivacy-preservingk-NNQuery)协议.为提高查询执行效率,文中首先设计了基于定向存储机制的KNQ(k-NNQuery)查询框架,有效缩短查询响应时延;为保护数据隐私,PKN协议引入了一种新颖的数据编码方法来分别对感知数据和查询请求进行编码,保证管理节点可以在不获知数据真实值的前提下完成k-NN数据查询操作;为抵御共谋攻击,CPKN通过在普通节点和存储节点之间设置一组特殊的代理节点来对初始编码进行处理,从而破坏普通节点与管理节点的数据关联性,达到使共谋攻击失效的目的.本文的主要贡献有:(1)提出双层传感器网络中基于Bloomfilter编码的隐私保护k-NN查询协议,在不泄露数据隐私的情况下精确地完成k-NN查询;(2)针对俘获后的管理节点和普通节点之间较高的共谋风险,提出基于代理节点的编码隐藏机制,能够有效地抵御共谋攻击;(3)在不泄露数据隐私的前提下,设计了双层网络上基于定向存储机制的隐私保护查询架构,保证了查询的高效执行.本文第2节介绍相关研究工作;第3节给出研究模型和问题定义;第4节和第5节分别描述面向俘获攻击的PKN协议和面向共谋攻击的CPKN协议;第6节通过真实数据集上的实验证明协议的有效性;第7节对全文进行总结.2相关工作现有的传感器网络隐私保护技术研究大多集中于隐私保护数据聚集[4-11]、范围查询[12-21]、Top-k查询[22-26]等,对隐私保护k-NN查询的研究还很少.同时,已有研究所针对的攻击类型多为节点俘获攻击,对于隐私危害性更大的共谋攻击的研究也较少.现有隐私保护数据聚集协议主要研究求和聚集与极值聚集,所使用的隐私保护技术有数据扰动技术[4-6]、切分重组技术[4-5,7-8]和同态加密技术[9-11]等.CPDA[4-5]结合了数据扰动和多项式性质,在隐藏节点真实数据的前提下,通过多项式变换求解出精确的求和聚集结果.SMART[4-5]提出了基于切分重组机制的隐私保护求和聚集协议,节点将每个敏感数据切分成多个数据片,不同数据片发送给不同的邻居节点,节点将收到数据片重新组合来完成求和聚集.ESPART[7]对SMART进行了改进,通过引入多种优化因子,有效提高了网络效率.SESDA[8]采用基于路线的方式执行数据聚集,将数据片通过安全通道传输来保证数据的隐私性,由于不采用加密处理,保证了较高的通信性能和能耗性能.IPHCDA[10]根据传感器网络的特点,对基于椭圆曲线密码机制的同态加密技术进行了改进,提高了节点数据在求Page4和聚集时的安全性.文献[11]在使用同态加密技术保护节点数据隐私性的同时,提出了一种基于离散时间控制环的动态数据聚集机制,以降低传感器节点的通信能耗.现有隐私保护范围查询协议研究主要在双层传感器网络上展开,主要方法有桶模式[12-16]、数据编码技术[17-19]和保序加密技术[20-21].文献[12-13]采用桶模式保护数据的隐私性,首先将值域划分成多个连续的桶,然后通过将用户查询和节点数据分别表示成对应的桶号来完成查询,攻击者无法从桶号推断出节点准确的真实数据.文献[16]给出了面向隐私保护单维和多维范围查询的VQuery协议,VQuery基于多项式技术对数据范围和查询条件进行编码以隐藏真实敏感信息,基于水印链完成结果完整性认证,并提出了多维区间树结构以表示多维数据.SafeQ[17-18]使用前缀成员验证技术在数据编码上实现双层网络中的隐私保护范围查询.在ZOSR[19]中,感知数据和查询请求被分别转化为Z-O编码,管理节点利用Z-O编码的数值比较特性,在不需要感知数据明文的前提下隐私保护地完成查询操作.文献[21]给出了一种新颖的保序加密机制,通过数据的有序映射,管理节点可以不泄露隐私地完成查询任务,同时还构建了基于多维邻居树和环形冗余校验码的链接水印机制以检验结果的完整性.在隐私保护Top-k查询处理技术中,现有研究所使用的主要技术包括安全多方计算[22-23]、保序加密技术[24]、前缀成员验证技术[25-26]等.SafeTQ[22]为每一个管理节点搭配一个高资源的辅助节点,管理节点与辅助节点使用安全比较机制[28]求解出Top-k结果的阈值.PI-TQ[23]对SafeTQ进行了改进,消除了对辅助节点的依赖,算法通过两轮查询来得出Top-k结果.文献[24]在保序加密机制上分别考虑了攻击者的密文攻击、背景知识推测攻击和恶意节点攻击,通过引入扰动机制和基于抽样假设检验的验证机制来保证数据的安全性和完整性.SVTQ[25]协议首先将节点数据通过前缀成员验证技术表示成前缀族和范围前缀的编码集合,再使用素数聚集机制完成数据大小关系判定,从而在保护隐私的同时完成查询.PPTQ[26]协议中,存储节点借助前缀成员验证技术的数值比较特性,在不获取原始数据的情况下计算包含查询结果的最小候选密文数据集,以实现隐私保护Top-k查询.在传统数据库和云计算环境中,隐私保护k-NN查询研究已经取得了一些成果.然而,这些研究成果往往基于高强度的加密操作[29-32]或复杂的分布式多方计算[33-34]来达到保护数据隐私的目的,既要求很强的计算能力又要求很强的网络通信能力,因此并不适用于能量以及计算能力、存储能力受限的无线传感器网络.现有的传感器网络隐私保护技术研究对k-NN查询的关注很少,由于查询类型存在明显差异,以上这些方法无法直接应用在传感器网络隐私保护k-NN查询中.同时,现有成果大多仅针对管理节点俘获攻击,而没有考虑对数据隐私危害更大的管理节点与普通传感器节点间的共谋攻击.针对以上问题,本文分别给出了面向节点俘获攻击的PKN协议和面向节点共谋攻击的CPKN协议,以在双层传感器网络中实现高效的隐私保护k-NN查询处理.3研究模型与问题定义3.1研究模型如图1所示,双层网络中包含N个能量、计算和存储都受限的普通传感器节点si1i(M个与基站类似的资源充足的管理节点s.传感器节点通过多跳方式与管理节点通信,而管理节点可以通过一跳方式直接将数据发送给传感器节点.简明起见,我们假设网络通信状况良好,不存在路由阻塞、链路失效等问题.传感器节点在每个上传周期中执行1次数据采集操作,采集到的数据包含多个属性,例如温度、光照、湿度等.在任意周期t中,普通节点si(1iN)采集到的数据表示为Vsi={vi[1],vi[2],…,vi[d]},d为数据的维数.在周期结束时,Page5普通节点通过多跳通信的形式将采集到的数据上传到最近的管理节点.数据上传结束后,基站直接与管理节点通信以完成k-NN查询.接下来,我们给出基于值的k-NN查询的相关定义.定义1.值的距离函数.对于任意给定的值G(G={G[1],G[2],…,G[d]}),G与节点si之间的值的距离Dis(G,si)为Dis(G,si)=∑其中wj为第j维属性的权值,由用户按照应用的不同以及各属性值的值域和重要性进行指定.定义2.基于值的k-NN查询.对于任意给定的包含N个对象的集合S以及任意给定的值G,查找一个大小为k的子集S(SS,kN),使得对于oe∈S以及of∈S-S,有Dis(G,oe)Dis(G,of).其中,Dis为值的距离函数.以图2为例,当d=1时,下发查询(k=3,G=5.0),则查询结果为{〈s1,5.1〉,〈s6,5.2〉,〈s8,4.7〉}.3.2攻击模型在双层传感器网络攻击模型中,对隐私数据的攻击可以分为外部攻击和内部攻击两种.外部攻击通过无线通信链路窃听的方式来获得敏感数据信息.内部攻击主要通过俘获单个或多个节点的方式实现,包括:普通节点俘获攻击.在俘获单个普通节点后,攻击者可以获得该节点上的真实数据,对整体网络的危害较小.管理节点俘获攻击.与普通节点相比,攻击者更倾向于俘获管理节点,一是因为管理节点存储着大量的感知数据;二是管理节点可以基于接收到的数据和查询请求进行推测攻击,以获得更多隐私数据信息.多个节点共谋攻击.攻击者通过管理节点与普通节点之间的共谋来获得敏感数据信息.可以看出,普通节点间的共谋攻击只会泄露被俘获节点的数据信息,对整体网络的影响较小;而管理节点与普通节点的共谋攻击有很大可能会泄露存储在管理节点上的所有的数据信息,造成极大的危害.本文的研究基于诚信但好奇(honest-but-curious)模型[35],攻击者通过外部攻击和内部攻击来记录或推测敏感数据信息,但其遵守协议且不篡改数据,仅破坏数据的隐私性但不破坏数据的完整性.因此,其他非诚信类型的攻击,包括DoS(DenialofService)、数据篡改删除等,不在本文的考虑范围内.我们假设基站节点是可信的,并且不可被俘获,同时攻击者能够俘获节点的数目是有限的,因为当网络中超过一定比例的节点都被俘获时,已经无法保证网络的正常性能.考虑到管理节点俘获攻击和共谋攻击对数据隐私安全的显著影响,本文首先针对管理节点俘获攻击提出了PKN隐私保护协议,接着针对共谋攻击提出了CPKN隐私保护协议.3.3问题定义本文的目标是提出适用于双层传感器网络的高效率低能耗的隐私保护k-NN查询处理协议.假设基站将查询请求Ai[]j|1iN,1j{节点采集的数据集合,所有传感器节点与查询点的距离值集合,Ωk为k-NN查询的结果集合,则在面对俘获攻击和共谋攻击时,隐私保护k-NN查询处理协议需要同时满足以下要求:(1)数据隐私性.节点本身和基站获得,而不允许被s(2)查询隐私性.查询请求等隐私信息,因此查询参数k只允许被保存在基站上.(3)正确性.Max(Dis(G,Ωk))Min(Dis(G,/Ωk)).(4)效率.协议在提供高强度隐私保护的同时Page6需要保证较高的查询效率和较低的能耗.4隐私保护犽-NN查询协议管理节点在被攻击者俘获时,容易直接泄露节点上存储的大量的感知数据,严重危害网络安全.因此,本节中我们给出了面向管理节点俘获攻击的PKN(Privacy-preservingk-NNquery)协议.PKN协议的目标是为基于值的k-NN查询提供数据隐私保护的同时保持较高的查询和能耗效率.因此,我们分为2个阶段来实现PKN协议.首先,为保证查询效率,构建适用于双层传感器网络的KNQ查询架构(k-NNQueryframework).接着,为抵御窃听攻击和管理节点俘获攻击,在KNQ查询架构上提出基于Bloomfilter编码的隐私保护机制.4.1KNQ查询架构KNQ查询架构的构建基于两个观察:(1)将潜在的查询响应数据定向存储到离基站更近的管理节点,可以缩短查询响应时间;(2)由于管理节点拥有充足的资源,所以应该尽量将数据通信和查询处理操作上推到管理节点执行,以节省普通节点的能量,提高网络的能耗效率,延长生存周期.本小节首先给出了KNQ查询架构的实现步骤,包括语言变量构建、数据定向存储和数据查询处理,接着指出了KNQ架构存在的隐私泄露问题.4.2节针对KNQ架构的隐私泄露风险,给出了基于编码机制的隐私保护方案.4.1.1基于值的语言变量在KNQ查询架构中,我们将k-NN查询中节点与指定值G之间距离的值域划分为非均匀的子域,不同的子域对应与指定值G之间不同的距离,越靠近0的子域的间隔越小.每个子域对应不同的基于值的语言变量VLV(ValuebasedLinguisticVariables).表1给出了基于值的语言变量的划分与表示的实例.VLVsABCDEF表1中将距离的值域划分为6个子域,分别用A到F表示.A对应最小的子域[0,3)以及相应的语义“几乎是指定值”.F代表离指定值最远的子域并对应语义“不值得关注”,在很多应用中可以根据具体情况直接进行过滤操作.通常来说,基于值的语言变量的子域参数选择可通过统计方法获得,或者直接由领域专家给定.4.1.2数据定向存储在KNQ架构中,距离值域的划分由基站完成,并发送到管理节点上.传感器节点在上传数据到最近的管理节点时,将落在同一个VLV子域的感知数据定向存储到一个指定的管理节点,可以在查询时有效缩短查询响应时延.KNQ使用hash函数将每个VLV映射到一个指定的管理节点进行相应的数据存储,子域值较小的VLV存储在离基站更近的管理节点.因此,在KNQ中,管理节点既要进行VLV判断操作,同时又是某一个或多个指定VLV的存储节点.图3给出了表1中VLV的定向存储的实例.子域为[0,3)的VLV(A)存储在离基站最近的管理节点上.例如当G=10时,感知数据Vi=11将存储在VLV(A)对应的管理节点上;感知数据Vi+1=17将存储在VLV(B)对应的管理节点上;而Vi+2=65将直接被过滤.4.1.3数据查询处理在执行k-NN查询的过程中,基站首先根据参数k和历史记录确定需要查询的管理节点.例如,当查询2-NN时,基站仅向存储VLV-A的管理节点下发查询请求;当查询8-NN时,基站同时向VLV(A)、VLV(B)、VLV(C)的存储节点下发查询请求.接收到查询请求的管理节点将存储的数据发送到基站.基站只需要在接收到的数据上进行排序操作,就可Page7以获得最终的查询结果.在特殊情况下,有很小的概率基站查询到的数据不能满足参数k的需求,基站需要再次向下一个VLV存储节点下发查询请求来完成查询.4.1.4KNQ架构的隐私泄露风险KNQ架构可以在减少普通传感器节点能耗的同时缩短k-NN查询的时延,保证较高的能耗效率和查询效率.然而,考虑到传感器网络中存在的窃听攻击和节点俘获攻击风险,在KNQ架构中,管理节点一旦被俘获,将严重泄漏网络的隐私信息.因此,未加密的原始敏感数据都不允许被转发或存储到管理节点,包括:(1)传感器节点感知数据;(2)基站查询请求;(3)语言变量子域划分表.然而,管理节点无法在加密数据上完成VLV判定和定向存储操作.本文中我们使用附加编码的方法来反映加密数据的真实值,协助基站和管理节点在不泄露隐私的前提下完成数据查询处理.4.2节给出了基于改进的Bloomfilter进行隐私保护k-NN查询处理的PKN协议.4.2隐私保护犽-NN查询协议(PKN)本节首先对标准的Bloomfilter[36]进行概要介绍,接着对Bloomfilter进行改进以实现隐私保护k-NN查询.4.2.1Bloomfilter概述Bloomfilter是具有很好的时间和空间效率的随机数据结构,通常用在成员关系判定中.如图4(a)所示,初始状态时,Bloomfilter是一个包含m位的位数组,每一位都置为0.为了表达n个元素的集合X={x1,x2,…,xn},Bloomfilter使用l个相互独立的hash函数,将集合中的每个元素映射到l个分布在范围内的位置上,并将数组中相应的位置置为1.如图4(b),h1(x1)=3,h2(x1)=6,h3(x1)=8,则将数组中的第(3,6,8)位都置为1.类似的,为表示元素x2,也将第(9,12,15)位都置为1.如果一个位置多次被置为1,则只有第一次会起作用,其他几次将没有任何效果.当判定元素y是否属于集合X时,检查是否所有的hi(y)(1il)位都为1,如果不成立,则y一定不属于X;如果成立,并不能100%确定y属于X.这是因为Bloomfilter存在一定的假阳性(FalsePositive)概率,当所有的hi(y)(1il)位都恰好被集合X中的其他元素置为1时,元素y会被错误地判定属于集合X.例如图4(c),集合X={x1,x2}由Bloomfilter编码0010010110010010表示,元素y1的hash值为(3,8,12),由于编码中以上3位都为1,y1将被判定为属于集合X,这是一个假阳性误判.而hash值为(8,13,15)的y2将直接被判定为不属于X.由于假阳性判定不会对结果的完整性产生影响,同时发生的概率较低且是可控的,Bloomfilter机制可以应用在隐私保护k-NN查询处理中.定理1[36]给出了Bloomfilter发生假阳性判定的概率.定理1.设m为Bloomfilter数组的长度,l为hash函数的数目,n为集合X中元素的数目,P为假阳性(FalsePositive)判定发生的概率.则简单起见,1-1-来表示.4.2.2隐私保护数据定向存储上文已经提到非加密的数据不允许被转发和存储到管理节点,因此,我们首先对本文使用的全局同步的端到端加密机制进行定义.在网络初始化阶段,传感器节点si与基站共享点对点的密钥种子ki,0.在周期t中,si使用ki,t对数据进行加密并上传到管理节点,ki,t=hash(ki,t-1)是节点si在周期t中的密钥,而ki,t-1在周期t开始时将被节点si删除.管理节点无法获得传感器节点与基站之间的同步密钥,因Page8此,即使被攻击者俘获也无法对加密数据进行解密来获得隐私数据信息.同时,我们对Bloomfilter机制进行改进,将感知数据和VLV子域分别转化成数据编码的形式,从而在加密数据上完成VLV判定和数据定向存储操作.接下来,我们分别给出基站、传感器节点和管理节点上的隐私保护定向存储机制.基站:在网络初始阶段,基站与普通传感器节点间共享一个由l个相互独立的hash函数{h1,h2,…,hl}组成的hashBF函数集合.基站为每个VLV子域构建一个m位的Bloomfilter数组,使用hash函数集合{h1,h2,…,hl}将子域中的每个元素映射到l个位置,并将数组中相应的位置置为1,重复这一过程,直到子域中的所有元素都被映射到Bloomfilter数组中.这样,每一个VLV子域都可以用一个m位的Bloomfilter编码进行表示.基站将所有VLV子域对应的Bloomfilter编码发送到管理节点.消息格式如下:Sink→s其中:t为周期,BFA为VLV(A)子域对应的Bloomfilter编码数组.BFVLVs为最后一个VLVs的编码,通常会被直接过滤掉,因此,BF|VLVs-1|为最后一个值得关注的子域的Bloomfilter编码.Hashmatch是存储节点分配函数,为每一个VLV子域分配指定的存储节点.距离值较小的VLV子域的数据被存储在离基站较近的管理节点上.普通传感器节点:传感器节点si采集数据并计算距离值Dis(G,si),使用hash函数集合{h1,h2,…,hl}将Dis(G,si)映射为一个m位的Bloomfilter编码,接着将Bloomfilter编码和加密后的真实数据发送到最近的管理节点.消息格式如下:sensorsi→s其中:IDi为节点ID,BFsifilter编码,Eki,t的密文.管理节点:在基站和传感器节点已有的前期准备的基础上,管理节点可以基于定理2和定理3完成隐私保护VLV判定和数据定向存储操作.定理2.如果BFsi∩BFA≠BFsisi)VLV(A).证明.使用反证法来进行证明.假设当BFsi∩BFA≠BFsi示Dis(G,si)的Bloomfilter编码.如果Dis(G,si)的值属于子域A,那么它对应的Bloomfilter编码中的l个hash位置都应该被置为1,则一定有BFsi∩BFA=BFsi定理3.当BFsi∩BFA=BFsiVLV(A)以一定概率成立.证明.定理3是定理2的逆反命题,由于定理2成立,则定理3一定成立.当BFsi∩BFA=BFsi时,令P^表示Dis(G,si)∈VLV(A)的概率,由定理1可得当管理节点接收到传感器节点发来的消息时,首先提取出si的Bloomfilter编码BFsi基站接收到的每一个VLV子域的Bloomfilter编码进行比较,以求得满足式(1)的参数U.UAUVLVs(如果U存在,则si的数据属于VLV(U)子域.管理节点使用Hash(U)来确定VLV(U)的存储节点(U),并将从si接收到的消息直接转发到ss节点.如果U不存在,则一定有Dis(G,si)∈VLVUnremarkable,传感器节点si的数据通常被直接(被过滤掉.4.2.3隐私保护数据查询处理与KNQ查询架构类似,基站根据参数k和历史记录确定需要查询的VLV子域,并将查询请求下发到这些VLV子域对应的管理节点.管理节点在接收到查询请求后,将存储的数据发送到基站,消息格式如下:基站接收到查询响应数据后,首先根据t和IDi来匹配得到密钥ki,t;接着通过解密得到真实值Vsi并求解真实距离值Dis(G,si),从而将假阳性判定引起的误判数据删除掉;最后通过对Dis(G,si)进行排序来得到精确的查询结果数据.由于基站可以通过真实Dis(G,si)值将假阳性判定数据与正确数据区分开,Bloomfilter的假阳性误判问题并不会对k-NN查询结果集的正确性产生影响.4.2.4PKN安全性分析隐私保护k-NN查询的要求是节点的真实数据和真实距离值到节点真实数据使用与基站的端到端密钥加密后传输到管理节点,在无密钥的情况下,管理节点无法通Page9过解密获得节点真实数据值.另一种攻击方式是被俘获的管理节点通过接收到的传感器节点si的编码,猜测BFsiBFsi应关系.管理节点通过观察能够确定传感器节点使用的哈希函数的个数l以及编码数组的长度m,则攻击者能够正确猜测编码与真实距离值对应关系的概率为Pi=()m4.2.5PKN性能分析(1)PKN协议计算复杂度.参照文献[12-13,16],我们对PKN协议中普通节点和管理节点的计算复杂度进行分析.普通节点需要对数据进行BF编码操作和加密操作,BF编码操作的计算复杂度为O(l),其中l为哈希函数的个数,设加密算法的复杂度为O(E),则普通节点的计算复杂度为O(l)+O(E).管理节点上单次编码比较操作的计算复杂度为O(m),假设每个管理节点收到c个普通节点的数据,VLV子域的划分数量为v,则管理节点的计算复杂度为()(2)传感器节点通信能耗.令id,BF,d分别表示上传消息中ID,BFsiLis表示节点si到s传感器节点的总能耗为(3)管理节点通信能耗.令k-NN查询使用到的最大的VLV子域,Lss据定向存储到对应管理节点的路由跳数,Lsink表示管理节点向基站返回查询结果的路由跳数.则PKN协议中管理节点的总能耗为Cs=∑由以上分析可知,PKN协议可以在管理节点被俘获的情况下不泄露隐私的完成k-NN查询,并且保持较低的能耗.本文第6节通过实验对PKN协议的性能进行了验证.4.3PKN协议改进与优化本节中,我们从隐私保护强度、协议适用范围和网络性能等方面对PKN协议进行改进,分别提出分组随机存储机制、动态参数G查询机制、VLV子域划分机制、编码长度选择机制和编码数据压缩机制等5种针对PKN协议的优化策略.4.3.1分组随机存储机制在PKN协议中,管理节点存储的子域范围与该管理节点与基站距离存在相关性,攻击者可以根据管理节点与基站的距离远近来推测不同管理节点子域范围的大概值域和大小关系,从而推测多个普通节点距离值的大概取值范围和大小关系.虽然攻击者无法准确推测出管理节点的真实子域范围,也无法推测普通感知节点的准确距离值,但仍然可能泄露数据隐私信息.针对以上问题,我们给出了分组随机存储机制.在基站为不同VLV子域指定存储节点前,首先根据子域范围大小对VLV子域进行分组,同时根据管理节点与基站距离对管理节点进行相应分组.以图3为例,将VLV(A)、VLV(B)和VLV(C)划分为第1组,对应的第1组管理节点为1、2和3;将VLV(D)和VLV(E)划分为第2组,对应第2组管理节点为4、5和6.基站在指定存储节点时,从第1组管理节点中为第1组VLV随机选择存储节点,从第2组管理节点中为第2组VLV随机选择存储节点.例如,VLV(A),VLV(B)和VLV(C)分别存储在管理节点2,3和1上,VLV(D)和VLV(E)分别存储在管理节点6和4上.为提高安全性,基站将周期性的对分组随机存储的分配进行更新.在未引入分组随机存储机制时,攻击者能推测多个普通节点数据距离值的大概取值范围和大小关系;在引入分组随机存储机制后,攻击者既不能确定子域取值范围也不能确定数据间的大小关系,保证了敏感数据的隐私性.同时,由于分组策略考虑了管理节点与基站间的距离,分组随机存储机制不会对网络性能产生明显影响.4.3.2动态参数G查询机制在传感器网络中,k-NN查询通常应用于数据监测环境中,参数G在多数情况下保持固定.然而,随着网络环境和应用需求的变化,用户也可能更改参数G的值.当G发生动态变化时,PKN协议按照如下步骤执行:(1)用户将新的参数G及相应的VLV子域范围划分方式提交到基站;(2)基站根据新的VLV子域划分范围生成相应的Bloomfilter编码,并发送到管理节点;(3)基站使用与普通节点共享的公钥对G进行Page10加密,并通过管理节点下发到普通节点;(4)普通节点解密后使用新的G值作为标准计算Dis(G,si),并生成BF编码;(5)普通节点的数据上传操作和管理节点上的定向存储操作与固定参数G的情况完全相同.新的参数G的下发操作和新的VLV编码计算及传输都由基站和高资源的管理节点完成,参数G的更新并不会对普通节点的能耗和生命周期产生明显影响.由于基站与高资源管理节点的能量都是充足的,因此能够满足参数G动态更新的需求.4.3.3VLV子域划分机制在PKN协议中,VLV子域划分方式对查询响应结果集的大小有直接影响,本节我们对VLV的划分方式进行讨论.与文献[12-13]相同,假设基站通过历史数据估计得出距离值的分布函数F(x).设第i个VLV子域的上下界分别为li和hi.由4.2.5节中的计算复杂度分析可知,管理节点执行的编码比较操作的次数与VLV子域的数量v成正比,过高的VLV子域数量会增加管理节点的负载.因此,VLV子域划分粒度不应过小.常用的划分方式包括等宽划分、等高划分和递增划分3种.(1)等宽划分方式:所有的VLV子域采用相同的值域范围,即h1-l1=…=hv-lv.当VK落在第i个VLV子域时,等宽划分方式冗余数据的上界为可以看出,当VLV子域i对应大量的节点数据时,查询时可能导致明显的冗余数据问题.(2)等高划分方式:以不同VLV子域对应相等数量的节点数据为原则进行划分.节点数据的数量即为VLV子域的高度值.设高度值为T,则等高划分方式的冗余数据的上界为T.可以通过设置T,将冗余数据限制在一定范围内,然而当k较小时,冗余数据的比例仍旧比较高,如k=2时,冗余比例为T()-2/T.(3)递增划分方式:距离值较小的VLV的划分粒度较小,随距离值的增大,VLV的划分粒度逐渐增大,即h1-l1<…<hv-lv.当k较小时,冗余数据的比例低,然而当查询涉及值域较大的子域时,容易导致大量的冗余数据.结合k-NN查询的特点,兼顾查询结果集较小和较大的情况,我们采用混合划分方式.对距离值较小的VLV子域,采用递增式划分,以尽量减少冗余数据比例.而考虑查询结果集较大的情形,对距离值较大的VLV子域,采用等高划分方式,控制冗余数据的上限.采用混合划分方式可以保证当k较小时,冗余数据比例较小,同时当k较大时,冗余数据量也不超过T.4.3.4Bloomfilter数组长度选择机制在进行k-NN查询时,过高的假阳性判定概率会导致查询时的冗余数据问题.由定理1可知,假阳性判定概率与数组长度成反比,然而采用过长的Bloomfilter数组编码时会增加普通节点的通信代价,缩短网络的生存周期.定理4给出了任意指定假阳性概率和元素数量所对应的最小Bloomfilter数组编码长度.定理4.设ε为指定的假阳性判定概率,m为Bloomfilter数组的长度,l为hash函数的数目,n为集合X中元素的数量,P为假阳性(FalsePositive)判定发生的概率.满足Pε的最小Bloomfilter数组长度m为证明.由定理1可知[36],对于指定的m和n,保证最低假阳性概率的最优hash函数个数为l=m()nln2,因此,假阳性判定概率可以表示为由Pε可得,mnlog2e×log2(1/ε),得证.证毕.第6节实验部分对Bloomfilter数组长度与元素个数之间的关系进行了评估.4.3.5数据压缩机制在传感器节点数据生成BF编码的过程中,由于仅使用l个hash函数,编码中仅有l位为“1”,其他位全部为“0”.为减少普通节点上传的数据量,需要对BF编码进行数据压缩.本小节根据数据压缩方式的不同,分别给出了两种数据压缩机制:绝对位置数据压缩和相对位置数据压缩.(1)绝对位置数据压缩机制用“1”的绝对位置的集合来表示BF编码.例如,用{1,4,12}表示BF编码〈1001000000010000〉,其中1、4、12分别表示“1”在BF编码中的绝对位置.相比于初始的16位编码,压缩后只需要8位就可以表示BF编码,压缩率为2.设l为哈希函数的数量,m为BF编码的长度,Bj为第j个“1”在BF编码中的绝对位置,Bit为编码压缩后所需的位数.以下公式分别给出了基于绝对位置的压缩机制所需Page11位数的最大值和最小值.可以看出,当所有的“1”都落在编码的最后l位时,压缩后的位数最多;当所有的“1”都落在编码的最前l位时,压缩后的位数最少.(2)相对位置数据压缩机制用相邻两个“1”的位置之差的集合来表示BF编码.如用{1,3,8}表示BF编码〈1001000000010000〉,其中1是第一个“1”在BF编码中的绝对位置,3和8分别是BF编码中相邻两个“1”的位置之差.基于相对位置的压缩机制只用7位就可以表示16位的BF编码,压缩率为2.286.以下公式给出了基于相对位置的数据压缩机制所需位数的最大值.Bitmax=max∑可以看出,当所有的“1”均匀分布在BF编码中时,压缩后的位数最多;当所有的“1”都落在编码的最前l位时,压缩后的位数最少.显然,无论是绝对位置压缩还是相对位置压缩,管理节点都可以还原出初始BF编码,并正确地完成VLV判定.数据压缩机制仅应用于普通节点数据,以减少数据上传量,节省普通节点能量.由于基站与管理节点能量充足,因此VLV编码不做压缩处理.6.2.1节实验在对两种编码压缩算法的性能进行了评估.5面向共谋攻击的犽-NN查询协议双层传感器网络中另一类危害较大的攻击类型是普通传感器节点与管理节点间的共谋攻击.攻击者通过共谋攻击能够直接获得传感器节点上的Bloomfilter编码hashBF函数集合.基于这些函数,攻击者可以枚举得到:(1)管理节点上存储的感知数据的真实距离值真实范围与定向存储信息.因此,传感器节点与管理节点间的共谋攻击将使PKN协议的保护机制失效,并严重影响网络的数据安全.我们在PKN协议的基础上提出了抵御共谋攻击的CPKN协议,首先给出了节点匿名方法,接着基于迭代处理机制给出了基础的CPKN-naive协议,然后对它进行了改进,提出了基于编码分片传输机制的Slice-CPKN(CPKN-s)协议.5.1节点匿名空间为抵御共谋攻击,基站在网络初始化阶段为每个传感器节点构建匿名空间.如图5所示,基站上建立由N×η个虚假ID建立的总体匿名空间,然后采用随机选择的方式为每个传感器节点分配一个由η个虚假ID组成的匿名子空间,并直接内置在传感器节点上.传感器节点上传数据时,每次从子匿名空间中随机选择一个虚假ID来替代真实ID进行数据传输.5.2NaveCPKN协议5.2.1NaveCPKN协议实现NaveCPKN协议的核心思想是基于节点间的迭代处理来达到抵御共谋攻击的目的.首先,在网络中选择一系列传感器节点作为代理节点(AgentNodes),用Aθ(θ=1,2,…,w)表示,为保证数据精度,代理节点仍然正常进行数据采集操作.代理节点的选择由基站控制,并根据能耗状况进行周期性的更新.基站通过端到端加密向选定的代理节点发送如下参数:ID单路完美哈希函数hID函数hCA能够保证避免哈希碰撞问题.hIDID哈希为新的ID,hC每个1位随机哈希到其他位,从而产生一个新的编码.kAθPage12数据.算法1给出了NaveCPKN协议中基于代理节(Vsi(Vsi(pID0点迭代处理的数据隐藏机制的详细步骤.当A1节点接收到传感器节点si发送来的数据{t;pIDi;BFsiEki,tEki,thIDA1然后,将处理后的数据发送至下一个代理节点A2.A2接收到消息后重复数据处理过程,直到消息到达Aw节点.代理节点Aw在对接收到的数据处理后,直接发送到管理节点.因此,管理节点接收到的si的数据为{t;pIDw基站将对所有VLV子域进行重编码,将每一个元素对应的编码进行与代理节点相同的哈希处理后,组成新的VLV子域Bloomfilter编码,并发送到管理节点.消息格式如下:Sink→s管理节点采用与PKN协议完全相同的定向存储和数据查询处理机制来完成隐私保护k-NN查询.算法1.NaveCPKN协议代理节点数据迭代隐藏机制.输入:{t;pIDi;BFs输出:t;pIDw1.pID02.BF03.E0(Vs4.FOR1θw5.pIDθ6.BFθ7.Eθ(Vs8.Aθ→Aθ+1:{t;pIDθ//代理节点Aθ将消息发送给Aθ+1代理节点9.ENDFOR10.RETURN{t;pIDw//代理节点将隐藏后的数据发送到管理节点5.2.2NaveCPKN协议安全性分析在NaveCPKN协议中,攻击者根据俘获节点的不同,可以实施两种形式的共谋攻击:管理节点与传感器节点的共谋攻击;管理节点、代理节点与传感器节点的共谋攻击.下面针对这两种情况分别进行安全性分析:(1)管理节点s经过w个代理节点对传感器节点数据的处理后,即使si也无法从sEw(Vsi用的Bloomfilter哈希函数,但是由于传感器节点的原始BFsi理节点很难从BFwsi节点上Bloomfilter哈希函数的个数,则管理节点能够正确地逆向推测原始BFsi-1()ml理节点与传感器节点的共谋攻击.(2)管理节点s的共谋攻击.假设攻击者同时俘获了多个传感器节点、代理节点和管理节点,如果被俘获的代理节点不能构成从传感器节点到管理节点的完整路径,则仍旧不能完成节点原始数据与管理节点数据的一一对应.只有当所有的代理节点都被俘获时,传感器节点才可以通过重复代理节点完整的数据处理操作来进行枚举攻击,在原始值与管理节点存储值之间建立联系.然而,由于攻击者能够俘获的节点数目是有限的,并且代理节点在网络中的分布是不确定的,攻击者俘获完整路径的几率很小.假设攻击者能够俘获的节点数为Γ,代理节点数目为w,网络中传感器节点数目为N,攻击者俘获的任意一个节点为普通节点的概率为(1-w/N),刚好为第θ个代理节点的概率为(1/N),则攻击者在俘获Γ个节点时,能够同时俘获代理节点完整路径的概率Pc为Pc=因此,在代理节点足够多时,攻击者很难通过管理节点、代理节点与传感器节点间的共谋攻击来获得隐私数据.5.2.3NaveCPKN协议能耗分析(1)NaveCPKN协议计算复杂度.我们分别对普通节点、代理节点和管理节点的计算复杂度进行分析.普通节点的计算复杂度与PKN协议相同,仍为O(l)+O(E).代理节点上hIDO(m).假设每个管理节点收到c个普通节点的数据,则代理节点的计算复杂度为c(O(1)+O(m)+Page13O(E)).与PKN协议相同,管理节点的计算复杂度为O(cvm).(2)传感器节点通信能耗.令LiA表示从节点si到代理节点A的路由跳数,LAWsA到W再到s中传感器节点的总能耗为CS=∑(3)管理节点通信能耗.由于NaveCPKN协议与PKN协议的定向存储和数据查询操作是完全相同的.因此,两者的管理节点总能耗是相同的.由以上分析可知,NaveCPKN协议能够提供高强度的隐私保护,但代理节点的计算能耗和通信能耗都比较高.虽然引入代理节点轮转机制能够减轻能耗不均衡问题的影响,但仍然会消耗较多的网络能量.因此NaveCPKN协议仅适用于安全需求高,能量较为充足的网络中.为进一步解决代理节点能耗问题,扩大协议的适用范围,我们提出了基于分片机制的Slice-CPKN(CPKN-s)协议.5.3Slice-CPKN协议由于NaveCPKN协议存在网络能耗较多和上传时延较长的问题,我们给出了Slice-CPKN(CPKN-s)协议.5.3.1CPKN-s协议实现在CPKN-s中,与Nave-CPKN不同,基站同时在网络中设置组功能完全相同的代理节点,用Aθ(θ=1,2,…,w),Bθ(θ=1,2,…,w),…,θ(θ=1,2,…,w)表示.其中每组中对应节点的数据处理函数是相同的,例如A1、B1和1的功能相同,Aw、Bw和w的功能相同.因此,同一个编码数据在经过代理节点(A1,B2,B3,…,w)处理后的值与经过(A1,A2,A3,…,Aw)处理后的值是完全相同的.基站通过端到端加密仅向选定的代理节点Aθ,Bθ和θ发送编码单路哈希函数hC算法2给出了CPKN-s协议中基于编码切片的数据隐藏机制的详细步骤.传感器节点si上传数据时,将加密后的数据Eki,t到管理节点,然后将编码BFsi(zθ)(θ=1,2,…,w).w个编码切片满足如下BFsi要求:‖z1‖>‖z2‖>…>‖zw‖,‖zw‖表示第w个编码切片的长度.将第θ(θ=1,2,…,w)个编码片加上pIDi后发送到最近的第θ个代理节点上.第θ个代理节点使用hC段BFsi节点.管理节点在接收到来自si的所有数据后,包括pIDi,BFsi条消息携带的pIDi首先将BFsi合并为整体编码BFsi该编码片在整体编码BFsi根据以上信息,合并出隐藏后的节点si的完整信息{t;pIDi;BFsi基站在下发和更新VLV编码表时,也采用与传感器节点对应的方式将每个元素对应的编码切分为w个编码片,对每个编码片使用对应的hC合并为完整的元素编码,从而得到新的VLV子域Bloomfilter编码,并发送到管理节点.消息格式如下:Sink→s在CPKN-s协议中,管理节点采用与PKN和CPKN-naive协议完全相同的定向存储和数据查询处理机制来完成隐私保护k-NN查询.算法2.CPKN-s协议代理节点数据隐藏机制.输入:{t;pIDi;BFs输出:{t;pIDi;BFs1.FOR1θw2.Sink→Aθ,Bθ,…,θ:hC//基站为每组代理节点中对应的节点下发相同的3.ENDFOR4.si→s5.si将BFs6.Aθ,Bθ,…,θ:BFs7.Aθ,Bθ,…,θ→s//代理节点将处理后的编码片发送到管理节点8.s9.合并BFs10.RETURN{t;pIDi;BFs//管理节点合并得到隐藏后的数据5.3.2CPKN-s协议安全性分析(1)管理节点s经过w个代理节点对传感器节点数据编码的处理后,管理节点虽然获得了传感器节点所使用的Bloomfilter哈希函数,但是由于传感器节点的原始BFsi经被代理节点上的w个哈希函数转化为BFsiPage14节点很难从BFsi节点上Bloomfilter哈希函数的个数,假设lθ个1落在第BFsi向推测原始BFsi(2)管理节点s的共谋攻击.假设攻击者同时俘获了多个传感器节点、代理节点和管理节点,攻击者的目的是获得所有θ(θ=1,2,…,w)函数.因为即使仅缺少一个hC的hC函数,攻击者也无法重复代理节点完整的数据处理操作,也就无法通过分析BFsi而得到数据的真实值.假设网络中传感器节点数目为N,攻击者能够俘获的节点数为Γ,代理节点共有组,每组包含w个节点,用Γθ表示攻击者通过俘获得到的hC有的hCθ函数,则一定有1Γθ(θ=1,2,…,w).因此,攻击者在俘获Γ个节点时,能够得到所有hC数的概率Pc为烄Pc=烅烆由上式可以看出,Pc与俘获节点的数目Γ以及代理节点的组数成正比,与每组代理节点的数目w成反比.当w足够大,取值合理时,攻击者很难获得所有的hC议的隐私保护性能进行验证.5.3.3CPKN-s协议能耗分析(1)CPKN-s协议计算复杂度.CPKN-s协议中普通节点的计算复杂度仍为O(l)+O(E).假设每个管理节点收到c个普通节点的数据,则每个代理节点接收到的BF编码片数量平均为(c/),BF编码片的长度平均为(m/w),代理节点上的复杂度为O(m/w).因此代理节点的计算复杂hC度为(c/)O(m/w),明显低于NaveCPKN协议.而管理节点的计算复杂度仍为O(cvm).Aθ(2)传感器节点总能耗.令Liθs到代理节点θ再到s切片个数,则CPKN-s协议中传感器节点的总能耗为NCS=∑i=1(3)管理节点通信能耗.CPKN-s协议的管理节点总能耗与PKN协议以及NaveCPKN协议是相同的.5.3.4CPKN-s协议能耗均衡优化机制面向能耗均衡的簇头节点选取机制在已有工作中已经得了深入的研究,如文献[37-40].在CPKN-s协议中,多组代理节点不再需要对数据进行加密操作,而是只对接收到的部分编码片进行哈希操作,计算能耗明显降低,能耗不均衡问题也较NaveCPKN有所缓解.为了更好的解决CPKN-s协议中的代理节点选取和能耗均衡问题,我们引入现有研究中比较成熟的算法[37],文献[37]中提出的多簇头产生机制适用于CPKN-s中多代理节点的选择,并且能够达到很好的网络能耗均衡效果.6实验与分析我们首先对本文核心的隐私保护Bloomfilter编码机制的性能进行实验验证,并讨论相应的参数选择问题;接着按照非共谋攻击和共谋攻击两种场景,分别对本文提出的隐私保护k-NN查询协议的关键性能进行验证,包括网络性能和隐私性能两个方面.网络性能主要衡量PKN和CPKN协议的通信能耗以及查询时延两个重要参数;隐私性能主要关注Nave-CPKN和CPKN-s协议在共谋攻击下的隐私保护强度.由于现有研究大多针对基于位置的k-NN查询展开,缺少传感器网络中隐私保护基于值的k-NN查询方面的工作,实验中选用经典的不提供数据隐私保护的分布式TinyOS-kNN[41]算法作为对比协议.我们使用OMNet++4.1来对协议的性能进行仿真.传感器节点数目N从100~1000变化,网络覆盖范围为100槡N×100槡Nm2的矩形区域,基站位于区域中心位置.文献[42-43]的研究表明,在双层传感网中,管理节点数量的增加通常有利于延长普通节点的生命周期,但也会明显地增加网络的成本.考虑到实际应用中网络的实用性和可扩展性,与文献[43]相同,实验中管理节点的数量随网络规模的增大而增加,设每个管理节点对应c个普通节点(本文中c约为50),因此管理节点的数目Page15从2个逐渐增加到20个,并均匀分布在网络中.与文献[14-15]相同,设普通节点到管理节点的平均跳数Lis实验使用公开的真实数据集LUCEdataset①,该数据集为2006年11月至2007年5月采集的环境温度、土壤湿度等多维属性数据,共包含约100个节点.实验中不同规模网络的传感器节点数据通过合成LUCEdataset得到.6.1隐私保护Bloomfilter编码机制的性能假阳性判定概率是影响Bloomfilter编码机制性能的关键点,在进行k-NN查询时,过高的假阳性判定概率会引发严重的能量和存储空间浪费问题.本节对Bloomfilter的假阳性判定概率与编码数组长度以及哈希函数个数之间的关系进行了评估.如图6Bloomfilter编码机制性能6.2隐私保护犽-NN查询协议性能(PKN)本节中首先对PKN协议所采用的数据压缩机制的性能进行验证,接着使用通信能耗来对PKN协议的网络性能进行评价,最后评估了非共谋攻击图6(a)所示,当哈希函数取4个时,Bloomfilter的假阳性判定概率随着编码长度的增加快速下降.在传感器网络当中,假阳性判定概率一般不应超过5%,因此对于包含10个、15个和20个元素的集合,适合的编码数值长度分别为70位、95位和125位.图6(b)给出了在元素个数为20时,哈希函数个数对假阳性判定概率的影响.可以看到,哈希函数个数越多时,对编码长度的要求越高,同时假阳性判定概率的下降速度也越快.图6(c)给出了指定假阳性判定概率下,元素数量与编码数组长度之间的关系.可以看到,元素数量越多所需要的编码数组长度也就越长.因此,在划分VLV时,子域元素的数量一般不超过20.本文中为Bloomfilter机制选择4个哈希函数和128位的编码数组.下PKN协议的隐私保护性能.6.2.1PKN协议数据压缩机制性能评价数据压缩机制能够明显地降低普通传感器节点①LUCE.http://lcav.epfl.ch/cms/lang/en/pid/86035Page16的通信量,图7比较了两种数据压缩机制的压缩性能.压缩后的位数越少,则通信能耗越低.设初始BF编码为128位,使用绝对位置数据压缩机制后,编码被压缩到约24位,平均压缩率约为5;而使用相对位置压缩机制后,编码被压缩到约18位,平均压缩率约为7.可以看到,相对位置数据压缩机制能够更好地减少普通节点的通信量,在PKN中将采用相对位置数据压缩机制.6.2.2PKN协议网络性能评价在传感器网络中,绝大部分的能量消耗是由数据通信引起的.因此,我们使用通信代价来衡量网络的能耗性能.对于PKN协议,VLV划分表对值域的覆盖率是决定能耗高低的重要因素,我们分别考虑了VLV覆盖率为100%(PKN-1.0)、50%(PKN-0.5)和30%(PKN-0.3)的情况.图8和图9分别给出了普通传感器节点和管理节点在不同场景下的通信代价.图8PKN协议普通传感器节点能耗性能如图8(a)所示,当网络规模从100增加到1000时,能耗随着网络规模的扩大而增加.当PKN的VLV表覆盖整个值域时,PKN-1.0的能耗高于TinyOS,这是因为PKN协议为每个数据增加了一个编码数组.而PKN-0.5和PKN-0.3由于在传感器节点进行了过滤操作,减少了数据发送量,能耗较低.由实验结果可以看出,实际应用中在不影响结果精度的前提下基站选择覆盖率尽可能小的VLV表是有必要的.图8(b)给出了k-NN查询中参数k的变化与普通传感器节点能耗的关系.在500个节点的网络中,k值由50增大到100.由于数据查询过程仅仅与上层管理节点有关,因此各协议的普通传感器节点能耗不随k值的变化而发生变化.图9(a)对PKN协议中管理节点能耗与网络规模的关系进行了衡量.考虑到查询的合理性,我们将k值设置为网络规模的10%.可以看出PKN-0.5的管理节点总能耗略高于TinyOS,而PKN-0.3的管理节点能耗相对较低.TinyOS中数据分布存储在多个管理节点,查询响应时的多跳通信增加了总体的能耗.图9(b)中,在500个节点的网络中,当k值由50增大到100时,PKN-0.5和PKN-0.3的管理节点能耗增长幅度不大,而TinyOS的能耗有较明显的增加.这是因为在PKN协议中,k值的增大对定向存储的能耗没有影响,仅仅增加了结果返回值的规模,而结果数据存储在近基站的节点,数据返回所使用的能耗较低.Page17图9PKN协议管理节点能耗性能6.2.3PKN协议隐私性能评价图10给出了PKN协议在不同Bloomfilter哈希函数数目下的隐私泄露概率,即攻击者通过推测攻击正确关联数据编码与距离真实值的概率.仅当哈希函数数目为1时,有不足0.01的隐私泄露概率,当哈希函数数目大于等于3时,隐私泄露概率接图11CPKN协议普通传感器节点能耗性能近于0,攻击者无法获得隐私数据信息.本文中为Bloomfilter选择4个哈希函数,因此能够保证数据的隐私.6.3共谋攻击下的犽-NN查询协议性能(CPKN)本节主要关注CPKN协议在共谋攻击下的能耗性能和隐私性能.6.3.1CPKN协议能耗性能评价图11(a)给出了CPKN-Nave协议和CPKN-s协议普通传感器节点的能耗.可以看出,CPKN-Nave协议中,代理节点由于采用了串行的数据处理方式,增加了数据上传的平均跳数,能耗明显大于CPKN-s协议.而CPKN-s协议中代理节点仅对进行并行处理的方法有效地降低了传感器节点BFsi的能耗.图11(b)给出了CPKN协议中普通传感器节点能耗与参数k的变化的关系.与PKN协议类似,CPKN-Nave和CPKN-s协议的传感器节点能耗不随k值的变化而发生变化.Page18图12CPKN协议管理节点能耗性能如图12(a)所示,CPKN-Nave协议和CPKN-s协议的管理节点能耗在不同网络规模下是基本相等的,这是因为两个协议在管理节点上的定向存储机制和数据查询机制都是相同的,仅仅在VLV子域判定过程中存在细微差别.数据上传阶段中代理节点的不同数据处理方式对管理节点不会产生影响.与图12(a)类似,图12(b)中CPKN-Nave协议和CPKN-s协议的管理节点能耗在不同k值条件下也是基本相等的.6.3.2CPKN协议隐私性能评价对CPKN协议隐私性能的评价分为两种情况:一是普通传感器节点与管理节点间的共谋攻击;二是普通传感器节点、代理节点与管理节点间的共谋攻击.图13给出了攻击者通过存储在管理节点上的BFsi显地看出,当Bloomfilter哈希函数大于等于3时,CPKN-Nave协议和CPKN-s协议的隐私泄露概率都趋近于0,攻击者无法在普通传感器节点与管理节点共谋的情况获得敏感数据信息.攻击者为获得隐私数据,将尝试在俘获普通传感器节点和管理节点的同时继续俘获代理节点.然而,攻击者必须在俘获所有代理的节点的前提下才能获得所有的编码处理函数hC而获取真实数据值.图14(a)给出了当=1时,攻击者获得所有hC理节点时,攻击者即使俘获整个网络中20%的节图14si,Aθ与sPage19点,能够获得所有hC图14(b)所示,当=2时,隐私泄露的概率有所增加,这是因为同时存在的两组功能相同的代理节点增大了攻击者获得所有hC组中的代理节点数目大于等于4个时,隐私泄露的概率仍然不超过0.005.使用=2,w=4的CPKN-s协议既可以保证较低的网络能耗,又能够保证高强度的隐私保护.由以上实验结果可知,在管理节点俘获攻击和节点共谋攻击两种情况下,PKN协议和CPKN协议能够在提供高强度隐私保护的同时高效率低能耗地精确完成k-NN查询处理.7总结本文针对双层无线传感器网络中的隐私保护k-NN查询处理,分别提出了面向管理节点俘获攻击的PKN协议和面向共谋攻击的CPKN协议.在PKN协议中,我们首先基于定向存储机制提出了适用于双层传感网的KNQ查询架构,接着给出了一种隐私保护数据编码机制,通过为真实数据附加编码的方式,保证在不泄露数据隐私的同时高效的完成查询.在CPKN协议中,针对节点共谋攻击,设计了基于一系列代理节点的数据隐藏机制,通过破坏普通节点编码与管理节点编码间的关联性达到抵御共谋攻击的目的.理论分析和实验结果表明,PKN和CPKN协议能够在提供高强度隐私保护的同时保证较高的能耗性能和查询时延性能.致谢本文审稿专家和编辑老师提出了宝贵的意见和建议,在此表示感谢!本文部分工作是在作者访问中国人民大学的萨师煊大数据管理和分析中心时完成的,该中心获国家高等学校学科创新引智计划(111计划)等资助!
