Page1基于软近邻投票的图像标签相关性计算李锡荣1),2)许洁萍2)薛盛博2)杨刚2)1)(中国人民大学数据工程与知识工程教育部重点实验室北京100872)2)(中国人民大学信息学院北京100872)摘要如何自动判断社会化标签与图像内容之间的相关性是社会化多媒体内容检索领域一个重要的研究问题.近邻投票算法是已知的计算标签相关性的最有效方法之一.但该算法采用硬投票策略,并未考虑近邻图像的权重以及近邻图像自身标签的质量.针对上述问题,文中提出一种一般性的软近邻投票框架,通过考察近邻权重和近邻标签权重这两个维度,系统性地比较了23种软近邻投票实现方案.以近120万张Flickr图像为训练集、约两万张图像为测试集的实验表明,软近邻投票策略要优于硬投票策略:平均查准率从0.764提升到0.783,且软近邻投票对于近邻个数这一重要参数的选取相对不敏感.关键词图像检索;社会化标签;图像标签相关性;软近邻投票1引言每天都有大量图像被世界各地的互联网用户上传到社会化多媒体共享平台,如国外的Facebook、Flickr、Twitter和国内的网易LOFTER、新浪微博等.社会化媒体已日益成为大众获取信息的重要来源.目前,社会化多媒体内容检索主要依赖于用户自Page2发提供的标签.我们将这种用户对多媒体内容的自发标注称为社会化标注(SocialTagging),并将随之产生的标签称为社会化标签(SocialTag).由于用户存在标注动机、文化背景等多方面的差异[1-2],社会化标注具有天然的主观性和歧义性,使得标签往往与图像内容无关.如何自动判断标签与图像内容是否相关是社会化多媒体内容检索研究的一个重要问题.不同于一个单词可能会在一篇文档中出现多次,一个标签被多次赋予同一幅图像的情况是很少见的.标签的这种稀疏性使得我们无法利用文本分析中广泛使用的基于词频方法来估计标签与图像的相关性.因此,对图像内容进行分析是必须的.给定一幅图像,若与它视觉上相近的许多其他图像分别被各自所属的用户打上同一标签,则直观上该标签体现了不同用户关于类似图像内容的某种共识,从而很可能是给定图像的相关标签.近邻投票算法[3]正是基于这种想法:通过统计标签在一幅图像的视觉近邻图像所对应社会化标注中出现的次数以估计标签的相关性.该算法的优点是完全基于大量被社会化标注的图像而无需额外人工标注,并且实现简图1基于软近邻投票的社会化标签与图像内容相关性计算示意图(右侧为软近邻投票结果.对比左侧的硬近邻投票结果,软近邻投票策略因为同时考虑近邻权重和近邻自身标签质量,所以能更准确地计算标签与图像的相关性)单.近邻投票算法目前被认为是一种比较有效的社会化标签与图像内容相关性估计算法[4-7].直观上,与给定图像越相似的近邻应该被赋予更多的投票权重.但近邻投票算法[3]并没有考虑近邻的重要性,也未考虑近邻自身标签质量.我们称这种投票策略为硬近邻投票(HardNeighborVoting).文献[5]作为一种改进算法,在投票过程中根据图像视觉相似度对近邻进行加权.文献[8]通过在标签连接图上的随机游走计算标签相关性.文献[9]提出了一种语义场算法,用一个标签与对应图像中其余标签的平均语义相似度计算该标签相关性.就我们知识所及,目前尚未有文献系统性地研究近邻权重和近邻自身标签质量对于近邻投票算法的影响.为提高基于近邻投票的社会化标签与图像相关性计算的准确性,本文提出一种通用的软近邻投票(SoftNeighborVoting)框架,如图1所示.在该框架下,我们分别针对近邻权重和近邻标签质量这两个维度引入多种计算方法.通过组合这两个维度的不同实现方法,对23种软近邻投票方案进行了系统的对比研究.Page32相关工作图像与社会化标签的相关性计算问题是一个随着社会化媒体兴起而出现的新的交叉研究课题,涉及到多媒体检索、图像处理、计算机视觉、机器学习等多个领域.鉴于其在社会化媒体分析和检索中的重要性,图像标签相关性计算是当前研究热点之一.在本节中,我们简要分析最近3年的相关工作.文献[10]假设添加标签的顺序可反映出用户意图,最先被添加的标签最可能和图像内容相关.因此,标签位置被用于估计标签与图像的相关性.但文献[8]在Flickr数据上的实验表明,相关标签排在第一位的图像不到10%.文献[9]利用标签之间的语义相似度计算标签与图像的相关性.注意到上述方法不能处理单标签(即一张图像仅有一个标签).另外,由于它们未考虑视觉内容,使其性能受到了很大程度的制约.为利用视觉内容,文献[11]在近邻投票的基础上融合多种全局和局部特征.文献[12]在视觉相似性的基础上引入图像显著性分析.为了减少标签推荐中的冗余,文献[13]讨论如何平衡标签的相关性和多样性.文献[14]提出为每个标签建立基于支持向量机的分类器.文献[15]提出基于图学习的检索结果重排序方法,以改进基于标签图像检索的准确率.而文献[16]提出一种基于张量分解的算法,通过分析图像、标签、用户三者的关联,将它们表示在一个公共隐性语义子空间中.最近的对比实验表明[17],基于视觉相似性的近邻投票算法[3]仍是最有效的图像标签相关性计算方法之一,且适合于处理大规模数据.本文工作是对近邻投票算法的一种改进.3软近邻投票的一般框架本文所提的软近邻投票策略以硬近邻投票[3]为基础.出于文章完整性的考虑,我们首先给出社会化标签与图像相关性估计的形式化描述,接着在第3.1节简要介绍硬近邻投票算法,然后在第3.2节给出软近邻投票算法.我们用x表示一幅图像,用t表示一个标签.为简化符号,x也用于表示该图像对应的视觉特征向量.若一幅图像带有l个社会化标签,则记这些标签为Tx={t1,…,tl}.令f(x,t)为一个实值的标签相关性计算函数.我们的目标是构建一个f(x,t),使得当我们用f(x,t)对所有标为t的图像进行排序时,与t真正相关图像能被排到与t无关图像前面,从而实现社会化标注图像的准确检索.3.1硬近邻投票算法硬近邻投票算法[3]假设当多个用户用相同标签描述一组视觉相似图像时,该标签和该组图像相关的可能性较大.具体地,给定一张图像x,硬近邻投票算法的f(x,t)可表达为其中,xi(i=1,…,k)表示x的k个视觉最近邻.若近邻图像xi带有标签t,则二值函数δ(xi,t)为1,否则为0.如式(1)所示,所有k个近邻图片具有相同的投票权.对于一个特定的近邻图像,它的各个标签的投票权也是相同的.3.2软近邻投票算法为了改进上述硬近邻投票算法,我们提出同时考虑近邻权重和近邻自身标签权重.为此,我们将软近邻投票算法的f(x,t)定义为其中,s(x,xi)表示近邻xi的投票权重,v(xi,t)表示标签t在近邻xi中的权重.对比式(1)和式(2)不难发现,硬近邻投票是软近邻投票取s(x,xi)=1和v(xi,t)=δ(xi,t)时的一种特例.接下来,我们给出通过选取不同s(x,xi)和v(xi,t)所形成的多种软近邻投票方案.4软近邻投票的多种实现方案针对近邻权重s(x,xi)和近邻标签权重v(xi,t),我们分别给出以下5种和3种计算方法.正如我们在前文中说明的,尽管有些计算方法已在前人工作中零星使用,但目前尚未有工作在近邻投票框架下系统性地探究这些方法的价值.4.1近邻权重计算方法为了使与给定图像更相似的近邻具有更多的投票权,我们使用以下5种不同的近邻权重计算方法,其中前3种方法基于视觉相似度,后2种方法基于标签相似度.(1)近邻权重方法-1.最小最大归一化分数(Min-MaxScore).通过常用的最小最大归一化将视觉距离转换为0~1之间的视觉相似度,即Page4Smin(x,xi)=1-d(x,xi)-d(x,x1)其中,d(x,xi)表示两幅图像对应的视觉特征向量的欧式距离.文献[4-5]采用该方法.(2)近邻权重方法-2.径向基函数(RadialBasicFunction).以图像x为中心点,定义为其中,γ为频带宽度参数,根据文献[8]的经验设为视觉距离平均值的倒数.(3)近邻权重方法-3.基于排序(Rank-Based)的权重,即不同于前两种方法可能会使距离较远的近邻失去投票权,基于排序的权重允许这些近邻仍有一定的投票权.(4)近邻权重方法-4.标签Jaccard相似度.基于图像所带标签的匹配情况,即其中,Tx和Txi分别表示图像x和xi对应的社会化标签集合.注意到式(6)不能反映标签之间的语义关联.为此我们引入基于语义的标签相似度如下.(5)近邻权重方法-5.标签语义相似度:其中,sim(t,t)表示两个标签之间的语义相似度.本文采用文献[9]基于标签共现的FlickrContextSimilarity计算sim(t,t).4.2近邻标签权重计算方法一幅近邻图像可能带有多个标签,而这些标签不一定都和该近邻图像相关.为计算近邻自身的标签权重,我们采用以下3种方法.(1)近邻标签权重方法-1.标签位置(TagPosition).文献[4]假设用户在标注图像时会倾向于将与图像内容最相关的标签排在前面.基于标签位置的v(xi,t)定义为其中,r(t)为标签t在图像xi的标签序列中的排序.(2)近邻标签权重方法-2.随机游走(RandomWalk).文献[8]将一幅图像对应的每个社会化标签视为一个连接图的节点,节点间边以相应标签对的语义相似度(与式(7)相同)作为权重,通过随机游走确定标签权重.为构建随机游走所需的概率转移矩阵,文献[8]将一个标签节点ti到另一个标签节点tj的转移概率定义为(3)近邻标签权重方法-3.语义场(SemanticField).文献[9]假设一幅图像的社会化标签中的大部分是和图像内容相关的,因此一个相关标签应该和总体语义一致,表现为即用一个标签与近邻图像中其他标签的平均语义相似度作为该标签的权重.给定上述5种近邻权重计算方法和3种近邻标签权重计算方法,通过单独选取或两两组合,我们得到23种软近邻投票方案.为便于描述,我们采用下列命名习惯表示这些方案.比如Ssemantic×Vsemantic表示近邻权重方法-5和近邻标签权重方法-3的组合.类似地,Ssemantic×Vrandom-walk表示近邻权重方法-5和近邻标签权重方法-2的组合,1×Vrandom-walk表示仅用近邻标签权重方法-2,而Ssemantic×δ表示仅用近邻权重方法-5.4.3软近邻投票的计算复杂度分析相对于硬近邻投票,软近邻投票增加的计算复杂度在于近邻权重s(x,xi)和近邻标签权重v(xi,t)的计算.对比5种近邻权重计算方法,前3种方法的时间复杂度为O(1),其中方法-2包含指数函数因而其计算开销较方法-1和方法-3略大.后2种方法的复杂度取决于图像所带标签个数.假定平均每张图像带有l个标签,则近邻权重方法-4的计算复杂度为O(l).而近邻权重方法-5要计算两张图像之间所有标签对的语义相似度,所以其复杂度为O(l2).比较3种近邻标签权重计算方法,方法-1的计算复杂度为O(l),方法-3的计算复杂度为O(l2).方法-2的计算复杂度为O(ql2),其中q表示随机游走迭代次数.注意到v(xi,t)与测试图像x无关,因此可以预先计算并存储,从而在实际投票过程可通过查表得到.综合上述分析,我们可以得出23种软近邻投票方案的计算复杂度,其中含有语义计算模块的方案的计算复杂度相对较高.Page55实验与结果分析5.1实验设置实验数据.为验证软近邻投票算法的各种实现方案的有效性,我们以文献[18]的近120万幅Flickr图像为训练集,这些图像带有普通用户提供的标签.以文献[3]提供的近2万张Flickr图像为测试集进行实验①,如表1所示.该测试集为20个测试标签如airplane、beach、dog等提供了经人工校验的标准答案.对于测试集中的每张图像,我们通过计算它与训练集中每张图像在视觉特征空间的欧式距离找到k个最近邻.因此训练集仅用于产生视觉近邻.视觉特征.我们选用一种64维的全局特征[19].该特征由44维颜色自相关直方图、14维纹理矩及6维颜色矩拼接而成.实验[3,11]表明该特征对于计算标签相关性是有效的.评价指标.对于20个测试标签中的每个标签,我们用不同方案对应的标签相关性计算函数f(x,t)对含有该标签的图像进行降序排序,以定量比较各方案.评价指标为常用的平均查准率(AveragePrecision).作整体比较时,我们将报告所有20个测试标签平均查准率的均值.数据集训练集[10]测试集[3]5.2实验结果与分析实验1.近邻个数的影响.近邻个数k是近邻投票算法的一个重要参数.为比较硬近邻投票与软近邻投票对于k值选取的敏感度,我们以1000为步长,将k从1000取到20000.软近邻投票方案采用的是Ssemantic×Vsemantic组合.如图2所示,在开始阶段,平均查准率随着k的增加而增加,达到某一值后上下略微波动.两种近邻投票策略均在k=3000时性能最优.但随着k继续增大,此时不但计算量会更大,而且引入的无关图像也逐渐使平均查准率下降.综合来看,软近邻投票算法的平均查准率下降速度较硬近邻投票算法相对缓慢,且其最差结果仍优于硬近邻投票的最好结果.该实验结果说明软近邻投票算法对于近邻个数k的选取相对不敏感,从而使得算法具有更好的鲁棒性.图2近邻个数k对于软、硬近邻投票算法的影响(对比硬近邻投票算法,软近邻投票算法对于k的取值相对不敏感,且其最差结果仍优于硬近邻投票算法的最好结果)实验2.比较硬近邻投票与各种软近邻投票方案.根据实验1的结果,我们在比较各种方案时均令近邻个数k=3000.表2给出了各种软、硬近邻投票方案的实验结果.其中,硬投票算法[3]排在了第21位.以硬近邻投票结果(平均查准率=0.764)为基线,对比5种近邻权重计算方法,基于视觉距离的方法较基线略有提高.而引入标签语义信息后,性能有了较明显的提升.对比3种近邻标签权重计算方法,仅利用标签位置反而会使性能下降,而随机游走和语义场方法根据标签不同会带来不同程度的性能表2对比硬近邻投票和23种软近邻投票方案(为便于分析,我们将各方案按照其平均查准率降序排列)排序1Ssemantic×Vsemantic2Ssemantic×Vrandom-walk345Sjaccard×Vsemantic6Sjaccard×Vrandom-walk789Sradial×Vrandom-walk10Sradial×Vsemantic1112Srank×Vsemantic13Srank×Vrandom-walk14151617Smin×Vrandom-walk181920211×δ(硬近邻投票)222324①数据下载地址mediamill.nlPage6提升.比较近邻权重和近邻标签权重这两个维度,近邻权重方法的选择对于性能的影响更为显著.最佳软近邻投票方案是计算近邻权重和近邻标签权重时都使用标签语义信息的Ssemantic×Vsemantic组合(平均查准率=0.783).总体而言,软投票策略可以提高基于近邻投票的标签相关性计算准确度.我们也注意到,尽管Ssemantic×Vsemantic组合整体表现最优,但它并非对于所有测试标签都是最好的解决方案.为了更好地理解各种组合的适用范围,我们在表3中给出针对每个测试标签的最优组合.比如对于标签airplane,最好的是Ssemantic×Vsemantic.而对于标签rhino,最佳选择是Sjaccard×Vsemantic,该组合的平均查准率比硬近邻投票的平均查准率增加了0.140.最适合于标签mountain的是Sradial×Vrandom-walk.若能自动为各个标签选取最优组合,平均查准率将达到0.792,这说明软近邻投票具有进一步提高的空间.综上,若仅考虑性能,我们推荐Ssemantic×Vsemantic组合.若需兼顾性能和计算复杂度,我们推荐Ssemantic×δ组合.表3比较每个测试标签的最优组合和硬近邻投票结果标签airplaneSsemantic×Vsemantic0.7120.659beachSmin×VposboatSmin×Vsemantic0.6510.635bridgeSsemantic×Vrandom-walk0.8510.829busSsemantic×Vsemantic0.8720.854butterflySjaccard×Vpos0.9370.932carSsemantic×Vsemantic0.7380.721cityscapeSjaccard×Vsemantic0.9280.905classroomSsemantic×Vrandom-walk0.5950.565dogSsemantic×Vrandom-walk0.9080.888flowerSradial×δ0.9730.969harborSsemantic×Vsemantic0.8000.775horseSradial×Vrandom-walk0.8580.851kitchenSsemantic×δ0.7110.697lionSjaccard×Vpos0.7880.742mountainSradial×Vrandom-walk0.7810.774rhinoSjaccard×Vsemantic0.8190.679sheepSsemantic×Vrandom-walk0.7900.764streetSrank×Vrandom-walk0.6340.626tigerSjaccard×Vrandom-walk0.8370.7786结束语社会化标签与图像内容的相关性计算对于社会化多媒体内容检索具有重要意义.尽管近邻投票算法被认为是比较有效的标签相关性计算方法,但其采用的硬投票机制没有考虑近邻权重和近邻自身标签的质量.针对上述问题,我们研究软近邻投票策略,并以近邻权重和近邻标签权重为两个维度,系统性地比较了23种软近邻投票方案.根据在公共数据集上的实验结果,本文得出以下结论.首先,软近邻投票算法要优于硬近邻投票算法:平均查准率从0.764提高到0.783,并且软近邻投票对于近邻个数这一重要参数的取值更具鲁棒性.其次,对比近邻权重和近邻标签权重这两个维度,前者对于性能提升的作用更大.最后,在所有软近邻投票方案中,基于标签语义相似度的近邻权重计算方法和基于语义场的近邻标签权重计算方法是最佳组合.我们注意到有些整体效果一般的软近邻投票方案在个别标签上却有很好的表现.如何为特定标签自动选取合适的近邻投票方案将是值得进一步探索的课题.致谢感谢第九届和谐人机环境联合学术会议(HHME2013)评审专家对本文提出的宝贵修改意见!
