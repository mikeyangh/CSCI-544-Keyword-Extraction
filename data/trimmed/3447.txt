Page1一种基于三维直方图和RFKCN的图像分割方法陈子阳1)王保平2)1)(燕山大学信息科学与工程学院河北秦皇岛066004)2)(西北工业大学无人机特种技术国防重点实验室西安710072)摘要该文提出了一种基于三维直方图和抑制式模糊Kohonen聚类网络(RFKCN)的图像分割方法.该方法分为2步,第1步是像素的模糊化,通过模糊均值和模糊中值构造两幅冗余图像;第2步是通过冗余图像和原始图像组成一个三维特征矢量集,并利用RFKCN聚类网络对该特征矢量集进行聚类,从而达到图像分割的目的.由于新方法不仅利用了图像像元点的灰度分布信息,而且充分考虑了像元点之间的灰度相关信息及其模糊信息,构造出三维特征空间,根据各信息间的竞争性、冗余性和互补性,进行有效的融合,增加了聚类分割的精确度.理论分析和实验表明,该方法具有良好的分割性能.关键词图像分割;三维直方图;边缘检测;抑制式模糊Kohonen聚类网络1引言图像分割技术是计算机视觉和人工智能领域中Page2用的一类图像分割方法.研究表明[3]:各种阈值分割法[4-11]一般是对某种特定图像的分割效果较佳,而对其它类别图像的分割效果相对较差.因此,在实际应用时,应针对具体的应用背景和给定的图像类别,选择适当的分割方法.另外,经过较深入的研究发现,当图像的信噪比较低时,几乎所有的阈值法的分割效果均不能令人满意.这是因为当图像受到噪声干扰时,它们的灰度直方图不一定出现明显的代表物体和背景的峰,此时选择出来的阈值并不能使图像分割得到满意的结果,往往会产生较大的分割错误.由于仅仅基于灰度值的阈值化方法并没有利用图像中的所有有用的信息,因此人们希望是否能利用图像像素在空间上的相关信息来改善分割性能.在文献[12]中,Ahuja等人使用了所谓的犕矩阵方法,用来使直方图中的峰更加尖锐,而谷更加深凹.但这种方法不能自动选择阈值进行图像分割.针对这点,文献[13]中,刘健壮和谢维信考虑了图像像素间的相关信息,构建了图像的二维直方图,然后利用模糊C均值(FCM)聚类算法对二维直方图中的点的分布进行模糊聚类,最后根据各像素的隶属度进行像素分类,实现图像分割.该方法的分割效果较之使用一维直方图的方法有较大的改善.但该算法仍有一定的不足之处:(1)该方法没有考虑图像中所固有的模糊信息.(2)由于图像像素空间较大,即使用的模糊C均值(FCM)算法进行聚类的数据量较大,迭代空间也较大,因而运算时间较长.为此,本文提出了一种基于三维直方图和抑制式模糊Koho-nen聚类网络(RFKCN)的图像分割方法.该算法既利用了像点的灰度分布信息和邻域空间相关信息,也利用了图像所固有的模糊信息.另外,该文通过采用新的模糊算子及变换迭代空间,大大地加快了网络收敛的速度.克服了模糊C均值(FCM)聚类算法收敛速度慢及计算量大等缺点.2基于三维直方图的图像分割算法2.1构造原图像的模糊冗余图像2.1.1图像的模糊集表示依照模糊集的概念,一幅大小为M×N、灰度级为L的图像犡=[x(i,j)]M×N,可以表示为一个M×N的模糊集矩阵:矩阵中的各个元素μij/xij表示图像中像素(i,j)的灰度xij相对于某个特定的灰度级x的隶属度,隶属度与灰度值之间的关系为μij=T(xij)=[1+u-xij/u]-v,其中u与v是两个确定隶属度函数μij形状的参数,它们的取值应根据具体情况而确定,但一般应保证隶属度的取值范围在0~1之间.2.1.2模糊可能性分布(FuzzyPossibilityDistri-对于论域X上的模糊集A,其隶属度函数μA满足μA(x)∈[0,1],x∈X,则可能性分布可表示为可能性分布描述因子定义[14]为从上式可知,可能性分布描述因子实际上是隶属度函数的加权平均,其权值是它本身值,类似于概率论中的均值概念,可能性分布描述因子反映了可能性分布的平均可能性.显然0<PDDA1.2.1.3基于FPD的冗余信息图像构造方法首先产生大小为p=h×w的模板Bh×w,以模板中像素的灰度值集为论域,定义在其上的模糊集Ahw的模糊可能性分布可表示为μAhw(x1)则其可能性分布描述因子定义为其中μAhw(xi)=T(xi)=[1+u-xi/u]-v,如果令u为模板中像素灰度值的平均值,并令v=2.计算PDDAhw,将其作为模板Bh×w中心处像素xij的新隶属度μAhw(xij),然后重新计算该像素的灰度值gij=T-1(μAhw(xij)),如此循环直至模板经过所有像素为止,并生成冗余信息图像G=[g(i,j)]M×N,称之为模糊均值图像.从上述可知,模糊均值实际上是对均值的一个合理调整.其过程是,首先,定义了一个隶属度函数,该隶属度函数特征灰度值为模板中像素的平均灰度值.其次,以模板中像素的灰度值集为论域定义一个模糊集.最后,通过可能性分布描述因子计算出其最可能的分布,并通过隶属度函数的逆变换计算出最Page3可能分布对应的灰度值,即模糊均值.如果令u为模板中像素灰度值的中值,并令v=2,同理可以生成冗余信息图像犢=[y(i,j)]M×N,称之为模糊中值图像.2.2图像灰度、模糊均值和模糊中值的三维向量及三维直方图的定义设图像的尺寸为M×N,令q=M×N,则对于任意一帧图像T=[t(i,j)]M×N,可以用三维向量矩阵犜=[t(i,j)]q×3=[x(i,j),g(i,j),y(i,j)]表示,即犜=[t(i,j)]q×3=[x(i,j),g(i,j),y(i,j)]=x(0,0)g(0,0)y(0,0)熿x(0,N-1)g(0,N-1)y(0,N-1)x(1,0)g(1,0)y(1,0)x(1,N-1)g(1,N-1)y(1,N-1)x(M-1,N-1)g(M-1,N-1)y(M-1,N-1燀对于一M×N的图像犜=[t(i,j)]M×N,当采用犜=[t(i,j)]q×3=[x(i,j),g(i,j),y(i,j)]的向量表示方式时,我们定义并计算它的三维直方图.该三维直方图定义在一个L×L×L大小的正方体区域,其3个坐标分别表示图像像元的灰度值、模糊均值、模糊中值.直方图任意一点的值定义为Pslk,它表示向量(s,l,k)发生的频率,这里(s,l,k)表示(x(i,j),g(i,j),y(i,j)),且0s,l,kL.hslk表示向量(x(i,j),g(i,j),y(i,j))发生的频数,那么向量(x(i,j),g(i,j),y(i,j))发生的频率Pslk由下式确定.式中,0s,l,kL并且∑L-12.3基于三维直方图的抑制式模糊Kohonen聚类网络RFKCN2.3.1抑制式模糊Kohonen聚类网络RFKCN由于FCM算法本身存在着一定的不足之处,因而以其为核心FKCN网络也存在一定的缺陷,其中主要的缺陷之一是网络的收敛速度较慢.对此,本文提出一种抑制式模糊Kohonen聚类网络RFKCN.我们注意到,在FKCN网络中,学习率是通过对隶属度求m次幂来得到的.这种在模糊逻辑中被称为“模糊集中”的操作使得只有在u=0或u=1时,α=u,其余时候都是α<u.对u进行这种操作的目的在于能够有效地减小低隶属度样本对聚类中心的影响.但是,这种操作同时也不同程度的削弱了最大隶属度样本在修正聚类中心时所起的作用,从而减缓了网络的收敛速度.由此,本文提出一种新的“模糊算子”,该算子表述如下综上分析可知,该算子不仅能够有效的减小低隶属度样本的学习率,还相对的增大了最大隶属度的学习率.即可以通过“放大”最大隶属度,“抑制”其它隶属度来提高分类速度.2.3.2基于三维直方图的抑制式模糊Kohonen聚由于图像的像素空间是巨大的(一幅256×256的图像就有64k个像素),因此基于像素空间的迭代其计算量也是惊人的.尽管采用新的模糊算子能有效减少网络学习的迭代次数,但要进一步减少计算开销,就必须设法缩小样本空间从而减小单次迭代的计算量.对此,本文通过三维直方图的使用而变换迭代空间,使单次迭代的时间大为减少,从而进一步加快了网络收敛的速度.J(Uslk,V)=∑c为了使上式最小,可以利用拉格朗日乘数法对其求条件极值,分别得出下面两式:vi=∑L-1使用三维直方图后,图像分割的目标函数如下:uslk,i=∑c由于图像的三维直方图hslk表示向量(s,t,k)发生的频数,它实际上反映的是图像中灰度值、模糊均值和模糊中值组成的矢量中,该矢量相同的那些像素的个数.以往的算法是分别求出其隶属度和权值,其实这是不必要的,因为它们的特性是相同的,据此,本文利用三维直方图的统计特性,只需一次运算就可以求出具有相同矢量的那些像素的隶属度和权值,从而使单次迭代的次数得到了一定的压缩.Page43实验结果及分析为了证明本文方法的有效性,我们分别用一些图像进行了仿真实验.现以以下几幅图像为例,进行说明和比较.实验1是利用被污染的图像作为输入,实验时,首先利用不同的特征提取方法对图像中的所有像素进行多维特征提取,以每个像素的多个特征组成一个特征矢量,这样就得到一组数据样本,显然数据样本的个数等于整幅图像中的像素个数,接着利用本文提出的基于直方图的抑制式模糊Kohonen聚类图1在利用不同的图像特征的情况下,使用RFKCN法的分割效果比较为什么会出现这样的结果?是因为过去人们所提出的各种阈值分割方法,大多是从图像的灰度分布直方图上进行的,使用这种方法在噪声的干扰下通常并没有得到满意的结果.分割效果不好的关键原因就是在一维直方图中,物体的分布和背景的分布已经相互重叠,如图2所示,此时直方图只有一个峰,这就使得许多分割方法的前提假设不成立.但如果考虑到每一图像像素与其邻域像素的相关性,增加新的像素特征,组成维特征矢量,使得在一维矢量空间中未显现的特征在维矢量空间中显现出来.例如,通过对原图像进行邻域平均得到另一“平滑图像”,由原图像和平滑图像构造出一个二维直方图,如图3所示,那么物体和背景的分布在二维直方网络RFKCN对该组数据样本进行聚类,从而达到图像分割的目的.实验1的结果如图1所示.图1(a)为原图像,其大小为180×180、灰度级为256,该图像由物体(圆)和背景两部分组成,其中背景灰度值为100,物体的灰度值为160.图1(b)为原图迭加了一个高斯噪声N(0,σ2)(σ=30)后的图像.图1(c)是仅利用图像的灰度值组成一维特征数据,然后利用本文方法的分割结果.可以看出分割的效果较差,错分的点较多.图1(d)是用图像的灰度值和图像的邻域均值组成的二维特征数据,然后利用本文方法的分割结果.可看出相对于利用一维数据时,分割效果有较大的改善.图中就会比在一维直方图更容易区分.因此,利用二维直方图进行图像分割一定会产生更好的效果.Page5图1(e)是用图像的灰度值和本文首次提出的模糊均值组成二维特征数据样本集,然后利用本文方法的分割结果.可看出分割效果相对图1(d)又有一定的改善.为什么同样提取的是二维特征且用同一种算法,但分割效果却有较大的差别.究其原因关键是我们通过模糊均值的引入,利用了图像中所固有的模糊信息,提取出了更加有效的图像特征,因而图像的分割效果较好.图1(f)是用图像的灰度值和本文首次提出的模糊均值和模糊中值组成三维特征数据样本集,然后利用本文方法进行图像分割的结果.由于通过模糊中值的引入增加了像素新的独立特征,因而进一步减少了分类错误,分割效果相对图1(e)又有了一定的改善.图4不同方法的分割效果比较4结论本文针对FKCN在图像分割应用中的缺陷,提实验2是利用大小为256×256的坦克图像作为输入,实验中采用三维直方图将其分为3类,实验结果如图4所示.图4(a)是坦克的原图像,图4(b)是利用图像灰度值、模糊均值和模糊中值组成三维特征后,FKCN的分割结果.图4(c)是在利用上述相同的特征后,利用本文提出的基于三维直方图的抑制式模糊Kohonen聚类网络RFKCN进行图像分割效果.可以看出其分割效果均较好,而且二者分割效果几乎相同.但其进行图像分割的速度却相差很大,见表1.通过2.3.1节可知,FKCN是KCN和FCM有机地结合,这种结合避免了分割结果与样本顺序相关的缺点,但是FKCN的收敛速度比较慢,为此本文进行了相应的修改,较成功的解决了速度问题.图4(d)和图4(e)均是利用图像灰度值、均值和中值组成三维特征后,并分别利用FKCN和RFKCN的分割结果.可以看出不如利用图像灰度值、模糊均值和模糊中值组成三维特征的分割结果好.综上可知,新方法不仅具有模糊Kohonen聚类神经网络的优点,而且在保持分类效果不变的情况下,采用了新的模糊算子和变换迭代空间,从而加快了网络的收敛速度.另外,由于新方法提出了一种更加有效的特征提取方法,准确提取出了图像像素新的独立特征,增加了分类的精确性.出了一种新的算法,即基于三维直方图和抑制式模糊Kohonen聚类网络RFKCN.该算法通过采用新的模糊算子和通过直方图变换迭代空间大大的加快了网络的收敛速度.另外,该算法通过模糊均值和模Page6糊中值的引入,在图像分割中不仅利用了图像像元的灰度分布信息,而且也利用了像元的邻域空间相关信息及其模糊现象.实验证明,利用该聚类网络进行图像分割,可以减少人为的干预,且较适合图像中存在不确定性和模糊性的特点.对于低对比度、低信噪比的目标,新算法具有良好的分割效果.算法迭代次数单次迭代时间/s运行时间/sFKCN68RFKCN15
