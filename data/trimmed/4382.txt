Page1适用于广播监视的视频水印协议刘丽1)赵学民1)彭代渊2)高悦翔2),3)1)(郑州航空工业管理学院计算机科学与应用系郑州450015)2)(西南交通大学信息科学与技术学院成都610031)3)(四川师范大学计算机科学学院成都610068)摘要数字水印技术被广泛应用于多媒体版权保护、广播监视等领域中.在广播监视中,广告商首先在他的广告中嵌入水印信息,之后把该广告发送给广播电视台.为了防止双方可能产生的欺诈,对一段广告、嵌入的水印能够做出双重认证是必不可少的.论文就双重认证提出了一种适合应用在广播监视中的协议,该协议在加密域完成水印的产生和嵌入.协议在加密时应用一种同态公钥密码技术,同时利用嵌入的信息绑定广告、嵌入的水印和本次交易.应用提出的协议,最常见的问题如消费者的权利问题和非绑定问题都可以被解决,甚至广告商或广播电视台的欺诈行为也可以预防.关键词鲁棒水印;广播监视;水印协议;同态公钥密码1引言在当今社会,几乎所有行业数字产品的广播都是通过电视广播进行的,例如新闻、电影、广告等传媒行业以及其它许多行业.电视广播是分时段的,且某些时段的购买费用相当高,因此,在广播监视环境中,对于广告客户自己拥有的从广播公司买下的全部广告时间是必须要确认的.与此同时,广告公司付给演员应得的版税也是要确保的.另外,对持有作品版权的人来说,也不会被侵权电台非法转播他们的所有物.数字水印可以用来加密鉴别信息,它可以应用在广播监视中.欧洲有一个ESPRIT项目———VIVA(VisualIdentityVerificationAuditor)①,该项目是研究在专业的电视广播监视系统[1-2]中运用数字水印技术.但是,简单的水印不足以作为合法的证据指控有责任方,必须要有一个性能良好的水印协议与之配合才可以指控责任方.在水印框架中引入水印协议最先是由Qiao等人在文献[3]中提出的,其主要目的就是解决关于版权所有者问题以及消费者权利保护问题.目前,已有研究人员提出了一些水印协议,这些协议都是在现有水印算法的基础上提出的,并且协议中水印的嵌入过程通常在加密域完成.在这样的情况下,由于卖方不可能知道准确的水印,所以他不能用这种含水印的副本去鉴别买方.假如买方分发了一个非法复制品,这个复制品只要被察觉,卖方就可以证明买方有罪.Memon和Wong在文献[4]中提出一种水印协议,该协议最早解决了消费者权利问题,然而它仍然存在缺陷:该协议不能解决非绑定问题,它不能将待嵌入的水印信息、原始载体和本次交易绑定在一起.所以就会出现这样一种情况:如果卖方从市场上发现了一个盗版作品,他可以从该作品中提取水印,并将其嵌入到一个价格不菲的作品中,以获得高额赔付.除此之外,此协议在认证仲裁时必须要有买方参与,如果买方不愿意参与仲裁,那么我们就有理由怀疑他.这是因为在多数国家的法律文件中规定:若被告有罪,原告是有责任去证明的.在Memon和Wong提出的协议中,买方同卖方及水印认证权威机构的通信联系在业务往来的过程中是必不可少的,如此一来就增大了买方的花销.为了处理好上面提及的非绑定问题,同时为了保护在业务往来过程中买方的隐私,文献[5]中提出一种匿名的水印协议.该协议仍有以下缺点:两个能够实施安全鲁棒水印程序的可信网络实体是双水印插入的必要条件;双水印的嵌入必将降低媒体的视觉/听觉质量;在适用于版权保护的数字水印技术中,嵌入第二个水印的一方也可以说版权是他的,这就是所谓的歧义攻击.基于加同态公钥密码技术,Kuribayashi等人在文献[6]中提出一种可用于操作跟踪的数字指纹协议;在互联网上,认证中心的数字证书对买方来说是无法获知的,而且买方也不能独立执行一些安全操作,针对此问题,文献[7]提出一种保护Web内容的水印协议.近几年又出现了一些新的水印协议[8-10],这些协议有的适合应用于网上交易,有的适合应用于版权保护,但是它们都不适合应用在广播监视环境下.到目前为止,鲜有适用于广播监视环境下的视频水印协议出现.本文就广播监视环境中经常出现的问题,提出一种适用于该环境下的视频水印协议,提出的协议采用了一种新的同态公钥密码技术.2同态ElGamal公钥密码体制在协议的设计过程中,加密技术如果仅采用加同态或乘同态的公钥密码,肯定会在一定程度上限制水印算法选取的灵活性.举个例子,ElGamal是一种拥有乘同态性质的密码体制,所以在利用加同态密码的水印协议[6]中,不适合采用ElGamal密码体制.下面我们将借助于同态转换的方法[11]来增加水印协议设计中水印算法选取的灵活性.本文对具有加同态本质的ElGamal公钥密码的变异进行详细说明如下:随机选取一大素数n,假设g是Zn上一个生成元.针对公钥y,存在一私钥x∈Zn-1,满足y=gxmodn.加密过程:假设明文为gm,0gmn-1,选取一随机数r(r∈Zn-1),并根据式(1)计算密文:其中解密过程:从密文中抽取两部分,按照式(2)破解加密密文:①IVAhomepage.http://www.intec.rug.ac.be/Research/Page3D(E(m,r))=B·C-x=(gm·yrmodn)·(g-x·rmodn)然后对式(2)所得结果计算对数得到原始信息:因为E(m1,r1)·E(m2,r2)=(B;C)·(F;G)=(B·F;C·G)因而上面的公式算法有加同态的性质.假若犡={x1,x2,…,xi}为特征向量,该特征向量是从数字视频片段中抽取出来的.犠={w1,w2,…,wi}是即将嵌入的水印向量,这里ij.可以用式(3)表示水印的嵌入过程:这里犡表示嵌入水印后视频的特征向量,表示水印的嵌入操作,对操作来说,不管是用ElGamal乘同态性质的公钥密码,还是采用ElGama加同态性质的公钥密码的变异,都有式(4)存在.EK(犡)=EK(犡犠)=EK(犡)·EK(犠)(4)3广播监视应用中的视频水印协议消费者的权利得到保障不仅仅是广播监视唯一要做的事情,如何保证广告的播放质量也是必须要做的.为了提高广告的播放质量,应尽量避免双水印的嵌入.近些年,数字水印技术被广泛应用于各种领域,但是在这些领域中会产生一些欺诈行为.例如:在广播监视环境中,广播电视台提取出合法广告商的水印,并将该水印嵌入到其他广告商的广告中,然后代之播放,而广播电视台却依然向合法的广告商收取这一时段的广告费用,获取更大的利润;广告商利用非法的水印替换掉合法的水印,然后诬告广播电视台在他没有购买的时段播放了他的广告,以逃避缴费和应该支付给演员的版税.为了在纷争与冲突产生时找出并确定应该负责任的一方,本文提出的应用于广播监视的视频水印协议由水印协议、监视协议和认证仲裁协议这3个子协议组成.下面分别用B、S、BMB、WCA代表水印协议中涉及到的广告商、广播电视台、监视服务商和水印认证权威机构.这里假设BMB和WCA均为可信的权威机构.图1显示了B、BMB、WCA和S之间的交互方案.这里需要说明的是(7.1)与(7.2)需同时执行或者(7.1)要在(7.2)之前执行.3.1提出的水印协议B和S在执行该水印协议前首先要商议签订一个合同(以下记为ARG).B和S要遵守的权力、义务、广告所涉及到的信息(如购买的时段、购买的花费)等都必须写在合同中.这样,即将播放的广告和本次交易就被该合同绑定在了一起,该ARG也可以看成是B和S之间签订的一个订单.我们假设S将之前与它产生的所有订单ARGs,以及广播电视台所要播放的所有广告的目录都挂在它的主页上,并且所有与之签订过订单的广告商都可以匿名访问.协议执行过程中的水印嵌入和检测方案采用文献[12]中的算法.(1)B随机产生一个密钥对(KB,KS)(其中KB为公钥,KS为私钥),并将以下信息发送给WCA:身份证明IDB、公钥KB、ARG、SignKS(IDB,ARG,T)(其中SignKS(M)表示用私钥KS对M进行签名),同时请求一个合法标识V.T具有双重身份,可以是随机数也可以是一个时间戳,它只能用于唯一标识一次会话.(2)当B把消息发送给WCA之后,WCA先验证签名是否有效,且在签名验证通过之后先创建B的信任状,之后任意选取一合法标识V.并在此基础上计算EKB(V)、SignWCA(EKB(V),KB,EKB(ARG),T),再把计算的结果发送给B(其中SignWCA(M)表示用WCA的私钥对M进行签名;EI(·)表示用公钥I加密的函数).(3)当B接收到WCA发送过来的消息后,将身份证明IDB、ARG、SignKS(ARG)、EKB(V)、SignWCA(EKB(V),KB,EKB(ARG),T)与广告X(即将要播放的广告)一起发送给BMB.(4)收到B发送过来的信息后,BMB首先验证Page4签名的有效性.如果有效,即可根据某个广告片段犡去计算视频Hash值H(犡),此视频Hash值是与犡唯一相关联的.计算完之后,BMB通过B的公钥KB对H(犡)加密得到EKB(H(犡)).最后通过一个置乱函数σ[13]计算出σ(EKB(H(犡))·EKB(V))=σ(EKB(H(犡)+V))即可得到加密后的水印.这里E(·)采用的是第2部分提出的ElGamal同态公钥密码技术,直接在加密域嵌入水印,即EKB(犡)=EKB(犡犠)=EKB(犡)·EKB(犠),其中可以是两种方案———加性嵌入方案或乘性嵌入方案.然后,BMB发送EKB(犡)给B,并且存储B的以下信息到交易记录表Table中:IDB、KB、ARG、SignWCA(EKB(V),KB,EKB(ARG),T)、SignKS(ARG)、EKB(V)与EKB(犠).(5)当B接收到他用自己的私钥KS解密得到的犡=DKS(EKB(犡))(即含水印的广告片段)后,将犡、SignKS(犡)发送给广播电视台S.3.2提出的监视协议B发送过来相关的消息以后,S首先对这段广告进行验证.如果验证通过,该段广告即可播放.同时,广播监视客户端软件由可信任机构BMB提供给S,用以进行对广告的监视:首先计算并提取广播电视台播放的广告中的视频Hash值H(犡)和水印犠,然后实施水印置乱的逆操作,并用高通滤波器对其结果进行滤波.最后,计算滤波后的结果与H(犡)的相关性,若相关性比某一指定的阈值大,就说明“广告已被播放”;反之,反馈“广告没有被播放”.并且BMB添加水印犠和H(犡)到Table中本次交易记录的后边.3.3提出的认证仲裁协议一旦“广告没有被播放”的消息被反馈给B,认证与仲裁协议可以起到帮忙查找与确定有责任方的作用.鉴于要体现公平性,仲裁者A必须参与,但B和S并不需要参与.在发生纠纷时,A要求BMB发送给A如下信息:IDB、ARG、SignKS(ARG)、EKB(V)、EKB(犠)、SignWCA(EKB(V),KB,EKB(ARG),T)、犠和H(犡).接下来A计算EKB(犠),并将结果与EKB(犠)比较,若结果相等就证明这是合法的水印,即此水印不是B换过的非法水印,也就不能诬告S;为了进一步锁定责任方,当EKB(犠)=EKB(犠)时,A再要求WCA和BMB分别提供水印标识V和置乱函数σ,同时要查明EKB(σ(V+H(犡)))=EKB(犠)能否成立.如果EKB(σ(V+H(犡)))≠EKB(犠),就证明S存在欺诈的行为,也就是说S用别人的广告(该广告中植入了真正的水印信息)代替B的已付费的广告播出.如果EKB(犠)≠EKB(犠),由于EKB(犠)是BMB(可信任的权威机构)从其交易记录里取得的,所以EKB(犠)肯定不会是假的,那么就只有EKB(犠)为假,即水印为非法水印.因为水印犠是从播放的广告中提取的,所以一定是B为了诬陷S将水印换成非法的水印(S不可能将水印换成非法的,因为这样做对他没有一点好处).4协议分析一个安全的应用数字水印技术的广播监视系统应该能够经受住主动攻击的干扰,应满足以下方面:(1)提出的协议对广播电视台是安全和公平的.若签名体质安全,恶意的广告商则无法将非法的水印替换成合法水印,这样S就不可能被诬陷.因为关于确切的水印信息,广告商在整个交易过程中都是无法获知的.他仅能知道整个水印信息EKB(犠)=EKB(σ(V+H(犡)))中的V,这样一来水印就不能被移除.同时在认证仲裁协议中,A会比较EKB(犠)(其中犠为提取出的水印信息)和由BMB这一可信任机构发过来的交易记录中的EKB(犠),若EKB(犠)≠EKB(犠),就说明B存在欺诈行为.(2)提出的协议对广告商是安全和公平的.一些广播电视台恶意在其它广告商的广告中使用B的合法水印,虽然B的已付费广告被替换成其他广告商的广告播出,然而这些恶意的广播电视台却仍希望收取B的这一时段的播放费用.由于本次交易的合法水印标识由WCA产生,广告片段的Hash值由BMB产生,而合法水印是由水印标识和Hash值最后一起生成的.因此提出的协议将本次交易、交易中的水印及广告绑定在了一起,解决了非绑定问题.仲裁者在认证与仲裁的时候,通过得到的H(犡)、EKB(V)以及置乱函数σ来计算EKB(σ(V+H(犡))),并将计算结果与EKB(犠)比较.如果EKB(σ(V+H(犡)))≠EKB(犠),广播电视台会被仲裁者判定有欺诈行为.(3)提出的协议能够抵御重放攻击,原因在于该协议在消息中添加了时间戳/随机数.(4)为了防止歧义攻击,并且提高广告的播放质量,提出的水印协议不允许嵌入一个以上的水印.Page5而且整个水印的生成和嵌入都是在加密域完成的,这样B、S、WCA和BMB无一方可获知水印,这样消费者的权力问题得到了解决,整个交易的安全性也得到了保证.(5)由于广告商和广播电视台不用参与仲裁,这样双方的公平性与安全性能够得到保证.5结论本文提出了一种适用于广播监视的视频水印协议.该协议不仅实现了某次交易、此次交易中的广告和水印信息的绑定,也可以解决消费者权力问题.与此同时,还可以通过同态公钥密码体制在加密域中锁定并生成和嵌入水印.这样一来,无论是B、S还是WCA、BMB都得不到准确的关于水印的信息,从而确保公平与安全的交易.文中提出的适用于广播监视的视频水印协议充分考虑了广播监视环境下B和S之间可能出现的欺诈行为,使得这些欺诈行为在水印协议执行阶段就可以被预防,当发生争端的时候,还能够通过认证仲裁协议认定责任方,追究其法律责任.
