Page1一种基于量化用户和服务的大规模网络访问控制方法刘庆云1),3),4),5)沙泓州2),4)李世明2),4)杨嵘3),4)1)(中国科学院计算技术研究所北京100193)2)(北京邮电大学计算机学院北京100876)3)(中国科学院信息工程研究所北京100190)4)(信息内容安全技术国家工程实验室北京100190)5)(中国科学院大学北京100049)摘要目前,传统的RBAC(Role-BasedAccessControl)访问控制模型在支持细粒度服务和角色迁移的可控性上存在一定不足.针对这些不足,结合开放式网络环境的实际情况,文中提出了量化服务的概念,实现了一种基于细粒度角色和服务的访问控制机制,给出了一个形式化的基于量化服务和角色的访问控制模型QSRBAC(QuantifiedServicesandRolesBasedAccessControl).该模型提供了灵活的访问控制粒度,支持对角色和服务的多角度访问控制,支持权限动态调整和条件角色迁移,可以用于大规模开放式网络环境.经测试,在百万规模规则的情况下,基于该模型的访问控制系统内存占用9.6GB以下,平均规则执行时间20μs以内.实验结果证明,该模型可以满足访问控制的效果和时间要求,它的应用显著增强了访问控制过程的可管理性.关键词访问控制;量化角色;量化服务;细粒度;条件角色迁移;信息安全;网络安全1引言近年来,随着互联网技术的迅猛发展,各种网络应用服务不断涌现,这些服务方便了人们的日常生活,提高了生产效率,但也带来了许多新的安全威胁,比如恶意软件入侵,网络带宽消耗,机密资料外泄等.而由于缺乏对网络应用的有效识别和控制能力,传统防火墙已远远不能满足用户对自身网络的安全管理需求.面对这一新的安全威胁和挑战,下一代防火墙技术应运而生.2009年,Gartner①首先定义了下一代防火墙的概念.它将网络防火墙定义为在线安全控制措施,即可实时在各个受信网络间执行网络安全策略的部件.目前下一代防火墙的研究主要包括应用流量的识别和检测研究[1]、网络访问控制策略研究[2]和面向攻击的入侵防御技术研究[3].其中,访问控制策略的研究依然是防火墙领域最为核心的问题.在下一代网络防火墙中,如何在用户和服务之间建立对应的访问控制机制并进行合理可靠的授权是安全的关键,国内外很多学者对这一问题进行了深入的研究[4-6].这些研究按照访问控制模型的不同分为两类:(1)基于信任度的访问控制模型[4].信任度是指一个实体对另一个实体的信任程度.此类模型往往通过描述不同实体间信任程度的差别进行访问控制;(2)基于用户-角色映射关系的访问控制机制[5].角色是特定访问权限的集合.此类模型往往通过将用户映射到角色从而进行访问控制.在这两类模型中,前者主要用于在自治域间协同结构松散的情况;而后者主要用于自治域间相互熟悉,存在依赖或信任关系的情况,并且因为实用性强而受到广泛关注.在基于映射的研究中,蔡伟鸿等人[6]综合前人的工作,引入了“可度量角色”的概念,提出了支持细粒度的委托授权模型.这一模型对基于角色的访问控制研究具有重要的理论价值.然而,由于网络行为逐步呈现出规模大、高并发及“服务-角色”授权关系复杂等特点,传统的基于角色或权限映射的授权关系已经暴露出了可扩展性差,可复用性低等弱点.例如,在蔡伟鸿等人的研究中,只讨论了角色的授权问题,而忽视了角色所访问的服务属性和服务的优先级问题.举例来说,在一个网络防火墙内,角色A、B都可能通过80端口访问即时通信和网页邮箱两个服务.在访问控制和委托授权模型中,A应当被禁止访问即时通信服务,而B的网页邮箱服务属于关键服务,应该优先保证.而根据现有授权模型,无法判断应该如何给A、B授权访问80端口.由此可见,忽视服务属性及服务的优先级可能导致实际应用时发生授权角色访问非法服务或者关键服务因带宽有限而被拒绝访问等问题,降低控制的有效性和灵活性.本文在蔡伟鸿等人的研究基础上重点讨论了服务和用户的属性,从研究大规模网络行为的角度出发,提出了一个基于量化服务和角色的访问控制模型QSRBAC(QuantifiedServicesandRolesBasedAccessControl).该模型研究网络行为到“角色-服务”的映射关系,在分析服务和用户属性的基础上提出了可量化服务和角色的概念.通过对服务和角色的量化,使得访问控制具有足够的可扩展性和灵活性.同时,本文在QSRBAC模型的基础上,依据量化用户和服务的思想,提出了一种细粒度的大规模网络访问控制方法.该方法通过动态评估服务和用户的属性,进而调整用户的角色,使其访问权限发生变化,以支持权限的动态迁移.上述方法的特点在于对服务和用户提供了具体的量化方法,并能够保证其属性可以进行动态变更,从而使其能够适应开放式的网络环境.实验证明,该方法相比传统方法具有更高的鲁棒性和实用价值.本文第2节介绍相关研究工作;第3节给出QSRBAC模型;第4节给出原型系统的实现和评价;第5节总结全文并讨论进一步的研究方向.2相关工作在信息安全领域的研究中,访问控制技术作为①http://www.gartner.com/Page3一种关键技术而受到研究人员的广泛关注[7].通过监控用户访问资源的过程,人们应用该技术以保证在合法时间内,合法用户可以获得足够和有效的系统访问权限[8].现有的访问控制模型包括但不限于强制访问控制模型,自主访问控制模型,基于任务、角色和信任度的访问控制模型.早在20世纪70年代,访问控制技术就已经出现并获得重视.那时,访问控制技术常常被用于保护大型计算机系统的数据集[9].基于这一安全需求,研究人员先后提出了自主访问控制模型(Discretion-aryAccessControl,DAC)以及强制访问控制模型(MandatoryAccessControl,MAC).其中,DAC模型曾被广泛应用于操作系统以及数据库中[10].然而,DAC模型的缺陷也十分明显.在这一模型中,用户的访问权限通常具有可传递性,而权限的传递过程往往是不可控的.与此不同的是,MAC模型有效提高了信息的机密性,但没有考虑对信息完整性的验证和控制问题.随着网络信息系统的发展和进步,在访问过程中,信息完整性以及权限控制的问题日益严重.此外,网络信息系统日益开放,导致用户数目不断增多且变动频繁,对授权管理的可扩展性提出了更高的要求.在上述安全需求背景下,Ferraiolo和Kuhn提出了RBAC(RoleBasedAccessControl)模型[11].RBAC模型的优势在于,它依据对工作职务的描述简化了授权管理过程,从而显著提高了这一访问控制模型的可扩展性.在RBAC模型中,用户和角色间存在多对多的映射关系,用户通过角色可以获取访问特定系统资源的权限.通过定义不同类型的角色,角色间的继承和包含关系以及限制条件,RBAC模型可以更准确地规范用户行为.基于该模型的思想,先后出现了RBAC96[12]、ARBAC97[13]、ARBAC99[14]、ARBAC02[15]和NISTRBAC[16]等.这些模型从系统的角度出发,侧重于资源的保护,但不支持资源的动态授权.随着分布式计算的发展,任务的组织进一步自动化,人们希望在任务的执行过程中可以动态授权,从而对访问控制技术提出了新的需求.Thomas等人[17]从“面向任务”的角度出发,提出了基于任务的授权控制模型(Task-BasedAuthorizationControl,TBAC),并建立了相应的安全机制.TBAC模型的最大特点是它可以对不同任务流以及同一任务流中的不同子任务提供不同的访问控制策略.这一特点使它能够满足工作流及分布式网络环境的要求.黄勤等人[18]提出了基于任务状态的转授权模型,邢光林等人[19]提出了基于角色和任务的工作流授权模型并给出了相应的约束条件.此外,针对基于角色访问控制的动态性和监管性的不足,Chakraborty等人[20]提出了基于信任的访问控制模型.该模型符合开放式的网络环境特点,但是在信任度的计算上存在不足.赵庆松等人[21]和孙波等人[22]等人从分布式转授权的角度提出了基于角色的转授权模型,较好地解决了权限传播的问题.上述研究工作主要集中在对访问主体的层次结构,操作方式以及计算环境的异构性进行分析,而忽视了访问客体(包括资源和服务)的结构特点和动态特性.随着大量新型应用和服务通过少数端口和采用少数网络协议进行通信,访问控制机制中客体的层次和特点发生了变化.这种变化要求访问控制技术能够依据服务、角色及其相关环境的特点制定相应的访问控制策略.为了满足上述要求,许峰等人[7]首次将服务的概念引入传统的访问控制方法,提出了一种基于服务依赖关系的访问控制技术,但没有考虑服务的细粒度访问控制和量化问题.例如,在图1中,假设用户John当前获得的服务为S1,S2.那么当服务动态调整时,如新增服务S3时,传统的RBAC系统需要增加服务S3及与其相关的访问控制策略.而QSRBAC系统可以以服务属性为基础进行细粒度的服务访问控制,并可以通过给不同属性赋予不同权值,达到量化服务的目的,并建立任务执行过程的安全控制机制.在前人的工作基础上,我们对服务的概念进行了延伸和扩展,提出了基于量化服务和角色的访问控制模型QSRBAC.同传统的访问控制模型比较,它的优点在于:(1)通过对用户和服务的量化,进一步简化了对访问控制对象的管理.该模型能够依据量化结果Page4对服务进行动态授权,从而较好地适应动态变化的复杂网络环境.(2)提出了一种基于映射机制的动态访问控制方法.该方法能够适应开放式的网络环境的要求,并支持细粒度的访问控制.3基于量化服务和角色的访问控制模型(QSRBAC)在传统的RBAC模型中,系统提供的用户、角色、资源、服务以及它们间的映射关系相对固定.在开放式的网络环境中,随着用户、服务和资源不受限制地接入网络,映射关系动态变化,原有假设不再成立.为此,我们提出QSRBAC模型,以适应网络环境的开放性和“角色-服务”映射关系的动态变化.3.1QSRBAC的基本概念与传统RBAC模型不同,QSRBAC模型提出了量化用户和服务的概念,以实现开放式环境中访问控制对象的动态管理.出如下定义.在给出QSRBAC模型的定义之前,我们先给定义1.可量化用户.系统中用户的集合U.U={user1,user2,…,usern}.其中,useri={uidi,uattri1,uattri2,…,uattrin}用户useri指一个可以独立访问网络服务的主体,是由用户uid和一组用户属性uattr构成.定义2.角色.系统设置的角色集合R.R={role1,role2,…,rolen},在本模型中,角色是指用户在一个系统中拥有的身份或所属组别.通常由用户的角色决定其对系统中部分资源进行操作的权力或者资格.定义3.可量化服务.系统为用户提供的服务集合S.S={service1,service2,…,servicen}.其中,servicei={sidi,sattri1,sattri2,…,sattrin}服务service是由服务sid和一组服务属性sattr标识构成.定义4.属性.属性Attr是指实体在某一方面的特点,特征和特质.在本模型中,它包括用户属性uattr和服务属性sattr两类.定义5.操作.用户对服务可以执行的操作集合OPT={opt1,opt2,…,optn}.定义6.条件.用户对服务可以执行操作时需要达到的要求Condition.在本模型中,条件是指用户为了获得指定权限应当满足的要求.它包括时间触发条件、授权次数条件等.定义7.权限.权限是对系统所提供的服务进行访问的许可.在本模型中,权限的形式化定义为Permission=(opt,service,condition),其中,服务service是访问控制的客体,操作opt是访问服务采取的方式,condition是角色被允许执行该操作时应当满足的阈值要求.定义8.会话.会话集合SESSION.会话是指用户和他所激活的角色之间的映射关系.3.2用户量化模型用户可量化是指可以通过用户属性uattr的计算结果来衡量该用户所属的角色.用户属性(例如,“地域”、“年龄”和“性别”)从不同维度刻画了用户具有的特征.根据访问控制目的的不同,选择的用户属性也不完全相同.本文以“地域”、“年龄”和“性别”等属性为例,说明用户的角色量化过程.而其量化结果决定了该用户的角色分配情况,进而影响该用户的访问权限.图2所示为本文提出的用户量化模型的结构.3.3服务量化模型服务可量化是指可以通过服务属性sattr的计算来衡量该服务的授权访问范围.服务的量化结果决定了服务的角色分配情况.这样用户对服务的访问不仅取决于用户所属角色,而且取决于该服务所具有的属性.本文提出的服务量化模型的结构如图3.Page5该模型包括服务、服务ID、属性计算及层次化服务属性.其中层次化服务属性是由属性(例如,语言、主题、交互性等)和属性域(例如,体育、社区、银行、军事等)等构成.定义9.量化服务的权限.QSA={(s,k)|s∈S∧0<ktotal(sattr)}是全部量化服务的权限集合.其中,total(attr:Attr)→N是服务的属性总量函数,k是该量化服务所包含的属性量值.kserv((s,k):QSA)→2N,该函数将(s,k)映射到其量值集.qrpsrc(qs:QSA)→2SA∪PA,该函数将量化服务映射为其权限.定义10.量化服务上的权限关系=和.(s,k)=(s,k)s=s,(s,k)(s,k){kserv(s,k)kserv(s,k),s=sx:SERVICES·(s,x)∈qrpsrc(s,k)∧xs,s≠(s,k)的用户可以访问(s,k).如果(s,k)(s,k),一个被明确授权访问定理1.量化服务上的关系是偏序关系.证明.由偏序关系的概念可知,只需证明是自反性:根据定义,(s,k)(s,k)是显然的.反对称性:自反的、反对称的和传递的.(s,k)(s,k)kserv(s,k)kserv(s,k),s=s烄x:SERVICES·(s,x)∈qrpsrc(s,k)∧烅xs,s≠烆(s,k)(s,k)kserv(s,k)kserv(s,k),s=s烄x:SERVICES·(s,x)∈qrpsrc(s,k)∧烅xs,s≠烆若式(1)、(3)成立,则有(s,k)=(s,k).图4QSRBAC模型结构若式(2)、(4)成立,根据式(2),sxs并且s≠s,则s>s.根据式(4),sxs并且s≠s,则s>s.产生矛盾,所以式(2)和式(4)不可能同时成立.显然式(1)、(4)不可能同时成立,式(2)、(3)不可能同时成立.(s,k)(s,k)∧(s,k)(s,k)(s,k)=(s,k).(s,k)(s,k)依据上述证明,传递性:kserv(s,k)kserv(s,k),s=s烄烅烆(s,k)(s,k)kserv(s,k)kserv(s,k),s=s烄y:SERVICES·(s,y)∈qrpsrc(s,k)∧烅ys,s≠烆根据式(5)、(7),当s=s时,kserv(s,k)kserv(s,k).根据式(6)、(8),则有s>s>s,z:SERVICES·(s,z)∈qrpsrc(s,k)∧zs,s≠s.综上可知,(s,k)(s,k).从而证明该式是可传递的.量化服务在服务关系=和下形成了服务的层次结构.该层次结构依赖于服务的属性关系和属性值.量化服务是对RBAC模型中服务结构的扩展,可以表示其任意部分.适用量化服务作为服务对象提供了灵活的访问控制粒度,同时避免引入过高的管理和维护代价.3.4QSRBAC模型QSRBAC模型从服务和用户的量化出发,是传统RBAC模型的一种扩展形式.它包括基于量化服务的访问控制视图和基于量化角色的访问控制视图两个部分.本文提出的QSRBAC模型结构如图4.Page6定义11.QSRBAC模型.QSRBAC={U,R,S,Attr,OPT,Condition,Permission,SESSION},其中,U是用户集,R是角色集合,S是服务集合,Attr是属性集合,OPT是操作集合,Condition是条件集合,SESSION是会话集合,Permission是权限集合.定义下列关系:(1)用户分配关系(UserAssignment)是一种从用户到角色的多对多映射关系,记为UA,UAU×R.(2)权限分配关系(PermissionAssignment)是一种从访问权限到角色的多对多的映射关系,记为PA,PAR×P;Passigned(r:R)→2P,表示一个将角色映射到其分配的权限的函数,(3)用户-属性映射关系(UserAttributeMap)是从属性到用户的多对多的映射关系,记为UAM,UAMU×Attr;ownuattr(u:U)→2Attr表示一个将用户映射到其拥有的属性的函数,ownuattr(u)={attr∈Attr|(u,attr)∈UAM}.(4)服务-属性映射关系(ServiceAttributeMap)是从属性到服务的多对多的映射关系,记为SAM,SAMS×Attr;ownsattr(s:S)→2Attr表示一个将服务映射到其拥有的属性的函数,ownsattr(s)={attr∈Attr|(s,attr)∈SAM}.(5)条件角色迁移(ConditionalRoleTransition),是指用户在执行授权的过程中,根据触发条件而产生的用户属性变化,致使其所属角色发生变化的过程.系统根据用户当前的状态统计和触发条件,动态调整用户所属的角色.条件角色迁移是访问行为统计和属性动态评估的结果.(6)动态授权关系(DynamicAccess),是指在授权过程中依据授权迁移状态和角色拥有的访问权限,访问控制系统可以动态地决定角色的实际执行权限.其中,判定角色的当前授权迁移状态state(r,t)采用以时间为自变量的决策函数PD,state(r,t)=PD(t,state(r,t-1)).定义12.量化用户信任度.设Γu(uattr,t)表示访问控制系统对量化用户u的信任评价,称为量化用户信任度.令Γu(uattr,t)=∑n中uattr是用户属性集合,Yi(uattri)是第i个用户属性值,mi是第i个用户属性的重要程度,t是时间戳.为了提高信任度评估的准确性,把一段时间分为若干个时间戳,时间戳反映了某一个时刻量化用户u的信任度,信任度随时间的变化而变化.量化用户的信任度是属性计算的结果,也是用户权限分配的依据.一般情况下,信任度越高的用户,其获得的访问权限也越高.定义13.量化服务信任度.设γs(sattr,condi-tion)表示访问控制系统对量化服务s的信任评价,称为量化服务信任度,令γs(sattr,condition)=∑nmiYi(sattri),其中sattr是服务属性集合,Yi(sattri)i=1是第i个服务属性值,mi是第i个服务属性的重要性程度,condition是触发条件.服务的信任度是属性计算的结果,是权限分配的依据.定义14.总体信任度.设(uattr,sattr,t,condition)表示用户和服务的总体信任评价,称为总体信任度.令(uattr,sattr,t,condition)=Γuγs,表示矩阵的乘积.总体信任度的高低是此次访问是否会获得授权的重要判断标准.定义15.用户服务授权.设授权可分为P个决策S={s1,s2,…,sp},信任空间记作C,表示为C={c1,c2,…,cp}.信任空间C具有如下性质:ci∩cj=(i≠j)且c1<c2<…<cp,即ck+1比ck大.则C是一个有序分割类,S和用户信任度及服务信任度之间的映射函数Ψ,称为用户服务授权.它可以表示为Ψ(Γuγs)=sp,cpΓuγs1烄…sk,ck-1Γuγsck烅…s1,0Γu(uattr,t)×γs(sattr,condition)c烆当用户u向访问控制系统请求服务时,首先要根据量化用户u的信任度Γu(uattr,t)决定它能得到的服务可信度区间.这样既可以分级对不同用户提供不同信任度的服务,也有利于使用服务量化的结果对服务作细粒度访问控制.综上所述,QSRBAC模型的访问策略是由角色、服务、触发条件共同确定的.而上述部件之间的Page7关系则由系统管理员统一配置决定.3.5访问控制策略分析作为一种动态访问控制模型,QSRBAC模型可以随时间和上下文的变化而变化.在这一模型中,角色获得服务访问权限的过程也是动态交互的.访问控制系统依据当前的限制条件和授权结构体的状态进行综合判断,从而确定是否允许角色对服务的这一访问.在QSRBAC模型中,用户获得系统访问授权的途径有3种:权限分配、条件角色迁移以及动态权限调整.(1)权限分配权限分配过程是指将角色和对应的访问权限分配给用户的过程.这一过程包含角色分配和访问权限分配两个操作.其中,角色分配用二元组〈u,r〉来表示,记作ua(u,r),角色r所包含用户的集合记为UA(r).UA(r)={ua(ui,r)|ua(ui,r)∈UA,i=1,2,…,n}.而系统中中角色的访问权限主要表现为访问服务的能力,进而权限的分配关系PA(PermissionAssignment)可以用二元组〈r,s〉来表示,记为pa(r,s).类似地,如果角色被授予一组权限,则记为PA(r).PA(r)={pa(ui,r)|pa(ui,r)∈PA,i=1,2,…,n}.(2)条件角色迁移当用户被分配角色以后,系统依据权限分配结果给该用户分配权限.当他的状态统计结果满足系统触发条件时,其用户属性发生改变,用户所属角色发生迁移.条件角色迁移过程包括用户属性变更和角色迁移两个步骤.当用户属性attr(u)变更后,触发用户所属的角色Role(u)的重新计算.其中,Role(u)=func(attr(u)).(3)动态权限调整在QSRBAC模型中,其基本的授权结构体AU={User,Role,LF},其中LF表示该授权结构体的生命周期.当授权结构体被触发时,它的生命周期开始进入倒计时,在AU的整个生命周期中授权始终有效.但当授权超过生命周期时,系统则认为该授权结构体的授权无效.3.6QSRBAC模型的访问控制算法在QSRBAC模型的基础上,将量化服务的计算过程引入访问控制模型中.在某一个应用系统内,用户user访问服务service的授权结果Auth(user,service)是通过算法1获得.在算法1中,用stream表示流量(流量中包含用户user,服务service),policy表示策略,uid和sid分别表示用户和服务的身份信息,uattr和sattr分别表示用户和服务的属性信息,cache表示缓存信息,server是服务器,用于保存用户和服务的信息库.算法1.基于量化服务和角色的访问控制算法.输入:stream,policy输出:Auth1.functionAccCon(stream,policy)2.Auth←;3.uid←fextractu(stream);4.sid←fextracts(stream);5.uattr=FINDATTR(cache,serveru,uid);6.sattr=FINDATTR(cache,servers,sid);7.Auth=Inquire(uattr,sattr,policy);8.returnAuth9.endfunction10.functionFINDATTR(cache,server,id)11.i←0;12.attr←;13.block←sizeof(AttrSet);14.whilei<cache/blockdo15.ifattr=then16.attr=lookup(block[i],id);17.break;18.endif19.i++;20.endwhile21.ifattr=NULLthen22.attr=lookup(server,id);23.endif24.returnattr25.endfunction函数AccCon通过对stream和policy进行分析,判断当前流是否需要采取何种控制措施.在这个函数中,有3个子函数.其中,fextract是通过对stream的信息进行分析,解析出用户和服务的id信息.FINDATTR函数根据用户和服务的id信息与cache和server中保存的信息进行比较,输出查询到的属性信息attr.Inquire函数,依据服务和用户的属性信息attr以及系统策略policy查询策略,判断应当采取的控制措施.此外,lookup函数通过对缓存指定块block或服务器server进行查询,返回用户或服务的属性值attr.3.7QSRBAC模型的优点同传统的RBAC模型进行比较,QSRBAC模型Page8具有下述优势:(1)支持权限动态调整传统的RBAC模型以静态分配为主,并不涉及权限的动态调整.通过引入授权结构体及它的生命周期,QSRBAC模型支持权限的动态调整,符合连续变化的网络环境的要求.在QSRBAC模型中,系统对用户的状态进行统计,结合触发条件将统计结果反映在用户的属性变更上.通过重新计算用户的属性,系统可以将新的角色及其访问权限分配给用户,从而达到用户的条件角色迁移.通过这样的设计,QSRBAC模型能够更好地适应开放式的环境.特别地,当用户属性不明确时,系统无需为用户创建临时角色,通过访问结果的统计即能达到分配角色和访问控制的目的.(2)支持服务动态扩展和更新通过引入服务属性和可量化服务的概念,QSRBAC模型可以方便地对服务的种类和数目进行扩展和更新.对比RBAC模型,引入属性的概念对角色和服务进行统一量化和封装,可以使开放式网络环境中服务的可扩展性更强,同时该模型提供了更加方便的安全管理方式.(3)提供粒度可控的访问控制关系管理对服务属性的多层次划分使得QSRBAC模型对服务和用户的细粒度访问权限控制成为现实.此外,由于采用层次化的服务属性,服务的访问控制粒度的大小可以由安全人员自行控制,以应对不同的访问控制需求.3.8QSRBAC模型的应用场景随着网络环境的日益开放,一方面,各种网络应用和服务层出不穷;另一方面,大量用户动态地接入网络.因此,人们对访问控制的可扩展性和安全性提出了更高要求.这恰恰是传统的基于角色的访问控制技术所不能满足的.而QSRBAC模型适用于面向开放性网络服务的系统,尤其适合于复杂授权关系下的大规模访问控制系统.3.9访问控制性能分析在传统的DAC、MAC、RBAC和TBAC模型中,某一类服务(资源)Sr往往作为一个整体参与访问权限控制,即一旦将Sr的权限赋予某一角色,该角色将获得Sr中所有服务的访问权限.在开放式的网络环境中,这种机制违背了“最小特权”原则.在表1中,给出了QSRBAC与传统模型在访问控制性能方面的对比.从表1中可知,相比于其他传统模型仅支持授权主体(即用户)的访问控制粒度,QSRBAC还支持授权客体(即服务或资源)的访问控制粒度和层次性,因而能很好地满足用户在细粒度访问控制方面的需求.此外,通过在角色信任度的量化过程中引入时间戳的概念,模型的可管理性和可控性得到了进一步提升.表1QSRBAC与DAC、MAC、RBAC和TBAC的性能对比模型角色粒度QSRBAC√√√√√√√DAC√×√××××MAC√×√××××RBAC√×√××××TBAC√√√××√√4模型的应用4.1原型系统的实现目前,QSRBAC模型已经在开发的一个基于用户和服务的网络防火墙系统中得到了应用.在该系统中主要类别的服务数如表2.类别总数/类覆盖总数/条435028656741339128305从表2可以看出,系统目前能够预设了43类服务,覆盖了超过5万个常用服务.4.2原型系统的评价本文分别从系统的覆盖能力,准确性和系统的处理性能对这个原型系统进行测试和评价.该访问控制系统对网址的识别覆盖率和划分准确率的测试.识别覆盖率是指系统识别的URL数目占输入URL的百分比,划分准确率是指系统正确识别的URL数目占所有识别URL数目的百分比.首先,本文采集了著名的导航网站hao123的网站分类结果(30个类别,共1776个URL)作为标注样本集.然后,取出其中四个典型类别,将服务分类结果同系统服务的量化结果作比较,其结果如表3所示.由表3可知,在最坏情况下,识别覆盖率能够达到91.6%,划分准确率达到84.6%,符合大多数系统的访问控制要求.Page9类别识别覆盖率/%划分准确率/%测试URL数目体育100.0社区91.6军事100.0银行92.8性能测试,实验环境为8核主频为2.13GHz内存大小为16GB的服务器.下列实验主要测试了在不同规模的访问控制规则和复杂规则占比不同的情况下执行规则的时间和内存使用情况.这里的规则主要包括访问者、访问资源、条件和控制策略(例如通过、阻止)等4部分.由于复杂规则在精细化控制过程中经常使用,具有很强的现实意义.所以在实验过程中,引入复杂规则的概念.在实验中假设访问控图5系统执行时间随规模和规则组成的变化趋势图6表示了不同规则规模和复杂规模占比的情况下访问控制系统的内存占用情况.图6(a)显示,系统占用内存随着规则规模的扩大而扩大.图6(b)显示,当复杂规则占比为0.8,规则规模达到280万条时,系统占用内存达到9.6GB.从内存的角度来看,内存与规则数目大致呈线性关系.复杂规则占比越大,系统占用内存越多.这是由于系统的首要需求制系统中只有复杂规则和简单规则两种.在实验中设计的复杂规则所涉及区域是简单规则的6倍,用p表示复杂规则数占规则总数的比例.下面从时间和内存使用量两个角度来考察系统在不同规则规模情况下的性能,实验效果如图5、图6所示.图5表示了不同规模和复杂规则比例情况下执行规则所需的时间变化情况.为了全面检查系统性能,对每种情况独立运行10000次,以统计执行时间的分布情况.由图5可知,当规则规模小于300万条的情况时,执行规则的时间一般在20μs以下,且不随时间线性增长.系统执行规则时间的分布随复杂规则比例的增加而变得稀疏,复杂规则比例越大,执行时间越长.但系统的平均执行时间基本不变.是保证系统执行规则的时间尽可能短,访问控制的效果尽可能好,因而在内存中保存了规则的一部分信息.因此,它满足真实应用场景下的实际需求.从功能测试和性能测试的结果来看,该原型系统基本能够完成大规模网络行为的访问控制任务,在进一步扩大服务覆盖范围和优化服务量化准确度后,可以取得理想的效果.Page10图6系统占用内存随规则规模和组成的变化趋势相比于传统的访问控制系统,该访问控制系统的优势如下:(1)通过细粒度的访问控制机制,更好地支持了两个著名的安全控制原则,即最小特权原则及职责分离原则.(2)提供了开放式的接口,可扩展性强.(3)覆盖范围广,准确率高.5结论在开放式的网络环境中,网络资源和服务以及用户的随时动态接入一方面提高了生产效率,另一方面对下一代防火墙技术提出了很多新的安全挑战,而现有的诸多访问控制技术并不能满足开放式网络环境的要求.针对现有RBAC、TBAC模型在支持服务细致授权粒度上的不足,本文引入了量化服务的概念并将其应用在访问控制系统中.量化服务是传统访问控制模型中服务的扩展形式,通过服务属性对服务进行划分,从而达到服务的扩展性要求.以很低的管理和维护代价实现了灵活的访问控制粒度.为了增强权限的动态可控性,该模型引入了条件角色迁移的概念,从而实现了细粒度的访问控制.本文形式化地定义了服务量化模型和角色量化模型,并在此基础上提出了基于量化角色和服务的访问控制模型(QSRBAC).量化角色和服务是一种在RBAC系统中实施最小特权原则的有效机制,角色迁移是在开放式网络环境下运行访问控制系统的必然要求.研究量化角色和服务以及角色迁移是解决开放式网络场景中面临的访问控制要求的有效手段.下一步的工作,将围绕分布式计算环境中的访问控制系统开展研究,以建立细粒度多级安全的访问控制模型.此外,将深入研究区域网络中策略的冲突和冗余的问题,并提出相应的检测及消解的方法.
