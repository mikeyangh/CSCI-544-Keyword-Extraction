Page1考虑电压/温度变化的电热综合分析及其并行加速技术赵国兴骆祖莹黄琨唐亮(北京师范大学信息科学与技术学院北京100875)摘要受限于计算能力,在现有的电热分析研究中,无法考虑电压变化对电热分析的影响,从而降低了分析的精度.基于已有的研究成果,文中分析了芯片的功耗/电压/温度分布向量之间的相互关系,指出了在电热综合分析中考虑电压/温度变化的必要性,进而提出了一种迭代式的并行电热综合分析方法ETA_VT,该方法基于功耗与电压/温度之间的递归关系,进行迭代计算,最后将收敛后的功耗/电压/温度分布向量作为求解结果同时输出.基于多核CPU+众核GPU异构计算机系统所提供的并行计算资源,为了提高电热综合分析的运行效率,文中不仅设计了一个具有主辅双进程的ETA_VT算法流程,而且还分别采用CPU多线程并行计算、GPU并行计算、CPU+GPU协同并行计算技术对ETA_VT算法进行加速研究.实验数据表明:(1)考虑电压/温度变化的电热综合分析不仅可以获得较为精确的分析结果,而且可以同时计算出芯片的功耗/电压/温度分布;(2)采用并行计算技术、并合理分配计算资源,不仅可以解决电热综合分析中存在的功耗/电压/温度多参量相互影响的问题,而且还可以有效地提高电热综合分析的速度,获得多达44倍的加速效果.文中工作是将高性能计算引入电子设计自动化(EDA)算法研究的一次有益尝试,表明高性能计算技术不仅可以提高EDA算法的执行效率,而且可以促进芯片设计中存在的多参量相互影响综合分析问题的研究和解决.关键词P/G分析;3D热分析;高性能计算;GPU计算;异构计算机1引言随着集成电路(IC)工艺进入纳米工艺时代,IC集成度与工作频率不断增加,伴随性能提高的是不断增加的IC功耗与功耗密度①,不仅拉低了供电网络的供电电压,而且升高了内核温度,其直接后果是增加电路时延,降低芯片性能,所以在芯片设计中,必须对芯片功耗、供电网络、工作温度进行快速而精确的电热分析(Electro-ThermalAnalysis,ETA)[1-2].狭义的电热分析包括电源线/地线网络分析(Power/Groundnetworkanalysis,简称P/G分析)与全芯片3D热分析,二者共用电热分析方程G×X=B[1-2];广义的电热分析还包括功耗分析[1].在电热分析中,功耗/电压/温度这3个参量之间存在着直接的相互影响,具体关系见2.4节.一方面,根据芯片的功耗分布向量可以计算出吸纳电流向量和功耗密度向量,P/G分析算法[3-8]根据吸纳电流向量可以计算出节点电压向量,并且3D热分析算法[9-11]根据功耗密度向量可以计算出节点温度向量;另一方面,温度和静态功耗之间存在指数关系[1-2,9,11],供电电压同时影响动/静态功耗[1,12],因此,供电电压和温度反过来又直接影响功耗(动态功耗和静态功耗之和)[1,12].总而言之,功耗/电压/温度这3个参量之间存在着复杂且直接的相互作用,必须对功耗/电压/温度进行电热综合分析,但受限于巨大的计算复杂度,现有的电热分析研究无法做到这一点[1-11,13-15].事实上,由于电热分析具有非常高的时间复杂度,其算法研究核心就是在保证精度的前提下,降低算法复杂度[1-2].在计算节点电压分布的P/G分析中,随机行走(RW)[3]、连续过松弛(SOR)[4]、等效电路[5,8]、单点SOR(SNSOR)[7]等算法都是加速P/G网直流分析、瞬态分析、统计分析的有效方法.在计算节点温度分布的3D热分析中,变向隐含(ADI)[9]、多网格(MG)[10]、SNSOR[11]等算法都是提高3D热分析效率的有效方法.由于电热分析共用一个电热分析方程,P/G分析和3D热分析的求解算法是通用的,这些算法一般为降低P/G分析算法复杂度而提出,可直接用于高效求解3D热分析[2].以上工作主要是从算法设计的角度来提高电热分析算法的效率,算法设计为串行程序,运行平台为传统的单线程CPU.随着高性能计算技术的不断发展,如何将其应用到提高EDA算法的运行效率,成为近年来EDA算法研究的热点问题[13-19].就现有研究成果而言,多核CPU的多线程并行计算[16]、众核GPU的众线程并行计算[17]、计算机集群的多CPU并行计算[18]都可以有效地提高EDA算法的效率.一般而言,集群并行计算比较适用于粗颗粒度的并行计算,CPU并行计算比较适用于中颗粒度的并行计算,GPU并行计算比较适用于细颗粒度的并行计算[13-19].对于具有细并行颗粒度的电热分析算法而言,GPU并行计算可以提供理想的加速效果[13-15],最近我们也对P/G分析提出了一种基于行(row-based)并行计算的SOR算法,GPU加速算法[20].针对目前缺乏电热综合分析算法、无法对功耗/电压/温度这3个参量进行精确分析的问题[21],基于我们在电热分析方向上的研究成果[2,5,7-8,11,20-21],本文提出了一种电热综合分析方法ETA_VT,该方法对功耗分析、P/G分析、与3D热分析进行统一建模,采用迭代方法对功耗与温度/电压之间的相互影响进行分析,最后将功耗/温度/电压向量收敛值作为分析结果同时输出.ETA_VT包含如下4个操作:(1)根据功耗分布计算出芯片的吸纳电流向量①InternationalTechnologyRoadmapforSemiconductorsPage3和功耗密度向量;(2)采用改良的连续过松弛算法(SOR)并行地进行P/G分析和3D热分析,求解出电压向量和温度向量;(3)根据芯片的供电电压分布和温度分布,分别计算出动态功耗与静态功耗分布,二者相加获得芯片的功耗分布;(4)如果最高温度Tmax的改进量低于一个足够小的值,则输出芯片的功耗/电压/温度分布向量;否则返回第(1)步、继续迭代.为了提高电热综合分析的算法运行效率,基于一个通用的多核CPU+众核GPU异构计算机系统(PCS_CGHA),本文不仅设计了一个具有主辅双进程的ETA_VT算法流程,而且还分别采用CPU多线程并行计算、GPU并行计算、CPU+GPU协同并行计算技术对ETA_VT算法进行加速研究.实验结果表明:(1)在电热分析中,如果既不考虑电压降低、也不考虑温度升高对功耗的影响,其所得出的分析结果将过于乐观,明显不符合实际;(2)现有的迭代式电热分析方法只考虑温度升高对功耗的影响、而不考虑电压降低对功耗的影响,会产生悲观的分析结果,且迭代收敛较慢;(3)本文的ETA_VT方法同时考虑电压降低和温度升高对功耗的影响,会产生较为合理的分析结果,同时其收敛的速度较快;(4)采用CPU+GPU协同并行计算技术、并针对产生时间瓶颈的进程合理分配计算资源,可以得到理想的加速效果,与双CPU线程执行双进程ETA_VT算法的并行计算相比,采用3个CPU线程进行P/G分析、384个GPU线程进行3D热分析,可以获得多达44倍的加速效果.本文的理论贡献在于:首次提出综合考虑电压/温度变化的电热综合分析方法,并用并行计算技术实现了电热综合分析的算法加速,是一次将高性能计算引入电子设计自动化(EDA)算法研究的有益尝试,丰富了现有的电路分析理论与实践.本文第2节论述功耗/电压/温度之间的相互关系;第3节介绍PCS_CGHA的组成及其所提供的计算资源;第4节给出电热综合分析方法ETA_VT及其并行加速技术;第5节给出实验数据并加以分析;第6节给出结论与未来工作.2功耗/电压/温度之间的相互关系2.1功耗分析:供电电压和工作温度决定CMOS电路功耗CMOS工艺芯片的节点功耗分布向量犘是由动态功耗犘ac和静态功耗犘lk累加而成,即犘=犘ac+犘lk,犘ac源自逻辑门状态改变产生的充、放电电流,犘lk源自MOS管的漏电流犐lk,犐lk主要由源漏之间的沟道漏电流构成[2].不同于温度犜只影响犘lk,供电电压犞既影响犘lk又影响犘ac.相对于犘lk,犘ac只与供电电压犞相关,如下式所示:式中珚f是工作频率,Ceff为有效负载电容.从式中可以看出,犘ac是犞的2次函数.在本文研究中,珚f取定值,以确定犘ac与犞之间的确定关系.在另一方面,犘lk与供电电压犞和工作温度犜均相关,如下式所示[12]:式中珡A和B是犐lk-犜曲线的拟合系数,本文通过HSPICE模拟实验获得这两个参数.2.2P/G分析:功耗拉低供电电压在当今高端芯片设计中,一般采用6层或8层布线,P/G网占有最上与最下两个层对,构成上下两个供电网,并用通孔(via)将双层网连起来.上层粗线网采用如图1所示的Mesh结构,作为理想电压源的C4-PAD(图中的小方块),呈阵列状排列,相邻的4个PAD所围的区域称为一个Block(块),所以P/G网可分为多个Block,达到就近供电、多路容余的目的.本文假设P/G网为单层,每个节点连接一个吸纳电流,所有节点的吸纳电流构成了一个吸纳电流向量犐,一个PAD阵列被用来为P/G网供电.本文采用更新后的功耗分布向量犘k+1和已知节点电压向量犞k来计算刷新后的吸纳电流向量犐k+1,如下式所示:q,犘k+1式中犐k+1压.使用犐k+1和互导矩阵犌,可以求解出一个刷新后的节点电压向量犞k+1,如式(4)所示:Page4上式也可以改写为犞=犌-1犐.由于吸纳电流从PAD(理想电压源VDD)流向P/G网的节点,必然在电导上产生电压降,所以功耗折算出的吸纳电流将节点电压从VDD向下拉,具体的电压降必须用P/G分析来求解,P/G网中最大电压降节点的电压被称为最低电压Vmin.2.33D热分析:功耗升高工作温度本文采用差分方法进行全芯片3D热分析,先对芯片内核进行离散化,在x/y/z轴上将内核划分为n1×n2×n3个质元,具体如图2所示.假设每个质元所产生的热量都被加到它的中心点,并将中心点的温度做为质元温度,每个质元就可以视为一个节点.在图2中,最上层节点与芯片的散热系统为邻,可以用热导g0来表征散热系统的散热效果,g0的下端为最上层节点,上端是取值为环境温度Ta的恒定温度源节点.本文采用更新后的功耗分布向量犘k+1来计算刷新后的功耗密度向量ρk+1=犘k+1/犇,其中犇为质元体积向量.设珚犌为热导矩阵,可以利用下式求解节点温度分布向量犜:上式也可以改写为犜=(珚犌)-1ρ.由于热量从芯片的内部节点流出,必然在热导上产生温度差,所以功耗折算出的功耗密度向量将节点温度向量从Ta向上抬升,具体的温度增量必须用3D热分析来求解,其中具有最大温度增量的节点温度被称为最高温度Tmax.2.4功耗/电压/温度之间的相互关系:直接而复杂如上所述,我们用计算公式在图3中对功耗/电压/温度之间的相互关系进行了清晰地表述,三者之间的相互影响具有如下特性:(1)直接性.功耗向量可以直接折算出吸纳电流向量和功耗密度向量,进而直接计算出节点电压向量和节点温度向量;同样,使用电压向量和温度向量也可以直接计算出每个节点的动态功耗与静态功耗,累加后得到每个节点的功耗,从而获得节点的功耗分布向量.(2)循环性.一方面,功耗的大小决定了电压降低和温度升高;另一方面,电压降低和温度升高又反过来决定功耗的大小.(3)补偿性.一方面,功耗和温度之间存在犘/犜正反馈关系,即功耗的增加会造成工作温度的增加,而工作温度的增加又反过来增大静态功耗,进而使功耗增加;另一方面,功耗和供电电压之间存在犘/犞负反馈关系,即功耗的增加会造成供电电压的降低,但供电电压的降低会造成功耗的降低;犘/犜正反馈与犘/犞负反馈之间存在着补偿关系.3具有并行计算资源的CPU+GPU异构计算机系统PCS_CGHA在本文PCS_CGHA系统中,CPU采用Intel公司i7860处理器,GPU采用Nvidia公司GTX560Ti处理器.i7860整合了CPU、内存控制器和PCI-E控制器,亦即CPU+北桥,具体的CPU+GPU异构计算机系统架构如图4所示,具有如下性能指标:(1)CPU通过双通道内存管理器提供21.3GB/s的内存带宽;(2)显卡通过PCI-E2.0-X16总线连到CPU的PCI-E总线管理器,总线带宽为8GB/s;(3)CPU和GPU可以并行计算,但CPU与GPU进行数据通信时,主存和显存必须通过内存管理器和PCI-E总线管理器进行中继,与GTX560Ti显卡的128GB/s显存带宽和系统的21.3GB/s主存带宽相比,PCI-E2.0-X16总线8GB/s带宽是整个系统的带宽瓶颈.图4基于Intel公司i7-860的PCS_CGHA系统架构Page5PCS_CGHA系统架构可以提供如下的3种并行计算资源:(1)基于MPI的CPU多进程并行计算技术;(2)基于OpenMP的CPU多线程并行计算技术;(3)基于CUDA的GPU并行计算技术.4电热综合分析方法及其加速技术4.1电热综合分析方法ETA_VT:考虑功耗/电压/温度之间的相互关系根据图3所给出的功耗/电压/温度之间相互关系,本文首次提出了一种并行的电热综合分析迭代方法ETA_VT,以利于将并行计算技术应用于该方法的算法实现,该方法的算法表述如下:1.参数输入.输入环境温度Ta、初始电压向量犞0、P/G分析所需的电导矩阵犌、3D热分析所需的热导矩阵珚犌、芯片的功耗分布向量犘、最高工作温度改进量δTmax的迭代判出极小值εT.2.初始化.节点电压初始化为VDD以获得初始电压向量犞0、节点温度初始化为Ta以获得初始温度向量犜0、并将功耗分布输入量作为初始功耗向量犘0、迭代次数k←0.3.功耗到功耗密度与吸纳电流的折算.根据功耗向量犘k计算吸纳电流向量犐k和功耗密度向量ρk.4.P/G分析与3D热分析的并行计算.使用独立线程同时进行P/G分析和3D热分析,即采用改良的SOR算法,根据犌,犐k,犞k-1计算出犞k,同时根据珚犌,ρk,犜k-1计算出犜k.5.刷新功耗向量.根据犞k和犜k计算出新的功耗向量犘k+1.6.循环跳出判断.如果最高工作温度改进量δTmax小于εT,则转到下一步,跳出循环;否则,将k+1→k,转到步3,开图5ETA_VT算法流程图始新一轮迭代.7.结果输出.将犘k+1/犞k/犜k作为功耗向量/电压向量/温度向量的最终结果输出.从以上的ETA_VT算法表述可以看出:(1)ETA_VT是一个迭代算法,第3~6步构成了一个循环体;(2)ETA_VT是一个高效的并行算法,第4步的P/G分析与3D热分析存在并行计算关系,与其它算法相比,P/G分析和3D热分析都具有很高的计算复杂度,采用并行计算技术来同时进行二者的求解,可以有效提高本文方法的算法效率;(3)ETA_VT是一个电热综合分析方法,它完整地反映了图3中所给出的功耗/电压/温度之间相互关系,不仅考虑了温度变化的影响,而且还考虑了电压变化的影响,通过迭代计算,最后同时输出功耗向量/电压向量/温度向量的最终结果.4.2ETA_VT的算法流程根据4.1节所述的算法思想和并行计算技术,本文设计了如图5所示的ETA_VT算法流程.由于3D热分析比P/G分析的算法复杂度高[2],所以本文将3D热分析作为一个独立的辅助进程(即辅进程),而将其它操作作为程序主体、即主进程,采用独立的计算资源运行主辅进程,二者之间通过MPI协议进行数据交换.因此,本文的电热综合分析算法采用了并行计算架构,主辅进程构成了两个粗颗粒度的并行计算.在本文的并行算法加速设计中,将采用较多的计算资源进行辅进程的3D热分析,而将剩余的计算资源运行包括P/G分析在内的主进程,以减少主进程的等待时间.Page64.3ETA_VT的4种并行加速算法在图5所示ETA_VT算法流程中,主进程的时间复杂度主要集中在P/G分析.由于3D热分析处理3D网格、P/G分析处理2D网格,所以3D热分析的算法复杂度要远大于P/G分析.在分配计算资源时,如果用相同的计算资源并行求解P/G分析和3D热分析,其结果是3D热分析运行时间过长,使得主进程的等待时间过长,大大降低电热综合分析的效率.因此,本文在计算资源分配时,将较少的计算资源分配给主进程,相反却将较多的计算资源分配给辅进程的3D热分析,以降低主进程的等待时间,提高ETA_VT算法的运行效率.本文实验平台PCS_CGHA的并行计算资源包括4个共享L3Cache的CPU物理线程和384个GPU线程.整体而言,CPU物理线程的数量非常少,CPU提供的总计算能力要远小于GPU;但就个体来说,单个CPU线程的计算能力却非常强大,可以处理非常复杂的任务,这是GPU线程所无法比拟的.因此,PCS_CGHA具有如下两个特点:(1)CPU物理线程数量少、功能强大、可以独立运行;(2)GPU线程数量多、专用于计算、且必须依赖于CPU提供的数据与运行指令.为了获得最佳的平衡加速效果,减少主、辅进程之间的等待时间,根据ETA_VT算法对计算资源分配的需求和PCS_CGHA所提供计算资源的特点,本文设计了如下4种需要不同计算资源的加速算法:(1)SPST加速算法:主、辅进程各占用1个(2)SPMT加速算法:主、辅进程分别占用1个(3)SPGT加速算法:主进程占用1个CPU线(4)MPGT加速算法:主进程占用3个CPU线CPU线程.和3个CPU线程.程、辅进程占用384个GPU线程.程、辅进程占用384个GPU线程.4.4具有数据一致性的并行SOR求解算法在采用传统的SOR算法求解电热分析方程犌犡=犅以获得待求电压向量犡的过程中,假设第k步松弛结束,得到待求解向量为犡k,为了进行第k+1步松弛,我们将犡k装入一个中间节点电压向量珚犡.当我们对任意节点p进行第k+1步松弛,需要进行如下松弛计算:p=(1.0-λ)XkXk+1式中Bp为p点的激励,p点有np个邻点,Np和Lp分别是p点的邻点集合和邻接线集,其中,珡XNp(j)是第j个邻点的中间节点电压,GLp(j)是第j个邻点所连线的电导,Gp是p点自导,为Gp=∑j∈LpGLp(j),λ为过松弛因子,可以根据P/G网电路参数计算出λ的最优值λopt方法获得其最优值λopt路中所有点都松弛过一遍后,中间节点电压向量珚犡就是第k+1步松弛结果犡k+1.如果犡k+1中所有点的误差绝对值均小于一个极小的设定值ε1,则结束松弛,求解出电热分析的待求解向量犡;否则,将k+1→k,开始新一轮松弛迭代.节点p的误差ep可按下式计算:当计算出Xk+1以上传统的SOR算法必须逐点进行松弛,在并行计算中,由于读/写的并行性,就会产生数据冲突,进而产生计算错误.为了解决这个问题,本文提出了基于红-黑次序的并行SOR算法,所谓红-黑次序,即将所有节点分为红、黑两类,保证所有红色节点的四周只有黑色节点,所有黑色节点的四周只有红色节点,如图6所示(图中用小方块代表红色节点).在并行计算时,先用一个函数“kernel_red”计算所有红色节点的电压,再用一个新的函数“kernel_black”计算所有黑色节点的电压,函数“kernel_red”结束后的隐式同步保证了当计算黑色节点的电压时,所有红色节点的电压都已经被更新了.同时由于所有红色节点的电压求解仅依赖于电压不变的黑色节点,反之亦然,所以函数“kernel_red”可以采用乱序方法并行求解所有红色节点的电压,函数“kernel_black”也可以采用乱序方法并行求解所有黑色节点的电压,因此本文改良的SOR算法可以产生N/2个如式(6)、Page7(7)所示的并行松弛计算,即具有与电路节点数N成正比的计算并行度,较好地满足了GPU众线程对算法并行度的需求.5实验结果5.1电热综合分析的物理建模为了实验本文所提的电热综合分析方法的效果,我们根据已有的P/G网分析与3D热分析的研究经验[2,5,7-8,11,20-21],进行如下简单的物理建模.(1)实验对象为一个正方形芯片,边长为12.1mm,芯片功耗为100W,动态功耗和静态功耗各占50W[2].(2)本文只对如图1所示的最上层粗网进行P/G分析,P/G网由16×16C4-PAD阵列进行供电,供电电压VDD=1.0V,芯片被分为121×121个供电区,每个供电区为100μm×100μm,并被等效为一个0.0034A吸纳电流源,相邻节点之间的电阻为0.15Ω[5,7-8,20].(3)在3D热分析中,如图2所示对芯片进行3D离散化,设芯片衬底的厚度为500μm,将衬底离散为5层,则每个质元为100μm×100μm×100μm立方体,每个节点之间的热阻为0.01×cm2/W,器件层的功耗密度为68.3W/cm2,散热系统的等效热阻为0.33cm2/W,环境温度为Ta=45[11,21].(4)为了反映电热耦合效应,本文使用BSIM3-70nm工艺获取式(2)的珡A、B参数.其中珡A=3.495e-7W/2,B=9.050e-5W.5.2电热综合分析的效果基于以上的电热综合分析物理建模,为了验证温度T和供电电压V对电热分析的影响,本文设计了3种对比方法,分别是完全不考虑V&T的ET_N方法、只考虑T不考虑V的ET_T方法、既考虑V又考虑T的ETA_VT方法(即本文的电热综合分析方法).在以上3种方法中,ET_N方法只需要采用P/G分析和3D热分析求解一次,就可以得到V&T;ET_T方法和ETA_VT方法必须采用迭代方法、对V&T进行多次求解,直到Tmax收敛到一个较为确定的值.根据ET_T和ETA_VT方法的迭代结果,本文绘制了Vmin和Tmax迭代收敛图.如图7所示,ET_T方法由于不考虑电压变低对温度变高的平衡作用,Tmax收敛于较高的温度(67.93),导致Vmin收敛于较低的电压(0.935V),同时由于Tmax变化比较大,ET_T方法需要较多次(16次)迭代才收敛到最终值.相反如图8所示,ETA_VT方法由于考虑了电压变低对温度变高的平衡补偿作用,Tmax收敛于较低的温度(61.21),使得Vmin收敛于较高的电压(0.946V),同时由于Tmax变化比较小,ETA_VT方法需要较少次(12次)迭代就收敛到最终值.我们将所有3种方法所获得的Vmin和Tmax结果列在表1中,从表中数据可以得出如下结论:(1)ET_N方法不考虑V&T对电热分析的影响,只用根据功耗分布向量犘简单地进行孤立的P/G分析与3D热分析,其结果会得出乐观的分析结果,Tmax最低(56.83),Vmin最高(0.99V);(2)ET_T方法只考虑T不考虑V对电热分析的影响,其结果会得出悲观的分析结果,Tmax最高(67.93),Vmin最低(0.935V);(3)ETA_VT方法既考虑V又考虑T对电热分析的影响,由于考虑了电压变低对温度变高的平衡补偿作用,ETA_VT方法不仅得出了较为合理的分析结果,而且收敛速度也比较快.方法温度T的影响电压V的影响Vmin/VTmax/ET_N不考虑不考虑0.99056.83ET_T考虑ET_VT考虑Page85.3电热综合分析并行加速的效果基于通用的CPU+GPU异构计算机系统(PCS_CGHA),本文4.3节设计了SPST、SPMT、SPGT、MPGT等4种并行计算加速算法.表2给出了使用上述4种并行加速算法运行ETA_VT电热综合分析方法的所有数据,包括所用的计算资源、运行时间(s)、加速效果.我们可以从表2数据中得出如下结论:(1)使用最少计算资源的SPST算法的运行时间最长,使用最多计算资源的MPGT算法的运行时间最短,与SPST算法相比,MPGT算法提供了44倍的加速效果.(2)从SPST算法的运行结果来看,电热综合分析ETA_VT的时间复杂度(11022s)主要是由辅进程3D热分析(11021s)贡献的,其1s时间差主要是由MPI信息传递所贡献的.由于主进程中P/G分析的时间复杂度是最大的,而P/G分析的运行时间只有115s,所以主进程时间(也就是ETA_VT运行时间)的绝大部分运行时间都浪费在等待辅进程的信息返回上.因此,采用并行计算技术加速辅进程的3D热分析、可以获得满意的ETA_VT加速效果.(3)从SPMT算法的运行结果来看,3个CPU线程可以有效地将辅进程的3D热分析运行时间从11021s压缩到3783s(2.913倍加速),从而将主进程的运行时间从11022s压缩到3835s(2.874倍加速),这表明主进程的等待时间被有效降低了,所以获得了满意的ETA_VT加速效果.(4)从SPGT算法的运行结果来看,384个GPU线程可以非常有效地将辅进程的3D热分析运行时间从11021s大幅压缩到87s(126.678倍加表2不同加速算法的计算资源与运行时间比较方法SPST1CPU线程115BASE1CPU线程11021BASE11022BASESPMT1CPU线程1151.0003CPU线程37832.91338352.874SPGT1CPU线程1151.000384GPU线程87126.67831335.214MPGT3CPU线程402.875384GPU线程89123.83124944.265从以上的数据分析可以得出如下结论:(1)将电热综和分析设计为一个迭代式的多进程并行算法非常有意义,它可以提供粗颗粒度的计算并行性;(2)对于粗颗粒度的并行计算,通过合理分配计算资源、可以在减少所有进程运行时间的同时,减少所有进程的等待时间,从而获得最佳的性能提升;(3)对于具体的进程,必须不断改进具体运行算法速),从而将主进程的运行时间进一步从SPMT算法的11022s压缩到313s(35.214倍加速).由于主进程的P/G分析时间为115s,所以SPGT算法的时间瓶颈已变为主进程,辅进程一部分运行时间处于等待状态,这表明必须通过压缩P/G分析时间来获得更好的ETA_VT加速效果.(5)从MPGT算法的运行结果来看,3个CPU线程可以非常有效地将主进程的P/G分析运行时间从115s有效地压缩到40s(2.875倍加速),从而将主进程的运行时间从SPGT算法的313s进一步压缩到249s,获得了更好的ETA_VT加速效果.(6)从SPST→SPMT→SPGT→MPGT算法的计算资源与运行时间的演化情况可以看出:将更多的计算资源用来压缩ETA_VT的时间瓶颈,可以获得很好的ETA_VT加速效果;在多进程并行计算中,平衡分配计算资源,以降低所有进程的等待时间,是将高性能并行计算应用于EDA算法加速的关键.(7)对于CPU多线程并行计算而言,3个CPU线程可以将P/G分析的运行时间从115s压缩到40s(2.875倍加速)、同时将3D热分析的运行时间从11021s压缩到3783s(2.913倍加速),表明本文给出的“具有数据一致性的并行SOR求解算法”适用于中颗粒度的多核CPU并行加速.同时对于GPU众线程并行计算而言,384个GPU线程可以将3D热分析的运行时间从11021s压缩到87s(126.678倍加速),表明本文给出的“具有数据一致性的并行SOR求解算法”具有非常好的计算并行度,满足了众核GPU并行加速对众多细颗粒度并行计算线程的需求.3D热分析的计算并行性,这将有助于改进CPU多线程并行加速、特别是GPU众线程并行加速的效果.6结论与未来工作本文分析了电热综合分析中功耗/电压/温度之间的相互关系,首次提出了考虑电压/温度变化对电Page9热分析影响的电热综合分析方法ETA_VT,并基于通用的CPU+GPU异构计算机系统(PCS_CGHA),设计了一种适用于CPU+GPU协同并行计算的加速算法MPGT,与使用双CPU线程(最少并行资源)的SPST算法相比,可以获得44倍的加速效果.本文研究是将不断发展的高性能并行计算技术应用于EDA研究的一个有益尝试,表明高性能并行计算不仅可以解决多参数相互影响的复杂问题,而且可以有效地提高问题的求解效率.因此,本文研究是对现有电路分析理论与技术的一种重要扩展与改进.由于本文工作是对电热综合分析进行的首次研究、并尝试将高性能并行计算技术应用到电热综合分析的算法加速,所以本文研究具有探索性色彩,离实际应用还比较远,近期将针对本文工作中不符合实际应用之处,开展如下研究:(1)采用当前主流工艺参数、建立更为贴近实际的物理模型;(2)采用瞬态分析方法进行P/G分析和3D热分析,以替代本文使用的静态分析方法;(3)采用更先进的并行计算平台与算法、来扩大电热综合分析的求解规模与效率.由于性能与电压/温度关系密切,所以我们远期将开展:(1)建立功耗/电压/温度/性能之间的相互关系模型;(2)将电热综合分析研究成果应用于芯片的电热综合优化研究中;(3)将考虑参数工艺变化的统计分析方法引入电热综合分析研究.
