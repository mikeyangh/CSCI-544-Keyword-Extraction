Page1一种采用随机归一化相关系数调制的量化水印朱新山1),2)丁杰1)1)(扬州大学信息工程学院江苏扬州225009)2)(数字出版技术国家重点实验室(筹)北京100871)摘要该文提出了一种新颖的量化水印.该方案通过调制由宿主信号变换产生的特征信号嵌入水印信息.特征信号由源宿主信号与一个随机信号的归一化相关系数构成.对该信号的调制方法是从水印信息对应的码本中选择一个码字,码本设计使用了均匀量化器并考虑了多进制的情况.加水印的宿主信号在最小化嵌入失真的意义下产生,并使其与随机信号具有调制后的归一化相关系数.同时,该文给出了嵌入失真与可移除水印信息的最小通道失真的表达式,根据它们可以在码本中搜索最优的码字以提高水印性能.该文方案对幅值缩放攻击具有不变性,而且抗噪能力优于著名的扩展变换抖动调制水印.图像仿真结果表明,该方案具有良好的不可感知性以及能抵抗广泛的攻击,和几种典型的水印方案相比具有显著的性能优势.关键词数字水印;量化水印;归一化相关系数;鲁棒性;幅值缩放1引言数字水印是一个具有边带信息的通信问题[1].对于这个问题,Costa理论上得出了信道容量与编码器端的宿主信号无关[2].Costa的结果向我们暗示可以设计一个水印系统,完全抵制宿主信号和隐藏信息之间的干扰.为了追求这一目标,学术界提出了大量的水印方案,它们中的大多数都包含一个量化步骤.至今,一类最重要的方法称为量化索引调制(QuantizationIndexModulation,QIM)[3].该方案构造一组量化器,每个量化器对应一个不同的信息,并通过选择量化器量化宿主信号实现水印嵌入.QIM的一个基本实现称为抖动调制(DitherModu-lation,DM)[3],它采用了一组标量均匀量化器.尽管,DM既简单又有很好的性能,但是它的容量与理论容量的差距相对较大.随后,失真补偿技术被引入到QIM方案中[3],得到了带失真补偿的QIM(也称为标量Costa方案[4]).该方案利用了Costa理论的准则,从而进一步逼近了水印的理论性能.这些基本算法都是就一个像素或一组像素的幅值进行量化.虽然,直接使用幅值特征可简化水印设计,但有时候性能并不好.为此,许多研究着重于探索提取新的特征用于量化.扩展变换抖动调制(Spread-TransformDitherModulation,STDM)是传统DM的一个重要扩展[3].该方案量化宿主信号在一个随机信号方向上的投影.STDM的思想之后被应用于量化投影方案与带失真补偿的量化投影方案[5].投影特征的使用显著地提升了传统QIM的性能[3,5].在基于球面固化的DM方案(Sphere-HardeningDitherModula-tionSHDM)[6]中,通过量化宿主信号的范数实现水印嵌入.SHDM利用了球面固化效应,在抵抗加性高斯白噪声(AdditiveWhiteGaussianNoise,AWGN)攻击方面可获得与STDM相同的解码错误率.文献[7]将对数变换引入到QIM中,对数变换的使用可为嵌入水印产生非均匀的量化步长,从而有利于提升水印的不可感知性.此外,考虑到量化水印对幅值缩放攻击(ValumetricScalingAttack,VSA)的弱点,一些研究致力于构造具有增益不变性的特征用于量化.文献[8]将宿主信号与其自身均值的比作为一个新的信号进行量化.该方案获得了对VSA的鲁棒性,但是,它在零失真时得出了非零的解码错误率,降低了水印性能.RationalDitheredModulation(RDM)[9]使用了与前者类似的思想构造特征信号,只是其中作为除数的量是加水印信号的某个函数.RDM不仅在性能上渐进地逼近DM,而且拥有对VSA的不变性.由于相位信息不受幅值缩放的影响,因此,采用相位调制可以提升水印性能.在基于角度的QIM(AngelQIM,AQIM)[10]中,水印嵌入通过量化宿主信号在高维空间中构造的角度.AQIM对幅值缩放具有内在的不变性,但是,由于缺少性能比较,AQIM在其它方面的性能不甚明了.AQIM的思想也被用于改善STDM的性能[11].文献[12]提出利用宿主信号的4个样本确定一条直线,并通过量化该直线的倾斜角嵌入水印.文献[13]针对图像小波域内的梯度方向进行量化调制.后两种水印都是面向实际图像设计的,获得了良好的鲁棒性.本文将提出一种新的量化水印方案,称为基于归一化相关系数的量化水印(NormalizedCorrela-tionbasedQuantizationWatermarking,NCQW).该方案通过量化宿主信号与一个随机信号的归一化相关系数嵌入水印.NCQW的突出特征是它对VSA具有理论的不变性,同时,也提升了水印对其它一些攻击的鲁棒性.本文第2节给出一个水印问题模型和相关的定义;第3节详细描述NCQW,包括特征信号的选择、水印信息调制和提取;第4节致力于嵌入函数的设计;第5节推导嵌入失真的表达式;第6节针对VSA和加性噪声攻击探讨NCQW的鲁棒性;第7节对NCQW的性能进行测试和评估;第8节总结全文.2基于特征的水印模型本研究采用图1所示的水印模型.向量狓∈表示宿主信号,用于嵌入水印信息m.宿主信号可以是像素值构成的向量,也可以是离散余弦变换系数或者其它变换域系数构成的向量.首先,对狓实施某种变换获得一个特征信号f狓,该特征信号的长度一般取决于要嵌入的信息量.然后,使用信息m调制特征信号f狓,得到新的特征信号fm.接着,在宿主信号狓中嵌入水印,获得加水印的宿主信号狔∈使得狔经过相同的特征提取操作能获得特征信号fm.考虑到安全问题,上述过程依赖于某个安全的密钥K.Page3图1基于特征的水印模型通常,水印信号狑被定义为加水印的宿主信号和原始宿主信号的差,即狑狔-狓,这样可采用De‖狑‖2测量嵌入失真,其中‖·‖表示取欧拉范数操作(也就是2范数).利用该失真量,可进一步定义载体水印比(Document-to-WatermarkRatio,DWR)ζ,ζ‖狓‖2/De.在提取水印信息前,加水印的宿主信号狔可能通过一个未知的通道,在那里遭遇各种信号处理过程(例如,低通滤波,加性噪声,甚至是一些故意移除嵌入信息的操作).不失一般性,可使用一个未知噪声源狀∈信号狕可以写作狕=狔+狀.与嵌入失真类似,我们将采用Dc‖狀‖2衡量通道失真,利用它可进一步定义水印噪声比(Watermark-to-NoiseRatio,WNR)ξ,ξDe/Dc.在提取水印时,失真信号狕将首先被变换为特征信号f狕,该操作与水印嵌入时的变换操作相同.然后,从特征信号f狕中提出信息m^.为了保证安全,水印提取过程需要使用密钥K.一个理想的水印系统应该可以完全恢复嵌入信息,即m^=m.从这个角度,可以利用位错误率(BitErrorRate,BER)Pe评估水印系统的性能.上述模型引入了一个特征信号提取过程,因此,我们称其为基于特征的水印模型.从水印嵌入过程可以看出,该水印模型不是直接对宿主信号自身进行信息调制,而是对宿主信号产生的一个特征信号进行信息调制,这是它与一般水印模型的重要区别.这种区别将导致设计由原始宿主信号到加水印的宿主信号的映射变得更复杂,但是,只要采用的特征信号合适,便可获得提升的水印性能.3基本的NCQW基于给出的水印模型设计水印方案,需要考虑的主要问题包括特征信号的构造、信息调制、由原始宿主信号到加水印的宿主信号的映射以及水印信息的提取操作.下面,将给出一种具体的水印方案NCQW.为了便于理解和方便解释,我们考虑一种基本情况,即从原始宿主信号内提取的特征信号是一维的.因此,以下特征信号将用斜体的小写字母表示.3.1特征选择许多信号特征都可用于水印设计.常见的统计特征有均值、标准差、各阶矩和直方图等.这几种特征对普通信号处理过程(例如加噪)都比较敏感,因此,使用它们隐藏信息容易导致信息损失.相对而言,投影特征(或者说扩展变换)具有更大的优势.使用投影特征隐藏信息,在某种程度上相当于引入扩频技术,可提升水印对一般信号处理操作的鲁棒性[3,5],但是,投影特征对幅值缩放攻击很敏感[14].宿主信号的范数也有类似的问题,尽管,使用范数嵌入水印可以获得与投影特征相同的抗噪能力[6].文献[8]将宿主信号与其自身均值的比作为特征信号,虽然该特征对缩放攻击具有不变性,但是它的稳定性较差,对宿主信号均值的改变特别敏感.这种构造特征信号的思想后来被用于RDM,所不同的是特征信号中作为除数的量使用的是加水印信号的某个函数[9],结果提高了特征信号的稳定性.可惜的是,RDM没有考虑引入扩展变换,因此,它在抗噪声攻击方面的性能也仅仅是逼近传统的DM.AQIM中使用了对幅值缩放攻击具有不变性的角度特征[10],但同样也没有考虑扩展变换.目前,还不存在指导特征信号设计的一般准则.但是,特征的选择一般应该考虑所使用的调制技术的特性.本文将主要关注量化水印.众所周知量化水印对VSA特别脆弱.为了解决该问题,需要使用一个对幅值缩放具有不变性的特征,同时,最好能引入扩展变换.的归一化相关系数(NormalizedCorrelation,NC)作为特征信号,即本文提出将宿主信号狓与一个随机信号狌∈Page4其中,信号狌可以使用随机数发生器产生,并依赖于密钥K.特别的,信号狌的每个元素遵从独立的标准正态分布(0,1).显然,fx的取值范围为[-1,1],当向量维数L足够大时,fx近似符合均值为零的高斯分布.式(1)表明,特征信号NC对幅值缩放具有不变性.利用该特性,可实现水印方案对VSA的不变性.其次,NC的计算过程包括一个投影操作,可使水印嵌入引入扩展变换,从而提升水印的性能[3,5].最后,该特征是随机的,其安全性依赖于某个安全的密钥,有利于改善水印方案的安全[3,15].3.2信息调制与提取文献[16]给出了二进制NCQW的基本实现.这里,考虑多进制(M-ary)水印的情况.为了嵌入一个信息基元m∈,={0,1,…,M-1},我们需要为每个信息元构造码本.首先,将NC的取值范围[-1,1]分为Ls个大小相同的子区间,记为i=[iΔ-1,(i+1)Δ-1),i=0,1,…,Ls-1,其中,Δ=2/Ls.显然,步长Δ的值越小,子区间的个数Ls越大.然后,再将每个子区间按步长Δ/M等分为M个不重叠的区域,表示为i=∪M-1[(i+j/M)Δ-1,(i+(j+1)/M)Δ-1),每个区域对应一个信息元.最后,给定偏移量d∈[0,Δ/M),在区域ij内选择位置(i+j/M)Δ+d-1作为信息元j∈的码字,形成点集Λj={(i+j/M)Δ+d-1|0i<Ls}作为信息元j的码本.偏移量d可在区间[0,Δ/M)上随机产生,以提升码本的安全性.这种码本的设计采用了均匀的量化步长,但是它可以推广到非均匀量化步长的情况.信息调制的过程是从待嵌入的信息基元m的码本Λm中选择一个值代替NC特征fx.一种直接的方法是在Λm中选择与fx最接近的点,这可以通过量化操作实现.设round(·)表示将一个数值近似到最近的整数的函数.量化步长为Δ的量化器因此可定义为犙m(x,Δ)roundxd,m∈.使用与信息元m对应的量化器量化特征fx得到调制后的NCfm,即如果上式得到的fm超出区间[-1,1],可通过增加或减少Δ,使其值返回该区间.特征信号fx量化前后的误差记为qe,qe=fm-fx.注意到式(2)在形式上与抖动调制[3]一致,所不同的是这里信息元的码本空间是有限的.有限的码本空间不会降低NCQW水印性能,因为我们使用的NC特征是随机的.虽然,量化操作可保证误差信号qe最小,但是,这不等价于水印嵌入过程引入的嵌入失真De最小.因此,一种优化的方法是在最小化De的意义下选择fm,即第3种选择fm的方法是考虑攻击者移除嵌入信息所需要引入的最小通道失真Dcm,通过最大化Dcm获得fm,即失真量De和Dcm的表达式将在后文中给出.后两种方法需要在整个码本空间中进行搜索,因此比第1种方法更复杂,但由于我们的码本空间是有限的,所以搜索是可行的,另外,后文将指出,在一些特殊情况下,搜索范围可以缩小.对于加水印的宿主信号狔,它与狌的NCfy须满足fy=fm.产生信号狔的一般函数表达式可写作其中,Em(·)称为嵌入函数,它的具体形式将在下一节中给出.要提取隐藏信息,首先利用密钥K再次产生随机信号狌,然后,计算信号狕和狌之间的NCfz,最后,应用最小距离检测器从fz中提取一个消息m^,该过程可以表示为使用上式提取水印信息需要在整个码本空间内进行搜索,因此,水印提取过程的复杂度相对较高.由于量化操作可以确定每个信息元的码本内与fz距离最近的点,因此,式(6)中内层的最小化操作可以去除,简化为如果fz位于区间[-1,Δ-1)或[1-Δ,1)内时,上式的量化操作可能得出超出范围[-1,1]的量化值,这与信息调制时可能出现的问题一致,因此可采取相同的策略来处理,即通过加减一个量化步长使其返回到取值范围[-1,1].4嵌入函数的设计水印嵌入函数Em(·)的基本功能是产生一个加水印的宿主信号狔,且满足条件fy=fm.设计Em(·)是实现水印方案的一个关键问题,随着特征Page5信号构造方法的不同,Em(·)有不同的表达式,而且,即使特征信号已经确定,它的表达式也不唯一,这是因为信号狔是多维的,但是确定狔的条件只有一个.下面,将推导NCQW的水印嵌入函数,为了获得唯一的表达式,我们考虑了最小化嵌入失真的情况.图2给出了此问题的一种几何解释.图2水印嵌入与移除的几何解释(实心点表示向量,图2中的实心点表示L维空间内的向量.由给出的NCfm,可以求出向量狔和狌之间的夹角为θy,θy=cos-1(fm).以向量狌为轴,母线与轴的夹角为θy,确定一个圆锥体,嵌入区域位于该圆锥的表面.在嵌入区域内寻找一个与点狓距离最近的点,目的是最小化嵌入失真.显然,这个点是狓在圆锥体表面的投影,并位于向量狓与狌构成的高维平面内.假设狔d表示向量狔的单位向量,即狔d=狔/‖狔‖,狓d和狌d也有类似的定义.根据前面的分析,可获得和其中,α和β是两个嵌入因子.向量狔d满足条件将式(9)代入式(10),并解方程组(10)可以得到注意到上述结果只适合‖狓‖≠0且|fx|≠1的情况.如果‖狓‖=0,也就是说狓是一个零向量,此时,我们再产生一个与向量狌正交的随机向量狏∈L.利用向量狌和狏很容易构造向量狔d满足条件(10),即其中,向量狏d是狏的单位向量.同时,向量狔的幅值不能再采用投影狓T狔d的方法确定,而应取决于嵌入失真.当|fx|=1时,即向量狓与狌的方向相同或者相反,此时,可用狓d和狏d的线性组合构造向量狔d,即其中,λ和η是两个嵌入因子.根据条件(10)以及狌和狏之间的正交性,可以导出此处,sgn(·)表示符号函数.最后,通过把式(14)代入式(8)得到信号狔.5嵌入失真上一节给出了NCQW的嵌入函数表达式,现在可以推导它的嵌入失真De和DWRζ.我们考虑了一般情况,即‖狓‖≠0.由于向量狑和狔是正交的,嵌入失真De可表示为De=狓2sin2(θ狓狔)=狓2(1-cos2(θ狓狔))表1几个NC样本的调制及对应的绝对误差和DWRNC调制后的NC绝对误差DWR-0.9153-0.96250.047251.5-0.6887-0.74250.0538168.60.52350.57750.0540239.20.85460.90750.052979.30.99870.90750.09127.2此处,φ(fx,fm)=((1-f2x)(1-f2mfxfm)2,θ狓狔是向量狓与狔之间的夹角,θ狓狔=cos-1(fx)-cos-1(fm).根据上式和DWR的定义,立刻可以得到从式(17)和式(18)可以看出,嵌入失真与原始宿主信号的能量成正比,换句话说,DWR与原始宿主信号的能量无关.另外,De和fm之间的关系是非线性的,也就是说,与fx最接近的fm未必会导致嵌入失真最小.表1清楚地展示了这一效果.结合式(3)和式(17)可以获得一个令De最小的fm.实际Page6上,为了确定最优的fm没必要在整个码本空间Λm内搜索,而只需要比较在码本Λm内位于fx左右两侧的值fml和fmr,因此,式(3)等价于这大大降低了水印嵌入的复杂度.对于最常用的二进制NCQW和不同的宿主信号维数L,图3画出了DWRζ与步长Δ的关系曲线.可见DWR和Δ之间的关系是非线性的.随着Δ的增加,DWR下降的速度很快,但是,当Δ大于0.3时,DWR的变化相对平稳.根据式(17),我们知道DWR的下限是1.相对而言,DWR受L的影响则较小.当Δ小于0.2时,对于不同的L得出了近似相同的DWR,当Δ较大时(超过0.7),L的影响才变得相对突出.图3ζ(DWR)与Δ之间关系的实验曲线(d=Δ/4)6解码器性能本节评估NCQW水印的解码性能.为此,我们考虑了两种攻击:VSA和加性噪声攻击.考虑VSA,是因为许多量化水印对该操作特别敏感.通过加性噪声攻击可以考验水印对信息损失的抵抗能力.此外,为了展示NCQW水印的相对性能,我们采用RDM和STDM两种水印作为性能基准.前者对VSA具有不变性,后者引入了扩展变换,它们都在量化水印家族中占有极其重要的地位.6.1幅值缩放攻击假设加水印的宿主信号狔经过了幅值缩放过程得到失真信号狕,因此,两者的关系可以表示为狕=ρ狔,其中ρ是增益因子.此时,根据NC的定义(见式(1)),很容易获得fz=fm,结果从fz中提出的信息m^就是嵌入信息m.因此,可以得出结论,NCQW对幅值缩放攻击具有不变性.在L=32和DWRζ=30dB的情况下,我们使用随机信号对NCQW(M=2)、RDM和STDM的抗幅值缩放攻击能力进行了测试.实验结果显示在图4中.可见,STDM对该攻击特别敏感.当增益因子超出范围[0.9,1.1]时,STDM的错误率急速上升.相反,NCQW和RDM都表现了极强的鲁棒性.特别是NCQW,在整个增益因子的变化区间内,错误率都为零.图4Pe(BER)对增益因子ρ的实验曲线(ζ=30dB,L=32)6.2加性噪声攻击对于噪声攻击,如果噪声导致的NC变化量满足|fz-fm|<Δ/(2M)时,不会发生解码错误.这里,fz=fm±Δ/(2M)规定了正确解码区域的边界,它是以向量狌为轴,母线与轴的夹角为cos-1(fm+Δ/(2M))确定的圆锥体表面,和以向量狌为轴,母线与轴的夹角为cos-1(fm-Δ/(2M))确定的圆锥体表面,如图2所示,我们称其为决策边界.NCQW的鲁棒性可以使用加水印的宿主信号狔到决策边界的最小距离Dcm来衡量.假设狕1表示信号狔在边界fz=fm-Δ/(2M)上的投影,狕2表示信号狔在边界fz=fm+Δ/(2M)上的投影.显然,当狕1和狕2位于包含向量狔和狌的平面内时,它们中的一个是决策区域边界上所有向量中与信号狔最接近的.由此,Dcm可写作Dcm=mini∈{1,2}狕i-狔2=min其中,θ狔狕=cos-1(fm)-cos-1(fz),最后一个等式的推导方法与式(17)类似.上式表明,通过增大加水印信号狔的能量和量化步长Δ可以改善NCQW的鲁棒性.将式(4)和式(20)相结合,可以获得fm在最大化Dcm意义下的一个最优解.利用随机信号,我们测试了NCQW(M=2)、RDM和STDM对加性高斯噪声的鲁棒性.图5给Page7出了几种不同条件下的测试结果.如图5(a)所示,对于L=32和DWRζ=30dB的情况,当WNR处于区间[-15dB,-3dB]内时,NCQW的性能比STDM略差,但是,当WNR再下降时,NCQW的性能便开始超越STDM.总的说来,在该测试条件下,两者的性能是很接近的.然而,随着L增加,NCQW图5BERPe与WNRξ之间的经验关系曲线7实验结果及分析为了评估水印在实际应用中的性能,我们实现了一种基于NCQW的小波域图像水印方案.该方案对图像进行三级haar小波分解,并提取第3层对角线方向的细节子带小波系数作为宿主信号.利用图6NCQW水印嵌入效果:原始图像(第1行)与加水印的图像(第2行)在更广的WNR区间上获得了优于STDM的性能,这可以从图5(b)观测到.图5(c)和图5(d)表明通过降低DWR可进一步提升NCQW相对STDM的性能优势.相对而言,RDM的性能很不理想,随着WNR的下降,它的BER迅速增大,这主要是因为该方法没有使用扩展变换.NCQW在宿主信号内嵌入一个长为128位的随机信息,并实施小波逆变换.实验使用了10个大小为512×512的标准图像,如图6中第1行所示,从不可感知性和鲁棒性两个方面测试了水印性能.由于随着进制M的增加,NCQW的性能会降低,所以,我们仅考虑了M=2的情况.Page87.1不可感知性测试为了公平的比较,我们调整量化步长,使嵌入每个图像的水印能量保持一致,水印能量可通过信噪比PSNR测量.图6给出了NCQW水印的嵌入效果,其中,第2行为加水印的图像,PSNR为48dB.从主观上说,每个加水印的图像与其原始图像看起来都几乎完全一致,人眼无法区分它们.这说明该水印方案的不可感知性非常好.另外,利用一些客观的图像质量评价指标[17]:加权的信噪比wPSNR(theweightedPSNR)、TPE(theTotalPerceptualError)以及NLPE1(theNumberofblocksgreaterthanthefirstLocalPer-ceptualErrorthreshold),我们对加水印图像进行了测试.表2给出了NCQW水印的测试结果,同时,也表2水印不可感知性评测(PSNR为48dB)图像Plane49.349.249.36.86.05.7Barbara51.751.852.08.17.16.6Boat51.351.251.48.17.26.8House49.950.050.17.26.35.9Baboon53.453.453.57.76.66.5Peppers49.449.550.28.77.16.1Bridge52.552.552.58.27.67.2Crowd50.750.650.87.76.66.4Lake51.851.851.97.26.15.9Lena49.649.749.88.77.26.87.2鲁棒性测试下面,将测试水印对一些常见图像处理操作的鲁棒性.该实验在图像质量相同的条件下进行.为此,我们调整量化步长,使每个加水印图像的TPE都为5.7×10-3.提取水印信息在攻击操作之后进行,并以BER作为水印鲁棒性的评价指标.表3和4给出了在各种攻击下的测试结果.在没有特殊说明的情况下,获得的BER是在所有图像上的平均值.(1)对幅值缩放攻击的鲁棒性.我们首先测试了幅值缩放对水印的作用效果.表3给出了几种不同增益因子条件下获得的BER.显然,本文算法对幅值缩放的鲁棒性明显优于其它两种水印方法,它获得了最低的BER.这主要是因为我们把信息嵌入在一个与幅值缩放攻击无关的特征信号内.RDM也获得了不错的性能.(2)对Gamma校正操作的鲁棒性.Gamma校正是视频处理中常用的操作.表3显示了Gamma校正对水印的作用效果.可见,随着γ因子的增加,我们方案的BER上升了.但相比而言,提供了RDM水印和STDM水印的测试结果.后两种方案的实现方法与NCQW水印相类似.对于NCQW,每个加水印图像的wPSNR都在49dB以上,TPE值都在0.008以下,这说明图像的全局质量是极高的,而且,没有一个图像块的失真达到了不能接受的程度,这又说明图像的局部质量是令人满意的.与RDM、STDM相比较,NCQW提供了最大的wPSNR和最小的TPE.这说明NCQW的性能就不可感知性而言优于其它两个方案.产生这一结果的原因可解释为:在STDM中水印信号是一个随机信号,而在NCQW中,水印信号是宿主信号与随机信号的组合,因此,NCQW可提供比STDM更好的水印不可感知性.RDM在这方面的性能最差,因为它没有使用扩展变换,而扩展变换已被证实可以降低嵌入失真[5].TPE/10-3我们方案的性能是最佳的,而且优势非常明显,RDM的性能是三者中最差的.(3)对有损压缩攻击的鲁棒性.有损压缩是水印面临的最重要的攻击之一.我们测试了不同质量因子的压缩对水印的影响,测试结果显示在表3中.对该攻击,NCQW表现了良好的鲁棒性,当质量因子下降到10时,它的错误率仍然是较低的.在这方面,STDM的性能略微优于我们的方法,两者都远远超过RDM.一个主要的原因是RDM没有使用扩展变换.(4)对灰度级变换的鲁棒性.图像灰度的调整有许多种变换函数,这里,我们测试了3种情况,分别是直方图均衡、对比度拉伸和对数变换,测试结果显示在表3中.可以看出,对比度拉伸和对数变换对NCQW的影响很小,而直方图均衡过程的影响则较明显.和其它两种方案比较,我们的方案在这方面显示了最强的鲁棒性.RDM的性能与本文算法的性能相近,两者都远远优于STDM.这可能是由于前两种算法对幅值缩放都具Page9有不变性导致的结果.(5)对图像模糊操作的鲁棒性.我们使用运动模糊对加水印图像进行攻击,角度参数设为45°,长度参数取不同的值,测试结果显示在表3中.很明显,随着长度参数的增加,本文算法的性能下降了,但是,在模糊失真比较严重的情况下,它的性能仍然很好.STDM对长度参数的变化最敏感,随着长度参数的增加,它的性能下降最快.在3种方案中,本文算法的性能是最佳的.(6)对图像锐化操作的鲁棒性.图像锐化可用于增强图像的边缘和灰度跳变部分.我们使用图像锐化的一种方法Sobel算子测试了水印性能,测试结果如表3所示.与前几种攻击不同,锐化显著降低了所有被测试水印方案的性能,产生了极高的BER.这是由于我们把水印信息嵌入在图像的中低频区域,而锐化操作会大量去除图像中的低频信息.因此,如果要提升水印对该操作的鲁棒性,可以将水印嵌入在图像的高频区域,但这又会降低水印对其它攻击的鲁棒性.具体的水印方案设计应该根据应用要求采用折衷的策略.(7)对噪声攻击的鲁棒性.本文测试了水印对加性高斯白噪声和椒盐噪声的鲁棒性,攻击强度分别由噪声的标准差和噪声的分布概率来衡量,测试结果显示在表4中.容易看表3在不同攻击下NCQW、STDM与RDM得到的BER/%方法幅值缩放BERNCQW002.701.627.824.05.21.10.118.82.601.912.327.447.7STDM12.00.27.00.22.829.221.92.50.2041.623.85.56.424.837.048.9RDM0.50.55.51.311.435.950.253.432.815.918.99.40.58.719.131.450.610203040有损压缩BER表4在噪声与滤波攻击下NCQW、STDM与RDM得到的BER/%方法NCQW1.28.821.928.013.623.830.10.51.11.14.020.937.912.2STDM0.210.325.237.112.028.038.92.26.06.44.227.243.427.2RDM43.952.151.649.620.339.946.14.56.56.319.127.039.523.47.3与其它方案的比较下面,我们将提供更多的比较实验结果,以便能够更全面地评估提出的NCQW水印的性能.用于比较的水印方案有文献[6-7,10-11,13,18]中的方案.这些方案都是本领域中有代表性的研究成果.(1)与文献[10]和文献[11]的比较.这两种方法都是基于角度的量化水印.它们的实现与前面出,本文算法对这两种噪声都具有很强的鲁棒性,但是,对椒盐噪声的性能不如对高斯噪声的性能好.STDM水印的性能在攻击强度低的情况下好于本文算法,但随着攻击强度的上升很快被超越.这种效果与上一节中在随机信号上获得的结果是一致的.RDM在这方面的性能远远落后于前面两种方案,其原因与压缩的情况相同.(8)对滤波攻击的鲁棒性.本文测试了水印对高斯滤波、中值滤波和维纳滤波的鲁棒性,其中高斯滤波的标准差为0.9,滤波窗的尺寸取不同的值,表4给出了多种情况下的测试结果.我们观察到,本文算法对高斯滤波非常鲁棒,在测试的几种条件下,它都获得了很低的BER.相对而言,中值滤波和维纳滤波对本文算法的性能影响较大,特别是中值滤波,当滤波窗的尺寸为7×7时,本文算法的BER显著变大了.滤波攻击对另两种水印方案的影响也类似,只是此两者在不同方面有各自的优势.和它们相比,本文算法对滤波攻击的鲁棒性是最优的.前面比较了NCQW与两种基本量化水印的性能,他们的实现是相同的,测试条件也一致.实验表明,我们的方案对各种图像处理操作的综合性能是最优的,其他两种方案除STDM在有损压缩方面略微领先,在其他方面的劣势非常明显.高斯滤波BER3×35×57×7NCQW的实现类似.鲁棒性测试在加水印图像的质量TPE为0.0057时进行,测试结果如表5所示.容易看出,在被测试的几种攻击情况下,本文提出的方案优于其它两种方法.(2)与文献[6]和文献[7]的比较.这两种方法都是基于宿主信号范数的量化水印,区别是前者使用了非均匀的量化步长.对这两种方法,我们也采用了与前面NCQW类似的实现策略.鲁棒性测试在Page10加水印图像的质量TPE为0.0057时进行,我们给出了在几个标准图像上的测试结果,如表6所示.可以看出,除压缩以外,对其它被测试的攻击,本文提出的方案都优于另外两种方法.表5在不同攻击下NCQW与文献[10]和文献[11]的BER/%结果比较方法幅值缩放BER文献[10]0.4716.485.23文献[11]1.5613.137.42NCQW04.140.55表6在不同攻击下NCQW与文献[6]和文献[7]的BER/%结果比较有损压缩BER82030图像方法高斯滤波BERBoat文献[6]17.97Boat文献[7]33.59BoatNCQW0.78House文献[6]18.75House文献[7]0HouseNCQW0(3)与文献[13]的比较.文献[13]提出了一种基于梯度方向的量化水印.它的一个实现是在第3层小波系数上嵌入256位信息.为了在相同的信息长度下进行比较,NCQW水印的实现被修改如下:利用第3层小波变换的3个细节子带LH3、HL3和HH3产生两个新的差值矩阵作为宿主信号,即HH3-LH3和HL3-HH3,然后通过NCQW在每32个差值矩阵分量内嵌入1位信息,最后把获得的对差值矩阵信号的修改量在最小均方误差的意义下转换为对各个细节子带的修改量.鲁棒性测试在加水印图像的质量为PSNR为42dB时进行,表7给出表7在不同攻击下NCQW与文献[13]的BER/%结果比较图像方法幅值缩放BERPeppers文献[13]000.581.176.6410.681.410.181.3213.470.11PeppersNCQW000Baboon文献[13]000.965.0819.759.861.410.621.2812.480.54BaboonNCQW000.782.7319.531.950003.130Barbara文献[13]000.131.108.148.641.690.161.4012.870.14BarbaraNCQW000Lena文献[13]000.1707.108.641.650.411.8513.520.03LenaNCQW000表8在不同攻击下NCQW与文献[18]的BER/%结果比较图像方法中值滤波PeppersWang[18]29.3526.101.252.00PeppersNCQW010.1602.73BaboonWang[18]31.6516.951.301.95BaboonNCQW2.731.9500BarbaraWang[18]24.9516.451.452.25BarbaraNCQW1.174.690.390.78LenaWang[18]30.8029.801.452.45LenaNCQW09.7700.78有损压缩BER2030了在几个标准图像上的测试结果.表7表明两种方案对幅值缩放攻击的性能一致,在其它方面,除椒盐噪声攻击以外本文方案的性能都优于文献[13]提出的方案.(4)与文献[18]的比较.该方案是一种小波域的扩频水印.比较实验在水印信息长度为256位和加水印图像的质量为PSNR为42dB的条件下进行,NCQW的实现与前一个实验相同,表8给出了在一些标准图像上的测试结果.显然,在用于测试的几种攻击下,本文方案都表现了比文献[18]的方案更优的鲁棒性.1120308结束语本文的主要贡献是提出了一种新颖的量化水印,称为NCQW.该方法对宿主信号与一个随机信号的归一化相关系数进行信息调制.我们给出了多进制NCQW的码本结构、信息调制与提取方案,并设计了水印嵌入函数.在NCQW中,码本大小是有限的,它与使用的步长有关,水印信号是宿主信号与Page11随机信号的线性组合,有利于改善水印的不可感知性,另外,该方法中引入了扩展变换过程,有利于提升水印的鲁棒性.我们进一步导出了NCQW水印的嵌入失真和移除水印信息所需要的最小失真表达式.利用它们可以在码本内搜索一个最佳的信息码,提升水印的性能.解码器性能的分析表明NCQW不仅对幅值缩放攻击具有不变性,而且,对AWGN也表现出比传统STDM更优的性能.仿真结果表明,相对于多种已有的典型水印方案,NCQW水印在不可感知性和鲁棒性方面获得了显著的提升.致谢彭硕玲同学参与了本文算法性能的测试工作,苑岩峰同学参与了论文格式的排版.作者对他们的贡献深表谢意.作者还要衷心感谢匿名的评审者和编辑为本文提出了宝贵意见和修改建议!
