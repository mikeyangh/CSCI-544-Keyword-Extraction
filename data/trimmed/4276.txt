Page1基于稀疏编码多尺度空间潜在语义分析的图像分类赵仲秋季海峰高隽胡东辉吴信东(合肥工业大学计算机与信息学院合肥230009)摘要传统潜在语义分析方法无法利用图像中区域语义构成的上下文信息来获得图像目标空间分布信息,因此它丢掉了局部特征之间的空间关系信息.而基于最近邻矢量量化来构造共生矩阵具有较大的量化误差,使得特征描述缺乏鲁棒性,影响后续潜在语义分析获得特征的精确性.为了弥补这些不足,文中提出了一种基于稀疏编码的多尺度空间潜在语义分析的图像分类方法.首先通过空间金字塔方法对图像进行空间多尺度划分,然后利用稀疏编码对每个局部块特征进行软量化以形成共生矩阵,之后结合概率潜在语义分析(PLSA)获得每个局部块的潜在语义信息,再利用权值串接每个特定局部块中的语义信息得到图像多尺度空间潜在语义信息,最后用支持向量机(SVM)分类器完成图像的场景分类.在常见图像库上的实验表明,本文提出的基于稀疏编码的多尺度空间潜在语义分析方法平均分类精度比现有诸多方法均有明显提高,验证了其有效性和鲁棒性.实验还表明,空间金字塔匹配、稀疏编码共生矩阵以及PLSA降维这3个模块在该文方法中缺一不可,共同提升图像表征和分类性能.关键词图像分类;稀疏编码;潜在语义分析;空间金字塔1引言随着高速互联网的快速发展,信息存储与传输技术的发展以及数码设备的普及,数字彩色图像的获取和存储变得更加容易,人们接触到的图像数据也以前所未有的速度在增长.面对海量的图像数据,如何使计算机模拟人类对图像的理解认知机理,自动把图像按照人们理解的方式分类到不同的语义类别就成为一个关键问题.此外,图像分类不仅包含人们对一幅图像的总体认识,而且还提供了图像中对象出现的上下文环境,为进一步识别出图像中的其他内容提供了基础.因此,图像分类成为当前计算机视觉和多媒体信息处理领域的热点问题.传统的图像分类方法中根据描述图像方式的不同,图像分类方法可以分为基于全局特征和基于中层语义信息两大类.早期的场景分类方法通过提取图像的颜色、纹理、形状等全局底层特征后再利用特征矢量表示场景内容.如Vailaya等人[1]提出的结合图像低级特征和二元贝叶斯分类器的多级框架;Szummer等人[2]采用综合颜色、纹理和频率信息的方法来提取场景特征;Oliva等人[3]提出空间包络面方法表示图像内容.虽然这些方法在一定条件下能够很好地表示图像,但都基于图像的底层特征,无法解决图像分类中的“语义鸿沟”问题[4],即底层视觉特征和高层语义特征之间的不统一性.近年来,基于图像中层语义特征来对图像建模的方法来表述图像得到了广泛的关注,即分别建立图像关于低层、中层、高层场景语义的表示.如基于“词包模型”(Bag-of-Words,BOW)[5]方法以及在基于BOW基础上利用概率潜在语义分析(ProbabilisticLatentSemanticAnalysis,PLSA)[6]和潜在狄雷克雷分布(LatentDirichletAllocation,LDA)[7]等主题分析模型来找出图像最可能属于的主题或者潜在语义分布,从而完成图像场景分类.典型的如Bosch等人[8]提出的基于PLSA的场景图像分类方法.该方法中利用的PLSA模型能够很好的解决图像分类中出现的多义词和同义词问题,从而大大地提高图像的分类准确率.然而,基于BOW描述的主题分析模型描述场景图像中视觉词汇出现的总体频次,这类方法既没有考虑视觉词汇在空间的分布特点,也无法获得场景中各目标的空间分布信息[9].为了获取目标空间分布信息,Lazebnik等人[10]提出了一种空间金字塔匹配方法,将图像在不同尺度下分割成多个子区域,然后对每个子区域中的视觉词汇进行直方图统计和串联,从而得到场景图像的空间分布表达;由于文献[10]中基于最近邻向量量化(NearestNeighboredVectorQuantification,NN-VQ)方法在特征编码时具有较大的重构误差[11],基于稀疏编码(SparseCoding,SC)的局部特征量化方法应运而生,并且取得了很好的分类效果[12].然而,这种基于SC的局部特征量化方法忽略了局部区域的潜在语义信息,无法表示特征在潜在语义空间的内在关系.针对现有方法的不足,为了解决前面方法存在的不足,同时考虑到同类图像中区域语义的空间分布往往具有一定的规律,本文提出了一种基于稀疏编码多尺度空间潜在语义分析的图像分类方法.该方法通过空间金字塔思想对图像进行空间分层和局部区域分块划分获得图像的局部块之间的空间关系,接着利用SC对每个局部块进行软量化形成共生矩阵,再结合PLSA模型对每个局部块进行潜在语义挖掘以获得其潜在语义信息分布.最后通过权值将不同尺度上汇总的潜在语义信息进行串接得到图像最终的特征描述.该特征不仅考虑到图像的局部潜在语义信息,而且考虑到了图像空间信息.实验结果表明本算法生成的图像多尺度空间潜在语义信息具有较高的分类性能.Page32基于稀疏编码的图像多尺度空间潜在语义分析图像可视为若干个局部区域组成的集合.本文提出一种基于稀疏编码的多尺度空间潜在语义分析的图像分类,依据局部区域潜在语义信息与其空间分布情况进行图像分类.2.1局部特征编码传统的基于潜在语义信息分类方法主要是基于NN-VQ局部特征编码来构建共生矩阵[8].假设犡=[x1,…,xN]∈RK×N表示图像局部特征集,其中K表示特征维数,N表示特征个数,犠=[w1,…,wM]∈RK×M表示视觉字典中基的集合,其中M是基的个数,则NN-VQ问题表示如下:其中,狔iτ0=1,狔i1=1,狔i0表示yi向量中只有一个元素是非零的且该非零元素是1其余全部为0.实际上,编码系数狔i的求解就是寻找狓i在字典犠中最近邻的一个基的过程.为了降低重构误差,提高量化精度,SC[12]将式(1)中狔iτ0=1约束条件进行放宽,即利用L1范数来正规化稀疏编码yi:其中,λ是正则化参数.对于式(2)的求解,本文先使用k-means方法[13]对局部特征进行聚类,得到视觉字典犠,然后固定犠,利用特征符号(featuresign)方法[14]来求解稀疏编码yi.图1直观地描述了NN-VQ和SC之间的差异.由图可知,SC利用了更多视觉字典中的基来表示特征描述子狓i;而NN-VQ方法只选择1个基来表示局部特征描述子狓i.因此本文采用SC方法取代原先的NN-VQ方法来进行量化形成共生矩阵,使得生成的共生矩阵具有较小的重构误差.2.2基于PLSA的图像局部特征语义提取PLSA模型是由Hofmann[6]提出的一种用于文本检索的概率生成模型,它是为了解决文本中的同义词和多义词对文本语义理解的影响而产生的.在图像分类中,图像特征作为输入,就等同于文本分类中的单词,同样具有“同义词”和“多义词”的特点.例如,在太阳占大篇幅的图像中,提取的特征必定是相似的,但它们所表达的场景意义就不一定相同,因为太阳既可以为日出场景做贡献,也可以为日落场景做贡献,这就类似于文本中的多义词.而不同的图像特征常常也可以表现同一个场景.例如,在室外场景中,可以出现沙漠、瀑布、森林等,尽管这些目标物体的特征相差很大,甚至完全不同,但是他们所表示的场景是一类的,这就相当于文本中的同义词.由此可知,图像中“同义词”和“多义词”的存在严重影响了图像的分类精度.本文借鉴PLSA主题模型在文本分析中的一些优良特性来对图像进行分析[8],将该模型用于图像局部区域潜在语义挖掘,使其获得的潜在语义特征具有较小的冗余性和歧义性.假设有训练图像库犇=[d1,…,dN],其中di表示图像库中第i幅图像,由k-means聚类[13]而成的视觉词汇犠=[w1,…,wM],局部区域特征软量化形成的共生矩阵犙,其中犙ij=n(wi,dj)∈M×N表示视觉词汇wi在图像dj中出现的频次.我们用犣=[狕1,…,狕K]表示潜在语义(主题)集合,K为常数,为经验确定的主题个数.PLSA假设“图像-视觉词汇”之间是条件独立的并且潜在语义在图像和视觉词上分布也是条件独立的,在这个前提下,可以用式(3)表示“图像-视觉词汇”条件概率分布:犘(狑i,dj)=犘(dj)∑K式(3)中犘(dj)表示第j个图像概率,犘(狑i|狕k)为潜潜在语义在视觉词汇上分布概率,犘(狕k|dj)为图像中的潜在语义分布概率.模型参数可根据极大似然准则求解,本文通过极大化以下似然函数来进行模型的参数设计:L=∑M∝∑M其中,犘(狕k|di)和犘(狑j|狕k)参数通过期望极大化(ExpectationMaximization,EM)算法[15]迭代优化.Page4最终得到的犘(狕k|di)描述了图像的局部特征在语义上的分布情况,通过它来表示图像最终特征.2.3图像多尺度空间潜在语义学习模型结合图像的区域语义与其空间分布,人们往往能够方便准确地进行图像分类.例如,一个海滩的场景往往是由在图像上部的天空、中间的海洋和下面的沙滩组成.因此,通过分析图像在相应位置是否包含这些区域语义就能够有效地对图像进行分类,从而大大的提高图像分类的准确率.本文构造的图像多尺度空间潜在语义学习模型图2图像多尺度空间潜在语义学习算法示意图在上面金字塔分割的基础上利用PLSA模型来对每层的每个局部区域块进行潜在语义学习,第0层潜在语义学习得到的犘(狑|狕)保持不变,而对第1层和第2层的各子区域利用folding-in算法,将EM算法中第M步的犘(狑|狕)保持不变,不断地更新第M步和E步中的其他参数使得式(4)中似然函数值达到最大,进而得到每个局部块的潜在语义信息犘(狕|d).假设潜在语义主题个数为K1,则每个局部块dij可以产生一个K1维的特征向量[犘(狕1|dij),…,犘(狕K1|dij)],将同层每个块内学习得到的犘(狕|d)串接形成每层的潜在语义概率分布,最后对各分割层次进行加权串接以形成最终的图像多尺度空间潜在语义概率分布.测试图像生成多尺度空间潜在语义信息的过程与训练图像类似,只是在后期的局部块潜在语义学习阶段要利用训练阶段得到的犘(狑|狕).这里,犘(狑|狕)实际上就是局部特征的潜在语义模型.保持犘(狑|狕)通过对图像空间进行多尺度分割得到局部块后,利用PLSA模型对每个局部子区域进行学习得到该子区域的潜在语义信息,最后将每个局部区域的潜在语义特征加权拼接得到图像的最终特征.以一个3层空间金字塔分块模型为例,第0层表示是原图像,第1层对图像进行2×2分块划分,第2层对图像进行4×4分块划分,则一共可以得到21个图像区域,模型如图2所示.由此得到的图像区域包含了图像中目标大小和空间位置的情况,因此具有更好的鲁棒性.不变,对测试图像的第0层,第1层和第2层的每个图像局部块,利用EM算法迭代直至收敛,从而得到测试图像在每层的每个局部块中的潜在语义分布犘(狕|d);然后利用训练阶段对每个局部块内潜在语义处理方法得到测试图像最终的多尺度空间潜在语义分布.本文的加权拼接中的权值我们采用文献[10]中的设置方法,即第0层的系数设置为1/2L,第l层的系数设置为1/2L-l+1,其中L表示金字塔总层次数,l表示的特征所处的层次.故3层金字塔结构的权值系数为[0.5,0.25,0.25].2.4图像分类系统结构图3为基于稀疏编码多尺度空间潜在语义分析的图像分类的总体框架示意图.系统主要分为两个阶段:训练阶段和测试阶段.在训练阶段,通过本文提出的图像多尺度空间潜在语义模型学习得到最优的PLSA模型,再结合该模型生成的图像多尺度空Page5间潜在语义特征来训练SVM分类器模型[16],从而得到最优的SVM分类器模型.在测试阶段,首先结合训练阶段得到的最优PLSA模型参数犘(狑|狕)及测试图像的每个局部区域软量化形成的共生矩阵,使用folding-in方法来计算测试图像的空间潜在语图4Scene-13和Scene-15每类场景的部分示例图像义信息分布,再联合训练阶段生成的最优SVM对该潜在语义信息分布向量进行分类,并将所得的置信度最高的语义类别作为该测试图像的类别标签从而实现测试图像分类.3实验结果与分析为了验证本文算法的有效性和鲁棒性,将在3个常用图像数据集Scene-13[17]、Scene-15[10]和Caltech-101[18]上测试其分类精度,并与其他现有图像分类方法进行比较.Scene-13图像数据集共包括13类自然场景3759幅场景图[17],Scene-15则是在Scene-13的基础上另增加两个类别,因此共包含15个类别的4485幅场景图像[10].图4给出了Scene-13和Scene-15每类场景的部分示例图像.为公平起见,参照其他文献[10],在每次随机实验中,随机抽取各类别100幅图像作为训练集,而将剩余图像作为测试集.Caltech-101图像数据集[18](其部分示例图像见图5)共包含101个类别9146幅图片.为了和以前的方法比较[10],从每个类别中随机选择了15或30幅图像进行训练,剩下的图像作为测试.实验中,舍弃图像颜色信息,事先将图像库中彩色图像均转换为灰度图像.同时,为了减少运算量,在保持纵横比不变的条件下,将所有图像的尺寸缩放到了300×300像素以内.采用稠密SIFT特征提取算法[19]来进行图像局部特征描述,提取SIFT特征的图像块为16×16像素,步长为8像素.Page6图5Caltech-101图像数据集的部分示例图像本文SVM分类器采用了一对多(one-vs-all)的方法来处理多类问题.SVM分类器使用速度较快的线性核函数[12],参数通过交叉验证方法进行确定.与此同时为了保证结果的客观性,在每个库上独立进行了10次随机实验,并将平均分类准确率和标准方差作为评价指标.3.1节分析了潜在语义数目对空间金字塔各层分类精度的影响;稀疏编码软量化和最近邻向量量化方法的性能比较结果将在3.2节介绍;接下来的3.3节和3.4节我们研究了PLSA的必要性及多尺度空间金字塔对分类性能的影响;3.5节集中阐述了本文方法与其他现有方法的分类比较结果.3.1潜在语义数目对分类精度的影响本节将通过Scene-13数据集实验分析潜在语义数目对分类精度的影响.图6是分类精度随潜在语义数目增加的变化趋势.由图可看出,在一定的范围内,随着主题个数的增加分类精度将提高;而当超过一定范围时分类精度反而会降低,当主题个数为50时分类精度达到最大.当空间金字塔设为3层时,分类精度达到最高,这充分说明多尺度空间匹配有利于发现更多的图像目标空间位置信息和提高图像分类精度.图6潜在语义数目对分类精度影响(字典大小为1024,L=(0),L=(0,1),L=(0,1,2)分别表示3个层次的空间金字塔匹配)图7给出了稀疏编码(SC)、最近邻向量量化(NN-VQ)、基于稀疏编码的概率潜在语义分析方法(SC+PLSA)以及基于最近邻向量量化的概率潜在语义(NN-VQ+PLSA)方法在Scene-13和Scene-15图像数据集上随字典大小变化的分类结果.由图中结果可知,在多数情况下基于SC分类精度都是优于NN-VQ方法,表明用SC来进行特征量化,比常用的k-means特征量化精度更高,而且更具有鲁棒性.而SC结合PLSA的方法(SC+PLSA)相对于NN-VQ结合PLSA(NN-VQ+PLSA)的方法在分类性能则有明显提升.结果表明,基于稀疏编码软量化形成的共生矩阵具有较小的重构误差,能够提高分类精度.图7中结果也显示,不管字典的大小,SC+PLSA相比较于SC,或者NN-VQ+PLSA相比较于NN-VQ,分类精度都有明显提高,这也证明了PLSA的必要性.3.2稀疏编码软量化和最近邻向量量化比较此外,由图7我们还可以发现,随着视觉字典维度的增大,基于SC和NN-VQ的图像分类精度都有一定变化.这些情况说明,视觉词典的大小对于视觉单词的描述能力有着一定的影响;当视觉词典太小或太大时,其描述能力较弱;而只有在视觉词典大小适当时才能有较好的描述能力.产生这一现象的原因,主要源于由SIFT特征所生成的视觉单词存在多义或同义的现象.当视觉词典过小时,一个视觉单词可能表示了不同的内容,具有多义性;而当视觉词典过大时,几个视觉单词可能表示的是同一个内容,具有同义性.正如文本分类中所出现的情况,多义和同义往往带来了分类性能的下降,因而采用视觉单词的方法也会带来同样的问题.由此可见,视觉词典的大小与分类问题密切相关.在本实验中考虑到增加视觉字典的维度会导致分类的时间消耗增大.综Page7合以上考虑,本文视觉字典大小选择为1024,为了便于和现有的分类方法之间比较,同时也很好的折中了分类时间的消耗问题.图7SC、NN-VQ、SC+PLSA及NN-VQ+PLSA表2本文方法和ScSPM方法在单层分块和空间金字塔分块上分类精度/%(Scene-13,字典大小为1024)方法ScSPM75.97±0.4182.02±0.5384.15±0.72本文方法76.43±0.3784.04±0.3185.71±0.52表3本文方法和ScSPM方法在单层分块和空间金字塔分块上分类精度/%(Scene-15,字典大小为1024)方法ScSPM71.36±0.3478.42±0.6179.91±0.89本文方法73.14±0.5479.62±0.3280.83±0.573.5本文模型与其他已有方法的比较本文方法在Scene-15数据集上的平均分类正确率为82.73%,图8是在Scene-15场景图像集上分类时生成的混淆矩阵(confusionmatrix).表4和表5分别给出了本文方法和其他性能较好方法在Scene-13、Scene-15、Caltech-101的分类正确率比较.由表4可知,本文方法在Scene-13场景图像上分类率达到了86.75%,在Scene-15场景3.3PLSA的必要性我们通过Scene-13和Scene-15数据集来验证PLSA潜在语义信息抽取的必要性.表1给出了基于稀疏编码空间金字塔匹配(ScSPM)[12],ScSPM结合主成分分析(PrincipalComponentAnalysis,PCA)降维[20]以及ScSPM结合PLSA降维的分类结果.由表中实验结果可知,在Scene-15数据集上ScSPM+PLSA方法比单纯的ScSPM和ScSPM+PCA方法分类精度分别提高近1.8%和2.3%.该结果充分说明在每个局部区域利用PLSA模型进行学习得到的潜在语义信息能够提高图像的分类准确率,验证了PLSA在本文图像分类模型中的重要性.表1ScSPM、ScSPM结合PCA及其结合PLSA的ScSPMScSPM+PCA85.17±0.6580.42±0.45ScSPM+PLSA86.75±0.5382.73±0.653.4多尺度空间金字塔对分类精度的影响为了进一步说明多尺度空间金字塔匹配对提升图像分类精度的重要性,我们将本文方法和ScSPM方法分别在单尺度和多尺度空间进行实验比较,结果如表2和表3所示.其中L=0,L=1,L=2分别表示对图像进行1×1,2×2,4×4多尺度划分.由表中结果可以看出,图像多尺度划分粒度越细,分类精度越高,此外串联各层形成的多尺度空间金字塔划分其分类精度比单尺度划分分类精度高,表明多尺度空间金字塔划分能得到更多的图像目标空间信息.L=2L=2图像上达到了82.73%,比其他5种算法(空间金字塔匹配核(KSPM)[10],朴素贝叶斯最近邻(NBNN)[21],稀疏编码空间金字塔匹配ScSPM[12],概率潜在语义分析(PLSA)[8],基于潜在主题空间关系(SR-PLSA)[22])性能均优.由表5可看出,在Caltech-101数据集上,当训练图像数为15时,本文分类精度比ScSPM高出2.2%;而当训练图像数为30时,其分类性能比ScSPM提升2.4%.与其他各方法比较,Page8图8本文方法在Scene-15数据集上产生的混淆矩阵(其中对角线上的元素表示本文的方法在各类别上平均分类识别率.在第i行和第j列的元素表示的是将类别j的图像误分类到i类别上的百分比.字典大小为1024,潜在主题数为50)本文方法分类性能均有明显提高.实验结果很好地说明了本文所提出的基于稀疏编码多尺度空间潜在语义分析的图像分类方法的有效性和鲁棒性.表4本文方法和其他分类方法在Scene数据集上Lazebnik[10]Boiman[21]Bosch[8]Jin[22]ScSPM[12]85.53±0.7680.91±0.73本文方法86.75±0.5382.73±0.65:由于本文的对比实验中参数的设置问题,对比实验结果与原始论文结果之间可能有所差异.表5本文方法和其他方法在Caltech-101数据库上训练图像个数15trainsBoiman[21]Jain[23]Lazebnik[10]Huang[24]ScSPM[12]本文方法69.21±0.6375.65±0.724结论本文提出基于稀疏编码多尺度空间潜在语义分析的图像分类方法.通过图像分割的空间金字塔匹配提取目标空间位置信息;基于稀疏编码对局部区域进行特征软量化,形成共生矩阵,提高了共生矩阵对原始特征表述的准确性;最后,结合PLSA模型挖掘局部潜在语义信息,并串接每个局部的语义信息得到图像多尺度空间潜在语义信息.通过实验验证,本文方法同现有较好图像分类方法相比分类精度更高;而空间金字塔匹配、稀疏编码构建共生矩阵以及PLSA降维这3个模块在本文方法中缺一不可,使图像得到更精确的表征,共同提升图像分类性能.
