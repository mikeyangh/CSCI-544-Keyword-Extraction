Page1基于秘密共享模数的一般性多方求逆协议胡华明周展飞(中国科学院研究生院信息安全国家重点实验室北京100049)摘要Catalano、Gennaro和Halevi提出了一个实用的基于秘密共享模数的分布式求逆协议,然而他们仅仅考虑了门限敌手结构的情况.文中考虑了一般敌手结构的情况,针对半诚实敌手和恶意敌手,利用Damgrd和Thorbek提出的线性整数秘密共享方案,分别构造了一个多方模求逆协议.该协议在敌手结构是Q2(对应Q3以及强RSA假设)的条件下针对半诚实(对应恶意)敌手是安全的.该协议是Catalano等人方案的一个推广,可以用来分布式地计算RSA私钥以及构造标准模型下安全的分布式Gennaro-Halevi-Rabin、Cramer-Shoup和Mames-Joye签名方案.另外,文中的构造方法也是对环上的安全多方协议构造方法的一个有力补充.关键词模求逆;一般敌手结构;线性整数秘密共享;乘性张成方案;分布式RSA签名1引言本文考虑基于秘密共享模数进行求逆的问题,Page22000年,Catalano、Gennaro以及Halevi[4]针对上述分布式模求逆问题提出了一个高效的解决方案.他们的基本思想是利用扩展的欧几里德算法(记为GCD运算)来计算e-1mod.他们采用了整数环上的秘密共享方案来避免(N)上的求逆运算.然而,Catalano等人的方案[4]考虑的仅仅是门限敌手结构的情况,也即假设所有的参与方被攻破或者被收买的难度是相同的,唯一起决定作用的是被攻破或者被收买的参与方人数.然而,在现实当中,可能某些参与方会比其他参与方更可靠一些,因此需要以一种更灵活的方式来明确地指出哪些参与方是非授权的,也即,需要一般性的敌手结构.Cramer、Damgrd和Maurer[5]提出了利用有限域上的线性秘密共享方案来构造相同敌手结构的安全多方协议,他们给出了有限域上单调张成方案的乘性性质.后来,Cramer、Fehr等人[6]又将文献[5]扩展到了任意的含1交换环上,证明了环上安全多方计算协议的存在性,并给出了整数张成方案的乘性性质.利用乘性性质,Cramer、Fehr等人[6]使用一般敌手结构上的黑箱秘密共享(Black-BoxSecretSharing,BBSS)方案[7]构造了一个非常有效的安全多方计算协议.由于采用了黑箱秘密共享方案,在环上做运算时需要黑箱调用.分布式模求逆协议可用于分布式生成RSA私钥以及构造标准模型下安全的分布式Gennaro-Halevi-Rabin[1]、Cramer-Shoup[2]和Mames-Joye[3]签名方案.上述两个应用都需要高效的模求逆协议,尤其是后者,这是因为每次签名时都要使用不同的素指数e来运行模求逆协议.因此设计高效的分布式模求逆协议具有现实意义.1.1相关工作Damgrd和Thorbek[8]提出了线性整数秘密共享(LinearIntegerSecretSharing,LISS)方案来构造分布式RSA签名方案.在一个LISS方案中,秘密为选自一个公开区间的整数,每个份额(share)为秘密和一些随机整数的线性组合,秘密的重构也是通过计算授权集中所有份额的一个整系数线性组合得到.LISS方案与BBSS方案[7]有着紧密的联系,但两者并不相同.在BBSS方案中,秘密为取自于任意的有限Abel群中的元素,所有的运算都是在该群中完成,对于环上的计算和元素的选取,需要通过黑箱调用来完成.而在LISS方案中,所有的运算都是在整数环上进行.1.2我们的贡献Catalano等人[4]的方案只考虑了门限敌手结构的情况,为此本文给出了一般敌手结构上的多方模求逆协议,首先构造了一个半诚实敌手模型下的简单高效的安全多方模求逆协议,该协议在给定保密信道的前提下以及敌手结构是Q2的条件下是无条件安全的.然后又在半诚实敌手模型下的协议基础上增加了鲁棒性,将其改造为恶意敌手模型下的多方模求逆协议.该协议在强RSA假设下以及敌手结构是Q3的条件下是安全的.协议的鲁棒性是通过可验证线性整数秘密共享(VerifiableLinearIntegerSecretSharing,VLISS)方案以及一个零知识证明协议实现的.该VLISS方案是Pedersen-VSS[9]的一般敌手结构上的变体.相应的零知识证明协议是统计零知识的基于强RSA假设绑定的.本文的想法主要来源于文献[5-6],即利用敌手结构为的线性秘密共享方案来构造相同敌手结构的多方计算协议.为了避免(N)上的求逆问题,与文献[6]中采取黑箱秘密共享方案不同,本文采用了敌手结构为的LISS方案来构造针对敌手安全的多方模求逆协议,这样可以在整数环上做所有运算,从而避免了黑箱调用.因此本文构造多方协议的方法也是对文献[6]的一个有力补充.1.3本文的组织结构第2节将介绍一些预备知识;第3节是本文的重点,3.1节给出协议的系统模型,3.2节给出多方模求逆协议及其安全性的定义,3.3节和3.4节分别介绍半诚实敌手模型下和恶意敌手模型下的多方模求逆协议,并给出安全性证明,3.5节简单分析协议的效率;第4节总结全文.2张成方案和线性整数秘密共享2.1整数张成方案Karchmer和Wigderson[10]引入了有限域上的单调张成方案(MonotoneSpanPrograms,MSP),并证明了MSP和域上的线性秘密共享方案是一一对应的.后来,Damgrd和Thorbek[8]提出了线性整数秘密共享方案,并证明了整数张成方案(IntegerSpanPrograms,ISP),即上的单调张成方案,与线性整数秘密共享方案有着类似的对应关系.定义1.设P={P1,…,Pn}为n个参与方组Page3成的集合,称Γ2P为P上的存取结构,如果Γ且Γ满足:A∈Γ,AA,则A∈Γ.称2P为P上的敌手结构,如果=2P\是一个存取结构.考虑上的一个l行m列矩阵犕(记作犕∈l×m),一个标号函数ψ:{1,…,l}→P,ψ为满射以及目标向量ε=(1,0,…,0)T∈方标记犕的行,不同的行可以有相同的标记,因此可以看作是每个参与方拥有犕的一行或者多行.如果AP,则犕A表示犕中由行i组成的矩阵,其中ψ(i)∈A,lA表示犕A的行数.类似地,如果狓表示任意的l维向量,则狓A表示狓中由坐标i标识的部分向量,其中ψ(i)∈A.如果A={Pi},则用犕i,狓i,li代替犕A,狓A,lA.最后,im(·)和ker(·)分别表示矩阵对应的像(image)和核(kernel).定义2.设=(,犕,ψ,ε)为如上定义的四元组,Γ为P上的一个存取结构.称为存取结构Γ或者敌手结构=珚Γ对应的整数张成方案(ISP),如果任意的AP都满足:(1)如果A∈Γ,则存在λA=(λ1,…,λlA)T∈lA,使得犕TAλA=ε,其中λA被称为A所对应的张成向量;(2)如果AΓ,则存在κA=(κ1,…,κm)T∈使得犕AκA=0,其中κ1=1,κA被称为A所对应的消去向量.有时也称计算Γ或.定义λmax=max{|a||a为某一张成向量中的元素},κmax=max{|b||b为某一消去向量中的元素}.注1.由线性代数的基本知识可知,由κA∈ker(犕A)且κ1=1可推出εim(犕TA),然而另一个方向一般只在有限域内成立.2.2线性整数秘密共享现在引入Damgrd和Thorbek[8]提出的线性整数秘密共享(LinearIntegerSecretSharing,LISS)方案.在LISS方案中,秘密为选自一个公开区间的整数,每个份额是秘密和分发者(dealer)随机选取的一些整数的线性组合.秘密的重构也是通过计算一个授权集中份额的整系数线性组合来完成.设P,Γ的定义如前,现在有一个分发者(dealer)想在P对应的参与方中共享一个取自公开区间[0,N]的秘密s,对应的存取结构是Γ.为了实现上述目标,构造如下的秘密共享方案,称之为LISS方案:首先构造一个计算Γ的ISP(构造方法详见文献[8]的完整版),称中的矩阵犕为分发矩阵.然后选择一个分发向量ρ=(s,ρ2,…,ρm)T,其中s为秘密,ρi为均匀随机选自[0,κmax(m-1)2kN]的整数,2im,k为一个安全参数.通过下式来共享秘密s:记每个si为一个份额,1il.将第i个份额秘密地发送给参与方ψ(i).记参与方Pi的所有份额为狊Pi,参与方集合A的所有份额为狊A.定义3.称一个LISS方案是正确的,如果份额狊A和A的张成向量的线性组合可以重构秘密s,其中A为任意一个授权集.定义4.称一个LISS方案是保密的,如果对于公开区间内的任意两个秘密s,s,独立随机的掷币r,r以及任意的非授权集A,狊A和狊′A的分布是统计不可区分的,其中狊A为由s,r,k所生成的份额,狊′A为由s,r,k所生成的份额.显然,定义2中的第一个条件使得方案是正确的,因为对于任意的授权集A通过计算份额的线性组合都能够重构出秘密,也即存在一个张成向量lA使得犕TAλA=ε,从而有狊TAλA=(犕Aρ)TλA=λA∈ρT(犕TAλA)=ρTε=s.下面的引理证明了定义2中第2个条件是保证方案是保密的充分条件.引理1.如果s∈[0,N],而且对于所有的2im,ρi都是均匀随机地选自[0,κmax(m-1)2kN],则由得来的LISS方案是保密的(证明请参见文献[8]).从上面的介绍可以看到,ISP与线性整数秘密共享方案是一一对应的.可以看到使用ISP来描述协议会更加方便,因此后续的协议将使用ISP来描述LISS.2.3乘性张成方案Cramer、Damgrd以及Maurer[5]引入了有限域上张成方案的乘性性质.后来Cramer、Fehr等人[6]将乘性性质引入到了任意含1交换环上的张成方案当中.乘性性质的本质是要求两个共享秘密的乘积可以由本地份额乘积的线性组合重构得到.然而在某些情况下,给定相应的张成方案,并不清楚秘密以及份额将选自于哪个环,因此Cramer、Fehr等人[6]将乘性性质定义为张成方案自身的性质.该性质在文献[6]中被用来构造门限黑箱安全多方计算协议,本文将该性质具体到整数环上,然后利用乘Page4A∈,珡A是乘性的.设K为一个含1的交换环,Q2,Q3分别表示敌手结构中的任意两个和三个集合的并集都不等于参与者集合P.Cramer、Fehr等人[6]证明了对于任意的敌手结构,在K上存在一个(强)乘性张成方案当且仅当是(Q3)Q2的.本文将考虑一种特殊情况,即K=.因此有如下相似的结论.定理1.对于任意的敌手结构,存在一个(强)乘性ISP当且仅当是(Q3)Q2的.证明请参见文献[5,6,11].性ISP来构造一般敌手结构下的多方模求逆协议.设=(,犕,ψ,ε)为敌手结构对应的ISP.下面的定义是文献[6]中定义3的一种特殊情况.定义5.称张成方案是乘性的,如果存在一个块对角矩阵犇∈为重构矩阵.块对角矩阵可按如下理解:设犇的行和列都被ψ所标记,那么犇中的非零元素都被集中在块犇1,…,犇n中,使得对于任意的Pi∈P,犇i中的行和列都被Pi所标记.称是强乘性的,如果对于任意的参与方集合与域上的情况类似,环上的乘性性质也可以保证分布式地计算两个共享秘密的乘积.设s,s∈[0,N]为任意的两个秘密,令狊=犕ρ以及狊′=犕ρ′为s,s所对应的份额,则乘积ss可表示为ss=ρTεεTρ′=ρT犕T犇犕ρ′=(犕ρ)T犇(犕ρ′)=狊T犇狊′=∑i也即根据犇的特殊形式,ss可写为本地可计算值的和.3多方模求逆协议3.1系统模型网络模型.考虑由集合P={P1,…,Pn}中的n个参与方组成的网络.任意两个参与方之间都有一个保密的点对点信道,除此之外,所有的参与方还共享一个广播信道①.假设通信是同步的.敌手模型.通常用一个外部敌手来模仿不诚实的参与方,外部敌手可以收买(corrupt)某些参与方集合.本文考虑下面两种类型的敌手:(1)半诚实的.敌手获得了被收买的参与方所掌握的所有信息,但并不干涉他们的行为,被收买的参与方仍然忠实地执行协议.(2)恶意的.敌手完全控制了被收买的参与方.被收买的参与方可能会破坏或者终止协议,或者任意地背离协议的运行.诚实的参与方(至少初始时)并不知道哪些参与方被收买了.敌手的收买能力由敌手所能收买的参与方集合组成的子集簇-敌手结构来表征.本文假设敌手是静态的,也即在协议运行之前,敌手已经确定了要收买的参与方,而且在协议运行过程当中不再改变.3.2多方模求逆协议的定义一个多方模求逆协议是一个(,P)协议,P中所有的参与方共享一个秘密模数(Pi的份额为Pi)作为协议的一个私有输入,所有的参与方都知道公开输入e(一个素数)和N(的近似界).协议的最后,每个参与方Pi都获得一个秘密输出犱Pi,该输出是d=e-1mod的秘密共享份额.(1)正确性.称一个多方模求逆协议是正确的,如果P利用得到的份额能够重构d=e-1mod,即使在敌手A∈存在的情况下.(2)保密性.利用模拟的方法来定义保密性,也即,考虑协议运行当中敌手A的视图(view).敌手的视图包括被收买的参与方所拥有的私有输入、协议运行期间收到的来自诚实方的消息.称一个多方模求逆协议是保密的,如果对于任意的敌手A,都存在一个多项式时间模拟器S,使得S和A一起运行协议时,S提供给A的视图与真实的视图是不可区分的.(3)安全性.称一个多方模求逆协议是安全的,如果它既是正确的又是保密的.3.3半诚实敌手模型下的模求逆协议设k为安全参数,RSA模数为N,=(N)∈[0,N],公开素数e.协议的详细描述请参见图1.协议的大体流程如下.1.每个参与方Pi∈P开始运行协议,输入其私有输入Pi,i=1,2,…,n.2.协议第1轮,所有参与方共同生成三个随机的m维分发向量,相应的秘密分别为Λ,R以及0.3.协议第2轮,参与方之间交换一些有用的信息来重构F=Λ+Re.4.最后,利用GCD算法计算出a和b,使得aF+be=1,并设d=aR+b≡e-1mod.每个参与方Pi利用R的份额计算出自己对应d的份额.①使用该网络模型,可以把精力集中到协议的高层描述上.可Page5半诚实情况i=1私有输入:已用对应的乘性ISP共享了,分发向量为ρ=(,ρ,2,…,ρ,m)T,其中ρ,j∈R[0,κmax(m-1)N],j=2,3,…,m,公开输入:RSA模数N,素数e,e>n,(e,)=1;第1轮.每个参与方Pi按如下步骤运行协议第1轮:1.选择ρλi=(λi,ρλi,2,…,ρλi,m)T,其中λi∈R[0,2kN],ρλi,j∈R[0,κmax(m-1)22kN],j=2,3,…,m;选择ρri=(ri,ρri,2,…,ρri,m)T,其中ri∈R[0,2kN2],ρri,j∈R[0,κmax(m-1)22kN2],j=2,3,…,m;选择ρ0i=(0,ρ0i,2,…,ρ0i,m)T,其中ρ0i,j∈R[0,κmax(m-1)23kN2],j=2,3,…,m.2.利用式(1)共享λi,ri,0给所有的参与方,其中ρ分别被ρλi,ρri以及ρ0i代替.3.发送λiPj,狉iPj,0iPj给每个参与方Pj.第2轮.每个参与方Pj按如下步骤运行协议第2轮:1.令Λj=∑n犕ρR=犕∑n2.将值Fj=ΛT(Λ=∑j输出:每个参与方Pi做如下操作:1.将所有的广播值加起来,计算F=∑n2.利用GCD算法求出a和b,使得aF+be=1.如果找不到这样的a和b,则返回到第1轮;3.e的逆为d=aR+b.秘密地输出d的份额犱Pi=a犚i+b犕Pi,1,其中犕Pi,1表示犕Pi的第1列.注2.为了便于表示和计算,参与方Pi的份额可以设置为a犚i,在重构d时,可以首先重构得到aR,然后再加上常数b即可得到d.图1半诚实模型下的多方模求逆协议定理2.如果所有的参与方都正确地执行图1所描述的协议,并且敌手结构是Q2的,那么上述协议就是一个安全的多方模求逆协议.证明.不难看出,协议泄露的唯一信息就是值F=Λ+Re.但是可以证明F的分布是与(几乎)独立无关的.具体来讲,可以证明当Λ和R遵从协议中所描述的概率分布时,{F=Λ+Re}的分布和{^F=ΛN+Re}的分布是统计不可区分的(达O(2-k)).下面就根据3.2节的安全性定义给出具体的证明.正确性.很容易验证协议可以得到正确的输出.由于是Q2的,则存在一个与对应的乘性ISP,也即,存在一个重构矩阵犇,使得参与方利用该矩阵以及相应的份额可以重构Λ.另外也存在一个重构向量狋来重构R.因此参与方可以计算得到F=Λ+Re.然后可以将它与e做GCD运算.注意到(e,)=1,GCD(F,e)≠1的概率约为1/e(也即e整除Λ的概率),因此并不需要重复运行协议很多次.一旦找到了a和b,使得aF+be=1,可将它写为a(Λ+Re)+be=1,等式两边取mod,则等式变为(aR+b)e=1mod,这样就得到了d=aR+b=e-1mod.注意到R已由共享,而且a和b都是常数,所以由输出值犱Pi确实可以重构d.保密性.(1)初始输入.敌手A知道所有被收买的参与λi,R=∑ni=1方所拥有的私有输入.模拟器可以利用相同的ISP来共享N,并将相应的份额分发给A.由于N-=O(槡N),仿照引理1,可以证明是保密的,份额犖A和A是统计不可区分的.(2)接收到的消息.协议第1轮,模拟器只需简单地遵从协议即可,这样第1轮过后,模拟器共享了^Λ,^R和^Z.显然,^Λ,^R,^Z与Λ,R,Z遵从相同的分布.同时注意到,与初始输入类似,敌手不能获得^Λ,^R和^Z的任何信息.协议第2轮,模拟器广播值^Fj=^ΛTj犇j犖Pj+e〈狋j,^犚j〉+〈狋j,^犣j〉(对于所有的Pj∈珡A).因为ρZ和ρZ^中的元素分别要比ρR,ρΛ,ρ和ρR^,ρΛ^,ρ^中的元素分别高出一到三阶(相对于安全参数k和N),因此〈狋j,犣j〉和〈狋j,^犣j〉分别要比ΛTe〈狋j,犚j〉和^ΛT全参数k),从而Fj和^Fj的分布都在统计上与〈狋j,犣j〉的分布接近.最后敌手将所有的广播值加起来,得到^F=^ΛN+^Re,而在实际的协议中敌手将得到F=Λ+Re,这是模拟器与实际协议的唯一区别.然而可以证明这两个值的分布是统计不可区分的.此处省略了该证明过程,读者可参见文献[4]的完整版.证毕.3.4恶意敌手模型下的模求逆协议本节来考虑恶意敌手模型下的多方模求逆协议.我们构造了一个一般性模求逆协议,并证明了如果敌手结构是Q3的,那么该协议在强RSA假设之下是安全的.协议的具体描述详见图2.Page6私有输入:已用对应的强乘性ISP共享了,分发向量为ρ=(,ρ,2,…,ρ,m)T,并选择ρ^=(^,ρ^,2,…,ρ^,m)T对ρ做承诺,其中一般性模求逆协议公开输入:RSA模数N,素数e,e>n,(e,)=1以及利用ρ^得到的关于ρ的公开承诺.第1轮:每个参与方Pi选择λi∈R[0,N2k]和ri∈R[0,N222k],然后进行如下操作:;1.使用VLISS来共享λi,界为N2k,得到的分发向量分别为ρλi和ρλ^i2.使用VLISS来共享ri,界为N222k,得到的分发向量分别为ρri和ρr^i;3.使用VLISS来共享0,界为N323k,得到的分发向量分别为ρ0i和ρ0^i.注3.在此仅用到了VLISS的分发阶段,其中得到的ρλ^i设A为第1轮中所有通过VLISS验证的参与方组成的集合,令Λ=∑Pi∈A第2轮:每个参与方Pj进行如下操作:1.将从第1轮中收到的所有来自A中参与方的份额加起来,也即,令注4.这些份额是由分发矩阵犕A和分发向量ρΛ,ρR,ρZ,ρΛ^,ρR^,ρZ^生成的.Λj,犚j,犣j的承诺值可以由VLISS得到.2.将值Fj=ΛT输出:每个参与方Pi进行如下操作:1.Pi利用图4描述的子协议Prove-Correct来证明Fi是正确的.令A为所有能够正确执行Prove-Correct的参与方组成的集合.如果A=A,则继续执行后续步骤;否则返回到第2轮,并将A赋值给A,重新运行,直至运行到这一步满足A=A为止.2.A中的每个参与方Pi计算F=∑Pi∈A3.利用GCD算法,求出a和b,满足aF+be=1.如果不存在满足上述条件的a和b,则返回到第1轮.4.每个参与方Pi秘密地计算相应的份额犱Pi=a犚i+b犕Pi,1,其中犕Pi,1为犕Pi的第1列.图2恶意敌手模型下的多方模求逆协议在恶意敌手模型中,恶意的参与方可能任意地背离协议来干扰诚实方得到正确的输出,或者想方设法地获取诚实方的私有信息.多方模求逆协议要求即使在恶意敌手存在的情况下,诚实方仍然能够保密地计算得到正确的输出.为了做到这一点,本文采用了如下两种常用技术:VLISS分发阶段公开输入:RSA模数N,两个生成元G,H∈QN以及界β.分发者(dealer)的输入:秘密s∈[0,β].1.分发者选择s^∈R[0,β]以及ρ2,ρ^2,…,ρm,ρ^m∈R[0,κmax(m-1)2kβ].令ρs=(s,ρ2,…,ρm)T,ρs^=(s^,ρ^2,…,ρ^m)T.利用式(1)在P中共享s,s^,将值狊Pi2.参与方Pi验证(Cw)MPi,j,wmodNw=1其中sPi,j和s^Pi,j分别为狊Pi和狊^Pi中的第j个元素,MPi,j,w为犕Pi中第j行的第w个元素.如果验证失败,Pi则公开投诉.如果所有投诉的参与方能够形成一个授权集,那么分发者将被弹劾.3.如果分发者没有被弹劾,他会公开满足式(2)的值狊Pi和狊^Pi.如果分发者不能正确执行这一步,他将被弹劾.4.Pi验证他接收到的值以及分发者之前广播的值在绝对值上是否都被限制在界κ2max(m-1)22kβ+κmaxβ之内.如果验证失败,Pi则会公开他的份额.如果公开的份额确实比κ2max(m-1)22kβ+κmaxβ大,而且满足式(2),那么分发者将被弹劾.重构阶段每个参与方Pi出示狊Pi和狊^Pi,只有满足式(2)的值才会被接受.利用常用的LISS来重构秘密s,然后将它输出.图3可验证线性整数秘密共享方案(VLISS)λi,R=∑Pi∈Aρri,ρZ=∑Pi∈Aρr^i,ρZ^=∑Pi∈A狉iPj,犣j=∑Pi∈A^狉iPj,^犣j=∑Pi∈A(1)将第1轮中简单的线性整数秘密共享方案替换为可验证线性整数秘密共享(VLISS,Peders-en-VSS[9]的一个变体)方案,来保证参与方在分布式生成随机数时执行正确的秘密共享,保证每个参与方共享得到的份额是一致的.图3给出了VLISS的详细描述.Page7Prove-CorrectP的私有输入:犪,犪^,犫,犫^,犮,犮^(定义如上所述).公开输入:RSA模数N,两个生成元G,H∈QN,素数e,e>n,(e,)=1.F和承诺值Ai,Bi,Ci,i=1,2,…,u,Cρ,j,j=1,2,…,m.目标:证明F=犪T犇P犫+e〈狋,犮〉1.V验证公开承诺值Ai,Bi,Ci和Cρ,j是否满足式(2).2.Ρ随机选择一个矩阵Δ∈[0,N2]u×u并且公开Eij=GaibjHΔij,i,j=1,2,…,u.3.Ρ以零知识的形式(向验证者V)证明Eij相对Ai,Bj(i,j=1,2,…,u)是正确的:(a)Ρ随机选择α,α^,β,β^∈[0,N323k]u以及Δ^∈R[0,N323k]u×u,并将Mi=GαiHα^i,Xi=GβiHβ^i,Yij=BαijH^Δij发送给V.(b)V随机选择θ∈[0,N],并将其发送给Ρ.(c)Ρ返回xi=αi+θai,x^i=α^i+θa^i,yi=βi+θbi,y^i=β^i+θb^i,zij=Δ^ij+θ(Δij-b^jai).(d)V接受Eij是正确的,如果GxiHx^i=MiAθi,BxijHzij=YijEθij,GyiHy^i=XiBθi.4.Ρ公开F=犪T犇Ρ犫+e〈狋,犮〉和F^=∑ij(Eij)DΡij∏i图4如何证明F=犪T犇P犫+e〈狋,犮〉(2)第2轮重构F时,利用Prove-Correct零知识证明协议来防止恶意的参与方提供错误的份额。图4给出了Prove-Correct协议的具体实现.为了便于理解和描述,本文先给出一般性模求逆协议的具体描述,之后再分别给出VLISS和Prove-Correct的具体描述.设k为安全参数,RSA模数为N,=(N)∈[0,N],公开素数e.一般性模求逆协议的完整描述见图2.在一般性模求逆协议中,“使用VLISS共享s,界为β”表示共享s时,选取区间[0,β]的元素来为s做承诺,分发向量中其它元素也由β的常数倍界定.假设所有的参与方都会通过下面的承诺方案对分发向量ρ中的元素做承诺,并作为公开输入的一部分,在执行Prove-Correct协议时会用到这些承诺.VLISS协议也会用到下面的承诺方案C:公开参数为一个RSA模数N=pq(p=2p+1,q=2q+1,p,p,q,q都是素数)以及两个随机元素G,H∈QN.QN为阶循环群.可设G,H为QN的两个生成元,因为它们不是生成元的概率是可忽略的.消息空间为一个整数集.为了对整数α做承诺,发送方在某个给定的区间内(比如[0,N2])随机选择一个整数α^,将C(α,α^)=GαHα^modN发送给接收方.解承诺时,发送方给出α,α^,接收方验证他们是否与C(α,α^)匹配.引理2.在分解N是困难的假设之下,上述承诺方案是一个信息论意义下保密、计算意义下绑定的承诺方案.相关证明请参见文献[4]的完整版.当在多方模求逆协议中执行子协议Prove-Cor-(Ci)etimodNrect时,每一个参与方都会充当证明者运行Prove-Correct一次.验证者的挑战将由其他所有的参与方共同生成.Canetti等人[12]证明了该协议是一个诚实验证者零知识协议,因为每个运行该协议的证明者面对的是由其他所有参与方组成的一个“虚拟”的验证者.该验证者被强制是诚实的,因为其它所有的参与方中的大多数都是诚实的.3.4.1可验证线性整数秘密共享方案在一般性模求逆协议中,考虑到是在整数环上进行秘密共享,因此本文给出了Pedersen-VSS[9]的一个变体-可验证线性整数秘密共享(VLISS)方案.在Pedersen的方案中,秘密和份额被视为某个循环群〈g〉的“指数”.因此在份额和群元素之间存在一个有效的映射xgx,参与方可以利用群运算来验证份额的各种性质.在VLISS中,秘密和份额则被视为循环群QN的“指数”,因此参与方同样可以利用群运算来验证份额的正确性.后面将证明,在分解N是困难的假设下,VLISS是一个安全的VSS.协议VLISS的具体描述请参见图3.注5.为了保证VLISS是一个安全的VSS,协议中的第4步并不是必须的.多方模求逆协议需要这一步是因为Pedersen-VSS并没有提供工具来保证所共享的秘密是“足够小的”,而协议的保密性就依赖于我们知道秘密大小的某个界值.例如,如果F=Λ+eR中Λ的大小比其它项大很多,那么F就会泄露的部分信息.因此,每个参与方都要验证一下相应的份额是否界定在某个区间[0,κ2max(m-1)22kβ+κmaxβ]之内,以此确定相应的秘密是否落在区间[0,λmaxκ2maxn(m-1)22kβ+λmaxκmaxnβ]内.引理3.如果是Q2的,那么在分解N是困难的假设之下,针对敌手结构,图3描述的协议Page8VLISS是一个安全的VSS.证明.正确性.由于是Q2的,对于任意A∈,珡A是一个授权集,正确性可由珡A实现.而且,协议中的承诺是计算意义下绑定的,敌手在解承诺时,无法给出两个不同的解.因此任何恶意的参与方都能够被检测出来.保密性.很容易验证敌手所拥有的份额其分布是和其它秘密所生成份额的分布是统计不可区分的,也即敌手从拥有的份额中无法获得秘密的相关信息.这一点是由LISS的保密性来保证的(参见引理1).另外,敌手看到的对分发向量的承诺是信息论意义下保密的,因此从中敌手也无法获得秘密的相关信息.3.4.2份额正确性的证明在一般性模求逆协议第2轮重构F时,必须要防止恶意的参与方提供错误的份额,这是通过图4介绍的Prove-Correct零知识证明协议实现的.该协议使用了Fujisaki和Okamoto[13]提出的一项基于强RSA假设的技术,其中N同样是两个安全素数的乘积.定义6(强RSA假设).给定RSA模数N和一个随机元素y∈数对(e,x),其中x∈xe=y(modN)的成功概率是可忽略的.强RSA假设是由文献[14]提出来的,后来被很多协议[1-3,13]使用.假设使用前面介绍的基于分解困难性假设的承诺方案来对共享时的分发向量做承诺.这样一般性模求逆协议的公开输入就包括Cρ,j=Gρ,jHρ^,jmodN,j=1,2,…,m,其中ρ,1=,ρ^,1=^.以概括如下:有如下公开值:在一般性模求逆协议中,参与方面临的问题可以及其它公开输入,例如e,犇,狋以及上面介绍的Cρ,j.参与方Ρ已知犪=(a1,…,au)T,α^=(α^1,…,α^u)T,犫=(b1,…,bu)T,^犫=(^b1,…,^bu)T,犮=(c1,…,cu)T,犮^=(c^1,…,c^u)T,并公开了一个值F,现在需要证明F=犪T犇Ρ犫+e〈狋,犮〉.在一般性模求逆协议中,每个参与方Pi都要执行上述证明过程,并将犪=Pi,α^=^Pi,犫=Λi,^犫=^Λi,犮=犚i,犮^=^犚i以及犇Ρ=犇i作为输入.为了便于描述,此处没有考虑随机化子(randomizers)犣i和^犣i.该零知识证明是一个统计零知识协议,这是因为犪T犇Ρ犫是O(N222k)的,通过在区间[0,N323k]中随机选择元素,可以保证在协议中第3(c)步时,证明者的回答与区间内的随机数是统计不可区分的.上面介绍了VLISS和Prove-Correct协议,并做了简单分析和证明.本节最后,给出一般性模求逆协议的安全性证明.定理3.如果敌手结构是Q3的,那么在强RSA假设下,图2描述的一般性模求逆协议,在恶意敌手存在的情况下是一个安全的多方模求逆协议.证明.正确性.利用VLISS和Prove-Correct两个子协议,可以筛选出一般性模求逆协议中的恶意参与方.而且很容易验证一般性模求逆协议能够计算出正确的输出.因为是Q3的,所以在输出的第一步时,可以找到一个A=A,并且A是乘性的,因此可以由所有诚实方的份额犱Pi(Pi∈A)重构得到d.保密性.在强RSA假设下,分解N是困难的,因此子协议VLISS是一个安全的VSS.同时,子协议Prove-Correct是一个统计零知识协议.因此一般性模求逆协议的保密性大部分可以由VLISS的保密性和Prove-Correct的零知识性来保证,其它部分与半诚实敌手模型下的证明类似.与半诚实模型不同的是敌手在选择λi时可能会超出指定的区间[0,N2k].但是,正如在注5中所说的,敌手能够通过VLISS验证仅当λi是O(N22k)的,最终Λ将是O(N23k)的.为了补偿Λ扩大的范围,有必要增加R的取值范围以及共享0时的界,这就是为什么要求ri取自区间[0,N222k]以及共享0时界为N323k.证毕.3.5协议的效率分析为了研究一般敌手结构上多方模求逆协议的存在性,本文并没有花费过多的精力去提高协议的效率和减小运算中整数的大小.但相关的协议确实能够更优化一些,运算中的一些整数大小是可以减小的,这一点对于份额犱Pi来讲尤为重要,因为在多方RSA签名中会使用该份额来做指数运算,显然份额越小,计算起来越方便.在半诚实模型下的多方模求逆协议中,每个份额的大小都限定在O(N223k),而在恶意敌手模型下的多方模求逆协议中,每个份额的大小都限定在O(N323k).根据不同的应用场景,可以选择合适的安全参数k和RSA模数N来减小份额的大小.多方模求逆协议是Catalano、Gennero和Hale-vi[4]门限协议的一个推广.实际应用时,如果面临的Page9是门限敌手结构,可以使用Vandermonde矩阵作为分发矩阵,因此相应的ISP是乘性的(如果n>2t,t为门限值)或者强乘性的(如果n>3t).因此两个协议拥有相同的效率.但多方模协议同样适合其它非门限类型的敌手结构.对于其它非门限类型的敌手结构,可以根据计算的一般ISP来构造乘性或者强乘性的ISP.Cramer、Damgrd和Maurer[5]证明了对于Q2类型的敌手结构,存在有效的算法将计算的一般的ISP转化成计算相同敌手结构的乘性ISP,而乘性ISP的大小仅是原ISP大小的两倍.然而,如何有效地将计算Q3类型的敌手结构的一般性ISP转化成计算相同敌手结构的强乘性ISP仍然是一个公开难题,但Cramer、Damgrd和Maurer[5]给出了的上界.因此最终协议运行完之后,每个参与方可能持有多个份额,所有份额的大小将会比门限情况下的份额大小要大一些.在两种敌手模型下的多方模求逆协议中,本文都将文献[4]中的拉格朗日插值替换为简单的加法运算,只需将所有广播的份额简单加起来即可,因此计算起来会比文献[4]略快一些.有兴趣的朋友可以尽一步优化和改进上述协议,也欢迎更多的朋友去设计新的高效协议来解决分布式模求逆问题.4总结本文构造了两个一般敌手结构下的多方模求逆协议:一个是半诚实模型下的,在敌手结构是Q2的条件下是安全的;另一个是恶意敌手模型下的,在敌手结构是Q3的条件下以及强RSA假设下是安全的.在协议的构造中,使用了线性整数秘密共享方案,在做环上的运算时,避免了黑箱调用.因此,本文构造多方协议的方法对文献[6]是一个有力的补充.
