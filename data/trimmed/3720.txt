Page1图像稀疏表示的结构自适应子空间匹配追踪算法研究孙玉宝1),2)肖亮2)韦志辉2)刘青山1)1)(南京信息工程大学信息与控制学院自动化系南京210044)2)(南京理工大学计算机科学与技术学院南京210094)摘要如何设计高效的图像稀疏表示模型及其分解算法是稀疏表示领域的研究热点.文中首先构建了图像的结构自适应多成分稀疏表示模型,该模型采用相对阈值标准对图像进行结构自适应的四叉树区域剖分,并将其分类为平滑、边缘和纹理结构的同性区域,构建与其结构形态相一致的多成分字典进行表示.进一步提出了一种结构自适应的子空间匹配追踪图像稀疏分解算法,将每一区域只在与其结构类型相一致的单一结构类型子成分字典中进行低维子空间搜索,降低了图像维数与字典搜索复杂度,提高了稀疏分解效率.实验结果验证了文中算法的有效性.关键词稀疏表示;匹配追踪;多成分字典;四叉树分解1引言在图像处理领域中寻求图像的有效表示方式是一个基本问题.从计算调和分析的角度看,图像可以表示为一组基函数的线性组合,如Fourier基函数、余弦函数、小波函数等等.Fourier基函数可以对平稳信号形成有效表示,然而工程应用中的信号通常是非平稳的奇异信号.小波可以对非平稳信号进行形成多分辨的时频局部化分析,然而二维小波的各向同性特点使得它在表示自然图像的各向异性特征如边缘、轮廓等方面效率不高,在边缘、轮廓处仍然聚集了大量的大幅度小波系数.受人类大脑视觉皮层神经元响应的稀疏性启发[1],Olshausen和Field[2-3]提出了一种对自然图像更为有效的表示方法:稀疏表示(SparseRepresentation).稀疏表示模型要求图像线性展开中大部分基函数的系数为零,只有少数的基函数具有非零的大系数,这里称基函数为原子,所有原子信号的集合为字典.稀疏表示使信号能量只集中于较少的原子,具有非零系数的原子能够最优匹配图像的模式结构,揭示了信号的主要特征与内在结构.当字典中原子个数L大于信号维数N且包含N个线形无关的原子能够张成整个信号空间RN时,字典为过完备的(Overcomplete)或冗余的(Redundant).信号在此冗余字典下的分解并不唯一,这为信号的自适应稀疏表示提供了可能.制定合适的稀疏性度量标准,可寻求信号在此字典下的最稀疏表示.当采用L0范数度量信号的稀疏性时,基于冗余字典的信号稀疏表示模型可表示为其中,犳∈RN为待分解信号,维数为N;α∈RL为系数向量,维数为L;L0范数定义为系数向量α中非零系数的个数α0=#{i,α[i]≠0};将冗余字典中的L个原子作为列向量形成稀疏表示矩阵Φ∈RN×L.由于L0范数是非凸的,求解基于冗余字典的信号稀疏表示是一个需要组合搜索的NP-hard问题,需要采用次优的逼近方法.研究者对此问题展开了广泛而深入的研究,提出了许多获取信号稀疏逼近的优化算法,主要为凸松弛算法(ConvexRelaxationalgorithm)与贪婪算法(Greedyalgorithm).凸松驰算法将L0范数凸化,进而使用凸优化算法进行逼近求解,主要包括基追踪算法[4]、FOCUSS[5]、迭代阈值收缩算法[6]、梯度投影算法[7]、交叉投影算法[8]等.贪婪追踪算法的主要思想是通过特定的相似性度量准则从字典中逐次选择用于信号分解的原子,不断迭代此过程可构成对原信号的稀疏逼近.典型的贪婪算法有匹配追踪[9]与正交匹配追踪[10].尽管凸松弛算法可以简化问题的求解,但算法的有效性往往依赖于字典自身是否存在快速变换,而贪婪算法则可适用于一般的冗余字典.总体而言,匹配追踪是现有稀疏分解算法中复杂度较低的算法,每一次迭代的运算复杂度为O(L·N2),其中L为字典中原子个数,N为图像的维数.但当图像维数较高或字典中原子数较多时,匹配追踪算法的复杂性仍然很高.设计有效的稀疏表示过完备字典是图像稀疏表示理论中的另一个重要问题.研究者们已经提出了许多冗余字典,如小波包字典、小波和正弦函数的级联、局部余弦字典、Grassmann框架,AnisotropicRefinement-Gaussian(AR-G)混合字典[11]等.由于图像为二维复杂信号,包含平滑、边缘、纹理多种结构成分,上述字典只能有效表示单一的成分,而不能同时对上述多种结构成分形成稀疏表示.尽管AR-G混合字典能够稀疏表示图像中的边缘轮廓,却不能对纹理结构形成稀疏表示.Starck等人[12-13]提出的图像形态成分分析方法(MorphologicalComponentAnalysis,MCA)采用DCT表示纹理,Curvelet[14]表示边缘.在分解中,MCA应用交替迭代数值算法对整个图像交替使用DCT与Curvelet变换,进而形成对图像中边缘与纹理结构的分离与稀疏表示.但要求所使用的字典具有快速的分解与重构算法,而一般的冗余字典并不存在这样的快速算法,如各向同性Gabor字典、AR-Gauss混合字典等.文献[15]构建了Gabor感知多成分字典进行分解,通过调制Gabor函数的空间频率带宽生成平滑、边缘以及纹理3种结构形态的子字典,能够有效表示图像中的多种形态结构.然而先前算法均使用整个多形态分字典对整幅图像进行稀释分解,尽管有利用表示图像中的多形态结构,但是由于图像维数高,字典原子个数众多,从而大幅增加了稀疏分解算法的运算复杂度.鉴于以上分析,如何设计高效的图像稀疏表示模型及其分解算法是一个难点问题.稀疏分解算法的复杂度主要取决于图像的维数与字典中原子个数,降低图像维数与缩减字典中原子个数可以提高稀疏分解算法的效率.同时字典中原子应能够有效匹配图像中的平滑、边缘、纹理等局部结构,越匹配越易形成稀疏表示.基于此分析,本文构建了图像的结构自适应多成分稀疏表示模型,依据一定的同性Page3测试标准对图像进行结构自适应的四叉树区域剖分,使得分解后每个子块为结构同性区域.对每一区域根据结构内容分类为平滑、边缘或纹理结构类型区域,相应地每一区域只在与其几何结构类型一致的单一子成分字典中进行低维子空间的匹配追踪稀疏分解.因此,不仅降低了图像的维数同时降低了搜索字典的复杂度,并且每一子块可并行实现,从而获取了一种高效的稀疏表示算法:结构自适应子空间匹配追踪图像稀疏表示算法.实验结果验证了本文算法的高效性.2图像的结构自适应多成分稀疏表示模型图像是一种包含多种结构成分的复杂信号,不同区域呈现出不同的结构类型.平滑、边缘轮廓、纹理是图像中视觉感知重要的结构形态,传递着重要的视觉信息.借助于集合概念,本文将图像分解为互不重叠的平滑、边缘和纹理结构类型区域其中,集合Ωimage代表整个图像区域,为不同结构类型子块的并集,并且每个子块Ωi均满足同性判别标准,是结构同性区域,分别为平滑(Smooth)、边缘(Edge)和纹理(Texture)这3种结构类型之一;子集Ωsmooth由平滑结构类型子块Si组成,Ωsmooth=∪iSi;相应地,Ωedge,Ωtexture分别由边缘结构类型子块Ej、纹理结构类型子块组成Tk,Ωedge=∪jEj,Ωtexture=∪kTk.为了形成稀疏的图像表示方式,字典中原子应能有效匹配图像中的平坦、边缘轮廓、纹理等多种局部几何结构,增加字典中原子种类数形成非正交的冗余系统,可提高匹配的灵活性,有利于形成对图像这类复杂信号的稀疏表示.为此依据上面的图像结构分解模型(2),分别建立适合于表示图像中平滑、边缘与纹理结构区域Ωsmooth,Ωedge,Ωtexture的子成分字典犇smooth,犇edge,犇texture,这些子字典相互补充,组合为一个大的冗余多成分字典(Multi-ComponentDictionary,MCD):犇smooth,犇edge,犇texture能够有效匹配图像中的多种重要结构,形成对图像的有效表示.图像Ωimage依据多成分字典的结构自适应稀疏表示模型可表示为minαs0+αe0+αt0s.t.Ωimage=Φsmoothαs∪Φedgeαe∪Φtextureαt(4)其中,Φsmooth,Φedge,Φtexture为各子成分字典犇smooth,犇edge,犇texture中的原子作为列向量依次排列所形成的字典矩阵,αs,αe,αt分别为图像子集Ωsmooth,Ωedge,Ωtexture在子成分字典犇smooth,犇edge,犇texture下的稀疏分解分解系数.本文称式(4)为图像的结构自适应多成分稀疏表示模型,这里的多成分模型不同于文献[15]的表示模型,该模型侧重于多成分过完备字典的分析与设计.同时与文献[12-13]的MCA(MorphologicalComponentAnalysis)模型也不相同,尽管该模型认为图像包含多种形态的结构成分,但并没有对图像进行结构自适应的空间区域剖分.本文模型(4)在对图像进行多形态结构成分建模的同时,进一步考虑如何将多成分字典更加高效地应用于图像的稀疏表示与分解算法中.在应用模型(4)时,如何对图像进行自适应区域分解与结构类型判断是有待解决的问题,同时如何选择与设计能够有效匹配图像中平坦、边缘轮廓、纹理结构的子成分字典也是一个难点问题.文献[15]从图像的几何结构特性与人类视觉感知特性出发,选用Gabor感知多成分字典,包含平滑、边缘、纹理这3种结构类型的子成分字典.并依据视觉皮层神经元的响应特性、组织方式与自然图像的几何结构特性约束字典生成函数自由参数的取值范数,大幅度地缩减了字典中原子个数,有利于提高稀疏分解效率.因此在模型(4)下,选用文献[15]的Gabor感知多成分字典对图像中相应结构类型区域进行稀疏分解.在下一节中将分析如何利用自适应四叉树分解与基于DCT变换的块分类算法得到关于图像中平滑、边缘、纹理区域的剖分与精细分类.3自适应四叉树分解与块分类依据建立的结构分解模型(2),可以通过四叉树分解与块分类技术实现图像关于平滑区域、边缘区域、纹理区域的精细分解与分类.四叉树分解是经常使用的图像分解技巧,依据一定的结构同性测试标准,它可将图像自适应地剖分为可变大小的二维结构同性区域(HomogenousRegions).为了形成对图像的有效分解,研究者们提出了多种同性测试标准,如视觉熵、对比度、方差、能量等等.以往通常采取的分割策略为:当目前子块的测试结果小于给定的阈值时,则不再分割,否则继续分割.本文给出了一种新的四叉树分割策略,对于当前大小为2n+1×2n+1的子块犡n+1,假定分割后大小为2n×2n的4个孩子Page4结点分别记为犡n,i,i=1…4,当maxi=1…4measure(犡n+1)-measure(犡n,i)ξ(5)即当前结点的测试结果measure(犡n+1)与其4个孩子结点的测试结果measure(犡n,i)之间差的最大绝对值小于给定的阈值ξ时,则不再分割的,否则继续分割.可以认为以往的分割策略采用绝对阈值,这里采用相对阈值,从而能够自适应于图像的局部特性,形成更有效的分解.根据应用目的,四叉树分解过程中还可约束最大子块与最小子块.共生矩阵法在图像的纹理特征分析中具有广泛的应用[17].本文通过对归一化的灰度共生矩阵构建同性测试标准.首先计算当前节点的4个孩子节点的归一化灰度共生矩阵犆n,i,进而可快速计算出当前节点的灰度共生矩阵犆n+1,并由此计算每个子块的熵其中,Cij为共生矩阵元素,生成灰度共生矩阵时,选取像素间隔为1,并分别计算0°,45°,90°与135°这4个方向的灰度共生矩阵,由式(6)计算熵,并取4个方向的均值为同性度量标准.图1(a)、(c)、(e)给出了对512×512Lena、Barbara与Clock标准测试图像的四叉树分解结果,选择分割阈值ξ=0.87,并约束子块大小范围为64×64~8×8.可以看出,在图像结构类型发生变化的地方形成较细的分割,而同一结构类型区域则具有较大的子块,达到了使分割后每一子块为结构同性区域的预期目标.四叉树分解后,需将每一子块区域分类为平滑(SMOOTH)、边缘(EDGE)、纹理(TEXTURE)这3种结构类型之一.文献[16]中给出了3种结构类型的分类方法,为了文章的完整性,这里简单地叙述一下文献[16]中的基于DCT变换的块分类方法.它将每个子块的DCT变换系数分为直流区、低频区、中频区与高频区,分别记每个区域DCT变换系数绝对值和为D、L、M、H.子块的纹理能量可以近似计算为M+H,纹理能量低的子块通常为平滑子块,但纹理能量高的子块不一定都为纹理子块,因为边缘子块同样具有较高的纹理能量,进一步依据比率L+M/H与L/H来鉴别纹理与边缘子块,通常大比率的子块为边缘子块.详细的分类算法请参见文献[16].依据图1(a)、(c)、(e)中的四叉树结构,应用上面的分类算法,块分类结果如图1(b)、(d)、(f)所示.图1(b)、(d)、(f)中黑色区域代表平滑结构,灰色区域代表纹理结构,白色区域表示边缘结构.从实验结果可以观察出,分类算法比较准确地检测出了子块的结构类型.四叉分解中只需计算子块的方差,图1自适应四叉树分解与块分类((a)、(c)、(e)分别为Lena、Barbara与Clock图像的自适应四叉树分解结果;(b)、(d)、(f)为相应的块分类结果)块分类中则只需计算子块的DCT变换系数,从而只需很少的计算量,同时在整个稀疏分解算法中四叉树分解与块分类只需执行一次.4结构自适应子空间匹配追踪算法匹配追踪是一个迭代的贪婪算法,它在每一次迭代过程中,将残差信号向字典中与其最相关的一个原子投影,逼近误差形成新的衰减的残差,每一次投影都使对原信号的逼近更为优化,巧妙地降低了计算复杂性.对于小波包字典或局部余弦字典,匹配追踪每一次迭代的复杂度为O(Nlog2N).由于匹配追踪算法所挑选的原子并非先验的正交于先前选择的原子,并不能得到最优的逼近.正交匹配追踪算法利用Gram-Schmidt正交化过程将投影方向正交化来改进匹配追踪逼近,做有限次迭代即可收敛,这在非正交投影情况下是做不到的.但这样做的代价是正交化过程所需要的巨大计算开销,正交化M个原子需要O(NM2)次运算,对于M较大的情况,正交Page5化过程使得正交匹配追踪的计算复杂性显著地增大.尽管对稀疏分解算法的研究取得了很大的进展,但当前算法复杂性仍然很高,如何提高稀疏分解效率是一个难点问题.运用贪婪的追踪方法对图像进行稀疏分解的计算复杂性主要表现为字典中原子张成的高维空间与图像空间(或图像残差空间)的匹配搜索过程,算法的复杂度取决于图像的维数与字典中原子个数,降低图像维数与缩减字典中原子个数可以提高稀疏分解算法的效率.基于此分析,依据第2节建立的图像结构分解模型(2),制定一定的结构同性测试标准,将图像进行结构自适应的四叉树分解,使分割后每个子块为结构同性区域,从而只需在与其结构类型相同的单一子成分字典下即可形成稀疏表示.为了确定适合于表示每一子块的子成分字典,依据每一子块的结构内容进行分类,判断出每一子块的几何结构类型:平滑、边缘或纹理结构,相应地只在与其几何结构类型一致的单一子成分字典中进行低维子空间的稀疏分解,实验结果(见本文第5节)验证了本文思想的有效性.因此不仅降低了图像的维数同时降低了搜索字典的复杂度,并适合并行实现.现有的稀疏分解算法都可以用来获取每个子块的稀疏表示,由于匹配追踪稀疏分解算法复杂度较低,因此本文选取匹配追踪对每一子块进行自适应分解,从而获取了一种高效的结构自适应子空间匹配追踪图像稀疏表示算法.算法具体步骤如算法1所示.算法1.结构自适应的子空间匹配追踪图像稀疏分解.输入:待分解图像犳,残差能量ξstop输出:各子块的匹配追踪稀疏逼近图像1.构建离散的Gabor感知多成分字典.2.对输入图像进行结构自适应四叉树分解与块分类,记分解后的子块为{犅k}1kK,K为总块数,初始化k=1.3.自适应选择与当前子块犅k结构类型一致的子成分字典犇j用于子空间匹配追踪稀疏分解.4.初始化:令初始残差信号为原信号R0犳=犅k,初始迭代次数i=0,并计算原始信号与子成分字典犇j中所有原子的内积:αγ=〈R0犳,γ∈Γj〉.5.内积极大化搜索:γi=argmaxγ∈Γj6.残差信号更新:Ri+1犳=Ri犳-αγiγi.7.内积系数更新:αγ=〈Ri+1犳,γ∈Γj〉.8.迭代停止规则:如果残差信号能量小于给定的值Ri犳2ξstop,停止迭代,转至步9.否则,i=i+1,转至步5.9.整体停止规则:如果k<K,k=k+1,转至步3继续分解;否则算法停止.追踪完成后,可获得每个子块的稀疏逼近.当追踪的原子个数较少时,在各子块区域的边界可能存在块效应.为了避免由区域剖分引起的块效应,适当增加每个子块区域的尺寸,使得选取的各子块区域边界存在重叠,每个子块分解完毕时,在边界区域对分解结果进行优化计算,为此,本文建立去除块效应的目标函数如下其中,犳为优化变量,犳k为各子块的稀疏逼近重建图像,犚i为nk×N的矩阵,从图像f提取子块犅k,nk为子块犅k的维数,式(7)为二次优化问题,存在解析的最优解,去除块效应后的图像为应用式(8)可获得去除块效应后的匹配追踪稀疏重建图像.5实验结果与分析为了验证本文结构自适应多成分稀疏表示模型及其子空间匹配追踪算法的性能,实验中选取文献[15]的Gabor感知多成分字典作为图像中相应结构类型区域的稀疏表示字典,本文给出了一系列实验结果.依据文献[15]的方法对自由参数进行采样构建离散Gabor感知多成分字典,同时为了进一步分析字典离散采样密度对稀疏逼近性能的影响,分别只取纹理子字典中带宽b=0.5与边缘子字典中b=1.5的原子构成两个低密度Gabor字典用于稀疏分解.图1给出了512×512Lena、Barbara与Clock标准测试图像的四叉树分解与块分类结果,图2(a)、(g)则给出了两个取自Barbra图像的64×64子块区域,块分类结果分别为纹理与边缘结构区域.本文对两个子块分别使用AR-G混合字典、整个Gabor感知多成分字典、相应结构类型的Gabor子成分字典与低密度Gabor字典以及DCT或Curvelet等5个字典进行匹配追踪稀疏分解,混合字典采用文献[11]中的离散计划,Gabor感知多成分字典采用文献[15]给出的离散形式.纹理子块在以上5个不同字典下使用前100个大系数原子的重构图像分别如图2(b)~(f)所示,图2(h)~(l)则分别给出了边缘子块在5个不同字典下使用前30个大系数原子的重构图像.表2列出了两个子块在不同字典下使用相同原子个数的重构图像峰值信噪比PSNRPage6(PeakSignalNoiseRatio).尽管随着本文字典离散采样密度的大幅降低,但稀疏逼近图像的PSNR并没有随之大幅降低,从而表明本文字典的有效性.图2(m)、(n)分别为(a)、(g)在整个Gabor感知多成分字典稀疏分解中各种结构类型原子所占比例,可以看出尽管使用整个多成分字典进行稀疏分解,但最终选择的原子仍大部分取自相应结构类型的子成分字典,同时重构PSNR相差较小,从而证实了本文只使用与其相同结构类型一致的单一子成分字典进行稀疏表示思想的有效性.尽管使用整个多成分字典重构PSNR要高,但应用于压缩编码时则需要更多的比特来编码原子序号,同时也增加了分解时字典搜索复杂度.图2实验结果((a),(g)为原64×64子块图像;(b)、(h),(c)、(i),(d)、(j),(e)、(k),(f)、(l)分别为图像子块(a)、(g)在AR-G混合字典、整个Gabor感知多成分字典、相同结构类型的单一子成分字典与低密度字典,DCT(f)或Curvelet(l)下的匹配追踪稀疏逼近图像;(m)、(n)分别为图像子块(a)、(g)在整个Gabor感知多成分字典稀疏分解中各种结构类型原子所占比例)图3则比较了不同字典下重构信号PSNR随着原子个数增加而增加的函数图形.从图3与表2可以看出,由于Gabor感知多成分字典能够有效匹配图像中的边缘、轮廓、纹理等多种几何结构,与AR-G混合字典、DCT字典、Curvelet字典相比具有更强的稀疏逼近能力.图4给出了Barbra图像的稀疏逼近重建结果.表3列出了应用本文的结构自适应子空间匹配追踪算法针对512×512Lena、Barbara与Clock标准测试图像使用不同原子个数的稀疏分解结果,并统计了分解系数中不同类型原子的个数.表2图2中(a)、(g)在不同类型字典下相同原子个数图像纹理子块10024.687027.204026.615025.745522.7569边缘子块3031.564034.968834.609133.864329.2724表3结构自适应子空间匹配追踪算法实验结果统计分析图像重构总Barbara15000294738948159Lena15000621034605330Clock1000049554669376图3不同类型字典下匹配追踪重构信号PSNRPage7图4使用不同原子个数的结构自适应子空间匹配追踪与MCA稀疏逼近图像实验结果表明本文基于Gabor感知字典的结构自适应子空间匹配追踪算法较基于DCT与Curvelet的MCA算法具有更强的稀疏逼近能力.实验中对于8×8与16×16的子块,扩展3个像素作为子块边界的重叠区域,对于32×32与64×64的子块,扩展5个像素.并依据式(8)进行重建,减缓块效应.由于本文Gabor感知多成分字典能够自适应于图像中平滑、边缘轮廓与纹理结构,只需使用较少个数原子重构即可保持原图像的几何结构,继续增加原子个数并不会显著提高图像的视觉质量.由于篇幅有限,不再给出Lena与Clock图像不同原子个数的重构图像.经典的匹配追踪算法使用整个Gabor感知多成分字典对整幅图像进行稀疏分解.与此不同,本文算法在低维子空间里对低维图像进行匹配追踪稀疏分解,有效地降低了每一次迭代所需运算的乘法次数,表4比较了两种算法的运算效率.表4本文算法与经典匹配追踪算法每次迭代乘法次数比较图像本文算法经典匹配追踪算法效率比Barbara2.8457E+0118.8923E+013312Lena2.0897E+0118.8923E+013426Clock1.8321E+0118.8923E+013485由于图像维数与字典中原子个数的缩减,本文算法运算效率提高了两个数量级,大幅度地降低了运算的时间与空间复杂度,同时可采用并行实现进一步提高了效率.6结论与展望本文依据建立的图像结构分解模型,建立了图像的结构自适应多成分稀疏表示模型,将图像进行自适应的四叉树分割与块分类,只选择相同结构类型的子成分字典形成匹配追踪稀疏分解.因此,不仅降低了图像的维数同时降低了搜索字典的复杂度,从而获取了一种高效的结构自适应匹配追踪稀疏分解算法.实验结果验证了本文算法的高效性.进一步的研究将应用率失真性能作为分割测试标准并引入合并策略,构建率失真最优的四叉树分解,应用于低比特率图像压缩与通信等领域.
