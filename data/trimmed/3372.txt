Page1可热扩展的三维并行散热集成方法:用于大规模并行计算的片上系统关键技术骆祖莹1)韩银和2)赵国兴1)余先川1)周明全1)1)(北京师范大学信息科学与技术学院北京100875)2)(中国科学院计算技术研究所北京100190)摘要现有的三维(3D)垂直集成技术无法实现热扩展,受限于过高的温度,难以通过众多器件层的叠放来实现性能的最大化.文中提出了一种具有热扩展性的3D并行散热集成方法,将每个器件层平行于散热方向进行叠放,器件层为长条形,其短边平行于散热方向,长边垂直于散热方向,这样就保证了每个器件层均可以凭借自身所拥有的高导热性硅衬底(而不是导热过孔)来获得独立而较短的散热通道,保证3D并行散热集成芯片最高温度与所叠加的器件层数无关.文中提出了一种用于3D并行散热集成芯片最高衬底温度计算的分析模型,推导出3D芯片最高衬底温度的解析表达式,从理论上说明了该方法具有热扩展性.通过对未来用于千核并行计算的芯片进行3D集成设计表明:该文3D并行散热集成方法具有热扩展性、不需要导热过孔、良品率高等优点.关键词片上系统;三维芯片;热分析;并行计算;算法1引言1.13D集成技术研究的重要性与优点摩尔定律(Moore’sLaw)给出了IC产业的发展方向,即IC生产工艺2~3年提高一代,集成度、性能、和性能/价格比提高一倍[1-2].但随着晶体管尺寸越来越接近其物理极限,如何延续摩尔定律就成为IT产业发展的关键[1-2].3D芯片技术作为一种能够延续摩尔定律的候选技术,获得了广泛的研究[3-14].同时为了提高性能和降低设计复杂度,片上集成并行计算技术被广泛地应用于高端计算领域,多核片上系统(MPSoC)已成为集成电路设计的重要研究方向[5,14].为了追求性能的最大化,未来必须在芯片中集成数以千计的计算单元[14],需要更高的集成度,只有3D集成技术才能提供如此高的集成度.目前,3D垂直集成技术将普通的2D平面芯片或器件层垂直于散热通道进行叠加,所有器件层平行于散热器底面,以获取如下性能和成本的改善:(1)高集成度.由于3D芯片拥有2个以上的器件层,所以其单位面积上可以集成更多的晶体管,其集成度更高[3-14].(2)高性能.由于3D集成中的垂直互连要远短于水平互连,用3D芯片代替2D芯片,不仅可以减小芯片尺寸,而且使影响芯片性能的全局互连得到明显的缩短,提高芯片的工作频率与性能[3-14].(3)高工艺兼容性.先采用不同工艺制造出无疵内核(KnownGoodDie,KGD),再对KGD进行垂直叠加来制造3D芯片,可以获得很好的工艺兼容性[3-4].(4)消除数模混合电路的干扰问题.对于数模混合电路,2D集成会产生明显的干扰;通过将数模电路分层集成,3D集成能够很好地消除数模电路之间的干扰[6].(5)减少芯片管脚的需求.3D芯片中较多的是KGD之间的互连,其对外的芯片管脚需求相对较少[3-7].(6)降低封装成本.由于3D集成中多个KGD共用一个封装,并且芯片管脚少,所以3D芯片的封装成本较低[3-4].由于具有众多的优点,所以3D集成技术被视为延续摩尔定律的有效手段[3-14].1.2现有3D集成技术所面临的工作温度高难题及其对策现有的3D垂直集成技术工作温度高的缺陷也很明显[3-14],这主要源于:(1)高功耗密度.3D芯片的高集成度,必然带来高功耗密度,特别是高端MPSoC芯片,会因为大规模的并行计算而产生大量的功耗[3-5].(2)低散热能力.由于导电与导热都靠电子的运动,所以材料的导电性与导热性是正相关的,布线层之间的绝缘隔离层具有很差的导热能力[3,10-13],尤其是多孔结构的低K材料绝缘隔离层具有非常差的导热能力[3];一般来说,一个器件层配4~8个布线层,如果3D芯片集成3个以上的器件层,它的导热能力就非常差了,必须插入导热过孔[11-13].为了更好地控制3D芯片的工作温度,不仅要进行基础性的3D热分析研究,包括简单的静态热分析方法[8,16-17]和较为复杂的动态RC热分析方法[13],更要进行温度管理方面的研究[7-9,11-12].目前3D芯片的温度管理方法主要有如下4种:(1)面向温度的布图规划[7],由于3D芯片中与散热片相连的是顶层,顶层散热性最好、温度最低,越往下的层散热性越差、温度越高,所以在布图规划中,将功耗高的功能块置于顶层,功耗低的功能块置于下面的层.(2)面向温度的布局优化[8],在布局优化中,将过孔尽量置于温度梯度大的部位,可以尽快地将3D芯片中下层的热量散出.(3)系统运行时的实时温度管理[9],根据对任务的多寡和部件的冷热来进行任务平衡分配,避免系统中出现过热点.(4)插入导热TSV(Through-Silicon-Via,过硅器件层的过孔)[8,11-13],针对3D芯片中下层的散热性差的问题,最直接的方法是插入导热TSV来提高散热性能.前3种方法是间接温度控制方法,优点是不增加面积和TSV的开销,缺点是它们不能在散热片和热源之间建立直接的散热通路,所以散热效果有限;第4种方法则是一种直接温度控制方法,导热TSV在散热片和热源之间建立起直接的散热通路,所以它的控制温度能力明显强于前3种方法,但缺点也很明显,即需增加面积和TSV的开销,降低3D芯片的集成度.由于现有3D芯片均采用垂直散热技术,所以在进行更多器件层集成时,必须打破散热与供电对3D设计的瓶颈约束[3,12].为了未来在单颗芯片上集成多达千颗处理器单元,以进行片上大规模并行计算[14],现行的3D垂直集成技术必须回答如下两个科学问题:“3D集成技术是否存在对器件层叠加数的技术限制?利用3D技术的其它可能选择是什么?”[10](“Isthereapracticallimitofhowmanylevelsoneshouldstack?Whatareotherpossibili-tiestoutilize3Dtechnology?”)1.3本文工作及创新本文最大的创新就体现在:从理论上首次回答Page3了以上两个科学问题,明确指出现有的3D垂直集成技术无法对多器件层进行叠加,并提出了一种能够叠加足够多器件层的3D并行集成方法.为了回答1.2节的第一个科学问题,基于在芯片三维热分析领域作者已有的研究成果[15,17],对3D垂直集成芯片的散热问题进行模型化,推导出精确计算3D芯片最高衬底温度Tchip的解析表达式,指出Tchip是关于3D芯片垂直叠加层数M的二次多项式函数,从理论上证明了现有的3D垂直集成技术具有热不可扩展的固有局限性.为了回答1.2节的第2个科学问题,本文提出了一种并行散热的3D集成方法,将所有器件层与散热通道平行(即所有器件层与散热片的接触面垂直),借助硅材料的高热导性,将器件层的衬底用作导热层,以降低晶体管沟道的温度.由于每个器件层的导热层是固有的,所以都会获得一个独立而稳定的散热通道,即3D芯片获得了并行散热能力.同时随着器件层的增加,3D并行散热集成芯片与散热片之间的接触面积也成比例地增加,可以有效地将3D芯片的热量传导出去,使得3D芯片衬底温度保持不变.为此,本文专门针对3D并行散热集成方法进行模型化,推导出精确计算3D芯片最高衬底温度Tchip的解析表达式,从理论上证明了3D并行散热集成方法具有可热扩展性的优点,并分析了器件层尺寸对3D芯片最高衬底温度的影响.基于现有的3D垂直散热集成方法和本文提出的3D并行散热集成方法,我们对采用10nm工艺、面积10cm2、功耗200W的千核SOC三维集成进行了散热设计.当采用3D垂直集成技术时,受困于过大的功耗密度与层内温度差,只有采用传统的双层垂直集成,才能满足热性能的设计要求,但单层5cm2内核面积会极大地降低芯片的良品率.采用3D并行散热集成方法,则可以将千核SOC等分为20个0.2×2.5cm2器件层,获得2.5cm2的散热面,此时3D芯片的最高衬底温度为66.22,小于设定的70最高温度限,即满足热性能的设计要求;同时制造0.2×2.5cm2器件层的无疵内核(KGD)则可以获得较高的良品率,规避3D垂直集成技术所面临的散热和良品率之间的矛盾,在保证良品率的前提下,满足热性能的设计要求.文章最后进一步对3D并行散热集成方法所存在的相关技术问题及其解决方案进行了简单论述,指出本文方法还可以采用如下技术来提高并行处理能力:(1)每个器件层集成多个处理器核,多核共用L2和L3-Cache技术来提高芯片数据处理性能.(2)采用片上网络(NoC)获得更好的核间数据通信性能,并减少多核对3D芯片I/O管脚的需求.(3)本文方法可以降低对TSV资源的需求,并提供更多的I/O管脚,使3D芯片获得更好的供电性能.总之,本文提出的3D并行散热集成方法具有如下优点:(1)并行散热;(2)无需导热TSV;(3)高良品率.本文下面内容的组织如下:第2节是研究基础;第3节论述3D垂直集成芯片的静态热分析模型并给出这种技术热不可扩展性的结论;第4节提出3D并行散热集成方法及其热分析模型、从理论上证明这种新方法的热扩展性优点;第5节对千核SOC进行3D集成的热设计,显示3D并行散热集成方法的优越性;第6节给出3D并行散热集成技术的应用及其相关技术问题;第7节总结全文.2研究基础2.1不同材料的热导率在集成电路所用材料(如Si、Cu、SiO2、SiN等)中,其热(电)导率差异很大,但一般而言,导电材料的导热性好,绝缘材料的导热性差,半导体材料的导热性明显好于绝缘材料,但弱于导电材料.不同材料的热导率κ如表1的前4项所示.从表1的前4项可以看出,铜具有最好的导热性,硅材料的导热性也比较好,二氧化硅和空气的导热性非常差.在3D热分析中,可以将二氧化硅和空气近似为绝热材料,硅材料的热导率是铜的1/4,所以本文将铜和硅视为导热材料.另外,栅极绝缘层所用的high-κ材料、铜导线的包裹材料和互连线之间的low-κ材料等用于绝缘的材料均可以视为绝热材料[3,12].此外,碳纳米管具有非常高的导热性,但没有应用于实际的3D芯片集成,同时液体微管散热技术过于复杂[12-13],所以本文不考虑碳纳米管与液体微管,仅考虑铜材料与硅材料.2.22D芯片的散热系统图1给出了完整的2D芯片散热系统结构(事实上3D芯片的散热系统结构也是一样的),在散热片上是导热层,导热层可进一步分为导热层1(TIM1)和导热层2(TIM2),导热层上方就是芯片的内核(die),导热层的热传导性能远好于空气,可以有效地改善内核与散热片之间的热传导性能,因此内核+导热层+散热片构成了主散热通道.内核下方是芯片的封装基座,封装基座下方是芯片插座,Page4芯片插座下方则是印刷电路版(PCB),内核+封装基座+芯片插座+PCB构成了辅散热通道.主散热通道的散热能力强于辅散热通道几个数量级,所以在全芯片3D热分析中,均只讨论主散热通道,而忽略辅散热通道,本文下面将主散热通道简称散热通道.2.32D芯片的静态热分析简化模型由于全芯片3D静态热分析较为复杂[15-17],所以本文假设芯片内核的功耗密度分布均匀,硅衬底、导热层、散热片及风扇均匀导热,就可以获得一个简单的串行导热模型,如图2所示.在图2(a)所示的直接简化模型中,硅衬底、导热层、散热片及风扇的导热能力被等效为各自的热阻,分别为rbulk、rcond、rsink、rfan,器件层的功耗密度P为器件层所产生的热量.在图2(b)所示的深度简化模型中,导热层、散热片及风扇的热阻被合并为一个总的等效电阻r0,即r0=rcond+rsink+rfan.以上两图可以形式化为如下公式式中rsystem=rbulk+r0为芯片散热系统的系统等效热阻,Ta为环境温度.Intel公司的Xeon7400系列处理器手册[18]给出了如下的温度函数(最好的一条温度曲线)式中TDP(ThermalDesignPower)是芯片的热设计功耗,最高值为130W,Ta为45.从式(2)可以获得如下结论:(1)芯片的最高工作温度为64.(2)由于其内核面积为Achip=1.43cm2,则其单位面积所对应的系统热阻rsystem=0.146×1.43=0.209cm2K/W.33D垂直集成芯片的静态热分析模型3.13D垂直集成芯片图3给出了3D垂直集成芯片的结构图及其垂直散热的工作原理.在3D垂直散热芯片中,第1器件层具有常规厚度的硅衬底,其它器件层具有剪薄衬底,以缩短3D互连线长度.3D互连包含两类TSV,即信号TSV与导热TSV,信号TSV穿过器件层和硅衬底,在两个器件层之间进行信号传输,为了防止信号电流的泄漏,信号TSV和硅衬底之间有绝缘层,因此信号TSV的导热性比较差;而导热TSV仅穿过器件层,在两个相邻的硅衬底之间进行热传导,要求采用导热性非常好的材料,本文采用的是铜.图33D垂直散热芯片的截面示意图(未按比例绘制)3D垂直集成芯片的垂直散热工作原理如下:各个器件层所产生的热量从第5器件层向第1器件层传导,最后依次经导热层、散热片、风扇,散入环境中,此路径构成了散热通道.因此,在3D垂直散热芯片中,沿着散热方向的逆方向,从第1器件层到第5器件层,其衬底温度依次升高,第5器件层的衬底温度最高,被称为3D芯片的最高衬底温度Tchip.同理,对于一个叠加M个器件层的3D垂直散热芯片,Page5其第M器件层具有最高衬底温度.图4给出了器件层的版图示意.对于一个正方形的器件层,其边长为Ddie,其面积Adie=Ddie×Ddie.器件层中有数个3D垂直布线通道,所有TSV都布放在3D垂直布线通道中[14],其中信号TSV优先布放,剩下的所有TSV均作为导热TSV.器件层被3D垂直布线通道均匀地分为几个器件模块,器件模块所产生的热量通过导热TSV导出,每个模块的宽度为Lblock.由于模块中心线离3D垂直布线通道最远,所以中心线具有模块中的最高温度.3.2多器件层3D垂直散热芯片的热分析模型为了对3D垂直散热芯片静态热分析进行模型化,本文进行如下假设:(1)每个器件层具有均匀的功耗密度;(2)在器件层,只有导热TSV将一个硅衬底的热量传导到它的低温相邻的硅衬底;(3)导热TSV在3D垂直布线通道中均匀分布.依据以上假设可以得出如下结论:(1)在同一个器件层内,导热TSV具有相同的温度,传导相同的热量;(2)在每个器件模块,由于模块中心线离3D垂直布线通道最远,所以模块中心线具有模块中最高的温度.对于第i个器件层,它的剪薄衬底厚度为h2,其器件模块中心线到导热TSV之间的温度差取为Ti,block.通过3D热分析的离散化后,从器件模块中心线到导热TSV之间共有0.5Lblock/h2个边长为h2的正方块质元.每个质元的热阻为rthin=h2/kSi,其中kSi为硅材料的热导率,kSi单位为W/(cm·K).设此器件层上所有器件模块的功耗密度为Pi,则可以将Ti,block形式化为Ti,block=∑0.5L/h2根据式(3)可以得出如下结论:(1)缩小器件模块宽度Lblock或加厚剪博衬底的厚度h2都可以降低Ti,block,但对于3D垂直集成设计,降低Lblock和加厚h2都存在技术难度.(2)降低功耗密度Pi也可以降低Ti,block,可以通过在器件层布放L2或L3高速缓存的设计来适当降低Pi,但大幅度降低Pi也不现实.(3)对于具有剪薄衬底的器件层,降低h2尽管可以提高3D互连的性能,但也导致了器件层内导热能力的降低,扩大了器件层内温度分布的最大温度差.如图5所示,与形式化Ti,block所需的平面离散相比,对每个器件层导热TSV的温度进行形式化则需要进行3D离散处理,其中采用边长为h3的正方块质元、对厚度为h3的常规衬底进行离散化,每个质元的热阻r1=h3/kSi,并设导热层、散热片及风扇的等效热阻为r0.对于i>1的器件层,取ri为厚度为h1的第i个器件层与第i+1个器件层剪薄衬底的等效热阻,如果不考虑剪薄衬底中导热通路的侧面扩展效应,可直接采用下式计算ri式中Adie和ATSV分别为器件层与3D垂直布线通道的面积.在本文研究中,我们假设所有TSV均作为导热TSV,采用铜材料制作导热TSV,式中kCu是铜材料的导热率.基于图5所示的3D离散化处理,可以将第i个器件层的导热TSV温度Ti,TSV形式化为Ti,TSV=Ta+r0+r()1∑M式中M为3D垂直散热芯片所叠加的器件层数,Ta为环境温度.将Ti,block和Ti,TSV进行相加可以获得第i个器件层的最高衬底温度TiTi=Ti,TSV+Ti,block=Ta+r0+r()1∑M将TM作为3D垂直散热芯片的最高衬底温度Tchip,则可以获得下式Page6其中式中T2Dchip是2D等效衬底温度,即对所有器件层功耗密度进行累加后,将其总和加到第一器件层所产图5多器件层3D垂直散热集成芯片的静态热分析模型Tchip=TM,TSV+TM,block基于表2所给出的3D垂直集成工艺与设计参数,本文采用经典的连续过松弛(SOR)算法[17]来验证以上的解析分析模型.首先,计算出Lblock=1.0-ATSVA()die接着可以计算出r1=h3/kSi=0.05cm2·K/W,并采用式(4)计算出ri=0.205cm2·K/W,采用式(5)计算出第i个器件层的导热TSV温度Ti,TSVTi,TSV=45+0.209×(10+5×M)+基于式(7)、(10)、(11)可以计算出3D垂直集成芯片的最高衬底温度Tchip:生的最高衬底温度;T3D带来的温度增量.按照式(8)和(9),当3D所叠加的器件层数M增加时,T2D呈现出二次方增加,即3D垂直集成芯片的最高衬底温度Tchip是关于其所叠加器件层数M的二次多形式函数.因此,3D垂直集成芯片存在一个致命的技术缺陷,即无法实现热扩展,在限定最高工作温度的前提下,3D垂直集成技术难以叠加更多的器件层,无法实现大规模的片上并行计算.=45+1.045(2+M)+=49.75+1.045(2+M)+0.5125M(M-1)=51.84+0.5325M+0.5125M2(12)对于集成不同器件层数M的3D垂直散热芯片,采用式(12)可以直接计算出最高衬底温度Tchip.为了对叠加2~10层的3D垂直集成芯片进行设计,本文根据文献[8,14,16]设定相关参数,列于表1中.其中与散热片接触的第一器件层功耗密度P1为15W/cm2,其它器件层的功耗密度均为5W/cm2,器件层厚度h1取为5μm,剪薄硅衬底厚度h2取为50μm,常规硅衬底厚度h3取为500μm,器件层正方形内核面积Adie为1.0cm2,边长Ddie为1.0cm,器件层3D互连通道面积ATSV为0.025cm2,器件层拥有Nblock=5个功能模块,环境温度Ta为45.将采用本文模型计算出的Tchip数据与SOR模Page7拟算法求解的数据列在表2中.从表中数据可以看出,随着3D垂直散热芯片所集成器件层数M的增加,Tchip快速增加,呈现出二次曲线性质,这表明3D垂直集成技术无法进行热扩展,存在着致命的热性能缺陷;同时,与采用SOR算法模拟出的精确值相比,本文解析模型所计算Tchip的最大误差小于1.7%,这表明本文模型足够精确.因此,本文模型可以直接用来计算集成M个器件层的3D垂直集成芯片的最高衬底温度Tchip,分析3D垂直集成设计的热性能.表1用于3D垂直集成芯片热设计的全部工艺与设计参数[8,14,16]参数kCu4.00W/(cm·K)r00.159cm2K/WkSi1.00W/(cm·K)M2~10kSiO20.014W/(cm·K)Nblockkair0.0003W/(cm·K)Adie1.00cm2h1h2h3Ta表2关于3D垂直集成芯片犜chip的算法比较MSOR解析模型误差/%255.35358.84463.19568.41674.51781.47889.29997.9910107.56108.4243D并行散热集成方法及其热分析模型4.1多器件层3D并行散热集成方法由于3D垂直集成技术无法解决热扩展性问题,现有的3D垂直集成技术难以在3D芯片中集成众多的器件层.但IC工业确实需要集成更多的器件层来实现片上大规模并行计算[6,14].为了克服3D垂直集成技术难以进行热扩展的缺陷,本文提出了一种全新的多器件层3D并行散热集成技术,即将器件层做成长条形内核,长边垂直于散热通道方向,短边平行于散热通道方向,具体如图6所示.按照3D集成工艺[3],多器件层3D并行散热集成技术的制造工艺流程是:(1)制造无疵内核(KGD),先在晶圆(Wafer)上制造内核,再采用磨平工艺以获得常规厚度的衬底,然后进行切割、测试,最后获得形状划一的无疵内核.(2)将无疵内核逐片进行粘接,粘接前必须采用高精度的对准定位,以保证信号TSV的连通.(3)将粘接完毕的3D芯片固定在封装基底上,获得一颗3D芯片.封装基底与散热片位于3D芯片内核的两侧,图6中只画出散热片,而没有画出封装基底.3D并行散热集成方法具有两个重要的优点来保证它的热扩展性:(1)图中所有器件层均具有常规厚度的硅衬底,由于硅材料是一种很好的导热材料,每个器件层均可以通过它自己的硅衬底将它产生的热量传导到散热片,所以每个器件层都拥有自己独立的散热通道,因此本文提出的3D集成方法具有并行散热能力.(2)对于3D并行散热集成芯片,由于它与散热片之间的接触面积正比于器件层数,所以当它集成更多的器件层时,它与散热片之间的接触面积也同比增大,加大热对流的能力.与此相反,当所集成的器件层数增加时,3D垂直集成芯片与散热片的接触面积却没有增加.受惠于以上两个优点,当集成的器件层数增加时,3D并行散热集成芯片的衬底温度才能够保持不变.同时如图6所示,3D并行散热集成方法不需要导热TSV,不会产生TSV和芯片面积的额外开销.在3D并行散热集成方法中,每个器件层均为具有常规厚度硅衬底的无疵内核(KGD),通过适当封装来制造3D并行散热集成芯片.由于每个无疵内核的面积较小,所以无疵内核制造的良品率很高,进而保证3D并行散热集成芯片的高良品率.图6多器件层3D并行散热集成技术的装配及为了控制3D并行散热集成芯片的最高衬底温度Tchip,应当适当降低器件层高度H的取值.本部分下面内容将推导二者之间的关系.4.2用于3D并行散热芯片热分析的离散化模型在3D芯片并行散热器件层的分布式热分析模型化中,本文按如下步骤进行离散化:Page8(1)设3D并行散热集成芯片的所有器件层具有相同功耗PD,也具有相同的面积与尺寸规格,其面积AD=H×L,则器件层的功耗密度为Pd=PD/AD=PD/(H×L).(2)以常规衬底厚度h3为单位将器件层高度H均匀细分为K个热量单元,其计算公式如下中轴线上的标准热阻为rd,可以用下式表示(3)第i个热量单元的功耗密度Pd分别通过水平热阻传到衬底的散热通道(中轴线)上,由于从器件层到中轴线的距离为0.5h3,所以水平热阻为0.5rd.(4)第i个热量单元的功耗密度Pd传到中轴线后,汇合从上面传来的(i-1)×Pd功耗密度,向下传的功耗密度为i×Pd.(5)中轴线上的热量沿中轴线向散热片传导,标准热阻为rd,由于从散热片接触面到第1个温度节点的距离为0.5h3,所以与散热片热阻r0相连的热阻为0.5rd.(6)导热层与内核接触面处的功耗密度为(7)风扇、散热片、导热层的等效热阻为r0.(8)由于各器件层拥有各自独立的散热通道,所K×Pd.图73D并行散热集成芯片的分布式热分析模型为了验证以上所推导的3D并行散热集成芯片热分析的解析模型,本文分别采用经典的SOR求解方法[17]和本文的解析模型分别求解Tchip,其中器件以每个器件层的散热通路相互独立.4.33D并行散热集成技术热分析的解析模型如图7所示,3D并行散热集成芯片的最高衬底温度Tchip与器件层数M无关,只与器件层的功耗密度、尺寸规格有关,所以3D并行散热集成技术具有热可扩展性.根据图7所示的模型化结果,可以计算出Tchip:Tchip=Ta+0.5rd×Pd+∑K-10.5rd+r()0×K×Pd=Ta+0.5K2+()1×rd×Pd+r0×K×Pd按照表1中的参数,可以获得rd=0.05cm2·K/W和r0=0.159cm2·K/W,进而将式(15)改写为Tchip=Ta+0.5K2+()10.05Pd+K×0.159Pd从式(16)可以获得关于3D并行散热集成方法的如下结论:(1)Tchip和器件层数M无关,即3D并行散热集成方法具有明显的热可扩展性.(2)Tchip正比于器件层功耗密度Pd.(3)Tchip正比于K的平方,由于K=H/h3,所以随着器件层高度H的增加,Tchip会呈现出平方量的增加.因此,可以通过调低Pd和H的值,来达到降低Tchip的目的.对于条状的器件层,它的高度较小,因此可以保证较低的Tchip.=Ta+0.025+0.159K+0.025K层功耗密度Pd取为10W/cm2.在SOR求解方法中,为了保证SOR求解的精确性,采用边长为50μm(而不是500μm的h3)的正方块对3D并行散热集Page9成芯片进行离散化.对应于不同的K取值,所有Tchip的求解值(单位为)被列于表3中.如表3所示,随着K取值的不断增加,Tchip也快速增加,并呈现出二次曲线的变化规律,表明Tchip与K(和H)之间存在二次多项式函数的关系.同时,与SOR算法相比,本文的解析模型非常精确,其最大误差小于0.17%,因此本文的解析模型可以用于快速分析3D并行散热集成设计的热性能.表3关于3D并行散热集成芯片最高衬底温度犜chip的方法比较K=H/h3SOR解析方法误差/%23456789105千核SOC的3D集成热设计对于目前采用45nm生产的Xeon7400系列处理器[18],其内核面积为1.43cm2,最大功耗为130W,包含6个处理器单元.按照摩尔定律,在10年内IC工艺将提高4代,即45nm→32nm→22nm→15nm→10nm,集成度提高16倍,可以在1.43cm2面积上集成96个核,单核功耗可以控制在1W左右.受困于MOS管工艺的量子效应,10nm以后的工艺提升将面临物理极限,难于再对工艺进行提升.为了延续摩尔定律,3D集成芯片的层数将不断增加,以保持芯片集成度的不断提升,如何对千核SOC进行3D集成就成为一个有意义的研究问题[10-14].在千核SOC的3D集成中,我们可以假设芯片采用10nm工艺,单核面积为0.01cm2(即1mm2),单核功耗为0.2W(采用超低功耗设计),从理论上对千核SOC的3D集成进行散热设计,尽管10nm工艺在今天看来还是不可想象的.按照以上假设,千核SOC的内核面积为10cm2,功耗为200W.如果还采用传统的2D芯片进行设计,按照式(1)与式(2)可以计算它的最高衬底温度为49.38,远小于热设计的70温度限,但它的10cm2内核面积却会造成良品率奇低的后果,所以传统的2D芯片设计方案不可取.下面我们将分别采用3D垂直集成技术和3D并行散热集成技术、对千核SOC的3D集成热设计问题进行研究,研究焦点集中于芯片的最高衬底温度Tchip.5.1现行的3D垂直集成方案在3D垂直集成设计中,设与散热片接触的第一器件层功耗密度为P1,其它器件层的功耗密度为Pi,P1=3Pi.本文使用第2节所给出的解析模型计算所有3D垂直集成设计方案的最高衬底温度Tchip.对应于2~5个器件层的3D垂直集成设计方案的热设计参数都列在表4中.随着3D芯片所集成器件层数M的增加,可以看出每个器件层面积Adie不断减少,意味着3D芯片与散热片的接触面积也在不断减少,同时P1和Pi也有少量增加,但二者之间的比例保持不变,但3D垂直集成芯片的Tchip却在大幅增加.只有采用目前常用的双器件层集成方案,才能保证Tchip=64.91,满足Tchip<70的设计要求,但对于双器件层集成方案,由于每个器件层的内核面积为5.0cm2,如此大面积的内核将会显著降低制造的良品率.因此,受困于3D垂直集成技术的热不可扩展性,千核SOC的3D垂直集成方案在热性能和良品率之间存在难以调和的矛盾.MAdie/cm2P1/(W/cm2)Pi/(W/cm2)Tchip/25.0030.0010.0064.9133.3336.0012.0076.3242.5040.0013.3390.7952.0042.8614.29108.765.23D并行散热集成方案对于3D并行散热集成设计,本文采用式(16)来计算出:对应于不同Pd和K的3D并行散热集成芯片的Tchip值,所有参数列于表5中.随着K=H/h3的增加,Tchip不断增大,必须降低K和H的值,才能降低Tchip.在表5中,浅灰色区域所对应的设计方案均能够保证Tchip<70的设计要求.对于内核面积为10cm2、功耗为200W的千核SOC,假设其功耗密度均匀,则Pd=20W/cm2,当取K=4时,Tchip=66.22,满足Tchip<70的设计要求.当K=4时,H=K×h3=4×500μm=0.2cm.为了保证器件层的长/高比合理,本文取L=2.5cm,此时内核的长/高比为12.5,内核面积Adie=0.5cm2,即需要集成20片无疵内核才能获得千核SOC的10cm2内核面积.此3D并行散热集成芯片与散热片的接触面积Ainterface=M×h3×L=20×0.05×2.5=2.5cm2,表明3D并行散热集成芯片具有足够大的热对流面积.表6列出了采用Pd=20W/cm2和K=4的3D并行散热集成所对应的所有热设计参数.Page10表5对应于不同犘犱和犓的3D并行散热集成芯片的犜chipK247.21549.4351.64553.86348.63552.2755.90559.54450.30555.6160.91566.22552.22559.4566.67573.90654.39563.7973.18582.58756.81568.6380.44592.26859.48573.9788.455102.94962.40579.8197.215114.621065.57586.15106.725127.30表63D平行散热集成芯片设计方案的热设计参数参数Pd20W/cm2Adie0.5cm2KH0.2cmAinterface2.5cm2L2.5cmTchip66.22与现有的3D垂直集成技术相比,本文提出的3D并行散热集成方法显示出如下优点:(1)热扩展性,每个器件层均拥有自己独自的散热通道,并且3D并行散热芯片与散热片之间的接触面积正比于器件层的数目M,都保证了Tchip不随M的增加而增大.(2)无需导热TSV,不会带来内核面积与TSV的额外开销.(3)高良品率,3D并行散热芯片需要平行叠加很多层的无疵内核,无疵内核较小的内核面积保证它拥有非常高的良品率,进而保证3D并行散热芯片拥有较高的良品率.63D并行散热集成技术的应用及其相关技术问题作为一种全新的3D集成技术,3D并行散热集成技术带来了一些新的技术特点,也面临一些额外的技术难题,下面就对几个突出的技术特点与相关问题进行讨论,以进一步说明这项技术的优越性与实用性.6.13D并行散热集成芯片的并行计算技术有别于现有3D集成中所用的矩形器件层,3D并行散热集成方法使用条形KGD上的器件层,采用何种体系结构才能实现系统性能的最大化?下面对这个问题进行论述.如图6所示,在千核SOC的3D并行散热集成设计中,按照表6的设计参数,20片无疵内核(KGD)器件层上集成1000个处理器,平均每个无疵内核器件层集成50个处理器.对于采用CPU+L1Cache+L2Cache+L3Cache的多核并行计算技术,在一个矩形器件层上,可以采用如图8所示的布放形式来实行片上并行计算.KGD上的50个处理器可以分为5组,每组包括10个处理器,每组共享一个L3Cache;一个组可以分为2个子组,每个子组包括5个处理器,共享一个L2Cache,共享一个3D路由器.每个处理器包括一个处理器核心(逻辑部分)与一个专用的L1Cache.图850核KGD布放版图局部示意(未按比例绘制)图8所示的布放形式主要追求如下目的:(1)良好的散热性能.由于就功耗密度而言,处理器核心>L1Cache>L2Cache,所以将三者依次排列,并将散热片置于处理器核心的下侧,利于将热量散出.(2)层次化的储存器架构.可以提高命中率,降低数据总线带宽.(3)高性能片上网络.20个器件层每层拥有10个3D路由器,可以构成一个20×10的片上网络,每个路由器实现每个子组内5个处理器的数据通信.由于KGD的厚度小于600μm,片上网络在叠片方向具有较小的互连延迟,所以3D并行散热集成方法可以获得一个高性能片上网络.6.2高性能的3D并行散热集成技术借鉴现有3D集成技术中大容量缓存与处理器核心分层集成方法,3D并行散热集成芯片可以进一步获得性能的提升.尽管采用图8所示的多核布放版图形式可以获得很高的性能,但L2Cache到L3Cache的距离仍然较远,将L3Cache放到另外一个器件层上则可以获得更短的信号延迟,提高缓存带宽,以获得更高的并行计算性能[2-6],并已获得IC厂商的应用[3].由于3D并行散热集成方法的基本部件是KGD(无疵内核),所以对如图9所示的双器件层KGD可以直接进行并行集成.在图9中,双器件层KGD由脸对脸(器件层对器件层)的两个器件层构成,其中一个器件层具有常规衬底,用于布放高功耗的处理器核心、L1Cache和L2Cache、3D路由器,另一个器件层具有剪薄衬底,用于布放低功耗的L3Cache.由于两个器件层直接通过片内互连(而不是TSV互连)进行通信,并且互连层的厚度非常小(<10μm),与L2缓存进行通信的总线距离非常短,因此可以获得非常Page11大的通信带宽,极大地提高处理器的性能.在散热方面,由于L3Cache的功耗较低,它自己的剪薄衬底以及相邻的常规衬底可以提供很好的散热条件.但对于最左边的那个L3Cache器件层,由于无相邻的常规衬底,它自己的剪薄衬底难于进行高效散热,则将剪薄衬底更换为常规衬底,以保证它的热性能.图9由脸对脸双器件层KGD构成的3D并行6.33D并行散热集成技术的I/O与供电技术现有的3D垂直散热集成芯片与封装基座之间的接触面积是固定的,并不随器件层的增加而增大,因此3D垂直集成芯片的I/O数目是固定的[3,12].相反,对于3D并行散热集成芯片而言,由于随集成器件层数的增加,它与封装基座之间的接触面积同比增加,所以3D并行散热集成芯片的I/O数目也同比增加,即3D并行散热集成芯片具有I/O的可扩展性.I/O可扩展性的优点体现在如下两个方面:(1)更多的片外存储器总线端口及更大的前端总线带宽.(2)更多的电源线/地线网络(P/G网)供电管脚,降低P/G网的IR电压降.同时与3D垂直散热集成芯片相比,由于3D并行散热集成芯片的器件层是长条形,其高度较小(B2mm),所以其I/O更接近于器件层,其I/O的性能更好.以电源线/地线网络(P/G网)供电系统为例,由于每个器件层都有自己的P/G网PAD,所以3D并行散热集成芯片的供电I/O更多,更容易保证芯片的电源供应.7结论用于大规模并行计算的片上系统迫切需要散热性能好的3D集成方案,本文主要针对这个问题,不仅从理论上指出现有3D垂直集成技术面临热扩展性的难题,还提出了多器件层3D并行散热集成方法,并对3D并行散热集成芯片温度分析进行建模,推导出简洁而精确的解析分析公式,从理论上指出本文的3D并行散热集成方法具有热扩展性.本文工作表明:采用3D并行散热集成方法可以在保证芯片热性能的前提下,大幅度提高芯片的良品率,并更好地保障器件层的供电和大数据量的NoC通信,适用于未来千核SOC的3D集成,使摩尔定律能够在IC工艺达到物理极限后、还能够延续下去.本文仅采用简单的静态热分析模型、来定性地分析了3D垂直集成技术无热扩展性的缺陷和本文的3D并行散热集成方法具有热扩展性的优点.但要对采用特定工艺的3D芯片进行定量的热分析,则需要更复杂的瞬态热分析模型.3D芯片瞬态热分析的计算复杂度非常巨大,不仅需要低复杂度的高效EDA算法,还需要更为强大的计算能力.为了对3D芯片进行电热分析(包括功耗分析、P/G网分析与热分析)与优化,本课题组已成功研制了基于Windows操作系统的GPU高性能计算集群,今后将基于该集群、对应用于3D芯片电热分析与优化的GPU集群层次式并行算法进行研究,满足3D芯片电热设计的需求.致谢清华大学微电子与纳电子学系叶佐昌老师对本文理论工作提出了有益的建议,在此表示感谢!
