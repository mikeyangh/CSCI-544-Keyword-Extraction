Page1几何定理机器证明复系数质点法的改进及其应用1)(天津城建大学理学院天津300384)2)(广州大学计算机科学与教育软件学院广州510006)摘要复系数质点法是以几何点的运算为基础而建立起来的一种新的几何定理机器证明方法.它能高效地证明大部分构造型几何命题,但现有的复系数质点法仍不能有效地处理一些非线性构造型几何命题.为此,该文在原有工作的基础上,对原复系数质点法机器证明算法进行了较大的改进,新添加了一些重要的构图方式,并选用Mathematica重新实现了改进的算法,创建了新的证明器CMPP(ComplexMassPointmethodProver).对上百个几何定理的运行结果显示,证明器CMPP能有效地处理非线性构造型几何命题以及许多非构造型几何命题,在解题能力及运行效率上均有所提高.特别地,CMPP能在短时间内实现五圆定理、莫莱定理等一些难度较大的几何定理的可读机器证明.关键词几何自动推理;可读机器证明;构造型几何命题;复系数质点法;CMPP1引言1985年,吴文俊院士创造性地提出了“吴方法”.此后的30余年间,几何定理机器证明研究不断发展:代数法[1]、数值法[2]能有效地判断无序几何命题的真假;面积法[3-4]、搜索法[5-6]更能对其生成“可读”的机器证明.最近,在上述研究的基础上,笔者发展了复系数质点法[7-8](下文简称质点法).该方法是个能对“线性构造型”几何定理生成可读证明的新的算法.对上百个“线性构造型”几何命题的运行结果显示,质点法的运行效率高且多数证明的可读性令人满意.为了能处理更多类型的几何命题,本文在已有工作的基础上,对原质点法的核心算法进行了改进,并特别添加了一些能更准确地描述“直线与圆相交、直线与圆相切、圆与圆相交、圆与圆相切”等构图情况的作图语句,使得质点法能灵活地表述并证明许多非线性构造型几何命题及非构造型几何命题.原质点法机器证明算法是在Maple中实现的,在深入测试该证明器的解题能力及运行效率时发现,一些涉及到大规模符号计算的几何命题,特别是较复杂的多元三角函数和多元无理式的综合运算的几何命题,有时并不能用质点法在合理的时间内完成机器证明.通过详细比较多款当前世界上一些具有强大符号计算功能的数学软件发现,Mathematica对多元三角函数和多元无理式等的处理有其独特的优势.因此,本文选用Mathematica对改进的质点法机器证明算法进行重新实现,创建了新的几何定理证明器CMPP(ComplexMassPointmethodProver).对上百个几何定理的运行结果表明,CMPP的解题能力与运行效率均令人满意,尤其是对于五圆定理、莫莱定理、布洛卡圆定理等一些大难度的几何定理,CMPP均能够在短时间内实现可读机器证明.本文第2节介绍质点法的基本原理和机器证明算法;第3节介绍质点法机器证明算法的新实现和新证明器中的函数命令;第4节介绍CMPP在近世几何定理机器证明中的应用,并以布洛卡圆定理为例,详细说明质点法机器证明的运行过程;最后对全文进行总结.2质点法对于平面上的点,我们用大写字母A,B,C,…,来表示;实数用小写字母a,b,c,…,表示;向量用犃犅(或B-A)表示;△ABC的“有向”面积用S△ABC表示.2.1质点法的基本原理定义1.对于直线AB(A≠B)上的任意一点C,不妨设犃犆上一点,满足|CD|=|AB|,且A-B-D呈逆时针方向(如图1所示).X是CD上任意一点,不妨设犆犡犆犇=v,则记X=(1-u-vi)A+(u+vi)B.图1是定义1中0<u<1,v>0的情形,当v<0时,X应在AB的下方.我们称形如X=(1-u-vi)A+(u+vi)B的复系数和为1的质点关系式为规范组合式.性质1.设C=(1-u-vi)A+(u+vi)B,则有(1)设CX⊥AB,垂足为X,则X=(1-u)A+uB,且|CX|=|v||AB|.若v<0,则A-B-C呈顺时针方向;若v>0,则A-B-C呈逆时针方向.(2)设点P是△ABC所在平面内的任意一点,则有唯一的表示式:(3)若v=0,则C,A,B三点共线;若v≠0,当u=0时,∠CAB=90°;当u>0时,∠CAB是锐角;当u<0时,∠CAB是钝角.定义2.若θ=arctan所成的夹角,即(PQ,AB)=θ;且|x+yi|为两向量的模之比,即|PQ|(x+yi)(B-A).性质2.设P-Q=(x+yi)(M-N),则有(1)若y=0,x≠0,则PQ‖MN;(2)若x=0,y≠0,则PQ⊥MN;(3)若|x+yi|=t,则|PQ|=t·|MN|.特别地,当t=1时|PQ|=|MN|.Page3性质3.若P=(1-m-ni)A+(m+ni)B,Q=(1-a-bi)A+(a+bi)B,PX⊥AB,QY⊥AB,垂足分别为X,Y,则(1)犘犡犙犢=nb;(2)若n≠b,则PQ与AB必交于一点;设O=PQ∩AB,则(n-b)O=nQ-bP.性质4.设C=(1-a-bi)A+(a+bi)B,P=(1-x-yi)Q+(x+yi)R,则有(1)若a=x=0,则∠CAB=∠PQR为直角;(2)设a≠0,x≠0.若b时,∠CAB=∠PQR;当-by∠CAB+∠PQR=180°;(3)若a=x,b=±y,则△CAB与△PQR相似.定义3.设△CAB与△PQR相似,若A-B-C与P-Q-R同为顺时针或逆时针方向,则称△CAB与△PQR正相似;否则,称△CAB与△PQR逆相似.性质5.设△PQR与△CAB相似,C=(1-a-bi)A+(a+bi)B.(1)若△CAB与△PQR正相似,则P=(1-a-bi)Q+(a+bi)R;(2)若△CAB与△PQR逆相似,则P=(1-a+bi)Q+(a-bi)R.性质6.设P=(1-a-bi)S+(a+bi)R,P=(1-x-yi)Q+(x+yi)R.若a=x=0或b(a≠0且x≠0),则P,Q,R,S四点共圆.质点关系式不仅能表示几何点之间的关系,还可直接表示一些具有特殊性质的直线和圆.性质7.设u,v是两个单位复数,对于平面上A,B,C三点,满足uA+vB=(u+v)C,则当A,B,v固定,u在单位圆上变化时,点C的轨迹为AB的中垂线.性质8.设x,v是两个单位复数,对于平面上A,B,C三点,满足(v+x)C-vA=xB,则当A,C,v固定,x在单位圆上变化时,点B的轨迹为以C为圆心、CA为半径的圆.性质9.设两条直线为uA+v1P1=(u+v1)X(AP1的中垂线)uA+v2P2=(u+v2)X(AP2的中垂线{则其交点可表示为X=性质10.设3条直线为l1:uA+v1P1=(u+v1)X(AP1的中垂线)烄l2:uA+v2P2=(u+v2)X(AP2的中垂线)烅l3:uA+v3P3=(u+v3)X(AP3的中垂线烆则直线l1,l2,l3所围成三角形的外心为注:为保证与性质7统一,性质9、性质10中的u,v1,v2,v3为单位复数.且为计算方便不妨取vi=PiPi(i=1,2,3),其中A为作图过程中引入的第1个点.上述性质7~性质10使得改进后的质点法能以更高的效率处理关联多个圆的构造型几何命题.2.2质点法机器证明算法一般来说,用质点法解题需要以下3个步骤:(1)构图.用构造性的方式描述几何定理,它的构图通常由多个构图语句组成;(2)转化.根据2.1节中的基本原理,将上述构图语句转化为特定的质点关系表达式;再按照构图顺序依次进行质点关系式间的运算,从而逐步得到新的质点关系表达式,一直到题目所需的所有构图语句被成功地表达出来;(3)验证.输入验证语句或检验函数(详见本文3.2节),检查题目所要证明(或求解)的结论是否已包含在刚刚得到的质点关系式中.若在,输出结果;否则,由已得到的关系式继续进行推导,直至搜索到所需结果.通常情况下,用质点法进行证明时,初始的作图语句都会先引入两个基点(设为A,B).由2.1节的性质1知,每一条构图语句所引入的新的点X都可以表示为基点A,B的“规范组合”.不妨设X=(1-a-bi)A+(a+bi)B,由“规范组合”表示的唯一性知,X可与二维数组(1-a-bi,a+bi)一一对应.又由于A,B两点所对应的数组可分别记作(1,0)、(0,1).因此,一个几何命题所涉及到的全部的点都能找到与之相应的数组.在质点法机器证明算法中,通常用3个全局变量pnts、varlist和coordlist(分别代表“点的个数”、“点表”和“数组表”)来记录上述机器证明过程中的每一步结果.算法1.质点法机器证明算法.输入:能完整描述一个几何命题的所有构图语句及检输出:构图语句产生的质点关系式及所求结论是否成1.置pnts=0,varlist为空表,coordlist为空表;Page42.初始构图语句引入两个自由点,不妨设为P1,P2,则pnts=2,varlist={P1,P2},coordlist=(1,0),(0,13.此后,每引入一个新点,pnts→pnts+1;并把新的点和它所对应的数组分别储存到表varlist和coordlist的第pnts+1的位置上;同时输出相关的质点表达式或几何关系信息;4.考虑结论中所涉及到的质点,搜索它们在点表varlist中的位置,将其记录下来.再调用数组表coordlist中相应位置的数组,进行相关的计算,验证结论是否成立并输出相应的结果.下面以验证3点P,Q,R是否共线的检验函数为例,详细说明证明器CMPP如何在步4中检验结论是否成立.通过步1~步3,证明器应已求出并记录了3点P,Q,R的质点表达式中的相关信息.步4在验证P,Q,R3点是否共线时将进行如下操作:(1)分别搜索P,Q,R在varlist中的相应位置,设位置序号分别为ai,bi,ci;(2)在coordlist中找到对应的数组coordlist[ai]、coordlist[bi]和coordlist[ci],不妨分别设为t1,t2,t3;(3)比较t1-t2和t2-t3,若存在实数a,使得t2-t3=a(t1-t2),则输出“P,Q,Rarecollinear!”及对应的质点关系式;否则输出“P,Q,Rarenotcollinear!”.3质点法机器证明算法的新实现及相关的函数命令3.1质点法机器证明算法的新实现质点法机器证明过程往往涉及到较复杂的符号计算和列表处理,要快速地实现算法就需要选择合适的工具.原质点法证明器是在Maple中实现的,在深入测试其解题能力及运行效率时发现,该证明器在处理一些涉及大规模符号计算的几何命题(特别是涉及圆上多个点或多个圆的较复杂的命题以及一些与度量性质相关的几何问题)时,有时并不能在合理的时间内完成机器证明,其主要原因是这些命题往往涉及多元无理式和多元三角函数等复杂代数式的综合处理.通过详细比较多款当前世界上一些具有强大符号计算能力的数学软件发现,Mathematica不仅具有相比其他同类软件更胜一筹的符号计算能力,而且其对多元三角函数和多元无理式等的处理有其独特的优势.例如,直接调用Mathematica中的Simplify函数,就能将表达式1-sin2(a-b|cos(a-b)|,而类似的运算在Maple中却不易实现.因此,本文选用Mathematica对改进后的算法进行重新实现,创建了新的几何定理证明器CMPP(ComplexMassPointmethodProver).经测试后发现,新证明器CMPP证明几何定理的运行效率有明显的提高.由于在新质点法中添加了一些能更准确地描述“直线与圆相交、直线与圆相切、圆与圆相交、圆与圆相切”等构图情况的作图函数,CMPP还能证明许多非线性构造型几何命题,因而解题能力得到了明显增强.3.2新质点法证明器中的函数命令质点法证明器中的函数命令主要分两种类型———构图语句C和检验函数E.当这些编译好的函数命令被加载后,只需在Mathematica中直接输入一个几何命题的构图语句及检验函数并运行,就能得到该命题的质点法证明.在CMPP中,常用的构图语句有:C1.Points(A,B).在平面上任取两点A,B.C2.Point1(X,A,B,a,b).已经选取了A,B,作一点X满足X=(1-a-bi)A+(a+bi)B,这里的a,b可以是特定的数、独立的变量或有理表达式.C3.Midpoint(X,A,B).作AB的中点X.C4.Foot(X,C,A,B).过C作AB的垂足X.C5.Inter(X,U,V,A,B).作直线UV与直线AB的交点X.C6.Parallel(X,A,B,C).作点X,使得四边形ABCX为平行四边形.C7.Centroid(X,A,B,C).作△ABC的重心X.C8.Circumcenter(X,A,B,C).作△ABC的外心X.C9.Orthocenter(X,A,B,C).作△ABC的垂心X.C10.Incenter(X,B,C,I).已知△XBC的内心I和顶点B,C,作第3个顶点X.C11.CCinter(X,P,O1,O2).作过点P且分别以O1,O2为圆心的两圆的另一个交点X.C12.Similartrianglepoint1(X,P,Q,A,B,C).作点X,使得△XPQ与△ABC逆相似.C13.LLinter(X,Pi,Pj).作APi的中垂线与APj的中垂线的交点X,其中A为初始构图语句引入的第1个点.C14.Cir(X,Pi,Pj,Pk).作以APi的中垂线、Page5APj的中垂线及APk的中垂线所围成的三角形的外心X,其中A为初始构图语句引入的第1个点.C15.Tangentpoint(X,T,O,A).过T作⊙O的切线与⊙O的一个切点X,其中⊙O是以O为圆心过点A的圆,T是⊙O外一点.C16.LCinter(X,P,Q,O,A).作直线PQ与⊙(O,A)的一个交点X.C17.CCinter2(X,O1,P1,O2,P2).作⊙(O1,P1)与⊙(O2,P2)的一个交点X.C18.ASApoint(X,A,B,α,β).作点X,满足XAB=α,XBA=β.C19.Brocardpoint(X,A,B,C).作△ABC的正布洛卡点X.C20.Conjugatepoint(X,A,B,C,P).作P关于△ABC的等角共轭点X.改进后的质点法机器证明算法中特别新增了上述构图语句中C13~C20,而C19、C20是专为证明近世几何中的一些定理准备的,其中:(1)构图语句C19用于构造△ABC的正布洛卡点,其相当于以下9个构图语句相继作用的结果:但按这种方式,构图过程需要多引入8个点:P,Q,R,S,E,F,O1,O2;(2)构图语句C20用于构造点P关于△ABC的等角共轭点X,其相当于以下3个构图语句相继作用的结果:Similartrianglepoint1(M,A,C,P,A,B),Similartrianglepoint1(N,B,C,P,B,A),Inter(X,A,M,B,N).但按这种方式,构图过程需要多引入两个点M,N.在CMPP中,常用的检验函数有:E1.Ifequal(P,Q).检验点P与点Q是否重合.E2.Ifcollinear(P,Q,R).检验点P,Q,R是否共线.E3.Ifconcyclic(P,Q,R,S).检验P,Q,R,S是否共圆.E4.Ifsimilartriangle(P,Q,R,A,B,C).检验△PQR与△ABC是否相似.E5.Ifcongruenttriangle(P,Q,R,A,B,C).检验△PQR与△ABC是否全等.E6.Ifcctangent(O1,P,O2,Q).检验⊙(O1,P)与⊙(O2,Q)是否相切.E7.Relation3(P,Q,R).求P,Q,R3点所满足的质点关系式,即求出a,b并把P表示为Q,R的规范组合:P=(1-a-bi)Q+(a+bi)R,可以根据a,b的值来判断P,Q,R间的几何关系.E8.Relation4(P,Q,M,N).求出P,Q,M,N4点所满足的质点关系式,即求出x+yi使得P-Q=(x+yi)(M-N),根据x,y的值判断两向量P-Q和M-N的几何关系并求出t=|x+yi|.4新质点法证明器的应用近世几何又称近代欧氏几何,主要研究“三角形的五心、几何变换、等角共轭、等距共轭、布洛卡点、布洛卡圆、斯俾克圆、泰勒圆”等与圆和三角有关的内容.它包含了大量而优美的几何定理,但由于构造辅助元素的多样性和不可预见性,许多大难度的近世几何定理的优美证明往往凝聚着几代数学家辛苦研究的结晶.随着质点法研究的不断深入,笔者尝试用质点法来证明一些大难度的近世几何定理,希望从另一个角度来呈现质点法强大的解题能力.图2以布洛卡圆定理为例说明如何用质点法证明器CMPP证明几何定理.例1.布洛卡圆定理.设△ABC的正、负布洛卡点分别为U,V,外心为O,共轭重心为K,证明:(1)OU=OV;(2)△OUK△OVK;(3)O,U,K,V4点共圆,该圆称为布洛卡圆[9].Page6布洛卡圆定理涉及“等角共轭点、陪位重心、布洛卡点、布洛卡圆”等近世几何研究内容,其构图过程比较复杂,用以前的质点法或其他的代数方法来证明它往往需要大量的符号计算,一般的证明器不容易实现它的机器证明.而改进的质点法针对近世几何内容特别添加了一些新的构图函数.新证明器CMPP能在短时间内实现它的可读机器证明.在加载了新证明器程序的Mathematica环境中,直接输入如下函数命令并运行,即可得到相应的质点法机器证明过程:Points[A,B];Point1[C,A,B,u,v];Centroid[G,A,B,C];Circumcenter[O,A,B,C]Brocardpoint[U,A,B,C];Conjugatepoint[K,G,A,B,C]Conjugatepoint[V,U,A,B,C];Relation4[O,U,O,V];Ifcongruenttriangle[O,U,K,O,V,K];Ifconcyclic[K,U,O,V].在输入函数命令之前,证明器中的3个全局变量处于初始状态,即pnts=0,varlist为空表,coordlist为空表.初始构图语句引入两个自由点A,B之后,3个全局变量相应地变为pnts=2,varlist={A,B},coordlist={(1,0),(0,1)};然后用构图语句C2构造另一个自由点C,再用构图语句C7、C8和C19分别构造△ABC的重心G、外心O和正布洛卡点U;最后用构图语句C20构造△ABC的共轭重心K和负布洛卡点V.上述过程中,每引入一个新点,证明器将pnts变为pnts+1,同时把这个新的点及该点所对应的数组分别存储到点表varlist和数组表coordlist的第pnts+1的位置上,并输出相关的质点关系表达式.对于同一题设下有多个结论的几何命题,在质点法证明器CMPP中能直接调用多个检验函数一起验证.上述检验函数中,用Relation4[O,U,O,V]求出O,U,O,V所满足的质点关系式并判断题目要证的第一个结论OU=OV是否成立;用函数Ifcon-gruenttriangle[O,U,K,O,V,K]来判定两个三角形是否全等;用Ifconcyclic[K,U,O,V]来验证4点O,U,K,V是否共圆.在验证过程中,CMPP先搜索每一个检验函数中所涉及到的全部的点在表varlist中的位置,然后调用表coordlist中相应的数组进行质点关系运算,最后判断结论是否成立并输出结果.对于输出的结果,我们既可让证明器产生非常简短的证明过程,也可以根据需要得到证明过程中所有推导的详细过程.限于篇幅,下面给出证明器自动生成的一个简化的证明过程:Thetwobasicpointsare:A,B.C==(1-u-iv)×A+(u+iv)×BGisthecentriodoftriangleABC.3×G==A+B+COisthecircumcenteroftriangleABC.O==A+UisthebrocardpointoftriangleABC.K,GareconjugatepointsabouttriangleABC.V,UareconjugatepointsabouttriangleABC.O-V==OV==1×OU△OVK△OUKK==K==∠KVU==∠KOU,K,U,O,Vareconcyclic!此外,我们还用证明器CMPP分别对开世定理、五圆定理、莫莱定理、莱莫恩圆定理等一些大难度几何定理进行了验证,并把在LenovoG450(Intel酷睿2双核P7450,2GB)计算机上运行这5个定理的时间统计如表1所示.表1CMPP证明5个大难度几何定理的运行时间定理开世定理五圆定理莫莱定理布洛卡圆莱莫恩圆时间/s0.141337.0630.016值得一提的是,原质点法证明器在证明“五圆定理”时,只能证明蕴含结果的中间结论,而无法在合理的时间内直接验证结论是否成立(即五点是否共圆).用不变量方法(如面积法)或代数方法(如吴方法等)来证明五圆定理理论上是可行的,但由于机器能力的限制,目前尚未见到在机器上实现的报道.而新改进的质点法证明器可在合理时间内实现五圆定理Page7的可读机器证明,这表明了CMPP在处理与圆有关的几何命题时有其独特的优势.5结语本文改进了原有的质点法机器证明算法,并利用Mathematica创建了新的证明器CMPP,拓展了质点法的解题能力.CMPP能轻松地处理近世几何中涉及的逆平行线、等角共轭、反演、陪位重心、布洛卡点、布洛卡圆、泰勒圆等内容的几何命题.对一些大难度的近世几何定理如开世定理、莫莱定理、布洛卡圆定理、莱莫恩圆定理等的运行结果表明,新证明器CMPP的解题能力与运行效率均令人满意.质点法是以几何点(而非坐标点或不变量)的计算为基础而建立起来的一种几何定理机器证明方法.由于质点法研究的是更基本的几何对象———几何点之间的相互关系,一些蕴含在向量、有向面积等几何量以及隐藏在三角形、四边形或完全四边形等基本几何图形中的特殊性质有机会被更深层次地揭示出来,这些特殊的性质有可能为几何定理可读机器证明的研究增添新的色彩.特别地,结合质点的性质能表现向量、有向面积等几何量的性质,且质点间数量关系还可用几何意义明确的复数形式或三角形式灵活表示,这为发展、扩展或融合其他已有的可读证明方法提供了一个新的工具.这将是我们下一步的工作.
