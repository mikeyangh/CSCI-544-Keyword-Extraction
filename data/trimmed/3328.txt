Page1高效的适应性选择密文安全公钥加密算法康立王之怡(西南财经大学经济信息工程学院计算机系成都610074)摘要安全高效的公钥加密算法是信息系统安全的重要保障技术,文中利用陷门承诺函数的思想实现对密文完整性的保护,由此在标准模型下给出一个可证明适应性选择密文攻击安全的公钥加密算法.新算法与著名的CS98公钥加密算法相比公钥参数数量减少20%,私钥参数减少80%;与BMW05公钥加密算法比较,公、私钥参数数量大为减少且安全规约效率显著提高.新算法支持公开的密文完整性验证,具有精简的公、私钥参数数量,其安全性被证明高效地归约为GHDH数学难题假设.关键词公钥加密;适应性选择密文安全;公开密文完整性验证;GHDH1引言面.加、解密运算快速可以降低对计算能力的要求;公、私钥数量精简可以减少对存储资源和存储管理的要求;安全归约效率描述算法安全性和数学难题假设间的紧密程度,安全归约效率越高表明算法安全性和数学难题结合越紧密,从而说明算法更为可信、安全.本文的主要工作是在标准模型下利用陷门承诺函数[1]的思想实现密文完整性的保护,从而设Page2计了一个高效的公钥加密算法.新算法的公、私钥数量精简,能支持公开的密文完整性验证,具有较低的密文通信量,安全归约效率高,其适应性选择密文安全性在带Gap的判定性HashedDiffie-Hellman(GHDH)数学难题[2]假设下能得到形式化的安全证明.1998年,Cramer和Shoup(CS98)在标准模型下构造了一个适应性选择密文攻击(CCA)安全的公钥加密算法[3],该算法需要5个公钥参数,5个私钥参数,加密一次消息需要传送4个群元素.2005年,Boyen、Mei和Waters(BMW)利用Waters基于身份加密算法[4]给出了一个CCA安全的加密算法[5],BMW加密算法需要n+3个公钥参数和n+2个私钥参数(在目前最低160bit安全要求[6]下n=160),加密一次消息需要传送3个群元素.BMW加密算法较CS98算法公私钥数量大大增加了,这将耗费更多的存储资源;同时BMW加密算法的安全规约效率较低;但BMW算法有一个突出特点:在密文解密前,存在一个无需输入任何私钥的验证算法能判定密文的完整性,它能确保解密后得到明文消息的正确性;由于验证算法无需输入私钥因此被称为公开的密文完整性验证.这一性质在互联网通信环境中非常有用,互联网通信环境中如果PKE算法支持密文完整性的公开验证,使用者就能将公开验证算法嵌入到密文接收方计算机可控的路由器(或网络计算机)中,在不泄露接收方私钥的情况下由该路由器(或网络计算机)来执行密文验证算法并直接过滤错误密文.这样能有效地减少接收方计算机的解密计算负担而不用担心泄露接收方私钥.Kurosawa和Desmedt(KD)在CS98算法基础上给出了一个混合加密算法[7],该混合加密算法由三部分组成:密钥封装算法、一次性对称加密算法和消息认证码.随后也有文献[2]和文献[8-9]来研究混合加密算法,由于对称加密算法和消息认证码的设计不在公钥密码学的范畴内,因此本文后面的算法对比未将混合加密算法列入考查范围.新给出的公钥加密算法结合了CS98加密算法和BMW加密算法的优势:新算法仅需要4个公钥参数,1个私钥参数,加密一次消息需要传送3个群G中元素和1个整数域Zp中元素;新算法能支持公开的密文完整性验证且安全规约效率高;在标准模型(非随机预言机模型)下基于GHDH数学难题假设新算法被证明是适应性选择密文攻击安全的.随后的第2节是相关算法定义;第3节和第4节是新公钥加密(PublicKeyEncryption,PKE)由以系统建立Setup(k).根据输入的安全参数k∈加密算法EncPK(M).输入公钥PK和消息的CCA安全高效公钥加密算法及其在非随机预言机模型下形式化的安全证明;第5节和第6节是相关算法效率对比和总结.2相关算法定义2.1公钥加密算法和其安全性定义下算法组成.Z,输出公钥PK和私钥SK;M,选择随机数r,输出密文C=EncPK(M,r);解密算法DecSK(C).根据输入的解密私钥SK和密文C,算法输出消息M或表示密文不合法的特殊符号⊥.适应性选择密文攻击安全:在适应性选择密文攻击下,攻击者对挑战密文的不可区分安全性,即是指IND-CCA2(简记为CCA)安全性.此概念由如下仿真者和攻击者之间的交互活动来定义,其中k∈Z为安全参数.(1)仿真者运行Setup(k)获得随机产生的公私钥对(PK,SK),他将公钥PK给攻击者;(2)攻击者用适应性选取的密文C询问仿真者,仿真者运行解密算法DecSK(C)计算明文,应答询问;(3)攻击者输出两个等长消息(M0,M1),仿真者随机选取比特β∈{0,1},计算挑战密文C=EncPK(Mβ),将C发送给攻击者;(4)攻击者继续自由选择密文C进行解密询问,唯一的限制是要求C≠C,挑战者仍然运行解密算法DecSK(C)计算明文,应答询问;(5)攻击者输出β∈{0,1}作为对β的猜测.攻击者攻击上述加密算法的优势被定义为PKE算法是CCA安全的当且仅当优势AdvPKE对于概率多项式时间攻击者A来说是可以忽略的[10].2.2目标抗碰撞Hash函数给定随机元素x和目标抗碰撞的Hash函数H(TargetCollisionResistance,TCR),假设存在一个对H的攻击者A,他能找到一个值y≠x,使得H(x)=H(y).定义攻击者A的优势:Page3都有e(ua,vb)=e(u,v)ab;Advhash-tcrHash函数H的输出长度为n,它由安全参数k确定.Hash函数H是目标抗碰撞安全的当且仅当优势Advhash-tcr说是可以忽略的.2.3双线性映射Pairing对计算设G和G1为阶为素数p的循环群,g为G上的生成元,双线性映射e:G×G→G1是具有如下性质的映射:(1)双线性性.对于所有的u,v∈G,a,b∈Zp,(2)免退化性.e(g,g)≠1.如果G上的群运算可以有效地计算,并且存在群G1和能有效计算的双线性映射e:G×G→G1,则称G为双线性映射群[11].2.4带Gap的判定性HashedDiffie-Hellman(GHDH)数学难题假设挑战者随机选择一个抗碰撞Hash函数H,Zp中的随机元素a,b,d,群G的生成元g和一个随机比特β∈{0,1}.若β=0,挑战者计算并发送(g,ga,gb,Z=H(gab))给攻击者,反之发送(g,ga,gb,Z=H(gd)).攻击者在DDH预言机的帮助下返回β∈{0,1}作为对β的猜测.攻击者A解GHDH数学难题假设的优势定义为这里DDH预言机定义为输入(g,ga,gb,gc)当且仅当ab=cmodp时DDH预言机输出1,反之输出0.文献[2]中指出利用gap群或是双线性映射群能有效实现DDH预言机.例如,利用双线性映射群下的pairing对计算能有效地对参数(g,ga,gb,gc)是否满足ab=cmodp进行判定,如果e(ga,gb)=e(g,gc)成立,DDH预言机输出1,反之输出0.GHDH数学难题假设成立当且仅当优势AdvGHDH对于概率多项式时间攻击者A来说是可以忽略的.关于GHDH数学难题假设和DBDH难题假设[11]的关系及GHDH数学难题假设详细的安全证明请参阅文献[2].3新的CCA安全加密算法设G和G1是阶为素数p的群,存在双线性映射e:G×G→G1,g是G的生成元,群的大小由安全参数k确定.选择目标抗碰撞Hash函数H1:{0,1}→Zp和满足GHDH数学难题要求的抗碰撞Hash函数H2:G→G.系统建立Setup(k).算法首先随机选取a∈Zp并计算g1=ga,在G中随机选择X1和X2.公钥为(g,g1,X1,X2);私钥为(a).加密算法EncPK(M):为了加密消息M∈G,加密算法随机选取t∈Zp和τ∈Zp,生成密文这里ω=H1(C0,C1).C2=(Xω的陷门承诺值,可以确保ω的完整性.解密算法DecSK(C).令C=(C0,C1,C2,C3)为接收到的密文.接收者计算ω=H1(C0,C1)并利用pairing对计算(GHDH数学难题的DDH预言机)验证:如果上述验证等式不成立拒绝密文,成立则利M=C0/H2(Ca用私钥a解密密文C:可以发现在上述密文完整性的验证过程中不需要使用接收方的私钥,仅需利用pairing对计算和相关公钥就能对密文的完整性进行验证,这样能确保解密后得到明文消息的正确性.提高计算效率.Pairing对计算与群中的模数乘法运算或是指数运算相比较为费时,可以发现在上述加密算法中除了密文验证算法外无需进行pairing对计算.如果修改参数X1和X2的选择方法:随机选取x1,x1∈Zp并计算X1=gx1和X2=gx2,将x1,x1∈Zp作为私钥保存.那么在不需要密文公开验证属性的条件下,上述加密算法可以通过判定验证等式C2=(C1)ωx1+τx2成立与否来确定密文的完整性,这样就无需进行pairing对计算从而提高计算效率.当然伴随计算效率的提高公开验证密文完整性的功能也失去了,目前支持密文完整性公开验证的算法都不可避免地要使用pairing对计算.4新算法在标准模型下的安全证明定理1.令H1:{0,1}→Zp是目标抗碰撞(TCR)Hash函数,H2:G→G是满足GHDH数学难题要求的抗碰撞Hash函数,假设GHDH数学难题成立,那么上述公钥加密算法是选择密文攻击安全(CCA)的.Page4准确地说,假设攻击者A执行CCA攻击上述加密算法的优势为εA=AdvPKE询问,那么存在一个对GHDH数学难题的攻击者B,对TCRHash函数的攻击者Btcr,使得攻击者B在至多执行O(qd(logp)2)数量的群运算后,其攻击GHDH数学难题的优势为AdvGHDH下面将具体描述仿真者和攻击者的交互行为.仿真者B将接受一个GHDH问题挑战(g,ga,gb,Z),他将利用上述加密算法攻击者A的攻击行为来解GHDH问题(判定Z是一个随机数或是Z=H2(gab)).证明.系统建立Setup(k).设群G的阶为素数p,存在一个高效的到G1的双线性映射,表示为e:G×G→G1;首先,B从GHDH数学难题挑战处获得(g,ga,gb,Z)和满足GHDH数学难题要求的抗碰撞Hash函数H2:G→G,令g1=ga,其中参数(a,b)未知;接着在Zp中随机选择x1,x2,x3和x4,计算X1=gx11gx2和X2=gx31gx4;最后随机选择目标抗碰撞(TCR)Hash函数H1:{0,1}→Zp.仿真者B给出公钥(g,g1,X1,X2),而(x1,x2,x3,x4)作为私钥由B保留.解密询问1.仿真者B收到询问密文C=(C0,C1,C2,C3),B测试e(C1,Xω其中ω=H1(C0,C1),如果等式不成立,B拒绝密文;否则B测试等式ωx1+C3x3=0(modp)是否成立,如果成立B将终止仿真(Abort1)并拒绝解密密文;反之B计算gt此解密消息M=C0/H2(CaH2(gt1=(C2/(Cωx2+C3x41))1/(ωx1+C3x3)gt=((Xω={((gx11gx2)ω(gx31gx4)τ)t/(gt)ωx2+C3x4}1/(ωx1+C3x3)={(gx1ω+x3τ={(gx1ω+x3τ挑战密文.仿真者B收到攻击者A输出两个等长的明文(M0,M1),B随机地选取一个比特β∈{0,1},给出挑战密文:C0=Z·Mβ,C1=gb,C2=gb(x2ω+x4τ),C3=τ,这里ω=H1(C0,C1),同时计算τ=-ωx1/1)并返回M.正确性.C2=(Xω=(gx2ω+x4τ)b=gb(x2ω+x4τ).如果Z=H2(gab)成立,那么上述关于Mβ的密文是正确密文:当Z=H2(gd)时,C0与C1是相互独立的.C2是由C0和C1的直接计算结果,C2中关于β的信息包含在H2(gd)·Mβ中,所以攻击者A仅能从H2(gd)·Mβ中获得β的信息,由于H2(gd)是一个攻击者未知的随机值,因此H2(gd)·Mβ中β的信息被隐藏.解密询问2.仿真者B收到询问密文C=(C0,C1,C2,C3),B测试e(C1,Xω等式不成立,B拒绝密文;否则B按照以下两种不同情况处理解密询问:(1)当C0=C0,C1=C1且C3=C3.此时必有C2=C2,因此有C=C,根据CCA安全模型定义仿真者B将拒绝进行解密回答;(2)当条件C0=C0,C1=C1且C3=C3不成立时,仿真者B将按照解密询问1中的过程进行处理.猜测阶段.在询问结束后,攻击者A输出对β的猜测值β.如果β=β,仿真者B判定GHDH挑战中的Z=H2(gab),否则判断Z为一随机数.在上述的仿真描述中,解密询问为C=(C0,C1,C2,C3),当C0=C0和C1=C1均不成立或有一个等式不成立时,若存在ω=H1(C0,C1)=H1(C0,C1)=ω,仿真者将以概率AdvTCR仿真;另外,仿真中B会在Abort1终止仿真,这里将计算Abort1发生的概率.如果在解密询问1中出现ωx1+C3x3=0(modp)发生,Abort1事件将发生.Pr[Abort1]=Pr[ωx1+C3x3=0(modp)]考察解密询问1时Pr[ωx1+C3x3=0(modp)]的概率,由于参数x1和x3对于攻击者是未知的,因此Pr[ωx1+C3x3=0(modp)]的概率为1/p;在解密询问2中攻击者获得了ωx1+τx3=0(modp),假设攻击者A还可以得到Page5对于攻击者A这里有6个未知数(a,b,x1,x2,x3,x4),但只有上述4个方程,因此攻击者将不能获得x1和x3的有用信息以帮助它提交特别的合法C=(C0,C1,C2,C3)使得Pr[ωx1+C3x3=0(modp)]的概率发生变化.因此在解密询问的仿真中,仿真者不终止的概率是独立的且每一次均为Pr[Abort1]=1-1/p.攻击者A进行解密询问qd次后,总的解密询问不终止的概率为Pr[Abortqd]=(1-1/p)qd.综上所述仿真者在系统仿真中不终止的概率为Pr[Abort]=Pr[Abortqd](1-AdvTCR表1相关加密算法效率对比公开密文完整性验证算法CS98[3]BMW[5](n+1)G+1G1/1G+(n+1)p1G1+1G√(4exp+(2+0.5n)multi)/(1exp+2multi+1E)1/(nqd)KitlzAppendixB[2](n+1)G/(n+1)p2G√(3exp+(2+0.5n)multi)/(2exp+1multi)1/(nqd)本文算法在表1中,公私钥参数数量计算时没有考虑Hash函数的数量,其后也不考虑Hash函数在加解密中的运算量;密文通信负担是指密文与明文消息长度的差值;公开密文完整性验证中×表示对应算法不支持公开的密文完整性验证,反之√表示支持;算法加/解密运算量列举了算法在非公开密文完整性验证情况下加解密需要的相应数学运算量(如需公开验证功能,后3个算法均需附加两次pairing对计算);算法的安全归约效率意味着算法安全性和所基于数学难题假设的紧密程度,“n”参数是Waters身份处理函数的输入长度,“qd”是攻击者在仿真证明中进行解密询问的最大次数,在任意安全要求条件下qd远大于n[6],如果算法安全性与数学难题假设的关系越紧密,那么算法也就越安全、可信.可以看出新算法的安全归约效率接近于CS98算法[3](:文献[3]并未直接给出安全归约效率,但可以推算接近1);新算法的安全归约效率较文献[2,5]中的加密算法有了很大提高.一般的,在现有最低160bits安全要求[6,10]下,n=160,qd=230,p=2160,G=2512,G1=2768.符号expmultiGZpG1假设攻击者A能以优势εA攻破上述混合加密算法,那么仿真者B能以如下优势解GHDH数学难题:εB=εAPr[Abort]1-1()p5相关算法性能对比表1中给出新加密算法与CS98加密算法、BMW加密算法及Kiltz文献[2]附录中公钥加密算法的效率对比.表2中给出相关符号定义.6总结本文利用陷门承诺函数的思想实现密文完整性的保护,从而给出一个新的公钥加密算法,它同时具备较为精简公私钥参数数量,较少的密文通信量,支持公开的密文完整性验证和高效的安全归约效率,新算法能在标准模型下被证明归约为GHDH数学难题假设.由于新算法同时具备上述优秀的密码学性质将使其具有更广阔的拓展应用前景.
