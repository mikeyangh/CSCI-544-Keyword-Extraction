Page1语音识别中带宽失配的补偿研究何勇军1),2)韩纪庆1)1)(哈尔滨工业大学计算机科学与技术学院哈尔滨150001)2)(哈尔滨理工大学计算机科学与技术学院哈尔滨150080)摘要目前的语音识别系统在训练环境与测试环境匹配的情况下具有很高的识别率,而当环境失配时,其性能将急剧下降.作者研究发现,带宽失配,即训练语料和测试语料带宽不一致,也是引起环境失配的主要原因之一.当测试语音带宽比训练语音带宽窄时,丢失的频段不可逆,且其影响在倒谱域或对数频谱域上是时变的,因而无法用目前的信道补偿方法补偿.文章在分析丢失频段对梅尔频率倒谱系数影响的基础上,提出了用频谱折叠方法对窄带测试语音进行补偿.在此基础上给出了语音带宽检测算法和带宽补偿统一框架.在AN4和TIMIT/NTIMIT数据库上的实验表明,该框架能有效增强语音识别系统在带宽失配情况下的鲁棒性.关键词带宽失配;畸变补偿;梅尔倒谱;鲁棒性;语音识别1引言让机器能像人一样感知和理解语音一直是人类的梦想,语音识别为这一梦想带来了希望.经过几十年发展,语音识别技术取得了巨大成就,从最初的孤立词识别到如今的大词表连续语音识别(LargeVocabularyContinueSpeechRecognition,LVCSR),Page2语音识别技术已经迈出了实验室并逐步走向应用.在理想环境下,目前的小词表以及中等词表语音识别系统的识别率能达到99%以上,LVCSR系统识别率也能超过95%[1],但在环境失配情况下,识别率将急剧下降.数十年来,研究者们尝试用各种方法来增强语音识别系统的鲁棒性,虽取得了一定进展,但目前的语音识别系统仍然难以适应复杂的应用环境.环境失配是指识别系统的训练环境和测试环境存在差异.造成环境失配的主要因素在于噪声的存在,这种噪声可能是加性的,可能是卷积性的,也可能是两者的混合[2].一般认为,外部环境噪声呈加性,信道影响呈卷积性.诸如训练环境没有噪声而测试环境存在噪声,或者训练环境和测试环境存在不同的噪声,都会引起环境失配.环境失配必然导致语音特征参数的分布存在偏差进而影响系统性能.为了增强语音识别系统的环境鲁棒性,研究者们提出了大量的方法.这些方法大致可分为两类,即特征增强和模型补偿.特征增强试图从畸变语音中提取鲁棒特征.这类方法或先对信号去噪然后提取特征,例如谱减[3]、维纳滤波、卡尔曼滤波[4]、子空间法[5]等,或者直接补偿特征,例如倒谱均值方差规正(CepstralMeanNormalization,CMN)[6-7]、特征弯折[8]、短时高斯化[9]、相关谱滤波(RelAtiveSpec-TrAl,RASTA)[10]、非线性滤波[11]等.模型补偿则试图修改声学模型来适应环境,典型的有并行混合模型[12]、泰勒级数展开(VectorTaylorSeries,VTS)[2,13]以及各种自适应方法如最大似然线性回归(MaximumLikelihoodLinearRegression,MLLR)[14]、最大后验概率(MaximumA-Posteriori,MAP)[15]等.测试语音和训练语音的带宽不同也会造成环境失配,比如训练语料采用16kHz采样率具有0~8kHz带宽,测试语料为10kHz具有0~5kHz带宽.语音的带宽失配广泛存在,除了采样率的影响,不同编码格式,不同编码速率以及不同麦克风或传输网络,都会造成带宽差异.一般来说,采样率越低,带宽越窄(奈奎斯特定理),编码速率越低,带宽也越窄(放弃了对某些频段的编码).带宽失配补偿的重要性体现在:(1)网络语音识别.互联网的发展使网络语音识别及相关应用应运而生,网络上的语音数据带宽复杂;(2)分布式语音识别.普适计算的兴起,分布式语音识别系统成为发展趋势.语音识别服务器要处理来自各种语音采集前端的数据,这些数据带宽多变;(3)语音检索.语音检索已经成为当前研究热点,处理的数据跨度数十年甚至上百年,有各种编码、采样率,必然存在带宽失配.因此,研究带宽失配补偿有着重要意义.虽然,在有额外标注数据的情况下,传统的模型自适应方法能有效补偿带宽失配.但上述应用环境复杂,且带宽随时变化,为每种可能出现的带宽都采集数据然后标注训练是不切实际的.我们需要的是能自动检测带宽,快速补偿不同带宽数据的方法.目前这方面的研究较少,文献[16]曾在丢失数据理论的基础上,提出用少量宽带语音和大量窄带语音训练桌面语音识别系统,却未给出窄带测试语音的补偿方法.带宽失配问题可以由窄带信道的传输引起,似乎可以采用目前的信道畸变补偿方法进行补偿.但这类方法大多假定信道在计算特征的频段上可逆,且信道影响在倒谱域的偏差为常量[6-7,17].基于上述假定的方法在丢失的频段是不成立的:一方面,在丢失频段上信道不可逆[18];另一方面,本文的分析表明,丢失频段在梅尔频率倒谱参数上引起的偏差是时变的.因此,传统的信道补偿方法事实上无法消除带宽差异对语音识别系统的影响.本文在分析丢失频段对梅尔倒谱特征参数影响的基础上,提出了采用频谱折叠方法补偿丢失频段的统一框架并给出了快速带宽检测算法.最后用实验验证了本文方法的有效性.2带宽失配对语音特征分布的影响在语音识别中,测试语音的带宽比训练语音的带宽宽或窄都会引起带宽失配.前者并不影响识别率,因为计算特征的梅尔滤波器组所覆盖的频段范围是固定的,范围以外的带宽已被忽略;对于后者,则需要重建丢失频段的信息.基于人耳听觉特性的梅尔频率倒谱系数(Mel-FrequencyCepstrumCoef-ficients,MFCC)及其差分在语音识别中处于统治地位.因此,本节将定量分析带宽失配对梅尔频率倒谱特征的影响.不失一般性,假定有宽带语音s(n)(这里的宽带语音是指带宽较宽的语音,非一般意义的宽带,窄带语音也类似),其采样率为fs(Hz),带宽为fs/2(Hz),分帧后各帧数据为s1,s2,…,sM.计算梅尔频率倒谱特征,首先做短时傅立叶变换并取幅值(有的文献取功率谱,但这不影响分析结果):Page3其中:m=1,…,M为帧序号;DFT(·)为短时傅里叶变换;Sm[k]为第m帧的第k个频谱分量的幅值,k=1,2,…,K为离散傅立叶变换序号,且K对应奈奎斯特频率.由于其带宽/Hz为fs/2,Sm[k]满足:该语音在某一环境影响下,其带宽变窄,相当于存在滤波器其传递函数H[k]满足其中K<K,需要注意的是,本文只分析带宽失配问题,不讨论频谱幅值的改变,但这种影响在信道不匹配情况下是存在的.滤波器H[k]的作用仅仅在于将宽带语音变成窄带语音.在频域,宽带变窄带表现为信号与该滤波器的乘积运算,窄带语音的幅度谱为显然,有如式(6)成立在梅尔倒谱的计算中,一组梅尔滤波器被用来模拟人的听觉特性.梅尔滤波器分布在频谱分量1~K范围内,则宽带语音经过梅尔滤波器组后,其输出表示为其中Ym[i]为第m帧宽带语音在第i个梅尔三角滤波器上的输出,i=1,2,…,I,且I为最后一个梅尔滤波器序号,对于窄带语音有Ym[i]=∑k其中Ym[i]为第m帧窄带语音在第i个梅尔滤波器上的输出.结合式(3),则当i=1,2,…,I时,其中I为覆盖窄带语音截止频率的梅尔滤波器序号,下式成立如图1所示,三角形为梅尔滤波器,虚线为某帧宽带语音的幅度谱,在频谱分量0~K上有不为零的能量,丢失频段以后,频谱分量0~K(对应梅尔滤波器输出为Ym[1]~Ym[I])的能量保持不变,频谱分量K+1~K(对应梅尔滤波器输出为Ym[I+1]~Ym[I])上的能量丢失.可见频宽较窄的语音在末尾几个梅尔滤波器所覆盖的范围,失去了宽带语音的全部信息,仅剩下信道噪声①级别的能量,即当i=I+1,I+2,…,I时Ym[i]≠0,而Ym[i]≈0,在对数运算时将溢出.语音识别系统通常采用一个很小的阈值代替,也就是令Ym[i]=ε>0,而ε接近于信道噪声并远小于宽带语音在该处的值.宽带语音的梅尔倒谱系数为犮=犆ln犢=[犆I×I犆I×(I-I)]ln犢I×1其中:ln(·)表示对输入向量的每个元素取对数,犆为离散余弦变换矩阵,[犆I×I犆I×(I-I)]是其分块矩阵的形式,各下标为行乘列形式.类似的,窄带语音的梅尔倒谱系数为犮′=犆ln犢′=[犆I×I犆I×(I-I)]ln犢′I×1其中犢和犢′分别为宽带语音帧及其对应的窄带语音帧的梅尔滤波器组的输出,皆为I维列向量,在这里省略了帧序号m,ε=[εε…ε]T为(I-I)维列向量.犮和犮′分别为两种语音对应的倒谱系数向量.根据式(7)~(9),二者差值为犱=犮-犮′=其中犱为I维误差向量,代表每一维倒谱系数产生的偏差.从式(11)可以看出:(1)宽带语音变成窄带语音在倒谱参数上的影响是扩散性的,即某些频段的缺失将使倒谱域上的每个参数产生偏差;(2)丢失的频段越宽,能量越大,产生的畸变就越严重.(3)偏差值并非常量,而是与该帧丢失的频段有关,①信道噪声为信道内的加性噪声或引起带宽丢失的处理所形Page4因为犱随着Y(I-I)×1变化.由于各帧丢失部分的能量各异,在倒谱参数上产生的偏差也就不同,因此这个偏差是随着帧不同而不同的,是时变的.目前的信道补偿方法,在倒谱域补偿特征或在模型域调整均值,其内在的假定都是信道对语音的影响在倒谱域是一个加性的常量,这对可逆时不变信道有效,而对丢失频段则是无效的.3丢失频段的重建将带宽较窄的语音信号准确恢复为带宽较宽的原始信号是不可能的,因为被衰减到零(严格说是信道噪声)的频段是不可逆的.所幸的是,语音特征参数是根据人的听觉特性计算的.从式(6)可以看出,梅尔滤波器的输出是其覆盖频段下能量的加权,如果能将丢失的高频部分的能量恢复到丢失前的水平,就能减小偏差,进而提高系统识别率.频谱扩展是一种将窄带信号扩展为宽带信号的方法,它利用窄带信号的频谱分量,根据窄带与宽带频谱能量之间的相关性来获得高频段能量.这类方法虽然不以准确恢复语音信号为目的,但却能使重建后的信号在高频段的能量与丢失前相近.文献[19]报道这类方法能显著改善窄带语音的主观听觉和客观能量误差.本文将频谱扩展方法用于补偿丢失的高频段频谱,以提升系统在不同带宽情况下的识别率.频谱扩展方法可分为基于模型的和非基于模型两类.基于发声模型的方法常采用线性预测(LinearPredictionCoding,LPC)模型对声道建模,并用LPC分析然后合成的方式扩展频谱.该类方法用窄带语音的残差和LPC系数计算丢失的高频语音的残差和LPC系数,然后合成高频语音.典型的有基于高斯混合模型[20]、隐马尔可夫模型[21]、人工神经网络[22]和基于码本映射[23]等方法.非基于模型的方法有频谱折叠、频谱搬移、非线性函数法[19]等,这类方法通过某种变换,将窄带语音低频部分的非零频谱“搬移”到高频以达到频谱扩展的目的.本文采用频谱折叠补偿丢失频段主要出于以下考虑:(1)实时性要求.基于发生模型的方法需要训练模型,然后结合模型补偿,计算复杂度高,而频谱折叠只需要插0计算和滤波计算,运算量低;(2)工作量要求.基于模型的方法需要宽带语音和对应的语音数据库训练模型,这需要大量人力物力,在大多数应用中无法满足,频谱折叠方法无需训练数据;(3)应用可行性.基于模型的方法主要针对带宽不随时间变化时的频谱扩展,当带宽发生改变,还必须重新采集数据集训练模型,这在现实应用中是无法做到的,而频谱折叠却无此限制.频谱折叠首先在时域对语音隔点插零,获得与低频频谱成镜像的高频频谱.假定sn[n],n=0,1,…,N-1为窄带信号,sf[n],n=0,1,…,2N-1为折叠后的信号,有sf[n]=2snn[]2,n=0,2,4,…,2(N-1)从式(12)可以看出,频谱折叠对信号在时域插入0值后,信号的采样率变成了原信号的一倍.为了统一频点,我们首先将窄带信号进行过采样,即sn[]n={sn[1],sn[1]+sn[2[对窄带信号进行离散傅立叶变换有Sn[]k2=∑2N-1sn[N-2]+sn[N-1[由傅立叶变换的性质有,Sn[]k2以k=N为对称轴.由于过采样不增加频宽,因此Sn[]k2在k=1,2,…,N/2时幅度值不为零,在其它频点幅度为零.对频谱折叠后的信号进行离散傅立叶变换有当k=1,2,…,N/2时,Sf[]k2=∑N-1而当频点大于N/2时SfN-[]k2=∑N-1Page5可见频谱折叠后,高频部分存在与低频部分成镜像的频谱(如图2、3所示).因为语音的能量大部分集中在低频段,高频段的幅度大致随频率递减,故通过隔点插零处理后的语音,高频段频谱幅度并不接近真实语音.要使折叠后的语音接近真实语音,必须对高频部分能量进行修正.一个合理的整形函数能使折叠后的信号在高频部分非常接近真实语音.频谱整形可以用下面式子表示其中,k=0,2,…,2N-1,Sf[k]为频谱折叠后语音的频谱,Sw[k]为滤波整型后语音的频谱,H[k]为整形滤波器.整形滤波器的目的在于削弱高频部分的镜像频谱,使其接近真实语音的高频频谱.我们采用有限冲击响应低通滤波器达到这一目的.滤波器在设计时设定其上限截止频率比频谱对称点大100Hz左右.为了使滤波对高频的衰减稍慢,其阶数设置为5比较适中.如图4所示,频谱整形以后,高频部分有了可用的频谱.图3频谱折叠后效果(在高频部分出现了镜像频谱)需要注意的是,频谱折叠后,高频部分和低频部分是以奈奎斯特频率(采样频率的1/2)为对称点的.如果语音最大不为零的频率值低于奈奎斯特频率,频谱折叠就会在奈奎斯特频率附近产生一个空隙,在空隙中信号能量仍然为零,无法被重建.因此,图4对折叠后频谱整形滤波,获得的宽带语音频谱在频谱折叠之前,首先需要对语音进行重采样,重采样的频率为语音实际带宽上限截止频率的两倍.4语音带宽检测引起语音带宽变窄的因素众多,各种因素对语音带宽的影响差别较大,因此只用语音的采样率,根据奈奎斯特定理来确定语音的带宽是不可靠的.而用频谱折叠重建高频段需要准确知道语音的带宽,否则就会在奈奎斯特频率附近形成频谱空隙.如果语音的带宽/Hz为fl~fh,带宽检测的任务在于确定fl和fh的值.考虑到低频段损失很小,系统采用fl=0.25kHz的设置,因此,带宽检测的主要任务在于确定fh.首先通过语音活动检测获取一段活动语音{X1,X2,…,XT1}和另一段静音{Y1,Y2,…,YT2},各帧都已经过2K点傅立叶变换,取第1到第K个值(频率采样定理)并取模.带宽检测如算法1所示.算法1.fori=1toKε[i]←1εmax[i]←maxt(犢t[i]);狓[i]←1endfori←K;while狓[i]εmax[i]i←i-1;endwhilefh=(fs/2K)×i;其中fs为未知带宽语音的采样率.算法通过比较εmax[i]和狓[i]的值来确定fh所在的位置.对于窄带语音,语音段均值狓的高频分量(衰减为信道噪声)近似等于向量ε内对应元素的值,这些值又必然小Page6于εmax对应的值,而狓低频部分的值(未被衰减)又大于εmax.算法最后一行将截止频率所在的傅立叶变换序号换算成频率.该算法自动统计门限,运算复杂度低.5带宽失配补偿框架补偿带宽失配就是要减小测试语音和训练语音的带宽不一致所造成的影响,提高识别率.因此,在测试时,只需要对那些带宽比训练语音带宽窄的语音进行频谱折叠补偿.在系统的构建上,必须为训练语音确定一个合理的带宽.一般而言,桌面语音识别系统采用0.2~8kHz的带宽,电话语音识别系统采用0.3~3.5kHz带宽.如果采用桌面系统的带宽训练语音,在面对电话语音时需要重构3.5~8kHz的频段,而频谱分量相关性随频率距离增加而减弱[24],在用低频频谱重建高频谱时,如高低频谱频率距离太大将导致重构误差增大.如果采用电话系统的频谱训练语料,将所有频谱的高频部分都去掉,虽然无需频谱重构,但其性能是次优的[16].我们需要确定一个训练带宽,既确保宽带语音被准确识别,又使得窄带语音不至于重构太宽的频带.本文通过在AN4数据库上的实验来确定训练模型使用的带宽.AN4中语音采样率为16kHz,带宽为0.13~8kHz.使用低通滤波器将训练集和测试集处理成为带宽为0.25~7.5kHz、7kHz、6.5kHz、6kHz、5.5kHz5个版本的数据,分别用来训练模型,然后用相应的测试集测试.AN4数据库的介绍以及语音识别系统参数设置见6.1节.如图5所示,实验结果表明随着带宽变窄,带宽匹配情况下识别率逐渐降低,但在6.5kHz以上时,下降并不明显,因为6.5~8kHz内能量低,畸变较小(式(10)).训练语音带宽确定为0.25~6.5kHz是一个折中而合理的选择.因此,本文系统训练时用采样率16kHz的语音,并使梅尔滤波器组分布的频率范围为0.25~6.5kHz.系统的补偿框架如图6所示,测试语音首先经过带宽检测模块,采用算法1检测带宽,如果测试语音带宽高于训练语音带宽,则直接重采样,使其采样率与训练语音的采样频率一致并送入特征提取模块.对于带宽上限截止频率低于6.5kHz的语音,先重采样,使其采样频率为其上限截止频率的二倍以避免频谱折叠时引起频段空隙,然后用前述的隔点插零以及滤波整形重构丢失频段,紧接着重采样使其采样率为16kHz,进而使用高通滤波器仅保留丢失频段部分,最后将原始语音重采样后与重构语音进行叠加,形成补偿后的语音用于特征提取.图6带宽失配补偿流程,其中fh为语音带宽上限截止6实验与分析6.1在AN4上的实验本节采用AN4数据库对本文方法进行测试.AN4是卡耐基梅隆大学的一个语音数据库,采样率为16kHz,内容为数字串和字母串.训练集含有74个发音人(53男,21女)的948句语音,测试集含有74个发音人的130句语音.实验采用CMU的Sphinx-4,并用AN4中所有语音文本训练3元统计语言模型.在声学模型的训练方面,采用3音子绑定声学模型.将AN4训练语料通过带通滤波器处理,使其带宽在0.25~6.5kHz范围内,用来训练声学模型.将AN4语料分别通过带通滤波器处理,使其Page7应,然后识别对应的窄带语音;形成0.25~6.0kHz、5.5kHz、5.0kHz、4.5kHz、4.0kHz、3.5kHz、3.0kHz等7个窄带语料库,用于自适应或测试.前端处理的预加重系数为0.97,梅尔滤波器组的滤波器个数为40,短时傅立叶变换点数为512,帧长为30ms,帧移10ms.采用13维梅尔频率倒谱系数及其一阶,二阶差分参数构成39维特征参数.训练和所有测试中的梅尔倒谱参数都经过CMN与RASTA处理.各用于用于对比实验的方法标记如下:Baseline:用宽带声学模型识别各窄带测试语音,训练数据和测试数据经CMN和RASTA处理;MLLR:用宽带模型和窄带数据进行MLLR自适应,然后识别对应的窄带语音;MAP:用宽带模型和窄带数据进行MAP自适SF:用本文方法对窄带语音重建后用宽带声学模型识别.对于MLLR和MAP采用监督学习的方法,而为了测试本文方法的带宽测试能力,带宽信息对SF是不可知的.也就是识别时,SF以句子为单位,检测语音带宽作为频谱重构的输入信息.从各训练集选择性别均衡的40人的语音(约480句)作为对应带宽的自适应数据.从图7可以看出,使用0.25~6.5kHz训练的模型在测试语音带宽匹配的情况下识别率最高达到99.6%,随着测试语料带宽变窄,Baseline的识别率明显下降,到了3kHz时降到了69.2%.经过CMN与RASTA处理后,识别率仍然随着带宽降低而快速降低,这种结果符合式(11)的分析.MLLR和MAP在有较多标注数据时能有效补偿带宽失配,随着带宽变窄,对识别率的提高尤其显著.自动检测带宽时,SF在上限截止频率为6kHz和5.5kHz时与模型自适应方法相当,随着带宽继续降低时,其性能优于模型自适应方法.另外,在带宽给定情况下,SF的性能要略优于自动检测带宽时的识别率.这说明经一步提高带宽检测准确率有助于提高本文方法的性能.6.2在TIMIT/NTIMIT上的实验为了进一步验证本文算法的有效性,我们在TIMIT/NTIMIT数据库上做了实验.TIMIT数据库中包含来自美国的8个方言区的630个发音人(其中男438,女192)的语音数据,每个人作10次发音,每次发音内容为一个句子,语音采样率为16kHz.库中的6300个发音被分成训练集和测试集,其中训练集4620句,测试集1680句.NTIMIT是TIMIT在窄带电话环境的版本,由TIMIT中的数据通过美国本土电话网络后重新录制而成.与TIMIT相比,NTIMIT数据库虽然采样频率也为16kHz,但其真实带宽为电话信道的带宽,即0.3~3.2kHz.除此之外,NTIMIT的频谱在幅值上也受到电话信道的影响.本实验训练带宽和特征参数的选择与AN4数据库上的实验相同,CMN与RASTA也用于前端处理.系统采用TIMIT训练集训练3音子绑定声学模型,用TIMIT上所有文本训练3元统计语言模型,分别用来识别NTIMIT测试集以及用本文方法补偿后的NTIMIT测试集.选择NTIMIT测试集的40人(男20,女20,共400句)的语音作为自适应数据为MLLR和MAP做自适应.实验结果如表1所示,可以看出,Baseline使用CMN与RASTA消除信道影响后在NTIMIT测试集上识别率只有56.2%.这进一步证实了这两种方法补偿带宽失配的局限性.MLLR和MAP的识别率分别达到了59.4%和60.6%,相比之下,本文的方法进行补偿后识别率比Baseline提高了6.5个百分点.6.3实验小节当丢失带宽较多时,带宽失配对识别率影响比较严重,必须加以补偿.模型自适应是目前常用且有效的方法,在有足够带标注数据情况下,补偿效果较为明显.可以预料,随着自适应语料的增加,这类方法的识别率会继续上升甚至超过本文方法.然而在带宽失配情况下,这类方法存在很大局限性.复杂应Page8用环境,诸如网络,语音检索等应用,带宽不可预测而且随时发生变化.自适应算法需要重新采集数据进行标注然后用于训练.这使得该类方法难以使用.本文方法工作在语音识别的前端,随时检测带宽,无需任何标注数据直接补偿,且算法复杂度低,适合实时应用.7结论训练语音与测试语音带宽失配在应用中广泛存在.本文研究表明,带宽失配对梅尔倒谱特征分布的影响是扩散性的,且损失的频段越宽,其能量越大,产生的畸变也越大.这种畸变是时变的,因此无法用加减信道偏移量或在模型域移动高斯均值来实现补偿.模型自适应方法在带宽不变时效果明显,在带宽变时难以使用.本文分析了带宽失配对梅尔特征参数的影响并提出了基于频谱折叠的补偿框架,其补偿效果明显.进一步的实验表明:本文提出的框架能有效提高语音识别系统在带宽失配情况下的鲁棒性.
