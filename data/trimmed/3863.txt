Page1改进的选择密文安全公钥加密方案陈泯融1),2)张席3)何凯4)关超文4)刘丹4)1)(深圳大学信息工程学院广东深圳518060)2)(华南师范大学计算机学院广州510631)3)(深圳大学计算机与软件学院广东深圳518060)4)(暨南大学计算机系广州510632)摘要如何设计在标准模型下满足适应性选择密文安全(IND-CCA2)的高效公钥加密方案,是公钥密码学领域中的一个重要研究课题.康立等人提出了一个高效的公钥加密方案,并认为他们的方案在标准模型下满足IND-CCA2安全.文中首先对该方案进行分析,通过给出具体的攻击方法表明该方案并不满足IND-CCA2安全.然后对该方案进行改进得到一个新的公钥加密方案,并在标准模型下证明了新方案的IND-CCA2安全性.关键词公钥加密;标准模型;适应性选择密文攻击;双线性配对1引言码学领域的一个重要研究课题.如何设计高效安全的公钥加密方案,是公钥密Rackoff和Simon[1]在1991年提出了适应性选择密文安全(IND-CCA2)的概念.目前,IND-CCA2已成为公钥加密体制的标准安全性要求.在ACMCCS’93上,Bellare和Rogaway[2]提出了随机预言机模型(randomoraclemodel)的概念,并构建了一Page2个在随机预言机模型下满足IND-CCA2安全的公钥加密方案.然而,正如Canetti等人[3]所指出的,在随机预言机模型下证明安全的公钥密码方案在实际中可能是不安全的,因为随机预言机模型与真实世界存在着一定的差距,在真实环境中攻击者掌握Hash函数的细节信息而在随机预言机模型中Hash函数对于攻击者是个黑盒子.因此,不依赖随机预言机模型(即标准模型)下满足IND-CCA2安全的公钥加密方案更加具有吸引力.在Crypto’98上,Cramer和Shoup[4]提出了首个在标准模型下满足IND-CCA2安全的高效公钥加密方案(简称为“CS方案”),该方案的安全性是基于判定型迪菲-赫尔曼(DDH)假设的.在ACMCCS’05上,Boyen等人[5]利用双线性配对(bilinearpairing)这一工具,提出了一个标准模型下满足IND-CCA2安全的公钥加密方案(简称为“BMW加密方案”),该方案能够支持密文公开可验证性(即任何人无需私钥都可以验证密文的有效性).随后,学术界提出了一些标准模型下满足IND-CCA2安全的公钥加密方案,如文献[6-10]等.近年,康立等人[11]提出了一个新的公钥加密方案.该方案具有很高的效率,能够支持密文公开可验证,并认为可以在标准模型下满足IND-CCA2安全.然而,遗憾的是,本文通过给出的具体攻击方法,表明康立等人的公钥加密方案并不满足IND-CCA2安全.需要特别指出的是,虽然他们的方案没能满足IND-CCA2安全,但是其方案具有较巧妙的设计思想,确实为公钥加密体制的设计作出了贡献.本文在康立等人加密方案的基础上,设计了一个新的公钥加密方案,并在标准模型下证明了所提方案满足IND-CCA2安全.本文第2节介绍公钥加密体制定义和安全模型、双线性配对及相关困难问题假设以及目标防碰撞Hash函数等基础知识;第3节回顾康立等人的公钥加密方案,并通过给出具体的攻击方法表明其方案并不满足IND-CCA2安全;第4节提出一个新的公钥加密方案,并在标准模型下证明该方案满足IND-CCA2安全;第5节对本文进行了总结.2预备知识2.1符号说明对于一个有限集合S,令x∈S表示从S中随机均匀选取元素x.令A(x,y,…)表示一个输入为(x,y,…)的算法A,而z←A(x,y,…)表示运行算法A(x,y,…)来得到输出z.对于一个函数f(·),若对于任意多项式p(·),均存在一个自然数N,使得对于所有n>N,均有f(N)<1是可忽略的.2.2公钥加密定义及安全模型一个公钥加密方案由如下3个算法组成:(1)密钥生成算法Setup(k).给定安全参数k,该算法输出公钥pk和相应的私钥sk.(2)加密算法Enc(pk,m).给定公钥pk和明文m,该算法输出密文C.(3)解密算法Dec(sk,C).给定私钥sk和密文C,该算法输出明文M或⊥.此处⊥意味着C为非法密文.公钥加密方案的IND-CCA2安全模型可以通过下面的挑战者C与敌手A之间的游戏来定义:系统建立阶段.挑战者C运行算法Setup产生公/私钥对(pk,sk),然后将pk交给敌手A,而将sk秘密保留.查询阶段1.在本阶段,敌手A进行一系列的解密查询.当敌手A对密文C进行解密查询时,挑战者C运行Dec(sk,C)并将结果返回给敌手A.挑战阶段.当敌手A决定结束查询阶段1时,它输出两个长度相等的明文M0,M1.挑战者C随机选取β∈{0,1},将挑战密文设定为C=Enc(pk,Mβ),然后将C返回给敌手A.查询阶段2.敌手A继续进行一系列的解密查询,挑战者C采取与Phase1相同的方法进行应答.此处要求敌手A不能对C进行解密查询.猜测阶段.最后,敌手A输出对β的猜测β.将上述敌手A称为IND-CCA2敌手,并将它攻击上述公钥加密方案的优势定义为若对于任意概率性多项式时间(PPT)敌手A,它针对一个公钥加密方案的优势AdvIND-CCA2忽略的(negligible),则称该公钥加密方案是IND-CCA2安全的.2.3双线性配对映射及困难性问题设G和GT为素数p阶循环群.满足如下3个条件的映射e:G×G→GT称为双线性配对映射:(1)双线性.对于g1,g2∈G及a,b∈Z有e(ga1,gb2)=e(g1,g2)ab成立;(2)非退化性.g1,g2∈G满足e(g1,g2)≠1GT,其中1GT为群GT的一个单位元.Page3若对于任意PPT算法β,它针对群组(G,GT)上(3)可计算性.存在有效算法,对于g1,g2∈G,均可计算e(g1,g2)的值.设G和GT均为素数p阶群,则群组(G,GT)上的判断型双线性Diffie-Hellman(DBDH)问题为:给定(g,ga,gb,gc,Q)∈G4×GT,对于未知的a,b,p,判断Q=e(g,g)abc是否成立.对于一个PPTc∈Z算法β,将其针对群组(G,GT)上的DBDH问题的优势定义为β=|Pr[β(g,ga,gb,gc,e(g,g)abc)=1]-AdvDBDH其中a,b,c,z∈RZ的DBDH问题的优势AdvDBDH(G,GT)上的DBDH假设成立.2.4目标防碰撞Hash函数设F是一个Hash函数族,该函数族内的任意Hash函数H均是由定义域D到值域R的映射,即H:D→R.对于Hash函数族F中任意给定的Hash函数H,将一个PPT敌手针对H的目标防碰撞性(TargetCollisionResistance,TCR)的优势定义为AdvTCRPr[x∈D,y←A(H,x):H(x)=H(y)∧y≠x].若对于Hash函数族F任意随机选取的Hash函数H及任意PPT敌手A,均有AdvTCR称该Hash函数族F是目标防碰撞的.在实际应用中,通常可以采用诸如SHA-1等密码学Hash函数作为目标防碰撞的Hash函数H.为方便起见,后文将假定目标防碰撞的Hash函数H为一个固定的函数.3对康立等人方案的安全性分析3.1康立等人的公钥加密方案A=其公钥加密方案由如下算法组成[11]:(1)系统建立算法Setup(k).选取kbit素数p阶双线性配对群组(G,GT),其中g为G的生成元.选取目标防碰撞Hash函数H1:{0,1}→Zp和H2:G→G.随机选取a∈Zg1=ga.最后输出公钥pk=(g,g1,X1,X2)和私钥sk=a.(2)加密算法Enc(pk,M).随机选取r,τ∈Z然后计算密文C0=H2(gr其中w=H1(C0,C1).最后输出密文C=(C0,C1,C2,C3).(3)解密算法Dec(sk,C).给定密文C=(C0,C1,C2,C3),该算法首先计算w=H1(C0,C1),然后验证e(C1,Xw则拒绝该密文;否则利用私钥sk=a按照如下方法恢复明文:M←C03.2攻击方法加密方案的IND-CCA2安全性:钥pk=(g,g1,X1,X2).下面给出一个PPT敌手来攻破康立等人公钥(1)在系统建立阶段,敌手从挑战者处获得公(2)在查询阶段1,敌手无需进行任何解密查询.(3)在挑战阶段,敌手提交两个等长的明文M0和M1,然后获得挑战密文C=Enc(pk,Mβ).根据康立等人的方案描述,挑战密文C=(C0,C1,C2,C3)为如下形式:C0=H2(gr其中w=H1(C0,C1).(C0,C1,C2,C3):(4)在查询阶段2,敌手首先构造如下密文C=C0=2C0=H2(grC2=(C2)wC3=τ=w其中w=H1(C0,C1).注意到C=(C0,C1,C2,C3)实际上是针对明文2Mβ的一个密文,且可以通过密文有效性检验:e(C1,Xw然后,敌手对C进行解密查询.注意到由于C≠C,敌手对C进行解密查询是合法的.因此,敌手将可以获得密文C对应的明文2Mβ,进而获得Mβ.知道Mβ的值,敌手当然可以通过与(M0,M1)进行比较来获得β的值,从而攻破康立等人加密方案的IND-CCA2安全性.4改进方案本节在康立等人的公钥加密方案的基础上,给出一个新的公钥加密方案,并在标准模型下证明所提方案满足IND-CCA2安全.Page44.1方案描述本文的改进方案由如下算法组成:(1)系统建立算法Setup(k).选取kbit素数p阶双线性配对群组(G,G1),其中g为G的生成元.选取目标防碰撞Hash函数H:G2→Zp.随机选取和X1,X2,X3∈G,并计算g1=gx.最后输出公钥pk=(g,g1,X1,X2,X3)和私钥sk=x.(2)加密算法Enc(pk,M).给定明文M∈GT,该算法首先随机选取τ,τ∈ZC0=e(g1,X3)rM,C1=gr,C2=(Xw其中w=H(C0,C1).最后输出密文C=(τ,C0,C1,C2).(3)解密算法Dec(sk,C).给定密文C=(τ,C0,C1,C2),该算法首先计算w=H(C0,C1),然后验证e(C1,Xw拒绝该密文;否则利用私钥sk=x恢复明文4.2安全性证明定理1.假设H是一个目标防碰撞的Hash函数且群组(G,GT)中的DBDH假设成立.那么,本文方案是IND-CCA2安全的.证明.不失一般性,假设H是一个目标防碰撞的Hash函数.若存在一个多项式时间敌手A能够以不可忽略的优势ε攻破本文所提方案的IND-CCA2安全性,那么将可以构造多项式时间算法B以不可忽略的优势ε攻破群组(G,GT)中的DBDH假设,其中ε满足其中qd为敌手进行解密查询的次数.给定DBDH实例(g,ga,gb,gc,Q)∈G4×GT,其中a,b,c为Z是判断Q=e(g,g)abc是否成立.按照IND-CCA2游戏的规则,算法B和敌手A按照如下方式进行交互:系统建立阶段.B选取α1,α2,α3,β1,β2,β3∈Z然后计算g1=ga,X1=(gb)α1gβ1,X2=(gb)α2gβ2,X3=(gb)α3gβ3,并将公钥pk=(g,g1,X1,X2,X3)交给敌手A.查询阶段1.如IND-CCA2游戏所述,敌手A在本阶段可以进行一系列解密查询.当敌手A对密文C=(τ,C0,C1,C2)进行解密查询时,算法B首先计算w=H(C0,C1),并检查e(C1,Xw是否成立.若不成立,则拒绝该密文;否则,进一步检查α1w+α2τ+α3=0modp是否成立.若成立,算法B输出一个随机位并终止游戏;否则,算法B计算3←((gb)r)α3Cβ31=((gb)r)α3(gr)β3=((gb)α3gβ3)rXr然后将明文M←C0需要指出的是,在公钥参数X1=(gb)α1gβ1,X2=(gb)α2gβ2和X3=(gb)α3gβ3中,α1,α2和α3分别被β1,β2和β3所盲化,因此敌手A无法获得α1,α2和α3的任何信息.从而α1w+α2τ+α3=0modp的概率最多为1挑战阶段.敌手A输出两个等长的明文M0,M1∈GT.算法B计算C0=Qα3e(ga,gc)β3Mβ,C1=gc,w=H(C0,C1),τ=-α1w+α3(gc)β1w+β2τ+β3,然后将C=(τ,C0,C1,C2)作为挑战密文交给敌手A.若Q=e(g,g)abc成立,上面所得的C是一个有效密文,这是因为:C0=Qα3e(ga,gc)β3Mβ=(e(g,g)abc)α3e(ga,gc)β3Mβ=e(ga,(gb)α3)ce(ga,gβ3)cMβ=e(ga,(gb)α3gβ3)cMβ=e(g1,X3)cMβ,C1=gc,C2=(gc)β1w+β2τ+β3=(gβ1w+β2τ+β3)c=((gb)α1w+α2-α1w+α3=((gb)α1w+α2τ+α3gβ1w+β2τ+β3)c=(((gb)α1gβ1)w((gb)α2gβ2)τ(gb)α3gβ3)c=(Xw查询阶段2.在本阶段,敌手A继续进行一系列解密查询.当敌手A对密文C=(τ,C0,C1,C2)进行查询时,算法B首先计算w=H(C0,C1),并检查e(C1,Xw拒绝该密文;否则,算法按如下情况进行处理:(1)若(τ=τ)∧(C0=C0)∧(C1=C1),这意味着C2=C2,即C=C.根据安全模型,算法B拒绝进行解密应答.(2)若((C0≠C0)∨(C1≠C1))∧(H(C0,C1)=H(C0,C1)),算法B输出一个随机位并终止游戏.然而,根据H的目标防碰撞性,整个仿真过程中这种情况发生的概率最多为AdvTCRPage5(3)其它情形:算法B按照查询阶段1的方法进行解密.值得指出的是,虽然敌手可以从挑战密文中获知α1w+α2τ+α3=0modp这一信息,α1w+α2τ+α3=0modp发生的概率仍然最多为1此处只有两个方程而有3个未知数.猜测阶段.最后,敌手A输出一个猜测β∈{0,1}.若β=β,算法B输出1来猜测Q=e(g,g)abc;否则,B输出0来猜测Q=e(g,g)z.令Abort表示仿真过程中算法B发生失败而终止的事件,则可得Pr[Abort]=1-qd()p(1-A).注意到,一方面,若事件Abort不发生且AdvTCRQ=e(g,g)abc,则从敌手A的角度来看,算法B提供的仿真与真实环境是不可区分的,因此可得Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1Abort]=12+ε.另一方面,由仿真过程可知,若事件Abort发生且Q=e(g,g)abc,则算法B输出1的概率为1Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1Abort]=12.因此可得Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1]=Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1|Abort]Pr[Abort]+Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1Abort]Pr[Abort]2+()εPr[Abort]+1=12+()εPr[Abort]+1=1表1本文方案与相关加密方案的比较方案Kiltz公钥长度5G(n+1)G+1G1(n+1)G私钥长度5Zp1G+(n+1)Zp(n+1)Zp密文长度3G+1M2G+1M2G+1M2G+1Zp+1M2G+1Zp+1M加密运算量3te+1tme2te+1tme解密运算量1te+1tme1te+1tme+3tp密文公开可验证?NoCCA2安全?紧归约?5结束语本文对康立等人最近提出的公钥加密方案进行了分析,指出其方案并不满足IND-CCA2安全.然后提出一个新的公钥加密方案,并在标准模型下证=12+Pr[Abort]·ε.此外,若Q为群GT中的随机元素(即Q=e(g,g)z),从敌手A的角度来看,C与β是互相独立的,因而可得Pr[B(g,ga,gb,gc,Q=e(g,g)z)=1]=1此,算法B针对群组(G,GT)中DBDH假设的优势为ε=Pr[B(g,ga,gb,gc,Q=e(g,g)abc)=1]-=1=Pr[Abort]·ε=1-qd()p(1-AdvTCR上述优势显然是不可忽略的.再由仿真过程来看,算法B的运行时间也是多项式时间的.因此定理获证.4.3效率比较表1对本文所提的加密方案与CS98方案[4]、BMW加密方案[5]、Kiltz加密方案(文献[8]附录中的方案)、康立等人方案[11]在效率和所具备性质方面进行了比较.在表1中,M、G、G1和Zp分别表示明文空间、群G、G1和Zp中的一个元素的位长度.te、tme和tp分别表示一个模指数乘法、多重模指数乘法和双线性配对的运算代价.从表1可见,与CS98方案相比,本文方案具有更短的私钥长度,并且密文具有公开可验证性.与BMW方案和Kiltz方案相比,本文的公/私钥长度更短,并且具有更紧的安全性归约.与康立等人方案相比,本文方案能够满足CCA2安全.2teYesYesNo明了新方案的IND-CCA2安全性.
