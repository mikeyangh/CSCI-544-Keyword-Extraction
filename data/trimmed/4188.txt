Page1一种结合推荐对象间关联关系的社会化推荐算法郭磊1)马军1)陈竹敏1)姜浩然2)1)(山东大学计算机科学与技术学院济南250101)2)(山东省邮政公司信息技术局济南250011)摘要随着社会化媒体的兴起,信息资源的数量呈现爆炸式增长,如何在海量的信息中帮助用户发现有用的知识成为亟需解决的问题.社会化推荐方法作为一种有效的信息过滤技术,由于能够结合社会网络的特点,模拟现实社会中的推荐过程,在分析用户历史行为的基础上,主动向用户推荐满足他们兴趣和需求的信息,受到了研究者们的广泛关注.但目前已有的方法大都只从用户间社会关系的角度出发,仅认为相互信任的朋友间具有相似的兴趣爱好,而忽略了推荐对象间的关联关系对推荐结果产生的影响.针对以上存在的问题,文中从推荐对象间关联关系的角度出发,假设具有关联关系的推荐对象更容易受到同一用户的关注,并进而在已有的社会化推荐算法的基础上,提出了一种结合推荐对象间关联关系进行推荐的算法.算法使用共享的潜在特征空间对目标函数的求解过程进行约束,使其在考虑用户间社会关系的同时,也考虑到推荐对象间关联关系所起到的重要作用.实验结果表明,与主流的推荐算法相比,文中所提出的方法在分类准确率和评分误差等多种评价指标上都取得了更好的结果.关键词社会网络;矩阵分解;推荐系统;协同过滤;社会化推荐1引言近年来,随着诸如Facebook、Twitter等社会化媒体的兴起,利用用户间的社会关系进行推荐的方法,由于能更好地模拟现实社会中的推荐过程,更能体现出人在推荐过程中的作用,逐渐成为推荐领域的研究热点.例如,Ma等人[1-2]研究了如何利用用户间的社会关系来进一步提高传统推荐方法的性能,并给出了一种能够将社会关系信息进行整合的概率矩阵分解框架.Jamali等人[3]则通过对用户间信任关系的传播现象进行建模,提出了一种基于信任传播的推荐方法.以上这些社会化推荐方法,虽然能够对推荐的社会化过程进行建模,但它们大都只从用户的角度出发,而假设推荐对象之间是相互独立的,忽略了推荐对象间的关联关系在许多应用场景中对推荐结果产生的影响.例如,在微博中的Follow关系推荐场景中,当我们为用户推荐Follow关系时,用户往往更倾向于选择那些与自己的朋友有Follow关系的人(推荐对象之间存在Follow关系).再比如,在商品推荐场景中,用户则更倾向于选择那些与自己购买过的商品有关联关系的物品(曾经购买过羽毛球拍的用户,很有可能会在未来购买羽毛球).基于对以上应用场景的分析,为了能更好地对推荐过程进行建模,从而体现出推荐对象间的关联关系对推荐结果产生的影响.在本文中,我们首先引入了在NetflixPrize①比赛中取得较好成绩的矩阵分解方法对用户的评分信息进行建模,然后在已有社会化推荐算法的基础上融入了推荐对象间的关联关系信息进行推荐.具体而言,我们将三种不同类型的数据信息(用户间的社会关系、对象间的关联关系和评分信息)通过共享的潜在特征空间进行关联,使得算法在学习过程中能对目标函数进行约束,从而达到优化推荐结果的目的.本文的贡献主要包括以下3个方面:(1)在已有社会化推荐算法的基础上提出了一种结合推荐对象间关联关系的推荐方法,并给出了算法的概率图模型和具体的求解过程;(2)使用共享特征空间的方法利用社会网络信息对推荐结果进行优化,将3种不同类型的信息关联到一个统一的推荐框架中;(3)在微博数据集上测试了算法在准确率和评分误差等评价指标上的性能,分析了推荐对象间的关联关系和算法中的参数对实验结果的影响.2相关工作这一节主要介绍了与本文相关的几种社会化推荐算法和本文所研究内容的最新进展.推荐系统按照所使用的数据来分类[4],可以分为协同过滤[5-6]、内容过滤[7-8]和社会化推荐系统等.其中,社会化推荐系统是指利用了用户或推荐对象间的社会网络信息对推荐过程进行建模的算法.这里的社会网络信息主要包括用户间的信任或朋友关系,以及推荐对象间的关联关系.其中用户间的信任或朋友关系是指用户间由于有共同的兴趣爱好而形成的一种社会关系.目前,社会化推荐算法大都集中在如何利用用户间的社会关系来提高推荐的准确率.例如,在文献[9-10]中,Massa和Avesani研究了利用信任关系来改进协同过滤的方法,他们在算法中使用用户间的信任关系矩阵来代替寻找相似用户的过程,并且假设这种信任关系不但可以在信任网络中进行传播,还可以对未知的信任值进行预测.实验结果表明,他们的方法可以在不降低正确率的情况下,有效地提高覆盖率.在文献[11]中,Ma等人提出了一种基于矩阵分解的社会化推荐方法,他们通过一个共享的低维潜在用户特征矩阵,将用户间的信任关系网络同评分矩阵结合在一起.实验结果表明,与传统的推荐方法相比,他们的方法能取得更好的推荐效果.在随后的工作中[1],他们又从解决数据稀疏性的角度出发,将用户及其朋友的兴趣信息使用统一的①http://www.netflixprize.com/Page3框架进行整合,同时利用用户评分和用户间的信任关系信息进行推荐.Konstas等人[12]则通过在音乐推荐系统中使用带重启的随机游走模型对朋友关系和标注关系进行建模,研究了社交网络在推荐系统中的作用.另外一些相关工作则围绕着如何挖掘更深层次的用户关系信息来提高推荐的质量,如Yuan等人[13]研究了社会网络中的两种社交关系“friendship”和“membership”在推荐系统中的作用,并提出了一种将它们融合在一起的推荐算法.Yang等人在文献[14]中认为用户间的信任关系强度并不是唯一的,而是受到其所处的朋友圈的影响,在不同的朋友圈中,用户间的信任关系也是不同的.他们通过给用户的朋友赋予不同的权重来对用户间的信任关系进行建模,并提出了一种基于朋友圈的社会化推荐算法.Noel等人[15]针对社会化推荐算法在计算用户相似性时没有考虑到用户本身的特征、不能直接对用户间信息传播建模和不能反映用户间只有部分兴趣相同的问题,给出了一种将多种目标函数整合在一起的方法,并在矩阵分解的框架下进行求解.已有的社会化推荐算法虽然取得了不错的推荐效果,但它们大都只从用户间社会关系的角度出发,而忽略了推荐对象间关联关系的重要性.因此本文从推荐对象间关联关系的角度出发,研究了其对推荐结果所产生的影响.目前,在社会网络中结合推荐对象间的关联关系进行推荐的相关研究还较少.例如,Jiang等人[16]在研究为用户推荐tweets的工作中,提出了一种基于社会上下文信息的推荐算法,并使用推荐对象间的内容相似性对目标函数进行约束,但是该方法并没有考虑推荐对象间显示的关联关系,他们的工作更侧重于如何对不同的社会上下文信息进行建模.Liu等人[17]利用推荐对象的属性上下文信息来对它们之间的关联关系进行度量,并通过估计出的关联关系信息来改善推荐的效果.但是他们的工作主要集中在如何从上下文信息中推导出隐式的关联关系信息,并且也没有进一步将所推导出的关联关系同用户间的社会关系融合在一起.3推荐方法在这一部分,我们首先以微博中的Follow关系推荐为例对问题进行说明,然后引入基于概率矩阵分解的方法对评分信息进行建模;接着,我们又以SoRec[11]算法为例,介绍了利用用户间的社会关系信息进行推荐的方法,最后我们在SoRec算法的基础上提出了一种结合推荐对象间关联关系的社会化推荐算法.3.1问题描述我们以微博中的Follow关系推荐场景为例对问题进行说明.在微博中,用户通过与其他用户之间建立Follow关系,来获取其发布的信息,并且这种Follow关系是单向的,不需要得到目标用户的认可.Follow关系推荐就是通过分析用户的社交网络结构和历史评分信息,帮助他们建立合适的Follow关系,这里的评分信息是指用户对推荐结果的历史选择情况.图1展示了在微博中进行Follow关系推荐的场景,从图1中可以看出,这一场景主要包括3个核心要素:(1)用户之间的Follow关系,(2)推荐对象之间的Follow关系,(3)用户对推荐对象的评分信息.图1(a)定义了用户和推荐对象间的Follow关系图=(∪,),其中,分别表示用户和推荐对象的集合;u1,u2∈,(u1,u2)∈表示用户u1Followu2;v1,v2∈,(v1,v2)∈表示对象v1与v2之间存在Follow关系;u∈,v∈,(u,v)∈表示将对象v推荐给用户u;图1(b)定义了用户的评分矩阵犚=犝×犞;其中,u∈,v∈,犚(u,v)=1表示u喜欢v,犚(u,v)=0表示不喜欢;犚(u,v)=?表示没有相应的评分记录.在这样一个二值推荐问题中,我们的目标就是利用所观察到的社交网络和历史评分信息去预测评分矩阵中的缺失项(0或1),从而判断用户最终是否会选择某个推荐对象.3.2基于评分的推荐方法为了能有效地对评分信息进行建模,在论文中我们引入了概率矩阵分解方法[18](ProbabilisticMatrixFactorization,PMF)作为基本的推荐框架.PMF方法通过对用户的评分矩阵进行分解,来推导Page4出两个分别表示用户和推荐对象的低维潜在特征矩阵,而这些特征是刻画用户和推荐对象的关键因素.另外,由于PMF方法在学习过程中只需要使用较低维度的特征向量,使得它的计算复杂度较低,在社会网络这样大规模的数据集上具有较高的可扩展性和准确性.假设用户的评分矩阵犚中有m个用户,n个推荐对象,其中rij∈[0,1]表示用户ui对推荐对象vj的评分.犝∈与用户和推荐对象相关的l-维特征矩阵,其列向量犝i和犞j则分别表示相对应的潜在特征向量.由于PMF假设可观测评分是由概率线性模型犝i犞j和高斯观测噪声组成的,因此评分矩阵犚的条件概率分布可以定义为[19]p(犚|犝,犞,σ2其中,(x|μ,σ2)表示x服从均值为μ,方差为σ2的高斯分布,I犚荐对象vj进行了评分,它的值就等于1,否则为0.函数g(x)表示逻辑函数g(x)=1/(1+exp(-x)),使用它的目的是将预测值(犝T内.假设犝和犞同样服从均值为0的球形高斯先验[20]:经过贝叶斯推断,可以得到犝和犞的联合后验概率分布[18]:p(犝,犞|犚,σ2∝p(犚|犝,犞,σ2如式(3)所示,PMF方法只利用了用户的评分矩阵信息对用户和推荐对象的潜在特征进行估计,而没有考虑到用户间的社会关系以及推荐对象间的关联关系,推荐的准确率还有待进一步提高.在接下来的章节中,我们首先引入了SoRec方法,介绍如何利用用户间的社会关系信息来为目标用户进行推荐.3.3SoRec方法假设用户间的社会关系网络用图=(,)表示,其中={ui}m的社会关系.犇={dij}表示图的社会关系矩阵①(m×m),对于任意一对用户ui和uj来说,如果他们之间存在社会关系,则用dij∈(0,1]表示所对应的有向边ui到uj的权重,否则dij=0.有向边的权重dij代表了在社会网络中ui对uj的信任程度或熟知程度.Ma等人提出的SoRec方法假设社会关系矩阵犇表征了用户在社会网络中的重要交互信息,通过对其进行分解可以学习到表示用户社交行为的低维潜在重要特征.犝∈与用户相关的特征矩阵,列向量犝i和犙k分别表示与它们相对应的潜在特征向量.矩阵犇的条件概率分布定义为p(犇|犝,犙,σ2ik是指示函数,它表示当用户之间存在直接的其中I犇社会关系时,其值取1,否则为0.假设犝,犙服从均值为0的球形高斯先验:为了分析用户间的社会关系是否会影响用户的决策过程,SoRec方法使用共享的用户特征空间将用户间的社会关系与评分信息结合在一起,通过对这两部分信息进行联合分解,识别出在评分上比较相近并且具有社会关系的用户来进行推荐,使用的概率图模型如图2所示.犝,犞和犙的联合后验概率分布可以表示为[9]p(犝,犞,犙|犚,犇,σ2∝p(犚|犝,犞,σ2①这里的社会关系矩阵表示的是图的邻接矩阵.Page5假设推荐对象间的关联关系用图3.4结合推荐对象间关联关系的推荐方法SoRec方法通过对用户间的社会关系矩阵进行分解来学习用户的潜在特征,通过共享的特征空间来约束求解的过程,从而达到使用朋友的兴趣信息进行推荐的目的.但是,这种方法只是从用户的角度出发,而认为推荐对象间是相互独立的,没有考虑到对象间的关联关系同样也是影响用户决策的重要因素.为了研究推荐对象间的关联关系对推荐结果产生的影响以及如何利用这部分信息来进一步提高推荐算法的性能,我们在SoRec方法的基础上提出了一种结合推荐对象间关联关系的社会化推荐方法(ProbabilisticMatrixFactorizationwithUserandItemrelations,PMFUI).表示,其中={vt}n推荐对象间的关联关系.犛={stj}表示图关系矩阵①(n×n),对于任意两个推荐对象vt和vj来说,如果它们之间存在关联关系,则用stj∈(0,1]表示所对应有向边的权重,否则stj=0.权重stj的大小代表了推荐对象vt和vj之间的关联程度.在社会网络中,关联关系的紧密程度可以通过对象间链接关系的网络结构进行刻画[21].例如在朋友推荐中,如果被推荐的朋友之间存在直接相连的链接关系,则表明他们很可能处于一个较为紧密的朋友圈中.在本文中,我们使用较为流行的PropFlow方法[22]对stj的值进行计算.PropFlow方法使用对象间信息流的大小,对它们在网络上的链接关系进行估算,信息流越大,表明对象间的链接关系越紧密.通过对关联关系矩阵犛进行分解,可以学习到表示推荐对象之间关联关系的低维潜在特征矩阵.推荐对象vt和vj在图解它们的特征向量犞t和犞j的重要信息来源②,关联关系矩阵犛的后验概率分布可以定义为p(犛|犞,σ2其中,指示函数I犛接的链接关系,其值为1,否则为0.我们假设犞服从均值为0的球形高斯先验(参见式(2)).为了利用推荐对象间的关联关系对求解的过程进行优化,我们通过共享的潜在特征空间将推荐对象间的关联关系、用户间的社会关系和评分信息结合在一起,通过发现社会网络中相互关联的推荐对象来进一步提高推荐的效果.所使用的概率图模型如图3所示,犝,犞,犙的对数联合后验概率分布可以进一步表示为lnp(犝,犞,犙|犚,犇,犛,σ2-112σ212σ212σ212σ22∑m112(mllnσ2其中,C是不依赖于参数的常量,求参数固定时犝,犞,犙的极大后验概率,相当于最小化以下带正则项的误差平方和函数:1其中,λ犇=σ2λ犙=σ2犚/σ2①②Page6j=1示的目标函数,我们通过在犝,犞和犙上使用梯度下降的方法进行求解,使其达到局部极小值:犝i=∑nEλ犇∑m犞j=∑mEλ犛∑n犙k=λ犇∑mE其中,g(x)=exp(x)/(1+exp(x))2是回归函数g(x)的导数.i=14实验结果与分析在这一部分,我们首先通过几组实验对比了本文的方法与已有方法在推荐效果上的差异,然后进一步分析了PMFUI方法中实验参数和关联关系的计算方法对实验结果的影响.4.1数据集在实验中,我们采用了KDDCUP在2012年发布的数据集①,该数据集记录了腾讯微博在某个时间段内微博用户对某些推荐对象的评分信息(是否会选择某个对象).这些推荐对象既可以是人,也可以是某个社团或组织.其中,推荐对象间的关联关系是指它们在微博中的Follow关系,表示两个推荐对象之间是否相互关注.为了更好地突出问题本身,降低模型的计算复杂度,我们只抽取了该数据集中的评分信息、用户间的社会关系信息和推荐对象间的关联关系信息作为主要的数据来源(原数据集中还包括内容、分类和标签等更加丰富的信息).在新提取的数据集中,共涉及到了50万个用户、6000个推荐对象、21803721条训练数据和100万条测试样例以及287381条用户间的社会关系信息和170080条推荐对象之间的关联关系信息.4.2评价方法我们采用了较为常用的RMSE、MAE、precision、recall、F1-measure和MAP等6种指标[23-24]去评价推荐结果的好坏.RMSE和MAE是评价预测评分准确性的标准,它们反映的是算法的预测评分与用户实际评分的贴近程度.其中,MAE的定义为MAE=1象vj的实际评分,R^ij则表示相应的预测评分,T表示测试样例的数量.与MAE的定义类似,RMSE的公式可以表示为RMSE=1且MAE和RMSE的值越小,表示系统的推荐效果越好.另外一类评价指标,如precision、recall、F1-measure和MAP等是对推荐算法分类准确率进行度量的标准,反映的是推荐系统对分类预测的准确程度,它们特别适合于具有明确二分喜好的用户系统.其中,precision的定义为precision=1Ntp表示推荐列表中用户所喜欢的推荐对象的数量,L表示推荐列表的长度.recall的定义为recall=1T∑uNtp/Bu,其中,Bu表示测试集中用户u所喜欢的推荐对象的数量,它表达的是用户所喜欢的推荐对象能被推荐的概率.这样,可以将F1-measure定义为F1=(2×precision×recall)/(precision+recall),该测度由于同时考虑了precision和recall的值,因此能较为全面地评价算法的优劣.另外一个评价分类准确率的指标是MAP,它的定义为MAP=1荐中用户所喜欢的推荐对象的数量,P(Ljk)表示第j次推荐中推荐列表前k个位置中用户所喜欢的推荐对象的数量与位置k的比值,L是推荐列表的长表,在实验中我们取L=5.4.3结果比较为了验证推荐对象间的关联关系和用户间的社会关系在推荐过程中所起到的作用以及它们对推荐结果产生的影响,在实验中我们比较了PMF、SoRec、PMFUI和两种基于记忆类型的方法Item-①http://www.kddcup2012.org/c/kddcup2012-track1/dataPage7Mean和ItemKNN[25]在未知数据上的推荐效果.在PMFUI中我们首先使用PropFlow作为推荐对象间关联关系的计算方法.实验中的参数设置如下:λ犇=10,λ犝=λ犞=λ犙=0.01,并且在所有的实验中,算法的最大迭代次数设为100.表1给出了在λ犛=5,潜在特征向量的维度分别为10和15的情况下的实验结果.从表1中我们可以看出,在这两种不同的维度下,PMFUI方法在分类准确率和评分误差率指标上都取得了较好的结果(结果要优于SoRec和PMF两种方法).这个结果表明,经常被忽视的推荐对象间的关联关系信息,是推荐过程中的重要因素,它与用户间的社会关系信息一样,能对推荐的最终结果产生重要影响.另外,从表1中我们还可以看出,基于矩阵分解的算法与两种基于记忆类型的算法(ItemMean和ItemKNN)相比,推荐结果在MAE和RMSE等评价指标上都有明显的提高,这也证明了矩阵分解方法的有效性.图4推荐结果随列表长度的变化情况4.4参数的影响在PMFUI方法中,参数λ犛起到了很重要的作用,它控制了推荐对象间的关联关系信息在整个推荐过程中所占的比重,也就是推荐方法对这部分信息的依赖程度.当λ犛=0时,该方法将会只使用用户间的社会关系及评分信息作为推荐的依据;当λ犛→时,该方法仅使用推荐对象间的关联关系信息进行推荐;在其它情况下,该方法则综合使用了评分信息、用户间的社会关系以及推荐对象间的关联关系三部分信息作为推荐的依据.图5给出了λ犛对各个评价指标的影响,我们发方法ItemMean0.08850.29960.13680.21480.55890.5377ItemKNN0.08930.30510.13810.21910.44620.4782PMF0.08970.30670.13880.22060.44550.4700SoRec0.09500.32420.14690.24020.44180.4757PMFUI0.09570.32590.14800.24180.43770.4671方法ItemMean0.08850.29960.13680.21480.55890.5377ItemKNN0.08930.30510.13810.21910.44620.4782PMF0.09030.30840.13970.22290.44560.4701SoRec0.09460.32410.14650.24020.44130.4784PMFUI0.09530.32470.14740.24170.43620.4678图4给出了推荐结果随推荐列表长度的变化情况.从图中可以看出,precision和recall受列表长度的影响较为明显,而F1-measure和MAP所受的影响则相对较小.该图同样表明,PMFUI方法在不同的推荐列表长度下都能取得较好的结果.现λ犛的取值对实验结果有较为显著的影响,随着λ犛取值的不同,推荐的结果也发生了很大的变化.当λ犛从0开始增加时,MAE和RMSE的值逐渐降低(越低越好),但是当λ犛超过某个阈值之后,MAE和RMSE开始逐渐增大.而分类正确率指标precision、recall和F1-measure则首先随着λ犛的增加而增加(越大越好),然后当λ犛达到阈值以后,开始逐渐减小.推荐结果随着参数λ犛的波动情况,也正好反映了推荐对象间的关联关系对推荐过程产生的影响,推荐对象间的关联关系在推荐算法中所占的比重,直接影响了最终推荐的质量.Page8图5参数λ犛对实验结果的影响(维度=10)4.5关联关系计算方法的比较在PMFUI中,关联关系的大小反应了推荐对象间相互关联的紧密程度,它是用户选择推荐对象的重要依据.在本文中,我们进一步比较了PropFlow方法与Katz方法[21]在推荐效果上的差异.另外,为了验证它们对推荐算法的贡献程度,我们还同时比较了关联关系取两种特殊值的情况:(1)关联关系矩阵全为1,它表示将推荐对象间的关联关系都统一对待;(2)关联关系矩阵为[0,1]之间的随机生成数.实验结果如表2所示,其中,PMFUI_1表示推荐对象间的关联关系取值为1,PMFUI_R表示推荐对象间的关联关系为随机值,PMFUI_K和PMFUI_P则表示分别用Katz和PropFlow方法进行计算.其中,PMFUI_P方法在precision、recall、F1-measure和RMSE等指标上都取得了最好的推荐结果,而PMFUI_K方法则在MAP和MAE两种指标上取得了较好的结果.从表2中还可以看出,关联关系在两种特殊取值的情况下都不如使用Katz和Prop-Flow方法计算得到的结果.这也意味着,关联关系的取值直接影响了推荐方法的最终结果,并且我们既不能将它去掉也不能简单地用随机数来代替.表2关联关系计算方法的比较(λ犛=5,犔=5)方法PMFUI_R0.09460.32430.14650.22330.44240.4769PMFUI_10.09520.32440.14720.24060.44410.4760PMFUI_K0.09560.32540.14780.24190.43760.4671PMFUI_P0.09570.32590.14800.24180.43770.46715结论和工作展望本文提出了一种结合推荐对象间关联关系的推荐方法,该方法在推荐过程中考虑了推荐对象的关联关系、用户间的社会关系以及评分矩阵三部分信息,并给出了一种将它们结合在一起的推荐框架.实验结果表明,推荐对象间的关联关系在推荐过程中起到了重要作用,是用户选择推荐结果的重要依据之一.另外,该方法虽然是在社会网络的环境下提出的,但是当上下文信息发生变化时,我们只需要调整关联关系的计算方法,就可以很容易地将其扩展到其它应用场景中.为了突出问题本身,本文只考虑了社会网络的结构性信息,而忽略了用户与推荐对象的其它上下文信息对推荐结果的影响,如用户的位置、发布的tweets和人口统计属性等.在未来的工作中,我们打算研究如何将更多的上下文信息加入到推荐方法中,以便进一步改善推荐的效果.
