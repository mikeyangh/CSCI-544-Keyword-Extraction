Page1一种基于断点处边缘方向保持假设的闭合轮廓提取方法关涛1)周东翔1)刘云辉2)1)(国防科学技术大学电子科学与工程学院长沙410073)2)(香港中文大学机械与自动化工程学系香港)摘要文中提出了一种新颖的闭合轮廓提取方法.分析了当GVFSnake模型处理边缘断裂的图像时,存在无法提取目标原始轮廓信息,尤其是目标边角信息的问题.在GVF外力场演化的能量模型的基础上,基于保持断点处边缘原方向的假设,提出了一种新的具有边角保持特性的能量模型,由此模型得到了边角保持GVF(CP-GVF)外力场.CP-GVF外力场解决了当目标轮廓发生断裂时断点对于GVF外力场的影响问题,能够根据断点处的边缘方向信息,以保持该边缘方向的方式恢复目标轮廓中丢失的边角信息,从而恢复这类目标的原始形状.不同边缘结构的仿真图像和真实图像的实验结果验证了算法的性能.关键词闭合轮廓提取;GVFSnake模型;图像分割;形状恢复1引言闭合轮廓提取[1-2]在图像处理与计算机视觉中有着重要的应用.为了能够定位图像中的感兴趣目标并提取完整清晰的轮廓,相关的算法一般首先对图像进行边缘检测,然后对边缘检测结果进行后处理,剔除掉虚假的边缘,保留目标的轮廓.目前大部Page2分边缘检测算子[3]主要采取微分算子检测图像中灰度剧变的区域作为边缘,但是由于某些图像边缘过于模糊,很难提取完整的边缘信息,所以边缘检测不可避免的会出现边缘断裂的情况.为了提取目标完整的闭合轮廓,关键的一步是进行断裂边缘的连接.虽然对于人类视觉而言,识别断裂的边缘并正确的予以连接很容易,但是由于图像本身、边缘的结构等复杂性,采用计算机自动实现却很难.目前已有很多学者研究了断裂边缘连接的算法,如基于自适应形态学[4]、代价函数最小化[2]、智能布线法[5]等算法.Farag和Delp[6]将断裂边缘连接视为一个搜索图问题,采用顺序搜索的办法实现边缘连接.文献给出了较好的边缘连接结果,但是该算法含有太多的参数,而且这些参数的设置与具体图像有关,算法普适性不好.Sappa和Vintimilla[2]采用基于代价最小化的方法连接断裂的边缘,该算法将图论引入到边缘连接问题中,并得到了较好的实验效果,但是这种基于代价最小化的方法对于代价函数的定义有待改进.当断裂边缘发生在目标轮廓的边角位置时,大部分算法都无法恢复目标轮廓的边角信息,使得轮廓提取的结果与目标原始形状不吻合.近20年在图像处理与计算机视觉领域,变分与偏微分方程方法备受关注[7].1988年由Kass等人[8]提出的Snake模型(也称为主动轮廓模型)是该领域中非常具有影响力的变分模型之一.1998年Xu等人[9]提出GVFSnake模型,采用变分与偏微分方程方法将新的外力场———GVF(GradientVectorFlow,梯度向量流)场引入到Snake模型中,从而解决了传统Snake模型中无法提取边缘凹陷轮廓的问题.到现在为止,围绕着Snake模型已有很多学者提出了改进算法[10-12].Snake模型采用一个逐渐演化的轮廓线来逼近目标的真实轮廓,由于该演化的轮廓线始终保持闭合状态,所以可以用于连接断裂边缘,从而实现闭合轮廓提取.但是,以往提出的主动轮廓模型无法恢复目标边角处丢失的轮廓信息.受到GVFSnake模型[9]的启发,本文将变分与偏微分方程方法引入到断裂边缘连接的问题中,提出一种能量模型———边角保持能量模型用于演化外力场,该能量模型改进了GVF外力场能量模型不能够恢复目标轮廓边角信息的问题.通过最小化这一能量模型,可以得到一个新的外力场———边角保持GVF(CP-GVF)外力场,该外力场将连续边缘处的梯度向量扩散到断裂边缘处,从而将目标的原始轮廓信息恢复,这样便可以进一步采用Snake模型提取出目标的闭合轮廓.在一些图像中,由于目标的边缘模糊导致其轮廓的角点位置出现断裂,但是在轮廓的断裂边缘处保留了一部分有价值的边缘方向信息.本文的闭合轮廓提取算法能够根据目标轮廓断点处的梯度信息,以保持该断点处边缘方向的方式恢复目标丢失的轮廓信息,尤其是目标轮廓中的边角信息,从而恢复这种类型目标的原始形状.通过对仿真图像和真实的边缘模糊图像的实验验证,本文算法相对于GVFSnake算法能够得到更接近目标原始形状的轮廓提取结果.本文第2节介绍GVF外力场的基础知识;第3节详细描述本文算法,提出边角保持能量模型,从而得到边角保持GVF外力场;第4节给出详细的实验结果与讨论;第5节对本文的算法做总结与展望.2GVF外力场简介传统Snake模型[8]的缺点:一是要求初始轮廓设置在目标附近,作用范围小;二是不能处理目标轮廓凹陷的情况.为了解决这些问题,Xu等人[9]提出一种新的外力场———GVF(GradientVectorFlow,梯度向量流)外力场,通过GVF外力场,Snake模型可以解决上述问题.GVF外力场是一种向量场狏(x,y)=[u(x,y),v(x,y)],它是从最小化如下能量泛函而得来:E=∫∫μ狏2+f2狏-f2dxdy(1)其中,f是原始边缘图像的梯度图像,μ是一个加权参数,狏(x,y)就是待求解的GVF外力场.求解上式的Euler方程是:其中,Δ是Laplace算子,fx和fy是f的偏微分.3本文方法本文算法并不关注图像的边缘检测问题,所以边缘检测的实现在这里不进行叙述,算法的输入图像要求是对原始灰度图像进行边缘检测后的图像.这里背景像素点设为黑色(0),边缘像素点设为白色(1).3.1预处理本文算法首先对边缘图像进行形态学细化[13]处理,得到单像素的边缘图像,然后进行断点标注,Page3得到断点图像.这里本文定义断点为只有一个8邻居点的边缘像素点.断点标记的过程为:遍历图像中每一个边缘像素点,如果该边缘像素点只含有一个8邻居点,则将该边缘点标记为断点.这里设原始输入的边缘图像为fo,经过形态学细化后的单像素边缘图像为f,标注的断点图像为fe,如图1所示.该图像为仿真图像,目标的原始形状为三角形,这里我们将三角形的3个顶角去掉,从而模拟目标在边角位置发生边缘断裂的情况.3.2边角保持GVF(CP-GVF)外力场首先分析一下图像中断裂边缘处的原始梯度场和GVF场[9]的特点.根据GVF中的能量模型式(1),在边缘区域,f较大,最小化式(1)主要由第2项主导,即狏=f;而在非边缘区域,f较小,最小化式(1)主要由第1项主导,于是会形成一个缓变的向量场.因此,GVF场相对于原始梯度场是一个扩展的梯度向量场,它将边缘处的梯度向量扩散到了非边缘区域.如图2所示.然而,当原始灰度图像中目标的轮廓过于模糊,使得目标轮廓区域边缘提取的结果发生断裂的时候,断裂边缘处也变成了非边缘区域.因此在断裂边缘区域,GVF场中的梯度向量都流向了断点,如图2(c)所示.那么我们是否能够恢复原始目标轮廓线(边缘)处的梯度向量信息,或者将连续边缘处的梯度向量扩散到断裂边缘处呢?受到这一思想的启发,本文在GVF[9]中的能量模型式(1)的基础上,同时基于保持断点处边缘原方向的假设,提出如下边角保持能量模型:ECP=∫∫μ犞2+其中,W是断点映射图,犞(x,y)=[u(x,y),v(x,y)]是待求解的新的向量场,f是单像素边缘图像f的梯度图像,μ是加权因子,W是断点映射图.本文将新的向量场犞(x,y)称为边角保持GVF(CornerPreservingGVF,CP-GVF)场.该能量函数式(3)的积分式中包含两项,第1项μ犞2反映了向量场犞沿着坐标(x,y)的变化,该项越小犞的变化越小,则整个向量场犞是缓变的;第2项W(x,y)·f2犞-W(x,y)·f2反映了向量场犞与W(x,y)·f的差异度,该项越小,犞与W(x,y)·f越相近.因此整个能量函数的最小化由这两项共同控制.本文后面会根据W(x,y)的构成方式解释能量函数式(3)最小化的过程.这一过程将会使得最终的向量场犞在W(x,y)·f2主导的区域保持了原始梯度场的信息,在其他区域由第1项的控制使得整个向量场是一个缓变的场,原始边缘附近的梯度场被扩散到了图像中的非边缘区域.基于这一特性,断裂区域的向量场信息得以恢复.参数μ是一个加权因子,主要用于控制能量函数式(3)第1项的权重系数,也同时控制第1项和第2项之间对于整个能量函数最小化的影响大小.对于同一类型的图像该参数的取值基本固定.断点映射图W引入到上式中用来抑制f中位于断点附近的梯度向量,我们将在后面详述WPage4的生成方法.根据GVF[9]向量场的推导过程,采用变分方法[14],通过最小化式(3)求解CP-GVF场的Euler方程是:μΔu(x,y)-[u(x,y)-W(x,y)·fx(x,y)]·W(x,y)·f2=0,μΔv(x,y)-[v(x,y)-W(x,y)·fy(x,y)]·W(x,y)·f2=0W(x,y)·f2=[W(x,y)·fx(x,y)]2+[W(x,y)·fy(x,y)]2(5)其中,Δ是Laplace算子,fx和fy是f的偏微分.将u和v看作是随时间变化的函数:上述方程式(4)可以通过最速下降法来求解[15].由于W(x,y)·fx(x,y)和W(x,y)·fy(x,y)都是标量积,上述方程的数值实现方法与GVF模型中的相似,需要将fx(x,y)和fy(x,y)分别与W(x,y)相乘,感兴趣的读者可以参考文献[9].下面我们给出如何计算断点映射图W.对于W的数值实现,这里我们将直角坐标系下的x和y分别由图像阵列中的索引i和j来代替.这样,在像素点(i,j)处W(x,y)=W(i,j).断点映射图W的主要作用是用来抑制断点附近的原始梯度场,这里我们采用形态学膨胀技术,以一种比较巧妙的方法实现W,如下所述:膨胀后的断点图像fex.其中,代表形态学膨胀运算,SEellipse为椭圆型结构元素,SEellipse的设置主要作用是覆盖断点周围(邻域内)的点,如果尺寸选择太小可能导致断点周围的向首先对断点标记图像fe进行形态学膨胀,得到图3图1(b)对应的GVF场与本文方法所得CP-GVF场的对比量不能得到充分的抑制,选择过大会削弱非断点的边缘区域的向量场,从而影响最终的向量场.尺寸选择以削弱断点处的场强为宜,在本文实验中,选取尺寸为2的椭圆型结构元素比较合适.在fex中断点的面积扩大,在每个断点附近形成一个小的连通域.断点映射图W由下式得到其中,λ为抑制因子,W如图1(d)所示.λ的主要作用是反映断点周围向量场的抑制系数,该参数是介于0~1之间的一个权重因子,选择太小可能导致断点周围的向量不能得到充分的抑制,取值大小的选择以削弱断点处的场强为宜,在本文实验中,选取为0.9可以达到抑制的效果.下面我们来分析一下新的能量模型式(3)的特点:W的存在对f进行了重定义,W(x,y)·f只有在连续边缘附近才会比较大.因此,在连续边缘区域,能量模型式(3)由第2项控制,其最小值在犞(x,y)=W(x,y)·f时得到.然而在其他区域(包括断裂边缘区域和非边缘区域),W(x,y)·f较小,最小化式(3)主要由第1项来控制,从而将产生一种缓变的向量场.其最终的效果是:连续边缘区域的梯度向量以保持断点处边缘方向的方式被扩散到了断裂边缘区域,从而断裂边缘区域的边缘信息得到恢复.图3、图4给出了GVF外力场和CP-GVF外力场的对比.在图4(a)中,三角形的顶角边缘断裂,该断裂边缘图像的对应的GVF外力场如图4(b)所示,在GVF外力场中,断裂区域的向量都流向了断点,相比之下,在CP-GVF外力场中断裂边缘区域的向量保留了连续边缘区域向量的走势,断裂边缘的信息得到恢复.另外还可以看出CP-GVF外力场有一个显著特点:三角形的顶角信息也同时得到恢复,如图4(c)所示.Page5图4GVF与CP-GVF外力场4实验结果与讨论本文利用不同类型的断裂边缘图像对我们的算法进行了测试.这些测试图像中目标轮廓的形状包括:圆形、三角形、多边形(带有凹陷的部分).断裂边缘发生在目标轮廓的不同位置(主要在边角位置),这些断裂边缘图像可以用来模拟真实的灰度图像经过边缘提取后的结果.实验的软件编程环境为MatlabR2011,实验中的各个参数设置为μ=0.2,λ=0.9.在实验中为了更好的测试本文算法的性能,图5本文方法与GVFSnake的结果对比我们将本文算法的处理结果与GVFSnake[9]的处理结果进行对比.为了方便论文的打印,这里本文将边缘图像进行反色显示,黑色代表边缘,白色代表背景.如图5第1行所示,对于圆形的断裂边缘,本文算法和GVFSnake都能够很好的提取圆形目标的闭合轮廓.但是,对于三角形的断裂边缘,如图5第2行所示,三角形的3个顶角处的边缘发生断裂,经过GVFSnake提取的目标轮廓,三角形的顶角信息丢失,而本文算法能够很好地提取三角形的轮廓,并且恢复三角形的顶角信息,从而恢复目标的原始形状.Page6在图5第3行中,对于一个复杂的带有凹陷的多边形目标,GVFSnake同样不能够保持目标的原始边角信息,这一多边形目标的原始形状是一个形状规则的“凹”形目标,为了仿真目标形状的边角信息的丢失,图5(a)中去除了它的一些边角,目标的边缘存在很多处断裂.GVFSnake模型将断裂处的边缘直接相连,造成目标形状的边角信息丢失.但是本文算法能够很好地提取该目标的闭合轮廓,尤其是目标原始轮廓中的尖角.本文实验所用的仿真图片和真实边缘模糊图像的尺寸约为128×128像素点,经过对实验图像的测试,图像中断裂边缘处的距离在30个像素点以内能够实现断裂点的有效连接.为了进一步验证本文算法的效果,我们还对真实的边缘模糊图像进行了测试,如图6所示.图中的目标下半部分边角处的边缘非常模糊,经过边缘检测后,此处的边缘信息将丢失,因此采用GVFSnake提取的目标轮廓边角信息丢失.但是在CP-GVF外力场下,丢失的目标边角信息可以得到一定程度的恢复.所以采用本文算法得到的目标轮廓更能够较好地保持边角信息,从而更准确地提取目标原始轮廓(本文并不关注模糊图像的边缘检测算法,所以此处未对边缘检测的方式进行详述).另外,在图6的第3行、第4行图像中,给出了目标的凹陷处存在边缘模糊的情况,这些目标原本都是由一些形状规则的方形盒子叠加在一块而形成.但是由于光照、传感器成像等原因造成图像中目标的一部分边缘过于模糊.例如第3行图像中的目标,其轮廓凹陷处的边缘非常模糊.从图6(b)和(c)的对比可以看出,GVFSnake模型提取的目标轮廓丢失了目标凹陷处的尖角信息,而本文算法的结果更接近目标的真实轮廓.在实际的工程应用中,图像中目标的形状多种多样,由于CP-GVF场是在保持断点处边缘原方向的假设条件下推导出的,所以本文算法适用于这样一类目标的闭合轮廓提取:目标的形状比较规则(例如具有矩形、三角形形状的目标以及二者之间的形状组合的目标),并且在目标轮廓的断裂处保留了一些边缘方向信息,通过这些边缘方向信息可以恢复目标轮廓中丢失的边角信息,从而恢复目标的原始形状.5结论与后续工作方向本文以图像分割中的目标轮廓提取为应用背景,提出了一种新颖的闭合轮廓提取算法,该算法能够根据目标轮廓断点处的边缘方向,恢复其轮廓中丢失的边角信息,从而提取这类目标的原始形状.在GVFSnake模型的基础上,基于保持断点处边缘原方向的假设,本文提出了一种改进的能量模型———边角保持能量模型.通过最小化该能量模型可以得到一个新的外力场,该外力场解决了当目标轮廓发生断裂时,断点对于GVF外力场的影响问题,从而使目标轮廓的边角信息得到恢复.不同类型图像的实验结果验证了算法的性能.我们未来的工作将进一步改进断点映射图的生成方法,以及引入新的依赖于原始灰度图像的因子到能量模型式(3)中,从而进一步提高算法的实用性.致谢Xu和Prince等学者[9]提供了GVFSnake模型公开演示程序,本文测试用的边缘模糊图像来自VisionLabattheUniversityofSouthFlorida,在此表示感谢!
