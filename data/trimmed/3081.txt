Page1演化多目标优化中的几何热力学选择应伟勤1),2)李元香1)SHEUPhillipC-Y1),2)吴昱1)余法红1)1)(武汉大学软件工程国家重点实验室武汉430072)2)(加州大学尔湾分校电气工程和计算机科学系加利福利亚92697美国)摘要热力学遗传算法(ThermodynamicalGeneticAlgorithms,TDGAs)借鉴热力学中的自由能极小过程来统一处理多目标优化在逼近性和多样性两方面的任务.为提高TDGA的运行效率和解集分布均匀性,提出了一种几何热力学选择.在该选择中首先定义角度熵通过扇形采样来度量种群逼近方向的多样性.然后利用距离精英定义距离能量来度量种群的逼近程度,避免了耗时的非劣分层操作.此外,引入分量热力学替换规则以较低计算代价驱动种群的几何自由能快速下降.在多目标0/1背包问题上的实验结果表明,几何热力学选择极大地提高了TDGA的运行效率和解集分布均匀性;采用该选择的TDGA算法可生成与NSGA-II在逼近性和分布多样性上性能相当的解,但在运行效率上明显优于NSGA-II.关键词多目标优化;演化算法;热力学替换;角度熵;距离能量1引言现实世界中的许多优化问题都是多属性的,通常需要对多个目标同时优化.一般来说,多目标优化问题(Multi-ObjectiveOptimizationProblems,MOPs)中各目标之间通过决策变量相互制约,对其中一个目标优化必须以其它目标作为代价,因而总体目标没有单个最优解.这使得一次能得到一组最优解的算法比那些一次只得到一个最优解的算法更具优势.基于群体搜索的演化算法可并行搜索多个目标,因此非常适合求解多目标优化问题[1-2].VanVeldhuizen等[3]从决策者的角度将多目标演化算法(Multi-ObjectiveEvolutionaryAlgorithms,MOEAs)分为3大类:先验法、渐进法和后验法.先验法在搜索之前就需要决策者输入决策信息将多个目标合成为数量成本函数,然后通过MOEA产生成本函数的最优解提供给决策者.渐进法中决策者与MOEA搜索过程不断交互,前者为后者提供目标的优先关系,而后者为前者提供新解以产生更好的目标间优先关系.后验法则通过运行MOEA产生一组Pareto最优候选解供决策者选择.该方法使得决策者不必要事先作出各目标之间优先和偏好的决定,将决策过程从“事前”移到“事后”,这样决策者有了对各目标之间关系的总体轮廓后更容易决策[4].目前基于Pareto占优的后验法最为活跃,大多数MOEA采用这种方法.这些算法使用Pareto占优指导搜索,在进化过程中,通过Pareto非劣分层或Pareto占优计数进行适应值指派,使当前进化群体的Pareto非劣解集不断逼近真实Pareto最优解集.另外,演化算法种群大小有限,而Pareto最优解的数量庞大甚至无限,因而MOEA算法需用较少的解来代表无限多个解,从而便于决策者进行决策.因此决策者对MOEA所求非劣解集存在两方面的需求[5]:(1)逼近性.即解集尽量逼近Pareto最优前沿;(2)多样性.即解集在最优前沿上分布均匀且覆盖宽广,从而能较好地代表整个Pareto最优前沿.为达到这两个要求出现了很多种MOEA算法[2],例如Fonseca和Fleming提出的MOGA(Multi-ObjectiveGeneticAlgorithm)[6]、Deb提出的NSGA(Non-dominatedSortingGeneticAlgo-rithm)[7]和NSGA-II[5]、Zitzler和Thiele提出的SPEA(StrengthParetoEvolutionaryAlgorithm)[8]等.为逼近前沿,这些算法均通过基于Pareto占优的适应值指派方法来指导种群向最优前沿搜索.MOGA按Pareto占优计数结果为种群中每个个体分配一个等级(rank)值[6],个体的rank值等于1加上种群中占优它的个体数.NSGA和NSGA-II则首先进行非劣分层将种群划分成不同的层级,没有被任何个体占优的个体属于第0级,将该批个体清除出去后,再没有被任何个体占优的个体属于第1级,依次类推[5,7].分层之后越低层级中的个体分配更好的适应值,使种群以层的形式向Pareto最优域推进.SPEA中进化种群和精英种群的每一个体都依据Pareto占优计数结果被指派一个强度值,该值包含了占优和密度信息[8].这些方法的优点是通用性较好,其不足是计算效率不高,因为这些算法在每代进化中都要进行非劣分层或占优计数操作,两者的时间复杂度均不低于O(mn2为种群规模.此外,由于演化算法具有随机性,SPEA和NSGA-II分别采用了显式和隐式精英保留策略,保证进化过程中已发现的“好”解不至于丢失.大量实验表明精英保留策略有助于提高MOEA的收敛速度.为保持分布多样性,这些算法采用了各种不同的策略.MOGA引入基于共享函数的小生境(niching)技术来提高非劣解集的多样性[6],首先指定一个niche半径δshare,目标向量之间的距离小于δshare的解将共享适应值.NSGA对每个非劣层也采用适应度共享机制,但其适应度共享方式不同于MOGA,前者是在决策向量空间共享适应度,而后者是在目标向量空间共享适应度[7].共享函数法的缺点是计算开销较高,且进化结果对niche半径δshare的选取很敏感.NSGA-II采用一种新颖的密度估计和拥挤比较方法来取代共享函数方法[5],先对同一层级的个体计算拥挤距离,然后将层级中个体按拥挤距离降序排序.该方法能有效保持非劣解集的多样性,不需要额外的参数,并且比共享函数法有更低的时间复杂度.SPEA则应用聚类方法压缩精英种群[8]来保持非劣解集的分布多样性.而Kita等[9]从热力学的自由能极小定律得到启发,在多目标优化中引入能量、熵和温度的概念,设计出一种求解多目标优化问题的热力学遗传算法(ThermodynamicalGeneticAlgorithm,TDGA).TDGA最初由Mori在求解单目标优化问题时提出[10],它通过模拟热力学中能量和熵的竞争模式来定量协调演化优化中提高“选择压力”和保持“种群多样性”之间的冲突.热力学系统在恒温下的任何Page3状态改变都遵循自由能极小定律[11]:对于与外界交换热量而温度保持不变的热力学封闭系统,系统状态的自发变化总是朝着自由能减少的方向进行,当自由能达到极小值时系统达到平衡态.热力学中,系统的自由能F=E-HT,其中E是系统的能量,H是系统的热力学熵.能量减少和熵增加均有利于减少自由能,因此系统的任何状态改变都可被视为E和H竞争的结果,温度T决定着两者的相对权重.在热力学系统和演化多目标优化之间存在着诸多相似性.例如,种群可视为热力学系统,个体对应粒子,种群的平均逼近性、种群多样性和一个权重控制参数T则分别可担当热力学中能量、熵和温度的角色.Kita等[9]正是在这些相似性基础上,将TDGA算法引入到多目标优化领域,通过模拟热力学中能量与熵之间的竞争模式统一处理多目标优化在逼近性和多样性两方面的需求.TDGA在多目标优化时解集保持了良好的分布宽广性.但是TDGA当前仍存在一些明显的不足.首先,TDGA采用基因熵度量种群在基因空间中的多样性[9],这使得解集在目标空间的分布均匀性得不到保证.其次,TDGA使用贪婪热力学替换规则驱动种群自由能快速下降[9],该规则具有较高的时间复杂度,这导致TDGA的计算成本很高[12].再次,TDGA采用层级能量度量种群的逼近性[9],而计算层级能量时需要对种群进行耗时的非劣分层操作,这进一步降低了TDGA的运行效率.本文提出了一种几何热力学选择以改进多目标优化中TDGA的运行效率和解集分布均匀性.该选择充分利用多目标优化中的角度和距离等几何量定义了角度熵和距离能量.其中角度熵通过在目标空间中扇形采样来度量种群逼近方向的多样性,提高了解集的分布均匀性;距离能量运用几何元素间接度量了种群的逼近程度,巧妙地避免了耗时的非劣分层操作.此外,该选择引入几何分量热力学替换规则,以较低时间复杂度驱动种群几何自由能近似最速下降,有效降低了替换规则的计算成本.在多目标0/1背包问题上的实验结果表明,几何热力学选择在保持TDGA良好的覆盖宽广性的同时,极大地提高了TDGA的运行效率和解集分布均匀性.运用该选择的几何热力学遗传算法(GeometricThermo-dynamicalGeneticAlgorithm,GTGA)可生成与NSGA-II在收敛性和分布性上相当的解,但在运行效率上明显优于NSGA-II.2多目标优化中的角度和距离为表述方便首先给出Pareto占优的相关概念.定义1(多目标优化问题).一个通用的多目标优化问题(MOP)可描述为将n维决策变量映射到m个目标的向量函数犉:X→Y:min./max.狔=犉(狓)=(f1(狓),f2(狓),…,fm(狓))subjectto狓=(x1,x2,…,xn)∈X这里狓被称为决策向量,X称为决策空间,狔称为目标向量,Y称为目标空间.多目标优化问题中每一个目标函数fi分别带有一个优化类型,优化类型可以为最小化min或最大化max.定义2(规范目标).多目标优化问题犉(狓)的规范目标为狕=犌(狓)=(g1(狓),g2(狓),…,gm(狓))∈m,狓∈X,在fi的优化类型为最大化时gi(狓)=Z-fi(狓),在fi的优化类型为最小化时gi(狓)=fi(狓),i=1,2,…,m.这里Z称为规范目标空间.规范目标的优化类型全部为最小化.为表述方便,下文目标空间若无说明均指规范目标空间.称狕1Pareto占优狕2(记为狕1狕2)当且仅当(i∈1..m:z1决策向量狓1∈X和狓2∈X,称狓1Pareto占优狓2(记为狓1狓2)当且仅当犌(狓1)犌(狓2).定义4(Pareto非劣解).设SX,犪∈S,若﹁狓∈S:狓犪,则称犪为S的Pareto非劣解;若犪为X的非劣解,则犪简称为Pareto非劣解或Pareto最优解.我们在多目标优化中引入角度和距离这两个几何元素来描述解的性质.进一步的分析可揭示这两个几何量与Pareto占优具有紧密联系,这为在演化多目标优化中利用几何元素度量种群自由能提供了理论依据.定义3(Pareto占优).设狕1∈定义5(解集的基点).设SX,犫=(b1,iz2b2,…,bm)∈m,则称犫为S的一个基点.定义6(解到基点的距离).设狓∈SX,犫为S的一个基点,则称d(狓,犫)=∑m狓到基点犫的距离.S且狓∈S:d(狓,犫)d(狓,犫),则狓必为S的定理1.设SX,犫∈Page4i=1Pareto非劣解.证明.用反证法.假设狓不是S的Pareto非劣解,根据定义4,必狓∈S:狓狓.再根据定义3可得i∈1..m:gi(狓)gi(狓)∧i∈1..m:gi(狓)<gi(狓)(i∈1..m:gi(狓)-bigi(狓)-bi)∧(i∈1..m:gi(狓)-bi<gi(狓)-bi)(2)由于犫是S的基点且狓∈S,由定义5可知结合式(2)和式(3)可得(i∈1..m:(gi(狓)-bi)2(gi(狓)-bi)2)∧(i∈1..m:(gi(狓)-bi)2>(gi(狓)-bi)2)(gi(狓)-bi)槡2>∑m∑md(狓,犫)>d(狓,犫)式(4)与定理中条件狓∈S:d(狓,犫)d(狓,犫)矛盾,故假设不成立,定理得证.定理1告诉我们集合S中到基点距离最大的解一定是S的一个Pareto非劣解,这表明几何中的距离度量与多目标中的Pareto占优存在某种程度的关联.但事实也清晰地表明定理1的逆命题并不成立,即并不是S的任一个Pareto非劣解与基点的距离最大,甚至S中的Pareto被占优解可以比S的某些Pareto非劣解到基点的距离更大,这可以很容易举例说明.为了更清晰地揭示距离度量与Pareto占优的关系,需要给距离度量添加方向限定条件.定义7(角度).设SX,犫∈点,则称θ(狓,犫)=(θ1(狓,犫),θ2(狓,犫),…,θm-1(狓,犫))为狓∈S在基点犫上的角度,这里θj(狓,犫)=arctangj+1(狓)-bj+1θj的几何意义是个目标与第1个目标张成的坐标平面上的投影与第1维坐标轴负方向的夹角.这m-1个夹角共同确定了是只有两个目标,此时角度是一个标量.角度和距离描述了解的很多有用信息.在已知基点的情况下,这两个几何量可共同确定目标空间的一个解,其中角度描述了解向前沿逼近的方向,距离描述了解逼近前沿的程度.根据基点和角度的定义容易得出以下推论.推论1.设犫为S的一个基点,那么狓∈S:tan(θj(狓,犫))>0,0<θj(狓,犫)<π/2,j=1,2,…,m-1.定义8(距离占优).设SX,犫∈基点,若狓1∈S,狓2∈S,d(狓1,犫)>d(狓2,犫),则称狓1关于基点犫距离占优狓2,记为狓1犫狓2.定理2.设SX,犫∈S,狓2∈S,θ(狓1,犫)=θ(狓2,犫),那么狓1狓2的充要条件是狓1犫狓2.证明.设θ(狓1,犫)=θ(狓2,犫)=(θ1,θ2,…,θm-1),θ0=π/4,则根据定义7可知i=1先证充分性.由定义8、式(6)和推论1可得狓1犫狓2(gi(狓1)-bi)槡2>∑m∑m(g1(狓1)-b1)2∑m(g1(狓2)-b1)2∑m(g1(狓1)-b1)2>(g1(狓2)-b1)2g1(狓1)-b1<g1(狓2)-b1tan(θi-1)(g1(狓1)-b1)<tan(θi-1)(g1(狓2)-b1),i=1,2,…,mgi(狓1)-bi<gi(狓2)-bi,i=1,2,…,mgi(狓1)<gi(狓2),i=1,2,…,m狓1狓2再证必要性.由定义5和定义6可得狓1狓2(i∈1..m:gi(狓1)-bigi(狓2)-bi<0)∧(i∈1..m:gi(狓1)-bi<gi(狓2)-bi<0)(i∈1..m:(gi(狓1)-bi)2(gi(狓2)-bi)2)∧(i∈1..m:(gi(狓1)-bi)2>(gi(狓2)-bi)2)(gi(狓1)-bi)槡2>∑m∑m狓1犫狓2定理得证.定理2说明距离占优并不在所有情况下有实际意义,但是在角度相等时,距离占优总是有效的,此时距离占优等价于Pareto占优.这为本文下一步创造条件利用距离占优代替Pareto占优避免耗时的非劣分层操作提供了依据.i=1Page53利用几何元素度量自由能在演化多目标优化中引入热力学中能量与熵的竞争机制时首先要解决两个基本问题:(1)如何定义能度量种群多样性的熵;(2)如何定义能度量种群逼近性的能量.为改进TDGA的计算成本及解集分布均匀性,本文利用多目标优化中的角度和距离从几何观点重新定义了种群的自由能.3.1扇形采样与种群的角度熵TDGA沿用了在单目标优化中提出的基因熵,基因熵等于种群在每一基因位上基因的信息熵的合计值[9].由于基因熵是在基因空间定义的,因而多目标优化时难以保证非劣解在目标空间中的均匀分布.本文直接在目标空间中定义种群的熵.在目标空间中保持非劣解均匀和宽广分布的目的是通过有限的解来代表大量甚至无穷多个最优解,使决策者能获得各目标之间关系的总体轮廓从而方便决策.从几何的观点来看,这实际上是在目标空间对真实Pareto前沿进行空间采样的问题.Knowles[13-14]在PAES算法中提出了对目标空间进行网格采样的方法,该方法通过均匀划分每一目标的取值范围得到矩形网格.Ding[15]曾把网格采样方法应用到TDGA中.Zheng[4,16]提出了对目标空间进行扇形采样的方法,该方法具有比网格采样更低的时间和空间成本,而且有利于进一步利用几何量度量个体能量,因此本文采用扇形采样方式.首先利用角度定义扇形区域.定义9(上界和下界).设Pt=(狓t,0,狓t,1,…,狓t,nP-1)为算法在第t(t0)代的种群,Ot=(狓t,nP,狓t,nP+1,…,狓t,nP+nO-1)为算法在第t(t0)代的子种群,则称狌(t)=(u(t)2,…,l(t)l(t)i=max(u(t-1)u(t)i=max{gi(狓)|狓∈P0},u(0)i=min(l(t-1)l(t)i=min{gi(狓)|狓∈P0},i=1,2,…,m(9)l(0)定义10(第t代基点).算法第t代基点犫(t)=(b(t)1,b(t)2,…,b(t)(1)t=0时,b(0)2,…,m;(2)t>0时,若u(t)40(u(t)i-l(t)2,…,m.定义11(扇形区域).设第t代基点为犫(t)∈m,那么在区域D(t)={狕∈m}中通过将每个角度分量的取值范围(0,π/2)划分K等份可得到Km-1个扇形区域s(t)狏={狕∈D(t)|vjπ/(2K)θj(狕,犫(t))<s(t)其中整数常量K为每个角度分量上的等份数,狏=(v1,v2,…,vm-1)为扇形区域s(t)狏中所有个体的第j个角度分量都位于第vj个等s(t)份中,vj∈0..K-1,j=1,2,…,m-1.称s(t)点犫(t)下坐标为狏的扇形区域.对于任意个体狓∈Pt,若犌(狓)∈s(t)定义12(角度熵).设第t代种群为Pt∈XnP,第t代基点为犫(t)∈Pt在基点犫(t)上的角度熵,这里H(犫(t),Pt)=-∑(K-1,K-1,…,K-1)其中n狏为种群Pt中位于扇形s(t)种群Pt的个体总数.上界和下界记录了到第t代为止搜索过程已达个体的范围,它们将随搜索过程的进行不断地扩张.其中上界被任意已达个体占优,下界占优任何已达个体.第t代基点设为被当前所有已达个体强占优并且距离已达个体比较遥远的点,这使得基点位置变化的概率非常小,并且从基点出发对非劣前沿的采样将更加均匀.已达个体在当前基点上的每个角度分量θj∈(0,π/2),j=1,2,…,m-1.通过将每个角度分量的取值范围(0,π/2)划分K个等份,可最终将强占优基点的区域划分成Km-1个扇形,二目标时的扇形划分情形如图1所示.网格划分法将产生Km个矩形,二目标时的网格划分情形如图2所示,这明显比扇形划分法占用更多的存储空间和采样时间.根据定义11可知个体狓∈Pt所在扇形的坐标为狏=(v1,v2,…,vm-1),vj=floor(2Kθj(狓,犫(t))/π),j=1,2,…,m-1,这里floor(·)表示下取整函数.角度熵H(犫(t),Pt)度量了种群逼近方向的分散程度.可以证明当Pt中所有个体全部位于同一扇形时角度熵H(犫(t),Pt)取最小值0,当每一扇形中均有个体出现并且数量相等即n(0,0,…,0)=n(1,0,…,0)=…=n(K-1,K-1,…,K-1)时H(犫(t),Pt)达到最大值(m-1)logK.Page63.2距离精英与种群的距离能量TDGA当前采用层级能量度量逼近性,个体的层级能量等于该个体所在层级的编号[9],种群的能量等于个体能量的均值,层级能量越低逼近程度越高.显然计算层级能量时需要首先对种群进行耗时的非劣分层操作,这对TDGA的运行效率有较大影响.由定理2可知角度相等时距离占优可代替Pareto占优,当扇形划分中K较大时每个扇形的夹角很小,同一扇形中个体角度非常相近,此时可用距离来近似度量同一个扇形中个体的逼近程度,避免耗时的非劣分层操作.为使不同扇形中的距离具可比性,还需建立距离精英文档来保存每个扇形中的距离精英.定义13(距离精英文档).距离精英文档At是一个长度为Km-1的决策向量数组,它保存至第t代每个扇形中的距离最好解,其中坐标为狏=(v1,v2,…,vm-1)的扇形区域s(t)At[index],这里index=v1+v2×K+…+vm-1×Km-2称为扇形区域s(t)At由以下3种操作得到At-1,Ot-1);(1)t=0时,A0=initialize(犫(0),P0);(2)若t>0且犫(t)=犫(t-1),则At=update(犫(t),(3)若t>0且犫(t)≠犫(t-1),则At=reset(犫(t),At-1,Pt-1,Ot-1).其中initialize(),update()和reset()3个操作分别初始化文档,根据子个体更新文档,在基点改变时重置文档.这3个操作都需要调用insert(A,犫,狓)函数,函数insert(A,犫,狓)比较当前个体狓和狓所在扇形的距离精英A[index]到基点犫的距离,若狓距离占优A[index],则替换距离精英A[index]为狓.这4个函数可描述如下.算法1.文档初始化A0=initialize(犫(0),P0).1.for(index=0;index<Km-1;index++)2.for(i=0;i<nP;i++)A0=insert(A0,犫(0),P0[i]).算法2.文档更新At=update(犫(t),At-1,Ot-1).1.At=At-1;2.for(i=0;i<nO;i++)At=insert(At,犫(t),Ot-1[i]).算法3.文档重置At=reset(犫(t),At-1,Pt-1,Ot-1).1.for(index=0;index<Km-1;index++)2.for(index=0;index<Km-1;index++)3.if(At-1[index]!=NULL)4.for(i=0;i<nP;i++)At=insert(At,犫(t),Pt-1[i]);5.for(i=0;i<nO;i++)At=insert(At,犫(t),Ot-1[i]).算法4.添加个体到文档A=insert(A,犫,狓).1.index=0;//计算个体x所在扇形的坐标及文档索引2.for(j=1;j<=m-1;j++){3.aj=arctan((gj+1(狓)-bj+1)/(g1(狓)-b1));4.cj=floor(2Kaj/π);//狓所在扇形的坐标分量cj5.index+=cjKj-1;}//狓所在扇形的的文档索引6.if((A[index]==NULL)or7.A[index]=狓.定义14(距离能量).设犫(t)∈点,狓∈Pt,那么称e(犫(t),At,狓)为个体狓在基点犫(t)下的距离能量,E(犫(t),At,Pt)为种群Pt在基点犫(t)Page7下的距离能量,这里e(犫(t),At,x)=d(At[index],犫(t))-d(狓,犫(t))(12)E(犫(t),At,Pt)=1其中index=v1+v2×K+…+vm-1×Km-2为狓所在扇形的文档索引,狏=(v1,v2,…,vm-1)为狓所在扇形的坐标,nP为种群Pt的个体总数.给定一个一般的解集S,S中任意两个体Pareto占优比较可出现4种结果:相等、占优、被占优、不可比较,所以Pareto占优一般并不是S上的全序关系,存在两个个体互不占优不可比较的情况.若同一个扇形中个体的角度都相同,则扇形成为一条射线,根据定理2该扇形中距离比较可代替Pareto比较,因而Pareto比较只可能有相等、占优、被占优3种结果.此时Pareto占优关系是该扇形上的一个严格全序关系,任意两个个体都是可比较的,在每个扇形中存在一个Pareto最好解,即到基点距离最大的距离精英,故可以选取该解代表这个扇形中的所有解.个体的距离能量等于个体所在扇形的距离精英到基点的距离与该个体到基点的距离之差.那么距离能量小的个体到基点的距离更大,根据定理2距离大的个体肯定Pareto占优距离小的个体,所以距离能量小的个体更加逼近Pareto最优前沿.当K值较大时同一扇形中个体角度非常相近,上述扇形中个体的角度相同的假设可近似成立,因而个体的距离能量可近似度量个体的逼近程度.这里精英文档实际上扮演了两方面的角色.首先为每个扇形的距离度量设立了一个标尺,每个扇形中的精英个体距离能量最小且为0,不同扇形中个体比较时越靠近本扇形精英的个体距离能量越小.其次精英文档记录了至第t代每个扇形中的距离最好解,可实现精英保留策略.根据定理1,无论每个扇形的角度范围有多大,其距离精英个体一定是该扇形中个体的Pareto非劣解,这使得利用几何量也可以间接构造出Pareto非劣前沿.度量层级能量的主要操作在非劣分层,需要个体两两间做Pareto占优比较,时间复杂度为O(m(nP+nO)2).度量距离能量的主要操作为距离比较,其中每个个体只需与其所在扇形中的距离精英比较,其复杂度为O(m(nP+nO)),明显低于层级能量的复杂度.3.3种群的几何自由能上面已经揭示了目标空间中角度、距离这两个几何元素与Pareto占优之间的联系,并充分利用角度、距离定义了种群的角度熵和距离能量.现在可根据角度熵和距离能量从几何的观点定义种群的自由能.种群的几何自由能将多目标优化中的逼近性和多样性在温度T下统一起来.定义15(几何自由能).设犫(t)∈基点,Pt∈XnP是第t代种群,那么称F(犫(t),At,T,Pt)为种群Pt在基点犫(t)和温度T下的几何自由能,这里F(犫(t),At,T,Pt)=E(犫(t),At,Pt)-TH(犫(t),Pt)4几何分量热力学替换规则热力学替换规则的设计是在演化多目标优化中引入能量和熵竞争机制的另一个关键问题.热力学替换规则的任务是从父代种群Pt=(狓t,0,狓t,1,…,狓t,nP-1)的nP个个体及其子种群Ot=(狓t,nP,狓t,nP+1,…,狓t,nP+nO-1)的nO个个体中挑选出nP个个体组成下一代种群P(E)F(犫(t+1),At+1,T,P(E)确地最小化每一代的自由能本身是一个颇难的组合优化问题,基于角度熵和距离能量的穷举替换规则复杂度高达O(Km-1CnPnP+nO),实际中是不可行的.为降低替换规则的复杂度,TDGA当前采用贪婪热力学替换(GreedyThermodynamicalReplacement,GTR)规则[9],按贪婪策略逐个往下一代种群中填充个体.GTR规则的计算开销较穷举规则有很大程度降低,基于角度熵和距离能量的GTR规则的复杂度为O(m(nP+nO)+Km-1nP(nP+nO)),但GTR规则在实际应用中计算成本仍相当高,不具实用性.在单目标优化中我们提出了一种基于等级熵和相对能量的分量热力学替换规则CTR[17-18],通过自由能分量的概念将种群的自由能分派到其各个体上,极大地简化了热力学替换规则的设计.本文进一步将分量替换的思想引入到多目标优化中以降低替换规则的复杂度.首先定义多目标优化中的几何自由能分量.定义16(几何自由能分量).设Pt为第t代种群,犫(t)为第t代基点,狓∈Pt,那么称Fc(犫(t),At,T,Pt,狓)为在基点犫(t)、文档At和温度T下个体狓在种群Pt中的几何自由能分量,这里Fc(犫(t),At,T,Pt,狓)=e(犫(t),At,狓)+Tlog(n狏/nP)Page8其中狏=(v1,v2,…,vm-1)为狓所在扇形的坐标,vj=floor(2Kθj(狓,犫(t))/π),j=1,2,…,m-1,n狏为种群Pt中位于坐标为狏的扇形中的个体数,nP为种群Pt的个体总数.几何分量热力学替换规则通过计算个体在中间种群Pt+1中的几何自由能分量可间接达到近似最小化下一代种群几何自由能的目的,这样极大地减小了替换规则的计算开销.如算法5所示,几何CTR规则主要有3个步骤.算法5.几何分量热力学替换规则Pt+1=CTR(犫(t+1),At+1,T,Pt,Ot).1.合并父种群Pt和子种群Ot得到中间种群Pt+1;2.计算中间种群Pt+1中所有个体的几何自由能分量Fc(犫(t+1),At+1,T,Pt+1,狓),狓∈Pt+1;Pt+1中删除这nO个个体即可得到下一代种群Pt+1.3.在Pt+1中挑选出nO个自由能分量最大的个体,从几何CTR规则中计算自由能分量的复杂度为O(m(nP+nO)),挑选淘汰个体的复杂度为O(nO(nP+nO)),故几何CTR规则的复杂度为O((m+nO)(nP+nO)),明显降低了GTR规则的计算成本.与单目标优化中类似,我们亦可证明多目标优化中的几何CTR规则具有驱动种群的几何自由能近似最速下降的能力.定理3.对于父代种群Pt和子种群Ot,设P(E)为几何自由能最小的下一代种群,P(C)CTR规则生成的下一代种群,即P(C)At+1,T,Pt,Ot),y=nO/(nP+nO),D(犫(t+1),At+1,T,Pt,Ot)=F(犫(t+1),At+1,T,P(C)At+1,T,P(E)运用极限夹逼准则可证明定理3,这里省略了定理3的证明,其证明过程可参考文献[18].定理3告诉我们,当nOnP时,几何CTR规则具有驱动种群几何自由能至少以接近最快的进化速度下降的能力.定理3保证了多目标优化中几何CTR规则的有效性.5几何热力学遗传算法上述几何CTR规则亦称为基于角度熵和距离能量的CTR规则.角度熵、距离能量、冷却进度表和分量热力学替换规则这4个要素一起构成了几何热力学选择,它驱使种群快速向几何自由能减少的方向演化,从而营造出热力学中能量和熵的竞争模式.本文称采用几何热力学选择的热力学遗传算法为几何热力学遗传算法GTGA.算法6给出了GTGA的一般流程.算法6.几何热力学遗传算法GTGA.1.随机生成nP个个体组成初始种群P0,并评估P0中个体;2.按定义10中规则(1)生成第0代基点犫(0);3.A0=initialize(犫(0),P0);4.T0=10;t=0;5.while(terminate(Pt,t)==False){6.从Pt∪At通过均匀选择、交叉、变异生成nO个子个体;7.将这nO个个体组织成子种群Ot,并评估Ot中个体;8.按定义10中规则(2)生成第t+1代基点犫(t+1);9.if(犫(t+1)==犫(t))At+1=update(犫(t+1),At,Ot);10.elseAt+1=reset(犫(t+1),At,Pt,Ot);11.Pt+1=CTR(犫(t+1),At+1,Tt,Pt,Ot);12.t=t+1;13.Tt=T0/(1+t);}14.对At进行非劣分层,输出At中的Pareto非劣解集.上述GTGA算法中初始温度T0和温度衰减函数Tt=T0/(1+t)共同构成了冷却进度表.GTGA在进化迭代结束后得到的精英文档是各扇形区域的非劣解的集合.整个目标空间的非劣解肯定是其所在扇形的一个非劣解,但扇形的非劣解不一定是整个目标空间的非劣解.例如,位于两端的扇形非劣解可能被其它解占优,如图3所示.因此算法结束时需要调用Pareto非劣分层操作对扇形非劣解的集合进行后处理,将被占优的扇形非劣解清除出去即可得到最终的Pareto非劣前沿.GTGA在一次迭代中文档更新操作update()Page9的复杂度为O(nOm);由于种群的基点设为距已达个体比较遥远的点,这使得GTGA中基点发生改变需要调用重置文档操作reset()的概率非常小,可忽略不计;几何CTR规则的复杂度为O((m+nO)(nP+nO)).故在nOnP时GTGA算法一次迭代的复杂度约为O((m+nO)nP),因此GTGA算法的总复杂度约为O(Ne/nO(m+nO)nP)=O(Ne(m+nO)(nP/nO)),其中Ne为允许的最大评估次数.而TDGA当前采用的基于基因熵和层级能量的GTR规则在nOnP时一次迭代的复杂度约为O((m+n)n2TDGA算法的总复杂度约为O(Ne/nO(m+n)n2O(Ne(mnP+nnP)(nP/nO)).为分别对比分析替换规则、熵度量方法和能量度量方法对算法运行效率的影响,我们先将TDGA中GTR规则替换为CTR规则可得到算法TDGA2.TDGA2采用基于基因熵和层级能量的CTR规则,依上面方法分析可知TDGA2算法的复杂度约为O(Ne(mnP+n)(nP/nO)).进一步将TDGA2中基因熵度量方法替换为角度熵度量方法可得到算法TDGA3.TDGA3采用基于角度熵和层级能量的CTR规则,同样可分析得到TDGA3算法的复杂度约为O(Ne(mnP)(nP/nO)).以上分析表明分量替换规则、角度熵和距离能量均改进了TDGA的运行效率,其中分量替换规则和距离能量的效果尤为明显.6实验与分析为了检验上述几何热力学选择方法的性能,本文以C++实现了相关多目标演化算法,并在多目标0/1背包问题上对这些算法进行了一系列对比实验.所有实验均在Intel(R)Core(TM)2DuoCPUT9300/2GB内存的计算机上进行.6.1性能度量衡量多目标演化算法的性能通常需要考虑3方面的因素:(1)逼近性.所求非劣解集逼近Pareto最优前沿的程度;(2)多样性.所求非劣解集的分散程度,这又包括均匀性和宽广性,其中均匀性表示解集分布的均匀程度,宽广性表示解集覆盖最优前沿的完整程度;(3)计算成本.本文使用C和Δ两个评价标准来比较各算法所求二目标问题非劣解集的优劣.其中C(S,S)用于比较两个解集逼近前沿的程度[8,19],这里C(S,S)=|{a∈S|a∈S:aa}|C(S,S)表示了S被S占优的比率.若C(S,S)>C(S,S),则可认为解集S逼近最优前沿的程度要优于解集S.Δ(S)度量了二目标问题非劣解集S的分散程度[20].设二目标问题边界点为犈1和犈2,将边界点加入到非劣前沿犉(S)中可得到Q=犉(S)∪{犈1,犈2},并按第一目标升序排列前沿Q,那么Δ(S)可如下定义:Δ(S)=1其中di=‖犉(狓i)-犉(狓i+1)‖2,这里狓i为序列Q中第i个解,犉(狓1)=犈1,犉(狓|Q|)=犈2.Δ综合考虑了S的分布均匀性和覆盖宽广性,分布越均匀覆盖越完整的非劣解集具有更小的Δ值.另外计算成本表示算法平均搜索一个解所需要付出的计算代价,本文使用在相同机器上算法搜索相同数目个体的运行时间度量计算成本.6.2测试例为方便评估各算法的性能,本文选用Zitzler[8]提出的3个二目标0/1背包问题作为测试例,分别记为2-100、2-250、2-500,其背包数目均为2,物品数目分别为100、250、500,其Pareto最优前沿的边界点见表1.实验中所有算法均采用长为n的二进制串编码,其中n为测试例的物品数.由于遗传操作可能产生不可行解,本文采用加权标量(weightedscalar)修补算子[21]将不可行解转化为可行解.该修补算子按加权标量qj的升序以贪婪方式逐个清除背包中物品,直到满足所有背包的容量限制.这里物品j的加权标量qj定义为其中pij和wij分别为物品j在背包i中的收益与重量,λ=(λ1,λ2,…,λm)为关联于当前解的权重向量.本文也进一步采用了加权标量填充算子加快局部搜索.该填充算子只要背包容量允许,就按加权标量qj的降序以贪婪方式逐个往背包中添加剩余物品.测试例边界点2-100E1=(4266,3215)2-250E1=(9893,7570)2-500E1=(20094,16315)6.3实验数据分析本文首先选择4种多目标演化算法来对比分析Page10几何热力学选择的性能,分别为非劣分层遗传算法NSGA[7]、精英保留非劣分层遗传算法NSGA-II[5],采用基于基因熵和层级能量的分量替换规则的热力学遗传算法TDGA2和几何热力学遗传算法GTGA.所有算法均采用均匀交叉算子和翻转变异算子,变异后先对不满足约束的个体应用加权标量修补算子,之后再对该个体应用加权标量填充算子.所有算法的种群规模nP=200,交叉概率Pc=0.8,变异概率Pm=2/n,终止条件terminate在评估次数达到Ne时满足,Ne随问题的复杂度而增加,如表1所示.由于NSGA对Niche半径δ比较敏感,本文使用了与文献[8]中相同的δ值.TDGA2和GTGA中子种群Ot的规模nO=1/10×nP=20,初始温度T0=10,GTGA中角度分量等份数K=10000.应用4个算法各求解3个测试例10次.图4~图6分别呈现了算法在3个测试例上第1次运行所得到的非劣前沿.表2~表4分别给出了在3个测试例上各算法之间利用C度量得到的逼近性比较结果.其中,每一列的值皆代表一种算法与其它算法比较的C度量值在10次实验中的平均数.例如表3的第2行第4列的值C(NSGA-II,GTGA)=0.1858,代表GTGA所得的解平均有将近二成被NSGA-II的解所占优了;同理,第4行第2列的值C(GTGA,NSGA-II)=0.3054,代表NSGA-II平均有约三成的解被GTGA的解所占优;从C(NSGA-II,GTGA)<C(GTGA,NSGA-II)可知GTGA在2-250上的实验中逼近效果要比NSGA-II略好.从图4~图6可直观看出NSGA-II和GTGA的逼近效果明显比NSGA和TDGA2好很多,进一步从表2~表4可知后者的解绝大部分甚至全部被前者占优,这主要是因为NSGA和TDGA2均不带有精英保留机制.实验中NSGA-II和GTGA的逼近效果相当,在物品数较少的2-100上NSGA-II逼近性略好于GTGA,但在物品数较多的2-250和2-500上GTGA逼近性略好于NSGA-II.表22-100上利用犆度量得到的逼近性比较结果NSGA-00.43110.0019NSGA-II0.6934-0.73530.0835TDGA20.03540.0150-0.0201GTGA0.66590.02560.7284-表32-250上利用犆度量得到的逼近性比较结果NSGA-0.00320.34060.0012NSGA-II0.9192-0.85610.1858TDGA200.0076-0.0089GTGA0.94370.30540.8922-表42-500上利用犆度量得到的逼近性比较结果NSGA-0.00520.29820NSGA-II0.8565-0.87170.1107TDGA200.0006-0.0049GTGA0.96900.51770.8926-表5显示了算法在各测试例上10次实验中多样性度量Δ的均值.除了在2-100上NSGA-II略优于GTGA外,在2-250和2-500上GTGA都具有最Page11小的Δ值,这主要得益于GTGA较好的分布均匀性和极好的覆盖宽广性.实验数据表明几何热力学选择在保持种群多样性方面是有效的.NSGA-II也保持了较好的多样性,在2-250和2-500上的Δ值只是略差于GTGA.从图5和图6可以看出NSGA-II的解分布非常均匀,只是在覆盖宽广性上GTGA更优.TDGA2在保持多样性方面比NSGA-II和GTGA差,但明显好于NSGA.从图4~图6可看出TDGA2覆盖比较宽广,但分布不太均匀,这主要是由于TDGA2使用的基因熵是在决策空间而不是目标空间定义的.表53个测试例上利用Δ度量得到的多样性比较结果NSGA45.0861160.4884254.2272NSGA-II7.455912.481618.1551TDGA239.257953.049276.5794GTGA9.101211.815812.6635为更好地理解NSGA-II和GTGA中的种群进化特点,本文也呈现了2-250上两个算法在单次运行实验中当前评估次数ne分别达到2×103、1×104、4×104、2×105时的种群快照,分别如图7和图8所示.根据算法原理,NSGA-II对接近Pareto非劣前沿的个体施加大的选择压,GTGA初始对较稀疏扇形区域中的个体施加大的选择压,其后随温度的下降对接近各扇形中距离精英的个体施加越来越大的选择压.图7显示NSGA-II锋面的前进能力非常强,种群初始迅速逼近最优前沿,但覆盖较窄,之后沿最优前沿向两端扩张.图8显示GTGA扩张分布广度的能力非常强,种群的逼近方向初始迅速多样化,其后在保持逼近方向多样性的基础上向最优前沿逼近.由此可以看出这两个算法代表了两种具有不同特点的搜索模式,两者的特点可分别形象地总结为“深度优先搜索”和“广度优先搜索”.在物品数较少时,搜索空间较小,此时增加非劣前沿选择压比增加逼近方向多样性更有效,故NSGA-II在2-100上效果略好;而物品数较多时,维持逼近方向多样性显得更为重要,因而GTGA在2-250和2-500上表现略好.图9给出了4个算法在3个测试例上各10次运行中平均运行时间(以s为单位)的对比直方图.从图9可看出其中GTGA具有最高的运行效率,在3个测试例上的运行时间都明显小于其它算法.因为其它算法在每一代的适应值(个体能量)指派过程中都需要进行耗时的种群非劣分层操作,而在GTGA中计算个体的距离能量时个体只需与其所在扇形区域的距离精英比较,巧妙地避免了非劣分图93测试例上各算法的运行时间对比直方图层操作.图9显示了TDGA2的计算成本最大,在每个测试例上都至少4倍于GTGA.为进一步对比分析多目标优化中熵度量、能量度量、替换规则以及种群规模对热力学遗传算法运行效率的影响,本文也在2-250上以8个种群规模运行TDGA、TDGA2、TDGA3、GTGA各10次.8个种群规模依次为nP=100,200,300,400,500,600,700,800,TDGA中子种群规模按文献[9]设为nO=nP,其它3个算法nO=1/10×nP,所有算法终止条件terminate均在评估次数达到Ne=2×105时满足.图10呈现了种群规模变化时4种热力学遗传算Page12图104种热力学遗传算法的运行时间曲线法10次运行的平均时间曲线.从图中可看出TDGA在各种群规模下都具有最高的计算代价,并且种群增大时其运行时间急剧增加.TDGA2采用了分量替换规则,其运行时间相对于TDGA有很大程度减少,但其运行时间随种群规模增大有较明显增长.TDGA3采用了角度熵,其运行时间相对于TDGA2有些微下降.GTGA进一步采用距离能量避免了非劣分层操作,从图中可知GTGA具有最低的计算开销,且对种群规模较不敏感,种群增大时计算成本只有些微增加.这与TDGA极高的计算代价形成了鲜明的对比,例如,种群规模nP=100时,TDGA的运行时间约8倍于TDGA2,40倍于GTGA;种群规模nP=800时,TDGA的运行时间约25倍于TDGA2,400倍于GTGA,TDGA如此高的计算代价在实际应用中是难以承受的,这主要是因为TDGA采用了耗时的非劣分层操作和贪婪替换规则.实验结果显示分量替换规则极大地降低了多目标优化中热力学遗传算法的计算成本,距离能量则进一步明显改进了热力学遗传算法的运行效率.这与第5节中的时间复杂度分析结果是一致的.7总结针对多目标优化中TDGA目前计算代价太高和解集分布不够均匀的问题,本文从几何的观点引入了几何热力学选择方法以改善TDGA的运行效率和解集分布.几何热力学选择首先充分利用多目标优化中的角度和距离等几何量定义了角度熵和距离能量.其中角度熵通过在目标空间中扇形采样来度量种群逼近方向的多样性,提高了解集的分布均匀性;距离能量运用几何元素间接度量了种群的逼近程度,巧妙地避免了耗时的非劣分层操作.此外,引入几何分量热力学替换规则,通过将种群的几何自由能分派到其各个体有效降低了替换规则的复杂度.在多目标0/1背包问题上的实验结果表明,几何热力学选择在保持TDGA良好的覆盖宽广性的同时,极大地改进了其运行效率和分布均匀性.运用该选择的GTGA算法能够得到与NSGA-II性能相当的解集,但在运行效率上明显优于NSGA-II.随着目标数的增多距离精英文档将急剧增长,几何热力学选择在空间复杂度方面面临更大的挑战,因而在3个及以上目标时如何存储距离精英文档值得进一步研究.此外,几何热力学遗传算法的收敛性分析也是我们下一步的研究方向.
