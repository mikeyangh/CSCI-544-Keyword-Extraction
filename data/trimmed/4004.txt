Page1多特征联合建模的视频对象分割技术研究李宗民公绪超刘玉杰(中国石油大学计算机与通信工程学院山东青岛266580)摘要当前很多视频对象分割方法都联合利用了多种特征进行前景提取,但是这些特征都是通过简单加权融合到一起的.该文通过主成分分析法(PrincipalComponentAnalysis,PCA)比较准确地衡量了各特征在前景检测中所占的权重,使其有效指导前景分割.同时通过对各特征建立相应的高斯模型,有效提高了前景分割的质量,最后再通过基于颜色不变量的阴影检测算法得到了比较准确的结果.实验中采用了颜色(RGB)和局部二值模式(LocalBinaryPattern,LBP)4种特征,结果表明:无论是对于静态场景还是动态场景,该算法都具有良好的分割效果.关键词主成分分析;颜色;局部二值模式;高斯模型;颜色不变量1引言在众多的计算机视觉应用中,一项基础而关键的任务就是将运动前景对象从视频序列中提取出来.该技术广泛应用于对象跟踪、视频编解码、航空清障、航海指南、安防、海防、智能交通等很多领域.Page2成基于分类预测的分割方式,再被改进成基于时空联合分割的方式等.在视频对象分割技术发展的早期,很多学者利用帧间差分的方法进行前景对象获取,这类方法把视频序列中的前一帧或前某帧当作参考背景图像,通过阈值差分来得到最终的运动对象掩模.其中VSAM(VideoSurveillanceandMonitoring)[6]项目提出了一种改进的帧间差分方法,利用当前3个相邻帧做时间差分.该方法在一定程度上考虑到了背景随时间的变化因素,在检测精度上有一定的改进.Elias等人[7]通过建立长时间与短时间背景模型来共同表示真实背景.长时间背景主要是用来解决运动物体的暂时静止和全局性的光照变化问题,短时间背景主要是用来实时更新背景记录突然出现的变化.在特定的场景下该方法取得了较好的效果,但是由于涉及更新参数与阈值太多,使得它不具有通用性.帧间差分方法的更新机制相对简单,环境适应能力较快,但是由于不能有效地记录背景的历史信息,导致得到的前景对象往往太过粗糙.为了适应缓慢多变的场景,提高分割质量,有人从前景像素本身出发,通过一定的预测手段实时地获得前景对象.Wixson等人[1]利用了基于光流场的方法来提取前景,将突出运动看成是随着时间朝一个方向运动的,它主要考虑像素在下一个时间图像上偏离原位置的距离.为了提高准确性,作者用到了“流积累”.这种方法的运算量大,时间复杂度较高.Fragkiadaki和Shi[4]构建了基于光谱类聚轨迹分区图,然后根据轨迹分区图的显著性把轨迹分割为前景和背景.Karm[2]根据像素值随时间的变化情况,利用线性预测的方法进行背景更新与前景检测.Joaquin和Hugo[8]在利用光流法之前首先选择场景中的感兴趣区域,再根据亮度和颜色等信息建立初始背景层.然后用光流法来判定物体的运动方向和速度,在此基础上获取前景对象.Arnell和Lars[9]将U视差转换应用于光流法中,相对于传统的光流法文章中的算法速度更快,并在室外场景的检测中取得了比较好的效果.Yang等人[10]采用了基于图像块的视频对象分割方法,将每一个图像块看作是一个整体,在时间序列上不断地计算自身的均值与方差,当新的图像块偏离历史记录值较大时,则认为当前的图像块是前景,否则按照之前规定的原则进行更新.Mason和Duric[11]在基于图像分块的基础上,利用颜色直方图和边缘直方图作为度量值,分别对各块进行计算,通过统计来区分前背景区域.Hong等人[12]针对事先划分好的图像块选取合适的运动向量模型对其作出全局的运动估计,并运用运动信息获得初始结果,同时对其进行一定的时空滤波,最后通过自适应阈值判别得出运动前景.上述这类算法虽然能检测出前景区域但并不精确.当前景对象很大并且移动较为缓慢时,这些方法由于没有考虑到邻域信息容易产生空洞现象.它们虽能容忍一定的天气和光照变化但并不能有效地处理多变的场景和环境中的突然变化.为了改善环境的突然变化对检测效果的影响,有效地处理经常摇动的树叶等不完全静止背景.Stenger等人[13]利用了隐马尔科夫模型,把那些突然变化的因素离散化成为前景、背景和阴影,在背景建模与前景检测中将这些变化因素对应于不同的状态进行处理.Friedman[3]、KaewTraKulPong[14]、Stauffer[15]、Zivkovic[16]、Zang[17]根据视频中像素随时间的变化情况,通过对其建立多个高斯模型来适应场景的突然变化,其中每个高斯模型按照正态分布的规则进行更新,既有效地保留了历史信息又能及时记录当前变化.当前像素值的变化属于其中某个高斯分布的标准差之内时就认为该时刻的像素属于背景否则即为前景.与混合高斯模型类似,Kim等人[18]提出了一种基于码本思想的背景建模方法.方法中作者利用像素的亮度与色度,通过在一定时间内的聚类运算生成一套能够适应相应场景变化的码本并以此为基础进行运动对象分割,该方法能够抑制较大场景变化.Moshe等人[19]则用时空投射核函数对运动对象进行预测.Gong和Cheng[20]将前背景分割看作分类问题,用一类分类器来实现前景提取.Pham等人[21]用基于迭代分布匹配的方式,从建模的角度进行视频对象提取.从随机数据处理的角度,进行运动前景分割.Li等人[22]提出了基于贝叶斯判别的前景检测方法.这种方法适用于多背景的情况,比如摇摆的树叶、移动的电梯、移动的窗帘等等.这类算法由于过多地依赖像素本身随时间的变化而没有考虑邻域像素对其自身的影响,导致检测得到的结果中往往包含较多的噪点,对于运动不太明显的较小的前景对象往往检测不到,从而出现吸收前景的现象.为了有效解决上述问题,改善分割质量,综合考虑视频帧中像素的时间与空间信息,Sun等人[23]提出一种基于能量最小化的方法进行精确视频对象分割方法.作者在方法中考虑了像素邻域关系并结合Page3了最大流和最小割思想,使得分割结果比较精确,但是迭代的计算量偏大,不能实时更新背景.Li等人[5]为获取精确的视频对象分割结果,首先获取初始的视频前景掩膜并进行阴影检测,以此为基础再进行基于马尔科夫随机场的四分图分割,最后获得较为精确的结果.Yao等人[24]结合局部二值模式(LBP)与颜色这两个特征来对背景进行建模.这种纹理与颜色融合的方法确实取得了一定的效果.在建模过程中作者先将两者分别进行处理,最后通过人为的权值赋值将其结合起来,由于场景是复杂多变的,只用权值进行结合会给方法的鲁棒性带来很大的影响.Patwardhan等人[25]用基于像素聚类的方法进行背景建模,将预处理的M幅图像经过指定的技术将其聚类分成若干层,一般情况下特征相似的像素在位置上也是邻近的,在前背景判定阶段利用最大相似度技术进行判定.为了更加精确地检测出前景物体避免摄像机抖动的干扰,作者用了基于像素邻域的概率最大化匹配,利用高斯核进行概率计算.这种方法的重点在于将前景物体检测出来,它并不强调检测结果的准确性,并且运算复杂度高不满足实时性.2运动前景获取本文提出了一种基于权重确立的视频对象分割算法,其方法流程图如图1所示.该算法首先获取少量的样本,通过主成分分析得到各个特征在背景建模中的权重;然后对各个特征建立相应的高斯模型;再通过阈值检测获得运动的初始前景对象;最后进行阴影检测处理获得比较精确的视频前景.在视频对象分割中,最常用的特征是灰度特征、2.1特征选取颜色特征和局部纹理特征.一般而言,灰度特征的提取及运算速度最快,由于颜色特征会涉及多颜色通道,因此它的运算速度次之,它们对于表征单个像素随时间的变化是很有效的.局部纹理特征通过当前像素与其周围空间邻域的灰度分布来表现,它能比较稳健地描述当前像素所处的局部区域,对于噪声有一定的抑制作用.相比灰度特征,图像的颜色特征更能比较全面地反映视频场景中的像素级变化,因此我们采用了图像的颜色特征作为表征像素随时间变化的标量值,考虑到时间影响,我们直接使用了RGB颜色特征.在视频处理中,由于外界环境和摄像机本身的影响不可避免地会在一些位置出现噪声,而当前的很多方法都是依据先验学习判别前景的,这就会使得到的判别结果出现错误,得到“伪前景”.为了抑制这一问题,我们采用了局部纹理特征.当前局部纹理特征有很多,比较有代表性的局部纹理特征如:灰度共生矩阵、Gabor滤波器组、马尔科夫随机场模型、离散Walsh-Hadamard变换[26]、小波变换、局部二值模式(LBP)[27]等等.其中LBP是一种灰度级统计纹理,由于它对于灰度单调变化的不变性,使得它可以忍受自然场景中的显著变化.考虑到运算速度、描述精度和实际应用,我们采用LBP来衡量中心像素产生变化的置信度.这样一来本文就利用了RGB和LBP的4种特征.2.2高斯模型的建立为了较好适应多变的场景,有效地提取前景信息,我们认为对每种特征都建立一种分布模型来模拟场景的变化是很有必要的.通过相应的实验我们发现高斯模型是一种很好的选择.高斯模型的具体表示如式(1)所示.η(Xit,μi,Σi)=1其中,Xit表示时刻t的视频帧所对应的第i个特征,μi表示Xi所对应的均值,Σi表示Xi所对应的协方差.这样一来针对每种特征都会建立相应的高斯模型,为了获取准确的前景,我们根据各特征模型的组合预测来确定当前图像属于前景背景的概率.具体如式(2)所示.其中K表示模型个数,wi表示第i个特征所建立的高斯模型在组合预测中占的权重,μit表示特征Xi所在t时刻对应的均值,Σit表示Xi在t时刻所对应的协方差矩阵,ηi表示根据第i个特征随时间变化建立的高斯模型.以上参数值可以通过在线K均值聚类估计获得,如果当前像素的特征Xi数值在3.0个标准差范围之内,我们就认为当前像素满足Xi的背Page4景分布,否则认为它属于Xi前景.当像素属于背景的概率P小于0.5时,则确定当前像素属于前景.具体实验结果如图2(b)所示.2.3特征权重确定针对视频对象分割中的多特征多变量问题,当前主流的做法是通过将所用特征简单的加权组合进行分割,如Friedman等人[3]、Yao等人[24]中的方法.但是这种简单的加权方式在多变的场景中并不可靠,前景对象获取的好坏与权值有直接的关系,而这种情况下权值又是人为确定的,所以会给多特征情况下的视频对象分割带来很多不确定性.为此我们在多特征模型建立的同时提出了各模型所占权重确定的方法.假设采用的特征集合为X={X1,X2,X3,…,Xi,…,Xn},其中Xi表示所采用的特征,t表示采用的特征种类数目.依据随时间变化的视频帧,我们可以计算得到图像在n维特征空间的分布.对于随机变量犡T=(X1,X2,X3,…,Xi,…,Xn)T,我们假设犡T的取值符合正态分布,这样一来样本点在n维空间中的分布就是n维椭球体.由于各特征之间是相互独立的,我们可以经过正交变换使样本点在Z1方向的方差最大,在与Z1垂直的Z2上的方差次大,在与Z1和Z2垂直的Z3上方差第3大…,直到求出最后垂直于Z1,Z2,…,Zn-1的Zn,进而我们可以求解出每个方差方向所占的权重.这样一来特征在视频前景分割中的权重估计,就转化为了主成分分析问题.首先我们根据获得的样本点建立获得各特征的均值,如式(3)所示.i表示第i个特征的均值,M表示样本总数,xik是x-第i个特征的第k个样本值.依据此结果我们可以求出相应的协方差矩阵犛.犛ij=1M∑M由协方差矩阵我们得到相关阵犚.由于协方差矩阵是正定矩阵,所以相关阵也是正定矩阵,据此我们可以求解R的特征方程:求出犚的特征值(λ1,λ2,…,λn).接下来,与常用的的PCA特征降维不同,我们保留所有的成分,每一种特征在前景决策中所占的权重ωi为2.4前景对象获取通过前述内容,我们对各特征建立了相应的高斯模型,并确立了所用特征在前景检测中所占的权重,据此我们构建了一个基于多特征的混合高斯模型.为了更详细地描述算法提取前景对象的流程,体现帧间连续,我们用伪代码描述如下.1.训练阶段(1)模型建立阶段Fort=1,2,…,n(n表示训练图像数目)①对于每一幅图像的像素,获取RGB颜色特征,计算②对每一种特征建立与之对应的高斯模型η(Xit,μi,Σi)=1相应的LBP纹理特征;其中,(注:μi和Σi的初始值均为0)EndFor(2)权重确立阶段Fort=1,2,…,n(n表示训练图像数目)③对于每一幅图像,获取其RGB颜色值和LBP纹理值;EndFor④通过步③我们可以获得n×4(“4”表示R、G、B、LBP,4种特征)维矩阵;⑤通过式(3)~(8)我们可以计算得到每一种特征在前景决策中所占的权重ω;2.前景对象检测阶段Fort=1,2,…(t表示视频帧的序号)⑥依据构建的混合高斯模型判断当前像素是否属于前景.具体判别方法为:如果当前像素的特征Xi的数值在对应模型的3.0个标准差范围之内,我们就认为当前像素满足Xi的背景分布,否则认为它属于Xi所建模型的前景;最终当像素在混合模型中属于背景的概率P小于0.5时,则确定当前像素是前景;⑦如果当前像素属于前景则标记并输出,如果属于背Fort=1,2,…,n(n表示特征数目)景则更新每个特征Xi的高斯模型.更新方式如下Page5(注:L是一个定值,在试验中我们将L设定为200,其目的是将时间较久远的历史数据去除,加强最近最新数据的影响)EndForEndFor图2联合特征建模实验结果((a)表示视频序列中的3阴影检测与消除虽然利用本文提出的方法获得了较好的效果,但是由于阴影和移动背景的影响使得获取的前景还是不精确,为此我们采用基于颜色不变量的移动阴影检测算法进行阴影的检测与消除,以获得更加准确的前景.颜色不变量特征最早由Cavallaro等人[28]提出,像素i的颜色不变特征参见式(9).其中R(i)、G(i)、B(i)分别表示像素i的红、绿、蓝颜色组件.随后我们对比了当前像素i的Ii与其所对应的背景IBi,于是有式(10)Di=(c1(i)-cB通过实验对比分析,我们约定当Di小于一定阈值,并且颜色分量R(i),G(i),B(i)满足一定阈值条件时,则认为当前像素属于背景,具体算法实验约定参见表1所示.1|Xi-XB2|Xi-XB3|Xi-XB其中,α是允许方差波动范围的阈值参数,fbackground、fforeground和fshadow分别是决定前景和背景的两个阈值.为了使获得的前景尽量无噪点,在不影响查全率的前提下我们对处理后的结果做了适当的区域滤波,以使结果更加准确,具体实验效果如图3所示.图3阴影检测效果((a)视频序列中的某一帧;(b)用本文方法得到的初始前景;(c)阴影检测后的实验效果)4实验结果为了验证算法的有效性,我们实验了一些视频序列.这些视频序列的分辨率是320×240,并且都含有随机移动的背景.我们实验的硬件环境是2.5GHzCPU,内存为2GB.图4到图10分别显示了实验结果以及相应的对比情况.其中,第1行(a)图像表示原始图像;第2行(b)图像表示用混合高斯模型得到的实验结果;第3行(c)图像表示用本文提出的方法得到的实验结果;第4行(d)图像表示用本文提出的方法再进行阴影检测后得到的实验结果.其中,图8和图9是在室内情况下进行前景检测的结果.图4~图7及图10是在室外情况下前景检测的结果.在室内情况下(图8和图9)由于灯光的频闪和投射阴影的存在会给视频中对应区域的色度带来较大改变,但是纹理信息却变化不大.如果将所有特征都等同看待会产生很多误检.由于我们在检测之前就确定了特征在前景检测中的权重,所以产生了比较好的效果.Page6图10所处的背景和行人的衣服颜色都很暗,这种情况下纹理特征所占权重就会比较大.图4和图7中,前景与背景的颜色差别较大.图6的环境中在风的吹动下树叶摇摆不定,从实验中可以看出我们的方法取得了比较好的效果.图5中的摄像机距离较远,视频中前景物体很小,应用我们的方法同样获得了比较好的效果.实验表明该算法对于移动背景有较强的适应能力,能够提取出比较完整而准确的前景对象,其性能要优于经典的混合高斯模型方法.应用阴影检测算法处理之后能够达到更好的效果.5结论本文提出了一种基于多特征联合建模的视频对象分割方法,它有以下特点:(1)较之传统的视频对象分割方法,本文对多特征联合建模之间的权重用主成分分析方法进行了衡量;(2)我们所构建的混合高斯模型是基于多特征的,这与经典的混合高斯模型不同.实验结果显示,该算法在提取运动场景时Page7图9室内光照与反射光存在情况下检测结果图10室外暗背景情况下低分辨率行人检测结果的运算量较小,稳定性较高,能够从动态场景中快速准确地提取出运动物体.如何从动态多变的场景中准确快速地提取出运动物体,并对其识别和跟踪将是我们下一步要研究的问题.
