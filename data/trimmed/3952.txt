Page1大规模不确定图上的Top-犽极大团挖掘算法邹兆年朱矪(哈尔滨工业大学计算机科学与技术学院哈尔滨150001)摘要该文研究了从不确定图中挖掘出前k个出现概率最高的极大团的问题,提出了一种基于划分的高效并行算法.在该算法中,输入的大规模不确定图首先被划分为若干互不重叠的规模较小的子图,每个子图通过扩展邻居结点信息成为扩展子图.而后,应用改进后的分支界限搜索策略,并行挖掘各个扩展子图,以得到局部top-k结果.最后,归并所有的局部top-k结果,得到全局top-k极大团.同时,该文还提出了两种预处理策略,以提高算法效率.并且严格证明了算法的正确性.在多组不确定图数据集上的实验结果表明,算法具有很高的效率和很好的实用性.关键词不确定图;top-k极大团;图划分算法;扩展子图1引言近年来,随着图数据模型的迅速发展,多种实际Page2且大量算法[4-5]被提出.其中,极大团枚举问题(简称MCE)是一个十分重要的问题.在图中,团是一个任意两顶点均邻接的顶点集合,极大团是指不是任何其它团的子集的团.极大团枚举问题就是挖掘给定图中全部极大团.由于具有最佳的连通性,团和极大团通常被视为图中稠密子结构的核心部分,蕴藏着集中的知识信息.因此,MCE被广泛应用于实际应用中,如社交网络中的社区发现[1]、Web网络中的拓扑分析[2]等.同时,MCE问题和图论中的图染色问题[6]、最大独立集问题[7]等理论问题具有密切联系.长期以来,人们对于MCE问题进行了深入研究.文献[5,7-11]中提出了一些具有代表性的算法.虽然理论上MCE是一个NP-难问题[7],但实验表明上述算法在实际的稀疏图中表现良好[5].然而,现有的MCE算法所关注的图模型都是准确和完备的确定图.在现实应用中,图数据往往带有内生的不确定性,称为不确定图.例如,在无线传感器网络中,我们用点表示传感器结点,用边表示结点间的通信链路.由于能量耗尽,网络中的某些结点可能失效,同时由于通信干扰,结点之间的通信链路可能受到影响[12].因此,整个网络中的顶点和边都以一定的概率存在,整体的图结构具有不确定性.在不确定图中挖掘极大团同样具有重要意义[13].例如挖掘生物蛋白质网络中的极大团可以预测不同蛋白质在功能上的密切联系.但是由于缺乏对不确定性的考虑,现有的MCE算法在不确定图上并不适用.假设在某个极大团中,顶点和边的存在概率均很低,那么其作为极大团结构真实存在的概率很小,不具备现实的应用价值.因此,不确定图上的MCE算法必须建立合适的评价指标,区分不同极大团的出现可能并找出其中存在概率较高的极大团.在我们的前期工作[13]中,作者提出了极大团概率的概念,用于表示不确定图中某个顶点集合作为极大团真实出现的概率.同时,文中提出了挖掘不确定图中top-k极大团概率的分支界限搜索算法.虽然该算法适用于不确定图上的极大团挖掘,但在处理大规模不确定图时面临挑战.为解决此问题,本文将其进行拓展并提出一种基于划分的并行算法,用于不确定大图中的极大团发掘.首先,本文采用文献[14]中提出的一种高效图划分算法将一个不确定大图划分为若干个规模较小的不确定子图,并在各个子图上并行处理.为了保证结果正确和完整,对划分得到的子图进行适当扩展,得到扩展子图.而后在每个扩展子图上,将文献[13]中的分支界限算法加以改动以挖掘其中的top-k极大团,称为局部结果.最后,归并所有的局部结果得到全局的top-k极大团结果.另外,我们还提出了两种预处理策略,通过减小输入图的规模来提高算法效率.为了测试算法的正确性和效率,我们在多组不确定图数据上进行了实验.实验结果表明,算法具有很高的效率,并且挖掘结果具有很高的实用价值.在本文第2节介绍本文相关工作;第3节给出问题的形式化描述;第4节介绍基于划分的并行算法;第5节给出实验结果与分析;第6节总结本文工作.2相关工作极大团枚举问题的相关算法研究为时已久,文献[15]中给出了关于MCE问题典型算法的详细综述.其中主要的工作包括文献[8]中提出的基于子问题规约的算法、文献[9]中基于深度优先搜索的算法、文献[11]中基于并行搜索树的算法等.文献[7]中提出了一种在多项式时间间隔内连续产生极大团的算法.文献[16]对其进行了改进和提高.在文献[5]中,作者提出了一种高效的外存算法,可通过图中局部顶点的信息计算得到全局的极大团结果,具有很好的并行性和扩展性.但是,这些算法均没有考虑图数据中的不确定性,不能从概率的角度给出出现可能较大的极大团.因此,上述MCE算法并不适合于不确定图上的极大团挖掘.不确定图的相关研究工作最近开展较多,提出了大量的模型和挖掘算法.文献[4,13,17]给出了用概率加权形式表示的不确定图模型.文献[4,17]给出了概率语义下不确定图中挖掘频繁子模式的定义与方法.作为本文的前期工作,文献[13]中给出了不确定图上top-k极大团问题的形式化定义和一种分支界限搜索算法.为了解决其在处理大图数据时面临的挑战,我们将以此为基础提出一种新的并行算法.为了适应大图数据处理,文中采用了图划分的策略.早期基于边加权方式[18]的图划分算法不够高效,而基于层次聚类和基于最大-最小割[19]的算法只在特定图中效果较好.文献[14]提出了基于模块度的划分算法,其时间复杂度达到了O(|V|·log2(|V|)),非常适用于处理大规模图数据.因此,本文将采用此算法来划分不确定大图.Page33问题定义本节介绍一种不确定图模型,并形式化描述不确定图上的top-k极大团挖掘问题.3.1不确定图模型不确定图是一个四元组=(V,E,PV,PE),其中G=(V,E)是一个无向确定图;PV:V→(0,1]是一个函数,它为每个顶点v赋予存在概率PV(v),用于表示顶点v实际存在的概率;PE:E→(0,1]也是一个函数,它为每条边e=(u,v)赋予条件存在概率PE(e),表示在顶点u和v存在的条件下,边e的存在概率.因此,若PV(v)=1,则顶点v一定存在;若PE(e)=1,则边e在两个端点存在的条件下一定存在.于是,一个确定图等价于一个所有顶点的存在概率均为1且所有边的条件存在概率也均为1的特殊不确定图.由于不确定图中的顶点和边是否真正存在是不确定的,因此一个不确定图实际对应着一组可能的确定图结构.我们称不确定图=(V,E,PV,PE)导出确定子图G=(V,E),记为G,当且仅当G满足:1.{v|v∈V,PV(v)=1}VV,2.{e=(u,v)|u,v∈V,PE(e)=1}EE.其中条件1说明V是顶点集V的子集,并且确定存在的顶点(即PV(v)=1的顶点)一定要出现在V中.条件2说明G中所有边的端点均在顶点子集V中,并且在V存在的条件下,确定存在的边(即PE(e)=1的边)一定要出现在E中.在本文中,我们假设不确定图中各个顶点的存在概率相互独立,同时各条边的条件存在概率也相互独立.那么,不确定图=(V,E,PV,PE)导出确定子图G=(V,E)的概率为P(G)=∏v∈V∏(u,v)∈E例如,图1(a)给出了一个不确定图.图1(b)给出了的可能导出的一个确定子图G.容易验证,P(G)≈1.0838×10-4.我们用Ω()表示不确定图导出的所有确定子图的集合.可以看出,函数p(G)=P(G)是Ω()上的一个概率质量函数.为了表述方便,我们将确定图(V,E)称为不确定图=(V,E,PV,PE)对应的主确定图,记为3.2问题描述给定确定图G=(V,E)和顶点子集CV,如果对于任意两个不同顶点u,v∈C,均有(u,v)∈E,则称C为团.如果C是团,并且C不是其它任何团的子集,则称C为极大团.团C中所包含的顶点数量称为C的大小,记作|C|.例如,在图1(a)中的不确定图的主确定图为3的团,顶点集{5,6,8}则是一个极大团.给定不确定图=(V,E,PV,PE)和顶点子集CV,我们用mcliq(C)表示C在Ω()的所有确定图中成为极大团的事件.因此,事件mcliq(C)发生的概率等于C作为极大团出现的确定图的导出概率之和,即:P(mcliq(C))=∑G∈Ω(),C在G中是极大团P(G)(2)为简便起见,我们将P(mcliq(C))称为C的极大团概率.P(mcliq(C))越高,表示顶点子集C在实际中以极大团结构出现的可能性越大.在实际应用中,人们往往只关注给定不确定图中极大团概率前k个大的顶点子集,称为不确定图上的top-k极大团.因此,不确定图上的top-k极大团问题描述如下:输入:不确定图=(V,E,PV,PE),正整数k和s.输出:包含k个顶点集合的集族F,对于任意顶点子集C∈F,均有Cs;且对任何顶点集合CF,Cs,均有P(mcliq(C))Pmcliq()()C.文献[13]证明了不确定图上的top-k极大团问题是一个NP-难问题.4算法描述本节提出一种基于划分的并行挖掘算法,用于挖掘不确定大图中的top-k极大团.首先,4.1节回顾经典的分支界限搜索算法[13].而后,4.2节给出基于划分的算法的细节.在4.3节中,我们介绍了两种提高算法效率的预处理策略.4.1分支界限搜索算法我们首先回顾文献[13]中提出的用于挖掘不确定图中的top-k极大团的分支界限搜索算法.为了Page4计算极大团概率,我们引入团概率的概念.在不确定图=(V,E,PV,PE)中,用cliq(C)表示顶点子集CV在Ω()的所有确定图中成为团的事件.与极大团概率类似,我们称cliq(C)为C的团概率,定义为P(cliq(C))=∑G∈Ω(),C在G中是团P(G)(3)在不确定图中,如果顶点子集C在主确定图中不是团,那么C在Ω()中所有确定图中均不是团.因此,我们只考虑在述命题1和2给出了在多项式时间内计算团概率P(cliq(C))和极大团概率P(mcliq(C))的方法.命题1.给定不确定图=(V,E,PV,PE),对于主确定图P(cliq(C))=∏v∈C命题2.给定不确定图=(V,E,PV,PE),对于主确定图C多出一个顶点的团,那么C的极大团概率为P(mcliq(C))=P(cliq(C))∏m有关命题1和2的详细证明可以在文献[13]中得到.下面给出分支界限搜索算法[13].设是顶点集V上的一个偏序关系,根据可将组织成一颗搜索树.其中搜索树的根节点为空集,树中的每个结点对应于一个团C,其儿子结点为比C多一个顶点的团C,并且对{w}=C\C和任意顶点v∈C,均有vw.具体算法描述如下.算法1.分支界限搜索算法.输入:不确定图,正整数k和s输出:包含k个顶点集的集族FS1:初始化F为空集,用于存放已得到的部分top-k概率的极大团.初始化优先级队列Q用于存放待搜索的团,其中Q中元素按照团概率递减排列,F中元素按照极大团概率递增排列.S2:对任意顶点v∈V,根据式(4)计算单顶点团的团概S3:重复下列步骤,直到Q为空或者Q中最大元素的率P(cliq({v})),而后将{v}插入Q中.团概率小于F中最小元素的极大团概率:1.取Q队首元素C,按照式(5)计算P(mcliq(C)).2.若|C|s,则更新F,即如果F<k,则将C直接插入F;否则,若P(mcliq(C))大于F中最小元素的极大团概率,则将F中最小元素弹出,插入C.3.枚举C在搜索树中的儿子结点,根据式(4)计算其团概率并插入Q中.S4:输出F中的全部元素,即为top-k概率的极大团.文献[13]中描述了算法的更多细节步骤.对于图1(a)中的不确定图,设k=5,s=3,则其top-5极大团为{5,6,8},{1,2,4},{1,3,4},{5,7,8}和{2,3,4}.4.2基于划分的算法本节提出了一种基于划分的top-k极大团并行挖掘算法,该算法的基本过程如下:给定不确定图=(V,E,PV,PE)和正整数k和s,首先将顶点集V划分为N个互不相交的顶点子集V1,V2,…,VN,使得∪Ni=1Vi=V,其中N表示并行机器的数量.这样,我们可得到由V1,V2,…,VN导出的不确定子图1,2,…,N.为了保证结果的正确性,我们对子图1,2,…,N进行扩展,得到N个不确定扩展子图2,…,+上,并使用改进后的分支界限搜索算法在扩展子图1,2,…,++部top-k极大团Fi.最后,归并所有的局部结果F1,F2,…,FN,得到中的top-k极大团F.下面,我们首先介绍图划分算法,然后给出子图扩展方法并证明其正确性,而后介绍经过改进的分支界限搜索算法,最后给出整体算法.4.2.1图划分算法给定不确定图=(V,E,PV,PE)和正整数N,我们将V划分为N个互不相交的子集V1,V2,…,VN,使得∪N的划分策略在此处均适用,然而不同划分策略的代价截然不同.直观上,我们希望划分得到的子图“高内聚,低耦合”,即同一划分内部的边尽可能多,而连接不同划分的边尽可能少.同时对于大规模图,划分算法的效率也至关重要.因此,本文选用了文献[14]中的算法,其时间复杂度为O(|V|·log2(|V|)).在该算法中,为衡量划分质量,作者提出了模块度的概念.对划分V1,V2,…,VN,其模块度定义为此处eii=δ(Vi,Vi)/m,ai=∑km是图中边的数量,δ(Vi,Vj)表示连接划分Vi和Vj的边的数量.因此,eii表示划分Vi内部边的比例,而ai表示和Vi中顶点邻接的边所占比例.模块度越高,算法的划分效果越好.为此,算法采用迭代方式进行处理.初始时,每个顶点都是一个单独的划分.然后在每一轮迭代中,选取能够使模块度提高最大的两个划分进行合并,直到划分数量到达N为止.在该算法中,为了能够快速地找到最大的Δ,算法Page5采用了高效的数据结构进行优化.此处,我们给出该算法的一个概括性描述.算法2.图划分算法.输入:不确定图=(V,E,PV,PE),划分数量N输出:N个不相交集合V1,V2,…,VN,并有∪NS1:初始化一个|V|行的Δ矩阵,存储划分Vi和Vj合并时的模块度变化值Δ(i,j).将Δ的每一行都同时组织成一个最大堆和一棵平衡树.初始化一个全局最大堆H,将Δ的每行最大元素连同位置信息(i,j)一同压入H中.S2:若划分规模大于N则继续,否则转向S4.S3:取H的堆顶元素Δ(i,j),将Δ矩阵的i和j行合并到i行,合并后的i行包含原i和j行中所有顶点.更新矩阵i行的元素值,并更新最大堆和平衡树,而后更新全局最大堆H.返回S2.S4:输出Δ矩阵中每行所代表的顶点集为划分结果V1,V2,…,VN.文献[14]中给出了矩阵元素初始值和更新值的详细计算公式.同时文中给出了算法时间复杂度的详细分析过程.4.2.2子图扩展在不确定图中,顶点子集SV导出的不确定子图为[S]=(VS,ES,PV,PE),其中VS=S,ES=(S×S)∩E.对划分结果V1,V2,…,VN,其对应的不确定导出子图为1=V[]1,2=V[]2,…,N=[VN].但直接在i上运行挖掘算法并不能保证最终结果的正确性.若某个团C中的顶点被划分到若干不同的划分中,那么在每个划分导出的子图中,C均不会被搜索和计算到,最终结果中和C一样的跨划分的团将全部丢失.例如在图1(a)中,若V1={1,2,3,4,6},V2={5,7,8},那么团{5,6,8}将从最终结果中丢失.因此,我们必须对子图进行扩展,使得每个团都包含在至少一个扩展子图中.为了保证挖掘结果的完整性,我们需要将划分Vi的邻居信息包含到子图中.对于划分Vi,其邻居顶点集定义为N(Vi)={v|(u,v)∈E,u∈Vi,vVi}.我们用子图,称为划分Vi对应的扩展子图.下面我们证明这种扩展方式的正确性,首先我们通过定理1证明每个团C都包含在至少一个扩展子图定理1.对于划分Vi,使得CVi∪N(Vi)且C∩Vi≠.证明.对于任意团CV和顶点v∈C,设Vi为v所属划分,显然C∩Vi≠.由于C是团,对任意其它顶点u,u和v必邻接.因此,若u不在Vi中,则u一定在N(Vi)中.故存在划分Vi使得CVi∪N(Vi).定理2.对于定理1保证了挖掘结果的完整性.下面的定理2保证了结果的正确性,即在扩展子图上得到的极大团概率可以和在全图中计算得到的相同.Vi∪N(Vi)且C∩Vi≠,则C在率与在中的极大团概率相等.证明.根据式(5),若要计算C的极大团概率,必须计算C和比C仅多一个顶点的团Ci的团概率.根据式(4),若计算C和Ci的团概率,则要知道C和Ci中所有点和边的概率信息.由于CVi∪N(Vi),因此在于Ci,设{vi}=Ci\C,由于Ci为团且C∩Vi≠,于是有vi∈Vi∪N(Vi),因此可以计算PcliqC()()i.综上所述,可知在和在中计算的结果相同.定理2保证了在扩展子图少包含一个Vi中顶点的极大团是正确的.综合定理1和2,我们可以先将图划分,而后挖掘所有扩展子图i上至少包含一个Vi中顶点的极大团.下面的命+题说明所有扩展子图中的top-k极大团归并以后,可以得到正确的全局top-k极大团.命题3.设C1,C2,…,Ck是中的top-k极大团,对于每一个Ci,一定存在某个扩展子图j上的top-k极大团.Ci是+证明.根据定理1,必定存在的团,并且有Ci∩Vj≠.根据定理2,其在极大团概率可以计算,并且和全局极大团概率相等.由于其极大团概率在全局是top-k的,在也是top-k的.因此命题得证.综合上述,我们可以通过图划分和图扩展的方式得到准确完备的全局top-k极大团.考虑图1(a),将图划分为V1={1,2,3,4}和V2={5,6,7,8},其扩展子图在图2中给出,每个子图的邻居顶点用白色标出.为了满足图划分和子图扩展方式下挖掘极大团4.2.3分支界限搜索算法改进的要求,我们要对扩展子图法加以改进,以满足每个局部top-k极大团中包含Page6至少一个划分Vi中结点.同时,注意到,对于跨划分的团的搜索存在重复计算的冗余情况.例如图2中的团{2,4,5},其在了保证正确性和消除冗余,我们对分支搜索的策略加以改进,下面命题说明任何一个全局top-k极大团都可以仅被搜索一次.命题4.设C是中的top-k极大团,那么有且只有一个划分Vi使得C∩Vi≠,C是top-k极大团,并且对任意j<i,Vj内不包括C中的任何顶点.证明.我们分两种情况证明此命题.在第1种情况中,团C仅属于某个划分Vi.根据命题3,C必是任意划分Vj,均有C∩Vj=.在第2种情况中,团C被划分到多个划分Vk1,Vk2,…,VkM中.不妨设k1<k2<…<kM.对任意Vkj,1jM均有C∩Vkj≠.根据定理1和2,团C在其中任意一个划分中均可计算得到正确的极大团概率.再根据命题3,团C是全局的top-k极大团,那么团C在任意一个划分所对应扩展子图上也是top-k极大团.在此,令i=k1,由于k1最小,因此不存在j<i并且Vj包含C中顶点.在并行搜索过程中,我们只需在的扩展子图上忽略团C即可.根据命题4,对于扩展子图搜索每个团在搜索树中的子结点时只考虑向当前团中增加Vi+1,Vi+2,…,VN中的顶点.这样一个全局top-k极大团就不会在不同划分中被重复搜索.同时在算法初始阶段,可以仅将Vi中的顶点放入搜索队列.通过设定偏序关系,使得u∈Vi,v∈N(Vi)均有uv,这样就可以保证所有被搜索到的团中都包含至少一个Vi中顶点.下面我们给出改进后的分支界限搜索算法.算法3.改进分支界限搜索算法.输入:不确定子图输出:k个顶点集的集族FiS1:初始化Fi为空集.初始化优先级队列Q.其中Q中元素按照团概率递减排列,Fi中元素按照极大团概率递增排列.S2:对所有顶点v∈Vi,计算Pcliq({v()}),而后将{v}S3:重复下列步骤直到Q中没有元素或者Q中最大元插入Q中.素的团概率小于F中最小元素的极大团概率:1.取Q队首元素C,计算极大团概率P(mcliq(C)).2.若|C|s,则更新Fi,即如果Fi<k直接插入Fi;否则若P(mcliq(C))大于Fi中最小元素的极大团概率,则将3.枚举C的子树结点,如果新增结点u∈Vj且ji,则S4:输出Fi中的全部元素,即为Fi中最小元素弹出并插入C.计算其团概率并插入Q中.4.2.4算法小结到最终算法.至此,可以将本小节的各部分算法加以总结得算法4.基于划分的并行算法.输入:不确定图,正整数k和s输出:k个顶点集的集族FS1:对于划分得到顶点集合V1,V2,…,VN,经过子图扩展后得到扩展子图S2:对于搜索算法得到局部结果Fi.为了提高分支界限的搜索效率,我们给出两种S3:将得到的Fi(1iN)按照极大团概率使用选择树或者最小堆归并,得到最终的全局top-k极大团结果F.4.3预处理策略预处理搜索策略:度过滤和边过滤.度过滤方法如下:由于团大小至少是s,那么一个度数小于s-1的顶点肯定不会出现在最终结果中.因此,我们可以迭代地移除图中所有度数小于s-1的顶点,直至图中不包含度数小于s-1的顶点为止.边过滤的方法如下:对于边e=(u,v),如果u和v能够形成团,则共同邻接u和v的顶点个数不能小于s-2.否则,边(u,v)可以移除.因此,我们可以迭代地移除所有不满足条件的边.显然,度过滤和边过滤的方法对于不确定图及其子图都适用.两者可以相互配合直到两者条件均满足为止.在算法4中,我们可以先对进行预处理而后进行划分.在子图挖掘前,可以对不确定子图进行预处理以提高算法效率.5实验为了验证本文算法的效率和正确性,我们进行了大量实验.实验中我们测试了算法在不同输入参数下的性能表现以验证算法效率.同时,我们测试了算法的预处理策略以及分支界限搜索算法的优化效果.算法采用C++编程实现,实验环境为PC机,2GHz处理器,2GB内存,运行Windows7操作系统.实验采用了下列3种数据集.真实数据集.实验中采用欧洲分子生物学实验室STRING(http://string-db.org)提供的真实不确定图数据.数据集是一个蛋白质网络,其中顶点代Page7表蛋白质,具有确定性.边代表不同蛋白质之间存在相互作用的概率,通过生物实验加以测定.整个网络包括6865个顶点和70288条边.合成数据集.实验中的合成数据集采用确定图数据加上人工标注概率的方法生成.真实的图数据是一个大规模的PGP网络,包括10680个结点和24317条边.我们为其中所有的点和边随机生成存在概率,概率取值为随机生成的0.000~0.999之间的三位有效小数.人造数据集.我们随机生成了一规模人造网络,其包括104个顶点.首先随机连接不同顶点,生成105条边.而后为所有的顶点和边随机生成存在概率,概率取值为随机生成的0.000~0.999之间的三位有效小数.5.1算法参数实验我们首先测试算法在不同输入参数情况下的性能表现,包括不同的划分数目N、不同的结果集大小k和不同的最小团大小限制s.在测试某一参数时,我们固定其它参数,并给出算法的运行时间关于参数的变化关系,其中Protein曲线表示真实蛋白质数据集,PGP曲线表示合成数据集,Artificial代表人造数据集.首先设定参数s=3,k=50,测试划分数目N从2~15变化时算法的运行时间.从图3可以看出,随着划分数目的增多,算法运行时间t首先呈现明显的下降趋势,在达到某阈值Nc后,算法运行时间基本保持稳定.此种实验现象的原因在于,在基于划分的算法中,算法的执行时间和划分与扩展后得到的不确定扩展子图规模相关.当划分数量增加时,划分得到的顶点集规模逐渐减少.在划分数量较少时,划分得到的顶点集合规模较大,故其增加邻居顶点的数量较少.因此,此时不确定子图扩展前后规模变化不大,由于子图规模不断变小,算法运行时间快速下降.随着划分数目增大,顶点集数目变小,新增加邻居结点的概率不断增大,经过扩展后子图规模基本保持稳定.因此在达到某一阈值Nc后,算法运行时间保持稳定.这一实验结果说明通过提高划分数目来降低算法运行时间的方法存在下界,其在实际应用中具有重要意义.对于给定的数据集,我们只需通过实验测定Nc值,而后使用稍大于Nc的机器数量并行运行算法即可获得稳定的运行时间,大大节约了计算资源.而后,通过对比可以看出采用本文中基于划分的算法在运行时间上的优势.传统的算法包括穷举搜索算法、面向全图的分支界限搜索算法两种.从理论上看,穷举搜索算法其枚举数量和图的顶点规模成指数关系,具有极高的时间和空间复杂度.在图规模较大时,穷举法在有限计算时间内无法得到结果,因此不具有实用价值.在N=1时,本文算法即为面向全图的分支界限搜索算法.在表1中,我们对比了全图分支界限搜索法和基于划分算法的稳定运行时间.可以看出,基于划分算法其运行时间只有传统算法的40%左右.说明通过图划分的手段减小了计算规模,显著降低了运行时间.算法类型分支界限1.6880.8528.931基于划分0.6760.4375.753而后设定参数s=3,N=10,测试结果集大小k从10~120变化时算法的运行效率.由图4看出,算法运行时间t关于结果集大小k呈现接近于线性的增长趋势.分析算法过程可知这一趋势符合算法特性.在算法中,结果集F可用最小堆实现.初始时构建最小堆复杂度为O(k·log(k)),而后向堆中删除或者插入一个元素复杂度为O(log(k)).同时,增大k会减少最小概率导致削弱剪枝效果.因此,算法时间对k呈现接近线性的增长趋势.对于正常的top-k查询,这一效率足够满足需要.下面我们考察算法效率和最小团大小限制s的关系.设定N=10,k=50,令s由3~7增长.通过测试算法运行时间可看出,在图5中,时间t和s呈现Page8明显的指数增长关系.在分支界限搜索算法中,我们将图组织成一颗搜索树,算法的搜索规模等价于计算树中所有小于s层的结点概率.随着s增大这一数字以指数形式增长,因此算法时间表现出相同的趋势.在一般的top-k查询中,s取值不大,因此对于算法效率影响有限.综合参数实验可以看出,选取合适的划分数目N,对于一般的查询参数k和s,算法具有较高的效率.一般情况下,对于顶点规模在104左右的不确定图,算法处理时间在10s以内.其中,稠密图如人造数据集比稀疏图如合成数据集处理时间多出数倍,因此算法需要采取适当的预处理策略尽量降低输入图的规模.5.2算法优化措施实验测试不同优化措施对于算法性能的影响,包括预处理策略(度过滤和边过滤)和分支界限搜索算法的消除冗余搜索的效果.首先测试两种预处理策略度过滤和边过滤的优化效果.预处理流程为迭代使用度过滤消除顶点和使用边过滤去除边.在测试中,我们选定s=5,N=10,变化结果集大小k值,对比观察有无预处理策略下算法的运行时间差异.在图6中,我们给出了真实蛋白质图数据中预处理措施的优化效果.对比算法运行时间可以发现,经过预处理后算法运行时间只有原先的60%~70%.证明预处理措施对提高算法效率有很好的效果.同样,我们测试了改进分支界限算法消除冗余搜索的效果.设定s=5,N=10,变化结果集大小k值,我们对比算法是否采用冗余消除搜索算法的时间差异.图7中显示了在Protein数据集上测试结果,可以看出使用冗余消除搜索算法时间降低程度在10%以内.这说明经过划分算法后跨划分的top-k极大团数量有限,因此冗余消除效果并不明显,但由于不增加程序实现难度,在实际应用中此方法可以采用.在其它数据集中的类似结果,由于篇幅限制不再列出.5.3算法结果应用实例此处,我们给出一个本文算法的应用实例,针对实验中Protein数据集得到的top-5极大团如表2所示.在top-1结果中,我们认为有99%以上的可能F2,FGB和FGG这3种蛋白质分子存在相互作用.其中,FGB和FGG蛋白质属于凝血酶.根据最新研究成果,F2蛋白和FGX系列蛋白共同作用,在治疗先天性凝血酶原缺陷症和遗传性纤维蛋白原血症中有重要作用[20].因此,针对蛋白质网络的极大团挖掘分析,可以帮助发现未知的蛋白质作用途径,为生物学实验和药物开发提供方向和指导.对于化合物分子网络的分析可以为化合物性质分析、化学合成提供帮助.序号12ABI1BAIAP2WASF20.9910173ABI1BAIAP2WASL0.98407945DOCK1ELMO1RHOG0.9662496结论本文提出了一种在大规模不确定图上挖掘Page9top-k极大团的并行算法.该算法采用的图划分策略使得我们可以在划分子图上并行地挖掘局部极大团.该算法的子图扩展策略保证了对局部挖掘结果进行合并可以得到正确的全局挖掘结果.实验结果表明,该并行挖掘算法具有很好的执行效率,与传统算法相比显著提高了挖掘效率.
