Page1基于张量的取向估计方法的理论框架邵晓芳李淑华(海军航空工程学院青岛分院山东青岛266041)摘要取向估计的主要目的是计算出图像等多维信号各点的取向信息,在图像处理和机器视觉的底层处理中具有广泛的应用.在总结现有基于张量的取向估计方法的基础上,文中提出了基于张量的取向估计方法的理论框架,并从取向张量的构造这一核心问题入手证明各种基于张量的取向估计方法都可以统一到这一理论框架之下,从而有利于对这类方法进行深入研究或设计更准确的取向估计方法.关键词取向;取向估计;取向张量1引言一般情况下,多维信号是用矢量表示的,而矢量是带有方向性的,对于图像信息而言,这种方向性成为区分多维信号和一维信号的基本特征之一,本文将多维信号所具有的方向性定义为“取向”.首先区分一下取向(orientation)和方向(direction).举例说来,在二维情况下,一条直线有其特定的取向,但是没有唯一确定的方向,矢量具有唯一确定的方向,但是没有取向;在三维空间中的平面也是只有唯一确Page2根据现有的取向估计方法对取向的表示方法不同,可以将这些方法分为基于通道表示的方法、基于自相关函数的方法和基于张量的方法.基于通道表示的方法[1]实际上是选择适当的核函数对信号在不同尺度下的梯度分别作一个映射,然后通过对特定核函数的编解码过程来进行取向估计.基于自相关函数的方法[2]直接计算信号的自相关函数,然后用抛物线拟合自相关函数的一小部分中心值,最后根据所得抛物线的主曲率推导所要估计的取向.基于张量的方法[3-10]用二阶张量表示取向,通过构造取向张量来计算取向信息,算法简单有效,是目前应用最为广泛的一种方法.本文的主要工作是为基于张量的取向估计方法建立统一的理论框架,使得各种基于张量的取向估计方法可以在这一理论框架中得到统一的解释.由于基于通道表示的方法和基于自相关函数的方法只是在取向表示方法和相应的计算过程上与基于张量的方法有所差别,因此本文的理论框架对其它两类方法也具有借鉴意义.2基于张量的取向估计方法根据取向张量的计算方法不同,基于张量的取向估计方法可以进一步细分为梯度张量法[3-6]、多项式张量法[7]和正交张量法[8-10].2.1梯度张量法梯度张量法与以往一些文献中提到的结构张量(structuretensor)的计算方法相同,主要是采用某种微分算子计算图像的灰度梯度,然后根据梯度方向矢量构造张量.具体计算公式如下[5]:式中,狓为矢量空间坐标,w(|狓|)为该点的高斯加权值,f(狓)为该点的梯度.2.2多项式张量法基于多项式张量的方法[7]是采用正则化卷积(normalizedconvolution)的信号分析方法,综合考虑信号的不确定性和信号分析函数,首先选择一组信号分析函数构成一组基,然后通过正则化卷积获得这组基的系数,这组系数与信号的泰勒展开式具有对应关系,最后采用多项式近似构造取向张量.基于多项式张量的方法对信号建立了一个多项式近似框架:式中,狓为待估计信号,犃,犫,犮分别为二次项、一次项和零次项的系数矩阵,基于多项式张量的方法就是通过正则化卷积针对这一信号框架进行取向估计.过多项式近似的框架参数构造张量[7]:多项式张量主要针对式(2)所示的信号框架,通式中,γ为奇偶滤波器之间的加权系数,如果令fmodel表示信号框架,f表示信号,wa表示加权系数,则[犃,犫,犮]=argmin‖fmodel-f‖2算公式分别为犃(狓)=1式中,wa(狓)为归一化的高斯加权函数,且wa(狓)=(2槡πσ)ne-‖狓‖212.3正交张量法基于正交张量的方法一般是设计一组频域正交滤波器,对信号进行滤波,最后根据滤波器组的输出结果构造张量,用于估计取向.正交张量的构造公式如下[8]:式中,狇k为第k个方向的滤波结果,‖狇k‖代表狇k的模值,如果狀k是滤波器引导矢量,则要求{狀k}张成矢量空间的一组基或一组框架,而{狀~对偶基或对偶框架,珦犖k=狀~式中,F(ω)为信号f(狓)的Fourier变换,Hk(ω)为第k个方向的正交滤波器.一般地,式中,ρ为径向函数;d为方向函数;ω^=ω/‖ω‖;狀k是滤波器引导矢量.3理论框架基于张量的取向估计方法进行取向估计的过程可以分解为两个主要步骤:1.构造计算取向信息的张量;2.根据张量计算取向信息.其中,构造计算取向信息的张量是最关键的一步,也Page3是不同方法的主要区别所在.下面首先就张量的构造建立统一的计算框架.3.1张量的构造张量的构造主要是计算表示与取向张量相关的矩阵.本文从正交张量的构造方法中获得启发,对于信号中任一点,根据信号在该点的滤波结果来计算其取向张量.另外,也可以从正交张量的构造中得出取向张量和取向张量矩阵中的各分量之间的关系,即它们的滤波结果是相同的,只是取向张量求和时是乘上相应滤波器引导矢量的对偶矢量构成的张量珦犖k,而取向张量矩阵的各分量乘的是珦犖k中相应的分量.在频域中,信号与滤波器的卷积可以转化为乘积计算,于是,各种取向张量的构造方法可统一用式(9)表示,而其分量可统一用式(10)表示:上式中,S(ω)表示信号项;H(ω)为进行取向估计所选用的滤波器;D(ω)与式(6)中珦犖k的含义相同;Dij(ω)为D(ω)中第i行第j列的分量;∫(·)代表与ω的维数相对应的积分运算.不同的取向张量计算方法主要是滤波器H(ω)的设计以及与滤波器的阶数有关的信号项S(ω)有所差别,但是滤波器均需要具备以下性质:(1)对称性令ω=(ω1,ω2,…,ωn),则H(ω1,ω2,…,ωn)=H(ωn,ωn-1,…,ω1).(2)Hermitian共轭性令ω=(ω1,ω2,…,ωn),则H(-ω1,-ω2,…,-ωn)=H(ωn,ωn-1,…,ω1).(3)张量矩阵的非负性即犜=∫S(ω)·H(ω)·D(ω)dω0.本文将在下一小节通过理论推导证明,基于张量的取向估计方法尽管在具体计算方法上有所差别,但均可统一到这一框架之下.3.2根据张量计算取向信息完成了对图像中各点与取向信息相关的张量的计算,就可以计算相应的取向信息.根据前面分析的取向估计原理,如果该张量是通过梯度张量法求得的,则可对其进行特征值分解,取最小特征值对应的特征向量为信号的取向矢量;如果该张量是通过多项式张量法或者正交张量法求得的,由于此时求得的张量与梯度张量法求得的张量是正交的关系,因而取最大特征值对应的特征向量为信号的取向矢量.进一步,相应的取向角信息可由取向矢量求出.如令取向张量为张量的特征值分解如下式所示:式中,犜为张量,{λk}表示张量矩阵的特征值,{犲^k}为相应的特征矢量,根据张量的计算方法及其特征值分解结果,选择最小或最大特征值对应的特征矢量作为取向矢量,假定犲^k=(e2,k,e1,k)为选取的取向矢量,则相应的取向角为4理论框架的证明下面就通过理论推导证明各种基于张量的取向估计方法可以统一到本文建立的理论框架之中.4.1梯度张量号与高斯微分函数的卷积,即在实际计算过程中,梯度的计算可以转化为信于是,梯度张量的计算结果为犜g=∫w(狓)[(fg)(狓)]·[(fg)(狓)]Td狓=∫∫∫w(狓)[(fg)(狔)]·[(fg)(狕)]T·δ(狓-狔)δ(狓-狕)d狓d狔d狕=∫∫∫w(狓)[(fg)(狔)]·[(fg)(狕)]T·∫∫e-jω1(狓-狔)ejω2(狓-狕)dω1dω=∫∫∫w(狓)e-j狓(ω1-ω2)d狓∫(fg)(狔)ejω1狔d狔·∫[(fg)(狕)]Tejω2zd狕dω1dω2=(2π)-2n∫∫W(ω1-ω2)F(ω1)F(ω2)·G(ω1)G(ω2)ω1ωT2dω1dω2=-(2π)-2n∫∫W(ω1+ω2)F(ω1)F(ω2)·G(ω1)G(ω2)ω1ωT2dω1dω2式中,W(·)、F(·)、G(·)分别为w(·)、f(·)、g(·)Page4的Fourier变换.一般地,式中,σw和σΔ分别为高斯加权函数和高斯微分函数的方差.由式(15)可知,对于梯度张量,H(ω)=-W(ω1+ω2)G(ω2)G(ω2)H(ω1,ω2)由式(20)可知,H(ω1,ω2)满足同时,即滤波器满足对称性和Hermitan共轭性.犜g=∫∫S(ω1,ω2)·H(ω1,ω2)·D(ω1,ω2)dω1dω2=-∫∫W(ω1+ω2)F(ω1)F(ω2)·G(ω1)G(ω2)ω1ωT2dω1dω2=∫∫∫w(狓)e-j狓(ω1-ω2)d狓·F(ω1)F(ω2)G(ω1)G(ω2)ω1ωT2dω1dω2=∫w(狓)∫ω1F(ω1)G(ω1)e-j狓ω1dω1∫ω2F(ω2)G(ω2)e-j狓ω2dω]2d狓(23)令a(狓)=∫ωF(ω)G(ω)e-j狓ωdω,则犜g=∫w(狓)a(狓)a(狓)d狓=∫w(狓)‖a(狓)‖2d狓0由式(24)可知,梯度张量满足非负性.综上,梯度张量的构造方法可以统一到式(9)的理论框架下,且满足滤波器的各项性质.4.2多项式张量局部特性,则式(4)、式(5)可变换为Aij=∫1对多项式张量的构造而言,如果只考虑信号的式中,Aij代表局部信号狓i、狓j的二次项拟合系数,bi表示信号狓i的一次项拟合系数.根据Parseval定理,式(25)、式(26)可以变换为式中,Wa(·)=e-σ2‖·‖2的Fourier变换.于是,Tij=∑k由式(29)可得,在式(10)的统一计算框架下,计算多项式张量的信号项、滤波器项及表示信号方向的分量分别为H(ω)=1于是,由式(31)可知,H(ω1,ω2)满足对称性和Her-mitan共轭性.犜p=∫∫S(ω1,ω2)·H(ω1,ω2)·D(ω1,ω2)dω1dω24∫∫ω2=1γ∫∫ω1ω2Wa(ω1)Wa(ω2)F(ω1)F(ω2)dω1dω24∫∫ω2=1γ∫∫ω1ω2Wa(ω1)Wa(ω2)F(ω1)F(ω2)dω1dω24∫ω2=1γ∫ω1Wa(ω1)F(ω1)dω1∫ω2Wa(ω2)F(ω2)dω2令犪1=∫ω2Wa(ω)F(ω)dω,犪2=∫ωWa(ω)F(ω)dω,则式(34)可以转化为Page5犜p=1因而,对于γ0,犜p0,即多项式张量满足非在式(9)的统一计算框架下,正交张量的计算为负性.4.3正交张量信号在频域中通过一组正交滤波器进行滤波,即犜q=∑k=∑k(2π)n∫‖F(ω)‖∑k=1(2π)n∫‖F(ω)‖∑k=1(2π)n∫‖F(ω)‖ρ()ω∑k=1由式(36)可得,在式(9)的统一计算框架下,对于正交张量:H(ω)·D(ω)=ρ(ω)∑k由式(38)可知,H(ω)满足对称性和Hermitan共轭性.另外,由于正交滤波器H(ω)的一个重要特点就是在半个频域上值为0,一般情况下都令正交滤波器在负半频域上值为0,因而正交张量满足非负性.综上,各种基于张量的取向估计方法均可统一在本文提出的理论框架之下.5正交张量法的改进及实验结果根据前面建立的理论框架可以知道,基于张量的取向估计方法的关键在于滤波器的设计.鉴于正交张量法算法简单、应用广泛,我们选择对这一种方法的滤波器进行了重新的设计,以提高其估计的准确性和鲁棒性.算法改进的主要思想是在正交滤波的基础上进行非线性扩散滤波,也就是将正交滤波器和非线性扩散滤波结合起来构成新的滤波器,由于非线性扩散能够在抑制噪声的同时保持图像原有的特征点,因此这两者结合之后就能够达到我们的设计目的[11].实验方法是应用上述方法对已知取向信息的测试图像进行取向估计得到进行取向估计的平均误差,并添加方差为0.1的高斯噪声比较了方法改进前后对噪声的鲁棒性.这里,测试图像如图1所示,其中图1(a)为原始测试图像(大小为256×256),由各种倾角的直线组成,这里选取对各种倾角的直线进行估计的原因是不同倾角的直线离散化的误差不同,只有某些特定的方向(如水平、垂直和45°方向)不存在离散化误差;图1(b)为测试图1(a)被添加了方差为0.1的高斯噪声的结果.对不同倾角的直线分别计算平均估计误差,可以得到改进后的方法对不同角度的直线进行取向估计与原方法的误差比较曲线,如图2所示.从该图中可以看出,改进措施不但减小了估计误差,而且减小了估计误差的起伏变化幅度.实验中,正交滤波器的参数为B=3,ω0=π平滑函数的方差为σ=0.01,非线性滤波的参数t=20[11].图2本文方法与基于正交滤波的方法的估计误差曲线为测试改进后的方法与原方法相比对噪声的鲁棒性,我们对图1(a)依次添加方差为0~1的高斯噪声,比较了原方法和本文方法分别进行非线性扩散迭代20次、100次的平均估计误差变动曲线.从图3中可以看出,本文的方法减小了噪声对估计精度的影响,而且随着迭代次数t的增加,可以进一步减小估计误差[11].Page6图3对图1(a)添加高斯噪声情况下的估计误差变动曲线6结束语本文在总结分析现有取向估计方法的基础上,建立了基于张量的取向估计方法的理论框架,从而使得现有的基于张量的取向估计方法在此理论框架下得到统一的解释.建立这一理论框架既方便于比较和分析现有的方法,也有利于设计出新的取向估计方法.
