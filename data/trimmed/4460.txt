Page1可证安全的无证书混合签密俞惠芳1),2)杨波1)1)(陕西师范大学计算机科学学院西安710062)2)(青海师范大学计算机学院西宁810008)摘要混合签密能够处理任意长度的消息,而公钥签密则不能.文中将混合签密技术扩展到无证书环境,构建了一个可证明安全的无证书混合签密方案.随机预言模型下,作者证明,所提方案在双线性Diffie-Hellman问题和计算性Diffie-Hellman问题的难解性下,满足自适应选择密文攻击下的不可区分性和自适应选择消息攻击下的不可伪造性.文中方案计算复杂度低,适合于实际应用.关键词无证书密码学;混合签密;可证安全性;双线性对;密码学1引言公钥密码是一种实现网络和信息安全的重要技术.传统公钥密码要求认证机构颁发证书来绑定用户的身份和公钥,这样就带来了证书管理问题.一旦用户量剧增,证书管理问题就会极大地影响系统性能.为了简化证书的管理,降低额外的计算开销,Shamir[1]提出了基于身份的公钥密码学概念.按照Shamir思想,用户不是自己生成公钥和私钥,而是选择其公开身份信息作为公钥,私钥生成中心用这些公开身份信息为用户计算出相应私钥.为了解决身份密码学中的密钥托管问题和传统公钥基础设施中的证书管理问题,2003年的亚密会上Al-RiyamiPage2和Paterson[2]提出无证书密码学,减少了对密钥生成中心(KeyGenerationCenter,KGC)的信任,KGC生成用户的部分私钥,用户的完整私钥由这个部分私钥和用户自己随机选取的秘密值构成,而用户公钥由用户自己计算得出.构造无证书的密码方案[3-5]一直是密码学界感兴趣的研究方向.加密任意长度的消息时,通常的公钥加密限制了其消息空间.Cramer等人[6]构造的混合加密能够实现大消息的保密通信.一个混合加密方案包含两部分:密钥封装机制(KeyEncapsulationMechanism,KEM)和数据封装机制(DataEncapsulationMech-anism,DEM),KEM运用非对称技术加密一个对称密钥,而DEM利用对称技术和这个对称密钥加密任意长度的消息.KEM和DEM是完全独立的两个模块,因而可以被分别研究.混合密码学[7-10]能够顾及到密码学应用中的安全性和高效性,是IND-CCA2安全的公钥密码机制的通用解决方法.2005年,Dent[11-12]将KEM-DEM混合结构扩展到签密环境,提出混合签密的概念.后来,Tan[13]构造了标准模型下的签密KEM和签密tag-KEM.2011年,Sun等人[14]提出了基于身份的多接收者签密KEM.2013年,Li等人[15]给出了一个内部安全的无证书混合签密方案.可以说,设计安全高效的无证书混合签密方案是值得研究的重要问题.本文构造出随机预言模型下可证安全的无证书混合签密(PS-CLHS),PS-CLHS包含一个无证书签密KEM(CertificatelessSigncryptionKEM,CLS-KEM)和一个DEM.PS-CLHS的IND-CCA2安全性和sUF-CMA安全性可规约为双线性Diffie-Hellman问题和计算性Diffie-Hellman问题的难解性.PS-CLHS方案不仅计算复杂度低,而且安全实用.本文第2节介绍双线性映射和一些密码学假设,描述CLS-KEM、DEM和PS-CLHS的定义以及PS-CLHS的安全模型;第3节具体描述本文方案;第4节分析本文方案的安全结果;第5节对本文方案与同类方案进行性能比较;最后一节总结全文.2预备知识2.1双线性映射G1是一个阶为素数q的加法群,G2为相同阶的乘法群.P是G1的本原根.e:G1×G1→G2是具有以下性质的双线性映射.(1)双线性.a,b∈Z(2)非退化性.e(P,P)≠1G2.(3)可计算性.P,Q∈G1,存在一个有效算法ComputationalDiffie-Hellman(CDH)问题.BilinearDiffie-Hellman(BDH)问题.已知(P,计算e(P,Q).2.2复杂性假设aP,bP,cP)∈G1,对于任意未知的a,b,c∈Ze(P,P)abc∈G2.DecisionalBilinearDiffie-Hellman(DBDH)问题.已知(P,aP,bP,cP)∈G1和z∈G2,对于任意未知的a,b,c∈Z成立,ODBDH返回1;否则,ODBDH返回0.已知(P,aP,bP)∈G1,对于任意未知的a,b∈Z算abP∈G1.2.3CLS-KEM[14]一个CLS-KEM方案可以通过下面6个概率多项式时间算法来定义.Setup:这个算法输入安全参数k,输出系统参数params以及主密钥x.Extract-Partial-Private-Key:这个算法输入系统参数params、主控钥x和用户身份ui∈{0,1},输出该用户部分私钥di.Generate-User-Key:这个算法输入用户身份ui∈{0,1},输出秘密值xi和用户公钥Pi.Extract-Private-Key:这个算法输入部分私钥di和秘密值xi,输出完整私钥si=(xi,di).Encap:这个算法输入系统参数params、发送者的身份uA和公私钥对(PA,sA)、接收者的身份uB和公钥PB,输出对称密钥κ和密钥封装.Decap:这个算法输入系统参数params、密钥封装、发送者的身份uA和公钥PA、接收者的身份uB和公私钥对(PB,sB),输出对称密钥κ或表示解封装失败的标志⊥.2.4DEM[15]DEM包含下面两个概率多项式时间算法.Enc:这个算法输入安全参数k、消息m和对称Dec:这个算法输入对称密钥κ和密文c,输出密钥κ,输出密文c.明文m或符号⊥.2.5PS-CLHS成,算法细节如下所述.PS-CLHS由CLS-KEM和DEM两个方案组Setup:与CLS-KEM方案相同.Page3案相同.PB),发送者通过以下步骤生成密文σ.Extract-Partial-Private-Key:与CLS-KEM方Generate-User-Key:与CLS-KEM方案相同.Extract-Private-Key:与CLS-KEM方案相同.Signcrypt:已知(params,uA,uB,m,sA,PA,(1)利用2.3节Encap算法计算(κ,).(2)利用2.4节Enc算法计算密文c.(3)输出σ←(c,).Unsigncrypt:已知(params,uA,uB,σ,sB,PA,(1)利用2.3节Decap算法计算κ.(2)利用2.4节Dec算法恢复消息m.(3)检查验证等式是否成立?若成立,接受明文PB),接收者执行如下步骤.m;否则,输出符号⊥.2.6PS-CLHS的安全模型PS-CLHS方案应该满足IND-CCA2安全性和sUF-CMA安全性.PS-CLHS的安全模型中,我们考虑两类攻击者.第1类攻击者I或I不知道KGC的主控钥,但能够自适应地替换任意用户的公钥.第2类攻击者II或II知道KGC的主控钥,但不具备替换任意用户公钥的能力.定义1.如果任何多项式有界的敌手I和II赢得IND-CCA2-I和IND-CCA2-II的优势是可忽略的,则称一个PS-CLHS方案具有自适应选择密文攻击下的不可区分性.IND-CCA2-I:这是一个挑战者Γ和敌手I之间进行的交互游戏.初始化.Γ运行系统初始化算法产生系统参数params和主控钥x,返回params给I,保留x.阶段1.I在这个阶段进行如下多项式有界次适应性询问.公钥询问:收到任意身份的公钥询问时,Γ运行用户钥生成算法,返回公钥Pi.部分私钥询问:收到任意身份的部分私钥询问时,Γ运行部分私钥提取算法,返回部分私钥di.私钥询问:收到任意身份的私钥询问时,Γ从相关“询问与应答”表中找到含有完整私钥的条目,返回完整私钥si←(xi,di).如果公钥已被替换,不允许I询问秘密值.公钥替换:I可以在指定范围内选择任意值,替换任何用户的公钥.签密询问:收到消息m在发送者身份uA和接收者身份uB下的签密询问时,Γ从相关“询问与应答”表中检索到(sA,PA,PB),并返回σ←Signcrypt(params,uA,uB,m,sA,PA,PB).解签密询问:收到密文σ在发送者身份uA和接收者身份uB下的解签密询问时,Γ从相关“询问与应答”表中检索到(sB,PA,PB),并返回m/⊥←Unsigncrypt(params,uA,uB,σ,sB,PA,PB).挑战.阶段1结束后,I生成两个相同长度的明文m0,m1以及希望挑战的两个身份(uA,uB),这里uA和uB分别是发送者和接收者的身份.阶段1期间,uB的秘密值和部分私钥不能被询问,并且uB不能是公钥已被替换的那个身份.Γ从相关“询问与应答”表中找到(sA,PA,PB),选择γ∈R{0,1},计算σ←Signcrypt(params,uA,uB,mγ,sA,PA,PB),返回挑战密文σ.阶段2.I像阶段1那样进行多项式有界次适应性询问.约束条件是:(1)uB的完整私钥不能被询问;(2)uB不能是公钥已被替换的那个身份;(3)不能对uA和uB下的σ进行解签密询问.猜测.I输出一个猜测γ.若γ=γ,I赢得IND-CCA2-I.我们定义I的获胜优势为IND-CCA2-II:这是一个挑战者Γ和敌手II之间进行的交互游戏.初始化.Γ运行系统初始化算法产生系统参数params以及主控钥x,返回(params,x)给II.阶段1.II在这个阶段进行多项式有界次适应性询问.除了不需要进行部分私钥询问和公钥替换询问之外,公钥询问、私钥询问、签密询问和解签密询问类似于IND-CCA2-I的阶段1.需要注意的是,由于II知道主控钥x,自己能够计算出用户的部分私钥.挑战.阶段1结束以后,II生成两个相同长度的明文m0,m1以及希望挑战的两个身份(uA,uB),这里uA和uB分别是发送者和接收者的身份.阶段1期间,uB的秘密值不能被询问.Γ从相关“询问与应答”表中找到(sA,PA,PB),选择γ∈R{0,1},计算σ←Signcrypt(params,uA,uB,mγ,sA,PA,PB),返回挑战密文σ.阶段2.II像阶段1那样进行多项式有界次适应性询问.约束条件是:(1)uB的秘密值不能被询问;(2)不能对uA和uB下的σ进行解签密询问.猜测.II输出一个猜测γ.若γ=γ,II赢得IND-CCA2-II.我们定义II的获胜优势为Page4间进行的交互游戏.params和主控钥x,返回params给I,保留x.的询问与IND-CCA2-I的阶段1相同.定义2.如果任何多项式有界的伪造者I和II赢得sUF-CMA-I和sUF-CMA-II的优势是可忽略的,则称一个PS-CLHS方案在自适应选择明文攻击下是不可伪造的.sUF-CMA-I:这是一个挑战者Γ和伪造者I之初始化.Γ运行系统初始化算法产生系统参数训练.I进行适应性多项式有界次询问.进行伪造.训练阶段结束的时候,I输出一个伪造(σ,uA,uB).训练期间,I不能询问uA的部分私钥和秘密值,uA不能是公钥已被替换的那个身份.此外,σ不能是来自伪造者对uA和uB下的某个消息m的签密询问的应答.如果不是符号⊥,I赢得sUF-CMA-I.Unsigncrypt(params,uA,uB,σ,sB,PA,PB)I获胜的优势定义为之间进行的交互游戏.params以及主控钥x,返回(params,x)给II.行的询问类似于IND-CCA2-II的阶段1.sUF-CMA-II:这是一个挑战者Γ和伪造者II初始化.Γ运行系统初始化算法产生系统参数训练.II自适应地进行多项式有界次询问.进伪造.训练阶段结束的时候,II输出一个伪造(σ,uA,uB).训练期间,II不能询问uA的秘密值,并且σ不能是来自伪造者对uA和uB下的某个消息m的签密询问的应答.如果不是符号⊥,II赢得sUF-CMA-II.Unsigncrypt(params,uA,uB,σ,sB,PA,PB)II获胜的优势定义为3具体方案3.1Setup令G1和G2分别是素数阶q2k(k是安全参数)的加法群和乘法群,P是G1的一个生成元,e:G1×G1→G2是个双线性映射.KGC定义3个密码学Hash函数:h1:{0,1}→G1,h2:G2h3:{0,1}2×{0,1}n×G3密钥长度.然后,KGC选择x∈RZ算系统公钥Ppub=xP.最后,KGC保密主控钥x,公布系统参数params=(G1,G2,e,P,Ppub,n,h1,h2,h3).3.2Extract-Partial-Private-Key给定params、系统主控钥x和用户身份ui,KGC计算Hi=h1(ui),设置用户的部分私钥di=xHi,并发送(ui,di)给用户.3.3Generate-User-Key给定用户身份ui,该用户随机选择一个秘密值q,计算公钥Pi=xiP.给定部分私钥di和秘密值xi,这个算法设置完xi∈Z3.4Generate-User-Key整私钥si←(xi,di).3.5Signcrypt过以下步骤生成密文.给定(params,uA,uB,m,sA,PA,PB),发送者通(1)选择r∈RZ(2)计算y=e(Ppub,HB)r.(3)计算z=e(PB,HB)r.(4)计算κ=h2(y,z,R).(5)计算c=DEM.Enc(κ,m).(6)计算f=h3(uA,uB,m,R,PA,PB).(7)计算S=rHA+xAf+dA.(8)输出σ=(c,←(R,S)).给定(params,uA,uB,σ,sB,PA,PB),接收者执(1)计算y=e(R,dB).(2)计算z=e(R,HB)xB.(3)计算κ=h2(y,z,R).(4)计算m=DEM.Dec(κ,c).(5)计算f=h3(uA,uB,m,R,PA,PB).(6)验证e(P,S)=e(R,HA)e(PA,f)e(Ppub,3.6Unsigncrypt行以下步骤.HA)是否成立?若成立,接受m;否则,输出⊥.4安全性分析定理1.假如存在一个IND-CCA2-I敌手I经过qi次hi询问(i=1,2,3)、qe1次部分私钥询问、qe2次私钥询问和qr次公钥替换询问后,能以一个不可忽略的优势ε攻破PS-CLHS方案的IND-CCA2-I安全性,则存在一个算法Γ能以优势ε解决BDH问题,这里ε为Page5证明.假设Γ收到一个BDH问题的随机实例(P,aP,bP,cP)∈G1,目标是计算出e(P,P)abc∈G2.为了达到这个目标,Γ将I作为子程序并扮演其挑战者在IND-CCA2-I中与之交互.假设游戏中I询问以身份ui作为输入的其它预言机之前都先用身份ui询问h1预言机.初始化.Γ运行系统初始化算法,返回系统参数(G1,G2,e,P,Ppub=aP,n,h1,h2,h3)给I.为了避免对I的询问的非连续应答,Γ维护起初为空的4张列表L1~L3与Lk.阶段1.I进行多项式有界次适应性询问.h1询问:I选择一系列身份询问相应Hash值.接收到身份ui的h1询问时,若L1中含有(ui,Hi,li),Γ返回Hi作为应答;否则,Γ随机选择一个整数α∈[1..q1],将uα作为挑战身份但不会泄露α的值给I.如果接收到的是第α次询问,Γ设置Hi=bP,返回Hi,添加(ui,Hi,-)到L1.如果接收到的不是第α次询问,选择一个随机数li∈Z加(ui,Hi,li)到L1.h2询问:接收到h2询问时,Γ检查L2中是否含有元组(y,z,R,κ).若有,返回对称密钥κ;否则,返回任意的κ∈{0,1}n,添加(y,z,R,κ)到L2.h3询问:接收到h3询问时,Γ检查L3中是否含有元组(uA,uB,m,R,PA,PB,υ,f).若有,返回f;否则,Γ选择一个随机数υ∈Z(uA,uB,m,R,PA,PB,υ,f)到L3.公钥询问:收到身份ui的公钥询问时,Γ检查Lk中是否含有条目(ui,di,xi,Pi).若有,Γ返回公钥Pi;否则,选择一个随机数xi∈Z返回公钥Pi,添加(ui,-,xi,Pi)到Lk.部分私钥询问:收到身份ui的部分私钥询问时,Γ检查是否ui=uα.若相等,Γ放弃游戏;否则,Γ调用h1预言机得到li,设置di=liaP,返回部分私钥di,以(ui,di,xi,Pi)更新Lk.私钥询问:收到身份ui的私钥询问时,Γ检查是否ui=uα.若相等,Γ放弃游戏;否则,Γ从Lk中获得(ui,di,xi,Pi),返回完整私钥si←(di,xi).公钥替换:I在指定范围内选择一个随机数Pi替换身份ui的公钥Pi.若ui=uα,Γ放弃游戏;否则,Γ以(ui,di,-,Pi)更新Lk.签密:收到消息m在发送者身份uA和接收者身份uB下的签密询问时,Γ检查是否uA≠uα.若是,Γ正常执行签密算法,返回运行结果;否则,Γ从Lk检索到(xB,dB,PA),并按下面方式生成密文.到L3.(1)选择r,υ∈RZ(2)计算y=e(R,dB).(3)通过L1得到lB,计算z=e(R,lBP)xB.(4)计算κ=h2(y,z,R),添加(y,z,R,κ)到L2.(5)计算c=DEM.Enc(κ,m).(6)计算f=υP,添加(uA,uB,m,R,PA,PB,υ,f)(7)通过L1得到HA=bP,计算S=rHA+υPA.(8)返回σ=(c,←(R,S)).正确性:e(R,HA)e(PA,f)e(Ppub,HA)=e(rP-aP,bP)e(xAPA,υP)e(aP,bP)=e(P,rbP-abP)e(P,υPA)e(P,abP)=e(P,rHA+υPA)=e(P,S).解签密:收到密文σ在发送者身份uA和接收者身份uB下的解签密询问时,Γ检查是否uB≠uα.若是,Γ正常运行解签密算法,返回运行结果;否则,Γ从Lk检索到(xB,PA),并做出如下应答.(1)通过L1得到HB=bP,计算z=e(R,HB)xB.(2)寻找不同y值的元组(y,z,R,κ),使得询问(Ppub,HB,R,y)时ODBDH返回1.如果这种情况发生,计算κ=h2(y,z,R).(3)计算m=DEM.Dec(κ,c).(4)通过调用h3预言机获得f,然后检查等式e(P,S)=e(R,HA)e(PA,f)e(Ppub,HA)是否成立?若成立,接受m;否则,输出⊥.挑战.阶段1结束后,I生成两个相同长度的明文m0,m1以及希望挑战的两个身份(uA,uB),这里uA和uB分别是发送者和接收者的身份.阶段1期间,uB的秘密值和部分私钥不能被询问,并且uB不能是公钥已被替换的那个身份.若uB≠uα,Γ放弃游戏;否则,Γ从Lk找到(PA,xA,dA,xB),并按下面方式计算挑战密文.到L2.(1)设置R=cP,选择υ∈RZ(2)通过L1得到HB=bP,计算z=e(R,HB)x(3)计算κ1=h2(y,z,R),添加(y,z,R,κ1)(4)选择任意的κ0∈κPS-CLHS与γ∈{0,1}.(5)计算c=DEM.Dec(κγ,mγ).(6)计算f=υP,添加(uA,uB,mγ,R,PA,Page6PB,υ,f)到L3.(7)通过L1得到lA,计算S=lAcP+xAf+dA.(8)返回σ=(c,←(R,S)).阶段2.I像阶段1那样进行多项式有界次适应性询问.询问期间,uB的秘密值和部分私钥不能被询问,uB不能是公钥已被替换的那个身份,并且不能对uA和uB下的σ进行解签密询问.猜测.L2中储存了q2个Hash值,Γ从L2中随机均匀地选择y,输出作为BDH问题实例的解答.y=e(Ppub,HB)r=e(aP,bP)c=e(P,P)abc概率分析.现在来分析Γ得到BDH问题实例解答e(P,P)abc的成功概率.Γ在不放弃游戏的情况下才能解决BDH问题,而它放弃游戏是由于下面4个事件.事件1.I询问了挑战身份uα的部分私钥,这事件2.I询问了挑战身份uα的秘密值,这个个事件发生的概率为qe1/q1.事件发生的概率为qe2/q1.件发生的概率为qr/q1.是挑战身份uα,这个事件发生的概率为事件3.I替换了挑战身份uα的公钥,这个事事件4.I在挑战阶段所选择的接收者身份不于是,Γ不放弃游戏的概率为1-qe1q()11-qe2q()1ε1-qe1q()11-qe2q()1Γ均匀随机地从L2中选择y的概率是1/q2.因此,Γ解决BDH问题的优势ε为定理2.假如存在一个IND-CCA2-II敌手II经过qi次hi询问(i=1,2,3)和qe2次私钥询问后,能以一个不可忽略的优势ε攻破PS-CLHS方案的IND-CCA2-II安全性,则存在一个算法Γ能以优势ε解决BDH问题,这里ε为证明.假设Γ收到一个BDH问题的随机实例(P,aP,bP,cP)∈G1,目标是计算出e(P,P)abc∈G2.为了能够得到BDH问题实例的解答,Γ扮演II的挑战者并把II作为子程序与之在IND-CCA2-II中进行交互.假设游戏中II询问以身份ui作为输入的其它预言机之前都先用身份ui询问h1预言机.初始化.Γ运行系统初始化算法,发送主控密钥x和系统参数(G1,G2,e,P,Ppub,n,h1,h2,h3)给II.为了记录相关预言机的询问与应答,Γ维护起初为空的4张列表L1~L3与Lk.阶段1.II自适应地进行多项式有界次询问.h1询问:II选择一系列身份询问相应Hash值.接收到身份ui的h1询问时,若L1中含有(ui,Hi,li),Γ返回Hi;否则,Γ随机选择整数α∈[1..q1],将uα作为挑战身份但不会泄露α的值给II.若接收到的是第α次询问,Γ设置Hi=bP,返回Hi,添加(ui,Hi,-)到L1.若接收到的不是第α次询问,选择li∈RZh2询问:接收到h2询问时,Γ检查L2中是否含有元组(y,z,R,κ).若有,返回对称密钥κ;否则,返回任意的κ∈{0,1}n,添加(y,z,R,κ)到L2.h3询问:接收到h3询问时,Γ检查L3中是否含有元组(uA,uB,m,R,PA,PB,f).若有,返回f;否则,Γ选择一个随机数υ∈Z(uA,uB,m,R,PA,PB,f)到L3.公钥询问:II选择一个身份ui并询问这个身份的公钥.若ui=uα,Γ设置Pi=aP,返回公钥Pi,添加(ui,-,-,Pi)到Lk;否则,Γ选择xi∈RZPi=xiP,添加(ui,-,xi,Pi)到Lk,返回公钥Pi.私钥询问:接收到身份ui的私钥询问时,Γ检查是否ui=uα.若相等,Γ放弃游戏;否则,Γ从L1/Lk找到li/(ui,-,xi,Pi),返回秘密值xi,以(ui,xliP,xi,Pi)更新Lk.II知道主密钥x,自己能计算出用户的部分私钥.签密:收到消息m在发送者身份uA和接收者身份uB下的签密询问时,Γ检查是否uA≠uα.若是,Γ正常执行签密算法,返回运行结果;否则,Γ从Lk检索到(xB,dB,PA),接着按下面方式生成密文.(1)选择r,υ∈RZ(2)计算y=e(R,dB).(3)通过L1检索到lB,计算z=e(R,lBP)xB.(4)计算κ=h2(y,z,R),添加(y,z,R,κ)到L2.(5)计算c=DEM.Enc(κ,m).(6)计算f=υP,添加(uA,uB,m,R,PA,PB,υ,f)(7)通过调用h1预言机得到HA=bP,计算S=到L3.Page7rHA+υPA+xHA.(8)返回σ=(c,←(R,S)).正确性:解签密:收到密文σ在发送者身份uA和接收者uB下的解签密询问时,Γ检查是否uB≠uα.如果是,Γ正常运行解签密算法,返回运行结果;否则,Γ从Lk检索到(PB,PA),按下面方式做出响应.(1)通过Lk调用h1预言机得到HB=bP,计算y=e(R,bP)x.(2)寻找不同z值的元组(y,z,R,κ),使得询问(PB,HB,R,z)时ODBDH返回1.如果存在这样一个元组,计算κ=h2(y,z,R).(3)计算m=DEM.Dec(κ,c).(4)通过h3预言机得到f,然后检查等式e(P,S)=e(R,HA)e(PA,f)e(Ppub,HA)是否成立?若成立,接受m;否则,输出⊥.挑战.阶段1结束后,II生成两个相同长度的明文m0,m1以及希望挑战的两个身份(uA,uB),这里uA和uB分别是发送者和接收者的身份.阶段1期间,uB的秘密值不能被询问.如果uB≠uα,Γ放弃游戏;否则,Γ从Lk检索到(xA,dA),并按下面方式计算挑战密文.κ1)到L2.υ,f)到L3.(1)设置R=cP,随机选择υ∈Z(2)通过L1得到HB=bP,计算y=e(R,HB)x.(3)计算κ1=h2(y,z,R),添加(y,z,R,(4)选择任意的κ0∈κPS-CLHS与γ∈{0,1}.(5)计算c=DEM.Enc(κγ,mγ).(6)计算f=υP,添加(uA,uB,mγ,R,PA,PB,(7)通过L1得到lA,计算S=lAcP+xAf+dA.(8)计算S=lAcP+υxAP+dA.(9)返回σ=(c,←(R,S)).阶段2.II像阶段1那样进行多项式有界次适应性询问.询问期间,uB的秘密值不能被询问,并且不能对uA和uB下的σ进行解签密询问.机均匀地选择z,输出猜测.L2中储存了q2个Hash值,Γ从L2中随z=e(PB,HB)r=e(aP,bP)c=e(P,P)abc作为BDH问题实例的解答.概率分析.现在来分析Γ得到BDH问题实例解答e(P,P)abc的成功概率.Γ在不放弃游戏的情况下才能得到DBH问题实例的解答,而放弃游戏是由于下面两个事件.事件1.II询问了挑战身份uα的秘密值,这个事件发生的概率为qe2/q1.是挑战身份uα,这个事件发生的概率为事件2.挑战阶段,II所选择的接收者身份不于是,Γ不放弃游戏的概率为1-qe2q()1Γ随机均匀地从列表L2中选择z的概率是1/q2.因此,Γ解决BDH问题的概率为定理3.假如存在一个sUF-CMA-I伪造者I经过qi次hi询问(i=1,2,3)、qe1次部分私钥询问、qe2次私钥询问和qr次公钥替换询问后,能以不可忽略的优势ε伪造PS-CLHS方案的一个密文,则存在一个算法Γ能以优势ε解决CDH问题,这里ε为2()k1-qe1q()11-qe2q()1ε-1证明.假设Γ收到一个CDH问题的随机实例(P,aP,bP)∈G1,目的是计算abP∈G1.为了得到CDH问题实例的解答,Γ扮演I的挑战者并将它作为子程序与之在sUF-CMA-I中进行交互.假设游戏中I询问以身份ui作为输入的其它预言机之前都先用身份ui询问h1预言机.初始化.Γ运行系统初始化算法,将系统参数(G1,G2,e,P,Ppub=aP,n,h1,h2,h3)发送给I.为了保证对各个预言机询问的连续应答,Γ维护起初为空的4张列表L1~L3与Lk.训练.I进行适应性多项式有界次询问.进行的询问与IND-CCA2-I中的阶段1相同.伪造.训练结束的时候,I输出一个伪造(σ,uA,uB),这里R=Ppub.训练期间,uA的完整私钥不能被询问,uA不能是公钥已被替换的那个身份,并且σ不能是来自伪造者对uA和uB下的某个消息m的签密询问的应答.若uA≠uα,Γ放弃游戏;否则,Γ通过Lk得到PA,调用h1预言机和h3预言机得Page8到HA=bP和υ,输出abP=(S-υPA)/2作为CDH问题实例的解答.原因如下:e(P,S)=e(R,HA)e(PA,f)e(Ppub,HA)概率分析.现在我们来评估Γ解决CDH问题的成功概率.参考定理1,可得:(1)I询问了挑战身份uα的部分私钥的概率为qe1/q1;(2)I询问了挑战身份uα的秘密值的概率为qe2/q1;(3)I替换了挑战身份uα的公钥,这个事件发生的概率为qr/q1;(4)I在训练阶段所选择的接收者身份不是挑战身份uα的概率为于是,Γ不放弃游戏的概率为1-qe1q()11-qe2q()11/2k.因此,Γ解决CDH问题的概率是2()k1-qe1q()11-qe2q()1ε-1I猜测相关h3预言机的相应Hash值的概率是定理4.如果存在一个sUF-CMA-II伪造者II经过qi次hi询问(i=1,2,3)以及qe2次私钥提取询问后,能以一个不可忽略的优势ε伪造PS-CLHS方案的一个密文,则存在一个算法Γ能以概率ε解决CDH问题,这里ε为证明.假设Γ收到一个CDH问题的随机实例(P,aP,bP)∈G1,其目标是得到CDH问题实例的解答abP∈G1.为此,Γ将II作为子程序并扮演其挑战者在sUF-CMA-II中与之进行交互.假设在游戏中II询问以身份ui作为输入的其它预言机之前都先用身份ui询问h1预言机.初始化.Γ运行系统初始化算法,将系统参数(G1,G2,e,P,Ppub,n,h1,h2,h3)和主控钥x发送给II.为了避免对各个预言机询问的非连续应答,Γ维护起初为空的4张列表L1~L3与Lk.训练.II在这个阶段进行适应性多项式有界次询问.除了h1询问和h3询问之外,其余询问与IND-CCA2-II的阶段1相同.h1询问:收到身份ui的h1询问时,Γ检查L1中是否存有(ui,Hi,li).若有,Γ返回Hi;否则,Γ选择q,返回Hi←liP,以(ui,Hi,li)更新L1.li∈RZh3询问:接收到h3询问时,Γ检查L3中是否含有元组(uA,uB,m,R,PA,PB,υ,f).若有,返回f;否则,Γ选择一个随机数υ∈Z(uA,uB,m,R,PA,PB,υ,f)到L3.伪造.训练结束的时候,II输出一个伪造(σ,uA,uB).训练期间,uA的秘密值不能被询问,并且σ不能是来自伪造者对uA和uB下的某个消息m的签密询问的应答.若uA≠uα,Γ放弃游戏;否则,Γ调用h1预言机和h3预言机得到lA和υ,通过Lk获得dA,输出abP=(S-lAR-dA)/υ作为CDH问题实例的解答.原因如下:e(P,S)=e(R,HA)e(PA,f)e(Ppub,HA)概率分析.现在我们来评估Γ得到CDH问题实例解答的成功概率.参考定理2,可得:(1)II询问了挑战身份uα的秘密值的概率是qe2/q1;(2)II在训练阶段所选择的接收者身份不是挑战身份uα的概率是于是,Γ不放弃游戏的概率为II猜测相关h3预言机的相应Hash值的概率是1/2k.因此,Γ解决CDH问题的概率是5效率分析本节通过计算开销和通信开销对PS-CLHS方案和同类方案[15-16]的计算复杂性进行比较.比较中主要考虑3种运算:G2上的双线性对运算x1、G1上的点乘运算x2以及G1上的指数运算x3.|r|表示有q中一个元素的长度,|G1|表示G1上一个元限域z素的长度,密文长度表示通信开销.表1中没有考虑双线性对预运算.方案文献[15]方案040110n+2|G1|文献[16]方案110110n+|r|+|G1|PS-CLHS030100n+2|G1|Page9相对于点乘运算来说,对运算和指数运算比较耗时[17].从表1可以看出,除了密文长度与同类方案大致得当外,PS-CLHS方案在签密阶段执行了3次G1上的标量乘操作,在解签密阶段执行了1次G2上的对操作.总体来说,PS-CLHS方案具有较低的计算复杂性.6结语本文给出了一个可证明安全的无证书混合签密方案.在随机预言模型下以及BDH问题和CDH问题的困难性假设下,我们证明该方案是IND-CCA2安全的和sUF-CMA安全的.所提方案计算效率高、通信成本低,适合应用于电子支付、移动通信、密钥管理、EDI、防火墙、电子商务等领域.
