Page1网络协同取证计算研究张有东1),2),3)曾庆凯1),2)王建东4)1)(南京大学计算机软件新技术国家重点实验室南京210093)2)(南京大学计算机科学与技术系南京210093)3)(淮阴工学院计算机工程系江苏淮安223003)4)(南京航空航天大学信息科学与技术学院南京210016)摘要网络取证面临着复杂多样的网络入侵环境,尤其是对于复合攻击的取证,为此提出了网络协同取证计算新概念.通过对传统的函数依赖关系理论的扩展,提出了以一定概率相依赖的概率函数依赖关系及其分析方法与算法,进而结合贝叶斯网络理论、报警关联分析技术和对K2算法的改进,提出了一种网络协同取证分析算法,算法通过对元报警事件的聚类和综合不同的网络取证数据源,能够直观地再现复杂网络攻击的犯罪场景,有效地实现网络取证分析;而且即使在部分数据缺失情况下,算法也可推理攻击的发生过程.关键词协同取证;复合攻击;概率函数依赖;贝叶斯网络;犯罪场景1引言对于复杂的网络入侵,其攻击行为往往是分步、多变或综合的,对其入侵行为的认定需要对不同网络安全设施获取的信息进行关联分析,才可能重构入侵者的入侵过程,获得其犯罪证据.事实上,对于复杂的案件,法律上更关注证据之间的关联性,对于计算机网络犯罪而言,有因果关系的、相互确证的多个独立证据之间的关联也有利于重建攻击过程.定义1.协同取证(coordinativeforensics)计算是指从目标系统所有可利用资源中发现、关联、解释、分析信息,以确定证据因果关系、再现网络犯罪场景的过程并形成证据链,从而支持法庭举证.网络取证系统需要保存大量的不同来源的数据,这些保存的数据并不直接等同于举证证据,一般地可以认为是一种疑似证据,协同取证计算是一种事后取证分析,是通过对保存的疑似证据的分析,再现(重构)攻击的场景(或犯罪场景),从中发现真正的犯罪证据.在入侵检测技术的研究中,已经提出了对攻击场景的构建问题及报警关联分析技术.本文从对报警关联分析技术研究着手,提出了一种基于贝叶斯网络(BayesianNetwork,BN)的协同取证计算算法CFA,CFA的核心思想是通过概率函数依赖关系分析,对K2算法的先验假设进行改进,并将无丢失数据处理的K2算法扩展到对不完整数据的处理,使之适用于网络电子证据的分析.CFA可以综合多方数据源,实现犯罪场景(crimescenario)再现.2报警关联分析技术2000年第一次大规模的DDoS攻击引发了对报警关联(alertcorrelation)分析技术的研究,并受到越来越多的关注.报警关联指对入侵报警信息进行组合、解释和分析,以识别攻击和进行攻击场景重构.入侵报警信息可以是来自同一个IDS的,也可以是来自不同的IDS甚至异构的IDS.报警关联分析起初主要是对来自于同一个IDS产生的报警(消息),通过报警属性值之间的相似性对报警进行聚类,使得每个聚类的报警集合具有某些相同的特性[1].这种方法不能完全揭示相关报警之间的因果联系,无法进行入侵的意图识别和入侵行为预测.为此,研究者提出了复合攻击的概念,认为一些复杂的攻击是由若干单步攻击按照一定的逻辑关系、在特定的时间和空间形成的一个攻击序列,这里的每个单步攻击是指一个独立的、不可分割的攻击行为,而综合多个原始报警或其它元报警所产生的报警,称为超报警事件或元报警事件(HyperAlertEvent或MetaAlertEvent)[2],超报警概念的提出有利于构造层次化的报警聚合与关联.在此基础上,研究者又提出了入侵事件关联方法[3],将每个入侵检测传感器产生的、由于入侵行为而引发的报警称为一个事件.入侵事件关联是对单个或多个IDS的传感器产生的事件进行再组织和再分析以发现攻击行为的过程.报警事件关联扩大了IDS的检测范围,尤其是在大型的交换式网络系统中.目前已经提出了许多报警关联算法,对于大型网络上的复杂的攻击,研究者提出了用图示的方法来表示一个攻击的过程从而再现攻击,一些研究论文称之为攻击场景(attackscenario)[4]或攻击图[5]的重构.但实际上这类算法主要是基于融合技术产生超报警,并构造超报警的关联图,而所谓的场景也就是指此关联图,它并不等同于网络取证所要求的原始的攻击现场.文献[6]从网络取证的需求出发,提出了通过证据图进行网络取证分析的方法,该方法将整个系统分为攻击者(attacker)、受害者(victim)、跳板主机(steppingstone)和后台攻击者(backgroundattacker)4类角色,首先对报警事件进行时序聚类,然后将聚类结果用图示的方法表示,即表示为证据图,最后在专家干预下,在证据图上进行推理取证,这实际上是一种将攻击事件聚类后可视化的方法.3协同取证计算基本思想如前所说,现代网络攻击大多数不是孤立的行为,往往是经过多个单步攻击后才能完成的一种复合攻击.如图1表示的一个实际攻击过程[7],该过程分为5个步骤:地址探测、端口扫描、获取口令文件、口令破解和登录系统.图中每个节点代表某种攻击方式,攻击的每一步都有多种方式可供选择,攻击者只要成功地使用其中一种即可实施该步攻击.对这种复合攻击的取证是对网络取证提出的新的挑战,现有网络取证技术还没有涉及对该问题的研究.图1反映的是一个因果关系图,但是要发现这个因果关系图,需要在海量的信息中进行因果数据Page3挖掘.然而数据挖掘算法大都是对事物间的统计关联关系的挖掘,如关联规则挖掘、聚类、分类等,都没图1一个复合攻击实例因果贝叶斯网络学习理论的发展为因果知识发现的研究提供了契机,基于因果贝叶斯网络学习理论的知识发现能够进一步获得对事物的因果本质的认识,是对统计数据的更高层次的因果知识的发现.分析图1,它实际上是一个典型的包含隐藏变量的因果贝叶斯网络,在前3步攻击之间都可以认为是隐藏了隐藏变量L1、L2和L3(图略).本文所提出的CFA算法是基于贝叶斯网络进行因果分析的协同取证计算方法,它通过对综合多个原始报警或其它元报警所产生的元报警事件的分析,生成元报警贝叶斯网络,从而反映更高层次的因果知识,实现犯罪场景的重构与事后取证.算法的基本步骤为1.数据预处理,对不同证据源的原始事件经过预处理转换为统一的标准报警数据格式IDMEF,形成标准原始事件;2.对标准原始事件聚类形成元事件;3.用贝叶斯网络对元事件进行因果分析;4.重构攻击场景.下面将分析CFA算法的理论基础与核心组成.4贝叶斯网络基本原理4.1贝叶斯网络模型贝叶斯网络最早是由Pearl提出的,它模拟人的认知思维推理模式,用一组条件概率函数以有向无环图(directedacyclicgraph)形式表示因果推理模型.它由两部分组成:(1)贝叶斯网络结构(G).G的每个节点代表对象的一个属性变量,变量可以是离散的或连续的;G的每条弧代表一个概率依赖关系.(2)每个变量对应的条件概率分布(CPD).当变量有涉及到事物之间的底层因果结构.为离散变量时,常用条件概率表(CPT)来表示.考虑离散变量的情况,设有n维训练数据集Ξ,V={V1,V2,…,Vk}是贝叶斯网络中的节点,离散变量Vi的vi个状态对应于vi种可能的模型结构,用p(vi)表示其概率分布,变量Vi的CPT说明条件分布p(Vi|Ξ).对于每一种模型结构vi,存在一个连续向量值变量θvi,其中θvi值对应的是可能模型的真实参数.对于θvi,使用概率密度函数p(θvi|vi)进行编码.则对每个vi和θvi使用贝叶斯规则计算其后验概率分布如下:Vj的双亲(父节点),Vj是Vi的后继.定义2.如果一条弧由节点Vi到Vj,则Vi是假设1.条件独立性假设:给定双亲,假设贝叶斯网络的每个变量条件独立于图中的非后继,即图中的每个节点Vi条件独立于由Vi的双亲节点给定的Vi的非后代节点构成的任何节点子集.设A(Vi)是图中非Vi后代节点的任何节点集合,设Pa(Vi)是图中Vi的直接双亲,则p(vi|A(Vi),Pa(Vi))=p(vi|Pa(Vi)).定义3.一个贝叶斯网络定义为一个三元组(G,Ξ,P),这里G=(V,E)是一个具有节点V={V1,V2,…,Vk}和弧E的有向无环图,P表示概率分布,Ξ为实例空间.应用链规则以及Markov条件,根据假设1,得到贝叶斯网络中所有节点的联合概率如下:Page4p(V1,V2,…,Vk)=∏k贝叶斯网络可表示事件的因果关系,其连接节点的弧表达了两个节点间的直接的因果影响,它也可被看作是拥有许多不同组合的一个抽象知识库.所谓因果贝叶斯网络就是指具有因果关系的贝叶斯网络,网络中的每个节点的父节点被解释为该节点相对于模型中其它节点的直接原因[8].贝叶斯网络模型的假定避免了搜索贝叶斯网络结构的问题,尽管这个强限制假定不是很现实,然而大量的实验表明,即使在违背这种独立性假定的条件下,它仍能表现出很好的健壮性.定义4.没有双亲节点的节点V,概率不以其它节点为条件,p(V)称为该节点的先验概率.为了计算给定因果贝叶斯网络的联合概率,需要知道先验概率和以双亲节点为条件的每个节点的条件概率函数.因此,一个随机变量集合的概率的一个完整说明涉及到这些变量的一个贝叶斯网络及网络中每个变量的CPT.4.2贝叶斯网络学习学习一个贝叶斯网络的问题是寻找一个网络,包括DAG结构和DAG中每个节点的概率分布或CPT,它能最好地匹配一个数据训练集Ξ,Ξ是所有变量值的实例集合.在学习和训练贝叶斯网络时,网络结构可以由领域专家预先给定,这种情况下贝叶斯网络的学习问题变得比较容易,否则需要由训练数据导出,理论上讲,训练得出的模型是实际贝叶斯网络的一个同构图,因此,训练本身是一个不断渐进的学习过程.另外,网络变量可能是可见的,也可能隐藏在所有或某些训练样本中,还可能是缺失的.根据统计学领域对多变量联合概率分布的近似分解方法,贝叶斯网络的学习可分为基于评价与搜索和基于独立性检验两大类算法[9].基于评价与搜索的典型算法是Cooper等提出的K2算法[10],K2算法在给定节点顺序先验信息的情况下,利用贝叶斯概率作为标准来评价模型与数据的符合程度,通过不断向网络中增加边的贪婪搜索方法找到最佳网络结构.5CFA核心算法分析5.1网络结构学习的K2算法[10]设Z是数据库D的变量集,BS表示仅包含在Z中的变量的任意一个贝叶斯网络结构,BSi和BSj是两个包含Z中变量的贝叶斯网络结构.用πi表示xi的双亲,用ωij指明在πi中变量的值的第j个唯一的实例(相对于D中案例的顺序),则有P(BS,D)=∫BP这里BP的值表示与贝叶斯网络结构BS相关联的条件概率分配,f是给定BS后作用于BP的条件概率密度函数.假设2.给定贝叶斯网络模型,数据库中的一条记录独立地发生.根据此假设,有P(BS,D)=∫BP∏m[这里的m是D中的案例数,Ch是D中的第h个案例.定理1.设Z为n个离散变量集,Z中的一个变量xi有ri个可能的值(νi1,…,νiri).设D为具有m个案例的数据库,每个案例包含对Z中每个变量的一个赋值.设BS表示仅包含在Z中变量的一个贝叶斯网络结构,BS中的每个变量xi有一个双亲用πi表示,用ωij指明在πi中相对于D的变量的值的第j个唯一的实例.假设πi中有qi个这样的唯一实例,定义Nijk为D中案例的数量,变量xi有值vik,并且πi被实例化为ωij,设则P(BS,D)=P(BS)∏nK2算法寻求最大P(BS,D)的网络结构,但作为节点数目的函数,可能的结构呈指数增长[11],显然,穷举所有可能的结构在大多数情况下是不可行的.为此,下文将提出一种基于概率函数依赖关系分析的方法,对变量集进行约简,然后通过启发式方法,搜索适合的贝叶斯网络结构.5.2概率函数依赖关系分析通常,人们对数据集中属性的函数依赖关系会有一些先验的认识,函数依赖关系是数据库规范化理论的重要内容,已形成比较成熟的理论体系,应用规范化理论,可以极大地提高对数据库数据分析的效率.Page5下面我们将提出一种概率函数依赖的方法,相对于概率函数依赖而言,上述函数依赖可以认为是分布概率为1的概率函数依赖关系.定义5.设有关系模式R(U),X和Y是属性变量集U的子集,概率函数依赖是形为X→PY的一个命题,只要r是R的当前关系,对r中任意两个实例t和s,都有t[X]=s[X]以概率P蕴涵t[Y]=s[Y],那么,概率函数依赖X→PY在关系模式R(U)中成立.其中,t[X]表示实例t在属性变量集X上的值;实例概念等同于数据库理论中的元组,另外,为叙说方便,前文中的变量在本节用属性变量表示.定义6.设F是概率函数依赖集,被F逻辑蕴涵的概率函数依赖全体构成的集合,称为概率函数依赖集F的闭包(clouser),记为F+.定理2.如果A1,…,An是关系模式R的属性变量集合,那么X→PA1,…,An成立的充分必要条件是X→PAi(i=1,2,…,n)成立.定义7.设F是属性变量集U上的概率函数依赖集,X是U的子集,那么(相对于F)属性变量集X的闭包X+表示从F集使用概率函数依赖推理规则推出的所有满足X→PAi的属性变量Ai的集合:量闭包X+.算法1.求属性变量集合X关于F的属性变输入:关系模式R的全部属性变量集合U,在U上的概输出:关于F的属性变量闭包X+1.i=0,X(i)=X;2.在F中寻找尚未用过的左边是X(i)的子集的概率函数依赖:在Zj中寻找X(i)中未出现过的属性变量集合A,令X(i+1)=X(i)A,若无这样的A,则转步4.3.判断是否有X(i+1)=X(i),若是,则转步4;否则转步2.等价情况:4.输出X(i),即为X+.算法中,对于步3的计算停止条件,有以下4种(1)X(i+1)=X(i);(2)当发现X(i)包含了全部属性变量时;找不到X(i)中未出现过的属性变量;变量已没有X(i)的子集;(3)在F中的概率函数依赖的右边属性中再也(4)在F中未用过的概率函数依赖的左边属性定义8.如果关系模式R(U)上的两个概率函数依赖集F和G,有F+=G+,则称F和G是等价的概率函数依赖集,记作F≡G.定义9.设F是属性变量集U上的概率函数依赖集,如果Fmin是F的一个最小的概率函数依赖集,那么Fmin应满足下列4个条件:(1)F+min=F+;(2)每个概率函数依赖的右边都是单属性变量;(3)每个概率函数依赖的左边没有冗余的属性变量(即F中不存在这样的概率函数依赖XP→1Y,X有真子集W使得F-{XP→1Y}∪{WP→2Y}与F等价).(4)Fmin中没有冗余的概率函数依赖(即F中不存在这样的函数依赖XP→1Y,使得F与{F-{XP→1Y}}等价).小的概率依赖集Fmin,且F≡Fmin.显然,每个概率函数依赖集F至少存在一个最算法2.求概率函数依赖集的最小的概率函数依赖集.输入:一个概率函数依赖集F输出:F的一个等价最小的概率依赖集Fmin1.应用分解规则,使F中每一个依赖的右部属性变量单一化.2.逐个检查F中左部是非单属性变量的依赖,去掉各依赖左部冗余的属性变量.3.去掉冗余的依赖.即从第一个依赖开始,从F中去掉它(假设该依赖为XP→1Y),然后在剩下的依赖中求X+,看X+是否包含Y,若是,则去掉XP→1Y;若不包含Y,则不能去掉XP→1Y.根据以上的分析,当已知数据库D的先验概率函数依赖关系F时,就可以根据算法1和2得到最小的概率函数依赖集F+,这样,非集合中的属性变量不可能作为集合中属性变量的双亲节点,这就大大降低了贝叶斯网络学习的计算复杂性.事实上,先验概率函数依赖关系在很多情况下是存在的,如通过数据挖掘方法得到的关联规则集合就蕴含了一个概率函数依赖关系集合.Page65.3启发式搜索方法通过对D的概率函数依赖关系分析,能够对所有的n个变量指定一个顺序,这样,如果在顺序中xi先于xj,则不允许结构中有一条弧从xj到xi,非集合F+中的变量不可能是集合中变量的双亲节点.给定这样一个顺序作为约束,如果顺序变量包括了所有n个变量,则有2n()2=2n(n-1)/2个可能的贝叶斯网络结构.当n较大时,应用等式(6)对2n(n-1)/2个中的每个可能的结构进行计算还是很难实现的,因此,除节点顺序外,假设在观察到数据D之前,BS等优先级,则可得到P(BS,D)=c∏n对于每个BS,这里c是先验概率P(BS)常量,最大化等式(7),只需要发现每个变量的双亲集合,最大化乘积的第2项,有maxBS这里在等式(8)右边,最大化发生在xi的双亲πi的每个实例.为了最大化P(BS,D),可用一种贪婪搜索(greedy-search)方法修改等式(8)右边的最大化操作,算法开始时假设节点没有双亲节点,每次加入对结构的概率增长最大的节点作为双亲,当增加单个双亲不能增加概率时,停止增加双亲到该节点.实现贪婪搜索使用的函数如下:这里的Nijk相对于xi的双亲πi和数据库D被计算,ri、qi的定义同定理1,则结合算法1和2以及K2算法得到的启发式搜索算法如算法3所示.算法3.启发式搜索算法K2_C.输入:数据库D,最小概率函数依赖集(算法2的结果)输出:每个节点的双亲节点ProcedureK2_C;Fori=1tolEndFor;假设等式(9)的所有阶乘都已计算并存入一个数组,因为Nij不可能大于m,因此等式(9)中没有因子大于(m+r-1)!,所以可以在O(m+r-1)时间内把1~(m+r-1)的整数阶乘计算并存储到数组中.算法中的函数g最多被调用l-1次,因为xi最多有l-1个双亲节点,因此Pnew最多需要O(murl)的时间就可以完成所有的操作.While循环中的其它语句是以O(l)时间执行的,每次进行循环时,需要循环的次数是O(u)次,For语句需要循环l次.综合以上情况,算法3的时间复杂度为O(m+r-1)+O(marl)O(u)l=O(mu2r2l),在最坏的情况下,当u=n,l=n时,其时间复杂度为O(mn4r).5.4CPT学习5.4.1无缺失数据学习知道贝叶斯网络结构后,要得到某个节点xi的CPT,如果有充足的样本,只要计算每个节点和它的双亲的采样统计信息即可.遵从前面的约定,设变量xi有ri个可能的值(νi1,…,νiri),其双亲节点为πi,用ωij指明在πi中相对于D的变量的值的第j个唯一的实例,采样统计结果表示为^p(xi=rik|πi=wijk)=5.4.2不完整数据学习当贝叶斯网络结构给定而某变量有空缺或不全时,根据具体情况,可运用贝叶斯分类的链规则技巧避开空缺项进行计算.一般地,我们引入梯度下降方法学习贝叶斯网络的CPT[12].设D是n个训练样本的集合{C1,C2,…,Cn},pijk是具有双亲πi的变量xi的CPT项,用ωij指明πi的第j个唯一的实例,pijk可以看作权,类似于神经网络中隐藏单元的权,权的集合总称为p,这些权被初始化为随机概率值.梯度下降策略采用贪心爬山法,在每次迭代中,修改这些权,并最终收敛到一个局部最优解.Page7基于p的每个可能设置都等可能地假定,梯度下降方法能搜索最好地对数据建模的pijk值,其目标是通过按lnPp(D)梯度来最大化Pp(D)=∏n给定贝叶斯网络结构和pijk的初值,该算法表示如下.算法4.梯度下降方法训练贝叶斯网络.1.计算梯度.对于每个i,j,k,计算:式(11)右端的概率要对D中的每个样本Cd计算,为方便起见,称此概率为p1.当xi和πi表示的变量对某个Cd隐藏时,对应的概率p1可以使用贝叶斯网络推理的标准算法(如一些商用软件包提供的标准功能)由样本的观察变量计算.2.沿梯度方向前进一小步:用更新权值,其中l是表示步长的学习率,而lnPp(D)式(11)计算.学习率设置为一个小常数.3.重新格式化权值:由于权值pijk是概率值,它们必须在0.0和1.0之间,并且对于所有的i,k,∑j新后,可以对它们进行归一化处理来保证这一条件.6实验与分析6.1元报警事件聚类我们使用基于属性相似性和上下文要求的报警聚合来合并原始报警为元报警,原始报警的格式为(AlertID,Classificaton,SrcIP,DseIP,detectime,hyperID),元报警的格式为(HyperID,Classifica-图中的CPT是用Snort得到的对一个实际攻击数据学习的概率分布,CPT中的N1~N5对应攻图2IISAttack的贝叶斯网络tion,SrcIP,DesIP,StartTime,EndTime,Count).报警聚合过程将去除重复报警并产生保留重要信息粒度的易于分析的元报警.每个元报警与原始报警之间具有一对多的关系,在元报警中,Count域记录合并入元报警的原始报警的数目,原始报警中的HyperID域记录着它并入的元报警的唯一标识码.元报警的聚合使用基于Leader-Follower模型的聚合算法[13],其聚合准则是把具有相同源地址和目的地址的报警组合为相同类,其时间戳落入一个自扩展的时间窗口.当原始报警的时间戳超出元报警的时间窗口时,元报警的时间窗口在预定义的界限T内自动扩展.这意味着能够把连续重复的原始报警合并为一个具有适当T时间窗口的元报警.实际上,影响聚合结果的一个重要因素是攻击类的划分,对于针对相同的系统弱点或具有相似的结果的攻击类型,可以在一个更高的层次上划分攻击类,例如:由Snort产生的“SCANNmapTCP”和“SCANNmapXMAS”报警可以合并入“SCANAttack”类,当然,这种报警抽象及定义合适的攻击类需要人工干预.6.2事例分析图1是一个每个单步攻击的方法可选的复合攻击,而有些攻击的攻击步骤也是可选的,例如图2所示的IIS攻击,攻击者启动攻击时首先对攻击主机进行ping操作,然后对其80端口进行扫描,第3步则有两个选择性操作,即ScanPort139或ScanIISServer,第4步也存在一个选择,既可在ScanPort139后直接进行攻击,也可回到步骤3后继续攻击.也就是说第4、5步存在两个选择性攻击步骤,整个攻击过程可以4步完成,也可以5步完成,但这并不影响攻击的结果.击步,P(N1)可以学习得到,也可根据经验直接设置为0.5.Page8据此,就可以对捕获的网络数据和日志数据进行推理,分析得到所需的网络电子证据,另外,从上述过程也可以发现,即使在部分证据丢失的情况下,也可以很好地推理攻击过程的发生.6.3比较分析我们用两个数据集对算法进行了测试,一个是Cooper使用的[10]ALARM网络产生的10000个案例的数据集[14],用于与K2算法的对比实验.另一个是DARPA2000入侵场景关联评测数据集①,用于取证分析对比实验.测试用计算机为DELLD620,系统环境为WindowsVista.ALARM包含了37个网络节点和46条边,为了对比与验证算法的有效性,实验中训练集的大小分别使用了100、500、1000、2000和3000几种尺度,对每个数据集比较了边的增加、边的减少及网络结构计算时间3种性能,并以ALARM的结构为标准,分别用均值和标准差来度量,实验结果如表1所示.实验中未考虑联合概率分布计算情况的比较,显然这种比较很难选择一种标准来衡量.从实验结果可以看到,K2_C算法的准确率和计算时间都有明显改善.但是,正如前面分析,计算时间的提高与先验有关,显然当先验的准确性较高时,计算时间将大大减少.算法数据集K2K2_C1000.751.280.220.48321.00K2_C5000.220.420.110.312213.00K2K2K2_C10000.110.310.030.166783.00K2_C20000.050.230.030.169147.00K2K2K2_C30000.000.000.030.1618848.00我们还用DARPA2000数据集进行了取证计算实验.DARPA2000数据集是DARPA资助MIT林肯实验室构造的入侵场景关联评测数据集,已成为入侵报警关联算法、场景构建算法的有效性验证的标准数据集.DARPA数据集包括用Tcpdump分别在非军事区(DMZ)和内部网(Inside)中监听到的全部数据包.该数据集包括LLDOS1.0和LLDOS2.0.2两个攻击场景实例.在LLDOS1.0攻击场景中,攻击者通过Solarissadmind服务漏洞攻陷并控制了Eyrie空军基地网络中的3台主机,上传了Mstream工具,并对一个政府网站发动了DDoS攻击.LLDOS2.0.2攻击场景与LLDOS1.0相似,所不同的是攻击者对漏洞主机的发现以及Mstream分布式拒绝服务攻击的上传使用了更加隐蔽的方法,从而能够验证关联算法在底层入侵检测系统存在漏报情况下的关联效果.我们在LLDOS1.0数据集上进行了实验,首先使用Leader-Follower算法进行元报警事件聚类,得到元报警事件集合,因元报警事件较少,直接使用算法3进行贝叶斯网络结构学习,得到的结构如图3所示.图中节点与元报警的对应关系如表2所示.节点事实上,LLDOS1.0中包含了一个复合攻击的过程,其完整的攻击序列分为5个攻击阶段:(a)通过IPSweep进行主机探测;(b)使用Sandmin_Ping进行Sadminddaemon服务端口扫描,探测可能存在Sadmind漏洞的主机;(c)利用主机漏洞进行系统入侵,获得3台主机的root控制权限;(d)在被攻破的主机上安装可用于DDoS攻击的木马;(e)利用被控制主机发起DDoS攻击.图3的贝叶斯网络完全重构了这个攻击过程.但图中的Email_Almail_Overflow并不是一个单步攻击,分析发现仅与Rsh具有较高的概率函数依赖关系,如何去除这样的噪音节点是需要进一步研究的问题.除了上述攻击场景重构功能之外,算法在对报警事件的检测方面也表现了较好的性能,我们对两个数据集进行检测并在相似环境下与Ning[2]的报①MITLincolnLaboratory,2000DARPAIntrusionDetec-tionScenarioSpecificDataSets.http://www.ll.mit.edu/Page9警关联算法进行了相同的实验比较,用RealSecureNetworkSensor6.0对数据集进行比对分析,实验表3入侵检测结果比较LLDOS1.0LLDS2.0.27结束语本文将报警关联技术、贝叶斯网络学习方法、概率函数依赖理论相结合,提出了一种能够对来自于不同数据源的数据进行网络协同取证计算的算法.计算机取证是一项专业性很强的工作,通过贝叶斯网络可以直观地再现攻击场景,便于进行网络取证分析.因此下一步的工作主要是实现自动生成可视化的贝叶斯网络图,用图示的形式直观地反映取证计算的结果,以便于广泛使用.
