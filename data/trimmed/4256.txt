Page1无可信中心的可公开验证多秘密共享于佳1),2),3)陈养奎1)郝蓉1)孔凡玉4),5)程相国1)潘振宽1)1)(青岛大学信息工程学院山东青岛266071)2)(山东省科学院山东省计算机网络重点实验室济南250014)3)(中国科学院信息工程研究所信息安全国家重点实验室北京100093)4)(山东大学网络信息安全研究所济南250100)5)(山东大学密码技术与信息安全教育部重点实验室济南250100)摘要多秘密共享是通过一次计算过程就可以实现同时对多个秘密进行共享的密码体制,在一般的多秘密共享中,都需要可信中心的参与,由可信中心进行秘密份额的分发.然而,在很多情况下,无法保证可信中心的存在,即使存在可信中心,它也很容易遭受敌手的攻击,成为系统的盲点.该文提出了一个无可信中心的可公开验证多个秘密共享方案,共享的多个随机秘密是由参与成员共同产生的,密钥份额的有效性不仅可以被份额持有者自己验证,而且可以被其他任何成员验证,这使方案具有更广的应用背景,可用于设计电子投票协议、密钥托管协议等.为了适用于无线自组网等新的网络环境,该文也讨论了无可信中心的条件下动态撤出和增加成员的问题.关键词秘密共享;多秘密共享;可信中心;可公开验证方案;安全性;网络安全;信息安全1引言为了确保秘密的安全性和有效性,Shamir[1]和Blakley[2]于1979年分别基于拉格朗日插值多项式和射影几何理论最先提出了门限秘密共享方案.在一个(t,n)的秘密共享方案中,一个秘密共享在n个服务器中,其中的任意t个服务器都可以合作重构出秘密,而少于t个的服务器均不能正确地重构出秘密.然而,这两个秘密共享方案并不能保证分发者和份额持有者的诚实性问题.文献[3-4]提出了两个著名的可验证秘密共享方案,解决了上述问题.文献[5-6]则提出了两种具有公开验证能力的秘密共享方案,分发者分发的秘密份额的正确性不仅能被份额持有者自己验证,而且可以被其他任何成员验证.Gennaro等人[7]提出了一个无可信中心的可验证秘密共享方案,在没有可信中心的情况下,可以实现秘密共享的目的.上述的所有方案每次只能共享一个秘密,有时候我们需要同时保护多个秘密,或者把一个比较大的秘密分成多个子秘密,通过保护子秘密来保护秘密,这样就需要一个方案能够实现一次共享多个秘密的目的.为此,多秘密共享的方法被提出来.在一个多秘密共享方案中可以同时共享多个秘密,门限个份额持有者合作可以重构出所有秘密.He和Dawson[8]基于单向函数提出了一个实用的多秘密共享方案.Yang等人[9]基于Shamir的秘密共享体制[1]提出了一个多秘密共享方案,方案的运算效率较高,但不具有可验证能力.文献[10-14]提出了具有可验证功能的多秘密共享方案,可避免因份额分发者和持有者的欺骗而导致不能重构出正确秘密的问题.观察目前已有的多秘密共享方案,存在下面两个问题需要进一步解决.首先,多秘密共享方案中都需要一个可信中心负责分发份额,这在很多应用中是不现实并难以实现的,比如在无线传感网和无线自组网中.因此,提出无可信中心的多秘密共享方案具有重要的应用背景.其次,目前已有的方案多数不具备可公开验证的属性,即份额持有者所得到份额的正确性只能由自己验证,其他成员无法验证它是否正确.由于秘密共享的许多应用(比如电子投票、密钥托管、电子支付协议等)都需要可公开验证的性质,因此,构造具有可公开验证性质的多秘密共享方案是一项非常有意义的研究工作.为了解决上述这两个问题,本文提出了一个无可信中心的可公开验证多秘密共享方案.方案基于同态结构,与使用单向函数(或双变量单向函数)的多秘密共享不同,具有同态性质的方案可以较容易的实现联合生成秘密的目标.为了使联合生成的份额能被每个成员验证,利用可公开验证的方法进行秘密分发,任意成员都可以对所有份额进行验证.为了能够一次性重构出多个秘密,文中给出了一个多秘密求解算法,多于一定数目的成员通过该求解算法,可以计算出联合生成共享的多个秘密.此方案也可方便地实现成员的撤出和加入.2预备知识2.1定义定义1.无可信中心的可公开验证多秘密共享由两个阶段组成:秘密产生阶段和秘密恢复阶段.(1)秘密产生阶段.当参与者要生成m个随机秘密时,每个参与者Pi都分别为所有参与者Pj(j=1,…,n)产生随机秘密份额sij,使用加密函数Ei生成加密的Sij=Ei(sij),并将Si1,…,Sin公开.任何成员都可验证Sij是否是Pi为Pj生成的sij的正确加密形式,成员Pj可以通过解密函数获取份额sij.Pj可以通过sij(i=1,…,n)最终计算获得份额sj.(2)秘密恢复阶段.当参与者要重构秘密时,Pj提供份额sj并证明它是一个正确的解密形式.运行重构函数计算最终共享的秘密k0,k1,…,km-1.2.2所需工具(1)Shamir的(t,n)秘密共享方案[1]令q为大素数,假定要分发的秘密为s∈Zq,分发者选择随机多项式f(x)=∑t-1a0=s,aj∈RZq(j=1,…,t-1).计算份额si=f(i)(i=1,…,n),并将si秘密地发送给成员Pi.Page3秘密重构时,任意t个成员的集合B拿出他们的份额si,计算s=∑Pi∈BCBi=∏Pj∈B\{Pi}DLE(g1,h1;g2,h2;α)[15](2)非交互的离散对数相等的零知识证明协议首先,P选取w∈RZq,计算a1=gw设g1,g2是素数q阶乘法群Gq的两个生成元,证明者P向验证者V证明他知道某个秘密α∈Z满足α=logg1h1=logg2h2,而不泄露α的值.c=H(a1‖a2),r=w-αc(modq),公布(r,c).然后,V验证c≡H(gr信P确实知道秘密信息α;否则,不相信.3提出的无可信中心的可公开验证多秘密共享方案3.1符号定义p,q表示两个大素数,满足q|(p-1),Gq为Z的唯一q阶子群.g,h表示Gq中两个不同的生成元.Ω={P1,…,Pn}表示所有参与成员构成的集合.成员Pi的私钥表示为zi∈Zq,对应的公钥表示为yi=hzi(modp).H表示一个密码hash函数,t表示门限值,m表示共享的多秘密个数,A表示协议执行中不诚实的成员集合.3.2提出的求解多个共享秘密的算法犆犕犛(狆,狇,犌狇,犵,τ,犛狓1,犛狓2,…,犛狓τ)p,q,Gq,g遵循3.1节的定义,τ-1表示共享多项式f(x)的指数,Sx1,Sx2,…,Sxτ表示以g为底,以该多项式τ个解f(xi)(i=1,…,τ)为指数所计算的幂.令一随机多项式为f(x)=∑τ-1αxi=f(xi),Sxi=gαxi(i=1,…,τ),该算法输入:p,q,Gq,g,τ,Sx1,Sx2,…,Sxτ,输出:k0=ga0,k1=ga1,…,kτ-1=gaτ-1.构造的算法可以按照以下过程求解:(1)令集合B={x1,x2,…,xτ},将f(x)写成f(x)=∑τ展开多项式整理的xk项的系数其中k∈{0,…,τ-1}.因此,按照式(1)可展开求解出λk,xi,k∈{0,…,τ-1}.(2)对所有的k∈{0,…,τ-1},做以下计算:i=1gak≡g≡∏τ输出:k0=ga0,k1=ga1,…,kτ-1=gaτ-1.3.3方案思想为了不依赖于可信分发中心,需要所有成员Pi(i=1,…,n)联合生成秘密.采用同态结构,所有秘密的值都可由一个多项式的相应系数来计算,门限个成员可通过线性插值来重构秘密.为了获取可公开验证的能力,采用的方法考虑下面两种情况:(1)当秘密个数不大于门限值,即mt时.在秘密产生阶段,各成员构造的多项式次数是t-1,公开对多项式系数的承诺,并公开加密后的子秘密份额,该成员构造证据以便使他人相信他所公开的子秘密份额都是正确的,任何成员都可以通过公开信息验证子密钥的正确性,最后,成员可通过加密子密钥和他的私钥来计算自己的份额.在秘密恢复阶段,该成员需向其他成员证明他的份额确实是从加密的子密钥份额中解密出来的,不少于t个诚实成员可利用提出的求解多个共享秘密的CMS算法来获取重构秘密.(2)当秘密个数大于门限值,即m>t时.在秘密产生阶段,各成员所要构造的多项式的次数是m-1,公开该多项式上的m-t个解和对应的承诺,其他步骤与mt时相似.重构秘密时,首先,通过同态关系,计算m-t个公开份额,任何不少于t个诚实成员利用m-t个公开份额和他们的子密钥,执行提出的求解多个共享秘密的CMS算法,其输出即为所有共享的全部秘密.3.4方案具体描述当mt时,方案描述如下:(1)秘密产生阶段①成员Pi随机选取aij∈RZq(j=0,1,…,t-1),构造多项式fi(x)=∑t-1系数的承诺Cik=gaikmodp(k=0,1,…,t-1)和Yij=yfi(j)jmodp(j=1,2,…,n).Page4②成员Pi构造证据,以便使其他成员相信他们收到的Yij是有效的,即满足Xij=gfi(j)modp,Yij=jmodp.为此,Pi任意选取n个随机数wij∈RZqyfi(j)(j=1,2,…,n),计算a1ij=gwijmodp,a2ij=ywijjmodp,j=1,2,…,n.然后构造质询值ci=H(g‖h‖Xi1‖…‖Xin‖Yi1‖…并计算Ri=(ri1,…,rin)=(wi1-cifi(1)(modq),…,公布证据ProofPi=(ci,Ri).fi(x)的公开承诺Cik来计算③任何成员Pl∈Ω/{Pi}都可根据对多项式④然后,Pl∈Ω/{Pi}再利用已知的ci,rij,g,h,Xij,Yij(j=1,2,…,n),计算a1ij和a2ij:a1ij=grijXci验证式(2)是否成立.若成立,则表明成员Pi分发的份额是正确的.否则,广播对成员Pi的指控,经过不少于t个成员的确认后,将Pi加入不诚实成员集合A,A=A∪{Pi}.⑤所有成员都已分发了子秘密份额后,每个成员Pj∈Ω可计算出加密的秘密份额Yj=∏Pi∈Ω-AYijmodp,再利用私钥zj从加密子密钥Yj中计算出最终的秘密份额Sj=Yz-1(2)秘密恢复阶段参与秘密恢复的成员Pj∈Ω提供Sj,并按下面的步骤向其他成员证明Sj确实是从Yj中解密出来的.①成员Pj任意选取wj∈RZq,并计算b1j=hwjmodp,b2j=Swjjmodp,rj=wj-cjzj(modq),其中cj=H(b1j‖b2j).②成员Pj公布(rj,cj)作为他知道秘密信息zj的证据.③其他验证者验证cj≡H(hrjycj成立.若成立,则证明Sj确实是从Yj中解密出来的.④任何t个证明了他们提供了正确份额Sxi的成员Pxi(i=1,2,…,t,xi∈{1,…,n}),通过执行CMS(p,q,Gq,g,t,Sx1,Sx2,…,Sxt)算法,输出的t个值的前m个就是联合产生的随机秘密k0,k1,…,km-1.当m>t时,方案描述如下:(1)秘密产生阶段①成员Pi选取aij∈RZq(j=0,1,…,m-1),构造多项式fi(x)=∑m-1m-t对解(j,fi(j)),其中j=n+1,…,n+m-t,并公开对系数的承诺Cik=gaikmodp(k=0,1,…,m-1),Yij=yfi(j)②成员Pi构造证据,以便使其他成员相信他们收到的Yij是有效的,即满足Xij=gfi(j)modp,jmodp(j=1,2,…,n).为此,成员Pi任意Yij=yfi(j)选取n个随机数wij∈RZq(j=1,2,…,n),计算a1ij=gwijmodp,a2ij=ywijjmodp,j=1,2,…,n.然后构造质询值ci=H(g‖h‖Xi1‖…‖Xin‖Yi1‖…并计算Ri=(ri1,…,rin)=(wi1-cifi(1)(modq),…,公布证据ProofPi=(ci,Ri).fi(x)的公开承诺Cik来计算③任何成员Pl∈Ω/{Pi}都可根据对多项式④然后,Pl∈Ω/{Pi}再利用已知的ci,rij,g,h,Xij,Yij(j=1,2,…,n),计算a1ij和a2ij:a1ij=grijXciijmodp,a2ij=yrij验证式(3)是否成立.若成立,则表明成员Pi分发的Yij是正确的.否则,广播对成员Pi的指控,经过不少于t个成员的确认后,将Pi加入不诚实成员集合A,A=A∪{Pi}.⑤任何成员都可以通过下面等式验证(j,fi(j)),(j=n+1,…,n+m-t)是否成立若成立,则表明成员Pi公开的fi(j)(j=n+1,…,n+m-t)是正确的.否则,广播对成员Pi的指控,经过超过t个成员的确认后,将Pi加入不诚实成员集合A,A=A∪{Pi}.⑥所有成员都分发了子秘密份额后,每个成员Pj∈Ω可计算出加密的秘密份额Yj=∏Pi∈Ω-APage5再利用私钥zj从加密秘密份额Yj中计算出最终的秘密份额Sj=Yz-1⑦每个成员Pj∈Ω计算联合生成多项式的另外m-t个份额Tj=∏Pi∈Ω-A(2)密钥恢复阶段参与秘密恢复的成员Pj∈Ω提供Sj,并按下面的步骤向其他成员证明Sj确实是从Yj中解密出来的.①成员Pj任意选取wj∈RZq,并计算b1j=hwjmodp,b2j=Swjjmodp,rj=wj-cjzj(modq),其中cj=H(b1j‖b2j).②成员Pj公布(rj,cj)作为他知道秘密信息zj的证据.③其他验证者验证cj≡H(hrjycj成立,若成立,则证明Sj确实是从Yj中解密出来的.④任何t个证明了他们提供了正确份额Sxi的成员Pxi(i=1,2,…,t,xi∈{1,…,n}),通过执行CMS(p,q,Gq,g,m,Sx1,Sx2,…,Sxt,Tn+1,…,Tn+m-t)算法,就可以输出m个联合产生的随机秘密k0,k1,…,km-1.4安全性分析定理1.当n2t-1时,即使存在多达t-1个成员是不诚实的,通过提出方案,各诚实成员在分发阶段仍然可以获得正确的份额,在秘密恢复阶段,仍然可以恢复出正确的秘密.证明.首先,考虑mt的时候.在密钥产生阶段,当成员Pi分发了份额后,验证者利用公开的cij,rij计算a1ij,a2ij,然后把得到的a1ij,a2ij与g,h,Xij,Yij代入式(2),如果得到的结果与成员Pi所公布的cij相同,则说明成员Pi分发了正确的份额;否则,当a1ij,a2ij,g,h,Xij,Yij中的任何一个值有误时,等式(2)均不成立,说明成员Pi分发了错误的份额.事实上,如果成员Pi分发了正确的份额,那么grijXcijjycijfi(j)ywij-cijfi(j)过自己的私钥解密Yj,获取自己正确的份额Sj=Yz-1jmodp.密钥恢复阶段,只有当Sj确实是从Yj中解密出来的,Pj才能通过①~③的零知识证明步骤,事实上,假设Sj是从Yj中解密出来的,也就是Sj=Yz-1ij=gwij-cijfi(j)gcijfi(j)=gwij(modp),yrijjjjmodp,有Yj=Szjhwj-cjzjhzjcj=hwj=b1j(modp),Srjj=b2j=(modp).因为n2t-1,即使存在多达Swjt-1个成员是不诚实的,仍然有不少于t个成员是诚实的,通过这些诚实成员仍然可以在④步中联合产生共享的秘密.相似的,在m>t时,定理仍然成立.证毕.定理2.若Diffie-Hellman假设成立,则提出方案中的份额加密算法是安全的.fi(j)),注意到Xj=∏Pi∈Ω-A证明.假设提出方案中的份额加密算法是不安全的,即存在算法I能攻破份额加密算法,可以利用算法I来攻击Diffie-Hellman假设.假设给定输入g,h,Xij,yj,Yij(Pi∈Ω-A),算法I能以某个不可忽略概率ε成功计算出Pj的份额Sj(=hf(j)=h∑Pi∈Ω-A定gα和gβ,我们的目标是使用算法I计算z=gαβ.令i={min(i)|Pi∈Ω-A},选择α,βi,γi(Pi∈Ω-A),提供给算法I一随机输入g,h=gαα,Xij=gββi,Xij=gβi(Pi∈Ω-A且i≠i),yj=hγ,Yij=hβiγ,Yij=hβi(Pi∈Ω-A且i≠i),则算法I能够以ε概率输出:Sj=gααβ∏Pi∈Ω-A(gααβ∏Pi∈Ω-A中的份额加密算法是安全的.这与Diffie-Hellman假设矛盾,所以提出方案定理3.提出的方案中,若Diffie-Hellman假设成立,则任意t-1个成员利用他们的份额都不能恢复出任何秘密.证明.利用反证法,假设攻击者知道t-1个成员的子密钥,并能利用这t-1个成员的子密钥恢复出某个秘密.不失一般性,假设这t-1个成员是前t-1个成员Pi(i=1,…,t-1),恢复的秘密是k1.首先,考虑mt的情况.假定每个成员Pi选择的多项式为fi(x)=∑t-1秘密多项式为f(x)=a0+a1x+…+at-1xt-1(modq),因此f(x)=∑Pi∈Ω-A攻击者I在实际协议中的所有观察,设置如下:Ci1(gai1)满足∏Pi∈Ω-Agβ(a1=β),也隐含确定了ai1.(1)令h=gα,对所有Pi∈Ω-A,随机选择Page6(2)对所有的i=1,…,n,随机选取t-1个值fi(1),fi(2),…,fi(t-1)∈RZq,这t-1个值和所有Ci1就固定了函数fi(x).(3)计算前t-1个Xij和Yij的值:Xij=gfi(j),j(j=1,2,…,t-1).(4)下面利用公开值和固定的Ci1值来计算CijYij=yfi(j)(j=0,2,3,…,t-1).由fi(x)=∑t-1可得11…1烄122…2t-1…………1(t-1)2…(t-1)t-烆烄fi(t-1)-ai1·(t-1烆烄记犃=烆是t-1,所以,它必有逆矩阵,记为犃-1,不妨设求解的犃-1=可以写成另一种形式烄烆ai(t-1故aij=∑t-1可得gaij=g∑t-1即Cij=∏t-1(5)计算其余的Xij,Xij=∏i-1(1)令h=gα,对所有Pi∈Ω-A,随机选择(6)最后,构造yi,Yij(j=t,…n).随机选取uj∈RZq(j=t,…,n),令yj=guj,Yij=(Xij)ui(i=t,…,n).则Yij满足Yij≡yfi(j)(Xij)uj=(gfi(j))uj=(guj)fi(j)=(yj)fi(j).通过以上模型系统就可以模拟敌手的所有观察.由于已假设t-1个成员Pi(i=1,…,t-1)可以恢复出秘密k1=ha1,又因为h=gα,C1=gβ.所以,这t-1个成员通过模拟器必可以计算出gαβ=(gα)β=ha1=k1,这与Diffie-Hellman假设矛盾.然后,考虑m>t的情况,假定成员Pi选择的多项式为fi(x)=∑m-1密多项式为f(x)=a0+a1x+…+am-1xm-1(modq),因此f(x)=∑Pi∈Ω-A攻击者I在实际协议中的所有观察,设置如下:Ci1(gai1)满足∏Pi∈Ω-Agβ(a1=β),也隐含确定了ai1.n+1,…,m+n-t),计算f(j)=∑Pi∈Ω-A(j=n+1,…,m+n-t).随机选取t-1个值fi(1),fi(2),…,fi(t-1)∈RZq,这t-1个值和fi(j)(j=n+1,…,m+n-t)以及Ci1就固定了函数fi(x).(3)计算前t-1个Xij和Yij的值:Xij=gfi(j),j(j=1,2,…,t-1).Yij=yfi(j)(4)利用公开值和固定的Ci1值来计算Cij(j=0,2,3,…,m-1).由fi(x)=∑m-1式(4)求解aij的方法相似,可以知道aij=∑t-1这里(j=0,2,3,…,m-1),bji是相应系数矩阵的逆矩阵中的对应元素.因此(2)对所有的i=1,…,n,根据公开的fi(j)(j=t,…,n).l=1gaij=g∑t-1Page7即Cij=∏t-1这里,j=0,2,3,…,m-1.l=1(5)计算其余的Xij,Xij=∏t-1t,…,n).(6)最后,构造yi,Yij(j=t,…,n).随机选取uj∈RZq(j=t,…,n),令yj=guj,Yij=(Xij)ui,这里i=t,…,n.则Yij满足Yij≡yfi(j)(Xij)uj=(gfi(j))uj=(guj)fi(j)=(yj)fi(j).通过以上模型系统就可以模拟敌手的所有观察.因为已假设t-1个成员Pi(i=1,…,t-1)可以恢复出秘密k1=ha1,又因为h=gα,C1=gβ,所以这t-1个成员通过模拟器必可以计算出gαβ=(gα)β=ha1=k1,这与Diffie-Hellman假设矛盾.证毕.5相关工作的比较下面该文将提出的方案与文献[3]的方案、文献[6]的方案、文献[7]的方案、文献[8-9]的方案和文献[10]的方案进行比较.文献[3]的方案能对份额进行验证,但不能公开验证份额,且不能一次对多个秘密进行共享.文献[6]的方案虽然能公开验证份额,但也不能同时对多个秘密进行共享,且需要可信中心.文献[7]的方案虽然不需要可信中心,但只能一次对单个秘密进行共享.文献[8-9]的方案能一次对任意多个秘密进行共享,但不具有可(公开)验证能力,也需要可信中心的参与.文献[10]的方案能一次对多个秘密进行共享,但不具有公开验证的能力,且需要可信中心的参与.该文提出的多秘密方案,不仅能公开验证份额,而且不需要可信中心,这使得方案具有更广的应用,如应用于可撤销匿名性的电子支付协议及电子选举协议等.表1给出了几种秘密共享方案在相关方面的比较.方案是否能文献[3]的方案是否否否文献[6]的方案是是否否文献[7]的方案是否否是文献[8-9]的方案否否是否文献[10]的方案是否是否提出的方案是是是是6成员的动态加入和删除在一些实际的网络环境诸如无线自组网中,秘密共享在密钥管理等方面发挥着重要的作用.然而,这些网络中,难以存在可信中心且成员往往需要动态变化.因此,如何在无可信中心的情况下实现成员的动态撤出和加入是十分有意义的工作.上述提出的方案实现成员的撤出是十分容易的,如果成员Pi需要撤出多秘密共享方案时,只需所有成员将Pi的公钥yi注销,在以后秘密恢复阶段,不再接受Pi的份额即可.当成员Pn+1加入上述多秘密共享方案时,可利用文献[15]的思想,执行下面的协议完成.令B表示协议执行时不诚实的成员集合,初始化B=.(1)首先,Pn+1选择他的私钥zn+1∈Zq,公开对(2)每个成员Pi(i=1,2,…,n)选择一随机多应的公钥yn+1=hzn+1(modp).项式gi(x)=∑t-1gbij(modp),0jt-1和Zij=ygi(j)1,2,…,n+1.令Eij=∏t-1ggi(j)(modp),j=1,2,…,n+1.随机数wij∈RZgwij(modp),a2ij=ywijj(modp),这里j=1,2,…,n+1.然后构造质询值ci=H(g‖y1‖…‖yn+1‖Ei1‖…‖Ei(n+1)‖Zi1‖…‖Zi(n+1)‖a1i1‖…‖a1i(n+1)‖a2i1‖…‖a2i(n+1))(3)每个成员Pi(i=1,2,…,n)选择n+1个并计算Ri=(ri1,…,ri(n+1))=(wi1-cigi(1)(modq),…,wi(n+1)-cigi(n+1)(modq)).最后,公布证据ProofPi=(ci,Ri).(4)成员Pn+1对于每个j(j=1,2,…,n+1),先计算Eij=∏t-1算a1ij=grijEci后,验证等式(5)是否成立.若成立,则表明成员Pi分发的Zij是正确的,Pn+1计算δi(n+1)=(Zi(n+1))z-1Page8否则,广播对成员Pi的指控,经过不少于t个成员的确认后,将Pi加入不诚实成员集合B,令B=B∪{Pi}.最后,Pn+1计算δn+1=∏Pi∈Ω-B(5)每个成员Pk(k=1,2,…,n)对于每个j(j=1,2,…,n+1)需验证Pi分发的Zij是否正确.先计算Eij=∏t-1计算a1ij=grijEci然后,验证等式(5)是否正确.若成立,则表明成员Pi分发的Zij是正确的;否则,广播对成员Pi的指控,经过不少于t个成员的确认后,将Pi加入不诚实成员集合B,令B=B∪{Pi}.(6)每个成员Pj(j=1,2,…,n)计算Sj=Sj·∏Pi∈Ω-Bδij(modp).(7)每个成员Pj(j=1,2,…,n)选择wj(n+1)∈RZq,先计算a1j(n+1)=hwj(n+1)(modp)和a2j(n+1)=wj(n+1)(modp);再计算Sjcj(n+1)=(h‖Sj‖yj‖Yj∏Pi∈Ω-B最后,公布ProofPi=(cj(n+1),rj(n+1)).Sj(yn+1)zj(modp).(8)每个成员Pj(j=1,2,…,n)计算并广播θj=l=0(9)成员Pn+1解密θj·(yzn+1j)-1=Sj(yn+1)zj·(yzn+1j)-1=Sjhzn+1zj·h-zjzn+1=Sj(modp),并计算a1j(n+1)=hrj(n+1)rj(n+1)Yj∏Pi∈Ω-BSj式(6)是否成立.成员Pn+1选择t个通过上述验证的成员的编号j(j∈Λ,|Λ|=t),最后计算它的份额Sn+1=∏j∈Λ1)=∏i∈Λ在上述协议的(2)(3)步中,成员Pi(i=1,2,…,n)产生随机份额δij将其加密的版本Zij分发给成员Pj(j=1,2,…,n+1);在第(4)(5)步中,Pn+1和Pk(k=1,2,…,n)验证Zij(j=1,2,…,n+1)是否是正确的加密版本,并分别解密获取δi(n+1)和δij(j=1,2,…,n);在(6)步中,Pj(j=1,2,…,n)计算份额Sj的盲化版本Sj;在第(7)(8)步中,Pj(j=1,2,…,n)将Sj加密成θj发送给Pn+1,并证明它是一个正确的加密版本;在第(9)步中,成员Pn+1解密Sj的盲化版本Sj,并验证其正确性,最后插值并解盲化获取其份额Sn+1.7结论本文提出了一个无可信中心的可公开验证多秘密共享方案,在没有可信分发中心的情况下,所有成员可一次性联合生成多个随机秘密,任意t个成员只要拿出正确的秘密份额就可恢复出秘密.方案中,份额的正确性不但能被份额持有者验证,还可以被任何其他成员验证.本文证明了方案的安全性,也给出了与其他相关工作的对比.最后,讨论了在无可信中心的条件下成员的动态撤出和加入问题.
