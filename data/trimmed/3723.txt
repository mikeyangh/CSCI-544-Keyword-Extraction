Page1基于双密度圆对称轮廓波二元分布模型的压缩传感图像重构练秋生陈书贞孔令富(燕山大学信息科学与工程学院河北秦皇岛066004)摘要压缩感知理论利用图像表示的稀疏先验知识,可以从远小于奈奎斯特抽样率的抽样点中重构图像.图像的稀疏表示和稀疏性度量是影响图像重构性能的两个重要因素.为获得更好的图像稀疏表示,文中根据简单细胞感受野特性,将圆对称轮廓波的一个倍频程尺度分裂为径向带宽比为1.414的两个尺度,构造出双密度圆对称轮廓波变换(DDCSCT).根据DDCSCT的联合分布特性,利用二元分布模型获得了压缩传感图像重构的二阶稀疏性度量.实验结果表明,利用DDCSCT和二阶稀疏准则进行图像重构比现有的图像重构算法在峰值信噪比和主观视觉效果两方面均有显著提高.关键词压缩传感;稀疏表示;轮廓波变换;二元分布模型;图像重构1引言压缩传感(压缩抽样)是Donoho和Candes等学者在2006年提出的一种新的信号抽样和处理理论,是信息处理领域的重大突破[1-3].在传统的数据采集系统中,信号抽样频率必须大于等于信号带宽的两倍(奈奎斯特抽样率)才能无失真地重构原始信号.由于目前所处理的信号其带宽越来越宽,在高速信号和高分辨率视频采集系统中,模数转换器件的抽样频率已成为制约系统性能进一步提高的瓶颈.能否突破奈奎斯特抽样定理的限制已成为近年来广大学者关注的焦点.压缩感知理论将信号的稀疏表示作为重构的先验知识,把压缩和抽样两个环节结合,能从少量的抽样点(随机投影)中重构原始信号.压缩传感在某种程度上突破了奈奎斯特抽样定理的限制,并且有效降低了传感器和抽样系统硬件的复杂性.但这并不表示压缩感知理论推翻了奈奎斯特抽样定理.传统的奈奎斯特抽样定理仅以信号的带宽作为先验知识,其重构算法简单;而压缩感知理论在重构时以信号的稀疏性作为先验知识,其算法的复杂度远高于奈奎斯特抽样定理.Donoho的理论结果表明[1],只要信号是可压缩的,则用压缩传感方法重构原始信号所需要的抽样率远低于奈奎斯特抽样率.对于像素数为M的K稀疏图像(K-Sparse),利用O(Klog(M))个抽样点和l1范数极小化准则即可重构原始图像,重构误差和K个显著系数的逼近误差相当.Tsaig和Donoho在文献[4]中的实验结果表明,利用3K~5K个抽样点进行图像重构的结果和K个显著正交小波变换系数重构图像的质量相当.在图像压缩感知系统中,图像的稀疏表示是影响图像重构质量的关键因素.只有合适的图像稀疏表示方式才能保证图像的重构质量.在大部分关于压缩传感的文献中普遍采用二维正交小波基进行图像稀疏表示,但小波并不是图像表示的最优基,它不能有效表示自然图像中轮廓、纹理等高维几何特征.近年来,为克服小波基的固有缺陷,图像稀疏表示的研究热点已经从普通的正交小波转移到冗余字典下的稀疏分解[5].其核心思想是用超完备的原子库(冗余字典)代替正交基.由于冗余字典中的原子数量比图像的像素数多,因此原子的选择比正交基更加灵活,它能更好地与图像本身的结构和内容匹配.近来人们开始尝试将冗余稀疏表示用于压缩传感中,并从理论上证明了冗余稀疏表示方法用于压缩传感的可行性[6].Peyre[7]提出了基于Bandlet最优基的图像压缩感知算法;Ma[8]利用Curvelet变换和迭代收缩法提出了单像素压缩成像算法;Mun等人[9]利用方向小波变换提出了分块压缩感知算法.这些算法的性能都高于基于正交小波变换的压缩感知算法,表明冗余稀疏表示比正交稀疏变换更适合图像压缩传感.选择合适的稀疏性度量是压缩感知理论中的另一个关键问题.目前人们普遍用l0范数衡量变换稀疏的稀疏性.但由于l0范数最优化是典型NP-Hard问题,在实际应用中经常用l1范数代替l0范数(文献[10]及其参考文献中给出了多种基于l1范数优化的压缩感知算法).l1范数的缺点是没考虑系数之间的统计相依关系.为克服l1范数的缺陷,根据稀疏变换系数的统计特性,Baraniuk等人[11]提出了利用块稀疏性度量和树稀疏性度量的基于模型的压缩感知算法;He等人[12]利用小波树结构提出了贝叶斯压缩感知算法.Tzagkarakis等人[13]利用高斯尺度混合分布提出了一种图像压缩感知算法,其实验结果表明该算法比基于l1范数的算法性能有显著提高.这些研究成果表明利用更准确的模型和稀疏性度量是提高压缩传感性能的有效途径.为获得更好的图像稀疏表示方法和稀疏性度量,本文从视觉生理学实验数据出发,对圆对称轮廓波的径向频带分割进行改进,提出了更加符合人眼视觉特性的双密度轮廓波变换;根据其系数的联合分布规律,利用二元变量模型和贝叶斯理论获得了一种新的二阶稀疏性度量,实验结果表明它能获得更高的图像重构质量.2双密度圆对称轮廓波变换及其二维分布轮廓波变换是一种多尺度几何分析方法,它比小波变换能更稀疏地表示图像的边缘纹理等几何特征[14].为克服轮廓波变换存在的频谱混淆现象,本文作者在文献[15]提出了由圆周对称滤波器组和方向滤波器组实现的圆对称轮廓波变换(CircularSymmetricContourletTransform,CSCT),其稀疏性比轮廓波变换高.然而包括CSCT在内,虽然目前的多尺度几何分析方法均具有多尺度和多方向性,但在径向频带分割上与人眼视觉特性还有较大差别.多尺度几何分析(如contourlet、curvelet等)Page3相邻尺度的径向频带宽度比为2(即一倍频程),这一点和视觉特性不相符.文献[16]为了构建仿视皮层模式识别系统,详细分析了视觉生理学实验数据.他们对视觉皮层V1区中的简单细胞进行研究后发现,简单细胞的感受野在频域径向上可以划分为8个尺度,第k尺度的简单细胞感受野用式(1)表示:RFk(x,y)=exp-(x2r+γ2y2r)xr=xcosθ+ysinθ,yr=ycosθ-xsinθ,式中θ为简单细胞感受野的主方向,λk为第k个频带内的平均波长,λk(k=1,2,…,8)分别为4.05、6.20、8.50、10.90、13.40、16.10、18.95和22.00,σk(k=1,2,…,8)分别为3.20、4.95、6.80、8.70、10.75、12.85、15.20和17.60.σk/λk的平均值为0.80,它和相邻尺度的径向带宽比B之间满足以下关系[17]:将σλ=0.8代入上式得B=1.61.为了使圆对称轮廓波变换更加符合人眼视觉特性,进一步提高其表示图像细节的能力,本文构造了一种双密度圆对称轮廓波变换(DoubleDensityCircularSymmetricContourletTransform,DDCSCT).DDCSCT的频带划分如图1(a)所示.和图1(b)给出的CSCT的频带划分相比较,CSCT中的一个尺度分裂成DDCSCT的两个尺度(这也是称之为双密度圆对称轮廓波的原因),并且DDCSCT相邻尺度间的径向带宽比小于2.设DDCSCT最高频尺度的径向带宽为x,则从次高频到低频尺度的径向带宽依次为0.5π-x,0.5x,0.25π-0.5x,….根据相邻尺度的径向带宽比为常数得上面方程的两个根x1,2=(槡2±2)π/2.去掉大于π的不合理解得x=(槡2-2)π/2,此时DDCSCT相邻尺度的径向带宽比为槡2,它比CSCT的径向带宽比更加接近1.61.即DDCSCT比CSCT更符合人眼视觉特性.图2是双密度圆对称轮廓波变换(DDCSCT)的原理图,它由频域圆对称滤波器组和方向滤波器组(DirectionalFilterBanks,DFB)实现.图像x(狀)经过Hi和Lo分解为高频子带和低频子带.高频子带经过Hm和Lm分解为径向带宽比为槡2的两个细节子带,两个细节子带再分别通过方向滤波器组分解为2i个方向子带(i为任意正整数,在不同尺度i可以取不同值)[14].对低频子带重复上述过程可实现图像的多分辨率多方向分解,完成DDCSCT变换.图3列出了一个方向的DDCSCT基函数和同方向同频带的Gabor函数.从图中可以看出DDCSCT基函数与Gabor函数的空域形状十分类似.图3DDCSCT基函数(左)与Gaobr函数(右)的对比为避免产生频谱混淆现象,图2中的滤波器Hi和Lo应该满足文献[15]中给出的两个重构条件:由于图2中的滤波器Hm和Lm后面没有下抽样操作,并且DFB本身是可重构的,因此它们的重构条件为另外为了满足DDCSCT相邻尺度的径向带宽比为槡2的条件,Lm还应该满足Page4和设计Hi、Lo类似,采用遗传算法设计Hm和Lm[15].图4给出了DDCSCT系数x和它父系数的联合分布.从图中可以看出大部分系数对集中在零附近,它具有非高斯性、高峰度和长拖尾等特性.这种二维稀疏分布可用二元分布模型描述[18]:f(x,xp)=33基于二元分布模型的图像重构造算法在文献[1-4]中是通过求解下列l1范数优化问题来从随机投影(抽样点)中重构图像:由拉普拉斯乘子法可以将上面的优化问题转化为式中α为稀疏变换系数组成的向量,狔为随机投影值组成的观测向量.Φ为随机投影矩阵,Ψ的每一列对应稀疏变换的一个基函数,Φ与Ψ不相干.在实际计算中,Ψα可通过稀疏逆变换实现,而随机投影Φ狓可通过PDCT(PermutedDCT)算法[19]或noiselet变换实现[20](本文Φ通过PDCT随机投影算子实现).求出最优解α^后,对α^进行稀疏逆变换获得重构图像.式(8)的物理意义非常明显:即在尽量符合观察值的前提下(ΦΨα=狔),最稀疏解就是最优解.这里是用l1范数度量系数的稀疏性.我们也可以从另外一个角度来理解式(9).在有正态白噪声狀存在的情况下,狔与α的关系为狔=ΦΨα+狀.由最大后验概率法(MAP)得式中f(α|狔)为条件概率密度.根据贝叶斯公式得式中f(α)和f(狔)分别为α和狔的概率密度,其中f(狔)为常数.对上式右边取对数得由于狀符合正态分布,因此有f(狔|α)=1现假设α的每一个分量αi均符合相同的拉普拉斯分布,并且相互之间独立,则有f(α)=∏i=1,…,N将式(13)、(14)代入式(12),并且去掉常数项,系数合并后用γ表示,则式(12)简化为将括号中的负号去掉得比较式(9)和式(16),两者完全一致.这表明目前压缩感知系统中在图像重构时仅仅利用了最简单的一阶稀疏准则,即将独立的拉普拉斯分布作为图像重构的先验知识.然而,无论是小波变换还是多尺度几何变换,其变换系数之间虽然近似不相关,但它们不是统计独立的.如果一个系数的幅值大,则其父系数为大幅值系数的概率非常大.因此严格来说,不管是哪种稀疏变换其统计模型不能简单地看作是多个独立的拉普拉斯分布的乘积,它必须考虑系数之间的相互关系.二元变量模型和拉普拉斯分布的根本区别在于它能有效描述相邻尺度间父子系数之间的统计相依关系.由于轮廓波变换系数的概率分布符合式(7)给出的二元分布模型,考虑到αi只与其父系数αpi有统计关联,则向量α的概率密度为f(α)=∏i=1,…,N将式(13)、(17)代入式(12),并且去掉常数项,系数合并后用β表示,则式(12)简化为α^=argmax-∑i=1,…,N将括号中的负号去掉得α^=argmin∑i=1,…,N由拉普拉斯乘子法,上式等价为求下列有约束条件的优化问题:Page5令αBv=∑i=1,…,N区别在于αBv考虑了父子系数之间的统计相依关系,本文称αBv为向量α的二阶稀疏性度量.4算法实现本文利用凸集交替投影算法(POCS)[21]求解式(18)表示的优化问题.定义以下两个集合:下面要证明C1和C2均为凸集.若狓∈C1,狕∈C1,则ΦΨ[λ狓+(1-λ)狕]=狔,即λ狓+(1-λ)狕∈C1,根据凸集的定义可知C1为凸集.若狓∈C2,狕∈C2,即∑i=1,…,N槡要证明C2为凸集,只要证明当0<λ<1时,λ狓+(1-λ)狕∈C2,即证明下式成立:∑i=1,…,N结合式(19),上式等价为∑i=1,…,N∑i=1,…,N如果上式中的任意一项都满足下列不等式:槡[λxi+(1-λ)zi]2+[λxpi+(1-λ)zpi]p槡i+(1-λ)z2i+z2λx2i+x2槡λx2i+x2则式(20)成立.对上式两边取平方后整理得再对上式两边取平方后得上式显然成立.由于推导过程中的每一步都可以逆推,因此式(20)成立,即C2为凸集.假设集合C1和C2的交点为αc,即有C1∩C2={αc},αc为优化问题的解.用POCS算法求集合C1和C2的交点包括以下两个关键步骤:(1)将α的第t次迭代值αt投影到C1:(2)利用梯度下降法将β投影到C2得到α~t:j=βj-ρα~t具体的图像重构算法如下:1.初始化.设t=1,αt的每个分量均为0,最小误差为Emin,最大迭代次数为tmax.2.利用式(25)将αt投影到C1.式中Ψ代表DDCSCT逆变换,ΨT表示DDCSCT变换.3.利用式(26)向C2投影得到α~t.为避免βj的符号改变,在算法实现时式(26)修正为4.为进一步提高图像重构质量,将图像梯度的稀疏性结合到图像重构中.图像梯度的稀疏性可用全变差(TotalVariation)来衡量[22].每次迭代应用梯度下降法调整全变差,使图像的全变差减小:式中犡=Ψ(α~t),TV(犡)为犡的全变差,μ=0.25/t.下一步;否则αt+1←αt,t←t+1,转到步2继续.5.αt=ΨT(犡t),若t>tmax或αt-αt-1Emin,则转到6.对αt进行DDCSCT逆变换获得重构图像.5实验结果在下面的实验中,本文算法与文献[22-24]中提出的算法进行了对比.为便于比较,本文采用和文献[22-24]相同的测试图像集,利用图5列出的4幅256×256的标准灰度图像测试算法性能.Page6表1列出了4幅图像在随机投影数(即抽样点数)分别为10000、15000、20000、25000时的重构结果,表中共比较了6种算法.其中Wavelet-l1是Candes等人在文献[22]中提出的基于正交小波变换和l1范数最小化的重构算法;Block-CS为Gan等人在文献[23]中提出的基于分块投影和l1范数最小化的重构算法,它利用非抽样小波基和过完备Lapped混合基表示图像;DDCSCT-l1表示利用DDCSCT和l1范数最小化的重构算法;DDCSCT-Bv1表示DDCSCT结合二元分布的重构算法.Hybrid-CS表示Han等人在文献[24]中提出的混合抽样压缩感知算法.Hybrid-CS将图像分为稀疏和非稀疏两部分,对稀疏部分采用随机投影抽样,而对非稀疏部分则进行线性抽样;DDCSCT-Bv2与DDCSCT-Bv1类似,但两者抽样方式不同.DDCSCT-Bv2的抽样方式与Hybrid-CS相同,而DDCSCT-Bv1完全采用随机投影抽样.在后3种算法中,最大迭代次数均为90.从表1可以看出,前4种采用随机投影抽样的算法相比,只有在抽样点数为25000时,Block-CS重构Boats图像的PSNR比DDCSCT-Bv1高0.1dB;在其它情况下,DDCSCT-Bv1均获得了最高的PSNR.后两种采用混合抽样的算法相比,DDCSCT-Bv2的性能明显高于Hybrid-CS.表2列出了抽样点数分别为10000、15000、20000、25000时对4幅测试图像进行重构的平均峰值信噪比.从表2可知,前4种算法中DDCSCT-Bv1重构图像的平均峰值信噪比最高.以Lena图像为例,DDCSCT-Bv1比Wavelet-l1、Block-CS和DDCSCT-l1分别高1.5dB、1.4dB和0.6dB;后两种算法中DDCSCT-Bv2比Hybrid-CS高0.6dB.图6Peppers的重构结果(局部)LenaPeppersCameraBoatsWavelet-l1[22]29.426.029.730.5Block-CS[23]29.531.226.931.1DDCSCT-l1DDCSCT-Bv130.931.830.431.7Hybrid-CS[24]32.331.428.831.9DDCSCT-Bv232.932.830.933.2图6给出了抽样点数为15000时Wavelet-l1、DDCSCT-l1、DDCSCT-Bv1和DDCSCT-Bv24种算法对Peppers进行重构的结果.对比四幅图像可以看出DDCSCT-Bv2的重构图像视觉效果最佳,边缘细节最清晰.Page76结论图像的稀疏表示和稀疏性度量是影响压缩传感系统图像重构的两个重要因素.本文根据视觉皮层简单细胞感受野的特性构造出符合视觉特性的双密度圆对称轮廓波变换(DDCSCT),并且根据DDCSCT相邻尺度间父子系数之间联合分布具有的非高斯性、高峰度和长拖尾等特点,利用二元分布模型获得了一种新的图像重构算法.对四幅标准测试图像进行重构的实验结果表明本文算法在客观指标峰值信噪比和主观视觉效果两方面均有明显提高.
