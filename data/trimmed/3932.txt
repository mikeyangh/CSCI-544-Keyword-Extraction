Page1尺度不变V变换信号消噪梁延研1)蔡占川2)李坚2)齐东旭2)唐泽圣1),2)1)(澳门科技大学太空科学研究所澳门中国)2)(澳门科技大学资讯科技学院澳门中国)摘要传统的小波变换方法用于信号的逼近、重构和消噪,通常会引起信号失真,例如在信号奇异点处的Gibbs现象,这是由于小波基函数的连续特性所引起的.该文提出一种新的尺度不变V变换(SIVT),可用于信号重构和消噪,并能有效消除信号逼近过程中的Gibbs现象.V系统是Haar小波基函数的扩展,并且是一种不变集上的多小波.信号消噪的困难点在于奇异点处的局部信号重构.该文通过对信号奇异点的分析,创新地提出采样信号局部尺度变换结合正交变换的方法(称为尺度不变V变换)进行信号消噪重构.实验结果表明该文方法消噪重构的信号比基于小波变换重构的信号有着更好的效果和更高的信噪比值.尺度不变V变换的理论表明了这种新的技术框架在某些信号重构问题上比小波变换方法更具优势.关键词尺度不变V变换;逼近;重构;消噪;信号处理;小波变换1引言小波变换已经被广泛应用于信号处理领域,例如滤波、估计、压缩、特征提取以及数据融合等[1].小波变换对信号处理的适用,许多情况下取决于小波多分辨率与局部紧支集特性.一般说来,这些特性如时间局部性、光滑性、正交性和对称性,都是非常必要的.然而,在小波基的设计原理上正交性与对称性是不可兼得的[1-4],因此解决这些问题是对设计小波基工作的重要挑战.自20世纪90年代开始,小波方法已经被广泛用于信号与图像的噪声消除中.最初的基本方法是利用正交小波基分解含噪信号,并用阈值对系数处理,重构的信号即是消噪后信号.小波消噪的本质在于将信号投影到各个尺度的小波基下,再通过选定阈值将小波系数处理,从而得到重构的消噪信号.由于正交小波是有基本小波函数经伸缩平移得到的函数集,平移是非一致取样,随着尺度增大位移取样间隔以2的指数倍变大,从而正交小波不能从多尺度的角度完美地匹配信号的局部结构特征,因此小波消噪通常会使得消噪信号的急剧变化部分产生振荡现象.后来从小波基和阈值选择方面都进行了许多改进,例如提出不同的阈值函数、基于噪声大小的动态阈值、阈值的自适应选取以及贝叶斯条件的非线性预测等[5-10].特别地,基于冗余小波变换阈值消噪[11]和基于平移不变小波变换消噪方法得到广泛应用[12-13].平移不变(Translation-Invariant)小波消噪方法通过循环平移的方法,对多次平移而且平移量不同的信号进行消噪,再取平均,可以明显改进消噪效果.但由于传统小波阈值去噪方法固有的局限性(难以在细小尺度上区分含噪声系数与有用系数),信号消噪依然面临挑战.由齐东旭和冯玉瑜在1983年提出的U系统是一类新的完备正交函数系[14].U系统由[0,1]上的k次分片多项式组成,可以同时处理连续和间断的信号,并在几何模型重构[15-16]和模式识别中得到应用[17].由于0次U系统正是Walsh函数系,1次U系统是在图像处理中广泛应用的斜变换函数,因此我们可以把U系统视为Walsh函数的推广.在本文中,将重点介绍一类新的与U系统相关的正交函数系———V系统,是一类有着分片光滑性的多小波[18].它具有时间局部性、光滑性、正交性与对称性等优点.由于0次V系统恰是Haar小波基函数,故V系统可视为Haar小波的推广.此外,V系统与U系统有着紧密的联系,它除了具有U系统的诸优点,还具有时间局部性这一特性.V系统已经在某些信息处理领域中得到应用,是一个有效的工具[19-22].与其它一些小波和多小波[23-28]相比,V系统有两个明显的优势:其一,V系统具有明确数学表达式.通常小波使用Mallat算法实现对信号的分解与重构,它们的基函数通过离散滤波器组给出,并没有明确的数学表达式.但是在某些情况下,信号需要表示为多项式,此时V系统较通常小波更适合于该类型的信号处理.其二,与多小波相比,V系统对信号的分解和重构运算是直接明了的,避免了诸如预滤波这样的复杂运算,使得V系统的实现更加简便,具体细节可参见下文的详细叙述.在本文的方法中,我们将信号视为具有多种局部特征的分片信号组合.由于V系统包括了各个尺度下不同支集长度的基函数,这些基函数均由分片多项式组成.结合信号尺度变换技术,我们通过V变换,可得不同尺度下的局部逼近信号,从而可以得到较优的消噪重构信号.本文将这种全新的信号处理的方法框架,命名为尺度不变V变换.实验示例说明了该方法的有效性.文本所有示意图均通过Matlab软件生成.本文首先给出V系统简介,包括其定义、构造、性质;其次,提出尺度不变V变换并给出实现算法及实例;然后是该算法在信号消噪中的应用;最后是讨论.2V系统简介2.1V系统的定义和构造V系统首先在文献[18]中提出,这里将简要介绍k次V系统定义、构造和相关性质.首先,V系统是分组分类的,k次V系统的第1组函数是区间[0,1]上的前k+1个Legendre多项式,用Vik,1(x),i=1,2,…,k是k+1个k次函数生成元,用{Vik,2(x),i=1,2,…,k+1}表示;依次对这k+1个函数生成元作各种尺度的压缩平移并规范化,就得到了k次V系统其它组函数.从第3组开始,第mth组包括k+1类共2m-2个函数,详细构造过程参见文献[2].我们定义Vi,jk,m(x)作为k次V系统第m组第i类第j个函数,这里k=0,1,…;m=3,4,…;j=1,2,…,2m-2.图1给出了当k=0,1,2,3时k次V系统示意图.{Page3图1k次V系统示意图((a)当k=0时,V系统前16个函数;此时V系统即是非常重要的Haar小波函数;(b)当k=1为了便于理解V系统结构,以3次V系统(见图2)为例详细分析它的组成部分.图23次V系统的前32个函数((a)Legendre函数;(b)函数生成元;(c)接下来8个函数;(d)下一个分辨率下16个函数)图2(a)为3次V系统的基本函数,从函数生成元(图2(b))开始,通过压缩和平移,可以得到接下来的函数Vi,jk,m(x),见图2(c)~2(d).通项表达式如下Vi,jk,m(x)=定义Vi(x)为k(k=0,1,…)次V系统中的第ith个分片多项式,对于给定函数F(x),可用V级数展开如下这里符号bi表示函数F(x)关于V系统的频谱系数.F(x)~∑烄烅bi=〈F(x),Vi(x)〉=∫1烆V系统有以下性质:(1)局部紧支集V系统的第m组第i类第j个函数具有局部紧支集,支集区间为j-1k+1;j=1,2,…,2m-2;m=3,4,….(2)完备正交性k次V系统是L2[0,1]上归一化的正交函数系,有这里m,n=1,2,…;p,q=1,2,…,k+1;i=1,2,…,2n-2;j=1,2,…,2m-2.(3)V级数的再生性令F(x)为具有间断点x=q/2r的k次分片多项式,这里q,r均为正整数,那么,F(x)可由有限项V级数精确重构.2.2离散V变换离散正交变换已经大量应用于科学与工程的许多方面.构造基于V系统的离散变换是应用V变换的关键问题.对于离散信号来说,我们采取下列的步Page4骤构造离散V变换.(1)对于具有n(n=2r,r=1,2,…)个采样点的离散时间信号F(x),采用k(k=0,1,…)次V系统前n个基函数Vi(x),i=0,1,…,n-1,并进行等间隔分段积分,积分区间为j-1这样可得到n×n的矩阵.矩阵.F(x)的频谱.将式(2)重写为离散形式,如下得(2)对该n×n矩阵正交化和标准化,得到正交(3)内积bi=〈F(x),Vi(x)〉即是离散时间信号F(x)=∑n-1烄烅bi=〈F(x),Vi(x)〉=∑n-1烆至此实现了正交离散V变换.从V系统的构造理论可知,正如许多离散小波一样,V系统的基函数之间具有2进的尺度关系,并且包括了多分辨率下的间断点.因此V变换只适用于具有2的方幂个采样点的离散信号.关于任意长度的离散信号处理技术,可通过下一节中的信号尺度变换技术实现.0次离散V变换和1次离散V变换的快速算法,可以参照快速Walsh变换及快速斜变换算法得到,其算法复杂度均为O(nlog2n).更高次离散V变换算法只能通过矩阵相乘得到,算法复杂度为O(n2).3尺度不变V变换及实现3.1平移不变小波变换消噪在正交小波逼近信号的过程中(无论线性逼近还是非线性逼近),会产生类似用有限项Fourier级数逼近间断信号时的振荡现象,称为pseudo-Gibbs现象(图3).因为若用一个阈值强行将小波分解信号的频谱系数截断,由于有效系数被丢弃,重构的非线性逼近信号和原信号之差在L2范数意义下很小,但是并不能保证每一点的差都很小———特别地,在奇异点处小波分解产生较大的系数,这些系数的丢失会造成奇异点处的振荡.从这个角度讲Fourier变换和小波变换产生振荡的原因本质是相同的[29-32].原信号通常只含有限个奇异点,因此原信号在不含奇异点的局部可以用多项式逼近.难点在于难以重构含奇异点的局部信号.由于小波变换的局部化特征,重构信号其振荡幅度与奇异点的位置密切相关.考虑一个分段线性长度为256的离散信号f(n),0n<255,在n=128处有一个跳跃间断,如图4(a)所示.因为f(n)包含的奇异点恰好落在n=q/2r(q,r均为正整数),由V系统的再生性可知,在3次离散V变换下只用少量系数即可精确重构,其展开系数如图4(b)所示.给f(n)加上高斯白噪声得到f(n)(图4(c)),并得到f(n)在3次离散V变换下的系数(图4(d)).可以看到,由噪声引起的系数幅值较小,可以通过一个简单的阈值t=2log(N)槡σ(N为信号长度,σ为估计的噪声方差)把噪声系数去除.重构的信号如图4(e)所示.一般地,考虑分段线性长度为256的离散信号f(n),n=0,1,…,255,在n=118处有一个跳跃间断(图4(f)),其在3次V变换下展开的系数如图4(g)所示.由于间断点没有落在n=q/2r(q,r均为正整数)处,频谱中含有大量的非零系数.考虑将原信号加上噪声的情况(图4(h)),在3次V系统的展开系数中,有效的频谱系数被“淹没”在由噪声产生的系数中(图4(i)),此时若根据阈值滤去噪声相当困难,恢复的信号效果并不好(图4(j),同样采用阈值t=2log(N)槡σ).为了消除去噪后信号所表现的振荡现象,需要采取适当的方法,消除小波去噪在奇异点位置的特殊性.由小波基的时频局部性可知,振荡现象与信号的奇异点在信号中的排列位置相关联.一个具有同样特征但与原始信号具有相位差的新信号可能产生我们所期待的更小的振荡幅度.因此,一个有效的途径是通过改变信号的排列次序,从而改变奇异点在整个信号的位置来达到降低或消除振荡幅度的目的.对于信号xt(0t<N),定义Sh为循环平移hPage5图4Page6位的平移算子:并有其逆设小波变换和阈值处理的综合过程为运算T表示,那么通过平移消噪的总过程可表示为^x为原始信号xt基于平移不变小波变换去噪的结果.为了获得理想的去噪结果,基于平移不变的去噪就转化为寻找最优的平移参数h.信号消噪的根本目的在于获得原本光滑的信号.在原信号不含奇异点的光滑部分,可方便地用多项式进行逼近,即可得到消噪信号;如果在奇异点的有限局部邻域内,则很难用泰勒公式逼近,换言之,在奇异点处即便用泰勒公式逼近,则截断误差很大,导致奇异点局部邻域信号的消噪效果不佳,这也是小波阈值消噪方法固有缺陷的原因所在.因此,即使在噪声方差和阈值已知的情况下,仍然无法完美地恢复信号,这是由于噪声通常会使得大部分奇异点并不显见,我们无法估计原信号奇异点的分布位置,也就无法精确地用多项式重构信号.因为蕴含了原信号只存在有限个奇异点这一条件,可知在奇异点的左(右)局部邻域总是光滑的,如果只对该奇异点的左(右)局部邻域进行泰勒公式逼近,则可以得到理想效果.Coifman与Donoho指出,如果将信号进行循环平移,则在某一次平移时,可以获得对某个奇异点的“最佳”逼近[12].对多次平移而且平移量不同的信号进行消噪,再取平均,则可极大地抑制Gibbs振荡现象,这也是尺度不变(Translation-Invariant,TI)小波变换消噪方法的理论基础所在,其过程可由式(8)表示这里Avgh∈H为平均运算,最大平移量H为原始信号长度N.但是,TI小波变换消噪方法的最大缺陷有两点,首先,TI消噪方法需要将处理信号进行圆周循环移位,虽然得到差一相位的新信号,但信号首尾相接处理,会带来新的误差.其次,TI算法通过循环移位的方法,实质上是将小波基的平移量加细,从而得到各个平移下的小波基,这为重构消噪带来了好处,但由于小波一般需要二进离散化,TI方法未能完全利用所有可能的尺度下的小波基,这种潜在的优势尚需进一步发掘.3.2尺度不变V变换消噪算法理论与实现V级数的再生性提示我们,如果根据信号的特性,对信号进行分割,并对每个区域进行局部尺度变换,使信号的奇异点落在n=q/2r(q,r均为正整数)处,那么,利用V变换可以取得对尺度变换后的间断信号的高效逼近;再通过对逼近信号的逆尺度变换,即可得到重构原信号.对此,我们借鉴了平移不变(Translation-Invar-iant)小波变换消噪方法的思想,提出了尺度不变V变换(Scale-InvariantV-Transform,SIVT)的技术框架,这里的尺度不变是指局部信号可由多个尺度下的局部重构信号组成,具体做法为:在奇异点的一个可变长的局部邻域内,多次对信号进行多项式逼近,对逼近信号求平均,则得到最期望的消噪重构信号.上文提及的V系统,包括了各个尺度下不同支集长度的基函数,这些基函数均由分片多项式组成,非常适合信号局部重构.将SIVT算法过程综合描述如下.SIVT算法.1.选取每个样本点作为中点,将信号分割为两部分进行局部信号尺度变换;2.进行离散V变换,可得不同尺度下的局部逼近信号;3.将这些重构信号取平均或中值,即是期望的消噪信号.为了更清楚地描述以上过程,对于信号xt(0Sm(xt)=x(2(log2(m))t),0t<mt<N),考虑时域尺度变换算子及逆算子(Sm)-1(xt)=x(mt),0t<2(log2(m))在本文中,时域尺度变换算子采用基于分段3次Hermit多项式插值的重采样方法实现.这里的尺度变换参数m,若取离散信号的最小步长1,则可以充分使得局部信号在各个尺度下分解,从而得到高效的逼近.设小波变换和阈值处理的综合过程为运算T表示,那么通过尺度不变V变换消噪的总过程可表示为多次运算之后取中值平均可得消噪信号^x^x=Avgm∈M(Sm)-1(T(Sm(xt))),0<MN通过式(12)可知,SIVT算法复杂度为O(MN2),其中离散V变换算法复杂度为O(N2).下面给出SIVT的相关理论分析及证明.Page7设信号xt(0t<N)在V变换多分辨率子空间j上的逼近分量为这里Vi(0ij)为按照顺序排列的前j个V系统基函数.另有珚Pj=Avgm∈M(Sm)-1(Sm(Pj)),0<MN为子空间j上的尺度不变逼近分量.为了更好说明,假设原信号xt为连续函数,则m∈M为连续变量.由式(9)与(13)以及V系统基函数特性易知,Sm(xt)的逼近分量Sm(Pj)是以子空间j上的V系统基函数的线性组合,是以q/2j,0<qN为间断点的分片连续函数.若Vi(0ij)在其支集区间最高具有Cα连续性,对所有Sm(Pj),1mN,可知在任意m处及邻域必存在一个α-1阶多项式逼近;对所有Sm(Pj)取中值平均珚Pj,则可以极大地抑制重构信号在奇异点处出现的pseudo-Gibbs振荡,提高重构信号的质量.综上所述,尺度不变V变换避免了TI小波变换的缺陷,可以得到更好的逼近.用伪代码将SIVT算法表示如下:fori=1ton//信号长度为nfL=f(1:i-1);fR=f(i:n);//根据点f(i)将信号分为左右两部分ifm<n/2m=2(log2(i));图5Piecewise2信号消噪elsem=2(log2(n-i));endfL=resample(fL,m);//左边部分信号重采样为mfR=resample(fL,n-m);//右边部分信号重采样为n-my=VST([fL,fR]);//V变换y=threshold(y);//进行阈值处理gi=iVST(y);//V反变换gi(1:i-1)=resample(fL,i-1);gi(i:n)=resample(fL,n-i);end珟g=median(gi),0<in4SIVT消噪实验结果下面我们给出3个信号(Piecewise2[33]、Bumps[7-8]、Doppler[7-8])的实验示例,说明SIVT算法对信号消噪的效果.基于参考文献[5-13]的综合分析,平移不变(TranslationInvariant,TI)小波变换消噪方法是目前最佳的信号消噪方法之一,限于论文篇幅,因此本文只用TI小波变换方法进行了效果对比.为了能有更好的消噪效果,采用了对称性最佳并且正交的sym系列小波.在实验中,为了方便比较,所有阈值统一设置为t=2log(N)槡σ(N为信号长度,σ为估计的噪声方差[7-8])(如图5~图7).Page8图6Bumps信号消噪图7Doppler信号消噪5信号自适应简单分割本文提出的SIVT消噪技术,包括两个基本选项:对于一般信号,采取多次分割的方法,并进行尺度变换得到多个局部不同尺度的信号,称之为尺度不变V变换(SIVT)的基本算法;而对于某些简单的分片线性信号,为了降低计算复杂度和提高消噪质量,本文开发了简化的算法方案:采用随机游走(RandomWalker,RW)算法进行一维自适应简单分割,分割后进行信号局部尺度变换使之适应V系统基函数的结构特征,从而可以更方便分离噪声.为方Page9便统一描述,将结合信号分割和尺度变换技术、利用离散V变换消噪的技术方案命名为S-SIVT(意为SIVT的简化算法),详细过程在下文给出.与基本算法的区别在于,S-SIVT只需对待处理信号进行一次分割.显见,S-SIVT消噪的关键在于获得对原信号的理想分割,其消噪的效果依赖于信号分割的质量.信号分割是S-SIVT中的关键技术.在二维信号领域,关于图像分割已有许多研究工作,其中基于图论的图像分割技术是近年来国际上图像分割领域的一个新的研究热点.该方法将图像映射为带权无向图,把像素视作节点.利用最小剪切准则得到图像的最佳分割,该方法本质上将图像分割问题转化为最优化问题,是一种点对聚类方法.随机游走(Ran-domWalker,RW)算法是一种基于图论的图像分割方法[34-36],它对噪声具有鲁棒性,对微弱边缘具有良好响应,而且其计算速度较快,无需迭代.本文采用一维随机游走算法实现了一维离散信号的分割,首先手工设定种子点,然后计算信号中每个非种子点到种子点的概率,并对其赋予概率中最大的种子点所对应的标记,从而得到分割结果.由于直线上的随机游走问题实质上是求边界值为0或者1的4.对每个非种子点赋予能到达的最大概率种子点的标记,将信号分割为两个区域Ω0,Ω()1.5.分别设置每个区域Ωi的端点为新的不同区域种子点Mi,L,Mi,()R,i=0,1,…为区域序号,并标定不同标记.分别计算每个区域内所有非种子点到该区域两个端点Mi,L,Mi,()R的概率Pi,L,Pi,()R,并统计每个区域的两个概率之差的绝对值总和εi=∑j∈Ωi6.选max(εi),i=0,1,…对应的区域Ωi进行区域分割;7.重复步5和步6的过程,直至满足区域数量等于设定值n.Dirichlet问题,可以通过稀疏的、对称的、正定的线性方程系统来求解,使计算速度大为提高.本文采用的一维随机游走信号分割算法如下.1.初始化长度为N的信号为唯一区域Ω0,根据信号特性,人工指定分割区域数量n,其中n=2r,r为正整数;2.设置信号两端端点为不同区域Ω0,Ω()1种子点ML,M()R(左边起第一个点为ML,最后一个点为MR),标定不同标记;3.计算每个非种子点到种子点ML,M()R的概率PL,P()R,计算准则如下:对每个非种子点到达种子点ML的概率为PL(0)=1;PL(N-1)=0;PL(x)=wx,x-1PL(x-1)x=1,2,…,N-2对每个非种子点到达种子点MR的概率为PR(0)=0;PR(N-1)=1;PR(x)=wx,x-1PR(x-1)x=1,2,…,N-2其中wx,y=exp(-β(gx-gy)2)为权值,β为控制参数,在本文中取0.25,gx,g()y分别为相邻两个采样点的幅值.权值wx,y与相邻采样点幅值相近程度相关.最终概率PL,P()R的计算归结为求解类似下面形式的线性方程组:wx,x+1wx,x-1+wx,x+1wx,x+1wx,x-1+wx,x+1由RW分割算法的过程可知,在计算信号样本点归属概率PL,P()R时需要解n×n的线性方程组,通用解法效率为O(n3).因此上述分割算法综合效率为O(kn3),其中,k为分割的区域数目,n为信号长度.因为在解大规模稀疏矩阵构成的线性方程系统时已有许多高效的算法,因此该分割算法效率可以得到进一步提高.必须指出,随机游走算法对含噪声信号的分割质量取决于原信号的结构特征与信噪比,对于大部Page10分的类似Block信号[7-8]的情况,取合理的权值wx,y即可以得到较优的分解.图8给出了利用S-SIVT进行信号Block消噪的过程.图8(a)是含高斯白噪声,长度为1024的信号Block.图8(b)采用1维RW算法进行分割,分割区域数为16,并用分段3次Hermit多项式进行基图8利用S-SIVT进行信号Block消噪下面的实验中,选取了多种不同类型的信号(Block[7-8]、Skyline[28]、Piecewise1[33])作为实例.为了方便比较,所有阈值统一设置为t=2log(N)槡σ(N为信号长度,σ为估计的噪声方差)(如图9~图11).将上述结果汇总列表如表1所示.可以看到,用SIVT和S-SIVT方法进行消噪的信号明显消除了Gibbs现象.事实上,消噪后重构的信号大部分在V变换下的频谱系数为零,也正说明了,采用少数基函数的线性组合可以精确逼近重构信号.消噪处理的本质其实正是逼近,SIVT和于重采样的尺度变换,得到每个区域采样点数目均为64的信号(图8(c)).将图8(c)的信号用0次离散V变换进行分解得到频谱系数(图8(d)),图中幅值较大系数只有13项,其它全部为噪声引起的幅值较小的系数.重构信号与尺度变换后的最终信号分别如图8(e)、图8(f)所示.信号含噪Block22.221735.987544.3647--8.3772Skyline23.183930.378640.4767--10.0981Piecewise120.491828.855937.9228--9.0669Piecewise215.483025.5273--26.39100.8637Bumps20.761528.1911--29.83401.6429Doppler19.217628.1451--29.05940.9143S-SIVT方法可以自适应地逼近分片信号,因而是有效的信号消噪技术.Page11图9Block信号消噪图10Skyline信号消噪6结论通过小波变换与阈值处理消噪因为其方便性和实用性,得到了普遍应用.本文提出了一个基于尺度不变V变换对信号逼近和消噪的技术框架,通过针对信号特征自适应高效地实现信号分割,并对局部尺度变换后信号进行离散V变换,实现信号的消噪Page12图11Piecewise1信号消噪1224和重构.本文方法克服了传统正交变换方法在信号消噪处理中的缺陷,能够消除Gibbs现象.实验结果表明,采用本文所提出的SIVT算法,重构的信号无论信噪比和视觉特征都取得了良好效果,并有望在数字信号处理领域得到应用和进一步发展.
