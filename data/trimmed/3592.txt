Page1高效的基于格的环签名方案田苗苗黄刘生杨威(中国科学技术大学计算机科学与技术学院合肥230026)(中国科学技术大学苏州研究院江苏苏州215123)摘要安全高效的环签名方案有很多重要应用.文中提出了一种新的基于格的环签名方案并在标准模型下给出了正式的安全性证明.在标准的小整数解(SIS)困难假设下,该方案对适应性选择消息攻击是强不可伪造的.与现有的标准模型下基于格的环签名方案相比,新方案签名长度更短,计算效率更高,安全性更强.关键词环签名;格;标准模型;强不可伪造;高效1引言2001年,Rivest、Shamir和Tauman提出了环签名的概念[1].在环签名中,任意环成员可以代表整个环对任意消息签名,验证者只知道签名来自此环,但无法知道具体的签名人.由于环签名没有管理员,没有环的建立和撤销过程,所以它具有无条件匿名性,可以应用于ad-hoc网络、无线传感器网络等场合[2-3].目前,大多数的环签名方案是在随机预言模型下可证安全的[1-6],但是Canetti等人[7]指出随机格(Lattices)是n维空间中规则排列的离散点Page2集合,有以下优点:格上任意实例的安全度都相同;格中运算以线性运算和模运算为主;至今没有可行的量子算法能够破解格上的困难问题(关于格的更多细节读者可以参考文献[12]).这些优点使得设计基于格的签名方案成为了一个研究热点[13-20].Cash等人[14]于2010年提出了一种格基生成算法,并基于此算法设计了首个标准模型下可证安全的基于格的签名方案,但是该方案签名长度较长,计算费时且只能在静态选择消息攻击下证明是存在不可伪造的.最近,Boyen[15]设计了一个高效的基于格的签名方案,在标准模型下该方案被证明对适应性选择消息攻击是存在不可伪造的.2010年,王凤和等人[16]基于Cash等人[14]的签名方案,提出了一个标准模型下对固定环攻击可证安全的基于格的环签名方案,但该方案继承了Cash等人签名方案的固有弱点,因此效率较低,安全性较弱.Wang[17]利用Boyen[15]的签名算法,提出了一个新的标准模型下基于格的环签名方案.虽然作者声称该方案具有很强的安全性,但是他并没有给出安全性的具体证明.此外,上述4个签名方案都不是强不可伪造的,即已知某个环对一个消息的签名后(普通数字签名可以看作只有一个固定环成员的环签名),攻击者可以容易地伪造此环对该消息的一个不同签名.强不可伪造的签名首先由An等人[21]提出,它除了要求签名方案是存在不可伪造外,还要求在敌手已知一个消息的签名后也无法伪造该消息的一个新签名(强不可伪造环签名的形式化定义,请参见本文第2.5节).据我们所知,已有的环签名方案都未要求签名满足强不可伪造性.鉴于强不可伪造的签名方案可用于构造选择密文安全的加密系统和基于身份的盲签名等[22-23],本文我们要求环签名方案满足强不可伪造性.本文基于Boyen的消息添加技术[15],提出一种基于格的环签名方案并在标准模型下给出形式化的安全性证明.在小整数解(SmallIntegerSolution,SIS)假设下,该方案在选择子环和适应性选择消息攻击下是安全的,并且还满足强不可伪造性.与以往的标准模型下基于格的环签名方案相比,本文方案的效率更高,安全性更强.另外,本文方案还可以方便地推广为基于身份的格上环签名方案.本文第2节介绍一些相关的背景知识和算法,并给出环签名的安全模型;在第3节,我们提出一个基于格的高效环签名方案;第4节给出方案正式的安全性证明;第5节将本文方案与同类的两个方案进行比较;第6节总结全文.本文环签名方案的安全性依赖于格中经典的2预备知识2.1格(Lattices)本文的系统安全参数是n,向量均为列向量,矩阵犡的Gram-Schmidt正交化矩阵记为珟犡.定义1.格.设为整数集合,犅=[犫1,犫2,…,犫n]∈Rn×n是n维空间中的一组基,则以犅为基的格定义为Λ=L(犅)={犅狏|狏∈定义2.格上的离散高斯分布.令犮∈Rm,σ>0,Λ是一个格,则Λ上的离散高斯分布是狓∈Λ,DΛ,σ,犮=ρσ,犮(狓)/ρσ,犮(Λ),其中ρσ,犮(狓)=exp(-π‖狓-犮‖2/σ2).2.2困难假设SIS问题的困难性,其定义如下[24].定义3.SIS问题.设q为整数,β(n)是任意的多项式有界函数,矩阵犃∈(q,m,β)为参数的SIS问题是:求一个非零向量犲∈{狏∈SIS假设:如果对某些以n为自变量的有界多项式函数q(n),m(n)和β(n),在不知陷门的情况下,任意多项式时间敌手A成功破解SIS问题的概率是可忽略的,则称SIS假设成立.关于SIS问题安全参数的详细讨论请参考文献[25].2.3相关算法目前,大多数基于格的签名方案都使用了Gentry、Peikert和Vaikuntanathan于2008年提出的GPV格点筛选算法[13].该算法主要包括以下3部分:1.TrapGen(1n).设整数q3,m5nlog(q),σm2ω(log槡m).输入安全参数n,算法TrapGen(1n)输出一个矩阵犃∈个基犅犃∈珟犅犃O(nlog槡q).2.SampleDom(1n,σ).输入参数n和σ,该算法按照分m,σ,0选取随机向量狏∈布D率成立.3.SamplePre(犃,犅犃,σ,狔).输入任意向量狔∈法利用小基犅犃求得一个随机的非零向量犲∈{狏∈σ槡m},使得犃犲=狔(modq).从上述GPV格点筛选算法我们可以知道,矩阵犃的小基犅犃就是SIS问题的陷门.2010年,Cash等人[14]提出了一种格基生成算法ExtBasis和随机Page3化算法RandBasis.令q2,m5nlog(q),算法如下所述:1.ExtBasis(犉=犃‖犆,犅犃).设m为任意正整数,输入矩阵犃∈n×m,该算法输出矩阵犉∈(m+m)×(m+m).2.RandBasis(犃,犅犃).输入矩阵犃∈m×m,此算法产生犃的一个与犅犃无关的小基犅′犃∈犅犃∈m×m.2.4环签名法[10]:环签名方案包括以下3个概率多项式时间算1.系统建立(Setup).输入系统安全参数n,该算法为用户Ui(1imax)输出公钥-私钥对(PKi,SKi)(这里我们假定每个用户都有一个互不相同的公钥,因此用户与其公钥是一一对应的,在不引起混淆的情况下,文中我们会以用户的公钥来代指此用户).出Valid或者Invalid.2.签名(Sign).输入环RS={U1,…,Umax},签名人Ui∈R的私钥SKi及消息M,输出环R对消息M的签名狓.3.验证(Verify).输入环RS、消息M及环签名狓,输显然,在一个正确的环签名算法中,如果签名人是诚实的,则算法Verify总是以极大的概率输出Valid.2.5环签名的安全模型一个安全的环签名方案需要满足匿名性和不可伪造性.文献[10]对匿名性和不可伪造性按照不同的安全强度分别给出了不同的定义.本文的匿名性采用文献[10]的最强定义,不可伪造性采用选择子环安全的定义,并加入了强不可伪造性的要求.注意到,选择子环安全的攻击模型比文献[16]的固定环攻击模型强,与文献[10]的2-用户环签名方案的安全度相同.因此,在这种模型下安全的环签名方案是可接受的.下面我们分别给出环签名的匿名性及在选择子环和适应性选择消息攻击下强不可伪造的定义.定义4.匿名性.设任意多项式时间敌手A赢得以下游戏的概率为SuccanonRS,A-1/2.如果敌手A的优势AdvanonSuccanon略的,则称该环签名方案具有匿名性.游戏定义如下:(1)挑战者C选取系统安全参数n,运行算法Setup,得到所有用户的公钥-私钥对{(PKi,SKi)}max1,并将{PKi}max(2)敌手A提交索引号il,环R={PK1,…,PKl}和消息M∈(0,1).挑战者C使用私钥SKi执行算法Sign,并将结果狓返回给A.私钥,挑战者C返回SKi.(3)敌手A适应性地询问索引号为imax的(4)敌手A提交消息M∈(0,1),两个用户U0,U1和环R进行签名询问,其中U0,U1∈R.挑战者C随机选择b∈{0,1},输入Ub的私钥SKb,运行签名算法Sign(R,SKb,M),并将结果狓返回给A.(5)敌手A输出b作为对签名人身份的猜测,如果b=b,则A赢得游戏.定义5.强不可伪造性.对于任意多项式有界的敌手A,如果他赢得以下游戏的概率是可忽略的,则称该环签名方案在选择子环和适应性选择消息攻击下具有强不可伪造性.该游戏分为以下3个步骤:(1)系统建立(Setup).挑战者C选取系统安全参数n,运行算法Setup,发送公钥集合S={PKi}max1给敌手A,但将私钥集合{SKi}max(2)签名询问(SignQueries).敌手A适应性地选择子环R={PK1,…,PKl}S和消息M∈(0,1).挑战者C运行算法Sign,并将结果狓返回给A.(3)伪造(Forgery).敌手A输出一个环签名(R,M,狓′).如果Verify(R,M,狓′)输出Valid,RS且(R,M,狓′)从未在签名询问中出现过,则A赢得游戏.3基于格的高效环签名方案本文提出的基于格的环签名方案由以下3个概率多项式时间算法构成:1.系统建立(Setup).令素数q3,m5nlogq,L=O(nlog槡q),σ=L·ω(log槡n).系统最大环为S={U1,…,Umax}.选择抗碰撞Hash函数h:(0,1)→{0}×{0,1}d,d+1个独立随机矩阵犆i∈和一个随机矩阵犃0∈TrapGen(1n),输出公钥犃i∈满足珟犅iL.2.签名(Sign).设环R={U1,…,Ul}S,消息M∈(0,1),用户Us∈R的私钥为犅s.签名过程如下:(1)如果(M,R)的签名已经存在,则直接返回此签名;否则,进行下一步.(2)Us计算μ=h(M‖R)(这里我们将R看做一个按用户下标升序排列的字符串,因此,对于不同的环R,h(M‖R)≠h(M‖R)).(3)根据μ的各个分量计算矩阵犆=∑d(4)运行SampleDom(1n,σ),选择l+1个向量狓i∈Page4(i=0,…,s-1,s+1,…,l+1).(5)令狕=狔-∑i∈{0,…,l}\{s}犅s,σ,狕)得到小向量狓s∈(6)保存并输出环签名狓T=(狓T3.验证(Verify).输入环R={U1,…,Ul}S,消息M∈(0,1)和签名狓∈并根据μ的各个分量计算矩阵犆=∑d狓σ(l+1)m+[(d+1)σm+槡m]是否都成立,其中验证矩阵犉=[犃0‖犃1‖…‖犃l‖犆]∈q.当两者均成立时Verify输出Valid;否则,输出n×(l+2)mInvalid.由于算法SampleDom(1n,σ)选取的向量狏∈m以极大概率满足狏σ槡m,又根据算法SamplePre(犃,犅犃,σ,狔)的性质可知,向量狓以极大概率同时满足犉狓=狔(modq)和狓σ(l+2)槡m<槡σ(l+1)m+[(d+1)σm+槡m]名方案是正确的.的环签名方案的基本思想.假设密钥生成中心PKG(PrivateKeyGenerator)有公钥犃0和私钥犅0,密码学Hash函数为H:(0,1)→q,则对于身份为ID的用户,令其公钥为n×mPKID=犃0H(ID),PKG为其生成的私钥SKID=RandBasis(犃0H(ID),ExtBasis(犃0H(ID),犅0)).对于环R={ID1,…,IDl},验证矩阵的主体部分为犉=[犃0‖H(ID1)‖…‖H(IDl)].用户签名时只要将PKID作为整体看待并将最后的签名结果按照约定的顺序重新排列即可,其他过程与上述环签名方案类似.4安全性分析这里我们简要地说明由本方案推广到基于身份本节我们按照本文第2节给出的安全性定义,在标准模型下给出本文方案的匿名性和强不可伪造性的证明.方案的强不可伪造性可归约为格上标准的SIS假设.4.1匿名性签名方案满足无条件匿名性.如下.{0}×{0,1}d,d+1个独立随机矩阵犆i∈定理1.本文提出的标准模型下基于格的环证明.按照本文的定义4,定理1的证明过程(1)挑战者C选择抗碰撞Hash函数h:(0,1)→槡id),一个非零向量狔∈运行算法TrapGen(1n),输出公钥集合〈犃〉={犃i∈q}及相应的私钥集合〈犅〉={犅i∈n×m〈犆〉={犆i}d送给敌手A.(2)敌手A提交关于环R和消息M∈(0,1)的签名询问,挑战者C执行第3节的Sign算法,并将结果返回给A.(3)敌手A适应性地询问索引号imax所对应的私钥,挑战者C返回犅i.(4)敌手A提交消息M∈(0,1),两个用户U0,U1和环R进行签名询问,其中U0,U1∈R.挑战者C随机选择b∈{0,1},输入Ub的私钥犅b,执行第3节的Sign算法,并将输出结果狓返回给A.(5)敌手A输出b作为对签名人身份的猜测.假设敌手A以不可忽略的优势Advanonb=b.下面说明此假设与事实是相悖的.由于本方案的所有合法签名都是特定集合中的随机向量,所以我们只需考察它们的分布情况即可.由第3节的签名算法可知,对于任意的环R={U1,…,Ul}和消息M∈(0,1),任意合法环签名狓和狓′的验证矩阵均为犉=[犃0‖犃1‖…‖犃l‖犆],即有犉狓=犉狓′=狔(modq).根据文献[13],签名狓和狓′所服从的分布是不可区分的(这是由计算签名的算法所决定的).这就是说,敌手A的优势Advanon是可忽略的,所以该基于格的环签名方案满足无条件匿名性.4.2强不可伪造性定理2.如果存在敌手A能够在时间t内,以不可忽略的概率ε伪造本方案的一个签名,则存在一个挑战者C,在时间tt+Q·m(TSample+(max+1)Tmul)内,以不可忽略的概率ε2(1-1/q)Q-1ε(3q)-1破解参数为(q,(max+1)m,2(d+1)σ2(max+1)m2+[(d+1)σm3/2+m]SIS问题实例,其中max为最大环成员数,Q为签名询问次数,TSample表示算法SamplePre每步所花费的平均时间,Tmul是n次标量乘法运算所花费的时间.证明.假设敌手A能够在时间t内,以不可忽略的概率ε伪造消息(R,M)的签名,则挑战者C在多项式时间内以不可忽略的概率破解一个困难SIS问题实例的过程如下:(1)系统建立(Setup).令素数q3,m5nlogq,L=O(nlog槡q),σ=L·ω(log槡n),最大环为S={U1,…,Umax},抗碰撞Hash函数为h:(0,1)→Page5{0}×{0,1}d.挑战者C选择随机矩阵犃i∈(0imax),犇i∈数hi∈q(1id),其中对任意0id要求犇iσ槡m(这种矩阵可以通过运行SampleDom算法来选取).挑战者C运行TrapGen(1n),生成矩阵犈∈机向量狉∈零,则重新选择狉,直至狔非零.令d+1个公共矩阵为犆0=犃0犇0+犈,犆i=犃0犇i+hi犈(1id).最后,C将系统参数{〈犃〉,〈犆〉,狔}发送给A,其中〈犃〉=0,〈犆〉={犆i}d{犃i}max(2)签名询问(SignQueries).敌手A提交环R={U1,…,Ul}S关于消息M∈(0,1)的签名询问(为使分析更加简练,这里我们假设敌手A提交的消息(R,M)互不相同)C如下响应该签名询问:①计算μ=h(M‖R),根据μ的各个分量计算h=1+∑d两种情况:(a)如果h=0(modq)是首次出现,则挑战者Ci=1在向量狉∈(狉T,0)T∈终止.(b)否则,即h=0(modq)第2次出现,则算法否则,即h≠0(modq),继续下一步.②计算犆=∑d犇=∑d取l+1个向量狓i∈i=0q.(l+2)m③令狕=狔-∑i∈{0,…,l}犃i狓i.由于h≠0(modq),所以犅E也是矩阵h犈的小基.挑战者C可以运行SamplePre(h犈,犅犈,σ,狕)得到小向量狓l+1∈h犈狓l+1=狕(modq).④输出向量狓T=((狓0-犇狓l+1)T,狓T1,…,狓Tl+1)∈由上述签名过程可知[犃0‖犃1‖…‖犃l‖犆]狓=狔(modq).由于犇(d+1)σ槡m,即犇狓l+1(d+1)σ2m,所以狓σ(l+1)m+[(d+1)σm+槡m]即返回的向量狓是合法环签名.(3)伪造(Forgery).敌手A以概率ε产生环R={U1,…,Uw}S关于消息M的签名狓′.设固定矩阵犌=[犃0‖犃1‖…‖犃max].由系统建立过程可知,挑战者C没有矩阵犌的小基,因此求小的非零向量狌∈是一个困难的SIS问题实例.下面我们说明,C如何利用敌手A来破解此困难实例.挑战者C得到该伪造的签名后,首先计算μ′=h(M‖R),并根据μ′的各个分量计算h=1+∑d(-1)μ′[i]hi.如果h≠0(modq),则C失败;否i=1则,有以下两种可能情况发生:(a)消息(R,M)从未被询问过.设验证矩阵为犉=[犃0‖犃1‖…‖犃w‖犆],其中犆=犃0犇=犃0∑d(-1)μ′[i]犇i中不含矩阵犈.此时,犉狓′=狔=犃0狉(modq),通过在向量狉∈扩充的非零向量狉′=(狉T,0)T∈犉狉′(modq).由文献[13]知,对任意矩阵犃∈果犃狆′=犃狆(modq),则Prob(狆′=狆)2-ω(logn).令狏=(狏0,…,狏w+1)=狓′-狉′,所以狏=0的概率是可忽略的,即C得到一个非零向量狏满足犃0(狏0+犇′狏w+1)+∑w狏1,…,狏w),如果存在一个狏i(1iw)非零,则狌′≠0;否则,类似于文献[15]的引理26,我们有Prob(狌′≠0)2/3.进一步地,在狌′的合适位置填充0后可得扩充的非零向量狌∈‖狌‖=‖狌′‖‖犇′‖·‖狏‖(d+1)σ2(m+(w+1)m2+[(d+1)σm3/2+m]并且满足犌狌=[犃0‖犃1‖…‖犃max]狌=0(modq).因此,在不知矩阵犌小基的情况下,挑战者C以不可忽略的概率得到了上述困难SIS实例的一个非零解.(b)消息(R,M)被询问过.如果(R,M)不是h=0(modq)首次出现的签名询问,则C失败;否则,我们有[犃0‖犃1‖…‖犃w‖犆]狓′=狔=[犃0‖犃1‖…‖犃w‖犆]犵(modq),其中犆=犃0∑d犃0犇.按照强不可伪造的定义,狓′≠犵,所以C得到了一个非零向量犲′=(犲′0,…,犲′w+1)=狓′-犵,使得[犃0‖犃1‖…‖犃w‖犆]犲′=0(modq).令犲=(犲′0+犇犲′w+1,犲′1,…,犲′w),则[犃0‖犃1‖…‖犃w]犲=0(modq).与(a)类似,挑战者C以较大概率得到一个非零向量犲.在犲的合适位置填充0后可得非零向量狊∈q,满足犌狊=0(modq).类似的,我们有(max+1)m‖狊‖=‖犲‖‖犇‖·‖犲′‖(d+1)σ2(m+(w+1)m2+[(d+1)σm3/2+m]i=0Page6根据以上分析,我们可以令上述SIS问题实例的参数β为2(d+1)σ2(max+1)m2+[(d+1)σm3/2+m]现在我们考虑挑战者C成功的概率ε及所花费的时间t.假设上述两种伪造出现的概率相同.从上述模拟过程我们知道,对第1种伪造,C成功主要取决于签名询问时h≠0(modq)至少出现Q-1次,伪造时h=0(modq)以及狌′≠0,所以C成功的概率不低于2(1-1/q)Q-1ε(3q)-1;对第2种伪造,C成功主要取决于签名询问时h=0(modq)出现一次,(R,M)是首次h=0(modq)的签名询问且犲≠0,所以C成功的概率不低于2C1上,C总的成功概率ε2(1-1/q)Q-1ε(3q)-1.挑战者C成功破解上述SIS问题所花的最长时间t包括Q次签名询问的时间及敌手伪造签名所花费的最长时间t,因此tt+Q·m(TSample+(max+1)Tmul)(这里忽略了加法计算时间).由上述游戏可知,如果有敌手A能够在时间t内,以不可忽略的概率ε伪造本文方案的签名,则存在算法C在时间t内,以不可忽略的概率ε成功解表1几种标准模型下基于格的环签名方案比较验证时间W-H-W的方案[16]m(l+d)TExtB+m(l+d+1)TSamplem(l+d+1)Tmulm(l+k)TmulWang方案[17]m(l+2)Tmul本文方案6结束语基于格的环签名方案是很多协议的基础,也是一个新的研究热点.本文基于Boyen的消息添加技术[15]提出了一种高效的基于格的环签名方案.在标准模型下证明该方案对选择子环和适应性选择消息攻击是强不可伪造的.与以往的标准模型下基于格的环签名方案相比,本文方案的安全性及效率都更高.本方案的主要缺点是公钥、私钥及签名长度比文献[8-10]基于双线性对的环签名方案长,这是目前格签名方案的普遍缺陷,我们可以利用理想格[26]来减少其长度.
