Page1标准模型下可证明安全的BGP路由属性保护机制李道丰1),3)王高才1),3)王志伟2)钟诚1),3)李陶深1),3)1)(广西大学计算机与电子信息学院南宁530004)2)(南京邮电大学计算机学院南京210003)3)(广西高校并行分布式计算技术重点实验室南宁530004)摘要BGP路由协议是目前大多数网络基础设施所采用的重要协议之一.随着网络攻击技术的发展,如何构造安全且容易部署的BGP协议保护机制,仍然是安全路由协议研究中的热点问题.文中提出标准模型下可证明安全的BGP协议的路由属性保护机制———Identity-basedSanitizableSignaturePathVerification(简称IDSPV).IDSPV机制采用基于身份的密码学思想以及可净化签名方案的优点.并结合BGP路由协议特征,在无需证书的条件下,仅需将自己的更新报文签名后再添加到AS_PATH路径中,为BGP路由属性完整性和真实性提供保护.避免证书存储和管理开销.另外,文中给出保护AS_PATH路由属性的安全模型,利用规约技术,在标准模型下给出IDSPV机制的安全证明.通过安全性和性能方面的分析可知,与现有方案相比,IDSPV机制更易于在实际网络中部署.关键词标准模型;边界网关协议;可证明安全;路由属性保护;可净化签名1引言BGP路由协议①是当前唯一使用的域间路由协议,而构建安全的BGP协议一直是近十多年以来互联网研究的热点问题.随着互联网技术的发展和网络攻击技术的提高,BGP协议的安全问题日益凸出,严重影响着网络的正常运营[1],阻碍到互联网的进一步发展.目前BGP路由协议所存在的安全问题是源地址真实性问题和更新报文AS_PATH路由属性的安全问题[2].源地址真实性问题是指路由信息发起者AS(AutonomousSystem,AS)是否真正拥有所声称的IP地址前缀;AS_PATH路由属性安全问题则是AS所更新的报文AS_PATH是否具有完整性和真实性,亦即是否被纂改.具体而言,所有参与路由的AS是否诚实地传播AS_PATH并正确地添加相应的路由信息到AS_PATH中.这两个安全问题将引起非法的路由攻击.前缀劫持就是由于上述安全问题而导致的破坏性巨大的一种攻击方式,而且BGP路由器能够自主地宣告任意错误/恶意路由信息,同时这些路由信息不加任何检测措施就传播到整个互联网,造成全球网络不稳定,甚至瘫痪.因此,在可信可控可管的网络基础设施课题研究中,BGP路由协议的安全问题仍然是不可回避的研究课题[3-4].BGP路由协议的安全问题主要包括BGP会话安全、前缀源地址认证和AS_PATH路由属性信息的真实性和完整性认证等问题.AS_PATH路由属性是BGP最重要的属性之一,其主要任务是按顺序记录一条BGP路由从源AS到目的AS所经过的路径,且可以用于避免环路,提供选路标准.若AS_PATH路由属性信息未得到安全保护,将会遭到篡改攻击而引起路由欺骗、窃取秘密信息和流量以及路由黑洞等危及网络空间安全的严重安全事件.因此,AS_PATH路由属性的保护是BGP安全研究中首先需要解决的关键问题之一.在AS_PATH路由属性信息保护的研究过程中,首先要认识到在BGP上部署任何安全机制都会对其工作性能造成影响这个事实.因此,所研究的AS_PATH路由属性信息保护机制需满足容易部署且能提供安全保护的功能.所谓容易部署是指要求所部署的安全机制能尽量减少对BGP工作性能的影响,如能考虑到存储和资源开销、路由收敛时间影响以及可扩展性等;安全保护要求所部署的安全机制确实能保护AS_PATH路由属性信息的完整性和真实性.针对BGP存在更新报文AS_PATH路由属性的安全问题的研究,目前已有很多研究成果,大致可分为基于密码学技术的保护机制[5-10]、非基于密码学技术的保护机制[11-16]以及这两种机制的整合机制[17].尽管这些方案具有很高的理论研究价值和实际意义,但在现有的众多方案中,容易部署的安全方案未能很好的解决BGP路由安全问题;安全强度高的方案又因计算能力和存储资源等问题而难以部署于互联网中.如路由检测方案[11],虽然引入了异常检测机制,但检测结果本身存在一定的不确定性,因而很难得到更准确的安全保证;而S-BGP协议[5]利用基于证书和数字签名机制给出了AS_PATH路由属性的保护方案,提供了很好的完整性和真实性保护功能,但其所用的部分密码组件运算较为复杂,且增加证书管理负担和存储开销.另外,现有的方案均未给出在标准模型或随机预言机模型下的安全证明.因此,研究既易于部署又能提供很好安全保护的可证明安全的BGP协议AS_PATH路由属性安全机制具有重要的理论价值和实际意义,这也是路由协议安全方面的一个研究方向.密码学理论具有保护信息完整性和真实性的良好属性.同时,根据不同的应用场合和需求,利用密码学理论可以构造出满足不同应用需求的轻量型的密码方案[8,18-19].由于目前用于保护BGP协议安全的公钥密码保护方案大都是基于PKI证书的设计方案(如S-BGP等),PKI体系是集中式的架构,但BGP是分布式的工作架构,若采用基于证书的方案,不仅需要承担证书存储开销,而且使得BGP的部署难以扩展.为此,我们采用基于身份的思想,能够避免证书的使用,从而能使我们的设计方案无需承担证书存储开销.同时,可净化签名方案的优点是具有允许签名的文档可以指定被授权者不需与消息签名者进行交互即可修改文档指定的部分,且修改后的文档的签名仍然有效的属性.因此,在BGP协议中,我们采用可净化签名方案,在更新报文过程中,路由属性更新者(AS)不需要与路由前缀拥有者①RekhterY,LiT,HaresS.Abordergatewayprotocol4Page3以及上一跳的路由属性更新者进行交互,就可以生成更新部分的有效路由属性证明,并直接添加到原来的路由属性证明中,无需重新对整个AS_PATH路由属性进行签名.因此,本文采用基于身份的可净化签名,在标准模型下提出了一种可证明安全的保护BGPAS_PATH路由属性的安全机制———IDSPV机制(Identity-basedSanitizableSignaturePathVerification).IDSPV机制利用AS的身份作为AS的公开密钥,运用可净化签名的特点,允许被授权的AS在更新AS_PATH报文时,仅需对自己更新的部分进行签名,生成AS_PATH路由属性证明,同时能确保更新后的AS_PATH路由属性证明仍然有效.另外,我们在标准模型下给出了IDSPV机制的安全证明.IDSPV机制的优点有:(1)IDSPV机制无需证书部署,从而避免证书存储和管理开销;(2)在更新报文时,IDSPV机制无需重新对整个AS_PATH路由属性进行签名;(3)IDSPV机制是一种标准模型下可证明安全的机制.目前已有的BGP路由保护安全机制和方案均不是标准模型下可证明安全的机制和方案.基于上述的优点,在低端设备的存储能力和计算能力不断提高的背景下,与现有的BGP保护机制和方案相比,IDSPV机制更具有重要的理论意义和应用价值.本文第2节讨论BGP协议安全保护机制的相关研究工作;第3节介绍基于身份的可净化签名模型,提出一种采用基于身份的可净化签名机制保护BGP协议AS_PATH路由属性安全的机制;在第4节中给出机制的安全证明;第5节中给出机制的效率分析;最后在第6节中总结全文并给出进一步的工作展望.2相关研究工作目前,面向BGP协议在更新报文AS_PATH路由属性方面容易部署且安全强度高的保护机制的研究工作仍在不断的探索之中,尚未出现成熟且系统化的方案,已有相关领域的研究工作概括如下:自从BGP协议提出以后,其安全问题得到了广泛地关注.首先,Kent等人在2000年提出S-BGP协议[5],其思想是采用PKI技术来确保网络地址前缀和AS_PATH路由属性的真实性和完整性,通过4种“证书”来解决路由信息的安全保护,但未能给出安全证明,而且路由资源开销较大.随后,各种基于证书和密码技术的保护方案相继提出.Kranankis等人[6]在S-BGP优点的基础上提出了psBGP,它主要利用集中式的信任模型来认证AS号码,并利用分布式的信任模型来验证IP地址前缀的所有权.在网络地址前缀信任方面,通过邻居AS的信誉评价程度来刻画,但是由于网络规模很大,若采用证书机制来确保信任,将严重影响路由协议的正常运行,同时证书的管理也是一个很刺手的问题,难于部署.胡湘江等提出的SE-BGP[20],结合PKI认证中心,建立“安全AS联盟(SecureASAlliance)”,以AS联盟为单位建立PKI认证中心,设计一种新的BGP安全协议机制,该机制采用基于AS联盟的安全体系架构.并提出一种分布式的转换者信任模型(TranslatorTrustModel,TTM),只需局部信息就可进行全局认证,在很大程度上简化了证书的管理.王娜等人[7]提出的基于身份的域间路由协议安全机制,进一步简化证书使用和管理工作.赵宸等人[8]提出的一种轻量化的边界网关协议路径验证机制FTAPV(First-Two-ASbasedPathVerification),主要借助人类社会中排直线队列的思想,通过验证AS_PATH中前两个AS的签名信息的有效性来确认路径信息的真实性.Raimagia等人[9]提出了采用对称密码学技术对BGP路由信息进行加密以确保BGP路由信息的安全,其核心思想是在对等BGP实体建立连接时,采用一种循环移位算法来产生加密密钥,并用SHA-1算法对密钥求Hash值,再将密钥的Hash值通过open消息发给邻居对等BGP实体.其邻居对等BGP实体收到密钥Hash值后,也利用相同的循环移位算法产生密钥并生成新的密钥Hash值,再与接收到的密钥Hash值进行比较,若匹配则建立安全连接,否则中断.该方案能减少签名操作次数和密钥存储需求,但经常出现未能成功连接的情况.最近Boldyreva等人[10]借鉴密码学中可证明安全理论和方法,提出了路径向量路由协议的安全模型,通过规约的方法给出S-BGP的安全证明,指出S-BGP未能完全满足其所提出的安全模型中定义的三个安全目标,并对S-BGP进行改进,是开展BGP协议安全机制研究的关键和突破点.3IDSPV的BGP协议路径属性保护机制3.1预备知识设阶均为q的加法群G1和乘法群G2,g为G1的生成元,存在映射e:G1×G1→G2,具有以下性质:(1)双线性.对于a,b∈Ζq,P,Q∈G1,有Page4e(Pa,Qb)=e(P,Q)ab;(2)非退化性.存在P,Q∈G1,使得e(P,Q)≠1;(3)可计算性.P,Q∈G1,存在计算e(P,Q)的有效算法.定义1.计算Diffie-Hellman(ComputationalDiffie-Hellman,CDH)问题:已知有限的加法群G1,给定元素g,ga,gb∈G1,其中a,b∈未知,求gab.定义2.(ε,t)-CDH假定.若不存在任何概率多项式算法能在时间t内,以至少概率为ε解决群G1上的CDH问题,则称群G1上的(ε,t)-CDH假定成立.可知,在Diffie-Hellman的假设下,CDH问题是一个非常困难的问题[21].3.2基于身份的可净化签名模型基于身份的可净化签名方案[19](IDSSA)具有对披露文档进行认证的功能,主要由4个参与者参与操作:私钥生成器(PKG)、签名者(signer)、可净化者(sanitizer)和验证者(verifier).一个IDSSA方案主要由5个步骤组成:系统参数建立(Setup)、密钥抽取(Extract)、签名(Sign)、净化签名(Sanitize)和验证(Verify).设ID=(ID1,ID2,…,IDn)∈{0,1}λ,M=(M1,M2,…,Mn)∈{0,1}λ,给出算法定义如下:(1)系统参数建立(Setup).给定一个安全参数k,私钥生成器(PKG)生成系统参数params和主密钥msk,其中params公开,msk保密.(2)密钥抽取(Extract).给定一个身份ID,PKG利用主密钥msk计算ID的私有密钥dID,并将dID通过安全信道秘密发送给用户ID.(3)签名运算(Sign).给定系统参数params,签名者身份ID,消息M以及签名者的私钥dID,签名者输出签名σ以及秘密信息ψ.(4)净化运算(Sanitize).给定系统参数params,签名者身份ID,秘密信息ψ以及消息M的签名σ.净化者输出新的消息M及其签名σ.(5)验证运算(Verify).给定系统参数params,签名者身份IDi,以及消息/签名(Mi,σi)和(Mi,σi),利用签名验证算法进行验证,输出有效“True”或无效“False”.3.3安全模型针对目前AS_PATH路由属性已有的攻击方式,我们给出安全模型.在所给的安全模型中,假定攻击者拥有很强的攻击条件和能力,既能知道网络N的拓扑,同时能根据自己的攻击需要来腐化除了攻击对象之外的任意AS.而且攻击者能代表已被腐化的AS执行任意攻击行为,可以修改路由宣告中的AS_PATH路径属性,例如在AS_PATH路由属性中增减AS.在攻击过程中,假定挑战者C和攻击者A之间进行如下的交互游戏:(1)参数建立.给定一个安全参数k,挑战者C利用私钥生成器(PKG)生成系统参数params和主密钥msk.并将params发送给攻击者A,msk保密.(2)请求.攻击者A进行有界多项式次数的请求,而且每次请求都是有记忆、自适应的.具体如下:①密钥抽取请求.攻击者A指定一个身份为ID的AS,挑战者C运行密钥抽取算法得到身份为ID的AS的私钥dID,并将dID发送给攻击者A;②签名请求.攻击者A指定一个身份为ID的AS以及路由属性消息M以及签名者的私钥dID,挑战者C运行密钥抽取算法和签名算法得到(ID,M)的签名σ并发给攻击者A.(3)伪造.攻击者A能成功宣告关于一个身份为ID的AS对自己更新的路由信息AS_PATH路由属性(IP1,AS1,AS2,…,ASi,AS)及其签名σ,使得①攻击者A未进行过关于身份为ID的AS私②攻击者A未对AS_PATH路由属性(IP1,AS1,AS2,…,ASi,AS)进行过签名请求;③攻击者A所宣告的AS_PATH路由属性(IP1,AS1,AS2,…,ASi,AS)及其签名σ有效,即使得未腐化的AS接收到该路由属性时认为是有效的路径.若攻击者A成功伪造有效的AS_PATH路由属性证明,则其可以解决CDH问题的实例.3.4IDSPV保护机制3.4.1IDSPV机制原理本文提出的IDSPV机制和S-BGP的目标一样,主要用于保护AS_PATH路由属性的完整性和真实性以及前缀地址的真实性.我们利用上面提到的基于身份的可净化签名方案模型,提出了一种简称为IDSPV的BGP路由协议AS_PATH路由属性保护机制.IDSPV机制的工作流程如下:(1)系统初始化.包括系统参数建立和每个AS及其相应的BGP路由器密钥的生成阶段.(2)路由更新.更新过程包括添加路由、路由属性证明生成、路由属性证明验证3个主要操作,具体操作流程如图1所示.在路由更新过程中,主要分如下两种情况来实现:钥抽取请求;Page5图1IDSPV机制工作流程当|AS_PATH|=0时,意味着由拥有IP地址前缀的AS发起路由宣告.首先将自己的AS号(ASNumber,ASN)以及下一跳的AS号添加到AS_PATH中;其次利用自己的私钥dID对AS_PATH路由信息进行签名,生成路由属性证明.并将生成的AS_PATH路由信息和路由属性证明传递给下一跳信任的邻居AS.当|AS_PATH|1时,表明AS收到上一跳AS发来的AS_PATH路由信息.在收到路由消息后,AS首先利用上一跳AS的公钥来验证路由属性证明的真实性和有效性;其次,添加下一跳的AS号到AS_PATH中;最后,利用可净化签名算法对更新后的AS_PATH路由信息进行签名,生成新的路由属性证明.再将新的AS_PATH路由信息及其路由属性证明发送给下一跳信任的邻居AS.图1中|AS_PATH|表示AS_PATH的长度.所涉及的函数描述如下:(1)Add(AS_PATH,ASN,Next_ASNumber).表示某个AS将自己的AS号ASN以及它所信任的下一跳AS号Next_ASNumber添加到AS_PATH中.(2)Sig(AS_PATH,dID).表示某个AS利用自己的私钥dID对要宣告的AS_PATH进行签名生成路由属性证明.(3)Sig_San(AS_PATH,dID).表示某个AS利用自己的私钥dID对更新后的AS_PATH进行可净化签名生成新的路由属性证明.(4)Ver(σ,ID).表示某个AS利用公钥ID对).7C+	5C+?=LY 0+;A*1	PA1"PAC+A,;(:5\TILY"#(:F7(;/ :PNF:HU(:F7(;/,C+A路由属性证明σ的真实性和有效性进行验证.3.4.2IDSPV机制实现具体实现方法.在本节中主要给出IDSPV机制中每个操作的(1)系统初始化在系统初始化阶段中,主要建立IDSPV机制的系统,包括系统参数建立和系统中每个AS及其相应的BGP路由器密钥生成.(1)系统参数建立.给定安全参数k,PKG选取阶为q的两个群G1和G2,一个生成元g以及可允许的双线性配对e:G1×G1→G2.而后随机选取整数q,计算g1=gα并选取g2∈G1.PKG选择两个α∈元素u,m∈G1以及两个含有n个元素的向量犝=(ui),犞=(vi),其中向量的元素均随机取自于群G1.从而得到系统参数为params=(G1,G2,e,q,g,g1,g2,u,m,犝,犞),以及系统主密钥为gα(2)BGP路由器密钥生成.每个路由器将自己的身份信息IDi=Hash(IPR(i)‖ASi‖ti)做为自己的公钥,将IDi表示为IDi={ID1并发给PKG,其中IPR(i)为ASi中第i个边界路由器的IP地址或MAC地址,ASi为第i个边界路由器所属的第i个AS域;ti为BGP路由器公钥的有效期.其私钥dIDi生成如下:PKG随机选取一个整数rIDi,并按式(1)计算:dIDi=(d(1)其中j=1,2,…,n.此步中包括宣告前缀消息签名Page6AS的公钥、宣告前缀消息签名AS的私钥、更新AS_PATH的AS公钥以及更新AS_PATH的AS私钥的生成.限于篇幅,我们这里不做详细地说明.(2)路由更新在路由更新阶段中,主要给出路由属性证明生成、路由属性证明验证的3个操作:Sig(AS_PATH,dID)、Sig_San(AS_PATH,dID)、Ver(σ,ID)的实现.①源路由宣告的属性证明生成Sig(AS_PATH,dID)函数实现,即生成路由属性证明(AS_PATH路径签名,文后涉及到的签名均指路由属性证明).假定源路由宣告(前缀)的发起者为AS1,其发布路由通告信息NLRI(IP1),并通过其路由器将该信息发送给其信任的邻居AS,这样的AS可能有很多个.为了方便描述,我们仅讨论一个AS的情形,同时不对AS和它下面负责宣告路由信息的BGP路由器作区分,也可将负责宣告路由的BGP路由器看作其所在的AS.设邻居AS为AS2,并生成AS_PATH路径属性(IP1,AS1,AS2),同时计算:H1=Hash(dID1‖IP1‖AS1‖ID1);h1=Hash(H1‖AS2‖ID2),并将h1分成n份,表示为h1={h11,h21,…,hn1},其中Hash()为Hash函数.AS1随机选取一个整数r-计算AS_PATH路由属性证明:ID1v∏nσ1=d(1)ID1=gr-ID1,σ3=grID1σ2=d(2)并可将NLRI(IP1)、AS_PATH属性(IP1,AS1,AS2)、路由属性证明σ=(σ1,σ2,σ3)以及H1一起发给信任的邻居AS2.②更新路由的属性证明生成Sig_San(AS_PATH,dID)函数实现,即下一个AS进行的AS_PATH路由属性证明.在实现过程中,我们采用可净化签名技术,将更新的路由信息部分直接添加到原来的路由属性证明σ中,生成新的路由属性证明,而且保持新的路由属性证明有效,同时起到聚合签名的作用.以下给出具体实现过程.当邻居ASi接收ASi-1发来的信息(σ1,σ2,σ3)以及Hi-1时,进行如下操作:(i)首先根据AS_PATH信息以及自己的身份IDi来验证路由路径证明(σ1,σ2,σ3)的有效性,验证方法详见路由属性证明验证Ver(σ,ID)函数的实现,若路由证明无效,则丢弃该路由信息.否则进入下一步;(ii)指定要更新的路由属性以及下一跳信任的AS.ASi在自己的信任邻居列表中选取信任的AS,记为ASi+1,以及该域的身份IDi+1,并计算:并将hi表示为hi={h1i,h2i,…,hni};(iii)ASi更新自己要宣告的AS_PATH路由属性为(IP1,AS1,AS2,…,ASi,ASi+1),随机选取两个整数r-运算:将NLRI(IP1)、AS_PATH属性(IP1,AS1,AS2,…,ASi,ASi+1)、路由属性证明σ=(σ1,σ2,σ3)以及Hi一起发给下一个信任的邻居ASi+1.如步骤(iii)中所示,ASi仅需将要宣告的AS_PATH路由属性中的更新部分的路由属性证明按式(3)添加至原来的路由属性证明中,无需重新对整个AS_PATH路由属性进行签名.(3)路由属性证明验证Ver(σ,ID)函数的实现.当邻居ASi接收ASi-1发来的信息NLRI(IP1)、AS_PATH路由属性(IP1,AS1,AS2,…,ASi)、路由属性证明σ=(σ1,σ2,σ3)以及Hk-1时,进行如下计算:①对于每一个ASk,其中k∈{1,2,…,i},计算Hash值:hk=Hash(Hk-1‖ASk‖IDk),并将hk表示为hk={h1k,h2k,…,hnk};②对于k∈{1,2,…,i},判断式(4)是否成立:e(σ1,g)=e(g1,g2)∏i若式(4)成立,意味着接收到的路由信息有效.e(σ1,g)=eσ1u∏n正确性分析:由式(4)的左边等式有Page7因此,只要BGP协议遵循上述保护机制,即可σ2=g∑i保证AS_PATH路由属性的完整性和真实性.4安全性分析本节主要对IDSPV机制的安全性进行分析.我们利用密码学中的规约技术和可证明安全的方法,给出IDSPV机制在标准模型下的安全证明.定义3.假设网络I中的AS规模大小为N,称攻击者A是一个具有(t,qe,qs,ε)能力的攻击者:在IDSPV机制中,A可以进行qe次私钥抽取请求和qs次的签名请求,在运行时间为t内能以不可忽略的优势ε成功伪造有效的AS_PATH路由属性.定义4.若IDSPV机制能抵御定义了的攻击,则称IDSPV机制为(t,qe,qs,ε)安全.定理1.如果(ε,t)-CDH假定成立,上述的IDSPV机制是(t,qe,qs,ε)安全.证明.假定IDSPV机制不是(t,qe,qs,ε)安全,则存在一个攻击者A,A进行qe次私钥抽取请求和qs次的签名请求,在运行时间为t内能以ε的优势根据IDSPV机制的步骤能成功伪造有效的AS_PATH路由属性.在这样的假定下,给定群G1和它的生成元g,则存在一个求解算法B能在运行时间t内以ε的优势解决CDH问题的一个实例,即在收到ga、gb后,能用算法B求解gab,其中其中tG1为群G1中指数运算所花的总时间.对于给定运行IDSPV机制的网络I,而且网络I中的AS域的个数|AS|=N>2,在攻击过程中,算法B充当挑战者的角色与攻击者A进行交互,两者掌握共同的资源,在攻击者A能攻击IDSPV机制成功伪造合法的AS_PATH路由属性时,算法B也能成功求解攻击场景中涉及到的具体CDH问题的一个实例.具体攻击步骤如下:首先,算法B构造用于求解CDH问题实例的部分数据和系统参数.随机选取以下整数和参数:整数ru和rm,其中要求0<ru<q,0<rm<q;整数su和sm,其中要求0<su<n,0<sm<n(ru(n+1)<q,rm(n+1)<q);令ru=2(qe+qs),rm=2qs.整数x∈ru,y∈rm,z∈q,w∈q;n维向量(x1,x2,…,xn),其中xi∈ru;n维向量(y1,y2,…,yn),其中yi∈rm;n维向量(z1,z2,…,zn),其中zi∈q;n维向量(w1,w2,…,wn),其中wi∈q;同时,对于网络I中的任意身份为ID的AS,将其身份表示为ID={ID1,ID2,…,IDn},并构造与身份为ID的AS相关的AS_PATH路由信息AS‖ID,h=Hash(AS‖ID),表示为h={h1,h2,…,hn}.利用这些信息构造如下4个函数:并构造以下系统参数:u=g-rusu+xu=g-rmsm+yuIDii=gF(ID)且有u∏ni=1然后将网络I以及上面的信息发给攻击者A.其次,在攻击IDSPV机制过程中,当攻击者A在任何时间内进行询问AS私钥抽取oracle和AS_PATH签名oracle时,算法B给以如下响应:(1)私钥抽取请求.当攻击者A向算法B提交关于身份为ID的AS的私钥抽取请求时,算法B进行如下操作:①若F(ID)=0mod(ru),则算法B终止并输出“失败”;Page8一个整数rID∈dID=(d(1)=(g-J(ID)②若F(ID)≠0mod(ru),则算法B随机选取并将身份为ID的AS的私钥(d(1)击者.由于ID=g-J(ID)d(1)ID=g-1d(2)其中狉ID=rID-a因此所构造的私钥(d1,d2)是有效的.(2)AS_PATH路由属性证明(签名)请求.当攻击者A向签名oracles提出关于身份为ID的AS生成的AS_PATH路由属性证明,即对自己更新的路由属性的签名.自己更新的路由信息就是所信任的下一跳的AS域及其身份ID,记为AS‖ID.算法B操作如下:①若F(ID)≠0mod(ru),算法B调用前面给出的私钥抽取请求来构造身份为ID的AS的私钥,再用私钥对更新的AS_PATH信息进行签名即可;②若F(ID)=0mod(ru)且K(h)≠0mod(rm),则算法B选取r,r∈σ=(σ1,σ2,σ3)i()i(=u∏n③若F(ID)=0mod(ru)且K(h)=0mod(rm),则算法B终止并输出“失败”.(3)AS_PATH路由属性证明(签名)伪造.倘若算法B在求解过程中未终止,则攻击者A能成功输出一个身份为ID的AS生成的路由属性证明σ=(σ1,σ2,σ3),从而能成功伪造有效的AS_PATH路由属性(IP1,AS1,AS2,…,ASi,AS).最后,算法B对CDH问题实例进行求解.若F(ID)≠0mod(q)且K(h)≠0mod(q),算法B终止操作.否则,若F(ID)=0mod(q)且K(h)=0mod(q),那么算法B可求出CDH问题的实例的一个解为为了确保算法B能以至少ε的概率成功解决CDH问题实例,算法B需在同时满足如下3个事件的条件下进行:①Evt1.当攻击者A进行AS私钥抽取请求时算法B不会终止,即要求F(ID)≠0mod(ru);②Evt2.攻击者A能生成身份为ID的AS对自己更新的路由信息的一个有效的路由属性证明(签名)σ=(σ1,σ2,σ3);即至少要求K(h)≠0mod(rm);③Evt3.路由属性证明伪造成功,同时要求F(ID)=0mod(q)且K(h)=0mod(q),其中1in.为了便于计算,定义Ui:F(ID)≠0mod(ru);U:F(ID)=0mod(q);Vj:K(h)≠0mod(rm);V:K(h)=0mod(q).则算法B成功的概率等价于Pr[Bsucc]Pr∩qe+qs=Pr∩qe+qs=Pr∩qe+qs式(7)、(8)均由Ui、U、Vj、Vj相互独立而得到,其中Pr[U]以及Pr[∩qe+qsPr[U]=Pr[F(ID)=0mod(q)∧F(ID)=0mod(ru)]Pr∩qe+qsi=1U[]i=1-Pr∪qe+qs因此,我们得到Pr∩qe+qsi=1Ui∧U[同理可得从而有Page9得到ε的值为算法B的运行时间为攻击者A的运行时间加上qE次私钥询问以及qS次签名询问的响应时间,且将攻击者A的伪造签名转化为解决CDH问题的时间.在攻击游戏中,每次私钥抽取询问中,总共进行了5次群G1中的指数运算;每次签名询问中进行了(2N+4)次群G1中的指数运算.因此总的运行时间有如下关系:其中,tG1是群G1中指数运算所花的总时间.当然,在算法B的模拟过程中,若事件Xi:F(ID)=0mod(ru)或者事件Yj:F(ID)=0mod(ru)且K(h)=0mod(rm)发生,则会导致攻击失败而终止.易知,攻击失败的概率为Pr∪qei=1Xi∨∪qsj=1Y[其中式(9)的结果由Xi、Yj相互独立得到,式(10)根据前面的参数设置得到.若N、qe和qs都很大时,攻击者A攻击失败的概率一定程度上不影响我们模拟攻击的完成.证毕.假定在参与路由宣告过程中的AS既是签名者又是可净化签名者,实际上在IDSPV机制中就是如此.任何AS均不能修改前面AS所更新的路由属性.具体地,若攻击者A已攻陷了自治域ASi,攻击者A能篡改ASi接收到的路由属性(IP1,AS1,AS2,…,ASi),则意味着我们的保护机制未能达到存在不可伪造签名安全.因此得出如下结论.定理2.假定存在有界多项式攻击者A能在时间t内经过至多qe次的密钥提取询问和qs次的签名询问后以优势ε来攻破IDSPV机制中AS_PATH路由属性的不可改变性,则存在一个算法B能在时间t内以优势ε来产生一个有效的签名.ASi-1的私钥,并获得私钥(d(1)②算法B令犱(1)证明.AS_PATH路由属性的不可改变性是指即使攻击者A未能合法地将路由属性(IP1,AS1,AS2,…,ASi)修改为(IP1,AS1,AS2,…,ASi),即将ASi替换为ASi,其中ASi为未授权的自治域.若攻击者A将接收到的路由属性中插入路由信息如ASi,则更改为(IP1,AS1,AS2,…,ASi),而且更改后的路由属性有效,意味着算法B可以产生一个有效的路由属性证明(签名).具体分析如下:(1)参数建立.攻击者A在游戏中与算法B及其挑战者C进行如下交互:①算法B向挑战者C提交一个请求,挑战者C给算法B返回系统的参数如下(G1,G2,e,q,g,g1,g2,u,v,u1,…,un,v1,…,vn);ui=gti,并添加到发给算法B的系统参数之中;vi=gsi,并添加到发给算法B的系统参数之中.于身份为IDi的ASi的私钥,算法B如下响应:②对于i=1,…,n,算法B选择ti∈③对于i=1,…,n,算法B选择si∈(2)私钥抽取请求.攻击者A向算法B提交关①算法B向挑战者C请求身份为IDi-1的IDi-1,并将(犱(1)d(2)(3)路由属性证明(签名)请求.当攻击者A向算法B提交关于身份IDi的ASi对路由信息ASi+1‖IDi+1的路由属性证明(签名)询问时,算法B进行如下操作:①算法B计算Hi=Hash(犱IDi‖ASi‖IDi),h=Hash(Hi‖ASi+1‖IDi+1),并将h表示为h={h1,h2,…,hn};②算法B向挑战者C询问关于身份IDi-1的ASi-1对路由信息ASi‖IDi的路由属性证明,并得到(σ1,σ2,σ3);攻击者A.③算法B令σ1=σ1·σIDiti2∏n④算法B将(σ1,σ2,σ3)∪(σh1si3,…,σhnsi3)发给(4)路由属性证明(签名)伪造.假定攻击者A能输出一个由身份ID⌒的AS⌒对相关的AS_PATH路由信息AS‖ID的一个有效路由属性证明(σ^1,σ^2,σ^3),则算法B在攻击者A伪造的签名的基础上也能获得一个有效路由属性证明,具体如下:①攻击者A将路由相关信息AS‖ID及其路Page10由属性证明(σ^1,σ^2,σ^3)发给算法B,其中AS‖ID不是ASi指定的合法消息.②B构造身份为ID的ASi对相关的AS_PATH路由信息AS‖ID的有效路由属性证明,其中AS‖ID不是ASi指定的合法消息.具体计算如下:很容易验证,σ=(σ1,σ2,σ3)是身份为ID的ASi对相关的AS_PATH路由信息AS‖ID的有效路由属性证明.从定理1的证明可知,算法B能求解CDH问题的一个实例.显然,算法B成功伪造有效路由属性证明的前提条件是攻击者A能改变了IDSPV机制的AS_PATH路由属性的不可改变性,因此B成功的概率εε.同时,算法B运行的时间t等于攻击者A运行的时间t再加上它响应qe次的密钥提取询问和qs次的签名询问所花的时间.而每次密钥抽取询问需要算法B在群G1中进行n次的指数运算;每次签名询问需要算法B在群G1中进行2n次的指数运算.假定群G1中进行指数运算所花的时间为te,则有t=t+(n·qe+2n·qs).5效率分析针对第3节提出的IDSPV保护机制,本节给出了存储和平均收敛时间两个指标的效率分析.在存储方面,我们主要考虑保护机制中更新路由信息的大小增量以及证书存储开销;在平均收敛时间方面,主要考虑更新路由信息总数、签名运算次数及所花的时间以及签名验证运算次数及所花的时间.在测试过程中,所采用的测试网络场景参数是:假定有m个AS,每个AS均有a个ASspeaker,且与b个AS对等链接,同时每个ASspeaker发布c个前缀信息,该信息传播到整个网络,在传播过程中接收到宣告信息的AS进行更新,直至路由稳定收敛.5.1存储增量在考察存储增量中,主要考虑IDSPV机制和S-BGP中的报文长度分别比BGP更新报文长度的增加量.由于IDSPV机制采用了可净化签名方案,在更新报文中增加了路由属性证明(σ1,σ2,σ3)属性,因此IDSPV机制中的更新报文长度比BGP协议的更新报文长度约增加92.6字节.若在有限域F397上进行,则IDSPV机制中更新报文的大小增量为ΔUpdate_IDSPV=92.6(L1).而采用1024比特的RSA算法的S-BGP中更新报文的大小增量为ΔUpdate_RSA=128L,FTAPV机制中更新报文的大小增量为ΔUpdate_FTAPV=81(L1),其中L为BGP中AS_PATH的长度.图2所示的结果是随着AS_PATH长度L不断增加,IDSPV机制、FTAPV机制以及采用1024比特的RSA机制的S-BGP中更新报文长度增量的变化.图2IDSPV、S-BGP和FTAPV更新报文长度增量我们从图2观察到:S-BGP机制的更新报文长度增量随着AS_PATH长度L不断增加而增加,而IDSPV机制和FTAPV机制并未发生变化.尽管IDSPV机制中更新报文新增加了一个属性,相当于3个签名长度,但在每次生成路由属性证明过程中采用可净化签名技术,只需按照3.4.2节的式(4)对更新的报文进行聚合添加,起到了聚合签名作用,占用较少的存储空间,而且增量未随着AS_PATH长度L的变化而改变.因此采用IDSPV机制的路由更新报文增加的长度比采用RSA机制的S-BGP的路由更新报文增加的长度小;对于FTAPV机制,IDSPV机制报文长度增量略高,但如下面表1所示,IDSPV机制不需要存储证书.从存储开销方面来说,由于IDSPV机制主要基于身份的可净化签名方案,避免了使用证书,因此不需承担证书存储开销,仅需承担系统参数和更新报文长度增量的存储开销.但目前基于密码学的BGP路由属性保护方案多数采用了证书,比如在S-BGP中,总证书规模为N2,单个BGP路由器的证书规模为N;在IDPV[7]中,总证书规模为0.027N2,单个Page11节点证书规模为0.027N;其中N是网络拓扑I中的AS规模;FTAPV[8]中,总证书规模为珚O×(1+珚O),单个节点证书规模为珚O×(1+珚O)×N,其中珚O=avg_p×(1+avg_p),avg_p为每个AS拥有的平均邻居数目.X.509证书的大小约为600byte[22],若N很大时,如CIDRReport①数据给出,2014年2月14日在Internet中约有46351个AS,会导致每个BGP路由器承担的证书存储开销很大,再加上承担系统参数和更新报文长度增量的存储开销,将会占用很多的路由器存储空间,因而影响BGP路由器的工作性能.表1给出各方案采用证书的规模.方案每个路由器需存储的证书规模全网需存储的证书规模IDSPVFTAPV珚O×(1+珚O)IDPVS-BGP表1中给出了IDSPV、FTAPV、IDPV以及S-BGP等方案中需要存储的证书规模.从表中可知,IDSPV机制由于采用了基于身份的密码学,不再需要证书机制.因此,在证书方面IDSPV机制比其他方案更优.5.2平均收敛时间我们所考虑的路由平均收敛时间与产生的更新报文总数#Update、生成路由属性证明运算次数#Sign及所耗时间tSign、路由属性证明验证次数#Verif及所耗时间tVerif等因素有关,当然还与CPU处理信息的能力、所采用的路由属性证明生成算法等有关.根据前面的实验场景和参数设置,获得更新报文的总数为#Update=m×a×b×c.由于在更新的报文中,AS仅选择与自己的路由策略相符合的报文,因此在签名验证时,并不是对所有接收到的更新报文进行验证,而是仅对自己所选择的报文的合法性和完整性进行验证.类似的,AS也仅对所选择的更新报文进行更新并生成路由属性证明.由于AS都是自治域,均可自主地根据自己的路由策略来选取路由,因此对更新报文的选择、路由属性证明生成和路由属性证明验证均具有一定的概率性.在相同的最小路由宣告间隔(MRAI)下,假定每个AS选择更新报文的概率均为Pr{AS_PATHpreferred},则给出路由收敛时间增量模型如下:ΔTime_Conver=Pr{AS_PATHpreferred}×#Update×其中参数ΔTime_Conver表示路由收敛时间增量,其余参数已由上面给出.我们在测试中采用SSFNet②生成网络拓扑,根据SSFNet生成的网络拓扑,搭建了60个AS域,总共120台BGP路由器.我们的IDSPV机制是基于2.4GHz的处理器及Ubuntu11.04操作系统,采用PBCLibrary③来实现.在我们的原型系统中每个AS有1个speaker,且有12个邻居,同时每个speaker生成2个前缀,即a=1,b=12,c=2.具体参数如下设置:最小路由宣告间隔(MRAI)为30s,链路延迟为0.1ms,L=16,Pr{AS_PATHpreferred}=0.8.根据文献[23-24],1024比特的RSA的签名所花时间为50ms,签名验证所花的时间为2.5ms;而有限域F397上的配对运算所花时间为43ms;主要考察随着AS规模大小的变化,采用IDSPV机制的BGP协议、采用RSA机制的S-BGP协议以及未采用任何安全机制的BGP协议的路由平均收敛时间,实验结果如图3所示.图3中表明,采用IDSPV机制的BGP协议的路由平均收敛时间比采用S-BGP的BGP协议的路由平均收敛时间少,而与BGP协议的路由平均收敛时间略多.目前互联网中绝大多数的BGP路由器处理一次UPDATE消息平均需要的时间为1s,在200MHz的CPU(接近目前路由器的计算能力)中,实现有限域F397的配对运算中所需的时间是43ms,而IDSPV机制中进行了1次签名操作和1次验证操作,总耗时为86ms.若遇到高峰期,峰值扩大10倍,也仅耗时860ms.因此,IDSPV机制对BGP路①②③Page12由的平均收敛时间不造成太大影响.6结论BGP路由协议中AS_PATH路由属性的认证问题是BGP路由协议安全的一个重要课题,研究资源开销少、易部署的AS_PATH路由属性安全保护方案仍是重要的研究方向.基于此,本文提出了一种标准模型下可证明安全的BGP路由属性保护机制———IDSPV机制,采用基于身份的可净化签名技术来保护BGP路由属性完整性和合法性的安全机制,同时在标准模型下给出了IDSPV机制的安全证明.在文中详细讨论了IDSPV机制的安全性和性能,与现有方案相比,IDSPV机制更易于在实际中部署实现.由于所采用的可净化签名方案是一种轻量型的签名方案,该机制是可以结合BGP自身的路由策略来决定将路由信息转发给更信任的下一个AS域,从安全性和负载均衡方面来说,具有一定的灵活性和可扩展性.今后的研究工作将进一步研究如何结合BGP自身的路由策略来确定和刻画AS域的信任度,以便更好地确保新机制的有效性.致谢审稿人提出的修改意见对提高论文水平有很大的帮助,在此表示感谢!
