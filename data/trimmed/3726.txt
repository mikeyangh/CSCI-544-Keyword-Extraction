Page1实现分离多级存取结构的黑盒密钥共享体制陈祺1),2)裴定一3)赵淦森2),4)纪求华1),2)2)(广州杰赛科技股份有限公司-华南师范大学服务计算联合实验室广州510310)1)(广州杰赛科技股份有限公司广州510310)3)(广州大学数学与信息科学学院广州510006)4)(华南师范大学计算机学院广州510631)摘要黑盒密钥共享体制和有限域上的密钥共享体制是不同的.该体制只要求主密钥空间是一个有限交换群,并且可以将群运算和随机挑选群元素等过程作为黑盒调用.尤其是,它与群的结构和除数无关.迄今为止,还没有造出有效的实现非门限存取结构的黑盒密钥共享体制.文中给出了任意交换群上的实现一类非门限存取结构的黑盒密钥共享体制的构造方法.作者使用的工具是环上单调张成方案.首先,作者提出弱单调张成方案的概念,并给出了使用弱单调张成方案构造单调张成方案的方法.然后,利用有理数域上的单调张成方案和有限域上的单调张成方案,构造出了一对互素的弱单调张成方案,最终构造出了实现一类非门限存取结构———分离多级存取结构的有效黑盒密钥共享体制.作者构造的新体制可用于构造新的实现分离多级存取结构的环上安全多方计算协议、线性整密钥共享体制、分布式RSA签名协议和新的零知识证明协议.关键词黑盒密钥共享体制;单调张成方案;非门限存取结构;安全多方计算;分布式RSA签名1引言在密钥共享的大多数应用中,都是事先给定了主密钥空间,然后按照访问控制要求(即存取结构)设计相应的密钥共享体制.但是,在有些应用背景下,关于主密钥空间的信息非常有限,比如只知道它是一个有限群或有限环,它的阶数却是未知的或保密的.例如,在门限RSA密码体制中N=pq是RSA模数,公钥e∈(N),私钥d∈(N),满足ed≡(mod((N)).为了将私钥d进行(t,n)门限化(即使得只有至少t个的人联合才能解密,任何少于t个的人都无法由密文得到明文),一个自然的想法是把私钥d利用密钥共享体制在参与者之间共享.但是,此时主密钥空间的规模(N)必须是保密的.因此,需要在不知道主密钥空间规模的前提下设计一个(t,n)门限密钥共享体制.更一般地,我们希望设计一个密钥共享体制,它的主密钥空间可以是任意一个有限交换群.如果一个密钥共享体制的主密钥空间是一个有限交换群(不限定群的阶数),并且可以将群运算和随机挑选群元素等过程作为黑盒调用(即给定输入即得到输出,不需要知道具体的内部处理过程),那么这样的密钥共享体制称为交换群上的黑盒密钥共享体制.黑盒密钥共享体制与一般的有限域上的密钥共享体制[1-6]是不同的,密钥颁发者构造的n个参与者的子密钥为整数环上的要分配的主密钥值的线性组合,并且主密钥值是授权集中的参与者所掌握的子密钥的上的线性组合.另外,每一个参与者的子密钥是一个或多个群元素.1.1研究现状关于这个问题的参考文献不是很多,Desmedt和Frankel[7-8]从门限密码体制出发研究了这个问题.后来,Cramer等人[9]进一步研究了这一问题,并提出了黑盒密钥共享体制的概念.Desmedt和Frankel[8]以及Cramer等人[9-10]构造了黑盒门限密钥共享体制.Cramer和Fehr[9]给出了黑盒密钥共享体制与环上单调张成方案(monotonespanprogram)之间的一一对应关系.周展飞[11]研究了理想黑盒密钥共享体制与普遍理想同态密钥共享体制(universallyidealhomomorphicsecretsharingschemes)及拟阵之间的关系.King等人[12-13]也进行了相关研究,特别是估计了这类密钥共享体制随机性(randomness)的复杂度.黑盒密钥共享体制也有很多重要的应用,可应用于环上黑盒安全多方计算(securemulti-partycomputation)、零知识证明(zero-knowledge)和线性整密钥共享体制(linearintegersecretsharingschemes)的构造等方面.Cramer等人[14]讨论了该体制在环上安全多方计算中的应用,Cramer和Damgrd[15]讨论了该体制在零知识证明中的应用,Damgrd和Thorbek[16]使用构造黑盒密钥共享体制的工具———整数环上的单调张成方案———构造了线性整密钥共享体制.其中,安全多方计算[17-18]和零知识证明[19-20]都是密码学中的重要研究方向,并且都有很多的实际应用.而线性整密钥共享体制可用于构造任意群中的指数(exponentiation)的安全分布式协议(distrib-utedprotocol)[16].例如,可以构造适合任意存取结构的具有任意公共指数(publicexponents)的分布式RSA协议.这些协议是对门限签名的推广,从而使得签名可应用于更广泛的存取结构中.但现在也只是有理论上的结果,因为还没有人具体构造出实现非门限存取结构的线性整密钥共享体制.另外,胡华明和周展飞[21]利用线性整密钥共享体制构造出了好的多方模求逆协议.因此,考虑到这类体制在环上安全多方计算协议、零知识证明和线性整密钥体制等方面的应用,黑盒密钥共享体制是一个有意义的研究问题.但迄今为止,在已有文献中只构造出实现门限存取结构的黑盒密钥共享体制,还没有发现有相关文献构造出实现非门限存取结构的黑盒密钥共享体制,尤其是有效的实现非门限存取结构的黑盒密钥共享体制.虽然Cramer和Fehr[9]将任意交换群上的黑盒密钥共享体制的构造问题转化为环上单调张成方案的构造问题,可以说已经给出了构造黑盒密钥共享体制的充分必要条件,但是他们并没有给出构造实现非门限存取结构的环上单调张成方案的具体方法.因此,事实上他们并没有构造出实现非门限存取结构的黑盒密钥共享体制.仅仅研究门限存取结构的黑盒密钥共享体制并不能完全解决实际问题,因为在很多应用中,所遇到的存取结构并不是门限情况的.例如,银行金库的钥匙共享,核武器发射装置的密钥共享,电子选举中所遇到的存取结构等等.尤其是在电子选举中(密钥共享在电子选举中有着重要的应用[22]),参与投票的人非常复杂,他们可能来自不同的国家和地区,在投票中的地位也可能互不相同,门限存取结构根本无Page3法处理这些情况.从而就需要研究非门限存取结构和实现非门限存取结构的密钥共享体制的构造问题.事实上,实现非门限存取结构的密钥共享体制的构造问题一直是密码学中的重要研究问题,有限域上的实现非门限存取结构的密钥共享体制已有大量的研究成果.其中,多重分拆存取结构的性质和实现这一存取结构的密钥共享体制一直是重要的研究对象,对此可参阅文献[3,23-32].该类存取结构主要包括带重量的存取结构[6,23]、多级门限存取结构[25-26,31]、多组织存取结构[3,24,26]、multilevel存取结构[3,27]、bipartite存取结构[29]和tripartite存取结构[21,24,28]等等.但是在任意交换群上,实现非门限存取结构的黑盒密钥共享体制的研究基本上处于空白阶段.因此,找到构造实现非门限存取结构的黑盒密钥共享体制的构造方法,尤其是有效黑盒密钥共享体制的构造方法是重要而且值得研究的问题(有效密钥共享体制的概念是由Beimel[1]提出的,在实际中有很多重要的应用).1.2主要贡献本文研究的是任意交换群上的实现非门限存取结构的黑盒密钥共享体制的构造问题.我们构造了实现一类特殊的多重分拆存取结构———分离多极(disjunctivemulti-level)存取结构的有效黑盒密钥共享体制.我们的思想是首先构造出上实现分离多极存取结构Γ0的单调张成方案,然后再基于Cra-mer和Fehr[9]给出的黑盒密钥共享体制与环上单调张成方案之间的一一对应关系,构造出相应的黑盒密钥共享体制.但是构造上实现存取结构Γ0的单调张成方案并不是一件容易的事情.首先我们推广了Cramer等人[9]提出的环上单调张成方案的定义,提出弱单调张成方案的概念,并分析了单调张成方案与弱单调张成方案之间的关系,然后通过构造弱单调张成方案来构造单调张成方案.我们证明:如果可以构造出特殊的一类环R上的两个互素的II类型Γ弱单调张成方案,则就可以构造出整数环上的Γ单调张成方案,并给出一种基于含有单位元的交换环Λ上的I类型Γ弱单调张成方案构造II类型Γ弱单调张成方案的方法.然后,我们构造了整数环上的实现分离多级存取结构的单调张成方案.第一步,我们构造出了一个整数环上的II类型弱单调张成方案1.我们先给出整数集上的I类型弱单调张成方案和有理数域上的单调张成方案之间的关系.这个关系表明:如果存在有理数域上的单调张成方案,则可以构造出上的I类型弱单调张成方案.然后,我们构造了上Γ0单调张成方案,从而构造出了上的II类型弱单调张成方案1.第二步,构造出了一个和1互素的II类型弱单调张成方案.我们先讨论了有限域上实现分离多级存取结构的单调张成方案的构造方法.事实上,Tassa[25]构造了有限域上实现Γ0的密钥共享体制.由于有限域上的单调张成方案与线性密钥共享体制是一一对应的关系[1,4-5],所以实际上Tassa已经构造出了有限域上的实现Γ0的单调张成方案.然后,我们给了一个重要的定理,这个定理证明了Tassa的Γ0单调张成方案具有一些特殊的性质,这些性质在构造和上的II类型弱单调张成方案1互素的II类型Γ0弱单调张成方案时有重要的应用.最后,我们构造出了一个和1互素的II类型弱单调张成方案.从而最终构造出了实现分离多级存取结构的黑盒密钥共享体制.1.3论文组织在第2节,我们介绍了密钥共享体制和单调张成方案的一些预备知识和相关概念,然后提出弱单调张成方案的概念,并给出了单调张成方案与弱单调张成方案之间的关系;第3节给出了本文的主要结果,构造了整数环上的实现分离多级存取结构的单调张成方案.在第3.1节,我们构造出了整数环上的II类型弱单调张成方案1.我们先给出整数集上的I类型弱单调张成方案和有理数域上的单调张成方案之间的关系.然后,我们构造了上Γ0单调张成方案,从而构造出了上的II类型弱单调张成方案1.在第3.2节,我们讨论了有限域上实现存取结构Γ0的单调张成方案的特殊性质.这些性质在构造和上的II类型弱单调张成方案1互素的II类型Γ0弱单调张成方案时有重要的应用.在3.3节,我们构造出了和1互素的II类型弱单调张成方案.第3.4节构造出了Γ0有效黑盒密钥共享体制;第4节总结了本文的工作并提出了一些需要进一步研究的问题.2预备知识与相关概念在这一节,我们首先介绍一些任意交换群上的黑盒密钥共享体制的相关概念,然后提出环上弱单调张成方案的概念,并介绍弱单调张成方案与单调Page4张成方案之间的关系.定义1(存取结构).设={u1,…,un}是n个参与者的集合,Γ2是2的一个非空子集,其中2表示的全部子集所构成的集合,即Γ是由的某些子集构成的非空集合.如果集合Γ满足单调性,即如果∈Γ,则对任何的2和,都有∈Γ,则我们称Γ是上的存取结构(accessstructure).若Γ是上的存取结构,则Γ中的任何集合都称为授权集,不属于Γ的的任何子集都称为非授权集.设有授权集∈Γ,如果对每一个集合,集合都是非授权集,那么称∈Γ为极小授权集.设非授权集Γ,如果对每一个集合,集合都是授权集,那么称Γ为极大非授权集.例1(门限存取结构).设t和n是满足关系0<t<n的整数.门限存取结构为定义2.设是n个参与者的集合,并假设由多个级构成,即=∪mi∩j=.设犽={ki}m列,0<k0<…<km,则(犽,n)分离多极(disjunctivemulti-level)存取结构Γ0定义为从现在起,Λ表示含有单位元1的交换环(不一定是有限的),Γ是={u1,…,un}上的存取结构,犕∈d,e是整数集合上的d行e列矩阵,并设是满映射.我们说犕的第j行(j={1,…,d})由ψ(j)标号或“ψ(j)控制第j行”.对于,犕表示犕限制在标号为中的成员的行所构成的矩阵.用d表示犕的行数.同样的,对于狓∈狓∈d对每个∈Γ,设λ()∈向量.我们称它为的恢复向量.用表示所有恢复向量组成的集合.另外,设G是一个有限交换群.我们用加法表示该群的群运算,用0G表示该群的单位元.定义映射×G→G,(μg)→μ·g,则群G可看作是一个-模[33],其中0·g=0G;当μ>0时,μ·g=g+…+g(μ个g相加);当μ<0时,μ·g=-((-μ)·g).我们有时也用μg或gμ代替μ·g.定义3(黑盒密钥共享体制).设Γ是={u1,…,un}上的存取结构,=(犕,ψ,R)定义如上.则我们称为整数集上的Γ-方案(integerΓ-scheme).设G是任意一个有限交换群,并设是任意一个非空集合.对任意一个要分配的主密钥狊∈G,设犵=(g1,…,ge)T∈Ge,其中g1=狊,g2,…,ge一致地随机取自群G.定义狊=犕犵.对于1in,参与者ui得到的子密钥为sui=犕ui犵,则称是可实现存取结构Γ的黑盒密钥共享体制(以下简称是Γ黑盒密钥共享体制),如果下列条件成立:(1)重构要求.如果∈Γ,那么狊T(2)安全性要求.如果Γ,那么狊不能得到下面的定义是由Beimel[1]提出的,用来刻画密概率为1,其中λ()∈是的恢复向量;关于狊的任何信息.钥共享体制的数据扩散程度和有效性.定义4(有效的黑盒密钥共享体制).设=(犕,ψ,R)是Γ黑盒密钥共享体制.它的扩张因子定义为η=t/n.如果η<f(n),其中f(n)是关于n的一个多项式,则称是有效的黑盒密钥共享体制.对于矩阵犖∈Λa,b,设im犖表示它的列空间,即所有向量犖狓∈Λa所组成的空间,其中狓遍历Λb;设ker犖表示满足犖狓=0∈Λa的所有向量狓∈Λb所组成的空间.定义5(单调张成方案).我们称ε=(1,0,…,0)T∈Λe为目标向量.称=(Λ,犕,ψ,ε)是Γ单调张成方案,如果对所有下列条件成立:(1)如果∈Γ,那么ε∈im犕T(2)如果Γ,那么存在κ=(κ1,…,κe)T∈ker犕,其中κ1=1.我们也称可计算Γ.d,其中d是矩阵犕的行数.另外,定义单调张成方案的规模为size()=命题1.设=(犕,ψ,R)是整数集上的Γ-方案,则是Γ黑盒密钥共享体制当且仅当=(,犕,ψ,ε)是Γ单调张成方案,并且对所有的∈Γ,它的恢复向量λ()∈满足犕T由定义5可知,要想证明=(Λ,犕,ψ,ε)是Γ单调张成方案,只需证明其满足定义5中的两个条件.但一般来说,这是不容易证明的.下面介绍我们所提出的弱单调张成方案的概念,这些概念是对单调张成方案概念的推广,并且,Page5我们给出了这些概念和单调张成方案之间的关系.定义6(I类型弱单调张成方案).称=(Λ,犕,ψ,ε)是I类型Γ弱单调张成方案,如果存在1,2∈Λ\{0},使得对所有,下列条件成立:(1)如果∈Γ,则1ε∈im犕T(2)如果Γ,则存在κ=(κ1,…,κe)T∈ker犕,其中κ1=2.定义7(II类型弱单调张成方案).称=(Λ,犕,ψ,ε)是II类型Γ弱单调张成方案,如果存在∈Λ\{0},使得对所有,下列条件成立:(1)如果∈Γ,则ε∈im犕T(2)如果Γ,则存在κ=(κ1,…,κe)T∈ker犕,其中κ1=1.定义8(互素的II类型弱单调张成方案).现令i=1或2.设i=(Λ,犕i,ψi,εi)是II类型Γ弱单调张成方案,其中犕i∈Λdi,ei,并且存在i∈Λ\{0},使得对所有,下列条件成立:(1)如果∈Γ,则iεi∈im犕T(2)如果Γ,则存在κ=(κ(i)ker犕,其中κ(i)如果存在r1,r2∈Λ使得r11+r22=1,则称1和2是互素的II类型弱单调张成方案.在下一节,我们将通过构造互素的II类型Γ弱单调张成方案来构造Γ单调张成方案.引理1[9].设f(X)∈[X]是首项系数为1的不可约多项式,并记它的次数为deg(f)=λ.设环R=[X]/(f(X)).如果=(R,犕,ψ,ε)是环R上的Γ单调张成方案,则存在整数集上的Γ单调张成方案^=(,犕^,ψ^,ε^),并且size(^)=λ·size().下面的两个引理可用于构造实现Γ0的单调张成方案.为了文章的可读性,我们把引理的证明过程放到了附录中.引理2.设f(X)∈[X]是首项系数为1的不可约多项式,并记它的次数为deg(f)=λ.设环R=[X]/(f(X)).如果1=(R,犕1,ψ1,ε1)和2=(R,犕2,ψ2,ε2)是环R上的两个互素的II类型Γ弱单调张成方案,则存在环R上的Γ单调张成方案=(R,犕,ψ,ε).从而,存在一个整数集上的Γ单调张成方案^=(,犕^,ψ^,ε^)并且size(^)=λ·size().引理3.设=(Λ,犕,ψ,ε)是环Λ上的I类型Γ弱单调张成方案,则可基于构造出一个II类型Γ弱单调张成方案由引理2可知,如果可以构造出环R上的两个互素的II类型Γ弱单调张成方案,则就可以构造出整数集上的Γ单调张成方案.引理3给出一种基于环Λ上的I类型Γ弱单调张成方案构造II类型Γ弱单调张成方案的方法.3主要结果这一节将构造出Γ0黑盒密钥共享体制.由于黑盒密钥共享体制的构造问题可转化为整数环上单调张成方案的构造问题,因此,如果能构造出上实现Γ0的单调张成方案,则就可以构造出相应的黑盒密钥共享体制.为构造上实现Γ0的单调张成方案,首先,我们构造出一个上的II类型弱单调张成方案1;然后,为构造出和1互素的II类型弱单调张成方案,我们先讨论有限域上满足某些特殊性质的实现Γ0的单调张成方案的构造方法;最后,我们构造出和1互素的II类型弱单调张成方案,从而构造出Γ0黑盒密钥共享体制.3.1整数环上的II类型弱单调张成方案1为构造出整数环上的II类型弱单调张成方案,首先,我们给出上的I类型弱单调张成方案有理数域上的单调张成方案之间的关系.这个关系表明:如果存在有理数域上的单调张成方案,则就可以构造出上的I类型弱单调张成方案;然后,构造了上Γ0单调张成方案;最终构造出了上的II类型弱单调张成方案1.引理4.设ε=(1,0,…,0)T∈Γ弱单调张成方案单调张成方案=(,犕,ψ,ε).证明.先证明充分性.假设=(,犕,ψ,ε)是Γ单调张成方案,其中d,e.设a表示矩阵犕中所有元素的分母的一个犕∈任意公倍数,定义犕-=a犕,则犕-∈-=(,犕-,ψ,ε)是I类型Γ弱单调张成方案.到对任意∈Γ,方程组犕Tε都存在一组非零解因此它也是方程组犕-T一组解.设b表示Y1,Y2,…,Y的分母的任意一个公倍数,则是方程组犕-T零解.对任意∈Γ,使用这种方法都可以得到一个b.Page6设b表示所有b的一个任意公倍数,其中∈Γ.则对任意∈Γ,有如果Γ,则存在.设c表示κ1,κ2,…,κe的分母的任意一个公其中κ1=1且(κ1,…,κe)T∈ker犕-倍数,则c(κ1,…,κe)T∈ker犕-表示所有c的最小公倍数,其中Γ,则因此对任意Γ,使用这种方法总可以得到c.设cc(κ1,…,κe)T∈ker犕--=(,犕-,ψ,ε)是I类型Γ弱单调张成方案.接下来证明必要性.假设方案,其中犕-∈{0},使得对所有,有当Γ时,存在κ=(κ1,…,κe)T∈ker犕-κ1=2.现设犕-∈当Γ时,因此-=(,犕-,ψ,ε)是Γ单调张成方案.证毕.由这一引理可知:为构造上I类型Γ弱单调张成方案,只需构造上Γ单调张成方案.下面,我们介绍上Γ0单调张成方案的构造方法.首先,我们介绍Birkhoff插值理论[34],这是构造上Γ0单调张成方案时要用到的工具.Birkhoff插值问题:设X={x1,…,xk}是上给定的点集,其中x1<x2<…<xk;犈=(ei,j)k是一个矩阵,I(犈)={(i,j):ei,j=1},d=|I(犈)|(从现在起假设矩阵犈的最右列是非零的);C={ci,j:(i,j)∈I(犈)},是一个有d个有理数的集合,则对应于三元组〈X,犈,C〉的Birkhoff插值问题指的是找到一个满足下面d个等式的多项式P(x)∈d-1[x]的问题其中的矩阵犈称为插值矩阵.定义9.插值矩阵犈中的l-序列是矩阵犈的某一行中最长的连续l序列;即它是一个形式三元组(i,j0,j1),其中,1ik,0j0j1l,使得对所有j0jj1,ei,j=1,同时ei,j0-1=ei,j1+1=0(假设ei,-1=ei,l+1=0.称一个l-序列(i,j0,j1)为支撑的(supported),如果犈在序列的首项元素(leadingentry)中的西北和西南处都有1;即存在inw<i,isw>i和jnw,jsw<j0使得einw,jnw=eisw,jsw=1.引理5[1].假设x1<x2<…<xk.如果插值矩阵犈满足下列条件,则Birkhoff插值问题有唯一解:(1)(Pólya条件)对每个0tl,l是最高阶导(2)犈不包含奇数长度的支撑的l-序列.下面,我们介绍上Γ0单调张成方案的构造方法.首先我们构造出了有理数域上的实现存取结构Γ0的密钥共享体制,其构造如下:(1)主密钥颁发者选择一个随机多项式P(x)∈[x],其中数,{(i,j)∈I(犈):jt}t+1;(2)主密钥颁发者使用中的元素u标识参与者u∈.(3)主密钥颁发者用下面的方式分配子密钥给所有参与者:第i级的每个参与者u∈i,0im,收到子密钥P(k-ki)(u).由这个密钥共享体制,可得到下面的方案=(,犕,ψ,ε):设狉:→并且对所有i0,设狉(i)(x)表示该向量的i阶导数.设tm=n且ui∈,u1<u2<…<un.定义M=(狉(k-k0)(u1),…,狉(k-k0)(ut0);狉(k-k1)(ut0+1),…,狉(k-k1)(ut1);…;狉(utm-1+1),…,狉(utm)).假设t-1=1,定义满函数ψ:{1,…,d}→:ψ(j)=uti-1+j∈i,对ti-1jti和0im,并定义目标向量为ε=(1,0,…,0)T∈定理1.=(,犕,ψ,ε)是Γ0单调张成方案.证明.设={v1,…,v||}并假设Page7其中0l0…lm=||,则是授权集当且仅当存在0im使得liki.只需证明如果∈Γ0是极小授权子集,则ε∈.因为由线性代数知识可知,如果R是域,则im犕Tεim犕Tκ1=1.一般地,可假设中的参与者由式(1)表示(其中lm=k),并且这些标识在中以通常的情况排序,即v1<v2<…<vk.现证明在中ε∈im犕T只需考虑满足下列条件的极小授权子集∈Γ0:(1)∩(∪i(2)对所有l<i,∩(∪l设犕~的犕的||×||子式.因为矩阵犕的后k-||列都是全零向量,所以如果犕~det(犕~)≠0,则ε∈im犕T为了证明犕~所要处理的Birkhoff插值问题所对应的插值矩犕~阵犈具有梯队形式(echelonform).确实,犈的每一行都只有一个元素为1,并且从犈的第1行到最后一行,1的位置是单调非下降的:在前l0行,1出现在第j=0列;在接下来的l1-l0行,1出现在第j=l0列,依此类推.因此矩阵犈并没有定义9意义下的支撑的1-序列.从而,由引理5可知:在上)≠0.det(犕~由定理1和引理4可知,可构造出上的I类型Γ0弱单调张成方案.然后,由引理3就可以构造上的II类型Γ0弱单调张成方案1.从而可以容易地得到下面的结果.推论1.可构造出上的II类型Γ0弱单调张成方案1.3.2有限域上具有特殊性质的Γ0单调张成方案在这一节,我们首先介绍有限域q上的Γ0单调张成方案的构造方法.事实上,Tassa[25]构造了有限域上实现Γ0的密钥共享体制.由于有限域上的单调张成方案与与线性密钥共享体制是一一对应的关系[1,4-5],所以实际上Tassa已经构造出了有限域上的实现Γ0的单调张成方案.然后,我们给出一个重要的定理,这个定理证明了Tassa的Γ0单调张成方案具有一些特殊的性质,这些性质在构造和上的II类型弱单调张成方案1互素的II类型Γ0弱单调张成方案时有重要的应用.首先,介绍Tassa[25]构造的有限域上的实现Γ0的密钥共享体制如下:(1)主密钥颁发者选择一个随机多项式P(x)∈q[x],其中(2)主密钥颁发者使用q中的元素u标识参与者u∈.(3)主密钥颁发者用下面的方式分配子密钥给所有参与者:第i级的每个参与者u∈i,0im,收到子密钥P(k-ki)(u).从而可以构造出下面的单调张成方案=(q,犕,ψ,ε):定义狉:q→并对所有i0,设狉(i)(x)表示该向量的i阶导数.设tm=n且ui∈q,u1<u2<…<un.定义犕=(狉(k-k0)(u1),…,狉(k-k0)(ut0);假设t-1=1,定义满函数ψ:{1,…,d}→:ψ(j)=uti-1+j∈i,对ti-1jti和0im,并定义目标向量为ε=(1,0,…,0)T∈下面我们将给出一个重要的定理.设minΓ0={是Γ0的极小授权子集:∩(∪i且∩(∪lΓ-0={Γ0:只差一个参与者就成为minΓ0中的对任意∈minΓ0,设犕~式,它是通过去掉犕的后k-||列而得到的;对任意∈Γ-0,设犕^表示矩阵犕的||×||子式,它是通过去掉犕的第1列和后k--1列所得到的.定理2.在阶数的有限域q上可以构造出满足下列条件的Γ0单调张成方案=(q,犕,ψ,ε):(1)对任意∈minΓ0,矩阵犕~Page8证明.对任意∈minΓ0,假设标识中参与者的元素由式(1)给出,且这些标识在q中以通常的情况v1<v2<…<vk排序.设首先证明:对任意∈minΓ0,犕~概率至少为1-ρ,即我们将使用数学归纳法证明这一结论.注意到当ki=0,1时,这是显然成立的.接下来证明当ki>1时,结论也成立.设并设μ||-1(狏)表示矩阵犕~(-1)子式的行列式(该子式是通过去掉犕~第1行和第1列而得到的),则按犕~行列式,可得到一个关于vi的多项式其中常量ci是依赖于狏的.设Ω表示所有使得μ-1=0的狏∈Prob(det(犕~∑v∈∑v∈Ω如果狏∈数为ki-1的多项式.因此,vk存在至多ki-1个值使det(犕~Prob(det(犕~如果狏∈Ω,则det(犕~ki-2的多项式.由于狏是-1维向量,所以由诱导假设可知Prob(det(犕~因此可以证明Prob(det(犕~接下来证明对任意∈Γ-0,Prob(det(犕~ρ.和上面的证明思路一样,可以证明Prob(det(犕~因为minΓ0中极小授权子集的数量至多为Γ-0中非授权子集的数量至多为所以矩阵犕满足条件(1)和(2)的概率为因此,如果则存在一个矩阵犕满足题设中的两个条件.证毕.3.3犚上和1互素的弱Γ0单调张成方案由推论1可知,可构造出上的II类型Γ0弱单调张成方案1.设R=[X]/(f(X)).自然地,也可以把1作为R上的II类型Γ0弱单调张成方案.这一节将构造出和1互素的R上II类型弱单调张成方案.假设已经构造出一个上的II类型Γ0弱单调张成方案1=(,犕1,ψ1,ε1).设∈使得对任意∈Γ0,ε1∈im犕T等于的整素数所构成的集合.令λ>logk(k-1)(m+1)n设f(X)∈[X]是一个任意的首项系数为1的λ次不可约多项式,使得对所有p∈Φ,fp(X)(f(X)的系数模p同余后所得到的多项式)在p[X]上都是不可约的.现将1作为R上的II类型弱Γ0单调张成方案.由f(X)的定义可知,对所有p∈Φ,R/(p)都是有限域.确实,对所有p∈Φ,有R/(p)[X]/(p,f(X))p[X]/(fp(X))pλ.注意:对所有p∈Φ,环R中的所有理想(p)都是不同的极大理想.从而由中国剩余定理可知,R/(Q)∏p∈Φ假设对任意p∈Φ,单调张成方案犕(p)=(α(p)犕(p),ψ,ε(p))满足定理2,其中并且ε(p)=(1,0,…,0)T∈Page9犕=(αi,j)n×k使得ui∈R→φR/(Q)瓡u-i→f^(u(p)其中φ是自然满同态,f^是隐式(implicit)同构,且1in.下面将看到可以使用犕构造出I类型弱单调张成方案=(R,犕,ψ,ε),然后可以基于构造出II类型弱单调张成方案2.引理6.对任意∈Γ0,都存在1∈R\{0}使得1ε∈im犕T证明.由定理2已知对于任意p∈Φ,对任意∈minΓ0,都有犕~(p)假设犕-=(α-i,j)n×k.由于f^是隐式同构,所以det(犕^-(p)其中(R/(Q))表示R/(Q)中的所有可逆元所构成的集合.因此det(犕~则在R的分式域K中(注意R中没有零因子)方程(X1,X2,…,X||)T=ε~有唯一解.因此,由组犕~TCramér法则,可得到解其中Bi∈R,i=1,…,.这表明在R中方程组(X1,X2,…,X||)T=det(犕~T犕~T在环R中,det(犕~TRk.由于犕的后k-列都是零向量,所有在环R上det(犕~T则可得出结论:对任意∈Γ0,1ε∈im犕T引理7.对任意Γ0,存在2∈R\{0}使得存在κ=(κ1,…,κe)T∈ker犕,其中κ1=2.证明.对任意∈Γ-0,假设狊表示犕的第1列,犕^表示犕的||×||子式,该子式是通过去掉犕的第1列和最后k--1列而得到的.假设犕-=(α-i,j)n×k,犕-^表示犕-的||×||子式,该子式是通过去掉犕-的最后k--1列而得到的.由于对任意p∈Φ,犕^(p)det(犕-^)=f^-1((det(犕^(p)有唯一解.由Cramér法则,可得到解其中Ci∈R.这表明是方程组犕^(X2,…,X||+1)T=-det(犕^)狊在环R中的一组解.因此(det(犕^),det(犕^)κ2,…,det(犕^)κ||+1)T∈ker犕其中犕通过去掉犕的最后k--1而得到的.由于犕的最后k--1列都是零向量,所以存在(det(犕^),det(犕^)κ2,…,det(犕^)κk)T∈ker犕.令2=∏∈Γ-另外,每一个非授权子集添加至多k个参与者后都可成为一个授权子集(当然这个授权子集不一定是极小的).一般地,可假设只差一个参与者就成为授权子集.现假设则要考虑下列两种情况:子集,其中i<t.(1)添加t中的一个参与者可成为一个授权(2)添加i中的一个参与者可成为一个授权在第1种情况,=kt-1且∈Γ-0,因此接下来处理第2种情况.通过对添加kt-子集;-1个∪t子集0,使得对所有l<t,都有0∩(∪l成立.由于ki,所以kt-ki>kt--1.所以可以构造出这样的集合0.在这种情况,0=kt-1且∈Γ-0,所以从而由于1,所以因此对任意Γ0,都有定理3.可构造出和II类型弱单调张成方案1互素的R上II类型Γ0弱单调张成方案.Page10证明.由引理6和引理7可知,可以使用矩阵犕构造出I类型弱单调张成方案=(R,犕,ψ,ε);然后根据引理3,可基于构造出II类型弱单调张成方案2=(R,犕2,ψ2,ε2),其中对任意∈Γ0,12ε2∈im犕T由于φ(1),φ(2)∈(R/(Q)),所以φ(12)∈(R/(Q)).则存在a,b∈R使得a12=1+bQ.另外,是Q的因子,所以12和是互素的.因此,2和1是互素的II类型弱单调张成方案.证毕.3.4实现分离多级存取结构的有效黑盒密钥共享体制本节将给出实现分离多级存取结构Γ0的有效黑盒密钥共享体制,这类体制在实际中有很多的应用.推论2.可构造出有效Γ0黑盒密钥共享体制.证明.因为1=(,犕1,ψ1,ε1)是II类型Γ0弱单调张成方案,且size(1)=n.另外由引理1可知size(2)=(nlogk(k-1)(m+1)n因此根据引理1,可构造出上的Γ0单调张成方案,其规模为(nlogk(k-1)(m+1)n基于这个Γ0单调张成方案,可构造出实现Γ0的黑盒密钥共享体制.由于这个体制的扩张因子η=size()/n=logk(k-1)(m+1)n<f(n),其中f(n)是一个关于n的多项式,所以该体制是有效的.4结论本文给出了实现分离多级门限存取结构的有效黑盒密钥共享体制的构造方法,首先,推广了环上单调张成方案的定义,提出了弱单调张成方案的概念,并讨论了弱单调张成方案与单调张成方案之间的关系.然后,利用有理数域上的单调张成方案和有限域上的单调张成方案,构造出了实现分离多级存取结构的黑盒密钥共享体制.具体地,我们推广了Cramer等人[9]构造门限黑盒密钥共享体制的方法,结合Tassa[25]构造的有限域上的实现分离多级存取结构的密钥共享体制(注意:Tassa并没有构造出实现级门限存取结构的黑盒密钥共享体制),构造出了实现分离多极存取结构的有效黑盒密钥共享体制.是否可以使用我们的方法构造出实现其它非门限存取结构的黑盒密钥共享体制是一个值得进一步研究的问题.另外,我们所构造的整数环上的实现分离多级门限存取结构的单调张成方案的规模并不是最小的,即所构造的相应的黑盒密钥共享体制的扩张因子并不是最优的.因此,如何构造出扩张因为最优的实现分离多级存取结构的黑盒密钥共享体制也是一个值得进一步研究的问题.
