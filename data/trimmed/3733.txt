Page1标准模型下固定长度的基于身份环签名方案葛爱军1)马传贵1)张振峰2)陈少真1)1)(信息工程大学信息工程学院信息研究系郑州450002)2)(中国科学院信息工程研究所信息安全国家重点实验室北京100190)摘要针对现有基于身份环签名方案签名长度过长、安全性不高等问题,利用椭圆曲线双线性对技术,文中提出了一种新的基于身份环签名方案,在标准模型下证明了其能抵抗适应性选择消息攻击,并且具有无条件匿名性.新方案签名长度达到了固定值,并且算法只需要三个双线性对运算.与现有的标准模型下基于身份环签名方案相比,该方案占用通信带宽低,计算效率高,安全性强,因此能更好地满足应用要求.关键词基于身份环签名;匿名性;双线性对;标准模型1引言为解决传统的基于公钥基础设施(PKI)密码体制使用公钥证书产生的存储和管理开销过大的问题,最早由Shamir[1]提出了基于身份的公钥密码体Page2lin[2]首次将椭圆曲线上双线性对引入到公钥密码体制,并构造了第一个实用的基于身份加密体制.由于双线性对在密码学中具有良好的性质,因此得到了广泛的关注.Rivest等人[3]在研究如何匿名泄露秘密的背景下首次提出了环签名这一概念,并且因为其签名按一定规则首尾相接可组成一个环状而得名.自环签名的概念被提出后,引起了各国学者的广泛关注,一系列高效的环签名方案相继被提出[4-6].环签名可以让用户以一种完全匿名的方式对消息进行签名.任何验证者只能确信这个签名来自环中的某个成员,但却不能确认真实签名者的身份.与群签名[7]相比,环签名可以实现无条件匿名性,并且具有更强的灵活性:没有群管理员,不需要预先建立群组以及撤销环成员等阶段,签名者只要知道某个用户的公钥,不需要对方同意或者合作就可以将其加入到环中进而对消息签名.环签名的这些性质,使得其在电子现金、电子选举、Adhoc网络等匿名身份认证领域有着广泛的应用.基于身份环签名[8-11],作为环签名与基于身份密码体制的结合,已成为近年来的热点研究问题.由于环签名中签名算法要使用环中所有成员的公钥,导致环签名的长度往往与环成员的个数线性相关,因此这类签名只适合于环成员规模较小的情况.王玲玲等人[10]利用累加器技术,提出一种签名长度固定的基于身份环签名方案,但是他们的方案要求环成员固定不变,并且只能在随机预言模型下证明安全性.然而,随机预言机模型把Hash函数作为一个完全随机的理想模型,而真正的Hash函数与随机预言机的问答模式是有区别的,近年来也有学者指出某些在随机预言机模型下可证安全的方案在Hash函数实例化后并不安全[12].因此在不借助于随机预言机的标准模型下设计固定长度的基于身份环签名方案更有意义.利用Waters基于身份的签名技术[13],Au等人[9]首次给出了一个签名长度固定的基于身份环签名方案,并且在标准模型下证明了其安全性.但是该方案存在两个问题:(1)安全性较弱,不能抵抗适应性选择消息攻击;(2)用户的私钥长度为(n+1)(n+2)个群元素,其中n为环成员的最大数目,导致用户的存储代价过高.通过在私钥中嵌入系统公开参数的方法,本文提出了一种新的签名长度固定的基于身份环签名方案,满足无条件匿名性,在标准模型下证明了其对适应性选择消息攻击是存在性不可伪造的,并且私钥长度缩短至(n+1)个群元素,从而在提高安全性的同时,有效地减少了存储量.本文第2节介绍环签名相关的背景知识,包括双线性映射、困难问题假设以及基于身份环签名的定义;第3节给出环签名的安全模型;第4节提出新的标准模型下安全的固定长度的基于身份环签名方案;第5节给出方案的安全性分析;最后,第6节总结全文.2预备知识2.1双线性映射设G1,G2是阶为素数p的乘法群,g是G1的生成元,若一个映射e:G1×G1→G2满足以下3条性质,我们称这个映射为双线性映射:e(ga,gb)=e(g,g)ab.(1)双线性性.对于任意的a,b∈(2)非退化性.e(g,g)≠1.(3)可计算性.对于任意的g,h∈G1,存在一个高效的算法来计算e(g,h)的值.2.2复杂性假设下面介绍本文环签名方案安全性所基于的复杂性假设:计算性n-DHE问题,这是基于2005年欧密会提出的困难问题:双线性计算n-DHE问题[14]的一个变型.可以证明,如果计算性n-DHE问题解决,很容易解决双线性计算n-DHE问题[14],因此本文环签名方案所基于的计算性n-DHE困难问题是比双线性计算n-DHE[13]还要弱的困难问题假设,也即本文的困难问题假设是合理的.定义1.双线性计算n-DHE(Computationn-BilinearDiffie-HellmanExponentiation)问题[14].设G1是阶为素数p的乘法群,且存在双线性映射e:G1×G1→G2,给定2n+1元组(g,h,gα,gα2,…,gαn,gαn+2,…,gα2n)∈G2n+11,其中α未知,要求计算e(g,h)αn+1的值.定义2.计算性n-DHE(Computationn-Diffie-HellmanExponentiation)问题.设G1是阶为素数p的乘法群,g是G1的一个生成元,给定2n元组(g,gα,gα2,…,gαn,gαn+2,…,gα2n)∈G2n知,要求计算gαn+1的值.如果敌手不能在时间t内以一个不可忽略的概率ε计算出gαn+1的值,则称在G1内(t,ε)计算性n-DHE假设成立.2.3基于身份环签名方案的一般化模型根据文献[8],一个基于身份环签名体制一般是Page3由如下4个多项式时间算法组成:(1)系统建立(Setup).该算法是由PKG完成的概率多项式时间算法,输入安全参数λ,输出主密钥s和系统公开参数params.(2)密钥提取(Extract).该算法亦是由PKG完成的概率多项式时间算法,输入一个用户的身份ID,主密钥s和系统公开参数params,算法输出对应ID的私钥skID,并通过秘密信道安全地传送给该用户.(3)签名算法(Sign).该算法是由用户完成的概率多项式时间算法,输入系统公开参数params、消息M、构成环的用户身份集合R以及真实签名者的私钥skID(要求用户ID在环R中,即ID∈R),输出环R关于消息M的签名σ.(4)验证算法(Verify).该算法是由验证者完成的确定性多项式时间算法,输入系统公开参数params、消息M、环R以及对消息M的签名σ,输出判断值“接受”或者“拒绝”.3基于身份环签名体制的安全模型基于身份环签名方案必须满足两方面的安全性要求,一个是不可伪造性,即敌手只有知道环中公钥所对应的私钥时才能生成一个有效的环签名;另外一个是无条件匿名性,即便敌手拥有无限的计算能力并获取所有可能签名者的私钥,其仍然无法确定签名究竟是环中哪个成员所签署.安全模型我们参照了文献[5,8].3.1不可伪造性我们提出的基于身份环签名方案在选择环及适应性选择消息攻击下是存在性不可伪造的(EUF-sR-CMA),其正式定义用如下一系列游戏来刻画,这些游戏分别由敌手和挑战者共同进行:(1)初始化(Init).敌手首先声明一个他要攻击的环R,此环R即为在伪造环签名中要使用到的环成员身份列表.(2)系统建立(Setup).接收到敌手的挑战环R之后,挑战者输入安全参数λ,运行系统建立算法并得到主密钥s和系统公开参数params,挑战者发送公开参数params给敌手,并秘密保存主密钥s.(3)询问阶段(Query).敌手可以进行多项式次数的适应性私钥提取询问和签名询问,挑战者利用自己掌握的主密钥s相应地回答.私钥提取询问:敌手任意选择用户的身份过私钥提取询问.ID,要求挑战者输出对应ID的私钥skID;签名询问:敌手任意选择一个消息M及包含n个身份的集合R={ID1,…,IDn},要求挑战者输出环R关于消息M的签名σ.(4)伪造阶段(Forgery).最后,敌手输出一个对应消息M及环R的签名σ,并且满足以下条件:①对于任意ID∈R,敌手没有对ID进行②敌手对(M,R)没有进行过签名询问.③σ是满足环R对消息M的有效签名,即(M,R,σ)能通过验证算法.我们定义敌手的优势AdvsR-CMA-EUF游戏中它能赢得游戏的概率.定义3.不可伪造性.如果一个敌手能够在时间t内最多进行了qK次私钥提取询问,qS次签名询问后能伪造上述签名的优势AdvsR-CMA-EUFε,我们就称该基于身份环签名方案可以被敌手(t,qK,qS,ε)攻破.如果基于身份环签名算法对于任意多项式t,qK,qS以及不可忽略值ε都不能被敌手(t,qK,qS,ε)攻破,则称其对适应性选择消息攻击是存在性不可伪造的.3.2无条件匿名性为了保证签名者无条件匿名性,基于身份环签名要求验证者只能确信环中某签名者签署该消息,但不泄露真实签名者的身份信息,正式定义如下.定义4.签名者无条件匿名性.对于任意包含n个身份的集合R={ID1,…,IDn}以及对消息M的签名σ,如果任何敌手识别出实际签名者的优势不大于随机猜测,也即输出实际签名者的概率不会大于1/n,我们就称该基于身份环签名方案达到了无条件匿名性.4固定长度的基于身份环签名方案本节我们提出了一种有效的基于身份环签名方案,并且签名长度达到了常数值,具体构造如下:系统建立(Setup).设G1,G2都是阶为素数p的乘法群且G1的生成元为g,双线性映射e:G1×G1→G2,密钥生成中心PKG从G1中随机选择n+2(n为系统允许的环成员最大数目)个元素犌=(g0,g1,…,gn,gn+1),m+1个元素犝=(u,u1,u2,…,um),其中m为待签名消息的长度.取随机数x∈令Z=e(g,g)x.公开参数params=(g,Z,犌,犝),系统主密钥为msk=gx.Page4密钥提取(Extract).给定用户的身份ID∈PKG随机选择rID∈(KID,LID,KID,1,…,KID,n),其中KID=gx(g0)rID,LID=grID,{KID,i=(gi+1(g1)-(ID)i)rID}i=1,2,…,n.签名算法(Sign).令R=(ID1,ID2,…,IDk)为环签名中所包含的k(kn)个身份列表,假定真实签名者身份为IDs,对消息M=(M1,M2,…,Mm)∈{0,1}m进行签名如下:(1)签名者IDs首先对私钥skIDs进行随机化:随机选择t∈KIDs=KIDs(g0)t,LIDs=LIDsgt,{KIDs,i=KIDs,i(gi+1(g1)-(IDs)i)t}i=1,2,…,k.注.私钥随机化算法可以在签名之前完成,也(2)设环R对应的多项式为fR(X)=∏k即此时签名者可以预计算.正确性验证如下:因为σ1=KIDs∏k=gx(g0)(t+rIDs)∏k=gx(g0)(t+rIDs)∏k(∏k(gi+1)(t+rIDs)·yi=gx(g0(g1)-∑ki=1i=1IDi)=∑k+1σ1=KIDs∏kσ3=gr.(3)输出对消息M的签名σ=(σ1,σ2,σ3).验证算法(Verify).给定某签名者代表环R=(ID1,ID2,…,IDk)对消息M=(M1,M2,…,Mm)∈{0,1}m的签名σ=(σ1,σ2,σ3),验证者计算环R对应的多项式为fR(X)=∏k验证如下等式是否成立:e(g,σ1)=Z·e(g0∏k+15方案的安全性分析5.1方案的正确性((gi)y(又IDs是fR(X)=∏k一个根,故-∑k原式=gxg0(g1)y1∏k=gxg0∏k+1故e(g,σ1)=eg,gx(g0∏k+1=e(g,gx)eg0∏k+1=Z·eg0∏k+15.2方案的安全性定理1.如果在G1内(t,ε)计算性n-DHE假设成立,并且假设攻击者最多qK次私钥提取询问,qS次签名询问,那么本文提出的基于身份环签名方案在选择环模型下对适应性选择消息攻击是(t,qK,qS,ε)存在性不可伪造的,其中εε/(4kqS+2),t=t+O((qK+qS)nρ)+O((qK+qS)nτ),ρ和τ分别是G1上乘法和幂指数运算时间.证明.设敌手能以ε的优势攻击成功本文方案,给定挑战者一个计算性n-DHE问题实例(g,h1=gα,h2=gα2,…,hn=gαn,hn+2=gαn+2,…,h2n=gα2n),以下我们将演示如何利用来计算出hn+1=gαn+1,进而解决计算性n-DHE问题.攻击者首先给出要攻击的环成员身份列表R=(ID1,ID2,…,IDk).计算R=(ID1,ID2,…,IDk)对应的多项式为fR(X)=∏kIDi)=∑k+1(1in),再定义u=ha0ngb0,uj=hajngbj(1jm),其中βi(0in),aj,bj(0jm)都是随机p中选取的.令Z=e(g,g)αn+1=e(h1,hn),则主从密钥msk=gx=gαn+1(未知),公开参数params=(g,Z,犌=(g0,g1,…,gn),犝=(u,u1,…,um)).假设待签名的消息M=(M1,M2,…,Mm)∈{0,1}m,为了方便理解,参照Waters[13]的思想,我们首先定义两个函数:F(M)=p-kt+a0+∑mJ(M)=b0+∑mPage50mod(t),定义F(M)=0,否则定义F(M)=1.与进行如下交互:(1)私钥提取询问.假设最多qK次私钥提取询问,任意选择一个用户的身份ID满足IDR,要求挑战者输出ID对应的私钥.计算私钥如下:随机选t∈i=1i=1fR(ID)),输出私钥skID=(KID,LID,KID,1,…,KID,n-1),其中KID=gx(g0)t,LID=gt,{KID,i=(gi+1(g1)-(ID)i)t}i=1,2,…,n-1.注.因为ID不是fR(X)=∏k∑k+1yiXi-1=0的根,故fR(ID)≠0.可以验证,计算私钥skID不需利用到gαn+1的值,这是因为KID,{KID,i=(gi+1(g1)-(ID)i)t}i=1,2,…,n-1相应的αn+1的系数全为0,详细信息如下:在计算KID=gx(g0)t时,(g0)t中含gαn+1的项为g-fR(X)-1∑k+1g-fR(X)-1fR(X)αn+1=g-αn+1恰好与gx=gαn+1约去;而在计算KID,i=(gi+1(g1)-(ID)i)t时,其含gαn+1的项为gfR(ID)-1((ID)iαn+1-(ID)iαn+1)恰好为g0=1.因此对于挑战者来说,其只需知道(gα,gα2,…,gαn,gαn+2,…,gα2n)而无需gαn+1即可完美模拟用户的私钥.(2)签名询问.可以任意选择一个包含k(kn)个身份列表R=(ID1,ID2,…,IDk)以及消息M=(M1,M2,…,Mm)∈{0,1}m,要求挑战者输出一个有效的环签名:①若R不是R的子集,即存在某个ID∈R但IDR,此时可以通过(1)私钥提取询问获得该ID对应的私钥,进一步利用私钥来生成一个有效的环签名.②若R是R的子集,即RR,此时不能通过询问私钥的方法获得一个有效的环签名,但是只要F(M)≠0,仍然可以通过如下方法输出一个有效的签名σ=(σ1,σ2,σ3):随机选s,t∈p,计算R=(ID1,ID2,…,IDk)对应的多项式fR(X)=∏k∑k+1yiZi-1,并令t=t-(α/F(M)),可计算签名σ1=gxg0∏k+1σ2=gs;σ3=gt=gt-(α/F(M))=gth1-(1/F(M)).伪造.模拟结束后,最终攻击者输出一个对应环R=(ID1,ID2,…,IDk)对消息M=(M1,M2,…,Mm)的一个有效签名σ=(σ1,σ2,σ3),如果a0+∑m回失败;否则,按如下方法可解决该计算性n-DHE困难问题:i=1因为伪造的签名能通过验证,必然有σ=(σ1,σ2,σ3)=gxg0∏k+1gαn+1=gx=σ1/gβ0∏k+1可计算得概率分析.上述过程成功,即解决计算性n-DHE问题的成功概率分析如下:假定攻击者至多进行了qS次签名询问,输入的消息分别是Mi(1iqS),记成功的概率为Pr(),则Pr()ε·Pr(F(M1≠0)∩F(M2≠0)∩…∩F(MqS≠0)∩F(M=0)).记Pr(E)=Pr(F(M1≠0)∩F(M2≠0)∩…∩F(MqS≠0)∩F(M=0)),又因为Pr(珚E)Pr(F(M≠0))+∑qS可计算得Pr(E)1/(4kqS+2).因此如果攻击者能够以不可忽略的优势ε攻击成功本文提出的基于身份环签名方案,那么就可以构造一个算法,并以ε=ε/((4kqS+2))的优势解决计算性n-DHE问题.定理2.本文提出的基于身份环签名方案满足签名者无条件匿名性.证明.本文方案输出的环签名σ=(σ1,σ2,σ3)中,显然σ3=gr是随机生成的,没有提供实际签名者的任何信息.另外,σ2=grIDgt,其中rID是由PKG(与实际签名者独立的)随机生成的,t是由实际签名者随机选择的,因此σ2的分布也是随机的.最后我们考虑σ1=gxg0∏k+1部分s和r都是随机的,gx是主密钥,所有这些都没有提供任何有关实际签名者的信息.所以对于敌手Page6来说,给定环签名σ=(σ1,σ2,σ3)仍然等同于暴力猜测,因此本文提出的基于身份环签名方案满足签名者无条件匿名性.5.3性能比较在本节我们主要通过计算开销和通信开销两文献[11]方案文献[12]方案文献[9]方案表1与现有的标准模型下的基于身份环签名方案的性能比较签名算法复杂度(2k+2)E(k+3)E(2k+3)E(k+2)E不失一般性,在性能比较中,我们仅考虑最耗时的双线性对运算(用P表示一个双线性对运算时间)和次耗时的幂指数运算(用E表示一个幂指数运算所花费的时间).在表1中,设k(1kn)为环签名中环的成员个数,n表示系统所支持的环成员的最大个数.通过表1可以看出,考虑到预计算,本文方案在签名算法只需(k+2)个指数运算,具有最高的计算效率.此外,文献[11-12]中的方案签名长度以及验证算法所需双线性对运算的个数都与环成员个数k成线性关系,而本文方案签名长度达到了固定值,并且只需要3个双线性对运算,通信量和计算效率都有了很大改进.与文献[9]方案相比,本文方案签名虽然增加了一个群元素,但是私钥长度由(n+1)(n+2)缩短至(n+1)个群元素,从而有效地减少了存储量.此外,文献[9]方案不能抵抗适应性选择消息攻击,而本文方案可以证明在适应性选择消息攻击性仍然是存在性不可伪造的,安全性也有明显提高.6总结在基于身份环签名体制中,验证者只能确信环中某成员签署了消息,但不能确定真实签名者的身份信息,这使得基于身份环签名在匿名认证及隐私保护中有着广泛的应用.本文提出的基于身份环签名方案,在标准模型下基于计算性n-DHE困难假设证明了其对适应性选择消息攻击是存在性不可伪造的.新方案签名长度达到了固定值,并且方案只需三个双线性对运算,具有极高的运算效率.与现有的标准模型下基于身份环签名方案相比,本文方案无论在通信量还是计算量和安全性上都有了较大改善,具有一定优势.通过在私钥中嵌入系统公开参数的方法,本文签名长度达到了固定值,但是本文方案私钥长度较方面来综合分析本方案的性能,并将我们的方案与已有的标准模型下的基于身份环签名方案进行了性能对比.其中,计算开销主要由签名运算及验证运算两部分组成,通信开销为签名长度.此外,我们还对私钥长度进行了比较,具体如表1所示.大,即牺牲用户存储代价来降低通信带宽,提高运算效率.在网络环境中,系统的通信带宽往往会成为瓶颈,这是因为计算机的处理速度、存储容量服从摩尔定律,而要提高系统的通信带宽往往需要很高的代价.如何在n-DHE困难假设下,尽量缩短私钥的长度,是我们下一步要继续研究的问题.
