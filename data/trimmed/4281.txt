Page1布朗运动模拟退火算法傅文渊凌朝东(华侨大学信息科学与工程学院福建厦门361002)(厦门市专用电路系统重点实验室福建厦门361008)摘要针对传统模拟退火算法计算效率较低的问题,文中将布朗运动和模拟退火相结合,提出一种智能启发式算法.该算法将布朗运动中粒子运动时间和模拟退火温度联系在一起,布朗运动的粒子运动时间等效于退火温度的倒数,通过理论分析得到基于布朗运动的邻域函数模型以及相应的温度下降函数.温度下降函数具有更快的退温特性,保证算法执行过程中具有更高的效率.数值实验结果表明,该算法具有搜索速度快、稳定性高和易于实现的特点,能显著提高求解全局优化问题的计算效率.关键词布朗运动;模拟退火;启发式算法;退火温度1引言随着最优化理论的不断进步和数值计算技术的日趋成熟,极值问题得到快速发展.其研究的理论成果已在集成电路与系统设计[1]、金融学、第三代和第四代无线通信、信号处理等领域得到显著应用.极值问题常见的解决方案有确定性方法和智能启发式方法.模拟退火算法是智能启发式算法中研究较多的一种方法,与遗传法和微粒群法相比,它具有优良的全局收敛特性、隐含的数据并行处理特性、良好的鲁棒特性.但是其缺点是仿真时间过长、退火温度等参Page2数设置对优化结果影响较大.布朗运动是1827年英国植物学家布朗研究液体中花粉颗粒之间的运动时提出的.它是一种典型的随机涨落现象,广泛应用于金融学中的股票、基金、期权等研究领域.目前学者研究的热点主要集中于提高传统模拟退火算法的计算效率和收敛精度,并取得了较为可观的成果.模拟退火算法在执行过程中对搜索空间的信息交流及反馈不够充分,使得在搜索过程中不能有效进入全局最优区域,极易陷入局部最优区域.而算法一旦进入局部最优区域,则需要较大的评价次数以跳出该局部最优区域,降低了模拟退火算法的执行效率.因此将传统模拟退火算法与其他算法或思想相结合,借鉴其他算法的优点来克服传统SA(SimulatedAnnealing)算法的不足,是目前国内外学者重点研究的方向和趋势.在此期间,出现了多种基于不同思想的改进算法.文献[2]将模拟退火算法与禁忌搜索算法相结合,利用函数复杂度自适应调整迭代步长控制参数,然后根据调整后步长求得函数的粗糙解,在此基础上再使用初始步长求得全局最优解,实现了较好的全局寻优能力和较高的搜索精度.文献[3]将粒子群算法与模拟退火算法相结合,利用粒子群算法的收敛速度快、全局搜索能力强以及SA算法的具有跳出局部极值点区域能力的特点来解决约束优化问题.文献[4]提出SASEA(SimulatedAnnealingSteady-stateEvolutionaryAlgorithm)算法,利用交叉算子构造模拟退火算法的邻域函数,并且将候选解嵌入到种群进化过程,利用Metropolis接受准则得到质量较好的子代解.文献[5]在文献[4]的基础上进一步阐述模拟退火和进化算法融合对算法性能的提升,并在此基础上提出两种算法需处理好“勘探”和“开采”的折中关系.文献[6]将模拟退火算法与人工鱼群算法结合在一起,采用AFSA(ArtificialFishSwarmAlgorithm)进行全局搜索,SA进行局部探测,解决了AFSA收敛于全局最优解的速度缓慢问题.文献[7]先使用模拟退火算法为爬山法提供一个较好的初始解,再用爬山法进行精确校正,仅需要少量的模拟退火迭代过程即可提供一个好的初始解.由于精确校正阶段的爬山法速度快,因此获得相同效果需要的迭代次数比普通模拟退火算法大幅度减少,同时大大降低了进入局部最优值的可能.为解决算法早熟问题,文献[8]结合模糊推理、模拟退火算法和自适应机制,提出一种改进算法FASAGA(FuzzyAdaptiveSimulatedAnnealingGeneticAlgorithm).将模拟退火机制结合到遗传算法的交叉算子和遗传算子当中,这样不仅改进了遗传算子,同时保留了遗传算法群体优化和新解产生灵活的特点,而且增加了模拟退火算法的“爬山”能力.文献[9]提出一种类似Cauchy分布的快速搜索方法,极大地提高了随机数的搜索效率.文献[10]提出高温下产生的随机数与初始温度无关的结论,同时在低温下对随机扰动进行适当约束,减小扰动空间,提高了最优解的搜索几率.然而,目前研究表明,传统模拟退火算法计算效率较低,改进算法操作过于复杂,需要设定和控制的参数个数较多,并且各个参数之间的相互影响也会对算法结果产生较大影响,因此在实际应用中存在局限性.本文将布朗运动与模拟退火思想结合在一起,提出了一种新型快速智能启发式算法.数学分析、理论推导和仿真实例验证表明,该算法执行过程简单,可以显著减少调用待测函数的次数,提高求解全局最优问题的效率.2模拟退火算法模拟退火算法由Metropolis等人于1953年提出,而直到1982年Kirkpatrick等人将其真正应用于工业界,才得到快速发展.算法以统计物理为基础,引入物理系统中晶体退火过程的自然机理,采用Metropolis准则接受产生的最优问题解.算法的核心是以一定的概率拒绝局部极小值问题解,从而跳出局部极值点继续开采状态空间的其他状态解,进而得到全局最优问题解.将模拟退火优化算法进行数学抽象,实质为优化函数f(x),minf(x),x∈C,C为状态空间,x代表状态元素.算法伪代码:INITIALIZE(T0,Xmax,Tmax,L,xi);IFT>TmaxrepeatFORk··=1toLdobeginTHENP··=xjEND;k··=k+1;GENERATE(Tk)END;上述算法中T0代表晶体退火的初始温度,XmaxPage3代表晶体退火的最大变化范围,Tmax为退火结束温度,L为马科夫链长度,xi代表初始状态.Xmax由经过编码的可行解集合组成,算法初始状态的选择具有任意性,根据初始状态探测整个状态空间,并且由状态产生函数生成一个新状态,按照Metropolis准则检验是否接受新状态,如果新状态被接受,则把结果反馈到最优状态,同时改变晶体退火温度.传统模拟退火算法能够以概率1收敛于全局最优解,其缺点是退火过程慢,计算效率偏低.由于算法模拟实际晶体的退火过程,因此需对每个降火温度进行多次评估以达到期望的平衡,当退火温度由高温逐渐降到低温时(理想状态是温度为0),晶体中的分子由紊乱状态逐步趋向于平稳状态,从而得到系统全局最优问题解.影响模拟退火计算效率的因素主要有退火初始温度、邻域函数、温度下降函数、退火终止温度、退火结束方式等.3BMSA算法将布朗运动和模拟退火这两种思想结合起来,提出基于布朗运动和模拟退火的智能启发式算法.为阐述方便将此算法简记为BMSA(BrownianMotionSimulatedAnnealing).模拟退火包含内外两个循环,内循环的循环次数为马科夫链长度,并且按照Metropolis准则检验是否接受新状态,因此它的控制是由邻域函数完成的.外循环的迭代次数由温度下降函数和退火终止温度控制.模拟退火算法的性能主要由邻域函数和温度下降函数决定.对于传统的模拟退火算法,收敛性已被证明,但是未给出具体的温度下降函数以及相应的构成方法,因此实际应用中往往采用指数函数、线性一次函数、对数函数等进行退火温度更新.本文基于布朗运动的构成思想提出邻域函数,并在此基础上利用该邻域函数的概率密度确定温度下降函数.BMSA算法主要对这两方面进行控制和设计.3.1布朗运动邻域函数布朗运动是连续时间和连续状态空间的马科夫随机过程,在t>0是连续状态函数,并且其样本函数同样是连续函数[11],假设其变化过程为{B(t),t0},其定义为(1)B(0)=0;(2){B(t),t0}是奇次独立平稳增量过程;(3)对t>0,B(t)是高斯分布的随机变量,且E(B(t))=0.退火过程可以视为正则系统,微观粒子在系统能量较低时出现的概率较大.当退火温度降至最低时,大部分微观粒子出现在能量最低的基态.在算法执行过程中,由初始解生成相应的邻域函数是整个算法是否有效和成功的关键部分.对于邻域函数的要求是尽可能在较高温度下探测状态空间所有可能的取值范围,而在较低温度下能精细地开采解邻域获得全局最优解.由于理想晶体退火的初始温度为无穷高,退火结束温度为0,并且在退火过程中温度变化具有连续性,因此将模拟退火的温度与布朗运动中粒子运动时间联系起来,具体的变换关系为退火的温度的倒数等效于布朗运动的粒子运动时间.晶体退火的初始状态和结束状态分别等价于布朗运动的初始状态和结束状态(粒子运动时间趋于无穷大).布朗运动由花粉颗粒受到周围介质分子撞击的不均匀性造成,其粒子运动时间具有连续性,因此退火过程中邻域函数生成方式可以由布朗运动来模拟.定理1.BMSA算法中邻域函数的概率密度为f(y1,y2,…,yn)=其中,A=T1·y2证明.假设退火过程中的温度序列排布为T1,T2,…,Tn,并且T1>T2>…>Tn0,则1/T1<1/Tn.由于布朗运动是平稳增量过程,因此对于退火过程中任意的温度T1和T2以及退火增量Δ,其中1/T1>1/T2,B(1/T1+Δ)-B(1/T2+Δ)与B(1/T1)-B(1/T2)具有相同的概率分布.B(1/T1+Δ)-B(1/T2+Δ)的概率分布函数只取决于退火温度差,而与实际退火的初始温度无关.令B(1/Tj)-B(1/Tj-1)=yj,j=1,2,…,n.则B(1/T1)=y1,B(1/T2)=y1+y2,…,B(1/Tn)=y1+…+yn.因此B(1/Tn)是yj的一阶线性函数,即E[B(1/Tj)-B(1/Tj-1)]=0,D[B(1/Tj)-B(1/Tj-1)]=1/Tj-(1/Tj-1).B(1/Tj)的概率分布等价于退火温度增量的概率分布.BMSA产生邻域函数的概率密度为f(y1,y2,…,yn)=f1/T1(y1)∏n又因为Page4把式(2)代入式(1),整理得到定理1.证毕.3.2布朗运动温度下降函数根据定理1给出的邻域函数概率密度推导出温度下降函数满足一定条件时,退火过程产生的随机数落在包含坐标原点的实对称区间内的概率趋近于零.定理2.BMSA的温度下降函数满足Tn-1-Tn=eq·nTnTn-1时,由BMSA概率密度产生的随机数落在包含坐标原点的实对称区间内的概率趋近于零.证明.由Tn-1-Tn=eq·nTn-1Tn,得到-x假设优化问题的解区间为[-x,+x],x∈Rn,退火过程中由退温函数Ti产生的随机数为yi(1in),退温系数为q,因此|yi|x,由定理1得P{yix,i=1,2,…,n}=…∫x∫x-xf1/T1(y1)…f1/Tn-1/Tn-1(yn-yn-1)dy1…dyn把式(3)代入式(4),令M=eL,得到i=1,…,nx}=∫xP{yiL=-q式(5)和式(6)由数值分析理论得到,当N趋向于正向无穷大时,式(5)等价于:联立式(6)和式(7)得到定理2.证毕.由定理2可知,当温度下降函数满足条件Tn-1-Tn=eq·nTnTn-1时,退火过程产生的随机数落在包含坐标原点的实对称区间内的概率趋近于零,保证算法在初始阶段能在大空间范围内搜索.同时根据Metropolis接受准则,算法能以一定概率逃逸局部最优位置,确定全局最优位置所在的区域.然后退火温度逐渐下降,相应的搜索范围也逐渐减小,由于此时算法基本不接受恶劣解,搜索转为精细“开采”,确保寻优解的精度.考察温度下降函数的下降速率,对式(3)求导,得到由式(8)得,该温度下降函数在q>1时,随q的增大,温度下降速率越大,具有更快的退火特性.与指数函数的温度下降函数比较,提出的下降函数在退火阶段具有更快的下降速率,同时在精细“开采”阶段具有更平缓的特性来获得较好的搜索精度,因此计算效率得到极大提高.线性函数的下降函数虽然具有较快的下降特性,但是其恒定的下降速率制约了算法在退火后期对最优解的搜索精度,同时使搜索集中于更多无序紊乱的状态,从而降低了算法的寻优效率.退火初始温度的选择根据初始状态中较差状态的接受概率决定,选定一个较大的初始温度和初始接受概率进行递归变换,如果接受概率小于预定的初始接受概率则将当前的初始温度数值加倍,以新的初始温度为基准重复上述递归变换,直至接受概率满足预设要求.采用Johnson的方法,选择接受概率为0.9.则初始温度为T0=-ΔC/(klnλ0),其中ΔC为一个马科夫链中随机选择的状态能量平均增长[12].退火算法的终止条件是退温次数等于预先设置的最大值.本文采用较为简单的原则,即给出一个较小温度的数值,当温度小于这个数时算法停止,表示退火已达到最低温度,晶体内部已达到最小能量的平衡态.退火的退温下降次数为定值,当温度迭代次数达到该定值时停止运算.3.3算法机理分析邻域函数应尽可能保证产生的状态变量遍历整个解空间,在较大范围内进行粗搜索,然后在此基础上在局部小范围内进行细搜索,进而搜寻到全局最优问题解.确定性算法由于在执行过程中仅利用局部信息进行搜索,无法收集全局信息,使得算法易于陷入局部极值点.由定理1和定理2得,算法执行初始阶段,式(2)产生的随机数在[-x,+x]内的概率趋近于零,邻域函数产生的状态变量基本集中于(-,-x]和[+x,+).保证在初始阶段能大范围搜索,确定全局最优位置所在的区域.然后退火温度逐渐下降,相应的搜索范围也逐渐减小,由于此时算法基本不接受恶劣解,搜索集中在最优解附近,因此能搜索到全局最优解.本文提出的退温函数与传统的指数退温函数相比,具有相同的降温特性:高温时下降快,而低温时下降速率慢.不同之处是具有更快的温度Page5下降特性,退温系数越大,温度下降的速率也越大,算法执行的效率越高,因而搜索最优值所需时间越少.但是不能设置过大,以免将退火过程中的全局最优解忽略.BMSA能在退火下降到较低温度之前保持较大的探测范围,从而避免了在低温时探测点集中于局部区域而无法得到全局最优值.为了更直观地表述BMSA的邻域函数工作机理,本文同时采用高温模式和低温模式考察算法.列举2个工作状态,分别记为a,b,其状态的定义域为[-2,1.5].为了便于分析,邻域函数分别采用柯西分布、随机数发生器和布朗运动分布,其对应的图示符号为“·”、“”和“+”.图1为高温模式下的状态分布图,从图中可以看出,柯西分布扰动范围小于随机数发生器和布朗运动分布,状态分散程度较低.随机数发生器与布朗运动分布相比,其状态分散程度更均匀,但是其扰动范围略小.图2为低温模式下的状态分布图,柯西分布和布朗运动分布的扰动范围均变小,但是后者状态分散程度更小,更适合精细搜索.对于随机数发生器来说,无论是高温模式还是低温模式,状态分散程度都呈现均匀特性,使算法搜索过程中的计算效率降低.当优化过程中的扰动状态朝某个特定方向变化符合最优值的搜索方向时,如果随机数发生器总是产生其他方向的扰动状态,那么它的计算效率则会不高.同时,当算法接近全局最优值时,邻域函数产生的扰动状态应集中于最优值附近,否则过大的扰动范围使搜索重复性增大,计算效率降低.4实验验证为了验证BMSA算法的效率及适应性,利用PC机(CPU:PentiumDual-CoreT4200(2.00GHz);RAM:2.00GB)分别对不同复杂函数进行了模型实验.4.1二维函数优化测试的函数均为经典的优化算法测试函数,能反映算法执行的有效性.测试的二维函数分别为F1:DeJongFunction(1)、F2:SchafferFunction(2)、F3:Six-HumpCamelBackFunction、F4:RosenbrockFunction.其中F1、F2、F3和F4的表达式为F1=∑2F2=0.5+sin2(x23x(F3=4-2.1x2i=1F4=100(x2F1为二次抛物线的平方和函数,该函数在非极小值处的下降陡峭,接近全局最优值时变化缓慢,其最小值为x1=x2=0.运用BMSA,设置退火初始温度为0.01,退温运行19次,马科夫链长度为1000.为了比较算法的性能,采用测试函数在算法执行过程中平均调用次数来衡量.图3~图6为本文算法与文献[13-14]算法比较图,其中实线和虚线分别为文献[13-14]的仿真结果,点实线为本文的BMSA算法仿真结果.F2的图形为“四角帽檐”状,它是一种典型的多峰函数,全局最优位置处于帽檐的中央,其全局最优位置相对搜索区域非常小.取初始温度为0.1,退温运行24次,马科夫链长度为1000,结果为图4所示.F3为全局缓慢变化函数,逼近全局最优位置有2处.取初始温度为0.1,退温运行19次,马科夫链长度为1000,其结果为图5所示.F4的图形为“马鞍”形状,全局最优点在鞍点处,由于其具有极强的非线性特性,因此求其最优值难度极大.取初始温度为0.1,退温运行22次,马科夫链的长度为1000,执行算法得到最优解为(0.999996641524556,Page60.999997477916308).VFSR算法调用该待测函数105次,得到的最优值约为10-6.搜索效率远低于BMSA.图3BMSA与VFSR和自适应混合优化对比图4BMSA与VFSR和自适应混合优化对比图5BMSA与VFSR和自适应混合优化对比表1BMSA和OGA/Q、EGEA、HTGA、MAGA、STGA、OEA优化结果比较算法BMSA6840-12568.3OGA/Q302166-12569.45376.447×10-4134000MAGA10862-12569.4866EGEA28786-12569.23671.5×10-1HTGA163468-12569.46STGAOEA300019-12569.48665.555×10-123000201.317×10-21.561×10-2图6BMSA与VFSR和自适应混合优化对比4.2多维函数优化本文的BMSA与文献[15]的OGA/Q、文献[16]的HTGA、文献[17]的MAGA、文献[18]的STGA、文献[19]的OEA和文献[20]的基于模拟退火排序选择算子的族群进化算法(EGEA)的计算结果进行比较.为简便计,选取文献[16]的f1和f4作为本文的待测函数F5和F6.GeneralizedSchwefel函数F5的局部极小值数目在解区间内达到240个,全局最优解的测试函数值为-12569.5.取退火初始温度为10-4,退温运行11次,马科夫链长度为104.Griewank函数(F6)是典型的多峰函数,在[-600,600]内约有3000个局部极小值,全局最优解为xi=0.对Griewank函数进行优化计算,独立运行50次.设置BMSA算法的初始温度为0.1,退温运行29次,马科夫链长度为1000,得到F6的全局最优解为2.35×10-6.为了比较算法的稳定性,程序独立运行50次.表1分别给出了7种算法调用待测函数次数的平均值(MNFE)、优化的待测函数全局最优值(MFE)以及标准差(Std).从表1可以看出,STGA是7种算法中唯一找到F5的全局最优解的算法,而且计算效率最高,其调用待测函数次数仅为1500次.对F6优化过程中OGA/Q、MAGA和HTGA都找到全局最优解,但是计算效率不高.BMSA算法调用待测函数次数远小于其他6种算法,其平均计算效率在7种算法中最高.待测函数Page75结论布朗运动模拟退火算法将模拟退火温度与布朗运动中粒子运动时间联系在一起,通过数学分析和推导得到基于布朗运动的邻域函数模型以及相应的温度下降函数.数值实验表明,布朗运动模拟退火算法可以显著减少调用待测函数的次数,执行过程简单,具有搜索速度快、稳定性高和易于实现的特点,是一种效率较高的智能启发式优化算法.
