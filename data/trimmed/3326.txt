Page1网络设备协同联动模型臧天宁1)云晓春1),2),3)张永铮2)门朝光1)孙建亮2)1)(哈尔滨工程大学计算机科学与技术学院哈尔滨150001)2)(中国科学院计算技术研究所北京100190)3)(国家计算机网络应急技术处理协调中心北京100029)摘要在开放的互联网环境下,大规模分布式网络恶意行为日益增多.发生在不同地理位置、不同时间段的安全事件可能存在潜在的隐藏关系.作者基于通用图灵机思想,提出了一个处理大规模网络安全事件的协同联动模型(CoordinativeRunningModel,CRM).在形式定义的基础上,从人机交互角度分析模型层次结构,由不同部件构建模型系统结构,并实现了面向基础网络的协同联动系统(CoordinativeRunningSystem,CRS),且与基于安全域的安全操作中心(SecurityOperatingSystem,SOC)模型进行了对比分析.在僵尸网络的检测和追踪、DDoS攻击事件关联以及僵尸网络与DDoS攻击源关系分析三个应用实例中,CRS协调骨干网上不同类型安全设备共同工作.典型数据的分析结果表明,CRS为分析不同时间及不同空间安全事件之间关系,挖掘各事件关联后的更深层次安全隐患提供了有力平台.关键词网络安全;协同联动;图灵机;DDoS;僵尸网络1引言随着计算机通信技术的进步,大规模网络恶意行为日趋复杂和多样,越来越多的研究工作关注多网络安全设备的融合和协同以应对大规模分布式网络安全事件.美国加州大学Davis分校在20世纪90年代就研发了DIDS(DistributedIntrusionDetectionSystem)系统[1],把分散部署的若干个网络监视器和主机监视器采集的信息送到中心节点DIDSDirector,集中分析处理.德克萨斯农工大学提出了对等体组织结构的CSM(CooperatingSecurityManagers)[2]系统,由若干个基于主机的入侵检测和响应系统CSM组成,设立攻击可疑度作为响应因素.美国国防部高级研究计划局(DARPA)资助的EMERALD[3]项目构建了一个集成误用检测和异常检测的大型分布式入侵检测与分析系统.日本信息化推进机构(InformationtechnologyPromotionAgency,IPA)开发的入侵检测代理系统(IntrusionDetectionAgentsystem)[4]采用两层架构,应用移动代理技术自动收集信息.法国MIRADOR项目提出了网络恶意行为的协同识别模型(CooperationandRecognitionofMalevolentIntentions,CRIM)[5-6].这些研究工作主要是针对分布式入侵检测系统,通过告警聚合去除冗余告警,降低虚警率,然后进一步关联告警信息,识别入侵行为,分析入侵意图.Renaud[7]描述的安全操作中心(SecurityOper-ationCenter,SOC)结构模型,融合了网络管理和安全管理.首先根据大量网络恶意行为的模式关联,建立入侵行为模板,存储于知识库.然后按照时序模式匹配等方式处理各种网络安全监测设备探测到的异常信息,监测网络安全事件.并根据系统漏洞和脆弱性分析,建立系统安全策略模板.Fortinet公司提出了一种七层安全技术,统一威胁管理(UnitedThreatManagement,UTM).将多种安全特性集成于一个硬设备里,构成统一管理平台.具备网络防火墙、网络入侵防御和网关防病毒等功能.是一种部署在网关的安全设备.以上研究和工作的前提是在互联网上划分出一个域,在这个域中按照事先设置的固定模式,集中管理或防御.然而,互联网本身是一个开放、互通的网络空间,目前,以建立僵尸网络、发动分布式拒绝服务(DistributedDenialofService,DDoS)攻击等为代表的群体性网络恶意行为大规模调用分布在整个互联网的资源[8],他们位置分散,形式多样,仅对某个安全域的防护,无法深入分析这些群体性恶意行为.另外,发生在不同地理位置、不同时间段的安全事件是否由同一组织所为,不同类别的安全事件是否存在着关联性,诸多安全事件信息结合在一起能否挖掘出更深层次的安全隐患.针对上述问题,本文提出了一个基于通用图灵机的网络安全设备协同联动模型,并通过该模型实现了一个面向国家基础网络的网络安全协同联动系统.为追踪、分析互联网的大规模安全事件提供了有力平台.本文第2节介绍协同联动模型;第3节描述协同联动系统的实现;第4节阐述协同联动系统的应用实例和数据分析;第5节是应用实例;第6节总结全文.2基于通用图灵机的协同联动模型2.1通用图灵机和存储程序计算机为了解决有限步数可计算问题,英国数学家阿兰·图灵于1937年提出了抽象计算模型———图灵机(TuringMachine)[9].图灵进一步描述了一种可存储指令的通用图灵机[10],这种机器能够读取并执行不同的程序.在某种意义上,通用图灵机相当于一个解释程序,给定任意应用程序及输入数据,利用这个解释程序可以得到输出.采用通用图灵机模型可以对任意特定的图灵机进行仿真[11].图灵认为这样的一台机器能模拟人类进行任何计算过程,是可等价于任何有限逻辑数学过程的终极强大计算机器.因此,通用图灵机是一个通用计算机的数学模型,其抽象意义为一种数学逻辑机,是一个普适性定义的理Page3想模型.约翰·冯·诺伊曼将这一思想作了具体实现,提出了存储程序计算机(storedprogramcomputer)的体系架构,把需要解决的问题用软件编制程序,然后将程序和数据都存放在存储器里,由中央处理器(CPU)根据指令对数据进行操作.这一思想被现代计算机的体系结构所继承.2.2协同联动模型形式定义网络安全的协同联动工作是根据事先设定的工作任务,协调多种类型网络设备共同合作,利用这些设备提供的信息,挖掘、分析各种异常网络行为.如果把需要协同的设备看作外部设备,则对这些设备提供的信息进行协同处理过程可认为是进行有限步数的计算,因此,本文根据图灵的计算模型和存储程序计算机的体系结构提出了一个处置网络安全事件的协同联动模型(CoordinativeRunningModel,CRM).定义1.协同联动模型的形式定义.一个协同联动模型是一个十元组:C=(Q,q0,qaccept,qreject,Σ,δ,Γ1,Γ2,Γ3,Γ4),其中:Q是状态集;q0∈Q是起始状态;qaccept∈Q是接受状态;qreject∈Q是拒绝状态,且qreject≠qaccept;Σ为输入字母表,不包括特殊空白符B;Γ1是事件带字母表,B∈Γ1且ΣΓ1;Γ2是知识带字母表,B∈Γ2且ΣΓ2;Γ3是结果带字母表,B∈Γ3且ΣΓ3;Γ4是流程带字母表,B∈Γ4且ΣΓ4.δ:Q×Γ4→δQ×Γ4×{L,R}4是状态转移函数.把Q×Γ4中的某一个元素映射为Q×Γ4×{L,R}4中的一个元素.即定义域和值域分别为Q×Γ4和Q×Γ4×{L,R}4.工作带Γ1和Γ2上分别记录需要处理的事件字母表和知识字母表;Γ3记录处理结果字母表;而Γ4上记录着由不同的协同任务定制的工作流程字母表.灵机.定理1.协同联动模型CRM等价于通用图证明.(1)CRM等价于图灵机.定义1中,根据存储功能的不同,定义了多条工作带,显然,CRM是多带图灵机,而多带图灵机与图灵机等价,因此,CRM等价于图灵机.(2)CRM等价于通用图灵机.设R1,R2,R3,R4分别表示C每次计算时的事件字母表、知识字母表、结果字母表和流程字母表.图灵机M被定义为一个七元组,M的格局由当前状态、当前带内容和读写头的位置构成.计算过程中,根据转移函数δ描述的规则,M从一个格局转换到另一个格局,因此,图灵机的本质是一个算法或函数,给定一个输入数据x,可计算出f(x).也就是说,M相当于一个专用机,进行一种特定的计算.而每一个协同任务就是要CRM根据编制的流程完成一次特定的计算.通过流程字母表R4编制的流程确定一个算法Mi.给定R1,R2,根据算法Mi制定转移函数δ的规则,C从一个格局转到另一个格局,因此,算法Mi实际就是一个图灵机.也就是说,每个协同任务对应一个流程,而每个流程对应着一个图灵机.因此,图灵机Mi对输入(R1,R2)的计算等同于CRM对数组(R1,R2,R4)的计算.即CRM输入任何图灵机Mi的编码,CRM都可以仿真Mi的计算,CRM相当于Mi的解释器,所以,CRM等价于一个通用图灵机(可以完成任意的协同任务).根据定理1,我们构建的协同联动模型CRM是一个通用计算模型.为了能够物理实现CRM,下面分别从使用者(包括一般的用户和系统开发人员)和系统结构的角度进一步阐述.2.3模型层次结构如图1划分为操作层、系统层和物理设备层.从使用者角度,协同联动模型表现为层次结构,(1)操作层,直接面向一般的操作人员,由以下相关概念来定义.定义2.操作语言.是面向一般操作人员定义的一组语法规则.借助这组语法规则,使用者直接操Page4定义4.操作流程.指操作人员根据要完成的协同联动任务,按照操作语言的语法规则,组合起来的一系列操作指令.每一条指令指示了协同联动系统的每一步行为.员,由以下几个概念定义.(2)系统层主要面向协同联动系统的开发人定义5.系统语言.指协同联动系统的各组成设备可直接识别和解读的一组语法规则.操作指令系统中的每条指令在系统语言的语法规则下都有若干条系统指令与之对应.下,最基本指令的集合.定义6.系统指令集.在系统语言的语法框架定义7.系统流程.在系统语言的语法框架下,按照协同联动模型要完成任务的逻辑顺序组合起来,系统可直接执行的系统指令集合.(3)物理设备层,是构建协同联动系统,执行协作协同联动系统,并准确完成相应的操作任务.为便于操作人员使用,操作语言尽量采用简单指令或图形界面化的形式实现.定义3.操作指令集.在操作语言的语法框架下,定义的一组指示协同联动系统完成各种基本操作动作的指令.多条操作指令按工作流程组合起来,以完成一定协同联动任务.每条指令也可单独使用,执行指定的操作行为.指令由操作码和变量码组成.操作码,指示协同联动系统进行基本的操作动作;变量码,表示操作指令的执行对象以及操作对象的存储位置.同联动任务的各种物理设备的总称.在上述模型中,操作语言是源语言,系统语言是目标语言.操作人员通过操作语言下达的指令和编写的操作流程要翻译为系统语言语法框架下的系统指令和系统流程,以驱动物理设备层的各组成设备.也可以直接用系统语言编写系统流程完成协同分析任务.2.4模型系统结构根据协同联动模型的形式定义,构建模型系统结构.如图2所示,其结构由以下各系统部件组成.(1)接口系统(InterfaceSystem,IS).是协同联动系统与外界信息交互的中转站.需要协同的数据一般来自各种网络安全设备,也可能是合作组织或个人提供的网络事件信息,数据传输方式各不相同,而且数据格式和存储形式各异.接口系统兼容多种通信方式,并统一不同来源的异构数据格式.识.比如域名监测设备提供的DNS解析信息.流程单元.存储操作人员根据要完成的协同分析任务,通过操作语言或系统语言编写的工作流程.每个流程设定编码.结果单元.存储协同联动任务的执行结果.可(2)存储部件(StorageComponent).根据协同模型形式定义中的不同工作带,存储部件按功能包括事件单元、知识单元、流程单元、结果单元等几部分.每个存储单元的功能如下:事件单元.用于存储外界提供的网络安全事件信息.外界数据通过接口系统将信息标准化后,送到事件单元中.协同联动引擎可直接访问事件单元,按照工作流程操作事件单元中数据,并将结果存入结果单元中.知识单元.存储协同联动过程中所需的专家知随时通过输出设备展示结果单元中的数据.(3)协同联动引擎(CoordinativeRunningEngine,CRE)是协同联动模型的核心部件.将操作人员下达的指令解释为协同联动系统可识别的系统语言,并按照流程或指令调度、协同各存储部件中的信息.工作过程分为接受指令(receive)、解码翻译(decode)、执行流程(execute)、结果存入(write-back)4个阶段.接受指令.CRE可直接接受操作人员通过输入设备传入的操作指令,或调用流程单元中的操作流程.解码翻译.CRE接受操作指令后,首先按照操作语言的语法规则对每条指令解码,解析出操作码Page5和变量码;然后根据系统语言的语法框架把解码后的指令翻译成系统可识别的若干条系统指令;最后组合系统指令,编写系统流程进入执行流程阶段或设定系统流程编码存入流程单元.执行流程.解码翻译后的系统流程可直接执行,或者在操作人员的指令下按编号运行流程单元中的系统流程.结果存入.将各协同联动任务的执行结果写入结果单元中,按照工作流程编码,保存执行结果,以供在输出设备上展示.(4)输入设备(InputDevice).它是操作人员与协同联动系统通信的桥梁,操作人员通过输入设备向系统输入指令和数据.(5)输出设备(OutputDevice).输出或展示操作人员的指令或流程的执行结果.3协同联动系统基于协同联动模型,我们实现了一个开放、通用和易扩展的协同联动系统(CoordinativeRunningSystem,CRS),应用于基础网络的监测环境中.3.1存储部件各种数据库或文件系统等都可以实现存储部件.针对骨干网的海量信息,我们采用了具有强大数据处理能力的大型关系数据库系统作为主要存储部件,各存储单元根据不同的存储功能分别由不同的数据库实现.为便于寻址和易于扩展,将数据表看作可操作的最小存储单位,定义为存储资源,并通过存储向量描述:〈MNum,Unit,DBType,Host,User,PWD,TNS,DBName,Table〉.各分量含义分别为存储资源编号、存储部件类型、对应数据库的类型(如ORACLE、DB2等)、数据库主机IP地址、用户名、用户密码、ORACLE连接选项、数据库名、数据表名.其中TNS是ORACLE连接时使用的选项,对其它类型数据库填写NULL即可.为了能快速寻址,高效维护存储资源,采用链表结构组织存储向量,构成存储地址表,通过MNum快速连接数据库,定位到相应数据表.3.2接口系统口系统采用模块化设计结构,如图3所示.为了兼容多种通信协议和异构的数据格式,接CRS从外部设备接收数据时,协议代理根据不同通信协议和连接方式(主动获取或被动接收)调用相应协议代理模块建立数据传输信道.接收的数据临时存入数据区.格式解析部分读取数据区中的数据,根据不同数据格式,应用不同格式解析模块,数据转换为CRS定义的标准数据格式.系统向外部输出数据时与上述过程相反.为了对外部设备统一管理,接口系统定义了外设资源向量:〈DNum,Protocol,Host,User,PWD,Format〉.各分量分别表示外设资源编号、外部设备的通信协议、外部设备IP地址、通信协议使用的用户名和密码以及外部设备使用的数据格式.与某外设交互数据时,通过外设的唯一标识DNum即可快速与其建立连接,通过向量中的Protocol和Format可便捷地匹配某外部设备需要的通信协议代理模块和数据格式解析模块.所有的外设资源向量构成外设资源表.3.3协同联动引擎协同联动引擎是系统的核心部件,解析操作指令,并翻译为系统可识别的系统语言.为了便于一般使用人员的操作,我们设计了一个简单易用的脚本语言CADL(CollaborativeAnalysisDescriptionLanguage)作为系统的操作语言.操作指令由基本指令和扩展指令两部分构成.基本指令是协同联动最常用指令,分协同分析指令、数据交互指令和调度指令三类.协同分析指令通过对存储部件的操作完成主要的协同分析工作;数据交互指令负责协调系统与外设通过接口系统的数据交互;调度指令协调工作流程的执行情况.当有特定的或特别复杂的协同分析任务时,需要为其定制专门指令,也就是扩展指令.表1中列出了典型的基本操作指令.以操作指令为例,CADL的文法用巴克斯范式(BNF)描述如下:〈操作指令〉∷=〈操作码〉:〈变量码〉;Page6〈操作码〉∷=〈关键字〉;〈变量码〉∷=字符串|〈值〉;〈关键字〉∷=Table_Create|Table_Remove|Index_Creat|Index_Remove|Read_Write|Redun_Rem|……;由于存储部件的功能由数据库系统担任,并考〈值〉∷=字符串或数字.表1典型操作指令MNum1:需要去重的数据表对应的存储资源编号.协同分析指令数据交互指令调度指令4相关工作比较与分析多种类安全设备协同工作的典型系统有UTM和SOC[7]等.UTM将防火墙、入侵检测、网关防病毒等集成在一起,是一种集成型网关设备.与本文的协同联动模型在形式和实质上都完全不同.SOC协同管理多种安全设备,但目前业界对SOC还没有形成统一的理解,SOC的实现方式也各不相同.其一般模型的定位是采用划分安全域的思想,以资产为核心的一套资产风险模型.SOC与本文提出的协同联动系统有相似的逻辑架构,但二者有本质区别.虑到系统的执行效率,采用SQL和C语言作为系统语言.一条操作指令的功能由一段SQL和C语言程序实现,并封装成函数.在解码翻译阶段,解析操作指令,调用该指令对应的系统语言中的函数.一段CADL编写的操作流程,经解码后,翻译为若干段SQL和C语言程序构成的系统流程.SOC是协助管理员进行事件分析、风险分析、预警管理和应急响应处理的集中安全管理系统.其根本模型是PDR模型.在一个安全域内针对不同时间、不同位置的离散单一安全事件进行收集、汇总、过滤和关联分析以形成统一的安全决策,对事件进行响应和处理,实现全域的资产风险管理.本文提出的协同联动模型是一个开放式的、以图灵机模型为基础的抽象计算模型,在互联网空间追踪和分析大规模网络安全事件.主要是协同不同种类的互联网设备,以这些设备提供的海量信息为数据源,分析危害网络空间的大规模网络安全事件.表2列出了二者的比较.Page7面向对象开放的互联网空间基础模型图灵机计算模型数据来源分布在互联网的各种安全主要目的事件的分析、挖掘通用性可根据不同的分析任务,编操作方式编制工作流程,需要学习SOC按照一个大的规则库来管理安全域,是一套专家系统,存储了大量规则,但数量有限,有些规则没有被存储,这些规则涉及到的安全事件,SOC无能为力.而基于图灵机的协同联动模型根据不同的协同任务定制不同的工作流程,应用计算概念,是一种用有限来应对无限的方法.此外,协同联动系统完成一次协同联动任务实质是通用图灵机进行了一次计算,需要考虑图灵机进入停机状态的时间,即需要多长时间完成协同任务才能有实际应用价值.因此,协同联动系统在执行不同的协同任务时,要根据相应环境和不同的应用做效率上的优化.这就需要我们在设计操作语言和系统语言时考虑执行效率的优化功能.5应用实例这个协同任务要求协同3种不同类型的设备,为了验证本文基于通用图灵机建立的协同联动模型CRM和协同联动系统CRS的自动协同联动能力,本节分析了CRS在国家基础网络的安全应用中3个典型实例,并给出每个实例基于通用图灵机的形式化描述.5.1僵尸网络的检测和追踪是一个多元协同联动任务.5.1.1任务概述僵尸网络[12]是目前互联网安全的一个严重威胁.采用IRC和HTTP协议通信的集中式僵尸网络[13]一般通过DNS实现控制服务器与受控主机间的联系,并经常通过更换控制服务器域名和IP的迁移机制[14]来躲避检测.因此,同一个僵尸网络的服务器域名和IP在不同时刻可能会不相同.另外,僵尸网络成员也在动态变化[15],一些受控主机可能摆脱僵尸网络的控制,或者有新的受控成员加入.为了更好地检测和追踪集中式僵尸网络的控制服务器和受控端主机,协同了以下几个设备共同分析僵尸网络行为.(1)网络报文监测系统.国家网络安全监测平台(863-917平台)[16],实时检测互联网中特定的安全事件,提供恶意代码的受控主机IP、服务器IP和通信时间等信息.(2)DNS监测系统.记录国内各服务器的域名解析信息.(3)流监测系统.提供指定IP与互联网其它主机通信的数据流信息.协同过程如图4所示:(1)报文监测系统根据僵尸程序特征码捕获活跃的僵尸程序样本,并发现控制端IP地址;(2)DNS监测系统通过监测到的IP、域名对应关系,根据IP提供该僵尸网络控制端域名;(3)DNS监测系统进一步匹配一段时间内与控制端域名对应的所有IP,给出控制端IP列表;(4)将控制端IP列表与该时间段内流监测系统日志关联,获得与僵尸网络控制端通信的受控僵尸主机IP地址列表.定时重复执行上述过程,可以获得更多的控制服务器IP和受控主机IP,追踪、分析集中式僵尸网络在不同时间的变化状况.5.1.2流程设计根据这个协同任务,规划操作流程如表3所示.通过c,d消除原始数据中冗余信息;通过e,f建立存储索引,提高对存储资源的搜索效率.操作人员按照表3中各步骤,通过CADL语法编写操作流程,存入流程单元,协同联动引擎将其翻译为系统流程并执行.操作人员也可单步执行操作流程中的语句,逐步完成协同分析任务.Page8表3僵尸网络协同分析操作流程步骤操作码aInputDNum1,MNum1将报文监测系统提供的僵尸网络控制端IP信息写入事件单元的存储资源MNum1中.bInputDNum2,MNum2将DNS监控系统提供的域名、IP对应信息写入知识单元的存储资源MNum2中.cRedun_RemMNum1,Field1,dRedun_RemMNum2,Field1,eIndex_CreatMNum3,Name_Index1,fIndex_CreatMNum4,Name_Index2,gRead_WritehRead_WriteiRead_WriteMNum6,MNum7,jOutputMNum7,DNum3kInputDNum3,MNum8把设备DNum3(数据流监测设备)传过来的数据(控制端IP列表和受控端IP列表)写lIndex_CreatMNum8,Name_Index3,最后,通过Schedule指令每隔6h重复执行这个过程,进一步追踪由于僵尸网络迁移和动态变化产生的新僵尸网络控制端和僵尸网络成员.5.1.3形式化描述入到结果单元的MNum8中.首先将这个任务的协同过程符号化.a,c,e和b,d,f分别是报文监测设备和DNS监控系统提供数据的写入、去重和寻址优化3个步骤,顺序不能改变.g,h,i,j,k,l几个步骤也须固定不变.因此这个协同过程可以译码为符号串N=(Kghijkl),其中K表示分别固定a,c,e和b,d,f两组字符的顺序后的6个字符的任意组合构成的字符串集合.因此N表示了这些字符组合后的所有字符串.符号串中的符号取自有穷的字母表Σ,这些字符串就构成了语言L.所以,问题转化为构造一个识别语言L的图灵机M1.最后给出这个实例中图灵机M的形式描述.M=(Q,Σ,Γ,q0,qaccept,qreject,δ),其中:Q={q1,q2,…,q11,qaccept,qreject};Σ={a,b,c,d,e,f,g,h,i,j,k,l};Γ={a,b,c,d,e,f,g,h,i,j,k,l,B};δ:Q×Γ→δQ×Γ×{L,R};q0是起始状态;qaccept是接受状态;qreject是拒绝状态.开始状态为q0,把要判断的符号串写在工作带上,每格写入一个符号,其余空格是空白符号B.对于输入符号串N=(Kghijkl),从左向右扫描,每扫描一个符号说明经过了一次协同引擎的处理,解析出了新的信息,生成一个新的状态qi.状态图如图5所示.从q0到q1的转移记为a→c,R,即转移函数δ(q0,a)=(q1,c,R),表示当状态处于q0且读写头读符号a时,机器的状态变为q1,写下符号c,并向右移动读写头.其它状态转移与此类似.为了图示清晰,图中没有标出每个状态到拒绝状态的转移标记,而且单独列出了需要交叉连线的状态转移标记.5.1.4执行结果分析(1)CRS,一个时间段执行结果.表4列出了某一时间段内,各设备提供的数据量及协同联动后的结果.CRS通过去重指令有效消除了冗余信息,DNS监测系统的数据尤为明显,消除了近30%.共分析出10万多条恶意主机IP,受控端主机有近6千万条记录,有效地分析出僵尸网络的服务器和受控主机的相关信息.为进一步验证恶意主机信息我们进行了(2)、(3)两步观察分析.Page9数据来源863-917平台DNS监测系统1829830411198870恶意主机域名恶意主机IP流监控返回信息58346396(2)某僵尸网络一个时间段协同结果.在一个时间段内,一个典型僵尸网络经过协同联动的变化情况如表5所示.CRS根据控制端IP...46发现了该僵尸网络的一个域名①和另一个控制服务器IP,这两个IP都与12万个以上的受控客户端有数据通信行为.控制端IP域名控制端IP列表受控端IP数量(条)...46jj...su...71127798(3)某僵尸网络多时间段协同结果.从表6中看出,在72h后,CRS协同出新的控制端IP,受控端主机的数量也随之明显增加;120h后,服务器的域名产生变化,僵尸网络发生了迁移行为,并且受控主机的数量在增加;在240h后,再次发现新迁移行为,僵尸网络规模继续扩大.这是个活跃的僵尸网络,在其发展过程中,应用了多个服务器IP,把受控主机分成多个群体,并发生了2次迁移.一个正常服务器不会频繁发生更换域名的迁移行为,因此,多个时间段的观察结果进一步确认了僵尸网络检测信息.时间控制端IP控制端域名受控端IP数量(条)初始...78oi...net24h后...78oi...net72h后120h后240h后(4)效率比较.CRS每次执行这个操作流程大约需要51min,我们同时比较了没有去重指令和建索引指令的操作流程运行时间,用时194min.因此,如第4节所述,只有通过效率优化,考虑进入停机状态的时间,基于图灵机构建的模型才有实际应用价值.通过以上4个方面的分析,可以看出,CRS能有效完成追踪大规模僵尸网络的协同联动任务.消除海量数据的冗余信息,挖掘僵尸网络在不同时间段的变化情况,同时,也为确认僵尸网络的检测结果提供了有效分析手段.并且,通过高效的实施协同联动任务,提高了安全事件的处置效率.5.2大规模DDoS攻击事件关联个网络安全监测设备做协同分析.5.2.1任务概述分布式拒绝服务攻击具有地理分布性和一定时间延续性,可利用分布式实时监测设备检测DDoS攻击行为.但对大规模DDoS行为,设备上报的信息量巨大,需要关联这些信息,掌握DDoS攻击的真实情况.利用CRS,协同分析了一套分布式网络恶意事件这是一个一元协同任务,要求对同一类型的几①通过Google搜索确认,该域名为一个控制服务器位于俄罗Page10监测系统上报的DDoS攻击.这套系统部署在国内几个基础网络节点和国际出入口,实时上报蠕虫、僵尸网络、木马和DDoS等各类恶意行为.协同步骤如下:(1)提取一个时间段(比如24h)的各类安全事件原始数据;(2)选出该时间段内的DDoS攻击事件信息;(3)时间关联.合并同一攻击的连续报警信息,表7DDoS去重分析操作流程步骤操作码a写入bRead_WriteMNum9,MNum10,cRead_WriteMNum10,MNum11,dRedun_Rem_timeMNum11,MNum12,eRedun_Rem_spaceMNum12,MNum13,fRead_WriteMNum13,MNum14MNum11.5.2.3形式化定义先符号化这个协同过程:N=(abcdef),符号串中的各字符顺序固定.符号取自有穷的字母表Σ,这个字符串构成了语言L.因此,构造一个识别语言L的图灵机M2.开始状态为q0,状态图如图6所示(省略所有到拒绝状态的转移标记).最后给出这个实例图灵机M的形式描述.M=(Q,Σ,Γ,q0,qaccept,qreject,δ),其中:Q={q1,q2,q3,q4,qaccept,qreject};Σ={a,b,c,d,e,f};Γ={a,b,c,d,e,f,B};δ:Q×Γ→δQ×Γ×{L,R};q0是起始状态;qaccept是接受状态;qreject是拒绝状态.5.2.4执行结果分析为了说明CRS执行这个协同任务的意义,我们分析了2010-03-03到2010-03-108天的运行结果.并统计攻击的数据量;(4)空间关联.合并不同地点的监测设备在一个时间间隔内检测到同一DDoS攻击信息,并统计攻击的总数据量,计算攻击强度和攻击规模.5.2.2流程设计述.工作流程如表7所示.与5.1.2节过程相似,限于篇幅,本文不再详图7展示了关联前后的DDoS攻击事件数量的变化情况.由于把同一事件的信息进行了合并,关联后明显减少了重复上报的DDoS事件冗余信息.图8展示了关联前后,每天发生的DDoS攻击事件Page11中最大规模的主机数量.经过关联,归并了参与同一次DDoS攻击事件的主机,主机数量显著增加,因此,更明确了一次DDoS攻击的规模和强度.从以上结果可以看出,CRS执行的这个协同任务能有效地从不同空间和时间的海量安全事件信息中关联出同一DDoS攻击事件,并分析出攻击规模和攻击强度,有效加强了大规模DDoS攻击的检测能力,为掌握DDoS攻击的真实情况提供了有力的支持.5.3僵尸网络与DDoS攻击源关系分析这个任务是把5.1节追踪到的僵尸网络与5.2节关联出的DDoS攻击源主机群做进一步关联分析,是一个二元协同任务.5.3.1任务概述DDoS的攻击源是互联网空间内的大批受控傀儡主机,它们可能隶属于某一僵尸网络.因此,有必表8DDoS僵尸网络协同分析操作流程步骤操作码aRead_WriteMNum14,MNum15读结果单元中DDoS事件表MNum14,写入知识单元MNum15.bRead_WriteMNum8,MNum16读僵尸网络受控主机表MNum8,写入知识单元MNum16.cCount_IPdCountMNum5,MNum6,eRead_WriteMNum7,MNum8读取MNum19,写入结果单元MNum20.C类IP段的IP,写入MNum18.量,结果写入MNum19.5.3.3形式化定义将这个任务的协同过程符号化.a,b两个步骤没有先后顺序.其余步骤固定不变.因此这个协同过程可以译码为符号串N=(Kcde),其中K表示a,b或b,a.因此N表示这些字符组合后的所有字符串.符号串中的符号取自有穷的字母表Σ,这些字符串构成语言L.因此,问题转化为构造一个识别语言L的图灵机M3.状态图如图9所示.图中省略了所有到拒绝状态的转移标记.这个实例的图灵机M3的形式描述为M=(Q,Σ,Γ,q0,qaccept,qreject,δ),其中:Q={q1,q2,q3,q4,qaccept,qreject};Σ={a,b,c,d,e};要分析DDoS攻击源的主机群与一个已知僵尸网络之间的关系.最直接的分析方法是计算两批主机的IP重合度.但由于很多互联网用户使用动态IP,直接计算有很大误差,而ISP分配的动态IP具有一定的局部性,因此,我们用C类IP段代替单独的IP地址来计算IP重合度.令,重复运行上述工作流程进行关联.5.3.2流程设计述.工作流程如表8所示.与5.1.2节过程相似,限于篇幅,本文不再详5.1节受控僵尸主机列表;这个协同任务按如下步骤进行:(1)分别读取5.2节DDoS攻击源主机列表和(2)分别统计两个列表中C类IP段的数量;(3)统计两个列表中相同IP段的数量.对任意两个要比较的主机列表,可通过调度指Γ={a,b,c,d,e,B};δ:Q×Γ→δQ×Γ×{L,R};q0是起始状态;qaccept是接受状态;qreject是拒绝状态.5.3.4执行结果分析为了说明执行这个协同任务的意义,我们分析了以下3种典型的情况.(1)僵尸网络和DDoS攻击源部分重合.表9列出了两个实例.重合度越高,说明DDoS攻击源来自这个僵尸网络的可能性越大.而DDoS攻击源中没有与僵尸网络重合的主机,可能是属于这个僵尸网络而没有被检测到的受控主机.因此,这个协同任务加强了我们追踪僵尸网络的能力,有助于我们更深入了解僵尸网络规模.僵尸主机数量1122355219665629.870.05293756281880928.70.09Page12(2)几次DDoS攻击事件的攻击源都与同一个僵尸网络有重合.表10统计了一个134465台受控主机的僵尸网络与3批DDoS攻击源主机的重合情况.每个DDoS攻击源都有部分主机与僵尸网络受控主机群重合,因此,这3批DDoS攻击源可能都来自这个僵尸网络,扩大了该僵尸网络规模.表10一个僵尸网络与3个DDoS攻击源重合DDoS攻击源主机数量相同主机数量占DDoS攻击源比率/%111562109631655(3)在同一次DDoS攻击中发现攻击源来自不同的僵尸网络.表11是一个有2696台主机的DDoS攻击源与3个僵尸网络的重合情况.由于每批僵尸主机群都与同一DDoS攻击源有部分重合,说明它们可能是同一僵尸网络的不同部分,有助于我们分析僵尸主机群之间的关系.表11一个DDoS攻击源与3个僵尸网络重合僵尸主机数量相同主机数量占僵尸主机比率/%1105636296452324556从以上3个观察结果可以看出,CRS运行的这个协同任务,为我们掌握僵尸网络的规模,追踪和分析僵尸网络之间的关系都提供了有效手段.因此,CRS可为分析不同时间、不同空间安全事件间的关系,挖掘各事件关联后的更深层次安全隐患,提供有力的工作平台.6结论本文在讨论分析大规模网络安全事件的目的和意义的基础上,提出了一个基于通用图灵机的协同联动模型,并实现了协同联动系统,给出了相关的定义,系统在国家基础网的监测环境中进行了应用.与以前工作相比,这个模型在开放的网络空间中提供了网络安全协同联动的有力平台:(1)能够有效地追踪大规模网络安全事件在不同时间段的变化情况.通过高效地实施协同联动工作,提高了安全事件的处理效率.(2)从不同空间和不同时间的安全事件信息中关联出同一事件,并分析出事件的规模和强度,掌握事件的真实情况.(3)可以自动挖掘出不同安全事件间的关系,有助于更深入分析安全事件的本质.致谢真诚感谢审稿人为本文提出的宝贵意见!真诚感谢CNERT/CC相关工作人员对我们工作的支持!
