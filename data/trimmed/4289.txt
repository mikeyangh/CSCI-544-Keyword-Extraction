Page1基于多元统计模型的分形小波自适应图像去噪王智文1),2),3)李绍滋1),3)1)(厦门大学智能科学与技术系福建厦门361005)2)(广西科技大学计算机学院广西柳州545006)3)(福建省仿脑智能系统重点实验室(厦门大学)福建厦门361005)摘要为了克服分形小波去噪方法缺乏保护图像的边缘与细节的缺陷,文中提出了一种基于多元统计模型的分形小波自适应图像去噪算法.通过建立一个参数可以灵活改善的多元统计模型来准确地估计各种相关信息,并通过最小化残差来自适应调整模型参数;在适度的噪声方差下根据拼贴距离找出最好的子树域中的近优父子树,通过使用四叉树分割来实现对噪声图像自适应地预测分形小波无噪图像编码,从而达到去除噪声和保护图像的边缘与细节的目的.实验结果表明,该方法在去除噪声的同时,能有效地保持图像的边缘特征和保留图像的精细结构.由于采用了预测小波分形编码,优化了算法结构,算法的处理速度比较快.因此,完全可以达到实时图像处理过程中的去噪预处理对处理速度的要求.关键词图像去噪;多元统计模型;分形小波变换;拼贴编码;RMSE和PSNR1引言由于图像信号在获取、传输和存储过程中,不可避免地受到噪声的干扰,噪声降低了图像质量,淹没了图像的边缘和细节特征,给图像分析和后续处理带来困难.图像噪声的消除是图像处理中的一个重要研究内容,能否有效地滤除噪声直接影响着图像处理后续工作的进行.在进一步进行边缘检测、图像分割、特征提取和模式识别等处理之前,采用适当的方法去除噪声是一个非常重要的预处理步骤[1].如何在有效去除噪声的同时保持图像细节的清晰度和图像的对比度成了人们研究的热点.传统的图像去噪算法是根据图像频谱分布规律,从频率上将图像中的有用信息与噪声分开,例如小波方法去噪[2-5].这些方法一般认为噪声的能量集中于图像的高频部分,而图像的有用信息的频谱则分布于图像低频部分的一个有限区域内.然而,在许多情况下,图像的有用信息也有分布于图像的高频部分的,例如图像边缘,所以采用这些方法在去除噪声的同时也损失了部分有用信息,即缺乏特征保持性.一些改进方法采用了如Contourlet等其他变换代替小波变换[6],取得了更好的效果,但其基本假设不变.而噪声在图像的低频部分也有一定的分量,简单地滤除图像的高频成分无法去除这部分噪声分量,即没有有效地将图像有用信息与噪声数据区分开来.如中值滤波去噪是对图像中所有像素进行滤波,改变了图像中未被脉冲噪声污染的像素点,所以在有效滤除脉冲噪声的同时,由于对图像的边缘细节和纹理部分过度平滑,造成去噪后的图像清晰度较低.中值滤波算法在去除噪声时仅考虑了邻域内像素的排序信息,忽略了像素的时序信息,因此会在边缘处产生抖动并会删除一些重要的图像细节[7-9].空域去噪中的高斯滤波能有效地去除图像平滑区域的噪声,但由于高斯滤波器[10]是各向同性的,对边缘和细节不加区分,因此该方法容易造成图像边缘和细节模糊.采用软阈值去噪时很难确定一种对所有图像都适用的阈值选取方法,且容易产生图像的伪吉普斯现象[11-13].近年来很多研究工作集中于保留图像细节上,但大多数方法仍然假设图像分段平滑,这样虽然能保留边缘信息,但对纹理细节的保留贡献不大.如TV及其改进算法通过最小化图像全变分得到分段平滑图像[14-17].现有的算法通常将图像各部分分为平滑与边缘两种模式,通过滤除平滑模式图像中的高频分量进行去噪,即将其处理为理想的平滑模式.当图像含有纹理时,纹理也会被当作以上两种模式处理,所以会损失部分细节信息.为了保留图像的纹理信息,一些学者提出了针对纹理自相似性的图像去噪方法.如分形小波去噪算法[18-19]利用图像分形小波变换中块自相似性来调整尺度因子.通过分形小波预测编码来达到图像去噪的目的.虽然该方法能取得比较良好的去噪效果,但是该方法在图像去噪过程中边缘细节的保持方面还有待加强.非局部均值方法通过假设相邻区域具有自相似性,搜索领域内的相似图像区域并进行加权平均实现图像去噪[20].基于混合线性模型的去噪方法不假设图像分段平滑,仅假设图像具有自相似性,利用图像的相似性区分图像信号与噪声[21].通用离散图像去噪算法假设图像具有平稳分布,用非参数估计方法统计图像块的分布,再用最小代价准则来实现图像去噪[22].静态小波变换(SWT)利用时间不变性来实现图像去噪[23].基于PDE的非线性扩散滤波方法(P-M)[24]是一种非线性的各向异性去噪方法,各向异性的去噪模型根据图像的梯度值确定扩散的速度,能够兼顾噪声消除和边缘保持两方面的要求.尽管P-M方法在抑制噪声与保留图像重要特征方面取得了一定效果,但却表现出病态且不稳定.针对分形小波去噪方法缺乏保护图像的边缘与细节的缺陷,本文提出一种基于多元统计模型的分形小波自适应图像去噪算法.根据分形小波变换具有低熵性、多分辨率、去相关性和选基的灵活性等特点,通过选用扩展的GGD模型MGGD(MultivariateGeneralizedGaussianDistribution)模型建立多元统计模型的基础上利用分形小波变换来完成图像去噪.通过最小化残差R1得到最接近p1(狓)的p2(狓)及自适应调整参数α和β;通过使用四叉树分割来实现对噪声图像自适应地预测分形小波无噪图像编码以达到去噪目的.与其他算法相比较,具有更好的去噪效果和更强的边缘保持能力,特别适用于消除高斯和脉冲混合噪声.2相关工作本文提出的去噪方法是在分形小波去噪算法的基础上进行的.分形小波变换(FractalWaveletTransforms,FWT)是在分形图像压缩过程中,为了减少块效应和计算的复杂性而引入的[25-29].分形小波变换操作涉及将小波系数子树缩放和复制到较低的子树,完全类似于分形图像编码器在空间域的操作.分形小波去噪的本质是从噪声图像中预测出无Page3噪声图像的分形编码.2.1分形小波变换图像编码简介二维信号(图像)的离散小波变换(DWT)系数是一个标准的矩阵式排列图.假设二维小波基函数是通过一维尺度函数和小波函数的合适的张量积来构造的,则可以得到图1所示的二维分形小波变换图[18].每个块Xh系数分别为xh角3个块系数构成的四叉树.在这个矩阵和唯一的子树中,任何小波系数xγk,i,j为根元素.分形小波变换图像编码可以用“拼贴xγ编码”来完成.“拼贴编码”程序对图像产生分形小波编码的过程如下:首先考虑一套固定的父子子树的等级值(k1,k2),且k1<k2.对每个未编码子子树Xγ1,…,2k度系数si,j,i,j,使用式(1)计算出来的“拼贴距离”最小.分形小波编码的结果由3部分组成:(1)父子子树的等级值(k1,k2);(2)总数为4kk,i,j,这些小波系数在分形小波变换过程中保持不xγ变;(3)总数为3×4k个父子子树索引(iγ,jγ).在严格执行图像保真度的限制条件下,标准分形小波编码方案中的3个基本子带可以使用共同的父带和尺度系数.分形小波编码通常是先从已存储小波系数的小波系数树开始.然后通过分形小波缩放和复制的迭代方式生成一个逼近原始图像的“固定点”的小波系数矩阵.“拼贴距离”越小,逼近原始图像的效果越好[30].给定一个小波系数树R,假设子子树为Ci,j=2,i,j,用向量狓=(x1,…,xd)T来表示;父子树为XγKPi,j=Xγ实践中,父子子树的拼贴编码应使L2范数的误差Δ=狓-s狓最大限度地减少.然后,把图像的小波变换作为一个随机信号.这样,小波系数狓和狓就可以被看作是从随机变量中抽取出来的随机样本,并分别代表父子树及其对应的子子树小波系数分布.最佳最小二乘尺度系数可以写成[18]由于统计的样本量有限,严格地说,上面的表达式只是随机变量的近似统计量.2.2无噪图像的分形小波预测编码如果把图像的分形小波变换看作为一个随机信号[18],那么分形小波编码过程可以归纳为均方差(MSE)的估计问题:对每个未编码的子子树狓k来说,找到最佳的父子树狓k及其对应的尺度系数时的均方差可以用式(3)来计算:MES=E[(狓k-si,k狓i)2]其中,尺度系数的估计是通过式(2)完成的.然而,在实际中必须对噪声图像进行无噪预测编码.用狓^和狓^分别表示噪声图像的子子树和父子树,则采用正交小波基时,噪声图像和无噪图像对应的小波系数之间满足如下关系:其中,W狓i和W狓k可认为是统计独立的相同分布的AWGN处理[11].N(0,σ2的.可以通过确保子子树和父子树不重叠来达到独立.并假设图像和噪声信号都是独立的,这种假设是合理可行的.由上述假设可以很容易地得到:由上述推导,提出以下重要观测:①从对噪声的观测过程中,可以对原始无噪声图像的统计进行估计.当这些估计具有鲁棒性时,它们可以用来估计无噪声图像的分形小波编码.根据Page4对噪声观测的统计来估计无噪声图像拼贴均方差MES.对于给定的子树,选择最小的父子子树均方差MES估计.当含噪父子树和子子树的能量远远大于噪声方差时,统计估计量的鲁棒性得以实现,即②参数ν1.通过对各种测试图像的观测,ν在1.5~2.5之间能够获得最佳分形小波编码去噪效果,在本文实验中选取ν=2.当式(6)的鲁棒性标准不满足时,式(5)可能会产生负的二阶矩估计,式(2)的预测尺度系数可能是极大的.因此,该预测方法不适用于稀疏信号信息.对于这种特殊的噪声子树,由于减小噪声尺度系数的幅度,噪声的分形小波系数得到了减少,故有助于抑制一些噪声.采用式(7)来减小噪声尺度系数的幅度:虽然上述算法是对标准分形小波编码方法的概述,但可以将它推广到其他分形小波编码方案,如使用拼贴误差分解标准的四叉树分形小波分解编码方法[26].使用子和父3个子带树的分形小波去噪方法,增加了编码节点的个数,从而使得编码有足够大的规模.有利于对局部统计的估计和取得良好的去噪效果.对于图像中不具备自相似性的部分,通常是噪声点部分,在预测编码的过程中将被自相似性的部分的预测编码取代,因此,去噪过程中不会引发新的畸变.3基于多元统计模型的分形小波自适应图像去噪虽然分形小波预测编码能够在图像去噪过程中得到比较清晰的去噪图像,但是去噪同时丢失了部分边缘信息.大量自然图像的小波系数具有非高斯特性,各细节子带中的系数都基本上在零附近对称分布,在零点处形成一个尖峰,有很长的拖尾.这种分布特性与广义高斯函数很接近,如图2中的人脸图2人脸肤色在YCbCr空间中的高斯分布设IA为不带噪声的自然图像,IB为带噪声图图像在YCbCr空间中的小波系数类似高斯分布,因此GGD经常被用于描述子带系数的先验信息.为了得到保留良好边缘和纹理细节的去噪图像,本文利用多元统计模型来优化分形小波编码.3.1多元统计模型的贝叶斯估计像,它们之间的关系可以用式(8)来表示:其中,C表示零均值高斯白噪声,C~N(0,1);σ2表示噪声方差.对噪声图像IB进行多分辨率分形小波分解后得到第j层第i个水平小波系数yhi,j、垂直小波系数yvi,j和对角小波系数ydi,j.由小波变换的线性关系,可以得出:其中,xh和对角小波系数;zh水平、垂直和对角小波系数.设狓是一个d维小波系数向量,狓=(x1,…,xd)T.其中x1是在去噪过程中必须考虑的小波系数,(x2,…,xd)是在去噪过程中可以考虑的相关小波系数(如邻域、父子小波系数).为了简化计算式,用单下标小波系数xk,yk,zk分别取代(xhi,j),(yhxd声对应的小波系数向量分别为狔和狕,则有在计算过程中,关注的焦点是未知小波系数向量狓^的估计值.而狓^的估计值的计算又依赖于噪声图像IB所对应的小波系数向量狔.本文利用最大后验概率(MaximumAPosteriori,MAP)算子最大化概率p(狓|狔)来估计狓^,可以通过式(11)来计算.由于式(11)中p(狔)只是一个已知常量,不影响计算结果.则在概率的误差最小时,狓^最佳值可以通过p(狔|狓)和统计样本的分布函数均方差p(狓)来估计.狓^=argmax=argmax=argmaxargmax首先,由于高斯噪声的每个向量是独立同分布,p(狔|狓)满足多元高斯分布N(0,∑狕Page5Inp(狔|狓)可以通过式(12)来计算:Inp(狔狓)=Inp(狕)=In1=In1(2π)d/2∑犣(2π)d/2∑犣2In(2πσ2)-(狔-狓)T(狔-狓)=-d其次,必须为p(狓)建立合适的统计模型.为此,对样本图像的小波系数进行检测,发现它们的分布近似于高斯分布.并结合文献[31-35]得出高斯混合模型最适合组建最佳模型.因此,选用扩展的GGD模型的MGGD模型可表示为p(狓)=νexp-其中,α和β为模型的球形参数;ν是α,β和协方差矩阵∑狓定义为未知函数f(狓),则由式(11)和(12)可得狓^=argmax=argmax其中,F(狓)为方括号内的部分.假设F(狓)连续、可微,如果存在狓^满足F(狓^)>limxi→F(狓),则最大化F(狓)可改由式(15)来计算.狓∈狓∈最后,利用式(15)对式(14)进行化简可得这样,假设μ=0,利用MGGD模型可以得出式(16)的更明确的计算为由式(16)和式(17)可得为了解决式(18)中没有通解的问题,可以通过利用基于多元统计模型的分形小波自适应图像定义α,β及协方差矩阵∑狓^求解的目的.本文在实验中采用最小二乘法来自适应求解参数α和β.利用多元统计模型来分析经分形小波变换后的图像的小波系数分布,充分利用了图像的局部特征以提高滤波器的滤噪效果,图像的精细结构及边缘信息得到了保留.3.2算法描述去噪算法进行去噪的具体步骤描述如下.算法1.基于多元统计模型的分形小波自适应图像去噪算法.1.先对含噪图像f(x)进行同态变换.通过同态变换,含乘性噪声的原始图像f(x)转换为只含加性噪声的图像f(x).2.对含噪图像f(x)进行分形小波变换,选择合适的小波基和小波分解层数j,得到相应的小波系数.3.选择MGGD多元统计模型自适应求解参数α和β.在对自然图像的小波系数分布情况进行分析后,通过下面的方法来获得最适合的参数值α和β:众所周知,自然图像的小波系数的详细分布看起来像零均值高斯分布,如GGD[32].选用20幅大小为512×512的测试图像进行样本系数提取.在分析过程中,利用Daubechies20滤波器对图像集进行分形小波分解,寻找最接近每个子带分析的MGGD多元统计模型.确定最适合的参数问题就可以转化为数据拟合问题.如果考虑两个分布函数均方差p1(狓)和p2(狓^|(α,β)),其中p2(狓^|(α,β))是参数α和β取最佳值时采用多元统计模型的分布函数均方差,p1(狓)是统计样本的分布函数均方差.残差的L2范数可以用式(19)来定义:为此,利用Matlab的优化工具箱lsqcurvefit()函数来分析,通过最小化R1得到最接近p1(狓)的p2(狓^)及其参数α和β.由于数目较少的大小波系数比数目较多的小小波系数在计算中更重要,本文定义对数残差的L2范数为由于没有样本时p1(狓)可能为0和p1(狓)取值小得不合理时,利用lsqcurvefit()函数可能得到不准确解.这时,风险值R2和参数α,β之间的关系可以通过观测获得.4.对分解得到的噪声图像小波系数的子子树和父子树狓^和狓^,利用2.2节介绍的分形小波编码方法对噪声图像进行无噪预测编码.5.利用狓^和狓^进行小波重构,得到估计信号狓k和狓k,即为去噪后的图像信号.Page64实验结果分析为验证本文提出算法的去噪效果并和最近相关文献提出的HMT去噪方法[35]、边缘保护小波变换去噪方法[17]、局部双向收缩去噪方法[16]、分形小波变换去噪方法[18]、多元统计去噪方法[33]和高斯尺度混合去噪方法[34]进行对比研究,本文选用灰度级为256,像素为(512×512)Lena(图3(a)所示)、Boat图3Lena图像、噪声图像和6种去噪方法去噪效果图和Peppers256图像进行去噪实验.由于许多实际噪声可以近似为高斯分布的白噪声,本文通过在图像中叠加高斯白噪声来研究和比较图像去噪效果.加入高斯噪声后的图像如图3(b)所示.采用本文提出的去噪方法和文献中提出的去噪方法得到的结果图像分别如图3(c)~(h)所示.从图3可以看出,本文提出的去噪算法得到的图像,不仅能够有效地去除噪声,而且原图像中的许多边缘和纹理细节特征也得以很好地保留(如帽羽、瞳孔等),具有较高的视觉质量.为了定量地衡量去噪效果,通过定义均方误差百分比(RatioofMeanSquareError,RMSE)和峰值信噪比(PeakSignaltoNoiseRatio,PSNR)两项本文采用定性和定量的比较方法对本文提出的去噪方法和相关文献中提出的去噪方法的去噪效果进行比较.由于在去噪过程中不可避免地丢失一些图像信息和残留部分噪声信息,这样图像中一些像素的灰度值及图像的边缘特征会发生相应的变化.因此,可以根据图像的灰度直方图和图像的边缘检测结果图来比较各种去噪方法的去噪效果.图4(a)为原始Lena图像的灰度直方图;图4(b)为加入高斯噪声后图像的灰度直方图;采用本文提出的去噪方法和文献中提出的去噪方法得到的结果图像的灰度直方图分别如图4(c)~(h)所示.和原始图像比较可以看出,利用文献中提出的去噪算法得到的图像的像素点的灰度值变化比较大,而利用本文提出的去噪算法得到的图像的像素点的灰度值变化不明显.说明本文方法的去噪效果更好.图5(a)为原始Lena图像的边缘检测结果图;采用本文提出的去噪方法和文献中提出的去噪方法得到的结果图像的边缘检测结果图分别如图5(b)~(g)所示.与原始图像的边缘特征比较可以看出,图中分形小波去噪图像轮廓细节的清晰度较好,但明显丢失了部分边缘特征;多元统计模型去噪图像的边缘特征保持得比较好,但精细结构欠缺;通过对分形小波变换中的各子小波系数采用多元统计模型进行统计去噪,有利于综合分形小波和多元统计模型的优点.从直方图和边缘检测效果可以看出本文去噪方法既能够保持图像原有的清晰边缘又可以提高去噪图像的清晰度.本文采用的去噪算法与最近相关文献提出的去噪方法在处理一幅噪声图像的平均用时如表1所示.Page7图4Lena图像、噪声图像和6种图像去噪方法去噪后的结果图像的灰度直方图图5Lena图像和6种图像去噪方法去噪后的结果图像的边缘检测图表17种图像去噪方法处理一幅噪声图像平均用时算法本文方法分形小波变换多元统计HMT局部双向收缩边缘保护小波变换高斯尺度混合耗时0.013560.012680.025870.031530.02294Page8指标对去噪效果进行统计分析.对于一幅像素为N×M的图像,定义均方误差百分比为RMSE=1定义去噪后图像的峰值信噪比为其中,fmax=maxf(n,m),n∈[0,1,…,N-1],m∈[0,1,…,M-1],f(n,m)和^f(n,m)分别是原始图像和去噪后的图像在(n,m)位置上的像素点的灰度值.表2、表3和表4分别列出了Lena、Boat和Peppers256图像(如图6)在不同噪声等级下使用不同去噪算法的峰值信噪比和均方误差百分比.由结果可见,本文所提出的算法的去噪效果明显优于其他算法的去噪效果,尤其在平滑高斯噪声和有脉冲噪声在内的混合噪声去噪方面效果更显著.总的来说,无论从主观视觉效果还是PSNR和RMSE的表2不同等级高斯噪声下去噪性能比较(Lena)方法本文方法43.202.3741.702.8240.713.2439.023.6738.873.98分形小波变换30.597.5430.067.9529.688.3729.278.7628.899.16多元统计33.315.6731.466.9830.147.8929.129.0128.249.87HMT32.256.1230.287.7128.819.6727.6510.2526.8010.81局部双向收缩33.075.7631.337.0330.057.9529.038.8228.289.86边缘保护小波变换33.325.6531.666.9630.567.5830.017.9629.518.40高斯尺度混合40.433.3035.994.5933.515.6231.536.9830.227.83表3不同等级高斯噪声下去噪性能比较(Boat)方法本文方法35.715.0234.665.3133.345.7631.966.3130.667.00分形小波变换30.138.5728.999.0628.909.1528.1310.4527.3111.00多元统计31.537.5429.728.8629.159.0328.2410.2627.6110.89HMT33.126.2532.516.4831.606.8730.627.3629.627.95局部双向收缩32.076.7230.868.0330.228.4529.458.7728.789.23边缘保护小波变换32.156.5830.937.9630.418.3629.568.6928.939.18高斯尺度混合33.745.5233.055.7832.076.2030.996.7429.907.38表4不同等级高斯噪声下去噪性能比较(Peppers256)方法本文方法35.795.2334.685.5133.385.9632.006.5130.767.10分形小波变换30.617.5130.387.6730.317.7829.738.0128.749.32多元统计33.625.8232.876.1032.036.4630.917.0229.917.89HMT32.806.1432.076.3831.086.7930.097.7529.328.13局部双向收缩32.626.2131.877.6831.037.9530.668.2429.468.78边缘保护小波变换32.487.4132.017.5931.257.9130.398.3029.428.84高斯尺度混合33.806.0433.086.2832.076.6931.097.1530.027.83客观评价方面来看,本文算法相对于其他6种算法去噪效果都有明显的改进,既能够很好地消除噪声,又能够较好地保持图像边缘和纹理细节.图6Boat和Peppers256的原图和σ=20时的噪声图σ=20PSNRRMSEσ=20PSNRRMSEσ=20PSNRRMSEPage9需要说明的是,不同的图像及不同的含噪度,其最终采用的参数也会不一样.因此,在使用本文提出的算法去噪时,应不断地自适应调整参数α和β的值,以便达到使图像最终处理的结果最优的目的.4结论本文提出了一种基于多元统计模型的分形小波自适应图像去噪算法.该算法首先采用分形小波变换构造噪声图像小波系数的子子树和父子树,然后利用多元统计模型根据分形小波变换的自相似性对各部分进行统计去噪.最后通过使用四叉树分割来实现对噪声图像自适应地预测分形小波无噪图像编码,从而达到优化去噪的目的.实验结果表明,本文提出的去噪方法明显优于作为实验结果中列出的现有算法.该方法在去除噪声的同时,能有效地保持图像的边缘及纹理特征,很好地保留图像的精细结构,取得了良好的去噪效果.在图像复原、增强等诸多领域内都具有重要的应用价值.致谢感谢给出评语和修改意见的审稿老师!
