Page1基于最优区分器的多差分密码分析方法高海英金晨辉(解放军信息工程大学郑州450001)摘要如何利用多个差分特征对分组密码算法进行差分攻击,从而精确地估计出分组密码算法抵抗差分攻击的能力,是一个重要的研究课题.文中基于最优区分器的思想,提出了一种多差分密码分析方法.针对每个实验密钥,构造出基于多个差分特征的统计量,根据统计量的大小判决实验密钥是否为正确密钥.给出了多差分分析方法的计算复杂度,分析了正确密钥、错误密钥对应统计量的概率分布规律,并在此基础上给出了多差分分析方法的成功率和数据复杂度之间的关系.通过具体实例表明,在成功率相同的条件下,基于的差分特征越多,需要的数据复杂度越小.关键词分组密码;最优区分器;多差分密码分析;差分特征;成功率;密码学1引言差分密码分析方法是Biham和Shamir[1]在1990年欧洲密码年会上提出的一种对迭代型分组密码算法的选择明文攻击方法.其基本思想是利用分组密码算法的差分统计量分布的不平衡性这个信文献[1]的差分分析方法只使用了一个差分特Page2征,如何综合利用多个差分特征对算法进行攻击?为了解决该问题,Biham和Shamir[9]提出了综合利用多个具有相同输出差分的差分特征的差分分析方法;Knudsen[6]提出了截断差分分析方法,但是该方法要求输出差分必须构成一个线性空间.2011年,Blondeau等人[10]提出了具有普适性的多差分攻击方法,该方法综合利用了多个输入差分、多个输出差分的差分特征(差分特征中的输入差分和输出差分没有特殊要求),但是,文章构造的统计量没有利用最优区分的思想,给出的多差分分析方法不是最优的,即没有最大限度地利用差分特征分布不均匀性这个信息泄漏特点.为了给出最优的多差分攻击方法,2012年Blondeau等人[11]提出了针对单个输入差分、多个输出差分情况的多差分攻击方法,并给出了任意成功率条件下的数据复杂度的计算公式,但文中没有针对多个输入差分、多个输出差分的情况提出攻击方法.针对多个输入差分、多个输出差分的情况,如何设计多差分分析方法?为了解决该问题,本文基于最优区分器的思想和策略提出了一种多差分分析方法,并给出了任意成功率条件下的数据复杂度的计算公式.在已知数据量的条件下,给出了成功率为1时,候选密钥量的个数的期望值.最后,通过具体实例得出:在成功率相等的条件下,利用的差分特征越多,攻击所需的数据复杂度就越小.本文第2节简要介绍最优区分器;第3节介绍基于最优区分器的多差分密码分析方法;第4节对多差分分析方法的各项性能指标进行分析;第5节给出了多差分密码分析方法的一个具体应用;最后一节对全文进行总结和展望.2最优区分器由于文章给出的多差分密码分析方法是基于最优区分器的思想提出的,因此,本节首先介绍最优区分器.设一条序列s-={si}n分布的,并且若si服从D0分布,则对于a∈FmPrD0[a]=PrD0[si=a]=pa;若si服从D1分布,令PrD1[a]=PrD1[si=a]=1/2m.区分器是一种判定算法,该算法的目的是在已知上述条件的前提下,给出si服从何种分布(D0或D1)的判定结果.所谓最优区分器,即使得区分优势达到最大的判定算法,文献[12]基于后验概率的思想提出了一种最优区分器,现将该区分器描述如下.最优区分器.输入:一条n长序列s-={si}n输出:若输出0,则判定s-服从D0分布;若输出1,则判1.计算LLR(LogarithmicLikelihoodRatio)统计量:其中N(a|s-)表示序列s-中a的个数.2.输出判定结果A(s-):文献[12]定义了区分器的区分优势为Adv(A(s-))=PrD0[A(s-)=0]-PrD1[A(s-)=0]其中,Pe=1服从D1分布的错误概率,α2是将s-服从D1分布判断为服从D0分布的错误概率.给出区分优势的计算公式为Adv(A(s-))=1-2-n·Δ(D0槡)其中并且证明了上述区分器是最优区分器.3多差分密码分析方法3.1相关定义令E表示一个r圈迭代型分组密码算法,该算法的密钥是K,分组规模是m比特,Kr是第r圈子密钥,F表示圈函数.设明文空间为X,密文空间是Y.对于任意明文分组x∈X,相应的密文表示为y=EK(x),其中EK(x)=FKr…FK1(x).下面介绍与多差分密码分析方法相关的定义.定义1.设(δ0,δr-1)是分组密码算法E的(r-1)圈差分特征,该差分特征的概率定义为Pr[δ0→δr-1]=PrX,K[F-1δr-1]=2-m.一般情况下,当Kr是错误密钥时,Pr[δ0→针对分组密码算法E,假设攻击者找到了多个Page3利用最优区分器判决δ(i)r-1服从D1分布.因此,判定实验密钥Kr是具有较大概率的(r-1)圈差分特征,这些差分特征构成集合Δ={(δ(i)r-1|},令其中输入差分构成的集合为Δ0,Δ0=def|Δ(i){δ0,δr-1,(δ0,δr-1)∈Δ}={δ(1)Δ0中的每个输入差分δ(i)记为Δ(i)δ(i,|Δ(i)r-1}.r-1|)下面介绍本文提出的多差分密码分析方法.3.2基于最优区分器的多差分密码分析假设|Δ0|=1,即Δ中输入差分只有一种,记为0,其对应的输出差分记为δ(i)δ(i)圈子密钥时,δ(i)钥时,δ(i)否是正确圈子密钥等价于区分δ(i)D1分布.依此类推,针对|Δ0|>1的情况,假设当Kr是正确圈子密钥时,输出差分构成的向量(δ(1)r-1)服从珡D0分布;当Kr是错误圈子密钥时,δ(|Δ0|)(δ(1)r-1,δ(2)密钥Kr是否是正确圈子密钥等价于区分(δ(1)r-1,…,δ(|Δ0|)δ(2)需要计算统计量LLR(i).同理,为了区分(δ(1)r-1,…,δ(|Δ0|)δ(2)LLR.下面分别介绍LLR(i)(i=1…|Δ0|)和LLR的构造方法.首先假设当Kr是正确圈子密钥时,δ(i)D0分布,具体描述如下:(1)j∈{1,2,…,|Δ(i)p(i,j),且p(i,j)是已知的;(2)β∈Fm(1-∑1jΔiwi表示1-∑1jΔiD1分布:β∈Fm(δ(1)r-1,δ(2)(γ1,…,γ|Δ0|)∈(FmPr珡D0[δr-1=(γ1,…,γ|Δ0|)]=∏Δ0Pr珡D1[δr-1=(γ1,…,γ|Δ0|)]=∏Δ0同时假设当Kr是错误圈子密钥时,δ(i)假设δ(i)已知M个明文对{(xk,xkδ(i)|Δ0|}),以及对应的密文对{(yk,yk)}M的子密钥Kr有2nk个可能值,记为Kt利用实验密钥Kt到{(zk,zk)}M{1,…,|Δ0|}.根据式(1),基于差分特征(δ(i)r-1),…,(δ(i)(δ(i)0,δ(i,2)LLR(i)(δ(i)LLR(i)(δ(i)=∑a∈Δ(i)∑aΔ(i)=∑δ(i,j)r-1∈Δ(i)(M-∑δ(i,j)下面分析如何利用集合Δ中的所有差分特征构造相应的统计量LLR.设|Δ0|+1个明文(xk,xkδ(1)0)构成一个明文向量,已知M个明文向量xkδ(|Δ0|)构成的向量序列{(xk,xkδ(1)0)}Mδ(|Δ0|)k)}My(|Δ0|){(yk,y(1)k)}Mz(|Δ0|){(zkz(1)令序列δr-1(Ktk)}Mz(|Δ0|)根据式(1)可得LLR(δr-1(Kt=∑(γ1,…,γΔ0)∈(FmlogPrD0[γ1]∑(γ1,…,γΔ0)∈(FmPage42logPrD0[γ2]∑(γ1,…,γΔ0)∈(Fm(2-m(logPrD0[γ|Δ0|]=∑γ1∈Fm∑γ2∈Fm∑γΔ0∈Fm=LLR(1)(δ(1)LLR(|Δ0|)(δ(|Δ0|)在假设差分特征相互独立的条件下,式(3)给出了综合利用集合Δ中的所有差分特征构造的统计量LLR(δr-1(Kt基于最优区分器的思想,利用差分特征(δ(i)2r-1)(i=1,…,|Δ0|,j=1,…,|Δ(i)δ(i,j)E进行多差分攻击的过程,等价于对2nk条输出差分序列δr-1(Kt(|Δ0|>1)的基本过程,记为算法1.下面给出对r圈分组密码算法进行多差分攻击算法1.1.已知M个明文向量构成的序列{(xk,xkδ(1)0,…,xkδ(|Δ0|)δ(2)k)}My(|Δ0|)k)}My(|Δ0|)出差分序列,分别是δ(1){zkz(2)k}M2.利用式(2)分别计算出LLR(i)(δ(i)|Δ0|,然后,利用式(3)计算出LLR(δr-1(Kt量LLR(δr-1(Kt计量对应的圈子密钥作为候选密钥.4多差分密码分析方法的指标分析本节分析算法1的计算复杂度、存储复杂度和定理1.算法1的计算复杂度是O((|Δ0|+1)·M·2nk/r)次分组密码算法解密运算,存储复杂度是O((|Δ0|+1)·M)个明密对.成功率.证明.算法1中步1中需要进行(|Δ0|+1)·M·2nk次第r圈解密操作,步2中需要计算2nk个LLR统计量,并且需要对2nk个统计量的值进行排序.由于步2的计算复杂度与步1的计算复杂度相比,具有较小的数量级,因此,算法1的计算复杂度记为O((|Δ0|+1)·M·2nk)次圈函数解密运算,由于本文假设分组密码算法是r圈,因此,算法1的计算复杂度是O((|Δ0|+1)·M·2nk/r)次分组密码算法解密运算.算法1需要存储M个明文向量(xk,xkδ(1)0,…,xkδ(|Δ0|)xkδ(2){(yk,y(1)度是O((|Δ0|+1)·M)个明密对.证毕.另外注意,当|Δ0|=1时,算法1的计算复杂度和存储复杂度与文献[11]的结果相同.为了给出数据复杂度与成功率之间的关系,我们需要分析正确的圈子密钥KTr对应的统计量LLR(δr-1(KTr))、错误的圈子密钥KFr对应的统计量LLR(δr-1(KFr))的概率分布.首先给出相关定义.对于(γ1,…,γ|Δ0|)∈(Fm并且令Δ(珡D0)=∑γ∈(Fm由于Pr珡D1[δr-1=γ]=Pr珡D1[δr-1=(γ1,…,γ|Δ0|)]因此定理2.LLR(δr-1(KTr))和LLR(δr-1(KFr))都服从正态分布,且μ0≈-μ1≈1证明.由文献[12]中的Proposition5直接可得LLR(δr-1(KTr))和LLR(δr-1(KFr))的概率分布.Page5定理2分别给出了统计量LLR(δr-1(KTr))和统计量LLR(δr-1(KFr))服从的概率分布,利用该结论,我们在定理3中分析了算法1的数据复杂度和成功率之间的关系.定理3.令d=M·Δ(珚D0),假设LLR(δr-1(KTr))和LLR(δr-1(KFr))相互独立,且假设攻击者选择前l个最大值对应的实验密钥作为候选密钥,则当数据复杂度是(1+|Δ0|)·M时,算法1的成功率为证明.由于假设LLR(δr-1(KTr))和LLR(δr-1(KFr))是相互独立的,由定理2可得LLR(δr-1(KTr))-LLR(δr-1(KFr))服从正态分布N(μ,σ2),其中因此,Pr[LLR(δr-1(KTr))-LLR(δr-1(KFr))<0]=[PrLLR(δr-1(KTr))-LLR(δr-1(KFr))-MΔ(珚D0)2MΔ(珚D0槡])≈(-MΔ(珡D0)/槡2),其中,(x)=1-MΔ(珚D0)将LLR(δr-1(Kt事件Aj表示排第j(1jl)位的实验密钥是正确密钥,求出其中,d=M·Δ(珡D0).已知攻击者选择前l个最大值对应的实验密钥作为候选密钥,则算法1攻击成功的概率PS=Pr[正确密钥落入候选密钥集]=Pr[A1∪A2∪…∪Al],由于Aj是互斥的,因此算法1用到了M长的明文向量序列以及对应的密文向量序列,因此,数据复杂度是(1+|Δ0|)·M个明密对,通过上述分析可知,算法1的成功率是∑l2nk-1·((-d/槡2))j-1·(1-(-d/槡2))2nk-j.Cj-1j=1值应该是多少?下面分析算法1的成功率为1的条件下,l的取由定理3的证明过程可知:Pr[LLR(δr-1(KTr))-LLR(δr-1(KFr))<0]≈(-MΔ(珡D0)/槡2).因此,平均有(2nk-1)·(-MΔ(珡D0)/槡2)个错误密钥的统计量的值大于正确密钥的统计量的值.若使得成功率为1,则l的平均值是1+(2nk-1)·(-MΔ(珡D0)/槡2).由定理3可知,为了得到算法1的数据复杂度和成功率的关系,需要计算Δ(珡D0)(d=M·Δ(珡D0)),如果直接利用式(4)计算Δ(珡D0),计算复杂度较高,下面以定理4的形式给出计算Δ(珡D0)的简单方法.(1)Δ(i)(D0)=定理4.令Δ(i)(D0)=∑γi∈Fm其中i=1,2,…,|Δ0|,则2m∑δ(i,j)r-1∈Δ(i)2m(2m-|Δ(i)其中p(i,j)=PrD0[δ(i)1,…,|Δ(i)(2)Δ(珡D0)≈∑Δ0证明.(1)根据Δ(i)(D0)的定义得到Δ(i)(D0)=∑γi∈Fm=2m∑γi∈Fm=2m∑γi∈Δ(i)=2m∑δ(i,j)Page62m(2m-|Δ(i),其中p(i,j)=PrD0[δ(i)(2)利用数学归纳法证明,具体证明过程如下:①当|Δ0|=1时,Δ(珡D0)=Δ(1)(D1);②当|Δ0|=2时,r-1=γ2]))(2Pr珡D1[δ(1)Δ(珡D0)=∑γ∈(Fm=∑γ1,γ2∈Fm(γ1,δ(2)=22m·∑γ1,γ2∈Fm=22m·∑γ1,γ2∈Fm2·∑γ1,γ2∈Fm=22m·∑γ1∈Fm2·∑γ1∈Fm=22m·∑γ1∈Fm同理,Δ(1)(D0)=∑γ1∈FmΔ(2)(D0)=2m·∑γ2∈Fm则Δ(珡D0)-Δ(1)(D0)=22m·∑γ1∈Fm1-2m·∑γ1∈Fm=2m·∑γ1∈Fm[2m∑γ2∈Fm=Δ(2)(D0)(Δ(1)(D0)+1)由于Δ(2)(D0)·Δ(1)(D0)max{Δ(2)(D0),Δ(2)(D0)},因此Δ(珡D0)=Δ(1)(D0)+Δ(2)(D0)+Δ(1)(D0)Δ(2)(D0)③当|Δ0|=n时,设Δ(珡D0)≈∑n④当|Δ0|=n+1时,根据②的证明过程可得由定理4可知,在已知p(i,j)(i=1,…,|Δ0|,j=Δ(珚D0)-∑n因此,Δ(珡D0)≈∑n+11,…,|Δ(i)Δ(i)(D0),i=1,2,…,|Δ0|,然后,利用式(7)计算出Δ(珡D0).在已知Δ(珡D0)的条件下,我们就可以利用定理3的结论计算出算法1的数据复杂度和成功率之间的关系.5基于最优区分器的多差分密码分析的应用本节通过一个例子给出算法1的具体应用.已知一个r圈分组密码算法E的分组规模m=128,第r圈子密钥Kr是nk比特.并且找到该算法的48个r-1圈的高概率差分特征,其中输入差分构成的集合Δ0={δ(1)2,…,16},|Δ(i)已知:(1)PrD0[δ(i)(2)β∈F128(3)β∈F128下面给出利用算法1对该分组密码算法E的1.已知M个明文向量构成的序列{(xk,xkδ(1)多差分密码分析方法.k=1.利用实验密钥Ktk=1,得到{(zk,z(1)0,…,xkδ(16)δ(2)k)}My(16)k)}My(16)差分序列,分别是δ(1){zkz(2)k}M2.利用式(2)分别计算出LLR(i)(δ(i)16,然后,利用式(3)计算出LLR(δr-1(KtLLR(δr-1(Kt量对应的圈子密钥作为候选密钥.Page7下面分析上述多差分攻击算法的成功率与数据根据式(6)可计算出Δ(i)(D0)(1i16):复杂度之间的关系.Δ(i)(D0)=2128[×3×(2-114-2-128)2+(2128-3)×根据式(7)可计算出Δ(珡D0)≈∑16根据式(5)计算出当数据复杂度是17·M个明密对时,对差分攻击的成功率是若令l=1,假设在相同成功率的条件下,令基于单个输入差分、多个输出差分(假设只利用差分特0,δ(1,1)征(δ(1)攻击的数据复杂度为N1个明密对,基于多个输入差分、多个输出差分(利用的差分特征是(δ(i)r-1),1i3,1j16)的多差分攻击的数据复δ(i,j)杂度为N2个明密对,下面分析N1和N2的关系.已知l=1,且成功率相同,由定理3可得(1-(-(N1/2)·Δ(1)(D0)/(1-(-(N2/(1+|Δ0|))·Δ(珡D0)/(N1/2)·2-99=(N2/(1+|Δ0|))·|Δ0|·2-95(8)由式(8)计算出N1/N2=2|Δ0|/(|Δ0|+1),当|Δ0|=16时,N1/N2≈32.由N1/N2=2|Δ0|/(|Δ0|+1)说明,在|Δ0|>1,且攻击成功率相同的条件下,利用的差分特征越多,算法1所需的数据复杂度越小.6结束语如何利用多个差分特征对分组密码算法进行攻击,从而降低基于单差分特征的差分攻击的数据复杂度,是密码分析领域的一个重要的研究问题.本文基于最优区分器的思想,提出了一种最优的多差分密码分析方法,并分析了该方法的各项性能指标.另外,本文分析得出,在相同成功率的条件下,采用的差分特征越多,所需的数据复杂度越小,并给出具体实例证明了该理论结果.我们下一步的工作重点是利用文章提出的多差分分析方法攻击具体的分组密码算法,从而给出该算法的精确的抗差分分析的能力.致谢审稿专家和编辑老师为本文提出了宝贵的修改建议,在此表示衷心的感谢!
