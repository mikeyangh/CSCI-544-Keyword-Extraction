Page1基于KFD指标聚类的高隐蔽性JPEG隐写分析黄炜1),2)赵险峰2)盛任农3)1)(中国科学院软件研究所北京100190)2)(中国科学院信息工程研究所信息安全国家重点实验室北京100195)3)(北京电子技术应用研究所北京100191)摘要采用非公开的图像源或算法的隐写行为具有很强的隐蔽性.在这类对隐写者先验不足的场景下聚类分析更为实用.Ker等人比较不同指标不同配置之后,提出基于MMD指标聚类的隐写者识别方法.然而该方法所用MMD指标只考虑两个类样本中心之间的距离,忽略了样本相对中心点的聚合程度对可分性的影响,因而准确率存在提高的空间.为进一步提高现有隐写聚类分析方法的准确率,该文提出用核Fisher鉴别(KFD)指标计算样本间差异度量的聚类方法.首先,提取PEV274校准特征并归一化.然后,计算KFD指标组成距离矩阵.最后,根据样本间差异度量矩阵按重心法自底向上进行层次聚类分析.KFD指标兼顾与最大平均距离(MMD)原理相近的类间方差以及指示样本聚集程度的类内方差,更准确地估算样本间差异.实验结果表明,该文对低嵌入率隐写其准确率最高提高约30%,对高嵌入率准确率降低不超过5%.该文的创新点在于提出了一种更合理的指标和基于该指标聚类隐写分析的方法,比现有方法平均准确率有一定的提高.关键词核Fisher鉴别指标;聚类分析;隐写分析;类内方差1引言隐写分析(steganalysis)[1]作为检测隐写行为存在性的一种手段,近年来受到广泛的研究.JPEG图像是最常见的多媒体之一,因而JPEG图像隐写研究具有较好的实用意义.现有JPEG隐写方法包括最低有效位(LeastSignificantBits,LSB)、量化方法和在此基础上的改进方法.JPHide[7]基于查表动态选择嵌入位置提高了LSB隐写的隐蔽性.扰动量化(PerturbedQuantization,PQ)[5]选取失真较小的系数进行嵌入,从而达到减小扰动量的目的;PQe[6]在PQ基础上做出改进,选择在DCT能量高的地方嵌入,进一步减少了扰动量.F5[3]通过矩阵编码技术减少改动位置;修改的矩阵编码(ModifiedMatrixEncoding,MME)[4]进一步寻找失真最小的位置组合进行嵌入,进一步降低扰动量;nsF5[6]在F5基础上进一步改进,消除DCT直方图收缩(shrinkage)效应,是目前隐蔽性最强的JPEG隐写算法之一.现有隐写分析多基于一组通用隐写特征和一种分类器[8],用已知样本训练后对待测样本进行二类分类,判断待测样本隐写行为存在性.其中,PEV274特征[14]利用校准技术估计原图,对图像裁剪4行4列重做JPEG压缩,并提取了7组统计特性,是目前维度较低且分析能力最强的特征.二类隐写分析可以扩展为多类隐写分析[2],有效地适用已知隐写算法和样本来源(或其范围)的情形.但是,该方法具有两点局限性:(1)在隐写算法范围未知的情况下,分类准确率下降明显;(2)当训练集和测试集样本来源不一致(如训练集和测试集来自不同相机)时,会出现“载体源不匹配”(cover-sourcemismatch)[10]的情况,准确率大大下降.有经验的隐写者可以利用该局限性来逃避隐写分析,即尽量避免采用公开的算法和图像源,以隐藏秘密信息的存在性.这一类的隐写行为隐蔽性很高,是隐写分析的难点之一.相对二类或多类隐写分析,在未知算法和图像源范围的场景下的隐写分析方法却少有关注.针对此类高隐蔽性隐写,分析者无法得到适合待测样本的载体和隐写特征,训练和分类过程无从实现,此时,聚类分析(clusteranalysis)可以解决这类问题[11].由于隐写是对图像的轻微修改,该环境下截获的样本往往较少,统计上不够稳定.因此,聚类方法并不判断单个样本的隐写存在性,而是找出参与者(actor)的隐写行为存在性.即假定截获的图像来自几个参与者,每个参与者发送一定量的图像,其中部分含有或者完全不含秘密信息.通过聚类分析,可以找出可能有隐写的参与者,以进一步跟踪分析.相对传统隐写分析,该环境有3个特点:(1)截获样本少;(2)样本的来源未知,无法获取更多同源样本;(3)隐写样本的算法及嵌入率未知.Ker等人[11]提出一种基于最大平均差异(Maxi-mumMeanDiscrepancy,MMD)[12,18]准则的隐写聚类分析方法.该方法提取不同参与者所传递图像的PEV274特征[14],将同一个参与者传递的图像整体视为聚类中的一个样本,计算MMD作为样本间差异度量(dissimilaritymeasure),自底向上进行层次聚类(hierarchicalclustering)[9]得到最可能的隐写者.然而,MMD所指示的是两个类的样本中心点在所有可能空间的最大距离,它不能很好地表达两个类间的差异程度.两个类之间是否可以区分,不仅与类间分散程度有关,还受到类内聚合程度的影响.该方法未能考虑类内聚合程度因素,计算样本间差异度量不够准确,其准确率存在提高的空间.为了进一步提高对高隐蔽性隐写的聚类分析效果,本文提出了一种基于核Fisher鉴别(KernelFisherDiscriminant,KFD)[13]指标的隐写聚类分析Page3方法,兼顾样本在类间与类内两方面的聚合程度,以提高隐写分析检测能力.实验结果表明,该方法在低嵌入率下对隐写者的识别准确率有较大的提升,最高约30%,同时对高嵌入率隐写的准确率下降不超过5%.总体上,KFD指标(KFDIndex,KFDI)更好地反应了两个类的间距,该方法在已知条件较少的情况下能更有效地检测出真正的隐写者.本文第2节介绍相关工作;第3节介绍KFDI及本文分析算法框架,并比较KFDI与MMD指标;第4节对比本文方法与文献[11]方法,进行实验及实验分析;第5节为总结.2相关工作2.1问题定义Cachin[1]提出隐写可以视为一种信息论模型.令C为载体样本集,隐写过程可以视为一个映射关系Emb:C×E×D→S,其中E为秘密信息集,D为密钥集,S为隐写样本集,C,SI,I为样本集.通过s=Emb(c,m,k)将任意c∈C,m∈E,k∈D映射到一个隐写样本s∈S.接受方通过一个对应的映射Ext:S×D→E,获得消息m=Ext(s,k).现有的二类隐写分析通常随机选择一定数量的三元组(ci,mi,ki)制备隐写样本si,并提取隐写特征.隐写特征提取也可以视为一个映射关系Fea:I→F,其中F为特征集.对于载体样本,通过x=Fea(c),x∈X,可以提取载体特征集X,类似地,对于隐写样本有y=Fea(s),y∈Y,对于待测样本t∈TI,特征z=Fea(t),z∈Z.使用支持向量机等机器学习方法可以利用已知x={x1,x2,…,xnx}和y={y1,y2,…,yny},判断待测特征z={z1,z2,…,zn}是否含有秘密信息.当X,Y与Z在选用隐写方法及图像来源方面差异较大时,传统二类或多类隐写分析准确率较低[10].由于不同型号图像采集设备(如相机或扫描仪等)对图像的成像及加工的过程各有不同,在上述对T知识较少的情况下,无法找到与待分析样本来源相近的样本,通过单个样本的判断来识别隐写者变得困难.不妨假设T来自于N个参与者A1,A2,…,AN.其中,有且仅有一个参与者Ai,其样本数量为ni中有a·ni个样本含有秘密信息(a为嵌入密度),这些样本的嵌入率为r,其余ni-a·ni个样本没有隐写.另外N-1个参与者完全传递载体样本.本文目的在于仅已知A1,A2,…,AN的所有样本情况下,识别最可能的隐写者Ai.2.2隐写聚类分析隐写聚类分析是指通过将同一参与者的隐写样本特征作为一个对象,利用聚类方法找出隐写者的隐写分析方法.隐写聚类分析过程中,由于载体之间差异(dissimilarity)或距离(distance)较小,最终划为同一个簇(cluster);同样地,具有一定嵌入强度的隐写样本与载体样本差异较大,最终划为另一簇.最后,得到可能的隐写者.隐写聚类分析方法相较于传统二类或多类隐写分析以及一般的聚类分析,存在以下几个特点:(1)隐写聚类分析可用的先验知识较少.由于载体来源和隐写算法范围未知,分析者无法制备类似的样本用于训练;(2)维度灾难(CurseofDimensionality,CoD)[10].由于截获同一参与者图像往往较少,很难达到特征数量的数十倍[9].这也限定了特征的维度应该尽量较低;(3)隐写聚类分析识别隐写者而不是单个隐写样本.隐写对自然图像修改很少,对单个样本的判断结果并不稳定.如果对单个图像进行聚类,图像内容差异等因素很可能代替隐写行为存在性,成为影响聚类的主要因素.因而,隐写聚类分析把同一参与者的样本视为一个整体来判断隐写存在性.2.3基于MMD的隐写聚类分析MMD是度量两个类样本均值在所有映射空间下最大距离的量,其计算公式为MMD[F,X,Y]=supf∈FEx~pf(x)-Ey~qf(y其中,F是函数f:X→R的集合,R是实数集,Ex~p表示变量x服从p分布时的期望,Ey~q表示变量y服从q分布时的期望.由于MMD无法直接计算,文献[18]提供了一个近似算法.Ker等人经过大量实验比较,提出目前隐写聚类分析中效果较好的MMD隐写聚类分析方法.该方法将MMD作为样本间差异度量的计算标准,定义MMD[F,Ai,Aj]为Ai,Aj两类之间在函数集F下的距离.接着,进行层次聚类,自底向上不断将样本间差异度量最近的两个类合并,最后找出可能的隐写者.Ker等人[11]通过实验比较,计算类间差异时,重心法(centroidclustering)效果最好.3基于KFDI的隐写聚类分析方法本节介绍类间方差与类内方差,并将其扩展至Page4再生核Hilbert空间(ReproducingKernelHilbertSpaces,RKHS),用核方法求解,称为KFD指标(KFDI).接着,从原理上将KFDI和MMD指标做比较.最后,给出本文方法的实现流程.3.1类间方差与类内方差D2}为两个不同分类的样本,并有样本集整体X=狓(2)X1∪X2={狓1,狓2,…,狓D},则样本均值可以定义为令X1={狓(1)其对于给定向量狑可被映射为类间方差(between-classvariances)SSB作为类间分散程度的平方和,其计算公式为SSB=(珘μ1-珘μ2)2其中,犛B=(μ1-μ2)(μ1-μ2)T称为类间散度矩阵(between-classscattermatrix).图1(a)显示了二维情况下的类间方差.图中圆圈代表类1的样本,方框代表类2的样本,实心圆圈和方框分别是各类的中心点.在向量狑上的标记分别是这些样本及其中心在该向量上的投影.从图中可以看出,类间方差在作为类1和类2的差异性大小的评价指标时是非常重要的.一般SSB越大,表明它们的可区分性越高.类内方差(within-classvariances)SSW作为类内散度的平方和,其计算公式为SSW=∑i=1,2∑狓∈Xi=∑i=1,2其中,称为类内散度矩阵(within-classscattermatrix).图1(b)显示了二维情况下的类内方差.可以看出类内方差表明了两个类的内聚性,即两个类的样本对其中心的聚合程度.当SSB一定时,SSW越小,界限越清楚,可分离性就越好.在线性情况下,Fisher鉴别指标为类间方差和类内方差在向量狑上的比值,即3.2KFD指标现实世界的数据复杂度高,线性鉴别的能力往往有限.核(kernel)的思想[15]最初用于支持向量机(SupportVectorMachine,SVM)[8]和其它算法.下面介绍基于核的鉴别分析及KFDI.令Φ作为到空间F的非线性映射.在空间F的线性鉴别,即是最大化式(1)和(2)被替代为W=∑i=1,2∑狓∈Xi犛Φ其中,μΦ如果F维度很高,甚至是无限的,上式就不可能直接求解.考虑到只计算〈Φ(狓)·Φ(狔)〉,而不关心Φ(狓)或Φ(狔)的具体数值,因此,不需将数据显式映射到F,可以转而寻求某种算法,直接计算点乘〈Φ(狓)·Φ(狔)〉.为此,研究人员引入核的概念,定义核为一个对称正定有限矩阵的函数k:X×XR.Page5令F为一个RKHS,为求得RKHSF中的J(狑),只需找到式(3)只包含点乘公式的一种形式.在将点乘替换为一个特定的核函数,即令〈Φ(狓)·Φ(狔)〉=k(狓,狔).函数k可以是高斯函数或其它形式.由可再生核的理论可知,任意解狑∈F必须存在于F的训练样本范围之内.因此,可以找到一个狑的展开形式根据μΦi的定义,可得狑TμΦ其中,点乘被核函数替代,得到则式(2)可被重新写为其中,犕=(犕1-犕2)(犕1-犕2)T.与上式相似,可得其中犖=∑j=1,2阵,(犓j)n,m=kxn,x(j)()m,犐为单位矩阵,1Dj是元素全为1/Dj的矩阵.结合式(4)、(5),KFD度量可通过最大化得到.在有限样本的情况下,KFDI定义为类间方差和类内方差在任意映射下的最大比率,即为RHKSF下的J(α)的最大值.式(6)可通过求解犖-1犕的最大特征值得到.因而,KFDI的计算公式为其中,v(犃)为矩阵犃的最大特征值.如果犖非正定,可能无法求得犖-1.此时,可以把犖和多个单位矩阵相加,例如,可以使用犖′=犖+u·犐代替犖(建议取u=0.1).该方法可视为对α的范数α2做规范化(normalization),降低基于样本估计的特征值所带来的偏差[13].3.3KFDI和MMD比较KFDI计算类间方差与类内方差的比值在所有映射中的最大值.其中,类间方差是两个类的中心点在其投影方向的差值平方.MMD计算的是两个类中心点在所有映射空间上的距离最大值,其物理意义相当于类间方差.本文从BOSSBase图库①随机选取1000张图像作为载体,计算不同算法嵌入率下载体与隐写样本间的MMD与KFDI(表1).从表中可以看出,MMD与类间方差在数值上存在一定程度的关系,一般MMD越大,类间方差也越大.表1不同算法嵌入率下MMD与KFDI对照(1000对样本)算法嵌入率/bpacMMD类间方差类内方差KFDIJPHide[7]MME3[4]PQe[6]然而,不同的类对其中心的聚合程度并不一样.当两个类的样本间差异度量相同时,样本等中心聚合程度大的类,其区分度也较高.类内方差指示的即是样本对中心的聚合程度.图1(a)与(b)具有相同的类间方差,但图1(b)中类内方差较小,其区分度明显高于图1(a).从表1中也可以看出,类内方差在一定范围内浮动,起到一定的补充作用.将类间方差除以类内方差,有利于突出聚合程度较高的类相对于其它类之间的分离程度,因而在度量样本间差异度量上具有更好的适用性.3.4本文分析流程其实现流程如图2所示.具体步骤如下.本文提出的基于KFDI的隐写聚类分析方法,图2基于KFDI聚类的JPEG隐写分析实现流程①BOSSBasev1.0Imagebase.ftp://camnepserver.felk.Page6(1)对N个参与者的图像集犃={A1,A2,…,AN}提取PEV-274特征[14],得到特征集狕={狕1,狕2,…,狕N},其中狕i为ni×d的矩阵,PEV274的特征维度d=274;(2)计算特征集狕每一维特征的均值μd和样本标准差sd,按下式对特征矩阵规范化:(3)计算隐写特征集狕′两两之间的样本间差异度量di,j=KFDI[F,狕′i,狕′j],得到N2个样本间差异度量,选用高斯内核k(狓,狔)=exp-γ(狓-狔)(中,γ=-η2,η为狓,狔样本间L2距离(L2diver-gences);(4)根据样本间差异度量矩阵犱i,j按重心法自底向上进行层次聚类分析,以两个类的重心之间距离为两类间的距离,得到初步的聚类结果;(5)如果聚类结果最后合并的两类有一类只有一个参与者,则该参与者为隐写者;如果聚类结果最后合并的两类都包含多个参与者,则距离另一类最远的参与者为隐写者.4实验4.1实验配置为验证所提方法的有效性,本文采用BOSS-Basev1.0图库及自制图库共来自6台相机(表2)的图像,各相机选取前100幅用以模拟6个参与者,假设每个参与者各使用一种相机.将这些图像压缩至JPEG质量因子90,并用开源隐写算法nsF5[6]和表3不同隐写算法及嵌入配置下的识别率(100次实验)隐写算法分析方法nsF5文献[11]方法0.22830.32830.62330.97670.99170.99330.9950JPHide文献[11]方法0.61670.63670.65000.81170.98330.99000.9933表4展示了当嵌入负载0.30bpac及嵌入密度为30%情况下的检测结果.从表中可知,采用文献[11]方法时,A2、A3和A4多被识别为A3,相对地本文方法采用KFDI作为样本间差异度量,结果就会有较好的区分度.对于其中一次实验,聚类层次图如图3所示.从图中可以看出,在一定的嵌入率下,隐写者在聚类中JPHide[7]进行隐写,其中嵌入率密度a与嵌入率r(单位为bpac(bitpernon-zeroACcoefficient))相等,a,r∈[0.1,0.7],记为a×r.参与者A1CanonEOS400DDigital2592×3888BOSSBaseA2CanonEOSDigitalRebelXSi4272×2848BOSSBaseA3M9DigitalCamera5212×3468BOSSBaseA4A5A6CanonEOS450D4272×2848自制图库实验用自然图像来模拟非隐写者,并从嵌入率为r的隐写图像中随机选择其中的α·n幅代替对应自然图像,用以模拟隐写者.依次遍历每个参与者的不同嵌入率配置,记录其成为隐写者时,用本文方法识别正确的概率.计算概率时,对每个隐写者随机选取隐写图像重复100次.4.2实验结果基于KFDI的隐写聚类分析并与MMD的对照实验结果如表3所示,其中准确率较高的情况用粗体显示.从表中可以看出,在两种隐写算法中的低嵌入率部分,KFDI检测率高于MMD最高30%,而在高嵌入率部分,检测率降低不超过5%.造成该现象的主要原因是在低嵌入率情况下,隐写样本与载体样本的特征之间差异性较小,而样本中心的聚合程度差异较大.此时考虑类内方差的因素有利于提高检测能力.而在高嵌入率时,MMD聚类准确率已较高,隐写样本与载体样本的特征之间差异性较大.此时类内方差对样本间差异度量的影响较小,考虑类内方差的因素无助于提高检测率.识别率会被划分为最后一层,从而暴露其隐写行为.需要指出的是,在嵌入率较低的情况下,聚类时更倾向于判定为某个特定的相机(表4的A6).对于MMD指标,尽管隐写者是A4,最后判定为A3(图3(b)),和没有隐写者时的情况大致相同(图3(a)).而在KFDI下,其准确地判断为A4.Page7表4本文方法与文献[11]方法隐写者识别结果(100次实验)隐写者A18704009A201000000A300100000A400100000A500120880A60010099隐写者A189000011A20901009A30095005A40009604A50000928A600000100隐写者A10030097A20961003A30099001A400100000A50000955A600000100隐写者A159000041A208900011A30091009A40019405A50161884A600000100图3本文方法与文献[11]方法在有无隐写者时的层次图比较本文将各个参与者之间的KFDI作为距离,用多维标度法(MultiDimensionalScaling,MDS)[17]作图,得到图3实验对应各个参与者的大致平面分布(图4).从图中可以看出,在一定的嵌入率下,隐写者总是和普通参与者距离较大.此时,在距离足够大的时候,隐写行为可以被检测.图4本文方法与文献[11]方法在有无隐写者时的MDS图比较5结束语载体来源和隐写算法范围未知往往造成隐写分析准确率的下降,高级用户可能据此采用不公开的载体源或算法来逃避隐写分析.在该情况下,Ker经过实验提出了一种基于MMD进行隐写聚类分析的有效方法.然而,MMD只考虑类与类的中心点之间的距离却忽略了样本聚集程度因素对计算样本间差异度量的影响.为了解决该问题并进一步提高隐写分析准确率,本文提出了一种用核Fisher鉴别指标提高隐写聚类分析的方法.该方法不仅考虑了类间方差对聚类效果的主要作用,还考虑类内方差在计算样本间差异度量时的补充作用,较大地提高了相对低嵌入率情况下的检测能力,最高提高约30%,同时,在高嵌入率情况检测率降低不超过5%.
