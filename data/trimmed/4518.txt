Page1一种基于交叉熵的社区发现算法于海赵玉丽崔坤朱志良(东北大学软件学院沈阳110819)摘要作为复杂网络中的一个极其重要的研究领域,社区结构的搜寻和发现研究具有重要的应用价值.该文将信号处理领域的交叉熵概念引入到网络社区结构的发现算法中,提出了一种基于交叉熵的社区发现算法.算法利用Modularity值作为判别依据,使用交叉熵方法中的重要抽样方法提高收敛速度,从而在提高社区发现算法运算效率的同时,提高算法的精确性.针对计算机生成网络的社区划分结果表明,该算法所得MNI值和划分正确节点所占比例高于Girvan-Newman算法.在真实网络上的仿真结果表明,该社区划分算法的Modularity值高于Girvan-Newman算法,且不低于极值优化算法,进一步验证了该文提出算法的社区划分准确性优于已有的Girvan-Newman算法和极值优化算法.关键词复杂网络;社区发现;交叉熵1引言近年来,复杂网络引起了研究人员的广泛关Page2构特性,如“小世界”性和“无标度”性等[10].复杂网络的一个重要特性是社区结构,即网络可以由若干社区构成,社区内的节点连边较多,而社区之间存在的连边较少[11-13].社区内的节点有很多共同的特性,如在社会网络中,社区表示了真实的社会团体;万维网中的社区则表示了一系列相关主题的网站集合;软件系统中的社区表示了实现某一类功能的组件[14-17].因此,发现并分析这些社区能够帮助研究人员更好地理解和研究复杂网络,揭示复杂网络的内在机制,改善网络行为,具有重要的应用价值.研究人员提出了很多算法来解决社区发现问题[18-20].2004年,Girvan和Newman[21]提出了一种根据最大边介数来划分社区的方法,被称为Girvan-Newman算法,他们首次提出了一个定量描述———Modularity来评价社区结构的合理性.这种方法已经在很多真实的复杂网络中得到了应用,例如:动物社会网络、新陈代谢网络、电子邮件网络等.时间复杂度和准确性是复杂网络社区发现算法面临的主要问题.利用最优的Modularity搜索社区的计算复杂度是一个NP完全问题.为降低计算的复杂度,基于组合优化算法的社区发现方法被相继提出.2005年,Medus等人[22]提出了基于模拟退火算法的社区发现算法,Duch和Arenas[23]使用极值优化算法实现社区划分;2007年,Xu等人[24]将Mixedinteger算法应用到社区发现中,提高了社区发现的准确度.尽管这些结果从不同角度研究了社区发现问题,丰富了网络社区结构的意义,但这些算法仍然存在着不同的缺点,如Girvan-Newman算法由于算法的局部性和不可逆性,划分精度不高;而极值优化算法虽然大大提高了社区划分的Modularity值,但是在处理划分有歧义的节点时,准确率依然不高.因此,针对不同的网络结构,如何在降低计算复杂度的前提下,提高社区发现算法的准确性是社区发现研究需要解决的重要问题之一.为解决这一问题,本文提出了一种利用组合优化算法中的交叉熵(CrossEntropy)方法来划分社区的算法,实验结果表明在不增加算法复杂度的前提下,本文所提方法在准确性上优于上述算法.2基于交叉熵的社区发现算法2.1社区结构的定量描述目前,有关复杂网络中的社区结构还没有一个被广泛认可的定义.在网络社区结构研究中通常会选用Newman和Girvan在文献[21]中定义的Modularity来定量描述网络中的社区结构.Modularity是网络社区结构的一个定量描述,指网络中连接社区内部节点的边所占的比例与相同规模和社区结构的随机网络中连接社区内部节点的边所占比例相减得到的差值.文献[21]中给出了随机网络的构造方法:保持每个节点的社区性质,节点间的边根据节点的度随机连接.对于一个已经划分社区的网络G,定义一个n×n的对称矩阵犃表示网络中节点的邻接关系,当且仅当节点i和节点j存在连边时Aij=1,否则Aij=0.若网络中边的数量为m,ci为节点i所在的社区,则描述社区划分的Modularity函数Q有如下表示形式[14,25]:其中:ki表示节点i的度;kikj/2m表示随机网络中节点i和节点j之间的连边数的期望.δij是Kronecker函数,当ci=cj时值为1,否则为0.Q值的大小反映了网络社区内部连接的强弱.通常,Q值在0~1之间,Q值越接近1,社区结构越明显,一般以Q=0.3作为网络具有明显社区结构的下界.然而,Q值作为社区结构定性定义的一个度量方式,表明了社区结构的内聚性,并不能作为社区划分准确度的评价标准.目前,在评价社区划分准确度方面主要借助于诸如划分正确节点所占比例和规范化交互信息(NormalizedMutualInformation,NMI)等统计信息[26-27].2.2交叉熵和交叉熵方法1951年,Kullback和Leibler在文献[28]中首次提出了交叉熵的概念.作为一种概率分布与其近似分布接近程度的一种度量,交叉熵广泛地应用于数字信号处理领域.定义1.交叉熵.若存在基于随机变量X={X1,X2,…,Xn}的两个概率分布函数P(·)和Q(·),则分布函数Q(·)对于P(·)的交叉熵为CE(P,Q)=∑[X11999年,Rubinstein[29]在解决组合优化问题中首次引入了交叉熵方法.交叉熵方法最初用于估计复杂随机网络中稀有事件发生的概率,但是经实验发现它对于优化问题也非常适用,是一种寻找估计方差的自适应算法.Page3组合优化通常是指在有限的数学结构上,寻找一个满足给定约束条件并使其目标函数值达到最大或最小的解.对于一个如下式所示的组合优化问题:其实质为求解S(x)γ的概率估计:若χ上存在一个γ∈R的示性函数集合{I{S(x)γ},x∈χ,γ∈R},其具体表示为则估计可以通过重要抽样方法实现.设f(x,p)和f(x,q)是χ上的等价概率分布,则的估计^为这样就可以将“确定性”的优化问题转变成一个相关的“随机”优化问题,并可以使用交叉熵方法来解决.使用交叉熵方法解决优化问题可以分为两个基本步骤,首先选择一个与初始概率分布函数等价的概率分布函数生成随机样本,从中选取结果比较好的样本通过一定机制更新概率分布函数[25,28].通过不断地更新概率分布函数,最终会产生“更好”的分布函数,解决系统的优化问题.交叉熵方法是一种衡量两种概率分布相似程度的快速算法,其收敛性优于遗传算法、Pareto优化算法等优化排序算法[30].特别是采用基于交叉熵的重要抽样方法可以大幅度地减少测试样本,提高效率.因此考虑将交叉熵方法引入到社区发现中,以提高划分的准确性.2.3基于交叉熵方法的社区发现算法分析设G是一个由n个节点组成网络,用节点序列{y1,y2,…,yr}来表示G上的一个社区,设向量狔={y1,y2,…,yr},其中yi∈{1,2,…,n},且对于i=1,2,…,rn都满足y1≠y2≠…≠yr.用χ表示所有可能存在的向量狔,即χ为网络G上所有可能的狔组成的向量空间.设S为狔上的一个实值评价函数则可以在概率密度为f(·;狏)的条件下,研究S(狔)比一个给定数γ大的概率问题.那么社区划分问题可以使用交叉熵方法按照组合优化问题来求解,即将划分社区看成如下所示的优化问题:其中:S为Modularity函数;γ表示最优解,可通过产生的社区向量狔计算.为了得到网络中的一个社区,选择狓表示一个可能存在的社区划分,即狓={x1,x2,…,xr}.特别地,若节点i在第一个社区中,则xi=1,否则xi=0,即狓可以表示为一组由0、1构成的向量.这样,划分社区的问题就转变为求S(狓)在向量空间χ的最大值问题.在χ上定义示性函数{I{S(x)γ}}表示S(狓)值不小于阈值γ的解集.设{f(·;狏),狏∈V}为χ上的概率密度函数,狏表示概率密度函数的参数向量,则对于一组特定参数向量狌∈V,式(8)的相关估计为(γ)=犘狌(S(犡)γ)=∑狓其中:犡为概率密度函数f(·;狌)生成的随机样本;犘u是基于X的概率度量;犈u是期望算子.这样,当γ取接近于最优解的Modularity值时,S(犡)γ是一个小概率事件.使用MonteCarlo方法求解式(9)需要足够大的样本数量[30],因此可以利用式(6)得到参数估计:其中,g(狓)为重要抽样密度.通过优化参数狏,使得f(狓,v)与最优重要抽样密度g(狓,狏)之间交叉熵(即Kullback-Leibler距离)最小,从而得到社区的最优划分.利用Kullback-Leibler距离公式可以推导出最优参数狏的解为[30]利用迭代求解,则式(11)可采用以下表述形式[30]:其中:t表示迭代次数;j表示参数向量中第j个参数.在算法实现时为了方便选取γt的值,引入分位数ρ表示S(狓)不小于阈值γt所占的比例,那么γt的估计值^γt为这里,S1,S2,…,SN是S(犡1),S(犡2),…,S(犡N)按递增方式排序的序列,犡1,犡2,…,犡N∈χ为产生的社区样本,N是样本数量.因此{S(狓)^γt}可以表示为{S(1-ρ)N,S(1-ρ)N+1,…,SN}.由此可以得到满足式(8)的一组{x1,x2,…,xr},则{x1,x2,…,xr}表示的节点为所求的Q值最大的一组样本,即为网络G最好的一种社区划分方式.Page42.4算法实现通常,网络的社区会多于两个,因此在划分社区时使用二分迭代法.即先将整个网络划分成两个社区,再分别将每一个社区继续划分为两个更小的社区,不断迭代操作直到Modularity不再增加为止.算法的具体描述如下:(1)初始化概率密度函数参数,这里使用向量狏={x1,x2,…,xn}表示节点分布不同社区的概率.其中,xi为节点i在第1个社区中的概率,1-xi为节点i在第2个社区中的概率.定义初始化概率向量狏0={1,1/2,1/2,…,1/2},并设置迭代次数t=1;(2)使用概率向量狏生成随机样本犡1,犡2,…,犡N,采用式(1)计算样本所对应社区的Modularity值;(3)通过式(13)计算^γt,并取(1-ρ)N个重要抽样,其中(1-ρ)是分位点,即从原有的N个采样中选择使得Modularity值较大的(1-ρ)N个重要样本,通过式(12)更新概率向量狏t;(4)如果t满足则结束,否则t=t+1,返回第2步.其中d是控制最优值逼近的迭代次数,即停止位.在上述算法执行完毕后,可以得到一个近似最优的解,即找到一个Modularity近似最大的社区划分.本文提出的交叉熵算法使用二分迭代法,理论上当真实社区个数为偶数个时,划分的社区结构相对准确,但在划分个数为奇数时,存在潜在的问题.因此,本文在二分迭代法的基础上增加了调优操作,即如果某些节点明显不属于某个社区,那么将这些节点从一个社区移动到另一个社区中,如果Modularity值增加,则接受此移动操作,否则不接受,提高了社区划分的准确性,解决了社区个数为奇数时存在的问题.3实验结果与分析为了检验本文提出的基于交叉熵的社区发现算法的有效性,将此算法应用到计算机生成网络和Zachary俱乐部网络、Dolphins社会关系网络等实际网络上进行社区划分,并将实验结果同Girvan和Newman在文献[21]中提出的Girvan-Newman算法以及文献[23]中的极值优化算法进行比较.在基于交叉熵的社区发现算法中,参数ρ和d的选择会影响算法的执行效率.经过大量实验得出,ρ=0.4和d=7时算法执行效果较好.3.1计算机生成网络本节采用划分正确节点所占的比例和规范化交互信息对比不同算法找到的社区结构与标准社区结构的相似程度,进而评价社区划分的准确度.划分正确节点所占的比例和NMI越大,则社区划分结果越准确.如图1所示,实验中选择的计算机生成网络由n=128个节点构成,分为4个社区,每个社区32个节点.每个节点有平均Zin个边连接社区内的节点,有平均Zout个边连接其他社区的节点,并且满足Zin+Zout=16.本文使用上述网络生成原则创建了20个随机网络,并分别使用基于交叉熵的社区发现算法、Girvan-Newman算法和极值优化算法对这20个计算机生成网络进行社区划分,计算相应的划分正确节点所占的比例,其平均值如图1所示.图1计算机生成网络社区划分正确节点所占比例(n=128)在图1中,当Zout<5时,3种方法都可以准确地划分社区.随着社区间连边的增加,不同的算法划分正确节点所占比例开始出现差别.从图1中可以看出本文提出的交叉熵算法和极值优化算法都明显优于Girvan-Newman算法,Girvan-Newman算法在Zout=8时的划分正确节点所占比例只有约40%,而交叉熵算法和极值优化算法的划分正确节点所占比例都超过80%.在Zout=9时,极值优化算法的划分正确节点所占比例为50%,而交叉熵算法的划分正确节点所占比例为53%;在Zout=10时,极值优化算法的划分正确节点所占比例为41%,而交叉熵算法为43%.图2为n=160个节点的计算机生成网络中社区划分的划分正确节点所占的比例,其中社区数量为4,每个社区包含40个节点,Zin+Zout=20.以上述两种计算机生成网络为基础,应用式(14)Page5图2计算机生成网络社区划分正确节点所占比例(n=160)计算20个随机网络可以达到的最大规范化交互信息[26-27],进一步比较3种社区划分算法的准确度,结果如表1所示.NMI=其中犕为含混矩阵;元素Mij表示第i个真实社区与第j个划分的社区都存在的节点数量;n为网络规模;CA是真实的社区结构数量;CB是划分的社区结构数量;矩阵犕ij中第i行的和是Mi·,第j列的和是M·j.规模ZoutNMIGN1.00.970.820.551.01.00.840.46NMIEO1.01.000.950.631.01.01.001.00NMICE1.01.000.960.621.01.01.001.00从表1可知,在平均Zout较小时,社区结构明显,3种社区划分算法的NMI值均为1.0.随着Zout增大,网络结构更趋向于随机网络,社区结构不明显,NMI值较小.基于交叉熵的社区发现算法的NMI值明显高于Girvan-Newman算法的NMI值,且与基于极值优化算法的NMI值近似相同.综合分析3种社区划分算法中划分正确节点所占的比例和NMI值可知,针对计算机生成网络的社区划分,本文提出的交叉熵算法与Girvan-Newman算法相比,在准确度方面得到了明显的改善,与极值优化算法相比,也有一定的提高.3.2实际网络测试用的实际网络包括:Zachary俱乐部网络[31]、Dolphins社会关系网络[32]、LesMiserables作家关系网络[33]、爵士乐演奏家网络[34]、C.elegans新陈代谢网络[35]等,实验结果如表2所示.表2中,网络规模指的是网络的节点数,QGN、QEO和QCE分别为Girvan-Newman算法、极值优化算法和交叉熵算法分析5种实际网络的Modularity值,CGN、CEO和CCE为3种算法划分得到的社区的数量.表23种算法划分实际网络的最大Modularity值网络ZacharyDolphinsLesMiserables770.53810.55630.56001166JazzC.elegans4530.40010.43420.4418101212从表2可以看出,对于5个实际网络的Modu-larity值,交叉熵算法均大于Girvan-Newman算法,而对Zachary网络、Dolphins网络、LesMiserables网络和C.elegans网络的社区划分中,交叉熵算法也优于极值优化算法,仅在Jazz网络划分中,两种算法得到的Modularity值相同.也就是说交叉熵算法得到的社区内部的连接性强,更能够体现社区的本质.此外,通过将文献[31-35]中的真实网络结构与3种算法的划分结果相比较,可以发现交叉熵算法明显好于Girvan-Newman算法.Girvan-Newman算法得到的社区划分中有一些社区只有很少的节点,如Girvan-Newman算法用于LesMiserables网络的社区划分时会得到包含1个节点和2个节点组成的社区,这样导致算法划分结果较差,与真实的社区结构相差较多.分析Girvan-Newman算法和极值优化算法可知,两者的时间复杂度分别为O(n3)和O(nlnn).与上述两种算法相比,基于交叉熵的社区发现算法采用重要采样技术,收敛速度很快.因此,基于交叉熵的社区发现算法能够准确划分复杂网络中社区结构的同时,使得寻找社区结构的效率也有所提高.下面具体比较3种算法划分Zachary网络和Dolphins社会关系网络的划分结果.(1)Zachary俱乐部网络Zachary社会关系网包含了34个节点和78条边,是复杂网络与社区分析研究领域中经常选用的一个小型测试网络.该网络是20世纪70年代初,WayneZachary研究一所美国大学的空手道俱乐部的社会关系时建立的.网络中的节点表示一个俱乐部成员,节点间的连接表示两个成员经常一起出现Page6在俱乐部活动之外的其他场合,即在俱乐部活动之外,他们有相对密切的联系和来往.WayneZachary利用俱乐部成员的内部关系和外部关系构建了社会网络.但是,在他学习期间俱乐部管理员和老师之间因为俱乐部费用问题将俱乐部一分为二,成为了两个小的俱乐部[31].使用Girvan-Newman算法、极值优化算法和本文提出的交叉熵算法分析Zachary网络的实验结果分别如图3~图5所示.图中在相同直线分割区域内的节点属于同一社区.图3Girvan-Newman算法的Zachary网络社区划分结果图4极值优化算法的Zachary网络社区划分结果图5交叉熵算法的Zachary网络社区划分结果如图3所示,Girvan-Newman算法将Zachary网络划分为5个社区,Q值为0.4013.在真实的Zachary网络社区中,节点10与节点34、30、24等组成一个社区,节点1、2、12等组成了另外一个社区.其中,节点10与两个社区的连边一样多,Girvan-Newman算法错误地将其划分为一个单独的社区,导致Modularity值较低.极值优化算法和交叉熵算法都将网络划分为4个社区,虽然与网络真实的社区结构相比,极值优化算法和交叉熵算法得到了更多的社区,但是得到Modularity值也要更大.交叉熵算法划分该网络的Q值为0.4198(图5),略大于极值优化算法的0.4188(图4).特别的是,极值优化算法将节点10划分到了中心节点1所在的社区,而交叉熵算法则避免了这个错误,因此比极值优化算法得到了更好的社区划分和更大的Modularity值.(2)Dolphins社会关系网络Dolphins社会关系网络也是社区划分中经常选用的一个真实网络,是Lusseau等人通过对海豚之间接触频率进行7年的观察和研究构建的.Dolphins社会关系网络是由生活在新西兰DoubtfulSound峡湾的62只宽吻海豚构成,网络包含62个节点和159条边[32].其中节点代表海豚,连边代表海豚间的接触.研究发现,DoubtfulSound峡湾的海豚属于不同家族,较大的海豚家族包含42个成员,而较小的家族仅包含20只海豚.使用交叉熵算法、Girvan-Newman算法和极值优化算法分析Dolphins社会网络的实验结果分别如图6~图8所示.图中相同直线分割区域内节点属于同一社区.图6Girvan-Newman算法的Dolphins网络社区划分结果如图6~图8所示,3种算法都将Dolphins社会关系网络划分成了较小粒度的网络,社区数量都要比实际网络的多.在真实的Dolphins社会关系网络中,节点53、61与节点58、43、34、33等同属于Page7图7极值优化算法的Dolphins网络社区划分结果图8交叉熵算法的Dolphins网络社区划分结果1个社区.Girvan-Newman算法将网络划分为5个社区,Q值为0.5194,且该算法将节点53和61单独划分成了1个社区.而极值优化算法和交叉熵算法都修正了Girvan-Newman算法中划分错误的53和61两个节点,得到了更好的划分结果.极值优化算法将网络划分为4个社区,Q值为0.5264.交叉熵算法将Girvan-Newman算法和极值优化算法社区划分有歧义的5个节点3、8、36、39、59划分成1个社区,提高了Modularity值,为0.5285.4结论社区结构是复杂网络的一个极其重要的特性,在复杂网络中搜寻和发现社区结构具有重要的应用价值,在生物学、计算机科学和社会学等多个研究领域均具有重要意义.近年来,针对不同类型的大规模复杂网络,人们提出了很多发现社区结构的算法.本文提出了一种基于交叉熵的社区发现算法,算法利用对社区Modularity值的组合优化进行社区划分.该算法不仅无须事先指定社区个数等算法参数,而且由于采用重要抽样方法更新概率密度分布函数,因而具有收敛速度快的优点.通过对计算机生成网络以及Zachary俱乐部网络、Dolphins社会关系网等5个实际网络进行划分的实验结果显示,基于交叉熵的社区发现算法在社区划分准确率上明显好于Girvan-Newman算法和极值优化算法,且可以得到3个算法中最大Modularity值.此外,该算法在一定程度上可以消除社区结构及社区间具有不确定性的重叠节点现象,进一步提高了社区划分的准确率.
