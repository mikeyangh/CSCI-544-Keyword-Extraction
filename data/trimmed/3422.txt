Page1具有代理解签密功能的无证书签密方案于刚韩文报(解放军信息工程大学信息工程学院郑州450002)摘要首先,提出具有代理解签密功能的签密概念.此模型中,原始解签密者把消息分为不同的主题,按照主题把解密权力授予不同的代理人;代理人可以代替原始解签密者解密其授权主题下的密文.其次,给出安全模型并基于无证书公钥密码体制提出一个具体方案.最后,基于Weak-BDH难题证明该方案的安全性.关键词无证书公钥密码体制;签密;可证安全;代理解签密1引言2003年,Al-Riyami和Paterson[1]提出无证书公钥密码系统(CL-PKC).CL-PKC是传统公钥密码系统和基于身份密码系统的折中.在CL-PKC中,密钥生成中心(KGC)根据系统主密钥和用户的身份生成用户部分私钥,而用户选择秘密值,利用秘密值与KGC分发的部分私钥一起生成完全私钥,完全私钥作为用户密钥进行签名或者解密.CL-PKC既避免了传统公钥密码系统中PKI证书管理负担(包括证书的颁发、传输、存储、验证及撤销等),又解决了基于身份公钥密码系统的密钥托管问题———私钥生成中心PKG为每一个用户生成私钥,恶意PKG可以伪造任意用户的私钥.使消息既保密又认证地传输是信息安全研究的重要目标之一.实现这一目标的传统方法是“先签名后加密”.具体做法是先将消息签名,然后将消息及签名一起加密生成密文,其代价是签名代价与加密代价之和,因此效率较低.为了提高效率,1997年,Zheng[2]提出签密的概念.签密能够在同一个逻辑步骤内同时完成签名和加密两项功能,是实现既保密又认证消息传输的理想方法.2008年,Barbosa与Farshim[3]首次将签密思想引入到无证书公钥密码体制,提出基于无证书公钥密码体制的签密概念,并给出一个有效的方案.此后,许多无证书签密方案被Page2提出,例如文献[4-6]等.代理密码体制的概念由Mambo等人[7]在1996年提出,主要指的是签名权力授权与代理.随着信息化的迅速发展,代理业务需求越来越大,相应的许多拓展概念及方案被提出,如门限代理签名[8]、代理解密[9]、代理签密[10]、多代理多签密[11]、无证书多代理签密[12]等.本文从解签密角度出发,基于无证书公钥密码体制提出具有代理解签密功能的签密概念.不妨考虑以下场景:假设Bob是一个业务繁忙的公司经理,他需要经常出差.而每天他又需要处理一大堆经过签密的密文文件.为了把他自己从繁忙的工作中解放出来也为了避免因其不在公司而导致重要业务流失,他把消息分成几类,像E-mail的主题一样为每一类消息命名一个主题.然后,他就可以安排不同的助理代替自己处理不同主题下的业务.正是基于此类需求,本文提出具有代理解签密功能的无证书签密,原始解签密者把消息划分为不同主题,并把解签密的权力按照主题分别授权给不同代理解签密者.代理解签密者能解密其授权主题下的签密密文.此外,基于公告牌提出一个拓展方案,实现了原始解签密者通过公告牌随时终止某主题下代理解签密者解签密授权的功能.2基础知识2.1双线性对设G1为大素数q阶的加法循环群;G2为q阶的乘法循环群,双线性对是满足以下性质的映射e^:G1×G1→G2:(1)双线性性.对于任意的P,Q∈G1和所有的a,b∈Z以在多项式时间内有效计算出来.Diffie-Hellman问题(Weak-BDH问题).(2)非退化性.存在P,Q∈G1,使得e^(P,Q)≠1.(3)可计算性.对所有的P,Q∈G1,e^(P,Q)可本文方案的安全性基于CDH问题及弱双线性定义1.CDH问题.设P是G1的生成元,群G1中的CDH问题是:给定(P,aP,bP),其中a,b∈q,求解abP.Z定义2.Weak-BDH问题.设(G1,G2,q,e^)是双线性对系统,P是G1的生成元,Weak-BDH问题是:给定(P,aP,bP,cP,cw1,…,cwl),其中a,b,c,l∈q,wi∈G1,求解e^(P,P)abc.Z2.2具有代理解签密功能无证书签密的形式化定义具有代理解签密功能的无证书签密,记为PUCLSC,由以下7个算法组成:(1)系统初始化(Setup).给定安全参数1k,该算法生成系统的公开参数Params和主密钥s.记为(Params,s)←Setup(1k).(2)部分私钥生成(PartialSecretKeyGener-ate).给定身份IDU,KGC为用户生成部分私钥PSKU.记为PSKU←PSKG(IDU,s,Params).(3)公钥生成(PublicKeyGenerate).用户IDU选取秘密值xU,结合Params以及身份生成对应公钥PU.记为PU←PKG(IDU,xU,Params).(4)完全私钥生成(FullSecretKeyGenerate).IDU利用秘密值xU及部分私钥PSKU生成完全私钥FSKU.记为FSKU←FSKG(IDU,xU,PSKU,Params).(5)代理私钥生成(ProxySecretKeyGenerate).原始解签密者,Alice,要把解签密权力分别授权给l个代理解签密者P1,…,Pl,首先他把消息分成l类,并为每一类定义主题subi,i=1,2,…,l.然后,Alice利用完全私钥FSKA为主题subi生成代理私钥Ssubi,并把代理私钥Ssubi秘密发送给代理者Pi.记为Ssubi←PRSKG(subi,FSKA,Params).(6)签密(Signcrypt).发送消息m∈subi给原始解签密者IDA,发送者IDB利用IDA的公钥PA及自己的完全私钥FSKB生成密文δ.记为δ←SC(IDB,FSKB,IDA,PA,subi,m).(7)解签密(Unsigncrypt).收到密文δ,原始解签密者Alice以及该主题的代理解签密者分别利用完全私钥FSKA或代理私钥Ssubi恢复消息m∈subi,或输出“⊥”表示解签密失败.记为m←USC(IDB,PB,IDA,FSKA(Ssubi),subi,δ).2.3具有代理解签密功能的无证书签密的安全模型我们的安全模型基于Barbosa和Farshim[3]提出的无证书签密的安全模型.对于无证书公钥密码体制,存在两种类型攻击,I型攻击和II型攻击,对应着两种敌手,AI和AII.AI代表着第三方攻击,AI不能得到KGC的主密钥但是可以随意替换用户的公钥;AII代表着恶意的KGC攻击,AII知道主密钥但是不允许替换任何公钥.定义3.机密性.PUCLSC称作是适应性选择密文攻击安全(IND-PUCLSC-CCA2),如果不存在任何多项式有界的攻击者(包括AI和AII)以不可Page3其中,mβi0和mβi1(1ik)是相同长度的消息;IDS和IDR是不同身份;当x=I时,aux为空,当x=II时,aux=s.在上述游戏的阶段1和阶段2中,敌手可以向挑战者C进行以下询问:(1)部分私钥询问.敌手询问用户IDU的部分私钥PSKU,C返回对应的部分私钥PSKU.(2)公钥询问.敌手询问用户IDU的公钥,C返回对应的公钥PU.(3)完全私钥询问.敌手询问用户IDU的完全私钥FSKU,如果IDU的公钥没有被敌手替换,C返回对应的完全私钥FSKU.(4)公钥替换.敌手可以向挑战者要求把用户忽略的概率赢得下面的游戏:IND-PUCLSC-CCA2-x.(s,Params)←Setup(1k)(IDS,IDR,(mβ10,mβ11),…,(mβk0,mβk1))←AO1Phase1(Params,aux),1ikl,mβi0,mβi1∈{subi},γ←{0,1},δi←SC(IDS,FSKS,IDR,PR,subi,mβiγ),γ←AO2Phase2(δ1,…,δk),Adv(AIND-PUCLSC-CCA2-x)=|2P[γ=γ]-1|,IDU的公钥PU替换为PU.(5)代理私钥询问.敌手可以询问主题subi下的代理私钥,C返回对应的代理私钥Ssubi.这里敌手至多询问l-1个代理私钥.(6)签密询问.敌手给定发送者身份IDS、接收者身份IDR、公钥PR和消息m∈subi,C返回密文δ.(7)解签密询问.敌手给定密文δ、发送者身份IDS、公钥PS、接收者身份IDR、C返回消息m或者⊥.此外,在上述游戏中,AI需要遵守以下限制:(1)AI不能询问IDR的完全私钥以及挑战主题subi对应的代理私钥Ssubi.私钥.(2)敌手AI不能询问公钥被替换用户的完全(3)敌手AI不能同时在挑战阶段结束前替换IDR的公钥和在某一阶段询问IDR的部分私钥.(4)敌手不能对挑战密文δ1,…,δk执行解签密AII需要遵守以下限制:询问除非发送者或者接收者的公钥被替换.(1)敌手AII不能替换任何公钥.(2)敌手AII不能询问IDR的完全私钥以及挑战主题subi对应的代理私钥Ssubi.(3)敌手AII不能对挑战密文δ1,…,δk进行解签密询问.定义4.不可伪造性.PUCLSC称作是适应性选择消息攻击下存在性不可伪造(EUF-PU-CLSC-ACMA)的,如果不存在任何多项式有界的攻击者以不可忽略的概率赢得如下定义的游戏:EUF-PUCLSC-ACMA-x(s,Params)←Setup(1k),(IDS,IDR,δ,subi)←AO(Params,aux),Adv(AEUF-PUCLSC-ACMA-x)=Pr{AEUF-PUCLSC-ACMA-x成功},其中,当x=I时,aux为空,当x=II时,aux=s.如果密文IDS、IDR、δ、subi不是签密询问产生的,也没询问IDS的完全私钥,那么敌手成功当且仅当对密文解签密的结果不是⊥.同游戏IND-PUCLSC-CCA2-x,敌手可以获得C的预言服务.此外,在上述游戏中,AI需要遵守以下限制:(1)敌手AI不能询问IDS的完全私钥;敌手AI不能询问公钥被替换的用户的完全私钥.(2)敌手AI不能同时在挑战阶段结束前替换IDS的公钥和在某一阶段询问IDS的部分私钥.AII需要遵守以下限制:(1)敌手AII不能替换任何公钥.(2)敌手AII不能询问IDS的完全私钥.3PUCLSC方案本节,首先基于无证书公钥密码体制给出一个基础方案:B-PUCLSC;然后,基于公告牌提出一个拓展方案:F-PUCLSC.F-PUCLSC中原始解签密者可以通过公告牌随时终止代理解签密者的解签密授权,即使代理解签密者仍处在合法授权期内.3.1基础方案B-PUCLSC系统初始化.设G1为大素数q阶的加法循环群,生成元为P;G2为q阶的乘法循环群;e^:G1×G1→G2为双线性对;定义4个安全的Hash函数:H0:{0,1}n1→G1,H1:{0,1}n2→G1,H2:G1×G1×{0,1}n3×{0,1}n1×G1×{0,1}n1×G1→ZG2→G1×{0,1}n3×{0,1}n1,n1,n2,n3分别表示身份、主题和消息的比特长度;KGC随机选择主密钥q,计算系统公钥PPub=sP.最后,KGC秘密保s∈ZPage4存s,公开系统参数Params={G1,G2,q,e^,P,PPub,H0,H1,H2,H3}.部分私钥生成.用户将身份IDU提交给KGC,KGC计算对应的部分私钥PSKU=sQU,其中QU=H0(IDU),并将PSKU秘密发送给IDU.公钥生成.用户IDU,生成其公钥PU=(XU,YU)如下:①随机选择xU∈Z②计算XU=xUP,YU=xUPPub,并公开PU=(XU,YU).任何人可以通过等式:e^(XU,PPub)=e^(YU,P)验证其形式上的正确性.完全私钥生成.用户IDU的完全私钥为FSKU=xUPSKU=xU·s·QU.代理私钥生成.假设用户,Alice(原始解签密者),其身份IDA、公钥PA、完全私钥FSKA,要把解签密权力分别授权给l∈Zq个代理解签密者P1,…,Pl,执行以下步骤:主题subi∈{0,1}n2,i=1,2,…,l,公布subi.1.将所有消息m∈{0,1}n3划分为l类,对每一类定义2.对于主题subi∈{sub1,…,subl},Alice生成该主题下的代理解签密密钥:2.1.随机选择di∈Zq.2.2.计算Ssubi=(Ssubi1,Ssubi2)=(diwi+FSKA,diP),其中wi=H1(subi).解签密者Pi.3.Alice将Ssubi通过安全方式秘密分发给相应的代理签密.发送者Bob(身份ID_B、完全私钥FSK_B),执行以下步骤:H1(subi).1.随机选择r∈Zq,计算U=rP和W=rwi,其中wi=2.计算h=H2(U,W,m,IDA,XA,IDB,XB).3.计算V=rQB+h·FSKB.4.计算kt=H3(e^(YA,QA)r)和z=V‖m‖IDBkt.5.密文为〈subi,U,W,z〉.解签密.Alice收到密文〈subi,U,W,z〉后,1.计算会话密钥kt:1.1.原始解签密者,Alice,计算:kt=H3(e^(U,FSKA)).H3e^(Ssubi2,W()).1.2.代理解签密者,Pi,计算:wi=H1(subi),kt=e^(Ssubi1,U)2.恢复明文消息V‖m‖IDB=zkt.3.验证Bob对消息的签名.e^(V,P)=e^(U+hYB,QB),其中h=H2(U,W,m,IDA,XA,IDB,XB).注.如果Bob希望该消息由Alice本人恢复消息,可以设置W=0.基础方案中,如果发送者正常签密,原始解签密者不能终止代理解签密者在合法授权下恢复消息.3.2拓展方案F-PUCLSC系统初始化.除Hash函数H2略微改变,变为H2:G31×{0,1}n3×{0,1}n1×G1×{0,1}n1×G1→q外,其它参数同基础方案一样.Z部分私钥生成、公钥生成、完全私钥生成,同基础方案.代理私钥生成.1.代理私钥生成:1.1.将消息m∈{0,1}n3划分为l类,对每一类定义主题subi∈{0,1}n2,i=1,2,…,l,公布subi.1.2.对于主题subi∈{sub1,…,subl},Alice如下生成代理解签密密钥Ssubi:1.2.1.随机选择b0,b1,di∈Zq,其中b0+b1=1modq.1.2.2.计算Ssubi=(Ssubi1,Ssubi2)=(diwi+b0-FSKA,diP),其中wi=H1(subi)∈G1.1.3.Alice将Ssubi通过安全方式秘密分发给代理解签2.公告牌参数更新:2.1.对某一时段τj∈{τ1,τ2,…},τj∈{0,1}n1,选择密者Pi.dτji∈Zq.iΓj,dτjdτj2.2.计算P(τji)=(x(τji),y(τji))=(b1·FSKA+iP),其中Γj=H0(τj).2.3.Bob在公告牌上为其代理解签密者更新P(τji).签密.发送者Bob(身份ID_B、完全私钥FSK_B),执行以下步骤:中wi=H1(subi)、Γj=H0(τj).1.随机选择r∈Zq,计算U=rP、W=rwi和T=rΓj,其2.计算h=H2(U,W,T,m,IDA,XA,IDB,XB).3.计算V=rQB+h·FSKB.4.计算kt=H3(e^(YA,QA)r)和z=V‖m‖IDBkt.5.密文为〈subi,U,W,T,z〉.解签密.Alice收到密文〈subi,U,W,T,z〉后,1.计算会话密钥kt:1.1.原始解签密者Alice计算kt=H3(e^(U,FSKA)).1.2.代理解签密者,Pi,计算:wi=H1(subi),kt=e^(Ssubi1+x(τji),U)e^(Ssubi2,W)e^(y(τji),T2.恢复明文消息V‖m‖IDB=zkt.3.验证Bob对消息的签名:e^(V,P)=e^(U+hYB,QB),注.如果发送者希望该消息由原始解签密者本人恢复消息,可以设置W=0和T=0.拓展方案中,其中h=H2(U,W,T,m,IDA,XA,IDB,XB).(H3Page5如果主题subi下的代理解签密者被腐化,原始解签密者把原来的b0,b1,di,dτji∈Zq,其中bi≠bi,i=0,1,di≠di,dτji≠dτji,b0+b1=Z1modq.然后在公告牌上更新P(τji),并把新的代理解密私钥秘密发送给新的代理者.4安全分析本节对基础方案,B-PUCLSC的安全性做简单分析,拓展方案安全分析类似.假设敌手最多进行qi次Hi询问(i=0,1,2,3),qs次签密询问、qu次解签密询问.机密性.在Weak-BDH难题假设下,B-PU-CLSC方案是适应性选择密文攻击安全的.B-PUCLSC的机密性可以由以下两个引理得到.引理1.假设存在I类敌手AIND-PUCLSC-CCA2-I能够以优势Adv(AIND-PUCLSC-CCA2-I)赢得游戏IND-PU-CLSC-CCA2-I,则存在挑战者C以优势ε解决Weak-BDH问题,其中:ε1-qsq3()q·1-qs·(q2+q3+2qs)证明见附录1.引理2.假设存在II类敌手AIND-PUCLSC-CCA2-II能够以优势Adv(AIND-PUCLSC-CCA2-II)赢得游戏IND-PUCLSC-CCA2-II,则存在挑战者C以优势ε解决Weak-BDH问题,其中:证明见附录2.不可伪造性.在CDH难题假设下,B-PUCLSC方案在适应性选择消息攻击下抗存在性伪造.B-PUCLSC方案中的签名本质上是Hess提出的基于身份签名[13]在无证书环境下的变体.具体签名及验证算法如下:个安全的Hash函数.首先H2:G1×{0,1}n3×{0,1}n1×G1→Z签名.签名者Bob,其身份为IDB,公钥为PB=(XB,YB),完全私钥为FSKB=xB·s·QB,给定消息m后,执行以下步骤生成签名σ=(U,V):随机选择r∈ZV=rQB+h·FSKB,消息m的签名为σ=(U,V).验证.任何人可以计算h=H2(U,m,IDB,上述签名在适应性选择消息攻击下抗存在性伪仅当等式成立时签名σ=(U,V)有效.造性,证明见附录3.考虑到B-PUCLSC方案中恶意的代理解签密者也存在伪造签名的可能,附录3证明中额外地考虑了敌手对代理私钥的询问,模拟了恶意的代理解签密者伪造签名的攻击方式,从而B-PUCLSC方案抗存在性伪造.5结论本文首先提出一个新的密码模型———具有代理解签密功能的签密,并给出其安全模型.然后基于无证书密码体制提出一个基础方案,又通过公告牌给出一个拓展方案,实现代理授权的任意终止.最后,基于Weak-BDH和CDH难题分析了方案的安全性.
