Page1具有时效机制的增量式无线定位方法刘军发1),2)谷洋1),2)陈益强1),2)曹姝3)1)(中国科学院计算技术研究所北京100190)2)(移动计算与新型终端北京市重点实验室北京100190)3)(北京邮电大学北京100876)摘要基于WLAN(WirelessLocalAreaNetworks)的无线定位是移动互联网领域的重要研究内容之一.其中,指纹定位方法已成为主流,此类方法的特点之一在于需要离线训练数据与在线测试数据具有严格的一致性.但在实际环境中,无线信号数据波动较大,存在显著的时效性问题.这导致一定时间后,定位模型的预测精度不断下降.文中提出一种具有时效机制的增量式定位方法(TimelinessManagingExtremeLearningMachine,TMELM),一方面满足实际系统的应用需求,可随时加入新的训练数据进行在线增量式学习,另一方面融入时效机制,以最大化新增训练数据对定位模型的贡献,保持定位模型的精度.实验表明,在实际WLAN定位数据集上,文中方法相比于传统的几种增量式学习方法,具有明显的时效优势,能获得更好的定位精度.关键词时效机制;增量学习;无线定位;极速学习机;移动互联网1引言服务(LocationBasedServices,LBS)是移动互联网领域的重要研究内容.其中,基于WLAN的室内定位技术已成为研究热点,而最近几年,基于指纹定位移动终端的定位(Localization)与基于位置的方法的研究成为主流[1-2].一般来说,基于指纹模型Page2的定位方法包括离线训练阶段与在线预测阶段,如图1所示.离线训练阶段的任务就是采用训练机器M,挖掘无线信号向量犡与物理位置Y之间的映射关系Y=f(犡),并提交到在线预测阶段进行应用,从而基于在线采集的无线信号向量犡估计出设备当前所在位置Y.此类方法模型的预测精度在很大程度上取决于离线的训练数据与在线测试数据是否满足同一模型分布.但在实际环境中,室内的WiFi无线信号具有明显的高动态特性.时间、温湿度、室内建筑物格局以及人群的流动等因素,都会导致同一地点接收到的AP(AccessPoint)信号强度会发生显著的变化,从而使得训练出的预测模型的适用性大为降低.图2显示了在实际环境中采集的WiFi信号强度值变化情况.增量式学习框架为此问题提供了一种解决途径,其原理在于能够将最新训练样本实时融入到训练模型中去,用以实现对环境变迁的适应.但是,传统的增量式学习模型存在未考虑训练样本时效性的问题.传统增量式学习模型往往对新增数据与之前的训练样本数据采取相同的权值对待,没有对新增数据的贡献加以特殊考虑.本文提出了一种基于ELM(ExtremeLearningMachine)的具有时效机制的增量式训练方法,对新样本加以一定权重———使得时间越久的数据,其贡献越小,反之使得最新数据贡献最大,以此来实现定位模型的时效性问题.2相关工作近年,基于WiFi信号强度的定位方法逐渐成为了移动终端的定位研究热点,国内外在此领域出现大量研究工作.基于WiFi信号强度的研究工作可以分为两个方面:基于信号传播模型和基于指纹模型.基于传播模型的方法利用无线信号在空气中传播时所呈现出的非线性衰减特性,建立信号强度与距离的模型,从而获得位置信息.代表的工作有射线追踪法确定信号传播模型[3]等.该类方法的复杂度和功耗较低,但是由于复杂多变的室内环境对信号的传播造成较大的损耗,以及信号传播过程中的多径效应,使得定位结果的精度不高.而基于指纹模型的定位方法主要是基于大量实际观测数据,采用各种统计分析工具进行定位模型训练,然后用获得的定位模型对目标点进行位置估计.如前所述,一般分为两个阶段:第1阶段为离线训练阶段,采集所需定位区域各参考节点(ReferencePoint,RP)的信号特征参数,将一组无线指纹信息对应一个特定的位置,由此形成位置指纹数据库;第2阶段为在线定位阶段,采集测试地点的信号参数,采用模式匹配算法与指纹数据库中的数据相匹配,优化估计用户的实际位置.近期代表工作有马里兰大学研发的HORUS定位系统[4].它在信号空间的建立中引入了概率模型,即在预先选定的参考点上,形成每个AP的信号强度值在该点上的直方分布图,然后采用联合分簇法和增量三角测量法两种分类方法进行定位.Sjoberg等人[5]采用支持向量机作为学习工具,并融合计算机视觉技术对位置进行预测,获得了较好的定位效果.Wu等人[6]首次在定位领域提出了信道状态信息(ChannelStateInformation,CSI)作为新的指纹参数,相比于信号强度参数,CSI不仅提供了更多维数的信息,而且定位结果表现也更为稳定.Sen等人[7]使用细粒度的CSI可以实现WiFi信号Page3波长级别高精度定位,而且功耗也较之传统的定位方法有所降低.相比于传播模型而言,指纹模型的方法可以得到较高的定位精度.另一方面,现有的定位工作对由于物理设施的改变、信源的动态变化、时间和设备的差异等因素引起的信号的高动态变化问题进行了研究.Fang等人[8]使用主成分分析(PrincipalComponentAnalysis,PCA)的方法,将环境中获取的多维无线信号信息提取出最主要的成分,以克服环境变化带来的信号不确定性波动的影响,最终相比于传统的定位方法来说,平均定位误差可以降低33.75%.Yin等人[9]通过参考点的回归模型,建立动态RadioMap,弥补了离线和在线阶段的信号差异,提高了定位的精确度.Pan等人[10]对经典的流形联合正则化(ManifoldCo-Regularization)进行扩展,实现了多任务学习定位框架;再配合参考点提供在线标定数据,最终达到动态调整RadioMap,以适应不同时间段的目的.Zheng等人[11]把静态的RadioMap适用于不同的时间段看做一个迁移学习的问题,并提出了基于迁移的隐马尔科夫模型算法来动态调整RadioMap.Sun等人[12]利用源数据和部分标定目标数据通过流形对齐(ManifoldAlignment)的方法,同时处理时间和设备的差异并保证了有效的定位精度.Tsui等人[13]在传统的离线训练和在线定位阶段之间增加了一个在线的调整阶段,来解决设备间的信号差异问题.Piao等人[14]基于流形正则化框架重构信号场分布,解决由于损耗、断电等原因引起的信源动态变化导致定位精度下降的问题.上述学习预测模型融入了对信号在时间上的波动因素,但还未对环境中无线信号发生结构性的变异情况给予考虑.增量式学习方法采用最新到达的数据对预测模型进行更新,能更好体现预测模型的结构性调整.梁等人[15]将增量式学习模型的方法应用到小样本草图检索问题中,在每次反馈循环中对新加入的样本进行分类器的增量学习,取得多方面积极效果,在减少分类器训练时间的同时积累样本信息,进一步缓解小样本问题,且提高了检索性能.Ren等人[16]则将增量式学习模型方法进行人脸识别研究.系统不需要完全准备好足够的人脸数据库,对于新增训练数据造成的数据库改变,使用增量学习的方法进行在线学习,获得比以前更好的识别模型.Pan等人[17]则在无线定位问题中采用了增量式学习框架,并且能够实时接收已标定或未标定的新增无线数据,对定位预测模型进行在线更新,较之已有方法,能减少标定工作量,且获得更好的定位准确率.本文也提出一种增量式学习定位模型.相比已有工作,本方法对新增训练样本加以时效机制设计,以最大化新增样本对定位模型的贡献,使得预测模型及时调整以适应环境的变化,从而更好地提高定位模型的准确性和鲁棒性.3具有时效机制的增量定位方法为了达到增量式训练、实时更新定位模型的效果,本文引入极速学习机ELM(ExtremeLearningMachine),其特点在于能够较传统机器学习方法更快地进行训练学习.正因如此,本文鉴于ELM的快速训练特点,提出一种具有时效机制的极速增量学习算法TMELM(TimelinessManagingExtremeLearningMachine),并应用于实际定位问题.本节先对ELM模型进行简介,然后介绍TMELM.3.1极速学习机ELMELM由Huang等人[18]提出,是近年出现的一种高效率的机器学习方法,具有训练时间快、网络结构简洁等特点.ELM可看作一种前向单隐层学习网络SLFN(SinglehiddenLayerFeedforwardNeuralNetwork),对于一个输入无线特征向量狓∈有L个隐层节点的单隐层的前馈神经网络(如图3所示),其输出可以表示为式(1).fL(狓)=∑L这里犪i=ai1,ai2,…,a[i个隐层节点的权值,bi表示第i个隐层节点的偏置参数,G(犪i,bi,狓)是第i个隐层节点的输出,βi=[βi1,βi2,…,βim]T表示连接第i个隐层节点与输出节点的权值.Page4节点的输出可以如下求得若隐层节点的激励函数为g(狓),则第i个隐层G(犪i,bi,狓)=g(犪i·狓+bi),犪i∈则对于输入的N个训练样本数据集{(狓j,tj)|j=1,2,…,N},狓j=[xj1,xj2,…,xjn]T,有G(犪i,bi,狓j)=g(犪i·狓j+bi),犪i∈表达为犎=β=则根据式(1)可得到犎β=犜.文献[18]中已经讨论,隐层节点的参数犪i和bi在训练过程中并不需调整,只需在初始阶段随意赋值即可.因此犎与犜已知,犎为犎的广义逆矩阵,β为待求解参数.则其解为上述方程可以看作一个线性系统,对SLFN的训练可以通过对该线性系统进行最小均方误差求解来实现.而文献[18]已证明式(4)是该线性系统唯一的最小均方误差解.3.2增量式ELM学习模型为了获得增量式实时学习效果,对于新增加的训练数据犡,可以将其加入已有训练数据集组成一个新的训练集,重复图1中的训练过程获得定位模型,也可以将其贡献Δβ直接体现在对已有训练模型参数β0进行修正,从而获得新的模型参数β,如式(5)所示.显然,后者涉及的计算要基于前一步骤的计算结果,相比之下,其计算量要减少很多.文献[19]提出一种在线增量式学习方法OS-ELM,给出了上式的一种方案模型.基于ELM学习模型,根据式(4),现假设已有学习系统β(0)=犓-10犎T0犜0,其中,犓0=犎T数据集为{(狓i,ti)}N0+N1犎[]1犓1=犎0从而,获得新的模型参数为β(1)=犓-11上式表达出来的含义恰好与式(5)所示思路一致,β(1)的计算是基于β(0)来进行,而不需要将所有原始训练数据重新纳入计算,从而大大减轻了计算量.同时,式中犓-11犎T样本信息(犎1,犜1)对训练模型的修正.3.3具有时效机制的增量式学习模型TMELM式(7)虽然对新增样本的贡献进行了分解表征,很大程度上减少了计算量,能够解决定位模型的实时训练问题,但未能对新增数据的时效性给予考虑.另一方面,在实际定位环境中,由于环境的动态变化和迁移需求,新增数据具有明显的时效性,其所属的分布模型与已有的训练数据存在差异,因此应对各时段产生的数据予以时效性考虑.即需要建立一种时效机制,使得越久远的数据贡献越少甚至直接丢弃,越新的数据贡献越大,这种实时更新的机制,能更好地体现环境的动态变化,使得当前采集的数据对定位模型具有更高的贡献.在式(7)中,(犜1-犎1β(0))项的含义可理解为采用旧的模型参数β(0),将犎1β(0)预测为新增数据犜1的输出值时产生的误差,因此,可对该项进行权重惩罚,使得:该项误差越大,旧的模型参数β(0)被修正得越多,以达到前述时效机制的目标.因此,对式(7)改写为如下形式:惩罚权重ω加强了新增数据对预测模型的影响程度,相应地减小了历史数据对预测模型的贡献率,此即时效性的直接体现.ω的取值可通过实验获得,且其值在增量式学习过程中保持不变.本文实验中发现,对于上式进行一次性的权重修正,还不足以使得系统稳定.为了达到学习系统的稳定目的,这里模型参数的最终解β()采取牛顿迭代法直至收敛的方式获得,即对下式进行迭代计算,直至|β(k+1)-β(k)|<ε(ε为一给定的极小阈值):β(k+1)=β(k)+ω·犓-11犎T综上,对具有时效机制的增量式极速学习算法TMELM可如图4所示,总结如下.算法TMELM流程:1.从实际环境中采集获得N个无线训练样本数据{(xi,ti)|i=1,2,…,N},确定系统参数,如隐层神经结点个数L、惩罚权重ω以及激活函数形式g(狓)(如选择为RBF);2.随机确定输入权重向量犪i和偏移量bi的值,i=1,2,…,N;3.计算隐层输出矩阵犎0;4.计算初始模型参数β0=犎Page55.新增一批样本数据{犡1,犜1},根据式(8)计算犎1以及6.计算β(k+1)=β(k)+ω·犓-17.若|β(k+1)-β(k)|<ε,则停止;否则β(k+1)=β(k),k=β1,同时赋值k=0;k+1,跳转至步6;8.输出β=β(k+1).从步5开始为增量式训练过程,若有新增WiFi数据到来,则重复步5~8可完成每一次新增数据的模型训练计算.算法TMELM的上述步骤完成了定位模型的训练和更新.在定位应用时,则如图1中的在线预测阶段所示,即输入环境中的WiFi特征,系统则输出定位结果.4定位实验与性能分析定位数据的采集实验在某单位大厦内进行.数据采集的终端设备为三部HTC智能手机(G3,G10,G14各一部),操作系统为Android.整个数据采集过程时间跨度为三个月,采取不定时采集的做法,每次采样记录数为Ni,前后两次采集的时间间隔在1h以上.参加数据采集的人员来自两片工作区,其中一块覆盖范围为12m×9m,另一块覆盖范围为99m×38m.将整个区域划分为大小0.5m×0.5m的方格,总共在432个方格上采集的总量为311040条样本序列.实验中,将每次采样的样本的60%作为新增数据进行增量式训练,另外40%的记录作为测试数据.本实验采集大厦环境中已经存在的无线WiFiAP,总共采集到AP23个,最后选择其中信号最为稳定的7个AP,将其信号强度作为输入特征向量.采集到的样本数据如表1所示.x1,y1,t1-69-52-49-56-58-68-65x2,y2,t3-70-55-48-49-58-68-58x3,y3,t3-61-61-43-60-60-76-72x4,y4,t4-65-59-50-57-61-56-72x5,y5,t5-60-56-37-56-62-68-63x6,y6,t6-52-54-30-58-66-46-67……………………实验使用4种算法进行了性能比较:即本文时效机制增量方法TMELM(迭代求解β)、一次权重增量方法WOSELM(不迭代求解,仅使用一次权重)、原始在线增量方法OSELM[19]以及常用的GGAP-RBF方法[20].神经网络节点选取sigmoid函数g(狓)=1/1+e-()x作为激励函数.系统运行软件环境为Matlab8.0,WindowsXP,硬件环境为PentiumIV,3.2GHz,2GMB内存的PC机.(1)采用两种评价方法进行了比较实验.①采用均方差MSE(MeanSquareError)为度假设对于某实际观测位置,其真实坐标为Yt,对应的无线信号输入为犡,根据犡回归获得的预测位置为Y0,则MSE定义为量标准比较4种方法的位置预测性能.结果如图5所示.可以看出,随着时间推移,本文方法较其它3种预测方法具有明显优势,对预测模型具有更好的更新机制,对环境的适应性更强.预测性能.②采用定位准确率标准比较4种方法的位置首先定义误差距离ED0,如图6所示,对于实际位置Yt,若预测点与其之间的距离小于ED0,则该次预测为准确定位.即,若|Yt-Y02|ED0,则Y02Page6是准确定位.反之,若|Yt-Y01|>ED0,则Y01是错误的预测.对前述4种方法在不同误差距离下的定位准确率进行了统计,结果如图7所示.对比情况显示,本文的方法在不同的误差距离时,均具有更好的定位准确率,尤其在要求误差距离较小时具有更好的定位性能.图74种方法在不同误差距离时的定位准确率(2)TMELM定位算法的收敛性.算法的迭代步骤是否能够收敛决定了算法的可用性.本文基于定位训练数据,定位模型的参数β获得了较好的收敛性.图8是在惩罚权重ω=2.2时的收敛过程,纵轴是迭代计算前后两次的模型参数差,即|β(k+1)-β(k)|.一般经过30次左右迭代计算,算法即可收敛.(3)惩罚权重ω相关实验.本文算法中惩罚权重ω取经验值,需要由基于实际定位数据的训练与测试实验来确定.具体计算过程如下:选定惩罚权重ω的一定区域,如[1,10],对于区域中的每一取值ω0,都能够进行一次模型增量训练与测试,从而获得相应的测试MSE值,这样则可获得如图9所示的惩罚权重实验图,选择MSE极小时对应的ω0值作为惩罚权重经验值.5结束语本文针对实际无线环境中训练数据存在的时效性问题,提出了一种具有时效机制的增量式无线定位方法,充分考虑了新增训练样本的时效性,使得越新产生的训练样本对定位模型的贡献越大.实验表明了本文算法正常收敛,且该方法比传统的增量式Page7学习方法能更好地体现训练数据的时效性,提高了实时定位的准确率.下一步工作将侧重实际系统应用中的另一问题,即无标定数据的增量式学习问题.由于在实际环境中获取有标定的训练数据具有较高的人力成本与时间成本,因此我们将研究如何在增量式学习过程中,能够通过融入非标定样本来提高模型的定位精度.此外,我们也将对算法中的惩罚权重对不同场景的适应性问题进行深入研究,使得本文所述方法可扩展应用于更多领域.
