Page1一种新的容忍恶意节点攻击的无线传感器网络安全定位方法叶苗王宇平(西安电子科技大学计算机学院西安710071)摘要无线传感器节点位置定位正确与否对整个网络传感器起着至关重要的作用.当无线传感器网络暴露在恶意危险环境中时,攻击者会攻击节点定位的过程,使其定位到错误位置,从而导致整个网络应用完全失效.基于最大似然估计的传感器定位概率模型是一种常用的定位模型,但是它有两个缺点:(1)为了降低计算复杂性,通常将RSS(接收信号强度)信号标准差看成常数,影响定位精度;(2)安全性差,在有恶意节点攻击时模型常常会定位失效.文中首先通过拟合测试数据归纳出了RSS信号标准差随距离变化的函数关系,克服了第一个缺点.针对第二个问题,在分析其受攻击时定位失败的具体原因后,对节点定位的概率计算公式进行了改进,设计了一种新的基于变方差特征的传感器节点定位概率模型.该模型属于高度非线性全局优化问题.针对其难以求解的特点,文中设计了一个新的有效的进化算法,并证明了该算法的全局收敛性.最后通过对公开数据集的测试和实际实验,验证了该模型和求解算法能在保证定位精度的前提下,完成节点的安全定位.关键词无线传感器网络;变方差;过滤;投票法;进化算法;物联网1引言无线传感器网络是由大量成本低廉、存储能量有限、分布广泛的传感器节点组成的网络,这些节点之间能在短距离内进行无线通信.它在医疗健康监视、危险环境数据采集和军队战场操作等领域中都有广泛应用[1].节点定位技术是无线传感器网络应用(如地理路径路由协议GPSR和GEAR、环境检测、目标跟踪等)的基础,一个没有位置信息的节点,在传感器网络中不会起到任何作用[1-2].目前,已经设计出很多位置发现协议(也称为定位技术)[3].这些定位技术通常会使用一些已知自身位置信息的节点(信标节点,也称为锚点)进行定位,步骤如下:首先,待定位的普通节点(非信标节点)接收到从信标节点发送过来的无线信号数据包,这些数据包中携带着对应信标节点的位置信息;然后,从接收到的信号数据包中包含的信息(比如接收信号强度RSS[3-4]、到达时间差[5-6]、数据包记录的路径跳数等[7])中计算出发送节点和接收节点之间的距离,再依据这些测量来估计普通节点的位置.常用的估计算法有三边测量法[8]、三角测量法[9]、最大似然估计法(概率可能性最大)[10]、质心法等.其中,依据接收信号强度(RSS)与位置距离之间的概率分布关系,利用最大似然估计法(概率可能性最大)来估计普通节点位置的方法是一种常用的定位方法[10].但这些定位方法通常都忽略了存在恶意节点攻击的情况,在恶意节点攻击环境中会发生定位错误[1,11-12].比如,攻击者在不同位置通过拦截并伪造信标节点数据包,提供虚假位置信息,或者通过捕获控制信标节点,更改信标节点信号值等行为,将导致普通节点的定位错误,从而颠覆无线传感器网络正常的应用.虽然可以通过加密和认证等传统安全技术(比如给每个数据包加密,待定位的普通节点只接收通过加密认证的信标节点数据包)提高节点安全定位的准确性,但这样传统的认证机制在无线广播环境中很难保证足够的安全,攻击者很容易采用复制、阻塞和改变传播路径等手段破坏这些传统的安全技术,导致定位失败.而且有些定位方法是由于本身设计缺陷、缺乏辅助安全机制导致安全问题的,概率因子连乘形式的最大似然估计法就属于这样的例子.因此必须设计一些辅助的安全机制为节点定位提供安全保障.传感器网络中基于最大似然估计[10]的节点定位概率模型是一种常用的定位模型,但是它有两个缺点:(1)为了降低计算复杂性,通常将RSS信号标准差看成常数,不能反映实际情况,影响定位精度;(2)在有恶意攻击节点时,模型常常定位失效.为了克服这些缺点,本文首先针对基于最大似然估计的传感器定位概率模型,通过拟合RSS信号标准差随距离的变化规律,给出了它们的函数关系,克服了该标准差取常数值带来的缺陷,从而对原模型进行了改进.其次,针对改进模型没有考虑恶意节点攻击时会出现定位失效的问题,采用投票法的思想,对模型中的关键技术:定位节点的概率计算公式进行了重新设计,解决了原模型在有恶意节点攻击时出现定位失效的问题,实现安全定位.然后,针对设计的模型为高度非线性的全局优化问题而难以求解的特点,设计了一个新的有效的进化算法,并利用随机论[13-14]证明了设计算法的全局收敛性.最后通过对公开数据集[15]①的模拟和实际实验,验证了本文模型和求解算法能在保证定位精度的前提下,完成节点的安全定位.只要大多数的信标节点为正常节点,该定位模型和求解算法就可以很好抵御共谋攻击,过滤掉恶意节点的定位参考信息,能解决传统概率似然定位方法在攻击环境下彻底失效的问题.按照文献[11]的分类方法,节点定位安全措施按照设计目标分可以分为三类:预防[16]、检测[17]②和过滤[18-19].本文提出的安全方法属于一种过滤算法,除了能解决传统最大似然估计定位方法在攻击环境下①②Page3定位彻底失效的问题之外,相比投票过滤算法[18]能避免投票法网格大小和网格数目影响求解时间性能的缺陷,相比求最大一致信标集的恶意节点过滤算法(如Attack-ResistantMinimumMeanSquare-Estimate,AR-MMSE)[19]能避免其由于组合数爆炸而不得不使用贪婪算法获得近似解的缺陷.2传感器网络中基于变方差特征的最大似然估计定位模型无线信号是一种电磁波信号,考虑各向同性球面波的RSS(接收信号强度,单位:dB)信号,其在传播过程中会被传播介质吸收部分能量,强度会随距离成指数衰减,衰减规律可以表示为式(1)其中RSS(d)表示接收端信号强度值(单位是dB),d表示发射点到测量点的距离,d0表示参考距离,PL0是在参考距离为d0处的接收信号强度值(单位是dB)(通常取d0=1),η表示路径损失因子,即衰减因子.由于干扰噪声的存在,测量的RSS值往往有偏差,由此式(1)可修改成(取d0=1)其中NσN~N(0,σ2准差为σN的高斯分布的随机变量,则在实际距离为d的条件下信号值为RSS的条件概率分布就可表示为其中,r1=RSS-PL0+10ηlog10(d).在实际测量表示中,式(2)通常表示为RSS(珟d)=PL0-10ηlog10珟d,其中,RSS(珟d)表示由测量得到的RSS值,珟d表示测量得到的距离,从而有用P(d)表示距离为d的先验概率,珟d表示通过式(4)计算得到的测量距离,P(d|珟d)表示在测量距离为珟d条件下实际距离为d的概率,由式(3)和式(4)可得P(d|珟d)=P(珟d|d)P(d)/P(珟d)=P(RSS|d)·dg由于随机事件的概率分布要求随机事件发生的初始条件必须相同,在不同地点对RSS进行测量,场景不一样,概率事件发生的初始条件也不一样,因此式(3)和(5)中的σN通常不是常量.在很多文献,如文献[20-21]中,将σN作为常数处理,仅仅是为了减少计算复杂度、方便求解而对模型进行的简化,但这往往影响模型的精度.一些文献讨论了σN不为常数的情形,如文献[15]取σN的上界作为σN的估值,这相当于还是将其看成常数;文献[22]直接给出了σN随距离d的变化关系,但没给出理由,建模依据不足;文献[23]通过实验证实了σN不为常数的结论,但只是利用此结论给出了一个选择信标节点的原则(依此原则设计了一种模糊贴近度的间接定位方法),没有讨论如何将σN的变化规律直接用在定位方法的设计上.采用类似文献[23]的实验方法,本文在感知RF2-210传感器网络实验教学平台上,利用实验方法拟合出两个传感器节点之间RSS信号标准差与距离之间的函数关系,从而给出了σN变化规律的定量描述.感知RF2-210是国内公司开发的一种无线传感器网络实验教学平台,传感器节点采用ZigBee协议.在室内办公室环境中保持15dB发射功率,每改变一次两个节点之间的距离,采集1000次RSS信号值,求出标准差.图1统计出了RSS信号标准差与距离的变化关系,所得结果和文献[23]的测量结果类似.其实图1中标准差σN与距离间的变化规律其实是有共性的,在越靠近信标节点的地方,受到的噪声影响越小,标准差σN也越小;随着距离增加,噪声影响增加,σN也变大;再随着距离的增加,RSS信号会减弱,在有限噪声影响下,σN也跟着减小.结合图1所示实验结果及以上分析,RSS信号的标准差与距离的变化关系接近高斯函数,可以用高斯函数σN(d)=ae-中参数a,b,d0的值可以从训练测试数据中进行曲Page4线拟合得到(本文的实验部分给出了拟合方法).因此,式(5)可以表示为P(d|珘d)=P(珘d|d)P(d)/P(珘d)=P(RSS|d)·dg=1σN(d)2槡πe其中d=(x-xi)2+(y-yi)点坐标(xi,yi)的距离为d的先验概率,σN(d)=(d-d0)2b2为标准差拟合函数.对P(d)的计算,采用ae-类似文献[24]中的做法,P(d)=m(d)似表示为m(d)≈2π·d,dR尺寸,假设节点通信范围大于R,这样做的依据是让P(d)表示落在半径为d的环形区域占整个区域的比例.假设总共有n个信标节点参与定位,第i个信标节点发送过来的定位参考信息用三元组〈xi,yi,珟di〉表示,其中(xi,yi)是表示第i个信标节点的位置坐标,珟di表示待定位节点与第i个信标节点的测量距离.由于有n个信标节点参与定位,相当于n个随机事件独立发生,利用与文献[10,24]类似的思想,依据概率论中的乘法法则和贝叶斯法则,在待定位节点到各信标节点的测量距离为珟di的条件下实际距离为di的条件概率(i=1,…,n)最大,即满足(x,y)=argmaxx,yPM(x,y)=∏n=∏n=∏nP(珟di|di)P(di)/P(珟di)i=1σN(di)2槡πei=1其中,di=(x-xi)2+(y-yi)(x,y)距离第i个信标节点的距离为di,σN(di)=(di-d0)2ae-b2表示距离第i个信标节点di长度的地方接收到这个信标节点RSS信号的标准差,P(di)∝2π·di表示处于距离第i个信标节点长度为di位置的先验概率.其余的量中,n表示信标节点个数,珟di的先验概率,η是路径损失因子(即衰减因子),这些量都是与变量(x,y)无关的常数.为方便引用,记式(6)为模型(6).模型(6)表示要定位到的位置点能使得在测量得到与各个信标节点距离为(珟d1,珟d2,…,珟dn)条件下该点的条件概率取最大值.3传感器网络中基于变方差特征的安全定位概率模型和求解算法3.1安全定位概率模型假设攻击者可以改变三元组〈xi,yi,珟di〉中的任何值,可以恶意地声称一个错误的位置〈xi,yi〉,也可以恶意地调整信号值改变测量距离珟di.发起的攻击可以是单个恶意节点的攻击,也可以是多个恶意节点彼此独立的非共谋攻击,还可以是多个恶意信标节点协同合作的共谋攻击.在没有攻击的安全情况下,上节概率连乘的最大似然估计定位模型(6)是有效的.相当于每个信标节点都为定位提供一个条件概率值,总概率为这些条件概率的乘积.n个概率事件相互独立发生,依据概率论中的乘法定理,要求概率连乘值最大.但一旦有恶意攻击存在,概率连乘的模型(6)注定会失败.原因很简单,安全环境下会使每个条件概率PMk(x,y)在正确位置定位点都取一个大概率值;而在恶意节点攻击环境下,由于恶意信标节点(比如信标节点k)的存在,所提供的定位三元组〈xk,yk,珟dk〉参考信息有误,则在某个定位位置点,当定位概率值PMk(x,y)取值为大概率值时,其余正常信标节点提供的定位概率值PMi(x,y)在该点上取值几乎为0;或者在正确定位位置点,正常信标节点提供的定位概率值PMi(x,y)取值为大概率值时,恶性信标节点k提供的定位概率值PMk(x,y)在该位置点上取值几乎为0.无论哪种情况,由于有几乎为0的连乘因子存在,模型(6)中最后相乘起来得到的结果也就几乎总为0,定位也就失效了.为此,文献[18]提出可以先识别并过滤掉这样的恶性信标节点再进行定位,并设计了求最大一致信标集的恶意节点过滤算法AR-MMSE(Attack-ResistantMinimumMeanSquare-Estimate),但由于要准确求出最大一致信标集需要列举所有节点的组合情况而产生组合数爆炸,不得不使用了贪婪算法,并且这样只能获得近似解,不仅如此,还将定位过程机械地分成了滤除恶意节点和安全定位两个阶Page5段,增加了时耗.本文认为,只要将定位模型(6)中的概率值连乘PM(x,y)=∏n的形式PM(x,y)=∑n供几乎为0的定位概率值PMk(x,y)不是作为乘法因子项出现,而是作为加法加数项出现,从而免除了对最终目标函数值的影响,完成安全定位,不但避免了由于组合数爆炸求近似解的缺点,而且滤除恶意节点和安全定位可以同时完成,减少耗时.将式(6)中概率值连乘PM(x,y)=∏n改成连加形式PM(x,y)=∑n还有一个依据,就是基于网格划分法求解的投票法的思路.投票法是文献[18-19]提出的一种典型的恶意节点过滤方法.图2是文献[18]中投票法示意图,将定位平面区域划分成网格,每个信标节点i和测量距离珟di对应一个圆环,对每个圆环经过的网格投票计数加1,得票最多的网格中心为定位位置点.这样即使存在恶意节点的攻击,只要大多数信标节点为正常节点,正确定位的网格得到的投票最多,实现安全定位.文献[25]证明了当恶意节点的个数大于等于(n-2)/2时,若不采取特殊措施,则没有算法可以绝对保证安全的定位到指定精度.投票法实质上是对空间网格进行加法投票计数,以此达到过滤恶意节点的目的,思路是连加计数.因此,将模型(6)中的概率值连乘PM(x,y)=∏n成连加的形式PM(x,y)=∑n综合以上分析,在模型(6)中去掉与坐标变量(x,y)无关的常数项珟d,P(珟d)和ln10恶意节点完成安全定位的新模型为(x,y)=argmaxx,yPM(x,y)=∑n其中σN(di)=ae-槡(x-xi)2+(y-yi)标变量(x,y).为方便引用,记式(7)为模型(7).3.2求解算法接下来的问题是如何求解模型式(7)的最优解.这是一个非线性全局最优化问题,由于变方差项的存在,目标函数是一个关于变量x,y高度非线性复杂的函数表达式,x,y的偏导数项非常复杂,用数学中传统的基于导数的优化方法,如最速下降法、牛顿法、拟牛顿法、共轭梯度法等求解.用网格划分法来求解,其精度要受网格划分大小的影响,文献[18-19]设计了一种循环迭代求精改进方法,在找到投票最多的单元格后,再以该单元格作为目标区域,进入下一轮投票,反复迭代直到满足定位精度要求,但这类方法计算量太大,且计算量明显与定位区域大小有关,区域越大网格数量也越多,耗时也越多.网格法还有其它的变种形式,如模糊贴近度[26]等,也都有类似的缺点.因此必须设计一种求解算法,既能避免传统优化方法的缺陷,又能避开网格法中的缺陷.进化算法作为一种随机搜索的自然仿生算法,求解时不需要函数导数信息,目标函数表达式复杂性对求解的影响相对较低,在传感器网络上的应用越来越受到重视[27-28].文献[29-31]在无线传感器定位问题中使用了智能优化算法,但仅仅是对目标函数为最小误差平方和∑j∈H(i)的限制还需要加上修正步骤,这是比较麻烦的.目前对目标函数为概率形式使用智能优化算法的文献还很少,关于变方差形式的讨论更少.针对模型(7)中目标函数关于变量x,y高度非线性、难于求解的问题,结合无线传感器通信特征,本文运用智能优化中的进化计算理论设计了模型(7)的求解算法,具体算法如下.求解算法1.第1步.种群初始化:在定位平面上随机产生μ个点作为初始解P(0)=Page6{P1(0),P2(0),…,Pμ(0)},其中Pj(0)=(xj(0),yj(0))T表示平面上的第j个点坐标.对任意的初始个体Pj(0),j=1,…,μ,对每个信标节点Aq,q=1,…,n,分别在连线Pj(0)Aq方向上运用传统数学方法求出单自变量函数的函数最大值点(由于dq=(x-xq)2+(y-yq)PMq(x,y)中的两个自变量x,y都在dq中,因此可以将函数PMq(x,y)看作是dq的单自变量函数),令k=1,记找到PMq(x,y)最大值的点为Lqj(k),比如在图3中的个体P1(1)对应信标点A1而言找到的最大值点为L11(1).分析:这里没有使用PM(x,y)=∑n标函数对变量x,y求导,而是使用单个的PMi(x,y)对di求导,可以避开对函数PM(x,y)的复杂处理,这样简单而有效的方法很多,比如梯度法、插值法.对个体Pj(0)和函数PMq(x,y)而言,同一信标节点Aq,函数值PMq(x,y)只与到圆心Aq的距离有关,对不同的个体Pj(0)对应的最优点Lqj(k)(其中k=1)一定分布在以Aq为圆心的某个圆上,如图3所示.若总共有n个信标节点,则会对应有n个圆,每个圆上分布了μ个局部搜索的点Lqj(1),j=1,…,μ,初始化的结果是在每个圆上都初始化分布了一个规模为μ的子群体.第2步(第1阶段进化).对各个圆心为Aq的圆上的子群体,令k=1,使用PM(x,y)=∑n数,做第1阶段的交叉、变异和选择:半角交叉.在子群体中任意取两个点Lqj1(k),Lqj2(k),用平分圆心角θ=∠Lqj1(k)AqLqj2(k)的方式产生两个子代Lqo1c(k),Lqo2c(k),如图4所示.如果用xqo1(k)和yqo1(k)表示子代Lqo1c(k)的坐标,则具体计算表达式为xqo1(k)=xAq(k)+Lqj2(k)Aq·cos(θqj2+θ/2),yqo1(k)=yAq(k)+Lqj2(k)Aq·sin(θqj2+θ/2),其中xAq(k)和yAq(k)表示点Aq的坐标,Lqj2(k)Aq表示连线Lqj2(k)Aq的长度,θqj2为连线Lqj2(k)Aq的水平夹角,θ表示圆心角∠Lqj1(k)AqLqj2(k),由于3个点Lqj1(k),Aq,Lqj2(k)的坐标都已知,因此θqj2和θ可以分别通过反正切函数和反余弦函数求出.类似方法可以得到另一个子代Lqo2c(k)的坐标xqo2(k),yqo2(k)的表达式.均匀变异.设定变异概率为Pm,对经过以上交叉后任一子代个体Lqojc(k)点,绕圆心Aq随机转动一个角度θrnd得到变异后的子代个体Lqojm(k)点,其中θrnd表示[0,2π)之间的一个均匀分布的随机数.选择.在所有原子群体个体、经过交叉后所有个体和经过变异后所有个体组成的集合{Lqj(k)|j=1,…,μ}∪{Lqojc(k)|j=1,…,μ}∪{Lqojm(k)|j=1,…,μ}中,以PM(x,y)=∑nPMi(x,y)作为适应度函数,令k=k+1,选择最好的μ个个体作为下一代子群体{Lqj(k)|j=1,…,μ},若k达到事先给定的进化代数G1,则进入第3步;否则转入第2步开始的半角交叉继续进化.分析:这一步中的进化实际上是在n个不同的子群体中独立进行的进化,每个限制于各个圆上的子群体进化方式(交叉、变异、选择)都相同,使用的适应度函数形式也相同,进化结果是各子群体的优良个体分布在n个圆交叉区域附近.i=1第3步(第2阶段进化).以PM(x,y)=∑n作为适应度函数,在第2步进化得到n个子群体的所有个体中(总共有n·μ个)选择最好的μ个个体作为初始群体,记为Pj(t),j=1,…,μ,令t=0,做第2阶段的交叉、变异和选择:随机凸组合交叉.在当前群体中随机选取3个个体Pi1(t),Pi2(t),Pi3(t),计算Pi(t)=∑3其中θij为元素在0和1之间的随机数,并且满足凸组合的约束条件1=∑3区域可以是一个凸区域.两重高斯变异.设定变异概率为Pm,对上面的个体Pi(t)做变换得到Qi(t)=Pi(t)+ΔP,其中ΔP~N(0,σ2(N(0,σ2样的变异方式相当于对个体Pi(t)的两个位置分量Pi(t)=k1),N(0,σ2Page7(xi(t),yi(t))做高斯变异后得到新个体Qi(t),这样的变异方式符合传感器RSS信道噪声服从高斯分布的特点.扰动项中的方差σ2k1,σ2k2为事先设定的一个常数.选择.以PM(x,y)=∑n分析:第3步开始进化前的群体是从第2步进化结束后从{Pj(t)|j=1,…,μ}∪{Qj(t)|j=1,…,μ}中选μ个最好的位置点个体作为下一代群体P(t+1).进化到一定代数G2后算法停止,输出最优个体P(x,y)=(x,y)作为定位结果;否则转入第3步中的交叉算子步骤继续进化.得到的n·μ个个体中,以PM(x,y)=∑n应度函数,选择最好的μ个个体组成的.由于恶意信标节点对应的圆是和正常信标节点对应的圆的重叠区域是分离的(如图3所示),这样可以去除恶意信标节点对应的子群体个体的影响,此后进行的随机凸组合交叉和两重高斯变异的进化就是在正常信标节点圆上的个体中进行的,这一步不但能完成精细求解,还屏蔽掉了恶意节点信息,保证了定位的安全性.和其它一些先求最大一致信标集来过滤恶意节点再进行定位的安全定位算法(如Attack-ResistantMinimumMeanSquare-Estimate,AR-MMSE[18-19])相比,这一步可以让算法在安全定位过程中过滤掉恶意节点信息.4算法收敛性证明和时间复杂度分析4.1算法收敛性求解算法1是一种随机搜索算法,主要由两个进化阶段组成.如果能证明两个阶段收敛,那么由收敛的充分条件可知求解算法1是收敛的.为此先明确数学中随机序列以概率收敛于最优解的确切定义,再证明求解算法1在数学上以概率收敛于最优解.为了数学上表述方便,先给出如下的记号X={x∈S|f(x)=maxf(x),x∈S},表示全局最优解对应的解;对ε>0,Mε={x∈S|f(x)-f(x)ε,x∈X},用m(Mε)表示该ε领域集合Mε的测度,对欧式平面测度空间来讲,m(Mε)表示集合Mε的测度.定义1.用x∈Ω(Ω表示搜索可行域)表示目标函数f(x)的最优解,若有Prob{limt→x∈P(t)}=1成立,则称该进化算法以概率1收敛于全局最优解;若有x∈P(t),ε>0,Prob{limt→x∈Mε}=1成立,则称该进化算法以概率1在ε-精度上收敛于全局最优解.显然,如果ε→0,两种以概率1收敛的定义是一致的.定义2.对进化群体中的两个个体a和b,如果个体a经过交叉、变异后进化成子代个体b的概率满足Prob{MC(a)=b}>0,则称个体b可由个体a可达;若Prob{MC(a)=b∈Mε}>0,则称个体b可由个体a在ε-精度可达.显然,如果ε→0,两种可达的定义是一致的.Bck[13]和Rudolph[14]已经证明了若设计的进化算法满足以下假设,则该进化算法以概率1(或ε-精度)收敛于全局最优解,且与初始群体分布无关.假设1.可行域空间中的任意两个个体a和b,个体b可由个体a(ε-精度)可达.假设2.对于群体序列P(0),P(1),…,P(k),…单调,即对k,满足max{f(x)|x∈P(k+1)}max{f(x)|x∈P(k)}.基于以上定义和结论,对上一节提出的进化求解算法有以下结论成立.定理1.对求解算法1第2步中处于可行域为圆Aq上的群体,按照算法中的半角交叉、平均变异和选择策略进行进化,以概率1收敛于可行域圆Aq上的全局最优解,而且与初始群体分布无关.证明.算法第2步中适应度函数为PM(x,y)=∑nPMi(x,y),可行域Ω为以Aq为圆心的圆,由于i=1适应度函数在可行域上连续,可确定上下界、最优解集不为空集.任意两个个体a,b,如果用c表示从父代a通过半角交叉得到的任一子代个体,发生变异的概率为pm>0,则个体a到达个体b的概率可以表示为Prob{MC(a)=b}=pm·Prob{M(c)=b},若Prob{M(c)=b}>0成立,则说明个体a,b是可达的.而可行域Ω为以Aq为圆心的圆,记为Cq,由于采用的是[0,2π)均匀变异,c∈Cq变异到另一个体b的概率为Prob{M(c)=b}=1/2π>0,所以假设1成立.又由于采用保留μ个最好个体作为下一代群体的选择策略,每次进化的当前代最好个体肯定比上代要好,满足单调要求,因此假设2也成立.从而定理得证.定理2.对求解算法1第3步中按照算法中的随机凸组合交叉、高斯变异和选择策略进化的群体,以概率1在ε-精度收敛于全局最优解.证明.适应度函数为PM(x,y)=∑nPage8可行域Ω为传感器有限传输区域,由于适应度函数在可行域上连续,可确定上下界、最优解集不为空集.先证明假设1成立.对任意的两个个体a,b,用c表示从父代a通过随机凸组合交叉得到的任一子代个体,再以一定变异概率变异到b.记个体c的坐标分量为x1,x2,变异成个体b的分量为x1,x2,由于采用的是分量相互独立的高斯变异,xi=xi+ηi,i=1,2.其中ηi~N(0,σ2x-x,所以ηi的密度函数为p(yi)=1/2槡πσ()t·exp(-y2i/(2σ2exp(-(y21+y22)/(2σ2Mε}=∫Mεy22)/(2σ2有界知yiθ为常数,上式有Prob{M(c)=b∈Mε}∫Mε=1/(2槡πσt)2·exp(-(θ2)/(σ2因此假设1满足.又由于采用保留μ个最好个体作为下一代群体的选择策略,每次进化的当前代最好个体肯定比上代要好,满足单调要求,假设2也成立.从而定理得证.定理3.求解算法1以概率1在ε-精度收敛于全局最优解,ε为任一小的数.证明.PMEA进化算法由3个阶段组成.第1阶段随机生成群体后,由于使用确定的局部搜索算法,可以保证以概率1收敛于第一阶段的最优解;由定理1知第2阶段以概率1收敛于该阶段可行域上的最优解,由定理2知第3阶段以概率1在ε-精度收敛于整个定位区域的全局最优解,依据收敛的充分条件性质可判断算法以概率1在ε-精度收敛于整个定位区域的全局最优解.4.2时间复杂度分析对于进化算法的收敛速率分析,目前还没有通用的数学分析方法[32],多数还是通过实验进行分析,这里仅仅对算法时间性能做简单分析与比较,直接的实验及分析在后面进行.算法分3个步骤,第1步初始化所花时间与信标节点个数n、种群规模大小μ成正比,时间复杂度为O(μ·n);对第2步子群体的进化,假设一次半角交叉、一次均匀变异和一次选择操作的时间为T1,则第2步所花时间为O(n·G1·T1),其中G1为该阶段的最大进化代数;对第3步群体的进化,假设一次随机凸组合交叉、一次高斯变异和一次选择操作的时间为T2,则第3步所花时间为O(G2·T2),G2为该阶段的最大进化代数.整个算法时间复杂度就为O(μ·n)+O(n·G1·T1)+O(G2·T2).严格讲,这样简单的分析是不够严谨的,比如关于T1,T2的假设.在目前对进化算法没有通用的数学分析方法[32]情况下,只能通过下节的实验进行验证.再来对比分析模型(7)及设计的求解进化算法与基于网格划分的投票法[18]、基于最小均方差的最大一致信标集(Attack-ResistantMinimumMeanSquare-Estimate,AR-MMSE)过滤算法[19]的时间性能.对于基于网格划分的投票法运行时间依赖于网格数目的多少,在固定网格尺寸(即定位精度)时,场地尺寸越大,网格数目也越多,运行时间也越长;对于文献[19]中基于最小均方差的最大一致信标集过滤算法,为避免组合数爆炸使用贪婪算法求解最大一致信标集,运行时间与恶意节点数量有关,文献[19]给出分析并给出其时间复杂度为1+nm()+1+…+()n从前面关于模型(7)及求解进化算法的简单分析已经可以看出本文的安全定位方法与场地区域大小无关,与恶意攻击节点的数目也无关(当然要正确定位,必须保证正常信标节点个数占多数).这是相比投票法和最大一致信标集过滤算法好的方面.5实验及分析本节对安全定位模型(7)和求解算法1在定位准确性、定位时间性能和安全性方面做了测试实验,包括在公开数据集上的仿真实验和在实验平台上的实际实验,以保证实验结果的真实性和正确性,方便检验.5.1实验数据集和安全环境下定位精度测试先确定仿真实验方式.和很多用MatLab软件进行定位仿真的文献不同,本文的变方差概率特征模型更加接近实际信道模型,再用MatLab软件仿真不具备说服力,较为合理的是对实际的RSS数据集进行仿真测试.为此采用了文献[15,33]中提供的公开数据集.该数据集由佛罗里达摩托罗拉通信实验室发布,传感器由摩托罗拉公司提供.实验环境为室内办公室(如图5),任何一个节点都在所有其余节点的通信范围内.该数据集总共采集了44个传感器相互之Page9间的TOA和RSS两种测试数据,本文只需要RSS数据.为对比定位效果,本文采用和文献[15,33]中一样的实验方式,选择3、10、35、44号节点作为信标节点对其余节点进行定位.由普通节点与这4个信标节点的RSS信号值计算得到该普通节点到这4个信标点的估计距离,再利用这些估计距离对其余40个普通节点定位.设对第i个普通节点定位得到的最优位置为(xi,yi),计算其与真实位置(xi,yi)之间的偏离距离erri=(xi-xi)2+(yi-yi)个节点的绝对估计误差,总共有40个普通节点,将平均误差err=1/40·∑i指标.文献[15,33]中用克美罗-雷界估计RSS平均定位误差为2.18m.很多文献给出的实际定位测量误差结果都在2m以上.本文用C程序实现了安全定位模型(7)和求解算法1,经过多次测试得到合适的群体规模参数值为μ=30,变异参数ΔP~N(0,σ2(N(0,σ2进化代数为G1=100,G2=100,传感器参数取公开数据集文献[15,33]提供的值,通信半径R=80,路径损失因子η=2.3.图5数据集文献[15,19,33]中的室内节点分布确定公开数据集和仿真实验方式后,下面先在公开数据集上检验RSS信号标准差随距离高斯函数变化的概率特征是否成立,安全定位模型(7)和求解算法1是否可以提高定位精度,以证实多数文献中假定标准差σN(d)为常数时结果不够理想的判断.图6是取标准差σN(d)=C为常数(C分别取值为0.5,0.9,1.0,1.5,2.5,4.0,6.0)时,用求解算法1对公开数据集[15,33]进行定位仿真的平均误差err随不同常数C变化的折线图.可以看出常数C取0.9时,达到2.67m最小平均误差(仍然比文献[15,33]的2.18m大).再考虑RSS标准差σN(d)不为常数的情况.对公开数据集中的RSS信号值标准差σN(d)=(d-d0)2b2参数a,b,d0可以通过以下实验步骤找到ae-合适取值.先固定某个d0值,然后给a,b取不同值,运行算法程序,观察实验结果.比如固定d0=8.0,a从0.8开始取值(a其实表示标准差σN(d)=(d-d0)2b2的最大值),引入b满足b=d0/sqrt(ln(a/ae-b)),不同的b对应了不同的b值,b表示是σN(d)=ae-离d为零的标准差,当然实际中d=0是不存在的,所以只是理论值),引入b是由于b比b更加直观.让b从0.1开始取值.再固定某个b值,变化a,d0,观察实验结果,然后再固定d0,变化a,b,重复这样的步骤.通过多次的实验,查找平均误差最小时参数a,b,d0分别的取值.最后得到在参数a,b,d0分别取值0.9,0.3,8.0时平均误差最小,为1.86m.这不但比方差为常数的最小平均误差2.67m小,而且比文献[15,33]用克美罗-雷界得到的2.18m结果还要好,达到了2m以下的平均误差.说明多数文献中假定标准差σN(d)为常数确实是不够理想的.再在公开数据集上[15,33]进行仿真实验以比较安全定位模型(7)和最大似然估计的概率连乘定位模型(6)的定位精度.采用算法1求解模型(6),进行同样实验步骤,结果显示还是在参数a,b,d0取值为0.9,0.3,8.0时,概率连乘定位模型(6)达到最小的估计误差1.87m.说明安全定位模型(7)与最大似然估计的概率连乘定位模型(6)相比,(7)并没有影响(6)的定位精度.以上仿真结果说明RSS信号标准差随距离高斯函数变化的概率特征是成立的,概率连加的安全定位模型(7)确实可以达到很好的定位精度.以下再通过实际实验测试安全定位模型(7)和求解算法1的定位精度.为此,在感知RF2-V210传感器网络实验教学平台上实现了模型(7)和Page10求解算法1.以第2节图1中采集的实验数据为例,通过如下步骤确定标准差σN(d)=ae-a,b,d0的取值.对第2节中采集到的实验数据(图1中数据采集方式为:在室内办公室环境下保持15dB节点发射功率,每改变一次两个节点之间的距离,采集1000次RSS信号值并统计出标准差)的标准差取自然对数后进行基于最小二乘法的二次函数曲线拟合,得到的拟合曲线及拟合公式系数如图7所示.曲线拟合效果可以用样本决定系数r2表示,该值介于0和1之间,r2越大,说明曲线和样本数据拟合程度越好.图7中r2值为0.9486,很接近1,说明拟合程度是不错的.由于以上拟合是对标准差的对数值进行的,对拟合公式中的系数进行指数变换就可以得到标准差公式σN(di)=ae-3个参数的取值,分别为1.05,4.75,6.30.然后再代入模型(7)在室内环境中进行定位精度的测试实验,测试方案设计如下:在大小为5m×11m室内办公室处于同一高度的4个角上放置4个信标节点,在办公室中心位置放置一个待定位的普通节点,采集接收到的4个信标节点发送过来的RSS值,在普通节点上嵌入模型(7)和求解算法1的C语言代码.群体规模参数μ取30,为保证进化到足够精度,G1与G2都取100,信标节点个数n=4,多次运行结果显示中心位置节点的定位位置仅仅偏离实际位置0.63m.说明在没有攻击时定位模型(7)和求解算法的定位精度是不错的.以上进行的数据采集、参数训练和定位测试都是在室内常温环境下进行.图8表示在室内环境下重复以上三次数据训练得到的拟合曲线,三次拟合的结果都非常接近,三次拟合的样本决定系数r2分别为0.9486、0.9432和0.9477,都很接近1.说明在相同环境下反应标准差特性的a,b,d03个参数值是可以保持稳定的.标准差随距离的变化可以用σN(di)=图7标准差自然对数值对节点距离的二次拟合曲线图8室内环境下标准差自然对数值随距离曲线拟合(di-d0)2b2表示,但a,b,d0这3个参数值是和环境相ae-关的①.在不同环境下,即使是对同一类型号的传感器器件,在不同传播介质中的路径损耗不同,器件内部的热噪声干扰程度不同以及室内室外等环境下的反射等干扰程度不同,因此在不同环境(比如室内和室外、潮湿和干燥、高温和低温等)下a,b,d03个参数值也会不同.合理的做法是在某种环境下的具体定位应用前,先在相同环境中进行数据采集和训练数据的曲线拟合,得到反应标准差变化特性的a,b,d03个参数的训练值,再在该环境下进行定位应用,以保证拟合结果的准确性和稳定性.虽然麻烦了些,但从理论分析、仿真实验和实际测试的效果来看比方差为常数时的定位精度有了明显提高,在实际应用中也是可行的.5.2安全环境下时间性能测试先在公开数据集[15,33]上测试不同最大进化代数G1,G2取值对算法时间性能的影响.算法1的第2步是一个加速收敛的子群体进化阶段,第3步相当于在所有子群体中选择最好的一部分个体再进行进化,这两个步骤的进化程度是通过最大进化代数G1,G2来控制的.不同的最大进化代数G1,G2取值会对算法性能有直接的影响.对公开数据集[15,33],选择3、10、35、44号节点作为信标节点(即参考节点,总共4个,n=4),单独测试1号节点定位的时间性能.群体大小参数、变异参数和方差拟合参数a,b,d0取值同前面实验.每次进化找到群体中函数适应度值最好的个体位置点,①叶苗,王宇平.基于变方差概率模型和进化计算的传感器Page11计算该点偏离38号节点的误差.图9表示第2步的4个子群体所有个体中的最好个体位置点对应的最小偏离误差与进化代数的变化关系,可以看出开始阶段进化效果比较明显,从第40代左右开始,进化比较缓慢.图10表示第2步进化最大代数G1取不同的值时(分别测试了G1为0,10,40,80,100的情况),第3步进化群体的最好个体位置点对应的最小偏离误差与进化代数的变化关系.最大进化代数G1=0,表示算法1直接跳过第2步进入第3步,从图10中可以看出收敛速度比较慢,差不多到第90代才稳定;G1=10时发生类似的情况;而取G1=40,80或100时,进化收敛速度明显加快,几乎在进化到第30代时就稳定了,特别是G1=100时,在进化到第20代时最小误差为1.33m,此后稳定在这个值.这说明适当G1取值可以加速第3步的收敛速度.假设第2步和第3步各自交叉、变异和选择所用时间复杂度相同,则可以用G1+G2作为时间复杂度的标准,从实验中可以看出G1=40,G2=50比较合适.图9最小平均误差与第2步进化代数的关系图图10最小平均误差与第3步进化代数的关系图再通过在实际平台上的程序运行时间来直接测试时间性能.同5.1节实验,针对定位模型(7),在感知RF2-V210传感器网络实验教学平台上嵌入并运行求解算法1和网格划分法(不进行迭代),参数同5.1节实验中的取值,使用API时间函数统计出定位代码运行所花时间,得到图11结果.可以看到网格划分比较粗时,网格划分法(不进行迭代)运行定位时间比求解算法1所花时间少,随着网格划分越来越细,网格边长越来越小,网格划分法花费时间也越多,已经明显超过了求解算法1.最后测试恶性信标节点攻击情况下安全定位概5.3攻击环境下定位精度测试率模型(7)的准确性和安全性.先在公开数据集[15,33]上建立如下3个测试实验场景.第1个实验场景是模拟单个恶意信标节点提供偏离实际位置e长度的错误位置(直接改变数据集中三元组〈xi,yi,珟di〉中的估计距离珟di,可以达到同样的效果).具体设置为:选择3、10、35、44号节点作为信标节点,38号节点为待定位的普通节点,任取一个信标节点(如指定10号节点)为恶意节点,在指向普通节点38号节点方向上偏离自身实际位置e长度.第2个实验场景是模拟存在多个非共谋的恶意信标节点,每个恶意信标节点分别独立地声明一个偏离实际位置e长度的位置信息.具体设置为:选择3、10、11、31、35、36和44号作为信标节点,38号节点作为普通节点,11、31和36号节点作为非共谋的恶意信标节点,分别在指向普通节点38号节点方向上偏离自身实际位置e长度.第3个实验场景是存在多个共谋节点,提供一致的虚假定位信息,但是共谋节点个数不多于正常节点个数.在这种情况中,恶意信标节点彼此协调好各自偏离距离e从而定位到一个错误位置.具体设置为:选择3、10、11、31、35、36和44号作为信标节点,38号节点作为普通节点,11、31和36号节点作为共谋的恶意信标节点,每个恶意节点分别在垂直向上的方向上声明偏离自身实际位置e长度的位置,这样如果用11、31和36号信标节点定位就可以产生可以偏离定位位置e长度大小的合谋攻击.显然,攻击力度随着偏离距离e的增加而增大,偏离距离e的大小可以代表攻击力度.图12统计出以上3种场景中定位绝对误差随着恶意节点偏离实际位置e长度变化的情Page12况.从图12中看出在3种场景中,在e比较小的一个范围内,定位误差随着偏离距离e增加而增大,在1至2m时受攻击的定位精度略微差于安全环境下的定位精度,这是由于在偏离距离e比较小时,恶意信标节点和正常信标节点的区别并不明显,很难分辨出是恶意节点还是正常节点;随后不管攻击力度e如何加大,定位误差几乎不变,有时还略微好于安全环境下的定位精度(注意:纵轴是对数坐标),说明定位模型(7)和求解算法1确实能过滤掉恶意节点的影响完成安全定位.文献[34]可以解释恶意攻击环境下定位误差还略微好于安全环境下的定位精度的现象.文献[34]证明了当距离测量误差较大时增加信标节点的数量反而会降低定位精度的结论.从图12可以分析出,在安全环境下,3、10、35号这3个信标节点的定位精度略好于安全环境下3、10、11、31、35、36和44号这6个信标节点的定位精度,这正好符合文献[34]的结论.文献[23]还给出了在多个信标节点中选择参与定位的原则.这都说明过多的信标节点参与定位会带来过多的冗余信息,反而会影响定位精度.因此在图12出现了恶意攻击环境下定位误差略微好于安全环境下的定位精度的现象.但值得注意的是如果定位冗余信息太少,在恶意攻击环境下的定位安全性又会显得很脆弱,因此一般要有折中.从图12中还可以看出模型(6)不具备任何抵抗攻击的能力,在只有单个恶意节点攻击存在时就失去了应有的定位精度.本文在感知RF2-V210传感器网络实验教学平台上也建立了类似以上的实际场景,并进行了相应实验,得到的结果和图12类似,限于论文篇幅,不再列举.综合以上分析,本文提出的定位模型(7)和求解算法在恶意攻击环境下确实能过滤掉恶意节点的攻击信息,完成安全定位.6结论针对最大似然估计的定位法和提高安全的投票法,本文先建立更加符合实际情况的基于接收信号强度变方差特征的概率模型,在分析传统最大似然估计的定位方法的安全性缺陷后,采用投票法的思路,设计了变方差特征的传感器网络恶意节点过滤安全定位概率模型,考虑到模型目标函数中高度非线性不好求解的问题,运用进化计算理论设计出符合传感器通信特征的求解算法.只要是大多数的信标节点为正常节点,该定位模型和求解算法可以很好抵御共谋攻击,过滤掉恶意节点的定位参考信息.最后不仅在数学上证明了算法的收敛性,还在公开数据集的模拟和实际测试中验证了基于变方差特征的安全定位概率模型和求解算法能在保证定位精度的前提下过滤恶意节点信息,能避免投票法网格大小和网格数目影响求解时间性能的缺陷.相比投票过滤算法能避免投票法网格大小和网格数目影响求解时间性能的缺陷,相比求最大一致信标集的恶意节点过滤算法(如Attack-ResistantMinimumMeanSquare-Estimate,AR-MMSE)能避免由于组合数爆炸而不得不使用贪婪算法获得近似解的缺陷.致谢在此,我们向对本文的工作给予支持和建议的同行,尤其是西安电子科技大学计算机学院王宇平教授领导的网络优化讨论班上的老师和同学表示感谢!
