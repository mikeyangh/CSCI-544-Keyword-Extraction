Page1僵尸网络中的关键问题王天佐1),2)王怀民2)刘波1)史佩昌2)1)(国防科学技术大学计算机学院网络与信息安全研究所长沙410073)2)(国防科学技术大学计算机学院并行与分布处理国家重点实验室长沙410073)摘要僵尸网络是一种复杂、灵活、高效的网络攻击平台,在互联网中分布非常广泛.僵尸网络使攻击者具备了实施大规模恶意活动的能力,如发送垃圾邮件、发动分布式拒绝服务攻击等.由于其危害日益严重,僵尸网络已经成为网络安全研究的热点之一.但是近年来,僵尸网络新的发展、变化,突破了以往对僵尸网络的认知.文中分析僵尸网络的现有研究,对僵尸网络进行了重新定义,并从网络结构、网络独立性和信息传递方式等角度对僵尸网络的类型进行了划分;然后,梳理了僵尸网络检测技术、测量技术和反制技术等方面的工作;最后,给出了僵尸网络的演化趋势和未来研究方向.关键词志愿僵尸网络;自部署僵尸网络;测量技术;检测技术;反制技术;僵尸网络演化趋势1引言僵尸网络通常指攻击者通过一对多的命令与控制信道,控制大量主机所组成的恶意网络.这种恶意网络在互联网中的渗透范围非常广.赛门铁克公司的数据表明①,2010年仅Rustock[1]僵尸网络的结点规模就超过了100万.中国国家互联网应急中心年度报告②也指出,2011年中国境内约有890万个IP地址感染了木马和僵尸病毒,较2010年同比增长78.5%.凭借大量网络资源,僵尸网络在攻击者的控制下,对网络安全构成巨大威胁,主要体现为发送垃圾邮件[2-3]、窃取用户隐私[4-5]、进行点击欺诈[6]、发动分布式拒绝服务攻击(DistributedDenialofService,DDoS)[7]、为恶意网站提供Fast-Flux保护[8]等.例如,2010年全球47.5%的垃圾邮件来自Rustock,其日发送量约为441亿封①,这些垃圾邮件被用于投送海量广告、传播恶意代码和散播不实股市消息.另据分析③,到2011年初点击欺诈也成为了Rustock的主要功能.通过DDoS攻击BGP(BorderGatewayProtocol)路由器来瘫痪互联网[9],更凸显了僵尸网络的巨大破坏力.目前僵尸网络已经得到网络安全学术界的持续重点关注.德国蜜网项目组的Holz等人[7,10-11]将蜜网技术用于僵尸网络检测,做出了突出贡献;美国乔治理工学院的Gu等人设计了BotHunter[12]等多个僵尸网络检测系统;美国约翰霍普金斯大学的Ra-jab等人[13]在僵尸网络规模测量方面研究较早,提出了一种根据DNS(DomainNameSystem)缓存记录进行测量的方法;德国曼海姆大学的Holz、加拿大麦吉尔大学的Davis等人[14-15]分别研究了P2P僵尸网络反制方法;美国加州大学圣芭芭拉分校的Stone-Gross等人[16]的工作证明了劫持僵尸网络的可行性.2008年以来,CCS(ACMConferenceonComputerandCommunicationsSecurity)、SIG-COMM(ACMannualconferenceoftheSpecialIn-terestGrouponDataCommunication)、USENIXSecurity、NDSS(ISOCNetwork&DistributedSys-temSecurityConference)等网络安全重要学术会议都对僵尸网络给予高度重视,而由WORM(ACMWorkshoponRecurring/RapidMalcode)和Hot-Bots(USENIXWorkshoponHotTopicsinUnder-standingBotnets)合并而来的LEET(USENIXWorkshoponLarger-scaleExploitsandEmergentThreats)会议更将僵尸网络作为重点关注方向.最近几年僵尸网络的发展出现了很多不同以往的新情况.在网络形态上,随着智能手机的迅速普及,不仅僵尸程序的载体由相对固定的主机扩展到了移动平台[17-18],控制信道的构建方式也由基于In-ternet延伸到了基于短信[19-20]、蓝牙[21]等技术;随着匿名黑客社区的逐渐成熟[22],僵尸网络的传播不再纯粹依靠恶意攻击,用户通过自愿安装他所信任的LOIC④等开源程序加入僵尸网络已经是不争的事实[23];随着云计算技术的快速发展,攻击者基于云服务平台(如亚马逊的EC2⑤等)提供的廉价资源构建高效能、高可控的僵尸网络也变得方便可行[24].在网络功能上,Stuxnet⑥和Duqu⑦的相继出现标志着僵尸网络的攻击技术走向专业化,开始具备向工控系统等非通用平台渗透攻击的能力.在威胁水平上,僵尸网络的目标已经逐渐由单纯谋取暴利和攻击某个站点转向更高层次.如随着社交网络(如Twitter、Facebook等)的广泛使用及对社会舆论引导能力的增强⑧,僵尸网络不仅能够借助社交链进行社交渗透和扩大感染规模(如Koobface[25]),还可以借助社交网络对大众心理产生重要影响[26].Ratkiewicz等人[27]研究发现在2010年美国中期选举中有部分受控社交结点在Twitter上发布大量误导信息,试图对选情造成影响.据称,目前地下市场中一个这种结点的售价高达29美元⑨.形态的多元化、功能的专业化、威胁的复杂化,不仅对当前僵尸网络防护研究提出了严峻挑战,而且说明僵尸网络的概念、外延已经扩展,迫切需要对僵尸网络从基本涵义到研究状况进行全方位的重新分析,认清威胁本质,抓住问题关键,预测发展趋势,①②③④⑤⑥⑦⑧⑨Page3找出研究盲区,明确努力方向.本文深入剖析了僵尸网络的基本概念、类型、关键技术和演化及研究趋势.文章内容组织如下:第2节在分析僵尸网络概念的基础上,提出了僵尸网络的新定义;第3节从网络结构、网络独立性和信息传递方式等角度对僵尸网络的类型进行了划分;第4节从僵尸网络的检测、测量和反制等方面对僵尸网络研究的关键技术进行了系统总结和分析比较;第5节对僵尸网络自身演化趋势和未来研究方向进行了分析和展望;最后总结全文.当前对僵尸网络的研究主要分为3类:(1)认识型研究.主要研究僵尸网络本身的特点和规律,包括僵尸网络的概念、功能结构和工作机制等;(2)防护型研究.主要研究如何应对僵尸网络的危害,包括僵尸网络的检测、测量和反制技术等;(3)攻击型研究.主要研究如何提高僵尸网络的功能和性能,包括增强僵尸网络隐蔽性和鲁棒性等技术.本文重点关注前两类研究.为便于表述,本文将用户自愿安装僵尸程序而形成的僵尸网络称为志愿僵尸网络,如LOIC网络;将攻击者使用自有网络结点构建的僵尸网络称为自部署僵尸网络,如基于云的僵尸网络[24].2基本概念2.1僵尸网络定义关于僵尸网络的概念,Honeynet项目组①认为僵尸网络是由受害主机组成并被攻击者远程控制的网络;Gu等人[28]指出僵尸网络由感染了特定恶意代码的大量受害主机组成,能够被单个操纵者控制;而诸葛建伟等人[29]认为僵尸网络是攻击者出于恶意目的,传播僵尸程序控制大量主机,并通过一对多的命令与控制信道所组成的网络.然而新型僵尸网络的发展不仅超出了这些定义的范畴(如僵尸程序不再必须运行于计算机主机,不再必须构建于Internet之上,也不再必须以破坏的方式进行传播),而且已经对网络安全造成了重大现实威胁(如2011年4月,来自LOIC僵尸网络的分布式拒绝服务攻击使索尼PSN网站无法正常提供服务,该公司遭受严重损失).为了正视威胁,认清本质,有必要对僵尸网络的定义进行重新修正.定义1.僵尸网络是攻击者通过一对多的控制结构,恶意组织大量受控网络结点形成的受控网络.记为Botnet=(CNS,CS,CA).CNS(ControlledNodeSet)指僵尸网络受控结点集合,记为CNS={CN1,CN2,…,CNK}.CN(ControlledNode)指僵尸网络的受控结点.受控结点可以是计算机、手机,也可以是虚拟机等;不止包括非授权的网络结点(如通过入侵手段获取的僵尸主机等),还包括授权使用的网络结点(如用户志愿加入或自主部署到僵尸网络中的各类结点).记为CN=(ControlledProgram,AuthorityType).ControlledProgram指运行于受控结点之上的受控程序.ControlledProgram∈{Infrastructure,BotProgram},受控结点也相应分为两种类型.Infrastructure表示受控结点上运行的是僵尸网络操纵设施程序,此时该结点的作用在于帮助控制者向僵尸结点发布指令;此类结点称为CNIn-frastructure(操纵设施),通常体现为命令与控制服务器.BotProgram表示受控结点上运行的是僵尸程序,此时该结点的作用在于接收攻击者的指令并执行指定任务;此类结点称为CNBot(僵尸结点),通常体现为僵尸主机.AuthorityType指受控结点上ControlledPro-gram运行权限的获取方式.AuthorityType∈{Authorized,Unauthorized},Authorized表示ControlledProgram的运行获得了用户授权,Unauthorized表示通过入侵手段获取了运行权限.CS(ControlStructure)指僵尸网络的控制结构.攻击者为了实现对僵尸网络的控制,需要在自身和僵尸结点之间构建一对多的命令传递通道,本文将该通道的组织方式称为控制结构,记为CS=(botmaster×CNInfrastructurei×CNBotj).CS刻画了僵尸网络中各角色在命令传递过程中的协作关系,botmaster×CNInfrastructure表示由攻击者向操纵设施发布指令的路径,CNInfrastructure×CNBot表示由操纵设施向僵尸结点传递指令的路径.i表示操纵设施的层级数量,j表示僵尸结点的层级数量.指令传递的路径可以基于互联网构建,也可以基于其他方式(如SMS、Bluetooth等)构建.CA(Command-Activity)指僵尸网络的指令-响应模式,记为CA=(〈Command1,Activity1〉,〈Command2,Activity2〉,…,〈Commandn,Activityn〉).Commandi表示第i种指令,Activityi表示Commandi触发的相关活动.①KnowyourEnemy:TrackingBotnets.http://www.hon-Page4与已有定义相比,本文定义在概念内涵上更关注僵尸网络的整体控制机制,在概念外延上适应了新型僵尸网络的发展需求.例如,通过分别定义僵尸网络的受控结点和控制结构,突出了网络的拓扑特性;通过区分受控程序的类型,指出了僵尸网络中的受控结点存在角色差异这一事实,明确地刻画了操纵设施(如控制服务器等)在僵尸网络命令分发中的作用;通过区分受控结点的权限获取方式,以非授权类型的僵尸网络表述了与已有定义相一致的概念,以授权类型的僵尸网络涵盖了志愿僵尸网络和自部署僵尸网络等新形态.2.2僵尸网络关键性能从攻击者的视角,僵尸网络以下性能备受关注.(1)透明性.透明性是指攻击者在操纵僵尸网络发起攻击或维护升级时可以将整个僵尸网络当作一个整体来操纵,不需要关心网络内部细节.透明性主要通过控制结构来实现,具体体现为僵尸网络控制者只需将命令与控制信息注入到控制结构中,由控制结构传递到各个僵尸结点,实现对僵尸网络的整体操纵.网络控制者不需要直接操纵僵尸结点,即僵尸结点对攻击者命令发布过程透明.(2)攻击容量.攻击容量是指能够被僵尸网络控制者操纵的所有受控资源的总和,决定了控制者能够发起的最大攻击强度.攻击容量取决于网络规模、带宽资源等因素.网络规模越大,攻击者能够利用的网络地址就越多,攻击来源就越分散,受到的制约越小;带宽资源越丰富,攻击者能够发起的攻击流量就越强大.(3)隐蔽性.隐蔽性主要是指传统僵尸网络生命周期中的4个主要阶段[30](包括僵尸网络初始感染、二次注入、执行任务和维护升级等)的活动需要较为隐蔽,降低僵尸结点、操纵设施和僵尸网络整体产生的流量等被检测的可能性.隐蔽性要求僵尸结点通常不能显著占用CPU、内存和带宽等资源或对宿主机可用性产生明显破坏,甚至需要使用Rootkit技术进行隐藏或主动禁止非授权行为检测工具的运行等.对志愿僵尸网络和自部署僵尸网络而言,隐蔽性更多是要防止被网络监管系统发现,而不注重防范终端用户查杀.(4)抗毁性.抗毁性是指僵尸网络在面临部分僵尸结点被毁坏或清除的情况下,仍然能保持一定攻击能力(部分满足僵尸网络控制者预期)的特性,也可称为韧性.较高抗毁性可以提高僵尸网络的生存能力,可以为攻击者提供更充裕的时间调整僵尸结点行为特征,避免僵尸网络完全失效.僵尸网络抗毁性的提高主要通过构造更稳健的网络结构来实现.目前的研究[31-32]认为,采用结构化P2P构建的僵尸网络具有较好的抗毁性.对于志愿僵尸网络和自部署僵尸网络而言,僵尸结点被清除的威胁不大,主要的挑战来自于对其控制结构的破坏,因此相对于隐蔽性,控制结构的抗毁性对其更为重要.3类型划分本节从网络结构、网络独立性和信息传递方式等不同维度划分僵尸网络的类型,如图1所示.其中从网络结构角度,根据僵尸网络是否具有中心控制结点,将僵尸网络划分为中心式、非中心式和复合式3种类型.其中,中心式僵尸网络指具有中心控制服务器的僵尸网络;非中心式僵尸网络指不具有中心控制服务器的僵尸网络;复合式僵尸网络指中心式和非中心式两种网络结构复合而成的僵尸网络.从网络独立性的角度,根据僵尸网络是否附着在其他网络中,将僵尸网络划分为寄生式和自生式两种类型.其中,寄生式僵尸网络指附着在其他网络中的僵尸网络;自生式僵尸网络指独立于其他网络的僵尸网络.从信息传递方式的角度,根据僵尸结点是否主动获取命令与控制信息,将僵尸网络划分为推送式和拉取式两种类型.其中,推送式僵尸网络指僵尸结点被动接收命令与控制信息的僵尸网络;拉取式僵尸网络指僵尸结点主动请求命令与控制信息的僵尸网络.图1从网络结构、独立性和信息传递方式等3.1基于网络结构的划分文献[33]将僵尸网络分为单服务器星形结构、多服务器结构、层次结构和随机结构等4种类型,随机结构主要是指采用P2P协议的网络,但是很多采用层次结构和多服务器结构的僵尸网络在某些层面Page5上也会采用随机结构,如Waledac等.Leder等人[34]将僵尸网络分为中心式、非中心式和机动式,但很多机动式僵尸网络本质上仍然是中心式的.为了提高分类的准确性,根据网络结构是否具有中心服务器,本文将当前的僵尸网络分为中心式、非中心式以及在这两种基本结构基础上形成的复合式结构.中心式僵尸网络每次发布命令与控制信息所用的操纵设施位置相对固定,形成明显的中心服务器,多呈现出星型结构或多服务器结构[33].中心式僵尸网络采用最多的通信协议是IRC协议与HTTP协议.其中,IRC协议自从僵尸网络产生起一直是其主流的协议[35],典型的基于IRC协议的僵尸网络有SDBot、RBot、AgoBot等.典型的基于HTTP协议的僵尸网络有BoBax、ClickBot、MegaD[36]、iKee.B[37]等.另外,很多其他协议也都可以用于构建中心式的僵尸网络,如各种IM协议、FTP协议、邮件协议[38]等.中心式僵尸网络的主要优点在于便于控制,主要弱点在于单点失效.非中心式僵尸网络每次发布命令与控制信息所用的网络结点不固定,不具有中心服务器,单点失效问题不明显.这种僵尸网络一般采用P2P协议并呈现出P2P结构.在这种僵尸网络中,僵尸结点也可以传播命令与控制信息,这为攻击者提供了灵活多变的操纵接口,而无需固定的操纵设施.典型的采用结构化P2P协议的僵尸网络有Storm等,而非结构化P2P僵尸网络有Nugache等.Grizzard等人[39]在总结P2P僵尸网络的基础上,对基于Overnet协议的Storm僵尸网络进行了分析;Dietrich等人[40]对Nugache僵尸网络进行了详细分析,发现改进后的Nugache提高了加密强度,并通过博客和垃圾邮件等进行传播.考虑到实际P2P网络中各个结点的异构性,Wang等人[41]提出了一种新型非中心式僵尸网络———HybridP2Pbotnet.该网络采用P2P协议,上层是Servent结点(一般具有独立IP),下层是Client结点(一般是内网结点);Client之间没有连接,且需要通过Servent结点来连入整个P2P网络.攻击者可以通过任一结点将命令与控制信息注入网络;网络中的任何一个结点在接收到新的命令与控制信息后,都会向其邻居列表中的Servent结点主动转发;而Client结点会定期地主动连接邻居列表中的Servent结点以获取命令与控制信息.这样,命令与控制信息在Servent结点间以泛洪的方式传播,然后Client结点以拉取的方式从Server结点获取命令与控制信息.非中心式僵尸网络的主要优点在于抗毁性高,主要弱点在于难以应对Sybil[42]攻击.复合式僵尸网络是指同时使用中心式和非中心式两种基本结构构造出的僵尸网络.Vogt等人[43]基于僵尸网络小型化的趋势,提出了一种下层为中心式、上层为非中心式的复合式僵尸网络SuperBotnet.SuperBotnet僵尸程序在传播过程中,自动地构建出指定数量的小规模中心式僵尸网络,作为整个僵尸网络的底层;同时,利用传播过程中的感染关系以及重复感染关系,在各个子僵尸网络的中心服务器之间建立加密连接,形成上层的非中心式服务器网络.命令与控制信息被注入上层服务器网络后,通过非中心式网络的连接关系传播到各个子网的中心服务器;各中心服务器接收到信息之后,完成信息在本子网内的传播,这样就实现了命令与控制信息的“一对多”传递和对复合式僵尸网络的透明操纵.Nunnery等人[44]对曾在互联网中广泛分布的Waledac进行了研究,发现Waledac是一种具有四层结构的复合式僵尸网络,而Conficker[45]也已被证明同时具备中心服务器和P2P连接.复合式僵尸网络旨在同时借助两种控制方式提高控制便利性和生存能力,但往往也同时面临着单点失效和Sybil攻击的威胁.3.2基于网络独立性的划分根据是否附着在其他网络上,僵尸网络还可以分为自生式和寄生式两种.自生式僵尸网络,每个结点都是僵尸网络的结点,所用的通信协议也是独立的;寄生式僵尸网络是其他网络的子网,其命令与控制信息的发布需要利用被附着网络现有的通信协议,甚至命令与控制信息的传递过程也常常会用到被附着网络中的常规结点.例如,2007年以前的Storm僵尸网络[10]即属于寄生式,它附着于正常的ED2K网络中,借助Overnet协议通信,并且在搜索命令与控制信息的过程中,常常需要正常结点提供路由支持.2007年以后改用StormNet私有协议的Storm僵尸网络则属于自生式.自生式僵尸网络的主要优点在于可以方便地采用各种控制机制,但其容易被防护方沿结点间连接关系、“顺藤摸瓜”地找到其他僵尸结点.寄生式僵尸网络的主要优点在于结点活动的隐藏性更好,不易被网络监管系统发现.然而,由于寄生式僵尸结点难以辨识当前的交互对象是否也为僵尸结点,因此往往只能通过预先约定“接头地点”的方式传递指令;而这种约定规律一旦被发现,很容易被反制.Page63.3基于信息传递方式的划分操纵设施为操纵者向僵尸网络注入命令与控制信息提供了接口,但信息如何在操纵设施与僵尸结点之间传递还是另一个问题.Holz[11]按照命令与控制信息传递的方式,将僵尸网络分为推送式(PushMechanism)和拉取式(PullMechanism)两种类型.推送式僵尸网络的命令与控制信息会被发送到各个结点,僵尸结点只需被动接收.IRC僵尸网络一般都采用推送式机制,而P2P僵尸网络如果采用泛洪的通信方式,则也属于推送式.拉取式僵尸网络中,僵尸结点需要主动请求命令与控制信息.基于HTTP协议的僵尸网络一般采用拉取式机制,而如果基于P2P协议的僵尸网络采用基于发布/订阅机制(Publish/Subscribe)的通信方式,则也属于拉取式.推送式僵尸网络的主要优点在于指令传递迅速,主要弱点在于如果采用P2P结构,泛洪信息会降低僵尸结点的隐蔽性.拉取式僵尸网络的主要优点在于当采用P2P结构时,僵尸结点较为隐蔽,主要弱点在于指令传递的时效性受限.Holz结合基于网络结构的分类方法和基于信3.4典型僵尸网络的类型分析一些典型僵尸网络在网络结构、网络独立性和信息传递方式等维度的特征比较如表2所示.其中,Clickbot主要用于进行点击欺诈,MegaD和Waledac等主要用于发送垃圾邮件.中心式僵尸网络与非中心式的区别主要体现在抗毁性上,中心式僵尸网络因存在单点失效问题而劣于非中心式僵尸网络.推送式与拉取式僵尸网络的主要区别体现在隐蔽性上,推送式的僵尸网络在推送命令与控制信息的时候,非常容易暴露,因此劣于拉取式,但其在命令传递的时效性上优于拉取式.寄生式僵尸网络因有被附着网络的掩护而增强了隐蔽性.表2僵尸网络的分类典型僵尸网络Storm(Overnet)Storm(Stormnet)HybridP2PbotnetSuper-Botnet4关键技术√√√√√√√√√√√√混合协议√由于我们以降低僵尸网络的危害为研究目标,因此本文关键技术主要涉及僵尸网络的防护型技术,包括僵尸网络检测技术、测量技术和反制技术,如图2所示.检测技术所要解决的问题是如何找出互联网中活动的僵尸结点和僵尸网络,主要的思路有3种:流量分析、蜜网捕获和反向检测.测量技术所要解决的问题是对僵尸网络的结点数量进行统息传递方式的分类方法,形成了如下的交叉分类列表(表1).传递方式推送式基于IRC机制拉取式基于HTTP机制基于Publish/Subscribe机制僵尸网络类型自生式寄生式Page7计,主要思路可以分为渗透至僵尸网络内部进行枚举和从僵尸网络外部进行估测两种.反制技术所要解决的问题是在检测发现僵尸网络后,如何清除僵尸网络或减轻其危害,主要的思路可以分为对僵尸网络活动进行抑制和劫持僵尸网络控制权两种.这3类技术之间的关系如图3所示,检测是测量和反制的基础,反制是检测和测量的目的,测量是反制的评估手段之一.由于目前鲜有对志愿僵尸网络和自部署僵尸网络的测量、检测和反制的研究成果,因此,如无特殊声明,本节内容所分析的技术只针对传统僵尸网络.4.1检测技术僵尸网络的检测一直是僵尸网络研究的难点问题,目前主要的检测技术有基于流量分析的检测技术、基于蜜网捕获的检测技术和反向检测技术等.流量分析技术主要是对互联网中某个子网的主机集合实施主动持续监测,蜜网捕获技术对整个互联网进行被动抽样监测,而反向检测技术则根据危害后果反溯僵尸网络.4.1.1基于流量分析的检测技术基于流量分析的检测技术通过对网络数据报文进行持续监测和关联分析来发现僵尸网络的活动.关联分析可以从3个层面进行[46]:纵向关联、横向关联和因果关联.纵向关联.Gu等人[12]为僵尸程序的多阶段感染过程构建了“基于状态的感染序列模型”,并基于Snort设计实现了僵尸结点检测系统BotHunter.该系统通过在网关上追踪内部主机与外部网络间的双向通信流量来识别感染过程的不同阶段(包括指向内部网络的扫描、攻击与恶意代码下载,指向外部网络的协同会话、对外攻击与传播等),并将识别结果汇总到关联分析引擎.关联分析引擎对汇总结果进行纵向关联形成可疑会话链,然后与感染序列模型进行匹配以判断是否存在僵尸结点.这种方法的局限性在于:感染序列模型是预定义的,且对于感染过程各个阶段的检测手段是基于特征的.横向关联.横向关联检测方法基于如下认识:僵尸结点活动规律是由其共同代码逻辑定义的,因而同一僵尸网络中的结点行为应具有时空相似性.横向关联方法正是通过分析不同主机流量间的时空相似性来检测僵尸结点.基于这种思想实现的系统有BotSniffer[47]和BotMiner[48].BotSniffer主要针对中心式僵尸网络,从时空特性和消息/响应特性等角度对多个主机的网络流量进行关联分析.BotMiner是一种不限于中心式僵尸网络的通用检测框架,它先分别根据通信流量相似性和恶意行为相似性对主机组进行两维度聚类,然后对聚类结果进行跨维度关联分析,以期发现既具有相似通信模式又具有相似恶意行为模式的主机集合.与BotHunter相比,这种方法的好处是不需要僵尸网络的先验知识(如僵尸程序行为特征等).因果关联.BotHunter、BotSniffer和BotMiner都是通过对网络流量的收集分析来发现僵尸结点,文献[49]还进一步提出了一种主动探测IRC僵尸网络的系统BotProbe.BotProbe系统基于典型僵尸程序具有确定的命令-响应模式且不能容忍会话中发生拼写错误的这一理性认识,利用假设检验的思想,从网络流量中分辨出哪些是IRC僵尸程序与外部的命令与控制会话,哪些是人与人的会话.在检测过程中,BotProbe会向网络中注入一些探针报文,因而是一种主动探测技术.这种方法较之前两种,更为积极.4.1.2基于蜜网捕获的检测技术基于蜜网捕获的检测技术是指通过设置蜜网系统,对所捕获程序的行为进行分析,判断是否存在僵尸结点.德国的蜜网项目组①最早利用蜜网技术对僵尸网络进行检测和跟踪研究.该项目组利用蜜罐蜜网技术捕获了大量僵尸程序,并对这些程序进行了详细研究,为僵尸网络的检测研究提供了第一手资料.Holz等人[11]详细介绍了利用蜜罐蜜网技术对中心式僵尸网络和非中心式僵尸网络的检测、分析和跟踪方法.北京大学的诸葛建伟等构建了一种基于高交互式蜜罐技术的恶意代码捕获器———①Thehoneynetproject.http://www.honeynet.org/Page8HoneyBow[50],获得了优于Nepenthes①的检测效果.ShadowServer组织②也利用蜜罐蜜网技术来对互联网中僵尸网络的活动进行检测.蜜网技术本身“守株待兔、愿者上钩”的特点保证了检测结果的准确性,但无法感知不访问蜜网系统的大量恶意代码.4.1.3反向检测技术反向检测技术是指通过对互联网中大规模恶意行为的危害后果进行数据挖掘,寻找隐藏其后的僵尸网络.Husna等人[51]基于时域特征对邮件进行聚类分析,获得了对发送垃圾邮件的僵尸网络检测方法.Sroufe等人[52]提出了一种基于邮件外形轮廓特征聚类以检测僵尸网络的方法.Xie等人[53]提出了一种基于内容特征的僵尸网络识别系统AUTORE,该系统提取海量垃圾邮件中包含的URL信息并据此对邮件进行聚类分析,追踪可能构建于部分邮件源地址之上的僵尸网络.这种方法基于危害结果进行反溯,针对性较强,结果一般较为可信.4.1.4检测技术比较分析表3对各种检测技术进行了比较.三类技术都可以实现对中心式和非中心式僵尸网络的检测,但是能力各有不同.BotHunter等系统可以通过对本地网络的实时检测快速发现僵尸结点,但其误报率问题尚待解决.蜜网技术可以通过捕获僵尸程序并进行逆向分析来获得僵尸网络的详细信息,检测准确率较高,但由于方式过于被动,导致检测范围受限.而且具备蜜罐感知能力的僵尸网络[54]也对蜜网的检测能力构成严重挑战.反向检测技术基于充足的危害数据,结果较为可信,但必须在大规模危害发生之后才能够进行检测,时效性差,且误报率较高.综合来看,在僵尸网络检测研究方面,Gu等人的方法虽然在误报率问题上(尤其是对非中心式僵尸网络的检测上)不及蜜网技术,但既克服了蜜网技术的被动性带来的高受限度,又能够在僵尸网络的传播和活动阶段实施检测,时效性较高,实用性较强.方法类型检测系统中心式流量分析蜜网捕获HoneyBow√√√反向检测AUTORE√√测量.4.2测量技术中介绍了一种对僵尸网络的规模进行测量的思路:美国约翰霍普金斯大学的Rajab等在文献[13](1)收集恶意代码;(2)分析通信规律;(3)利用已知的通信规律对僵尸网络进行在该思路下,主要的测量方法有DNScache探测、C&C信道监测、DNS重定向和P2P网络爬虫.另外,研究人员还提出了DNSBL、垃圾邮件数据挖掘等其他的规模测量思路.这些测量技术可以归纳为两类,一类是内部枚举技术,即通过渗透进入僵尸网络,从其信道内部测算结点数量;一类是外部估测技术,即对僵尸网络的外部活动数据进行分析,估算网络规模.4.2.1内部枚举技术P2P网络爬虫.内部枚举的主要途径包括C&C信道监测和C&C信道监测.对于中心式僵尸网络,进入其C&C服务器信道内部可以高效枚举网络结点.Freiling等人[7]使用了一种基于IRC信道监测的僵尸网络规模测量方法,该方法通过潜入IRC信道中观察僵尸结点的加入信息来统计网络规模.但这种方法适用范围非常有限[30],因为对于配置良好的IRC服务器,普通客户端几乎都没有权限获取僵尸结点的加入信息.实际上在大部分情况下,C&C信道监测方法都需要在一定程度上监控服务器,因此其实施难度较大.P2P网络爬虫.对于P2P僵尸网络,利用网络爬虫进行结点枚举是一种有效的测量方法.Holz等人[10]针对Storm僵尸网络,提出了利用P2P网络爬虫来获得结点信息的方法.该爬虫利用P2P协议查询机制,首先通过向P2P僵尸网络中的结点发送路由请求,获知其他僵尸结点信息;然后反复迭代地向新获知的结点发送路由请求,就可以估测出整个网络的结点数量.他们在2007年12月到2008年1月对Storm僵尸网络进行了测量,每次测量时间30min,发现Storm僵尸结点分布范围超过200个国家和地区,同时在线的僵尸结点约为5000至40000.这种方法非常适用于自生式的P2P僵尸网络,对于寄生式的僵尸网络,还需要对正常结点进行①②Page9区分.4.2.2外部估测技术外部估测的主要途径包括DNScache探测、DNS重定向、DNSBL统计和垃圾邮件数据挖掘等.DNScache探测.Rajab在对僵尸网络进行研究的过程中,提出了利用DNScache探测结果对僵尸网络规模进行下限估测的方法[13].现实中大多数的僵尸结点在与IRC服务器进行连接时,都要进行域名解析.如果使用IRC服务器的域名对DNS服务器的cache进行探测并命中,则说明至少有一个僵尸结点曾向该DNS服务器发起过请求.通过对海量DNS服务器的cache进行探测,就可以得到cache命中的服务器数量,并以该数量作为对僵尸网络规模下限的估测值.这种方法的问题在于,只适用于通过域名解析定位命令与控制服务器的中心式僵尸网络.DNS重定向.Dagon等人[55]提出了通过DNS重定向测量僵尸网络规模的方法.该方法首先分析捕获的僵尸程序,发现中心服务器的域名;然后通过域名服务商将对该中心服务器的域名解析重定向到特定网络位置,进而统计僵尸网络中的结点数量.其缺陷在于,如果僵尸结点不再需要进行DNS解析或者相关的域名服务商不愿合作,则难以进行统计.DNSBL统计.Ramachandran等人[56]提出了通方法类型测量技术中心式适用非中心式适用高准确度表4僵尸网络规模测量技术比较内部测量外部测量对于中心式僵尸网络而言,由于C&C信道监测方法往往实施难度较大,因而外部估测方法更可行.但外部估测方法中各种技术也都有其局限性.DNScache探测技术和DNS重定向技术都利用了僵尸节点的DNS查询行为,且常常需要网络服务商的支持,因此其适用性同时受到僵尸网络行为特征和服务商的制约.垃圾邮件数据挖掘技术虽然同时适用于中心式与非中心式僵尸网络,但只对发送垃圾邮件的僵尸网络有效.DNSBL方法的适用对象具有较强的特殊性,且无法区分所观察到的僵尸结点是否属于同一僵尸网络,因而实用性较差.过分析DNSBL①的查询记录来测量僵尸网络规模的方法.DNSBL是一种垃圾邮件黑名单,登记了具有不良记录的垃圾邮件源地址,可以为用户屏蔽垃圾邮件提供帮助.由于黑名单中的源地址都以域名方式记录,因而称为DNSBL.该测量方法基于这样一种假设:使用僵尸网络发送垃圾邮件的攻击者,可能会对DNSBL进行查询以了解僵尸结点是否在DNSBL中,进而调整僵尸结点的发送行为.因此,通过对DNSBL的查询情况进行统计分析,就可以对僵尸网络的结点规模形成粗略估测.这种方法的缺陷在于,无法揭示所发现的僵尸结点是否属于同一个僵尸网络,并且只有在僵尸网络用于发送垃圾邮件而攻击者进行DNSBL查询时,才能进行测量.垃圾邮件数据挖掘.Zhuang等人[57]提出了一种通过对垃圾邮件数据进行分析,发现僵尸网络并对网络规模进行计算的方法.方法首先对海量邮件进行指纹计算及比较,实现邮件聚类(每个类可以看作一次垃圾邮件大规模发送行动);然后对聚类后的邮件源IP地址信息进行分析,映射出对应的僵尸网络,从而估算出僵尸网络的规模.这种方法也可用于僵尸网络的检测.4.2.3测量技术比较分析表4给出了各种规模测量技术的比较.在僵尸网络规模测量方面,内部枚举技术的准确度明显高于外部估测技术.适用于成员结点通过DNS查询中心服务器的僵尸网络适用于成员结点通过DNS查询中心服务器的僵尸网络,且一般需要服务商支持适用于发送垃圾邮件的僵尸网络,且需要攻击者查询DNSBL记录只适用于发送垃圾邮件的僵尸网络对于非中心式僵尸网络而言,P2P爬虫技术受限度低、准确度高,因而综合性能最好.但对于寄生式的僵尸网络,仍然需要解决好识别正常P2P结点的问题.4.3反制技术检测到僵尸网络之后,如何有效反制以缓解或消除其危害,也是僵尸网络研究的一个重要方面.当前的僵尸网络反制技术可以分为网络抑制技术和网络劫持技术两类.①http://www.dnsbl.infoPage104.3.1网络抑制技术网络抑制技术的相关研究主要有Sybil攻击技术、内容污染技术和结点清除技术3类.Sybil攻击技术[42].对于非中心式僵尸网络,针对传统P2P网络的攻击技术可以起到反制作用.Sybil攻击有两种方式,一种是内容屏蔽,一种是查询抑制.以Storm网络为例,内容屏蔽技术首先向Storm网络中加入一定数量的Sybil结点,使其DHTID值接近某目标关键字Key;然后Sybil结点在网络中声明自己的存在,试图对多数Storm结点的路由表造成影响;当Storm结点查询该关键字Key时,就有可能被误导到Sybil结点,从而屏蔽真实搜索目标.查询抑制是指利用DHT技术中的查询停止机制,令Sybil在收到任何查询请求时,都向请求结点返回特定信息以使其停止进一步搜索,导致请求结点无法获得目标信息.文献[10]针对Storm僵尸网络,分析了内容屏蔽技术.不过Holz认为,由于Storm网络信息发布机制不同于KAD网络,内容屏蔽方法对Storm网络的抑制效果不佳.Davis等人[14-15]定量研究了查询抑制方法对Storm僵尸网络的抑制效果.他们以模拟的方式在Storm网络中加入大量的Sybil结点,这些节点接收到来自Storm结点的任何搜索请求时,都返回错误的应答消息,使搜索失败.分析结果表明,查询抑制方法可以在较大程度上抑制Storm僵尸网络命令与控制信息的传递.由于非中心式系统很难解决Sybil问题,因此Sybil攻击技术始终是抑制P2P僵尸网络的有效手段.内容污染技术.内容污染技术主要用于非中心式的僵尸网络,通过覆盖目标结点中所存储的命令与控制信息,阻止命令与控制信息在僵尸网络中传播.以Storm为例,为阻止以关键字Key为索引的命令与控制信息在网络中传播,内容污染技术首先搜索所有可能存储了该信息的结点,然后重新构造以Key为索引的假信息并以一定的频率反复地向这些结点发布,覆盖原有信息.Wang等人[58]进一步研究了内容污染方法,并指出内容污染能够高效抑制Storm是因为Storm网络在搜索中体现出了一定程度的中心化.Starnberger等人[59]提出了一种新型的结构化P2P僵尸网络Overbot,解决了Storm网络所残留的中心化问题.Overbot控制者针对每个僵尸结点采用不同的关键字来发布命令与控制信息,因此要对Overbot类型的僵尸网络进行内容污染,几乎需要向所有的僵尸结点发布污染内容.实际上,Overbot僵尸网络因其管理复杂和维护困难,目前几乎无法有效部署.因此,在能够获得命令与控制信息发布规律的情况下,内容污染方法仍然是一种高效的抑制手段.结点清除技术.清除僵尸网络结点可以达到直接抑制僵尸网络的效果.僵尸网络结点清除有3种策略:定向清除、树形清除和随机清除[31].定向清除按照连接度由高到低的顺序清除僵尸网络结点;这种方式对中心式僵尸网络的抑制效果显著,通过直接停止中心服务器的运转或者联系域名服务商拒绝对僵尸网络提供服务,可以达到瘫痪僵尸网络的目的.树形清除,是防护方利用已经捕获的僵尸结点,分析出与之有连接关系的其他僵尸结点,“顺藤摸瓜”地进行结点清除.随机清除指随机地对僵尸网络中的结点进行清除;僵尸网络的结点被宿主机用户或杀毒软件发现并查杀,是随机清除的典型情况.各种清除策略的效果与僵尸网络采用的网络结构有关.Dagon等人[32]从复杂网络的研究角度出发,提出了描述僵尸网络结构的效能、效率、健壮性这3个属性的指标-最大分支规模及带宽、网络直径、聚类系数;然后以这3个指标对各种网络结构进行了衡量.研究结果表明,结构化P2P网络和ER(Erds-Rényimodel)随机网络[60]对于定向清除的韧性要高于非结构化P2P和BA(Barabsi-Albertmodel)无标度网络[61],而对于随机清除策略则相反.Davis等人[31]进一步提出了两个新的性能指标-网络对单个结点的可达性和最短路径集分布,并通过模拟实验发现:与ER网络相比,结构化P2P网络具有更高的抗毁性.4.3.2网络劫持技术网络劫持技术主要包括域名抢注、Sybil欺骗和内容替换等技术.域名抢注.很多中心式僵尸网络为了提高隐蔽性,会频繁更换其中心服务器的域名,这就为劫持僵尸网络提供了机会.Stone-Gross等人[16]通过分析Torpig僵尸程序,获得了其中心服务器域名变换规律;通过预测并抢注Torpig中心服务器将要采用的域名,使僵尸结点误将防护方的服务器作为其中心服务器,并接受其指令.由于不少僵尸网络都设计有自卸载功能(如AgoBot、SDbot等),因此在劫持这类僵尸网络后,可以通过发布自卸载命令来高效清除宿主机器上的僵尸程序[62].Sybil欺骗.在P2P僵尸网络中,Sybil结点如果对任何僵尸结点的搜索请求返回特意构造的信息,就有可能实现对僵尸网络的劫持.Page11内容替换.在对P2P僵尸网络的抑制技术中,内容污染通过将被目标关键字索引的内容都覆盖掉,导致僵尸网络无法有效传递命令与控制信息.如果使用特意构造的信息来覆盖目标内容,僵尸结点在获取并执行相应命令后,就有可能被劫持.目前有关网络劫持技术的研究尚未涉及Sybil欺骗和内容替换.但Sybil欺骗和内容替换将是未来网络劫持的重要手段.4.3.3反制技术比较分析如表5所示是对僵尸网络反制技术的比较.Sybil攻击方法阻止僵尸结点寻找存储有命令与控制信息的结点,使得僵尸网络出现“有命令,取不到”的现象,抑制了僵尸结点的命令获取能力.内容污染通过直接破坏命令与控制信息,抑制了僵尸网络的命令发布与传递能力.结点清除方法通过直接清除僵尸结点或操纵设施来抑制僵尸网络,破坏了僵尸网络的结点生存能力.网络劫持技术都是通过误导僵尸结点,劫持攻击者对僵尸网络的控制权.对于中心式僵尸网络,由于其存在单点失效问题,因此应当主要考虑用定向结点清除或域名抢注的方法实施反制.对于非中心式的僵尸网络,虽然结点清除能够降低其网络规模,但由于其抗毁性一般较高,因此应当更多考虑用Sybil攻击、内容污染、Sybil欺骗或内容替换的方法实施反制.内容污染和内容替换需要首先分析僵尸网络的命令与控制信息发布规律,而分析发布规律具有一定的难度,因此Sybil攻击和Sybil欺骗的可行度更高.目前对基于Sybil欺骗的劫持技术尚无研究,而定量研究[61-62]已证明Sybil攻击技术的有效性,因此对非中心式僵尸网络而言,Sybil攻击是最可靠的反制技术.尽管如此,目前利用Sybil攻击技术抑制僵尸网络的研究仍然不够充分,既缺乏对抑制效果的定量预测模型,又缺乏更加灵活的抑制策略,因此应当受到研究人员的更多关注.方法类型反制技术中心式适用非中心式适用网络抑制网络劫持5僵尸网络演化及研究趋势基于对僵尸网络分类和关键技术研究现状的系统介绍与分析,本节提炼出了僵尸网络自身的演化趋势和僵尸网络未来研究方向.其中,僵尸网络演化趋势是对僵尸网络自身结构和功能发展方向的预测,僵尸网络未来研究方向是对僵尸网络研究未来亟需解决的技术问题的判断.5.1演化趋势僵尸网络在与安全组织和厂商的博弈过程中,为了解决隐蔽性、生存性等问题,自身也在不断地演化,从而呈现出如下的发展趋势.非中心化.非中心式结构因其在抗毁性方面的优势,正逐渐被越来越多的僵尸网络采用.Dittrich等人[40]通过分析指出,在僵尸网络多年来的演化过程中,由于现有的方法对P2P僵尸网络的检测和抑制效果相对有限,僵尸网络逐渐趋于采用P2P类型的命令与控制信息传递机制.Wang等人[58]指出,尽管当前大多数僵尸网络仍然是中心式的,但是没有中心服务器的P2P僵尸网络比传统的僵尸网络表现出更好的抗毁性和生存性.更多的研究[41,63]也都将P2P看作下一代高级僵尸网络将会采用的机制.另外,志愿僵尸网络和自部署僵尸网络基本上不受反病毒软件的影响,其最大的威胁在于其可能会造成单点失效问题的中心控制服务器,因此,这类僵尸网络的进一步发展,必然会走向非中心化.小型化.僵尸网络的规模在一定程度上呈现出缩小的趋势.密歇根大学的Cooke等[64]认为,这种趋势的出现,可能是因为防御措施获得改进,使新的大规模僵尸网络难以构建.但更可能的原因是随着带宽的不断增加,更小规模的僵尸网络完全可以胜任原先低带宽环境中需要大规模僵尸网络完成的任务,因此攻击者为了提高隐蔽性,主动地减小了单个僵尸网络的规模.另外,对于采用P2P信道的僵尸网络,在网络规模扩大之后,命令与控制信息的传递效率会受到一定影响,这可能也会迫使网络规模小型化.Damballa公司①通过对600多个僵尸网络长达3个月的监测发现,这些僵尸网络中结点规模超过10000的只占5%,规模在500到10000之间的占17%,规模在100到500之间的占21%,而规模在100以下的则占到了57%.智能化.未来僵尸网络在演化过程中将更具智能性.Zou等人[54]提出了一种具有反蜜罐能力的僵尸网络.这种僵尸网络在传播过程中,通过要求目标①GunterOllmann.BotnetSizewithintheEnterprise.http:Page12主机执行某些恶意的网络攻击行为来判断该目标是否是蜜罐;而蜜罐在设计中考虑到法律因素,一般不会执行这些攻击行为.Hund等人[63]提出了一种具有较高智能和较强防反制能力的高级僵尸网络.这种僵尸网络采用信誉积分体系建立僵尸结点的信誉档案,用于识别伪造结点;要求新入网结点执行复杂耗时的计算任务,阻止P2P爬虫的高效运行,并在一定程度上遏制Sybil攻击;提供对脱网僵尸结点的回收机制,使僵尸结点可以借助现有的P2P网络重新入网.强化加密传输.早期的僵尸网络大多不对传输信道进行加密,缺乏认证机制,这使僵尸网络很容易被分析、渗透和劫持.然而在演化过程中,更多僵尸网络(如Peacomm[65])正在采用越来越复杂的加密技术来提高其反渗透能力.Dittrich等人[66]通过分析僵尸程序发现,Nugache僵尸网络已经采用了非常强的加密机制,而Storm僵尸网络的加密机制也在不断演变.Hund等人[63]提出的下一代僵尸网络更利用了DH密钥协商方法来实现僵尸结点之间的密钥交换,采用了较强的对称加密措施保护传输信道和隐藏流量特征,并通过公钥加密实现了僵尸网络的分片出租.隔离化.更多的僵尸网络将会采用Fast-Flux技术来隔离僵尸结点与命令服务器的直接通信,为服务器提供一层安全保护.Fast-Flux技术主要可以分为两种类型[33],一类是IP-Flux,一类是Domain-Flux.IP-Flux是一种由一定数量受控主机所组成的服务网络,利用自身的IP地址资源池,以一定的速率轮转地对指定域名设置具有短生命周期的解析映射,从而达到为一个域名分配不断变换的多个(几百甚至上千)IP地址的目的.Fast-Flux网络中的大量IP地址一般不是内容请求的最终目的地址,而是仅仅被部署成为一层重定向代理服务器,转发僵尸结点与真正服务器之间的请求与响应.蜜网组织①进一步将IP-Flux服务网络分为两种不同的类型:Single-Flux和Double-Flux.与Single-Flux网络相比,Double-Flux网络多了一个保护层,这一层通过不断地改变授权名字服务器的IP地址来增强保护能力.与IP-Flux技术相反,Domain-Flux技术的目的是为一个IP提供不断变换的多个域名.僵尸网络在Fast-Flux技术上的发展趋势体现在以下两个方面.一方面是僵尸网络通过改造自身功能,对外提供Fast-Flux服务.Holz等人指出,在2007年6月Storm僵尸网络组织被发现时,该组织正在对Storm进行改进以使之具备Fast-Flux服务能力.Hu等人[67]利用在边界路由器上的Netflow数据,对提供Fast-Flux服务的僵尸网络进行了研究,而Perdisci等人[8]的工作进一步指出,Fast-Flux服务网络的结点通常以僵尸网络功能模块的形态出现.另一方面,僵尸网络也会利用Fast-Flux技术来完成自身组网.Stone-Gross等人[16]在对Torpig僵尸网络的研究过程中发现,该僵尸网络采用了Domain-Flux技术来提高自身的生存能力,而Waledac更在对外提供IP-Flux服务的同时,利用自身的Fast-Flux机制对僵尸结点进行检查,以避免虚假结点的加入[44].移动化.移动计算技术的蓬勃发展为僵尸网络提供了新的生存空间,基于移动平台构建的僵尸网络从种类和数量上都呈现出快速增长态势.Sym-bOS.Yxes[68]通过感染塞班平台构建了一个通过HTTP服务器进行控制的僵尸网络;Geinimi②通过感染安卓平台构建了一个中心式的僵尸网络;甚至在较为封闭的苹果平台上,iKee.B[37]也利用iPhone越狱造成的安全漏洞,通过扫描传播构建了大规模的僵尸网络.Mulliner等人[69]和Traynor等人[18]已经实证性地研究了移动僵尸网络对移动网络的安全所能造成的严重危害.很多安全研究人员从不同角度对移动僵尸网络的发展做出了预测.Dimitrios等人[70]提出了基于iPhone的移动僵尸网络高级构建技术iSAM.崔翔等人[71]设计了基于HTTP和URL-Fulx技术的中心化移动僵尸网络Andbot.Weidman等人[20]基于SMS设计了一套推送式移动僵尸网络的组网技术;Geng等人[72]基于SMS设计了一种层次式移动僵尸网络的组网技术;Zeng等人[19]基于SMS设计了构建P2P结构移动僵尸网络的方法.Singh等人[21]研究了基于蓝牙技术构建移动僵尸网络控制信道的可行性.2012年初,赛门铁克公司指出中国境内有超过10万部安卓手机感染了Andrio.Bmaster僵尸程序③,进一步说明移动僵尸网络的发展趋势已经十分明显.5.2未来研究方向结合僵尸网络当前的研究现状及其演化趋势,①②③Page13本文认为僵尸网络的未来研究趋势可从如下三类传统研究方向中提炼概括,具体包括僵尸网络认识型研究新技术、僵尸网络防护型研究新技术和僵尸网络攻击型研究新技术.5.2.1认识型研究新技术认识型研究新技术主要包括传播模型技术、协议模型自动构建技术和僵尸网络性能评价技术等.传播模型构建技术.僵尸网络传播模型刻画僵尸网络生长发展的行为规律,为僵尸网络防护型研究提供指导,有助于把握僵尸网络的本质特点.目前对僵尸网络传播模型的研究中最重要的工作是Dagon等人[55]基于时区的传播模型,但其仅适用于扫描传播的僵尸网络.僵尸网络的传播途径是灵活多样的,除扫描传播外,垃圾邮件传播、网站挂载传播、植入盗版软件传播和操纵软件下载站点的下载评分进行传播等也都是重要途径.针对这些途径的传播模型技术尚有待研究.协议模型自动逆向构建技术.协议模型以形式化方法描绘僵尸结点活动和命令控制信息之间的关系,是认识和分析僵尸网络活动规律的重要手段,能够为检测、测量和反制提供重要的指导.僵尸网络泛滥肆虐,变种众多,需要协议模型自动逆向构建技术来为快速认清僵尸网络的控制规律提供手段.Cho等人[73]基于在线测试和自动协议分析技术,针对MegaD僵尸网络设计实现了一个协议分析引擎,逆向构建了MegaD的Mealy[74]自动机模型.但该系统仅仅针对特定僵尸网络,具有更高通用性和更高自动化程度的僵尸网络协议模型自动逆向构建平台,是未来研究的一个重要方向.僵尸网络性能评价技术.僵尸网络性能评价主要指从可用性、隐藏性、鲁棒性等各个方面对僵尸网络危害能力进行综合度量,为僵尸网络威胁评估、反制效果评估等提供支撑.Dagon等人[32]指出,仅通过规模来衡量僵尸网络的性能是远远不够的,因此构建综合指标评价僵尸网络是一个重要的研究方向.但是这方面的现有研究较少,而且已有成果大多从复杂网络抗毁性角度进行分析[31-32],鲜有从僵尸网络特有属性出发的性能评价技术研究.5.2.2防护型研究新技术防护型研究新技术包括全球范围的监测技术、针对寄生式僵尸网络的规模测量技术和借助Sybil欺骗反制僵尸网络的新技术等.全球范围的监测技术.全球范围的检测系统要通过对整个互联网中的网络活动进行监测和汇聚,从中找出僵尸网络.非中心化是僵尸网络结构演化的重要趋势,会降低单个结点因流量异常而被检测的概率.如果非中心僵尸网络进一步采用反蜜罐技术,并寄生在正常P2P网络中,则基于主机的检测难度会进一步增大.因此,僵尸网络检测的总体思路应当放在充分利用僵尸结点活动的时空相似性上,最大范围地汇聚其恶意性,克服其隐蔽性,而全球范围的监测系统是一个重要选择.针对寄生式僵尸网络的规模测量技术.在对P2P僵尸网络的规模测量技术中,DNSBL方法实用性较差,垃圾邮件数据挖掘方法准确度较低,P2P网络爬虫技术综合效果最好.虽然P2P网络爬虫技术可以对独立式P2P僵尸网络进行较为准确的规模测量,但对于寄生式的P2P僵尸网络,还需要解决如何区分正常结点与僵尸结点的问题.借助Sybil结点反制僵尸网络的技术.对于中心化的僵尸网络,往往可以在ISP的支持下,采用关闭中心服务器的方法进行反制.但对非中心化的僵尸网络,目前主要的反制手段仍然是通过各种恶意代码查杀工具进行清除,时效性差,不确定性高.进一步,随着志愿僵尸网络和自部署僵尸网络的出现,防护方必须要在无法清除僵尸结点的前提下对僵尸网络实施反制.因此,如何对非中心化的僵尸网络进行高效反制,成为一个非常重要的课题.考虑到P2P网络协议较强的扩展性所带来的开放特点,利用Sybil结点对P2P僵尸网络进行渗透,并通过发布虚假消息抑制僵尸结点间的通信、甚至劫持僵尸网络的控制权,应为反制技术研究的一个重要方向.5.2.3攻击型研究新技术本文以研究僵尸网络防御技术为主,但僵尸网络攻击技术的研究仍然是一个重要方向.深度把握僵尸网络的攻击技术研究趋势可以为研究僵尸网络防御技术提供支持.根据本文对僵尸网络内涵的把握和演化趋势的分析,我们认为如下两类攻击型技术将会对僵尸网络的未来演化产生重要影响:僵尸网络协同技术.僵尸网络的协同技术可以分为两个层面,一是受控结点间协同技术,即同一僵尸网络内部结点间分工协作完成任务的技术;二是僵尸网络间协同技术,即不同僵尸网络间分工协作完成任务的技术.目前僵尸网络结点间协同主要体现为操纵设施与僵尸结点之间的信息传递,但能够胜任更复杂攻击任务的僵尸网络要求在设计中进一步细分角色,这需要更先进的结点间协同技术的支持.另外,文献[75]指出,在僵尸网络小型化趋势下,Page14大规模僵尸网络倾向于采用协同管理模式:整个僵尸网络划分为若干小网络,各自构建独立的命令与控制机制,同时接受攻击者统一控制.这使得网络间协同技术变得非常重要.僵尸网络先进组网技术.僵尸网络的非中心化会大幅提高其抗毁性,但Wang等人[58]的研究指出,目前P2P僵尸网络在命令与控制机制中仍然存在中心化现象,这严重威胁了僵尸网络的生存性和可用性.Overbot[59]试图解决这个问题,然而其实用性较差.因此,完全非中心化且实用性强的先进组网技术,很可能会成为攻击技术研究者下一步的重点关注方向.除上述技术因素之外,未来还应当从道德、法律方面,为降低僵尸网络的危害提供重要手段.著名科幻作家阿西莫夫曾提出机器人三定律,为机器人的设计指出了伦理边界.“盗亦有道”,僵尸网络作为一种人造的受控网络,也应当对其在伦理上进行限定,从而为法律约束提供依据,以此从一定程度上通过威慑来保护重要的网络基础设施不被僵尸网络破坏.6结束语僵尸网络作为一种复杂、灵活和高效的网络攻击平台,对个人、企业和国家等在各个层面构成了巨大的、潜在威胁.目前,僵尸网络已引起了网络安全研究领域的高度关注,并已经成为研究热点.本文首先深入剖析了僵尸网络概念的内涵和外延,提出了僵尸网络的新定义,并从网络结构、网络独立性和信息传递方式等维度对僵尸网络进行了划分;然后系统分析了僵尸网络检测技术、测量技术和反制技术等三类关键技术的最新研究进展;最后探讨了僵尸网络自身结构和功能方面的演化趋势,并结合僵尸网络的本质内涵和关键技术的最新研究进展等,提炼出了僵尸网络的未来研究方向,包括传统技术的新方向和小型化、智能化等僵尸网络演化趋势下的新技术.
