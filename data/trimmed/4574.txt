Page1基于捕获效应的预约时隙分配RFID防碰撞协议研究1)(西南交通大学信息科学与技术学院成都610031)2)(西南民族大学计算机科学与技术学院成都610041)摘要适合于RFID低成本要求的Aloha协议中存在标签无法被阅读器多次识别的饥饿现象.在移动RFID系统中,该现象将导致标签漏读这一严重问题,而有效地解决地这一问题需要大幅提高Aloha协议的识别效率.为此考虑RFID无线通信系统中客观存在的捕获效应,提出一种预约时隙分配高效防碰撞协议.该协议基于捕获效应将识别循环分为预约和在读取标签两个阶段,通过帧前预约机制和感知冲突机制有效地减少了读取阶段的无效时隙数.在此基础上,通过选择最优预约随机码位数和预约时隙数,实现了该防碰撞协议的识别效率最优化.此外还给出了适用于本协议的基于捕获效应标签数估计方法.性能评估表明该防碰撞协议的平均识别效率达到92.6%,明显高于现有Aloha协议,因而该协议比现有协议更适合于移动RFID系统.此外该协议在识别速度、通信复杂性和抗干扰能力方面明显优于现有的典型防碰撞协议.通过研制基于该协议的RFID原型系统,利用该系统完成的物理实验结果表明了协议的有效性.关键词射频识别RFID;防碰撞协议;预约;捕获效应;标签估计;物联网1引言物联网中射频识别(RadioFrequencyIdentifi-cation,RFID)是一种非接触识别技术,它通过无线信道获取物体的相关数据从而自动识别该物体[1].该识别过程无需人参与,所以RFID能够被应用于各种自动跟踪系统,如物流系统等.一般来说,RFID系统由一个阅读器和众多标签构成.附着于物体的标签有物体相关识别信息ID(IDentification),通过阅读器和标签间的共享无线信道响应阅读器的盘查命令.如果多个标签同时传送数据到阅读器,那么这些数据包将冲突,从而降低阅读器数据接收效率,即是标签碰撞,它是RFID技术关键问题之一.RFID系统通过防碰撞协议处理该问题[2].防碰撞协议分为Tree协议[3-7]和Aloha协议[8-23].Tree协议是一种确定性机制,它能识别阅读器感知区域内所有标签,但时延较长.而Aloha协议采用随机机制,得益于其简单且易于实现而被广泛应用于RFID标准中.在传统Aloha协议中,当标签数与帧时隙数相等时,识别效率最优(效率为成功时隙数与总时隙数之比),故大部分研究工作主要关注如何满足这一最优效率条件,考虑到待识别标签数会发生变化,研究者提出了帧长随标签数变化而变化的动态帧时隙Aloha(DynamicFramedSlottedAloha,DFSA),DFSA协议能够让阅读器在标签数变化时仍然以最优效率识别标签.EDFSA(EnhancedDynamicFramedSlottedAloha)协议[8]是一种改进型DFSA协议,采用分组识别标签的方法解决DFSA协议中存在的因标签增加所引起的帧时隙指数级增长问题.DFSA协议中,准确估计标签数成为该协议的一项关键技术.为此很多RFID技术研究者提出了多种标签数估计方法[9-12].近期文献提出了中止剩余低效时隙的读取策略[13]来提高DFSA协议效率.归纳现有Aloha协议识别标签的时间分配机制,可分为随机分配和预约分配.前者的时隙时间分配仅依靠标签的随机数电路来随机选择帧内某时隙,识别效率较低,这类协议如EDFSA.后者阅读器根据标签随机选择情况来分配时隙时间,避免了时隙时间分配的盲目性,减少了无效时隙时间分配,从而提高了防碰撞协议的标签识别速度.目前已知有两种预约分配机制,一种是位隙机制,如Wong等人[14]提出的GBBSA(GroupingBasedBit-SlotAloha)协议和王中祥等人[15]提出的BIS(BitSlot)算法.GBBSA和BIS均消除了帧内空时隙,但仍然存在较多的碰撞时隙.这些帧前预约机制提高了协议效率,有利于解决标签饥饿问题.另一种是时隙时间预约机制,标签随机选择时隙,阅读器在分配时隙后根据该时隙内标签响应数来决定是否继续分配其剩余时间,例如EPC-C1G2(EPCglobalClass-1Generation-2)防碰撞机制[16].这种预约机制提高了识别标签的速度,但识别效率与随机分配协议相同,不利于解决标签饥饿问题.目前,虽然已有不少关于RFID防碰撞协议的研究成果,但协议的识别效率比较低(大约37%~61%),如果这些协议用于移动RFID系统,其饥饿现象引起的标签漏读问题,不容忽视.同时,少有协议考虑RFID无线通信环境中所客观存在的捕获效应,而这种效应将明显地影响协议参数最优确定和标签数估计准确性.基于此,本文在现有研究成果的基础上,考虑捕获效应,研究如何进一步提高Aloha防碰撞协议的识别效率和识别速度.所提出的防碰撞协议采用了新预约时隙分配机制.该协议将一个识别循环分为预约帧时隙阶段和在帧时隙内读取标签两个阶段.阅读器根据标签数在读取标签的帧时隙前分配一定数目的预约时隙(Reservationslot).标签在其随机选择的预约位隙内向阅读器传送一位预约随机码(Reservationrandomcode)以预约一个帧时隙.该协议被称为SARCE(SlotAssignmentbasedPage3onReservationconsideringtheCaptureEffect).SARCE协议与现有Aloha协议相比,不仅能消除读取阶段中的空闲帧时隙,而且能够明显减少读取阶段中的碰撞帧时隙数,在读取阶段的绝大多数时隙是能够读取标签的成功时隙.性能评估表明该协议较现有Aloha协议,识别效率与速度以及抗干扰能力明显提高,识别效率达到92.6%,同时通信复杂性降低.由于SARCE协议与传统DFSA协议机制有较大差别,用于DFSA协议的传统标签数估计方法不能直接用于SARCE协议,因此本文提出了适用于SARCE协议的标签数估计方法.2相关工作(1)EDFSADFSA协议在标签数稀疏环境中具有优势并被用于ISO18000-6A,然而DFSA性能在标签数密集环境中,其性能下降.Lee等人[8]针对标签密集环境,提出了DFSA的扩展型协议EDFSA.该协议估计标签数后,通过优化技术限定帧内参与识别标签数的办法来分组识别标签.该协议的帧碰撞时隙数和空闲时隙数仍然较多,该协议效率仍然较低.标签分组标准如表1所示.待识别标签数708~1416(2)EPC-C1G2防碰撞机制该机制采用Q算法确定和修改帧长,每个标签随机选择时隙,然后在所选择的时隙内传送16位随机码来预约该时隙剩余时间.有3种时隙:空时隙(Emptyslot),阅读器在开启该类时隙后,等待一个短的特定时间t3后,然后中止该时隙;碰撞时隙(Collisionslot),阅读器开启该类时隙后,接收到多个标签传送的16位随机码,于是阅读器检测标签碰撞,然后阅读器等待时间t2后中止该类时隙,碰撞时隙比空时隙时间更长.成功时隙(Successslot),阅读器开启该类时隙后,只有一个标签传送其16位随机码,阅读器成功接收到该随机码后,用ACK命令通知标签传送其ID.图1和图2分别是EPC-C1G2防碰撞系统和Q算法[16].(3)GBBSA该协议中,每个标签产生128位预约序列,每位代表一个时隙,其中只有一位为1,表示该标签预约了某一时隙,其余位为0.阅读器接收到各个标签产生的预约序列,如果某位为0,表明该位代表的时隙未被预约,因而阅读器不开启该时隙,从而消除了空闲时隙.如果接收到的预约序列某位为1,表明该位所代表的时隙已被预约,然后阅读器开启该时隙,如果只有一个标签预约该时隙,则阅读器在该时隙成功识别标签,如果有多个标签预约该时隙,则该时隙为碰撞时隙.故该协议消除了空闲时隙,但未消除碰撞时隙.(4)标签数估计me,ms,mc为空闲、成功和碰撞时隙数观测值,L为帧长,Le,Ls,Lc为空闲、成功和碰撞时隙数理论值,n为标签数.Schoute估计法[9]假定标签数和帧长相等时碰撞时隙标签数为2.39个,得到n估计值:Page4Cha估计法[10]所估计的标签数n满足:Vogt法[11]采用理论值和测量值最小化来估计碰撞标签数,选择这样的n值,这个值使测量值和理论值最小:Chen估计法[12]基于多项分布和最优概率方法来估计帧内参与识别的标签数:其中P(nme,ms,mc)=[nL1(1-最后一种估计方法估计误差在这些估计方法中最低,平均值约为5%左右.上述标签估计方法均未考虑捕获效应,实际应用中标签估计误差将比较大.(5)曼彻斯特编码曼彻斯特编码(Manchester)[17]已用于ISO18000-7标准中,该编码机制如图3所示.逻辑“0”和“1”分别用正跳变和负跳变表示.如果两个或两个以上标签同时传送不同逻辑位到阅读器,正跳变和负跳变相互抵消而变为高电平,阅读器视该高电平为碰撞结果,在图中标记为“?”.此外,阅读器还能保证在连续出现“0”时,对标签的能量供应,且便于标签从数据编码中提取时钟信息,因此本协议采用曼彻斯特编码机制来检测碰撞.(6)捕获效应正如上面所述,传统观点认为来自多个标签信号在阅读器处会引起碰撞,导致其无法正确识别任何标签.在RFID无线通信环境中,当多个标签与阅读器间距离差等原因导致标签反射回阅读器的信号强弱不相同时,会产生捕获效应(Captureeffect),即强信号的能够被阅读器接收而成功识别标签.这种捕获效应会明显影响防碰撞协议性能.目前文献中主要有3种捕获效应模型(n为标签数).模型1的捕获概率[18]为u0为捕获效应产生时距离比值下限.模型2的捕获概率[18]为δ(n)=P(SIR>z0)=P该模型中,只有当信噪比大于某一门限值z0时,捕获效应才会发生.模型3的捕获概率为[19]其中α∈(0,1)称为捕获因子.除能够成功接收的强信号外,其余弱信号被视为噪声信号.如弱信号越多,则噪声越大,强信号被成功接收概率越小,故模型3与模型2在本质上是一致的.因模型3的简洁性和有效性,在协议分析中,采用其来描述捕获效应.3SARCE协议在SARCE协议的预约帧时隙阶段,阅读器根据待识别标签数确定预约时隙(ReservationSlot)数,读取标签阶段由帧时隙(Frameslot)组成.每个预约时隙代表一个帧时隙,标签随机选择预约时隙表示随机选择了所代表的帧时隙.在读取标签阶段,阅读器根据标签预约情况来决定是否分配每个预约时隙所代表的帧时隙.SARCE协议如图4所示,协议过程如下.(1)预约帧时隙阶段阅读器根据当前待识别标签数发送带参数q的Query命令,该参数表示本阶段将分配2q个预约时隙.接收到该命令的标签在[0,2q-1]范围内随机选择预约时隙(时隙号s),并为该预约时隙产生v位随机码(RNv).然后阅读器发送预约命令Res以分配2q个预约时隙,各个标签基于自身时隙计数器在其随机选择的预约时隙内传送其RNv.阅读器在各个预约时隙内接收RNv.如果某个预约时隙内,阅读器没有接收到RNv,则在读取标签阶段,阅读器不分配该预约时隙所代表的帧时隙,由此消除了空闲帧时隙(Emptyframeslot).当预约时隙被一个标签选择时,则阅读器于该预约时隙内成功接收RNv,然后在读取标签阶段分配该预约时隙所代表的帧Page5时隙,且能够在该帧时隙内成功接收标签ID,称这个时隙为成功帧时隙(Successframeslot).当多个标签选择同一个预约时隙时,就会导致预约冲突(Reservationcollision),阅读器采用曼彻斯特编码机制来感知预约冲突:①当选择同一个预约时隙的标签所产生的随机码RNv不相同,且阅读器通过曼彻斯特编码能检测到随机码的差异,从而感知到预约冲突.在读取标签阶段,阅读器就不再分配该预约时隙所代表的帧时隙,避免了碰撞帧时隙(Collisionframeslot);②如果它们的RNv相同或由于捕获效应而成功接收到预约码,则无法感知到预约冲突,在读取标签阶段,阅读器会分配该预约时隙所代表的帧时隙,并在该帧时隙内多个标签向阅读器传送其ID,如果阅读器接收到多个标签ID,就产生了识别冲突(Identificationcollision),该时隙为碰撞时隙.阅读器内用寄存器R记录各预约时隙接收预约码的情况:如果阅读器在某预约时隙i成功接收预约随机码,则置R中第i位为1,否则置为0.(2)读取标签阶段阅读器根据寄存器R记录的预约情况分配帧时隙,并在帧时隙内识别标签.阅读器从第0位到最后一位检测R,如R的第i位为1{R(i)=1},则向标签传送参数为i的时隙分配命令Assi.收到该命令的标签比较其预约时隙号s是否等于i,若相等,则向阅读器传送其ID码.如果阅读器能成功接收ID,然后向标签发送该ID低8位作为参数的确认命令Ack,以让标签ID低8位等于Ack命令参数的标签处于静默状态.如阅读器接收到多个标签ID,则发生识别碰撞,然后阅读器向标签发送Nak命令,以让标签参加下一次识别循环.由上可知,在SARCE协议中,阅读器在预约阶段用Query命令发送预约时隙数后,标签根据预约时隙选择回复,阅读器在读取标签阶段根据各预约时隙内标签回复情况来分配帧时隙,它是帧时隙外预约机制.在EPC-C1G2中,阅读器用QueryRep开启帧时隙后,标签通过16位随机数来预约该帧时隙剩余时间,这是时隙内预约机制.SARCE时隙外预约机制比EPC-C1G2时隙内预约机制能够更有效地减少无效时间开销,且时隙外预约机制的预约开销比时隙内预约机制开销小,因而SARCE比EPC-C1G2具有更好的识别性能,第5节图11说明了这一点.在预约阶段检测时隙利用情况会增加少许时间开销(用于检测空闲帧时隙和感知预约冲突的时间开销),这种开销带来的好处是有效地减少了在识别阶段的无效帧时隙时间开销.如何权衡增加的时间开销和减少的无效帧时隙时间开销,第4节“基于捕获效应的SARCE协议分析”中,式(16)和式(17)考虑了这种权衡.3.1SARCE协议中的捕获效应在无线共享信道中,当多个信号同时传输,其中信号强的能够被信号接收器成功解码,该现象被称为捕获效应.在RFID系统中,阅读器利用该现象能够从碰撞时隙中识别出信号强的标签.在多个标签选择同一个预约时隙条件下,当预约随机码相同时,阅读器能够成功接收预约随机码.当预约随机码不同时,因捕获效应也能成功接收到某一个标签的预约随机码.阅读器在这两种情况下成功接收预约随机码后,在读取标签阶段分配该预约时隙所对应的帧时隙,在该帧时隙内可能因捕获效应而成功读取某个标签的ID数据,从而该帧时隙是一个成功帧时隙.当只有一个标签选择一个预约时隙时,阅读器能够在该预约时隙对应的帧时隙内成功的识别标签.进一步分析可知,在读取标签阶段产生成功帧Page6时隙有3种情形:(1)一个标签选择一个预约时隙(该情形的概率用Ps1表示);(2)多标签在预约阶段选择一个预约时隙且预约随机码相同,然后在标签读取阶段,阅读器因捕获效应而成功识别标签(该情形的概率用Ps2表示);(3)多标签在预约阶段选择一个预约时隙时且预约随机码不全相同,阅读器因捕获效应而成功接收预约随机码,然后在标签读取阶段,阅读器因捕获效应而成功识别标签(该情形的概率用Ps3表示).在读取标签阶段产生碰撞帧时隙有两种情形:(1)在预约阶段,多个标签选择一个预约时隙且预约随机码相同,在标签读取阶段,阅读器未成功接收任何一个标签ID数据(该情形的概率用Pc1表示);(2)多个标签在预约阶段选择一个预约时隙且预约随机码不相同,阅读器因捕获效应而成功接收预约随机码,但在标签读取阶段,阅读器未成功接收任何一个标签ID数据(该情形概率用Pc2表示).3.2SARCE协议识别用例结合捕获效应分析结果,以一个帧识别用例来说明SARCE协议流程.该例中的随机码为4位,预约时隙数L=8(q=3),标签数为9.预约帧时隙阶段如图5(a)所示.每个标签产生一个随机数s(s∈[0,7])作为所选择的预约时隙号,并为该预约时隙产生4位随机码.标签1和标签3选择预约时隙0,且有相同随机码(“0101”),阅读器能够成功接收该随机码,并将寄存器R的0位置为1.预约时隙1仅被标签5选择,阅读器能够成功接收随机码,所以寄存器R的位1被置为1.而预约时隙(2,5)没有标签选择,阅读器不能接收标签随机码,故寄存器R的位(2,5)被置为0.标签6和标签8选择同一个预约时隙3,但它们的随机码不同(“0111”和“0101”),阅读器不能够成功接收该随机码而检测到该预约冲突,所以寄存器R的位3置为0.标签4和标签7选择同一个预约时隙4,阅读器因捕获效应成功接收到标签4预约随机码,寄存器R的位4被置为1.标签2和标签11选择预约时隙6,且有相同随机码(“0111”),阅读器能够成功接收该随机码,并将寄存器R的6位置为1.标签9和标签10选择同一个预约时隙7,因捕获效应阅读器成功接收到标签9预约随机码,寄存器R的位7被置为1.读取标签阶段如图5(b)所示.阅读器基于寄存器R(‘11001011’)与标签通信.因R(0)=1,R(1)=1,R(4)=1,R(6)=1,R(7)=1,阅读器分配5个帧时隙(0,1,4,6,7);由于R(2)=0,R(3)=0,R(5)=0,阅读器不分配帧时隙(2,3,5).在帧时隙0内,标签1和标签3同时传送其ID给阅读器,阅读器因捕获效应成功接收ID1.帧时隙1内只有标签5传送ID5,故阅读器能够成功接收到该ID.在帧时隙4内,标签4和标签7同时传送其ID给阅读器,阅读器无法成功接收其中任何一个ID,因而该帧时隙为碰撞帧时隙.在帧时隙6内有标签2和标签11回传ID,阅读器无法成功接收其中任何一个ID,该时隙也为碰撞帧时隙.在帧时隙7内标签9和标签10传送ID,阅读器因捕获效应成功接收ID9,该时隙为成功帧时隙.总之,本阶段没有空闲帧时隙,只有成功帧时隙和少量碰撞帧时隙.SARCE与传统DFSA相比,以较少的预约开销换来无效帧时隙开销的降低.4基于捕获效应的SARCE协议分析从第3节可知SARCE的参数包括用于计算预约时隙数L的q(q∈ZP+P)和随机码RNv的位数v.这些参数取值将决定协议的性能.设阅读器感知区域内标签数为n.Page74.1SARCE识别效率分析与协议参数确定设有k个标签的碰撞时隙(有预约冲突的预约时隙或碰撞帧时隙),阅读器的捕获概率为[19]其中,α∈(0,1)称为捕获因子,故无捕获效应的概率为预约时隙数为L=2q,则标签选择某一预约时隙概率为k个标签选择同一个预约时隙概率为Pk=Ck故该预约时隙内,k个标签产生相同随机码的概率为k个标签产生不全相同随机码的概率为Pck2=Pk×1-C在读取标签阶段的成功帧时隙情形1的概率为Ps1=C1在读取标签阶段的成功帧时隙情形2的概率为Ps2=∑在读取标签阶段的成功帧时隙情形3的概率为nPs3=∑k=2n=∑k=2故成功帧时隙概率为η(q,n,v)=不考虑捕获效应即δ(k)=0时,可得{Ps=Ps1+Ps2+Ps3=C1Ck则成功帧时隙期望数为Ls=L×Ps=n1-n2q∑k=2在读取标签阶段的碰撞帧时隙情形1的概率为Pc1=∑在读取标签阶段的碰撞帧时隙情形2的概率为Pc2=∑k=2=∑k=2故碰撞帧时隙概率为Pc=Pc1+Pc2=∑k=2Ck则碰撞帧时隙期望数为Lc=L×Pc=2q∑Ckn预约帧时隙阶段等效帧时隙数为这里size()为二进制码的位长函数,参照EPC-C1G2标准,size(ID)函数值为256.由此可得SARCE识别效率:nk=2{δ(k)+δ(k)1Page8n1-)q2(size(ID)+2q∑数值结果:在协议设计过程,应当考虑获得最优识别效率.由式(17)或式(18)可知变量(v,q)是SARCE协议的关键参数.当n分别取9个值(10,100,200,300,400,500,600,700,800)时,对应每个n值,α分别取0,0.1,0.2,0.4和0.8,利用式(17)得到45个三维图,它们均为单峰,该函数有最大值(最优值).图6、图7和图8是其中3个图,对应函数最优值有最优变量(最优参数).从这些三维图可以得到最优效率值η和相应的最优v和最优q值,如表2所示.表2标签数(狀)和捕获因子(α)vs.最优值(η,狏,狇)n101002003004005006007008001nCkk=2图6在α=0和n=400时q和v对效率影响图7在α=0.4和n=400时q和v对效率影响Page9图8在α=0.8和n=400时q和v对效率影响由表2看出,不考虑捕获效应,当v=5时识别效率最优.考虑捕获效应,当v=1时识别效率最优,且协议效率η和协议参数q受捕获因子α影响极小δ(k)+δ(k)()1nk=2进一步分析v等于1时,q对效率的影响.图8呈现了10个q值所对应的10个效率曲线,每两个相邻q值曲线有一个重要交点,而这些重要交点的横坐标满足等式(20)和等式(21)其中qi∈[1,…,10],ni∈Z+.SARCE参数q应当根据标签数(n)来确定.q可取11个值(4,5,6,7,8,9,10,11,12,13).协议效率(η)和协议参数q受捕获因子α的影响极小,故式(19)中捕获因子α取中间值0.4,得到11个曲线和10个曲线交点,如图9所示.图中每对交点间曲线段对应于一个q值,当标签数在相邻两个横坐标值之间变化时,效率接近于最优值,且其波动幅度较小.列这些数据于表3中,可见效率最小值为93.5%,该值为识别效率理论值.n1~34~67~1112~2223~4546~9091~179180~360361~716717~800(见SARCE抗干扰能力分析一节).基于v=1可由式(17)得到式(19)2δ(k)+δ(k)()1{4.2捕获效应下SARCE协议标签数估计目前已提出了多种适用于DFSA协议标签数的估计方法,这些标签估计法基于帧成功时隙数、碰撞时隙数和空闲时隙数.由于本协议将识别过程分为两个阶段,每个阶段均有冲突或碰撞,而且两个阶段均可能发生捕获效应,故与传统DFSA协议机制有较大差异,需要提出适用于本协议的标签数估计方法.预约帧时隙阶段与DFSA协议一样均采用随机方式选择时隙,但阅读器无法检测到所有的预约冲突.一个识别循环结束后,阅读器统计两个阶段总的成功时隙数ms、总的空闲时隙数me和总的碰撞时隙数mc,可得到适用于SARCE协议的标签数估计方法.设预约帧时隙阶段空闲的预约时隙数为re,Page10预约冲突的预约时隙数为rc,读取标签阶段的成功帧时隙数为is,碰撞帧时隙数为ic,则ms=is,mc=rc+ic,me=re.基于式(10)和式(14)可得到适用于SARCE标签数估计的最优化模型:maxf(n,a)=其中Pe=1-Ps=C1Pc=∑s.t.0<a<1,n∈z+.由于粒子群算法具有明确的社会心理学指导思想,并有算法简单、易于实现和收敛速度快等优点[24],因此本文采用粒子群优化算法来求该模型的解(n和α).4.3SARCE抗干扰能力分析(受捕获效应影响小)考虑基于信噪比的捕获效应,作为信号接收方的阅读器的硬件电路决定了正确读取信号的信噪比门限.如果某防碰撞协议识别效率和协议参数受捕获效应影响大,则该防碰撞协议的参数应该根据具体阅读器来进行调整,而这给防碰撞协议的应用带来不便.捕获效应是抗干扰能力的体现,干扰信号包括其他未识别标签信号,也包括源自非标签的信号,故防碰撞协议受捕获效应影响小也表明它更能够适应于复杂的电磁干扰环境.基于标签数n=100,由式(19)可得图10,该图为捕获因子(α)对识别效率(η)的影响.可见随着α的增加,效率(η)增加很少,故捕获效应对识别效率的影响很小,SARCE协议具有良好的抗干扰能力.在性能评估一节将对本协议与其他协议算法在捕获因子对效率影响方面进行比较.4.4SARCE标签电路复杂性(实际成本)分析考虑SARCE协议应用,将它与目前广泛应用EPC-C1G2标准协议的标签电路复杂性分析比较.标签由发送与接收电路、编码与解码电路、存储器、控制器和时钟电路等电路单元构成,它的计算和存储功能由这些电路单元完成.计算包括随机数产生、时隙计数等;存储器保存所选择的时隙号、随机码和ID数据.SARCE标签生成选择预约时隙的随机数q和v=1位随机码共需产生logq而q最大值由阅读器感知区域最大可能标签数决定,当q=13时L=8192,能够满足实际应用需要,故q可取4位.所以需要随机产生4+1=5位随机数.而EPC-C1G2防碰撞协议(Q算法)需生成16位RN16随机数,需产生16+4=20位随机数,因此,本文所提出的SARCE协议随机数计算复杂性明显低于EPC-C1G2标签.此外,标签中需要实现状态机来执行命令,SARCE协议中标签需执行共5个(Query、Res、Assi、Ack、Nak),而EPC-C1G2标签需的执行必备命令也是5个(Select、Query、QueryRep、Ack、Nak),故基于SARCE协议标签和基于EPC-C1G2协议标签命令执行的计算复杂性相近.另外,SARCE协议需要产生和存储1位预约随机码,而EPC则需要产生和存储16位预约随机码.故总体上SARCE协议的标签电路复杂性低于EPC-C1G2协议的标签电路复杂性.5性能评估本文在考虑无线通信系统的捕获效应基础上,将先采用识别效率、识别速度和通信复杂性3个性能指标对所提出的SARCE协议和现有典型防碰撞协议进行性能评估.识别效率不受标签ID位数的影响,它被用来评估防碰撞协议的内在性能,而通信复杂性和识别速度则是在固定标签ID位数的情况下,从具体性能角度来对协议进行评估.通过比较SARCE和经典协议(EDFSA、GBBSA和Q算法)在3个性能指标方面的差异,来对SARCE协议进行内在性能和实际性能评估.然后评估捕获效应对4个协议识别效率影响.在识别效率、识别速度和通信复杂性3个性能指标评估中,待识别标签数设定为1~801,4个协议Page11采用相同的空中接口通信参数(标签ID位数、数据传输速度、识别命令和链路时序).考虑到EPC-C1G2的最大最小ID位数分别为16和496,性能评估选择中间值256.EPC-C1G2标准中规定数据传输速率在26.7kbps到128kbps之间,在评估中类似地采用中间值96kbps.在本评估中,采用类似EPC-C1G2标准的4个主要识别命令(‘Query’,‘QueryRep’,‘Ack’和‘Nak’).22位命令‘Query’用来分配一个帧及其第一个时隙,4位命令‘QueryRep’用于分配一个新时隙.12位命令‘Ack’用于告知已识别标签处于静默状态.4位命令‘Nak’用于告知未识别标签参与下一识别循环.参考EPC-C1G2标准,设置EDFSA、GBBSA和SARCE协议链路时序,由于篇幅限制,在此略去.此外假定准确估计标签数,故能得到各协议的最好性能.捕获因子取中间值0.4.基于3个指标的实验结果分别如图11、图12和图13所示.识别效率(η)定义为成功时隙数和总时隙数的比率,协议效率越高则避免空闲时隙和碰撞时隙能力越强.为比较这种避免能力,在识别完一定数量(n)标签后,统计总帧时隙数(totalframeslot)、空闲帧时隙数(emptyframeslot)、碰撞帧时隙数(collisionframeslot)、成功帧时隙数(successframeslot)和等效帧时隙数(equivalentframeslot),这些实验数据见图11.图11表明:SARCE与其他协议相比,无空闲时隙,很少的等效时隙和很少的碰撞时隙.例如,当标签数为801时,EDFSA总帧时隙数为2167,Q算法总帧时隙数为2365,GBBSA的总帧时隙数为1301,而SARCE的总帧时隙数仅为865,故SARCE在识别效率方面明显优于其他协议效率,达到92.6%,这一实验测量值接近于理论值93.5%.在移动RFID环境中,识别速度越快,则标签漏读率越低.图12呈现识别一定数量(n)标签的平均速度(Thenumberoftagsidentifiedpersecond).例如,SARCE总平均速度为每秒识别292个标签,而Q算法、EDFSA和GBBSA总平均速度分别大约每秒237、209和223个标签,SARCE高出Q算法约23.2%.图12表明SARCE在4个协议中识别速度最快.无线通信系统中,在相同的硬件条件下,发送01码所消耗的能量与发送时间成本成正比,而该时间成本又与发送01码位数成正比,因此能量消耗可以用发送01码位数来表示.通信系统消耗的能量主要用于数据传输,因此能量消耗通过传送码位数的多少来计算.图13呈现了一定数量(n)标签条件下4个协议识别每个标签时平均传输位数(Trans-mittedbitsforonetagidentified).例如,SARCE协议平均需要传输295位,而Q算法、EDFSA和GBBSA识别一个标签分别平均需要传输376、450和423位,故SARCE能量比Q算法减少21.5%.图13表明SARCE传输位数在4个协议中最少,原因在于它以较少的时间开销消除了空闲帧时隙和有效地减少了碰撞帧时隙,从而显著减少了传输位.SARCE在通信复杂性方面的优势有利于其应用于实际RFID系统.捕获效应对协议识别效率的影响.在该评估中,Page12标签数n=100,捕获因子从0.1~0.9变化,得到4个协议识别效率(η)受捕获因子(α)影响情况,如图14所示.该图表明,SARCE曲线与第5节理论分析所得图10中曲线接近,受捕获因子影响小;EDFSA受捕获因子影响较小;而Q算法和GBBSA受捕获因子影响比较大.因此,SARCE协议具有良好的抗标签干扰能力,协议受无线通信环境变化影响小,不会因捕获因子变化而修改协议参数,从而为协议应用提供了方便.6原型系统研制与物理实验SARCE协议的一个帧识别循环分为预约帧时隙阶段和读取标签阶段.读取标签阶段的各帧时隙均由阅读器Assi命令分配,故帧时隙同步性较好.预约阶段的预约时隙是由阅读器Res命令连续分配的,各标签选择的预约时隙的开始时间只能由各个标签根据自身时钟电路来完成,而标签工艺与实际环境会引起时钟计时误差.各标签与阅读器之间也会存在距离差.计时误差和距离差都将影响标签间预约时隙同步.实现所有标签对预约时隙的划分有统一的标准,达到预约时隙同步是SARCE协议具备有效性的关键.本协议可用于高速RFID系统,采用雷达电磁反射原理实现阅读器与标签间通信.阅读器通过天线发送用命令编码对基带调制过的信号,命令信号到达标签天线后,标签解调后接收命令并执行.为给标签持续供应能量,在无数据发送时,阅读器仍然持续发送基带信号.这些基带电磁波遇到标签天线后,将会反射回阅读器,其振幅受天线负载控制.当标签向阅读器发送其ID数据时,根据待传送的01代码来改变天线负载,以对标签所反射基带电磁波的振幅进行调制,向阅读器传送其ID数据.标签对获得的基带信号分频后产生多个分频信号,这些频率信号可作为标签的控制器、存储器、编码/解码等电路工作时钟信号.为了减轻计时误差对预约时隙同步的影响,标签预约时隙计数器的时钟信号也采用某一分频信号.目前已有一些时隙同步问题研究成果[25-27],但考虑标签的低成本要求,采用时隙保护的方法来达到预约时隙同步目的.阅读器发送的Res命令是一个预约阶段的同步信号,各标签将该命令信号到达时间作为自己预约帧时隙阶段的计时基准时间,并根据其预约时隙计时器来确定各个预约时隙开始时间.一个预约时隙时延(tr)=发送起始保护时间(tb)+发送1位随机码时间(ts)+发送完成保护时间(te).标签与阅读器间的距离通常在10m以内,距离差大概也在10m以内,而电磁传播速度为3×108m/s,由各标签距离差所引起的最大传播时延大约为10÷(3×108)≈3.33×10-8s=0.0333μs.为便于观察曼彻斯特编码波形,参照ISO18000-6B标准采用40kbps数据速率,传输1位预约随机码所需要的时间ts=1÷(4×104)=25μs.电阻和电容等元件的温度系统约为10-6,因而标签时钟频率不稳定率一般低于10-6.考虑有8192个预约时隙,则同步误差=传播时延+预约阶段最大定时抖动×2≈0.0333μs+8192×25μs×10-6×2=0.4429μs.发送起始保护时间tb最大同步误差=0.4429μs.发送结束保护时间te=发送起始保护时间+最大同步误差+最大传播时延=0.4429μs+0.4429μs+0.0333μs=0.9191μs.由此得到一个预约时隙时延tr=tb+ts+te=0.4429μs+25μs+0.9191μs=26.362μs.用于预约时隙同步开销仅占预约时隙时延5.2%,且预约阶段的等效帧时隙数在总帧时隙数所占比例很小(见图11),故预约时隙同步开销引起RFID系统性能损失很小.为验证SARCE协议的有效性,我们研制了该协议的RFID原型系统.该系统采用前面方法解决了协议实际应用中所存在的预约时隙同步问题(即分布式节点同步问题).标签在发送起始保护时间结束后发送预约随机码,而不是在预约时隙开始后立即发送;在发送完预约码后,再等待发送完成保护时间结束后,才开始下一预约时隙,从而消除预约时隙不同步所引起的阅读器随机码接收错误.所设计的RFID原型系统硬件结构如图15所示.因阅读器与标签的硬件结构大致相同,为快速研制出原型系统而采用相同样板,在后续的生产中再将两者区分,所设计的原型系统电路板实物如图16所示.Page13该RFID原型系统的右边开关用于设置电路板的阅读器模式/标签模式.阅读器中R寄存器为8位(0~7),在电路板下部有“寄存器R(0~7)”来显示R各位值.该电路板在标签模式时,可通过“q/s设置”开关设置标签选择的预约时隙;在阅读器模式时,则通过它设置阅读器所分配的预约时隙数.为了便于观测预约时隙内所接收到的预约随机码RNv波形,随机码位数为8,可通过“随机码设置”开关随机设置各位的值.标签ID通过“ID设置”开关置入.为了便于观测波形,阅读器有自动和手动两种工作方式,可以通过“自动/手动”开关选择.当置为“自动”时,阅读器自动完成标签识别过程;当置为“手动”时,每按“单步”按键一次,阅读器执行一个命令,从而分步进行阅读器识别标签过程各个环节,这样便于用数字存储示波器在阅读器/标签电路的“观测点”观测多个经过曼彻斯特编码的标签信号叠加情况,以分析对应时隙的利用情况.在电路板下部是标签发送数据曼彻斯特编码波形的观测点(标签模式)/阅读器接收标签数据曼彻斯特编码叠加后波形观测点(阅读器模式).利用所研制的RFID原型系统,进行未成功感知预约冲突物理实验、成功感知预约冲突物理实验和无标签选择预约时隙物理实验.具体实验情况如下:在未成功感知预约冲突物理实验中,两个标签选择同一预约时隙3,两标签随机码均置为11101101,通过示波器观测到两个标签向阅读器传送的曼彻斯特编码波形如图17(a)所示,它们的码形相同,并从阅读器观察到两标签返回的数据经过叠加后的曼彻斯特编码波形如图17(b)所示,所成功接收到的预约随机码也为11101101,表明没有感知到预约冲突,由此阅读器将在标签识别阶段分配一个碰撞帧时隙.在成功感知预约冲突物理实验中,两个标签选择同一预约时隙5,随机码分别置为11011011和11011010.通过示波器观测到两个标签向阅读器传送的曼彻斯特编码波形如图18(a)所示,它们的码形不全相同,也从阅读器观察到两标签返回的数据波形经过叠加后的曼彻斯特编码波形如图18(b)所示.可见最后一位的波形没有跳变(本原型系统中,当阅读器检测到没有跳变时,在观测端以低电平信号方式输出),阅读器未成功接收到标签所发送的预Page14约随机码,从而感知到预约冲突,阅读器将在标签识别阶段避免分配一个碰撞帧时隙.在无标签选择预约时隙物理实验中,两个标签均未选择预约时隙4,通过手动方式单步执行标签识别,在该预约时隙内,示波器在阅读器观测点处未监测到任何曼彻斯特波形.基于所研制RFID原型系统的物理实验表明:(1)时隙保护技术能够解决SARCE协议所涉及到的预约时隙同步问题(即分布式节点同步问题);(2)曼彻斯特编码技术能够用于RFID检测预约冲突,从而降低碰撞帧时隙等无效时隙分配,提高RFID系统的识别性能.7结束语在现有的Aloha协议中,存在许多无效空闲帧时隙和无效碰撞帧时隙,从而导致低识别效率问题,在动态RFID环境中该问题将引起标签漏读,限制了RFID在一些重要领域的应用.此外,这些协议基于理想无线通信环境,不利于最优化系统性能.为此本文基于无线通信系统中捕获效应,提出了SARCE协议来解决这些问题.SARCE协议通过随机码来有效地避免碰撞时隙,通过帧前预约机制消除空闲时隙.权衡捕获效率和预约开销,得到了协议最优参数(随机码位数和预约时隙数).性能评估表明,SARCE协议识别效率达到92.6%,明显高于其他协议效率.这种高识别效率能够有效地解决因标签饥饿现象所导致的标签漏读问题.考虑捕获效应环境,提出标签估计最优化模型,该模型有效地估计标签数和捕获因子.此外,SARCE协议在通信复杂性和识别速度方面也优于其他协议.协议深入分析表明协议性能受捕获因子影响很小的特性,这种特性表明其抗干扰能力强、协议参数受环境和阅读器硬件影响小,从而为协议应用带来了方便.开发RFID原型系统,并采用时隙保护技术解决了预约时隙同步这一实际应用中的关键问题,实际实验数据也表明该协议的有效性,且通过曼彻斯特编码的标签信号叠加后能够分析出对应时隙的利用情况.具有上述优点的高识别效率该协议在移动RFID系统中具有良好的应用前景.
