Page1基于社交圈的在线社交网络朋友推荐算法王1),2)高琳1)1)(西安电子科技大学计算机学院西安710071)2)(西安电子科技大学经济与管理学院西安710071)摘要为用户推荐朋友是在线社交网络的重要个性化服务.社交网站通过用户之间是否有相同属性信息或公共邻居判断他们能否成为朋友,但由于用户注册信息不完善和对公共邻居之间关系的忽略,推荐精度不高.事实上用户的朋友可以组成多个社交圈,拥有相似社交圈的用户更易成为朋友.因此,首先提出了社交圈检测算法,进而定义用户间的社交圈相似性,基于社交圈相似程度为用户推荐新朋友.使用YouTube数据验证了该文假设;使用Facebook自我网络数据,验证了社交圈检测方法的有效性,并与3种典型检测算法比较;使用区域Facebook数据,通过与公共邻居、Jaccard相似性比较,进一步验证了朋友推荐方法的准确性.关键词社交网络;社交圈;朋友推荐;社团发现;相似性;社会计算1引言随着Web2.0技术的成熟,在线社交网络(OnlineSocialNetwork,OSN),如Facebook、Twitter、人人网等吸引了大量用户.用户们不仅把现实生活中的人际关系搬到了网络上,还建立了与线下无关的单纯线上朋友关系,在社交网络上搭建起全新的沟通和分享信息的平台.在社交网络提供的众多服务中,为注册用户推荐朋友是其中一项关键个性化服务,在提高用户体验和促进网络增长方面起重要作用[1].新朋友不仅能为用户提供新的信息来源、满足用户和其他具有共同兴趣爱好用户交流的需求[2],还能帮助社交网络利用朋友关系推荐用户潜在感兴趣的服务项目,如Facebook的新闻反馈、LinkedIn的产品推荐和Dopplr的旅游同伴等[3].当朋友数量爆炸性增长时,用户在社交网络上的沟通效率反而会变得低下,大量朋友每天更新的信息都会推送到用户个人主页上,而用户可能只关心某些朋友关于某个主题的更新,如同事发布的工作相关内容、家人发布的生活相关消息、一起玩网游的朋友发布的游戏相关信息等.为了过滤噪声、使用户快速发现他们真正需要的信息,朋友分组管理成为在线社交网络必须解决的问题.2相关工作作为信息推荐问题的一种[4],朋友推荐通常被转换为复杂网络上的链路预测问题[5].两个用户越相似,他们越有可能成为朋友.社交网站在注册时要求用户填写个人资料,如性别、年龄、就读过的学校、工作单位等特征信息,可以利用特征信息的相似程度预测朋友关系.但用户的特征信息常常是不完善的,考虑到隐私问题,用户可能不愿填写完整个人信息或填写虚假信息,网站为了简化注册过程,对此也不强求,所以仅利用注册信息推荐朋友的精确性较低.除了特征信息,主要有3种方法计算用户相似性:基于局部信息的相似性、基于全局信息的相似性和基于随机游走的相似性.其中基于全局和基于随机游走的相似性计算方法都需要整个网络的拓扑信息,不适合用于在线社交网络这种顶点规模巨大的网络上,而且朋友预测也不需要考虑整个网络上所有顶点.因此在线社交网络都采用基于局部信息的相似性计算方法,主要是公共邻居相似性(CommonNeighbors)及其不同的规范化.公共邻居相似性定义如下sxy=|Γ(x)∩Γ(y)|,其中Γ(x)是用户x的邻居顶点的集合,即用户x的朋友集合.如果考虑公共邻居的相对数量,即可得到Jaccard相似性sxy=|Γ(x)∩Γ(y)|/|Γ(x)∪Γ(y)|.此类相似性最大的缺陷是仅考虑了公共邻居个数,忽略了公共邻居之间的关系.我们注意到在社交网络中,用户的朋友会自然形成多个社交圈亲人、同事、同学等,如果两个用户拥有重叠程度很高的社交圈,那他们很可能会建立朋友关系.为了利用社交圈发现潜在朋友,首先需要识别社交圈,即实现对朋友的自动分组.朋友自动分组问题通常转换为用户自我网络(egonetwork)社团发现问题[6].自我网络是用户及其朋友以及他们之间的连接关系构成的网络.如图1所示为某用户A的自我网络,用户A将他的朋友分成邻居、同事、大学同学和驴友4组,其中同事分组和大学同学分组有重叠.McAuley等人[7]在对自我网络聚类时,除了网络拓扑结构,还考虑用户特征信息,认为拓扑连接稠密且特征信息相似的朋友们应属于同一社交圈,并在此基础上提出基于概率模型的社交圈发现算法.该算法的主要缺陷是运行时间太长,当网络规模大于1000时,需要的运行时间以小时计算.Yoshida[8]提出的低秩嵌入算法能够聚类顶点有属性信息的网络,也可以用来发现自我网络中的社交圈,但该算法不能识别重叠圈子.为了高效准确地预测朋友关系,本文首先提出一个基于关系的社交圈检测算法,快速聚类自我网络,完成社交圈的自动分类.其次充分考虑公共邻居之间的关系,给出基于社交圈的用户相似性定义,并利用该相似性设计朋友推荐算法.已有的研究将朋友分组与朋友预测看作两个独立问题,本文将这两Page3个问题结合在一起,在朋友推荐时充分利用朋友分组信息,不仅提高了推荐精度,还对新朋友所属社交圈给出建议,实现了朋友分组的自动更新.3朋友分组与预测算法3.1基于关系的社交圈检测算法用户拥有不同社会角色,其朋友可以按照他们与用户不同的关系被分成多个社交圈:亲人、同事、同学等,同一圈子里的人相互联系紧密[7].通过对边进行聚类来识别社交圈更符合人们对社交圈的直观理解———由于拥有紧密相连的相同关系,人们才形成了社交圈.边聚类能够有效发现重叠社交圈,因为一个顶点可以与多条边相连,当这些边属于不同圈子时,这个顶点相应也属于不同社交圈.由于在线社交网络的朋友关系是逐步建立的,用户的某个真实社交圈可能会因为其朋友之间暂时还未形成稠密连接而被忽略.为了发现这种“隐社交圈”,我们利用“有公共属性的用户更可能成为朋友并构成稠密社团”[9]这一理论,结合网络拓扑与用户特征信息,定义相邻边的相似性.边eik与边ejk的相似性定义为s(eik,ejk)=α×ts(eik,ejk)+(1-α)×fs(eik,ejk),其中,ts(eik,ejk)表示边eik与ejk的拓扑相似性,fs(eik,ejk)表示边eik与ejk的特征相似性,参数α平衡两种相似性所占比重.拓扑相似性定义为ts(eik,ejk)=|n+(i)∩n+(j)|/|n+(i)∪n+(j)|,其中n+(i)表示顶点i及其邻居的集合.特征相似性定义为fs(eik,ejk)=cos(feature(i),feature(j)),其中feature(i)是表示用户i特征信息的特征向量.可以把自我网络中用户及其朋友的所有特征信息集成到一个树型结构中,称为特征树.图2是一个自我网络特征树的示意图.在这个特征树的例子中,用户注册时需要填写职业、居住地、就读大学等信息,叶子节点表示该自我网络中至少有一个人具有这种mc-(nc-1)特征.利用特征树,自我网络中每个人的特征信息都可以用向量表示,向量长度与叶子数相等,当用户具有某个叶子节点描述的特征时,就将该用户特征向量的对应位置置1,反之置0.例如用户i毕业于复旦大学,现在在上海做一名精算师,那么i的特征向量表示为feature(i)=(01001010).需要说明的是,每个自我网络的特征树都不相同.利用连边相似度,可以用单链接分层聚类算法构建连边层次树图,并通过最大化划分密度函数来确定最优的社团划分[10].划分密度函数D=M∑mcmc-(nc-1)2团边密度的平均值.社团c的边密度定义为Dc=nc(nc-1)/2-(nc-1),这里mc表示社团c中的边数,nc表示社团c中的顶点数.该密度是在标准图密度的分子与分母上同时减去|nc-1|得到的,这种变化使得树型社团的密度为0.因为在随机网络中,树结构几乎处处可见[11],所以在真实网络中,当检测到的社团是一棵树时,有理由认为它是没有意义的.边密度函数使得树结构社团的密度为0,让树结构社团在最大化划分密度函数时不做贡献,用这样的方法避免检测到没有意义的树型社团.由于层次树图的其他分割线也能得到有意义的社团结构[12],我们简化了边社团聚类,将相似性大于某个阈值的边的集合构成一个边社团,其导出的顶点集合(即与这些边相连的顶点)就构成了一个社交圈.边聚类算法划分网络中的边,一些社团之间的边也会被看做是一个边社团.在图3所示的网络中,直观上看应该包括2个社团:由顶点1,2,3,4,5,6构成的社团1和由顶点7,8,9,10,11,12,13构成的社团2.顶点1,2的相似度很高,所以边e1,7与边e2,7属于同一类;顶点7,8的相似度很高,所以边e2,7与e2,8属于同一类.由于采用单链接分层聚类,最终边e1,7、边e2,7与边e2,8被聚为一个边社团.虽然3条边是相似的,但它们的导出顶点集合(1,2,7,8)不符合社团“内紧外松”的特点,不能作为一个社交圈.我们Page4用边聚集系数[13]过滤此类边社团,当一个边社团中大部分边的聚集系数都较小时,认为它的导出顶点集合不是社交圈.由于这种边社团规模通常较小(大部分只包括2条边),不需要对所有边社团进行判断,在本文实验中,仅对边数小于4的边社团进行筛选.基于以上分析,提出基于关系的社交圈检测算法.算法步骤如算法1所示.算法1.基于关系的社交圈检测算法.输入:用户u的自我网络G=(V,E);网络中所有顶点输出:用户u的社交圈,SC;步骤:1.初始化集合SC=;2.计算图G中所有连边对的相似度;3.初始化集合Searched_Edges=;4.FORei∈E5.IFeiSearched_Edges6.将ei添加到Searched_Edges中;7.初始化集合Edge_Circle=;//集合Edge_Circle8.将ei添加到Edge_Circle中;9.FORej∈Edge_Circle10.IF存在ek∈E且ekSearched_Edges且11.将ek添加到Edge_Circle中;12.将ek添加到Searched_Edges中;13.ENDIF14.ENDFOR15.IFsize(Edge_Circle)<4且Edge_Circle中每16.Edge_Circle=;17.ENDIF18.将Edge_Circle的导出顶点集合添加到SC中;19.ENDIF20.ENDFOR21.返回SC算法涉及3个参数:平衡参数α、相似性阈值θ和边聚集系数阈值η.平衡参数α用于调节拓扑相似性与特征相似性所占比例,其取值与网络成熟度有关.当自我网络比较成熟,即用户朋友之间的关系较为稳定时,α取值较大;而当朋友关系正在完善,很多真实的朋友在网络中并未建立连接时,α取值较小.相似性阈值θ控制社交圈的规模,当θ增大时,检测到的社交圈数目增多.边聚集系数阈值η用于过滤噪声社团,η取值越小,过滤掉的社团越可能是噪声.在后续实验中,取α=0.5,θ等于网络中所有连边对的平均相似度,η等于网络中平均边聚集系数的一半.3.2基于社交圈的朋友推荐算法基于公共邻居的朋友预测只考虑了公共朋友的个数,周涛等人[14]进一步考虑了公共朋友间的关系,认为如果两个用户共同拥有的是一些经常联系的朋友,那么他们更可能成为朋友.本文从社交圈的角度出发,更精细的分析公共朋友间的关系,认为如果两个用户的公共邻居在同一社交圈,那么他们更倾向于建立朋友关系.以图4为例,在图4(a)与图4(b)中,顶点1与顶点20都有3个公共邻居,且这些邻居互为朋友.在图4(a)中,顶点17、18、19既是顶点1的一个社交圈也是顶点20的一个社交圈,由于同一个社交圈中的用户拥有相同关系,所以可以认为顶点1与顶点20也可能拥有这种关系.在图4(b)中,公共邻居2、7、15是顶点20的一个社交圈,但分别属于顶点1的3个不同社交圈.这说明顶点20与顶点2、7、15彼此间有某种关系,而顶点1与顶点2、7、15没有这种关系,所以顶点1与顶点20可能也没有这种关系.基于以上分析,有理由认为,Page5图4(a)中的顶点1与顶点20更可能建立朋友关系.实验1进一步验证了该假设.本文利用社交圈预测用户间的朋友关系,认为两个用户的重叠社交圈个数越多、社交圈重叠朋友越多、重叠圈子中的朋友连接越紧密,他们越可能成为朋友.基于这个考虑,提出用户间的社交圈相似性.将用户u的社交圈记为uc1,uc2,…,ucp,用户v的社交圈记为vc1,vc2,…,vcq,uci与vcj重叠顶点的导出子图记为overlap_circleij,nij表示overlap_circleij中点的个数,mij表示overlap_circleij中边的条数.定义社交圈uci与vcj的重叠度为nij×(mij+1),用户u与用户v的相似性定义为i=1∑qsuv=∑p利用该定义,给出朋友推荐算法,其步骤如算法2所示.算法2.基于社交圈的朋友推荐算法.输入:用户u,用户u的社交圈uc1,uc2,…,ucp,参数k,输出:推荐给用户u的k个朋友及其所属社交圈步骤:1.初始化集合candidate,其中存储与u有公共邻居2.FORi∈candidate3.检测i的社交圈;计算sui;4.ENDFOR5.将candidate中与用户u相似性最大的k个顶点存6.FORj∈protential_friends7.将j推荐给用户u;8.建议j应属于u的社交圈中与j的社交圈重叠9.ENDFOR利用在线社交网络中用户朋友能够分类成不同社交圈这一特性,推荐有相似社交圈的用户成为朋友,推荐算法不仅能预测朋友关系,还提供新朋友所属社交圈的建议.4实验验证与结果分析4.1验证实验4.1.1实验数据本文使用YouTube用户数据集验证假设:有相似社交圈的用户更容易建立朋友关系.YouTube是一个视频共享社交网络,用户可以相互建立朋友关系,创建并加入不同的兴趣小组,用户所加入的一个兴趣小组可以看作是用户的一个社交圈.该数据来自美国东北大学AlanMislove教授工作组(http://socialnetworks.mpi-sws.org),包括1157827个用户、2987624对朋友关系和16386个兴趣小组.4.1.2实验结果实验随机采样2000000对用户,统计在有n个公共邻居的条件下,一对用户有边相连的概率pCN以及在有n个公共邻居且这n个公共邻居属于同一社交圈的条件下,一对用户有边相连的概率pCS.实验结果如表1所示.表1不同条件下一对顶点有边相连的概率比较npCN/%pCS/%同比增长/%34.0745.7057.3268.92710.47812.02913.521014.87从表1中可以看出,加上“公共邻居属于同一社交圈”的约束后,一对用户建立朋友关系的概率更大,也就是说,当一对用户有相似社交圈时,他们更容易成为朋友.特别是当n较小时,连边概率显著增大.实验结果很好地验证了本文假设.4.2社交圈检测实验4.2.1实验数据社交圈检测算法的验证数据来自斯坦福大学Leskovec教授工作组(http://snap.stanford.edu),包括Facebook中10组自我网络数据.10组自我网络中共包含4039个用户与193个社交圈.4.2.2评价标准本文利用平衡误差率BER(BalancedErrorRate)衡量一个预测社交圈p与一个真实社交圈b的相似程度[15].BER定义为通过比较预测社交圈集合P与真实社交圈集合B的相似性来验证社交圈检测算法的精确性.预测社交圈集合P与真实社交圈集合B之间的相似性定义为1-BER=maxf:P→B这里f是集合B与集合P之间的部分映射,|f|=min(|B|,|P|).当预测社交圈个数|P|小于真实社Page6交圈的数目|B|时,对每一个p∈P都要找到一个对应的b∈B.当|P|>|B|时,不惩罚多找到的社交圈,因为它们可能是还未被分组的社交圈.1-BER越大说明预测越准确.4.2.3实验结果在自我网络数据集上,本文算法平均为每个网络检测到21个社交圈,社交圈的平均规模为23,非常接近真实情况.实验比较了低秩嵌入[8]、概率模型[7]、边社团[10]与本文算法检测结果的精确性和算法在不同规模数据上的运行时间.如图5所示,我们算法的1-BER值为0.79,比边社团算法高31.7%,比低秩嵌入算法高25.4%,比概率模型算法低6.3%.虽然精确性比概率模型算法稍差,但运行时间远少于它.通过选择3个规模不等的自我网络,比较了4种算法在输入不同等级数据时的运行时间,实验结果如图6所示.在顶点数为66的网络中,本文算法运行时间不到0.1s,概率模型算法需要5s;在顶点数为159的网络中,本文算法运行时间为1.8s,概率模型算法需要76s;在顶点数为1046的网络中,本文算法运行时间为240s,而此时概率模型算法需要3h.由于对边的相似性定义更加复杂、对得到的社团过滤噪声,我们算法需要的运行时间大于边社团算法,在该实验的3个网络中,运行时间大约实验结果表明,我们的算法可以很好地平衡精是边社团算法的2倍.确性与有效性,能快速准确地识别用户社交圈.4.3朋友推荐实验4.3.1实验数据朋友推荐算法的验证数据来自美国东北大学的AlanMislove工作组(http://socialnetworks.mpi-sws.org),数据采集了在2008年12月29日~2009年1月3日这一时间段中,新奥尔良地区的Facebook朋友关系,包括63731个用户和1545685个朋友关系.本实验忽略了朋友关系的方向,将其简化为一个顶点数为63731,边数为817090的网络.需要说明的是,该数据集没有顶点的特征信息,在社交圈检测时只利用了拓扑相似性.4.3.2评价标准利用AUC与Precision指标评价朋友推荐算法.为了验证朋友推荐算法的准确性,将网络中已知的连边集E分为训练集ET和测试集EP两部分,E=ET∪EP,ET∩EP=.在计算时只使用测试边的信息,并把不属于现有边集E的任意一对顶点之间的可能连边称为不存在的边.AUC从整体上衡量预测算法的精确度[16].每次随机从测试集中选取一条边与随机选择的不存在的边进行比较:如果测试集中的边的分数值大于不存在的边的分数值,就加1分,如果两个分数值相等就加0.5分.这样独立比较n次,如果有n次测试集中的边的分数值大于不存在的边的分数值,有n次两个分数值相当,那么AUC定义为如果所有分数都是随机产生的,那么AUC=0.5.因此AUC>0.5的程度衡量了算法在多大程度上比随机选择的方法精确.Precision只考虑排在前L位的边是否准确预测[17].如果排在前L位的边中有m个在测试集中,那么Precision定义为Precision@L=m越大说明算法越倾向于把真正的朋友关系排在前面.4.3.3实验结果实验利用新奥尔良Facebook数据,通过10折交叉验证,比较了社交圈相似性、公共邻居相似性与Jaccard相似性在朋友推荐中的准确性.3种相似性的AUC值分别为0.962(社交圈相似性)、0.938(公共邻居相似性)和0.934(Jaccard相似性),社交圈Page7相似性的AUC值明显优于其他两种.在使用Precision衡量预测精度时,实验分别取L=50,L=100,L=200和L=500,结果如表2所示,在每一种情况下,社交圈相似性都明显占优.表23种相似性在不同犔取值下的犘狉犲犮犻狊犻狅狀值比较Precison公共邻居Jaccard相似性社交圈相似性L=500.5320.482L=1000.4850.437L=2000.4680.422L=5000.3140.340实验结果表明,社交圈相似性可以更准确地预测朋友关系.5总结与展望本文将用户的社交圈看作相似关系的集合,提出了基于关系的社交圈检测算法,算法结合用户特征信息与社交网络拓扑结构,定义了关系的相似性,通过聚类相似的关系,快速识别出重叠社交圈.利用有相似社交圈的用户更可能成为朋友这一假设,定义了用户间的社交圈相似性,设计了朋友推荐算法,该算法能够对新朋友所属的社交圈给出建议,实现了朋友分组的自动更新.最后用Facebook数据验证社交圈检测与朋友推荐算法的准确性,实验结果表明我们的方法能够快速检测社交圈、准确预测朋友关系.在接下来的工作中,将考虑关系的权重与方向,将算法扩展到有权重的有向网络中.致谢感谢Mislove教授,他为我们提供了用于实验验证的数据集!
