Page1基于多重解析字典学习和观测矩阵优化的压缩感知练秋生王小娜石保顺陈书贞(燕山大学信息科学与工程学院河北秦皇岛066004)摘要文中提出了一种基于子空间解析字典学习和观测矩阵优化的图像压缩感知算法.该算法根据图像的局部方向特征,将整个图像空间分成多个子空间,并且采用几何共轭梯度算法分别在各个子空间学习解析字典,以实现对不同子空间图像块的最优稀疏表示.在图像重构过程中,首先在所有的子空间对每个图像块分别进行估计,然后根据稀疏表示最小误差准则获得每个图像块的最优估计.为了进一步提高图像重构质量,文中通过对不同子空间的图像块进行线性判别分析获得优化观测矩阵.实验表明文中算法可以实现高质量的压缩感知图像重构.关键词稀疏表示;压缩感知;解析模型;解析字典;观测矩阵优化1引言传统的信号处理以奈奎斯特采样定律为基础,而压缩感知打破了只有在采样率高于信号带宽两倍Page2以利用少量观测值重构图像.在传统的压缩感知系统中,图像的重构质量与图像表示的稀疏程度密切相关,一般采用基于综合模型(SynthesisModel)的稀疏表示对图像进行稀疏编码[6].基于综合模型的稀疏表示假定信号能被分解成少量字典原子的线性组合,该模型被广泛应用于从不完备信息中重构原始图像的反问题(如图像修复、图像复原和压缩成像等).传统的压缩成像算法具有成像质量不理想,计算复杂度高等缺点.为了提高图像的重构质量,Baraniuk等人[7]利用信号的结构性提出了基于模型的压缩感知(Model-basedCompressiveSensing),并从理论上证明了基于模型的压缩感知重构所需的测量值小于传统的压缩感知算法.基于模型的压缩感知研究越来越受到人们的关注.Wu和Liu等人[8]利用小波系数的尺度混合模型描述尺度内小波系数的统计相依性,提出了多元追踪算法,有效地提高了图像重构质量.Wu和Dong等人[9]提出了基于二维分段自回归模型的自适应压缩成像(MARX)算法.孙玉宝等人[10]构建了结构自适应多成分稀疏表示模型,提出了结构自适应子空间匹配追踪算法.目前,基于综合模型的稀疏表示仍然处于不断的发展和完善的阶段.近几年,与基于综合模型的稀疏表示极其类似的模型-基于解析模型(AnalysisModel)的稀疏表示吸引了越来越多学者的关注[11].解析模型假定信号狓是由它在某个矩阵Ω(该矩阵称为解析字典或解析算子)下的变换系数Ω狓决定的.与综合模型相比,在相同维数的情况下解析模型的子空间数量更多,有更丰富和更灵活的表示能力.解析字典的学习问题是目前学者们深入研究的热点.在文献[12]中,Ophir和Elad等人采用序贯最小特征值法更新解析字典,在更新过程中,每次更新一个解析原子,迭代直到满足某种收敛准则为止.在文献[13]中,Rubinstein等人提出了使用解析K-SVD学习解析字典的算法,该算法采用l0范数作为稀疏性度量准则,利用稀疏编码和字典更新交替优化学习解析字典Ω.当Ω固定时,通过BG(Backward-Greedy)或OBG(OptimizedBackward-Greedy)等解析追踪(Analysispursuit)算法实现稀疏编码.文献[14]采用l1-范数进行稀疏性约束,用次梯度法求解相应的优化问题.为避免平凡解及某些解析原子为0的情况,Yaghoobi等人将解析字典约束到UNTF(UniformNormalizedTightFrames)上,即保证解析字典每一行的l2范数为1且列与列之间是正交的.该算法的一个缺点就是要求训练集不含噪声.为了克服该缺点,Yaghoobi等人提出了一种改进算法[15],他们利用字典学习与样本去噪交替进行的策略,用次梯度算法更新解析字典.文献[16]中Hawe等人提出的解析字典学习算法是到目前为止一个较为优秀的解析字典学习方法.该算法以lp(0<p<1)范数最小作为约束条件求解优化问题,将解析字典的学习问题归结为矩阵流形的优化问题,解析字典的转置可以看成矩阵空间中斜流形上的一个元素.在此基础上Hawe等人提出了几何共轭梯度下降法来求解斜流形上的lp(0<p<1)范数最小化问题,并通过实验验证了解析字典在图像去噪、图像修复和超分辨率分析的应用中显示的巨大潜力.本文将基于解析模型的稀疏表示理论融合到压缩感知系统中,用多重解析字典代替常规的综合字典对图像进行稀疏表示,以获得更高的图像重构质量.2基于解析模型的稀疏表示理论基于解析模型的稀疏表示也称为共稀疏解析模型(CosparseAnalysisModel)[17],在共稀疏解析模型中,假设信号狓∈犚n是共稀疏的,则可以通过变换矩阵Ω∈犚K×n将狓变换为狕=Ω狓,且变换系数向量狕中有许多零元素.变换矩阵Ω称为解析字典,Ω中的每一行代表了一个解析原子.在该模型中,强调的是变换系数狕中有许多零元素.为了避免混淆,将稀疏变换系数狕中零元素的个数l称为共稀疏度,即l=K-狕0,此时称狓是l-共稀疏的,共稀疏度在共稀疏解析模型中起着重要的作用.在变换系数狕中,所有零元素索引的集合称为狓的共支撑集Λ,即有ΩΛ狓=0.其中ΩΛ是包含了Ω中被Λ索引行的子矩阵,即信号狓所在的空间与共支撑集所决定的空间是正交的.而在基于综合模型的稀疏表示中,给定字典犇∈犚n×L(Ln),字典犇中的每一列称为一个原子,则稀疏信号狓∈犚n可以表示为字典犇中少数原子的线性组合,即狓=犇α.对比综合模型与解析模型,当字典犇是正交基时,综合模型与解析模型是完全等效的,即Ω=犇-1,综合字典犇与解析字典Ω互为逆矩阵;而当犇是冗余字典时,两个模型有本质区别[17].3基于子空间解析字典学习和观测矩阵优化的压缩感知算法本文算法的核心思想是根据图像块的方向特征将整个图像空间划分为多个子空间,分别在每个子Page3空间中学习解析字典,同时根据子空间的线性判别分析对观测矩阵进行优化,以实现图像的高质量重构.设训练集犛={狊1,狊2,…,狊N}∈犚n×N,待重构图像观测值犢={狔1,狔2,…,狔i,…},本文算法由图1所示的4部分组成.(1)图像块分类.将训练集犛分成M+1类,即犛={犛1,犛2,…,犛M,犛M+1};其中前M类为方向子空间,最后一类为不规则图像块组成的子空间;(2)多重解析字典学习.采用几何共轭梯度算法分别在每个子空间学习解析字典,得到Ωi,i=1,2,…,M,M+1;(3)观测矩阵优化.将具有类别标签的{犛1,犛2,…,犛M,犛M+1}作为训练集,利用Fisher线性判别准则优化观测矩阵Φ;(4)图像重构.利用GAP算法对图像进行重构.3.1图像块分类在基于过完备稀疏表示的图像处理中,为降低计算复杂度,一般要对图像进行分块处理.每一图像块都是整体图像中的一个局部,不同的图像块具有不同的方向特征.为实现图像块分类,先对图像块进行主方向估计[18],然后依据主方向角的不同对图像块进行分类.图像梯度可以有效地反映图像的方向特性,设图像块的梯度矩阵为犌=[犵x,犵y],对梯度矩阵进行奇异值分解:其中s1表示图像块梯度场主方向上的能量大小;s2表示与梯度场主方向垂直方向上的能量大小.在图像块分类过程中,将具有各向异性特征并且主方向唯一的结构称为方向结构,其余图像结构称为不规则结构.方向性显著的图像块在主方向上能量比较大,梯度场方向上能量比较小,而结构复杂的图像块没有明显的方向结构性.因此可以利用s1,s2的差异进行方向显著性的估计:由方向显著性判决参数R的表达式可以看出,R是有界的且取值范围在[0,1]之间.当s1s2时,R≈1,说明图像块的方向特征显著,方向一致性强.当s1≈s2时,R≈0,表明图像结构不规则,包含多个方向特征,没有明显的方向性.设定阈值τ,将Rτ的图像块集合组成的空间称为方向空间;将R<τ的图像块集合组成的空间称为不规则图像空间.式(2)中R是一个随机变量,其概率密度函数满足[19]:当阈值选择为τ时,根据式(3)可得到错误判别概率:σ=prob(Rτ|R<τ)1τfR(r)dr=-=∫式中prob为将事件R<τ错判为事件Rτ的概率;σ为期望的最大错误概率.给定期望的最大错误概率σ,则可以求得对应的阈值τ.本文选取σ=0.0001,n=64,求得τ=0.2701.式(1)中犞∈R2×2是一个正交矩阵,第1列狏1表示梯度场的主方向,将狏1旋转90°可得到图像块的主方向.由于第2列狏2与狏1是正交的,所以狏2所在方向即为图像块的主方向,狏2=[狏12,狏22]T,则图像块的主方向角θ可表示为获得每个图像块的主方向角度θ后,对其每隔180°/M(M为方向子空间个数)进行量化得到珋θ,根据量化后的角度珋θ将方向结构空间划分为M个方向子空间.设方向子空间个数为M,则整个自然图像块空间可以用形如S={S1,S2,…,SL,SM+1}的一组子空间联合表示,其中Si(i=1,2,…,M)为第i个方向子空间,SM+1为具有不规则结构图像块组成的子空间.图2为图像块的部分分类结果示意图,由图中Page4可以看出,每个方向子空间内的图像块都具有相似的方向结构特征,而不规则图像块集合中则包含了多种复杂的几何结构特征.3.2基于几何共轭梯度的解析字典学习算法在基于解析模型的稀疏表示中,解析字典Ω∈犚K×n(Kn)的学习问题可以表示为其中g是用来度量Ω犛稀疏度的函数,即其中lp范数可以是l0、l1范数等.基于几何共轭梯度的解析字典学习算法[16]使用(p,q)伪范数作为稀疏度的度量,该范数可以提高训练样本的稀疏度,还可以确保解析字典适用于大部分信号,从而提高解析字典的通用性.对于变换系数矩阵犣=Ω犛∈犚K×N,稀疏度可表示为其中0p1,q>1;狕ij表示犣的第i行第j列元素;狕j表示犣的第j列;由式(6)可以看出,Ω=0时该式取得最小值,为了避免平凡解,对Ω加3个约束条件:(1)解析字典Ω的每一行的l2范数为1,即狑i2=1,i=1,2,…,K;(2)解析字典Ω是列满秩的,即rk(Ω)=n.该约束保证对任意的训练样本狊1,狊2∈Rn,当狊1≠狊2时,均有Ω狊1≠Ω狊2;(3)解析字典Ω中没有完全相同的两个解析原子,即i≠j,狑i≠狑j,从而避免Ω狊i中出现冗余分量,保证变换系数中有尽可能多的零元素.满足列归一化的满秩矩阵的流形结构是斜流形[20],所以ΩT是斜流形OB(n,K)上的一个元素:OB(n,K)·综上所述解析字典Ω的优化问题可表示为ΩT=argminχ∈OB(n,K)其中β,μ∈犚+为正则因子,χ为斜流形OB(n,K)上的一点,h(Ω)是对Ω列满秩条件的约束:r(Ω)是对Ω第3个正则条件的约束:由于式(10)的优化问题被约束到一个光滑流形上,可以采用矩阵流形[21]优化方法求解式(10).由文献[22]可知,斜流形上的几何共轭梯度算法计算复杂度适中,收敛特性较好.使用几何共轭梯度算法优化式(10)主要包含两个步骤,一是寻找流形上的搜索方向,二是更新当前最优目标点直到满足某种收敛准则或达到最大迭代次数.实验中以Berkeley自然图像库为训练集,图像块大小为8×8,解析字典原子个数K=128,方向子空间个数M=18,依据几何共轭梯度算法分别在每个子空间学习解析字典,得到Ωi,i=1,2,…,M+1.图3为在各个子空间下学习的解析字典(图中只列出部分子空间的解析字典).从图3中可以看出,在对应方向子空间下的解析字典中包含了与该方向子空间方向特性相似的解析原子,这些原子与该方向子空间内的图像块有较大的相关性,而在不规则子空间下学习的解析字典则没有明显的方向特性.3.3观测矩阵优化由于随机高斯矩阵与正交基和过完备字典是非Page5相干的,目前在压缩感知系统中普遍采用随机高斯矩阵作为观测矩阵.研究表明,使用优化的观测矩阵可以有效地提高图像重构质量[23].在文献[23]中,作者提出了利用互相干性最小准则同时学习观测矩阵和自适应字典的有效算法,使用该算法优化的观测矩阵与(综合)字典间有更低的相干性,能获得更好的图像重构效果.但文献[23]中提出的优化观测矩阵方法是针对综合字典来设计的,并不适用于解析字典.本文基于图像块的方向特征,对图像块集合进行子空间分类,得到一系列标记子空间类别标签的图像块作为优化观测矩阵的训练集,寻找可以对训练集图像块实现Fisher线性判别[24]的投影矩阵.对于同一个子空间的两个图像块狊i,狊j,记lij=1,此时图像块狊i,狊j的投影值Φ狊i与Φ狊j应该比较接近;对处于两个不同子空间的图像块狊i,狊j,记lij=0,此时图像块狊i,狊j的投影值Φ狊i与Φ狊j差异应该较大.因此观测矩阵优化问题可表示为满足式(13)的最优解即为所求的观测矩阵.式(13)可等价成:其中矩阵犃、犅分别为如式(14)所示的广义特征系统的最大广义特征值对应的特征向量即为式(13)的最优解.设对图像块狓∈犚n进行观测得到的采样点数为m,则观测矩阵Φ为式(17)前m个最大广义特征值对应的特征向量组成的矩阵.需要注意的是当犅为奇异矩阵时,式(14)无解.为了避免这种情况,可用式(18)代替式(14)优化Φ:式中犅′是犅的正则形式.为求解犅′,先对犅进行特征值分解:令犎ii=λi,则犎′ii=max(λi,λr),其中λr为阈值常数,将特征值{λi}中小于λr的分量置为λr,则犅′=犝犎′犝T,因此可以根据式(18)得到优化的观测矩阵.图4是在不同采样率下使用上述方法优化的观测矩阵结构示意图.实验时以Berkeley自然图像库为训练集,首先根据3.1节中图像块分类方法将训练集分成M+1类,其中M=18;然后根据上述的观测矩阵优化方法优化观测矩阵.3.4图像重构要想精确重构原始图像,投影后的观测值应尽可能的保留原始图像的信息,也就是说采样后图像块观测值所属子空间的类别信息应该保持不变.因此在图像重构时,应该首先对图像块所属空间类别进行判断,然后决定使用哪个子空间的解析字典对图像块进行重构.本文提出的算法在图像重构过程中,首先利用图像块的观测值在每个子空间内分别对图像块进行估计,然后根据稀疏表示误差最小准则找到图像块的最优估计,最后对所有图像块的最优估计重新排列得到重构图像.设图像犡的分块投影[25]为犢={狔1,狔2,…,狔i,…},其中狔i=Φ狓i∈犚m×n,狓i∈犚n为第i个图像块,图像子空间总个数为M+1,在每个子空间学习的解析字典分别为Ωj,j=1,2,…,M+1,则图像犡的具体重构步骤如下:(1)根据式(20)对图像块狓i在每个子空间分别进行估计;{狓^ji}=argmin(2)根据式(21)选出图像块狓i的最优估计;{j}=argmin(3)将得到的所有图像块最优估计{狓^j列,得到重构图像.在上述的图像重构过程中,问题主要集中在步(1)中式(20)的求解,下面阐述如何对式(20)进行求解.现假设狓∈犚n是共稀疏信号,Φ∈犚m×n为观测矩阵.已知解析字典Ω∈犚K×n及狓的观测值狔=Page6Φ狓∈犚m×n(m<n),在解析模型中信号狓的重构可以描述成下述的优化问题:狓^=argmin式中g是用来度量Ω狓稀疏度的函数,即g(Ω狓)=Ω狓p(0p1),其中lp通常为l0或l1范数.本文使用GAP(GreedyAnalysisPursuit)算法[26]求解式(22)所对应的优化问题.在GAP算法中,使用l0-范数作为稀疏度度量准则,式(20)可表示为GAP算法的主要思想是:假定初始共支撑集0=[1,K],从Λ^Λ^支撑集估计Λ^往是移除与信号内积绝对值最大的解析原子.但由于实际中的信号狓是未知的,所以首要的是要获得狓的估计狓^,之后共支撑集与信号估计狓^交替更新.GAP算法的迭代过程主要如下:(1)初始化.Λ^(2)信号估计.(3)共支撑集估计.其中狑j表示解析字典Ω的第j行,即第j个解析原子;i表示第i次迭代.(4)迭代.若达到最大迭代次数或是满足停止准则,则停止迭代;否则i=i+1,回到步(2)继续迭代.在上述算法步(4)中,停止迭代准则一般可以为i<lstop、ΩΛ^Λ^其中γ,β均为数值较小的常数.另外,GAP算法迭代过程的求解主要是步(2),式(24)是一个关于狓的二次函数,可以通过对狓求导并令导数为0来求解狓:由式(26)可以看出,在求解狓^i的过程中涉及到矩阵求逆问题,在实验仿真过程中,会影响算法的运行速度.为避免矩阵求逆计算,本文在实验中采用共轭梯度下降法[27]求解式(24)中狓^i的优化问题,具体算法步骤如下:(1)初始化.狓0=0;犫=ΦT狔;搜索步长狉0=-犫,搜索方向犱0=-狉0,迭代次数t=1;(2)更新搜索步长.狉t=ΦTΦ狓t-1+λΩ狓t-1-犫;计算调整因子:α=前估计值:狓t=狓t-1+α犱t-1;更新搜索方向:犱t=-狉t+μ犱t-1,其中μ=(3)若狓t=狓t-1或达到最大迭代次数,则停止迭代;否则t=t+1,回到步(2).3.5复杂度分析大部分图像压缩感知算法使用单一字典的稀疏性进行图像重构,与本文提出的多重字典相比,单一字典学习的算法复杂度低.本文利用Fisher线性判别准则训练观测矩阵,使得同类子空间的图像块投影后的差异小,而属于不同子空间的图像块投影后的差异大,其复杂度与子空间的数量有关,子空间数越大,观测矩阵训练的复杂度越高.但字典学习和观测矩阵训练过程是离线进行的,即事先训练好字典和观测矩阵,在图像重构时直接使用训练好的字典和观测矩阵,不同的图像在重构时使用同样的字典和观测矩阵,无需重新训练字典及观测矩阵.字典训练和图像重构的复杂度与图像重构的时间开销无关,压缩感知算法的复杂度都主要体现在图像重构中.下面重点分析本文算法与实验对比用到的MLD算法[28]图像重构的复杂度.MLD算法采用与OMP算法类似的方式进行图像重构,与OMP算法不同的是在图像重构过程中从每层字典中只选取一个字典原子对图像进行重构.根据文献[29]采用的方法分析MLD算法复杂度,在图像重构过程中MLD算法的复杂度可表示为式中n为字典基原子维数,S为稀疏度,C为MLD字典的层数,L是每层字典的原子数量.本文算法采用GAP算法对图像进行重构,GAP算法的复杂度主要集中在步(2)中的信号估计,如式(24)所示.本文采用共轭梯度下降法对式(24)进行求解,由本文3.4节中共轭梯度下降算法步骤可以看出,该算法的复杂度主要是计算搜索步长狉t=ΦTΦ狓t-1+λΩ先算出来,Ω法的复杂度可近似为式中K-i+1为第i次迭代是ΩΛ^轭梯度下降算法的迭代次数.本文算法对图像进行重构时,需要对图像块在每个子空间分别进行估计.由于图像块集合分为M个方向子空间和1个不规则结构对应的子空间,共Page7计M+1个子空间,因此本文算法的计算复杂度可表示为由上式可以看出,图像重构过程的复杂度随着方向子空间数M的增加而增加.以上为算法复杂度的理论分析,实际测试结果表明,当方向子空间数为8时,本文算法的运行时间约为MLD算法的2.6倍.4实验结果为验证本文提出算法的有效性,实验中以Berkeley自然图像库为训练集,选用如图5所示的8幅标准灰度图像作为测试图像,图像大小为512×512,图像块大小为8×8.实验时首先将图像像素值归一化到0~1之间,并且去除图像块的直流分量;然后对图像分块投影,实验仿真时采样率(采样点数/像素数)分别选取0.1、0.2、0.3,解析字典原子个数K=128,并在不同个数的子空间及不同的观测矩阵条件下对本文算法的有效性进行了验证.实验时当观测矩阵为随机高斯矩阵时的实验结果为10次实验的平均值.表1为当方向子空间个数M=18,子空间总个数为19,观测矩阵分别为优化的观测矩阵及随机高斯矩阵时,本文提出算法的图像重构质量比较.由表1可以看出,使用本文优化方法得到的观测矩阵对测试图像重构,对比使用随机高斯矩阵作为观测矩阵,图像重构质量有了较大的提高.对8幅测试图像,在3种采样率下,使用本文优化观测矩阵重构图像平均PSNR值比使用随机高斯矩阵分别高出4.96dB、1.48dB、4.39dB、4.37dB、8.00dB、5.46dB、4.32dB、4.92dB.实验验证了本文优化观表1采用不同观测矩阵时图像重构质量比较(dB)图像LenaBarbaraGoldhillBoatFingerprintFlinstonesManMandrill测矩阵方法的有效性.图6为当采样率为0.2时,采用本文算法对测试图像Lena、Boat、Man、Goldhill进行重构的峰值信噪比(PSNR)与方向子空间个数(M)的关系曲线.由该图可以看出,当子空间划分的越精细,即子空间个数越多,图像重构质量逐渐提高.当方向子空间数量超过18时,重构质量基本保持稳定.图6本文算法重构性能随方向子空间数变化曲线在子空间个数分别为9,11,19这3种情况下,采用本文优化的观测矩阵对测试图像的重构质量比较如表2所示.由表2可以看出.当采样率为0.1时,子空间数对图像的重构质量变化不明显;当采样率大于0.2时,子空间数增加,图像重构质量逐渐提高.但子空间数越大,算法的复杂度也越高,根据图6的实验结果,从图像重建质量和算法复杂度两方面考虑,本文算法的子空间数选为19(其中方向子空间数为18).Page8表2采用不同子空间个数图像重构质量比较(dB)图像LenaBarbaraGoldhillBoatFingerprintFlinstonesManMandrill当观测矩阵均为优化矩阵时,表3列出了本文算法与MLD算法[28]图像重构质量比较.MLD算法主要思想是学习多层字典,根据每层字典分别自适应的优化观测矩阵[23],在图像重构过程中分别从每层字典中选取一个字典原子对图像进行重构.在实验仿真时,设MLD字典层数为16.由表3可以看出,使用本文算法进行图像重构的PSNR均值明显高于MLD算法.以Lena图像为例,采用本文算法获得的重构图像平均PSNR值比MLD算法高2.06dB.表3本文算法与MLD算法图像重构质量比较(dB)图像LenaBarbaraGoldhillBoatFingerprintFlinstonesManMandrill当观测矩阵均为优化矩阵时,在不同的采样率下,两种算法对Lena图像的重构结果(为便于观察,图像中只显示Lena图像的局部)如图7和图8所示.由图7与图8可以看出本文算法重构图像在视觉效果上明显优于MLD算法,表现在图像的边缘和纹理结构更清晰.5结论本文提出了基于多重子空间解析字典学习和观测矩阵优化的压缩感知算法.该算法利用图像块的方向特征,将图像块划分到对应的子空间中,分别在每个子空间中学习解析字典以实现对不同子空间图像块的最优稀疏表示.为了进一步提高图像重构质量,本文利用线性判别分析对观测矩阵进行优化,实现了在低采样率下的高质量图像重构.在本文提出的算法中,由于需要在每个子空间内对每个图像块分别重构并找出最优的重构结果,从而增加了计算复杂度.如何根据图像块的观测值直接判断出其所在的子空间是将来需要研究的问题.
