Page1一种抗LU攻击的传感器网络密钥预分配方案钟晓睿马春光(哈尔滨工程大学计算机科学与技术学院哈尔滨150001)摘要现有的基于矩阵LU分解的传感网密钥预分配方案容易遭受LU攻击.针对该问题,采用扰动技术干扰LU分解的结果矩阵,并结合随机共享比特串截取方法,使得共享密钥难以计算,进而提出了一种抗LU攻击的传感器网络密钥预分配方案.通过有效调节噪声因子大小、密钥组件长度、密钥组件计算轮数等参数,节点仅需预分配一定数量的密钥材料,就能以较高的安全概率建立配对密钥.经过与典型方案的对比分析与讨论,结合可行性分析,证明了所提方案不仅适用于传感器网络,更能够有效抵抗窃听攻击、LU攻击和节点捕获攻击.关键词传感器网络;密钥预分配;对密钥;LU分解;扰动技术1引言传感器网络(WirelessSensorNetworks,WSN)是由一组传感器节点以自组织的方式组成的多跳无线网络.它以协作地感知、处理并传递信息为目的,Page2预分配密钥是基于对称密码技术进行传感网密钥管理机制设计的第一步[1].密钥预分配的目的是为传感网的通信节点建立配对密钥.通常,密钥预分配方案将密钥或密钥原材料预先加载到节点,再根据约定规则选择或生成共享密钥.已有的传感网对称密钥预分配方案可以分为随机性密钥预分配和确定性密钥预分配两种类型.第一个配对密钥预分配方案,即E-G方案[2],是一种典型的随机性密钥预分配方案.随机性密钥预分配方案仅能以一定的概率在节点间建立共享密钥.这使得两个地理位置上十分接近的节点也可能无法建立安全链路.确定性密钥预分配方案克服了随机性方案的这一缺陷,它通常以牺牲存储空间为代价,为传感网提供100%的密钥连通概率.基于矩阵的密钥预分配方案是一种典型的确定性方案,以基于Blom方案[3]的密钥预分配方案(如文献[4])和基于LU分解的密钥预分配方案(如文献[5-10])为主,受到业界的广泛关注.这类方案的基本思想是将矩阵或矩阵的行列向量作为密钥材料预先加载到传感器节点,待节点布撒后再通过节点间的协商获得共享密钥.基于Blom方案的密钥预分配方案具有λ安全性,即当少于或等于λ个节点妥协时,节点间通信仍然保密.但当大于或等于λ+1个节点被捕时,秘密信息将可能迅速暴露.而且,这类方案的存储复杂度也与安全阈值λ密切相关,λ越小,存储复杂度越低,但安全性也越低;反之,λ越大,存储复杂度越高,安全性也越高.在安全性与存储复杂度之间寻求平衡,已经成为了这类方案迫切需要解决的问题.与基于Blom方案的密钥预分配方案不同,基于LU分解的方案具有易压缩性和易扩展性,不具有安全阈值.这意味着基于LU分解的方案能够很好地缩减节点所需存储空间,灵活支持网络拓扑的动态变化,并提供随被捕节点数目的增多而逐步降低的安全性.只要设计得当,基于LU分解的方案就能够在被捕节点数目超过λ的时候,以更低的存储复杂度获得更高的安全性.然而现有的基于LU分解的密钥预分配方案均无法抵抗LU攻击,其原因在于LU分解产生的结果矩阵具有线性相关性,而现有方案又均直接采用这些结果矩阵来构建共享密钥.Zhu等人[11-12]已于2009年向基于LU分解的密钥预分配方案发起了LU攻击,证明了只要攻击者收集到非零元素数目足够多的秘密向量,基于LU分解建立的共享密钥就很容易被攻击者计算获得.LU攻击已经严重威胁到基于LU分解的密钥预分配方案的安全性,为其进一步研究和应用带来了极大挑战,设计一种能够抵抗LU攻击的密钥预分配方案成为了当务之急.本文通过将扰动技术应用于矩阵构造中,打破LU分解结果矩阵间的相关性,再结合使用随机比特串截取方法削弱共享密钥对秘密矩阵的依赖性,提出一种抵抗LU攻击的密钥预分配方案.该方案能够通过噪声因子来控制密钥被干扰的位数,通过动态协商随机参数来确定共享比特串的有效片段,通过多轮密钥组件连接产生共享密钥,使得方案不仅能够抵抗窃听攻击,更具有较以往基于LU分解的方案显著提高的抗物理捕获攻击能力和抗LU攻击的能力.本文第2节在对全文符号进行统一说明的基础上,介绍了与基于LU分解的密钥预分配方案相关的现有研究;第3节详细介绍了实现抗LU攻击的密钥预分配方案的主要思路与步骤;第4、5节分析并讨论了所提方案的安全性和有效性;最后,在第6节总结全文.2相关研究为了便于讨论与分析,现对本文涉及的符号进行统一说明,如表1所示.符号犔ra犔的第a个行向量r噪声因子犝ca犝的第a个列向量sa第a个节点的ID(u)mid第u个密钥材料组ID(u)m第u个密钥材料组rd(a,b)[a,b]的随机整数B(b)b的最简形式R(k,r)扰动k的末r位clg第g个簇的ID(u)A第u组密钥材料的AA(v)第v轮的Alength(A)比特串A的实际位数Len最终密钥长度non(犃)犃的非零元个数cm(b,p,q)截取比特串b的前p-q位len密钥组件长度LU分解是将一个对称矩阵犓分解为一个下三角矩阵犔和一个上三角矩阵犝的过程.2005年,Choi和Youn[5]开创性地提出了第一个基于LU分解的密钥预分配方案.随后,他们又分别针对原来方案中LU分解矩阵构造过程的时间开销过大和需要进行认证信息交换的问题,改进了构造LU分解相关矩阵的方法[6]并提出了一个新的层级LU方案MKPS[7].2006年,Pathan等人[8]通过将LU分解结果矩阵的零元素部分按行列向量进行压缩,降低Page3了方案所需存储空间,并结合简单的认证提出了一个新的基于LU分解的密钥预分配方案.在文献[8]的基础上,Chen等人[9]在2008年将聚簇模型引入方案设计中,实现了基于LU分解的簇内密钥和簇间密钥建立.2010年,Dai等人[10]提出了一种多项式LU分解方案.该方案使用多项式替代密钥来构建LU分解的相关矩阵,使得任意两点能够通过共享多现实来动态构造共享密钥.2011年,Doraipandian等人[13]基于LU分解提出了同时支持组通信和配对节点通信的密钥管理方案,并利用ElGamal公钥加密技术加强了簇头与基站之间的通信安全性.目前的基于LU分解的密钥预分配方案建立共享密钥的方法具有一些共性,包括:(1)构建LU分解的3个n维矩阵犓,犔和犝;(2)为节点sa分配犔的第a行(犔r密,另一个公开;(3)任意两节点通过信息交换获得对方的公开向量,再与自己的秘密向量相乘得到共享密钥ka,b=犔r抵抗Zhu等人[11-12]提出的LU攻击.具体来说,LU攻击是指:根据LU分解结果矩阵犔和犝的元素满足关系la,mum,b=lb,mum,a(1a,b,mn)的原理,若存在攻击者A已知任意节点sa的行向量犔r量犝csb的公开向量犝c点sb的秘密行向量犔r前z个元素,其中a(它们的非零元素个数均为z),以及另一节点显然,当犔r可计算得到完整的犔r节点的共享密钥kb,x=犔r击者能否计算得到被攻击节点的秘密向量,取决于攻击者已经获得的秘密向量的最大非零元素个数是否大于目标向量的非零元素个数.抵抗LU攻击最直接的办法是打破秘密矩阵犔与公开矩阵犝之间的相关性,增大秘密信息的计算复杂度.扰动能够实现这一目标.2007年,Zhang等人[14]首次将扰动(Perturbation)技术引入传感网密钥预分配过程,并在第二年提出了一个认证方案[15].随后,Yu等人[16]在文献[14,17]的基础上,利用受限随机扰动技术对Blom方案[3]进行了改进,提出了CARPY(+)方案,明显提高了方案的抗毁性.虽然Albrecht等人[18]攻击了基于扰动多项式的密钥管理方案,但这种攻击仅能在参数公开、共享密钥计算方法未知的前提下,通过恢复扰动多项式来破解未妥协节点密钥.而基于LU分解的方案的密钥计算方式是公开的,参数包含秘密向量,故该攻击对破解实施在LU分解结果矩阵上的扰动是无效的.3抗LU攻击的密钥预分配方案3.1关键问题与主要思路本文解决两个关键问题:(1)如何在LU分解的基础上恰当地执行扰动,在打破LU分解结果矩阵间的相关性,增加秘密信息计算难度的同时产生共享信息;(2)如何利用共享信息建立共享密钥,削弱秘密信息与共享密钥的直接关系,降低LU攻击对方案的影响,从而增加攻破共享密钥的难度.假设传感网由m个节点I={s1,s2,…,sm}组成,初始对称矩阵犓、下三角矩阵犔和上三角矩阵犝已构造完毕且犓=犔犝.若有矩阵犓=犠犝,且其元素与犓对应位置上的元素仅最末r位不同,则任意两个获知ka,b或kb,a的节点sa和sb就能通过截取共享比特串来获得共享信息,如图1所示.令函数R(k,r)表示随机改变正整数k的二进制表示的最末r位,使其结果与k不同,如k1,2=R(k1,2,4).称r为噪声因子,狀狊为噪声矩阵,其行向量为噪声向量,犓是犓关于狀狊的受扰矩阵,犠是犔关于狀狊的受扰矩阵.sb,则一旦它们获得对方的列向量犝c,就可根据式(1)计算出对方秘密行向量犔r的元素.如s3可计若将(犔rPage4算l2,1=l3,1u1,2/u1,3=38/89×318/228=53/89,s2的其它秘密行向量元素同理可得.此时s2与任一节点sx的密钥k2,x=犔r阵狀狊扰动矩阵犔产生矩阵犠,再将犠的行向量分配给节点,此时wj,i≠wi,iui,j/ui,i≠wk,iui,j/ui,k(ui,i,ui,k≠0),LU攻击对新秘密矩阵犠=犔+狀狊失效.虽然新矩阵犓不再是对称的,但任意一对(ki,j,kj,i)的二进制表示都持有公共比特串,如k1,2≠k2,1却共享比特串10011.持有公共比特串的节点可进一步协商共享密钥.最简单的密钥产生方式是直接使用共享比特串作为共享密钥.但这种方法过分依赖噪声向量的干扰作用.矩阵犔与犝的关联性使得狀狊中任意一个噪声向量暴露,都可能导致犔矩阵的某些行向量泄露,进而导致共享密钥的泄露.因此,为了削弱共享比特串与共享密钥的直接关系,本文设计使用截取随机长度的公共比特串的方法来产生共享密钥.令B(b)表示比特串b的最简形式,函数cm(b,p,q)表示从比特串b的全部p位中去掉最末q位后的结果,其中rq<length(B(b))length(b)pLen,length(·)为比特串长度,Len为最终密钥长度.如b=01101,则B(b)=1101,length(B(b))=4,cm(b,8,3)=00001.当任意两节点需要建立共享密钥时,为了得到目标长度的密钥,需要重复生成共享比特串,多次协商合适的截取参数p和q并截取共享比特串.称单次截取到的共享比特串为一个密钥组件.3.2密钥预分配方案为了减少存储开销,本方案对所有三角矩阵的向量均采用与文献[8]相同的压缩处理,即将向量分成非零元素部分和零元素部分,并按照下述形式存储和传输:保留非零元素部分,替换零元素部分为表示零元素个数的整数.3.2.1初始化初始密钥材料:在节点部署之前,基站以离线方式为节点加载(1)产生容量为|P|的密钥池P,其中|P|表示密钥数量,且满足|P|=2q-1(q∈N+),q是一个大素数;(2)随机地从密钥池P中选择n(n+1)/2个密钥组成对称矩阵犓m×m.对犓m×m进行LU分解,产生一组下三角矩阵犔和上三角矩阵犝.选定一个噪声因子r,保证r<min{0.5q,len},len为犓中元素的最小比特长度.计算新矩阵犓={ka,b}={R(ka,b,r)}和秘密矩阵犠=犓犝-1,其中1a,bm;(3)产生截取函数cm(·,·,·)和随机数生成器rd(·,·).重复步骤(2)产生若干个密钥材料组kmg=(犓,犓,犔,犠,犝),任选其中t组{(1)kmg,(2)kmg,…,(t)kmg},为节点sa加载节点密钥材料nkm={sa,r,cm,rd,m1,a,m2,a,…,mt,a},其中mu,a=((u)mid,(u)犠r材料组中第u个密钥材料组(u)kmg的ID,(u)犠ra分别表示(u)kmg中犠的第a行和犝的第a列.(u)犝c3.2.2密钥建立初始化完成以后,每个节点均携带来自相同t个密钥材料组的密钥材料,并被随机布撒到监测区域中.令Ek{M}表示利用密钥k对消息M进行加密,反之,Dk{M}表示解密.欲建立安全链路的节点sa和sb通过ξ轮信息交互来产生共享密钥.整个过程如下:(1)在第v(1vξ)轮,节点sa决定使用预加载(2)收到消息的sb计算k(v)=((u)犠r的t个密钥材料组中的第u组,广播{(u)mid,(u)犝cl=length(k(v)),以及第v轮的共享比特串cbs(v)=cm(k(v),l,r).利用随机数生成器产生随机参数p(v)=rd(l,Len),q(v)=rd(r+1,l-1),发送消息{Ecbs(v){p(v),q(v)},(u)犝c图2给出了第v轮密钥组件k(v)cbs(v),k(v)左向箭头表示数值,双向箭头表示比特串.(3)sa计算k(v)=((u)犠rcm(k(v),l,r),从而解密消息Ecbs(v){p(v),q(v)}得到随机参数,并最终计算得到第v轮密钥组件k(v)cm(k(v),p(v),q(v)).同理sb计算得到k(v)a,b;k(v)(4)重复步骤(1)~(3),直到所有密钥组件的连接总长度length(k(1)结束.双方链接每轮产生的密钥组件得到k=a,b‖…‖k(v)k(1)即ka,b=cm(k,length(k),length(k)-Len).Page54安全分析本节主要讨论窃听攻击、LU攻击和捕获攻击对所提方案的影响,并与典型的简单LU方案[6]、MKPS方案[7]、压缩LU方案[8]、多项式LU方案[10](后统称为4种典型方案)进行对比分析.4.1窃听攻击发起窃听攻击的攻击者仅能被动监听网络中传递的消息.在4种典型方案中,密钥建立所交换的信息仅为公开的矩阵犝的向量信息.攻击者在仅窃听到公开矩阵信息而对秘密向量完全无知的情况下,无法计算共享密钥,因此这4种典型方案是抗窃听攻击的.与之类似,本文所提方案也能够很好地抵抗窃听攻击.一方面以明文方式交互的信息同样仅涉及公开矩阵犝的信息;另一方面,秘密的随机参数p和q是由最简共享比特串加密的,攻击者利用获得的公开信息也无法计算共享比特串,故无法获得p和q.综上所述,本文所提方案与4种典型方案一样,均能抵抗窃听攻击.4.2LU攻击4.2.1所提方案对LU攻击的抵抗力攻击者能够发动LU攻击的前提是已经获得了至少一个LU分解后的秘密向量,通常是犔r.称当LU攻击可行时,被攻击节点间的共享密钥仍然安全的概率为对LU攻击的抵抗性.假设进行LU分解的初始对称矩阵是m维的,目前已经有x个秘密行向量犙x=(犔r露.令non(犃)表示向量犃的非零元素个数,maxn(犙x)=max{non(犔r泄露的x个秘密向量中最大非零元素个数,它反映了攻击者对未知秘密行向量的计算能力.例如犙2={[1,0,0],[1,1,0]},maxn({犙2})=2,则发起LU攻击的攻击者最多能计算出未知行向量[·,·,·]的前两个非零元素,此时攻击者采用向量[1,1,0]进行后续攻击计算能得到最佳攻击效果.令e(A)表示A被攻破的事件,反之!e(A)表示A未被攻破事件.引理1.当发起LU攻击的攻击者已获得知识犙x时,任意一个未知行向量犔rz=m,non(犔r证明.由于犔是一个下三角矩阵,任意两个行向量拥有不同的非零元素个数.根据LU攻击原理,攻击者最多能计算得到未知秘密向量的前maxn(犙x)个元素.故当未知向量犔r数non(犔rm-maxn(犙x)个元素中有多少非零元素,仅获得前maxn(犙x)个元素.反之non(犔r者计算得到的元素已经出现了零元素,则只需继续添零就可以得到完整犔r引理2.当发起LU攻击的攻击者已获得知识犙x时,对于任意两个未暴露犔行向量的节点sa与sb,它们的未受扰比特串ka,b=犔rPr(e(犔r1,烄烅1-∑m-2烆证明.在初始对称矩阵犓中,ka,b=犔rz=xkb,a=犔rka,b暴露.否则,犔r元素.令w=min{non(犔r时,ka,b=∑z中c是能被攻击者计算得到的值,攻击者无法计算la,i,lb,i(z+1iw),ka,b仍然安全.更进一步,当m-1x,xz,wz,矩阵犓暴露,此时ka,b暴露的概率Pr(e(ka,b)|犙x)=1;否则ka,b暴露的概率为Pr(e(犔r=1-Pr(non(犔rnon(犔r=1-∑mPr(non(犔r=1-∑mz=x定理1.若网络中仅存在LU攻击,且攻击者已获得知识犙x,则任意两个受攻击节点(未暴露行向量犔r)sa和sb间共享密钥安全的概率约等于式(4).长度为Len的密钥所需进行的轮数,且第v轮产生的密钥组件k(v)b.显然攻破密钥ka,b等价于在仅知犙x的条犠(v)ra犝(v)c件下攻破每轮密钥组件.在第v轮计算中,噪声向量的干扰作用仅限于(犔(v)r着若攻击者知道犔(v)r计算犠(v)ra犝(v)c证明.由于ka,b=k(1)Page6系rq(v)<length(k(v)a,b=cm(犔(v)ra犝(v)ck(v)Pr(e(k(v)Pr(!e(ka,b)|犙x)≈1-a犝cb)2)])-1tx×Pr(e(犔rC(i)x烄x-∑i-1∏φ烆Pr(e(p),e(q)|犙x)=Pr(e(p)|e(q))Pr(e(q)|犙x)烄Pr(e(q)|犙x)=Pr(length((犔ri=2假设泄露的x个秘密向量中,属于第i个密钥材料组的秘密向量有(i)x个,节点共选用了φ(φt)(t为节点预存储的密钥材料组数)个不同的密钥材料组执行了ξ轮密钥组件计算来构建密钥ka,b,则当x<φ时至少有一轮运算的犔(v)r攻击得到,此时密钥ka,b安全,即Pr(!e(ka,b)|犙x)=1.考虑xφ的情况,仅当被选中的φ个密钥材料组均有至少一个秘密行向量犔r泄露,攻击者才有可能攻破密钥ka,b,故第i(1iφ)个密钥材料组泄露的秘密向量个数(i)x一定满足1(i)xx-∑i-1由于各轮密钥组建的计算过程相互独立,故密钥ka,b泄露的概率等于构建该密钥的每一轮密钥组件泄露概率的乘积,即Pr(e(ka,b)|犙x)=Pr(e(k(1)=Pr(e(犔(1)ra犝(1)ce(p(1)),…,e(p(ξ)),e(q(1)),…,e(q(ξ))|犙x)≈(Pr(e(p),e(q)|犙x))ξPr(e(犔(1)re(犔(ξ)r=(Pr(e(p)|e(q))Pr(e(q)|犙x))ξA(6)其中,A=Pr(e(犔(1)r由于在仅存在LU攻击的条件下,噪声因子r未知,随机变量p,q间的关系演变为0q(v)<length(cbs(v))烅烄length(cbs(v))p(v)Len+length(cbs(v))烆令E犙x[A]表示在犙x条件下A的平均值,E[A]表示所有A的平均值,故E[length((犔r犔ra犝cb的值的二进制表示的平均长度,进而有取一定会完全被抛弃,故能否攻破k(v)获得犔(v)ra犝(v)c(j)xj=1烅Pr(e(p)|e(q))=Len+length(犔r烆又由于当且仅当ξ轮计算选定的φ个密钥材料组中对应节点sa的犔r露,因此有A=Pr(e(犔(1)r=Pr(e((1)犔r=Pr(e((1)犔r对于所采用的第i个密钥材料组,行列向量积(i)犔r(i)犝ca泄露的概率Pr((i)x|犙x)与在此条件下(i)犔r露概率的乘积,如式(10)和(11)所示.Pr(e((1)犔r∑x-φ+1=∑x-φ+1Pr((1)x|犙x)Pr(e((1)犔r(1)x=1(1)x=1Page7(1)x=1=∑x-φ+1Pr(e((i)犔rx-∑i-1=∑j=1(j)x-[φ-(i-1)]+1(j)x-[φ-(i-1)]+1j=1x-∑i-1=∑Pr(e((i)犔r(j)x-[φ-(i-1)]+1j=1x-∑i-1=∑Pr(e(犔r综上所述,当前方案对LU攻击的抵抗性为Pr(!e(ka,b)|犙x)=1-Pr(e(ka,b)|犙x)(12)将式(10)、(11)代入式(9)后再将结果与式(8)一同代入式(6),最后将式(6)代入式(12)可得到Pr(!e(ka,b)|犙x)的完整数学表达如式(4)所示,定理得证.4.2.2对比分析简单LU方案[6]中任意两节点sa和sb直接采用犔r和犝c的乘积作为共享密钥,这使得该方案在攻击者已经获得犙x的情况下,密钥安全的概率Pr(!e(ka,b)|犙x)=1-Pr(e(犔rLU方案[6]、多级LU方案[8]、多项式LU方案[9]采用了不同的方法来使得通信双方能够构造犔r和犝c的乘积并作为共享密钥(共享多项式),但仍然具有公共信息一旦交互完毕,秘密信息就可计算的特性.因此它们对LU攻击具有完全相同的抵抗力.将上述4种典型方案与所提方案进行对比,结果如图3所示.参数m表示初始矩阵的维度,它等价于一个密钥材料组能够支持的最大节点数目.标识our(Len,EL,ξ,φ,t)表示所提方案使用到的参数,包括所需密钥长度Len,平均密钥组件长度EL,执行轮数ξ,涉及的互异密钥材料组数φ和预加载的密钥材料组数t.经过对比不难发现,在上述5个方案都仅采用一组密钥材料,执行一轮运算来产生共享密钥的条件下,它们对LU攻击的抵抗力均随着矩阵维度的增加而加强,随泄露秘密向量数目x的增加而削弱.但4个经典方案的LU攻击抵抗性始终低于0.3,而本文所提方案的LU攻击抵抗性却远远高于其它方案.在(Len,EL,t)=(10,5,3)时,所提方案对LU攻击的抵抗性甚至始终高于0.95,接近于1.进一步分析,在执行轮数和涉及的互异密钥材料数一定的情况下,所提方案的LU攻击抵抗性随x的增加而降低,随t的增加而加强,即使全部m个节点的秘密向量都暴露,攻击者攻破网络的概率仍然在0.5以下,这是因为攻击者还需正确获得截取参数p和q的缘故.由于所提方案能够选择加载多个不同的密钥材料组,从某种程度上来说,加大了攻击者获得同组秘密向量和正确秘密向量的概率.图4展示了所提方案对LU攻击的抵抗力随妥协节点和预加载密钥材料组数的不同而变化的趋势.显然,在等量的秘密向量被暴露的条件下,预加载了越多密钥材料组,方案的安全性也越高.图4所提方案抗LU攻击能力随x和t变化趋势Page8此外,图5和图6还进一步验证了增加执行轮数,预加载密钥材料组数,参与密钥组件计算的密钥材料组数,最终密钥长度以及平均密钥组件长度均能够有效地提高所提方案对LU攻击的抵抗力.在各维参数大于our(10,5,1,1,3)时,抵抗力始终维持在0.9以上,逼近1.图5所提方案抗LU攻击能力随计算轮数变化趋势图6所提方案抗LU攻击能力随密钥组数变化趋势综上所述,所提方案能够有效地抵抗LU攻击.4.3节点捕获攻击4.3.1所提方案对捕获攻击的抗毁性当有x个节点妥协时,未妥协节点间共享密钥泄露的概率称为方案的抗毁性.妥协节点持有的信息完全暴露给了攻击者,包括密钥材料和已经建立的密钥.现假设网络中共有x个节点被捕,组成集合C={sc1,…,scx},剩余未妥协节点组成集合UC,有节点si∈C,sa,sb∈UC,sj∈C∪UC.节点的任意一个噪声向量暴露的平均概率为引理3.当有x个节点妥协时,任意一个妥协证明.在所提方案中,被捕节点si将泄露噪声因子r、截取函数cm、随机数生成器rd、t组密钥材料中的秘密行向量(u)犠r所有密钥.受噪声矩阵影响,攻击者无法直接通过上述信息计算得到未妥协节点的犠r信息,即不能通过计算犠r考虑对第v轮密钥组件的攻击过程,攻击者已经获得了x个犠(v)r有y个的噪声向量狀狊(v)ri泄露时,攻击者可以获得对应的y个犔(v)ri=犠(v)r犔(v)ra将以Pr(e(犔(v)ra)|Qy)的概率暴露.一旦犔(v)r露,攻击者就可以计算sa与sb间的第v轮最简共享比特串cbs(v)又因为噪声因子r已知,攻击者可以1/2r的概率得到任意一个妥协节点si的未受扰密钥ki,j=犔r旦节点si的前i个未受扰密钥ki,1,…,ki,i被攻击者成功获得时,si的犔r进行计算,si的噪声向量也相应暴露.故任一妥协节点的噪声向量暴露的平均概率等于A狀狊=Pr(e(狀狊r)|e(犠r))=∑m引理4.当有x个节点妥协时,任意两节点的共享比特串暴露的概率约为Pr(e(cbs(v)y=1()x∑x证明.令Cx表示有x个节点妥协的事件,Pr(NSy|Cx)表示x个妥协节点中有y个噪声向量暴露的概率,它实际与Pr(Qy|Cx)等价(因为Pr(Qy|NSy)=1),故根据引理3容易得到cbs(v)露的概率为Pr(e(cbs(v)=∑xy=1()x≈∑x定理2.当有x个节点妥协时,任意两个未妥Pr(NSy|Cx)Pr(e(犔(v)ry=1Page9协节点间共享密钥泄露的概率为ξ()i∑ξi=0证明.攻破k(v)(1)sa与sb恰好处在对密钥建立期.攻击者能够监听并解密信息Ecbs(v){p(v),q(v)},得到共享密钥组件k(v)q(v)-r).此时攻破k(v)Pr(e(cbs(v)(2)sa与sb已经完成了对密钥建立.攻击者只能通过判定p(v)和q(v)的取值来获得共享密钥.噪声因子r和最简共享比特串cbs(v)露可缩小q(v)的猜测范围.此时攻破k(v)Pr(e(k(v)Pr(e(cbs(v)=Pr(e(cbs(v)e(cbs(v)=Pr(e(cbs(v)≈Pr(e(cbs(v)(Len-1)(E(length(犔r其中,Pr(e(p(v))|e(q(v))),Pr(e(q(v))|e(cbs(v)求解与等式组(8)相同.由于各轮密钥组件的运算是相互独立的,结合引理2容易得到所提方案的抗毁性Pr(e(ka,b)|Cx)=∑ξ4.3.2对比分析在同样基于LU分解的多项式LU方案[9]中,节点一旦被捕,攻击者将立刻获得节点的秘密列向量犝c,通过与未妥协节点交互获得对方公开行向量犔r,此时攻击者只需发动LU攻击就可能获得对方的秘密列向量,进而攻破该节点,并将攻击传递下去,最终攻破整个网络.因此,多项式LU方案对捕获攻击的抗毁性与对LU攻击的抵抗性是一致的.类似的,基础LU方案、压缩LU方案、多级LU方案都直接采用LU乘积来作为最终密钥.多项式LU方案虽然将多项式分解为LU乘积形式,LU攻击仍然能够以相同的原理计算秘密多项式,得到多((Len-1)(E(length(犔ri=0项式乘积,产生共享多项式,从而导致密钥泄露.因此4个典型方案都具有相同的抗毁性,且由于没有噪声干扰的作用,当捕获攻击发生时,将直接丢失节点的秘密向量.故它们的抗毁性与它们对LU攻击的抵抗性等价.所提方案与4个典型方案的对比结果如图7所示,其中所提方案参数为ouri(Len,EL,ξ,r),其中,下标i表示密钥ka,b的所有密钥组件已建立完成i(0iξ)个.由于其它4个方案的抗毁性仅依赖于矩阵维度m与妥协节点数x,故在其它参数变化时,它们的抗毁性都遵循同一条增长曲线:未妥协节点密钥概率从0.7开始快速增长到1.所提方案的抗毁性还受密钥和密钥组件长度、运算轮数和噪声因子大小的影响.不难发现,随着已建立密钥组件数目的增多,攻击者攻破密钥的难度逐渐加大,如果所有密钥组件都已经建立完毕后才遭到攻击,即使参数极小时,所提方案的抗毁性也极佳,密钥泄露概率接近于0.总的来说,在给定参数(Len,EL,ξ,r)的条件下,所提方案的抗毁性主要取决于密钥尚未开始建立就已遭受攻击的情况(即our0)下密钥泄露的概率.在our0下,密钥和密钥组件长度对所提方案抗毁性不产生影响,所有our0(128,64,1,3)与our0(10,5,1,3)是重合的.而扩大运算轮数ξ或扩大噪声因子r都可以明显地提高方案的抗毁性,如在x<15时,our0(128,64,4,3)的增长趋势明显缓于our0(128,64,1,3),而our0(128,64,4,5)与our0(128,64,4,3)相比,已经能够提供0.2以下的攻破概率保证.更进一步,当密钥材料支持的节点数(即矩阵维度)m=30,而已经有28个节点被捕时,所提方案仍然可以通过控制噪声因子和运算轮数来达到理想的抗毁性,如图8所示.Page10图8噪声因子与运算轮数对所提方案抗毁性的影响5性能分析5.1对比分析本文所提方案采用与压缩LU方案相同的压缩方式存储行列向量,即将向量分成零元素部分和非零元素部分,矩阵犝可以完全压缩,矩阵犠则可能由于噪声向量的加入使得零元素的出现不规律而只能完全存储.假设犠和犝矩阵的每个元素都要占据l比特,矩阵维度为m,节点预加载t组密钥材料,则所提方案的平均存储开销为Cm=tm+(m+1)整个密钥建立过程需要进行ξ轮,每轮两两节点均单播一次交换列向量信息和两个随机参数,令随机参数占据abit,单播单位比特的通信开销为u,则所提方案的通信开销为Ccmn=ξ2(1+m)令加解密运算开销为b,向量乘法运算开销为c,则所提方案的计算开销为表2是本文方案与基础LU方案、压缩LU方案、多级LU方案多项式LU方案的性能开销比较方案存储开销通信开销计算开销本文方案3lt基础LU方案[5]2mlu(m+3)lc压缩LU方案[6](m+3)lu(m+3)lc多级LU方案[8]3mlu(m+3)l2c多项式LU方案[9]2mlpu(m+3)lcp结果,其中lp,cp分别表示多项式存储开销和符号乘法运算开销.5.2方案可行性分析由于传感网是性能受限网络,本文方案又以牺牲部分性能为代价来换取安全性,故而存在由于参数选取不当而导致性能代价过高使得所提方案不再适用于传感网的可能.为了验证所提方案的可行性和有效性,本文以MICAz节点为例,利用仿真工具OMNET++4.2对所提方案在不同的参数条件(轮数、密钥长度、噪声因子等)下的网络寿命进行仿真分析.5.2.1参数选择MICAz的结构如图9所示,它拥有ATmega128L微处理器,2.4GHz的带宽,支持IEEE802.15.4协议,数据传输率为250kbps,内部存储器容量为128KB,外部存储器容量为512KB(用于数据存储),在本文中担当普通成员节点的角色,与簇头MIB520节点通过无线信道通信.根据文献[19-20],仿真分析涉及的经验参数统一在表3中给出.对于大多数传感器网络应用来说,网络的生存时间需求比网络运算速度需求更大,因此虽然AES有3种实现方式,HardwareAES、Ta-bleLookupAES和OriginalAES,本文选择了能量最有效的TableLookupAES来进行仿真分析.参数AES7.211μJ/bit单时钟周期3.5nJ/clk标量乘法10clk传输电路1.066μJ/bit电池1.5V接收电路0.533μJ/bit根据表3可知,一只普通AA电池的能量约为1.5×2.5×3600=13500J,一个普通的MICAz节点有两节AA电池,共27000J的能量.5.2.2网络规模分析AES加密方案的密钥长度常为128bit,192bit和Page11256bit.MICAz的内存容量为10.48576×105bit.图10给出了在不同密钥长度l,支持的矩阵维度m和预加载密钥组数t的条件下,所提方案预分配密钥材料所需占据的存储空间容量情况.其中(t,l)=(1,256)和(t,l)=(2,128),(t,l)=(2,192)和(t,l)=(3,128)的图像刚好重合,ROM指示MICAz的内存容量.从图10可以看出,MICAz的ROM能够支持的矩阵规模,对应的预加载密钥材料组数如表4所示.如果采取全网统一分配t组密钥材料的方式,则所提方案能够保证任意两个节点间均能够以100%的概率建立配对密钥,但所支持的网络规模将大于900,小于5400.如果选择分簇的方式构建网络,将密钥材料按组进行分配,使得组内节点间两两构建配对密钥,则每个组的规模将约为900到5400,而所提方案所支持的全网规模可以无限层级扩大.密钥长度l材料组数t支持的矩阵规模m1281922565.2.3寿命仿真分析所提方案在计算和通信上的开销将直观的表现为对节点能量的消耗,最终表现为节点的寿命长短.为此,我们利用OMNET++构建了如图11所示的仿真场景,以模拟MICAz节点连续运行所提方案的情况下能量的消耗速度.在图11中,图11(a)为某一时刻各个节点自由发起密钥更新的场景图,图11(b)为所有节点并行地在整个生命周期中随机触发密钥更新的事件序列图.全网共有50个传感器节点,均具有80m的通信半径,网络拓扑随机,节点仅与自己通信半径内的邻居节点建立配对密钥.在任意时刻,任意节点随机发起配对密钥建立事件,随机选择一个邻居节点并执行配对密钥建立过程.每个已经发起过密钥建立事件的节点每隔一段固定的时间重新发起一次密钥更新,直到节点能量耗尽退出网络.通过将更新间隔分别设置为1s,1min和10min,将能耗模型划分为信息收发能耗和计算能耗两部分,我们得到了如表5所示的仿真结果.从中容易发现,密钥组件的平均长度基本维持在所需密钥总长度一半的水平上,在所选随机执行轮数的情况下,由两节AA电池供电的传感器节点以1s的时间间隔运行所提协议时,平均存活时间约为半个月到1个月;以1min的时间间隔运行所提协议时,平均存活时间达到1年半到4年;以10min的时间间隔运行所提协议时,平均存活时间能够达到16年到39年.在实际的传感网应用中,更新间隔往往是远大于1min的,可能会是1h,1d,或者仅在必要的时Page12候才更新.可见,虽然所提方案虽然以牺牲部分性能为代价来换取安全性的显著提高,但只要更新间隔表5实验参数与结果更新间隔/s密钥总长度10min(600s)1min(60s)1s6总结与展望本文结合噪声技术与随机比特串截取方法,提出了一种新的基于LU分解的密钥预分配方案,解决了现有的基于LU分解的密钥预分配方案难以抵抗LU攻击的问题.文中详细讨论了所提方案对窃听攻击、LU攻击和节点捕获攻击的抵抗能力,并与典型LU密钥预分配方案进行了对比.结果表明所提方案能够通过牺牲少量的性能换来安全性的显著提高.随后,进一步采用理论分析与仿真分析相结合的方式,分析了在MICAz节点上运行所提方案时所能支持的网络规模和寿命情况,证明了所提方案虽然在性能上有所牺牲,但仍然适用于传感器网络.在后续的研究中,我们将以提高方案性能和为方案提供扩展性为目标,使之性能代价降低并支持节点的动态加入和离开,从而更好地适应网络拓扑结构动态变化,保证密钥的安全有效.
