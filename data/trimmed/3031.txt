Page1一种基于一致性准则的属性约简算法杨明(南京师范大学计算机科学与技术学院南京210097)(江苏省信息安全保密技术工程研究中心南京210097)摘要粗糙集方法提供了一种新的处理不精确、不完全与不相容知识的数学工具.属性约简是粗糙集理论的重要研究内容之一,已有的大多数属性约简算法主要针对离散值属性的约简,面向连续值属性的约简报道较少.为此,在引入新的对象一致性定义后,提出一种新的基于一致性准则的属性约简模型,该模型可针对离散或连续值属性进行有效的约简,是经典粗糙集属性约简模型的有效推广.依据新模型,提出了一种基于一致性准则的属性约简算法,该算法可有效进行连续值属性的约简,且通过错分对象数的控制可有效增强属性约简的有效性.理论分析和实验表明提出的算法是有效可行的.关键词粗糙集;属性约简;一致性准则1引言波兰数学家Pawlak在20世纪80年代初提出Page2要研究内容之一,也是知识获取的关键步骤.现有的属性约简大体上可分为基于差别矩阵及其改进的属性约简算法[5-9]、基于正区域的属性约简算法[10-11]、基于启发式的属性约简算法[12-13]3种,但这些基于经典Rough集模型的算法都是针对离散值属性,不适合连续值属性的约简.目前,在粗糙集理论框架下,进行连续值属性约简是当前粗糙集研究的重要内容之一,受到研究者的极大关注,取得了一定的进展[5,14-17],但现有的模型主要侧重于理论模型,相应模型下的高效算法还报道不多,这是因为研究者重点放在经典粗糙集模型的改进,如文献[16]作者提出的覆盖粗糙集的拓扑方法.从粒度计算角度来看,经典粗糙集除了需要连续属性值离散化外,采用等价关系对数据进行粒度划分不利于挖掘隐含在数据集的潜在知识,且人们认识自然也是从不同的粒度考虑的.于是,研究者提出基于覆盖的方法,这些方法是对Rough集模型的有效扩展[14-17].这些扩展的属性约简模型为我们提供了理论依据,但相应的高效属性约简算法还报道不多.为此,针对已提出的邻域覆盖模型[14,17],文献[18]提出一种基于邻域的属性约简算法,以满足连续值属性的约简需要.新模型诱导出的属性约简算法避免了连续值属性的离散化,增强了约简的有效性,为粗糙集模型下连续值属性的约简提高了一条新的途径.但该算法须求解各对象的邻域,存在计算代价高的不足,且邻域参数选择缺乏理论上的合理解释.为此,本文引入基于一致性准则的属性约简模型,该模型采用一致性对象保持策略来获取属性约简,不仅有效扩展了经典的粗糙集模型且可有效避免计算各对象的邻域,因而可有效提高属性约简的效率.基于新模型,本文提出一种基于一致性准则的属性约简算法,该算法无须计算各对象的邻域,且依据统计机器学习的间隔理论[19-20]可对参数选择在理论上给出合理的解释.实验结果表明本文算法是有效可行的.2粗糙集概念粗糙集理论的要点是将分类与知识联系在一起,并用等价类关系形式化表示分类.可理解为:知识是使用等价类R对离散空间U的划分,记为U/R={X1,X2,…,Xn},称为Xi为U/R的等价类.为节省篇幅,仅介绍和属性约简及核有关的一些概念,关于粗糙集的其它一些概念可参见文献[2-3].决策表DT是一个四元组〈U,Q,V,f〉,其中,U是一组对象的非空有限集合,称为论域;设有n个对象,则U可表示为U={x1,x2,…,xn},Q是属性集合,V=∪a∈QVa,Va为属性a的值域集;f是U×Q→V的映射.属性集合Q通常分为条件属性集C与决策属性集D.对BQ,无差别关系IND(B)定义为{(x,y)∈U2|a∈B,f(x,a)=f(y,a)},通过IND(B)将U划分为若干个类Ei(1i|U/IND(B)|).为便于叙述,设条件属性集合C中有m个属性C1,C2,C3,…,Cm,其值域为有限离散集合,并用|·|表示集合的基.不失一般性,假设仅有一个决策属性D,其取值范围是1,2,…,k.由D导出的等价类构成U的一个划分:{ψ1,ψ2,…,ψk},其中,ψi={x∈U:f(x,D)=i},i=1,2,…,k.定义1[7].在决策表DT中,对PC,若两个不同的对象x和y在属性集P下具有相同的条件属性值而具有不同的分类,则称x和y是关于P不一致的,否则称x和y是关于P一致的.定义2.设XU为论域的一个子集,PC,X的关于P的下近似为PX={x∈U:[x]pX};其中,[x]p表示U中所有与x在关系IND(P)下是等价的元素构成的集合.定义3.设PC,对划分{ψ1,ψ2,…,ψk}的P-近似精度为γP=∑k定义4.设PC,若γP=γC,且不存在RP,使得γR=γC,则称P为C的一个(相对于决策属性D的)属性约简.称满足γP=γC的条件属性子集P为候选属性约简.所有C的属性约简的交称为C的核(简称核),记为Core(C).定义5.如果属性a∈C满足γC-{a}<γC,则称属性a为不可缺少的(indispensable),否则,称属性为冗余的.性质1.属性a∈Core(C)当且仅当a是不可缺少的属性.利用定义4和定义5,研究者提出一些高效的属性约简算法(如文献[8,10-12]).然而,这些基于经典Rough集模型的属性约简算法仅适用于离散值属性的约简.因此,寻找可有效求解连续值属性的约简算法是本文的主要目标.3基于一致性准则的属性约简模型为克服经典Rough集模型的不足,研究者对Page3Rough集模型进行了扩展,使其适应连续值属性的约简,该方面的研究取得了一定的进展[14,17-18],但还有很多问题需要解决,如避免求解各对象的邻域、寻找邻域参数值在理论上的合理解释等.为此,本节在引入对象的ε-一致和ε-不一致概念后,提出基于一致性准则的属性约简模型并得到该模型下的若干性质.定义6.设DT为一决策表,PC,对两个对象x,y∈U,f(x,D)≠f(y,D),若有dP(x,y)>ε或dissimP(x,y)>ε,则称x,y在P上是ε-一致的;否则,x,y在P上是ε-不一致的,其中ε0(ε被称为一致性参数),dP(x,y)或dissimP(x,y)表示两个对象x与y之间的距离或不相似度(相离度),如dP(x,y)=maxa∈P|f(x,a)-f(y,a)|.定义7.设DT为一决策表,PC,对x∈U,若y∈U,f(x,D)≠f(y,D),有dP(x,y)>ε或dissimP(x,y)>ε,则称x在P上是ε-一致对象;否则,x在P上是ε-不一致对象(非ε-一致对象),其中,ε0,dP(x,y)或dissimP(x,y)表示两个对象x与y之间的距离或不相似度(相离度).为方便计,属性子集P(PC)上的所有ε-一致对象集和所有ε-不一致对象集分别简记为U(P,ε)和IU(P,ε).依据上述ε-一致对象和ε-不一致对象的定义,得到决策表属性约简的新定义如下.定义8.设DT=〈U,C∪D,V,f〉为一决策表,设PC,ε0,若U(P,ε)=U(C,ε)且U(O,ε)U(P,ε)(OP),则称P是C的一个约简.对定义8,我们分离散值属性和连续值属性两种情况进行分析.一方面,当决策表DT为离散值属性情况时,设ε=0,若令U中两个对象在属性子集P上的距离dP(x,y)定义为dP(x,y)=1,a∈Ps.t.f(x,a)≠f(y,a)则令[x]P={y|dP(x,y)=0}可得与定义2一致的等价关系IND(P),从而可得|U(C,0)|/|U|=γC,|U(P,0)|/|U|=γP.可见,在特定约束下,定义8与经典属性约简的定义4是一致的.因此,定义8是经典Rough集属性约简模型的推广.另一方面,对连续值属性而言,设PC,ε0,令x(x∈U)关于P的ε-邻域为NN(x,P,ε)={y|dP(x,y)ε}.对任意XU,定义X关于P的下近似为PX={x∈U|NN(x,P,ε)X},有下列引理和定理成立.引理1.若xi(xi∈U)在P上是ε-一致对象,若f(xi,D)=s,则NN(xi,P,ε)ψs.证明.反证法.若存在y∈NN(xi,P,ε),而yψs,则存在j≠s,使y∈ψj.于是,有dP(xi,y)ε成立,这与xi在P上是ε-一致对象矛盾.故NN(xi,P,ε)ψs.引理2.对给定的ε(ε0),设PC,若i≠j(1i,jk),则Pψi∩Pψj=.证明.反证法.若Pψi∩Pψj≠,必存在x∈(Pψi∩Pψj),则x∈(ψi∩ψj),这与ψi∩ψj=矛盾.定理1.对给定的ε(ε0),设PC,有U(P,ε)=∪k证明.因Pψi={x∈U|NN(x,P,ε)ψi},由引理1和定义7可知U(P,ε)∪k因Pψi中的每个对象都是ε-一致对象,故∪kU(P,ε)成立.由定理1和引理2可知,有|U(P,ε)|=∑k成立.可见,由定义8给出的属性约简模型可诱导出基于邻域的属性约简模型但无须计算各对象的邻域.也就是说,本文提出的基于一致性准则的属性约简模型仅关心不同类对象之间的可分性而无须关心同类对象之间的差别,这与统计机器学习的间隔理论是一致的.依据间隔理论,若增大不同类之间的间隔,则间隔之间的误分对象数将增加;而依据本文基于一致性准则的属性约简模型,我们采用参数ε来有效控制误分对象数并使得间隔尽可能大.为进一步分析参数ε与误分对象数之间的关系,我们给出下面的定理2.定理2.给定的ε2ε1(ε10,ε10),对任意BC,有U(B,ε2)U(B,ε1)成立.证明.若x(x∈U)在B上是ε2-一致对象,则对任意y∈U,f(x,D)≠f(y,D),有dB(x,y)>ε2,从而有dB(x,y)>ε1,因此有U(B,ε2)U(B,ε1)成立.从定理2可以看出,增大参数ε意味着间隔的增大,同时意味着误分对象数可能增大.寻找增大间隔且保持误分对象数尽可能少的属性子集是我们的一个主要目标.此外,如何依据基于一致性准则的属性约简模型快速有效求解属性子集也是本文的另一个主要目标.Page44基于一致性准则的属性约简4.1基于一致性准则的属性约简算法为快速有效地得到基于一致性准则的属性约简,需剖析属性子集不断扩展情况下一致对象集的变化(即其单调性).为此,引入下面的引理3和定理3.引理3.给定的ε(ε0),对任意AB,BC,设对dA(x,y)>ε有dB(x,y)>ε成立,若x(x∈U)是关于A的ε-一致对象,则x(x∈U)是关于B的ε-一致对象.事实上,常用的距离度量函数均满足引理3条件,如当属性子集A上的距离函数dA(x,y)定义为p-范数(p=1,2,)时,引理3的条件成立,即若dA(x,y)>ε有dB(x,y)>ε(AB),简称距离度量dB满足单调性.依据引理3可得下面的定理3.定理3.给定ε(ε0),设距离度量dB满足单调性,则对B1B2…BnC,有U(B1,ε)U(B2,ε)…U(Bn,ε)U(C,ε)成立.证明.由引理3可知,对任意AB,BC,由dA(x,y)>ε可得dB(x,y)>ε,即有U(A,ε)U(B,ε)成立.故结论成立.依据定理3,若给定的距离度量满足单调性,则通过逐步扩展重要属性即可得到一个有效的属性约简.也就是说,对已得到的一致对象集U(B,ε),我们希望扩展这样的属性a∈(C-B)使得U(B∪{a},ε)的一致对象数尽可能增多,同时希望寻找可快速求解U(B∪{a},ε)的策略.为此目的,我们引入下面的定义9、定理4和定理5.定义9.对给定的ε(ε0),BC,定义区别矩阵犕B={MB(xi,xj)}为MB(xi,xj)=定理4.对给定的ε(ε0)和属性子集B(BC),其相应区别矩阵为犕B,若对xi∈U,f(xi,D)=s(1sk),有∑U在B上是ε-一致对象;否则,xi在B上是ε-不一致对象.证明.由∑U意不同类对象xj∈U(f(xj,D)≠s)在B上是ε-一致的,因而由定义7可得xi在B上是ε-一致对象.否则,若∑UU(f(xj,D)≠s)使得MB(xi,xj)=0,即dB(xi,xj)ε,从而xi与xj在B上是ε-不一致的,进而xi在B上是ε-不一致对象.为方便计,令I(MB,xi)=∑UI(MB)=∑xi∈U区分的不同类对象数越多.定理5.对给定的ε(ε0),设距离度量d满足单调性,若已知属性子集A(AC)和B(BC)的区别矩阵分别为犕A和犕B,则属性子集A∪B的区别矩阵犕A∪B为MA∪B(xi,xj)=1,MA(xi,xj)=1或MB(xi,xj)=1,烄1,f(xi,D)≠f(xj,D)且dA∪B(xi,xj)>ε,烅0,烆其它证明.对任意两个不同类的对象xi和xj,若MA(xi,xj)=1或MB(xi,xj)=1,则因距离度量dB满足单调性,可得MA∪B(xi,xj)=1;否则,对MA(xi,xj)≠1且MB(xi,xj)≠1,计算dA∪B(xi,xj),如果dA∪B(xi,xj)>ε,那么MA∪B(xi,xj)=1;否则,MA∪B(xi,xj)=0.依据定理4,对给定的ε(ε0)和属性子集B(BC),可便捷快速求解U(B,ε).而依据定理5,可由两个属性子集上的区别矩阵犕A和犕B快速得到并集的区别矩阵犕A∪B,从而由定理4可快速求解U(A∪B,ε).进一步,结合定理3,可得如下属性重要性的评价准则:Sig(a,B,ε)=|U(A∪{a},ε)|-|U(B,ε)|(4)对式(4),由定理3知Sig(a,B,ε)0,若Sig(a,B,ε)=0,则表明属性a相对于B来说重要性为0,因而是冗余的.Sig(a,B,ε)的值越大表明属性a越重要.因此,若采用前向搜索方法,则每次希望选择重要性尽可能大的属性,直到剩余的所有属性的重要性都为0.依据上述分析,我们可得一种基于一致性准则的属性约简算法,其主要思路为:(1)对给定的决策表,初始化ε(ε0)为一个合适的值,令约简集B=,选择一个满足单调性的距离度量函数d或不相似性度量dissim;(2)计算各属性a的区别矩阵;(3)若(C-B)中存在使Sig(a,B,ε)>0最大的属性Page5a,则增加该属性a到B;否则,若对a∈(C-B),Sig(a,B,ε)都为0,则选择使得(I(犕B∪{a})-I(犕B))最大的属性a并增加到B;(4)重复(3)直到U(B,ε)=U(C,ε)为止.依据上述一致性准则及相应的属性约简思路,基于一致性准则的属性约简算法的具体描述如下.算法1.ARBCC(AttributeReductionBasedonConsistencyCriterion).输入:(1)DT=〈U,Q,V,f〉;输出:一个属性约简R主要步骤:1.a∈C:计算区别矩阵犕a;2.R=;3.计算U(C,ε);4.对a∈(C-R),计算Sig(a,R,ε);5.求使Sig(a,R,ε)最大的属性b=argmaxa∈(C-R)Sig(a,R,ε);6.ifSig(b,R,ε)>0,R=R∪{b};计算区别矩阵犕R;goto4;7.ifU(R,ε)≠U(C,ε)then7.1.对a∈(C-R),计算I(犕R∪{a});7.2.求使(I(犕R∪{a})-I(犕R))最大的属性7.3.ifI(犕R∪{b})>I(犕R)then8.Return(R).在ARBCC算法中,步5可由定理4和式(4)快速得到;步6~7中的犕R∪{b}可由定理5快速求得,因而使得ARBCC算法可有效改进属性约简的效率.由间隔理论可知,增大间隔可引起误分对象的增加,而增大一致性参数ε隐含着增大间隔,通过允许有一定数量的误分对象来合理增大间隔可有效增强分类器的推广性.我们知道一致对象数的减少意味着不一致对象的增加,而不一致对象的增加表明误分对象的增加,因而在ARBCC算法中通过控制不一致对象数可增强约简子集的有效性.因此,ARBCC算法的有效性可从统计机器学习的间隔理论角度得到合理的解释,且参数ε的值可通过误分对象数来进行有效的设置;同时,也可通过ε来有效控制误分对象数.此外,为降低区别矩阵的空间代价可采用文献[6]的压缩存储策略;限于篇幅,该部分工作将另文讨论.为便于问题的讨论,本文的实验中采用的距离度量为dB(x,y)=maxa∈B|f(x,a)-f(y,a)|(即-范数).4.2与经典Rough集及邻域模型比较基于一致性准则的属性约简模型具有以下优点:与经典Rough集及邻域模型相比,本文提出的(1)经典Rough集属性约简模型仅适用于离散值属性的约简,即连续属性须先离散化,而基于一致性准则的属性约简模型既适用离散值属性的约简,也可直接用于连续值属性的约简.基于一致性准则的属性约简模型是经典Rough集属性约简模型的有效扩展.(2)基于邻域的属性约简模型须计算各对象的邻域,而基于一致性准则的属性约简模型无须计算各对象的邻域,仅需计算不同类对象之间的相似性而不需要计算同类对象之间的相似性;同时,本文模型有效利用已得属性子集上的区别矩阵可快速求得两个属性子集的并集上的区别矩阵,因而使得由新模型诱导出的属性约简算法更加简洁快速.从时间复杂度角度来看,对一个具有N个对象k类的决策表,其中各类对象数分别为N1,N2,…,Nk(∑k对象邻域的时间复杂度至少为O(N2);而基于一致性准则的属性约简模型计算不同类对象之间相似性的时间复杂度至多为O∑1i,jk,i≠j效提高计算效率.i=1(3)在基于一致性准则的属性约简模型中,参数ε的取值可从统计机器学习的间隔理论角度进行合理的解释,并可通过误分对象数加以合理控制,因而有利于增强分类器的推广性能.实例1.假定数据集dataset是一个人工合成数据集,它是一个2维2类的数据集(第1维属性记为a,第2维属性记为b),其中第1类和第2类各有60个样本;第1类样本由高斯分布随机生成,其均向量为[3,1]、协方差阵为0.1250[由均向量为[3,2.5]、协方差阵为0.1250[高斯分布随机生成,该数据集见图1所示.为了有效解释参数ε的作用,本文给出一个简单的例子加以说明(见实例1).采用经典Rough集属性约简算法均得到属性约简{a,b}.然而,若不考虑个别对象的误分,则属性b可将图1数据集中的Page6两类对象有效区分开来,如若允许图1中两个虚线框中的4个对象误分,则可得属性约简{b};换句话说,若通过增大参数ε使得图1中两个虚线框中的4个对象为不一致对象,则有效增大两类之间的“间隔”,且可得到属性约简{b}.当然,在实际应用中,如何有效选择参数ε是一个值得研究的问题.本文的准则是希望找到“间隔”大且不一致对象数相对小情况下的参数ε,该准则符合我们的直觉.为了验证该准则的有效性,第5节将给出相关的实验结果.5实验结果5.1数据集描述为进一步验证算法的性能,本文采用网上(http://www.ics.uci.edu)提供的UCI数据集,共有11个数据集,各数据集的描述见表1.序号数据集名称对象数类别数条件属性数1PimaIndians23Heart_disease(Hd)2702134Ionosphere3512345678910Winerecognition11Waveformdomain5.2实验分析为方便计,将文献[13]提出的属性约简算法简记为Wang算法,将文献[18]提出的基于邻域的属性约简算法简记为Hu算法.我们对ARBCC算法、Wang算法及Hu算法进行了性能比较.对ARBCC算法和Wang算法,侧重比较他们的分类精度;而对ARBCC算法和Hu算法,主要比较他们的效率.为便于讨论,参数ε的取值从集合{0.25,0.22,0.2,0.15,0.13,0.11,0.1,0.08,0.05,0.02,0}中选择,并采用“间隔”大且不一致对象数相对小的属性子集选择准则.为测试ARBCC和Wang算法的性能,用表1中的前10个数据集来测试由属性子集诱导出的分类器精度.在实验中,我们采用10-fold交叉验证的平均分类精度来评价属性子集的优劣,并分别用3NN、C4.5、RBF网络(简记为RBFNN)及KSVM4个不同的分类器来评价分类精度.这里,KSVM采用核化的C-SVM,其核函数采用RBF核;分类器3NN、C4.5、RBFNN采用Weka(Version3-5)软件的缺省参数.ARBCC和Wang的分类性能测试的实验结果如表2所示.为测试ARBCC算法和Hu算法的效率,我们随机从Wave数据集中抽取500,1000,1500,2000,3000个对象构成一组实验数据,采用Matlab7.0.4实现这两种算法且比较参数ε取0.15和0.25两种情况下的算法执行效率,实验结果如图2所示.由图2可以看出,与Hu算法比,ARBCC算法有效改进了属性约简的效率,这与4.2节的理论分析是一致的.而图3和表2的实验结果则为参数ε的有效选择提供了一条新的途径,与Hu算法比,本文模型的参数值ε易于选择,具体说明如下:由图3(a)可见,随着参数ε的逐渐减小,不一致对象数也逐渐减少,即“间隔”减小意味着误分对象减少,而“间隔”增大意味着误分对象逐步增多.因此,我们希望在误分对象数较少的情况尽可能使“间隔”大.而Page7由图3(b)可见,当随着参数ε取值为0.085左右时,各分类器可取得比较满意的分类精度,而随着参数ε取值的不断减小,各分类器的精度是不断降低的,即对数据集Vehicle,ε应取[0.095,0.085]之间的表2分类性能比较数据集DiabeteGlassHdIonosphereIrisVehicleWBCDWDBCWPBCWine注:“-”表示条件属性集的基;黑色加粗表示较高识别率;ARBCC(0.15)表示当参数ε取0.15时得到的属性约简.这里的分类精度用10-fold交叉验证的平均分类精度和标准差来表示.图3由表2(表2中参数ε的值是在不一致对象数不超过8情况下得到的)可见,多数情况下,由ARBCC和Wang算法诱导出的分类器性能优于由全部属性集得到的分类器性能.进一步,对Glass,Iris,某个值.该实验结果表明,在实际应用中,若当参数值ε较小时不一致对象数仍不为0,则通过允许有一定数量不一致对象来增大参数ε.Ionosphere,WBCD,WDBC和Wine数据集而言,由ARBCC算法诱导出的分类器性能一致优于Wang算法诱导出的分类器性能;对WPBC数据集而言,由ARBCC算法诱导出的分类器性能与Wang算法Page8诱导出的分类器性能是可以比较的;对Hd和Vehi-cle而言,由ARBCC算法诱导出的分类器和Wang算法诱导出的分类器互有胜负;对Diabete而言,Wang算法得到的属性子集是整个属性集,因而由ARBCC算法诱导出的分类器性能略优于Wang算法诱导出的分类器性能.可见,总体上ARBCC算法诱导出的分类器具有较优的分类性能.而某些情况下ARBCC算法诱导出的分类器性能略低,这可能是因为这里参数ε不是最优化得到的参数引起的.综上分析,通过参数ε的选择,ARBCC算法可有效降低约简属性集的规模,改进分类器的性能,因此是经典Rough集模型的拓展和改进.当然,在实际应用中,如何更加有效选择精度参数ε,降低区别矩阵的存储代价将是我们的未来研究内容之一.6结语在引入新的一致性定义后,提出一种新的基于一致性准则的属性约简模型,该模型可针对离散或连续值属性进行有效的约简,是经典粗糙集属性约简模型的有效推广.依据新模型,提出了一种基于一致性准则的属性约简算法,该算法可有效进行连续值属性的约简,且通过错分对象数的控制可有效增强属性约简的有效性.理论分析和实验结果表明本文提出的算法是有效可行的.
