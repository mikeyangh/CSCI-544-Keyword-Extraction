Page1一个有效的多PKG环境下基于身份签密方案赵秀凤1),2)徐秋亮2)1)(信息工程大学电子技术学院郑州450004)2)(山东大学计算机科学与技术学院济南250101)摘要多PKG环境下的签密机制是域间实体认证和保密通信的有效手段.文中提出了一个新的多PKG环境下基于身份的签密方案,方案使用了Waters基于身份加密体制及现有的基于身份签密体制的构造思想,并利用“”运算和抗碰撞Hash函数消除了签密密文与明文之间的对应关系,从而保证了方案的语义安全.文中的方案实现了标准模型下的可证明CCA安全和存在不可伪造性;且当新方案退化为单个PKG环境时,与其它标准模型下的安全方案相比,该方案仍有稍高的效率.关键词基于身份签密;多PKG;双线性对;可证明安全;标准模型1引言随着新型网络计算背景的出现,跨域认证和保密通信技术成为一个关键和迫切需要解决的问题.签密能够在一个合理的逻辑步骤内同时完成数字签名和公钥加密两项功能,而其所花费的代价,要远远低于传统的先签名后加密的方法,因此它是实现既Page2人[9]分别指出该方案不满足密文不可区分性和密文不可伪造性并给出了改进的方案.但是我们发现,Zhang改进的方案依然不满足密文不可区分性,原因是敌手获得挑战密文后,通过解签密的验证等式可以验证签密密文与明文消息的对应关系,从而可以进行密文区分.最近,Li等人[10]也指出Zhang[8]给出的改进方案不满足CCA安全,同时指出Jin等人[9]的改进方案不满足不可伪造性,并基于Kiltz和Vahlis的IBE方案及Paterson和Schuldt的IBS方案给出了一个新的在标准模型下可证明安全的身份基签密方案.2010年,张波等人[11]给出了一个高效的基于身份多签密方案,但是在签密者对消息签密的过程中,不仅需要解签密者的身份信息,还需要解签密者的公钥参与运算,因此该方案涉及到公钥认证问题.上述签密方案要求所有的通信实体都必须处在一个相同的PKG(privatekeygenerator)的管理之下,极大地限制了方案的适用范围.2007年,Li等人[12]提出了可用于多域的基于身份签密方案,很好地实现了域间秘密信息既保密又认证的安全传输.该方案中域间通信的不同PKG共享相同的公共参数.随后,Li等人[13]对上述方案进行了优化,提高了计算效率,而且可以扩展到多个PKG拥有不同的系统参数.但是,Zhang等人[14]指出Li等人的两个方案在选择密文攻击下是不安全的.与此同时,闻英友等人[15]也给出了一个可用于多域的可证明安全的签密方案,并且多个PKG拥有不同的系统参数和各自的公私钥.但是上述签密方案的安全性都依赖于随机预言模型.借助于Waters的IBE体制[16]及基于身份签密方案[8-11],本文提出了一个有效的多PKG环境下基于身份签密方案,并在标准模型下对方案的CCA2安全和存在性不可伪造性进行了证明,这是第一个在标准模型下可证安全的多PKG环境下基于身份签密方案,同时也适用于单个PKG环境.2背景知识2.1双线性对设G和GT为两个素数p阶的循环群,g是群G的生成元,双线性对e是一个双线性映射e:G×G→GT,满足下面的特性:(1)双线性.对所有的u,v∈G,a,b∈Z,有e(ua,vb)=e(u,v)ab;(2)非退化性.e(g,g)不是GT的生成元;(3)可计算性.对于任何P,Q∈G,存在有效的算法计算e(P,Q).2.2DBDH假设判定双线性Diffie-Hellman(DBDH)问题.挑战者随机选择a,b,c,z∈Z如果γ=1,则输出元组(g,A=ga,B=gb,C=gc,Z=e(g,g)abc),否则输出(g,A=ga,B=gb,C=gc,Z=e(g,g)z),其中g为群G的生成元,攻击者输出对γ的猜测γ.对于多项式时间的概率算法,如果有|Pr[(g,ga,gb,gc,e(g,g)abc)=1]-则称至少以优势ε解决群G上的DBDH问题.DBDH假设.对于所有的概率多项式时间算法,优势ε是可以忽略的.2.3CDH假设计算性Diffie-Hellman(CDH)问题.群G中的CDH问题是指对于给定的随机的元组(g,ga,gb)计算出gab,其中g为群G的生成元,a,b从Z选取.一个多项式时间内的概率算法成功解决群G上的CDH问题的概率定义为AdvCDHCDH假设.对于所有的概率多项式时间算法,AdvCDH3多PKG基于身份签密的形式化模型3.1概念模型多PKG环境下基于身份的签密方案由以下5个算法构成:全局建立G-Setup,域建立D-Setup,私钥提取Extract,签密Signcrypt,解签密Unsign-crypt.全局建立G-Setup.输入安全参数,输出全局公开的系统参数params.域建立D-Setup.输入全局公开的系统参数params,每个域PKGx(x=1,2,…,l)输出一个主密钥sx和相应的域公钥Px(我们假设有l个域),公开域公钥Px,保存主密钥sx.私钥提取Extract.输入域PKGx中的身份ID,PKGx计算相应的私钥SID并通过安全信道发送给用户ID.签密Signcrypt.假设签密者为PKG1中的用户A,解签密者为PKG2中的用户B.输入全局公开的Page3系统参数params、域公钥P1和P2、签密者的私钥SIDA、待签密明文消息m以及解签密者身份信息IDB,输出签密者对消息m的签密密文σ,该算法由签密者运行.解签密Unsigncrypt.输入全局公开的系统参数params、域公钥P1和P2、签密者身份IDA、解签密者私钥SIDB和签名σ,输出明文消息m或者表示解签密失败的符号⊥.3.2安全性定义Li等人[12-13]给出了多PKG环境下基于身份签密的安全性定义,包括自适应选择密文攻击下的密文不可区分性和自适应选择消息攻击下的密文存在性不可伪造性.定义1(机密性).如果不存在多项式时间的敌手可以以不可忽略的概率赢得下面的游戏,则称多PKG环境下基于身份的签密方案(MPIDSC)在自适应选择密文攻击下具有密文不可区分性(IND-MPIDSC-CCA2).游戏参与者包括挑战者和敌手,游戏过程如下.建立.挑战者选定安全参数k,执行建立G-Setup算法和D-Setup算法,并将全局系统参数params和域公钥Px(x=1,2,…,l)发送给敌手,秘密的持有主密钥sx(x=1,2,…,l).第一阶段敌手执行多项式次数的询问,这些询问可以是自适应选择的,也就是说,每个询问都可以在前一个询问基础上进行.敌手可以进行的询问包括:私钥提取询问.敌手可以发起对任意域PKGx中任意身份ID的询问并获得与该身份信息相关的私钥SID=Extract(ID).签密询问.敌手可以发起对签密者身份IDA、接收者身份IDB和消息m的签密询问.计算SIDA=Extract(IDA)和σ=Signcrypt(m,SIDA,IDB),并将签密密文σ发送给敌手.解签密询问.敌手可以产生对签密者身份信息IDA、接收者身份IDB和签密密文σ的解签密询问.计算SIDA=Extract(IDA),并将解签密结果Unsigncrypt(σ,IDA,SIDB)发送给敌手,这个结果可能是合法的明文消息m或在σ为不合法密文情况下的符号⊥.挑战.敌手选择两个明文消息m0和m1以及他想挑战的签密者身份IDA和接收者身份IDB.注意到:他不能够在第一阶段中询问过与身份信息IDB相关的私钥.选择随机比特γ,计算签密密文σ=Signcrypt(mγ,SID第二阶段敌手可以进行和第一阶段相同的多项式次数询问,但是,他不能够发起对身份信息IDB的私钥提取询问以及对签密密文σ在接收者身份为IDB的解签密询问.猜测.最后,敌手输出对γ的猜测值γ∈{0,1},如果γ=γ,则称敌手成功.上述敌手被称为IND-MPIDSC-CCA2攻击者,敌手成功的概率优势定义为AdvIND-MPIDSC-CCA2=|Pr[γ=γ]-1/2|.定义2(不可为造性).如果不存在多项式时间的敌手可以以不可忽略的概率赢得下面的游戏,则称多PKG环境下基于身份签密方案在自适应选择消息攻击下具有密文的存在性不可伪造性(EUF-MPIDSC-CMA).游戏过程如下:.建立.挑战者选定安全参数k,执行建立G-Setup算法和D-Setup算法,并将全局系统参数params和域公钥Px(x=1,2,…,l)发送给敌手,秘密的持有主密钥sx(x=1,2,…,l).询问.如同定义2中一样,敌手可以自适应地发起多项式次数的询问.伪造.敌手产生新的元组(σ,IDA,SIDB)(即不是由签密询问得到的元组),如果解签密的结果Unsigncrypt(σ,IDA,SIDB)不是符号⊥,则称敌手成功,即敌手产生了合法的签密密文.4具体方案4.1方案描述在下面的描述中,不妨设所有的身份信息都由具有固定长度nu的字符串表示.为保证方案的通用性,可以使用抗碰撞的Hash函数完成对任意长度身份信息的处理.具体的多PKG环境下基于身份签密方案包括如下算法.G-Setup.选择素数p阶群G和GT,e:G×G→GT为双线性对,g为群G的生成元.选定随机元素g2←RG,另外,选择群G中元素u,m←RG和长度分别为nu和nm的向量ΛU=(ui),ΛM=(mi),向量中的元素为群G中的随机元素.H和Hm为密码学意义上的Hash函数,H:GT→0,{}1lt,其中lt表示明文消息长度.Hm:0,{}1lt×GT→0,{}1nm全局系统参数为params={G,GT,e,g,g2,u,ΛU,m,ΛM,Page4H,Hm}.D-Setup.每个PKGx(x=1,2,…,l)选择一个随机元素αx∈Zp并计算域公钥Px=gαx和相应的主密钥sx=gαxExtract.令u为具有长度nu的表示身份的字符串,u[i]为u的第i比特,定义{1,2,…,nu}为u[i]=1的位i的集合.为构造与身份信息u相关的私钥du,随机选择ru←Zp,并计算du=(du1,du2)=(sx(u∏i∈这里不妨设签密者Alice为域PKG1注册的用户,身份信息为uA,解签密者Bob为域PKG2注册的用户,身份信息为uB.他们的私钥分别由PKG1和PKG2生成:和dA=(dA1,dA2)=gα12u∏j∈AdB=(dB1,dB2)=gα2的域公钥,计算σ1=mH(R);其中{1,2,…,nm}为M[i]=1的位i的集合;Signcrypt.令m为待签密消息,为发送消息m给接收者Bob,签密者Alice选择随机数rm∈Zp并执行以下步骤:(1)计算R=e(P2,g2)rm,其中P2=gα2为PKG2(2)计算σ2=grm;(3)计算σ3=u∏j∈B(4)计算M=Hm(m‖R)和σ4=dA1·m∏j∈(5)σ5=dA2.最终的签密密文为σ=(σ1,σ2,σ3,σ4,σ5).Unsigncrypt.接收到签密密文σ=(σ1,σ2,σ3,σ4,σ5)后,Bob执行以下步骤进行解签密:(1)计算R=e(dB1,σ2)e(dB2,σ3)-1;(2)计算m=σ1H(R);(3)计算M=Hm(m‖R).当且仅当等式e(σ4,g)=e(P2,g2)eu∏j∈A成立时Bob接受该签密密文.4.2正确性e(dB1,σ2)e(dB2,σ3)-1方案的正确性可以由下面的等式验证=egα22,gr)eu∏j∈B2,grm)=e(gα2,g2)rm=e(P2,g2)rm=R,=e(gα2=e(gα2e(σ4,g)=edA1·m∏j∈(=egα1=e(gα1=e(gα1,g2)eu∏j∈A=e(P2,g2)eu∏j∈A4.3安全性定理1.假设存在定义1中的IND-MPIDSC-CCA2敌手,经过至多qE次私钥提取询问、qS次签密询问以及qU次解签密询问,可以以优势ε区分两个合法密文,则存在一个区分者,可以以的优势解决判定双线性Diffie-Hellman问题.证明.假设区分器获得随机双线性判定Diffie-Hellman问题实例(g,ga,gb,gc,Z∈GT),他的目标是判断等式Z=e(g,g)abc是否成立.区分器将把定义1中的IND-MPIDSC-CCA2敌手作为子过程同时充当游戏中的挑战者,具体的模拟过程如下.随机选择建立.该过程包括G-Setup和D-Setup.G-Setup.令lu=2(qE+qS+qU)和lm=2qS,(1)两个整数ku和km(0kunu,0kmnm);(2)整数x∈Zlu,一个nu维向量犡=(xi),xi∈Zlu;(3)整数z∈Zlm,一个nm维向量犣=(zj),zj∈Zlm;(4)两个整数y,w∈Zp,一个nu长度的向量犢=(yi)(yi∈Zp)和一个nm长度的向量犠=(wj)(wj∈Zp).为方便分析,对身份u和消息m分别定义函数:F(u)=-luku+x+∑i∈K(m)=-lmkm+z+∑j∈设定全局系统参数:g2=gb,u=g-nuku+xPage5m=g-nmkm+z因此对任意身份信息u和明文消息m,有u∏i∈D-Setup.随机选择i∈{1,2,…,l},设定域PKGi的公钥为Pi=ga,并诚实地计算其他每个域PKGx的公钥gαx和主密钥sx=gαx素αx∈Zp.第一阶段敌手执行多项式次数的询问,应答.私钥提取询问.当敌手对选择的身份信息u做私钥提取询问时,挑战者首先检查u所属的域,(1)如果u是域PKGx(x≠i)的用户,则随机选择ru←Zp,并计算du=(du1,du2)=gαx(2)如果u是域PKGi的用户,则检查F(u)=0modlu是否成立,如果成立,则停止游戏,如果不成立,挑战者选择随机数ru←Zp,计算du=(du1,du2)=P-J(u)并将其返回给敌手.当F(u)≠0modlu时挑战者可以产生du,这个模拟是完美的,即du是身份信息u对应的合法私钥,这是因为令r^u=ru-adu1=P-J(u)=g-a·J(u)=ga=ga=gadu2=P-1和如果F(u)=0modp,上面的计算是无法进行的,挑战者将退出游戏.为使分析更加简单,不妨设lu(nu+1)<p即0<lunu<p,容易得到-p<F(u)=-luku+x+∑i∈F(u)=0modpF(u)=0modlu.因此F(u)≠0modlu蕴含F(u)≠0modp,这样条件F(u)≠0modlu就足以保证不会在私钥提取询问过程中退出.签密询问.在任意时刻,敌手可以发起对明文信息m和身份信息uA与uB的签密询问.如果uA是域PKGi的用户且F(uA)=0modlu,则停止游戏;否则首先调用私钥提取询问产生uA对应的私钥,然后执行算法Signcrypt(m,dA,IDB)应答敌手的询问.解签密询问.在任意时刻,敌手可以发起对签密密文σ和身份信息uA与uB的解签密询问.如果uB是域PKGi的用户且F(uB)=0modlu,则停止游戏;否则,首先调用私钥提取询问产生uB对应的私钥,然后执行算法Unsigncrypt(σ,dB,uA)应答敌手的询问.挑战.经过多项式轮数的询问后,敌手选择他想挑战的身份信息uA和uB,注意到:敌手在第一阶段不能对uA和uB进行私钥提取询问.接着敌手选择两条等长的明文消息m0和m1,将其发送给挑战者.(1)如果uA不是域PKGi的用户,停止游戏;(2)如果uA是域PKGi的用户,但是F(uB)=0modlu,停止游戏;(3)如果uA是域PKGi的用户且满足F(uB)=0modlu,选择随机比特γ和随机数r∈Zp,按下列方式构造mγ对应的签密密文:计算M=Hm(mγ‖Z),令{1,2,…,nm}为M[i]=1的位i的集合.如果K(M)≠0modnm,则停止游戏.否则设定签密密文为σ=(mγH(Z),C,CJ(uP-当Z=e(g,g)abc,C=gc时,这个模拟是完美的,这是因为Z=e(g,g)abc=e(ga,gb)c=e(Pi,g2)c,CJ(uP-J(uA)i(gF(uF(uB)=P-J(uA)=g-a·J(uA)=ga第二阶段敌手可以进行和第一阶段相同的多项式次数询问,注意敌手不能发起对身份信息uB的私钥提取询问和对挑战密文的解签密询问.Page6猜测.在模拟的末尾,敌手输出对γ的猜测值γ∈{0,1},如果γ=γ,返回1表示Z=e(g,g)abc;否则返回0,作为DBDH问题的解.成功的概率.现在来计算成功的概率,为保证模拟顺利进行,在模拟过程中必须保证如下条件:(1)对身份信息u的私钥提取询问,必须满足u是域PKGx(x≠i)的用户或者u是域PKGi的用户且F(u)≠0modlu;(2)对消息m的发起签密询问,签密者的身份信息uA,必须满足uA是域PKGx(x≠i)的用户或者uA是域PKGi的用户且F(uA)≠0modlu;(3)对密文σ的解签密询问,解签密者的身份信息为uB,必须满足uB是域PKGx(x≠i)的用户或者uB是域PKGi的用户且F(uB)≠0modlu;(4)在挑战阶段,必须满足uA是域PKGi的用户且满足F(uA)≠0modp,另外K(Mγ)=0modp,其中Mγ=Hm(mγ‖Z).令u1,…,uqI为所有出现私钥提取询问中的身份信息,易得qIqE+qS+qU.定义事件如下:Ai为F(ui)≠0modlu;A为F(uB)≠0modp;B为K(Mγ)=0modp;C为u是域PKGi中的用户.这样,不会放弃模拟的概率可以表示为Pr[abort]Pr[∧qI首先,根据概率事件的分配率有(C∧Ai)∨珚C=(C∨珚C)∧(Ai∨珚C)=(Ai∨珚C),因此,Pr[∧qI因为i是独立选择的,因此,事件∧qIC是相互独立的,因此,我们有因为函数F和K是独立选择的,因此,事件∧qIA和B是相互独立的,因为ku、x和X的随机性,有Pr[A]=Pr[F(u)=0modp]同理,Pr[B]=1另一方面,对任意i,事件Ai和A均为独立的,因此有Pr[∧qI最后,可以得到挑战者不放弃模拟的概率为Pr[abort]Pr[∧qI这样,如果模拟没有被放弃,敌手可以以ε的概率赢得定义3中的游戏,那么挑战者可以解决DBDH问题实例的概率就至少为因此,提出的多PKG环境下基于身份签密方案在自适应选择密文攻击下满足密文不可区分性.定理1得证.定理2.在CDH困难问题假设下,提出的多PKG基于身份签密方案在自适应选择消息攻击下具有密文的存在性不可伪造性.假设存在定义2中的敌手,在经过至多qE次私钥提取询问,qS次签密询问以及qU次解签密询问,可以以概率ε伪造密文,则存在一个挑战者,可以以Page72qS(nm+1)+2(qE+qS+qU)(nu+1)-18lqS(qE+qS+qU)(nu+1)(nm+1)ε的优势解决计算性Diffie-Hellman问题.证明.假设存在成功的EUF-MPIDSC-CMA敌手,则可以构造挑战者,将敌手作为子程序解决CDH困难问题的实例.给定一个CDH困难问题实例:群G,生成元g,元素ga和gb,的目标是输出gab.首先如定理1中所示设定全局系统参数及域主密钥和域公钥,其中g2=gb,PKGi的域公钥为ga.在定义函数F(u),J(u),K(m)和L(m)后有u∏i∈敌手可以发起多项式次数的询问,包括私钥提取询问、签密询问和解签密询问,挑战者如定理1中方法回答询问.如果没有放弃模拟,敌手返回一个对消息m的签密密文σ,其中敌手对元组(m,uA,uB)没有询问过.可以解签密σ得到消息(m,R),计算M=Hm(m‖R),如果不同时满足下面的条件,放弃模拟:(1)uA是域PKGi中的用户;(2)F(uA)=0modp或者K(M)=0modp.否则计算并返回(σ5)J(u==Pi=gab作为CDH问题的解.成功的概率.现在来计算成功的概率,为保证模拟顺利进行,在模拟过程中必须保证如下条件:(1)对身份信息u的私钥提取询问,必须满足u是域PKGx(x≠i)的用户或者u是域PKGi的用户且F(u)≠0modlu;(2)对消息m的发起签密询问,签密者的身份信息u,必须满足u是域PKGx(x≠i)的用户或者u是域PKGi的用户且F(u)≠0modlu;(3)对密文σ的解签密询问,解签密者的身份信息为uB,必须满足uB是域PKGx(x≠i)的用户或者uB是域PKGi的用户且F(uB)≠0modlu;(4)在伪造阶段,必须满足uA是域PKGi的用户,F(uA)=0modp或者K(M)=0modp,其中M=Hm(m‖R).令u1,…,uqI为所有出现私钥提取询问中的身份信息,易得qIqE+qS+qU.定义与定理1中相同的事件Ai,A,B及C,这样,不会放弃模拟的概率可以表示为Pr[abort]Pr[∧qI=Pr[∧qIi=1(Ai∨珚C)∧C∧(A∨B)]=Pr[∧qIi=1Ai∧C∧(A∨B)]=Pr[∧qIi=1Ai∧C∧A]+Pr[∧qIPr[∧qIi=1Ai∧C∧A∧B].根据定理1中的分析,我们有i=1Ai∧C∧A]=1-qIl()uPr[∧qIi=1Ai∧C∧B]=1-qIl()uPr[∧qIi=1Ai∧C∧A∧B]=1-qIl()uPr[∧qInu+1·11从而,Pr[abort]Pr[∧qIPr[∧qI=1-qIl()u1-qIl()u1-qIl()u=1-qIl()u(1-qE+qS+qU2(qE+qS+qU2qS(nm+1)+2(qE+qS+qU)(nu+1)-1=2qS(nm+1)+2(qE+qS+qU)(nu+1)-1这样,如果模拟没有被放弃,敌手可以以ε的概率赢得定义3中的游戏,那么挑战者可以解决CDH问题实例的概率就至少为2qS(nm+1)+2(qE+qS+qU)(nu+1)-18lqS(qE+qS+qU)(nu+1)(nm+1)ε.因此,提出的多PKG环境下基于身份签密方案在自适应选择消息攻击下具有密文的存在性不可伪造性,定理2得证.Page84.4性能比较本节我们将新方案与已有的签密方案进行性能比较,注意:我们仅比较需要在线计算的运算个数,可以预先计算的运算不予统计.首先,我们将新构造的多PKG环境下签密方案与已有的RO模型下的方案[12-13,15]进行性能比较,见表1.从表1中可以看到,我们的方案在增加计算代价的基础上,实现了标准模型下的可证明安全.因此,新方案在安全性方面具有一定的优势.表1多PKG环境下基于身份签密方案的性能比较文献Li方案[12]323NoRO模型Li方案[13]314NoRO模型闻方案[15]323YesRO模型本文方案542nm+4Yes标准模型表2中我们对方案退化为单个PKG环境时与其他标准模型下基于身份的签密方案进行了比较,从中我们可以看到新方案实现了CCA安全和存在不可伪造性,在计算效率方面稍有优势.表2单个PKG环境下基于身份签密方案的性能比较文献Yu方案[8]542nm+6NoNoJin方案[9]542nm+6NoNo张方案[10]582nm+8NoYesLi方案[12]572nm+9YesYes本文方案542nm+4YesYes5结束语本文提出了一个有效的多PKG环境下基于身份签密方案,并在标准模型下对方案的CCA2安全和存在性不可伪造性进行了证明.特别的,当环境退化为单个PKG时,我们的方案也是安全有效的.下一步的工作是对各个PKG拥有不同系统参数签密方案进行深入研究.
