Page1基于内容的物联网寻径模型及节点休眠机制肖融1),2)孙波1)陈文龙3)肖永康1)魏云刚1)1)(北京师范大学信息科学与技术学院北京100875)2)(北京师范大学教育学部北京100875)3)(首都师范大学信息工程学院北京100048)摘要物联网现有的基于节点标识的寻径机制只能提供基本的传输可达性,在面向内容的监控及通告场景中传输效率较低.针对物联网最典型的树型拓扑结构,提出了基于传感内容的寻径模型(RoutingModelbasedonSensorContent,ROC),以子树为单位定期收集、汇聚传感内容值,并在树型结构中逐层实施.设计了物联网内容组播和内容任播消息的高效通告方法,利用内容寻径规则精准高效地传送消息到满足条件的节点.理论分析及真实节点组网实验验证了ROC模型能以较低的带宽和存储代价实现高效的内容寻径.根据内容敏感范围,提出了基于最大子树的节点休眠机制,可延长部分节点休眠时间.ROC模型与已有的基于节点标识的物联网路由机制完全兼容,可叠加实施,互不干扰.关键词内容组播;内容任播;寻径;休眠;物联网1引言现有的物联网寻径机制主要基于节点标识完成,如ROLL工作组为低功耗有损网络设计的RPL[1]路由协议,它在树型拓扑结构中基于节点IP标识实现路由机制.然而,普通基于节点标识的寻径机制只能提供多跳节点间的传输可达性.物联网通信有其独特性,常用于监测部署区域的特定环境参数,节点间的数据通信也主要围绕传感内容展开.例如,管控系统要监测物联子网的温度范围,并通知温度在35以上的节点实施特定处理.管控系统对高温节点发送通告消息时,并不确定消息接收端的数量及IP地址.所以,当管控系统向满足某内容规则的传感节点发送消息时,只能向所有节点通告,再由各节点分析内容规则并确定是否处理消息.显然,现有标识寻径机制无法为物联子网中基于传感内容的消息通告提供高效的传输手段.本文正是针对上述典型通信场景,提出了基于传感内容的物联网寻径体系.同时,针对有明确敏感内容范围的物联子网,设计了基于最大子树的节点休眠机制.物联网已成为环境监测的一个重要手段,并将无缝融合到互联网体系中,IP技术也逐渐成为物联网系统的主流标识技术[2-3].由于物联网节点的供电、存储、处理、带宽等核心资源极为有限[4],低代价的路由传输机制成为了学术界研究的热点.无线传感器路由模型中,最为典型的“层次结构”路由机制[5]通过层次归属关系构建传感节点的连接拓扑,实现节点与远端系统的数据通信.常见的分簇路由[6]也可算作“层次路由”的一种.“数据中心”路由协议关注传感数据,并根据传感数据实施协议交互机制的优化.其中,SPIN(SensorProtocolsforInformationviaNegotiation)[7]利用高层数据描述符对数据进行命名,称之为元数据,节点间通过协商元数据来减少网络中的冗余数据传输.LEACH(Low-EnergyAdaptiveClusteringHierarchy)[8]面向分簇网络结构,依据特定规则在簇头实现数据的聚集,减少冗余传输,提高传输效率.现有“数据中心”路由协议主要聚焦于减少冗余传感数据的上报,并未利用传感内容实现以传感节点为目标的传输寻径优化,但它仍然给本文工作提供了很好的参考.此外,节点能量也是物联网寻径重要参数.Li等人[9]利用查询消息洪泛快速建立数据转发路径,并且基于能量和路径拥塞程度建立综合路径代价模型.Machado等人[10]在传统转发跳数的基础上,结合链路质量及节点剩余能量作为评价参数,构建转发路径.Kong等人[11]分析了物联网资源的显性和隐性资源名称,并基于现有互联网资源寻址机制(包括资源搜索、域名解析等)进行扩展,提出了物联网资源寻址的通用层次模型.在IP互联网中,面向内容的路由模型也受到学术界广泛关注[12-13].DONA(Data-OrientedNetworkArchitecture)[14]是针对互联网名字解析的革新方案,它制定的互联网实体内容的名字结构包含了相应内容的HASH值.该体系,对于通信目的端的域名解析和路由可同时进行,提高了通信效率,不过DONA扁平化的名字结构导致其可扩展性不好.SIONA[15]在DONA基础上进一步将信息服务要求,如服务质量、数据安全等,加入命名体系,名字中还具有层次化特性.SIONA路由器会缓存内容数据,为某些内容请求者直接提供服务,大大提高了网络传输效率.上述工作尚难以在庞大复杂的互联网中部署,但给物联网内容寻径提供了重要参考.本文工作也会在节点中缓存内容,即传感值的范围.而且,物联子网总是在局部范围内自成体系,为内容路由方案的部署提供了便利.由于多数物联网节点都是电池供电工作,所以传感节点的节能技术尤为重要.针对周期监控型传感器网络,Wang和Wu[16]提出了基于采样周期的节点自适应休眠方法,即根据通信负载自动调整休眠时间,它并不关注传感内容值.文献[17]依据节点电量、报文传输电耗代价和报文重要性等参数,设计了传感器网络高效节能的转发机制.ContikiMAC[18]是一种广泛实施于contiki系统的节点休眠机制,它无需时间同步,节点多数时间处于休眠状态,并定期被唤醒检查是否有无线数据需要接收,一旦有接收信号,则实施数据接收并向发送者发出接收确认.对于发送者,会反复发送同一报文,直到有一个确认消息到达.本文针对物联网最常见的树型连接拓扑,提出了基于传感内容的物联网寻径模型(RoutingModelbasedonSensorContent,ROC),以子树为单位定期收集和汇聚内容传感值并由下至上层层实施,实现子树区域的传感内容值监控,并设计了物联网内容组播和内容任播消息的高效通告方法.对物联网中带宽和处理等核心资源的代价分析,确定了ROC模型的单跳链路IP传输模式.提出了ROC模型节点实现方法和相关算法,理论分析及真实节点组网Page3实验验证了ROC模型的低存储、低带宽消耗,以及高效的寻径能力.此外,针对监测内容有敏感范围的场景,为传感内容处于非敏感范围的节点设计了基于最大休眠子树的节点休眠机制,在无节点时间同步的前提下确保物联子网的最佳节能效果.本文第2节定义内容组播和内容任播消息,并提出内容寻径模型ROC;第3节针对ROC模型的单跳链路IP传输,分析并确定使用IP单播传输模式;第4节基于非敏感内容范围,设计最大子树休眠机制;第5节给出寻径模型和休眠机制的实施方法;第6节通过实验和分析验证本文内容寻径模型和节能机制的低代价及高效性;第7节总结全文.2内容寻径模型典型物联网环境中,管控系统监测区域中各节点传感值是否在特定范围,并向传感值在特定范围的节点发送通告,实施处理.通告消息主要有两种:(1)向物联子网内所有满足某约束规则的节点发出通告;(2)向任一满足某约束规则的节点发送通告.ROC模型以物联网中典型的树型结构为对象展开研究,该模型与已有物联网IP路由机制兼容,互不影响.根据习惯描述,将物联子网的树根节点称为SINK节点,它承担了物联子网与外部通信的任务,但自身不参与环境感知.定义1.传感内容约束规则定义为RL(Rule),它描述了特定传感内容取值范围.RL有两种描述类型,既可以是一段连续的传感内容值,如{x|1x100},也可以是一些离散的传感内容值的集合,如{1,5,9}.通常,在同一物联子网中使用同一类型的约束规则.本文关注传感范围,所以基于连续型约束规则进行后续分析.定义2.基于传感内容的任播消息定义为MCacast(AnycastMessageBasedonSenseContent),它由SINK节点发向任何一个满足约束规则的物联网节点.例如,发向物联子网中任一温度大于30节点的消息就是一个内容任播消息.定义3.基于传感内容的组播消息定义为MCmcast(MulticastMessageBasedonSenseContent),它由SINK节点发向一组满足约束条件的物联网节点.当约束规则为空时,MCmcast为广播消息,发向物联子网所有节点.例如,发向物联子网中所有温度大于30节点的消息就是一个内容组播消息.物联子网中,针对信息的传输方向,主要有两种消息传送:上行消息由树节点朝SINK节点方向传送,下行消息由SINK节点朝叶子方向传送(目的节点可以是非叶子节点).上行消息总是沿着父节点方向传输,与消息中的传感内容没有太大关联.因此,本文不对上行消息进行讨论,只关注定义2和定义3所述的基于传感内容的下行组播/任播消息.本文不关注物联子网外的传统寻径过程,所有下行消息都被视为由SINK节点发起.现有下行通告发送是不关注传感内容的普通IP传输模式(RoutingModelNo-ConcerningSensorContent,RON),通常由SINK节点逐跳向树节点发送消息.对于内容组播消息,由于不知道各子树的传感内容范围,节点接收消息后总是向所有子节点转发.对于内容任播消息,接收到消息的节点若满足约束规则便停止转发,否则也需向所有子节点转发消息.ROC模型实施的依据是节点传感信息,涉及子树节点传感内容的周期性收集和聚合.每一节点都代表其所辖子树,周期性地向父节点上报所辖子树的传感信息取值范围.这样,树型结构中任一节点都存有所辖各个子树的传感范围.令节点上报传感内容值的周期为Ψ,子树中各角色节点的工作分别为:(1)叶子节点.每隔时间周期Ψ,更新传感内容值并向父节点上报.(2)内部节点(既不是叶子节点、也不是SINK节点).一方面,监听子节点上报的传感信息,存储并更新每一子节点所辖子树的传感内容值.另一方面,汇聚自身和所有子节点的传感内容值,每隔时间周期Ψ向父节点上报其所辖子树的传感内容值范围.(3)SINK节点.监听并更新存储每一子树对应分别对内容组播和内容任播消息的发送情景进的传感内容值.行描述.情景1.SINK节点向物联子网发送内容组播消息MCmcast.SINK节点根据自身存储的各直连子树的传感取值范围,将消息发送到符合条件的部分子节点.接着,每个收到MCmcast消息的子节点也根据其子树的传感取值范围,将消息继续向满足约束条件的子节点发送,直至叶子节点.当消息传递到某节点,其所辖子孙节点都不满足约束条件时,消息传递便会终止.每个接收到消息的节点,还会根据自身传感值判断是否交由上层协议处理.Page4图1中,SINK节点A希望发送组播消息到所有满足内容约束规则RL1的节点,RL1为温度大于35,虚线箭头标识了发送过程.A节点会将消息发送给C、D节点,因为这两个子树包含满足RL1的节点.接着,C会发送消息给G,并继续逐跳发送到K、L、R,但节点K的子树都不满足约束条件,所以K会终止传递消息.同样,D会在其子树中逐跳发送内容组播消息至J、M、N.组播消息传递过程中,只会选择满足条件的子树传递,如C只给G发送消息,而不向H发送.而且,虽然C和J转发了消息,但由于自身温度值不满足约束规则RL1,不会将消息交由上层协议处理.情景2.SINK节点向物联子网发送内容任播消息MCacast.SINK节点根据自身存储的各个子树对应的传感取值范围,将消息发送到第一个满足约束规则的子树.此后,每个收到消息的子节点也根据各子树的传感取值范围,继续向第一个满足约束规则的子节点发送消息,直到节点自身传感值符合约束规则.任播消息传递终止于某个满足约束规则的节点,也只有它才会将消息交给上层协议处理.图1中,SINK节点A希望发送内容任播消息至满足内容约束规则RL1的节点,RL1为温度大于35,实线箭头标识了发送过程.A节点会将消息发送给C节点,该子树包含满足RL1的节点;C不满足RL1,继续转发消息到G节点;G满足约束规则RL1,不再转发消息.整个过程,只有节点G会将消息交由上层协议处理.3IP传输模式分析针对ROC模型的单跳链路IP传输,需要分析确定使用IP单播还是IP组播传输模式.为方便分析,令转发树结构为完全m叉树,即除了叶子节点,每个节点都有m个子节点.令转发树共有n+1层,第0层有1个根节点(即SINK节点),第n层是叶子节点.第1层有m个节点,第i层有mi个节点,共有节点数为∑n符号STlay(j)(RL)第j层各节点符合传感内容约束规则RL的子LminRi节点i的内容规则表容量Ba单跳发送一个内容通告消息所耗带宽ROC模型中,各节点的内容规则表中都有1项存储节点自身的传感值,非叶子节点还要存储与直连子节点数相等的内容规则项,节点规则表容量满足式(1)IP传输模式的不同,主要影响处理消息的节点数量和带宽资源的消耗.针对ROC模型中某内容规则RL,分析采用IP单播和IP组播发送通告消息的资源代价.(1)IP单播,内容组播通告一次内容组播通告中,第0层的SINK节点必须处理;第1层处理节点数为STlay(0)(RL);第2层处理节点数为STlay(0)(RL)×STlay(1)(RL);以此类推,第i层处理节点数为∏i-1播通告的处理节点数为1+∑n次内容组播通告占用带宽Ba×∑n当SINK节点发现没有符合条件的子树,则内容组播通告耗用带宽为0.(2)IP单播,内容任播通告内容任播通告总是发向某一个满足内容规则的子节点.当子网中没有满足约束规则的节点时,只有SINK节点处理,带宽消耗为0.当第1层节点中有满足规则的节点时,处理节点数为2,带宽消耗为Ba.由于SINK节点不参与环境感知,根据表1定义,一次内容任播通告涉及处理节点数为(Lmin+1),当Lmin为0时表示子网中没有符合约束规则RL的节点.同时,一次内容任播耗用带宽为(Lmin×Ba).(3)IP组播,内容组播通告利用IP组播发送消息,会导致一些无关节点处理通告消息.发送内容组播消息时,第1层有Page5STlay(0)(RL)个节点关注该通告消息,但采用IP组播会导致第1层m个节点都会处理该消息.当然,其中m-STlay(0)(RL)个节点不会往下层转发消息.所以,从第0层SINK节点至第i层,每层需要处理通告消息的节点数为1,m,m×STlay(0)(RL),m×STlay(0)(RL)×STlay(1)(RL),以此类推.显然,第i层(i2)处理节点数为m×∏i-2以,一次内容组播通告涉及处理节点数为1+m+m×∑n利用IP组播,第0层SINK节点向第1层节点发送内容消息耗用带宽为Ba;第1层有STlay(0)(RL)个节点会转发该消息,耗用带宽Ba×STlay(0)(RL);以此类推,则第i层有∏i-1消息,耗用带宽Ba×∏i-1子节点,不再转发消息.所以,总带宽消耗为Ba×(1+∑n-1i=1∏i-1(4)IP组播,内容任播通告当子网中没有满足约束规则的节点时,只有表2不同IP传输模式代价分析IP传输模式IP单播IP组播1+m+m×∑n4休眠机制面对物联网资源受限环境,实施者总是希望在保证节点感知环境的同时,能通过休眠机制延长传感节点的使用期限.ContikiMAC是现有物联网普遍使用的简单休眠方法.然而,物联子网经常会针对监测内容有明确的敏感取值范围,对于传感值处于非敏感范围的节点,网络交互极少,可实施休眠周期更长的深度休眠.为了描述方便,第4节、5节的“休眠”指深度休眠.相关符号定义如表3所示.消耗带宽STlay(j)(RL(Ba×∑ni=1∏i-1(STlay(j)(RL(i=1∏i-1定义4.Rsenstive,Rsenstive.定义物联子网实施者关注的传感取值范围为敏感内容范围,表示为Rsenstive,可具体描述为[Rsenstive.low,Rsenstive.high].Rsenstive之外的传感值被视为非敏感内容范围,记为Rsenstive.对于任一节点K,实施基于内容的休眠应满足2个条件:(1)节点K的传感内容值处于非敏感范围;(2)节点K无需为其他节点转发通告消息,即节点K所辖子树节点的传感内容值也都处于非敏感范围.节点K定期将传感值向上汇报并实施间断性休眠,节点休眠期间,由其代理节点负责与管控系统的简单交互.例如,代理节点接收敏感范围发生变化的通告,并在子节点工作状态时转发通告.因此,本文设计了针对非敏感内容节点的最大子树休眠机制(SensorNodesSleepMechanismBaseonMaximalSINK节点分析处理,带宽消耗为0.当第1层节点中有满足规则的节点时,带宽消耗为Ba;但组播传递会导致第1层所有节点处理该消息,所以处理节点数为m+1.根据表1定义,Lmin是满足规则的节点的最小层数,带宽消耗为(Lmin×Ba),处理节点数为(m×Lmin+1).如只有第n层的叶子节点满足约束规则,则带宽消耗为n×Ba,处理节点数为(m×n+1).表2对不同IP传输模式的处理代价进行了综合比较.对于内容组播通告,IP单播较IP组播涉及的处理节点略少,但消耗带宽略多.对于内容任播通告,IP单播和IP组播消耗带宽一样,但IP单播处理节点数更少.综合上述分析,本文认为ROC模型中单跳链路应使用IP单播,理由如下:(1)物联子网可同时支持多个内容约束规则通告,为避免干扰,使用IP组播需要针对不同约束规则建立多个组播组,组播组协议维护开销太大;(2)使用IP组播,会对无关节点产生干扰.当某节点向满足约束规则的部分子节点发送消息时,不满足约束规则的节点也会收到该组播消息,并需对报文分析处理,导致处理资源和电能的浪费;(3)内容任播是内容寻径体系中的重要通告,它每次只会发送给一个节点,使用IP组播会导致很高比例的无意义资源消耗.j=0j=0Page6Sub-Tree,SST),整个子树可周期性深度休眠.定义5.Rstree.子树传感内容范围定义为Rstree,它描述了以某节点为根的子树中所有节点的传感范围.如以节点K为根的子树传感内容范围记为Rstree(K),具体描述为[Rstree(K).low,Rstree(K).high],该子树中所有节点的传感值都在Rstree(K)范围.对于任何物联子网节点K,若以K为根的子树Stree(K)的节点传感值都属于非敏感内容范围,即Rstree(K)Rsenstive,则子树Stree(K)可成为一棵休眠子树.为了实施最多节点的休眠,可基于明确的传感内容敏感范围Rsenstive,确定物联子网中的所有最大休眠子树.对于任何树节点K,当式(2)成立时,以节点K为根的子树是一棵最大休眠子树.(Rstree(K)Rsenstive)∧((Rstree(P(K))Rsenstive))式(2)说明,K及其所有子孙节点传感值都属于Rsenstive.而且,其父节点P(K)所辖子树的节点传感值范围不属于Rsenstive.节点K的父节点P(K)被定义为K的休眠代理节点,P(K)启动面向Stree(K)所辖节点休眠阶段的简单管理代理.图2给出4种典型的局部拓扑,其中灰色节点表示该节点传感值属于非敏感内容范围,条纹节点为休眠代理节点.图2(a)以B为根的子树Stree(B)中所有节点可一起休眠,此时A为代理节点;图2(b)中,有两棵休眠子树Stree(C)和Stree(D),它们有共同的代理节点B;图2(c)中,3个休眠子树都只有一个节点,当休眠子树只有一个节点时,该节点必为叶子节点;图2(d)中,节点C虽然传感值属于非敏感范围,但它要为节点E、F转发数据,因此不能休眠.对于传感值处于非敏感范围的节点,管控系统通常能接受较大的监测周期.物联子网环境监测要求传感值在敏感范围的节点传感内容最大上报周期为Ts,传感值在非敏感范围节点的最大上报周期为Tn,通常Tn为Ts的若干倍,后续实验以4倍为例分析.当然,如果不分析传感内容,为了满足监测要求,只能让所有节点的上报周期为Ts.需要说明,休眠子树的代理节点会接收管控系统的敏感范围通告,一旦敏感范围发生变化,将判断是否重新构建休眠子树.另外,当休眠子树中节点的传感值不属于非敏感范围时,则在节点上报传感内容过程中,每个收到传感值的节点会停止周期性休眠,并重新构建休眠子树.5实现及算法5.1内容寻径本文基于6LoWPAN、IPv6协议设计了ROC模型的报文格式,如图3所示.报文传输层基于UDP设计,应用层协议主要包括两类消息,用2Bytes的“type”描述消息类型.“type”值为0时用于传感值上报,“Vlow”和“Vhigh”描述获取的传感内容取值范围,此时没有“othermessage”字段.“type”值为1或2时用于基于传感内容的通告下发,分别为内容任播和内容组播通告,“Vlow”和“Vhigh”描述通告目标所满足的内容规则,“othermessage”描述通告消息的相关信息,本文不分析该字段.定义6.RTC.节点中基于传感内容的寻径规则项为RTC(RoutebasedonSenseContent),记录某子节点所辖子树对应的传感内容取值范围,通过IP地址标识子节点,记为〈RL,IP〉.定义7.内容范围并操作∪.若有RLi=[Li,Hi]和RLj=[Lj,Hj],则RLi∪RLj=[min(Li,Lj),max(Hi,Hj)].举例说明,若RLi=[10,30],RLj=[20,40],则RLi∪RLj=[10,40];若RLi=[10,30]且RLj=[40,60],则RLi∪RLj=[10,60].令节点K有m个子节点,即m个子树,第i个子树的传感内容范围为RLi=[Li,Hi],表示该子树中的节点传感值介于低值Li和高值Hi之间.同时,节点K自身的传感值也融入寻径规则项存储,节点的第0项寻径规则RTC0=〈RL0,IP〉描述自身传感值.由于每个节点只有1个实时传感值,有RL0=[L0,H0],其中L0=H0.节点K的内容寻径规则表有m+1个条目,记录节点自身及各子树的传感内容范围,RTCi表示为〈RLi,IPi〉,即〈Li,Hi,IPi〉.令Li和Hi传感值描述都为16位无符号整数型变量,IPi为压缩的IPv6地址,即只存储后64bits主机Page7此外,节点K向其父节点上报所辖子树的传感位,则1条寻径规则项占用内存12Bytes.内容取值范围RLK满足式(3).RLK=RL0∪RL1∪RL2∪…∪RLm=∪m基于传感内容的通告消息,会携带内容约束规则描述的取值范围,包含低值Vlow和高值Vhigh.例如,温度介于10到30,则Vlow=10且Vhigh=30;温度大于10,则Vlow=10且Vhigh=+;温度小于10,则Vlow=-且Vhigh=10.节点收到内容通告消息后会进行寻径规则匹配,针对第i个子树的寻径规则项RTCi=〈Li,Hi,IPi〉,有图4所示6种可能的匹配结果.其中,图4(a)和图4(e)两种情况可视为第i个子树中没有任何满足内容通告的节点,而其他4种情况表示第i个子树中可能存在满足内容通告的节点.基于上述分析,算法1、2给出了ROC模型中节点对通告消息的处理算法.当接收到内容组播消息,算法1会将通告传递给所有满足内容规则的子节点;当然,若节点自身满足内容规则,还会处理该通告.当接收到内容任播消息,算法2会分析节点自身传感值,若满足内容规则则自身处理并结束算法;否则,将消息发送给第1个满足规则的子节点.算法1.intProcess_mcast_notify(MCmcast).gettheVlowandVhighoftheMCmcast;for(i=0;im;i++)if((VhighLi)&&(VlowHi))return0;算法2.intProcess_acast_notify(MCacast).gettheVlowandVhighoftheMCacast;for(i=0;im;i++)if((VhighLi)&&(VlowHi))return0;5.2节点休眠休眠机制SST总是构建最大休眠子树,使尽可能多的节点休眠,获取最佳的物联子网节能效果.首先,物联子网会根据第2节所述,完成节点传感内容的实时收集和聚合,每一节点都能获知其对应子树的传感范围.接着,由代理节点确定最大休眠子树,并逐层通告节点休眠周期.对于物联子网中任一节点K,若其满足式(4),则确定K为某最大休眠子树的代理节点.式(4)表示,以K为根的子树传感范围不属于“非敏感范围”,而存在子节点Si(K),以其为根的子树却属于“非敏感范围”.此时,K是代理节点且Stree(Si(K))是一棵最大休眠子树,Si(K)为休眠子树的树根.(Rstree(K)Rsenstive),(i)(Rstree(Si(K))Rsenstive)代理节点确定及休眠子树构建的实施方法如算法3.SINK节点配置物联子网敏感内容范围Rsenstive,SINK节点向直连子节点通告Rsenstive,并逐跳向下通告.每个获得敏感内容范围的节点(包括SINK节点),都判断自己是否需充当代理节点的角色,即判断它的子树是否是一棵休眠子树.该实施方法中,只有代理节点知道最大休眠子树的位置.休眠子树所有节点,包括树根节点,都只是根据父节点的通告,定期实施休眠行为.所以,最大休眠子树中,根节点与其他休眠节点的处理行为一样,无特殊之处.算法3.intProcess_range(Rsenstive).bool_agent=0;//初始为“非代理节点”gettheVlowandVhighoftheRsenstive;for(i=1;im;i++)return0;针对第4节所述休眠节点和非休眠节点不同的传感值上报周期,不同角色节点的具体实施方法如下:各节点启动周期性内容上报定时器,休眠子树节点为Tn,非休眠子树节点为Ts.定时器超时后向父节点上报子树传感范围;若为非叶子节点,每当收到子节点的传感内容上报消息,需要更新所辖子树传感范围.Page86实验及性能分析ROC模型中,各节点的内容规则表容量只与直连子节点数相关,不会因网络规模扩大而增加,具有很好的可扩展性.针对完全m叉树结构的物联子网,若层数为n,根据前文分析可知1条寻径规则项占用内存12Bytes,则平均每节点的内容寻径规则的存储代价为12×(m+1)×∑n-1ROC模型中平均每节点所需内容规则表存储代价随节点分支数变化的关系如图5所示.对于1层~5层的传感树,每节点平均存储代价都不超过20Bytes,可见ROC模块带来的节点存储开销不大.ROC模型需要SINK之外的各节点定期向父节点上报子树传感范围,由图3可知每次上报消耗38Bytes.不考虑休眠机制,上报周期统一为Ts,各节点内容上报消耗带宽为(38×8/Ts)bps.传感范围上报周期Ts根据不同的需求可设定为不同的值,令Ts为20s,则节点带宽消耗为15.2bps.可见,ROC模型的带宽代价也很小.基于真实节点构建实验环境,实验节点规格如表4所示,并利用串口将ARM11开发板和传感节点集成实现SINK节点功能.实验通过在节点链路层实施MAC地址过滤,强制指定链路层邻居关系,生成了图6所示的典型网络拓扑.处理器链路层协议传输速率操作系统网络协议环境传感实验中各节点随机产生一个31~40的温度值,并设置内容约束规则为大于35.各节点统计从父节点接收到的内容通告消息字节数.图7、图8分别是1次内容组播和内容任播实验中物联子网的总接收带宽统计.针对内容组播通告,ROC模型与不关注内容的RON模型(第2节已描述)比较,能节省约一半的带宽.在内容任播通告过程中ROC模型节省的带宽更为明显.实验中满足约束规则的节点所处的位置对实验结果会产生一定的影响,此外无线传输丢包现象也会影响带宽统计.通过同样的实验来分析1次内容通告涉及的处理节点数.内容组播实验结果如图9所示,内容无关的数据转发过程中,节点无法确定其下层节点是否满足约束规则,总是让所有子节点参与处理,偶尔的丢包现象会导致统计的节点数减少.与之不同,ROC模型能利用规则表只向满足规则的目标节点发送,大大减少了处理节点数.内容任播实验如图10所示,ROC模型最多只需3个节点的处理就Page9能使通告消息到达目标节点,而RON却会向所有子节点发送,虽然节点满足约束规则后会终止传递,但其他发送分支却可能还在传递,耗费许多不必要的处理资源.综上可见,ROC模型能高效、快速地通知到满足内容约束规则的节点.针对休眠机制的分析,利用万用表对表4所述图11SST节点休眠机制示例网络节点进行了能耗测量.节点休眠状态实施PM2供电模式①,休眠状态的电流为1.9mA,电压为3.6V,功率为0.00684W;节点非休眠状态的电流为30mA,电压为3.34V,功率为0.10020W.需要说明,节点非休眠状态时,无论是否收发报文,其能耗基本一样.基于上述数据,分析比较普通ContikiMAC休眠模式及在该模式下实施SST机制的节点能耗.根据文献[15],接收节点每个休眠周期都会有0.884ms的信号监听时间.令接收节点休眠周期为1s,即每1s会唤醒0.884ms来监听是否有数据要接收.此外,由于接收节点休眠周期为1s,则发送节点每次发送报文的尝试时间取0~1s的平均值为0.5s.基于MATLAB进行节能分析,网络拓扑如图11,随机生成节点温度值,并假设温度不变.普通ContikiMAC休眠模式不关注节点传感内容值,传感内容上报周期为Ts.此外,SST机制基于Con-tikiMAC实施基于内容的休眠机制,节点按5.2节所述规则实施传感值上报.分析不同机制下的节点能耗.图12中是Ts=5s,Tn=20s时两种机制的能耗分析,SST机制下有9个节点能耗明显低于Con-tikiMAC,而且这些节点几乎能达到能耗减半的效果.显然,各种模式下的休眠效果与传感内容上报周期密切相关.基于图11的拓扑结构,随机生成10组不同的节点温度,其他规则均不变,图13显示了SST机制相对普通ContikiMAC机制,能使20%~40%节点更高效地休眠.①http://www.ti.com/lit/ds/symlink/cc2530.pdfPage107总结现有物联网主要以节点标识为依据实施寻径机制,这无法与物联网基于内容的监控及通告场景紧密结合,在消息通告传输时无法基于内容规则提升发送效率.本文针对最常见的树型拓扑结构,提出了基于传感内容的物联网寻径模型ROC,以子树为单位定期收集、汇聚传感内容取值范围,并在树结构中由下至上层层实施.ROC模型能以子树为单位实时获取所辖节点的传感内容范围.更为重要的是,ROC模型发送内容组播消息和内容任播消息时,能利用节点内容规则项精准高效地传送消息到满足规则的目标节点.本文对协议维护、数据带宽、节点处理等核心资源进行了分析,认为内容组播和内容任播消息的单跳链路传输应使用IP单播传输模式完成.本文还设计了内容消息报文格式和节点对通告消息的处理算法,并在真实物联网节点中完成内容寻径模型的实现.理论分析和真实组网实验说明,内容寻径模型的开销很小,但却能方便地监测传感内容并高效发布内容组播或内容任播消息.针对有指定敏感范围的内容监测场景,设计了基于最大子树的节点休眠机制,在无时间同步环境下能利用最少的代理节点实施最多节点的高效休眠.需要说明,ROC模型与已有的基于节点标识的物联网路由机制完全兼容,可叠加实施,互不干扰.例如,对于非内容通告消息或内容通告之后的网络行为,仍可沿用传统的标识路由通信机制.当然,即便没有传统路由机制,ROC模型也能正常实施.此外,ROC模型还可简单地扩展为针对多种传感内容的方案,既可以针对不同类型的传感内容分别实施ROC模型,也可扩展ROC模型支持多内容组合约束规则的内容组播和内容任播消息.
