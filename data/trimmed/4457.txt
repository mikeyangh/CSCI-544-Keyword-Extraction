Page1基于理想格的高效模糊身份加密方案吴立强1)杨晓元1),2)韩益亮1)1)(武警工程大学电子技术系武警部队密码与信息安全保密重点实验室西安710086)2)(西安电子科技大学网络信息安全教育部重点实验室西安710071)摘要模糊身份加密方案(FIBE)是将用户的身份信息通过一个属性集合来表示,加密公钥则使用另一个属性集合表示,当且仅当这两个集合足够“相近”时,解密才能正常执行.这类密码体制能够容忍部分错误公钥信息,特别适用于某些用户身份信息不能被完全正确提取的场合.文中基于理想格上的困难问题,在标准模型下,提出了一种IND-sID-CPA安全的多比特FIBE方案,并将其安全性紧致地归约为判定性R-LWE困难假设,相比以前基于标准格上的FIBE方案,新方案具有公钥长度短、密文扩展率低的优势.关键词模糊身份加密;理想格;可证明安全;密码学1引言在2005年欧密会上,Sahai和Waters[1]首次提出了模糊身份加密(FuzzyIdentity-BasedEncryp-Page2别适用于某些用户的身份信息不能被完全正确提取的场合,如生物特征的识别等.由于该文献首次将属性的概念应用到公钥密码中,因此也将FIBE称为属性基加密(Attribute-BasedEncryption,ABE).FIBE的提出是公钥密码学的一个重要革新,因为公钥不再局限于传统的单一实体描述,而是以实体属性的细粒度进行描述的,即公钥是一类细化的结构.解密条件也不仅仅是判定加密公钥与解密者的公钥是否相等,也可能是门限、访问树或者内积等函数的值.正是受到FIBE思想的启发,断言加密和函数加密等[2-3]构造灵活且实用的密码方案相继被提出.目前,基于双线性对和标准格这两种数学工具分别实现了两个FIBE方案.文献[1]基于DBDH(DecisionalBilinearDiffie-HellmanAssumption)假设,采用Shamir门限秘密共享的方法,构造了一种标准模型下选择身份安全(Selective-IDsecurity)的FIBE方案,即当用户公钥属性集与加密公钥属性集的交集等于或大于规定数量的属性时,可正常解密.文献[4]在标准模型下,基于LWE(LearningwithErrors)困难问题[4],构造了一种选择身份IND-CPA(IndistinguishabilityunderChosenPlain-textAttacks)安全的单比特FIBE方案,同时给出了将方案扩展到IND-CCA(IndistinguishabilityunderChosenCiphertextAttacks)安全的方法.LWE的复杂性可以归约到格上的gap-SVP(gapShortestVectorProblem)和SIVP(ShortestInde-pendentVectorsProblem),因此该方案不仅具有线性的运算结构,还具有抵抗量子攻击和亚指数攻击的能力.但在效率方面,却存在密文扩展率高和公钥长度大的缺陷,严重影响了方案的实用性.理想格的格基具有循环特点,即用一个主理想基可表达整个格,而传统的格需要若干个基才能表达,因此利用基于多项式商环的理想格构造出的公钥密码体制具有更紧致的密文和更短的密钥长度.2010年Lyubashevsky等人[5]提出了LWE问题在环(Ring)上的变体———R-LWE,并将其复杂性归约到理想格上的经典困难问题;最近,Lyubashevsky等人[6]进一步扩展了文献[5]中成果,给出了更为紧致和简洁的归约过程,并且设计了一些丰富的理想格上密码学工具.本文正是利用这些工具,设计了一些可满足身份型加密体制的核心算法和函数,从而在标准模型下构造了一种IND-sID-CPA安全的多比特FIBE方案,相比以前基于标准格上LWE的方案,新方案具有公钥长度短、密文扩展率低的优势.本文第2节给出FIBE方案的概念、安全模型和判定性R-LWE困难假设;第3节介绍构造新方案的一些必备算法和函数;第4节描述新的IND-sID-CPA安全FIBE方案;第5节分析方案的正确性和效率,并给出严格的安全性证明;第6节对文章进行总结.2安全模型2.1标记符号i[l]表示分别取整数i=1,2,…,l.向量用黑体小写字母犪,犫,犮,…表示,一般指列向量;矩阵用黑体大写字母犃,犅,犆,…表示.设[x]和[x]分别为系数为整数和实数的多项式集合.R=[x]/〈犳(x)〉是模犳(x)的多项式环,Rq=q[x]/〈犳(x)〉是模犳(x)和系数在q上的多项式环.长度为m的环多项式向量记作狓^=(狓1,狓2,…,狓m)∈Rm,定义狓^的两种乘法运算:(1)狓^狔=(狓1狔,狓2狔,…,狓m狔)∈Rm,狓^∈Rm,狔∈R.(2)狓^狔^=∑m设犪=a0+a1x+…+an-2xn-2+an-1xn-1∈q[x]/〈犳(x)〉,犪^∈Rm,记若m不需要明确指出,可简记为rotf(犪)和Rotf(狓^).记向量犪=(a0,a1,…,an-1)的Euclidean范数为犪=a2n-1+a2n-2+…+a21+a的Euclidean范数为犕=max(犿i)(1im).犲=MapM-v(犪^)表示依次连接犪i(i=1,…,m)的系数组成的一维列向量犲∈表示将犲∈犪^∈Rm的系数.对于一个素数q,整数m,n,矩阵犃∈维q-ary格定义为Page3Λ⊥Λu设狓为n维向量,ρs(狓)为中心为0,标准差为s的n维高斯分布,即ρs(狓)=exp(-π狓2/s2),那么对于格L,记ρs(L)=∑狓∈Lρs(狓),当ρs(L)有界时,格L上的离散高斯分布[4]定义为2.2R-LWE困难假设假设犳(x)=xn+1∈[x],安全参数为n=2p(p∈)(保证犳(x)不可逆),q2,定义在上的离散噪声分布为χ=R-LWE随机预言机,包含两个采样算法$(随机均匀选取(犪,犫)∈Rq×Rq)和s(设定秘密狊∈Rq,选择均匀分布的环多项式犪和系数取自χ的噪声犲,计算(犪,犫=犪狊+犲)∈Rq×Rq),攻击者向预言机询问,随机利用$或者s产生若干个实例(犪,犫)返回给攻击者,如果能够准确分辨出该实例来自$或s的优势Adv(A)=|Pr[AOs=1]-Pr[AO$=1]|是不可忽略的,那么就说能够解决判定性R-LWE问题.2.3FIBE的定义下4个算法:一个基于身份的模糊加密方案(FIBE)包括以FIBE.Setup(λ,l)→(PP,MSK):输入安全参数λ和最大身份长度l,输出公共参数PP和主密钥MSK.FIBE.Extract(PP,MSK,ID,k)→SKID:输入主密钥MSK,公共参数PP、用户身份ID和门限值k,输出ID对应的解密密钥SKID.FIBE.Enc(PP,M,ID)→CT:输入明文消息M,加密公钥ID和公共参数PP,输出密文CTID.FIBE.Dec(PP,CTID,SKID)→M:输入密文CTID,解密密钥SKID和公共参数PP,如果|ID∩ID|k则输出消息M,否则输出⊥.一个FIBE方案是正确的,对于Setup生成的所有(PP,MSK),Extract生成的所有用户私钥SKID,明文空间内所有的消息M,使用Enc(M,ID)生成的所有密文CTID,如果|ID∩ID|k,那么2.4IND-sID-CPA安全模型在FIBE方案中,非适应性选择挑战ID和选择明文攻击下的语义不可区分性(IND-sID-CPA)可以通过攻击者与挑战者之间的游戏来定义.PP,保留主密钥MSK.目标:攻击者公布要攻击的ID.设置:挑战者运行FIBE.Setup算法,公布询问阶段I:攻击者选择一系列IDj(|ID∩IDj|<k)交给挑战者进行私钥查询,挑战者返回IDj所对应的私钥SKIDj.挑战:攻击者选择两个等长的明文M0和M1,告知挑战者,挑战者随机选择b∈{0,1},使用ID加密Mb,将密文给攻击者.询问阶段II:攻击者再选择一系列的IDj(|ID∩IDj|<k)进行私钥查询.猜测:攻击者输出Mb,如果b=b,则攻击者获胜.如果任何一个多项式时间的算法在游戏中作为攻击者的优势AdvIND-sID-CAP是可忽略的,则称该FIBE方案满足IND-sID-CPA安全.3重要算法和函数3.1陷门产生算法和原像抽样函数定理1[7].存在理想格上陷门产生算法Ideal-TrapGen,输入n,σ,r>0,素数q,m∈和次数为n的多项式犳,该算法能够在多项式时间内同时得到一个统计上接近均匀分布的多项式向量犵^=(犵1,犵2,…,犵m)∈Rm犜犵^=0且犜犵^珟O(槡n).生算法生成矩阵犃∈珟犜犃ω(log槡m),对于任意狌∈时间内算法SamplePre(犃,犜犃,狌,σ),返回一个分布接近于Λu定理2[8].假设q2,使用标准格上的陷门产到目前为止,还不存在理想格上原像抽样函数,定理2中抽样函数是建立在标准格上的,对于环多项式向量的运算并不成立.但是可以证明,环运算和矩阵运算之间存在定理3中的关系.定理3.设犵^=(犵1,犵2,…,犵m)是一个长度为m的环多项式向量,定义犌=Rotf(犵^)∈Page4对任意一个环多项式犮^∈Rm,犵^犮^=犆T·犌成立,其中犆=MapM-v(犮^)∈证明.犵^犮^=∑m其中,犮i,j表示多项式犮i的j个分量.证毕利用定理3,我们可以构造出理想格上原像采样函数.算法1.Ideal-SamplePre(犵^,犜犵^,σ,狏).输入:环多项式向量犵^∈Rm,对应陷门犜犵,噪声控制参输出:多项式向量犲^~1.犌=Rotf(犵^)∈2.狋=SamplePre(犌,犜犵^,狏,σ)∈3.犲^=Mapv-M(狋)∈Rm.3.2理想格中私钥提取算法算法2.Ideal-SampleLeft(犵^,犜犵^,狏,σ,id,犪^,犫^).输入:用户id∈{0,1}n,犵^,犪^,犫^∈Rm输出:私钥犲^id~1.将id编码为环多项式u(id)∈Rq;2.随机选取统计分布服从3.计算狏1=(犪^+u(id)犫^)犲^1;4.犲^2=Ideal-SamplePre(犵^,犜犵^,狏-狏1,σ)∈Rm,显然有m×n,σ;5.用户私钥为犲^id=犲^1犲^2~4方案描述假设用户身份属性向量犐犇由l个长度为n的比特串构造,即犐犇=(id1,id2,…,idl),其中idi∈{0,1}n,安全参数n=2p,p∈,犳(x)=xn+1,qn3是素数满足q≡3mod8,σ=m·ω(logn),r=1+log3q,m=(logq+1)σ+r=珟O(1),Rq=q[x]/犳(x).门限值k表示当用户身份向量和加密公钥向量中至少需要k个属性值相同时,才能成功解密.4.1FIBE.Setup(狀)(1)随机选择均匀分布的狌∈Rq;犜犵^i∈(2)对于i=[l],①使用ideal-TrapGen(n)产生犵^i∈Rmq,犜犵^i珟O(槡n);②随机选取系数均匀分布的环多项式向量q、犫^i∈Rm(3)系统参数和主密钥分别为犪^i∈RmPP=({犪^i,犫^i,犵^i}i∈[l],狌,q,犳),MSK=({犜犵^i}i∈[l]).4.2FIBE.Extract(犘犘,犕犛犓,犐犇,犽)输入公共参数PP,主密钥MSK和用户属性向量犐犇=(id1,id2,…,idl),门限值k<l.(1)分别对狌=(u1,u2,…,un)∈Rq的每个分量使用Shamir秘密共享方案,生成l个份额.即对于i∈[l],选择一个系数均匀分布的k-1次多项式狆i∈q[x]满足狆i(0)=狌i.(2)对于j∈[l],构造第j个份额向量狏j=(vj,1,vj,2,…,vj,n)=(狆1(j),狆2(j),…,狆n(j))∈Rq,根据Shamir秘密共享方案中系数的相关性,存在系数Lj使得(3)对于i∈[l],取身份idi,构造通过ideal-SampleLeft(犵^i,犜犵^i,狏i,σ,idi,犪^i,犫^i)计算私钥犲^idi∈R2m,满足犳^idi犲^idi=狏i.(4)输出私钥SKID=(犲^id1,犲^id2,…,犲^idl).输入公共参数PP,身份属性ID=(id1,id2,…,4.3FIBE.Encryptidl)Rl犿∈R.(1)设D=(l!)2;(2)随机均匀选取狊∈Rq;(3)对于i∈[l],①取身份idi构造犳^idi=犵^i②随机选择系数服从分布量犲^x∈Rm;随机产生m个环多项式向量狉^1,狉^2,…,狉^m∈Rm,其系数取自{-1,1},犲^y=(犲^x狉^1,犲^x狉^2,…,犲^x狉^m)∈Rm;③计算犮^i=犳^idi狊+D犲^x犲^()y∈R2mPage54.4FIBE.Decrypt(犛犓犐犇,犆犜犐犇′)(4)选择噪声犲z∈R;(5)计算犮0=狌狊+D犲z+犿q/2∈Rq.输出密文CTID=(犮0,{犮^i}i∈[l]).输入PP,私钥SKID和密文CTID.(1)设J[l]表示属性向量中犐犇和犐犇中匹配元素集合,如果|J|<k,输出⊥,否则计算Lagrange系数Lj使得(2)计算犿=犮0-∑jJ数在(q/4,3q/4]时设为1,否则为0.5方案分析5.1正确性定理4.设q>2tDmncδσ,c1,t>15,利用上述方案产生的密钥加密消息犿,那么解密算法以趋近于1的概率正确恢复出原文.证明.犿=犮0-∑jJ=狌狊+D犲z+犿q/2-∑jJ=犿q/(2+狌狊-∑jJ)烐烏D∑jJ密文要正确解密,必须要求噪声中每一个系数的绝对值不超过q/4,下面介绍几个定理来分析噪声的上界.定理5[9].设c1,C=cexp1-c2()2<1,那么对于任意的实数s>0和n1,都存在:狓∈定理6[9].对于任意的实数s>0,T>0和n,有Pr|〈狓,定理7[4].设D=(l!)2,给定kl个数I1,…,Ik[1,2,…,l],定义Lagrange系数那么对于1jk,DLj是整数,且满足|DLj|D2(l!)4.由于私钥向量犲^j和噪声向量犲^x的系数服从分2m×n,σ和布犲^x狉^m)∈Rm,所以对于任意的1im,有犲^狔i槡mn犲^狓i.根据定理5,存在一个c1,使犲^狓icδn/2槡π.由环多项式的运算规则,噪声多项式的每一系数相当于DLjm(mn槡)槡Dmn个系数服从n,σ分布的狓∈积,因此解密失败的概率为而T=q显然,概率2exp(-πT2)是可忽略不计的,所以新方案将会以趋近于1的概率正确解密.证毕.5.2安全性定理8.假设判定性R-LWE问题是困难的,那么新的FIBE方案是IND-sID-CPA安全的.证明.方案安全性证明采用“game-hopping”方法①.游戏序列:Game0.攻击者和挑战者之间真实的非适应性选择挑战ID和选择明文攻击,如2.4小节中IND-sID-CPA安全模型,设要攻击的身份为ID.Game1.在Game0中,挑战者公开的系统参数犪^i取自均匀分布,Game1中环多项式犪^i不是随机选取,而通过犪^i=(犵^i狉^1,犵^i狉^2,…,犵^i狉^m)-狌(idi)犫^i计算得到,狉^1,狉^2,…,狉^m为加密阶段选取的随机环多项式向量,其余参数的选取与Game0相同.Game2.对Game1中参数进行如下修改:犵^i∈Rm系数在q上随机均匀选取,不含陷门.利用Ideal-TrapGen产生含有陷门犜犫^i的犫^i,挑战者利用后门犜犫^i使用算法3为用户ID(|ID∩ID|<k)生成私钥.①DentAW.Anoteongame-hoppingproofs.http://Page6算法3.Ideal-SampleRight(犵^,狏,σ,id,犪^,犫^,犜犫^).输入:用户id∈{0,1}n,环多项式向量犵^∈Rm输出:用户id的私钥犲^id~1.犳^id=犵^2.使用如下算法构造犳^id的陷门犜犳^id.2.1.对于1imn,犮i为陷门犜犫^第i列,狋^i=Mapv-M(犮i)∈Rm,那么犫^狋^i=0,设j=1其中狋^i[j]表示狋^i的第j个向量,则犳^id狋^i=犵^狉i(狋^i[j(-∑mu(id))犫^)狋^i=0.2.2.对于1+mni2mn,设犮i为单位矩阵犐mn第i-mn列,狋^i=Mapv-M(犮i)∈Rm,选取一个狑^i使得(u(id)-u(id))犫^狑^i=犵^狋^i(这里没有限制狑^i的长度,所以容易找到满足条件的狑^i),显然有犳^id狋^i=0.2.3.犜犳^id=(MapM-v(狋^1),MapM-v(狋^2),…,MapM-v(狋^2mn)),犜犳^id‖犜犫^‖槡mω(log槡m)且珟犜犳^id中2mn个向量线性无关(证明可以类似参考文献[11]).3.犲^id=ideal-SamplePre(犳^id,犜犳^id,狏,σ)∈Rm,满足犲^id~2m×n,σ.Game3.挑战密文为随机选取互相独立的环多项式向量(犮0,{犮^i}i∈[l])∈Rq×RmlGame2中相同.序列转移:Game0到Game1.对多项式时间内的攻击者而言,Game0和Game1概率不可区分,使用剩余哈希引理在环上的变体(引理1)容易证明.引理1[11].设R是一个有限环,犪^=(犪1,犪2,…,犪m)∈Rm是一组任意的环多项式,另有犫^∈Rm服从均匀分布且互不相关,那么犪^犫^在理想〈犪1,犪2,…,犪m〉上是均匀分布的.Game1到Game2.私钥生成过程对攻击者是不可见的,而获得的私钥犲^ID在统计上仍然服从分布Game1中得到的优势与在Game2中得到的优势相当.Game2到Game3.假设攻击者有不可忽略的优势来区分Game2和Game3,那么挑战者就可以解决判定性R-LWE问题.如R-LWE定义中描述,存在一个R-LWE采样预言机,其随机从$或s中选取一些采样作为输出,挑战者通过下面的模拟过程与攻击者进行交互来解决判定性R-LWE问题.实例化:向预言机询问并接收lm+1个R-LWE采样,标记为(狑1,狏1),{(狑11,狏11),(狑21,狏21),…,(狑m1,狏m1)},…,{(狑1l,狏1l),(狑2l,狏2l),…,(狑ml,狏ml)}(Rq×Rq)(lm+1).攻击目标:向公布它要攻击的目标ID.设置:构造如下系统参数:(1)对于i[l],犵^i=(狑1i,狑2i,…,狑mi);(2)狌=狑1;(3)其余系统参数设置与Game2中的相同.询问:当攻击者向挑战者询问时,如第二,设犮^i=犵^i狊+犲^x,那么密文第二部分为犮^i=犮^iGame2中完成私钥询问过程.时,挑战者如下构造密文,对于所有的i[l]:挑战:当攻击者给挑战者发送加密消息犿(1)设犮^i=(狏1i,狏2i,…,狏mi);(2)犮^i=犮^i(3)犮0=狏0+犿q/2;(4)挑战者从{0,1}中随机选取r,如果r=0,密文CTID=(犮0,{犮^i}i∈[l])构造如上,否则随机选取均匀分布的环多项式向量犆犜ID=(犮0,{犮^i}i∈[l]),将CTID发送给攻击者.如果实例化过程中预言机输出的分布来自s,那么密文CTID的分布与Game2中分布相同,原因如下:第一,犳^id均匀分布;Page7==犳^id第一部分为犮0=狏1+犿q/2.两部分都与Game2中挑战的密文分布相同.如果实例化过程中预言机输出的分布来自$,那么根据引理1,通过计算得到密文分布统计上服从随机均匀分布,而在Game3中,密文(犮0,{犮^i}i∈[l])正是随机取于均匀分布.猜测:询问过后,给出一个猜想b∈{0,1},这里b=1意味着攻击者正在与Game2交互,挑战者回答R-LWE挑战的猜测β=b,这里β=1意味着上述实例(狑i,狏i)(1ilm+1)服从R-LWE分布,否则β=0表示实例服从随机均匀分布.以上完成了对挑战者的描述,可以看出如果能够以不可忽略的优势区分Game2和Game3,那么挑战者能够以绝对的优势解决判定性R-LWE问题.表1两种不同方案的相关加密算法效率对比ABVVW方案[4]m=Ω(nlogq)3mlnlogqml单比特(2ml+1)logq矩阵运算本文方案m=Ω(logq)3mlnlogq2nmln比特(2ml+1)logqFFT运算6结论模糊身份加密体制能够容忍部分错误公钥信息,使得解密更为灵活和实用,已经成为近几年来研究的一个热点,而一种密码体制要应用于实际环境,必须在保证其安全性的前提下尽可能地提高其执行效率.本文基于R-LWE困难假设,在标准模型下构造了一种IND-sID-CPA安全的多比特FIBE方案,相比于以前基于标准格上LWE的方案,新方案公钥长度更短,密文扩展率更低.
