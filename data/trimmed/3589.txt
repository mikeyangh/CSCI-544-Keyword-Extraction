Page1一种构造并发不可延展零知识的新方法李睿徐秋亮(山东大学计算机科学与技术学院济南250101)摘要构造了一个新的并发不可延展的零知识论证系统,具有更好的鲁棒性.新方案基于Feige-Shamir结构而设计,以具有鲁棒性的不可延展承诺方案以及巧妙设计的证据不可区分性证明为基本组件,来实现并发不可延展性和鲁棒性.此外,对敌手视图的模拟借助了“茫然模拟”的策略.当与其它协议并发组合时,该方案更易于分析和应用.基于单向函数假设,该方案的轮复杂性为超对数.关键词零知识;并发不可延展性;鲁棒性;单向函数假设;茫然模拟1引言交互证明系统[1]是现代密码学的一个基本组件,自其提出以来一直受到广泛的关注.零知识证明系统最具吸引力的性质在于它能够使一个参与方P(称Goldwasser、Micali和Rackoff提出的零知识为证明者)向另一个参与方V(称为验证者)证明一Page2并发零知识[2-7]在一个更现实的环境(并发、异步的网络环境)中讨论零知识证明系统的安全性,它允许敌手作为验证者与多个证明者并发地执行协议,并在多个进程之间协调自己的攻击行为.Dolev、Dwork和Naor等人在文献[8]中提出了零知识证明的另外一种并发安全性,称为不可延展性(non-malleability),描述零知识证明系统抵抗中间人攻击的能力.即在协议的两次并发执行中,敌手一方面作为验证者与一个诚实的证明者交互,验证其对某个声明的证明过程(称为左侧会话);另一方面作为证明者与一个诚实的验证者交互,试图证明一个相关的声明(称为右侧会话).此后,Pass等人[9]提出了一个类似的性质称为模拟可抽取(simulation-extractability),其安全性定义强于不可延展性但便于应用.简言之,一个交互证明系统称为模拟可抽取的,如果存在一个模拟抽取器S能够模拟中间人敌手A在左右两侧执行过程中的视图,同时抽取出A在右侧证明中所使用的证据.本文主要关注并发不可延展的零知识(Concur-rentNon-MalleableZero-Knowledge,CNMZK)论证协议,即考虑一个概率多项式时间(以下简称PPT)的敌手同时参与m个左侧会话以及m个右侧会话(m为安全参数的多项式).普遍认为,在此背景下协议的安全性最能够反映其在开放网络中的执行情况.项声明(statement)的正确性(例如,x∈L,其中L是一个NP语言),而不泄露任何额外的信息.这种性质通常形式化地描述为:存在一个高效的模拟器S使得对任意的恶意验证者V,模拟器S(内部调用V)能够模拟协议执行的过程,并且S的输出与协议真实执行时的输出计算不可区分.文献[10]中,Barak等人以模拟可抽取的定义方式重新给出了CNMZK的明确定义,并首次提出了平凡模型下CNMZK论证系统的构造方法.基于单向函数假设,该协议的轮复杂性为多项式,若基于抗碰撞Hash函数假设,其轮复杂性可降为珟O(logn).此后,Ostrovsky等人[11]在DDH假设下给出了上述协议的高效实现方法.然而以上两个协议仅具有计算可靠性.近期,Lin等人[12]提出了一种实现CNMZK的新方法,并且构造了第一个CNMZK证明系统.基于单向函数假设或者抗碰撞Hash函数假设,其轮复杂性分别为多项式和珟O(logn).若仅考虑计算可靠性,该证明系统还可转化为基于单向函值得一提的是,该协议的设计方式源于著名的Goldreich-Kahan零知识证明系统[13].此外,其它一些文献在相对(平凡模型)较弱的模型下讨论了抵抗并发中间人攻击的零知识证明系统.例如,借助于可信的系统建立假设(如公共引用串[14]),或者全局可访问的“公告牌”(如裸公钥模型[15-16]),或者引入其它的安全性框架(如超多项式时间模拟[17]).然而,本文仅关注平凡模型下的并发不可延展性.(1)研究动机零知识证明和承诺协议的研究是紧密联系、相互促进的.并发不可延展零知识的一个潜在应用在于构造打开阶段并发不可延展(concurrentnon-mallealew.r.tdecommitment)的承诺协议.近期,Ostrovsky等人[18]以及Cao等人[19]在对承诺方案的并发不可延展性研究中指出,已有的方案存在一个共同的限制,即其承诺阶段和打开阶段在时间上不可重叠.其中一个主要的问题在于,当承诺阶段与打开阶段作为一个整体执行时,两阶段需要各自保证自己的安全性需求,即对其中一个阶段的模拟不能影响另一阶段的安全性.该性质通常称为鲁棒性(或可组合性).在已有的不可延展零知识协议中,一部分使用了非黑盒模拟技术[20],而缺乏鲁棒性是非黑盒模拟技术内在的限制[21],尤其在并发环境下.此外,在其它黑盒CNMZK证明(论证)系统中,都存在一个零知识证明子协议,令其鲁棒性难于讨论.因此,构造一个在并发环境下具有较好的鲁棒性的CNMZK证明系统对解决上述问题以及其它类似的应用,具有重要意义.(2)本文的贡献本文基于著名的Feige-Shamir结构[22]提出了一种设计并发不可延展零知识论证系统的新方法,以巧妙设计的证据不可区分证明来代替零知识证明子协议,以及文献[23]提出的鲁棒的不可延展承诺方案来实现整个协议的不可延展性.另一方面,本文对敌手视图的模拟采用了“茫然模拟”的策略[3-5],并借助文献[12]的证明方法来分析模拟的不可区分性.由于证据不可区分性在并发组合下封闭,承诺子协议是鲁棒的,并且模拟策略是茫然的,因此当与其它协议并发组合时,本文的方案更易于分析和应用.与文献[12]相同,本文的方案在单向函数假设下的轮复杂性为珟O(logn).Page32预备知识令N表示正整数的集合,对于任意n∈N,令[n]表示集合{1,2,…,n}.令{0,1}n表示所有长度为n比特的字符串集合,{0,1}表示所有字符串的集合.对于任意NP语言L,令RL表示L对应的证据关系.函数μ:N→{0,1}称为可忽略的,如果对任意正多项式p以及足够大的n∈N,μ(n)<1/p(n).两个概率总体称为计算不可区分的(记为≈c),如果不存在概率多项式时间,图灵机能够以不可忽略的概率区分它们.详细的定义请参阅文献[24].2.1证据不可区分性及特殊可靠性不严格地讲,一个交互证明系统称为证据不可区分的(WitnessIndistinguishable,WI)[25],如果证明者使用不同的证据执行两次协议,而验证者无法区分这两次执行.值得一提的是,证据不可区分性在并发组合下是封闭的.对某项声明x∈L,称一个k轮公开投币的交互证明系统具有特殊可靠性(SpecialSoundness,SS)[26],如果给定一个随机生成的长度为(k-2)的消息前缀(记为α),以及在该前缀下两个接受的证明副本,存在概率多项式时间的知识抽取器能够抽取x∈L对应的证据.WISS证明系统一个常见的例子是Blum提出的对哈密顿回路问题的证明系统[27].若将Blum协议中的承诺方案初始化为基于单向置换的统计绑定承诺,那么该协议仅需3轮.或者将上述承诺方案替换为Naor提出的两轮统计绑定承诺方案[28],可得到4轮的基于单向函数假设的WISS证明系统.2.2不可延展的承诺方案承诺方案是在两个参与者之间进行的两阶段交互协议,其中两名参与者分别称为承诺者(或发送者)和接收者.在承诺阶段,承诺者对一个值v承诺,并确保v在整个承诺阶段的保密性.随后在打开阶段,承诺者公开v,并证明其与承诺阶段的一致性.承诺方案的两个基本性质称为隐藏性和绑定性.简言之,隐藏性是指在承诺阶段任何恶意的接收者都不能获取关于v的信息,而绑定性是指在打开阶段任何恶意的承诺者都不能将v成功地打开为另外一个值.本文中涉及的承诺方案均为统计绑定(计算隐藏)的承诺方案.对不可延展承诺的定义通常通过比较该承诺方案在中间人攻击下的执行过程和模拟的执行过程来形式化地描述.本文引用文献[9]给出的基于模拟的不可延展性定义,但采用一种不同的形式[29,23](与原定义等价).对于承诺方案〈C,R〉和中间人敌手A(辅助输入为z),考虑以下执行过程:敌手A作为接收者与诚实承诺者C交互,接收承诺者对一个值v的承诺(左侧会话);同时作为承诺者与诚实接收者R交互,试图对一个相关的值v~承诺(右侧会话).两次执行分别关联于不同的会话标识,记为id和id~,均由A选定.若在右侧协议中,A未能构造出合法的承诺,或者id~=id(A直接复制了左侧的会话),v~的值默认为⊥.令随机变量mimA述执行过程中的视图以及A在右侧协议中承诺的值v~.定义1.称一个承诺方案〈C,R〉为不可延展的,如果对任意PPT中间人敌手A,以下两个概率总体计算不可区分{mimA≈c{mimA此外,称一个承诺方案为初始绑定的,如果承诺者的第1条消息能够唯一确定其承诺的值v.已有的承诺方案(以及不可延展的承诺方案)几乎都满足该性质.2.3并发不可延展的零知识本文中,我们引用文献[10,12]中对并发不可延展零知识的定义.令〈P,V〉表示NP语言L的交互证明系统.对于PPT中间人敌手A(辅助输入为z∈{0,1}),考虑以下过程:A作为验证者与m(n)个诚实证明者{P1,…,Pm}交互,验证每个证明者Pi对声明xi∈L的证明;同时作为证明者分别与m(n)个诚实验证者{V1,…,Vm}交互,试图向验证者Vj证明一个相关的声明x~会话标识{id1,…,idm},每个右侧会话分别关联标识{id~侧待证明的声明均由A自适应地选定.令随机变量viewA(n,x1,…,xm,z)表示A在上述执行过程中的视图.定义2.对于语言L,RL表示其证据关系,一个交互证明系统〈P,V〉称为并发不可延展的零知识证明系统,如果对任意多项式m,任意PPT中间人敌手A,并发地参与m个左侧会话和m个右侧会话,都存在一个PPT的机器S(称为模拟抽取器),满足1,…,id~Page4(2)令x1,…,xm∈L∩{0,1}n,z∈{0,1},(view,ω)表示S(n,x1,…,xm,z)的输出,以及1,…,x~x~明.令id1,…,idm以及id~话和右侧会话的标识.那么,对任意1im,若第i个右侧证明是接受的,并且id~左侧标识idj(1jm),那么ω包含了满足RL(x~3新的并发不可延展的i,ωi)=1的证据ωi.(1)对于足够大的n∈N,以下两个概率总体计算不可区分:{viewA(n,x1,…,xm,z)}n∈N,x1,…,xm∈L∩{0,1}n,z∈{0,1}≈c{S1(n,x1,…,xm,z)}n∈N,x1,…,xm∈L∩{0,1}n,z∈{0,1}.其中{S1(n,x1,…,xm,z)}n∈N,x1,…,xm∈L∩{0,1}n,z∈{0,1}表示S(n,x1,…,xm,z)的第1个输出.零知识论证协议在本节中,我们将基于单向函数假设构造一个并发不可延展的零知识论证协议.首先介绍该协议的基本组件(子协议).3.1并发可抽取的承诺方案并发可抽取承诺(ConcurrentlyExtractableCommitment,CECom)的概念是由Micciancio等人[30]从著名的PRS并发零知识协议[4]中抽象出来的.简言之,利用此类承诺协议承诺的字符串,可由模拟器以重绕的方式、黑盒调用承诺者来并发地、实时地抽取.文献[4]分析指出,CECom的交互轮复杂性为超对数(super-logarithmic).令k(n)为一个超对数函数.若对一个n比特字符串δ承诺,在承诺阶段,承诺者C首先选择一个初始承诺方案记为Com,以及nk(n)对n比特随机串(α0i,j,α1i,j),其中i∈[n],j∈[k(n)],满足对任意的i和j,α0i,jα1i,j=δ.然后承诺者利用Com对δ以及所有2nk(n)个字符串承诺.承诺阶段的第2步包含k(n)个“挑战-应答”回合.在第j个回合中,接收者发送一个随机的n比特挑战串bj,而承诺者则依据bj相应地打开对αb1,j1,j,…,αbn,jn,j的承诺.在打开阶段,承诺者打开其它nk(n)+1个承诺.当且仅当以上所有利用Com所做的承诺都能够被正确地打开,并且对任意的i和j满足α0i,jα1i,j=δ时,CECom的打开才是合法的.正如文献[30]中所述,一个CECom方案的隐藏性和绑定性与其初始承诺方案相同.本文方案中调用了一个统计绑定的并发可抽取承诺.将上述子协议Com初始化为Naor的统计绑定承诺Comsb,即可得到基于单项函数假设的统计绑定的并发可抽取承诺CEComsb(如图1所示).协议CEComsb.公共输入:安全参数1n被承诺的字符串:δ∈{0,1}n承诺阶段:第1步:C→R:选择nk(n)对n比特随机串(α0i,j,α1i,j),其中i∈[n],第2步:对j=1→k(n)执行以下步骤:R→C:发送一个n比特字符串bj=b1,j,…,bn,j.C→R:打开承诺αb1,j1,j,…,αbn,jn,j.打开阶段:C→R:打开其它nk(n)+1个承诺.3.2并发可抽取的子协议本文方案的另一个组成部分是满足并发可抽取性质的子协议〈S^,R^〉,用来设定(模拟器使用的)“伪证据”.协议〈S^,R^〉是对文献[5]中并发零知识协议的前序部分的抽象.首先在第1阶段,发送者S^均匀选取两个随机字符串s0和s1,并将其关于单向函数f的像c0=f(s0)以及c1=f(s1)发送给接收者R^.然后S^与R^并行执行一个WISS证明系统的k(n)个副本至倒数第2轮(最后两轮暂不执行)证明c0或者c1属于f的值域.在第2阶段中,S^与R^顺序执行上述k(n)个证明的后两轮.若在上述任何一个证明中R^未能接受,则终止协议.协议〈S^,R^〉的完整描述见图2.协议〈S^,R^〉.公共输入:安全参数1n,单向函数f第1阶段:S^→R^:均匀选择s0,s1∈{0,1}n,发送c0=f(s0)以及c1=f(s1).S^→R^:随机选择b∈{0,1},以sb为证据执行一个WISS证明系第2阶段:对j=1→k(n)执行以下步骤:R^→S^:对第j个证明副本,发送其倒数第2轮消息βj∈{0,1}n2.S^→R^:对第j个证明副本,发送其最后一轮消息γj.R^:若以上证明验证失败则终止协议.Page53.3关于任意犽轮协议不可延展的承诺方案一般而言,不可延展性的研究背景是中间人敌手并发执行多个相同的协议.近期,Lin等人[23]将承诺方案的不可延展性扩展到一般化的情况,即对任意k轮协议的不可延展性(以下简称为k-不可延展).考虑以下情形:中间人敌手A在左侧与参与方B交互,执行任意一个k轮协议,同时在右侧作为承诺者与m个诚实接收者交互,执行承诺协议〈C,R〉.每个右侧协议的会话标识应与左侧协议不同,且均由A自适应地选定.令随机变量〈C,R〉(y,z)(其中y表示B的本地输入,z表示AmimB,A的辅助输入)表示A的视图以及A在右侧执行中利用〈C,R〉承诺的值.此外,令viewA[B(y),A(z)]表示A与B交互的视图.定义3.称一个承诺方案〈C,R〉是关于任意k轮协议一对多不可延展的(k-不可延展),如果对任意PPT中间人敌手A并发地参与一个k轮的左侧协议(与机器B交互)和m个右侧承诺协议〈C,R〉(与m个诚实接收者交互),以及机器B的任意的输入序列{y1n}n∈N和{y2n}n∈N,y1n,y2n∈{0,1}n,当成立时,以下两个概率总体计算不可区分:本文的方案中调用了一个关于任意超对数轮协议不可延展的承诺协议NMCom.如文献[12,23]中所述,以适当的参数实例化文献[29]的不可延展承诺方案,即可满足.引理1.令k(n)为一个超对数函数,那么基于单向函数假设,存在一个O(k(n))轮(初始)统计绑定的k(n)-不可延展承诺方案NMCom.此外,NMCom满足另外一个性质,称为(一对多)弱不可延展性(one-manyweaknon-malleability)[23],是对传统并发不可延展性的放宽.弱不可延展性针对一类受限的性质集合(定义于敌手的视图及其在右侧承诺的值之上),强调当左侧协议的执行过程发生变化时,成立的概率不会从一个可忽略的值跳跃至不可忽略.关于弱不可延展性的严格定义请参阅文献[23].3.4本文的方案不失一般性,我们假设待证明的声明x∈L以及证据w均为n比特字符串.令k(n)为一个超对数函数,表示上述并发可抽取承诺CEComsb以及并发可抽取子协议〈S^,R^〉的轮复杂性.令l(n)=O(k(n))表示k(n)-不可延展的承诺协议NMCom的轮复杂性(显然,l(n)>k(n)).令t(n)表示标识字符串的长度.令〈wiP,wiV〉表示一个挑战串长度为2n的WISS证明系统.第1阶段,验证者首先和证明者执行并发可抽取的子协议〈S^,R^〉,其中验证者作为发送方S^参与协议,而证明者作为接收方执行R^对应的代码.此后,证明者在第2步和第3步分别利用CEComsb和NMCom对其掌握的证据w承诺.第4阶段,证明者对字符串0n承诺,并在第5步利用WISS证明系统〈wiP,wiV〉证明该承诺确实是对0n的承诺,或者他掌握第1阶段收到的其中某个值的原像(即“伪证据”).协议最后一步包含l+1个WISS交互证明,证明者P证明如下声明:协议的第2步和第3步的确是对证据w的承诺,或者第4步是对一个伪证据的承诺(见图3).协议〈P,V〉.标识字符串:id∈{0,1}t公共输入:安全参数1n,字符串x∈{0,1}nP的秘密输入:证据字符串w∈{0,1}n,满足(x,w)∈RL第1阶段:VP:执行并发可抽取的子协议〈S^,R^〉,其中V作为发送方S^P:若上述过程失败则终止协议.第2阶段:P→V:利用CEComsb对证据w承诺.令T1表示该承诺的交互第3阶段:P→V:利用NMCom对证据w承诺.记该承诺的交互副本为T2.第4阶段:P→V:利用NMCom对字符串0n承诺.令T3表示该承诺的交第5阶段:PV:执行WISS证明系统〈wiP,wiV〉,证明者P证明如下第6阶段:PV:顺序执行WISS证明系统〈wiP,wiV〉l+1次,证明者P图3并发不可延展的零知识论证协议〈P,V〉4安全性证明零知识论证系统.定理1.协议〈P,V〉是一个并发不可延展的下面我们分别论证〈P,V〉满足完备性、可靠性完备性.易于验证.〈P,V〉的完备性是平凡的.以及并发不可延展的零知识.Page6可靠性.直观地讲.〈P,V〉的可靠性依赖于〈wiP,wiV〉证明系统的特殊可靠性和证据不可区分性,以及函数f的单向性.假设存在一个多项式p和一个敌手A,使得A能够以1/p(n)的概率攻破〈P,V〉的可靠性.那么,由〈wiP,wiV〉的特殊可靠性可知,存在一个知识抽取器能够通过重绕第6步中的证明,抽取P在协议第6步中所使用的证据w.此外,由CEComsb以及NMCom的绑定性可知,w是c0或c1原像的概率为1/p(n)-μ(n)(其中μ(n)是一个可忽略函数).令sb(b∈{0,1})表示协议第1阶段中包含的伪证据.依据“双证据”论证方法,若w=sb那么可构造一个算法B攻破第1阶段中WISS证明系统的证据不可区分性;若w=s1-b,那么可构造另一个算法B攻破函数f的单向性.详细的论述请参阅下文中定理8的证明.并发不可延展的零知识.证明〈P,V〉满足并发不可延展的零知识需要构造一个模拟抽取器S,能够模拟中间人敌手A在左右两侧会话中的视图,并且抽取A在右侧证明中所使用的证据.下面分别讨论模拟的不可区分性以及证据抽取的正确性.(1)模拟抽取器本文中模拟抽取器S的构造(见图4)类似于文献[12],对每个左侧会话,S首先尝试重绕第1阶段的某个WISS证明,找到两个接受的证明副本,并抽取得到一个伪证据(该过程由特殊可靠性保证).然后S利用伪证据进行后续的模拟过程.对每个右侧的会话,S按照诚实验证者的步骤进行.模拟右侧证明的视图:S按照诚实验证者的步骤执行.模拟左侧证明的视图:对于每个左侧会话,S抽取第1阶段消息中所包含的伪证据,并在第2和第3阶段对0n承诺,在第4阶对伪证据承诺,最后利用伪证据来完成第5和第6阶段.抽取右侧证明的证据:对每个成功的右侧证明,S抽取出A在第2阶段承诺的值w.总体上讲,S采取了文献[3-5]中所使用的“茫然模拟(oblivioussimulation)”策略.S尝试以直线的方式模拟A的视图,这是通过多次的重绕收集信息(即匹配的证明副本)来实现的.S对A的每次重绕会产生一个新的模拟分支,它与S最终在主线程(即输出线程)中输出的A的视图相互独立,但有助于S对伪证据的抽取.模拟过程结束后,S从每个成功的右侧协议中抽取出A在第2阶段承诺的值(即右侧声明对应的证据).此外,S在上述模拟过程中可能面临两种失败的情况.首先,在某个并发可抽取承诺或者并发可抽取的子协议完成之后,S未能找到两个匹配的挑战-应答回合,即对A的重绕并没有起到应有的作用.这种形式的失败称为重绕失败.第二,对于左侧协议的第1步,S尽管找到了两个匹配的证明脚本,但未能提取出伪证据,即违反了WISS证明的特殊可靠性.这种形式的失败,称为特殊可靠性失败.定理2.模拟抽取器S出现重绕失败和特殊可靠性失败的概率是可忽略的.定理2的正确性可由文献[5,12]中的相关结论得出.详细的论证请参阅文献[5,12].(2)模拟的不可区分性本节中我们将证明由模拟器S输出的A的视定理3.中间人敌手A在真实协议中的视图图与A在真实协议中的视图不可区分.与S模拟输出的A的视图计算不可区分,即{S(1n,x1,…,xm,z)}n∈N,x1,…,xm∈{0,1}n∩L,z∈{0,1}≈c{mim(1n,x1,…,xm,z)}n∈N,x1,…,xm∈{0,1}n∩L,z∈{0,1}.证明.定理3的证明与文献[12]中类似.在以下证明中,我们将左侧协议按照其第1步结束的时间顺序来排序.首先,按如下方式定义一系列混合模拟器hybi(1im+1),每个混合模拟器的辅助输入(记为z)包括左侧所有声明对应的证据.主模拟阶段:运行模拟器S以得到A的视图view.若模拟成功,记录S在每个左侧会话中抽取的伪证据(记第j个左侧证明对应的伪证据为rj).否则终止(即S遇到了重绕失败或者特殊可靠性失败).重绕阶段:在view中,以第i个左侧会话的第1阶段恰好完成为分割点,记viewi为分割点之前的部分.然后从分割点开始,以如下策略继续进行模拟:①对每个右侧会话,作为诚实验证者参与协议(如同S).②对左侧前i个会话,利用第1步中记录的伪证据rj进行后续步骤(如同S).由定理2可知,在分割点之前,左侧前i个会话对应的伪证据已固定.因此,此步骤能够以直线方式进行.③对左侧第i+1个以及后续会话,利用真实证据完成模拟(如同诚实证明者).输出阶段:输出在以上策略下生成的A的视图.此外,定义另外一组混合模拟器hybi,其模拟策略类似于hybi,但在重绕阶段hybi使用真实证据完成第i个左侧会话的模拟(如同诚实证明者),其Page7它会话保持不变.需要注意的是,hybi以及hybi仅关注对敌手A视图的模拟,而不关注对右侧证据的抽取.定理4.对任意i∈{1,…,m+1},hybi以及hybi终止的概率可忽略.证明.hybi以及hybi仅在模拟器S出现重绕失败或者特殊可靠性失败时才会终止,因而由定理2可知其发生概率可忽略.定理5.hybi与hybi的输出计算不可区分.证明.hybi与hybi唯一的区别在于其模拟第i个左侧会话的方式不同.hybi以直线的方式进行,在第2及第3阶段对字符串0n承诺,并利用伪证据完成后续模拟过程.而hybi利用真实证据,以诚实证明者的方式进行.因此,由CEComsb、NMCom的隐藏性,以及〈wiP,wiV〉证明系统的证据不可区分性可知,两者输出的A的视图计算不可区分.定理6.hybi-1以及hybi的输出统计不可区分.证明.hybi-1以及hybi的唯一区别在于:从第i-1个左侧会话的第1阶段结束之后到第i个左侧会话的第1阶段结束为止,hybi以重绕的方式生成A的视图.由于模拟器S利用了“茫然模拟”的策略,由重绕产生的模拟分支与输出相互独立,因此在hybi-1以及hybi成功完成的情况下,两者的输出同分布.此外,由定理2可知,hybi-1和hybi终止的概率可忽略,定理6得证.易知hybm+1的输出与模拟器S的输出同分布,而hyb0的输出与协议真实执行时A的视图统计不可区分,因此定理3的正确性可由定理5及定理6保证.(3)证据抽取的正确性本节中我们将完成定理3证明的最后一部分,即S在右侧协议的第2步中抽取的证据是正确的.为便于表述,在以下证明中如无特殊说明,右侧证明即是指验证者接受的右侧证明并且其标识不同于任何一个左侧证明.此外,若敌手A在某个右侧证明的第2阶段承诺的值并非合法的证据,则称敌手A欺骗成功.因此,只需证明在模拟器输出的视图中,A欺骗成功的概率是可忽略的,即可推断出S抽取的正确性.由WISS证明系统的可靠性、证据不可区分性以及函数f的单向性可知,在协议的真实执行过程中,A欺骗成功的概率可忽略.因此,我们需要证明模拟的过程不会使A欺骗成功的概率从可忽略的值跳跃至不可忽略.事实上,这是由NMCom的不可延展性以及协议第6阶段证明的鲁棒性保证的.定理7.对任意PPT中间人敌手A同时参与m个左侧证明和m个右侧证明,任意n∈N,x1,…,xm∈{0,1}n∩L以及z∈{0,1},都存在一个可忽略函数μ,使得A在某个右侧证明中欺骗成功的概率小于μ(n).证明.回顾第4.2节中定义的混合模拟器.定理7可由以下定理8、定理9以及定理10得出.定理8.对任意PPT敌手A,A在hyb0的输出视图中欺骗成功的概率可忽略.证明.由hyb0的定义可知,其输出产生于第2阶段,并且该过程与协议的真实执行过程等价.由于其第1阶段与第2阶段以及最终的输出相对独立,因此不失一般性我们仅考虑hyb0的第2阶段.假设存在一个PPT敌手A以及一个多项式p,使得对无穷多的n∈N满足A在hyb0中欺骗成功的概率为1/p(n).因此,对随机选取的第j个右侧证明,A在该证明副本中欺骗的概率为1/mp(n).固定一个证明副本j,那么由第6步证明的可靠性可知,在该证明中A在第4阶段对一个伪证据(c0或c1的原像)承诺的概率也为1/mp(n)(减去一个可忽略的值).再由第5阶段证明的特殊可靠性可知,存在一个有效的知识抽取器能够抽取A在第5阶段证明中所使用的证据,即某个值s满足cb=f(s)(其中b∈{0,1}).①若b=1-b,那么可以构造一个算法B来攻破f的单向性.设B的挑战字符串为y=f(x).B按照hyb0的步骤执行,但在随机选取的第j个右侧证明中,B将第1步中函数f的两个像之一替换为y.此后,B利用其掌握的唯一证据(另一个值的原像)完成第1步的证明.由假设可知,B能够以近似1/mp(n)的概率找到y对应的原像x,从而攻破f的单向性.②若b=b,那么可以构造另一个算法B攻破WISS证明系统的证据不可区分性.首先考虑以下混合实验Bi(0ik).对一个随机选择的右侧会话j,Bi在第1阶段的前i个WISS证明中使用sj为证据,而在后k-i个证明中使用sj然在B0中,会话j的第5阶段中抽取的证据为sj而在Bk中相应的值为sj可知,存在一个索引值i满足在Bi和Bi+1中,会话j的第5阶段中抽取的证据是不同的值.由Bi和Bi+1的定义可知,二者唯一的区别在于第1阶段的第i+1个WISS证明所使用的证据不同.因此,基于上Page8述事实可以构造算法B攻破WISS证明系统的证据不可区分性.B按照hyb0的步骤执行,但对于随机选取的第j个右侧会话以及该会话第1阶段中随机选取的第i个WISS证明,B执行以下步骤:利用0作为证据生成前i-1个WISS证明,利用sjsj证据生成后k-i个WISS证明,而对于第i个WISS证明,B在A以及WI-挑战者之间传递消息.因此,通过上述分析可知,B以近似1/kmp(n)的概率可以攻破协议第1阶段中WISS证明的证据不可区分性.综上所述,基于单向函数假设,任意PPT敌手A在hyb0中欺骗成功的概率可忽略.定理9.对任意PPT敌手A以及任意i∈{0,…,m+1},A在hybi+1以及hybi的输出视图中欺骗成功的概率仅相差一个可忽略的值.证明(概要).回顾定理6,在hybi以及hybi+1成功完成的条件下,其输出同分布,因此A在二者的输出视图中欺骗成功的概率相同.而hybi以及hybi+1终止的概率均为可忽略的值,因而A在二者的输出视图中欺骗成功的概率仅相差一个可忽略的值.定理10.对任意PPT敌手A以及任意i∈{0,…,m+1},A在hybi以及hybi的输出视图中欺骗成功的概率仅相差一个可忽略的值.证明.本段中我们将证明在每一对hybi和hybi中,敌手A的视图以及A在右侧会话的第2阶段中承诺的值计算不可区分,并且A在第4阶段对一个伪证据承诺的概率可忽略.由此即可推断出A在两者中的欺骗概率仅相差一个可忽略的值.下面通过归纳法来证明上述命题.当i=0时,该命题是平凡的,因此我们从i=1的情况开始.基础步骤(i=1):由上述定理8和定理9可知,A在hyb1中欺骗的概率可忽略(该结论将在以下对1和H1H0另外一组混合实验H0的重绕阶段中,左侧第1个会话的改变及其对右侧会话的影响.1:H0H0个右侧会话的第3阶段承诺的值.显然,由CEComsb以及NMCom的绑定性可知,在H0视图以及A在每个右侧会话的第3阶段承诺的值不可区分.1:H1H1步中,H1NMCom的4-不可延展性(或者3-不可延展性,若该WISS证明系统是基于单向置换假设构造的3轮证明系统)可知,在每个右侧会话中,A在第4阶段承诺的值与H0A在第4阶段对伪证据承诺的概率可忽略,因此该结论在H1可延展性以及WISS证明系统的证据不可区分性可知,在H0话的第3阶段中承诺的值计算不可区分.定理12.对任意PPT敌手A,A在H2视图以及A在右侧会话的第3阶段承诺的值与H1中计算不可区分.证明(概要).该证明依赖于协议第6阶段的鲁棒性.首先,协议第4阶段的NMCom轮复杂度为l,而第6阶段中有l+1个WISS证明.那么,对每个右侧会话,其第6阶段必然存在一个WISS证明不包含左侧会话第4阶段的任何消息(即不相交).因此,通过重绕该证明可抽取一个证据而不影H2阶段,H2定理11.对任意PPT敌手A,A在某个右侧会话的第4阶段中对一个伪证据承诺的概率可忽略.证明(概要).考虑以下关于右侧会话的情况:首先H2是相同的.因此,由初始绑定性可知,若任何一个右侧会话的第4阶段在第1个左侧协议的第4阶段之前出现,那么A在该阶段承诺的值已经确定,并且它是一个伪证据的概率可忽略.其次,若A在其它右侧会话的第4阶段中对伪证据承诺的概率不可忽略,那么可以构造算法B攻破NMCom的弱不可延展性.简言之,算法B执行H2个会话的第4阶段中,B在A与一个外部的诚实承诺者之间传递消息,并且对于(出现在左侧第1个会话第4阶段之后的)右侧会话的第4阶段,B在A与外部的诚实接收者之间传递消息.显然,当左侧收到一个对0n的承诺时,B完美地模拟A在H1视图.另一方面,当左侧收到对一个伪证据的承诺时,B完美地模拟A在H2的值由0n变为一个伪证据时,A在右侧欺骗的概率由可忽略(在H1而违背了NMCom的弱不可延展性.Page9响对左侧会话的模拟,即对第1个左侧会话第4阶段的模拟不影响右侧会话第6阶段的可靠性.此外,由定理11可知,A在右侧第4阶段对伪证据承诺的概率可忽略.因而,在右侧第6阶段抽取的证据必为A在第2、3阶段承诺的值(及相应的承诺密钥).综上可知,在H1不可区分.此外,由NMCom的隐藏性可得,A在H1及H21中的视图同样计算不可区分.关于定理12详细的证明类似于文献[23]中对Subclaim4的证明.1(1il+1):H3,iH3,i1个会话的第6阶段,前i个WISS证明以“第4阶段是对一个伪证据的承诺”作为证据.通过混合论证的方法,以及类似于上述H1论:在H3,l+1承诺的值与H3,1可区分.1:H4H4第3阶段,H41:H5H5阶段中,H5可延展性,以及CEComsb的隐藏性可得,在H5的视图以及A在右侧第3阶段承诺的值与H4可区分,并且A在右侧第4阶段对伪证据承诺的概率可忽略.此外,由第6阶段证明的可靠性可知,对任意一个接受的右侧会话,A在第2阶段和第3阶段承诺的值相同.因此,在H52阶段承诺的值与hyb1中计算不可区分.基础步骤证明完毕.归纳步骤:假设定理10对任意1im-1成立.对于i=m,考虑如图5所示的不可区分链,其中实箭头表示(在定理9中)已经证明的不可区分性,而虚箭头表示待证明的部分.在定理8中我们已经证明了A在hyb0中欺骗成功的概率可忽略,那么由归纳假设可知A在hybm中欺骗成功的概率也为可忽略的值.通过与基础步骤相同的论证,易知定理10对i=m同样成立.定理10证明完毕.5结论本文提出了一种在平凡模型下构造并发不可延展零知识论证系统的新方法.与已有(平凡模型下的)方案[10-12]相比,本文的方案在最基本的密码学假设(即单向函数假设)下达到了最优的轮复杂性(与文献[18]相同).更重要的是,本文方案以具有鲁棒的不可延展承诺协议以及巧妙设计的证据不可区分的证明系统为基本组件,通过适当地调整协议轮数,即可达到更好的鲁棒性.因此,当与其它协议并发组合时,本文的协议更易于分析,因而有更广泛的应用.
