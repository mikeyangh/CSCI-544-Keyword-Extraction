Page1网络能耗系统模型及能效算法张法1)AntonioFernandezAnta4)王林1),2)侯晨颖1),2)刘志勇1),3)1)(中国科学院计算技术研究所北京100190)2)(中国科学院研究生院北京100190)3)(中国科学院计算技术研究所计算机体系结构国家重点实验室北京100190)4)(马德里高等研究院网络所马德里28918西班牙)摘要网络能耗问题是当前网络研究和发展的重要问题,影响着网络的设计、应用和发展.当前网络能效算法的研究大多从网络局部角度关注于网络某一(些)设施的能耗问题,缺乏从网络全局的角度研究网络整体能耗的算法和策略.文中从网络全局角度研究网络的能耗模型和算法问题.文中基于3种基本网络数据传递模式和3种基本网络能耗机制,构建了网络能耗系统优化模型,对其中5种关键系统模型给出了详细的描述.针对几个关键系统模型,文中给出了形式化描述并且提出了相应的优化的节能路由算法.文中给出的网络系统能耗优化模型有助于对于网络能耗的理解和分析,所提出的能耗优化的网络数据包路由算法可以从网络路由的角度有效降低网络能耗.关键词能耗;系统模型;能效算法;最优化;网络延迟;绿色计算1引言互联网络在过去20多年中飞速发展,对整个社会产生了深远的影响,已经从最初的仅供学术研究的实验平台发展成为对全球社会和经济有着至关重要影响力的通信媒介[1].统计数据显示[2],2010年全球以太网的接入节点数已超过30亿,而与之相连接的交换机、路由器等设备的数量也同样庞大.根据CNNIC(中国互联网络信息中心)最新公布的《第28次中国互联网络发展状况统计报告》显示①,“截止到2011年6月,我国网民规模已达到4.85亿,互联网普及率达到36.2%”,而随着网络成本的降低与应用的普及,这些数字仍在快速持续地增长.正如微软的首席技术官RayOzzie所讲:“我们已经进入了一个以互联网为中心的新时代”[3].长久以来,人们普遍认为信息系统对全球能源消耗的影响微乎其微,然而事实并非如此.美国环保署(EPA)公布的一项数据表明:当前美国数据中心所消耗的电力已占到美国全部电力使用量的2%,并且其电力需求正在以12%的速度递增,预计到2020年,这一数字将激增到9%[4].另外数量庞大的网络设备也带来了巨额的能耗,2008年服务于互联网的路由器、服务器、交换机、冷却设施、数据中心等各种设施总共消耗约8680亿度电,占全球总耗电量的5.3%[5],而且按照目前的增长趋势,到2025年,信息和通信技术行业(InformationCommunicationTechnology,ICT)平均耗能将达到2006年的5倍,网络领域的能耗更会达到13倍[6].伴随着能耗的持续增长,ICT行业造成的碳排放量也在急剧增长,2007年全球ICT行业的碳排放量占全球总排放量的2%,并且这一比例到2020年将翻一翻[7].众所周知,节能减排已经成为全球最受关注的焦点,我国在2009年哥本哈根气候峰会上承诺到2020年二氧化碳排放比2005年下降40%~45%,并且节能减排已经成为“十二五”发展规划的重要内容.因此,网络设备和计算设备对能源的消耗,严重阻碍着节能型社会的创建,已成为一个急需解决的对于环境和经济发展具有重要影响的重大社会问题.然而传统网络系统设计的两个原则,即超额资源供给和冗余设计,有悖于低碳节能的目标[5],造成当前网络的能耗效率极其低下.各种网络通信设备在最初设计时并没有充分考虑能耗问题,而是以解决通信拥塞和保障服务质量为设计目标,通常考虑如何满足未来网络流量的增长、提高网络传输的可靠性、应对突发故障、方便维护等因素,因此这些设备浪费了大量的能量[8],而且随着网络规模的扩大和网络设施的不断更新,网络系统的高能耗、低效率等问题日益显著.例如,目前网络繁忙时的最大平均链路利用率不足30%,很多网络的空闲时链路利用率甚至不足5%,几乎所有网络设备的能耗都是由峰值带宽决定的,且绝大部分设备为7×24小时全速工作,而网络用户真正需要最高带宽的工作时间不足设备运行时间的5%[9].这就意味着,即使在网络空闲的情况下,网络设备依旧按照峰值带宽的标准消耗能量.如果网络设备的能耗能够与其负载流量成正比,保守估计[7],超过80%的网络接入层能耗和40%的网络设备总能耗将被节省下来,至少将减少15%的二氧化碳排放量,这样在相同能源成本的情况下,我们可以部署更多的网络设施,从而提高整个网络系统的稳定性和可靠性.目前许多政府机构和产业组织也纷纷制定标准和法规来提倡绿色网络.例如美国贝尔实验室倡导构建的全球性联盟“绿色沟通”(GreenTouch),旨在通过技术创新实现千倍提升通信网络能效的目标;电子电气工程师协会(IEEE)正式批准了802.3azEEE规范以降低网络设备的能耗,其中EEE为高效节能以太网(EnergyEfficientEthernet)的缩写②.因此,构建绿色网络,降低网络能耗已经成为当前计算机网络领域一个意义重大、迫切需要解决的关键问题.绿色网络是一个系统级的研究课题,涉及网络①②licarea.http://grouper.ieee.org/groups/802/3/az/pub-lic/index.html,2008Page3体系结构、网络协议、网络设备结构创新和算法设计与优化等网络领域的核心科学问题[5].针对网络能效算法,人们进行了深入研究.速度缩放和休眠是当前两种动态适应能量消耗的主要机制[10-15].速度缩放机制是根据网络的负载流量动态调整网络设备的传输速度,从而到达节能的目的,休眠机制通过关闭相应的网络设备以实现降低网络能耗的效果.围绕这两种机制,人们已经取得了大量的研究成果.但是,从网络全局的路由分配角度分析,如何描述网络中消息传送的能耗优化问题以及如何为消息分配路由以使得能耗最小化,仍然没有得到充分研究.其中包括,如何结合网络数据不同的传输模式、采用不同的节能策略(如休眠、速度缩放、速率适应等)为能耗最优化建立模型,分析其计算的难度(复杂性)以及设计可行的路由分配算法等问题.现有研究中存在的主要问题包括:(1)缺乏降低网络全局整体能耗的算法研究.目前大多数的研究工作只关注于网络(有线或无线)某一(些)方面的能耗问题,例如如何降低处理器的能耗以延长移动设备的电池寿命,如何减少网络系统某一接口设备(CPU、网络接口、路由器、交换机等)的能耗等等,缺乏从网络全局的角度研究网络整体能耗的算法和策略.(2)缺乏针对网络能效算法理论分析的研究,包括算法正确性证明及其理论性的性能分析和评价等等.本文从网络全局数据包调度和路由的角度研究能耗优化的模型和算法.从数据传递模式以及网络能耗机制角度,构建了网络通信能耗优化的系统模型,并且给出了5种关键系统模型的详细描述.在此基础上,给出了部分系统模型的形式化描述和降低网络能耗的优化算法.本文主要分为以下4个部分:第2节综合分析当前提高网络能效的算法和策略;第3节基于数据的传递模式和网络能耗机制,对网络通信能耗的优化问题进行了系统建模,并且对其中5种关键系统模型进行了详细的形式化描述;第4节给出基于部分系统模型的网络能效算法及相应的实验结果;最后对全文进行总结,提出了进一步的研究方向.2提高网络能效的算法和策略由于CPU是现代计算系统中能耗最高的部件,关于能效算法的研究最初主要是针对处理器的电源管理[10],其主要目的是为了延长笔记本电脑或其它计算系统的电池使用寿命.围绕CPU电源管理的研究可分为如下两类:速度缩放机制(speedscaling)和休眠机制(poweringdown).而目前网络能效算法的研究策略是根据实际的流量负载动态调整网络的传输速率,从而达到降低网络能耗的目的.这方面的研究大多都借鉴了CPU电源管理的研究策略,同样也大致分为速度缩放机制和休眠机制两类.在速度缩放机制中每一个网络设备都具有调节自身传输速度的能力,它是根据网络流量负载动态调节处理速度以实现节约能源的目的.在休眠机制中每一个网络设备或者工作在全功耗的激活(active)模式下,或者工作在低功耗的休眠(sleeping)模式下,它是通过使相应的网络设备休眠以达到节约能源的目的.围绕上述两种机制,人们针对单一计算系统或该系统的某一方面(如CPU或某一网络接口设备)的能耗进行了深入研究,例如针对CPU任务调度的能源效率研究[16-24],针对单一网络接口设备节能的研究[10-15].Yao等人[16]对处理器的速度缩放问题进行了系统阐述,将处理器的能量消耗P定义为一个同处理速度s相关的多项式函数,P(s)=sα,其中常数α2.能耗函数P(s)是严格意义上的凸函数,也就是说,任务处理的速度越快,能耗增加得越快.这样给定一组任务集,并且明确指定每一任务的执行时间和被处理的速度,则处理器能耗最小化问题就转化为最优任务调度问题.并且Yao等人给出了一个离线的多项式时间内的贪心算法和两个在线的竞争算法.围绕速度缩放机制,研究人员进行了深入研究并取得了大量研究成果,例如文献[17-20].此外Wierman等人[20]针对IntelPXA270、PentiumM770和TCP/IPOffloadEngine进行了功耗研究,分别将常数α降低到1.11、1.62和1.66.Irani等人[21]明确定义了休眠(poweringdown)的工作机制,并且提出了一种基于概率的能耗最小算法[22].Irani定义的休眠机制如下[21]:在处理器运行过程中存在很多未知的空闲时段,在此期间处理器没有任何任务处理,因此在这些空闲时段可以将处理器处于休眠状态,直到某一任务需要处理器处理为止.对于处理器的非空闲时间,根据能耗将其划分成k个运行状态,S0,…,Sk,其对应的能耗分别为P0,…,Pk,且P0P1…Pk.处理器从状态Si转变到Sj需要转换时间tij和转换能耗eij.此外休眠状态结束时,处理器将被重置回S0状态.为了进一步降低CPU的能耗,Irani等人[23-24]尝试着将速度缩Page4放机制和休眠机制相结合,提出了一个(槡3+22)-competitive的算法.他们将处理器的运行过程划分成激活和休眠两种状态.在激活状态下,处理器可以以任意速度运行,且其能耗函数是一个与处理速度相关的凸函数;在休眠状态下,处理器不消耗任何能量,但是从休眠状态过渡到激活状态需要一个固定的能耗.此外,通信的能量消耗也一直是无线网络研究的热点问题,尤其是围绕adhoc无线网络和传感器网络中的能耗问题,人们进行了大量的研究工作[25-26],例如Jones等人[26]概括总结了不同协议层上的各种降低能耗的技术,提出了一种根据邻居状态的分布式休眠算法.Gupta和Singh首次强调了通用网络能耗问题的重要性[10-12].他们发现:当前大部分以太网接口设备都具备低能耗的工作模式,但是大部分链接在空闲时并没有被置于该状态.他们提出了通过改变网络协议将网络设备中的部分组件置于休眠状态(或节能状态)来降低能耗的方法.在此基础上,Christensen等人[13-15]提出了通过代理因特网适配器的途径来减少因特网边缘能耗的方法.同时他们对减少PC、以太网链接以及边缘路由器的能耗进行了研究,其中“在可能的情况下减少以太网链接中的数据传输速度”的思想被进一步发展为自适应链接速率(AdaptiveLinkRate,ALR)技术[15]:基于动态速度缩放机制,通过自主调节全双工传输的以太网链路交换速率从而适应不同的链路利用率,使链路交换速率与链路负载成比例.目前对于该技术的研究主要集中在速率切换(包括切换的条件和时机、最优速率的选择以及如何快速切换)及其对性能的影响等方面[5].在以太网工业界,速率适应和链接休眠这两种方法受到高度的重视[9],速度适应(rateadaptation)的方法已被应用到ALR技术中[15],链接休眠的方法也已经被IEEE802.3az节能以太网工作组定为低功耗空闲技术的标准.此外其它的链接标准AD-SL2和ADSL2+也支持多种链接速度和能耗模式[27].在针对全局网络最优能耗的策略和算法研究方面,Nedevschi等人[28]对速度自适应、链接休眠和部分网络设备休眠技术在降低全局网络能耗方面进行了探索,并在真实的拓扑结构上对这几种方法进行了对比.Chabarek等人[1]评估了两个标准路由器的能量需求,创建了一个能耗模型,并通过求解混合的整数规划的方法实现了能耗最优.综上所述,当前大多数的研究工作侧重于关注网络能耗问题的某一(些)具体设施,例如针对某一单独计算系统,或者该系统某一设备(CPU或是网络接口)的能耗问题,缺乏从网络全局的角度研究网络整体能耗的算法和策略.如何从网络全局范围的角度(例如网络的部署、网络数据传输的调度、路由,等)分析网络的能耗行为,建立网络能耗的系统模型,设计高效率低能耗算法,是影响网络能耗的具有挑战性的问题.3网络能耗系统模型本节从网络数据的传递模式以及网络能耗模式的角度,对网络通信能耗模型进行分析,归纳出几种系统模型,并且对其中部分系统模型给出了形式化描述和详细阐述.3.1网络能耗系统模型的构建从网络全局的角度考虑,通用的网络框架体系是由一些路由器和链路构成的,该网络系统为一些数据提供传输服务,且提供服务所消耗的能量取决于选择的路径以及每个链路上数据包的调度策略.在此我们定义数据传递的源点为s,终点为t.网络数据的传递模式可以分为如下3种:(1)连续流模式(continuousflow).假设存在一个源点终点对(si,ti)和某一传输请求di,使得有一个连续的,大小为di的流量从si传递到ti.(2)周期性包到达模式(periodicpacketarrival).假设存在一个源点终点对(si,ti)和传输速率pi,使得在每T个单位时间内,存在有pi个数据包从si传递到ti(我们可以将该模式视为连续流模式的一个特例,即di=pi/T).(3)对抗性包到达模式(adversarialpacketarrival).基于对抗性排队理论[29-30],在该模式中,我们引入了一个受约束的对抗量(adversary)到被传递的数据包中,即数据包的传输是由受约束的对抗量控制的.同样每个被传递的数据包有一个源点si和终点ti.根据每个数据包是否已经事先分配了一条路径,我们可以建立两个不同的传递模式.此外,对抗量的引入必须保证网络传递的稳定.除了网络数据传递模式外,我们引入了3种网络能耗机制.假设任一链接e都对应一个能耗函数fe(s),它表示该链接以速率s传输数据时所消耗的能量.这3种机制是:Page5(1)速度缩放机制(speedscaling).每个网络链接可以根据网络的传输负载情况在[0,R]速率区间中选择它的实际传输速率s,0sR.当R=时为特殊情况.(2)休眠机制(poweringdown).每个网络链接都有两种工作状态(激活状态和休眠状态).在激活状态时,网络的传输速度为全速R,其对应的能耗为f(R);在休眠状态时,网络的传输速度为0,其对应的能耗也为0.此外,网络由休眠状态转为激活状态需要花费δ时间,在这段时间内网络的传输速度为0,但能耗为f(R).(3)速率自适应机制(rateadaptation).网络工作时存在有多种工作状态(S0,…,Sk),其中包含休眠状态,且每一状态对应一传输速率.每一网络链路可以根据网络传输负载情况选择某一工作状态.对于任一状态Si,0ik,其传输速率为Ri,0RiR,对应的能耗为f(Ri).网络由状态Si转换为Sj需要花费δ时间,期间网络的传输速率为0,能耗为f(max(Ri,Rj)).围绕上述3种网络数据传递模式和三种网络能耗机制,可得到9种可能的网络通信能耗系统模型,其中绝大部分系统模型还没有被研究过.我们对其中更具有典型意义的5种网络能耗系统模型进行了构建和定义,这5种网络能耗系统模式如表1所示.速度缩放机制CFSS速率自适应机制CFRAPPRAAARA休眠机制(1)连续流速度缩放模型(ContinuousFlowwithSpeedScaling,CFSS).在该模型中,数据以稳定且连续的形式传输.网络中消耗的能量可以通过路由网络中的数据流量进行调节,也可以通过降低每个链路上的传输速度来调节.(2)连续流速度自适应模型(ContinuousFlowwithRateAdaptation,CFRA).该模型和CFSS模型有着相同的数据传递模式,同样可以通过路由来降低能源的消耗.但是在该模型中,链路上的数据传递速度不能取任意值,而只能从预先设定的、可能的传递速度中选取.(3)周期性包到达休眠模型(PeriodicPacketArrivalwithPowering-Down,PPPD).该模型中,数据以分批分组的形式周期性传递,同组被传递的数据有着相同的源点和终点,且可能沿着同样的传输路径.可以通过对数据包的相应调度,使链路在较长时间内处于休眠状态,从而达到降低能耗的目的.(4)周期性包到达速率自适应模型(PeriodicPacketArrivalwithRateAdaptation,PPRA).该模型同PPPD模型有着相同的数据传递模式,但是其能耗的减少并不是通过将链路处于休眠状态,而是通过对数据包的调度和路由选择,使链路暂时工作于低速率/低能耗的状态.(5)对抗性包到达速率自适应模型(AdversarialPacketArrivalwithRateAdaptation,AARA).该模型中数据包以对抗性形式传递,且通过对数据包的调度和路由选择,使链路暂时转换到低速/低能耗的工作状态,以实现能源消耗最小(注:此模型主要为分析网络节能策略和算法的最差性能而做出的一种抽象,本文将不详细论述).3.25种基本网络能耗系统模型的描述通过对真实网络中的路由和数据传输特点的分析,结合当前网络技术的特性和约束条件,以及系统模型中的主要组成部分,如网络拓扑结构、流量和能耗函数等,我们给出上述5种基本网络能耗系统模型的具体描述.用一个无向图G=(V,E)来表示一个网络,其中V代表网络设备(主机、路由器、交换机等),E表示网络中的链接.假设每一个网络设备(顶点或边)都有一个能耗函数f(s),可以定义该网络设备传输流量s所消耗的能源.(1)CFSS模型.在该模型中,请求从源点到终点以稳定且连续的形式传输.给定一组请求D=(d1,d2,…,dk),假设请求i沿一条单路径从源点si路由至终点ti,请求i的大小为di.此能量优化问题的最终的目标是在满足每个请求i时使链路能耗最小,也就是,寻找满足请求i的路径,使∑e∈E最小,其中xe表示所有请求在链路e上的总流量.那么,在CFSS模型中能耗最小问题就可以转换为一个如下的最优化问题:(P0)min∑e其中,yi,e的值表示请求i是否通过边e.我们定义Ii(v)和Oi(v)分别表示请求i流入顶点v的量和流Page6出顶点v的量.令Fi(v)=Oi(v)-Ii(v),流守恒即为对于源点si和终点ti有Fi(si)=di,Fi(ti)=-di,对于其它顶点v,Fi(v)=0.对于大多数能耗函数f(x)而言,这一问题是NP难问题,通过对该问题进行适当的约束,利用启发式算法可以得到不同形式能耗函数f(x)的近似解.(2)CFRA模型.在该模型中,每一网络设备都存在有多种工作状态S0,S1,…,Sk,其对应的传输速率分别为R0,R1,…,Rk(本文称之为有效速率),且R0R1…Rk,有效速率Ri的能耗为f(Ri).任一链接的传输速率只从这些有效速率中选择.假设能耗函数f(·)是非递减的,则CFRA模型类似于CFSS模型,其能耗最小问题可以转化为如下的最优化问题:(P1)min∑esubjectto:xe=∑i其中,ze代表链接e所选择的有效速率,且xeze,即ze可以确保流量xe在链路上的稳定传输.同CFSS模型类似,对于大多数能耗函数f(x)而言,这一问题同样是NP难问题.(3)PPPD模型.在这个模型中,由源点si路由至终点ti的请求di是周期性传递的,即每T个单位时间内,有pi个数据包从si传递到ti.网络链路有两种工作状态:激活状态和休眠状态,其中激活状态,网络链路以全速工作,休眠状态不消耗能量.该模型中降低能耗的唯一方法是在没有包到达时尽可能使网络链路处于休眠状态.因此能耗最小问题就转化为如何对每个链路中的数据包进行批处理调度,以使链路能够尽可能长时间地处于休眠状态.此外,休眠状态向激活状态的转换会产生大量能耗,因此休眠状态应该尽可能地保持连续.同时,在该模型中,数据的传输延迟也需要限定在一个可以接受的范围内.此类问题的困难在于,如何在满足传输延迟要求的条件下,对数据包进行调度和路由,以使得链路尽可能地处于较长时间的休眠状态,休眠状态又尽可能地连续以尽量避免状态转换引起的能量消耗.该模型的能耗最小问题可以分为两种情况进行分析:(1)由si至ti的数据传输路径是已知的,此时需要解决的问题仅仅是数据包的调度问题;(2)由si至ti的数据传输路径是未知的,此时我们可以自由选择路径,这时可以首先对简单无环的拓扑结构,如直线、树等进行有效地调度,然后在这些路径中寻找一个生成树,以实现网络能耗最小.(4)PPRA模型.该模型的数据传输模式与PPPD模型类似,由源点si路由至终点ti的请求di是周期性传递的;但是其网络能耗机制同CFRA模型类似,每一网络设备都存在有多种工作状态S0,S1,…,Sk,其对应的有效传输速率分别为R0,R1,…,Rk,且R0R1…Rk,有效速率Ri的能耗为f(Ri).该模型是通过选择不同的有效传输速率来实现降低能耗的目的的.然而比CFRA模型更复杂的是,在不同的传输周期,链路的传输速率是可以动态变化的.(5)AARA模型.在该模型中,数据的传输是按照对抗性包到达模式进行的,即数据的传输由一个受约束的对抗量控制,它决定了数据到达网络的时间以及传输的源点和终点.在数据的传输过程中,传输时间被分为离散的时间间隔,在每一时间间隔中对抗量会以一定平均速率r动态生成包注入到网络中,这些包的源点和终点已知,其路径可能已经由对抗量给定,或是路径未知需要在对抗量注入后由网络进行动态自适应调度.网络链路可以根据网络传输负载情况选择某一有效工作速率,不同工作速率对应有不同的能量消耗,由于网络中的对抗量包是在每个时间间隔内动态注入的,所以对抗量包的注入具有一定的破坏性,会影响当前网络中的能量消耗.因此,该模型中能耗最小问题可以看成是对抗量和调度协议的博弈.即对于每一个链路,在每个时间间隔内选择合适的工作速率和数据的调度协议,以使能耗达到最小.由于数据传输不是周期性的,所以解决方案很可能不是周期性的,而且它更有可能随着分组到达的方式进行调整.4网络能效算法的设计针对上述5种基本系统能耗模型及其最小能耗问题,在设计相应能效算法时,应充分考虑以下按照优先级排列的几个特性:时候都是有限制的,因此链接不允许过载.(1)网络链路的稳定性.网络传输流量在任何(2)能耗最小.设计的能效算法要使得系统消Page7耗的总能量尽可能少.(3)延迟最小.设计的能效算法要保证数据包的传输延迟尽可能小.4.1基于CFSS模型的能效算法在CFSS模型中,对于大多数能耗函数f(x)而言,最优化问题(P0)是NP难的.然而,如果能耗函数f(x)是次可加的,即f(a+b)f(a)+f(b),此类问题可以归结为Buy-at-Bulk网络设计问题.网络设计的Buy-at-Bulk问题已经被广泛研究,并且有一个对数性能比的近似算法[31];如果能耗函数f(x)是凸函数,并且允许部分路由(fractionalrouting),那么上述最优化问题就变成了一个可以在多项式时间内最优解决的凸规划问题.文献[32]针对两种非次可加的能耗函数,利用随机舍入的思想,给出了CFSS模型下的能效路由算法:(1)对于多项式形式的能耗函数f(x)=μxα,针对最优化问题(P0),首先将整数变量yi,e松弛到区间[0,1]上,然后通过求解松弛后的规划问题,获得分数的近似解yi,e,最后利用Raghavan-Thompson的方法[33]进行随机舍入得到整数解.对于请求di,通过不断寻找从源点si到终点ti的路径,并且取每条路径上的瓶颈作为该路径的权值.当找到所有连接源点si到终点ti的路径后,利用每条路径的权值作为其选取概率,进行随机选择,最终每个请求都将由唯一的路径路由.(2)对于带启动能量的能耗函数可以证明其近似算法的理论上界为Ω(log1/4N),并且利用随机舍入的方法可以获得O(K)的近似比,其中K为请求的数目.通过随机舍入的方法,能够解决CFSS模型下非次可加能量函数的路由问题,从而达到降低网络能耗的目的.4.1.1基于time-slot思想的能效算法但是上述方法没有考虑网络中的带宽限制.在实际网络中,每条链路的带宽都是有限的,如果只把网络中能耗总和最小作为路由的唯一目标,则可能会造成某些链路过载,最终导致拥塞或数据丢失.针对这一问题,本文在考虑了网络链路带宽限制的基础上提出一种全局规划的能效路由算法,该算法首先保证每条链路的流量不超过其容量上界,再以全局能耗最小化为目标进行路由.将网络的拓扑结构抽象为一个无向图G=(V,E),G中每条边e都有一容量值ce,能耗函数fe(x)表示边e上的流量为x时消耗的能量.此外还定义一个流量矩阵犜,其中Ti,j表示点i与点j之间的流量.假设在该模型中允许部分路由,则能耗最小问题可转化为如下最优化问题:subjectto:由于允许部分路由的存在,即yi,e可以取0到1之间的分数值,采用文献[32]中的方法,该线性规划问题可以在多项式复杂度时间内获得最优解.当数据传输为非连续时,上述能效方法仍然存在节能的空间.由于网络是一个异步的系统,在实际网络中,不同数据包可能存在不同的路径,造成的延迟也不相同.如果按照最优化问题(P2)的路由策略,链路并不是时刻都处在满负荷状态,(P2)仅为非连续流问题提供了一个下界,保证了链路中不会出现拥塞,但与此同时也带来了链路的带宽浪费和能量消耗.因此,本文提出一种基于time-slot思想的节能调度算法.在调度时,将所有数据包的调度分时槽进行,将不同的数据包分配到不同的时槽里进行调度以提高链路带宽的利用率.在时槽的分配上,可以采用多种方法,例如平均分配、随机选择等.在本文中,我们采用最优的分配时槽策略,则能耗最小问题可转化为如下最优化问题(以时槽数k=2为例):(P3)min∑e由于随着时槽数的增加,网络的拥塞程度会加大,数据包的延迟会变长,因此最优时槽数的确定取决于能耗与延迟之间的权衡关系.在本研究中时槽数定为2.4.1.2实验结果本文采用了Rocketfuel数据集中的美国ISPPage8拓扑结构(RocketfuelAS3967)为数据测试集①.采用文献[34]中的方法,首先提取出原始拓扑结构的最大连通子图,抽象出路由器图与城市图,如图1所示.然后根据城市图中每个城市的路由器数量以及城市间的地理距离,按照公式犜[a,b]=|routers(a)|×|routers(b)|市a的路由器数量)计算出流量矩阵犜.最后在残缺图上(即去掉一个点的图,以此模拟网络中可能出现的突发情况)采用最短路径方法路由流量矩阵犜来估算每条边的容量.实验中能耗函数fe(x)分别采用线性和凸函数形式,即fe(x)=ce-σce-σ·x2,其中σ=β·ce,β反映了网络设备随流量c2e大小调整传输速率的能力.在此基础上,本文对比了最短路径方法[32]、全局规划的能效路由算法(P2)和基于time-slot思想的能效算法(P3)的节能效果,实验结果如表2所示.图1RocketfuelAS3967路由器图和城市图表2RocketfuelAS3967数据集上各种方法的能耗对比能耗函数最短路径fe(x)=x458484584845848fe(x)=1/2cex561984194790568046000000fe(x)=1/4cex280906102394505022900000fe(x)=1/(2ce)x22056312947fe(x)=1/(4ce)x2102056474由表2可知,在节能方面,基于time-slot的能效算法要优于全局规划能效算法,而后者要优于最短路径法,并且节能的多少与能耗函数的表现形式有关.本文的能耗函数选取依据文献[34],利用凸函数来描述能耗随传输速率呈超线性增长这一特性,因此本实验中凸函数形式的能耗函数具有更好的节能效果.4.2基于CFRA模型的能效算法4.2.1算法描述CFRA模型可以适应网络中的设施可以工作在非连续的速度可调整的状态,从而描述网络中的设施可以工作在预先设定的阶梯型的速率上.在CFRA模型中,对于大多数能耗函数f(x)而言,最优化问题(P1)是NP难的;并且在该模型中,网络设备的能耗由其对应的工作状态决定,而这些状态又已经被预先给定.因此在(P1)中,能耗函数f(x)是阶梯函数.阶梯函数的离散性大大增加了(P1)问题的求解难度,这使得仅利用CFSS模型中对yi,e松弛的方法不能够使问题(P1)的难度降低到多项式时间内可解.为了解决这样一个困难的路由问题,我们需要对能耗函数f(x)进行预处理,将其拟合为连续性的能耗函数,以简化问题(P1)的难度.对于阶梯函数的拟合,最常用的方法有中点插值和采样插值法.中点插值法取分段函数每段的中点,然后利用这些点进行最小二乘拟合.由于没有考虑每段的长度,此方法存在很大的局限性.采样插值法通过在分段函数上采样获取一系列的样本点,并利用这些样本点进行最小二乘拟合,此方法在很大程度上依赖于使用的采样方法,效果无法保证.本文提出一种基于积分最小化的插值方法,利用原函数和目标函数的均方误差最小作为指导原则进行插值,可克服上述两种方法的不足,求得能够准确描述原函数特征的目标函数.义如下:假设CFRA模型中阶梯形能耗函数f(x)的定其中yi=f(Ri)(1im),为每一个工作状态的能耗,xi=Ri,xi+1=Ri+1(1im),表示每个工作状态有效速率的上下界.假设拟合得到的连续性目标函数为g(x)=μxβ,则积分最小化可描述为由于g(x)为非线性函数,此最小化问题求解难度很大.对g(x)两边做对数变换则成为线性,即log(g(x))=logμ+βlogx.令zi=logyi,wi=logxi和μ=logμ,则上式变为G(μ,β)=∑m①Rocketfuel:AnISPtopologymappingengine.http://Page9由于G为标准的二次型,选取合适的参数μ和β使G取得最小值的必要条件为G的二次偏导均非负,且一次偏导为零,则有μ=∑mG烄烅β=∑mG烆通过求解此方程组,得到参数μ和β的值,进而可得到拟合后的连续性能耗函数g(x).则优化问题(P1)转化成如下的优化问题(P1).优化问题(P1)为标准的整数规划问题,采用文献[32]中的方法予以求解.将规划问题中的整数变量松弛到分数区间,松弛后的部分路由问题可以由求解凸规划得到分数精确解.然后利用随机舍入的方法,对于每个流量请求将多路径的流量统一到单一路径上.至此问题(P1)得到近似求解,对于每个流量请求分配单一路径路由.(P1)min∑esubjectto:4.2.2实验结果本文在Geant2网络拓扑上测试了CFRA模型能效算法的性能.Geant2为欧洲教育骨干网拓扑①,包含有34个节点和50个链接,如图2所示.实验中能耗函数f(x)满足超可加的约束,每一工作状态对应的能耗按照指数axb随机生成,且b∈(2,3)[32],则每一工作状态对应的能耗如表3所示.表4能耗函数犳(狓)和犵(狓)在不同流量请求下的能量消耗及误差比率请求数目能耗函数第1轮5347.5297337.2635.557516201475.336752876.555805401.2第2轮8990.4384366.2620659.825862264.226062581.439143711.7第3轮6562.6251221.19001013.319652025.433863469.570976884.8第4轮9695.4215279.4816859.521631949.012711199.752085664.9第5轮4951.3313305.7892937.624522146.917301869.654065627.7第6轮5054.4153162.5979937.218031698.436763862.257745989.9第7轮111106492517.91015951.120502251.825962458.643114635.5第8轮4861.1294333.2873939.315771687.737913527.657655212.0第9轮4957.9509560.5455485.215681518.921632374.542564978.3第10轮6965.9289311.8788822.19841136.433063517.141054660.7平均值6868.9284.1299.7843.7869.31900.31833.329712922.45293.45377.8平均误差1.36表3超可加约束条件下随机生成的能耗函数犳(狓)工作状态利用积分最小化的差值拟合方法,可得到如下方程组:求解可得μ=0.664,β=2.62,即拟合后的能耗函数g(x)=μxβ=0.664x2.62.表4给出了分别以f(x)和g(x)为能耗函数时的能量消耗以及它们之间的误差比率.实验中流量请求随机生成并且数量以10的增量从10增加到60.对于每次路由,随机生成一定数量的流量请求,然后在网络拓扑上路由这些请求.表4中的平均值为重复进行10次实验后的平均能耗.f(x)g(x)①Geant2:LightingthepathwayforEuropeanResearchandPage10基于积分最小化的插值方法将分段函数上的每个点都纳入考察,因此拟合后的能耗函数g(x)能够准确描述原能耗函数f(x)的特征.此外,拟合中出现的误差对网络总能量计算的影响是两方面的,当f(x)>g(x)时能量被减少,而f(x)<g(x)时能量被增加,两个方面的作用也降低了实际误差.由表4可知,拟合过程产生的误差维持在2%左右,最多不超过6%.由于CFRA模型中假设网络设备只工作在一定的状态下,对于当前的网络设备更具有普遍适用性,因此在实际网络中CFRA模型较CFSS模型具有更广的应用范围.4.3双度量网络设计问题传统路由协议只采用单度量,力求使延迟最小而不考虑其它因素(如网络容量等),如基于最短路径的路由算法等.由于当前网络规模的扩大,网络环境日趋复杂,在路由问题上部分协议可同时考虑多个度量.但是,同时将能量节省和网络延迟最小作为网络设计度量的研究还很少,尤其是对于适用性更强的超可加分段能耗函数,此问题还没有被研究过.从本文前述的能耗模型可以看出,能耗最优化的路径分配依赖于能耗函数的性质,当能耗函数为线性函数(满足可加性)时,通常的最短路径(shortest-path)路由就是全局能耗最优化的路由;然而当能耗函数为超可加或者次可加函数时,简单的最短路径方法并不能获得全局最优路由.针对现实世界网络中的能耗函数并不是线性函数的特性我们可以在系统能耗和传输延迟之间做出权衡,设计双度量的目标函数.针对降低网络能耗和减小网络延迟的双度量网络设计问题,通过在目标函数中引入参数α,以凸组合的方式将上述两个目标结合起来,我们提出一种多项式时间的能效算法,能够在较低延迟情况下,得到较高的能量节省.优化问题(P1)只考虑了降低网络能耗,通过引入参数α对能量消耗和网络延迟两个目标进行凸组合,则总的消耗可表示为总消耗Cost=α×能量消耗+(1-α)×网络延迟代价.凸组合可以保持两个目标原有的凹凸性,使组合后的问题与原问题可以用相同的方法求解.通过调节参数α可以获得不同的问题描述:当α=0时,此模型退化成基于最短路径的路由问题;当α=1时,模型退化成CFRA模型;当α在(0,1)之间取值时,可以获得能耗和延迟的折中考虑.网络延迟代价可通过对CFRA模型的扩展予以形式化描述:在图G的每条边上引入一个新的特征参数le代表边e的延迟,即边e所抽象的网络设备的延迟.这样总的消耗可以表示为Cost=α×∑e其中Pi表示给请求i分配的路径,C(P1,P2,…,Pk)表示所有请求的路由路径的延迟代价,可以取所有路径延迟的最大值,或所有路径延迟的平均值.如果选取所有路径延迟的平均值作为网络延迟,则总消耗可以表示为其中yi,e表示请求i是否经过链路e,wi表示请求i的传输路径上延迟,AVG(wi)表示所有路径延迟的平均值.因此,给定α后,优化问题(P1)可转换为如下形式(P4).根据凸组合的性质可知,能耗和延迟两个凸函数结合,其目标函数仍然是凸函数.这样采用CFSS模型中求解凸规划和随机舍入的方法,可获得多项式复杂度时间内的最优解.(P4)minα∑esubjectto:xe=∑i本文在Geant2网络拓扑上对参数α和算法性能进行了测试.图3给出了当α取(0,1)间的值时,对于给定能耗函数和随机生成60个流量请求的能图3网络能耗与通信延迟随参数α的变化情况Page11耗与延迟的变化情况.随着α的增大,延迟将逐渐增大,但能耗将逐渐降低.当α在1附近逐渐变小时,网络延迟会迅速减小,而α靠近0时,网络延迟的变化相对平稳.由图3可知当α∈[0.4,0.7]时,能够保证在较低的延迟下获得较高的能量节省.表5给出了不同参数α下网络能耗与延迟的性能对比.实验中原始能耗函数f(x)如表3所示,g(x)=0.664x2.62.表5不同参数α下网络能耗与延迟的性能对比α=0.99α=0.9α=0.8α=0.7α=0.6α=0.5α=0.4α=0.3表5进一步验证了当α∈[0.4,0.7]时,能够保证在较低延迟下获得较高的能量节省.例如当α=0.6时,能耗降低达到了46%而延迟的增加仅为7.1%.5总结网络能耗问题是影响网络系统设计、使用和发展的重要问题.人们已经从局部的、具体的网络设施的角度对节能策略和算法进行了大量研究,而缺乏从网络全局的角度(如网络通讯信息包的调度、路由以及网络的总体部署等)对于网络能耗问题研究.本文从网络全局的路由角度研究了网络节能问题,给出了具体的能耗模型和优化方法.本文首先基于3种基本网络数据传递模式和3种基本网络能耗机制,构建了网络通信能耗优化的系统模型,并且对其中5种关键系统模型给出了详细的形式化描述.然后给出了CFSS和CFRA系统模型下的能效算法.其中,针对CFSS系统模型,我们提出了一种有限容量网络中的全局规划的能效路由算法和基于time-slot思想的节能调度算法.实验表明基于time-slot思想的节能调度算法,可以提高链路带宽的利用率,并且能够有效降低网络能耗.针对CFRA模型,我们利用基于积分最小的插值拟合和随机舍入的方法,提出了一种能效路由策略.同时考虑网络能耗效率和通讯延迟,提出了双度量网络设计问题,并且给出了一种启发式算法,通过调整参数可以获得节能和延迟权衡.实验表明在延迟增加不超过10%的情况下,可以降低超过40%的能耗.本文主要贡献在于,第一,对于具有固定拓扑结构的网络系统的能耗问题从网络全局路由角度抽象出了具体模型并给出了计算路由的算法;第二,给出了可在多项式复杂度时间内计算的路由分配方法(路由算法).其意义在于:第一,作为从全局路由的角度研究网络能耗的模型,它提供了对于从全局路由的角度对于网络能耗的理解认识.比如,他可以解释为什么常用的最短路径路由方法不能给出最优的能耗以及如何通过调整对延迟和能耗的权衡的参数可以在最短路径和能耗之间取得所期望的权衡或达到整体上“最好的”(最理想的)效果.第二,所给出的路由算法难于直接在分布式路由器的网络中直接实现,但本文的模型和算法可以作为评价和比较不同路由算法在能量消耗方面的一个标准.由于大量网络中具体的消息路由是由网络中多个没有集中控制机构的路由器以分布式的计算形式给出的,本文所给出的路由算法难于直接在分布式路由器的网络中实现.如何设计分布式路由器中易于实现的分布式高能效路由算法是值得进一步研究的重要问题.此外,针对PPPD、PPRA和AARA系统模型,如何对它们进行形式化描述,从而基于这三个系统模型开发设计实用的能效算法等,也是值得进一步研究的重要问题.致谢本文的研究中,我们与美国贝尔实验室(BellLabs)MatthewAndrews研究员和LisaZhang研究员进行的多次讨论,使我们获益匪浅,在此深表感谢!
