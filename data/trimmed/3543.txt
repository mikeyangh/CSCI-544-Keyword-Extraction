Page1用于图像认证的变容量恢复水印算法陈帆1)和红杰2)王宏霞1)1)(西南交通大学信息安全与国家计算网格实验室成都610031)2)(西南交通大学四川省信号与信息处理重点实验室成都610031)摘要兼顾水印嵌入容量和安全性,提出一种水印容量可变的数字图像可恢复水印算法.该算法提取2×2图像块特征生成变容量恢复水印———平滑块6比特,纹理块12比特.图像块的恢复水印基于密钥随机嵌入在其它图像块的低有效位,通过比较图像块特征与相应恢复水印重构的块特征并结合邻域特征判定图像块的真实性.变容量恢复水印用尽可能少的比特数保存足够的图像块信息,仅被嵌入一次且同时用于篡改检测与恢复,不仅有效降低了水印嵌入容量,而且提高了算法抵抗恒均值攻击的能力.实验仿真结果表明,该算法得到的含水印图像和恢复图像的质量好,且能有效抵抗拼贴攻击、恒均值攻击等已知伪造攻击.关键词数字图像;恢复水印;篡改检测;水印嵌入容量;变容量1引言随着信息技术,尤其是网络和数码成像技术的发展,数字图像成为人们获取与交换信息的主要来源和信息传播的重要载体之一.图像数字化存储和各种图像处理软件的出现使数字图像的编辑、修改等处理变得简单.数字图像处理技术提高了图像的显示质量.如果篡改和伪造数字图像被用于新闻媒体、法庭证据、科学发现等领域,对社会的诚信、政府的公信力和科学的真实性等可能带来严重的负面影响.因此,如何检测和鉴别数字图像的真实性和完整性已成为近年来国内外的前沿性研究课题,不仅具有重要的学术价值,更具有重要的社会意义和广泛的应用前景.基于数字水印的数字图像真实性鉴定应满足以下几点:①不可见性.人的感知系统察觉不到嵌入水印后的数字图像与原始图像的不同,一般用含水印数字图像的峰值信噪比(PSNR)来衡量;②安全性.理论上,以100%的概率检测出对数字图像恶意的改变;③盲检测.对数字图像认证不需要原始图像;④篡改检测与定位.检测并定位数字图像被篡改区域(图像块/像素);⑤篡改恢复.近似恢复篡改区域的原始内容,为推断篡改方式和攻击者的目的提供依据.篡改恢复对基于数字水印的数字图像真实性鉴别技术提出更高的要求.为提高篡改恢复质量,水印算法需准确判定图像块的真实性.因为篡改块未被检测或真实图像块被误判为篡改,将导致恢复图像中存在未被恢复或被错误恢复的图像块,从而降低图像的恢复质量.为降低图像块与其恢复水印同时被篡改的可能性,Fridrich等人[1]指出图像块的恢复水印不能嵌入在图像块自身,而是嵌入在其它图像块中,不过这使篡改检测变得相对困难[2].为解决可恢复水印算法的篡改检测问题,Lin等人[3]提出了一种分层检测可恢复水印算法,除为每个2×2图像块生成6比特恢复水印(块均值)外,还附加生成2比特的认证水印.图像块的2比特认证水印嵌入在图像块自身的低位,用来检测该图像块的真实性.附加认证水印的思想被许多研究者采用,如文献[4-7],然而附加认证水印无疑增大了水印嵌入容量,且认证水印的块独立特性使其易受拼贴攻击(collageattack)[8].为此,文献[9-10]基于密钥伪随机生成图像块恢复水印在宿主图像中的嵌入位置,通过比较恢复水印的一致性并结合邻域块的分布特性判定图像块的真实性.在不增加水印嵌入容量的前提下,实现可恢复水印算法的篡改检测.提高图像恢复质量还需解决同步篡改问题(tamperingcoincidenceproblem)[6],即如何有效恢复同步篡改块(即内容和相应恢复水印同时被破坏的篡改块)的问题.文献[9-10]无法对“同步篡改块”进行有效恢复,尽管其篡改检测优良,但算法的篡改恢复质量不高.为有效恢复同步篡改块,研究者提出将恢复水印多次重复嵌入[4-5]在图像中,当一个版本的恢复水印被篡改时,用另外一个版本的恢复水印对篡改块进行恢复.此外,文献[6-7]利用共享机制解决同步篡改块的恢复问题,其实质是通过增加冗余信息来实现.如文献[7]将64比特块特征扩展成为160比特的参考比特(referencebits).多次重复嵌入和共享机制等策略能提高可恢复水印算法的恢复质量,但算法水印嵌入容量的增加也会降低含水印图像的质量.此外,恢复水印生成方法也是影响篡改恢复质量和算法安全性的重要因素.现有生成恢复水印最常用的方法有2种:①8×8图像块重要DCT系数的量化编码[1,7,10],其缺点是定位精度较低.②2×2图像块的平均值[3-4,9],定位精度高,但易受恒均值攻击(constant-averageattack)[11].假设2个图像块B1=(30,30,30,30)和B2=(1,1,59,59),它们的平均值相同,因此在利用2×2图像块均值生成恢复水印的算法中它们的恢复水印是相同的.如果用图像块B1替换块B2,通过比较恢复水印检测块真实性的算法[9]不能检测该篡改(即不能抵抗恒均值攻击),而利用附加认证水印检测块真实性的算法[3-4]得到的恢复图像的质量不高,因为恢复水印仅能重构B2的均值,而无法重构B2的纹理特征.如果图像块恢复水印除保存块均值特征外还保存块纹理特征,则算法的恢复质量和安全性都会得到提高.不过,这无疑会增加水印容量,且对类似B1这样的平滑块也无需纹理特征.本文提出的算法思想是对平滑和纹理图像块分别生成不同长度的恢复水印,同时实现恢复水印的变长嵌入和提取,从而用尽可能少的水印容量提高算法的恢复质量和安全性.目前尚未见到变容量恢复水印算法方面的研究报道.综上所述,现有可恢复水印算法的水印嵌入容量都是固定的,篡改恢复质量和安全性提高大多依赖于水印嵌入容量的增加.兼顾水印嵌入容量和安全性,本文提出一种水印嵌入容量可变的恢复水印Page3算法,该算法首先提取2×2图像块特征生成变容量恢复水印信息———平滑图像块6比特,纹理图像块12比特,然后将图像块的恢复水印基于密钥随机嵌入到其它图像块的低有效位.认证时通过比较块特征与相应恢复水印重构特征并结合邻域特征判定图像块的真实性.变容量恢复水印在尽可能多保存原始图像信息的同时使水印容量最少,另外,本文算法的恢复水印仅被嵌入一次且同时用于篡改检测和篡改恢复,既提高了算法抵抗拼贴攻击的能力,又降低了水印嵌入容量,从而提高了含水印数字图像的质量.为提高篡改恢复质量,首先利用提取的有效恢复水印修复篡改块,然后利用有效邻域像素修复同步篡改块.与最近文献[4]和[6]的实验比较结果表明,本文算法的水印嵌入容量最小,且能有效抵抗拼贴攻击、恒均值攻击等已知伪造攻击.2变容量恢复水印本文提出的变容量恢复水印算法分为水印生成与嵌入、水印提取与篡改检测、篡改恢复3个部分.2.1水印生成与嵌入图1示出恢复水印的生成与嵌入过程,包括以下5个步骤.(1)分块并分类.将大小为2m×2n的原始图像X分为m×n个互不重叠的2×2图像块,按从上至下、从左至右对图像X的块编号:X={Xi|i=1,2,…,N},其中N=m×n为图像块个数.大小为2×2个像素的图像块表示为Xi={xi1,xi2,xi3,xi4}.如果图像块Xi中2个最大像素高5位之和与2个最小像素高位5位之和的差不超过3,则认为图像块Xi为平滑图像块,否则为纹理图像块.(2)伪随机序列与块链生成.基于用户密钥Key生成长度为N的实值伪随机序列R={ri|i=1,2,…,N},根据R生成块链{(Xi,Xi)|i,i∈[1,N]}以确定每个图像块的水印嵌入位置,其中i为R中第i个元素在R中的索引位置,详见参考文献[9].(3)特征提取.对每个图像块Xi,生成v比特块特征Fi={fi1,fi2,…,fiv}.fi2~fi6为图像块Xi高5位平均值的二进制编码,即其中(·)B表示整数的二进制编码.如果图像块为平滑图像块,v=6且fi1=0,否则,v=12且fi1=1.图2给出了非平滑图像块的6种类型及相应的子类编码,其中黑色表示2×2图像块中最大2个像素的位置;fi7~fi9为子类编码;fi10~fi12为2个最大值像素之和与其它2个像素之和的差均匀量化的二值编码,即fi10~fi12=1式(2)中的4个像素满足xi1xi2xi3xi4.(4)恢复水印生成.利用伪随机序列R的第i个随机数ri生成二值伪随机序列Bi={bij|j=1,2,…,12},加密图像块特征Fi生成恢复水印Wi={wi1,wi2,…,wiv},其中,为异或操作.(5)水印嵌入.对每个图像块Xi,由步(2)生成的块链得到其映射块Xi.把图像块Xi的恢复水印Wi嵌入到其映射块Xi的低位生成含水印图像块Yi:如果Xi为非平滑图像块,将12比特恢复水印wi1~wi12嵌入Yi,Yi=xij/8×8+4wi(j+8)+2wi(j+4)+wij(4)如果Xi为平滑图像块,将6比特恢复水印Yi=xij/4×4+2wi(j+4)+wij,j=1,2wi1~wi6嵌入Yi,2.2水印提取与篡改检测图像Y为被测图像,水印提取是水印嵌入的逆过程,篡改检测是判定每个图像块的真实性.用篡改检测矩阵犜=(ti|i=1,2,…,N)表示检测结果,ti=1表示被测图像块Yi被篡改,ti=0表示被测图像块Yi是真实的.Page4(1)分块、伪随机序列和块链生成.按2.1节中的“水印生成与嵌入”的步(1)和(2)把Y划分为2×2的图像块Y={Yi|i=1,2,…,N}并基于密钥Key生成随机序列R={ri|i=1,2,…,N}和块链{(Yi,Y(2)块特征计算与重构.对每个待测图像块Yi,按2.1节中的“水印生成与嵌入”的步(3)计算图像块特征Fi,同时根据从其映射块Y水印Wi重构块特征FL其中,Bi为基于伪随机序列R的第i个随机数ri生成的长度为12的二值伪随机序列,从待测图像块Yi的映射块Yj=1,2,…,12}如式(7)所示,wij=(3)特征比较.对每个待测图像块Yi,比较高位计算的块特征Fi与由其恢复水印重构的块特征FL并生成比较矩阵犇={di|i=1,2,…,N},di=0,∑c其中,c=6(1+f6个比特,非平滑图像块比较Fi与FL比特.(4)篡改检测.首先根据比较矩阵犇生成其邻域特征矩阵Δ={δi|i=1,2,…,N}(边界不作处理,详见文献[9]),δi=∑dj,j=i±1,i±n,i+n±1,i-n±1(9)然后根据矩阵犇和Δ生成初态篡改检测矩阵犜0=(t0i|i=1,2,…,N),最后,修正初态篡改检测矩阵犜0并生成篡改检测矩阵犜=(ti|i=1,2,…,N),其中τi=∑t02.3篡改恢复如果被测图像中存在被判定为篡改的图像块,则对被测图像依次执行以下2步操作得到篡改恢复图像YR.(1)特征恢复.对判定为篡改的图像块Yi,如果其映射块Y对Yi进行恢复,得到修复图像块YRi,其中,Γ-1()为图像块特征编码的逆过程.并生成同步篡改块的标示矩阵犔=(li|i=1,2,…,N),(2)邻域恢复.在上步恢复的结果上,如果li=1,即篡改块Yi为同步篡改块,则用与图像块YRi相邻12个像素中的有效像素的均值修正图像块YRi中的每一个像素.3性能分析与比较本文从鉴定数字图像真实性的实际需要出发,用以下5个指标来衡量可恢复水印算法的性能:①水印嵌入容量.单位像素嵌入的比特数(bitperpixel,bpp);②含水印图像质量.与原始图像的峰值信噪比(PeakSignal-to-NoiseRatio,PSNR);③篡改检测性能.漏警概率和虚警概率;④篡改恢复质量.篡改恢复图像与含水印图像的PSNR;⑤恢复水印信息量.水印重构图像与原始图像的PSNR.下面给出本文、Lee等人[4]和Zhang等人[6]的实验仿真与比较结果.由于文献[6]中第2个算法(Hierarchicalself-embeddingscheme)的性能更优,因此本文仅给出与文献[6]第2个算法的比较结果.3.1水印嵌入容量与水印信息量表1给出了本文、Lee等人[4]和Zhang等人[6]的水印嵌入容量和含水印图像质量比较结果.由表1可以看出,文献[4]和[6]的水印嵌入容量固定为3bpp,本文算法的水印容量是可变的,表中给出数字图像的水印嵌入容量的变化范围为1.8~2.62bpp,图像越平滑,水印嵌入容量越小.与之相对应,文献[4]和[6]对不同图像生成的含水印图像的PSNR相似,分别约为40.5dB和38dB.文献[4]生成的含水印数字图像的PSNR比文献[6]高约2.5dB,这是由于文献[4]在水印嵌入时采用了“平滑”技术.由于不同数字图像的水印嵌入容量不同,本文算法生成的含水印数字图像的PSNR变化较大,介于39~43dB之间,图像越平滑,生成含水印图像的质量越好,由表1看出本文的含水印图像的质量整体上明显优于文献[4]和[6].Page5表1水印嵌入容量和含水印图像质量333333333LenaBeachAirplaneMonaLisaManNapoleonGoldhillBarbaraFingerprint2.62恢复水印包含原始图像的信息量(简称“水印信息量”)越多,相同条件下算法的篡改检测概率越大,篡改恢复质量也越高.理想情况是用尽可能少的比特保存尽可能多的图像信息.兼顾算法定位精度和抗恒均值攻击的能力,本文在提取2×2图像块均值的同时,对纹理图像块增加“细节”编码,从而保存更多原始图像的信息,即增加了水印信息量.相应地,根据水印信息重构图像的质量也会更好.为定量地比较算法生成恢复水印的信息量,表2给出了恢复水印重构图像与原始图像的PSNR.文献[4]的恢复水印是2×2图像块的均值编码,本文在均值编码的基础上,添加了对纹理图像块的细节编码,因此,对不同的数字图像,本文恢复水印重构图像的质量都优于文献[4].由表2看出,本文算法的恢复水印重构图像的PSNR高于文献[4]约5dB以上,有的甚至高达9dB(如Napoleon).文献[6]对8×8图像块分层编码,8×8图像块的编码长度为167(102+45+20)比特,尽管图像块的特征编码比特数多于本文算法,但恢复水印重构图像的质量并没有优势.由表2可以看出,文献[6]恢复水印重构图像的PSNR仅Goldhill图像的高于本文算法约1dB,其它图像的PSNR都低于本文算法,有的甚至高达10dB(如Fingerprint).表2恢复水印重构图像与原始图像的PSNR比较图像LenaBeachAirplane33.3526.87MonaLisa34.9125.55ManNapoleon33.3424.14Goldhill33.0227.41Barbara30.4324.26Fingerprint30.0624.22总之,文献[4]和[6]的水印嵌入容量是固定的,而本文的水印嵌入容量是可变的,数字图像越平滑,水印嵌入容量越少,相应地生成含水印数字图像的质量也越好.由于在水印嵌入时没有引入冗余信息,本文的水印嵌入容量低于文献[4]和[6],而恢复水印信息量总体也优于文献[4]和[6],为提高算法的安全性和篡改恢复质量提供了保障.3.2篡改检测与篡改恢复现有恢复水印算法都能检测一般篡改,其差别主要体现在定位精度、篡改检测性能和篡改恢复图像质量的高低.图3给出一般篡改条件下,本文、文献[4]和[6]的篡改检测与篡改恢复的结果.其中,图3(a)是大小为328×328像素的Beach原始灰度图像,图3(b)为利用本文算法生成的含水印数字图像,其PSNR为42.93dB,图3(c)为篡改图像,其中包含以下篡改:①上方添加文字“ITPSouthwestJiaotongUniversity”;②下方添加一只小鹿.篡改像素的比例约为7.78%.图3(d)、(e)和(f)分别为本文、文献[4]和[6]的篡改检测结果;图3(g)、(h)和(i)分别为本文、文献[4]和[6]的篡改恢复图像.利用2×2像素的均值生成恢复水印其定位精度较高,却不能抵抗文献[11]提出的恒均值攻击.本文提出的变容量恢复水印扩大了水印信息量,也提高了算法抵抗恒均值攻击的能力.图4给出恒均值攻击条件下,本文、文献[4]和[6]的篡改检测与篡改恢复结果.其中,图4(a)是大小为256×256像素的Lena原始灰度图像,图4(b)为利用本文算法生成的含水印数字图像,图4(c)为篡改图像,其中,大小140×140像素的正方形区域遭到恒均值攻击,篡改比例约为30%.图4(d)、(e)和(f)分别为本文、文献[4]和[6]的篡改检测结果,图4(g)、(h)和(i)分别为本文、文献[4]和[6]的篡改恢复结果.拼贴攻击[8]是对脆弱水印算法威胁最大的攻击之一,现有很多脆弱水印算法不能有效抵抗该攻击.图5(a)和(b)分别是利用相同密钥生成的含水印Napoleon和MonaLisa灰度图像,大小均208×328Page6图3一般篡改时的篡改检测与篡改恢复性能比较像素.将含水印Napoleon图像显示的头部区域替换为含水印MonaLisa图像的相同区域(拼贴攻击),得到的篡改图像如图5(c)所示,篡改比例约为18%.图5(d)、(e)和(f)分别为本文、文献[4]和[6]的篡改检测结果,图5(g)、(h)和(i)分别为本文、文献[4]和[6]的篡改恢复结果.为定量比较算法的篡改检测和恢复性能,表3表3篡改检测性能与篡改恢复质量比较一般篡改0.37.900.390.415.1943.6333.3245.24恒均值攻击0.21100.000.9403.6930.8111.2028.46拼贴攻击2.0398.486.670.1302.2733.8217.2617.72结合图3和表3可以看出,一般篡改条件下,文献[6]的漏警概率最低,但虚警概率较高,这主要是由于文献[6]的图像块大小为8×8像素.文献[4]的虚警概率较低(0.41%),而漏警概率较高(7.9%),给出了上述3种篡改方式下,本文、文献[4]和[6]的篡改检测性能(漏警概率和虚警概率)和篡改恢复质量(篡改恢复图像与原始图像的PSNR).由图3~图5的仿真结果可以看出,本文和文献[4]定位篡改的基本单位是2×2像素,文献[6]是8×8像素.为统一衡量标准,文献[6]漏警概率和虚警概率也以2×2像素为单位计算.虚警概率/%这是由于文献[4]仅用2比特认证水印检测图像块的真实性,导致篡改边界(尤其是添加的文字)存在较多没被检测的图像块.本文算法的漏警概率和虚警概率都较低,分别为0.3%和0.39%.由于漏检的Page7图4恒均值攻击时的篡改检测与篡改恢复结果比较篡改块不执行篡改恢复,文献[4]在一般篡改下的恢复质量不高.相应地,文献[6]的漏警概率为0,所有被篡改的图像块都能进行篡改恢复,且由于篡改比例小,三层编码都能得到有效恢复,因此文献[6]的恢复质量最好.由于本文算法的漏警概率不为零,导致此条件下本文的恢复质量略低于文献[6].本文、文献[4]和[6]的恢复图像的PSNR分别为43.63dB、33.33dB和45.24dB.显然一般篡改条件下,本文算法能精确定位篡改且能得到质量较好的恢复图像.结合图4和表3可以看出,恒均值攻击条件下,文献[4]的漏警概率和虚警概率分别为100%和0%.由于没有检测到篡改块,文献[4]算法不执行篡改恢复操作,说明文献[4]不能抵抗恒均值攻击.文献[6]能有效抵抗恒均值攻击,其漏警和虚警概率分别为0%和3.69%,然而由于篡改比例较大(约30%)导致文献[6]第三层的一些编码比特不能正确恢复,导致恢复图像的质量略低,恢复图像与含水印图像的PSNR为28.46dB.本文算法的漏警和虚警概率分别为0.21%和0.94%,其篡改恢复图像与原始图像的PSNR为30.81dB,说明本文算法能有效抵抗恒均值攻击.结合图5和表3可以看出,拼贴攻击条件下,文献[4]和[6]的漏警概率较高,分别为98.4%和86.67%.从图5(e)和(f)可以看出,文献[4]和[6]仅检测出拼贴区域的边界,拼贴区域的内部通过认证.文献[4]和[6]之所以能检测出拼贴区域边界的图像块,主要是因为拼贴区域不是以图像块为单位实施的篡改.由于漏检的篡改块不执行篡改恢复操作,导致文献[4]和[6]的篡改恢复质量较低,它们恢复图像的PSNR分别为17.26dB和17.72dB,说明文献[4]和[6]都不能有效抵抗拼贴攻击.本文算法的漏警概率和虚警概率分别为2.03%和0.13%,其恢复图像的PSNR为33.82dB,说明本文算法能有效抵Page8图5拼贴攻击时的篡改检测与篡改恢复性能比较抗拼贴攻击.本文算法中的恢复水印容量是可变的,数字图像越平滑,生成的恢复水印量越少.在满足保存适量块信息的前提下降低了恢复水印的容量,从而提高了含水印图像的质量.同时,本文算法具有较高的安全性和篡改恢复质量.在一般篡改、恒均值攻击、拼贴攻击下,都能精确定位篡改位置、高概率检测篡改块并得到高质量的恢复图像.4结束语现有数字图像可恢复水印算法的水印嵌入容量都是固定的,其篡改恢复质量和安全性的提高,主要依赖于水印嵌入容量的扩大,而水印嵌入容量的扩大降低了含水印图像的质量.兼顾水印嵌入容量、安全性和篡改恢复质量,本文根据图像块自身特性生成变容量恢复水印,并从以下几个方面来提高算法的各项性能:(1)根据图像块的平滑或纹理特性,生成容量可变的恢复水印信息;(2)实现变长恢复水印的嵌入、提取和篡改检测;(3)无需增加认证水印信息且恢复水印仅嵌入一次,降低水印嵌入容量.与文献[4]和[6]的实验比较结果表明,本文算法的定位精度为2×2像素、水印嵌入容量可变、含水印数字图像的质量更好且能有效抵抗已知的伪造攻击,Page9如拼贴攻击、恒均值攻击等.如何进一步降低本文算法的漏警概率、篡改检测性能分析将是我们下一步的研究内容.
