Page1鉴别式多核手跟踪沙亮王贵锦林行刚(清华大学电子工程系智能技术与系统国家重点实验室图形图像分室北京100084)摘要快速运动、背景混杂及手的特殊性为传统的核目标跟踪技术提出了挑战.文中提出一种鉴别式颜色子空间选择和多核校正机制的核跟踪方法.首先基于前景背景建模,通过鉴别函数选取最优鉴别式颜色子空间集,再基于训练的肤色模型保留高置信子空间表征目标.其次,为适应尺度变化和快速运动,基于多核快速估计相似度表面以校正初始核位置,迭代定位目标.实验表明,融合二者的跟踪器在有效性和速度上都实现了满意的性能,满足实时性需要.关键词核目标跟踪;鉴别式特征选取;混合高斯模型;计算机视觉1引言低计算复杂度,易于实现和出色的性能使核目标跟踪[1]成为计算机视觉领域的研究热点.在核跟踪方法中,目标通过核加权的颜色直方图描述,位置Page2核跟踪即失效.文献[3]中提出了多核跟踪方法以解决该问题,但由于计算复杂度高,无法满足实时性需要.特别地,以手为代表的链接体是由内在关节约束进行自身形变的一类物体,在人机交互和安全认证等领域具有重要意义.手的自运动,在外观下的体现为尺度、旋转和自遮挡等复杂的变化,如果结合背景混杂和快速运动等不利条件,则对核跟踪提出了更为严峻的挑战[4].为在背景混杂和快速运动等复杂条件下实现低计算复杂度的鲁棒手跟踪,本文提出了一种鉴别式多核跟踪方法.在目标描述层面,结合在线邻域背景图1算法原理框图本文第2节简介核跟踪方法;第3节和第4节分别描述鉴别式子空间特征选取和多核跟踪机制;第5节分析实验性能;第6节进行总结.2核跟踪简介传统的核跟踪技术首先通过核映射,将目标区域的像素依据其彩色信息值生成核加权式直方图,作为目标的描述子,如式(1):其中函数b:个像素位置狓i的索引值b(狓i)映射到量化的特征直方图中的第u个bin(u∈{1…m})中.C为一个归一化常数;k(·)是一个d维空间加权的核函数,为与其它文献对比,本文中采用Epanechnikov核,如式(2)k(x)=式(2)中Cd为d维单位球的体积.其后,依据目标模型狇^u,核跟踪过程目的为最大化目标模型与在图像的一个局部区域狔^最大化候选描述子狆^(狔)=信息,利用鉴别式函数,从中在线选取最优子空间特征并在此基础上描述目标,再由离线训练的手的肤色模型选出高置信度候选的线性子空间集组成描述子,从而避免了背景混杂条件下跟踪器的漂移.针对快速运动的问题,提出了两步多核跟踪机制.第一步利用尺度自适应多核机制估计目标相似度曲面,修正当前帧中可能与目标区域不重叠的初始位置,第二步通过mean-shift迭代估计新目标位置.这一方法引入的计算成本很低,但使核跟踪的鲁棒性大大提升.图1给出了该方法的整体框图.{p^u(狔)}m对上式在狔^0处连续,可微分,在狔^0处进行Taylor展开,对狔求一阶偏导数,即转化为式(4)的从当前位置狔^0到新位置狔^1的迭代过程:其中δ(·)为符号函数,式(4)的收敛速度很快,通常3~5步完成[2],从而较好地保证了核跟踪的实时性能.3鉴别式手描述所谓鉴别性,是指能够最大程度地区分目标和背景的特性[5].而鉴别式特征选取就是通过评估一系列特征子空间的鉴别性来确定最优的一部分来描Page3述目标,其基础是充分大的候选特征子空间集.考虑到核跟踪中利用的是颜色特征,本方法利用式(6)通过线性映射的方式生成这一子空间集.在式(6)中,原图像犐(x)={Ij(x)}T中像素x在子空间i中的特征值Ψi(x)通过加权系数矢量αi={αi,j}T映射到特征子空间中.应当强调的是,这种映射方式的数量是无限的,可保证生成充分大的候选子空间集{Ψi}.在线环境中,对每个候选Ψi,鉴别式的目标描述可借鉴局域内的目标检测问题[6]来进行前景和背景建模.在本文的方法中,前景自然是目标区域,而背景则确定为目标的局部邻域.其原因有二,一是对全图进行背景建模的评估复杂度过高,二是考虑到核跟踪的迭代过程通常仅涉及目标的邻域.因此利用目标和邻域建模是合理的.依据核跟踪框架,将各灰度子空间图像Ψi的前景和背景区域分别建模为mbin直方图hi(o)={hi,j(o)}m{hi,j(b)}m数形式鉴别度:在式(7)中,li为一个类似Fisher准则的简化评估函数.li越大,相应的子空间i的鉴别性越好.利用li保留鉴别性最大的J个子空间进行置信度评估.注意到手的一大特性是肤色上具备彩色空间上图2子空间及其分割图示例集中性.利用这一特性可有效提高选取子空间的置信度,本系统中通过标记505帧超过400000个肤色区域的像素并以其余像素为非肤色区域,使用EM算法,生成16核的肤色混合高斯模型.式(8)给出了混合高斯模型的基本形式:p(狓)=∑N其中狓为该像素的颜色矢量,第i个高斯核的贡献决定于标量权重ωi、均值矢量μi和协方差矩阵Σi.p(狓)即为该像素属于肤色的概率.在此基础上,定义如式(9)的置信度函数:其中oi={oi,j}No当前前景和背景像素集,则ri可认为是前、背景区域中肤色像素似然比.ri越大,对应的子空间置信度越高.通过式(9)的置信度函数在鉴别度最大的J个子空间中保留置信度最大的J个子空间.定义为矢量连接各子空间上的核加权直方图,则最终生成的描述子为式(10):图2(a)中给出了一些在线选择的高鉴别度子Page4空间图像实例.与直接转换为灰度图像(图2(a)第1幅)相比,都更有效地鉴别出手的区域.但结合图2(b)中利用式(7)对相应(a)中子空间的前背景分割图来看,手区域的置信度差异很大.通过式(9)的进一步评估,只有3个子空间得以保留.值得注意的是,这种基于在线鉴别式选取和离线学习的先验知识监督的机制有3点好处:(1)可以灵活地对不同类别的目标嵌入不同的特征集;(2)合理地在离线和在线部分中分配了特征选择过程中的计算量,适合于实时跟踪的应用;(3)直方图形式的描述子适合不同的跟踪器框架,扩展性强.4两步式多核跟踪为解决邻帧目标不重叠情况下传统核跟踪收敛于错误位置的问题,本部分讨论利用多核校正初始核位置的核跟踪方法.其基本思路在于通过快速估计关于目标模型的观测相似度表面,在以真实目标为中心的区域内重新定位mean-shift迭代的初始位置.由于相邻帧内目标不重叠的情况是严格依赖于目标尺度的,而目标的尺度越小,其在快速运动条件下不重叠的可能性就越大,从而核跟踪失效的可能性越大.因此,为建立多个候选的核位置函数f(·),我们定义其为目标水平方向和垂直方向上的尺度(w,h)成负相关的线性分段函数,这一分段函数在水平方向上的采样步长为类似可得垂直方向的采样步长m_step.y.从而选取K×K个核位置.图3例示了不同尺度目标选取多核位置的例子,其中矩形为前景和背景区域,灰色圆点为候选的多核位置,黑色圆点为真实的目标中心.由于图3(a)中的目标尺度较大,其间隔的步长为目标尺度的一半;而图3(b)中的目标尺度较小,其间隔步长近似与目标尺度相同.以这K×K个位置为中心将相似度表面的观测区域划分K×K个子区域,对每个子区域依据高斯分布随机地抽取一个位置为中心生成核加权的直方图描述子.由于Bhattacharyya系数具备在目标邻域内的凸性,利用该系数来度量它们与目标模型的相似度,选择相似度最大的区域为修正后的mean-shift的迭代初始位置,可以保证收敛的可靠性.需要指出的是,如果最大的相似度ρ1和次大ρ2的相似度非常接近,则需要对相应的两区域加权来确定初始位置,如式(12):其中x1与x2为相似度最大的两区域位置的水平分量,x为加权后的迭代初始位置的水平分量,类似可得垂直分量.利用修正后的初始位置,即进行第2步的标准mean-shift迭代,确定当前帧中目标的最终位置.为适应尺度变化,采用了文献[7]中的目标尺度和模型更新机制.5实验结果为验证本文算法的性能,在配置为Intel1.6GHzCPU和2GB内存的微机上用C语言实现.测试中描述子候选子空间数为3,多核采样数为5×5.此条件下算法对320×240像素的彩色视频可以达到15~20帧/s的处理速度,满足实时性要求.下面设计两组实验评估算法的性能.为更明晰地反映本文算法的准确性和鲁棒性,实验中与基本核跟踪算法[1]和当前较为先进的多实例学习跟踪器[9]进行了对比.在图4和图5的(a)子图中分别用圆、椭圆和矩形标记上述跟踪器在相应帧上的结果,(b)子图则采用不同符号绘出多个跟踪器在相应视频上的L-2误差.5.1快速运动下的跟踪器性能本实验中,测试对象为使用300万像素的摄像头采集的200帧分辨率为640×480像素的视频.以小尺度的握紧的手为目标,大小为40×30像素,在人脸附近做快速的运动,并一度通过面部.其难点在于遮挡性和部分帧中目标无交叠.图4验证本文方法在上述运动下都能正常工作;由于目标尺度很小,传统的核跟踪算法在通过人脸时错误地锁定在颜色接近且目标较大的面部,而多实例学习跟踪器在快速运动下随机地在混杂的背景区域中摆动,也较为迅速丢失目标.值得注意的是,如图4(a)所示,尽管Page5图4快速运动下的小尺度手跟踪实验图5复杂外观变化与背景混杂条件下的手跟踪性能目标邻域的光照较暗且背景混杂,本文跟踪器确保了目标描述的准确性.5.2复杂外观变化下的手跟踪本节一段600帧320×240像素的视频中以手为目标,包含尺度、旋转、形变和自遮挡等多种变化,其背景混杂的程度也较高.传统核跟踪器和多实例学习跟踪器均很快丢失目标,而我们的算法能够适应这些变化,持续锁定目标,图5(b)中清楚地反映Page6了准确性;图5(a)中,尽管在一些特殊帧(如592帧),由于目标形变和快速运动的模糊,误差较大,但我们的在线特征子空间选取机制很快适应了目标外观的改变,跟踪器重新锁定了目标的真实位置,从而确保跟踪性能鲁棒性.6结论本文提出了一种结合鉴别式子空间特征选取和多核迭代位置校正的核跟踪方法,在算法复杂度增加很小的代价下大大提升了处理复杂条件下手的核跟踪性能.该方法可推广到多种类型的目标,可利用不同的特征描述,适合多种计算平台,实时性能好.今后的改进方向包括在线更新机制的优化和结合多尺度多特征的特征选取机制等.
