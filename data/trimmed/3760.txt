Page1进化大规模脉冲神经网络的发育方法蔺想红1),2)张田文2)张贵仓1)1)(西北师范大学数学与信息科学学院兰州730070)2)(哈尔滨工业大学计算机科学与技术学院哈尔滨150001)摘要通过自然进化得到的脑包含几十亿的神经元和几万亿的神经连接,并表现出复杂的智能行为.受生物脑进化与发育的启发,研究者给出了进化神经网络的发育编码方法,特点是通过基因重用可在较小的基因空间中进行大规模神经网络的快速搜索.以人工基因组模型为框架描述基因调控网络,用基因表达的动态特性表示细胞命运特化的发育过程,提出了一种进化大规模脉冲神经网络的发育方法.该方法的特点在于可以快速有效地发育生成脉冲神经元、神经连接和突触可塑性.相应的食物采集进化实验突现了以神经驱动的自主智能体的智能行为,并验证了该方法对大规模脉冲神经网络的进化能力.关键词脉冲神经网络;基因调控网络;发育机制;进化算法;自主智能体1引言生物的脑是我们已知世界中非常复杂的一个物体.尽管对于脑的认识还远远不够,但是研究组成神经系统的神经元产生感觉、行为和高级精神活动的方式已经成为科学研究中成果最丰硕的领域.脑是由神经系统的生长模式、神经元特性、轴突导向、突触形成及可塑性等一系列发育阶段构成的整合体,由最初少量胚胎细胞成为神经前体细胞开始,到突现智能行为为止.生物神经系统是由大量神经元组成的一个复杂的互连网络.据统计,人类大脑有1010~1011个神经元,每个神经元与103~105个其它的神经元通过突触互相连接,从而构成一个极为庞大复杂的网络.近年来,受生物神经网络进化与发育的启发,人工进化神经网络的研究越来越引起人工智能界的重视.对于大规模神经网络的进化,研究者提出了发育方法.发育方法采用间接编码从基因型逐步发育生成表现型[1-2].应用发育方法进化神经网络,有以下优点:(1)神经网络的结构具有高度重复性,这样就可能用少量的基因表达大量的神经元群.通过发育过程,应用相对较小的基因序列就可生成大规模的神经网络;(2)应用发育过程可生成逐渐分化的网络模式.在大脑皮层中,不同的区域具有不同的功能,但实际上它们都具有类似的子结构;(3)小数量的基因变化可造成神经网络结构的巨大变化.因此,在进化过程中通过很小的代价就能得到不同种类的网络结构,加速进化的进程;(4)发育过程有利于神经模块结构的进化.每组基因编码一群神经元,或者说一个神经模块.在进化过程中,以神经模块为单位进行相应的基因变化和功能评价,以便加快大规模神经网络的进化速度.综上所述,发育方法的特点是一个基因在不同的发育阶段多次表达,在较小的基因空间中可进行大规模神经网络的快速搜索.根据基因型的表示不同,发育方法可分为文法编码方法和基因调控网络方法两类.文法编码方法用表达发育过程的文法规则集合表示基因型,通过重复使用文法规则生成神经网络.Kitano[3]首次应用可进化的文法重写规则研究神经网络连接矩阵的进化,尽管直接编码方法在性能上要优于它,但在应用文法系统进行神经网络的进化方面,Kitano提出的图生成文法是一种有益的尝试.Gruau[4]应用文法树来编码神经网络的发育步骤,文法树的每个节点对应一个发育指令.由于该系统是通过发育指令指导单细胞分裂、改变细胞连接来生成神经网络,因此称为细胞编码方法.针对细胞编码方法存在的一些问题,Luke和Spector[5]提出了边编码方法,其网络增长过程主要通过修改网络中的边而非节点进行.最近,Suchorzewski[6]给出了与细胞编码类似的发育符号编码方法,进化了具有可扩展性和模块化的自适应神经网络.Jung[7]应用上下文无关的文法分别表示神经发育规则和连接分支规则,通过细胞分裂树生成具有分层、模块、重复和分形连接结构的神经网络.文法编码方法的优点是发育过程控制简单,很容易生成神经网络.但文法规则的设计与进化困难,限制了对复杂问题的求解.基因调控网络方法用控制发育过程的基因调控网络表示基因型,通过基因表达控制细胞的分裂、分化和迁移等机制生成神经网络.Dellaert和Beer[8]应用一种称为操作子的Boolean函数实现基因调控网络,并利用操作子产生的蛋白质来控制细胞的发育过程.Eggenberger[9]应用基于模板匹配的串编码表示基因调控网络,并引入可使细胞死亡的蛋白质,因为细胞程序性凋亡是生物发育的基本机制.Astor和Adami[10]在更低的层次建立了神经网络的发育模型,每个细胞在内部状态和外部环境的共同作用下在二维平面内移动,细胞可通过向外部环境扩散化学物质来影响其它的细胞.在这种框架下,通过细胞的迁移和轴突的生长来形成神经网络.在他们的实验中,应用手绘基因组模拟了小规模人工神经网络的发育与进化.最近,Federici等人[11-12]应用递归神经网络表示基因调控网络,同Boolean网络的离散Boolean函数相比,递归神经网络的连续函数对基因空间的搜索具有较好的调整特性和较丰富的中性区域.并用该模型进化了具有容错特性的脉冲神经网络,控制Khepera机器人执行简单的导航任务.虽然该方法通过复制过程实现了胚胎分期的发育过程,但在每个胚胎分期,控制发育的基因调控网络表现为固定的拓扑结构,然而从宏观的时间尺度看,生物基因调控网络的拓扑结构在基因复制与歧化机制的作用下动态变化的.本文以人工基因组模型为框架描述基因调控网络,提出了一种更具生物可解释性的进化大规模脉冲神经网络的发育方法.首先,应用基因表达和细胞分裂树,生成具有特定属性的脉冲神经元、神经网络Page3结构和连接权值以及每个神经元特有的学习规则.其次,应用基因片段复制与歧化算子,在人工基因组层次上设计脉冲神经网络的进化算法.最后,模拟以神经驱动的自主智能体的食物采集行为,在不同规模的神经网络下验证了该方法的进化能力,并分析了基因调控网络的不同编码方法对自主智能体智能行为突现的影响.2人工基因组模型基因调控网络采用Reil[13]所提出的人工基因组模型编码,人工基因组模型包含一个由“基”构成的线性序列,并沿DNA从5端到3端的方向阅读,基从集合D={0,1,2,3}中取值,模拟DNA中核苷酸的4个碱基A、C、G和T.人工基因组中的基因由特定的基序列“0101”标识,并称该序列为启动子,用于模拟生物基因组中的“TATA”序列.由于启动子是从集合D中随机取值构成序列“0101”,因此启动子在人工基因组中出现的概率为P=4-4=0.39%.启动子不允许相互重叠,比如在序列“010101”中,只有前4个基所构成的序列为启动子.每个启动子之后的g个基所构成的序列为一个基因,基因长度的缺省值为g=30.每个基因编码一个蛋白质,在人工基因组模型中蛋白质由p个基所构成的序列表示,蛋白质长度的缺省值为p=6,其中一些基因编码功能蛋白质,而另一些基因编码转录因子来调控其它基因的表达.在该模型中,从基因到蛋白质的翻译过程由多数决定原则控制[14].多数决定原则可描述为:(1)将长度为g的基因分为长度为p的子序列,并计算每个基在子序列每个位置上出现的次数;(2)在每个位置上出现次数最多的基为蛋白质在该位置上最终的值;(3)如果出现次数最多的基有多个,取最小的基为蛋白质在该位置上最终的值.表1给出了一个从基因翻译成蛋白质的例子,基因为“102301032233020122031021131121”,蛋白质为“031121”.基因出现次数{0,1,2,3}3,2,0,01,0,1,31,2,2,01,2,1,11,0,3,10,3,1,1蛋白质031121在真核生物的基因组中,基因的顺式调控元件既可位于其上游,也可位于其下游.在该模型中,顺式调控元件仅存在于启动子的上游序列中,这种简化并不影响基因调控的基本特性.与启动子和基因不同,我们允许DNA调控区域的顺式调控元件可相互重叠.顺式调控元件由结合序列和调控序列两部分构成:(1)长度为p的结合序列用于匹配转录因子,一旦匹配成功,转录因子调控与其最接近的下游基因;(2)长度为r的调控序列用于决定调控的类型及强度,其缺省值为r=6.如果调控序列的第一个基为“0”或“1”,顺式调控元件为抑制子,转录因子抑制基因的表达;否则,顺式调控元件为增强子,转录因子增强基因的表达.调控强度通过将剩余的序列转换为区间在[0,W]的实数权值来表达,其中W表示基因调控网络模型的交互强度或权值尺度.为了建模发育控制过程,基因组中每个基因的后面增加两个长度为r的基序列用来编码接口:输入接口接收来自相邻细胞或外部环境的诱导信号,输出接口决定细胞的发育过程.同调控序列一样,每个接口序列编码接口的类型和强度:第一个基决定接口的类型,是增强基因表达,还是抑制基因表达;剩余的基序列决定接口的强度,将其转换为区间在[0,W]的实数权值.基于人工基因组模型的编码(图1(a)),控制发育的遗传系统表示为由N个节点构成的基因调控网络(图1(b)).网络可分3层,分别为由NI个节点构成的输入层,由NR个节点构成的调控层和由NO个节点构成的输出层.NR由基因组中的基因决定,NI和NO由相应的发育模型决定.网络中的调控节点表示基因组中的基因,仅起调控作用.由于基因所编码的蛋白质由长度为p的基序列表示,因此可以将基因分成4p个不同的类,并标识为1~4p.网络中的输入节点用于表示细胞的诱导信号,模拟细胞与外界环境的交互.根据基因的标号顺序,将基因分为NI组,每个诱导信号通过基因的输入接口和一组基因连接.网络中的输出节点用于表示发育控制过程以及细胞的分化类型.基因按其标号顺序分为NO组,每一组通过基因的输出接口和一个输出节点连接.采用标准的递归神经网络表达基因调控网络的动态特性,网络的状态在离散时间步作同步更新.基因i在时间步t+1的活性Ai(t+1)可表示为Page4图1控制发育的基因调控网络模型其中,Aj(t)表示基因j在上一时间步t的活性,wij表示从基因j到基因i的调控权值.θi为基因i的活性阈值,可表示为其中,δ表示权值偏差,缺省值为δ=0.5.σ(x)为Sigmoid函数,可表示为因此,基因活性在区间[0,1]内连续变化,其中0表示基因失活,而1表示基因完全表达.对于随机生成的人工基因组,基因之间的距离为不确定的值,只能进行近似的估计[15].由于基因组中每个启动子标识一个基因,因此基因之间的距离满足概率为P的几何分布,根据几何分布原理,基因之间的平均距离可表示为然而,人工基因组模型中的基因不允许重叠,因此必须考虑基因及接口的长度,修正的式(4)可表示为3脉冲神经网络的发育方法为了描述方便,在发育过程中,调控节点在时刻t的活性表示为Ri(t),i=1,2,…,NR;输入节点在时刻t的活性表示为Ii(t),i=1,2,…,NI;输出节点在时刻t的活性表示为Oi(t),i=1,2,…,NO.一类输出节点的活性通过与给定的阈值比较,表示定性的特征;另一类转换为给定范围[Pmin,Pmax]内的特定参数值,可表示为Pmin+(Pmax-Pmin)Oi(t).如果Od3.1细胞分裂树的生成初始基因调控网络表示一个可发育成神经系统的胚胎细胞,其中节点的活性随机初始化,即在区间[0,1]内均匀取值.网络的状态在离散时间步作同步更新,其中每一步表示一次细胞分裂或分化事件.共有3个输出节点控制脉冲神经网络的发育过程,每个输出节点的活性表示为Od的活性Od还是分化成最终的神经元;第2个输出节点的活性2(t)表示细胞分裂的方向,是水平方向的分裂,还Od是垂直方向的分裂;第3个输出节点的活性Od表示两个子细胞中细胞命运决定子的分布,是进行对称分裂,还是不对称分裂.成特定的脉冲神经元;否则,细胞将分裂.当细胞分裂时,复制母细胞的基因调控网络,即两个子细胞中的基因调控网络具有相同的拓扑结构.在生物发育中,随着时间的推移,细胞可进行持续分裂的可能性越来越小.为了模拟这一现象,分裂阈值在发育过程中动态变化,并表示为θd=0.01eλd,其中d表示当前细胞在细胞分裂树中的深度,λ表示发育尺度,用于控制脉冲神经网络发育的规模.生成左子细胞和右子细胞;否则,细胞进行垂直方向的分裂,生成下子细胞和上子细胞.在发育控制中仅有两个输入节点,表示细胞分裂后子细胞相对位置的差异.对于左/下子细胞,输入节点的活性为:I1,l/d(t)=0和I2,l/d(t)=1.对于右/上子细胞,输入节点的活性为:I1,r/u(t)=1和I2,r/u(t)=0.其中,下标l/d和r/u分别表示细胞分裂树的左/下子细胞如果OdPage5如果Od和右/上子细胞.胞进行不对称分裂.为了模拟细胞的这种不对称分裂机制,将与第3个节点相连的调控基因称为不对称细胞分裂基因.当细胞进行对称分裂时,两个子细胞的不对称细胞分裂基因具有相同的活性:Ri,l/d(t)=Ri,r/u(t)=2Ri(t)Od时,两个子细胞中不对称细胞分裂基因的活性不均等分配:左/下子细胞中的活性为Ri,l/d(t)=Min(2Ri(t)OdRi,r/u(t)=2Ri(t)(1-Od最小值函数.除了不对称细胞分裂基因外,其余调控基因的活性在两个子细胞中均匀分配,具有和母细胞相同的基因活性.图2给出了一个细胞分裂树的示例.初始胚胎细胞第1次进行水平方向的分裂,生成左子细胞和右子细胞.在第2次分裂中,左子细胞进行垂直方向的分裂,右子细胞进行水平方向的分裂,共产生4个子细胞.依次进行第3次和第4次分裂,生成最终的细胞分裂树.在最终的细胞分裂树中,共有8个分化的细胞.3.2脉冲神经元的生成当细胞分裂终止时,细胞分裂树的所有终端节点表示分化的特定细胞,即脉冲神经元.如果仅考虑脉冲神经元的漏电流,就可得到最简单的脉冲神经元模型———漏电Integrate-and-Fire模型[16],其膜电位v(t)的变化过程由下面的一阶微分方程描述:其中,τm表示膜时间常量,Vrest表示静息电位.假设从突触输入一个脉冲,神经元的膜电位瞬时更新:v(t)→v(t)+we/i,其中we/i表示该突触的权值,下标e/i表示突触的兴奋性或抑制性.如果膜电位v(t)达到了阈值电位Vthresh,神经元立即发放一个脉冲,同时将膜电位重置到复位电位Vreset,并在绝对不应期tref之内保持不变;否则,在新脉冲到来之前,膜电位将按膜时间常量τm衰减直到静息电位Vrest.在脉冲神经网络中,包含输入层、隐层和输出层.隐层的神经元数MH由细胞分裂树中的细胞确定,输入和输出层的神经元数MI和MO由待求解的问题及其规模确定.如果采用漏电Integrate-and-Fire脉冲神经元模型,共需6个输出节点编码脉冲神经元的属性特征,每个输出节点的活性表示为On第1个输出节点的活性On奋性或抑制性属性;其它输出节点的活性On6(t)分别表示漏电Integrate-and-Fire脉冲神经元On模型的参数,如静息电位Vrest、阈值电位Vthresh、复位电位Vreset膜时间常量τm和绝对不应期tref.隐层的脉冲神经元可分为兴奋性和抑制性两类,由编码神经元属性的第1个输出节点决定.如果1(t)0.8,神经元为兴奋性的;否则,神经元为抑On制性的.也就是说,网络中兴奋性神经元占80%,抑制性神经元占20%.输入层的脉冲神经元根据外界环境的刺激强度或输入数据的大小,发放一定频率的脉冲序列,并满足Possion分布.输出层的脉冲神经元具有相同的参数,神经元输出的脉冲序列经解码后表示最终的结果.3.3神经连接的生成为了使用比较简单的生长规则生成神经连接,突现脉冲神经网络的拓扑结构及连接权值.共有7个输出节点编码神经元的连接属性,每个输出节点的活性表示为Oc表示脉冲神经元的接口连接属性,即与输入和输出神经元的连接;第2和3个输出节点的活性Oc3(t)表示脉冲神经元的分支连接属性,即与隐层中Oc其它神经元的连接;第4和5个输出节点的活性表示突触的权值,其中Oc5(t)为突触后权值标记;第6和7个输出节点的活Oc性表示脉冲的传播延迟,其中Oc标记,Oc出神经元连接,具体的连接方式为:(1)与第MIOc个输入神经元建立连接,突触权值由突触前权值标4(t)编码,该突触上脉冲的传播延迟由突触前记Oc延迟标记Oc隐层的每个神经元与一个输入神经元和一个输Page6元建立连接,突触权值由突触后权值标记Oc码,该突触上脉冲的传播延迟由突触后延迟标记7(t)编码.Oc隐层的每个神经元通过分支连接规则与隐层中的一组神经元连接,如算法1所示,与文献[7]类似的分支连接规则主要有3个步骤.算法1.神经元的分支连接规则.1.从一个终端节点,即源神经元出发,在细胞分裂树中上升dOc在细胞分裂树中的深度.2.从祖先节点出发,在以该祖先节点为根节点的细胞分裂子树中寻找目标神经元.如果2Oc到左/下子细胞,并且Oc从当前细胞下降到右/上子细胞,并且Oc循环,直到下降到一个终端节点为止,该节点即为所寻找的目标神经元.3.实际上,发育过程中细胞的空间位置在很大程度上决定于细胞分裂树中细胞之间的相对位置.当把细胞分裂树映射到二维平面上时,所有的终端节点具有一定的邻接关系,并定义与目标神经元相邻的一组神经元为最终的目标神经元群.源神经元与目标神经元群的每个神经元建立连接,连接权值由突触前神经元的突触前权值标记和突触后神经元的突触后权值标记共同编码,可表示为Sqrt(Oc经元的突触前延迟标记和突触后神经元的突触后延迟标记共同编码,可表示为Sqrt(Oc其中,下标pre和post分别表示突触前神经元和突触后神经元,Sqrt(x)表示平方根函数.图3给出了一个细胞分支连接示例,源神经元通过分支连接规则与目标神经元群(图中灰色区域)的7个神经元连接.3.4学习规则的生成脉冲序列引起的神经网络的持续变化,对成熟个体的学习记忆以及神经系统经验依赖的精细发育起着关键作用.学习的神经生理学基础是神经元之间的突触强度可动态变化,最近的研究表明,神经元突触的动态修饰由脉冲时间依赖的突触可塑性(Spike-TimingDependentSynapticPlasticity,STDP)规则确定[17].对于兴奋性突触,如果突触前神经元发放的脉冲在突触后神经元点火之前到达,则突触增强;反之,突触减弱.突触增强和减弱的强度满足下面的数学模型:Δw=A+exp(-(tpost-tpre)/τ+),如果tpre<tpost烅烄烆其中,tpre和tpost分别表示突触前和突触后神经元脉冲的发放时间,τ+和τ-分别表示时间常量,A+>0和A-<0分别表示突触增强和减弱的最大值.对于脉冲神经网络的STDP学习规则,可通过基因调控网络的输出节点编码.共有4个输出节点编码每个神经元的STDP学习规则,每个输出节点的活性表示为Ol表示突触增强的最大值A+;第2个输出节点的活2(t)表示突触减弱的最大值A-;第3个输出节性Ol点的活性Ol的活性Ol在我们的模型中,突触的权值在两个不同的时间尺度上变化:(1)在进化的每一代,由基因调控网络通过个体发育得到每个突触的初始权值;(2)在个体的生命周期内,隐层的突触按STDP学习规则动态变化,并且突触变化的范围限定在给定的权值区间内.4脉冲神经网络的进化算法4.1基因片段复制与歧化模型比较基因组学研究发现,基因片段(基因组中DNA的一个连续块)复制与歧化在基因组进化过程中持续发生,具有重要的作用.基因片段复制与歧化指在一次事件中基因及与其相连的调控区域被复制与歧化的过程[18-19].宏观层次上,基因组中大规模的基因复制与歧化导致基因调控网络结构持续的进化;微观层次上,一次基因复制与歧化产生新的基因及顺式调控元件.应用人工基因组模型描述基因调控网络,基因组层次的基因片段复制与歧化算子可以映射到网络层次的变异[20].最简单的变异算子为单点变异,一次单点变异指将基因组中一个随机的核苷酸变化为Page7与其不同的基,这类算子仅对单个的基因产生局部的影响.第二类变异算子为基因片段复制与歧化,其作用效果既可以是基因内的,仅仅影响一个基因;也可以是多基因的,影响一组基因.这类算子主要包括:(1)基因片段复制,基因组中一个随机的基因片段被复制.基因片段复制事件既可以是串联的,复制区域与原始区域紧相邻;也可以是非串联的,复制区域被复制到基因组的其它位置.在我们的模拟实验中,所有的复制事件都是串联的.(2)基因片段删除,基因组中一个随机的基因片段被删除.(3)基因片段移位,基因组中一个随机的基因(4)基因片段逆转,基因组中一个随机的基因片段被反位重写.基因片段复制与歧化产生的生理基础是基因组中存在大量的转座子,转座子为核苷酸的离散片段,可以从基因组的一个位置转移到另一个位置.基因片段复制与歧化算子的实质是转座子插入到基因组中或从基因组中去除,从而改变基因组的序列.对于人工基因组模型,在不同的基因片段复制与歧化事件中,转座子的长度是可变的,其值满足概率为P的几何分布.考虑到基因的不可重叠性,需增加相应的基因及接口长度.转座子在基因组中随机选择,并假设基因组中转座子的数目为片段被转移到基因组的其它位置.其中l表示基因组序列的长度.也就是说,基因组中的转座子数为基因数的平均值.4.2脉冲神经网络进化算法描述人工基因组在基因片段复制与歧化机制的作用下动态增长,对应的基因调控网络在整个进化过程中动态变化.在进化算法中,对需要变异的个体在基因组层次分别应用概率为ppoint的单点变异算子、概率为pdup的基因片段复制算子、概率为pdel的基因片段删除算子、概率为ptrans的基因片段移位算子和概率为pinv的基因片段逆转算子.交叉算子在进化算法中具有原始性的独有特征.交叉算子模仿自然界有性繁殖的基因重组过程,其作用在于将原有的优良基因遗传给下一代个体,并生成包含更复杂基因结构的新个体.在应用中,我们采用两点交叉.两点交叉算子一般分为以下两个步骤:(1)根据人工基因组长度l,对要交配的一对个体,随机选取[1,l-1]中两个整数k做交叉位置;(2)根据交叉概率pcross实施交叉操作,配对个体在交叉位置处,相互交换各自的部分内容,从而形成一对新个体.在脉冲神经网络进化的每一代,首先,由人工基因组编码的基因调控网络控制发育生成脉冲神经网络,并在生命周期内评价由神经驱动的自主智能体的适应值.然后,在遗传算子的作用下产生下一代个体,具体的产生过程为:(1)根据个体的适应值,应用联赛选择方式在群体中选取两个个体;(2)对所选取的两个个体,应用两点交叉算子产生两个新的个体;(3)对两个新个体,应用单点变异算子和基因片段复制与歧化算子.此外,在我们的进化算法中,使用精英比例为20%的精英保留策略.算法2给出了脉冲神经网络的进化算法,个体的基因组长度为l,基因组中的转座子数为t,群体规模为n.表2给出了进化算法中遗传算子的基本参数设置.算法2.脉冲神经网络的进化算法.1.随机生成规模为n的初始群体,每个个体的基因组具有相同的初始长度.评价每个个体的适应值.2.通过发育模型生成脉冲神经网络,并在生命周期内3.重复执行,直到n个新的个体生成.(1)应用联赛选择方式在群体中选取两个个体;(2)应用概率为pcross的两点交叉算子,产生新的个体;(3)对基因组中的l个核苷酸,应用概率为ppoint的单(4)对基因组中的t个转座子,应用基因片段复制与4.用新生成的群体替换当前群体.5.如果满足终止条件,循环结束;否则,转到第2步.两点交叉概率单点变异概率基因片段复制概率pdup基因片段删除概率pdel基因片段移位概率ptrans基因片段逆转概率pinvPage85实验环境进化基于神经驱动的自主智能体或机器人是神经计算领域中的一个重要分支,由于它具有高度的自主能力,这一方面的研究正受到越来越多的重视[21-22].具有代表性的行为主义思想认为,设计自主智能体或智能机器人的有效途径应像生物体进化那样,采用“自上而下”方式,以感知-行动作为基础,在与环境的交互中学习行为动作.在我们的实验中,自主智能体在虚拟的自然场景中通过群体进化和生命周期内的STDP学习突现食物采集行为.5.1自然场景为了模拟自主智能体的食物采集行为,自然场景表示为一个500×500的二维连续场,并且相对的边相互连接.自然场景中有食物和毒物两类物质,50个食物和50个毒物随机分散在自然场景中,大小为5×5.自主智能体在初始时刻处于自然场景的中心位置,大小为5×5.图4给出了简化的自然场景表示.5.2自主智能体每个自主智能体包含一组感觉神经元、运动神经元和一个脉冲神经控制器,脉冲神经控制器由人工基因组编码的基因调控网络通过发育过程生成.自主智能体仅能够感觉到一定范围内的食物和毒物,该感觉范围表示为半径为30的圆形区域,并将感觉区域分成若干个扇形子区域.为了能够区分每个方向的食物和毒物,每个子区域对应一个感觉输入神经元和一个运动输出神经元[2].图5(a)和(b)表示一个自主智能体的简单感觉运动系统,分别具有8个感觉神经元和8个运动神经元.对于脉冲神经网络,我们采用简单的频率编码方法.感觉神经元根据外部环境的刺激,发放一定频率的脉冲序列;运动神经元则根据脉冲发放的频率,编码自主智能体的运动方式.自主智能体在自然场景中运行2000步,每一时间步的时间窗口为100ms.对于每个感觉神经元的每一时间步,当在扇形子区域内存在一个食物时,发放25个兴奋性脉冲;当在扇形子区域内存在一个毒物时,发放25个抑制性脉冲;当在扇形子区域内没有食物和毒物时,发放5个兴奋性脉冲.对于每个运动神经元的每一时间步,当发放的脉冲频率最大时,自主智能体沿该扇形子区域的中线方向前进一定的距离,该距离取值为5.5.3适应值函数由于适应值是群体中个体生存机会选择的唯一确定性指标,所以适应值函数的形式直接决定着群体的进化行为.在模拟实验中,自主智能体在每一时间步,根据其所处的位置信息检测状态,如果碰到食物,则适应值增加;如果碰到毒物,则适应值减少.因此,自主智能体的适应值函数可表示为其中,F表示采集的食物总数,P表示采集的毒物总数,fitness的取值范围为[-1,1].进化自主智能体的目标为在生命周期内尽可能多地采集食物,但同时尽量避开毒物.6实验结果对于自主智能体的脉冲神经网络,表3给出了漏电Integrate-and-Fire神经元模型的参数设置.对于自主智能体的基因调控网络,输入节点数NI=2,输出节点数NO=20,调控节点数NR由人工基因组控制的发育过程决定.人工基因组的参数取第2节中的缺省值,权值尺度W=5.人工基因组的初始长度l=5000,并在基因片段复制与歧化机制下动态增长.图6和图7给出了群体规模为50,进化100代,运行10次的平均结果.Page9膜属性突触属性STDP属性6.1不同网络规模的比较对于每个自主智能体,包含感觉运动系统和脉冲神经控制器两部分.感觉运动系统用于接收外部环境的刺激,并驱动自主智能体做相应的运动,主要指输入层的MI个感觉神经元和输出层的MO个运动神经元.脉冲神经控制器作为隐层连接输入层和输出层的神经元,主要由人工基因组编码的基因调控网络通过发育过程生成,其中脉冲神经元数MH由发育尺度λ决定.图6给出了不同规模的感觉运动系统和脉冲神经控制器的进化结果,图中数据点表示进化时每代最优自主智能体的平均适应值.图6不同网络规模的比较从以上的结果可以看出,本文方法可以进化不同规模的脉冲神经网络,使神经驱动的自主智能体突现出较高智能的食物采集行为.也就是说,进化的自主智能体在生命周期内尽可能多地采集食物,但同时尽量避开了毒物.同时,由于应用基因片段复制与歧化模型,进化中的人工基因组动态增长,相应的基因调控网络随着进化的进程逐渐复杂化.在实验中,对于不同规模脉冲神经网络的进化,在进化的终图6(a)表示自主智能体的感觉运动系统变化时的进化结果,感觉神经元数MI和运动神经元数MO的取值分别为8、16、32和64,而脉冲神经控制器的规模基本保持稳定,即发育尺度λ=0.6.可以看出:(1)在一定范围内,随着感觉运动系统复杂程度的升高,神经驱动的自主智能体表现出越来越高的适应值;(2)但随着感觉运动系统的进一步复杂化,由于脉冲神经控制器的规模过小,自主智能体的适应值反而降低.在4种不同的感觉运动系统规模下,最终进化的最优自主智能体的平均适应值分别为0.886、0.924、0.954和0.846.图6(b)表示自主智能体的脉冲神经控制器变化时的进化结果,发育尺度λ的取值分别为0.7、0.6、0.5和0.4,而感觉运动系统保持恒定,即MI=32和MO=32.可以看出:(1)随着发育尺度的减小,经发育生成的脉冲神经控制器包含越来越多的脉冲神经元.在4种不同的发育尺度下,脉冲神经控制器中平均的脉冲神经元数MH分别为80±15、126±34、315±67和1020±205;(2)随着脉冲神经控制器复杂程度的升高,自主智能体的适应值也越来越高.在4种不同的脉冲神经控制器规模下,最终进化的最优自主智能体的平均适应值分别为0.912、0.954、0.968和0.992.止代,最优自主智能体的人工基因组长度差异不显著,平均长度为18875±6590.对于大规模的神经网络,若采用传统的直接编码方法进行进化,比如1000个神经元的网络,就需要上百万的基因来编码其连接信息,这不仅需要大量的存储空间,而且由于其搜索空间巨大,很难进行有效的进化.本文方法通过基因重用机制,一个基因在不同的发育阶段多次表达,可在较小的基因空间中进行大规模神经网络Page10的快速搜索.6.2不同基因编码的比较为了测试基因调控网络不同的编码方法对脉冲神经网络进化性能的影响,我们采用如图1(b)所示的具有固定拓扑结构的递归基因调控网络,输入节点数NI和输出节点数NO由相应的发育模型决定,调控节点数NR在进化过程中固定.递归基因调控网络采用全连接方式,其中调控节点之间递归连接,调控信息用权值矩阵表示,增强或抑制基因表达的调控强度在区间[0,5]内均匀取值,即权值尺度W=5.在递归基因调控网络的进化过程中,采用两类变异算子:(1)权值替换,即用新的权值替换原来的值;(2)增加噪声,即在原来的权值上增加一个随图7不同基因编码的比较比较结果可以看出:(1)递归基因调控网络的进化性能低于人工基因组模型.原因在于人工基因组在基因片段复制与歧化机制的作用下动态增长,用其编码的基因调控网络表现出与生物基因调控网络相似的拓扑结构和动态特性[23];(2)含有较少调控节点数的递归基因调控网络具有较高的进化性能.因为含有较多调控节点数的递归基因调控网络具有较大的搜索空间,需要更多的进化代来变异基因的调控强度.7总结通过自然进化得到的脑包含几十亿的神经元和几万亿的神经连接,并表现出复杂的智能行为.受生物神经网络进化与发育的启发,人工进化神经网络的研究越来越引起人工智能界的重视.本文用基因表达的动态特性表示细胞命运特化的发育过程,提出了一种进化大规模脉冲神经网络的发育方法.首先,应用基因表达和细胞分裂树,生成具有特定属性机噪声,噪声的取值满足Gaussian分布G(0,0.1).在模拟实验中,两类变异算子的概率为0.1.图7给出了输入节点数NI=2,输出节点数NO=20,调控节点数NR分别为8、16和32,进化输入层的感觉神经元数MI=32,输出层的运动神经元数MO=32以及发育尺度λ=0.6的脉冲神经网络时,所得最优自主智能体的平均适应值.如图7(a)所示,在权值替换算子的作用下,三类递归基因调控网络进化所得最优自主智能体的平均适应值分别为0.880、0.842和0.784;如图7(b)所示,在增加噪声算子的作用下,三类递归基因调控网络进化所得最优自主智能体的平均适应值分别为0.862、0.820和0.768.的脉冲神经元、神经网络结构和连接权值以及每个神经元特有的学习规则.其次,应用基因片段复制与歧化模型,在人工基因组层次上设计了脉冲神经网络的进化算法.在整个进化过程中,控制发育的基因调控网络动态变化.最后,模拟了以神经驱动的自主智能体的食物采集行为.实验结果表明:(1)通过对不同规模的脉冲神经网络的进化,验证了该方法对大规模脉冲神经网络的进化能力;(2)通过对基因调控网络的不同编码方法的对比分析,发现基于人工基因组编码的基因调控网络模型的进化能力优于具有固定拓扑结构的递归基因调控网络模型.
