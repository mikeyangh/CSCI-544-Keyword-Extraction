Page1高斯混合函数区域匹配引导的LevelSet纹理图像分割肖春霞1),2)初雨1)张青1)1)(武汉大学计算机学院武汉430072)2)(南京大学计算机软件新技术国家重点实验室南京210093)摘要基于高斯混合模型颜色匹配及多尺度图像增强,文中提出了有效的边缘停止函数用于引导levelset函数演化,有效地解决了纹理图像的分割问题.文中首先提出基于高斯混合模型颜色分布的边缘停止函数,通过计算levelset演化窄带区域与用户给定交互区域的相似性,根据其相似性来引导levelset快速演化;然后,提出一个定义在多尺度图像梯度上的边缘停止函数,使得levelset能精确地分割出图像的边缘;最后,结合以上两种边缘停止函数的优点,提出一个边缘停止函数的混合模型,根据图像颜色、边缘特征自适应地引导levelset函数演化.实验结果表明,文中提出的算法不仅能有效地检测出纹理目标区域,同时需要计算出纹理区域精确、光滑的边界.关键词水平集;图像分割;边缘检测;高斯混合模型;多尺度图像1引言Sethian[1]在研究曲线以曲率相关的速度演化时提出来的,用于描述曲线或曲面的演化过程.水平集方法的主要思想是引入levelset函数:Rn×R+→R,水平集方法(LevelSetMethod)是Osher和将移动界面S∈Rn作为的零等值线嵌入到高一维Page2的levelset函数中.在演化过程中,演化曲线(面)总是对应于该水平集函数的零等值线(面),确定零等值线即可确定移动界面的位置.自从水平集方法被提出以来,已在图像处理、火焰燃烧、流体模拟、图像建模等运动界面追踪领域得到了广泛的应用[2].水平集方法由于能够灵活地处理二维空间中的曲线运动和三维空间中的曲面运动,现已成为了处理运动界面追踪问题的一种代表性的方法.水平集方法虽然是一种成功的运动界面追踪算法,但其仍然存在许多缺点,例如计算速度较慢,曲面演化中计算可能不稳定,距离函数需要重新初始化,纹理图像分割不理想等缺点.本文的主要工作是利用levelset函数有效解决纹理图像的分割问题.由于纹理图像本身的复杂性,有效地检测出纹理图像的边缘,有效地定义levelset函数演化的边缘停止函数是解决纹理图像分割的关键.一个有效的levelset纹理图像分割算法不仅需要有效地检测出纹理目标区域,同时需要计算出纹理区域精确、光滑的边界.为解决以上问题,本文首先基于高斯混合模型颜色匹配的边缘停止函数,主要思想是利用描述颜色分布的高斯混合模型来计算levelset演化窄带区域与用户给定交互区域的相似性,根据其相似性来引导levelset快速演化;然后,提出一个定义在边缘增强的多尺度图像上的边缘停止函数,使得levelset能精确地分割出图像的边缘;最后,我们结合以上两种边缘停止函数的优点,提出一个边缘停止函数的混合模型,不仅能有效地分割出纹理区域,同时能计算出精确、光滑的边界.采用以上边缘停止函数引导levelset函数纹理图像的分割,不仅能消除单个像素颜色和局部梯度的变化对运动界面演化的影响,避免levelset演化过程中出现的数值不稳定情况;同时,由于采用窄带算法(局部高斯混合模型颜色匹配),能加速其levelset演化速度;此外,将两种基于不同度量定义的边缘停止函数结合起来,通过给定用户不同的参数,能更理想地引导运动界面的演化.2相关工作自从Osher和Sethian[1]提出水平集方法以来,该方法成功地计算和分析了依赖于时间、位置、界面的几何性质以及外部物理特性的作用下的界面的并发运动问题,已经在图像处理、计算机视觉、火焰燃烧、流体动画模拟等运动界面追踪领域得到了广泛的应用[2].例如在基于图像的建模方面,Faugeras等[3]提出了一种利用曲面演化恢复物体几何模型的方法,可以很好地恢复漫反射物体的三维模型.水平集方法把所追踪界面表示为高维函数的零等值线,通过求解高维函数来确定界面的运动情况.由于水平集方法具有方便有效地描述曲面的拓扑变化、能方便地推广到任意维空间、运动界面保持光滑等优点,已经成为了处理运动界面演化的主流方法,是处理封闭运动界面随时间演化过程中几何拓扑变化的有效计算工具[2,4].为了保持数值计算的稳定,传统的水平集方法通常对需要演化的levelset函数进行重新初始化,即水平集函数通常要周期性地初始化为一符号距离函数[4-6],保证Γ(t)在演化过程中获得一个稳定和精确的解.然而,重新初始化为一符号距离函数显然在水平集方法理论和具体实现之间存在分歧,水平集方法理论本身不需要重新初始化;并且现有的重新初始化方法通常具有使得零水平集函数偏离其原始位置等缺点,因此,有效的重新初始化现在依然是水平集方法中的一个公开问题.为了避免每次求解后重新初始化带来的不便,文献[7]提出了一种无需重新初始化的模型,该模型采用变分方法将levelset函数强制转换为一符号距离函数,比较有效地消除了重新初始化这一步骤,本文亦采用该方法求解levelset函数的演化.水平集方法的一个缺点就是它的计算量大,平面曲线的演化算法的计算复杂度为O(N2),三维曲面的计算复杂度为O(N3),其中N是将平面(或空间)均匀离散成网格点后的网格点数目.为提高水平集方法运动界面的演化速度,Adalsteinsson和Sethian给出了基于窄带水平集方法[8-9].窄带水平集方法的基本思想是在曲线的周围建立一个自适应的窄带,每次演化时,只更新窄带内网格点上的lev-elset函数值;此外,在演化过程中,为防止曲线的点跨越窄带,需要存储窄带的内外边界,当曲线上的点接近内外边界时,再重新建立一条以当前曲线为中心的,宽度为k的窄带,即重新初始化(Rein-itialize).通过这种方式,可以将计算复杂度降至O(Nk)或O(NlogN).与现有的自动的图像分割算法不同,交互式的图像分割现已成为图像分割研究的一个热点.Boykov和Jolly[10]提出的基于图切割的(Graphcut)交互式分割算法,将图像表示成一张图,通过用户交互,增Page3加了前景和背景的约束,建立一个约束化的能量方程,该算法不仅考虑图像本身相邻像素之间的关系,同时考虑了每个像素与用户给定的前景背景的关系,通过利用最大流算法高效的最小化能量方程,达到分割图像的目的.基于图切割算法[10],Rother等人[11]提出了一种Grabcut交互式图像分割算法,这是一种迭代的Graphcut算法,该用户无需指定前景和背景点,只需要指定包围前景物体的一个矩形,就能获得一个较为满意的分割;Li等人[12]也进一步发展了Graphcut算法,该算法主要的工作集中在减少前景分割中的用户交互量,使得交互式的Graphcut图像分割使用起来更加方便.此后,交互式Graphcut图像分割算法被推广到交互式的视频分割[13-14],获得了较好的效果.基于交互方式水平集方法图像分割也已被应用到灰度图像的彩色化[15],Qu等人[15]利用Gabor小波域里的统计特征[16]来定义灰度图像区域的相似性来引导levelset在灰度图像上的演化,进而分割出目标物体.3水平集彩色纹理图像分割本节首先介绍无初始化levelset演化算法,然后分别给出基于高斯混合模型区域匹配引导的levelset演化,特征保持的多尺度图像梯度引导的levelset演化算法及结合高斯混合模型与多尺度边缘检测的levelset演化算法.3.1无初始化LevelSet演化算法Osher和Sethian提出的水平集方法(levelset)[1]是一种隐式曲面的零等势面的演化方法,主要思想是将n维曲面的演化问题转化为n+1水平集的零水平集的隐式求解.在二维图像上具体表现为:将二维的运动闭合曲线Γ(t)表示为水平集函数的零水平集Γ(t)={(x,y)|(x,y,t)=0},即将二维曲线的演化转化为三维曲面演化.水平集函数的演化表现为如下的Hamilton-Jacobi方程:方程(1)称为水平集方程[1].其中F为曲线上各点的演化速度,方向沿曲线的法向方向,大小通常依赖于图像的梯度以及曲线的曲率.为了使Γ(t)在演化过程中获得一个稳定和精确的解,水平集函数通常要被初始化为一符号距离函数.同时在演化过程中,函数需要重新初始化[4-5],保持其符号距离函数的性质,来保证方程(1)求解的稳定性.为了避免每次求解后重新初始化带来的不便,文献[7]提出了一种无需重新初始化的模型.这里Τ()称作内能,用以保证演化中水平集函数自动保持为符号距离函数.Ε()为外能,作为演化的驱动力.文献[7]针对图像分割中的活动轮廓模型提出的方程如下:其中,分别为控制边界的能量项及控制着演化的速度项.δ()为Dirac函数,Η()为Heaviside函数.函数g为活动轮廓模型的边缘停止函数,定义如下这里GI为高斯卷积.方程为方程(2)通过Gateauxderivative求导后最终的采用以上方程可以避免求解过程的重新初始化步骤,且可以直接采用差分方法求解.有效地定义levelset函数演化的边缘停止函数g(5)是解决纹理图像分割的关键.然而,高斯滤波是一种低通滤波,会平滑图像的边缘特征,边缘停止函数(5)引导levelset函数演化效果不理想,本文接下来将给出多种边缘停止函数,更好地解决此问题.3.2基于GMM区域匹配的LevelSet演化为了更好地对图像进行分割,尤其是处理纹理图像,有效地计算levelset函数演化的边缘停止函数是关键.现有的levelset函数通常定义在灰度图像上,例如文献[15]利用Gabor小波域里的统计特征文献[16]来定义灰度图像区域的相识性.GraphCut灰度图像分割中[10],采用图像直方图来计算前景和背景颜色的表示,用于优化计算.为处理彩色图Page4图1基于GMM的纹理图像相似性区域选取(采用GMM区域匹配,选取出与用户交互区域相似的区域)像,本文将利用高斯混合模型(GaussianMixtureModel,GMM)来计算levelset演化窄带区域与用于交互区域的相似性,根据其相似性来计算活动轮廓模型的边缘停止函数,用来引导levelset的演化.与统计模型直方图相比,颜色模型GMM比统计模型更精确.图2基于高斯混合模型相似度引导的水平集运高斯混合模型作为一种有效的描述颜色分布的统计模型,被广泛应用于许多图像分析及处理中[11,17].一般的,高斯混合模型是由K个高斯模型分量组成的概率密度函数,定义如下:其中狓是一个D维的向量,pk是混合系数,满足∑Kpk=1,分量gk(狓)是高斯概率密度函数,定义k=1如下:gk(狓)=(2π)D/2|Σk|1/2exp-(狓-μk)TΣ-1k(狓-μk)12这里μk是第k个高斯模型的均值向量,Σk是第k个高斯模型gk(狓)的协方差矩阵,因此,通过求解出如下3种参数能有效地表示GMM颜色模型:如果用以构建GMM的数据样本的集合为X={狓1,狓2,…,狓N},我们首先用K-means方法聚类算法处理样本X计算出GMM的初始参数,然后通过EM(ExpectationMaximization)方法[18]对GMM参数进一步优化估计,直至收敛,计算出精确的参数ξ.在本文算法中,我们先采用笔刷在需要分割出的目标区域上交互选取一区域X作为数据样本,然后利用上述算法计算出高斯混合模型的参数,构建出相应的高斯混合模型.对于数据样本X的所有像素xi,计算出G(xi),设Guser为数据样本所有G(狓i)的均值.进而,对于图像中数据样本X以外的所有像素点狓i,同样可计算对应的概率似然估计G(狓i).像素点狓i与样本区域的相似性可定义为|G(狓)-Guser|,当值|G(狓)-Guser|ε(ε为给定参数)较小时,则狓i与样本X相似.可用于选取与用户交互区域相似的像素.图1给出基于GMM的纹理图像相似性区域选取的例子.基于以上工作,采用GMM区域匹配,我们给出基于统计模型的levelset函数演化(6)的边缘停止函数:利用此边缘停止函数,与用户交互区域相似的像素狓,其gGMM(狓)值大,将引导levelset函数(6)快速演化,在与用户交互区域颜色差别大的像素狓,其估计值gGMM(狓)小,演化速度慢,与用户交互区域完全不同区域的像素狓,此时gGMM(狓)将趋向为零,此时将中止levelset函数的演化.在有些情况,仅仅单个像素狓的G(狓i)不能鲁棒地计算出演化函数零水平集与户交互区域的相似性.为解决此问题,我们计算出像素狓邻域N(狓),对每个像素p∈N(狓)计算出其G(p),然后取高斯加权平均GAver(狓i):Page5GAver(狓i)=∑p∈N(x~i)为获得更鲁棒的边缘停止函数,利用GAver(狓i)计算运动界面点狓i(x,y)边缘停止函数更进一步定义为gGMM(狓)=1/(1+|GAver(狓i)-Guser|2)(11)图3基于高斯混合模型相似度引导的水平集运动界面演化3.3多尺度图像的梯度引导的LevelSet演化常用的运动界面演化的边缘停止函数g(x)(式(5))采用高斯滤波图像梯度.项|GI|在图像上一般为零,但在梯度变化大的区域,即图像的边缘处,其值通常较大,使得边缘停止函数的值为零,导致levelset水平集函数将在图像的边界处停止演化,从而分割出图像的物体.但该方法由于采用了高斯滤波,众所周知,高斯滤波是一种低通滤波,能平滑图像边缘特征,因此将减弱边缘停止函数(5)的功能,为了克服此缺点,本文提出基于多尺度边缘增图像梯度的边缘停止函数.我们方法的主要思想是利用保边缘的双边滤波算子对图像进行多尺度的滤波,获取其基图像,然后在此基图像上定义一个边缘停止函数来引导levelset方程的演化.我们利用文献[19]给出的方法对图图3给出了基于GMM区域相似度引导的levelset演化的结果.通过在用户交互区域建立GMM模型,运动界面演化的速度由界面上的像素与户交互区的相似度引导,在不同颜色块的边界处演化将中止.由于纹理特征往往是彩色图像重要的特性,使得我们的算法对纹理图像的分割非常有效.我们的算法适合一般的图像的分割.像进行多尺度保特征的预处理.双边滤波器(Bilat-eralFilterFunction,BLF)自从被Tomasi等人[20]引入图像滤波领域以来,已在计算机图形学和图像处理中有了广泛的应用[21].该算法的基本思想是将Gauss滤波和保特征权函数结合起来,有效地保持滤波后图像的边界特征.最近,Farbman等人[19]提出WLS图像滤波算子更进一步发展了BLF[20],其数学模型如下:ρ=argminρ∑x其中,I代表原始图像,ε是为了避免分母为0的一个很小的数,α决定了与原始图像梯度的接近程度.优化方Page6程(12)寻找最优的ρ,使得与原始图像I尽可能逼近的,并且结果光滑保特征.采用式(12)对图像进行累进的滤波,将获得其基图像(baseimage).该基图像不仅能平滑图像的噪声,减弱图像中的细节层,同时能保持图像的边缘特征.因此,该滤波算子对图像起到特征增强的效果.我们基于如上观察,提出本文的第二个边缘停止函数:其中图4基于保特征多尺度图像梯度引导的水平集运动界面演化(μ=2.0,α=0.8,n=2)3.4结合GMM与多尺度图像梯度的LevelSet演化前面提出的两个边缘停止函数gGMM(狓)和gWLS(狓)各有其优点.gGMM(狓)主要引导levelset函数在纹理颜色相似区域的运动界面的演化,但在图像的边缘像素处,由于利用了其领域的GMM加权平均概率估计值,可能导致运动界面在边缘处出现不光滑的情况.gWLS(狓)更适合边缘变化剧烈的区域,即图像的较强的边缘处,在这种情况,利用边缘停止函数gWLS(狓)中止运动界面的演化,将为分割出的目标物体获得光滑的边界.式(14)即对原始图像I进行累进滤波n次,每次参数αi为初始值α的i次幂.最后在CIELab色彩模型中的L部分计算图像的梯度.通过WLS滤波算子可以光滑图像中的细节(图3(c)),保留图像主要的边缘特征,基于其基曲面定义的边缘停止函数能引导levelset函数分割出图像的主要的目标物体.图4给出了我们的方法与文献[15]方法的比较,文献[15]利用高斯卷积后的图像来引导levelset函数的演化,从图中可以看出对于边界不明显的区域其分割效果不理想,而我们的算法更好地分割出了目标物体.为更有效地分割出图像中目标物体,我们利用这两种两个边缘停止函数的优点,在较强的边缘特征处采用边缘停止函数gWLS(狓),其它区域则采用边缘停止函数gGMM(狓),基于此思想,我们构建一个基于混合模型的边缘停止函数ghybrid(狓):ghybrid(狓)=1/(1+α·m(狓)+β·n(狓))(15)其中参数α和β为加权平均参数:α=m(x)/(m(x)+n(x)),β=n(x)/(m(x)+n(x)).设gWLS_aver为多尺度图像所有像素梯度的均值,gGMM_aver为图像上所有像素GMM概率估计值的均值.m(x)Page7为像素x的GMM概率估计值与这个图像GMM概率估计值的均值的比值,m(x)=gGMM(狓)/gGMM_aver,同理,n(x)为像素x的梯度图像梯度均值的比值,n(x)=gWLS(狓)/gWLS_aver.采用以上算法,不仅能消除单个像素颜色的和梯度的剧变对运动界面图5结合GMM与多尺度边缘检测的水平集图像分割4实验结果及分析我们在PC机上,使用C++实现了本文的纹理图像levelset分割算法.程序运行环境是WindowsXP,计算机配置为Intel(R)Core(TM)2DuoCPU(2.4GHz),2GB内存.本文给出了几种不同边缘停止函数引导levelset图像分割结果,并给出了与现有levelset方法、其它图形分割方法的比较结果.本文中大部分levelset演化参数,即式(6)如下:λ=0.04,μ=5.0,η=-3.0,Dirac函数参数取1.5,迭代步长取5.0,levelset初始化的参数取8.0,计算GAver(狓i)其参数一般为δ=3,r=5.表1给出了几组数据运行时间的统计.图像名称图3上图3下图3中演化的影响,同时能很好地将两个不同度量有效结合来引导运动界面的演化.图5给出了基于混合模型的边缘停止函数的levelset演化结果.利用此混合模型,我们获得更光滑的边界.图2显示了基于高斯混合模型相似度引导的levelset运动界面演化的过程,图2(a)、(b)、(c)、(d)分别显示了初始水平集、演化50次、200次、500次的结果.实验结果验证了本文所定义的高斯混合模型相似度能有效地引导levelset函数演化.图3给出了基于高斯混合模型相似度引导的水平集运动界面演化的结果及现有水平集方法的比较.由图3上图中可以看出,采用高斯混合模型相似度引导,零水平集运动界面演化图像在树叶的边界处停止演化,有效地分割出完整的树叶.图3(c)为采用高斯混合模型相似度引导的水平集图像分割结果,闭合曲线中既包含了树叶同时也包含了其它区域,获得此结果的原因是由于该方法仅仅考虑图像梯度,没有考虑图像本身包含的颜色纹理信息,导致分割结果不理想.图3下图给出了另外一组图像分割的比较结果,对于图中纹理目标物体,采用现有的水平集方法难以演化出一个有效的结果,由于本文采用高斯混合模型纹理颜色匹配,获得了一个更好的结果.Page8图4给出了基于保特征多尺度图像梯度引导的水平集运动界面演化的结果及与现有水平集方法的比较.图4(b)为采用高斯混合模型相似度引导的运动界面演化图像分割结果,因为图像中目标物体与周围场景交接处边界不明显,采用高斯混合模型相似度引导的水平集图像分割方法不能有效地演化出目标物体.利用WLS[19]对图像进行保特征多尺度滤波,获得其基图像,不仅能平滑原图像的噪声,减弱图像中的细节层,同时能保持图像的边缘特征,利用此多尺度基图像梯度引导的水平集运动界面更好地分割出了结果.图6基于高斯混合模型(GMM)相似度引导的levelset图像分割与GrabCut[11]方法的比较图7基于高斯混合模型(GMM)相似度引导的levelset图像分割与GrabCut[11]方法的比较图5给出了采用混合边缘停止函数的结果.从图5(a)可以看到由于图像中桃子部分边缘处梯度场非常平滑,采用传统的levelset函数难以精确地检测出其边界.图5(c)是GMM区域匹配引导水平集演化后的结果,可以看到由于GMM区域匹配还没到图像的边缘就停止,始终无法检测出最终的边界.图5(d)是混合边缘停止函数的结果,可以看到结合两种方法能有效地检测目标物体的边界,且边界平滑.图6、图7均为基于高斯混合模型相似度引导的水平集图像分割的结果,并与GrabCut[11]方法Page9进行了比较.可以看到通过简单的交互,我们获得了精确的边缘,而Grabcut方法则难以在边界处取得理想的效果,本文的Grabcut图像分割实验结果是利用MohitGupta①提供的公开代码实现的.对于该类型的图像,由于纹理性质较强,我们的方法通过将用户交互的区域作为训练集(trainingdata),在此训练集上利用高斯混合模型进行概率相似度分析,便能定义理想的边缘停止函数来引导水平集的演化.5结论与将来工作本文主要解决彩色纹理图像的分割问题,主要思想是基于高斯混合模型颜色匹配及多尺度图像增强,构建了有效的边缘停止函数用于引导levelset函数演化.由于纹理图像本身的复杂性,有效地检测出图像中的纹理目标特征边缘,有效地定义活动轮廓模型的边缘停止函数引导levelset函数演化,是解决纹理图像分割的关键.本文综合利用基于统计信息的高斯混合模型和多尺度图像的边缘检测等信息,提出了简单、实用、有效的边缘停止函数.实验结果验证了本文提出的算法不仅能分割出纹理目标区域,同时能有效地的计算出纹理区域精确、光滑的边界,取得了很好的结果.由于水平集方法能方便有效地描述曲面的拓扑变化,能推广到任意维空间,因此将来的一个工作是将本文提出的图像纹理分割算法推广到视频,有效地解决视频纹理的分割问题;同时,利用水平集方法解决一般视频目标物体的分割也是一个有意义的研究方向.再有,利用水平集运动曲线的演化解决图像视频中目标物体的颜色、纹理替换,尤其是视频目标物体的颜色替换,不仅有理论研究的价值,同时应用亦十分广泛.最后,水平集的方法的一个缺点是速度较慢,因此,对水平集的演化进行加速也是将来的一个工作.
