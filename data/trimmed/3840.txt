Page1ARJ:一种可变干扰半径的IEEE802.11g全频道干扰机刘永磊1),2)金志刚3)高铭3)陈?3)1)(天津大学计算机科学与技术学院天津300072)2)(天津城市建设学院计算机与信息工程学院天津300384)3)(天津大学电子信息工程学院天津300072)摘要针对传统全频道干扰需利用单一频道干扰机进行相对费时的频道跳转,提出了一种全频道IEEE802.11g干扰机(ARJ),ARJ利用临频干扰,尤其是非交叠信道临频干扰实现对全频道的覆盖.与单一频道干扰机相比,ARJ在一个固定频道上便可实现全频道干扰,可调节干扰信号发射功率实现可变的干扰半径,通过设置干扰频度达到能量有效.引入信道比特错误率的DCF马尔可夫链模型的理论分析和模拟场景的仿真实验表明:ARJ可以实现对IEEE802.11g全频道的干扰,其在真实实验中得到实现和验证.关键词干扰机;临频干扰;非交叠信道;马尔可夫链;干扰半径1引言随着IEEE802.11[1]无线局域网(WLAN)技术Page2播的本质以及WLAN安全体系结构各个层次的设计漏洞,WLAN的安全越来越受到威胁[2].许多WLAN的安全威胁已经通过利用密码学手段合理改进WLAN安全体系结构,比如改进密钥管理的IEEE802.11i[1]、引入接入控制和认证机制[3-4]等避免.但仍有一些安全威胁无法通过密码学方法进行控制,比如拒绝服务攻击的一种———射频干扰攻击.与传统的拒绝服务攻击着眼于造成用户域和内核域的缓冲区溢出[5]不同,由于WLAN的特殊性,干扰机(Jammer)可以更加轻易地发动物理(PHY)层和媒体存取控制(MAC)层拒绝服务攻击,通过忽略MAC协议,尤其是DCF(DistributedCoordinationFunction),连续在信道上发送,降低信噪比阻塞正常WLAN用户之间通信,引起数据包冲突导致用户重复退避,干扰用户无法接收到正确的报文等.当然干扰机还可以攻击网络体系结构中的其它网络层次———网络层和传输层,注入大量数据报文,破坏路由控制报文,阻塞TCPACK[6]等,甚至有整合各个网络层次干扰方法的分层Jammer[7](已超出本文的研究范围).然而这些干扰机仅仅针对WLAN的单一频道,若要进行全频道干扰,需要在每个频道上都配置干扰网卡,或配置少量干扰网卡进行多次频道跳转,并且这些干扰机也假设非交叠信道上的无线通信互不影响,因此如何建立一个灵活高效的全频道干扰机具有重要意义.鉴于IEEE802.11gWLAN在国内外广泛部署,本文提出了一种IEEE802.11g全频道Jammer(ARJ),利用非交叠信道的临频干扰简化干扰机的设计,通过调节干扰机内干扰网卡的发射功率实现干扰半径可变,应用BER下的马尔可夫链模型和设计模拟场景以及真实环境下的实验,对我们提出的干扰机模型加以验证.本文第2节介绍相关的工作;第3节阐述802.11g全频道干扰机的模型;第4节通过理论分析、模拟场景以及真实实验验证我们提出的干扰机模型;第5节对干扰机进行优化;第6节是结束语.2相关工作2.1IEEE802.11DCF作为IEEE802.11MAC层的基本接入方式,DCF必须被WLAN内所有参与者实现[1].DCF通过载波侦听多路访问/冲突避免(CSMA/CA)和随机退避算法降低冲突的概率,实现多个用户自动无线媒体共享.当站点有数据包要发送时,首先侦听信道持续空闲达分布式帧间隔(DIFS)时间.接着初始化退避计数器值为[0,W0-1]的均匀随机变量,并在每个时隙(aSlotTime)减1直到零,其中W0为第1次退避的竞争窗口大小.当侦听到信道繁忙则退避计数器停止减少,直到侦听信道持续空闲达DIFS才恢复.当退避计数器减少为零,站点发送该数据包.由于CSMA/CA并不依赖于站点检测自己发送冲突的能力,因此需要目的站点正确接收到数据包后,等待短帧间隔(SIFS)时间,无论信道忙/闲立即发送ACK.如果发送站点未收到ACK,则认为发送失败.站点将增大退避的竞争窗口为W1(W1>W0),在[0,W1-1]重新启动退避计数器,重复退避过程,如果Wi达到Wmax则不再增长维持在Wmax,直到到达最大数据包的重传次数,其中Wi=2iW0.当到达最大重传次数或数据包发送成功,退避窗口还原为W0.除了上述基本接入方法,DCF还采用了RTS/CTS接入机制帮助解决隐终端问题,站点需要发送数据前,先发送RTS,接收端收到RTS后响应CTS.发送端只有正确接收到CTS后才可以开始发送数据,其它站点通过侦听到的RTS或CTS更新网络分配矢量(NAV)并在发送过程中保持沉默.RTS/CTS机制的使用由RTSThreshold控制.DCF机制的详细描述见标准IEEE802.11[1].2.2IEEE802.11g非交叠信道干扰IEEE802.11WLAN工作在5GHz(.11a)和2.4GHz(.11b/g).对于IEEE802.11g的频带典型地被分为11个频道(美国),13个频道(欧洲),每个频道带宽22MHz,相邻频道中心频率间隔为5MHz,频道中心频率相隔至少25MHz的频道为非交叠频道,典型地如1,6,11(如图1所示).本文讨论的仅为国内常用的1~11的频带划分方案.典型的802.11g物理层采用正交频分复用(OFDM)技术,为避免传输信号能量影响到相邻信道,IEEE802.11g引入发射频谱屏蔽(如图2所示)采用带通滤波器实现.其中共有52个子载波,4个导频子载波,48个数据子载波,子载波频率间隔为0.3125MHz(20MHz/64),总带宽为20MHz.OFDMPage3符号持续时间(Ts)为4μs,OFDM符号发送时间(TTR)为100ns.Liu和Li[8]建立了OFDM的频谱模型,频率谱密度(PSD)可以通过计算所有独立子载波的功率谱的总和获得(见式(1)),其中W(f)为时间窗口函数的傅里叶变换(见式(2)).Villegas等人[9]在此基础上给出了临频干扰信号的交叠能量计算方法(见式(3)),其中fc为接收者的中心频率,Ffc为过滤器的频率响应,c为发送者与接收者的频道间隔.P0/Pc为当发送者和接收者在同一信道时与相隔c个频道时接收者接收到的功率的比值,以此来表征临频干扰的强弱程度.Villegas等人[9]只给出了相邻最近的非交叠信道(c=5)的P0/Pc的理论值为51.87dB,上述研究认为PSD只与符号率、符号整形窗口有关,并未考虑无线网卡提高发射功率,信号衰减以及周围环境等因素.P(f)=∑kW(f)=Tssin(πTsf)Pinterference=∫+类似地,黄柏宁等人[10],根据不同信道的频率重叠情况,通过计算得出了不同信道间的干扰因子.根据OFDM信号的功率谱密度以及特定网卡PRISMII过滤器频率响应得出,并进行了归一化处理,如表1所示[10].Nachtigall等人[11]在室内办公室环境进行实验,共分3个场景:发送-发送(TX-TX)、接收-接收(RX-RX)和接收-发送(RX-TX),固定一个信道为频道1,另一个信道在频道1~13之间变化,对于IEEE802.11g,分别测试每个信道发送端和接收端的吞吐率,用以说明临频干扰的严重程度.实验结果表明,3种场景下即使采用非交叠信道吞吐率依然下降明显,同时有较高的丢包率.尤其是对于多射频系统,当多个收发器物理距离为默认情况(比如15cm)时问题最为严重.Nachtigall等人[11]给出的解决办法是加大相邻信道之间的物理距离.上述研究的实验环境为室内,并没有考虑其它干扰源比如其它WLAN、蓝牙设备,甚至是微波炉,而且在实验中无线网卡的发射功率几乎固定,可调的参数也仅仅是信道之间的物理距离.道干扰问题[14-15].2.3IEEE802.11gJammer目前的Jammer主要分为4种:持续型、欺骗型、随机型和反应型Jammer.持续型Jammer[16]为持续发射射频信号的Jammer.由于持续型Jammer不遵守任何MAC层协议,也不等待信道空闲才发射,因此持续地占用信道,阻塞正常无线通信.持续型Jammer的实现方式一般为两种,一种是采用波形信号发生器(PHY层Jammer),一种是利用普通Fuxjger等人[12]在室内办公室环境进行实验,用接收信号强度指示值(RSSI)和ΔRSSI(正常通信和干扰源在接收端造成的RSSI差值)取代物理距离作为实验的参数.他们分别测试干扰源在非交叠信道上时,MAC层吞吐率、非交叠信道上解码率、接收帧的错误率、UDP和TCP流吞吐率等.实验结果表明,对于IEEE802.11g,即使采用非交叠信道干扰依然存在.上述研究使用RSSI和ΔRSSI取代物理距离作为实验参数更加合理,但RSSI以及ΔRSSI的变化时是通过物理距离的改变实现的,没有考虑无线网卡调节发射功率导致的RSSI值变化.Tan等人[13]对实验环境进行了改进,采用RF屏蔽盒消除了其它外界干扰,使用RF信号衰减器模拟物理距离的增大,同时控制路径损失.实验结果表明,对于IEEE802.11g,在低路径损失情况下,非交叠信道存在较高干扰,当路径损失和信道距离增大的情况下,非交叠信道的干扰相应地减弱.当然IEEE802.11a/b也具有类似的非交叠信Page4的无线网卡,通过修改驱动程序禁止ACK(也可采用发广播包或多播包替代)和载波侦听与退避(MAC层Jammer).欺骗型Jammer[16]持续发送规则报文,把自己伪装成合法的WLAN用户.在有的实现中欺骗型Jammer仅仅持续发送802.11帧的先导域代替整个报文[16].随机型Jammer[16]可在睡眠态和干扰态之间转换,干扰tj时间,睡眠ts时间,tj,ts的取值可随机也可固定.在干扰态时,可采用持续型或随机型干扰.随机型Jammer实际上是在能量效率和干扰效率之间找到一个平衡点.反应型Jammer[16]则始终在监听信道,信道空闲时保持沉默,一旦信道活动就发射射频信号阻塞正常无线通信.反应型Jammer可以选择冲突CTS、ACK、DA-TA、RTS[17].Gummadi等人[18]还提出了一种窄带干扰方式,针对PLCP的定时同步、动态区域选择和PLCP帧头处理发起攻击.文献[16,19-20]对Jam-mer的性能指标、分类、检测手段以及anti-干扰方法等进行了综述.现有的Jammer都是针对单一频道进行干扰,缺乏全频道覆盖Jammer的研究,虽然Pelechrinis等人[21]发现当Jammer存在时也会对临近非交叠信道产生干扰,但并没有据此设计全频道覆盖Jammer,仅仅用来揭示采用频道跳变来应对干扰不一定有效.2.4IEEE802.11gJammer分析方法博弈论分析方法.采用博弈论模型分析干扰问题,Jammer和正常WLAN用户作为博弈的参加者.参与者的策略集合一般是可选择的发射功率,参与者的效用函数一般是可以评估WLAN性能的指标.正常WLAN用户是在有能量限制的情况下达到效用函数的最大化.攻击者则是力争最小化效用函数.Altman等人[22]以信号与干扰加噪声比(SINR)作为效用函数,认为Jammer和正常WLAN用户之间的博弈为零和博弈,并且可以达到纳什均衡.分别给出了WLAN中存在一个Jammer以及两个Jammer时达到纳什均衡的策略组合(T,J)和(T,(J1,J2)).Pelechrinis等人[21]提出不同的博弈论模型,参与者的策略集合为可供频率跳变的频道,效用函数为吞吐率.正常WLAN是力争最大化吞吐率,Jammer则是最小化吞吐率.作为零和博弈具有纳什均衡.分别给出了IEEE802.11a/gWLAN中存在1~4(.11a)/1~2(.11g)个Jammer时达到纳什均衡的混合策略组合.还有一些其它基于博弈论的Jammer的研究成果[23-27].马尔可夫链模型分析方法.在IEEE802.11饱和负载(比如每个站点的发送队列始终有数据包等待发送)条件下,Bianchi[28]给出了IEEE802.11DCF的离散时间马尔可夫链建模方法并给出了系统冲突概率的求解方法和有效吞吐率的计算公式,然而该文献假设站点的重传次数为无穷.Wu等人[29]令重传次数为m分别给出了m大于或小于等于退避到最大竞争窗口(CWmax)所需的重传次数时,系统冲突概率的公式以及相应的有效吞吐率计算.Wu等人[30]而后对DCF进行了性能改进,提出了新的退避机制,包括到达重传限制后,竞争窗口保持不变;每次成功发送竞争窗口减半等,并采用离散时间马尔可夫链建模方法进行了分析.Chatzimisios等人[31]将BER(比特错误率)和PER(数据包错误率)引入Bianchi[28]提出的马尔可夫链模型,分析了系统在不同BER和网络节点数目下的性能,包括有效吞吐率、平均丢包率、平均包延迟和平均包丢弃时间.针对有Jammer存在的WLAN系统,Chinta等人[32]利用Bianchi[28]提出的马尔可夫链模型,认为当有一个反应型Jammer存在时冲突的概率p应为pc+(1-pc)×q;q为干扰的概率;pc=1-(1-τ)N-1.Bayraktaroglu等人[33]采用Wu等人[29]类似的模型,即重传次数m是有限的,令m=log2(CWmax/CWmin),同时认为每个退避阶段的冲突概率是不同的,即pi=pc+(1-pc)×qi,给出无记忆、反应型以及全知型Jammer存在时,系统不同的冲突概率和有效吞吐率的计算.上述对于Jammer的马尔可夫链分析模型都假定Jammer工作在单一频道缺乏,对于全频道Jam-mer的建模研究,尤其是全知型Jammer应用困难,因为攻击者无法确定正常通信的站点的发送过程到底处于哪个退避阶段,因此无法据此确定每个退避阶段不同的qi.同时,由于上述研究假设为单频道Jammer,将干扰的影响归结为干扰概率.博弈论模型和马尔可夫链模型是分析该问题的两种方法.博弈论模型侧重正常用户和Jammer之间的博弈,通过策略选择,达到效用函数的均衡.马尔可夫链模型着重分析不同Jammer存在的WLAN中,系统的网络性能参数.在本文中,并不涉及正常用户与Jammer之间的博弈,重点在于Jammer通过调整发射功率实现干扰半径可变从而对于WLANPage5的网络性能造成打击.因此马尔可夫链模型分析方法优于博弈论分析方法,本文采用马尔可夫链模型分析方法.3ARJ设计3.1基本思想本文设计了一种干扰半径可变的IEEE802.11g全频道干扰机,在设计中为减少干扰网卡的数量和频道跳转次数利用了邻频干扰,尤其是利用非交叠信道临频干扰,将干扰网卡频道跳转次数降为零.调节干扰网卡的发射功率有效地扩展了干扰机的干扰半径,同时考虑到能量有效性,引入干扰频度.3.2ARJ结构IEEE802.11g全频道干扰机的结构如图3所示.配置有网卡A和B.网卡A周期性地在IEEE802.11g11个频道进行扫描.网卡B根据网卡A扫描的结果进行干扰.由于网卡进行信道切换时比较费时为ms级别[34],因此设计中要保证网卡B固定信道.3.3扫描过程网卡A周期性依次扫描IEEE802.11g各个频道,记录有正常用户通信的频道号的最小值和最大值CHmin和CHmax以及周围节点的信号强度RSSIdata,RSSIdata可以通过一些软件测定,如inSSIDer2①.3.4干扰参数计算与设置过程干扰参数计算过程针对扫描模块传入的结果进行计算,并输出对干扰网卡B的参数设置.预计算的参数包括:干扰所在频道CHj、发射功率P、干扰频度F,共分4步.(1)干扰所在频道为CHj=CHmin+DCH.DCH=1/2(CHmax-CHmin).(2)计算所有频道内距离干扰机最远的节点距离Dmax(DCH,DS),其中DCH为信道距离,DS为空间距离.RSSIdata表征的是DS,RSSIdata值越高表明被干扰者距离干扰机越近.同时干扰者还要估计与被干扰者通信的正常用户与被干扰者的距离.接着根据经验值或者本文第4节的式(12)推算出满足干扰半径R(DCH,P)DS的最低发射功率P.(3)定义干扰频度F为干扰机每个干扰周期内,干扰机工作时间与干扰机工作时间和干扰机沉默时间总和的比值.干扰频度F则根据第5节所述干扰机优化的要求调整.(4)根据上述计算结果调整干扰网卡B所在频道,发射功率以及干扰频度.3.5干扰过程干扰机采用随机型Jammer,干扰机在干扰态时采用持续型模式即连续地发射干扰信号,在睡眠态则停止发送干扰信号.干扰态和睡眠态的时间比值由干扰频度F决定.4方案分析在理论分析和模拟场景验证中用到的参数为IEEE802.11gERP-OFDM54Mb/s,如表2所示.参数调制方式(M=64)信道比特率(Rb)报文载荷IP头(20)+UDP头(8)+数据(1500)=1528bitMAC头PHY头ACKW0WmaxSIFSDIFSPCPBPnoiceMfadeaSlotTime4.1理论分析4.1.1DCF建模与分析由于Jammer对于WLAN通信的影响,本质上降低了信道内的信噪比,进而增大了BER,PER,导致系统吞吐率的下降[9].因此我们采用饱和负载条件下无限次重传的DCF马尔可夫链模型[28,32]且将BER,PER引入该模型[31],并采用DCF基本接入方法.基本的马尔可夫链模型如图4所示.①Metageek,inSSIDer2,http://www.metageek.net/Page6图4DCF的马尔可夫链模型其中,状态Si,k(i=0,1,2,…,m;k=0,1,2,…,Wi-1)的概率记为bi,k,i为第i个退避阶段,k为退避计数器值.P为某个站点发送报文失败的概率.显然有P{i,k|i,k+1}=1,k∈(0,Wi-2),i∈(0,m)烄P{0,k|i,0}=(1-P)/W0,k∈(0,W0-1),i∈(0,m)烅P{i,k|i-1,0}=P/Wi,k∈(0,Wi-1),i∈(1,m)P{m,k|m,0}=P/Wm,k∈(0,Wm-1烆式(4)中的等式1表明退避计数器值一定减少的事实.等式2说明一旦报文发送成功,竞争窗口将被重置为W0.等式3说明如果报文发送失败,站点将进行退避.等式4说明一旦到达最大竞争窗口,报文再发送失败,竞争窗口将维持在m.同时也可以推导出:bi,0=Pib0,0,0<i<m;bm,0=Pm/(1-P)b0,0;∑mbi,0=b0,0/(1-P);bi,k=(Wi-k)/Wibi,0.把bi,k均用b0,0表示并利用∑m推导出:b0,0=2∑m-1(1)令τ为站点发送报文的概率:i=0(2)当Jammer存在时,此时P为站点报文发送遇到冲突或发生接收报文错误导致失败的概率,假设有N个站点竞争信道,各个站点的发送是相互独立的,当至少有1个其它站点发送时冲突发生.由于Jammer的存在导致BER上升,此时的比特错误率为BERJ,报文的长度为Lbit(包括头部和载荷).(3)显然通过式(5)~(7)可以求解P.同时根据报文错误率与比特错误率的关系[35],有Jammer存在情况下,此时的报文错误率为PERJ,PERJ=1-(1-BERJ)L.令有效吞吐率为T,T=E[一个时槽内传输的有效信息长度]/E[一个时槽的长度].有Jammer存在时,信道内报文发送成功、因冲突失败、因接收错误失败的概率分别为S,FC,FE.S=Nτ(1-τ)N-1(1-PERJ),FC=1-(1-τ)N-Nτ(1-τ)N-1,FE=Nτ(1-τ)N-1PERJ.1-S-FC-FE即(1-τ)N为信道沉默的概率.于是得到有效吞吐率T的公式为T=(1-S-FC-FE)·σ+S·TS+FC·TC+FE·TE(4)σ为空闲时槽长度,TS,TC,TE分别为发送成功、因冲突失败和因接收错误失败对应的平均时槽长度,如图5所示.Page7(5)L,TS,TC和TE,σ可由式(9)计算.L=(MAC头+报文载荷)/Rb+PHY头烄TS=L+SIFS+ACK/Rb+PHY头+DIFS烅TC=TE=L+DIFSσ=aSlotTime烆对应于不同的信道BER水平和信道内的节点稀疏程度(节点数n),BER与有效吞吐率的关系如图6所示.可以看到当BER较低时,大部分的发送失败是由于节点间的竞争造成的,因此稀疏的WLAN有效吞吐率会较高,当BER较大时,发送失败则更多的是由于报文接收错误,同时此时τ已经很低,因此稀疏的WLAN由于节点数少,吞吐有效率反而较低.同时有效的干扰机应该保证信道内的BER在1.00E-03以上,此时干扰效果最佳,若BER在1.00E-03与1.00E-06之间,干扰机基本有效.若BER在1.00E-06以下,干扰机无效.4.1.2BER与SINR关系利用BER与SINR的关系[36],可以求出未经处理(raw)的BER,其中P为M-QAM的符号错误率.考虑编码增益(IEEE802.11g要求的卷积编码和维特比解码[35,37]),并应用硬判决解码,BER可表示为式(11),ad和dfree是依赖于码率文献[38]给出的取值.dfree为卷积码的自由距离,ad为权重d的错误事件总数,Pd为在距离d时维特比译码器选择不正确路径的概率.目前IEEE802.11g网卡普遍采用54Mbps连接即物理层调制方式为64-QAM.因此我们给出了BER与SINR的关系图(如图7所示).BER=∑烄烄烅Pd=烅烆烆4.2模拟场景分析为了验证IEEE802.11g全频道Jammer的有效性,我们搭建了模拟场景.Jammer采用持续型,即以恒定最大速度发送UDP广播包.正常通信节点间为AdHocIEEE802.11gUDPCBR(恒定比特率)通信路径.信道比特率为目前IEEE802.11g常采用的高速64-QAM调制的54Mbps信道.正常通信节点的发送功率为市面上常见网卡普遍使用的50mW,Jammer的网卡发射功率则根据市面个别大功率网卡设定为最高1W.模拟实际的干扰场景如图8所示.PC机A与C之间建立起802.11g标准的AdHoc无线网络,并且A作为接收端,C作为发送端.PC机B作为干扰机,通过改变与接收端A的距离与B自身无线网卡的发送功率(TXpower)来达到干扰A、C之间的数据传输的目的.其中AdHoc的信道固定,干扰信道与AdHoc信道的间隔从0~5逐一改变.Page8PC机A处的SINR(SignaltoInterferenceplusNoiseRatio,信道信号干扰噪声比)为SINRA=10lgPC×PL|C-A|其中,PC为C的发射功率;PL|C-A|为C到A的功率路径损失;Pnoise为信道噪声功率;Mfade为用于克服多径效应的衰减因子;PB为B的发射功率;PL|B-A|为B到A的功率路径损失;f为不同信道间的干扰因子(见表1).功率路径损失采用无线大尺度衰减模型[39]计算,分别仿真两种环境:自由空间和室内环境.自由空间采用式(13),其中,λ为波长;r为相距距离.在室内环境中当相距距离为50m内时,此时多为同一个房间或视距无遮挡的楼道,因此采用对数距离路径损耗模型[39],见式(14),其中n为路径损耗指数,d0为近地参考距离;Xσ为标准偏差σ的正态随机变量;当相距距离在50~110m时,此时多为不同楼层的不同办公室之间,由于距离跨度加大,因此采用改进的多层建筑物衰减因子模型[39]见式(15),其中,a为信道的衰减常数;FAF为平均楼层衰减因子.我们在实际环境中(即天津大学教学楼内)进行实测对式(14)和(15)中的参数进行了修正.因此仿真中的衰减模型已考虑了多种干扰因素.PL(dB)=PL(d0)+10nlogdPL(dB)=PL(d0)+20logd使用Matlab①对上述模拟场景进行仿真,当没有Jammer时,如图9所示.信道(A处)SINR在50m以内时较高,随着距离的增大而衰减.当Jammer工作时,Jammer与信道内节点间距离相当时信道SINR如图10所示.我们可以看到信道间隔越小,SINR越低,在交叠信道即信道间隔为0~4时,Jammer即使不增加发射功率也可以把信道SINR控制在10dB以下,此时的BER为1,有效吞吐率已经降为0.当Jammer位于非交叠信道即信道间隔为5时,若不提高发射功率,显然此时的SINR在23dB左右,BER在1.00E-06与1.00E-05之间对有效吞吐率基本没有影响,当增大Jam-mer的发射功率后,SINR明显下降,BER增大,有效吞吐率得到了抑制.(室内,PC=50mW,D(AC)=D(AB)=50m)当Jammer距离大于信道内节点间距离时信道SINR如图11所示.我们可以看到Jammer的信号衰减由于距离的增大更为强烈,当Jammer位于非交叠信道即信道间隔为5时,市面上的大功率网卡已经不能满足要求,此时的几乎没有干扰效果,干扰无效.对于交叠信道中距离较远的即信道间隔为4时,也必须将发射功率提高到相对较大的500mW才能将SINR降低到18dB左右,此时BER为1.00E-03以上,有效吞吐率被抑制为零.而对于交叠信道中距离较近的即信道间隔为0~3,Jammer不提高发射功率仍可有效干扰.(室内,PC=50mW,D(AC)=50m,D(AB)=110m)①MathWorks.MATLAB.http://www.mathworks.com/Page9因此我们认为,由于信号衰减和信道间隔的存在,干扰机的干扰半径R与信道间隔和发射功率有关.定义R(D,P).D为干扰机与被干扰者的信道距离,P为干扰机发射功率.在干扰机半径R(D,P)范围内所有与干扰机信道距离D的WLAN信道有效吞吐率为零.显然在我们设计的模拟场景中,与被干扰者通信的正常用户与被干扰者的距离为50m,同时WLAN内的正常通信用户都使用标准的发射功率在50mW左右的无线网卡.我们可以看到,典型地如R(0,P)远大于110m,R(5,50mW)小于50m,R(4,50mW)<110m,R(4,500mW)稍大于110m.信道间隔越短,干扰半径R越大.提高发射功率可以增加干扰半径R.同时信道间隔越大,提高发射功率对于增加干扰半径的效果越差.对于非交叠信道,现有无线网卡产品所能提高的发射功率水平对干扰半径R的影响已经不大.4.3干扰机实现与实验验证分析我们搭建了一个简单的干扰机系统,并仅包括干扰网卡B.干扰机在干扰态采用类-持续型,即Jammer以恒定最大速度发送UDP广播包.此时无须ACK且退避窗口始终为W025Mbit/s,IEEE802.11gUDP广播包的产生和发送使用Iperf①.搭建类似模拟场景的实验环境,主要设备如表3所示.各个网卡的发射功率均为50mW左右.由于直接调整设备发射功率和大功率网卡的欠缺,实验中采用间接手段实现发射功率的调整(增大R-S与R-J的距离比,增大接收端的J-S信号强度差值).同时由于在物理层没有禁止载波侦听,干扰机并不是真正意义的持续型,因此吞吐率只能降到近似为零(本节实验结果中的零为近似零).信号强度测量使用inSSIDer2.实验地点为天津大学内空旷无家具的面积约为85m2的一间实验室.R(Receiver)S(Sender)J(Jammer)4.3.1干扰频度验证R与S、R与J之间的距离均为50cm.在R与S之间建立15Mbps的AdHoc单播链路,工作在频道1.Jammer工作在频道4.干扰频度F通过调整Jammer的广播速率间接实现,实验结果如表4所示.J干扰速率/Mbps从实验结果可以看出,F≈干扰速率/最大干扰速率.4.3.2非交叠信道干扰半径验证R与S之间的距离可变.在R与S之间建立8Mbps的AdHoc单播链路,工作在频道6.Jam-mer工作在频道1或者2.Jammer与R的距离可变,实验结果如表5所示.分组信道距离153/-500.10/-305.00253/-500.02/-250.00343/-500.10/-302.35从实验结果可以看出,分组1与2的对比,说明提高发射功率(减小R-J的距离)后,干扰效果明显增强,干扰半径扩大.分组1与3的对比,说明信道间隔减小后,干扰效果明显增强,干扰半径扩大.与4.2节的分析相吻合.4.3.3R-S距离对干扰半径的影响在仿真环境验证中,我们固定了R-S距离,即与被干扰者通信的正常用户与被干扰者的距离.在真实实验中,我们通过改变R-S距离,获得了一系列实验数据,如表6所示.分组信道距离455/-550.10/-300.00553/-500.10/-305.00653/-500.02/-250.00752/-450.02/-251.77从实验结果可以看出,分组4与5的对比,说明R-S距离变近时,在R端,正常通信造成的RSSIdata变大,干扰效果变差.分组5与6的对比,说明Jam-mer想增强干扰效果(即增大干扰半径)需要提高发射功率.分组5与7的对比,说明增加发射功率后,干扰效果明显增强,R-S之间的距离已经可以逼近到2m,未提高发射功率前,R-S距离为3m时,干扰①NLANR/DAST.Iperf.http://iperf.sourceforge.net/Page10效果已经很差.4.4与单频道干扰机比较传统单频道干扰机采用默认的发射功率,并且并不利用临频干扰特性,因此要实现IEEE802.11g全11个频道的干扰需要跳转10次.如4.2节我们认为单频道Jammer在默认发射功率下可干扰到频道间隔为0~3的信道.要干扰的节点在ARJ的干扰半径内.假设11个频道均有无线通信流量,干扰时间为(11t)s.单频道Jammer分别在每个信道干扰ts,ARJ则在固定信道干扰(11t)s.表7显示了ARJ在有效吞吐率抑制方面的极大优势.比如对于信道1显然单频道Jammer跳转到5信道以后,信道1则在剩余时间里再也不会受到干扰.频道号跳转次数显然可以看出,单频道干扰机跳转次数过多,对于有效吞吐率的抑制率最多在50%左右而且在边缘信道干扰效果不好,而且鉴于网卡频道跳转的时间过长,t必须远大于网卡跳转时间.因此单频道Jammer实现全频道覆盖时,频道要长时间才能被再次干扰到.而ARJ不存在这方面问题.5干扰机优化由于无线网络的特殊性,能量有效性成为重要的考量指标.对干扰机的优化主要为在一定的能量消耗限制下,最大程度地降低WLAN中的网络吞吐量.5.1干扰频度犙干扰机的能量消耗和诸多因素有关,比如干扰包的长度和信号格式,干扰机传输线路等.我们把干扰机的优化归结为:使被干扰者在干扰半径内的发射功率为P,给定干扰机最大能量消耗C0,干扰频度为Q时的能量消耗C(Q,P),在C(Q,P)C0下,求解使得系统吞吐率最小的Q.显然吞吐率分别是Q的单调减函数.能量消耗(1)如果C0C(1,P),令Q=1,可以使得系统(2)如果C0<C(1,P),选择C(Q,P)=C0,可以分别为Q的单调增函数,我们可以得到:吞吐率为0.使得系统吞吐率最小.5.2干扰机的模式选择对于干扰网卡B如果采用反应式Jammer,当Jammer和正常通信的节点信道距离较远时,Jammer不能准确地侦听到报文,因此需要额外的网卡在正常通信节点所在信道侦听,这样使得干扰机的设计过于复杂,将不只仅仅用到2块无线网卡而会用到数块.在我们的设计中干扰机采用随机型Jammer,干扰机在干扰态时采用持续型模式即连续地发射干扰信号,在睡眠态则停止发送干扰信号.这种设计能量有效性受到了一定限制,相比反应式Jammer能量消耗多.当然这样也容易被anti-干扰,因此我们在下一步的工作中还要做进一步研究.6结束语本文针对WLAN易受干扰攻击的特点,提出了一种IEEE802.11g全频道干扰机,在设计中利用临频干扰,尤其是非交叠信道的临频干扰,仅用到两块无线网卡,同时干扰网卡无须进行频率跳变便可覆盖全频道,同时通过调节干扰网卡的发射功率实现了可变干扰半径,并通过设置干扰频度来实现轻量级的能量有效性.通过利用引入信道BER的马尔可夫链模型的理论分析、模拟场景的仿真分析和真实环境实验验证了我们提出的干扰机可灵活有效地覆盖IEEE802.11g全频道.下一步,我们提出的Jammer采用的是随机型,如何在反应型Jammer的基础上构建全频道Jammer进一步优化能量消耗是研究的方向.同时我们的工作中并没有涉及如何防御和检测我们提出的全频道Jammer,这些问题都是我们下一步努力工作的方向.我们的真实环境实验也有待于进一步精化和改进.致谢在此,我们向对本文的工作给予支持和建议的天津大学计算机科学与技术学院以及电子信息工程学院的老师和同学们表示感谢!
