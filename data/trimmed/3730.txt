Page1可追踪并撤销叛徒的属性基加密方案马海英1),2),3)曾国荪1),2)1)(同济大学计算机科学与技术系上海201804)2)(嵌入式系统与服务计算教育部重点实验室上海201804)3)(南通大学计算机科学与技术学院江苏南通226019)摘要属性基加密(ABE)是一种有效地对加密数据实现细粒度访问控制的密码学体制.在ABE系统中,存在恶意用户(或叛徒)泄露私钥生成盗版解码器,并将其分发给非法用户的问题.现有的解决方案仅能追查到密钥泄漏者的身份,但不能将其从ABE系统中撤销.文中提出了一种既可追踪又可撤销叛徒的属性基加密方案(ABTR).首先,给出一个具有扩展通配符的属性基加密方案(GWABE),基于3个3素数子群判定假设,采用双系统加密方法证明该GWABE方案是完全安全的.然后,利用完全子树构架将GWABE转化成ABTR方案,并证明该ABTR方案是完全安全的,且用户私钥长度是固定的.而此前的可追踪叛徒的ABE方案仅满足选择安全性.关键词属性基加密;访问控制;完全子树框架;叛徒追踪;撤销1引言2005年Sahai和Waters[1]在欧洲密码学年会上提出了属性基加密机制(Attribute-BasedEncryption,ABE)的概念.在该ABE机制中,可信授权机构为用户颁发私钥,用户私钥和密文分别与一组属性相关,当用户的私钥属性与密文属性相互匹配度达到系统规定的门限值时,用户才能解密密文.该ABE机制[1]仅能支持门限访问控制策略.为了表达更灵活的访问控制策略,2006年Goyal等人[2]在CCS会议上提出了密钥策略的ABE机制(KP-ABE),实现了对加密数据的细粒度访问控制.在KP-ABE中,密钥与访问策略相关,密文与属性集合相关,只有密文的属性满足密钥的访问策略时,才能解密密文.2007年,Bethencourt等人[3]提出了密文策略的ABE机制(CP-ABE).在CP-ABE中,密文与访问策略相关,密钥与属性集合相关,只有密钥的属性满足密文的访问策略时,才能解密密文.上述两种ABE机制实现了基于属性的灵活访问控制策略,使得它们在细粒度访问控制领域具有广阔的应用前景[2-5],例如付费电视系统、审计日志、数据库访问等.在ABE系统中,用户的访问权利与其私钥直接关联[1-6].如果合法用户泄露自己的私钥构造盗版解密设备,并将其分发给非法用户,则系统的访问控制策略将会被打破[7].特别的,在ABE机制中,用户私钥仅与其属性相关,而与用户的任何特定信息(如身份)无关,即使泄露的密钥后来被发现,我们也无法将其与任何合法用户相关联.因此,合法用户可以轻易的与他人共享自己的私钥而不用担心被发现[7-10].针对这个密钥滥用问题,学者们进行了深入的研究,提出了不同的解决方案.2008年Hinek等人[7]提出基于标号的ABE方案,使得密钥代理将会暴露用户的隐私信息,对预防密钥克隆起到威慑作用.但是,该方案无法追查到密钥滥用者的真实身份.YRLL09[8]和LRZW09[9]基于DBDH和D-Linear假设分别提出了防滥用KP-ABE方案和可追责的匿名CP-ABE方案,解决了ABE机制中密钥滥用者的身份追踪问题.WCC11[10]提出了属性基叛徒追踪方案,使用唯一身份标识用户,采用联合安全编码[11]和叛徒追踪[12]技术来确定密钥滥用者的身份.但是联合安全编码的使用导致密文和公钥长度过大,系统效率过低.因此,他们将构造一个高效的属性基叛徒追踪方案作为一个公开问题.然而,上述可追踪叛徒的ABE方案[7-10]均不能将叛徒从系统中撤销,从而无法使盗版解密设备无效.针对用户私钥的泄露问题,Pirretti等人[13]最早提出可撤销的ABE机制,使用户私钥与有效期相关,授权机构周期性更新未撤销用户的私钥,从而使已撤销用户的私钥无效,但该方案不支持用户的即时撤销.Ostrovsky等人[14]将用户标识作为一个属性,把密文和被撤销用户标识的“非”相关联,实现了CP-ABE中用户的即时撤销,但是增加了用户私钥和密文的长度.Attrapadung和Imai[15]对其进行了改进,减少撤销的开销,提出广播ABE机制.Boldyreva等人[16]采用二叉树提出可撤销的ABE方案,实现了KP-ABE中用户的撤销.但是,现有可撤销的ABE方案[13-16]都不能追查到叛徒的真实身份.综上所述,现有的ABE方案都无法同时实现叛徒的追踪和撤销[17].为了更好地防止ABE系统中盗版密钥的产生和传播,构建既可追踪又可撤销叛徒的属性基加密方案具有十分重要的现实意义.本文基于完全子树构架[18]提出一个可追踪并撤销叛徒的属性基加密方案(ABTR).在完全子树构架中,需要根据身份撤销列表将未撤销用户划分成不相交的子集,然后为每个子集的用户生成子密文,整个密文由所有子密文构成.但是,一般的ABE方案无法为由身份撤销列表划分成的用户子集生成密文.因此,无法利用完全子树构架将一般的ABE方案直接转化成ABTR方案.针对这个问题,我们首先给出了具有扩展通配符的属性基加密方案(GWABE),基于3个3素数子群判定假设,采用双系统加密方法[6]证明该GWABE方案在标准模型下是完全安全的.然后,我们利用完全子树构架将该GWABE转化成ABTR方案,并证明该ABTR方案是完全安全的,且用户私钥长度是固定的.第2节给出本文所使用的预备知识;第3节给出GWABE的定义及其安全性模型,提出一个具体的GWABE方案,并证明其相应的安全性;第4节采用完全子树构架将第3节的GWABE转化成ABTR方案,并证明该ABTR方案是完全安全的,随后将该方案与相关方案在性能方面进行比较;第5节给出全文的总结.2预备知识2.1符号说明本文中,Z表示整数环,对于正整数p,Zp表示模为p的整数环.符号x←RZp表示在Zp中随机选取元素x.当表示某个算法时,符号(a1,a2,…,Page3an)→b1,…,bm表示算法以a1,a2,…,an为输入,输出b1,…,bm.2.2访问结构和线性秘密共享方案(LSSS)定义1(访问结构[6]).设={1,2,…,n}是n个参与者的集合,集族2称为单调的,如果对任意集合B、C,都有:若B∈且BC,则C∈.访问结构(或单调访问结构)是的某些非空子集构成的集族(或单调集族),即2\,中的集合称为授权集,不在中的集合称为非授权集.定义2(LSSS[6]).称参与者集合={1,2,…,n}上的一个秘密共享方案Π是线性的,如果①参与者的秘密分享值构成Zp上的一个向量;②对于Π,存在一个秘密份额生成矩阵犃l×h和行标号函数ρ:{1,…,}→,设s∈Zp是待共享的秘密值,随机选择r2,…,rh∈Zp,构成向量狏=(s,r2,…,rh),令狏为狏的转置,则犃·狏是个秘密份额构成的向量,根据标号函数将秘密份额λi=(犃狏)i(1i)分配给参与者ρ(i).LSSS的线性重构性质:假定Π是访问结构的线性秘密共享方案,令S∈是授权集,定义I={i:ρ(i)∈S}{1,…,},则存在多项式时间算法计算{ci∈Zp}i∈I,使得对于秘密共享值s的任意有效份额{λi}i∈{1,…,},满足Σi∈Iciλi=s.将LSSS引入到本文的方案中,参与者为属性,访问结构包含所有的授权属性集.2.3合数阶双线性群和复杂性假设文献[6]提出合数阶双线性群的概念,本文利用一个群生成器算法对其定义.该算法输入系统的安全参数λ,输出一个对双线性群G的描述,即输出一个元组(p1,p2,p3,G,GT,e),其中p1,p2,p3为3个不同素数,G和GT是N=p1p2p3阶循环群,映射e:G×G→GT满足:(1)双线性.u,v∈G;a,b∈ZN;e(ua,vb)=e(u,v)ab.(2)非退化性.g∈G使得e(g,g)在GT中的阶为N.(3)可计算性.G和GT中的运算以及双线性映射e都是在多项式时间内可计算的.令Gp1,Gp2,Gp3分别表示群G的p1,p2,p3阶子群,当hi∈Gpi,hj∈Gpj,且i≠j时,e(hi,hj)为GT的单位元.子群Gp1,Gp2和Gp3之间的正交性[6]是本文构造方案的一个主要工具.下面,我们给出用于证明本文方案安全性的复杂性假设.本文中的3个3素数子群判定假设是在文献[6]中被提出的,在这些假设中,令Gp1p2等表示群G的p1p2阶子群,Pr是概率函数.假设1.给定群生成器,我们定义如下分布:=(N=p1p2p3,G,GT,e)←RX2,Y2←RGp2;X3,Y3←RGp3,D=(,g,X1X2,X3,Y2Y3),T1←RG,T2←RGp1p3.我们定义敌手攻破假设2的优势为Adv2,(λ)··=|Pr((D,T1)=1)-Pr((D,T2)=1)|.假设3.给定群生成器,我们定义如下分布:=(N=p1p2p3,G,GT,e)←RX3←RGp3,D=(,g,X3),T1←RGp1p2,T2←RGp1.我们定义敌手攻破假设1的优势为Adv1,(λ)··=|Pr((D,T1)=1)-Pr((D,T2)=1)|.假设2.给定群生成器,我们定义如下分布:=(N=p1p2p3,G,GT,e)←Rg←RGp1;X2,Y2,Z2←RGp2,X3←RGp3,D=(,g,gαX2,X3,gtY2,Z2),T1←Re(g,g)αt,T2←RGT.我们定义敌手攻破假设3的优势为Adv3,(λ)··=|Pr((D,T1)=1)-Pr((D,T2)=1)|.定义3.如果对于任意多项式时间的敌手,Adv1,(λ),Adv2,(λ),Adv3,(λ)都是可忽略的,我们就说群生成器满足假设1,2,3,即假设1,2,3均成立.2.4子集覆盖构架和完全子树构架令表示全体用户的集合,表示撤销用户的集合,\表示未撤销用户集合.子集覆盖构架[18]将每个用户与二叉树的一个叶子节点相对应,由Subset算法和Cover算法组成.Subset算法定义一个子集的集合(S1,S2,…,Sw),每个子集Si(1iw)具有一个身份模式Pi,Si中的每个用户都能解密在模式Pi下加密的密文.当有用户子集被系统撤销时,Cover算法将未撤销用户集合\划分成若干个互不相交的集合(Si1,Si2,…,Sim),使得Si1∪Si2∪…∪Sim=\.完全子树构架是对子集覆盖构架的一个具体实现,基于完全子树构架定义的加密系统由3个算法组成:(1)初始化算法.给每个合法用户指定秘密信息,用于解密消息.(2)加密算法.给定消息M和撤销用户集合,系统利用Cover算法将未撤销用户集合\划分成(Si1,Si2,…,Sim),随后选择会话密钥K,分别用这些子集对应的身份模式Pij(1Page4jm)对会话密钥K进行公钥加密,而用K对消息M进行对称加密,密文形如{[i1,i2,…,im,EncPi1(K),…,EncPim(K)],EK(M)},其中,Enc为公钥加密算法,为了提高效率减少带宽,E采用快速的对称加密算法,例如M和K的异或运算.(3)解密算法.未撤销用户u∈\首先找到j使得u∈Sij,利用自己的秘密信息解密EncPij(K),得到会话密钥K,计算DK(EK(M)),得到消息M.3具有扩展通配符的ABE方案(GWABE)为了将ABE和完全子树构架相结合实现用户的撤销,本节基于LW的KP-ABE方案[6]提出具有扩展通配符的属性基加密方案(GWABE),GWABE本质上是ABE的一种变形.为了更好地理解GWABE的定义,我们首先给出身份模式(或模式)和匹配的概念.身份模式P是由长度为n的位串来表示,其中可能包含一个通配符,通配符由其开始位置和终止位置决定,例如,长度为9的身份模式P=“101101”,其中,通配符的长度为3,开始位置为4,终止位置为6.如果P中确实包含一个通配符,则称P为扩展通配符.每个身份模式可记为P=Pip‖‖Pis,其中,Pip,Pis分别是长度为ip,is的位串(1ip,isn),通配符的长度为n-ip-is,开始位置为ip+1,终止位置为n-is.给定用户的身份id和身份模式P,如果id=P或者id和P的形式为P=Pip‖‖Pis且id=Pip‖id‖Pis,其中id是长度为n-ip-is的位串,称id和P相匹配,记作id∈P.在GWABE方案中,用户是由一个元组(id,(犃,ρ))来标识,id是一个长度为n的位串,表示用户的身份,(犃,ρ)是用户的访问结构.用户的私钥与身份id和访问结构(犃,ρ)相关,密文与身份模式P和属性集ω相关,当且仅当id∈P且ω满足访问结构(犃,ρ)时,用户(id,(犃,ρ))才能解密密文.3.1GWABE的定义和安全性模型一个GWABE方案由4个算法组成:初始化(Setup),密钥生成(KeyGen),加密(Enc),解密(Dec).Setup(λ)→PK,MSK.初始化算法输入系统安全参数λ,输出系统公钥PK和主密钥MSK.KeyGen(id,(犃,ρ),MSK)→did,(犃,ρ).密钥生成算法输入用户的身份id、访问结构(犃,ρ)、主密钥MSK,输出用户私钥did,(犃,ρ).Enc(M,ω,P,PK)→CT.加密算法输入消息M、属性集ω、身份模式P和公钥PK,输出密文CT.Dec(did,(犃,ρ),CT)→M.解密算法输入用户私钥did,(犃,ρ)和在ω和P下加密的密文CT,仅当id∈P且ω满足访问结构(犃,ρ)时,用户(id,(犃,ρ))才能解密密文,否则,解密失败.正确性.系统运行初始化算法生成PK和MSK,对于所有消息M∈{0,1},id∈{0,1}n,身份模式P,当ω满足(犃,ρ)且id∈P时,Dec(KeyGen(id,(犃,ρ),MSK),Enc(M,ω,P,PK))=M的概率为1.下面,我们通过挑战者和敌手之间的交互性游戏定义GWABE的完全安全性.(1)初始化.挑战者运行系统初始化算法,生成公钥PK和主密钥MSK,并将PK发送给敌手.(2)阶段1.敌手适应性地询问用户(id,(犃,ρ))的私钥,挑战者生成私钥并其发送给敌手,敌手可以重复多次询问私钥.(3)挑战.敌手向挑战者提交等长消息M0、M1、挑战属性集ω和挑战身份模式P,挑战者抛掷一枚公平硬币b∈{0,1},计算CT=Enc(Mb,ω,P,PK),并将CT发送给敌手.(4)阶段2.重复执行阶段1.(5)猜测.敌手输出对密文CT的一个猜测值b∈{0,1}.若b=b,且敌手从未询问这类用户(id,(犃,ρ))的私钥,其中id∈P,且ω满足(犃,ρ),则称敌手赢得这个游戏.敌手在上述游戏中获胜的优势定义为Adv=|Pr[b=b]-1/2|.定义4.如果任意多项式时间敌手赢得上述游戏的优势都是可以忽略的,则称这个GWABE方案是完全安全的.3.2GWABE方案我们首先解释本小节中所使用的标号.j∈id表示变量j取遍位串id中所有是1的位置,定义Waters散列函数为F(id)=u0Πj∈iduj,其中,uj是系统公钥PK中的元素.对于一个模式P=Pip‖‖Pis,定义F(Pip‖‖Pis)=F(Pip‖0…0‖Pis),其中,0的个数为n-ip-is.注意:如果已知所有的utip+1,…,n-is),则对任意长度为n-ip-is的位串id,我们可以使用F(idip‖‖idis)t计算F(idip‖id‖idis)t,即F(idip‖id‖idis)t=F(idip‖‖idis)t·Πj∈idut利用上述特性,如果密文中包含与通配符相应的元j,解密者可以组合与自己身份相应的ut素ut解密.令G,GT是阶为N=p1p2p3的循环群,其中,Page5p1,p2,p3是3个互不相同的素数,e:G×G→GT是双线性映射,Gpi是群G的阶为pi的子群.为全体用户的集合,||是中的用户个数,n=log2||.Setup(λ)→PK,MSK.可信授权机构输入安全参数λ,随机选择α∈ZN,g,u0,…,un∈Gp1和Gp3的生成元X3.对每个属性i,选择一个随机数si∈ZN,计算Ti=gsii.定义Waters散列函数F:{0,1}n→p1为F(id)=u0Πj∈iduj.输出系统公钥PK=G{N,g,e(g,g)α,Tii,u0,…,un},主密钥MSK={α,X3}.KeyGen(MSK,id,(犃,ρ))→did,(犃,ρ).授权机构随机选择v2,…,vh∈ZN,构成向量狏=(α,v2,…,vh).对矩阵犃的每个行向量犃x,随机选择rx,rx∈ZN,Ux,Vx,Wx∈Gp3,计算did,(犃,ρ)为Enc(M,ω,P,PK)→CT.加密算法输入消息M、属性集合ω、模式P=Pip‖‖Pis和公钥PK.随机选择t∈ZN,计算密文CT如下:C1=M·e(g,g)αt,C2=gt,C3,i=Ttii∈ω,C4=(C4,ip,is=F(Pip‖0…0‖Pis)t,其中,位串Pip‖0…0‖Pis的长度为n,0的个数为n-ip-is,即用n-ip-is个0替代P中的通配符.Dec(did,(犃,ρ),CT,PK)→M.解密算法收到在P和ω下加密的密文CT时,如果id∈P且ω满足(犃,ρ),首先计算:C4=F(id)t=C4,ip,isΠj∈id,j=ip+1,…,n-isC4,j.然后,计算常量cx使得∑ρ(x)∈ω并计算∏ρ(x)∈ω=∏ρ(x)∈ω=e(g,g)t∑ρ(x)∈ω最后,恢复消息M=C1/Me(g,g)tα.3.3安全性证明为了证明GWABE方案是完全安全的,我们需要首先定义半功能密文和半功能私钥.令1=(1,0,…,0),g2为子群Gp2的生成元.半功能密文.加密算法首先计算消息M的正规密文,然后,选择随机数c∈ZN,对每个属性i∈ω,选择随机数zi∈ZN,为矩阵犃的每个行向量犃x,随机选择Rx,Rx∈Gp2,计算半功能密文为C1=M·e(g,g)αt,C2=gtgcC4=(C4,ip,is=F(Pip‖0…0‖Pis)tRx,半功能私钥.密钥生成算法首先为用户(id,(犃,ρ))生成正规密钥,选择随机向量狏∈Zh数γx∈ZN,令δx=犃x·狏,计算I型半功能私钥为II型半功能私钥为注意:当密文的属性满足访问结构且用户身份匹配密文中的模式时,正规私钥可以解密半功能密文,半功能私钥也可以解密正规密文,但半功能私钥不能解密半功能密文,因为存在一个多余项e(g2,g2)∑ρ(x)∈ω若狏·1=0且id∈P,我们称I型半功能私钥为I型名义半功能私钥,注意:I型名义半功能私钥可以解密相应的半功能密文.该GWABE方案的安全性依赖于2.3节中给出的假设1~3,我们利用混合争论技术,借助一系列相邻游戏(GameReal,Game0,Game1,1,Game1,2,…,Gamek-1,2,Gamek,1,Gamek,2,…,Gameq-1,2,Gameq,1,Gameq,2,GameFinal)的不可区分性证明该方案的安全性,其中,q是敌手询问密钥的最大次数.GameReal:一个真实的GWABE系统的安全性游戏,私钥和密文都是正规的.Game0:与GameReal类似,除了挑战密文是半功能密文.Gamek,1:与Game0类似,除了前k-1次询问的私钥是II型半功能的,第k次询问私钥是I型半功能的,剩余的私钥是正规的.Gamek,2:与Game0类似,除了前k次询问的私钥是II型半功能的,剩余的私钥是正规的.GameFinal:在这个安全性游戏中,所有询问私钥都是II型半功能的,且挑战密文是对一个随机明文加密生成的半功能密文.引理1.如果存在一个多项式时间(PPT)算法(敌手)使得GameRealAdv-Game0Adv=ε,那么我们可以构造一个PPT算法以ε的优势攻破假设1.证明.挑战者接收到假设1的条件{g,X3,T},能够模拟GameReal或Game0.设置公共参数如下:随机选择α,si∈ZN(i),向量τ=(τy)y=0,…,n∈N,计算狌=(uy=gτy)y=0,…,n,生成公钥PK=Zn+1{N,g,狌,e(g,g)α,Ti=gsii}并将其发送给敌手,Page6保存主密钥MSK={α,X3}.当询问私钥时,利用MSK和密钥生成算法给颁发正规私钥.用属性集ω和身份模式P=Pip‖‖Pis对消息Mb进行加密,令T的Gp1部分为gt,生成挑战密文为C1=Mb·e(g,T)α,C2=T,C3,i=Tsii∈ω,C4=(C4,ip,is=Tτ0+∑j∈Pip‖Pis注意:挑战密文隐式的设置zi=si,但是,由中国剩余定理可知,simodp1与zimodp2是无关的.如果T=gt∈Gp1,上述密文是一个均匀分布的正规密文;如果T=gtX2∈Gp1p2,上述密文是一个均匀分布的半功能密文.因此,可以根据的输出以ε优势攻破假设1.引理2.如果存在一个PPT算法(敌手)使得Gamek-1,2Adv-Gamek,1Adv=ε,那么我们可以构造一个PPT算法以几乎为ε的优势攻破假设2.证明.挑战者接收到假设2的条件{g,X3,gtX2,Y2Y3,T},能够模拟Gamek-1,2或Gamek,1.设置公共参数如下:随机选择α,si∈ZN(i),向量τ=(τy)y=0,…,n∈Zn+1成公钥PK={N,g,狌,e(g,g)α,Ti=gsii}并发送给敌手,保存主密钥MSK={α,X3}.用属性集ω和身份模式P=Pip‖‖Pis对明文Mb进行加密,生成挑战密文为C1=Mb·e(g,g)αt=Mb·e(g,gtX2)α,C2=gtX2,C3,i=(gtX2)sii∈ω,C4=(C4,ip,is=(gtX2)τ0+∑j∈Pip‖Pis挑战密文隐式的设置zi=si,但是simodp1与zimodp2是无关的.下面,我们将私钥询问分为3部分.(1)当询问私钥次数大于k时,利用MSK和私钥生成算法给颁发相应的正规私钥.(2)当询问私钥次数小于k时,选择随机向量狏,狏2∈ZhWx,Vx,Ux∈Gp3,计算II型半功能私钥为K1x=g犃x·狏TrxK2x=grxVx,K3x=grxUx.注意:若Y2=gc狏=c狏2.(3)当进行第k次私钥询问时,选择随机向量狌,狌∈Zh部分为gr,隐式的设置狏=r狌+狌,随机选择γx,rx∈ZN,Wx,Vx,Ux∈Gp3,计算注意:在这个私钥中,rx=r·γx,但是rxmodp1与γxmodp2是无关的.当T∈Gp1p3,这个私钥是正规私钥;当T∈G,这个私钥是I型半功能私钥,此时,若id∈P,这个私钥是I型名义半功能私钥.下面我们证明,当的第k个询问私钥不能解密挑战密文时,无法区分第k个私钥是I型名义半功能私钥还是I型半功能私钥.注意:在访问结构(犃,ρ)中,每个属性在ρ中至多出现一次.当属性iω时,由于除了第k个以外的半功能私钥都是II型的,所以zi仅可能在第k个私钥中出现.由安全性模型可知,第k个询问私钥无法解密挑战密文,所以当id∈P,犃中ρ(x)∈ω的所有行x生成的行空间犚不包含1.因此,存在一个向量狑使得狑正交于犚,但狑不正交于1,即1·狑≠0.我们固定一个包含狑的基,则存在f∈ZN,使得狌=f狑+狌1modp2,其中狌1属于除狑外的基向量扩张的空间中,注意到狌1是均匀分布的,且无法揭露f的任何信息.由于狌·1=f·1·狑+1·狌1,且1·狑≠0,所以狌·1与f相关.当ρ(x)∈ω时,犃x·狌=犃x·(f·狑+狌1)=犃x·狌1,与f无关.当ρ(x)ω时,f·狑仅出现在犃x·狌+γxzρ(x)中,当γx≠0modp2时,每项犃x·狌+γxzρ(x)都引入一个新的未知量zρ(x),且zρ(x)不出现在其它项中,因此,无法从这些项中得知f的任何信息.准确地说,无论狌的第一个分量为何值,上述方程都有相同个数的解,因此,当所有的γxmodp2都不为0时,在看来,挑战密文和第k个私钥以几乎为1的概率均匀分布.因此,当T∈Gp1p3,完美仿真Gamek-1,2;当T∈G;以几乎为1的概率完美仿真Gamek,1,所以,可以根据的输出以几乎为ε的概率攻破假设2.引理3.如果存在一个PPT算法使得Gamek,1Adv-Gamek,2Adv=ε,那么我们可以构造一个PPT算法以ε的优势攻破假设2.证明.挑战者接收到假设2的条件{g,X3,gtX2,Y2Y3,T},能够模拟Gamek,1或Gamek,2.设置公共参数如下:随机选择α,si∈ZN(i),向量τ=(τy)y=0,…,n∈Zn+1公钥PK={N,g,狌,e(g,g)α,Ti=gsii}并将其发送给敌手,保存主密钥MSK={α,X3}.挑战密文、前k-1个II型半功能私钥和询问次数大于k的所有正规私钥的构造方法与引理2相同.当进行第k次私钥询问时,选择随机向量狏,Page7狏∈ZhWx∈Gp3,计算N,使得狏·1=α.随机选择γx,rx∈ZN,Ux,Vx,K1x=g犃x·狏Tγxsρ(x)F(id)rxWx(Y2Y3)犃x·狏,K2x=TγxVx,K3x=grxUx.注意:若T的Gp1部分为gr,则rx=r·γx.如果T∈G,则这个私钥是均匀分布的I型半功能私钥;如果T∈Gp1p3,则这个私钥是均匀分布的II型半功能私钥.因此,将根据的输出以ε的概率攻破假设2.引理4.如果存在一个PPT算法使得Gameq,2Adv-GameFinalAdv=ε,那么我们可以构造一个PPT算法以ε的优势攻破假设3.证明.挑战者接收到假设3的条件{g,X3,gαX2,gtY2,Z2,T},能够模拟Gameq,2或GameFinal.设置公共参数如下:随机选择si∈ZN(i),向量τ=(τy)y=0,…,n∈Zn+1成公钥PK={N,g,狌,e(g,gαX2),Ti=gsii}并将其发送给敌手,注意:不知道主密钥中的α.用属性集ω和身份模式P=Pip‖‖Pis生成挑战密文为C1=MbT,C2=gtX2,C3,i=(gtX2)sii∈ω,C4=((gtX2)τ0+∑j∈Pip‖Pis如果T=e(g,g)αt,上述密文为Mb的半功能密文,如果T是GT中的随机元素,上述密文为随机消息的半功能密文,此时无法获知b的任何信息.为了给用户(id,(犃,ρ))生成II型半功能私钥,隐式的选择向量狏=(α,v2,…,vh),其中,v2,…,vh←RZN,然后,随机选择向量狏∈ZhWx∈Gp3,rx,rx∈ZN,计算K1x=(gαX2)犃x,1g∑hK2x=grxVx,K3x=grxUx.注意:若X2=gc图1基于完全子树构架和GWABE的ABTR方案ABTR的目标是追踪所有叛徒的身份,并将其从系统中撤销,使得盗版解密设备无效,即允许任何用户在ω和下加密消息,使得用户是未撤销用户,且密文中ω满足该用户的访问结构,才能解密密文.同时,中的所有用户联合起来也无法解密则δx=犃x·狏2,其中狏2=d狏+(c,0,…,0),从而可得上述II型半功能私钥是均匀分布的.综上所述,可以根据的输出以ε的概率攻破假设3.定理1.如果假设1~3均成立,则该GWABE方案是完全安全的.证明.根据上述4个引理可知,如果假设1~3成立,则真实游戏GameReal和GameFinal是不可区分的,又因为在信息论意义上GameFinal中的b对敌手是隐藏的,所以敌手在GameFinal中的优势为0,从而可得敌手在真实游戏中的优势是可忽略的.证毕.4可追踪并撤销叛徒的ABE方案(ABTR)本节利用完全子树构架将第3节的GWABE转化成ABTR方案.在该ABTR方案中,令表示所有用户的集合,||是中用户的个数,n=2,为撤销用户的集合.我们首先构造一棵深log||度为n的完全二叉树,在该树的每一层上,左分支对应0,右分支对应1.与GWABE方案相同,每个用户由一个元组(id,(犃,ρ))来标识,用户的身份id∈{0,1}n被指定到二叉树的一个叶子节点.如果用GWABE在节点S和属性集ω下加密消息,我们将用通配符来替代S以下的层次,当密文中的属性满足用户的访问结构,且该用户为以S为根节点的子树中的用户时才能解密密文.如图1所示,叶子节点对应用户,Si1,…,Si4是未撤销用户的一个覆盖,使用GWABE在属性集ω和子集Sij(1j4)的身份模式下对K进行加密,以S4为例,我们用GWABE.Enc(K,ω,“11”,PK)加密K.ABTR对消息M的加密生成的密文为{ω,[i1,i2,i3,i4,GWABE.Enc(K,ω,“00”,PK),…,GWABE.Enc(K,ω,“11”,PK)],EK(M)},其中,K为会话密钥,E为对称加密算法.密文.4.1ABTR的定义和安全性模型一个ABTR方案由5个算法构成:初始化(Setup),密钥生成(KeyGen),加密(Enc),解密(Dec),叛徒追踪(Trace).Page8Setup(λ)→PK,MSK.初始化算法输入系统安全参数λ,输出系统公钥PK和主密钥MSK.KeyGen(id,(犃,ρ),MSK)→did,(犃,ρ).密钥生成算法输入用户的身份id、访问结构(犃,ρ)、主密钥MSK,输出用户私钥did,(犃,ρ).Enc(M,ω,,PK)→CT.加密算法输入消息M、属性集ω、撤销列表和公钥PK,输出密文CT.Dec(did,(犃,ρ),CT)→M.解密算法输入密钥did,(犃,ρ)和密文CT,仅当用户的身份id∈\且密文中的ω满足用户的访问结构(犃,ρ)时,输出消息M,否则,解密失败.Trace(MSK,ω,).叛徒追踪算法输入主密钥MSK、属性集合ω、撤销列表、盗版解码器,输出用户身份的集合(称此类用户为“叛徒”).正确性.系统运行初始化算法生成PK和MSK,对于所有消息M∈{0,1},id∈{0,1}n,撤销列表,属性集ω,当ω满足(犃,ρ)且id∈\时,Dec(KeyGen(id,(犃,ρ),MSK),Enc(M,ω,,PK))=M的概率为1.注意:本文的叛徒追踪算法基于子集追踪过程,用户只能用叶子节点的私钥解密密文,而叶子节点的私钥直接暴露用户的身份,因此,叛徒追踪算法可以追查到所有叛徒.该算法还要求所有盗版解密设备可以重置,即在两次解密之间不保留状态信息,特别的,盗版设备不能自毁.ABTR的完全安全模型通过挑战者和敌手之间的攻击性游戏来定义.(1)初始化.挑战者运行Setup算法,生成系统公钥PK和主密钥MSK,并将PK发送给敌手.(2)阶段1.敌手向挑战者询问任意用户(id,(犃,ρ))的私钥,挑战者运行密钥生成算法,将did,(犃,ρ)返回给敌手,并将id添加到撤销列表(初始化为空).(3)挑战.敌手提交等长消息M0,M1和挑战属性集ω.挑战者随机选取一个比特b∈{0,1},利用ω和对Mb加密,生成挑战密文CT,并将CT发送给敌手.(4)阶段2.重复执行阶段1,但敌手不能询问这类用户(id,(犃,ρ))的私钥,其中ω满足(犃,ρ)且id∈\.(5)猜测.敌手输出一个猜测值b∈{0,1}.若b=b,则称敌手赢得这个游戏.敌手在上述游戏中的优势Adv,ABTR定义为|Pr[b=b]-1/2|.如果任意多项式时间敌手赢得上述游戏的优势都是可以忽略的,则称ABTR方案是完全安全的.4.2ABTR方案Setup(λ)→PK,MSK.可信授权机构执行初始化算法,选择一个阶为N=p1p2p3(3个互不相同的素数)的双线性群G.令Gpi表示群G的pi阶子群.该算法随机选择α∈ZN,g,u0,…,un∈Gp1,Gp3的生成元X3.对每个属性i,选择一个随机数si∈ZN,计算Ti=gsi.定义Waters散列函数F:{0,1}n→p1为F(id)=u0Πy∈iduy.输出系统公钥PK=G{N,g,e(g,g)α,Tii,u0,…,un},主密钥MSK={α,X3}.此外,初始化算法还定义了一个对称加密方案(EK,DK)来加密消息.KeyGen(MSK,id,(犃,ρ))→did,(犃,ρ).授权机构随机选择v2,…,vh∈ZN,构成向量狏=(α,v2,…,vh).对犃的每一行犃x,随机选择rx,rx∈ZN,Ux,Vx,Wx∈Gp3,计算did,(犃,ρ)为Enc(M,ω,,PK)→CT.加密算法输入消息M,属性集ω,用户撤销列表和公钥PK.该算法运行完全子树构架,将未撤销用户\划分成不相交子集Si1,…,Sim,每个子集Sij(1jm)对应一个身份模式Pij=idij‖,其中idij=idij,1idij,2…idij,ip是从根节点到节点Sij的道路,idij的长度是ip.然后,加密算法随机选择一个会话密钥K,用GWABE在每个子集的身份模式Pij和ω下对K进行m次加密.最后,利用会话密钥K对消息M进行对称加密,即EK(M).下面,我们详细介绍如何用GWABE在模式Pij(1jm)和ω下对K进行加密.GWABE的加密算法选择一个随机数t∈ZN,计算Cj=(Pij,Cj2,CjCj1=Ke(g,g)αt,CjCj4=(CjCj输出密文CT={ω,[i1,…,im,C1,…,Cm],EK(M)}.Decrypt(did,(犃,ρ),CT,PK)→M.用户(id,(犃,ρ))收到用ω和加密的密文CT,如果ω满足(犃,ρ)且id∈\,用户首先找到j使得id∈Pij,并计算常量cx使得∑ρ(x)∈ωdid,(犃,ρ)解密Cj得到K.最后,计算DK(EK(M))得到消息M.3,i,Cj下面,我们解释如何解密Cj得到K,计算CjCjPage9Trace(MSK,ω,).可信授权机构执行叛徒追踪算法,该算法得到一个盗版解码器,它能以大于门限值q的概率p解密在ω和下加密的密文.当中包含t个叛徒的密钥,追踪算法执行以下子集追踪过程tlog2||次,追查到所有叛徒的确切身份,并将其添加到撤销列表.(1)追踪算法用撤销列表生成一个划分\=Si1∪…∪Sim,令pj(0jm)表示正确解密追踪密文{ω,[i1,i2,…,im,GWABE.Enc(RK,ω,Pi1,PK),…,GWABE.Enc(RK,ω,Pij,PK),GWABE.Enc(K,ω,Pi(j+1),PK),…,GWABE.Enc(K,ω,Pim,PK)],EK(M)}的概率,其中RK是一个与会话密钥K等长的随机位串,注意:p0=p,pm=0.(2)追踪算法对当前划分使用子集追踪过程,子集追踪过程使用类似二分查找法找到索引j使得|pj-1-pj|p/m.初始搜索区间为[0,m],子集追踪过程递归地执行搜索过程将区间缩短到[a,b].在每次递归执行时,计算中值c=(a+b)/2和pc,如果|pc-pa||pb-pc|,将搜索区间折半到[a,c],否则,区间折半到[c,b].经过log2m次递归执行,当a=b-1时,子集追踪过程结束并将b返回给索引j,输出叛徒所在子集Sij(3)如果Sij中用户个数大于1,将Sij分割为2个大小相同的子集Sij,1,Sij,2,得到一个新的划分Si1,…,Si(j-1),Sij,1,Sij,2,Si(j+1),…,Sim,追踪算法对新的划分继续使用二分查找法搜索包含叛徒的子集.如果Sij中仅包含一个用户,该用户一定是叛徒并将其撤销,得到一个新的撤销列表,则当前划分为Si1,…,Si(j-1),Si(j+1),…,Sim.此时,追踪算法在该划分下检测解码器解密密文的概率p,当p大于门限值q时,追踪算法对此划分继续使用二分查找法搜索包含叛徒的子集.否则,追踪算法结束,并输出所有叛徒.4.3安全性证明该ABTR的安全性依赖于GWABE的安全性.我们利用混合争论技术,借助一系列相邻游戏(TRGame0,TRGame1,…,TRGamem)的不可区分性证明ABTR的安全性,其中,m是\的划分中子集的个数.TRGame0:是真实ABTR的安全性游戏.接收到PK后,询问用户(id,(犃,ρ))的私钥,挑战者使用密钥生成算法ABTR.KeyGen(MSK,id,(犃,ρ))生成私钥did,(犃,ρ),并将其发送给,将id添加到中.提交等长的消息M0、M1和挑战属性集ω,随机选择b∈{0,1},计算挑战密文CT=ABTR.Enc(Mb,ω,,MSK),并将其发送给.输出猜测值b∈{0,1},如果b=b,称赢得这个游戏.定义赢得这个游戏的优势TRGame0Adv为|Pr[(ABTR.Enc(M1,ω,,MSK))=1]-Pr[(ABTR.Enc(M0,ω,,MSK))=1]|.如果这个优势是不可忽略的,我们称可以攻破ABTR的完全安全性.我们构造ABTR的密文如下:ABTR.Enc(M,ω,,MSK)=(GWABE.Enc(M,ω,Pi1,PK),…,其中,\被划分成m个子集Si1,…,Sim,每个子集Sij对应身份模式Pij.在后面的游戏中,我们逐步修改挑战密文,定义修改后的加密算法ABTR.Enck为ABTR.Enck(M,ω,,MSK)=(GWABE.Enc(M0,ω,Pi1,PK),…,注意:ABTR.Enc0(·)=ABTR.Enc(·),ABTR.Enck(M0,ω,,PK)=ABTR.Enc(M0,ω,,PK),0km,ABTR.Encm(M,ω,,PK)=ABTR.Enc(M0,ω,,PK),其中M为任意消息.TRGamek(k=1,2,…,m):与TRGamek-1相同,除了挑战者用ABTR.Enck(·)替代ABTR.Enck-1(·).我们用TRGamekAdv表示敌手在TRGamek中的优势.注意:在最后一个游戏TRGamem中,挑战密文总是对消息M0的加密,因此,在该游戏中的优势为0.引理5.如果存在一个PPT算法使得TRGamekAdv-TRGamek-1Adv=ε,那么我们可以构造一个PPT算法以ε的优势攻破GWABE安全性.证明.的挑战者运行GWABE的初始化算法,生成PK,MSK,并将PK发送给,收到GWABE的公钥PK,能够模拟TRGamek或TRGamek-1.由于GWABE和ABTR具有相同的公钥,将PK作为ABTR的公钥发送给.当询问用户(id,(犃,ρ))的私钥时,向其挑战者询问(id,(犃,ρ))的私钥,得到did,(犃,ρ)并将其Page10发送给.由于GWABE方案和ABTR方案的密钥生成算法是相同的,所以可以确保给的私钥是正确的.当敌手询问用户(id,(犃,ρ))的私钥后,将id添加到撤销列表中(初始为空集).将\划分成Si1,Si2,…,Sim,提交等长消息M0、M1、模式Pik和挑战属性集ω给其挑战者,该挑战者生成GWABE的挑战密文CTb=GWABE.Enc(Mb,ω,Pik,PK)并将其发送给.计算ABTR的挑战密文CT=(GWABE.Enc(M0,ω,Pi1,PK),…,并将其发送给.接收到CT后,可以继续询问用户的私钥,注意:此时不能询问这类用户(id,(犃,ρ))的私钥,其中,ω满足(犃,ρ)且id∈\.当输出它的猜测值后,将输出相应的猜测表1本文ABTR方案与相关方案的性能对比密文长度方案私钥长度NNL[18]O(log||)IDTR[19]O(1)O(log||)O(rlog(||/r)·log||)O(rlog(||/r)·log||)O(log||)完全安全ABTT[10]O(1)O(c2log(||/r)+log(1/ε))O(c2log(||/r)+log(1/ε))O(c2log(||/r)+log(1/ε))O(log||)选择安全本文的ABTRO(1)O(log||)O(rlog(||/r)·log||)O(rlog(||/r)·log||)O(log||)完全安全销用户.事实上,还存在其它的撤销方法,例如周期性更新用户私钥[13]和引入半可信的仲裁者[20]等撤销方法,如何将这些撤销方法和叛徒追踪算法有机结合起来,生成效率更高的ABTR方案,是我们未来重点的研究工作.致谢在此,我们向对本文提出宝贵修改意见的匿名审稿老师表示衷心的感谢!与ABTT方案[10]相比,本文的ABTR方案同时支持叛徒的追踪和撤销,且当叛徒个数较大时,该ABTR方案的效率高于ABTT方案.与NNL[18]和IDTR[19]方案相比,该ABTR方案支持加密数据的细粒度访问控制,且用户的私钥长度是固定的.5结论本文首先提出一个具有扩展通配符的ABE方案(GWABE),然后,将GWABE和完全子树构架[18]相结合,提出一个可追踪并撤销叛徒的属性基加密方案(ABTR),并证明该ABTR方案是完全安全的,且用户私钥长度是固定的.本文的主要贡献有3个方面:(1)该ABTR方案同时支持属性基加密系统的叛徒追踪和用户撤销两种功能.(2)该ABTR方案能够在标准模型下证明其完全安全性,而此前可追踪叛徒的ABE方案仅满足选择安全性.(3)我们提出了一个GWABE方案,并证明其完全安全性.GWABE可以用来设计可撤销的ABE方案,可能具有独立的学术价值.本文基于完全子树构架采用撤销列表的方法撤值.由ABTR挑战密文的构造可知,当b=0,模拟的游戏是TRGamek;当b=1,模拟的游戏是TRGamek-1.因此,能够以ε的优势攻破GWABE的安全性.定理2.如果GWABE是完全安全的,则ABTR是完全安全的.证明.由引理5可知,如果GWABE是IND-CPA安全的,则相邻游戏TRGamek和TRGamek-1(k=1,2,…,m)是不可区分的.因此,TRGame0和TRGamem是不可区分的,由于敌手在TRGamem中的优势为0,所以,敌手在TRGame0中的优势是可以忽略的,即定理2成立.4.4性能比较表1将本文ABTR方案和相关方案在效率和安全模型方面进行了详细比较,其中ABTT[10]方案需要在系统初始化前设置叛徒的最大个数c,且追踪算法出错的概率为ε.r表示撤销用户的个数,||表示全体用户的个数.
