Page1面向异步通信机制的无线传感器网络及其MAC协议研究胡玉鹏1)林亚平1)周四望1)刘永和1),2)1)(湖南省“可信系统与网络”重点实验室,湖南大学信息科学与工程学院长沙410082)2)(德州大学阿灵顿分校计算机科学与工程系美国阿灵顿)摘要无线传感器网络的底层通信主要依赖于节点间的协同睡眠/唤醒机制,且仍然在链路层沿袭或扩展传统802.11协议.对于节点密集、网络规模较大的传感器网络而言,传统802.11协议在网络能耗与吞吐量等方面并不是有效的.基于传感器网络在多数应用场景中的链路动态性,文中提出一种面向弱连接的异步通信机制.有别于传统的RTC/CTS握手机制,它允许发送节点直接向“睡眠”的接收节点上的低功耗异步模块写入数据,因此,无需同步机制,单个节点只需按照自身的时间唤醒并进行数据通信,形成一种缓存-唤醒-转发的异步通信模式.文中首先阐述了异步通信机制的关键设计因素,针对不同的应用背景提出两种新的MAC协议.然后,基于扩散近似理论建立开放式排队网络模型,对异步通信机制的性能进行理论分析,得出其网络吞吐量为OW验结果表明,与传统同步通信相比,异步通信能在很大程度上延长了网络的生存周期,提高了网络吞吐量.关键词无线传感器网络;异步通信机制;MAC协议;能量有效性;网络吞吐量1引言无线传感器网络在诸多领域潜在的广泛应用前景(如战场监视、环境和交通监测、灾难救助等),吸引了众多研究者对其进行研究,并且取得了较为丰富的研究成果.与传统网络相比,无线传感器网络资源有限,且通常部署在野外环境,其链路往往呈现出较强的动态性[1-5].目前无线传感器网络的底层通信协议主要依赖于节点间的协同唤醒/睡眠机制.特别是物理层和链路层协议仍然是沿袭传统IEEE802.11无线协议的扩展技术.虽然IEEE802.11协议对于规模较大、节点较密集的无线传感器网络而言,在能量有效性与网络吞吐量等方面并不是有效的[6-9],但目前提出的大多MAC协议,包括S-MAC[10]、T-MAC[11]、B-MAC[12]、P-MAC[13]、SCP-MAC[14]、RI-MAC[15]和CCP-MAC[16-17]等,均沿袭802.11协议的RTS/CTS握手机制与随机时间片竞争机制.在这些MAC协议中,仍然采用传统的载波侦听和基于随机退避机制的冲突避免方法作为底层的信道管理机制;而能量有效性则依赖于节点间协同的睡眠/唤醒机制.因此,除节点间建立稳定链路所需的同步开销外,将节点间的通信限制在狭窄的通信窗口内不可避免地会增加冲突概率和无关的数据侦听[18-19].实际上,无线传感器网络物理层和链路层的瓶颈已经成为阻碍其迈向应用的重要因素之一.此外,研究者针对无线传感器网络节能的要求,通过改进底层硬件模块探索一些新的通信方案,主要有PicoRadio[20-21]、Radio-triggered[22]、STEM[23-24]和Wake-upradio[25]及Wake-on-Wireless[26].这些方案主要是研究在节点上嵌入额外的低功耗唤醒Radio/模块,用于检测唤醒信号以唤醒睡眠节点,然后再依靠主Radio接收数据,以减少不必要的空闲侦听.但是此类唤醒Radio/模块均不是用于数据接收/缓存,且唤醒Radio/模块本身需要周期性地唤醒,并接收/发送唤醒信号,从而消耗额外的能量.因此,目前该类研究大多停留在探索阶段.本文基于低功耗的通信模块和缓存-唤醒-转发思想,提出一种面向弱连接的适合无线传感器网络的异步通信机制(AsynchronousCommunicationMechanism,ACM).无需节点间同步的睡眠/唤醒与RTS/CTS机制,ACM允许单个节点独立地进行唤醒与数据传输,它允许发送节点直接向睡眠中的接收节点发送数据,接收节点通过特定的低功耗模块半被动式(Semi-passive)地接收并缓存数据,从而使得节点保持一种缓存-唤醒-转发的异步工作模式.因此,无需同步机制,单个节点仍然可以正常工作,节省了节点同步与链路建立的能耗.由于ACM利用传统协议通常忽略的睡眠时间作为一种“额外”的网络资源,且采用短的唤醒期,故可以很大程度上减少冲突和无效的信道侦听,从而提高网络吞吐量,降低系统能耗.因此,这种新的异步通信机制需要特殊的软硬件支持,如低功耗的被动式接收模块、MAC协议及上层数据处理算法等.本文在阐述异步通信机制原理的基础上,将主要讨论低功耗接收模块及底层MAC协议的设计.首先,本文基于目前传感器元件的工艺水平,采用半被动式RFID来设计低功耗接收模块,在半被动式状态下,该模块能以很低的功耗接收数据.然后,在分析了异步通信模式特性的基础上,提出了两种不同的解决方案:协同式的随机唤醒机制(CoordinatedRandomWakeupSchedule,CRW)和交错唤醒机制(InterleavedWakeupSched-ule,IWS),以满足不同的应用需求.为了从理论上对ACM进行分析,本文建立了通用排队网络模型GI/GI/1-FCFS,对ACM的多个性能指标进行分析与比较,包括网络吞吐量、传输延时及单字节传输能耗等,比如,分析表明ACM中的网络吞吐量可达n/log槡()n.理论分析与实验结果表明,与同步通OW信相比,异步通信能在很大程度上延长网络的生存Page3周期、提高网络吞吐量.本文第2节对异步通信机制与主要原理进行阐述;第3节讨论异步MAC协议;第4、5节建立通用排队网络模型并进行理论分析;第6节进行性能比较与实验验证;最后总结全文并展望下一步工作.2异步通信机制2.1总体设计本文提出的异步通信机制ACM是允许节点在近似睡眠的低功耗状态下,正确接收数据(注:本文提出的异步通信概念与文献[27]中的异步唤醒是两个不同的概念,区别于其基于节点时钟偏移的同、异步定义).异步通信实现的关键在于额外增加的异步模块,即一种半被动式、开放的低功耗异步射频模块(Semi-passiveOpenLow-powerAsynchronousRadiomodule,SOLAR)的实现.若用SOLAR模块承担传统传感器节点(如Mica2)的无线接收功能,则节点可以通过SOLAR模块接收邻居节点发送的数据包,并将数据包放入SOLAR模块缓存中等待节点进入激活状态处理.SOLAR模块的另外一个优点是可以向后兼容,即可以在关闭后,采用传统的通信方式进行数据传输.图1(a)显示了异步通信状态下的传感器网络,图1(b)显示了配置了SOLAR模块的节点的内部结构.在该异步架构中,某节点a可以根据自己的唤醒时间进行唤醒,然后发送传感数据到接收节点b的SOLAR模块.当节点b唤醒后则可以收集缓存在SOLAR模块的数据,然后通过发送Radio转发数据到下一跳节点.从而形成一种缓存-唤醒-转发的多跳异步通信模式.除了Radio-SOLAR通信方式,传统的Radio-Radio通信方式可以作为异步通信的补充模式.因此,在这种异步通信模式中,无需传统MAC层的载波侦听与冲突避免机制(CSMA/CA).因为节点充分利用了全部的通信时间,不再限制在狭窄的传统唤醒时间段内进行通信(如S-MAC通常采用1%~10%的占空比进行数据侦听,而剩余90%的时间处于休眠状态),故无线冲突概率很低,这样单个节点在唤醒后即可发送数据,简化了发送与接收数据的过程,从而提高了能量有效性.本节提出的基于异步通信架构的无线传感器网络适合于环境监控等基于概率事件的应用场景,如精细农业作业中的温度和湿度数据采集.与传统网络相比,在这些应用场景中,数据包长度较短,一般有效负载约为30~40字节,从而满足下面将要阐述的SOLAR模块的特性及异步环境下低冲突概率的特性.2.2SOLAR模块SOLAR模块是该异步通信机制的关键组成部分.本文基于目前传感器元件的工艺发展水平,利用现有的低功耗Radio和激活逻辑电路(activationlogic)技术设计SOLAR模块,使其能在低功耗状态下半被动式地接收数据.目前一些项目也已经对能量有效的唤醒Radio/模块进行了初步的研究[20-26],所采用的方法主要是通过额外的唤醒Radio/模块对信号进行检测以唤醒主Radio进行通信,由于均不是用于数据接收/缓存,因此这些模块并不能直接用于构建SOLAR.当前硬件技术的发展,尤其是当前的低功耗的无线射频识别(RadioFrequencyIdentification,RFID)标签(tags)的广泛使用,使得异步无线接收模块SOLAR的设计具有可实践性[28-29].RFID的基本原理是利用射频信号和电磁耦合,实现对标签识别码和内存数据的读取或写入操作.但如果采用全被动式的RFID标签,需要从发送节点的电磁耦合吸收全部能量,发送节点需要使用较高的发送功率.对于无线传感器网络而言,这一点难以满足.而主动式(active)的RFID标签,则与传统节点的Radio工作方式基本相同,完全依靠节点自带的电Page4池供电进行数据接收和发送,达不到节能目标.因此,基于SOLAR的低功耗需求,半被动式的RFID标签是一种很好的选择.目前,SOLAR模块采用的半被动式的RFID标签与全被动式的RFID标签的主要区别在于:无需从全部射频信号获取能量,节点内装有电池,电池仅对标签内要求供电维持数据的电路或标签芯片工作所需的电压作辅助支持,而标签电路本身耗电很少.标签在未进入工作状态前,一直处于休眠状态,当进入干扰范围时,受到节点发出的射频能量激励,进入工作状态,结合自身电池的能量接收数据.采用半被动式RFID标签的另外一个优点是增加了节点Radio感应灵敏度,延长了发送距离.因为半被动式的RFID标签采用一个电池供电的直流放大器,很大程度上提高了标签本身的灵敏度,降低对发送功率的要求,因此提高了有效通信距离.目前作为畅销产品的半被动式RFID标签很容易获取如IntelleFlex(www.intelleflex.com)标签具有近64K字节的读写容量,且依靠薄膜电池供电,使用寿命长达几年之久.按照目前Mica2的发送能力,在10mW的发送功率下,IntelleFlex公司的半被动式标签的有效通信距离可以达到约50英尺,足以满足大多数传感器网络的应用要求(放大器的本身功率是很小的,目前Texas仪器公司提供的放大器的本身功率约为毫微瓦).此外,SOLAR模块与一般RFID标签的一个重要不同之处在于不需要Radio进行读操作,即从SOLAR内部读取数据,这样进一步降低了SOLAR模块本身设计的复杂度.图2是基于IntelleFlex公司的半被动式RFID标签设计的SOLAR模块.该RFID标签提供了单独的射频收发芯片,能满足目前SOLAR模块在低功耗状态下接收数据的要求.目前主要是基于IntelleFlex公司Tags系列产品所采用的XC3Technology架构,以及其遵循的底层RFID数据标准,进行二次开发,包括接口连接控制和通信方式定制.为了与RFID标签无缝整合,节点可以采用Texas仪器公司的CC1110芯片,可以与IntelleFlex公司的RFID标签工作在同一个频率(如900MHz左右).如图2所示,节点上CC1110的SI接口与处理器Atmega128L的MOSI接口相连,进行数据发送;而原来与发射芯片相连的MISO接口则变为与SOLAR模块的输出接口相连,将SOLAR接收的数据载入Atmega128L进行处理.因硬件设计不是本文重点,故在此不再详细描述.2.3异步通信网络基本操作与状态状态.异步传感器网络包含几个重要的网络操作和初始化操作.节点部署后,首先节点将采用Radio-Radio或Radio-SOLAR通信方式进行网络的初始化操作,此过程类似于传统网络的初始化,包括参数设置、建立邻居表、路由建立、成簇和定位等等.传感与信息采集.初始化后,每个节点将从[0,Tf]时间段内随机选择一个初始唤醒时间t,Tf代表一轮的工作周期.每个节点将进行周期性的唤醒,每隔一定时间进行一次数据汇报.SOLAR模块接收数据后,节点在唤醒后对数据进行相应的处理(如数据融合)并交给主模块进行转发.数据传输操作.节点在睡眠期间,可以通过SOLAR模块将对接收的数据进行缓存.由于SOLAR模块的接收带宽有限(只有几十Kb/s),采用FIFO队列机制对数据进行缓存,避免数据覆盖.节点在睡眠期间,可能已经从邻居节点接收了数据,当节点按照自身的时间表唤醒后,首先从SOLAR模块收集数据并存储到主内存,对数据进行相应的处理后进行数据转发.与传统通信机制不同,节点唤醒后所进行的“侦听”与传统侦听不同,其无需利用Radio进行载波侦听和冲突避免,而是利用CPU和SOLAR模块工作,对SOLAR模块缓存队列的数据进行检查,根据MAC包头地址,若在“侦听”阶段没有发现需要转发的数据包(包括“侦听”阶段收到的数据)即转入睡眠,否则进行数据处理,并以突发(burst)的方式发送数据.由于节点充分利用了全部的通信时间,不再限制在狭窄的传统唤醒时间段内进行通信,正如下面分析的一致,信道的无线冲突概率将很低,结合低的占空比DutyCycle(本文指“侦听”时间与“侦听”/睡眠周期的时间比),以减少无效的信道侦听.与传统的MAC协议(如802.11,S-MAC)相比,节点的状态要简化了很多,可以进一步提高能量有效性.异步通信下的多跳路由操作可以结合现有的多种路由协议,包括能量有效的层次路由协议或平Page5面路由协议,如LEACH[30]、定向扩散[31].异步ACK机制.虽然冲突概率已经很低,但考虑到在一些重要应用中需要确保数据的传输质量,本文针对异步通信的特性采用一种新的应答(ACK)机制,提高数据传输的可靠性.传统的RTS/CTS/DATA/ACK机制中,节点接收数据后要额外发送一个ACK帧,新的异步ACK机制与此不同,该机制在发送的数据包中搭载额外的ACK标识字段表示是否需要接收节点返回一个ACK.接收节点收到ACK标识字段为true的数据包后需要进行确认,返回一个ACK给发送节点.而这种DATA-ACK确认机制同样采用一种异步的方式:即接收节点在唤醒后进行ACK确认,通过搭载机制将ACK确认和应答地址附带在转发的数据包中.若节点连续没有收到ACK应答(包括重发包的应答),认为冲突发生,则再次选择一个新的随机唤醒时间点进行下一轮的数据发送.3异步MAC协议底层通信模式的改变将导致上层协议发生根本的变化.首先,异步的唤醒和多跳通信模式会导致额外的通信延时,包括排队延时和唤醒延时.异步通信环境下,由于异步唤醒以及多跳通信模式造成的通信延迟,传感器汇聚节点收集到的数据将呈现出不规则的时间模式.因此,下面提出两种适合异步通信的MAC协议缓解以上问题:如果网内处理技术可以将数据进行有效的融合,则采用协同的随机唤醒机制(Coor-dinatedRandomWakeupscheme,CRW);如果具体应用当中未使用网内数据处理,或网内数据处理失效,则采用交错的唤醒机制(InterleavedWakeupScheme,IWS),使得节点能够较频繁地唤醒,进行数据转发.3.1协同的随机唤醒机制CRW如果网内的数据融合能有效地减少数据量,采用协同的随机唤醒机制CRW将节点的唤醒时间进行规则化,从而缓解时间不规则性,保持数据传输的有序性,使数据包能连续有序地向前传输.其主要原理是:根据节点与Sink的跳数来安排唤醒顺序,数据传输路径上距离Sink越远的节点越早唤醒,并通过数据融合技术有效地对传感数据进行融合,避免单个节点产生长消息数据,可将数据的传输延时限制在一轮时间周期T内.在某个时间周期内只要节点比它的前一跳节点晚唤醒则能够保持传感数据的有序传输.然而,关键是如何协调分布密集的节点之间的唤醒顺序,同时保持异步通信的特点,所以本文采用的方法是根据节点与Sink的距离为其分配时间段,离Sink越远的节点,越早唤醒.为了避免邻居节点间的冲突,允许节点在相应的时间段内随机地选择唤醒时间点.如果节点通过ACK丢失发现冲突,则重新选择一个新的唤醒时间点进行下一轮的数据发送.CRW中具体定义的唤醒时间选择如下:设节点到Sink的跳数为d(d0),每一轮的时间周期为T,节点A随机地选择它的唤醒时间为tw,tw均匀分布于tw=U2T1-1其中α>0,是与具体应用相关的网络参数.由上式可见,离Sink越远的节点越早唤醒,而Sink附近的节点后唤醒.不同跳数的节点所分配的时间段/帧表示为而且,为了计算节点与Sink节点的跳数d,Sink节点可以通过在网络的初始化阶段发送一个广播数据包,携带一个计算距离的字段,初始值设定为0,每被中转节点转发一次,该字段加1,直到遍历整个网络.图3(a)描述了α对时间段分配的影响.Y轴表示规一化的时间段比例Td/T,X轴表示节点与Sink的跳数(Hop).图3(a)中离Sink越近的节点分配的时间段越长,这是由于Sink附近的数据流量通常比较大,离Sink越远的节点分配的时间段则相对较短.随着α的缩小,离Sink越远的节点所分配的时间会变长,而离Sink越近的节点分配的时间段缩短,从而可以很好地控制冲突概率.反之,如图3(b)所示,根据具体的网络分布和流量情况,可以选择给离Sink远的节点分配较长的时间段.3.2交错的唤醒机制IWS如果网内数据处理不能有效地降低网络通信负荷,那么CRW机制将会造成大量数据积压在Sink周围节点.为解决数据包积压,本文提出一种交错的唤醒机制IWS,采用数据包交错的逐跳的转发模式.该IWS机制的主要思想是:让节点更频繁地唤醒来缓解Sink点周围的拥塞状况,且利用频谱空间的交替使用以降低冲突概率.与CRW机制相似的Page6图3参数α对时间段分配的影响是,每个节点从一个时间周期中随机选择一个时间点作为初始唤醒点,然后进行周期性的调度.关键的不同之处在于,CRW机制中所有节点共享一个时间周期T,而交错的唤醒机制IWS只有相邻的一组节点才共享一个时间周期.该机制的具体内容为:将路由上的所有节点分成不同的虚拟组,每个组包含G个节点,共享一个时间周期Tc.在单个组中,根据该节点到Sink点的跳数,每个节点会被赋值一个不同但连续的唤醒时间窗口Tc/G,在时间段Tc/G内均匀随机地选择一个唤醒时间点,进行唤醒和数据发送,传输路径后面的其它分组则采用相同的调度方法.IWS利用频谱空间的复用及G的大小所控制的唤醒频率来降低冲突概率.设一个唤醒-睡眠周期设置为Tc,ui表示传感器节点u到Sink点的跳数为i(节点到Sink跳数的计算方法与CRW机制相同),节点ui在ti(n)唤醒,定义为ti(n)=U0,Tc[]G+(G-(imodG))TcG+(n-1)Tc,烄imodG≠0烅U0,Tc[]G+(n-1)Tc,烆其中n=1,2,…表示数据采集的周期数,为了说明上式的含义,就如图4(a)所示,假设G=2,离Sink节点为偶数跳的节点将在任意的Tc/2的时间随机醒来,而奇数跳的节点将在剩下的Tc/2的时间随机醒来.即唤醒序列为[(u2,u4,u6…),(u1,u3,u5…)].图4(b)显示的是G=3时的情况,相同颜色的节点在相同的时间窗中唤醒,唤醒序列为[(u3,u6,u9…),(u2,u5,u8…),(u1,u4,u7…)].因此,通过调节周期时间Tc和组大小G能有效控制节点唤醒频率.假设极端情况下,若每个节点独立成组,G=1时,网络转入没有调度机制的状态;若所有路由节点属于一个虚拟组,则转入与CRW机制相似的状态,CRW为IWS的一种特殊情况.所以无论组大小为多少,一个时间周期内数据包在组内每个节点仅中转一次.图4IWS机制:相同颜色的节点在同一个时间窗口进行唤醒4通用排队网络模型本节首先描述基本网络参数与相关预备知识.然后基于排队论[32]与扩散近似理论[33]建立通用排队网络模型,对异步通信进行分析比较.设传感器网络由n个静止的传感器节点组成(不包含Sink),设每个节点的通信半径均为R,Rij表示节点i与j之间的距离.N(i)表示节点i的邻居节点集合,N(i)非空,i.i的邻居节点集中在以i为圆心的面积为A^(n)=πR2的圆形区域内(注:对于异步通信而言,其通信半径由于基于RFID的SOLAR模块的原因,接收范围比较短,设通信面积为A(n),且A(n)<A^(n)).设节点的发送速率均为W.本文的通信干扰模型如式(1),只要节点i为j的邻居节点,且其它同时向j发送数据的节点k均不在通信范围内,节点i就可以成功发送一个数据包给节点j.定义1.干扰邻居.基于式(1),若两个节点的Page7距离在2R内,则有可能相互干扰对方的数据发送,故称它们互相为“干扰邻居”.4.1相关预备知识扩散近似可以用来分析复杂的排队网络模型,已经被广泛认可为既能降低复杂度,又能获取较高精确度的一种方法[34].当节点从邻居接收到一个数据包时将以概率(1-p(n))对数据包进行转发,或以概率p(n)接收并不进行转发.当节点转发数据包时,周围的邻居均能以相等的概率接收该数据包.设采样数据到达传感器网络的时间间隔服从均值为1/λ、变异平方系数SCV为c2表示数据到达某节点i的SCV.单个数据包在节点i的处理时间服从均值和SCV分别为1/μ和c2般分布.单个节点的访问率ei定义为:单个数据包在网络中的处理完成离开前,被该节点处理的平均次数.基于扩散近似理论得知[32]:其中,p0i表示数据包从节点i进入网络的概率;pij表示从节点i进入节点j的概率.从式(2)可以发现有两种不同类型的数据包进入某节点i:一类是直接在节点i进入的;另一类是从其它节点转发过来的.因此,有效到达率λi定义为节点i的利用率/服务强度表示为ρi=(λi/μi)<1.根据式(2)和(3),c2B0=c2且c2数据包数为k的概率是其中,从而可以得出节点i中的平均顾客数量为基于扩散近似理论可获取便于应用的闭合分析结果,同时保证较好的精确度.4.2通用排队网络模型与Gupta-Kumar[33]模型及其它模型不同[35-36],本文建立的开放排队网络模型GI/GI/1-FCFS(如图5所示)并不是针对单跳网络场景,或理想的MAC协议(如TDMA).第5节的分析中将考虑多跳的传感器网络及MAC协议中的多种性能影响因子,从细节上刻画MAC协议的特性.本节将利用扩散近似方法建立开放式的排队网络模型GI/GI/1-FCFS(GI表示数据包的到达和服务时间均为独立的一般分布,数据包按照先进先处理的方式,且最终会离开网络发往Sink),为便于分析,理论分析时设定通信半径R=logn/槡n,这与文献[33]的条件相同(实际比较时,异步半径比传统同步要短).图5通用排队网络模型GI/GI/1-FCFS(pij(n)表示数据包从i发往j的概率,j以概率p(n)接收)引理1.数据包从节点i发往节点j的概率(以下分析结果均为平均值,即指各种网络拓扑、各种网络规模下的所有数据包的平均值)p-ij(n)=p-证明.令P[i→j]表示数据包从节点i发往节点j的概率.首先定义几个重要参数:βj,kαj,kβj因此,可以推出i→j=1βj,k由于节点随机独立地分布于单位面积的圆形区域内,节点i为节点j的邻居平均概率为A(n),则有P[j∈N(i)]=A(n),进而可以得出k1-P[i接收且不转发数据包αj,ki=n-2根据全概率原理有Page8p-ij(n)βj由于只有当节点j为节点i的邻居时,节点i才会将数据包转发给节点j,因此,P[i→jN(i)]=0.因此,代入p-ij(n)=P[i→j|j∈N(i)]P[j∈N(i)]p-从而引理1得证.当(1-A(n))n-1→0时,即A(n)使得网络中几乎没有孤立节点时,基于扩散近似理论,节点i的访问率如式(2)所示,在两端同时取平均值可以得到由于网络中节点性质相同,根据对称性有珋ei=珋ej,i,j.且当(1-A(n))n-1→0时,p-因此,珋ei可化为则节点i的平均访问率珋ei(即数据包在被处理完之前,在网络中传输时被节点i转发的平均次数)为然后,令h表示数据包从源节点到目的节点所经过的跳数,则易知其中k>0.于是可以推出珔h=E[h]=∑因此有,数据包在到达目标节点之前的平均跳数为珔h=1/p(n).5建模与性能分析本节将对异步与传统MAC协议的各项性能进行建模分析,包括传输延时、吞吐量及单字节传输能耗.5.1异步通信建模与分析在分析之前,本节首先计算一些重要的网络参数,包括数据包有效到达率、平均“干扰邻居”数量等.设节点处于唤醒状态的时间为指数分布,均值为1/μS;处于睡眠状态的时间为均值为1/μA的指数分布.节点间的状态相互独立,且在睡眠状态不进行数据采样.则易知节点处于唤醒和睡眠状态的概率,即处于唤醒/睡眠时间占总时间的比例,PA,PS分别为且对于异步MAC协议IWS而言,PA∝1/G.设单个节点的采样率为λpackets/s,则数据包在节点i的有效到达率λi为λi=λPA/p(n).由于节点采样生成数据包的过程为相互独立的泊松过程,该过程的平均到达率为λPA.故对整个网络而言,外部数据的到达率为λe=nλPA,然后,根据式(3),即可得出.设Xi表示节点i的“干扰邻居”的数量,则Xi为E[Xi]=4(n-1)A(n).由于某节点为节点i的“干扰邻居”的概率为π(2R)2=4A(n),因此P[Xi=q]=n-1()q可见Xi为二项式分布,故E[Xi]即为二项式分布的一阶矩.引理2.设犡i为节点i的“干扰邻居”中有数据包需要发送的节点数,ρ为节点的利用率,则在稳定状态时犡i为证明.设Uj=1(1jXi)为节点j的随机变量,用于表示稳定状态下,节点j是否有数据需要发送.Uj=1表示节点为唤醒状态且有数据需要发送;Uj=0则表示节点没有数据需要发送.根据式(5),可推出P[Uj=1]=ρjPA,其中ρj表示节点j的利用率.因此,E[Uj]=ρjPA.根据对称性,ρj=ρ,j,则犡i=∑Xi然后将E[Xi]代入,即可证明引理2.证毕.延时与网络吞吐量对于异步MAC协议,发送节点i每一次的数据包传输的时间犛i将包括两个部分:(1)检查SOLAR模块的时间;(2)成功发送数据包的时间.则不使用异步ACK机制时,犛i=t-ACK机制,则节点只有等到下一次唤醒后才知道是否要重发,故犛i=t-睡眠周期的长度.由于信道冲突,成功的数据包传输可能需要多次发送.当节点i发送数据包给节点j时,节点i的Page9任意“干扰邻居”(包括节点j本身)若刚好在j的通信范围内,且有数据包需要发送,则会造成节点j的数据接收失败.设pc为独立的随机变量,用于表明MAC层平均冲突概率.故可以推出:pc=1-1-2L/W其中,G为IWS协议中组大小;1>0,且为不依赖于n的常数.从式(10)可见,pc最后不依赖于具体的协议参数.设Si为数据包的处理/服务时间(即从数据包准备开始发送直到成功发送完毕),ai为发送次数,且由于数据到达发送模块时节点可能处于睡眠,则整个的处理时间为Si=ai·犛i/PA.下面将分别计算E[ai]和E[犛i].本文将采用“Random-look”原则[37],在稳定状态时,节点周围的唤醒“干扰邻居”节点数在整个处理时间内不变.则数据包第1次发送成功的概率为1-pc;第2次成功的概率为pc(1-pc);依次类推,可以得到P(ai=k)=(pc)k-1(1-pc),k>0,故有理时间的一阶矩、二阶矩,则烄E[ai]=∑烅E[a2i]=∑烆引理3.设珚Si、珚S2i分别表示节点i的数据包处珚Si=E[犛i]其中E[犛i]=(t-别不使用或使用ACK机制时.在Si=ai·犛i/PA两边同时取期望值,代入E[ai]或E[a2i]即可得.设某节点i数据包处理时间的SCV为c2Bi=σ2Si/珚Si=pc.根据式(4)可知,c2c2数据包的到达时间间隔的SCV为然后,根据式(6),代入c2延时为定理1.异步通信下的平均的端到端的传输D(n)async=1-exp-其中,ρ=λi珚Si=λPA珚Si证明.设珡Di表示在节点i的平均延时,根据Little定理[38],珡Di=珡Ki/λi=ρi每个节点的平均延时相同,因此,总延时为D(n)async=(珡Di·珔h).T(n)=OW定理2.异步通信下的网络吞吐量T(n)为证明.为使数据包的传输延时不趋向于,排队论有ρi=λi珚Si=λPA珚Si采样率λasync为λasync=p(n)exp-(n-1)(A(n))根据吞吐量的定义,如果从一个较长的时间段t<而言,按照输入输出对称性,发送到目的地的数据量与采样数据量相等.由于节点睡眠状态不采集数据,则有T(n)=λasync·PA=p(n)exp(-(n-1)(A(n))2)PA取Gupta-Kumar模型相同的条件,保持网络连通时,平均跳数为珔h=n/log槡n,根据式(9)可知p(n)=logn/槡n,且A(n)=πlogn/n,代入T(n)可得T(n)=OW与Gupta-Kumar模型的吞吐量公式相比,式(12)不仅仅体现了T(n)与节点数目/密度的关系,还体现了PA的影响.同时体现了发送距离对网络吞吐量的影响:发送半径越大,A(n)越大,吞吐量越小.这是因为发送半径越大,干扰可能性越大,冲突概率越高,导致网络吞吐量下降.网络能耗网络能耗是传感器网络关注的重要因素.本文Page10通过单字节传输能耗ECT(EnergyConsumptionpersuccessfulTransmissionforadatabyte)来评价网络能耗,并忽略无数据包时的睡眠能耗.异步通信中,能耗主要来源于发送节点与其周围的邻居节点,“侦听”能耗很少.除去需要对数据包进行接收的节点,周围的其它邻居节点(如睡眠状态中)同样可以通过SOLAR模块接收到数据包,并消耗能量.由于节点i的平均邻居数量为(n-1)A(n),且在一个数据包发送过程中,周围的各个邻居节点处于睡眠状态的平均时间为L(1-PA)/W.定理3.设Ptx,Prx,Plis分别表示发送/接收/侦听功率,数据包长度为L,则异步通信的ECT为ECTasync=(W·Wt-1证明.发送一个长度为L字节的数据包的能耗为PtxL/W,侦听能耗为t-到数据包所消耗的能耗为(L(n-1)A(n)(1-PA)Prx)/W,平均传输的跳数为珔h=1/p(n),每跳平均发送次数为1/(1-pc),故有ECTasync[=t-代入其它参数,即可得到ECTasync.证毕.5.2传统通信建模与分析而传统通信模式中,以S-MAC、T-MAC为代表的MAC协议采用协同的周期性唤醒/睡眠,从而进行同步通信.为与异步通信区别,设传统同步通信中数据包长为L^=L+Lsync/r,其中Lsync表示同步包SYNC长度,r表示发送SYNC的频率.故发送一个数据包的时间为L^/W+T0,T0表示用于RTS/CTS及ACK发送的时间,可以忽略不计.由于同步传感器网络通信范围比异步要大,用p^(n)、A^(n)分别表示吸收概率和通信范围面积.设Yi为节点i的“干扰邻居”数目,则有E[Yi]=4(n-1)A^(n),E[Y2i]=4(n-1)A^(n)(1+4(n-2)A^(n)).设犢i为节点i周围处于唤醒状态且有数据包需要发送的“干扰邻居”的数目,则有E[犢i]=4ρ(n-1)PAA^(n),E[犢2i]=4(n-1)A^(n)[ρ2P2A4(n-2)A^(n)+ρPA].对同步MAC协议而言,在成功发送数据的过程中,信道冲突会引起数据重传.每一次数据传输包括3个部分:(1)计时器退避时间,该计时器为均值为1/ε的指数分布;(2)计时器暂停时间间隔;(3)发送数据包时间.其中计时器退避时间由平均退避时间与计时器暂停次数决定.在信道侦听过程中,若节点通过RTS/CTS发现“干扰邻居”在进行通信,则暂停该计时器,且每次暂停的时间为L^/W.当退避计时器中止时,节点将发送数据包,而其它“干扰邻居”节点将暂停计时器,暂时转入睡眠状态直到数据发送完毕,当数据包发送完后,计时器继续计时.设犜i表示稳定状态时,节点i一次数据包传输的时间,则有犜i=t+ZiL^/W+L^/W.设Ti为整个数据包的服务时间,a^i为平均发送次数.因此有Ti=a^i犜i/PA.设p^c为冲突概率,并假设重发次数不限,则有当节点i发送数据包给节点j时,节点i的任意“干扰邻居”(包括节点j本身)若刚好在j的通信范围内,且有数据包需要发送,则会造成节点j的数据接收失败.由于节点同步唤醒,假设节点计时器的平均退避时间窗口大小为CW,节点选择同一个时槽的概率为1/CW,则冲突概率为p^c=1-(1-1由于A^(n)>A(n),故异步网络下的冲突概率要低.引理4.设Zi表示稳定状态时,在一次数据包发送过程中节点i计时器暂停的次数,则有定理4.同步通信模式的平均延时为D(n)sync=1-exp-其中,c2E[T2i]和E[Ti]2可由犜i和Ti共同求出.定理5.同步通信模式的网络吞吐量T^(n)为Page11T^(n)=p^(n)exp(-(n-1)(A^(n))2)其中,A^(n)=πlogn/n.定理5表明分析的吞吐量与Gupta-Kumar模型的结果是一致的,从而验证了通用排队网络模型的正确性.定理6.设Ptx,Prx,Psleep,Plis分别表示发送、接收、睡眠、和空闲侦听功率,则同步通信的ECT为ECTsync=1WPlis烄ε+L^(Ptx+Prx)+L⌒E[犢i]Plis+L^E[犢i]Psleep.烆其中,L⌒表示MAC报头和RTS或前导码的平均长度.6性能比较与验证6.1实验场景及参数设传感器网络随机部署在单位面积的圆形区域内,异步与同步实验时节点数相同,而同步环境下的通信范围比异步要大,故异步环境下源节点至目的节点的平均传输跳数要稍长,珔h>珔h,则p(n)<p^(n).使用与Gupta-Kumar模型相同的条件,保持网络均连通时,异步环境下的平均跳数为珔h=n/log槡n,同步环境下为珔h=珔h/(A^(n)/A(n槡)).本文基于OMNet++平台[39],开发异步通信模拟系统,主要模拟异步协议及随机网络拓扑,从源节点发送数据包到随机的目的节点,统计各个数据包的平均值,包括平均延时、能耗等,每次实验重复10次,以最后的平均值为实验结果.所设定的具体实验参数如表1所示,其中S-MAC协议参数参照文献[10],其占空比(duty-cycle)为1%~10%;数据参数说明PtxPrx&Plis25mWACK包长度2BytePrx(SOLAR)0.5mWA(n)0.01Plis(SOLAR&CPU)15mWA^(n)0.02Psleep0.05mW1/ε0.003st-lis(SOLAR)0.005s采样频率λ变量区域面积S1Tc包长度为36Byte;ACK长度为2Byte;overhead的平均长度为8Byte;其中节点能耗、速率等性能参数以Mica2节点作为参照,如传输速率为20Kbps,以接近SOLAR模块的性能参数.所有参数设置的前提是要保证节点的利用率ρ<1.6.2传输延时图6(a)显示了节点数n=1~2000时,采样频率λ=1/120packets/s)时的延时比较.当没有采用异步ACK机制,总体上异步MAC机制的延时比同步的要长.但是当节点数超过约1500时,同步MAC的延时比异步要增长的更快,其主要原因是节点密度过大时,由于同步的通信范围要大,导致冲突概率增大,此时过多的重发次数使得传输延时迅速增加.同时,当唤醒概率越小时,数据包积压越多,延时越大,如图所示,PA=0.01比PA=0.03的传输延时要大.图6(b)显示了PA=0.01,采用异步ACK机制时,与同步机制的比较.可见使用异步ACK机制时,由于只有等到下一次唤醒方可进行重传,异步的传输延时增长速度比较快.图6传输延时比较(Async/Sync表示异步/同步通信)6.3网络吞吐量根据定理2和5,图7(a)描述了不同唤醒概率时的网络最大吞吐量比较.可以发现当节点数增加到一定程度时,异步通信的吞吐量要大于同步通信,Page12主要有两个原因:一是由于同步通信的通信半径比较大,则更容易导致通信干扰增多,因此吞吐量下降更快;二是异步通信的主要特点是可以在睡眠时接收数据,这使得网络可以容纳更多的数据量,故吞吐量更大.这意味着从一个比较长的时间段来看,异步通信的接收率比同步通信要高.图7(a)同时表明唤醒概率较高时,网络的吞吐量越高.图7(b)进一步描述了n=1000时,唤醒概率对吞吐量的影响.可见,当PA增大时,异步通信的吞吐量成线性增长,比同步通信要大许多.其中,异步通信采用ACK机制时的网络吞吐量比不用时要稍低,主要是因为传输时间延长导致.6.4传输能耗能量有效性与降低网络通信能耗是异步通信的主要目标之一.根据定理3和6,图8(a)比较了PA=0.01时,n=10~2000时,ECT随节点数增长时的变化.可见,同步网络中的ECT明显比异步通信要大,约为2~3倍左右,且随n增长其增长速度比异步要快.图8(b)进一步显示了当节点数量达到n=5000时,采样频率不同时,ECT的变化情况.由于网络规模进一步加大,当n>3000时,ECTsync/ECTasync已经超过4~5.当采样频率越高时,网络流量加大,参与信道竞争的节点增多时,故ECTsync/ECTasync还有所提高.实际中,同步通信中节点在退避或接收RTS数据包前,还需要侦听信道状态,将消耗更多的能量.6.5综合性能比较与验证图9(a)显示了当PA=0.01时,λ=1/120,n=100~3000时的综合性能,即能耗与延时的乘积:ECT×Delay.可见,网络规模比较小时,异步通信的开销与同步通信相差不多,而随着网络规模大于1500个节点时,异步通信的总开销要比同步通信约低3~5倍.虽然在传输延时方面性能不如同步,但是异步在总的开销上要远比同步通信低.图9(b)则显示了采用异步ACK机制时的综合性能对比.异步机制此时的总的开销比同步要高,主要原因是异步ACK机制导致延时迅速增加,ACK机制对传输能耗的影响很小,基本可以忽略.虽然如此,但当网络规模比较大时,n=3000时,同步通信的总开销基本赶上异步.同时,为了对分析结果进行验证,实验模拟随机的网络拓扑.同步通信模拟S-MAC协议,忽略其自适应侦听和长数据包等机制.异步模拟IWS机制,且组大小G=1~5.基本保持节点的唤醒概率为PA=0.01,在同样的条件下进行实验,最后的模拟平均值如以下两个图中所描述.由图9(a)可见,模Page13拟结果比分析值均要高出3%左右,这是因为ECT没有考虑节点睡眠状态的能耗及多余的信道侦听能耗.另外,采用异步ACK机制时,节点需要重发数据包,网络流量会比分析值要大,从而导致网络总开销偏大,因此,图9(b)中的模拟结果也比分析值要大.但模拟结果总的趋势与理论分析值基本保持一致.7结论与展望本文提出了一种适合传感器网络的异步通信机制,针对其特性设计了相应的MAC协议,并进行了建模分析与模拟实验.理论分析与实验结果表明,异步通信机制ACM能很大程度上提供网络吞吐量、延长网络生命周期.ACM对于资源有限、链路动态性比较强的传感器网络而言,是一个重要的发展方向,其中还存在许多新的研究课题,下一步的工作将主要集中在异步模块编码及MAC协议优化方面.
