Page1进化算法首达时间分析的停时理论模型1)(广东财经大学数学与统计学院广州510320)2)(南京大学计算机软件新技术国家重点实验室南京210093)3)(广东工业大学计算机学院广州510006)4)(华南理工大学软件学院广州510006)5)(广东技术师范学院计算机科学学院广州510665)摘要计算时间分析是进化算法理论基础研究中的重要课题,也是一大难点.该文基于停时理论,结合时齐马氏过程的性质,将进化算法的首达时间视为停时,提出了分析进化算法首达时间的一个新方法.在此框架下,Level-reachingEstimationTechnique作为特例得到了严格的证明.为展示如何用该理论方法分析具体问题,以(1+λ)EA求解PEAK函数和(1+λ)ES求解倾斜平面问题为实例,分析了平均首达时间.结果表明,该文所提出的方法不但适用于离散优化问题也适用于连续优化问题,具有通用性.关键词进化算法;计算时间;停时;时齐马氏过程;首达时间1引言进化算法(EvolutionaryAlgorithms,EAs)主要包括遗传算法(GeneticAlgorithm,GA)、进化规划(EvolutionaryProgramming,EP)、进化策略(EvolutionStrategy,ES),是受自然进化过程启发而产生的一大类随机启发式算法.遗传算法主要用于求解离散搜索空间的组合优化问题,而进化规划和进化策略则主要针对求解连续优化问题.随着研究的深入,三者有互相融合的趋势.当前,进化算法取得了丰硕的应用成果,主要集中在算法的改进和应用上,大多数是实证研究,相对来说,对于进化算法的运行理论机理研究比较少,这主要归结于进化算法运行的随机性本质.进化算法的理论基础研究有助于回答进化算法“为何有效”及“何时有效”的本质性问题,揭示算法的动态行为,从而对参数的选择和算法的应用具有指导作用.计算时间分析是进化算法理论基础研究中的一大难点和热点[1],近年来受到国内外相关学者的关注.进化算法的计算时间,简而言之是指算法找到最优解或满意解所需的迭代次数,亦称运行时间(runtime),是衡量算法优劣的重要指标.为了便于分析,很多研究都是针对(1+1)EA展开的.尽管(1+1)EA是一种简单的进化算法,但其依然有理论研究的价值,是进化算法计算时间分析的一个基本模型.通过深入研究(1+1)EA,可以揭示进化算法的动态行为,为分析更复杂的算法提供有用的工具.(1+1)EA的个体通常为二进制位串,但也有不采用二进制位串的变体[2-3],种群规模为1,在每一步迭代中父代个体通过变异产生子代个体,然后选择二者中较优的个体作为下一步迭代的父代个体.Droste等人[4]通过分析(1+1)EA在诸如OneMax函数、LeadingOnes函数、BinVal函数等伪布尔函数(即f:{0,1}n→R)上的计算时间,证明了(1+1)EA求解线性伪布尔函数的平均运行时间为Θ(nlnn);他们还构造了一个单峰函数的实例,证明(1+1)EA在其上的计算时间复杂度为指数式,推翻了一些学者之前的猜想.该论文得到的结果以及提出的数学工具和分析方法都极具启发性.Wegener[5]总结了分析(1+1)EA求解伪布尔函数的时间复杂度的常用数学工具和方法.近年来,对(1+1)EA的计算时间分析开始从伪布尔函数推广到具有现实背景的组合优化问题.Oliveto等人[6]针对顶点覆盖问题(VertexCoverProblems)分析了(1+1)EA在其上的表现,证明对于图中每个节点的度不大于2的实例,(1+1)EA能够有效地找到最小覆盖.计算唯一输入输出序列(UniqueInputOutputsequences,UIO)是有限状态机一致性测试中的一个基本且困难的问题,Lehre和Yao[2]挑选了此类问题的几个实例,分析了(1+1)EA的时间复杂性.Zhang等人[3]分析了(1+1)EA求解一个TSP实例和指派问题实例的计算时间复杂度.Borisovsky和Eremeev[7]以(1+1)EA作为基准算法,讨论(1+1)EA在何种条件下优于其他的EAs.针对一般进化算法的首达时间(FirstHittingTime,FHT)分析,He和Yao[8-9]提出了一个基于马尔可夫过程的通用框架,这涉及到复杂的矩阵计算.Jansen等人[10]通过分析(1+λ)EA在OneMax和LeadingOnes等函数上的首达时间,初步探讨了子代种群规模大小对进化算法性能的影响.Yu和Zhou[11]结合吸收态马尔可夫链与收敛速率,提出了一个估计平均首达时间的新方法.黄翰、郝志峰等人[12-13]运用吸收态马尔可夫链模型分析了蚁群算法和进化规划的计算时间复杂度.Jgersküpper[14]把马尔可夫链和Driftanalysis[15]结合起来,重新分析了(1+1)EA在线性函数上的运行时间上界,得到较精确的估计值.这些研究成果表明,充分利用进化算法的马尔可夫性是分析进化算法计算时间的一条可行之路.除马尔可夫链之外,Driftanalysis[15-16]也是一个强大的数学工具,其思想直观,有望成为进化算法计算时间分析的通用工具.但是实际应用中定理条件较难验证.Oliveto和Witt[17]对Driftanalysis进行了简化,得到一个更易于验证的Drift定理,计算了(1+1)EA在几个伪布尔函数和最大匹配问题实例上的运行时间下界.Chen等人[18]对基于种群的EAs在单峰函数上的时间复杂度展开了分析.他们通过将takeovertime概念和Driftanalysis方法相结合,提出了一个新的分析方法.他们选择两个单峰函数(OneMax和LeadingOnes)为实例,分析了不带交叉算子的(N+N)EA的平均首达时间上界,并讨论了将此方法推广到处理更复杂问题的可能性.当前的进化算法计算时间分析主要集中在离散搜索空间的情形,连续型进化算法如进化规划和进化策略的计算时间分析成果目前相对较少.Page3Jgersküpper[19-20]对基本的进化策略———(1+1)ES在连续优化中的运行时间进行了研究,其分析过程比较冗长.黄翰等人[13]运用吸收态马尔可夫链模型,建立了进化规划算法时间复杂度分析的一般框架,并以Gauss变异进化规划算法为例,分析了期望收敛时间.Agapie等人[21]引入更新过程理论,分析了带均匀变异算子的(1+1)ES在倾斜平面(inclinedplane)问题上的计算时间,取得了比较精确的结果.需要指出的是,按更新过程{N(t),t0}的定义,N(t)=sup{n:Snt},S0=0,Sn=∑{Xk,k1}是独立同分布的非负随机变量.为了能引用更新过程的有关结论,需假设(1+1)ES在倾斜平面上的每一步位移独立同分布.这是很强的假设,甚至比马尔可夫性要求还高,现实中只有少数情况才可能满足,所以该分析方法的适用范围受到很大的局限.受已有的理论分析方法如Driftanalysis、马尔可夫过程模型、更新过程模型等的思想的启发,本文引入停时(stoppingtime)理论作为工具,把进化算法的FHT视作停时,利用时齐马氏过程的性质,提出了分析进化算法平均首达时间(ExpectedFirstHittingTime,EFHT)的通用方法.与文献[21]所用的更新过程模型的不同之处在于,本文所提方法无需对进化算法的一步位移作独立同分布的假设,即可得到更具一般性的结果.Level-reachingEstimationTechnique是离散型进化算法时间复杂度分析中常用的工具[1,3-5,22],本文的分析表明它是我们所提出的定理的一个特例.最后,用所提出的方法对两个具体实例作了分析:(1)(1+λ)EA优化PEAK函数;(2)(1+λ)ES求解倾斜平面问题.前者是离散型优化,后者是连续型优化,算法的子代种群规模都大于1,更贴近实际.2进化算法与停时2.1进化算法的随机过程模型不失一般性,本文讨论的最优化问题可描述为:设可行解空间(搜索空间)为非空集合S,R表示实数集,f:S→R为目标函数,欲搜索到至少1个全局极大值点x∈S,使得fmax=f(x)=max进化算法的求解流程大致可用以下的框架统一描述[23].算法1.进化算法.输入:初始种群p(0)输出:包含全局最优解的种群p(t)1.初始化,生成初始种群p(0)={x0t=0;2.计算p(t)中每一个个体的适应值以评价当前种群的优劣;3.用进化算子生成新一代种群p(t+1),令t=t+1;4.若终止条件满足,则停止;否则回到步2.常用的进化算子主要有3种:交叉、变异、选择.在求解实际问题时,遗传算法一般采用全部3种进化算子,而进化规划和进化策略只采用后面两种.本文考察的进化算法采用(μ+λ)选择机制,即每次迭代时,由μ个父代个体生成λ个子代个体,然后将这μ+λ个个体按适应值从大到小排列,选择排在前面的μ个个体作为下一步迭代的父代个体.进化算法中,搜索空间S的元素x称为一个个体或解,可直接选取目标函数f:S→R作为个体的适应值函数.若干个个体组成一个种群,一个规模为N的种群可以表示为X={x1,x2,…,xN},xi∈S,i=1,2,…,N.种群空间由全体可能的种群构成,记为E={X={x1,x2,…,xN}|xi∈S,i=1,2,…,N}.针对本文所考察的最大化优化问题,定义Sopt={x∈S|f(x)=max空间,最优种群空间则定义为Eopt={X={x1,x2,…,xN}|xi∈X,i=1,2,…,N,使得f(xi)=fmax}.设Xk={xk法的第k代种群,则{Xk,k=0,1,…}是一个在状态空间E上取值的随机过程.进一步的,由于第k+1代种群Xk+1的状态仅依赖于第k代种群Xk而不受之前种群的影响,且本文考察的进化算法不采用自适应变异机制,因此随机过程{Xk,k=0,1,…}可视为时齐马尔可夫过程[9,15,24].为衡量某个种群与最优种群空间的距离,我们引入下列的定义.定义1.最优个体序列.令ξk为第k代种群Xk的一个个体,即ξk∈Xk,k=0,1,….若f(ξk)=max{f(xk0,1,…}称为进化算法的最优个体序列.设Sobj表示搜索空间S中的某一特定区域,不妨称之为目标区域,距离函数的定义如下.定义2.个体距离函数.令SobjS为目标区域,对于定义在搜索空间S的函数d:S→R+,若其满足:Page4(1)d(x)=0x∈Sobj;(2)对于x,y∈S\Sobj,有d(x)=d(y)f(x)=f(y);(3)对于x,y∈S\Sobj,有d(x)<d(y)f(x)>f(y).则将d:S→R+称为个体到目标区域的距离函数.特别的,若Sobj=Sopt,则d简称为距离函数.定义2所提的距离函数是存在的,如可令d(x)=fmax-f(x),x∈S,即为满足定义2的一种距离函数.对于种群X={x1,x2,…,xN},xi∈S,i=1,2,…,N,把V(X)=d(珟x)称为种群X的距离函数,其中珟x∈X满足f(珟x)=max其中最优个体的距离来定义.当进化算法使用(μ+λ)选择机制的精英选择策略时,显然V(Xk)=d(ξk),k=0,1,…是一个单调不增的序列.d(ξk)越小,表明种群与最优种群空间的距离越小,即越趋近于最优解,当d(ξk)=0时,则说明算法已经求得最优解.在连续优化中要求d(ξk)=0并不现实,有鉴于此,我们引入ε-FHT的定义.定义3.ε-FHT.假定随机过程{ξk,k=0,1,…}为进化算法的某个最优个体序列,实数ε>0,定义τε=min{k0;d(ξk)<ε}为进化算法的ε-FHT.ε-FHT刻画了在进化过程中种群与最优种群空间的距离首次小于ε时,算法所需要迭代的次数.接下来,本文将采用停时理论为工具,研究进化算法的ε-FHT.2.2停时理论简介停时作为随机过程理论中的一个重要概念,从直观上来讲是一个随机时间.其严格定义如下[25].定义4.停时.设T为非负整值随机变量,{Yn,n0}为一随机序列,令若对n0,有{T=n}∈n,则称T是{Yn,n0}的停时.在上述定义中,称Y1,…,Yn)为由随机变量序列Y0,Y1,…,Yn生成的事件σ域,它代表由Y0,Y1,…,Yn生成的全部事件信息.显然,有时不太方便,为此,我们推出如下的等价定义.推论1.随机变量T是{Yn,n0}的停时,当且仅当对n0,有{Tn}∈n.证明.充分性.若对n0,有{Tn}∈n,因为{T=n}={Tn}\{Tn-1},已知{Tn}∈n,{Tn-1}∈n-1n,由{Tn-1}∈n,即T是{Yn,n0}的停时.必要性.若T是{Yn,n0}的停时,即n0,{T=n}∈n,此时{Tn}=∪k}∈kn,由于进化算法首次找到满意解的时间仅仅与当前以及过去的搜索结果有关,故有以下引理.引理1.进化算法的ε-FHT是种群序列{Xk,k=0,1,…}的停时.证明.由定义3,对n0,{τε=n}={d(ξk)ε,k=0,…,n-1,d(ξn)<ε}=∩{d(ξn)<ε}∈σ(Xk;0kn).根据定义4,结论得证.3进化算法的平均首达时间分析对表达式作一番转换.令ηt=d(ξt-1)-d(ξt),t=1,2,…代表迭代过程中进化算法的种群从第t-1步到第t步的一步位移,此时d(ξk)<εd(ξ0)-d(ξk)>d(ξ0)-ε即τε=min{k0;d(ξk)<ε}d(ξ0)-}ε,此处约定∑下文中的IA代表事件A的示性函数,IA=1当且仅当A发生,否则IA=0.现在我们给出本文的主要定理,考虑到进化算法的首达时间与初始种群的状态有关,为了更精细地刻画首达时间与初始种群的关系,定理1给出了定理1.设{Xk,k=0,1,…}为进化算法的种群序列,{ξk,k=0,1,…}为对应的最优个体序列.当dξ()0>0时,若存在两个关于X0的函数α(X0),β(X0),使0<α(X0)η1|X(意的ε>0有Page5证明.因为∑根据Levi单调收敛定理得记n=σXi;0i上式=∑根据引理1,τε是{Xk,k=0,1,…}的停时,再由推论1可知{τεk}={τεk-1}c∈k-1,即I{τεk}关于k-1可测,故上式=∑因为{Xk,k=0,1,…}是一个时齐马氏过程,故当τεk时,(η1|X0),从而α(X0)∑k=1[α(X0)I{τεk}|X0]∑∑k=1注意到α(X0),β(X0)是关于X0的函数,马上得到α(X0)∑而∑k=1显然d(ξ0)-ε<∑X0的函数,故最后得到结论估算种群的一步平均位移应用的关键,作为条件数学期望,它是关于X0的一个函数.为使计算更为简便,可选择常数作为的上下界,但这有可能使得下界过小、上界过大,从而导致对理1采用两个关于X0的函数α(X0),β(X0)作为(η1|X0)的下上界,有助于更精细地估计的上下界.推论2综合考虑初始种群的各种状态,可以得到无条件数学期望推论2.若定理1的条件满足,则有特别地,当α(X0),β(X0)分别为两个常数Clow,Cup时,有d(ξ0[证明.由Level-reachingEstimationTechnique亦称MethodofFitness-BasedPartitions,该方法主要用于分析采用精英选择策略的种群规模为1的进化算法,是一个简单而实用的数学工具.该方法首先按照适应值函数的取值对搜索空间作适当的分割,然后估计个体从当前区域跳到更优区域的概率下界,从而估算出算法最终找到最优解的计算时间.该方法原有的理论证明[5,26]参考了几何分布的性质,直观但不够严格.通过构造适当的距离函数,在本文所建立的理论框架下,该方法实际是定理1的直接推论,可得到严格的证明.定义5.基于f的分割.设f:S→R是待极大化的目标函数,S是非空有限集.把f全部可能取到的值按升序排列f0<f1<…<fM=fmax.令Ai={x∈S|f(x)=fi},i=0,1,…,M,则称{A0,A1,…,AM}是基于f的分割.对于采用精英选择策略的种群规模为1的进化算法,最优个体序列{ξk,k=0,1,…}即为种群序列.Level-reachingEstimationTechnique的严格证明如下.推论3.设{A0,A1,…,AM}是一个基于f的分割,记s(a)=a∈Ai},t=0,1,…;i=0,1,…,M-1.令si=min{s(a)|a∈Ai},τ=min{k0;ξk∈Sopt},则可得证明.考察算法的搜索过程,不妨记τi=min{k1;ξk∈Ai+1∪…∪AM,ξ0∈Ai}为个体从进入Ai,i=0,1,…,M-1直到离开为止的逗留时间.显然τ∑Page6取i=0,1,…,M-1.在这里Sobj=Ai+1∪…∪AM,令d(x)=1,x∈Ai烄烅0,x∈Ai+1∪…∪A烆条件可得η1|X(根据推论2,得[τ][∑精确地估计一步转移概率的下界si,i=0,1,…,M-1是应用推论3的关键.4实例分析4.1(1+λ)EA求解PEAK函数PEAK函数只在一处取得最大值,其他的位串则具有相同的适应值,从而形成一个适应值平台,因此也被称为“大海捞针”(Needle-in-the-haystack)函数.由于进化算法的搜索过程受适应值引导,因此从直观上看,算法很难逃离该平台.针对只接受具有更高适应值的个体的(1+1)EA,Droste等人[4]分析了其在PEAK函数上的EFHT,得到了Ωn()2(时,算法的性能有否提升是一个值得探讨的问题.本小节将运用定理1分析(1+λ)EA求解PEAK函数的平均首达时间下界.待研究的目标函数是PEAK(狓)=∏显然,该函数在(1,1,…,1)处取到最大值1,而在其他地方的取值都为0.为方便作比较,本小节所讨论的(1+λ)EA仅仅接受适应值较大的个体作为下一次迭代的父代个体,算法流程如下所示.算法2.(1+λ)EA.输入:初始个体输出:最优个体1.初始化,随机生成1个个体狓=(x1,x2,…,xn)∈0,{}1n;2.通过变异产生λ个中间个体狔1,狔2,…,狔λ;3.若m=maxf狔()1,f狔()2,…,f狔(){则从狔i|1iλ且f狔()i=保留狓;4.若满足终止条件,则停止,否则回到步2.步2采用逐位翻转(bit-wiseflip)变异:对于父代个体狓=(x1,x2,…,xn)中的每一位xi,i=1,2,…,n,以1/n的概率独立翻转,产生一个中间个体狔=(y1,y2,…,yn),此时代个体狓作λ次重复变异操作,共产生λ个独立的中间个体.记{ξk,k=0,1,…}为(1+λ)EA的个体序列,τ=mink0;ξk=(1,1,…,1上的首达时间.定理2.(1+λ)EA在PEAK函数上的平均首达时间是证明.首先给出距离函数的定义,令ξ为算法产生的任一个个体,定义d()ξ=令ηt=d(ξt-1)-d(ξt),t=1,2,…,下面估计η1|ξ(体通过λ次独立变异,总共产生λ个中间个体,于是η1ξ(根据伯努利不等式:对任意整数n0,和任意实数x>-1,有1+()xn1+nx成立,于是η1ξ(记βξ()0=λ再根据推论2得[τ]==∑狓≠(1,1,…,1)∑==Page7=即因为(1+λ)EA在每次迭代时需要对λ个中间个体的适应值进行评估,所以在首次找到最优解前算法需要的适应值评估次数平均为λΩn()2(降低算法求解PEAK函数的计算复杂度.4.2(1+λ)ES求解倾斜平面问题倾斜平面(inclinedplane)问题是一个基本的连续优化问题,Agapie等人[21]引入更新过程理论,分析了带均匀分布变异算子的(1+1)ES在该问题上的平均运行时间.本小节应用定理1将他们的分析推广到带正态分布变异算子的(1+λ)ES.本节讨论的目标函数是二维倾斜平面(inclinedplane)[20]:f(x1,x2)=x1,(x1,x2)∈S=[0,a]×[-a,a],a>0.显然,max大值.(1+λ)ES的算法流程如算法3所示.算法3.(1+λ)ES.输入:初始个体输出:最优个体1.初始化,随机生成1个个体狓=(x1,x2,…,xn)∈Rn;2.通过变异产生λ个中间个体;3.从这1+λ个个体中选择1个最佳个体;4.若终止条件满足,则停止;否则回到步2.步2的变异算子采用标准正态分布:对于父代个体狓=(x1,x2,…,xn)中的每个分量xi,i=1,2,…,n,令yi=xi+zi,zi~N0,()1,z1,z2,…,zn相互独立,生成一个中间个体狔=(y1,y2,…,yn).对父代个体狓重复λ次变异操作,共独立产生λ个中间个体.由于本小节讨论的是二维连续优化问题,故可设ξt=xt个体.距离函数定义为d(ξt)=a-f(ξt)=a-xt则ηt=dξt()-1-dξ()t=xt法的个体在迭代过程中从第t-1步到第t步的位移.令τε=mink0;d(ξk)<a-ε},则τε为(1+λ)ES在倾斜平面问题上的ε-FHT.下面的引理描述了ηt引理2.ηtF(x)=F(x)=证明.记xt个分量,珟xt后产生的λ个中间个体的第1个分量,则珟xtzk,zk~N0,()1,k=1,2,…,λ且相互独立.于是第t+1代个体的第一个分量为xt+11=根据ηt由算法的搜索过程可知,每一次迭代时正态随机变量zk,k=1,2,…,λ都是独立产生的,故ηt1,2,…独立同分布,其分布函数F(x)=(1)当x<0时:F(x)=0;(2)当x=0时:F(x)=(3)当x>0时:F(x)=ηt{即F(x)=1,x(x0不妨假定算法在初始化时从原点出发,即ξ0=2=0,()0,此时有如下结论.)0定理3.带标准正态变异算子的(1+λ)ES求解倾斜平面问题的平均ε-FHT满足2槡π(a-ε)Page8证明.由式(4)可知,η1量zk,k=1,2,…,λ有关,故η1根据式(3)可得η1|ξ(∫而当x>0时,1λ()1λ∫由∫,可得12槡πλ()1假定算法从原点出发,此时dξ()0=a,根据定理1,立即得到2槡π(a-ε)需要指出的是本文的方法无需事先对ηt作独立同分布的假设,只是在分析这个具体实例时恰好可以证明ηt使得计算简化.而文献[21]的模型事先必须作ηtt=1,2,…独立同分布的假设,所分析的算法与实例又恰好满足这一假设.由此可见本文的方法比文献[21]的方法更具一般性.5结论由于进化算法的首达时间实质是一个随机停止时间,故引入停时来刻画是自然的想法.本文引入停时理论,通过构造合适的距离函数,运用时齐马氏过程的性质分析了平均首达时间、算法的一步平均位移、初始种群与最优种群空间的距离这三者的关系,得到了估计平均首达时间的一般方法.为展示这一方法的应用,我们选择分析更为复杂的(1+λ)EA和(1+λ)ES在两个问题实例上的计算时间,这与以往大部分的工作都是分析(1+1)EA、(1+1)ES不同,结果表明该方法适用于一般的进化算法.通过分析比较(1+λ)EA和(1+1)EA在PEAK函数上的平均首达时间,我们发现增大子代种群的规模无助于降低(1+λ)EA求解PEAK函数的计算复杂度.对于倾斜平面问题,文献[21]建立的更新过程模型要求对算法的一步位移作独立同分布的假设,这是很强的假设,在实际中能满足这一假设的情况很少,只是他们所分析的实例恰好满足这一假设.本文所建立的理论模型不需作这样的假设,从而更具通用性.Level-reachingEstimationTechnique是分析离散型进化算法计算时间的一个简单而又威力巨大的工具,得到广泛的应用,但原有的证明不够严谨,在本文中可以看出它只是我们所提出的理论模型的一个特例,从而得到了严格的证明.最后要指出的是,本文所建立的理论模型不仅适用于进化算法的计算时间分析,经过改进推广后也适用于ACO、PSO等仿生优化算法的计算时间分析.未来将要进一步研究:(1)改进本文的理论模型,将其推广到其他仿生算法的计算时间分析中;(2)分析进化算法在具有实际背景的组合优化问题上的计算时间;(3)分析种群规模大于1的进化算法,尤其是带交叉算子的遗传算法在一些优化问题实例上的计算时间.这些都将是极具挑战性的工作.
