Page1基于核方法的XML文档自动分类杨建武(北京大学计算机科学技术研究所北京100871)摘要支持向量机(SVM)方法通过核函数进行空间映射并构造最优分类超平面解决分类器的构造问题,该方法在文本自动分类应用中具有明显优势.XML文档是文本内容信息与结构信息的综合体,作为一种新的数据形式,成为当前的研究热点.文中以结构链接向量模型为基础,研究了基于支持向量机的XML文档自动分类方法,提出了适合XML文档分类的核函数及其参数的学习方法,从而将XML文档的结构分析与内容分析有机地结合起来.在INEX数据集上的测试结果表明,该方法的分类准确性明显高于INEX评测中所公布各方法的评测结果.关键词XML文档;文档分类;核函数;支持向量机;文档模型1引言由于具有结构化、可扩展性、跨平台性等特点,XML(eXtensibleMarkupLanguage)逐渐成为信息存储与交换的主要格式,XML文档数量随之迅速增长.XML方面的研究工作迅速展开,从最初的XML标准研究,发展到XML文档存储、检索与管理等多角度研究,而面向XML文档集的智能分析挖掘成为当前的研究热点.2002年,欧洲DELOS组织成立INEX①(Initi-ativefortheEvaluationofXMLretrieval)评测机Page2构,每年组织XML文档检索方面的评测,获得IEEE计算机学会的认可与支持.2005年底,首次举行XML文档挖掘评测“XMLDocumentMiningChallenge”①.XML文档是文本内容信息与结构信息的综合体,作为一种新的数据形式XML文档分析区别于传统的文本分析的关键在于结构信息与文本内容的综合利用.目前,XML方面的研究成果主要集中于XML标准、数据模型、存储、检索等方面,在面向XML文档集的文本挖掘方面的研究成果还相对很少.Yi等人提出了一种用于半结构化文档分类的扩展向量模型,它采用嵌套定义的向量来描述文档元素,并在此模型基础上利用概率统计方法进行文档分类[1];Zhang等人提出一种采用编辑距离进行XML文档结构相似度计算的方法[2];Denoyer等人研究了利用贝叶斯网络模型进行半结构化文档分类的方法[3];Kc等人研究了通过自组织映射技术进行XML文档自动聚类和分类的方法[4];Yong等人采用图形神经网络进行XML文档分类取得了较好的实验效果[5].支持向量机(SVM)[6]是公认的具有较好效果的文本自动分类方法之一[7].但是基于支持向量机的文本自动分类方法考虑的仅是文本内容信息,不涉及文本的结构信息.本文作者在文献[8]中对经典的文本向量空间模型[9]进行了扩展,提出了结构链接向量模型,综合描述了XML文档中的结构信息与内容信息.本文研究了采用支持向量机对XML文档进行自动分类的问题,提出了适合XML文档分类的核函数以及基于支持向量机回归学习进行核函数参数学习的方法.在INEX数据集上的测试结果表明,该方法具有很好的分类效果,分类准确性明显高于INEX评测中公布的各方法的评测结果.本文第2节简单介绍支持向量机及结构链接向量模型;第3节提出基于支持向量机的XML文档自动分类的基本方法;第4节讨论基于支持向量机回归学习进行核函数参数优化的方法;第5节给出本文方法在INEX数据集上的实验结果;最后一节对本文工作进行总结.2背景知识2.1支持向量机(SVM)支持向量机(SVM)[6]的基本思想是根据Vapnik提出的结构风险最小化原理,通过最大化分类间隔尽量提高学习机的泛化能力.对于线性可分情况,SVM给出一种用规划方法求解最大间隔的方法;对于线性不可分情况,SVM则利用核函数将原问题映射到高维空间,从而转化成线性可分的问题.考虑到求解最优分类面算法的性质,在高维空间中,只需进行内积运算即可.(xi,yi);i=1,2,…,n;狓∈Rd;y∈{+1,-1}满足对于线性可分样本集:下二次函数的寻优问题:yi[(w·xi)+b]-10;i=1,2,…,n.SVM训练的求解最优分类面问题可转换成如maxαQ(α)=∑n约束条件:∑n解该问题后得到最优分类函数:其中b是分类阈值.对于非线性问题,通过非线性变换转化为高维空间中的线性问题,在变换后的空间求最优分类面.设非线性映射为Φ:Rd→H.在特征空间H中构造最优超平面时,训练算法仅使用空间中的点积Φ(xi)×Φ(xj),而没有单独的Φ(xi)出现.因此,可通过核函数K,K(xi,xj)=Φ(xi)×Φ(xj),实现非线性变换后的线性分类,此时,训练函数为maxαQ(α)=∑n相应的分类函数为2.2向量空间模型(VSM)向量空间模型(VSM)[9]是一种常用的文档模型.它以词语为维度构造一个高维空间,每个词语为该空间的一个维,每个文档被看作该空间中的一个向量.其中n是文档集合中不同词语的个数.TFIDF[9]是VSM模型中一种常用的文档向量化方法,它综合考虑了词语在单个文档中出现的频度和该词语在文档集合中出现的频度.①http://xmlmining.lip6.fr/Page3其中,TF(wi,docx)是词wi在文档docx中出现的次数;IDF(wi)=log(|D|/DF(wi)),|D|是文档集合中文档总数,DF(wi)是包含词语wi的文档个数.IDF(wi)是词语wi全局特性,用来体现词语wi区分文档的能力.在VSM模型中,两个文档doc狓和doc狔之间的相似度通常采用相应的两个向量狓和狔的点积表示.sim(doc狓,doc狔)=狓·狔=∑n其中,狓和狔分别是文档doc狓和doc狔对应的向量,n是文档集合中不同词语的个数.2.3结构链接向量模型(SLVM)VSM模型能有效地描述文本内容,广泛应用于文本检索与文本挖掘之中.但是VSM模型不能描述文档中的结构信息.XML等半结构化文档中包含丰富的结构信息,结构信息在半结构化文档检索与分析中具有重要价值.为了能综合描述XML文档中的内容信息和结构信息,本文作者在文献[8]中对VSM模型进行了扩展,提出了结构链接向量模型(SLVM).SLVM模型的基本思想是根据结构单元中的内容,将XML文档中的每个结构单元看作一个向量,类似于VSM模型的一个文档,整个XML文档则被量化为一组向量,以一个矩阵来表示,从而达到将XML文档的结构分析与文本内容分析相结合的目的.SLVM模型中结构链接向量由3部分组成:结构向量、链出向量和链入向量.该模型中链出向量与链入向量是以链出目标资源和链入起始资源的结构向量进行表示的,为简化论述突出重点,本文仅考虑SLVM模型中的结构向量.具体来说,在SLVM模型中,文档doc狓被表示成一个矩阵狓∈Rn×m,矩阵的每列为一个结构单元对应一个n维向量:其中,m是XML文档中不同结构单元(如XML元素、XML结构树的结点路径)的个数,n是文档集合中不同词语的个数.x(i,j)的取值采用类似TFIDF的计算方法,综合考虑词语wi在文档doc狓的结构单元ej中出现的情况及该词的全局权重.其中,TF(wi,doc狓.ej)为词条wi在文档doc狓的结构单元ej中出现的频度.IDF(wi)=log(|D|/DF(wi)),|D|是文档集合中文档总数,DF(wi)是包含词语wi的文档个数.IDF(wi)是词语wi全局特性,用来体现词语wi区分文档的能力.3基于SVM的XML文档自动分类3.1XML文档的向量表示在SVM分类方法中,每个样本采用向量进行表示.向量空间模型(VSM)中,每个文档采用一个向量表示,可直接用于SVM进行训练与自动分类.而结构链接向量模型(SLVM),将每个XML采用一组向量表示,不能直接应用于SVM进行自动分类.为此,采用式(11)的形式,将SLVM模型中表示一个XML文档的一组向量(m个n维向量)转换成一个向量(m×n维).狓^=〈x(1,1),…,x(n,1),…,x(1,m),…,x(n,m)〉T该向量是按结构单元顺序将m个n维向量依次排列,组成一个新的m×n维向量,向量的每维分别对应一个结构单元中的一个词语.3.2核函数基于式(11)对XML文档集进行向量化后,如果把这些代表XML文档的向量样本集看作是线性可分的话,则SVM的训练函数和分类函数如式(1)和(2)所示.这种情况要求向量各维是互相独立的,XML文档中各结构单元之间无相关性.但是XML文档中各结构单元之间存在相关性,即SLVM模型所构造的特征空间并不是一个正交空间.举例来说,“计算机”这个词出现在A、B、C三个文档中:A、B文档的“标题”中和C文档的“摘要”中.直观地看,仅考虑“计算机”这个词的情况下,虽然“计算机”这个词出现在文档A和C的不同结构单元(元素)中,但它对A、C文档间的相似度有一定的贡献,但这种贡献要小于它对A、B文档间相似度的贡献.如本文2.1节中所述,对于非线性问题,可通过构造核函数进行空间映射来求解最优分类超平面.为此,本文提出函数(12)作为基于SVM的XML文档分类的核函数,通过该函数对XML文档中结构单元之间的关系进行建模描述.Page4K(xi,xj)=∑m其中,该公式的后半部分∑n是文档xi的结构单元ep和文档xj的结构单元eq在VSM模型中的相似度(参见式(7));相似度对两个文档间相似度的贡献函数.g(p,q)是描述两个文档结构单元ep和eq之间式(12)所描述的核函数可看作是在SLVM模型中计算两个XML文档之间的相似度,该相似度是由两文档中各结构单元之间相似度的加权累加之和.容易证明,式(12)的核函数满足Mercer条件.如果忽略不同结构单元之间相似度对文档间相似度的贡献,而仅考虑相同结构单元之间相似度对文档间相似度的贡献时,则函数g(p,q)将采用式(13)的形式,核函数退化为式(14)的形式,即简单的向量点积函数,分类问题退化为简单的线性可分问题.K(xi,xj)=∑m4核函数的学习获取XML文档中结构单元之间的关系是面向XML文档集的文本挖掘研究的基本课题之一,如Zhang等人在文献[2]中采用编辑距离进行XML文档结构相似度的计算.其基本思想是将文档结构抽象为一个树结构,不同结构单元之间的相似性是通过计算编辑距离获得.这种方法对某些文档相似度计算是有效的,但它是以一种固定的模式计算结构之间的关系,并不真正代表结构单元之间的语义关系,不能随着文档结构的组织形式的变化而变化.如果以不同的方式来组织相同的结构关系,则计算的结果也可能会有很大的差别,其适用性受到很大限制.通过学习的方法进行这种关系的训练学习可避免这种方法的限制.本文作者在文献[10]中提出了通过矩阵迭代的方法进行结构相关矩阵的学习,从而提高了XML文档的聚类效果.该方法虽然可用于有指导的学习,但基本思想是无指导的学习.本文采用基于支持向量机的XML文档结构单元相关性的学习方法,并用于核函数的计算.在式(12)中,函数g(p,q)描述是文档结构单元间的相关性,其两个自变量取值均为[1..m],m为结构单元的个数.为此,函数g(p,q)可用m×m维的矩阵犌来表示,并可进一步表示成一维向量的方式:犌^=〈G(1,1),…,G(m,1),…,G(1,m),…,G(m,m)〉T.此时,式(12)可表示成:K(xi,xj)=∑m其中,表示XML文档xi的第p个结构单元与文档xj的第q个结构单元中文本内容的相似度,可直接计算获得.从而式(12)描述的核函数K(xi,xj)可看作是关于犌的m×m维的向量.其中,犞=〈v(1,1),…,v(m,1),…,v(1,m),…,v(m,m)〉,v(p,q)=s(xi,p,xj,q)=∑n同时,核函数K(xi,xj)表示的是两个XML文档之间的相似度.对于XML文档集,两两文档作为一组,可获得式(17)所示的向量,且y(i,j)=K(xi,xj)从而,训练样本的XML文档集,两两构成一个向量,形成一组训练样本,采用SVM的回归学习方法则可求解并获得向量犌^,即矩阵犌,从而可获得函数g(p,q)的具体形式.进一步,根据犌^值的权重排序,可对取值小的项进行裁减,从而降低算法的计算量.针对大规模XML文档集,该裁减能明显提高计算速度.5实验5.1实验环境与数据集实验使用IntelP43.0GHzCPU,512MB内存Page5的个人计算机,在WindowsXPProfessional操作系统上以VisualC++6.0作为开发环境.实验选用INEX提供的XML文档实验数据集.该数据集含有12107篇XML文档,来源于IEEE的18种计算机类期刊杂志的文章.文档的总大小为494MB,包含192个不同的元素,平均每篇XML文档包含1532个结点项,平均结点深度为6.9.为进行文档分类评测,文档集根据文章内容被人工标注为18类别,6053个文档用于训练,6054个用于测试.5.2评价函数实验中,采用INEX提供的评价程序进行结果的评测.该评价程序是将自动分类的结果作为其输入、输出为分类结果的评价值MicroF1和MacroF1.其中,Ai为正确分到第i类的文档数;Bi为被分到第i类的总文档数;Ci为第i类实际包含的总文档数.F1(i)=2×precision(i)×recall(i)其中,m为类别总数,N为文档总数.5.3实验结果为方便对比,先将参加INEX评测的各方法的实验结果整理如表1所示.GraphNeuralNetwork0.7214400.713969ContextualSelf-OrganizingMapforStructuresDoucetPCXSSXing首先采用两个基本方法进行实验对比:(1)VSM法.仅考虑XML中的纯文本内容,不考虑其中的置标内容,并采用向量空间模型(VSM)进行文档向量化;(2)基本SLVM法.采用结构链接向量模型(SLVM)对XML文档进行向量化,并且不考虑结构单元之间的关系,即函数g(p,q)采用式(13)的形式,分别采取如下两种不同的方式选取结构单元:①基本SLVM法(元素).以XML文档的元素为基本结构单元,对于相同的元素,不论其出现在结构树的什么位置,将其内容都统一向量化到一个结构单元中;②基本SLVM法(路径).以XML文档的结构树的路径为基本结构单元,对结构树的不同路径分别进行向量化.实验结果如表2所示.基本SLVM法(元素)0.7687230.761243基本SLVM法(路径)0.7893380.780885实验表明,采用简单的VSM模型进行向量化的效果一般,略低于INEX评测中的GraphNeuralNetwork,但明显高于其它方法.而基本SLVM法高于INEX评测中公布的所有方法以及VSM法.同时,采用结构树路径为结构单元的方法要好于采用元素为结构单元的方法,因为相同的元素可能出现在结构树的不同位置,其实际意义会有所不同,例如:元素〈Name〉可分别作为元素〈Conference〉和元素〈Author〉的子元素.采用元素为结构单元的方法,不能区分这种情况,而采用结构树路径为结构单元的方法可对这一情况进行区分.各结构单元中的内容长短有明显差别,例如:正文中的内容通常有数千个词,向量化后占据的权重比例大,而标题等只有10个左右的词,所占总权重很小.为此,对结构单元的向量进行单位化,使得每个结构单元的向量长度都为1.即将式(8)变换成式(18)的形式.狓~(i)=〈x(1,i)/|x(i)|,x(2,i)/|x(i)|…x(n,i)/|x(i)|〉T单位化处理后,实验效果大幅改进,F1接近100%,实验中只有一个文档被错误分类.实验结果如表3所示.SLVM法(元素)0.9998350.999823SLVM法(路径)0.9998350.999823获得如此高准确性的原因在于XML文档中有两个元素(〈fno〉和〈doi〉)与文档的分类情况一一对应,进行结构单元单位化后,其重要性明显体现出来,SVM训练过程自动学习获得这一特性并体现在Page6分类模型中,分类过程中主要以这两个元素内容进行自动分类.元素剔除,实验结果如表4所示.为进一步试验方法的有效性,实验中将这两个SLVM法(元素,未单位化)0.7415100.733432SLVM法(路径,未单位化)0.7614170.750191SLVM法(元素,单位化)0.8826760.886292SLVM法(路径,单位化)0.9024040.901225实验结果表明,虽然剔除了两个对分类具有重要指示意义的元素,但分类效果仍好于INEX评测中公布的所有方法,特别是单位化后具有明显效果.实验进一步采用式(17),利用SVM的回归学习方法对核函数中的矩阵犌进行学习.由于回归学习的样本向量数为文档个数的平方(60532=36638809),全部采用的话,训练时间太长,也没有实际意义,为此,实验中随机选取其中10000个进行回归学习.实验结果如表5所示.SLVM法(元素,单位化)0.9230740.921920SLVM法(路径,单位化)0.9463910.942948实验表明,对矩阵犌进行回归学习可较明显提高分类的准确性.6结论本文研究了基于支持向量机的XML文档自动分类方法,提出了适合XML文档分类的核函数以及基于支持向量机回归学习的核函数参数训练方法,从而将XML文档的结构分析与内容分析有机地结合起来.在INEX数据集上的测试结果表明,该方法具有很好的分类效果,分类准确性明显高于INEX评测中公布的其它方法的评测结果.
