Page1基于特征权重量化的相似度计算方法1)(哈尔滨工业大学管理学院哈尔滨150001)2)(哈尔滨工业大学计算机科学与技术学院哈尔滨150001)摘要随着信息产业的迅猛发展,聚类的无监督特性使其成为一种极为有效的分析工具.而为获得良好的聚类结果,有效及准确的相似度计算方法是其必备的前提条件.事实上,在描述数据相似度时,不同的特征显然具有不同的作用,因此有必要借助一些先验知识,例如用户提供的限制数据,来衡量特征的重要性,并将其应用于相似度计算中以获取更加准确的计算结果.传统的特征权值量化方法均忽视了两点问题:(1)限制数据在特征空间中极有可能为非均匀分布;(2)限制数据可能包含不一致性.上述问题的存在使得传统的权值量化方法无法获得准确的结果甚至无法运行.基于此,文中提出了一种新颖的特征权值量化方法用以处理上述两点问题:(1)将限制数据划分为若干个等价类,进而通过计算参数“分布系数”来均匀化数据的分布;(2)将限制数据连接为无向图,进而通过计算参数“置信度”来衡量及弱化限制数据的不一致性.之后将这两个参数结合到特征权值量化函数中以获得准确的相似度计算结果.实验结果显示:该特征权值量化方法能够结合限制数据来获取不同特征对相似度计算的贡献能力,并能应用于任何聚类算法中以提高聚类的准确度.关键词限制数据;特征权重量化;分布系数;置信度1引言随着网络技术的迅猛发展,人们接触的信息量与日俱增,用户急需一种有效的信息分析工具以协助其日常工作.如文献[1]所述,聚类即是一种有效的信息分析工具,其通过凝聚相似数据能够缩小用户的查找范围并加快用户寻找相关信息的速度.聚类中最基本的要素就是数据间的相似度[2],有效的相似度度量函数显然能够帮助聚类算法获得良好的聚类结果.目前大多数聚类算法以向量空间模型组织数据,并通过计算不同数据间特征向量的夹角或距离来反映数据之间的相似度,例如欧式距离[3]、余弦相似度[4].此类相似度计算方法视所有特征对数据相似性的描述能力或对数据的划分能力是相同的[5].然而,现实中不同特征对数据的划分能力显然是不同的,因此有必要分析特征对相似度计算的贡献能力来为特征赋予不同的权值.传统的聚类技术是一种无监督的学习方法,在算法运行前不需要获取任何先验知识.然而,现实应用中,用户对于输入数据可能存在某些限制,而聚类结果显然要满足用户对于输入数据的限制.目前最常使用的限制信息是文献[6]中提及的must-link和can’t-link点对限制信息.如果用户指定输入数据中的任两个数据位于同一类别中,则说明这两个数据或点对满足must-link关系,而can’t-link关系正好相反.此类限制信息刚好可以结合到特征权值量化中去以获得更为准确的相似度计算结果.基于此,研究者们提出了多种特征权值量化方法[7-8].然而传统的基于限制数据的特征权值量化方法均无法处理以下两种情况:(1)用户指定的限制数据的数量通常远少于全部的输入数据,这使得限制数据经常是从整个特征空间中非均匀抽取的;(2)传统的特征权值量化方法认为用户提供的限制数据是准确无矛盾的,然而现实应用中用户提供的限制数据中某些满足must-link关系的数据对可能同时满足can’t-link关系①.当存在第1个问题时,非均匀分布的限制数据会使特征权值量化的结果出现“过适应”现象,即错误的将那些能够有效划分密集的限制数据的特征赋予较大的权值,而忽略了分布稀疏的限制数据对特征权值量化结果的影响.针对此问题,本文引入参数“分布系数”来平衡限制数据的分布,降低密集分布的限制数据对特征权值量化结果的影响,同时提高稀疏分布的限制数据的作用,以防止出现“过适应”现象,具体介绍参见文中第3节.当存在第2个问题时,传统的特征权值量化方法均无法对其进行处理.针对此问题,本文引入参数“置信度”来衡量限制数据的不一致性,并对不一致的限制数据赋予较小的权值来降低其在特征权值量化中的作用.具体介绍参见文中第4节.2基于限制数据的特征权值量化引入限制数据的聚类方法可分为两类:一类是在聚类算法的有效性函数或搜索策略中融合限制数据引入惩罚函数,如COP-K-means[9]和KCL[10],另一类是根据限制数据修改算法的相似度计算函数以使类别划分结果满足用户的要求.相比于第2类方法,第1类方法对算法的依赖性较大,针对不同的算法需要设计不同的优化函数或搜索策略,因此无法做到普适性.第2类方法通常以特征的重要性为依据,依据特征对数据分布的影响对特征赋予不同的权值,进而去修改相似度计算函数[11-12].依据此想法,即可从用户指定的限制数据中挖掘能够有效凝聚相似数据以及区分不同数据的特征,并增大其在相似度计算中的作用,以使聚类结果满足用户的要①关于传递特性的介绍参加文中第3节式(9).Page3求.由上述分析可见:这种结合限制数据进行特征权值量化的方式不依赖于特定的算法,其可以应用于任何聚类算法中以提高聚类的准确性.假设待聚类的数据集合为D,设D的势为n,则D中包含的可能点对数目为n(n-1)/2,设存放这些点对的集合为S.设集合MCS和NCS分别包含用户指定的满足must-link关系和can’t-link关系的点对,其中MCS∈S,NCS∈S.以(i,j)∈MCS代表点对(i,j)满足must-link关系,同理(i,j)∈NCS代表(i,j)满足can’t-link关系.设NDS为非限制数据集合,其包含了S中除MCS和NCS外的其他点对.本文以向量空间模型组织待聚类数据,并以式(1)计算输入数据之间的相似度,例如p与q.式(1)被许多文献索引用来作为衡量数据之间的相似度的依据[13-14],其中wk代表第k维特征在相似度计算中的重要性,wk∈[0,1].当wk=1时,所有特征的重要性相同,即为传统的欧式距离.式(1)的计算结果过于分散为[0,+),不利于进行权值量化,因此本文对式(1)进行改变从而得到更为灵活的相似度计算函数-ρρ均匀分布于0~1之间.(w)pq其中,参数β可由式(3)得到假设用户提供的限制数据是准确一致的①,那么显然位于MCS中的点对间的相似度应该较大,而位于NCS中的点对间的相似度应该较小.这样那些能够缩小MCS中点对间的相似度、而增大NCS中点对间的相似度的特征,对限制数据的划分能力较强,即上述特征在相似度计算中的作用应该较大,以此为依据即可得到下述的特征权值量化公式.当此公式达到最小值时对应的特征权值为最优的特征权值.FW=∑(i,j)∈MCS∑(k,l)∈NCS使用随机梯度下降算法优化特征的权值wk即可得权值更新幅度Δwk:(ρ=∑(i,j)∈MCS∑(k,l)∈NCS(w)kl×ρ(1-ρ其中,ρwkρwk将式(2)、式(5)和式(6)综合在一起即可得t+1时刻的特征权值:wk(t+1)=wk(t)-其中,以高斯函数控制梯度下降的步长,δ(t)为线性时间衰减函数,以使下降的步长逐渐减小[15].3分布系数式(4)~(7)仅考虑了限制数据在权值量化中的作用.事实上,用户提供的限制数据可能仅占全部数据的很少一部分,这样在按照式(4)进行权值量化时很可能会出现偏置现象,即特征对于限制数据过分表述,从而错误的描述了非限制数据间的相似关系,因此需要在权值量化中结合非限制数据.如文献[16]所述:按式(2)计算数据间的相似度时,对于相似度趋近于1的数据对,其相似性较小,基本上不可能位于同一类别中,而对于相似度趋近于0的数据对正好相反,对于相似度趋近于0.5的数据对,其对于数据的类别分布的描述最为模糊,基本上无法辨别出数据的类别归属.如果输入数据中存在大量这样的数据会严重降低聚类算法的性能.因此可以通过优化特征的权值以使相似度小于0.5的数据对其相似度趋近于0,而使相似度大于0.5的数据对其相似度趋于1,以提高数据的可分性从①关于一致性的叙述详见文中第4节.Page4而提高聚类结果的准确性.式(8)将非限制数据和限制数据结合在一起进行权值量化,其中μ为用户指定的参数,代表限制数据相对于非限制数据的重要程度.FW=(μ∑(i,j)∈MCS∑(k,l)∈NCS上述权值量化函数FW将数据分解为两部分:限制数据和非限制数据.但如前所述,用户指定的限制数据可能仅仅是全部数据的一个不均匀抽样,此时如果仍然对所有限制数据赋予同样的重要性,显然会在权值量化结果中引入误差,过分加大密集分布的限制数据在权值量化中的作用,从而忽略了分布稀疏的限制数据的影响.针对此问题,本文依据must-link关系将限制数据划分为多个等价类,然后据此计算“分布系数”以平衡限制数据的分布.如文献[6]所述:must-link关系满足自反、对称和传递特性,因此可将其视为等价关系,记为Rmust,如式(9)所示①.pRmustq;pRmustqqRmustp;pRmustq,qRmusthpRmusth文献[6]将can’t-link也看作为等价关系,但显然can’t-link不满足传递特性,即pRcan’tlinkq,qRcantlinkh|pRcantlinkh.因此本文仅以Rmust将满足must-link关系的点对集合MCS划分为若干个等价类,记这多个等价类的集合为Kmust.划分方式如算法1所示.算法1.输入:满足must-link关系的点对集合MCS,等价类输出:等价类集合Kmust划分过程:1.从MCS中任选一个点对,设其为(a,b);2.清空K和C;3.将(a,b)放入K中,并将(a,b)从MCS中删除;4.将a和b分别放入C中;5.从C中任选一个未标记数据,假设选择的是a,标记a为已选择;6.将MCS中所有包含a的点对都放入K中,并将这7.将每个点对中的数据无重复的放入C中(即如果某8.如果C中的数据均为已标记则转步9,否则转步5;9.将K作为新的等价类放入Kmust中;10.转步1直至MCS为空.按照上述等价类的划分方式,每个等价类中包含的任一点对均满足must-link关系(某些must-link关系是根据传递特性推出的,比如点对(a,b)、(b,c)分别满足must-link关系,则点对(a,c)也满足must-link关系).由于满足must-link关系的点对为用户指定的位于同一类别中的数据,即相似的数据,因此这些数据位于数据空间中相对密集的区域内.这样即可使每个密集分布的区域在权值量化函数中拥有同样的重要性以平衡限制数据的非均匀分布.然而,仅仅根据Rmust无法确定Kmust中不同的等价类是否可以合并为一个大的等价类,即无法确定两个不同的等价类中的数据是否分布于同一个密集区域内.而集合NCS恰好提供了这种信息:如果Kmust中有两个等价类分别含有NCS中的一个点对中的两个数据,则显然这两个等价类中包含的数据隶属于不同的类别.按照如上方法即可根据NCS将Kmust重新划分,将Kmust中两个确定不在同一类别中的等价类放入到集合T中,并将它们从Kmust中删除.对于Kmust中剩余的、无法确定是否可以合并的等价类,如P和Q,可以通过式(10)估算P和Q之间的相似度,并确定其是否可以合并.V(P,Q)=∑如式(10)所述,当等价类P和Q之间的值大于0时,可以认为这两个等价类内的相似数据多于不相似数据,则这两个等价类应属于同一类别,此时将P和Q合并后插入到集合T中.反之认为P和Q属于不同类别,将它们分别插入到集合T中.在将限制数据划分为多个密集区域(等价类)后,即可根据每个区域内包含的数据数分别对不同区域内的数据赋予不同的分布系数(λb),并将其结合到权值量化函数中去,结果如式(11)所述.其中Tb代表集合T中的第b个等价类,|T|代表集合T中等价类的数目.按照梯度下降算法对FW进行优化后,即可得到类似于式(7)的权值更新函数.FW=u∑Tb∈T①式(9)中等价关系的特性可参见文献[6,9],在此就不赘述了.Page5logρ式(12)为第b个等价类的分布系数λb的计算方法.其中,Tx代表T中的某个等价类,|Tx|代表集合的势,其他符号的含义如前所述.由此公式可见,该参数平衡了分布不同的各等价类内的数据对特征权值量化结果的影响,其降低了密集分布(等价类规模较大)的数据对特征量化结果的影响,而提升了稀疏分布(等价类规模较小)的数据的作用.4置信度传统的特征权值量化方法认为用户提供的限制数据是一致的,即如果用户认为点对(p,q)在MCS中,即(p,q)满足must-link关系,那么(p,q)是不可能位于NCS中的,即(p,q)不满足can’t-link关系.然而在实际应用中,尤其是进行聚类反馈时,是无法保证用户指定的限制数据中不存在上述矛盾的.即用户可能指定(a,b)、(b,c)分别满足must-link关系,这样根据传递特性,点对(a,c)也满足must-link关系,但是随着用户指定的点对数目的增多,用户不可能仔细检查每个点对,因此用户可能错误的指定(a,c)满足can’t-link关系,此时即出现了不一致性.这样即无法使用上述FW进行特征权值量化.针对此问题,本文为T中的每个等价类内的数据点对提供置信度,以确定其满足用户指定的限制关系的可信性,并融合此置信度进行特征权值量化.本文以边连接等价类中满足must-link关系(Rmust)且一致的点对.显然对于一个不存在不一致性的点对的等价类,其应该对应于一个全连通图.然而本文仅仅保留了MCS中包含的点对之间的边,而删除根据传递特性推导出的满足must-link关系的点对间的边.上述做法可以理解为:与MCS中用户指定的满足must-link关系的点对相比,那些推导出的满足must-link关系的点对的可信度较低,因此删除连接上述点对之间的边.设B中存储了存在不一致性的数据点对,即(p,q)∈B;(p,q)∈MCS&&(p,q)∈NCS.假设(p,q)位于等价类Tb中,这样即可根据Tb内的其他数据,例如i和j,与p和q间的距离来确定点对(i,j)是否是一致的置信度.显然,如果T中的某个等价类(Tb)中不存在不一致的点对,则该等价类中的任意点对间的置信度均为1.如果T中的某个等价类中存在不一致的点对,设其为(p,q),则对于Tb中的其他点对,例如(i,j),如果i和j分别与p和q在连通图中距离较近,则i和j反映的信息分别与p和q相似,则(i,j)是不一致的可能性较大,即其置信度应该较低,反之,其置信度应该较高;当然,等价类中可能存在着多个不一致的点对,此时分别计算每个点对相对于每个不一致点对的置信度,并以其最小值作为该点对的置信度.对于不一致的点对,其置信度显然为0.5,即其满足must-link关系和can’t-link关系的可能性均为50%.上述想法即可转化为式(13):烄oij=烅烆式(13)中,path(j,p)对应于j与p之间相距的最少边数.将置信度融合到权值量化函数中即可获得如式(14)所示的带有置信度的权值量化函数FW:FW=u∑b∈Tlogρlogρ在采用梯度下降算法优化FW后,即可将特征的权值代入到式(2)中实现带有特征权值的相似度计算方法,并使其代替传统的数据相似度计算方法(例如欧式距离)应用于任意的聚类算法中.Page65实验及分析本文采用UCI数据集[17]中的Waveform、Pima作为基准测试集,同时还采用了Newsgroup新闻语料和863文本分类语料来检测本文提出的权值量化方法在多特征、多类别下的表现情况.表1中列出了各基准数据集的相关信息.实验中分3种情况验证了本文所提出的权值量化函数的性能:(1)首先验证了在不存在不一致的限制数据的前提下,非均匀选择限制数据时,本文提出的权值量化函数的性能(主要证明“分布系数”的性能);(2)接下来验证了在均匀选择限制数据的前提下,限制数据中存在不一致性时,本文提出的权值量化函数的性能(主要证明“置信度”的性能);(3)最后验证了在非均匀选择限制数据且限制数据存在不一致性时,本文提出的权值量化函数的性能(主要证明“分布系数”和“置信度”可并存).按照上述设计,本文需要在限制数据均匀分布和非均匀分布两种情况下测试权值量化函数的性能.为实现上述测试,本文采用如下方法:以数据集Waveform为例,其他数据集也采用类似方法.Waveform数据集包含3个类别,每个类别中包含相似的数据,其意味着同一类别中的数据在数据空间中是紧密分布的.为保证选择的限制数据是均匀分布的,可以从每个密集分布的区域内选择等数量的限制数据.例如,如果需要选择20对均匀分布的限制数据完成测试(其他数量的限制数据采用类似方法),且假设Waveform的3个类别分别标记为A\B\C,则可以分别从3个类别中选择6\7\7对限制数据(由于20不可能为3整除,因此近似的选择6\7\7以保证限制数据接近均匀分布).为使限制数据非均匀分布,可以从单一的类别中选择限制数据,比如对于Waveform,可以仅从A类别中选择20对限制数据.为在限制数据中包含一致性和不一致性下分别测试权值量化函数的性能,本文采用如下方法:为从Waveform中选择20对一致的限制数据(其他数量和数据集也可按此种方式进行),则可先从Waveform中随机选择10对满足must-link关系的点对,即选择位于同一类别中的数据组成点对.然后在Waveform中随机选择10对满足can’t-link关系的点对,即选择不在同一类别中的数据组成点对,也就是说从某个类别中选择一个数据,然后再从另一个类别中选择一个数据,将这两个数据作为满足can’t-link关系的点对.同样如果为使选择的限制数据中包含不一致性,可以将上述某些按照传递特性推导出的满足must-link关系的点对设定为满足can’t-link关系.比如,如果选择(a,b)和(a,c)为满足must-link关系的点对,则设定(a,c)为满足can’t-link关系的点对,此时,限制数据中即包含不一致性.实验中以无监督聚类算法K-means和半监督聚类算法COP-K-means和KCL作为基准的聚类算法,然后将由不同的权值量化函数得到的特征权值应用于式(2)中以得到不同的相似度计算方法,之后比较了使用不同的相似度计算方法后各聚类算法的性能以表明本文所提的特征权值量化函数的性能.本文同时检测了在不同情况下,本权值量化函数和其他不同的权值量化函数在各基准聚类算法上的表现情况以验证本权值量化函数的性能.数据集WaveformNewsgroup本文以纯度值[18]来衡量聚类结果的准确率.在测试数据集中,已将待聚类数据划分到多个类别之中,当采用聚类算法进行处理时,仍然会将数据划分到多个类别中去.这样可以使用nq代表人工划分的第q个类别内包含的数据数,使用nr代表聚类结果中的第r个类别内包含的数据数,使用nq代表聚类结果中的第r个类别内属于人工划分的第q个类别的数据的数目.式(15)为第r个类别Cr的纯度值,其为具有最大数目的nq据数nr的比值.式(16)为算法的纯度值,其为所有类别的纯度值的一个平均值,其中c代表类别的个数.首先假设用户提供的限制数据是一致的,并且限制数据是从数据空间中非均匀选择的,在以上设定下,本文在图1中比较了K-means、COP-K-means、KCL在各基准数据集上的聚类准确率.图1的横坐标代表聚类算法的准确率,纵坐标代表非均匀分布的限制数据占全部限制数据的比例①.①本文进行的所有实验中,均人工预先指定100对数据作为Page7图1当限制数据非均匀分布且一致时的聚类准确率图中FW代表传统的权值量化函数(式(8)),FW+dp代表使用分布系数的权值量化函数(式(11)).K-means+FW和K-means+FW+dp代表使用基于特征权值的相似度计算方法的K-means算法,其中特征的权值分别由传统的权值量化函数和结合分布系数的权值量化函数得到.由图1可知,假设用户提供的限制数据是一致的,则K-means的效果最差,这是因为K-means不结合限制数据并且视所有特征具有相同的类别划分能力,而不同特征对数据的划分能力显然是不同的,例如Waveform数据集中仅有4个特征是与数据分布相关的,其他特征均为噪声特征.如果视所有特征具有相同的重要性,这些噪声特征显然会降低聚类算法对数据的划分能力.相对于K-means,COP-K-means和KCL通过改变算法的收敛函数或调整搜索策略能够有效的保证数据的分割结果在满足用户指定的限制信息的前提下达到最优的划分[9-10],因此效果较好.当非均匀分布的限制数据的数目较少时,KCL的效果要好于COP-K-means,然而随着非均匀分布的限制数据数目的增多,两种半监督聚类算法的性能逐渐下降,此时KCL下降的幅度要快于COP-K-means.性能下降的原因在于当非均匀分布的限制数据较少时,限制数据提供的有用信息能够帮助这两种算法改善聚类结果,然而当非均匀分布的限制数据增多时,非均匀分布引入的偏置会降低聚类的效果,同时由于KCL仅通过限制数据调整搜索策略,而COP-K-means同时结合了限制数据和非限制数据调整收敛函数,因此KCL受到的影响较大,性能波动幅度也较大.由图1还可知,如果将传统的权值量化函数和K-means相结合后,其聚类效果有显著地提高.这说明此函数在通过限制数据进行特征权值量化时,使那些能够有效划分限制数据的特征拥有较大的权值,从而使聚类结果能够满足用户提供的限制信息,同时该函数还结合了非限制数据以防止限制数据过少而引入的偏置,从而提高了算法对非限制数据的划分能力.然而随着非均匀分布的限制数据数目的提升,所有结合传统的权值量化函数的聚类算法的性能均下降,并且此时结合此函数的半监督聚类算法的性能要低于不使用此函数的聚类算法的性能.其原因在于,此权值量化函数结合了用户提供的限制数据来调整特征权值,因此会受到非均匀分布的限制数据的影响,从而出现性能波动.同时还可见,相对于无监督聚类算法,结合传统的权值量化函数的半监督聚类算法受到的影响最大.其原因在于,半监督聚类算法已经结合了限制数据进行类别划分,当与传统的权值量化函数相结合后,其受非均匀分Page8布的限制数据的影响显然也更大.然而,当将聚类算法和使用分布系数的权值量化函数相结合后即可发现,无论是无监督聚类算法还是半监督聚类算法,其性能均保持了很好的平衡,受非均匀分布的限制数据的影响较小,并且各算法均维持了很高的准确率.此种情况即可说明:分布系数能够平衡分布不均匀的限制数据对权值量化结果的影响.如文中第4节所述,限制数据中很可能包含不一致性,因此本文在图2中比较了当限制数据中包含不一致性的前提下,使用不同的相似度计算方法后,各种聚类算法的准确率,此时设定限制数据为均匀分布的.其中图2的横坐标代表聚类算法的准确率,纵坐标代表不一致的限制数据占全部限制数据的比例.图中FW代表传统的权值量化函数(式(8)),FW+bv代表使用置信度的权值量化函数(式(14)中去掉参数λb).K-means+FW和K-means+FW+bv代表使用基于特征权值的相似度计算方法的K-means算法,其中特征的权值分别由传统的权值量化函数和结合置信度的权值量化函数得到.对比图2和图1可知,图2中各种聚类算法的准确率曲线的分布和图1相差不多,其区别主要有:(1)与图1相比,除K-means外,图2中所有算法的准确率曲线均低于图1中的相应曲线.为清晰展示图2和图1中各曲线的差距情况,本文将图2和图1中曲线的对比结果展示为表2.表2中,分别选择比例1/10、5/10、10/10来展示各聚类算法的效果.由表中可以清晰的反映出:除K-means外,图2中所有算法的准确率曲线均低于图1中的曲线.(2)结合传统权值量化函数的半监督聚类算法的准确率曲线下降的幅度要大于图1中相应算法.造成第1点的原因在于:相对于非均匀分布,限制数据包含不一致性时引入的误差要更大,因此除K-means外,各聚类算法的性能均下降.K-means算法保持不变的原因在于该算法根本未考虑限制数据的影响,因此无论限制数据是否是不均匀分布还是包含不一致性时,该算法的性能均不受影响.造成第2点的原因在于:由于半监督聚类算法已经结合了限制数据进行类别划分,因此当限制数据包含不一致性时,半监督聚类算法与传统的权值量化函数相结合后,其性能会降低的更多.然而,当将所有的聚类算法和使用置信度的权值量化函数相结合后,各聚类算法的性能均有所提升,并且受不一致的限制数据的影响非常小.此种情图2当限制数据包含不一致且均匀分布时的聚类准确率况即可说明:本文提出的置信度能够有效改善限制数据的不一致性对权值量化结果的影响,进而提高聚类算法的准确率.Page9Waveform1/105/1010/101/105/1010/10WaveformK-means73.2573.2573.2573.2573.2573.25K-meansCOP-K-meansKCL86.7383.1676.5684.9381.3174.05KCLK-means+FWCOP-K-means+FWKCL+FW88.2582.4673.1486.5580.6370.14KCL+FWK-means+FW+dpCOP-K-means+FW+dpKCL+FW+dpPima1/105/1010/101/105/1010/10PimaK-means78.6178.6178.6178.6178.6178.61K-meansCOP-K-meansKCL90.7387.3180.3688.8385.3278.36KCLK-means+FWCOP-K-means+FWKCL+FW94.5588.9477.5491.8585.0771.12KCL+FWK-means+FW+dpCOP-K-means+FW+dpKCL+FW+dpNewsgroup1/105/1010/101/105/1010/10NewsgroupK-means71.0371.0371.0371.0371.0371.03K-meansCOP-K-meansKCL85.7382.5176.2685.0381.9275.16KCLK-means+FWCOP-K-means+FWKCL+FW87.5781.5470.8487.0280.8369.74KCL+FWK-means+FW+dpCOP-K-means+FW+dpKCL+FW+dp863K-means77.6177.6177.6177.6177.6177.61K-meansCOP-K-meansKCL87.9784.7678.3687.3283.6476.56KCLK-means+FWCOP-K-means+FWKCL+FW89.0383.2572.5588.3381.9270.75KCL+FWK-means+FW+dpCOP-K-means+FW+dpKCL+FW+dp接下来在图3中比较了在限制数据中既存在非均匀分布又存在不一致性的情况下,使用不同的相似度计算方法后,各种聚类算法的准确率.图3的横坐标代表聚类算法的准确率,纵坐标代表既是非均匀分布且是不一致的限制数据占全部限制数据的比例.图中FW代表传统的权值量化函数(式(8)),FW+dp+bv代表使用分布系数和置信度的权值量化函数(式(14)).K-means+FW和K-means+FW+dp+bv代表使用基于特征权值的相似度计算方法的K-means算法,特征权值分别由传统的权值量化函数和结合分布系数和置信度的权值量化函数得到.相比于图1和图2,由图3可见,当限制数据同时存在非均匀分布和不一致性时,传统的半监督聚类算法和使用传统的特征权值量化函数的各种聚类算法的性能均急剧下降,并且使用传统的特征权值量化函数的半监督聚类算法的性能要远远低于不使用此函数的半监督聚类算法.此种情况说明:非均匀分布和不一致性的同时存在使得依赖限制数据的聚类算法的性能受到极大的影响,其受影响程度远远大于上述两种情况单独存在时引入的影响.然而,当将分布系数和置信度同时引入权值量化函数后,各种聚类算法的性能均有所提高,且随着非均匀分布和不一致的限制数据数目的增多,其性能下降的幅度减小.此种情况说明分布系数和置信度可以同时存在来提高聚类算法的性能.为显示本文提出的权值量化函数的性能,本文同时检测了在不同情况下,此权值量化函数和其他权值量化函数在各基准聚类算法上的表现情况.作为比较的权值量化函数包括FWNB[19]、MWMR[20]、FWSA[21].以K-means为例,将应用各权值量化函数的K-means算法标记为K-means+FWNB、K-means+MWMR、K-means+FWSA,同时将应用“分布系数”和“置信度”的权值量化函数的K-means算法标记为K-means+FW+dp+bv.图4显示了当限制数据不存在不一致性,并且限制数据是从数据空间中非均匀选择的情况下,各权值量化函数和各聚类算法相结合后在各基准数据集上的聚类准确率.由图4可见,当限制数据为非均匀分布时,与未使用权值量化函数的聚类算法相比,除FWNB和本文提出的权值量化函数外,MWMR和FWSA与聚类算法相结合后,各聚类算法的性能均降低.其意味着,相对于MWMR和FWSA,FWNB可以很好的适应非均匀分布的限制数据对权值量化结果的影Page10图3当限制数据非均匀分布且不一致时的聚类准确率响,其原因在于FWNB使用数据的分布密度来融合限制数据进行特征权值量化,因此可以在一定程度上适应非均匀分布的限制数据对权值量化结果的影响.然而,由于FWNB需要预先设定数据的分布模型,这使得假设的分布模型与真实的数据分布存在一定的差距,从而降低了权值量化函数的准确率.相应的,MWMR和FWSA在进行权值量化前已经假设限制数据为均匀分布,因此权值量化的结果无法处理非均匀分布的限制数据.相对于FWNB、MWMR、FWSA,本文提出的权值量化函数(FW+dp+bv)通过等价类划分可以很好的考虑非均匀分布的限制数据对权值量化结果的影响,因此当将本文提出的权值量化函数与各聚类算法相结合后,各聚类算法的性能均得到很大的提升.图5显示了当限制数据均匀分布时,且限制数据包含不一致性的情况下,各权值量化函数和各聚类算法相结合后在各基准数据集上的聚类准确率.由图5可见,当限制数据包含不一致性时,与未使用权值量化函数的聚类算法相比,当使用FWNB、MWMR、FWSA后,各聚类算法的性能均有所降低,其意味着上述的权值量化函数均无法对包含不一致性的限制数据进行处理.相对来说,当使用本文提出的权值量化函数后,各聚类算法的性能均有所提升,并且随着不一致的限制数据数目的增多,各聚类算法的性能并没有下降得太多,这说明,相对于基准的权值量化函数(FWNB、MWMR、FWSA),本文提出的权值量化函数可以很好的处理限制数据中包含不一致性的情况.图6显示了当限制数据非均匀分布且包含不一致性的情况下,各权值量化函数和各聚类算法相结合后在各基准数据集上的聚类准确率.由图6可见,当限制数据非均匀分布且包含不一致性的情况下,与未应用权值量化函数的聚类算法相比,将FWNB、MWMR、FWSA和各聚类算法相结合后,各聚类算法的性能均下降.与图4相反,与图5类似,当将聚类算法和FWNB相结合后,各聚类算法的性能均低于未使用权值量化函数的聚类算法的性能,其意味着,非均匀分布且包含不一致性的两种情况会相互影响以更进一步的降低各基准的权值量化函数的性能.相反,如果使用本文提出的权值量化函数,可以很好的解决这两点问题,使得各聚类算法的性能均有所提高.本文通过划分等价类来形成“分布系数”以改善限制数据的分布不平衡对权值量化结果带来的影响.然而,如果按照传统的划分方式,即文中第3节所示的步骤来划分等价类,会忽略掉很多可能的等价类.因此,本文引入式(10)来改善此种情况.为显Page11示该方法的效果,本文检测了在未使用式(10)和使用式(10)后的权值量化函数对非均匀分布的限制数据的处理能力.图7中,FW+dp1和FW+dp2均图5当限制数据包含不一致性且均匀分布时代表使用“分布系数”的权值量化函数,区别为置信度分别通过常规方法获得(文中第3节所示的划分步骤)和通过式(10)重新划分获得.Page12图6当限制数据非均匀分布且包含不一致性时由图7可见,当采用常规方法划分等价类得到参数“分布系数”后,使用结合此“分布系数”的权值量化函数(FW+dp1)的各聚类算法的性能显然低图7当限制数据非均匀分布且一致时应用不同于使用结合式(10)的权值量化函数(FW+dp2)的各聚类算法的性能.其意味着如果简单的根据must-link关系和can’t-link关系划分等价类,显然Page13无法将限制数据的分布特性完全挖掘出来.例如,如果用户指定同一类别中的点对(a,b)和(c,d)均满足must-link关系,由于数据a、b、c、d位于同一类别中,因此点对(a,c)和(b,d)也满足must-link关系,但是按照传统的等价类划分方法会将(a,b)和(c,d)划分到不同的等价类中,即无法发现(a,c)和(b,d)之间的关系.而当采用式(10)后,通过计算不同等价类中的数据之间的相似性,可以很好的对等价类进行重新划分,即将点对(a,b)和(c,d)划分到同一等价类中.这说明,这种结合式(10)的权值量化函数可以更好的描述数据的分布特性,从而避免了不均匀分布的限制数据对权值量化结果带来的影响.6结论本文提出了一种结合限制数据的特征权值量化函数,该函数通过用户指定的限制数据进行特征权值量化,使得能够充分反映数据之间的相似性或能够有效划分数据的特征在相似度计算中具有较大的权值,并将相似度计算的结果应用于数据聚类之中.为了防止限制数据分布不均匀而形成训练结果的“过适应”,此函数将限制数据划分为多个等价类,并为不同的等价类赋予不同的分布系数.针对用户指定的限制数据中可能包含不一致性的问题,此函数对不同的限制数据赋予不同的置信度并将其结合到权值量化函数中去.由实验结果可得,此权值量化函数独立于固定的聚类算法,可以应用于任何聚类算法中以改变相似度度量函数并提高聚类结果的准确率.
