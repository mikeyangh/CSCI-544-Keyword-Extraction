Page1一些环签名及其扩展签名方案的安全性分析及改进王化群1),2)秦波3)1)(大连海洋大学信息工程学院辽宁大连116023)2)(辽宁省海洋信息技术重点实验室辽宁大连116023)3)(西安理工大学理学院数学系西安710048)摘要通过对Zhang(2007),Li-Chen-Yuen-Wang(2006),Li-Wang(2006)和Zhu-Zhang-Wang(2009)提出的环签名及其扩展签名方案进行密码学分析,指出了这几个方案所存在的安全性缺陷,基于其安全性缺陷提出了群成员改变攻击方法或匿名性攻击方法.为避免这些缺陷,利用Herranz-Saez(2003)环签名方案的一般模式和分叉引理对原方案进行改进,改进后的方案是可证安全的.关键词环签名;代理环签名;环签密;群成员改变攻击1引言环签名是由Rivest等人[1]首次提出的,并且利用组合函数和对称密码体制给出了一种高效的环签名方案.环签名提出以后引起了信息安全研究领域Page2RSA被攻破也须保护匿名的场合.对于环签名的安全分析,存在3种强度不同的安全模型[1,6-7].对于环签名及其扩展环签名方案,可在不同的安全模型下进行分析.最近,双线性对被广泛应用在各种密码方案的设计中,并提出了许多不同的环签名方案[8-10].由于双线性对在密码学应用中具有良好的性质,所以得到广泛的关注.本文在3种不同安全模型中分析了文献[2-5]中的环签名及其扩展签名方案,指出了其存在的安全缺陷,并对其进行了改进,弥补了这些安全缺陷,使得改进后的方案是可证安全的.本文第2节主要介绍双线性对和环签名的基本概念,并给出了环签名的3种强度不同的安全模型;第3节简要介绍文献[2]提出的Zhang具有自认证的环签名及其扩展签名方案,针对该方案提出了群成员改变攻击;第4节简要介绍文献[3]提出的2种Li-Chen-Yuen-Wang代理环签名方案,针对该方案提出了群成员改变攻击;第5节简要介绍文献[4]提出的Li-Wang通用指定验证者环签名方案,针对该方案提出群成员改变攻击;第6节简要介绍文献[5]提出的Zhu-Zhang-Wang基于身份的环签密方案,针对该方案提出了匿名性攻击和群成员改变攻击;第7节详细分析Zhang(2007),Li-Chen-Yuen-Wang(2006),Li-Wang(2006),Yap-Heng-Goi(2006)和Zhu-Zhang-Wang(2009)环签名及其扩展签名方案存在安全缺陷的原因,并指出其安全性证明过程中存在的问题.在此基础上,对原方案进行改进,并对改进后的方案进行安全性分析;第8节对本文进行总结.2双线性对、环签名和安全模型设G1为一生成元为P的加法循环群,G2为乘法循环群,其阶都为素数p.群G1,G2中的离散对数问题都是困难的.定义双线性对e:G1×G1→G2,e满足如下条件:(1)双线性性.e(aP,bQ)=e(P,Q)ab,其中P,Q∈G1,a,b∈Z(2)非退化性.存在P,Q∈G1,满足e(P,Q)≠1,其中1为循环乘法群G2的幺元.(3)可计算性.任取P,Q∈G1,存在有效算法计算e(P,Q).群G1可取有限域上超奇异椭圆曲线或超椭圆曲线,双线性对可利用该曲线上的Weil配对或Tate配对改进后进行实现.假设G1为一加法群,在群G1上定义以下密码学问题:离散对数问题(DLP):任取Q∈G1,求满足Q=计算Diffie-Hellman问题(CDHP):(P,aP,决策Diffie-Hellman问题(DDHP):(P,aP,nP的n∈ZbP)∈G3bP,cP)∈G4否成立.GapDiffie-Hellman(GDH)问题:一类CDHP困难而DDHP容易的问题.假设DLP问题和CDHP问题是困难的,即不存在多项式时间算法以不可忽略的概率求解DLP问题、CDHP问题.群G1的选取可满足DLP问题、CDHP问题难解,而DDHP问题易解的条件,即群G1为GDH群.环签名指一个面向群体的签名中可能签名者的集合组成一个环,其中实际签名的环成员为签名者,其它的环成员为非签名者.签名者能够使得确认者相信消息的签名者为这个环中的一个成员,但该成员能够保持无条件匿名性,即攻击者即便非法获取了所有可能的签名者的私钥,他能确定出真正的签名者的概率不超过1/n,这里n为环成员(可能的签名者)的个数.环签名还有另外一个特征,即签名者可以在n个用户中自由地任意选取r>1个用户(包括自己)产生一个环签名,也就是说,签名者可以指定自己的匿名范围,并且被指定的用户可能不知道自己被包含在其中.不同的模型,下面简要介绍一下:成,其中各自的作用如下:对于环签名的不可伪造性,文献[1,6-7]提出了一个环签名方案由一个三元算法组(Ι,S,V)组(x,u)←I(1k)是一个概率多项式时间算法,k为安全参数,输出x为私钥,u为相应的公钥;σ←S(1k,x,L,m)是一个概率多项式时间算法,输入k为安全参数,x为私钥,L为n个成员公钥的集合,其中含有对应于x的公钥,m为要求签名的消息,输出σ为签名;1/0←V(1k,L,m,σ)为确定的多项式时间算法,输入符号的含义跟前两个算法相同,输出1或0表示接受或拒绝,并要求V(1k,L,m,S(1k,x,L,m))=1.为简化起见,本文其余部分将输入中的安全参数1k省略.设S为签名者,A为攻击者.S利用I产生一个大的公钥集合L={u1,u2,…,uN},其中N为k的某个多项式.A向S请求至多k的多项式次不同消息mi关于Li的环签名请求,在得到响应(Li,mi,σi)Page3后,A不能以不可忽略的概率产生消息m的环签名(L,m,σ)(LL,m{已请求环签名的消息mi}),称该方案在安全模型Model-1中是安全的[1];当A不能以不可忽略的概率产生任一消息m的环签名(L,m,σ)(LL,(L,m){已请求环签名的消息、成员组对(Li,mi)})时,称该方案在安全模型Model-2中是安全的[7];当A不能以不可忽略的概率产生任一消息m的环签名(L,m,σ)(LL,(L,m,σ){已请求环签名的消息、成员组、签名对(Li,mi,σi)})时,称该方案在安全模型Model-3中是安全的[6].容易看到,Model-1、Model-2和Model-3的安全性要求依次增强.Model-1没有考虑群成员改变攻击,多已知签名存在伪造攻击;Model-2考虑了群成员改变攻击,没考虑多已知签名存在伪造攻击;Model-3考虑了这两种攻击.3Zhang具有自认证的环签名方案及其扩展签名方案的简介和攻击方法3.1Zhang具有自认证的环签名方案及其扩展签名方案2007年,Zhang[2]提出了一种高效的基于身份的具有自认证的环签名方案,新方案不需要将身份映射为群G1中的点,并且能够进行批验证,因而提高了运算速度.因为我们的讨论仅是方案本身的可伪造性,因而省略自认证过程.简单介绍下列步骤:Setup,Keygen,Sign,Verify:Setup:随机选取s∈RZp为主密钥,相应的系统公钥为IDivi+IDnvn+IDn+1vn4Li-Chen-Yuen-Wang代理环签名方案的简介和攻击方法4.1Li-Chen-Yuen-Wang代理环签名方案2006年,Li等人[3]提出了一种高效的代理环签Ppub=sP.选取Hash函数H:{0,1}×G2→Zp,并计算ω=e(P,P),则得到系统公开参数为param={e,G1,G2,P,ω,H,Ppub},参数的含义跟第2节的介绍相同,主密钥s保密;KeyExtract:对于身份IDi∈Zp,计算si=1果s+IDi=0modp,终止并返回Setup.则身份IDi的成员的私钥为si,公钥为IDi.Sign:设L={ID1,ID2,…,IDn}为环签名成员身份集合,其中包含实际签名者,设其身份为IDπ,并假设请求签名的消息为m,签名过程如下:对于i∈{1,2,…,n}/π,随机选择ai∈Zp,k∈Zp,依次计算:vi=aiP,r=ωkeP,∑nu=H(m,r),vπ=(u+k)SIDπ.最后输出的关于m的签名为(v1,v2,…,vn,r).Verify:当收到关于m和成员集L的签名σ=(v1,v2,…,vn,r)时,验证者计算u=H(m,r),并检测ωur=?v()ieP,∑nePpub,∑n否则,拒绝.3.2对上述环签名方案的攻击方法文献[2]环签名方案就是在Model-3安全模型中证明其安全性的,但是,方案的证明过程有缺陷,错用了数字签名分叉引理,因而其结论不正确.我们在Model-3中给出攻击方法:假设攻击者截获了关于消息m和成员集L的签名(v1,v2,…,vn,r),取t∈RZtIDn+1P,vn+1=tPpub+tIDnP,则伪造的关于消息m的另一个环签名σ=(v1,v2,…,vn-1,vn,vn+1,r)能够通过确认,成员集为L=L∪{IDn+1}.伪造的环签名能够通过验证的证明如下:i=1名方案,其签名步骤为Setup,Keygen,PRS,Verify.Setup:选取Hash函数H1:{0,1}→Zp,H2:G1→G1.公开参数为param={e,G1,G2,P,H1,H2}.Keygen:对于授权签名者IDo,选取xo∈Zp作为私钥,计算yo=xoP作为其公钥.对于代理签名者IDi,选取xi∈Zp作为私钥,计算yi=xiP作为其公钥.授权签名者IDo为将签名能力授权给代理签名者IDi,计算Si=xoH2(yi),发Page4送给IDi.IDi的私钥为ski=(xi,Si).i=1Verify:设验证者收到的关于消息m、代理签名者集合PRS:假设代理签名人的集合为L={ID1,ID2,…,IDn},实际代理签名人为IDt∈L,代理环签名过程如下:选取ri∈RZp,计算σi=riP,其中i∈{1,2,…,n}\t;然后依次计算ω=∏n最后,得到关于消息m,代理签名者集合为L={ID1,ID2,…,IDn}的代理环签名σ={σ1,…,σn}.L的环签名为σ={σ1,…,σn},验证者检测∏nH1(m)P)=?∏n否则,拒绝.4.2对上述代理环签名方案的攻击方法文献[3]代理环签名方案是在Model-2安全模型中证明其安全性的,但是,当在更强的安全模型Model-3中考虑其安全性时,该方案存在群成员改变攻击.下面给出其攻击方法:假设第n+1个代理签名人为攻击者,在截获了关于消息m、成员集L的代理环签名σ={σ1,…,σn}后,该攻击者能够主动加入该环签名,构造如下:计算σn+1=(xn+1+H(m))-1Sn+1,则e(σn+1,yn+1+H1(m)P)=e((xn+1+H(m))-1Sn+1,yn+1+H1(m)P)=e(Sn+1,P)=e(H2(yn+1),yo),因而∏n+1σ={σ1,…,σn,σn+1}为关于消息m、成员集为L=L∪{IDn+1}的有效的环签名.伪造的环签名能够通过验证的证明如下:∏n+1e(σi,yi+H1(m)P)=e(σn+1,yn+1+H1(m)P)∏n=e(σn+1,yn+1+H1(m)P)∏n=e(H2(yn+1),yo)∏n=∏n+1e(H2(yi),yo).i=1注.文献[3]中还提出了另一个环签名方案,类似地,该方案在Model-3中同样存在上述攻击.5Li-Wang广义指定验证者环签名方案的简介和攻击方法i=1i=15.1Li-Wang广义指定验证者环签名方案2006年,Li等人[4]提出一个标准模型中可证安全的广义指定验证者环签名方案,基于(q,n)-DsjSDH困难性问题在Model-3中证明了所提方案的安全性.该签名步骤:Setup,Keygen,RS,RV,DRS,DRV:Setup:选取密码Hash函数Hi:{0,1}→Zp,其中i∈{1,2,…,n},公开参数为param={e,G1,G2,P,P,H1,H2},P,P为G1的两个不同的产生子.Keygen:签名者IDi选取(xi,yi)∈(Zp)2,计算Xi=xiP,Yi=yiP,则(xi,yi)为用户IDi的私钥,(Xi,Yi)为用户IDi的公钥;同样地,验证者IDv选取其私钥(xv,yv),公钥(Xv,Yv);RS:设签名者公钥集合为{(X1,Y1),(X2,Y2),…,(Xn,Yn)},验证者公钥为(Xv,Yv),实际签名者为IDt,其公钥(Xt,Yt)∈{(X1,Y1),(X2,Y2),…,(Xn,Yn)}.对于i∈{1,2,…,n}\t,j∈{1,2,…,n},选取zi∈RZp,rj∈RZp,依次计算σi=ziP,ω=P-∑i∈{1,…,n}\txt+rt+ytHt(m)ω;最后,得到环签名σ={(σ1,r1),…,(σn,rn)}.RV:对于签名者公钥集合L={(X1,Y1),…,(Xn,Yn)},消息m,签名σ={(σ1,r1),…,(σn,rn)},检测∏nriPi+Hi(m)Yi)]=?e(P,P).如果成立,则接受;否则,拒绝.DRS:对于签名者公钥集合L={(X1,Y1),…,(Xn,Yn)},消息m,签名σ={(σ1,r1),…,(σn,rn)},如果指定验证者公钥为(Xv,Yv),签名拥有者计算:Ai=riP,Bi=e(Xv,Yv)ri,则指定确认者环签名为σ={(σ1,A1),…,(σn,An),B1,…,Bn};DRV:对于指定确认者环签名为σ={(σ1,A1),…,(σn,An),B1,…,Bn};验证者检测∏ne(P,P),e(Xv,Ai)yv=?Bi.如果成立,则接受;否则,拒绝.5.2对上述广义指定验证者环签名方案的攻击方法文献[4]广义指定验证者环签名方案就是在Model-3安全模型中证明其安全性的,但是,方案的证明过程有缺陷,错用了数字签名分叉引理,因而其结论不正确.下面在Model-3安全模型中给出其攻击方法:设攻击者在RS阶段收到环签名σ={(σ1,r1),…,(σn,rn)},攻击者可以将公钥为(Xn+1,Yn+1)的成员加入该环签名,构造如下:任取t,rn+1∈RZσn=σn+t(Xn+1+rn+1+Hn+1(m)Yn+1),σn+1=-t(Xn+rnP+Hn(m)Yn),则σ={σ1,…,σn-1,σn,σn+1}为关于消息m、成员集为L=L∪{IDn+1}的有效的环签名.能够成功通过验证者确认.伪造的环签名能够通过验证的证明如下:Page5∏n-1i=1rnPn+Hn(m)Yn)e(σn+1,Xn+1+rn+1Pn+1+Hn+1(m)Yn+1)=∏n-1i=1t(Xn+1+rn+1+Hn+1(m)Yn+1),Xn+rnPn+Hn(m)Yn)·e(-t(Xn+rnP+Hn(m)Yn),Xn+1+rn+1Pn+1+Hn+1(m)Yn+1)=∏n-1i=1rnPn+Hn(m)Yn)=∏ni=1=e(P,P).6Zhu-Zhang-Wang基于身份的环签密方案简介及其攻击方法6.1Zhu-Zhang-Wang基于身份的环签密方案2009年,Zhu-Zhang-Wang提出一个基于身份的环签密方案[5],该方案被证明是自适应选择密文环攻击下不可区分的,自适应选择消息攻击下是存在不可伪造的.该方案步骤如下:Setup,Keygen,Signcryption,Designcryption.Setup.选取安全参数k,L,两个阶为p的群G1,G2.PKG(PrivateKeyGenerator)选取随机数s∈Zp作为其主密钥,其公钥为Ppub=sP.选取密码Hash函数H1:{0,1}→G1,H2:G2→{0,1}l,H3:{0,1}l×G2→{0,1}l,H4:{0,1}→Zp.消息空间为M={0,1}l,公开参数为param={e,G1,G2,P,Ppub,H1,H2,H3,H4}.Keygen.对于成员IDi,PKG计算QIDi=H1(ID1),DIDi=sQIDi,将DIDi发送给IDi.Signcryption.设n个用户的集合为L={ID1,ID2,…,IDn},实际环签密者为IDs,接收者为IDB.IDs计算如下:(1)随机选取r∈RZp,m∈RM,计算R0=rP,R=e(rPpub,QIDB),k=H2(R),c1=mk,c2=mH3(m‖R0);(2)随机选取Ui∈RG1,计算hi=H4(c2‖Ui),i∈{1,2,…,n}\{s}.随机选取r∈Zp,计算Us=rQIDs-∑i≠s{Ui+hiQIDs},hs=H4(c2‖Us),V=(hs+r)DIDs,则消息m的密文为δ=R0,c1,c2,∪n者IDB.Designcryption.接收者IDB进行解签密如下:(1)对于i∈{1,2,…,n},计算hi=H4(c2‖Ui);(2)检测eP,∑n果成立,计算k=H2(e(R0,DIDB)),恢复m=c1k,m=c2H3(m‖R0),并接受m为有效的.否则,拒绝该密文.6.2对上述环签密方案的攻击方法文献[5]环签密方案不满足匿名性和不可伪造性,这两个性质是环签密方案应具备的基本性质.下面给出攻击方法.(1)在环签密解密过程中,需要检测在该检测式中,用到了签名者的身份IDs计算出的Qs=H1(IDs),而没有用到其它成员的身份.因而,通过枚举法,逐个验证环签密成员集中每个成员的身份,使得该检测式成立的成员的身份即为实际环签密者.这样,Zhu-Zhang-Wang基于身份的环签密方案不满足无条件匿名性.(2)Zhu-Zhang-Wang基于身份的环签密方案是可伪造的.假设攻击者收到消息m的密文δ=R0,c1,c2,∪n(G1,计算hn+1=H4(c2‖Un+1),Un=Un-(Un+1+hn+1QIDs),Un+1=Un+1,则δ=(R0,c1,c2,∪n-1{Un,Un+1},V)是消息m的一个有效的密文,即(eP,∑n-1成立.因而,伪造的环签密能够通过检测.证明如下:(eP,∑n-1(Un+1+hn+1QIDs))=eP,∑n-1=eP,∑n=e(P,V).7上述环签名及其扩展签名方案的安全性分析及改进环签名及其扩展签名的特性使得其安全性证明更加复杂,而不能仅用目前已有的数字签名的安全性证明方法.比如Pointcheval分叉引理[11]并不能直接应用在环签名及其扩展签名环境中,因为没有包含群成员改变攻击,文献[2-4]的证明过程就是错Page6误地使用了Pointcheval分叉引理[11],从而得出了错误的安全性结论,而文献[5]的错误在于未将随机值跟消息、成员集一起求其Hash函数值,因而导致错误地使用了Pointcheval分叉引理[11],从而得出了错误的安全性结论.为了在环签名体制中应用分叉技术,Herranz-Saez提出了在Model-2安全模型下一般模式的环签名模型,及相应的分叉引理[12].同样的,如果将Hash函数作用于消息、成员集和随机值,可以同样地得出在Model-3安全模型下一般模式的环签名模型,及相应的分叉引理.在对原签名方案的改进中,我们将在Model-3安全模型下研究改进方案的安全性.7.1对Zhang(2007),Li-Chen-Yuen-Wang(2006),Li-Wang(2006)签名方案的改进在改进的Zhang(2007)签名方案中,Setup、KeyExtract跟原签名方案相同,Sign过程中,将Hash函数作用于(m,L,r)上,即u=H(m,r),其余步骤相同;对应的,在Verify过程中,将Hash函数H作用于(m,L,r)上,即u=H(m,r),然后再进行检测.在改进的Li-Chen-Yuen-Wang(2006)代理环签名方案中,Setup、Keygen跟原签名方案相同,PRS过程中,将Hash函数H1作用于(m,L,r)上,即H1(m,L,r),其余步骤相同;对应的,在Verify过程中,将Hash函数H1作用于(m,L,r)上,即H1(m,L,r),然后再进行检测.在改进的Li-Wang(2006)签名方案中,Setup、Keygen跟原签名方案相同,RS过程中,将Hash函数Hi作用于(m,L,r)上,即Hi(m,L,r),其中i∈{1,2,…,n},其余步骤相同;对应的,在Verify过程中,将Hash函数Hi作用于(m,L,r)上,即Hi(m,L,r),其中i∈{1,2,…,n},然后再进行检测.DRS、DRV跟原签名方案相同.7.2对Zhu-Zhang-Wang(2009)环签密方案的改进在改进的Zhu-Zhang-Wang(2009)环签密方案中,Setup、Keygen跟原环签密方案相同.Signcryption过程中,设实际环签密者IDs选取的环签密成员集为L={ID1,ID2,…,IDn},请求环签密的消息为m,计算如下:(1)随机选取r∈RZR=e(rPpub,QIDB),k=H2(R),c1=mk,c2=mH3(m‖R0);(2)随机选取Ui∈RG1,计算hi=H4(c2‖Ui‖L),i∈{1,2,…,n}\{s}.随机选取r∈ZrQIDs-∑i≠s(hs+r)DIDs,则消息m的密文为δ(=R0,c1,c2,i=1{Ui},)V,发送δ给接收者IDB.∪nDesigncryption:接收者IDB进行解环签密如下:(1)对于i∈{1,2,…,n},计算hi=H4(c2‖Ui‖L);(2)检测eP,∑n成立,计算k=H2(e(R0,DIDB)),恢复m=c1k,m=c2H3(m‖R0),并接受m为有效的.否则,拒绝该密文.7.3改进的环签名及其扩展签名方案的安全性分析文献[2-5]提出的环签名及其扩展签名方案中,作者都给出了相应的安全性证明.证明中出现错误的原因在于误用了随机预言模型中的分叉引理.Pointcheval等人[11]提出的数字签名分叉引理对于环签名及其扩展签名是不适用的.作者的证明过程仅仅利用了文献[11]或相关的数字签名分叉引理,导致了证明中的错误.为了研究环签名及其扩展签名的分叉引理,Herranz-Saez[12]在Model-2安全模型中给出了环签名的一般模式和相应的分叉引理.而将Herranz-Saez[12]在Model-2安全模型中给出的环签名的一般模式和相应的分叉引理推广到在Model-3安全模型中的分叉引理是平凡的,仅将Hash函数作用于消息、环签名成员集和随机数上即可.我们对上面几种环签名及其扩展签名方案的改进就是使得改进后的方案满足Model-3安全模型中环签名的一般模式,以便证明过程充分利用Model-3安全模型中的环签名分叉引理.改进后环签名方案的不可伪造性证明思路跟原来的证明思路类似,区别仅仅在于取Hash函数时,输入的值不一样,以及利用环签名分叉引理,而不是Pointcheval等人的数字签名分叉引理.至于改进的Zhu-Zhang-Wang(2009)环签密方案的匿名性,由于在解环签密过程中的检测方程eP,∑n用到了所有的环签密成员的身份,因而保证了无条件匿名性.8总结本文对文献[2-5]提出的环签名及其扩展签名方案进行了分析,给出了群成员改变攻击或匿名性攻击.由于文献[2-5]提出的方案是可证安全的,我Page7们分析了安全性证明中的错误,以及导致错误产生的原因.针对原方案证明过程中出现的错误,对原签名方案进行了改进,使得改进后的环签名及其扩展签名方案是可证安全的.
