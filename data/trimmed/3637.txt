Page1基于IEEE802.11的长距离无线Mesh网络赵增华王楠窦志斌张连芳舒炎泰(天津大学计算机科学与技术学院天津300072)摘要基于IEEE802.11的长距离无线Mesh网络(LDmesh)的单跳链路长度在几十到上百公里,具有带宽高、成本低、覆盖广等优点,可广泛应用于偏远乡村或人口分布稀疏地区的无线宽带接入等.LDmesh网络是点到点的链路,链路的干扰特性和传输特性与传统无线Mesh网络有显著不同,原有的基于CSMA的MAC协议不再适用,进而影响到上层协议的设计.分析了LDmesh网络的研究进展,从链路性能、MAC协议、路由协议及网络管理等方面深入论述了LDmesh网络面临的挑战和进一步研究方向.关键词IEEE802.11;长距离链路;无线Mesh网络;MAC协议;路由协议;网络管理1引言基于IEEE802.11的长距离无线Mesh网络LDmesh(Long-DistancewirelessMeshnetworks)指相邻节点间距离很长(长至几十到上百公里)的无线Mesh网络,它的节点采用廉价的大功率IEEE802.11无线网卡和高增益定向天线,以实现长距离信号覆盖[1].它使用公开ISM(IndustrialScientificandmedical)频段,无需缴纳频段使用费.耗电量低,可使用太阳能等清洁能源供电,不依赖市电供应,可以工作在极端恶劣的野外环境.与其它主流网络技术相比,无线局域网WLAN和传统无线Mesh网络通常部署在人口密集、经济较发达地区的室内/市内,覆盖范围小.光纤网带宽高,但是铺设困难、实施费用高.卫星链路虽然覆盖范围大,但是费用高.移动通信网如3G虽然能提供高带宽、广域覆盖,但是目前费用较高,而且主要集中在人口密集的大中城市.而LDmesh网络具有成本低、带宽高、覆盖广、易于部署和维护的特点,性价比高,可以广泛应用于偏远地区/人口分布稀疏地区的无线宽带接入.这些地区通常居民居住分散,地形地貌复杂,布线困难,经济发展较缓慢,受经济发展的制约,亟需性价比高的“草根”网络.另外LDmesh网络还可应用于野外大区域的宽带网络部署,如自然保护区(湿地、森林、草原)的环境监控,偏远地区的远程医疗和远程教育等.在我国大力发展西部农村经济,缩短东西部差距,建设新农村的政策方针以及保护绿色地球的背景下,研究LDmesh网络关键技术,推动其产业化具有重要社会和经济意义.近年来,国外的专家学者对LDmesh技术展开了研究.代表性研究单位有印度理工学院的Raman教授领导的小组和美国加州大学伯克利分校的Brewer教授领导的小组.Raman教授在2005年指出802.11的CSMA/CA协议在远距离传输时性能很差,提出了2PMAC协议,该文在无线网络领域国际会议ACMMOBICOM’05[1]上发表,确立了LDmesh的网络架构和干扰模型,成为目前最有影响的LDmesh网络的MAC协议.对长距离802.11链路性能的分析发表在MOBICOM’06[2]上.Ra-man教授在印度建立了大规模实验网络.Brewer教授对LDmesh进行了较为系统的研究,包括MAC协议、网络部署及网络管理等方面,研究成果发表在NSDI’07[3]、MOBICOM’08[4]等重要会议上,还在印度、加纳以及圣地亚哥海湾等地建立了实验网络.MOBICOM’10[5]发表了长距离无线网络管理方面的论文.一些国际大公司如Intel、IBM、Microsoft等也开展了研究和产品化工作,其中,Intel推出了基于802.11的RCP(RuralConnectivityPlatform)项目.从2007年开始,SIGCOMM设立了研讨会NSDR(ACMSIGCOMMWorkshoponNetworkedSys-temsforDevelopingRegions).2008年,MOBICOM也开设了研讨会WiNS’DR(ACMWirelessNet-worksandSystemsforDevelopingRegionsWork-shop),专门讨论面向发展中地区的低成本无线网络技术,远距离IEEE802.11是其重要主题.国内的研究刚刚起步.天津大学是国内较早开展长距离无线Mesh网络研究的单位之一,搭建了含多条长距离链路(最长20km)的实验床,并进行了初步的研究工作[6-7].目前国际上对LDmesh网络的研究主要集中在信道性能的测试和理解、MAC协议的设计、路由机制以及网络管理和维护等方面.本文分析了这一领域的研究现状,在LDmesh的概念和特点、面临的挑战、研究进展以及亟待解决的问题等方面展开了深入讨论.2长距离无线Mesh网络的基本概念和面临的挑战长距离无线Mesh网络LDmesh的架构如图1所示,通常有1个或多个Internet接入点,其它节点以多跳方式汇聚到Internet接入点.和常用的室内/外短距离(几十米到几百米)802.11无线网络相比,它采用了大功率无线网卡(如400mW发射功率)和高增益定向天线(高达30dBi).一个节点通常配备多块无线网卡,或者由多个互连的无线路由器组成,每个天线对应1条无线链路,因此在这种网络中,链路成了点到点的通信方式而不再是广播方式.而且单条链路距离很长,从几公里到几十公里甚至上百公里不等,目前实现的最长一条链路达382km[8].LDmesh最初用于发展中国家乡村无线接入[9],因此也被称为乡村无线Mesh网络(ruralwirelessMeshnetworks)、WiLDnet(WiFiLongDistancenetworks)等.LDmesh网络的主要特点归纳如下:(1)成本低.硬件成本低.节点主要由嵌入式网络设备、大功Page3率无线802.11网卡和高增益的天线组成.这些设备都是技术成熟的大批量生产的商品,因此价格较低.嵌入式网络设备不过几千元,大功率无线网卡和高增益天线都是几百元.通信塔成本低.设备重量较轻,通常不到1kg,所以通信塔的成本也较低,另外还可以借助地势或建筑搭建,使用普通杆支撑天线,两个节点间能直视即可,进一步降低了费用.功耗低.单个节点的典型功耗小于10W.在没有市电的地方完全可以采用太阳能、风能等清洁能源.运维费用低.使用ISM开放频段,无需缴纳使用费.也较低.综上,LDmesh网络不但建设成本低,运维费用(2)“点到点”的长距离无线链路.节点间由于距离较远,通常几公里甚至上百公里,使用大功率无线网卡和高增益的天线后,构成点到点的长距离无线链路,要求节点间可视.2.1面临的挑战LDmesh网络虽然是使用现有IEEE802.11设备构建起来的,但是由于其点到点的长距离链路特性和应用环境,使得它和传统的短距离无线Mesh网络有着本质的不同,因此原有的网络协议和机制不再适用,在链路性能理解、MAC协议、路由协议的设计以及网络配置和管理等方面都面临新的挑战.(1)长距离无线信道性能的研究链路性能是上层协议设计的基础,因此长距离无线链路的性能研究是LDmesh网络的关键基础问题.对传统短距离无线Mesh网络的链路性能有很多研究成果,然而在LDmesh网络中,链路的长度、运行环境和传统无线Mesh网络有很大差别.长距离链路中,信道衰落不同,短距离链路中的多径衰落不再是主要影响因素;外部干扰是造成丢包的主要原因,然而链路有的两端都在乡村/人口稀疏地区,有的一端在乡村一端在城镇,不同链路受到外部干扰的情况不同.另外所使用的高增益定向天线也会导致干扰模型的变化.LDmesh链路l(l=1,2,3,…)的丢包率Lossl和信号波长λ、链路长度d、物理层速率r及外部干扰强度Ie有关,可以粗略表述为下式:链路间的干扰则和链路夹角、发送功率、链路衰减等有关.假定A为网络中所有天线的集合,NA为天线个数.G(i,j)表示天线ai发送、天线aj接收的增益,d(i,j)表示天线ai和aj所属节点间的距离.则天线ai处受到其它链路的干扰可以表示为其中,Pj为天线aj所对应无线网卡的发送功率,PL[d]是距离为d时的链路衰减.增益G和天线方向图与链路夹角有关.(2)MAC层协议的设计原有CSMA/CA协议面临如下问题:ACK超时.802.11MAC协议采用停-等方式发送数据,即发出数据包后,要等到ACK返回后再发下一个数据包.如果超时则重传,直到超过重传次数.在长距离无线Mesh网络中,由于链路距离长,传播延迟较大,如果超过设定的ACK超时时间,就会导致不必要的重传,并有可能与接收方返回的ACK碰撞,浪费带宽.而且这种停-等方式对长距离链路来说效率很低.侦听机制失效.802.11MAC协议是为室内短距离环境设计的,发送端和接收端都在彼此的侦听范围内,发送端在发送时先侦听信道,如果信道空闲则发送,从而避免碰撞.然而在长距离链路中,由于传播延迟很长,节点在DIFS(DCFInterFrameSpace)时间内无法侦听到其他节点的发送信号,发送方和接收方可能同时发送数据而产生碰撞.相邻链路间干扰.一个节点通常有多条链路,这些链路间如果使用同一个信道或非正交信道,受定向天线副瓣的影响,干扰严重.(3)路由协议的设计由于LDmesh的链路都是长距离点到点的,邻居间干扰以及链路衰减特性与传统无线Mesh网络不同,因此链路质量的刻画也不一样,进而路由性能参数不同,所以路由协议也需要重新设计.Page4(4)网络配置和管理LDmesh网络节点间距离远,网络覆盖范围广.大多节点部署在野外,环境恶劣.因此一旦产生故障,定位和排除困难.在这种情况下网络管理尤为重要,高效的网络管理可以大幅节省运维成本,是LDmesh大规模应用的基础.3长距离无线信道性能的研究市内无线Mesh网络的链路性能研究较多[10-12],然而LDmesh网络通常搭建在乡村、野外等WiFi干扰源较少的区域,而且采用大功率无线网卡,高增益定向天线,链路长,且中间无遮挡.这些特点和市内无线Mesh网络完全不同,因此需要重写认识链路的性能,包括吞吐率、丢包率、链路间干扰、接收信号强度RSSI(ReceiverSignalStrengthInicator)等.本节介绍测量信道性能的实验方法以及对长距离链路性能的一些代表性测量和分析结果.3.1实验方法和手段3.1.1真实链路的实际测量采用上述的硬件平台搭建真实的长距离无线链路进行测量.使用Iperf①、pktgen②等测量工具.在测量丢包特性时,通常禁止MAC层ACK,将最大重传次数设为0.使用无线网卡驱动程序如madwifi记录每个发送和接收到的帧的细粒度信息.收集外部WiFi源的帧的信息:创建一个虚拟网络接口,和主接口使用相同信道,设为“monitormode”,这种方法和使用2个物理的网络接口效果相同.收集的帧的信息包括802.11MAC头部信息、IP数据、RSSI、物理层数据传输速率、时间戳、PHY错误和CRC错误、背景噪声等.3.1.2半实物环境下的模拟数,能重现实验场景.有如下两种方式.使用半实物模拟的好处在于可以调节测量的参(1)无线信道半实物模拟器Spirent5500.将链路的两端放在RF屏蔽的盒子里[13],中间用Spirent5500模拟器相连.Spirent5500可以精确模拟信道丢包、衰减和延迟扩散(delayspreads)等特性,因此能用于模拟不同长度链路的性能.(2)将链路两端直接用线缆相连,中间加上衰减器[14].改变衰减器的值,可以模拟信道衰落,进行有控制的实验研究.3.2802.11b信道性能3.2.1半市区(semi-urban)链路802.11b丢包率在LDmesh网络中,有很多链路都是半市区的,即一端在市区一端在乡村的链路.Patra等人[3]研究了semi-urban长距离链路的丢包特性.如图2所示,丢包率高且波动大.链路具有不对称性、突发性,低丢包率(1%~10%)长时间存在.突发丢包的到达近似为泊松分布,但是丢包持续的时间和丢包率的大小很难预测,没有规律可循.进一步分析丢包原因,发现外部WiFi干扰源是导致链路丢包的主要原因之一.多径衰落反而不明显,这和Roofnet等市内无线Mesh网络的丢包原因有很大不同[15].CSMA/CA协议是导致丢包的另一个主要因素,这是因为传播延迟增加,致使CSMA的侦听机制失效或链路层ACK超时重传,引起碰撞丢包,传输效率下降.3.2.2两端都在乡村的802.11b链路(1)差错率Chebrolu等人[2]在对DigitalGangeticPlains实验床及Ashwini网络中长距离链路大量测量的基础上,从链路长度、SNR(SignaltoNoiseRatio)、数据包长度、物理发送速率、天气等多个方面分析了802.11b链路差错率(errorrate)的性能.这些网络都部署在远离都市的乡村,大多数链路没有外部WiFi干扰.如图3所示,链路差错率和SNR的关系和理论相符,SNR在4~6dB时丢包率几乎为100%,大于6dB时丢包率几乎为零,即可以用SNR或RSSI来估测差错率[2,16],进而LDmesh网络的性能是可以预测的,这个结论和Roofnet的结果不同[11].差错率和链路长度没有直接关系,只和SNR有关.数据①②Page5包的长度对丢包率的影响不大.雨和雾等天气对链路性能几乎没有影响.外部干扰则对链路性能有很大影响.据此Raman指出,通过合理规划和部署,长距离链路可以达到预测的性能.(2)链路的吞吐率使用1400byte包长,采用MAC广播方式(没有ACK),当SNR大于5dB时,链路UDP吞吐率能接近理论值.在没有ACK超时的链路,TCP吞吐率也接近于理论值.然而在有ACK超时的链路,TCP的性能很差,物理层速率为11Mbps时,SNR为16dB,使用MAC广播发送,TCP吞吐率只能达到1.9Mbps.使用MAC单播发送(有ACK),TCP的吞吐率只有0.5Mbps.(3)相邻链路间的干扰在LDmesh网络中,一个节点要连接多条链路,每条链路有一个高增益定向天线和大功率无线网卡,这些设备通常都安装在一个通信塔上.由于电磁信号的泄露产生近场效应(near-fieldeffect),当一方天线位于另一方天线的近场时,相邻链路间会产生干扰.天线的近场可以用下式计算:df=2×D2/λ,其中D是定向天线的最大尺寸,λ为信号波长.按此式计算作者所使用的定向天线的近场为16m.两天线间的距离大于近场时,可以工作在正交信道上,互不干扰.天线的副瓣也会产生类似的干扰情况[17].3.3802.11a/g信道性能802.11a/g支持更高的速率(最大54Mbps),而且有更多的正交信道,只要合理部署就可以同时工作而不互相干扰,因此,对802.11a/g在长距离链路下的信道性能也进行了研究.天线方向、摆放位置以及信道间隔对长距离802.11g链路的性能有重要影响[18].实验结果表明,在同一信道上,夹角为从180°调到135°,链路吞吐率有明显提升.而信道间隔5(个信道)时,链路间基本上不干扰.将一个天线在垂直方向上升高1.2m,也会使干扰程度降低.El-Sayed等人[19]在距离市区120km的沙漠中,在没有外部WiFi干扰的情况下,就信号强度、自由空间损耗、延迟抖动和RTT等性能参数做了研究.将2个节点放在车上,一辆车固定位置,另一辆车不断向一个方向行驶以改变链路的距离.测量了链路长度从1km~7km的性能.RTT从30ms增加到360ms,延迟抖动从0增大到接近40ms,信号强度从-54dBm衰减到-92dBm.自由空间信号损耗和链路距离有关,符合Hata/Okumural模型.Gupta等人[16]测量了乡村无外部WiFi干扰环境下,较短802.11g链路的性能(最长1.2km),认为和802.11b长距离链路一样,链路差错率和RSSI相关,当RSSI在一定范围内,差错率分布从0到100%,毫无规律可言.然而RSSI超过某一数值后,差错率接近0.这一结果和无外部WiFi干扰下802.11b链路的结果相符[16].4长距离无线Mesh网络的MAC协议MAC协议是影响长距离无线Mesh网络性能的关键技术.IEEE802.11采用的CSMA/CA协议是面向短距离通信设计的,在长距离链路中性能很差,因此新型MAC协议的设计是研究的热点问题.由于长距离Mesh网络中一个节点通常配有多个无线网卡和定向天线,因此既可以使用单信道(即网络中所有链路都工作在同一个信道上),也可以使用多条正交信道.根据MAC协议使用的信道数量,可以将其分为两类:“单信道MAC协议”和“多信道MAC协议”.使用单信道有以下优点:(1)方便管理,长距离链路使用一个固定信道,接入网络使用其它信道可以避免对长距离链路的干扰.(2)在某些地区/国家,802.11a在户外使用要收费,因此使用单信道可以节省成本.(3)如果使用802.11b,只有3个可用的正交信道,可能不够分配.因此基于802.11b的LDmesh网络通常采用单信道MAC协议.而拥有更多正交信道的802.11a则常采用多信道MAC协议以提高网络吞吐率.下面进行详细介绍.4.1单信道MAC协议使用单信道MAC协议面临的最大问题是同一个节点使用相同信道时产生的链路间干扰.具体来Page6讲,如图4所示,由于安装在同一个通信塔上,天线间距离有限,又都是高增益的,副瓣干扰很严重,导致同一个节点的链路不能一个发送一个接收(Mix-Rx-Tx),只能同时发送或接收(Syn-Rx,Syn-tx),而且链路间夹角α必须大于30°才能避免干扰.因此CS-MA的竞争信道方法性能很差,只能使用TDMA方式的MAC协议.2PMAC[1]是最早提出的面向长距离链路的MAC协议,此后的MAC协议,无论是使用单信道还是多信道受此协议影响颇深,尤其是单信道协议均是在此基础上进行的改进,如WiLDNet[3]、JazzyMAC[4]和JaldiMAC[20]等.下面详细介绍2PMAC,并对其它协议逐一进行评述.图4同一节点2条链路发送、接收状态(Syn-Rx:同时接收;Syn-Tx:同时发送;Mix-Rx-Tx:混合发送接收)[1]4.1.12PMAC2PMAC[1]协议是Raman等人提出的一种基于固定时隙TDMA的MAC协议.基本思想是:一个节点的所有网络接口(无线网卡)同时接收(SynRx)或是同时发送(SynTx)数据,当一个节点转换状态时,它的所有邻居节点也同时进行状态转换.由于节点处于发送或接收两种状态,因此称为2P(2Phases)MAC.图5是4节点网络2PMAC协议运行情况,线上的方块表示发送时隙,线下的方块表示接收时隙.在初始时隙,节点A和C处于发送状态,A向B、D节点同时发送数据,C向B和D同时发送数据.下一个时隙,A和C切换到接收状态,B和D切换到发送状态,由B和D同时向A和C发送数据.以此循环往复,不断进行状态切换.其中的关键问题是如何进行节点间同步以及状态转换.2PMAC使用marker包解决这一问题.它采用固定长度的时隙,即节点每次发送和接收的数据长度是固定的.如图6所示,当节点的所有接口发送完固定个数据包之后,发送一个marker包进行同步.当发送节点的所有接口都发送了marker包之后,该节点由发送状态切换到接收状态.处于接收状态的节点等所有接口都收到marker包之后,从接收状态切换到发送状态.marker包有可能丢失,影响状态的同步切换.2PMAC引入了超时机制来应对这一问题,如果接收端在一段时间之内都没有收到marker包,就自动转换到发送状态,避免由于marker包丢失导致的无限期等待.在失去同步之后的一个“发送-接收”周期之内,如果不发生丢包的情况,就可以重新回到同步的状态.另外,同一节点不同网络接口间的同步也是需要考虑的问题.由发送状态向接收状态的转换一定是同步的,因为所有的接口同时开始发送数据,发送数据的数量及速率又是相同的,所以它们会同时完成发送.而由接收状态向发送状态转换则可能出现marker包丢失的情况.在复合节点的情况下,同一节点的多个接口通常使用hub进行有线连接,因此可以采用NOTIF机制,即当一个接口发送完数据后,通过有线链接广播一个notification(NOTIF)消息给同一节点的其他接口;每个接口都收到其它所有接口发送的NOTIF后,节点就切换到发送状态.2PMAC的不足在于,采用了固定时隙的TDMA,即发送节点每次发送的数据长度是一定的.如果一个节点没有数据发送,也要发送无意义的字节,以维持同步;而如果一个节点有大量数据要发送,每次也只能发送规定的字节数,因此,固定时隙的TDMA不够灵活.2PMAC需要Marker包进行同步,一旦Marker包丢失需要花费一定时间重新建立同步.另外,2PMAC要求同一链路的2个端节点处于不同的状态(发送/接收),因此Mesh网络的拓扑必须是二分图,限制了2PMAC的应用范围.Page7WiLDNet认为2PMAC不适用于有损环境,marker包的丢失会在网络上引起连锁反应,因此引入了“隐式同步”(implicitsynchronization)机制.考虑一个连接(A,B),其中A是发送者,B为接收者.tsend_A、trecv_B分别表示A发送时隙、B接收时隙的开始时间.所有A发送的包都有一个时间戳,记录包的发送时间t1与时隙开始时间tsend_A的差值δ.当B在时刻t2收到一个包时,B的时隙开始时间修改为trecv_B=t2-δ.当B的接收时隙结束时,并且tsend_B=trecv_B+T,B开始发送.这样就避免了由于marker包的丢失而造成的延迟.实验结果表明,WiLDNet有效消除了双向链路中的冲突,避免了相邻链路间的干扰,它的自适应恢复机制能够很好的适应有损环境.但是,在干扰模式没有规律的情况下,WiLDNet的FEC机制很难发挥作用.4.1.3JazzyMac4.1.2WiLDNetWiLDNet[3]在2PMAC基础上进行了改进,依然采用固定时隙,不同之处在于:(1)使用基于滑动窗口和FEC(ForwardErrorCorrection)的可靠传输协议,(2)引入“隐式同步”机制,放宽了节点间同步的要求.WiLDNet用基于滑动窗口的流控制方法替代传统的802.11的停等协议.接收节点发送BulkACK,对上一时隙中收到的所有包进行确认.BulkACK可以附加在数据包的后面,也可以作为一个单独的包发送.为提高数据的正确接收率,实现了基于包间FEC的自适应恢复机制.JazzyMac[4]对2PMAC的改进主要有以下3点:(1)采用可变长度的时隙.根据实际流量动态调整发送时隙的长度,实际操作中使用每条链路发送队列的长度来确定发送时隙的大小,为避免忙的链路占用太长时间以保证公平性,规定了一个最大时隙长度.(2)使用令牌进一步放宽了对同步的要求.网络中每条链路都有一个令牌(token),该令牌用于确定链路两端的节点接口的状态:发送或接收.只有当一个节点所有接口都持有令牌时,才能从接收状态切换到发送状态;一个节点只有释放了所有接口的令牌之后才能切换到接收状态.令牌和超时时间的使用确保该协议不会死锁,也不会有链路因得不到发送机会而饿死.(3)拓展到任意拓扑结构.对网络拓扑不再有二分图的限制.给出了两种解决办法:顶点着色法和最大切(maximumcut)方法.前者首先计算拓扑的最小顶点着色数K,节点根据自己的颜色循环发送数据,不同颜色对应不同时隙,因此,每个节点每K个时隙发送一次数据.对于二分图,K=2.最大切方法先计算拓扑结构中包含所有节点的最大二分子图,即原图中的最大切.然后在这个最大切子图中使用2PMAC,其它的边作为备用链路.仿真结果表明,JazzyMac提高了网络的最大吞吐率.吞吐率的提高不只是针对特定的拓扑结构和流量模式,而是具有一定的普遍性,其中,在不对称的流量模式中提高最明显.JazzyMac的缺点是计算复杂度高.虽然该协议是分布式的,只需要局部的信息,但是令牌的初始化分配却需要借助全局信息.4.1.4JaldiMac在构成LDmesh网络的硬件设备中,耗资最大的是通信塔,它的投入几乎占据了成本的60%以上.减少通信塔的数量是消减成本的有效手段.可以借助地势如山顶、建筑等,使用点到多点通信方式,如图7所示,在增大覆盖范围的同时减少通信塔的数量.因此,与前面介绍的几种协议不同,JaldiMac[20]致力于解决点到多点的通信问题.图7LDmesh网络中点对多点的通信方式[20]JaldiMac采用轮询方式,主站(master)为每个子站(station)分别传输下行数据,并通知子站分配到的上行时隙长度.考虑到实际网络流量的不对称性,重新定义了TDMA时隙的分配方式.每个基站根据需要传输的数据量向主站提出请求,主站根据请求将带宽按比例动态分配.根据应用对带宽、延迟、抖动等不同的要求,把应用分成了不同的服务类(serviceclass).并提出了区分服务的调度算法,以满足应用的要求,保证多媒体业务的QoS(QualityofService).由于采用了轮询的方式,子站需要向主站提出请求以获得需要的时隙,产生了一定的开销.另外,点到多点的通信模式过于依赖主站的处理能力,一旦主站出现故障,整个网络就会瘫痪.Page84.2多信道协议从上一节可以看到,单信道MAC协议只使用一个信道,减少了频率污染,但是相邻链路间干扰严重,因此需要设计复杂的协议解决由此引发的问题,如发送/接收同步问题、网络拓扑的二分问题等.多信道的MAC协议可以为相邻链路分配互不干扰的正交信道,因而避免了相邻链路间的干扰.但是多信道引发的问题则是子网的划分和信道的分配.下面介绍LDmesh网络中几种主要的多信道MAC协议.4.2.1基于802.11b/g的多信道MAC协议2PMAC的主要问题有两个,一是网络拓扑必须是二分图,这点限制了2PMAC的应用范围;二是发送和接收时隙长度相同,且固定,当链路上行和下行的网络业务不对称时造成带宽的极大浪费.这些问题是继2PMAC之后的单信道MAC协议所致力解决的.Raman则从多信道角度提出了上述问题的解决方法[21].他把网络划分成多个信道子图,使每个信道子图都是二分图,子图内部使用相同的信道,采用2PMAC协议,相邻子图间使用正交信道,因此子图间的通信不会相互干扰而且是相互独立的.文中针对802.11b/g链路,有3个正交信道,因此把信道子图划分看成是3边着色问题.证明了当节点度数小于5时,存在3边可着色的信道分配方法.为实现按照业务量分配时隙长度,定义了DF(DesiredFraction)和AF(AchievedFraction),即一条边一个方向上需要的带宽占信道容量的比例以及可得到的带宽比例.提出了ZMCA(Zero-MismatchChannelAllocation)信道分配算法,证明了ZMCA是NP完全问题.将ZMCA转化为最小化AF和DF之差的信道分配优化问题,该问题是NP-hard,因此提出了启发式方法并进行了性能评价.这种方法尚存在以下问题:文中假定所有链路的权重相同,然而在实际网络中并非如此,链路的重要性并不相同.另外DF的确定比较困难,需要考虑到路由、Internet接入点的部署等问题,而且DF还可能是动态变化的,因此动态信道分配是一个系统设计问题.再有,在信道分配中没有考虑同一节点的相邻链路间的夹角的限制,事实上链路间夹角小于一定角度就会相互干扰,应该分配给它们正交信道.解决方法中假定节点度数小于5也是一个限制条件,在规模较大的网络中,节点度数就有可能超过5.4.2.2K个可用正交信道的MAC协议Dutta等人[22]在文献[21]的基础上考虑了更一般的情况,即有K个(1<K<11)正交信道的情况.把LDmesh网络建模为无向图G=(V,E),考虑了从源节点到目的节点的端到端业务需求.给定K个可用正交信道,由于同时工作的二分子图需要使用不同的信道,最多有K个二分子图同时工作.因此需要找到能够覆盖整个网络的K个二分子图.提出了一种分割算法,迭代使用该方法,如果保证每次都能得到图的最大割,则每个源到目的的业务至少有λ部分可以通过路由满足,在最坏情况下K个二分子图中能够为每个源和目的节点路由的业务比例为2K+log(|E|(λ=Ω2Kλ度数小于2K-1时,原Mesh图中的业务在K个二分子图中也可以满足.在二分子图内部使用2PMAC协议进行业务调度,由于2PMAC协议使用固定时隙,因此作者提出一个启发式算法把具有相似业务需求的链路聚合到一个二分子图中.使用仿真验证了所提的算法和协议.和文献[21]相比该协议放宽了对可用信道数目的要求,并给出了最坏情况下能够满足的业务量的下界,而且考虑了链路两边业务需求的不对称性.但是它的计算复杂度依然很大.使用最大割方法求二分图是NP-hard问题,文中使用局部搜索近似算法实现.对于链路两边的流量需求不同的情况,则要将需求相近的链路聚合到一个二分图中,这也是个NP-hard问题,文中使用启发式贪心算法实现,这些近似算法都增加了该协议实现的复杂度.4.2.3基于有向图的多信道MAC协议单信道LDmesh网络中,相邻长距离链路间相互干扰,采用同步发送和接收(Syn-Tx-Rx)机制虽然避免了链路间干扰,但是单向链路的利用率最多为50%,甚至更低.为提高链路的吞吐率,Dutta等人[23]提出一条链路采用两对不同发送方向、正交信道的链路组成,实现同时收、发数据而不需要同步,如图8所示.这样,链路可以建模为双向有向边,信道分配问题转化为有向边着色问题,其中每个信道对应一种颜色.对一个节点来说,为避免发送和接收Page9的干扰,进入的边和出去的边要使用正交信道,在这种约束条件下,要使总的信道数目最少,即最小化有向边着色问题.文中给出了一个启发式实现算法.这种方法在一个节点处能够同时发送和接收,不用考虑节点间的同步问题,具有很大的灵活性.但是一条链路需要配置两对无线网卡/设备、两对定向天线,因此成本成倍增加.另外,据Raman的测试结果[19],既便正交信道,链路间夹角小于30°也会相互干扰,如果如图8所述使用两条平行的正交信道构成一条无线链路,在实际部署中也会遇到问题,然而文中并没有具体论述,而且实验中只使用了两条链路,其中一条还是短距离(250m)的,实验结果缺乏说服力.5长距离无线Mesh网络的路由协议目前的研究大多集中在MAC层,路由协议的研究成果较少.长距离无线Mesh网络的规模较小时,如只有几条链路、若干个节点的情况下,路由并不是个问题,手动配置静态路由即可.然而当网络规模增大,要为用户提供高质量的网络服务时,端到端的路由就成了要解决的关键问题之一.和传统无线Mesh网络不同,LDmesh网络的点到点链路与广域有线网络如Internet有些类似,但是链路特性不同,因此天津大学网络研究所将Internet中保证端到端服务质量的约束应用于LDmesh,提出了基于MAR的QoS路由[7].另外,Dutta等人[24]应用网络流方法提出了和调度相结合的路由.下面分别介绍这两种LDmesh网络的路由机制.5.1基于MAR的QoS路由算法在LDmesh网络中需要支持多种业务类的传输,带宽估计和预留是保证服务质量QoS的关键.在传统的使用全向天线的短距离无线Mesh网络中,邻居节点间相互干扰,带宽估计常使用1跳或2跳干扰模型,计算和实施困难.而使用基于2PMAC协议的LDmesh网络中,链路是点到点的长距离链路,一个节点的相邻链路同时发送或接收数据,消除了链路间的干扰,这种情况和广域有线网络类似,只是链路的特性不同,由此可将Internet上成熟的QoS保证方法应用到LDmesh网络中.MAR(Max-imumAllocationwithReservation)是Internet中成功应用的一种区分服务的带宽分配方案,可以有效实现带宽分配、隔离与保护,能够使业务的准入最多、业务准入后带宽不被抢占.将MAR引入LDmesh网络的带宽分配,可以根据LDmesh网络的MAC协议特点,设计新的带宽估计和分配方案[7].和DSR路由机制相结合进行了仿真实现,可以为各业务类的带宽实施动态的保护,在网络没有发生拥塞时所有业务类共享所有的可用带宽,一旦网络发生拥塞便对业务类的分配带宽进行保护.在MAR模型的基础上对进入网络的业务流进行准入控制,对允许进入的流进行带宽预留,保证QoS业务的带宽需求,并为每条进入网络的流提供一条最大可用带宽的路径.能为不同速率和延迟要求的实时业务提供参数化的QoS.5.2和调度相结合的路由机制Dutta等人[24]考虑点到点链路的LDmesh网络,使用基于2P的MAC协议.给定源到目的节点的业务流量需求,将路由和调度机制相结合,把问题转化为带约束的线性规划问题,使用网络流和多段图边着色的方法给出了近似算法.具体来说,将网络建模为有向图G=(V,E),C(e)为链路e的容量,给定M个从源到目的节点的业务流量需求,rk表示从源sk到目的dk的第k个流量需求的速率.B为G的有向二分子图的集合,在一个时隙中所有处于发送状态的链路构成B的一个子集,任意调度可以表示为带权重的Bi∈的组合,权重为该子集所占时隙的比例.给定调度π,令wB1,wB2,…,wB||为权重,1e,Bi为示性函数(当链路e在有向二分子图Bi中时值为1).可以表示为带约束的线性规划问题,如图9所示.图中Nin(v)和Nout(v)分别表示节点v所有进入和出去的边的集合.f(e,k)为满足第k个需求的链路e上的负载.图9中式(2)~(5)是网络流的约Page10束,式(6)和(7)为调度的约束.线性规划为所有二分子图和相应链路流量找到最优化的权重,虽然能给出最优解,但是计算复杂度很高.因此文献[24]提出了基于多段图边着色的近似调度算法.只从理论上分析了近似解与最优解的差的下界,并没有给出仿真或实验结果.6长距离无线Mesh网络的配置和管理Surana等结合在印度做的两大LDmesh实验网络AirJaldi和Aravind[25-26]总结了网络管理的经验,认为LDmesh网络管理的最大问题是运行环境比较恶劣,包括自然环境和人为环境.比如乡村电力供应不稳定,会烧毁设备;安装在野外的设备会遭偷窃;当地管理人员技术水平太低,处理故障的能力有限;网络配置错误等.一旦出现链路故障(网络不通),节点分布范围较广,交通不便,到现场依次排查故障节点很困难.因此网络管理和故障诊断及定位对LDmesh的正常运转非常重要,但是只依靠LDmesh网络本身传递网络管理信息很不可靠,现有研究成果通常借助于第三方通信手段或独立的硬件平台来提高网络管理的效率.6.1基于第三方通信手段的管理Surana等[25-26]在LDmesh网络管理中运用了多种第三方通信手段,包括VSAT(VerySmallAp-ertureTerminal)卫星系统,移动通信系统CDMA、GPRS,构成多条备用链路,监测节点运行状态、辅助诊断故障点并推断起因.摈弃网络管理中常用的轮询收集数据的方法,采用主动上报运行状态的方案,称之为“PhoneHome”.针对LDmesh运行中出现的问题,采用电力控制获取清洁稳定的电源供应,启用软件看门狗和硬件看门狗应对软硬件“死机”故障,积极培训当地的网络技术人员.然而借助第三方通信手段会增加运营成本,而且有的节点部署地可能没有移动通信网络的覆盖.6.2基于独立硬件平台的管理英国爱丁堡大学的Bernardi等人[5]提出独立的硬件平台和软件工具解决网络管理问题,在网内执行监测和控制,网内存储管理数据,把工作流的方法应用到网络管理中,不再使用传统的SNMP.提出了两个设计原则:(1)面向目标的管理;(2)网络就是NOC(NetworkOperationsCenter).前者采用高层次的基于工作流的可视化建模语言(StixL)表述网络管理的活动(activities),使得网络管理者更多的关注网络管理对象和相关活动规范而不是底层的细节.后者使用分布式协作代理管理架构来监测和控制,将管理代理(StixAgent)推到设备方近距离监控.工作流语言在网络中的StixAgents中转换为XML文件,直接产生可执行代码.Stix的另一个特点是网络管理活动的执行,如监测统计数据,都会被网络中StixAgents做为日志记录下来,再使用Sprinkle机制实现日志覆盖网络(logoverlay).管理者可以根据需要访问存储在日志覆盖网络中的管理数据,使用StixView异步获取数据.StixView采用类似WiKi语法和类似SQL的查询语句,基于Web页面的访问方式.这样就将网络管理活动的执行和结果的访问分离开来.Stix还在StixAgents中提供了设备管理作为“硬件抽象层”把软件和硬件分离,以便支持不同厂商的设备.7长距离无线Mesh网络的应用7.1硬件平台在LDmesh网络中,由于一个节点通常连接多条链路,而每条链路都需要一块网卡和一个定向天线,因此有两种实现方法:(1)节点采用一台支持多个无线网卡的嵌入式设备.(2)采用如图1所示的方法:多个带有一块网卡的嵌入式网络设备(无线路由器)通过hub有线相连,组成一个“复合节点”.由于多块网卡插在同一台设备上,距离较近,容易相互干扰,既便工作在同一频段的正交信道上干扰也很严重,只能工作在不同频段(如2.4GHz和5GHz)[15],这样最多只能插两块网卡(802.11b/g,802.11a),因此第一种方法应用较少,实际使用中多采用后者,即“复合节点”.表1汇总了文献中曾采用的主要节点设备、大功率无线网卡和定向天线等的情况.7.2典型应用(1)偏远乡村宽带接入网络解决发展中国家偏远乡村的宽带无线接入是LDmesh的初衷,低成本和高带宽成为该项技术的杀手锏.美国加州大学伯克利分校在印度北部建立的AirJaldi网络,如图10所示,目前有8条长距离链路,10km到41km长,主要为村民提供网络接入和VoIP服务,用户达1万人,覆盖范围方圆100km.LDmesh高性价比也受到一些发达国家的青睐,用于人口分布稀疏地区的无线宽带接入,如丹麦①等.①http://djurslands.net/biblioteket/international/djurslands_net_english_presentation.ppt.Page11表1主要LDmesh实验网络的硬件平台汇总MadWifi无线网卡驱动实验网络AravindNetwork1266MHzx86Geode单板机,功耗AirJaldiNetwork2LinksysWRT54GL,200MHz,16MBTJUtestbedWiZiTJUwirelessrouter,400MHz,Plainstestbed3Soekrisnet4521,net4501,PebbleLinuxSenao2511CD,基于Prisms2芯片组的DigitalGangeticQuailRidgereservation4注:1AravindEyeCareSystem.http://www.aravind.org;2AirJaldiWirelessNetwork.http://summit.airjaldi.com;3DigitalGangeticPlains.http://www.iitk.ac.in/mladgp/;4QuailRidgereservation.http://nrs.ucdavis.edu/quail.html(2)人口分布稀疏地区的远程医疗和教育美国加州大学伯克利分校在印度南部建了9条点到点长距离链路的无线Mesh网络,如图11所示,链路长度从1km到15km不等.节点安装在通信塔上(塔高24m到42m),或者装在房顶、烟囱上.将5个村庄的眼科诊所连接到Aravind的眼科医院,支持视频会议,开展远程医疗.每个月远程诊治大功率无线网卡3000名乡村患者,每年约50万患者通过网络治疗眼疾.该网络将拓展到50个诊所,5所医院.在加纳建的长距离无线Mesh网络,含5条链路,为加纳大学提供Internet接入和远程教育.(3)其它应用LDmesh网络能提供高带宽,因此可广泛用于远距离、大区域的视频监控,如自然保护区等大范围环境监控、长距离输油管道监控、地震监测点的监控等.3G网络的费用目前依然居高不下,GPRS/CD-MA又难以满足实时高分变率视频的传输带宽需求,LDmesh无疑是最佳选择.LDmesh还可以和无线传感器网络互联,以实现环境监测和视频监控的一体化解决方案.8尚存的问题及可能的研究方向高效简单的MAC协议及标准.现有LDmesh网络中的MAC协议均是TDMA类型的,受相邻链路间干扰条件的制约,使用相同信道的相邻链路只能同时发送或者同时接收数据,需要进行链路间同步.一方面,链路是半双工的,单向传输的链路利用率只有原来的50%.另一方面,随着网络规模的增加,链路间同步很复杂,开销增大,而且容错性也降低,网络性能受限.因此需要进一步研究高效、简单的MAC协议,以下方向可供探讨:(1)采用软件无线电平台,借助物理层技术解决链路间干扰问题.(2)引入新的无线网络技术,如802.11n,在此基础上设计新的MAC协议.另外,现有的LDmesh网络的MAC协议,如2PMAC,WiLDnet在仍然采用CSMA/CA协议的大功率802.11网卡的基础上实现,需要更改网卡的驱动程序来实现类似TDMA的功能.虽然能节约成本,但是实现起来很困难,而且并不是所有型号的Page12大功率无线网卡都支持禁止载波侦听和禁止ACK,大规模的商业应用受到限制.因此,需要尽快制定LDmesh网络的MAC标准,以推动低成本的适用于LDmesh网络的无线网卡的生产制造.低能耗绿色网络协议.由于LDmesh网络部署在人烟稀少的野外,有些节点没有市电供应,或者电源质量很差,因此只能使用如太阳能、风能等清洁能源.目前这些能源的转换效率较低,而且价格较高,因此电源供应很有限.但是为提供长距离传输能力,又必须采用大功率无线网卡(如400mW).因此网络协议的设计需要低能耗.目前,网络协议的研究多集中在数据链路层,即MAC协议,对上层协议的研究较少.随着网络规模的增大,上层协议,如网络层、传输层协议的设计对网络性能有重要影响,而且,在长距离环境下,链路性能、MAC协议与传统无线Mesh网络不同,导致原有的路由协议及路由性能参数未必能适用.另外长距离链路中传播延迟大,造成端到端的延迟大幅增加,TCP协议的性能也会受到影响.因此考虑节点能耗的网络层、传输层协议的研究是进一步研究的重要方向.轻量级网络管理和维护工具.LDmesh网络的节点多部署在野外,无人值守,节点间距离远,人为排查故障十分困难,因此方便实用的轻量级网络管理和维护工具是LDmesh网络推向实用化的重要保障.但是网络管理和维护工具的设计面临诸多挑战:LDmesh网络的链路丢包率高,带宽利用率低;由于电源供应受限制,节点采用低功耗嵌入式硬件设备,因此处理能力和存储能力很有限;第三方通信手段如移动通信网络可能覆盖不到节点所处位置;因此需要研究轻量级的网络管理和维护的工具.9结束语和现有远程接入网络如卫星通信、移动通信CDMA/GPRS/3G等相比,长距离无线Mesh网络LDmesh具有显著的优势:成本低、带宽高.这种网络覆盖范围广,安装简便灵活.可以布署在偏远/人口分布稀疏的地区,应用于野外大区域的数据监控,如地震观测台数据的收集、自然保护区的监控等,因此LDmesh网络具有重要理论价值和潜在的社会、经济效益.LDmesh网络在国际上从2005年开始有研究成果发表,在印度等发展中国家以及一些发达国家的人口稀疏地区得到了初步应用,近年来在网络领域国际会议上如SIGCOMM、MOBICOM、NSDI等陆续有文章发表,也有一些研讨会.然而在我国尚未引起足够重视.LDmesh网络在我国有广阔的应用前景,尤其在我国西部农村的信息化建设以及脆弱的野生生态环境保护方面.另一方面,LDmesh网络距实际应用还有很多关键技术问题有待进一步解决.因此我们根据课题组的研究情况,综述了LDmesh网络的研究进展,并指出了可能的研究方向,希望能起到抛砖引玉的作用,引起国内专家学者以及政府、工业界的重视,推动LDmesh网络在我国的发展和应用.
