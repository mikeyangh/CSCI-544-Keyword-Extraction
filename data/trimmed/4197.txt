Page1一种基于波动类型识别的路由节点行为预测算法夏怒李伟罗军舟于枫陆悠(东南大学计算机科学与工程学院南京211189)摘要路由节点行为预测可以为网络安全管理以及路由行为评估机制等提供重要的决策依据,而现有的路由节点行为预测算法存在诸如依赖专家经验、对样本要求较高以及在节点行为波动较大的情况下预测准确度下降等问题.为克服上述问题,该文在灰色预测模型的基础上提出了一种路由节点行为预测算法,该算法将路由节点行为序列中的波动类型被分为突发波动和迁移波动,结合Markov预测模型实现波动类型识别,随后基于不同的波动类型设立相应的未来行为值预测方法:对于突发波动,预测方法基于平滑级比序列的灰色预测结果;对于迁移波动,预测方法基于路由节点行为序列的灰色预测结果.最后,使用Markov模型对预测结果进行修正.实验结果表明,相比于已有的节点行为预测算法,该文的预测算法在预测精度上有较大提升.关键词路由节点行为预测;灰色预测模型;波动类型识别;网络行为1引言在网络中,路由节点担负着数据传输的责任并在保持网络端到端的连通性方面扮演着重要角色,因此当路由节点自身出现故障或遭受恶意攻击[1-2]后将严重影响数据传输以及网络的可达性.如果能够实现对路由节点行为的准确预测,将可为网络安全管理以及路由行为评估机制等提供有效的决策依据.Mizrak等人[3]指出路由节点行为可以分成两类:数据层面行为和控制层面行为.其中数据层面指的是数据报文转发行为,可能存在的恶意行为如数据丢包、报文错误转发以及数据篡改等.控制层面指的是路由通告的转发行为,可能存在的恶意行为主要有发送虚假路由通告等.因此,对路由节点行为好坏的判断可以基于一些指标如数据丢包率、数据错误转发率、转发流量以及路由通告的稳定性(包括前缀热度以及前缀可达时间等)等.上述行为指标具有非线性和突发性等特征,往往呈现出如平稳伴随着波动、不规则的周期变化以及部分随机性等状态,由此导致路由节点行为的变化规律往往难以把握,预测难度较大.随着网络的不断发展,路由节点行为的非线性和突发性进一步加剧,一些使用传统模型如Markov模型、Poisson以及AR模型的行为预测方法已经不能满足高准确度预测的要求.为提高预测精度,一些预测方法采用能够捕捉序列非线性特征的数学模型,如基于神经网络的路由节点行为预测模型[4-5],基于小波模型[6-7]、模糊模型[8]以及灰色模型[9]的网络行为预测模型.在这些行为预测模型中,神经网络具有一定的学习功能可以弥补传统线性预测模型的不足,但是在样本空间较小的情况下其学习精度难以保证,同时对于神经网络的层次结构、神经元数、训练方法上的设置尚无一个比较明确的理论依据,因此需要依赖于人的经验.小波分析是处理非平稳网络行为序列的一种有效方法,其可以将复杂的网络行为序列分解成近似不相关的行为序列,从而便于使用传统的预测方法对分解后的序列进行预测,但是小波分解的层数需要由人确定,这不仅增加了算法的复杂度,同时又不可避免的如神经网络预测模型那样依赖专家经验.模糊预测利用实时信息对目标函数不断滚动优化并根据目标实际输出修正或补偿预测模型,其比较适用于复杂的工业流程,但是模糊预测面临的问题有如规则庞大、制定方法复杂以及具有一定主观性需要依赖经验信息等.相比于上述模型,灰色预测模型[10]具有如下特点:在小样本状态下(样本数据不少于4个)即可实施预测、无样本分布要求、不依赖专家经验并且对于波动较小的数据具有较高的预测精度.文献[11-12]对灰色建模的理论基础进行改进,优化了初始迭代点和背景值等参数,改进后的灰色预测模型对于较小波动和具有趋势行为数据的预测准确度有明显提高.然而文献[13]指出灰色预测模型在行为数据波动较大情况下存在预测精度下降的问题.为提高灰色模型对于波动较大行为数据的预测精度,文献[14]将灰色预测结果作为一条基线,并结合Markov模型[15]修正预测准确度,然而在初期样本空间不足并且数据波动较大的情况下,灰色预测的基线与实际数据曲线存在一定偏差,同时Markov模型在数据样本较小的情况下也无法有效找到数据变化的规律,此时结合Markov模型反而可能会进一步增大预测偏差,因此简单的以灰色预测为基线结合Markov调整偏差的方法只能有限的提高预测精度.基于上述问题,本文在灰色预测模型的基础上提出一种路由节点行为预测算法,在该算法中路由节点行为序列中的波动类型被分为突发波动和迁移波动,并通过Markov预测模型实现波动类型识别,随后基于当前路由节点行为值所属波动类型设立了相应的未来行为值预测方法,最后使用Markov模型对预测结果进行修正.基于实际数据的实验结果表明本文算法的预测精度相比于灰色预测算法有较大幅度提高.本文第2节介绍路由节点行为值的波动类型识别方法;第3节详细阐述路由节点行为预测算法;第4节基于实际数据验证本文预测算法的有效性;最后一节对本文做出总结并对未来工作进行展望.2路由节点行为值波动类型识别一个复杂的路由节点行为序列中往往会包含较多的波动值,波动值的出现会破坏数据变化的趋势性从而会对预测造成较大的干扰,本文预测算法是基于对路由节点行为值的波动类型识别,因此首先需要对波动类型进行分类以寻找出行为序列中的波动值,随后才可以基于历史波动类型的交替规律实现未知波动类型识别.2.1路由节点行为值波动类型为便于描述,将路由节点行为序列设为X=Page3{x1,x2,…,xn},其中xi为第i周期的行为值,行为预测的目标是基于已知序列X预测出第n+1周期的行为值,将预测值设为xn+1.定义1.波动值是在给定的一段行为序列中与其它时刻行为值有显著不同的行为值.定义2.突发波动只干扰波动出现的那一刻的行为值,对后续序列无影响,具有突发性.定义3.迁移波动不仅干扰波动出现那一刻的行为值并会对后续序列产生一定影响,导致行为序列发生如水平迁移以及趋势改变等变化.定义4.级比序列由相邻行为值的比值构成,表示为σ={σ1,σ2,…,σn-1},其中有σi=xi+1/xi.由灰色预测模型[10]可知,对于序列X的级比序列σ,如果满足|max(σi)-min(σi)|0.2,则称序列X为平滑序列.由于一个复杂行为序列不可能保证整体平滑性,因此可以使用灰色预测模型的平滑标准将序列分割成一个个区间,本文将这些区间称为分组并用Xj表示.通过分组,可以找出序列中存在的波动值,设两个连续的分组为Xj和Xj+1,其中Xj包含m个行为值,根据分组标准必然满足1/xj|xj+11称为相对于分组Xj的波动值.然而通过实验发xj+1现,使用固定的0.2作为分组标准有可能将一些正常行为值误判为波动值,这是因为在数据曲线呈现较大斜率升降的情况下,一些具有趋势性变化的数据之间的关系却满足|σi-σi-1|>0.2,因此如果仍然将0.2作为分组标准必然会导致部分具有趋势性变化的数据被误认为波动值.为解决这个问题,本文采用动态分组标准θ,设已知行为序列的级比序列为σ={σ1,σ2,…,σm},θ的计算方法如下式所示:式(1)中min(σ)为级比序列的最小值,动态设置θ的意义在于:对于平滑的序列,较小的θ值便于发现波动.对于波动较大的序列,较大的θ值对于平滑部分的分组是没有影响的,因为级比变化小于0.2的部分在θ>0.2的情况下仍然会被划分到平滑分组.分组值增大的好处是可以将更多的变化具有趋势性但是幅度较大的行为值纳入一个平滑区间,减小了将这类行为值误认为是波动的可能性,因此使用动态分组值θ相比固定值0.2更有利于把握行为序列变化的趋势.当发现波动值后,出于预测需要,首先要对依据定义2、3确定波动值类型.依据本文的分组标准|max(σi)-min(σi)|θ,将发现的波动值构成波动值序列F={f1,f2,…,fl},其中l表示序列X中包含的波动值数量,如果fi所对应的行为值为xk,则设fi=k.下面将介绍通过波动序列F对波动值类型进行确定的方法:(1)如果波动值fk不是波动序列F的最后一个数据,则必有波动值fk+1,如果有(fk+1-fk)>2,表明{xfk,xfk+1,…,xfk+1-1}是一个平滑分组,因此fk的后续影响力大于2个数据,可以判断fk的类型为迁移波动.如果有(fk+1-fk)2则存在两种情况:第一是(fk+1-fk)=1,则fk的类型为突发波动.其次是(fk+1-fk)=2,则表明序列分组{xfk,xfk+1}是一个平滑分组,虽然此时fk后续影响力为2个数据,但是由于数据过少,因此仍然将行为值xfk和xfk+1视为突发波动.(2)如果波动值fk是波动序列F的最后一个数据,则其后再无其它波动值,如果有(n-fk)>2,表明序列分组{xfk,xfk+1,…,xn}是一个平滑分组,则可以判断fk的类型为迁移波动.如果(n-fk)2,由于无法通过当前序列进行识别,需要通过未来数据做进一步判定,则将fk标记为“待定”,下面通过定理1对“待定”的情况进行分析:定理1.如果fk标记为“待定”,则必有fk=n或xn不为波动.证明.当fk标记为“待定”,依据分组原则fk所属的分组仅有两种:(1)Xk={fk},可证fk=n;(2)Xk={fk,xn},假设xn是一个波动,有Xj={fk,fk+1},此时fk的类型可以确定为突发波动,与标记“待定”矛盾,故可证明xn不为波动.证毕.通过定理1可知,如果当前行为值是一个波动,则序列中其它波动的类型必然是已经确定的,因此可以通过分析之前不同波动类型交替变化的规律识别当前波动所属类型.2.2波动类型预测如果发现当前行为值xn是一个波动值,由于缺乏后续数据对其类型进行识别,出于预测下一周期行为值的需要,有必要对该波动的类型进行预测.考虑到Markov模型[15]可以有效描绘一个随机变化的动态系统并根据系统中的状态之间的转移概率来推测系统未来的状态,因此本文使用Markov模型来分析历史行为序列中波动类型交替变化的规律以预测当前波动所属类型.Markov模型可表示为犡(n)=犡(1)犘n,式中犡(n)为第n时刻的状态概率Page4向量,犡(1)为初始时刻的状态概率向量,犘n为状态转移概率矩阵,其中n表示由初始矩阵转移n步,初熿犘2=燀…熿=燀Pij(t)0,i,j=1,2,…,M,∑Mj=1其中M为状态数,转移矩阵所具有的性质是,任意步数转移矩阵(以第t步为例)都需要满足:由于有两种波动类型,因此状态数设为2,使用状态0表示突发波动,使用状态1表示迁移波动.波动类型转移矩阵如式(3)所示:在式(3)中,Pij(1)计算方法如式(4)所示:在式(4)中,Tij为波动值序列F={f1,f2,…,fl}中任意两个相邻波动fj和fj+1(j∈[1,l-1])所属波动类型状态为i和j的次数.可以看出,Pij(1)实质为状态i到状态j的转移概率,通过犘1能够直观的反映出历史上波动类型之间的交替规律,由式(2)可知犘1得出的一步转移矩阵犘2所包含的元素Pij(2)为未来一步后状态i变迁到状态j的概率,此时可以使用Markov预测模型犡(2)=犡(1)犘2来预测当前周期波动fl的类型,犡(1)则为fl-1所属波动类型对应的状态,设犡(1)的状态为i,最后通过比较Pi1(2)和Pi2(2)的大小选取概率值最大的状态作为预测结果.为了便于后面使用波动类型预测算法,将该算法用函数TP(xi)表示,输出0表示预测结果是突发波动,1表示预测结果为迁移波动.始状态矩阵为犘1.矩阵转移的方式(以犘1转移到犘2为例)如式(2)所示:3路由节点行为预测算法尽管灰色预测算法能够较为准确和快速地把握行为数据序列发展的趋势,但是在数据序列波动较大的情况下预测精度有所降低.为了提高对于波动较大序列的预测精度,本文提出一种基于波动类型识别的路由节点行为预测算法FTI-RNBP(aRou-tingNodeBehaviorPredictionalgorithmbasedonFluctuationTypeIdentification).3.1算法思想当一个波动出现后,不同波动类型会对未来行为值产生不同的影响:如果是当前行为值属于突发波动,则意味着当前行为值与未来行为值不属于同一个平滑区间,因此不能通过当前行为值推测未来行为值;如果当前行为值属于迁移波动,则意味着当前行为值与未来行为值属于同一个平滑区间,因此可以通过当前行为值推测未来行为值.因此在具备识别当前行为值波动类型的能力后,将基于当前行为值的类型提出相应的预测方法:(1)如果当前行为值xn是一个波动且被预测为突发波动,这意味着未来下一周期行为值xn+1和xn将存在较大差异,值得注意的是在数据较大的波动甚至是接近随机波动的情况下(不包含周期性波动),为了避免寻找近似随机变化的波动规律,本文转而寻找随时间变化的波动所围绕的基线,而灰色预测恰好具有准确把握时间序列变化趋势的能力,因此在下一周期行为值和当前周期行为值可能存在较大差异的情况下,下一周期序列预测值的计算方法如式(5)所示:Page5其中GreyPred()是一步灰色预测函数,算法实现见灰色预测模型[12],Smooth()是平滑函数,用于对行为序列做平滑处理.之所以要在灰色预测之前对序列进行平滑是因为当序列中出现突发较大波动会导致灰色预测结果产生一定偏离,为了提高预测精度需要先对行为序列进行平滑处理然后再进行灰色建模,Smooth()函数采取较为常用的移动平均法,如式(6)所示:xsmth在式(6)中xsmth(2)如果当前行为值xn为波动且预测为迁移波动或属于非波动,这表明下一周期行为值xn+1将以xn为起点产生永久、暂时迁移或是平稳变化,这也意味着xn+1和xn同属于一个平滑分组.在这种情况下,下一周期预测值为其中PredSR(X,F)为平滑级比序列预测函数,函数参数分别为路由节点行为序列X以及波动值序列F,函数的输出为级别预测值,该函数的具体实现算法将在稍后详细介绍.3.2算法描述所示.基于波动类型的预测算法的具体描述如算法1算法1.基于波动类型的预测算法.输入:X={x1,x2,…,xn},F={f1,f2,…,fl}输出:xn+11.IF(xnF)THEN2.xn+1=xn×PredSR(X,F);3.ELSEIF(TP(xn)==1)THEN//xn为迁移波动4.xn+1=xn×PredSR(X,F);5.ELSEIF(TP(xn)==0)THEN//xn为突发波动6.xn+1=GreyPred(Smooth(X));7.ENDIF8.ENDIF9.RETURNxn+1;在算法1中,PredSR(X,F)为平滑级比序列预测函数.由2.1节可知,使用动态分组标准|max(σi)-min(σi)|θ将行为序列分割成若干分组,分组的种类有以下3类:(1)突发波动分组,Xj={xj{xj1,xj同(1).为了寻找行为序列的平滑数据之间的变化规律,本文从平滑分组中数据之间的级比入手,对所有2,…,xj平滑分组内的数据求级比并将不同平滑分组的级比值集合起来构成一个新的序列称为平滑级比序列σsmth,与整个序列的级别序列σ不同的是,σsmth是行为序列X中所有平滑数据之间关系的集合,显然σsmth是一个相对平滑的序列,非常适合使用灰色预测模型进行预测.如果σsmth中数据大于等于4,该序列未来序列值的预测方法为:对平滑级比序列的序列值使用灰色预测以实现对未来级比值的预估,计算方法为σsmth小于4个,由于不满足灰色预测对数据样本大小的最低要求,因此不能使用灰色预测模型,可取σsmth中行为值平均值作为预测结果.函数PredSR(X,F)具体描述如算法2所示.算法2.PredSR(X,F)函数求解.输入:X={x1,x2,…,xn},F={f1,f2,…,fl}输出:σsmth1.m=1;2.FORi=2tolDO3.Len=fi-fi-1;4.IF(Len>2)THEN//发现平滑分组5.FORj=fitofi+Len-1DO6.σsmth7.m++;8.ENDFOR9.ELSEcontinue;10.ENDIF11.ENDFOR12.IF(m4)THEN13.σsmth14.ELSE15.sum=0;16.FORi=1tomDO17.sum=sum+σsmth18.ENDFOR19.σsmth20.ENDIF21.RETURNσsmth综上所述,为了提高对波动序列的预测精度,本文的预测方法分为波动预测和平稳预测两部分.对于波动部分,通过把握序列变化趋势的基线并以行为趋势基线作为预测值.对于平稳部分,通过序列分组获得序列中所包含的各个平滑区间,将这些平滑区间组合起来进行分析以把握平滑数据之间的变化规律并结合当前数据进行预测.3.3基于Markov状态转移矩阵的预测偏差调整鉴于文献[14]以灰色预测结果为基线结合Page6Markov模型可以在行为序列波动较大的情况下一定程度地提高预测精度,为了进一步减小预测偏差,本节使用Markov状态转移矩阵来调整预测值,设置了6种偏差程度:小幅正偏差、中幅正偏差、大幅正偏差、小幅负偏差、中幅负偏差以及大幅负偏差,并使用状态0~5来表示,预测值与实际值偏差计算方法如下:偏差程度设置方法为:(1)Di∈[0,s)小幅正偏差;(2)Di∈[S,M)为中幅正偏差;(3)DiM为大幅正偏差;(4)Di∈[-S,0)为小幅负偏差;(5)Di∈[-M,-S)为中幅负偏差;(6)Di<-M为大幅负偏差.其中S和M均为正值,赋值方法为S=DΔ/2、M=DΔ,DΔ为绝对偏差均值,计算方法为由上可知,通过划分偏差区域,可以将各个周期的预测偏差Di映射到不同的预测偏差类型,完成了从偏差数值向偏差状态的转变.偏差程度转移矩阵的设置与式(3)类似并且犘1矩阵中Pij(1)的计算方法也在2.2节中介绍,这里不再冗述.然而值得注意的是,与预测波动类型所不同,这里不选择概率最大的状态用于偏差预测,因为如果多个偏差状态概率接近,选择其中任何一个都会一定程度增大偏差,因此转而求取偏差的数学期望,设立各个状态所对应的偏差值为{D(0),D(1),D(2),D(3),D(4),D(5)}={S/2,(M+S)/2,(L+M)/2,-S/2,-(M+S)/2,-(L+M)/2},其中L=(max(|Di|)+DΔ)/2,设Dn的偏差程度所对应的状态为i,则偏差预测值的计算方法如式(10)所示:最后通过偏差预测值对预测值进行调整,调整方法如式(11)所示:使用Markov状态转移矩阵对FTI-RNBP预测结果进行调整的优势是不仅可以在序列中数据较多的情况下进一步降低预测偏差,而且在数据量较小,导致变化规律无法掌握的情况下,使用式(11)得出的偏差预测值可有效减缓通过取最大概率偏差状态所导致的误差加大.因为相比于以往一些使用Markov模型提高灰色预测准确度的方法,FTI-RNBP预测准确度相比灰色预测显著提高,从而即使出现预测偏差失准的情况也不会对最终预测结果产生较大影响,从而在发挥Markov模型效能的同时有效减小其可能产生的对于预测结果的不利影响.4实验本节将通过实际的路由节点行为数据(数据层面和控制层面)验证FTI-RNBP算法的有效性.数据来源分别为CERNET网站①和RIS项目网站②.实验环境为P42.0GHz、2GB、WindowsXP平台,使用Java作为开发工具.由于FTI-RNBP算法采用的是一步预测,为保证比较的公平性,采用一步灰色预测作为比较.为量化显示不同预测模型所得出的预测结果与实际值的偏离程度,使用平均预测偏差度e作为评估指标:在式(12)中偏差度从第5周期开始计算,原因是灰色预测是基于前4个数据预测从第5周期往后的行为值.实验1.对路由节点数据层面行为的FTI-RNBP算法性能验证.首先验证FTI-RNBP算法对于路由节点流量行为的预测效能,数据来源于江苏省计算机网络技术重点实验室的一台边界路由器,采集时间跨度为1d,为方便比较,分别以10min、30min以及1h为观测周期对流量数据建立相应的时间序列.如图1所示,相比灰色预测算法,FTI-RNBP的预测曲线与实际曲线拟合度有很大程度提高.在图2和图3中,尽管相比于图1,FTI-RNBP的预测曲线与实际曲线的拟合度有所降低,但是仍然保持较高的拟合度.尤其相比于灰色预测,在数据序列出现变化趋势改变后,FTI-RNBP算法的预测曲线可以快速拟合实际数据曲线,因此在出现波动时FTI-RNBP算法的预测结果能够对波动后的数据变化做出准确预测.由图1到图3可知,随着观测周期的减少FTI-RNBP的预测精度也会随之下降,这说明在数据较少的情况下,数据变化规律较难把握,进而增大了预测的难度.为进一步量化预测结果,使用平均偏差度对比两个算法的预测效能,如表1所示,对于实验1中这类变化幅度较大的路由节点行为序列,FTI-①②Page7图1流量变化预测/(10min)RNBP相比灰色预测模型预测精度提高很大,尽管随着样本空间的缩小,两种算法的预测精度都有一定程度下降,FTI-RNBP的预测准确度降低幅度是大于灰色预测算法的,这是因为FTI-RNBP算法中结合了Markov模型,在一定程度上需要依赖概率统计,因此在样本数据减小的情况下会造成统计不充分.灰色预测45.463046.50755.036FTI-RNBP9.876212.44921.327实验2.对路由节点控制层面行为的FTI-RNBP算法性能验证.其次验证FTI-RNBP算法对于通告稳定性指标中的前缀平均可达时间的预测效果,首先说明前缀平均可达时间的计算方法,设在一个观测周期内同一前缀出现m次,则该前缀的平均可达时间计算方法如式(13)所示:其中PLi为前缀第i次持续的时间,持续时间是前缀被宣告到撤销之间的时间间隔.实验数据来源于RIPENCC的RIS项目网站提供的位于迈阿密的一台核心路由器上的路由通告数据,该项目提供的每一个数据样本中信息的时间跨度为5min,为了方便统计,将观测周期设为10min(将两个样本信息合并为一个样本),总计30个周期.将一个地址前缀84.205.77.01/24以及对其通告的相关自治域(AS6461、AS9002和AS13030)作为观测对象,以该前缀的平均可达时间为指标得出这3个自治域对于该前缀的通告平均可达时间序列,如图4~图6所示,3个自治域对于同一前缀的通告行为呈现出不同的特征:AS6461所发出通告的前缀平均可达时间较长,AS9002的变化波动较大,而AS13030的较短但是波动较小.对于这3个序列,FTI-RNBP的预精度高于灰色预测,但是预测精度提升程度并不如对于实验1中那么明显,这是因为波动较大甚至接近随机波动的序列中以突发波动居多,故FTI-RNBP更倾向于将波动类型预判为突发波动,所选择的预测策略更多的是对平滑后的序列做一步灰色预测.然而不同于灰色预测结果是波动序列的一条趋势基线,FTI-RNBP预测曲线在更大程度上是与实际曲线拟合的,产生预测偏差的重要原因是由于波动的随机性较强在一些情况下预测曲线与实际曲线呈现反向性.综上所述,FTI-RNBP基于灰色预测但不同于灰色预测,对于波动较大序列中数据变化趋势的把握更加准确进而预测曲线可以快速拟合实际变化曲线,这使得对于波动较大数据序列的预测更具有实际意义.为进一步量化预测结果,使用平均偏差度对比两个算法的预测效能,如表2所示,对于实验2中这Page8类呈现小幅震荡波动的行为序列,两种方法的预测精度都比较高,说明FTI-RNBP算法继承了灰色预测模型对于小幅波动序列预测精度较高的优点,而当波动增大后,FTI-RNBP算法的偏差增大幅度相比灰色预测算法较缓.灰色预测3.31716.61922.8189FTI-RNBP3.18565.24222.41785结语针对路由节点行为呈现出的非线性和突发性特征,本文提出了一种基于波动类型识别的路由节点行为预测算法FTI-RNBP.在该算法中,路由节点行为序列中的波动类型被分为突发波动和迁移波动并通过Markov预测模型实现波动类型识别,随后基于波动类型设立相应的方法预测未来行为值.FTI-RNBP算法对序列中各种波动的有效的分类并充分分析波动之间的交替规律,通过波动类型的识别准确把握当前行为值与未来行为值的关联性,因此FTI-RNBP算法对于具有较大波动的行为序列具有较高的预测精度并且预测曲线与实际曲线的拟合速度较快,基于实际数据的实验结果也进一步验证FTI-RNBP算法相比于已有的节点行为预测算法在预测精度上有较大提升在以后的工作中将基于路由节点行为预测结果构建面向路由节点的信任评估机制.
