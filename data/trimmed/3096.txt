Page1一种基于不变量结构分解的工作流性能分析方法庞善臣1),2)蒋昌俊3)1)(山东科技大学信息科学与工程学院青岛山东266510)2)(清华大学计算机科学与技术系北京100084)3)(同济大学嵌入式系统与服务计算教育部重点实验室上海201804)摘要基于工作流的Petri网结构化建模方法,证明了工作流网的P-不变量存在性、可覆盖性,给出了一个工作流模型可靠性(soundness)的充要条件,得到了基于P-不变量的多项式分解算法,克服了非多项式算法遍历的不足,降低了时间和空间复杂度,基于工作流网的定义,给出了包含时间等信息的广义工作流网的概念,在结构分解的基础上,利用矩姆函数,建立了工作流的时间性能分析方法,所得结果为工作流模型分析和验证提供了理论基础和依据,并可有效降低工作流系统的分析复杂度,对于分析工作流系统处理业务实例的能力,提高业务处理效率有重要意义,给出的实例验证了算法的有效性.关键词广义工作流网;不变量;矩姆函数;多项式算法;性能分析1引言工作流是一类可完全或部分自动完成的业务过程,依据一系列过程规则,文档、信息或任务在不同的参与者之间传递[1],作为成功实施工作流管理的关键,其建模、分析和优化方法成为工作流技术的一个研究重点[2].由于Petri网具有图形化表达的形式语义、基于状态的流程描述方式及丰富的模型分析方法,又具有严格的数学基础,能自然地描述并发、同步、资源冲突等系统特性,自含执行控制,是目前工作流建模的主要方法之一[3],主要有时间Petri网(TimedPetriNet,TPN)[4-6]、有色Petri网(ColoredPetriNet,CPN)[7-8]、随机Petri网(StochasticPetriNet,SPN)[9]和逻辑Petri网(LogicalPetriNet,LPN)[10-11]等模型,其研究主要集中在工作流过程逻辑的可靠性(Soundness)以及工作流的性能分析等方面.工作流网成功地实现了工作流系统的过程逻辑层次的描述,而要进一步分析工作流系统的性能,需要将资源和时间信息元素引入到工作流模型中.工作流的性能分析主要包括以下几个内容:工作流中的资源利用率(或负载率)、工作流系统的吞吐率、工作流系统的稳定性、业务实例在工作流系统中的滞留时间、工作流的关键路径及最短路径等,分析方法主要有基于Petri网的化简策略、基于Markov链的分析方法、基于矩姆函数方法、基于排队论分析方法、基于行为表达式分析方法等.其中化简策略主要利用功能和行为等效机制,将复杂结构简化为一个简单结构,来分析工作流的性能,这种方法对分析工作流的时间性能具有较好效果,但在分析工作流的资源性能时却无能为力,因为在结构化简过程中,因化简带来的黑盒现象,工作流的资源信息将会丢失;基于Markov链的分析方法和基于矩姆函数方法虽然可以分析系统的资源和时间特性及系统稳定性,但需要得到模型的每一个状态分布情况,随着规模的扩大,其分析的时间复杂性和空间复杂性均呈指数增长;基于排队论分析方法是将工作流模型中的每一个变迁看成一个服务系统,可以较好地分析工作流系统的时间、资源及稳定性;基于行为表达式的分析方法为工作流系统性能分析提供了一种新方法,其最大特点是避免了求解系统模型的各种状态,但求解行为表达式也是系统深度遍历的过程,仍然具有较高的时间复杂性.Petri网的化简技术作为系统性质分析的一种有效手段,被成功应用于柔性制造系统(FlexibleManufacturingSystems,FMS)、协议分析(ProtocolAnalysis)、嵌入式系统(EmbeddedSystem)、企业经营过程(BusinessProcessReengineering,BPR)等领域,却不可避免因结构变化造成黑盒现象而带来的大量信息丢失.针对分布异构环境中长期运行、开销较大的复杂工作流,在分析过程中既能有效避免状态爆炸问题,又能保证多项式的时间分析复杂度的算法尚不多见.针对上述问题,基于工作流的Petri网结构化建模方法,本文提出了一种基于P-不变量的多项式分解算法,将一个复杂的、可靠的工作流网分解成一组简单的能够描述业务实例处理过程的子网类,通过分解,既能够有效避免状态爆炸问题,降低空间复杂度,又能够降低工作流系统分析的时间复杂性,提高分析效率.本文提出了广义工作流网的概念,证明了工作流网的T-不变量和P-不变量的存在性、不变量支集外延子网的可覆盖性;给出了一个工作流网模型保持可靠性(soundness)的充要条件;提出了P-不变量的多项式分解算法;基于广义工作流网的概念,利用P-不变量分解算法,结合矩姆函数,建立了工作流系统的性能分析方法,该方法克服了以往分析方法可能带来的状态爆炸和时间复杂性较高的不足,分析复杂度是多项式的,具有良好的应用价值,同时还具有简单、易理解、操作性强的优点,对于分析工作流系统处理业务实例的能力,提高业务处理效率有重要意义;给出的实例验证了算法的有效性.本文第2节介绍一些基本的定义和引理;第3节证明工作流网的T-不变量和P-不变量的存在性、不变量支集外延子网的可覆盖性,给出一个工作流网模型保持可靠性(soundness)的充要条件,并提出P-不变量的多项式分解算法;第4节建立工作流的广义Petri网模型和基于P-不变量分解的工作流性能分析方法;第5节给出分解及性能分析的实验结果;第6节介绍相关工作;第7节总结本文的工作.2基本概念及引理有关工作流网和Petri网的基本概念,请读者参阅文献[3,12-14],仅就本文中用到的主要概念介Page3绍如下.定义1.三元组N=(P,T;F)是一个网,当且仅当P、T分别是库所和变迁的有限集,P∩T=;F(P×T)∪(T×P)是流关系.PN=(N,M)是Petri网,当且仅当N=(P,T;F)是一个网,且M:P→{0,1,2,3,…}是PN的标识函数.(1)t∈T在M下是使能的,当且仅当p∈·t,M(P)>0,记M[t〉;(2)对M1和M2,M1M2,当且仅当对所有的p∈P:M1(p)M2(p);(3)(PN,M0)是活的,当且仅当t∈T,M∈R(M0),M∈R(M),M[t〉;(4)(PN,M0)是有界的,当且仅当对p∈P,M∈R(M0),k∈N+,M(p)k;(5)PN是结构有界的,当且仅当对M0,(PN,M0)是有界的;(6)若对p∈P:|·p|=|p·|1,则称PN为一个T-组件网(T-Component),若对t∈T:|·t|=|t·|1,则称PN为一个P-组件网(P-Component);(7)Petri网PN=(P,T,F)是PN的子网,当且仅当PP,TT,F=F∩((P×T)∪(T×P));Petri网PN=(P,T,F)是PN库所子集P的外延子网,当且仅当PP,T=·P∪P·;F=F∩((P×T)∪(T×P));(8)|P|=m,|T|=n,犃是PN的关联矩阵.犃=[aij]n×m,其中aij=a+ij-a-ij,i=1,2,…,n,j=1,2,…,m,a+ij=1,(ti,sj)∈F如果非平凡的m维非负整数向量犢满足犃犢=0,则称犢为PN的一个P-不变量;如果非平凡的n维非负整数向量犡满足犃T犡=0,则称犡为PN的一个T-不变量;犢={pi∈P|犢(i)>0},犡={tj∈T|犡(j)>0}分别称为P-不变量犢和T-不变量犡的支集;对任意的P2P1=犢(T2T1=犡)都不是PN的P-不变量支集(T-不变量支集),则称P1(T1)为PN的P-不变量(T-不变量)的极小支集;(9)一个标志Mh称为家态,当且仅当对M∈R(M0),Mh∈R(M);(PN,M0)是可逆的,当且仅当M0是家态.定义2.Petri网模型PN=(P,T,F,i)称为工作流网(Workflownet,简称WF-net)当且仅当:(1)PN中存在两个特殊的库所i和o,库所i是一个起始库所,即·i=;库所o是一个终止库所,即o·=;(2)如果在PN中加入一个新的变迁t,使t连接库所o和i,即·t={o},t·={i},这时所得到的扩展网PN是强连通的.定义3.一个WF-netPN是可靠的(Sound-ness),当且仅当:(1)对每一个由状态i可达的状态M,存在一个从状态M到状态o发生序列,即M:i[σ〉MM[τ〉o,其中σ,τ为变迁序列;(2)在任何情况下,终止状态最终可以到达,当状态由M变化到状态o时,只有o中含有一个Token,其它位置均为空,即M:i[σ〉M∧M(o)=1∧(p≠o,M(p)=0);(3)在WF-net中不存在死的变迁,即t∈T,M,M:i[σ〉M,M[t〉M.vanderAalst给出的工作流的可靠性(Sound-ness)的概念主要描述了工作流的功能可靠性,从过程集成角度看,工作流是由若干个相互联系协调完成同一目标的任务组成的业务过程.过程执行也必需保证应用的语义原子性.具有不同属性的活动的组合失配可能会破坏执行的语义原子性,存在组合失配问题的工作流过程定义是非良构的,本文假设工作流过程定义都是良构的.定义4.设PN是一个Petri网,一个从节点n1到nk的路径C是一个节点的序列〈n1,n2,…,nk〉,其中〈ni,ni+1〉∈F,1ik-1,α(C)={n1,n2,…,nk}是路径C的字母表.路径C是基本的,当且仅当对路径C上的任意两个节点ni,nj,若i≠jni≠nj.定义5.一个Petri网是强连通的,当且仅当对于每一对节点x,y∈P∪T,都存在一个从x到y的路径.定义6.一个Petri网在结构上是良构的,当且仅当对任意一对不同类型的节点x,y(一个为变迁,一个为库所),若C1,C2是从x到y的任意两条基本路径,且α(C1)∩α(C2)={x,y}C1=C2.一个工作流网结构上是良构的当且仅当扩展网结构上是良构的.仅当PN的扩展网PN具有活性和有界性.引理1[3].一个WF-netPN具有可靠性当且引理2[13].一个Petri网PN是守恒网当且仅引理3[13].一个Petri网PN是守恒网,则当P是一个P-不变量支集.PN是结构有界网.Page4引理4[15].一个可逆Petri网PN是活的当且仅当它的每个变迁都是一次活的.3工作流网性质分析及分解算法3.1工作流网性质及可靠性分析性质1.一个可靠WF-netPN的扩展网PN至少存在一个T-不变量.证明.由定义3(1)、(2)及扩展网的定义可知,PN存在一个变迁序列σ=t1t2…t,使得i[σ〉i,这表明变迁序列σ在形式上没有改变PN的状态,因此构造一个非平凡的n+1维非负整数向量犡=(x1,x2,…,xn,xn+1),其中xi=|ti|,xn+1=|t|,i=1,…,n,|ti|表示变迁ti在σ中出现的次数,则向量犡满足犃T犡=0,即犡为PN的一个T-不变量,变迁序列σ是PN的一个T-不变量支集,性质1得证.推论1.PN中一个T-不变量的支集若含有变迁t,则支集对应着PN中所反应一个业务实例的执行序列.由模型影射结果,该结论是显然的.性质2.一个可靠WF-netPN的变迁集合T被其扩展网PN的T-不变量的支集R={T1,T2,…,Tk}所覆盖.证明.假设变迁集合T不被其扩展网PN的T-不变量的支集所覆盖,则至少存在一个变迁t∈T,对Ti∈R,tTi.由PN的可靠性可知,对M∈R(i),M∈R(M):M[tσ〉o[t〉i成立,即t存在PN的一个循环结构上,这个循环结构上的所有变迁便构成了PN的一个T-不变量的支集.这与Ti∈R,tTi相矛盾,故性质2得证.存在一个正整数的T-不变量.推论2.一个可靠WF-netPN的扩展网PN性质3.一个WF-netPN是可靠的,则扩展网PN的T-不变量的极小支集的外延子网是一个T-组件网,且PN被其所覆盖.证明.假设存在一个T-不变量的极小支集的外延子网PN=(P,T,F)不是一个T-组件网,则存在一个库所p∈P使得|p·|2或|·p|2,不妨设|p·|=2,分别记作t1,t2∈T,因为PN在结构上是良构的,则在PN上一定存在一个p与p相对应,且|·p|2,否则,因为PN只有1个终止库所o,所以在PN上一定存在一个p与p相对应,且|·p|=1,定义p经t1到·p的路径为C1,p经t2到·p的路径为C2,由Petri网的良构定义,则α(C1)∩α(C2)={p,·p}C1=C2,即t1=t2,与|p·|=2相矛盾,即在PN上一定存在一个p与p相对应,且|·p|2结论得证.令t3、t4是p前集的两个变迁,分别在路径C1、C2上,由于PN是可靠的,则下列两式成立:M∈R(i),M∈R(M):M[t1σ1t3σ〉o[t〉i,M∈R(i),M∈R(M):M[t2σ2t4σ〉o[t〉i.因此将t2到t4的路径从PN中删掉,则子网PN上的变迁仍然是一个T-不变量支集,这与极小T-不变量支集的定义相矛盾,所以PN的T-不变量的极小支集的外延子网是一个T-组件网;由性质2容易证得PN被其所覆盖.性质4.一个可靠WF-netPN至少存在一个P-不变量.证明.假设PN不存在P-不变量,因为PN的扩展网PN是强连通的,所以存在一条从初始库所i到终止库所o的一条路径C,不妨记作C=〈i,p1,…,pk,o〉(将中间的变迁去掉后得到),现在遍历路径C上库所,对pl∈C,若|p·2,由于PN在结构是良构的,由性质3的证明方法,可以证得在路径C上存在一个pj:|·pj(pj在PN中)|2,与pl成对出现,分两种情况讨论:(1)若pj存在C中从pl到终止库所o的路径上,则pl(or-split)与pj(or-join)组成一个选择路由,此时将pl到pj的另一条路径C1上的所有库所并入到C中,得到新的C=C∪C1\{t|t∈C1};(2)若pj存在C中从初始库所i到pl的路径上,则从pl到pj组成一个循环路由,同样将pl到pj的另一条路径C2上的所有库所并入到C中,得到新的C=C∪C2\{t|t∈C2};重复以上步骤,直到C中所有|p·中)|2库所遍历完毕.现在来讨论新得到的C中的所有库所组成PN的一个P-不变量支集:假设Token从初始库所i出发到pl时遇到第一个选择路由或循环路由,则从i到pl之间存在两种路由结构,若从i到pl是顺序路由,则i到pl之间的库所只进行了Token的传递,该过程中,Token的数量保持库所i的数量不变;若从i到pl之间有并发路由,由C的构造可知,在构造C时,只选取了并发路由中的一个顺序路由作为其一部分,因此Token在经过该并发路由中顺序路由部分时,TokenPage5数量保持库所i的数量不变,无论在遇到循环结构或选择结构pl时,pl中的Token只能流向其中的一个后继库所(用success(pl)表示),所以C中增加的C1、C2中的库所与{success(pl),…,pref(pj)}C(pref(pj)表示pj的前置库所)中的库所的Token之和等于pl中的Token,即经过选取的这种选择或循环路由到达pj过程中,Token的数量保持不变,所以最终得到的C中所有库所中的Token数的总和是一个只与库所i中Token数有关的一个.通过上述构造过程,可以得到一个非平凡的m维非负整数向量犢满足犃犢=0,其中yi为上述构造过程库所中Token增减的数量,i=1,2,…,m.由P-不变量支集的定义可得:C中的所有库所组成PN的一个P-不变量支集,这与假设相矛盾,故PN至少存在一个P-不变量.性质5.一个可靠WF-netPN的库所集合P被其P-不变量的支集集合R={P1,P2,…,Pk}所覆盖.证明.由性质4的构造过程,便可得证.推论3.一个可靠WF-netPN存在一个正整数的P-不变量.性质6.一个可靠WF-netPN的P-不变量的极小支集的外延子网是一个P-组件网,且PN被其所覆盖.证明.由性质4的构造过程,容易证得P-不变量的支集的外延子网是一个P-组件网;由性质5容易证得PN被其P-不变量的支集的外延子网所覆盖.定理1.一个WF-netPN是可靠的,当且仅当扩展网PN的T-不变量的极小支集的外延子网是一个T-组件网,且PN被其所覆盖,P-不变量的极小支集的外延子网是一个P-组件网,且PN被其所覆盖,i为家态.证明.只要证明WF-netPN的可靠性等价即可.()由性质3和性质6直接得证,由定义1(9)容易证明i为家态.()先证PN是有界的,P-不变量的极小支集的外延子网是一个P-组件网,且PN被其所覆盖,可以得到P是PN的一个P-不变量支集,由引理2和引理3得PN是结构有界的,即PN有界得证.再证PN是活的,因为PN的T-不变量的极小支集的外延子网是一个T-组件网,且PN被其所覆盖,则犡=T是PN一个T-不变量支集,即PN是一个可重复网系统,i为家态,又因为PN是良构的,下面证明PN是活的.假设PN不是活的,则t∈T是死变迁,即p∈·t,M∈R(i),M(p)=0,即·p也不能发生,重复上述步骤,最终可以找到一个p,·p能够发生,且|p·|2,此时存在两种情况,第1种情况是至少存在两条从p到t的路径,这与PN是良构的定义矛盾;第2种情况是t在p选择结构其中的一条路径上,因此p中的Token流向t所在的路径时,t可以发生,这与假设相矛盾,因此对t∈T,t至少可以发生一次,由引理4可知,PN是活的.定理1不仅证明了一个可靠的工作流网模型可以分解成一组T-组件网和P-组件网,还得到了模型可靠性的验证方法,这些性质和定理为工作流的性能分析提供了理论依据.3.2基于犘-不变量的分解算法一个工作流模型是用来描述一类业务实例的处理过程,因此通过某种分解算法,将一个复杂的、完整的工作流网分解成一组简单的能够描述单个业务实例处理过程的子网类,对于分析工作流的性质、业务处理的能力,将带来极大的方便,通过分解,可以降低分析的复杂性,提高分析效率,还可以进一步判断工作流网完成其功能的有效性,有利于分析模型的描述与真实系统的一致性以及模型的结构和行为等性质.本文的3.1节的性质说明了工作流网是可以分解并且能分解得到具有良好结构的子网,下面给出一种基于P-不变量的分解算法,该算法是一个多项式算法,为分析工作流系统的性能提供帮助.算法思想:在本文的第3.1节中,得到了可靠工作流网可以分解成一组P-组件网的性质,利用其证明的过程,首先构建工作流网的扩展网,通过代数方法求得工作流网扩展网的P-不变量,再影射成P-不变量支集,在所有包含扩展网变迁的支集的基础上,构建外延子网,最终得到所有的分解子网.算法步骤:输入:一个可靠的工作流网;输出:工作流网的分解子网;1.通过在起始库所i和终止库所o增加新的变迁t,即·t={o},t·={i},以构建扩展工作流网PN.2.通过求解方程组犃犢=0,得到所有非平凡的m维非负整数向量犢,向量犢对应的支集集合为R={P1,P2,…,Pk}.3.对Pj∈R,构建PN的一个外延连通子网,记为Page6PNj=(Pj,Tj,Fj),令R=R\{Pj},重复执行步3,直到R=,得到集合RPN={PN1,PN2,…,PNk}.弧(o,t)和(t,i).4.将RPN中所有的PNj中变迁t删除,并删除其连接算法复杂性分析.该算法主要为用来研究和分析资源约束的工作流系统性能而建立的,这是该算法的一个主要目的,该算法具有典型的结构分解特性,不用考虑系统的状态变化,能有效避免状态爆炸问题,且不用专门处理系统的循环结构,因为循环结构内部的库所是扩展网PN的P-不变量的一部分,这一点可由3.1节中的证明得到.这使得分解算法具有简单、易理解、操作性强的优点,复杂性也大为降低.算法步1和步4分别用来构建和消除扩展工作流网(分别通过增加和删除附加变迁t),步2和步3用来求解扩展网P-不变量支集和支集的外延子网,便得到所有要分解的子网.算法中求解P-不变量的分解算法是一个多项式算法,这是因为求线性方程组犃犢=0是一个多项式算法[16],求扩展网的P-不变量支集的外延子网,是一个线性查询的过程,因此也可以在多项式时间内完成,综合上述分析,这个算法是一个多项式算法,其复杂性可由库所的多项式表示.同样,基于P-不变量的分解算法,不仅是多项式算法,同时此算法还有很好的并行性,在多处理器环境下,可以进一步提高分解的计算速度.4基于犘-不变量分解的工作流性能分析本节的思想是,利用P-不变量分解算法,将广义工作流网分解,得到的所有的子网都是状态图,再对每个分解子网求解它们的传递函数,最后利用分解的逆方法对子网的传递函数进行运算得到广义工作流网的传递函数.有关的几个概念和定理如下.4.1广义工作流网(GeneralizedWF-net,简称GWF-net)定义7.广义工作流网为二元组GWF-net=(WF-net,μ),其中(1)WF-net=(P,T,F,i)为工作流网;(2)μ为变迁的引发速率的集合,μ={μ1,μ2,…,基于广义工作流网的定义,可以比较容易得到μk}(k为变迁总数);其扩展网的定义.根据工程实际,假设广义工作流网所描述的工作流模型的变迁引发速率服从负指数分布.4.2性能分析方法定义8.设x是一个随机变量,则esx的期望值称为x的矩姆函数(MomentGenerationFunction),记为MGF(s)=E(esx)(s为实变数).定义9.按照Petri网变迁使能规则,当变迁t只有一个输入库所p,且p中至少有一个Token,则变迁t使能,t使能后,将其前置库所中的一个Token转移到其后置库所,令ρ(p,t)表示变迁t的引发概率,变迁t的延迟是一个常数或者是一个随机变量ρ(p,t)、变迁t的矩姆函数MGF(s)依赖于变迁t的时间延迟、库所p当前Token数量以及其它相关的可使能的变迁,因此定义转移函数为Wt(s)=ρ(p,t)MGF(s).设t1和t2是两个时延分别为X1和X2的发射变迁,X1和X2是独立的.Xi对应的矩姆函数是MGFi(s),ti对应发射概率和传递函数分别是ρi和Wi(s),文献[13]分别给出了顺序结构、选择结构和循环结构的矩姆函数和传递函数的表达式,为了证明定理3,在此仅给出定理2来说明循环结构的表达式.定理2[13].对于循环结构t1和t2(其中只有t1循环,t2是循环的后继变迁),则该结构的矩姆函数和传递函数可表示为(1)MGF(s)=ρ1MGF1(s)(2)W(s)=W1(s)这里的概率与每次循环执行的具体次数有关,可理解为t1和t2执行次数与它们执行总次数的比值(此时的概率是一个变频的参数).定理2实际上只给出了While循环结构的转移函数表达式(如图1),对于Until循环结构,利用文献[17]的证明方法给出下面的定理图2给出了Until循环结构及其等价变换结构(t1是t1的等价变迁),下面分析相关速率的关系.Page7图2Until循环结构及其等价变换结构定理3.如图2的Until循环结构,在条件下,该结构的矩姆函数和传递函数可以表示为(1)MGF(s)=ρ1MGF1(s)ρ1MGF1(s)(2)W(s)=W1(s)W1(s)证明.由图2可知,Until循环结构是由一个变迁和一个While循环结构组成的顺序结构,由定理2和顺序结构表达式联合,可以得到和成立,定理得证.统的性能分析方法.由上面的定理可以得到任意状态图的传递函数.下面讨论基于P-不变量分解算法的工作流系其分析方法的具体步骤:(1)根据P-不变量的分解算法构建P-不变量支集外延子网(每个子网为一个状态图);图3工作流系统的GWF-net模型图4GWF-net模型的扩展网的发射速率μ={μ1,μ2,…μk};支集外延子网上求得变迁的传递函数.(2)利用已知的变迁平均执行时间求得各变迁(3)根据定义8和定义9,在每一个P-不变量(4)根据上述定理计算出每个P-不变量支集的(5)对(4)中得到的所有传递函数求和即为整(6)基于(5)和矩姆函数的有关分析方法得到文章将在下面的分析示例中说明其有效性.传递函数.个工作流网的传递函数.工作流网相应的分析结果.5基于犘-不变量分解的工作流性能分析示例5.1基于犘-不变量分解算法示例图3给出了一个典型工作流的广义工作流网模型,不难证明该工作流网是可靠的,图4给出了它的扩展网,其中变迁上的数字标签表示变迁的平均延迟时间.Page8根据分解算法,由图4可以得到扩展工作流网PN的关联矩阵犃.由步骤2,通过求解方程组犃犢=0得到PN的所有极小P-不变量为y1=(1,1,1,1,0,1,0,1,0,1,0,1,1,0,1),y2=(1,1,1,1,1,0,1,0,1,0,1,0,1,1,1),它们同样也是WF-netPN的极小P-不变量;不变量对应的支集分别为P1=(i,p1,p2,p3,p5,p7,图5P-不变量支集P1的外延连通子网PN1图6P-不变量支集P2的外延连通子网PN2图7P-不变量支集P1的分解子网PN1图8P-不变量支集P2的分解子网PN2通过上述分解示例,能够看出扩展网PN(图4)含有2个有极小P-不变量,并且被它们的外延子网覆盖,这一点由上面的分解算法进一步得到证实.当我们研究业务过程的资源处理问题时,该分解为分析带来较大帮助,因为P-不变量反映了系统资源的分布和流动情况,从分解得到的子网中可以清晰地p9,p11,p12,o),P2=(i,p1,p2,p3,p4,p6,p8,p10,p12,p13,o).由步3,得到PN的两个P-不变量支集的外延连通子网PN1、PN2,如图5、图6,由步4,将所有的PNj中变迁t删除,并删除其连接弧(o,t)和(t,i),便得到由P-不变量分解而来的子网PN1、PN2,如图7、图8.分析资源(如文件信息等)在工作流系统中的加工和传递过程,从资源建模的角度分析,理论上该工作流在同时确保2种不同的信息数据等资源进行传递或加工,而互不影响,其性能将全部得到发挥,当同时需要处理的业务处理种类大于等于3个时,系统因资源占用,会出现等待状态,即系统性能将有所下Page9降,所以通过P-不变量分解来分析研究工作流系统的资源情况,来保证工作流系统正常运行的重要手段,也是十分重要的.5.2工作流性能分析示例由广义工作流网模型(图3),可求解得到变迁平均发射速率向量为μ=(,1,1,1/3,1/2,1/4,1/5,1/6,1/5,,1,1,1,1,),有些变迁的平均执行时间为0,求得其引发速率为无穷大,根据定义8,可得到该变迁的矩姆函数MGF(s)=1.根据矩姆函数和传递函数的定义及定理,分别求解得到子网PN1(图7)和子网PN2(图8)的传递函数,最后求得整个广义工作流网的传递函数.在图7中,子网PN1每个变迁的传递函数分别为Wt1(s)=1;Wt2(s)=μ2Wt3(s)=μ3Wt5(s)=μ5Wt8(s)=μ8Wt12(s)=(1-ρ13)μ12Wt13(s)=ρ13μ13Wt14(s)=μ14由定理,可以计算图7子网PN1的传递函数为WT1(s)=Wt1(s)(Wt2(s)Wt4(s)Wt6(s)+其中,Wt(s)=Wt10Wt13Wt14Wt101-Wt12传递函数.别为在图8中,子网PN2每个变迁的传递函数分Wt1(s)=1;Wt2(s)=μ2Wt3(s)=μ3Wt5(s)=μ5Wt9(s)=μ9Wt11(s)=μ11Wt15(s)=1;由定理,可以计算图8子网PN2的传递函数为WT2(s)=Wt1(s)(Wt2(s)Wt4(s)Wt7(s)+Wt3(s)Wt5(s)Wt9(s))Wt11(s)Wt12(s)Wt15(s)此时,可以得到整个工作流模型的传递函数为将式(1)、(2)代入式(3),可进一步得到WT(s)=Wt1(s)((Wt2(s)Wt4(s)Wt6(s)+Wt3(s)Wt5(s)Wt9(s))Wt11(s)Wt12(s))Wt15(s),WT(s)=Wt1(s)((Wt2(s)Wt4(s)(Wt6(s)Wt(s)+不难发现,求解传递函数的复杂度不是传递函数的计算,而是准备工作,若通过求解可达状态图,其过程没有多项式的算法,并且有状态空间爆炸的可能性,求解行为表达式虽然能够避免状态空间爆炸的可能性,但时间复杂性至少也要随选择结构呈指数增长,基于P-不变量分解的分析方法是一个多项式的算法,这在前面的分析中得到证明,因此基于P-不变量分解的分析方法是已知算法中的最优算法.将前面求得的每个变迁的发射速率代入各自的传递函数,假设循环概率为0.5,再将求得的传递函数值代入式(1)得WT(s)=12-s(2-s)(1-5s)由于该工作流网具有可靠性,因此扩展网是可逆的,所以WT(s)|s=0=1,从而可以得到工作流系统平均执行周期和方差为(因此,工作流系统执行周期的平方差:V(tGWF-net)=D(tGWF-net)-E2(tGWF-net)=97.在一个工作流执行周期内,考虑循环结构的时延T,令Wi(s)中的s=0,i=T\{t10,t13,t14}.此时的传递函数Page10WT(s)=Wt(s)+Wt12(0)将每个变迁的发射速率代入上式得从而可以得到循环结构的平均时延为则循环结构的稳态概率为若工作流网中的某些变迁不服从任何分布,其执行时间为一个规模的函数时,例如一个工程计算过程,可以由式(1)来分析该变迁对工作流执行周期的影响函数.6相关工作在以往的研究中,文献[18]给出了工作流网的一个特殊子类———无环自由选择工作流网的一个分解算法,文献[2,6]将文献[18]的分解算法推广,进一步给出了含有循环结构的自由选择工作流网的分解算法,并在分解的基础上对工作流模型的性能进行了分析,在很大程度上降低了模型性能分析的复杂度,虽然利用上述分解算法对模型分析,其复杂度只随选择库所指数增长,仍然是一个非多项式算法,有一定的局限性.文献[19-20]提出了基于矩姆函数性能分析方法,该方法通过建立Petri网的状态图来求解Petri网的传递函数,该方法适用于任意分布的随机Petri网,并在柔性制造系统分析中得到应用,但求解Petri网的状态图还没有多项式算法,还会带来状态爆炸问题;文献[13]在矩姆函数方法的基础上,建立了基于行为表达式的分析方法,通过建立行为表达式求解Petri网的传递函数,该方法同样适用于任意分布的随机Petri网,该方法虽然能够有效避免状态爆炸问题,其行为表达式求解与状态图的求解具有相同的复杂度.文献[17]将文献[13]的理论成果应用在智能交通模型的分析中,建立了交通系统的分析方法.7本文总结本文提出基于不变量分解的工作流模型性能分析技术,建立了不变量的存在性、工作流网不变量支集的可覆盖性等定理,给出了基于P-不变量和T-不变量的工作流网保持可靠性的一个充要判定定理及证明方法,为工作流系统的可靠性验证提供一个简单、有效的验证方法;该分解方法避免了通过建立Petri网的状态可达图来分析工作流的时间性能,有效解决了空间状态爆炸问题,降低了系统性能分析的时间复杂性,是实现系统性能分析的一个良好途径.
