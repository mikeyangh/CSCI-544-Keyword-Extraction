Page1面向机会社会网络的服务广告分发机制郑啸1),2)罗军舟1)曹玖新1)李伟1)刘波1)1)(东南大学计算机科学与工程学院南京211189)2)(安徽工业大学计算机学院安徽马鞍山243002)摘要提出面向机会社会网络的服务广告分发机制,解决移动网络环境中由于节点移动性、拓扑动态性引起的集中式服务注册库失效的问题.首先分析机会社会网络中服务表现出的社会特征,提出服务社会上下文及其参数度量方法;然后提出基于社会上下文的服务广告分发机制,该机制根据服务行业相关度判断用户对服务的感兴趣程度,以确定广告目标节点,根据可靠度和活跃度计算节点效用,并根据行业时空共存关系预测节点和服务行业相遇概率,以动态选择服务广告代理;最后在社区移动模型下进行了仿真实验,验证了算法的正确性和有效性.关键词机会社会网络;服务发现;消息分发;上下文;机会路由1引言在面向服务的体系架构(Service-orientedAr-chitecture,SOA)中,服务发现是其关键技术之一.有效的服务发现可以使服务使用者全面获取目标服务的信息,为进一步的服务选择和组合提供备选服务.随着移动计算和普适计算研究的深入和普及,出现了移动服务(mobileservice)和普适服务(perva-siveservice)等新的服务形态和模式.与传统服务模式不同的是,这些服务模式都要面对异构、移动的网络环境.这种环境下,服务的使用者和提供者表现出移动性、间歇连接性,其拓扑结构随时间变化呈现出极强的动态性.传统有线网络环境下,服务提供者向服务注册库发布服务信息,服务使用者在服务注册库中查找所需要的服务.由于节点的移动性和拓扑结构的不稳定性,以及移动节点计算和存储能力的限制,这种以注册库为服务信息中介的方式在移动网络环境下面临极大挑战.如何在移动环境下有效发现服务,成为一个开放的具有挑战的问题.当前,移动社会网络(MobileSocialNetworks,MSNs)[1-2]受到了重视.Kayastha等人[1]将移动社会网络分为基于Web和非集中式两种类型,将其通信方式分为蜂窝通信网络、机会网络和无线传感网络.本文将服务发现问题的移动网络环境定位于基于机会网络的非集中式移动社会网络,简称机会社会网络.机会社会网络因为人类的社会活动而产生,由人携带的移动通信终端形成的一种移动自组织网络,网络终端以短距离无线方式直接通信(如Wi-Fi或蓝牙),可以在相遇时交换信息.机会社会网络虽然具有节点移动性强、拓扑变化快、消息传递容迟、机会路由等机会网络的本质特征,但却具有反映社会关系的特点.随着智能手机等掌上计算设备的普及.这种类型的移动社会网络已经出现在校园、居民小区、工厂等人群聚居地区.服务广告是移动环境下解决集中式服务发现问题的有效方法.服务提供者向周围邻居节点定期分发称为服务广告的服务描述信息,直接投放服务广告给服务消费者.这种机制不但可以发现一些潜在的用户,而且更加适合动态和移动的网络环境.这是因为服务使用者不必寻找位置可能变化的服务注册库,而且可以及时获得服务QoS(QualityofServ-ice)变化的信息.服务广告机制所面临的主要问题是移动设备具有有限的缓存、带宽和计算能力,不可能向周围的邻居洪泛式地分发服务信息.因此,服务广告分发机制优化的目标是在减少广告消息数的同时,提高广告投放的覆盖率.上下文(context)可以潜在增强移动环境下的服务操作能力[3].服务上下文是指可以用来刻画实体状况的任何信息,实体可以是用户和服务交互过程中,任何相关的人、地点或物体,也包括了用户和服务本身[4].已有研究提出了服务上下文的概念、属性、分类和建模方法[3-6],并将其应用于服务组合和服务发现,但都没有考虑服务的社会属性.我们发现服务具有社会性.服务本质上虽然是软件,但具有其自身的特点.首先,服务不是单独存在的应用,必须和其他服务交互,否则,就失去或降低了服务存在的价值.特别是在服务组合场景下,服务之间合作完成某项任务,因此要考虑服务间的关系或联系.其次,服务的应用场景复杂,可能是移动、无线环境.因此要考虑服务的部署和使用环境.在移动环境下,手持设备上服务的可用性和设备拥有者的活动规律有关.如果设备拥有者远离了服务的使用者,服务就会变得不可达.此外,设备拥有者的身份、职业以及兴趣爱好和所需要的服务类型有关,例如教师可能对教育行业的服务更加感兴趣.因此,本文提出服务社会上下文及其度量方法,并探索利用这些信息优化服务广告的分发机制.本文第2节简要介绍移动环境下服务计算相关研究,随后介绍服务发现、消息分发和服务上下文等相关工作;第3节给出服务社会上下文描述和参数度量方法;第4节介绍基于社会上下文的服务广告分发机制;第5节在社区移动模型下进行仿真实验,并对算法性能进行评估;第6节讨论本文工作的应用价值;第7节总结全文.2相关工作随着移动掌上设备的普及,移动人群通过自组织联网方式共享信息和服务的潜在需求也在增长.如文献[7]给出了一个街头服务共享的场景,路人可以共享分别由不同智能掌上设备提供的GPS服务、公交线路服务、步行速度服务,而这些服务亦可以通过机会服务组合的方式,计算出通过步行、乘车等不同方式到达某个目的地的时间.目前开展的移动自组织环境下的服务架构和关键技术的研究主要以服务中间件[8]、服务组合[7,9-10]和发现[11-13]研究为代Page3表,研究项目如MobiLife①、DCC(DynamicCom-posableComputing)[14].这些研究工作直接面向当前普适和移动互联环境下的服务提供和增值问题,试图解决在任何时间、任何地点、任何设备上,在不必用户决策或较少决策的情况下,向用户提供个性化服务的问题[15].和传统有线网络环境不同的是,服务使用者和提供者具有移动性,这给服务的定位和组合带来很大的困难.同时,无线网络带宽受限、移动节点资源受限,这就要求设计轻量级的资源节约型服务发现方法.解决服务发现问题有两种思路:(1)通过研究移动节点的移动规律,设计服务查找方法[11];(2)通过在移动节点上设置缓存,提高服务发现请求的响应速度[12-13].文献[11]提出了移动自组织网络中基于节点移动性的Web服务发现.研究了在移动自组织网络中节点移动的聚类特性,从移动方向、速度、运动轨迹的保持时间和连通性等角度研究节点的移动规律.提出了一种混合查找方法,即根据簇结构的复杂程度,由簇头选择DHT、集中式Hash或Flooding方式的服务发现机制.文献[12]提出了移动自组织网络中的分布式服务发现协议.其关键技术是服务广告的P2P缓存和基于组的服务查询消息传递.利用移动节点构成的P2P缓存保留周围其他服务的广告信息,有利于引导服务查询消息向这些服务节点转发.对服务按组分类,并对服务组进行语义描述,利用这个语义信息有选择地转发服务查询消息.文献[13]提出了移动自组织网络中一种分布式Web服务缓存和响应系统.系统中设置缓存节点,它可以存储对服务的请求和服务的响应数据,这种缓存的方法可以有效减少服务的响应延迟,减轻网络负载.和以上工作不同,本文提出了主动发布服务广告消息的方法.移动社会网络中有关消息分发的研究为本文工作提供了有益参考.这些分发机制通常基于节点社会属性,利用社会网络分析方法解决.文献[2]研究社会网络对消息分发性能的影响,理论证明了利用社会关系设计算法可以使网络带宽可优化、系统规模可扩展.文献[16]研究了用户社会性的移动行为对信息分发的影响,根据移动轨迹是否有规律及可预测,将用户划分为社会人(Social)和游民(Vagabond)两大类,并发现游民在人口数量和密度大的区域具有更高的消息发送效率.文献[17]研究了3种不同移动模式的移动自组织网络,发现都具有小世界特征.从而根据其高聚类系数和短平均路径长度的特点设计了发布/订阅协议.文献[18]根据移动用户兴趣和社会交互模式考虑数据的分发机制.只将数据转发给对其有兴趣的节点,以此提高数据分发的性价比.和这些工作不同,广告消息的主体是服务,而服务具有一些不同于消息的特征,如可组合、行业相关、服务质量.这些特点是设计服务广告分发机制时要考虑的问题.服务上下文一般结合服务发现、选择和组合等具体问题来研究.文献[3]提出服务的上下文化趋势,认为在移动环境下,如果不考虑有关的上下文参数,注定会导致服务发现的失败.这是因为不考虑上下文时,会降低查找精度,产生极其庞大的交换数据,花费较多的处理时间.论文提出一个层次式的上下文模型,使用WSDL2.0和SOAP实现上下文的处理.提出了基于地理位置上下文的路由机制.文献[4]概括了移动环境下服务调用的3种方式,给出了服务上下文的定义,将上下文数据的每一维度建模为层次结构.具体的上下文信息可以按照用户需求建模,建模方式可以是本体、图或元组等.文献[6]提出基于上下文推理的语义Web服务发现方法.分别建立了用户情境本体和Web服务情境本体来描述服务用户和Web服务的上下文信息,建立用户情境和服务情境之间的推理元规则.并提出基于规则的服务筛选方法.文献[19]关注在移动社交网络中的服务选择问题,将用户上下文作为三维协作过滤模型的一个评价维度,以提高服务选择的准确性.3服务社会上下文及其参数度量3.1服务社会上下文服务计算环境中参与计算的实体分为服务提供者和服务使用者两种类型.服务的载体是服务提供者,服务使用者可以是服务,也可以是仅仅调用其它服务的非服务化封装的程序,如果是程序,本文将其看作是一种虚服务.根据服务之间是否存在调用关系,这些实体服务和虚服务共同构成一个服务覆盖网络,简称服务网络.服务是网络中的节点,如果服务之间存在调用关系,就用边将它们连接.如图1所示的一个校园机会社会网络场景,网络节点拥有者因为在校园学习工作而形成了一个社会网络.节点p1的拥有者是教务管理员,提供全校的教学计划服务S1,p2的拥有者是教师,提供某门课程的教学文①http://research.nokia.com/page/239Page4档资料服务S2,p3的拥有者是后勤管理员,提供全校教室信息服务S3.p4的拥有者是某位学生,他是服务用户,通过设备访问这些服务,获得和某门课程相关的教学文档、教室位置等信息.这些服务和服务用户之间形成相互调用的关系,p4上虽然没有服务,但和其他服务构成了调用关系,也是服务网络的一部分,因此可看作是拥有一个虚服务S4.S4可以直接调用服务S1、S2或S3,S1、S2和S3也可以构成一个关于某门课程所有教学信息的组合服务.为了描述服务关系,先给出以下定义.定义1.实体服务,服务网络中服务提供者所提供的服务可以调用其它服务,或者被服务使用者或其它服务调用,这些实际存在的服务称为实体服务.定义2.虚服务,服务网络中的服务使用者只调用或访问服务,其本身并不对外提供服务,本文称其为虚服务.本文后面不再区分虚服务还是实体服务,都统一称为服务.本文提出的服务社会上下文是这些实体服务和虚服务的社会上下文.服务具有社会属性,服务间在交互时会表现出某些社会行为.这是因为,服务计算强调服务之间的组合和协作,由原子服务按照一定的工作流程组织为组合服务以实现服务增值是SOA架构下分布式应用的一个重要的特点.因此,服务计算环境下的服务不是独立存在的,而是必须要和其它服务交互,与服务使用者交互,形成一个服务社会,这在一定程度上体现出了服务计算环境下的社会关系.例如,服务在组合时,总是相关行业的服务组成一个工作流.服务使用者总是使用一些和其兴趣或爱好相近的服务.此外,随着掌上移动计算设备的涌现,这些设备和设备携带者的社会活动更加密切,特别是设备使用的区域、位置和时间和设备携带者活动的范围、作息时间密切相关.这也体现了设备所承载的服务具有社会性.定义3.服务社会上下文是指服务在相互作用过程中所表现出来的和社会属性相关的任何信息.本文考虑的服务社会上下文包括以下参数,其定义为SocialContext=(industry,friends,activeness,其中,industry是服务行业集合,表示服务所属行业或感兴趣的(调用的)行业,friends代表朋友圈,ac-tiveness是服务活跃度,reliability是服务可靠度,area是服务区域,time是服务时间.服务行业是指服务所属的行业,根据服务的功能,它总是属于某一个行业的.我们曾经提出了服务按行业分类组织的方法[20].服务行业可以细分为主行业、相关行业和上下游行业,在组合服务中,多个原子服务分别属于不同的行业.而这些行业构成了调用时的上下游关系.朋友圈是服务伙伴,属于同一朋友圈的服务载体具有相近的兴趣爱好或工作关系.活跃度体现了服务的移动性,服务的移动性实质上由承载设备的移动性所决定.服务可靠度是指服务具有的在某一段时间内提供持久服务的能力.服务区域是能提供服务的地理区域范围,服务时间是提供服务的时间范围.3.2上下文参数度量服务社会上下文参数是服务或服务载体的社会环境信息,代表了服务所处的社会关系环境.这些属性依赖于客观物理环境,因此其度量方法和服务载体的物理状况及特性有关.例如,服务时间和服务载体的工作时间有密切的联系.通过量化载体的物理特性,建立服务社会上下文参数和服务载体物理特性之间的映射关系,就可以对这些参数进行度量.下面给出行业相关度、服务活跃度和服务可靠度的计算方法.这些参数将用于优化服务广告分发.定义4.上下游关系,如果行业a中的服务和行业b中的服务在同一个服务业务流程中可以使用,则称a和b具有上下游关系.上下游关系具有传递性、自反性和对称性.如果两个具有上下游关系的行业的服务之间存在直接调用关系,则称具有直接上下游关系,否则称为间接上下游关系.如图2所示,在一个旅游组合服务中,铁路运输业和住宿业就具有直接上下游关系.服务行业根据其直接上下游关系可以构成一个服务行业网络.其中,最短距离和节点度数是决定两个节点关系紧密程度的主要参数.由于篇幅所限,本文不介绍服务行业网络的构建方法.基本方法是,统Page5计组合服务样本中形成直接上下游关系的服务行业对,若两个服务行业形成直接上下游关系的概率大于某一阈值,则认为其具有直接上下游关系.最短距离是指在一个服务行业网络中两个行业节点之间的最短跳数,跳数越小说明两个行业在一个工作流中调用距离越小.服务节点的度数表示了服务行业的使用程度,度数越大说明节点代表的行业可以参与多种不同的流程中,和越多的服务行业之间具有上下游关系.因此,以最短距离和节点度数为参数,得到行业相关度的定义和计算公式.定义5.行业相关度是在行业上下游关系中所体现出的行业关系紧密程度,其值是不大于1的非负实数.行业i和行业j的行业相关度定义为r(i,j)=1/(hops(i,j)×max(di,dj)-α+1其中hops(i,j)是i和j在网络中的最短距离,max(·)是取最大数函数,di,dj分别是i和j的度数.调节因子α是大于0并小于1的实数.当两个服务属于同一个服务行业时,它们的行业相关度为1.在距离相同时,节点度数越大,则行业相关度越大.服务活跃度和服务载体的移动性相关,也和其周围邻居节点的移动性相关.如果,服务s一直在较大范围内移动,则其邻居的变化率比较大,如果服务s不移动,但其邻居经常改变,则其活跃度也较大.因此,服务s在时刻t1到t2时间段的服务活跃度αs(t1,t2)为αs(t1,t2)=1-Ns(t2)∩Ns(t1)其中:Ns(t1)是s在时刻t1时的邻居节点集合;Ns(t2)是s在时刻t2时的邻居节点集合.因此,服务活跃度体现了一段时间内节点邻居变化的情况.如果在两个不同的时刻,服务s的所有邻居都不相同,则αs=1,如果所有邻居没有变化,则αs=0.因此,αs属于[0,1]之间.在移动网络环境下,影响服务可靠度的底层因素主要包括服务载体(移动设备)的工作电量和可用缓存大小.较多电量和较大可用缓存的设备可以保障在一段时间内提供持久性的服务.因此,本文以服务载体的电量和缓存作为衡量服务可靠度的参数.服务s的服务可靠度为γs.有γs=ωL×Ls+ωC×Css.t.ωL+ωC=1,ωL0,ωC0(3)其中,Ls属于[0,1],表示服务s载体的电量,0表示没有电量,1表示满电量;Cs是服务s载体的可用缓存容量,需要进行归一化处理;ωL和ωC是权重因子.在归一化处理时,通常需要获得全部缓存参数中的最大和最小值,然而,这在动态的移动环境下是很难做到的.因此,本文根据文献[21]提出的服务质量曲线概念和计算方法,给出缓存用户满意函数和用户满意度的定义,并用用户满意度来描述用户对缓存的满意程度.对缓存容量c的用户满意度S(c)为S(c)=其中,Cmax和Cmin分别是最大和最小阈值.当缓存容量c大于Cmax,就设置满意度为1,当c小于Cmin,就设置其为0.因此在不必获得实际全局环境中缓存的最大值和最小值的情况下,就可以进行归一化处理.算公式,即因此,在式(3)中用S(Cs)取代Cs,得到新的计4基于服务社会上下文的服务广告分发机制4.1问题描述与设计思想本文研究的机会社会网络可以抽象为以下网络模型:假设网络是一个面积为N×N的二维正方形区域,所有网络节点在该区域中按照社区移动模型(Community-basedMobileModel,CMM)[22]自由移动.区域中的所有节点P的上下文信息可以共享,节点没有隐私,相遇时,可以交换上下文信息.每个节点都是对等服务节点,既可能是服务提供者,也可能是服务消费者.Page6在这样一个网络模型下,本文要解决的问题是:如何优化服务广告消息的转发路径,使得在尽量减少消息量和传递时间的同时,达到最大的消息投放覆盖率.在实际生活中,移动社会网络中节点的移动轨迹具有以下规律[23]:多数节点在大多数时间内在某几个固定范围或区域内移动,而少数节点在区域间自由大范围移动.考虑这些特性,本文将网络中的所有节点分为两类,服务用户U(即节点)和广告代理A.U可以产生服务广告,并且将广告消息散发给邻居节点,但它不转发其他服务广告.这样做是为了减少消息的个数,避免出现信息泛滥.U也可以接收到其他服务广告.而A要转发服务广告,并且会复制多个广告并转发给邻居.广告代理也可能是服务用户,极端情况下,网络中所有节点都是广告代理.每个节点需要维护一个邻居上下文信息表.节点在转发消息时,要根据信息表中记载的信息有选择地挑选邻居进行转发.定义6.服务广告消息可以定义为一个五元组其中,sinfo是服务的基本信息;scontext是服务的社会上下文;transfertag是消息转发标识,其值为布尔型,表示消息是否允许被转发,当值为零时,表示不能被转发;replicanum是消息在发布给广告代理时被允许复制的次数,其值为非负整数;TTL是广告代理转发消息时所允许经过的社区数,其值为非负整数.假设当前节点为i,为了发布服务信息,它产生一个广告消息Ad,服务广告发布协议的执行过程为:(1)根据邻居的社会上下文信息,按照广告目标选择策略,服务用户U将Ad发布给多个最有可能对该服务感兴趣的邻居节点,设置Adtrans-fertag为0;(2)在所有邻居节点中,根据广告代理选择机制,选择不超过k(k=Adreplicanum)个合适的节点作为广告代理A.发给A的消息Ad中的Adtransfertag设置为1,AdTTL设置为t;(3)如果节点收到广告消息Ad,检查Adtransfertag,如果为0,则不转发广告消息;如果为1,则说明自己已被选择为此广告的广告代理,将Ad存入本地缓存,等待转发;(4)广告代理按照广告目标选择策略,将缓存中的Ad的副本转发给选择的邻居,并将此副本的transfertag设置为0;(5)广告代理检测社区,若经过一个社区,就将缓存中的AdTTL减1;(6)重复以上过程,直到Adtransfertag=0或AdTTL=0,丢弃Ad.可见,服务广告发布协议中的关键机制是广告目标选择策略、广告代理选择机制、社区检测与TTL更新策略.4.2基于行业相关度的广告目标选择服务广告应该有选择地发布给潜在的用户,因此,广告发布者要根据邻居信息,从邻居中选择出最有可能对宣传的服务感兴趣,并且可能会使用该服务的邻居.因此,必须考虑服务用户节点和服务本身的相关性,将服务用户的社会上下文和服务(提供者)的社会上下文进行比较.本文利用行业相关度来估计用户对某个服务感兴趣的程度.在基于SOA的应用系统中,服务除了对本行业的服务感兴趣以外,还会调用上下游服务,以完成服务组合过程.例如,一个虚服务在调用交通行业的服务后,很有可能要调用旅馆行业服务,以完成一个旅游服务组合的过程.因此,可以根据行业相关度预测出是否会需要该服务.根据式(1),如果两个服务属于同一个行业,则相关度为最大值1,如果是具有直接上下游关系,并且有多种联系(调用关系),那么服务之间越有可能产生调用,其相关度也越大.本文的广告目标选择算法中计算行业相关度.如果其值大于某个设定的阈值,就作为广告目标.算法1描述了广告目标选择算法.算法1.广告目标选择.输入:邻居节点集J,服务i,行业相关度阈值rt输出:广告目标集合D算法描述:D←;FOREACHj∈JDOcalculater(i,j)byformula(1);IFr(i,j)>=rtTHEND←D∪{j};returnD;4.3广告代理的动态选择节点在其所有的邻居中选择若干个合适的节点成为广告代理,本文倾向于选择活跃度大、可靠度高,并有可能和潜在用户相遇的节点作为广告代理.其动态选择的过程分为以下两个步骤.Page7(1)资格确认首先根据上下文信息,确定哪些邻居节点可以成为广告代理.本文提出基于效用的资格确认方法,即先根据上下文信息设计统一的效用函数,再分别计算每个节点的效用值,若某节点效用值大于一个设定的阈值,即可以成为广告代理候选者.本文倾向于选择活跃度大、可靠度高的节点,所以效用函数定义为其中,α是活跃度;γ是可靠度;wα和wγ是相应的权值.当效用值U大于某一个阈值,说明节点的移动性和可靠性满足要求,可以成为广告代理的候选者.但是对于某类型的服务广告,并不是所有的广告代理候选者都能成为其代理,还要预测其是否会和对此类服务感兴趣的节点相遇.(2)相遇预测由于广告代理的移动性较强,有可能移动到目标节点附近.因此可以采用存储-移动-转发的消息传输方式,即由广告代理携带服务广告到广告发布者不能到达的区域,并转发服务广告给可能的服务用户.因此,如果可以准确预测某个广告代理侯选者未来可以和期望的服务用户相遇,则可以使其成为该服务的广告代理.考虑到移动设备计算能力的限制,本文提出基于时空共存关系的轻量级相遇预测方法.本文预测所基于的基本事实是,人们总是在一定范围内周期性活动,他们在某个空间相遇的时间持续越长,说明越熟悉,在将来相遇的可能性也更大.相遇的次数越多,也说明将来相遇的可能性也越大.由于服务的载体是移动设备,而移动设备的携带者是人,因此,服务相遇情况也遵循以上规律.时空共存关系是指两个移动物体在某个时间段共存于同一地理位置[24],本文利用地理信息学中的这个概念来描述服务行业间的时空关系.本文关注的不是广告代理候选者会和哪些节点相遇,而是关心会和哪些服务行业相遇,因此本文给出服务行业时空共存关系的定义.定义7.服务行业时空共存关系.在时空三维坐标系上,如果两节点可以在某个时间段上直接一跳通信,则其中某个节点和另一节点上的服务行业在此时间段上具有服务行业时空共存关系.图3描述了节点m(从pm点出发)和节点n(从pn点出发)在不同时间时的地理坐标的变化情况,即是它们的移动轨迹.在t1和t2之间的时间段,两个节点的距离小于通信距离d.则说明节点m和节点n上的服务行业具有服务行业时空共存关系.节点移动轨迹信息是一个三元组(x,y,t),t是表示节点移动过程中的某一时刻,(x(t),y(t))是节点在t时刻的空间坐标.可以通过这些信息判断节点的时空共存关系.下面给出相遇时间的定义,以此可判断是否相遇.定义8.相遇是指两个节点在空间位置上接近到足以在一跳间直接交换数据.节点i和j相遇时间Δt可定义为其中d(i,j,Δt)=(xi(t)-xj(t))2+(yi(t)-yj(t))其中,i=(xi,yi),j=(xj,yj)分别是节点i和j的坐标位置,dc是可以直接交换信息的距离.因为广告代理只关心是否会和哪些服务行业相遇,而不关心在哪里相遇,因此广告代理上只需要记录曾经和哪些服务行业相遇过、何时遇见、相遇的次数、相遇的周期等信息.这些信息可以记录在节点的相遇信息表中,以帮助选择合适的广告代理.定义9.节点i的相遇信息表MeetingTab可定义为MeetingTab=(industry,MNum,MPeriod,其中,industry是和i相遇的节点中包含的服务行业;MNum代表和该industry相遇的总次数;MPe-riod代表平均相遇周期,是与该industry两次相遇的时间间隔的平均值;Timestamp是时间戳,记录了最近一次相遇的时间.预测是否相遇的方法是:考虑相遇次数和平均相遇周期这两个参数.相遇次数越多的服务行业在今后相遇的机会也越大;根据平均相遇周期可以判断何时可能再次相遇,检查时间戳距离当前时刻有Page8多久,如果时间和平均相遇时间比较接近,则可能即将相遇,如果远大于平均相遇周期,则再次相遇的可能性也减少.作为判断依据,给出最近一次相遇到当前时刻的时间与平均相遇周期之间的相对比值其中,tc是当前时刻;ts是时间戳;MPeriod是平均相遇周期;σ越小,则有可能就要相遇,小于1则可能会相遇,若σ增大,则相遇的可能性减小.基于以上分析,算法2描述了广告代理选择算法.算法2.广告代理选择算法.输入:广告代理候选者集合A,广告消息msg,服务行业SI,效用函数U(·),行业相关度阈值rt,效用阈值ut,副本数k输出:广告代理集合A算法描述:A←;FOREACHa∈ADOIFU(a)>=utTHENA←A∪{a};FOREACHa∈ADOIFr(aSI,msgSI)<=rtTHENA←A\{a};IF|A|<=kTHENreturnA;ELSESortainAorderbyMNumDESC,σASC;returntopkelementsinA;4.4社区的检测和犜犜犔更新根据广告代理检测到的节点密度高低的变化,判断是否从一个社区移动到了另一个社区.广告代理a的节点密度Da定义为其中,Na是a的邻居节点数;ra是a的通信半径;π为圆周率.如图4所示,当代理节点从社区A移动到社区B时,在每个ti(i=1,2,…,5)时刻,邻居节点数发生变化.设置一个节点密度阈值,如果当前节点密度大于该阈值,说明代理在一个社区中.反之,说明其不在社区中.因此,当前值和阈值的差值由正变负再变正时,说明结点从一个社区到达了另一个社区,广告代理缓存中所有消息的TTL减1.由于对于同一广告代理,其通信半径相同,所以在算法中,节点密度图4广告代理移动过程中邻居节点变化示意图可以用节点数代替.节点数的采样周期为Δt,为了消除噪声,运用邻域均值滤波方法来平滑节点数曲线,即时刻t的节点数N(t)为这里取邻域范围为[-2,2],即当前值为其左右各2个相邻点值的平均值.然而,还要考虑广告代理一直待在一个社区中的情况.活跃度表明了广告代理是否还有新的邻居,如果服务活跃度高,说明一直有新的邻居出现,则允许保持节点中消息的TTL不变,等待社区变化.如果活跃度低,则表明节点处在一个邻居几乎不变化的社区中,这时设计一个超时事件,即,每当有一次超时则消息TTL减1.代理a的超时时间τa定义为其中,ra是a的通信半径;va是a的移动速度.算法3描述了TTL更新算法.当广告代理的活跃度大于某个阈值时,根据节点密度变化,判断是否离开社区.若离开社区,则其消息缓存中所有消息的TTL减1.当广告代理的活跃度小于某个阈值时,则设置一个超时时间,每次达到超时,则将TTL减1.算法3.TTL更新算法.输入:广告代理a,a的活跃度a.act,a中缓存的消息集合a.MSGs,活跃度阈值αt,当前时间步k,记录连续时间步下的邻居节点数数组N[k-3…k+2],节点数阈值Nt,超时时间τa输出:a.MSGs中所有消息的TTL,即msg.TTL算法描述:IFa.act>=αtTHENNk←(N[k-2]+N[k-1]+N[k+1]+N[k+2])/4;Nk-1←(N[k-3]+N[k-2]+N[k]+N[k+1])/4;IF(Nk-Nt)<=0AND(Nk-1-Nt)=>0THENFOREACHmsg∈a.MSGsDOPage9msg.TTL--;ELSEIFτaexpiredTHENFOREACHmsg∈a.MSGsDOmsg.TTL--;5仿真实验为了验证本文提出的服务广告分发机制,从广告投放覆盖率和网络流量两个方面进行了性能分析,下面首先介绍本文仿真环境的设置.5.1仿真环境仿真实验包括两个步骤,首先要产生节点的运动轨迹,然后在基于此运动轨迹的仿真环境中,执行服务广告发布过程.节点移动模型分别采用了随机移动模型(RandomWayPoint,RWP)和基于社区的移动模型(Community-basedMobileModel,CMM).RWP模型是经典的移动网络模型,每个节点随机选择下一个移动位置,并以随机速度移动到目的地.CMM模型基于社会网络的特性产生更符合实际的移动路径,其有效性已经得到验证[25].RWP模型的移动轨迹由NS2产生,而CMM模型的移动轨迹由MPG工具(MobilityPatternsGener-atorforns-2simulator)产生.假设节点能耗主要由通信产生,采用文献[26]实验中的移动节点能耗模型,从节点i向节点j传送1bit信息时,发送能耗etij和接收能耗erij分别为其中,eT=50nJ/bit是发射器能耗;eR=150nJ/bit是接收器能耗;εamp=100pJ/(bit·m)是发射天线能耗;dij为两节点间距离;n=4是路径损耗指数(pathlossexponent).该模型表明,节点发送消息能耗和传送的消息量及距离有关,而接收消息能耗和距离无关,只和接收的消息量有关.本文实验每30s随机选择一个节点发布一条广告消息.尽管一个服务可以属于多个服务行业,为了简化起见,实验中假设每个服务属于一个服务行业.由于广告消息发布是发布方单方面行为,只有通过接收者的反馈才能确定广告是否成功,取得效果.为了验证广告是否有效,假设每个移动节点都对若干服务行业感兴趣,如果节点获得了属于这些行业的服务广告,就表示投放成功.每项测试至少包含20次实验,将这些实验的平均值作为一项测试的结果.本文实验中的主要参数如表1和表2所示,其中仿真环境参数的含义可参考文献[22].为了测试算法性能,实验中可能会修改一些参数值(如节点数、移动速度),以比较在不同取值下的算法性能,因此表1和表2中列出的是缺省值.实验中修改的参数值分别在各实验中加以说明.仿真环境参数广告发布间隔广告目标分布漫游者数量漫游者速度算法参数缺省值α0.5ωLωCCmax10MBCmin1MBrtwαwγutk5t7Ntαt5.2性能测试与分析使用下列性能度量指标评估本文算法.覆盖率(completeness).广告消息覆盖到的符合广告条件的节点数占网络中符合条件的节点总数的比率,这些符合条件的节点都是可能会对广告感兴趣的节点.表现了消息覆盖到广告目标的程度.网络流量(networktraffic).在广告发布过程中,由所有节点传递的广告消息总数.表现了广告发布对网络通信带宽的消耗,流量越大,网络负载越大.实验1.算法基本性能.由于广告代理动态选择方法对性能优化起到主要作用,将本文算法稍加修改,一种是不做广告代理选择,广告发布者只根据广告目标选择策略向邻居节点发布广告消息,消息不能被邻居节点转发;另一种是随机选择邻居节点成为广告代理,消息可以被广告代理转发.将本文Page10算法与这两种算法进行比较,以验证总体优化效果.图5显示了3种算法在覆盖率、网络流量上的对比.如图5(a)所示,随着时间增长,无广告代理算法的覆盖率难以提高,较早达到饱和.这是因为在CMM模型中,节点多数时间在社区内运动,在没有消息转发节点的情况下,节点的广告消息只能在社区中发布.因此,发布节点的移动范围决定了广告消息的发布范围.另两种算法的覆盖率都得到显著提高,这是因为增加广告代理后拓展了消息发布的范围.随机选择广告代理算法的性能要稍逊于本文算法,这种算法没有利用历史经验去预测节点的相遇概率,而本文算法利用相遇的历史信息预测未来相遇的可能性,获得了较好的效果.实验又比较了3种算法在RWP模型中的覆盖率,如图5(b)所示,在这种情况下,无广告代理算法的覆盖率得到了改善,这是因为节点的移动不受社区的限制,移动范围扩大.同时,节点移动无规律,随机性增强,本文算法覆盖率降低,因为本文广告代理选择方法基于的社会网络性质不存在,导致选择较少的广告代理.而随机选择广告代理的算法的覆盖率最高,因为该算法不受到节点移动规律的影响.但是RWP模型并不符合现实生活中节点的移动路径.这说明在更符合实际环境的移动社会网络中,增加广告代理并进行有预测地选择,可以有效提高覆盖率.图5(c)反映的网络流量是算法随时间推移累图53种算法性能比较积产生的消息总数.在都使用算法1的前提下,影响消息数的主要因素是产生的广告代理数和广告代理漫游到的社区数,即和算法中的k和t有关.根据算法3,若选择的广告代理移动性强,导致其在多个社区中漫游,则会产生较多的消息.如果其局限在少数社区中,即使t的设置值较大,也会因为超时而减少,直至不再转发消息.随机算法选择的广告代理数恒定为k,但并不关心选择到的广告代理可以漫游到的社区数,因此社区数没有规律.而本文算法选择的广告代理数虽然小于等于k,但会优先选择活跃度大的节点,这导致以较大概率漫游到的较多的社区.这两个因素此消彼长,因此两种算法在初期产生的消息数差不多,而随着时间的推移,节点移动规律逐渐稳定,本文算法产生的消息量会逐渐减少.无广告代理算法的网络流量较少,因为该算法只局限在广告发布节点的社区中发布消息,且不产生转发的消息流量.但这种方法的覆盖率太低.需要说明的是,此图和图7(b)、图8(b)中的网络流量都是指从实验开始后产生并累积统计的消息总数,而不是某个时间点上的消息数.实验过程中,在单位时间内产生的网络流量是平稳的,不会持续增长.图5(d)是在CMM模型下,设定不同广告代理数量时的覆盖率对比.广告代理携带并转发广告消息,是决定消息转发路径的关键,其数量和移动轨迹影响算法优化效果.如果广告代理可以将消息携带Page11到目标节点周围,则可导致广告投放成功.因此转发路径优化,实际上就是广告代理选择优化.从图5(d)可见,在相同的代理数量时,本文算法可以获得较大的覆盖率.这是因为本文算法选择的代理是活跃度更大、可靠度更高,且更有可能和对服务广告感兴趣的节点相遇的节点.因此,本文算法选择的广告代理质量优于随机选择算法.实验2.算法收敛效果.本文算法利用相遇信息表中的历史数据预测服务行业相遇概率,以此作为选择广告代理的依据.预测的准确程度决定了是否可以选择出合适的广告代理,提高覆盖率.图6是在一个缺少相遇信息的初始环境下,不断迭代发布属于同一个服务行业的服务信息后,覆盖率变化趋势及不同轮次下的覆盖率的比较.实验连续执行多轮,每轮实验为10min,从图6中可以发现,在最初几轮,覆盖率不高,但随后逐渐提高,说明积累的相遇信息为预测提供了较为准确的数据,对于提高预测的准确性起到了关键作用.同时,在第8轮时,在最初的几分钟内即可达到较高的水平,即将近90%的覆盖率.这表明本文算法的收敛速度快,可以在较短的时间内达到较高的覆盖率.实验3.可扩展性是指算法适应系统不同规模的能力.特别是在大规模的系统环境下,算法的基本性能是否会降低是可扩展性的重要标志.这里关注在不同的节点密度,移动速度情况下,算法性能的变化情况.本文在节点数n=100时,将节点移动速度最大值vmax分别设为4m/s、6m/s和8m/s;在移动速度最大值vmax=4m/s时,将节点数量n分别设为100、150和200.仿真结果如图7(a)和图8(a)所示,随着节点密度、移动速度的增加,算法的覆盖率在逐步提高.这是因为随着节点密度的增大,一跳通信覆盖的节点将增多,这有效提高了信息传播范围;而节点移动速度的提高,可以在较短时间覆盖更多的新的节点,这有效加快信息传播速度.同时,只改变节点最大移动速度时(图7(b)),由广告发布而产生的网络流量变化不大,这是由于本文算法中,rep-licanum数k和TTL数t是决定消息总数的主要因素.此外,在不同节点数量的情况下(图8(b)),由于广告目标节点按照相同比例设置,节点数增加后,广告目标节点随比例增加,这导致消息数自然增长.Page12实验4.节点失效对算法性能的影响.现实环境中,部分节点会因为电量消耗殆尽而导致失效,本实验考虑这种情况下算法的鲁棒性.实验中,节点的能耗符合式(12),(13)的模型,广告消息为定长800bit长度,节点初始电量在[1500,4000]焦耳之间随机分布.随着时间的流逝,由于消息的收发,会有一些节点因电量耗尽而失效,如果电量耗尽,则不会恢复,因此若该节点被选作广告代理,也将失去消息转发功能.但节点失效的时间不确定.图9记录了节点失效比例从1%上升到10%时算法的性能变化.由于本文算法在选择广告代理时考虑节点的电量水平,这保证选择的广告代理近期不会因为电量耗尽而失效,而随机选择方法选择到的节点可能会因电量水平低而在近期失效,不能完成消息转发任务.此外,根据式(12),节点的电耗和节点发送的消息比特数有关.由实验1可知,本文算法产生较少的消息量,因此节点电耗较小,生存期较长,这有助于消息的转发.图9在不同节点失效比例下的覆盖率变化对比6应用价值讨论随着智能手机等掌上设备的普及和直接联网需求的增强,机会社会网络已成为一种新型的网络形态.机会社会网络不依赖于通信基础设施,因此和其它需要通信基站进行通信的方式相比,具有不产生通信费用、高带宽、联网便捷等优势,必将成为移动人群共享信息和服务的方式之一.而网络上能否提供和用户工作、生活密切相关的丰富的服务,并易于使用,是其能够普及和被广泛接受的重要因素.面向服务的体系结构所具有的松耦合、可快速集成、易网络访问的特点,很适合移动环境下的数据访问和临时性快速应用集成.例如,在一个学术会议现场,参会学者通过自己的移动办公设备(智能手机、笔记本电脑等)随时便捷地访问会务信息服务、打印设备服务、旅馆服务等.为了宣传自己的研究成果,他们也可以在自己的办公设备上维护一个论文信息服务(提供论文稿件、演讲稿和作者信息等).论文信息服务和打印设备服务可以组合,完成文稿打印任务.而实现这种应用的关键是迅速发现服务和动态快速地组合服务.相对于商业应用上持久性的复杂服务组合,这种组合是临时的、轻量级的、机会的[7].和以往从服务使用者主动发起服务发现请求不同,本文从服务提供者的角度出发,提出基于服务社会上下文的服务广告主动分发机制,实现了服务信息的主动高效分发.仿真实验表明,本文机制适合于以社区为基本单元的移动网络环境,可以应用于校园、机场等具有明显社会关系特征的机会社会网络环境中.7结束语本文研究机会社会网络中的服务发现问题,提出基于服务社会上下文的服务广告分发机制,以解决此类网络环境下由于节点移动性、拓扑动态性和资源受限所引起的服务注册库失效问题.根据机会社会网络的社会关系特性和服务在交互调用过程中所体现出的社会关系特征,论文首先提出了服务社会上下文的定义和参数度量方法.然后,基于服务社会上下文,提出服务广告分发协议及优化机制.实验表明,本文提出的算法可以在减少广告消息数的同时,提高广告投放的覆盖率.未来工作包括以下几个方面:一是利用社会关系熟悉程度,判断对节点的信任程度,建立可信服务广告机制,以降低恶意节点发布虚假服务广告信息的可能;二是研究移动节点的缓存策略,充分利用移动节点缓存构成的移动P2P缓存储存服务信息,提高服务主动发现的性能;三是考虑用户个性,通过用户个性化的服务广告发布,减少网络负载开销,提高用户满意度.致谢匿名评审专家对完善本文所提出了宝贵的意见和建议,在此表示感谢!
