Page1云环境下一种隐私保护的高效密文排序查询方法程芳权彭智勇宋伟王书林崔一辉(武汉大学软件工程国家重点实验室武汉430072)(武汉大学计算机学院武汉430072)摘要数据前端加密是保护云环境下外包数据隐私的一种有效手段,但却给数据查询等操作带来挑战.针对云环境下多数据拥有者数据外包及选择性访问授权特征,为支持大规模加密云数据上高效且隐私保护的用户个性化密文查询,文中提出了一种隐私保护的高效密文排序查询方法RQED.通过设计无证书认证的PKES(支持关键词检索的公钥加密),并构建RQED框架来实现强隐私保护的密文查询.基于该框架,设计了更合理的多属性多关键词密文查询排序函数,并提出了基于层次动态布隆过滤器的RQED索引机制,提高密文查询时空效率.理论分析和实验性能对比证明:RQED在确保查询强隐私保护和高准确性的同时,具有较明显的时空效率优势.关键词云计算;布隆过滤器;排序查询;层次索引;无证书认证1引言云计算是一种新型网络计算模式并被喻为信息领域的工业化革命[1].云环境下,以“X-as-a-Serv-ice”和“Pay-as-you-go”为核心理念,驱动企业或用户将本地数据及其复杂管理外包给云服务提供商[2-3](CloudServiceProvider,CSP),从而利用“云”充足的计算、存储和网络等资源,使用户只需较小的代价就能快速获得高质量的数据服务及应用.但数据安全和隐私保护在云计算问题中首当其冲.外包于云端的隐私数据完全脱离其拥有者的直接物理控制,将面临外部网络攻击者和CSP中不可信(诚实而好奇[4])管理员的双重威胁.采用前端加密是解决上述安全问题的一种有效方法[2-4],即数据拥有者在本地可信前端对数据加密后再外包给CSP,查询时则从CSP获取满足请求的密文数据并在前端解密.如此一来,密文数据查询则不再具有明文查询特性而成为重要挑战,且云环境下密文查询有以下两方面需求:一方面,面向云端海量数据特征和用户个性化查询需求,有必要提供针对多关键词、多属性请求的高效密文排序查询[3],充分表达用户查询兴趣,高效返回更能精确满足用户需求且具有重要度区分的所有排序结果或Top-k排序结果,使用户能快速定位与查询最相关密文数据,同时也减小网络传输开销.另一方面,不同于传统企业级单数据拥有者数据外包,云环境下数据外包应用更具有多数据拥有者数据发布及选择性访问授权、多源数据查询等特征.如Email系统等,任何用户都可以作为数据拥有者外包数据并选择性授权其所有或部分数据给任何其他用户查询访问,用户查询则执行其被授权的来源于不同数据拥有者的所有数据.该特征下,将使用户面临更具威胁的攻击,如不可信CSP与部分恶意数据拥有者之间合谋对其他任何用户隐私的攻击.同时考虑到云环境下的“Pay-as-you-go”理念、轻量级用户查询客户端及高要求用户体验等特征,极有必要提供针对上述特征的时空高效密文查询及查询授权控制,并确保其针对各种攻击的强隐私保护能力.其时空高效表现为:数据发布时数据、索引等的低传输/存储代价,数据查询时请求转换的客户端低计算代价以及云端密文查询的低执行代价.而隐私保护则要求除了保护数据隐私,还需确保密文索引和查询过程无隐私泄露.目前针对数值型数据[4]和字符型数据[5-12]的密文查询都有大量的方法提出,Cao等人[3]也在2011年第一次提出并解决了单数据拥有者云环境下的隐私保护多关键词密文排序查询.然而,现有方法仍无法满足上述云环境下的密文查询需求:首先,未全面考虑多关键词查询相似度计算的贡献因素,如多属性数据查询、关键词隐私保护权重、用户被授权可访问的数据范围等,无法有效实现更客观、合理的密文排序查询.其次,无法在支持多数据拥有者数据外包及其选择性数据查询授权的同时,兼顾密文查询的强隐私保护能力、时空高效性、查询及结果排序准确性,如无法在保证查询隐私前提下,支持大规模数据高效、准确的多关键词密文排序查询并保持较低索引空间(传输/存储)开销等.针对以上问题,本文提出了一种支持隐私保护的高效密文排序查询方法(RQED),旨在满足上述云环境下密文查询需求,主要贡献:(1)提出了针对云环境下多数据拥有者数据外包及选择性数据查询授权特征的多属性多关键词密文排序查询,并定义其系统模型和攻击模型.基于无证书认证思想[13-14]设计不依赖于可信第三方和安全传输信道的可认证PKES(支持关键词检索的公钥加密[8-9]),并构建支持系统模型的RQED框架以增强查询隐私保护.(2)基于RQED框架,设计支持多属性数据隐私保护词权重、查询词权重及用户被授权可访问数据范围等更客观、合理的密文查询排序函数.(3)考虑到单数据量不确定性、数据和授权更新不确定性以及大规模密文数据查询,为提高密文查询执行与密文索引的时空效率,提出了基于层次动态布隆过滤器的RQED索引机制.(4)理论分析了RQED机制对密文查询各种隐私的保障,并通过真实数据集上的实验分析展示出RQED机制在兼顾查询高准确性和强隐私保护的同时,还具备了较高的时空效率优势.2相关工作目前国内外学者和研究人员针对加密数据查询方面做了大量工作,旨在实现密文数据查询的功能丰富、高执行效率、低空间开销和强隐私保护,本文相关工作大致分为以下方面:(1)关键词密文查询.现有基于关键词的密文Page3查询方法主要分为单关键词查询和多关键词查询,其目的都是通过索引关键词构建密文数据索引以实现相关查询,并确保其针对无查询密钥的非授权用户不泄露数据隐私.Song等人[5]第一次提出基于对称密钥的单关键词可检索加密方法,Goh[7]基于布隆过滤器对其效率进行改进,同时Curtmola等人[10]在Song的基础上给出更严格的安全性定义和更高效的对称密钥可检索加密方法构造.Wang等人[11]考虑关键词词频信息,提出基于对称密钥保序加密技术OPSE的单关键词分级密文排序查询方法,该方法对相似度计算并未全面考虑,因为需要扫描所有文档而不易进行索引更新.然而,单关键词查询不足以表达和满足用户的个性化查询需求,且涉及过多查询结果而导致巨大的网络通信负载.Li等人[12]针对关键词精确匹配的不足提出基于编辑距离的加密字符串模糊检索方案.然而这些方法却仅仅针对“all-or-nothing”的查询方式,并返回给用户完全无区分性的查询结果.为了进一步满足用户个性化查询需求,Cao等[3]第一次提出多关键词密文排序查询问题,并基于安全KNN查询技术[6]中索引向量与查询向量间“内积相似度”来实现排序查询并进行隐私保护增强.然而,该方法并未考虑数据中索引关键词权重及查询关键词权重等因素,从而不能返回满足用户查询请求的准确排序结果;并且该方法需要构建系统枚举索引关键词词典并在用户端存储,这无疑不符合实际应用且造成较大客户端负担.例如,当词典规模为N时,其用户需要安全传输和存储的密钥矩阵空间开销为O(N2)则随着N增大将带给客户端难以承受的负担.(2)密文查询隐私保护.事实上,现有方法都试图在具有一定攻击能力的特定攻击模型下执行查询图1云环境下隐私保护的密文排序查询结构图隐私保护.基于对称密钥加密的查询隐私保护[3,5-6]具有较高的执行效率,然而一方面,若采用同一个密钥进行所有用户的查询授权控制,则完全无法抵御内部用户与CSP的合谋攻击;若实施选择性查询授权控制,即数据拥有者对不同用户授权不同的查询密钥,显然将带来复杂的密钥安全分发和管理问题(随着系统数据和用户规模扩大,其密钥安全管理极具挑战[15]且近似于NP完全困难问题).文献[3]试图通过扰乱排序实现查询隐私保护,但其内部用户完全可以根据自己所掌握的密钥与CSP合谋推理出其他用户的查询请求隐私.针对上述缺陷,Boneh等人[8]首次基于DH密钥交换协议提出关键词可检索的公钥加密方法(PKES),通过公钥加密和私钥查询很好的避免了上述选择性查询授权中的复杂密钥管理问题.Boneh等人[9]在此基础上,进一步提出了支持PIR查询的公钥加密方法,但需要繁重的客户端与服务器端间交互.相对于基于对称密钥的方法,PKES显然更具有优势.然而,现有PKES方法存在局限性:算法构造中忽视公钥的认证;当存在多数据拥有者查询授权时,用户查询过程难以抵御恶意数据拥有者与CSP的合谋攻击;索引缺乏动态伸缩性致使空间开销较大;查询时直接匹配每个数据索引导致查询效率低下;无法高效支持云环境下大规模数据的多关键词排序查询.3问题定义3.1系统模型如图1所示,我们认为一个典型的云环境下多数拥有者数据外包服务系统主要包括以下3个实体:云服务提供商CSP、数据拥有者用户和被授权Page4用户.系统任何用户都可以作为数据拥有者发布数据,也可以同时作为被授权用户获得其他用户的数据访问权限.假设数据拥有者用户珘u有数据集珘u需要外包给CSP,为保障数据安全,首先将珘u加密为密文数据珘u.而珘u可以根据自己的需求选择性地授权珘u中所有或部分数据给被授权用户u进行访问.为了实现在密文数据珘u上的查询能力,珘u在外包数据前还需要根据珘u构建其密文索引珘u.然后再将密文数据及对应密文索引{珘u,珘u}外包给CSP.当被授权用户u提交查询时,通过如图1中所示查询授权控制机制,u能够正确转换为查询(又称为Trapdoor),并提交CSP.CSP利用陷门在系统所有密文索引集和密文数据集上执行查询,并返回满足查询条件且按查询相关度排序的所有结果或Top-k结果.最终,通过如图1所示的数据访问控制机制[15],u从相应数据拥有者获取结果数据对应密钥安全解密数据内容.本文旨在设计上述系统模型下强隐私保护且时空高效的多属性多关键词密文排序查询方法.3.2攻击模型攻击者.按照其攻击能力由弱至强分为:(1)外部攻击者,即网络攻击者,在系统中最普遍且攻击能力最弱;(2)CSP,即不可信(诚实而好奇)系统管理员,他承诺正确执行与用户的数据托管协议,但无法避免其恶意窥窃或分析用户数据、索引及查询请求,从而获取用户隐私信息;(3)内部攻击者,包括恶意数据拥有者和被授权用户,通过其已掌握的部分信息(如部分数据、索引、Trapdoor、密钥等)来试图攻击其他用户隐私信息;(4)合谋攻击者,包括被授权用户与CSP合谋和数据拥有者与CSP合谋,后者较前者有更强的攻击能力.攻击方式.正如文献[3]所述,存在两种攻击方式:(1)已知密文攻击,攻击者仅仅掌握密文数据、密文索引及密文查询请求Trapdoor;(2)已知背景攻击,攻击者在已知密文基础上,还掌握部分关键词或关键词频等静态信息、部分给定关键词与数据的关联信息以及部分给定Trapdoor间的关联信息等.后者有更强攻击能力,而外部攻击者只能执行前者.本文目标是在上述攻击模型下,保障密文排序查询的隐私需求[3],详见5.1节安全性分析.3.3主要符号说明u;U任何一个用户;系统所有用户集合.珘u;OU任何数据拥有者;所有数据拥有者集合.OUU.引集.;;系统明文数据集;密文数据集;密文索;任何一个数据属性标识;所有属性集合.珘u;珘u;珘u珘u外包的明文数据集;密文数据集;密文索引集.=∪珘u∈OU珘u;=∪珘u∈OU珘u;=∪珘u∈OU珘u.珘u;珘u;珘u珘u外包的其中一条明文数据;密文数据;密文索引.即珘u∈珘u;珘u∈珘u;珘u∈珘u.珘u,珘u中属性上的数据值,即珘u,∈珘u.W珘u,中所包含的索引关键词集合.W,lW中第l个索引关键词.EW,lW,l加密后的密文索引词.EWW加密后的密文索引词集合.EW珘u经处理后的所有密文索引词集合.u的查询请求.的查询Trapdoor.~;WW珘u,WTrapdoor.HBFi=[1,K]布隆过滤器的K个Hash函数簇.HBFi=[1,K](x)x映射到布隆过滤器的K个位BF[HBFi=[1,K]()x]位于布隆过滤器BF中K游标.个位游标处的K个值.4RQED机制4.1RQED框架概念1.双线性配对映射[13-14].假设G1和G2是两个阶都为大素数p的乘法群,映射e^:G1×G1→G2称为双线性配对映射,则映射e^满足如下性质:(1)双线性.对于P,Q∈G1和a,b∈Zp,都有e^(Pa,Qb)=e^(P,Q)ab.(2)非退化性.P,Q∈G1,使得e^(P,Q)≠1.(3)可计算性.对于P,Q∈G1,都会有一个有效的多项式时间算法来计算e^(P,Q).针对上述系统模型和安全模型,我们首先构造RQED框架.该框架中,通过设计不依赖于可信第三方和安全传输信道的无证书认证PKES来实施复杂的多数据拥有者选择性查询授权控制并增强查Page5询隐私保护.基于该框架,我们设计多属性、多关键词的隐私保护RQED排序函数,并进一步提出基于层次动态布隆过滤器索引的RQED机制.无证书公钥密码[13-14]的基本思想即通过引入半可信第三方KGC来辅助用户公私钥对生成及公钥认证,但KGC却并不能掌握威胁用户私钥的相关信息.本文在VipulGoyal[14]所提出的无证书思想基础上,构造高效的可认证PKES.在本文系统模型和框架中,我们认为CSP是一个典型的半可信第三方实体(诚实而好奇),可以充当KGC角色.RQED框架由以下部分组成:Scenario.为了阐述更为清晰,我们这里仅以数据拥有者珘u的单条数据珘u为例,而珘u的其它数据处理过程完全相同.珘u对应的密文数据及索引分别为珘u、珘u,且珘u={珘u,|∈}.同时假设珘u将数据珘u的访问权限授权给用户u.然后,用户u提交查询请求,且包含有属性集个查询关键词WKGC→u:KGC接收到(Ru,IDu),首先对其进行零知识证明[14],若证明失败则放弃交互,否则计算QIDu=H1(IDu)以及用户u的部分公钥Hu=(Ru)1/(α-QIDuu:u获得Hu后首先对其进行真实性认证,即判断e^(H1/auu,g1g-QIDu)=?e^(h,g).若等式成立,则确定其公私钥对Ku生成失败.Setup(1).KGC生成系统主密钥α并秘密保存,同时选取阶都为p的乘法群G1和G2以及满足概念1所述性质的双线性映射e^:G1×G1→G2.令g、h是G1的两个生成元,并设置g1=gα.同时,选取一个Hash函数H1:{0,1}→ZHBFi=[1,K]={HBFi|i=[1,K]},且HBFi:{0,1}→m(针对后面4.3节,K为Hash函数个数,m为任何标准布隆过滤器[16-17]的位长度).最终系统公开参数为ppub={G1,G2,e^,g,g1,α,H1,m,HBFi=[1,K]}.KeyGen(α,Ppub).任何用户u加入系统时,该算法通过u与KGC的交互生成u的公私钥对pub,Ku(Kuu→KGC:u随机选取一个大整数作为秘密值au并秘密保存,同时计算其公开值Ru=hau.然后传输对值(Ru,IDu)给KGC,其中IDu是用户u的身份标识.PreProcData(珘u).对于珘u,∈珘u,将其预处理为索引关键词的集合W.并对W,l∈W,计算其权重相关信息.PKES(珘u,IDu,Hu,a珘u).对于∈,W,l∈W,数据拥有者珘u对W,l进行PKES加密成为密文索引词EW,l.该加密处理涉及珘u的私钥K珘u被授权用户u的可认证公钥Ku如下:(1)计算QID珘u=H1(ID珘u)和QIDu=H1(IDu).(2)判断e^(Hu,g1g-QIDu)=?e^(Ru,g).若等式成立,执行对u授权,否则放弃授权.(3)计算EW,l=e^((Hu)a珘u·H1(W最终得珘u,对应的所有密文索引词为EW,珘u对应的所有密文索引词为EW={EW|∈}.RQED机制中,我们将属性标识引入PKES加密及下面的Trapdoor计算,以此来区分数据及查询请求中的不同属性关键词.相对于传统单属性查询,如此处理的优势是多属性数据仅需采用同一个索引,提高索引空间效率.法输出珘u的密文索引珘u.BuildIndex(EW).输入密文索引词EW,该算PreProcQuery().令中任何属性个查询关键词集合W~,为WWTrapdoor(,au).令已授权给u的数据拥有者集合为OUu,则对于OUu,利用u的私钥Ku询子Trapdoor珘u,W最终得查询的查询陷门Trapdoor:={珘u,WQuery(法并返回满足条件的所有排序结果或Top-k结果.4.2RQED排序函数基于上述RQED框架,我们设计了更合理且隐私保护的多属性多关键词密文查询排序函数.信息检索(IR)领域,数据(文档)与给定查询请求间的相似度是用于查询排序的最常用标准,相似度越高则越满足用户的查询兴趣.单关键词排序查询中相似度计算广泛采用的是TF×IDF规则,其中TF指数据中的简单关键词频,反映关键词在数据中的重要度;IDF指反数据(文档)词频,反映关键词在整Page6个数据集中的区分度.然而,在本文系统模型下,仅仅考虑单关键词与数据间的相似度是不可行的[3,11],特别是针对隐私保护的多关键词排序查询(例如,关键词词频泄露会导致遭受已知背景统计攻击[3]).RQED机制中,在保护隐私前提下全面分析相似度计算的贡献因素,涉及两个重要概念:一方面最重要的是针对数据不同属性的隐私保护关键词权重(Privacy-preservingDataKeywordWeight,PDKW),另一方面则是用户自定义的查询请求不同属性关键词权重(QueryKeywordWeight,QKW).归纳起来,RQED机制的关键点体现在:(1)数据发布时如何计算PDKW;(2)构建索引时如何存储PDKW;(3)查询时如何获取PDKW;(4)如何利用PDKW和QKW计算查询结果相似度并排序.考虑到多关键词查询中“OR”查询逻辑更为普遍,且“AND”查询逻辑可以通过“OR”实现,因此本文仅以“OR”查询为例进行阐述.RQED框架的PreProcData中,所做的主要处理任务是计算数据珘u中每一个关键词的PDKW,对于W,l∈W,定义其PDKW为W于对传统经典方法的分析设计了更合理的PDKW计算函数,如下W(TFW,l=δ·εW,l/(lg(max式(1)中,δ和εWPDKW计算客观性而设计的调整因子.在数据挖掘领域的文摘抽取、QA等技术中也有类似思路,而现有安全云数据排序查询方法却完全未考虑.δ用于关键词在不同属性中的重要度区分,即数据属性特
