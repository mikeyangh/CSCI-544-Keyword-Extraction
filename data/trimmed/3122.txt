Page1分工式门限认证加密方案谭作文1),2),3)范艳芳4)1)(江西财经大学信息管理学院计算机系南昌330032)2)(福建师范大学数学与计算机学院网络安全与密码重点实验室福州350007)3)(中国科学院软件研究所信息安全重点实验室北京100190)4)(北京交通大学计算机与信息技术学院北京100044)摘要(t,n)门限认证加密方案允许t个以上签名方产生指定接收方的认证加密签名,使得只有指定的接收方能够恢复消息和验证消息的完整性,而其他人却无法做到这一点.最近,在Tseng和Jan的认证加密方案的基础上,Chung等构造了一个(t,n)门限认证加密方案.该方案运用了分工式签名技术,有效地减轻了签名方的负担.然而,该文作者对该方案的安全性仅进行了解释性说明.目前,文献中没有对分工式门限认证加密的形式化刻画,没有出现可证安全分工式门限认证加密方案.事实上,Chung等的分工式门限认证加密方案存在设计上的缺陷.文中给出了分工式门限认证加密方案的形式化模型和安全模型,基于双线性映射构造了一个新的分工式门限认证加密方案.在随机预言机模型下,证明了该方案对于适应性选择密文攻击是语义安全的,该方案对于适应性选择消息攻击是存在性不可伪造的.方案的安全性可规约到计算性Diffie-Hellman(CDH)困难假设和决定性双线性Diffie-Hellman困难假设(DBDH).关键词公钥密码学;门限签名;认证加密方案;随机预言机模型1引言消息的私密性和对消息发送者的认证是开放网络环境下通信的两个基本安全目标.加密方案和签名方案或消息认证码能够分别用来实现上述目标.Nyberg和Rueppel[1]基于离散对数问题提出了第一个具有消息恢复功能的签名方案.在他们的方案中,签名方产生消息的签名后,只有指定的验证者才能恢复消息,认证消息的发送者和验证消息的完整性.这种方案被称作认证加密(authenticatedencryption)方案,简称AE方案.自从Nyberg和Rueppel提出第一个AE方案以来,已有大量的AE方案[2-3]被设计出来.AE方案能够同时实现消息的私密性和发送方的认证性两个目标.为了给AE方案增加更多的安全性能,Nyberg和Rueppel[2]认为构造AE方案最好的方式是先签名-后加密(sign-then-encrypt).通过先签名-后加密,签名方能够保证只有指定的消息接受者或验证方才能解密并验证签名.可证安全是密码学组件设计的一个十分重要的基本要求.Bellare和Rogaway定义[4]了随机预言机模型(RandomOracleModel,RO模型).然而,AE方案一直到Bellare和Namprempre[5]讨论对称密码系统中的AE方案,才有了形式化的安全定义.文献[6]将AE方案的认证性分为明文完整性和密文完整性,而将方案的私密性分为选择明文攻击下的不可区分性(IND-CPA)和选择密文攻击下的不可区分性(IND-CCA)以及选择明文攻击下的非延展性(NM-CPA).该文还分析了对称密码方案与消息认证码(MAC)通过常规组合方法构造的AE方案的安全性.这些常规组合方法包括加密-MAC(Encrypt-and-MAC)、先MAC-后加密(MAC-then-encrypt)和先加密-后MAC(Encrypt-then-MAC).对于每一种构造方法,Bellare和Namprempre讨论了在对称密码方案具有选择明文攻击安全IND-CPA和MAC具有选择消息安全时,相应AE方案的安全性质.此外,文献[5]给出了AE方案的安全性质严格证明.对于AE方案不具有的安全性质,也给出了反例.在2001年,An[7]给出了非对称密码系统中AE方案形式化的安全定义.文献[7]提出了非对称密码系统下AE方案的两个认证概念,这些认证性概念比对称密码系统中AE方案的完整性具有更强的密码学意义.与对称密码系统AE方案[6]形成鲜明对照的是,非对称密码系统中的AE方案[8]即使具有选择明文攻击下不可区分性(IND-CPA)和密文完整性(integrityofciphertext,INT-CTXT),仍无法保证AE方案具有抵抗适应性选择密文攻击下的不可区分性(IND-CCA2).An分别使用3种常规组合方法,即加密-签名(Encrypt-and-Sign)、先签名-后加密(Sign-then-Encrypt)和先加密-后签名(Encrypt-then-Sign),把公钥密码加密方案和数字签名方案构造成AE方案,并对3种AE方案的安全性质进行了分析.研究表明:3种构造方法中没有哪一种方法可以确保相应的AE方案具有文献[7]中所定义的所有安全性质.An还证明了:即使是基于Diffie-Hellman的认证加密方案也不能满足下列较强意义的安全性质:抵抗选择明文攻击下接收方密文存在性不可伪造性(receiverexistentialunforgerywithciphertextforgery,RUF-CTXT)和抵抗选择消息攻击下接收方明文存在性不可伪造性(receiverexistentialunforgerywithplaintextforgery,RUF-PTXT).另一种可以同时提供认证和保密性的密码学概念是由Zheng首次提出来的签密[6].AE方案和签密方案同时将签名与加密结合起来,但在AE方案中加密和认证仅仅使用对称密码系统(对称系统环境中的AE方案),或仅仅使用公钥密码系统(非对称系统环境中的AE方案).但是,签密方案必须同时使用对称密码系统和公钥密码系统.基于非对称密码系统的AE方案存在一个缺Page3陷:因为只有指定的接收者才能验证签名的有效性,签名方可能会否定自己所产生的签名.为了解决这个问题,Araki等[8]提出了一种可转换认证加密方案(ConvertibleAuthenticatedEncryption,CAE).CAE方案可以将认证加密的结果转换为一般的数字签名,任何收到签名的参与方都可以验证签名的有效性.2002年,Wu等[9]发现:在Araki等的CAE方案[8]中,如果签名方不合作,认证加密的结果就不能转换为一般的数字签名.Wu等提出了一个改进的CAE方案[9].然而,Huang和Chang发现[10]:在Wu等的CAE方案中,攻击者如果得到了消息,就能轻易地将认证加密的结果转换为一般的数字签名.Huang和Chang设计了一个新的CAE方案[10],弥补了Wu等的CAE方案的缺点.为了降低风险,一个文件常常由两个或更多的签名方来执行签名.面向群的签名就是这种类型的签名之一.Itakura与Nakamura于1983年应用面向群的签名构造了多重签名方案[11].然而文献[8-10]中的CAE方案并不适合存在多签名方的情形.Wu等构造了一个有消息冗余的可转换多重认证加密方案[12](ConvertibleMulti-AuthenticatedEncryption,CMAE).Tsai运用单向杂凑函数构造了基于离散对数问题的高效CMAE方案,消除了消息冗余[13].门限签名[14-15]是另一种类型的面向群的签名.这种签名常常需要运用密钥共享技术,n个参与者组成的团体中,任意t个或t个以上参与者可以代表整个团体对消息签名,而少于t个不能够代表整个团体对消息签名.Chen等应用门限签名构造一个门限AE方案(ThresholdAuthenticatedEncryp-tion,TAE)[16].对AE方案的研究方向除了形式化安全证明外,还有如何提高AE方案的效率[3,17-18].尽管在签名方案中使用消息的Hash值能够有效减少签名大小,但在AE方案中却不能使用该技术,因为必须从密文中恢复消息.签密也许更适合于传输较长的消息.然而,签密需同时使用对称密码系统和非对称密码系统.因此,在设计AE方案时,一些研究者利用分工式技术将较长的消息分成若干短消息块,每个消息块附有前一个消息块的链接信息和产生前一个消息块签名的秘密信息[17-18].最近,Chung等基于门限密码系统[19]和Tseng与Jan的AE方案[20],借助于分工式技术构造了一个(t,n)门限TAE方案[21],该方案中每个消息块附有前一个消息块的链接信息.分工式技术的主要思想是:整个消息先被分成若干消息块,每个签名参与者分配到其中一个消息块,每个签名参与者只对自己的消息块进行认证加密,最后将所有子密文组合成整个消息的面向群的密文.为了简单起见,下文称Chung等的TAE方案[21]为CHC-DOLTAE方案.Boneh、Lynn和Shacham设计了一个基于双线性映射的高效率短签名方案(BLS)[22].该签名方案基于计算性Diffie-Hellman(CDH)假设在RO模型中是可证安全的.本文的主要贡献是:CHC-DOLTAE方案[21]使用分工式签密技术处理较长消息,能够有效地减少每一个签名方的工作负担,所采用的TAE方案里的门限策略能改善AE方案面向群的安全性.但是,本文分析发现CHC-DOLTAE方案存在着设计上的缺陷.而且,文献[21]仅对CHC-DOLTAE方案安全性质做了解释性说明.可证安全性是密码协议设计时不可缺少的要求.在形式化的模式下设计安全分工式门限认证加密方案(Division-Of-LaborbasedThresholdAuthenticatedEncryption,DOLTAE)是一个有趣的问题.对于公钥认证加密(PKAE)方案的安全性,仅仅考虑方案能够抵抗接收方攻击和第三方攻击下适应性选择密文攻击就足够了.然而,对于TAE方案,其安全性并不尽相同.因为对于TAE方案,敌手也许来自第三方、接收方或者t-1个签名参与方,甚至可以是t-1个签名参与方与接收方组成的合谋团体.在TAE方案中,恶意的接收方可能与一部分签名方合谋伪造有效密文,而只需要求参与合谋的签名方数目少于门限值.在上述敌手中,最后一种敌手具有最强大的攻击能力.在本文中,将讨论DOLTAE在接收方与t-1个签名参与方合谋攻击模式下适应性选择消息攻击的保持密文完整的不可伪造性(Unforgeabilitywithciphertextin-tegrity,UF-CTXT).这样把TAE方案认证安全从文献中较强意义下的RUF-CTXT扩展到最强意义下的UF-CTXT.在BLS方案的基础上,我们设计了一个具体的DOLTAE方案.新的DOLTAE方案被证明:基于CDH和DBDH(DecisionalBilinearDiffie-Hellman)假设,在RO模型中,具有抵抗适应性选择密文攻击紧致不可区分性(IND-CCA2)和抵抗适应性选择消息攻击保持密文完整的不可伪造性(UF-CTXT).此外,从本文构造的DOLTAE方案,很容易Page4构造出多重认证加密方案(Multi-AuthenticationEncryption,MAE)或TAE方案.本文第2节给出部分预备知识;第3节简单回顾一下CHC-DOLTAE方案;DOLTAE方案的形式化模型在第4节给出;第5节描述新的DOLTAE方案;第6节分析新方案的安全性;最后是全文的总结.2预备知识在这一节,回顾一下双线性映射和一些密码学假设.2.1记号首先介绍本文将要使用到的一些记号.令UU={U1,U2,…,Un}表示n个签名方组成的签名方群,Ui表示第i个签名方(i=1,2,…,n).UUaa表示实际签名参与者组成的签名方群,Ur是密文接收方,Uc是实际签名方群UUaa中的签名收集者,Uc可以是UUaa中的任何一个签名方.用Ind(SET)表示指标集{i|Ui∈SET}.2.2双线性映射G1与G2是两个素数p阶循环群,g是群G1的一个生成元.e是一个从G1×G1到G2的可容许映射,该映射满足下列性质:e(ua,vb)=e(u,v)ab.(1)双线性.对于任意u,v∈G1,a,b∈Z(2)非退化.e(g,g)≠1.(3)可计算性.对于任意u,v∈G1,均存在有效定义1(DBDH问题).已知循环群G1中四元算法计算e(u,v).2.3密码学假设组(g,ga,gb,gc),其中a,b,c∈Z于Z∈G2,判断Z=e(g,g)abc是否成立.分器A具有的优势定义如下:SuccDBDH一个能求解DBDH问题的概率多项式时间区定义2(DBDH假设).已知循环乘法群G1中四元组(g,ga,gb,gc),其中a,b,c∈Z数,对于Z∈G2,求解DBDH问题的概率多项式时间区分器A具有的优势是可以忽略的.定义3(CDH问题).已知循环乘法群G1中三元组(g,ga,gb),其中a,b∈Z算gab.一个能求解CDH问题的概率多项式时间算法A具有的优势定义如下:SuccCDH定义4(CDH假设).已知循环乘法群G1中三元组(g,ga,gb),其中a,b∈ZCDH问题的概率多项式时间算法A具有的优势SuccCDHA,G1是可以忽略的.定义5(DDH问题).已知循环乘法群G1中四元组(g,ga,gb,gc),其中a,b,c∈Z判断gab=gc是否成立.如果存在可容许映射e:G1×G1→G2,那么G1中的DDH问题很容易通过e(ga,gb)=e(g,gc)来解决.定义6(GDH群).如果群G1中的CDH问题是难解的,而DDH问题容易求解,就称G1是GDH群(GapDiffie-HellmanGroup).3CHC-DOLTAE方案回顾为了更好地理解分工式认证加密技术,在这一节先回顾一下CHC-DOLTAE方案[21],然后对该方案的安全性做简要分析.CHC-DOLTAE方案[21]在椭圆密码系统[23]和DOLTAE方案[16]的基础上运用了消息链接技术和分工式签名技术.在CHC-DOLTAE方案中,签名群UU中的每个签名方Ui具有公开信息xi.根据实际签名方子群中的参与者数目如t个,将每个较长的消息分成t个消息块,然后给每个签名参与者分配一个消息子块.实际签名方子群中的参与者只需要对分配给他的消息子块签名.CHCDOLTAE方案包含3个阶段.系统初始化阶段.系统可信方SA选择大素数p和q,有限域Fp,Fp上椭圆曲线E的q阶点群E(Fp)和E(Fp)的一个生成元P.设h()是一个公开的单向杂凑函数.SA通过下列方式产生方案各个参与者的私钥.(1)在多项式环Fp[x]中随机选择一个(t-1)次多项式:(2)将e0作为签名方群UU的私钥,计算Ys=e0P(3)对于签名方群UU中的每个签名方Ui(i=1,(4)在Z作为它的公钥.2,…,n),计算私钥f(xi)和公钥Yi=f(xi)P.计算Ur的公钥Yr=xrP.Page5认证签名产生阶段.不失一般性,假设实际签名方子群UUaa是由t个签名方组成{Ui|i=1,2,…,t}.签名方子群UUaa要认证加密消息M.UUaa中t个签名方合作将消息M分成t个相关联的消息块{M1,M2,…,Mt}.不妨设Mi∈Z攻击,每个消息块Mi均附有消息冗余.每个签名参与者Ui分别对分配给自己的消息块Mi通过下列步骤产生签名.(1)在F(2)计算zi=(bi·xBi)Yr=(xzi,yzi).(3)通过安全信道将Bi和zi发送到UUaa中的其他(4)收到其他签名参与者发送来的(Bi,zi)(i=B=∑t(5)计算消息块Mi的子密文(ri,si),并在实际签名方子群UUaa中发布子密文:ri=Mih(i‖xV)modp,si=xBi·bi-ri·f(xi)·∏t当签名收集者Uc收到子密文(ri,si)时,i=1,2,…,t,Uc先验证其有效性:签名参与者.1,2,…,t)后,计算B和V:如果对于i=1,2,…,t,上述等式都成立,则Uc将所有子密文组合成整个消息M的密文.最后,Uc发送密文(r,s,r1,r2,…,rt)给指定的接收方Ur.后,执行下列步骤恢复消息.消息恢复阶段.Ur收到签名(r,s,r1,r2,…,rt)(1)计算与实际签名方群UUaa共享会话密钥V.(2)对于i=1,2,…,t,逐个恢复消息块{M1,M2,…,Mt}(3)通过每个消息块附有的冗余信息判别消息块的有效性.如果所有消息块都是有效的,Ur获取整个消息M.文献[21]给出了CHC-DOLTAE安全性质的解释性说明.因此,其安全性分析不是令人信服的.分析发现:CHC-DOLTAE存在着设计缺陷,等式(6)不会成立.文献[21]中定理1的证明是错误的.因此,密文的接收方Ur不可能通过等式(7)恢复消息子块Mi(i=1,2,…,t).事实上,V=∑t上式中,Li是Lagrange系数.4DOLTAE方案形式化在这一节,给出形式化DOLTAE方案,建立DOLTAE方案的安全模型.4.1DOLTAE方案的组成在DOLTAE方案中,有3个参与方:签名方群UU={U1,U2,…,Un},实际参与签名方群UUaa和指定接收方Ur.一个DOLTAE方案由5个算法{Kc,Ks,Kr,E,D}组成.(1)SetupKc.输入安全参数k,随机算法Kc输出系统参数I.记作:I←Kc(k).(2)SenderKeyGenKs:输入系统参数和门限值(n,t),随机算法Ks输出签名方群UU以及每个签名方公私钥对(pkU,skU),(pksi,sksi).记作((pkU,skU),(pks1,sks1),…,(pksn,sksn))←Ks(I,(n,t)).(3)ReceiverKeyGenKr.输入系统参数,随机算法Kr输出指定接收方Ur的公私钥对(pkr,skr).记作(pkr,skr)←Kr(I).(4)DOLTAEE.输入签名方群UU的公钥pkU,实际参与签名方的私钥sksi和接收方Ur的公钥pkr以及消息M,随机算法DOLTAEE先将消息M分为与实际参与签名方数目相同的消息子块,然后产生相应的子密文,最后输出密文C.记作C←E〈pkU,sksi(5)DOLTAED.输入接收方Ur的私钥skr,签名方群UU的公钥pkU,接收方Ur的公钥pkr和密文C,确定性算法DOLTAED输出(pk,M)或符号⊥,pk是发送方公钥,M是跟密文对应的明文,符号⊥表示密文是无效的.对于解密算法要求:Dskr(E〈skU,pkU,pkr〉(M))=(pkU,M).记作string←Page6Dskr(C),string是⊥或者(pk,M).4.2DOLTAE方案的安全性在这一小节,定义DOLTAE方案的安全性.安全的DOLTAE方案应该同时满足PKAE[7]的安全性和门限方案的安全性.一个DOLTAE方案所能满足的最强意义的安全性质是IND-CCA2安全和UF-CTXT安全.定义7(鲁棒性).对于任意至多能够腐蚀t个签名方的概率多项式时间攻击者,DOLTAE方案(Kc,Ks,Kr,E,D)都能成功地运行.定义8(私密性).设(Kc,Ks,Kr,E,D)是一个DOLTAE方案.令b∈{0,1},k是系统的安全参数.E〈pkU,sksi机预言机(Oracle).输入一个消息,该Oracle返回一个密文.Dskr(·)是一个DOLTAE解密随机预言机,输入密文,Dskr(·)返回(pk,M).设A为任意概率多项式时间敌手.敌手A可以询问DOLTAE加密随机预言机E〈pkU,sksi密随机预言机Dskr(·).考虑下列游戏(game).(1)初始化阶段.运行Setup算法Kc和Sender-KeyGen算法Ks,产生系统参数I、签名方群UU的公私密钥对(pkU,skU)、签名方的公私密钥对(pksi,sksi)(i=1,2,…,n).运行随机算法Kr,产生接收方Ur的公私密钥对(pkr,skr).发送{I,pkU,pkr,pksi(i=1,2,…,n)}给敌手A.(2)攻击阶段1.敌手A适应性地作DOLTAE加密随机预言机和DOLTAE解密随机预言机询问.DOLTAE加密随机预言机询问.A选择一个消息M,然后作DOLTAE加密询问,随机预言机E〈pkU,sksiDOLTAE解密随机预言机询问.A对于DOL-TAE密文C作解密询问,解密随机预言机Dskr(·)做出应答,返回(pk,M)或者密文无效符号⊥.(3)挑战阶段.A随机选择两个长度相同的消息M0和M1.DOLTAE加密算法先掷一个硬币决定Mb,b∈{0,1},然后加密Mb,将DOLTAE密文C返回给敌手A,作为一个挑战(challenge).(4)攻击阶段2.A如攻击阶段1一样适应性地作DOLTAE加密和解密随机预言机询问,但是A不被允许关于挑战(challenge)询问DOLTAE解密随机预言机.(5)猜测阶段.在游戏结束时,A输出一个比特b.若b=b,则A在游戏中获胜.定义敌手A在上述游戏中的优势如下称一个DOLTAE方案(Kc,Ks,Kr,E,D)是IND-CCA安全,如果不存在概率多项式时间(PPT)敌手以不可忽略的优势在上述游戏中获胜.尽管PKAE方案存在形式化的安全概念,但TAE还没有正式的不可伪造性安全概念.对于PKAE方案,敌手A可能来自不同于签名方的任何一方,如第三方或者指定的接收方.因为密文是根据签名方的密钥和接收方的公钥生成的,潜在的敌手分成两类:第三方或者指定的接收方.一个安全的PKAE方案在接收方攻击或第三方攻击模式下能够抵抗适应性选择密文攻击,是不可伪造的[7].TAE方案的安全性跟上面的不尽相同.因为在TAE方案中,敌手来自于第三方、接收方、至多(t-1)个签名方或者至多(t-1)个签名方与接收方的合谋团体.在门限情形下,只要签名方数目少于门限值,恶意接收方可能与一部分签名方合谋来伪造有效的密文.在以上所有敌手中,最后一种敌手是最强大的.在本文中,仅仅讨论DOLTAE方案在最强意义下的安全性,即在接收方和(t-1)个签名方的合谋攻击模式下适应性选择消息攻击的安全性(UF-CTXT).敌手的伪造分为两种类型:密文伪造(CTXT)和明文伪造(PTXT).密文伪造是指敌手产生的密文不同于DOLTAE加密随机预言机所产生的密文,而明文伪造是指敌手伪造的密文所对应的明文不同于敌手询问DOLTAE加密随机预言机时所使用的明文.DOLTAE方案抵抗密文伪造的不可伪造性类比了普通数字签名在较强意义下的安全性.结合合谋攻击下密文不可伪造性,DOLTAE方案有一个最强意义下的安全性概念:UF-CTXT.在DOLTAE方案的这种安全模型中,敌手可以进行选择消息攻击和密钥改变攻击.DOLTAE方案的UF-CTXT安全定义如下.定义9(不可伪造性).设DOLTAE方案为(Kc,Ks,Kr,E,D).k是安全参数.假设敌手F能访问DOLTAE加密随机预言机E〈pkU,sksi考虑以下游戏.(1)初始化阶段.运行Setup算法Kc和Sender-KeyGen算法Ks,产生系统参数I、签名方群UU的公私密钥对(pkU,skU)、签名方的公私密钥对(pksi,sksi)(i=1,2,…,n).然后,将{I,pkU,pkr,pksi(i=1,2,…,n)}发送给敌手F.F选择不多于t个签名Page7方作为腐蚀对象,获取他们的公私钥.甚至允许F运行随机算法Kr,获得接收方的公私钥(pkr,skr).(2)攻击阶段.F适应性地作DOLTAE加密随机预言机询问.DOLTAE加密随机预言机询问.F选择消息M,然后作加密询问,随机预言机E〈pkU,sksi做出应答.DOLTAE密文(C,pkr,skr).(3)密文伪造.在游戏结束时,敌手F产生一个(4)输出:运行算法AuthDecD:①若string是⊥,则F在游戏中失败.返回0.②将string分组成(pk,M).若pk=pkU,密文C不是DOLTAE加密随机预言机的应答,则F在游戏中获胜.返回1.③若pk≠pkU,则F在游戏中失败.返回0.④若C是DOLTAE加密随机预言机的应答,定义敌手F在上述游戏中的优势如下称一个DOLTAE方案(Kc,Ks,Kr,E,D)是UF-CTXT安全,如果不存在PPT敌手以不可忽略的优势在上述游戏中获胜.5新的DOLTAE方案则F在游戏中失败.返回0.在这一节,描述一个新的DOLTAE方案.新的DOLTAE方案涉及3个参与方:签名方群UU={U1,U2,…,Un},实际参与签名方群UUaa和指定接收方Ur.DOLTAE方案由以下5个算法{Kc,Ks,Kr,E,D}组成.SetupKc.输入安全参数k,随机算法Kc输出系统参数I={G1,G2,e,g,p,H1(),H2()}.其中G1与G2是两个素数p阶循环群,g是群G1的一个生成元.e是一个从G1×G1到G2的双线性映射,H1():{0,1}→G2和H2():{0,1}→G1两个安全的杂凑函数.SenderKeyGenKs.随机算法Ks采用Gennaro等设计的基于离散对数假设分布式密钥生成协议DKG[25].签名方群UU中所有成员{U1,U2,…,Un}共同执行此算法.输入系统参数I和门限值t,Ks输出签名方群UU的公钥y.Ui的私钥xi∈Zx2,…,xn}是U的秘钥x依照秘密共享策略所产生的n个份额,x=loggy.任何t个秘钥子集SET通过拉格朗日插值法可以重构x=∑i∈SET是Lagrange系数.对每个秘密份额xi,计算yi=gxi作为Ui的公钥.公钥在签名方群UU中广播.ReceiverKeyGenKr.给定系统参数I,随机算法Kr选择a,b,c∈Zg2=gb,g3=gc.Kr输出指定接收者Ur的公钥{g,g1,g2,g3}.DOLTAEE.不失一般性,假设实际签名方群UUaa是由{Ui|i=1,2,…,t}组成.UUaa中的签名方通过执行以下步骤合作生成消息M的DOLTAE密文.(1)消息分块.明文M被分成t个消息块.不妨设第i个消息块分给Ui.如文献[22]中所示,很容易构造一个将消息映射到G2中点的算法MapTo-Group.为叙述简便,设Mi∈G2(i=1,2,…,t).(2)子密文生成.设ni是消息子块Mi的序列号.每个Ui随机选择ki∈Z密文,在实际签名方群UUaa中广播(Ci1,Ci2,Ci3):Ci1=gki,αi=H1(Ci1),Ci2=Zki(ni‖y‖Mi),Ci3=(gαi1g3)ki(10)接着,ui计算si=H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3)Lixi(3)子密文有效性验证.Ui发送子密文(Ci1,Ci2,Ci3,si)给收集者Uc,Uc可以是实际签名方群中的任意签名方.Uc通过检查下列等式是否成立来验证子密文的有效性:e(g,si)=e(yi,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖)Li)(4)密文合成.如果所有子密文(Ci1,Ci2,Ci3,si)(i=1,2,…,t)都是有效的,Uc把所有的子密文组合成整个消息M的DOLTAE密文.Uc通过公共信道将DOLTAE密文(C11,C12,C13,…,Ct1,Ct2,Ct3,s)发送给指定接收者Ur.DOLTAED:当Ur得到密文(C11,C12,C13,…,Ct1,Ct2,Ct3,s)时,Ur执行以下操作.1.若有e(g,s)≠e(y,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3)),则Ur输出⊥;否则,执行步2;Ci3≠Caαi+c2.Ur计算αi=H1(Ci1).若存在某个i∈{1,2,…,t},有i1,Ur输出⊥;否则,执行步3;3.Ur计算stringi=Ci2/e(Ci1,gab),将其分组为Page8Ai‖Bi‖Mi.若Ai{1,2,…,t},或i≠j,Ai=Aj,或i,Bi≠y,则Ur输出⊥;否则,执行步4;合成整个消息M.4.Ur按照消息子块的序列号Ai将所有消息块Mi组从以上可知,新的DOLTAE方案很容易转换为一个MAE方案或TAE方案.为简便起见,这里省略转化过程.6新的DOLTAE方案分析本节中,将证明新的DOLTAE方案基于CDH假设是鲁棒的,IND-CCA2安全和UF-CTXT安全的.定理1(鲁棒性).即使存在允许腐蚀少于n/2个签名方的PPT攻击者,新的DOLTAE方案也能够成功地执行.因此,接收方Ur能够恢复整个消息M.证明.如文献[14]所示,即使攻击者腐蚀签名方群UU中的少于n/2个签名方,任何t个份额的集合能够唯一确定对应公钥y的私钥x,并且x在p中是均匀分布的.因此,y在G1中也是均匀分布Z的.这意味着新的DOLTAE方案即使有腐蚀能力的攻击者存在,也能成功地执行.其次,因为每个有效的si是对应于公钥yi=gxi的一个短BLS签名[22],只有有效的si才能通过验证方程(12).事实上,有e(g,si)=e(g,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖)Lixi)=e(yi,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖)Li)密文s是通过至少t个有效的形如H2()Lixi的子密文si相乘得到的.依据式子(10),有Ci3=(gα因此,通过式子(13),能够得到e(g,s)=eg,∏i∈UUa(=e∏i∈UUayLii,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖=e(g∑i∈UUa=e(y,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖)).定理2(私密性).新的DOLTAE方案在RO模型下基于DBDH假设是IND-CCA2安全的,而且有式子中ε是攻击者攻破DOLTAE方案所具有的优势,SuccDBDH凑函数H1()的目标碰撞概率,ε2是伪造有效BLS签名成功的概率,t是门限值,qd是解密随机预言机访问的次数,且qdp/2.证明.假设存在一个(t1,ε)的攻击者A.敌手A在时间t1内以概率ε攻破新的DOLTAE方案.那么,能够构造一个算法B在时间t2内以优势SuccDBDHA,G1求解DBDH问题的一个随机实例.G1与G2是两个素数p阶循环群,g是群G1的一个生成元.给算法B输入5元组(g,ga,gb,gk,Q)∈G41×G2.当Q=e(g,g)abk时,算法B输出1;当Q≠e(g,g)abk时,算法B输出0.算法B与敌手A交互进行下列游戏.初始化阶段.算法B运行Kc.输入安全参数k,Kc如第5节方案中一样输出系统参数I={G1,G2,e,p,H1(),H2()}.算法B运行算法Ks.把系统参数I和门限值t作为Ks的输入.算法B随机选择一个私钥xi∈Zx2,…,xn}是秘密值x∈Z任意t个或更多私钥的子集SET能通过拉格朗日插值方法重构x.设U的私/公钥对为(x,y),x=loggy.每个Ui有它的私/公钥对(xi,yi),yi=gxi(i=1,2,…,n).算法B模拟随机算法Kr.敌手A能够获得参数{I,y,yr,yi}(i=1,2,…,n).令g1=ga,g2=gb.算法B随机选择两个数p,β∈Zk∈Z计算g3=g-αyr={g,g1,g2,g3}.攻击阶段1.敌手A适应性地作DOLTAE加解密预言机询问.算法B像DOLTAE加密和解密在方案实际运行中的一样模拟A的视图.DOLTAE加密模拟.当敌手A需要对一个消息M做DOLTAE加密时,A甚至能按照门限策略指定一个特定的实际签名方群UUaa.不妨设UUaa的基数是t.算法B先把明文M分成t个消息块.对于所有i∈Ind(UUaa),算法B随机选择ki∈Z序列号ni和公钥y与Mi串联起来.算法B对于所有i∈Ind(UUaa),如下计算消息块Mi的子密文:Ci1=gki,αi=H1(Ci1),Ci2=Zki(ni‖y‖Mi),Ci3=(gαi1g3)ki(16)Page9si=H2(y‖Ci11‖Ci12‖Ci13‖…‖Cit1‖Cit2‖Cit3)Lixi最后,算法B把所有的子密文组合成消息M的DOLTAE密文:算法B返回DOLTAE密文(Ci11,Ci12,Ci13,…,Cit1,Cit2,Cit3,s)作为A对DOLTAE加密询问的应答.DOLTAE解密模拟:当敌手A关于DOLTAE密文C=(Ci11,Ci12,Ci13,…,Cit1,Cit2,Cit3,s)作解密随机预言机询问时,算法B作模拟应答.H1(C1.检查是否存在指标i使得Ci1=Ci1).如果存在,B放弃.2.验证以下式子是否成立:e(g,s)=e(y,H2(y‖Ci11‖Ci12‖Ci13‖…‖Cit1‖Cit2‖Cit3))如果不成立,B返回⊥;否则,执行步3.3.计算αi=H1(Ci1),gki11=(Cβi1C-1i3)1/(α-α),stringi=Ci2/e(gki11,g2)然后,B把stringi分组为Ai‖Bi‖Mi.若AiInd(UUaa),或者i≠j,Ai=Aj,或i,Bi≠y,B返回⊥;否则,执行步4.拼接成整个消息M.4.根据消息子块的序列号Ai,B把所有消息子块Mi挑战阶段.敌手A选择两个长度相同的消息M0和M1,把它们发送给算法B.算法B掷一个硬币决定Mb,b∈{0,1}.算法B如下计算Mb的DOL-TAE密文C作为挑战challenge.1.把明文M分成t个消息块,选择某个i∈Ind(UUaa)和随机数k∈Zp,计算Ci1=gk,Ci2=Q(ni‖y‖Mi),Ci3=(Ci1)β.2.对于所有j∈Ind(UUaa)\{i},B做出与DOLTAE加密模拟类似的应答.3.返回一个挑战密文攻击阶段2.敌手A以类似于攻击阶段1的方式适应性地发出加解密询问.但不允许敌手A关于挑战challengeCh询问解密随机预言机Dskr(·).猜测阶段.在游戏结束时,A输出一个比特b.若b=b,则A赢得游戏.下面通过归约方法来分析算法B成功的概率.A发出各种随机预言机询问,算法B模拟A的视图.A在模拟过程中的视图与A在实际协议运行中的视图几乎完全不可区分,除非以下事件发生.事件T1.当算法B对DOLTAE密文的解密询问做出应答时,若Ci1=C个解密询问,T1发生的概率是Pr(T1)t事件T2.当算法B对DOLTAE密文的解密询问做出应答时,若H1(Ci1)=H1(C若杂凑函数H1()的目标碰撞概率是ε1,则对qd个解密询问,这个拒绝事件T2发生的概率是事件T3.当敌手A选择消息,计算(Ci11,Ci12,Ci13,…,Cit1,Cit2,Cit3,s),然后询问DOLTAE解密随机预言机时,B无法对此解密询问作出正确的应答.当且仅当以下式子成立时,事件T3才发生:e(g,s)=e(y,H2(y‖Ci11‖Ci12‖Ci13‖…‖Cit1‖Cit2‖Cit3)).换言之,敌手A成功地了伪造一个BLS签名[22].因此,可以得到事件T4.除非攻击者A能区分e(g,g)abk和G2中的一个随机元素,A才能判断挑战密文的有效性.攻击者A没有关于b的信息.因此,可以得出从以上式子(21)~(24),可以得到运行时间t1和t2是两个关于安全参数的概率多项式时间,具有相同的数量级.因此,新的DOLTAE方案在DBDH假设下基于RO模型是IND-CCA2安全的.定理3(不可伪造性).新的DOLTAE方案基于CDH假设在RO模型下是UF-CTXT安全的,并且有式子中ε1是攻击者伪造DOLTAE密文的成功概率,SuccCDH随机预言机访问的次数,qe是加密随机预言机访问的次数.证明.设DOLTAE方案为(Kc,Ks,Kr,E,D),k是系统安全参数.假设存在(t1,ε1)攻击者F,F能够在时间t1内以概率ε1成功地对给定消息伪造有效的DOLTAE密文.下面把新的DOLTAE方案的安全性归约到CDH假设.为此需要应用F来构Page10造一个算法A,该算法在时间t2内以优势SuccCDH攻破G1中的CDH假设.给定G1中的CDH问题实例:{g,ga,gb},算法A的目标是计算gab.攻击者F能够访问签名随机预言机和随机杂凑预言机.F预先选择多达t-1个欲腐蚀的签名方.不失一般性,假设{犝1,犝2,…,犝t-1}是被F选定的欲腐蚀签名方群.在UF-CTXT模型下,F还能腐蚀接收者Ur.算法A通过攻击者F交互执行下列实验.初始化阶段.算法A运行算法Kc.输入安全参数k,Kc输出系统参数I={G1,G2,e,p,H1(),H2()}.F甚至能够运行算法Kr来获得公/私密钥对(pkr,skr).A模拟算法Ks和算法Kr.1.将签名方群UU的公钥y为挑战ga.算法A在Zp中随机选择t-1个元素{x1,x2,…,xt-1}.对于{犝1,犝2,…,犝t-1}中每个签名方犝i,选定xi为它的私钥,则犝i的公钥是yi=gxi.对于其他签名方,即jInd{犝1,犝2,…,犝t-1},A计算yj=y∏t-1通过指标集Ind{犝1,犝2,…,犝t-1}∪{j}计算的.2.在Zp中随机选择3个元素{a,b,c}.计算g1=ga,g2=gb,g3=gc,将他们作为指定接收方Ur的公钥.3.发送下列信息给F:{I,y,(yi,xi),yj|i∈Ind{犝1,犝2,…,犝t-1}}.攻击阶段.F适应性地发出随机杂凑预言机询问和DOLTAE加密随机预言机询问.A模拟随机杂凑预言机和DOLTAE加密随机预言机的应答.(1)模拟随机杂凑预言机.算法A创建两个杂凑值表HL1和HL2.表HL1和HL2分别用来存放H1()和H2()的值.当F关于Ci1发出H1()询问时,p中随机选择一个元素αi,并把(Ci1,αi)存放A在Z到HL1中.当F关于y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3发出H2()询问时,A在Zd,计算(gb)d,把下列元组存放到HL2中(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3,d,(gb)d).(2)模拟DOLTAE加密随机预言机.F选择消息M,关于M发出DOLTAE加密随机预言机询问.实际签名方群甚至都可由F选定.假设实际签名方群UUaa是由{犝1,犝2,…,犝t-1}和唯一诚实的签名方Uj组成.对于这种选择,敌手F在作出DOLTAE加密询问时将有更多的优势.对任意消息M(M不一定是新鲜的),算法A如在新的DOLTAE方案中一样执行消息分块操作.对于i∈j.因为以下式子成立,sj一定是有效的.Ind(UUaa),若Ci1以(Ci1,αi)的形式出现在HL1中,则令αi=H1(Ci1);否则,A如在随机杂凑预言机模拟中一样进行模拟运算.接着,A计算(Ci2,Ci3).若列表HL2中已经存在(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3),则A终止模拟;否则,算法A随机选择一个元素d∈ZC13‖…‖Ct1‖Ct2‖Ct3,d,gd)到表HL2中.对于每个被腐蚀的签名方,算法A能通过式子(17)生成他们的BLS签名si.对于诚实签名方Uj,A计算sj=yLjde(g,sj)=e(yj,gLjd)=e(yj,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3‖)Lj).算法A计算s=∏i∈Ind(UUaa)si.容易验证,下列式子成立:e(g,s)=e(y,H2(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3)).算法A能够完善地作出DOLTAE加密随机预言机的模拟.密文伪造.在实验结束时,攻击者F伪造认证密文(C11,C12,C13,…,Ct1,Ct2,Ct3,s).这个伪造的密文不是DOLTAE加密随机预言机的输出.输出.算法A依照定义9中的方法验证伪造DOLTAE密文的有效性.搜索表HL2,寻找到(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3,d,(gb)d).这样,算法A能够计算出gab=s1/d.下面用归约方法分析F的成功概率.F在A模拟过程中的视图与在实际方案执行过程中的视图几乎完全不可区分.除非在DOLTAE加密模拟时,(y‖C11‖C12‖C13‖…‖Ct1‖Ct2‖Ct3)出现在表HL2中,A模拟失败.这个事件发生的概率至多为qh·qe从以上讨论,可以得到ε1SuccCDHt2t1+(n+4+1.5qh+2.5qe)Te+(n-t-1)Tm,上式中Te与Tm分别指一次指数运算和乘法运算的时间.在DOLTAE加密模拟过程中,没有要求消息M必须是新鲜的.敌手伪造的密文所对应的消息可能是询问过DOLTAE加密随机预言机的消息,仅仅要求敌手伪造的密文不是DOLTAE加密随机预言机的应答.因此,所提出的DOLTAE方案是UF-CTXT安全的.Page117总结本文对CHC-DOLTAE方案[21]进行了分析,发现CHC-DOLTAE方案存在设计缺陷,以致于接收方无法恢复消息.本文形式化了DOLTAE方案,构造了DOLTAE方案的形式化安全模型.基于双线性映射,设计了一个新的DOLTAE方案.在CDH与DBDH假设和随机预言机RO模型下,新的方案被证明对于适应性选择密文攻击是语义安全的,对于适应性选择消息攻击是存在性不可伪造的.
