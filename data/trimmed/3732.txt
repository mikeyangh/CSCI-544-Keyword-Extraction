Page1构造从字符串到犆34曲线的散列函数于伟1),2)王鲲鹏2)李宝2)田松2)1)(中国科学技术大学电子工程与信息科学系合肥230027)2)(中国科学院信息工程研究所北京100093)摘要该文利用求立方根的方法构造了一个从有限域q映射到C34曲线上的确定函数,其时间复杂性是(log3q).利用这个确定的函数构造了从字符串到C34曲线上的散列函数.在相同的素域上,与2009年IcartT构造的到椭圆曲线上的散列函数相比,开立方的方法在计算速度上提高超过30%.并且作者利用该确定函数构造了与随机谕言不可区分的函数.关键词散列;随机谕言;椭圆曲线;C34曲线1引言公钥密码体制成功地解决了对称密码面临的3个难题:密钥分发、密钥管理和提供不可否认性.公钥密码一般基于所依赖的数学难题来分类.目前被认为安全有效的主要有3类:(1)基于大整数分解问题的RSA公钥密码体制.(2)基于有限域上离散对数问题的Elgamal型Page2线上是不安全的.在实际应用中,取亏格小于5的代数曲线.Cab曲线的亏格是(a-1)(b-1)考虑亏格为3的C34曲线.文献[2]中给出了C34曲线上如何进行快速有效计算的方法.Boneh-Frankin构造的基于身份的加密算法[3]中,公钥需要映射到代数曲线上的点.他们构造了一个从基域q到超奇异椭圆曲线上点的一一映射f,可以证明当h是一个传统散列函数时,f(h(m))也相当于一个传统散列函数.其它的一些系统,如基于身份的加密算法[4-6]、基于身份的签名算法[7-11]以及基于身份的签密算法[12-13]都需要散列进代数曲线.基于身份的加密[3]一文中指出:映射f:SR具有如下3条性质时,fh是散列函数.(1)可计算性:f在确定的多项式时间内是可计算的.(2)映射的原象数目可计数:对于任意的r∈R,|f-1(r)|l.(3)对于任意的象,都存在多项式时间的算法,以一定的概率返回其中的一个原象.a=2,b=3时,C23曲线即为椭圆曲线.散列进椭圆曲线的方法有Boneh,Lynn,Shacham[14]短签名方案中的非确定性时间的算法、Shallue和Woestijne[15]基于开平方根的算法和IcartT[16]的算法.散列进超椭圆曲线的方法有文献[17-18]中的方法.散列进C34曲线像散列进椭圆曲线一样,构造一个从基域q到C34曲线上的映射f,当h是一个传统散列函数时,需要证明f(h(m))也满足传统散列函数的条件.至今还没有散列进C34曲线的研究.本文给出了构造从字符串到C34曲线上的一一映射f的方法,当h是传统散列函数时,fh是散列函数.并且利用该函数构造了到C34曲线Jacobian群上与随机谕言不可区分的函数.本文所讨论的问题都是在域q上,其中q=pn,p是素数并且p>3,n为任意的正整数.本文第2节给出C34曲线的基础知识;第3节论述如何构造从有限域到C34曲线上的映射;第4节证明函数fh是一个散列函数;第5节给出在NIST素域和SM2素域上的计算实例和算法的时间和空间复杂性分析;第6节给出构造字符串到C34曲线Jacobian群上的与随机谕言不可区分的函数;第7节给出文章的结论.2背景知识2.1C34曲线Cab曲线最先由MiuraS[19-21]提出.令K是一个完全域,珡K为K的代数闭包,是定义在珡K2上的不可约的仿射代数集.x,y是仿射平面珡K2的两个坐标.a,b是互素的两个整数,则下面的两个条件是等价的(证明见文献[22]定理1):(1)是绝对不可约的代数曲线,恰好有一个K无穷远有理点Q.aQ是x的唯一极点,bQ是y的的唯一极点.(2)是由如下所示定义的双变量的多项式:αb,0xb+α0,aya+∑ia+jb<ab式(1)所定义的代数曲线叫做Cab曲线(文献[22]的定义2).在Cab曲线中,令a=3,b=4,得到C34的方程为α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0+α0,3y3+α0,2y2+α0,1y+α2,1x2y+α1,2xy2+α1,1xy=0实际应用中,常使用形式简单的C34曲线:α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0=α0,3y3.这里以一条C34曲线:y3=x4+2x2-3x-1为例,在实数域上的图形如图1所示.C34有唯一的无穷远点.其亏格是3,是除椭圆曲线和超奇异椭圆曲线外亏格最小的Cab曲线.2.2犆34曲线上的Jacobian群令C表示一条C34曲线,K(C)是C的函数域.Page3除子类群Div(C)定义为由C上的点P生成的自由阿贝尔群.除子D∈Div(C)定义为并且只有有限个nP不为0.除子D的次数定义为零次除子的集合对于f∈珡K(C),定义除子其中ordP(f)表示f在P∈C的阶.如果存在f∈珡K(C)使得D=(f),则称D为主除子.C上的主除子类群是D0C(K)的子群,记做PC(K).Jacobian群定义如下C34曲线上的Jacobian群的具体运算见文献[24].关于C34曲线,更多的介绍,请参考文献[24-26].2.3构造散列函数短签名中的构造散列函数算法[14]的运行时间不是常数,还可能导致时间攻击(具体分析见文献[16]).当q是模4余3的情况下,平均时间复杂性是(log3q);其余情况下的平均时间复杂性是(log4q).后来,密码学研究者寻找到了运行时间可以确定的散列函数.Shallue和Woestijne[15]的利用Skalba的等式[27]的散列算法是基于开平方根的,在域q(q模4余3)中,时间复杂性是(log3q);其它情况下的时间复杂性是(log4q).在q≡2mod3情况下,Icart的确定散列算法[16]的时间复杂性是(log3q).Ulas[18]给出了到形如y2=xn+ax+b和y2=xn+ax2+bx超椭圆曲线上的散列算法.其算法的本质是寻找二次剩余.对于Cab曲线,因为x,y次数的提高,构造散列的情况要复杂得多.本文主要考察Cab曲线中应用和研究较多的C34曲线.3构造从有限域到犆34曲线的函数当q=pn≡2mod3时,映射xx3是一个双射,并且有逆映射xx1/3=x(2q-1)/3.由此可以构造从有限域到C34曲线的一一映射.对于域q中的任意元素u,构造从q到C34曲线的映射f:f:uu,α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,0这是一个关于u的1次方程u=x,即象集的点一定存在唯一的原象.引理1.q表示一个域,q=pn≡2mod3,p>3.对于任意的u∈pn,f(u)是α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0=α0,3y3中的点.证明.x=u,y=α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,0代入u=x,可以得到x,y之间的关系y=α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0得到y3=α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0所以,α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0=α0,3y3.这样就证明了引理1.根据f的定义,可以发现不同的原象映射到不同的象,原象的q个元素恰好映射到象集中的q个不同的点(x坐标互不相同).这说明q中的元素映射到C34曲线中的q个不同的点.4构造从字符串到犆34曲线上点的散列函数设映射h:{0,1}是消息(表示成0,1字符串).我们构造了一个一一映射f,将域q中的元素映射到C34曲线上的点.下面证明fh是一个散列函数,即fh具有单向性和抗碰撞性.首先,定义散列函数的单向性和抗碰撞性.4.1单向性定义1.一个散列函数被称作是(t,ε)单向:任给一个y∈Im(h),其中Im(h)是象集,对于任意算法运行时间t,输出m,满足h(m)=y的概率最多是ε.可以证明这是一个从域中元素映射到椭圆曲线的散列.引理2.如果h是一个(t,ε)的单向函数,f如式(3)所定义,则H=fh是一个(t,ε)的单向函数.证明.令u=h(m),则H(m)=u,α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,0Page4f的逆映射f-1:C34上的点→q,即是P=(x,y)x,则H-1(P)=h-1(x).因为h是一个(t,ε)的单向函数,所以H=fh是一个(t,ε)的单向函数.证毕.4.2抗碰撞性定义2.一个散列函数簇被称作是(t,ε)抗碰撞的:对于任意算法运行时间为t,任给一个h∈,输出(m,m)满足m≠m,h(m)=h(m)的概率最多是ε.对于给定的散列函数簇,任意的h∈,定义函数H=fh,f为q到C34曲线上点的函数.H中发生碰撞当且仅当:(1)存在m和m,使得h(m)=h(m),这是h的一个碰撞.(2)或者对于u=h(m),u=h(m),u≠u满足f(u)=f(u),这是f造成的一个碰撞.引理3.f如式(3)所定义,如果h是(t,ε)抗碰撞的,那么H是(t,ε)抗碰撞的.证明.设(m,m)是H的碰撞,由于f是一一映射,所以H发生碰撞只能是h也发生了碰撞.同理,h的碰撞也是H的一个碰撞.如果h是(t,ε)抗碰撞的,那么H是(t,ε)抗碰撞的.证毕.5实验结果与分析本节以C34曲线y3=x4+2x2-3x-1(如图1)定义在NIST和SM2推荐使用的素域p上为例,给出具体的计算方法和计算时间.5.1NIST素域和SM2素域上的犆34曲线的散列美国国家标准与技术协会NIST推荐的192bit素域P192和384bit素域P384.中国国家密码管理局给出了椭圆曲线密码标准SM2,推荐了二进制长度为256位的素域S256.通过计算得知P192≡2mod3,P384≡2mod3,S256≡2mod3.用u表示p中的元素,映射f的构造如下.在3个素域上,u=1的运行结果如表2,u=2的运行结果如表3,随机选取u之后的平均运行时间如表4.f:uu,α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,0计算x1/3的方法如下:x1/3=x(2q-1)/3.素域名称P192P384S256素域名称P192FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFP384S256FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF素域名称P19213CCC34C326FC4E767F52212D966D8CCE4D17P384S2564196DFF089DB32EC4AED31786B72D56B806C38素域名称使用大数运算库LibTom[28]编程实现IcartT的散列函数,平台是IntelCore22.66GHz四核处理器.IcartT的散列函数的平均运行时间如表4所示.在相同的素域上,与IcartT散列函数的运行时间相比,我们的算法平均提高30%以上.5.2时间复杂性域q的乘法时间用M表示,域中的元素乘以一个常数用MA表示,平方用S表示,求逆用I表示,开立方根用E表示.散列进C34曲线的算法中,主要是计算映射f:uu,α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,0计算f的时间为I+5MA+M+2S+E.在域q中,当q=pn≡2mod3时,x1/3=x(2q-1)/3.也就是说开立方就是计算一个数的(2q-1)/3次方,时间复杂性为(log3q).实际上,取则原C34曲线的方程化为y3=α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0,映射f变为f:uu,α4,0u4+α3,0u3+α2,0u2+α1,0u+α0,Page5时间复杂性为4MA+M+2S+E.IcartT[16]的时间复杂性为I+2M+3S+E.在素域上,一般取I+2M+3S+ES=0.8M,利用重复平方法计算E:x1/3=x(2q-1)/3,需要S+M()2logp.选取比较小的参数αi,0,0i4,则MA相对于M可以忽略.开立方的方法的时间复杂性是(2.6+1.3logp)M.IcartT的散列函数[16]的时间复杂性为(104.4+1.3logp)M.如果p的位数为192位,则节省101.8/(104.4+1.3×192)×100%≈30%.6构造随机谕言在文献[29]中指出了如何利用IcartT的确定函数构造与随机谕言模型不可区分的函数.文献[30]中指出了如何构造到亏格大于1的曲线上与随机谕言不可区分的函数.利用文献[30]中给出的方法构造出到C34曲线Jacobian群上的与随机谕言不可区分的函数.构造如下:其中,Hj(1ji)是传统的散列函数.根据文献[30]中给出的结论,只要i大于C34曲线的亏格,该构造就是与随机谕言不可区分的函数.即时,我们取i=4,得到构造为H(m)=f(h1(m))+f(h2(m))+f(h3(m))+f(h4(m)).7结论当q=pn≡2mod3时,映射xx3是q到自身的一个双射.利用逆映射xx1/3=x(2q-1)/3,本文给出了从域q到定义在q上C34曲线α4,0x4+α3,0x3+α2,0x2+α1,0x+α0,0=α0,3y3的散列函数f.与IcartT构造的到椭圆曲线上的散列函数相比,我们构造的散列函数在时间复杂性上有较大的优势.在相同的素域上,计算速度至少提高30%.由于f是一个双射,由传统散列函数h:{0,1}从字符串{0,1}到C34曲线的散列函数fh和与随机谕言不可区分的函数.
