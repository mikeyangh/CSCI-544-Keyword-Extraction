Page1面向邮件网络事件检测的用户行为模式挖掘李全刚1)时金桥2),3)秦志光1)柳厅文2),3)1)(电子科技大学计算机科学与工程学院成都610054)2)(中国科学院信息工程研究所北京100093)3)(信息内容安全技术国家工程实验室北京100093)摘要挖掘邮件网络通信中的用户行为模式并分析其演变过程对于检测数据泄漏、内部威胁等工作都有着重要指导意义.已有的邮件网络用户行为模式挖掘方法可大致分为两大类:基于邮件内容和基于网络结构.基于邮件内容的挖掘方法存在侵犯用户隐私或者因加密导致无法获得邮件内容等诸多局限性;基于网络结构的挖掘方法常把邮件网络视为是一个完整的网络,而忽略了组织外部邮箱间通信信息存在的缺失,使得提取某些特征时出现偏差,从而会影响到结论的准确性.文中将邮件网络分为两部分:域内通信网络和有连接缺失的域外通信网络,分析了域内通信和域外通信信息完整性的差异,分别提取了其各自的结构特征和职能特征.通过引入模元的概念,将常见的二元对应关系(特征-模式)转化为三元对应关系(特征-模元-模式),并从模元的角度来对用户模式进行统一描述.文中的工作有助于对用户行为模式的理解与对比,同时又具有降维的作用.在Enron邮件数据集上的实验结果表明文中方法将用户行为模式更加简洁地表示出来,并且能够通过分析用户行为模式的变化来直观地定位事件的发生.关键词行为模式挖掘;事件检测;非负矩阵分解;邮件网络;日志分析;数据挖掘;信息安全;网络安全1引言电子邮件是互联网上的流行应用,是信息社会最重要的通讯手段之一.电子邮件通讯具有方便、快捷、廉价的特点,成为人们不可或缺的沟通工具,已经深深地融入人们的日常工作、生活和学习当中.邮件通信日志记录了人们的通信关系、通信频率、通信时间等许多有价值的信息.基于邮件日志可以学习用户在邮件通信中的行为模式,继而挖掘出用户的社交关系网、生活习惯、工作性质等社会属性.获取用户社会属性可以帮助服务提供商对用户进行个性化资源推送,也可为组织机构的信息安全防护工作提供重要依据.例如,通过对不同个体的通信行为模式进行横向对比可以发现那些“特立独行”的人;对个体行为模式的纵向分析可以发现个体行为的异常变动.基于这些异常可以帮助相关人员缩小排查范围,快速发现并定位内部人员的不轨行为,这对于检测组织内部威胁和计算机取证等工作都有重要的指导意义.邮件通信网络属于复杂网络范畴,它与朋友关系网、网页链接关系网一样都属于动态网络.但朋友关系网、网页连接网的变化是渐进的,即网络在衍化的同时始终有一个相对稳定的主体,随着时间发展只有部分的节点和边发生变化,改变仅是局部的更新;而邮件通信网络是一个典型的流式网络:没有一个相对固定的主体结构,一切都随时间的变化在不断发展,变化不是局部更新而是重构.渐变式网络可以通过记录某时刻的瞬时影像———快照(Snapshot)来刻画,而流式网络则需要通过叠加某段时间内的记录来生成一个累积影像,最终结果依赖于切分时间段的跨度.邮件通信网络的流式特性给用户行为模式挖掘带来了极大挑战,主要体现在:(1)网络采样时间间隔对挖掘结果影响极大;(2)网络的频繁重构导致行为模式复杂多变,没有较稳定的主体行为模式,致使模式描述困难.已有的邮件网络用户行为模式挖掘方法可大致分为两大类:基于邮件内容的文本主题挖掘方法和基于网络结构的社交网络分析方法.前者存在侵犯用户隐私的问题,并且无法应用在邮件内容被加密的情况;后者往往忽略邮件网络的域内通信和域外通信在信息完整性上的差异,常把邮件网络视为一个完整的社交网络,这导致最终结果不准确.此外,已有工作大多将用户的行为模式直接用特征表示,当特征较多时这种简单的二元对应关系(特征-行为模式)往往导致模式描述不够统一,不利于用户间的模式对比.本文以Enron公司内部人员的邮件通信网络日志为研究对象,结合邮件网络域外通信的信息缺失特点,提出了一种用户行为模式挖掘方法,分别对域内网络和域外网络有区别地提取相关特征,充分挖掘邮件网络的结构特征与职能特征(如转发量、附件量等).邮件网络中用户的通信行为模式是用户在长期的工作生活中通信行为特征的累积体现,用户的通信行为模式由其日常工作性质决定,同时也受到个体的性格、习惯等因素的影响.为了简便统一地描述用户行为模式及其变化情况,提出了基本行为模式单元(简称模元)的概念.模元是描述用户行为模式的一组“基”,它是全网用户某一研究尺度上通信行为模式的基本组成单元,是工作中某类职能属性的特征表现.模元的个数决定了行为模式分析的研究尺度.在某组织机构中员工总是可以按照职能的不同来分类,具有不同工作职能的用户其通信行为模式会表现为不同的模元线性组合,通过对模元权重的变化分析可以了解用户行为模式演变,继而可以结合模元的含义推断出现实中事件的发生.本文的贡献主要体现在:Page3(1)面向邮件通信网络行为模式复杂多变、难以描述的挑战,本文提出基本行为模式单元的概念.模元体现为一些邮件通信特征的组合,代表了从整个邮件通信网络中抽象出的基本通信行为模式.用户的行为模式是由模元构成的,基于模元可以对用户行为模式进行建模分析.首先,利用网络中全体用户的通信特征抽象出若干(通常远小于特征个数)模元,然后将用户行为特征映射到模元空间,这样用户在某个快照内的行为模式就可以表示为一个模元空间中的向量,为用户的行为模式提供了统一的描述准则,降低了模式表述的复杂性.集合多个连续快照的用户行为模式向量则可构成一个以模元为“基”的多元时间序列.(2)针对组织机构邮件网络的域外通信呈现的不完整性特点,提出对入选特征进行区别对待,经过初步筛选,增强结果的可靠性.在关注网络结构特征的同时,也关注用户在通信过程中与工作性质有关的职能特征,如转发量、附件量等.(3)在真实邮件数据集上进行了实验验证,实验结果表明该模型能够真实地获取用户的行为模式,从模式的变化中能够反映出用户真实的状态改变,并具有良好的可解释性和多尺度的特点.2相关工作邮件通信行为模式是指人们在邮件通信过程中所体现出的个体或群体间重复出现的通信特征集合.组织机构的邮件日志中隐含了许多与内部员工的工作性质、日常行为习惯、生活作息时间等有关的信息.如何挖掘这类信息并有效地利用这些信息是人们十分关注的问题.2.1基于邮件内容的挖掘方法邮件通信作为信息交流的一种工具,其邮件的文本内容是最重要的信息载体,于是发展出许多基于邮件内容的邮件网络挖掘方法.如Berry与Browne在文献[1]中基于邮件内容利用非负矩阵分解的方法来提取邮件的主题信息并通过分析主题的变化来对邮件通信进行监控.McCallum等人在文献[2]中结合邮件收发关系及文本挖掘中的主题概率模型提出了Author-Recipient-Topic模型,可以基于信息的传递关系提取用户的多重角色信息.Carvalho与Cohen在文献[3]中通过计算之前邮件文本与当前邮件文本的TF-IDF向量的相似度来衡量当前邮件的可信度,利用预设的可信度阈值来预测可疑的邮件,从而防止信息泄漏的发生.但在真实情况中,通常由于邮件加密或者隐私问题而无法获得全部的邮件内容,基于邮件内容的挖掘方法在该情形下无法使用.本文仅从邮件网络的日志信息来考虑如何挖掘用户的通信行为模式,可作为基于内容的挖掘方法的补充.2.2基于网络结构的挖掘方法一些学者从社交网络角度对邮件网络开展了广泛的研究,如社团划分[4]、重要节点的发现[5]、社会关系与地位的推断[6-8]等.但是大部分社交网络层面的研究工作重点在于构建社交网络层面的普适性算法,考虑的因素较少,挖掘的结果比较宏观.Sun等人在文献[9]中提出GraphScope模型,利用最小描述长度准则来处理动态网络中的事件检测以及节点的社团划分问题.该方法以网络快照作为研究对象,可以检测出快照间的变化时刻,但是不能提取用户个体的通信行为变化,同时GraphScope只用到了网络中出度入度等基本链接特征,忽略了邮件网络中其他大量有价值的信息.Akoglu等人在文献[10]中提出OddBall模型,基于网络的幂率性质来定位网络中的异常节点.该模型只能够发现那些结构偏离明显的节点,同时该模型只考虑单个网络快照,而邮件网络是动态网,故OddBall方法不能发现节点自身的异常变化行为.Henderson等人在文献[11]中提出了结构角色(StructuralRole)的概念,用于对复杂网络的节点进行划分及节点行为的分析预测.结构角色是指某类结构特征的组合,如星形结构的中心、完全图的成员等就是两种不同的角色,它们有着各自独特的节点度分布、聚集系数等特征表现.随后,Rossi等人[12]通过考察节点结构角色的变化构建了一种分析网络及节点结构变化模式的方法.文献[11-12]共同组建了一种特征-结构角色-结构变化的三层模型框架,可以有效地分析动态网络的结构变化.但是该模型仅考察了网络的拓扑结构层面的特征,对于邮件通信行为模式分析而言,需要更深一步的探索.另外,我们注意到邮件网络除去社交网络中共有的结构特征之外,还有许多特有的属性,如时间、抄送关系、附件大小等,这些特征在邮件通信模式的分析中同样具有重要的价值.例如Kalyan与Chandrasekaran在文献[13]中就利用这些特有属性来检测信息泄漏问题,并达到92%的准确性.由此可见,邮件通信中的特有属性是不可忽略的重要特征.Page4本文综合以上分析,考虑仅利用组织机构邮件网络的日志信息,避免了因分析邮件内容而导致的隐私问题,细致分析了邮件网络外部通信信息缺失的拓扑特征,通过引入邮件网络的转发、附件信息等特有属性,将结构角色[11-12]的思想延伸为基本行为模式单元,引入了特征-模元-模式的行为模式学习模型,该模型既能方便地表示某时刻用户的通信行为模式又能有效地分析用户通信模式的时序变化.3邮件通信行为模式挖掘在工作中,人们使用邮件来进行通知的传达、文件的传送、工作的安排与交流等活动.我们认为用户的邮件通信行为模式是与其工作性质紧密相关的,用户在不同的生活环境中所养成的性格、生活习惯等也会对其通信行为模式产生影响.例如,行政人员的通信模式会表现为邮箱活跃,经常性地群发通知及文件附件;职务相同的人员,热情随和的会对大多来信都给予回复,稳重干练的可能只回复一些要紧的邮件.在介绍行为模式的挖掘方法以前,我们首先详细介绍邮件网络的结构特点,以及用户行为模式挖掘的有关概念.3.1邮件网络拓扑与特征选择原则某组织机构的邮件网络通常可分为两部分:组织内部间的通信———域内通信网络;组织内部与外部间的通信———域外通信网络,如图1所示.域内通信网络可以通过邮件服务器的日志信息完整获取,但对于域外通信来说,其外部邮箱之间的联系是不可知的(图1中虚线所示).因此一个组织机构的邮件网络可视为由一个完整的域内通信网络和一个有信息缺失的域外通信网络组成.本文目的是针对组织机构的内部员工进行通信行为模式的挖掘,检测其异常通信行为的发生,故仅以域内通信网络的节点作为行为模式挖掘的对象(图1中圈内节点),并假设邮件网络中每个用户只对应一个邮箱,忽略一个用户拥有多个邮箱的情形.挖掘用户的通信行为模式,既要考虑用户通信数据的完整性,也应该意识到域外通信网络存在着信息的缺失.用户的域外通信量在其总通信量中占有可观的比例,不能轻易忽略.例如某公司负责人才招聘的职员,他的通信可能更多的是面向公司外部的,如果忽略外部通信就会丢失该用户的主要通信行为;然而由于域外通信网络的信息缺失性,一些复杂网络研究中常用的特征就会失准,例如节点的聚集系数[14],因为外部节点间链接的缺失,所以内部节点的聚集系数会趋于变小.因此对于像聚集系数这类特征在计算的时候就应当只考虑域内通信网络部分.如果把邮箱视作节点,把邮箱间的通信视作边,通过整合一段时间内的通信记录,可以把该时间段的邮件网络抽象地表示为一个有权有向图,其中边的权重代表通信的次数,边的方向代表邮件的发送方向.如果不考虑边的权重,则是一个无权有向图,可代表联系人关系网.邮件网络抽象成图的结构后就可以采用复杂网络研究中的各种特征,如出度、入度、局部聚集系数等与拓扑结构有关的特征.由于本文要研究的是用户个体的通信模式,因此主要以用户的egonet(即节点和该点的一跳邻居点以及这些邻居点彼此间的连边)为基础进行特征采集.除去以上跟网络拓扑结构有关的特征之外,邮件网络还有可以体现用户工作性质的特征,我们称之为职能特征,如邮件的转发、抄送,附件的数量、大小、格式,邮箱使用频率等.初期特征选择可以从拓扑和逻辑两个层面来对邮件网络的特征进行划分,分别是拓扑层面的域内通信网和域外通信网,逻辑层面的结构特征和职能特征.两者的层次关系是可以嵌套的,见表1.结构特征职能特征3.2问题描述与求解我们认为用户的行为模式是由他们日常工作职能所决定的,同时受到人的性格、习惯等个体因素的影响.例如,工作职能决定了其联系人的数量、邮件使用频率、抄送、转发等特征,而个体因素会影响到使用时间、回复概率等.在组织机构中员工是可以按照职能的不同来分类的,于是我们假设在整个网络中内部人员的邮件通信行为模式也会有一些基本的Page5分类,而个体的行为模式又会因个体的差异而有所分化.因此我们借鉴文献[11-12]中的结构角色的概念并将其含义做延伸,即不仅考察网络的拓扑结构特征,还加入了邮件网络的职能特征信息,然后在邮件网络特征和用户行为模式之间引入一个抽象的概念———基本行为模式单元(简称模元).3.2.1基本行为模式单元的定义定义1.基本行为模式单元是指网络中全体用户在某尺度上所体现出的通信行为模式的基本组成单元.模元是特征之上的一层抽象概念,代表了工作中某类职能属性的特征表现,是网络中用户行为模式的最小体现.模元表现为一些特征的组合,其具体的含义需要依据特征在现实中的语义并结合在模元中的权重来进行判定.模元的个数决定了模式分析的研究尺度.将模元作为描述用户行为模式的“基”,最终用户某时刻的通信行为模式可理解为模元空间中的向量.它是结构角色的延伸,即同时包含了结构特征和职能特征,能更全面地代表用户行为模式.引入抽象的模元之后,之前的二元对应关系:就变成三元对应关系:二元关系下,每个用户都会有自己的行为模式—特征的对应表示,不同用户行为模式之间不易对比,而且每个模式都要对应到m维向量空间(m为特征的个数);而在三元关系下m个特征会预先对应到r个模元(通常rm),然后将用户行为特征映射到r维向量空间,这样一方面降低了行为模式表示向量维数,另一方面每个模元代表一个基本行为模式,因此不同用户间的行为模式作比较就变得相对容易些.本文采用非负矩阵分解(NMF)来计算模元,它一方面有便于操作、过程及结果的可解释性等优点;另一方面,文献[15]的研究表明列正规化后的NMF在I-散度下与pLSA所优化的目标函数是一致的,因此矩阵分解对于模元计算来说同样具有统计模型的基础,只是求解的方法不同.3.2.2行为模式的计算本文的目的是挖掘邮件网络中用户的行为模式,而行为模式是用户在长期的工作生活中使用邮件通信时逐步积累并体现出来的,因此本文主要是以组织内部人员中使用邮件通信的频率较高的那些用户作为研究对象,通过分析其通信行为模式的变化情况,发现并定位异常的事件.给定t时间内连续的T个邮件网络快照={G1,G2,…,GT}.首先借助用户在各快照中出现的次数来标志用户的活跃度,然后取最活跃的Topθ%的用户作为行为模式挖掘的研究对象.在实际中可以依据问题的背景来决定θ取值.假设共选取了n个不同的用户,然后分别对各快照计算这些用户相关特征的取值,设m为特征个数,则可得到T个m×n的特征矩阵={犃1,犃2,…,犃T}.计算用户行为模式的主要过程如下:过程1.用户行为模式的计算.1.利用计算基准特征矩阵犃.2.对特征矩阵犃与进行标准化处理.3.对基准特征矩阵犃进行非负矩阵分解,获得模元矩阵犠.4.对每个特征矩阵:已知犃i,犠,求解犃i=犠×犎i,得到模式系数矩阵犎i;分别提取{H1,H2,…,HT}中的第j列组成用户j在t时间内基于模元矩阵犠的行为模式演变序列.下面分别给出每步的详细说明.(1)计算基准特征矩阵基准特征矩阵犃为所有的用户提供一个统一的参考标准,它反映了用户在邮件网络中整体的行为特征表现.对于用户j的特征i而言,本文简单采用特征i在各个快照中非零值的均值来作为基准特征矩阵中用户j的特征i取值,即(2)特征矩阵标准化由于各个特征之间的尺度差异较大,例如聚集系数取值在[0,1]之间,而节点的度可达上千,两者之间最大相差4个数量级,因此数据预处理显得十分有必要.常用的标准差标准化会产生负值,无法进行后续的非负矩阵分解的工作,而离差标准化对数据的极值过于依赖.在此我们提出一种基于分位数的数据标准化方法,该方法简单有效,并能很好保留原特征的分布信息.对于基准特征矩阵犃的每行数据{x}(它们代表了不同用户同一特征的取值),首先计算其下侧p①①为了方便期见,我们将p的取值范围从(0,1)的连续区间x100=xmax.Page6分位数xp,然后按照xp-1<xp的原则构造区间(xp-1,xp],p∈[1,100],如果{x}的数据落入该区间内,则把它的值改写为p,最终数据取值均在[0,100].如此对基准网络特征矩阵犃做标准化处理后,保存其分位数矩阵犘m×101,再用犘m×101对其他的特征矩阵犃k∈,k=1,…,T做如下标准化处理犃kij=(3)模元矩阵求解非负矩阵分解(NMF)是Lee与Seung[16]在1999年提出的,并迅速引起研究人员的广泛关注,已成功地被运用到人脸识别、文本分析、推荐系统、数字水印等领域.它要求分解后的矩阵所有元素均为非负数,而非负数的限制恰恰是许多现实应用中的基本约束,因此NMF的分解结果能够很方便地与实际问题相结合,给出合理的解释.给定一个非负矩阵犃m×n,非负矩阵分解的目的是将犃m×n分解成两个非负矩阵犠m×r和犎r×n的乘积,即犃≈犠×犎,并使得误差犃-犠×犎2代表Frobenius范数)最小,其中r是预先确定的参数,通常满足r<mn/(m+n),犠称为基矩阵,犎称为系数矩阵,如图2所示(更多内容请参阅文献[17]).本文实验中选用Kim与Park[18]提出的NMF/ANSL算法来计算非负矩阵分解.如果把矩阵都表示为列向量集:犃=[犃·1,犃·2,…,犃·n],犠=[犠·1,犠·2,…,犠·r],犎=[犎·1,犎·2,…,犎·n],则某用户特征向量、模元矩阵、系数矩阵间的关系为犃·j=∑r给出基准特征矩阵犃,给定模元个数r(模元个数r决定了问题的分析粒度,较大的r会提高描述精度,但也增加了模型的复杂度,关于模元个数的确定在第5节会给予讨论),通过NMF分解特征矩阵犃m×n得到基矩阵犠m×r.其中基矩阵犠的r个列向量就是所要求的r个模元.由于基准特征矩阵犃是基于全体特征矩阵构建的,因此犠就代表整个网络中n个用户的基本行为模式单元集.(4)用户行为模式计算已知特征矩阵犃i,i∈[1,T]和模元矩阵犠,求其系数矩阵犎i,使得犃i-犠×犎i2这是一个非负最小二乘问题,可用文献[19]中的方法求解.对于用户j而言系数向量集{犎1·j,犎2·j,…,犎T·j}就作为其在t时间内基于模元矩阵犠的行为模式演变序列.通过对该序列的分析可以很方便地检测该用户行为模式的变化,检测异常事件.4实验分析4.1实验数据本文实验选用Enron公司内部人员的邮件网络日志①.Enron公司是全美最大的电力和天然气销售及交易商,也提供各种能源产品、宽频服务以及金融和风险管理服务.在2001年10月至11月短短二十几天时间内,Enron股价下跌近80%,近200亿美元的市值蒸发,最后退市以破产告终.该邮件数据集是美国联邦能源管制委员会(FERC)在调查Enron破产事件时公开的.我们选用2001年1月1日至2001年12月30日共52周的数据,把后缀为“@enron.com”的邮箱视作内部员工的邮箱,只分析发信方和收信方至少一方邮箱后缀为“@enron.com”的记录,然后清除无效节点(如no.address@enron.com,@enron.com)以及节点到自身的边,我们注意到数据集中的“CC”(抄送)与“BCC”(密送)①http://www.isi.edu/~adibi/Enron/Enron.htmPage7字段的记录具有高度的重合性,就是说一封邮件同时抄送、密送了同一个人,因此仅保留抄送记录,实验数据的基本信息如表2所示.全部通信106265734726内部通信97172423661外部通信9093311065邮件网络的切分间隔会影响模元代表的含义,切分间隔的大小完全取决于研究者对问题的关注角度.本文实验中选用“周”这一基本的工作周期来作为网络的切分间隔,将Enron数据集按照周为单位分割成52份,基本数据统计如图5所示.每个内部员工邮箱在各快照中出现次数统计如图6所示.由于本文关注的是用户行为模式,而模式是基于长时间的记录来学习的,因此我们只选择那些长期活跃的用户作为模式挖掘的对象.本实验中选取前5%的活跃用户作为模式挖掘的对象,即在52个快照中出现次数在32次以上的用户,共有1191个用户.4.2特征筛选收集到的多个特征之间可能会有相互依赖性,为了降低数据维数并提高计算的精确性,可以利用Pearson相关系数来计算特征之间的相关性,依此来做特征筛选.例如相关系数的绝对值大于给定阈值,就说明两个特征的相关性大于预设,应该删掉其中一个.结合前面的描述我们按照内部通信网络、外部通信网络、结构特征、职能特征的层次可选取内部聚集系数、出度、入度、邮件抄送数量、外部联系人数、内部联系人数等众多特征.但是由于Enron数据集本身所包含的信息较少且不够完整,本文实验中仅提取到了46个特征.如图7所示特征之间的相关性集中分布在[0.2,0.6]区间,实验中设特征间Pearson相关系数阈值为0.7(由于特征个数较少且彼此相关性较大,因此选取了较大的阈值.此处的阈值仅作示范用,在真实情况下应该根据特征之间相关性的分布情况选取较合适的阈值,以求在保证特征间低相关性的同时保留较多的特征),共删除31个特征,剩下15个特征,各特征的含义详见表3.ID含义ID含义ID含义1#r6#(s,u)[i]11ID9/ID7[i]2#s7#(u,r)[i]12#r[o]3LCC[i]8#(s,u)[i]13#s[o]4#r[i]9#(u,r){CC}[i]14#(u,r){CC}[o]5#s[i]10#(s,u){CC}[i]15#(s,u){CC}[o]注:#代表数量,代表不重复,u代表该用户,r代表u主动通信的联系人,s代表主动与u通信的联系人;(u,r)代表用户u发送的邮件,(s,u)代表用户u接收到的邮件;{TO,CC}代表传送方式;LCC指局部聚集系数;[i]指域内网络,[o]指域外网络.4.3模式计算与分析对于NMF的实现我们采用Li等人[20]的Matlab工具包.该工具包中使用迭代的方式来计算非负矩阵分解,我们设定判断迭代收敛的误差阈值为10-6.4.3.1模元含义及个数的确定模元本质上是特征的组合,其具体含义需要借助该模元中占主导地位的特征的含义并结合邮件用户的背景知识来进行归纳抽象.模元的个数决定了行为模式分析的研究尺度.图8展示了不同模元个数与特征的对应关系.由表3可知特征3~11是邮件网络域内特征,而特征12~15是邮件网络域外特征.当r=2时,模元1中域内特征与域外特征均有体现,并且表示接收邮件行为的这类特征权重较高,因此可以推断模元1代表了常对外联络并接收邮件比较多的这类用户行为;而模元2中特征12~15的Page8权重为0,说明该模元反映的主要是仅存在域内通信的这类用户行为,同时注意到其特征1、3、4、9、11的权重较高,结合这些特征在表3中的含义可以推断模式2主要代表了跟内部人员具有较频繁通信的用户行为.随着模元个数的增加,模元所代表的含义也越来越精细,从而可以反映出更加细致的信息,体现了模型的多尺度特点.图8中当r=3时,可以分析出模元1重点体现了对外通信的行为模式;模元2中特征3、6、8、10的权重较高,而已知特征3局部聚集系数代表其联系人之间通信联系的强弱,特征6、8、10主要是跟收信有关的特征,可推测该模元代表了那些社团领袖的行为模式;模元3侧重在对域内发送邮件的特征但是局部聚集系数很低,代表了那些具有发布消息通告等广播行为的用户基本行为模式.为了展示不同的模元个数对用户行为模式挖掘的影响,我们分别以图8中两类模元为基础对各个快照的特征矩阵做分解,并提取所有系数矩阵中有关JeffreySkilling的列组成多元序列,该序列即体现其通信行为模式的演变情况,见图9.JeffreySkilling在2001年2月12日当选首席执行官(CEO),到8月14日突然辞职,共6个月的时间.上文已分析过图9中A与B的模式1均体现了有较频繁的对外联络特征,而从模式演变图中可以很明显地看出从第16周开始模式1表现的十分明显,这与其职位的变动以及作为CEO对外商业洽谈、外事处理等工作特点相符.他辞职时间大约对应33周(图中黑色虚线中间部分),从其前两周的行为变化来看A中模元2突然增多即对内的通信多了起来,而从B中看出主要是模元3的增加,更进一步可知其对内通信主要体现在广发消息这类行为.可见模元个数的增加可以对用户的行为有更为细致的分析.模元个数影响了对用户行为模式挖掘分析的粒度,模元个数的作用类似于空间的维度,小的可以降低计算的复杂度,但对模式的描述过于宏观,不利于对用户自身的模式演变的分析;大的可以对行为模式进行更细致的描述,但会增加计算的复杂度,不利于对用户行为模式的对比分析.如何选择合适的模元个数以准确有效地挖掘用户行为模式是一个值得深入探讨的问题.为了更好地描述众多不同用户的行为模式,我们期望得到更多的相关性低的模元.本文中借助模元间Pearson相关系数采用迭代筛减的方式来确定模元个数.给定一个模元的相关性阈值α,要求最终所有模元之间的相关系数均小于该阈值.首先给出一个较大的模元个数初值r,通过对基准特征矩阵犃进行模元个数为r的非负矩阵分解计算出模元矩阵犠;然后计算各模元之间的Pearson相关系数,如果存在模元间的相关系数大于阈值α,则把模元个数定为r-1;重复以上步骤,直到所有模元的相关系数均小于α为止.实验中设置模元间相关系数的阈值为0.2,初始模元个数为12,经过6轮运算最终确定模元个数为7,即可以从15个特征中,提取出7个基本行为模式单元来描述活跃度为Top5%的1191个用户的通信行为模式,同时保证了模元之间的相关系数小于0.2,彼此间具有较好的区分性.为了说明模元的客观性,我们另选取Top3%(至少出现39次,共741个用户)和Top10%(至少出现20次,共2479个用户)的活跃用户作为对象,然后与Top5%的用户的模元做对照.模元个数定为7时其各自模元与特征的对应关系见图10.可见Page9虽然选取的用户量不同,但是最终的模元与特征的对应关系是基本一致的,只是在权重上面有所差异,说明模元在用户行为模式挖掘的过程中是相对稳定的.4.3.2工作性质与模式的关系我们认为工作性质决定了用户的基本行为模式,不同的职务所体现出的行为模式会不同,但具有相同工作性质的个体之间会因受到个体性格、生活习惯等个性的影响表现出差异性.图11给出了两种不同职务的员工在图8中所示模元个数为2的情况下通信行为模式对比,左侧一列是5位职员(Employee),右侧一列是5位交易员(Trader).由上文知,模元1代表较频繁的域外通信模式,模元2主要代表域内通信模式.图中可以明显地看出交易员的通信行为模式以模元2为主,而职员的通信行为模式中模元1的比重相对交易员而言更多一些,可以解释为交易员的工作更多的需要跟客户频繁地沟通,所以域外通信较多,而职员的工作交流主要在公司内部,个体间的差异导致其模式演变的不同.这一方面验证了工作性质决定通信模式的假设,另一方面也图12JeffreyMcMahon通信行为模式演变图说明保留不够完整的对外邮件网络的信息是有必要的,如若不然就无法挖掘出交易员这类职务重在对外通信的这一行为模式.同时相同职务的个体之间也有着不同的模式演化轨迹,表明个体的通信行为模式会受到个体化差异的影响.另外,可以明显地看出职员A在18周时通信模式发生了重大的改变,可推测其工作岗位发生了变化.4.3.3用户个体行为模式的分析通过对用户各模元的表现强度的变化分析可以发现用户在使用邮件过程中发生的事件,例如工作职能的转变等.图12给出了Enron的首席财务官(CFO)JeffreyMcMahon依据图10中Top5%的模元为基时通信行为模式演变图,左上是模元与特征的对应关系,右上是通信行为模式演变序列的立体展示.从图中可以看出在44周后McMahon所展现出的行为模式有较明显的变化,主要是模元2、3、4所占比重开始增加并维持下来.结合左上侧模元与特征的对应图以及表3中各特征的含义分析得知模元2主要代表接受来自企业内部的抄送邮件模式,模元3主要代表其联系人之间存在紧密联系的模式,模元4代表接受来自企业内部邮件的模式.2001年10月24日(约第44周,下图中黑色虚线所示)原工业市场部主管JeffreyMcMahon接替AndrewFastow担任Enron的CFO.基于这一背景我们可以把上述行为模式的改变理解为McMahon从中级领导升级为整个企业的高管,CFO要负责财务、会计、投资、融资、投资关系和法律等事务,其所管辖的人员跟事务开始增多,于是收到抄送邮件的次数会增加(模式2),负责的事务多了接受邮件的总量也会增加(模式4),并且会直接跟公司各领导阶层进行通信,而这些领导之间也必然会有广泛的联络,所以模元3代表的模式也开始展现出来.Page104.4与相关工作的对比GraphScope所关注的是连续快照间的异常,可以检测快照变化的时刻,从而发现整个网络层面的事件,但是不能发现个体的异常行为.OddBall是通过个体之间的对比来发现那些异于群体的节点,但这只能说明该节点与其他节点的行为模式有着很大的不同,并不意味着该点的行为模式是异常的.正如第3节中所描述的那样,不同职位的人其邮件通信行为模式是不同的,可以直观地认为普通职员的通信模式与高层管理者的通信模式是有差异的,但是普通职员的数量要远远多于高层管理者的数量,这就使得管理者在行为模式上异于员工群体,但据此就可说明管理者的行为模式是不正常的吗?真实情况未必如此.本文的工作弥补上述两种方法的不足,通过对用户自身不同时间段的通信行为模式进行对比可以检测出用户个体行为模式发生的异常变化,从而为事件的时间定位及排查提供帮助.5问题讨论与模型应用5.1问题讨论模元个数决定了对用户行为模式挖掘的尺度,它的取值大小既决定了对用户行为模式分析的细腻程度又影响了模式表示的复杂度.关于模元个数的选择目前缺少统一的衡量标准,它依赖于具体的问题背景、研究目的及特征之间的联系等因素.文献[11]利用最小描述长度准则基于最佳压缩率的思考给出了一个可以自动确定结构角色个数的模型.它研究的仅是节点的结构属性,最佳压缩率也意味节点集的共性最大化,然而本文中的模元概念与其相比有了更丰富的内涵,我们的目的是通过学习用户的通信模式,希望能从中挖掘到隐含的信息,因此有时较多的基本模式单元会有利于发现那些更加隐蔽的行为模式.模元个数也可以归结为一个研究模型的尺度问题,类似于聚类分析中类别个数、主题模型中主题个数、社团划分中社团个数等,自然也可以借鉴这类问题的解决方案,但在实际中还是要根据具体问题来区别对待.此外,本文需要从T个邮件网络快照的特征矩阵中构建一个基准特征矩阵犃.基准特征矩阵通常代表用户截至某一时刻的全局情形下行为特征的平均体现.整个网络中基本模式单元的挖掘效果依赖于构建的基准特征矩阵能反映出用户整体行为的准确性如何.本文简单地采取了取平均值的方法构建基准特征矩阵,如何合理准确地描述整个邮件网络中用户的主导行为模式是个有待解决的问题.5.2模型应用通过引入模元的概念将用户某快照内的行为模式最终表现为模元空间中的一个向量,而多个连续的快照就可以组成一个反映用户行为模式演变的多元时间序列.基于统一的模元来表示用户的行为模式大大方便了对用户行为模式的进一步分析和比较.例如不仅可以通过对用户行为模式的变化来推测事件的发生时间及其基本行为,还可通过对用户模式序列进行分析学习,构建用户行为模式的预测模型,对用户以后行为模式的发展做出预测.6结束语组织机构内的邮件通信主要用于业务交流、消息传递、文件发放等与工作紧密相关的内容.用户行为模式是用户邮件通信行为的综合体现,挖掘用户行为模式对检测数据泄漏、内部威胁等工作有着重要的实用价值.本文以Enron公司的邮件通信日志为研究对象,引入基本行为模式单元挖掘用户的通信行为模式.首先,把邮件通信网络从结构上分为域内和域外两部分,提取其结构特征和职能特征.然后,通过构建邮件通信的基准网络,利用非负矩阵分解来计算整个网络的基本行为模式单元.最后转化成求解非负最小二乘问题,利用系数序列来表示用户的通信行为模式.在Enron邮件数据集的实验结果表明了我们的方法能够有效地获取用户的通信行为模式,并能通过分析用户行为模式的变化来定位事件的发生.
