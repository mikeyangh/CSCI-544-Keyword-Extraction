Page1基于QCircuit的BB84窃听仿真与分析路松峰1)陈莹1)胥永康2)胡和平1)赵友桥1)1)(华中科技大学计算机科学与技术学院武汉430074)2)(中国工程物理研究院计算机应用技术研究所四川绵阳621900)摘要该文研究量子线路模型仿真量子密钥分配协议.基于QCircuit软件运用量子线路模型设计不同攻击模型下的BB84量子密钥分配协议仿真模型,并引入rsec和I^(α,ε)两个指标,设计指标分析线路模型,仿真分析了不同噪声信道模型下BB84密钥分配协议在P/P、B/P和B/B三种不同截取/重发策略下的有效性及安全性.仿真结果表明,在噪声环境下,基本的BB84协议无法满足量子密钥的有效性和安全性,即使采用协商纠错也不能保证密钥的安全性;为此需要进一步采用保密增强等后处理措施.关键词量子计算;量子密钥分配;量子线路模型;量子线路仿真;量子密码协议1引言量子密钥分配协议(QKD)旨在利用量子力学Page2议:BB84协议[2].BB84协议基于两组不同的正交基(Protocol基)编解码随机密钥比特,通信双方Alice和Bob利用观测一般会干扰被观测系统的量子力学原理来检测窃听者的存在,从而实现安全密钥共享.窃听者Eve同样可以充分利用量子力学特性以采用不同的攻击策略窃取信息,文献[3]利用Alice和Eve的平均互信息量评判了非相干攻击中两种不同的截取/重发策略,得出结论:Protocol基窃听优于Breidbart基窃听;文献[4]则进一步分析了BB84继协商纠错处理后Alice和Eve的平均互信息量,得出结论:Breidbart基窃听在标准协商纠错方法下更有效[3,5].但是这种评判标准并不能很好地衡量窃听者信息,因为通信双方进行数据筛选和协商纠错时将舍弃那些不一致的比特信息,也就是说,Eve窃听到的一部分信息是无效的,为此文献[6]提出有效平均互信息量评判标准,文献[7]研究了各种窃听方案下Alice和Bob可以采用的反攻击策略.以上Eve窃听信息量的研究均为理论分析和推导,并没有考虑在真实物理环境下,不可避免的各种噪声对其带来的影响.目前,为了减少真实物理环境研究的巨大开销,研究者们开发了一系列仿真软件,主要有QCSim、QDNS、QCircuit①、Qucrypto②等.此外,还有量子计算语言QCL③、Mathematica软件包QDENSITY④以及C语言函数库libquantum⑤等.迄今为止,运用量子线路模型对量子密钥分配协议的有效性和安全性进行量化仿真分析在国内研究中还是空白.国外学者Pereszlényi提出了这一思路,但是其针对BB84协议设计的QCircuit线路分析模型仅局限于单一的简单截取/重发攻击,并没有深入考虑窃听者可能采用的不同攻击策略,并且仅依据误码率差值即协议可靠率rsec来定量分析BB84协议的安全性也具有一定的局限性,因为不同攻击策略下窃听者所引起的误码率有所区别[8].此外,误码率并不能全面地衡量一个密钥分配协议的安全性,在理论论证时通常还需要借助互信息量来衡量窃听者的窃听信息量.为了弥补国内量子线路模型仿真密码协议的研究空白,本文在QCircuit仿真软件上设计基于不同量子噪声信道模型BB84协议在不同截取/重发攻击策略下的量子线路仿真分析模型,并在Pereszlényi的研究基础上为文献[6]提出的有效平均互信息I^(α,ε)构建线路分析模型,结合协议可靠率rsec进一步深入、全面地分析了BB84协议的有效性和安全性.2截取/重发基下的平均互信息BB84协议中通常使用水平偏振基和π/4偏振基,统称为Protocol基,把介于两组Protocol基之间的一组正交基称为Breidbart基,如图1所示,定义Breidbart基为沿θ方向和θ+π/2方向的一组偏振基(θ∈[0,π/4]).令这组偏振基为则有又已知故得|〉=1|〉=1由式(2)及式(4)可知,Eve使用测量基{|eθ0〉,|eθ1〉},得到正确结果的概率分别为p(|→〉|→〉e)=p(|↑〉|↑〉e)=cos2θ,p(|〉|〉e)=p(|〉|〉e)得到错误结果的概率分别为①②③④⑤Page3p(|↑〉|→〉e)p(|〉|〉e)=p(|〉|〉e)其余未给出概率均为0,令i,j∈{|→〉,|↑〉,|〉,|〉},m∈{|→〉e,|↑〉e,|〉e,|〉e},BB84协议中Alice等概率制备{|→〉,|↑〉,|〉,|〉},故有Eve获得的平均信息利润为G=14∑m∑i≠j由式(7)可知,当且仅当θmax=π/8时,Eve获得最大平均信息量利润G=槡2BERe=11-BERe=1p(|→〉|→〉e)=p(|↑〉|↑〉e)=p(|〉|〉e)p(|↑〉|→〉e)=p(|→〉|↑〉e)=p(|〉|〉e)则Alice和Eve的互信息量为I(α,ε)=1+ηlog2η+(1-η)log2(1-η)≈0.3991本文研究的Breidbart基窃听策略均为θmax=π/8下的Breidbart线偏振基.同理可导出,当θ=0或θ=π/4,即Eve使用Protocol基(水平或π/4偏振基)时,Alice和Eve的互信息量为I(α,ε)=1+1由式(9)与(10)得,Eve采用Protocol基窃听比图2无窃听BB84协议仿真线路模型Breidbart基窃听得到更多的信息[3].但这些信息很可能因为Alice和Bob后续进行的数据筛选及协商纠错而失效.为此我们将仿真计算不同信道噪声下,经数据筛选和协商纠错后BB84协议在不同窃听基策略下的有效平均互信息量I^(α,ε),并结合可靠率rsec进行详细的比较分析.3仿真线路模型设计本文采用独特的量子线路模型,基于QCircuit软件通过不同信道模型尽可能地真实地仿真实际通信环境,在文献[8]Protocol基截取/Protocol基重发(P/P)攻击策略基础上设计另外两种典型的截取/重发攻击策略模型,分别为Breidbart基截取/Protocol基重发(B/P)和Breidbart基截取/Breidbart基重发(B/B).同时在协议可靠率rsec基础上引入了有效平均互信息量I^(α,ε)这一指标量,并为其设计分析模型定量仿真分析BB84协议,如图2~图5.3.1线路模型设计在文献[8]基础上设计B/P与B/B攻击模型,Breidbart基截取时,使用自定义的Breidbart测量器BM进行测量,依据式(1)将测量基运算元设置为[cos(π/8),sin(π/8)]与[-sin(π/8),cos(π/8)];Breidbart基重发时,使用自定义1/8门对测量结果重新编码,其中1/8门对应的酉变换即为Breidbart测量基的逆变换.在协议可靠率rsec基础上设计有效平均互信息量I^(α,ε)分析线路,首先评判Eve是否窃听到正确信息,然后评判此时Eve是否引入误码,设计思路如下:通过Eq门比较Alice比特值和Eve比特值并进行测量,测量器标识为Everightbit,在其后设置同名观察器,若相等则测量结果为1.然后将此测量Page4图3基于P/P窃听的BB84协议仿真线路模型图4基于B/P窃听的BB84协议仿真线路模型图5基于B/B窃听的BB84协议仿真线路模型结果与rsec线路模型下的测量器Thebasesandbitsmatch的测量结果经由受控Puali-X门评判是否引入误码率,并测量评判结果,将此测量器标识为Eve’srightbitwhenAandBmatch.测量结果为0时,即误码.3.2狉sec与犐^(α,ε)指标定义文献[8]设置观察器Thebasesmatch用来查看测量器Thebasesmatch的测量结果1(即Alice和Bob选用相同的测量基)的概率,把无窃听者Eve下的结果记为rbases,有窃听者Eve的结果记为rEve,bases.观察器Thebasesandthebitsmatch用来查看测量器Thebasesandthebitsmatch的测量结果1(即Alice和Bob选用相同的测量基且比特信息一致)的概率,把无窃听者Eve下的结果记为rbitss,有窃听者Eve的结果记为rEve,bits,并给出协议可靠率rsec定义如下Page5其中通过比较Eve存在与否的两个误码率,检测通信协议的可靠性.若Eve存在时的误码率明显大于Eve不存在时的误码率,那么Alice和Bob可以检测出Eve的存在,从而放弃此次不安全通信.结合仿真图2~图5的观察器输出结果,定义Alice和Bob数据筛选且协商纠错后,Eve有效窃听率如下其中,rEver为观察器Eve’srightbitwhenAandBmatch用来查看测量器Eve’srightbitwhenAandBmatch测量结果为1(即Eve在Alice和Bob进行数据筛选后留下的正确比特信息)的概率.那么式(9)与式(13)修改为Alice和Eve的有效平均互信息I^(α,ε)I^(α,ε)=1+η^log2η^+(1-η^)log2(1-η^)(14)I^(α,ε)=1+14仿真结果分析4.1协议可靠率狉sec仿真分析首先,我们关注可靠率rsec,为简化仿真过程,这里假设信道Ch1无噪声,即Alice发送设备精准,同时Alice与Eve之间的通信信道没有噪声;Ch2信道分别选用幅度阻尼(Amplitude-Damping,AD)、去极化(Depolarizing)及相位阻尼(Phase-Damping,PD)噪声信道模型,并且设置参数p∈[0,1],Δp=0.125.图6给出了不同噪声信道模型下Eve采取不同截取/重发攻击策略时rsec的变化曲线图,下面做出详细分析说明.在无噪声(p=0)信道下,Eve采用P/P与B/B窃听策略时,BB84协议的可靠率rsec为0.25,而B/P窃听策略时,rsec为0.3232.无论是在哪种噪声信道模型下,P/P与B/B窃听策略和B/P窃听策略下,rsec的最大差值都在p=0时取得,相差0.0732.由于无噪声信道下,当Eve不存在时,Bob误码率为零,图6不同攻击策略及噪声信道模型下rsec变化曲线图因此由式(11)可知,当Eve存在时Bob误码率BERP/P与BERB/B均为0.25,而BERB/P为0.3232,成功验证了文献[3]给出的结论:当Eve在截取/重发攻击中,使用相同的测量基与重发基(无论是水平偏振基、π/4偏振基,还是Breidbart基),Bob的误码率均为0.25,如果Eve选取不同测量基与重发基则引入更多错误.相位阻尼噪声信道下,无论是P/P、B/P,还是B/B窃听策略,rsec随着信道误码概率p从0到1增加呈线性下降,但是在p=1时并不下降到0,也就是说攻击者即使在噪声最大的情形下也能够被检测到.在p=1时,当Eve采用P/P与B/B窃听策略,rsec为0.125;当Eve采用B/P窃听策略,rsec为0.1616.在去极化噪声信道下,随着信道误码概率p从0到1增加,无论是P/P、B/B还是B/P窃听策略,BB84协议的可靠率rsec也呈线性下降,并在p=1时下降到0.在幅度阻尼噪声信道下,p从0到0.875时,无论是P/P与B/B窃听策略还是B/P窃听策略,rsec呈线性下降,在p=0.875时,P/P与B/B窃听策略下rsec为0.0598,而B/P窃听策略时,rsec为0.0774.并在p为[0.875,1]时,下降率加剧直至零.4.2有效平均互信息犐^(α,ε)仿真分析下面从I^(α,ε)角度进一步分析BB84协议的安全性.图7给出了不同噪声信道模型下Eve采取不同截取/重发攻击策略时I^(α,ε)的变化曲线图,下面做出详细分析说明.在无噪声(P=0)信道中,P/P窃听策略下,Alice和Eve的有效互信息I^P/P(α,ε)为0.6750;B/P窃听策略下,I^B/P(α,ε)为0.6965;B/B窃听策略下,I^B/B(α,ε)为0.8130,即I^P/P(α,ε)<I^B/P(α,ε)<I^B/B(α,ε).也就是说,在这3种窃听策略下,当Eve采用B/B窃听策略时,Eve可以窃取到最多有效信息.Page6图7不同攻击策略及噪声信道模型下I^(α,ε)变化曲线图在相位阻尼噪声信道下,随着信道误码概率p的增长,无论是P/P、B/P还是B/B窃听策略,I^(α,ε)呈线性下降,其中I^P/P(α,ε)受p的影响最小,其次是I^B/P(α,ε),影响最大的是I^B/B(α,ε).I^P/P(α,ε)和I^B/P(α,ε)在p约为0.18时相交,继而随着p的增长,反而有I^B/P(α,ε)<I^P/P(α,ε);I^P/P(α,ε)和I^B/B(α,ε)在p约为0.85时相交,继而随着p的增长,反而有I^B/B(α,ε)<I^P/P(α,ε).在相位阻尼噪声最大即p=1时,I^P/P(α,ε)最大,为0.6390;I^B/B(α,ε)次之,为0.6127;I^B/P(α,ε)最小,为0.5520.在去极化噪声信道下,随着信道误码概率p的增长,无论是P/P、B/P还是B/B窃听策略,I^(α,ε)也呈线性下降,其中I^P/P(α,ε)受p的影响最小,其次是I^B/P(α,ε),影响最大的是I^B/B(α,ε).I^P/P(α,ε)和I^B/P(α,ε)在p约为0.10时相交,继而随着p的增长,反而有I^B/P(α,ε)<I^P/P(α,ε);I^P/P(α,ε)和I^B/B(α,ε)在p约为0.40时相交,继而随着p的增长,反而有I^B/P(α,ε)<I^P/P(α,ε).在去极化噪声最大即p=1时,I^P/P(α,ε)最大,为0.5944;I^B/P(α,ε)和I^B/B(α,ε)均降为0.3992.在幅度阻尼噪声信道下,随着信道误码概率p从0到0.875增长时,无论是P/P、B/P还是B/B窃听策略,I^(α,ε)也呈线性下降,其中I^P/P(α,ε)受p的影响最小,其次是I^B/P(α,ε),影响最大的是I^B/B(α,ε).I^P/P(α,ε)和I^B/P(α,ε)在p约为0.15时相交,继而随着p的增长,反而有I^B/P(α,ε)<I^P/P(α,ε);I^P/P(α,ε)和I^B/B(α,ε)在p约为0.52时相交,继而随着p的增长,反而有I^B/B(α,ε)<I^P/P(α,ε).并当p为[0.875,1]时,下降率加剧,在去极化噪声最大即p=1时,I^P/P(α,ε)最大,为0.5944;I^B/P(α,ε)和I^B/B(α,ε)均降为0.3992,与去极化噪声信道相同.4.3仿真分析小结通过上述分析可知,无论Eve选用P/P、B/P还是B/B窃听策略,rsec和I^(α,ε)两指标量受噪声信道的影响程度都为相位阻尼信道<幅度阻尼信道<去极化信道.在这3个噪声信道下,B/P窃听策略下的rsec受噪声影响比P/P与B/B窃听策略大,P/P与B/B窃听策略由于截取基和重发基相同受噪声影响也相同,并且在相位阻尼噪声信道下rsec并未降到零,也就是说只要Alice和Bob合理设置评估误码率,B/P窃听攻击更容易被检测到;同时I^B/B(α,ε)受噪声影响总是最为显著,其次是I^B/P(α,ε),影响最小的是I^P/P(α,ε),并且I^B/P(α,ε)总是小于I^B/B(α,ε),而在某个信道误码概率p下,I^P/P(α,ε)将超过前两者,也就是说,窃听者Eve采用哪种窃听策略为最佳窃听策略,要依据具体的信道环境的噪声类型和误码概率.在信道误码概率较小的时候,Eve采用B/B窃听最有效,可以窃取到最多信息同时引入的误码率也小,也即BB84协议的安全性此时受到最大威胁.如果无法评估信道的噪声类型和误码概率,为确保相对稳定的更多的有效窃听信息,Eve宜选用P/P窃听,因为虽然在小于某个信道误码概率p(通常在0.10~0.25之间取到)下,有I^P/P(α,ε)<I^B/P(α,ε),但是根据rsec分析可知,B/P窃听策略攻击更容易被Alice和Bob检测到.5结束语通过仿真实验可知,无论是rsec还是I^(α,ε)实验结果均表明:在非理想环境(即噪声环境)下,基本BB84协议无法满足密钥的有效性和安全性.由于噪声引起的误码率,通信双方无法保证密钥的一致性,并且窃听者可以获取到一定的有效密钥信息,无法保证密钥的安全性.因此,在实际量子密钥分配系统中,必须通过协商纠错来得到一致的密钥,但是从I^(α,ε)分析结果来看,协商纠错无法保证密钥的安全性.因此,还需要进一步后处理,即保密增强以确保密钥的安全性.此外,值得指出的是,rsec评估BB84协议的可靠性时,需要Alice和Bob协商合理的误码率,在尽可能不影响BB84协议有效性的前提下保证BB84协议的安全性.同时本文讨论的I^(α,ε)是基于Alice和Bob进行标准协商纠错,即废弃掉那些不一致测量基下的比特信息,并没有核对错误基下的信息准确率.综上,为保证量子密钥的安全共享,需要进一步深入研究,寻求一种更为安全的密钥分配方案.主要有两方面的解决思路:(1)进一步深入研究协商纠Page7错和保密增强算法,以设计出抵抗上述截取/重发攻击的有效安全算法,进一步巩固BB84协议的安全性;(2)设计新的更为安全的密钥分配思想或方案.这些将是今后要开展的研究工作.致谢在此,我们对PereszlényiAttila提供的Qcircuit仿真软件表示感谢!
