Page1一种面向移动计算的机密性与完整性模型郭云川1),3)方滨兴1)殷丽华1)周渊2)1)(中国科学院信息工程研究所北京100093)2)(国家计算机网络应急技术处理协调中心北京100029)3)(广西可信软件重点实验室(桂林电子科技大学)广西桂林541004)摘要机密性和完整性是移动计算的两个重要特性,如何保障机密性和完整性是移动计算的重大挑战.利用π演算能有效建模移动并发系统的特征,借鉴程序语言中不同类型变量之间的赋值方式,提出基于混杂类型检测的安全π演算(HybridTypedSecurityπ,πHTS).根据πHTS利用静态类型检测保障低机密级信息只能向同等或更高机密级流动,高完整级信息只能向同等或更低完整级流动,针对机密性和完整性在信息流向上的相反性,提出了基于强制类型转化的有效动态转换框架.πHTS将静态检测和动态检测有机地整合在一起,形成了一种统一的安全形式模型.它能同时保障移动计算中的机密性和完整性,具有较好的可用性.关键词机密性;完整性;混杂类型检测;移动计算;移动互联网1引言移动互联网在世界范围内广泛应用,仅在中国2010年底手机上网用户就达3.03亿[1],据中国互联网数据中心DCCI(DataCenteroftheChinaInternet)预测,2015年底中国手机上网用户将达9.19亿①,移动互联网正在深刻地影响着人们的生活及工作方式.安全问题作为移动互联网的挑战之一正影响其发展,国家计算机病毒中心统计表明,2010年39.85%的移动终端曾感染病毒,54.09%曾被病毒感染的用户手机无法正常使用,50.32%的用户信息曾被泄露,46.55%的用户曾被恶意扣费②.即使针对非恶意入侵,移动互联网中安全隐私也是一个重大问题,如位置匿名.移动互联网安全研究包括两类:(1)针对移动终端、接入网络和应用服务的应用及应用基础研究,具体地包括移动终端安全、无线网络安全、应用安全、内容安全及位置隐私保护等;(2)基于移动计算的移动互联网的机理研究,包括移动计算安全模型、移动安全评估等.针对第1类,最新的工作包括文献[1-4]等,其中,文献[2]在消息中附加安全策略来保障移动Adhoc网络的机密性,文献[3]给出了一种移动环境下的紧急医疗救助方案,文献[4]提出了一种面向移动社交网络的协作式内容分发机制,文献[1]综述了面向移动互联网的终端、网络与服务的研究现状.在移动计算的机理建模方面,π演算由于能有效建模信道名创建及交换而在移动计算中得到广泛使用.如文献[5]利用π演算建模移动主体是否具有访问某种资源的能力,文献[6]进一步扩展了π演算,区分两种不同的能力类型(CapabilityTypes):读信道类型和写信道类型,建立子类型关系,进而给出了类型化移动进程的代数理论;文献[7]基于π演算设计ω算子来刻画MANETs网络的广播、节点移动等特性,区分了两类不同的动作:τ动作和μ动作,并分隔MANETs节点的通信和计算行为,该工作能有效地建模和推理MANETs网络的行为.文献[8]利用局部位置和在不同位置的计算能力来刻画移动系统,而后采用标签Kripke结构以位置网的形式建立其形式语义,并使用SATABS模型检验器进行验证.然而,文献[5-8]不涉及安全.为了分析移动计算中的安全性,文献[9]进行安全级划分,采用π演算建模移动资源访问,保障低安全级的主体不能访问高安全级的信息.但低安全级的主体不能访问高安全级信息,这不能同时保障机密性和完整性:机密性模型(如BLP模型)中低安全级主体能以“写”的方式访问高安全级信息,完整性模型(如Biba模型)中低安全级主体能以“读”的方式访问高安全级的信息.文献[10]基于控制流图扩展了Java安全体系结构,定义了交互式移动设备中资源访问控制的程序验证模型,但并未定义安全策略,因此,难以同时处理机密性和完整性.由上面的分析可看出,虽然研究者对移动计算分析、建模及验证进行了深入研究,但鲜有同时保障机密性和完整性的形式模型.特别地,虽然有很多工作利用加密及哈希等方式提供机密性和完整性,但我们认为这是从语法层面保障的.从信息流语义层面看,目前少有工作同时提供机密性和完整性,其部分原因为:以BLP模型为代表的机密性模型保障信息只能从低安全级流向同等安全级或高安全级信息或主体,以Biba模型为代表的完整性模型保障信息只能从高安全级流向同等安全级或低安全级信息或主体.这意味着语义层面机密性模型和完整性模型在信息流上是相反的.如果直接采用两种模型来保障移动系统的机密性和完整性会降低可用性[11].这种情况下何如采用BLP和Biba模型来同时保障移动系统的机密性与完整性且不降低可用性成了一个问题.针对该问题,本文利用π演算能够有效建模移动并发系统的特征,借鉴程序语言中不同类型变量之间的赋值方式,提出混杂类型检测安全π演算(HybridTypedSecurityπ,πHTS).根据πHTS利用静态类型检测保障低机密级信息只能向同等或更高机密级信息流动,及高完整级信息只能向同等或更低完整级信息流动.针对BLP模型和Biba模型在信息流向上的相反性,提出了动态检测框架.πHTS将静态检测和动态检测有机地整合在一起,形成了一种统一的安全形式模型.它能同时保障移动计算中的机密性和完整性,且不降低可用性.2πHTS中的类型及前序关系为了给出保障机密性和完整性的类型化安全π演算,需要给出进程或项的类型,为此,首先讨论与类型相关的预类型.①②Page32.1预类型首先定义πHTS的预类型,如下:preT····=base|{L1,L2,…,Ln};base····=(SC,SL)|(IC,IL)|(SC,SL,IC,IL);L····=ch+〈preT〉|ch-〈preT〉.预类型(preT)包含了两类:基值预类型base(用来描述算子中变量或名的预类型)和信道预类型{L1,L2,…,Ln}.基值预类型包含了机密基值类型(SC,SL)、完整基值类型(IC,IL)及混杂基值类型(SC,SL,IC,IL).机密基值类型(SC,SL)是一个二元组,其中,第1维为信息的机密性范畴(Category),如文献[12]中的US和EUR等,第2维表示该信息运行的机密级标签,如机密、绝密等.由于实际应用中SC和SL依据不同的应用而可能不同,所以对SC和SL没有做明确限制(后面的IC和IL类似).同样,完整基值类型(IC,IL)也是一个二元组,其中,第1维表示完整性范畴,如文献[12]中的“生产(SP)”、“开发(SD)”和“系统开发(SSD)”等,第2维表示完整级标签,如高完整级、低完整级等.混杂基值类型是机密基值类型和完整基值类型的合成.信道预类型用集合表示,集合中的每个元素要么为写信道预类型ch+〈A〉①,要么为读信道预类型ch-〈A〉.若某变量x的类型为ch+〈A〉,这意味着x是信道,且可向x中写入类型为A的值.同样若某变量x的类型为ch-〈A〉,这意味着x是信道,且可从x中读出类型为A的值.若将信道预类型集合直接作为相应的值类型,而不对读写信道的能力做限制,这可能会导致信息流动违反BLP模型或Biba模型.如若将{ch+〈A〉,ch-〈B〉}直接作为信道的类型(即可以向该信道写入类型为A的值,也可以从该信道读取类型为B的值).此时,若A的SL为高机密级,B的SL为低机密级,则会导致违背BLP模型(因此不能将这些集合直接作为类型,故而称之为预类型),为了避免这种情况,需要先定义子类型关系.2.2子类型由于机密性基值类型和完整性基值类型均为二元组,为了定义预类型上的子类型关系,我们先讨论维上的关系.对于第1维,用表示机密性范畴(SC)或完整性范畴(IC)上的子类型关系②.该关系的定义依据不同的应用而不同,本文定义基值机密性范畴或基值完整性范畴上的子类型关系为集合上的包含于关系,如对于上一小节的基值机密性类型US和EUR,有{US}{US,EUR}.对于第2AB维,机密性信息流和完整性信息流均可看成完全格,因此,在机密级上和完整级上分别构成偏序关系(分别用S和I表示).其含义如下:若sl1和sl2为机密级标签集合上的两个元素,il1和il2为完整级标签集合上的两个元素,则sl1Ssl2表示标签为sl2的机密性高于标签为sl1的机密性,il1Iil2表示标签为il2的完整性高于标签为il1的完整性.由此,类似于文献[9],预类型上的子类型关系可定义如下:Sub-secr-baseSC1SC2SL1SSL2(SC1,SL1)(SC2,SL2)Sub-hybrid-baseSC1SC2SL1SSL2IC2IC1IL2IIL1(SC1,SL1,IC1,IL1)(SC2,SL2,IC2,IL2);Sub-wrch+〈B〉ch+〈A〉Sub-link(j)(i)LiLj{Li}i∈I{Lj}j∈J上面定义中最上面一行为相应子类型规则的名称,如Sub-secr-base为SC1SC2SL1SSL2名称.Sub-secr-base表明,若SC1是SC2的子类型,且机密级别SL1小于SL2,则(SC1,SL1)为(SC2,SL2)的子类型.Sub-inte-base与Sub-secr-base相反,若IC1是IC2的子类型,且完整性级别IL1小于IL2,则(IC2,IL2)为(IC1,IL1)的子类型.Sub-hybrid-base是Sub-secr-base和Sub-inte-base的合成.对于写信道类型,规则Sub-wr表明,对于值预类型A和B,若A为B的子类型,则ch+〈B〉是ch+〈A〉的子类型.而对于读信道类型,规则Sub-rd表明,对于值预类型A和B,若A为B的子类型,则ch-〈A〉是ch-〈B〉的子类型.规则Sub-link表明,若信道预类型{Li}i∈I为{Lj}j∈J的子类型,则要求对任意的Lj均存在Li使得Li为Lj的子类型.规则Sub-pwt显示,对于进程类型pwt,自身互为子类型.下面以BLP模型中的策略为例,进一步阐释子类型关系的含义(Biba模型与此类似).①②Page4(1)若变量x和y的类型分别为({US},public)和({US,EUR},secrecy),即x的范畴为US,y的范畴为US和EUR,且x和y的机密级别分别为public和secrecy,则有({US},public)({US,EUR},secrecy),即机密级别为public的数据可看着机密级别为secrecy的数据①,这符合BLP模型,并不违背数据机密性.(2)若x:ch+〈({US,EUR},secrecy)〉和y:ch+〈({US},public)〉,即为x和y均为写信道类型,且能够向信道x中写入机密级别为secrecy的数据,向信道y中写入机密级别为public的数据.采用Sub-wr规则有x:ch+〈({US,EUR},secrecy)〉ch+〈({US},public)〉,即在机密级别为secrecy的信道x中可写入机密级别为public的数据,这并没违反机密性模型(因为在写入机密级别为public的数据之后,会将其机密级别提升为secrecy).文献[9]采用某个安全级别所能访问的信息作为基值类型,这隐式地表明了该安全级别能访问所有处于该级别范畴的信息,并暗含了高安全级能访问所有低安全级能访问的信息(低安全级能访问的作为高安全级能访问的子类型),然而这对于Biba模型来说并不成立.因此,我们在基值类型定义中区分机密性和完整性,并将范畴和级别所形成的元组作为基值类型.从子类型规则可以看出,对于机密性基值类型,其合成是协变的(Covariant),而对于完整性基值类型,其合成是逆变的(Contra-variant).这是因为BLP模型需要保障数据只能从低机密级流向同等或高机密级,而Biba模型需要保障信息只能从高完整级流向同等或低完整级.另外,写信道预类型的子类型是逆变的,而读信道预类型的子类型是协变的.这是因为若某个变量为写信道预类型,则其信息是流入该信道;而若某个变量为读信道预类型,则其信息是从该信道流出.相对于信道来说,这两种流向是相反的.2.3类型如第2.1节所述,预类型不能直接作为类型.为了将之作为类型,必须依据BLP和Biba模型对其进行限制,下面给出类型的定义:TBASES{(SC,SL)}∈TYPE;TBASEH{(SC,SL,IC,IL)}∈TYPE;TRD{ch-〈A〉}∈TYPE;A∈TYPE在上面的类型定义中,最上面一行为类型的名称,如{(SC,SL)}∈TYPE的名称为TBASES.TBASES的含义是(SC,SL)为类型.TWR和TRD表明单个写或读信道预类型可作为类型.这些规则中值得注意的是TWRRD,TWRRD表明若A为B的子类型,则{ch+〈A〉,ch-〈B〉}为类型.若某个变量的类型为{ch+〈A〉,ch-〈B〉},则:(1)该变量的类型是信道类型,(2)A是B的子类型,(3)可向变量中写入类型为A的值,(4)可从该变量中读出类型为B的值.这意味着信道中子类型的信息能够流向其父类型,但父类型的信息不能流向子类型.同文献[9]相比,在类型定义中我们区分了机密性类型和完整性类型.TBASES,对于其它规则的考察是类似的.命题1.类型上的子关系为前序关系.证明.对TYPE的定义作归纳,这里只考察对于TBASES:(1)首先证明由TBASES而得到的类型关于是自反的.由于为基值机密性范畴上的包含关系,故SCSC;因为S为机密性级上的偏序关系,故SLSSL.由Sub-secr-base规则有(SC,SL)(SC,SL),因此依据TBASES而得到的类型关于是自反的.(2)其次证明由TBASES而得到的类型关于是传递的.假设(SC1,SL1)(SC2,SL2),(SC2,SL2)(SC3,SL3),由于这些关系只能采用Sub-secr-base规则而得到,因此有SC1SC2,SC2SC3,SL1SSL2,SL2SSL3.基值机密性范畴上的为包含关系,故有SC1SC3;而S为机密级别上的偏序关系,所以S为传递的,即SL1SSL3.由Sub-secr-base有(SC1,SL1)(SC3,SL3),即由规则TBASES而得到的类型关于是传递的.故由TBASES而得到的类型关于是前序的.后文我们用变量R,S,T表示类型.定义1(类型环境).若将给定变量x赋予一个类型T(简称为赋型),其形式记为x:T,则类型环境为赋型的有限集合.用Γ或Δ表示类型环境,类型环境的语法为在类型环境中,所有变量名均应不同.给定一个①此处解释未涉及类别,下面的解释类似.Page5类型环境,用函数方式表示变量的类型,如,若Γ={x:T1,y:T2},则Γ(x)=T1,Γ(y)=T2,即环境Γ中,x的类型为T1,y的类型为T2.3πHTS演算上节定义了移动系统所需的类型,为了有效地利用π演算来建模移动计算中的机密性和完整性,需要将其类型化,我们称类型化之后的安全π演算为πHTS.下面给出πHTS的语法和形式语义及其简单解释.除了类型化及类型转化算子之外,其语法和语义类似于标准π演算[9,13].3.1πHTS语法πHTS的语法定义如下:P,Q····=u,v····=bv|x,y,z|a,b,c其中,πP为前缀操作,其含义为先执行前缀π,而后执行P.前缀π有两类:输入u?(x:T)和输出u!v,其中,u?(x:T)表示接收源自于信道u上的值,并将其植入类型为T(其接收值的类型必须为T)的变量x中;u!v表示将值v发布到信道u上.(νa:T)P为限制操作,表示a的类型为T,其作用范围为P.P|Q表示P和Q并发运行.!P为复制操作,表示重复执行P.值包括三部分:名(a)、变量(x)和基值(bv),其中,名代表信道,变量表示可被任何项替换的形式参数.虽然标准π演算并未区分名和变量,但是区分名和变量可简化关系的处理[14].ifu=vthenPelseQ为匹配操作.下面详细讨论let算子,let(x:T)=(ST)(u→u)inPelseQ的含义为:若u的类型为S,且能够转化类型为T的值,转化之后的值用u表示,x的类型为T,则该算子将P中的x替换为u,否则保持Q不变.包含了两个算子:公开算子public和净化算子sanitized.公开用来建模对高机密级信息进程处理,使之能向低机密级信息流动.如移动支付系统中用户的密码属于高机密级,移动信道属于低机密级,依照BLP模型,密码不能在移动信道中传输.这种情况下可采用加密算法将密码进行加密,以此将高安全级别的密码转化为低安全级别的密文,进而可在移动信道上传输.这个例子中加密过程属于公开算子,可粗略地描述为(SpublicT)(u→u),其中,信息u的初始类型为S=(-,secrecy,-,-),经过加密之后转化为u,u的类型T=(-,public,-,-),即将秘密级类型转化为公开级类型.净化算子建模对低完整级信息进行处理,使之能向高完整级信息流动.如传感器网络中传感节点收集的信息为低完整级,中央决策器所接收的信息为高完整级,这样低完整级的信息传给中央决策器之前会经过准确性判定模块,这里准确性判定模块属于净化算子,整个过程可表示为(SsanitizedT)(u→u),其中,u的初始类型为S=(-,-,-,tainted)(即为低完整级),经过准确性判定模块处理之后转化为u,u的类型为T=(-,-,-,untainted)(即为高完整级).公开算子的操作规则为((SC1,SL,IC,IL)public(SC2,SL,IC,IL))(u→u)((SC,SL1,IC,IL)public(SC,SL2,IC,IL))(u→u).该规则表明公开算子针对的是机密标签或机密性范畴,并不涉及完整性.对于机密性标签来说,若基类型的公开操作能够成功,则转化前的机密级别不低于转化后的机密级别.类似地,净化算子的规则为((SC,SL,IC1,IL)sanitized(SC,SL,IC2,IL))(u→u)((SC,SL,IC,IL1)sanitized(SC,SL,IC,IL2))(u→u).3.2πHTS语义πHTS的操作语义如下:P≡PP|0≡P!P≡P|!PP|Q≡Q|P(P|Q)|R≡P|(Q|R)(νa1:T)(νa2:S)P≡(νa2:S)(νa1:T)PP≡QQ≡PP≡Q(νa:T)P≡(νa:T)Qafn(P)MATEifu=uthenPelseQ→PPage6MATNu≠vI/O(a!v)P|a(x:T)Q→P|Q{v/x}REPP→PRESP→P(νa:T)P→(νa:T)P≡P≡PP→QQ≡QLET1Γu:Tlet(x:T)=(ST)(u→u)inPelseQ→P{u/x}LET2let(x:T)=(ST)(u→u)inPelseQ→QπHTS操作语义类似于标准π演算的操作语义,不同之处在于类型化及类型转化算子(包括公开算子和净化算子),下面详细解释类型转化算子.Γu:T表示类型环境中项u的类型被动态地判定为T,Γ|≠u:T表示类型环境中项u的类型被判定为非T.这种判定结果是通过动态检测而得出来的(如类型化的代码分析[15]等),并不是通过类型的静态推理而得到.判定的正确性依赖于各种动态类型检测模块的可靠性.虽然相对来说设计动态类型检测模块比较难,但通过细致的设计是可以实现的,如加密算法提供了一个从高安全级向低安全级转化的手段.若动态类型检测模块是可靠的,则认为Γu:T蕴含了Γ|-u:T.后文假设动态类型检测模块是可靠的.LET1和LET2意味着:若动态地判定u的类型与变量x的类型一致,则用u替换P中的x;否则,则执行另外的分支Q.4πHTS的类型化规则及其性质Γ|-x:TT-nameΓ(a)T类型化规则分析类型环境下值的类型以及在什么情况下进程是良类型的.用Γ|-:T来表示类型化规则,其中,Γ为类型环境,为基值、变量或名,T为类型,Γ|-:T的含义是在Γ环境下,的类型为T.类型化规则如下所示:T-varΓ(x)TT-inte-basebv∈(IC,IL)T-secr-basebv∈(SC,SL)T-basebv∈(SC,SL,IC,IL)Γ|-bv:(SC,SL,IC,IL)T-parΓ|-PΓ|-QT-resΓ,a:T|-PΓ|-(νa:T)PT-eqΓ|-u:T,v:T,P,QΓ|-let(x:T)=(ST)(u→u)inPelseQT-rdΓ,x:T|-PΓ|-u:ch-〈T〉T-wrΓ|-v:TΓ|-u:ch+〈T〉Γ|-PT-LetΓ,x:T|-PΓ|-u:SΓ|-QT-stopΓ|-0T-inte-base、T-secr-base和T-base中,x∈T表示x是类型为T的变量.TLet意味着:若需要保障let(x:T)=(ST)(u→u)inPelseQ在Γ中是良类型的,则必须满足如下条件:(1)变量x的类型为T,且将其加入到环境Γ中使得P是良类型的;(2)在Γ下Q是良类型的,且u具有类型S.注意,这里要求在Γ下u具有类型S,而不要求u具有类型T.其它类型化规则的解释是直接的.类型系统中规则(特别是与子类型相关的规则)的细微变化都可能会对整个系统的性质产生重大影响[16],因此,需要证明相关性质.类型检测中一个重要的性质是主题规约(SubjectReduction)和主题全等(SubjectCongruence).主题规约的含义是:如果类型系统满足主题规约,则良类型进程每步演绎的结果仍是良类型的.体现在机密性和完整性问题上表现为:如果一个进程在初始状态既能保持机密性又能保持完整性,则经过每次操作之后仍然既能保持机密性又能保持完整性.主题全等的含义是:若类型系统满足主题全等,则与良类型进程全等的进程仍然是良类型的.体现在机密性和完整性问题上表现为:若一个进程既能保持机密性又能保持完整性,则与之全等的进程仍既能保持机密性又能保持完整性.在初始状态,机密性及完整性是由类型定义提供.这样,如果良类型进程满足主题规约和主题全等,则既能保持机密性又能保持完整性.一般来说类型系统中证明主题规约定理的过程是类似的[9,13,17].由于篇幅的限制,下面的归纳证明过程中只考察最复杂的部分,其它部分类似.命题2.若Γ|-v:T且TS,则Γ|-v:S.证明.对v的结构作归纳(只考察v为基值的情况).若v为基值,即为bv.由于v为基值,所以能采用的规则只有T-inte-base、T-secr-base和T-base.这3种情况下均有:若Γ|-bv:T(T为基型),则bv∈T.由于bv属于T类型,而T为S的子类型,由于子类型的传递性,故bv也属于S类型,即bv∈S.故Γ|-bv:S.Page7命题3.若Γ|-v:T且ΔΓ,则Δ|-v:T.证明.对v的结构作归纳(只考察v为变量的情况).若v为变量,因为Γ|-x:T,由于v为变量,故其只能由T-var规则派生,因此Γ(x)T.因ΔΓ,故Δ(x)Γ(x).由命题1知,是传递的,故Δ(x)T,由T-var有Δ|-x:T.命题4.若Γ|-P且ΔΓ,则Δ|-P.证明.对P的结构作归纳(只考察P为let的情况).令P为let(x:T)=(ST)(u→u)inP1elseQ1,且Γ|-P,由于这只能采用T-Let规则而得到,故有Γ|-u:S,Γ|-Q1和Γ,x:T|-P1.因为ΔΓ,由命题3有Δ|-u:S.由归纳有Δ|-Q1.另外,利用alpha等价总可能对Δ中的x进行替换,使之不在Δ中出现,这样Δ,x:T总是有定义.由于ΔΓ,故Δ,x:TΓ,x:T,由归纳有Δ,x:T|-P1;由T-Let规则有let(x:T)=(ST)(u→u)inP1elseQ1,即Δ|-P.命题5.若Γ,u:T|-v:S,且u≠v,则Γ|-v:S.证明.因为u≠v,而Γ,u:T|-v:S,因此必有Γ(v)S或v∈S(S为基型),这两种情况下均有Γ|-v:S.命题6.若Γ,u:T|-P,且u在P中不是自由的,则Γ|-P.对类型推理的长度作归纳,其证明过程类似于命题4.命题7.若Γ|-v:T且Γ,x:T|-u:S,则Γ|-u{v/x}:S.证明.对项u的结构作归纳(只考察u为变量的情况).若u为变量,此时有两种情况:(1)当u=x时,有TS,因此,Γ|-v:S,由u(v/x)=v,得Γ|-u{v/x}:S;(2)当u≠x,此时,u{v/x}=u.因为Γ,x:T|-u:S,而u≠x,根据命题5有u≠x,即Γ|-u{v/x}:S.命题8.若Γ|-v:T且Γ,x:T|-P,则Γ|-P{v/x}.证明.对P的结构作归纳(只考察P为let的情况).令P为let(y:R)=(SR)(u→u)inP1elseQ1,且Γ,x:T|-P,由于这只能采用T-Let规则而得到,故有Γ,x:T|-u:S,且Γ,x:T|-Q1和Γ,y:R,x:T|-P1.因为Γ|-v:T,由命题7有Γ|-u{v/x}:S.由归纳有Γ|-Q{v/x}和Γ,y:R|-P1{v/x}.由T-Let得Γ|-(let(y:R)=(SR)(u→u)inP1elseQ1){v/x},即Γ|-P{v/x}.定理1(SubjectCongruence).若Γ|-P,且P≡Q,则Γ|-Q.证明.对P≡Q的派生形式作归纳.这里只考察最复杂的afn(P)类似.若Γ|-(νa:T)(P|Q),此时只能由T-res派生而得到,故有Γ,a:T|-P|Q.对于Γ,a:T|-P|Q只能由T-par派生而得到,故Γ,a:T|-P和Γ,a:T|-Q.由于afn(P),由命题6可得Γ|-P.因为Γ,a:T|-Q,由T-res可得Γ|-(νa:T)Q.由T-par得Γ|-P|(νa:T)Q.定理2(SubjectReduction).若Γ|-P且P→Q,则Γ|-Q.证明.对进程规约过程作归纳(只考察I/O和LET).首先分析I/O,若Γ|-(a!v)P|a?(x:T)Q,此时只能采用规则T-par做派生而得到,故Γ|-a?(x:T)Q和Γ|-(a!v)P.这只能分别由T-wr和T-rd派生而得到,故有Γ|-a:ch-〈T〉,Γ,x:T|-Q和Γ|-a:ch+〈S〉,Γ|-v:S,且Γ|-P.由于a具有类型ch-〈T〉和ch+〈S〉,由类型的定义有ST,因此Γ|-v:T,由命题8得Γ|-Q{v/x}.由T-par得Γ|-P|Q{v/x}.下面分析LET1,假设Γ|-let(x:T)=(ST)(u→u)inPelseQ,由归纳有Γ,x:T|-P.由前提条件是Γu:T,故Γ|-u:T.由命题8有Γ|-P{u/x}.对于LET2,由TLet可以直接得到Γ|-Q.5应用举例为了清晰地分析如何用πHTS来保障移动计算中的机密性和完整性,且不降低可用性,但也由于篇幅的限制,我们给出一个简洁的例子:以第3节中的移动支付为例.依据BLP模型,移动支付中未加密的密码不能在移动信道上传输.用Owner表示移动支付终端拥有者,Bank表示银行服务器,pwd为密码.首先分析Owner通过移动信道使用明文进行支付,这个过程可用πHTS演算描述为Page8OwnerpCh!pwd0;Bank(νsCh:TsCh)pCh?(x:Tx)sCh(x)0;POwner|Bank.其中,pCh为移动信道,sCh为银行内部私有信道.进程Owner定义为在pCh信道上发布pwd之后终止;Bank定义为用类型为Tx的变量来接收信道pCh上的输入,并在sCh上输出(之后由银行内部对接收的信息进行处理,这里不讨论),而后终止.整个通信进程P为Owner与Bank的组合.下面讨论pwd和pCh的类型,由于卡持有者和银行需要知道密码,并且密码需要在网络上传输,因此,依据BLP模型的“需要知道”原则,pwd的机密性范畴应设置为Φ.同时,pwd应具有较高的安全级别(设其为secrecy)和完整级别(设其为untainted).这样,pwd的类型为(Φ,secrecy,{owner},untainted).一般来说,Owner向Bank传输信息的移动信道pCh具有如下特征:(1)能够传输任何信息,(2)是一个公开的信道,(3)网络上的数据容易被篡改,(4)能够接收和输出信息.因此该信道是低机密级、低完整级的信道,这样,pCh的类型为{ch+〈({network},public,Φ,tainted)〉,ch-〈({net-work},public,Φ,tainted)〉}.Bank进程中变量x用来接收从信道中传输的信息,由于其目标是接收pwd,因此,类型Tx({network},secrecy,Φ,tainted).类似地,sCh的类型TsChch+〈({bank,network},secrecy,{bank},untainted)〉.基于上述阐释,定义类型环境Γ{pwd:Tpwd,pCh:{ch+〈Tpub〉,ch-〈Tpub〉}},其中Tpwd(Φ,secrecy,{owner},untainted),Tpub({network},public,Φ,tainted).命题9.Γ中P不是良类型的.下面给出证明思路.用反证法进行证明,假设P是良类型的,则其前提条件是进程Owner和Bank在Γ中均是良类型的.实际上,进程Owner在Γ中不是良类型的.这是因为若Owner在Γ中是良类型的,这要求存在类型T使得Γ|-pwd:T和Γ|-pCh:Ch+〈T〉均成立,但由Γ及子类型关系的定义可知,不存在这样的类型T.因此Owner在Γ中不是良类型的,故在Γ中P不是良类型的.证毕.命题9表明,P中类型系统会阻止Owner直接向Bank传输明文pwd,这正符合安全要求:明文pwd不能直接移动信道上传输;也符合BLP模型的规则:高安全级信息不能向低安全级流动.为了保障安全移动支付,我们需要对高安全级明文pwd进行公开化处理,这个过程可用πHTS演算描述如下.Ownerlet(x:Tpub)BankpCh?(x:Tx)let(y:Tbank)POwner|Bank.其中,Tbank({network,bank},secrecy,{bank},untainted).命题10.P在Γ中是良类型的.下面给出证明思路,因为P为进程Owner和Bank的组合,因此,为了证明P是良类型的,需要证明Owner和Bank是良类型的.下面以Owner为例,为了证明Γ|-Owner,需要证明:(1)Γ,x:Tpub|-pCh!x0,(2)Γ|-pwd:Tpwd,(3)Γ|-0.其中,(2)和(3)分别由Γ及类型化规则中的终止规则可得.为了证明(1),需要证明Γ,x:Tpub|-pCh!x,这可由Γ,x:Tpub|-x:Tpub及Γ,x:Tpub|-pCh:ch+〈Tpub〉得到(因为pCh:{ch+〈Tpub〉,ch-〈Tpub〉},而{ch+〈Tpub〉,ch-〈Tpub〉}ch+〈Tpub〉,故有Γ,x:Tpub|-pCh:ch+〈Tpub〉).因此,Γ|-Owner:pwt,类似地有,Γ|-Bank.因此,Γ|-P,即P在类型环境Γ中是良类型的.命题10表明,P中类型系统不会阻止Owner在移动信道上传输公开化后的pwd.同进程Owner相比,进程Owner对pwd进行了类型转化:将pwd的机密类型转化为公开类型.实际应用中其安全性依赖于Γpwd:Tpub的正确性.若以加密算法来实施类型转换,则Owner的安全性依赖于加密算法的安全性.若加密算法是安全的,则Owner是安全的①.这正符合我们的需求:加密后的密码可在移动信道传输.6结论作为轻量级的形式化方法,类型检测具有清晰的模块接口,能够规范地设计一个大型系统,并可高效静态地推理程序的行为,在程序语言中得到了广泛的应用.本文利用π演算能够有效建模移动并发系统的特征,借鉴程序语言中不同类型变量之间的①这里的安全是指在网络上传输的密码不能被攻击者获得,Page9赋值方式,提出混杂类型检测安全π演算.πHTS利用静态类型检测保障低机密级信息只能向同等或更高机密级信息流动,及高完整级信息只能向同等或更低完整级信息流动.针对BLP模型和Biba模型在信息流向上的相反性,提出了动态检测框架.πHTS将静态检测和动态检测有机地整合在一起,弥补了独自采用BLP模型或Biba模型的不足,形成了一种统一的安全形式模型.它能同时保障移动计算中的机密性和完整性,且不降低可用性.虽然本文提出了机密性和完整性的安全模型,但安全并不一定“是”与“非”的问题,更重要的是评估安全的保障度,未来我们将在评估机密性和完整性的保障度方面展开工作.
