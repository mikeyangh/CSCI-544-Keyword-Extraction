Page1基于身份签名方案的安全性分析禹勇1)李继国2)伍玮3)黄欣沂3)1)(电子科技大学计算机科学与工程学院成都610054)2)(河海大学计算机与信息学院南京210098)3)(福建师范大学数学与计算机科学学院福州350007)摘要基于身份的数字签名是一种重要的密码学工具,不仅在基于身份密码体制中实现了签名功能,而且简化了传统数字签名中公钥证书的生成、管理和吊销等问题.Paterson和Schuldt首次构造了标准模型下可证明安全的基于身份的数字签名方案,但是该方案效率不高且通信代价昂贵.李继国和姜平进提出了一个新型的改进方案———标准模型下可证安全的基于身份的高效签名方案,新方案的特点是:标准模型下可证明安全、计算效率更高、通信代价更小.然而,文中发现,该方案并不满足不可伪造性,原因在于用户密钥提取是广义伪造的.进一步指出了原方案安全性证明中的缺陷:敌手的view与安全性模拟中成功的事件不独立.关键词数字签名;基于身份的签名;安全性分析;标准模型;信息安全;网络安全1引言Shamir[1]创新性地提出了基于身份的密码体制,用于解决传统基于公钥基础设施(PKI)密码体制带来的证书的生成、验证、存储和吊销等问题,在这种密码体制中,将标示用户身份的唯一信息如Email地址或IP地址作为用户的公钥,用户的私钥由可信第3方即私钥生成中心利用用户的身份信息和自己的主密钥计算得到,因此,基于身份的密码体制的主要优势是减轻了用户对公钥证书的依赖.同时,Shamir[1]构造了第一个基于身份的签名方案,其安全性依赖于大整数分解问题.2001年,Boneh和Franklin[2]利用双线性对构建了第一个安全实用的基于身份的加密方案,这一开创性工作得到了密码学界的广泛关注,利用双线性对构造基于身份的加密方案、签名方案和密钥协商协议等各种密码协议[3-14]已经成为信息安全研究中的热点之一.目前,大部分基于身份签名方案[3-4]的安全性是在随机预言机模型(RandomOracleModel)[6]下证明的,该模型是Bellare和Rogoway提出的用于安全性证明的一种理想模型,在这种模型的安全性证明中,Hash函数被看作是随机函数,其输出是随机值,对于敌手的每一次询问,挑战者给出一个随机应答.然而,对于一个具体的签名方案,由于其使用的Hash函数是具体的,故而询问的结果不是随机的,因此,虽然在该模型下可证明安全的方案有些很高效,但是不一定安全,Canetti和Goldreich等人[7]给出了反例:即使在随机预言机模型下可证明安全的密码学方案,在现实中根本不安全.因此,设计在标准模型(WithoutRandomOracleModel)下可证明安全的密码方案是非常有意义的研究工作.2006年,Paterson和Schuldt[12]突破传统的标准模型下安全的基于身份签名的构造方法,利用两层Waters签名[13],设计了一个新的标准模型下可证明安全的基于身份签名方案,记为PS方案,该方案具有短的签名长度、不可伪造性归约到计算性Diffie-Hellman(CDH)问题等优势,美中不足的是方案的计算量效率不高,需要多次群G中的乘法运算.针对这一问题,李继国和姜平进[14]在不改变PS攻击模型和困难问题假设的前提下,给出了一种更高效的实现,新方案的不可伪造性仍然可归约到计算性Diffie-Hellman问题假设,并给出了安全性证明.然而,本文发现,改进的方案无法达到数字签名的基本性质:不可伪造性,给出了具体的安全性分析并指出了安全性证明中的不完美之处.2李-姜方案及安全性分析为了便于分析,本节首先回顾李继国和姜平进提出的改进方案[14](简记为李-姜方案),并在基于身份签名的安全模型中给出安全性分析.2.1李-姜方案下算法构成:文献[14]提出的基于身份的高效签名方案由以(1)系统参数设置(Setup).令G、GT是p阶循环群,其中p为素数,g为G的生成元,e:G×G→GT表示双线性对.PKG随机选择g2∈G,α∈Zp,计算g1=gα∈G.随机选择u∈Zp,m∈G,nu维的向量犝=(ui),nm维的向量犕=(mi),其中ui∈Zp,mi∈G.Hu和Hm表示两个安全的Hash函数:Hu:{0,1}→{0,1}nu,Hm:{0,1}→{0,1}nm.令z1=e(g1,g2),z2=e(g,g2),则PKG的系统参数为{G,GT,p,g,g1,g2,u,犝,犕,m,z1,z2,Hu,Hm},主密钥为α.(2)用户密钥生成(Extract).用户身份u为长度为nu的比特串,U{1,2,…,nu}为u中比特值为1的位置的集合.PKG随机选择t∈Zp,计算用户的密钥:并通过安全信道把密钥传递给用户.若则PKG返回(1),重新选择α.(3)签名(Sign).用户得到密钥du后,先通过验证式对密钥进行检验:e(g,d0)=z1·du+∑i∈U等式成立,则用户确认密钥有效;之后可用该密钥对消息签名.令消息m为长度为nm的比特串,M{1,2,…,nm}为m中比特值为1的位置集合.随机选择s∈Zp,消息m的签名为σ=(w,x,y)=(d0·m∏j∈M(4)验证(Verify).验证人检验以下验证式是否成立:e(g,w)=z1·yu+∑i∈U等式成立,签名有效;否则,签名无效.2.2李-姜方案的安全性分析本节首先回顾基于身份签名的安全模型[12,14],Page3然后在该模型下分析李-姜方案的安全性.2.2.1基于身份签名的安全模型基于身份签名的不可伪造性模型通过挑战者(Challenger)和敌手(Adversary)之间的如下攻击游戏来定义.(1)系统参数设置(Setup).挑战者运行系统参数设置算法,得到系统参数和主密钥,秘密保存主密钥;敌手只得到系统参数.行一系列询问,包括:(2)询问(Queries).敌手向挑战者自适应地进①密钥提取询问.敌手能够对任何身份u进行密钥提取询问,挑战者执行密钥提取算法得到相应的私钥du,并将du发送给敌手.②签名询问.敌手能够询问任何身份u对任意消息m的签名.挑战者首先运行密钥提取算法获得身份u的私钥du,然后利用私钥运行签名算法获得对消息m的签名σ,并将该签名发送给敌手.(3)伪造(Forgery).最后,敌手输出身份u对消息m的签名σ,若以下条件成立,则攻击成功:①敌手未对身份u进行密钥提取询问.②敌手未对(u,m)进行签名询问.③σ是u对m的有效的签名.定义1.如果敌手最多进行qE次密钥提取询问和qS次签名询问,至少在时间t内以不小于ε的概率赢得上述游戏,则称是基于身份签名的(ε,t,qE,qS)-伪造者;如果在基于身份签名方案中不存在(ε,t,qE,qS)-伪造者,则称方案是(ε,t,qE,qS)-安全的.2.2.2具体的攻击方法本节给出一种具体的攻击方法,指出文献[14]不满足不可伪造性,即存在敌手能够在多项式时间内以不可忽略的优势赢得基于身份签名的不可伪造性攻击游戏.(1)系统参数设置(Setup).挑战者运行系统参数设置算法,得到系统参数和主密钥,秘密保存主密钥;敌手得到系统参数:{G,GT,p,g,g1,g2,u,犝,犕,m,z1,z2,Hu,Hm}.(2)询问(Queries).在这一阶段,敌手不进行任何询问.(3)伪造(Forgery).设目标用户的身份为u,U{1,2,…,nu}为u中比特值为1的位置集合,敌手通过以下步骤输出目标消息m的有效签名伪造σ,M{1,2,…,nm}记为m中值为1的位置集合.①随机选择d0∈G.②利用扩展的欧几里得算法,计算t=u+∑i∈Uu()i③计算d1=e(g,d0)④随机选择s∈Zp,输出:σ=(w,x,y)=d0·m∏j∈Mm()j作为签名人u对消息m的基于身份签名.的基于身份签名,因为:容易验证,σ=(w,x,y)是u对m的有效(1)du=(d0,d1)是用户u的有效的密钥,正确性分析如下:z1·(d1)u+∑i∈U=z1·e(g,d0)=z1·e(g,d0)=e(g,d0).(2)σ=(w,x,y)是用户u对消息m的有效的基于身份签名,正确性分析如下:e(g,w)=eg,d0·m∏j∈Mm()j基于Waters[13]和Paterson等人[12]的证明技巧,文献[14]对改进方案给出了详尽的安全性证明,然而,其证明中的不完美之处导致上述攻击的存在.具体地,在系统参数设置算法中,模拟者令lu=2(qE+qS),随机选择ku∈Zlu,对于给定的qE,qS,nu,nm,假定lu(nu+1)<p.随机选择x∈Zlu,nu维向量犡=(xi),其中xi∈Zlu.定义F(u)=x+∑i∈Uluku.在模拟者构造的系统参数中,u=-luku+x,ui=xi,1inu,则可得到F(u)=u+∑i∈Uu,ui都是系统参数的一部分,所以任何人都可以计算F(u).完整的安全性证明见文献[14].最终,模拟者能成功解决CDH问题的条件是,在密钥提取询问、签名询问和签名伪造3个阶段,模Page4拟者均不能终止,即(1)密钥提取询问时,F(ui)≠0modlu.(2)签名询问时,K(mi)≠0modlm.(3)签名伪造时,F(u)=0modp,且K(m)=0modp.由于敌手的view(模拟过程中敌手获得的知识)与安全性模拟中成功的事件不独立,故当敌手需要输出身份u对消息m的基于身份的签名伪造σ时,敌手自己可以检验F(u)=0modp是否成立,如果等式不成立,敌手将σ返回给模拟者;否则,敌手不返回σ.因此,敌手总能使安全性模拟中的事件(3)中的F(u)=0modp不成立,即挑战者解决CDH问题的概率是可忽略的,故而,签名方案的安全性无法归约到CDH假设.3结束语文献[14]利用Waters方法[13],基于PS签名方案[12],提出了一种在标准模型下可证明安全的高效签名算法,新算法与PS方案具有相同的安全性,且具有更高的验证效率,可视为对PS方案的一种改进.然而,本文在基于身份签名的安全模型下对新方案进行了分析,发现新方案并不满足数字签名应该具有的最重要性质,即不可伪造性,给出了具体的伪造攻击方法,并指出了原文安全性证明中的不合理之处.如何构造一个在标准模型下可证明安全、计算效率高且系统参数短的基于身份签名方案仍然是密码学里的一个公开问题.
