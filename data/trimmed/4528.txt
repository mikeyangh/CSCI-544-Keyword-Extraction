Page1网络分析中求最大流的商空间方法(安徽大学计算智能与信号处理教育部重点实验室合肥230039)(安徽大学计算机科学与技术学院合肥230039)摘要该文研究利用商空间的保真、保假原理给出分析网络的新方法,并以求网络中两点的最大流量为例进行说明,主要工作包括:(1)给出利用保真、保假原理求解问题的基本原则;(2)给出将所研究的问题(求最大流问题)化成“问题求解”形式的方法;(3)利用商空间理论建立对应问题求解的保真、保假原理,并证明对所研究的问题,保真、保假原理均成立;(4)根据保真、保假原理给出求两点最大流量的方法.新方法对求所有的点对点的最大流的计算量由原来需要求n(n-1)/2次点对点的最大流,变成只要求(n-1)次点对点的最大流,显著降低了计算的复杂性.关键词粒计算;商空间;保真原理;商逼近原理;最大流1引言粒计算是人工智能研究的热点方向之一,目前Page2“结构”是对象论域的一个非常重要的特征描述,如给定一个仪表,若只给出仪表中各元件的参数,而不知道各元件之间是如何连接的,则对该仪表基本是一无所知.又如对一张图像,若只知道各像素点的三色的参数,而不知各个像素之间的相对位置,则对这张图像也是一无所知.总之,结构是事物的主要信息之一,只有给出论域中各元素的属性以及各元素之间的相互关系(结构)才能全面地反映对象的本质.商空间理论正是利用结构这个特点,建立了不同粒度空间之间的保真、保假原理,为问题求解和推理提供一个全新的方法.文献[15-17]中给出利用商空间方法求两点之间最短程的新算法.本文利用商结构及保真、保假原理来求解复杂网络中最大流量的问题.网络最大流问题是网络分析中最主要的问题之一[18-19],最大流问题算法的研究已有40多年的历史,最早的算法是Dantzig单纯形法,1956年Ford和Fulkerson[21]的增载轨算法.20世纪70年代Dinic[22]和Edmonds和Karp得出多项式时间算法.1973年,Dinic[24]首次获得了时间复杂度的核心因子为nm的算法.其中n是网络节点个数,m是网络边的个数.以后的几十年中,最大流算法获得了很大的进展,但nm的核心因子始终没有被突破.关于求最大流算法的历史发展情况,张宪超[25]给出全面的叙述,有兴趣的读者可阅读此文.本文的目的不是研究如何提高求点-点对应的最大流的算法效率,而是研究如何利用商空间理论提高求解所有点对最大流的效率的方法.2问题求解的商空间模型人类可以从不同粒度、不同层次来观察问题.所谓粒度,就是由一些元素组成的集合,将这个集合看成是一个新元素.故粒度与数学中的商集概念是一致,于是我们就用商集作为建立不同粒度世界模型的数学工具.2.1不同粒度世界的描述我们以三元组(X,f,T)描述一个问题,其中X是论域,f(·)表示论域上(元素)的属性,f:X→Y,Y可以是n维空间,也可以是一般的集合,T是论域的结构,它表示论域中各元素之间的关系.求解问题(X,f,T)就是对论域X及其相关的结构、属性进行分析、研究.当X很复杂时,人们常从比较“粗”的粒度来考察问题,用数学的术语就是:给出X的一个等价关系R,得到商集[X],然后对[X]进行研究.即研究对应的问题([X],[f],[T]),以及研究([X],[f],[T])与(X,f,T)的关系.当我们从不同的角度(粒度)考察同一问题,得出几个不同的粒度上的结果,如([X]1,[f]1,[T]1),([X]2,[f]2,[T]2),….问如何对所得的结果进行综合,给出对问题的新的结论?即在不同粒度世界上如何进行推理.为此我们建立了问题求解的保真、保假原理.2.2保真保假原理命题1.设([X],[T])是(X,T)的商空间,p是(X,T)→([X],[T])的自然投影,若AX,且A是X中的连通集,则p(A)是[X]中的连通集.注:如果在(X,T)上,给定一个前提A(X中的一个子集)和目标B,若从A推导出B的充分必要的条件是:A与B落在同一连通集中.于是,由命题1,直接得出问题求解的“保假原理”.保假原理:若问题在商空间([X],[T])上无解.则在原空间(X,T)上对应的问题一定也无解.“保假原理”人们在日常生活中是经常用到的,人们常在较粗的层次上考察一个问题,先将在这种层次上不可能有解的部分删去,而对可能有解的部分进一步进行求解.如刑侦人员对案件进行排查,就是利用保假原理进行粗粒度的排除.这里我们把它抽象归纳成一般原理.利用下面的命题,可给出“保真原理”.命题2.设(X,T)的商空间(X1,T1),若对a∈X1,有p-1(a)是X中的连通集(即将X1的元素看成是X上的子集是连通集),且X1连通,则X连通.保真原理:若命题在商空间X1上有解,且X1的每个元素是X中的连通集,则对应的命题在X中也有解.与保假原理相结合,得出原来要研究空间X上的命题成立与否,等价于研究商空间X1上的对应的命题成立与否.而X1的规模比X小,这就使问题大为简化.这个原理在日常生活中经常被应用.这个原理说明,若在细粒度上“局部有解”(指p-1(a)连通)且在粗粒度上全局有解(指X1连通),则在细粒度上全局有解.以上的保真、保假原理是建立在结构的连通性上,本文将这个概念推广,建立不同类型的保真、保假原理.我们曾将商空间方法应用于时间规划[26-27]获得新的求解方法———矩阵法.以及应用路径规划的Page3研究,得出路径规划的新方法[28]———拓扑方法成为当时两大方法之一以及将商空间方法应用于研究第二代小波分析[29]等.这些说明商空间方法是极富生命力的方法.3复杂网络分析中的保真、保假原理对复杂对象的分析,商空间方法常常是非常有效的,下面以求复杂网络中的两点之间的最大流量问题为例,来说明如何利用商空间方法求解问题.3.1求两点之间的最大流问题求最大流问题是研究网络流的一个非常重要的课题,早在20世纪50年代就有了结论,如Ford-Fulkerson[18]的最大流与最小割定理:两点间的最大流等于分离该两点的最小割,以此给出求最大流算法等.本文是从商结构的观点来分析求最大流问题,主要要建立网络与商网络之间求最大流问题的保真和保假原理,然后将在复杂网络上求最大流的问题化成它的某个商网络上求最大流问题.下面先介绍几个概念.定义1.给定网络N(V,E,D(E)),其中D(E)={d(e)|e∈E}是边上的容量的集合,再设R是V上的一个等价关系,得对应的商集[V],现定义[v],[u]∈[V],([v],[u])∈[E]v∈[v],u∈[u],(v,u)∈E,令d([v],[u])=∑v∈[v],u∈[u][E],D([E])),称之为N对应于R的商网络,或简称为商网络.定义2.设f(e)是定义在E上的函数,记f(e)=f(vi,vj),若满足以下条件:(1)e=(vi,vj),0f(e)d(vi,vj).(2)vi∈V/{vs,vt},∑(vivi)=0.其中:vs是源点,vt是汇点,vi,vj是其他节点.称f是N的一个可行流,其流量定义为∑(vs∑(f(vj,vt).vj,vt)∈E最大流问题:给定网络N(V,E,D(E))和v,u∈V,求从v到u的最大流f(v,u).有关可行流、最大流等的定义可参考文献[18].3.2求最大流的保真保假原理命题3(保假原理).设N([V],[E],D([E]))(简记为[N])是N(V,E,D(E))的商网络,则任给v,u,f(v,u)f([v],[u]),v∈[v],u∈[u],[v]≠[u],其中f(v,u),f([v],[u])分别表示点v与u,点[v]与[u]之间的最大流(即若[v],[u]之间不存在大于l的最大流,则v,u之间也不存在大于l的最大流).证明.由两点之间的最大流等于这两点之间的最小割,而[N]中关于[v],[u]的割必是N中关于v,u之间的割,故得f(v,u)f([v],[u]).证毕.这个命题对V上的任一等价关系R均成立.在实际生活中,我们也经常用到保假原理,如对一个仪器进行检查,若发现这个仪器的两大部件之间关系发生问题,则显然这个仪器有故障.这就是保假原理的应用.但保真原理就不这么容易建立,下面举一个例子说明之.例1.令图1中各边的流量均为1,f(v,u)为v,u之间的最大流.取v=2,u=6,则f(v,u)=2,若取a={1,2},b=6,则[f](a,b)=3.在图2商网络上a,b之间存在大于2的最大流,但在原网络中1,2之间不存在大于2的最大流.即保真原理不成立.虽然上面给出保真原理不成立的例子,研究证明,只要精心选取网络的粒度(即商网络),可以使保真原理也成立.下面我们利用Romory和Hu[19]的一个结果(引理1),来建立对应于求最大流的保真原理.定义3.设V1,V2是网络N的割,其量记为c(V1,V2),若v∈V1,u∈V2,f(v,u)=c(V1,V2),则称V1,V2是v,u最大流量对应的最小割.称V1(V2)Page4为v,u对应的最小割集.命题4(保真原理).设A,B是N的关于节点对a,b的最小割,现作等价关系R:v,u∈B,v~u,v∈A,v~v(即将B压缩成一点,A中的点不变,而得到的商空间).令R对应的商网络记为N1,则a,c∈A,f(a,c)=[f](a,c),其中[f]表示N1中最大流量函数.命题4给出在商网络N1上的保真原理.证明.任取a,c∈A,设其对应的最小割为(A1∪B1,A2∪B2),为书写方便对这四部分之间的连接用简图表示如图3所示,其中A=A1∪A2,B=B1∪B2,a∈A1,c∈A2,ei表对应边上的通过能力.最小割c(A,B)=c5+c2+c3+c6,c(A1∪B1,A2∪B2)=c1+c2+c3+c4.作割c(B2,A∪B1)=c2+c4+c6c(A,B)=c5+c2+c3+c6得作割c(A1,A2∪B)=c1+c2+c5c(A1∪B1,A2∪B2)=c1+c2+c3+c4得由式(1)、(2)得c4c3+c5c4+2c3由式(3)得得c(A1,A2∪B)=c1+c2+c5=c1+c2+c3+c4最后得证明的关键在于,利用(A,B)和(A1∪B1,A2∪B2)是最小割的条件得出不等式(1)、(2),再由此推得c3=0,c4=c5,即得命题的结论.4复杂网络分析中的商逼近原理上一节我们分析了商空间理论中的保真、保假原理,并针对网络中求最大流问题建立了对应的保真、保假原理,可是已建立的保真原理对求单个最大流问题没有多大帮助,若我们要求网络中n个节点的所有C2保真原理将发挥很大的作用.本节讨论如何用商逼近原理来求所有点对之间的最大流问题.4.1最小割树与商空间逼近原理商逼近原理:设X1<X2<…<Xn=X是X的一个商空间链,若在(X,T)中求问题P的解,能化成求商空间(Xi,Ti)(其中Ti是对应于Xi的商拓扑)上的对应问题Pi的解,且在某种意义下有Pi→P成立.我们将商空间逼近方法应用于对第二代小波,得出:小波就是商逼近中相邻商空间逼近之间差异的描述[29].为了利用商逼近原理进行求解网络上所有C2个点对之间的最大流问题,我们首先要建立对应的商空间(网络)链.为此先建立下面的概念.定义4.设树T满足:(1)其顶点集是网络N的顶点集的商集;(2)在T中任删去一条边将T划分成两个连通部分T1,T2,其对应的顶点V(T1),V(T2)构成N的一个最小割,则称T是N的一个最小割树.命题5.设Tk-1是网络N的一个最小割树,其节点为{V1,…,Vk},任取Vi,|Vi|>1,取v1,v2∈Vi,作等价关系:v,u∈Vj,j≠i,v~u,v∈Vi,v~v,取边权:d(Vj,v)=∑u∈V其余的边权不变,得商网络N1,求v1,v2在N1中的最小割(V,V),设在树中与Vi相连的边有l1,…,lj,若将边ls删去,得到不含Vi的子树为Ts,1sj,则Ts必整个含在V或V中.证明.在N1求v1,v2最小割得(V,V),设Vj∈Ts,由命题4得Vj必包含在V或V之中,设属于V,由于Ts是连通的,得TsV.命题6.设最小割树Tk-1,其顶点集为(Vk-1k),不妨设|Vk-1k相连的边有l1,…,lj,若将边li删去,得到不k的子树为Tk-1Vk-1与Vk-1含Vk-1节点集为{V(T1),…,V(Tj),v∈Vk-1N1的最小割(V,V),v1∈V,v2∈V,现将树Tk-1顶点Vk-1(Vkk+1),其权d(Vk凡属于V的子树Tk-1于V的子树Tk-1Tk,则Tk也是一个最小割树,其顶点比Tk-1多一个.k,Vk证明.因为Tk只比Tk-1多一条边(Vk而这条边对应于最小割(V,V),故得Tk是最小割树.Page54.2求最小割树的算法命题6给出了求最小割树的具体步骤.算法1.求最小割树.给定最小割树Ti,i<n,其顶点集合为:{Vii+1},不妨设|ViVil1,…,lj,将边ls删去,得到不含Vi作等价关系R,其节点集为{V(T1),…,V(Tj),v∈Vk-1R对应的商网络为Ni,在Ni中取v,u∈Vi的最小割,得(V,V),v∈V,u∈V,作树Ti+1,顶点集={Vi+1Ti边(Vi+1i+1,Vi+1命题7.在最小割树Tn-1上,v,u,w∈V,则1,…,Vi+1j与Vi+1i+1相连,若Tif(v,u)min{f(v,w),f(w,u)}.证明.设v,u的最小割为{V1,V2},若w∈V1,得f(w,u)f(v,u),若w∈V2,得f(w,v)f(v,u),最后得f(v,u)min{f(v,w),f(w,u)}.定理1.设一个最小割树Ti,则(1)Ti中任一条边,对应于N上的一个最小割;(2)e=(vif(vj,vk)=d(e),其中[f],f分别是Ti,N中的最大流函数;(3)设l=(vi[f](vi[f](vik,vi证明.(1)现设Ti是最小割树,其边对应于N的最小割,用归纳法证,因Ti+1与Ti只多一条边(Vi+1i+1,Vi+1(2)由(1)直接得.(3)设l=(vij,Vi边(Vi另一方面,由于(vi最后,得f(vi若一个最小割树的长度为n-1,于是求N中任意两点之间的最大流,都可以在这个最小割树上进行,这样就大大降低计算的复杂性.即通过n-1次的求最大流计算就可得出对整个网络的n(n-1)/2个点对之间的最大流,而且每次只要在一个商网络上求对应的最大流(商网络的节点个数比原网络少,这也降低一部分的计算量).下面举一例说明.例2.求图4网络中所有点对之间的最大流.解.在图4中,网络N0中求A,G最小割得V1={A,B,C,D,E},V2={F,G},d(v1,v2)=f(A,G)=16,得如图5所示的最小割树T1.作商网络N1(如图6所示),在N1中求A,E的最小割得d(V,V)=f(A,E)=15,V3={e}.得到如图7所示的最小割树T2.作如图8所示的商网络N2,在N2中求A,D的Page6最小割得V={A,B,C,V2},V={D},d(V,V)=f(A,D)=10得如图9所示的最小割树T3.作如图10所示的商网络N3,在N3中求A,B的最小割得得如图11所示的最小割树T4.作如图12的所示商网络N4,在N4中求A,C的最小割得f(A,C)=f(V1,V6)=11,得如图13所示的最小割树T5.最后作如图14所示的商网络N5(其中V={A,B,C,D,E}),在N5上求F,G的最小割:最后得如图15所示的最小割树T6.从最小割树T6中,我们可以求出任两点之间的最大流,如求G,E之间的最大流得f(G,E)=min{f(G,A),f(A,E)}求F,C之间的最大流f(F,C)=min{f(F,G),f(G,A),f(A,C)}所得到的最小割树,一般不是唯一的,其结构与构造过程中所取的求最小割的的点对的顺序有关.其次,从图15最小割树,很容易看出例子中的网络,D点通过能力最弱,其次是C.该方法将求所有点对的最大流由求C21)/2次点对最大流减少到求(n-1)次点对最大流.5结论利用商空间方法求解具体问题时,要针对具体Page7问题建立对应的保真、保假原理,然后进行求解.本文证明了对在网络上求解最大流问题,可取适当的商空间,证明求最大流的问题在该商空间上保真原理成立,然后利用商逼近原理来求解最大流问题,求出网络对应的最小割树,在最小割树上可以求出任何一个点对之间的最大流,这样利用商空间技术就可大大降低求解的复杂性.但本工作还存在不足之处,就是用求(点-点)最大流方法来求(整体)最大流.今后应进一步研究划分满足何种条件(最好是充分、必要条件)后,其对应的商空间能保证求最大流保真原理成立.加深商空间方法对网络分析中的应用.致谢审稿专家提出了宝贵意见,这些评审意见对完善论文有很大帮助,在此表示感谢!
