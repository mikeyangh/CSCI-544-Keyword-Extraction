Page1基于图元旋转不变性和相位统计信息的LBP算法在纹理分类中的研究韩延彬尹建芹李金屏(济南大学信息科学与工程学院模式识别与智能系统研究所济南250022)(山东省网络环境智能计算技术重点实验室济南250022)摘要传统的LBP算法缺少对图元的相位分析,因此不能较好地区分由图元旋转形成的同类纹理图像.文中提出了一种融合图元旋转不变性和相位统计信息的纹理分析算法.新算法利用图元旋转不变性的等价类约简纹理特征,减小纹理旋转带来的分类误差,然后利用图元的统计相位特征进一步划分纹理图像分类集,进而解决由旋转不变性带来的欠分类问题.该算法选用均值漂移作为纹理分类工具,并采用Brodatz纹理库作测试.与传统的WTGGD、LBP等算法相比,分类效果有显著的改善.关键词纹理分类;局部二值模式;旋转不变性;相位信息;均值漂移1引言随着图像处理和机器视觉等研究领域的飞速发展,图像理解日益成为人们关注的热点.作为图像基本视觉特征之一的纹理是当前研究的一个重要领域,引起了诸多学者广泛的研究.目前纹理分析的研究已经涉及到图像处理的许多领域,如遥感图像分析、图像检索、目标检测、水泥微观形貌分析等.一般来讲,纹理主要是指真实物体的图像中某些区域中某种结构或者模式的重复,即纹理图像是由许多相同和相似的元素组成,这些元素称之为图元.因此纹理图像分析就是寻找一种合适的方法提取图元或者图元构成区域的特征.目前纹理分析可以概括为3类:统计分析方法、结构分析方法和基于模型的方法.早在20世纪70年代,Tamura等提出的粗糙度、对比度、方向性、类线性、规整度和粗略度等6个纹理特征[1],现已成为人们研究纹理图像的参照.20世纪90年代,随着小波理论的日臻完善,不少围绕小波变换的纹理分析技术见诸报道[2].目前常见的纹理分析方法还有马尔可夫随机模型[3]、局部二值模式(LocalBinaryPattern,LBP)[4]等方法.传统LBP算法的窗口大小固定,且与图像内容无关,使得LBP在纹理图元特征的提取上出现误差,难以适应不同粗糙度和尺度纹理的要求.针对这些问题,许多学者纷纷提出了自己的改进算法.文献[5]提出了混合高斯模型的LBP算法,有效地解决了孔洞问题;文献[6]提出了一种自适应的LBP算法可以自动调节滑动窗口,提高了LBP算法的适应度.在众多的改进LBP算法中,很少讨论关于图元的走向、旋转和纹理之间的关系.虽然文献[7]讨论了一种LBP算子的扩展“均匀模式”,可以有效地描述出图像的大部分纹理特征,并明显减少特征的数量(占LBP特征总量的23%),但是对纹理的旋转并没有很好的效果.因此,在传统的LBP算法基础上,本文通过加入图元旋转不变性对应的“旋转等价类”概念,扩展了LBP算法的旋转不变性,进而引入图元“相位”特征保证了纹理分析的准确性.在不特加说明的情况下,本文所指的LBP窗口为3×3.该方法首先利用置换群(PermutationGroup,PG)的原理,将经过旋转之后重合的图元归为一类,这样使得原来LBP所提取的256个图元大幅度约简为36个(占传统LBP特征总量的14%).该算法保留了原来LBP算法的优点,完善了LBP算法的旋转不变性,即为PG-LBP.需要指出,由于这种纹理特征提取方法过分强调了纹理的旋转不变性,忽略了纹理的方向性,因此本文算法特别保留了图元相位信息,通过相位统计分布的匹配,对纹理分类作进一步划分.换言之,利用PG-LBP特征进行粗分类,相位信息进行细分类.本文采用的粗分类工具为均值漂移,且实验表明了这种粗细结合的方式可以有效提高纹理图像的搜索效率,验证了算法的有效性.2图元的旋转不变性图元作为纹理的基本单位是纹理分析和描述的基础.因此,图元的提取和分析至关重要,涉及到边缘检测、图像平滑、图像分割等许多技术.本文提取图元信息方法的基础是Ojala在文献[8]中提出用LBP描述纹理,优点是纹理识别能力强、计算复杂度小,缺点是针对纹理的旋转无能为力,这是由LBP算法的顺序编码方式引起的.本文引入置换群,将图元进行旋转等价类划分,进一步约简图元信息,完善LBP处理旋转不变性的能力,并保留相位信息,使得纹理的精确匹配成为可能.2.1基于LBP的纹理特征提取和分析LBP算法的基本流程是:首先选取3×3窗口提取图元信息;然后用中心子块作为阈值对周围8个邻近子块进行二值处理,其中小于阈值的子块为0,反之为1,进而获得一个二进制数串,如下所示:其中,Bi为二进制串上第i个数位的取值,Li为3×3窗口中像素的灰度值(中间像素除外),Mi为中间像素的灰度值,i取值为1~8.最后将该二进制数串转换为十进制数值,作为纹理单元的LBP值,如图1所示.由于LBP值主要参考了周围子块相对中心子块的梯度,因此充分描述了纹理空间特征,也即保留了纹理的形状和走向.Page3显然,传统的LBP算法对于如图2的情况是无能为力的.分析图2,可以看出之所以提取的图2(a)和图2(b)纹理特征有较大的差异,主要原因是在图像图3旋转图元分析示意图显然,旋转之后原始的纹理向量犘1,犘2,犘3的相位和模都发生了变化,因而其LBP特征值也是不同的.虽然实际上由图3(b)和图3(d)所描述的图元图4图2的LBP直方图在图4(a)和(b)中,横坐标为LBP值,其范围为0~255,纵坐标为对应LBP统计值占总像素值的比率.如果把图4(a)和图4(b)所示的特征统计值看作是两个特征向量,分别记作犘犪和犘犫,则其相似度可由式(2)获得.旋转的过程中,构成纹理图像的图元发生了旋转(我们称之为图元相位发生了变化),而传统的LBP算法其特征提取的方式不能从根本上解决这个问题.也就是说当图1(a)的窗口数据旋转时,其对应的LBP值将发生变化,这是问题的根本所在.其变换分析图如图3所示.图3(a)是原始图像LBP特征的提取过程,其LBP值是146,图3(b)是图3(a)的纹理结构示意图(即图元),方向箭头为纹理走向,也就是数据为1的方格.图3(c)为图像3(a)旋转90°后的图像LBP特征提取示意图,其LBP值是37,图3(d)是图3(c)的纹理结构示意图.组成的纹理图像应该是同一类图像(图2),但是传统的LBP算法无法解决这个问题.从两幅图像的LBP直方图也可以看出这个问题,如图4所示.从式(2)中可以看出,如果两个向量越相近或相似的话,其匹配度越接近1,否则趋于0.按照式(2)的匹配准则,两幅纹理图的相似度为0.391826,差别很大.因此需要修正图像特征的提取并完善纹理旋转的不变性.Page42.2图元的旋转不变性为了解决图元旋转而导致的LBP值的变化,需要利用图元的旋转不变性和等价类概念.定义1.一个图元经过一定角度的旋转后获得的新图元称为旋转不变的,即新图元与原始图元是旋转等价的.定理1.设A为所有图元结构组成的集合,R为定义在集合A上的旋转关系,在旋转不变性的前提下,R是一个等价关系.证明.(1)自反性.设任意图元a∈A,a与自身显然相同,所以a(a∈A→aRa)成立.(2)对称性.设图元a,b∈A,如果a旋转一定角度到达b,则b经过同样角度反向旋转后也可以到达a,所以a,b(a,b∈A∧aRb→bRa)成立.(3)传递性.设图元a,b,c∈A,如果a经过旋转角度θ1到达b,而b经过旋转角度θ2到达c,则a经过旋转角度θ1+θ2也可以到达c,所以a,b,c(a,b,c∈A∧aRb∧bRc→aRc)成立.因此R是一个等价关系.定义2.旋转等价类.因为R为集合A上的旋转等价关系,对任意图元a∈A的集合[a]R={x|x∈A,aRx}称为图元a形成的旋转等价类.于是,通过旋转等价关系可以将原来的图元集合进行等价划分,使得图3(b)和图3(d)的图元划归为同一类图元,从而解决LBP算法的旋转问题.关于等价类的划分,可以采用置换群的思想进行计算.关于等价类的详细信息可以参见文献[9].2.3基于置换群的图元信息约简1831年伽罗瓦在其论文中首先定义了“置换群”的概念.顾名思义就是定义在一个集合上的一组置换集合,该集合满足群的定义,因此定义在某一集合上的置换群可以按照置换的性质将集合元素划分为若干子集,同类元素经过置换后仍然属于同一集合.结合等价类的概念,给出如下的定义.定义3.如果P={P1,P2,P3,…,Pn}是定义在集合A={a1,a2,a3,…,ak}上的一个旋转置换群,其中A为所有图元的集合,旋转置换群P可以将图元集合A中的图元元素分为A1,A2,…,Am,那么如果aki∈Ak,则aki·P∈Ak.也即属于某一集合的图元元素,无论经过怎样的旋转仍属于同一集合.传统的LBP算法中,如果其特征提取窗口为(8,1)(如图1(a)所示),则图1(c)表述的二进制串共有28=256种,其LBP值为0~255.这256种图元分别代表了不同结构、相位和模(结构矢量的模)的纹理结构;相同图元结构但不同相位的图元,此时视为两种纹理结构(见图3).引入图元“旋转等价类”之后,则类似于图3(b)和图3(d)的图元结构称为一类(两个图元的相位相差45°),其LBP值也一致.将传统的256种LBP图元进行归类约简,把旋转之后重合的图元设为一类.图5为某一图元归类示意图,第1行为图元结构图,第2行为LBP值,第3行为相位.之所以保留了图元的相位信息,主要是等价类过度约简了纹理特征,仅仅保留了结构特征,因此其分类是相当粗糙的.可见,构造的旋转置换群应包括:旋转0°、±45°、±90°、±135°、180°等8种形式.通过这种置换可以将原来的256种图元约简为36种(详见计算过程),约简率高达86%.如图5中LBP值为1,2,4,8,16,32,64,128可以视为同一图元.大量实验证明,这种约简能够高效保留原有纹理信息.由于图元的相位直方图表明了图元旋转信息,因此传统的LBP图元信息变为约简图元和相位两种信息.图2利用PG-LBP特征提取之后的LBP直方图如图6所示.根据式(2)可得两者的相似度为0.95238.可见约简后图元特征针对旋转非常有效.利用置换群进行旋转等价类的计算过程如下(R为旋转置换):1.初始化图元集合A;k=1;2.如果集合A为空则停止运算,否则转向步3;3.任意元素a∈Ak,Ak=Ak+{a};A=A-{a};4.B=A,任意的元素b∈B,满足aRb则B=B-{b},5.如果B为空,则k++,返回步2;否则返回步4.A=A-{b};否则B=B-{b};2.4图元相位信息利用旋转等价类获取的纹理特征仅仅评判了两幅图像中的图元结构是否相同,约简掉因图元方向分布不同而造成的纹理差异.事实上,纹理图像的特Page5图6基于PG-LBP值的直方图计算过程:征不仅体现在图元的结构信息,而且还有图元的方向(相位)信息.因此本算法在后期处理的过程中,将充分利用图元的相位信息.相位信息定义如下.定义4.图元序列号.图元结构在图元等价类集合中的编号,其值为图元结构的LBP值,其范围为[0~35].定义5.图元相位.设某一图元旋转等价类最低序号的相位为0,称为图元基,其它图元的相位值为本图元经过旋转达到图元基的角度.定义6.纹理相位特征.纹理图像中统计量最大的图元等价类(除去第0和35类)中图元的相位统计直方图.定义6所阐述的含义是纹理的相位特征可用纹理中占最多数的图元的相位特征来表征.这是符合人类观察事物“抓主要特征”的规律.根据定义4~6,我们可以得出纹理相位特征的图7纹理图像的相位图分析图7的纹理图像的相位图特征,可以看出图7(a)的相位图,如果循环右移两个单位,如图8所示,两幅相位基本上相符.因为无论图元和相位,都是相符的,所以认定两幅纹理图像为同一类.如果两个待匹配的纹理相位特征分别用向量犘犎a和犘犎b表示,则其匹配公式如式(3)所示.1.获取纹理图像的PG-LBP统计直方图;2.获取纹理统计直方图中最大图元序号(图元等价类的编号);3.在选定的图元等价类中,计算图元相位在前述8个方向的统计值(8×1特征向量);4.将上述特征向量作为纹理相位特征.需要说明的是按照前述算法获得的图元旋转等价类,第0类和第35类图元结构单一,LBP值分别为0和255,其相位的统计信息恒为0,所以统计纹理的相位特征应排除这两类图元等价类.在图6所示的PG-LBP直方图中,我们可以分别获得图2所示两幅纹理图像的最大图元序号均为15.在其图元序号为15的等价类中,计算各个图元在8个方向上的统计值,其结果如图7所示.图7(a)和图7(b)分别为图2(a)和图2(b)的纹理相位信息.f=min∑8根据图7所示的特征和式(3),我们可以获得两幅纹理图像相位的匹配结果为0.110828,显然这个值越小,两幅纹理图像的相位越匹配.同时根据j的Page6图8纹理图像的相位图(右移)取值我们可以判定两幅图像相位旋转的角度.在图7的相位特征匹配中j=2,也即两幅图像的相位相差2×π/4=π/2.这可从图2所示纹理图像中直接得出结果.通过大量的实验表明,PG-LBP直方图匹配的阈值为0.90,即大于该值便视为纹理图元匹配成功;而相位特征匹配的阈值为0.15,即小于该值便视为相位特征匹配成功.3基于均值漂移和相位信息的纹理分类算法3.1均值漂移的聚类算法均值漂移(MS)算法是一种有效的统计迭代算法[10],是由Fukunaga在1975年首先提出的,并由Cheng在1995年改进了MS算法中的核函数和权重函数,并将其应用于聚类和全局优化[11].本文中的采样点空间是通过提取纹理图像的PG-LBP特征形成的,漂移的迭代方程如式(4)所示.xi+1=mh(狓)=∑n其中,狓为当前窗口内的样本点(纹理图像的PG-LBP特征向量),xi为当前代的样本几何中心,xi+1为迭代之后的质心,g(狓)可以理解为窗口函数,h为窗口半径.最终样本的分类取决于g(狓)窗口滑过的区域.另外,变尺度的均值漂移算法中窗口半径h不再是一个常量,其大小的调节公式如式(5)所示.其中,ρ为当前窗口内的样本浓度,pc为标准浓度常数,C为常数.pc和C根据不同情况进行初始化,在本方案中采用的数值是pc为0.001,C为100.基于均值漂移的纹理图像分类的计算步骤如下:1.提取纹理样本图像的PG-LBP特征,形成代表纹理图像的特征空间.2.在特征空间中任意选择未分类的特征点狓作为初始搜索区域中心,设定窗口宽度h.3.以狓为中心点,根据式(4)计算搜索窗口中特征点的均值x-;并将窗口内的点视为同类特征点.4.计算狓和x-的距离d.如果d小于预设阈值ε则迭代结束,否则新搜索区域的中心狓更新为x-(自适应窗口算法,则应根据式(5)重新确定窗口宽度h),并转步3;步2,否则结束分类计算.5.检查是否存在尚未分类的特征点,如果存在则转向通过上述步骤,利用均值漂移算法在PG-LBP特征空间中,可以获得原纹理图像集的分类结果,但是正如2.4节分析的那样,由于在均值漂移算法中采用纹理的旋转不变特征是PG-LBP,所以该分类结果仅仅区分了组成纹理图像的图元结构,并没有考虑图元的方向分布特征,因此相位信息的主要作用是在前述分类的基础上,根据纹理的相位特征做进一步的划分.3.2基于相位信息的纹理分类算法假设纹理集合为G,根据3.1节划分为G1,G2,G3,…,Gn,则当i≠j时,Gi∩Gj=,且G={G1,G2,…,Gn}.第k类纹理图像Gk可表示为Gk={Gk1,Gk2,…,Gkm},其中Gki代表第k类纹理分类中的第i个纹理图像,则依据相位信息进行分类划分的计算步骤如下,G为新的分类结果集.1.初始化新纹理分类集合G为空;2.计算第k类纹理分类(Gk)中的各个纹理的相位特征,记为Hki(i∈[1,2,…,m]);3.利用式(3)计算纹理个体之间的相位匹配.满足相位匹配阈值的仍看作同一类纹理,反之将视为新的纹理分类.其新的分类结果用Gk={G(1)Gk派生出来的子类;最后的纹理分类结果.4.更新分类集合:G=G+Gk,而G=G-Gk;5.如果G不为空,则跳转步2,否则结束算法,G就是从上述计算步骤,我们可以看出相位信息的作用在于对已有的分类结果做进一步的细分,从而保证Page7了纹理分类的结果,既满足图元的结构特征(第1次分类结果),又考虑图元相位特征(第2次分类结果).4实验结果分析本文从Brodatz纹理库中选取了90幅尺寸为512×512的纹理图像,并将每幅图像随机分割为图9PG-LBP特征直方图4.1基于PG-LBP的纹理分类在实验过程中,将980幅图像,分别提取其PG-LBP特征,在36维空间中形成980个样本点,采用均值漂移聚类法进行分类,并通过3个参数来衡量算法的性能:正确分类率、过分类率和欠分类率.其10幅大小不等的子图像,最终形成一个包含90类900幅的纹理图像库;另外为了测试该算法的旋转不变性,我们加入了10类纹理图像,每类纹理按8个方向进行旋转,共80幅纹理图像库,共形成规模为980的纹理图像测试库.每一幅纹理图像,提取PG-LBP直方图,形成36维空间向量,其特征提取如图9所示.中,在某一类样本点中,包含相同类的样本点不超过3个,认为该类属于过分类;某一分类中包含不同类样本点,则认为是欠分类.下面给出上述3个参数随类间距(k)变化的曲线图,如图10所示.Page8通过上述曲线可以看出,随着窗口半径h变小(分类条件的严格),欠分类率逐渐减少,而过分类率逐渐上升.当条件非常苛刻的时候,分类的正确率也逐渐下降,因此基于PG-LBP的纹理特征符合分类的一般规律.实验结果表明当k=0.038时,均值漂移的分类性能达到最好,其分类准确率为96.8%,过分类率为0.05%,欠分类率为0.83%.4.2PG-LBP算法的缺陷因为PG-LBP为满足图元特征的旋转不变性,所以仅仅保留了图元的结构特征,忽略了纹理图像特征的另一个重要因素:纹理图元的方向分布.要有图12所示的6个图元组成.图11为两幅差别较大纹理图,但其纹理结构主这6个图元分别占据了整个纹理结构的10.0%、11.0%、17.5%、9.6%、5.87%、9.41%,共计63.38%,在提取PG-LBP特征后,利用式(2)计算两者之间的相似度为0.9704(满足匹配的阈值0.9),所以仅凭PG-LBP特征容易将二者判为一类.4.3融合相位信息的纹理分类通过对PG-LBP算法缺陷的分析,其分类的准确率很难有进一步的提高,特别是在解决欠分类问题上更是无能为力,因此必须加入新的特征———纹理相位来对分类结果进一步调整,解决当前所面临的困难.根据定义4~6,我们得到图11所示两幅纹理图像的纹理相位的特征信息,如图13所示.可以看出,两幅纹理图像的相位信息特征是截然不同的.针对图13所示的特征,根据式(3),我们可以得到8个相位匹配结果{0.763055,1.159996,0.618349,1.210867,0.778402,1.172617,0.702905,1.213236};其相位的最终匹配结果取其最小值为0.702905;不能满足相位匹配的阈值(0.15),因此可以通过相位将纹理图像做进一步的划分.由于纹理的相位信息是将分类的结果做进一步的分析,也就是主要针对欠分类纹理集合做进一步的划分.所以当k=0.04时,其欠分类率由0.83%降至0.3%;而由于分类的进一步拆分,其过分类率由0.05%增至0.1%;而其分类准确率为97.3%.另外我们按照如上思想,利用了自适应均值漂移法再次对空间中的样本点进行分类测试,其分类结果的正确率最高可达98.1%.表1是几种分类方法的比较.Page9表1中GWE(Gabor-Weighted-Euclid)数据参考文献[2],CTHMT(Contourlet-HMT)数据参考文献[12],WTGGD(Wavelet-GGD,WTGGD)数据参考文献[13],LBP数据参考文献[4].从上述实验结果分析可以看出相位信息之所以能够提高算法的性能,主要是由于解决了原来分类结果没有相位信息而产生的欠分类问题.因此分类性能的提高必然是由于欠分类率的减少而引起的.对比4.1节和4.3节的分类结果,我们可以看出,相位信息的引入并不能解决由噪声等其它原因引起的错误分类率.5结论本文在分析传统LBP算法的基础上,提出了一种新的改进算法,该算法通过图元“旋转等价类”特征完善了传统算法的旋转不变性;在图元结构相同的情况下,利用纹理的相位信息进一步划分纹理类别.这种由粗到细的分析过程,更加符合人眼的实际视觉感知过程.实验结果表明,该算法能很好地表述复杂纹理特征.
