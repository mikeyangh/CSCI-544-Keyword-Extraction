Page1基于增量式GHSOM神经网络模型的入侵检测研究杨雅辉黄海珍沈晴霓吴中海张英(北京大学软件与微电子学院北京102600)摘要传统的网络入侵检测方法利用已知类型的攻击样本以离线的方式训练入侵检测模型,虽然对已知攻击类型具有较高的检测率,但是不能识别网络上新出现的攻击类型.这样的入侵检测系统存在着建立系统的速度慢、模型更新代价高等不足,面对规模日益扩大的网络和层出不穷的攻击,缺乏自适应性和扩展性,难以检测出网络上新出现的攻击类型.文中对GHSOM(GrowingHierarchicalSelf-OrganizingMaps)神经网络模型进行了扩展,提出了一种基于增量式GHSOM神经网络模型的网络入侵检测方法,在不破坏已学习过的知识的同时,对在线检测过程中新出现的攻击类型进行增量式学习,实现对入侵检测模型的动态扩展.作者开发了一个基于增量式GHSOM神经网络模型的在线网络入侵检测原型系统,在局域网环境下开展了在线入侵检测实验.实验结果表明增量式GHSOM入侵检测方法具有动态自适应性,能够实现在线检测过程中对GHSOM模型的动态更新,而且对于网络上新出现的攻击类型,增量式GHSOM算法与传统GHSOM算法的检测率相当.关键词增量式学习;生长型分层自组织映射;入侵检测;神经网络;信息安全;网络安全1引言随着网络技术的发展和网络规模的不断扩大,计算机网络已成为人们生活中不可缺少的部分.如何保护信息网络免于或者少受来自互联网和组织内部的攻击,成为业界密切关注的重要课题.入侵检测系统是信息安全综合防御系统的重要组成部分.网络入侵检测系统位于第二安全防线,通过分析在网络中若干关键点采集的流量数据来发现是否有网络入侵的行为或迹象,识别出正在发生的入侵企图或已经发生的入侵活动.传统的入侵检测系统大多基于模式匹配方法构建入侵检测模型[1],以离线的方式通过对已知攻击样本的学习训练入侵检测模型并应用于网络入侵检测,检测已知类型的攻击.这样的入侵检测系统存在着建立系统的速度慢、模型更新代价高等不足,难以检测出网络上新出现的攻击类型.面对规模日益扩大的网络和层出不穷的攻击,目前的入侵检测方法大多缺乏自适应性和扩展性,因此需要研究更加自动化、智能化的方法来构造自适应的、动态可扩展的入侵检测模型.神经网络算法具有自适应、自学习、自组织、较好的容错性以及能够进行大规模并行计算和非线性映射等优点,非常适用于变化多端的入侵检测环境.自组织映射(Self-OrganizingMaps,SOM)是神经网络方法中一种典型的方法.然而传统的SOM神经网络算法具有一定的局限性,主要表现在SOM网络的神经元个数必须在聚类之前确定,这对于大量的复杂数据而言是很难实现的,而生长型分层自组织映射(GrowingHierarchicalSelf-OrganizingMaps,GHSOM)神经网络在一定程度上解决了这些问题.GHSOM是一种具有分层结构的SOM神经网络,不仅可以自适应地调整子网和拓展子网,而且可以更好地体现数据中可能存在的复杂层次关系,较好地解决了SOM神经网络模型结构固定的缺点.近年来研究人员结合网络入侵检测的应用背景,从不同角度研究并改进GHSOM模型,改善入侵检测系统的适应性和检测率[2-4].尽管传统GHSOM的入侵检测方法在检测攻击的变种方面具有一定的适应性.但传统GHSOM网络学习算法采用批量学习,即假设一次可以得到所有训练样本,学习过程终止后就不再学习新知识.显然传统GHSOM网络模型无法检测出网络中新出现的攻击,在入侵检测的动态适应性和扩展性方面存在局限性.在网络入侵检测应用中,攻击类型层出不穷,包含所有攻击类型的训练样本通常是随着时间逐步得到的,并且训练样本反映的内在信息可能随着时间的变化而变化.如果将新出现的攻击样本加入到训练样本集中,对整个神经网络重新训练,所付出的时间代价是巨大的,而且新训练的神经网络模型的重新加载势必会影响入侵检测系统的可用性.因此,本文对GHSOM神经网络模型进行研究,在不降低检测率的前提下,使其具有动态增量式学习的能力,能够实现在线检测过程中对GHSOM模型进行动态更新.本文的研究将会提升基于GHSOM神经网络的入侵检测方法的适应性和扩展性.2研究现状增量式学习是指一个学习系统不断地从来自环境的新样本中学习新的知识,并能保留大部分以前已经学习到的知识.使用增量学习算法,可以渐进地进行知识的更新,修正和加强以前的知识,使得更新后的知识能适应更新后的数据,而不必重新学习全部数据.增量式学习降低了对时间和空间的需求,更适应实际要求.一些已有的研究工作集中于增量学习算法.Syed等人[5]提出基于SVM(SupportVectorMachine)增量训练算法,每次增量学习后只保留支持向量,丢弃所有非支持向量样本.孔锐等人[6]提出了一种快速增量学习算法,该算法首先选择那些可能成为支持向量的边界向量,进行SVM增量式学习,找出支持Page3向量,最终求出最优分类.Laskov等人[7]提出通过修改拉格朗日乘子和偏置项求增量训练的精确解.这些增量算法都过分依赖训练样本集中的支持向量,可能导致有用信息过早损失,从而直接影响后续的学习精度.此外,很多学者对神经网络增量式学习问题进行了研究.Li等人[8]给出了一种通过调整BP(BackPropagation)神经网络权值实现增量式学习的方法.Han等人[9]提出了一种通过在前馈神经网络中添加隐单元的方式实现增量式学习的方法,随着隐单元数目的增加,网络训练的收敛速度将变慢.Parekh等人[10]给出了一种通过调整多层感知器神经网络MLP(MultilayerPerceptron)结构实现增量学习的方法.当新样本所含知识不在MLP网络已学到的知识范围内时,通过添加隐含层单元的方法实现对新样本的增量学习.当训练样本集过大时计算的复杂度会很高,不适用于在线入侵检测系统.在神经网络增量式学习的研究中,SOM神经网络应用最为广泛.但是SOM网络结构是固定的,不能动态改变.为此,人们提出了多种在训练过程中调整神经元权值和网络结构的增量式学习解决方案.Zell等人[11]提出了自组织表面(Self-OrganizingSurfaces,SOS)算法,神经元分布在球体表面上,支持网络规模和密度的动态变化,容易实现在频繁获胜的神经元周围动态增加神经元;Deng等人[12]提图1动态增量式GHSOM学习过程对于每一个在线提取的检测模式向量,基于动态增量式GHSOM网络,采用自顶向下的层拓展方式,计算并找出可用于检测的获胜神经元.如果检测模式向量与可用于检测的获胜神经元同类,则输出该检测向量的检测结果,否则有可能是新出现的攻击类型,需要把该检测向量添加到当前获胜神经元的增量训练集中,即调整其增量训练集.判断获胜神经元调整增量训练集以后是否满足层拓展的条件,出演化SOM(EvolveSelf-OrganizingMap,ESOM),该算法根据输入样本调整神经元权值,学习过程中可根据需要增加神经元,能够高速处理数据;Merkl等人[13]提出增量式网格生长(IncrementalGridGrowing,IGG)算法,神经元分布呈二维网络结构,在训练过程中根据输入样本动态调整网络结构.Shen等人[14-15]提出一种自组织增量神经网络(Self-OrganizingIncrementalNeuralNetwork,SOINN),该算法根据输入样本调整神经元的控制区域,自适应地增加或删除神经元.当新样本规模较大时,这些方法通常会存在对训练数据产生过量匹配和分类精度有限的缺点.GHSOM神经网络本身的层拓展特性便于在增量学习过程中通过动态层拓展实现网络结构的动态调整.因此,本文在传统GHSOM神经网络算法的基础上,以动态自适应入侵检测方法为目标开展研究,提出一种增量式GHSOM神经网络的入侵检测方法.3增量式GHSOM学习方法增量式GHSOM学习过程在一个初始训练好的GHSOM模型基础上以在线方式边检测边进行增量学习,实现在检测过程中对GHSOM模型进行动态更新.增量式学习过程(包含检测过程)如图1所示.如果获胜神经元不满足层拓展条件,则该检测模式向量的检测/学习过程结束,否则拓展一层子网,以增量训练集作为初始训练集,对新拓展的子网进行训练,直到新拓展子网的结构达到稳定.如果动态增长的神经网络规模达到了控制条件,则需要剪掉不成熟的子网并收集被剪掉子网的训练数据集,重新训练并拓展一层子网,使得增长过于庞大的GHSOM子网结构得到精简.Page4方法及原理.在增量式GHSOM学习过程中,需要解决的关键问题有:(1)如何判断检测向量与获胜神经元是否属于同类型;(2)如何构造增量训练集;(3)如何设定拓展新子网的条件;(4)如何控制网络的动态增长规模.本节后续内容针对这4个关键问题阐述其解决为了便于后续内容的讨论,先给出如下定义:定义1.映射向量.训练过程中落在神经元上定义2.获胜向量.检测过程中落在神经元上的向量称为获胜向量.定义3.覆盖神经元.如果神经元t能够被一个足够小的超球区域所覆盖,那么该神经元称为覆盖神经元,即的获胜向量称为映射向量.其中,wt是神经元t的权值,犕t是神经元t的映射向量集合,犻是犕t中的任意一个向量.ζ为经验常数,以保证该神经元的映射向量分布集中.本文中ζ通过实验方式获得,取值为0.11.3.1相似度阈值的确定在线检测过程中,进行“同类”判定的前提是确定获胜神经元可用于检测.对于动态增量式GHSOM神经网络,为了保证已学习过的知识不被破坏,可用于检测的神经元包括初始网络的叶神经元、拓展后网络的叶神经元以及非叶覆盖神经元.确定获胜神经元可用于检测以后,判断检测向量与获胜神经元是否同类型,实际上就是判断检测向量与获胜神经元的权值向量之间的相似度.相似度衡量一个向量与另一个向量的相似程度,可以转化为计算两个向量之间的差异,本文通过欧氏距离作为相似度测度的方法[16],即检测向量狓与神经元t的相似度的计算方法为其中,wt是神经元t的权值.对于增量式GHSOM神经网络模型而言,已训练好的神经元上映射向量与该神经元具有较高的相似度,因此以叶神经元权值向量作为球心,映射向量到该神经元的最大欧氏距离作为半径构成的超球可以看成一个相似域.定义4.相似度阈值.相似度阈值定义为相似域的半径,也就是映射向量到该获胜神经元的最大距离.如果检测向量落在神经元的相似域中,那么检测向量与该神经元相似并且同类型,否则不相似.设St为神经元t上的相似度阈值,则相似度阈值St的计算方法如下:其中,wt是神经元t的权值,犕t是神经元t的映射向量集合,犻是犕t中的任意一个向量.3.2增量训练集的动态生成在线检测过程中,只要检测向量被认定与获胜神经元不同类型,那么该检测向量很有可能是新出现的攻击类型,所以需要收集到增量训练集中,用于在新拓展子网中进行训练.增量训练集可能来自检测向量,也可能来自神经元上的映射向量,因此需要设计一种增量训练集的构造机制.每个叶神经元都对应一个增量训练集.根据定义3,覆盖神经元本质上反映的是神经元上的映射向量分布集中度,决定了某个神经元是否起到聚类效果、映射向量是否需要再训练.推论1.如果当前神经元不是覆盖神经元,那么所有该神经元上的映射向量和获胜向量都需要在新拓展的SOM网络中再训练,即需要把训练过程产生的映射向量以及检测过程产生的获胜向量都添加到增量训练集中.推论2.如果当前神经元是覆盖神经元,那么只有检测过程中与该神经元不相似的获胜向量需要添加到当前神经元的增量训练集中,在新拓展子网中再训练.3.3动态层拓展方案在线检测过程中,增量训练集会动态增加,当增加到一定规模以后,可认为这个增量训练集可以被用于训练并拓展一个相对成熟的新子网.定义5.拓展条件.叶神经元t满足拓展条件为其增量训练集It中样本数Nt=k×Ex(其中k为正整数).满足拓展条件时可以用增量训练集It训练一层相对成熟的、可以较好聚类的SOM网络.其中Ex通过实验方式获取,本文中取值为1000.在增量GHSOM神经网络的层拓展方案中,引入虚神经元的概念.定义6.虚神经元.虚神经元是动态层拓展过程中拓展出用于引导检测的神经元,其本身不具备检测攻击类型的功能.其映射向量集为父神经元的增量训练集,权值为其映射向量集中向量的平均权值.当从任意叶神经元t开始进行动态层拓展时,先从t向下拓展一个虚神经元t,再以虚神经元t为Page5父神经元,采用传统GHSOM学习方法进行训练,拓展一层结构稳定的SOM子网.拓展后的子网中的神经元可能是覆盖神经元,也可能是非覆盖神经元.图2给出了一个动态层拓展后的GHSOM神经网络示例.图2动态层拓展后的GHSOM神经网络示例在图2中,实线连接部分表示初始GHSOM网络,虚线连接的部分表示拓展出的SOM子网.用圆点标识网络中的神经元,其中实线框内的白色圆点表示初始GHSOM网络中非叶神经元(不能用于检测),虚线框内白色圆点表示虚神经元,黑色圆点表示覆盖神经元,灰色圆点表示非覆盖神经元.3.4网络规模的控制机制在线检测过程中,动态增量式GHSOM神经网络会随着新增攻击类型的输入自适应地动态拓展,其网络结构最终可能会拓展成无法控制的规模,造成系统崩溃,因此需要设计一种能够有效控制GHSOM神经网络规模的机制.控制动态增量式GHSOM神经网络规模的目标是:(1)减小算法的空间消耗;(2)控制后的增量GHSOM模型更成熟.定义7.成熟神经元.是指在增量式学习算法执行过程中不发生改变的神经元.所有初始GHSOM神经网络中的神经元都是成熟神经元;动态拓展出的子网中的神经元是成熟神经元,应同时满足以下必要条件:(1)非虚根节点上的成熟神经元一定是覆盖神经元;(2)成熟神经元的虚根神经元也是成熟神经元;(3)成熟神经元所在SOM网络中的所有非虚根神经元都是覆盖神经元;(4)成熟神经元的所有上层(包括直接上层和间接上层)SOM网络中的所有神经元都是成熟神经元.定义8.成熟GHSOM神经网络.增量式GHSOM神经网络成熟的充分必要条件是神经网络中的所有神经元都是成熟神经元.初始GHSOM神经网络是一成熟的GHSOM神经网络.增量式GHSOM网络包括一个在初始GHSOM神经网络基础上动态增长的成熟的增量式GHSOM网络和多个不断动态拓展出的不成熟的GHSOM子网络.成熟的增量式GHSOM网络中已有的知识不再改变,但可以通过动态学习增加新知识,本质上反映的是聚类效果好的神经网络.不成熟子网中的知识随着动态学习过程发生改变,本质上反映的是聚类效果不够好的子网.控制机制的基本思想是:(1)当不成熟GHSOM子网规模足够大时,删除不成熟的GHSOM子网;(2)收集删除的子网神经元上的映射向量,重新构造增量训练集;(3)采用动态层拓展方法重新拓展一层更趋于成熟的SOM子网.由于不成熟子网反映的是聚类效果不好的子网,因此不成熟子网在一定条件下可以被删除并重新训练拓展新SOM子网,动态拓展后的GHSOM网络会越来越成熟,确保增量式GHSOM模型在保持原有检测能力的同时,其检测能力也会不断增强.当不成熟GHSOM子网规模足够大时,删除不成熟的GHSOM子网.引入两个控制参数α1和α2,α1为不成熟子网的层数阈值,α2为不成熟子网的神经元个数阈值.删除不成熟子网条件:(1)不成熟子网的总层数大于α1;(2)并且不成熟神经元总个数大于α2.本文通过实验,确定α1=3,α2=15.当某个成熟神经元节点下的不成熟子网被删除后,需要收集不成熟子网中所有覆盖神经元和非覆盖叶神经元的映射向量,重新构造该成熟神经元节点的增量训练集.基于该增量训练集,根据动态层拓展的方法,从成熟神经元动态拓展一个虚神经元和一层SOM子网.该SOM子网是对删除前的GHSOM子网进行精简后的SOM子网.该子网仅包含一层SOM子网,使网络规模得到有效控制.而且由于训练数据更为充分、全面,新拓展的网络结构成熟度不断提高,检测能力将得到增强.4算法描述增量式GHSOM算法在基于增量式GHSOM神经网络模型的在线入侵检测过程中对GHSOM模型进行了动态更新.在线检测之前,需要以离线方式训练好一个成熟的GHSOM神经网络模型作为Page6初始增量式GHSOM神经网络模型.算法描述如下:输入:以离线方式训练的成熟的GHSOM神经网络模型输出:动态更新的增量式GHSOM神经网络模型增量式GHSOM学习算法步骤如下:1.初始化:增量式GHSOM模型初始化为离线训练好的成熟的GHSOM神经网络模型.将在线提取的当前检测模式向量赋值给狓.获胜神经元,t=argmink狓-wk.2.选择第一层SOM中与狓距离最小的神经元t作为3.如果获胜神经元可用于检测神经元,则跳转至步5.4.如果获胜神经元t不是叶神经元,则继续查找获胜神经元t子层中的获胜神经元,并将该神经元赋值给t,然后返回步3;否则获胜神经元t是叶神经元,输出检测结果并调整获胜神经元的增量训练集:当获胜神经元t是非覆盖神经元且增量训练集合It为空,执行It={狓}∪犕t,否则执行It=It∪{狓},跳转至步6.5.计算dis(狓,t)和St.如果dis(狓,t)>St,说明检测模式向量狓与获胜神经元t不同类,返回步4;否则向量狓检测成功,如果获胜神经元t是覆盖神经元,则输出检测结果并图3局域网入侵检测实验环境入侵检测原型系统采用分布式系统结构部署于局域网环境中.攻击终端安装模拟攻击软件IDSInformer产生各种网络攻击流量,用户终端产生各种网络应用的正常流量,特征提取代理在线采集并提取正常或者各种攻击类型网络流量特征,生成特征向量,在线入侵检测服务器基于特征向量执行增量式GHSOM检测/学习算法,完成在线入侵检测及动态更新GHSOM神经网络模型的功能.监控节点执行对网络入侵事件的监控.实验中初始训练数据集包含正常类型和6种攻击类型共计7种类型的特征向量,随机产生的在线检测数据集中的数据类型包含了初始训练数据集中的全部7种类型和2种新增攻击类型,数据集中所包含的各种类型的数据的条数如表1所示.初始训返回步8,不是则返回步4.6.如果当前获胜叶神经元t满足拓展条件时,则从神经元t下方拓展出一个虚神经元t,再从虚神经元t拓展出一个2×2结构的SOM.将神经元t的增量训练集合It作为虚神经元t的映射向量集合,以集合It中向量均值作为虚神经元t的初始权值,以虚神经元t作为父虚神经元,训练新拓展的SOM子网.7.查找新拓展子网的成熟父神经元r,判断神经元r是否满足删除不成熟子网条件.满足则把神经元r的所有不成熟子网删除,并合并所有子网中覆盖神经元和非覆盖叶神经元的映射向量,构成神经元r的增量训练集,返回步6.8.将在线获取的下一个检测模式向量赋值给狓,返回步2,循环此算法.5入侵检测实验与结果分析我们开发了一个基于增量式GHSOM神经网络模型的在线网络入侵检测原型系统,在局域网环境下开展了入侵检测实验,如图3所示.练集和在线检测数据集中的数据都含有标签,可依据此标签判定检测结果是否正确.攻击类型初始训练数据集在线检测数集normalfloodteardropbackdoorsmurfnukebuffoverflowApache25.1验证模型动态更新的效果以表1中的初始训练数据集作为输入,训练生Page7成初始GHSOM网络模型.随机产生表1中的在线检测数据,输入给GHSOM网络模型进行在线检测.观察输入新增攻击类型数据时模型的动态变化情况及检测情况.实验结果如表2所示.新增攻击类型smurf5542×31000100.0flood25142×6100098.4从表2中可以看出当输入smurf数据达到554条时,神经元节点上的增量训练集数目达到了1000个,此时可使网络模型动态更新从而拓展出一层由2×3个神经元构成的SOM网络,且新的神经元可用于表征这个新类型.在输入后续的1000个smurf检测数据后,可利用拓展的模型进行检测,检测率为100%.当输入flood数据达到2514条时,神经元节点上的增量训练集数目达到了2000个,此时拓展出一层由2×6个神经元构成的SOM网络,后续输入1000个smurf检测数据的检测率为98.4%.通过本实验可以看出,动态增量式GHSOM模型不仅可以动态更新,而且更新后的模型能够以较高的检测率检测新增攻击类型.5.2验证增量式学习的稳定性初始模型是基于表1的初始训练数据进行训练获得的模型,增量模型是指5.1节实验中动态增量后的GHSOM模型.针对这两个模型,使用表1中的去掉2种新增攻击类型后的在线检测数据进行入侵检测实验,统计其检测率,判断动态更新是否对已学习过的知识造成影响.据的检测率对比如表3所示.实验中初始模型和增量模型对于同一组检测数攻击类型teardropbackdoorbuffoverflowApache2从表3看出,模型动态更新后对原有类型攻击的检测率基本保持不变,这表明GHSOM模型动态更新对已学习过的知识基本没有影响,验证了增量式GHSOM模型的稳定性.5.3验证算法的可用性5.1节实验中的两种新增攻击类型(smurf和flood)的数据被分成两部分:一部分用于增量训练,另一部分用于在线检测.将新增攻击类型的增量训练数据合并到表1中的初始训练数据集中,之后再基于此合并后的初始训练集,使用传统的GHSOM学习算法进行训练得到一新的GHSOM模型.基于此传统GHSOM模型,输入两种新增攻击类型的在线检测数据,将检测结果与表2中动态增量式GH-SOM模型对这两种新增攻击类型的在线检测结果进行对比,其结果如表4所示.检测数据类型smurfflood本实验表明当训练数据集相同时,增量式GHSOM算法的检测效果与传统GHSOM算法的检测效果相当,从而验证了动态增量式GHSOM神经网络入侵检测算法的可用性.6结论本文提出了一种增量式GHSOM算法,该算法不仅具有原有GHSOM算法的优点,而且能够以在线方式边检测边进行增量学习,实现在检测过程中对GHSOM模型进行动态更新.局域网环境下进行的入侵检测实验表明增量式GHSOM模型具有适应性和扩展性,可用于在线网络入侵检测.虽然增量式GHSOM算法对于实验数据有着较好的结果,但是实际环境中的数据有着很大的不确定性,在噪声环境下识别准确率会受到一定影响.因此,如何提高算法的抗噪性是有待解决的问题.
