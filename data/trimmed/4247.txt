Page1无线传感器网络中隐私保护通用近似查询协议范永健1),2),3)陈红1),2)张晓莹1),2)彭辉1),2)李翠平1),2)1)(中国人民大学数据工程与知识工程教育部重点实验室北京100872)2)(中国人民大学信息学院北京100872)3)(河北工程大学信息与电气工程学院河北邯郸056038)摘要无线传感器网络中实现隐私保护通用近似查询是具有挑战性的问题.文中提出一种无线传感器网络中隐私保护通用近似查询协议PGAQ.PGAQ将传感器节点编号和其采集数据隐藏于设计的数据结构中,在基站构造线性方程组解出直方图,根据直方图具有的统计信息,不泄露隐私地完成Top-k查询、范围查询、SUM、MAX/MIN、Median、Histogram等近似查询.PGAQ使用网内求和聚集以减少能量消耗,并且能够通过调节直方图划分粒度来平衡查询精度与能量消耗.PGAQ协议分为H-PGAQ和F-PGAQ两种模式.H-PGAQ模式使用数据扰动技术加强数据安全性,F-PGAQ使用过滤器减少连续查询通信量.通过理论分析和使用真实数据集实验验证了PGAQ的安全性和有效性.关键词无线传感器网络;隐私保护;近似查询;数据聚集;物联网1引言物联网隐私保护技术水平直接影响物联网的应用发展.无线传感器网络(以下简称为传感器网络)是物联网的重要组成部分,在环境监测、医疗卫生、智能交通、国防军事等领域具有广阔的应用前景.随着传感器网络的应用发展,在实际应用部署过程中暴露出严重的隐私数据泄漏或被篡改的威胁.传感器网络实际部署中暴漏出的严重隐私泄露问题,引起了研究人员的高度重视,隐私保护技术目前已成为研究热点.目前,传感器网络数据隐私保护技术主要针对数据聚集、数据查询和访问控制中数据隐私保护问题进行研究[1].在隐私保护数据聚集方面,文献[2-11]研究了在不泄露隐私信息的情况下,完成SUM、MIX、MAX或Median等数据聚集操作,但是这些成果不能够通过网内数据聚集完成Top-k查询、范围查询等复杂查询.在隐私保护数据查询方面,文献[12-15]分别研究了范围查询(rangequery)、Top-k查询等查询中隐私保护技术,但是不能够在不泄露隐私信息的情况下,同时完成Top-k查询、范围查询等查询操作.传感器网络中能量消耗往往直接影响网络寿命,网内数据聚集是传感器网络常用的减少能量消耗技术.在实际应用中,常常既需要查询采集数据值最高(或最低)的前k个传感器节点,又需要查询采集数据值在某个范围的传感器节点,仅能实现单一查询类型的隐私保护协议在实际应用中是受限的.所以,研究使用网内数据聚集的隐私保护通用查询协议具有积极意义.因为具有诸多挑战性,目前这方面研究成果基本还是空白.使用网内聚集的隐私保护通用查询协议具有以下挑战:(1)因为Top-k等查询需要全局信息,这就要求网内数据聚集既要完成数据融合或压缩又要保留全局信息;(2)聚集节点需要在不能获得数据真实值的情况下,实现数据融合或压缩;(3)常用查询往往既需要符合查询条件的采集数据值,同时还需要相应的传感器节点编号,以便获取需要关注的区域等信息.本文提出使用网内数据聚集的隐私保护通用近似查询协议,将传感器节点编号和其采集的感知数据等信息隐藏于随机向量中,中间聚集节点对上传向量进行求和聚集,在基站构造线性方程组,解出带全局统计信息的直方图和对应的传感器节点编号,使用直方图中统计信息完成隐私保护Top-k查询、范围查询、SUM、MAX/MIN、Median、Histogram等近似查询.本文主要贡献:(1)提出一种新颖的能够完成Top-k查询、范围查询、SUM、MAX/MIN等查询的隐私保护通用近似查询协议;(2)在不泄漏隐私信息的情况下,使用网内数据聚集和过滤器等策略减少近似查询能量消耗;(3)在不需要修改模型的情况下,通过参数调节能够实现对隐私保护近似查询精度控制;(4)通过理论分析和使用真实数据集实验验证了PGAQ协议的安全性和有效性.本文第2节总结相关工作;第3节介绍研究基于的模型和性能需求;第4节描述协议的两个模式;第5节进行性能分析;第6节使用真实数据进行实验并分析;第7节总结本文.2相关工作目前,面向数据的隐私保护技术研究成果主要集中在数据挖掘和数据发布两个领域[16],综合现有的研究成果,隐私保护技术主要可分为三类:数据扰乱技术、数据加密技术和数据匿名化技术.数据挖掘和数据发布领域的隐私保护技术为传感器网络数据隐私保护提供技术借鉴和支撑,但是往往由于能量消耗大或不适合分布式环境等因素不能直接应用于传感器网络.现有的传感器网络数据隐私保护技术研究成果主要集中在隐私保护数据聚集和隐私保护数据查询两方面.传感器网络中隐私保护数据聚集协议采用不同的加密方式进行隐私保护.文献[2-4]使用逐跳加密方式(hopbyhop)应对通信链路窃听攻击.文献[2-3]使用数据扰动(perturbation)技术应对俘获节点窃听攻击,在原始数据中添加随机种子和私有随机数进行扰乱来隐藏真实数据值,簇头节点利用多项式的代数性质求解出精确的聚集结果.文献[2,4]使用切分重组(shuffling)技术应对俘获节点窃听攻击.文献[5-9]使用端到端加密机制,端到端加密机制可以较好地应对内部攻击和外部攻击,但需要使用同态加密模式在加密数据上实现数据聚集.文献[5-7]使用求和同态加密模式,文献[8]使用Domingo-Ferrer提出的同态加密模式(DFscheme),文献[9]使用基于椭圆曲线的同态加密模式.文献[10]在不加密的情况下通过添加伪装数据(camouflagedata)主要实现隐私保护MAX/MIN非线性聚集.文献[11]使用扰乱直方图技术实现隐私保护近似MAX/MIN、Page3SUM、Median等聚集操作.上述文献在聚集节点不能获得真实数据值的情况下实现聚集操作,但是由于聚集信息中没有携带传感器节点编号信息,所以不能实现需要传感器节点ID的复杂查询,如Top-k查询或范围查询等.文献[12-14,17]对传感器网络中隐私保护范围查询进行研究,基于的网络模型为高资源节点为存储节点的两层传感器网络.文献[12]采用桶模式(bucketingscheme)和加密技术完成隐私保护范围查询,文献[14]使用前缀成员验证技术(prefixmembershipverificationtechnique)在编码数据上实现范围查询而不泄漏数据值.文献[17]利用多项式技术对节点采集的数据范围信息和查询条件进行编码,保证存储节点在不知道数据和查询条件真实内容的情况下正确地执行范围查询处理.文献[15]使用数据扰乱和安全比较技术,提出一种两层传感器网络中隐私保护Top-k查询协议.上述文献针对两层传感器网络中单一查询类型有效,不能同时完成Top-k和范围等查询,不具有通用性,并且不能在节点相似网络中应用.近似查询是传感器网络中重要的查询方式,在对精度要求不高的情况下,可以在精度和能量消耗之间进行平衡.文献[18-19]研究了传感器网络中的近似查询,但是没有考虑隐私保护问题.3研究模型和背景3.1传感器网络和数据聚集模型现有传感器网络数据隐私保护研究主要基于节点相似的传感器网络和两层传感器网络两种网络模型[1].本文研究基于节点相似的传感器网络模型,网内传感器节点在初始能量、存储能力、通信能力方面都是相似的,所有网内节点都有可能成为聚集节点等承担更多任务的节点.本文考虑的传感器网络模型由基站和n个传感器节点构成,每个传感器节点编号唯一,传感器节点编号记为{s1,s2,…,sn}.基站具有充足的存储、计算和通信能力,并且能够获取网络全局的拓扑结构信息.网络能够形成树形路由,基站通过树形路由下发查询需求,传感器节点通过树形路由将查询响应数据上传至基站.在上传查询响应过程中,非叶子节点对其孩子节点数据和本节点采集数据进行聚集融合,仅上传聚集后数据.聚集函数可定义为y(t)f(Vs1(t),…,Vsi(t),…,Vsn(t)),其中Vsi(t)为节点si在t时间段采集的数据.本文使用求和聚集函数为f(t)=∑n3.2查询模型PGAQ协议中查询模型分为通用近似查询模型和网内查询模型.用户使用通用近似查询模型向基站发送查询命令,基站使用网内查询模型通过路由树下发给传感器节点,传感器节点将感知数据通过非叶子节点聚集并上传,基站根据聚集结果推导出直方图,根据直方图计算出用户需要的通用近似查询结果,将其返回给用户.通用近似查询模型描述为G=(queryregion=G)∧(epoch=t)∧(querytype=T)∧(queryparameter=P)∧(approximateparameter=ε),其中,G为查询区域,t为查询周期,T为用户需要返回的查询类型集合,P为T中查询类型所需的参数集合,ε为近似查询精度阈值参数.PGAQ协议所支持的查询类型有Top-k查询,范围查询、MAX\MIN,SUM、Median、Histogram等.T中可以是单个查询类型,也可以是多个PGAQ协议所支持的查询类型.P中参数应和T中查询类型相对应.查询类型为Top-k查询时,P中参数为k值;查询类型为范围查询时,P中参数为查询范围[a,b].基站通过树形路由向查询区域G内传感器节点下发的网内查询模型为其中,t为查询周期,(H1,…,Hh)为由近似查询精度阈值参数ε计算出来的直方图区间划分,如ε为默认值,则不需要传(H1,…,Hh).3.3攻击模型与安全目标传感器网络中针对隐私数据的攻击可分为外部攻击和内部攻击两种攻击模型.由于传感器网络采用无线通信,数据在节点之间传输时攻击者可能通过链路层窃听获取敏感数据,这种攻击模式称为外部攻击.进行内部攻击时,攻击者通过俘获或复制传感器节点等手段成为网络的参与者,能够获取俘获传感器节点的所有数据.本文研究基于诚信但好奇(honestbutcurious)模型[15],攻击者通过记录或推测敏感数据进行窃取信息,但其遵守协议且不篡改数据,仅破坏数据的隐私性但不破坏数据的完整性.本文假设攻击者采用两种攻击方式窃取敏感信息:(1)使用外部攻击模式,数据在节点之间传输时通过链路层窃听获取敏感数据;(2)使用内部攻击模Page4式,俘获传感器节点后通过记录或推测敏感数据进行窃取信息.本文安全目标为:在诚信但好奇模型下,PGAQ能够应对外部攻击和内部攻击两种模式的攻击,在不泄漏隐私信息的情况下使用数据聚集完成通用近似聚集查询.3.4隐私保护近似查询需求平衡:隐私保护近似查询协议需要以下性能需求和(1)隐私保护需求.由于攻击者能够通过无线链路窃听和俘获传感器节点进行攻击,隐私保护近似查询协议应满足以下要求:为了保护隐私信息,传感器网络中任意节点si(si∈G)采集的数据Vsi不能够被无线链路窃听者获知,同时也不能被网络中其他任意节点sj(sj∈G且i≠j)获知;传感器网络中任意节点不能获知查询结果数据集;传感器网络中任意节点不能获知查询结果数据项对应的传感器节点ID.(2)能量消耗量.能量消耗往往直接影响传感器网络寿命,减少能量消耗是传感器网络协议重要的性能需求.隐私保护技术往往需要增加传感器网络通信量和能量消耗,隐私保护查询协议应尽量减少通信量和能量消耗.网内数据聚集和融合能够有效地减少数据传输量,进而减少能量消耗.将网内数据聚集和融合应用于隐私保护近似查询协议具有重要意义.(3)查询精度.在对精度要求不高的情况下,近似查询可以在精度和能量消耗之间进行平衡,以减少能量消耗.同时,近似查询的精度应能够满足应用的需求,所以近似查询精度应能够通过系统参数进行控制,以达到满足应用需求精度和能量消耗之间的平衡.4PGAQ协议PGAQ通过设计基站与传感器节点共享的数据结构,将传感器节点编号和其采集的感知数据等信息隐藏于构造的向量中,通过树状路由将此向量向基站传送,上传此向量过程中使用网内求和聚集以减少能量消耗,在基站构造线性方程组,解出直方图和对应的传感器节点编号,使用直方图中的统计信息,不泄露隐私地完成Top-k查询、范围查询、SUM、MAX/MIN、Median、Histogram等近似查询.PGAQ基本步骤如图1所示.首先,基站为每个传感器节点si(si∈G)产生唯一的随机向量作为参照向量(a1i,a2i,…,ami)T,加密后下发至对应传感器节点si,传感器节点si使用其采集的数据Vsi和参照向量(a1i,a2i,…,ami)T计算响应向量(r1i,r2i,…,rmi)T,根据树状路由将响应向量上传至父节点,父节点作为聚集节点,使用求和聚集函数对所有收到的数据进行聚集,生成本节点的响应向量,然后发送聚集结果至其父节点,依次传送至基站.基站使用所有收到的数据计算出统计直方图,根据该直方图完成隐私保护近似查询.调节直方图划分粒度来平衡查询精度与能量消耗.PGAQ协议分为H-PGAQ和F-PGAQ两种模式.H-PGAQ模式使用数据扰动技术和单路Hash函数,增强了数据安全性.F-PGAQ使用过滤器来减少连续查询通信量.4.1H-PGAQ模式H-PGAQ协议分为系统初始化和查询两个阶段.用n表示传感器网络节点的个数,对网内传感器节点进行统一编号分别表示为{s1,s2,…,sn},用[vmin,vmax]表示传感器节点采集数据的值域.(1)系统初始化阶段.基站在{1,2,3,…,2γ}(其中γ为系统参数)中随机选择m×n个不同的正整数aij(i=1,2,…,m;j=1,2,…,n),构成m×n的参照矩阵犌为传感器节点si(i=1,2,…,n)与参照矩阵犌中第i列向量(a1i,a2i,…,ami)T对应,将(a1i,a2i,…,ami)T作为传感器节点si(i=1,2,…,n)的参照向量.基站为每个传感器节点si(i=1,2,…,n)生成Page5唯一且长度为m的扰动向量(sn1i,sn2i,…,snmi)T和单路Hash函数h(·),单路Hash函数h(·)能够将数据映射至集合{1,2,…,M},其中M=n×vmax×2γ,vmax为采集数据值域[vmin,vmax]的上界.在基站,采集数据值域[vmin,vmax]被连续划分为h个区间,表示为(H1,…,Hh).基站使用与每个传感器节点si(i=1,2,…,n)共享密钥进行加密,为了增加安全性,PGAQ采用文献[12]中周期更换密钥方式,用ki,t表示周期t内传感器节点si与Sink共享的密钥,则有ki,t=hash(ki,t-1).用Eki,t{}表示加密过程,向传感器节点si(i=1,2,…,n)传送如下消息:Sink→si(i=1,2,…,n):i,Eki,t{(a1i,a2i,…,ami)T,(sn1i,sn2i,…,snmi)T,传感器节点si(i=1,2,…,n)收到消息后,使用与基站共享密钥ki进行解密,得到与基站排他共享的如下信息:参照向量(a1i,a2i,…,ami)T、扰动向量(sn1i,sn2i,…,snmi)T、单路Hash函数h(·)和采集数据值域划分区间(H1,…,Hh).(2)查询阶段.传感器节点将采集数据所在划分区间信息和传感器节点编号信息隐藏于长度为m的响应向量中,并传送给聚集节点;聚集节点对收到的向量执行求和操作,并加上本节点生成的向量,得到本节点长度为m的响应向量,上传并参加求和聚集;基站对收到的所有向量求和得到聚集结果向量,聚集结果向量减去扰动数据,得到以参照矩阵为系数矩阵的线性方程组,求解线性方程组得到带统计信息的直方图和相应传感器节点编号,使用直方图和相应传感器节点编号计算出近似查询结果.输入:叶子节点si查询周期t内采集数据值vi,t;输出:叶子节点si响应向量(r1i,r2i,…,rmi)T;1.IFvi,t≠null//查询周期t内有采集数据2.FORk=1,2,…,hdo3.IFvi,t∈HkTHEN//采集数据vi,t落入Hk4.Ni=k;(1)叶子节点处理过程叶子节点si采用算法1将采集数据vi,t所在划分区间信息和传感器节点编号信息隐藏于长度为m的响应向量中.算法1.叶子节点计算响应向量算法.需求:参照向量(a1i,a2i,…,ami)T、扰动向量(sn1i,sn2i,…,snmi)T、单路Hash函数h(·)、采集数据值域划分区间(H1,…,Hh);5.(r1i,r2i,…,rmi)T=Ni×(a1i,a2i,…,ami)T+6.ENDIF7.ENDFOR8.ELSE//查询周期t内没有采集数据9.(r1i,r2i,…,rmi)T=(h(sn1i),h(sn2i),…,h(snmi))T;10.RETURN(r1i,r2i,…,rmi)T叶子节点si在查询周期t内有采集数据时,采用算法1计算响应向量为其中,Ni为传感器节点si查询周期t内所采集数据vi,t所在划分区间的编号,即vi,t∈HNi.叶子节点si在查询周期t内没有采集数据时,采用算法1计算响应向量为(r1i,r2i,…,rmi)T=(h(sn1i),h(sn2i),…,h(snmi))T.叶子节点si将响应向量(r1i,r2i,…,rmi)T上传(2)聚集节点聚集过程假设聚集节点sj有cnj个孩子节点,孩子节点编号分别为{j-cnj,j-cnj+1,…,j-1},聚集节点sj在查询周期t内采集数据为vj,t.聚集节点sj采用算法2对收到的孩子节点响应向量进行求和并加本节点产生的向量,生成聚集节点响应向量并上传.至父节点参加聚集.算法2.聚集节点计算响应向量算法.需求:参照向量(a1j,a2j,…,amj)T、扰动向量(sn1j,sn2j,…,snmj)T、单路Hash函数h(·)、采集数据值域划分区间(H1,…,Hh);输入:聚集节点sj查询周期t内采集数据值vj,t,孩子输出:聚集节点sj响应向量(r1j,r2j,…,rmj)T;1.使用算法1,输入vj,t,得到向量(r1j,r2j,…,rmj)T;2.FORk=j-cnj,j-cnj+1,…,j-1do3.(r1j,r2j,…,rmj)T=(r1j,r2j,…,rmj)T+4.ENDFOR5.RETURN(r1j,r2j,…,rmj)T聚集节点sj将响应向量(r1j,r2j,…,rmj)T上传至父节点参加聚集,如父节点不是基站,使用算法2生成响应向量并继续上传,直到上传至基站.(3)基站处理过程基站收到其所有孩子节点后,进行以下处理:将所有孩子节点响应向量执行求和操作,得到聚集结果向量:Page6将聚集结果向量减去所有节点经单路Hash函数h(·)处理过的扰动数据之和,得到向量(b1,b2,…,bn)T.,b1烄烌b2=b烎m烆b1烄b2即为b烆即为如下线性方程组:a11×N1+a12×N2+…+a1n×Nn=b1烄a21×N1+a22×N2+…+a2n×Nn=b2烅am1×N1+am2×N2+…+amn×Nn=b烆方程组(1)的系数矩阵为参照矩阵犌.当m足够大时,能够求解出集合{N1,N2,…,Nn}.当m=n时,参照矩阵犌为n×n方阵,且有犌≠0.根据克莱姆法则(Cramer’sRule),当m=n时方程组(1)能够准确求解.传感器节点s1,s2,…,sn在查询周期t内采集数据所在的区间分别为HN1,HN2,…,HNn.统计(H1,…,Hh)中各区间所包含的传感器节点采集数据的数目和相应的传感器节点编号,得到以(H1,…,Hh)为划分的统计直方图.根据直方图求解出通用近似查询G中用户需要的查询类型T的近似查询结果.4.2F-PGAQ模式H-PGAQ模式使用数据扰动技术和单路Hash函数,这样即使聚集节点能够获得传感器节点和基站共享密钥,能够解密并获得基站下发的参照向量,聚集节点也不能计算出感知数据,增强了数据安全性,但是H-PGAQ需要所有传感器节点上传数据,连续查询时通信代价较高.F-PGAQ假设聚集节点不能够获取传感器节点和基站共享的密钥,使用参照向量代替真实采集数据进行隐私保护.F-PGAQ使用过滤器减少连续查询时的通信量,将直方图划分作为过滤器窗口,如果本轮采集数据与上轮采集数据落入同一直方图划分,则不需要上传数据.F-PGAQ模式和H-PGAQ模式处理过程基本相似,主要区别在于:(1)F-PGAQ不对上传向量添加扰动数据;(2)F-PGAQ使用过滤器,在连续查询中,如果本轮采集数据与上轮采集数据落入同一直方图划分,则不需要上传数据.F-PGAQ模式具体过程如下:(1)系统初始化阶段基站使用H-PGAQ中方法划分区间(H1,…,Hh),并为每个传感器节点si(i=1,2,…,n)生成参照向量(a1i,a2i,…,ami)T.使用与传感器节点si共享密钥ki,t进行加密,基站向传感器节点si(i=1,2,…,n)传送如下消息:Sink→si(i=1,2,…,n):传感器节点si解密得到(a1i,a2i,…,ami)T和(H1,…,Hh).(2)查询阶段①叶子节点处理过程在连续查询中,叶子节点首先判断本轮采集数据与上轮数据是否落入同一区间划分(H1,…,Hh),如果落入同一划分区间,则不需要上传数据.如果本轮采集数据与上轮数据落在不同的区间,则参照算法1(不添加扰动数据)计算响应向量为(r1i,r2i,…,rmi)T=(a1i×Ni,a2i×Ni,…ami×Ni).叶子节点si将响应向量(r1i,r2i,…,rmi)T上传②聚集节点聚集过程聚集节点使用叶子节点处理过程产生本节点向量.聚集节点对收到的孩子节点响应向量进行求和并加本节点产生的向量,生成聚集节点的响应向量并上传.没有采集数据,则聚集节点不需要上传数据.如果所有孩子节点没有上传数据并且聚集节点至父节点参加聚集.③基站处理过程假设本轮查询中查询区域内有nG(nGn)个传感器节点上传向量参加聚集.为表述方便,假设上传Page7向量的传感器节点为{s1,s2,…,snG}.基站将收到的孩子节点响应向量执行求和操作,得到聚集结果向量:即为如下线性方程组:a11×N1+a12×N2+…+a1nG×NnG=b1烄a21×N1+a22×N2+…+a2nG×NnG=b2烅am1×N1+am2×N2+…+amnG×NnG=b烆当m足够大时,能够求解出集合{N1,N2,…,NnG}.当m=nG时方程组(2)能够准确求解.基站对于没有上传数据的节点si使用上一轮si对应的Ni,得到具有查询区域全部节点采集数据信息的直方图数据{N1,N2,…,Nn}.根据直方图求解出通用近似查询G中用户需要的查询类型T的近似查询结果.5性能分析5.1查询精度查询精度主要受系统参数h和对区间(H1,…,Hh)划分方式的影响.区间(H1,…,Hh)划分方式决定在基站计算得到的直方图的类型,系统参数h决定区间(H1,…,Hh)的划分粒度.为了控制精度的需要,本文采用等宽直方图和等高直方图两种直方图划分方式.直方图划分方式可由传感器网络系统用户选择.近似查询误差由两个参数描述,分别为数据值误差值εv和数据项个数误差值εn.定义1.数据值误差值εv.εv为查询返回结果中数据值范围误差上限,即max{|vpmax-vrmax|,|vpmin-vrmin|}εv,其中,vpmax和vpmin分别为p中的最大值和最小值,vrmax和vrmin分别为r中的最大值和最小值,p为基站返回的近似查询结果数据项集合,r符合查询条件的精确查询数据项集合.定义2.数据项个数误差值εn.εn为查询返回结果中不符合查询条件的数据项数上限,即其中,p为基站返回的近似查询结果数据项集合,r为符合查询条件的精确查询数据项集合.定理1.使用等宽直方图划分方式能够控制近似查询结果数据值误差值εv.证明.等宽直方图划分方式为:将采集数据值域[vmin,vmax]均匀划分为h个区间(H1,…,Hh),每个区间的宽度σ=(vmax-vmin)/h,则Hi为[(i-1)×σ,i×σ].数据值误差值εv与等宽直方图划分方式时总划分数h的关系为所以,使用等宽直方图划分方式能够控制近似查询结果数据值误差值εv.由于等宽直方图划分方式能够控制近似查询结果数据值误差值εv,所以等宽直方图划分方式更加适合用于范围查询类型.当查询类型T为范围查询时,参数集合P为范围查询参数[a,b].PGAQ协议计算覆盖[a,b]的最小直方图划分集合,将所有落入该直方图划分集合的数据项作为近似查询的结果集,返回给用户.定理2.使用等高直方图划分方式能够控制近似查询结果数据项个数误差值εn.证明.等宽直方图保证落入划分区间的采集数据项基本相等.其划分思路为:根据基站对整个网络历史采集数据项的统计分布函数f(x),等宽直方图划分在区间划分(H1,…,Hh)上,对于i,j(1i,jh)有∫x∈Hiεn与等高直方图划分方式时总划分数h的关系为其中,Sn为查询周期t内所有传感器节点采集的数据项目总和,Sn/h为落入每个区间的采集数据项数的平均数.所以,使用等高直方图划分方式能够控制近似查询结果数据项个数误差值εn.假设统计分布函数f(x)为正态分布f(x)~N(μ,σ),划分数h为7,等高直方图划分示意图如图2所示.由于等高直方图划分方式能够控制近似查询结果数据项个数误差值εn,所以等直方图划分方式更加适合用于Top-k查询类型.当查询类型T为Page8Top-k查询时,参数集合P为Top-k查询参数k.PGAQ协议计算落入最高(低)划分区间的数据项数大于(小于)等于k的最小划分区间集合,将所有落入该直方图划分集合的数据项作为近似查询的结果集,返回给用户.为了兼顾查询结果数据值误差和数据项个数误差,直方图可采用混合划分方式.在落入数据项密集的区域Hcon采用等高直方图的划分方式.在区域Hcon内有∫x∈Hi定理2,在区域Hcon内能够控制近似查询结果数据项个数误差值εn,同时,由于区域Hcon内落入数据项较密集,使用等高直方图的划分方式得到的划分区间较窄,使得数据值误差较小,兼顾了查询结果数据值误差.在落入数据项稀疏的区域Hspar采用等宽直方图的划分方式,在区域Hspar内有Hm=Hn(Hm,HnHspar),根据定理1,在区域Hspar内能够控制近似查询结果数据值误差值εv,同时,由于区域Hspar内落入数据项较稀疏,使用等宽直方图划分方式将使落入每个划分区间的数据项个数较少,使得数据项个数误差较小,兼顾了查询结果数据项个数误差.假设统计分布函数f(x)为正态分布f(x)~N(μ,σ),划分数h为9,直方图混合划分示意图如图3所示.其中H1=H2=H8=H9,∫x∈H3∫x∈H5f(x)=∫x∈H65.2隐私性定义3.传感器网络中通用近似查询隐私性.传感器网络中通用近似查询G={G,t,T,P,ε}正确执行时,如果攻击者不能获得以下敏感信息,则查询G满足隐私性:(1)查询区域G内传感器节点si(i=1,2,…,n)采集数据值vi,t;(2)包含采集数据统计信息的直方图信息;(3)查询结果数据对应的传感器节点编号.本文考虑攻击者能够进行通过俘获聚集节点的内部攻击和通过窃听链路层的外部攻击两种攻击方式.定理3.在假设聚集节点不能够获取传感器节点和基站共享的密钥的情况下,F-PGAQ满足传感器网络中通用近似查询隐私性(定义3).证明.在F-PGAQ的系统初始化阶段,基站对每个传感器节点对应的参照向量,使用其与传感器节点共享的密钥加密,下发至传感器节点,由于假设聚集节点不能够获取传感器节点和基站共享的密钥,聚集节点不能获得参照向量.叶子节点将采集数据信息和节点编号信息隐藏于响应向量并上传至聚集节点,聚集节点不知道参照向量,所以不能推导出采集数据信息和节点ID信息.同时,由于无线链路中传输的数据为响应向量,所以外部攻击者也不能获得定义3中定义的敏感信息.定理4.无论聚集节点是否能够获取传感器节点和基站共享的密钥,H-PGAQ都满足传感器网络中通用近似查询隐私性(定义3).证明.在F-PGAQ隐私保护方法的基础上,H-PGAQ模式使用数据扰动技术和单路Hash函数.由定理3知:在聚集节点不能够获取传感器节点和基站共享的密钥的情况下,F-PGAQ满足传感器网络中通用近似查询隐私性.当聚集节点能够获取传感器节点和基站共享的密钥时,聚集节点能够获知参照向量,但是由于H-PGAQ中响应向量中包含单路Hash函数处理过的扰动数据,聚集节点同样不能获得定义3中定义的敏感信息.证毕.定理5.PGAQ能够应对共谋攻击.证明.在系统初始阶段,基站使用与传感器节点共享密钥进行下发参照向量,传感器节点不能获得其他节点的参照向量,因此即使获知其他节点的响应向量也不能通过共谋(串通)来获得其他节点真实数据.5.3能量消耗传感器网络能量消耗主要受系统参数m影响.Page9在PGAQ协议中,叶子节点向聚集节点传输长度为m的响应向量,聚集节点将收到的所有孩子节点的响应向量进行求和聚集,并加入本节点信息生成本节点长度为m的响应向量,上传并参加父节点的聚集.所以,在PGAQ协议中,聚集路由树中上传的均为长度为m的向量.第6节使用真实数据对系统参数与传感器网络能量消耗关系进行实验和分析.5.4系统扩展性在网络规模方面,PGAQ协议能够较方便地适应网络规模的扩展.在PGAQ协议中基站为网内每个传感器节点si(i=1,2,…,n)分配不同的参照向量(a1i,a2i,…,ami)T,基站需要产生m×n参照矩阵犌,n需要不小于网内传感器节点个数.当传感器网络规模需要扩展时,基站按第4节要求为新增的节点生成相应的参照向量和扰动向量,并使用基站与传感器节点共享密钥加密后,下发至新增传感器节点,同时将新产生的参照向量加入参照矩阵,其他节点的参照向量和扰动向量不需要变化.在生成新的聚集路由后,PGAQ协议可以在网络规模扩展后的网络上执行.6实验与分析本文设计的PGAQ协议代价可分以下两部分:在系统初始化阶段,传输加密的参照向量和区间划分代价;在查询阶段主要为传感器节点采集数据、生成聚集响应向量和传输响应向量的代价.其中网络系统性能主要受查询阶段代价影响.对于传感器节点,通信能量消耗远大于计算能量消耗,本文参照文献[2,4,12-13],使用数据通信量对算法的有效性进行评价.本文使用公开可获得的真实数据集LUCEdataset①,在OMNeT++平台上对PGAQ进行实验.LUCEdataset数据集为2006年和2007年采集的环境温度、土壤湿度等11维属性数据,本文使用环境温度数据进行实验,使用的实验数据值域为[-20,30].本文使用LUCEdataset中节点位置数据,根据规模分为3组实验.假设传感器节点有效传输距离为60m,使用TAG(tinyaggregationserviceforadhocsensornetworks)算法建立路由.第1组实验,20个传感器节点分布在200m×200m矩形区域内,传感器节点向单元头节点传输数据平均需要2.5跳,每个传感器节点平均有4.5个邻居节点;第2组实验,50个传感器节点分布在350m×250m矩形区域内,传感器节点向单元头节点传输数据平均需要2.9跳,每个传感器节点平均有6.4个邻居节点;第3组实验,88个传感器节点分布在450m×300m矩形区域内,传感器节点向单元头节点传输数据平均需要3.1跳,每个传感器节点平均有11.1个邻居节点.图4显示了PGAQ在系统初始化阶段,3组不同网络规模的实验中,基站向传感器节点传输加密数据需要的通信量,本文采用文献[12]中的密钥机制,使用16位密钥进行加密.为了考察PGAQ查询时的通信量,本文将H-PGAQ、F-PGAQ和KIPDA[10]、端到端(endtoend)加密方案进行比较.KIPDA和PGAQ同样使用非加密策略(non-cryptographicmethod)实现隐私保护聚集操作.KIPDA仅能较好地实现隐私保护MAX/MIN非线性聚集,PGAQ实现通用隐私保护近似查询,能完成的查询类型为Top-k查询、范围查询、SUM、MAX/MIN、Median、Histogram等查询.端到端加密查询方案使用基站与传感器节点共享密钥加密,将传感器节点采集的所有数据传输到基站,实现隐私保护查询,但是端到端加密查询方案不容易实现中间节点的聚集操作,而传感器网络中数据聚集融合是有效减少通信量的方法.PGAQ能够进行网内数据聚集,具有较大的改进和优化空间.在网络规模不同的3组实验中,分别考察了区间划分的数目(numberofranges)和采集数据的轮数(numberofrounds)对查询通信量CQ的影响.为便于描述,本实验假设1个时间单位传感器节点采集1轮数据,即查询周期t内采集t轮数据.本实验采用的参照向量长度m等于网内节点数n,以保证基站能够准确解出线性方程组,得到直方图信息.本实验中设KIPDA中参数k为5.图5~图7表述了在查询周期t为100时(即采①http://sensorscope.epfl.ch/index.php/Environmental_DataPage10集数据轮数为100次时),区间划分数h对传感器节点连续传输数据通信量的影响.可以看出:KIPDA和H-PGAQ通信量高于F-PGAQ通信量,KIPDA略高于H-PGAQ,这是因为F-PGAQ使用了过滤器机制,减少了通信量.在第1组实验中端到端方案通信量低于KIPDA和H-PGAQ,高于F-PGAQ.在第2组和第3组实验中,端到端方案通信量低于KIPDA和H-PGAQ,和F-PGAQ通信量曲线有交叉,第2组交叉点在h=175附近,第3组交叉点在h=100附近.区间划分数h对KIPDA和H-PGAQ影响很小,而F-PGAQ通信量随h增长而增长,这是因为区间划分数h决定了F-PGAQ中过滤器窗口的宽度,区间划分数h越大,F-PGAQ中过滤器窗口越窄,通信量越大,同时查询精度越高.数据值误差值εv与等宽直方图划分数h的关系为εv=(vmax-vmin)/h.图8显示了在采集数据值域为[-20,30]时,区间划分数h和数据值误差阈值的关系.图5区间划分数目对通信量的影响(n=20,t=100)图6区间划分数目对通信量的影响(n=50,t=100)图7区间划分数目对通信量的影响(n=88,t=100)图9~图11为在区间划分数h为100时,采集数据轮数t(即查询周期t)对传感器节点连续传输数据通信量的影响.可以看出通信量从高到低依次为KIPDA、H-PGAQ、端到端方案和F-PGAQ.KIPDA略高于H-PGAQ.KIPDA、H-PGAQ和端到端方案通信量高于F-PGAQ通信量,同样因为F-PGAQ使用了过滤器机制,减少了通信量.KIPDA、H-PGAQ、端到端方案和F-PGAQ都随采集数据轮数增长而增长,因为KIPDA、H-PGAQ和端到端方案没有使用过滤机制,所以随采集数据轮数增长基本呈线性增长.图9采集数据轮数对通信量的影响(n=20,h=100)图10采集数据轮数对通信量的影响(n=50,h=100)图11采集数据轮数对通信量的影响(n=88,h=100)Page117总结本文提出一种在传感器网络中基于聚集的通用隐私保护通用查询协议PGAQ.PGAQ使用网内求和聚集以减少能量消耗,并且能够通过调节直方图划分粒度来平衡查询精度与能量消耗.通过理论分析和使用真实数据集实验验证了PGAQ的安全性和有效性.PGAQ协议分为H-PGAQ和F-PGAQ两种模式.H-PGAQ模式使用数据扰动技术和单路Hash函数,这样即使聚集节点能够获得传感器节点和基站共享密钥,能够解密并获得基站下发的参照向量,聚集节点也不能计算出感知数据,增强了数据安全性,但是H-PGAQ需要所有传感器节点上传数据,连续查询时通信代价较高.F-PGAQ假设聚集节点不能够获取传感器节点和基站共享的密钥,使用参照向量进行隐私保护.F-PGAQ使用过滤器减少连续查询通信量,将直方图划分作为过滤器窗口,如果本轮采集数据与上轮采集数据落入同一直方图划分,则不需要上传数据,通过理论分析和实验验证,F-PGAQ显著减少了通信量和能量消耗.我们未来将进一步研究PGAQ参数优化问题,使得PGAQ在隐私保护能力、查询精度和能量消耗等方面更加优化和平衡.
