Page1因子分解假设的复合模广义迪菲赫尔曼问题的伪随机提取梅其祥1),2)李宝1)路献辉1)1)(中国科学院研究生院信息安全国家重点实验室北京100049)2)(广东海洋大学信息学院广东湛江524088)摘要研究怎样在因子分解假设下有效地提取复合模数上的广义菲赫尔曼问题的伪随机比特串.证明了Blum-Blum-Shub生成器是一个合适的广义菲赫尔曼问题提取器.利用Naor-Reingold-Rosen伪随机函数中的技巧证明:在因子分解假设下,对于任意的{1,2,…,n}上的真子集合A,即使公开了g∏i∈A(其中,g是平方剩余群QRN上的生成元,N为Blum整数).利用该结论,在因子分解假设下,可以得到不可区分意义安全的公钥加密和密钥交换协议.关键词随机提取;Blum-Blum-Shub生成器;因子分解假设;广义迪菲赫尔曼问题1引言复合模数上的广义迪菲赫尔曼(GeneralizedDiffie-Hellman,GDH)问题有一个很好的性质:其Page2计算的;当n=3时,给定ga1,ga2,ga3,ga1a2,ga2a3,ga1a3后,ga1a2a3是难以计算的.基于GDH问题,可以构造密钥交换协议和公钥加密[3-4].当n=2时,可以构造复合模数上的Dif-fie-Hellman密钥交换协议、复合模数上的ElGamal加密;n3时,可以构造复合模数上的多方Diffie-Hellman密钥交换协议.但是,直接应用GDH问题,所得方案只是在单向性的意义下是安全的,原因是我们只能保证g∏n码方案中,我们还需要由g∏n该会话密钥是在不可区分意义下是安全的.为此,我们需要一个GDH问题的密钥提取器来对g∏n行随机提取.一种方法是将通用散列函数作为的GDH问题密钥提取器[5].但这种方法需要假设判定性迪菲赫尔曼(DecisionalDiffie-Hellman,DDH)问题是难解的.还有一种方法是用难核预测器(hard-corepredi-cate)来作为密钥提取器[6].这种方法的好处是可以基于因子分解假设,缺点是一次模指数运算只能一次提取一个比特,因而效率太低,不满足实际需要.一个自然的问题是如何在因子分解假设下构造高效的复合模数上的GDH问题的密钥提取器.本文中我们证明了Blum-Blum-Shub(BBS)生成器[7]是复合模数上的GDH问题的满足前面要求的密钥提取器.大致地说,我们证明了,假设分解模数N是困难的,对于任意的[n]上的真子集A,即使给定g∏i∈A生成器BBSr(u)提取比特串(Br(u),Br(u2),…,Br(2K-1)),而Br(u)表示r与u的内积比特,〈u,r〉mod2.由于提取一个比特只需要一次模平方运算,因此,该提取器的效率很高.2构造和安全性定义2.1提取器的构造该提取器由密钥产生算法KGEBBS和密钥提取算法KEXBBS组成.KGEBBS:根据安全参数λ,KGEBBS随机地选取两个m(λ)比特的素数P,Q且满足P≡Q≡3mod4,取N=PQ(因此N是Blum整数);接着,KGEBBS从[(N-1)/4]随机地选取n(λ)个元素,用向量犪=i=1(a1,a2,…,an)表示;从QRN中随机地选取一个元素g,并随机选取一个与N等长的比特串r;最后,输出(g,犪,N,r).KEXBBS:根据输入(g,犪,N,r),KEXBBS计算长度为K的比特串K:K=BBSr(g∏nBr(g∏nBr(u)表示内积〈u,r〉mod2.2.2安全性对于上面的提取器,安全性要求对于任意的多项式时间攻击者M在下面的与挑战者C的游戏中获得的优势可以忽视:首先,M激起KGE询问,挑战者C运行接着,M激起若干次Observe询问,每次使用KGEBBS,将(g,N,r)给M;不同的[n]真子集,用A表示.C计算g∏i∈A给M;M发起Challenge询问,C随机地选取比特b,计算K0=KEXBBS(g,犪,N,r),并选取一个随机的比特串K1=(b0,…,bK-1),将Kb给M;最后,M输出一个比特b作为对比特b的猜测.M的优势定义为AdvIND1]-Pr[M(K1)=1]|.另外,我们用HJ验:该试验基本与上面定义的游戏相同,但对Chal-lenge询问的回答改为(b0,b1,…,bJ-1,Br(g2J∏n即前J比特与K1中相同,而后K-J比特与K0中相同.这样,H0与K0的分布相同,在HK串的分布与K1的分布相同.3安全性证明本节证明上节构造的提取器在因子分解假设下是安全的.证明可通过下面3个引理完成.引理1.如果存在一个多项式时间攻击者M在上节构造的提取器中可以获得的优势AdvINDBBS,M(λ)为ε(λ),则存在一个多项式时间攻击者D(v2,N,r,Page3α)可以区分α是Br(uw)或是一个随机比特b的优势为ε(λ).其中,u是唯一满足u2=v2的平方剩余,w是一个由v2和D所用的内部随机数决定的平方剩余,ε(λ)等于(ε(λ)-n(λ)O(2-m(λ)))/K.证明.给定输入(v2,N,r,α),D按如下进行定义:(1)当M激起KGE询问时,D从{0,1,…,K-1}随机选取J=k;随机地从[(N-1)/4]选取n个元素ξi(i=1,…,n),并用ξ=(ξ1,ξ2,…,ξn)表示;取s=K·n-k和g=v2smodN;将(g,N,r)给M;(2)当M用[n]的真子集A发起Challenge询问时,D定义每个ai=(ξi+2-K)modγ(i=1,…,n),其中γ=ord(g);D计算g∏i∈A作为回答;(3)M发起Challenge询问,D将下列比特串给M:b0,b1,…,bk-1,α,Br(g2k+1∏n2K-1∏nBr(g(4)当M输出一个猜测比特时,D输出同样的比特.我们需要证明D可以在关于参数λ的多项式时间内进行如上操作.显然,(1)和(4)可以在多项式时间内进行.(2)和(3)可以在多项式时间内进行被下面描述和证明的声称1和声称2、3所隐含.为此,我们先给出一些事实.事实1.由如上定义的D选择的g是QRN上一致分布的平方剩余,其阶γ为奇数.事实1的证明.由于P=Q=3mod4,所以P-12和Q-11)(Q-1)/4,所以|QRN|为奇数.而g的阶γ整除|QRN|,所以γ为奇数.由于(2,|QRN|)=1,所以QRN上的模平方是置换.由于v2是QRN上一致分布的平方剩余,而且一致分布元素的置换也是一致分布的,所以g=v2s是QRN上一致分布的平方剩余.事实2.对于每个0<i<s,g2-imodγ等于事实2的证明.因为g的阶γ为奇数,所以v2s-imodN.2-1modγ存在.注意到2-1modγ等于γ+1v2s,所以g2-imodγ等于v2s-imodN.平方剩余.事实3.u=g2-s是唯一满足u2=v2modN的事实3的证明.由于g=v2s,所以u2=(g2-s)2=v(2s·2-s·2)=v2modN.又因为2-1modγ等于γ+12,所以u=g2-s是平方剩余.但因为N是Blum整数,所以v2modN在QRN上的平方剩余根是唯一的,则u=g2-s是唯一满足u2=v2modN的平方剩余.声称1.对于任意的[n]的真子集A,D可以在多项式时间内计算g∏i∈A声称1的证明.设|A|=j,因为A是[n]的真子集,所以jn-1.设q(x)=∏i∈A由于D知道每个ξi,所以他可以按整系数计算出多项式q(x),从而计算出δi.因此,g∏i∈A因为s=K·n-k,ijn-1,kK-1,所以s-K·i=K(n-i)-kK-k1.又因为D知道v2,所以他可以计算v2(s-K·i).另外,由于D可以计算σi,所以,D可以计算∏j此,D可以计算g∏i∈A(v2(s-K·i))δi.而g∏i∈Ai=0定义w:我们定义w=∏n-1是多项式P(x)=∏n数范围的系数.由于D知道ξ=(ξ1,ξ2,…,ξn),所以他可以计算出每个βi.另外,D还被给定v2,所以,他可以计算如上定义的w.很显然,w是平方剩余,而且w由v2和D用来产生ξ=(ξ1,ξ2,…,ξn)内部随机数决定.声称2.对于如前面定义的(犪,g,u,w),有g2k∏nai=uw.声称2的证明.g2k∏ng2k-K·n+∑n-1uv∑n-1i=1Page4声称3.对于j=1,…,K-k-1,D可以计算Br(g2k+j∏n声称3的证明.由声称2知,g2k∏n于j=1,…,K-k-1,每个Br(g2k+j∏nBr((uw)2j)由于D知道v2和w,从而可以计算(uw)2j,进而计算Br((uw)2j).为了分析D的成功概率,我们下面证明D模仿的ai和g与实际定义的游戏中的ai和g统计不可区分.事实4.设ξi和ai是从[(N-1)/4]一致随机选取,令ai等于(ξi+2-K)modγ,则ai与aimodγ的统计距离为O(2-m(λ)).事实4的证明.由于γ整除Q-1)(P-1)/4,所以ai在事件ξi∈[(Q-1)(P-1)/4]的条件分布与aimodγ在事件ai∈[(Q-1)(P-1)/4]的条件分布是相同的,二者都是Zγ上的一致分布.另外,我们有Pr[ξi∈(Q-1)(P-1)/4])=所以,ai与aimodγ的统计距离为O(2-m(λ)).声称4.(犪modγ,g,N,r)与(犪,g,N,r)之间的统计距离为n(λ)O(2-m(λ)).声称4的证明.犪=(a1,a2,…,an)中每个元素都是从[(N-1)/4]中一致随机选取,而犪中的每个ai都等于(ξi+2-K)modγ.由事实4知,对于每个1in,ai与aimodγ的统计距离为O(2-m(λ)).因此,(犪modγ,g,N,r)与(犪,g,N,r)之间的统计距离为n(λ)O(2-m(λ)).由声称2我们知道,如果α=Br(uw),则M观察到的信息的分布与HJ机比特b时,M观察到的信息的分布与HJ+1一样.由事实1和D的描述,我们知道(g,N,r)被完美模仿.另外,由于犪=(a1,a2,…,an)中每个元素都从[(N-1)/4]中一致随机选取,所以,我们有|Pr[M(H0根据声称4,我们有|Pr[M(H0|Pr[M(H0n(λ)O(2-m(λ)).因此,D的优势为Pr[D(Br(uw))=1]-Pr[D(b)=1]=K∑K-11Pr[D(b)=1J=j]}=K∑K-11Pr[M(Hj+11KPr[M(H0Pr[M(HK-11{Pr[M(H0KPr[M(HK-1ε(λ)-n(λ)O(2-m(λ))由于引理1中定义的D自己选择ξ=(ξ1,ξ2,…,ξn),而w依赖于v2和ξ,这样,D每次被调用时,w的值有变化的可能.另外,D不是Br(uw)的预测器而是区分器.因此,D不适合直接作为Goldreich-Levin重构算法的预言机[6].为了克服第一个问题,我们将ξ=(ξ1,ξ2,…,ξn)在调用D之前就固定下来.为了克服第2个问题,我们将难核区分器归结为难核预测器.具体地,根据输入r,我们按如下定义难核预测器DN,ξ,v2:(1)一致随机选择比特α和β;(2)以〈v2,N,r,α〉为输入激起D,并将ξ给D(从而D不再自己产生ξ);(3)如果D输出1时,则DN,ξ,v2输出α,如果D输出0,则DN,ξ,v2输出β.这样,w的值不会随着DN,ξ,v2的调用而变化,因此,可以作为Goldreich-Levin重构算法的预言机来恢复uw.引理2.如果存在一个多项式时间攻击者M在上节构造的提取器中可以获得的优势AdvIND为ε(λ),则以概率ε(λ)/2(概率定义在N,v2,ξ的选取上),上面定义的DN,ξ,v2可以ε(λ)/4的优势(定义在r的选取上)预测Br(uw)的值,其中ε(λ)等于(ε(λ)-n(λ)O(2-m(λ)))/K.证明.根据引理1,D有ε(λ)的优势可以区分Br(uw)和随机比特b.因此,对于至少ε(λ)/2比例的随机选择中的N、v2和ξ,D有ε(λ)/2的优势区分Br(uw)和随机比特b.很显然,DN,ξ,v2可以以Page5ε(λ)/4的优势预测Br(uw).引理3.如果存在一个多项式时间攻击者M在上节构造的提取器中可以获得的优势AdvIND为ε(λ),则存在一个多项式时间算法A可以以概率Ω(ε(λ)2)分解N.证明.根据输入N,A可以按如下进行定义:(1)从[(N-1)/4]一致随机选择ξi(i=1,…,n),用向量表示为ξ=(ξ1,…,ξn);从ZN中一致随机选择v,计算v2modN;(2)计算w=v∑i=n-1项式P(x)=∏n合Z的)系数;(3)调用Goldreich-Levin重构算法R(1λ):当要求回答Bri(z)的值时,以ri为输入调用DN,ξ,v2,并以DN,ξ,v2的输出作为回答;用z表示R的输出;(4)计算u=zw-1modN.若R输出的值z等于uw,则一定有u2=v2modN,当u≠±vmodN,计算并输出gcd(u-v,N);若R输出的值z不等于uw,则输出“失败”.由前面引理知,以概率ε(λ)/2,DN,ξ,v2能够以优势ε(λ)/4来预测Br(uw)的值.根据Goldreich-Levin定理,R能够以概率Ω(ε(n)2)提取uw的值.注意到uw和w均是平方剩余,所以u也是平方剩余.因此,以概率1/2,u不等于±v.当u不等于±v时,gcd(u-v,N)是N的一个非平凡因子.所以,以概率Ω(ε(n)2),A能够分解N.应用举例.考虑一个二方密钥交换协议:甲方随机选取私钥a1,将A1=ga1发送给乙方;乙方随机地选取私钥a2,将A2=ga2发送给甲方;甲和乙的共同密钥为BBSr(ga1a2).根据我们的结论,即使攻击者看到了ga1,ga2后,甲和乙的共同密钥BBSr(ga1a2)仍然是伪随机的.从而这个密钥交换协议是被动攻击下不可区分意义安全的.我们再考虑一个三方密钥交换协议:甲方随机地选取私钥a1,将ga1发送给乙方;乙方收到ga1后,随机地选取私钥a2,将(ga1,ga2,ga1a2)发送给丙方;丙方收到信息后,随机地选取私钥a3,将(ga3,ga1a3,ga2a3)发送给甲方和乙方;根据各自的私钥,甲、乙、丙三方可以计算出共同密钥BBSr(ga1a2a3).根据我们的结论,攻击者即使看到了(ga1,ga2,ga3,ga1a2,ga1a3,ga2a3),甲、乙、丙3方的共同密钥BBSr(ga1a2a3)仍然是伪随机的,从而该密钥交换协议是被动攻击下不可区分意义安全的.4相关工作比较与之不同的是,在我们的方案中,安全性要求即在文献[8]中,BBS生成器被用作在因子分解假设下具有单向安全性的Rabin公钥加密方案的密钥提取器,得到了具有不可区分安全性的Blum-Goldwasser公钥加密方案.具体地说,他们证明了即使给定了u2K,BBSr(u)仍然是伪随机的.Naor、Reingold与Rosen基于BBS生成器提出了基于因子分解假设的伪随机函数[9].具体地说,他们提出的伪随机函数是BBSr(g∏nx2,…,xn)是X的比特表示,犪=(a1,0,a1,1,…,an,0,an,1),每个ai,j∈[(N-1)/4].其安全性要求即使攻击者获得了对于任意的Y≠X的BBSr(g∏nBBSr(g∏n使攻击者看到了g∏i∈ABBSr(g∏n计算BBSr(g∏i∈A计算g∏i∈A更多的信息.这个区别在公钥加密和密钥交换的应用非常重要:在公钥加密和二方密钥交换协议中,攻击者可以看到ga1和ga2.在多方密钥交换协议中,攻击者可以看到相应于[n]一些子集A的g∏i∈A在证明方法上,我们借鉴了NRR中的证明技巧.我们的证明与NRR中的证明都是分为3个步骤:第1步是将方案的安全性归结为难核区分器(hardcoredistinguisher);第2步将难核区分器归结为难核预测器;第3步将难核预测器归结为因子分解算法.在后两步的具体证明也基本相同.不同之处在第1步:在我们的证明中,对于攻击者的任意询问A,我们必须模仿g∏i∈A在他们的证明中,对于攻击者的任意询问Y,他们必须模仿BBSr(g∏n在2010年国际理论密码学年会上,Cramer、Page6Hofheinz和Kiltz得到了一个基于RSA假设的选择密文安全公钥密码方案[10].但他们需要一个在RSA假设(或更弱的因子分解假设)下的迪菲赫尔曼问题的提取器.即,他们需要一个提取器Ext满足:即使给定(gx,gy),Ext(gxy)仍然是伪随机的.而我们的结论说明了BBS生成器(取n=2时)正是满足这种要求的提取器.
