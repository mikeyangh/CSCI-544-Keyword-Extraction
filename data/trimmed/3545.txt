Page1基于高斯混合模型的Wyner-Ziv视频编码尹明蔡述庭谢云(广东工业大学自动化学院广州510006)摘要针对现有Laplacian模型不能精确描述相关噪声分布,分布式视频编码(DistributedVideoCoding,DVC)的率失真性能改善非常有限,文中提出一种基于高斯混合模型的分布式视频编码方法.首先分析了WZ帧与相应边信息之间相关噪声的统计特征,发现相关噪声信息的分布并不满足某种单峰分布,然后采用高斯混合模型(GaussianMixtureModel,GMM)对噪声系数直方图进行拟合,提出基于样本特征的EM(ExpectationMaximum)算法来估计模型参数.将提出的高斯混合相关噪声模型与相应的Laplacian模型进行比较,实验结果表明前者更能精确描述相关噪声的统计特征,基于该模型的DVC率失真性能优于基于Laplacian模型的DISCOVER方案,获得的平均增益接近1dB.关键词分布式视频编码;相关噪声;高斯混合分布;无线传感器网络;EM算法1引言随着以无线多媒体传感器网络(WirelessMul-Page2码器[1-2].然而,传统的视频编码技术(如H.26x、MPEG等面向广播视频应用类的方案)依赖于DCT变换和混合块运动补偿编码架构,其编码复杂度是解码复杂度的5~10倍,功耗较大,不再适用于新型应用场合.近年来,新兴的分布式视频编码(Distrib-utedVideoCoding,DVC)以其低复杂度的编码特性、良好的编码效率,满足了对编码的计算功率、内存有严格限制的应用需求,诸如无线视频传感器网络(wirelessvideosensornetwork)、多源图像捕获系统等,引起了人们强烈的兴趣[3-4].DVC建立在由Slepian和Wolf提出的分布式信源编码理论———Slepian-Wolf理论基础之上,Wyner-Ziv(WZ)视频编码是DVC的有损压缩形式.不同于传统视频编码技术的“联合编码、联合解码”压缩方式,Wyner-Ziv视频编码采用独立编码、联合解码的方式,可将运动估计、运动补偿等高计算复杂度的部分灵活地转移到解码端,使得编码器的复杂度大大降低[5],从而满足了无线传感器网络应用所要求的低复杂度.在编码效率方面,为了获得与传统编码技术近似等同的性能,Wyner-Ziv编码在解码器端利用边信息(SideInformation,SI)预测待编码帧X,边信息由已获得的关键帧和重构帧信息通过插补方式得到[6],被视作经过信道传输后得到的受噪声污染的待编码帧版本,而Wyner-Ziv编码的解码过程正是对受噪声污染后的帧纠错的过程.由分布式信源编码理论可知,预测的边信息SI越接近X,解码端用于纠错的校验信息就越少,编码器的压缩效率就越高且复杂度越低.因此,X与SI之间的密切关系表现为一种依赖关系,被视作虚拟相关信道.这种相关性体现为原始信号与边信息的差距(即相关噪声),而相关噪声模型(CorrelationNoiseModel,CNM)正是表征相关性的模型,其精确与否关系到对噪声分布情况描述准确与否,很大程度上影响着分布式视频编码率失真性能[7].目前,CNM模型的研究型主要集中在像素域和变换域(DCT域和小波域).文献[8]分析了像素域的编码码流,指出相关噪声的分布是随边信息的变化而改变,两者密切相关.Brites等人[9]针对像素域和变换域的Wyner-Ziv编码分别提出了帧、块、像素三级估计模型参数的算法,通过精确的CNM改善了编码效率.Slowack等人[10]考虑了量化噪声对SI帧精度的影响,并将此影响纳入到相关噪声模型的参数计算中,从而使得粗量化情况下WZ帧的码率最大降低了19.5%.Cheung等人[11]通过抽样方法研究了分布式信源编码的相关模型,建立了针对单二进制信源、多二进制信源及连续信源的模型,精确估计了模型中的各种参数,有效改善了编码效率.Huang等人[12]提出利用交叉频带信息来估计相关模型参数,可以有效改善率失真性能.Fang等人[13]研究了小波域中低频子带(LLsubband)相关噪声信息的分布情况,并采用拉普拉斯(Laplacian)模型逼近其分布,实验表明在高码率下RD性能优于像素域DVC.在国内,房胜等人[14]对影响时域相关噪声的因素进行了研究,提出了一种基于小波变换域的相关噪声模型VCMDWT,提高DVC系统的率失真性能达到2.6dB以上.王凤琴等人[15]发现其残差变换后直流系数带统计分布相比零均值拉普拉斯分布存在一定偏差,提出了一种基于变换域的相关噪声分布模型及自适应参数估计算法,有效提高了编码效率.然而,上述研究工作中均假定相关噪声分布服从Laplacian模型,工作大多集中在参数动态估计方面.虽然Maugey等人[16]采用幂指数模型(expo-nentialpowerdistribution)来拟合相关噪声,仿真表明编解码系统性能优于Laplacian模型,但没给出全面反映新模型的精度及率失真性能改善的实验结果.由于视频信息固有的非平稳特性和解码端不能获取当前帧信息等原因,相关噪声呈现非平稳特性.尽管Laplacian模型易于计算,但用于描述相关噪声概率分布并不精确,不能反映所有的视频运动模式可能性,从而增加WZ帧解码所需的比特数,导致Wyner-Ziv编码系统的效率损失,这正是其率失真性能难以到达传统运动补偿预测编码性能的症结之一[17].因此,本文深入研究了不同运动类型视频序列的原始帧与相应边信息之间噪声系数的分布情况,发现相关噪声信息的分布并不满足某种单峰分布,并利用高斯混合模型(GaussianMixtureModel,GMM)理论[18],提出了一种新的DCT域分布式视频编码系统的相关噪声模型.针对模型参数估计问题,提出了基于样本特征的期望最大(ExpectationMaximum,EM)算法.2相关工作2.1DCT域Wyner-Ziv编解码体系结构变换域Wyner-Ziv视频编码(TDWZ)是目前典型的分布式视频编码方案[4],图1给出了本文采用的DCT域Wyner-Ziv视频编码架构.它由量化器和Slepian-Wolf编码器(SWC)构成.在编码端,视频图Page3像帧通常被分为两类:关键帧(即Key帧)和WZ帧.Key帧采用传统帧内编码方法进行编解码,而WZ帧采用Wyner-Ziv编码.具体说来,Wyner-Ziv编解码系统的工作原理为:首先对序列X进行变换处理(如DCT变换)以去除图像空域相关性,然后对相应变换系数进行量化,产生量化符号流.量化后的符号流经由Slepian-Wolf编码器产生量化符号流的奇偶校验信息.在解码端,利用已解码帧进行边信息估计,得到边信息帧SI,结合Slepian-Wolf解码出的校验比特一起重构出WZ帧.一旦解码质量未达到误码率的要求时,Wyner-Ziv解码端会通过反向信道要求Slepian-Wolf编码器提供更多的校验信息.因此,当边信息SI越接近原始WZ帧,解码端用图1DCT域Wyner-Ziv编解码系统架构目前,常用的边信息生成方法是基于运动补偿内插算法(MotionCompensationInterpolation,MCI),其操作过程为:首先根据图像组结构确定用于生成边信息的参考帧(即前向参考帧和后向参考帧),通过运动搜索得到初始运动矢量信息,然后根据双向运动估计得到最佳运动矢量,通过交叠块运动补偿(OverlappedBlockMotionCompensation,OB-MC)方法生成边信息.利用式(1)求得最佳运动矢量:〈dx^,dy^〉=argmindx,dy∑i,j∈Ω(dxB,dyB)=-(dxF,dyF)=(dx,dy)/2(1)其中(i,j)表示像素的位置,XF和XB分别为待解码帧的前后两帧(已解码),Ω表示为当前块的像素集合.由此,获取前向和后向的最佳运动矢量dx^B,dy^()B、dx^F,dy^()F,进而生成边信息S(i,j):S(i,j)=1于纠错的所需校验信息就越少,这反映了边信息SI与原始WZ帧存在紧密的相关依赖.为了更好地利用边信息解码和重建WZ帧,相关噪声的分布情况变得非常重要.它不仅反映了虚拟信道的特性,还影响着解码端WZ帧的重构质量.但实际编解码过程中,原始WZ帧和SI分别出现在编、解码端,解码端无法获知原始信息,而编码端也只能以离线方式重构边信息或通过反向信道从解码端传输,进而增加系统计算复杂度及时延等诸多不利,这不符合实际应用需求.而且随着编码视频内容的变化,SI在时域和空域上动态变化,相关噪声亦呈现非平稳特性,尤其对于运动较复杂的序列边信息质量变差,因此对相关噪声的分布精确建模变得非常困难.其中,N(i,j)表示相关噪声.经过DCT变换后的边信息,一方面用于WZ帧解码,另一方面用于相关噪声建模.由式(1)可看出,如果前后运动补偿帧相差越大,所生成的边信息质量越差,则相关噪声越大.反之,边信息质量越好,则相关噪声越小.实际编码过程中边信息不会出现在编码端,解码端又无法获取原始帧信息,所以前后运动补偿帧之差往往被采用来描述相关噪声的概率分布[8-10].由式(2)得相关噪声N(i,j):N(i,j)=S(i,j)-X(i,j)在本文中,利用前后运动补偿帧之差R(i,j)来对相关噪声建模:Page4R(i,j)=|XB(i+dxB,j+dyB)-XF(i+dxF,j+dyF)|2.2图像系数的统计模型不少文献[7-10]对DCT系数的统计特性研究表明,其概率分布近似服从Laplacian分布,如式(5)所示其中,σ2为方差,μ为均值.然而,文献[19]研究表明,Laplacian模型并不是DCT系数概率分布的最佳逼近.文献[20]论证了Laplacian分布具有指数级的衰减,不适合具有重拖尾的样本数据.其它密度分布函数,诸如:广义高斯分布、高斯分布、伽玛(Gamma)分布、瑞利分布以及Laplacian分布都往往要求所拟合系数的概率分布具有单峰形式,即只有一个极大值.但实际中,不同的图像区域DCT系数可能包含多峰的概率形式,在特征空间中往往表现为多种分布的混合,很难把这种复杂的分布通过单一的参数化密度函数表示出来.而高斯混合模型(GMM)在拟合多种概率密度分布情况时,具有理论分析的可解析性,表现为较强的逼近能力[21].因此,本文将采用高斯混合模型来逼近DCT系数的分布,进而精确描述相关噪声信息.单变量的高斯随机函数:多变量的高斯随机函数:g(犡)=1其中,Σ为协方差矩阵,犝为均值矢量,犡为变量矢量,d表示高斯分布的维数.图像的高斯混合模型是不同的高斯函数的线性组合,其表达形式为其中,g(·)为高斯分布函数,ρm为第m维高斯分布的权值,M表示模型中高斯分布的总数量.混合高斯模型的参数集Θ=(ρ,μ,σ)可以使用期望最大(EM)算法估计得到.EM算法基本思想是利用训练数据X=(x1,x2,…,xn),从模型参数集的初始值Θ0开始,估计一个新的参数集珟Θ,使得新的模型参数再作为当前参数进行训练,这样迭代运算直到模型收敛.3相关噪声信息统计特征分析及建模本文对几种典型的视频序列的DCT残差系数的统计特征进行分析,重点比较Laplacian模型和高斯混合模型在DCT频带残差系数(亮度分量)分布上的拟合程度.在DCT域Wyner-Ziv编码系统中,相关噪声是边信息SI与原始WZ帧之差,其系数正是DCT残差系数.随着图像区域的改变,相关噪声呈现动态变化,其方差被视为一随机变量.这里使用斯坦福大学提供的仿真平台[19]来获取相关噪声数据.在仿真实验中,WZ帧采用规则LDPC作为Slepian-Wolf编码,符号节点的度为3,信息长度为6636比特.DCT变换采用8×8块,量化参数QP的选取尽量满足于使每一Key帧和WZ帧的PSNR值近似相等,保证重构出的图像近似平滑.实验选用了不同运动类型的标准视频序列Foreman、Football、Coastguard和Carphone,以QCIF格式和15Hz帧率进行编码,共100帧.从实际应用角度考虑,在线建模相关噪声信息无法获取原始图像帧.与文献[8-12,15]一致,本文利用前后运动补偿帧之差R(i,j)来对相关噪声建模.对式(4)所得帧差R(i,j)进行4×4DCT变换后,将频带系数分组形成频带组Rk(k=0,1,…,15),然后采用Laplacian模型拟合其分布情况.图2给出几种典型视频序列的补偿帧残差系数分布特征,每种序列采用所有的WZ帧进行统计.从图2可发现,在不同运动类型的视频序列中,系数频带中直流系数的均值不为零,方差较大,表明集中了图像大部分能量.而低频带均值近似为零,方差稍小,随着频率增加,系数分布越集中,方差越小,但分布与近似零均值Laplacian分布存在一定差距,尤其在尾部下降部分,出现了较严重拖尾,曲线下降较慢.因此,本文改进现有模型,直流频带系数近似服从Laplacian分布(均值不为零),其余频带系数采用GMM分布拟合,即f(Rk)=Page5Page6图2几种典型视频序列的DCT域残差系数分布特征(自左向右,自上向下分别为DC,AC1,AC2,…,AC15其中,λ槡=2/σ,μ=1表示高斯分布数量,ρm为每一高斯分布的权值,表示频带系数归属于不同的运动类型.Θ={μm,σm}为高斯分布参数集.一般来说,不同运动类型的图像帧所包含的运动量也会不同,当图像表现为运动剧烈时,则解码端图32种模型对DCT域残差系数分布拟合的比较前后向补偿帧的绝对误差较大,即残差系数所含能量就越高,在分布上表现为大方差系数.反之,当图像表现为运动平缓时,则解码端前后向补偿帧的绝对误差较小,即残差系数所含能量就越低,在分布上表现为小方差系数.为计算简便,本文假设噪声系数的方差可分作大小两类,即大小方差分别为σ2则高斯混合相关噪声模型表示为Page7f(x)=ρ0g0(x)+ρ1g1(x)=ρ012槡πσ0我们采用高斯混合相关噪声模型对残差系数进行了拟合,发现在低频分量部分,本文模型比Laplacian模型能更精确描述残差系数的分布.由于篇幅限制,仅给出部分代表性结果,如图3所示.图3给出了4种序列残差系数在低、中频带上的拟合情况.可看出,除均值附近的几个尖锐点外,GMM模型与系数真实分布的拟合程度非常好,出现概率较大的高斯分布方差小,代表了大量的小系数.而出现概率较小的高斯分布方差大,代表了少量的大系数,这完全符合DCT残差系数的特征.相比Laplacian模型,GMM模型在尾部下降部分能更精确地拟合噪声系数的分布情况,消除了Laplacian模型尾部下降过慢的现象,减少了解码所需的校验数据.4高斯混合相关噪声模型的EM算法在噪声分布建模中,残差频带系数构成观察空间,为不完备数据,而频带系数所描述的图像运动类型构成不可观察空间,为隐藏数据,两者构成完备数据可表示为F={(Rk,ρ),k∈(1,2,…,15)}.假设每个频带中样本数为N,高斯分布数为M=2,构造似然函数L(Θ;R,ρ):L(Θ;R,ρ)=∏N系数归属不同运动类型为m(m=1,2)类分布其中,Σ=σ200中的第i个系数.出现的后验概率为则期望(E)步骤的目标函数如下式所示(具体推导见文献[22]):Q(Θ|Θ(t))=E[lnL(Θ;R,ρ)]=∑Ni=1∑2最大化(M)步骤选择Θ(t+1),根据拉格朗日极值求解方法,得到参数求解的迭代公式:m=1Σ(t+1)上述方法是EM的标准算法,然而该算法收敛过慢,需要迭代多次,参数才能稳定,计算复杂度较大.因此,本文将直方图中对应频数不为零的每个系数(四舍五入整数化后)作为一个特征,利用残差的各个频带系数特征快速迭代求解模型参数,具体算法步骤如下:1.统计各个频带的系数,得到相应的特征总数N、每一特征值Rk,1,Rk,2,…,Rk,N及相应出现频数h1,h2,…,hN.2.修正式(15)~(17),得m=1Σ(t+1)基于特征的EM算法减少了样本数(NN),从而避免了重复计算,加速了迭代收敛,降低计算复杂度.同时,由于减少的样本均为零值系数,所以并不影响参数的最大似然估计精度.5仿真实验及分析为评估提出的相关噪声模型性能,本文选择了4组典型的视频序列进行测试,分别为Foreman及Soccer、Coastguard、HallMonitor,对应高、中及低运动程度的视频序列.序列均采用QCIF@15Hz格式,GOP长度为2.根据大多文献的评估方法,实验中仅评估亮度分量的率失真结果.Key帧采用H.264/AVC帧内编码(Mainprofile),依据表1所示量化参数量化,得到相应质量(RD)等级.边信息采用帧内插方式[23]生成,前后向运动估计搜索范围取±32个像素,运动补偿采用OBMC.目前RD性能最好的TDWZ系统是DISCOVER方案[24],而相Page8关噪声建模最好的方法为文献[9]所提出,其中相关噪声模型均采用Laplacian分布描述.因此本文将改进模型的性能与两者进行比较,作为性能评估.实验参考了文献[25]提供的部分源代码,采用C和Matlab混合编程.另外,实验中还选取了3种标准的编码方案H.263+Intra,H.264/AVCIntra,H.264/AVCInterNoMotion进行率失真性能比较,用以说明与最好的传统视频编码技术性能的优劣.最后,本节比较了采用改进模型带来的计算复杂度.表1对应不同质量水平的Key帧的量化参数序列Q1Q2Q3Q4Q5Q6Q7Q8Foreman4240393635333126Coastguard3938383534333127HallMonitor3736353332312925Soccer4544423838353126图4几种典型视频序列的率失真曲线(GOP=2)随着码率的增加,噪声模型对DVC性能的增益越大,但对于高运动序列来说,由于高码率减轻了解码对模型精度的依赖,增益反而减小.对比其它3种标准编码方案,对于低运动序列来说,其性能可以与H.264/AVCInterNoMotion相当,超过帧内(In-tra)编码的方案.但对于高运动和复杂的视频来说,所提出的Wyner-Ziv编码在率失真性能方面仍存在较大改善空间,尤其是包含剧烈运动的Soccer序列.5.2模型复杂度分析模型精度是其性能的一方面,而计算模型参数5.1模型RD性能分析从图4所示的率失真性能曲线,相比Laplacian模型,本文提出的高斯混合相关噪声模型能更精确地描述相关噪声,基于该模型的DVC率失真性能优于DISCOVER方案[24]和文献[9]的方案,其中平均增益接近1dB,对于HallMonitor序列最大增益可达到1.48dB.对于运动平缓的图像序列(如HallMonitor),由于解码端前后向补偿帧的绝对误差较小,利用残差系数训练的高斯混合相关噪声模型更精确地反映了虚拟信道的模型,在同等质量下,用于纠错的比特数较少,解码端获得了更高的增益.而对于运动较剧烈的图像序列(如Soccer),解码端前后向补偿帧的绝对误差较大,无法有效建模,所需纠错比特数增加,改进模型获得的率失真增益较小.的复杂度也关乎于改进编解码算法在实际应用中的效果.在解码端,本文利用基于样本特征的EM算法估计GMM模型参数,由于EM算法是一种最大似然参数估计方法,需通过多次迭代运算来实现最优参数估计,其中GMM模型的维数和样本集的大小是影响计算的复杂度的两个重要因素.因此,将其引入到Wyner-Ziv编解码系统必然引起运算复杂度的增加,本节将讨论改进模型方案与DCT域Wyner-Ziv解码的运算复杂度不同.解码使用3.4GHz主频和2.048GBRAM内存Page9的PC机,代码的软件环境为VisualStudio2008,其它条件与性能评估时相同.表2给出了以运算时间为准则的解码复杂度对比.可以看出,利用EM算法估计GMM模型参数确实引入了较大的计算复杂度,但Wyner-Ziv编码架构的主要目标是寻求“编表2不同方法解码时间比较RD点Q1295.151284.62240.671238.10723.661732.80508.561563.1Q2408.771411.36322.451322.50897.621899.02634.591602.3Q3475.671475.01371.001372.201010.782021.64709.721700.0Q4794.651799.32564.221564.871651.632651.211178.802183.6Q5820.481817.32605.841605.001771.772699.301290.302299.0Q61257.992259.03869.161872.202316.643362.001802.902803.1Q71668.902675.991055.602101.302949.723801.982328.303327.8Q83090.834102.121712.802799.014775.635799.203873.804872.96总结针对分布式视频编码中相关噪声的分布并不满足某个单一密度分布,现有Laplacian模型不能精确描述相关噪声的分布,本文利用高斯混合模型(GaussianMixtureModel,GMM)理论,提出了一种新的DCT域分布式视频编码系统的相关噪声模型.同时,针对EM算法估计模型参数存在收敛过慢的问题,提出了基于样本特征的改进EM算法.实验结果表明,相比Laplacian模型,本文提出的高斯混合相关噪声模型能更精确地描述相关噪声,基于该模型的Wyner-Ziv编码率失真性能优于DIS-COVER方案.然而,对于包含大运动和复杂运动的视频来说,本文提出的编码方案在率失真性能方面,相比H.264/AVCInterNoMotion,仍存在较大改善空间.此外,寻求低复杂度的优化GMM模型参数估计也是本文需进一步的工作.
