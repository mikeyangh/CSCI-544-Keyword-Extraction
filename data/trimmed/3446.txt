Page1基于数字化光顺性指标的NURBS曲线自适应光顺王爱增1),2)赵罡1),2)穆国旺3)1)(北京航空航天大学虚拟现实技术与系统国家重点实验室北京100191)2)(北京航空航天大学机械工程及自动化学院北京100191)3)(河北工业大学理学院天津300401)摘要目前曲线曲面光顺算法大都基于手工操作,自动化程度低,难以对曲线曲面进行自适应光顺.针对此问题,文中给出一种数字化光顺性指标SValue的定义,基于此定义,提出了一个对NURBS曲线自适应的光顺算法.该算法通过对曲线小波分解,得到其尺度部分和细节部分.然后压缩细节部分得到光顺后的曲线,通过计算SValue来评定曲线的光顺效果.最后递归光顺曲线,直到满足光顺要求.与其它光顺方法相比,该方法不仅直观,而且光顺效果更佳,算法的自动性和自适应性更好.关键词光顺;B-样条小波;曲线曲面1引言曲线曲面的光顺处理是计算机辅助设计中的一个重要问题,特别在汽车、船舶、航空等行业中有重要的应用.从产品的角度来说,设计产品的几何光顺性对产品的质量以及产品的几何美观性等会产生重要的影响.因此光顺问题在CAGD中有重要的理论Page2和应用价值,引起人们的广泛关注,但由于光顺问题的复杂性,直到现在仍没有得到彻底的解决,对它的研究仍在进行之中.曲线曲面的光顺性是一个比较难以界定的概念.所谓的光顺准则即为判定曲线曲面光顺的依据,从目前发表的文献来看[1-6],在光顺中经常使用的曲线曲面光顺准则都为定性判断,通常根据曲线曲面上的曲率变化是否均匀等来判断.这些方法作为光顺准则时遇到了以下两个问题:(1)由于对光顺性的判定均为定性判断,难以实现自动判定;(2)无法在不同的曲线或曲面之间进行光顺性比较.针对以上两个问题,本文定义了一种数字化光顺性指标SValue,根据SValue的性质可以对曲线曲面的光顺性进行定量计算,也可以对不同曲线曲面的光顺性进行比较,从而达到了对曲线曲面光顺性进行自动判定的功能.基于此定义本文设计出一种曲线曲面自适应光顺算法.传统的曲线光顺处理方法大致可以分为三类:基于节点删除-插入的光顺[1,7]、基于能量法的光顺[8-10]和基于小波技术的光顺[11-12].基于节点删除-插入的光顺方法一般采用交互的方式确定“坏点”,这类方法主要基于手工操作,自动化程度低,当坏点较多时,光顺效果并不理想.随后出现的一些关于能量法的光顺算法,其光顺曲线时在某些情况下会导致曲线形状改变较大,另外当控制点较多时计算量较大,并且在光顺时不具有自适应性.基于小波技术的曲线曲面光顺算法是近些年出现的.早期,Cho等人[11-12]提出了如何在小波变换过程中保持边界不变的光顺算法;Lyche等人[13]构造出了具有最小支撑区间的非均匀B样条小波;赵罡[14]提出了基于数据压缩特性的保持边界参数连续的准均匀B样条曲线曲面的小波变换算法;Amati[15]提出了一种新的基于小波技术的曲线光顺算法,但由于该算法基于手工方法选择坏点,算法效率较低;2010年Wang等人[16]提出了一种基于小波的NURBS曲线的简化和光顺算法(本文简称为Wang算法),该算法虽然提高了计算效率,但它是一种整体光顺方法,且不具有自适应性.上述光顺算法大都基于手工操作,自动化程度低,难以对曲线曲面进行自适应光顺.针对这个问题,本文在给出数字化光顺性指标SValue定义的基础上,根据SValue的性质,提出了一个对NURBS曲线的自适应光顺算法,该算法在光顺时达到了自动性和自适应性.2犛犞犪犾狌犲的定义及其性质曲线曲面现有的光顺准则在对光顺性进行判断时都属于定性判断,难以通过计算机来达到自动判断曲线曲面光顺性的目的.针对这些不足,本文通过SValue的性质,给出了一种定量判定光顺性的方法,并由此可以在计算机上自动判定曲线曲面的光顺性.对NURBS曲线进行小波分解得到下式:写成矩阵形式如下,其中ΦL表示由原B样条基函数定义的行向量,犆L表示原控制顶点构成的列向量,犆L-1和犇L-1分别对应尺度部分和小波部分控制顶点,犘L和犙L为相应的重构矩阵.我们称犘L犆L-1为曲线的尺度信息,称犙L犇L-1为曲线的细节信息.对于非均匀B样条小波分解需要首先选取原节点矢量的一个子序列,在本文中选取子序列的原则是对内节点隔一取一,如图1所示.其中,○表示保留对应的节点;●表示移除相应的节点.SValue相对于曲线的定义:(1)小波分解时取子序列为原偶节点序列,计算SEven=∑犙L犇L-1(2)小波分解时取子序列为原奇节点序列,计算SOdd=∑犙L犇L-1∑犘L犆L-1+∑犙L犇L-1.(3)SValue=SOdd+SEven显然SValue具有以下性质:性质1.0SValue1.由SValue的定义可知0SValue1.性质2.SValue的值越小,曲线越光顺.由定义可知∑犙L犇L-1表示曲线细节信息的总和,∑犘L犆L-1表示尺度信息的总和.SValue越大,说明曲线包含的细节信息越多,曲线越不光顺,SValue越小,表示曲线细节信息相对越少,曲线就越光顺.同样对于曲面控制顶点进行小波分解,可以得到Page3犌ΦLuΦLv=犘Lu犌ΦLu-1ΦLv-1(犘Lv)T+犘Lu犇ΦLu-1ΨLv-1(犙Lv)T+犙Lu犇ΨLu-1ΦLv-1(犘Lv)T+犙Lu犇ΨLu-1ΨLv-1(犙Lv)T犌ΦLuΦLv为原曲面控制顶点构成的矩阵,犌ΦLu-1ΦLv-1为小波分解后尺度部分对应的控制顶点矩阵,犇ΦLu-1ΨLv-1,犇ΨLu-1ΦLv-1,犇ΨLu-1ΨLv-1为小波部分对应的控制顶点构成的矩阵.犘Lu,犘Lv,犙Lu,犙Lv为相应的重构矩阵.通过重构矩阵,把分解后的控制顶点插值为原节点矢量下的形式.定义A=∑犙Lu犇ΨLu-1ΨLv-1(犙Lv)T+B=∑犘Lu犌ΦLu-1ΦLv-1(犘Lv)T其中A代表曲面细节信息的总和,B代表曲面尺度信息的总和.SValue相对于曲面的定义:(1)小波分解时取子空间由原两个参数方向中的偶节点序列构成,计算SEven=A(2)小波分解时取子空间由原奇节点序列构综上,由SValue的性质可以得到:(1)定量判定线面的光顺情况;(2)可以任意比较不同曲线曲面间图2曲线1和曲线2的比较成,计算SOdd=A(3)SValue=SOdd+SEven与SValue的曲线定义类似,SValue的曲面定义同样具有性质1和性质2.性质1.0SValue1.性质2.SValue的值越小,曲面越光顺.在对曲线曲面进行小波分解时,曲线曲面可被分解为尺度部分和细节部分,一般情况下细节部分代表了不光顺信息,尺度部分代表了光顺信息,如果细节部分的信息占的比重越大,曲线曲面就越不光顺.图2(a)、(b)分别是曲线1和曲线2,图2(c)、(d)分别是其对应的曲率图.由光顺准则[2]可知曲线1没有曲线2光顺.计算得到两条曲线的SValue值,SValue(1)=0.0668,SValue(2)=0.0070,其中SValue(i)表示曲线i的SValue值,SValue(1)>SValue(2),由SValue的性质可知曲线1的光顺性没有曲线2的光顺性好,这与通过光顺准则[2]得到的结果是一样的,但光顺准则[2]却不能自动判定,有很大的局限性,而本文方法却可以由计算机自动判定给出比较结果.的光顺性.由此可以在计算机上自动判定曲线曲面的光顺性,而这些都是其它光顺准则所不能达到的.Page43基于犛犞犪犾狌犲的NURBS曲线自适应光顺算法3.1自适应光顺算法根据SValue的性质,本文给出一种NURBS曲线的自适应光顺算法.通过对曲线进行小波分解,得到相应的尺度部分和细节部分,然后压缩细节部分,去除了曲线的不光顺部分.对修改后的细节部分进行重构,得到光顺后的曲线,同时计算曲线的SValue,由SValue评定曲线的光顺效果,最后递归光顺曲线,逐次提高曲线的光顺性,直到满足光顺要求.具体步骤如下:1.对原曲线进行非均匀B样条小波分解,分别计算SOdd,SEven.顺性就越好.2.计算SValue=SOdd+S()Even/2,SValue值越小,光3.对细节部分进行整体或局部压缩,如果SValuek,对细节部分进行整体压缩,其中k为一设定值;如果SValue<k,对细节部分进行局部压缩,每次只对细节部分的极值元素进行压缩.4.对修复后的细节部分进行小波重构得到光顺后的曲线.5.计算光顺后曲线的SValue,评定曲线的光顺性,如果SValue<α,α为一设定值,则光顺自动结束;否则进行递归光顺,直到达到光顺性要求或满足递归终止条件(超过误差限或递归次数).3.2误差估计本文我们用error=∑C-L两条曲线间的误差.设γL(u)=ΦL犆L是原曲线,L(u)=ΦL犆-L是光顺后得到的曲线,则我们可以根γ-据光顺前后控制顶点的变化情况直接估算曲线误差,证明如下:maxγL(u)-γ-=max∑n(因为∑n[d0,d1,…,dn]T,m=maxidi0in.整体误差我们可以用error=∑C-L似表示.在两条曲线比较接近的情况下,两条曲线间的i=0本算法通过修复细节部分,并根据SValue的值评定光顺效果以及选择整体或局部光顺,达到自适应光顺曲线曲面的目的,而且用户可以利用本算法实现对NURBS曲线的自动光顺.4算法实例本节对两组曲线数据进行光顺试验.图3(a)是原曲率图,图3(b)~(f)是本算法逐次光顺得到的曲率图.图3(g)是原曲线,该曲线是具有35个控制顶点的三次非均匀B样条曲线.图3(h)是本算法五次递归光顺后得到的光顺曲线.图3(i)是Wang算法光顺后曲线,图3(j)是其对应的曲率图.与原曲率图3(a)相比较,Wang算法有一定的光顺效果,如图3(j)所示,而我们的算法在递归五次后就可以达到比Wang算法更好的光顺效果,如图3(f)所示,且有更小的光顺误差(error(Wang算法)=22.8522,error(本算法递归五次)=17.1436).由图3(k)和(l)可知,我们算法达到了对曲线局部光顺的效果.图3(m)是用局部光顺方法对原曲线光顺的结果[15],图3(n)是其对应的曲率图,比较图3(a)和图3(n),由光顺准则[2]可知,文献[15]方法对原曲线有一定的光顺效果.但通过曲率图3(f)和图3(n)由光顺准则[2]可知,本文方法对曲线的光顺效果要优于文献[15]的局部光顺方法.由表1可知,通过本算法递归光顺,曲线的SValue是逐渐减小的,同时由对应的曲率图3(b)~(f)可知曲线也变得越来越光顺,即通过递归光顺,我们算法可以逐次达到更加光顺的效果.递归次数对于另外一个例子,图4(a)是原曲率图,图4(b)、(c)是本算法逐次光顺曲率图,图4(d)是具有28个控制顶点的原三次B样条曲线.当用能量法对其进行光顺时,如果约束条件给的不好,原曲线会被光滑成一条直线,如图4(e)所示.图4(f)为经过本算法一次递归光顺后曲线与原曲线的比较图,图4(g)是其局部放大效果.图4(h)为本算法两次递归光顺后曲线与原曲线的比较图,图4(i)是其局部放Page5图3本算法对曲线的逐次递归光顺效果Page6图4本算法对曲线的自适应光顺效果大效果.由图可知本算法只在原曲线不光顺的地方进行光顺处理,而原曲线相对光顺的区域则保持不变,从而本算法达到了对曲线自适应光顺的效果.由表2可以看出,应用本文光顺算法,每次递归光顺后曲线的SValue值是逐渐减少的,同时由曲率图4(a)~(c)可知曲线的光顺性也变得越来越好.由以上可知,根据SValue的性质可以有效地判定曲线的光顺性.递归次数本算法通过递归光顺,可以使曲线达到更好的光顺性,通过引入SValue,达到了自动评定曲线的光顺性、自适应光顺曲线的目的.Page75结论光顺问题在几何造型和制造加工中的重要性不言而喻,但关于曲线曲面的光顺必须要解决以下两个基本问题:(1)针对目前光顺算法主要基于手工操作、自动化程度低的特点,如何对曲线的光顺达到自动性;(2)如何对曲线进行自适应光顺,把整体光顺方法和局部光顺方法相结合.针对这两个问题,本文给出数字化光顺性指标SValue的定义,根据SValue的性质给出一个在计算机上自动判定曲线曲面光顺性的方法.同时依据SValue的性质提出了一个NURBS曲线的光顺算法,与其它光顺算法相比,本算法光顺效果更佳,且本算法的自动性和自适应性更好.
