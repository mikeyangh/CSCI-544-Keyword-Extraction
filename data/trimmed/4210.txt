Page1智能空间下基于时序直方图的人体行为表示与理解尹建芹1),2)田国会1)周风余1)1)(山东大学控制科学与工程学院济南250061)2)(济南大学信息科学与工程学院山东省网络环境智能计算技术重点实验室济南250022)摘要为了实现在智能空间下理解人体行为,该文提出了一种基于时序直方图的人体行为表示方法,并设计了基于softmax回归分析的行为理解算法.将传感器的输出状态所对应的离散值的编号定义为事件项;提出了事件直方图的概念以表征事件项的发生频率,提出了时序直方图的概念以表示传感器序列的时序信息;为了降低过拟合的风险,设计了时序模式选择算法以得到候选特征集,基于互信息准则进行特征选择,完成行为的表示;最终,基于选择的特征子集及softmax回归分析实现了人体的行为理解.实验结果表明,该文提出的特征表示方法可以较好的表示外部传感器序列捕获的人体行为模式,同时softmax回归分析可以较好的实现人体行为的理解,并取得了良好的效果.关键词智能空间;人体行为理解;直方图;softmax回归;物联网1引言近年来,低成本、低功率和高鲁棒性传感器的大量涌现,使得物联网技术得到了快速发展.智能空间是物联网技术的一个重要应用.同时,老龄化问题已经成为当前亟待解决的一个重大社会问题,而人力资源的匮乏和越来越高的劳动力成本,使得空巢老人的照料问题越来越突出,急需要研究人体行为的表示与理解技术:通过在家庭环境中构建智能空间,并以智能空间中所捕获的传感器序列为基础,研究人体行为的表示与理解方法,实现人体行为识别,用以辅助老年人的日常生活,从而达到提高老年人独立生活的安全感和舒适感的目的.为了解决智能空间下的人体行为理解与识别问题,本文提出了事件直方图及时序直方图的概念,设计了时序模式选择算法对特征进行初步选择;然后,以互相关作为分类的衡量准则,实现时序模式的最终选择;最后,利用softmax回归分析实现了人体的行为理解.基于本文算法,一方面避免了常用概率网络中需要寻求独立性和依赖性关系的缺点,另一方面得益于本文的时序模式选择算法,不仅可以有效去除噪声的影响,也可以寻求具有最优判别力的不同阶时序关系.实验结果表明,本文提出的算法在多个公用的行为测试集上均取得了很好的识别效果.本文第2节介绍相关工作;第3节给出外部传感器序列的事件项及事件直方图的概念;第4节给出时序直方图的概念;第5节提出特征选择及行为表示的方法;第6节讨论基于softmax回归的人体行为理解方法;第7节给出相关的实验结果和讨论;第8节对本文工作和以后的工作进行评述.2相关工作近年来在家庭环境中构建智能空间辅助人的日常生活已成为国际上的一个研究热点[1],如麻省理工学院人工智能实验室(MITAILab)的IntelligentRoom、佐治亚技术理工学院(GIT)的AwareHome、微软研究院(MicrosoftResearch)的EasyLiving[2].其共同的目的是利用机器学习和普适计算技术,完成对人体日常行为的理解与识别,从而使老人可以在家里独立的生活.在普适计算领域,通过传感器来测量用户的运动、位置以及人与环境和物品的交互,从而完成人的行为理解,常用的传感器有3类.(1)外部传感器.Tapia等人[3]将接触开关传感器安装于窗、冰箱、微波炉等家用物品上来获取人与环境和物品的交互信息,从而捕获人体行为模式;Logan等人[4]在接触开关传感器的基础上,添加了红外运动传感器更好的监测人体行为;Wilson等人[5]利用接触开关、红外运动传感器和压力传感器实现了人与环境及物品交互的刻画.(2)可穿戴传感器.Gu等人[6-8]通过将3-轴加速度计穿戴于人体上,实现了人体行为的描述;Stikic等人[7]利用腕式RFID捕获人与物品的交互信息,将读写器戴在手腕上,将标签粘贴于物品上或环境中,通过RFID信息判定人的行为.(3)环境状态监测传感器.采用环境状态监测传感器,如温度传感器、湿度传感器和光照传感器等作为外部传感器和可穿戴传感器的有效补充,进行人体行为的描述[8].由于可穿戴式传感器需要穿戴在人身上,具有不方便且有辐射等缺点.因此,基于外部传感器的方法近年来得到了广泛的应用,而环境状态监测传感器同样安装于外部环境中.因此,大多数工作将其与第1类的外部传感器不做区分,将它们统称为外部传感器[9-10].本文采用该类传感器完成行为信息的捕获.在行为表示和理解方面,由于捕获的传感器数据噪声较大,基于概率网络的方法取得了广泛应用.Tapia等人[3]采用滑动窗口内的传感器的状态值序列作为特征向量,利用朴素贝叶斯网络进行行为建模,将传感器序列中的每个传感器独立建模;Kim和Kasteren等人[11-12]将每个传感器的状态作为特征,利用隐马尔可夫模型(HiddenMarkovModels,HMM)进行行为建模,通过状态转移函数加入时间信息;由于动态贝叶斯网络(DynamicBayesNet,DBN)比HMM具有更好的可分解性和可扩展性,推理更方便等优点,Philipose等人[8]同样将每个传感器的状态作为特征值,利用DBN进行人体的行为理解;HMM与DBN等生成式模型需要确定变量之间的独立性和依赖性,而这种独立性与依赖性的建立与寻求是比较困难的.因此,Vinh等人[13]利用判别式模型条件随机场(ConditionalRandomField,CRF)进行了行为建模;Wongpatikaseree等人[14]采用本体论的方法对人体行为进行识别,但基于本体论的方法在处理不确定性和噪声方面会受到限制.Page3基于概率网络的方法虽然可以在一定程度上克服噪声的影响,但无法很好的描述人体行为这种随意性较大的时序模式中所包含的变阶时序关系;另一方面,此类方法重视机器学习的设计,其期望学习机器自动的完成特征选择与分类,对于数据本身分析不多;但事实上,分辨力不足的特征的加入会影响分类器的性能[15].因此,一部分研究者开始重视对数据本身的分析[6,16-17],Gu等人[6]利用出现模式(EmergingPattern,EP)提取类别之间数据的差异来进行人体行为的识别,Aztiria等人[16]通过数据挖掘的方式对用户与环境的交互进行建模,Xin等人[17]通过建模行为的相似性来进行行为检测与识别.本文同样侧重对数据的分析,提出了一种新的人体行为特征抽取方式,该抽取方式既考虑了传感器序列数据中的时序信息,又可以避免寻求其独立性和依赖性关系,同时利用特征选择机制可方便地得到具有最优鉴别力的不同阶时序关系.我们在以往的工作中提出了事件与事件直方图的概念,并利用(Karhunen-Loeve,KL)变换对行为进行了识别,取得了良好效果,初步验证了以事件直方图表示行为的有效性[18].但其定义的事件及事件直方图只考虑了开关传感器,而在进行行为表示时,有时需要模拟量传感器.因此,本文基于开关传感器和模拟量传感器,重新定义了事件及事件直方图的概念.针对外部环境传感器获取的数据,将传感器状态的编号抽象为事件项并基于事件项构造了事件直方图;另一方面,事件直方图忽略了时序信息,为了结合时序关系,本文提出了时序直方图的概念,以事件直方图和时序直方图为基础,设计了时序特征选择算法得到候选特征集,并采用互信息进行特征选择从而进行行为表示,利用该特征子集,以softmax回归实现人的行为理解.3事件项及事件直方图人体行为所触发的传感器序列具有不定长的特点,这加大了人体行为理解的难度.受图像灰度直方图的启发,定义了事件直方图.设传感器可能的状态有M种,为了建模这种传感器数据,提出事件项及事件直方图的概念.3.1事件项定义1.事件项.为传感器触发的每一种可能的状态指定一个唯一的编号,将该编号定义为事件项.按照定义1,二值传感器对应的输出可以直接映射为事件项[18],而对具有连续输出的传感器,需要将这些连续量映射为离散量,如例1.例1.如果在火炉上安装温度传感器,指定该传感器的ID,由于温度传感器输出的是连续值,需要将连续变量映射为离散变量,即获取传感器的离散状态量及其对应的事件项.3.2基于高斯混合模型的事件项获取认为某一传感器的输出值服从高斯混合模型犕,用随机变量X来代表传感器输出,由于采用的外部传感器输出的大多是一维数据,则X的概率密度可以表示为:p(x犕)=p(xK,θk)=∑K其中,∑Kk=1方差.给定传感器的N个观测值={x1,x2,…,xN},为了得到高斯混合模型,需要确定高斯分量的结构参数K以及每个高斯成分的参数均值和协方差矩阵.为了使混合模型能最好地描述原始数据,本文采用极大似然估计来描述模型对数据的拟合能力,将混合高斯模型与描述极大似然估计的代价函数联系起来,定义代价函数如式(2).其中,K决定了混合高斯模型的结构,αk,μk,σk决定了混合高斯模型的参数.首先设K为已知,对于混合高斯模型的参数估计,可以看作是其所属类别未知的参数估计,而对于具有隐变量的参数估计,常用的方法是期望最大化算法(ExpectationMaximal,EM).针对我们的问题,迭代进行E步和M步,直至收敛.E步:w(i)w(i)j其中,zi=j,表示xi是第j个高斯分布所生成的数据.M步:Page4如果对K不加限制,显然K越大,模型能够越好地描述数据集,但此时模型复杂度较高,过拟合风险加大,从而会影响模型的推广能力,Fraley和Raftery采用层次化聚类以解决该问题[19].本文采用类似的方式,引入贝叶斯信息准则来权衡数据的描述能力和模型的复杂度:其中,2K为模型中要估计的独立参数的个数,N为数据集的大小.从式(5)可以看出,其第1项对应的是负似然函数,该函数越小,说明模型对数据的描述能力越强;第2项对应模型的复杂度,对于具有K个成分的混合高斯模型,其独立的参数有2K个,为了使模型具有好的推广能力,希望K越小越好,将式(2)代入式(5),得BIC=-2∑N选定K的最大值Kmax和最小值Kmin,从Kmax开始,按照EM算法估计模型的参数,依次递减,直到式(6)取最小或到达Kmin时结束,选择BIC最小的模型作为最终模型.此时得到的K即为状态数M,对应得到的均值μk是其状态,将μk映射到自然数集,即μk→{1,2,…,M},并以该集合为基础构造传感器的事件项.定义2.事件直方图.事件直方图是事件项的函数,描述的是行为中发生的事件项的次数.对于开关量传感器,其可能触发的事件项个数M=2,对于模拟量传感器,其可能触发的事件项个数M需经过离散化后才能得到.给每个传感器指定唯一的ID,记作SensorID,传感器输出状态记为SensorValue,其中SensorValue∈{1,2,…,M},一般情况下,SensorID为顺序编码的自然数集,其最小值取1,最大值取为SensorNum(SensorNum为所用的传感器数目),即{1,2,…,SensorNum}.对应的事件项通过计算∑SensorID-1不同长度的行为序列经过直方图变换后,得到(指定M0=0,对于M0的加入,只是为了得到一种简洁的表示形式),从而将传感器的每个离散状态映射为一个唯一的编号.相同长度的特征序列.例2.设环境中共有5个传感器,传感器的ID分别为SENSOR1,SENSOR2,SENSOR3,SENSOR4,SENSOR5,得到长度为9的传感器序列如下.SENSOR5ONBedbeginSENSOR2ONSENSOR2OFFSENSOR1OFFSENSOR2ONSENSOR2OFFSENSOR4ONSENSOR320.4SENSOR4OFFBedend从例2可以看出,该行为序列对应触发的传感器中,有4个是开关量传感器,1个模拟量传感器,假设对模拟量传感器的训练数据中,已经计算出M=3,且其中μ1=20,σ1=5,μ2=38,σ2=3,μ3=50,σ3=4,则得到状态序列为[10221001101].由于人体行为具有随意性和相互交织性,同一行为所对应的不同实现往往长度不一,每一个事件项出现的次数也不一定相同,并且差异可能还比较大,通过采用归一化事件直方图的办法,可以较好地克服该随意性.同时,对于布置了外部传感器的室内环境来讲,不管序列长度为多少,最终得到的事件直方图的长度都是一样的.4时序直方图事件直方图对于描述人体行为具有重要意义,但同灰度直方图类似,忽略了时间信息,即缺少时序性.由于用于人体行为理解的外部传感器一般安装在室内环境中一些关键的区域,如床、门等部位.当目标在这些特定区域运动时,相应的传感器被触发,可以得到对应了这些关键区域的遍历序列,而这些序列的时序关系对于正确的行为理解非常重要.为了建模这种时序关系,本文提出了多阶时序直方图的定义,并将事件直方图作为0阶时序直方图.定义3.时序直方图.将n个事件项序列作为横坐标,n个事件项序列出现的次数作为纵坐标组成的直方图称为n-1阶时序直方图.例3.为了说明时序直方图的含义及时序关Page5系的重要性,将传感器序列替换为关键区域,作示意图例如图1所示.在该例中,从图1(a)中可以看出,直方图较好地保留了大部分行为信息,但忽略了时间信息,从而会造成行为理解的歧义(图中直方图所代表的行为很有可能是在做饭的过程中接了电话,去了厕所;当然也有可能是去了厕所,然后接了电话,接着去做饭);从图1(b)中可以看出,1阶时序直方图(图中考虑了一定的时间信息,在图中,由于2个事件组合较多,因此,未出现的事件采用“其它”项代表;在图1(b)中,行为则很有可能是做饭的过程中接了电话,然后接完电话去了厕所,接着继续做饭)的引入大大降低了行为的歧义性,同时不同阶直方图会体现出不同的时序关系.再考虑诸如离开家和到家这两种行为,其事件直方图是一致的,但其时序关系则是相反的.因此,融合不同阶时序直方图对人体行为模式表示是很必要的.5特征选择及行为表示由于基于外部传感器获取的传感器序列中,存在较大噪声,如果直接利用其构造的时序直方图进行行为理解,必然会降低行为识别的效果.另外,时序直方图得到的特征维数较高.为了克服噪声的影响,同时获得对行为理解更有效的特征,需要进行噪为此本文提出了一种时序序列模式特征选择的声滤除及特征选择.方法,以进行行为表示.5.1时序模式选择设Σ={e1,e2,…,eZ}是所有事件项的集合,共获得R个传感器序列,第j个序列为Sj={s1j,s2j,…,sTj},其中sij∈Σ,i=1,2,…,Tj,Tj是第j个序列的长度.下面基于所有传感器序列的集合,进行序列模式的选择.考虑m阶时序关系,为了消除噪声的影响,定义最小出现频率minf,最大序列间隔length.其中minf控制了有用的序列频率,从而滤除了由噪声产生的时序序列;最大序列间隔保证了在这个间隔内出现的才能作为一个序列模式,从而在一定程度上滤掉了由于噪声或行为本身(例如“出门”这一行为,正常时是直接离开,但有时到了门口却发现忘了带钥匙,需要折回来重新找到钥匙再离开)对时序直方图的影响.对于所有的传感器事件序列S组成的集合D,采用如下方法计算序列模式.算法1.时序特征提取算法.输入:R个传感器序列输出:候选模式序列FORi=1:R对于序列siFORj=1:m在length范围内,计算e1,e2,…,ej的出现频率,其ENDIFe1,e2,…,ej的频率<minf滤除e1,e2,…,ejELSE保留序列e1,e2,…,ejENDEND训练过程中,为了提高训练速度,采用分层次训练的方法.考虑时序直方图的特点,如果n-1阶时序直方图中的某一项e1,e2,…,en-1的频率小于minf的话,则以其为基础构成的n阶时序直方图中的所有项都将会小于minf.因此,在滤除e1,e2,…,en-1之后,其对应的所有的n阶时序直方图中的项也会被滤除.5.2时序模式特征选择进行时序模式提取后,出现的特征较多,增大了过拟合的风险,因此需要进行特征选择.利用特征和分类结果的互信息进行相关性衡量,选择与分类结果相关性强的特征进行行为表示.设得到的特征为Page6x1,x2,…,xn,其中xi是选择出的事件直方图与时序直方图特征,分类结果为y,特征与分类结果的互信息表示为MI(xi,y)=∑xi∑y其中,p(xi,y)、p(xi)和p(y)可以直接从训练样本估计.在归一化后,xi在[01]内取值,且是连续的.为了高效地计算互信息,取固定值对xi进行量化.本文采用在[01]内按固定份数进行量化(在本文中取20),量化之后利用式(7)计算出互信息之后,按照互信息由大到小对特征进行排序,取前Q个最大的部分特征子集作为最终的特征集合.6基于softmax回归的人体行为理解人体行为理解属于分类问题的范畴,且其分类结果服从多项分布.设总共有h类的行为模式集合P,给定标记后的R个传感器模式序列信号为{(x(1),y(1)),(x(2),y(2)),…,(x(R),y(R))},其中,x(i),i=1,2,…,R是第i个行为序列经特征选择后的特征子集,y(i),i=1,2,…,R是第i个行为的标记,显然Y~Multinomial(φ1,φ2,…,φh).由于soft-max回归分析在处理分类结果服从多项分布的分类问题中具有良好的性能[20],因此,本文选择softmax回归分析进行行为理解.softmax回归属于判别式模型,针对我们的问题,其对数似然函数为l(θ)=∑R其中,1{y(i)=c}是指示函数,当y(i)=c时,该函数取1,否则,函数取0.我们的目标是求得使似然函数取极大值的参数.由于模型过于复杂,会影响模型的推广能力,因此,引入贝叶斯正则化因子,综合考虑模型的复杂性和对训练数据的拟合程度,得到如下准则函数:J(θ)=-1式(9)中,第1项对应数据的似然函数,用于衡量模型对于训练数据的拟合能力,第2项为正则化项,是对模型复杂程度的惩罚项,该项的加入保证了模型具有良好的推广能力.为了进行极大似然估计,只要使式(9)取极小值即可.由于式(9)是凸函数,因此,可以利用梯度下降法,求解最优参数.其梯度为:θjJ(θ)=R∑R-1λθj采用式(10)进行梯度下降,得到使式(10)极小的参数θ后,构造分类函数如式(11).fθ(x(i))=7实验结果及讨论为了验证本文算法的有效性,分别利用Cairo数据集①、Milan数据集①和本实验室获得的数据集对算法进行了测试.实验过程中,首先将传感器序列转换为时序直方图,并对它们做归一化处理,在训练阶段完成时序模式的选择及分类器的参数选择.由于随着时序阶数的增大,计算量增长迅速,采用m=2,即采用0-2阶时序直方图进行特征提取,利用N-折交叉验证完成模型的选择.7.1Cairo数据集Cario数据集采用27个开关量传感器来捕获人体的10种行为,分别记作{Bed_to_toilet,Break-fast,Bed,C_work,Dinner,Laundry,Leave_home,Lunch,Night_wandering,R_medicine},其发生的次数分别为{30;48;207;46;42;10;69;37;67;44},共600个行为.7.1.1模型的选择在已知训练数据且训练集个数较小的情况下,Q可以取为训练集个数.对于模型的其他参数,利用N-折交叉验证进行模型选择,其中待选择的参数包括:时序模式提取中的最大间隔长度length,最低频①http://ailab.wsu.edu/casasPage7率minf以及softmax回归分析中的λ.采用N=5进行交叉验证,将数据集进行5等分,每次取4份作训练,1份做测试,实验进行5次,得到的测试集中分类正确率与长度length、最小频率minf及贝叶斯正则化因子λ关系图如图2所示.实验中,取length的初值为0,步长为1,取minf的初始值为0.01,步长选择0.04,利用图2进行最终的参数确定:从图2中可以看出,在λ较大的情况下,不管采用哪种长度,在测试集上的分类正确率均较低,也就是过于简单的模型无法达到好的数据拟合能力;随着λ的减小,分类器性能越来越好,且变化速率较大,当λ=1e-4或1e-5时,分类器性能变好的速率减慢,且对有些length,性能也会下降;对于length的取值,当length=0时,即只采用单纯的事件直方图时,分类正确率最高为88.17%(此时,λ=1e-7),若采用时序直方图,分类准确率会有所提高;从图2可以看出,当length=1和length=3时,在1e-10<λ<1e-5时,其分类器性能均弱于length=2时的性能,故取length=2;当length=2时,得到的分类器不管λ和minf的取值如何,其性能均为最优,最优时的λ=1e-6,minf=0.21,准确率为94%.因此,最终选择最优时的参数length=2,λ=1e-6,minf=0.21.当λ继续变小时,可以看出,测试误差越来越大,分类正确率越来越低,从而表明了贝叶斯正则化项的引入提高了分类器的推广能力.此外,在图2中,采用相同图例表示相同length得到的结果,可以看出,相同的length的结果比较近似,即通过minf的调整无法有效改变由于length不同导致的分类器性能的差异.在实际当中,length对应了在多大间隔内可以看作是一个行为触发的行为序列,该间隔事实上反应了行为的实现过程,因此,加入length之后有效的提取了行为特征,取得了较单纯的事件直方图更好的效果.而minf由于只单纯的滤除了不是经常出现的噪声,尽管可以一定程度上提高分类器性能,但这种提高不能补偿由于length不同所带来的性能差异.7.1.2在Cairo数据集上的测试结果采用length=2,minf=0.21,λ=1e-6进行分类器设计.为了表示方便,将Bed_to_toilet表示为BTT,Breakfast表示为BRE,C_work表示为CW,Dinner表示为DIN,Laundry表示为LAU,Leave_home表示为LEH,Lunch表示为LUN,Night_wandering表示为NWA,R_medicine表示为RME.在没有附加时间信息之前,得到的混淆矩阵如表1所示,分类正确率为82.67%.而对于该行为序列中的早饭、午饭和晚饭,可以将其识别结果看作吃饭的子类,如果不考虑时间,不应该将其分开.因此从时序直方图来看,不应对其作区分,但可以考虑结合吃饭的时间,修正该部分误差,另外,吃药同样跟这些行为非常相似,但吃药区别于以上动作的地方在于时间间隔远小于吃饭行为,结合时间间隔修正这部分误差,最终分类正确率为94%,其混淆矩阵如表2.从表1和表2的混淆矩阵可以看出,分类器的错误集中于BTT(Bed_to_toilet)、BED和NWA(NightWandering),即晚上起床去厕所、躺在床上、夜间徘徊.而事实上,这组行为所触发的传感器序列本身具有较强的相似性,也降低了算法的精度.BTTBREBEDCWDINLAULEHLUNNWARMEBTT25030000020BRE03000600507BED101980000071CW00441000100DIN07002800601LAU00000100000LEH00000069000LUN08005002400NWA001401000520RME013115005019BTTBREBEDCWDINLAULEHLUNNWARMEBTT25030000020BRE04800000000BED101980000071CW00441000100DIN00004200000LAU00000100000LEH00000069000Lunch00000003700NWA001401000520RME00110000042Page87.1.3本文方法与其它方法的比较为了进一步验证该算法的有效性,将本文算法与常用的HMM和条件随机场CRF进行比较,训练过程中,采用与本文相同的分割方法进行训练集与测试集分割,并采用5-折交叉验证进行模型的参数确定,结果表明,本文算法94%的准确率高于HMM的75.5%和CRF的73%①.其中,HMM的混淆矩阵结果如表3所示.由表3可以看出,由HMM所得到的分类结果在BTT、BED和NWA中同样具有较大的错误率,同时,对于其他行为的识别率,HMM算法也低于本文算法的准确率.BTTBREBEDCWDINLAULEHLUNNWARMEBTT130300000140BRE04170000000BED15016371030180CW101619205111DIN00004200000LAU0012051100LEH00210065001Lunch01040103100NWA1701000000400RME00800010134我们利用事件直方图和KL变换的方法同样取得了较HMM更好的效果[18],在取41个主成分的情况下,可以取得最好效果,最高准确率为88.73%.但加入时序模式后,主成分分析的效果却出现了退化现象.实验结果表明,不管取多少个主成分,其最高准确率仅为67.3%.考虑到我们的问题,加入时序模式后,由于噪声的出现,使时序模式中有意义的模式与无意义的模式相互混杂,而主分量分析(PCA)的基本思想是寻求方差最大化从而将模式分开,无意义模式的大量加入使得利用方差最大化进行分类的效果变差.同样,采用PCA降维后,再进行softmax回归,其正确率提高到72%.7.2Milan数据集Milan数据集采用24个开关量传感器,2个模拟量温度传感器.数据集中,共包括人体的15种行为:{Bed-to-Toilet,Chores,Desk_Activity,Dining_Rm_Activity,Eve_Meds,Guest_Bathroom,Kitchen_Activity,Leave_Home,Master_Bath-room,Med-itate,Watch_TV,Sleep,Read,Morning_Meds,Master_Bedroom_Activity},其发生的次数分别为{89;23;54;22;19;330;554;214;306;17;114;96;314;41;117},共2310个行为序列,计算得到两个温度传感器中的K值为3,同样采用5-折交叉验证进行参数的选择,且在length=2,λ=1e-6时,对于该行为序列,其分类准确率达到83.94%,如图3所示.而基于HMM算法的准确率为71%.在Milan数据集上本文算法同样取得了较HMM更优的效果.7.3实验室数据集在作者所在服务机器人实验室的电话、饮水机、门、床、电脑桌、座椅这些关键位置安装开关传感器、运动传感器和压力传感器,进行人的日常行为理解测试.测试的行为包括打电话(Tel)、喝水(Drink)、躺在床上(Bed)、工作(Work)、出门(Lea)等5种行为.对于每种行为,采集50个序列,共得到250个已标记数据,利用5-折交叉验证进行参数的选择,取length=2,λ=1e-6,得到本文算法的混淆矩阵如表4所示,最终取得了98%的准确率.由于实验室数据集的行为序列区分性较大,因此取得了非常高的准确率.Tel481010Drink048020Bed005000Work100490Lea0000508结论及展望本文提出了事件直方图及时序直方图的概念,以时序直方图结合互信息进行特征选择以表示行为,采用softmax回归分析进行了人体行为识别,结合行为发生的时间信息,进行人体的行为理解.实验结果表明,本文算法的准确率在常用的数据集上取①http://ailab.wsu.edu/casasPage9得了远高于基于HMM或CRF等的行为识别方法的准确率.由于HMM和CRF的基础是马尔可夫无后效性,可以较好地建模一阶时序关系,但行为是一种复杂模式,包含多阶或变阶时序关系,这也就是HMM和CRF在Cairo数据集、Milan数据集上识别率不高的原因.事件直方图忽略了时间信息,而行为往往与事件项发生的时序有关系,时序直方图的加入考虑了多阶时序关系,而基于信息的特征选择则提取了对识别行为最有利的时序关系.因此,本文的行为表示方法可以取得较好的效果,同时结合softmax回归可以取得良好的识别效果,在标准数据集和实验室数据集下都取得了最好的识别效果.尽管该方法可以取得很好的识别效果,但其存在一个非常重要的问题就是训练复杂度问题,本文采用了一种简单指定时序阶数的方法来避免训练复杂度过高,虽然可以取得较目前HMM和CRF更好的效果,但是其选择的时序特征具有局限性.在实际情况下,更高阶的时序关系也有可能具有良好的类别鉴别能力.数据挖掘领域的相关知识可以为高阶时序模式的提取提供更好的工具,基于该认识,我们下一步的研究将集中在进一步降低算法的训练复杂度,选择更好的行为表示特征上.
