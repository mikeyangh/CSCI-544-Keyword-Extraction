Page1高斯混合概率假设密度滤波器在多目标跟踪中的应用吕学斌周群彪陈正茂熊运余蔡葵(四川大学计算机学院视觉合成图形图像技术国防重点学科实验室成都610064)摘要实现了基于随机集和点过程理论在目标数未知或随时间变化的多目标跟踪滤波算法.研究成果包括:(1)分析了基于随机有限集的多目标跟踪模型;(2)分析推导了基于随机集和点过程理论的概率假设密度滤波递推表达式;(3)实现了在线性高斯条件下的概率假设密度滤波的一种解析滤波算法;(4)仿真实验验证了算法的性能,比较了在杂波强度和检测概率变化的情况下和联合概率数据互联算法相关性能;(5)指出了算法的一些不足以及改进的研究方向.关键词高斯混合概率假设密度(PHD)滤波器;概率假设密度滤波器;随机集;多目标跟踪;联合概率数据互联1引言多目标跟踪技术无论在军事领域还是在民用领域均有广泛的应用.它可以用于超视距多目标探测、跟踪与攻击、空中交通管制、空中导弹防御、海洋监视、港口监视、卫星监控系统和机器视觉等.跟踪单Page2对于后一个问题,传统的多目标跟踪技术采用“量测—航迹”的关联技术.传统的多目标跟踪过程的关键问题是如何进行有效的数据关联.联合概率数据关联算法(JPDA)和多假设方法(MHT)是多目标跟踪中最为有效的两种关联算法,但当多目标和回波数目增加时,JPDA会遭遇到数据关联组合计算量巨大的问题,计算复杂性呈指数增加,而MHT由于大量的“迭代”过程浪费许多时间.为了解决数据关联的计算量大和避免航迹关联错误,需改变研究问题的思路.最近几年提出了使用随机有限集理论来研究多目标跟踪的思路,基于随机有限集的方法把目标的状态和所有的量测看作是一个随机单一的目标状态集合和一个单一的传感器量测集合,这样基于随机集的方法就把多目标跟踪的问题简化为在集合意义上单目标的跟踪问题.避免了直接的从量测到航迹的关联.本文首先分析了基于随机有限集的多目标跟踪模型,在此基础上从理论上分析推导了基于随机集的概率假设密度滤波递推表达式,实现了在线性高斯情况下的概率假设密度滤波的一种解析滤波算法———高斯混合概率假设密度滤波算法(GaussianMixtureProbabilityHypothesisDensityFilter).实验结果表明该算法在密集杂波环境下能够很好地估计出目标的状态和数目,具有较好的跟踪性能.最后进一步分析指出了算法的一些不足和改进的研究方向.2基于随机有限集的多目标跟踪模型2.1随机集滤波近几年由Mahler[1]提出的有限集合统计学(FiniteSetsStatistics)理论———随机集理论的特例,从概率论的角度统一表述了多目标跟踪中的检测、分类和跟踪问题.在多目标跟踪问题中,多目标的状态模型和观测模型可以表示为随机有限集(RandomFiniteSet)形式.为了描述方便,假设在k时刻的多目标状态集为Xk={xk,1,…,xk,M(k)}∈F(X),多目标观测集为Zk={zk,1,…,zk,N(k)∈F(Ζ)},其中,M(k)及N(k)分别表示k时刻目标数及量测数,F(X)、F(Z)分别表示有限集X和Z的幂集,N(k)M(k),部分量测值可能源于杂波.状态集和量测集可以分别用状态空间的随机有限集Xk和量测空间的随机有限集Zk表示.那么根据随机有限集k时刻的目标状态集可描述为Sk|k-1(x(Xk=∪x∈Xk-1其中Xk-1表示k-1时刻的目标状态集.Sk|k-1表示在k-1时刻的目标在k时刻仍然存在的目标随机集,Bk|k-1表示由Xk-1衍生的目标随机集,Γk表示k时刻瞬间出现的新的目标随机集.在k时刻的多目标的量测根据有限集可描述为Zk=Kk∪Θk(x()),其中Θk(Xk)对多目标状态Xk的量测∪x∈Xk随机集,Kk表示由杂波或者误差引起的量测随机集.根据贝叶斯估计理论,基于有限集的贝叶斯估计可描述为pk|k-1(Xk|Zk-1)=∫fk|k-1(Xk|X)pk-1(X|Zk)μs(dX)pk(Xk|Zk)=gk(Zk|Xk)pk|k-1(Xk|Zk-1)优化的递推的贝叶斯估计表达式(1)、(2)需在空间F(X)进行积分运算,且多目标联合似然函数gk(Zk|Xk)的计算随着目标数的增加而成指数增长,使得直接运用优化的贝叶斯估计来进行目标数和目标状态的估计变得难以实现.为了简化计算,Mahler进一步提出了使用多目标后验概率分布的一阶统计量来近似代替多目标的后验概率分布,以此递推地近似计算目标数和目标状态,并提出了概率假设密度滤波[1](ProbabilityHypothesisDensityFilter).2.2概率假设密度滤波假设v为有限集X∈F(x)的一阶统计量(v也被称作概率假设密度或者强度函数),对于任意的SF(X)有E[|X∩S|]=∫Sv(x)dx.其中|X|代表有限集X的元素的个数.因此对于给定一个x,对应的强度函数v(x)为单位体积x上的目标个数期望值的密度函数[4].下面给出泊松有限集定义.定义1.在满足下列条件的情况下,多目标的(1)随机有限集X的势的分布Pr(|X|=n)服有限集X为服从泊松分布有限集.从期望为N^的泊松分布.(2)x1∈X,x2∈X满足E[x1x2]=E[x1]·E[x2],且具有相同的分布.定理1.若vk和vk-1分别表示多目标有限集的后验概率密度函数pk和预测概率密度函数pk|k-1Page3间相互独立.分布.的强度函数,且满足下列3个条件:对目标的量测间相互独立.条件1.每个目标的状态更新相互独立,传感器条件2.杂波量测均相互独立,杂波和目标量测条件3.多目标的预测概率pk|k-1服从泊松根据有限集统计理论和贝叶斯估计有PHD滤vk|k-1(x)=∫ps,k()fk|k-1(x|)vk-1()d+vk(x)=1-pD,k(x)vk|k-1(x)+波递推表达式为[1]其中公式中的相关符号的定义为γt(·)为在时刻t瞬间出现的新的目标的有限集Γt的强度函数.βt|t-1(·|)为由t-1衍生的目标有限集Bt|t-1()的强度函数.ps,t()为在前一时刻状态为在t时刻仍然存活的概率.pD,t(x)为在t时刻的检测概率,κt(·)为t时刻杂波有限集Kt的强度函数.从式(3)~(4)可知PHD滤波器避免了传统跟踪方法中的“量测—航迹”的数据关联过程,提高了计算的实时性,而且PHD滤波器具有跟踪目标数未知或随时间变化的多目标跟踪的能力,能够同时递推地估计出目标数和目标状态.但PHD递推在一般意义上不存在解析解,数值积分的运算也存在着维数灾(curseofdimensionality)的计算问题.基于此本文推导给出在目标运动状态模型和传感器量测均为线性高斯条件下的PHD滤波器的解析解.3高斯混合概率假设密度滤波算法3.1算法递推表达式本节分析了在线性高斯情况下的多目标跟踪模型下的PHD滤波器的解析式,归纳给出高斯混合概率假设密度滤波算法(GMPHD).首先给出相关的前提条件和引理.条件4.每个目标的状态模型,传感器量测均为线性高斯模型.即其中N(;m,p)表示均值为m协方差为p的正态分布,犉k-1为目标状态转移矩阵,犙k-1为处理噪声的协方差,犎k为量测矩阵,犚k为量测噪声协方差.条件5.目标的存活概率和目标的检测概率状态相互独立.即条件6.新出现的目标和衍生的目标的强度函数可描述为若干高斯混合加权和的形式,即βk|k-1(x|)=∑Jβ,K正定则有(证明略):引理1.给定适当维数的犉,犱,犙,犿,犘且犙,犘∫N(x;犉+犱,犙)N(;犿,犘)d=N(x;犉犿+犱,犙+犉犘犉T)(11)引理2.给定适当维数的犎,犚,犿,犘且犚,犘正定则有(证明略):N(z;犎狓,犚)N(x;犿,狆)=q(z)N(x;珦犿,珟犘)(12)其中q(z)=N(z;犎犿,犚+犎犘犎T);珦犿=犿+犓(z-犎犿),珟犘=(犐-犓犎)犘;犓=犘犎T(犎犘犎T+犚)-1.根据条件4~6以及引理1和引理2,可以得出下面两个结论.推论1.在满足条件4~6且假设多目标在k-1时刻的后验强度函数可表述为高斯混合的形式,即则在k时刻的多目标的预测强度函数也可表述为高斯混合的形式,即vk|k-1(x)=vS,k|k-1(x)+vβ,k|k-1(x)+γk(x)(14)其中γk(x)由式(9)给出vS,k|k-1(x)=PS,k∑Jk-1犿(j)S,k|k-1=犉k-1犿(j)vβ,k|k-1(x)=∑Jk-1犿(j,l)β,k|k-1=犉(l)犘(j,l)β,k|k-1=犙(l)推论2.在满足条件4~6且假设多目标在kPage4的预测强度函数可表述为混合加权的高斯和的形式,即vk|k-1(x)=∑Jkk-1则在k时刻的多目标的后验强度函数也可表述为混合加权的高斯和的形式,即vk(x)=(1-PD,k)vk|k-1(x)+∑z∈Zk其中vD,k(x;z)=∑Jkk-1k(z)=PD,kω(j)ω(j)k(z)=N(z;犎k犿(j)q(j)k|k(z)=犿(j)犿(j)k|k=[犐-犓(j)犘(j)犓(j)k=犘(j)由推论1把式(5)、(7)、(9)~(11)代入到式(3)中,用引理1中的结论知,可用某高斯分布来替代式(3)中的积分运算,同时由推论2和引理1、2的结论,把式(6)、(8)、(15)代入到式(4)中可取消(4)中的积分运算和两个高斯分布的乘积运算.由推论1、2可知若初始化的强度函数v0可表述成混合加权的高斯和的形式,那么后续的预测和后验强度函数均可表述成该形式.另外,根据推论1和推论2可得出当前时刻预测目标数和更新目标数的期望N^k|k-1和N^k计算,结论如下.推论3.在推论1成立的情况下,k时刻目标数的预测的期望N^k|k-1为N^k|k-1=N^k-1PS,k+∑Jβ,k推论4.在推论2成立的情况下,k时刻目标数的更新估计的期望N^k为N^k=N^k|k-1(1-PD,k)+∑z∈Zk∑Jkk-13.2混合加权的高斯和部件的剪枝和合并从推论2知在k时刻的后验强度函数需要的高斯分布的个数Jk=(Jk-1(1+Jβ,k)+Jγ,k)(1+|Zk|)=o(Jk-1|Zk|),知Jk会随着时间没有边界的不断增长,因此在算法中需要对描述后验强度函数的高斯部件进行相应的处理,本文采用了两个步骤进行.1.对于权重小于阈值的高斯部件进行剪枝操作,直接除去该部件.2.对于分布性非常接近的高斯分布采取直接合并为一个高斯分布.3.3GMPHD算法下面给出GMPHD算法的完整描述.其中步1为初始化,步2~6为循环过程.算法1.GMPHD算法.1.根据目标可能的初始的起始位置,计算多目标的初其中m(j,l)2.根据k-1采样时刻假设密度预测k时刻的概率假Forj=1,…,Jγ,k,预测k时刻的可能新目标集的概率始概率假设密度v0(x)=∑J0设密度假设密度γk(x)=∑Jγ,kForj=1,…,Jβ,k,l=1,…,Jk-1,预测衍生目标集的k时刻的概率假设密度vβ,k|k-1(x)=∑Jk-1β,k|k-1,P(j,l)Forj=1,…,Jk-1,预测幸存目标k时刻的目标集的vS,k|k-1(x)=PS,k∑Jk-1S,k|k-1,P(j)预测概率假设密度的高斯分布的个数Jk|k-1=Jγ+vk|k-1(x)=∑Jkk-13.根据步2中的预测与k时刻传感器的观测值更新k时刻的概率假设密度Forj=1,…,Jk|k-1,计算预测概率假设密度中的其中m(j)Jβ+Jk-1|k-1,预测的概率假设密度概率假设密度Jk|k-1个高斯分布的增益和新息协方差等漏检时的更新预测概率假设密度中的每个高斯分布进行更新计算k|k-1=犎k犿(j)η(j)犓(j)k=犘(j)Forj=1,…,Jk|k-1,根据传感器检测概率,考虑目标k=(1-PD,k)ω(j)ω(j)Forl=1,…,|Zk|,根据k时刻传感器的每个观测值与Forj=1,…,Jk|k-1ω(lJk|k-1+j)犿(lJk|k-1+j)犘(lJk|k-1+j)Forj=1,…,Jk|k-1ω(lJk|k-1+j)Jk=lJk|k-1+Jk|k-1;%Output{ω(i)Page5高斯分布的个数.4.概率假设密度中的高斯分布的剪枝和合并运算%τ为剪枝阈值,U为合并门限,Jmax为允许的最大的对更新得到的Jk个高斯分布,进行剪枝,对小于剪枝阈值的高斯分布直接删除I={i=1,…,Jk|ω(i)高斯分布的合并:对于分布非常接近的若干高斯分布进行合并,用一个新的分布代替While集合I非空l··=l+1;j=argmaxi∈Iω(i)足合并条件的所有元素,即集合L={i∈I|(犿(i)计算新的合并后的高斯分布即珘ω(l)k=1珟犘(l)从集合I中删除集合L中的元素I··=I\L;ifl>Jmax,则取权重最大的Jmax的高斯分布输出Output{珘ω(i)5.目标的数目与状态估计根据{珘ω(i)Fori=1,…,Jk,如果ω(i)Forj=1,…,round(ω(i)UpdateX^k··=[X^k,犿(i)6.输出目标估计集合X^,集合X^元素的个数即为当前和数目估计得到的目标个数.4实验仿真为了验证算法的性能,下面给出两组实验,实验1验证GMPHD滤波算法在线性高斯模型下的目标跟踪,实验2比较了在不同杂波强度和不同的检测概率的情况下GMPHD和JPDA滤波器的性能比较.4.1实验1实验环境构建在一个二维平面监控区域[-1000,1000]×[-1000,1000]内,在监控区域内目标的个数未知并且随着时间变化.传感器位于平面内点(0,0),并且存在着强的杂波和传感器漏检情况.目标的状态为[x,x·,y,y·]T,其中(x,y)表示目标的位置,(x·,y·)为目标的速度.目标在k时刻的存活概率PS,k=0.99,目标的运动满足线性高斯模型(5)即1T00熿0100犉k=001T燅0001燀其中σv=0.2(m/s2)为处理噪声的标准差.新产生的目标的泊松有限集Γk(x)的强度函数γk(x)=0.1N(x;犿(1)γ,犘γ),其中犿(3)γ=[50,0,50,0]T,犿(2)犿(1)γ=[150,0,150,0]T,犘γ=diag([100,25,100,25]T).犿(3)从其它目标衍生的目标的泊松有限集Bk|k-1()的强度函数βk|k-1(x|)=0.05N(x;,犙β),其中犙β=diag([100,400,100,400]T).传感器的检测概率为PD,k=0.98量测方程犎k=1000[]0010为量测噪声的标准差,杂波的泊松有限集Kk的强度函数κk(z)=λu(z),其中杂波强度λ=50,u(z)为在监控区域的一致分布.且剪枝阈值τ=10-5,合并门限U=4,允许最大的高斯分布个数Jmax=200.图1为目标在监控区域运动真实的轨迹图,其中“□”表示目标的起始点,“○”表示目标的终结点.其中目标4为在k=11时刻从目标2衍生而来.图2和图4分别描绘了在整个观测时间内量测数据和目标真实值.图3和图5分别给出了GMPHD的滤波估计值和真实值的位置比较.同时从图3和图5中可以看出在某一些时刻GMPHD产生了几个假目标的估计,但这些假的目标很快消失.图6给出了整个观测时间内GMPHD的目标数的估计值与实际目标数的对比,从图中可知估计目标数基本与实际数目吻合,只是有些时刻出现了一些假的目标估计,但该假目标很快消失,由实验结果知GMPHD在强的杂波环境具有很好的估计性能.Page64.2实验2为了进一步验证GMPHD算法在杂波强度和检测概率变化情况下的滤波性能,实验2选取了传统跟踪方法中,对杂波环境下多目标数据关联的一种良好的算法———联合概率数据互联算法(JPDA),对在杂波强度和检测概率变化的情况下两者的性能比较.为了比较两者,对于JPDA使用Kalman滤波器结合的跟踪方法即JPDA滤波器.同时由于JPDA滤波器只能对目标已知且数目确定的多目标进行跟踪,所以实验2仿真了一种目标确定的多目标运动场景,为了比较分析性能.本文选用CPEP(CircularPositionErrorProbability)来定义航迹丢失的平均概率CPEPk(r)=1Prob{‖Hx^-Hx‖2>r,x^∈X^k}.同时对GMPHD对目标数的估计给出了均值绝对误差E{|X^k|-|Xk|},其中|X|表示集合X的个数.下面给出实验的相关数据.实验2的场景为两个固定的目标在位置[60;2.5;60;-12],[-152;12;-150;-2.5]起始,目标在k=100时终结.其中r=20m.其它相关参数同实验1.(1)杂波强度变换图7(b)为杂波强度依次取不同值,且检测概率图7杂波强度变换的GMPHD与JPDA性能比较Page7不变的情况下进行100次蒙特卡罗实验.实验结果表明伴随着杂波强度的增强,GMPHD和JPDA具有较为接近的性能,但GMPHD还具有在线估计目标数的能力,且从图7(a)中不难发现,随着杂波的增强目标数的估计误差没有显著变化.(2)检测概率变换图8(b)为检测概率依次取不同值,且杂波强度不变的情况下进行100次蒙特卡罗实验,实验结果表明伴随着检测概率的减小,GMPHD和JPDA在跟踪上的性能差距变大,JPDA由于有目标数的先验知识因此对于检测概率的变化,在目标丢失的平均概率上没有较大的变换.相反GMPHD由于每步需要检测目标的数目,因此随着检测概率的下降,增加了GMPHD在目标检测上不确定,如图8(a)所示GMPHD的目标估计的误差随着检测概率的下降而增强,同时其跟踪性能也随着下降.图8检测概率变换的GMPHD与JPDA性能比较5结论本文基于随机有限集的多目标跟踪模型,实现了在线性高斯情况下的概率假设密度滤波的一种解析滤波算法———高斯混合概率密度滤波算法(GaussianMixtureProbabilityHypothesisDensityFilter).实验结果表明该算法不仅能够避免传统跟踪方法中的数据关联过程,而且在密集杂波环境的情况下和JPDA滤波器有相近的状态估计性能,同时在目标数未知或随时间变换的情况下,GMPHD能实时地估计出当前的目标数,这是传统跟踪方法如JPDA所不具备的能力.因此GMPHD具有很好的研究和应用的前景.另一方面从仿真实验中看到虽然GMPHD能够实时地估计出当前的目标数,但有些时刻仍会估计出一些假的目标估计,且随着目标数目的增多,GMPHD对目标数的估计误差会增大[6].这是由于算法中假设了目标数服从泊松分布.本文中的跟踪算法只是使用了随机目标集的一阶统计量,即文中的概率假设密度.这样算法在跟踪过程中丢弃了目标的高阶的统计信息.在每步的估计中,对于目标数目的估计,算法估计出当前的目标数目只是真实目标数目的一个统计意义上的期望值.本文认为对于目标数估计的精度提高可以从两个方面加以改进.(1)对本文的算法增加目标航迹处理的能力,通过航迹起始、航迹终结等方法对形成稳定的目标航迹,这样能够有效地提高目标数的估计精度.(2)跟踪算法实现上尽可能地保留目标的高阶统计信息,同时放宽算法成立的限制条件.从点过程理论的研究角度,可以适当地放宽目标数服从泊松过程的假设,在目标数的估计上可以用目标数的概率分布函数来替代原算法推论3和推论4中的直接利用强度函数来计算的办法,从点过程的角度结合强度函数和目标数的概率分布来提高算法的估计性能和精确性.
