Page1一种面向认知网络的QoS路由协议谢小民1)王兴伟1)温占考2)黄敏1)1)(东北大学信息科学与工程学院沈阳110819)2)(东北大学计算中心沈阳110819)摘要随着网络应用的快速发展,传统网络面临诸多挑战,难以满足新型应用的服务质量QoS(QualityofService)需求,网络管理变得极其复杂,迫切要求网络具备认知能力.文中提出了一种面向认知网络的QoS路由协议.为了满足不同应用的QoS需求,路由请求对应不同业务类型和服务等级,映射到相应的QoS参数.文中赋予路由节点感觉、活动感、记忆、查找、决策、执行、推理、解释等认知行为,设计了与这些行为相对应的协议报文,支持节点之间通过这些报文进行交互,从而具备认知能力.节点只收集和维护局部邻居和链路状态信息,通过使用和维护经验路段信息提高路由效率.文中对所提出的路由协议在原型系统上进行了实现,对协议的多项性能指标进行了评价.实验结果表明,文中所提出的路由协议是可行和有效的.关键词认知网络;认知行为;服务质量;路由协议1引言近年来,网络技术快速发展,网络规模不断扩大,传统网络的缺陷逐渐暴露出来,难以满足应用多样化的服务质量(QualityofService,QoS)需求,网络管理变得越来越复杂.网络中各种新应用、新业务不断出现,对网络提出的要求也越来越高,需要网络具备自适应、自管理、学习和推理等功能,即具备认知能力[1],以满足应用和用户日益提高的需要.认知网络的概念是从认知无线电网络[2-4]等发展而来的.文献[5]将知识平面引入到网络中,使之具备自我感知能力,能通过观察、学习、推理,做出前瞻性决定,进行自我配置和管理,从而适应网络环境变化.目前,关于认知网络的研究多专注于认知网络框架设计或是把某种认知技术引入到网络中[6].文献[7-8]论述了机器学习、跨层设计和分布式推理等认知网络关键技术.文献[9]提出了一种认知网络三层结构框架,分别为行为目标层、认知处理层和软件可调节网络层.文献[10]提出了一种基于多级反馈域认知环的认知网络结构.文献[11]提出了一个协同型认知网络平台,提供可信赖、自组织和自管理能力.文献[12]构建了一种分布式认知平面,可以跨层、跨节点、跨域实现自管理、自控制和自优化.文献[13]提出了一种基于可用频段统计特性的感知策略,自适应选出可用频段.文献[14]指出了在认知网络设计中需要考虑的三个重要因素,即决策制定单元行为、单元可计算状态及其可控级别.文献[15]把协作感知技术引入到认知无线电网络中,提出了一种分布式多目标联盟构造算法,降低了网络节点在形成协作感知联盟时产生的开销.文献[16]提出了一种分布式协调协议,考虑了节点间的连通性和主系统的出现模式.文献[17]研究了认知网络的管理和协议配置,可以动态调整协议配置参数.文献[18]提出了一种面向认知无线电网络的分布式干扰感知路由协议,可以结合频谱使用成本和干扰指标来选择合适的路由.文献[19]提出了一种基于QoS约束和负载均衡的多策略认知路由机制.文献[20]提出了一种面向认知无尺度网络的拥塞避免路由协议,通过权衡最短路径长度和负载建立最优路径.文献[21]提出了一种具有链路可用性预测机制的认知网络路由协议,根据链路质量和节点负载进行路由选择.现有工作对主干网的认知能力问题和面向具备认知能力的主干网中的路由问题涉猎不多,还有很多挑战没有解决.本文提出了一种面向主干网的认知网络QoS路由协议,对所提出的协议在原型系统上进行了实现,评价了多项协议性能指标.研究结果表明,本文所提出的路由协议可以满足面向主干网的认知网络的需要.2问题描述2.1网络模型和参数描述网络建模为图G(V,E).用V={v1,v2,…,vn}表示节点集合,用E={e1,e2,…,el}表示边集合.引入如下参数描述节点和边状态:链路可用带宽、延迟、延迟抖动、出错率、节点CPU使用率、节点存储使用率.为了满足不同应用和用户的QoS需求,本文把路由请求对应于不同业务类型和服务等级,业务类型分为ST个种类,每种业务类型分为LV个服务等级,业务类型和服务等级映射至特定的QoS需求:带宽、延迟、延迟抖动、出错率.因此,本文的路由请求表示为五元组〈路由请求ID,源地址,目的地址,业务类型,服务等级〉.2.2节点行为认知是人类在认识事物时对信息的收集、处理以及做出反馈的过程.本文根据文献[22]提出的大脑分层模型,对节点引入以下认知行为:感觉、活动感、记忆、查找、决策、执行、推理和解释.在本文提出的路由协议中,节点通过感觉行为获得邻居节点和直连链路信息;通过活动感行为促进网络节能;通过记忆行为存储经验路段信息;通过查找行为加快寻路;通过决策行为完成寻路;通过执行行为进行路由信息更新;通过推理行为促进网络性能优化;通过解释行为帮助故障处理.3面向认知网络的QoS路由协议本文提出了一种QoS路由协议,支持节点通过报文交互实现认知行为,完成QoS路由.该协议不仅支持单播,而且支持组播.3.1路由信息表在本文提出的路由协议中,路由信息分为两类:(1)邻居信息,主要通过感觉行为获得;(2)到一目的地址的经验路段信息,主要通过记忆行为获得.Page3如下:路由器ID.和存储使用率.邻居信息表格式如图1(a)所示,表中各项说明接口号:1个字节,与邻居节点相连的接口标识.节点地址:16个字节,邻居节点的IPv6地址.节点标识:8个字节,邻居节点的自治域ID和节点状态:4个字节,邻居节点的CPU使用率链路标识:8个字节,链路编号.链路状态:16个字节,邻居节点与当前节点间相连链路的状态参数,包括出口参数与入口参数各8个字节,分别包括可用带宽、延迟、延迟抖动、出错率.休眠标志:1个字节,邻居节点是否处于休眠状态,1表示处于休眠状态,0表示处于工作状态.经验路段信息表格式如图1(b)所示,表中各项说明如下:PID:4个字节,经验路段标识符.目的地址:16个字节,经验路段目的节点的IPv6地址.经验路段QoS:16个字节,该经验路段的双向QoS,包括可用带宽、延迟、延迟抖动和出错率.计时器:2个字节,经验路段死亡时限,单位为s.其初值为65535,其值按时递减,为0时清除该经验路段对应的表项.使用次数:4个字节,表示经验路段累计使用次数,初值为1,增大到最大值时封顶.经验路段组成节点标识:变长,线性表结构,每个表项由经验路段组成节点的自治域ID和路由器ID构成,第一个表项对应当前节点,最后一个表项对应目的节点.3.2路由表路由表分为单播和组播两类.单播路由表格式如图1(c)所示,表中各项说明单播路由请求ID:4个字节,唯一标识该单播源地址:16个字节,表示该单播路由请求的目的地址:16个字节,表示该单播路由请求的业务类型:1个字节,表示该单播路由请求对应服务等级:1个字节,表示该单播路由请求对应IPv6源地址.IPv6目的地址.的业务类型.如下:路由请求.的业务类型下的服务等级.下跳标识:8个字节,对应下跳节点的自治域ID和路由器ID.转发接口:1个字节,表示向下跳节点转发数据的接口号.如下:路由请求.组播路由表格式如图1(d)所示,表中各项说明组播路由请求ID:4个字节,唯一标识该组播源地址:16个字节,表示该组播路由请求的IPv6组播源节点地址.目的地址:16个字节,表示该组播路由请求的IPv6组播组地址.的业务类型.业务类型:1个字节,表示该组播路由请求对应服务等级:1个字节,表示该组播路由请求对应的业务类型下的服务等级.下游节点标识:8个字节,对应下游节点的自治域ID和路由器ID.转发接口:1个字节,表示向该下游节点转发数据的接口号.同一组播路由请求在组播路由表中可以有多个下游节点标识和转发接口项.注:“}☆”表示可有多项.3.3协议报文首部定义在本文提出的面向认知网络的QoS路由协议中,所有报文使用统一的报文首部,格式如图2所示,各字段说明如下:Page4所在自治域的ID.版本号:1个字节,协议的版本号.报文类型:1个字节,表示不同的报文类型.报文长度:2个字节,单位字节.自治域ID:4个字节,表示发送报文的路由器路由器ID:4个字节,表示发送报文的路由器校验和:2个字节,用于校验报文的正确性.实例ID:1个字节,标识不同的协议实例.网络中可以运行本文协议的多个实例,使用它可以唯一标识一个实例.的ID.保留:1个字节,未来扩展用.07815162324313.4感觉节点通过感觉行为获取和维护邻居信息,感觉其邻居节点的加入、退出和状态,感觉直连链路的状态.感觉行为使用Hello、Sense和SenseAck三种报文交互.节点周期性发送Hello报文来感知邻居节点的存在、加入与退出,报文类型为01,格式如图3所示,各字段说明如下:Hello时间间隔:2个字节,发送Hello报文的周期,单位为s.无效时间间隔:2个字节,在此时间内如果一直未收到邻居节点的Hello报文,则认为邻居节点已经退出,单位为s.邻居节点自治域ID和邻居节点路由器ID:标识邻居节点.由于一个节点可以有多个邻居,因此Hello报文的长度不固定,可以通过报文长度得出该报文携带邻居节点信息的个数.邻居节点自治域ID☆节点通过周期性发送Sense报文来获取邻居节点和对应邻边的状态信息,报文类型为02,格式如图4所示,字段说明如下:报文发送时刻:4个字节,记录该报文的发送时刻,单位为ms.SenseAck报文是对Sense报文的应答,报文类型为03,格式如图5所示,各字段说明如下:接收者自治域ID和接收者路由器ID:标识接收该SenseAck报文的节点,与发送对应的Sense报文的节点标识相对应.报文发送时刻:4个字节,对应Sense报文的发送节点发送Sense报文的时刻,单位为ms.出口可用带宽和入口可用带宽:该SenseAck报文发送节点对应接口的出口和入口可用带宽,单位为Kbps.16位的字段分为指数部分和尾数部分,令指数部分占a位,则尾数部分占(16-a)位,令基数为b,则可以表示的最大可用带宽值为216-a()-1×baKbps.本文在原型实现时这两个字段均采用无符号整数编码,支持的可用带宽最大值为216()-1Kbps,即65535Kbps.出口出错率和入口出错率:该SenseAck报文发送节点对应接口在出口方向和入口方向的出错率,为[0,1]之间的小数,编码方式为实际出错率乘以10000,取整;读取时,将读出值除以10000,作为出错率.CPU使用率:2字节,该SenseAck报文发送节点的CPU使用率,编解码方法与出错率的相同.存储使用率:2字节,该SenseAck报文发送节点的存储使用率,编解码方法与出错率的相同.处理时间:4个字节,从收到对应的Sense报文到发送该SenseAck报文的时间差,单位为ms.报文接收时刻:4个字节,收到SenseAck报文的时刻,单位为ms.节点vi按“Hello时间间隔”向邻居节点周期性发送Hello报文.节点vj首次收到vi发送的Hello报文时,将vi相关信息存入vj的邻居信息表中.如Page5果在“无效时间间隔”内,vj始终没有收到vi的Hello报文,则认为vi已经退出,并将vi的相关信息从vj的邻居信息表中删除.vj和vi成为邻居后,通过Sense报文和SenseAck报文周期性交互,得到彼此和对应邻边的状态信息,包括出口方向和入口方向的可用带宽、延迟、延迟抖动和出错率.3.5活动感节点通过活动感行为促进网络节能.如果节点在一段时间内既没有收到路由请求也没有数据需其转发,则进入休眠状态;如果休眠节点收到路由请求或需要转发数据,则苏醒,进入工作状态;休眠节点也可由邻居节点唤醒.活动感行为通过Sleep、WakeupInform和Wakeup三种报文交互.节点使用Sleep报文,通知邻居节点其将进入休眠状态;使用Wakeup报文唤醒休眠节点;使用WakeupInform报文,通知邻居节点其已进入正常工作状态.Sleep报文和WakeupInform报文只有报文首部,其中,Sleep报文类型为04,WakeupInform报文类型为05.Wakeup报文类型为06,格式如图6所示.如果vi要进入休眠状态,则其向所有邻居节点发送Sleep报文,通知其将进入休眠状态,vi启动休眠计时器.收到Sleep报文的邻居节点将其邻居信息表中vi的休眠标志置1.如果vi的某个邻居节点需要其恢复到正常工作状态,则向vi发送Wakeup报文,将其唤醒.如果没有节点唤醒vi,则当休眠计时器到期时,vi自动苏醒.vi被唤醒或苏醒后,向其所有邻居节点发送WakeupInform报文,告知其已进入正常工作状态,收到WakeupInform报文的邻居节点将其邻居信息表中vi的休眠标志置0.3.6记忆当找到满足路由需求的路径时,沿反向路径返回找到的路径信息,并在沿途节点记忆从其到达目的节点的经验路段信息,从而为以后快捷寻路提供有效支持.记忆行为通过Memorize报文实现,报文类型为07,格式如图7所示,各字段说明如下:目的地址:16个字节,目的节点的IPv6地址.该节点和目的节点间经验路段QoS:16个字节,该节点和目的节点之间经验路段的双向可用带宽、延迟、延迟抖动和出错率.说明同经验路段表.该节点和目的节点间经验路段组成节点标识:记忆行为由目的节点使用Memorize报文发起.假设已经找到一条满足需求的从源节点vs到目的节点vd的路径vs→…→vi→…→vd.vd反向向沿途各节点发送Memorize报文,中途各节点vi(1in)收到Memorize报文后,根据报文携带的经验路段QoS以及vi到vi+1边的QoS,使用式(1)~(4)计算得出从vi到vd的经验路段QoS,存入本地经验路段信息表,同时更新Memorize报文中的经验路段QoS,转发Memorize报文给vi-1,直至到达vs.其中,bwp、dlp、jtp和lsp分别为vi收到的Memorize报文中携带的经验路段可用带宽、延迟、延迟抖动和出错率值,bwl、dll、jtl和lsl分别为vi到vi+1边的可用带宽、延迟、延迟抖动和出错率值,bw、dl、jt和ls分别为从vi到vd的经验路段的可用带宽、延迟、延迟抖动和出错率值.经验路段两个方向的QoS参数分别计算.3.7查找查找是节点通过查询邻居节点经验路段信息表寻找到达目的节点经验路段信息的行为,目的是提高路由效率.节点通过Search报文和SearchAck报文实现与邻居节点的查找交互.Search报文类型为08,格式如图8所示.其中,源节点和该节点之间的路段QoS字段16个字节,分别对应该路段的双向可用带宽、延迟、延迟抖动和出错率,路段组成节点标识说明同经验路段信息表.Page6SearchAck报文类型为09,格式如图9所示.其中,经验路段数字段为1个字节,表示满足条件的经验路段数目;#SEG_START和#SEG_END,均为2个字节,分别标识经验路段的开始与结束,两者之间是该经验路段的PID、QoS(16个字节,分别对应该经验路段的双向可用带宽、延迟、延迟抖动和出错率)和组成节点标识(长度视组成节点个数而定).路由请求ID业务类型服务等级经验路段数#SEG_START☆节点向其邻居节点发送Search报文,邻居节点收到Search报文后,在本地经验路段信息表中查找同时满足下列两个条件的经验路段:目的地址与Search报文中携带的目的地址相同;经验路段QoS与Search报文中携带的路段QoS的组合满足路由请求对应的业务类型和服务等级要求.邻居节点将满足条件的经验路段数和经验路段信息填入SearchAck报文的对应字段,而后将SearchAck报文发送给当前节点.如果满足条件的经验路段多于由经验路段数字段确定的上限,则择优选用上限个经验路段.3.8决策节点根据其Search的结果即收到的SearchAck报文进行路由决策.如果SearchAck报文的经验路段数字段值为0,则表示无满足条件的可用经验路段,当前节点按照常规寻路过程,寻找下一跳,在下一跳继续3.7节的查找;如果SearchAck报文的经验路段数字段值为1,则直接使用经验路段;否则,根据路由请求对应的业务类型和服务等级,按照既定的决策规则(例如,跳数最短、可用带宽最大、延迟最小、延迟抖动最低或出错率最低及其各种组合)从多条可用经验路段中选出最适合的经验路段.如果目的地址已达,则路由过程结束,节点通过Decide报文通知路径上的所有节点已为路由请求完成寻路.Decide报文类型为10,格式如图10所示,其中,路径组成节点标识字段存放路径上各节点对应的自治域ID和路由器ID.3.9执行已完成路由请求的路径上沿途各节点收到Decide报文后,执行路由表更新操作,相关节点更新其相关经验路段定时器为最大值且使用次数加1.3.10推理如果有经验路段在时间间隔T内的使用次数超过预设阈值,则说明该经验路段使用极其频繁,通过的业务量多,应在该经验路段两端点间构建直连线路,以改善网络性能.存储这样的经验路段的节点向网络管理员发出Reasoning报文,给出直连建议.Reasoning报文类型为11,格式如图11所示.一个Reasoning报文可携带多条这样的经验路段信息.PID☆网络管理员收到Reasoning报文后,可在未来网络的规划和建设中予以考虑,以进一步优化网络运行.如果在经验路段两端点间建立了直连线路,则网络管理员使用Delete报文通知存储相应经验路段的节点从经验路段信息表中删除之.Delete报文类型为12,格式如图12所示.一个Delete报文可携带多条要删除的经验路段标识.PID3.11解释如果报文在转发过程中失败,则可能是由于当前节点与下游节点之间的链路出现故障或/和下游节点出现故障.当前节点通过对下游节点局部重路由来测试下游节点是否工作正常,进而确定是链路故障还是节点故障亦或两者兼而有之.之后,当前节点发送Explain报文给网络管理员,通知其故障类型和故障位置.Explain报文类型为13,格式如图13所示.Explain报文是变长的,其中,故障类型为1,表示节点故障,报文只携带故障节点标识;故障类型为Page72,表示链路故障,报文只携带故障链路标识;故障类型为3,表示节点和链路均发生故障,报文携带故障节点标识和故障链路标识.4性能评价4.1网络实验平台本文提出的协议在自行研制的原型路由器上进行了实现,在参照CERNET2拓扑由20台原型路由器构成的网络实验平台上进行了实验.网络实验平台如图14所示,连接4台应用服务器.4.2实验结果选取OSPFv3[23]作为比较对象,对比本文协议与OSPFv3的性能.表1为本文协议和OSPFv3获取邻居信息所需时间、传输报文数以及字节数之比.可以看出,本文协议开销比OSPFv3大,这是因为本文协议不仅需要发现邻居而且需要获取邻居节点状态信息和直连链路状态信息,OSPFv3只需发现邻居即可.表2为本文协议与OSPFv3从协议启动到进入收敛状态所需时间、传输报文数以及字节数之比.可以看出,本文协议开销低于OSPFv3,这是因为本文协议仅使用局部信息,而OSPFv3需要收集全局信息.表3为本文协议与OSPFv3协议在进入收敛状态后单位时间内传输报文数和字节数之比.可以看出,本文协议比OSPFv3传输的报文数量多,这是因为本文协议需要定期更新邻居节点和直连链路信息,而OSPFv3不需要此过程;但是,本文协议传输字节数比OSPFv3小,这是因为本文协议的报文只携带局部信息,而OSPFv3有些报文需携带全局信息.表4为本文协议与OSPFv3在有节点加入/退出导致网络拓扑出现变化时协议重新到达收敛状态所需时间之比.可以看出,本文协议重新进入收敛状态所需时间更少,这是因为本文协议只需加入/退出节点的邻居节点发现此变化且更新其路由信息表即可,而OSPFv3需要网络中所有节点都获知全局拓扑信息.图15为本文协议与OSPFv3的节点CPU和存储使用率之比.可以看出,本文协议在进入收敛状态前比OSPFv3的节点CPU使用率低,在进入收敛状态后比OSPFv3的高,这是因为本文协议只需要收集局部信息但是需要定期更新;本文协议比OSPFv3的节点存储使用率低,这是因为本文协议仅需要存储局部信息,而OSPFv3需要存储全局信息.图16是本文协议下网络节点休眠率(定义为网络中休眠节点数与网络节点总数之比)在不同网络负载下的变化情况.可以看出,随着单位时间内路由请求数的增多,休眠率逐渐降低,这是因为网络中需Page8要处理路由请求和传输业务量的节点数逐渐增多,因而可以进入休眠状态的节点逐渐减少.5结论本文提出了一种面向认知网络的QoS路由协议,赋予路由节点感觉、活动感、记忆、查找、决策、执行、推理和解释等认知行为,定义了与这些行为相对应的报文及其操作.节点通过感觉和活动感行为收集和维护邻居节点和直连链路状态等局部信息,通过记忆和查找行为加快寻路过程,通过决策和执行行为完成路由选择,通过推理和解释行为维护和优化网络运行.对本文提出的协议进行了原型实现,并与OSPFv3进行了性能比较,结果表明,本文提出的协议是可行和有效的.协议的进一步完善和实用化是未来研究工作的重点.致谢审稿专家和编辑老师为本文提出了宝贵的修改意见和建议,在此,我们表示衷心的感谢!
