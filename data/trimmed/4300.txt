Page1一位可重构三值光学处理器的设计和实现王宏健金翊欧阳山(上海大学计算机工程与科学学院上海200072)摘要文中对可重构三值光学处理器的原理和基本结构进行了详细的实验研究,证明了这种处理器的可重构性和重构电路的有效性.本次研究设计了实用的重构电路,使用小规模FPGA芯片、笔段式液晶显示器和高速光强传感器等元件,成功构造了一个像素位的可重构三值光学处理器.在实现的实验系统上,通过精心选择的50个实验用例,对三值光学处理器的全部42个基元和28个代表性逻辑运算器进行了研究.50个实验用例覆盖了所有可能的输入状态和各种基元组合情况.该文是对降值设计理论的第一次全面实践,为可重构三值光学处理器从理论到实际应用提供了实验基础和技术支持.关键词三值光学处理器;降值设计理论;基元;可重构;重构电路;实验1引言三值光学计算机是利用光的强度和两个正交的Page2计算机研究进入实际制作和可应用阶段[6-12].2010年,本文作者设计了实现三值光学处理器自动重构性的技术架构[13],为制作实用型千位并行三值光学计算机奠定了技术基础.然而,这个技术的有效性和可用性必须通过严格的实验研究才能被肯定,同时也只有通过详尽的实验研究才能完善这项基础技术.本文报道在三值光学处理器可重构性实验研究方面的成果.2三值光学处理器可重构性理论2.1降值设计理论简介参考文献[2]在理论上深入研究了无进(借)位两路输入n值运算器的构造问题,建立了多值逻辑运算器的降值设计理论,揭示了逻辑运算器的硬件可重构性.这个理论的结论可以概括为:任意的n值逻辑运算器可以通过组合不超过n×(n-1)种仅有二值输出状态的最简基元而成.由于最简基元的输出状态只有两个,所以它们的结构非常简单.根据这个结论,任何一个复杂的n值逻辑运算器都可以用几个输出仅有二值、结构简单的最简基元组合而成.图1可重构三值光学处理器整体结构对于三值逻辑,共有19683(33×3)种逻辑运算器和18种最简基元,只需组合不超过6种最简基元就可以构成任意一个三值逻辑运算器.依据降值设计理论[2,14],在多值计算机中只需准备好各种最简基元,即可按以下步骤随时生成某种具体的逻辑运算器:(1)根据运算器选择最简基元;(2)给选定的最简基元同时送入同一个输入值,并使其同步工作;(3)将选定基元的输出状态进行物理叠加,得到运算器的输出状态———运算结果.当一个逻辑运算器工作结束后,其占用的最简基元又可以用于构造其他的逻辑运算器.因此,多值计算机中的逻辑处理部件只是各种最简基元的汇聚体,而具体的逻辑运算器是由逻辑处理部件中的一部分最简基元组成的临时协作体.这种构造各种逻辑运算器的思想和技术使得n值逻辑处理部件(逻辑处理器)表现出明显的可重构性.2.2可重构三值光学处理器原理依据降值设计理论构造三值光学计算机的逻辑处理部件时发现,三值逻辑光学处理器的18种最简基元都具有相同的抽象结构,如图1所示.其中:主光路(a)由编码器和两个偏振片夹一个液晶的“三明治”Page3结构组成;控制光路(b)由偏振片后放置一个感光管组成.由于这个结构中所用偏振片的偏振方向不能随时改变,因此,图1中将偏振片的偏振方向相同的最简基元放置在一起,主光路就自然地形成了HH、VH、HV和VV4个区域,控制光路形成了V和H两个区域.这里V表示偏振方向置于垂直方位的偏振片,H表示偏振方向置于水平方位的偏振片,前一个字母表示光入侧偏振片的偏振方向,后一个字母表示光出侧偏振片的偏振方向.将图1中的主光路和控制光路构成一个最简基元的过程,是将控制光路中一个区域的像素用于控制主光路某个区域中一个像素的配置过程,图1中设计的重构电路模块承担这项配置工作.图1中还在每个液晶像素的控制信号输入端设计了一个异或门,用于改变液晶像素控制端信号的有效状态.图1中的4个锁存器Rhh、Rvh、Rhv和Rvv分别用于保存对主光路4个分区的重构命令,以实现通过程序控制光学处理器的重构操作.在图1表示的三值逻辑光学处理器中,由光学元件组成的区域共有6个,主光路的HH、VH、HV和VV区域与控制光路的V和H区域.为了构造上的便利,三值光学计算机中将这6个区域的像素排列成完全相同的阵列,并将位于各区域上行列坐标相同的像素作为一个整体看待,称这6个像素为一个像素位.进一步研究发现,在同一个主光路分区上的2个或3个最简基元可以合并在该主光路的一个像素上实现,称它们为复合基元[14-15].复合基元共有24种,它们的使用方法与最简基元一样,利用它们可以减少某些逻辑运算器中使用像素位的数量.于是,三值逻辑运算器有42种基元,其中18种最简基元,24种复合基元.三值光学处理器的重构需要两个过程:第1个过程是基元重构,即由基元抽象结构重构出具体的基元,其核心操作是为主光路搭配控制光路,由重构指令指挥基元重构电路完成;第2个过程是处理器重构,即组合各基元生成具体的三值逻辑运算器,其核心操作是指派重构好的基元,由重构例程完成[13].3可重构三值光学处理器的整体设计可重构三值光学处理器整体结构如图1所示.图中实线表示光信号传输线,虚线表示电信号传输线,这个结构包含电控制的原因是目前未在市场上购得光控液晶,所以,控制信号只能使用电信号,这个做法与三值光学计算机“光处理,电控制”的原则相一致.图中主光路(a)由光源、四层偏振片、三层液晶和一个感光管构成.其中靠近光源的两层垂直偏振片(V)和两层液晶为主光路编码器[8-9],负责将二值的电信号转化成三值的光信号.剩余的两层偏振片和一层液晶为基元的“三明治”结构.控制光路(b)由光源、一层偏振片和一个感光管构成,外加一个V区域和H区域输出信号相“或”的类型.主光路计算结果的光信号通过图中最右侧的感光管转化成电信号,四路电信号再通过两个或门Yh和Yv生成最终的计算结果(c)并输出.每一个主光路类型都配备一个重构模块,这个模块由3个异或门(X1,X2,X3)、一套重构电路和一个6位重构命令锁存器(Rhh或Rvh或Rhv或Rvv)组成.4个重构模块连接到同一个像素位的V型控制光路、H型控制光路和二者的“或”.图中左边的主光路编码器输入寄存器用于存放主光路输入光信号的编码命令,这些命令信号通过重构模块的调制最终用于控制主光路编码器两层液晶的旋光性.控制光路编码器输入寄存器用于存放控制光路输入光信号的编码命令,这些命令信号直接控制V、H两种类型控制光路光源的开和关.4一像素位可重构三值光学处理器的实现4.1器件选择搭建一像素位的可重构三值光学处理器所需要的器件主要有光源、偏振片、光状态调制器(液晶)、感光管和数字电路系统.考虑到设备的简单性、可靠性和控制实验过程的方便性,本次实验中选用DICE-SEMⅡ型数字模拟综合实验箱做主实验箱,选用荧光灯做光源,选用笔段面积较大的液晶数码显示器做光状态调制器,选用将输入光强转化成输出电压的TSL14s高速光强传感器做感光管.实验中,在主实验箱上的小规模FPGA芯片(ACEX1K)中搭建重构电路、主光路编码器输入寄存器、控制光路编码器输入寄存器及其它电子元器件,用主实验箱上的拨动电键对各个锁存器和寄存器输入命令字或数据字,用主实验箱上的两个发光二极管(LED)作为V型和H型控制光路的光源.4.2电路设计结合主实验箱上FPGA模块电路设计软件Page4MAX+PLUSII完成的实验电路图如图2所示.其中:6位的重构命令寄存器Rhh、Rvh、Rhv和Rvv分别用4个八D锁存器(74LS377)实现,并将这图2重构实验电路图4个锁存器用一个2-4译码器(74LS139)寻址,于是基元重构命令增长到8位,增加的两位称为“址码”[15],保存8位基元重构命令的锁存器(Rcg)用一个74LS377来实现.Page5重构模块的内部电路示于图2中CGDL虚线框内,它的输入信号K3、K4、K5取反后通过一个三输入与门接到一个三态门(Z)的控制端;Z的输入端接地,输出端接到重构电路模块的输出信号端Y,这个设计代替图1中的接地电阻r.主光路编码器输入寄存器(Rzb)和控制光路编码器输入寄存器(Rcb)分别用两个双D触发器(74LS74)来实现.液晶需要用交变电压驱动,而实验箱的输出信号都是直流电压,因此实验电路中给12个液晶控制端各设计了一个异或门(Y1~Y12),并将这12个异或门的各个输入端接100Hz的方波电压CLK[16].4个感光管(gvv,gvh,ghh,ghv)分别采集主光路液晶模块4个分区输出的计算结果光信号,感光管的输出信号送入解码电路(见虚线框JMDL);解码电路由两个异或门(Yv和Yh)、两个非门(f1和f2)和一个与门(f3)组成,它将4个感光管的输出信号转换成3个电信号cw、cv、ch.当计算结果为无光态时cw为高电平,当计算结果为垂直偏振光态时cv为高电平,当计算结果为水平偏振光态时ch为高电平.控制光路用两个发光管(L1和L2)实现;控制光路的输出由两个感光管(gv和gh)采集.4.3电子线路连接实验箱中部的可编程逻辑电路(EP1K30TC144-1)中构造了图2中给出的各芯片和电路,该芯片有96个输入/输出管脚和1728个逻辑单元,实验电路总共用了49个输入/输出管脚和76个逻辑单元,管脚占用率和逻辑单元占用率分别为51%和4%.实验箱底部的拨动电键K1~K8分别连接图2中的d0~d7,用作在数据总线上生成重构命令;K9连接CLK-1,实现地址总线对重构命令寄存器的寻址,起到设置重构命令的作用;K10和K11连接a2和a1,用作生成主光路编码器的输入数据;K13和K14连接LED灯L2和L1的控制端,用作生成控图4TN型笔段式液晶规格(单位为mm)制光路编码器的输入数据;K12连接CLK-2,用作两个编码器的输出使能信号,生成运算器的工作命令信号.位于拨动电键左边的12对红绿LED灯分别连接图2中的输出信号vv-y1、vv-y2、vv-y3、hv-y1、hv-y2、hv-y3、vh-y1、vh-y2、vh-y3、hh-y1、hh-y2、hh-y3,用于监视4个分区重构电路的实际输出状态,以便记录和分析实验现象.在实验箱左下角的红色LED灯L1和L2上各密封了一个感光管(gv和gh),用于实现控制光路的功能,L1和L2的发光状态由K14和K13控制,gv和gh的输出信号连接到图2的输入信号bv和bh上,同时连接到实验箱左上角的数码管LED1和LED2,这两个数码管用于实时监视gv和gh的实际输出信号.图2中的CLK连接实验箱上的100Hz方波电压.实验箱上端中部的3个数码管LED4、LED5、LED6分别连接cw、cv、ch信号,用于显示计算结果.各部件连接和调试完毕的一位可重构三值光学处理器实验平台如图3所示.4.4光学元件制作对于一个像素位的可重构三值光学处理器,其主光路每个分区只有一个像素,因此本实验系统的主光路共有4个像素,为了方便制作,我们将这4个像素集中在一块液晶屏上,即实验系统主光路的4个分区在一个液晶模块上实现.用于制作主光路的液晶模块如图4所示,共有Page6两个半的八字显示笔段.为了使制作好的光学处理器的每一个像素既方便于人眼观察和拍照记录,又方便于感光管采光,给每种分区分配两个相邻笔段,并将这两个笔段视为一个像素.具体分配为:2A和2F分配给VV分区、2D和2E分配给VH分区、3A和3B分配给HV分区、3C和3D分配给HH分区.4个感光管分别贴到4个分区的一个显示笔段上.5实验用例设计在所有的两输入三值逻辑运算器中,有一部分运算器需要分别将3种输入光状态(即无光态、水平偏振光态和垂直偏振光态)转换成同一种有光态输出的基元,但是一个像素位的主光路中只有两个液晶像素可以输出相同的光状态,于是就需要用两个像素位来实现这部分运算器,但这两个像素位上的基元仍然都是42个基元之一.所以这部分运算器除了会给像素位指派软件带来一点麻烦之外,在基元和运算器的硬件重构结构和控制方面并没有增加内容.因此,本文设计制作的处理器主光路只为每个分区各做出一个液晶像素,即仅构造出一个像素位的实验系统.同理,在制作千位三值光学处理器时,主光路仅需要4个分区即可.5.1基元测试例为了证实重构电路的功能,需要在一位可重构三值光学处理器上对基元和运算器进行实验测试.对基元的测试旨在验证三值光学处理器所有重构命令的正确性,需要将42个基元依次进行实验.为了简化实验过程,把42个基元中重构码(重构命令中除址码外的其他6位)相同的基元同时测试,形成22个实验用例.5.2运算器测试例对运算器的测试旨在验证三值光学处理器重构过程的正确性.为使实验内容涵盖所有的理论要点和各类重构状态,按下述原则选择了28个运算器作为实验用例:(1)选择包含4个基元的运算器14个,对应表1中的前4列,其中用X表示基元,等价地表示对应的重构码.X的位置分别对应于HV、HH、VV和VH分区,当两个分区的基元(重构码)相同时,给X附以相同的下标,当基元互不相同时,给X附以不同的下标,例如,“X1X1X2X3”表示HV和HH分区相同的基元(都用X1表示),VV和VH分区各有不同于其他3个分区的基元.第1列的特征是4个分区的基元相同;第2列的特征是4个分区的基元有两种;第3列的特征是4个分区的基元有3种;第4列的特征是4个分区的基元各不相同.(2)选择包含3个相同基元的运算器4个,对应于表1中的第5列.其中0称为关码,作用是关闭所在位置对应的主光路分区.(3)选择包含两个相同基元的运算器6个,对应于表1中的第6列.(4)选择包含一个基元的运算器4个,对应于表1中的第7列.XXXXX1X1X1X2X1X1X2X3X1X2X3X40XXX00XX000X合并基元测试例和运算器测试例得到本次实验5.3实验用例的实验用例共计50例.6实验过程及结果分析为了规范实验操作步骤和准确记录实验结果,我们为每一个实验用例制作了一张纸质的基元说明页,总共50张,其中基元测试页22张,运算器测试页28张.每张说明页中包含各个分区上基元的编号、标识、重构命令(未使用分区的重构命令为关码)、光状态变化表和一个像素位运算器的整体状态变化表.另一方面,要对状态变化表中的每种输入组合依次进行实验,因此还制作了9张实验步骤指示纸质页,用于指示当前实验操作的输入值(a1,a2,bv,bh)和对应的输入光状态(如ab=WH).实验时,首先根据基元说明页设置好每个分区的重构命令或者关码,完成一位可重构三值光学处理器的重构过程;然后根据实验步骤指示页依次完成9步实验操作并记录实验结果.重复上述步骤,直至50个实验用例全部被执行.图5是针对17H号基元测试的实验结果之一,右上部分为主光路光学模块的局部放大图,该实验用例只在HH分区构建有17H号基元,其他3个分区为关码,其实验步骤指示页标示这次操作是执行第④步,即a端输入无光态(W),b端输入水平偏振光态(H).根据基元说明页,第④步操作时理论预测输出(C)为水平偏振光,从主光路光学模块上很容Page7易看到HH分区中有亮点,其他3个分区均无亮点,即目测运算结果为水平偏振光,实验箱上运算结果输出数码管的H位为1,W和V位为0,也表明运算结果是水平偏振光,故实验结果与理论结论一致,于是得到成功的手势.图6是针对“X1X2X3X4”型运算器测试的实验结果之一,构成该运算器的基元分别是:HV分区中重构码为4cH的基元、HH分区中重构码为0bH的基元、VV分区中重构码为d5H的基元、VH分区中重构码为90H的基元.当前实验步骤是第④步,根据基元说明页的理论预测,输出(C)为垂直偏振光,从主光路光学模块上很容易看到VV分区中有亮点,其他3个分区均无亮点,即目测运算结果为垂直偏振光,实验箱上运算结果输出数码管的V位为1,W和H位为0,也表明运算结果是垂直偏振光,故实验结果与理论结论一致,于是得到成功的手势.对50个实验用例各进行9步实验操作,得到450张实验结果记录照片,实验结果全部与理论预测一致,证明了可重构三值光学处理器重构理论的正确性和重构电路的有效性.7结束语本文给出了基于FPGA芯片的三值光学处理器重构电路具体设计,成功研制了一个像素位的可重构三值光学处理器,在其上通过50个实验用例,对全部42个基元和28个代表性逻辑运算器进行了实验研究.实验结果证明了可重构三值光学处理器理论的正确性和重构电路的有效性.本文所述实验系统亦是降值设计理论的全面实践,以本实验为基础的1024位可重构三值光学处理器样品已于2012年10月建成,而以此样品为蓝本构建的千位三值光学计算机应用研究系统———SD11已进入装配阶段.
