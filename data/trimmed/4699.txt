Page1基于二次相似度函数学习的行人再识别杜宇宁艾海舟(清华大学计算机科学与技术系北京100084)摘要行人再识别是一个有着非常重要现实意义的研究问题,它可以应用于刑事侦查、在公共场所中寻找丢失的小孩、个人相册管理以及电子商务等领域.同时由于光照、视角、人的姿态以及背景的变化,同一个人的表观在不同的监控视频中往往变化很大,解决行人再识别问题也非常有挑战性.在设计行人再识别算法时,给定行人图像的特征,考虑到不同的特征分量具有不同的区分能力,学习合适的相似度度量非常重要.度量学习是一类学习相似度度量的主流算法,这些算法通过学习一个马氏距离相似度函数(MahalanobisSimilarityFunction,MSF)来估计一对行人图像的相似度.然而MSF只与特征差分空间有关,忽略了一对图像中每个个体的表观特征,对于同一个人在不同场景中很大的表观变化的捕捉能力有限.为了加强相似度函数与每个个体的表观特征的联系,该文提出通过学习一个二次相似度函数(QuadraticSimilarityFunction,QSF),来估计一对行人图像的相似度.QSF是MSF的泛化形式,不但描述了一对行人图像的互相关关系,而且关联了一对行人图像的自相关关系,可以更好地捕捉同一个人在不同监控视频中很大的表观变化.为了学习QSF,该文分别从分类和排序的角度出发,设计两种不同的优化目标,提出了两种不同的学习QSF的算法.由行人再识别的公共数据集VIPeR和CUHK的实验表明,这两种不同的算法都可以学习到有效的QSF,识别性能优于已有的行人再识别算法.关键词视频监控;行人再识别;行人分析;度量学习;二次相似度函数学习;机器学习1引言行人再识别是指在已有的多个空间位置上不交叠的监控视频中,根据目标行人图像,检索目标行人是否出现在这些视频中.该技术可以广泛应用到多个领域,例如刑事侦查、个人相册管理、在公共区域寻找丢失的老人和小孩、电子商务等.同时,由于光照、视角、人的姿态以及背景的变化,在不同的监控视频中,同一个人的表观变化往往很大,因此解决行人再识别问题非常有挑战性.正因为此问题广泛的应用前景和面临的困难,近年来有大量的研究工作关注此问题[1-15].为了便于叙述,如果一对行人图像来源于同一个人,本文简称为相关行人图像对,否则简称为不相关行人图像对.文献[16]综述了近年来关于行人再识别问题的研究进展.为了匹配同一个人在不同摄像机视场中的图像,一个典型的行人再识别算法由两步组成:(1)抽取待查询图像和行人图像库中图像的特征;(2)利用上述行人图像的特征,根据相似度度量准则,计算行人图像之间的相似度,从而从行人图像库中检索出目标行人.先前的行人再识别算法根据这两步的侧重点不同大致分为两类:无监督的算法[1-4]和有监督的算法[5-14].无监督的算法侧重于图像特征的提取,然后利用标准的相似度度量(例如1范数、2范数、巴氏距离等)度量一对行人图像的相似度.其基本想法是手动设计具有稳定性和区分性的特征,以适应同一个人在不同场景下的表观变化.文献[1]利用行人图像的对称性,提出对称的局部累积特征来处理姿态、视角和光照的变化.为了处理姿态的变化,文献[2]从人体的每个部件区域抽取特征.各个部件区域的定位则采用人体姿态估计中经典算法,图案结构算法(pictorialstructure).文献[3]同样使用图案结构算法,通过图匹配计算相似度.文献[4]借助一个参考的行人图像库来学习每个行人的显著性特征,进而处理姿态和视角变换的问题.因为在不同的实际场景中,同一个人的表观变化很大,因此手动设计鲁棒的特征往往很困难.而提取这些手动设计的特征时间代价也很大.此外,当给定行人图像的特征,考虑到不同的特征分量具有不同的区分能力,而标准的相似度度量等同对待所有的特征分量,因此标准的相似度度量并不是最优的相似度度量.有监督的算法侧重于从简单的行人图像特征中,利用机器学习算法(例如AdaBoost、支持向量机、度量学习等)学习相似度度量,从数据中挖掘有区分性的信息.相对于无监督的算法,即使使用简单的行人图像特征,这些算法也可以捕获同一个人在不同场景中很大的表观变化,并且估计一对行人图像相似度的时间代价很低.此外,这些算法也有助于进一步提高通过无监督的算法得到的行人图像特征的性能.因此,本文主要关注当给定行人图像特征时,如何更好地学习一对行人图像的相似度度量.文献[5]利用Adaboost算法从一个特征池中学习最优的特征组合,进而定义一对行人图像之间的相似度.上述特征池由通过密集采样生成的水平条带的颜色和纹理特征组成.文献[6]则利用支持向量机,结合预先定义的具有一定区分性的特征向量学习相似度度量.上述方法也采用颜色和纹理特征,但与文献[5]不同,特征来源于均分的6个水平条带.近年来基于度量学习的算法受到普遍重视[7-12],这些算法通过学习一个马氏距离相似度函数(MahalanobisSimilarityFunction,MSF)来度量一对行人图像的相似度,使相关行人图像对获得尽可能高的相似度,而不相关行人图像对获得尽可能低的相似度.然而,以上所有算法学习的相似度函数只与特征差分空间有关,忽略了每个个体的表观特征,因此对于同一个人在不同场景中的很大的表观变化的捕捉能力有限.与以上算法不同,文献[13]将图像的空间分成不同的区域,对于每个区域学习各自的相似Page3度函数.文献[14]首先估计每个图像的显著性区域,然后学习与显著性区域相关的相似度函数.这两种算法都验证了学习与每个个体相关的相似度函数有助于提高识别性能.基于上述分析,本文提出利用一个二次相似度函数(QuadraticSimilarityFunction,QSF)来估计一对行人图像的相似度,进而捕捉不同摄像机视场下同一个人较大的表观变化.QSF与MSF有两方面的不同:(1)一对行人图像包含两种二阶关系:自相关关系和互相关关系.在MSF中,描述这两种关系的自相关矩阵和互相关矩阵互为负矩阵(详见第2节),因此MSF只与特征差分空间有关.而在QSF中,上述两个矩阵完全不同,因此QSF与每个个体的表观特征有关;(2)MSF仅仅描述了一对行人图像的二阶关系.但是QSF不仅描述了上述关系,而且描述了一对行人图像的一阶关系,加强了相似度函数与每个个体的表观特征的相关性.因此,QSF是局部自适应的,可以更好地捕捉同一个人在不同的场景中的很大的表观变化.在已有的度量学习算法中,学习相似度函数的优化策略大致分为两类:一类是类似于文献[8-10,12],从分类的角度出发,将相关行人图像对和不相关行人图像对看成是两个不同的类别,优化目标是使任图1两种不同的学习相似度函数的策略说明综上所述,本文的贡献概括为两个方面:(1)将行人再识别问题形式化为一个局部自适应的二次相似度函数(QuadraticSimilarityFunction,QSF)学习问题;(2)分别从分类和排序的角度出发,提出了意的相关行人图像对的相似度高于任意的不相关行人图像对的相似度,如图1(a)所示.图中A1和A2表示同一个人的不同图像,B1和B2,C1和C2类似.相关图像对A1和A2的相似度,不但要高于与A有关联的不相关图像对,例如A1和B1,而且需要高于与A没有关联的不相关图像对,例如C1和B2.另一类是类似于文献[7],从排序的角度出发,给定一个待考察的行人图像,只考虑与此图像有关联的相关行人图像对和不相关行人图像对,使它们的差异尽可能大,而不关注与此行人图像无关联的行人图像对,如图1(b)所示.相关图像对A1和A2的相似度,只要求高于与A有关联的不相关图像对,例如A1和B2,不再要求高于与A没有关联的不相关图像对,例如C1和B2.两种策略各有利弊.基于分类的策略考虑的行人图像对之间的关系比基于排序的策略复杂,但是前者比后者更容易受到噪声影响.为了学习QSF,本文分别从分类和排序的角度出发,设计了两种不同的新的优化策略.在行人再识别的公共数据集VIPeR[15]和CUHK[12]的实验表明,这两种不同的优化策略都可以学习到有效的二次相似度函数,识别性能优于已有的行人再识别算法.而这两种优化策略的识别性能相当.两种不同的优化策略学习二次相似度函数.本文第2节介绍如何学习二次相似度函数;第3节介绍基于QSF学习的行人再识别系统;第4节介绍本文算法在公共数据集上的实验;第5节总结全文.Page42二次相似度函数的学习在给定的特征空间中学习样本之间的相似度是机器学习和数据挖掘领域中一个非常重要的基本问题.许多算法需要一个合适的相似度度量来反映样本之间的重要关系,进而提高算法性能,例如K均值算法、最近邻分类器以及基于核函数的算法(例如支持向量机)等.因此,相似度度量的学习受到研究者的普遍关注,其中包括MLCC[17]、ITML[18]以及LMNN[19]等.受这些算法的启发,近年来,行人再识别问题的研究者也尝试设计合适的相似度学习算法[7-12],更好地估计一对行人图像的相似度.当给定一对可能来源于非交叠摄像机视场的行人图像(行人图像的特征向量为犡和犢,犡,犢∈Rd,d是特征维度),这些算法通过学习一个马氏距离相似度函数(MahalanobisSimilarityFunction,MSF)fM(犡,犢)来来度量一对行人图像的相似度,使相关行人图像对获得尽可能高的相似度,而不相关行人图像对获得尽可能低的相似度.MSF形式如式(1)所示:其中犅是一个半正定矩阵,用于保证相似度函数的对称性.正如引言所述,MSF只与特征差分空间有关,忽略了每个个体的表观特征,因此对于同一个人在不同场景中的很大的表观变化的捕捉能力有限.因此,本文通过学习一个二次相似度函数(QuadraticSimilarityFunction,QSF)fQ(犡,犢)来估计一对行人图像的相似度.QSF是MSF的泛化形式,而已有的工作却很少关注应用QSF来度量样本之间的相似度.QSF的一个复杂形式如式(2)所示:f珟Q(犡,犢)=犡T犃1犡+犢T犃2犢+犡T犅1犢+其中犃1,犃2,犅1,犅2∈Rd×d,犠1,犠2∈Rd,e∈R.考虑到一对行人图像对相似度的对称性,即f槇Q(犢,犡),令犃1=犃2,犅1=犅2,犠1=犠2,忽略脚标,f槇则得到QSF的一般形式,如式(3).fQ(犡,犢)=犡T犃犡+犢T犃犢+犡T犅犢+在QSF中,犠T犡+犠T犢描述了一对行人图像的一阶关系,犡T犃犡+犢T犃犢+犡T犅犢+犢T犅犡描述了一对行人图像的二阶关系,e是偏移量.在二阶关系中,犡T犃犡+犢T犃犢描述了一对行人图像的自相关关系,犡T犅犢+犢T犅犡描述了一对行人图像的互相关关系.因为式(3)已经保证了相似度的对称性,所以在QSF中,犃和犅并不需要是半正定矩阵.从式(3)可以看出,QSF是MSF的泛化形式.当犃=-犅,犠=0,e=0,并且犅是一个半正定矩阵时,可以从QSF得到MSF的形式.犃=-犅表示MSF的自相关矩阵和互相关矩阵互为负矩阵.犠=0表示MSF忽略了一对行人图像的一阶关系.因此,MSF仅与一对行人图像的特征差分空间有关,忽略了一对行人图像的每个个体的表观特征.而QSF是局部自适应的,捕捉用于行人再识别的区分性信息的能力更强.为了说明上述观点,作为举例说明,可以考虑如下的一维空间的二分类情形.其中一个类的样本来源于[-2,-0.3]的均匀分布,另一个类的样本来源于[0.3,2]的均匀分布.当给定一个样本x=-0.5,图2显示了采用不同的相似度函数,x和另一个样本y的相似度的分布,其中c(x)=c(y)表示x和y属于同一类,用实线表示,c(x)!=c(y)表示x和y属于不同类,用虚线表示.当相似度函数采用MSF,即fM(x,y)=-σ(x-y)2,如图2(a)所示,同类样本和不同类样本之间的相似度的范围有重叠.MSF并不能分开上述两类样本.因为σ并不影响两类样本之间相似度的相对关系,在图2中,σ=1.当相似度函数中的自相关矩阵和互相关矩阵不再互为负矩阵,增强互相关关系的影响,即fQs-(x-y)2+5xy,如图2(b)所示,同类样本和不同类样本之间的相似度的范围存在间隔,上述两类样本可以被分开.当进一步增加一阶关系,即fQ(x,y)=-(x-y)2+5xy-15(x+y),如图2(c)所示,同类样本和不同类样本之间的相似度的范围的间隔将增大,上述两类样本可以更好地被分开.以上示例说明QSF比MSF更加鲁棒.2.1基于分类的QSF学习算法本文将基于分类的QSF学习策略简称为QSFC.QSFC利用一个由相关行人图像对组成的集合S和一个由不相关行人图像对组成的集合D,学习相似度函数.学习目标是在新的度量准则下,相关行人图像对处于正无穷大,不相关行人图像对处于负无穷大.为了实现上述目标,首先利用一个逻辑回归函数将二次函数相似度的范围规范到[0,1],式(4)为转换函数.Page5然后通过最小化式(5)学到二次相似度函数的参数θ={犃,犅,犠,e}.Jc(θ)=-其中S表示集合S中元素的数目,犃F表示矩阵犃的Frobenius范数,β1和β2是为了防止过拟合的权重衰减参数,JS相关图像对和不相关图像对的相似度的能力,其定义如下:对于相关行人图像对犡和犢,优化式(5)可以使Cc(犡,犢)接近于1,犡和犢的相似度被压缩到正无穷大.对于不相关行人图像对犡和犢,优化式(5)可以使Cc(犡,犢)接近于0,犡和犢的相似度被压缩到负无穷大.因为目标函数Jc(θ)与逻辑回归函数类似,本文采用一种拟牛顿迭代优化算法L-BFGS算法[20]优化Jc(θ).优化算法的初始参数为欧氏距离相似度函数,即犃0=-犐,犅0=犐,犠0=0,e0=0.式(8)~式(11)给了每一轮迭代中参数的更新量,推导见附录1.犃Jc(θ){=-犅Jc(θ){=-犠Jc(θ){=-eJc(θ){=-算法1总结了基于分类的二次相似度函数学习算法(QSFC算法).算法1.QSFC算法.输入:由相关行人图像对组成的集合S和由不相关行输出:QSF的参数犃T,犅T,犠T,eT1.初始化犃0=-犐,犅0=犐,犠0=0,e0=0.2.根据式(8)~式(11),计算参数更新量犃Jc(θ),犅Jc(θ),犠Jc(θ),eJc(θ).3.利用L-BFGS算法计算参数更新率ε.4.根据参数更新量和更新率更新参数,即犃t+1=犃t-ε犃Jc(θ),犅t+1=犅t-ε犅Jc(θ),犠t+1=犠t-ε犠Jc(θ),Page6et+1=et-εeJc(θ).5.重复步2到步4,直到收敛.此时的参数为犃T,犅T,犠T,eT.2.2基于排序的QSF学习算法本文将基于排序的QSF学习策略简称为QSFR.给定一张行人图像犡,包含犡的一个相关的行人图像对(犡,犢)和一个不相关的行人图像对(犡,犣)形成一个三元组(犡,犢,犣).QSFR利用由三元组组成的集合O,学习一个相似度函数区分一对行人图像.学习的目标是使每个三元组中涉及的不相关行人图像对和相关行人图像对的相似度的差异尽可能的大.为了实现上述目标,首先利用一个逻辑回归函数将相似度的差规范到[0,1],式(12)为转换函数.然后通过最小化式(13)学到二次相似度函数的参数θ={犃,犅,犠,e}.Jr(θ)=-其中β1和β2是为了防止过拟合的权重衰减参数.优化式(13)可以使Cr(犡,犢,犣)接近于1,每个三元组中相关行人图像对和不相关行人图像对的差压缩到正无穷大.同样QSFR采用L-BFGS算法[20]优化Jr(θ).优化算法的初始参数仍采用欧氏距离相似度函数.式(14)~(17)给出了QSFR的每一轮迭代中参数的更新量,推导见附录2.犃Jr(θ)=-犅Jr(θ)=-犠Jr(θ)=-eJr(θ)=0算法2总结了基于排序的二次相似度函数学习算法(QSFR算法).算法2.QSFR算法.输入:三元组集合O,权重衰减参数β1和β2输出:QSF的参数犃T,犅T,犠T,eT1.初始化犃0=-犐,犅0=犐,犠0=0,e0=0.2.根据式(14)~式(17),计算参数更新量犃Jr(θ),犅Jr(θ),犠Jr(θ).3.利用L-BFGS算法计算参数更新率ε.4.根据参数更新量和更新率更新参数,即犃t+1=犃t-ε犃Jr(θ),犅t+1=犅t-ε犅Jr(θ),犠t+1=犠t-ε犠Jr(θ),et+1=0.5.重复步2到步4,直到收敛.此时的参数为犃T,犅T,犠T,eT.3基于QSF学习的行人再识别系统基于QSF学习的行人再识别系统包括3个阶段:(1)行人图像特征的提取;(2)QSF学习;(3)目标行人图像查询.整个系统如图3所示.而QSF则是根据QSFC或QSFR算法,利用训练数据集,离线学习得到.3.1行人图像的特征描述颜色和纹理是先前行人再识别算法常用的两种特征.后续试验表明,只用颜色特征,不用纹理特征,也可以学到一个很好的相似度函数.图4给出了提取一张行人图像的特征描述的示例.本文从4种颜色空间提取特征,即HSV,规范化的RGB(NRGB),CIELab和YCbCr.提取特征时,将一张行人图像均分为6个水平条带,对于每种颜色空间中每个通道,在每个水平条带上抽取16维的颜色直方图特征.上述所有特征级联形成行人图像的特征描述,该特征的维度为1152(6×4×3×16).本文使用的特征在行人目标主体未能填充行人图像时也有一定的适用性.不同场景中行人姿态的变化主要集中在水平方向上,而在垂直方向上并不很明显.本文使用的特征对于水平方向的移动具有一定的不变性.此外,也可以结合行人检测器和人体Page7姿态估计对行人图像进行校准,使行人目标主体较好填充行人图像.为了说明本文提出的通过学习一个二次相似度函数,来估计一对行人图像的相似度的有效性,本文在实验中采用了上述比较简单的行人颜色直方图特征.后续实验表明,虽然采用的特征简单,但本文算法性能优于已有的行人再识别算法.如果采用更加复杂的特征来描述行人图像,本文算法的识别性能会进一步提升.3.2QSF学习为了提高特征的有效性,便于QSF的学习,实验中首先利用PCA降维,将行人图像的特征维数降到150.对于VIPeR数据集[15],保持大约97.6%的能量.对于CUHK数据集[12],保持大约98.4%的能量.在训练阶段,根据QSFC或QSFR算法,离线学习一个QSF.当估计出QSF的参数犃,犅,犠,e,则根据式(3)评估一对行人图像犡和犢的相似度.3.3目标行人图像识别行人再识别的研究目标是在已有的多个空间位置上不交叠的监控视频中,根据目标行人图像,检索该行人是否出现在这些视频中.本文假设通过行人检测技术,已经将不交叠的监控视频转换为行人图像库.利用学习到的较优的相似度函数,度量目标图5公共数据集行人图像对举例为了评价行人再识别算法性能,累计匹配特性(CumulativeMatchCharacteristic,CMC)曲线在先前的算法中广泛被采用.CMC曲线描述的是在一个给定的行人图像库中检索目标行人图像,在前r个搜索结果中识别出目标行人的比例.第1匹配率(r=1)表征了算法真正识别能力,非常重要.但是,在实际应用中,因为可以借助人眼判断,从检索的前r个结果中发现目标行人,所以当r取值很小时的匹配率也值得去关注.因此,行人再识别问题也可以看成是一个信息检索问题.除了CMC曲线,本文引行人图像和行人图像库中所有图像的相似度.行人图像库中相似度高的图像为潜在的目标行人图像.4实验本节首先介绍实验细节,然后分析QSF模型,验证QSF的一阶关系和二阶关系的有效性.最后,比较本文算法和已有的行人再识别算法.4.1实验细节VIPeR[15]和CUHK[12]是行人再识别广泛使用的公共数据集,本文将在这两个数据集上评测本文算法.VIPeR数据集中每个行人有2张图像,这两张图像来源于2个不同的摄像机场景,总共由632个行人组成,所有图像的分辨率都被规范到48×128.CUHK数据集由971个行人组成,每个行人有4张图像,同样来源于2个不同的摄像机视场,每个视场有两张图像,所有图像的分辨率都被规范到60×160.图5显示了这两个数据集中一些图像,其中同一列中的行人图像为同一个人.因为这两个数据集中同一个人的表观由于姿态、视角、光照和背景的变化而变化很大,所以非常适合用于研究行人再识别问题.入规范化折扣累计增益(NDCG),信息检索中常用的评测指标来评测算法性能.NDCG可以根据CMC曲线,利用式(18)来计算.本文实验中评测算法性能时采用NDCG@15.其中G(i)是CMC曲线中第i匹配率,Page8本文采用行人再识别的标准评测框架评测本文算法性能[5,12,15].对于一个评测集合中所有行人,随机选择一半作为训练集,余下的作为测试集.测试集由行人图像库和查询集组成.对于测试集中的每个行人,随机选择一个场景的行人图像并入行人图像库,另一个场景的行人图像并入查询集.通过衡量在行人图像库中检索目标行人的能力来评测一个行人再识别算法的性能.与此同时,从VIPeR数据集中随机选择100个行人作为训练集,余下的用于测试,形成一个新的实验场景用于评估基于学习的行人再识别算法的过拟合程度.上述每组实验的过程重复10次,每组的实验结果为相关的10次实验的平均值.因为本文组织实验是按照行人再识别的标准评测框架,已有算法的性能直接从相应文章的图表中获得.4.2QSF模型分析为了验证QSF的一阶关系和二阶关系的有效性,本文在两个公共数据集上,采用本文提出的两种优化策略分别学习MSF、QSF和QSFs(只含有二阶关系的QSF).其中基于分类的策略的算法简称为MSFC、QSFC、QSFCs;基于排序的策略的算法简称为MSFR、QSFR、QSFRs.表1和表2显示了比较结果.在VIPeR数据集上,QSFCs的检索性能比MSFC大约高2.1%,QSFRs的检索性能比MSFR大约高2.5%,其中检索性能指NDCG@15.在CUHK数据集上,QSFCs的检索性能比MSFC大约高2.8%,QSFRs的检索性能比MSFR大约高3.2%.由此可见,利用两个完全不同的矩阵描述自相关关系和互相关关系,可以使相似度函数局部自适应,有益于行人再识别.此外,在VIPeR数据集上,QSFC的检索性能比QSFCs大约高2.8%,QSFR的检索性能比QSFRs大约高1.6%.在CUHK数据集上,QSFC的检索性能比QSFCs大约高5.5%,QSFR的检索性能比QSFRs大约高4.3%.在相似度函数中引入一对图像的一阶关系,可以进一步使相似度函数局部自适应,提高性能.表1在VIPeR数据集上QSF和MSF的比较算法QSFCQSFCs0.259MSFCQSFRQSFRs0.271MSFR表2在CUHK数据集上QSF和MSF的比较算法QSFCQSFCs0.235MSFCQSFRQSFRs0.224MSFR防止过拟合的权重衰减参数β1和β2是本文提出的两种学习QSF的算法的主要参数.本文从VIPeR数据集中随机产生一轮测试集规模为316的实验,通过交叉验证决定上述参数.这轮实验与参与评测算法性能的10轮实验不同.图6描述了QSFC和QSFR的检索性能随β1和β2的变化.在本文的实验中,对于QSFC,β1=2.5×10-6,β2=0.1;对于QSFR,β1=1.0×10-6,β2=0.5.4.3与先前的行人再识别算法对比表3将本文的算法QSFC和QSFR与已有的无监督的行人再识别算法在VIPeR数据集(测试集规模为316)上进行对比,其中包括SDALF[1]、CPS[2]、MCTCS[3]、eSDC[4].QSFC的检索性能比SDALF大约高21.6%,比CPS大约高16.3%,比MCTCS大约高13.9%,比eSDC大约高10.7%.QSFR的检索性能比SDALF大约高20.6%,比CPS大约高15.3%,比MCTCS大约高12.9%,比eSDC大约高9.7%.这些表明,即使使用简单的颜色直方图特征,从数据中学习有区分性的信息,要优于只是单纯的通过手动设计鲁棒性的特征的算法.表3在VIPeR数据集,与无监督的行人再识别算法QSFCQSFRSDALF[1]0.2000.3900.4900.5800.389CPS[2]MCTCS[3]0.2300.4800.4000.6900.466eSDC[4]表4将本文的算法QSFC和QSFR与已有的有监督的行人再识别算法在VIPeR数据集(测试集规模为316)上进行对比,其中包括LF[11]、LAFT[13]、RPLM[10]、SalMatch[14].因为这些算法明显优于文献[5-9,12]中的有监督的行人再识别算法,因此本文只与这些算法进行对比.QSFC的检索性能比LF大约高10.1%,比LAFT大约高7.1%,比RPLMPage9图6QSFC和QSFR的检索性能随β1和β2的变化曲线大约高7.4%,比SalMatch大约高8.2%.QSFR的检索性能比LF大约高9.1%,比LAFT大约高6.1%,比RPLM大约高6.4%,比SalMatch大约高7.2%.QSFC和QSFR优于基于MSF的算法LF和RPLM,可见QSF与MSF相比,更易描述不同摄像机视场下同一个人的有区分性的信息.此外,QSFC和QSFR也优于基于与个体相关的相似度函数学习的算法LAFT和SalMatch.可见利用QSF挖掘相似度函数与个体表观之间的关系更加有效.表4在VIPeR数据集,与有监督的行人再识别算法QSFCQSFRLF[11]LAFT[13]RPLM[10]SalMatch[14]0.3020.5250.6600.7400.523表5将本文的算法QSFC和QSFR与已有的有监督的行人再识别算法在训练数据较少时进行比较,其中包括PRDC[7]、PCCA[9]、LAFT[13]和RPLM[10].QSFC的检索性能比PRDC大约高13.1%,比PCCA大约高12.6%,比LAFT大约高6.6%,比RPLM大约高11.3%.QSFR的检索性能比PRDC大约高12.1%,比PCCA大约高11.6%,比LAFT大约高5.6%,比RPLM大约高10.3%.这些表明,当训练数据较少时,QSFC和QSFR缓解了基于学习的算法的过拟合问题.表5在VIPeR数据集,与有监督的行人再识别算法QSFCQSFRPRDC[7]PCCA[9]LAFT[13]0.1290.3030.4270.5200.312RPLM[10]0.1100.2500.2800.4600.265表6将本文的算法QSFC和QSFR与SalMatch[14]在CUHK数据集上进行对比.因为文献[14]中表明SalMatch在这个数据集上优于已有的算法,因此本文只与SalMatch进行对比.虽然QSFC和QSFR的第1匹配率低于SalMatch,但是QSFC和QSFRPage10自第5匹配率以后,明显高于SalMatch.QSFC的检索性能比SalMatch大约高5.2%,QSFR的检索性能比SalMatch大约高2.9%.SalMatch是基于与个体相关的相似度函数学习的算法,实验结果再次说表6在CUHK数据集,与已有的行人再识别算法比较算法QSFCQSFRSalMatch[14]0.2850.4600.5500.6350.460图7利用QSF从行人图像库中查询目标行人的示例5结论本文将行人再识别问题形式化为一个二次相似度函数学习问题.QSF是马氏距离相似度函数的泛化形式.与MSF相比,QSF重新设计了一对行人图像的二阶关系,并且引入一对行人图像的一阶关系,从而可以更好地捕捉同一个人在不同摄像机视场下较大的表观变化.为了学习QSF,本文分别从分类和排序的角度出发,设计了两种不同的新的优化策略.由行人再识别的公共数据集VIPeR和CUHK的实验表明,这两种不同的优化策略可以学习到有明了QSF可以更好地挖掘相似度函数与个体表观之间的关系.图7给出一些利用QSF从行人图像库中查询目标行人的示例.在每个示例中,最右边的两张行人图像显示了待查询图像和行人图像库中与其匹配的图像.而x轴上的5张图则是根据QSF计算的相似度,从左到右依次为行人图像库中与待查询行人图像相似度最高的5张图像.图中的相似度的值是利用式(4)进行规范化后的值.效的二次相似度函数,识别性能优于已有的行人再识别算法.
