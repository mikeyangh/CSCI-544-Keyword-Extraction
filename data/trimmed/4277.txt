Page1一种基于Google的OCR结果校对新方法颜建强高新波(西安电子科技大学电子工程学院西安710071)摘要为了提高OCR识别率,许多校对算法被提出用作后处理.这些方法利用自然语言规律统计大量的语料库进行语法判断.由于语料库规模有限且无法及时更新,导致一些网络新词、专用名词等常被错误处理.为此,文中将传统的语料库和Google知识库相结合,利用Google知识库获得网络新词等出现的频率,建立N-Gram模型,利用词语间的接续关系进行查错,再借助Google的拼写校对功能和词语之间的可信度进行改错.相比传统的方法,该方法的语料库源于互联网,对一些新词有更好的校对效果,更适合图像中嵌入的文字信息识别结果的校正.关键词OCR;校对;语料库;Google;纠错1引言随着互联网的发展,视频和图像已经成为人们传递信息的主要手段.视频、图像中的文字与媒体内容密切相关,有助于媒体内容的理解.通过光学字符识别(OCR)技术可以从视频、图像中提取出其中的文字信息.目前,该技术已经广泛地应用在了图像检Page21971年,斯坦福大学的Ralph实现了一个英文拼写检查程序SPEN[2].随着新技术的不断涌现,针对该问题的研究取得了一些突破性的进展.Hisao等人[3]提出了一种基于模式学习的OCR识别结果校对算法,通过字典生成一个候选错误列表,根据词汇表和字符的语法环境选择一个最合适的候选词.Liu等人[4]提出了一种OCR错误校对的统计方法,基于N-Gram模型字典生成候选的错误列表,根据频率矩阵选择一个频率最高的词.Wang等人[5]提出了一种手写中文字符识别的框架,在识别过程中组合字符分类、几何和上下文语境利用贝叶斯决策评价候选路径,使用最大字符精度准则确定候选字符,并在识别过程中实现了自动纠错.微软亚洲研究院[6]实现了一个基于多特征的中文自动校对方法,采用Winnow方法进行特征学习,利用这些上下文特征对目标词混淆集中的词进行选择.Zhang[7]提出一种利用综合近似字集替换,并用统计语言模型评分的方法,将评分最高的字符串与待校对文本中的句子进行对照.这些文本校对算法的提出,有效地提高了扫描文档中OCR的识别率.然而,随着我们把校对范围扩展到更复杂的情况,又有一些新的问题出现,比如,网络上自然图像中字符识别校对问题.由于自然图1系统框架图2犖-Gram模型计算机语言学认为自然语言的知识可由连续符图像语法规则较弱,专有名词和新词较多,传统的文本校对方法很难取得好的效果,Bassil和Alwani[8]总结了传统方法的缺点,他们认为“一是需要一个足够大的字典,二是不能同时支持多种语言,三是对一些人名、国家地区名和专有名词支持不够,四是字典是静态的,无法动态的增加新词”.所以他们提出了一种利用Google拼写校对接口进行校对的方法,Google具有海量的数据库,将一个错误的词送入Google搜索引擎时,Google搜索引擎能通过比对海量数据来预测出这个错误,并给出一个建议的代替词.受其启发,我们将传统的文字校对方法和Google知识库相结合来解决传统字典在专业词汇方面不足的问题.本文所提出的系统框架如图1所示.先以北京大学标注的1998年《人民日报》语料库为基础,利用N-Gram模型训练一个语料库.然后利用互联网不断地完善语料库,对于语料库中的词,利用词语之间的互信息判断接续关系是否合理,不包含在语料库中时,利用Google搜索引擎得到词语出现的次数,计算概率并加入到语料库进行进一步处理.对于不合理的接续关系,先用Google拼写校对功能进行校对,对于不能正确校对的,再利用词语之间的可信度提供若干个纠错意见供用户选择.号组成序列的概率来表示[9].如果用变量W代表文本中一个任意的词序列,它由顺序排列的n个词组成,即W=w1w2…wn,该词序列W在文本中出现的概率为P(W),利用概率的乘积公式表示如下:Page3P(W)=P(w1)P(w2|w1)P(w3|w1w2)…被称为N-Gram模型.要预测词wn的出现概率,必须知道它前面所有词的出现概率,从计算量上来看,这种方法太复杂.Markov模型认为,任何时刻的信源符号发生的概率只与前面已经发生的数个符号有关,而与更前面发生的符号无关.由于自然语言可以看成是一个离散的Markov模型,任意一个词wi的出现概率可以认为只与它前面的若干个词有关.这样,问题就可以得到极大的简化,通常N=2,也就是二元关系模型[10]如下:在二元关系模型中,把组成这条语句的单词看作一连串的随机事件,然后借助互信息来研究和分析它们.互信息是一种计算两个随机变量之间共有信息的度量,当两个随机变量相关时,他们的互信息大于零,互信息越大,结合程度越强,当变量之间不存在依赖关系时,它们的互信息小于零[11].词间的互信息可以表示词串之间的前后接续关系,定义如下:其中,MI(wi,wi+1)为两个词wi和wi+1的互信息,P(wi)为词串wi在语料库中单独出现时的概率,P(wi,wi+1)为词串wi,wi+1在语料库中的同现概率.用M表示语料库中的总词数,R(wi)表示wi在语料库中单独出现的次数,R(wi,wi+1)表示wi,wi+1在语料库中的同现的次数,结果如下:P(wi)=R(wi)互信息表示字符串序列(wi,wi+1)形成可信赖的搭配出现的概率,设定一阈值ζ1,若词间的互信息大于ζ1,则认为上下文衔接合理,否则认为上下文衔接不合理.3查错要判断词串的接续关系,需要在大规模的语料库上进行统计分析.很多研究机构发布了语料库的研究成果[12],1998年北京大学发布的《1998年人民日报》免费文本语料库是已经标记好的语料库.通过对语料库进行分析,可以得到每个词语单独出现和同时出现的概率,利用概率计算两个词的接续关系.由于该语料库较早,包含的人名、地名和一些专有名词较少,特别是近两年互联网新词不断出现,该语料库不能适应自然图像和视频的文本校对.为此,我们利用Google知识库进行大范围的训练,完善语料库的覆盖范围.对于输入的一个新词,如果没有在语料库中,利用Google搜索引擎得到词语的概率如下所示:这里,Totalpagesnumber表示互联网的词库总数,我们使用Google收录的网页数目来代替,2008年7月Google软件工程师耶西·阿尔波特(JesseAlpert)和尼森·哈扎伊(NissanHajaj)公布称Google收录的网页总数达到了一万亿幅①.Wordsindexednumber表示Google检索到包含该词组的网页总数,如图2框中标记所示,可以通过Google的接口②获得.这样就可以计算该词出现的概率P(wi).在实验中,我们对所得到的概率进行了如下的归一化:P(wi)=I这里,I表示Google搜索引擎检索到的词条数,N表示Google包含的页面总数,M表示语料库包含的词数,A表示词在语料库中出现的平均次数,T表示语料库的大小.图2Google检索界面(框中是检索到的词条数)通过以上方法,新词被不断地加入,语料库被不①②Page4停地更新,语料库的适用性和准确性也在不断的提高,可以用来检查各种词语的接续关系.对于一个测试的句子S表示为S=c1c2…cici+1…ck=w1w2…wjwj+1…w(7)其中,ci表示句子S中的字,wj表示S中的词,i=1,…,k,j=1,…,,ci、ci+1为相邻字,wj、wj+1为相邻词.由于词是由字组成的,故wj=c1c2…ck,可以通过词与相邻字之间的接续关系判断词语的合法性.对于句子S中的任意连续出现的两个词wi和wi+1的接续关系定义为MI(wj,wj+1)≈log2P(wj·ck,wj+1·c1)其中,P(wj·ck)为词wj的最后一个字ck在语料库中出现的频率,P(wj+1·c1)为词wj+1的第1个字c1在语料库中出现的频率,P(wj·ck)P(wj+1·c1)为两个字在语料库中连续出现的频率.在实验中,我们使用基于字符串匹配中的逆向最大匹配法进行分词,然后使用两个相连词的相连字的互信息和两个相连词的互信息的加权作为连续性判断依据,如果互信息小于阈值ζ1,则认为该处存在错误.4纠错文本纠错是把查错过程中检测出来的错误字符串修改为正确字符串或者给出修改建议.由于OCR识别后文本中的错误形式变化多端,无法预测何时有何种噪音影响,所以目前还没有有效的方法.我们将Google的拼写校对功能和词串的可信度结合,对于查出的错误,先使用Google提供的拼写校对功能改错①,当用户输入一个错误的词进行搜索时,Google会给出一个合理的拼写建议.如图3所示.算法1通过调用Google提供的接口获取拼写建议图3Google拼写校对界面(框中是Google拼写校对)进行修正,由于Google是基于整个互联网信息的,所以对新词、专用名词一些不正确的拼写会进行修正.算法1.Google拼写校对算法.输入:句子S;错误位置ErrorBegin,ErrorEnd输出:句子S过程://将错误字符串赋给PP=Substring(S,ErrorBegin,ErrorEnd)//调用Google搜索引擎检索PResult=GoogleSearch(P)IF(有校对建议)ThenEndifUpdateS//更新句子S对于Google不能给出拼写建议的错误词串,我们使用词语的可信度来选择合理的词,词语的可信度函数定义如下:其中,n为语料库中的词数.对于两个不同的字串,可以使用它们之间可信度的差来计算哪个串的可信度更高.串S2对串S1的可信度定义为设定阈值ζ2,当存在串S2对于串S1的可信度大于给定的阈值ζ2时,则对于出错串S1,S2为一个纠错建议.统计发现,OCR识别错误一般包含3种情况:漏字、多字和别字,因此,分别构造漏字校对候选集、多字校对候选集和别字校对候选集来形成候选串,过程如算法2,按可信度的大小对这些候选字串进行排序,显示纠错建议供用户选择,软件界面如图4所示.①GoogleSpellCheckerGuide[EB/OL].http://www.Page5算法2.纠错校对候选集构造算法.输入:错误字符串P;语料库C;常用别字替换集FC;P输出:P的漏字校对候选集,多字校对候选集合别字校对过程:P=c1…cici+1…cn//构造P的漏字校对候选集InsSet(P)Fori=1..nDoEndFor//构造P的多字校对候选集DelSet(P)Fori=1..nDoP=c1c2…ci-1ci+1ci+2…cnIF(AC(P,P)>ξ2)加入P的多字校对候选集EndFor//构造P的别字校对候选集RepSet(P)Fori=1..nDo图5文字识别结果(下划线标记文字为OCR识别错误的文字,底色阴影标记为算法正确校对的文字)方法正确表1OCR识别结果校对算法比较汪维家等方法[15]223750336762514272.9658.7238.6983林晖等方法[14]223750339560316778.5265.5142.2875Bassil等方法[8]223750324330412848.3179.9352.671720本文方法223750340252725779.9276.2863.93416EndFor5实验为了测试本文提出的校对方法的有效性,我们采用C++进行了系统的开发实现及测试.测试库来源于vLecture项目(一个虚拟的学习社区,提供基于内容的视频片段搜索)和互联网,我们使用Yan的方法[13]提取文字区域进行OCR识别,该方法将文字作为一种特殊的纹理,利用Gabor滤波器提取4个方向的纹理信息,然后使用SVM分类器得到文字区域,对复杂背景下文字区域的定位具有较好的效果.为了测试算法的有效性,采用召回率、查准率和改正率来评价系统[14].测试图片从vLecture项目和互联网上选择了50幅图像,原始图像如图5(a)所示,OCR识别结果如图5(b)所示,识别错误部分用下划线标记.图5(c)为最终的OCR校对结果,校对时默认采用可信度最大的一个词自动校对,正确校对的结果用阴影底色标记.50幅图片共包含文字2740个,其中正确识别2237个,错误503个.与传统OCR校对方法的比较如表1所示.纠正的错误总数召回率/%查准率/%改正率/%时间复杂度/sPage6汪维家等方法[15]是目前比较经典的传统方法,林晖等方法[14]是对Markov算法的改进,召回率较高,这两种方法的语料库都是固定的,对互联网上出现的一些新词和专用词效果不佳,查准率都比较低.Bassil等方法[8]完全依赖于Google搜索引擎,由于Google包含的内容太多,词语组合形式复杂,召回率较低.另外,Google提供的纠错功能对英文的校对效果要好于对中文的校对效果,对很多中文句子,Google不能给出正确的纠错建议,改正率也有限.因此,本文在此基础上对Google不能处理的词语分别构造漏字校对候选集、多字校对候选集和别字校对候选集来形成候选串,根据可信度的大小选择纠错词,实验结果表明,改正率提高了10%以上.本文的方法原理上属于林晖等方法[14]和Bassil等方法[8]的结合,由于语料库是不断完善的,能处理包含新词、专业名词等各种词语,召回率比较高,另外,本文提出的方法不但能有效地利用词语之间的可信度关系给出正确建议,而且具有Google拼写校对的优势,改正率较高.本文的方法和Bassil等方法[8]都需要调用Google的接口获取数据,而调用Google接口受网速的影响较大,在实验室(100MB共享)网络环境下,各算法的时间复杂度如表1所示.汪维家等方法[15]和林晖等方法[14]不需要访问网络,速度非常快,分别耗时83s和75s.Bassil等方法[8]对每个词都需要调用Google接口,耗时1720s.我们的方法对大部分传统词汇通过语料库来处理,只有少量的语料库中没有的新词需要调用Google接口,耗时416s,而且随着语料库不断的积累,需要通过Google接口获取的新词会越来越少,速度会逐步逼近林晖等方法[14].6小结文字识别一直是模式识别中研究的重点,许多文字识别方法被提出[16],这些方法主要集中在OCR识别前的去干扰上,但由于很多字符、文字的相似性,OCR识别依然有很多错误,为了进一步提高OCR识别率,本文提出了一种基于Google的识别结果校对方法.该方法将传统的基于N-Gram方法和Google知识库相结合,利用Google知识库来不断的丰富传统的语料库,有效地解决了传统N-Gram方法在字典词汇量有限,对新词、专有名词无法校对的问题.该方法首先利用词语之间的互信息判断接续关系的合理性,对于找出的错误,先用Google的拼写校对功能进行校对,再利用词语之间的可信度提供纠错意见供用户选择.本方法实用性比较强,在vLecture项目中有效地提高了OCR的识别率.
