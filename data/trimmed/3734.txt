Page1基于多变量公钥密码体制的无证书多接收者签密体制李慧贤1)陈绪宝1)庞辽军2)王育民2)1)(西北工业大学计算机学院西安710072)2)(西安电子科技大学综合业务网国家重点实验室西安710071)摘要针对基于身份的多接收者签密方案不能抵抗量子攻击以及存在的密钥托管问题,基于多变量公钥密码体制,提出一个多接收者模型下的无证书签密方案.新方案不仅避免了基于身份密码体制的密钥托管问题,而且继承了多变量公钥密码体制的优势,实现了“抗量子攻击”的高安全性.与现有方案相比,新方案无需双线性对操作,具有更少的计算量,更高的计算效率,适用于智能卡等计算能力较小的终端设备.最后,在随机预言模型下,给出了该文方案基于MQ困难问题假设和IP困难问题假设的安全性证明.分析表明,该文方案具有不可否认性、前向安全性、后向安全性、保护接收者隐私等安全属性.关键词多变量公钥密码;无证书签密;多接收者签密;抗量子攻击1引言传统的公钥基础设施中,一个可信中心用于管理用户的证书,但它会带来证书管理问题,包括证书的产生、存储、分配及销毁等.为了解决传统公钥密码体制中的证书管理问题,文献[1]提出了基于身份的公钥密码体制,它的主要思想是利用用户的数字身份信息作为它的公钥,同时,系统还需要一个可信的第三方用于计算用户的私钥信息.然而,基于身份的公钥密码体制存在密钥托管问题.为了解决密钥托管问题,Al-Riyami等人[2]在2003年首次提出无证书密码体制,并立刻成为密码学领域的研究热点.在该体制中,用户的私钥由两部分组成:一部分是由密钥生成中心KGC(KeyGen-eratorCenter)生成,另一部分则由用户生成,这样就解决了传统公钥密码体制中的证书管理问题,并消除了基于身份的密码体制中的密钥托管问题.2008年,Barbosa等人[3]首次将签密思想引入无证书密码体制.签密技术[4]能够在一个逻辑步内同时实现签名和加密两项功能,而且其计算量和通信开销均大幅低于传统的“先签名后加密”方案,是实现既保密又认证消息传输的理想方法.此后,无证书签密得到学者的广泛研究[5-6].Barbosa等人[3]的方案利用双线性对运算提出了一种具有前向安全性的无证书签密方案,但没有给出安全性证明.2008年,Selvi等人[7]首次在多接收者模型下构建了一个无证书签密方案,但是方案的计算量较大.随后,Selvi等人研究发现文献[7]的方案在伪造性攻击下是不安全的,并在2009年给出一个改进方案①.然而Mi-ao等人[8]指出Selvi等人的改进方案在内部攻击下依旧是不安全的,并给出了详细的安全分析.2010年,Li等人[9]利用双线性对构造了无证书签密方案,并对方案进行了可证明安全分析,但该方案计算效率较低.朱辉等人[10]和Jing[11]分别基于离散对数问题提出不使用双线性对的无证书签密方案,使计算量进一步降低,并在随机预言机模型下分析了方案的安全性.随着无线网络和移动终端的快速发展,构建安全、高效的通信是首要解决的问题,然而,移动终端的计算能力低和无线网络的带宽窄,严重制约了包含双线性对等复杂运算的签密方案的应用.迄今为止,几乎所有的无证书签密方案都是基于公钥密码实现的,这些公钥密码的安全性主要基于因式分解和离散对数问题.随着量子计算机的发展,公钥密码所依赖的数学难题将得到解决,现有的无证书签密方案的安全性将会受到威胁②.因此,设计一个抗量子攻击的无证书签密方案成为一项越来越紧迫的任务.多变量公钥密码能够抵抗量子计算机的攻击,被认为是后量子时代的一种安全的密码体制,其安全性是基于有限域上二次方程的难解性,与现有基于身份的密码体制相比,其计算量大大减少,计算效率更高,并且可以在低端设备上实现强安全性的通信.基于多变量密码体制的签名方案得到广泛研究[12-13].据此,本文利用多变量密码体制对现有的无证书签密方案进行改进,提出一个基于多变量密码体制的多接收者无证书签密方案,新方案不仅具备无证书体制的优势,而且可以以轻量级的计算实现抗量子攻击的高安全性,新方案可以完美地解决上述问题,符合实际需求.最后在随机预言模型下,对新方案进行了详细的安全性证明.此外,该方案还具有前向安全性、后向安全性、不可否认性、保护接收者隐私等安全属性,与现有的其它无证书签密方案相比效率更高.2预备知识2.1MQ问题和IP问题本节简要介绍多变量公钥密码学的相关背景知识,包括多变量多项式方程组、MQ问题和IP问题.选取一个大素数p,G是以p为阶的有限域.令n表示变量的数目,g为方程的数目,d表示方程组的全次数.x1,x2,…,xn是有限域G上的n个变量.令P表示全次数为d由g个n元变量多项式组成的多项式组,即P=(p1,p2,…,pg),其中pi(i=1,2,…,g)定义如下:pi(x1,x2,…,xn)=∑1jkn上式中所有变量x和系数α、β、γ都在域G中.yg是有限域G上的元素,pi同式(1)定义,那么定义1.多变量多项式方程组:令yl,y2,…,①iacr.org/2009/308,2009②Page3就是一个多变量多项式方程组.式方程组就称为二次多变量方程组.当全次数d=2时,有限域G上的多变量多项定义2.给定有限域G的二次多变量方程组:p1(x1,x2,…,xn)=p2(x1,x2,…,xn)…其中pi的系数和变量均取自有限域G,求解该方程组的问题称为MQ问题(MultivariateQuadratic-Problem).MQ问题已经被证明是NP-困难问题[14].多变量公钥密码体制的安全性依赖于MQ问题的难解性.定义3.设P和Q为有限域G上两个随机的n元g个方程的多变量方程组,且P和Q同构,则有P=TQV(符号表示映射合成),T和V分别为Gn上的两个可逆的仿射变换,这里Gn表示有限域G的n(n为一个正整数)次扩张.称寻找从P~Q同构的(T,V)问题为IP问题(IsomorphismofPol-ynomialsProblem),即多项式同构问题.1996年,在欧密会上Patarin证明了IP问题为NP困难问题[15].因此,可以利用IP问题将陷门T、V很好地隐藏到公钥P中,从而构造多变量公钥密码体制的单向陷门函数.2.2多变量公钥密码体制基本结构公钥:多变量加密结构的公钥为P=TQV,其中Q是选择的中心映射,V是一个在有限域Gn上随机选择的可逆映射,V:Gn→Gn,T是一个在有限域Gg上随机选择的可逆映射,T:Gg→Gg,T和V主要用于隐藏中心映射Q.Q是Gn到Gg的中心映射,它的多项式表达形式为包含n个变量g个多项式的方程组:Q(x1,x2,…,xn)=(p1(x1,x2,…,xn),…,私钥:三元组(T,Q,V)为多变量加密结构的私钥.加密过程:令x为明文消息,x=(x1,x2,…,xn),带入公钥多项式,计算P(x),得到的y=(y1,y2,…,yg)即为加密密文.解密过程:接收到密文y=(y1,y2,…,yg),解密密文即计算方程P(x)=y的根,x=P-1(y),可以先后计算yT=T-1(y),yQ=Q-1(yT),x=V-1(yQ),最终得到明文消息x=(x1,x2,…,xn).2.3算法模型一个无证书多接收者签密方案由5个概率多项式算法组成,包括系统建立算法、部分密钥生成算法、用户密钥生成算法、签密算法和解签密算法[7].结合多变量密码体制的特点,本文对无证书多接收者签密方案进行了改进,在部分密钥生成阶段,KGC生成了通用的系统部分公钥和系统部分私钥.(1)系统建立算法(Setup):该算法由KGC运行.输入秘密参数s0,返回系统参数params.(2)部分密钥生成算法(PartialKeyExtract):该算法由KGC运行.KGC生成系统主密钥w,输入系统参数params和系统主密钥w,KGC输出系统的部分公钥PPu和部分私钥PSu,即{w,params}→{PPu,PSu}.(3)用户密钥生成算法(KeyExtract):输入公共参数params、PPu、PSu和用户身份IDu,用户U执行该算法生成自己完整的公钥PKu和私钥SKu,即{PPu,PSu,IDu,params}→{PKu,SKu}.(4)签密算法(Signcrypt):签密算法由发送者Sender执行.输入params、消息m、发送者身份IDs、发送者私钥SKs以及接收者组L的身份和公钥信息,算法最后输出密文σ,即{params,IDs,SKs,m,L0,L1}→σ,其中接收者身份集合L0={ID1,ID2,…,IDt},接收者公钥集合L1={PK1,PK2,…,PKt}.(5)解签密算法(De-Signcrypt):输入params、σ、签密者身份IDs、公钥PKs、接收者身份IDi及其私钥SKi,若验证通过则输出m,否则解密失败输出⊥.若正确解签密即有{params,σ,IDs,PKs,IDi,SKi}→m.2.4安全模型基于多变量的无证书多接收者签密的安全模型是基于Selvi等人[7]所定义的无证书多接收者签密的安全模型,对于无证书密码体制面对两种类型攻击:类型1攻击和类型2攻击.对应两类攻击者,分别为A1和A2.在类型1攻击中,A1可以替换所有用户的公钥,但不能得到KGC的主密钥;在类型2攻击中,A2代表恶意的KGC,可以知道系统主密钥但是不允许替换任何公钥.定义4.类型1攻击下的机密性.若不存在任何多项式有界敌手A以不可忽略优势赢得IND-CLMSC-CCA2-1游戏[7],则称该基于多变量的无证书多接收者签密方案在适应性选择密文攻击下具有不可区分性(Type1-IND-CLMSC-CCA2).敌手A在IND-CLMSC-CCA2-1游戏中需遵守以下限制:(1)不能对系统主密钥进行询问;(2)不能对挑战者集合中的身份进行私钥提取询问;(3)不能对挑战密文执行解签密询问.Page4定义5.类型2攻击下的机密性.若不存在任何多项式有界敌手A以不可忽略优势赢得IND-CLMSC-CCA2-2游戏[7],则称该基于多变量的无证书多接收者签密方案在适应性选择密文攻击下具有不可区分性(Type2-IND-CLMSC-CCA2).敌手A在IND-CLMSC-CCA2-2游戏中需遵守以下限制:(1)不能对挑战者集合中的身份进行私钥提取询问;(2)不能进行公钥替换询问;(3)不能对挑战密文执行解签密询问.定义6.类型1攻击下的不可伪造性.若不存在任何多项式有界敌手A以不可忽略优势赢得EUF-CLMSC-CMA-1游戏[7],则称该基于多变量的无证书多接收者签密方案在适应性选择消息攻击下具有不可伪造性(Type1-EUF-CLMSC-CMA).敌手A在EUF-CLMSC-CMA-1游戏中需遵守以下限制:(1)不能对系统主密钥进行询问;(2)不能对挑战者集合中的身份进行私钥提取询问.定义7.类型2攻击下的不可伪造性.若不存在任何多项式有界敌手A以不可忽略优势赢得EUF-CLMSC-CMA-2游戏[7],则称该基于多变量的无证书多接收者签密方案在适应性选择消息攻击下具有不可伪造性(Type2-EUF-CLMSC-CMA).敌手A在EUF-CLMSC-CMA-2游戏中需遵守以下限制:(1)不能对挑战者集合中的身份进行私钥提取询问;(2)不能进行公钥替换询问.3新方案本文提出的基于多变量的无证书多接收者签密方案由5个算法组成,分别是系统参数建立算法、部分密钥生成算法、用户密钥生成算法、签密算法和解签密算法.具体描述如下.(1)系统参数建立算法(Setup).输入秘密参数s0,KGC产生大素数p和正整数l,设置特征为p、阶为q的有限域G,其中q=pl;选择两个安全的Hash函数H1:Gn×Gn×Gn→Gn,H2:Gn→Gn,选择一个正整数g表示多变量方程组中方程的个数.最后公开系统参数(G,l,g,n,q,p,H1,H2).(2)部分密钥生成算法(PartialKeyExtract).①KGC选择安全的多变量加密算法MES(MultivariateEncryptionSystem),其核心变换F为Gn→Gn上的可逆二次变换,并在Gn→Gn上随机选择两个可逆的仿射变换T和V,则KGC的系统公钥为珚F=TFV,系统私钥为(T,F,V).②KGC在Gn→Gn上随机选择两个可逆的仿射变换T0和V0,计算珚F0=T0珚FV0,则部分公钥为珚F0,部分私钥为(T0T,F,VV0).最后,KGC通过秘密信道将部分私钥传递给合法用户,KGC公开自己的系统公钥.注意:当有用户退出时,KGC需重新生成系统部分公钥和系统部分私钥;增加新用户则不需改变密钥.(3)用户密钥生成算法(KeyExtract).①用户U获取KGC的部分公钥和部分私钥,随机选择Gn→Gn上的仿射变换Tu和Vu,计算公钥Fu,Fu=Tu珚F0Vu.用户U的公钥为Fu,私钥为(TuT0T,F,VV0Vu).②用户U将公钥Fu传递给KGC.(4)签密算法(Signcrypt).身份为IDA的用户Alice,将签密消息m发送给用户组L={ID1,ID2,…,IDt},首先通过向KGC查询得到用户组L的公钥信息,然后进行如下计算.①选择随机数r∈Gn,并依次计算X=珚F(r),Y=H1(m‖IDA‖X),S=F-1A(Y).②对于IDi,i=1,2,…,t,计算qi=H2(IDi),Wi=Fi(m‖S‖X)(qi‖Y).③对于用户组L,计算L=珚F0(L).④最后生成密文σ=(S,W1,W2,…,Wt,L).(5)解签密算法(De-SignCrypt).用户IDi,i=1,2,…,t,收到密文σ后,进行如下计算.①获取身份列表,L=珚F-10(L),提取其对应的密文信息(S,Wi).②解密时依次计算Y=FA(S),qi=H2(IDi),Z=Wi(qi‖Y),m‖S‖X=F-1i(Z).③验证等式Y=H1(m‖IDA‖X)是否成立.若等式成立则接受密文σ,否则拒绝并输出⊥.4分析与讨论4.1正确性分析定理1.新方案解签密阶段的解密和验证过程是正确的.证明.用户IDi,i=1,2,…,t,接收到密文σ,提取出相应的密文信息(S,Wi),进行如下计算,Y=FA(S)=FA(F-1A(Y))=Y,只有用户Alice知道自己的私钥F-1A,使得上述等式成立.以及qi=H2(IDi),Z=Wi(qi‖Y)=Wi(qi‖Y),则m‖S‖X=珚F-1i(Z)=m‖S‖X,用户IDi利用其私钥计算出消息m及X,进而Y=H1(m‖IDA‖X)=Page5H1(m‖IDA‖X)成立,说明解签密阶段的计算是正确的.4.2安全性分析4.2.1保密性定理2.类型1攻击下的保密性.在随机预言模型中,如果存在一个IND-CLMSC-CCA2-1敌手A,能够在多项式时间内以ε的优势赢得定义4中的游戏(最多进行qH1次H1询问,qH2次H2询问,qske次私钥提取询问,qpke次公钥提取询问,qpkr次公钥替换询问,qsc次签密询问,qdsc次解签密询问),那么存在一个算法C能够在多项式时间内以ε优势解决MQ问题,其中ε>εtqsc+qH1其中G1表示有限域G进行n次扩张后的元素大小.下同.证明.算法C接收到一个MQ问题实例〈f(x),Y0=f(X0)〉,C的目标是计算出X0.C把A作为子程序并扮演IND-CLMSC-CCA2-1游戏中的挑战者.1)初始化.C设置珚F=TFV作为系统公钥,在Gn→Gn上随机选择两个可逆的仿射变换T0和V0,可得部分私钥为(T0T,F,VV0),并计算珚F0=T0珚FV0作为部分公钥,一并将公共参数(G,l,g,n,q,p,H1,H2)发送给A,C秘密保存系统主密钥(T,F,V).然后A输出目标身份集合L={ID1,ID2,…,IDt}.为了保持一致性,C定义列表L1和L2,分别用于记录A对预言机H1、H2的询问以及对私钥提取、公钥提取、公钥替换、签密和解签密的询问.2)阶段1.A向C进行下列询问.H1询问:输入元组(m,IDi,X,L),如果表L1中存在相应的记录,那么C返回相应的hi;否则选择一个随机数hi∈RGn,将记录(hi,m,IDi,X,L,,△)加入表L1,并返回hi.符号“”、“△”分别表示用户IDi对消息m的签名和加密的信息.H2询问:输入IDi,如果表L2中存在相应的记录,那么C返回相应的qi;否则选择一个随机数qi∈RGn,将记录(qi,IDi,○,□,◇,bi=0)加入表L2,并返回qi.3个符号“○”、“□”、“◇”分别存储该用户的公钥Fi和秘密值Ti、Vi.bi是一个标志位,表示该用户的公钥是否被替换.1,2,…,t,则C丢弃该询问;否则C查找L2,提取记录(qi,IDi,Fi,Ti,Vi,bi=0).如果bi=0,C返回私钥提取询问:输入IDi,如果IDi=ID私钥(TiT0T,F,VV0Vi);如果bi=1,则该用户的公钥已被替换,C向A询问私钥参数对(Ti,Vi),C返回相应的私钥(TiT0T,F,VV0Vi).公钥提取询问:输入IDi,如果表L2中存在相应的记录,那么C返回相应的Fi;否则选择随机数Ti,Vi∈RGn,计算Fi=Ti珚F0Vi,返回Fi,并更新L2中的记录.公钥替换询问:输入(IDi,Fi),C搜索表L2中的相应记录(·,IDi,Fi,·),若存在,则利用Fi替换Fi,并置bi=1;若不存在,那么对IDi进行公钥提取询问,再输入(IDi,Fi)进行替换公钥询问.签密询问:输入(m,IDs,L={IDR1,IDR2,…,IDRt}),如果IDs=IDRi,i∈{1,2,…,t},或者IDRi∈L且至少有一个IDRi∈L,i∈{1,2,…,t},则丢弃该询问.若IDs≠ID知道发送者的私钥,按照签密算法进行计算,并更新表L1、L2相应的记录信息.最后返回密文σ=〈S,W1,W2,…,Wt,L〉.若IDs=ID那么C不知道发送者的私钥,按照如下步骤产生密文.首先,C从表L2提取记录(qj,IDs,Fj,Tj,Vj,bj),选择一个随机数r∈RGn,计算X=Fj(r),对(m,IDs,X,L)执行H1询问,获取h1j,计算签名S.然后,C随机选择qi∈RGn,从表L2中查询记录(·,IDRi,·,bRi),计算得到yi=Fi(m‖S‖X),Wi=yi(qi‖h1j)以及L,并更新L1中的记录.若bj=1,表明该用户的公钥被替换,则向A请求(Ti,Vi).最后,将记录(qi,IDRi,Fi,Ti,Vi,bi)添加到表L2,如果L2已经存在相应记录,那么C签密失败,C失败的概率至多为tqsc+qH22G1.C将密文σ=〈S,W1,W2,…,Wt,L〉发送给A.解签密询问:输入密文σ、发送者身份IDs和接收者身份IDR,C从中提取(S,Wi,L).如果IDRL,则C知道接收者IDR的私钥,按照解密算法解密该密文;否则,C搜索表L1,如果没有包含S、L的记录,那么C拒绝该密文;此外,C搜索表L2,如果不包含记录〈qR,IDR,FR,TR,VR,bR〉,则拒绝该密文.计算Y=FA(S),Z=Wi(qi‖Y),m‖S‖X=F-1i(Z),如果S=S,则验证通过,返回m,否则拒绝该密文.此时一个有效密文被拒绝的概率至多为qdsc2G1-1.3)挑战阶段.A输出两个等长消息{m0,m1},以及发送者身份IDsL,A希望C为其产生一个Page6挑战密文.C随机选择一个比特b∈R{0,1},签密消息mb发送给L={ID1,ID2,…,IDt}.C选择一个随机数S∈RGn,定义X0=mb‖X‖S,则密文为σ=〈S,W1,W2,…,Wt,L〉,按如下步骤产生Wi,i=1,2,…,t.C选择随机数yi∈RGn,qi∈RGn,Y∈RGn,计算Wi=yi(qi‖Y),L=珚F0(L).4)阶段2.C按照阶段1的描述模拟A的查询,A不能为接收者IDi(i=1,2,…,t)对密文σ进行解签密询问.5)猜测阶段.最后A输出猜测b,C忽略A的猜测,通过上述分析可知,我们的模拟等同于实际攻击环境,敌手A猜测成功,则必须通过询问H1得到yi=Fi(m‖X‖S),i=1,2,…,t.C在L1中随机选择一个记录〈hi,m,Si,IDi,X,L,yi〉,C以1的概率(表L1中至多有tqsc+qH1个元素)选择记录中包含正确的元素yi=Fi(mb‖X‖S),C将X0作为MQ问题的解输出.下面我们分析C成功的概率,事件E表示A输出正确比特b=b.下列任一事件发生则模拟失败.(1)E1:对选定的挑战身份进行私钥提取询问.(2)E2:模拟失败,因为在某次签密询问中,发(3)E3:模拟失败,因为在签密询问时对H2询(4)E4:C在解签密时拒绝一个有效密文.由上可知,Pr[E]=ε,若事件E发生,则事件E1、E2都不发生,即E1∧E2.通过上述分析可得,Pr[E3]qsc(tqsc+qH2)询问,表L2中至多有tqsc+qH2个记录;Pr[E4]qdsc2G1-1表示一个有效密文被拒绝的概率,Pr[E5]tqsc+qH1上述事件,我们定义C成功的优势ε=Pr[E∧E1∧E2∧E3∧E4∧E5].送者且至少一个接收者属于挑战者身份集合.问出现碰撞.1因此我们可得ε>εtqsc+qH1定理3.类型2攻击下的保密性.在随机预言模型中,如果存在一个IND-CLMSC-CCA2-2敌手A,能够在多项式时间内以ε的优势赢得定义5中t(tqsc+qH2)1-qsctqsc+qH()22G(的游戏(最多进行q1次H1询问,q2次H2询问,qske次私钥提取询问,qpke次公钥提取询问,qsc次签密询问,qdsc次解签密询问),那么存在一个算法C能够在多项式时间内以ε优势解决MQ问题.其中ε>εt.qsc+qH1在第2类攻击类型下,攻击者可以获得系统主密钥信息,但不能替换用户公钥,参照定理2,我们可以很容易证明定理3成立.4.2.2不可伪造性定理4.类型1攻击下的不可伪造性.在随机预言模型中,如果存在一个EUF-CLMSC-CMA-1敌手A,能够在多项式时间内以ε的优势赢得定义6中的游戏(最多进行qH1次H1询问,qH2次H2询问,qske次私钥提取询问,qpke次公钥提取询问,qpkr次公钥替换询问,qsc次签密询问,qver次验证询问),那么存在一个算法C能够在多项式时间内以ε优势解决IP问题.其中ε>ε证明.算法C接收到一个IP问题实例(FS=TS珚F0VS,珚F0),C的目标是计算出(TS,VS).C把A作为子程序并扮演EUF-CLMSC-CMA-1游戏中的挑战者.1)初始化.C设置珚F=TFV作为系统公钥,在Gn→Gn上随机选择两个可逆的仿射变换T0和S0,可得部分私钥为(T0T,F,VV0),并计算珚F0=T0珚FV0作为部分公钥,一并将公共参数(G,l,g,n,q,p,H1,H2)发送给A,秘密保存系统主密钥(T,F,V).然后A输出目标身份集合L={ID1,ID2,…,IDt}.为了保持一致性,C定义列表L1和L2,分别用于记录A对预言机H1、H2的询问,以及对私钥提取、公钥提取、公钥替换、签密和验证的询问.2)攻击.A向C进行下列询问.H1询问:输入元组(m,IDi,X,L),如果表L1中存在相应的记录,那么C返回相应的hi;否则选择一个随机数hi∈Gn,将记录(hi,m,IDi,X,L,,△)加入表L1,并返回hi.符号“”,“△”分别表示用户IDi对消息m的签名和加密的信息.H2询问:输入IDi,如果表L2中存在相应的记录,那么C返回相应的qi;否则选择一个随机数qi∈RGn,将记录(qi,IDi,○,□,◇,bi=0)加入表L2,并返回qi.3个符号“○”,“□”,“◇”分别存储该用户的公钥Fi和秘密值Ti、Vi.bi是一个标志位,表示该用户的公钥是否被替换.Page7私钥提取询问:输入IDi,如果IDi=ID1,2,…,t,则C丢弃该询问;否则C查找L2,提取记录(qi,IDi,Fi,Ti,Vi,bi=0).如果bi=0,C返回私钥(TiT0T,F,VV0Vi);如果bi=1,则该用户的公钥已被替换,C向A询问私钥参数对(Ti,Vi),C返回相应的私钥(TiT0T,F,VV0Vi).公钥提取询问:输入IDi,如果表L2中存在相应的记录,那么C返回相应的Fi;否则选择随机数Ti,Vi∈RGn,计算Fi=Ti珚F0Vi,返回Fi,并更新L2中记录.公钥替换询问:输入(IDi,Fi),C搜索表L2中的相应记录(·,IDi,Fi·),若存在,则利用Fi替换Fi,并置bi=1;若不存在,那么对IDi进行公钥提取询问,再输入(IDi,F)进行替换公钥询问.签密询问:输入(m,IDs,L={IDR1,IDR2,…,IDRt}),如果IDs=IDRi,i∈{1,2,…,t},或者IDs∈L且至少有一个IDRj∈L,j∈{1,2,…,t},则丢弃该询问.若IDs≠ID发送者的私钥,按照签密算法进行计算,并更新表L1、L2相应的记录信息.最后返回密文σ=〈S,W1,W2,…,Wt,L〉.若IDs=IDC不知道发送者的私钥,按照如下步骤产生密文.首先,C从表L2提取记录(qj,IDs,Fj,Tj,Vj,bj),选择一个随机数r∈RGn,计算X=Fj(r),对(m,IDs,X,L)执行H1询问,获取h1j,计算签名S.然后,C随机选择qi∈RGn,从表L2中查询记录(·,IDRi,·,bRi),计算得到yi=Fi(m‖S‖X),Wi=yi(qi‖h1j)以及L,并更新L1中的记录.若bj=1,表明该用户的公钥被替换,则向A请求(Ti,Vi).最后,将记录(qi,IDRi,Fi,Ti,Vi,bi)添加到表L2,如果L2已经存在相应记录,那么C签密失败,C失败的概率至多为tqsc+qH22G1.C将密文σ=〈S,W1,W2,…,Wt,L〉发送给A.验证询问:输入密文σ=〈S,W1,W2,…,Wt,L〉,发送者身份IDs和接收者身份IDR,C从中提取(S,Wi,L),如果IDRL,则C知道接收者IDR的私钥,按照解签密算法解密该密文;否则,C搜索表L1,如果没有包含S、L的记录,那么C拒绝该密文;此外,C搜索表L2,如果不包含记录〈qR,IDR,FR,TR,SR,bR〉,则拒绝该密文.计算Y=FA(S),Z=Wi(qi‖Y),m‖S‖X=F-1i(Z),如果S=S成立,那么验证通过,否则验证失败.此时一个有效密文验证失败的概率至多为qdsc2G1-1.3)伪造.进行多项式有界次上述询问后,A输出伪造密文σ=〈S,W1,W2,…,Wt,L〉(对于L={IDR1,IDR2,…,IDRt},至少有一个IDRiL),发送者身份IDs∈L.通过上述分析可知,我们的模拟等同于实际攻击环境,敌手A伪造成功,则必须通过询问H2得到(TS,VS).C在L2中随机选择一个记录〈qi,IDs,Fi,Ti,Vi,bi〉,C以1tqsc+qH2个元素,IDs被选中的概率为1/n)选择的记录中包含正确的数对(TS,VS),C将其作为IP问题的解输出.下面我们分析C成功的概率,事件E表示A伪造的密文σ验证通过.下列任一事件发生则模拟失败.(1)E1:对选定的挑战身份进行私钥提取询问.(2)E2:模拟失败,因为在某次签密询问中,发(3)E3:模拟失败,因为在签密询问时对H2询(4)E4:C在验证时拒绝一个有效密文.由上可知,Pr[E]=ε,若事件E发生,则事件E1、E2都不发生,即E1∧E2.通过上述分析可得,Pr[E3]qsc(tqsc+qH2)询问,表L2中至多有tqsc+qH2个记录;Pr[E4]qdsc2G1-1,表示一个有效密文验证未通过的概率,Pr[E5]1概率.根据上述事件,我们定义C成功的优势ε=Pr[E∧E1∧E2∧E3∧E4∧E5].因此我们可得ε>ε送者且至少一个接收者属于挑战者身份集合.问出现碰撞.t(tqsc+qH2)1-qsctqsc+qH()22G(定理5.类型2攻击下的不可伪造性.在随机预言模型中,如果存在一个EUF-CLMSC-CMA-2敌手A,能够在多项式时间内以ε的优势赢得定义7中的游戏(最多进行q1次H1询问,q2次H2询问,qske次私钥提取询问,qpke次公钥提取询问,qsc次签密询问,qver次验证询问),那么存在一个算法C能够在多项式时间内以ε优势解决IP问题.其中ε>εt(tqsc+qH2)1-qsctqsc+qH()22G(在第2类攻击类型下,攻击者可以获得系统主Page8密钥信息,但不能替换用户公钥,参照定理4,我们可以很容易证明定理5成立.4.2.3前向安全性签密者每次发送消息,都要选择随机数r∈Gn,即便发送相同的消息,最后形成的密文σ=(S,W1,W2,…,Wt,L)也是不同的.因此,攻击者获得Alice的密钥也无法生成之前签密时的X=珚F(r),也就无法获得传输的消息m.因此,本方案满足前向安全性.4.2.4后向安全性在本文方案中,当有用户退出时,KGC会重新计算用户组的部分私钥,组内用户生成新的密钥,这样退出的用户即便接收到密文消息,也无法解密出正确的明文消息.因此,本方案满足后向安全性.4.2.5不可否认性由定理4、定理5可知,本文方案是不可伪造的,若Alice确实签密过一个消息m,那么她就不能对自己的行为进行否认.因此本方案具有不可否认性.4.2.6保护接收者隐私由于通信信道是公开的,那么攻击者就可以窃听获取传输的密文信息.签密阶段的步骤3)对用户组列表L进行加密操作,L=珚F0(L),如果外部攻击者通过密文获取用户组成员信息,则需要求解MQ问题,这在计算上是不可行的,因此,本文方案能够保护用户组成员隐私.4.3性能分析密和解签密阶段操作,分析如下.签密阶段,需要(t+1)次Hash运算,(2t+3)次加密运算和1次异或运算.解密验证阶段,每一个用户只需进行3次解密运算,1次异或运算和2次Hash运算.整个操作不涉及线性对运算、指数运算、群上的点乘运算,计算量为O(2t+3).生成的密文大小为(2t+1)G1,其中,t表示接收者的人数,G1表示有限域G的n次扩张后元素的大小.与同为多接收者模型下具有代表性的无证书签密方案[7]相比,新方案不包含复杂的线性对运算和指数运算,具备计算量小、计算效率高、密文短小的特点.单接收者模型下的无证书签密方案[9-11],为了向t个接收者签密消息m,需重复执行t次.所以本方案的计算量与文献[9-11]中的方案比较起来具有很大的优势,具体比较结果如表1所示.随着无线传感器网络的快速发展,实现控制端和智能前端的认证和保密的数据通信,在某些机密对于本方案的效率分析,只考虑计算量大的签的领域显得尤为重要.智能终端对在涉密环境中采集的敏感信息,首先通过加密技术防止敏感信息被侦听、破解,然后发送给控制端,控制端根据接收到的信息,可以实时地组播发送控制指令,调整智能终端的工作状态,出于安全考虑智能终端需对控制指令的发送者———控制终端进行身份认证.本文方案可以较好地解决上述问题,符合智能终端功耗低、计算能力偏小、通信带宽窄的特点.新方案避免了密钥托管带来的危害,同时又能实现认证和抗量子攻击的具有高安全性的数据通信.方案双线性Selvi等人方法[7]22t+2t+7(2t+1)|Zq|+|I|Li等人方法[9]2t+12t+22t|I|+t|m|Zhu等人方法[10]03t+43t+32t|I|+t|m|Jing等人方法[11]03t+22t+22t|I|+t|m|新方案00n+3(2t+1)G1注:表中,t表示接收者人数,|Zq|表示有限域Zq元素的大小,|I|表示循环群I元素的大小,|m|表示消息m的大小,G1表示有限域G的n次扩张后元素的大小.5结论随着对量子计算理论研究的日益成熟,后量子密码越来越得到人们的重视,多变量公钥密码作为能够抵抗量子攻击的主要备选密码体制之一,已得到学者的广泛研究.在现有无证书签密体制的基础上,提出一个基于多变量的多接收者无证书签密方案,新方案继承了多变量密码体制的安全性,能够抵抗量子攻击.基于MQ难题和IP难题在随机预言模型下分析了方案的安全性,新方案在适应性选择密文攻击下具有不可区分性并在适应性选择消息攻击下具有不可伪造性.此外,本方案还具有前向安全性、后向安全性、不可否认性和保护接收者隐私等安全属性.
