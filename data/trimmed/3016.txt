Page1可信PDA计算平台系统结构与安全机制赵波1),2)张焕国1),2)李晶1),2)陈璐1),2)文松1),2)1)(武汉大学计算机学院武汉430079)2)(空天信息安全与可信计算教育部重点实验室武汉430079)摘要PDA作为一种手持设备,面临着众多的安全问题.文中利用可信计算思想构造了可信PDA的体系结构与安全机制.首先提出了一种带数据恢复功能的星型信任结构,其在安全性、效率及可靠性等方面较TCG的链式信任结构都有很大提升.在此基础上,进一步使用总线仲裁等技术构造了可信PDA的体系结构模型.文中还提出并实现了针对可信PDA嵌入式操作系统的安全增强、基于可信PDA平台的可信网络连接(TNC)以及SD卡全卡加密等新的安全技术与方法.在此基础上,给出一种可信PDA的原型系统.经过实验验证,这款可信PDA在各方面都达到了可信计算平台的技术要求.关键词可信计算;可信计算平台;可信PDA;星型信任结构1引言化在硬件芯片里面的,不存在被攻击的可能性,因此对于PDA系统的安全问题,业界并没有给予重视和研究.然而,随着PDA的技术发展与广泛应用,长期以来,很多人认为PDA系统的软件是固PDA也面临着巨大的安全威胁:首先,PDA是一种Page2手持移动设备,容易丢失,由此可能被冒用,造成信息泄露;其次,由于存储器技术的发展,PDA的存储器越来越多地采用可编程FLASH器件.因此病毒等恶意代码完全可以攻击PDA系统;再其次,PDA的主要通信方式为无线通信,因此会产生电磁再次辐射,极易造成通信信息的泄露.目前,对PDA设备及嵌入式系统安全增强的方法,大部分还是采用诸如SD卡加密等对敏感数据进行保护的传统安全技术.这种安全保护并没有从体系结构和操作系统等软硬件底层提供根本性的安全保障.可信计算技术是近年来出现的一种新的信息系统安全技术,目前已在世界范围形成了热潮.它是提高计算机系统安全性的行之有效的新技术,因此也是解决PDA安全问题的有效途径.国内外众多研究机构、学者已经对该领域开展了许多研究工作,并取得了一定的成果:可信计算组织TCG已经提出了用于解决移动平台的安全规范①②和设想,但是尚未有任何具体的实现理论和技术的说明;Intel、IBM、NTT等公司提出了可信移动平台(TrustedMobilePlatform,TMP)项目,以TCG的可信平台模块(TrustedPlatformModule,TPM)为基础,提出了可信移动平台的软件、硬件体系结构和协议规范③④⑤⑥,但同样缺乏具体的实现方案;国内的其他学者[1-4]也提出了利用该TPM模块与嵌入式CPU进行通信,以改善嵌入式系统安全水平的方法,这些平台构建方案都是基于TPM模块,现有TPM模块是针对PC终端设计的,并不能满足移动平台特有的属性和应用需求,也没有解决TPM和嵌入式CPU的双CPU结构对系统的控制等问题.目前,基于TCG的规范标准,已经有了比较成熟的可信PC产品,TCG对可信PC[5]的链式信任关系的定义和实现值得研究可信嵌入式平台借鉴.本文描述的可信PDA在理论上提出了适合嵌入式系统的带数据恢复功能的星型信任结构,并使用总线仲裁等新技术来管理TPM和嵌入式CPU,解决了安全控制和系统应用之间的矛盾,提高了嵌入式系统的可信性和工作效率.可信PDA还支持基于硬件的存储设备加密、基于硬件的外部设备安全管理等功能、操作系统安全增强和可信网络连接(TNC),基本实现了可信计算对嵌入式系统安全的期望.2可信PDA的体系结构可信PDA除提供一般PDA的功能之外,更重要的是能为用户提供可信安全保障.可信PDA采用可信计算机制,利用可信平台模块(TPM)和信任链技术对系统安全性进行了增强,提高了PDA的安全性.可信PDA由S3c2410xARMCPU、JetWay2810安全芯片⑦、FPGA、指纹识别模块、GPS、WLAN等控制芯片构成,并有TFT触摸屏、USB等外部输入输出设备,采用包含图形界面的嵌入式Linux作为操作系统,其基本结构如图1所示.除了保持传统PDA的特点之外,还根据可信≈可靠+安全的学术思想[6-7],从理论上完成了星型信任结构的设计,并从技术上实现了如下的安全特点:(1)具有数据恢复功能的星型信任结构.信任链是保证计算机设备可信性的一个基本手段,可信PDA针对嵌入式系统的自身特点和可信PC链式信任结构的不足之处,设计了全新的星型信任结构,这种信任结构可以降低信任传递时的损耗,提高信任传递的效率、保护可信测量根CTRM的物理安全等.同时,信任结构还带有数据恢复功能,启动时如果发现软件部分不完整(包括人为的破坏和病毒的传染),则自动启动恢复功能,以备份软件覆盖受损内容,确保平台软件的完整性和可靠性.(2)包含总线仲裁模块的ETPM(EmbeddedSystem-TPM)新结构.以JetWay2810安全芯片为TPM核心芯片,FPGA以总线形式与JetWay2810相连,构成了包括总线仲裁和对称密码算法模块的①②trustedcomputinggroup.org/specs/mobilephone/tcg2mobile2-③④tion[EB/OL].[2007206205].http://www.trustedmo-⑤⑥⑦Page3图1可信PDA体系结构框图完整ETPM(图1虚线部分),这是对TCG规范的一个改进.可信PDA上电伊始就以TPM为主控设备,用TPM①控制指纹模块对用户身份加以识别,之后对所有启动部分实施完整性度量,只有经完整性度量确认环境安全之后,才允许ARM平台启动.相对于目前可信PC的实现方案,本方法更能确保TPM的主控地位,提高安全性.JetWay2810芯片还通过FPGA对部分外设通信信道的硬件通断进行物理层控制,如USB设备(包括无线网卡和GPS).这样就做到了既安全又可控,符合我国政府的信息安全政策.(3)操作系统安全增强.在嵌入式操作系统上实现了包括加密文件系统、重要存储区域的隔离保护、日志系统、强制访问控制等安全功能,提供全面的操作系统安全保障,为上层应用软件的安全提供了基础[8].用户身份使用指纹进行识别,并结合本机硬件特征形成各类密钥,密钥存储于ETPM中,并受其物理级别的保护.NandFlash存储器中的信息,以密文形式存储,并结合硬件密码算法模块对SD卡实现全卡加密,被加密过的SD卡只能在本机使用,在其它设备上无法读取其内容,从而实现了软件和数据的防复制功能,可以防止可信PDA丢失后的冒用.(4)可信网络连接.可信网络连接(TNC)是可信计算向网络领域扩展的一种重要技术.它将可信计算机制引入网络,把信任链从终端平台扩展到网络,使得网络成为一种可信的计算环境.在可信PDA中我们设计并实现了基于远程证明的可信网络连接(TNC)②,即在使用网络功能之前,对要接入网络的设备进行完整性验证③,以保证网络环境下应用的安全④⑤[9].除此之外,可信PDA还配备了100M速率网卡,提供图形化的操作接口,实现了资源管理器、音频等实用功能,方便一般用户的日常工作与使用.3星型的信任结构对于不同的实体,可以使用不同的组织方式来表示它们之间的相互信任关系,这种组织方式即为信任结构.对于各个实体,最直接的组织方式既为两两之间都有直接的信任关系.如图2所示[10].这种相互信任结构可以非常方便地表示出各个①②③tectureforInteroperabilityRevision1.1[EB/OL].Trustedinggroup.org④⑤Page4TCG的链式信任结构存在着很多的不足之处:(1)可信测量根CRTM置于TPM之外,不受TPM的物理保护,容易受到恶意攻击破坏;(2)由于可信的测量值采用迭代的计算方法,因此如果在信任链形成后增加或者删除某个部件,或者软件的版本升级,都必须重新计算所有的信任值,增加了维护和管理的难度;(3)根据信任理论,信任值在传递过程中会有损耗,传递的路径越长,则损耗越大[7].由于链式信任结构的信任传递路径长,所以容易产生信任的损耗.3.1星型信任结构条原则如下[12]:基于Dempster-Shafer原理的计算信任值的两(1)信任衰减原则如果节点A对节点B的信任值为T(A,B),节点B对节点C的信任值为T(B,C),TB(A,C)表示经由B点传递的A,C之间的信任关系.由传递性可以推断出A和C之间的信任关系.实体之间的相互信任关系,但是,这种结构需要维护的关系表很多,如果实体数量较多,实现将非常困难.TCG提出了一种链式的信任结构来实现实体的信任关系,与相互信任结构相比,该结构更易于实现.根据TCG规范中的定义,信任传递呈一种链式结构,在可信平台的信任链传递过程中,各层可信代理之间层层传递信任关系[11].定理1.TB(A,C)=T(A,B)T(B,C).这里符号表示提取两者之间信任最小值的概念,因此有TB(A,C)min(T(A,B),T(B,C)).(2)信任聚合原则节点A到节点D存在两条独立的路径,这两条路径分别给出它们的信任值TB(A,D)和TC(A,D).TB(A,D)表示经由B点传递的A,D之间的信任关系,TC(A,D)表示经由C点传递的A,D之间的信任关系.由此可以判断出A和D之间的信任关系.定理2.T(A,D)=TB(A,D)TC(A,D).这里符号表示提取两者之间信任最大值的概念,因此有T(A,D)max(TB(A,D),TC(A,D)).图4分别图示了链式信任结构和星型信任结构.在图4中,依照以上两条原则递推:由链式结构,信任链经过节点:A->B->C->D->…->L->M->N,则链式信任结构的各级信任值有T(A,C)=min(T(A,B),T(B,C)),T(A,C)表示经过B点的A、C之间的信任关系,以此类推,有T(B,D)=min(T(B,C),T(C,D)),…,其最终信任值Tline不会大于min(T(A,B),T(B,C),…,T(L,M),T(M,N)),并且,从节点A到节点N的路径上任何一个信任关系的破坏,都会完全破坏整个信任链.结论1.如果依照星型信任结构,节点A与节点N之间有多条直接路径:T1(A,N),T2(A,N),T3(A,N),…,Tn(A,N);则最终信任值Tstar不会小于max(T1(A,N),T2(A,N),T3(A,N),…,Tn(A,N)),即总有TstarTline(Tstar在最坏情况下等于Tline在最好情况下的值);而且星型信任关系结构较之前者健壮[13].结论2.在星型信任结构中,节点A一般作为信任根出现,由它进行对其它节点的度量工作,其作用相当于TCG定义的TPM,然而,其具体的结构与TPM略有不同,星型信任结构的TPM将包含可信Page5将链式信任结构和星型信任结构进行比较可以度量根CRTM,这样可以最大限度地保证CRTM在物理上是安全的.结论3.星型信任结构的信任值计算是根节点与每一个测量节点之间的独立计算结果,互相之间不会产生影响,因此添加和删除组件以及软件版本升级,只需要根节点对该节点单独重新进行计算即可,不会影响到整个信任链.看出,星型信任结构优于链式信任结构.星型信任结构也有不足之处:在星型结构中,由于根节点处于中心位置,在平台的工作过程中需要不断地对各节点进行完整性度量和可信度的判断,因此,根节点的计算压力较大,可能造成平台工作效率的损失.但是,PDA系统有自己的特点,其TPM与ARMCPU的计算能力相当,因此TPM的工作不会带来系统整体性能明显的改变.可信PDA原型系统的实际运行情况也证明了这一点.所以,可信PDA使用星型信任结构是可行的,它保证了系统的信任度优于可信PC的链式信任结构.可信PDA的星型信任结构以TPM为可信根,作为整个嵌入式平台的可信测量和控制器,嵌入式平台作为从设备受TPM的管理和控制;TPM内部采用物理方式集成了可信度量根、可信存储根和可信报告根,对自身以及连接电路有良好的物理保护;TPM启动后,只有身份信息和存储器内容的完整性验证完成之后,可信的代码才能在嵌入式平台上执行.星型信任结构如图5所示.星型信任结构和可信启动的概念,已经获得国家专利授权(专利号ZL200710053331.1;ZL200710053330.7).3.2总线仲裁为了实现系统启动前的星型信任结构的完整性校验,TPM要将NandFlash中的BootLoader,Linuxkernel等内容读入进行校验[14],这就涉及到两个问题:(1)启动顺序,在上电后,TPM要先进行完整性检验,此时ARM还不能启动,在TPM校验通过后,ARM开始启动;(2)S3C2410ARMCPU和TPM都需要读取NandFlash的值,因此需要对Flash读取的总线进行仲裁.总线仲裁的体系结构设计框图如图6所示.在图6中,使用FPGA实现S3C2410和TPM对NandFlash的分时操作,TPM为控制核心,由它来控制可信PDA的启动流程,可以根据度量情况随时将S3C2410关断和启动.这种方法解决了可信PC中可信根度量和BIOS同时工作的尴尬局面,真正使TPM处于主控地位.总线仲裁的实现还可以带来如下的好处:(1)TPM控制方便,灵活.TPM通过对总线控制器中的控制寄存器的修改,可以完全使用程序来灵活控制S3C2410的启动,TPM也可以使用程序来控制读取NandFlash的信息量.(2)扩展方便.本模块设计了TPM对S3C2410的开启与关断,若想实现其它安全控制,如关闭某个外设,只需要对体系结构做些许修改[6,15];此外,还可以非常容易地扩展实现TPM对NandFlash的读Page6写保护.从物理上保护存储设备中内容的完整性和安全性.可信PC没有考虑总线仲裁问题,采用了TPM和CPU同时启动的可信根扩展的方法[16].这种方法是对现有PC产品的一种妥协,使得对CRTM的保护和对BIOS的度量都难于实现.这是目前可信PC的一个缺陷.3.3具有数据恢复功能的信任结构可信PDA仅仅具有安全功能是不够的,根据可信≈可靠+安全的学术思想[7](https://www.trustedcomputinggroup.org/network/),可信的产品也应该有较好的可靠性.因此,TPM在启动时若检测到可信PDA的OS、Bootloader等已经受到了攻击并被篡改时,除了阻止PDA的进一步运行之外,需要提供一种机制以使得PDA能够恢复到其正常的状态,保证PDA的正常工作不受干扰.可信PDA的备份恢复机制需要对TCG规范中的TPM结构进行扩展,在TPM内部添加一个受物理保护的系统备份存储器,保存计算机系统引导程序和操作系统等希望被保护的内容代码.TPM在系统启动之前对PDA引导程序代码及操作系统代码进行完整性校验,若校验未通过则认为以上内容被篡改,TPM将使用总线仲裁机制获取总线控制权,从受保护的备份存储器中读取相应的备份代码,并将其写入PDA外部工作用存储器,再次进行完整性校验,若通过校验,表明系统恢复成功,TPM将交出总线控制权,允许PDA设备系统启动.与现有的技术相比,该方式有如下优点:由TPM作为系统的可信根,对可执行代码进行完整性校验,同时为备份存储器提供受保护的安全存储环境.TPM拥有可信PDA总线控制权,在进行完整性校验和系统恢复的过程中不会受到外部干扰.图7为基于TPM控制的备份恢复体系结构.经过原型系统的实际测试,完成一次备份恢复的时间少于1s(恢复内容小于32MB),可以满足实际使用的要求.从而大大提高了可信PDA的可靠性和可用性.3.4新型的TPM结构可信PDA是自主研发的可信产品,目前国内尚无适合星型信任结构的TPM成品.由前文所述,可信PDA的TPM包含的功能比常规的TPM芯片多,因此,在图1中,以JetWay2810安全芯片和FPGA设备构成了一种新的TPM模块结构.3.4.1JetWay2810芯片JetWay2810的安全芯片是一款通过国家认证的可信计算平台模块芯片.它是与AMD186兼容的16位微控制器芯片,采用经SOSCA(SecureOpenSmartCardArchitecture)指令集增强的X86处理器内核,集成大容量存储器,多体制密码引擎,USB,ISO7816/4等多种外围控制器.该芯片具有基本的密码计算和PCR数据存储功能,经过添加COS,JetWay2810可以完成TCG规定的TPM的基本功能,并提供TSS的底层接口.3.4.2TPM与TCMTPM是可信计算平台的一个重要的组成部件,根据TCG的定义,TPM必须由硬件来实现,但是TCG仅仅在理论上定义出了TPM应该完成的功能,对其如何实现,性能指标要求,并没有统一的实现规定,作为一个标准的TPM,应包含执行引擎、存储器、I/O、RSA密码引擎、随机数产生器等部件,以完成加密、签名、认证、密钥产生等安全功能.但是,TCG的TPM定义中并不包含对称密码算法引擎.一般TCG建议利用其他的方式实现,这就带来一定的安全和性能隐患.我国的TCM(TrustedCryptographyModule,可信密码模块)标准[16],是由国家密码管理局主持国内一些IT企业推出的.TCM与TPM最大的不同在于,其内部的核心密码算法为我国自主知识产权的算法标准,特别是集成了我国的对称密码算法(SMS4).这样,TCM就避免了TPM中没有对称密码算法的缺陷.3.4.3ETPM(EmbeddedSystemTPM)可信PDA由于使用了前文描述的星型信任结构,因此ETPM的体系结构与TPM和TCM不同,其基本结构如图8所示:公钥算法采用了RSA的2048位(也可使用ECC),对称密码算法采用了SMS4,另外还有完成正常启动顺序的总线仲裁、备份恢复模块.上述几种模块,JetWay2810没有提供,故而采用FPGA硬件实现.ETPM构成了可信PDA的核心根模块,可以很好地实现星型信任结构Page7所描述的功能,如图1和图5所示,形成了一种支持嵌入式系统的可信计算体系结构模块.4存储介质和操作系统安全对于用户而言,可信PDA最重要的功能之一就是要保证数据信息的安全,需要达到如下的安全效果:(1)实现可信PDA的存储介质NandFlash上重要数据区域的写操作保护,提供开机启动时的完整性校验支持.(2)保证移动设备数据存储的机密性,解决未经授权的访问和因便携式设备的失窃引发的泄密等问题.(3)细化文件的访问粒度,限制超级用户的权限.即使是授权用户在访问资源时,行为必须符合安全策略,操作才能执行,否则将拒绝.防止超级用户滥用权限.(4)系统的安全增强模块有可以信赖的可信计算基.可信PDA应实现对用户透明的安全存储保护模式,授权用户可以像使用普通文件系统一样完成安全功能操作.由于嵌入式操作系统资源有限,安全增强模块在内核层实现,加密模块利用Linux缓冲机制并调用硬件密码模块进行加密,并在访问控制机制中添加策略缓存,提高了系统性能(见本文第3页注释④)4.1存储介质的安全可信PDA使用SD卡作为外部的数据存储器,用户的私密信息经常存储于此.因此,SD卡内的数据保护就显得尤为重要.SD卡使用TPM中的硬件加密芯片实现加解密操作,在系统的性能和物理安全上都有极大的提高,其密钥存入TPM中,由TPM提供保护.SD卡加密文件系统主要分为加密引擎和密钥管理两个主要部分[17].加密引擎是在内核合适的加解密位置调用硬件加密芯片利用SMS4完成加解密操作;密钥管理是使用TSS密钥安全存储接口访问TPM芯片中存储的密钥,从而利用其加密以及平台绑定功能来保证密钥的可信和安全性.其体系结构如图9所示.由于是在页高速缓存层和通用块层之间添加了数据加解密功能[17],因此对于上层用户是透明的,使用户感觉不到文件的加密过程,不修改文件系统的数据结构且用户访问加密文件的过程也不变.SD卡一旦丢失,非合法用户也无法获得其内容,因加密层在文件系统层之下,非法用户甚至连文件结构都不能读取.4.2数据隔离保护嵌入式系统中,BootLoader、kernel和根文件系统是保障系统安全的重要区域,要求用户进程不能随便改动,否则将导致系统出错甚至无法使用.但用户存储区内的数据应可由用户任意添加、删除和修改.因此有必要对嵌入式的存储空间进行划分,以用户是否可以自由修改为依据,可以将存储空间划分为用户数据区和系统数据区.在操作系统启动之前,TPM会自动校验系统数据区,校验通过后TPM才把控制权交给CPU,系统运行.至此这些区域一直由TPM来保护.按照目前可信PC的运行模式,在操作系统开始运行之后,TPM不会再对这些区域进行保护,恶意进程和用户的误操作可能会改写这些区域的数据,因此需要保护这些重要区域,防止被改写.可信PDA中存储隔离保护设计的核心思想是在存储介质NandFlash上划分出一个重要分区来Page8进行写操作保护[18].因为文件系统是建立在Nand-Flash上,在读写请求被提交给NandFlash驱动时,NandFlash驱动要检查写操作,如果写的位置是这些重要区域,那么NandFlash驱动就阻止这次写操作,并直接返回错误值给进程,以防止这些区域被篡改.NandFlash之下是MTD块设备,所以确定在存储技术设备驱动中进行修改,对于NandFlash在执行写操作前,检查要写的地址是不是在指定的地址,如果是,则直接返回错误,否则发起写操作,从而来提供完整性保护.可信PDA的MTD设备层次结构如图10所示,Flash硬件驱动层负责在初始化时驱动Flash硬件;MTD原始设备层一部分是MTD原始设备的通用代码[17],另一部分是各个特定的Flash的数据例如分区,定义了大量的关于MTD的数据和操作函数;MTD设备层是基于MTD原始设备,定义出MTD的设备号以及注册设备操作;设备节点层负责建立MTD字符设备节点(主设备号为90)和MTD块设备节点(主设备号为31),通过访问此设备节点即可访问MTD字符设备和块设备.4.3操作系统内核安全增强可信PDA在操作系统内核中加入钩子函数[19-20],对标准内核进行了以安全增强为目的的修改,并以配置文件的方式实现策略逻辑.当需要进行访问内核时,首先检查是否符合既定的安全策略,如果符合则通过本次访问,否则拒绝.在Linux内核中,钩子函数被放置于namei.c、open.c和readdir.c的相关函数中.打开文件时,钩子函数就先查找策略配置文件中的相关策略[21],如果符合策略,则通过read_write.c文件中的相关函数执行读写操作,如果不符合,则直接返回错误.图11所示为钩子函数的调用过程.策略文件中保存了主体(可执行文件)、客体(数据文件)、节点号、访问权限信息,用以指明哪个主体可以哪种方式访问哪个客体[22].该强制访问控制实现简单[23],策略易于定制,提供策略管理工具,适于可信PDA的应用.我们测试了设置为只读的文件如何实现访问控制(图12).利用命令重写和追加test_readonly文件时,终端均显示为操作被禁止.使用cat显示未经修改的文件内容,表明只读文件不可以被修改和追加.4.4日志系统普通的嵌入式Linux并不带有日志功能[24],为了让用户了解可信PDA的运行状态,进一步增强可信PDA的安全性[16],并为日后的审计工作提供依据,我们为可信PDA增加了日志功能.可信PDA在嵌入式Linux内核源码中编译加入了syslog模块,能够有效节省空间.同时,syslog带有日志轮转功能,能够通过对syslog加命令行参数来打开日志轮转的功能,不需要另外增加logro-tate程序,以提高日志记录效率.经过综合考虑与原型系统的实验,由于可信PDA目前所要记录的日志量不大,种类也不多,为实现简单起见,采用交叉编译的方法,将syslog编译到busybox中即可,不需要另外添加logrotate工具.可信PDA上的日志系统主要记录以下事件:(1)内核的输出信息;Page9(2)应用程序的日志;(3)系统出错信息.通过对日志的分析,用户能够了解可信PDA的运行状况,及时发现安全隐患,防范于未然,并为日后的审计工作提供依据.5可信的网络连接在基于远端证明的可信PDA无线网络接入控图13远程证明的系统结构在该系统中,终端(即上图可信PC)与可信PDA进行远程证明,完整性参考服务器具有双方平台的标准完整性参考值.可信PDA通过无线网络与终端及完整性参考服务器相连接,终端及PDA都有TPM作支持.可信PC上完成远程证明的功能组件主要包括自行开发的TSS(见TNCIF-TNCCS),RemoteAttestationService和IMC(IntegrityMeas-urementCollector),负责读取平台的PCR及Even-tLog等信息并报告给PDA.可信PDA上的功能组件主要包括TSS,RemoteAttestationService和IMV(IntegrityMeasurementVerifier),负责验证要求接入的平台是否可信(见TNCIF-PEP).证明过程如下:(1)终端正常工作,通过有线或无线网络连入局域网;完整性参考服务器正常工作,通过有线网络连入局域网;可信PDA正常工作,通过无线网络连入局域网.(2)可信PDA从终端获取其TPM中的PCR值和EventLog.制方案中,PDA与终端建立连接之前,首先对终端的身份进行认证,保证只有特定的终端才可以与PDA进行连接;在身份认证通过之后,对终端的平台状态进行验证;若符合要求,则允许终端与其建立连接,这样可以避免由于终端自身的安全问题而导致可信PDA上的数据遭到破坏.在实现系统中,主要有3个实体:可信PDA、接入终端和完整性参考服务器.系统架构如图13所示.(3)可信PDA通过EventLog计算PCR,并与获取的PCR比较,匹配则继续,否则判断终端不可信,程序结束.(4)可信PDA从完整性参考服务器获取标准EventLog值,并参照它验证从终端获取的Even-tLog,从而判断终端的安全状态.(5)若匹配则说明远程证明成功,终端可信,否则终端不可信.通过以上过程,可以利用可信PDA对接入网络的终端进行可信验证,从而实现可信网络连接,在此基础上,可以完成可信数据传输,可信资源共享,进一步向可信网络的应用发展.6结论本文提出了一种带数据恢复功能的星型信任结构,其在安全性、效率及可靠性等方面较TCG的链式信任结构都有很大提升.在此基础上,进一步使用总线仲裁等技术构造了可信PDA的体系结构模Page10型.文中还提出并实现了针对可信PDA嵌入式操作系统的安全增强、基于可信PDA平台的可信网络连接(TNC)以及SD卡全盘加密等新的安全技术与方法.这些理论和方法是对可信计算技术的有益发展,对PDA等嵌入式平台实现可信计算技术具有一定的应用价值,而且对解决目前可信PC的一些问题也提供了较好的思路.可信PDA的研究工作是在国家“八六三”项目支持下进行的,通过理论研究和技术实践,研制出我国第一款具有自主知识产权的可信PDA原型系统,如图14所示.经过实验验证,这款可信PDA在各方面都达到了可信计算平台的技术要求,实现了构建可信嵌入式系统的目标.
