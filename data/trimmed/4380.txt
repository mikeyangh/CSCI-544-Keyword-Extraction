Page1核零空间线性鉴别分析及其在人脸识别中的应用甘俊英何国辉何思斌(五邑大学信息工程学院广东江门529020)摘要零空间线性鉴别分析NLDA充分利用样本总类内离散度矩阵的零空间信息,能有效克服线性鉴别分析LDA的小样本问题.核方法通过非线性映射,将输入空间样本映射到高维特征空间,再在高维特征空间利用线性特征提取算法.因此,核方法属于非线性特征提取算法.文中结合LDA、NLDA和核方法的优点,引入了核零空间线性鉴别分析KNLDA,导出了KNLDA算法.该算法通过引入核函数,得到低维矩阵,有效避免了直接计算复杂的非线性映射函数,解决了高维类内离散度矩阵的维数灾难问题.同时,将KNLDA算法应用于人脸识别.基于ORL人脸数据库以及ORL与Yale混合人脸数据库的实验结果表明了KNLDA算法的有效性.关键词核零空间线性鉴别分析;零空间线性鉴别分析;核方法;人脸识别1引言人脸特征的唯一性和稳定性,以及人脸图像获取的无伤害性、非接触性、易得性,使得人脸识别技术的发展对提高识别系统的安全等级、准确性与高效性均具有重要的实用价值.自20世纪初以来,人脸识别备受研究者的关注,且已广泛应用于安防领域.人脸图像易受表情和光照变化等因素影响,因此,人脸识别是一项极富挑战性的研究[1];而如何有效提取人脸图像的鉴别特征是获得较高识别率的关键因素.作为一种线性特征提取和降维算法[2],线性鉴别分析(LinearDiscriminantAnalysis,LDA)已广泛应用于机器视觉和图像识别等领域,但难以解决遇到的“小样本”问题[3-4].零空间线性鉴别分析(NullSpaceLinearDiscriminantAnalysis,NLDA)[4-7]在训练样本总类内离散度矩阵的零空间中提取样本的鉴别特征,克服了LDA的“小样本”问题,提高了识别率.然而,NLDA仍然是一种线性特征的提取方法,不能有效提取样本的非线性特征.通过非线性映射,核方法[2,8]将输入空间样本映射到高维特征空间,在高维特征空间利用线性特征提取算法,从而有效提取样本的非线性特征.文献[5]提出NullSpace-basedKernelFisherDiscriminantAnalysis(NKFDA),选取Cosine核函数,采用直方图均衡化预处理.首先,求训练样本核函数;其次,计算训练样本总类内离散度矩阵;接着,求解训练样本总类内离散度矩阵的零空间;最后,输出训练样本的映射特征,得出有益的结论.但未从核函数角度加以探讨.本文结合LDA、NLDA和核方法的优点,引入了核零空间线性鉴别分析(KernelNullSpaceLinearDiscriminantAnalysis,KNLDA),导出了KNLDA算法;通过引入核函数,得到低维矩阵,有效避免了直接计算复杂的非线性映射函数,解决了高维类内离散度矩阵的维数灾难问题;ORL(OlivettiResearchLaboratory)人脸数据库、ORL与Yale混合人脸数据库的应用实例表明了KNLDA算法用于人脸识别的有效性.2核零空间线性鉴别分析假设C类样本分别表示为犃1,犃2,犃3,…,犃c,每类样本数为ni(i=1,2,3,…,C),总数为N;犃i犚m×1表示第i(i=1,2,3,…,C)类、第j(j=1,2,3,…,ni)个样本,则第i类样本的类内均值为犃i=ni∑ni1犃ij=12.1线性鉴别分析线性鉴别分析是以提取高维样本最具鉴别能力的低维特征为目的.将样本总类内离散度矩阵犛w和总类间离散度矩阵犛b分别定义为则样本总离散度矩阵犛t为犛t=犛w+犛b=1假设犠LDA为LDA算法的投影矩阵,则LDA准则定义为当式(4)中的投影矩阵犠LDA满足LDA准则函数J(犠LDA)最大时,样本投影后的线性鉴别特征具有最佳的分类能力.犠LDA可通过求解犛b犛-1和特征向量得到,即以犛b犛-1应的特征向量狑1,狑2,…,狑d,…,狑p组成投影矩阵:犠LDA=[狑1,狑2,…,狑d,…,狑p][2].其中,狑d为犠LDA的第d个投影向量.然而,犛w通常为奇异矩阵,其秩远小于样本的维数m,从而使犠LDA无法求解,即出现“小样本”问题(SmallSampleSizeProblem,S3Problem)[3-4,9].2.2零空间线性鉴别分析NLDA算法将样本总类内离散度矩阵犛w特征值为零对应的特征向量所构成的投影子空间称为犛w的零空间[9].在算法的实施中,首先将所有样本向犛w的零空间投影,再使投影后的样本类间距离最大.然而,犛w零空间的求解必须在m×m的高维空间中进行,计算和存储代价都很大.因此,文献[3]首先采用“像素聚类”(Pixelgrouping)方法提取样本几何特征和降低样本维数,然后计算犛w零空间.文献[9]提出了一种改进的NLDA算法,解决了文献[3]“像素聚类”计算量大的问题,并提高了识别率.同时,文献[9]提出,并非整个犛w的零空间都对样本鉴别特征提取有效,并定义了有效零空间和无效零空间.若投影矩阵狇满足狇犛w狇=0与狇犛b狇≠0,则狇为犛w的有效零空间投影矩阵;若狇犛w狇=0与Page3狇犛b狇=0,则狇为犛w的无效零空间投影矩阵.定理1.假设犙为犛w的无效零空间投影矩阵,则犙为犛t的零空间投影矩阵[4].由上可知,在NLDA算法中,首先去除犛t的零空间,将所有样本向犛t的秩空间投影,降低了样本维数而没有丢失犛w的零空间鉴别信息.犛t的秩通常为N-1[5,10],因此,样本向犛t的秩空间投影后的维数l满足lN-1m,从而解决了犛w零空间的维数灾难问题.具体描述如下[5,11].步1.去除犛t的零空间.假设犝为犛t非零特征值对应的特征向量组成的投影矩阵,则有犛w=犝T犛w犝和犛b=犝T犛b犝.步2.计算犛w的零空间.假设犘为犛w的零空间,则有犛w=犘T犛w犘=(犝犘)T犛w(犝犘)=0和犛b=犘T犛b犘=(犝犘)T犛b(犝犘).其中,犝犘为犛w的有效零空间,对提取鉴别特征有贡献.步3.若犛b的零空间存在,则将其去除,即在犛w的零空间中最大化样本的类间距离.假设犞表示犛b非零特征值对应的特征向量组成的矩阵,则NLDA的投影矩阵可表示为犠NLDA=犝犘犞.经过步1和步2,犛b通常为满秩矩阵[5,9].因此,步3可以省略.此时,NLDA投影矩阵可表示为其中,犠NLDA表示NLDA的投影矩阵,且犠NLDA∈犚m×(C-1)[5,7].2.3KNLDA算法NLDA算法是在样本总类内离散度矩阵的零空间中提取样本的鉴别特征,克服了LDA的“小样本”问题,提高了识别率.但是,作为线性特征提取方法,NLDA算法仍然不能有效提取样本的非线性特征.而核方法可以通过非线性映射,将输入空间样本映射到高维特征空间,然后在高维特征空间提取样本最具鉴别能力的非线性特征.本文结合LDA、NLDA和核方法的优点,引入了KNLDA算法,并应用于人脸识别,即将高维特征空间中样本总类内离散度矩阵的零空间投影矩阵作为人脸识别的投影矩阵.变换到高维特征空间犉中,即经过非线性映射Φ,将输入空间样本犃i则在特征空间犉中,每类样本经过非线性映射后的均值为Φ(犃i)=1狑d,…,狑p]为KNLDA的投影矩阵,则在高维特征空间犉中,样本Φ(犃i在高维特征空间犉中,样本特征犢i阵犜犛Φw表示为其中,犢i=1样本特征犢i其中,犛Φw=1Φ(犃i))T为样本在高维特征空间犉中总类内离散度矩阵.然而,非线性映射Φ的具体形式难以求出.因此,不能直接通过对犛Φw进行特征值分解求得KNLDA的投影矩阵犠KNLDA.根据核函数理论,在高维特征空间犉中,投影矩阵犠KNLDA的任意投影向量狑d可展开为所有经过非线性映射Φ后的训练样本之和[12],即其中,ai展开系数.这里,投影方向指训练样本犃i射Φ后形成的方向Φ(犃iΦ(犃i样本Φ(犃ij))=〈Φ(犃l狑TdΦ(犃i狑TdΦ(犃i)=∑C根据式(10)和式(11),有其中,犪=[犪1,犪2,…,犪d,…,犪p]为投影向量朝着投影方向投影后展开系数组成的系数矩阵.这里,投影方向指训练样本经非线性映射后形成的方向.犪d=(aid,j)i=1,2,…,Cl=1∑ni∑C因此,犜犛Φw可化简为k=1其中,犙=∑CPage4可通过解犙的特征值和特征向量得到,由选取的犙的p个较小特征值对应的特征向量所组成,维数大小为N×p.同时,pN.因此,在特征空间犉中,样本Φ(犃ij=[狔i犢ij(d)=∑C其中,狔i线性映射Φ后的样本Φ(犃i狑d投影所提取的特征.具体描述如下.步1.将输入空间样本映射到高维特征空间犉步2.计算系数矩阵犪.首先,计算矩阵犙=中,即Φ:犚m×1→犉,犃ii=1∑ni∑C犙的p个较小特征值所对应的特征向量组成矩阵犪.j=1步3.计算样本特征.样本犃i[狔ij(1),狔il=1∑ni∑Calk=1由上可知,KNLDA算法通过引入核函数K(Φ(犃l阵;选取犙的p个较小特征值对应的特征向量组成犪,矩阵犪和犙的维数大小分别为N×p和N×N,其中,pN.因此,核方法通过内积形式采用Mercer核函数,有效避免了直接计算复杂的非线性映射函数Φ,解决了高维类内离散度矩阵犛Φw的维数灾难问题.3最小距离分类器提取人脸特征之后,采用最小距离分类器完成人脸识别[13].假设犢test=[狔test(1),狔test(2),…,狔test(d),…,狔test(p)]表示任意测试样本犃test在高维空间犉中的特征;犢ij(p)]表示训练样本犃i狔i犢test与犢iD犢i其中,狔i与狔test(d)之间的欧氏距离.若第k类、第q个训练样本犃kj,犢()test成立,则将测试样本犃test判为第k类.mini,jD犢i4应用于人脸识别本文以ORL人脸数据库、以及ORL与Yale混合人脸数据库为实验对象.用KNLDA提取人脸图像的鉴别特征后,再利用最小距离分类器得到识别结果.用KNLDA算法提取样本特征时,分别选取多项式核函数K(Φ(犃l向基核函数K(Φ(犃l进行实验.4.1ORL人脸数据库的实验结果与分析基于表情和姿态变化,ORL人脸数据库由40人、每人10幅不同姿态和表情的人脸图像构成,共400幅.其中,表情及细节变化为闭眼或睁眼、笑或不笑、戴或不戴眼镜;姿态变化,如面部上下左右旋转(可达20°),变化尺度近10%;该数据库中人脸图像的分辨率为112×92,灰度级为256,部分人脸图像见图1.实验中,选取每类人脸图像的前5幅为训练样本,后5幅为测试样本,即训练样本和测试样本的总数分别为200幅.首先,选取多项式核函数,参数q变化的实验结果如图2所示.然后,分别选取多项式核函数和径向基核函数,实验结果如图3所示.图2Page5中,多项式核函数的参数q分别选为2、4、8、12、15.图3中,多项式核函数参数q等于2;径向基核函数参数δ等于1.从图2可知,当参数q为2和4时,KNLDA的最高识别率相等;当参数q分别为8、12和15时,随着参数q的增加,KNLDA的最高识别率呈下降趋势.图3选取不同核函数参数变化时的实验结果从图3可知,选取不同的特征维数,KNLDA和NLDA的识别率均在变化,且KNLDA的最高识别率高于NLDA;在KNLDA中,选取多项式核函数和径向基核函数时的最高识别率相等;随着特征维数的不断增加,KNLDA和NLDA的识别率都有下降的趋势,这主要因为此时选取了犙较多特征值对应的特征向量组成系数矩阵犪,增大了所提取样本特征的类内离散度.4.2ORL与Yale混合人脸数据库的实验结果与分析Yale人脸数据库由15人、每人11幅不同表情姿态和受光照影响的人脸图像组成,共165幅.图像分辨率243×320、灰度级256,部分人脸图像见图4.其中,光照变化为左边、右边以及正面光照;表情和姿态变化为笑或不笑、闭眼或睁眼、戴或不戴眼镜等.选取ORL人脸数据库中的400幅图像和Yale人脸数据库中每类前10幅图像构成一个含有55人、每人10幅、共550幅图像的混合人脸数据库.首先,对Yale人脸数据库的人脸图像进行一层双正交小波分解,提取其低频分量;然后,用双线性插值法将其低频分量归一化为112×92.实验中,选取混合人脸数据库每类的前3至8幅图像为训练样本,剩余的为测试样本,结果如表1所示.表1基于ORL与Yale混合人脸数据库的实验结果(单位:%)训练样本数NLDA多项式KNLDA径向基KNLDA377.0487.53481.8289.09583.6489.82687.2792.73793.3397.58896.3698.18从表1可知,多项式KNLDA和径向基KNLDA的识别率高于NLDA的识别率;当每类样本的训练样本数分别为4、7、8时,多项式KNLDA和径向基KNLDA的识别率相等.5总结与展望本文引入了KNLDA概念,导出了KNLDA算法;通过引入核函数,得到低维矩阵;有效避免了直接计算复杂的非线性映射函数,解决了高维类内离散度矩阵的维数灾难问题.同时,将KNLDA算法应用于人脸识别,有效提取了人脸图像的非线性特征,克服了LDA的“小样本”问题.实验结果表明,当多项式KNLDA随参数q增加时,识别率呈下降趋势;选取不同的核函数,KNLDA的识别率变化较小并高于NLDA,表明KNLDA算法用于人脸识别的有效性.如何有效提高复杂背景下人脸图像的识别率仍是一个有待深入研究的课题.
