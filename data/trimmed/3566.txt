Page1两层传感器网络中可验证隐私保护Top-犽查询协议范永健1),2),3)陈红1),2)1)(中国人民大学数据工程与知识工程教育部重点实验室北京100872)2)(中国人民大学信息学院北京100872)3)(河北工程大学信息与电气工程学院河北邯郸056038)摘要无线传感器网络中隐私保护技术已经成为研究热点,其中隐私保护精确Top-k查询协议已成为富有挑战性的研究问题.文中提出了一种两层传感器网络中可验证隐私保护Top-k查询协议SafeTQ(SafeTop-kQuery),SafeTQ由隐私保护Top-k查询协议和两种完整性验证模式组成.SafeTQ使用加随机数扰乱、加密和高资源节点之间安全计算第k位数据值等策略,能够在不泄漏隐私信息的情况下,精确地完成传感器网络Top-k查询.SafeTQ中两种完整性验证模式分别使用邻居数据项形成加密链和空间邻居节点概率发送验证消息策略,使Sink能够检测和拒绝不正确或不完整查询响应.文中通过理论分析和使用真实数据集实验验证了SafeTQ的安全性和有效性.关键词物联网;无线传感器网络;Top-k查询;隐私保护;完整性验证;安全计算1引言无线传感器网络(以下简称为传感器网络)作为物联网的重要组成部分,在环境监测、医疗卫生、智能交通、国防军事等领域具有广阔的应用前景.随着传感器网络应用发展,在实际应用部署过程中暴露出严重的隐私泄漏威胁.在野生动物监测应用中,珍Page2贵野生动物的位置信息可能被用于非法捕猎;在医疗应用领域,患者的体征敏感数据可能被泄漏;在车载传感网应用中,车载实体的位置和运动轨迹等敏感信息可能被泄漏;在军事应用领域,重要数据、基站或事件源位置等敏感信息泄漏可能造成严重后果.传感器网络中这些严重的隐私泄漏威胁,极大地影响了传感器网络的应用发展.研究和解决传感器网络中的隐私保护问题,对传感器网络的大规模应用具有重要意义.传感器网络中数据隐私保护技术已经成为研究热点,现有研究内容主要集中在SUM、MIN、MAX或Median等聚集操作中隐私保护技术[1-3]和范围查询隐私保护和验证技术[4-6].文献[7]研究了Top-k查询完整性验证技术,但该文献没有考虑数据隐私问题.Top-k查询是传感器网络中重要的查询类型.由于传感器网络可验证隐私保护精确Top-k查询协议面临诸多挑战.据作者所知,目前相关成果基本还是空白.传感器网络Top-k查询隐私保护和验证技术面临的挑战主要表现在以下方面:(1)Top-k查询执行需要查询区域的全局数据信息,并且执行过程中不能泄漏数据值等敏感信息;(2)应同时保证Top-k查询的正确性和精确性;(3)传感器节点资源严重受限,应减少传感器节点能量消耗,尽量利用高资源节点(两层传感器网络中);(4)将Top-k查询隐私保护和验证技术结合,同时保证数据的隐私性和完整性.本文研究两层传感器网络中Top-k查询的安全性问题.两层传感器网络具有寿命长等优点,已成为研究热点[4-7].在两层传感器网络中,由于单元头节点需要聚集数据和执行查询,往往成为被攻击的对象.单元头节点被俘获后常进行破坏隐私性和破坏完整性两种模式的攻击.本文在单元头节点不安全的情况下,为应对破坏隐私性攻击威胁,采用加随机数扰乱、加密和高资源节点之间进行安全计算等策略,能够在不泄漏隐私信息的情况下,精确地完成传感器网络Top-k查询;为应对破坏完整性攻击威胁,采用邻居数据项形成加密链和空间邻居节点概率发送验证消息策略,能够使Sink检测和拒绝不正确或不完整查询响应.本文主要贡献有:(1)提出两层传感器网络中隐私保护Top-k查询协议,首次实现了在不泄漏隐私信息的情况下,精确地完成传感器网络Top-k查询;(2)提出两种新颖的两层传感器网络中Top-k查询完整性验证模式,能够使Sink检测和拒绝不正确或不完整查询响应;(3)将隐私保护Top-k查询协议与完整性验证模式结合,形成两层传感器网络中可验证隐私保护Top-k查询协议SafeTQ(SafeTop-kQuery);(4)通过理论分析和使用真实数据集仿真实验,分析和验证了SafeTQ的安全性和有效性.本文第2节介绍相关研究工作;第3节给出本文研究所基于的模型和安全设计目标;第4节对SafeTQ进行形式化描述;第5节给出安全性分析和证明;第6节使用公开真实数据集进行仿真实验证明了SafeTQ的有效性;第7节进行总结.2相关工作(1)隐私保护技术目前,隐私保护技术研究成果主要集中在数据挖掘和数据发布两个领域[8].综合现有的研究成果,隐私保护技术主要可分为三类:数据扰乱技术、数据加密技术和数据匿名化技术.数据扰乱技术使用加随机数、交换等技术对原始数据进行扰动,但需要保证处理后数据能够满足相关应用需求;在数据加密技术中,安全多方计算(SecureMultipartyComputation,SMC)是目前研究热点之一;数据匿名化技术主要成果有k-anonymity、l-diversity、t-Closeness等模型.没有任何一种隐私保护技术适用于所有应用.适用于多方参与通信环境的安全多方计算是基于可交换加密等技术实现的,通信和计算开销都较大,不适合直接在资源严重受限的传感器节点间运行,传感器节点能量消耗量直接影响传感器网络的寿命.本文将消耗能量较高的安全比较计算设计在两个高资源节点之间完成,在性能上适用于两层传感器网络环境.k-anonymity等匿名化技术是基于泛化等技术实现的,往往在隐私披漏风险和数据精度之间进行折中.为保证Top-k查询的精确度,本文采用加随机数扰乱技术,通过安全比较算法能够精确完成Top-k查询,加随机数扰乱技术的隐私安全程度高于k-anonymity模型.(2)传感器网络数据隐私保护技术近年来,传感器网络数据隐私保护技术成为研究热点,有许多有价值的研究成果发表.文献[1-3]针对攻击者俘获聚集节点企图获取敏感信息的攻击模型,提出了具有保护隐私功能的SUM、MIN、MAX和Median等数据聚集算法,文献[4-6]在两Page3层传感器网络中存储节点被俘获的情况下,研究范围查询隐私保护和可验证技术.文献[7]采用加密数据关系链技术,嵌入额外附加信息outlier,在两层传感器网络中存储节点被俘获的情况下,实现Top-k查询的完整性验证,但没有考虑隐私保护问题.Top-k查询是传感器网络中重要的查询类型,用于对污染、干旱或易发生火灾等区域的污染指数、湿度或温度值等数据的查询和监测.在这方面有一些研究成果[9-11],这些研究成果集中在以减少能量为目标的查询优化方面,没有考虑隐私保护问题.(3)分布式隐私保护Top-k查询技术在分布式Top-k查询隐私保护研究方面,文献[12]提出在分布的多站点中安全计算第k位值的算法.文献[13]针对分布式垂直划分的数据集,提出隐私保护Top-k算法.上述算法通信和计算代价大,特别是在多站点中安全发现数据项并集和计算交集数据项个数时,使用安全多方计算技术需要很高的通信和计算代价,该协议不适用于传感器网络中的Top-k查询.3模型3.1网络模型两层传感器网络存在大量资源相对较少的传感器节点和少数资源充裕的高资源节点.传感器节点构成下层网络,将数据传送至高资源节点;高资源节点构成上层网络,完成数据聚集和执行查询任务.本文采用的两层传感器网络模型如图1所示.两层传感器网络被划分为若干个单元(cell),单元划分时应保证每个单元区域至少存在2个高资源节点.选择单元内一个高资源节点作为单元头节点(cellheader),另外指定一个高资源节点作为辅助计算节点(computingnode),即每个单元由单元头节点、辅助计算节点和若干个传感器节点组成.单元头节点与单元头节点之间能够进行长距离、高速率通信,形成多跳的上层网络,Sink与一些单元头节点进行无线链接,这种无线链接(如卫星链接)往往具有不稳定、高代价、低速率等特点.这就要求隐私保护Top-k查询操作应在单元内进行,以尽量减少单元头节点与Sink之间的通信量.单元头节点拥有本单元内网络拓扑信息,Sink拥有全局网络拓扑信息.由于两层传感器网络具有寿命长、易扩展等优点,使其具有良好的发展空间.目前很多研究[4-7]采用了两层传感器网络模型.3.2查询模型式化表示为本文采用的传感器网络Top-k查询t模型形其中C为查询单元,G为查询区域,t为查询周期,k为查询需要返回的最大(或最小)的数据项数.Top-k查询{C,G,t,k}在指定查询区域G和查询周期t内所采集的全体数据中查询Top-k数据,本文研究Top-k查询t中隐私保护技术和完整性验证机制.与文献[7]相似,SafeTQ仅描述查询区域在同一单元内的情况,对于查询区域为多个单元的情况能够进行分解处理.3.3攻击模型与安全目标单元头节点需要完成数据聚集和查询任务,攻击者俘获单元头节点对传感器网络安全性将造成严重的威胁.本文假设攻击者企图俘获单元头节点,通过单元头节点进行攻击的情况下,研究Top-k查询的隐私保护技术和完整性验证机制.传感器节点被俘获的情况下,攻击者仅能获取或修改被俘获节点采集的数据,对Top-k查询隐私性和完整性威胁较小,本文不考虑传感器节点被俘获的情况.不失一般性,本文假设攻击者俘获单元头节点后,具有的特征和背景知识为:(1)能够获得单元头节点收到和存储的明文数据,这些数据可能来自传感器节点或Sink;(2)不能解密使用传感器节点和Sink共享密钥加密的数据;(3)能够获得单元头节点的背景知识,如网络拓扑等信息.对传感器网络中Top-k查询隐私性和完整性定义如下.定义1.传感器网络中Top-k查询隐私性.传感器网络中Top-k查询t={C,G,t,k}正确执行时,如果攻击者不能获得以下敏感信息,则查询t满足隐私性:(1)查询区域G内传感器节点采集数据集Vt=∪si∈GVsi中数据项,其中Vsi为传感器节点Page4si∈G采集的数据集;(2)Top-k数据集t={vq|vq∈Vt且vqvkth}中数据项,其中vkth为Vt中第k位数据值;(3)Top-k节点集{si|si≠}中节点ID,其中si={vq|vq∈Vsi且vqvkth}.定义2.传感器网络中Top-k查询完整性.传感器网络中单元头节点返回的响应Top-k查询t={C,G,t,k}结果集t满足以下条件,则查询t满足完整性:(1)结果集t中任何数据项都是查询区域G内传感器节点采集的真实数据,即tVt,其中Vt为采集数据集;(2)结果集t中任何数据都大于等于第k位数据值vkth,即v∈t,有vvkth;(3)采集数据集Vt中任何大于等于第k位数据值vkth的数据都在结果集t中,即v∈Vt且vvkth,有v∈t.本文假设单元头节点被俘获后采用如下两种模式进行攻击:(1)破坏隐私性攻击模式,攻击者企图记录或推测定义1中描述的敏感信息,破坏传感器网络中Top-k查询隐私性;(2)破坏完整性攻击模式,攻击者企图通过插入、篡改或删除查询响应结果,破坏传感器网络中Top-k查询完整性.本文的完全目标为:SafeTQ能够应对以上两种模式的攻击,在不泄漏隐私信息的情况下精确地完成Top-k查询,并且能够使Sink检测和拒绝不正确或不完整查询响应.4SafeTQ协议两层传感器网络中可验证隐私保护Top-k查询协议SafeTQ由隐私保护Top-k查询协议和两种完整性验证模式组成.两种完整性验证模式分别为数据项加密链验证模式和概率空间邻居验证模式.根据使用的完整性验证模式不同,SafeTQ分为SafeTQ-L和SafeTQ-N,其中SafeTQ-L使用数据项加密链验证模式,SafeTQ-N使用概率空间邻居验证模式.4.1隐私保护Top-犽查询协议隐私保护Top-k查询协议的基本思路为:接到Top-k查询t后,传感器节点si∈G产生随机数ri,将周期t内采集的数据集Vsi中前k个数据{vi,1,vi,2,…,vi,k}分别与随机数ri求和,将求和结果传送到单元头节点,同时将该随机数ri传送到辅助计算节点,由单元头节点与辅助计算节点通过安全比较,计算出周期t内查询区域G中采集的全体数据集Vt=∪si∈GVsi中第k位数据值vkth,单元头节点将vkth作为阈值下发至查询区域内所有传感器节点,传感器节点si∈G将Vsi中每个数据vi,j与vkth比较,大于等于vkth的数据即为Top-k数据,这些Top-k数据构成传感器节点si查询响应结果集si,根据所选用的完整性验证模式不同进行相应处理后,使用传感器节点与Sink共享的密钥加密并传送到单元头节点,由单元头节点上传至Sink,Sink解密并确定查询t结果集t=∪si∈Gsi(即Top-k数据集).述如下:结合图2,对隐私保护Top-k查询协议进行描(1)传感器节点数据加随机数处理Sink将Top-k查询t={C,G,t,k}发送给单元头节点,单元头节点将查询参数{t,k}下发给查询区域G内的传感器节点si∈G.传感器节点si∈G对在周期t内采集的数据集Vsi进行排序,并取前k个数据构成{vi,1,vi,2,…,vi,k}(vi,1vi,2…vi,k且l≠j(j=1,2,…,k),vi,lvi,j),传感器节点si∈G产生随机数ri,将ri与前k个数据集{vi,1,vi,2,…,vi,k}中每一项数据分别进行求和,数据项vi,j∈{vi,1,vi,2,…,vi,k}(j=1,2,…,k)与ri求和结果记为vri,j=vi,j+ri,传感器节点si将求和结果{vri,1,vri,2,…,vri,k},发送到单元头节点:si(si∈G)→cellheader:i,{vri,1,vri,2,…,vri,k}.发送到辅助计算节点:同时,传感器节点si将本节点产生的随机数ri,si(si∈G)→computingnode:i,{ri}.(2)安全计算第k位数据值单元头节点与辅助计算节点通过4.2节描述的算法,在单元头节点和辅助计算节点不能获知任何数据项值的情况下,计算出数据集Vt=∪si∈GVsi中第k位数据值vkth,vkth将数据集Vt中数据值最大的前k项与第k+1项及其之后的数据区分开来.单元头节点将阈值vkth发送至查询区域内所有传感器节点si∈G:Page5(3)生成查询响应结果集并加密上传传感器节点si∈G将vkth与周期t内采集的数据集Vsi进行比较,大于等于vkth的数据(即为Top-k数据)形成节点si的查询响应结果集si={vq|vq∈Vsi且vqvkth}.SafeTQ使用传感器节点与Sink共享的密钥,对需要上传的数据进行加密,单元头节点没有解密能力.为了增加安全性,本协议采用文献[4]中周期更换密钥方式,用ki,t表示周期t内传感器节点si与Sink共享的密钥,则有ki,t=hash(ki,t-1).对si分情况进行加密处理,使用数据项加密链验证模式时,需要按4.3.1节要求进行加密并形成数据项加密链;使用概率空间邻居验证模式时,对si直接进行整体加密.加密后经单元头节点上传至Sink:si(si≠)→cellheader→Sink:i,Eki,t{si}.(4)使用完整性验证模式生成验证消息根据所选用完整性验证模式进行不同的处理.使用数据项加密链验证模式,需要所有非Top-k节点si(si=))产生验证消息vl(详见4.3.1节);使用概率空间邻居验证模式,需要Top-k节点si(si≠)的邻居节点以概率p发送验证消息vn(详见4.3.2节).不使用完整性验证模式的情况下,隐私保护Top-k查询协议需要部分非Top-k节点发送虚假消息f,以避免单元头节点能够将上传加密数据的节点准确地判断为Top-k节点,造成敏感信息泄漏.为了下式描述方便,将vn、vl或f统一表示为.使用传感器节点si与Sink共享的密钥ki,t对进行直接加密后,经单元头节点上传至Sink:si(si∈G)→cellheader→Sink:i,Eki,t{}.(5)Sink解密并处理数据Sink解密数据,并进行如下处理:根据消息标志判断验证消息或虚假数据,根据完整性验证模式进行相应的完整性验证(详见4.3.1节和4.3.2节),求所有si并集得到查询t结果集t=∪si∈Gsi,即Top-k数据集.4.2安全计算第犽位数据值算法本节给出安全计算第k位数据值算法.安全计算第k位数据值算法利用二分查找和安全比较算法[12-14],在单元头节点和辅助计算节点不能获知任何数据项值的情况下,安全计算出数据集Vt中第k位的数据值vkth.1986年发表的文献[14]提出的安全比较算法,实现了在参与计算双方不能获知对方数据值的情况下进行安全比较计算.传感器节点si∈G将产生的随机数ri与前k个数据项求和vri,j=vi,j+ri(j=1,2,…,k),并将求和结果{vri,1,vri,2,…,vri,k}传送给单元头节点,同时将随机数ri传送到辅助计算节点,显然有vi,j=vri,j-ri.为了表述简单,将单元头节点收到的所有求和结果∪{vri,1,vri,2,…,vri,k}统一表示为{a1,a2,…,an}(n=|∪{vri,1,vri,2,…,vri,k}|),辅助计算节点将收到的所有随机数求相反数后得集合∪{-ri},将集合∪{-ri}相应项表示为{b1,b2,…,bn}(n=|∪{vri,1,vri,2,…,vri,k}|),则m,vm=am+bm,有vm∈{vi,j}.安全计算第k位数据值算法,使用二分查找法搜索第k位数据值vkth.用middle表示中间探测值,对于每一个数据项,单元头节点与辅助计算节点运用安全比较算法,比较middle与vm=am+bm的大小关系,根据middle与vm的大小关系,产生相应输出.在全部数据项安全比较完成后,单元头节点与辅助计算节点对各自所得输出结果求和,使用安全比较算法将该求和结果与k进行比较,依此判断middle与vkth的大小关系,如相等则返回vkth,否则,按二分查找算法进行下一轮处理,直到找到并返回vkth.假设共有x项数据上传至单元头节点,用M表示数据值域上界,算法能够在log|M|轮内找到第k位数据值,在每轮中所有x项数据都需要参与安全比较,算法复杂度为O(xlog|M|).算法1.安全计算第k位数据值.输入:单元头节点和辅助计算节点各自输入数据集输出:第k位数据值vkth1.lbound←0//数据值域下界2.ubound←M//数据值域上界M3.whiletruedo4.middle←(lbound+ubound)/25.form=1,2,…,ndo6.使用文献[14]的安全比较算法,输入am,bm,7.endfor8.单元头节点:lla←∑n9.辅助计算节点:llb←∑nPage610.ifllam+llbm(mod|M|)>kthen//middle>vkth11.ubound←middle12.elseifllam+llbm(mod|M|)<kthen//middle<vkth13.lbound←middle14.else//middle=vkth15.returnmiddle//返回第k位数据值vkth16.endif17.endwhile4.3完整性验证模式单元头节点可能通过插入虚假数据、篡改和删除数据,破坏3.3节中定义2定义的传感器网络中Top-k查询完整性.插入虚假数据破坏定义2中条件1,同时可能破坏条件2;篡改数据破坏条件1和条件3,可能破坏条件2;删除数据破坏条件3.SafeTQ使用传感器节点与Sink共享的密钥进行加密,在假设传感器节点没有被俘获的前提下,单元头节点不能获得密钥即没有解密和加密能力,所以单元头节点插入虚假数据和篡改数据时,破坏了加密数据包的完整性,Sink不能正确解密,从而能够检测到该攻击.但是,如果被俘获的单元头节点删除传感器节点上传的加密数据包,则破坏了查询t的完整性,需要使用完整性验证模式进行完整性验证.本文设计的两种完整性验证模式分别为数据项加密链验证模式和概率空间邻居验证模式,分别与隐私保护Top-k查询协议结合形成SafeTQ-L和SafeTQ-N.4.3.1数据项加密链验证模式数据项加密链验证模式使用数据项加密链技术检测对si的部分删除攻击,并使用非Top-k节点发送验证消息策略检测对si的整体删除攻击,由数据项加密链和验证消息共同完成Top-k查询完整性验证.本文针对隐私保护Top-k查询协议设计了相应的数据项加密链数据结构.数据项加密链技术[7-8]通过对有序数据集填充冗余数据,分段加密形成数据项加密链,使得解密后能够检测数据集的完整性.通过示例对数据项加密链技术进行演示,假设有序数据集为{2,4,6,8},使用密钥ki,t加密后形成的数据项加密链为{(Min|2)ki,t,(2|4)ki,t,(4|6)ki,t,(6|8)ki,t,(8|Max)ki,t}.分别使用--和用ni表示Top-k节点si(si≠)形成查询响应结果集si中数据项个数,即ni=|si|.对数据项加密链验证模式进行描述如下:(1)Top-k节点si(si≠)对si排序,排序后表示为{vqi,1,vqi,2,…,vqi,ni}(vqi,1>vqi,2>…>vqi,ni),使用传感器节点与Sink共享的密钥ki,t,对排序后的si加入冗余数据和公共极值--和加密后形成数据项加密链{(--|vqi,1)ki,t,(vqi,1|vqi,2)ki,t,…,(vqi,ni-1|vqi,ni)ki,t,(vqi,ni|数据项加密链经过单元头节点上传至Sink:si(si≠)→cellheader→Sink:(2)查询区域G内所有非Top-k节点si(si=)生成验证消息vl,采用传感器节点与Sink共享的密钥ki,t加密,经单元头节点上传至Sink:si(si=)→cellheader→Sink:i,{(vl)ki,t}.(3)Sink解密并进行完整性验证Sink对所有收到的加密数据进行解密,本模式需要Sink进行两类验证:(i)所有数据项加密链的完整性;(ii)是否查询区域G内所有节点均上传了加密数据.如果有数据项加密链不完整或查询区域G内有节点未上传加密数据,则判断为Top-k查询t不完整.下面讨论攻击者进行不同方式的完整性攻击时,数据项加密链验证模式进行完整性验证的情况.传感器节点和Sink共享密钥的加密方式,使Sink能够检测出攻击者插入虚假数据和篡改数据的攻击方式.所以,完整性验证模式仅需要考虑攻击者部分或全部删除加密数据的情况:(i)如果{(vqi,j|vqi,j-1)ki,t}(1<jni)被单元头节点删除,因不能形成完整的数据项加密链,而能够被Sink检测出;(ii)如果{(--|vqi,1)ki,t}或{(vqi,ni|元头节点删除,因数据项加密链缺少公共极少值--或公共极大值(iii)如果某数据项加密链被整体删除,Sink根据网络拓扑信息,能够检测出未收到加密数据的节点,因为本模式要求查询区域G内所有节点发送加密数据,Sink据此判断受到了完整性攻击.此模式需要查询区域G内所有节点发送加密数据,即查询区域G内非Top-k节点也需要发送加密的验证消息,并且需要冗余数据形成数据项加密Page7链,则此模式需要较高的通信代价.下面给出通信代价较小的概率空间邻居验证模式.4.3.2概率空间邻居验证模式概率空间邻居验证模式的基本步骤为:需要响应查询的Top-k节点si(si≠),对查询响应结果集si整体加密后上传,同时向邻居节点广播消息点生成验证消息vn,将vn与Top-k节点si的编号i一起加密后,以给定概率p上传,Sink解密后使用验证消息进行完整性验证.,表明本节点为Top-k节点,收到播消息对概率空间邻居验证模式进行描述如下:在传感器网络隐私保护Top-k算法中,Top-k节点si(si≠)形成查询响应结果集si后,进行以下操作:(1)Top-k节点si(si≠)使用与Sink共享密钥ki,t,对si进行整体加密后,经单元头节点上传至Sink:si(si≠)→cellheader→Sink:i,{si}ki,t.(2)Top-k节点si(si≠)向空间邻居节点广si(si≠)→neighbourhood:i,(3)Top-k节点si的邻居节点sj收到广播消息后,生成验证消息vn,使用与Sink共享的密钥kj,t,将vn与Top-k节点si的编号i一起加密,为了减少通信量,以给定概率p经单元头节点上传至Sink:p:sj→cellheader→Sink:j,{i,vn}kj,t.(4)Sink解密并进行完整性验证Sink对加密数据进行解密.对于与验证消息vn一起加密的节点编号i,Sink检测是否收到其对应节点si∈G的查询响应结果集si,如没收到,则判断为查询t结果集t=∪si∈Gsi不完整.在概率空间邻居验证模式中,传感器节点si使用与Sink节点共享的密钥ki,t,对查询结果集si进行整体加密,因此单元头节点插入虚假数据包、篡改数据将被检测出,其仅能够通过整体删除加密后的查询响应结果{si}ki,t来破坏查询完整性.Sink通过空间邻居节点发送的验证消息,能够判断攻击者是否删除{si}ki,t,以完成完整性验证.5安全性分析5.1隐私性分析定理1.SafeTQ正确完成Top-k查询t过程中,单元头节点不能获得Top-k查询隐私性定义(定义1)中描述的敏感信息.证明.SafeTQ在完成Top-k查询t过程中,单元头节点可能在以下环节获取定义1中描述的敏感信息:(环节1)为计算第k位数据值vkth而收集数据信息时,获取采集数据值;(环节2)与辅助计算节点合作计算k位数据值vkth时,获取采集数据值和Top-k数据值;(环节3)接收Top-k节点上传的查询响应结果集si时,获取Top-k数据值并推测Top-k节点.在SafeTQ执行时,在环节1中传感器节点将数据与本节点产生的随机数求和后上传,单元头节点无法获得真实数据;在环节2中使用二分查找和安全比较计算第k位数据值,单元头节点和辅助计算节点不能获知任何数据项值,安全比较算法[14]保证了参与计算的双方不能获知对方的数据值;在环节3中,一方面,使用传感器节点和Sink共享密钥加密数据,单元头节点不能通过解密获取Top-k数据值,另一方面,SafeTQ要求部分非Top-k节点产生扰乱数据,使单元头节点不能将上传加密数据的节点准确地推测为Top-k节点.综上所述,在SafeTQ执行过程中,单元头节点不能获得定义1中描述的敏感信息.定理2.SafeTQ正确完成Top-k查询t过程中,辅助计算节点不能获得Top-k查询隐私性定义(定义1)中描述的敏感信息.证明.SafeTQ执行Top-k查询t过程中,辅助计算节点仅负责接收传感器节点si∈G传送的随机数ri,与单元头节点使用安全比较算法计算第k位数据值vkth.安全比较算法[14]保证辅助计算节点不能获得单元头节点的数据信息.SafeTQ执行过程中采集的数据和查询响应的Top-k数据不向辅助计算节点传送.所以,定理2成立.证毕.定理3.SafeTQ正确完成Top-k查询t过程中,在传感器节点没有被俘获的情况下,SafeTQ满足传感器网络中Top-k查询隐私性定义(定义1).证明.根据定理1、2,SafeTQ执行Top-k查询t过程中,单元头节点和辅助计算节点不能获得定义1中敏感信息.在传感器节点没有被俘获的情况下,SafeTQ执行过程中攻击者不能获得定义1中敏感信息.所以,SafeTQ满足传感器网络中Top-k查询隐私性定义.5.2完整性分析定理4.在没有传感器节点被俘获发起攻击Page8的情况下,SafeTQ-L检测出单元头节点被俘获发起完整性攻击的概率为100%.证明.单元头节点可能通过插入虚假数据包、篡改数据和删除数据操作进行完整性攻击,破坏定义2定义的Top-k查询完整性.在没有传感器节点被俘获发起攻击的情况下,由于SafeTQ-L使用传感器节点与Sink共享密钥的加密方式,Sink检测出单元头节点插入虚假数据和篡改数据的概率为100%;由于SafeTQ-L使用数据项加密链技术,Sink检测出单元头节点删除数据项加密链中任意项的概率为100%;由于SafeTQ-L要求查询区域G内所有节点全部发送加密数据,且Sink拥有网络拓扑信息,所以Sink检测出单元头节点删除某传感器节点上传的全部加密数据的概率为100%.综上所述,在没有传感器节点被俘获发起攻击的情况下,SafeTQ-L检测出单元头节点被俘获发起完整性攻击的概率为100%.定理5.没有传感器节点被俘获发起攻击的情况下,在SafeTQ-N的Top-k节点si(si≠)和其空间邻居节点传送到单元头节点的加密数据中,单元头节点随机删除某加密数据项,使得完整性被破坏且被检测出的概率为1-(1-p)n/(p×n+1),其中p为SafeTQ-N中邻居节点发送验证消息的概率,n为Top-k节点si(si≠)空间邻居的个数.证明.在SafeTQ-N使用的概率空间邻居验证模式中,Top-k节点si(si≠)将消息给空间邻居节点,空间邻居节点以概率p向单元头节点发送验证消息,设Top-k节点si有n个空间邻居节点,则没有任何空间邻居节点发送验证消息的概率为(1-p)n,向单元头节点发送验证消息的邻居节点个数的期望值为p×n.SafeTQ-N将验证消息与响应查询数据项设计为相同长度,使得单元头节点不容易区分加密的查询响应数据项和加密的验证消息项.只有单元头节点删除加密查询响应数据项,Top-k查询完整性才被破坏.在SafeTQ-N的Top-k节点si(si≠)和其空间邻居上传的加密数据包中,单元头节点随机删除的加密数据项为加密查询响应数据项的概率为1/(p×n+1),此情况下Sink不能检测到的概率为(1-p)n/(p×n+1).所以,没有传感器节点被俘获发起攻击的情况下,单元头节点随机删除某数据项,使得完整性被破坏且被检测出的概率为1-(1-p)n/(p×n+1).证毕.定理6.SafeTQ执行Top-k查询t时,能够检测出辅助节点被俘获发起的完整性攻击.证明.SafeTQ执行过程中,辅助计算节点负责接收传感器节点si∈G传送的随机数ri,与单元头节点使用安全比较算法计算第k位数据值vkth.辅助计算节点被俘获仅能够通过插入、篡改和删除其接收的随机数,进行完整性攻击.根据安全计算第k位数据值算法(详见4.2节),辅助计算节点接收到的随机数ri与单元头节点收到的求和结果vri,j=vi,j+ri一一对应.当辅助计算节点插入或删除随机数项后,安全计算第k位数据值算法执行时将出错,从而检测出此攻击.如果辅助计算节点篡改随机数值,将计算出错误的第k位数据值vkth,使传感器节点筛选出的查询响应结果集si不完整或不正确,进而使Sink解密汇总的查询结果集t不完整,此时t中数据项数不等于k(|t|≠k).执行SafeTQ-L时,Sink确认所有数据项加密链完整且已收到所有传感器节点上传的加密数据后,如检测|t|不等于k值,则判断为辅助节点被俘获并发起完整性攻击;执行SafeTQ-N时,Sink确认验证消息携带编号对应节点上传的加密数据全部收到后,如检测|t|不等于k值,则判断为辅助节点被俘获并发起完整性攻击.6实验与分析本文设计的SafeTQ协议代价主要由三部分组成:传感器节点采集、计算和传输数据消耗的代价;单元头节点与辅助计算节点两个高资源节点之间安全计算第k位数据值vkth的代价;单元头节点与Sink之间传输数据的代价.4.2节已给出单元头节点与辅助计算节点之间安全计算第k位数据值的算法复杂度.对于传感器节点,通信能量消耗远大于计算能量消耗,如文献[7,15],本文使用数据通信量评价算法的有效性.本实验对单元内传感器节点通信量和单元头节点与Sink之间的外部通信量分别进行考查,前者影响整个网络寿命,后者使用高代价、低速率的无线链接(如卫星链接),要求通信量尽量小.分构成:单元内传感器节点传输数据通信量主要由4部(1)为安全计算阈值vkth向单元头节点传输采集数据和随机数之和,数据项格式为(2)为安全计算阈值vkth向辅助计算节点传输随机数,数据项格式为节点ID:4B随机数:4B;Page9(3)传感器节点对查询响应数据加密后向单元头节点传输,数据格式为日期:4B时间:4B节点ID:4BTop-k数据:4B;(4)传输验证消息,在数据项加密链验证模式中,非Top-k节点对验证消息加密后向单元头节点传输,数据格式为节点ID:4B验证信息:4B,在概率空间邻居验证模式中,Top-k节点向邻居节点广播数据的格式为节点ID:4B广播消息:4B,邻居节点对验证消息加密后向单元头节点传输,数据格式为Top-k节点ID:4B验证信息:12B,将邻居节点发送的验证消息设计为16字节,使得攻击者不容易区分验证消息和查询响应消息.本文采用文献[4,7]中密钥机制,使用16位密钥进行加密.本文使用真实数据集在OMNeT++平台上对SafeTQ进行仿真实验.本文使用公开可获得的真实数据集LUCEdataset①,该数据集为2006年11月至2007年5月采集的环境温度、土壤湿度等11维属性数据,本文使用环境温度数据进行仿真.根据LUCEdataset中节点位置数据,88个传感器节点分布在半径280m的圆形区域内,这些传感器节点和单元头节点、辅助计算节点一起构成两层传感器网络的划分单元,作为仿真实验查询区域.本文仿真实验中,单元头节点位于单元中心,假设传感器节点有效传输距离为60m,使用TAG(tinyaggregationserviceforadhocsensornetworks)算法建立路由,传感器节点向单元头节点传输数据平均需要3.13跳,每个传感器节点平均有10.97个邻居节点.本实验的前两组实验分别考查查询参数k值和查询周期t对以下3种协议单元内传感器节点通信量和单元外通信量影响:使用数据项加密链验证模式的SafeTQ-L、使用概率空间邻居验证模式的SafeTQ-N和没有隐私保护和验证机制的Top-k查询协议Topk-TAG.为了增加可比性,Topk-TAG和SafeTQ使用同样的Top-k查询策略和TAG路由.第3组实验考察SafeTQ-N中空间邻居节点发送验证消息的概率p对SafeTQ-N协议通信量的影响.为便于描述,本实验假设1个时间单位传感器节点采集1轮数据,即查询周期t内采集t轮数据.第1组实验考查k值对通信量的影响.实验在参数t=10和p=0.6下进行.图3显示k值对单元内传感器节点通信量影响,可以看出SafeTQ-L和SafeTQ-N通信量高于没有隐私保护和验证机制的Topk-TAG,SafeTQ-L通信量略高于SafeTQ-N.同时,三者趋势基本相同,当k<10时,通信量随k值接近于线性增长,当k10时,通信量增长缓慢.这是因为单元内传感器节点通信量主要由传感器节点将采集数据的前k项或全部数据传输到单元头节点产生,以计算第k位数据值vkth.在本组实验中t=10,根据假设在查询周期t内传感器节点采集10项数据.为计算第k位数据值vkth,当k<t时,传感器节点上传前k项数据,通信量随k值呈近似线性增长,当kt时,传感器节点上传全部的t项数据,此时通信量随k值增长不再显著.SafeTQ中由于传输随机数、验证消息和对响应查询数据加密,使得SafeTQ-L和SafeTQ-N通信量高于Topk-TAG.图4显示k值对单元头节点和Sink之间通信量的影响,可以看出SafeTQ-L通信量明显高于SafeTQ-N和Topk-TAG,这是因为SafeTQ-L使用的数据项加密链验证模式要求使用增加冗余数据形成数据项加密链,并且需要全部非Top-k节点发送验证消息,使得其通信量高于SafeTQ-N.图3k值对单元内传感器节点通信量的影响(t=10,p=0.6)图4k值对单元外部通信量的影响(t=10,p=0.6)第2组实验考查查询周期t对通信量的影响.实验在参数k=10和p=0.6下进行.根据假设查询周期t内传感器节点采集t轮数据.图5考查查询周期t对单元内传感器节点通信量影响,通信量增长的主体趋势和原因与图3相似.为计算第k位数据值vkth,当t<k时,传感器节点上传全部的t项数据,通信量随t值接近于线性增长,当tk时,传感①http://sensorscope.epfl.ch/index.php/Environmental_DataPage10器节点上传前k项数据,此时通信量随t值增长不再显著.在图5、图6中,t=1时,SafeTQ-N的通信量高于SafeTQ-L,这是因为从统计意义上看,k值相同时,t值越小Top-k节点数目越多,当t=1时,Top-k节点个数为k,而SafeTQ-N要求每个Top-k节点广播消息给邻居节点,邻居节点再以概率发送验证消息,所以Top-k节点数量对SafeTQ-N通信量影响较大.图6显示t值对单元头节点和Sink之间通信量的影响,可以看出t值对SafeTQ-N影响较大,对SafeTQ-L影响较小,而Topk-TAG不受t值影响.图5查询周期t对单元内传感器节点通信量的影响图6查询周期t对单元外部通信量的影响(k=10,p=0.6)第3组实验考查SafeTQ-N发送验证消息概率p对通信量的影响.实验在参数k=10和t=10下进行.从图7、图8可以看出,单元内传感器节点通信量和单元外通信量均随概率增大而单调递增.同时可以看出,无论p取何值,SafeTQ-N通信量均低于SafeTQ-L,但高于Topk-TAG.图7概率p对单元内传感器节点通信量的影响(k=10,t=10)图8概率p对单元外部通信量的影响(k=10,t=10)7总结目前传感器网络中隐私保护精确Top-k查询协议研究已成为富有挑战性的研究问题.本文提出了一种两层传感器网络中可验证隐私保护Top-k查询协议SafeTQ.根据使用的完整性验证模式不同,SafeTQ分为SafeTQ-L和SafeTQ-N.对SafeTQ的安全性和有效性评价总结如下:(1)SafeTQ使用随机数扰乱、加密和高资源节点之间安全计算第k位数据值策略,首次实现了在不泄漏隐私信息的情况下,精确地完成传感器网络Top-k查询,并能够对完整性攻击进行有效检测.利用两层传感器网络中高资源节点的资源和通讯优势,使其承担安全计算第k位数据值任务,减少传感器节点能量消耗,增强SafeTQ有效性和可行性.(2)根据安全性分析,SafeTQ在完成Top-k查询过程中,单元头节点和辅助计算节点不能获得定义1中描述的3类Top-k查询敏感信息;SafeTQ-L检测出破坏完整性攻击的概率高于SafeTQ-N.(3)从真实数据仿真实验结果看,在单元内传感器节点通信量方面,SafeTQ-L、SafeTQ-N通信量比没有隐私保护的Topk-TAG的通信量增加的倍数,远小于文献[1]中使用隐私保护技术的CPDA、SMART通信量比TAG通信量增加的倍数;在单元外通信量方面,在本实验设定的参数范围内,SafeTQ-L、SafeTQ-N和Topk-TAG通信量都小于5000bytes;SafeTQ-N平均通信量高于SafeTQ-L.致谢感谢本文审稿专家和编辑老师所提出的宝贵意见和建议!
