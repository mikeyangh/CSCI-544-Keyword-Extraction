Page1物联网安全传输模型吴振强1)周彦伟2)马建峰3)1)(陕西师范大学计算机科学学院西安710062)2)(陕西师范大学教师专业能力发展中心西安710062)3)(西安电子科技大学计算机网络与信息安全教育部重点实验室西安710071)摘要物联网的安全与隐私对参与方有着较大的影响,需要建立相应的安全框架实现数据保密、访问控制、客户端隐私保护等功能以抵抗复杂攻击.论文利用可信计算技术和双线性对的签密方法提出了一个物联网安全传输模型,满足了物联网的ONS查询及物品信息传输两个环节的安全需求.模型包括了EPC物联网中ONS查询服务的安全体系及相应的安全协议,ONS根服务机构利用可信认证服务器对申请查询的本地ONS服务器(L-ONS)的合法身份及平台可信性进行验证,对通过验证的L-ONS签发临时证书,在证书有效时间内L-ONS可持证书多次申请查询服务.安全ONS查询服务实现了匿名认证功能,仅对授权且可信的L-ONS提供查询服务,阻止了非法ONS查询物品信息;在传输过程中,远程物品信息服务器按响应路径中各节点的顺序从后至前用公钥对物品信息嵌套加密.加密后的数据每经过一个路由节点被解密一层,直到本地信息服务器时物品信息才被还原成明文,传输过程中每个路由节点可以验证收到数据的完整性及转发路径的真实性.分析表明,新的传输模型具有安全性、匿名性、可信性和抗攻击性等特点.关键词物联网;ONS查询;可信计算;匿名认证;匿名传输1引言物联网(InternetofThings,IoT)将感应器嵌入或装备到电网、铁路、桥梁、隧道、公路、建筑、供水系统、大坝、油气管道等物体中,实现物体与现有互联网的融合,实现人类社会、信息空间、物理系统的有机整合.在这个整合的网络中,存在能力超强的中心计算机群,用于对网络内的人员、机器、设备和基础设施实施实时的管理与控制[1].传统EPC(ElectronicProductCode)物联网中,每一个物品都被赋予一个独一无二的代码,将这个代码存储在电子标签中并贴在物品上,同时将这个代码所对应的详细信息和属性存储在物品信息服务系统的服务器中.流通环节中利用RFID阅读器读取标签代码,通过对象名解析服务(ObjectNamingService,ONS)系统解析后,本地ONS(LocalObjectNamingService,L-ONS)服务器可获得物品所属信息服务系统的统一资源标识,然后L-ONS将该标识转发到本地物品信息服务器(LocalInformationServerofThings,L-TIS),进而L-TIS通过网络与远程物品信息服务器(RemoteInformationServerofThings,R-TIS)间的消息交换获得非本地代码所对应的详细物品信息及属性,实现物品的识别、自动追踪和管理功能[2].然而传统物联网在用户隐私保护和信息安全传输机制中存在诸多不足[3-5]:(1)标签被嵌入任何物品,用户在没有察觉的情况下其标签被阅读器扫描,通过对物品的定位可追踪用户的行踪,使个人隐私遭到破坏;(2)射频识别系统读取速度快,通过对物品的迅速扫描方式跟踪企业销售情况的变化特点,使企业的商业秘密遭到泄露;(3)物品的详细信息在L-TIS与R-TIS间的传输过程易受流量分析、窃听、嗅探等网络攻击,导致物品信息传输过程存在安全隐患.针对物联网安全性问题,文献[5]指出应该从容忍攻击方面进行研究,以应对单点故障、数据认证、访问控制和客户端的隐私保护等问题;建议对企业进行必要的风险评估与风险管理.文献[6]提出在考虑物联网的各种安全因素时,隐私保护强度和特定业务需求之间是有折衷,即在满足业务需求(实用性、易用性)基础上尽可能地保护用户隐私、定制适度的隐私保护策略(实现匿名性和用户行为的不可追踪);并指出物联网的安全机制应该从认证、访问控制、数据加密和立法等方面加强保护.文献[7]提出物联网安全研究应主要集中在物联网安全体系、个体隐私保护模式、终端安全功能、物联网安全相关法律的制订等方面,并给出了一个物联网的安全层次架构,该架构根据物联网的感知层、网络层和应用/中间件层将安全架构分为感知层安全、网络层安全和应用层安全.目前的物联网安全方案更多地是从宏观上进行框架性讨论,涉及到物联网相关的感知、信息传输与信息处理三个阶段.在感知阶段:文献[8]在分析RFID协议的安全需求基础上,基于通用可组合安全模型,设计了低成本的RFID匿名认证协议,在确定的安全目标下证明了该协议的安全性;文献[9]分析了基于密码技术RFID安全协议的不足,用可证明安全性理论对RFID安全协议模型进行安全性研究;文献[10]给出了RFID系统中改进的防冲突算法,当大量标签同时识别时,该算法根据上一轮的碰撞情况估计待识别的标签数,然后对其进行分类或改变帧的大小以降低标签发生碰撞的概率,从而提高识别效率.文献[11]在欧盟提案的基础上,制订了信息感知阶段的隐私及数据保护的评估框架.在信息处理阶段:文献[12]基于RFID和物联网技术提出了全球物联网体系架构,并结合该架构给出了物联网信息服务系统的设计方案,为实现物Page3联网架构、信息服务系统和物联网管理协议提供了参考;文献[13-14]系统地介绍了物联网编码、编码转换、名称解析服务、信息发布系统、中间件及网络管理等物联网关键技术,通过大量实例分析了物联网的国内外发展现状,并在此基础上给出了部分设计方案,对物联网的研究起到了指导作用.纵观国内外在物联网基础技术方面的相关研究,文献[3-7]只分析了物联网传输机制中所存在的不足,并未给出相应的解决方案.因此有必要进行物联网安全传输机制研究,尤其是增强传输过程中安全协议与隐私保护方法的研究,以提高物联网的安全性.物联网在信息传输过程中易出现隐私泄露,其主要原因有:(1)阅读器与标签之间的任意读取,即阅读器无条件读取物品标签编码给用户隐私保护带来隐患;(2)ONS查询系统为L-ONS提供无条件查询功能,即任何L-ONS均可申请查询物品的详细信息;(3)物品信息由R-TIS以明文形式传送给L-TIS.本文在分析EPC物联网传输机制的安全性基础上,为解决物联网信息传输过程中隐私保护方面所存在的不足,综合可信计算技术与双线性对的签物联网安全传输模型由可信匿名认证的ONS查询机制和物品信息可信匿名传输机制组成,其中图1物联网安全传输模型密方法提出了一个物联网安全传输模型.本文创新性的工作是给出了物联网安全传输模型的框架,并对安全传输框架下涉及的ONS安全查询过程、物品信息安全传输过程进行了协议设计与实现.本文第2节详细介绍物联网安全传输模型,对可信匿名认证的ONS查询机制和物品信息可信匿名传输机制分别进行研究;第3节对物联网安全传输模型的匿名性、可信性和安全性等方面进行分析;第4节给出了基于本模型的安全物联网系统架构;最后总结展望了本文工作.2物联网安全传输模型本文提出的物联网安全传输模型是通过引入可信第三方———可信认证服务器(TrustedAuthen-ticationServer,TAS)对原有模型进行改进:在ONS查询机制中增加可信匿名认证过程对L-ONS的身份合法性及平台可信性进行认证;物品信息可信匿名传输机制确保物品信息的安全传输,保证了物联网中物品信息的安全性与可信性.物联网安全传输模型如图1所示.TAS在注册阶段为L-ONS生成查询系统的用户名,同时为其生成临时身份信息,完成对L-ONS的Page4身份合法性及平台可信性认证;在物品信息可信匿名传输机制中R-TIS按响应链路中各节点顺序从后至前用相邻节点的会话密钥对查询信息层层嵌套加密,传输过程中,响应数据每经过一个节点被解密一层,直到L-TIS时数据才被完全解密,且中间节点可根据前驱节点的签密信息验证转发数据的完整性,根据路由信息鉴别转发路径的真实性.2.1系统建立设G1和G2是阶为素数q的群,G1为加法群,G2为乘法群,p为G1的生成元,设群G1和G2中离散对数问题是困难的,双线性对是满足下列性质的映射e:G1×G1→G2.TAS选择满足双线性对要求的参数G1、G2、e、q、p,其中q、p为G1的生成元.E(k,m)和D(k,c)是一对单密钥加密/解密算法;P是大素数;Q是P-1的大素数因子;g是从[1,…,P-1]随机选取的模P的Q阶随机整数;H(k,m)是带密钥的杂凑函数;H(m)为标准散列算法SHA-1,∈C表示随机均匀选取集合中的元素,为异或运算,‖为连接符.TAS公开参数〈G1,G2,e,q,p,H,P,Q,g〉及加密/解密函数E和D.假设1.根ONS服务器(RootObjectNamingService,Root-ONS)与TAS都具有物联网管理中心CA-IoT签署的公钥证书.如实体A的证书格式图2可信匿名认证的ONS查询机制2.2.1L-ONS注册查询服务合法性及平台可信性认证.L-ONS向TAS申请注册查询服务,完成身份(1)L-ONS向TAS发送注册申请;(2)TAS基于平台可信性验证策略[15]认证L-ONS平台的可信性,为身份合法且平台可信的L-ONS分配唯一的临时标识号TIDL-ONS,由式(1)如下:CertA={IDA,KPA,DateA,LFA,其中KPA是A的公钥,KPrivCA-IoT是CA-IoT的私钥,DateA是证书的签署日期,LFA是证书的有效期,则Root-ONS、L-ONS和TAS的密钥对分别为{KPRoot-ONS,KSRoot-ONS}、{KPL-ONS,KSL-ONS}和{KPTAS,KSTAS}.假设2.可信匿名认证机制和可信匿名传输机制中随机数的产生、加密/解密、Hash运算等操作均可由可信平台模块(TrustedPlatformModule,TPM)完成.假设3.R-TIS基于可信计算技术构建物品信息传输链路的安全性和可信性,且每个节点有密钥协商、数据转发和加密/解密等操作能力.假设4.物品信息传输链路中节点Ri的签密私钥为SKi∈C[1,Q-1],其公钥PKi=gSKimodP.假设5.L-ONS、Root-ONS、TAS及CA-IoT间有时钟同步机制可确保本模型中消息时戳的新鲜性.2.2可信匿名认证的ONS查询机制在查询机制中,Root-ONS在TAS的协助下对L-ONS的身份合法性及平台可信性进行认证,详细查询工作流程如图2所示.计算产生秘密数SL-ONS,即NumTAS为TAS随机选取的大数.用式(2)计算L-ONS的临时身份TIDL-ONS,即TAS为L-ONS建立账户〈IDL-ONS,SL-ONS,TIDL-ONS,NumTAS〉,将SL-ONS和TIDL-ONS交由L-ONSPage5安全存储[16].2.2.2L-ONS申请查询服务L-ONS注册成功后即向Root-ONS申请查询服务,以获知相关R-TIS的网络地址.具体申请过程如图3所示:(1)L-ONS生成随机数X0∈[1,q-1],同时读图3L-ONS向Root-ONS申请查询服务L-ONS生成自身的完整性度量信息L-ONSTPM=E(key,s‖SML)后,将TIDL-ONS,L-ONSTPM及时戳TL-ONS连同签名信息SigL-ONS一起发给Root-ONS,其中SigL-ONS=H(KSL-ONS,TIDL-ONS‖L-ONSTPM‖TL-ONS).(2)Root-ONS验证L-ONS签名的真实性及时戳的有效性,以防范重放攻击,若验证无效,则拒绝为其提供查询服务,否则将选择随机数Nonce,并生成消息签名SigRoot-ONS=H(KSRoot-ONS,TIDL-ONS‖TRoot-ONS‖Nonce‖L-ONSTPM‖CertRoot-ONS).Root-ONS发送消息TIDL-ONS,Nonce,L-ONSTPM,SigRoot-ONS,CertRoot-ONS,TRoot-ONS给TAS.(3)TAS验证Root-ONS身份证书、消息签名及时戳的有效性,若无效则终止执行并退出认证机制,否则TAS按式(4)验证L-ONS的身份标识是否合法,即IDL-ONS=TIDL-ONSH(IDL-ONS‖NumTAS)IDTAS若L-ONS是非法用户,TAS终止操作;否则计算密钥key,解密L-ONSTPM获知度量PCR值及秘密随机数X0,结合SML及PCR值对L-ONS平台可信性进行验证,若验证不通过,TAS终止操作;否则发送Result,Nonce,E(KPRoot-ONS,X0),TTAS,CertTAS,SigTAS给Root-ONS,其中SigTAS=H(KSTAS,Result‖Nonce‖E(KPRoot-ONS,X0)‖TTAS‖CertTAS).(4)Root-ONS验证TAS身份证书的真实性、时戳的有效性,若无效,则中止执行,否则根据相关信息确认L-ONS的身份合法性与平台可信性,仅为取当前平台配置寄存器(PlatformConfigurationRegister,PCR)的值,用私钥KSL-ONS对其加密,得s=E(KSL-ONS,PCR‖X0),读出度量日志SML,并用式(3)计算临时密钥key.身份合法且平台可信的L-ONS签发成员证书TCertL-ONS.Root-ONS解密E(KPRoot-ONS,X0),计算k=X0,并产生随机数N0,将消息E(k,N0‖TCertL-ONS)、SigRoot-ONS发送给L-ONS.(5)L-ONS获得TCertL-ONS和N0,并将标签编码、时戳、随机数和签名信息发给Root-ONS.(6)Root-ONS根据收到的标签编码将对应R-TIS的网络地址与时戳、随机数和消息签名发给L-ONS,即完成双方间身份合法性及平台可信性验证.2.2.3L-ONS持成员证书申请查询服务当L-ONS获得TCertL-ONS后,在有效期内可持其向Root-ONS多次申请查询服务,申请过程如图4所示.(1)L-ONS再次申请查询时,生成随机数Xi∈C[1,q-1],并计算本次查询申请的临时身份TIDL-ONSi,即Page6其中TIDL-ONS0=TIDL-ONS,i=1,2,3,…,n,用式(6)计算本轮会话密钥ki,其中k0=k,i=1,2,3,…,n.L-ONS计算E(ki,TCertL-ONS‖Xi)和SigL-ONSi,读取当前时戳TL-ONSi,发送消息SigL-ONSi,TIDL-ONSi,E(ki,TCertL-ONS‖Xi),TL-ONSi给Root-ONS.(2)Root-ONS验证时戳和TIDL-ONSi是否有效,若无效则拒绝为L-ONS提供服务,否则计算ki,并解密E(ki,TCertL-ONS‖Xi),验证消息的完整性,同时验证TCertL-ONS的合法性,若合法则保存Xi.Root-ONS产生随机数Ni,计算消息签名SigRoot-ONSi后发送消息SigRoot-ONSi,TRoot-ONSi,E(ki,Ni)给L-ONS.(3)L-ONS将标签编码、时戳、消息签名连同随机数一起发送给Root-ONS.(4)Root-ONS根据收到的标签编码,将对应R-TIS的网络地址连同时戳、随机数和消息签名一同发送给L-ONS.2.2.4成员证书(1)证书结构过频的申请查询服务,不仅增加L-ONS的完整性度量负载,同时降低了查询系统的工作效率.本文使用证书机制减少L-ONS的可信性评估次数,提高查询系统的工作效率,证书的基本信息有:①有效图5查询响应路径示意图如图6所示,算法1中R-TIS根据链路中各节点顺序对物品信息依次进行嵌套加密封装,对封装的通信数据进行签密操作后产生查询响应信息Message,节点R1收到消息Message后通过算法2(如图7所示)进行消息转发,依此类推,链路中其它节点重复执行算法2,直至L-TIS.节点Rj收到节点Rj-1发送的查询响应消息Message后,根据算法2对其进行转发,首先通过签密信息验证转发数据的完整性,根据路由信息鉴别转发路径的真实性.然后将未被篡改的数据消息重新封装后转发到下一节点Rj+1,在数据包封装过程中,节点Rj可在Message尾部填充任意字符,并对转发数据进行签密操作,确保通信数据及通信路径的真实性,即R-TIS生成的响应数据Message在节期:证书的有效时间;②颁发时间:证书的颁发时间;③授权对象:证书拥有者临时身份信息TIDL-ONS;④签名:Root-ONS的签名信息.(2)证书合法性验证在成员证书的有效期内,L-ONS持该证书可多次申请查询服务,通过下述步骤验证成员证书的真实性,以判断L-ONS的身份合法性及平台可信性.①通过签名信息验证颁发者身份,同时检查证书内容是否被篡改;②根据证书的有效期、颁发时间等信息验证证③计算TIDL-ONS=TIDL-ONSiNi-1Ni-2…N0,验证TIDL-ONS=TIDL-ONS是否成立,验证持有者是否是证书的申请者.若上述验证均通过,表明L-ONS持有真实有效书在当前时间是否有效;的合法成员证书.2.3物品信息可信匿名传输机制L-TIS通过L-ONS的查询机制获得相关R-TIS的网络地址,通过与R-TIS间的信息交互L-TIS可获知相关物品的详细信息.本文设计的物品信息可信匿名传输机制实现L-TIS与R-TIS间物品信息的安全传输.R-TIS用合法且可信的中继节点建立如图5所示的物品信息传输链路,与各节点协商会话密钥,并获知各节点的身份Hash值.点间转发过程中大小不变,防止窃听者根据数据包的大小关系进行流量分析、窃听等攻击.链路中的每个节点通过如图7所示的算法2根据消息验证数据的完整性及转发路径的真实性,将完整且真实的数据重新封装后转发给下一节点,直至目标L-TIS.3物联网安全传输模型分析本节从安全性、可信性、匿名性等方面对物联网安全传输模型进行分析.3.1可信匿名认证的ONS查询机制在L-ONS申请查询服务时,Root-ONS在TAS的协助下对L-ONS的身份合法性及平台可信性进Page7算法1.R-TIS响应消息Message初始化算法.输入:①R-TIS、L-TIS及网络节点集合{R-TIS(R0),R1,R2,R3,…,Rn,L-TIS(Rn+1)}Node;输出:Message=E(KD(R-TIS,R1),H(IDR1)‖ST‖SP‖SQ‖TR-TIS‖H(IDR-TIS)‖FR0‖w‖z‖INF)Begin1.AddtheRjintothepathofresponse,OnlyiftheRjisatrusted/计算R-TIS与各节点的会话密钥k(R-TIS,Ri)/2.Form=1tom=nk(R-TIS,Rm)=e(qH(IDR-TIS),H(IDRm));EndFor;3.k(R-TIS,L-TIS)=e(qH(IDR-TIS),H(IDL-TIS));/封装查询响应数据,其中IPm为节点Rm的IP地址,Information4.Data=E{k(R-TIS,L-TIS),Information};5.Data=E{k(R-TIS,Rn),IPL-TIS‖Data};6.Form=n-1tom=1为物品的详细信息/Data=E{k(R-TIS,Rm),IPRm+1‖Data};EndFor;/计算各节点的路由鉴别信息/7.JR1=H(IDR-TIS)H(IDR1)H(IDR2);8.Form=1tom=n-1JRm+1=H(IDRm)H(IDRm+1)H(IDRm+2);EndFor;9.JRn+1=H(IDRn)H(IDL-TIS)H(IDR-TIS);10.Initial(ST);11.Form=n+1tom=1EndFor;13.FR0=H(IDR-TIS);14.LR0=H(FR0);图6响应消息初始化算法算法2.节点Rj转发来自Rj-1的响应消息Message.输入:Message=E(KD(Rj-1,Rj),H(IDRj)‖ST‖SP‖SQ‖H(IDRj-1)‖FRj-1‖TRj-1‖w‖z‖INF)输出:Message=E(KD(Rj,Rj+1),H(IDRj+1)‖ST‖SP‖SQ‖H(IDRj)‖FRj‖TRj‖w‖z‖INF)elsestopandsenderrormessage;BeginEndIf;/验证转发数据的完整性/1.Key1=(gPKw2.Key2=H(KeySKj1modP);3.Data=D(Key2,INF);4.IfH(Key1,INF)==wthengoto5;elsestopandsenderrormessage;Endif/鉴别转发路径的真实性/5.KD(Rj-1,Rj)=H(IDRj-1)H(IDRj);6.UseKD(Rj-1,Rj)decryptionMessage;7.RjgettheY=H(IDRj)fromtheMessage;/Rj检查H(IDRj)与自身计算的是否相等/8.RjcheckH(IDRj)withtheY=H(IDRj)whichdecryptionfromMessage;9.Ifthecheckpassesthengoto10;elsestopandsenderrormessage;EndIf;10.LRj=SP.Get();11.SP=SP.POP();12.FRj=FRj-1H(IDj);13.If(LRj==H(FRj))图7响应消息节点转发算法15.Form=0tom=n-1FRm+1=FRmH(IDRm+1);LRm+1=H(FRm+1);EndFor;16.FRn+1=FRnH(IDL-TIS);17.LRn+1=H(FRn+1);18.Initial(SP);19.Form=n+1tom=1SP.Push(LRm);EndFor;20.KD(R-TIS,R1)=H(IDR-TIS)H(IDR1);21.Initial(SQ);22.SQ.Push(PKL-TIS);23.Fori=ntom=2SQ.Push(PKRi);EndFor;24.Num∈C[1,Q-1];25.Key1=gNummodP;26.Key2=H(PKNum1modP);27.INF=E(Key2,Data);28.w=H(Key1,INF);29.z=Num(1+wSK0)-1modQ;30.R-TIS(R0)generatedtimestampisTR-TIS;31.Message=E(KD(R-TIS,R1),H(IDR1)‖ST‖SP‖SQ‖32.R-TIS(R0)SendMessagetoR1;End14.JRj=ST.Get();15.ST=ST.Pop();16.H(IDRj+1)=H(IDRj-1)H(IDRj)JRj;17.K(R-TIS,Rj-1)=e(qH(IDR-TIS),H(IDRj-1));18.RjuseK(R-TIS,Rj-1)decryptiontheData;19.Data=D(K(R-TIS,Rj-1),Data);20.Num∈C[1,Q-1];21.PKRj+1=SQ.Get();22.SQ=SQ.Pop();23.Key1=gNummodP;24.Key2=H(PKNum25.INF=E(Key2,Data);26.w=H(Key1,INF);27.z=Num(1+wSKj)-1modq;28.RjgettheIPofRj+1fromtheData;29.KD(Rj,Rj+1)=H(IDRj)H(IDRj+1);30.RjgeneratedtimestampisTRj;31.Message=E(KD(Rj,Rj+1),H(IDRj+1)‖ST‖SP‖32.RjSendMessagetoRj+1;EndPage8行验证,防止非授权L-ONS的查询申请,增强了物联网查询机制的可靠性、安全性及可信性.3.1.1安全性分析认证机制的安全性是基于求解离散对数的困难性.L-ONS利用秘密数SL-ONS和时戳通过散列函数计算临时密钥ki,由SL-ONS的机密性和散列函数的安全性保证ki的不可伪造性,时戳保证了ki的新鲜性.TAS检查时戳的新鲜性后,计算L-ONS的身份标识验证其合法性,同时结合完整性度量日志及PCR值验证L-ONS平台的可信性,即Root-ONS在TAS的协助下完成对L-ONS的身份合法性及平台可信性验证.其中消息散列运算保证了消息的完整性,并且随机数可防止重放攻击.L-ONS再次申请服务时,其成员证书可证明身份的合法性及平台的可信性,并且每次均产生不同的会话密钥ki,实现了一次一密,增强了安全性.由于Xi由L-ONS选择计算,而Ni由Root-ONS选择计算,因此ki是一次性密钥,且任何一方无法单独计算产生,保证了会话密钥的公正性、新鲜性及前向保密性.可信匿名ONS查询协议的安全性达到了通用可组合安全(UC安全)等级,详细的证明过程请参见附录.3.1.2匿名性分析(1)查询机制的匿名性和不可追踪性通信消息中均未出现L-ONS的真实身份,注册时L-ONS的真实身份IDL-ONS被临时身份TIDL-ONS替代.因仅有TAS掌握秘密数NumTAS,所以只有TAS才能通过式(2)正确验证用户的真实身份IDL-ONS,确保L-ONS身份的匿名性.不同的L-ONS对应不同的TIDL-ONS且由互不相同的随机数NumTAS计算产生,并且任何合法L-ONS均无法通过自己的TIDL-ONS计算其它ONS服务器的ID号,当同一L-ONS多次向Root-ONS申请查询时,每次均使用不同的临时身份TIDL-ONS,具有不可跟踪性.(2)证书的匿名性成员证书仅报告持有者身份是否合法、平台是否可信,未包含其配置信息及其身份信息,即成员证书具有匿名性,匿名性的强弱取决于有效授权时间的长短,越短则匿名性越强,同时其匿名性是可控的,可控性依赖于证书持有者的临时身份信息,在有效期内仅允许同一用户用该证书建立查询服务.3.1.3可信性TAS对L-ONS配置信息的安全存储,保证了对L-ONS进行平台可信性验证的同时,有效保护了平台信息的私密性,即使L-ONS的配置信息遭泄露,但L-ONS可信性验证信息是经过密钥ki加密处理的,由于ki的保密性,避免Root-ONS依平台配置信息推知L-ONS的平台身份及配置状况.L-ONS通过向TAS提供签名后的平台PCR值及度量日志SML来证明平台的完整性.L-ONS以硬件TPM为起点将可信性由底层通过信任链技术传递至应用层,即TAS根据完整性度量值及度量日志等信息鉴别L-ONS平台的可信性.3.2物品信息可信匿名传输机制R-TIS将物品信息按链路节点顺序从后至前嵌套加密,传输过程中加密后的数据每经过一个节点被解密一层,到L-TIS时数据才被完全解密,并且链路中各节点可根据前驱节点的签密信息验证数据的完整性,根据签名及路由信息鉴别链路的真实性,增强了物品信息传输过程的安全性.3.2.1匿名性分析匿名通信链路中各节点仅知其前驱和后继节点的身份Hash值.节点Rj+1用前驱节点Rj的H(IDRj)、自己的H(IDRj+1)和路由鉴别信息JRj+1进行运算后仅得到后继节点Rj+2的H(IDRj+2),无法获知其它节点的身份信息,即保证了R-TIS和L-TIS身份的匿名性;每个节点通过计算仅能获知相邻节点的网络地址,无法获知其它节点的地址信息,即保证了R-TIS和L-TIS位置的匿名性.匿名链路的路由鉴别信息、通信数据及地址信息只有合法的后继节点才能正确解密,保证了R-TIS和L-TIS通信的匿名性.3.2.2匿名度仿真Reiter和Rubin[17]提出针对共谋攻击的匿名度分析方法,攻击者由多个恶意节点组成,每个恶意节点占据了不同的位置.从攻击者而言,发送者是位于第1个恶意节点之前的;接收者是位于最后1个恶意节点之后.本文研究的物品信息传输机制由非恶意者发起,同时接收者也为非恶意者.假设物品信息匿名传输链路的长度为n,其中有c个恶意节点,则转发节点是有效节点的概率p为p=1-cn+1号位置,信息传输机制的匿名度为d.Hx(1xn-c)表示第1个恶意节点是链路的第x个节点;Hx+表示第1个恶意节点在第x个Page9节点及之前的事件;p(x)表示链路中第1个恶意节点在第x个节点的概率,I表示事件第1个恶意节点猜中发送者身份,则p(I|H1+)表示恶意节点正确推断出消息发送者的概率,即为发送者匿名度.第1个恶意节点在链路中第x个位置的概率p(Hx)为p(Hx)=p(x-1)(1-p);第1个恶意节点出现在链路中第1个位置及之后的概率p(H1+)为p(H1+)=(1-p)∑n-c当第1个恶意节点是链路的第1个节点时,它的前驱节点即为发送者,恶意节点猜中发送者的概率为1,即p(I|H1)=1;第1个恶意节点在第2个节点或在其之前,它的前驱不可能是发送者,即其猜中发送者的概率为0,即p(I|H2+)=0.p(I|H2+),因为p(I)=p(H1)·p(I|H1)+p(H2)·又因为p(I)=p(H1+)·p(I|H1+),所以p(I|H1+)=1-pMx(cxn)表示最后1个恶意节点是链路的第x个节点;Mx-表示最后1个恶意节点在第x个节点及之后的事件;Q(x)表示链路中最后1个恶意节点是第x个节点的概率,R表示事件最后1个恶意节点猜中接收者身份,则Q(R|Mn-)表示恶意节点正确推断出消息接收者的概率,即为接收者匿名度.最后1个恶意节点是链路第x个节点的概率Q(Hx)为Q(Mx)=(1-p)p(n-x);最后1个恶意节点是链路中第n号位及以后的概率Q(Mn-)为Q(Mn-)=(1-p)∑n当最后1个恶意节点是转发路径的第n个节点时,它的后继节点即为接收者,恶意节点猜中接收者的概率为1,即Q(R|Mn)=1;最后1个恶意节点是第n-1个节点或在其之后时,它的后继节点不可能是发送者,恶意节点猜中接收者的概率为0,即Q(R|M(n-1)-)=0.因为Q(R)=Q(Mn)·Q(R|Mn)+Q(M(n-1))·Q(R|M(n-1)-),又因为Q(R)=Q(Mn-)·Q(R|Mn-),所以Q(R|Mn-)=1-p综上所述,匿名度d=P(I|H1+)·Q(R|Mn-)=(1-p)2仿真表明,匿名度随n和p的增大而减小,受p的影响较大(如图8所示).当n10,p0.4时匿名度大小趋近于0,接近绝对匿名的等级,且此时匿名度大小不受节点数影响(如图9所示).这种结果与现实情况基本一致,说明物品信息可信匿名传输机制具有较强的匿名性.3.2.3安全性分析安全性是建立在求解双线性难解问题的基础之上.当窃听者获得节点的公钥H(IDRi)时,因大素数q的保密性而无法求解节点私钥qH(IDRi).即使当窃听者捕获了节点Ri,获得节点的公钥和私钥对,因面临求解双线性难解问题而使窃听者无法求解出q,因此即使捕获了一些节点,但其它节点的安全性不受其影响.(1)抗被动攻击.若窃听者捕获到节点Ri-1的H(IDR(i-1)),由于没有当前节点Ri的H(IDRi),而无法计算共享密钥,从而不能正确解密路由信息,因此仅有合法的路由节点才能得到正确的路由信息;同时响应路径中各节点的填充机制使通信数据包大小不变,方案可抵抗流量分析等攻击.(2)抗主动攻击.若窃听者捕获Ri与Ri-1间的共享密钥,窃听者仅能获得Ri+1的H(IDRi+1),并不能获得其它路由节点的任何信息.假设窃听者希望跳过节点Ri+1并把下一节点设为Rk,当节点Rk收Page10到路由信息后根据算法2取出堆栈SP的栈顶元素LRi+1=SP.Get(),计算FRk=FRk-1H(IDRk)后,显然LRi+1!=H(FRk),则Rk拒绝转发数据,保证了数据转发链路的真实性.(3)信息的极小量泄露.链路中各节点仅知晓其前驱节点和后继节点的假名信息及网络地址,无法获知其它节点及L-TIS与R-TIS的相关信息.(4)路由的可鉴别性.链路中的各节点均能确认它是链路的一部分,并且每个节点都可确认数据信息来源的真实性.(5)响应数据的可验证性.链路中各节点均能通过前驱节点的签密信息验证转发数据的真实性,且只有合法的后继节点才能解密前驱节点的签密信息.3.2.4可信性分析链路建立阶段对各节点的可信性使用相关策略[15]进行验证,只有通过可信性验证的节点才能接入,增强了链路的可信性,物品信息传输过程中,建立了以TPM为核心的节点安全保护机制,以及节点接入时的可信性验证机制,确保物联网安全传输模型中查询响应链路的可信性,增强了物品信息传输过程的安全性.3.3安全传输模型效率分析物联网安全传输模型中的部分运算(如加密/解密、生成随机数、散列运算等)是由TPM完成,不消耗平台CPU的计算能力,TPM作为独立的计算单图10物联网安全体系架构元,可以提高物联网安全传输模型中协议的执行效率.身份合法且平台可信的L-ONS申请成员证书后可持其多次申请查询服务,证书机制的使用提高了物联网安全传输模型的工作效率,同时有效减少L-ONS的完整性度量负载,防止Root-ONS和TAS成为系统瓶颈.查询机制中第一轮交互即对L-ONS的身份合法性和平台可信性进行验证,若验证未通过,TAS和Root-ONS在第一轮后就终止交互,降低了传输模型的执行负载.4物联网安全体系架构基于本传输模型的物联网安全体系架构如图10所示,其中物联网管理中心CA-IoT是一级管理中心,制定和发布总体标准,并对第二级的各地区的Root-ONS和TAS进行管理(Root-ONS和TAS可由物理环境中同一台服务器实现,可合称为TRoot-ONS);第二级为相关地区的TRoot-ONS,负责验证本地区L-ONS身份合法性和平台可信性,响应查询服务,同时可备份本地区TIS中相关物品的信息;第三级为本地物联网系统,负责物品标签编码的读取、处理、发送和申请查询服务等操作.TRoot-ONS加入安全物联网系统时,CA-IoT对其身份合法性及平台可信性进行验证,仅对通过验证的TRoot-Page11ONS颁发身份证书,同时CA-IoT定期对系统成员进身份合法性和平台可信性验证,将属性发生变化的成员移出系统,确保物联网ONS查询系统的可信性,同时各地区TRoot-ONS形成分布式查询系统,来受理L-ONS查询申请.本文物联网安全体系架构除安全性、高效性、可信性和匿名性等特点外,其还具有扩展性好、健壮性高和前向安全的特点.(1)扩展性好当某地区需部署新的查询系统时,新成员只需向CA-IoT申请注册,CA-IoT为身份合法且平台可信的新成员颁发身份证书,在CA-IoT的协助下系统成员更新相关成员信息,使各成员形成相互协作的整体.(2)健壮性高本文的安全物联网中采用分布式的查询体系,即各地区TRoot-ONS相互协作完成L-ONS的查询服务,这种任务分级处理的查询体系可有效防止个别TRoot-ONS由于负载过重而成为系统瓶颈,同时物品信息的区域备份机制可保证在相关TIS无法正常工作时,物品信息机制可顺利进行.(3)前向安全性假设L-ONS的第i次查询申请密钥ki泄露,即攻击者获悉信息Xi-1和Ni-1,但是攻击者无法从信息Xi-1和Ni-1推导出密钥ki+1与ki-1,保证了物联网安全体系模型中查询系统的前向安全性.5结束语本文提出物联网安全传输模型,该模型对传统物联网中ONS查询机制及物品信息传输过程进行改进.在ONS查询机制中加入匿名认证过程,仅为经过授权且可信的L-ONS提供查询服务,防止非授权L-ONS查询物品信息;采用可信匿名通信过程完成物品详细信息的传输,增强物品信息传输过程的安全性,防止攻击者对其进行流量分析、窃听等网络攻击行为.分析表明,物联网安全传输模型具有安全性、匿名性、可信性、高效性和抗攻击性等特点;本文的物联网安全体系架构具有扩展性好、健壮性高和前向安全的特点.本模型的创新点是提出了一个传输模型框架,且给出了可行的协议实现方案.本模型中L-ONS和R-ONS是对称的,在实际应用中可以将两个功能合并在同一个本地网络之中,以实现本地网络请求服务与远程网络的响应服务功能.
