Page1基于对称性理论的医学图像多阶段分类算法1)(哈尔滨工程大学计算机科学与技术学院哈尔滨150001)2)(香港城市大学计算机科学与技术系香港)摘要利用影像归档和通信系统收集的大量医学CT图像被广泛应用于临床诊断,从中提取的ROI区域和ROI区域的特征可以用来对医学CT图像进行分类,从而辅助医生提高诊断精度.医学图像的成像结果显示一张医学图像关于中垂线两侧近似对称.基于这一脑部医学领域知识的指导,文中提出了基于对称性理论的医学图像多阶段分类(Multi-StageClassification,MSC)方法.首先,文中提出了弱对称性和强对称性的定义,从不同粒度对医学图像的对称性进行了描述;然后,给出了基于灰度直方图相交性的弱对称性判定算法,对医学图像在较粗粒度上进行了第1阶段的分类;接着,提出了基于点对称的强对称性判定算法,结合弱对称性判定算法,对第1阶段分类结果为异常的图像进行了更细粒度的第2阶段分类,定位了病变区域的位置;最后,利用对病变区域所提取的特征,对病变区域进行了第3阶段的分类,以达到辅助医生诊断的效果.实验结果表明,基于对称性理论的医学图像多阶段分类方法提高了医学图像分类的准确度,同时减少了医生诊断决策的时间.关键词医学图像;弱对称性;强对称性;多阶段分类1引言由于医学图像中蕴含着丰富的图像和医学信息,近年来面向医学图像的数据挖掘技术成为医学和计算机交叉学科研究的热点.随着医疗数字化设备的快速发展,医学信息数据库被广泛使用.病人的结构化文本信息以及大量的非结构化医学图像信息,为医学图像的数据挖掘提供了丰富的数据资源.医学图像可以有效地辅助医师在诊断过程中对病理变化区域进行检测、定位以及判断它的良恶性,因此被广泛应用于临床诊断过程中.人体的对称性不但体现在外形上,而且在身体器官和人体组织成像上也体现出近似的对称性.如果某一个人的某种器官与其他人的相同器官进行对比,表现出更不对称的结构,那么就认为这是一种病理学的症状.因此在医学诊断和临床应用中,对称性理论有很重要的价值,即通过观察医学图像的对称性可以辅助医生诊断和决策.然而,具有不同知识背景的医生即使对同一张医学图像也可能存在不同的判断.所以,运用数据挖掘方法研究医学图像分类算法,对辅助医生根据医学图像进行诊断,提高其效率和精度,具有较高的学术价值和实际应用前景.目前,国内外在医学图像分类研究方面,常用的分类方法有神经网络、朴素贝叶斯、遗传算法和决策树算法等.Chen等人[1]利用贝叶斯分类器对多类文本数据集进行分类,该分类方法对特征选择高度敏感.Yang等人[2]利用贝叶斯随机变量选择方法对大量的基因数据进行分类.Osmar等人[3]在乳腺癌分类研究中应用了神经网络和关联规则挖掘技术.Mitsuru等人[4]提出了应用逻辑回归算法提取关联规则,挖掘出脑部功能与手指活动和肢体行为之间的关系.Rajendran等人[5]基于决策树使用关联规则挖掘算法的混合医学图像分类,从脑图像中挖掘频繁模式,基于这些频繁模式将脑图像进行分类.Al-Hadidi等人[6]提出一个基于神经网络的改进技术混合人工神经网络方法来分离乳腺癌,模拟结果表明混合人工神经网络技术有很高的灵敏度和特异性,但神经网络分类器的分类结果是在训练时间上将比其他分类器消耗更多的时间[7].Qurat-Ul-Ain等人[8]应用纹理的灰度共生矩阵将脑肿瘤进行分割和分类.Saha等人[9]利用模糊对称性对磁共振脑图像进行分割和聚类.Fallahi等人[10]将形态学的方法应用到分类特征的提取上(SVMwithMorphologicaloperations,SVM-MPO),将脑部CT图像分为两类:正常和异常,并与很多现有的分类方法做了分类准确率的对比.Saha等人[11]应用快速边界盒方法(FastBoundingBox,FBB)定位MRI中肿瘤和水肿的位置.Nanthagopal等人[12]利用二级小波纹理图像(WaveletStatisticalTexturefeature,WST)提取游程矩阵和灰度共生矩阵共6个特征作为将肿瘤分类为良恶性的特征.本文提出了基于对称性理论的医学图像多阶段分类(Multi-StageClassification,MSC)方法.首先,本文提出了弱对称性和强对称性的定义,从不同粒度对医学图像的对称性进行了描述;然后,给出了基于灰度直方图相交性的弱对称性判定算法,对医学图像在较粗粒度上进行了第1阶段的分类;接着,提出了基于点对称的强对称性判定算法,结合弱对称性判定算法,对第1阶段分类结果为异常的图像进行了更细粒度的第2阶段分类,定位了病变区域的位置;最后,利用对病变区域所提取的特征,对病变区域进行了第3阶段的分类,以达到辅助医生诊断的效果.实验结果表明,基于对称性理论的医学图像多阶段分类方法提高了医学图像分类的准确度,同时减少了医生诊断决策的时间.本文第2节为医学图像的预处理过程;第3节介绍本文的基本概念:弱对称性和强对称性等;第4节提出弱对称性判定算法和强对称性判定算法;第5节医学脑部CT图像多阶段分类器的构造;第6节实验结果分析;第7节总结本文.2预处理过程通过对大量脑部CT图像的观察得知,脑部CT图像具有以下特点:CT图像是由一定数目由黑到白不同灰度的像素按矩阵排列所构成;健康脑部图像的左右两侧灰度值分布近似相似;相似图像在相Page3近位置具有相似的纹理信息.图1(a)是一张原始的脑部CT图像,医生在根据脑部CT图像做诊断的过程中,往往认为图像中较暗和较亮区域的变化是最为重要的.根据这一医学领域知识,本文给予这些区域更多的关注.假设一张脑部CT图像M包含m×n个像素点,M(i,j)是图像M位于坐标(i,j)的像素点的灰度值.M(i,j)的值越小,表示图像M位于坐标(i,j)的灰度值越小(即越黑),也就表明位置(i,j)在图像M中更为重要.本文借鉴了本组内的医学图像的分级纹理提取算法[13].以图1中的图像为例,图1(a)是原始脑部CT图像,首先提取图1(a)的ROI区域得到图1(b),从而去除脑部CT图像中无用或干扰区域.然后通过计算ROI区域的灰度直方图的波峰、波谷自动得到分级数组par[k].按照k层分级数组使用canny算法[14]得到的分级纹理图像.图1(c)是经过校正[15]的分级纹理图像.最后,为了便于后续的建模和分类过程,将该分级纹理图像规范化为统一大小Column×Row的规范化大小纹理图像,如图1(d)所示.根据对原始图像数据集规格的统计,本文采用Column=160,Row=150.Pan等人[16]提出了一种基于脑部CT图像的纹理特征的不确定定点图的模型.一个不确定定点图(UncertainLocationGraph,ULG)是一个五元组N=(V,E,U,P,Q),其中V是顶点集,E属于V×V的边集,U:V→{1,2,3,…,n}为顶点分配标签函数,P:V→[0,1]是点的重要性指数函数,Q={Q(1),Q(2),…,Q(m)}是V的一个划分,其中Q(i)是V的真子集.在ULG中,点V(i)∈V的位置(x,y)具有不确定性,且其不确定性依赖于P(V(i)).当一个点对于整个图较为重要时(即若该点移动,则会严重影响原图),那么该点具有较高的P(V(i)).当一个点不重要时(即使它有较大的移动也不会对原图构成影响)这样的点具有较低的P(V(i)).因为点的重要性与点的可移动性成反比,所以,Quddus等人[17]定义点的可移动性半径mob如下:人类大脑可以分为两个半球,两侧具有近似对称性,在一侧的大多数结构相应的在另一侧相近位置存在相似结构.Ruppert等人[18]通过实验证明在MRI中,MRI图像切片的对称轴即为纵向裂缝的位置,由于肿瘤的存在,大脑的一侧受到压缩,使裂缝发生弯曲但不会影响到中垂线的选取[19].Tuzikov等人[20]应用块匹配算法和最小二乘法找出MR图像的中垂线,大量实验结果证明纵向裂缝的位置可以定义为中垂线.通过对大量健康脑CT图像的观察,近似中垂线位置的定义可以应用Ruppert和Tuzikov等人提出的方法.视觉上左右半球可以由纵向裂缝分割,纵向裂缝是充满脑髓脊液的脑干形成的.因此分离图像为左右两侧可以通过沿裂缝定义一个中垂线.事实上,纵向裂缝通常是弯曲的,主要是因为脑部肿瘤的存在,但定位近似中垂线足够可以标记出肿瘤和不对称性[21-22].如图2所示,其中图2(a)是脑部ROI区域,图2(b)是图2(a)的规范化后的纹理图像,图2(c)是图2(a)的关于中垂线对称分割后的图像,图2(d)是图2(b)的关于中垂线对称分割后的图像.3基本概念根据医学脑部CT图像的特征可知,正常脑部CT图像中存在的结构关于对称轴是近似对称的,经过预处理后得到的纹理图像显示的纹理信息也是Page4近似对称的[23].如果脑部CT图像发生病变,那么就会引起这种近似对称结构的改变,由于病变区域的存在使其内部结构存在不对称性[24].本文给出医学图像的定义,结合医学图像的定义提出了弱对称性和强对称性的概念.脑部图像发生病变后有这样一个常识,正常脑部图像左右两侧的结构是近似对称的.如果一侧出现病变,在形状上另一侧也会发生相应的变化,如挤压变形、覆盖变小等.我们称病变的脑部图像为异常图像,病变的区域称为异常区域.是否出现异常区域是区别正常脑部图像和异常脑部图像的关键.在正常脑部图像中不会出现异常区域,而异常图像中一定会出现异常区域.根据这一医学常识我们给出了医学图像的定义.定义1.一个医学图像MI(MedicalImage)是一个集合G={(L,R,T)|L={v1,v2,…,vn},n是MI左侧像素点的个数,vi∈[0,255].R={u1,u2,…,um},m是MI右侧像素点的个数,ui∈[0,255],T={w1,w2,…,wp},0<p<n或0<p<m,wi∈[0,255]}.其中L和R分别是MI被中垂线垂直平分后左侧和右侧像素的集合.T是MI中异常区域的像素集合,TR或TL.若MI是正常的,则T集合为空;否则T集合不空.在G中,由于器官中的某些基因出现异常,当正常细胞的染色体碰上了这一基因就能诱使细胞发生异常繁殖,阻碍正常细胞的生长,从而异常的一侧细胞迅速生长,而另一侧则由于挤压覆盖等原因阻碍了正常细胞的生长,使其被动发生形变.由于T区域的存在使L和R集合发生变化.这一医学知识体现在图像上即是异常的一侧像素集合发生较大变化,而非异常的一侧像素集合发生的变化较异常的一侧小.图3(a)为正常的医学脑部图像关于脑中垂线垂直平分为Left和Right两部分,在G中L和R集合中像素的分布均匀.图3(b)为异常脑部图像示例,我们可以发现在G中存在一个异常区域T集合.由于T集合的存在,G中L和R集合中像素的分布存在很大的差异.定义2.在异常图像AMI(AbnormalImage)中,若TL,则AMI的左侧发生的变化称为主动变化,右侧发生的变化称为被动变化;若TR,则AMI的右侧发生的变化称为主动变化,左侧发生的变化称为被动变化.定义2是对G中的异常图像AMI主动变化和被动变化的定义.在图3(b)中,L和R像素集合差别很大,导致T区域的存在.TL,即异常出现在左侧,所以图3(b)中左侧发生的变化就是主动变化,右侧是被动变化.如何确定G中L和R像素集合的差别呢?设D(X)是一个像素集合X的含有K个组距的灰度直方图,下面给出弱对称性的定义.定义3.对于一个医学图像G,弱对称性是指G中D(L)和D(R)在每个组距K中共有的像素数目,用它们相交的距离来衡量弱对称性其中,组距K是直方图每组的宽度.图4为图3(a)中Left、Right部分图像的灰度Page5直方图.横坐标表示灰度值的分布,取值范围[0,255],纵坐标表示在某一灰度值上像素点的个数K.根据式(2)可以得知L和R的像素集合相交的距离.弱对称性d(L,R)越大说明L和R相交的部分越多,差别越小.弱对称性d(L,R)越小说明L和R相交的部分越少,差别越大.在G中包括正常的医学图像NMI(NormalMedicalImage)和异常的医学图像AMI(AbnormalMedicalImage),怎么对它们进行区分呢,下面的性质给出NMI和AMI中主动变化和被动变化的关系.图5主动变化和被动变化示例结合定义2和性质,若val<0,则AMI的L中发生的是主动变化,R发生的是被动变化.那么T区域存在于AMI的L中.否则当val>0,T区域存在于R.根据主动变化和被动变化的关系可以定位灰度级医学图像中异常区域T的位置.根据式(3),图5中(a)和(b)的val>0,即T区域出现在图5(b)的右侧.性质(主动变化和被动变化的关系).主动变化和被动变化的关系存在于NMI和AMI弱对称性的对比中,且主动变化小于被动变化.主动变化和被动变化的关系如图5所示.图5(a)是NMI,图5(b)是AMI.图5(c)、(d)是图5(a)左侧和右侧的直方图,图5(e)、(f)是图5(b)左侧和右侧的直方图.若已知NMI的左侧和右侧像素集合为L和R,AMI的左侧和右侧像素集合为L和R.定位异常区域TL或TR应用式(3).医学图像的纹理图像由多条纹理组成,每条纹理由若干个点组成.NMI对应的纹理图像关于脑中垂线垂直平分后的左右两侧近似对称,根据这一原理给出了强对称性的定义.AMI的纹理图像中,发生主动变化的一侧呈现的纹理条数比被动变化的一侧纹理条数多.Page6定义4.一个纹理图像TI(TextureImage)是一个集合F={(Lh,Rh)|Lh={Lh1,Lh2,…,Lhn},Lhi是Lh中的第i条纹理,Lhi={v(1),v(2),…,v(n)},v(i)表示组成Lhi纹理的点.Rh={Rh1,Rh2,…,Rhn},Rhi是Rh中的第i条纹理,Rhj={v(1),v(2),…,v(m)},v(i)表示组成Rhi纹理的点},其中Lh和Rh是关于中垂线垂直平分的左侧和右侧纹理的集合.在纹理图像TI中,以组成纹理的点v(i)为圆心,点v(i)的可移动性mov(v(i))为半径做圆.在圆内或圆上的点都认为是与该点对称的.下面给出强图6强对称性示例算法1是在纹理图像中,根据强对称性rad(v(i))消去纹理上的点的消去算法.消去算法的主要思想是计算Lh和Rh点的个数,其中以点的个数多的一侧作为模板.计算出模板中每个点的强对称性,落在强对称性范围内的点都认为是与该点近似对称的.消去算法的输入是纹理图像TI,输出为纹理图像左右两侧剩余点的个数.纹理图像中纹理点的消去算法的伪代码见算法1.算法1.纹理点的消去算法.输入:纹理图像TI输出:纹理点的个数suml和sumr1.将TI关于中垂线分割为Lh和Rh2.H(i,j)=δ//H(i,j)是纹理图像中纹理点的灰3.suml=0;sumr=0//suml,sumr分别统计左侧和右对称性的定义.定义5.强对称性是指TI中圆内或圆上的点的个数的多少,用它们的半径范围来衡量强对称性rad(v(i))=mov(v(i)).图6(a)是一个纹理图像TI,图6(b)和图6(c)是图6(a)的局部放大图且关于中垂线对称.选择TI中纹理点多的一侧即左侧作为模板,根据强对称性的概念标记每个点的rad(v(i)),如图6(d)所示,图中用不同颜色的点表示点的重要性指数不同.图6(f)是图6(d)关于中垂线的对称图.图6(g)是强对称性rad(v(i))的示例图.4.遍历左侧图像Lh5.IFTl(i,j)≠0&&Tl(i,j)>δ//Tl(i,j)是Lh位于坐标(i,j)的像素点6.suml++7.ENDIF8.遍历右侧图像Rh9.IFTr(m,n)≠0&&Tr(m,n)>δ//Tr(i,j)是Rh位于坐标(i,j)的像素点10.sumr++11.ENDIF12.比较suml和sumr的大小13.将suml和sumr中值较大的一个赋给tem,并作为14.计算模板tem中每个纹理点的强对称性rad(v(i))15.在非模板中将rad(v(i))范围内的点Tr(i,j)=0Page716.循环步4到步15,统计纹理点消去后suml和sumr根据算法1,将rad(v(i))范围内的点消去后,统计左侧和右侧剩余点的个数suml和sumr.图7(a)是强对称性示例图,图7(b)和图7(c)分别是根据消去算法将rad(v(i))范围内的点消去后左侧和右侧剩余的点suml和sumr.4对称性判定算法根据强对称性和弱对称性的概念,引出强对称性判定算法和弱对称性判定算法.结合两个判定算法对医学图像实现多阶段的分类.4.1弱对称性判定算法对于G来说,像素的分布是很重要的特征.通过弱对称性d(L,R)判断T区域是否存在,其可以判定医学图像是否正常.对于T区域存在的图像应用第3节中的性质比较NMI和AMI中主动变化和被动变化的关系.已知L和R是NMI中的左侧和右侧像素的集合,L和R是AMI中左侧和右侧像素的集合.计算L和L的弱对称性d(L,L)与R和R的弱对称性d(R,R),若d(L,L)<d(R,R),则在L和L中像素分布发生的变化大于R和R中像素分布发生的变化,表明T区域出现在AMI的L中,即TL.否则出现在AMI的R中,即TR.基于灰度图像的弱对称性判定算法描述如下.算法2.弱对称性判定算法(WSDA).输入:输入图像L和R,病人在同一时期拍摄的图像分输出:异常区域TL或TR的值val1.计算L和R的直方图D(L)和D(R)2.根据弱对称性的定义求出d(L,R)的值3.IFd(L,R)>ε4.output:输入的图像为正常的医学图像5.ELSE6.output:输入的图像中存在异常区域T,即异常7.IF异常图像8.THEN计算异常图像左侧和右侧的直方图9.根据弱对称性的定义,计算L和L的d(L,L)10.异常区域TL或TR的值val11.ENDIF算法2描述了弱对称性的判定算法,其中步1到6实现了医学图像粗粒度的第1阶段的分类,第5节将详细描述如何利用弱对称性判定算法实现医学图像的多阶段分类.算法2实现了在灰度图像上对异常区域定位的功能,但是由于灰度图像中的灰度信息不能很好的捕捉图像中的局部属性,所以4.2节给出强对称性判定算法进一步确定医学图像上异常区域T的位置.4.2强对称性判定算法由于弱对称性特征对图像或图像区域的方向、大小、位置等变化不敏感,所以弱对称性特征不能很好地捕捉图像中对象的局部属性.本文提出图像的强对称性判定算法可以解决这一问题.与灰度直方图特征不同,纹理特征不是基于像素点的特征,它需要在包含多个像素点的区域中进行统计计算.纹理特征能局部的定位图像中灰度级像素点的位置.每一条纹理都是由灰度剧烈变化的点组成的,通过强对称性的定义来判断纹理图像的整体对称性.纹理上每个点v(i)关于中垂线垂直平分映射到另一侧的点v(i),根据强对称性的定义可以得出点v(i)的可移动范围.那么在可移动范围内的点都认为是与原点对称的.纹理图像集合F=(Lh,Rh}中,正常医学图像的纹理图像中Lh和Rh是近似对称的.如果出现病变区域T,那么T的一侧纹理条数将较多,即组成纹理的点数增多.根据这一性质,算法3给出了强对称性判定算法的算法描述.扫描Lh和Rh中组成纹理的点的个数,假设以点的个数多的一侧作为第1次的模板.关于对称轴映射到另一侧应用算法1消去所有在可移动范围内的点.第1次消去后剩余的点markf=suml-sumr.然后计算Lh和Rh中剩余的点的个数,以非模板的一侧作为第2次的模板消去另一侧的点.第2次消去后剩余的点markl=suml-sumr.比较两侧剩余点的个数sum=markf+markl,若sum0说明左侧存在T区域,sum<0说Page8明右侧存在T区域.这就是基于纹理图像的强对称性判定算法的基本思想.算法3给出了强对称性判定算法的算法描述.算法3.强对称性判定算法(SSDA).输入:纹理图像Lh和Rh输出:剩余点的个数sum1.对纹理图像Lh和Rh预处理,消去纹理图像的最外2.遍历Lh和Rh图像中所有组成纹理的点的个数分别3.比较sum_image_1和sum_image_2的大小,以点数4.利用算法1消去计算suml和sumr的值5.markf=suml-sumr6.以非模板作为新的模板,新模板中的点数为7.markl=suml-sumr8.剩余点的个数sum=markf+markl算法3中,输出强对称性判定结果剩余纹理点的个数sum.通过对标签数据的学习得知当sum0说明T区域在Lh中的可能性较大,而sum<0说明T区域在Rh中的可能性较大.5多阶段分类器的构造通过对医生的调查得知,其利用医学图像进行诊断的过程为:首先根据医生的医学知识判断该医学图像MI是否正常.其次,对AMI继续研究,根据医生的临床诊断经验判断异常出现在Left或者Right中.最后,对AMI中的区域T做进一步的研究,根据医生以往的诊断经验判断T区域的良恶性.本文模拟医生的诊断过程提出了MI多阶段分类器(Multi-StageClassification,MSC)的分类方法,其实现过程如图8所示.MSC-1.应用WSDA对医学图像MI进行了第1阶段分类,即对MI分类为NMI和AMI.MSC-2.对标记为异常的图像AMI进一步处理得到对应的纹理图像F,同时应用WSDA和SSDA判断出异常区域T在医学图像中的左侧或者右侧.MSC-3.本文根据异常区域T的边缘轮廓等信息,提取T的多个特征实现对AMI进行良恶性分类.5.1医学图像正异常分类方法(MSC-1)医生判断一个MI的正异常是根据他们的诊断经验通过MI左右两侧视觉上颜色和形状等信息的对比得出的.根据这一医学常识,结合WSDA我们给出了MSC-1的分类规则1,将MI分类为正常和异常.分类规则1.(1)MI是正常的,如果d(L,R)ε;(2)MI是异常的,如果d(L,R)<ε;其中ε是一个阈值变量,本文将通过实验来确定合适的ε值.利用分类规则1可以将医学图像分类为正常和异常两类.医学图像MI根据中线垂直平分为L和R,其对应的分量为D(L)和D(R),根据L和R的弱对称性d(L,R)的值,可以初步将医学图像分类为正常和异常.图9中(a)、(b)分别为图3中(a)和(b)的D(L)和D(R),其中图9(a)的d(L,R)=0.9085ε,图9(b)中d(L,R)=0.7731<ε.5.2医学图像异常定位分类方法(MSC-2)MSC-1过程将MI分类为正常和异常,接下来,我们对MSC-1过程所得结果中的异常图像做进一步分类处理,判断图像中发生异常区域T所处的位置.该阶段选用对样本数量要求较低的SVM(SupportVectorMachine)作为分类器.该方法在解决小样本、高维度、非线性的模式识别中表现出诸多优点,它的基本模型是一个二分类模型,是一个定义在特征空间上的最大间隔线性分类器.这种方法根据有限的样本信息在模型的复杂性和学习能力之间寻求最佳折衷,以期获得最好的推广能力.由于医生在诊断过程中往往通过对比同一个人的多张图像或同一图像左右两侧的颜色和位置等信息判断异常区域出现的位置,本文基于对称性理论提出了WSDA和SSDA两个判定算法.分类规则2是通过提取WSDA和SSDA的两个特征值val和sum作为SVM分类器的特征输入,训练分类模型model,最后输出测试集图像所属类别,如图10所示.Page9图9图3中(a)、(b)的D(L)和D(R)分类规则2.(1)如果测试集的两个特征val和sum满足model中的左侧异常特征,则MI左侧异常;(2)如果测试集的两个特征val和sum满足model中的右侧异常特征,则MI右侧异常.图10为MSC-2的分类模型,对训练集的学习可以导出一个分类模型model,测试集中的两个特征val和sum根据分类规则2应用分类模型model分类为左侧异常和右侧异常两类.基于医学图像对称性理论的WSDA和SSDA提取医学图像异常定位分类器模型的两个特征val和sum,应用分类规则2即可对异常的MI图像定位异常区域T的位置.可见,通过MSC-2的分类方法可以对MSC-1中异常图像定位其异常区域T的位置在MI的左侧或右侧,这样有助于医生对病变区域存在于左侧或右侧做出尽早的判断,从而减少医生用于诊断的时间和精力.5.3医学图像良恶性分类方法(MSC-3)判断出异常区域的位置后,为了避免异常区域阻碍正常细胞的生长,医生要及时的诊断异常区域的良恶性并做出诊断决策.模拟医生诊断的这一过程,本小节将对异常区域T进行分类处理,选用SVM作为分类器.虽然在脑部医学图像中肿瘤有很多类,但是目前脑膜瘤和胶质瘤最为常见.胶质瘤是最为常见的恶性肿瘤之一,脑膜瘤则是最为常见的良性脑肿瘤之一.术前对肿瘤的良恶性程度进行评估对治疗方案的制定和术后诊断有重要临床意义.由于这两种肿瘤在临床诊断中最为常见,所以本小节针对这两种肿瘤特征对异常的医学脑部CT图像切片分类为良性和恶性.图11(a)为良性肿瘤,其具有以下特Page10征:形态规则、边缘清晰光滑、肿瘤呈现近似圆形;而图11(b)为恶性肿瘤其形态不规则、边缘模糊粗糙.本文中将采用紧凑度C、平均标准化半径davg、粗糙度Ro、方差δ2、偏斜度Sk、峰值Pe共6个特征[25-26]区分AMI的良恶性.紧凑度C是一个粗略描述物体边缘规则度的特征参数,较多地应用于识别物体形状领域.其定义如下:其中A是肿瘤轮廓的面积,p是肿瘤轮廓的周长.当C→0时,形态接近于规则.上式也表明,紧凑度C与平移、旋转和缩放无关.平均标准化半径davg是宏观描述物体边缘规则度的特征参数,但相比于紧凑度,它还可以反映一些细微的边缘变化.其定义如下:其中,N为边缘上点的个数,设ROI区域的最小外接矩形的中心为(x0,y0),半径d(i)是各边缘点(xi,yi)到图像中心(x0,y0)的距离,可以根据下式计算.d(i)=其中max(d(i))是半径中的最大值.粗糙度Ro的大小反映了边缘毛刺的多少和边缘的光滑程度.其定义如下:其中N和d(i)的定义与式(5)相同.方差δ2反映的是边缘点和中心的偏离程度,用来衡量边缘数据的波动大小,方差越大说明边缘点的波动越大,肿瘤的边缘形状越不稳定,此特征的计算见式(8).其中,K是边缘上点的数量,Li是边缘上点和点之间的欧氏距离,μ是均值,可以通过下列公式计算得到偏斜度Sk反映边缘的形状是否规则,以平均值为中心数据分布的对称性.当偏斜度为正值时,说明肿瘤边缘的形状为圆或椭圆形,当偏斜度为负值时说明肿瘤边缘的形状不规则.此特征的计算见式(10).其中δ是式(8)中的方差,μ是式(9)中的均值,K是边缘上点的数量,Li是边缘上点和点之间的欧氏距离.峰值Pe反映边缘的光滑程度,峰值越大,边缘越不光滑;峰值越小,边缘越趋于光滑.此特征的计算见式(11).其中,δ是式(8)中的方差,μ是式(9)中的均值,K是边缘上点的数量,Li是边缘上点和点之间的欧氏距离.根据异常区域T的以上6个特征C、davg、Ro、δ2、Sk、Pe的提取,我们给出异常MI良恶性区分的分类规则3.分类规则3.(1)如果测试集的6个特征满足model中的良性特征,则MI为良性;(2)如果测试集的6个特征满足model中的恶性特征,则MI为恶性.图12为MSC-3的分类器模型.其中图12(a)为MI左侧异常区域分类为良恶性的模型,图12(b)为MI右侧异常区域分类为良恶性的模型.应用分类规则3判断异常区域的良恶性.根据左侧和右侧异常的MI的训练集分别训练出相应的model.测试集中的6个特征满足model中良性的概率大于恶性的概率时,我们认为其属于良性,否则属于恶性.6实验结果及分析为了验证基于对称性理论的医学图像多阶段分类方法的效率,本节将分为3个实验来予以说明.因为目前没有实现对医学图像的多阶段分类的方法,所以实验将每个阶段分别作了对比.文献[10]提出的基于形态学操作的分类方法SVM-MPO将医学图像分类为正常和异常.文献[11]中的FBB方法可以快速定位MR图像中的肿瘤位置.FBB方法的前提是知道肿瘤在图像的左侧还是右侧,然后应用Page11FBB方法将肿瘤区域标记出来.该方法只适合MR图像中,在CT图像中效果不是很好.文献[12]基于小波统计纹理WST方法分割和分类脑CT图像,提出一种基于小波图像的游程矩阵和灰度共生矩阵的混合方法将肿瘤分类为良性和恶性.本文为了更好地利用大量未标注图像样本信息来提高分类器性能,采用的是随机半监督采用算法[27].该算法采用迭代随机采样方法,每次采用中通过谱聚类估计未标注样本的类别值,使用SVM进行模型学习,逐步优化模型,以提高分类准确度.本文所使用的图像数据集来自于医院真实脑部CT图像.实验数据包括1500张医学脑部图像.其中1000张作为训练集,并做相应的标记如左侧异常、右侧异常、良性和恶性,500张作为测试集.实验的硬件环境:Intel(R)Core(TM)2QuadCPUQ8400@2.66GHz,2.0GBRAM,采用MicrosoftWindows7操作系统.实验软件开发环境:VS2010,opencv2.3.1,MatlabR2009.6.1MSC-1中阈值ε选取根据弱对称性将脑部CT图像分类为正常和异常两类.这时阈值的选取很重要.阈值的不同导致分类的精度有所改变.根据弱对称性的定义d(L,R),得知图3(a)的d(L,R)=0.9112.通过弱对称性d(L,R)的值可以判断图像的对称性,式(12)是判定图像正常或异常.大量实验得出当d(L,R)的阈值为0.88时,测试集的分类精度达到98.2%.阈值ε的选择做了以下两组实验,如图13所示.每组图像显示了随着阈值ε的改变,分类精度的变化情况.实验结果表明当阈值ε的范围选择的适当时,测试集中的脑部CT图像初步分类为正常和异常的准确率可以达到98.2%.图13显示的结果表明,不同阈值下脑部CT图像正确分类的百分比.当阈值ε<0.6和ε>0.96时,正确分类的CT图像数为0.当阈值ε为0.6时正确分类数只占3%,ε为0.96时正确分类数只占2%.当阈值ε=0.88时,训练集中的脑部CT图像的正确分类数达到87%.当阈值选为0.88时测试样本中的500张图像的正异常分类精度达到98.2%.6.2分类器性能评价分类器的设计好坏由分类结果的准确率和召回率来评估.准确率即图片库中相关的图片,被检索到的越多越好,而召回率是检索到的图片中,相关的越多越好,不相关的越少越好.准确率和召回率的公式如下:其中,TP是检索到的相关图像,FP是检索到的但不相关的图像.FN是未检索到但相关的图像,TN是未检索到也不相关的图像.准确率和召回率虽然没有必然的关系,然而在大规模的数据集合中,这两个指标是相互制约的.文献[10]将脑部CT图像分类为正常和异常两类.而本文提出的MSC分类方法包括将脑部CT图像分类为正常和异常,又将异常的分类为左侧异常和右侧异常.然后将异常的肿瘤分类为良恶性两类.通过实验表明MSC-1中使用WSDA将脑部CT图像分类为正常和异常的精度并不低于文献[10]提出的基于形态学操作的分类方法SVM-MPO的分类结果.如图14所示.文献[10]的方法应用在本文中的数据集进行分类精确度的测试时显示的分类精确度不是很高,而本文的方法对各类数据都比较适用.实验中共有1500个样本,其中1000个样本用作分类器的训练,500个样本用来测试分类器.当训练样本为50时,SVM-MPO的分类精确度为54%,而MSC-1的分类精确度为70.8%.随着训练样本的不断增大,两种分类方法的分类精度逐渐上升.但是实验结果显示MSC-1的分类精度在任何数据集的情况下都比SVM-MPO的分类精度高.Page12文献[10]提出的分类方法只是本文分类的第1阶段.第2阶段MSC-2是通过弱对称性和强对称性将脑部CT图像病变的位置进行分类为左侧病变和右侧病变.得出测试样本的准确率和召回率的关系图像为图15所示.图16为MSC-2与FBB方法的分类准确率的对比实验.图15MSC-2、MSC-3准确率和召回率的关系图16实验结果表明,在同样的训练集下,FBB方法的分类准确率很低,而本文提出的MSC-2的分类方法准确率都在95%以上.在测试集为180时,MSC-2的分类准确率为97.8%,而FBB方法的分类准确率为47.1%.FBB方法前提是知道肿瘤发生在图像的哪一侧,然后才能精确的在MR图像中定位肿瘤的区域.而本文直接通过弱对称性和强对称性就可以将肿瘤的区域定位在左侧或者右侧,而不是精确的定位肿瘤的区域,有利于第3阶段良恶性分类精度的提高.第3阶段MSC-3是将病变的肿瘤分类为良恶性两类.本文基于灰度图像提取病变肿瘤的6个特征作为良恶性分类的特征.其测试样本的准确率和召回率的关系图像为图15所示.图17是本文与WST分类准确率的对比.图17结果表明,当测试数据为180时,MSC-3的分类准确率是91.2%,而WST的分类准确率是83%.这说明在训练样本1000下训练的MSC-3分类模型的准确率高于WST分类模型的准确率.6.3时间复杂性分析为了验证基于对称性理论的医学图像多阶段的分类算法的效率,将文献[10]中的SVM-MPO方法、文献[11]中的FBB方法和文献[12]中的WST方法分别与本文的MSC-1、MSC-2和MSC-3在时间复杂度上做对比.实验结果如图18~图20所示.图18MSC-1与SVM-MPO时间复杂度对比Page13图19结果表明MSC-1方法的时间效率优于SVM-MPO的时间效率.随着数据集的增大,SVM-MPO的运行时间呈线性递增的趋势增长,而MSC-1方法在数据集达到300时,运行时间几乎不再变化,数据集达到500时运行时间为11s而SVM-MPO的运行时间为21.5s.所以本文的方法MSC-1要比SVM-图21分类结果实例MPO方法时间效率高.在数据集继续增大的情况下,MSC-1的运行时间将不会变化很大.图20是MSC-2与FBB方法在运行时间上的对比,当数据集达到130时,两个方法的运行时间几乎呈直线增长,但数据集继续增大时,MSC-2运行时间变化很小.图20表明MSC-2的运行效率高于FBB定位肿瘤的方法.图21Page14是MSC-3与WST方法在运行时间上的对比.因为WST方法要提取二级小波纹理图像,然后在小波纹理图像上提取游程矩阵和共生矩阵共17个特征作为分类特征集.效率要比MSC-3低很多.在准确率一定的情况下,MSC-3在运行时间上有更好的效率.图21给出了一些分类结果的实例,其中第1部分是待分类图像,其他3部分是分类结果,待分类图像取自不同的病人.第2部分为本文的分类方法,其中包括分类的3个阶段:MSC-1、MSC-2、MSC-3.第3部分为FBB方法的分类结果,第4部分为WST方法的分类结果.通过实例可以发现,基于对称性理论的医学图像多阶段分类算法可以更为准确地实现模拟医生的诊断过程并将医学图像分类.FBB方法实现的是将待分类的医学图像分类为左侧异常和右侧异常,WST方法是将待分类的医学图像分为良性和恶性两类.而本文通过模拟医生的诊断过程实现由粗粒度到细粒度的将医学图像分类.7总结医学图像的成像结果显示一张医学图像关于中垂线两侧近似对称.基于这一脑部医学领域知识的指导,本文提出了基于对称性理论的医学图像多阶段分类(Multi-StageClassification,MSC)方法.首先,本文提出了弱对称性和强对称性的定义,从不同粒度对医学图像的对称性进行了描述;然后,给出了基于灰度直方图相交性的弱对称性判定算法,对医学图像在较粗粒度上进行了第1阶段的分类;接着,提出了基于点对称的强对称性判定算法,结合弱对称性判定算法,对第1阶段分类结果为异常的图像进行了更细粒度的第2阶段分类,定位了病变区域的位置;最后,利用对病变区域所提取的特征,对病变区域进行了第3阶段的分类,已达到辅助医生诊断的效果.实验结果表明,基于对称性理论的医学图像多阶段分类方法提高了医学图像分类的准确度,同时减少了医生诊断决策的时间.
