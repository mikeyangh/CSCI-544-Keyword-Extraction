Page1一种基于进程验证的Petri网可达性判定方法于枫1),2)罗军舟1)李伟1)王鹏1)1)(东南大学计算机科学与工程学院南京210096)2)(江苏科技大学计算机科学与工程学院江苏镇江212003)摘要为了解决Petri网的可达性判定问题,提出了一种基于进程验证的可达性判定方法.通过分析Petri网基本进程段子段间偏序关系,该方法提出原子进程段概念,求得原子进程段集及其偏序关系集作为可达性判定的验证对象.基于原网状态方程解向量、原子进程段T-向量的线性纯整数规划问题解,选取该解中非零分量对应的原子进程段子集作为待验进程段集,选取待验进程段间的偏序关系子集作为待验推理规则集,通过验证是否存在这两个集合上的以初始标识M0为推导初态、目的标识Md为推导终态的序列而判定(M0,Md)是否可达.分析表明该可达性判定算法的时间复杂度是依赖于原子进程段集规模的,最坏情况下不超过变迁集规模.关键词Petri网;可达性判定;Petri网进程;进程验证1引言Petri网是适用于具有离散、并发、异步等特性的分布式系统建模分析的工具,在协议工程、逻辑推理、工作流建模等多领域得到广泛应用.Petri网可达性判定理论与方法是领域研究的一项重要内容,某些动态性质(如活性)判定在一定程度上要以它为基础.通常,Petri网可达性判定方法可分为两类,一类基于Petri网的可达图或可覆盖图判定标识可达性,另一类通过求证状态方程解向量的合法变迁引发序列(LegalTransitionFiringSequence,LFS)存在来判定可达性.基于可达图的有界Petri网可达性判定算法在理论上是可行的,但实际应用中,算法会因“状态组合爆炸”带来可达图线性时间内不可搜索而失效.无界Petri网的可覆盖图中,“无穷量ω”的引入使其不再具备可达性判定能力.因此,可达图或可覆盖图并不能真正解决Petri网的可达性判定问题.基于状态方程的可达性判定方法中,状态方程求解和LFS验证均已证明是NP-难问题,想要找到多项式时间复杂度的算法也是很困难的.基于LFS存在判定可达性问题,文献[1]针对T-invarant-lessPetri网提出了通过添加独特的补变迁把原Petri网的LFS判定转化为补Petri网的T-不变量线性表出系数求解问题的可达性分析方法;文献[2]扩展了文献[1]思想到一般Petri网,进一步研究补Petri网的T-不变量含义;文献[3]给出一种一般Petri网的LFS判定方法;文献[4]基于deadlock-avoidance思想提出LFS判定问题的启发式算法FSDC,此算法以先求得的MAXLFS为基础求解目标LFS.这些方法却各有局限:文献[1-2]的算法为保证补变迁只引发一次使得T-不变量的线性表出系数取值于实数域,难以求解且常常不符合Petri网应用于现实系统建模的物理特性;文献[3]算法虽对可达树进行缩减,本质上仍是完全搜索策略;文献[4]的迭代算法运算量巨大.因此,继续研究Petri网可达性判定的有效算法仍是十分有意义的.可达性是Petri网动态行为研究的基础,标识间可达必对应于网的某个运行轨迹,而Petri网进程是记录网运行轨迹的优良工具,因此,从进程角度研究可达性判定问题不失为一种有益尝试.由于一个进程(段)仅反映Petri网的一次运行(片段),为记录Petri网的全部可能运行过程,前人提出并研究了Petri网的进程表达式问题.文献[5]给出了有界Petri网的进程表达式,并证明有界Petri网的进程集是正规集.文献[6]提出进程段划分的行为等价准则从而给出无界公平Petri网的进程表达式.文献[7]设计无界Petri的进程网系统构造算法.文献[8]阐述基于库所指标分解的进程表达式求取方法.文献[9]首先求解S-网的进程表达式,随后证明任一Petri网可由一组S-网的拓展同步合成运算得到,进而得出进程表达式.然而,进程表达式是以极小基础进程段为基本元素构成的,而极小基本进程段并不能直接作为可达性判定的基本元素,主要原因在于:(1)粒度不等.进程表达式中,基本研究对象是极小基本进程段;可达性判定中,要分析至极小进程段的每个s-切.在进程网系统中,变迁引发(不引发)意味着其对应的极小基本进程段中的全部s-切都可达(都不可达),这不符合可达性判定的需求.(2)范围不等.进程表达式所确定的集合要小于可达性分析中须判定的合法变迁引发序列集.后文中,我们通过证明等价于进程表达式语言集的无标注Petri网进程网语言是标识对间合法变迁引发序列集的真子集说明这种不等价性.本文中,我们提出一种基于进程验证的可达性判定.首先,基于Petri网基本进程段子段的偏序关系分解,提出原子进程段概念(即不可偏序再分),求得该网的原子进程段集及其偏序关系集(推理规则集).然后,求原网状态方程解向量犡、原子进程段T-向量的线性纯整数规划问题解,选取该解中非零分量对应的原子进程段作为待验证进程段集,选取待验进程段间的偏序关系作为待验推理规则子集.最后,通过判定是否存在以初始标识M0为推导初态、目的标识Md为推导终态的序列存在来判定标识对(M0,Md)间的可达性.文中第2节介绍相关的Petri网基础知识;第3节提出原子进程段概念,设计Petri网的原子进程段集、原子进程段间偏序关系集求解算法;第4节首先证明原子进程段T-向量的线性纯整数规划问题解是可达性的必要非充分条件,然后阐述基于进程验证的可达性判定算法,并以示例演示和分析;最后一节总结全文,展望后续工作.2相关的Petri网基础知识本节给出的基本概念、术语等来自参考文献[7-8,Page310-11].不失一般性,假定Petri网中K=ω,W=1.定义1[10].设N=(B,E;G)为一个网,如果,(1)b∈B:|·b|1∧|b|·1.(2)x,y∈B∪E:(x,y)∈G+→(y,x)G+,则称N为一个出现网,其中G+表示流关系G的传递闭包.定义2[10].若N1=(S,T;F)为一个网,N2=(B,E;G)为一个出现网,若映射φ:B∪E→S∪T满足:(1)φ(B)S,φ(E)T;(2)x,y∈B∪E:(x,y)∈G→(φ(x),φ(y))∈F;(3)e∈E:φ(·e)=·φ(e),φ(e·)=φ(e)·,则称φ定义了从N2到N1的一个映射,记为φ:N2→N1.定义3[10].设Σ=(N1,M0)=(S,T,F;M0)为一个Petri网,N=(B,E;G)为一个出现网,如果φ:N→N1满足:(1)b1,b2∈B:b1≠b2,若φ(b1)=φ(b2),则·b1≠·b2且b·(2)s∈S:|{b|φ(b)=s∧·b=}|M0(s),则称(N,φ)为Σ的一个进程.定义4[10].设φ为出现网N=(B,E;G)到Petri网Σ=(S,T,F;M0)的一个网映射,如果:(1)b1,b2∈B(b1≠b2):φ(b1)=φ(b2)→(·b1≠·b2∨·b1=·b2=)∧(b·(2)|{b|φ(b)=s∧·b=}|=M0(s),则称P=(N,φ)为Σ的一个满进程.定义5[7].设P=(N,φ)为Σ的一个满进程,其中N=(B,E;G),u1u2,记(1)B1={x∈B|b1∈u1,b2∈u2:(b1,x)∈G∧(x,b2)∈G},(2)E1={y∈E|b1∈u1,b2∈u2:(b1,y)∈G+∧(y,b2)∈G+},(3)G1=G∩{(B1×E1)∩(E1×B1)}.令N1=(B1,E1;G1),φ1:N1→Σ满足:x∈B∪E:φ1(x)=φ(x),则称(N,φ1)为进程P的(界于u1和u2之间的)一段,也称作Σ的一个进程段,记为(N[u1,u2],φ).定义6[7].设P=(N,φ)为Σ的一个满进程,P1=(N[u1,u2],φ)为Σ的一个进程段,如果N[u1,u2]中的任意两个s-切ui和uj,i,j≠1,2,有ui≠uj→((φ(ui)≠φ(uj))∧((φ(ui)<|φ(uj))∧则称P1=(N[u1,u2],φ)是Σ的一个基本进程段.定义7[7].给定一个Petri网Σ=(S,T,F;M0),犆m×n为网的关联矩阵,|P|=m,|T|=n,若一个n维非负整数向量犢满足(1)犆犢T=0,则称犢为Σ的一个T-不变量.若对0<犢<犢有C(犢)T≠0,则称犢为Σ的一个极小T-不变量;(2)犆犢T>0,则称犢为Σ的一个增向量.若对0<犢<犢不是Σ的增向量,则称犢为Σ的一个极小增向量;(3)犆犢T<0,则称犢为Σ的一个减向量.若对0<犢<犢不是Σ的减向量,则称犢为Σ的一个极小减向量;(4)(犆犢T|<0)∧(犆犢T|>0),则称犢为Σ的一个传递向量.若对0<犢<犢不是Σ的传递向量,则称犢为Σ的一个极小传递向量.极小T-不变量和极小增向量被称为Σ的极小可重复向量,极小减向量和极小传递向量被称为Σ的极小受控可重复向量.定义8[7].给定Petri网Σ=(S,T,F;M0),犡是Σ的极小可重复向量,若存在M∈R(M0)和变迁序列σ(#(ti/σ)=X(i),i=1,2,…,n),使得对任意正整数k,都有M[σk>,则称犡为Σ的有效极小可重复向量.定义9[7].给定Σ=(S,T,F;M0),犡是Σ的极小受控可重复向量,若任意正整数k,都存在M∈R(M0)和变迁序列σ(#(ti/σ)=X(i),i=1,2,…,n),使得M[σk>,则称犡为Σ的有效极小受控可重复向量.定义10[7].设P1=(N[u1,u2],φ)为Σ的一进程段,N=(B,E;G),ti∈T|{e∈E|φ(e)=ti∧(b1∈u1,b2∈u2:(b1,e)∈G+∧(e,b2)∈G+)}|称作变迁ti在P1中出现的次数,记作#(ti,P1);n维非负整数向量犡P(i)=#(ti,P1),i=1,2,…,n,称为进程段P1的T-向量.定义11[7].设P1=(N[u1,u2],φ)为Σ的一个进程段,犡P为其T-向量,(1)称P1为Σ的一个(基本)不变进程段,当且仅当犡P为Σ的一个有效(极小)T-不变量;(2)称P1为Σ的一个(基本)增进程段,当且仅当犡P为Σ的一个有效(极小)增向量;(3)称P1为c的一个(基本)减进程段,当且仅当犡P为Σ的一个有效(极小)减向量;(4)称P1为Σ的一个(基本)传递进程段,当且仅当犡P为Σ的一个有效(极小)传递向量.Page4给定Σ=(P,T,F;M0)的一个有限进程段P1=(N[u1,u2],φ),φ(u1)=Mu1,φ(u2)=Mu2.若P1是Σ的(1)不变进程段,则φ(u1)=φ(u2);(2)增进程段,则φ(u1)<φ(u2),满足Mu2(si)>Mu1(si)的库所si称为P1的输出库所;(3)减进程段,则φ(u1)>φ(u2),满足Mu2(si)<Mu1(si)的库所si称为P1的驱动库所;(4)传递进程段,φ(u1)≠φ(u2)∧φ(u1)|<φ(u2)∧φ(u1)|>φ(u2).满足Mu2(si)>Mu1(si)的库所si称为P1的输出库所;满足Mu2(si)<Mu1(si)的库所si称为P1的驱动库所.定义12[7].给定Petri网Σ=(S,T,F;M0),CT(Σ)为其可覆盖树,满足以下条件的树CRT(Σ)称为Σ的特征可达树:(1)CRT(Σ)与CT(Σ)同构;(2)CRT(Σ)的根结点标注满足(3)对CRT(Σ)中的任意两个结点Mj和Mk,若Mj到Mk有一条有向边标注为ti,则T,F;M0)的一个进程段,P1对应的可达树是指:Mk(pi)=定义13[7].设P1=(N[u1,u2],φ)为Σ=(P,(1)根结点标注为M1=φ(u1);(2)树中一结点标注为Mj当且仅当存在s-切u满足:u1uu2∧φ(u)=Mj;(3)树中两结点MjMk间存在标注变迁t的有向弧当且仅当Mj[t>Mk.由定义12、13知,进程段对应的可达树是Petri网的可覆盖树同构意义下的子树,也同构于其特征可达树上的相应子树.定义14.设P1=(N[u11,u12],φ)和P2=(N[u21,u22],φ)为Σ的两个基本进程段,如果P1和P2在Σ的可达树满足:(1)同构于相同的可覆盖子树,(2)可覆盖子树中标注的变迁相同,则说P1和P2是功能等效的,记作P1P2.定理1[7].给定Petri网Σ=(S,T,F;M0),则Σ的基本进程段集在功能等效的意义下是有限集.推论1[7].在行为等价意义下,Petri网的基本进程段集是有限集.定义15.给定Petri网Σ=(S,T,F;M0),基本进程段集BP(Σ),记+、|、-闭包、α-闭包分别表示进程的连接、选择和闭包运算,E(Pj,Pk,…,+,|,-,α-)表示基本进程段Pj,Pk,…,经由上述运算所得表达式.若Pi∈BP(Σ):Pi≠E(Pj,Pk,…,+,|,),Pj,Pk∈BP(Σ),则称Pi为一个极小进程段.极小进程段的集合称为极小进程段集,记为BPe(Σ).按文献[7]描述,Petri网Σ的基本进程段集是基本不变进程段集BP=(Σ)、基本增进程段集BP+(Σ)、基本减进程段集BP-(Σ)、基本传递进程段集BP→(Σ)和基本开进程段集NBP(Σ)的并BP(Σ)=BP=(Σ)∪BP+(Σ)∪BP-(Σ)∪BP→(Σ)∪NBP(Σ).由于基本开进程段并不对应一个有效的传递向量,非有效进程段,故后文中,默认极小进程段集BPe(Σ)=BPe(Σ)-NBP(Σ).定义16.设P1=(N[u11,u12],φ)和P2=(N[u21,u22],φ)为Σ的两个进程段,P1和P2等价当且仅当P1和P2对应的可达树等价.3Petri网的原子进程段3.1极小基本进程段分析文献[7-8]中,Petri网的进程网系统ΣP是将原网的基本进程段抽象为变迁,基本进程段的输入、输出库所集作为该变迁输入、输出库所集,建立流关系,将原网的初始标识向进程网系统的库所集上做投影而建立起来的.这样,变迁引发的原子特性就迫使极小基本进程段中s-切的可达性判定带上原子特征,即极小进程段P1=(N[u1,u2],φ)抽象成的变迁t引发,则全部s-切可达;若t不引发则任意u1<uu2,Mu=φ(u)失去可达性判定机会.事实上,极小进程段P1的第一个s-切可达,并不能说明其后任意s-切是否可达.另一方面,极小进程段以是否存在有效极小(受控)可重复向量犢为判定标准,而犢的判定条件有两点:(1)犢左乘关联矩阵(犆犢T)后积向量与零向量的大小比较;(2)存在可达标识和合法引发序列,使得该序列可引发任意正整数k次(或对任意正整数k存在可达标识和合法引发序,该序列可引发k次).后一条件本身就是可达性判定问题.由上述知,极小基本进程段粒度上并不匹配于可达性判定的基本研究对象.另一方面,借助进程网语言,我们可证明,以极小基本进程段为基本元素构Page5成的进程表达式所确定的集合仅是Petri网可达标识对间合法变迁引发序列集的真子集.定义17[10].称PN=(S,T,F;M0,Σ,h,F)为一个标注Petri网,当且仅当(1)S,T,F;M0含义同前,Σ为字母表;(2)h:T→Σ为标注函数;(3)FR(M0)为终止标识集,R(M0)为可达集.定义18[10].设PN=(S,T,F;M0,Σ,h,F)为一个标注Petri网,令L={α∈Σ|σ∈T∧M0[σ>M∧M∈F∧h(σ)=α},F=R(M0)Σ=T,则称L为PN产生的P-型无标注语言,记为Pf.Petri网中相异标识对间可达必定对应网的一次运行,由Petri进程的定义知,若一对标识(M0,Md)间有可达关系,则至少存在一个进程P0d=(N(u0,ud),φ),有Γ(P0d)=σ0d满足M0[σ0d>Md.引理1.给定Petri网Σ=(S,T,F;M0),目标标识Md,记(M0,Md)间可达变迁引发序列集合为σR={σ|(M0[σ>Md)},则σRPf.量犡σ=#(ti/σ0d),必有Mσ=M0+犆犡T证明.由定义18可知,有σRPf.再证σR≠Pf.取Mω∈R(M0),M0[ω>Mω,Mω≠Md,由定义18知有ω∈Pf,记ω对应的T-向量犡ω=#(ti/ω),序列ω引发后的标识Mω=M0+ω,犆犡T取σ∈σR,M0[σ>Md,Md∈R(M0),σ对应T-向若ω∈σR,则有M0+犆犡T则与Mω≠Md矛盾,故ωσR,综上,有σRPf.推论2.给定Petri网Σ=(S,T,F;M0),任意标识M∈R(M0),标识对(M0,M)间可达变迁引发序列集合为σR={σ|(M0[σ>Md)},则证明.由定义18、引理1可知,该命题成立.引理2.给定Petri网Σ=(S,T,F;M0),极小进程段集BP(Σ),ΣP为其进程网系统,L(ΣP)为ΣP所确定的语言,Pf为Σ产生的P-型无标注语言,则L(ΣP)Pf.证明.由ΣP、L(ΣP)、Pf的定义知,显然有L(ΣP)Pf.再证L(ΣP)≠Pf.设BP(Σ)={P1,…,Pk},Γ:BP(Σ)→T.为满进程,取ω∈Pf,有M0[ω>Mω,P0ω=(N(u0,uω),φ)不妨设ω=Γ(P0ω)=t1t2…tl,取∏σj=()ω∧(Γ(sub(Pi))=σj),i∈{1…k},P0ω=∏sub(Pi),若任一sub(Pi)有sub(Pi)Pi,ΣP中无与sub(Pi)对应的变迁可引发,则∏sub(Pi)L(ΣP),即ωL(ΣP).定理2.给定Petri网Σ=(S,T,F;M0),极小进程段集BP(Σ),ΣP为其进程网系统,L(ΣP)为ΣP所确定的语言,标识对(M0,M)的可达变迁引发序列集σR,则证明.由引理1、推论2、引理2显然可证.综上所述,并不能通过直接应用进程表达式来确定是否存在其所确定的集合中有对应于Petri网的一对标识间合法变迁引发序列存在,即得出Petri网可达性判定结论.3.2原子进程段概念由以上知,极小基本进程段粒度相对于可达性判定来说偏大,因此,通过对其进行偏序再分,我们提出原子进程段概念.定义19.给定Petri网Σ=(S,T,F;M0),变迁ti、tj和tk,(1)若tj引发则必有ti先引发,则称ti、tj有顺序关系,ti为前驱变迁,tj为后继变迁,记为ti→tj;(2)若标识M下,有((M[tj>M)∧(M[ti>)∧(﹁M[tj))∨((M[ti>M)∧(M[tj>)∧(﹁M[ti>))成立,则称ti、tj在标识M并发,记为ti‖Mtj;(3)若标识M(M[tj>M∧﹁M[ti>)∨(M[ti>M∧﹁M[tj>)成立,则称ti、tj在标识M下冲突选择,记为tiMtj;(4)若标识M下,有成立,则称ti、tj在标识M下自由选择,记为tiMtj;(5)若(tk→ti)∧(tk→tj)∧(ti‖Mtj)成立,则称ti、tj在tk处有分支关系,记为ti↑tj;(6)若(ti→tk)∧(tj→tk)∧(ti‖tj)成立,则称ti、tj在tk处有汇合关系,记为ti↓tj.定义19给出的Petri网变迁间偏序关系如图1所示.Page6定义20.给定Petri网Σ=(S,T,F;M0),进程段集P(Σ),定义Γ:P(Σ)→T为进程段向变迁序列的映射关系.类似,可分析Petri网的进程段间偏序关系,有定义21.定义21.给定Petri网Σ=(S,T,F;M0),BPe(Σ)含k个极小进程段P1…Pk,以P==(N(u=1,u=2),φ)、P+=(N(u+1,u+2),φ)、P-=(N(u-1,u-2),φ)、P→=(N(u→1,u→2),φ)分别表示极小不变进程段、极小增进程段、极小减进程段、极小传递进程段,记%,&∈{=,+,-,→}.P∈BPe(Σ),若M%1[σ>M%2,则ΓP%=σ%,M%i=φ(u%i)|u%i∈P%.类似,M&j=φ(u&j)|u&∈P&,ΓP&=σ&,M,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)在标识M冲突选择;(4)若ΓP%∩ΓP&=,MM%1M∧M&1(N(u%1,u%2),φ)M(N(u&1,u&2),φ),M,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)在标识M(1)若ΓP%∩ΓP&=,M%2M&1,有(N(u%1,u%2),φ)→(N(u&1,u&2),φ),则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)在标识M%2顺序;(2)若ΓP%∩ΓP&=,MM%1M∧M&1M,有(N(u%1,u%2),φ)‖M(N(u&1,u&2),φ),则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)在标识M下并发;(3)若ΓP%∩ΓP&=,MM%1M∧M&1(N(u%1,u%2),φ)M(N(u&1,u&2),φ),自由选择;(5)若ΓP%∩ΓP&=,MM%2M∧M&2(N(u%1,u%2),φ)↓M(N(u&1,u&2),φ),M,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇结于标识M;(6)若ΓP%∩ΓP&=,M=φ(u)|u∈P%∧u∈P&,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇合于M后冲突选择;(7)若ΓP%∩ΓP&=,M=φ(u)|u∈P%∧u∈P&,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇合于M后自由选择;(8)若MMM%1∧MM&1,MMM%2∧(N(u%1,u%2),φ)M(N(u&1,u&2),φ);(N(u%1,u%2),φ)↓M(N(u&1,u&2),φ),MM&2,ΓP%∩ΓP&=,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)冲突汇结于标识M;(9)若MMM%1∧MM&1,MMM%2∧MM&2,ΓP%∩ΓP&=,有(N(u%1,u%2),φ)M(N(u&1,u&2),φ);(N(u%1,u%2),φ)↓M(N(u&1,u&2),φ),则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)自由汇结于标识M;(10)若MMM%1∧MM&1,u%1<u<u%2,u&1<u<u&2,MM=φ(u),ΓP%∩ΓP&=,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)自由汇合后冲突选择;(11)若MMM%1∧MM&1,u%1<u<u%2,u&1<u<u&2,MM=φ(u),ΓP%∩ΓP&=,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)冲突汇合后自由选择;(12)若ΓP%∩ΓP&=σ,{M%i}∩{M&j}={M…M%2},M[σ>M%2M=φ(u),M%2=φ(u%2),有(N(u%1,u),φ)↓(N(u,u&2),φ)(N(u&1,u),φ),Page7则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇结于(N(u,u&2),φ);(13)若ΓP%∩ΓP&=σ,{M%i}∩{M&j}={M…M},M[σ>MM=φ(u),M=φ(u)|u<u%2∧u<u&2,有则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇并于(N(u,u&2),φ);(14)若ΓP%∩ΓP&=σ,{M%i}∩{M&j}={M…M},M[σ>MM=φ(u),M=φ(u)|u=u%2∧u<u&2,有(N(u%1,u),φ)↓(N(u,u),φ)(N(u&1,u),φ),(N(u%1,u),φ)↓(N(u,u),φ)(N(u&1,u),φ);(N(u,u%2),φ)M(N(u,u%2),φ),则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇并于图2进程段间偏序关系图定义22.给定Petri网Σ=(S,T,F;M0),P为Σ的一个原子进程段当且仅为P在定义21下不可再分.3.3原子进程段及其偏序关系求解算法给定Petri网Σ=(S,T,F;M0),遵照定义21,分解其极小进程段,求原子进程段及其间推理规则方法如附图1所示.为了易于理解算法内容,此处以一个无界Petri网为例演示上述内容.该无界Petri网如图3所示,其中s3和s5为无界库所.按文献[7]方法求得极小进程段集BPe(Σ)={P1,P2,P3,P4,P5},如图4所示.(N(u,u),φ)后自由选择;(15)若ΓP%∩ΓP&=σ,{M%i}∩{M&j}={M…M},M[σ>M,M=φ(u),M=φ(u)|u=u%2∧u<u&2,有(N(u%1,u),φ)↓(N(u,u&2),φ)(N(u&1,u),φ);(N(u,u%2),φ)M(N(u,u%2),φ),则称(N(u%1,u%2),φ)与(N(u&1,u&2),φ)汇并于(N(u,u),φ)后冲突选择.定义21中,顺序关系表达进程段间的线性推进,冲突选择刻画进程段间的竞争,汇合关系定义进程推进的同步标识点(同步子进程段).这些关系可图示化如图2(顺序关系未表示).图中圆圈示意进程段的始末s-切.对图4给出的极小进程段,按算法1求得其原子进程段集为AP(Σ)={P1,P2,P3,P4,P5,P6},如图5所示.其推理规则集为R(Σ):{P1→P2,P1→P3,P1↓P4,P1P2,P2→P1,P2→P3,P3→P4,P3→P5,P3→P6,P4P5,P5→P6,P5↓P6,P6→P6}.原子进程段及其偏序关系是本文可达性判定的基础.Page84基于进程验证的可达性判定算法4.1算法思想通常,Petri网可达性问题形式化表述为:给定Petri网PN=(S,T,F;M0),Md由M0可达当且仅当(1)存在n-维非负整数向量犡满足Md=M0+犆犡T;(2)存在变迁序列σ,使得M0[σ>Md且#(ti/σ)=X(i).其中,σ是合法变迁引发序列,求证其存在是Petri网可达性判定的重要内容.基于进程验证的可达性判定方法中,原子进程段集及其偏序关系集是可达性判定的验证对象,但并不一定是最小对象集.算法中,我们通过求解原网状态方程解向量犡、原子进程段T-向量的线性纯整数规划问题解来选取最小验证对象集.这种最小对象验证集的选择依据是:该线性纯整数规划问题有解是可达性判定的必要非充分条件.这样,算法只需对应用纯整数规划问题求解方法(如分枝定界法)或软件(如LINGO)求得的解设计验证方法即可.以下,给出证明过程.定义23.设P1=(N[u1,u2],φ)为Σ的原子进程段,N=(B,E;G),ti∈T|{e∈E|φ(e)=ti∧(b1∈u1,b2∈u2:(b1,e)∈G+∧(e,b2)∈G+)}|称作变迁ti在P1中出现的次数,记作#(ti,P1);n维非负整数向量犡P(i)=#(ti,P1),i=1,2,…,n,称为原子进程段P1的T-向量.定义24.两个同维数向量犡和犢,关系犡犢成立当且仅当犡(i)犢(i)∧犡≠犢;关系犡犢成立当且仅当犡犢∨犡=犢.推论3.Petri网Σ的一个极小进程段P1对应的T-向量为犡P1,P1的真子进程段记为sub(P1),对应的T-向量为犡sub(P1),则犡sub(P1)犡P1.证明.设Γ(P1)=t1…tl,Γ(sub(P1))=ti…tj,Γ(sub(P1))Γ(P1)P1、sub(P1)的T-向量分别为犡P1和犡sub(P1),若有﹁(犡sub(P1)犡P1),则可能有以下3种情况:(1)犡sub(P1)=犡P1,与Γ(sub(P1))Γ(P1)矛盾.(2)犡pref(P1)>犡P1,不妨设分量k有犡pref(P1)(k)>犡P1(k),即变迁tk∈T在Γ(sub(P1))中出现次数多于Γ(P1),则Γ(sub(P1))Γ(P1),与已知条件矛盾.(3)存在分量i和j,有犡pref(P1)(i)>犡P1(i)且犡pref(P1)(j)犡P1(j),使得犡P1和犡sub(P1)不可比较.类似(2)可证.综上所述,知命题成立.引理3.给定Petri网Σ=(S,T,F;M0),原子进程段集AP(Σ),其T-向量集犢AP={犢1,…,犢l},则犢1,…,犢l在正整数域内线性无关.证明.设AP(Σ)中原子进程段为P1,P2,…,Pl.由定义21、定义23知,Pi,Pj∈AP(Σ):Pi≠Pj,其T-向量犢i、犢j在正整数域内线性不相关.若存在犢I犢AP,犢I={犢i|犢i∈犢AP},k=|犢I|(2<kl),由定义23知,有犢1>0,…,犢k>0.若存在不全为0的系数a1,a2,…,ak,使得a1犢1+a2犢2+…+ak犢k=0成立,必有某个系数ai<0,即不存在正整数域内的一组系数a1,a2,…,ak使得a1犢1+a2犢2+…+ak犢k=0成立.命题得证.推论4.给定Petri网Σ=(S,T,F;M0),原子进程段集AP(Σ),其T-向量集犢AP={犢1,…,犢l},则犢1,…,犢l在实数域内线性相关.由引理3的证明显然可得.为了保证原子进程段中任一s-切都不失去可达性判定机会,且任意标识对间进程的T-向量能够由原子进程段T-向量正整系数线性表出,引入余量犡b.定义25.给定Petri网Σ=(S,T,F;M0),目标标识Md,关联矩阵犆m×n,状态方程Md=M0+犆犡T解向量犡,原子进程段T-向量集犢AP={犢1,…,犢l},若存在n维非负整数向量犡b:(1)(犡b犡)∧(犢i∈犢AP犡b犢i);(2)犡=a1犢1+…+al犢l+al+1犡b,aj=0,1,…,j=1,2,…,l+1,则称{犢1,…,犢l,犡b}为犡的一组线性表出基,犡b称为余量.引理4.给定Petri网Σ=(S,T,F;M0),原子进程段T-向量集犢AP={犢1,…,犢l},则向量组犡b,犢1,…,犢l在正整数域内线性无关.证明.反证法.由定义25知,犢i∈犢AP,i=1,2,…,l,犡b与犢i在正整数域内线性无关.若向量组Page9犡b,犢1,…,犢l在正整数域内线性相关,即存在一组不全为零的整数c1,…,cl+1有若cl+1=0,则必有c1,…,cl不全为零,这与引理3矛盾.故cl+1≠0,有又由定义17知,犢1>0,…,犢l>0,犡b>0,则必有cick+1<0,与假设不符,原命题得证.证毕.推论5.给定Petri网Σ=(S,T,F;M0),原子进程段T-向量集犢AP={犢1,…,犢l},则犡b,犢1,…,犢k在实数域内线性相关.证明.由引理4证明显然可得.推论6.给定Petri网Σ=(S,T,F;M0),目标标识Md,原子进程段集AP(Σ),其T-向量集犢AP={犢1,…,犢l},自由余量犡b可为平凡向量.证明.若Petri网的标识对(M0,Md)间可达,对应进程P0d=(N(u0,ud),φ)可分解为则有Γ(P0d)=σ,Γ(P1)=σ1,…,Γ(Pk)=σk;表现在T-向量上,有上式与定义25中(2)对比,可知,犡b取为平凡向量.定理3.若给定Petri网Σ=(S,T,F;M0),目标标识Md,关联矩阵犆m×n,状态方程Md=M0+犆犡T的解向量犡,原子进程段T-向量集犢AP={犢1,…,犢l},原子进程段间关系集Ra(Σ),则线性不等式方程犡-a1犢1-…-al犢l0的整数解是Md由M0可达的必要条件,非充分条件.证明.设此Petri网的原子进程段集AP(Σ)={P1,…,Pl],映射关系定义如前Γ:P(Σ)→T.必要性.若Md由M0可达,则标识对(M0,Md)间必有满进程P0d=(N(u0,ud),φ),有Γ(P0d)=σ,向量犡(i)=#(ti/σ)|ti∈T满足状态方程Md=M0+犆犡T.不妨设|σ|=k,σ=t1…ti…tk,ti∈T.又,Pj∈AP(Σ):Γ(Pj)=σj;且P∈AP(Σ):u0∈P∧φ(u0)=M0,Γ(P)=σ;求σ与σ的最大匹配串,即σ1=max(pref(σ)∩sub(σ)),σ与σ1的T-向量分别为犡σ、犡σ1,有犡σ∈犢AP(Σ),犡σ1犡σ;取σ=σ-σ1,重复上一步直至σ=;它们的T-向量分别为犡σ1,犡σ2,…,犡σh,则记按上述方法求得的序列依次为σ1,σ2,…,σh,或者犡σj=犢i,犡σj∈犢AP(Σ);或者犢i∈犢AP(Σ),犡σj犢i;有犡=∑j∈{1…h}犡σj,对任意满足犡σj=犢i计数,取得向量犢i的系数ai,对任意满足犡σj犢i,取ai=0,则犡∑j∈{1…h}ai犡σj有一组整数解a1,a2,…,al.非充分性.若犡-a1犢1-…-ak犢k0有惟一一组整数解a1,a2,…,al,代入线性不等式方程得余量犡b,即取A=(a1,a2,…,al)中非零系数对应的原子进程段Pi形成待验证进程段集PX(Σ),PX(Σ)AP(Σ),若P,P∈AP(Σ)u∈P:φ(u)=M0,u∈P:φ(u)=Md,且PPX(Σ),PPX(Σ),则PX(Σ)=PX(Σ)∪{P,P}.取RX(Σ)Ra(Σ):R(Pi,Pj)∈RX(Σ)→(Pi,Pj∈PX(Σ));若不存在一个RX(Σ)上的推导序列PP,则Md由M0不可达.4.2算法描述与示例有了原子进程段集及其偏序关系集,求出线性纯整数规划问题的解,基于进程验证的可达性判定算法如图6所示.基于进程验证的可达性判定算法.输入:关联矩阵犆,初始标识M0,目的标识Md输出:可达或不可达结论1.求Md=M0+犆犡T的解向量犡;2.调用算法1,求AP(Σ)={P1…Pl},Ra(Σ),得T-向量集犢AP(Σ)={犢1…犢l};3.应用LINGO求解犡,犢1…犢l的线性不等式方程组,得犃={犃1…犃h},每一犃i为l维正整数向量;4.If犃<>null,Then{取犃i,犃=犃-{犃i}goto5}Elsegoto9;5.If犃i(j)≠0|(i=1…h)∧(j=1…l)Then取Pj形成一组待判进程集PX(Σ)={(N(uj1,uj2),φ)};6.IfP,P∈AP(Σ)且P,P∈PX(Σ)Thenifu∈P,u∈P,φ(u)=M0,φ(u)=Mdthengoto7else添加进程P和(或)P入待判定进程集PX(Σ);7.Ra(Σ)的任一规则:若其前件、后件都属于PX(Σ),则选入验证规则集RX(Σ);8.若存在RX(Σ)的推导序列PP,则合法引发序列存在,输出可达结论,停机;否则,转步3;9.输出不可达结论,停机.算法的正确性由前面分析保证,终止性由解向量与原子进程段T-向量的线性纯整数问题解的有限性而保证.下面,以图3所示的无界Petri网为例,演示此Page10算法.标识M0=[10000000],目的标识Md=[00000001].已知:给定Petri网Σ=(S,T,F;M0)如图2所示,初始问题:判定Md是否由M0可达.算法判定过程:第1步.求得满足状态方程的解向量犡=[11110110]熿0熿燄000000燀燅1=燀第2步.求得该网的原子进程段如图5所示,T-向量集为犢AP(Σ)={犢1=[00100000],犢2=[11000000],犢3=[00010000],犢4=[00001000],犢5=[00000010],犢6=[00000101]}.第3步.应用LINGO软件解线性不等式方程X-a1Y1-a2Y2-a3Y3-a4Y4-a5Y5-a6Y60.求得惟一一组整数解a1=1,a2=1,a3=1,a4=0,a5=1,a6=0,使得犡>a1Y1+a2Y2+a3Y3+a4Y4+a5Y5+a6Y6成立.第4步.依据此解选取进程段集{P1,P2,P3,P5,P6},偏序关系集{P1→P2,P1→P3,P1↓P4,P1P2,P2→P1,P2→P3,P3→P5,P3→P6,P5→P6,P5↓P6,P6→P6}.第5步.验证存在推导序列P2P1P3P5P6且u0∈P2,φ(u0)=M0,ud∈P6,φ(ud)=Md,则以解向量犡=[11110110]为发生数向量,故判定Md由M0可达.4.3时间复杂性分析算法中,可达性判定不再以单个标识作为判定对象,而是通过原子进程段形式,把若干带原子特性的s-切模块化成一个整体,进行可达性判定判断.直观上理解,这种类似状态聚合的判定思想跳过模块中若干状态判定,将带来工作量缩减.分析算法知,它的判定效率取决于原子进程段集、推理规则集求取和基于规则的推导序列验证两部分.其时间复杂度是依赖于原子进程段集规模而不是网规模.分析原子进程段集规模如下:设极小基本进程段集为P(Σ)={p1,p2,…,pk},记极小基本进程段长度l为其包含的变迁个数,则l(P(Σ))={l1,l2,…,lk}.由文献[5-8]知,在功效等价意义下,任意Petri网的极小基本进程段是有限的,设为max(l1,l2,…,lk)=h,则有1hn=|T|.若第i个极小基本进程段划分得到vi个原子进程段,则有pi={api1,api2,…,apivi},li=li1+li2+…+livi.设Petri网原子进程段集AP(Σ)={ap1,ap2,…,apq},原子进程段个数q为∑k即原子进程段集规模介于极小基本进程段集规模与网变迁集规模之间,最坏情况不会超过网中变迁集规模.5总结与展望集、原子进程段间偏序关系集的求取方法;Petri网的可达性判定问题是本领域研究的重点之一.本文分析极小基本进程段不能直接应用于可达性判定的原因,基于进程子段偏序关系分解引入原子进程段概念,并给出求取Petri网的原子进程段集、原子进程段间偏序关系集方法.其后,算法借鉴形式语言(以原子进程段间偏序关系为推理规则)中句型推导思想,以状态方程解向量、原子进程段T-向量的线性纯整数规划解为标准选取待验证原子进程段子集、偏序关系子集,验证是否存在从初始标识到目的标识的推导序列而判定可达性.本文的主要贡献在于:(1)提出原子进程段概念并给出原子进程段(2)证明Petri网的进程网系统产生的语言是Petri网可达标识对间合法变迁引发序列集的真子集;(3)证明状态方程解向量与原子进程段T-向量的纯整数规划问题解是可达性判定的必要非充分条件.分析表明,算法的复杂性依赖于原子进程段集规模,最坏情况不会超过网中变迁集规模.相比于文献[3]的判定算法,更具模块化.在一些状态可达性模块化特征明显的Petri网(如分层CPN)进行判定时,本算法能够得到较好效果.然而,本文算法未能对其时间复杂度给出严格的数学证明,序列验证中的推导方法简单.针对以上问题,今后不妨从两方面深入:(1)研究Petri网的状态空间组合问题与网规模间的数学关系;(2)研究如何应用形式文法与自动机理论中的成熟方法,设计高效的规则推理算法,提高序列验证效率.
