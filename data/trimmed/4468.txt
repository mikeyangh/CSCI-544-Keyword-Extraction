Page1隐私保护的推理机策略加密及应用张明武1),4)杨波2)王春枝1)TAKAGITsuyoshi3)1)(湖北工业大学计算机学院武汉430068)2)(陕西师范大学计算机学院西安710072)3)(九州大学工业数学研究所福冈819-0392日本)4)(中国科学院信息工程研究所信息安全国家重点实验室北京100093)摘要确定性有限自动状态机是能表示有限个状态以及在这些状态之间转移和动作等行为的数学模型.本文提出两种基于有限状态自动机策略的加密方案:第1种方案称为无消息负载方案,方案中密文关联到一有限自动机M而令牌关联到一个任意长的输入串狑,系统能在密文空间和密钥空间测试是否令牌关联的输入串可以被密文中的自动机接受.同时给出了转换到素数阶群构建的方法.第2种方案以前种方案为原语,扩展到支持消息负载保密的方案,当自动机接受输入串时,可以成功从密文中提取明文.采用双系统加密技术,在静态安全假设下证明了该方案达到标准模型下自适应语义安全性.同时给出了两种方案的性能评测.所提出的方案可应用于隐私保护的安全外包计算、网络防火墙内容过滤、模板隐私保护的DNA比对等领域,文中给出了实际应用中的具体案例.关键词有限自动机;双系统加密;隐私保护;语义安全1引言有限状态机是自动机理论和计算理论中重要工具,主要功能是描述对象在其生命周期内所经历的状态序列,以及如何响应来自外界的各种事件,它在硬件系统设计、软件工程、编译器、网络协议、计算语言、软件集成分析、网络漏洞分析等领域得到广泛的应用[1-2].一个有限状态自动机中存在有限数量的状态,每个状态可以迁移到零个或多个状态,输入字串决定执行哪个状态的迁移.有限状态自动机可以表示为一个有向图结构,可以分成确定型有限状态自动机(DeterministicFiniteAutomata,DFA)[1]与非确定型有限状态自动机(Non-deterministicFiniteAutomata,NFA)[2]两种.在确定型自动机模型中,每个状态对每个可能输入只有精确的一个转移.在非确定型自动机中,给定状态对可能的输入可以没有或存在多个转移.一个非确定有限状态自动机可以转化为确定有限状态自动机,有限状态自动机识别的语言称为正则语言.状态机的本质是对具有逻辑顺序或时序规律事件进行描述,可以用作软件程序的控制结构.但在一些应用中,采用明文有限自动机的证明,会泄露程序的流程结构,对软件保护产生不利的影响.例如,传统的编译代码中,程序在得到输入串后是以编译后的可执行代码运行,最后输出运行结果.但由于编译后的可执行程序没有加密,因此很容易被反编译并破解程序流程.函数加密[3-5]是一种灵活的加密技术,可实现细粒度的密文控制,克服了传统的基于公钥和身份加密方案的单一性,它采用灵活的策略函数定义接收者的解密能力.加密策略定义为策略函数F,而解密角色定义为属性向量狑.当接收者所持有的属性狑满足密文所关联的函数F(即F(狑)=1)时,使用其持有的密钥可以成功解密密文.事实上,公钥加密[4-6]、(层次)基于身份加密[7]、广播加密[8]、属性基加密[9-10]、隐藏向量加密[11-12]、内积加密[13-14]、空间加密[15-16]和代理加密[17]等均是函数加密的一个特例.例如,基于身份的加密方案中,策略函数表达为相等测试函数F(I,I):I=I,即加密策略与解密角色定义为简单的单射函数.广播加密方案中策略函数定义为元素与集合的包含关系,即当解密角色属于发送者所确定的广播用户集成员时可以利用其所拥有的密钥解密.在属性基加密方案中,加密策略定义为访问结构Γ而解密角色定义为属性集合S,策略函数定义为属性集满足访问结构,即Γ(S).事实上,由于任意层次深度的通用访问结构在有限域上密码技术较难构建,因此研究者通常将访问结构转化为访问树(AccessTree,AT)[9]或线性秘密共享(LinearSecretSharingScheme,LSSS)[10]等形式来描述,接收者角色描述为访问结构上一定长向量.文献[13]定义了基于通用谓词作为加密策略的方案,通过实例化内积谓词实现负载隐藏和属性隐藏的方案,内积加密可以实现包括相等测试、合取、析取、多项式比较、隐藏向量等功能.文献[16]中采用仿射空间上的仿射函数作为加密策略和解密角色,实现抗密钥加密,其中函数匹配定义为两个仿射空间存在最小不动点.文献[18]构造出在正则语言上的选择性安全函数加密,但其安全性归约基于非标准假设.文献[19]中首次基于合数阶群上的子群判定问题,构建了密文上不同功能的函数查询,如子集查询、范围查询、合取和析取查询等.文献[6]中设计一种基于有限自动机可逆理论的公钥方案,安全性基于求非线性有限自动机的弱逆的困难性和矩阵多项式的因式分解困难性基础上.与文献[6]不同之处在于,本文主要思路在于以有限自动机作为函数策略生成密文,并以满足自动机的串作为解密角色,安全性基于数论上的子群判定问题.文献[3]给出了一般意义上的函数加密模型,指出通用意义上的函数加密很难构建和证明,只能在具体可操作的函数上针对其特点进行设计.有限状态自动机可以看作一类特殊的函数,即自动机定义为一函数而作用在自动机上的输入串作为函数的输入,自动机是否接受输入串作为函数的输出,即fM(狑)=Accept(M,狑).与传统的函数加密相比,基于有限自动状态机策略的加密方案有如下优点:(1)有限状态自动机是随逻辑顺序或时序规律事件而运行的,这种动态的函数结构可以实现在密文空间状态的动态控制功能;(2)输入串是任意长的.传统的函数加密中,都假定输入属性串长度是固定的,因此限制这些方案在实际应用中的灵活性和可扩展性.Page3基于有限状态自动机策略的加密可对密文解密能力实现细粒度控制,保护密文中自动机的机密性,而解密属性串长度不受限制,极大地改进加密系统控制的灵活性、降低系统的通信代价和提高系统的计算效率,在外包计算、访问控制、隐私保护、防火墙内容过滤、数据搜索与挖掘、生物信息保护等方面有良好的应用前景[20-24].文献[25]提出适应于云数据共享环境下以有限状态推理机为代理策略的代理加密机制.文献[26]提出一种基于密钥泄漏条件下的推理机控制策略加密机制.本文首先设计一种采用有限状态自动机作为密文策略而输入串作为令牌角色的无消息负载加密方案.方案中密文关联到一个有限自动机M,令牌关联到一个任意长的输入串狑,系统能在密文空间和秘密令牌空间通过配对运算测试是否令牌关联的输入串可以被密文中的自动机接受.本文给出了该方案详细构造和安全性证明,并且给出方案在相关领域中的具体应用.同时,本文扩展第一种方案达到有消息负载的方案,当密文关联的自动机接受密钥关联的串时,可以成功从密文中提取消息明文.与其它加密方案相比,本文方案设计的困难在于:(1)有限自动机不是通用意义上的函数结构,它定义为五元组的数据结构以及在这个结构上的随输入串而变化的自动机模型,首要的关键问题是把其理论数学上的结构模型转换为密码技术可表达和运算的有限域上的模型;(2)自动机要根据不同输入串而动态的运行,这在明文空间比较容易实现,但转化在密文和秘密令牌空间来实现这种动态变迁,存在一定难度;(3)为达到自适应性安全性,方案设计和安全证明技术必须采用与之相适应的安全假设和证明框架.相对文献[26]方案,虽然本方案不能抗密钥的泄漏攻击,但本文方案效率更高.与文献[18]的非标准假设下选择性安全相比,本文方案达到自适应安全性下的自动机隐私,且密钥和密文结构更紧凑.2基础知识状态(State):指对象在其生命周期中的状况,处于某个特定状态中的对象必然会满足某些条件、执行某些动作或者是等待某些事件.事件(Event):指在时间和空间上占有一定位置,事件通常会引起自动机状态的变迁,促使状态机从一种状态切换到另一种状态.转移(Transition):指两个状态之间的一种关系,表示对象将在一个状态中执行一定的动作,并将在某个事件发生同时某个特定条件满足时进入另外一个状态.动作(Action):指状态机中可以执行的原子操作,一个动作在运行过程中不能被其他消息所中断.定义1(确定有限状态自动机,DFA).确定有限状态自动机M=(Q,Σ,δ,s0,F)定义为五元组,其中:(1)Q是非空有限的状态集合;(2)Σ是非空有限的字符集合的输入字母表;(3)δ:Q×Σ→Q是转移函数;(4)s0(∈Q)是开始状态;(5)FQ是接受状态的集合.确定有限状态自动机从起始状态s0开始,依次读入字符串,并根据给定的转移函数δ依次地转移至下一个状态.在读完该字符串后,如果该自动机停在一个属于F的接受状态,就接受该字符串,反之则拒绝该字符串.若自动机M接受串狑,记为Accept(M,狑),否则记为Reject(M,狑).本文为简化表达,记Accept(M,狑)=1表示自动机M接受串狑,Accept(M,狑)=0表示M拒绝串狑.定义2(扩展转移函数).设δ:Q×Σ→Q,这里δ(q,狑)是自动机从状态q顺序读入串狑后到达的状态.扩展转移函数的形式化递归定义满足如下两个性质:(1)δ(q,ε)=q;(2)δ(q,uσ)=δ(δ(q,u),σ),δ∈Σ&σ∈Σ定义3(转移系统).没有接受状态列表和指定开始状态的确定有限状态机叫做转移系统或半自动机.对于一个确定有限状态自动机M=(Q,Σ,δ,s0,F),如果δ(s,狑)∈F,称该自动机M接受字符串狑,否则表明该自动机拒绝字符串狑.被一个确定有限自动机M接受的语言定义为L(M)={狑∈ΣMAcceptstring狑}该语言定义为所有被接受的字符串组成的集合.为方便表达,本文使用符号Γ作为δ函数的转移集合,即t=(x,y,σ)∈Γδ(x,σ)=y.这里x是当前状态,y是下一个状态,δ是当前输入的字符.图1给出一个简单的转移函数实例,设接受状态集合F={S0,S2}.该自动机的初始状态是S0,转移函数是ti(i=1,…,6).若输入串狑是01010,则该自动机所确定的转移状态序列是S0→0S0→1Page4S1→0S1→1S2→0S2,所对应的转移函数序列是t1→t2→t3→t4→t5.经过输入串的状态转移,最后自动机停在S2状态,而S2∈F,因此该自动机接受串狑,即Accept(M,狑)=1.接受函数Accept(M,狑)用于表达基于确定有限自动机M=(Q,Σ,δ,q0,F)对串狑=(w1,w2,…,wn)的运行及输出:对于任何M,设初值r0=q0;对给定的输入序列wi(i=0,…,n-1),ri+1=δ(ri,wi+1);若rn∈F,输出1,否则输出0.即Accept(M,狑)=熿rn∈F燀显然,若串狑满足自动机M,则Accept(M,狑)=1,否则Accept(M,狑)=0.非确定有限自动机是对每个状态和输入符号对可以有多个可能的下一状态的有限状态自动机.区别于确定有限状态自动机DFA,NFA的下一个可能状态是不唯一确定的.虽然DFA与NFA有不同的定义,在形式理论中可以证明它们是等价的:对于任何给定NFA,都可以构造一个与之等价的DFA,反之亦然.DFA是非NFA的一种极限形式,并且DFA在计算能力上等价于NFA.本文所设计的加密方案中,只考虑基于确定有限自动机DFA策略的方案.3DFA策略加密体制3.1确定有限状态自动机加密体制确定有限自动机策略的加密体制中,密文对应于一个有限自动机M,而秘密令牌对应一个输入串狑,解文/令牌测试能够成功的必要条件是Accept(M,狑)=1.本文首先给出无消息负载的方案,它由4个概率性随机算法构成:L=(Setup,GenTK,Enc,Check).然后通过将该方案扩展,达到支持负载保密的确定性有限自动机策略加密L=(Setup,GenTK,Enc,Dec).定义4(确定有限状态自动机策略加密).1个确定有限状态自动机策略加密方案L包括4个概率多项式时间的算法,L=(Setup,GenTK,Enc,Check),对所有M∈DFA和w∈{0,1}.(1)(PubKey,MstKey)←Setup(1λ,Σ)(生成系统主公/密钥对)(2)Tokw←GenTK(PubKey,MstKey,狑)(创建(3)CtxM←Enc(PubKey,M)(生成有限自动机(4)0/1←Check(PubKey,CtxM,Tokw)(输出对所生成的系统公钥和主密钥,由上述算法生串狑的令牌)M的密文)关系Accept(M,狑))成的任何令牌Tokw和密文CtxM,满足(1)若Accept(M,狑)=1,则Check(PubKey,Enc(PubKey,M),GenTK(PubKey,MstKey,狑))=1(2)若Accept(M,狑)=0,则Check(PubKey,Enc(PubKey,M),GenTK(PubKey,MstKey,狑))=0即Accept(M,狑)与Check(PubKey,Enc(PubKey,M),GenTK(PubKey,MstKey,狑))在计算上是不可区分的.3.2安全性模型定义5(安全性游戏).对于β=0,1,定义一个敌手A在β上的游戏ExpLA,β(1λ):(1)初始化.运行(PubKey,MstKey)←Setup(1λ,Σ)并将PubKey发送给A;(2)询问.对i=1,…,q,A自适应地提供串狑并要求获得相应的令牌Tokwi;(3)挑战.A提交两个有限自动机(M(0),M(1))并获得对其中随机选择一个自动机的密文Enc(PubKey,M(β));(4)输出.对j=q+1,…,Q,A继续执行如前的令牌询问并获得相应令牌.为避免敌手获得挑战自动机所接受的输入串,此次询问要求Accept(M(0),狑)=Accept(M(1),狑)=0.询问结束后A输出一个比特作为对β的猜测.Page5对于β=0,1,设Wβ是敌手A输出1时的事件,定义敌手在ExpL若在ExpL定义6(有限自动状态机策略加密语义安全性).设敌手A在试验ExpL有限自动状态机的令牌询问,如果A在ExpL中所获得的优势AdvL忽略的,称有限自动状态机策略加密方案L是自适应Q-语义安全的.Pre过程,此过程中敌手A提供所需要挑战的两个有限自动机(M(0),M(1)).若敌手在这个试验游戏中所获得的优势函数输出是可忽略的,称该方案是选择性安全的.显然,选择性安全要求在系统所有参数生成前敌手就要提供挑战,这样的安全性比定义6中的适应安全性要弱.4方案构造4.1方案设计(1)Setup(1λ,Σ)系统初始化算法以一个安全参数λ和一个自动机字母表Σ作为输入,为系统生成系统级公钥PubKey和主密钥MstKey,过程如下:以安全参数λ为输入,调用合数阶双线性群生成算法生成Φ=(N=p1p2p3,G,Gt,e)←Gen(λ).这里p1,p2和p3是长度相等但不相同的素数,即对i=1,2,3,满足2λ-1pi2λ;随机选取g,z←Gp1,并对任意σ∈Σ,随机选取hσ←Gp1;随机选取α←ZN以及Gp3的随机生成元g3←Gp3;置系统级公钥PubKey=(Φ,g,z,g3,Y=e(g,g)α,σ∈Σhσ);保存系统主密钥MstKey=gα.(2)GenTK(PubKey,MstKey,狑)设狑={w1,…,w},令牌生成算法首先随机选取U,V←Gp3,s0,s1,…,s←ZN,X,Z←GTokw=(A=gs0U,(Ki,Di)其中烄(hw1)s1zs0(hw2)s2zs1…(hw)szs-烆注意:①U,V,X,Z在子群Gp3中随机选取,它们可以由生成元g3作随机的ZN中的幂指数得到.由于p1,p2和p3互素,根据中国剩余定理,∈ZN,②秘密令牌空间为G2+2g3modN≡g3modp3;性,从敌手的角度来看,一个令牌空间为G2+2G2+2.(3)Enc(PubKey,M)设确定有限自动状态机M=(Q,Σ,δ,q0,F),Q个状态为Q={q0,q1,…,qω-1},这里ω=|Q|.有限自动机M的初始状态是q0,转换函数δ定义为三元组{(xi,yi,σi)∈Q×Q×Σ}∈Γ的序列.密文生成算法执行:首先随机选取ω个元素γ0,γ1,…,γω-1←ZN,对i=0,1,…,ω-1,计算Bi=gγi,并用每个Bi关联有限自动机的状态qi;对每个ti=(xi,yi,σi)∈Γ,随机选择rti←ZN,然后计算Cti,1=zrti/Bxi,Cti,2=grti,Cti,3=Byi(hσi)rti;输密文CtxM=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F,xHx=Yγx).(4)Check(PubKey,CtxM,Tokw)设CtxM=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F,xHx=Yγx),Tokw=(A,(Ki,Di)联的有限自动机M=(Q,Σ,δ,q0,F)能接受令牌Tokw中关联串狑={w1,…,w},即Accept(M,w)=1,则存在一个+1个状态序列Bw0,Bw1,…,Bw和个状态转移t1,…,t,满足Bw0=q0,烄ti=(Bwi-1,Bwi,wi)∈Γ,i=1,…,-1烅Bw∈F,烆接下来,计算W0=e(A,B0)=e(gs0,B0)=e(g,B0)s0.然后由i=1,2,…,,通过递推的方法计算Wi=Wi-1若Accept(M,狑)=1,在状态转移结束(狑输入完成)后接受状态集F中存在qx=Bw,对应Bx满足W=e(g,Bx)s.最后验证等式若式(6)成立,输出1,否则输出0.4.2正确性与一致性在式(4)转移函数ti∈Γ中,Bwi-1对应于加密时的xi,Bwi则对应于加密时的yi,而wi则对应于σi.在加密过程中,对所有可能的转移函数ti作了盲化处理,而在解密过程中,则通过递推的方法恢复由输入串狑所决定的转移序列.解密测试时最开始的初始输入w0对应于q0,即Page6Bw0=B0,计算出对应的配对W0=e(g,B0)s0=e(g,Bw0)s0作为递推时的初始值.接下来我们考查式(5),由于TokM中所有元素组件在Gp1p3中而Ctx狑中所有组件在Gp1中,根据子群的正交性,当令牌组件和密文组件作双线性配对运算时,可以消去Gp3部分.因此Wi=Wi-1=e(g,Bwi-1)si-1e(Cti,1,Ki-1)e(Cti,3,Ki)=e(g,Bwi-1)si-1e(zrti/Bwi-1,gsi-1)e(Bwi(hwi)rti,gsi)=e(g,Bwi-1)si-1e(zrti,gsi-1)e(Bwi,gsi)e((hwi)rti,gsi)=e(Bwi,gsi)=e(g,Bwi)si考查式(6),W=e(g,Bw)s,Hx=Yγx,Bx=gγx,所以e(E,Bx)/W=e(gα+s,gγx)e(Bwi-1,gsi-1)e(grti,(hwi)si)e(grti,zsi-1)5安全性定理1[13].设N=∏m之积且N在多项式时间内不能被分解出pi,且对i∈[m],有pi>2λ.Ω=(N,G,Gt,e)是一满足双线性映射的阶为N的有限群描述,{Ai}是群G上一组随机变量,{Bi}是群Gt上一组随机变量,T0,T1是群G或Gt上的随机变量,且所涉及随机变量阶不高于t.考虑如下试验:算法A获得实例(Ω,{Ai},{Bi})以及T0和T1上随机选择一元素Tβ(β∈{0,1}),A在已有知识情况下输出对β的猜测β.算法A猜测成功的优势定义为Adv=|Pr[β=0]-Pr[β=1]|.若算法A在上述试验中最多进行了Q次操作并获得不可忽略ε大小的优势,在T0和T1独立于{Bi}∪{e(Ai,Aj)}的情况下,可以构造另一算法以ε-O(Q2t/2λ)优势分解合数N.根据定理1,在N=p1p2p3为三素数积阶的双线性群描述(Φ=(N,G,Gt,e))中,可以推导出如下推论.推论1.设g,X1∈Gp1,X2∈Gp2,X3∈Gp3,T0∈Gp1p2,T1∈Gp1,β∈{0,1},T=βT0+(1-β)T1,区分(Φ,g,X1X2,X3,T=T0)和(Φ,g,X1X2,X3,T=T1)在计算上是不可行的.推论2.设g,X1,Z1∈Gp1,X2,Y2,Z2∈Gp2,X3,Y3,Z3∈Gp3,T0=Z1Z3,T1=Z1Z2Z3,β∈{0,1},T=βT0+(1-β)T1,区分(Ω,g,X1X2,X3,Y2Y3,T=T0)和(Ω,g,X1X2,X3,Y2Y3,T=T1)在计算上是不可行的.双系统加密.双系统加密技术是Waters最先提出的实现适应性安全的基于身份的安全性证明方法[7],后来Lewko和Waters[27]将其扩展到合数阶群以实现简单的假设和固定长度密文.双系统加密核心思想是通过一系列在计算上不可区分的转换方法,将正常的挑战密文和询问秘密钥转换到半功能化状态(semi-functional),而根据双系统加密的性质,正常密钥可以解密正常或半功能化形式的密文,半功能化的密钥只能对正常密文形式的密文解密,而半功能化的秘密钥在解密半功能化密文时无法成功,其可解密优势是可忽略的.双系统加密能达到上述功能的主要原因是合数阶群存在阶是N因子的子群,且这多个子群是正交的.例如,在我们的设计的阶为N=p1p2p3的双线性群中,由于p1≠p2≠p3,对i≠j,gcd(pi,pj)=1,对G的生成元g,子群Gp1的生成元是gp2p3,Gp2的生成元是gp1p3.对任意h1∈Gp1,h2∈Gp2,设h1和h2分别是Gp1和Gp2生成元作指数a1和a2得到,即h1=(gp2p3)a1,h2=(gp1p3)a2,则系统构建中,如图2(b),令牌在Gp1p3子群,而密文在Gp1子群.为达到自适应性安全(不需要敌手在系统参数生成前提交挑战的有限自动机),本文通过Gp2子群来隐藏敌手可能存在的匹配询问.事实上,系统只公开了合数阶N及对应的群(G,Gt,e)和子群Gp1和Gp3的群元素,对子群Gp1和Gp3元素的选取可以利用其生成元作ZN上的指数运算得到.得到如下定理.定理2.g∈Gp1,r∈ZN,则gr∈Gp1.证明.r∈ZN,gr=grmodN=grmodp1p2p3.而p1,p2,p3互素,即对i≠j,gcd(pi,pj)=1,根据中国剩余定理,grmodp1p2p3=grmodp1∈Gp1.证毕.Page7定理3.设N=∏Lπ1{p1,p2,…,pL}满足gcd(π1,π2)=1,对(N,G,Gt)的子群元素gπ1∈Gπ1,gπ1π2∈Gπ1π2,则gπ1和gπ1π2在计算上是不可区分的.证明.由于双线性群只公开阶N而未公开pi,区分gπ1和gπ1gπ2等价于区分π1和π1π2.这π1和π2都是N的因子,要区分N的因子等价于N可以因式分解.根据定理3,可以得到如下两个推论.推论3.对确定性有状态机加密密文CtxM=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F,xHx=Yγx),对B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F每个组件元素对应乘以Gp2中的随机元素得到→CtxM,则→CtxM与CtxM是计算上不可区分的.推论4.对确定性有状态状态机加密令牌Tokw=(A=gs0U,(Ki,Di)牌组件元素乘以Gp2中的随机元素得到→Tokw,则→Tokw与Tokw是计算上不可区分的.所构建方案L中,秘密令牌在Gp1p3子群中而密文在Gp1子群中(Hx除外),而Gp2子群在实际方案中没有使用,主要用于安全性证明.借助于双系统加密的证明思想[7,27],半功能化的令牌和密文生成方法是在原来令牌或密文上附加随机的Gp2部分.设g2∈Gp2为Gp2的生成元.(1)半功能密文.设CtxM=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F,xHx=Yγx)为Enc算法生成的正常密文,一个半功能密文的构造:随机选取b0∈ZN,对ti∈Γ,随机选取cti,1,cti,2,cti,3∈ZN,对Bx∈F,选取bx∈ZN,输出半功能密文→CtxM=(B0gb02,(Cti,1gcti,12,Cti,2gcti,22,Cti,3gcti,32)ti∈Γ,xBxgbx2∈F,xHx=Yγx).(2)半功能令牌.设Tokw=(A=gs0U,(Ki,i=1,E=gα+sV)是GenTK算法生成的令牌,一Di)个半功能令牌构造:随机选择a,e∈ZN,对i∈[],选取ki,di∈ZN,输出半功能令牌→Tokw=(Aga(Kigki2,Digdi2)显然,使用Check算法,一个半功能令牌→Tokw检测一半功能密文→CtxM时,除了Gp1部分要匹配外,在测试过程中,由于半功能令牌和密文中都有Gp2部分,在进行配对运算时,将会产生额外的e(g2,g2)部分,而Gp3部分只在令牌中有,而在密文中没有,配对运算中可约去.在Wi迭代运算时,测试产生的Gp2部分是W0:e(g2,g2)ab0W1:e(g2,g2)θ0+ct1,1k0+ct1,3k1-ct1,2d1W:e(g2,g2)θ-1+ct,1k-1+ct,3k-ct,2di=1在计算Hx过程中,产生Gp2部分是e(g2,g2)ebx-θ=e(g2,g2)ebx-ab0-∑半功能密钥能正确测试半功能密文,要求ebx-ab0-∑该式中所有变量都是随机选取的,使得结果为0的可能性是1/p2.事实上,p2是Gp2的阶,对安全参数λ来说,2λ-1p22λ是足够安全的,即半功能令牌无法解密测试半功能密文.证明中首先把挑战密文CtxM转换为半功能化的形式→CtxM,根据推论1,这种转换在计算上是不可区分的,敌手无法感知这种转换.即若攻击者可以以不可忽略的优势ε区分这两种分布,则可以构造一算法,以攻击者计算能力作为子算法,以O(ε)的优势区分定理3的实例,其中,π1=p1,π2=p2.给出如下的定理.定理4.任何多项式时间的敌手无法区分正常形态的密文和半功能形态的密文.证明.采用反证法,假定一敌手A以不可忽略的概率优势区分正常形态的密文和半功能形态的密文,我们将利用A作为子算法,构建算法D作为模拟器解决定理3所陈述的对π1=p1和π2=p2下的不可区分性.D扮演系统模拟器并回答敌手A的询问:初始化.随机选择α,a,bi∈Z2+|Σ|σ∈Σhσ=gbi,Y=e(g,g)α.D公开双线性群描述以及公钥PubKey=(g,z,g3,Y,σ∈Σhσ).同时模拟器D保存系统主密钥MstKey=gα.询问.基于D自己选取的随机数,包括主密钥α,它可以为任何输入串狑={w1,…,w}生成令牌,Page8直接调用令牌生成算法即可.同时由于它拥有主密钥,可以回答任何敌手在定义5中安全游戏所设定的令牌询问.挑战.本阶段A两个自动机(M(0),M(1)),以便模拟器D生成挑战Enc(PubKey,M(0|1)).模拟器D随机选择随机选择β∈{0,1},设自动状态机表示为M(β)=(Q,Σ,δ,q0,F),其中Q个状态集合是Q={q0,q1,…,qω-1}(初始状态是q0),自动机M(β)的转换函数δ定义为{(xi,yi,σi)∈Q×Q×Σ}∈Γ的序列.D随机选取γ0,γ1,…,γω-1←ZN,计算Bi=Tγi,这里T是定理3中判定挑战(T∈Gπ1π2或T∈Gπ1).对自动机的转换函数ti=(xi,yi,σi),D采用递推方式执行:随机选取rti←ZN,计算Cti,1=Tarti/Bxi,Cti,2=Trti,Cti,3=ByiTrtibσi.然后D对M(β)的结束状态集F中每个元素Bx∈F,计算Hx=e(gα,T)γx.最后输出挑战密文CtxM(β)=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈FHx)在输出阶段,敌手A以β作为对挑战中的随机抛币β的猜测.D以相同的输出β作为对定理3中输出元素判定的猜测:β=0则T∈Gπ1,β=1则T∈Gπ1π2.上述输出中,若T∈Gp1,此时挑战密文CtxM(β)中没有子群Gp2的任何元素,因此是正常形态的密文.若T=gugv元,v≠0modp2(否则T∈Gp1),根据中国剩余定理,CtxM(β)中所有元素模p1不为0,即CtxM(β)是半功能化密文.因此若敌手可以区分一个正常形态的密文和半功能化形态的密文,则我们可以以相同的优势攻击定理3所证明计算不可区分的子群判定难.因此任何多项式时间的敌手是无法区分正常形态密文和半功能形态密文的.接下来把询问令牌转换为半功能化形式.设敌手在安全性游戏中共进行了Q次令牌询问.对1jQ,应答秘密令牌询问如下:对前j-1个令牌用半功能形式的令牌→Tok狑作应答,对j+1以后的令牌用正常形式令牌Tok狑回答,对第j个秘密令牌,用安全推论4的挑战作应答,即把Tokw中所有的g用定理4中的挑战输出T来代替.Tokw=(A=Ts0U,(Ki,Di)烄(hw1)s1zs0(hw2)s2zs1…(hw)szs-烆显然,若T=Z1Z3,则第j个令牌是正常形态的,若T=Z1Z2Z3则是半功能化的.采用定理4的证明,易证令牌由正常形态转换为半功能化形态时是不经意的,敌手无法在多项式时间的概率上获得这种转换的优势.图2(a)描述本方案中3个子群的正交性,图2(b)显示构造方案中密文和密钥所利用的子群.在定理4中的挑战密文生成过程中,用X1X2代替原来加密算法中的g,即Bi=(X1X2)γi,Cti,2=(X1X2)rti.显然挑战密文是半功能化的.若敌手可以通过已知询问的令牌来成功测试挑战密文,借助定理4的方法,我们可以利用敌手的输出来解决难题推论2.因此对所有询问的j个令牌1jQ,都无法成功测试挑战密文.在令牌进行半功能变化过程中,当j=0时,所有询问的令牌是正常形态的,当j=Q时,所有的询问秘密令牌都是半功能的,此时挑战密文也是半功能的.对于j=1,…,Q的每一次令牌提取,根据推论4,把一个正常令牌改变成半功能化形态时敌手在计算上是不可区分的.根据推论4,即使敌手询问了Q个令牌,仍不能成功测试一个挑战密文.而挑战密文和询问令牌都已是半功能化,根据双系统加密性质,半功能化令牌无法获得半功能密文任何信息,因此敌手询问的令牌无法获得正常形态的挑战密文信息.方案得证.6应用实例6.1安全外包计算现有的外包计算假定所要计算的目标或算法是不需要保密的,外包服务器通过其强大的计算能力为请求服务提供计算能力.如果需要计算的代码或算法具有隐私性,如生物模板匹配涉及用户的指纹、DNA或其它私密信息,信用卡支付涉及用户的帐号及相关隐私信息等,此时外包计算面临很大的隐私泄露风险.将设计的方案稍作修改,采用加密代码的方法Page9可以有效地应用于安全外包计算中.实现如下:首先用户把外包计算程序转换为等价表达的有限自动机M,然后对该自动机进行加密生成CtxM并提供给外包服务器.此时由于程序代码是经过加密处理的,即使是外包服务器也无法从密文中获知有关外包程序M的信息.然后用户将程序所需的输入狑生成一个令牌Tok狑并提供给外包服务器.外包服务器通过调用测试算法计算和输出运行结果.系统运行如图3(b)所示.事实上,Check算法可以作适当改进,达到输出运行结果(自动机运行结束后停止在集合F中的状态)而非简单的布尔结果,在第7.1节中讨论这种扩展.6.2防火墙内容过滤现有的防火墙过滤技术引入有限自动机来进行内容过滤,但由于过滤规则是以明文公式规则形式保存在防火墙服务器中,容易被攻击者识别后绕开过滤规则从而达到穿透防火墙的目的.采用本文提出的有限自动机策略加密技术,自动机过滤规则通过加密以密文的形式保存,即便攻击者获得这个密文形式的过滤规则,仍无法从中获得有关自动机的有用信息.6.3模板隐私保护的DNA比对DNA是个人敏感信息,需要采用一定的技术手段提供隐私保障.在基于网络的DNA比对时,一方面我们不能直接把DNA串以明文的形式在网络上提供给DNA匹配模板,同时要求匹配模板也需要保密,这对开放网络平台的DNA比对提出挑战.采用有限自动机加密技术,可以把DNA匹配模板加密生成密文并公开给用户在用户端进行比对,从而实现具有隐私的DNA比对.7扩展与讨论7.1带负载的确定有限状态机策略加密本节我们将讨论如何将无负载消息的方案L=(Setup,GenTK,Enc,Check)扩展到可以保护消息机密性的基于确定性有限状态机加密L=(Setup,GenKey,Enc,Dec).L方案要求加密密文中隐藏负载消息m,当Accept(M,w)=1时用秘密令牌Tok狑能解密密文CtxM并恢复消息m.扩展方案采用方案L作为核心模块并作适当扩展,具体如下:(1)L.Setup(1λ,Σ)该算法与L.Setup基本相同,唯一区别在于在此算法中要增加定义消息明文空间m∈Gt,并将其作为系统主公钥的一部分公开;(2)L.GenKey(PubKey,MstKey,w)该算法与L.GenTK相同;(3)L.Enc(PubKey,M,m)与L.Enc相比较,本算法输入参数增加消息明文m∈Gt.加密过程中,该算法调用L.Enc生成有限机密文CtxM=(B0,(Cti,1,Cti,2,Cti,3)ti∈Γ,xBx∈F,xHx=Yγx),然后把消息m附在Hx上,即置Hx=m·Yγx,其它密文组件保持不变.(4)L.Dec(PubKey,CtxM,Tokw)解密算法与L.Check基本相同,只是将L.Check中的测试等式(6)修改为事实上,算法L可以看作是L的一个特例:L中的消息空间定义为Gt上的单位元,即m=1Gt.7.2进一步讨论一般来讲,相同安全级别的双线性群构造中,合数阶群中双线性对的运算代价要比在素数阶群中大.为提高系统效率,一是可以采用文献[28]中提高双线性对运算效率的方法,另外也可以采用Freeman[29]和Lewko[30]所提出的转换方法,将基于合数阶群的构建方案转换为素数阶的构造.事实上,安全性证明中利用的是合数阶群的子群正交性来达到自适应安全.这里我们给出在多个素数阶群中构造出正交子群的方法,利用该性质可将合数阶的方案转换为素数阶方案L.定义7(可消去双线性映射).设G,H是两个阶为素数p的有限乘法群,珋e是双线性映射满足珋e:G×H→Gt.对G的子群G1,G2,G3和H的子群H1,H2,H3,即G=G1×G2×G3,H=H1×H2×H3.对任意gi∈Gi,hj∈Hj,若下面性质满足,则称珋e是具有可消去的说明.G可以看成三个子群构成.若G=H,称该双线性映射为对称群的可消去映射.显然,可消去双线性群具有合数阶双线性群的性质.Page10的双线性群(p,G,H,Gt,e)满足e:G×H→Gt;给出该可消去双线性群的具体构造:(1)以安全参数λ作为输入,生成阶是素数p(2)定义G=珚G3,珨H=H3以及珚Gt=Gt;(3)随机选取生成元g1,g3,g3∈G,h1,h2,h3∈H;(4)随机选择a,b,c,x,y,z∈Zp,满足1ax1by1cz(5)定义子群珚G1=〈(g1,ga珚G3=〈(g1,gc珨H2=〈(hcx-az珨H3=〈(hbx-ay(6)g1∈G1,g2∈G2,g3∈G3,h1∈H1,h2∈H2,h3∈H3,定义运算表1方案性能方案群阶Lp1p2p3(|Σ|+3)|G|+|Gt|(2+2)|G|(|Γ|+|F|+1)|G|+|Γ||Gt|(3+1)Pr+1Mul无Lp1p2p3(|Σ|+3)|G|+|Gt|(2+2)|G|(|Γ|+|F|+1)|G|+|Γ||Gt|(3+1)Pr+2Mul有Lp(6|Σ|+18)|G|+|Gt|(6+6)|G|(3|Γ|+3|F|+3)|G|+|Γ||Gt|(3+1)Pr+1Mul无注:|Σ|:DFA中字母表长度;:DFA输入串狑长度;|Γ|:DFA转换函数数量;|F|:接受状态集合大小;Pr:一个双线性对运算时间;Mul:一个Gt乘法运算时间;|G|:一个群G元素长度;|Gt|:一个群Gt元素长度;:素数阶中的对运算比合数阶的运算速度要快.实际应用中,L和L可用于隐私保护的数据库查询、隐私保护的防火墙过滤等应用场合,而含有负载消息的方案L可应用于关键字可搜索的机密文档传输、隐私保护的垃圾邮件过滤等场合.8小结本文提出一种以确定有限自动机DFA作为加密策略、以DFA可接受的串作为解密角色的加密技术,可以有效地应用于隐私保护的推导和计算的应用场合.在给出系统模型和安全性定义的基础上,本文构建了两个具体的方案:无负载的DFA加密方案和有负载的DFA加密方案,并给出了转换为素数阶群实现的一般方法.在双系统加密技术下,证明了所提出的方案达到自适应安全性.并给出了本文方案在安全外包计算和隐私保护的防火墙内容过滤方面的具体应用.接下来的工作主要体现在两方面:一是扩展有限自动机的表达能力,如达到非确定(p,G,珚G1,珚G2,珚G3,H,珨H1,珨H2,珨H3,珚Gt,珋e).(7)输出群描述说明.①式(14)前一行列式用于保证子群珚Gi(1i3)之间不线性相关,后一行列式保证珨Hi之间不线性相关.②利用该群来构造(4.1节)方案的方法:令G=H,将珚G1对应于合数阶群的子群Gp1,珚G2对应于子群Gp2和珚G3对应于子群Gp3,然后将方案中相应子群中的元素从可取消子群中选取,而方案的思路不变.7.3性能接下来我们给出本文方案的性能分析.方案L,L和L分别对应本文4.1节,7.1节和7.2节所提出的方案.表1描述所提出方案的性能参数.L和L在合数阶群中构造,L在素数阶群中构造,素数阶中的双线性对的计算效率高于合数阶,因此计算性能上L要高于前二者.L扩展L达到负载消息隐藏,L可以看作是一种特殊的L方案,即其消息m∈1Gt.性有限自动机或图灵机的加密方案,可以有效地实现对可执行代码的保护,避免被反编译或逆向工程而导致程序及算法思路泄露;二是进一步研究提高系统效率的方法.
