Page1云计算系统相空间分析模型及仿真研究王鹏1)张磊1)任超1)郭又铭2),3)1)(成都信息工程学院并行计算实验室成都610225)2)(中国科学院成都计算机应用研究所成都610041)3)(中国科学院研究生院北京100049)摘要针对云计算系统具有海量节点和节点间高耦合性的特点,提出了将云计算系统投影到参数相空间,将节点参数的变化转化为参数相空间中点的运动,利用海量节点在参数相空间的运动与热力学运动的相似性定义来分析云计算系统在相空间上的广义热力学参数,并在参数相空间的基础上进一步定义云计算系统的动量相空间,建立云计算相空间分析方法的基本理论模型.依据该模型建立了相空间调度算法,通过仿真对比实验验证了相空间分析模型对云计算系统工作状态的分析表述能力和相空间调度算法的有效性.相空间调度算法能使云计算系统在参数相空间中保持低熵的均衡状态.关键词云计算;参数相空间;动量相空间;相空间调度算法;广义热力学参数1引言云计算系统通过整合大量服务器的计算和存储等资源,形成一个可弹性化分配的资源池提供给用户[1-2].由于云计算系统中存在着频繁的计算迁移、存储迁移、计算备份、存储备份、节点失效处理等节点间的高耦合性操作使云计算系统成为一种高耦合的集群系统[3],这一点云计算数据中心与传统数据中心有很大的不同,传统数据中心服务器之间的逻辑耦合性较低,服务器只是在物理上被放在一起,这种情况下获得数据中心的整体工作态势并没有太大的意义,而云计算数据中心由于服务器的强耦合性同时又是一个统一的资源池,其更关心系统的整体工作态势.云计算系统节点的海量性和节点间的高耦合性为分析云计算系统架构和模型带来了很大的困难,找到一种能有效描述云计算系统整体工作态势的理论模型对云计算技术的发展具有重要的意义.近年来对云计算系统的架构和模型的研究已成为了一个热门研究领域,谷歌公司提出了以MapReduce为代表的云计算分布式处理模型[4],其它一些企业和研究者也相继提出了自己的云计算模型[5-8],但目前缺乏一种能有效地反映云计算系统海量节点和高耦合特征的云计算分析模型来支持云计算架构和模型的研究.相空间在数学与物理学中,是一个用来表示系统所有可能状态的空间;系统每个可能的状态都有对应的相空间的点.借相空间这一思路来表示云计算系统的工作状态时,云计算系统中的每一台服务器节点对应于相空间上的一个点,点的位置就描述了该服务器的当前工作状态,点的运动就描述服务器参数的变化,相空间投影方法给云计算系统的仿真,调度算法的设计、分析提供了一种新的视图,使我们能从整体上深刻地观察系统的工作状态.同时资源调度和负载均衡是云计算和集群系统研究中的传统话题[9-10],各类均衡算法层出不穷,但根据调度策略的不同,现有的均衡算法大致可以归为两类:静态负载均衡算法和动态负载均衡算法.静态负载均衡算法具有开销小、实现简单等[11-12]特点,一度曾成为关注的焦点,但由于存在不考虑各节点服务器的实际负载情况、灵活性差等缺点而逐渐被动态负载均衡算法所取代.目前,多数的动态负载均衡算法均是基于静态负载均衡算法发展而来,如文献[12]阐述了静态均衡算法的优缺点,并在先来先服务调度算法(FCFS)基础上提出了一种新的动态负载均衡算法,实验结果显示该算法性能要明显优于静态算法;文献[13]在回填调度算法的基础上,采用限时动态规划策略,提出了基于时间范围内的动态规划回填调度算法.然而,近年来随着能量、熵、相空间、量子等物理手段[14-16]相继进入算法研究者们的视野,一些研究者也开始利用这些手段来解决资源调度和负载均衡问题.孙宏元等人[17]给出了并行计算熵的概念,并在此基础上建立同构集群负载均衡算法.该算法通过设立并行计算熵值的阈值,用来调整节点间负载的不均衡.该算法强调均衡算法中的任务动态迁移,适合于大计算量并发任务的高性能集群系统,而本文研究的内容更倾向于面向小计算量海量并发任务的瘦服务器集群系统.董静宜等人[18]研究了云计算系统状态变化与能量、熵之间的内在联系,该方法主要用于对云计算系统工作状态进行整体评估,无法直接对系统资源的调度分配起到指引作用.云计算系统是一种海量节点条件下的高耦合系统,这就为云计算系统分析模型理论和调度算法的设计提出了新的要求,寻找一种适合云计算系统的分析模型并建立相应的资源调度算法框架变得非常迫切,相空间分析方法也有望成为建立新的调度算法的一种新思路.本文将海量节点云计算系统向相空间映射,建立云计算系统相空间分析模型,提出基于相空间分析模型的云计算系统资源调度的基础算法,并利用相空间仿真模型对调度算法进行了对比分析,证实相空间分析模型对云计算系统的建模能力和分析表述能力.2云计算系统相空间分析模型的建立云计算系统由大量高耦合的服务器节点构成,如果直接对每台服务器进行观察分析我们将无法了解系统的整体运行状态,从而无法对系统资源进行有效的调度和分析.本节我们对云计算系统的参数相空间投影及动量相空间投影进行研究.2.1云计算系统在参数相空间的投影分析模型我们发现,当云计算服务器节点的数量到达一定规模后,单个服务器的参数(如CPU占用率和内存占用率等)与大量服务器集群将形成明显的微观和宏观的区别,这种区别在相空间中能被更方便地描述和分析,特别是采用热力学模型后,为具有海量节点的高耦合云计算系统找到了一种在相空间上的Page3理论描述工具.定义1.由服务器的某两个或多个参数为广义坐标轴所形成的二维或多维空间称为云计算系统的参数相空间.利用相空间投影一个有m台服务器的云计算系统在做两个参数投影时就可以用二维相空间上的点集A来表示:A={(xi,yi):im,xi1,yi1},其中,xi,yi为归一化服务器参数.如果将每台服务器的参数投影到以各参数为广义坐标的参数相空间上,服务器参数的变化过程就转变为参数相空间上点的运动过程,这一映射变换将云计算系统转变为动力学系统来进行研究.通过对比可以发现,云计算系统在参数相空间上大量的节点运动与热力学系统大量的气体分子运动相对应,同时节点间相互耦合的关系与热力学中气体分子之间复杂的相互作用力相对应,利用这一对应关系可以采用热力学中有明确物理意义的宏观量和微观量来对云计算系统的工作状态进行描述、分析和控制[19].由于云计算系统不是实际的热力学系统,所以我们对广义热力学参数作如下定义.定义2.云计算系统参数相空间投影中定义的具有明确物理意义的物理量称为广义热力学参数.广义热力学参数是在参数相空间分析云计算系统工作状态及研究调度算法作用效果的重要工具,通过广义热力学参数建立单个服务器节点参数相空间状态与云计算系统的联系,而且可以用来构造广义热力学参数调度算法的一些判据.定义3.相空间上服务器投影点每次运动平均距离称为广义平均自由程.平均自由程与负载请求有关,外部负载请求的综合负载越大,服务器在相空间的平均自由程越大,平均自由程大的系统资源调度的难度会变大.从热力学意义上讲云计算系统在参数相空间中可以被认为是一种与外界有能量和物质交换的非孤立热力学系统.热力学系统一般不关心单个分子的运动状态,而是关心由大量分子相互作用后形成的整体运动情况,因此在参数相空间中我们就能对系统的整体工作状态进行观察和分析.2.1.1云计算系统参数相空间广义温度的计算方法在热力学系统中温度是一个重要的热力学参数,从微观上看,温度与分子运动的平均速度有关,温度越高的系统趋向系统平衡态的趋势越强,而保持系统处于非平衡态越难.依据热力学知识可以采用云计算系统参数相空间点运动的平均速度定义云计算系统在参数相空间的广义温度.假设外部对云计算系统只有两个负载请求参数输入ai,bi,单位时间内有l次负载请求,每次请求使服务器投影点在参数相空间的运动距离si=a2i+b2槡i,单位时间内外部请求造成的参数相空间运动的总距离s=∑l输入影响下的平均速度变化Δv=s于热力学中的环境温度.平均来看m台服务器单位时间内在外界负载在同一个单位时间内服务器所有投影点在相空间上由于释放负载而产生的运动平均速度v-为v-=∑m其中(ait,bit),(ai(t-1),bi(t-1))分别为第i台服务器在相空间中t时刻和t-1时刻由于负载释放而产生的两次坐标变化采样.v-对应于热力学中的内部温度.Δv使系统产生的速度方向在参数相空间上是向右上角顶点方向的,v-使系统产生的速度方向在参数相空间上是向原点方向的.当环境温度大于内部温度时(Δv>v-),根据热力学中热传导定理,系统整体温度就会升高,由于外部负载请求量大于内部负载释放量,系统整体负载就会逐步增大;当环境温度小于内部温度时(Δv<v-),系统整体温度就会降低,由于外部负载请求量小于内部负载释放量,系统整体负载就会逐步减小.Δv是系统温度的最终决定因素.如果我们把单位时间内云计算系统的工作状态分为负载分配和负载释放两个过程,那么单位时间内云计算系统总平均速度是这两个速度分量之和,所以这一时刻系统的总平均速度为从大的系统工作时间跨度来看每一个外部负载请求都会在某一时刻完成并被系统所释放,在忽略负载占用时间的情况下有云计算系统参数相空间投影点的速度守衡定理.定理1.所有时刻系统由外部负载请求引起的速度变化之和等于系统负载释放所引起的速度变Page4化之和.定义如下:这里将云计算系统处于广义绝对零度时的状态广义绝对零度定义:云计算系统无任何外部负载请求时,其广义温度将趋近于零度珚V=0.负载任务的释放是逐步完成的,当系统无任何外部负载请求时,系统的降温过程也是逐步完成的,并最终变为零度.由于温度表达的是分子运动的平均速度,所以广义温度为系统总平均速度的函数,即T=f(珚V),由于我们能准确计算总平均速度,简单的处理就可以将总平均速度作为广义温度的值.在实际云计算系统和仿真系统中云计算系统的广义温度可以采用计算单位时间内在相空间采样所有服务器投影点运动的平均速度作为广义温度的值,即T=∑m其中(xit,yit),(xi(t-1),yi(t-1))分别为第i台服务器在相空间中t时刻和t-1时刻的两次坐标采样.云计算系统的平均自由程越大,会造成广义温度升高,使调度更加困难.2.1.2云计算系统参数相空间广义归一化熵的计对云计算系统进行相空间分析需要用到另外一个广义热力学参数:广义归一化熵.广义归一化熵可以描述系统当前偏离平衡态的程度,这一点跟热力学中的定义十分相像,一个负载均衡较好的云计算系统其广义归一化熵值应该相对较小.为了方便比较,我们将熵值进行了归一化形成广义归一化熵.熵S在热力学中的定义如下:其中,k为玻尔兹曼常数,Ω为微观状态数.S1与系统在平衡态时的熵值S2的比值.我们将广义归一化熵定义为系统当前的熵值其中,Ω1是系统当前的微观状态数,Ω2为系统在平衡态时的微观状态数.云计算系统广义归一化熵的近似计算方法如下:假设需要分析的云计算节点数为m台服务器,我们将参数相空间划分为一个n×n的网格,m台服务器的当前工作参数映射到参数相空间必然会落入n×n的网格中,在平衡态时m台服务器会以随机的方式落入n×n个网格中,而在远离平衡态时m台服务器会落入l个网格中,这时1ln×n,如图1所示,图1(a)为平衡态时服务器参数在参数相空间的分布图,图1(b)为非平衡态时服务器参数在参数相空间的分布图.平衡态时m台服务器的服务器参数落入n×n个网格的状态数Ω2=(n×n)m;在非平衡态时我们近似认为m台服务器的服务器参数只会落入l个网格内,状态数Ω1=lm.所以当一个有m台服务器的云计算的服务器参数在参数相空间中只落入了l个网格时,系统的广义归一化熵可以得到由于1ln×n,所以广义归一化熵的取值范围为[0,1].当l=1时广义归一化熵为0,这时服务器参数全部落入一个网格内,表明系统远离平衡态,处于理想的均衡状态,当l=n×n时广义归一化熵为1,这时服务器参数随机分布于参数相空间,表明系统达到平衡态,处于非常不理想的均衡状态.通常系统往往处于这两种极端情况之间,系统的广义归一化熵越高表明系统当前均衡情况越不理想,广义归一化熵达到1时系统完全处于不均衡状态.广义归一化熵是在参数相空间评估分析资源调度算法作用效果的重要参数,一个资源负载均衡良好的云计算系统的参数相空间投影呈现出低熵的特点,即参数相空间投影点远离平衡态聚集在一个相对较小的参数相空间区域.实际计算中可以调整网格的密度获得不同的广义归一化熵近似值,一般来说服务器数量较多时可以用较密的网格,服务器数量较少时可以减少网格的密度.由于熵是一个统计量通常我们在网格划分时要使m>n×n,这样才能保证统计的有效性,同时在服务器节点个数太小时,如只有几个节点的情况Page5时,广义归一化熵的参考价值就不大了.2.1.3云计算系统参数相空间投影点重心的计算参数相空间投影点的重心位置是判断系统整体负载情况和建立系统调度策略的重要参数,假设服务器的总数为m,服务器参数的相空间投影(暂时只考虑两个参数,多个参数计算方法相似)为(xi,yi),其中im,t时刻所有服务器投影点的重心位置为G点,坐标为(x0,y0).为了计算重心方便,我们可以将这个二维的参数相空间分为n×n个网格作为计算重心的质量微元,每个网格的中心坐标为(xj,yl),将服务器的台数作为等效总质量,那系统的总质量为m,统计参数相空间中落入每个网格(xj,yl)内的服务器投影点的数目为mj,l,那么每个质量微元的等效质量就是mj,l.此时参数相空间重心的坐标G(x0,y0)计算公式如下:当n→能获得准确的重心位置,此时重心坐标计算公式变为根据计算结果我们可以得出结论1.结论1.云计算系统参数相空间投影的重心坐图2二维和三维子相空间划分图在相空间调度算法中最优子相空间是我们进行负载分配的主要区域,在实际系统运行时可能会出现这一区域节点被分配完的情况,所以需要对这一子空间投影点分布情况进行分析.在海量节点情况标就是由被投影的所有服务器工作状态参数的平均值构成.根据前面对广义热力学参数的定义,云计算系统参数相空间上的重心也可以称为广义重心,以区别于实际物体的重心.由于系统负载的平均值是随时间变化的,所以重心的位置在云计算系统的运行过程中也会不断地变化,本文的相空间调度算法就是以重心的当前位置作为服务器负载的重要分割点.2.1.4参数相空间中以重心为中心的子相空间划分以参数相空间投影点的重心为中心,可以将参数相空间划分成多个子相空间.通过重心坐标G(x0,…,y0,z0)向每一个坐标轴做垂直截面,最终将得到2n个区域,我们统称这些区域为子相空间.其中图2(a)和图2(b)分别表示以重心为中心的二维子相空间划分图和三维子相空间划分图.根据计算重心坐标的公式,我们知道这其中必然有一个子相空间内任意点的坐标(x,…,y,z)满足从服务器的负载情况来分析,这个子相空间内的服务器负载相对较低,称之为最优子相空间.在设计调度算法时可以优先考虑从这个子相空间分配服务器.同理子相空间中也必然存在一个空间坐标(x,…,y,z)满足条件间,落入这个空间的服务器负载相对较高,因此在设计调度算法时一般就不再考虑将属于这个空间的服务器对外进行分配.下可以有如下的参考性的结论.结论2.在海量节点云计算系统向n维参数相空间投影时,最优子相空间不出现投影点的事件为小概率事件.Page6证明.根据前面的求证,n维的参数相空间,通过重心可以划分成2n个子相空间,那么任一个服务器的投影点不出现在最优子相空间的概率为1-12n,m台服务器的投影点均不出现在最优子相空间的概率为1-1考虑到云计算系统中的节点个数是非常大的,所以我们可以设m1,且mn,则有1-1即m个服务器的投影点均不出现在最优子相空间的事件为小概率事件.例如当n=2,m=1000时,服务器投影点不出现在最优子相空间概率只有1.15×10-125.结论2表明调度系统在海量节点情况下通常可以很大的概率从最优子相空间找到相对负载较轻的节点分配给外部负载请求.结论2的成立为我们在设计相空间调度算法时只考虑从最优子相空间分配服务器提供了理论依据.而在最优子相空间中我们则依据服务器投影与重心的距离作为分配优先队列的排序依据,在最优子相空间中离重心越远的节点综合负载越低,在负载分配时优先进行分配.2.2云计算系统在动量相空间的投影分析模型仿真分析时我们需要对系统的静态和动态工作状态进行全面地分析,云计算系统投影到参数相空间只能有效地反映系统当前工作状态的快照,即系统的静态工作状况,系统的动态特征需要结合广义热力学参数才能判断,如果以云计算中服务器在参数相空间中的广义归一化动量为纵轴和广义归一化位置作为横轴建立投影,就能在这一投影空间上直接反映系统的动态工作状态.为区别本文中的参数相空间我们定义动量相空间:定义4.以广义归一化动量和广义归一化位置为广义坐标轴所形成的二维空间称为云计算系统的动量相空间.物理学中的动量的定义为p=mv,对于同质服务器构成的云计算系统可以设m=1,其中服务器的速度可以单位时间内服务器在参数相空间移动的距离为速度v的取值依据,并通过除以参数相空间内最大可能的移动距离槡2将速度归一化(因为参数相空间是归一化的相空间,所以对角线距离是投影点的最大可能移动距离),所以云计算服务器的广义归一化动量可以写为pi=vi单位时间内在参数相空间中的移动距离.第i个服务器的广义归一化位置xi=di务器在参数相空间的投影到当前重心的距离.云计算系统在动量相空间中的点集B可以描述如下:B=(xi,pi):im,xi=di3云计算系统的相空间调度算法由于云计算相空间分析模型具有直观深刻的特点,我们提出一种云计算系统的相空间调度算法,这一算法也是后面仿真实验中的算法对比实例.相空间调度算法的思想是:根据服务器工作状态参数构建参数相空间,将云计算系统中的所有服务器节点投影到参数相空间;求出投影的重心位置和找到最优子相空间,并对最优子相空间中的节点形成节点分配队列;接收外来负载请求任务,形成任务分配队列;将节点分配队列和任务分配队列进行匹配分配,如果节点分配队列中的节点个数少于任务分配队列中的任务个数,将节点分配队列中的节点分配完毕后,重新计算重心,进入下一个分配循环,直到将所有的任务分配完毕.基本相空间调度算法的实现步骤如下:1.确定映射的工作状态参数个数即参数相空间的维数n,构建相应的参数相空间.2.将云计算系统中的所有节点投影到参数相空间中.3.计算当前参数相空间投影的重心位置G(x0,…,y0,z0).4.对重心位置与系统设定的临界值进行比较,如果重心位置超过了系统临界值,系统开始负载报警,通过等待任务的不断释放,取消报警后重新跳转到步3,否则执行下一步.5.将参数相空间划分成2n个子相空间,并标出最优子相空间和最差子相空间,从而确定处于最优子相空间中的所有投影点.6.计算处于最优子相空间中所有投影点与重心的距离di,按di值由大到小形成待分配节点优先队列load_queue,di大的节点将被优先分配给负载请求使用,同时对所有待分配的任务形成任务分配优先队列task_queue,该请求按时间顺序进行排列,先进先出.7.对task_queue队列和load_queue队列中的任务和节点进行依次配对,直到load_queue被分配完毕,跳转到步3.相空间调度算法的几点说明:(1)task_queue队列的大小在算法实现时应设定得较大,以作为请求任务的缓冲区使用,当某段时间内任务请求压力很大,调度系统无法及时处理时,相关的任务信息应在task_queue中进行缓存,避免Page7系统对请求任务的拒绝.(2)相空间调度算法在服务器节点数量比较少的情况下,如果单位时间内的并发任务请求数超过了临界值,最优子相空间会出现无节点可分配的现象.通过分析我们发现,造成这一问题的原因是由于当m较小时,云计算系统中m个节点均不出现在最优子相空间的概率1-1的规律.因此在算法设计中,当出现这种情况时,我们将重心G(x,y)的位置向顶点D(1,1)方向进行平移,直到可分配的节点满足要求为止,从而保证系统有足够的节点进行负载分配.(3)相空间调度算法在实际云计算系统应用中是不能预先知道负载请求的资源占用率及占用时间的,但能获得服务器当前的资源占用情况,所以算法采取了最优子空间中服务器距重心的距离di作为负载分配的优先依据,即di越大越优先分配.(4)相空间调度算法只是一个基本算法框架并未对算法进行细节的优化,该算法结合相空间模型能有很大的优化能力.4云计算系统相空间分析模型及调度算法的仿真研究4.1仿真模型及参数描述(1)云计算系统的相空间仿真模型云计算系统在相空间模型下,一台服务器的工作状态可以用一个状态参数向量来表述(参数1,参数2,参数3,…),如(CPU占用率0.3,内存占用率0.2,连接数占用率0.1,…),参数向量的维数就对应于相空间的维数,服务器参数向量投影到相应的相空间,向量终点在相空间的位置就代表了服务器当前表1相空间算法、轮询算法、最小负载优先算法和动态反馈负载均衡算法的仿真结果比较节点数任务请求占用率时间片采样位置20000/s0~0.011~10100100020000/s0~0.011~1010010001000最小负载优先算法20000/s0~0.011~101001000动态反馈负载均衡算法20000/s0~0.011~101001600/s0~0.011~101001001600/s0~0.011~10100100100最小负载优先算法1600/s0~0.011~10100100动态反馈负载均衡算法1600/s0~0.011~1010016/s0~11~1010010016/s0~11~1010010016/s0~11~10100100最小负载优先算法100动态反馈负载均衡算法16/s0~11~10100的工作状态,向量的大小代表了服务器多个工作状态所形成的综合负载情况.服务器参数向量终点随时间的变化在相空间就转变为质点的运动.(2)外部负载请求的仿真模型采用向量模型向相空间投影来描述云计算系统的方法为我们建立外部负载请求的仿真提供了方便,同样外部负载请求也是采用负载参数向量来描述,只是多了一个时间片长度参数,这个参数描述的是负载请求占用服务器的时间长度,该时间片长度是一个相对的单位时间长度,持续时长不采用绝对时间是为了在进行仿真时实现在普通实验计算机上模拟单位时间内大量负载请求的生成和处理.每一个单位时间长度内发出的负载请求次数模拟系统的并发访问压力,每经过一个单位时间,负载的时间片就减少1.负载参数向量中的各个分量的取值范围的数值分布规律可以反映不同的外部应用程序资源需求特点.以CPU占用率为例,低占用率高并发请求可以描述大部分Web上的计算请求,高占用率低并发请求可以描述部分数值计算请求.因此通过对不同参数分量的取值范围及并发数进行调整可以实现对不同外部请求情况的模拟.(3)仿真参数描述在仿真实验中对比了本文提出的相空间调度算法、轮询算法、最小负载优先算法以及动态反馈负载均衡算法[20]作用到云计算仿真模型后的调度效果,仿真中为分析方便我们只考虑两个参数投影(CPU占用率和内存占用率)的二维情况,具体的实验参数如表1,表中的熵为广义归一化熵,它的值可以反映在本文的云计算系统仿真模型下调度算法的调度效果,通常广义归一化熵的值越小系统的负载越均衡.表中的广义归一化熵是在10×10的网格密度下利用式(2)进行计算的;采样时间位置都为100个时间Page8片长度;广义温度的计算是利用式(1)进行计算的;单个负载任务占用的时间片长度取1~10之间的一个随机整数;负载占用率分别取0~0.01和0~1两种情况,对应小负载变化范围和大负载变化范围.说明:表中广义归一化熵是将参数相空间划分为10×10的网格来进行计算,100个节点试验时动态反馈负载均衡算法的阈值取为0.495(归一化),1000个节点试验时动态反馈负载均衡算法的阈值取为0.636(归一化),动态反馈时间为一个单位时间片.由于1000个节点的负载相对较高,所以我们提高了动态反馈负载均衡算法阈值的范围.4.2仿真结果分析图3为节点数为1000、单个任务负载范围为0~0.01、单位时间片内的任务请求数为20000次的仿真结果,这种参数状态对应的为小负载高访问压力的情况,图3(a)~(d)分别为相空间调度算法、轮询算法、最小负载优先算法和动态反馈负载均衡算法在参数相空间(上)和动量相空间(下)调度结果的投影.对比4种算法计算结果在参数相空间的投影点分布情况,可以明显看出在相空间调度算法作用下节点在参数相空间的投影呈现出良好的聚集状态,表明系统当前的负载较为均衡,这种状态在热力学意义上是一种远离平衡态的状态.同时对比云计算系统在动量相空间上投影发现,相空间调度算法调度下的系统动量相空间投影点聚集于相空间原点的一个小区域内,在动量相空间中投影点越靠近原图3节点数为1000,单个任务负载为0~0.01,任务请求为20000次的仿真结果图4为节点数为100、单个任务负载范围为0~0.01、单位时间片内的任务请求数为1600次的仿真点表明系统当前的动态工作状态越平稳,且负载均衡状态也较好,因为投影点在动量相空间的原点附近时在参数相空间对应于该服务器的运动速度越慢且靠近重心位置.相比较而言轮询算法、最小负载优先算法和动态反馈负载均衡算法在参数相空间和动量相空间调度结果的投影均没有相空间调度算法好,从表1上我们也能看出相空间算法、轮询算法、最小负载优先算法和动态反馈负载均衡算法在这时的广义归一化熵分别为0.349、0.500、0.540、0.500,相空间算法使系统保持了较低的熵值,保证了系统处于良好的负载均衡状态.同时在相空间算法的作用下云计算系统广义温度只有0.0211,低于轮询算法、最小负载优先算法的广义温度,表明相空间算法在这时的工作稳定性要优于轮询算法和最小负载优先算法.动态反馈负载均衡算法的广义温度为0.0171低于相空间算法,此时动态反馈负载均衡算法的工作稳定性要优于相空间算法,但由于动态反馈负载均衡算法的广义归一化熵要高于相空间算法,这表明在动态反馈负载均衡算法调度下的系统负载均衡性不如相空间算法.通过将服务器运行结果投影到参数相空间和动量相空间,我们能从静态和动态两个角度对系统运行情况进行描述,投影点在相空间中的不同分布情况结合广义热力学参数值能直观地反应出系统的整体工作状态,相空间分析方法对海量高耦合云计算系统具有很强的描述能力,所以相空间分析方法是进行云计算系统分析的一种有力的工具.结果,图4(a)~(d)分别为相空间调度算法、轮询算法、最小负载优先算法和动态反馈负载均衡算法在Page9参数相空间(上)和动量相空间(下)调度结果的投影.对比图3可见这种实验条件下相空间调度算法的调度效果同样优于轮询算法、最小负载优先算法和动态反馈负载均衡算法.相空间调度算法作用下的系统广义归一化熵为0.239,广义温度为0.0197均比其它3种算法好,同时我们也能从参数相空间图4节点数为100,单个任务负载为0~0.01,任务请求为1600次的仿真结果图5为节点数为100,单个任务负载范围为0~1,单位时间片内的任务请求数为16次的仿真结果,图4(a)~(d)分别为相空间调度算法、轮询算法、最小负载优先算法和动态反馈负载均衡算法在参数相空间(上)和动量相空间(下)调度结果的投影.这种仿真条件外界负载请求的变化范围较大且负载的上限为1,这时服务器在参数相空间中运动的平均自由程较大.对比前面的实验,这种情况下系统的广义温度也较高,4种算法的广义温度分别为0.0849、0.1242、0.0849、0.1529,对比图3、图4和图5,在外界负载变化范围较大时4种算法的调度效果在参数相空间都呈现出随机分布的情况,服务器的相空间投影没有被负载均衡算法有效地聚集起来,系统处于热力学的平衡态,服务器负载非常不均衡,这一结果也在表1中的熵值中被反映出来,4种算法的广义归一化熵分别为0.903、0.849、0.903、0.889,这些值都很接近广义归一化熵的最大值1.从图5中的动量相空间图中我们也看到服务器在动量相空间上的投影点也不再聚集于原点,这表明系统当前的工作状态很不稳定,且系统负载很不均衡.这种不同温度和平均自由程下相同的调度算法作用效果的差异完全符合热力学原理,热力学高温和动量相空间中投影点的分布情况直观的得出算法的执行效果的比较,相空间算法作用下的云计算系统在参数相空间上的重心聚集性和在动量相空间向原点的聚集性都好于其它3种算法.相空间的投影图可以直观定性的描述系统的运动情况,广义热力学参数可以定量的给出调度效果的宏观比较参数.气体分子具有很强的扩散趋势,要维持系统处于非平衡态十分困难.同样原理,云计算系统相空间的广义温度很高时调度算法要维持系统在相空间上处于非平衡态也非常困难,这就出现了同样的调度算法在不同广义温度下调度效果出现截然不同的结果.在广义温度较高时系统需要付出更大的计算代价才能保持系统负载均衡,相空间调度算法应该在这种情况下作出相应的优化处理.根据以上的分析我们也能得到云计算系统在参数相空间和动量相空间上投影点形态的两个定性结论:(1)云计算系统在参数相空间上的投影点聚集性越好系统的负载均衡性越好.(2)云计算系统在动量相空间上的投影点向相空间原点的聚集性越好系统的工作稳定性和负载均衡性越好.通过以上两个定性结论我们可以直接从参数相空间和动量相空间图上读出系统的当前工作状态,相空间图的这一作用可以被应用于云计算专用监控系统的设计中,并且系统的节点数越多这一方法的优势越明显,这一点正是热力学方法的优势所在.Page10图5节点数为100,单个任务负载为0~1,任务请求为16次的仿真结果5结论本文将云计算系统向相空间投影,定义并分析了相空间上的广义温度、广义归一化熵、广义重心,广义归一化动量等广义热力学参数,利用热力学原理建立了云计算系统相空间分析模型的基本理论框架,这一理论适合对具有海量节点的高耦合云计算系统进行分析.利用相空间分析方法可以把对云计算系统的研究投影到参数相空间和动量相空间中进行,为建立云计算仿真模型、研究调度算法、分析系统工作状态提供了很大的方便.本文还在相空间分析模型的基础上提出了相空间调度算法、云计算系统相空间仿真模型,实现了对多种调度算法在相空间仿真模型上的仿真实验,仿真结果表明相空间调度算法能有效地使云计算系统在相空间中保持热力学意义上非平衡态从而实现系统的负载均衡,这一结果验证了相空间分析模型在系统分析、仿真,算法设计上的独特优势.因此云计算相空间分析模型有望能在云计算系统分析、云计算系统核心算法设计、系统监控、系统仿真诊断系统中得到大量的应用.
