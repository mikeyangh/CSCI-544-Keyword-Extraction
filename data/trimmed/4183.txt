Page1面向网络内容隐私的基于身份加密的安全自毁方案熊金波1),2)姚志强1),2)马建峰1),2),4)李凤华3)刘西蒙2),4)1)(福建师范大学软件学院福州350108)2)(西安电子科技大学计算机学院西安710071)3)(中国科学院信息工程研究所信息安全国家重点实验室北京100093)4)(西安电子科技大学陕西省网络与系统安全重点实验室西安710071)摘要针对网络内容生命周期隐私保护问题,结合多级安全、基于身份的加密(Identity-BasedEncryption,IBE)和分布式Hash表(DistributedHashTable,DHT)网络,提出了一种面向网络内容隐私的基于身份加密的安全自毁方案.为了实现密文安全,将网络内容划分为不同安全等级的隐私内容块,经对称密钥加密转变为原始密文;借助耦合和提取方法,将原始密文变换为耦合密文并进一步分解成提取密文和封装密文,然后将封装密文保存到存储服务提供商.为进一步保护网络内容过期后的隐私安全,对称密钥经IBE加密后的密文与提取密文一起经拉格朗日多项式处理生成混合密文分量并分发到DHT网络中.当超过生存期限,DHT网络节点将自动丢弃所存密文分量,从而使对称密钥和原始密文不可恢复,实现网络内容安全自毁.综合分析表明,与已有方案相比,该方案满足设计目标,不仅能抵抗传统密码分析攻击和蛮力攻击,还能抵抗DHT网络的跳跃和嗅探等Sybil攻击.关键词网络内容安全;基于身份的加密;安全自毁;多级安全;隐私保护;细粒度访问控制1引言随着个性化网络服务和Web应用的快速发展,尤其是云计算技术以及各种云服务的广泛普及,人们逐渐依赖于将自己创建的数据、文档等同步到免费的网络服务器或云数据中心,如Dropbox、有道云笔记、金山快盘等,以便在多个场所使用或在个人社交群中动态共享[1].然而,存储于网络或云端的这些数据或文档中往往包含隐私内容,如隐私邮件、职工个人信息、商业定价战略文件、电子医疗记录和上网Cookies等.由于这些隐私内容被赋予了网络内涵,这必然会引起人们对其可能被攻陷或泄露的担忧,而网络服务或云服务面临的各种新攻击和法律压力等使得这种担忧愈发升级[2].2012年11月,美国联邦贸易委员会以侵犯公民个人隐私为由罚款Google公司2250万美元;2013年3月,3·15晚会披露某些网络公司专门收集用户的上网行为,目前收集7亿多用户的Cookies资料,能揭示出用户的职业特点、收入水平、常上网时间段、常访问网站、登录账号和密码以及银行卡信息等,某些存储服务提供商甚至备份用户的重要数据或个人信息.因此,这类包含隐私信息的网络内容均需要设定一个生存期限,授权用户仅在该期限内可访问,需要设计一种面向网络内容隐私保护的安全自毁方案,支持网络内容生存期内的访问控制和过期后的自动销毁以保护其机密性与隐私安全.实现这一目标最直接的方式是在过期后删除这些隐私内容.然而,从本地或者Web页面中删除网络内容并不能实现真正删除.英国Glasgow大学的研究人员指出①:他们使用智能手机能够完全恢复出从Dropbox、Box和SugarSync中删除的图片、音频文件、PDF和Word文档.Perlman[3]最早关注文件安全删除技术,设计一种以文件为单位,在其加密密钥过期后即被删除以致文件不可恢复的系统.该系统仅考虑密钥生存时间,与此不同的是,本文还需要研究不同的授权用户访问不同的网络内容或不同的隐私内容块等访问策略;此外,该系统以本地计算机为中心不适合云计算环境.该思路后来扩展成FADE,一个在已有云计算基础设施上构建的安全重叠云存储系统,能够确保文件安全删除且支持不同的文件访问策略[4-5].另外一种可行的方法为Ephemerizer系统,在该系统中,需要一个可信服务器保存并管理由数据拥有者指定过期时间的解密密钥,一旦过期,则删除解密密钥使密文不可读[6-7].以上集中式解决方案的主要局限性在于:(1)完全集中,密钥管理过于依赖可信服务器;(2)当接受政府调查或法律传唤时,管理员需要被迫交出密钥管理权,此时可信服务器变得不可信;(3)均需要额外指令和操作才能达到文件确保删除.为此,Geambasu等人[8]提出一种新颖的数据自毁方案,设计并实现了Vanish系统,隐私数据经对称密钥加密,利用秘密共享方案将密钥分解成n个密钥分量,并分发到一个大规模分散的分布式①Deletedcloudfilescanberecoveredfromsmartphones,Page3Hash表(DistributedHashTable,DHT)网络中.DHT网络节点将周期性自动删除密钥分量导致密文不可读,从该意义上实现数据自毁而无需可信服务器及人为操作.Wang等人[9]改进了Vanish方案,除了将密钥分发到DHT网络中外,还提取部分密文并分发到DHT网络中,从而更有效抵抗传统密码分析和蛮力攻击.王等人[10]提出了一种适应于云存储的数据确定性删除方法,采用密钥派生树组织并管理密钥,然后将其分发到DHT网络以类似Vanish方法实现数据的确定性删除,该方案能有效提高密钥管理效率.然而,文献[11]指出,Vanish系统[8]采用的VuzeDHT网络存在Sybil攻击,攻击者可以在数据过期之前获取到足够多的密钥分量以重构出解密密钥.因此,文献[8-10]等方案均存在该安全问题.文献[12]提出SafeVanish方案,该方案通过扩展密钥分量的长度以抵抗Vanish系统中DHT网络存在的Sybil跳跃攻击,采用RSA加密对称密钥以抵抗Sybil嗅探攻击.Xiong等人[1]针对RSA机制存在复杂的密钥管理问题,结合基于身份的加密(IdentityBasedEncryption,IBE)和DHT网络提出ISDS方案,利用IBE算法加密对称密钥,并将其密文分发到DHT网络以抵抗Sybil攻击.以上分散式解决方案亦存在不同程度的以下局限性:(1)采用对称加密算法,存在复杂的密钥管理和密钥分发问题;(2)在隐私内容生存期内,不能提供细粒度访问控制机制;(3)不能对包含隐私信息的数据或网络内容实施分级安全保护;(4)虽然在一定程度上达到安全删除或自毁,但方案本身可能存在安全风险.针对以上问题,本文结合多级安全、IBE算法与DHT网络提出面向网络内容隐私的基于IBE的安全自毁(IBE-basedSecureSelf-destruction,ISS)方案,提供网络内容生存期内的细粒度访问控制和过期后的安全自毁.本文的主要贡献如下:(1)缓解对称加密算法复杂的密钥管理问题,缓解文献[12]中使用PKC而导致复杂的证书分发与管理问题.(2)提供生存期内的多级安全和细粒度访问控制策略;当超过生存期,实现网络内容安全自毁,无需额外人工干预.(3)不仅抵抗传统的密码分析和蛮力攻击,还可抵抗DHT网络的Sybil攻击.本文第2节概述相关的基础知识;第3节给出ISS方案的设计目标和方案假设;第4节首先提出系统模型和安全模型,然后概述ISS方案,最后从系统层面和算法层面详细描述ISS方案;第5节综合分析ISS方案并与已有方案进行比较与归纳;第6节总结全文并给出下一步研究方向.2基础知识2.1IBE基础IBE是一类典型的公钥密码方案,与PKI不同,其公/私钥对不是随机产生的,而是基于身份信息计算出来的.IBE首先由Shamir于1984年提出,已有不同类型的IBE方案,如由Boneh和Franklin[13]提出第一个实用且可证明安全的基于WeilPairing的IBE方案.随后,2007年RFC发布正式的IBE标准[14].在IBE方案[13-14]中,用于计算用户公钥的是用户独特的身份标识符,包含公开知道的身份信息,如通常将email地址作为IBE身份标识符.用户的私钥则由可信第三方(密钥产生中心,KeyGenerationCenter,KGC)利用用户公钥计算得到.KGC产生完全公开的IBE系统参数,包括明文空间、密文空间和密码函数等,其主要作用是结合用户身份计算用户的公钥.该IBE系统参数可以指定不同的IBE算法、密文空间长度和密钥强度.此外,KGC还产生主密钥,提供私钥生成(PrivateKeyGenerator,PKG)服务.PKG首先接收IBE用户私钥请求,然后认证用户,如果认证通过,则使用系统参数、主密钥和用户身份信息计算用户的私钥,并通过安全信道返回给用户.IBE算法能够很好地用于构造ISS方案的原因主要基于以下3方面:(1)IBE属于非对称加密算法,相比采用PKC的SafeVanish方案[12],IBE本身密钥管理简单,无需预先产生所有用户的公/私钥对且属主(网络内容拥有者)也无需预先获取所有用户的公钥证书.(2)网络内容被划分成具有不同安全等级的多个隐私内容块,经对称密钥k加密后,再使用IBE加密该k,所得密文经过处理变为混合密文分量(MixtureCiphertextShares,MS)并分发到DHT网络中,即可删除IBE密钥和k.当授权用户需要访问隐私内容时,向KGC申请IBE私钥即可解密.(3)能够灵活实现细粒度访问控制策略.在生存期范围内,不同的授权用户拥有不同身份,具有不Page4假设一个如下形式的插值多项式[9]:x-xixj-x()i.这说明,给定Q(x)中n个互不相同的安全级别,能访问不同安全等级的隐私内容.2.2门限秘密共享门限秘密共享方案最早由Shamir[15]提出,核心思想是:将共享秘密θ以某种算法分解成n个分量(shares),分别为θ1,θ2,…,θi,…,θn.从这n个分量中提取任意δ或δ以上的θi,能够计算出原始秘密θ,反之则不能计算出θ.该方法称之为(δ,n)门限秘密共享.在ISS方案中,门限秘密共享提供冗余能力,MS存储在DHT网络节点中.在某个时刻,允许DHT网络中少量节点动态加入或退出导致部分分量si∈SMS不可用,只要能够提取到任意δ或δ以上的si,即可恢复出MS.2.3拉格朗日多项式Q(x)=an-1xn-1+an-2xn-2+…+a2x2+a1x+a0.能够给出Q(x)中n个互不相同的点的如下集合:(x0,y0),…,(xi,yi),…,(xn-1,yn-1).则该多项式为拉格朗日多项式,由如下拉格朗日基本多项式线性组合而成:Q(x)=∑n-1∏0in-1i≠j同的点,可以重构出唯一的n-1阶多项式Q(x).在ISS方案中,根据提取密文CDHT和IBE加密k后的Ck,产生n个互不相同的点,从而能够构造出唯一的多项式Q(x),最终产生MS.2.4DHT网络概述DHT是对等网络中一种分布式数据结构,DHT网络是一种在分布式对等网络中查询、存储、检索和管理数据的大规模分散的基础设施[16-17].现有Internet中存在大量的DHT网络,如Vuze、Chord、OpenDHT和KAD等.每个DHT网络都具有如下3个重要的特征,适合于构造ISS安全自毁方案.(1)可用性.DHT网络中多个节点同时存储同一数据信息,这种冗余性提供可靠的分布式存储功能,保证节点中的数据在生存期内是可用的,是DHT网络能够构造ISS安全自毁方案的基础.(2)节点周期性自动清除功能.DHT网络中的节点每隔一定周期,会自动清除已存的原有数据以释放空间保存新数据.从而节点中存储的MS在过期后能够自动销毁而不可恢复,从而无法重构出解密密钥.为ISS安全自毁提供实现机制.(3)大规模且全球分布.Falkner等人[17]指出在Vuze网络中同时在线的活动节点超过百万个,且全球分布超过190个国家.这种大规模且完全分散的DHT能够为ISS方案提供健壮的抗攻击能力.3设计目标和方案假设然后提出ISS方案的设计目标和方案假设.本节中,首先给出ISS方案中2个概念的定义,定义1.生存期.指授权用户能够访问网络隐私内容或隐私内容块的有效时间范围.超过该范围的临界点即为过期.ISS方案要保护网络内容在生存期内和过期后的隐私安全.定义2.网络内容自毁对象(ContentSelf-DestructingObject,CDO).是一种新的数据结构,CDO封装网络隐私内容,不论CDO是在传输过程中,或备份在网络存储服务提供商中,都将阻止该内容泄露给任意非授权第三方.3.1设计目标ISS方案的设计目标如下:(1)过期后自毁.封装了属主隐私内容的CDO在生存期内的任意时刻对授权用户可用;一旦过期,能够自毁并对任何人不可读而无需人为干预,从而保护网络内容机密性和隐私安全.(2)细粒度访问控制.在CDO生存期内,需要实现不同授权用户访问不同安全等级的隐私内容块,以实现细粒度访问控制.(3)利用已有的基础设施和安全设备.ISS方案能够采用已有的基础设施实现安全自毁,不需要额外的安全服务和专用特殊的安全设备.(4)简单高效的密钥管理机制.已有相关方案仅采用对称加密算法导致复杂的密钥管理和分发问题,ISS方案应具有简单高效的密钥管理机制.(5)能够抵抗攻击.ISS方案不能引入新的安全与隐私风险.要求不仅能抵抗传统的密码分析和蛮力攻击,还能抵抗DHT网络的Sybil跳跃攻击和Sybil嗅探攻击.3.2方案假设的基础上,本文做出如下安全假设:为了实现ISS方案的设计目标,在文献[9-10](1)隐私内容具有时效性.ISS方案用于保护属主隐私内容的安全,该内容只有在生存期内对授权用户有效.属主在封装CDO时需要决定其生存时间.Page5(2)网络连接.属主和授权用户都可以连接到Internet,以便能够与KGC、网络存储服务提供商、DHT网络进行交互,实现生存期内MS的分发与提取,以及CDO的封装与解封装.(3)KGC、属主和授权用户可信.KGC是可信服务器,是IBE的核心组件,负责产生公共参数和生成IBE公/私钥;属主是CDO的创建者,是可信的;授权用户是可信的,不会主动泄露或备份获得的CDO或相关密钥数据[8-9].(4)存储服务提供商不可信.提供存储服务的同时,可能异地多次备份CDO或被迫泄露给法律机构等实体.4ISS方案构造ISS方案将多级安全、对称加密、基于身份的加密和DHT网络相结合,提供保护网络内容全生命周期隐私与安全的自毁方案,是一种分布式网络存储的增值安全服务.ISS方案中主要符号及其描述如表1所示.CDHT,CCDOk,CI,Ck1,2e,FKDFs,SMS4.1系统模型ISS方案的系统模型如图1所示,包含6个实体:网络隐私内容属主、存储服务提供商、授权用户、大规模分散的DHT网络、KGC和潜在的攻击者.网络隐私内容属主:属主将隐私内容加密并封装成CDO并发送给存储服务提供商,生成MS并分发到DHT网络中.存储服务提供商:负责存储CDO,并认证只有授权用户才能访问适当的CDO,一般为分布式网络或云存储服务器.授权用户:属主指定的社交群中的隐私内容共享者.不同的授权用户拥有不同的身份,具有不同的访问权限.大规模分散的DHT网络:网络节点负责存储混合密文分量,并保证过期后分量的安全清除.KGC:负责支持IBE密钥的产生与管理.潜在的攻击者:ISS方案潜在的攻击者主要来自对存储服务提供商中存储的CDO的攻击和对DHT网络的攻击两个方面.4.2安全模型ISS方案的核心安全目标是确保存储服务提供商中存储包含隐私信息的网络内容在过期后能够安全自毁,以抵抗未来攻击或追溯性攻击,如法院命令或传票、恶意攻击CDO.由假设(3)可知,在ISS方案中,能够访问相同CDO的属主和授权用户相互信任,不会主动泄露隐私内容.在ISS安全模型中,潜在的攻击者分为3种类型:(1)网络隐私内容过期后攻击CDO,如存储服务提供商可能提供CDO副本以支持法律传唤;(2)在生存期内攻击DHT网络本身,如Sybil跳跃攻击和Sybil嗅探攻击,在过期之前收集DHT网络节点中保存的MS以试图恢复出隐私内容的解密密钥;(3)在任意时刻,同时攻击CDO和DHT网络.4.3ISS方案概述下两个阶段:ISS方案的基本工作原理如图2所示,分为如第1个阶段为加密和封装阶段(图2中箭头向下方向).将隐私内容的明文加密后经过处理、封装、分发并分别保存到DHT网络和存储服务提供商.属主将隐私内容划分成多个具有不同安全等级的隐私内容块m,经k分别加密后汇总得到密文C,再经过耦合算法处理得到耦合密文C,最后将C提取并分解成两部分:用于分发到DHT网络的提取密文CDHT和用于封装成CDO的封装密文CCDO.采用IBE算法加密k的密文Ck,联合CDHT经过拉格朗日多项式处理后得到SMS,结合访问键值LPage6将SMS分发到DHT网络的各节点中保存.CCDO结合L并封装成CDO,然后保存到存储服务提供商的服务器中.第2个阶段为解封装和解密阶段(图2中箭头向上方向).主要是授权用户的访问阶段,是第1阶段的逆过程.首先从存储服务提供商和DHT网络中分别获得相关的CDO和SMS,然后经过一系列处理后,最终恢复出原始网络隐私内容的明文.为了更清楚和详尽地描述ISS安全自毁方案,下面从系统层面和算法层面分别展开:系统层面描述高级操作的功能,算法层面主要完成由系统层面调用的底层算法的具体实现.4.4ISS方案系统描述(1)系统建立.系统初始化阶段,给定安全参数κ,调用算法层面的Setup(κ)产生系统公共参数和IBE相关的公/私钥参数.(2)安全等级划分.引入多级安全思想[18],属主将包含隐私信息的网络内容依据其隐私程度的不同划分成多个具有安全等级的隐私内容块mi,需要在不同的用户间共享,如图3所示.在图3中,ISS方案采取如下密钥分配策略:同一授权用户访问不同安全等级的隐私内容块选用不同的密钥,访问相同安全等级的不同隐私内容块选用相同的密钥;不同授权用户访问同一个隐私内容块选用不同的密钥.与已有方案每个数据块每个用户分配不同的密钥相比,ISS方案能够减少密钥的数量,提高密钥管理效率.(3)网络隐私内容密文的处理.属主依据授权用户的权限将隐私内容块mi∈M分类,然后调用加密函数Encrypt(ψ,k,m)加密m后汇总为密文C.由于ISS方案需要将部分密文提取出来并发布到DHT网络中,通过增加密钥空间的长度以抵抗Sybil跳跃攻击,封装密文用来封装CDO以增加对CDO攻击的难度.因此,需要对密文进行适当处理[9]:调用函数Associate(ψ,C)对密文进行耦合计算后得到耦合密文C,然后调用函数Extract(ψ,C)得到用于分发到DHT网络的提取密文CDHT和用于封装CDO的封装密文CCDO.(4)混合密文分量的产生.首先,属主依据授权用户的身份I调用IBE密钥生成函数FKDF获得IBE加密密钥IEK,再调用IBE加密函数IBEEncrypt(IEK,k)加密k后变为Ck;其次,调用函数PolyGener(ψ,CDHT,Ck)产生多项式Qi(x);然后,调用混和密文分量产生函数MixSharesGener(ψ,Qi(x))产生SMS;最后,调用MixSharesDistribute(SMS)结合L将SMS分解成元组〈li,si〉并分发到DHT网络中.同时,属主删除IEK和k.(5)封装CDO.已知封装密文CCDO、L和公共参数ψ,属主调用函数Encapsulate(ψ,L,CCDO)将CCDO封装成CDO,然后将其保存到存储服务提供商中.(6)生存期内的细粒度访问控制.在网络隐私内容的生存期内,属主社交群中的授权用户通过身份认证后,执行如下操作:首先,从存储服务提供商中获得相应的CDO,调用解封装函数Decapsulate(CDO)获得L和CCDO;然后,依据L并调用算法ExtractShares(ψ,L)从DHT网络中提取足够多的SMS并恢复出Ck和CDHT,将得到的CDHT和CCDO重构成耦合密文C,再调用去耦函数UnAssociate(ψ,C)恢复出原始密文C;同时,调用IBE密钥生成函数FKDF获得IBE解密密钥IDK,再调用IBE解密函数IBEDecrypt(IDK,Ck)获得原始密钥k;最后,授权用户调用解密函数Page7Decrypt(ψ,k,C)使用k解密C得到原始网络隐私内容的明文块m.通过以上操作过程,不同授权用户访问不同安全级别的不同网络隐私内容块,实现隐私内容生存期内的细粒度访问控制.(7)过期后的网络隐私内容安全自毁.当封装了网络隐私内容的CDO在处理结束,并超过生存期后,ISS方案将利用DHT网络节点周期性数据自更新功能,即每个节点将自动丢弃所存的SMS以释放存储空间来保存新数据,而无需人工干预.因此,当CDO过期后,DHT网络中保存的SMS被安全删除.由于无法获取到SMS,不能恢复出Ck和CDHT,从而不能获得原始隐私内容的加密密钥k;另一方面,由于缺少CDHT,即使过期后任何实体(包括属主)从存储服务提供商获得相应的CDO副本,也不可能重构出耦合密文C,最终无法获得原始密文C.因此,当CDO过期后,由于无法恢复出原始密钥和原始密文,实现网络隐私内容的安全自毁.4.5ISS方案算法描述C1=C1H(C2,…,Ci,…,Cv),C2=C2H(C1,C3…,Ci,…,Cv),…Ci=CiH(C1,…,Ci-1,Ci+1,…,Cv),算法层面的各算法描述如下.(1)Setup(κ)给定安全参数κ,算法产生混合密文分量MS的个数n,门限值δ,每次提取的bit数量p,提取的次数t,一个Hash函数H:{0,1}→1,一个对称加密算法E:({0,1},{0,1}l)→{0,1}(如AES算法),一个随机对称密钥k,一个双线性对函数e:1×1→2(1和2均为大素数阶q的有限域加法循环群和乘法循环群,且1的生成元为g)和一个密钥生成算法FKDF:3→{0,1}l(这里l为算法E的密钥长度).此外,KGC产生一个私钥x∈q与相应的公钥(g,y=gx)∈p,t,H,E,e,q,1,2,g,FKDF,y).汇总得到密文C.(2)Encrypt(ψ,k,m)→C算法E使用k对每个网络隐私内容块m加密,(3)Associate(ψ,C)→C给定C和ψ,算法首先将C等分成ubit的块,最后一块如果不足ubit则补0,假设共v块,则C=(C1,…,Ci,…,Cv),算法耦合各密文块如下:…Cv=CvH(C1,…,Ci,…,Cv-1).最后,耦合后的密文即为C=(C1,…,Ci,…,Cv).(4)Extract(ψ,C)→(CDHT,CCDO)给定C和ψ,对于i=1,2,…,t(t<v),算法每次提取耦合密文C(i)中的[1,p×k]bit,表示为di,C(i+1)表示第i次提取后的密文.提取出的密文表示为CDHT=(d1,…,di,…,dt),其中di=(d[i][0],d[i][1],…,d[i][δ-1]).最终提取后的密文表示为封装密文CCDO.(5)FKDF(e(a,b))→IEK属主依据隐私内容授权用户的身份Ii创建一个伪私钥r,已知系统公钥y,算法计算出该用户的IBE加密密钥为IEK=FKDF(e(H(Ii)r,y)).同时,属主生成一个伪公钥z=gr并安全发布给该授权用户.(6)IBEEncrypt(IEK,k)→Ck给定IEK,算法使用IEK加密k得到Ck.(7)PolyGener(ψ,CDHT,Ck)→Qi(x)给定CDHT=(d1,…,di,…,dt)和Ck,算法首先将Ck等分成δ块,即Ck=(c0,…,ci,…,cδ-1),并产生t+1个拉格朗日多项式如下:Q1(x)=d[1][δ-1]xδ-1+d[1][δ-2]xδ-2+…+d[1][0],…Qi(x)=d[i][δ-1]xδ-1+d[i][δ-2]xδ-2+…+d[i][0],…Qt(x)=d[t][δ-1]xδ-1+d[t][δ-2]xδ-2+…+d[t][0],Qt+1(x)=cδ-1xδ-1+cδ-2xδ-2+…+c1x+c0.(8)MixSharesGener(ψ,Qi(x))→SMS给定以上t+1个多项式和ψ,算法随机选择n个大于1的自然数x1,…,xi,…,xn,然后计算分量si=(xi,Q1(xi),Q2(xi),…,Qt+1(xi)),最终获得n个混合密文分量SMS=(s1,…,si,…,sn).(9)MixSharesDistribute(SMS,L)→{〈li,si〉}给定SMS后,算法随机选择一个访问键值L作为安全伪随机数生成器的种子,运行该生成器生成对应的n个键值索引l1,l2,…,ln.对于i=1,…,n,SMS与键值关联并生成对应的元组〈li,si〉并分发到li对应的DHT网络节点中.最后,属主删除IEK和k.(10)Encapsulate(ψ,L,CCDO)→CDO给定ψ、L和CCDO作为输入,算法将其封装成(11)Decapsulate(CDO)→(L,CCDO)在隐私内容的生存期内,授权用户经过身份认CDO,并保存到存储服务提供商.Page8如下:证后,从存储服务提供商获得相应的CDO,算法解封装并获得L和CCDO.(12)ExtractShares(ψ,L)→(CDHT,Ck)给定L作为安全伪随机数产生器的种子,产生并从l1,l2,…,ln中提取大于等于δ个索引值,获得大于等于δ个si,利用拉格朗日插值法重构t+1个多项式,最终恢复出CDHT和Ck.从而,利用CCDO和CDHT可以重构出耦合密文C.(13)UnAssociate(ψ,C)→C给定C和ψ,算法可以恢复出原始密文C,执行Cv=CvH(C1,…,Ci,…,Cv-1),Cv-1=Cv-1H(C1,…,Ci,…,Cv-2,Cv),…Ci=CiH(C1,…,Ci-1,Ci+1,…,Cv),…C1=C1H(C2,…,Ci,…,Cv).从而得到C=(C1,…,Ci,…,Cv).(14)FKDF(e(c,d))→IDK授权用户能够获得伪公钥z=gr,还可以通过身份认证后从KGC获得其身份Ii对应的私钥kIi=H(Ii)x∈1,算法计算IDK=FKDF(e(kIi,z)).(15)IBEDecrypt(IDK,Ck)→k由于对函数e具有双线性的性质,即等式e(kIi,z)=e(H(Ii)r,y)成立,因此IEK=IDK.算法将Ck解密后获得原始解密密钥k.(16)Decrypt(ψ,k,C)→m给定ψ、C和k,算法最终解密出网络隐私内容的原始明文m.5ISS方案综合分析首先检验ISS方案是否满足设计目标;在此基础上,ISS方案的安全性主要体现在算法安全性、DHT网络安全性和系统安全性3个方面;ISS方案的性能主要体现在计算开销和传输开销两个方面.下面详细分析并与已有方案进行比较与归纳.5.1安全相关的特性分析依据ISS方案设计目标从以下7个方面分析方案的安全特性,并与已有方案进行比较分析,分析结果汇总于表2.(1)扩展性.ISS方案和文献[1]均采用KGC支持IBE加/解密对称密钥,采用DHT分布式存储混合密文分安全特性文献[4]文献[8]文献[9]文献[12]文献[1]ISS扩展性集中分散分散混合混合混合加密算法对称对称对称RSAIBEIBE数据自毁否是是是是是已有设施设备是是是否是是密钥管理复杂复杂复杂复杂高效高效细粒度访问控制是否否否是是多级安全否否否否否是量;文献[12]基于PKC采用RSA加/解密对称密钥,均属于混合式方案,具有较好的可扩展性.而文献[4]采用集中的可信服务器实现密钥管理,存在单点失效问题,扩展性较差.文献[8-9]不依赖可信服务器,是一种完全分散的方式,扩展性较好.(2)加密算法.文献[4,8-9]均采用对称加密算法加密文件或数据.文献[12]采用对称加密算法加密数据,然后基于PKC采用RSA加密对称密钥.文献[1]先采用对称密钥加密文档,然后利用IBE加密该对称密钥.相似的,在ISS方案中,先用对称密钥加密划分安全等级的网络隐私内容,然后采用IBE算法加密对称密钥.以上两种方案都采用IBE实现对称密钥的安全控制.(3)数据自毁.文献[4]通过额外的指令和操作能够实现数据的确保删除,文献[1,8-9,12]和ISS方案由于都采用DHT网络节点存储密钥或密文分量,而DHT节点能周期性地删除已存数据使得保存的分量不可恢复,从而原始密文不可读,即在无需人工干预的情况下实现数据自毁.但文献[11-12]指出文献[8-9]并不安全,存在DHT网络的Sybil攻击.(4)使用已有设施和设备.以上方案除了文献[12]需要PKC的专有CA外,均使用已有的基础设施和设备.文献[1]和ISS方案虽需要KGC服务器支持IBE加/解密,但KGC可以部署在已有服务器上,不需要专用的安全设备.(5)密钥管理.文献[4,8-9]均采用对称加密算法加密数据或文件,当数据种类多,且授权用户较多时,密钥管理与分发非常困难.文献[12]引入RSA加密对称密钥,系统在初始化时还需要知道所有用户的公钥证书以及产生所有用户的公/私钥对.因证书具有时效性,其管理非常复杂.文献[1]和ISS方案相似,在ISS方案中,相同授权用户相同安全级别的不同隐私内容块采用同一个对称密钥加密,然后IBE加密Page9该对称密钥.前者可以减少对称密钥的数量,后者IBE算法不需要PKC的基础设施,也不需要预先产生所有用户的公/私钥对和证书,只需要知道授权用户的身份即可.又依据方案假设可知,属主和授权用户间相互信任,不会故意泄露授权用户身份信息.而IBE私钥可以延迟到需要访问CDO时向KGC申请.综上,ISS方案的密钥管理简单高效.(6)细粒度访问控制.在隐私数据或文件的生存期内,文献[4]依据文件访问策略实现基于策略的访问控制,为不同的文件提供不同的确保删除服务.文献[1]基于IBE实现对隐私文档的细粒度安全访问.ISS方案通过安全等级的划分和IBE可以实现不同的授权用户具有不同身份,能够访问不同安全等级的隐私内容,实现细粒度访问控制.其余方案均缺乏对生存期内访问控制的考虑.(7)多级安全.引入多级安全思想[18],仅ISS方案依据隐私程度对网络内容分块,每个隐私内容块均具有特定的安全等级,不同安全等级的块采用不同的密钥加密.可以引入密钥推导[19]以实现高安全等级的用户可以通过密钥推导访问低安全等级的隐私内容.实现多级安全的同时进一步提高密钥管理的效率.5.2安全性分析在已有数据自毁方案中,均假设攻击者不是实时的,包含隐私信息的数据或文件的封装对象在过期之前未受攻击[8-10,12].而在实际应用中,尤其是云计算环境中,在生存期范围内,可能存在对封装对象的攻击.因此,该假设过于强制和理想.在ISS方案中,不需要该前提假设.文献[1,8-10,12]只考虑两种类型的攻击,ISS方案在此基础上进行扩展,考虑3种类型的攻击:(1)在过期之后对CDO使用密码分析或蛮力攻击;(2)在生存期内,从DHT网络中收集MS以重构原始密文和密钥;(3)在任意时刻同时攻击CDO和DHT网络并试图恢复出原始网络隐私内容.相应的,ISS方案的安全性取决于以下3个方面:抵抗密码分析和蛮力攻击的算法安全性、抵抗Sybil攻击的DHT网络安全性和同时抵抗以上两种攻击的系统安全性.(1)算法安全性.在文献[1]和ISS方案中,不仅网络内容是加密的,其密文亦是经过变换和提取的,且加密的密钥也是经过IBE加密的,其密钥密文和部分隐私内容密文都是经过变换处理的.因此,没有完整变换后的密文信息是不可能重构出原始密钥和密文的,也是不可能恢复出原始明文的.蛮力攻击的工作原理是,基于完整密文持续尝试所有可能的解密密钥.在ISS方案中,采用算法Associate(ψ,C)将密文C变换为耦合密文C,耦合密文块之间相互关联.然后算法Extract(ψ,C)将耦合后的密文分为两部分:CCDO和CDHT,后者将和密文Ck一起生成MS.因此,要实现蛮力攻击,获得原始密文的唯一方式是获得完整的CCDO和CDHT,攻击的难度与密钥空间有关.在ISS方案中,密钥空间与CDHT的长度以及Ck的长度相关,相比文献[9,12],该空间有明显增加.因此,文献[1]和ISS方案比文献[9,12]更能有效抵抗蛮力攻击.传统的密码分析攻击的前提也是需要获得完整的原始密文,而保存在存储服务提供商的CDO中封装的密文CCDO不是完整的密文.因此,文献[1]和ISS方案均能抵抗密码分析攻击.而文献[4,8]采用对称密钥加密,加密后的完整密文保存在网络中或云端服务器,由文献[9]分析可知,攻击者可以获得文献[4,8]完整的密文,通过密码分析或蛮力攻击可能分析出密钥,从而泄露明文.因此,他们不能抵抗以上攻击.(2)DHT网络安全性.文献[11-12]的分析和实验验证指出,文献[8-9]所提方案存在DHT网络的Sybil攻击.主要体现在两个方面:由于文献[8]分发到DHT网络的密钥分量一般定长且较短,通常为16~51字节.文献[12]通过增加密钥分量的长度以有效抵抗Sybil跳跃攻击;另一方面,在隐私数据的生存期内,攻击者可以从文献[8-9]方案的DHT网络中嗅探出足够多的密钥分量以重构解密密钥.文献[12]提供一个思想,将RSA加密对称密钥后,再产生密钥分量分发到DHT网络,即使攻击者嗅探到足够多的分量,也没有相应的私钥解密出原始对称密钥.因此,能够抵抗Sybil嗅探攻击.然而,由于其基于PKC方案,存在复杂的公/私钥和证书管理问题.在文献[1]和ISS方案中,采用IBE加密k,获得密文Ck,以解决文献[12]基于PKC所存在的问题,并有效抵抗Sybil嗅探攻击;另一方面,除了Ck外,ISS方案还将提取出来的CDHT一起经过变换处理后产生混合密文分量并分发到DHT网络中,该分量长度远大于文献[12]中密钥分量长度.因此,ISS方案也能有效抵抗Sybil跳跃攻击.Page10(3)系统安全性.由以上分析可知,文献[1,8-10,12]仅考虑前两种类型的攻击,且ISS方案均能有效抵抗.下面考虑第3种最强类型的攻击,在网络隐私内容封装后的任意时刻,同时攻击DHT网络和存储服务提供商保存的封装对象CDO.假设在某一时刻,攻击者发起Sybil攻击从DHT获得混和密文分量信息,通过拉格朗日插值法重构多项式获得Ck和CDHT的混和密文;同时该攻击者发起对CDO的攻击获得CCDO.由假设可知,KGC是可信的,攻击者不能获得正确的IBE私钥,因而不能分离出Ck和CDHT并正确解密出k;也不能由CDHT和CCDO重构出耦合密文C.最终无法获得原始的网络隐私内容,从而能够同时抵抗这两类攻击,达到系统整体安全性.以上方案抗攻击能力的比较汇总于表3.攻击类型文献[4]文献[8]文献[9]文献[12]文献[1]ISS密码分析攻击不能不能能能能能蛮力攻击不能不能能能能能Sybil跳跃攻击无不能不能能能能Sybil嗅探攻击无不能不能能能能同时攻击无不能不能不能不能能综上所述,ISS方案不需要像已有方案一样设定“CDO在过期之前未受攻击”的理想前提假设,也能实现在网络隐私内容过期后抵抗传统的密码分析和蛮力攻击;在过期前抵抗DHT网络的跳跃和嗅探等Sybil攻击;还能在任意时刻同时抵抗以上两类攻击达到系统安全.因此,ISS方案是安全的,优于已有方案.5.3性能分析从以下两个阶段分析ISS方案的性能:第1个阶段主要是加密和封装阶段,第2个阶段是解封装和解密阶段[9].(1)加密和封装阶段.①加密明文的计算开销.ISS方案使用随机产生的对称密钥加密具有安全等级的隐私内容块.②耦合原始密文的计算开销.在提取部分密文分发到DHT网络之前,ISS方案需要执行耦合算法将原始密文变为耦合密文.IBE算法加密对称密钥.③加密对称密钥的计算开销.ISS方案使用④生成混合密文分量的计算开销.ISS方案产⑤混合密文分量分发的传输开销.ISS方案产生n个不同的混合密文分量.生混合密文分量并分发到DHT网络的节点中.(2)解封装和解密阶段.①从DHT网络提取混合密文分量的传输开销.为了重构耦合密文和原始密钥,需要从DHT网络中提取足够多的混合密文分量.②重构多项式的计算开销.获得足够的混合密文分量后,需要使用拉格朗日插值法重构多项式获得Ck和CDHT.得原始密文.获得原始加密密钥k.③解密CKey的计算开销.采用IBE算法解密后④去耦的计算开销.ISS方案执行去耦函数获⑤解密的计算开销.ISS方案使用k解密原始密文得到授权用户访问的隐私内容明文.文献[8]测量了Vanish方案的性能,主要关注封装和解封VDO的时延,指出Vanish各项操作,如创建和阅读一份Vanish邮件的时延只需几秒钟.文献[9]相比Vanish方案增加了密文耦合和去耦算法,主要为Hash操作和异或操作,文献[9]指出以上操作是容易和高效的.而ISS方案相比文献[9]仅增加了IBE加密和解密对称密钥的开销,分别为群上的一次对运算操作和一次Hash操作.使用CPABEtoolkit完成一次对运算操作的时间近似为5.5ms[20],相比获得的安全性而言,该计算开销是合理的.6结论随着网络上各种个性化应用和新兴服务的出现,人们依赖网盘、云盘等第三方服务器存储包含隐私信息的数据和文件,其隐私安全保护问题极具挑战性.即使在本地或Web上删除网络服务器中存储的隐私内容,仍可能保存在备份服务器中,或被智能终端完全恢复.为了保护具有一定生存期的网络内容的机密性和隐私安全,本文将多级安全、IBE和DHT网络融入网络内容的隐私保护机制中,构造了一种面向网络内容隐私的基于身份加密的安全自毁(ISS)方案:首先依据隐私程度将网络内容划分成不同安全等级的隐私内容块,经对称密钥加密后对该密文进行耦合变换和提取操作生成提取密文和封装密文;同时,采用IBE算法加密对称密钥,其密文结合提取密文经拉格朗日多项式处理生成混合密文分量;最后,该分量被分发到大规模分散的DHT网络中,封装密Page11文被封装成网络内容自毁对象后保存到存储服务提供商.ISS方案能实现网络内容生存期内的细粒度访问控制和过期后的安全自毁.综合分析表明,相比类似方案,ISS方案不需要“CDO在过期之前未受攻击”的理想假设也完全能够满足设计目标,不仅能在过期前抵抗传统攻击,在过期后抵抗DHT网络的Sybil攻击,还能在封装CDO后的任意时刻抵抗这二者的同时攻击.因此,ISS方案要优于已有类似方案.下一步研究工作的重点主要为:(1)结合基于行为的访问控制机制[21],研究授权用户在不同环境、不同网络行为下对网络内容隐私保护的影响机理;(2)结合隐私保护的密文查询方法[22],为授权用户提供网络隐私内容生存期内的密文隐私保护查询和搜索服务;(3)在Vanish系统实现的基础上,结合OpenStack开发一个云计算环境中网络内容安全自毁系统,实现ISS安全自毁方案;(4)结合基于属性的加密算法[23]改进ISS方案,使其能够满足云环境中大规模用户对网络隐私内容的安全访问.
