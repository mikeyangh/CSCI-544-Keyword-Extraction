Page1基于MB-HDP模型的微博主题挖掘刘少鹏印鉴欧阳佳黄云杨晓颖(中山大学信息科学与技术学院计算机科学系广州510006)摘要主题模型是挖掘微博潜在主题的重要工具.然而,现有的主题模型多由LatentDirichletAllocation(LDA)派生,它需要用户预先指定主题数目.为了自动挖掘微博主题,作者提出了一个基于分层Dirichlet过程(HierarchicalDirichletProcess,HDP)的非参数贝叶斯模型MB-HDP.首先,针对微博应用场景,假设消息是不可交换的;接着,利用微博的时间信息、用户兴趣以及话题标签,聚合主题相关的消息以解决微博短文本的数据稀疏问题;然后,扩展ChineseRestaurantFranchise(CRF)对微博数据进行主题建模;最后,设计一个相应的MarkovChainMonteCarlo(MCMC)采样方法,推导MB-HDP模型的分布参数.实验表明,在生成主题质量、内容困惑度和模型复杂度等指标上,MB-HDP模型明显优于LDA和HDP两种模型.关键词主题挖掘;微博;分层Dirichlet过程;MB-HDP1引言Twitter是全球最流行的微博服务,它允许用Page2的信息,为信息提取提供了机遇,同时也带来了巨大挑战.微博潜在主题挖掘能够帮助用户及时获取信息,掌握社区动态,是当前的研究热点[1-6].主题模型是挖掘微博潜在主题的重要工具,主要包括参数贝叶斯模型与非参数贝叶斯模型.LatentDirichletAllocation(LDA)[7]是典型的参数贝叶斯模型,它通过词项在文档集中的共现信息,抽取出语义相关的主题集合,有效地挖掘文档集的潜在主题.然而,相比传统文本,微博文本长度较短,词项共现信息匮乏,导致数据十分稀疏,难以构建微博数据的主题结构.针对该问题,研究者通过利用微博的时间信息和结构化数据,提出若干LDA派生模型[8-10].但是,这些模型需要预先指定主题数目,而主题数目的选取直接影响了主题挖掘效果.在不具备任何先验知识的情况下,用户难以准确地估算出主题数目,因此人为设定主题数目加重了用户的负担,进而限制模型的应用推广.非参数贝叶斯模型分层Dirichlet过程(Hierar-chicalDirichletProcess,HDP)[11]常用于聚类问题,它能自动确定聚类的数目,并估计聚类的分布参数.由HDP派生的各种模型,已广泛应用于文本挖掘[11-12]、音乐内容识别[13]、图像检索[14]以及视频监控数据处理[15]等.在文本主题挖掘中,HDP能够自动确定主题数目,准确估计文档集的分布参数,从而取得良好的主题挖掘效果.但是,HDP并不适用于微博数据,原因在于:HDP假设数据具有可交换性,即在文档层次上,文档内的单词次序可交换且不影响模型的训练结果;在文档集的层次上,文档可交换性假设文档次序与模型的推导结果无关.由于消息是严格按照时间先后顺序发布的,当前消息可能是针对已发布的消息进行评论或者转发,这与文档可交换性假设相矛盾.因此,考虑时间信息是微博主题挖掘的关键.比如,主题“Obama’shealthcareBill”探讨的医疗改革法案签署于2010年3月23日,当天发布的消息与该主题相关的可能性很大.近年来,研究者逐渐意识到时间信息的重要性,并提出若干HDP改进模型[12,16-19].除此之外,用户兴趣和话题标签等信息也有助于微博的主题挖掘.比如,用户“macworld”主要关注苹果公司的产品,发布的消息大多涉及“apple”、“iphone”和“mac”等主题,与其自身兴趣紧密相关.而根据消息中的“#heat”话题标签,可推断该消息可能涉及“basketball”、“Miami”和“Wade”等主题.因此,文献[20]引入话题标签作为附加的弱监督信息,以改进微博的潜在主题挖掘.针对微博潜在主题的自动挖掘任务,本文提出了一个基于分层Dirichlet过程的非参数贝叶斯模型MB-HDP.首先,MB-HDP模型根据微博应用场景的特点,假设消息是不可交换的;接着,利用微博的时间信息、用户兴趣以及话题标签,聚合主题相关的消息以解决数据稀疏问题;然后,扩展ChineseRestaurantFranchise(CRF)[11]对微博数据进行主题建模;最后,设计一个相应的MarkovChainMonteCarlo(MCMC)采样方法,推导MB-HDP模型的分布参数,挖掘微博的潜在主题.实验表明,在生成主题质量、内容困惑度和模型复杂度3个指标上,MB-HDP模型明显优于LDA和HDP等现有主题模型.本文主要贡献如下:(1)利用时间信息、用户兴趣和话题标签,有效地解决了微博潜在主题的自动挖掘问题;(2)提出基于分层Dirichlet过程的非参数贝叶斯模型MB-HDP,并设计相应的MCMC采样方法推导该模型;(3)在真实数据集上进行大量实验,验证MB-HDP模型的有效性.本文第2节回顾相关的研究工作;第3节定义微博潜在主题的自动挖掘问题,并详细阐述MB-HDP模型的框架;第4节是关于MB-HDP模型在真实数据集上的实验分析与讨论;最后第5节给出结论和未来的工作.2相关工作主题模型是一种概率生成模型[21-22],常用于挖掘大规模文档集的潜在主题.词项作为自然语言的基本单元,往往隐含了潜在主题的语义信息.字面上毫不相干的单词,却可能描述同一个抽象概念.基于这种思想,主题模型假设主题遵循一定的规则生成单词.在文档单词已知的情况下,可以通过概率反推文档的主题结构,进而得到整个文档集的主题分布.主题模型通常划分为参数贝叶斯模型与非参数贝叶斯模型两大类.2.1参数贝叶斯模型LDA[7]是典型的参数贝叶斯模型,它将文档视为主题的概率分布,主题则是单词的概率分布.给定文档集的主题数目,每个文档的生成过程如下:首先,从先验Dirichlet分布中抽取该文档的主题分布;接着,从主题多项式分布中选择当前单词的主题;最后,从先验Dirichlet分布中抽取该主题的单词分布,并选择具体单词.重复以上步骤,直到生成所有单词.LDA常用的推导方法包括变分贝叶斯和Page3Gibbs抽样等.本质上,LDA利用词项在文档层次上的共现信息揭示文档集所蕴含的主题结构.由于微博文本长度较短,词项共现信息匮乏,导致了严重的数据稀疏问题,因而微博的主题结构难以直接估计.所以,将LDA直接应用于微博数据无法取得令人满意的主题挖掘效果.近年来,研究者通过利用微博的时间信息和结构化数据,开发了若干LDA派生模型,在一定程度上克服了数据稀疏的困难,提高了微博的主题挖掘效果.文献[23]提出了一个半监督学习模型:LabeledLDA,它将消息内容映射到substance、style、status和social这4个维度,从而更好地表示文本内容,适用于用户特征描述与消息组织等任务.文献[9]假设用户发布消息的行为受到突发性新闻、朋友消息和用户兴趣3个因素影响,设计了一个主题混合模型框架,实现消息发布行为的建模.文献[10]介绍了一个微博主题挖掘的概率生成模型MB-LDA,同时考虑微博的联系人关联关系和文本关联关系,以此辅助进行微博的主题挖掘.实验表明该模型不仅能找出微博的潜在主题,还能发现联系人关注的主题.文献[24]针对微博主题建模和主题转移问题,设计了一个时态感知的主题模型TM-LDA.该模型的核心思想是最小化消息序列主题分布的预测误差,从而求解主题转移的分布参数.文献[8]基于“用户发布的消息与日常生活和个人兴趣紧密相关”以及“特定时间段的消息倾向于谈论热点新闻事件”两个现象,提出了主题模型TimeUserLDA.该模型假设消息只描述单一的主题,融合时间信息和用户兴趣,准确地发现微博突发性话题.上述参数贝叶斯模型在训练阶段要求用户指定主题数目.然而,假设用户对微博数据的潜在主题具备的先验知识并不合理.由于主题数目随着时间动态变化,尝试搜索合适的主题数目往往耗时且低效.考虑到非参数贝叶斯模型允许无限的主题数目,它们无疑是更适合微博主题自动挖掘的解决方案.2.2非参数贝叶斯模型HDP[11]是典型的非参数贝叶斯模型,它能够揭示高维数据所隐藏的潜在语义结构.在HDP的主题建模过程中,每个文档是一组可观察单词的集合.单词按照主题聚类,最终确定文档的主题分布.各个文档的主题服从同一个Dirichlet过程,从而保证文档集共享相同的主题;文档集的主题数目不限,具体数值在模型分布参数推导过程中自动确定.HDP的采样常用Stick-breaking和CRF等构造方法实现,而模型参数后验分布推断方法主要包括MCMC和变分贝叶斯等.由于HDP忽略数据集的时间等附加信息,简单地假设数据具有可交换性,因此,当数据集的主题表现出明显的时间模式时,HDP的主题挖掘效果不佳.近年来,研究者提出了若干HDP派生模型,通过使用数据集的时间信息辅助主题挖掘.文献[16]针对时序数据随时间演变的统计性质,提出了一个动态分层Dirichlet过程dHDP.该模型为每个时间间隔建立混合分布,并保证初始混合分布与后续混合分布共享相同的主题.文献[17]介绍了一个动态主题模型dDTM,分析带有时间戳信息的文档集潜在主题.dDTM模型按照特定的时间间隔划分整个文档集,每个子集的文档是由混合分布的某个主题生成,针对NIPS论文集的实验验证了该模型的有效性.文献[12]设计了一个演化分层Dirichlet过程EvoHDP,从多个相互联系的时变文档集中,发现有趣的主题演变模式,包括主题的形成、演变以及消亡.EvoHDP模型由一系列携带时间信息的HDP构成,每个HDP依赖相邻的HDP,并采用级联Gibbs采样模式推断.文献[18]指出时序数据流的主题数目、分布和流行度等潜在语义结构是随时间演变的,为了描述这些演变规律,提出了一个非确定性动态主题模型iDTM.该模型根据时间间隔组织文档集,保持文档的时间顺序关系,消除了文档可交换的假设,最终在NIPS论文集上取得令人满意的结果.文献[19]结合数据集的时间信息,提出了一个基于HDP的distancedependentChineseRestaurantFranchise(ddCRF)模型.该模型由文档层次的ChineseRestaurantProcess(CRP)[25]和文档集层次的distancedependentChineseRestaurantProcess(ddCRP)[26]构成.其中,CRP假设文档内的单词是可交换的,按照主题对单词进行聚类;而ddCRP假设文档之间具有不可交换性,首先计算各文档的时间间隔,再根据已定义的衰减函数求解文档之间的依赖关系,以便实现文档集的主题聚类.实验表明ddCRF模型能够捕捉时序数据集潜在主题的时间模式,在学术论文集上的主题挖掘效果尤为突出.尽管上述HDP派生模型利用了时间信息,且在学术论文潜在主题的挖掘上效果显著,但是对于微博数据,仅考虑主题的时间模式还不足以实现主题的准确建模,也无法有效地解决数据稀疏问题.Page43MB-HDP模型针对现有模型的不足,考虑到微博的时间信息、用户兴趣和话题标签反映了消息的主题分布情况,有助于聚合主题相关的消息以克服数据稀疏的困难.本文提出基于HDP的MB-HDP模型,充分利用时间信息、用户兴趣和话题标签,假设微博数据不可交换,并扩展ddCRF进行主题建模,实现微博主题自动挖掘.3.1问题描述在微博主题自动挖掘问题中,消息集合表示为x={x1,x2,…,xJ},其中J是消息总数目,消息按照时间顺序排列.第j条消息xj由Nj个单词组成,即xj={xj1,xj2,…,xjNV表示词典的大小.xj由用户uj生成,其中uj∈{1,2,…,U},U表示用户集合的大小.xj的发布时间是tsj,其中tsj∈{1,2,…,TS},TS表示时间戳集合的大小.xj与特定的话题标签htj关联,其中htj∈{0,1,…,HT},HT表示话题标签集合的大小.注意,如果xj包含若干话题标签,则选取第一个标签;如果xj不存在话题标签,则htj标记为0.假设消息可由无限个主题的概率分布表示,而主题是词汇表中所有单词的概率分布,则微博主题自动挖掘指的是从消息集合x中自动发现K个潜在主题Φ=(k)K3.2HDP主题模型k=1.HDP本质上是Dirichlet过程混合模型的多层形式,现已成为文本主题挖掘的重要工具.HDP假定文档集共享相同的主题,且主题数目不限.相比参数贝叶斯模型,HDP具有良好的鲁棒性和灵活性.下面详细介绍基于文本主题挖掘的两层HDP模型.首先,从基分布H和Concentration参数γ构成的Dirichlet过程中,抽样分布G0.其次,从基分布G0和Concentration参数α0构成的Dirichlet过程中,为每一个文档抽取主题分布Gj.从式(1)可看出,各个文档的主题均服从基分布H,保证了各个文档之间的主题共享.通常,基分布H选取参数为η的Dirichlet分布.每个主题k是H的一个独立抽样,本质上是关于单词的概率分布.在文档xj中,(θji)N变量序列,θji指示了单词xji所分配的主题,隶属于Φ.文档xj的生成过程如下:其中,F(θji)表示给定参数θji下,单词xji的分布.为简化HDP采样过程的计算,F常选取为多项式分布,与基分布H构成共轭分布.为了实现HDP的采样,需设计相应的构造方法,以便推断模型参数后验分布.CRF是其中一种经典的构造方法,已得到广泛应用.在CRF中,J个餐厅共用一份相同的菜单:Φ=(k)K数;第j个餐厅可容纳mj张餐桌:(ψjt)m桌至多可容纳Nj个顾客.顾客可自由选择餐桌,每张餐桌只供应一道菜.餐桌的第一位的顾客负责点菜,该餐桌的其他客人共同享用该菜肴.不同餐厅的不同餐桌,或者是同一餐厅的不同餐桌均可点用同一道菜.在文本主题挖掘应用中,餐厅、顾客和菜肴分别对应了文档、单词和主题.假设δ表示一个概率测度,将单词xji的分布参数θji视为顾客,他以概率njti-1+α0k,或者以概率α0njt表示第j个餐厅里第t张餐桌的顾客数.如果顾客选择一张新餐桌,则根据已选用菜肴的受欢迎程度,以概率mk概率γ∑kk的餐桌数.可见,CRF的构造即是为顾客分配餐桌和菜肴的过程.首先为每个顾客分配餐桌,已有餐桌被选中的概率与其就座的顾客数成正比,而新餐桌也允许以一定的概率被选中.在完成餐桌指派后,为每张餐桌分配菜肴,已有菜肴被选中的概率与其供应的餐桌数成正比,而新菜肴也允许以一定的概率被选中.CRF构造过程对应了文档内单词的主题指派以及文档集的主题聚类,一旦完成CRF构造,即可采用Page5模型参数后验分布推断方法(比如MCMC方法)求解HDP主题模型,进而获取整个文档集的主题分布.3.3MB-HDP模型的框架针对微博主题的自动挖掘问题,本文在HDP的基础上,融合时间信息、用户兴趣和话题标签,提出MB-HDP模型.相比现有的主题模型,MB-HDP模型具有以下优点:首先,参数贝叶斯模型需要用户预先指定主题数目;而MB-HDP模型在主题建模过程中自动搜索合适的主题数目.其次,HDP等模型简单地认为数据具有可交换性,影响了主题挖掘的效果;而MB-HDP模型根据微博应用场景的特点,假设消息是不可交换的.最后,现有的HDP派生模型处理的多是新闻和学术论文等传统文本;而MB-HDP模型针对的是微博数据.考虑消息的短文本特点,深入分析时间信息、用户兴趣和话题标签对主题建模的关键作用,本文提出如下假设:(1)如果消息的发布时间相同,则它们很可能谈论全局的新闻事件,并共享该事件涉及的主题分布;(2)如果消息的发布用户相同,则它们很可能反映了该用户的自身兴趣,并共享该用户兴趣的主题分布;(3)如果消息包含相同的话题标签,则它们很可能与该标签反映的抽象概念或者突发性新闻有关,并共享其内在的主题分布.MB-HDP模型根据上述假设聚合主题相关的消息,从而丰富了词项的共现信息,有效地克服了数据稀疏的困难.而ddCRF等现有模型只利用时间信息,如果直接应用于微博数据,将面临严重的数据稀疏问题.类似HDP的CRF构造,MB-HDP模型采用改进的CRF构造.该构造方法由两层CRP构成:在文档层次上,使用CRP为顾客分配餐桌,而后将顾客按照所在餐桌进行划分,即完成文档内单词的聚类;在文档集层次上,使用ddCRP替换CRP,餐桌供应的菜肴取决于相互关联的其他餐桌,以满足文档的不可交换性约束.而后将餐桌按照供应的菜肴进行聚类,即得到每个文档的主题分布.在改进的CRF中,同一个餐厅的顾客之间不存在依赖关系,但餐桌供应的菜肴受相互关联的其他餐桌的影响.具体来说,如果两个餐桌所在餐厅的位置彼此靠近(即消息的发布时间相同),或者拥有者是同一人(即消息的发布用户相同),或者招牌菜相同(即消息的话题标签相同),则认为它们是相互关联的.据此,MB-HDP模型将时间信息、用户兴趣和话题标签融入到CRF构造过程,有效地聚合消息并辅助主题建模.基于改进CRF的MB-HDP模型的框架如图1所示.在文档层次的CRP中,长方形表示餐厅/文档,附加信息包括时间戳ts、用户u和话题标签ht;大圆表示餐桌,对应变量ψjt;小圆表示单词xji的分布参数θji.在文档集层次的ddCRP中,大圆表示菜肴/主题k;小圆、正方形和菱形均表示餐桌,分别表示在时间信息、用户兴趣和话题标签的影响下,餐桌按照其供应的菜肴进行聚类.图1基于改进CRF的MB-HDP模型的框架基于改进的CRF构造方法和MB-HDP模型框架图,对微博数据的生成过程进行解构.符号定义如下:tji为单词xji所在餐桌的索引,t={tji:(j,i)};kjt是餐桌ψjt所供应菜肴的索引,k={kjt:(j,t)};zji表示xji的主题索引,z={zji:(j,i)};nk和nv别是主题k中所有单词和单词索引为v的个数;分布参数θji对应xji所在的餐桌,Θ={θji:(j,i)};餐桌ψjt供应某道菜肴k,Ψ={ψji:(j,i)};xjt表示餐桌ψjt的所有顾客.约定某一变量的上角标有负号时,表示移除相应的变量或变量集.比如,t-ji表示除tji外的所有餐桌索引,n-jiψjt的顾客总数,n-x客总数.MB-HDP模型的生成过程包括3个主要步骤:第1步,生成全部单词所对应的分布参数θji.由于采用CRP对消息建模,θji的条件分布依赖Θ中剩余Page6的变量.式(3)描述了详细的抽样过程:如果根据第1项抽取θji,则表示顾客就座于已有餐桌,令θji=,tji=t;如果根据第2项抽取θji,则表示顾客就座ψjt于新餐桌,令mj=mj+1,同时由分布G0采样得到新餐桌ψjm每张餐桌ψjt由于采用ddCRP对消息集合建模,消息的主题指派受相互依赖的其他消息影响,ψjtΨ中相互关联的剩余变量:ψjtψ11如果根据第1项抽取ψjt,则表示顾客选择已有菜肴,令ψjt=k,kjt=k.如果根据第2项抽取ψjt,则表示顾客选择新菜肴,令K=K+1,同时由分布H采样得到新菜肴K~H,令ψjt=K,kjt=K.式(5)中的Sjt,jt反映了餐桌ψjt和ψjt之间的关联程度,其计算方法由消息的发布时间、发布用户和话题标签三者共同决定,该值大小与餐桌之间的关联程度成正比.Sjt,jt=1[tsj=tsj]+1[uj=uj]+1[htj=htj]第3步,生成每个可观察的单词xji.给定xji的主题索引为k,则生成xji的条件概率为fk({xji:zji=k}).由于基分布H为Dirichlet分布,主题的单词分布F为多项式分布,它们互为共轭分布;再利用Γ函数的递推性质,可得fk({xji:zji=k})=一旦fk({xji:zji=k})已知,给定t和k,则消息集合x的条件分布为3.4MB-HDP模型的采样本小节主要分析MCMC采样方法对MB-HDP模型实现采样.MCMC方法基于改进的CRF,根据可观测变量x,对所有的分布参数θji和ψjt采样.为了方便起见,对餐桌索引t和菜肴索引k采样,而不是直接采样Θ和Ψ.一旦索引变量已知,容易重建相应的聚类,进而得到消息集合的主题分布以及主题的单词分布.为了计算索引变量后验概率,需要先求解xji和xjt的条件概率.假设先验Dirichlet分布H以概率h(k|η)抽样主题k,多项式分布F以概率f(xji|k)从主题k中抽样单词xji.给定主题k中除xji以外的所有单词,xji的条件概率为f-xk(xji)=p(xjix-ji,t,k)=ji∫f(xjik)∏ji≠ji,z由于基分布H和主题的单词分布F是共轭分布,式(9)可进一步简化:其中,n-x总数.给定主题k中除xjt以外的所有单词,xjt的条件概率ff-xk(xjt)=jt(1)t采样.考虑tji继承了θji的可交换性,其后验概率正比于餐桌ψjt的顾客人数与xji条件概率之积:p(tji=tt-ji,k,x)∝在式(12)中,f时,表示顾客选择一张新餐桌,可观测单词xji的条件分布由餐桌之间的关联关系决定:p(xjitji=tnew,t-ji,k)=∑给定tji=tnew,xji的先验条件概率:f-x随后,对新餐桌分配菜肴kp(kjtnew=kt,k-jtnew)∝∑jt≠jt,k烄烅γ·f-x烆Page7其中,∑jt≠jt,k供应k的所有餐桌与ψjt的关联程度累加得到.(2)k采样.一旦完成所有餐桌的分配,即可对餐桌分配菜肴.kjt采样类似tji,每次修改k更新餐桌ψjt的所有单词的主题.因此,kjt的后验概率正比于菜肴受欢迎度与xjt条件概率之积:p(kjt=kt,k-jt,x)∝烄烅γ·f-x烆(3)Φ采样.给定t,k和可观察文档集x,每个主题k后验分布概率只依赖该主题下的所有单词:p(k|t,k,x,Φ-k)∝h(k|η)∏ji:k算法1.微博主题自动挖掘算法.输入:消息集合x,分布参数η,α0和γ输出:主题数目K,以及主题集合(k)K步骤:1.FOR所有文档xj∈xDO2.FOR所有单词xji∈xjDO3.根据式(12),为xji指派餐桌,索引为tji.4.IFtji=tnewTHEN5.根据式(15),为新餐桌分配菜肴,索引为kjt6.ENDIF7.ENDFOR8.FOR所有餐桌tji∈xjDO9.根据式(16),为tji分配菜肴,索引为kjt.10.ENDFOR11.ENDFOR12.根据式(17),计算K个主题的单词分布(k)K13.RETURNK,(k)K3.5微博主题自动挖掘算法MB-HDP模型通过MCMC采样方法,间接求解出消息集合中微博在主题上的概率分布参数Θ,以及主题在单词上的概率分布参数Ψ.利用这些分布参数,可进一步挖掘整个消息集合的潜在主题,以及每个主题最具有代表性的单词.在此基础上,设计一个基于MB-HDP模型的微博主题自动挖掘算法,具体流程如算法1所示.4实验本小节通过实验评估MB-HDP模型的有效性.实验数据集为真实Twitter消息,实验指标是生成主题的质量、内容困惑度和模型复杂度.为了验证时间信息、用户兴趣和话题标签对主题挖掘效果的重要作用,本文设计了3个简化的MB-HDP模型与HDP作对比.4.1数据集实验数据集包含了2009年9月到2010年1月之间的3845622条消息[27].由于消息是非正式的短文本,内容质量差异大,因此需要采用数据预处理技术过滤低质量的消息.首先,预先准备一个停用词列表,删除消息中频繁出现而没有实际意义的停用词.接着,采用Snowball算法①提取词干.将单词转化为词干有利于识别同根词,从而改善主题挖掘效果.比如“stemmer”、“stemming”和“stemmed”的词干均为“stem”.最后,删除文档频率低于20的单词,保留单词数不小于8的消息.预处理后,得到一个包含100000条消息的数据集,详细描述如表1所示.描述消息数量数据10000041051147688410103511012517344001260280443本文选取LDA[7]和HDP[11]作为对比.LDA的参数包括主题数目K、Dirichlet分布超参数α和β,经过实验调优分别设置为50、0.5和0.02.在HDP及派生模型中,基分布H的超参数η设为0.5,concentration参数由gamma先验分布决定:γ∝Γ(1,0.1),α0∝Γ(1,1).实验平台是WindowsXP操作系统,IntelCorequad-core(3.10GHz)处理器,内存容量为4GB.4.2主题质量主题质量评估包括有效性、独特性和多样性等.(1)主题有效性.微博主题挖掘的目标是从海量消息中找出有趣的主题.输出最能代表主题的单词,人工判断它们与描述主题的相关程度,是评价主题模型有效性的典型方法.限于篇幅,表2只给出各个主题模型所找到的9个相同主题,每个主题由概率最大的前10个单词表示.图2是人工评判主题有效性的投票结果.MB-HDP模型抽取的主题,52.6%被认为是最准确的;LDA和HDP分别得到18.4%和28.9%的投票.说明MB-HDP模型抽取的单词能够准确表达主题的①http://snowball.tartarus.org/Page8MB-HDPobama#tcothealth#p2carebillsenatepresident#tlothouseMB-HDPfridaydealblackshopcommondayholidayfreeonlinesaveMB-HDPjobsaleservicemanagerdetailengineerhealthsystempartmedical表2潜在主题的前10个单词RealEstateHDPrealhomeestatepressreleasesalemortgageforeclosurecomputerblogcomwwwSwineFluHDPfluschoolpoliceswinestudentcountysaykillh1n1deathStockTradeMarketHDPratereportsalebankjobmarketyorkfinancialstockreuter内容.LDA和HDP由于未考虑微博数据的特点,抽取的主题容易相互混淆,不利于用户理解.另外,LDA预先设置主题的数目,与实际情况相符的机会较小,导致主题的混淆程度加剧.(2)主题独特性.如图3所示,MB-HDP模型挖掘出最多的潜在主题,HDP次之,LDA排在最后.estatetodayarchiveschoolcountystudentofficialupdateswinemichaeljacksonforexdollarglobalmillion原因在于MB-HDP模型能够区分相似度很高的主题.比如,主题“WorldCup”和“FootballGame”被正确区分开来.再者,MB-HDP模型能够发现粒度更细的主题.比如,“Movie”的子主题“HollywoodMovieStar”被正确抽取出来.表3展示了MB-HDP模型检测到的特有主题.Page9表3MB-HDP模型的特有主题(3)主题多样性.主题的多样性评估是衡量主题模型优劣的另一个有效手段.多样性可用主题之间的Kullback-LeiblerDivergence(KL距离)表示:KL(1,2)=∑x主题之间的差异性与KL距离成正比.当KL图4模型的主题KL距离4.3内容困惑度内容困惑度指标被广泛应用于主题模型效果评估.困惑度越低,表明主题模型效果越好,其计算方法如下:perplexity(x)=ex(p-∑设置迭代次数为100,各个模型的困惑度如图5所示.MB-HDP模型明显优于LDA,说明自动确定主题数目是提升挖掘效果的关键因素.HDP比MB-HDP模型略差,说明考虑时间信息、用户兴趣和话题标签,在某种程度上提升了主题挖掘效果.一旦迭代次数超过30,各个模型的困惑度变化不明显.4.4模型复杂度模型复杂度是衡量非参数贝叶斯模型的另一个有效方法.复杂度越低,说明模型用于描述数据集的主题越少.当模型的困惑度差异不明显时,选择复杂距离为0时,表示两个主题完全一致.图4展示了不同模型的KL距离,颜色越深,KL距离越小.显然,MB-HDP模型发现的潜在主题差异性较大.在对比模型中,不同主题出现相同主题词可能性更大,这种冗余现象导致KL距离偏小.度较小的模型.如果模型基于MCMC采样方法推导后验概率,则其复杂度为主题数目与所有主题的复杂度之和.其中,主题k复杂度指的是至少存在一个单词的主题标号为k的微博总数.模型复杂度计算方法参考文献[19]:Page10complexity=K+∑k∑j设置迭代次数为100,各个模型的复杂度如图6所示.两个模型的复杂度增长速率随着迭代次数递增而变化.当迭代次数小于30时,MB-HDP模型的复杂度增长速率明显高于HDP;当迭代次数超过30以后,情况相反.总的来说,MB-HDP模型的复杂度低于HDP.因此,尽管MB-HDP模型的困惑度对比HDP优势不明显,但是综合考虑模型复杂度,MB-HDP模型的总体效果更优.4.5时间信息、用户兴趣和话题标签的重要性为了说明时间信息、用户兴趣和话题标签在微博主题挖掘中的重要性,本文设计了3个MB-HDP模型的简化版本与HDP作对比.简化的MB-HDP模型TimeHDP、UserHDP和HashtagHDP分别利用了时间信息、用户兴趣和话题标签.设置迭代次数为30,各个模型的困惑度和复杂度分别如图7和图8所示.各个模型的困惑度很接近,TimeHDP略优于其他模型,说明时间信息是挖掘潜在主题的关键因素.由于HDP抽取的主题包含更多的冗余信息,而简化的MB-HDP模型找到的主题区分度更高,因此,HDP的复杂度在所有模型中是最差的.综上所述,利用时间信息、用户兴趣和话题标签能够改善微博主题挖掘的效果.5结论本文针对微博潜在主题的自动挖掘问题,结合时间信息、用户兴趣和话题标签,提出一个基于分层Dirichlet过程的非参数贝叶斯模型MB-HDP,有效地克服了数据稀疏的困难,取得了良好的主题挖掘效果.为了推导MB-HDP模型的分布参数,设计了一个基于改进CRF的MCMC采样方法.大量真实数据集的实验表明,MB-HDP模型明显优于LDA和HDP等现有模型.后续的研究工作将侧重开发更加高效的MC-MC采样算法,使得MB-HDP模型适合海量微博数据应用.设计有效的方案进一步整合时间信息、用户兴趣和话题标签,以及深入分析主题之间的层次结构,也是今后的研究重点.致谢感谢帮助本文写作的毕志升老师和洪佳明老师.评审专家对本文提出了宝贵的修改意见,在此也一并表示感谢!
