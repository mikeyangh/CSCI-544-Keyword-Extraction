Page1基于低秩矩阵恢复和联合学习的图像超分辨率重建陈晓璇齐春(西安交通大学电子与信息工程学院西安710049)摘要文中提出一种新的基于低秩矩阵恢复和联合学习的单帧图像超分辨率重建方法.首先根据相似性将训练样本块分成若干个子集合,使用低秩矩阵恢复方法学习每个子集合的潜在结构.然后使用联合学习方法同时训练出两个投影矩阵,将原始高、低分辨率图像块特征的低秩分量映射到一个统一空间中,最后在该统一空间中完成基于邻域嵌入的图像超分辨率重建.实验结果显示文中方法在数量指标和视觉效果上都优于目前几种典型的图像超分辨率重建方法.关键词单帧图像超分辨率重建;低秩矩阵恢复;基于样本;联合学习;邻域嵌入1引言在诸如计算机视觉、医学图像诊疗、视频监控、卫星成像等许多领域都需要使用高分辨率图像.但是在某些情况下由于成像系统和成像环境的限制,很难获得一幅理想分辨率图像.有限的图像分辨率Page2量的高分辨率图像.近年来有很多超分辨率方法被提出来[3-12],这些方法可以大致分为两类:基于重建的超分辨率技术和基于样本的超分辨率技术.其中,基于重建的超分辨率技术[3-4]处理来自同一场景但是彼此之间存在亚像素位移的多幅低分辨率图像,将低分辨率图像中的信息融合起来生成一幅高分辨率图像.此类方法可以在2倍放大时生成质量不错的高分辨率图像,但是当放大倍数增大时重建图质量会下降[5].此外,此类方法容易受到图像错误对准等影响,从而造成重建图质量的严重下降[5].除了考虑图像自身的性质,现在有越来越多的方法着眼于使用由成对的高低分辨率图像块组成的样本集合,试图从样本集合中获得某些信息来重建出高分辨率图像,这种方法被称为基于样本的图像超分辨率方法[6-8].此类方法通常使用机器学习技术来获得高、低分辨率块之间的关系,因此也被称为基于学习的图像超分辨率重建方法.其中,Freeman等人[7]使用马尔科夫随机场模型利用图像局部区域的兼容关系来选择合适的高分辨率图像块对,从而生成高分辨率图像.此方法需要一个庞大的训练集合,计算量大.为克服这个缺点,Chang等人[8]借鉴流形学习中局部线性嵌入思想,提出高低分辨率块组成的流形具有相似的局部结构的假设,将每个测试低分辨率块使用样本集合中若干最近邻的线性组合来表示,通过计算出重建权值并将权值传递给高分辨率样本块的线性组合来生成待重建的高分辨率图像块.此方法避免了使用大的训练集合,能够生成令人满意的重建结果.但是在超分辨率重建问题中,高低分辨率块之间存在一对多的映射关系,因此流形假设不一定成立.为了解决这个问题,Gao等人[9]提出学习两个投影函数分别将高低分辨率块投影到一个统一特征子空间中,在该空间中高低分辨率块组成的流形的局部结构更相似,因此可以在这个空间中进行基于邻域嵌入方法的图像超分辨率重建.为了学习出合适的投影函数,Gao等人[9]提出一个耦合约束,把高低分辨率块的特征向量结合起来,使用这个结合特征将整个样本集合分成若干个子集合.如前所述,在超分辨率重建问题中高低分辨率块之间存在一对多的映射关系,而该方法不光要求低分辨率块相似,也要求高分辨率块相似,这就限制了高分辨率块的多样性.为了更好地保留高分辨率图像块的多样性,本文提出一个只使用低分辨率块特征进行训练集合划分的方法.对于高分辨率块,本文使用一个鲁棒的主成分分析(PCA)方法———低秩矩阵恢复方法[13]来学习它们的主要成分.低秩矩阵恢复方法具有在多项式时间内可求解的计算优势,又具有性能保证[13].低秩矩阵恢复方法已经被用于人脸识别[14]和背景去除[15]等领域,并取得了较好的效果.它的基本思想是:假设一个矩阵犃的列是一些属于同一模式的向量.因为这些向量来自同一模式,所以在很多情况下它们是线性相关的,因此矩阵犃具有低秩的性质.低秩矩阵恢复方法试图将这样的一个矩阵犃分解为一个低秩矩阵犔和一个稀疏矩阵犛,其中犔具有低秩性,矩阵犛具有稀疏性.犔中的列向量要比犃中的更紧凑地位于同一个子空间上.正因如此,为了学习出子集合中特征的结构来更好地满足邻域嵌入假设,从而实现图像超分辨率重建,本文提出使用低秩矩阵恢复方法来学习每个子集合中特征的潜在低秩结构.本文提出的方法可以分为以下几个步骤:首先依据相似性将训练集合划分成若干个子集合,每个子集合中的块位于同一个低维度的子空间上.然后使用低秩矩阵恢复方法学习出这个子空间的结构,求解出的特征的低秩分量虽然在长度上没有变化,但是它们彼此之间的联系更紧密了.然后再使用联合学习方法[9]同时训练出两个投影矩阵,将原始高、低分辨率特征的低秩分量分别映射到一个统一空间中.最后在该统一空间中完成基于邻域嵌入的超分辨率重建,得到初始高分辨率图像.为了令重建的高分辨率图像满足全局重建约束,本文使用迭代反向投影方法[16]来进一步提高重建图的效果.本文第2节介绍低秩矩阵恢复方法对训练集合的处理步骤;第3节介绍基于联合学习的图像超分辨率重建方法,第4节给出实验结果;第5节为总结.2低秩矩阵恢复方法对分组的训练样本做处理训练数据为成对的高低分辨率样本图像块集合,分别由低分辨率图像块的梯度特征集合Xs={狓is}Ni=1和高分辨率图像块的梯度特征集合Ys={狔is}Ni=1组成,其中狓is是第i个低分辨率图像块的d×1维梯度特征向量,是由该图像块中所有像素在垂直和水平方向上的一阶和二阶梯度值连接起来构成的;狔is是用同样方式生成的第i个高分辨率图像块的m×1维梯度特征向量.此外,Zs={狕is}NPage3分辨率图像块的亮度特征集合,其中狕is是高分辨率图像块的亮度值减去该块亮度平均值的结果,表示第i个高分辨率图像块的高频信息特征向量,长度为f×1.N是样本块的数量.对低分辨率图像块梯度特征集合Xs中的每一个向量狓is,选出它在Xs中的K近邻,将它们与狓is分到一个组中:其中Gi(1iN)表示与狓is有关的分组,NK(i)表示狓is的K近邻的下标集合.为了节省存储空间,不用直接保存Gi中的每个样本向量而只需保存Gi中样本向量的下标即可,公式变为对于测试图像块的梯度特征向量狓j率图像块梯度特征集合Xs中找出其最近邻样本块狓is,然后可得与狓is对应的Gi.Gi中指定了K+1个样本块的下标,将这K+1个低分辨率块梯度特征向量按照一个向量一列的方式组成矩阵,记作犔i∈Rd×(K+1),即犔i={狓rs},r∈Gi.将对应的K+1个高分辨率块梯度特征向量按照同样的方式组成矩阵,记作犎i∈Rm×(K+1),即犎i={狔rs},r∈Gi.为了学习出这两个矩阵中列向量的主要结构,可以使用主成分分析(PCA)方法,即将这些向量投影到一个低维子空间后保留向量的主要结构,但是传统的PCA方法只适用于噪声是密集且为小值的情况.如果噪声值较大,PCA方法的效果就会变差[13].为了避免这种情况,本文使用了一个鲁棒的PCA方法———低秩矩阵恢复方法[13],它可以将一个由多个相关向量组成的矩阵分解为一个低秩矩阵和一个稀疏矩阵的和,其中低秩矩阵是原相关向量的低维度版本,稀疏矩阵表示噪声或原相关向量的差异部分.具体来说,将测试图像块梯度特征狓j加入到低分辨率块梯度特征向量矩阵犔i中,得到一个增广矩阵犃i,即犃i=[狓j特征,分别对矩阵犃i和犎i做低秩矩阵恢复:minlr,犃i犃imin犎ilr,犎isplr和犃isp分别是犃i的低秩分量和稀疏分量,其中犃ilr和犎isp分别是犎i的低秩分量和稀疏分量.使用犎iIALM方法[17]对上述优化方程进行求解.因为低秩矩阵恢复不改变列的含义[13],所以求解得到的犃i可以分为两部分,分别为测试图像块狓j(狓jt)lr和低分辨率块梯度特征向量矩阵犔i的低秩分lr,即量犔i3基于联合学习的图像超分辨率重建在得到高低分辨率梯度特征的低秩分量后,分别使用两个投影矩阵将它们映射到一个统一的特征空间中.在这个统一特征空间中用于超分辨率重建的邻域嵌入假设能够更好地满足[9].具体来说,假设使用两个投影函数犘h∈Rm×p和犘l∈Rd×p将高低分辨率特征的低秩分量(狔is)lr和(狓is)lr投影到一个公共的低维度的嵌入特征空间h(狔is)lr和犘T犘T征空间中,对应的投影后的高低分辨率特征向量的低秩分量能够尽可能地保持距离相近,因此可以建立以下公式:argmin{犘l,犘h}J(犘l,犘h)=argmin{犘l,犘h}∑i∈Gi其中犘l和犘h是需要计算的投影矩阵,(狓is)lr是样本集合中第i个低分辨率特征的低秩分量,(狔is)lr是对应的高分辨率特征向量的低秩分量.注意到优化函数J(犘l,犘h)可以重新写作下面的用矩阵表示的形式,其中Tr表示矩阵的迹.J(犘l,犘h)=∑i∈Gi令犘=犘l则上式化简为加入限制条件犘T犛犛T犘=犐,其中犐是一个单位矩阵.为了求解上述优化公式,令=Ξ犃ΞT,=ΞΞT,则上述优化问题的解可以通过求解广义特征问题狆=λ狆的广义特征向量狆来得到,其中λ是广义特征值.此外,由于通常不可逆,需要在计算过程中加入正则操作,即令=+τ犐,其中τ是一个小的正数.实验发现对使用正则操作也会改善效果.选择第2个到第p+1个最小的特征值对应的特征向量组成最佳投影矩阵犘[9,18],将其分为两部分得到最佳投影矩阵犘l和犘h.Page4使用犘映射到统一特征空间:犕l=犘T辨率块梯度特征的低秩分量犎i间:犕h=犘Th犎i的低秩分量(狓j间:mjt=犘Tl(狓j最后,在统一特征空间中执行基于邻域嵌入的图像超分辨率重建,具体步骤如下:在犕l中寻找mj的k个最近邻,采用犕h中对应的最近邻重建出mj计算出使重建误差最小的权值ωja:其中Nk(j)表示mj犕h中的第a列.使用权值ωja和对应的高分辨率样本重构出高分辨率块的亮度向量狕j对狕j加上其平均亮度值珋l得到高分辨率块亮度向量犺j得到所有高分辨率块亮度向量犎t={犺j将其融合生成初始高分辨率图Ht0.对邻近块彼此重叠的部分使用平均融合.采用上述邻域嵌入方法生成的高分辨率图像是将图像分成块后对每一个块进行处理的,通常这种方式得到的高分辨率图像都不满足全局重建约束.为了进一步提高超分辨率图像的质量,本文采用迭代向后投影算法[16]对上述步骤得到的超分辨率重建结果加入全局重建约束,同时考虑了初始超分辨率结果和最终超分辨率结果之间的一致性约束.下面分析本文算法的时间复杂度和空间复杂度.在训练阶段,本文算法先对图像进行分块,时图1测试图像(依次称之为测试图“花”,“蝴蝶”,“老人”,“虎”,“马”,“建筑”,“女孩”,“蕾娜”)间复杂度为O(dN),再计算分组,计算复杂度为O(dKN2).再执行2次关于高、低分辨率块梯度特征的低秩矩阵恢复,记作2×OIALM(·).文献[13]指出低秩矩阵恢复可以在多项式时间内被求解出来,低秩矩阵恢复算法的主要计算代价在于每次迭代时需要计算一次partialSVD.本文算法存储高低分辨率块梯度向量的空间复杂度为O(dN+mN),存储高分辨率块亮度向量和分组信息的空间复杂度分别为O(fN)和O(KN).此外,还需加上做完低秩矩阵恢复的高低分辨率块梯度向量的低秩分量和稀疏分量O(2dN+2mN).整理结果见表1.在重建阶段,本文算法需要对测试低分辨率图像分块,其时间复杂度为O(dM),找出最近邻样本和对应的分组的时间复杂度为O(dMN).公式狆=λ狆中的广义特征分解需要的时间复杂度为O(d3M)[9].计算统一特征子空间中最佳权值和合成所有图像块的时间复杂度分别为O(k3pM)和O(kfM).此时,本文算法需存储高低分辨率块梯度向量及其低秩分量和稀疏分量、高分辨率块亮度向量、分组信息和测试图像块信息,空间复杂度分别为O(3dN+3mN)、O(fN)、O(KN)和O(3dM),见表1.复杂度时间复杂度空间复杂度4实验部分在本节中将本文方法与几种典型的图像超分辨率重建方法做了实验比较.对如图1所示的8幅测Page5试图做3倍放大的超分辨率重建,这些测试图包含了人类、植物、动物和建筑.首先将彩色图像从原RGB空间变换到YCbCr空间,因为人类视觉系统对亮度分量比色度分量更敏感,所以只对亮度分量做超分辨率重建,对两个色度分量采用双三次插值方法放大到想要的倍数.将本文方法与双三次插值、基于邻域嵌入的超分辨率重建方法(缩写为NESR)[8]和Gao等人[9]的方法(缩写为JLSR)做了比较.图像的梯度特征采用文献[10]中方法计算.因为低分辨率图的中频信息和高频信息的相关性比低频信息和高频信息的相关性更大,所以对原始低分辨率图像使用双三次插值进行2倍上采样,再对插值后的图像做超分辨率重建[9-10].将插值后的低分辨率图像划分成大小为6×6的块.为了保证重建结果图中块的兼容性,相邻块之间有2个像素的重叠.对应的高分辨率图划分为9×9的块,彼此有3个像素的重叠.因为低分辨率块梯度特征不包含亮度信息,所以高分辨率块的亮度特征中去除了亮度信息,即从高分辨率块中减去该块的平均亮度值来保留高分辨率块的高频信息.实验中使用的特征向量的数量是128,邻域嵌入中最近邻的数量是5.参数的数值是通过实验确定的.对NESR方法同样使用5个最近邻数量.JLSR方法中参数的设定参考文献[9].表2给出了使用不同方法得到的测试图像的超分辨率重建结果的PSNR和SSIM数值.从表2可以看出本文方法比其他几种方法得到更高的PSNR和SSIM数值,这显示了本文方法的有效性.图2给表2不同方法生成的超分辨率重建图的PSNR和SSIM数值测试图双三次插值NESRJLSR本文方法花26.549蝴蝶24.193老人27.589虎25.526马31.122建筑25.031女孩32.705蕾娜30.310平均值27.846出了由不同方法得到的测试图像“女孩”的超分辨率重建结果图.本文方法重建出的图像与双三次插值方法和NESR方法相比有着更尖锐的边缘,如在鼻子区域,本文方法得到的重建图中鼻子的轮廓更清晰.JLSR方法得到的超分辨率重建图在图像左下部的头发区域产生了瑕疵点,而本文方法则不会产生.此外,如图3所示,由NESR方法和JLSR方法生成的测试图“花”的超分辨率重建图中在花的边缘上有明显的瑕疵点,而由本文方法生成的图中则没有.这说明了本文提出的超分辨率方法在数量指标和视觉质量上都要好于其他几种超分辨率方法,这证明了本文方法的有效性.此外,本文考察了邻域嵌入方法中最近邻数量k对实验结果的影响.图4描述了8幅测试图像的超分辨率重建结果的PSNR和SSIM平均值随最近邻数量k变化的结果.从图中可以看到当最近邻数量大于5时,PSNR和SSIM的平均数值继续提高,图2不同方法得到的测试图“女孩”的超分辨率重建图Page6图3不同方法得到的测试图“花”的超分辨率重建图图4最近邻数量对超分辨率重建结果的影响在最近邻数量为9时到达顶峰;当最近邻数量继续增加时PSNR和SSIM的平均数值逐渐降低.在之前实验中为了做比较,3种方法使用了相同的最近邻数量,而从该实验可以看出本文方法还有进一步提高性能的空间.本文算法还与文献[12]做了比较.文献[12]利用从测试图自身获得的高低分辨率块来实现超分辨率重建.图5给出两种方法的超分辨率重建图.从图5中可以看出,文献[12]能生成边缘清晰的结果图,但是边缘过于刻板,与真实场景不一致.而本文方法得到的超分辨率重建结果图边缘既清晰又真实.图5本文方法与文献[12]的超分辨率重建图5结论本文提出一种新的基于样本的单帧图像超分辨率重建方法.首先依据低分辨率图像块的相似性将训练集合划分成若干个子集合,每个子集合中的块位于同一个低维度的子空间上.再使用联合学习方法同时训练出两个投影矩阵,分别将原始高低分辨率特征的低秩分量映射到一个统一空间中.最后在这个统一空间中完成基于邻域嵌入的超分辨率重建,得到高分辨率图像.文中将提出的方法与其他几种典型的超分辨率方法在几幅自然图像上进行了定性和定量的实验比较,实验结果显示本文方法在Page7PSNR和SSIM的数值上要高于其他几种方法,在视觉效果上也好于其他方法,这证明了本文方法的有效性.值得注意的是,本文方法只利用了特征的低秩分量,如何利用稀疏分量的信息是以后的一个研究方向.此外,本文使用线性投影矩阵进行投影,即假设高、低分辨率特征组成的流形之间具有线性的局部几何关系,在未来工作中将尝试使用非线性方法将两者的关系描述为非线性关系.
