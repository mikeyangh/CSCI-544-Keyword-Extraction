Page1对pSFLASH扰动公钥密码的一个实际攻击孙思维1)胡磊1)蒋鑫1),2)1)(中国科学院研究生院信息安全国家重点实验室北京100049)2)(中国航天科技集团公司第九研究院第七零四研究所北京100076)摘要通过对SFLASH的中心映射进行扰动,最近Wang等人提出了一个新的多变量公钥系统pSFLASH.pSFLASH的设计者认为,扰动后的中心映射可以破坏SFLASH公钥潜在的数学结构,从而抵抗针对SFLASH的差分代数攻击[2-3].然而对于以(T-1,U-1,β,γ)为私钥的任一pSFLASH实例,一定存在一个可逆仿射变换珦U,使它变成一个以(T-1,珦U-1)为私钥的SFLASH实例,因此利用对SFLASH的差分代数攻击[2-3],在几秒钟的时间内可以实际地伪造出任意消息的合法的pSFLASH签名.关键词多变量公钥密码;SFLASH;线性化方程攻击;差分代数攻击1引言公钥密码已经成为现代信息社会中保护数据通信的一种重要工具.经典的公钥密码算法主要基于大整数分解(如RSA算法)和离散对数(如ElGmalPage2常有意义.研究者们在此方向上进行了各种努力与尝试,构造了一些新的公钥算法.一些著名的例子包括基于一般线性码译码问题的McEliece公钥算法[5]、基于格问题的NTRU公钥算法[6]和基于有限域上多项式方程组求解问题的多变量公钥系统MI[7].这些新提出的公钥算法所基于的数学问题,至今没有找到有效的量子多项式时间算法.多变量公钥密码被认为是一类很有前途的可以抵抗量子计算机攻击的公钥系统.近年来各种新的多变量公钥系统的构造方法层出不穷[8-10],同时在对多变量公钥系统的攻击方面,研究者也积累了大量的经验.一些著名的攻击包括线性化方程攻击[11]、高阶线性化方程攻击[12]、小秩攻击[13]和差分代数攻击[2-3]等等.其中差分代数攻击成功攻破了SFLASH多变量公钥系统.最近,一些研究者研究了如何修复SFLASH公钥系统,文献[14]将SFLASH密码系统的消息空间定义在一个超平面上,以挫败差分代数攻击[2-3]中所利用的差分对称性质.而在文献[1]中,设计者试图通过对SFLASH算法的中心映射F进行扰动,设计出抵抗差分代数攻击的新的多变量公钥密码.第2节介绍原始SFLASH多变量公钥系统以及文献[1]设计的扰动SFLASH———pSFLASH;在第3节中,我们简要描述对SFLASH的线性化方程攻击和差分代数攻击;在第4节中,我们证明pS-FLASH系统等价于原始的SFLASH系统,并给出对pSFLASH的实际攻击.2SFLASH和pSFLASH多变量公钥系统SFLASH是一个用于签名的多变量公钥系统,它是2003年NESSIE推荐的3个签名算法之一,SFLASH算法的签名速度很快,并且适合在一些轻量级设备(如RFID智能卡)上实现,下面我们给出SFLASH的描述.2.1MI和SFLASH多变量公钥系统设k是一个有q个元素且特征为2的有限域,而K=k[x]/g(x)是k的一个n次扩域,其中g(x)是k[x]上的n次不可约多项式.令:K→kn是K与kn的自然同构,即Matsumoto-Imai(MI)型多变量公钥系统[7]的公钥P:kn→kn为而SFLASH型多变量公钥系统的公钥PΠ:kn→kn-r为其中,U,T是kn到kn上的可逆仿射变换;Πn-r的作用是n个坐标到它前n-r个坐标的投影.因此,SFLASH是一个“减”版本的MI系统[15].以下记Πn-rT为TΠ.F是K到K上的一个可逆变换,我们称其为中心映射,按如下的方式定义其中gcd(qθ+1,qθ-1)=1.因为τ:XXqθ是K到K上的k-线性映射,所以SFLASH系统的公钥可以写成一组k上的二次多项式,形如yi=∑0jknξijkxjxk+∑0jn注意,虽然这组多项式是公开的,但U和T是保密的,U-1和T-1作为SFLASH系统的私钥.对于消息狔=(y0,y1,…,yn-r-1)T∈kn-r,签名的过程为:首先任取r个k上的元素,把狔补成一个n维向量z,然后计算狓即为消息狔的签名.签名的验证过程为:计算ω=PΠ(狓),然后比较ω是否与狔相同,如果相同,签名验证通过.由于P是公开的,所以任何人都可以执行签名验证这个操作.但只有私钥拥有者,才能通过U-1和T-1来计算签名.对于一个想要伪造消息狔的签名的攻击者,伪造签名最直接的方式就是解如下由公钥P得到的多项式方程组若得到一个解狓,从而PΠ(狓)=狔.然而,解一个有限域上的一般的多项式方程组通常是困难的.虽然通过直接解上述方程组来攻击SFLASH是困难的,但Dubois等人利用SFLASH公钥差分的结构攻破了该系统[2-3].为了抵抗这种差分攻击,文献[1]提出了一个新的用于签名的多变量公钥系统pSFLASH.下面给出pSFLASH的具体构造.Page32.2pSFLASH多变量公钥系统pSFLASH的构造思想是,对原始的SFLASH系统的中心映射F进行所谓的“噪声扰动”,从而破坏公钥的差分结构.定义1.定义二元运算:K×K→K为ab=-1(a0b0,a1b1,…,an-1bn-1),其中(a0,a1,…,an-1)=(a),(b0,b1,…,bn-1)=(b).文献[1]称其为噪声运算.定义2.称〈PG,〉={β:β∈K,-1(β)∈(k)n}为SFLASH系统的噪声群,其中k表示有限域k的乘法群.从SFLASH的噪声群中任意取两个元素β,γ,令Fd:K→K为现在我们用Fd替换SFLASH的中心映射F,其它运算保持不变,便得到了pSFLASH系统,即pS-FLASH的公钥为在以后的讨论中,我们记TFd-1U为Q.因此,QΠ=Πn-rQ.文献[1]认为,SFLASH的中心映射经过这样的“噪声扰动”,就可以避免差分代数攻击,下面两节的分析指出,事实上并非如此.3对SFLASH的攻击3.1MI系统的线性化方程攻击由Y=F(X)=Xqθ+1可以得到两边同乘XY,有而对K上的元素进行qθ和q2θ次幂,都是K上的k-线性映射,所以对于任意的满足狔=P(狓)的狓和狔,其分量一定满足一些形如∑i,j的多项式方程.文献[11]的分析表明,对于MI系统任意给定的公钥,一定可以找到足够多的、相互独立的形如式(2)的多项式方程.这样,当攻击者想恢复狔=P(狓)的原象时,他并不需要去解由狔=P(狓)对应的多项式方程组,而是将狔代入形如式(2)的多项式方程组,此时便得到了一个关于xi的线性方程组,解这个线性方程组便可以得到狔在P下的原象狓.这种恢复原象的过程,就是著名的线性化方程攻击[7].为了避免上述线性化方程攻击,SFLASH的设计者在MI系统的中心映射P的基础上加入了一个投影映射Πn-r,即隐藏了由P(狓)导出的多项式方程组的最后r个多项式.文献[15]的分析表明,攻击者无法直接利用这样处理后所得到的公钥多项式组,找到足够多的、相互独立的形如式(2)的多项式方程组,从而线性化方程攻击对SFLASH失效.3.2SFLASH的差分代数攻击由上一小节的分析可知,如果我们能克服SFLASH系统中投影变换Πn-r的作用,便有可能利用线性化方程攻击来伪造SFLASH系统的合法签名.而SFLASH系统公钥差分的对称性质,使得攻击者可以达到这一目的[2-3].为了叙述方便,下面不再显式地写出自然同构映射,当运算需要时,我们认为所考虑的元素或向量被自然地同构映射或逆映射到相应的向量或域元素.另外,假设所有可逆仿射变换为可逆线性变换,这并不影响分析,具体细节参考文献[16-18].首先,引入差分算子D:Df(a,x)=f(a+x)-f(a)-f(x)+f(0),则对于SFLASH系统的中心映射F,有对于ξ∈K,可以得到DF(ξ·a,x)+DF(a,ξ·x)=(ξ+ξqθ)·DF(a,x)这是MI系统中心映射的差分具备的一个重要的对称性质.令P=TF-1U,则由DP(a,x)=TDF(U(a),U(x))与式(3)可以得到TDF(ξ·U(a),U(x))+TDF(U(a),ξ·U(x))=T(ξ+ξqθ)·DF(U(a),U(x))=T(ξ+ξqθ)·T-1(DP(a,x)).用Mξ,ML(ξ)和Nξ分别表示映射Mξ:xξ·x,ML(ξ):x(ξ+ξqθ)·x和Nξ:xU-1MξU(x).将Πn-r作用到上式,得到其中Λ(L(ξ))表示映射TΠML(ξ)T-1.当U固定时,{Nξ:ξ∈K}是一个由线性变换组成的n维k-线性空间,它是由全体线性变换组成的n2维k-线性空间的一个子空间.而一般的线性变换并不满足上式,由此可以用简单的线性代数很容易地计算出这个子Page4空间,请参考文献[2-3].实际上,由这个子空间还可以计算出U的一部分信息,见文献[19],不过下面的分析并不需要这一点.注意,在复合映射PΠ(狓)=Πn-rTF-1U(狓)式中,T的作用实质上是通过对F-1U(狓)的分量多项式进行新的线性组合得到一组新的分量多项式.如果能在TΠ=Πn-rT的复合之前引入一个新的线性变换,则很可能得到一些与PΠ所对应的多项式组线性独立的多项式,从而得到与MI系统等价的公钥多项式,进而利用线性化方程攻击,就可以伪造出SFLASH系统的合法签名.注意到PΠNξ=TΠFU(U-1MξU)由于TΠMξqθ+1与Πn-rT一般是线性独立的线性变换,所以利用PΠNξ,就可以得到所需的与PΠ所对应的多项式组线性独立的公钥多项式.实验证明,这种方法是完全可行的[2-3].4对SFLASH及pSFLASH的攻击4.1理论分析对于pSFLASH系统的中心映射Fd,我们有DFd(a,x)=βa·(βx)qθ+(βa)qθ·βx.pSFLASH的设计者认为,由于β是未知的,所以上述差分攻击对SFLASH无效.我们指出,pSFLASH公钥系统与SFLASH系统实质上是等价的.定理1.对于任意给定的β,γ∈〈PG,〉,一定存在仿射变换珦U,使得对任意的x∈kn,有其中QΠ是pSFLASH系统的公钥映射.证明.设可逆仿射变换U为U(狓)··=犃狓+犫,其中犃是k上n×n可逆矩阵,犫为k上的n维常向量.令犃狓+犫=狌=(u0,u1,…,un-1)T,并令珦U(狓)=犕犃狓+犕犫+γ=犕(犃狓+犫)+γ,可见珦U仍然是一个可逆的仿射变换.此时,我们有它进一步等于珟P=烄T-1烆烄烆T(((-1(β0u0+β1u1+…+βn-1un-1))qθ+1))=T(((β狌+γ)qθ+1))=T(((β(犃狓+犫)+γ)qθ+1))=Q(狓).上述等式两边同时作用投影映射Πn-r,得到也就是说,只要把pSFLASH系统中的秘密仿射变换U换成珦U,并去掉pSFLASH对SFLASH系统中心映射F的扰动,则pSFLASH系统变成SFLASH系统.由前一节的分析可以看出,对SFLASH的差分攻击与仿射变换U的选取无关.4.2实验数据下面给出伪造pSFLASH消息狔∈kn-r的签名的具体步骤并给出相应的实验结果.1.把pSFLASH的公钥多项式组QΠ看成一组SFLASH系统对应的公钥多项式.利用差分攻击,求出相应的线性空间{Nξ:ξ∈K}.它是线性变换的集合.2.从{Nξ:ξ∈K}中任选一线性变换,计算QΠNξ(狓),从而得到n-r个多项式,从这n-r个多项式中随机选取r个,加入到由QΠ(狓)对应的公钥多项式组中去,记新得到的公钥多项式组为珟Q(狓).3.对珟Q(狓)实施线性化方程攻击,得到狓,验证QΠ(狓)=狔因为SFLASH两个推荐版本的参数为:SFLASHv2—q=27,n=37,θ=11,r=11;SFLASHv3—q=27,n=67,θ=33,r=11,所以我们选取的攻击目标的参数都与上述参数相同或相近,在一台内存为3.25GB,主频为2.83GHz,Intel(R)Core(TM)2QuadCPU的计算机上,我们用Magma代数系统实现了上述攻击(只用了单核),实验结果见表1,另外我们在附录中给出了一个小规模的例子.其中表1中预计算耗时一行中显示的是恢复{Nξ:ξ∈K}的时间与恢复r个缺失多项式所用时间之和.是否成立,如果成立,签名伪造成功,否则重复步2.qnθr预计算耗时/s伪造签名耗时/s273681168+527371111100+232740812121+1727441213140+56276733113523+8122712833132210+513Page5实验表明,在各种典型的参数下,对一个给定的pSFLASH系统,通过最多两个小时的预计算后(此预计算对一个给定的公钥是一次性的),对任意消息狔,我们可以在几秒钟内伪造一个合法的pSFLASH签名.从而,文献[1]中的扰动方法对原始算法安全性的加强是无效的.5结束语在本文中,我们证明了pSFLASH系统与SFLASH系统在不考虑公钥中的两个可逆仿射变换的意义下是等价的,因此利用差分攻击和线性化方程攻击可以给出一个对pSFLASH的实际攻击,pSFLASH系统是完全不安全的.实际上,通过简单的扰动来增强类似于SFLASH这样的公钥系统的安全性是相当困难的问题[20-21],这方面的研究仍然是一个公开课题.
