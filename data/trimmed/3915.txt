Page1一种新颖的医学图像建模及相似性搜索方法潘海为李鹏远韩启龙谢晓芹张志强高琳琳(哈尔滨工程大学计算机科学与技术学院哈尔滨150001)摘要医学图像采集和存储技术的发展导致了相关数据的飞速增长,这些医学图像数据能够有效地辅助医生进行精确的诊断,但由于医学图像在相似性搜索方面要求图像匹配的精度远高于普通图像,所以目前仍没有一种有效的方法解决医学图像的相似性搜索问题.文中首先提出一种不确定定点图模型(ULG,UncertainLocationgraph),并针对脑部CT图像的固有特点,提出一种基于脑部CT图像纹理的从图像到不确定定点图的建模方法,继而提出一种基于不确定定点图的相似性搜索算法,并通过一种有效的索引结构,有效地减少了无意义的查询处理,降低了搜索时间.实验结果表明,该方法可以更精确地找出具有相似纹理的脑部CT图像.关键词图像建模;不确定定点图;医学图像;相似性搜索1引言随着医疗卫生事业现代化的不断发展,医学图Page2者做出的一系列珍贵的决策,以及患者病情的发展情况.找到与患者图像相似的医学图像,有助于发现之前和患者患有相同或相似病理情况的病人,并通过以往医生对此类病人做出的决策和病人病情的发展情况,帮助医生结合经验知识做出更为合理的诊断.可见,医学图像相似性搜索技术具有很强的实际应用价值和社会价值.目前,图像检索技术主要分为:(1)基于描述的图像检索技术,它基于图像的描述(如关键字、标题、尺寸等)进行检索;(2)基于内容的图像检索技术,它基于图像的内容特征(如颜色直方图、对象的形状和它们在图像中的布局和位置)进行检索[1].由于图像往往包含较为复杂的语义信息,而对于图像的描述总是有限的,所以基于描述的图像检索技术不能够满足对复杂语义图像的检索要求.相对于基于描述的图像检索,基于内容的图像检索能够更多地反应图像本身的固有内容特征,越来越受到人们的关注[2].Swain等人[3]提出一种基于颜色语义的图像检索方法,Liu等人[4]提出一种使用共生矩阵来表示纹理图像特征的方法,Quellec等人[5]提出一种基于小波的图像检索方法.但由于医学图像较一般图像有其特殊性[6-7],使其在相似性检索过程中更难以处理.其特殊性在于:(1)医学图像检索技术要求精度高,细微的图像变化可能导致语义的剧烈变化;(2)医学图像中医学本体难以识别,往往需要通过医师人为进行标记;(3)医学图像中医学本体的属性复杂,不利于发现和描述.Quddus等人[8]提出一种基于支持向量机和标记的医学图像检索框架,Wang等人[9]提出一种基于反馈的医学图像检索框架,Rahman等人[10]提出一种分类驱动的医学图像检索框架.虽然这些图像检索框架可以有效地提高医学图像检索质量,但这些方法并没有对医学图像的表示模型进行改进,而是使用基于一般图像的特征模型,经过一些有效的策略提高医学图像检索结果.纹理,作为一种重要的图像特征,更是医生通过医学图像进行诊断的关键.在医学图像中,纹理不仅可以刻画医学本体的轮廓,更可以对其内部的灰度变化情况进行有效的描述,这也正是医生进行诊断的重要依据.Unay等人[11]使用局部二值模式(Lo-calBinaryPatterns[12],LBP)表示纹理特征进行医学图像搜索,文献[13-14]对轮廓的表示以及匹配方法进行了研究.但是,目前所提出的纹理特征都是以静态的确定的数字来加以表示的,不能满足纹理结构性和不确定性的现实要求.与此同时,在科研领域中我们发现越来越多的问题可以自然地归约到图模型上,目前已提出若干关于图数据的查询以及匹配的方法[15-16].不确定图模型的提出[17-18],使图的表示更接近于现实世界的真正形式,这些研究极大地促进了基于图建模和图模型的应用研究.但是目前提出的不确定图模型是一种概率图模型,不能直接地应用于图像搜索方面.并且据作者所知,到目前为止尚没有使用不确定图模型进行图像搜索的相关研究.针对上述存在的问题,本文首先提出一种不确定定点图模型.结合医学图像的纹理特征,对图像建立不确定定点图模型,并进行不确定定点图匹配,从而完成医学图像检索过程.因为图的匹配问题一直以来都是一个NP难(NP-hard)问题,所以本文引入了相对纹理粒度更小的纹素的概念,在此基础上,提出了一种快速有效的计算不确定定点图匹配程度的近似算法.在大规模的图像搜索过程中,为了减少对图像数据集的多次访问,本文进一步提出一种索引结构,以提高搜索算法的效率.本文第2节为医学图像的预处理过程;第3节介绍不确定定点图数据模型,并给出医学图像到不确定定点图的建模方法;第4节提出基于不确定定点图模型的医学图像相似性搜索算法;第5节展示实验结果;第6节总结本文并展望未来工作.2预处理过程通过对大量脑部CT图像的观察,可以发现脑部CT图像具有以下特点:(1)图像中ROI(RegionOfInterest)区域大小相对固定;(2)相似图像在相同或相近位置具有相似的纹理信息;(3)图像背景单一.图1(a)是一张原始的脑部CT图像.通过对医生的咨询,我们了解到医生在根据脑部CT图像进行诊断的过程中,往往认为灰度存在剧烈变化的区域较为重要.也就是说在医生诊断的过程中,灰度存在剧烈变化区域的纹理结构对于医生的最终诊断具有较高的权重.根据这一领域知识,本文提出一种分级的图像纹理提取方法,从而给予灰度存在剧烈变化区域更多的关注.假设一张脑部CT图像F包含m×n个像素点,F(i,j)是图像F位于坐标(i,j)的像素点的灰度值.F(i,j)的值越小,表示图像F位于坐标(i,j)的灰度值越小(即越黑),也就表明位置(i,j)在图像F中更为Page3重要.本文提出了医学图像的分级纹理提取算法,见算法1.以图1中的图像为例,图1(a)是原始脑部CT图像,算法1首先提取图1(a)的ROI区域得到图1(b),从而去除脑部CT图像中无用或干扰区域.然后通过计算ROI区域的灰度直方图的波峰、波谷自动得到分级数组par[k].按照k层分级数组使用can-ny[19]算法得到分级纹理图像.图1(c)是经过校正[20]的分级纹理图像.最后,为了便于后续的建模和搜索过程,将该分级纹理图像规范化为统一大小Column×Row的规范化大小纹理图像TI,如图1(d)所示.根据对原始图像数据集规格的统计,本文采用Column=161,Row=151.通过算法1,医学图像数据库中的每一张原始图像均被转换为规范化大小的纹理图像TI.其中TI(i,j)是图像TI位于坐标(i,j)的像素点的灰度值.如果TI(i,j)≠0,则称有纹理经过TI(i,j).算法1.医学图像分级纹理提取算法.输入:原始图像F输出:规范化大小纹理图像TI1.初始化[m,n]=sizeof(F),犐犕m×n={0},IM=IM2.提取图像ROI区域为FROI3.计算FROI的灰度直方图,并得到分级数组par[k]4.FOR(i=1;i<k;i++)5.IM=canny(FROI,par[i],par[i+1])6.FOR(j=1;j<=m;j++)7.FOR(l=1;l<=n;l++)8.IF(IM(j,l)!=0&&IM(j,l)=0)9.IM(j,l)=1/i10.ENDIF11.ENDFOR12.ENDFOR13.ENDFOR14.矫正分级纹理图像15.提取分级纹理图像中纹理部分并将其规范化为大3不确定定点图本节首先给出不确定定点图的形式化定义.然后,根据脑部CT图像的纹理特征,提出医学图像到不确定定点图的建模方法.同时,提出纹素的概念以降低不确定定点图在匹配过程中的复杂性.最后,对纹素的可移动性进行讨论.3.1数据模型定义1.一个不确定定点图(UncertainLoca-tionGraph,ULG)是一个五元组G=(V,E,L,P,T),其中V是顶点集,E属于V×V的边集,L:V→{1,2,…,n}为顶点分配标签函数,P:V→[0,1]是点的重要性指数函数,T={T(1),T(2),…,T(m)}是V的一个划分,其中T(i)是V的真子集.在ULG中,点V(i)∈V的位置(x,y)具有不确定性,且其不确定性依赖于P(V(i)).当一个点对于整个图较为重要时(即若该点移动,则会严重影响原图),那么该点具有较高的P(V(i)).当一个点不重要时(即使它有较大的移动也不会对原图构成影响)我们称该点具有较低的P(V(i)).因为点的重要性与点的可移动性成反比,所以,本文定义点的可移动性mob如下点的可移动性表示点V(i)可以在以V(i)为圆心,mob(V(i))为半径的范围内移动而对图本身没有影响,同时,我们称这一范围为点的可移动范围.由于ULG中的点具有可移动性,所以ULG中的边也不是固定的,边e(k)∈E的可移动性取决于其两个端点的可移动性.例如,当边e(k)=(V(i),V(j))的两端点V(i)、V(j)的移动在其可移动范围内,我们认为边e(k)=(V(i),V(j))仍成立.例1.如图2所示,不确定定点图Gsample={{V(1),V(2),V(3)},{(V(1),V(2)),(V(2),V(3)),(V(1),V(3))},L,P,T={T(1),T(2)}}.其中T(1)={V(1),V(2)},T(2)={V(3)}.从图2中我们可以看出mob(V(2))<mob(V(3))<mob(V(1)),即表明P(V(2))>P(V(3))>P(V(1)).图2中点V(1)周围的圆圈是以该点为圆心、mob(V(1))为半径的圆,以表示点V(1)的可移动范围.ULG的不确定性主要是指点的位置的可移动性.在图2(a)中,当V(1)、V(2)、V(3)移动到位置V(1)、V(2)、V(3)时,我们认为此次移动是合法的,因为各点的移动均在其可移动范围内.在图2(b)中,由于点V(2)移动到位置V(2),超出V(2)的可移动范围,我们认为此次移动是非法的.Page4图2ULG不确定性示例通过例1可以发现,不确定定点图和传统的不确定图的不同之处在于,传统的不确定图是一种概率图模型,其不确定性主要指的是图中点和边存在的不确定性;而不确定定点图的不确定性是指图中点和边的可移动性.3.2建模过程经过预处理过程,一张原始脑部CT图像被转换为规范化大小纹理图像TI.通过TI对医学图像进行不确定定点图建模,基本方法如下.V:TI(i,j)是图像TI位于坐标(i,j)像素点的灰度值.若TI(i,j)≠0,则称有纹理经过像素点(i,j).那么,我们认为位于位置(i,j)点属于ULG的点集V.E:由于ULG中的点是基于图像TI的像素点,那么任意相邻两点间的距离如图3所示,最远距离不大于槡2.所以,定义ULG中的边E为{((i,j),(x,y))|TI(i,j)≠0,TI(x,y)≠0,dis((i,j),(x,y))槡2}.P:在预处理过程中,算法1根据图像的灰度直方图和医学相关知识赋予TI(i,j)以不同的值.根据医学相关知识,TI(i,j)的值即是位于位置(i,j)点的重要性指数.所以,定义函数P为在图像搜索过程中,如何选择图像的内容特征一直是图像搜索的主要问题.纹理特征往往过于复杂并且难于描述,而使用特征点的方法并不能将纹理特征表示完全.本文提出纹素的概念,以降低纹理特征的复杂性并仍能保存纹理特征的全部信息.定义2.在不确定定点图中,纹素T(i)={V(a),V(b),…,V(z)}是一条从V(a)到V(z)的路径.其中对于i,j,T(i)∩T(j)=,V={T(1)∪T(2)∪…∪T(m)}.通过定义2,我们可以发现每一条纹素都表示了一部分的纹理特征,而纹素集合则是纹理特征的一个划分.这样就将复杂的图结构分解成纹素集合,而纹素就像文章中的段落一样,有其本身的结构特征,同时也是图像纹理的一部分.T:在本文中T={T(1),T(2),…,T(n)}.其中T(i)是一条纹素,集合T是不确定定点图点集V的一个划分.我们称集合T为纹素集T.算法2给出了产生集合T的具体过程:(1)找到一个未标记点V(i),标记它为序号nodenum并将其加入第tnum条纹素T(tnum).(2)如果点V(i)存在边与一个未标记点V(j)相连,标记点V(j).如果存在多个点与V(i)相连且未标记,标记与V(a)重要性指数最为接近的点,否则随机标记.(3)执行第2步直到找不到未标记的点与之相连.(4)执行第1步直到所有的点均被标记.L:标签函数L按照拓扑排序对点集V中的点算法2.纹素集合T生成算法.输入:点集V、边集E输出:纹素集合T1.初始化nodenum=1,tnum=12.REPEAT3.找到起始点V(i),将其标记为nodenum,并将其打标签.具体过程如算法2所述.4.WHILE(存在点V(j)与V(i)相连且V(j)未被Page55.标记V(j)为nodenum,并将其加入T(tnum)6.V(i)=V(j),nodenum++7.ENDWHILE8.tnum++9.UNTIL(所有点均被标记)例2.图4(a)是一个规范化大小纹理图像TI,图4(b)是图4(a)的局部放大图.根据步骤V和E产生如图4(c)所示,其中任意一个位于位置(i,j)的点有TI(i,j)与之对应.经过算法2,纹理的划分结果如图4(d)所示.3.3纹素的不确定性因为ULG中的点具有可移动性,而纹素是由一系列点组成的,所以纹素也具有可移动性,我们称之为容忍度.如图2所示,ULG中点的可移动性依赖于点的重要性指数,所以纹素的不确定性也依赖于纹素上点的重要性指数.虽然,纹素上的点可能具有不同的重要性指数,但当纹素上的一个点移动时,会影响相邻点的移动情况,所以我们认为同一条纹素上的点具有一致的容忍度.本文首先给出纹素的基本容忍度btt的定义如下:btt(T(j))=∑mob(V(i))/n,V(i)∈T(j)(3)其中n是纹素T(j)中点的个数.这就意味着纹素T(j)上的点可以在以自身为圆心、半径为btt(T(j))的范围内移动.如图5(a)所示,纹素Ta是初始纹素,纹素Ta上的每个点V(i)都有一个以自身为圆心、btt(Ta)为半径的圆与之相对应,为该点的可移动范围.纹素Tb、Tc是合法的Ta可移动示例,因为纹素Tb、Tc上的点均在与之相对应的Ta上的点的可移动范围内.然而纹素的基本容忍度并没有将纹素的结构特征考虑其中.根据经验知识,如果纹素的一部分点移动的较少而另一部分移动的较多,我们认为它也应该在容忍度可接受的范围内.根据韦伯定律,同一刺激差别量必须达到一定比例,才能引起差别感觉[21],也就是说刺激的几何级增长才会引起视觉反应的线性增长.因为纹素是由一条一条边拼接而成的,所以本文根据韦伯定律,认为纹素的刺激是其长度,并设其增长基数为2.提出纹素的扩展容忍度ett定义如下ett(V(i))=btt(T(j)),log2lengthbtt(T(j))其中length是点V(i)距最远、满足基本容忍度btt(T(j))的点V(l)的长度.在本文中,长度是指点V(i)到点V(l)途经边的个数.在图5(b)中,根据纹素Ta的扩展容忍度约束,Tb、Tc是合法的.通过图5(b)中的两个例子我们可以发现纹素中每个点的可移动范围不是静止的,而和其结构以及其它点的运动情况有关.4ULG相似性搜索问题传统的图匹配问题往往可以定义为一个二分图匹配问题,即给定一个二分图G=(V,E),M为E的子集,如果M满足当中的任意两条边都不依附同一个顶点,则称M为一个匹配.对于ULG,我们更多的要考虑其位置和纹素的结构性的匹配.本文定义G=(V,E,L,P,T)是一个查询ULG,Gdb是被搜索ULG数据集,其中G=(V,E,L,P,T)∈Gdb.4.1ULG相似性定义本小节将首先定义ULG中点、纹素的匹配问题,继而定义纹素之间的完全相似、部分相似问题.从而给出纹素与纹素之间以及ULG与ULG之间相似性的度量函数.定义3.点V(i)和点V(j)匹配,如果两点之间的距离满足dis(V(i),V(j))mob(V(i))+mob(V(j)).定义4.纹素T(i)和T(j)匹配,如果T(i)上的每个点V(p)与T(j)上的每个点V(q)一一对应,且对应的点对V(p)、V(q)之间的距离满足Page6dis(V(p),V(q))btt(T(i))+btt(T(j)).如图6(a)所示,纹素Ta、Tb取自不同的ULG,纹素Tb与纹素Ta匹配因为纹素Tb上的点与纹素Ta上的点一一对应且满足定义4的约束条件.基础约束线是与纹素a距离为dis=btt(Ta)+btt(Tb)的线.定义5.纹素T(i)和T(j)完全相似,如果T(i)上的每个点V(p)与T(j)上的每个点V(q)一一对应,且满足dis(V(p),V(q))btt(T(i))+btt(T(j))+log2length,其中length是点V(p)到最远匹配点的长度.图6(b)给出了两个关于纹素完全相似的例子:纹素Tb、Tc与纹素Ta相似.其中扩展约束线是与纹素Ta距离为dis=btt(T(i))+btt(T(j))+log2length的线.通过图6(b),可以看出纹素的相似不仅与各匹配点之间的距离有关,还与纹素的结构有关.定义6.纹素T(i)与T(j)部分相似,如果T(i)上的一部分点与T(j)上的一部分点一一对应,且对应点对V(p)、V(q)之间的距离满足dis(V(p),V(q))btt(T(i))+btt(T(j))+log2length,其中length是点V(p)到最远匹配点的长度.根据定义6纹素T(j)与T(i)的相似性可计算为st(T(i),T(j))=∑V(l)∈PT(i)P(V(l))其中PT(i)为T(i)的真子集,是T(i)中能与T(j)上的点满足定义6的点的集合.图6(c)给出了纹素Tb、Tc部分相似于纹素Ta的例子.其中Tb与Ta相似点共计22个,Tc与Ta相似点共计29个,根据式(5)可知st(Ta,Tb)=0.5789,st(Ta,Tc)=0.7631.更进一步地,我们给出两个ULG之间的相似性定义.定义7.不确定定点图G对于不确定定点图G的相似性可计算为sg(G,G)=∑T(i)∈T∑T(i)∈T其中n是T中纹素的个数.推论.如果存在点对V(p)和V(q)匹配,点对V(m)和V(n)满足dis(V(m),V(n))btt(T(i))+btt(T(j))+log2length,其中点V(p)、V(m)属于T(i),V(q)、V(n)属于T(j),length是点V(p)到点V(m)的长度,那么T(j)和T(i)具有相似性.我们称V(p)、V(q)为相似起点,V(m)和V(n)为相似终点.如图7所示,纹素Tb、Tc中存在很多点满足推论所描述的条件,但是选择哪个点作为相似起点和相似终点更有益于提高相似性搜索的效率呢?在图论中,图匹配问题一直是一个NP难的问题,我们在这里也旨在找到一种近似方法去更快地完成匹配过程.按照自顶向下的思想,两条纹素如果相似,我们就应该尽早地发现它.如果选择点e、c作为相似起点,d、a作为相似终点,将会比选择其它点作为相似起点或相似终点更有利于完整地比较整个纹素,而不是将纹素分段地多次比较.同理,选择点c、f作为相似起点,点b、g作为相似终点,也会更有效更早地完成纹素的匹配过程,即使纹素Tc上存在点不满Page7足相似的约束条件.这样就减少了比较次数和比较时间,大大提高了算法的有效性.4.2ULG相似性搜索方法因为图匹配问题是一个NP难的问题,所以本文根据不确定定点图的相似性定义提出一种近似的图匹配算法来完成ULG的相似性搜索过程.算法3给出了不确定定点图相似性搜索方法,基本思想如下:对于查询图G中的每条纹素,与ULG数据集Gdb中每个图的每条纹素进行比较,并将其得分写入得分矩阵狊犮狅狉犲犾犻狊狋m×n,其中m是数据库中图像的个数,n是查询图G中纹素的个数.最后通过式(6)计算数据库中各图与查询图之间的相似性,从而得到排名数组rank.但是这种方法的时间复杂性很高,假设,查询ULGG中有m条纹素,ULG数据集Gdb中有n个ULG且其平均纹素个数为t,那么一次查询需要O(m×n×t)次纹素比较.假设每条纹素的长度为l,那么共需要O(m×n×t×l3/2)次计算.算法3.ULG相似性搜索算法(ULGR).输入:ULG查询图G,ULG数据集Gdb输出:搜索结果排名rank1.初始化得分矩阵狊犮狅狉犾犻狊狋,排名数组rank2.FOR(Gdb中的每张图Gl)3.FOR(查询图G中的每一条纹素T(i))4.FOR(Gl中的每一条纹素Tl(j))5.FOR(纹素T(i)上的任意点对V(m)、V(n))6.FOR(纹素Tl(j)上的任意点对V(p)、V(q))7.以V(m)、V(p)为起始点,V(n)、V(q)为终止图8索引结构利用图8所示的索引结构,算法4给出了如何找到与纹素T(i)从V(p)到V(q)可能相似的纹素集合Twl的具体过程:首先,以V(p)为相似起点,8.ENDFOR9.ENDFOR10.ENDFOR11.ENDFOR12.根据得分矩阵狊犮狅狉犲犾犻狊狋计算rank[l]=sg(Gl,G)13.ENDFOR14.对排名数组rank进行排序,得到排名结果经过对算法3的分析,不难发现其主要问题在于浪费了大量的时间比较那些不可能相似的纹素.最理想的方法是只比较那些可能与查询图中纹素T(i)相似的纹素.所以,要提高不确定定点图相似性搜索方法的效率,关键在于如何找到可能和纹素T(i)相似的纹素集合.4.3索引结构本文根据推论提出一种基于像素点的索引结构Pixelindex,如图8所示.因为本文所提到的ULG均在Column×Row的平面内,所以平面上的每一个位置(x,y)对应着PixelIndex中的一个指针PI(x,y),PI(x,y)指向记录了可能经过位置(x,y)的所有纹素的表(TransTable)TT(x,y)={(Gno,Tno,Vno)|VGno(Vno)∈TGno(Tno),dis((x,y),VGno(Vno))btt(TGno(Tno))}.其中,Vno是可能经过位置(x,y)的点在图号为Gno、纹素号为Tno的TGno(Tno)中的点号.通过TransTable中的任意一条记录TT(x,y)(i)=(Gno,Tno,Vno)可以方便地在表TexelTable中找到该纹素的所有相关信息Texel(k).根据推论可知,找到与纹素T(i)可能相似的纹素集合Twl即是找到符合推论条件的点对.V(q)为相似终点.(1)在PixelIndex中找到所有与点V(p)匹配的点(x,y)所对应的TT(x,y),从而得到纹素集合wl-;(2)在PixelIndex中找到所有与点Page8V(q)相似的点(x,y)所对应的TT(x,y),从而得到纹素集合wl+;(3)根据推论得到Twl=wl+∩wl-,它是以V(p)为相似起点,V(q)为相似终点的,可能与纹素T(i)相似的纹素集合.同理,得到Twl为以V(q)为相似起点,V(p)为相似终点,可能与纹素T(i)相似的纹素集合.最后,得到与纹素T(i)从V(p)到V(q)可能相似的纹素集合Twl=Twl∪Twl.算法4.可能相似纹素集合Twl生成算法.输入:纹素T(i)上的点V(p)和V(q)输出:与T(i)从V(p)至V(q)可能具有相似性的纹素1.初始化纹素集合Twl,wl-,wl+,Twl,Twl2.intlength=|p-q|3.wl-={TT(x,y)|dis((x,y),V(p))btt(T(i)4.wl+={TT(x,y)|dis((x,y),V(q))btt(T(i)+5.Twl=wl+∩wl-6.wl-={TT(x,y)|dis((x,y),V(q))btt(T(i)7.wl+={TT(x,y)|dis((x,y),V(p))btt(T(i)+8.Twl=wl+∩wl-9.Twl=Twl∪Twl4.4带索引结构的ULG相似性搜索方法通过算法4,可以方便地找到与纹素T(i)从V(p)到V(q)可能具有相似性的纹素集合Twl.算法5利用这一特征,提出一种带索引的不确定定点图相似性搜索算法,以减少搜索过程中对不可能相似纹素的匹配次数,从而降低搜索时间复杂度.算法5的基本步骤如下:(1)对查询图G中的每一条纹素T(i),设定两点V(p)、V(q)作为相似起点和相似终点.(2)通过算法4,找到与纹素T(i)可能相似的纹素集合Twl.(3)对于Twl中的每个纹素Tl(j),计算st(T(i),Tl(j)),并将结果写入得分矩阵狊犮狅狉犲犾犻狊狋m×n中.其中m是G中纹素的个数,n是Gdb中ULG的个数.(4)执行步2直到不能再找到为相似起点和相似终点的点对.(5)执行步1直到所有的纹素都被计算过.(6)通过狊犮狅狉犲犾犻狊狋计算查询图G与Gdb中各图的相似性得分,从而得到图像相似性排名结果.假设查询图G中有m条纹素,且纹素的平均长度为l,平均基本容忍度为b,通过算法4每次找到的可能相似纹素集合Twl所包含的平均纹素个数为p,那么算法5的时间复杂度为O(m×p×l2/4/b).可见,带索引结构的ULG相似性搜索方法有效地降低了ULG搜索的时间复杂度.算法5.带索引结构的ULG相似性搜索方法(ULGR-index).输入:ULG查询图G,ULG数据集Gdb输出:搜索结果排名1.intflag=1,starpoint=0,endpoint=0,move=02.WHILE(flag=1)3.flag=04.FOR(G中的每一条纹素T(i))5.IF(sizeof(T(i))-4×move×btt(T(i))0)6.startpoint=2×move×btt(T(i)),flag=17.endpoint=sizeof(T(i))-2×move×btt(T(i))8.找到与纹素T(i)从第startpoint个点至第end-9.FOR(Twl中的每一条纹素Tl(j))10.计算scorelist[l][i]=st(T(i),Tl(j))11.ENDFOR12.ENDIF13.ENDFOR14.move++15.ENDWHILE16.由式(6),根据得分矩阵狊犮狅狉犲犾犻狊狋计算各图与查询5实验结果与分析为了验证基于ULG模型的医学图像相似性搜索方法的高效性,本节将分为4个实验来予以说明.因为目前尚没有基于图模型的医学图像搜索算法,所以实验主要比较了基于内容的医学图像搜索方法中经典的Sp-LBP[11]、LBP[12]以及KLT[22]算法.LBP是一种利用图像局部纹理特征的有效搜索方法,Sp-LBP是采用了空间索引结构的LBP方法.KLT是一种有效的提取特征点的方法,并通过比较不同图像的特征点来比较其相似性.本文所使用的LBP方法采用3×3邻域的二进制描述,Sp-LBP采用3层8块的空间索引,KLT选取图像的100个特征点.本文所使用的图像数据集来自于医院真实脑部CT图像的截图,分别取自50位病人,共50×9张真实图像.并在此基础上模拟了1550张图像[23],共计2000张图像作为搜索数据集.实验的硬件环境:Intel(R)Core(TM)2QuadCPUQ8400@2.66GHz,2.0GBRAM,采用Mi-crosoftWindowsXP操作系统.实验软件开发环境:VC6.0,MatlabR2009.Page95.1时间复杂性分析在实验1中,我们首先对ULGR和ULGR-in-dex的时间复杂性进行了比较.如图9所示,ULGR-index在不同规模的数据集下的搜索速度均快于ULGR.并且,ULGR随着数据集规模的增大时间复杂性呈线性增长,增长速度约为3秒每100张.而ULGR-index随着数据集规模的增大,增长速度逐渐降低.表1是在2000张医学图像的数据库上5种医学图像搜索方法的时间统计表.由表1可以看出,LBP、Sp-LBP使用静态数值来表示纹理特征,所以最快,ULGR-index快于ULGR,KLT方法最慢.方法ULGR45.33Sp-LBP6.05ULGR-index10.51LBP0.57KLT128.815.2查准率分析通常,图像搜索方法的准确性用查准率和召回率来予以衡量.然而,在医学图像数据集中,图像之间均存在一定的相关性,所以实验2采用查准率作为准确性评价的标准,其中图11搜索结果实例在本次实验中,我们假设人们只关心top-20的返回结果,即返回结果数为20.对于5种医学图像搜索方法,此次实验在相同条件下各进行50次,用统计学中的盒图(又称箱线图)予以分析,如图10所示.其中盒图的最下端一横表示数据中的最小值,最上端的一横表示数据中的最大值,盒图的中间一横表示中位数的取值,盒子的大小表示数据的离散程度.通过图10,我们首先可以发现ULGR-index和ULGR具有相同的查准率.同时,还可以发现基于ULG模型的两种搜索方法的查准率的最大值、中位数、最小值均高于其它3种方法.并且,ULGR和ULGR-index的查准率的中位数高于其它3种方法的最大值,ULGR和ULGR-index查准率的最小值高于其它3种方法的中位数.图11给出了一些查询结果的实例,其中第1行图像为查询图像,其它5行为搜索结果的top-5.图像67~70是取自同一患者的脑部CT图像的相邻切层.通过实例可以发现,基于ULG模型的医学图像搜索方法可以更为准确地找到与查询图像具有相似纹理的图像.Page105.3敏感性分析查准率往往被作为评价图像搜索方法的最重要指标.但是在现实世界中,尤其对于医学图像,微小的图像变化可能导致不同语义信息.图12(a)是一张正常的脑部CT图像,图12(b)是一张在图12(a)基础上放入了模拟脑瘤的图像.虽然这两张图像在某些部分具有很高的相似性,但当医生使用医学图像进行诊断时他们往往只关注病变区域.根据这一领域特性,我们定义敏感性为sensitivity=(S(a)-SC(a))/S(a)(8)其中S(a)为图像a的搜索结果集合,SC(a)为经过细小变化的图像a的搜索结果集合.这里,我们仍采用top-20作为搜索结果集合.经过50组独立实验,得出5种方法的敏感性如图12(c)所示.可以看出,ULGR和ULGR-index具有相同的敏感性.并且ULGR和ULGR-index敏感性的最小值远大于其它3种方法敏感性的最大值.也就意味着基于ULG模型的医学图像搜索方法可以更好地对图像的变化做出反应.这一优点对利用医学图像进行诊断,尤其对诊断病人是否患病尤为重要.5.4得分分布分析图像搜索方法的得分分布情况.在实验4中,我们提出区分度这一概念来评价例3.假设有一张查询图像Q,我们分别使用方法A和B对100张图像数据集进行搜索.方法A给50张图像打1分,其它图像打0.5分.方法B给100张图像以完全不同的分数.现在如果我们希望得到top-20的搜索结果,方法B可以,而方法A却不能给我们提供足够的信息.也就是说使用方法B得到的搜索结果富含更多的信息,我们把这种能力叫做区分度.图13是5种方法200次搜索结果的得分统计图.可以看出LBP方法和Sp-LBP方法的得分主要集中在0.85~1之间,而其它3种方法的得分分布在0~1之间.在信息论中,熵往往被用来衡量一个随机变数出现的期望值,即不确定程度[24].当结局的可能个数n越大,不确定程度越大.如果某一随机实验共有n个可能的结局A={xi|i=1,2,…,n},而每个元素具有概率pos(xi),那么结果的熵可计算为同理,对于每一次图像搜索过程,数据库中的每一张图像会有一个得分xi∈[0,1],经过大量的统计可以发现每一张图像得分xi的概率为pos(xi).所以我们使用信息熵来衡量图像搜索方法的区分度.表2中是5种方法的信息熵得分,即区分度得分.我们可以发现ULGR、ULGR-index和KLT方法的得分远高于LBP和Sp-LBP,说明ULGR、UL-GR-index和KLT方法具有更好的区分度.方法ULGR1.5763Sp-LBP0.5564ULGR-index1.5796LBP0.9712KLT1.66996结束语本文首先提出一种不确定定点图模型,该模型的不确定性主要基于图中点位置的不确定性.结合脑部CT图像的纹理特征将图像转化到ULG模型上.从而通过ULG模型进行对医学图像进行相似性搜索.通过建立一种有效的索引结构,有效地减少了搜索过程中对整个图集不必要的计算过程.实验证明,基于ULG模型的医学图像搜索方法可以:(1)更准确地查找具有相似纹理的医学图像;(2)对具有微小变化的医学图像具有较高的敏感性;(3)有效地区分相似性搜索所返回结果.实验还表明ULGR-index和ULGR方法在准确性、敏感Page11性、得分分布上表现基本相同,但ULGR-index在时间复杂性上低于ULGR.目前,关于图模型的研究不断深入,不确定图作为一种更贴近现实世界的图模型给许多未解和难解问题带来了新的的求解途径.本文提出的ULG模型虽然是不确定图模型的一种,但其在对问题的不确定性描述上有着不同之处,又一次扩大了我们对不确定图的认识范围,并第一次将不确定图模型用于图像的相似性搜索方面,虽然仍然存在着时间复杂度高等问题,但值得期待.
