Page1Kad网络恶意索引节点行为研究刘丙双1)韦韬1)邹维2)张建宇1)周渊3)韩心慧1)1)(北京大学计算机科学技术研究所北京100080)2)(中国科学院信息工程研究所北京100093)3)(国家计算机网络应急技术处理协调中心北京100029)摘要作为当前十分流行的P2P文件共享网络,Kad网络容易受到来自索引节点层面的攻击.索引节点负责存储资源索引,并响应其他节点的搜索请求,其行为正确性会对P2P网络服务质量产生直接的影响.文中基于Anthill测量系统,从IMDb,iTunes和Amazon网站中选取热门资源作为测量目标,在真实Kad网络中系统地测量和分析了资源共享过程中各类节点的行为;通过与标准Kad协议进行对比,对节点行为的正确性进行全面验证,从而获取恶意节点的行为特征.结果显示,目前Kad网络中存在两类恶意索引节点:选择性拒绝服务节点和无意义应答节点.这两类节点广泛存在于Kad网络中,总数高达数十万,并且其攻击行为具有相当的隐蔽性,严重干扰了正常文件搜索和下载过程.文中对两类节点的行为特征进行了深入分析,并在此基础上,提出了针对性较强、易于部署的防御方法.关键词对等网络;文件共享;Kad;索引节点;索引污染;信息安全;网络安全1引言DHT(DistributedHashTable,分布式Hash表)已经成为目前主流的P2P文件共享网络中资源查找和定位的核心技术.其摆脱了传统非结构化P2P网络对中心化索引服务器的依赖,具有良好的可扩展性和强容错机制,较好地实现了Log(N)级别的节点定位和资源查找操作.在众多的DHT协议[1-4]中,只有Kademlia协议[4]在实际互联网环境中得到了大规模部署和应用.目前,广为流行的eMule①和BT②文件共享系统都已经实现了该协议,二者在实现上有一些细微差别,其构成的网络分别被称为eMule-Kad网络(简称Kad网络)和MainlineDHT网络.然而,在P2P文件共享取得巨大成功的同时,其存在的安全问题同样不容忽视.在一个缺少中心化认证和授权机制、完全开放的网络中,恶意节点可以用很小的代价实施对整个网络的攻击.在其面临的各种安全威胁中,对索引信息存取过程的破坏,即攻击者通过一定手段阻碍用户快速地、正确地发布或获取共享资源,已经严重干扰了P2P网络的可用性和服务质量.文献[5]早在2006年就明确指出,在当前主流P2P文件共享网络中,存在着普遍的索引污染现象.由于巨大的利益冲突,以美国电影协会(MPAA)和美国唱片业协会(RIAA)为代表的版权保护组织,对处于版权保护有效期内的电影和音乐资源,采取了各种手段干扰P2P文件共享网络的正常服务.文献[6]也明确指出在Kad网络中27%~35%的索引条目是被污染的.在Kad网络中,索引信息的存取过程涉及两类节点:发布节点和索引节点.针对索引信息的安全问题,现有研究工作大多集中在发布节点上,攻击形式主要为索引污染,即恶意发布节点主动发布大量虚假索引信息,干扰文件搜索和下载过程.然而从另一方面来看,恶意索引节点在该过程中可能产生的威胁却没有得到足够的重视.索引节点负责存储资源索引,并响应其它节点的搜索请求,其行为的正确与否将直接影响P2P网络的服务质量.本文利用Anthill测量系统,在实际Kad网络中对恶意索引节点的行为进行了系统地测量和分析.测量结果显示,当前Kad网络中存在大量恶意索引节点,总数高达数十万.对这些节点的行为特征进行全面分析后,发现目前Kad网络中存在两类恶意索引节点:选择性拒绝服务节点(SDoS节点,简称S-节点)和无意义应答节点(MeaninglessResponse节点,简称M-节点).最后,在行为特征分析的基础上,提出了有效的防御方法.本文第2节主要介绍Kad网络背景知识;第3节介绍相关的研究工作;第4节主要描述Anthill测量系统和实验过程及结果;第5节在测量的基础上对恶意索引节点的行为进行全面的分析;第6节给出相应的防御措施;最后对本工作进行总结.2Kad网络背景简介Kad网络中的每个节点通过对一个随机数进行Hash,得到一个128位二进制数作为其节点ID.网络中存在关键词和文件两类目标.前者根据关键词文本的Hash值得到其关键词ID,而后者则通过对文件内容进行Hash获得其文件ID.在理想情况下,节点、关键词和文件ID在同一个128位ID空间内是全局唯一的.通过按位异或操作XOR,ID之间的距离可以被量化,计算结果越小表明二者在逻辑ID空间中越接近.在Kad网络中,两类基本的操作:发布和搜索,均需首先通过路由过程定位距离其操作目标最近的节点集合.Kad的路由算法采用基于迭代的贪心算法.在路由过程中,每个中间节点从自身路由表中获取一定数量的距离目标较近的节点返回给路由发起者,随后路由发起者从这些候选节点中选择较近的继续发送路由请求.该过程会一直迭代下去,直到发起者无法找到更接近的节点为止.Kad使用如图1所示的“关键词-文件”和“文件-来源”两级索引结构管理索引信息,帮助用户快速查找和定位欲下载的资源.基于如上索引结构,Kad支持“发布”和“搜索”两个基本操作.发布节点通过路由过程定位距离目标最近的若干节点,把索引信息发布到这些节点上,使之成为该资源的索引节点(每次发布选择的索引节点数量上限为10).而索引节点则负责维护自身存储的索引信息,并响应其他节点的资源搜索请求.以电影“阿凡达.avi”举①②Page3例说明,整个下载过程如下:首先,用户在客户端搜索框中输入“阿凡达”,客户端对该关键词进行Hash后获得关键词ID,定位候选索引节点集合后,向其发送文件搜索请求,索引节点通过检索本地存储的“文件索引”列表,返回若干候选视频文件信息;然后,用户从该列表中选择欲下载的文件执行文件来源搜索.同样过程,用户获得一定数量的“文件来源信息”后,开始从这些来源处直接下载该文件.在Kad网络中文件搜索和文件来源搜索每次获得的索引信息条目数量上限为300.文件的发布过程与下载过程类似,此处不再赘述.3相关工作P2P文件共享网络自诞生之日起,就受到了广大互联网用户的青睐,同时其安全问题也受到国内外学术界和工业界的重视.Urdaneta等人[7]总结了DHT领域的安全问题和防御方法,主要包括Sybil攻击[8]、Eclipse攻击以及路由和存储攻击[9-10].本文主要关注的安全威胁是恶意节点对索引信息存取过程的干扰和破坏.下面将从发布节点和索引节点两方面阐述相关研究工作.从发布节点来讲,主要的攻击方法是索引污染.该攻击的表现形式为:针对某些特定的文件,恶意发布节点通过在网络中发布大量虚假或者错误的索引信息,干扰用户正常的搜索过程,最终导致用户无法定位和下载正确的文件.在此过程中,索引节点只是单纯地“存储”和“转发”这些异常的索引信息.Liang等人[5,11]最早于2006年就指出P2P文件共享网络中存在广泛的索引污染攻击.其通过研究FastTrack和Overnet网络中10首最流行歌曲的污染情况,发现70%~90%相同文件名的文件都受到了索引污染攻击,且Overnet中污染更加严重.Thomas等人[12]在真实的Kad网络中对索引污染攻击效果进行了测量,证明了通过持续向目标节点发布虚假索引信息,可以完全阻断网络中其他用户对特定资源的访问.Guillaume等人[13]提出了一种测量Kad网络中索引污染攻击的方法,发现真实Kad网络中流行度最高的1000个文件有2/3的文件索引信息被污染.目前对P2P网络恶意节点行为研究大多集中在发布节点上,这很大程度上与大量版权保护组织实施的索引污染攻击相关.然而,正常的索引信息存取过程不仅与发布节点相关,负责存储并对响应查询请求的索引节点同样不容忽视.当前从恶意索引节点层面展开的研究工作相对较少,并且绝大多数研究[12,14-17]均只是从理论上指出:Kad网络可能存在恶意索引节点,通过主动篡改文件元信息或来源信息干扰资源搜索过程、甚至利用P2P网络发起DDoS攻击.但是在实际网络中对该类节点的捕获和攻击行为的测量分析工作并没有展开.本文作者前期的研究[18-19]是在测量Kad网络查询可靠性的过程中,采用随机生成目标的方式,利用Anthill测量系统首次在实际Kad网络中发现并确认了一种新型的恶意索引节点:选择性拒绝服务节点.本文在前期工作的基础上,利用改进的Anthill实验平台,有针对性地选取了具有版权信息的热门电影和音乐等资源,在真实Kad网络中深入研究该类节点的行为特征,并进一步挖掘了其他类型恶意索引节点行为.在恶意节点的防御方面,研究工作主要集中在黑名单[5]、信誉系统[16,20-23]和协同过滤[6,24]等方面.这些方法需要引入中心化认证服务器,或新的控制协议,导致与现有Kad网络不兼容,实施代价过高,最终无一在实际网络中得到部署和应用.目前Kad网络采用的仍然是非常初级的基于目标的信誉模型,通过下载用户对某项资源打分进行信誉模型的构建.但在用户实际使用过程中,该机制由于作用有限,且使用起来较繁琐,因此该信誉机制在Kad广大用户群体中并没有得到普及.本文在恶意节点行为特征分析的基础上,提出了富有针对性、可部署性良好的解决方案,并在真实的eMule客户端上加以实现,有效遏制了恶意索引节点对Kad网络的干扰和破坏.4测量系统和实验4.1Anthill测量系统在我们的工作[18]中,为了测量Kad网络查询可靠性,设计了Anthill测量系统.该系统基于eMule(Kad网络跨平台开源客户端,最新版本为2.3.1)客户端创建Anthill发布和搜索节点,在Kad网络Page4中灵活地与其它节点进行交互,执行特定目标的发布和搜索任务;借助Kad网络日志和Graphviz可视化技术①,完整展示发布和搜索过程,进而分析其中潜在的恶意节点行为.在Anthill中,针对一个目标的发布操作与搜索操作合起来称为一个“任务”.其标准工作流程可参见图2,说明如下:(1)根据事先选定的测量目标生成任务集合;(2)创建发布节点组和搜索节点组,每组包含相同数量的节点;图2Anthill工作流程图为了更灵活有效地测量和优化Kad网络,Anthill充分利用了模块化、参数化方法,通过添加必要的模块,如消息重发、邻域搜索等,改进现有Kad的搜索能力和效率.表1列举了实验过程中涉及到的一系列参数及其说明,包括关键的Kad网络参数和Anthill主要模块的参数.2(搜索)从下一跳节点请求返回的节点数量符号默认值α3路由并行度β4(发布);γ10每次发布时索引节点上限τ3路由收敛超时时间/sρ140发布过程超时时间/sη45搜索过程超时时间/sκ1.5Kad请求超时时间/sν否是否爬取索引节点路由表以获取更多索引节点λ0Kad请求包重传次数θ128执行邻域发布和搜索的区域,此区域大小从δ是是否需要Anthill为每个任务执行发布操作(3)发布节点组中某个空闲的发布节点从任务集合中选择一个未被执行的任务,在Kad网络中执行发布操作;(4)一旦完成某个任务的发布操作,发布节点立即通知某个空闲的搜索节点对该目标执行搜索.图2中显示1号和2号任务成功完成,而3号任务却由于某些原因导致搜索失败;(5)在此过程中,日志模块记录所有Kad网络流量,为每个任务生成一个KadTrace文件,以便后续分析.4.2实验设置4.2.1运行环境Anthill测量系统运行在一台Linux服务器上,其硬件配置为Intel(R)Xeon(R)CPUE56452.40GHz,32GBRAM,500GBSATA2HardDisk.搜索节点组和发布节点组各有32个被改造过的eMule节点.每个节点的ID均不同,各自维护独立的路由表,通过一条独占的4MbpsADSL链路直接连接Internet,避免防火墙对测量产生影响.4.2.2测量目标的选取相关研究工作显示,处于版权保护期内的资源更容易被污染,因此为了最大限度揭示当前Kad网络中恶意索引节点现状,我们选择了著名电影数据库IMDb中当前上映的电影②、苹果音乐商店iTunes①②Page5中Top100歌曲①和亚马逊网上商城中热销的电子游戏软件②等资源作为测量目标.首先,对资源名字进行切词以获得关键词集合,过滤掉其中无意义的关键词,如the,an,of等,对余下的关键词进行Hash获得关键词ID,生成“关键词任务”(通过该ID发布或搜索相关文件索引);接下来,使用资源名字在Kad网络中搜索获得相关文件信息,选择可用源数大于50的文件作为目标文件,获得其文件ID,生成“文件任务”(通过该ID发布和搜索相关的文件来源索引).表2给出了测量目标选取的总体情况.来源日期资源数量关键词任务文件任务IMDb2013/3/221626102iTunes2013/3/2510068120Amazon2013/6/163282189注:由于服务器资源限制,表中带“”仅包括与Top15歌曲相关的文件.4.3实验过程及结果本文在对Kad网络节点行为进行测量的过程中,共发现两类恶意索引节点:S-节点和M-节点.关于二者的行为特征分析将在下一节详细讨论.为了证明这两类节点在Kad网络中的广泛存在性和测量其行为特征,本文利用Anthill测量系统设计了如下两个实验.实验1.S-节点测量实验.该实验主要用来测量Kad网络中是否存在S-节点,该类节点故意拒绝应答针对某些资源的搜索请求.实验过程中,在标准Kad网络(参数设置参见表1中的默认值)中引入了消息重发机制,即λ设置为3,用以消除广泛存在的底层物理网络丢包和其他偶然因素的影响.关于消息重发机制的引入,细节可参考文献[18].实验流程与标准Anthill实验流程一致.在此过程中,为了确保搜索节点得到的索引信息确实来自Anthill发布节点,发布的索引条目结构必须具有一定特殊性,以区分现有网络中该目标的其他无关索引条目.本文采用的索引结构主要有以下特征:文件名包含某一个特定字符串Anthill_test,文件大小为343434字节,文件来源节点IP为1.1.1.1.实验2.M-节点测量实验.该实验主要是用来测量Kad网络中是否存在M-节点,该类节点恶意返回虚假的、无意义的索引信息,干扰正常搜索过程.为了最大限度获取索引节点的数量及其行为,实验采取了一系列措施,涉及到的主要参数如下{β:4,η:1200,ν:是,λ:3,θ:8,δ:否},其余设置与表1相同.这些措施包括:增强路由能力,延长每轮搜索超时时间,爬取已知索引节点路由表以获取更多新的索引节点等.测量结果显示,改进后每个搜索过程平均获取的索引节点数量为234.6个,而标准Kad中该值仅为8.3个.按照上述实验过程,使用Anthill系统在真实Kad网络中对表2中587个关键词和文件目标进行了测量.实验过程记录了全部Kad流量数据,包括返回的详细索引信息,执行这些任务产生约40GB的KadTrace文件.在此期间为了避免带宽对测量产生影响,每个发布节点和搜索节点在同一时刻只执行一个任务,因此一次完整测量会持续5h左右.另外为了消除不同地点对测量结果的影响,同时也为了分析节点对来自不同地理位置的请求是否具有不同的行为,本文所有实验均在北京和海南同步进行,两个地点的软、硬件以及带宽环境完全一致.为了方便叙述,本文如没有特别指出,实验结果均以海南测量点为例进行说明.表3给出了实验结果汇总情况,包括两类恶意索引节点的总数和受影响的任务分布情况.结合表2中测量目标的分布情况,可以看出,在Kad网络中,针对受版权保护的资源,恶意索引节点的存在是非常普遍的,且针对文件目标的攻击更加严重.下一节将在上述实验的基础上全面分析恶意索引节点的行为特征.类别节点S-节点22755522511163M-节点44.7万11623373561625节点行为特征分析利用Anthill输出的KadTrace日志文件和可视化功能,可以直观地重现完整的Kad发布和搜索过程.本文通过将实际测量获得的节点行为与标准Kad协议对比,发现了真实Kad网络中存在的两类①②Page6恶意索引节点:选择性拒绝服务节点(S-节点)和无意义应答节点(M-节点).下面将详细分析二者的行为特性,并评估其对Kad网络正常索引服务产生的影响.5.1犛-节点行为特征分析文献[18]给出了S-节点的定义:“服务”是指该节点为其他Kad节点提供诸如路由、索引信息存取等服务,而“选择性拒绝”则是指该类索引节点有选图3S-节点与其他节点的交互图在图3中,一个发布节点在获得S-节点的路由应答后,根据Kad协议向其发送文件或文件来源发布请求;S-节点正常应答该发布请求,声称自己愿意成为该条索引条目的索引节点;在另一方面,搜索节点通过路由过程定位到该S-节点,同样能够收到其路由应答.在此之前,S-节点表现一切正常.然而,当搜索节点向该节点发送文件或文件来源搜索请求的时候,其拒绝提供索引信息.即便是发布节点出于验证目的发送的搜索请求,S-节点仍然会保持沉默.在此过程中,为了消除互联网丢包和偶然因素的影响[18],Anthill采取了自适应消息重发机制,将此影响降低到可以忽略不计的程度.由此可以说明该类节点拒绝回应搜索请求的行为是主观的、故意的.表3中实验结果显示,在实验1中,587个任务中有207个任务(38个关键词,55个IMDb文件、51个iTunes文件和63个Amazon文件)受到了S-节点攻击,共涉及227个S-节点和546次SDoS攻击.可以看出,SDoS攻击已经广泛存在于P2P网络中处于版权有效期内的资源上,并且同时针对关键词目标和文件目标.表4给出了受SDoS攻击次数最多的10个目标.结果显示当前正在上映的两部电影“Loveand择性地应答路由和发布请求,却对至关重要的搜索请求保持沉默.在实验1中为了消除底层互联网丢包以及偶然因素(链路问题、节点负载过重等)的影响,针对同一个目标节点,Kad搜索请求在最坏情况下会被发送4次.只有在Anthill搜索节点未收到该节点的任何搜索应答的情况下,才会判定该节点为S-节点.这里进一步使用S-节点与其他节点的交互过程来说明其行为特征,参见图3.Honor”和“Starbuck”受到了明显的SDoS攻击.进一步观察文件信息,发现有两个文件均为西班牙语版本.利用最新的Maxmind数据库①把IP映射到所属国家或地区,发现12%的S-节点来自西班牙.这说明该国某些组织在P2P版权保护方面已经做了大量工作.此外,有4个文件为目前iTunes上的流行歌曲,说明在音乐方面,受SDoS攻击的情况同样不容乐观.(centraldivx.com).avi,1.35GBPLATINUMvol.27).mp3,8.76MBmpg,799.03MB排名1Love.and.Honor.(Spanish).DVD-Rip.XviD-AC3.2Pitbullfeat.ChristinaAguilera-feelthismoment(Disco3Starbuck.[Spanish].CVCD.BR-Screener.[DTL].4Starbuck.avi,706.51MB5关键词:VHStoDVD6关键词:Downtown7Pitbullfeat.ChristinaAguilera-FeelThisMoment8BrunoMars-WhenIWasYourMan.mp3,8.26MB10918.Baauer-HarlemShake.mp3,7.46MB10Starbuck.DVD.XviD.[www.DivxTotaL.com].avi,(DJSequenceRemix).mp3,10.79MB1.15GB①IndustryleadingIPDatabase[EB/OL],http://www.max-Page7下面继续分析S-节点在面对发布节点和搜索节点的“搜索请求”时是否会有不同的表现.统计结果显示,227个S-节点中,有38个对发布节点和搜索节点均不应答搜索请求,56个只不应答发布节点,而余下的133个则只不应答搜索节点.这说明S-节点的攻击行为更倾向于搜索节点,对发布者的验证过程有一定对抗能力,具有很强的隐蔽性.从防御角度来看,如果发布节点和搜索节点之间没有有效的信息交流渠道(目前Kad网络并不具备这种沟通机制),该类索引节点将非常难以检测.最后,不同地点的测量结果表明,S-节点的行为并没有明显的地理针对性.在北京点进行的相同实验表明,海南点发现的超过80%的S-节点同样会出现在北京点的测量结果中.5.2犕-节点行为特征分析在实验2中,本文发现另一类恶意索引节点无意义应答节点,即该类节点虽然能够正常回应搜索请求,但是返回的索引信息无任何意义.所谓的“无意义索引信息”是指,索引节点返回的文件或文件来源信息对下载者(搜索者)的资源获取过程无任何帮助.下面在实验2的基础上,全面分析M-节点的行为特征.图4给出了M-节点与搜索节点的交互过程:搜索节点定位到M-节点后,向其发送文件或文件来源搜索请求;与S-节点不同的是,M-节点正常应答该请求,但是应答的内容在Kad协议中无任何意义.具体来讲,对于文件搜索请求,其返回的应答中应包括文件ID、文件名、文件大小等信息,而M-节点的应答中仅含有文件ID,且这个ID与关键词ID相同,实际上是无效的;而对于文件来源搜索请求,其返回的应答中应包含来源节点类型(主要是防火墙状态)、IP和端口等连接信息,但M-节点返回的应答中,来源节点类型均为0,该类型在Kad中是无效的,并且对于任何搜索目标,其返回的来源节点IP和端口均为某个特定值:181.74.13.60:4462.利用节点探测工具对其进行探测,发现该来源节点不回应任何Kad请求,表明其并不是一个真正的Kad节点.根据文献[25],如此大规模地返回指向某个特定IP地址的来源节点,很可能是由于攻击者利用M-节点发动了针对该IP的DDoS(分布式拒绝服务)攻击.表3中的结果显示,在实验2中共有397个任务受到了M-节点攻击,并且该类节点数量十分庞大,总数高达44.7万.297个被攻击的文件来源搜索任务中,M-节点的平均数量为3926个;而余下的文件搜索任务中,平均M-节点数为734个.这表明该类节点对正常获取文件来源信息的干扰和破坏更加严重.6.22MBNako.me.mp4,1.18GBHoldUs.mp3,9.93MB排名1MobileAVGInternetSecurity2013.rar.exe,357.64KBAVG-InternetSecurity2013betabuild201302615withKeyWorkingLikeFullVersionh33tiahq76.mp3.exe,2357.69KB3LATESTPRISMVIDEOFILECONVERTERPLUS1.79WITHSERIAL.zip,7.41MB4FallOutBoy-MySongsKnowWhatYouDidIntheDark(LightEmUp).mp3,7.32MB5Starbuck2011BluRay720pDualSub[HDTeam].mkv,5.19GB6Pitbullfeat.ChristinaAguilera-FeelThisMoment.mp3,7Jack.the.Giant.Slayer.2013.CAM.XViD-NOGRP.8069.Macklemore&RyanLewisFeat.RayDalton-Can’t9ImagineDragons-Radioactive.mp3,5.64MB10Love.and.Honor.[2006][DVDRIP.Espaol].avi,1.35GB表5给出了测量过程中发现M-节点数量最多的10个目标.总体来看,热门电影、音乐和软件均受到了来自大量M-节点的攻击.与表4中受SDoS攻击次数最多的10个目标对比,发现其中有两个目标是相同的,分别是电影“LoveandHonor”和“Starbuck”.此外安全软件“AVGInternetSecurity2013”的两个版本文件也同时受到比较严重的攻击.把这两类恶意索引节点的攻击目标联系起来可以发现,攻击者对某些重点目标采取了多种攻击方法.为了确认M-节点的行为是自发的,而不是恶Page8意发布节点发起的索引污染攻击(索引节点只是被动存储和应答虚假索引信息),进行了如下实验:表5中的10个目标作为原始目标;把每个原始目标分别加1(128位ID的最低位加1),获取10个修改目标;利用Anthill同时执行上述20个目标的搜索任务,分别统计每个任务遭遇的M-节点数量,以及原始目标与修改目标的M-节点集合的交集.根据Kad的ID生成算法,在128位ID空间中,理论上两个ID距离相差为1不可能发生,即修改目标在Kad网络中不可能存在.如果这些M-节点对这些目标仍然返回搜索应答,那么就可以确认M-节点的行为是自发的,因为恶意发布节点绝不可能事先对ID空间内的所有目标进行污染.图5的结果显示,6个修改目标同样受到了M-节点的攻击,并且原始目标和修改目标的M-节点集合相似度很高,平均Jaccard相似性系数高达0.76.由此可以肯定这6个任务中M-节点的行为一定是自发的.而余下的4个修改目标没有遇到M-节点,有两种可能:(1)这些M-节点发起的攻击具有很强的目的性,只针对网络中存在的资源;(2)这些索引节点的行为是由恶意发布节点实施的索引污染引起的.以上实验结果至少可以证明,在捕获的M-节点集合中,大部分节点的行为是自发的.接下来分析这些M-节点的分布情况,图6给出了M-节点Top10地理分布.利用MaxmindIP数据库,获得这些节点所在的地理位置.结果显示,有超过一半的节点来自中国,接下来是意大利和西班牙,比例分别为11%和10%.考虑到中国版权保护组织与欧美等国的差距,中国有如此大规模的M-节点,我们有理由推测国际上某些版权保护机构可能已经开始利用中国的僵尸网络来干扰P2P文件共享网络的正常运行.考虑到IP资源的稀缺性,攻击者会最大限度利用掌握的IP资源,所以一个M-节点很可能同时攻击多个目标.图7给出了对数尺度下每个M-节点攻击任务数的逆累积分布曲线(CCDF).虽然98%左右的M-节点只在一个目标中出现过,但是仍然有100个M-节点攻击的任务数超过30,甚至IP:60.250.192.28(来自台湾新竹)在126个被M-节点攻击的任务中都出现过.图7每个M-节点攻击任务数的逆累积分布图最后,我们对比了北京和海南两地的测量结果,发现M-节点的行为具有明显的地理针对性.虽然北京的实验遇到了在海南捕获到的超过90%的M-节点,但是这些M-节点并没有对来自北京的搜索请求发起攻击.这一方面说明该类节点的行为具有明显的地理针对性,另一方面也表明M-节点并不是真正的索引节点,再次佐证了其行为的自发性.5.3两种恶意索引节点的关联在实验过程中,共有560个任务受到了来自索引节点层面的攻击,其中有66个任务同时受到S-节点和M-节点的影响.此外,超过30%的S-节Page9点出现在M-节点集合之中,这说明这两类索引节点并不是完全分离的,某些恶意索引节点对同一个目标能够同时发起上述两种攻击,表4和表5也证实了这一点.这也说明了Kad协议在设计上还存在很多缺陷,很容易被攻击者找到安全漏洞并加以利用.6防御方法本文描述的两类恶意索引节点均会对Kad网络服务可用性和服务质量产生非常不利的影响.S-节点对发布者声称自己愿意成为该资源的索引节点,消耗发布过程有限的索引节点指标(Kad每次选择10个索引节点进行发布),却拒绝响应查询者的搜索请求,直接影响Kad网络查询的可靠性.根据文献[18]的测量,对于随机生成的目标,SDoS节点直接导致了4.4%的查询失败.而M-节点则是对查询者的请求,随意构造一些无意义的应答,占用每次查询可以获得的索引条目指标(Kad每次查询最多获得300条索引条目),促使其提前终止查询过程,无法获得真正有用的信息.除了浪费大量的网络流量,更可怕的是,只需将受害者IP写入应答消息,攻击者就能以很小的代价利用P2P平台的强大优势发起DDoS攻击.最后,如果把这两类恶意索引节点同Eclipse攻击[26]结合起来,阻断其他节点对某些资源的访问是完全有可能的.实际情况下,我们使用eMule客户端对表5中10个文件进行了24h的持续下载,结果显示一直无法获得任何有效的来源节点,最终均下载失败.在恶意索引节点的防御上,虽然可以参照之前对恶意发布节点的防御方法,但是这些方法需要引入中心化认证服务器或新的控制协议,导致与现有Kad网络不兼容,实施代价过高,不适合在实际Kad网络中部署应用.本文以不增加新的控制协议、与现有Kad网络完全兼容为原则,在行为分析的基础上,提出了富有针对性的、可部署性良好的防御方法:(1)对于S-节点的识别,由于其行为具有很强的隐蔽性,并且Kad网络中发布者和搜索者之间不存在有效的沟通机制,因此直接对该类节点进行识别十分困难.但是仍然可以采取一定的策略尽可能降低S-节点的影响,文献[18]提出的邻域搜索和邻域发布(Neighborhoodlookup)策略,能够尽量降低该类节点在全部索引节点中的比例,限制该类节点的攻击能力.邻域搜索是指,搜索者只要进入目标ID附近区域(在该区域内,节点与目标ID的共同前缀大于某一阈值),即可直接对该区域内的活跃节点发送查询请求,而不必等到路由收敛之后进行.邻域发布则是发布者在目标ID附近区域直接发布相关索引条目.该策略可以大大增加搜索者找到的索引节点数量,进而缩小S-节点的比例和提高查询可靠性.实验结果表明,当邻域大小设置为14时,就能够以可接受的通信代价将其不利影响降低到1;(2)在M-节点的识别和防御上,搜索者可以在搜索过程中根据图4中描述的M-节点应答消息的特征有效识别该类节点.具体来讲,搜索者对搜索应答中的索引条目进行审查,根据M-节点应答消息的特征(文件索引缺少关键信息,文件来源索引指向固定IP和节点类型异常),有效过滤掉那些无意义的应答,使搜索过程可以顺利进行下去.本文在eMule客户端上实现了上述防御方法,并对表4和表5中的目标进行了搜索和下载测试.实验结果表明改进后的eMule能够更快地获得正确的文件.具体优化效果如下:获取第1个文件的时间从平均8.6s缩短至1s;获取的有效文件数量从平均212个增加至298个(eMule客户端规定每次获取的文件数量不多于300);此外,由于在搜索阶段就排除了大量无意义的文件和文件来源,改进后的eMule大大降低了随后下载过程中的流量开销.7结论在P2P文件共享网络中,索引节点负责存储资源索引,并响应其它节点的搜索请求,其行为的正确与否直接影响资源查找的可靠性和效率.本文通过广泛的实验测量和分析,在实际Kad网络中发现了两类恶意索引节点:选择性拒绝服务节点和无意义应答节点.本文选取了当前流行的电影、音乐和应用软件资源作为测量目标,利用Ant-hill测量系统,获取了在索引信息存取过程中索引节点全面的行为特征,进而根据Kad协议识别出恶意节点.测量结果显示,恶意索引节点广泛存在于当前Kad网络中,总数高达数十万,其攻击行为也具有相当的隐蔽性.最后,在行为特征分析的基础上,本文针对以上恶意攻击,提出了针对性较强、易于部署的防御方法,能够消除或有效缓解恶Page10意索引节点产生的不利影响.
