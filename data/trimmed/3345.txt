Page1面向非完备决策表的正向近似特征选择加速算法钱宇华梁吉业王锋(计算智能与中文信息处理教育部重点实验室太原030006)(山西大学计算机与信息技术学院太原030006)摘要正向近似是刻画目标概念组成结构的一种有效方法.文中针对非完备决策表现有特征选择算法计算耗时过大的缺陷,提出了一种基于正向近似的通用特征选择加速算法.该算法不仅对候选属性具有保序性,而且通过在特征选择过程中减少样本数据的规模来降低计算耗时,加速特征选择过程.实验结果进一步验证了加速算法的有效性和高效性.特别指出的是,随着属性的增多和数据量的增大,加速算法的性能通常会更好,可有效应用于海量数据的特征选择.关键词特征选择;非完备决策表;粗糙集;正向近似1引言特征选择是数据挖掘与模式识别中的基本问题Page2出了迫切的要求,而特征选择可提高数据的质量,加快数据挖掘的速度[1],因此,特征选择方面的研究引起了数据挖掘领域学者的高度重视.特征选择算法可从搜索方向、搜索策略、评价方法和停止标准等四个方面考察特征的选择.特征选择一般针对两类数据进行研究,即符号型数据与数值型数据.近年来,面向符号型数据的特征选择逐渐受到了人们的关注.特别是,波兰学者Pawlak提出的粗糙集理论在符号型数据的特征选择领域中得到了广泛应用[2-7].应用粗糙集方法进行特征选择的过程,其实质就是对决策表进行属性约简.然而,寻找一个决策表的最小约简已被证明是一个NP-hard问题[8],在处理大规模数据集时计算时间代价过大.针对该问题,一些学者提出了许多有效且高效的约简算法.Hu等[9]给出了一种较好的启发式函数,提出了基于正域的属性约简算法;Wang等[10]用信息论观点和代数观点对知识约简进行了研究,用条件熵为启发式信息求解决策表的约简;Liu等[11]提出了一个以区分矩阵为基础的基于属性序的完备算法;Guan等[12]在等价关系的基础上定义了等价矩阵,通过矩阵的计算来刻画粗糙集计算;Wang等[13]对属性约简策略进行了分析;Xu等[14]提出了复杂度为max(O(|C||U|),O(|C|2|U/C|))的快速约简算法.一些其他学者也做了相关的分析和讨论[15-18].以上的算法都致力于降低特征选择过程中的时间消耗,提高计算效率.然而,上述特征选择算法都以完备意义下的决策表为研究对象.现实生活中,信息的非完备(对象的属性值缺损)现象是广泛存在的.比如,在医学诊断智能决策系统中,可能存在这样一组病人,他们不能执行所有要求的检查,因此不能够获得病人(对象)的某些检查结果(属性值).此时,如何从非完备信息系统中获取有用知识就显得更为重要,经典粗糙集理论的等价关系不再适合.于是,完备信息系统被推广到了非完备信息系统[19-20].针对非完备意义下的信息系统或决策表的特征选择,近年来一些作者也做了初步探索[21-22].Liang等[23]给出了非完备信息系统中粗糙熵的定义,并提出了基于粗糙熵的知识约简算法;Huang等[24]通过引入信息量来刻画属性的重要度,提出基于信息量的启发式约简算法;Meng等[25]提出了一种针对非完备决策表属性约简的快速算法.综上分析,对于大规模数据集,现有的基于非完备决策表的约简算法都不同程度地存在耗时较大的问题.因此,非完备决策表中特征选择的加速机制就成为亟待解决的一个关键问题.Qian和Liang等[26-27]提出的正向近似是一种刻画目标概念的有效方法.在粒度变化过程中,有逐渐细化和逐渐粗糙两种情况.前者主要处理对研究对象刻画和描述过于粗糙、仍需作进一步更精细的刻画的情况;而后者则相反,是处理目前所进行的刻画和描述过于精细、丢失了一些对象的抱团性质、需要使之粗糙一些的情形.用一组具有偏序关系的等价关系族来刻画目标概念称为动态粒度下的粗糙集近似.如果采用的是逐渐细化的思想,称为正向近似;如果采用的是逐渐粗糙的思想,称为逆向近似.Qian和Liang等[28]进一步研究了非完备意义下的正向近似,讨论了非完备意义下如何通过正向近似的方法来刻画粗糙集的粒度结构.动态粒度下的正向近似思想,为粒度计算和粗糙集理论提供了新的研究角度,并且在规则提取和属性约简中也得到了应用.运用正向近似,本文设计了一种通用算法加速器,提出了一种面向非完备决策表的通用特征选择加速算法.该算法利用正向近似思想,通过在启发式迭代中不断减少样本规模来降低计算量,有效地加速了特征子集的求解过程,更适合处理大规模数据集的特征选择.本文在第2节中介绍非完备信息系统及决策表的基本概念;第3节中分析非完备意义下正向近似的相关概念及性质;第4节选取两种有代表性的启发式信息的度量[9,29],证明正向近似下启发式信息度量的保序性,提出一种面向非完备决策表的正向近似特征选择加速算法;第5节,选取UCI数据库中的4组常用的非完备数据集进行实验分析,结果进一步验证了该加速算法的高效性.值得指出的是,随着数据量的增大,该加速算法的优势更加明显.本文提出的加速算法有效地加快了特征子集的求解过程,降低了大规模数据集特征选择的计算耗时,为海量信息的数据挖掘提供了新方法.2基本概念设S=(U,A)为一个信息系统,其中U表示对象的非空有限集合,称为论域;A表示属性的非空有限集合;对任意a∈A有a:U→Va,其中Va称为属性a的值域;如果至少有一个属性a∈A使得Va含有空值,则称S为一个非完备信息系统,并用表示空值.设PA,相容关系定义如下[5]:Page3SIM(P)={(u,v)∈U×U|a∈P,f(u,a)=f(v,a)或f(u,a)=或f(v,a)=}.显然,SIM(P)=∩a∈PSIM({a}),令SP(u)表示对象集{v∈U|(u,v)∈SIM(P)}.SP(u)是与u可能不可区分的对象的最大集合(相对P而言).设U/SIM(P)表示分类或信息粒度,即一簇集合{SP(u)|u∈U}.U/SIM(P)中的元素称为相容类或信息颗粒.U/SIM(P)中的相容类一般不构成U的划分,它们构成U的覆盖,即对于每一个u∈U有SP(u)≠,且∪x∈USP(u)=U.设XU且PA,X的下近似P-X和上近似P-X定义如下[5]:与完备信息系统一样,P-X是肯定属于X的对象的集合,而P-X是可能属于X的对象的集合,其中X的正域为POSP(X)=P-X.对非完备信息系统S=(U,A),如果A=C∪D,C称为条件属性集合,D表示决策属性集合,且C∩D=,则称非完备信息系统S为非完备决策表.令S=(U,C∪D)是一个非完备决策表,PC,U/D={D1,D2,…,Dr},则P相对于D的正域定义为POSP(D)=∪r集P的分类为U/SIM(P)={SP(u1),SP(u2),…,SP(u|U|)},如果记目标决策为U/SIM(D)={SD(u1),SD(u2),…,SD(u|U|)},则正域的定义也可以等价地描述如下POSP(D)={u|SP(u)SD(u),u∈U}.3正向近似相关概念正向近似是一种新的集合近似方法,通过粒度序来刻画粗糙集的粒度结构,为粒度计算和粗糙集理论提供了新的研究角度,也逐渐得到了应用[26-27].由于本文关注非完备决策表的特征选择,本节对非完备意义下正向近似的定义及其相关性质作简要介绍[28].令S=(U,A)是一个非完备信息系统,在2A上定义偏序关系:设PQ(或QP)表示Q比P粗糙(或P比Q精细),当且仅当满足对任意i∈{1,2,…,|U|},都有SP(ui)SQ(ui),如果PQ且P≠Q表示Q严格比P粗(或P严格比Q细)记作PQ(或QP).定义1[28].S=(U,C∪D)是一个非完备决策表,XU,B={P1,P2,…,Pn}是一组属性集且P1P2…Pn(Pi∈2A).X的上近似B-X和下近似B-X分别定义如下:B-X=SIM(Pn)(X),B-X=∪n其中X1=X,Xi=X-∪i-1我们记X的边界域为BNP=B-(X)-B-(X),记X的正域为POSP(X)=B-(X),且NEGP(X)=U-B-(X).显然,B-(X)=POSP(X)∪BNP(X).为了说明在非完备决策表中,正向近似的本质是关注目标概念X结构的变化,我们使用以上的相容类重新定义了X的正向近似.X正向近似的上近似B-(X)和下近似B-(X)的结构可表示如下:[B-(X)]={SPn(u)|SPn(u)∩X≠,u∈U},[B-(X)]={SPi(u)|SPi(u)Xi,in,u∈U},其中X1=X,Xi=X-∪i-1n,且[·]表示一个粗糙近似的结构.定义2[28].设S=(U,C∪D)是一个非完备决策表,XU,B={P1,P2,…,Pn}是一组属性集且P1P2…Pn(Pi∈2C),且U/D={D1,D2,…,Dr}是U上的一个决策,则D相对于P的上近似和下近似定义如下:B-D也称为D相对于粒度序P的正域,即POSP(D)=∪r4基于正向近似的特征选择算法特征选择的目的在于去除多余特征,特征选择是寻找满足一定准则的最优特征子集的过程.其主要思想是在保持分类能力不变的前提下,导出问题的决策或分类规则.用于特征选择的方法主要有穷尽搜索、随机搜索和启发式搜索三种,目前最常用的特征选择方法为启发式搜索.本节将正向近似的方法应用到启发式的特征选择中,提出面向非完备决策表的一种正向近似特征选择加速算法.本文中选取非完备意义下以正域和Liang的条件熵[29]作为Page4基于上述介绍,非完备决策表中基于正域的属定义3.设S=(U,C∪D)是一个非完备决策启发式信息的两种特征选择算法来研究.4.1属性重要度的度量性重要度的度量定义如下.表,PC.任意属性a∈P的属性重要度定义为其中γP(D)=|POSP(D)|/|U|.定义4.设S=(U,C∪D)是一个非完备决策表,PC.任意属性a∈C-P的属性重要度定义为其中γP(D)=|POSP(D)|/|U|.在非完备信息系统中,Liang等[29]定义了一种新的信息熵,并应用于消去冗余特征,其描述如下.定义5[29].设S=(U,A)是一个非完备信息系统,U/SIM(A)={SA(u1),SA(u2),…,SA(u|U|)},则A的信息熵定义为SIGinSIGout基于这个定义,容易给出其在非完备决策表中定义6.设S=(U,C∪D)是一个非完备决策且有0E(A)1-1/|U|.的条件信息熵.表,PC,则条件信息熵定义为E(D|P)=1根据定义6,基于Liang条件熵的相对属性重要度可定义如下.定义7.设S=(U,C∪D)是一个非完备决策表,PC.任意属性a∈P的属性重要度定义为2(a,P,D,U)=E(D|P-{a})-E(D|P).SIGin定义8.设S=(U,C∪D)是一个非完备决策表,PC.任意属性a∈C-P的属性重要度定义为2(a,P,D,U)=E(D|P)-E(D|P∪{a}).SIGout对于给定的非完备决策表,所有约简的交集称为核(可能是空集),核中的每一个属性都是必要的.为求解决策表的核属性,给出如下的定理.定理1.设S=(U,C∪D)是一个非完备决策表,a∈C,如果SIGina是非完备决策表S的一个核属性.基于上述介绍的两种属性重要度的度量,根据定理1可求解得到决策表的核属性,将度量信息作为启发式搜索的迭代准则,便可构造启发式的特征选择算法,进而求解决策表的相对约简.4.2基于正向近似的特征选择算法以上介绍了属性重要度的度量,并证明了正向近似下候选属性的属性重要度具有保序性.在此基础上,本小节给出非完备意义下基于正向近似的启发式特征选择方法,算法主要思想是:对非完备决策表S=(U,C∪D),C为条件属性集,D为决策属性.首先计算非完备决策表的核属性集P,以核属性集为起点,根据正向近似方法逐次从论域中去掉协调部分的对象,记剩下的论域为U,同时选择使EFU(D|P∪{a0})最小的条件属性a0(a0∈C-P)添加到P中,直到满足终止条件EFU(D|P)=EFU(D|C),则P是决策表的约简;其中EFU(D|P)表示对属性重要度的度量,如在基于正域的特征选择算法中EFU(D|P)表示为γP(D),而在基于Liang的条件熵的特征选择算法中表示为EU(D|P).算法1.面向非完备决策表的正向近似特征选择加速算法(IN-FSPA).输入:非完备决策表S=(U,C∪D)输出:特征选择结果red过程:1.令red=;2.for(j=1;j|C|;j++)3.令i=1,P=red,Ui=U;4.while(EFUi(P,D)≠EFU(C,D))do5.输出特征选择结果red.由于求解正域和条件熵要多次计算非完备决策表的相容类,所以本文使用文献[30]中的相容类快速算法来计算相容类.算法IN-FSPA的时间复杂度分析:文献[30]中计算相容类的时间复杂度是max(O(|U||C|),(O∑Cj=1∑j-1个属性下取值为缺省值的对象个数和属性取值个数.所以步2总的时间复杂度是(O|U||C|2+k=1Page5|C|∑Cj=1∑j-1并求得约简结果的时间复杂度是(O∑C|C|∑Cj=1∑j-1度都为常数,所以算法IN-FSPA总的时间复杂度是(O|U||C|2+|C|∑C|C|∑Cj=1∑j-1中随着论域Ui的减小,加速算法有效地加速了特征子集的求解过程,减少了时间消耗.5实验及分析为验证算法IN-FSPA的高效性和有效性,本文选取了UCI数据集中的4组非完备数据集进行测试,比较加速后的启发式特征选择算法与加速前算法的计算耗时.为表示方便,本节中将非完备意义下的基于正域的启发式特征选择算法记为IN-PR,基于Liang熵的算法记为IN-LCE.实验中使用的数据集见表1.1adult488421422shuttle580003ticdata200058228524mushroom8124222为方便比较加速前后算法的计算时间,首先分别将表1中的每组数据平均分为10份,记为xi(i=1,2,…,10),实验中使用的10份数据记为Xi(i=1,2,…,10),其中X1=x1,X2=x1+x2,…,X10=x1+x2+…+x10,最后一份数据即是数据集本身.为了更好地说明算法效果,我们在硬件配置为CPUPentium3.40GHz、内存1GB的计算机上,用C#语言编程实现算法,开发平台为MicrosoftVisualStudio2005.(1)IN-PR和基于正向近似加速后的IN-PR(IN-FSPA-PR)首先比较算法IN-PR和IN-FSPA-PR分别在4组数据集上的时间消耗,实验结果见图1~4,其中X轴表示上述10份样本数目由少到多的数据集Xi(i=1,2,…,10),Y轴表示算法在不同数据集上的计算时间(单位:min).图1IN-PR和IN-FSPA-PR不同数据集下的图2IN-PR和IN-FSPA-PR不同数据集下的图3IN-PR和IN-FSPA-PR不同数据集下的图4IN-PR和IN-FSPA-PR不同数据集下的Page6图1~4分别表示4组数据集上算法IN-PR和加速后的算法IN-FSPA-PR的计算时间.如图中实验结果所示,通常随着样本数据规模的增大,时间消耗的增多,两种算法的计算时间的差值会增大.所以实验结果表明加速算法不仅有效地加速了特征选择的求解过程,而且通常对规模较大的数据集,新算法的性能会更好,高效性也更明显.实验中图1~4的实验结果都比较有效,很好地体现了加速算法的高效性.其中图4中前几份数据在两种算法上的计算时间比较接近,这主要与计算过程中约简结果和核属性的数目有关.所以,加速算法IN-FSPA-PR与原算法IN-PR相比较,有效地提高了算法效率,降低了计算量并减少了时间消耗;而且通常对大规模数据集,新算法的高效性更明显.(2)IN-LCE和基于Liang熵加速后的IN-LCE(IN-FSPA-LCE)算法IN-LCE和IN-FSPA-LCE在4组数据集上的时间消耗见图5~8,其中X轴表示上述10份样本数目由少到多的数据集Xi(i=1,2,…,10),Y轴表示算法在不同数据集上的计算时间(单位:min).图5~8表示原算法IN-LCE和加速算法IN-FSPA-LCE在4组数据集上的计算时间.图中的图5IN-LCE和IN-FSPA-LCE不同数据集下的图6IN-LCE和IN-FSPA-LCE不同数据集下的图7IN-LCE和IN-FSPA-LCE不同数据集下的图8IN-LCE和IN-FSPA-LCE不同数据集下的实验结果表明,通常随着样本数据规模的增大和时间消耗的增多,两种算法时间消耗的差值会逐渐增大.所以实验结果进一步有效地验证了加速算法的高效性,加速算法不仅加速了特征选择的求解过程,而且通常随着数据规模的增大,算法的高效性会更明显.所以加速算法可以更有效地处理大规模数据集的特征选择.实验中的实验结果都比较有效,很好地体现了加速算法的高效性.图8中前几份数据集上两种算法计算时间的差值不太明显,原因主要受计算过程中约简结果和核属性的数目的影响,但随着数据规模的增大,加速算法便有效地降低了时间消耗.所以加速算法IN-FSPA-LCE相比较原算法,有效地提高了计算效率,且针对大规模数据集性能会更好.较,作以下几点分析:综上分析,加速算法IN-FSPA与原算法相比(1)由于基于正向近似的加速算法对候选属性具有保序性,所以加速后的算法不改变原算法的特征选择结果;效地加速了特征选择过程,降低了时间消耗;(2)新算法在得到相同特征选择结果的同时有(3)随着样本数据规模和属性的增多,加速算Page7法与原算法时间消耗的差值会增大,高效性更明显,但是,对于核属性集即是特征选择结果的数据集不适合于本算法.6结论针对现有面向非完备决策表的特征选择算法计算耗时过大的缺陷,本文构建了一个通用特征选择算法加速器.通过分析非完备正向近似的机理,证明了基于正域的和基于Liang的条件熵的两个启发式度量的保序性.基于这个保序性质,提出了一种基于正向相似的通用特征选择加速算法.该算法通过不断地缩小论域的规模,有效地降低了特征选择求解中的计算耗时,实现了对特征选择算法的加速.进一步,我们选取了UCI数据库中4组常用的非完备数据集进行实验分析,结果有效地验证了该加速算法的有效性和高效性.特别指出的是,通常随着数据规模的增大,加速算法IN-FSPA的高效性会更明显,可有效应用于海量数据的特征选择中.
