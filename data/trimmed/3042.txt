Page1标准模型下一种实用的和可证明安全的IBE方案徐鹏1)崔国华1)雷凤宇1)汤学明1)陈晶2)1)(华中科技大学计算机科学与技术学院信息安全实验室武汉430074)2)(武汉大学计算机学院武汉430072)摘要组合公钥方案是一种用于基于身份密码体制中生成用户加密密钥和私钥的知名方案.针对组合公钥方案存在合谋攻击的问题,通过仅扩展该方案的私钥生成过程,实现了扩展方案的抗合谋攻击性.在此基础上构建标准模型下基于DecisionalBilinearDiffie-Hellman假设可证明安全的一种新的基于身份加密方案.最后,为了说明所构新方案的实用性,分析了扩展组合公钥方案的用户加密密钥抗碰撞性;对比了新方案和同类的3个知名方案在安全性证明的归约程度方面、加解密的时间复杂度方面和密文的长度方面的性能,表明了新方案在以上3点上具有目前最优的指标.因此新方案是相对较实用的.关键词组合公钥;合谋攻击;标准模型;DecisionalBilinearDiffie-Hellman假设;基于身份加密1引言1984年,Shamir创造性地提出了基于身份的加密体制(Identity-BasedEncryption,IBE)的概念[1].和传统的公钥加密体制不同,它可以使用任意字符串作为用户的公钥,这样取消了传统公钥加密体制对在线密钥管理中心的需要,从而大大地提高了效率.虽然IBE的概念提出得很早,但直到2001年才由Boneh提出了第一个实用的IBE方案[2],并且该方案成功地在随机预言机模型(RandomOracleModel,ROModel)下将双线性计算难题BilinearDiffie-Hellman问题(BDH问题)的求解归约到其IBE方案的破解,因此是RO模型下可证明安全的.与此同时,Boneh也提出了新的问题,即能否构建标准模型下可证明安全的IBE方案.在标准模型下构建可证明安全的加密方案具有十分重要的实用意义.众所周知,RO模型下的安全性证明中使用了随机预言机提供询问应答服务,而真实环境中并不存在随机预言机,因此一个RO模型下可证明安全的加密方案在实用中必须选取合适的Hash函数或伪随机函数等算法来代替方案中的随机预言机(即实例化随机预言机过程),这样对实例化后的方案是否安全和实用需要做进一步的评估[3].而在标准模型下可证明安全的加密方案通常只需要抗碰撞的Hash函数或伪随机函数或单向函数,甚至有的方案根本不需要此类函数,因此其可证明安全性更实用.当然,这些并不能说明标准模型绝对优于RO模型,因为成功实例化随机预言机后的加密方案并不一定比标准模型下可证明安全的方案的安全性和执行效率低,而且有的标准模型下可证明安全的加密方案很显然就是不实用的,例如,文献[4]中的IBE方案.由于在标准模型下构建可证明安全的加密方案比RO模型要难,而且其安全性证明更实用,因此近几年得到了广泛的重视,特别是构建标准模型下可证明安全的IBE方案.在证明安全性的过程中,必须选取一个公认的难题(或称之为假设),并完成该难题的求解到加密方案破解的归约.这些难题可分为计算难题和判定难题.而要在标准模型下建立可证明安全的加密方案必须选取判定难题,因为在RO模型下安全性证明的归约过程中,计算难题的求解是依赖随机预言机的,而标准模型下由于不存在随机预言机,并且在安全性定义的攻击游戏中[2],仿真器不可能根据其与相应攻击者的交互信息求解计算难题,例如,IND-ID-CPA安全性定义的攻击游戏中,攻击者告诉仿真器的只有身份信息、两个等长的明文信息和攻击结束时的一位猜测信息,而这些信息或者是仿真器已知的,或者和计算难题的求解无关,因此无法正确地归约并求解计算难题.由此可见,判定难题在标准模型中构建可证明安全的IBE方案是至关重要的.2004年,Boneh等人[5]提出了第一个标准模型下可证明安全的IBE方案,即在相对较弱的安全性定义下(即非适应性选择挑战ID和选择明文攻击下的语义不可区分性,简称为IND-sID-CPA安全性)成功地实现了DecisionalBilinearDiffie-Hellman问题(DecisionalBDH问题)的求解到该方案破解的归约.但是在相对较强的安全性定义下(即适应性选择挑战ID和选择明文攻击下的语义不可区分性,简称为IND-ID-CPA安全性),该IBE方案的归约十分“松散”,具体地说该归约是指数级的归约,因而在实用中为了保证IND-ID-CPA安全性会选取一个很大的安全参数,但这使得该IBE方案不具有实用性.同年,Boneh等人[4]提出了另一个标准模型下可证明安全的IBE方案,虽然该方案实现了IND-ID-CPA安全性下DecisionalBDH问题的求解到IBE方案破解相对有效的归约,但其方案中密文的长度与用户ID的长度有关,因而密文较长,同时也增加了加解密的时间复杂度,从而降低了实用性.2005年,Waters[6]提出了第1个标准模型下可证明安全的且综合来说较实用的IBE方案,即该方案不仅具有固定长度的密文(安全参数的3倍),同时实现了IND-ID-CPA安全性下DecisionalBDH问题的求解到IBE方案破解相对有效的归约.2006年,Gentry[7]提出了另一个标准模型下可证明安全的IBE方案,该方案不仅减少了公开参数的个数,提高了性能,并且实现了更紧的归约,但是该归约是基于一个更强的问题,即判定的双线性Diffie-Hellman指数的扩展问题(DecisionalAugmentedBilinearDiffie-HellmanExponentProblem,DecisionalAB-DHEProblem),因而该方案的性能和安全性并不一定比前述方案优秀[7],因此其实用性是否真的提高还有待研究.通过研究发现,采用组合公钥方案[8](Com-binedPublic-KeyScheme,CPK)可以构建更高效的IBE方案,并且若不考虑CPK本身的安全性问题,该方案是标准模型下可证明安全的,而且具有目前同类方案[4-6]中最优的DecisionalBDH问题的求解到IBE方案破解的归约有相对最优的加解密时间Page3复杂度和密文长度.但是众所周知,CPK存在合谋攻击问题[9],即令CPK中私钥种子矩阵为m×h阶,则若有m×h个合法用户参与合谋即可计算出私钥种子矩阵.目前,现有的防范该攻击的方法[9]都是不合理的,例如,要求合法用户的总数小于m×h,很明显这和CPK的设计宗旨是相违背;通过加强管理使得合谋用户数量小于m×h,这种方法是不具有说服力的.因而,本文提出的新IBE方案首先继承CPK的优点及加密密钥和私钥的生成方法,通过扩展私钥的生成过程实现根本上的抗合谋攻击性;再由该扩展CPK方案构建标准模型下可证明安全的IBE方案;最后通过与前述的同类方案对比归约程度、加解密执行效率、密文长度来说明该方案具有相对较好的实用性.另外,在标准模型下可证明安全的IBE方案中,要求不同用户的加密密钥具有抗碰撞性(通常由输入为用户ID的某个抗碰撞的Hash函数实现),因此为了说明扩展CPK方案生成的用户加密密钥具有抗碰撞性,本文将详细分析新方案中加密密钥种子矩阵的规模(即m×h的大小)对抗碰撞性的影响,得出具有某种程度的抗碰撞性所需要的矩阵规模,而且由于扩展CPK方案和原CPK方案的加密密钥的生成方法相同,因此该结论也适用于原CPK方案.中在下一节中描述,并进行简要的分析.2预备知识为了方便理解,本文将一些重要的预备知识集本章将简要介绍与可证明安全的IBE方案有关的重要基础知识,分别是IBE方案的核心构件———单向函数“双线性映射”;安全性归约中基于的难题;安全性证明所要达到的安全目标,即安全性定义.2.1双线性映射双线性映射是对修正后的Weil对和Tate对的总结和抽象,是第一个实用的IBE方案[2]之所以成功的关键,因而在2001年后的大部分IBE方案中都得到了应用.定义1.令G1和G2分别是两个大素数q阶加法循环群和乘法循环群.称满足以下条件的映射^e:G1×G1→G2为双线性映射,条件如下:(1)双线性性.对P,Q∈G1和a,b∈犣,有^e(aP,bQ)=^e(P,Q)ab成立.(2)非退化性.若P为群G1的生成元,则^e(P,P)是G2的生成元.(3)可计算性.对P,Q∈G1,映射^e(P,Q)在有效时间内可计算.一个具体的双线性映射可以参考文献[2].2.2ComputationalDiffie-Hellman假设定义2[10].令G1为素数q阶加法群,P为该群的一个生成元.群G1上的CDH问题(CDHP)为:给定P,aP,bP,计算abP,其中a,b在犣取.若有效时间内,任意概率多项式时间算法的求解优势可忽略,则称群G1上CDH假设成立.2.3DecisionalBilinearDiffie-Hellman假设DecisionalBDH问题的提出是因为在具有双线性映射的群中,判定Diffie-Hellman(DDH)问题是易解的,即DDH假设不成立,因此Boneh在双线性映射群中扩展了DDH问题,即得到DecisionalBDH问题,并提出了研究热点,即若DecisionalBDH假设成立如何在标准模型下构建基于该假设的可证明安全的IBE方案.定义3.令G1和G2是两个大素数q阶加法循环群和乘法循环群,且存在双线性映射^e:G1×G1→G2,P为群G1的生成元.DecisionalBDH问题定义如下.DecisionalBDH问题.给定一个具有若干形如〈P,aP,bP,cP,abcP〉的Diffie-Hellman分组的分布D和一个具有若干形如〈P,aP,bP,cP,rP〉的随机分组的分布R,区分这两个分布,其中a,b,c,r在q中随机选取.范围犣若不存在有效的统计测试算法能在概率多项式时间T内,以至少ε的优势解DecisionalBDH问题,则称为(T,ε)-DecisionalBDH假设,即Deci-sionalBDH假设成立.总的来说,判定难题属于不可区分性问题,而不可区分性问题又分为:计算不可区分性问题和统计不可区分性问题.到目前为止,绝大多数基于判定问题可证明安全的公钥加密方案中,其判定问题均是计算不可区分性问题,例如:著名的Cramer-Shoup方案[11];还有本文第1节中介绍的所有标准模型下可证明安全的IBE方案[4,6-7].关于统计不可区分性的定义可以参考文献[12].2.4IND-ID-CPA安全性IND-ID-CPA安全性指的是适应性选择挑战ID和选择明文攻击下的语义不可区分性,是目前可证明安全的IBE方案中最受重视的安全性定义,因为凡是具有该安全性的IBE方案均可由Canetti等人[13]、Boneh等人[14]和Boyen等人[15]分别提出的通用方法有效地扩展为具有IND-ID-CCA安全性Page4(适应性选择挑战ID和选择密文攻击下的语义不可区分性)的IBE方案,因此一般只证明某IBE方案具有IND-ID-CPA安全性.但是实现IND-ID-CPA安全性并不容易,有些方案只在较弱的安全性定义IND-sID-CPA下才具有相对较实用的安全性归约,而在IND-ID-CPA安全性下的归约完全不实用[5],因此这也是标准模型下构建可证明安全的IBE方案的难点.下面给出IND-ID-CPA攻击的通用定义,再根据该攻击给出IND-ID-CPA安全性的定义.定义4.IND-ID-CPA攻击由如下几个阶段构成.初始化阶段.挑战者生成公开参数和秘密参数,并将公开参数传递给攻击者.私钥查询阶段1.攻击者可以向挑战者多次查询任意用户的私钥.挑战阶段.攻击者提交等长的明文m0,m1和要挑战的用户身份IDch给挑战者,其中要求攻击者没有询问过IDch的私钥;挑战者随机选取d∈{0,1},并利用IDch的加密密钥加密md生成挑战密文C;最后返回C给攻击者.私钥查询阶段2.除了攻击者不能询问IDch的私钥外,该阶段的执行和私钥查询阶段1相同.猜测阶段.攻击者向挑战者提交对d的猜测d,则完成了一次IND-ID-CPA攻击.定义5.称一个IBE方案θ是(T,qID,ε)-IND-ID-CPA安全的,若在时间T内对任意一个IND-ID-CPA攻击者A在进行最多qID次私钥查询后,其破解方案θ的优势Advθ,A<ε.IND-sID-CPA攻击和IND-ID-CPA攻击的差别仅在于:前者的攻击者在初始化阶段必须提交给挑战者其准备挑战的用户身份IDch,而后者的攻击者在挑战阶段才提交其挑战的用户身份IDch.显然,IND-ID-CPA攻击中的攻击者具有更强的攻击能力.3基于扩展CPK方案的IBE方案本方案首先对CPK方案进行扩展,实现抗合谋攻击性,即所有的合法用户合谋也不可能求出私钥种子矩阵;再基于该扩展CPK构建IBE方案.明确地说,这项研究的难点就在于不仅可以实现扩展CPK方案的完全抗合谋攻击性,同时可以基于该扩展CPK方案构建标准模型下可证明安全的IBE方案.本文将以上两个过程合为一体作为一个完整的IBE方案来描述,并不单独描述扩展CPK方案.基于扩展CPK方案的IBE方案由4个算法组成:系统初始化算法Setup、用户公私钥生成算法Extract、加密算法Encrypt、解密算法Decrypt.令η(k)为DecisionalBDH假设的参数生成算法,其中k为安全参数.各算法具体如下.Setup算法.输入系统安全参数k,密钥管理中心进行如下初始化过程:1.运行算法η(k)生成两个大素数q阶加法循环群G1和q阶乘法循环群G2、双线性映射^e:G1×G1→G2,G1的生成元P.2.随机选取a,b∈犣q,计算g1=aP和g2=bP.3.(生成CPK的所有参数)生成m×h阶私钥种子矩阵犘狉犻犓犛犕:r1,1…r1,h烄rm,1…rm,烆生成相应的m×h阶加密密钥种子矩阵犘狌犫犓犛犕:选取h个不同的伪随机函数(或带密钥的Hash函数)组成函数集F={f1,f2,…,fh},且满足对i∈[1,h]和ID∈{0,1}有fi(ID)∈[1,m].4.保密私钥种子矩阵犘狉犻犓犛犕和犪;公开系统参数params=〈q,G1,G2,^e,P,g1,g2,F,犘狌犫犓犛犕〉,其中G2也为明文空间.Extract算法.给定用户ID∈{0,1};令用户的私钥为SKID,密钥管理中心随机选取σ∈犣计算用户私钥SKID=(a·g2+σ·SKID·P,σ·P),其中SKID=(rf1(ID),1+…+rfh(ID),h)modq∈q,rfi(ID),i∈犘狉犻犓犛犕.显然:SKID的计算和CPK方犣案的私钥计算完全一样.扩展CPK方案只是在SKID的基础上额外进行了形如(a·g2+σ·SKID·P,σ·P)的计算,并将其作为用户的私钥,记为SKID.Encrypt算法.给定用户ID和明文m∈G2;加密过程如下:1.计算该用户的加密密钥PKID=(rf1(ID),1P+…+rfh(ID),hP)∈G1,其中rfi(ID),iP∈犘狌犫犓犛犕.2.随机选取t∈犣q,计算密文c=〈^e(g1,g2)t·m,t·P,t·PKID〉.Decrypt算法.给定密文c=〈c1,c2,c3〉;令私钥SKID=(a·g2+σ·SKID·P,σ·P),解密过程如下:m=c1·^e(c3,σ·P)密算法的一致性验证如下:令c2=t·P,c3=t·PKID,由于^e(t·PKID,σ·P)Page5^e(t·P,a·g2)·^e(t·P,σ·SKID·P)=1又有c1=^e(g1,g2)t·m,所以显然有一致性成立,即解密过程正确.通过以上新IBE方案的描述可以看出:系统初始化阶段引入了DecisionalBDH假设的参数生成算法;加密密钥和私钥的生成过程在继承CPK方案的基础上进行了扩展,使得私钥变成一个随机化的值;加密的密文长度为固定长度.这些为该方案的安全性证明和实用性提供了必要的条件.4新方案的安全性证明本章分两个部分分别证明扩展CPK方案的抗合谋攻击性和新IBE方案在标准模型下IND-ID-CPA安全性.4.1扩展CPK方案的抗合谋攻击性扩展CPK方案由新IBE方案的Extract算法、Encrypt算法中接收方加密密钥的生成算法及其相应的系统参数共同组成.本节将根据合谋攻击的直观含义和IBE体制的特点,即攻击者有可能预先知道某些合法用户的私钥,给出具有针对性的合谋攻击的定义.并在此基础上,基于CDH假设证明扩展CPK方案的抗合谋攻击性.定义6.IBE体制中针对私钥的合谋攻击.IBE体制中针对私钥的合谋攻击由以下阶段组成.初始化阶段.挑战者执行IBE体制的Setup算法,但仅生成与计算加密密钥和私钥相关的公开参数和秘密参数,并将公开参数发送给攻击者.私钥查询阶段.输入用户身份信息,攻击者可以向挑战者询问任意合法用户的私钥.私钥生成阶段.攻击者根据获取的用户私钥,生成并输出某合法用户的身份信息及其私钥,且攻击者在私钥查询阶段未询问过该用户的私钥.根据上述定义,若有效时间内,在私钥生成阶段攻击者输出的私钥为该用户的合法私钥,即满足IBE体制的私钥的结构,则称为IBE体制中一次成功的私钥合谋攻击.由于原CPK方案和扩展CPK方案的合谋攻击均是仅针对私钥的攻击,因此上述定义的初始化阶段并不要求生成完整的IBE体制的公开参数和秘密参数,而仅仅生成与计算加密密钥和私钥有关的参数.定理1.假设新IBE方案中,群G1上CDH假设成立,则其扩展CPK方案抗IBE体制中针对私钥的合谋攻击.证明.假设新IBE方案中存在成功的针对私钥的合谋攻击者A,则可以构造有效的仿真算法B实现一次A和B间合谋攻击的有效仿真,且最终仿真算法B求解出CDH问题.令η(k)为CDH问题的参数生成算法,其中k为安全参数.仿真算法B如下:初始化阶段.由算法η(k)生成CDH问题实例〈q,G1,P,aP,bP〉;根据新IBE方案的生成针对私钥的合谋攻击所需要的公开参数〈q,G1,P,g1,g2,F,犘狌犫犓犛犕〉和秘密参数犘狉犻犓犛犕,其中g1=aP,g2=bP,F={f1,f2,…,fh},犘狌犫犓犛犕=犘狉犻犓犛犕=阶段也是扩展CPK方案的实例化过程).私钥查询阶段.合谋攻击者A可以询问任意合法用户的私钥.令查询的用户身份信息为〈ID〉,若fh(ID)=m则仿真算法B停止并退出;否则仿真算法随机选取σ∈犣q,计算并返还私钥其中,SKID的计算与新IBE方案的Extract算法相同.显然SKID可有效计算,且易证SKID=〈a·g2+(σ+a)·(SKID-b)·P,(σ+a)P〉.由于a为随机选取,且SKID和新IBE方案的Extract算法生成的算法具有相同的结构,因此合谋攻击者A在有效时间内无法区分仿真算法B和新IBE方案的Extract算法的输出,即仿真算法B为有效仿真.私钥生成阶段.攻击者生成并输出某合法用户的有效的私钥,令输出为〈ID,SKID〉,且在私钥查询阶段攻击者没有询问过ID的私钥.若fh(ID)≠m则仿真算法B停止并退出.仿真算法B由〈ID,SKID〉求解CDH问题:由于SKID为有效私钥,即SKID=〈a·g2+σ·SKID·P,σP〉,其中σ∈犣tract算法相同,由ID计算SKID;由于已知SKID,σP,a·g2+σ·SKID·P,易求a·g2;由于a·g2=abP,因此仿真算法B成功求解CDH问题.最后计算仿真算法B在私钥查询阶段和私钥生成阶段不会停止并退出的概率.令该事件为Abort、合谋攻击者A询问用户私钥的次数为qID,Page6则显然有Pr[Abort]=1综上所述,可以得出:若新IBE方案中存在针对私钥的合谋攻击者A,且仿真算法B不会中途停止并退出,则以概率“1”求解CDH问题;又由于合谋攻击者A的询问必须在有效时间内完成,因此其询问次数qID必是关于安全参数k的多项式,则令m=qID,显然可以看出Pr[Abort]的值为不可忽略数.结合以上两点可以看出,仿真算法B求解CDH问题的概率不可忽略,而和群G1上CDH假设成立相矛盾,因此新IBE方案不存在针对私钥的有效的合谋攻击,即扩展CPK方案具有抗合谋攻击性.4.2新方案的IND-ID-CPA安全性新IBE方案的IND-ID-CPA安全性的证明:将某难题的求解归约到某方案的破解,从而推出矛盾(难题通常认为是不可解的),并证明该方案的安全性.针对本文提出的新IBE方案和安全性目标,即IND-ID-CPA安全性,该方案的安全性证明主要在于如何有效地仿真各用户私钥,并在某些条件下生成有效的挑战密文(具体条件见下文).本节将先提出安全性定理并详细证明.定理2.假设新IBE方案中,群G1(上T+O(qIDTE),1立,则该方案的实例θ是(T,qID,ε)-IND-ID-CPA安全的,其中TE是群G1中一次模幂运算的最大时间.证明.假设存在IND-ID-CPA攻击者A在时间T内以不可忽略的优势Advθ,A=ε攻破新IBE方案θ,本文将构建仿真器B实现一次A与B间的IND-ID-CPA攻击的有效仿真,并通过多次该仿真完成一次统计测试过程,最终以压倒性概率求解DecisionalBDH问题.从DecisionalBDH问题的分布D和R中,任意取定一个分布,并从中随机选取一个分组,且令该分组为〈P,aP,bP,cP,Z〉.输入分组〈P,aP,bP,cP,Z〉到仿真器B,并仿真新IBE方案的实例,过程如下:1.初始化阶段.继承DecisionalBDH问题的系统参数〈q,G1,G2,^e,P〉;根据新IBE方案的Setup算法生成系统参数〈q,G1,G2,^e,P,g1,g2,F〉,其中g1=aP,g2=bP,F={f1,f2,…,fh};选取私钥种子矩阵犘狉犻犓犛犕=实现私钥查询阶段和挑战密文阶段的有效仿真,计算加密密钥种子矩阵犘狌犫犓犛犕=且由于犘狉犻犓犛犕中各元素和b均是随机选取,所以该加密密钥种子矩阵和真实的新IBE方案的加密密钥种子矩阵不可区分;保密私钥种子矩阵犘狉犻犓犛犕,公开系统参数〈q,G1,G2,^e,P,g1,g2,F,犘狌犫犓犛犕〉.2.私钥查询阶段1.攻击者A可以向仿真器B多次询问任意用户的私钥.令私钥查询为〈ID〉,仿真器B的私钥生成过程如下:2.1.若fh(ID)=m,则B随机输出“1”或“0”,并提前结束该次仿真.2.2.否则,与新方案的Extract算法相同,根据私钥种子矩阵犘狉犻犓犛犕和函数集F计算SKID.2.3.选取随机数σ∈犣q,计算该用户私钥如下:根据初始化阶段的已知参数,上式显然可计算;(用户私钥的有效性分析)根据私钥生成方式,有如下等式成立:σ·SKID·P-σ·b·P+a·SKID·P=σ·SKID·P-σ·b·P+a·SKID·P-a·b·P+a·b·P=a·g2+(σ+a)·(SKID-b)·P,即私钥SKID=(a·g2+(σ+a)·(SKID-b)·P,(σ+a)·P).又根据初始化阶段的加密密钥种子矩阵,显然有该用户的加密密钥PKID=(SKID-b)·P.对比新IBE方案和仿真器B可以发现,由于σ,a,b和私钥种子矩阵的元素均是随机选取,因此这两种方式生成的加密密钥和私钥不可区分,即仿真器B生成的私钥有效.2.4.返回查询结果SKID给A.3.挑战阶段.攻击者A结束私钥查询阶段1后,提交等长的明文m0,m1和要挑战的用户身份IDch给仿真器B,其中A没有询问过IDch的私钥.B生成挑战密文过程如下:3.1.若fh(ID)≠m,则B随机输出“1”或“0”,并提前结束该次仿真.3.2.否则,随机选取d∈{0,1},并根据分组〈P,aP,bP,cP,Z〉生成md的挑战密文C=〈^e(P,Z)·md,c·P,SKIDch·c·P〉,由于B已知SKIDch,所以挑战密文可计算.3.3.将挑战密文C返回给A.4.私钥查询阶段2.除了攻击者A不能询问IDch的私钥外,该阶段的执行和私钥查询阶段1相同.5.猜测阶段.攻击者A向仿真器B提交对d的猜测d.若d=d,则B输出“1”;若d≠d,则B输出“0”.最后结束该次仿真.以上过程即为一次完整的IND-ID-CPA攻击的仿真,而且由于仿真不提前结束时,系统参数和私钥查询的结果和真实环境不可区分,因此是一次有效的仿真.若能证明当仿真器的输入分组来自不同Page7的分布时,攻击者A将以不可忽略的优势成功猜测d,则此时B也将以不可忽略的优势输出“1”,那么就可以通过执行多次以上仿真(每次仿真器的输入分组在取定的分布中随机选取)构成一次统计测试求解DecisionalBDH问题(具体的求解方法将在后面描述).因此,通过以下两个引理的证明,最终可以证明定理2.引理1.当仿真器的输入分组〈P,aP,bP,cP,Z〉来自分布D,并且仿真不提前结束时,攻击者A所看到的和d的联合分布与真实环境统计不可区分.证明.根据以上仿真过程,当仿真不提前结束时,显然有攻击者A所看到的和d的联合部分只在挑战密文阶段有效,因此只需证明该阶段的统计不可区分性.已知分组〈P,aP,bP,cP,Z〉来自分布D,则Z=abcP.根据挑战密文的生成方式,挑战密文C=〈^e(g1,g2)c·md,c·P,SKIDch·c·P〉.由于c是随机选取,并且挑战密文的生成形式和真实的新IBE方案相同,因此在一次仿真中,攻击者A所看到的和d的联合分布与真实环境不可区分.又因为由多次IND-ID-CPA攻击的仿真构成的统计测试中,每次仿真器的输入分组均是随机选取,且每个分布中的分组是均匀的和随机生成的,所以每次仿真所生成的挑战密文是均匀的和相互独立的.因此攻击者A所看到的和d的联合部分与真实环境是统计不可区分的.引理1得证.证毕.引理2.当仿真器的输入分组〈P,aP,bP,cP,Z〉来自分布R,并且仿真不提前结束时,攻击者A所看到的和d的分布相互独立.证明.与引理1相同,只需证明挑战密文阶段攻击者A所看到的和d的分布相互独立.已知分组〈P,aP,bP,cP,Z〉来自分布R,则Z=rP.根据挑战密文的生成方式,挑战密文C=〈^e(P,P)r·md,c·P,SKIDch·c·P〉.由于r是随机选取并且和a,b,c无关,更进一步的说,r和A所看到的无关,因此^e(P,P)r·md是一次完美填充,即攻击者A所看到的和d的分布相互独立.引理2得证.证毕.一方面,综合引理1和2,可以看出:当仿真器的输入分组〈P,aP,bP,cP,Z〉来自分布D并且仿真不提前结束时,一次仿真中攻击者A在时间T内以优势Advθ,A=ε使得d=d;当仿真器的输入分组〈P,aP,bP,cP,Z〉来自分布R并且仿真不提前结束时,一次仿真中攻击者A在时间T内以优势Advθ,A=0使得d=d.又根据仿真过程中,函数集F的选取方式,可以估算出一次仿真不提前结束的概率.令Abort表示一次仿真提前结束事件,则Pr[Abort]=1来自不同分布时,B输出“1”的优势为:|Pr[B(〈P,aP,bP,cP,abcP〉)=1]-Pr[B(〈P,aP,bP,cP,rP〉)=1]|=1m1-1()m1以构建由若干次以上仿真组成的一次统计测试,并且若统计测试结果中B输出“1”的次数多于输出“0”的次数,则B的输入分组来自分布D;若统计测试结果中B输出“1”的次数等于输出“0”的次数,则B的输入分组来自分布R,从而实现以压倒性的概率求解DecisionalBDH问题.另一方面,易计算仿真器B的时间复杂度约为O(qIDTE).又因为攻击者A的时间约束为T,所以一次仿真中B利用A求解DecisionalBDH问题的时间约束为T+O(qIDTE).综合以上两方面可以得出,DecisionalBDH问题在时间T+O(qIDTE)内以不小于1的优势被B破解.m1-1()m1所以上述新IBE方案θ是(T,qID,ε)-IND-ID-CPA安全的.定理2得证.综上所述,新IBE方案在标准模型下具有可证明的IND-ID-CCA安全性,即在标准模型下有效地实现了DecisionalBDH问题到新IBE方案的IND-ID-CPA攻击者的归约.5新方案的实用性分析众所周知,用户加密密钥的抗碰撞性是一个重要的安全性和实用性指标.由于扩展CPK方案和其它的IBE方案的加密密钥生成过程不同,因此需要单独讨论其抗碰撞性.本节还将通过与同类方案的归约程度和时空复杂度对比,讨论新IBE方案的实用性.5.1扩展CPK方案的加密密钥抗碰撞分析根据扩展CPK方案的加密密钥种子矩阵可以看出,共存在两种可能的碰撞:(1)两用户的ID对应不同索引值时,即fi∈F使得两用户的fi(ID)值不同时,对应的加密密钥相同;(2)两用户的ID对应的索引值相同,则加密密钥相同.本节将分别讨Page8论以上两种情况.情况1.由于私钥种子矩阵的元素是随机选取,且加密密钥种子矩阵基于素数阶循环群,因此任意用户对应的加密密钥种子矩阵中元素的组合也是循环群中的随机元.由于m×h阶加密密钥种子矩阵可以产生mh种组合,因此mh种组合不发生碰撞的概率Pr1为Pr1=1-1()q1-2()q…1-mh-1()q=1+-i()q≈∏mh-1∏mh-1i=1加密密钥种子矩阵为例,Pr1≈e-2320/O(21024),可见此时不发生碰撞的概率极高.虽然根据Pr1的计算公式可以看出:不发生碰撞的概率Pr1随m×h增大而减小,但是在实际应用中显然较小的m×h已经满足应用,例如32×32的加密密钥种子矩阵具有大约1048种组合.因此在实际应用中,第1种情况几乎不会发生.情况2.由于目前对所有实用中的Hash函数很难精确地刻画其抗碰撞概率,因此本文无法精确地计算出该情况下扩展CPK方案发生碰撞的概率.但是从实用角度出发,可以通过存在性证明的方法得出,当加密密钥种子矩阵的规模达到一定时,存在某种方法使其该情况下碰撞发生的概率和某实用Hash函数相同,具体的过程见定理3.定理3.若扩展CPK方案的m×h阶加密密钥种子矩阵满足m2160用户的索引值发生碰撞的概率不大于Hash函数SHA-1.证明.本文通过构造具体的方法证明该定理.已知Hash函数SHA-1的输出为160位.因此分为以下两种情况分别证明:(1)当h|160时,构造用户ID的加密密钥生成方式为:计算用户ID的Hash值SHA-1(ID);将该值依次分为等长的h份并依次对应扩展CPK方案加密密钥种子矩阵的h列,每份的值对应相应列的行号;依次提取h列的相应行值作为该用户的加密密钥种子组合,并计算加密密钥.由于每份长为160位,因此当m2160相同.而且此时不同用户的索引值发生碰撞的概率不大于SHA-1.(2)当h/|160时,构造用户ID的加密密钥生成方式为:计算用户ID的Hash值SHA-1(ID);将该值依次分为h份,其中二进制长度为160份、二进制长度为160160h×X+160烄烅烆hX+Y=将h份依次对应扩展CPK方案加密密钥种子矩阵的h列,每份的值对应相应列的行号;依次提取h列的相应行值作为该用户的加密密钥种子组合,并计算加密密钥.由于每份的长小于等于160当m2160且此时不同用户的索引值发生碰撞的概率不大于SHA-1.综合1、2,定理3得证.根据定理3可知,当扩展CPK方案的加密密钥种子矩阵达到32×32阶以上时,必然存在某种方法使其不同用户索引值发生碰撞的概率不大于Hash函数SHA-1.同理,当扩展CPK方案的加密密钥种子矩阵达到16×32阶以上时,必然存在某种方法使该碰撞的发生概率不大于Hash函数MD5.进一步可以看出,与情况1相反,情况2不发生碰撞的概率随m×h增大而增大,但是通过以上分析可见存在很多种加密密钥种子矩阵规模使以上两种情况发生的概率很小.另外,由于原CPK方案和扩展CPK方案的加密密钥生成方式相同,因此上述用户加密密钥的碰撞分析同样适用于前者.5.2新方案与同类方案的归约程度对比可证明安全性的归约程度是衡量一个密码体制安全性和实用性的重要指标.总的来说,基于同一个困难假设(不仅假设的文字描述相同,且安全性的量化也相同)的不同密码体制的可证明安全性,归约程度越“紧”(具体的含义见下文)则密码体制越安全;换句话说,基于同一类困难假设(假设的文字描述相同,但安全性的量化不同),且具有相同安全性量化的不同密码体制,归约程度越“紧”则密码体制的安全参数越小,计算效率更高.本节将对比新IBE方案和3个知名的基于同一个困难假设的IBE方案[4,6-7]在可证明安全性中的归约程度,从而得出新IBE方案在归约程度方面的实用性.由于文献[4-6]中各IBE方案的安全性定理的描述方式不同,为了方便进行归约程度的比较,本文将各安全性定理等价转换为同一种描述形式,即假设(T,ε)-DecisionalBDH假设在群G1中成立时,各IBE方案的IND-ID-CPA安全性,并且对结论进行了优化(选取适当参数使归约达到最“紧”),具体结论见表1(称文献[4-6]中的IBE体制分别为BB04a、BB04b、W05).Page9表14种IBE方案的IND-ID-CPA安全性对比IBE方案名称BB04aBB04bW05(T-O(ε-2ln(ε-1)λ-1ln(λ-1)),qID,32(N+1)qIDε)新IBE方案归约程度越“紧”指的是:若可以证明基于(T,ε)-HA假设,密码体制是(T-TR,ε)-SD安全的,其中HA表示某难题(例如,DecisionalBDH难题等等)、SD表示某安全性定义(例如,IND-ID-CPA安全性等等)、TR表示归约的时间复杂度,那么ε和ε越接近,归约程度越“紧”.根据表1可以看出,基于同一个困难假设的新IBE方案和BB04b方案具有目前同类方案中最“紧”的归约,换句话说,当以上4个方案具有相同的安全参数时,新IBE方案和BB04b方案的安全性最高.另一方面,虽然难题和密码方案的破解难度与时间有关,即时间越长破解优势越高,但是由于实用中安全的密码方案和难题通常是指在相当长的时间内它们的破解优势可忽略,表24个IBE方案的加解密时间复杂度和密文长度对比IBE方案的名称BB04aBB04bN+1W05新IBE方案2N+1N+2根据表2显然可以看出,虽然BB04b和新IBE方案具有目前最优的归约程度,但是BB04b方案的加解密时间复杂度和密文长度是4个方案中最差的,相反新IBE方案和W05方案具有目前最优的加解密时间复杂度和密文长度.综合以上两点可以得出,新IBE方案不仅具有目前最优的归约程度,同时具有目前最优的加解密时间复杂度和密文长度,是相对比较实用的加密方案.6总结与展望针对CPK方案存在合谋攻击的缺陷,本文在完全继承CPK方案的基础上,对其私钥生成过程进行了扩展,使得扩展CPK方案具有可证明的抗合谋攻击性.CPK方案是一种用于给基于身份密码体制生成加密密钥和私钥的方案,其最终意义还是要运用在某基于身份密码体制中,因此构建可证明安全的基于扩展CPK方案的IBE方案具有重要意义.本文基于扩展CPK方案提出了一个在标准模型下基通过适当取系统参数使归约达到最“紧”时的近似值;e=2.71(下同)通过适当取m使归约达到最“紧”时的近似值(m=qID)因此基于难题的时间参数T很大,而又因为归约过程是有效时间内可完成的(否则证明过程无意义),即TR最多为多项式时间复杂度,所以不考虑表1中4个IBE方案的IND-ID-CPA安全性因时间参数的不同对安全性的影响.由此可见,在归约程度上新IBE方案具有相对较好的实用性.5.3新方案与同类方案的时空复杂度对比除了归约程度外,由于较长时间的加解密过程会降低密码方案的应用范围,较长的密文会消耗更多的传输资源,因此加解密时间复杂度和密文长度是衡量密码方案的另一个重要指标.与上一节相同,本节将对比表1中4个IBE方案的加解密时间复杂度和密文的长度,具体数据见表2.解密时间复杂度群G2的模乘运算/次222于DecisionalBDH假设可证明安全的新IBE方案.最后,为了说明扩展CPK方案具有基本的实用性,即用户加密密钥的抗碰撞性,本文分析了加密密钥种子矩阵的规模对该碰撞性的影响.另一方面,本文对比了目前知名的3个同类方案和新IBE方案的3个重要的实用性指标,即安全性证明中的归约程度、加解密时间复杂度、密文长度,并得出新IBE方案在以上三点上具有目前最优的性能,因此新IBE方案是相对较实用的.目前,研究在标准模型下基于DecisionalBDH假设具有更“紧”归约的可证明安全的IBE方案仍然是一个公开的问题[7].致谢感谢华中科技大学计算机学院信息安全实验室的郑明辉博士、粟栗博士对可证明安全性理论的前期指导和对文章有价值的讨论!
