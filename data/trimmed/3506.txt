Page1多接口移动主机最优化费用和性能方法研究张春燕1)徐恪1)王保进2)沈蒙1)1)(清华大学计算机科学与技术系北京100084)2)(解放军信息工程大学信息工程学院郑州450002)摘要目前移动主机普遍具有多个网络接口,可以由这些接口通过不同的网络服务提供商(ISP)接入到Internet中.因此,移动主机与Internet之间就可能存在多条路径,通信的费用和性能取决于ISP的收费策略和网络通信性能.文中首先对移动主机与Internet通信进行建模,然后提出一种基于主动探测可用路径的最优化费用和性能的流量分配方法.最后,对此方法进行仿真,并与几种常见流量分配方法进行对比.结果表明本文所提出的方法能根据主机对费用和性能的需求合理分配和控制流量.关键词多网络接口;移动主机;费用和性能最优化;主动探测;流量分配1引言再适应当前的应用需求.互联网设计的最初假设是每个主机只有一个接入网络和一个默认网关.但经过几十年的发展,尤其是移动互联网时代的到来,连接到Internet的手段更加多样化:有线接入、Wi-Fi随着互联网的高速发展,最初的设计理念已不Page2网络、GPRS/EDGE、3G网络等,网络已经向着异构网络融合的趋势演进;连接到Internet的设备也多种多样:从PC机到手机,到万物均可联网的物联网等.可以说,终端和网络环境的变化远超出了在20世纪80年代人们设计TCP/IP协议和模型时候的想象.在这种场景下,具有多个网络接口的移动主机应运而生,这些移动主机不仅包括手机,还包括各种各样的PDA、GPS设备等.而以IPv6[1-2]为标志的下一代互联网的出现为移动主机带来了很大的便利.下一代互联网的目标是使网络向更大、更快、更安全的方向发展,针对当前IP地址资源日益枯竭的现象,提出了IPv6协议.这个协议IP地址资源丰富,使得点到点的通信真正成为现实.IPv6将地址空间从32位扩充到了128位,因此完全可以实现为移动设备分配地址这一需求.而且IPv6具有的邻居发现机制、安全机制等为移动网络解决了许多后顾之忧.目前,固定主机也大都具有多个网络接口,但多接口移动主机与固定主机有着较大的区别.首先,由于固定主机地理位置固定,所以不会很频繁地在网络接口间进行切换,而移动主机具有移动性,通常会因为地理位置的改变而引起网络的切换和通信质量的改变;其次,固定主机接入网路都具有高可靠的服务质量保障,而移动主机不能很好地保证其链路的可靠性和容错能力,因此应该实时寻找多条好的路径;最后,移动主机接入的网络具有丰富性,不仅可以接入移动网络,还可以接入为固定主机提供服务的网络中.现在对于多接口固定主机的研究主要集中在多宿主(multihoming)[3]的设计实现和优化上,但由于固定主机和移动主机的区别,移动主机不能完全借鉴固定主机的做法.多接口移动主机在接入网络后,与Internet之间就存在着多条路径,这些路径的费用和性能取决于网络服务提供商的收费策略和网络通信性能,因此不能简单地选择其中一条或者多条路径.本文通过对移动主机与Internet通信进行建模,针对移动主机通信的特点,对其费用和性能通过两个步骤进行最优化:第1步,探测通过ISP的可用路径集;第2步,在该可用路径集中,求解使得费用和性能最优的流量分配方案.最后,本文对此最优化方案进行仿真.仿真表明,移动主机不能做到费用和性能均为最优.当费用最优时,性能较差,当性能最优时,费用较高,因此只能取两者的折中方案.而ISP的容量也对费用和性能有一定的影响,在相同的收费策略和链路性能条件下,应该选取较大容量的ISP.另外,本文所提出的费用和性能最优方案虽然计算稍微复杂,但计算出的分配方案能够较好满足移动主机的需求.这个研究也可以用于多接入站点的性能和代价的优化.本文第2节介绍当前国内外相关工作;第3节对多接口移动主机的通信场景进行抽象和建模;第4节介绍求解该模型最优化费用和性能的方案;第5节对该模型进行仿真,测量多接口移动主机分配方案的性能和费用,并与常见的几种流量分配方案进行对比和分析,最后结合本文所提方案给出一个实际应用的例子;第6节对本文工作进行了总结,并指出进一步的工作.2相关工作为了解决多接口移动主机的相关问题,IETF于2008年成立了MIF工作组(MultipleInterfaceWorkingGroup)①,进行多接口IP模型标准化工作.MIF工作组对多接口的定义是移动主机利用多个接口接入一个或者多个供给域,并为其分配来自不同域的IP地址,主机可以利用这些地址同时并独立地进行通信.目前MIF工作组的主要工作集中在移动主机多接口通信机制上,主要包括多接口虚拟化②、多接口API③及连接管理器④等.在多接口移动主机费用和性能优化方面的研究较少,但多宿主主机的优化问题和策略配置研究较为成熟,主要关注点是多宿主主机的实现技术[3-4]、宿主路径选择[5]和费用性能优化[6-8]以及与覆盖网络的比较[10].从本质上讲,多宿主主机是一台具有多个网络连接的主机,在Internet中,多宿主连接系统是一个连接到两个上游服务提供商的系统.在文献[6]中对多宿主机的费用和性能进行了优化分析,提出了4种优化场景和策略,主要做法是通过在费用的约束条件下最优化性能的思想,将问①②inahostdraft-hong-mif-virtual-interface-02.http://tools.ietf.org/htm/draf-honf-mif-virtual-interface-02.October③④Page3题转换成一个最小花费多物网络流(Minimum-CostMulticommodityFlow,MCMCF)的线性规划问题.但该文章针对的是固定主机,没有考虑主机移动性带来的频繁探测和切换网络的问题,并且算法复杂,对于移动主机而言计算量过大.文献[7]提出了一种在线服务提供网络(OnlineServiceProviderNetworks,OSPN)中优化费用和性能的算法.它首先使用一种新颖的路由注入方法探测可用路径,这种方法能在不影响正在使用路径的情况下探测出新路径的性能;然后根据代价、性能等因素计算费用和性能最优的流量分配方案.但由于该文针对的场景是OSPN网络,包含网络服务器和数据中心,提供从数据中心到用户的路径,且由于连接的ISP数量庞大,因此与多接口移动主机的多路径有着本质区别.3多接口移动主机通信模型移动主机可以可以具有多个网络接口(如Wi-Fi,GPRS/EDGE,3G网络等),每个接口可在某一时刻与一个ISP连接,通过与ISP协商获取该接口的配置信息(包括IP地址、网关信息等),这样一台移动主机就可以通过不同的接口接入到Internet中.当移动主机需要访问Internet中的某个资源时,可以通过不同的接口和不同的ISP产生不同的路由访问该资源.图1是多接口主机的应用场景图.图中有两种通信方式:一种是移动主机间的通信,如图中左下角的iPhone与右下角手机间的通信;另外一种是移动主机和固定主机或者服务器的通信,如图中iPhone与右上角服务器间的通信.移动主机通常具有多个接口,如图1中左下角iPhone有IF_1的Wi-Fi接口和IF_2的3G网络接口,并且各自具有不同的链路层标识(LL_ID,LinkLayerIdentifier).为了能够灵活高效地操作多个接口,IETFMIF工作组的做法是在物理接口之上建立一个虚拟接口,这个接口对网络层透明,通过连接管理器管理这些接口.基于图1,本文对所研究问题进行如下假设:(1)无论是移动主机间通信还是移动主机与服务器或者固定主机通信,将另外一个被通信节点抽象为一个位于Internet中的目的通信节点,记为Node.(2)在某一时刻,移动主机的一个接口只能连接一个ISP,这也是移动主机通常的做法;在与一个ISP断连之后,可以尝试连接其他ISP.(3)在某一时刻,可以有多个ISP提供从移动主机到目的通信节点的链路.(4)移动主机与通信节点通信是双向的,即移动主机既有上游通信流量(Upstream),也有下游通信流量(Downstream).收费的通信量记录的是双向的通信流量,而不管是上游流量还是下游流量.因此,为了方便建立模型,将这两种方向的流量都标记为上游通信流量.抽象出的多接口移动主机通信模型如图2所示.图中,Host表示移动主机节点,Node表示目的通信节点.图中的连线和箭头表示Host产生的网络流量.Host1可以通过ISP1、ISP4和ISP5访问目的节点Node1;Host2可以通过ISP1、ISP2和ISP3访问目的节点Node2.将图2的通信场景简化模型进行抽象,得到多接口移动主机的流量分配模型.假设主机和ISP无连接可视为链路上分配的流量为零,则主机和每个ISP之间可以建立关系图,如图3所示.在图3这个模型中,由于只关心Hosts和ISPs间的流量分配,所以可以忽略目的通信节点Nodes.在这个模型中,可抽象出3个集合,分别是多接口移动主机(左边节Page4点)组成的Host集、为移动主机提供接入服务的ISP(中间节点)组成的ISP集、移动主机和ISP间的链路组Link集.由于移动主机具有移动性、数据需求实时性、接入网络丰富性等特点,这3个集合很有可能实时变化,这也是移动主机不同于固定主机的地方.在为移动主机多个接口分配流量时,需要经过两个步骤:首先,由于链路易失效,ISP集和Link集易变,因此在每次分配流量之前,都需要首先探测可用路径.第2步,在所有可用路径上,求解使得费用和性能最优的流量分配方案.4最优化费用和性能的分配方案首先对本文中所用到的标记和变量进行说明.在未提前声明情况下,本文所使用符号意义均参照表1中的解释.PerfMeasurement移动主机总的性能描述Ck(x)ISPk的收费函数,x是收费变量,PricekRTTi,k移动主机i分配给ISPk流量经历的RTT4.1探测可用路径在不影响移动主机正常通信的情况下,搜索新的路径,并计算这条新路径的性能指标,加入到Link集中,同时还需要实时更新Link集中的链路性能值.参考文献[7]中介绍了一种路由注入的探测方法,它可在不改变当前流量分配的路径的情况下,测量新路径性能.文献[11]提出了一种主动探测覆盖网络路由的方法,它针对覆盖网络的特点,如底层网络变化带来的拓扑变化、网络负载的实时变化,主动地在选定的节点上注入流量,测量其在可用路径上的性能.上层网络需要根据探测出的底层改变,调整其路由策略.该方法可以主动寻找和探测节点带宽,测量尺度比较丰富.文献[12]提出一种基于包排队方式的双步长网络路径可用带宽探测方法,通过检测包的排队延时来获取可用带宽,减少了探测次数和运行时间,降低了探测开销.根据移动主机自身和接入网络的特点,本文采用主动探测路径性能的方法,性能尺度将在4.3节性能评估模型中进行介绍.探测过程是:首先,检测移动主机所在范围内的可提供服务的ISP.主机的可用接口在与ISP建立连接时,ISP会返回网络的配置信息;其次,借鉴文献[7]中的方法,在不影响当前流量分配的情况下,测量该连接的性能.在探测出可用路径集后,就可以对所有移动主机在其可用路径上计算流量分配方案.接下来分别介绍移动主机采用的费用模型和性能模型.4.2费用模型目前国内ISP主要有3家:中国电信、中国网通和中国移动.接入方式主要有ADSL、GRPS、3G网络等.其资费方式各不相同,并且因地域差异和各人喜好也有不同的收费标准.但这些收费方式都有一个共同特点:均包含两个部分,一定流量或者时间的固定费用和超出流量或者时间的可变费用.将计费流量或者时间记为w,常量部分记为ConstPay-ment,超出部分记为ExcessPayment,可用下面公式表示:Cost(w)=ConstPayment+ExcessPayment(w).通常,这个超出部分的费用是关于流量或者时间的线性函数,将常量部分流量或者时间的阈值记为w0,超出部分的费用可表示为ExcessPayment(w)=Price×(w-w0),w>w0.当未超过阈值时,新增流量或时间不会收费,可视为Price为0;当超过阈值时,新增流量或时间按线性收费.对于需要分配的流量或时间x,Cost可简单归纳为其中,Page5国外一种最常用的ISP计费方法是95thper-centile.它是一种广泛使用的衡量网络规律和持续利用率的数学计算方法.使用这种方法可以避免因不正常使用或者网络突发事件而导致的突发高流量现象.使用方法是在取样间隔内(例如300s)计算平均带宽,计算方法是数据流量/间隔时间(300s),在一段时间(如一个月)后,对这些间隔带宽进行从高到低排序,去掉最高的5%,剩下的最高的数据作为这个月的计费带宽.将计费带宽记为x,则费用函数为无论是国内还是国外的计费方式,总的费用都是将各个ISP的收费累加.求费用的最优解可写为minCost=∑K本文使用的流量计量方式将基于此公式,根据各个ISP收费单价的不同计算费用.4.3性能模型文献[6]介绍了几种衡量网络性能的方法,网络性能的尺度包括网络延时、吞吐率、可利用带宽、通信质量(丢包率)等.由于移动主机硬件资源有限,而且需要实时探测路径,探测路径不能过于复杂,因此采用RTT延时度量网络性能.和分配的流量情况,可由如下公式计算得到:在度量网络性能时,需要兼顾每条链路的性能上文介绍了费用和性能模型,下面介绍如何获其中:P值越小,总体性能越好;反之,P值越大,总体性能越差.4.4计算费用和性能的最优化方案取费用和性能的最优化流量分配方案.4.4.1节给出了一种在性能约束P下的费用最优的流量分配方案,并进一步研究了性能约束P与最优费用的关系;4.4.2节在4.4.1节计算出的性能和费用关系基础上,给出一种根据用户要求定制的费用和性能的多约束优化方案.4.4.1费用最优方案首先求解在性能一定条件下的费用最优线性规划问题.目标函数是总费用最小,即对于所有移动主机的分配给所有ISP流量的费用之和最小.目标函数:minCost=∑K约束条件为∑Ii=1∑Kk=1i,k,i∈[1,2],k∈[1,k],0fi,k1约束条件(1)是对每个ISP的容量建立的约束,所有移动主机分配给ISPk的流量之和不能超过ISPk容量的α倍.约束条件(2)是针对性能建立的约束,P值可调.约束条件(3)保证了每个移动主机分配的流量都可到达ISP.约束条件(4)确定了解区间的正确范围.在这组线性规划表达式中,Pricek,α,Capk是可以从日常数据中提取的常量,Voli,RTTi,k可以在实际应用中测得,因此可以计算出在性能约束为P的条件下,移动主机为每个ISP分配的流量比例fi,k.改变P值,得出最优的费用,可得出一条费用和性能的曲线.不同的移动主机和ISP的参数得到的曲线有所不同,如图4所示.可知费用和性能是相互约束的,当性能较好时,费用会较高;当费用较少时,性能会较差.4.4.2最优化费用和性能方案4.4.1节中介绍的方案只是在性能一定的条件下求解最优的费用,而没有很好地将两者结合起来.而实际情况是在大多数情况下,无法确定一个实际的性能值.为了能更好地解决这个问题,借鉴4.4.1节已经得出的结论,设计一种包含费用和性能的双变量的目标函数:minZ=Cost+λ×PerfMeasurement,λ∈[0,)Page6其中:PerfMeasurement是将4.4.1节中性能指标P改为连续变量后的移动主机性能描述量.λ是费用和性能的折中参数,根据移动主机的需求而定.λ取值越小,说明用户越注重费用;反之λ越大,说明用户越注重性能.考虑到λ取值范围太大,将其归一化到[0,1]之中.归一化的好处在于使得用户更能理解这个调节费用和性能的参数.当这个参数接近0时,说明看重费用最优,当接近1时,说明看重性能最优.在众多归一化方法中,选择反正切函数对λ进行归一化.归一化后的参数记为γ,公式如下:其中,L为归一化常量,可以由统计数据给出.这是一个多目标的线性规划问题.但由于这个目标函数里只有两个决策变量,可采用直观的图解法进行求解.该问题的可行域是在4.4.1节中已经求解出的不同场景下最优化的费用和性能关系曲线,利用图解法可以求出目标函数与相应曲线的交点,通过计算费用和性能曲线和目标函数Z=Cost+λ×PerfMeasurement相切交点的费用和性能取值,从而可求出对应的流量分配方案,如图5所示.综上所述,计算费用和性能的最优化流量分配方案的具体过程有两步:第1步,在若干个单位时间间隔后探测可用路径,获得该ISP的容量、价格等信息,并测量出该移动主机到ISP间的RTT;第2步,根据获得的这些信息,计算最优费用和性能的流量分配方案.在第2步中又分为3个步骤,首先需要计算某特定场景下的费用和性能曲线Cost=Fun(PerfMeasurement);其次,求解该费用和性能曲线与目标函数相切的交点;最后,按照这种分配方案为每个移动主机分配流量.这个过程的伪代码描述如下://第1步:探测可用路径ExploreAvailablePaths();//第2步:计算最优费用和性能流量分配方案//输入:ISP,Cap,RTT,Price,TrafficFlow,λ//输出:流量分配方案f,并分配流量OptCostAndPerformance(ISP,Cap,RTT,Price,}5仿真与分析第4节介绍了费用和性能最优化的流量分配方案,接下来对该方案进行仿真和分析.5.1费用和性能的关系实验仿真环境设置:有3台移动主机,分别设置流量为(100bps,200bps,300bps);4个ISP,费用分别为(1CNY,1.5CNY,2CNY,0.5CNY).设计两种ISP带宽容量场景,第1种情况ISP容量(即表1中Cap)有限,设置ISP容量均为400bps,第2种ISP容量足够容纳所有流量需求,设置ISP容量为800bps;已知已经探测得到从移动主机到每个ISP每条链路的链路状况RTT,α设定为0.95,P值从0.5取到20,得到相应的最小费用.实验的目标是计算当3台主机分别有一定数量的数据请求发送时的流量分配策略f.求解过程:根据4.4.2节最优化费用和性能方案中设计的伪代码求解过程,在探测出可用路径后,首先将参数(ISP,Cap,RTT,Price,TrafficFlow,λ)代入线性规划方程组中,求解出性能P和费用Cost的数据,根据P和Cost的取值,拟合出费用和性能的关系曲线的表达式;其次,求解费用和性能曲Page7线与目标函数相切的交点;最后根据交点求出流量分配方案f.测量结果如图6所示,第1组数据(x1和y1)是当ISP容量有限的情况下测得的,第2组数据(x2和y2)是当ISP的容量可以容纳所有流量需求时测得的.之后对这些数据使用数学工具进行拟合,通过多次测试,设计了一个较优的拟合函数:y(x)=a+c/x+d/x2+f/x3+e/x4.图6中右上曲线是由第1组数据拟合得到的,左下曲线是由第2组数据拟合得到的.图6不同流量场景下得到的费用和性能关系图5.2最优费用和性能方案在4.4.2节中介绍了求解最优费用和性能的方法.根据这个方法,当用户给定一个归一化参数γ(如γ=0.5)时,则可以根据归一化公式计算出λ(若已知归一化常量L=500),λ=500.在图6求得的费用和性能关系曲线中,如果求在ISP容量较大条件下,取λ=500时的费用和性能最优分配方案,即求图中左下曲线与Z=Cost+λ×PerfMeasurement的相切点(如图7所示),则根据在4.4.2节中给出的求解方法,求得P为1.7,费用是530,最优化分配方案是即移动主机1将流量全部分配给ISP1,主机2将60%的流量分配给ISP1,40%分配给ISP3,主机3将全部流量分配给ISP3.5.3流量分配方案对比为了测试本流量分配方案(为了与单路径区分,下面将本方案称之为多路径方案)的性能和费用的优劣,使用多路径(γ=0.5,λ=500)方案、平均分配方案、多路径(γ=0,λ=0)方案、单一路径(费用低)方案、多路径(γ=0.97,λ=10000)方案和单一路径(性能好)方案进行测试,并将这6种方案进行对比.同时,为了体现出本分配方案在不同场景中的效果,分别设计了4种不同的流量场景.(1)3台移动主机流量不相同,分别设置为100bps,200bps,300bps;(2)3台移动主机流量相同,且总流量未超过任何ISP的容量,设置均为100bps;(3)3台移动主机流量相同,且总流量超过了其中一个ISP的容量,但两台移动主机流量之和未超过任何ISP容量,设置均为400bps;(4)3台移动主机流量相同,且总流量超过了其中任何一个ISP的容量,两台移动主机流量之和也超过了任何ISP的容量,设置均为600bps.其中,多路径方案是指本文所设计的方案,分别取λ权衡费用和性能的情况以及λ的两种极值情况,由γ的取值可以对λ进行控制;平均分配方案是指每个移动主机将其流量在每个时刻都平均的分配给其连接的ISP;单一路径(费用低)方案是指移动主机只选择其中一条路径分配流量,选择时兼顾所选的路径使得总体费用最低;单一路径(性能好)方案也是指移动主机只选一条路径,但选择时兼顾所选的路径使得总体性能最好.表2是经过计算得到的各种流量分配方案的费用和性能描述值.按照表2分别对这6种方案的费用和性能进行绘图.横坐标表示4种流量场景,纵坐标分别表示费用或者性能.图中每种流量场景中的6个条形依次代表表2中的6种方案.这6种方案的费用对比如图8所示,性能对比如图9所示.Page8表26种流量分配方案在4种流量场景下的费用和性能多路径(γ=0.5)方案C=530,P=1.7C=410,P=1.2C=920,P=1.82C=1560,P=1.8平均分配方案C=750,P=1.9C=375,P=1.8C=1500,P=1.8C=2250,P=1.8多路径(γ=0)方案C=300,P=2.3C=150,P=2.3C=820,P=2.0C=1560,P=1.8单一路径(费用低)方案C=300,P=2.3C=150,P=2.3C=1200,P=1.33C=1800,P=1.67多路径(γ=0.97)方案C=1100,P=1.0C=500,P=1.0C=1820,P=1.1C=2190,P=1.3单一路径(性能好)方案C=1100,P=1.0C=500,P=1.0C=1200,P=1.33C=2100,P=1.33图86种流量分配方案在4种流量场景下的费用对比图96种流量分配方案在4种流量场景下的性能对比从图8中可以看出,这6种分配方案在费用上差异较大.从总体来看,第3种和第4种方案费用较低,这是因为多路径(γ=0)方案,折中参数λ=0,即只考虑费用最优,与单一路径(费用低)方案目的相同;第1种和第2种方案费用较低;而第5种和第6种方案费用较高,这是因为多路径(γ=0.97)方案折中参数λ=10000,几乎只考虑了性能最优,忽略了费用的影响,与单一路径(性能好)方案目的相同.然后两两对比方案的费用.对比平均分配方案,多路径(γ=0.5,λ=500)方案在费用上普遍较低;对比单一路径(费用低)方案,多路径(γ=0,λ=0)方案费用要低;对比单一路径(性能好)方案,多路径(γ=0.97,λ=10000)方案费用偏高.从图9中可以看出,这6种分配方案的性能差异也较大.从总体上来看,第5种和第6种方案性能最好,这是因为(γ=0.97,λ=10000)方案几乎只考虑了性能最优,而单一路径(性能好)方案也是只考虑了性能,第1种和第2种方案性能较好;而第3种和第4种方案的性能最差,这是因为这两种方案都只考虑了费用最优,而忽略了性能.然后两两对比方描述值案的性能.对比平均分配方案,多路径(γ=0.5,λ=500)方案在性能上普遍要好;对比单一路径(费用低)方案,多路径(γ=0,λ=0)方案性能稍差;对比单一路径(性能好)方案,多路径(γ=0.97,λ=10000)方案性能要好.由上面费用和性能的比较可得知,本文所述的多路径分配方案能更好地按照移动主机的需求分配和控制流量.由λ决定费用和性能之间的权衡关系.当λ取值较小时,多路径方案可以做到费用最低;当λ取值较大,多路径方案可以做到性能最好;λ取中间值,多路径方案可以做到费用和性能两者的折中.再对这些方案的复杂性进行分析.在多路径方案中,首先求解了一个线性规划问题,采用内点法时该问题具有多项式级O(n3)的复杂度[13].然后是求解费用和性能曲线与目标函数的相切点,这两个函数都是多项式函数,因此具有多项式级O(n4)的复杂度.最后再通过费用和性能求解流量分配,这是一个多项式级O(n2)的复杂度问题.因此,多路径方案具有O(n4)的复杂度.平均分配方案可经过有限步将流量分配在各个链路上,因此是一个O(1)的问题.单一路径的两种方案是一个单目标的整数规划问题,复杂度是O(n2).但复杂性估算的是最坏情况,一般情况下线性规划的复杂度不会太高.下面对这几种方案进行进一步对比和分析.从表3的对比可知,每种方案都有优缺点,但相比本文所提出的方案虽然计算稍微复杂,但给出的流量分配方案是最为合理的,且可以根据移动主机的需求分配和控制流量.综上所述,从5.1节可知,移动主机不能做到费用和性能均为最优.当费用最优时,性能较差,当性能最优时,费用较高,因此只能取两者的折中方案.而ISP的容量也对费用和性能有一定的影响,在相同的收费策略和链路性能的条件下,应该选取较大容量的ISP.从5.2节和5.3节可知,本文所提出的费用和性能最优方案虽然计算稍微复杂,但计算出的分配方案能够满足移动主机的需求.Page9对于优化费用和性能这个问题,选择合适的折中参数λ很重要,当需要费用较小时,选择较小的表36种流量分配方案的对比多路径(γ=0.5)方案较低较好O(n4)费用和性能根据移动用户需求定制,都能做到较优计算稍微复杂平均分配方案较高较差O(1)多路径(γ=0)方案最低最差O(n4)单一路径(费用低)方案较低较差O(n2)多路径(γ=0.97)方案最高最好O(n4)单一路径(性能好)方案较高较好O(n2)5.4一个实际应用的例子设计一个实际应用场景:有1台移动主机(手机或iPad等);有2个ISP网络(GPRS和3G网络)可供接入;收费方式是按月收费,每个ISP都有在一定流量或者时间范围的固定费用ConstPayment和超出部分的可变费用ExcessPayment.实验采用如下资费标准:GPRS选择的是每月5CNY包30MB流量的资费方式(假设带宽为115Kbps),超出部分流量0.01CNY/KB;3G网络选择的是每月50CNY包600MB流量的资费方式(假设带宽为2Mbps,可随网络环境而变化),超出部分0.1CNY/MB.假设已测得3G网络的RTT小于GPRS的RTT.每个月总的固定费用为5+50=55CNY,下面对每月超出费用进行计算.移动主机可以实时统计主机对于各个ISP的网络使用情况.当某些ISP网络流量或者时间没有超过固定部分时,根据4.2节介绍的费用模型,相当于Price为0.若用户预测到本月剩余流量或者时间不能用完,可以调整折中参数λ取较大值(γ→1).这样在费用不变的条件下,可以取得较好的性能.当所有ISP网络流量或者时间已经超过的固定部分时,每个ISP的收费价格Price不为0.若用户考虑到网络花费较少,则可以调整折中参数λ取较小值(γ→0).若用户需要处理重要事务,需要让性能最好,而费用考虑较少,则仍然需要调整λ取较大值(γ→1).一般情况下需要兼顾费用和性能,因此用户可以根据实际需要调整λ取中间值(0<γ<1).移动主机上可以统计网络的使用情况.可能出现3种情况:第1种是两种网络都有余量;第2种是有某种网络的余量已经用完;第3种是所有网络的余量都已经用完.测量结果见表4.对于第1种情况,这种情况比较简单.ISP价格都为零,这条费用和性能曲线的斜率为零,相当于不用考虑费用,只需要让性能达到最优.依据第4节的方法,首先探测可用路径,这时GPRS和3G网络都λ;当需要性能较好时,选择较大的λ;当既要考虑费用,又不能忽略性能时,选择适中的λ.费用和性能都较为均衡,计算量小费用较低,计算稍微简单性能最好,计算稍微简单可用.测量出这些路径的RTT.一般情况下3G网络的RTT较小.实验结果是:当总流量小于或者等于3G网络的容量时,选择使用3G网络;当总流量大于3G网络的容量时,超过3G网络带宽部分选择使用GPRS.若GPRS的RTT较小时,则实验结果与之相反.第2种情况是当某种网络的固定流量已经用完,如3G网络的600MB已用完,则3G网络的价格为0.1CNY/MB,GPRS仍为0CNY.用户可调节λ的取值,选择合适的费用和性能取值.如某一时刻有300KB的流量,计算出的费用性能曲线如图10所示.若用户想要费用最少,则选取较小的λ(γ→0),如取0(γ=0)时,费用为0CNY,性能为2;若用户想要性能最好,则选取λ较大(γ→1),如取10000(γ=0.97),费用为0.03CNY,性能为1;若用户想要均衡费用和性能,则可选择λ=500(γ=0.5)时,费用为0.15CNY,性能为1.5.图10当3G流量用完时的费用和性能关系图第3种情况是当两种网络流量都已经用完,则GPRS的价格为0.01CNY/KB,3G网络的价格为0.1CNY/MB.若有300KB的流量,同样可求解出的曲线图如图11所示,由于3G网络的性能较好,价格低,因此无论λ取何值,都选择3G网络,费用都为0.03CNY,性能为1.Page10图11当两种网络流量用完时的费用和性能关系图网络使用情况λ取较小值第1种情况C=0,P最优C=0,P最优C=0,P最优第2种情况(如,3G网络用完)C=0,P=2C=0.15,P=1.5C=0.03,P=1第3种情况C=0.03,P=1C=0.03,P=1C=0.03,P=16总结和进一步工作目前移动主机普遍具有多个网络接口,并可以由这些不同的接口通过不同的网络服务提供商接入到Internet中.而以IPv6为标志的下一代互联网的出现为移动主机带来了更大便利,解决了移动主机对于多个IP地址的需求和移动网络安全方面的问题.在这样的条件下,移动主机与Internet之间就可能存在多条路径,但这些路径的费用和性能取决于ISP的收费策略和网络通信能力,因此不能简单地选择其中一条或者多条路径.本文主要解决了多接口移动主机的最优化费用和性能的流量分配问题.首先,对移动主机与Inter-net通信进行建模,然后针对移动主机通信的特点,对其费用和性能通过两个步骤进行最优化:第1步,探测通过ISP的可用路径集;第2步,在该可用路径集中,建立费用和性能的双目标线性规划,按照移动主机的需求求解,获得费用和性能最优的流量分配方案.最后,本文对此最优化方案进行仿真,并与几种流量分配方式进行对比.分析表明分配方案虽然计算稍微复杂,但能够根据移动主机需求分配和控制流量.本文在一些方面还存在着不足,需要继续进行研究.(1)机制设计问题.由于当前没有一个统一的多接口通信标准,使得通信机制比较混乱.差的机制不仅会使通信质量降低,而且会浪费网络和硬件资源.同时,还有DNS服务器的选择、路由的选择、源和目的地址的选择等,这些通信过程是多接口移动主机与之前单一接口所不同的地方.(2)根据高层业务流区分服务的流量分配.在未来的工作中,可以针对高层不同的业务选择适当的链路进行流量分配.(3)路由膨胀问题.由于移动主机具有多个接口,而且访问每个目标地址具有多条路由,因此会导致主干网络的路由剧增问题.而IPv6的引入稍微缓解了这个问题,但是需要寻找对症下药的解决途径.
