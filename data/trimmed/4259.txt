Page1犣犖上离散对数量子计算算法付向群1)鲍皖苏1)王帅2)1)(解放军信息工程大学郑州450002)2)(73671部队安徽六安237008)摘要文中通过多次量子Fourier变换和变量代换,给出了一个ZN上离散对数量子计算算法,刻画了元素的阶r与算法成功率的关系,当r为素数时,算法成功的概率接近于1,新算法所需基本量子门数的规模为O(L3),且不需要执行函数|f(x1,x2)〉的量子Fourier变换的反演变换,优于已有的ZN上离散对数量子计算算法,其中L=[logN]+1.关键词量子Fourier变换;离散对数;量子计算算法;公钥密码;量子门;网络安全;信息安全1引言自BB84协议[1]提出以来,人们开始不断的关注量子信息技术的研究[2-4].BB84协议可用于密钥分配,基于该协议可以解决对称密码体制的密钥分配问题,其安全性是基于量子态的测不准原理和不可克隆定理,而非计算上的安全.然而量子态还存在一个非常重要的性质———叠加性,基于该性质可以实现并行计算.1992年,Deutsch等人[5]基于量子态的叠加性设计了第一个量子计算算法,该算法展示了量子计算机的强大并行计算能力.在之后几年,出现了迄今为止最具影响力的两个量子计算算法———Shor算法[6]和Grover量子搜索算法[7],这主要在于Shor算法可以在多项式时间内求解大整数分解和有限域上离散对数问题,基于该算法可以在多项式时间内破译RSA公钥密码体制、ECC公钥密码体制和Diffe-Hellman协议;Grover量子搜索算法是量子计算机上的搜索算法,利用该算法对密码进行密钥穷尽攻击,计算复杂度可以得到开平方根的降低.这两个量子计算算法的提出,对现代密码的安全性造成了巨大的威胁,特别是公钥Page2密码体制[8].目前,对Shor算法的研究主要有两个方面———提高Shor算法的成功率和优化Shor算法的实现技术[9].在量子计算模式下,Shor整数求阶量子计算算法[6]是求解整数分解和有限域上离散对数问题的关键,该算法的成功率是4φ(r)/π2r(φ是欧拉函数,r是ZN中所选元素的阶).对于素域上的离散对数问题而言,Shor在其原始论文中,基于整数求阶量子计算算法给出了一个求解算法,算法的成功率是1/480[6].尽管Shor算法是针对素域上的离散对数问题给出的,但Shor指出上述证明并没有利用到素域的特性,因而对有限域上的离散对数问题也同样成立.1997年,Eicher和Opoku①给出了一个在多项式时间内以1/480的成功率攻击椭圆曲线离散对数问题的量子计算算法.2000年,Jozsa提出了一个求解有限域Fp(p为素数)上离散对数的量子计算算法①,其成功率为φ(p-1)/(p-1),同年,对更具有普适性的ZN上离散对数问题,Nielsen和Chuang[10]基于相位估计给出了一个量子求解算法,但该算法比较复杂,需要做函数|f(x1,x2)〉的量子Fourier变换的反演变换.如何给出更为简单的求解ZN上离散对数量子计算算法,还有待进一步研究.本文通过使用多次量子Fourier变换和变量代换,给出了新的求解ZN上离散对数量子计算算法,刻画了元素的阶r与成功率的关系,当r为素数时,算法的成功率接近于1.新算法与Nielsen算法相比,成功率一样,但不需要做函数|f(x1,x2)〉的量子Fourier变换的反演变换.2基础知识定义1(离散对数问题)[11].给定一个阶为n的有限循环群G,G的一个生成元α和一个元素β∈G,求解整数x,0xn-1,使得αx=β.定义2(量子Fourier变换)[10].设UF是标准正交基|0〉,|1〉,…,|N-1〉上的线性算子,作用在基态上的变换为那么UF作用在任意量子态上的变换为UF:∑N-1称UF为量子Fourier变换,其中,ωN=e2πi/N是N次文献[10]证明了量子Fourier变换是可逆变UF为n维量子Fourier变换.换,并给出了其量子实现线路.3犣犖上离散对数量子计算算法改进2000年,Jozsa提出了一个求解有限域Fp(p为素数)上离散对数量子计算算法②,算法运行一次的成功概率为φ(p-1)/(p-1).Shor离散对数量子计算算法与Jozsa离散对数量子计算算法相比,前者是求解一般有限域上的离散对数问题,后者是求解素域上的离散对数问题.2000年,Nielsen等人[10]给出了更普适的离散对数量子计算算法,即ZN上离散对数问题的量子计算算法.3.1Nielsen的犣犖上离散对数量子计算算法定义3(ZN上离散对数问题)[10].给定g∈ZN,gcd(g,N)=1,g的阶为r且已知,〈g〉是由g生成的循环群,对任意的x∈〈g〉,求解整数s(0sr-1),使得x=gsmodN.有了上述定义,下面给出Nielsen的ZN上离散对数问题的量子计算算法[10],其具体算法如下.算法1.Nielsen的ZN上离散对数量子计算算法.输入:r,N输出:s1.给定两个m=[logr]+log(1/ε)维量子寄存器和一个L=log[]N+1维量子寄存器,其初态均为|0m,0m,0L〉,[logr]为不超过logr的最大整数,对前两个寄存器做在标准正交基|0〉,|1〉,…,|2m-1-1〉上的量子Fourier变换UF,产生一个状态叠合2.做量子黑盒变换,并行计算fa,()b=gaxbmodN2t∑2t-1a=0∑2t-11再对函数f(a,b)做一次量子Fourier变换的反演变换,则量子叠加态变为l2=0∑2t-12t槡r∑r-112t槡r∑r-11①②Page33.对前两个寄存器分别做在标准正交基|0〉,|1〉,…,|N-1〉上的逆量子Fourier变换,可以得到4.对前两个寄存器进行观测,得到(sl2/r~,l2/r~);5.应用推广的连分式算法可以求得s.Nielsen算法的步2中f^(l1,l2)=1f^l1,l()2是|f(x1,x2)〉的量子Fourier变换,且有下式成立f^l1,l()2=槡r∑r-11烄烅j=00,烆由此可以得到|f(x1,x2)〉的量子Fourier变换的反演变换|f(x1,x2)〉=1在算法的步4中的(sl2/r~,l2/r~)分别为相位(sl2/r,l2/r)的近似值.Nielsen算法的成功率为φ(r)/r,算法中需要使用2次量子Fourier变换、2次逆量子Fourier变换、一次函数|f(x1,x2)〉的量子Fourier变换的反演变换和一次模幂运算.3.2新的犣犖上离散对数量子计算算法Nielsen算法通过相位估计求解离散对数问题,就其算法本身而言,即使算法观测的结果满足应用推广的连分式算法的条件,其求解结果也会产生误差,而且算法还要做函数|f(x1,x2)〉的量子Fourier变换的反演变换,针对Nielsen算法的这些缺点,本文提出了一个更为简单的ZN上离散对数问题的量子计算算法,其具体算法如下.算法2.新的ZN上离散对数问题的量子计算算法.输入:r,N输出:s1.给定3个m=[logr]+1维量子寄存器和一个L=log[]N+1维量子寄存器,其初态均为|0m,0m,0L〉、[logr]为不超过logr的最大整数,前两个寄存器用于存储函数的输入,第3个寄存器是一个辅助寄存器且用于存储函数的输出,对前两个寄存器做在标准正交基|0〉,|1〉,…,|r-1〉上的量子Fourier变换UF,产生一个状态叠合2.做量子黑盒变换,并行计算gaxba=0∑r-1r∑r-11再对第3个寄存器进行观测,可以得到一个元素gt,其中0tr-1,由量子坍缩原理及gaxb=ga(gs)b=ga+sb,可知前两个寄存器坍缩后的量子叠加态中的态|a〉|b〉必满足gaxb=gt,即a+sb≡tmodr,又由于0ar-1,因此,对于给定的t、s、b,存在唯一的k使得a=t-sb+kr,故观测后所得的量子叠加态等价于13.对前两个寄存器分别做在标准正交基|0〉,|1〉,…,|N-1〉上的量子Fourier变换,可以得到槡r∑r-11b=0其中ωr=e2πi/r;|t-sb+kr〉|b〉4.对前两个寄存器进行观测,得到k,b,则k,b满足b≡skmodr,当gcd(k,r)=1时,算法输出s=bk-1modr,否则输出失败.以下首先分析算法的正确性.由于ωrr=1,故∑r-1槡rr∑r-1b=0因此由此可知前两个寄存器中不满足b≡skmodr的量子态|k〉|b〉的几率幅为0,亦即经过步3之后,前两个寄存器保留下的量子态|k〉|b〉均满足b≡skmodr.为了进一步说明算法的正确性,下面给出一个实例.设N=129,r=7,g=4,x=127,则算法步2完成并行计算所得到的量子叠加态为易得gaxbmod129与a、b之间的关系,如表1所示.a011274121169764141211697641127216976411274121364112741211697412741211697641512116976411274697641127412116Page4假设在步2观测到的结果为4,则所剩下的叠加态为1槡7|6〉|4〉+|2〉|5〉+|5〉|6〉).因此,步3所得的量子叠加态为槡77∑617+ω2k+5bω6k+4bA=1故量子态|k〉|b〉的几率幅为当4k+b≡2b≡3k+3b≡6k+4b≡2k+5b≡5k+6b≡kmod7,即b≡4kmod7时,A=17;槡7ωk当4k+b≡/kmod7,即b≡/4kmod7时,k,4k+b,2b,3k+3b,6k+4b,2k+5b,5k+6b在模7下两两互不相等(如果4k+b≡2bmod7,则b≡4kmod7,矛盾,同理可证其它情况).又设k=7l1+q1,4k+b=7l2+q2,2b=7l3+q3,3k+3b=7l4+q4,6k+4b=7l5+q5,2k+5b=7l6+q6,5k+6b=7l7+q7,其中li和qi均为整数且0qi6(i=1,2,…,7),则{q1,q2,q3,q4,q5,q6,q7}={0,1,2,3,4,5,6},A=1槡77可见,当|k〉|b〉=|0〉|0〉,|1〉|4〉,|2〉|1〉,|3〉|5〉,|4〉|2〉,|5〉|6〉,|6〉|3〉时,当|k〉|b〉≠|0〉|0〉,|1〉|4〉,|2〉|1〉,|3〉|5〉,|4〉|2〉,|5〉|6〉,|6〉|3〉时,因此,只能观察到|0〉|0〉,|1〉|4〉,|2〉|1〉,|3〉|5〉,|4〉|2〉,|5〉|6〉,|6〉|3〉,假设观察到|3〉|5〉,由5≡3smod7,可解得s=4.其次,分析新算法的成功概率.经过步3变换之后,所得量子叠加态中的每个槡rr∑r-1态|k〉|b〉被观测到的概率为P1=1而在步4观测到的k,b有r种可能取值,但gcd(k,r)=1只有φ(r)种可能取值,因此步4能够正确输出s=bk-1modr的概率为亦即算法的成功概率为φ(r)由上面的分析可知,元素的阶决定算法的成功概率,特别地,当r为素数时,算法的成功概率为(r-1)/r,亦即r越大,算法的成功概率越接近于1.从新算法的步骤可知,算法需要4次量子Fourier变换和一次模幂运算,与Nielsen算法相比,成功概率一样,但新算法不需要做函数|f(x1,x2)〉的量子Fourier变换的反演变换,亦即新算法更为简单.与Jozsa算法相比,一是算法的研究对象不同,前者是针对环上离散对数问题,后者是针对素域上离散对数问题;二是新算法刻画了r与算法成功率的关系,当r为素数时,算法的成功概率达到最大,接近于1.3.3算法性能分析新算法的核心是量子Fourier变换能将量子态之间的隐含关系变成相位因子.文献[10]指出量子Fourier变换是一个酉变换,满足量子计算算法所要求的可逆条件,在新算法步2中所使用的并行计算同样也是一个可逆计算.就算法本身所使用的变换而言,该算法是正确的,在量子计算机可以得到有效的实现.在新的离散对数量子计算算法中,前3步是在量子计算机上执行的,最后一步是在经典计算机上执行的.由于最后一步可在经典计算机上以多项式时间得到实现,在资源消耗上可以忽略,因此新算法的资源消耗主要在前3步上.前3步中使用的基本部件主要有模幂运算和量子Fourier变换,它们所需的基本量子门数在文献[10]中做了详细的分析,基于这些研究结果,我们可以给出新算法的资源消耗分析.新的离散对数量子计算算法初始化|0〉态是m=[logr]+1量子比特的,执行1个Hadmard变换需要O(m)规模的基本量子门[10],实现1个量子Fourier变换需要O(m2)规模的基本量子门,因此,新算法中4个量子Fourier变换仍然需要O(m2)规模的基本量子门.对于模幂运算,由于加法运算和进位运算需要3L个基本量子门(L=[logN]+1),每个模乘运算需要L个长为L的加法运算,利用二进制表示法计算模幂运算需要2L步模乘运算,所以模幂运算所需要的基本量子门数的规模为O(L3)①,①FastversionsofShor’squantumfactoringalgorithmPage5新算法中只需要1次模幂运算,亦即只需要O(L3)规模的基本量子门,因此新算法所需基本量子门的规模为O(L3).4小结本文通过多次量子Fourier变换和变量代换,提出了一个ZN上离散对数量子计算算法,刻画了元素的阶r与算法成功概率的关系,算法的计算复杂性仍是多项式时间的,算法运行所需的基本量子门数的规模为O(L3).
