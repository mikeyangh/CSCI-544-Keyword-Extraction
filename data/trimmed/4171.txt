Page1基于忆阻神经网络PID控制器设计夏思为1)段书凯1)王丽丹1)胡小方2)1)(西南大学物理科学与技术学院电子信息工程学院重庆400715)2)(香港城市大学机械与生物医药工程系香港999077)摘要忆阻器是一种阻值变化依赖于通过它的电荷量或磁通量的新型电子器件,在非易失性存储器和人工神经网络等应用中具有独特优势.智能PID控制器在现代控制领域中占据重要地位.文中在研究传统单神经元和神经网络PID控制器的基础上,引入具有类似于人脑突触行为的忆阻器实现新型的权值更新机制,提出了忆阻单神经元和神经网络PID控制器模型.在理论推导的基础上,进行了编程仿真和Simulink建模.实验结果验证了提出方案的有效性.该方案可望进一步推动智能PID控制器的发展,促进神经网络PID控制器的硬件实现.关键词忆阻器;单神经元PID控制器;神经网络PID控制器;MATLAB仿真;智能控制1引言1971年,Chua[1]基于电路理论的完备性,提出了忆阻器的概念,指出它具有不同于电阻、电容和电感的独特性能,称之为第4种基本电路元件.2008年,惠普实验室的研究人员宣布他们实现了忆阻器的电子器件,并公布了其物理结构,验证了忆阻器的存在[2-3],立即引起了人们对忆阻器的极大兴趣.忆阻器是一种新型的非线性两端电路元件,其天然的记忆功能、连续输入输出特性和纳米级尺寸有望改善整个电子电路理论和应用.研究者们对忆阻器的数学理论[4]和器件模型等[5-6]进行日益深入的研究,在基于忆阻器的存储系统[7-9]、神经网络[10]、电子电路设计等方面取得了重大的进展.现代的工业控制系统中,应用最广泛的调节器控制规律为比例、积分、微分控制,即PID控制[11],其主要适用于线性时不变系统.控制器以输出反馈与预设定值之差作为输入,使被控对象输出最终趋向设定值.PID控制器结构简单、稳定性好、工作可靠,但其参数不易调节[12],一旦确定,就不能再改变,且不能有效控制复杂系统.研究者将智能控制方法与PID相融合,提出了智能PID控制器,其中神经网络PID,利用其任意非线性映射[13]和网络学习[14]能力,不仅使系统具有较强的鲁棒性,而且也能对复杂时变系统跟踪控制.然而,因其系统复杂,不易大规模集成实现,进一步的发展受到了限制.也有研究者将忆阻器与PID结合[15],但只是从理论上推导了忆阻PID(M-PID)的相关公式,用正弦和脉冲信号作为输入,简单地研究了控制器的动态输出.本文则在深入研究忆阻器特性、单神经元和神经网络PID控制的工作机制基础上,将忆阻器运用于神经网络PID控制器,探讨智能PID控制器的新方法.提出的忆阻PID(M-PID)控制器不仅能应用于复杂的时变系统,而且对被控对象数学模型难确定的系统也可以进行有效控制,使其在实际工业控制领域拥有广泛的应用前景.2神经网络PID控制器2.1PID控制器PID控制器结构如图1所示,其中u(t)为PID的输出,e(t)为误差信号,KP、KI、KD分别为比例、积分、微分系数,KP的作用在于加快系统的响应速度,提高系统调节精度,KP越大,响应速度越快,调节精度越高,但过大将产生超调,甚至导致系统不稳定.KI的作用在于消除系统稳态误差,KI越大,静差消除越快,但过大会产生积分饱和而引起较大的超调.KD影响系统的动态特性,KD越大,越能抑制偏差变化,但过大会延长调节时间,降低抗干扰能力.连续型PID控制器的标准输出形式为离散型PID控制器的标准输出形式为u(k)=KPe(k)+KI∑e(k)+KD[e(k)-e(k-1)]式中,u(k)为第k次采样时控制器的输出;k为采样序号,k=0,1,…;e(k)为第k次采样时的偏差值;e(k-1)为第(k-1)次采样时的偏差值.为了便于编程,常采用增量式的输出形式:Δu(k)=KP(e(k)-e(k-1))+KIe(k)+2.2单神经元PID控制器单神经元PID控制器是单神经元与传统PID相结合而产生的一种智能控制方法,单神经元具有自适应、自学习、并行处理及较强的容错能力,而且结构简单易于计算,可以在一定程度上解决传统PID不易在线实时调整和对复杂慢时变系统不能有效控制的缺点.单神经元自适应PID控制器如图2所示.神经元输出为其中,k为神经元的比例系数;wi、xi、u分别为权系数、神经元输入和输出;yout为系统输出.采用Hebb学习规则,神经元权值更新表达式为Page3烄烅烆ηP、ηI、ηD分别为3个权值的学习速率,且系统对权值进行了归一化处理.权值的更新是神经元不断学习的过程,新的权值是旧权值与一个学习变化量的和,当输出与设定值相等时,学习过程结束.2.3神经网络PID控制器神经元是构成神经网络的基本单位,神经网络是由多个神经元通过突触连接而成.神经网络PID控制器利用网络的学习能力和任意非线性映射能力,通过对样本数据对的训练,实现对复杂系统的控制,其结构如图3所示.神经网络通过不断的学习来改变KP、KI和KD这3个参数,使整个系统的输出最终达到预期值.图中ANN是BP神经网络结构,BP学习算法由正向传播和反向传播组成,在正向传播中,输入信号从输入层经隐含层传向输出层,若输出层得到期望的输出,学习结束;否则,转至反向传播.反向传播算法是将误差信号按照原链接路反向计算由梯度下降法调整各层神经元的权值和阈值,使误差信号最小.这两步相继反复进行,直到误差满足要求.其结构如图4所示.Xi为网络输入,j、i、k分别为网络的输入层、隐含层、输出层,KP、KI、KD为系统输出,即PID的3个控制参数.BP神经网络PID的学习算法在文献[16-18]中已有详细介绍,权值表达式为wijt()+1=wij(t)+Δwij=wij(t)-ηE(t)由BP算法得出输出层的权值更新表达式:Δw(3)其中,η为学习速率;δ(3)u(k)k(k)g(net(3)o(3)PID输出.隐含层权值更新表达式为Δw(2)其中,δ(2)入层输出.从中可以看出:神经网络PID权值更新算法虽已成熟,但其算法推理过程较为复杂,而且网络层数愈多,算法就愈复杂,不易用硬件实现.为了克服上述缺点,需将忆阻器引入到神经网络PID中,忆阻器作为电子突触,不仅可以简化权值更新算法,而且还有利于整个网络的硬件实现.3忆阻器忆阻器是一种具有记忆功能的非线性电子器件,其阻值受控作用在其两端的电源强度和作用时间,断电后,能保持断电时刻的电阻值不变.惠普忆阻器是由两层二氧化钛薄膜夹在两个铂(pt)电极之间组成的,其中一层二氧化钛薄膜中含有氧空缺,称为掺杂层,其阻值较小,另外一层是纯的二氧化钛薄膜,称为非掺杂层,其阻值较大.当有电源作用在忆阻器两端时,其两层间的分界面就会移动,阻值发生变化.忆阻器的总阻值等于两部分阻值的和[6]:其中,D为两层二氧化钛总厚度;w为掺杂层厚度;Ron和Roff为别为w=D和w=0时的极限阻值.令x=wD∈(0,1),则有掺杂层厚度的变化率为Page4把式(12)对时间t积分代入式(10)中可得其中,k=(Ron-Roff)μvRonD2;uv为离子移动速率;R(0)为忆阻器初值.因为,0<w<D,所以,Roff-R(0)c2=Ron-R(0)k<q(t)<Ron-R(0)Rmem=即为电荷控制忆阻器模型.实际的忆阻器是一种纳米器件,当给其施加一个小的电压源,就会产生巨大电场,使离子漂移表现出非线性,在忆阻器的边界附近表现更明显.为了模拟这种非线性离子漂移,需要在式(12)右边乘上一个窗函数[7].窗函数主要有两种:图5忆阻器的特性曲线4忆阻神经网络PID控制器4.1忆阻器神经突触忆阻器的阻值随着磁通或电荷的变化而变化,其纳米尺寸、信息存储能力和掉电后信息的非易失性非常适合作为神经网络中的电子突触,实现忆阻神经网络.已知神经网络权值更新公式为其中ηΔpij为每一次学习后权值的变化量.而电荷控制忆阻器的阻值表达式为离散化后:Rmem(t+1)=R(t)+kq(Δt),c1q(t)<c2(19)Joglekar窗函数:Biolek窗函数:其中,P为正整数,为函数的可控参数;sgn(·)为符号函数.Joglekar窗函数可以模拟未达到边界时的线性离子漂移,当离子到达边界后则状态不再改变.Biolek窗函数可以有效地解决边界效应,但是其不满足边界连续性.给忆阻器施加一个正弦电压,可观察其电压电流与磁通电荷关系曲线如图5所示,图5(a)是正弦激励作用忆阻器后的电压与电流关系图,是典型的滞回曲线,各项参数为R(0)=7204Ω,Ron=40Ω,Roff=8000Ω,v=1.2sin(2πt),D=10nm,μv=10-14m2s-1V-1,窗函数为f(x)=1-(2x-1)2P,P=10,图5(b)为磁通与电量关系曲线,磁通量增加,电荷量增加,反之降低.给忆阻器一个大小为v,时间为Δt的激励脉冲,则通过器件的电荷量为由式(17)、(18)可得将忆阻器作为电子突触,x表示忆阻器突触权值,Δpij为施加在忆阻器两端的电压源(或电流源),则忆阻器阻值发生变化,x也将改变.网络通过不断的学习,使x最终达到所需值,整个学习过程结束,忆阻器记录每一次权值的变化量.由式(11)可得:Page5由式(18)、(19)可得忆阻单神经元权值更新公式:x(t+1)=x(t)+4.2忆阻单神经元PID控制器忆阻单神经元PID结构如图6所示.图7忆阻神经网络PID的Simulink模型图7中最左端的是输入信号源,与输出反馈信号比较相减后,将误差信号(e(k)),误差的一阶导数(e(k-1)),误差的二阶导数(e(k-2))输入给忆阻单神经元PID控制器(sfunction),控制器输出直接作用被控对象(plant),使整个系统最终达到稳定状态.4.3忆阻神经网络PID控制器互连接构成的,其权值变化公式为xij(t+1)=xij(t)+忆阻神经网络是由多个神经元通过忆阻突触相这里选用的忆阻神经网络是一个四输入、三输出的网络,其中,隐含层含有5个神经元,输入量分别为误差、实际输出、理想输出和一个激励为1的电压源,输出值为PID的3个参数KP、KI、KD.其结构图如图8所示.图8中主要包括经典的PID控制回路和忆阻神经网络的在线调节系统两部分,上半部分为忆阻图9忆阻神经网络PID的Simulink模型图6中M为忆阻器突触,输入值与忆阻权值相乘,经神经元求和与激活函数处理后,作用被控对象.被控对象输出再反馈给输入,使忆阻权值改变,通过忆阻权值的不断调整,使系统输出最终达到预设定值.同时,也建立了上述系统的Simulink模型,该模型主要包括:输入信号源、延时模块、忆阻单神经元PID模块和被控对象模块等.由于Simulink库中没有忆阻单神经元PID的在线学习模型,这里用Simulink中的s函数模块进行了构造,其系统模型如图7所示.神经网络的在线调整部分,网络通过调整后,将合适的KP、KI、KD这3个参数传送给PID控制器.下半部分为经典PID控制回路,由误差和误差的导数作为输入,控制器输出直接作用被控对象,使被控对象输出达到预设定值.忆阻神经网络PID的Simulink模型主要包括:输入模块、控制模块、被控对象模块等部分,输入信号为阶跃函数,其中控制对象的传递函数为H(s)=720s2+720s+1,具体的模型如图9所示.Page6图9中左端为输入信号,Ann_controller是一个控制模型的封装,由一个MATLABFcn组成的子系统构成.控制模型的r(k)接输入信号,y(k)接输出反馈信号,u(k)为输出信号,K为忆阻神经网图10控制模块的子系统结构图图10中左端口1(r(k))与左端口2(y(k))为系统输入,相减后将误差信号和误差的导数信号输入给控制器,右端口1(u(k))与右端口2(K)为系统输出,延时模块5和6分别将神经网络的各个权值反馈给控制模块MATLABFcn.MATLABFcn是Simulink中的模块,可以根据用户的要求来构建Simulink模块,本次仿真中,其描述了忆阻神经网络PID控制器的功能,构建了其在线学习的Simulink模型.5计算机仿真5.1MATLAB仿真对忆阻单神经元使用Hebb学习算法进行仿真实验.其中控制信号为xin=0.5sin(4πt),神经元的比例系数k=0.12,初始权值WKP=0.1,WKI=0.1,WKD=0.1.系统的抽样时间间隔ts=0.001s,激励作用时间t=0.2s,被控对象的模型:y(k)=0.368y(k-1)+0.264y(k-2)+u(k-1)+0.632u(k-2).忆阻器的初始参数分别为R(0)=7204Ω,Ron=40Ω,Roff=8000Ω,D=10nm,μv=10-14m2s-1V-1,仿真结果如图11与图12所示.图11中,(a)与(b)两图显示了控制信号与输出信络PID控制器的KP、KI、KD输出,u(k)输出直接作用被控对象.忆阻神经网络PID控制器封装于Ann_controller模型中,Ann_controller控制器的子系统如图10所示.号的变化,两信号基本一致,显示了控制器良好的控制效果.(c)与(d)两图给出了神经元输出和误差的变化,误差变化始终保持在一个较小的范围内,说明了仿真结果的准确性.图12中,(a)图给出了突触权值变化曲线,3个子图分别对应KP、KI、KD3个参数的变化.(b)图给出了忆阻器阻值的变化曲线,3个子图分别为KP、KI、KD所对应忆阻器的阻值变化.所有仿真结果验证了忆阻单神经元PID控制方案的有效性.5.07对于忆阻神经网络,采用BP算法对系统进行仿真.被控对象的模型的传递函数为G(s)=784s2+56s+1e-10s,控制信号为rink=1,系统的抽样时间间隔ts=10s,惯性系数α=0.05,学习速率η=0.5,各个神经元之间的连接权值是在(-1,1)之间的随机数.忆阻器的初始状态为R(0)=7204Ω,Ron=40Ω,Roff=8000Ω,D=10nm,μv=10-14m2s-1V-1,激励作用时间为0.2s,仿真结果如图13所示.图13中,(a)图给出了忆阻神经网络PID对被控对象的有效控制图,大约第2000s时,系统输出与理想输出相等,达到了调控效果,误差的变化成减幅振荡逐渐趋向于零,使整个系统最终达到稳定状态.(b)图中PID输出最终趋向于稳定值,在时间上和误差变化同步,显示了整个系统控制的精确性和稳Page7定性.(c)图给出了忆阻神经网络的输出变化,显示了网络的自适应学习能力,使整个系统有较强的自适应性和鲁棒性.(d)图给出了隐含层的第一个神经图11忆阻单神经元PID仿真结果图12忆阻权值与阻值仿真结果5.2Simulink仿真忆阻单神经元Simulink模型与MATLAB仿真的各参数相同,其仿真结果如图14所示.仿真结果表明:系统误差主要出现在信号变化时刻,与系统本身特性有关.两次仿真结果显示了忆元与输出层之间的忆阻器的阻值的变化,忆阻器作为电子突触成功地记录了每一次权值的变化,验证了此方案的正确性.阻单神经元PID控制的正确性,系统的输出和控制信号基本一致,达到了调控的预期效果.忆阻神经网络PID的Simulink模型仿真结果如图15所示.Page8图13忆阻神经网络PID仿真结果图14忆阻单神经元PID的Simulink仿真结果Page9图15忆阻神经网络PID的Simulink仿真结果图15中显示被控对象的输出在控制信号的上下波动,波动幅度逐渐减小,最终趋向稳定,说明忆阻神经网络PID良好的控制效果和能力,忆阻神经网络输出的不断变化显示了其在线学习的功能,对被控对象数学模型未知的系统也可以进行有效的控制.6结论本文推导了忆阻神经元及神经网络PID控制器的突触权值更新算法,构建了控制系统的Simu-link模型,进行了编程和Simulink模型仿真.一系列的仿真结果,验证了方案的有效性和正确性.提出的方案可为忆阻智能PID控制器的实现提供理论和实验依据,在权值的更新上,直接把每一次权值的更新值都自动存储在忆阻器中.在硬件的实现方面,纳米忆阻器作为突触,可以大大简化电路,增加网络的连接数量并提高其连接密度.具有忆阻器突触的神经网络更易于VLSI实现,基于该神经网络的PID控制器有望实现该类控制由理论到实际的重大转换.忆阻器的引入简化了网络权值更新算法,但其非线性并不影响整个控制系统的其它性能.同时,掉电后非易失性可使网络的能耗大大减小,为实现新型智能PID控制器奠定了良好的基础.此外,忆阻神经网络有望用于智能信息处理,物联网等诸多领域.
