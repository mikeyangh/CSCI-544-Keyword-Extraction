Page1物联网环境下UC安全的组证明RFID协议张忠徐秋亮(山东大学计算机科学与技术学院济南250061)摘要物联网的安全和隐私保护问题是制约其进一步发展的关键性问题,如何设计一个安全、高效的组证明RFID协议是物联网安全需要重点研究的一个问题.首先,文中对物联网环境下组证明RFID协议的交互模型和攻击模型做了分析和描述.然后,在通用可组合安全框架下,形式化定义了理想功能FVS和RFID组证明理想功能FGP.最后,在FVS-混合模型下,设计了组证明RFID协议πGP,并证明对于任意的攻击者而言,协议πGP能安全实现理想功能FGP.根据组合定理表明新的组证明RFID协议具有通用可组合安全性.关键词物联网;RFID;组证明;通用可组合协议1引言物联网(InternetofThings,IOT)[1]通过射频识别(RFID)、红外感应器、全球定位系统(GPS)、激光扫描器等信息传感设备,按约定的协议,把任何物品与互联网连接起来;在强大的运算平台支持下进行信息交换和通信,实现智能识别、定位、跟踪、监控和管理.作为一个传感器网络、移动通信网络和Page2这些成果都是基于独立应用系统假设建立的,是否满足物联网安全需求还需要重新审视.在实际应用中,物联网的末端物体常常具有明显的群组特性,例如一个大型超市中所有接入物联网的商品对外声称属于同一家超市,某家医院的一组医疗器械针对某个特定手术等等.这种群组性就要求我们设计的RFID安全协议具有能够处理群组通信的能力.Juels[11]最早对多标签扫描问题做了研究,利用两个标签互相签名的思想,提出了一个两标签共存证明的RFID协议(称为联合证明协议).Saito和Sakurai[12]指出Juels的协议对重放攻击是不安全的,并通过为每一个会话引入时间戳设计了基于时间戳的联合证明协议.但由于时间戳是可以预先猜测的,因此攻击者可以事先猜测多项式个时间戳,并让RFID标签进行签名,然后在下一个会话攻击中使用.为克服这种弱点,Piramuthu等人[13]将时间戳换成了随机数以抵抗这种重放攻击.但在2007年,Peris-Lopez等人[14]和Lin等人[15]指出这种基于随机数的组证明协议对多会话干扰攻击是不安全的.随后,Burmester等人[16]基于共享组ID的思想提出了3个组证明协议,其中第3个协议具有匿名性和前向安全性.在2009年,Huang等人[17]针对病人用药安全问题提出了一个支持低成本RFID标签的在线组证明协议,协议中使用CRC校验代替常规的消息认证码和Hash函数.同年,Chien等人[18]对Juels的联合证明协议进行了扩展,提出了基于树的联合证明协议,将后台的计算复杂度降低到了O(1).但近来,Peris-Lopez等人[19]对上面的协议做了安全性分析,并指出Burmester等人[16]的方案容易遭受假冒攻击,而Huang等人[17]和Chien等人[18]的方案对伪造攻击和隐私攻击是敏感的.Duc等人[20]基于(n,n)门限思想提出了一个组证明协议,但该协议的组证明结果随着群组规模的增大线性增长,不适宜于较大的群组,并且Duc等人[20]的协议需要一个时刻在线的验证方发起证明,这对于接入形式比较复杂的网络也是很难保证的.本文在物联网环境下系统地研究了组证明RFID协议,在第2节定义物联网环境下的组证明RFID协议交互模型、敌手攻击模型和安全性需求;第3节将给出组证明RFID协议的UC模型定义[21],随后在第4节构造一个轻量级协议;第5节给出方案的安全性证明及效率分析;第6节总结全文.2组证明RFID协议模型和安全性需求2.1物联网环境下组证明RFID协议的交互模型我们定义,在物联网环境下一个组证明RFID交互协议涉及3种实体:标签集合TS、读写器集合RS和信息处理集合VS.其中TS={Tij},i标示组号,Tij表示第i组中的第j个RFID标签;RS={Rk},为降低协议的复杂度,假定一组标签同时只和一个读写器进行交互,Rik表示和第i组标签Ti发生交互的读写器;信息处理集合VS负责处理由RS采集到的TS数据,包含信息认证中心、密钥管理中心、数据处理中心以及数据存储中心等,方便起见,我们把这类集合抽象成理想功能FVS,它的具体定义将在3.1节给出.初始化阶段由FVS为标签集合TS和读写器集合RS分别生成初始参数(BTij,kij)和(BRk,kk),其中BTij表示盲化后标签Tij的身份ID,kij是与Tij身份绑定的通信主密钥,BRk表示盲化后读写器Rk的身份ID,kk是与Rk身份绑定的通信主密钥.考虑到物联网环境的特异性,对普通的RFID协议模型进行了弱化,放宽了对RS以及RS和VS之间通信信道的安全假设,认为其都是不安全的.读写器Rik执行组证明协议前需要向FVS申请组证明读写资格,成功之后FVS会为Rik生成一个读写授权Vik.但这种授权申请是一次性的,不需要在每次交互中都去申请,除非需要变更为对另一组标签Tj进行操作.2.2物联网环境下组证明RFID协议的敌手攻击模型在组证明RFID交互协议中,敌手攻击的一个主要目的[22]是获得能够通过VS验证的组证明p,但被证明存在的标签Tij并没有真正参与协议或并非该组合法成员;另一个目的是获取参与方TS和RS的隐私信息,如身份标识ID、位置和组别等信息.敌手A的攻击渠道可以分为对信道的攻击和对参与实体的攻击.我们假设敌手A能够完全控制TS与RS之间以及RS与VS之间的通信信道,可以任意地读取、删除、篡改、延迟发送和重放信道中的任何消息,也可以在任何时候发起与任何实体的任意会话.基于UC框架[21],我们假定敌手A也可以在协议执行的任何时候攻陷参与方TS和RS中Page3的任意实体,对于攻陷后的实体,敌手A能够成功获取到它内部状态数据,但无法获得该实体的密钥(包括通信主密钥和授权密钥Vik).敌手攻击的方法主要有:重放攻击[13]、子集重放攻击[19]、多会话干扰攻击[14]、假冒攻击、伪造攻击和隐私攻击[19]等等.2.3物联网环境下组证明RFID协议的安全性需求强隐私保护.只有获得授权Vik的读写器Rik才能读取到标签组Ti的共存证明pi,并且在所有的交互中即便是所有消息都被恶意截获,攻击者依然无法获得Rik和Ti的任何身份信息以及组信息.不可追踪性.攻击者无法通过截获的组证明集合{pi}判断任意两个证明pi和pj的关系,即无法关联任意两个组证明的生成者是否属于同一组,也无法确定两个证明的生成者中是否包含同一成员.读写器匿名性.协议执行过程中,任意的攻击者和协议交互方Ti都无法获得读写器Rik的身份信息.标签匿名性.类似于读写器匿名性,攻击者和协议交互方Rik都无法获取到标签Ti的身份信息和组信息.授权认证.只有被授权的读写器Rk和合法的组成员标签Ti正确执行协议才能得到合法的组证明pi,而对于任意未被授权的读写器将无法得到有效的组证明.3组证明RFID协议的UC模型UC框架最初是由Canetti[21]提出的,它是一种基于模块化协议设计的思想.只要协议满足了UC安全,就能保证它与其它协议或是它自身的多个实例并行运行时的安全.物联网是个非常复杂而庞大的综合性系统,如果把协议运行的外部环境(包括静态环境和运行时环境)全都考虑周全是十分复杂和极为困难的,因此我们拟借助UC框架这个工具来搭建整个物联网环境下的协议族.3.1理想功能犉犞犛为便于描述和分析协议,我们将物联网平台上的信息处理服务抽象出来用理想功能FVS来描述,其主要功能是为每一个标签和读写器生成初始参数,处理读写器授权申请和验证组证明信息.(1)当收到指令(Init,Ti)时,FVS为标签组Ti中的每一个标签Tij生成一对初始参数(BTij,kij),其中BTij=H(Tij)表示盲化后标签Tij的身份ID,H()是一个安全的Hash函数,kij是一个随机数,用作Tij的通信主密钥.然后将(Tij,BTij,kij,Ti)进行序列化存储,并将(BTij,kij)、(BTij,Tij)分别安全地传送给Tij和请求者.(2)当收到指令(Init,R)时,FVS为集合RS中的每一个读写器Rk生成一对初始参数(BRk,kk),其中BRk=H(Rk)表示盲化后读写器Rk的身份ID,H()是一个安全的Hash函数,kk是一个随机数,用作Rk的通信主密钥.然后将(Rk,BRk,kk)进行序列化存储,并将(BRk,kk)、(BRk,Rk)分别安全地传送给Rk和请求者.(3)当收到指令(QRead,Ti)时,FVS会为Rik生成一个读写授权Vik,Vik为一个随机数.然后将(Rk,Ti,Vik)进行序列化存储,并将Vik安全地传送给Rk.(4)当收到指令(Valid,BRk,sR,pi,r,ri1,…,rin)时,FVS令r=r,ri=ri1ri2…rin,搜索记录(Rk,BRk,kk)和(Rk,Ti,Vik).如果有一条记录不存在,返回失败.否则取出对应的kk,Ti,Vik,并计算sR=MACkk(BRk,r,ri),如果sR≠sR,返回失败.否则搜索Ti组的所有成员标签信息,取出对应的Tij,BTij,kij.计算sij=MACkij(BRij,Ti,r,ri,rij),si=si1si2…sin,pi=MACVi返回失败.否则返回成功.3.2理想功能犉犌犘基于第2节中描述的交互模型和敌手攻击能力,我们定义物联网环境下RFID组证明协议的理想功能FGP.理想环境下攻击者S可以攻陷任意的标签Tij和读写器Rk并获得参与方的内部状态数据(不包括密钥信息).环境机Z确定所有实体的输入,获得他们的输出,并指导各参与实体(包括攻击者S)执行相应的操作.(1)当收到指令(Activate,sid)时,FGP通过向理想功能FVS发送指令(Init,Ti)和(Init,R)对标签组Ti和读写器Rk进行初始化,并存储返回结果(BTij,Tij)和(BRk,Rk),然后向FVS发送指令(QRead,Ti)为Rk申请授权.(2)当从Rk收到指令(Init,sid,BRk)时,FGP查找(BRk,Rk),确定读写器身份Rk,如果Rk已经被攻破,则忽略此消息.否则生成一个子会话标识ssid并记录(ssid,BRk,Rk),然后发送(ssid,BRk)给攻击者S.(3)当从Tij收到指令(Init,sid,BTij)时,FGP查找(BTij,Tij),确定标签身份Tij,如果Tij已经被攻破,则忽略此消息.否则生成一个子会话标识ssid并记录(ssid,BTij,Tij),然后发送(ssid,BTij)给攻Page4击者S.(4)当从攻击者S收到指令(Product,ssid,BRk)时,FGP生成随机数r并将其发送给Ti.(5)当从攻击者S收到指令(Product,ssid,BTij)时,如果存在记录(ssid,BRk,Rk),则FGP生成随机数rij并将其发送给Rk.(6)当从攻击者S收到指令(Proof,ssid,BTij,sij)时,如果Tij已经被攻破,FGP查找记录(ssid,BRk,Rk),并把sij发送给Rk.否则计算si=si1si2…sin并将其发送给Rk,其中sij=Hkij(BTij,Ti,r,ri,rij),ri=ri1ri2…rin.(7)当从攻击者S收到指令(Verify,sid,BRk,P)时,如果Rk已经被攻破,FGP把P发送给FVS.否则,删除记录(ssid,BRk,Rk)、(ssid,BTij,Tij)并发送BRk,sR,pi,r,ri1,…,rin给理想功能FVS,其中sR=Hkk(BRk,r,ri),pi=HVi3.3安全分析下面我们证明理想功能FGP和理想功能FVS满足2.3节中定义的安全性需求.(1)强隐私保护.在理想环境下,所有由理想功能FGP发送给攻击者S的信息里的BRk和BTij,都是由理想功能FVS返回的盲化后读写器Rk或标签Tij的身份.因此在整个交互过程中,S无法区分读写器或标签的身份和某个随机数.(2)不可追踪性.在理想环境下,攻击者S可以攻陷读写器Rk,因此他有可能获得多个组证明{pi},但由于每次组证明里的参数r,r1,…,rn都是由多个标签独立选择的随机数,因此S无法确定任意两个组证明的生成者是否为同一组,或是否包含同一成员.(3)读写器匿名性.证明与(1)类似.(4)标签匿名性.证明与(1)类似.(5)授权认证.在理想环境下,攻击者S无法通过理想功能FVS获得授权Vik,却可以通过理想功能FGP获得Ti的共同签名si=si1si2…sin.但由于无法获得Vik,故S得不到能够通过FVS验证的合法组证明pi.4物联网环境下UC安全的组证明RFID协议本节给出一个物联网环境下组证明RFID协议πGP,见图1.该协议在RFID标签集合{Tij,j=1,2,…,n}和读写器Rk上执行计算量很少的操作:Tij只需要生成m比特的随机数和计算一次带key的消息认证码MACk(·).其中m根据一定标准选取(例如按EPCC1G2标准,m取值为16);读写器端除了上述两种操作外,还需要执行按位异或操作.绝大多数计算量都由后端的FVS来完成,这是非常适合物联网体系架构及其基本特征的.方案πGP共分为4个阶段:初始化、授权、组证明生成和组证明验证.其中初始化过程只需在系统建立之初使用一次,但需要FVS、读写器Rk和标签组{Ti}在线状态下完成.FVS为每一个标签Tij和每一个读写器Rk生成并分发l比特的随机通信密钥.授权过程满足2.1节中定义的交互模型,授权申请在不变更权限的条件下只需要一次在线申请,不需要每次执行组证明都去交互申请.组证明生成过程完全是标签组Ti和读写器Rk两方的交互,适用于FVS不在线或是没有条件在线的情况.首先由读写器发起挑战,标签对挑战进行签名响应,读写器收集所有标签的签名承诺,然后生成自己的签名承诺.最后是组证明验证过程,由FVS集中验证读写器Rk和标签组Ti的合法性、Rk授权访问的合法性以及组证明的合法性.5安全性证明及效率分析5.1安全性证明通过在理想模型中构造一个理想敌手S,使得没有环境Z能够区分现实模型中的执行和理想模型中的执行,从而证明协议πGP实现了理想功能FGP,即协议πGP具有UC安全性.定理1.对于任意的攻击者A,在FVS-混合模型下,协议πGP安全地实现了理想功能FGP.证明.对于任意的攻击者A,可以构造一个仿真器S,S能够将A在FVS-混合模型下与真实协议πGP交互的行为模拟成理想环境下攻击者S对理想功能FGP交互的行为.也就是说,对于任意的环境图灵机Z而言,它与攻击者A和协议πGP以及攻击者S和理想功能FGP的交互都是不可区分的.(1)构建仿真器S.在理想环境下仿真一份真实环境下的攻击者A、读写器Rk和标签组Ti以及理想功能FVS的拷贝.当理想攻击者S被激活以后,将环境机Z发送来的消息m作为仿真的攻击者A的输入,协议πGP执行完成后的输出作为理想攻击者S的输入,并返回给Z,这样就好像所有真实环境下的参与方都和环境机Z直接相连一样.Page5图1物联网环境下组证明RFID协议πGP(2)理想攻击者S的具体操作.当S从FGP处收到(ssid,BRk)时,生成一个新的子会话ssid,然后将(ssid,BRk)发送给仿真的攻击者A.当S从FGP处收到(ssid,BTij)时,生成一个新的子会话ssid,然后将(ssid,BTij)发送给仿真的攻击者A.当仿真的标签Tij输出sij时,S获得sij并向理想功能FGP发送指令(Proof,ssid,BTij,sij).当仿真的读写器Rk输出BRk,sR,pi,r,ri1,…,rin时,S获得BRk,sR,pi,r,ri1,…,rin并向FGP发送指令(Verify,sid,BRk,BRk,sR,pi,r,ri1,…,rin).(3)仿真器的有效性.令CTI表示标签Tij被攻陷的事件,CRI表示读写器Rk被攻陷后进行非授权访问的事件,下面我们证明无论CTI和CRI发生与否,对于环境机Z而言,真实协议πGP和理想功能FGP都是不可区分的.当CTI发生时,环境机Z触发指令(Activate,sid)后,S从FGP处收到(ssid,BTij),然后把(ssid,BTij)发送给仿真的攻击者A.当仿真的读写器Rk输出BRk,sR,pi,r,ri1,…,rin时,S获得相同的输入给理想功能FGP.因此,对于环境机Z而言,仿真的协议πGP和理想功能FGP得到的是同样的输出,是不可区分的.同理得证,当CRI发生时,对于环境机Z而言,真实协议πGP和理想功能FGP也是不可区分的.下面证明:当CTI和CRI都没有发生时,对于环境机Z而言,真实协议πGP和理想功能FGP是不可区分的.假设存在一个环境机Z能以不可忽略的概率区分FVS-混合模型下攻击者A和协议πGP的交互以及理想环境下攻击者S和理想功能FGP的交互,那么对于构建的仿真器S也可以区分真实协议πGP和理想功能FGP.在理想环境下仿真一份真实环境下的攻击者A、读写器Rk和标签组Ti以及理想功能FVS的拷贝,仿真的协议πGP正常执行后,由Rk输出的pi=MACVi出pi=HVi一个算法A,使得A能够找到带key的消息认证码MACk(·)的一个碰撞,从而违背了MAC函数的无碰撞假设.所以假设不成立.定理得证.Page6根据UC框架的定义以及定理1,我们在第3节中已经证明了FGP可以满足所有的安全性需求.因此协议πGP也可以满足所有的安全性需求,即强隐私保护、不可追踪性、读写器匿名性、标签匿名性和授权认证.5.2效率分析下面将本文提出的协议和已有的最新类似成果进行比较(见表1和表2).由于系统初始化和授权部分属于一次性执行过程,故在下表中未做统计.其中F表示满足,D表示不满足,Pr表示调用随机数运算,Po表示按位异或运算,Ph表示Hash运算,表2类似协议性能比较方案T的运算量T的存储需求①R的运算量R的存储需求①DB运算量②组证明长度/Byte②文献[16]N(Pr+3Ph)4文献[17]2(Pr+Po)+Pc1文献[18]5Ph+2Po5文献[19]11Pr+9Po2文献[20]Ph新协议Pr+Ph注:①按照除ID外需要存储的额外参数数量统计;②基于1个读写器对N个标签的情况的统计.从表1和表2可以看出,新协议不仅满足了强隐私保护、不可追踪性、匿名性、授权认证和可扩展性等物联网环境下组证明RFID协议的安全需求,而且组证明长度是最小的.通过比较,在我们的方案中,RFID标签的计算复杂度和存储需求都比较小,而后端的验证压力相比其它方案略有增加,这是非常适合物联网的体系结构的.6结束语物联网是一个具有多网融合、海量数据采集和处理等特征的综合环境.作为接入层协议的重要组成部分,组证明RFID协议在设计时,必须要考虑物联网的特异性和安全需求.本文对物联网环境下组证明RFID协议的交互模型和攻击模型做了分析和描述,并在UC框架下,形式化定义了理想功能FVS和RFID组证明理想功能FGP.然后,设计了一个组证明RFID协议πGP,并证明对于任意的攻击者而言,协议πGP安全地实现了理想功能FGP.
