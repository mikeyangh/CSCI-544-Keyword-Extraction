Page1AdHoc网络中一种基于防策略支付模型的安全激励合作算法王博1)黄传河2)1)(国家计算机网络应急技术处理协调中心北京100029)2)(武汉大学计算机学院武汉430072)摘要AdHoc网络中节点之间的正常通信都是通过节点相互合作来进行中继转发.但是,AdHoc网络由于受到自身能量、可用带宽和计算能力的限制,节点往往表现出自私性,因此激励节点合作转发的积极性成为当前AdHoc网络的研究热点.该文基于算法机制设计中的思想,对AdHoc-VCG模型进行具体分析,指出其存在的问题,提出了一种防策略和防共谋攻击的支付模型,设计了一种包含路由建立和数据包转发过程的安全激励合作算法ICTP.最后,通过仿真实验来验证该算法的有效性,并与AdHoc-VCG、COMMIT和LMOCP算法进行了性能对比.仿真结果表明:ICTP算法较其它3种算法在性能上有了显著的改善.关键词AdHoc-VCG;防策略;激励合作;支付模型;共谋1引言节点既是终端又是路由器,这种双重功能决定了节点既要保证自身的正常通信需求,又要为网络的其它节点提供转发数据和寻找路由的服务,即需要所AdHoc网络不依赖于任何固定的基础设施,有节点的相互协作来实现.这种合作性也是现有诸Page2多路由协议设计的一个基本假设前提.随着当前研究的发展,AdHoc网络逐步由单一控制的军用领域,延伸到民用领域.那么由于节点受不同组织中实体的操作和控制,并且其自身能量和带宽有限,节点往往表现出不合作的自私行为[1].此外,仿真分析表明[2]:当具有自私行为的节点数目占全网总节点数的10%~40%时,网络的整体性能会严重地下降16%~32%.如何有效地加强节点间的合作,从而保障AdHoc网络的可用性及其整体性能,是AdHoc网络当前研究的热点之一.当前针对自私节点的一种新的解决思路是为节点转发数据提供补偿,并且使得补偿大于转发数据的代价,以激励节点参与数据转发过程.但是每个节点的私有信息转发价格(主要与传输功率和电池剩余电量有关)可能不同,自私节点为了获得超额收益(效用),可能会虚报自己的转发价格,这就要求我们必须采用某种机制迫使节点真实地报告自己的转发价格.于是,一些研究者开始探索利用博弈论中的机制设计方法[3]来进行解决.本文以算法机制设计思想作为研究出发点,对AdHoc-VCG支付模型进行分析,指出其存在的主要问题,提出了防策略和防共谋的增强支付模型,并采用密码学的方式将此模型运用到在网络层节点如何执行数据转发和路由的问题中,设计了一种安全可靠的激励合作算法:ICTP.该算法考虑了路由建立和和数据包转发两个阶段,来提高节点的合作积极性.最后,通过仿真实验来对其进行验证和分析,并与其它的经典算法进行了性能对比.仿真结果表明:ICTP算法在性能上较其他算法有显著的提高.本文第2节介绍相关工作;第3节给出机制设计原理和VCG机制的思想;第4节分析基于AdHoc-VCG支付模型中存在的问题,并提出一种新的支付模型;第5节详细介绍安全激励合作算法ICTP,并给出理论分析;第6节是仿真实验;最后第7节给出全文总结和未来的工作.2相关工作当前对AdHoc网络中激励合作问题的研究主要集中在基于博弈论思想来提高节点之间的合作性,减少自私节点产生的攻击.近年的相关研究进展如下:文献[4-17]考虑将存在自私行为的AdHoc网络归类于非合作博弈的研究领域,采用相应的博弈论知识来增强节点合作转发的积极性.Felegyhazi等人[4]提出了一种基于节点拓扑依赖关系的博弈分析模型,Altman等人[5]则在前者基础上进一步提出了一个调整转发概率的模型.此外,Srinivasan等人[6]还提出了GTFT(GenerousTit-For-Tat)模型,尝试以针锋相对的转发策略来平衡节点间的相互贡献;进一步Levin[7]提出了一种以拥塞信道手段来强制协作的思路.其中,Felegyhazi和Altman的模型均引入了对拓扑的依赖性,其均衡状态的结论唯有在满足特定条件时方可应用,而这要求节点必须了解全局拓扑结构.与前者不同,GTFT从节点与网络间而不是多个节点间博弈的角度分析,从而避免了上述依赖性,但它仅考虑了历史收益对节点决策的影响,而没有考虑其将来获利的期望.在Levin的工作中,尽管作者证明了纳什均衡的存在性,但却没有提出具体的合作增强机制.文献[8]对节点间转发数据包的过程进行建模,也证明了纳什均衡存在的条件,提出了对自私行为约束的惩罚措施.文献[9]认为到实际网络中物理层的信道干扰、冲突和碰撞,导致数据包的丢失,此种情况的发生也不能归结为由节点的“自私性”所致,导致该节点遭受无辜的惩罚.同理,文献[10]提出了一种DARWIN模型,避免可能出现善意节点被误认为“自私节点”所经受的惩罚,帮助该节点快速恢复到合作转发数据包的状态.该模型具有较强的鲁棒性,能够抵抗共谋攻击的影响.文献[11]提出一种在路由发现阶段建立的转发困境博弈模型,并通过邻居发现协议来发现参与博弈的节点数,网络中的节点通过混合策略中的概率转发策略,实现了网络的混合策略纳什均衡.文献[12]通过建立基于信任的演化博弈模型,激励自私节点动态地选择合适的转发策略,进一步分别通过决定式模型和随机模型,来预测和了解邻居节点的转发行为,同时,结合遗传算法来促使节点优先选择转发策略,并且在AODV协议上进行了实现和仿真.文献[13]针对自组网络节点的预期收益及其协作交互过程建立了一个重复博弈模型,提出了一个激励一致性条件,在此条件下,节点会迫于惩戒机制威慑而自愿采取合作策略;并分析了节点对将来利益的重视程度、机制参数和作弊检测效率对协作效果的影响.文献[14]总结了无线网络中因自私节点的存在而带来的一些关键问题,特别对含有自私节点的无线环境中基于非合作博弈理论的路由机制进行了分析和研究.文献[15]针对基于邻居节点中继和生成的路由请求包过程,提出了一种适用于按需Page3路由协议寻路阶段的自私行为检测和惩罚机制,对算法激励合作的有效性进行分析.文献[16]提出一种建立在路由发现阶段的转发困境博弈模型,并通过邻居发现协议来发现参与博弈的节点数,网络中的节点通过混合策略中的概率转发策略,实现了网络的混合策略纳什均衡.文献[17]首次将博弈论和信任模型综合考虑,来实现节点的合作性.通过博弈策略的演化和遗传算法的结合,达到最优合作策略的快速收敛.最后,该文在非合作博弈的背景下提出了一种分布式演化算法来快速选择最优的合作策略.文献[18]提出了一种满足激励兼容条件的有限时间信誉系统FITS来增强节点的合作性.该系统主要采用博弈论思想中的有限重复博弈和信誉估计模型来提高节点数据包转发概率,并通过详细的理论和实验进行论证.文献[19]针对AdHoc网络中相邻节点的合作转发过程建立无限重复合作转发博弈模型,结合该模型提出了激励节点之间合作的积极性条件,并给出了一种通用惩罚机制,对节点的不合作行为给予比较严厉的惩罚,使得节点从不合作行为中得到的收益由于被惩罚而抵消,确保节点恢复到合作状态,然后给出了该惩罚机制的实现框架.文献[20]提出了基于VCG支付模型的合作机制AdHoc-VCG.这种基于VCG的机制是从经济学上的经典拍卖模型VCG改进而来的,可以有效地解决自私节点为路径选择和数据转发带来的问题.AdHoc-VCG机制在转发数据包的过程中优先选择一条能耗最小的路径,激励该路径中的节点积极转发数据包,根据节点的真实报价信息,给予较高的补偿来弥补节点的合作转发代价,从而使得节点获得的效用最大(可以将此过程理解为二级密封价格拍卖活动),最后基于该模型实现了一种路由协议,通过证明,该协议具有防策略性,能够找到一条成本有效的路径.此外,文献[21]也基于VCG支付模型对网络中的恶意节点和自私节点进行分析,提出一种安全诚实路由协议,而文献[22]实现了一种LOTTO协议,通过该协议不仅也能选择一条成本最优的路径,并且能够大大降低路由建立过程中的开销至O(n2).其它相关研究如CORSAC[23]、TEAM[24]、COMMIT[25]和LMOCP[26]等,其大多基于VCG机制[3],而忽略了数据包在转发过程中的重复性.由中继者报价、发送者给予选定路由中中继者一定数量的超额红利来激励合作是其核心思想.为鼓励诚实报价,发送者经拍卖支付的总费用一般远高于实际所需的代价,这使得收支平衡问题进一步恶化.还有一类是利用密码学方式来增强激励合作的安全机制:文献[27]提出一种比较实用的激励合作系统PIS.该系统主要是在Sprite[28]模型的基础上进行改进,对每次会话产生的数据包收据大小进行压缩,减少整个系统的存储空间.此外采用签名技术来确保源节点和目的节点之间通信的完整性、真实性和不可抵赖性.文献[29]提出了一种安全高效的激励合作协议ESIP.该协议主要采用基于公钥密码(Hash链和签名等)和身份鉴别技术来实现,从而确保整个通信过程数据包转发的完整性、可用性和不可抵赖性.文献[30]也是在Sprite模型的基础上,通过采用轻量级的统计方法来辨别为了提高自身利益的欺骗节点和共谋节点的攻击行为,实现了一种基于有效的激励合作框架的欺骗监测系统.文献[31]主要围绕网络环境下数据包丢失攻击行为的发生可能性开展讨论,从节点自身理性情况下发生的自私攻击行为和由于非理性节点故意丢弃数据包的行为两个角度来考虑,提出了一种新的激励合作机制TRIPO.该机制对理性的自私节点采取基于微支付的方式来进行激励,而对非理性的恶意节点则采取信誉系统的思想来对节点的故意丢包行为进行监视,并通过实验验证了该机制的有效性.本文的研究主要是基于AdHoc-VCG机制,对该机制中的支付模型进行详细分析,指出其存在的主要问题,对其支付模型进行改进,提出一种防策略、防共谋的增强支付模型,对路由建立和数据包转发过程统一考虑,建立有效激励合作算法.此外,借鉴密码学的一些思想,进一步提高激励合作算法运行的安全性,加强整个通信过程中数据包转发的完整性、可用性和不可抵赖性.3算法机制设计预备知识本节仅给出机制设计中的基本知识以及机制设计中的典型应用:VCG机制,详细内容可参考文献[3].3.1算法机制设计原理定义1(机制).一个机制M=(O,P)包含了两个部分:结果规则函数O和支付函数P.当网络中需要通信的节点对(S,D)建立了一条h跳的路径,结果规则函数O映射了该路径上的中间节点向机制报告其整个类型向量犪=(a1,a2,…,ah)时的输出结果;而支付函数P则规定了每个中间节点i在Page4该类型ai下的支付Pay(S,i,犪).此外,每个节点i都有一个真实的类型ti,由于受自身实际情况的约束,可能表现出ti≠ai,即节点i不以真实的类型来报告给机制M,同时节点i也在该类型ai下有相应的估价函数Vi(O,狋).其中,狋=(t1,t2,…,th)为路径上h个中间节点的真实类型组成的向量.那么可以得出节点i以类型ai报告时的效用函数:Ui(O(犪),狋)=Vi(O(犪),狋)+Pay(S,i,犪)(1)定义2(机制实现).对于机制M=(O,P),如果对于(a1,a2,…,ah)∈M,则存在P(a1,a2,…,ah)=F(犪),可以说机制M实现了社会选择函数F(犪),其中a1,a2,…,ah是由机制M导出的博弈均衡解.定义3(占优解).由于各个节点都是理性的,在不管其它h-1个节点选择的策略犪-i情况下,其中犪-i=(a1,a2,…,ai-1,ai+1,…,ah),节点i在选择ai时其效用函数能够达到最大,那么节点i选择的策略ai是占优策略,也即存在占优解.定义4(防策略性).如果每个节点的类型都是策略空间的一部分,每个节点通过报告其真实类型来最大化它们的效用函数,且不受其它节点的类型影响,则该机制实现了防策略性.如果机制M=(O,P)满足以下3个具体条件,可以说机制M具有防策略性:(2)节点理性防策略性机制保证各个节点都自愿参加.每个节点都可以得到一个非负的效用函数值.即对每个节点i满足:Vi(O(犪iti),狋)+Pay(S,i,犪iti)0(3)(3)多项式时间可计算性防策略性机制需要保证所有的结果规则函数O和支付函数P的计算都满足多项式时间.3.2VCG机制思想算法机制设计中典型的应用就是VCG机制.该机制由Vickrey[32]、Clarke[33]和Groves[34]提出.VCG机制主要解决的问题是结合各个节点给出的估价函数Vi(O,狋),来最大化社会选择函数g(O,狋):足激励兼容性,即每个节点i需要满足:(1)激励兼容性对于一个机制M具有防策略性,支付函数要满Vi(O(犪iti),狋)+Pay(S,i,犪iti)其中,犪|iti=(a1,a2,…,ai-1,ti,ai+1,…,ah).g(O,狋)=∑i在经济学领域中称为该机制具有功利性.定义5(VCG机制).一个机制M=(O(狋),P(狋))被认为是VCG机制,需要满足的条件如下:(1)当各个节点(如节点i)都以其真实的类型ti向机制M报告时,整个机制得到的输出结果O=O(狋)可以最大化g(O,狋).其中,g(O,狋)=∑i(2)每个节点i可以获得的支付Pay(S,i,狋)如下:Pay(S,i,狋)=∑j≠i(4)在需要建立通信的(S,D)节点对中,一般情其中,t-i=(t1,t2,…,ti-1,ti+1,…,th),Hi为t-i的任意函数.Groves在文献[34]中已经证明VCG机制具有防策略性,Green和Laffont在文献[38]中指出,当在给出适当的假设条件下,VCG机制在很多功利性的问题中表现出防策略性.本文的思想就是基于VCG机制和文献[20]中提出的AdHoc-VCG机制,为了激励网络的节点积极主动地参与网络中的各项工作,要求各个节点将其真实的私有类型信息(例如:节点成本或无线链路成本)报告给需要发生数据包的源节点,源节点根据网络的实际情况,确定各个节点的支付费用,从而确保它们自身效用的最大化,实现整个支付模式的防策略性,达到激励自私节点进行合作的目的.4模型建立4.1模型假设件进行假设:为了便于形式化分析和说明,对本文的模型条(1)网络是一个有向图(或双向连通图),用加权图G=(V,E)来表示AdHoc网络,其中V为网络的非空节点集合,E为连接节点对的通信链路集合(相邻节点都在彼此的通信范围之内),|V|和|E|分别表示该网络中节点和链路的数目.(2)网络中各个节点都是理性的,都很自愿地参与到VCG机制中来,但都以追求其自身的效用Ui为最大化的目的.(3)由源节点S来为网络中的节点支付转发费用,并且在建立路由之前,预先设置一个最大的支付费用阈值ms.Page5况下,目的节点D都是确定的、可信的、不存在攻击行为,并且其具有较强的存储能力和计算能力.(5)网络中的节点i在转发数据包的过程中,可能由于消耗自身能量、CPU计算能力、带宽资源,产生一定的转发成本ci,并且,只有该节点自己获知其私有类型成本信息.由于受到自私利益的驱动,节点i可能以成本信息di向源节点报告,一般情况下,di≠ci.(6)网络中的链路状态比较良好,不存在受物理信道干扰、冲突的影响情况,在转发过程中不考虑数据包丢失重传的情况,避免节点过多地增加转发成本.(7)在下次网络拓扑结构变化之前,整个网络的状态都比较稳定,基本上避免了各个节点的转发成本受节点移动和拓扑结构变化的影响.虑,此模型也可以延伸到多数据包转发的情况.4.2AdHoc-VCG支付模型假如节点对(S,D)需要建立通信,通信过程中需要经历若干h个中间节点.为了激励这h个中间节点的合作转发积极性,源节点S需要支付一定的费用来补偿中间节点转发数据包所消耗的成本,而各个节点需要获得的具体支付情况,则通过各个节点i向源节点S报告其对应的私有类型成本信息di来计算.这h个中间节点所报告的类型信息,可以组合成一个类型向量犱:犱=(d1,d2,…,dh).通过此支付思想,源节点S可以选择一条成本最小的路径LCP(S,D,犱)来转发数据包.具体的支付模型如下:Pay(S,i,犱)=(8)本模型的建立是以单个数据包的转发来考0,iLCP(S,D,犱)烄烅烆其中,LCP-i(S,D,犱)表示从S~D的所有路径中不包含中间节点i的最小成本路径,而LCP-i(S,D,犱)为对应的路径成本值.当节点i在LCP(S,D,犱)中,其获得源节点S给予的支付费用为Pay(S,i,犱)=LCP-i(S,D,犱)-LCP(S,D,犱)+di;而其它不在LCP(S,D,犱)中的节点获得的支付费用为0.该AdHoc-VCG支付模型是VCG机制在AdHoc网络中的典型应用.当节点i向源节点S报告其真实类型信息ci时,即di=ci,则节点i获得的效用Ui(犱)最大:并且保证节点i的效用值是非负的:Ui(犱)0.源节点S在实际的支付过程中,所需要支付的总费用为∑i∈LCP,i(S,D)Pay(S,i,D),而源节点S获得的效用为Us=ms-∑i∈LCP,i(S,D)Pay(S,i,D).此外,源节点S能够建立路由的条件Us0.4.3问题描述进一步对上节的AdHoc-VCG支付模型进行分析,发现AdHoc-VCG支付模型存在以下问题:(1)AdHoc-VCG模型不具有防策略性.文献[25]中已经指出AdHoc-VCG模型不具有防策略性,现举例分析和说明.如图1所示,假设源节点S可以提供的最大支付为100,S到D的最小成本路径为LCP,对应的LCP={1,5,6},通过AdHoc-VCG支付模型计算,得出LCP中各个节点的所获支付情况(利用式(5)):节点1的所获支付情况Pay(S,1,犱):Pay(S,1,犱)=35-26+5=14;节点5的所获支付情况Pay(S,5,犱):Pay(S,5,犱)=35-26+20=29;节点6的所获支付情况Pay(S,6,犱):Pay(S,6,犱)=35-26+1=10.同时,这3个节点对应的效用情况(利用式(6)):节点1的效用U1(犱)为U1(犱)=14-5=9;节点5的效用U5(犱)为U5(犱)=29-20=9;节点6的效用U6(犱)为U6(犱)=10-1=9.而当节点5虚报其成本类型信息为22时,LCP中各个节点(1,5,6)的支付情况需要重新计算:Pay(S,1,犱)=35-28+5=12;Pay(S,5,犱)=35-28+22=29;Pay(S,6,犱)=35-28+1=8.对应的效用也相应更新值为U1(犱)=12-5=9;U5(犱)=29-20=9;U6(犱)=8-1=7.通过对比发现:当节点5虚报信息后,其自身所获的支付费用仍然保持为29,而节点1和6的支付分别更新为12和8,由于节点5的虚报行为,即使节点1和6仍以真实类型信息报告,则其分别对应Page6的效用值为7(7)也达不到最大值9(9).因此,AdHoc-VCG模型不具有防策略性.(2)AdHoc-VCG模型存在过度支付问题.结合图1的示例所示,当节点5虚假报告其成本类型信息为10时,则LCP中所有节点(1,5,6)所获支付情况可以更新如下:对应的效用情况为LCP中的总支付为:24+29+20=73.而节点5真实报告成本信息为20时,LCP中的总支付为53.很明显,源节点S需要多支付金额为20的费用.因此,网络中的源节点S存在过度支付问题.(3)AdHoc-VCG模型中消息负载的开销过高,大致为O(n3).在AdHoc-VCG模型中,一次路由发现过程中总共需要转发O(n3)数量级的路由请求数据包.当网络中的节点数量较多时,消息负载开销会更大,将严重影响网络的性能.(4)AdHoc-VCG模型中存在共谋攻击的可能性.如图2所示,当节点5和6形成共谋小团体时,它们将联合获取较高的支付,其表现形式可能为:节点5故意降低自己的成本信息为10,而节点6则故意抬高其成本信息为10.在此情况下,LCP中的中间节点所获源节点S的支付为对应的效用情况为由于网络中存在共谋攻击的影响,节点6的效用值相对于其报告真实类型信息时,增加了6,但是,为了满足共谋小团体的效益,假如节点6转移其50%的效用值来补偿节点5为了整个小团体的利益而做出的牺牲,使其获取了效用值为3的收益,但此时节点5的效用并没有达到最大.4.4模型建立4.4.1防策略支付模型针对AdHoc-VCG支付模型中存在的问题,本文首先考虑解决防策略性方面的问题,对其支付模型进行改进.从AdHoc-VCG支付模型的分析中可以看出:LCP(S,D,犱)中的节点为了获取最大化的效用,可能会表现出虚报其真实类型信息的情况,不过此虚报没有任何意义,即对该节点自身的效用没有任何影响,而对LCP(S,D,犱)中其它节点的效用产生影响,使得路径中的节点以真实的类型信息向源节点S报告时,得到的相应效用值不能达到最大.因此,本节给出一个新的定义,具体如下.定义6(全局替代路径).全局替代路径是指一条从节点S到D去掉LCP(S,D,犱)中所有中间节点之外的最小成本路径.根据4.1节的模型假设条件:网络是双向连通图,能够确保在该网络拓扑结构下,源节点S能够通过拓扑发现协议,找到一条最优的全局替代路径.因此,改进后的防策略支付模型和4.2类似:Pay(S,i,犱)=0,iLCP(S,D,犱)烄烅i∈LCP(S,D,犱烆其中,当节点i在LCP(S,D,犱)路径上时,其获得源节点S给予的支付费用为Pay(S,i,犱)=LCP-i(S,D,犱)-LCP(S,D,犱)+di,其它不在LCP(S,D,犱)中的节点所获支付仍为0.LCP-i(S,D,犱)仍然表示从S到D的所有路径中不包含中间节点i的最小成本路径.而源节点S能够建立路由的条件如下:Us=ms-LCP(S,D,犱)0.而LCP(S,D,犱)Page7表示LCP(S,D,犱)的全局替代路径.本节改进的防策略支付模型主要是通过LCP(S,D,犱)来约束源节点S支付的总费用,使源节点S也具有防策略性.可以证明该支付模型具有防策略性,详细过程见5.3节中的定理3.现以一个示例说明该支付模型的思想.具体见图2所示.在图2中,假设源节点S仍以最大支付100来建立路由.首先S仍然通过拓扑发现协议,计算出从节点S到节点D的最小成本路径为LCP(S,D,犱)={1,5,6},其对应的路径成本仍为LCP(S,D,犱)=26.同时,全局替代路径也可以通过全局的网络拓扑结构计算得出LCP(S,D,犱)={8,9,0,Y,Z},对应的路径成本LCP(S,D,犱)=55.由于LCP(S,D,犱)<ms=100,源节点S可以发起路由发现和数据包转发过程.利用本节的支付模型分别计算出节点1,5,6的支付费用如下:Pay(S,5,D)=35-26+20=29;∑i∈LCP,i(S,D)Pay(S,i,D)=10+29+10=很明显,存在以下问题:LCP(S,D,犱)-∑i∈LCP,i(S,D)Pay(S,i,D)=6,源节点S支付的总费用为55,而LCP中节点需要支付的总费用为49,多余的支付没有得到有效地利用,即经济学上所谓的“盈余”现象.围绕此示例仔细分析,当LCP(S,D,犱)中的节点8更改其成本信息为20,则LCP(S,D,犱)=45,不过此时,LCP(S,D,犱)=45<ms=100(路由发现和数据包转发过程仍然可以进行),但是∑i∈LCP,i(S,D)Pay(S,i,D)=49>LCP(S,D,犱)=45,出现了实际支付的费用不足,超出了预计的最大支付,即经济学上所谓“亏空赤字”现象.因此,以上问题总结为:支出和预算不平衡问题,即LCP(S,D,犱)≠∑i∈LCP,i(S,D)Pay(S,i,D).为了解决源节点S预先定义的支付费用和实际的支付不平衡问题,本节通过可信的目的节点D来进行调控,实现源节点S费用的支出和预算之间的平衡.实际上在现实社会中,这种预算不平衡的现象出现很正常.为了便于理解,假定一种场景:源节点S为无线接入网络的用户,而目的节点D则为提供无线接入网的服务提供商.该服务提供商是诚实可信的,用户S为了使用无线接入提供的服务,必须向无线接入网的服务提供商支付一定的费用LCP(S,D,犱),费用的分摊可以补偿给为用户S提供接入建立路由的中间节点,具体的费用通过LCP(S,D,犱)来计算得到∑i∈LCP,i(S,D)Pay(S,i,D),分两种情况讨论:(1)当LCP(S,D,犱)>∑i∈LCP,i(S,D)Pay(S,i,D)时,服务提供商D将用户S支付的剩余费用要么直接退付给用户S,要么通知用户S在下次享用服务时,可以作为下次支付费用的一部分来解决;(2)当LCP(S,D,犱)∑i∈LCP,i(S,D)Pay(S,i,D)时,为了吸引用户S以后更多的使用该服务提供商提供的服务,服务提供商D可能采取以下措施:①由D来负责代替支付用户S支付其不足的费用;②D将登记支付费用不足的用户S的详细情况,以便下次及时提醒其补交;③D考虑到实际成本的情况,下次再向其他用户提供接入服务时,调整用户的支付价格以及预算费用情况.因此,当用户S预算不足时,由D来调控处理的思想也是可行的.4.4.2防共谋支付模型从4.3节看到,AdHoc-VCG支付模型中也存在共谋攻击问题.而在4.4.1节提出的防策略支付模型仅仅解决了AdHoc-VCG支付模型的防策略问题,该支付模型也存在共谋攻击的可能性.如何在4.4.1节支付模型的基础上进行改进,建立有效的防共谋支付模型是本节的研究重点.为便于挖掘网络中共谋攻击发生的表现形式和条件,本节对支付模型中存在的共谋攻击情况进行了分析和总结,特以2个节点形成的共谋小团体为例(多于2个节点形成的共谋场景就是此简单场景的延伸).团体中的2个节点通过密谋协商虚报其类型信息,来获取较高的支付费用,并根据具体的支付费用情况,弥补共谋节点为了整个团体的收益而牺牲的所获得的收益.本节首先分析几种典型的共谋情况,以便对以上提出的支付模型进行改进.结合网络的实际情况,可能发生攻击的条件如下:(1)一个节点在LCP中,另外一个节点不在LCP中.此种情况已在文献[35]中进行了详细的分析,提出的支付模型可以实现防策略性,并且可以抵制共谋攻击产生的影响.Page8(2)两个节点都不在LCP中,从4.3节中可以看出,不在LCP中的节点可以通过降低自己的类型信息来获取较高的支付.当这两个节点降低的类型信息足以确保这两个节点加入到LCP中时,那么该两个节点获得的效用将减少;当这两个节点降低的类型信息不足以加入到LCP中,则其获得的支付为0,对LCP路径不产生影响.因此,此情况发生共谋的可能性很小.(3)两个节点都在LCP中.①两个节点都抬高自己的真实成本类型信息.此种情况出现共谋的可能性很小,原因是由于两个节点提高自己的成本信息过高,那么这两个节点出现在LCP中的可能性减少,极有可能被网络中其它路径所替代,即可能获得的支付变为0.②两个节点都降低自己的真实成本类型信息.通过降低这两个节点的成本类型信息,这两个节点仍然在LCP中,但是这两个节点获得的支付很可能增加很多,但是网络的总支付最终受限于LCP(S,D,犱).如果在总支付在小于LCP(S,D,犱)的情况下,源节点S发起路由建立的可能性较大,则在此路由建立过程中很可能出现共谋.其对应的信息.③一个节点抬高其类型信息,一个节点则降低此种情况结合节点的虚报成本信息的程度,进一步分两种子情况来分析:子情况1.一个节点成本提高的程度高于另一个节点成本降低的程度.此子情况出现共谋的情况也较少.虽然两个节点通过此方式增加了效用,但是LCP中的其它节点的效用受这两个节点的影响,所获得的效用比发生共谋之前明显降低.此外,这两个节点虚报成本信息的折中,导致其LCP的路径成本增加,很有可能存在其它路径来替换当前的LCP.另一个节点的成本降低的程度.子情况2.一个节点成本提高的程度不高于从表面上来看,其中一个虚报成本降低的节点效用降低,另外一个节点虚报成本增加的节点效用增加,但是由于效用降低的程度不足以用增加的程度去弥补,因此,此子情况发生共谋的可能性很小.通过对上述分析结果进行总结,具体可能发生共谋攻击的条件和场景见如表1所示.两个节点不互为邻居节点的分析思路就是以上讨论过程的延伸,其对应的具体情况也对应有3种,表1两个节点都在犔犆犘中发生共谋的情况总结有一个节点在LCP的情况共谋存在共谋不存在共谋分析思路与上述过程类似,本文略去相应的分析过程.共谋小团体无非就是通过设计支付费用交换协议[23]来对通过共谋所获的额外支付进行转移,本文通过5.3节实现的算法来避免转移情况的发生.基于以上分析思路,对4.4.1节提出的支付模型进行改进如下:Pay(S,i,犱)=0,iLCP(S,D,犱)烄烅烆付模型具有防策略性.其中,Q(i)表示为包含节点i以及与i组成共谋小团体的其它所有节点的集合,而LCP-Q(i)(S,D,犱)表示为从S到D的所有路径中不包含Q(i)中所有节点的最小成本路径,LCP-Q(i)(S,D,犱)则为对应的最小路径成本值.其它表示的意义与4.4.1节相同.此时,源节点S能够建立路由的条件:Us=ms-LCP(S,D,犱)0.为了实现整个网络的支付和预算平衡,仍然采用4.4.1节中由目的节点D进行调控的思想.定理1(防共谋性+防策略性).该防共谋支证明.假如网络中存在有两个节点x和y,则此两个节点可以互为邻居节点,也可以不互为邻居节点.为了简化证明的过程,利用VCG机制中的节点效用计算思想(参见式(4)),对这两个节点的效用计算根据本节的支付模型进行变换,得到如下计算公式:Ux(S,x,犱)=∑hUy(S,y,犱)=∑h将x和y两个节点的效用值进行相加,得到如下计算公式:Ux(S,x,犱)+Uy(S,y,犱)=2×∑hPage9其中,H-x(犱-Q(x))+H-y(犱-Q(y))不依赖于x和y具体的自身成本类型信息dx和dy,此外,当LCP中所有节点都将真实的成本类型信息报告给源节点,以此来计算各自的支付时,∑h∑hVy(O(犱),di)都能够达到最大,即x和y都将以i=1真实的成本类型信息来最大化其对应的效用值.此证明过程可以延伸到网络中共谋小团体中至少包含2个节点的情况.因此,该支付模型能够抵抗共谋的攻击,具有防策略性.5安全激励合作算法5.1算法体系本节围绕上节所建立的具有防策略性和防共谋的支付模型,提出安全可靠的激励合作算法ICTP.当前已有的相关文献[21-26],重点在路由发现阶段去分析激励合作问题,而很少考虑在路由建立之后的数据包转发阶段,本文提出的激励合作算法则将这两个阶段统一设计,避免LCP中的节点在路由发现阶段表现出很好的合作性,而在数据包转发阶段则又表现出自私性发生的可能性.最后,考虑到在4.4.2节不互为邻居节点的共谋小团体在产生共谋之后,可能会出现所获支付的内部转移等情况发生,以及避免本身网络中出现的篡改、窃听和重放等攻击,而采用密码学方式的加密、认证方式来实现算法的保密性、完整性、不可否认性和可用性.具体的体系结构图如图3所示.5.2安全激励合作算法5.2.1初始化阶段本文采用Diffie-Hellman密钥交换协议,该协议的有效性依赖于计算离散对数的难度,其目的在于使节点之间安全地交换一个秘密密钥以便用于后续阶段的数据包加密.本文通过该协议预先给网络中的各个节点分配私钥和公钥,以及在需要通信的节点对之间建立对称密钥.节点i通过该协议选择一个作为私钥的随机数ki,并计算其公钥Ki=gki.类似地,目的节点j也得到对应的私钥、公钥,分别为kj和Kj.i与j都可以计算出其对称密钥ki,j:其中,g为离散对数问题中素数的原根.具体的协议思想可以参考文献[36].5.2.2路由建立阶段本节的路由建立过程是对基于AdHoc网络中典型按需路由算法(AODV,DSR)的思想改进实现.路由建立阶段包括两个子过程:路由请求过程和路由回复过程.假设S和D需要建立一条最小成本的路由,具体过程如下:(1)路由请求过程①源节点S向其所有邻居节点(假设其中一个节点为i)广播路由请求信息:S→brdcast:[RDP,KS,D(S,D,mS,NS,TTL)],其中,RDP是路由请求包,{S,D,mS,NS,TTL}信息通过S和D的对称密钥KS,D加密来确保信息的保密性.NS是由S产生的随机数,目的是用来唯一地确定RDP来自哪一个节点,每一次源节点S发起路由发现请求时,产生一个单调递增的NS源节点序列号,在网络的整个生命周期中NS是递增的.TTL是数据包在网络中的生存时间,增加该参数的目的是防止数据包在网络中逗留时间过长,减少广播风暴对整个网络通信性能的影响.②邻居节点i收到路由请求信息之后,向源节点S发送确认信息:i→S:[ACK,KS,D(S,D,mS,NS,TTL)]Ki,S,其中,ACK是确认包,一般情况下,该确认包的长度比较小,对网络的整个通信开销不造成影响,基本上可以忽略.节点i向源节点S发送此确认包的目的是为了通知源节点S确认其哪一跳节点收到了路由请求包,进一步提高网络的可靠性.确认成功之后,进入执行过程③.否则,源节点S需等待其它邻居节点发送的确认包.③节点i继续广播路由请求信息至其所有邻居节点j:i→brdcast:[RDP,KS,D(S,D,mS,NS,TTL),节点i将其私有类型信息di以及其它相关信息通过i和D的对称密钥Ki,D加密,确保信息转发过程中的保密性.利用类似过程②的方法,向上一跳节点发送确认信息,确认成功之后,则执行过程④.否则,节点i需等待其它邻居节点发送的确认包.④节点j继续广播路由请求信息直至到达目的Page10节点D的前一跳节点k:j→brdcast:[RDP,KS,D(S,D,mS,NS,TTL),Ki,D(i,D,di,NS,TTL),…,Kk,D(k,D,dk,NS,TTL)].重复过程③直至到达目的节点D.利用类似过程③的方法,向上一跳节点发送确认信息,确认成功之后,则执行过程⑤.否则,节点k需等待其它邻居节点发送的确认包.⑤目的节点D处理接收到的路由请求信息.由于AdHoc网络本身具有广播特性,目的节点D最终会收到多个来自源节点S发送的不同路由请求包信息,节点D通过利用其上一跳邻居节点对应的对称密钥进行解密,因为只有目的节点D可以通过它们的对称密钥进行解密,也从侧面上保证了对上一跳邻居节点签名和认证,进而获取到网络中各个节点的私有类型信息.通过节点D获取到的信息,可以构建一个全局拓扑结构图以及通过Dijkstra算法在该拓扑结构中形成最小成本路径LCP(S,D,犱),并且计算出全局替代路径LCP(S,D,犱).本文基于4.4.1节和4.4.2两节的支付模型,结合源节点S的最大支付阈值mS以及LCP(S,D,犱)的计算值,目的节点D来确定LCP(S,D,犱)中的中间节点支付转发费用.存在如下两种情况需考虑:情况1.当mS-LCP(S,D,犱)0,则继续执行后续路由回复过程.情况2.当mS-LCP(S,D,犱)<0,源节点的效用为负值,违背了支付模型的防策略性的要求,则不再继续执行后续的路由回复过程.(2)路由回复过程目的节点D确定各个中间节点的支付费用之后,则向源节点S发送路由回复信息,通知其需要支付的总金额为LCP(S,D,犱),并向LCP路径中的各个节点通知其给予支付的具体金额以及LCP(S,D,犱)和LCP(S,D,犱)等重要信息.LCP路径中需要支付的节点和支付金额,则通过各自与目的节点D的对称密钥进行加密,在路由回复过程中,相应地解密获取对应的支付信息.具体的过程如下:①目的节点D向LCP路径中节点D的上一跳节点l发送路由回复信息:D→l:[REP,KS,D(D,S,LCP,LCP,LCP,NS,TTL),Kl,D(D,l,Pay(S,l,犱),NS,TTL),Kw,D(D,w,Pay(S,w,犱),NS,TTL),…,Kx,D(D,x,Pay(S,x,犱),NS,TTL),Ky,D(D,x,Pay(S,x,犱),NS,TTL)]Kl,②节点l向目的节点D发送确认信息:其中,REP是路由回复包.节点D将重要信息以及LCP路径上节点的支付金额,发送给LCP路径中距离目的节点最近的上一跳节点1,REP路径中包含了LCP所要经历的所有节点,以便加快路由回复的过程.节点l通过其私钥解密,如果成功,则执行过程②.否则,等待重新发送的路由回复包.l→D:[ACK,Kl,D(D,l,Pay(S,l,犱),NS,TTL)]KD.同时也考虑到满足可靠性的要求,节点l向目的节点D确认收到的路由回复信息.如果目的节点D验证成功,则执行过程③,如果失败,则目的节点D重新发送路由回复信息.③节点l继续沿着反向LCP路径发送路由回复包给节点l的下一跳节点w:l→w:[REP,KS,D(D,S,LCP,LCP,LCP,NS,TTL),Kw,D(D,w,Pay(S,w,犱),NS,TTL),…,Kx,D(D,x,Pay(S,x,犱),NS,TTL),Ky,D(D,x,Pay(S,x,犱),NS,TTL)]Kw.节点w收到回复包之后,进行节点l的签名认证,如果认证成功,则向节点l发送类似过程②确认信息,确认成功之后,节点w通过解密获取到目的节点D发送的支付信息,同时,执行过程④;否则,l重新发送路由回复信息.④节点w继续沿着反向LCP路径发送路由回复包直至源节点S的下一跳节点y:w→y:[REP,KS,D(D,S,LCP,LCP,LCP,NS,TTL),…,Kx,D(D,x,Pay(S,x,犱),NS,TTL),Ky,D(D,x,Pay(S,x,犱),NS,TTL)]Ky.此过程类似于过程③,主要实现通过节点y的公钥来进行加密和向其上一跳节点x的确认,同时节点y通过解密获取到其对应的支付金额.⑤源节点S处理接收到的节点y发送的路由回复包:源节点S收到节点y发送的路由回复包,也要首先进行回复包来源的认证和确认,确保源节点S接收到的路由回复包准确无误,通过对称密钥进行解密出预先发送的重要信息,并计算其对应的效用值,进一步加强源节点S的防策略性.此外,通过周期性地发送探测包来验证LCP(S,D,犱)路径是否存在.5.2.3数据包转发阶段5.2.2节的路由建立阶段为本节的数据包转发阶段提供了前提条件.本文将此两个阶段综合考虑Page11的出发点是为了保证数据包转发阶段也能提高激励合作的效率,防止部分节点在路由建立阶段积极主动地参与到该部分的过程中,而在数据包转发阶段又表现出其自私性.因此,结合前面支付模型的基础是以单个数据包的合作转发来进行展开,本节进一步延伸,根据源节点S实际需要发送的数据包个数来为中间节点支付额外的费用,即源节点S需要转发N个数据包,则LCP中的节点i需要源节点S提供的支付费用为N×Pay(S,i,犱),不在LCP中的节点给予的支付费用仍然为0.同时,源节点S的效用值就相应地改变为US=ms-N×∑i∈LCP,i(S,D)Pay(S,i,D),也要保证US0.本节的数据包转发算法仍然结合密码学方式来进行,假定通过路由建立过程获得的最优LCP路径为{S,1,2,…,n,D},LCP路径中各个节点的本地缓存中都保存了到达目的节点D的最优LCP路径下一跳节点的路由表.具体的过程如下:①源节点S向下一跳节点1发送Data数据包:S→1:[KS,D(S,D,Data),NS,TTL,LCP]K1,D.源节点S为了统计发送数据包的个数,通过NS来统计,如果目的节点D成功接收到数据包,则NS自动递增.添加LCP信息是验证接收到数据包的节点是否在LCP中.②节点1接收到数据包后向源节点S发送确认:为了提高数据包传输的可靠性,节点1通过签名认证和LCP判断:如果验证成功,则向源节点S发送确认信息,同时在本地缓存中记录源节点S转发数据包的序列号,继续执行过程③;如果失败,则等待源节点S重新发送数据包.③节点1向下一跳节点2发送Data数据包:1→2:[KS,D(S,D,Data),NS,TTL,LCP]K1,2.此过程类似过程①,并且验证成功之后,节点2也要向节点1发送确认信息.④重复以上过程,直至节点n向目的节点D发送Data数据包:n→D:[KS,D(S,D,Data),NS,TTL,LCP]Kn,D.目的节点D验证节点n签名的有效性以及其是否在LCP中,如果验证成功,则执行过程⑤;如果验证不成功,则等待数据包的重新发送.⑤目的节点D向源节点S发送数据包收到的确认:D→S:[ACK,NS,TTL,LCP]KS,D.此过程沿反向LCP路径,发送该确认信息,中间节点收到确认信息后通过本地缓存的路由表信息,来转发此确认信息给下一跳节点,直至到达源节点S.当源节点S收到此信息后,如果还有数据包要发送,则开始下一个时刻的NS+1数据包的发送;如果没有,则源节点S要向LCP路径中的节点支付费用,执行过程⑥.⑥源节点S支付费用过程:每个节点都很积极主动地获取相应的支付费用,通过设计一个简单的控制协议来实现整个支付的过程,避免恶意节点的窃听、篡改等攻击的可能发生,仍然采用密码学方式来加强这方面的考虑.此部分为了避免LCP路径中的部分节点优先获取到了支付费用,不愿意为距离源节点S较远的节点转发支付费用的情况发生,那么本文采用优先为距离源节点S较远的节点支付转发费用,最后支付给距离较近的节点的方式,增强了支付费用过程的有效性.5.3算法正确性和有效性分析本节将从理论上来证明ICTP算法的有效性和正确性.具体从以下几个部分进行展开:定理2(无环性).路由建立阶段一定不会存在重复计算环.证明.需要证明:设从源节点S到目的节点D存在一条包含环的路径Path:Path={S,v1,…,vi,vj,…,vj+k,vi,vi+1,…,vn,D}.当RDP沿着路径LCP第2次经过节点vi时,节点vi将其丢弃并不影响目的节点D对LCP和全局替代路径的计算,从而对本算法的正确性不造成任何影响.具体证明如下:(1)因为{S,v1,…,vi,vi+1,…,vn,D}组成一条不含环的从S到D的路径,沿着这条路径的RDP不会被丢弃,因此目的节点D可以获得vi的私有类型信息;(2)对于环上{vj,…,vj+k}的任意节点vl(0lk),如果存在一条从S到D的经过vl的简单路径(不含环),则目的节点D也能够获得vl的私有类型信息;(3)对于环上{vj,…,vj+k}的任意节点vl(0lk),如果存在一条从S到D的路径中都包含环,则节点vl的信息对于计算LCP和全局替代路径没有任何意义(因为LCP和全局替代路径中都不包含环),因此,LCP和全局替代路径中都不会包含有vl,丢弃该节点不会影响本算法的正确性.证毕.Page12定理3(防策略性).ICTP算法一定具有防策略性.证明.本节结合4.4.1节和4.4.2节的支付模型,分别从源节点S、中间节点i和目的节点D的防策略性来分析和证明该算法的防策略性:(1)源节点的防策略性源节点S在寻找最小成本路径LCP之前,已经给出预支付的最大值mS,即源节点S实际支付给LCP中节点的总费用一定不会超过mS,因此,确保其效用值为非负US0.下面分两种情况来说明源节点S真实报告其私有类型是VCG机制的占优策略,其中mf为S虚报的类型信息,LCP(S,D,犱)为全局替代路径的成本:当mfmS时,存在以下3种子情况:子情况1:LCP(S,D,犱)<mfmS.在该情况下,源节点S实际支付的费用为LCP(S,D,犱),其效用US仍为mS-LCP(S,D,犱),则US不依赖于其它报告的类型信息.子情况2:mf<LCP(S,D,犱)<mS.在该情况下,源节点S以虚报信息mf报告时,由于mf<LCP(S,D,犱),产生过度支付问题,则整个算法将不执行,即US将为0,则源节点S报告mS为占优策略.子情况3:mfmS<LCP(S,D,犱).很明显,源节点S虚报信息mf时,由于支付的实际费用超过了预算,整个算法仍将不执行,即US将为0.很显然,源节点S报告mS为占优策略.当mf>mS时:证明过程与mfmS类似,同理也可以证明:源节点S仍以mS报告时为占优策略,因此,源节点具有防策略性.的信息为di,则可能存在如下两种情况:(2)中间节点的防策略性这里假定中间节点i的真实信息为ci,而虚报当ci<di(虚报的成本类型信息过高)时:子情况1:中间节点i不在LCP中,则节点i以报告di时,其效用Ui仍为0.子情况2:中间节点i在LCP中时,如果节点i虚报的信息di过高,那么节点i很可能不能加入LCP中,则其效用Ui=0;如果节点i以不太高的di信息报告时,那么该节点仍在LCP中,但报告di对其效用不产生任何影响.当cidi(虚报的成本类型信息过低)时:子情况1:中间节点i在LCP中,通过报告信息di,该节点仍在LCP中,对节点i的效用不产生任何影响,即不影响其支付费用.子情况2:中间节点i不在LCP中,通过报告di,则此时网络从源节点S到目的节点D形成的新LCP包含该节点,其对应的效用在信息虚报前后变化过程如下:节点i在虚报di信息之前(以ci报告)时,该节对应效用的为:Ui=LCP-i(S,D,犱)-而节点i以信息di报告时,节点i可能形成新Payd(S,i,D)=LCP-i(S,D,犱)-LCP(S,D,犱),很显然,Ui0.的LCP,则其支付更新为点的效用情况为很显然,原来节点i以ci信息报告时的LCP(S,D,犱),成为了当前网络拓扑下从S到D的所有路径中不包含中间节点i的最小成本路径LCP-i(S,D,犱),而LCP(S,D,犱)更新为LCP(S,D,犱)=LCP-i(S,D,犱)-ci+di.通过化简,计算其支付为Payd(S,1,D)=对应实际获取的效用为Ui=LCP(S,D,犱)-LCP-i(S,D,犱).由于Ui0,所以Ui0,即通过虚报信息di,节点i的效用比以ci报告时的明显减少,而且变为负值.综合以上情况分析,中间节点报告真实类型ci是占优策略,即该节点具有防策略性.(3)目的节点的防策略性本文中预先假定了目的节点D是可信的,能够真实地报告其类型信息,一般情况下,目的节点D不会与源节点S形成共谋来减少源节点S实际的支付,并且节点D也不会与中间节点形成共谋来为中间节点提供较高的支付.因此,目的节点D也具有防策略性.定理4(算法开销).ICTP算法的开销降为O(M2d),其中M为除S和D之外所有中间节点的子集,d为保证网络连通性时的最大连通度.证明.本文算法的执行条件要求从源节点S到目的节点D存在一条LCP路径,其成本要小于源节点S的最大支付mS.很明显,MV-2,而算法的开销主要集中在集合M中所有节点的数据包转发.由于数据包转发的开销至多为O(Md),因此该算法的整个通信开销大致为Page13O(M2d).相对于以Ad-HocVCG模型为基础的算法通信开销(见4.3节问题描述)来说,本文的ICTP算法开销大大降低.定理5(安全性分析).ICTP算法能够抵抗网证明.算法ICTP在基于对称密钥加密的基础上结合公钥加密的方式来实现安全保证.针对当前网络中出现的常见攻击方式,本节对该算法的鲁棒性进行评估,对其安全性进行分析.络中常见攻击的影响.(1)节点运行算法的安全性在网络初始化阶段,节点都需要通过Diffie-Hellman密钥交换协议与网络中的其它节点以及目的节点D分发各自的公钥和对称密钥信息,各个节点在本地缓存中保存对应节点的公钥信息以及合法的安全邻居列表,确保网络中的节点都是安全的、可信的,为下一步的路由建立过程提供认证,签名提供强有力的安全保证.(2)发送伪装的路由请求数据包信息来攻击由于每个节点都有一张邻居节点列表,节点在广播路由请求数据包RDP时,不能随意伪装成网络中的其它节点,只有下一跳节点的邻居节点存在伪装攻击的可能;否则,通过确认和监听方式很容易为下一跳节点发起伪装攻击提供可能.此外,本文采用逐跳的方式进行上游节点的确认和签名,接收节点也进行安全确认回复,即使节点刻意对数据包进行伪装攻击,那么每个节点的私钥也是无法获得的,因此该攻击出现的可能性较小.(3)更改路由信息攻击在本算法的路由建立阶段,恶意节点有可能更改路由信息,但是其更改也只能修改先于该节点之前的路由信息,而不能更改该节点之后的路由信息,因为如果其在该节点之后任意加入节点信息,则下一跳节点可以对其进行监测和发现.而当其更改前面的路由信息,当REP转发至被其更改的节点时,被更改节点和其邻居节点都很容易被监测,并将举报其篡改行为.(4)黑洞和灰洞攻击本文重点通过支付模型,让节点真实地报告其私有类型信息,来获取最大的支付,同时确保自身的效用最大化,即网络中的节点都较理性地去考虑自己的收益情况,此外本文的支付模型具有防策略性(见定理3),节点不可能表现出自私性,不会出现故意丢弃需要转发的数据包的行为,因此避免网络中存在黑洞和灰洞攻击的可能性.(5)重放攻击由于RDP和REP数据包中都包含数据包的序列号和时间戳等重要信息,因而,整个的算法过程可以阻止重放攻击的发生.(6)共谋攻击本文的出发点是通过改进AdHoc-VCG支付模型来避免共谋攻击产生的可能,4.4.2节给出了解决的方法,另外,本文在设计算法时也充分考虑了共谋小团体之间收益转移的可能性.因此,首先通过对邻居节点的流量信息实行监控,然后利用加密、认证和鉴别的方式进一步避免共谋攻击的发生.6仿真与分析6.1仿真环境建立本文为了进一步验证以上思路的有效性和正确性,采用NS2①仿真平台来实现上述算法ICTP,并与其它经典的3种算法AdHoc-VCG、COMMIT、LMOCP进行对比.本文的仿真环境基于MAC层使用IEEE802.11b的DCF,移动模型采用RandomWaypointModel模型以及将CBR(ConstantBitRate)作为传输流量模型,发送数据包的速率为4packet/s,每个数据包随机地从一个源节点发送到另一个随机目的节点,移动速度在0m/s~20m/s之间任意选择.到达目的节点后,经过一个暂停时间(0s~200s)再开始新的转发过程.仿真过程中建立的通信连接数为30,一共生成25种随机拓扑,每种情况对应5种,最后的数据为5种拓扑所产生数据的平均值.为了合理地计算出各个节点的私有类型转发成本信息,各个节点结合物理层的实际转发数据包的能量消耗,来计算其成本类型信息.其它参数的设置见表2所示.参数AreaNrS移动节点最大移动速度20m/sPT整个网络的仿真时间M网络中的自私节点数1~30ms源节点S的最大支付阈值100E节点的初始化能量①http://www.isi.edu/nsnam/ns/Page14本文的拓扑结构采用改进的Waxman[37]方法思想,它可以产生实际网络的拓扑结构.具体Wax-man方法的思想:网络中随机产生N个节点,并将这些节点均匀分布在一定拓扑区域中,任意两个节点i和j之间按一定的概率来建立连接,节点间连接概率的取值具体由节点间的欧氏距离来决定,从而将节点间链路的存在与否与节点间的距离关联起来.而链路的产生概率可以通过如下公式来计算:其中,Dis(i,j)表示节点i和j之间的欧氏距离;Lmax表示整个网络中任意节点间的最大距离;α和β为对应的动态调整参数(0<β<1,0<α<1).当β逐渐增大时,网络中边的密度也在增大,而α减少时,网路中节点间距离较小的边相对于距离较大的边的密度也在增大.通过对参数α和β进行调整,使得距离较小的边存在的概率大于较长的边存在的概率,并且确保图中节点平均密度为4~6.基于此,在假定各个节点的传输半径(具体见表2)是相同的前提条件下,根据节点间的距离与传输半径的对比情况,优化Waxman拓扑思想,再结合参数α和β的调整情况,使得彼此节点在各自传输半径范围内,确保距离较小的边对应的链路连通性较高,以及整个网络的密度适中,最终实现网络拓扑图的连通性.通过实验得到的网络拓扑结构见图4所示.图4中存在有40个正常的善意节点(Benevolentnode)和10个自私节点(Selfishnode).对这10个自私节点攻击行为的模拟是通过计算其自身能量的消耗成本作为其自身的私有成本类型信息,而故意增加或减少其真实消耗成本值,从而向源节点报告其虚假私有信息.6.2性能对比参数为了验证ICTP算法的性能,并与AdHoc-VCG、COMMIT、LMOCP算法进行实验对比,本文将围绕以下几个参数进行分析:(1)分组投递率,指目的节点收到的数据包数目与源节点发送的数据包数目的比值.(2)端到端的平均时延,包括路由查找时延、数据包在接口队列中的等待时延,传输时延及MAC层的重传时延,反映了路由有效性.端到端的平均时延=∑(接收到数据包的时间-发送数据包的时间)/发送数据包的个数).(3)总体效用值,指LCP路径中所有中间节点的效用值之和.此参数反映了节点效用值是否在采用本文的支付模型下取得最大.(4)归一化路由开销,指单位时间内路由控制包的传输量,它是网络拓扑结构变化率的函数.路由开销=转发的路由包个数和发送的路由包个数之和/目的端接收到的路由个数.(5)归一化支付费用,指全局替代路径中所有节点的总成本与LCP路径中的所有节点需要支付的总费用之差与LCP中所有节点需要支付的总费用的比例值.(6)总体成本开销,指LCP路径中所有中间节点的成本之和.(7)转发的数据包总数,指通过采取激励合作模型之后,网络中的中间节点所转发的数据包数目.(8)源节点的效用,指部分源节点的效用值,主要衡量源节点是否存在过度支付情况.6.3仿真结果分析本文重点分析ICTP算法较其它3种算法在6.2节参数下的性能对比情况,特别在网络中自私节点所占比重,归一化支付费用,总体成本开销,总体效用值和源节点的效用等方面来衡量本文提出支付模型的有效性.具体对比情况见图5~13所示.图5分组投递率和自私节点所占比重的对比图5给出了4种算法的分组投递率在不同自私节点所占比重下的表现情况.很明显,随着自私节点Page15逐渐增加,4种算法的分组投递率都在逐步下降.整体上来说,ICTP的分组投递率较高,AdHoc-VCG的最低,而COMMIT和LMOCP介于前面两者之间.这其中的主要原因:随着自私节点的增加,网络中的分组投递率肯定是减少的,如何采取有效的激励措施是解决问题的关键,而这4种算法都是通过给予中间的转发节点一定的成本补偿来调动其合作的积极性,源节点支付的总费用是否足以维持这些自私节点,这4种算法则各有所长,而ICTP算法较其它3个算法的优势体现在:源节点的防策略性,避免过度支付策略以及路由建立过程和数据包转发阶段的双重激励合作.而COMMIT和LMOCP都没有考虑源节点的防策略性,而AdHoc-VCG算法虽然考虑了源节点的防策略性,但是没有考虑过度支付的情况,因而,导致出现图5的所示结果.图6给出了4种算法的端到端的平均时延在不同自私节点所占比重下的对比情况.整体上来说,这4种算法的平均时延都随着自私节点数的增加而显著增加.AdHoc-VCG的时延从13ms增加到20ms,LMOCP的时延从12ms增加到18ms,COMMIT则从11ms增加到16ms,而ICTP算法则从11ms增加到14ms.直观上来看,AdHoc-VCG的时延开销最高,LMOCP次之,而ICTP和COMMIT的开销基本上差不多,达到了最小.导致存在这种差异的原因在于:源节点为了激励数目逐渐增加的自私节点的转发积极性,不得不向其支付一定的费用,并且保证支付的费用都是自私节点通过真实报告其类型来获得的,整个的支付和报告类型过程,都是通过路由发现过程来实现,目的节点通过广播的请求包,收集网络的全局拓扑结构图,选择一条最小成本的LCP,并向源节点进行回复确认,通知其需要支付的节点集合和相关费用.因此,整个的预处理过程较长,数据包转发的时延开销较高,但是AdHoc-VCG和LMOCP相比来说,由于这两种算法的存在共谋和源节点不具有防策略性问题,导致其中间节点和源节点可能存在不真实的报告其类型的行为,影响其数据包的转发效率,从而导致这两种算法的时延开销最高,而LMOCP是对AdHoc-VCG控制开销的减少的改进,使其开销略低;ICTP和COMMIT解决了源节点的防策略性问题,使COMMIT的时延开销较低,而ICTP也解决了共谋问题,使其真正实现了防策略性,进一步减少了网络通信的时延开销.图7显示了在不同自私节点数所占比重下4种算法的路由开销对比情况.该图中也反映了这4种算法的通信开销情况.从防策略性的特点中可以看出,网络的通信开销要在多项式时间内实现可计算性,也即整个通信过程包括防策略性的实施和支付费用都在保证通信开销维持的多项式时间内,网络的性能能够实现最优.和图6的分析类似,时延开销的情况也从侧面反映了通信开销的情况.这4种算法的路由开销随着自私节点数的增加而增加,COMMIT,LMOCP和ICTP这3种算法基本上开销变化很小,而AdHoc-VCG的开销要高些.存在这种对比差异的原因:AdHoc-VCG明确指出其通信开销维持在O(n3),其它3种算法的开销维持在都维持在n2的数量级,而这3种算法的主要区别主要体现在n2数量级的常数关系上.LMOCP在路由发现过程中,对发送路由请求包进行改进,针对重复发送的情况进行抑制以及网路拓扑变化时,动态局部更新路由表的过程,而COMMIT和ICTP算法则包含了改进思想,但ICTP可能由于使用了对称加密和公钥认证的方式以及长度较小的确认数据包,来增强其确认的安全机制,略微增加了网络的通信开销.Page16接下来图8~13主要从源节点的支付情况、中间节点的总效用、总成本和转发数据包个数等情况以及共谋攻击的影响方面来进一步对性能进行分析.图8给出了在不同自私节点所占比重下的LCP中的节点所获支付费用情况来进行对比.实际上,图8反映的是源节点预支付和实际支付的差额比值关系,进一步说明源节点的支付能力.当网络中不存在自私节点时,LCP中的节点都很自愿地转发数据包,而本文假定中间节点不存在支付的情况.随着自私节点数的增加,源节点需要支付给自私节点的费用增加,因而导致4种算法的支付情况都在逐渐下降.但是,ICTP算法的归一化支付较高,说明中间节点所需支付的总费用相比其它3种算法不会出现中间节点虚报信息而支付费用过高的可能性,进一步验证了ICTP算法的防策略性.不具有防策略性的AdHoc-VCG算法则其归一化支付费用过低,可能存在支付较高的可能性.而COMMIT和LMOCP算法是基于AdHoc-VCG支付模型的改进,支付的有效性可能有了改进.图9则对应给出了LCP中间节点的总体效用值的变化情况.该图反映了中间节点是否以真实的类型来报告其信息,如以真实的类型信息来报告,结合节点自身理性的特点,那么该节点获取的效用一定是最高的.也从侧面验证4种算法的防策略性.与图8的分析情况相同,很明显,ICTP算法的总体效用值最高,AdHoc-VCG算法的最低,COMMIT和LMOCP算法的总体效用值则介于以上两种算法的效用值之间.图10进一步验证了4种算法在存在自私节点情况下的总成本开销.由于不在LCP中的节点其所获支付费用为0,这些节点的成本开销主要体现在路由发现过程中的接收和转发路由请求包,实际的总体成本开销则指在路由发现过程和数据包转发过图9总体效用值和自私节点所占比重的对比程的两个阶段下LCP中所有中间节点的成本之和.很显然,其它3种算法都仅仅考虑路由发现过程中LCP中的节点转发成本,而忽略了数据包转发阶段的成本开销,也即该阶段下的自私激励过程,从而导致在路由发现过程中LCP中的节点具有合作转发的积极性,而在数据包转发阶段又表现出自私性.较其它3种算法,ICTP的成本开销较高,但是其在数据包转发阶段也对应获取到源节点给予积极合作的支付费用,起到一定的鼓励和补偿的目的.图10总体成本开销和自私节点所占比重的对比另外一个衡量LCP中节点的合作积极性的度量指标为转发数据包的总个数.图11给出了具体的对比情况.整体上来说,随着自私节点的增加,4种算法的数据包转发总数都在减少.相对而言,AdHoc-VCG算法的转发数据包总数递减的幅度最快,ICTP算法递减的幅度较慢,COMMIT和LMOCP算法的递减程度则介于上述两种算法之间.存在这种情况的原因仍然是由于AdHoc-VCG、COMMIT和LMOCP的支付模型缺少防策略性以及没有考虑数据包转发过程的激励措施所导致.ICTP算法针对以上3种算法的不足提出了改进方案,能够在自私节点较多的情况下,保持良好的性能.为了验证本文提出的防共谋攻击的支付模型性Page17图11转发数据包总数和自私节点所占比重的对比能情况,通过在一固定通信对的LCP中,随机选择至少两个中间节点来组成共谋小团体进行仿真测试.图12给出了测试结果.总效用值的计算思想和图10类似.当共谋节点数逐渐从4%增加到8%时,4种算法的总效用在逐渐增加;当从8%增加到16%,总效用都在逐渐减少;而从16%增加到20%时,则总效用又出现了逐渐递增的情况.相对图9所示来说,图12中ICTP算法的总体效用不再像图9表现出最大的优势,而是略低于COMMIT算法,仍高于其他两种算法.总体效用表现的最大,则并不意味着节点之间都以真实的类型信息来报告,很有可能是由于共谋小团体为了获取高额的支付,通过协商故意让小团体中的节点虚报节点的信息(具体见4.4.2节),因此一部分节点获取了较高的支付,而部分节点为了小团体的利益,减少了其自身的支付,但是通过支付转移来平衡节点的支付.本文的支付模型能够抵抗共谋攻击的影响,一方面通过加密和签名的方式防止支付转移的可能性发生,另一方面通过剔除共谋小团体来计算其各自的支付两种措施来进行保护,确保各个中间节点以真实类型信息进行报告.基于此,可能导致ICTP算法的总体效用相对于COMMIT算法不能达到最大,略高于LMOCP和AdHoc-VCG算法的总体效用.图12总体效用值和共谋节点所占比重的对比本文通过对30个通信对的源节点效用值在不同仿真时间下进行观察分析.图13给出了当网络中存在16%的自私节点数时,在30个源节点中随机选择出7个节点的效用情况.从图中可以看出:在ICTP算法的背景下,7个节点的效用值都大于0;而在使用其它3种算法的情况下,都存在或多或少的效用值小于0的情况.此现象发生的主要原因是由于ICTP算法解决了源节点的防策略的问题,利用全局替代路径来取代其它3种算法中的除去对应源节点的最小成本路径,减小源节点的过度支付,最大化其自身的效用值.因此,ICTP算法的性能较其它3种算法略好一些.图13源节点的效用值在停留时间为100s的情况6.4安全性能保证开销分析为了进一步验证ICTP算法的安全保证开销情况,本文对签名、对称和公钥密钥加密方式进行了效率的对比与分析.本文采用Crypto++库①中的RSA加密算法和DES加解密算法,并在不同密钥安全等级下进行仿真实验,从而评估该算法的安全性能和计算开销.各种算法均假定数据包长度为128Bytes下进行测试,仿真的计算机硬件配置环境为IntelCore2.2GHz.RSA签名算法采用了1024bit和512bit两种等级的密钥,分别对应运算10000次,DES加密及解密算法采用128bit和256bit两种等级的密钥分别进行1000000次运算,以上密钥等级均具有当前较高的安全等级密钥强度.通过对上次运算重复5次实验,得出:RSA加解密算法在密钥为1024bit时,加解密的时间开销基本上都在355s,而在密钥为512bit时,加解密的时间开销维持在96s~98s之间;而采用DES算法分别在密钥为128bit和256bit时,其对应的时间开销基本上维持在190s~191s以及198s.加解密算法的效率明显要远远高①http://www.cryptopp.com/Page18于同安全等级的签名和验证算法,且平均每次运算相差的时间为两个数量级.另外,一般情况下,对称加解密的运算速度比非对称加解密的运算要快,即该算法开销主要集中在RSA的算法上.此外,在路由建立过程中,由于确认包的长度较小,所以路由建立阶段的大部分时间开销都花费在RSA算法中的加解密操作中.当网络中广播的路由请求包RDP过多,以及需要经过的较多中间节点进行转发时,路由建立的开销可能更高.因此,在未来的工作中,选择有效的签名方法来对本文的算法进行改进和扩展.7总结与展望本文基于当前的研究热点———算法机制设计思想以及将此思想运用于AdHoc网络中的支付模型———AdHoc-VCG,提出了一种防策略和防共谋的支付模型,使自私节点报告其真实的私有类型成本信息来实现效用最大化,通过获取源节点提供的支付费用作为转发补偿,实现激励合作的目的,并进一步对路由发现过程和数据包转发过程一起考虑,加强数据包转发阶段节点转发的积极性,提出了对应的激励合作算法ICTP.最后,通过仿真实验验证其有效性,并与其它的经典算法(AdHoc-VCG,COMMIT和LMOCP)进行了性能对比.仿真结果表明:ICTP算法在性能上有了显著的提高.在未来的工作中,将继续测试该协议的性能,以及将其延伸到多播路由协议和QoS保证中来进一步提高网络的性能.
