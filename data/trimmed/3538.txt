Page1基于Markov逻辑网的两阶段数据冲突解决方法张永新李庆忠彭朝晖(山东大学计算机科学与技术学院济南250014)摘要在数据集成中,如何准确地解决数据冲突是关系集成数据质量的关键问题.现有的方法主要针对单个属性进行冲突解决,由于没有区分不同属性的冲突程度,也没有考虑不同属性间冲突解决的相互影响,导致数据冲突解决的准确率不高.针对现有方法存在的不足,文中提出一种基于Markov逻辑网的两阶段数据冲突解决方法.该方法可以根据冲突程度对属性进行划分,并分两阶段进行处理:(1)在第1阶段,对于弱冲突属性,利用投票规则及事实之间相互印证等简单规则进行冲突解决;(2)在第2阶段,利用了第1阶段冲突解决的结果,在规则中加入数据源与事实之间的相互影响规则、数据源之间相互依赖规则及弱冲突属性对强冲突属性影响规则,对强冲突属性进行冲突解决.通过在大量真实数据上的实验结果证明,该方法能够有效地解决集成数据的冲突问题,具有较高的准确率.关键词数据冲突解决;Markov逻辑网;数据集成;冲突程度;推理规则1引言数据集成的目的是通过集成同一领域中的多个数据源,为用户提供更加全面、高质量的数据.但由于不同数据源的数据质量不同,它们对同一实体有着不同的描述,这些数据有的能正确反映现实世界,有的则不能,这些不同的描述数据之间可能存在冲突.而这些冲突数据的存在会严重影响集成数据的质量.因此,如何有效解决数据冲突,即从众多冲突数据中选择与现实世界一致的数据(可以称为真值)已成为一个亟待解决的问题.这个问题正逐渐引起研究者的关注,成为数据集成领域中最新的研究热点之一[1-2].现有数据冲突解决方法大都通过关系扩展的方式实现,并定义了若干冲突解决策略和冲突解决函数[3].通过扩展关系操作及聚合函数,由用户或领域专家根据实际的需求或领域知识为冲突值指定不同的冲突解决函数,从而得到一致、无冲突的结果[4].但是,这类方法主要是根据具体的冲突类型人为指定冲突解决函数,在适应性和准确性方面还存在以下问题:(1)针对某一属性上冲突值指定的冲突解决函数,当有新数据源及新数据加入时可能对现有的指定产生影响,从而需要重新指定甚至定义冲突解决函数.而数据集成是个动态的过程,随着数据源信息的变化以及新数据源的加入,不断会有新的数据集成到系统中.显然这类方法的适应性不强,无法满足数据集成动态性的需要.(2)在现有的冲突解决策略中,应用比较广泛的是Trustyourfriends和Crywithyourwolves[3],其原理是通过信任某一数据源及少数服从多数的投票方式从多个冲突值中选择一个作为真值.但在数据集成中,如何从多个的数据源中选择“优质”数据源是一个挑战,并且选择单一的“优质”数据源作为信任数据源的做法也有些武断.另外,特别是在Web环境下,Web数据易于传播的特点使得在传播真实值的同时也传播了虚假值,单纯通过投票的方式确定真值也不尽合理.因此,利用现有策略进行冲突解决很难保证准确性.(3)现有冲突解决方法为每个属性分别指定相应的冲突解决函数,但没有区分不同属性的冲突程度,也没有考虑不同属性上冲突解决之间的相互影响,这也是现有冲突解决方法不够准确的一个原因.为了适应数据集成的需要,针对于现有方法的不足,本文提出一种基于Markov逻辑网[5]的两阶段数据冲突解决方法.本文创新点主要体现在以下几个方面:(1)提出一种基于Markov逻辑网的两阶段数据冲突解决方法,该方法可以根据冲突程度对属性进行划分,并分两阶段进行处理;由于充分利用了弱冲突属性对强冲突属性的影响因素,该方法有效地提高了冲突解决的准确度;(2)通过对冲突数据及数据源特点的观察和分析,该方法综合运用了多角度的特征和规则,保证了数据冲突解决的有效性和准确率;(3)通过在多个真实数据集上的实验表明,所提方法能够较好地完成数据冲突解决任务,具有较强的准确性和可适应性.本文第2节分析数据冲突解决的相关工作;第3节将对数据冲突解决的相关概念及问题进行说明;第4节详细介绍本文提出的数据冲突解决方法;第5节给出实验结果与分析;第6节对全文做总结.2相关工作现有数据冲突解决的研究主要集中在关系扩展上,其中比较具有代表性的是德国波茨坦大学Naumann等人的工作.Naumann等人总结了现有的冲突解决策略和冲突解决函数[3],提出了相应的研究原型,并扩展、实现了诸如minimumunion[6]等关系操作.对于此类方法的不足在引言中已经提及,这里不赘述了.除了通过关系扩展的方式外,还有一些研究从多个冲突值中选择真值的方法.Wu等人[7]提出一种对搜索引擎返回结果集进行聚合的方式以选取真值的方法,该方法利用了Web数据源的重要度及各数据源提供结果值之间的相似性.但这种方法仅能对数值型结果值识别真伪,具有一定的局限性,其中Web数据源的重要度通过网站的排名及流行度来衡量,而事实上这种通过PageRank的方式获得的排名与网站的可信度仍有一定的差距.Yin等人[8]将从描述同一对象的多个冲突值中识别真值的问题定义为Veracity,利用数据源的可信度和数据值的准确性之间的相互影响以及正确数据值之间的相互印证关系,提出一个名为TruthFinder的迭代算法,以实现真值的识别.但这种方法并没有考虑数据源之间的依赖关系,由于Web数据易于传播的特点,Page3使得在传播正确值的同时也传播了错误值,仅考虑正确值之间相互印证的关系显然是不足的,这在一定程度上会降低真值识别的准确率.Dong等人[9]主要考虑数据源之间的依赖关系,提出一种真值识别的贝叶斯推理模型.但对于贝叶斯模型而言,当有新的推理规则加入时需要重新建模,因此该方法在适应性上稍显不足.另外,现有真值识别方法主要是针对单个属性进行数据冲突解决,而对于不同属性的数据冲突采取同等对待的方式.这些方法并没有区分不同属性的冲突程度,也没有考虑不同属性间冲突解决的相互影响因素,这在一定程度上也影响了冲突解决的准确率.Markov逻辑网[5]是一种将Markov网络与一阶谓词逻辑相结合的统计关系学习模型,它将领域知识引入Markov网,为大型Markov网提供了一种简洁的描述语言,为一阶逻辑增加了不确定性处理能力,可以作为很多统计关系学习任务的统一框架.Markov逻辑网已经在诸如实体统一[10]、信息抽取[11]等方面的研究中得到应用.综上所述,现有方法在准确性、适应性方面分别存在着一定的不足,难以胜任集成数据的冲突解决任务,迫切需要一种准确率更高、适应性更强的数据冲突解决方法.3数据冲突解决问题在集成数据的冲突解决问题中,数据冲突主要表现在对同一实体的相同属性的不同数据源提供了不同的值,这些值有的能正确反映现实世界,有的不能.为了便于描述,对文中相关概念及问题解释如下:数据源(Source).提供冲突数据的不同来源,这里的数据源可以是数据库、Web网站等.数据源集合表示为S={s1,s2,…,sn},其中si(1in)表示第i个数据源.实体(Entity).实体是现实世界存在的,唯一的、可识别的对象,比如一本书、一部电影.实体集合可表示为E={e1,e2,…,em},其中ei(1im)表示第i个实体.实体类型(EntityType).一个实体类型即为拥有相同属性的实体集合.即实体类型是实体的一个类别,而实体是给定实体类型的一个实例.比如书、电影等.实体属性(EntityAttribute).某实体的一个属性,比如某一本书的作者、某部电影的导演.实体属性集合可表示为EA={ea11,ea12,…,eamk},其中eaij(1im,1jk)表示第i个实体的第j个属性.事实(Fact).对于一个实体属性,由某一数据源提供的值.如对于实体属性ea(《FlashCS3:TheMissingManual》这本书的作者),数据源s(图书在线网站ABCBooks)提供的事实为f(“ChrisGrover,E.A.VanderVeer”).数据冲突(DataConflict).多个数据源对同一实体属性提供的事实不一致时产生数据冲突.真值(TrueValue).与现实世界一致的事实.不同的数据源对于不同实体属性提供大量的事实,而对于同一实体属性不同数据源提供的不同事实之间可能存在着数据冲突,图1展示了数据源、实体、实体属性及事实之间的关系.数据冲突解决就是从实体属性的不同冲突事实中识别真值的过程.对于数据冲突解决,给出如下定义.图1数据源、实体、实体属性及事实之间的关系定义1(数据冲突解决).输入数据源集合S、实体集合E、实体属性集合EA、事实集合F及其之间的关系,对于一个实体属性ea∈EA,从各数据源对于实体属性ea所提供的事实集合Fea={f1,f2,…,fL}中选择对应的真值fi,其中fi∈Fea.4数据冲突解决方法本文提出一种基于Markov逻辑网的两阶段数据冲突解决方法,其流程如图2所示.(1)首先,对不同属性计算各属性上的数据冲突程度,根据冲突程度将属性分为两个集合:弱冲突属性和强冲突属性.(2)在第1阶段冲突解决中,对于弱冲突属性,根据观察的特征,设定投票规则及事实之间相互印证规则,通过训练集训练Markov逻辑网模型并进行真值推理;由于该部分属性冲突程度较小,通过这Page4些简单的规则即可得到很高的数据冲突解决准确度.(3)在第2阶段冲突解决中,将第1阶段数据冲突解决的结果加入到训练集中,重新训练模型,对强冲突属性进行数据冲突解决;由于该部分属性冲突程度较大,为了有效利用第1阶段数据冲突解决的图2基于Markov逻辑网的两阶段数据冲突解决整体流程数据冲突解决流程的输入是来自不同数据源的带有冲突的数据集,其中重复检测已经完成;输出的是数据冲突已解决的数据集.数据冲突解决整体算法如下.算法1.输入:冲突数据集DC,其中包括属性集A、实体集E,训输出:数据集DR,其中数据冲突已解决主要步骤:1.初始化:属性集合AL=,AH=,其中AL、AH分2.forai∈A3.计算ai属性上的数据冲突程度Conflict(ai);4.ifConflict(ai)<T5.AL=AL∪{ai};6.else7.AH=AH∪{ai};8.定义谓词及公式,利用训练集DTrain训练Markov逻表1图书实体属性上的冲突信息SourceABCBooksFlashCS3:TheMissingManualChrisGrover,E.A.VanderVeerVeer,E.A.Vander,Grover,ChrisA1BooksEAVanderVeer,ChrisGrover,VanderVeerE.,GroverChrisAurigaLtdtextbooksNowFlashCS3:MissingManualVanderVeerPowell’sBooksFlashCs3:TheMissingManualVanderVeer,EABookLoversUSAFlashCS3:theMissingManual,byMooreMoore,EmilyStratfordBooksFLASHCS3结果,提高对强冲突属性的冲突解决准确率,该阶段规则中加入数据源与事实之间的相互影响规则、数据源之间相互依赖规则及弱冲突属性对强冲突属性影响规则.(4)最后,根据两阶段冲突解决的结果,进行数据合并,得到无冲突的数据集.9.DTrain=DTrain∪D1;10.公式中加入新规则,利用新的训练集DTrain训练11.forei∈E12.foraj∈A13.根据结果集D1、D2选择相应的真值;14.将对应属性的真值组成记录ri,DR=DR∪{ri};15.返回数据集DR.4.1冲突程度的度量在集成数据集中,不同属性的冲突程度各不相同.表1是从多个图书网站收集的关于图书《FlashCS3:TheMissingManual》(ISBN:0596510446)的信息,内容包括数据源(Source)、书名(Title)和作者(Authors).对于该图书实体的书名属性,不同数据源提供的信息趋于一致,其冲突程度较小;而相对于作者属性,各数据源提供的信息差别较大,GloverPage5其冲突程度也较大.显然,对于一个实体属性而言,数据源提供的不同事实越多,其不确定性越大,则冲突程度也越大.因此,利用信息论中熵的概念定义实体属性的冲突程度.定义2(实体属性的冲突程度).对于实体属性ea∈EA,各数据源提供的不同事实集合为F={f1,f2,…,fL},|fi|表示事实fi(1iL)出现的次数,则实体属性ea的冲突程度可以定义为EAConflict(ea)=-1其中p(fi)为事实fi出现的先验概率,p(fi)=|fi|∑L|fj|j=1定义3(属性冲突程度).对于属性集合A中的一个属性a∈A,其对应的实体属性集合为EA={ea1,ea2,…,eam},则属性a的冲突程度可以定义为4.2利用Markov逻辑网进行数据冲突解决在对属性进行冲突程度划分后,本方法将利用Markov逻辑网分别对弱冲突属性及强冲突属性进行两阶段的数据冲突解决.本小节将首先对Markov逻辑网进行介绍,然后分别介绍利用Markov逻辑网进行数据冲突解决的几个重要步骤:特征选择、规则设定、真值推理.4.2.1Markov逻辑网Markov逻辑网(MarkovLogicNetworksMLN)[5]是一种将Markov网络与一阶谓词逻辑相结合的统计关系学习模型,它是对关系数据进行建模的一阶逻辑的概率扩展.其基本思想是将一阶逻辑的约束软化:一个可能世界违反的公式越多,其发生的概率越小,但其概率未必为零.对于数据冲突解决问题而言,需要组合不确定及不完美的知识,因此Markov逻辑网是个比较适合的模型.定义4(Markov逻辑网).Markov逻辑网[5]L是一个二元组集合{(Fi,wi)}m辑公式,实数wi为公式Fi的权值.已知Markov逻辑网中L和有限个体常项集合C={C1,C2,…,C|C|},则可以产生一个以闭谓词为节点、闭谓词关系为边的Markov网ML,C,其中,(1)每个闭谓词对应ML,C的一个二元节点,如果闭谓词为真则对应二元节点状态值为1,否则为0.(2)每个闭公式对应ML,C的一个特征,如果闭公式为真则对应的特征为1,否则为0.Markov逻辑网可以看作是一个构建Markov随机场的模板,其对应Markov网络中的一个状态x的概率定义为P(X=x)=1其中Z为归一化常数,ni(x)为Fi在x中所有取真值的基本规则数量,x{i}是Fi中为真的原子,i(x{i})=ewi,wi为第i个公式的权重.式(3)所定义的是一个产生式Markov逻辑网模型,即它定义了所有谓词的联合概率分布.在本文的数据冲突解决应用中,预先已知了证据谓词和查询谓词,需要对谓词的条件概率分布建模,因此,需要一个判别式Markov逻辑网模型[12].相比于产生式模型,判别式模型可以充分利用问题中的一切有用特征作为证据,也更有应用前景.首先,将谓词划分为两个集合———证据谓词X和查询谓词Q.给定一个常量x,判别式Markov逻辑网将条件概率定义如下[12]:P(q|x)=1其中Zx(w)为归一化因子,FQ是至少包括一个查询谓词的公式集合,Gi为第i个一阶谓词公式的基本公式集合.gj(q,x)是一个二元函数,当第j个基本公式为真时其值为1,否则为0.本文中的数据冲突解决是判别多个冲突事实的真伪性,从中选择与现实世界一致的真值.因此,查询谓词只有一个,用来判定一个事实是否准确,即IsAccurate(fact).证据谓词可以是冲突事实所呈现出来的特征,在式(4)所定义的判别式Markov逻辑网模型中,任意有用的特征都可以作为证据谓词.根据这些预定义的特征,可以定义一些Markov逻辑网中的谓词公式.4.2.2特征选择根据对数据源、数据及数据冲突特点的观察和分析,本文主要从4种不同的角度搜集特征:基本特征、数据源的可信性与事实的准确性、事实之间的相互印证、数据源之间的相互依赖.对于不同的特征,在Markov逻辑网中,将为其定义相关谓词,表2展示了本方法中用到的不同谓词.Page6搜集角度基本特征数据源的可信性与事实的准确性事实之间的相互印证相互依赖InterDepend(s1,s2)数据源s1与s2之间数据源之间的(1)基本特征基本特征展示了数据源、实体、实体属性及事实之间的基本关系.其中,数据源s提供事实f,其谓词可表示为Provide(s,f);实体属性ea是实体e的一个属性,其谓词可表示为Belong(ea,e);事实f是关于实体属性ea的一个事实,其谓词可表示为About(f,ea).另外,为了引入“投票规则”,这里使用谓词MaxFrequence(ea,f)表示f是关于实体属性ea的所有事实中出现次数最多的事实.(2)数据源的可信性与事实的准确性在数据冲突解决中,应该存在这样的“可信”数据源:相对于其它数据源,它提供的事实准确度比较高,如表1中的数据源ABCBooks和A1Books,事实上这种情况是存在的.于是,如果多个这样的“可信”数据源对同一实体属性提供相同的事实,那么认为该事实也很可能是真值;同样,如果一个数据源对很多实体属性都能提供真值,那么认为该数据源也很可能是“可信的”.为了表示数据源的可信性和事实的准确性,这里引入谓词IsTrustworthy(s)和IsAccurate(f).(3)事实之间的相互印证对于同一实体属性不同事实之间存在着相互印证的关系.这里主要考虑两种关系:等价和包含.如在表1中,一个数据源提供的一本图书的作者为“ChrisGrover,E.A.VanderVeer”,另一个数据源提供的则是“Veer,E.A.Vander,Grover,Chris”,这两个事实内容是一致的,只是表现形式不同,这里将这种关系定义为等价关系,使用谓词Equal(f1,f2)表示.又如两个数据源分别提供事实“E.A.VanderVeer”和“VanderVeer”,则前一个事实的内容包含定义5(数据源之间的依赖).对于两个数据(4)数据源之间的相互依赖如果两个数据源对很多实体的实体属性都提供一致的事实,那么认为这两个数据源之间存在着依赖关系,从而它们对于其它实体属性提供的事实也极有可能具有相同的准确性.本文引入谓词InterDepend(s1,s2)来表示数据源之间的依赖关系.为了更严谨地定义和计算数据源之间的依赖,这里给出依赖的定义.源s1、s2,如果存在|F1∩F2|依赖关系.其中,F1、F2分别表示s1、s2提供的事实集合,EA1、EA2分别表示s1、s2提供了事实的实体属性集合,参数α∈[0,1]为阈值.需要说明的是,两个事实相等当且仅当它们是关于同一实体属性的事实且值相等.4.2.3规则设定通过对数据源及其数据特点的观察和分析,针对上一小节定义的特征,本节引入一些用于推理的规则,这些规则体现出一些启发式的特点,以谓词公式的形式展现.由于Markov逻辑网具有强大的表述能力,当需要新的规则加入时只要定义相应的谓词公式,再重新学习公式权重以用于推理即可,这使得本方法具有较强的可适应性.另外,本文所提规则大都为不确定性规则,而Markov逻辑网恰恰具有这种组合不确定的甚至是相互矛盾的知识的能力,也使得所有对数据冲突解决有用的规则都可以加入到本方法中.4.2.3.1第1阶段规则在第1阶段数据冲突解决中,对于弱冲突属性,由于冲突程度较小,通过一些简单的规则即可得到很高的数据冲突解决准确度,这里介绍投票规则和事实之间相互印证规则.(1)规则1.投票规则针对于从多个冲突事实中选择真值的问题,投票规则是最为朴素的规则,通常对同一实体属性出现次数最多的事实往往是准确的.后一个事实的内容,这里将这种关系定义为包含关系,使用谓词Contain(f1,f2)表示.MaxFrequence(ea,f)IsAccurate(f)(5)(2)规则2.事实之间相互印证规则如果同一实体属性ea的两个事实的内容是等价的,则它们具有相同的准确性;通常,详尽的信息会比简略的信息好,因此,对于同一实体属性的两个Page7事实f1和f2,如果f1的内容包含f2的内容并且已知f2是准确的,那么f1也是准确的.Equal(f1,f2)(IsAccurate(f1)IsAccurate(f2))About(f1,ea)About(f2,ea)Contain(f1,f2)IsAccurate(f2)IsAccurate(f1)4.2.3.2第2阶段规则在第2阶段数据冲突解决中,对于强冲突属性,由于冲突程度较大,这里除了第1阶段利用的简单规则外,还加入一些比较复杂的规则:数据源与事实之间的相互影响规则、数据源之间相互依赖规则及弱冲突属性对强冲突属性影响规则.(1)规则3.数据源与事实之间的相互影响规则基于4.2.3小节的分析,通常准确事实的提供者是可信的,而可信数据源提供的事实是准确的.这里定义以下规则IsAccurate(f)Provide(s,f)IsTrustworthy(s)IsTrustworthy(s)Provide(s,f)IsAccurate(f)(2)规则4.数据源之间相互依赖规则如果两个数据源s1、s2对很多实体属性都提供一致的事实,那么认为这两个数据源之间存在着依赖关系,从而它们对于其它实体属性提供的事实也极有可能具有相同的准确性.InterDepend(s1,s2)About(f1,ea)About(f2,ea)Provide(s1,f1)Provide(s2,f2)(IsAccurate(f1)IsAccurate(f2))(10)(3)规则5.弱冲突属性对强冲突属性影响规则对于一个实体而言,如果一个数据源对同一实体的多个实体属性都提供正确的事实,那么它对其它实体属性提供的事实很可能也是正确的.IsAccurate(f1)Provide(s,f1)About(f1,ea1)Belong(ea1,e)Provide(s,f2)About(f2,ea2)Belong(ea2,e)IsAccurate(f2)4.2.4真值推理除了定义好的特征及规则以外,Markov逻辑网还必须包括每个规则的相对权重.在数据冲突解决问题中,由于事先并不知道各规则之间的依赖关系,因此需要通过自动训练模型来学习每个公式的权重.目前,对于判别式Markov逻辑网中权重学习的比较好的方法是表决感知算法[13].表决感知算法是一种梯度下降算法,它首先将所有权重设为0,然后根据训练集中预定值与真值是否匹配,来迭代训练数据并更新权重.最后,为了防止过拟合,权重设置为整个学习阶段的平均值而不是最终的权重.另外,为了使用表决感知算法,还需要知道每个子句为真的期望值.不过,通常这种期望值的获取是很难解决的,本文采用MC-SAT[14]算法来近似解决这一问题.通过训练模型得到每个公式的权重后,即可通过Markov逻辑网对测试集进行推理,从而从冲突数据中识别出真值.传统的概率模型推理通常使用MCMC(MarkovChainMonteCarlo)[15]算法,而纯逻辑系统通常采用可满足性算法.Markov逻辑网中的推理既具有概率性又具有确定性,因此,在本文的方法中采用了MC-SAT算法来确定查询谓词的值.MC-SAT算法综合了MCMC和可满足技术,因此在Markov逻辑网的推理中得到广泛应用.在方法的最后,需要根据两阶段数据冲突解决的结果将数据集进行合并.这里,对于每个实体根据对应实体属性上的真值,将表示同一实体的各条记录合并至一条记录,从而组成一致、准确的数据集,主要步骤参考算法1.5实验评价本文所提方法将在两个真实数据集上进行验证.首先随机选择一定量的数据作为训练集进行标注,在Markov逻辑网的学习和推理中,使用了开源工具Alchemy.为了验证算法的有效性,本文将从4个方面对实验结果进行分析评价:(1)数据冲突解决的准确率;(2)训练样本数量对准确率的影响;(3)两阶段数据冲突解决的有效性;(4)不同规则及组合对准确率的影响.5.1测试数据集(1)图书数据集首先从OReilly官网抽取其出版的图书信息(共1258条),抽取信息包括书名、作者、出版年份、ISBN(10位),并以此真值,作为最后冲突解决结果的比较标准.然后利用自制的信息收集程序,将OReilly出版图书的ISBN信息作为关键字,在www.abebooks.com中检索并收集相应的图书信息,作为图书数据集.本数据集共包括来自881个数据源的26891条图书信息.在图书信息中,由于ISBN信息不会出现冲突,因此本文通过对书名、作者、出版年份信息进行数据冲突解决来验证本方法Page8的有效性.由于不同网站提供的作者姓名含有一些杂质信息,本文对数据集进行了一些预处理以去除这些噪音信息.(2)电影数据集在图书数据集中,由于出版年份信息出现冲突的可能性较小,本方法主要对书名、作者这样的字符型数据的冲突进行处理;为了验证本方法对不同类型数据冲突的处理能力,本文搜集了一些电影信息,并测试本方法对电影时长这种数字型数据的冲突解决的有效性.首先从IMDB网站抽取最热门的250部电影的信息,其中包括电影名称、导演、电影时长,基于IMDB网站的权威性,将来自IMDB的电影信息作为真值,并以此作为比较标准.然后根据抽取的电影名称,利用类似文献[8]的方法从Google上搜索并抽取不同站点提供的电影时长及导演信息.本数据集共包括来自952个数据源的7119条电影信息.5.2实验结果与分析为了全面验证算法的有效性,本文主要从5个方面对实验结果进行分析评价.(1)数据冲突解决的准确率针对于数据冲突解决问题,准确率(Accuracy)可定义为正确识别真值的实体属性数占实体属性总数的比例.本文在两个数据集上比较了基于Markov逻辑网的两阶段数据冲突解决方法(用2-StageMLN表示)、投票方法(Voting)、TruthFinder[8]及文献[9]中方法(用Bayes表示)的准确率.需要说明的是,在TruthFinder和Bayes中,对于不完整的信息仍有得分,而在本文的实验中,不完整的信息被认为是不准确的.另外,对于内容等价的信息,本文将不考虑其展现形式,如一本图书有多个作者,只要作者数量及每个作者信息都正确则认为该图书作者信息是准确的,而不考虑作者的顺序.实验中,对于图书数据集,随机选择600个实体(不同ISBN)对应的记录作为训练集,利用定义3计算各属性的冲突程度,根据冲突程度的不同,首先选择书名、出版年份作为弱冲突属性,利用Markov逻辑网进行第1阶段的数据冲突解决,而对于冲突程度较强的作者属性,在第2阶段中进行处理.对于电影数据集,选择120个实体对应的记录作为训练集,其它作为测试集,同样通过属性冲突程度计算,将导演、电影时长信息分别归为弱冲突属性及强冲突属性,然后进行两阶段的数据冲突解决.其中,判断数据源相互依赖的阈值设置为α=0.8,而数据冲突阈值设置为T=0.5.图3显示了本方法与其它3个方法在准确率这个指标上的比较,从图中可以看出,在两个数据集上,本方法都能得到较高的准确率.相对而言,Bayes的准确率接近于本方法,但在对新特征和新规则的适应能力上较本方法有一定欠缺.其中在图书数据集上,本方法优势明显(92.9%),这主要是因为对于作者信息而言,其不完整、不准确的情况比较多,这在一定程度上也说明本方法处理数据冲突的能力;而对于电影数据集,本方法与TruthFinder及Bayes在准确率上差别不是特别明显,这是因为相比于图书数据集,同一电影的时长及导演信息变化不大,投票方法也可以获得较高的准确率(87.0%).实验证明,通过两阶段的数据冲突解决,综合运用多角度的特征和规则,本方法能够有效的提高数据冲突解决的准确率.(2)训练样本数量对准确率的影响为了进一步验证本方法的影响因素,通过实验测试了训练样本数量的变化对准确率的影响.从图书数据集中随机选择300、600、900、1200个实体对应的记录作为训练集,通过本方法进行数据冲突解决;而对于电影数据集,随机选择60、120、180、240个实体对应的记录作为训练集.图4(a)和(b)分别展示了在两个数据集上本方法准确率随着训练样本数量的增加而变化的曲线.通过观察发现,本方法准确率随着训练样本数量的增加而逐步提高.但是曲线会随着训练样本数量的增加而逐渐变得扁平.这个实验表明,训练样本的数量对本方法的性能有着明显的影响;但是随着训练样本数量的继续增加,这种影响将逐步降低.(3)两阶段数据冲突解决的有效性本文所提方法的一个重要特点是可以根据冲突程度将属性分为两个集合,然后利用Markov逻辑网进行两阶段的分别处理,为了验证两阶段数据冲突解决的有效性,本文进行以下实验.首先将所有属性同等对待,利用文中所提特征及规则(由于无法考Page9虑弱冲突属性对强冲突属性影响规则,仅使用前4个规则),通过训练集训练Markov逻辑网模型并进行真值推理,这里将这种方法称为一阶段Markov逻辑网方法(简称为MLN).然后利用本文所提的2-StageMLN方法对数据集进行同样的实验,比较两种方法的准确率.图5展示了两种方法在两个数据集上的准确率比较,相比于MLN方法,2-StageMLN可以比较明显地提高数据冲突解决的准确率.首先对于弱冲突属性,利用第1阶段Markov逻辑网即可获得较高的数据冲突解决准确率;其次,第1阶段冲突解决的结果有效地扩充了第2阶段冲突解决的训练集,再利用弱冲突属性对强冲突属性影响等规则,在第2阶段可以训练出更为精确的Markov逻辑网模型,从而有效地提高了数据冲突解决的准确性.(4)不同规则对准确率的影响为了验证本文所提规则的有效性,通过实验测试了不同规则对准确率的影响.由于弱冲突属性对强冲突属性影响规则需要先对弱冲突属性进行冲突解决,该规则仅能在第2阶段Markov逻辑网中应用,并且其对准确率的影响在图5所示实验中已有验证,因此本实验主要针对本文所提的前4类规则:投票规则(简称为V)、事实之间相互印证规则(简称为I)、数据源与事实之间的相互影响规则(简称为SF)、数据源之间相互依赖规则(D).将投票规则作为基本规则,在此基础上分别加入其它3种规则形成3种规则组合以及所有规则的组合,通过一阶段Markov逻辑网实验分别测试使用这5种规则及组合所得到的算法准确率.实验在图书数据集上进行,其它设置与图3所示实验相同.图6展示了不同规则对应的准确率直方图.通过观察发现,所提规则都在一定程度上提高了本方法的准确率,这证实了所提规则的有效性.在所有规则中,以数据源与事实之间的相互影响规则、事实之间相互印证规则对准确率的提升尤为明显,而数据源之间相互依赖规则对准确率的影响相对较小.这一方面证实了“可信”数据源的存在,不同数据源的可信性对冲突解决有着很大影响;另一方面,也说明了冲突信息会经常出现不完整或显示形式不一致等现象,这是导致难以识别真值的一个重要原因;而对于数据源之间的相互依赖规则,本文并没有考虑依赖的方向,这是导致依赖规则作用不显著的原因之一.另外,实验也验证了本方法能够方便地组合不同规则,只需要添加或删除相应的谓词公式即可.对于数据集成而言,由于集成的动态性特点,会不断地出现新的冲突类型,本方法可以根据新冲突类型的特征及展示出的规则,定义相应的谓词及公式,重新学习即可用于真值推理,这也体现了本方法具有较强的适应能力.(5)参数敏感性在本文的方法中存在两个重要的阈值参数:α和T,其中α为数据源相互依赖阈值(见4.2.2节),用以判断两数据源是否存在相互依赖关系,而T为数据冲突阈值,用以区分弱冲突属性和强冲突属性.Page10根据经验,将阈值分别设置为α=0.8,T=0.5.下面的实验表明,在一定的范围内,阈值的选择对方法的准确度影响很小.图7(a)显示了在两个数据集上不同α值对方法准确率的影响,其中T=0.5.在区间[0.4,0.9]上,参数α对方法准确率影响很小.这是因为如果α取值过小,此时大部分数据源之间都存在着相互依赖关系,这使得通过MLN学习得到的规则4(数据源之间相互依赖规则)的权重很低,在推理过程中该规则起到的作用会很小,特别地,当α=0或α=1时,规则4的作用将降到最低;同理,当α取值过大时效果类似.图7(b)显示了在两个数据集上不同T值对方法准确率的影响,其中α=0.8.由于数据集中同一实体类型的属性个数较少,数据冲突阈值对准确率的影响有限,一般而言,参数T取值在区间[0.2,0.8]上时方法准确率趋于稳定.6结论本文提出一种基于Markov逻辑网的两阶段数据冲突解决方法,该方法可以根据冲突程度对属性进行划分,并分两阶段进行处理;通过对数据源、数据及其冲突特点的观察和分析,该方法综合运用了多角度的特征和规则,有效地提高了冲突解决的准确度;基于Markov逻辑网强大的逻辑表述能力和处理不确定性的能力,该方法可以组合一些不完美甚至相互矛盾的知识来进行学习和推理,具有较强的可适应性.另外,对于本文所提方法而言,当训练集规模很大时,在模型训练过程中公式权重学习所需时间相对较长,因此,如何进一步提高该方法的效率将是未来工作中面临的主要问题.
