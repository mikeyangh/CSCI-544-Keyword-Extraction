Page1基于纹理的自适应提升小波变换图像压缩张军1)成礼智2)杨海滨1)黄魁华1)1)(国防科学技术大学信息系统与管理学院长沙410073)2)(国防科学技术大学理学院长沙410073)摘要经典二维小波变换仅在图像的水平和竖直方向应用小波滤波,不能提供灵活的方向信息,对纹理信息丰富的自然图像稀疏化效果不理想,在基于小波变换的图像压缩中还需改进.为了实现更有效的图像的稀疏表示,文中提出一种新型的基于图像纹理的自适应提升小波变换:根据局部特征将图像自适应分块,预先判断局部图像纹理方向,保持正交性质不变;沿纹理方向应用小波滤波,结合提升变换格式实现即位运算;沿纹理方向插值获取分数像素值,保护纹理信息不被破坏,总体变换对图像纹理描述更有效;结合JPEG2000中的编码方法EBCOT,对变换系数和方向信息分别编码,应用于图像压缩.仿真实验是在数值结果和视觉效果上将文中方法和JPEG2000方法作比较,以体现文中方法的优越性.关键词图像压缩;自适应提升小波变换;图像纹理;方向预测;像素插值1引言小波变换提供了一种适合人眼视觉原理的多分辨率、显微镜性质的图像表示方式,经过数十年的发展,在理论和实践中取得了一系列令人瞩目的成就,成为图像处理领域中一个有力的工具,如静止图像压缩的国际标准JPEG2000等.随着研究的进一步深入,发现经典小波变换在处理高维情形也存在一些不足.经典二维可分小波变换是通过对图像的行列分别进行一维小波变换得到的,可以很好地表示图像的点奇异性质.但是自然图像富含丰富的纹理信息,其奇异点具有纹理方向,而经典小波只能抓住水平与竖直方向的信息,不能有效地表示图像中其它方向的纹理或边界信息,在变换后的高频子带,图像纹理处小波变换系数值仍较显著,即不能很好的稀疏化,这给后续的图像处理带来了困难,如在低比特压缩时会产生Gibbs现象等.寻找更加有效的理论和工具,对图像的纹理信息实现更加有效的稀疏表示,是众多研究者努力的方向,也是现在图像处理领域研究的一个热点问题,已经取得了一系列显著的成果,主要可分为自适应和非自适应两类.非自适应方法主要通过提供更多的方向信息,增加高频子带分解个数,如方向滤波器[1]、Curvelet变换[2]、Contourlet变换[3]等,这些变换能够提供更多方向的选择,在图像处理领域取得了重要的应用,但是大多也存在一些不足,如图像的数学模型简单、存在一定的冗余、实现较为复杂等,应用于图像压缩中还存在一定的困难.自适应方法,主要是变换中增加方向预测,如Bandelet变换[4]、CurvedWavelet变换[5]等,Bandlet变换在经典小波变换的高频部分自适应的跟踪图像的几何正则方向,但仍存在小波变换的一些不足,CurvedWavelet变换将图像按固定大小分块,预测每个子块的正则方向,沿正则方向应用小波滤波,变换不再具有正交性.自适应方法大多存在计算量复杂、实现较困难的问题,在压缩处理中需要进一步改进完善.为了使变换自适应于图像局部纹理信息,实现更有效的稀疏表示,本文提出了矩阵偏差度的概念,在此基础上建立了更加符合图像特征的新型纹理与边缘方向选择方法以及基于方向的图像插值方法,从而更加有效地实现图像细节信息和局部特征的保护;提出了依据图像局部纹理丰富程度自适应分块的优化算法,其特点是在计算复杂度与算法效果间寻找平衡点;结合提升格式和预测方向,建立了保持变换过程中局部正交性的方向提升格式变换方法,该算法具有逐点运算、实现完全重构以及低计算复杂度等特点.本文提出的算法能很好地结合JPEG2000中的编码方法,对变换系数和方向信息分别编码,建立新型的图像压缩方案.数值实验说明了应用本文方法后高频能量降低,高频系数显著减小,非线性近似能力更好,图像压缩的效果显著,视觉效果相较于经典小波有明显提高,特别是局部目标特征保持能力显著提高,有着广阔的应用前景.2自适应方向提升小波变换2.1矩阵偏差度与方向预测为了建立方向提升格式,本文首先引入图像像素矩阵偏差度的概念,并由此得到子块图像纹理的方向预测方法.首先我们讨论方向预测矩阵偏差度的含义与性质.犅偏差度,如果满足定义1.函数P(犃,犅)称之为M×N矩阵犃,其中,表示某种矩阵范数.阵拟范数,即有下面的性质.下面证明按上式得到的偏差度实质上是一种矩(复)数;下列性质定理1.按照定义1定义的矩阵偏差度具有(1)P(犃,犅)0;(2)P(α犃,α犅)=|α|P(犃,犅),其中α为实(3)P(犃,犅)P(犃,C)+P(C,犅).其中性质(3)称之为半可加性.利用矩阵范数的性质容易证明定理1的结论成立.另外,根据矩阵偏差度的定义不难看到,其像素值的差事实上反映了图像中各种不同方向上信息的变化程度,而最后得到的值则代表了图像变化最大部分的方向信息,从而可以估计出图像的纹理和边缘.下面讨论如何利用矩阵偏差度刻画图像的纹理方向.首先考虑将N×N图像实现分块,对于每一个子块图像Dk,则相对于子块图像Dk中点xi,j=(i,j)所有可能的方向角度包括:Page3θ(i,j)=例如,下面的图1给出了一种方向示意图.定义2.对于子块图像Dk,两点xi,j与xn,m的距离定义为d(xi,j,xn,m)=max{|i-n|,|j-m|},以xi,j为顶点,高为h,宽为w,方向角度为θ(i,j)所得到的邻域,称之为含角度参数的邻域.含角度邻域参数的讨论:当θ(i,j)≠0或π差度,在实施像素差值运算时可能会出现在不同的分块图像中点的偏差度不均衡,从而导致边缘效应的出现,为了有效保持图像的纹理特征并实现图像的高保真表示,此时,我们可以采用两种方法进行处理.(1)边缘区域重叠.图2为一个图像边缘重叠x-(i,j)=x(2-i,2k-j),2-Ni0;k=1,若2-Nj0;k=N,若N+1j2N-1x(i,2k-j),1iN;k=1,若2-Nj0;k=N,若N+1j2N-1x(2k-i,j),k=1,若2-Ni0;k=N,若N+1i2N-1;1jN其中2-Ni,j2N-1,因此,不难看出,延拓后的图像大小为(3N-2)×(3N-2).根据上述描述,下面研究图像边缘与纹理方向的确定方法.如图3所示,对于给定的点(i,j),将图的示意图,在该图中x1,1块中.(2)按照小波变换中对图像边缘延拓所广泛采用的延拓方法进行处理.对于给定的图像边界,数据的边界延拓方式总结起来主要有5种,其中周期延拓和对称延拓由于在图像变换过程中能够保证信号的精确重构,因此是最常用的两种方式.考虑到对称延拓与周期延拓相比可以更好地保持图像不失真,故本节采用对称延拖.该延拓方法具体思想是,以图像边缘作为对称轴,将像素值对称延拓,例如,当θ(N,j)=0且对应于图像的右边界点时,其延拓公式为x(N+i,)=x(N-i,)或x(N+i,)=x(N-i+1,),设原图像与延拓后图像像素值分别定义为x(i,j)与x-(i,j),一般情形下的延拓公式满足像按照各种可能方向θ分成若干子块图像,并计算相邻两块子图像的偏差值,由于偏差值反映图像的平坦程度和邻近像素变化的剧烈程度,图像越平滑,偏差值越小,反之则越大,因此,我们选定偏差值最大的方向θ作为位于点(i,j)附近子块图像的方向.2.2方向提升变换现在研究基于纹理的自适应提升小波变换的实现过程.经典二维可分小波是由一维小波张量产生的,对一幅图像先进行行(或列)方向的一维小波变换,对变换结果再进行列(或行)方向的一维小波变换.其主要的一点不足是变换提供的方向信息固定且有限,对自然图像中非水平或竖直方向的纹理信息稀疏表示能力不足.为了更好地表示图像中任意方向的纹理信息,可以考虑在变换之前事先预测局Page4部纹理信息的方向,沿着这个方向进行小波变换,那么图像表示就更加稀疏有效.Sweldens等人研究经典小波变换可以通过提升格式[6]来实现,降低计算量的同时,可以实现即位运算.提升小波变换主要包括分裂、预测和更新几个步骤[7].不失一般性,假设小波变换先进行列方向变换,首先将信号分裂成奇偶两部分:在预测步骤中,就是用xe(m,n)来预测xo(m,n),预测误差为其中,P(·)为预测算子,只要选定一种预测算子,就可以由xe(m,n)和h(m,n)完全恢复xo(m,n),进而恢复信号x(m,n).经典小波提升格式中,利用的数据就是竖直列方向的一组数据,而在本文算法中,由于按照2.1节中得到的方向进行预测,假设在xo(m,n)点的列方向为θ,则预测算子就要修正为沿θ方向,即Pxe(m,n)=∑i在更新步骤中,就是要用h(m,n)来处理xe(m,n),使得处理后的xe(m,n)(记为l(m,n))只包含信号的低频部分:其中,U(·)为更新算子.同样的,在本文算法中,更新算子也要修正为沿θ方向,即Uh(m,n)=∑j在提升格式的每个步骤中只需要利用相邻的有限个像素点值,如通常使用的9/7小波,其提升格式变换每个步骤仅需要相邻3个像素值即可,这个性质非常符合本文的自适应小波变换,如图3所示,在确定方向以后,根据纹理方向相邻像素利用提升格式变换实现该点的预测和更新步骤.先前发展的基于图像内容的自适应变换,将二维变换分行列单独考虑,从各自方向角度选择合适的变换方向,从而整体变换不再具有正交这一重要的性质,本文从变换最终是达到高频(LH,HL,HH)信息总体能量最小的角度出发,在选择方向的时候保证局部行列方向变换正交的性质不变,选择二维变换后高频能量最小的方向,认为是局部纹理方向,从而同时确定了行和列的变换方向.理想方向选择可以是任意的,但从简化计算量的角度考虑,需要做出一些限制,本文变换先将图像分块(分块的规则在2.3节讨论),在每个子块内,方向是唯一的,即认为是同态区域;每个子块内的行列变换的方向保持正交;每个子块内的方向选择数限制为有限,本文限制在行列方向都有5个方向选择(如图3).根据上面的限制,方向选择的实现步骤如下:1.在每个允许的方向对图像应用行方向的一维提升小波滤波,在其对应的垂直方向应用列方向的一维提升小波滤波;2.计算每个子块在所有允许方向上二维滤波后高频能量之和(LH、HL、HH3个子带的能量之和);应变换方向,即同时确定了行方向和列方向.3.选择对应高频能量最小的方向作为这个子块的自适经过上述过程的计算,确定了分块子图像的变换方向,这些方向的集合构成了整个图像变换的一个方向基,我们称之为“方向图”.如在行方向的变换中,每个子块的行变换方向的线段互相衔接构成整个图像的行变换方向,即图像的行变换方向是由一段一段的线段构成的,从这里我们也可以看出,虽然事先进行了分块,但是在每个块的边界变换时候,利用相邻块的像素,从而不会产生边界效应.同时注意到,在第一步过程中,保证了在每个子带内行列变换方向的正交性.2.3四叉树分块在对图像事进行分块时,显然若分块子图像越小,则每个子块的同态性越好,变换效果将越明显,但是为了能够完全重构,每个子块的方向信息需要在变换过程中保留作为附加信息,若分块越小,附加信息量增大,将降低效率,不利于后来的压缩处理,故采用自适应分块方法.自然图像纹理信息丰富,且不同区域纹理信息丰富程度不同,即同态区域大小不同,如图像背景部分变化平稳,可以分块较大,而细节部分变化剧烈,选择分块较小.因而在确定变换方向之前进行图像分块,纹理信息丰富的区域分块较小,纹理信息不丰富的区域分块较大,使得每个子块图像都具有一个明确的纹理方向,保证方法的有效性.四叉树[8]作为一个有效的方法,应用广泛,已有许多分块的准则,这里采用四叉树的方法对图像分块.根据前述分析,分块的一个主要依据就是分块的纹理信息,而方差是反映图像纹理信息丰富与否的一个重要标志,且计算简单.为了降低计算复杂度简化计算,本文以方差作为判断标准,如下式.Page5其中,μ=1分块规则为:预先设定方差阈值σ0和最小分块图像大小M,计算图像I的方差σ:若σ>σ0且图像大小大于M,则一分为四,对4个子图像再分别考虑;若σ<σ0或子图像大小小于M,则停止不再分,这样循环进行下去.经过这个循环将图像根据图像内容分成大小不同的子块图像.本文算法中选择M=8,方差阈值σ0由最小分块图像的最大方差确定,如图4所示是Barbara和Lena图像按照本文方法分割结果.2.4分数像素插值在选择最优的方向过程中,由于限制在一个网格内,需要知道分数像素位置的像素值,如行方向选择若为π/8方向,空心的像素点为分数像素,则需要进行插值运算获取.插值不能完全重构,会引入额外误差,并会在后续变换中进一步扩散,因此需要详细研究.现有的插值运算方法很多,但是注意到图像内容具有方向性,我们的目的是选择有效的方向,已有的自适应方法中插值运算利用周围固定相邻的像素[7],会破坏图像原来的方向信息,考虑保护图像的纹理信息,本文选择沿图像纹理方向的像素进行插值.以π/8方向的空心位置像素F(i+u,j+v)为例,我们仅利用π/8这个方向上的整数像素值来插值,选择π/8这个方向上的斜四边形,与空心位置相邻的4个整数像素A、B、C、D插值,如图5所示.此方法实现简单且不会破坏图像方向信息.F(i+u,j+v)=a1A+a2B+a3C+a4D(8)其中,ai为各点的加权系数,用A,B,C,D代表该点像素的灰度值.本文采用简单的模型a1=a3=0.3,a2=a4=0.2.2.5图像压缩基于图像纹理的自适应提升小波变换从经典小波发展而来,保留了小波的优良性能,可以借鉴经典小波压缩方法如JPEG2000中的一些思想.这里先用本文方法对图像进行变换,变换后的系数利用JPEG2000[9]中的EBCOT(EmbeddedBlockCodingwithOptimalTruncation)方法进行编码,方向信息利用自适应算术编码进行无损压缩,如图6所示.编码的策略和JPEG2000类似,从而保留了JPEG2000方法的优良性质,只是增加了方向信息编码部分.方向信息量相对于图像本身很少,所以增加的编码信息不多.显然,这种新的压缩方案的运算量要大于JPEG2000方法,因为在图像变换过程中需要事先确定每个块的方向,经典小波没有这样的方向选择过程,但是由于限定方向的个数为有限几个,通过研究前面的算法描述过程,可以定性地得出算法和经典小波变换计算量仍是一个数量级,没有显著的增加,而后面的实验结果将表明,添加了方向预测,图像表示和压缩的结果,在数值和视觉效果上相较于经典小波方法都有显著的提高.3数值实验这里通过一些实验来验证本文方法的有效性.以C语言实现本文方法,小波滤波器选择9-7小波.测试图像选择为Lena(512×512)、Barbara(512×512)、Woman(512×512)、Pic1(1024×1024)、Pic2(1024×1024),其中Pic1和Pic2是遥感图像.第1部分实验主要比较基于图像纹理的自适应提升小波变换对图像表示的稀疏有效性,主要从变换后的高频系数的平均幅度、高频能量、非线性近似性能几个方面,将本文方法和经典小波变换比较,从实验数据及实验图像视觉效果两方面比较方法的优Page6劣.图7显示了Barbara(512×512)经过经典小波和本文方法变换后的第一层高频部分,为了便于观察,将系数进行放大显示.其中图7(a)~(c)显示的是经典小波变换后第一层的LH、HL和HH对应的高频子图像,图7(d)~(f)显示的是经过本文方法变换后第一层对应的高频子图像.从Barbara图分解的高频部分比较可以看出,经典小波变换后高频部分图像轮廓仍十分明显,相关性较强,系数值较大,而本文方法变换后高频能量降低,高频图像中轮廓已经十分模糊,这正说明了本文方法充分利用方向信息,自适应于图像纹理,从而变换后高频纹理不显著,相关性降低.图7小波和本文方法变换第一层高频部分比较下面考虑变换后高频系数平均幅度和高频平均能量,主要比较变换后的第一层高频,对几幅测试图像比较本文方法和经典小波的实验结果,如表1所示.方法高频系数平均幅度Lena3.102.754.97×1063.67×106Barbara6.254.324.30×1061.87×106Woman4.924.181.76×1071.32×107Pic115.2714.523.51×1083.29×108Pic26.656.277.04×1076.48×107表1列出了第1层变换的高频子带(LH,HL,HH)能量和高频系数平均幅度的比较.可以看出基于图像纹理的自适应提升小波变换后高频信息能量得到了显著的减少,系数的平均幅度得到降低.如Barbara图,高频系数平均幅度从6.25降到4.32,降低了30.9%,高频能量从4.30×106降到1.87×106,降低了56.5%,其它测试图像也有较明显的降低.多幅图像的测试说明了本文方法对图像稀疏化表示相较于经典小波更加有效.特别是对纹理信息丰富图像,本文方法利用图像纹理特征的性质充分体现,效果更明显.M点非线性近似性质是图像展开效率的一个有效评价标准[10].所谓M点非线性近似,就是保留变换后系数绝对值最大的M个点,其余系数赋为0,用这些系数重构近似图像,其近似性质能够很好的说明图像变换的性能.设图像f,基函数集合为{gm}m∈N,fM为用M个系数对f的非线性近似其中,IM是具有最大幅度值〈f,gm〉的M个小波系数的下标集.这里用ηn[M]=f-fM/f来衡量近似效果.图8给出了Lena和Barbara图的非线性近似结果.图8(a)显示的是Lenaηn[M]值从0.19降低到0.18;图8(c)和(d)显示的是Barbara图在取M=N2/16情况下,小波变换和本文方法非线性近似的局部图像,ηn[M]从0.20降低倒0.14,两次实验的数值ηn[M]的比较分别都有了降低.而在视觉效果上,观察图8(a)、(b)显示的局部图像的细节纹理处,可以发现,经典小波变换的非线性近似在边缘处模糊严重,而本文方法在边缘处仍十分清晰,虽然近似的ηn[M]数值降低的不多,但是视觉效Page7果有了显著提高,明显优于经典小波.第2部分主要实验本文方法应用于图像压缩中,与经典小波压缩方法JPEG2000比较,从PSNR(峰值信噪比)和视觉效果两方面比较方法的优劣.表2列出了几幅测试图像经过本文方法和JPEG2000方法,在不同压缩比情况下解压重构图像的峰值信噪比.从实验结果可以看出,在PSNR(峰值信噪比)方面,对所有图像压缩结果而言本文方法略高于JPEG2000,如Woman图压缩结果的PSNR高出JPEG2000方法最多达到0.7db,遥感图像由于高频信息更加丰富,并且本文方法和JPEG2000方法相比增加了附加信息编码部分,PSNR提高不明显,如Pic1和Pic2的实验结果,提高约0.1dB.在视觉方面,比较图9中Lena图在0.25bpp和Pic1图在0.5bpp下压缩后解压重构图图9解压重构的局部图像JPEG2000本文方法4总结为了实现图像更加有效的稀疏表示,本文针对像的局部,图9(a)~(c)显示的是Lena的原图、JPEG2000方法和本文方法结果的局部图像,图9(d)~(f)为遥感图像Pic1的实验结果局部图,比较可以发现JPEG2000压缩后解压图像在纹理信息丰富处出现模糊现象,特别是边缘轮廓处,而本文方法局部纹理仍十分清晰,特别是在Pic1图像炮管处对比明显,其它图像情况类似,可见虽然本文方法对Pic1图压缩的PSNR比JPEG2000的提高不明显,但是图像的视觉效果却有显著提高,其它图像在PSNR和视觉效果上也都有提高.说明了本文方法表示局部纹理特征丰富的图像有效,纹理保护能力增强,具有小目标保持能力,视觉效果优于JPEG2000.在某些场合中局部小目标十分重要,如遥感图像的某些应用中,要保证压缩过程中不丢失小目标,这时本文方法就显得尤为重要.经典小波变换的不足,首先研究了一种基于矩阵偏差度的纹理方向预测方法,在此基础上提出了新型的基于图像纹理的自适应提升小波变换方法.结合小波变换思想,根据图像纹理信息,自适应的将图像分块,在局部子图像中自适应的选择小波变换方向,且保证局部变换的正交性质不变,结合提升变换格式,实现本文方法.分块图像边界处变换利用相邻块的像素,不会产生块效应,在图像插值过程中保护图像纹理,沿纹理方向插值得分数像素值.结合JPEG2000方法的压缩思想,将本文方法应用于图像压缩,方向信息利用算术编码,变换系数利用EB-COT编码.实验结果表明,本文方法变换后的高频Page8系数平均幅度和高频能量都得到了显著降低,非线性近似的能力显著增强,逼近图像的纹理清晰,对大多图像的压缩实验结果PSNR略优于JPEG2000方法,且纹理保护与小目标保持能力明显优于JPEG2000,视觉效果更好,有着广阔的应用前景.
