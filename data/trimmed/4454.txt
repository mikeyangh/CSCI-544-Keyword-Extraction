Page1可证安全的移动互联网可信匿名漫游协议周彦伟1),2),3)杨波1),2),3)张文政2)1)(陕西师范大学计算机科学学院西安710062)2)(保密通信重点实验室成都610041)3)(中国科学院信息工程研究所信息安全国家重点实验室北京100093)摘要文中提出了移动互联网下移动可信终端(MTT)的可信漫游协议,协议仅需1轮消息交互即可实现MTT的匿名漫游证明,远程网络认证服务器通过验证MTT注册时家乡网络认证服务器为其签发的漫游证明信息的合法性,完成对MTT相关属性的认证,同时保证了MTT隐私信息的安全性和匿名性.最后运用CK安全模型证明了协议是会话密钥安全的,在继承传统漫游协议身份匿名性和不可追踪性的同时,具有较高的安全性、抗攻击性和通信效率.关键词移动互联网;匿名漫游认证;可信认证;CK安全模型1引言线互联网向无线移动互联网演变,使得移动互联网已成为下一代网络发展的趋势.由于本地网络覆盖范围的限制,为满足移动用户的漫游访问需求所提出的各网络通信技术的快速发展,促使Internet由无类问题,推进了关于移动互联网关键技术———漫游Page2服务机制的研究.当用户漫游到家乡网络之外的外地网络时,漫游服务机制在确保漫游用户保持通信连接的同时,须完成漫游用户的身份合法性认证,因此漫游服务过程中身份认证是重中之重.网络技术的迅速发展,使得身份合法性认证已不再是判断用户安全的充要条件,而应在身份合法的同时关注终端平台是否可信,即终端平台的可信性已成为用户安全的必要条件之一.因此促进了可信计算(TrustedComputing)技术的兴起及发展.可信计算工作组(TrustedComputingGroup,TCG)发布可信平台模块(TrustedPlatformModule,TPM)规范[1]和移动可信模块(MobileTrustedModule,MTM)规范[2],旨在以硬件芯片为基础,构建安全、图1可信移动互联网下MTT的漫游通信模型由于在传统漫游通信机制中,家乡网络和外地网络的认证服务器之间就漫游通信服务会事先签订好通信协议,各网络均允许非本地用户的接入,但是,当且仅当漫游用户完全通过该网络认证服务器的认证后,才允许其接入.为了保护漫游通信过程中漫游用户的隐私信息,漫游认证机制在验证漫游用户身份合法性的同时,为用户提供了身份的匿名性和不可追踪性.然而,由于移动互联网的特殊性,移动互联网下的漫游协议在满足身份匿名性和不可跟踪性的同时,还需兼顾以下两个方面:(1)移动终端的计算能力和能量是有限的,为满足用户的移动需求,漫游协议应尽量减轻协议参与方的计算量,特别是降低移动终端的计算量.(2)由于无线网络具有相对较低的带宽,并且信道易出错,因此,漫游协议在降低消息长度的同时应减少协议的交互轮数.从本质上讲,安全漫游即是跨域的身份认证、平台可信性评估、密钥协商及用户的隐私保护等.国内外研究人员在漫游协议、跨域服务申请等方面进行了大量研究.可靠、可信的终端平台(其中TPM用于非移动终端,MTM用于移动终端),同时终端平台的可信安全机制保护了用户隐私信息和敏感数据的安全性.因此须在漫游认证消息中增加用户终端平台的可信性验证信息,即在可信计算环境下,完成可信终端的漫游服务.如图1所示,可信计算环境下的移动互联网主要由移动可信终端(MobileTrustedTerminal,MTT),家乡网络认证服务器(HomenetworkauthenticationServer,HS)和远程网络认证服务器(RemotenetworkauthenticationServer,RS)组成,同时还包括可信第三方移动互联网管理中心CA.图1所示为可信移动互联网下MTT的漫游通信示意图.文献[3]基于对称加密提出一种高效的具有用户匿名性的无线认证协议,并且运算量较低.文献[4]发现文献[3]的方案存在匿名性缺陷,在分析其缺陷的基础上提出基于公钥的改进方案,但改进方案的计算开销较大.文献[5]分别基于秘密分割和自验证公钥机制提出了两种匿名漫游协议,但是这两种协议都无法满足漫游用户的身份不可追踪性,仅仅具有身份匿名性.文献[6]在分析无线漫游机制安全需求的基础上,给出了设计匿名无线漫游机制的通用框架.在文献[6]对漫游通用框架的研究基础上,文献[7]基于Diffie-Hellman密钥交换和证书公钥机制进一步提出具体的无线漫游协议.由于在传统漫游通信中网络运营商两两之间需事先签订漫游协议,为了避免签订漫游协议而造成管理的不便,文献[8]基于代理技术就漫游过程的认证和计费问题提出了新的设计框架.在文献[9]中提出了一种基于身份的漫游协议,但该协议无法满足漫游用户的身份匿名性.为了实现多信任域间的漫游通信需求,文献[10]提出一种基于身份的多信任域认证模型,但该模型的计算量较大,推广性较差.文献[11]对基于Page3身份的匿名无线认证技术进行了研究,在现有技术的研究基础上提出了基于身份的匿名无线认证方案,该方案基于公钥完成家乡认证服务器与外地认证服务器间的身份合法性验证.文献[12]提出异构无线网络下的匿名认证和密钥协商协议,引入用户的临时认证身份和临时通信身份实现用户的身份匿名.文献[13]对异构网络通信实体进行抽象,建立通用的接入认证模型.文献[14]提出了一种适用于异构无线网络的匿名漫游协议,协议流程简化,且具有较强的匿名性.文献[15]在移动互联网下提出可信移动平台的接入机制,实现可信计算环境下可信移动终端的服务接入及漫游接入等.无论是传统的漫游协议[12-14],还是跨域服务申请[10-11,15],对漫游用户的身份认证原理都基本相同.当漫游用户向RS申请漫游时,由于RS并未掌握漫游用户的注册信息,因此RS需在HS的协助下完成对漫游用户的身份合法性验证,即RS将移动终端的漫游证明信息发给HS,由HS负责验证移动终端的合法性,而RS仅根据HS的验证反馈信息制定相应的决策,因此传统漫游协议或跨域服务申请往往需要2轮(移动终端RS,RSHS)的消息交互才能完成用户的漫游(或跨域)接入,可见在移动互联网下传统漫游(或跨域)机制中移动终端的计算负载较重,并且通信时延较大.针对现有方案所存在的上述不足,本文提出可证安全的移动互联网可信匿名漫游协议.该协议中,成功注册家乡网络后,MTT获得由HS签发的漫游证明信息;在申请漫游服务时,RS通过验证漫游证明信息的合法性,完成对MTT身份合法性和平台可信性(本文平台可信性即指平台的真实性和完整性)的验证,同时保证了MTT隐私信息的安全性,并且漫游过程仅需1轮消息交互即可完成漫游认证,由于漫游过程的消息交互轮数的减少,在提高协议执行效率的同时,降低了协议的通信时延.本文协议的特点:(1)安全性提高.本文协议实现了漫游过程对MTT的身份合法性和平台可信性的验证,保证了MTT身份的匿名性和不可追踪性;同时提高了其安全性,弥补了传统移动互联网接入认证协议在MTT漫游时安全性保护和平台可信性验证方面的不足.(2)通信时延降低.本文协议中消息交互轮数减少,减轻了MTT的计算负载,降低了通信时延,并提高了协议的执行效率.相较于传统漫游协议而言,本文协议更适用于在移动互联网络环境下使用.(3)兼容性强.本文协议即适用于可信环境下漫游用户的身份合法性及平台可信性验证,又适用于非可信环境下漫游用户的身份合法性鉴别.(4)应用广泛.本文的漫游认证策略可用于3G网络下移动用户的漫游通信及资费服务管理等应用场景,具有广泛的应用性.本文第2节提出移动互联网可信匿名漫游协议,详细介绍协议的执行流程和信息注销、远程失效等漫游认证的管理机制;第3节在CK安全模型下对本文协议的安全性进行形式化证明;第4节从匿名性、抗攻击性和工作效率等方面对本文漫游协议进行分析;最后是结束语.2移动互联网可信匿名漫游协议本文使用的相关符号定义如下:n是大素数;rA、SA是A随机选取的秘密数;IDA是用户A的身份标识;TIDA是HS为本地用户A生成的临时身份标识;为异或运算;‖为连接符;∈C表示从相应的集合中随机选取一个数;KSA是A的私钥;KPA是A的公钥;CertA是认证服务器A的身份证书;TA是A产生的时间戳;〈AIKPriv,AIKPub〉为安全芯片(TPM或MTM)的身份证明密钥对,Cert(AIKPub)为可信平台的AIK证书;KS-1A是A关于私钥KSA的求逆运算值,令KS-1AKPA=Q,其中Q为常数,即用户的私钥求逆运算值与其公钥的乘积为常数.本文使用的相关运算定义如下.E(k,m)和D(k,c)是对称密钥加密/解密算法;ENC(KS,m)和DEC(KP,c)是非对称密钥加密/解密算法;H(m)为标准散列算法;F(K,N)为带参数的密钥推导函数,其中K,N为相关参数.系统建立时,各认证服务器向管理中心CA注册,由CA负责管理各认证服务器的安全性及其他相关事宜,并协助各认证服务器完成会话密钥及会话标识的安全协商,同时CA向各认证服务器签发证明其身份的身份证书.MTT、HS和RS的公私钥对分别为{KPM,KSM}、{KPH,KSH}和{KPR,KSR},其中公钥对外发布;CA为HS和RS签发的身份证书依次为CertH和CertR.本文协议的安全性基于以下假设.假设1.各网络认证服务器均可信,既不会发Page4送虚假信息,也不会利用已掌握的MTT信息实施假冒攻击,更不会随意揭示MTT的真实身份.同时为本地MTT(即本地网络用户)建立漫游证明信息的注销列表,并对外提供注销列表的查询下载服务.假设2.各认证服务器获得由管理中心CA签发的证书,证书包含CA签名等信息,并通过安全途径向外公布其相关参数.即在CA的协助下,各网络认证服务器完成彼此间安全通信信道及信任关系的建立.保证消息时戳的新鲜性及同步性.组成:假设3.各认证服务器间的时间同步机制可移动互联网可信匿名漫游协议由以下两个阶段网络.第1阶段为注册家乡网络.主要完成HS与MTT间的身份合法性认证及HS对MTT平台的可信性验证,并且完成会话密钥的协商和漫游证明信息的分发,即完成MTT的合法性及可信性认证;第2阶段为安全漫游.基于漫游证明信息RS完成对MTT身份合法性和平台可信性的验证,即实现MTT的安全漫游接入.MTT首次基于漫游证明信息完成漫游申请后,在保证MTT身份匿名和不可追踪的前提下为实现高效、快捷的漫游身份认证,本文2.3节在首次认证的基础上给出重复漫游认证协议,利用哈希散列链的认证策略以减少漫游认证过程的计算开销和通信时延.2.1可信认证协议———注册家乡网络的注册,获得HS为其生成的漫游证明信息.MTT通过执行可信认证协议完成向家乡网络可信认证协议如图2所示,协议具体描述如下.(1)MTT向HS发送申请,申请注册本地家乡(2)HS收到注册申请后,执行以下步骤.①首先选取秘密随机数rH∈C[2,n-1],并计算DH=(rH+KSH)KPM,通过计算将秘密数rH安全擦除;②最后选择随机数SH,并生成时戳TH,然后发送消息给MTT.HS→MTT:ENC(KSH,sid‖IDM‖IDR‖IDH‖DH‖SH‖TH‖Nonce).其中sid为会话标识,时间戳TH和随机数Nonce保证了消息的新鲜性,并且Nonce可用于标记通信消息是否得到相应的回复.(3)MTT收到响应消息后,MTT执行以下步骤.①首先选取秘密随机数rM∈C[2,n-1],并计算DM=(rM+KSM)KPH,通过计算将rM安全擦除;②然后分别按式(1)、(2)计算与HS间的会话密钥K(M,H)和签名信息SIGM:K(M,H)=KS-1SIGM=ENC(KSM,sid‖IDM‖IDH‖③接着使用存储根密钥从安全芯片中读取身份密钥AIKPriv,并使用AIKPriv签名平台配置寄存器值PCRs和秘密随机数SH,按式(3)生成MTT的平台可信性验证信息TAI:TAI=SML‖Cert(AIKPub)‖SIGTPM(PCRs,SH)其中SML为完整性度量日志;Cert(AIKPub)为MTT的AIK证书;SIGTPM(PCRs,SH)=ENC(AIKPriv,PCRs‖SH);④最后计算E(K(M,H),TAI),并生成时戳TM和随机数Nonce,然后发送消息给HS.MTT→HS:ENC(KPH,sid‖IDM‖IDH‖IDR‖DM‖Nonce‖SIGM‖TM‖E(K(M,H),TAI)).(4)HS收到验证请求后,执行以下步骤.①首先验证签名SIGM的合法性及参数的正确性,实现对MTT的身份合法性验证,并且验证消息是否由MTT发送;②身份合法性验证通过后,按式(4)计算会话密钥K(M,H),并使用K(M,H)和AIKPub分别解密E(K(M,H),TAI)和SIGTPM(PCRs,SH))获得MTT的可信性验证信息及平台配置寄存器值PCRs,同时通过秘密数SH完成对可信性验证信息的合法性验证:③最后运用平台可信性验证策略对MTT平台的可信性进行验证.文献[15-19]对平台可信性验证策略及相关关Page5键技术进行了详细研究,本文使用相关策略实现对MTT的平台可信性验证.篇幅所限,本文不再赘述终端平台的可信性验证策略.若MTT平台的可信性验证失败,则终止协议,否则HS为身份合法且平台可信的MTT分配唯一的临时标识号TIDM,并生成漫游证明信息.MTT的身份合法性及平台可信性验证通过后,HS执行以下步骤:(1)HS为MTT分配临时身份标识.HS首先生成秘密随机数SMTT,然后按式(5)为MTT生成临时身份标识TIDM,同时建立MTT的注册信息项〈TIDM,SMTT,IDM,K(M,H)〉.(2)HS为MTT生成漫游证明信息.①首先计算密钥K1=F(K(H,R),0),K2=F(K(H,R),1),其中K(H,R)为认证服务器HS与RS间安全协商的会话密钥;②然后生成身份凭证AUTHEN=sidHR‖CertHS‖TIDM‖TE,其中TE为身份凭证的过期时间,sidHR为认证服务器HS与RS间安全协商的会话标识;③最后计算CR=E(K1,AUTHEN),PR=E(K2,(3)漫游证明消息生成后HS发送应答消息给MTT.①首先计算K3=F(K(M,H),0),K4=F(K(M,H),1),CH=E(K3,MMTT),PH=E(K4,sid‖CH);②然后按式(6)计算签名信息SIGH:SIGH=ENC(KSH,sid‖IDM‖IDR‖IDH‖TIDM)③最后生成时戳TH,并发送应答消息给MTT.HS→MTT:ENC(K(M,H),sid‖IDM‖IDR‖IDH‖TIDM‖SIGH‖CH‖PH‖TH).(5)MTT收到由安全信道发送的应答消息后,执行以下步骤.①首先解密应答消息,验证签名SIGH及参数的正确性,MTT验证HS身份的合法性,即MTT与HS间完成双向的身份合法性验证;②身份合法性验证通过后,计算K3=F(K(M,H),0),K4=F(K(M,H),1),并验证E(K4,sid‖CH)与接收到的PH是否相等,完成消息完整性及正确性验证;③消息完整性及正确性验证通过后,最后计算MMTT=CR‖PR=D(K3,CH),即MTT获得漫游证明信息MMTT.sidHR‖CR),生成漫游证明信息MMTT=CR‖PR.此时,MTT已成功注册家乡网络,并获得HS为其生成的漫游证明信息.2.2安全漫游协议———漫游远程网络漫游证明信息获得后,MTT通过执行安全漫游协议向远程网络申请漫游服务.MTT通过安全信道将接入请求发送给远程网络认证服务器RS,向RS申请漫游服务.安全漫游协议如图3所示,协议详细介绍如下.册.MTT执行以下步骤:MTT向RS发送漫游申请,向远程网络申请注(1)首先选取秘密随机数g,rM∈C[2,n-1],并计算DM=(rM+KSM)KPR,通过计算将秘密随机数rM安全擦除.(2)然后计算G0=H(g).(3)最后生成时戳TM,并向RS发送漫游申请.MTT→RS:ENC(KPR,sid‖TIDM‖IDH‖RS收到MTT的漫游申请后,RS执行以下IDR‖DM‖G0‖Nonce‖MMTT‖TM).步骤:(1)RS验证消息合法性及参数正确性.①计算K1=F(K(H,R),0),K2=F(K(H,R),1);②计算PR=E(K2,sidHR‖CR),验证PR与接收到的PR是否相等,完成申请消息的完整性和参数的正确性验证;③RS通过计算式(7)获得MTT的临时身份标识TIDM、HS的身份证书CertHS及漫游证明信息的过期时间TE.AUTHEN=D(K1,CR)=sidHR‖CertHS‖TIDM‖TE(2)RS验证漫游证明信息MMTT的真实性.注销;①查询MTT注销列表,验证MMTT是否已被②通过签名验证MMTT是否被篡改,基于当前时间与TE间的关系验证MMTT在当前时间是否有效;③验证MMTT的持有者是否是信息的申请者,判断TIDM=TIDM是否成立,验证sidHR和CertHSPage6中包含的位置信息是否一致,其中TIDM为漫游请求消息中MTT的临时身份标识;④验证CertHS的真实性、完整性及有效性.若上述验证均通过,表明MTT持有真实有效的漫游证明信息,则RS允许MTT的漫游申请.即RS基于漫游证明信息完成对MTT身份合法性和平台可信性的验证,否则终止协议.(3)RS在漫游认证列表中为MTT建立重复漫Exit(0);ENDIFIF(Check(Dnow,TE)==0)//检查MMTT是否过期//Check(Dnow,TE)==0表示MMTT在当前时间已过期,则结束该算法.其中函数Check()为时间比较函数,Dnow为当前时间,若Dnow大于LT则Check()返回0,否则返回1.游认证信息.若MTT是身份合法且平台可信的漫游申请者,RS执行算法1在漫游认证列表中为MTT建立重复漫游认证信息.建立重复漫游认证信息时,RS执行以下步骤:①首先遍历HS的注销列表,以验证漫游证明信息MMTT是否已被MTT注销;②然后验证漫游证明信息的合法性及有效性,确保MMTT是合法未过期的漫游证明信息;步骤①和②为可选步骤,在RS验证漫游证明信息MMTT的真实性时已完成上述步骤的验证,但在漫游认证列表中建立重复漫游认证信息时,为保证认证列表的绝对安全性,可选择重复执行.③接着遍历漫游认证列表,判断列表中是否已存在相同TIDM的漫游认证信息,若存在,则结束算法,避免重复建立;否则进行步骤④操作;④最后建立重复漫游认证信息〈TID=H(TIDM),G=H(G0),N,D,TIDM〉,其中TIDM为MTT的临时身份标识信息;G为认证散列值;N为MTT重复漫游申请次数;D为重复漫游认证信息的过期时间,且D=TE.算法1.漫游认证列表建立算法.输入:漫游认证信息MMTT、身份标识TIDM输出:漫游认证列表〈TID,G,N,D,TIDM〉BEGINIF(Traverse(MMTT,LCHS)==1)//检查MMTT是否被注销//Traverse(MMTT,LCHS)==1表示MMTT已被MTT注销,则结束漫游认证列表建立算法.其中Traverse()为列表遍历函数,LCHS为HS维护的注销列表,Traverse(MMTT,LCHS)表示遍历注销列表LCHS,若列表LCHS中存在MMTT则返回1,否则返回0.Exit(0);ENDIFIF(Traverse(〈,,,,TIDM〉,LRARS)==1)//检查认证信息是否重复建立.在漫游认证列表中查找是否存在用户TIDM的重复漫游认证信息〈,,,,TIDM〉,Traverse(〈,,,,TIDM〉,LRARS)==1表示漫游认证列表LRARS中存在具有相同TIDM的漫游认证信息,则结束漫游认证列表建立算法,避免数据的重复建立.其中LRARS为RS负责维护的漫游认证列表.Exit(0);ENDIF//建立重复漫游认证信息N=1;TID=H(TIDM);G=H(G0);D=TE;//初始化重复漫游认证信息的过期时间Add〈TID,G,N,D,TIDM〉into(LRARS);END(4)RS应答MTT的漫游请求.①首先选取秘密随机数rR∈C[2,n-1],然后计算DR=(rR+KSR)KPM,通过计算将rR安全擦除;②然后按式(8)计算与MTT间的会密钥K(M,R):③最后发送应答消息给MTT.TIDM‖IDH‖IDR‖DR‖TR‖Nonce)).步骤:RS→MTT:ENC(KPM,ENC(KSR,sid‖MTT收到RS的应答消息后,MTT执行以下(1)首先解密消息,验证消息的合法性,然后确认消息是由RS发送,并验证RS的身份合法性,确定RS是否是其议定的远程网络认证服务器,实现漫游认证过程中MTT和RS的双向身份认证;(2)最后按式(9)计算与RS间的会密钥K(M,R),完成漫游申请.2.3重复漫游协议MTT可基于漫游证明信息MMTT多次向RS申请漫游认证,RS通过MMTT的合法性完成对MTT的身份合法性及平台可信性的验证,这样在一定程度上降低了漫游认证的通信时延和MTT的计算负载.为实现高效、快捷的漫游认证过程,基于MTT的首次漫游匿名认证(将通过可信认证和安全漫游进行的漫游认证称为首次漫游匿名认证),本文提出重复漫游认证协议.MTT持认证散列值GI进行第I(0<IMax,Page7D(I)M=(r(I)时身份标识TID(I)GI=H(GI-1)TID(I)(3)生成时戳T(I)申请消息.IDR‖D(I)MTT→RS:ENC(KPR,sid‖TID(I)其中Max为RS设置的MTT重复漫游的最大次数)次重复漫游认证申请,具体申请过程如下.行以下步骤:MTT向RS发送重复漫游认证申请.MTT执(1)选取秘密随机数r(I)(2)按式(10)计算散列值GI,按式(11)计算临RS验证MTT重复漫游申请信息的合法性.(1)RS执行算法2验证重复漫游认证信息的①验证重复漫游认证信息〈TID(I)合法性.RS执行以下步骤:的存在性.RS遍历漫游认证列表LRA查找漫游认证信息〈TID(I)则进行步骤②验证;②验证重复漫游认证信息是否过期.RS查找漫游认证列表中MTT的认证信息GI是否过期,若过期则终止,否则进行步骤③验证;③验证漫游请求消息的合法性.RS查找漫游认证列表中MTT认证信息GI所对应的用户信息是否为TID(I)MTT已通过身份合法性和平台可信性的验证,进行步骤④操作,否则终止;信息〈TID,G,N,D,TIDM〉.④更新漫游认证列表中MTT的重复漫游认证算法2.重复漫游认证信息合法性验证及更新算法.输入:散列值GI和临时身份标识TID(I)输出:更新后的重复漫游认证信息〈TID,G,N,D,息〈TID(I)BEGINIF(Traverse(〈TID(I)//遍历漫游认证列表,查找是否存在重复漫游认证信Exit(0);ENDIFIF(Check(Dnow,D)==0)//漫游认证列表中已存在相应的漫游认证信息〈TID(I)M,GI,,,〉,Check(Dnow,D)==0表示重复漫游认证信息在当前时间已过期,则RS删除漫游认证列表中该MTT的相关重复漫游认证信息,其中D为漫游认证信息〈TID(I)M,GI,N,D,TIDM〉的属性.Deletethe〈TID(I)LRARS;Exit(0);ENDIF//更新认证信息的相关关联数据N=N+1;TID=H(TID);G=H(G);IF(Max<N)//该MTT的重复漫游认证信息已达到最大的重复认证次数,则RS删除其相关信息.DeletethemessageofMTTfromLRARS;Exit(0);ENDIF//更新漫游认证列表UpdatedLRARS;ENDRS可定期将漫游认证列表中已过期的重复漫游认证信息删除,确保列表遍历的高效性;同时由于身份信息的更新具有不同时性(RS先更新,MTT后更新),因此RS可在重复漫游认证信息中分别存储连续的两个用户身份散列值(TIDI-1,TIDI)和认证散列值(GI-1,GI),以防止更新算法意外终止而造成MTT重复漫游认证的失败.(2)RS向MTT发送漫游应答消息.RS执行下述步骤:①选取秘密随机数r(I)R=(r(I)D(I)②按式(12)计算与MTT间会密钥K(I)(M,R);③发送应答消息给MTT.RS→MTT:ENC(KPM,ENC(KSR,TID(I)IDH‖IDR‖D(I)执行以下步骤:MTT验证RS漫游应答消息的合法性.MTT(1)根据加密消息验证RS是否是其议定的远程网络认证服务器,实现重复漫游认证过程中MTT和RS的双向身份认证.(2)按式(13)计算与RS间的会密钥K(I)成重复漫游申请.Page8本节介绍信息共享、信息注销和远程失效等认2.4认证管理策略证管理策略.2.4.1信息共享各认证服务器间基于安全协商的会话标识和密钥建立安全的通信链路,各网络认证服务器间基于安全通信链路进行漫游证明信息注销列表、公钥和身份证书等信息的共享.因此,在本文协议中HS与RS间的安全通信及信息共享机制,在确保MTT安全漫游的同时,并未增加协议的执行负载.2.4.2信息注销MTT注册本地网络时,获得HS签发的漫游证明信息MMTT,此后,MTT即可持漫游证明信息向RS申请重复漫游.重复漫游过程中,MTT可自行向HS注销其漫游证明信息MMTT.当漫游证明信息MMTT遭泄漏或被攻击者获得时,MTT可向HS申请注销MMTT,根据注销申请,HS更新漫游证明信息注销列表中的相关信息,并且HS与RS间的数据共享机制,可使RS获知HS最新的注销列表信息,因此可确保攻击者无法通过泄密信息MMTT申请重复漫游.2.4.3远程失效MTT漫游进入远程网络后,若漫游证明信息MMTT过期失效,此时,当RS收到MTT的服务申请时,通过查询HS的信息注销列表判断MMTT是否已被注销,若MMTT未被注销,即MMTT未出现异常,则RS采用传统漫游机制,在HS的协助下完成MTT的身份合法性及平台可信性验证,并根据HS的验证结果制定相应的接入策略;否则拒绝MTT的漫游服务申请.2.4.4维护漫游认证列表各网络认证服务器定时遍历其所维护的漫游认证列表,将已过期但重复漫游次数未达上限的重复漫游认证信息进行删除,提高漫游认证列表的遍历效率.3安全性证明3.1CK安全模型CK安全模型中定义了理想模型AM和现实模型UM[20-22]两种攻击模型.理想模型AM表示认证的链路模型,在AM中攻击者是被动的,并且具有调用协议运行、查询会话密钥、暴露会话密钥、攻陷协议参与者以及测试会话密钥的能力,但是AM中攻击者只能忠实地传递同一消息1次,不能伪造、篡改或重放来自未被攻陷参与者的消息.现实模型UM表示未认证的链路模型,在UM中攻击者除能够执行AM中的所有攻击外,还具有伪造、篡改和重放消息的能力,则在UM中攻击者能够控制协议事件的调度和通信链路,同时还能够通过攻击者具体的攻击手段获知协议参与者存储器中的秘密信息.定义1[21].设Π是运行在AM中的n方消息驱动协议,Π是运行在UM中的n方消息驱动协议.若对于任何UM敌手U,始终存在一个AM敌手A使得两个协议的全局输出在计算上是不可区分的,则称协议Π在UM中仿真了AM中的协议Π.定义2[21].编译器C是一个算法,它的输入是协议的描述,输出也是协议的描述.若一个编译器C对于任何协议Π,均有协议C(Π)在UM中仿真Π,则这个编辑器称为认证器.因此,AM中的安全协议可由认证器转化为UM中的安全协议.定义3[21].会话密钥安全:若对于AM中的任何敌手A,当且仅当下列性质都满足时,该协议在AM中是会话密钥安全的.性质1.未被攻陷的参与双方完整执行协议后,参与者获得相同的会话密钥.性质2.敌手A进行测试会话查询攻击,它猜中正确会话输出值b的概率不超过1是安全参数范围内可忽略的任意小数.定理1[21].假设λ是一个消息传输认证器,即λ在UM中仿真了简单消息传输协议,假设Cλ是在λ的基础之上定义的一个编译器,则Cλ也是一个认证器.3.2AM中的漫游协议本文协议中,RS依赖MTT持有的漫游证明信息鉴别MTT的身份合法性及平台可信性.为简化协议证明过程,漫游协议的两个阶段分别抽象描述为协议δ和ε,其中δ为可信认证协议,ε为安全漫游协议.分别证明δ和ε是AM中会话密钥安全的密钥交换协议.协议δ描述如下:(1)注册请求.MTT向HS发送注册请求消息,消息中包含相关的身份标识{sid,IDM,IDR,IDH}.(2)注册响应消息.HS收到MTT的注册请求Page9后,选取秘密随机数rH∈C[2,n-1],然后计算DH=(rH+KSH)KPM.HS选择随机数SH后发送消息{ENC(KSH,sid‖IDM‖IDR‖IDH‖DH‖SH‖TH‖Nonce)}给MTT.(3)可信性验证请求.MTT收到HS的响应消息后,选取秘密随机数rM∈C[2,n-1],然后计算DM=(rM+KSM)KPH;MTT计算会话密钥K(M,H),并生成平台可信性验证信息TAI,最后发送消息{ENC(KPH,sid‖IDM‖IDH‖IDR‖DM‖Nonce‖TM‖SIGM‖E(K(M,H),TAI))}给HS.(4)可信性验证响应.HS首先验证MTT签名及其参数的正确性,实现对MTT的身份合法性验证,验证通过后,HS基于终端的平台可信性验证策略对MTT平台的可信性进行验证;然后为身份合法且平台可信的MTT分配唯一的临时标识号TIDM,并为其生成漫游证明信息MMTT;最后发送应答消息ENC(K(M,N),sid‖IDM‖IDH‖IDR‖TIDM‖SIGH‖TH‖CH‖PH)给MTT.协议ε描述如下.(1)漫游请求.MTT在可信认证协议阶段获得漫游证明信息MMTT=CR‖PR,MTT选取秘密随机数rM∈C[2,n-1],然后计算DM=(rM+KSM)KPR;MTT向RS发送漫游请求消息{ENC(KPR,sid‖TIDM‖IDH‖DR‖DM‖Nonce‖sidHR‖MMTT‖TM)}.(2)漫游响应.RS收到MTT的漫游申请后,首先验证消息及参数的正确性,通过漫游证明信息MMTT的合法性完成对MTT身份合法性和平台可信性的验证,然后选取秘密随机数rR∈C[2,n-1],并计算DR=(rR+KSR)KPM;最后发送漫游响应消息ENC(KPH,ENC(KSR,sid‖TIDM‖IDH‖IDR‖DR‖Nonce‖TR))给MTT.(3)MTT计算会话密钥K(M,R)=KS-1KSM)DR,完成漫游申请.定理2.当签名、非对称加密、对称加密等算法均安全且难解时,协议δ和协议ε在AM中是安全的.证明.在AM中,由于协议δ交互过程中消息参与者没有被敌手A攻陷,因此协议执行完毕时,MTT和HS得到没有篡改的密钥协商参数DM和DH,MTT按式(1)计算的会话密钥:K(M,H)=KS-1HS按式(4)计算的会话密钥:K(M,H)=KS-1H(rH+KSH)DM因K(M,H)=K(M,H),因此协议δ满足会话密钥安全的性质1.命题.敌手A能以概率Ρ0来区分会话密钥协商参数与一个随机数,非对称加密算法被攻破的概率上限为PENC.由于非对称加密等算法均安全且难解,则概率Ρ0和ΡENC都是可忽略.在本文协议中,敌手A只能通过攻破KPH和KSH的加密数据得到DM和DH,再对其进行相关运算得到会话密钥K(M,H).因DH以KSH加密传输,很容易被敌手A获得,因此攻击重点将在DM上,A只能通过攻破可信性验证请求消息获得随机数DM,则秘密随机数DM被敌手A攻破的概率为P0PENC,则DM不被攻破的概率为1-P0PENC.若敌手A能够获知随机数DM,则必有1-P0PENCP0PENC(P0PENC远远大于1-P0PENC)成立,即有P0PENC1忽略的,这与命题相矛盾.因此敌手A正确猜中会话密钥K(M,H)的概率不超过1参数范围内可忽略的任意小数,则协议δ满足会话密钥安全的性质2.综上所述,协议δ在AM中是会话密钥安全的.根据AM的定义可知,在AM中,由于敌手不能进行伪造、篡改和重放消息,因此敌手仅能真实地将合法参与者产生的消息转发,所以MTT和HS得到没有篡改的身份合法性及平台可信性验证信息,并安全协商了会话密钥K(M,H)和K(M,H),所以协议δ在AM中是安全的.3.3认证器构造造认证器.对于可信认证协议中MTT与HS间的认证信息流采用基于时间戳的签名认证器λSIG,T[23]详细证明了认证器λSIG,T的安全性和匿名性.如图4所示,签名认证器λSIG,T的具体交互过程同理可证协议ε在AM中是安全的.证毕.本文从HS认证MTT、RS认证MTT着手构Page10如下.(1)A产生时间戳TA,计算消息m的签名信息SIG(m,TA,B),发送消息〈m,SIG(m,TA,B)〉给B.(2)B收到A的请求消息后,首先验证时戳TA的新鲜性,然后验证消息签名SIG(m,TA,B)的正确性,当且仅当时间戳TA的新鲜性和签名信息SIG(m,TA,B)的正确性,验证均通过时,B认为A发送的消息是合法的,即B完成对A的认证.安全漫游时,RS基于MTT持有的漫游证明信息MMTT完成对其身份合法性及平台可信性的验证.为满足MTT对身份等隐私信息的保护需求,故MTT的漫游申请消息须经过相应的处理,既不能包含MTT的真实身份信息,又能够使RS完成对MTT身份合法性及平台可信性的验证,因此,在安全漫游协议中使用基于身份的匿名认证器λENC,TID,T文献[22]中详细证明了认证器λENC,TID,T的安全性和匿名性.如图5所示,匿名认证器λENC,TID,T的具体交互过程如下.(1)A注册获得临时身份信息TIDA,用B的公钥加密产生密文消息ENC(KPB,m‖TA‖TIDA),将临时身份TIDA和密文消息ENC(KPB,m‖TA‖TIDA)发送给B.(2)B接收到消息后解密密文消息,首先验证TIDA是否合法,然后检查时间戳TA的新鲜性.当且仅当身份TIDA的合法性和时间戳TA的新鲜性验证均通过时,B认为A发送的消息是合法的,即A通过了B的认证.3.4UM中的协议首先,将基于时间戳的签名认证器λSIG,T和基于身份的匿名认证器λENC,TID,T应用于本文AM中的协议.然后,在对协议可证安全性不影响的前提下,隐藏MTT的身份标识信息,实现MTT身份标识的匿名性,使攻击者无法获得MTT真实有效的身份信息.最后,应用相关的优化方法将UM中的协议进行优化,得到UM中的相关协议.如图6所示为UM中的协议δ和协议ε.文献[24]对优化方法进行了详细介绍,并在CK模型下已证明该优化过程并不影响协议的安全性.定理3.当签名算法、非对称加密算法、对称加密算法等安全且难解时,协议δ和协议ε在UM中是安全的,即本文协议是安全的漫游协议.证明.运用基于时间戳的签名认证器λSIG,T和基于身份的匿名认证器λENC,TID,T把协议δ和协议ε直接转化为UM中会话密钥安全的可信接入协议和安全漫游协议.由于协议证明过程中所采用的签名认证器λSIG,T和匿名认证器λENC,TID,T是可证安全的,所以根据CK安全模型自动编译得到UM中的协议δ和协议ε是可证安全的.同理可证重复漫游认证协议是可证安全的.4模型分析4.1身份匿名性4.1.1首次漫游认证在首次漫游认证时,由于漫游通信消息中MTT的真实身份IDM被其临时身份标识TIDM所代替,即漫游通信消息中并未包含MTT的真实身份.因为仅有HS掌握秘密数SMTT,所以漫游用户的真实身份IDM只有HS才能还原.本文匿名漫游协议中基于临时身份实现了用户身份匿名性的保护,确保了用户身份的机密性.同时在保证漫游认证用户身份匿名性的同时并未降低其安全性.漫游证明信息(扩充后的HS身份证书)仅能报告其漫游申请者的身份是否合法、平台是否可信,并未包含MTT的配置信息及其身份等隐私信息,即漫游证明信息具有身份匿名性,而身份匿名性的强弱取决于有效授权时间的长短,越短则匿名性越强,同时其身份匿名性是可控的,可控性依赖于漫游证明信息持有者的临时身份标识,仅允许漫游证明信息的申请者持其与远程网络认证服务器RS建立漫游服务.4.1.2重复漫游认证在重复漫游认证阶段,MTT的真实身份IDMPage11被其临时身份标识TID(I)任何真实身份信息;同时仅有身份合法且平台可信的MTT才能提供有效的TID(I)作为MTT的身份合法性和平台可信性鉴别凭证,更不会泄露MTT的任何身份信息.4.2身份不可跟踪性4.2.1首次漫游认证不同的MTT对应不同的TIDM且由互不相同的随机数SMTT计算产生,并且任何合法MTT均无法通过自己的TIDM计算其他MTT的ID号,当同一MTT多次向RS申请漫游时,每次均使用不同的临时身份标识TIDM,具有身份不可跟踪性.MTT将临时身份TIDM加密后传给RS,即实现用户真实身份IDM对RS的匿名性,又实现了对其临时身份的保护,增强临时身份的安全性;即便用户的临时身份TIDM遭泄露,攻击者也无法获知用户的真实身份,更无法将截获的临时身份与其他通信过程进行关联,无法实现对用户身份的监听.即临时身份生成过程中随机参数的使用确保了漫游用户的身份信息具有不可关联性,因此攻击者将无法通过用户身份对漫游通信进行跟踪.4.2.2重复漫游认证对于外部攻击者而言,在重复漫游认证阶段,虽然散列值间具有关联性,但是对散列值的加密传输,使攻击者无法获知散列值,因此外部攻击者无法对MTT的不同会话实施追踪攻击.对于RS而言在重复漫游认证时,为减少计算负载和通信时延,采用散列值作为鉴别凭证,因此RS可将MTT的多次会话联系起来,所以若MTT需要完全无关联的漫游匿名认证时,则MTT重复进行首次漫游匿名认证过程,此时RS和外部攻击者都无法基于身份实现MTT不同会话的关联.4.3安全性分析4.3.1安全会话密钥协商本文协议中,RS在实现对MTT身份合法性和平台可信性验证的同时,完成与MTT间会话密钥K(M,R)的协商,会话密钥由双方选择的秘密随机参数rM和rR共同决定,任何一方都无法伪造合法的会话密钥K(M,R),并且rM和rR的安全存储,保证了会话密钥的安全性;同时rM和rR的随机性,保证了会话密钥的新鲜性.4.3.2双向身份认证本文协议实现了MTT和RS间双向的身份合法性认证.首次漫游认证时,RS通过漫游证明信息的合法性完成对MTT的身份合法性和平台可信性验证.重复漫游认证阶段,RS通过散列值GI来鉴别MTT,由于散列值基数G0已通过RS的认证,根据散列函数的单向性计算特点,仅有已通过身份合法性及平台可信性验证的MTT拥有合法的G0,因此只有合法且可信的MTT才能出示正确、有效的GI.同样MTT通过RS的私钥签名信息可确认其身份的合法性,验证RS是否是其议定的远程网络认证服务器.4.3.3抗伪造性利用秘密随机数SMTT和身份信息通过散列函数计算临时身份TIDM,由SMTT的机密性和散列函数的安全性保证TIDM的不可伪造性.并且漫游通信消息中的随机数方便确认相关消息是否得到相应的回复,同时可防止攻击者进行重放攻击.4.3.4漫游证明信息的保密性HS运用其与RS间的共享密钥K(H,R)计算密钥K1和K2,然后使用K1和K2封装平台可信性证明信息CR和PR,K(H,R)的私密性保证了漫游申请过程中证明信息CR和PR的安全性,除RS外其他任何认证服务器及用户都无法获知漫游证明信息.4.3.5抗攻击性攻击性.从抗中间人攻击和平台替换攻击分析协议的抗(1)抗中间人攻击假设U是主动的攻击者且知晓MTT与HS间会话密钥协商过程的所有公开参数及相关算法,U对MTT的漫游过程进行中间人攻击.如图7所示,MTT、HS和攻击者U获得相关参数后分别计算相应的会话密钥:MTT计算的会话密钥(MTT认为是其与HS间的会话密钥):K(M,H)=KS-1HS计算的会话密钥(HS认为是其与MTT间的会话密钥):攻击者U分别计算它与MTT和HS间的会话密钥K(U,H)和K(M,U):K(U,H)=KS-1K(M,U)=KS-1因为K(M,H)≠K(M,U)和K(M,H)≠K(U,H),攻击者U无法对密钥协商过程进行中间人攻击,即使U通Page12图7攻击者进行中间人攻击过窃听获得密钥参数DH和DM,但由于无法获知秘密参数SK-1K(M,H)的窃取,即使U在攻击过程中使用相同的参数(即rUU=rU),上述结论依然成立.MTT与HS间会话密钥K(M,H)的安全性确保攻击者无法获知漫游证明信息,同时保证漫游证明信息申请过程的安全性.(2)抗平台替换攻击用户A和B都是合法用户,其中PA是可信平台,PB为非可信平台,且A与B、B与RS间分别建立了安全信道.A、B分别控制平台PA和PB.若用户B通过非法手段获得用户A的漫游证明信息MMTT后,持MMTT向RS申请漫游服务,因漫游证明信息MMTT中封装了用户A的临时身份信息TIDA,由于B无法提供正确的临时身份标识,导致其无法持MMTT向RS证明其身份的合法性及平台的可信性.在漫游证明过程中,通过临时身份标识将漫游证明信息与平台身份进行了绑定,因此外部攻击者无法对本文协议进行漫游证明信息的替换攻击.文献[25]详细介绍了平台替换攻击的攻击过程.4.4性能分析4.4.1计算效率在本文协议中,由于首次漫游认证过程中漫游证明信息具有一定的时效性,漫游认证时MTT已成功注册家乡网络,并申请获得漫游证明信息,所以HS不参与MTT的漫游认证,因此在表1运算开销比较中不包含注册阶段的计算开销.同时由于传统加法和乘法等运算计算量较少,所以表1运算开销比较中未统计上述算法的计算开销.本文协议中,首次漫游认证阶段MTT仅需进行3次非对称加密运算;RS进行2次对称加解密运算和3次非对称加解密运算.重复漫游认证阶段MTT仅需进行2次Hash运算和3次非对称加密运算;RS只需进行3次非对称解密运算和2次Hash运算.重复漫游认证过程RS对MTT身份合法性及平台可信性的验证步骤较少,在减少通信时延的同时可提高漫游认证的执行效率.如表1所示为本文协议与其他相关方案[10-15]中各实体运算开销比较.与对比方案[10-15]相比,本文协议中各参与者的计算负载较低,特别是减少了漫游认证过程中RS与HS间的消息交互轮数,即无需HS的协助,通过1轮消息交互RS就可完成对MTT的身份合法性及平台可信性验证,消息交互轮数的减少,降低了漫游协议的通信时延.从表1数据来看,本文协议中MTT的计算量远小于文献[10-12,15]中相关方案的计算量,并延续了部分传统漫游认证协议[13-14]中MTT计算量小的优势,在本文协议中,RS通过1轮消息交互即可完成对MTT的身份合法性和平台可信性验证,并且Page13表1漫游认证过程各实体的运算开销比较Hash运算(MTT/HS/RS)0/0/22/0/2☆2/1/11/0/13/1/02/1/15/4/6对称加解密(MTT/HS/RS)0/0/20/0/02/4/21/1/00/0/11/1/12/1/12/0/2非对称加解密(MTT/HS/RS)3/0/33/0/33/3/21/1/22/2/12/1/10/3/30/1/1MAC次数(MTT/HS/RS)信息交换次数(MTT-RS/RS-HS)2/02/02/22/23/23/22/23/2注:表中“☆”表示该方案未涉及此操作.未使用计算量较大的指数运算.因此本文协议在未增加RS计算负载的基础下,减少协议的消息交互轮数,降低了通信时延,提高了协议的执行效率.由于仅能在安全性与计算开销间寻求平衡,因此为了确保移动终端通信过程的安全性,本文协议使用了非对称加解密、对称加解密等运算量较大的算法.但在实际应用中,可根据应用环境的特点减少通信消息的加密操作.本文协议的漫游过程中,为保证通信消息的安表2漫游通信时延比较本文协议文献[10]文献[11-15]注:文献[10-14]中漫游用户为移动终端(MT),本文方案和文献[15]中漫游用户为可信移动终端(MTT).本文协议中,因MTT在向远程网络申请漫游前,已完成本地网络的注册工作,获得漫游证明信息,则MTT申请漫游时,无需HS的协助RS即可直接完成对MTT的合法性验证.因此MTT与RS间通过1轮消息交互即可完成漫游申请,时延远远低于其他传统漫游[12-14]或跨域方案[10-11,15],降低了漫游过程的通信负载和切换时延,提高了移动互联网漫游切换速度和漫游协议的执行效率,并且在重复漫游认证阶段实现MTT高效、快捷的安全漫游.4.5扩展性如图8所示,本文协议的漫游认证原理可适用于3G网络环境下移动用户(MobileUser,MU)的网间漫游(区域性漫游和国际漫游)通信及资费服全,RS将应答消息经加密处理后发送给MTT,若RS与MTT间基于安全链路通信时,RS的应答消息则无需加密,此时MTT的只需执行1次非对称加密算法即可完成漫游,降低了MTT的计算负载,提高了协议的执行效率.4.4.2通信效率表2所示为本文协议与其他相关方案[10-15]就通信时延和漫游特点等方面的比较结果,其中通信时延的大小以消息交互轮数为依据判断.RS通过MTT持有的漫游证明信息直接验证其身份的合法性及平台可信性.RS在HS的协助下完成对MTT身份合法性的验证,并且通过KGC完成会话密钥的协商.RS在HS的协助下完成对MTT身份合法性的验证.务,MU持归属网络认证服务器HS签发的身份证明信息向漫游网络认证服务器RS申请漫游接入,RS为MU提供服务且收取费用,若MU每漫游移动1次就缴费1次,将带来诸多不便,因此在MUPage14漫游身份认证过程中,RS基于本地网络的身份证明信息验证MU的合法性,并为其提供服务,RS直接向HS收取MU的漫游服务费用,HS再统一向MU收取,因漫游过程中MU持身份证明信息向RS证明其身份合法性及平台可信性.由于MU向RS提供的身份证明信息中包含签名、身份标识等信息,因此MU无法否认因漫游而产生的费用.在3G网络中使用本文漫游原理,可降低MU漫游过程中由于身份验证、计费等造成的通信时延,提高MU的通信效率.4.6兼容性本文漫游协议不仅可完成可信移动互联网下MTT的漫游认证工作,同时可在传统网络(非可信计算环境)中完成移动终端(MobileTerminal,MT),的漫游服务请求.MT的漫游请求消息中仅包含用户的身份合法性验证信息,即MT通过漫游证图10MT漫游通信过程其中,阶段1主要完成MT与HS的双向身份合法性验证,并且HS为身份合法的MT签发漫游认证信息;阶段2中MT生成漫游认证信息{CR‖PR}向RS申请漫游服务,RS基于{CR‖PR}的合法性完成对MT的身份合法性验证,为身份合法的MT授权漫游接入服务.5结束语传统漫游认证协议无法满足可信计算环境下移动可信终端漫游服务时的平台可信性认证需求,本文提出移动互联网可信匿名漫游协议.移动可信终端申请漫游服务时,远程网络认证服务器通过验证家乡网络认证服务器生成漫游证明信息的真实性及有效性,完成对移动可信终端的合法性验证.采用临时身份实现用户的匿名性保护,不仅使远程网络和明信息向RS仅证明其身份的合法性.因此本文漫游协议具有强兼容性.可信计算环境下,HS通过身份验证信息和平台可信性验证信息,验证MTT身份的合法性和平台的可信性;而在传统非可信计算环境中,MT仅发送身份验证信息,HS只验证MT的身份合法性.MTT和MT漫游通信请求的数据结构如图9所示.非可信计算环境中移动终端的具体通信过程如图10所示.攻击者无法获知用户的真实身份,而且保证了用户身份和位置等隐私信息的机密性;同时攻击者无法将截获的临时身份与已有的通信信息相关联,确保用户身份和位置等隐私信息的不可跟踪性,有效防止攻击者针对用户实施跟踪、窃听等攻击行为.本文协议在实现可信漫游的同时并未降低安全性,同时具有匿名性、扩展性等特点.下一步将在本文协议的基础上继续深入对轻量级漫游认证机制的研究,争取在满足匿名漫游认证安全性的基础上降低移动终端的计算负载.致谢评审专家对稿件进行了细致审阅,各位编辑付出了辛勤劳动,在此表示感谢!
