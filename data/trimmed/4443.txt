Page1基于主-备关系的PMIPv6区域移动锚点容错方案张瀚文1)许智君1),2)张玉军1)李忠诚1)1)(中国科学院计算技术研究所北京100190)2)(中国科学院大学北京100049)摘要代理移动IPv6(PMIPv6)是IETF提出的基于网络的区域移动管理协议.在PMIPv6系统中,区域移动锚点(LMA)是维持移动节点(MobileNode,MN)在PMIPv6域内不同接入链路间移动过程中可达性的关键实体.文中针对PMIPv6中LMA的单点故障问题,提出一种基于主-备关系的区域移动锚点容错方案(LMAFT).方案在PMIPv6域内部署多LMA,并建立一一对应的主-备关系,通过LMA间自组织状态管理实现容错.方案设计了双向有效性检测机制,实现主、备LMA间快速的失效检测;LMA服务迁移机制支持失效实体全部服务迁移和过载实体部分服务迁移,实现容错的同时支持多LMA负载均衡.理论分析和仿真实验结果表明,LMAFT方案可将LAM容错时间控制在50ms~350ms.当容错时间控制在100ms以下时,可完全避免LMA失效对移动节点MN的TCP应用造成的影响;最差情况下,也可在LMA失效发生后的1s~2.7s内快速恢复相关MN的TCP应用吞吐量.对于UDP应用,LMAFT方案可在LMA失效发生后2s内恢复相关MN的收包率.关键词代理移动IPv6;区域移动锚点;可靠性;容错1引言代理移动IPv6(ProxyMobileIPv6,PMIPv6)协议[1]是IETF制定的无需终端参与的、基于网络的区域移动管理协议.利用该协议,未经修改的任意IP节点在一定管理域内,都可在不同接入路由器间移动而无需改变其IP地址.目前PMIPv6协议已被多种通信技术标准(3GPPSAE、WiMAX等)所采用,成为多种通信网络建设中实现区域移动管理的首选技术方案.在PMIPv6系统中,区域移动锚点(LocalizedMobilityAnchor,LMA)是PMIPv6域内所有MN的路由锚点,是维持MN在域内不同接入链路间移动过程中可达性的关键实体,承担两方面的功能:维护MN在PMIPv6域内的位置信息,即MN当前附着的移动接入网关(MobilityAccessGateway,MAG);通过与LMA-MAG间的双向隧道为MN转发数据包.作为PMIPv6系统中最重要的基础设施,LMA同时也是系统单点故障隐患所在.LMA失效将导致整个PMIPv6域的移动管理服务失效,处于该域内的所有MN将失去可达性.PMIPv6协议明确指出应在一个PMIPv6域内部署多LMA以支持容错,但并未定义具体容错方案.即使实现多LMA部署,PMIPv6协议本身也是不具备LMA容错能力的.这是因为:PMIPv6协议的设计原则是移动管理服务完全由网络实现,无需MN参与.遵循这一设计思想,PMIPv6系统中的移动管理实体对MN是不可见的.因此,MN由于当前服务LMA失效而失去网络连接时,不可能通过可用LMA发现和重配置选择新的LMA恢复网络连接,这些MN甚至根本无法获知导致其失去连接的原因是LMA失效.PMIPv6实际部署和运营要求解决LMA单点故障问题,保障系统可靠性.本文首次提出一种基于主-备关系的LMA容错方案,解决了PMIPv6系统中的LMA单点故障问题,使得某LMA失效后,系统仍能提供既定服务.本文第2节对相关研究现状进行介绍和分析;第3节提出基于主-备关系的LMA容错方案;第4节和第5节分别通过理论分析和仿真实验,从LMA容错时间、不同应用下的LMA容错性能、LMA容错开销等方面,对方案进行定量评价;最后总结全文.2相关工作目前针对PMIPv6的研究主要集中在路由优化、性能评价、多穴支持、PMIPv6-MIPv6交互等方面[2-8].PMIPv6可靠性技术方面的研究工作尚处于起步阶段.文献[9]提出PMIPv6心跳机制实现MAG和LMA之间相互的可达性检测.文献[10]针对PMIPv6中另一关键移动管理实体移动接入网关(MAG),提出容错方案.然而针对PMIPv6移动锚点LMA的容错方案还有待进一步研究.另一方面,PMIPv6中的LMA和MIPv6[11]中的家乡代理(HomeAgent,HA)分别是维持MN在区域范围微移动和全局范围宏移动过程中可达性的移动锚点,二者在功能上具有相似性.MIPv6中的HA容错方法研究已取得了一系列研究成果[12-15],这些成果中的某些思想可被借鉴用于解决PMIPv6实体容错.然而,LMA和HA在功能实现原理及部署方式上存在以下差异,使得HA容错方案无法直接应用于LMA容错:(1)MIPv6是基于主机的移动管理方案,HA容错方案的设计需要考虑多HA对MN的呈现形式及容错过程对MN的透明性;而PMIPv6是基于网络的移动管理方案,LMA对MN是不可见的,其容错方案无须考虑多LMA对MN的呈现形式.(2)MIPv6中多HA部署于同一家乡链路,可以引入集中的管理实体对多HA进行合理组织,实现高效容错;而在PMIPv6网络中,家乡链路只是逻辑上的概念,多LMA部署于不同物理链路,对多LMA采用集中管理,相关处理延时将很大,且将引入大量管理开销.对于LMA容错,应考虑基于LMA间的自组织方式,实现实体状态管理和失效实体的服务恢复.(3)MIPv6中,仅有实体HA维护MN的移动管理信息,现有HA容错方案大都基于HA间的信息备份实现失效HA的快速服务恢复.而LMA容错不宜采用基于信息备份的方法,原因如下:首先,多LMA部署于不同链路,而LMA作为多个MAG的汇聚点,维护的信息量大且更新频繁,难以实现LMA间的信息实时同步,且会在不同链路间引入大量同步开销;其次,PMIPv6中LMA和MAG维护一致的移动管理信息,LMA失效后,其服务接管实体可从MAG处获得相关信息.(4)HA和LMA的路由锚点功能实现方式不Page3同:HA为MN分配家乡地址HoA,这些HoA地址的前缀为HA的拓扑前缀,HA通过在本地链路为移动到外地的MN广播代理邻居宣告消息,将其HoA绑定到自己的物理地址,从而实现为MN截获并转发数据包的功能;而LMA则为各MN分配独立的家乡网络前缀(MN’sHomeNetworkPrefix,MN-HNP),并通过对外宣告MN-HNP为MN建立路由.移动代理功能实现方式的不同,使得两种实体失效后的服务接管方式也不可能相同.(5)MIPv6中,HA是唯一移动管理实体,容错过程不涉及其他实体;而PMIPv6中,LMA和MAG共同实现对MN的移动管理,LMA失效后的容错处理需要与对端实体MAG交互.3基于主-备关系的LMA容错方案本文提出一种基于主-备关系的LMA容错方案(LMAFault-Tolerantmethodbasedonprimary-standbyrelationship,LMAFT),使得PMIPv6域内某LMA失效时,在无需MN参与的前提下,由网络快速实现LMA失效检测和失效LMA的服务接管,恢复对failure-affected-MN(原本由失效LMA所服务的MN,后文简称fa-MN)的服务,减小对fa-MN上层应用造成的影响.LMAFT系统结构如图1所示,在PMIPv6域内部署多LMA,并建立一一对应的主-备关系,通过LMA间自组织的状态管理实现容错.备-LMA(standby-LMA,后文称s-LMA)负责对所支持的主-LMA(primary-LMA,后文称p-LMA)进行主动的有效性检测和失效后的服务接管.LMAFT的实现包括LMA主-备关系动态建立、失效检测和服务迁移3个关键过程.3.1LMA主-备关系动态建立各LMA本地维护一LMA列表(LMAList,LMAL),记录PMIPv6域内所有LMA的优先级、当前状态(“有效”或“失效”)、主-备关系等信息.LMA在系统初始化、失效重启恢复、或其当前s-LMA失效时,通过LMA主-备关系动态建立过程(如图2),在域内选择唯一LMA配置为s-LMA.(1)LMAi根据本地LMAL所维护的域内所有LMA信息,从当前“有效”LMA中,选择优先级最高且已支持p-LMA数目最少的一个作为候选s-LMA(图中以LMAj为例).(2)LMAi向LMAj发送主-备关系建立请求(PSRSR).(3)LMAj接收PSRSR消息后,根据自身状态或其他可选本地策略判断是否接受请求.若接受,则在本地LMAL中更新请求发送者LMAi表项中的主-备关系信息.(4)LMAj向LMAi回复主-备关系建立应答(PSRSA)消息,指示接受或拒绝主-备关系建立请求,可选的指示拒绝原因.(5)LMAi接收PSRSA后,若消息指示拒绝请求,则回到步(1),选择新的候选s-LMA重新执行此过程;若消息指示接受请求,则在本地LMAL中更新自己的主-备关系信息,并执行步(6).(6)LMAi向域内其他LMA发送主-备关系建立通告(PSRSN)消息,宣告新配置的s-LMA.(7)其他LMA接收到PSRSN消息后,在本地LMAL中更新LMAi的主-备关系信息.3.2LMA失效检测LMAFT中,各LMA与其s-LMA需相互进行有效性检测,当LMA检测到其s-LMA失效,需配置新的s-LMA;当LMA检测到它所支持的某p-LMA失效,需接管失效LMA所服务的所有fa-MN.为减小容错方案引入的信令开销,LMAFT设计实现了双向的有效性检测机制(如图3所示),其Page4基本思想是:s-LMA作为主动检测方,其支持的p-LMA作为被动检测方;s-LMA以间隔时间Ihb(心跳间隔时间HEARTBEAT_INTERVAL)周期性地向p-LMA发送心跳请求(HeartbeatRequest,HReq);双方各为对端维护一心跳定时器TO和丢失心跳消息计数器nmhb;双方一旦接收到对端发送的HReq,若消息序列号大于上一接收消息,需回复相应的心跳应答(HeartbeatResponse,HRsp).对于主动方s-LMA:周期性发送HReq,在发送前将对端维护的nmhb增1后判断nmhb是否已增至心跳消息允许丢失数目Nmh,若nmhb==Nmh则判断对端失效,若nmhb<Nmh才向对端发送HReq;s-LMA发送HReq后将对端维护的TO重置为Ihb;每当收到对端回复的HRsp,将其nmhb置0.对于被动方p-LMA:每当接收到端s-LMA发送的HReq后,首先将其维护的nmhb置0,并将其维护的TO重置为Ihb,之后回复HRsp;当定时器TO到期,将对端的nmhb增1,若nmhb值达到Nmh,则向对端s-LMA主动发送一HReq,重置定时器TO为略大于Ihb的值(Ihb+Δ),若TO到期,仍未接收到s-LMA的应答则判断其失效.s-LMA一旦检测到p-LMA失效,就作为接管实体发起LMA服务迁移过程,接管其服务的所有MN;并向域内所有其他LMA发送失效通告消息(LMAFailureNotify,LFN),通告p-LMA失效;各LMA接收LFN后,在本地LMAL中更新失效LMA状态.p-LMA一旦检测到s-LMA失效,则发起LMA主-备关系动态建立过程,配置新的s-LMA.失效检测过程中,p-LMA可能接收到其他LMA发送的LFN消息,通告其s-LMA失效,此时p-LMA停止检测过程,直接触发LMA主-备关系动态建立过程.3.3LMA服务迁移LMA服务迁移机制,针对失效或过载LMA分别实现全部或部分服务迁移(如图4).对于失效LMA服务迁移:失效LMA的s-LMA检测到其失效后,将作为接管实体(takeover-LMA,t-LMA)触发服务迁移过程,向域内所有MAG通告失效LMA,并从fa-MN当前附着的MAG获取移动管理信息,接管所有fa-MN.对于过载LMA服务迁移:处于“过载”状态的LMA将根据本地LMAL所维护的各LMA状态,选择某LMA,向其发送负载迁移请求.被选LMA若接受请求,则作为t-LMA发起LMA服务迁移过程,接管“过载”LMA的部分负载.LMA服务迁移机制具体实现如下:(1)t-LMA触发LMA服务迁移过程:触发事件:t-LMA检测到LMA失效;或LMAPage5过载,请求将部分负载迁移至t-LMA.步(2)仅在p-LMA过载触发的LMA服务迁移场景下发生.(2)LMA与t-LMA间上下文传递迁移MN的移动管理信息,双方可协商迁移MN数目等信息.(3)t-LMA向相关MAG发送LMA服务迁移通告(LMAServiceSwitchingNotify,LSSN):①LMA失效触发的服务迁移,则向域内所有MAG发送;LMA过载触发的服务迁移,则仅向待迁移MN当前附着的MAG发送,并在消息中携带待迁移MN标识;效或LMA过载.②通告消息中携带原LMA标识;③LSSN消息指示服务迁移触发原因:LMA失(4)MAG查找需迁移的MN:①MAG接收到LSSN消息,若消息表示迁移触发原因为LMA失效,则在本地LMAL中将失效LMA的状态置为“失效”;②MAG从LSSN消息中获取迁移MN标识(过载LMA部分服务迁移场景下);或根据失效LMA标识在本地绑定的更新列表(BUL)中查找需迁移MN(fa-MN),若未查找到需迁移MN,则不再进行后续处理.(5)MAG锁定待迁移MN的BUL(可选步骤):步(6)~(13)的迁移过程中,MAG暂存会导致MN的移动管理信息改变.(6)MAG向t-LMA发送LMA服务迁移请求(LMAServiceSwitchingRequest,LSSR):若MAG先前接收到的LSSN指示迁移触发原因为LMA失效,则LSSR中携带待迁移MN的移动管理信息.提供移动管理服务.(7)t-LMA接收处理LSSR:若接受LSSR,t-LMA创建或激活待迁移MN的代理绑定缓存项(PBCE);对外宣告迁移MN的MN-HNP;为其隧道转发数据包.(8)t-LMA向MAG回复LMA服务迁移应答(LMAServiceSwitchingRequest,LSSA),指示服务迁移结果.步(9)、(10)仅在LMA过载触发的服务迁移场(9)t-LMA向LMA发送LSSAck,指示服务迁(10)LMA删除迁移MN的PBCE,停止为其景下发生.移结果.新为t-LMA,并解锁迁移MN的BUL.(11)MAG在BUL中将迁移MN的LMA更(12)MN信息同步(可选步骤):若服务迁移过程中MAG缓存了导致MN移动管理信息改变的事件信息,在迁移完成后,MAG根据上述缓存信息修改MN的BUL并上报给t-LMA,保证MAG和LMA维护的移动管理信息一致.4LMAFT方案性能分析本节和下一节通过理论分析和系统仿真,从LMA容错时间、不同应用下的LMA容错性能、容错开销等方面,对LMAFT方案进行定量评价.LMAFT性能分析网络模型如图5所示,表1为相关参数说明及其经验值[16-17].参数tmrMN与基站或无线接入点(BS/AP)间的无线链路传输trmBS/AP到MAG的单项传输延时,2ms~5mstmmMN与MAG间的传输延时,tmm=tmr+trmtmlMAG与LAM间的单项传输延时,10ms~30mstllLAM间的单项传输延时,tll=tml,10ms~30mstclCN与LAM间的单向传输延时,40ms~50ms4.1LMA容错时间分析LMAFT中,LMA容错时间TLMA测时间TLMA如图6所示,s-LMA(LMAj)以间隔时间Ihb向其p-LMA(LMAi)发送HReq消息,检测有效性.设p-LMA失效发生在s-LMA向其发送第i次和第i+1次HReq的间隔周期内.从ti+1开始,s-LMA每次向p-LMA发送HReq前都会将本地维护的nmhb(i)值增1,直到ti+Nmh,nmhb(i)值达到Nmh,s-LMA判断p-LMA失效.令θ表示p-LMA失效发生到s-LMA下一次发出HReq的时间,那么θ服从[0,Ihb]均匀分布.失效检测时间为TLMAPage6忽略节点处理时间,服务迁移时间为TLMAft]=(Nmh-1/2)×Ihm+2tmlLMA容错时间及其均值为TLMAft=TMAGE[TLMA图7为LMA容错时间均值E[TLMA隔周期Ihb和允许丢失心跳消息数目Nmh的变化情况,其中tml=20ms时.E[TLMANmh越大,E[TLMA错时间,应尽量减小Nmh.然而Nmh过小将使得失效判断的准确率低,尤其在链路拥塞或丢包率较高的情况下,Nmh的一般取值为2~5.Ihb是影响E[TLMAft]的另一重要参数,Ihb越小,心跳消息发送频率越高,失效检测更快速,容错时间随之减小,Ihb的取值一般在50ms量级.通过合理调节参数Ihb和Nmh可以控制容错时间.图中给出的参数取值范围将容错时间控制在50ms~350ms内.4.2TCP应用下的LMA容错性能分析本节通过分析LMA失效造成的TCP应用吞吐量下降时间TLAM的LMA容错性能进行评价,分析模型如图8所示.假设LMAi在时间点A发生失效,失效发生以前MN的TCP连接处于稳定状态,拥塞窗口大小为CW.时刻B为LMAi在失效发生前为MN转发的最后一个CN→MN方向数据包到达MN的时刻;时刻E为LMAi为MN转发的最后一个MN→CN方向数据包(MN向CN回复的ACK消息)到达CN的时刻;在时刻C,s-LMA(LMAj)检测到LMAi失效;在时刻D,s-LMA完成服务迁移,接管所有fa-MN.时刻A到D的一段时间则为LMA容错时间TLMACN在时间点E接收到fa-MN在LMAi失效发生前向CN发送的最后一个ACK消息后,将向fa-MN发送拥塞窗口内(CW)的所有数据包,并等待fa-MN回复的ACK消息.根据容错时间TLMA不同,将有两种情况发生:情况1.CN发送的拥塞窗口内的最后一个数据包(时间点F发送)到达PMIPv6域时失效LMAi的服务迁移已经完成,即F+tclD(也就是TLAM(F-E)+(E-A)+tcl).这种情况下,CN在拥塞窗口内发送的数据包将通过LMAj转发至fa-MN,LMAi失效不影响MN的上层TCP应用,即TLAM由于TCP对于窗口内的数据包连续发送,这里(F-E)可忽略不计,(E-A)=tcl,因此情况2.CN发送的拥塞窗口内的最后一个数据包到达PMIPv6域时,服务迁移未完成,即F+tcl<D(也就是TLAM况下,CN在拥塞窗口内的发送的所有数据包将丢失.CN等待到G时刻,它在E时刻所发送数据包的Page7重传定时器(RTO1)到期,CN将重传该数据包,并将拥塞窗口置为1.若重传数据包到达PMIPv6域时,LMA服务迁移仍未完成,该数据包又将丢失.CN等到第2次重传定时器(RTO2)超时,重发数据包.假设第N次重传的数据包到达PMIPv6域时,服务迁移完成,LMAj将截获该数据包并转发至fa-MN.CN和MN通过LMAj恢复正常通信后,在H时刻后开始TCP慢启动,拥塞窗口从1增大到CW的恢复时间为τs=[log2(1+CW)-1]×RTT.LMAi失效造成的TCP吞吐量下降时间为TLAM(H-B)+τs+(tcl+tml+tmm),其中(H-B)=(H-E)+(E-A)-(B-A),(E-A)=tcl,(B-A)=tml+tmm.(H-E)由重传次数N确定.按照TCP重传机制,初始重传定时器值TO1=β×RTT,RTT为TCP连接的平均往返时延.第N次重传的定时器值TON(N1)为那么,(H-E)即从第1次发送到第N次重传某数据包的总时间为(H-E)=RTON=∑N==重传次数N由容错时间TLMARTON-1+(E-A)+tcl<TLMARTON-1+2tcl<TLMA因此,LMA失效造成的吞吐量下降时间为TLMAtd-TCP=0,烄RTO1+2tcl+τs,2tcl<TLMA烅RTON+2tcl+τs,RTON-1+2tcl<TLMA烆图9为LMA失效造成的吞吐量下降时间td-TCP随容错时间TLMATLAM10ms、50ms、150ms(WLAN、3G网络、卫星通信网络中的典型值).当TLMA图9LMA失效造成的TCP应用吞吐量下降时间ft的增大,TLAMLMA失效未对MN的上层TCP应用造成影响.随着TLMA次递增.这是因为随着TLMA就导致多一次的数据包重传次数,服务中断时间也就随之增大一个重传超时时间.另外,tmr越大,同等次数的TLAM时间与MN-CN间的传输时延相关,tmr越大,超时时间越大,TLAM网络环境,通过合理选择容错参数Ihb和Nmh,可有效控制LMA失效对fa-MN进行中的TCP应用造成的影响.理论上,将容错时间控制在100ms以下时,可完全避免LMA失效造成fa-MN上层TCP应用的吞吐量下降.针对不同类型的无线网络,最差情况,也可将吞吐量下降时间控制在1s~2.7s.4.3UDP应用下的LMA容错性能分析本节通过分析LMA失效造成的UDP应用丢包情况,对UDP应用下LMAFT方案的容错性能进行评价,分析模型如图10所示.A时刻,LMAi失效;B时刻,LMAi在失效前为fa-MN转发的最后一个数据包到达fa-MN;C时刻,LMAj检测到LMAi失效,发起LMA服务迁移;D时刻,服务迁移完成.此后,MN的数据包由LMAj负责转发.容错时间ft内,MN的数据包都将丢失.CN在时刻E到FTLMA间向MN发送的数据包将丢失.设CN的发包率为λp,则LMAi失效造成的MN丢包NLMApl-UDP=λp×(F-E)NMAGPage8图10LMA容错性能分析模型(UDP应用)图11给出了MN丢包NLMA的变化情况.NLMA率λp越大,NLMA方案的TLMA所示的3种发包率的UDP应用,LMAFT可将丢包数控制在[0,7]、[2,17]、[5,35]范围内.5LMAFT方案仿真实验本文在NS-2中实现了LMAFT方案,本节通过仿真分析对LMAFT在TCP和UDP应用下的容错性能进行评价.仿真场景为在PMIPv6域内部署3个LMA,6个MAG,100个MN在各MAG间随机移动,通过无线链路与MAG建立连接,分别仿真了IEEE802.11g、UMTS和卫星网络3种无线接入方式,单向传输延迟分别为10ms、50ms、150ms.各场景的仿真时间均为50s,失效发生在第25s,此时上层应用已处于稳定状态.5.1TCP应用下的LMA容错性能图12为MN-MAG间无线链路分别为802.11g、UMTS和卫星网络,心跳间隔Ihb,心跳消息允许丢失数Nmh分别取不同值时,LMA失效造成的TCP应用服务中断时间TLMA大,TLMAsi-TCP随Ihb的增大阶梯性增长.针对具体网络环境,选择适合的容错参数,可有效降低LMA失效对fa-MN上层TCP应用造成的影响.例如,针对卫星网络,当Nmh取值3,Ihb取值20ms~50ms时,LMA失效都不对fa-MN的TCP应用造成影响;Ihb取值60ms~140ms时,可将LMA失效造成的fa-MNTCP应用服务中断时间控制在600ms左右.图12LMA失效时的TCP应用服务中断时间理论上,MN-MAG间无线链路延时越大,CN-MN间的平均往返延时更大,CN向MN发包的重传定时器值将更大,那么服务中断时间TLMA该越大.然而在图12中,当Ihb较小时,MN-MAG间链路延时最大的卫星通信网络反倒比其他两种情况的服务中断时间更小.这是因为:对于MN-MAG间无线链路为802.11g和UMTS的情况,MN-MAGPage9单向传输延时分别为10ms/50ms,CN在LMA失效前发送给MN的最后一个数据包通过LMA到达MAG后分别通过10ms/50ms到达MN,之后MN回复ACK,ACK到达MAG时分别又过了10ms/50ms,共计20ms/100ms,此时LMA切换尚未完成,所以ACK丢失,CN需等待重传定时器超时才会向MN重传数据包,造成服务中断;而对于MN-MAG间无线链路为卫星通信网络的情况,MN-MAG单向传输延时为150ms,CN在LMA失效前发送给MN的最后一个数据包通过LMA到达MAG后,MAG转发给MN并再接收到MN回复的ACK共计过了300ms,此时LMA切换已经完成,所以该ACK能够通过LMA送到CN,CN收到ACK后将继续向MN发包,而无需等待重传定时器到期,因此服务中断时间为0.图13为3种不同无线链路,分别运行PMIPv6基本协议(Base-PMIPv6)和LMAFT方案的6种场景下,fa-MN的TCP吞吐量变化情况.在仿真进行5s左右,各场景下的TCP应用吞吐量达到稳定状态,Base-PMIPv6和LMAFT方案在同种无线链路场景下的吞吐量值相同.在LMA失效发生(第25s)后,Base-PMIPv6的3种场景下的吞吐量值都迅速降为0,且不再恢复.而在LMAFT-Satellite场景下,fa-MN的吞吐量值未下降,这是因为Ihb和Nmh的该取值使得LMA失效对卫星网络中的fa-MN上层TCP应用不造成影响.LMAFT-802.11g和LMAFT-UMTS场景下,吞吐量在LMA失效后明显下降,但快速上升并恢复到失效前的稳定状态.5.2UDP应用下的LMA容错性能图14为Base-PMIPv6和LMAFT方案下,fa-MN上层UDP应用的收包率变化情况.LMA失效对fa-MN上层UDP应用的影响与fa-MN所在无线链路无关,因此图中仅给出了一种无线链路的场景.LMA失效发生前,两种方案下,fa-MN的收包率变化情况相同.失效发生(第25s)后,LMAFT场景下,fa-MN丢包率在第26s下降到20packets/s左右,但在第27s已恢复至失效发生前的稳定值,整个容错过程中的丢包未超过10个;而Base-PMIPv6场景下的收包率迅速下降为0.5.3LMA容错信令开销图15为LMAFT方案引入的信令开销和PMIPv6图15LMA容错信令开销与PMIPv6基本信令开销的比较Page10基本信令开销的对比.LMAFT引入的容错信令开销主要为失效检测的心跳消息,因此如图15(a)所示,随着Ihb的增大,引入的容错信令开销快速减少.当Ihb取值50ms时,容错信令开销仅为PMIPv6基本信令的一半.图15(b)为信令开销随系统所服务MN数目变化的情况.随着系统所服务MN数目的增大,PMIPv6基本信令开销将线性增长,而容错信令开销不变,当MN数目为300时,基本信令开销已接近容错信令开销的5倍.而在实际网络部署中,一个LMA所支持的MN远大于300,也就是说当系统处于较饱和的服务状态时,方案引入的容错信令开销将远小于基本信令.6结语本文针对PMIPv6系统中的LMA单点故障问题,首次提出一种基于主备关系的LMA容错方案(LMAFT).该方案在PMIPv6域内部署多LMA,并建立一一对应的LMA主-备关系,通过LMA间自组织的状态管理实现容错.通过理论分析和仿真实验表明,LMAFT方案能在LMA失效后快速恢复相关MN的网络连接,有效减小甚至避免LMA失效对MN上层应用造成的影响;方案引入的容错信令开销远小于PMIPv6系统的基本信令.
