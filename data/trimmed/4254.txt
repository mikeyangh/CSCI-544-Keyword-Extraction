Page1基于属性的可搜索加密方案李双1)徐茂智2)1)(北京工商大学理学院北京100048)2)(北京大学数学科学学院北京100871)摘要2004年,Boneh等人利用匿名的基于身份的加密方案构造了一个公钥可搜索加密方案(PEKS),解决了特定环境下对加密数据进行检索的这一困难问题.已有的可搜索加密方案,通信模式往往是一对一的,关键词密文也只能被特定的单个用户查询或解密,这样的通讯模式在实际的系统中有很多局限性.作者首次给出了基于属性的可搜索方案(ATT-PEKS)的定义和构造算法.此方案与PEKS的不同之处在于基于属性的可搜索方案是适应群组的公钥加密搜索方案,扩大了信息的共享性,节省了第三方信息存储的空间.作者同时对此方案进行了一致性分析和安全性证明.关键词可搜索加密;基于属性的加密;双线性Diffie-Hellman问题;安全性证明;信息安全;网络安全1引言在网络迅猛发展、信息爆炸的今天,为了能快速查询到所需要的信息,搜索工具变得异常重要,如Google、百度已成为我们日常学习、生活的工具.如何使得搜索安全是一个重要的问题,于是一些关于加密数据的搜索技术应运而生.2004年,Boneh等Page2人[1]利用匿名的基于身份的加密方案构造了一个公钥可搜索加密方案(PEKS),该方案是针对在加密的邮件系统中邮件网关搜索带特定关键词邮件的应用场景而提出的.独立于文献[1]中的工作,Waters等人基于文献[2]提出了一个针对加密的审计日志进行检索的公钥加密方案[3].Park等人[4]提出了两个支持逻辑“与”的检索功能的可搜索公钥加密方案.2005年,Abdalla等人[5]对公钥可搜索加密方案的一致性进行了重新定义,将其划分为计算的、统计的和完美的三个类别.随后,他们给出了将匿名的基于身份的加密方案转化为具有计算一致性的可搜索公钥加密方案的通用方法,并基于Boyen和Waters[6]的匿名的基于层级身份的加密方案在标准模型中提出了一个基于身份的可搜索加密方案的一般定义,但没有给出具体的算法.2010年,Li等人[7]针对云计算环境提出了一个基于通配符的模糊的可搜索公钥加密方案.2011年,Cao等人[8]提出了一个可以同时对多个关键词进行检索的可搜索公钥加密方案.已有可搜索加密方案大都是针对关键词密文与查询方之间的关系是一对一的情形,在越来越多的信息共享的大背景下,这些方案显然不适合关键词可被多方查询的需求.比如数字电视、视频点播、个人微博、个人藏品展示等都可以存储在如Google或Yahoo这样的第三方服务器上,此时数据与接收方是一对多的关系,也就是说数据可以被多个用户进行查询,传统的可搜索加密方案只能解决数据被唯一对应用户查询访问的问题.此时当加密方想要将一个信息和对应的关键词让目标的一群人得以分享,以现在的系统只能针对每一个人的私钥进行加密,将不同的机密结果在公共信道传送至对应的人群.查询者先是根据关键词查询到一些相关信息,然后再将对应消息解密.在这种情况下用已有的可搜索加密方案进行查询,无论是在效率上还是实际应用都是难以让人满意的.基于属性的加密体制(ABE)[9],2005年首次被提出.在这种加密体制中加密者无需知道每个解密者的具体身份信息,而只需要掌握解密者一系列描述的属性,然后在加密过程中用属性定义访问结构对消息进行加密,当用户的密钥满足这个访问结构时就可以解密该密文.因此我们利用基于属性的加密方案可以实现一对多的通信特性提出基于属性的可搜索加密方案,给出了一般定义、具体算法构造、复杂度分析和安全性分析.基于属性的可搜索加密方案与基于身份的可搜索加密方案相比,解除了关键词密文只能被唯一用户正确查询的限制,使得关键词密文可以被多个用户共享检索,节省了网络存储空间,提高了检索效率,特别适合网络迅猛发展下的各种应用.2基础知识G2群的单位.设p,q是素数,G1和G2分别是阶为p,q的乘法循环群.称映射e:G1×G1→G2为一个双线性对,如果映射e满足下述性质[10]:(1)双线性(Bilinear)对于任意a,b∈Zp和x,y∈G1,都有对于任意x1,x2,y∈G1,有对于任意x,y1,y2∈G1,有(2)非退化性(Non-degenerate)存在x,y∈G1,使得e(x,y)≠1G2.这里1G2代表(3)可计算性(Computable)存在有效的多项式时间算法对任意的x,y∈G1,计算e(x,y)的值.在群G1上,作为密码学的安全假设,有以下几个密码学困难问题.定义1.计算Diffie-Hellman问题(CDH):给定三元组(g,ga,gb),其中a,b∈Zp且未知,g为循环群G1的一个生成元,计算gab的值.定义2.判定Diffie-Hellman问题(DDH):给定四元组(g,ga,gb,gc),其中a,b,c∈Zp且未知,g为循环群G1的一个生成元,判定c=ab(modp)是否成立.定义3.双线性Diffie-Hellman问题[6](BDH):给定四元组(g,ga,gb,gc),其中a,b,c∈Zp且未知,计算e(g,g)abc∈G2.定义4.判定双线性Diffie-Hellman问题(DBDH):给定五元组(g,ga,gb,gc,r),其中a,b,c∈Zp且未知,r∈G2,g为循环群G1的一个生成元,判定是否r=e(g,g)abc.目前仍未有解决BDH的有效算法,所以普遍认为BDH是一个困难问题.定义5.访问结构[10](AccessStructure):一个实体集P={P1,P2,…,Pn},对于A2P是2P上Page3的一个非空子集,B,C,如果当B∈A且BC时,则有C∈A,那么称集合A2P是单调的.一个访问结构A(通常是指单调的访问结构)是P={P1,P2,…,Pn}的一个非空子集合,即A2P\{Φ}.包含于A中的集合称为授权集合(AuthorizedSet),而不包含在A中的集合称为非授权集合(Non-AuthorizedSet).定义6.Υ表示一棵访问树,树中每个非叶子节点表示的是一个由子节点和阈值所描述的门限.假设numx表示节点x的子节点数目,kx表示节点x的阈值,则有0<kxnumx.当kx=1时,门限表示“或”门,而当kx=numx,时,它表示“与”门.另外,树中的叶子节点可以认为是一个属性且阈值kx=1.为了简化对访问树的操作,定义了一些函数.函数parent(x)表示节点x的父节点.如果x是叶子节点,则att(x)表示与子节点x关联起来的属性值.访问树Υ对每个节点的子节点进行编号,即子节点的编号是从l到num,而函数index(x)返回节点x的编号.满足访问树:令r表示Υ的根节点,而Υx表示是访问树Υ中以x为根的子树,因此Υ也可以表示为Υr.Υx(γ)=1表示属性集合γ满足访问树Υx.我们可以通过以下方式递归去计算Υx(γ)的值.如果x是一个非叶子节点,则计算x所有子节点x的Υx(γ),当且仅当有至少kx个子节点返回1时,Υx(γ)返回1;如果x是叶子节点并当且仅当att(x)∈γ,则Υx(γ)返回1.3基于属性可搜索加密方案的定义3.1ATT-PEKS算法定义首先给出基于属性的可搜索加密方案(AttributeBasedPEKS,记为ATT-PEKS)的定义.ATT-PEKS是在基于属性的加密方案(ABE)的基础上提出来的,基于属性的可搜索加密方案引入属性的概念,从而使得满足相关属性的用户均可以对加密数据进行查询,不同于基于身份的可搜索加密,每个关键词密文与唯一查询用户对应.定义7.一个基于属性的可搜索加密算法ATT-PEKS由5个多项式时间随机算法Setup、KeyGen、PEKS、Trapdoor、Test组成:(1)Setup(1λ):(Pub,Msk)←Setup(1λ)其中λ是系统参数.Setup是由系统参数λ生成公共参数Pub和主密钥Msk的概率多项式算法;(2)KeyGen(Msk,A):PrivA←KeyGen(Msk,A)密钥生成中心(KGC)根据访问结构A和系统主密钥Msk生成用户的私钥PrivA,其中KeyGen是由系统主密钥Msk和访问结构生成用户私钥的概率多项式算法;(3)PEKS(Pub,w,γ):C←PEKS(Pub,w,γ)发送方利用公共参数Pub和属性γ加密关键词w,生成可搜索关键词的密文C,只有属性满足访问结构的用户才能对关键词密文进行解密.其中PEKS是由系统公共参数Pub,关键词w和属性γ生成关键词密文的概率多项式算法;(4)Trapdoor(PrivA,w):Tw←Trapdoor(PrivA,w)接收方利用个人私钥PrivA计算查询关键词w∈{0,1}的门限值Tw发送给网关服务器,其中Trapdoor是由用户私钥PrivA和关键词w生成关键词门限Tw的概率多项式算法;(5)Test(Pub,Tw,C):b←Test(Pub,Tw,C)已知公共参数Pub,一个关键词w的密文C=PEKS(Pub,w,γ)和关键词w的门限值Tw=Trapdoor(PrivA,w),如果w=w,输出b=1,否则b=0,其中Test是判断密文C是否是门限Tw对应关键词w的密文的概率多项式算法.
