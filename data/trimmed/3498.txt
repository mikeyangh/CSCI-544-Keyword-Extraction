Page1基于单断言的安全的密文区间检索蔡克张敏冯登国(中国科学院软件研究所信息安全国家重点实验室北京100190)摘要为解决数据外包所带来的敏感数据的数据安全问题,数据所有者更多地选择外包敏感数据的密文.而外包密文的形式,为数据所有者对这些数据的使用带来了不便,如数据所有者无法对密文数据进行区间检索等.目前的密文区间检索方案中,为实现密文的区间检索,服务器需要对区间索引进行多次断言.而断言次数越多,向服务器泄露的信息也越多.文中提出采用单断言实现敏感数据的区间判断,同时使用可逆矩阵对区间索引和区间陷门进行安全保护,不仅减少了整个方案的信息泄露,而且保证了区间索引和区间陷门的安全.文中对方案复杂性进行了分析.该方案在安全性方面的提升并不以效率损失为代价.关键词密文检索;区间检索;区间索引;区间陷门1引言存储(CloudStorage)是当前的两个主流数据管理形式.由于数据的外包将数据完全暴露给半可信的服务提供商,使得数据脱离了数据所有者的掌控,数据隐私存在着被泄露的可能.Google、Salesforce等外包数据库(OutsourcedDatabase,ODB)和云Page2公司均发生过云存储泄密事件.为保护敏感数据,数据所有者期望在对敏感数据加密后外包存储,使得暴露给服务提供商的是密文形式的数据[1].外包数据的密文存储,为数据使用带来了诸多不便,如无法对敏感数据密文进行区间检索.通常采用通用的加密算法对敏感数据进行加密保护.我们假设加密算法是安全的.服务器在不了解密钥的情况下,无法直接对密文进行区间检索.如果数据所有者想要获得属于指定区间的数据,其必须向服务器请求全部敏感数据,在本地解密后再进行区间检索.整个过程需要服务器返回大量冗余数据,占用了大量网络带宽和客户端计算资源,这并非是有效的解决方案.鉴于直接对密文进行区间检索比较困难,目前普遍采用为敏感数据构建区间索引的方法实现区间检索.区间索引基于敏感数据明文构建,在一定程度上包含了敏感数据的相关信息.如果区间索引不安全,那么区间索引的外包,大大增大了服务器破解敏感数据的概率.在对数据安全要求比较高的场景下,不仅需要敏感数据可用,同时还要考虑其安全.应该在保证安全性的前提下提升敏感数据的可用性.在客户端进行区间检索的解决方案[2]不符合数据外包应用场景的要求,不在本文考虑范围之内.早期对密文区间检索的研究主要集中于保证敏感数据的可用性.最简单的是直接应用保序加密算法[3-4].区间索引继承了敏感数据的大小排列性质,服务器可以直接基于密文进行大小比较,从而获得检索结果.该类方案使得敏感数据的大小信息完全暴露给服务器,安全性方面的牺牲比较大.Hacigümü等人提出通过对敏感数据进行分桶[5-8]的方式实现密文区间检索,各区间索引组成了对敏感数据的一次划分.这个方案中,服务器可以直接获得敏感数据的归并特征,即多个敏感数据对应同一个区间索引.归并特征数量少的特点,使得破解难度很低.而且归并特征的破解对获得敏感数据的分布规律非常有利.后来,有学者注意到了密文区间检索方案在安全性方面的缺陷,提出了通过编码[9]的方式来实现密文区间检索.该方案通过对敏感数据进行前缀保序编码获得区间索引,使用前缀匹配获得区间检索结果.安全性有所提升,但是在获知多个区间陷门的情况下,服务器可以获得敏感数据的排列信息[9].现有方案中,要实现密文区间检索,服务器均需要对区间索引进行多次断言.每次断言都意味着服务器要进行一次判断,如等值匹配判断或大小比较判断等.任何一次断言都会向服务器泄露敏感数据的相关信息,如分桶[1-3]的方案中,检索区间涵盖多个分桶,检索时需要将区间索引与区间陷门的每个值进行一次断言,泄露了敏感数据属于其中某个分桶的信息,而不是只泄露敏感数据是否属于检索区间的信息.所以断言次数越多,检索过程向服务器泄露的信息也就越多,泄露信息的增多,增大了密文区间检索方案的安全隐患.本文针对上述的问题,第一个提出基于单断言来实现密文的区间检索,即服务器只需要对区间索引进行一次断言,就可以获知敏感数据是否属于该检索区间.这在一定程度上减少了区间检索过程中的信息泄露,使得密文区间检索方案的安全性得到了一定程度的保障.对于必须提供给服务器的信息,比如区间索引和区间陷门,方案对这些信息进行了相应的保护处理.该方案中,敏感数据的排列信息和敏感数据的归并信息不会被泄露,与现有方案相比,它在不影响敏感数据可用性的情况下,获得了更高的安全性.本文在第2节中对方案的安全模型进行假设,同时针对密文区间检索的特征,给出了相关的安全性描述的定义;第3节分析方案的基本框架,并描述了区间检索方案中涉及的一些方法;第4节对本方案中的区间索引和区间陷门的安全性进行分析;第5节对本方案的时间和空间复杂性进行分析,并与现有方案进行比较;第6节总结全文并给出对后续工作的展望.2相关知识2.1应用场景假设本文考虑的应用场景包含如下两种角色:数据所有者(DataOwner,DO)和服务提供商(ServiceProvider,SP).如图1所示,其中DO是敏感数据的拥有者,该角色不具备强大的数据存储和管理能力.为获得针对敏感数据密文的区间检索能力,该角色在将密文数据外包的同时,为敏感数据构建了区间索引并进行上传.SP是服务提供商,具有强大的存储和计算能力.对于DO发起的区间检索请求,SP承担大量的处理任务,并向DO返回检索结果.SP是半可信的,即SP会忠实地执行DO提交Page3的区间检索请求,并返回根据检索请求得到的检索结果.但是SP对敏感数据比较好奇,可能会利用所掌握的一切信息(如敏感数据的区间索引和区间陷门等)来进行分析,期望获得真实的敏感数据.当前我们主要考虑唯密文模型,即SP只了解存放在SP的敏感数据的区间索引以及DO进行区间检索时提供的区间陷门信息.SP事先并不了解敏感数据的值域、分布情况、敏感数据与索引的对应关系等信息.所以,本文需要考虑唯密文模型下的区间索引和区间陷门的安全性.2.2安全性定义我们主要研究唯密文模型下的区间索引和区间陷门的安全.现有研究中涉及索引和陷门安全的概念主要有:索引安全、陷门安全和关键词安全[10-11].索引安全是在密文文档的关键词检索中提出的,考虑的是关键词索引是否会泄露关键词与加密文档之间的对应关系;关键词安全考虑的是检索关键词,要求检索陷门不能泄露检索关键词;而陷门安全要求敌手无法根据已知的陷门生成未知的有效陷门.上述概念都是针对密文检索领域的关键词检索提出的,比较适合于用于描述关键词检索中的索引和陷门的安全.由于这些概念不能完全覆盖常见的区间检索中的安全隐患,所以这些概念在区间检索领域的使用具有一定的局限性.密文区间检索拥有下述特征.一方面区间检索不再是简单的单值匹配,需要考虑区间陷门是否会泄露检索区间上下界的信息,以及是否会泄露检索区间的归并特征;另一方面,敏感数据之间还附带了具有某种实际意义的大小关系,使得返回的检索结果不再只包含单值敏感数据.所以我们不仅需要考虑区间索引是否会泄露敏感数据的排列信息,而且需要考虑在检索过程是否会泄露检索结果中各个敏感数据的排列信息.本文针对密文区间检索的独特安全隐患,提出了相关的安全性描述.它主要分区间索引和区间陷门两个方面.其一,区间索引是否会泄露敏感数据的排列信息;其二,区间陷门是否会泄露检索区间的归并特征,是否会泄露检索结果中敏感数据的排列信息.定义1(区间索引的排列安全).已知一个密文区间检索方案的区间索引集合I={I1,I2,…,dn}和函数F(d,k),敏感数据集合D={d1,d2,…,dn}和密钥k均未知,其中Ii=F(di,k),i∈[1,n],根据I和F如果能得到如下结果密文的区间检索不同于关键词检索,区间检索涉及到区间陷门是否泄露敏感数据的归并特征的问题.由于每个归并特征均表示一组敏感数据,每次检索也是基于归并特征进行的.SP可以通过多个区间陷门获得归并特征排列信息,这对获得真实的敏感数据非常有利.(1)Ijdj,其中j∈[1,n];(2)P(di>dj)=0.5,其中i∈[1,n],j∈(3)P(di>dj|dk>dl)=P(di>dj),其中i∈[1,n],i≠j;[1,n],j∈[1,n],i≠j,且{i,j}≠{k,l},那么我们称该区间索引是排列安全的.其要求:(1)敌手无法根据区间索引直接获得真实的敏感数据;(2)无法根据区间索引获得任意两个敏感数据之间的大小关系,即敏感数据的大小关系不可区分;(3)即使敌手获得某两个敏感数据之间的大小关系,剩下的敏感数据的之间的大小关系仍然是不可区分的,即无法判断其余任意两个敏感数据之间的大小关系.所以,如果区间索引是排列不安全的,那么敌手可以获得所有敏感数据的一个排列,排列可能是升序的也可能是降序的.敏感数据排列信息的泄露,使敌手在了解所有敏感数据分布信息的情况下,可以方便地获得真实的敏感数据.定义2(区间陷门的归并特征安全).已知一个密文区间检索方案中区间陷门T(T1,T2,…,Tt),如果(1)TH-L,其中L和H分别是区间陷门T对应的检索区间[L,H]的下界和上界;(2)L,H,K→Ti,其中i∈[1,t],K为密钥,那么我们称该区间陷门是归并特征安全的.区间陷门的归并特征安全是指区间陷门只能由区间上下界生成,并且不会泄露检索区间大小.所以,敌手无法根据区间陷门获得检索区间真实的上下界以及检索区间的大小,并且无法获得检索区间内敏感数据的归并特征.Page4定理1.设存在n个互不相等的数字,只需要n-1个特定的区间检索就可以获得这n个数字的排列.证明.设n个数字为A={a1,a2,…,an},存在的n-1个区间检索Q={q1,q2,…,qn-1}对应的检索结果为R={r1,r2,…,rn-1}.其中qi的检索结果ri={ai,ai+1|1in}.那么,根据r1,r2可以得到{a1<ai|i=2,3}或{a1>ai|i=2,3},根据r2,r3可以得到{a2<ai|i=3,4}或{a2>ai|i=3,4},….而且如果a1<a2,那么{ai<aj|i<j}.否则{ai>aj|i<j}.根据这些可以得出a1,a2,…,an是以升序或降序排列的信息.所以,只需要n-1个特定的区间检索就可以获得n个数字的排列信息.证毕.由定理1可以看到,假如n是指敏感数据个数,且n比较大,那么这时需要大量的特定区间检索才能让SP获得敏感数据的排列信息.而当n是指归并特征个数时,由于每个归并特征代表了一组敏感数据,敏感数据比较多时,对应的归并特征也不会很多,即n比较小.这时根据少量的区间检索就可以获得归并特征的排列信息.根据归并特征的排列信息可以获得敏感数据的分布情况.这对于获得真实的敏感数据非常有利.所以,一个区间检索方案的区间陷门满足归并特征安全是非常有必要的.定义3(区间陷门的检索结果安全).已知一个区间陷门T和基于该陷门进行检索的检索结果集R={r1,r2,…,rs},而检索结果集对应的敏感数据集为D={d1,d2,…,ds},如果根据T和R可以得到(1)P(di>dj)=0.5,其中i∈[1,n],j∈(2)P(dk>dl|di>dj)=P(dk>dl),其中i∈[1,n],i≠j;[1,n],j∈[1,n],i≠j,且{i,j}≠{k,l},那么我们称区间陷门是检索结果安全的.区间陷门的检索结果安全是指区间陷门和检索结果集不会泄露敏感数据的大小关系,而且这个判断不受其它敏感数据的大小关系影响.密文的区间检索不同于关键词检索,区间检索中,各检索结果之间具有大小关系.如果区间检索的结果之间可以简单地判断出大小关系,那么只要获得多个特定区间陷门,敌手就可以获得所有敏感数据的顺序信息.所以,区间陷门的检索结果安全对于区间检索的安全性非常重要.定义4(区间检索的唯密文安全).如果一个密文区间检索方案在唯密文场景下,其区间陷门是排列安全的,区间陷门是归并特征安全和检索结果安全的,那么称该方案是唯密文安全的.由上述可以看出,无论是区间陷门的排列安全,还是区间陷门的归并特征安全和检索结果安全,均可以归约为尽可能地保护敏感数据的大小关系.由于密文区间检索与关键词检索相比,其特征在于敏感数据之间是具有某种实际意义的大小关系的.所以区间检索的唯密文安全的描述重心就是从区间索引和区间陷门方面考虑,尽可能保护敏感数据的大小关系信息不被敌手获得.2.3单断言实现区间判断当前的密文区间检索方案都是基于多次断言实现的.桶式索引的方案[5],检索时需要对检索区间中各个预定义的桶标识进行断言;编码索引方案[9],检索时需要对检索区间包含的所有最小前缀编码进行断言;而保序加密[1-2],需要对索引分别进行区间上下界两次断言判断.所以,当前并不存在基于单断言实现密文的区间检索方案.本节将介绍一种可以将区间匹配转换成单断言判断的方法.该断言将一个被断言值和一个断言区间作为输入,服务器进行相关计算和单次比较判断获得断言结果.其中被断言值即为敏感数据的区间索引,断言区间即为检索区间对应的区间陷门,断言结果就是敏感数据是否属于检索区间.该方法是基于单位圆的不同半径的位置关系转化而来的.定理2.由图2,已知在一个原点为O的坐标系中存在一个单位圆,上半圆周上有A、B、C3个不同的点,OA和OB,OB和OC,OA和OC之间的夹角分别为θ1,θ2,θ3,其中0<θi<π,i=1,2,3.那么当且仅当cosθ3<cosθ1cosθ2时,OB位于OA和OC之间(仅考虑上半圆).sinθ1>0,sinθ2>0,即sinθ1sinθ2>0.不会重叠,即cosθ3≠cosθ1cosθ2.证明.由于θ1∈(0,π)且θ2∈(0,π),那么由于A、B、C是3个不同的点,OA、OB、OC并不妨设OB位于OA、OC之间,那么θ3=θ1+Page5θ2,cosθ3=cos(θ1+θ2)=cosθ1cosθ2-sinθ1sinθ2,由sinθ1sinθ2>0,得cosθ3<cosθ1cosθ2.当OB位于OA、OC之外时,θ3=|θ1-θ2|,cosθ3=cos(θ1-θ2)=cosθ1cosθ2+sinθ1sinθ2,由sinθ1sinθ2>0,得cosθ3>cosθ1cosθ2.所以,当且仅当cosθ3<cosθ1cosθ2时,OB位于OA和OC之间.由定理2,断言cosθ3<cosθ1cosθ2可以用来表示半径线段OB位于线段OA、OC之间,OB的位置看作是要被检索的值,而OA和OC的位置看作为检索区间,断言cosθ3<cosθ1cosθ2可以表示一个区间判断.为更贴切地表达被检索值和检索区间的关系,我们将3个线段之间的位置关系用线段与横轴正半轴的夹角来表示.推论1.已知在一个原点为O的坐标系中存在一个圆,上半圆周上有V、VL、VH3个不同的点,其OV、OVL、OVH与横坐标的夹角分别是θ、θL、θH,其中0<θ,θL,θH<π.那么当且仅当cos(θH-θL)<cos(θ-θL)cos(θ-θH)时,θL<θ<θH.证明.由于OV与OVL、OV与OVH、OVL与OVH的夹角分别是θ-θL,θ-θH,θH-θL.由定理2得,当且仅当cos(θH-θL)<cos(θ-θL)cos(θ-θH)时,OB位于OA和OC之间,即θL<θ<θH.证毕.3方案3.1基本框架一个唯密文安全的密文区间检索方案,不仅要求构造的区间索引是排列安全的,而且构造的陷门是归并特征安全和检索结果安全的.本文将给出一种将区间判断转换成单断言的方法,并基于该方法构建一个安全的密文区间检索方案.密文的区间检索的方案构建与通用的密文检索方案[12]类似,涉及的两个流程分别是构建区间索引和区间检索.对这两个流程进行分解,可以获得如下几个过程:1.Setup.初始化并生成一个密钥K.2.BuildIndex(v,K).DO根据敏感数据v生成与其对应的索引,并使用密钥K进行加密保护,得到区间索引I.3.Trapdoor(L,H,K).DO根据检索区间上下界L和H,生成与之对应的陷门,并使用密钥K进行加密保护,得到区间陷门T.4.Search(I,T).SP根据区间索引I和区间陷门T进行单断言判断,获知区间索引对应的敏感数据是否满足检索区间.构建具体方案时,首先DO为外包的敏感数据构建索引,涉及Setup和BuildIndex两个过程.在初始化加密密钥后,对每个敏感数据进行区间索引的构建,并将这些区间索引上传到SP.然后,DO发起基于[L,H]的区间检索,其涉及Trapdoor和Search两个过程,即DO在基于L和H构建了区间陷门后,将区间陷门提交给SP进行检索.SP对区间索引和区间陷门进行判断,获得被检索的敏感数据是否属于检索区间的信息.3.2区间判断到单断言的映射上一节介绍了一种可以获得区间判断效果的断言,我们虽然可以通过单个断言cos(θH-θL)<cos(θ-θL)cos(θ-θH)来表示一个区间判断θL<θ<θH,但是由推论1知该区间判断的数值存在着大小的限制.由定理2可以知道,被判断的值只能属于(0,π).对于大部分的应用场景,(0,π)无法表示敏感数据的值域,所以需要一种将值域D的数值映射到0到π之间的方法,我们设计了如下的值的圆周映射方法.值的圆周映射(F).假设映射关系原像的值域为D,二维坐标系中存在一个半径为D的上半圆,在横轴找到映射值v,取其与O相对称的-v,并将其投影到上半圆周获得点A,那么OA与x正半轴的夹角θ就为v的映射值.如图3,cosθ=-v其中v是要进行映射的值,D是v所在值域的大小.将值域为D的数值映射到0到π之间的方法有很多.我们这里要求的方法是在映射后,断言cos(θH-θL)<cos(θ-θL)cos(θ-θH)仍然可以表示区间判断θL<θ<θH,其中0<θ,θL,θH<π,即该映射必须维持断言对于区间关系的判断.所以,我们定义了区间关系维持映射来表述这样的映射.定义5(区间关系维持映射).一个映射F,对于任意区间[L,H]和值v,至少存在一个断言ASF(L)-F(H)(F(v))与该区间相对应,使得只有当L<v<H时,断言ASF(L)-F(H)(F(v))才为真,那么Page6该映射F被称为是区间关系维持映射.区间关系维持映射表述了,数据进行映射之后,仍然存在一个可以表示区间关系的判断的断言.定理3.值的圆周映射是一个区间关系维持证明.如果存在v1>v2,由于值的圆周映射映射.θ=arccos-v么v1,v2经过映射后,对应的映射值θ1和θ2满足θ1>θ2,其中θ1∈[0,π],且θ2∈[0,π].假设存在3个值v,vL,vH,其中vL<v<vH,那么对应的映射值分别为θ,θL,θH,且满足关系θL<θ<θH.由推论1可知,当且仅当cos(θH-θL)<cos(θ-θL)cos(θ-θH)时,满足θL<θ<θH,即vL<v<vH.所以,区间判断可以由断言AS:cos(θH-θL)<cos(θ-θL)cos(θ-θH)来表示.那么对于值的圆周映射而言,任意区间[vL,vH]和值v,对应的映射值分别为[θL,θH]和θ.必然存在与区间[θL,θH]对应的断言AS:cos(θH-θL)<cos(θ-θL)cos(θ-θH),使得只有当vL<v<vL时,断言AS才为真.所以,值的圆周映射是一个区间关系维持映射,其对应的断言为cos(θH-θL)<cos(θ-θL)cos(θ-θH).3.3映射值的加密保护单断言cos(θH-θL)<cos(θ-θL)cos(θ-θH)可以实现区间判断.如果直接应用于区间检索方案中,虽然可以达到区间检索的目的,但无法满足区间索引安全的要求.SP进行断言判断时,需要DO向其提供敏感数据的映射值,SP可以利用映射值,方便地获得真实的敏感数据.所以,需要对上述断言进行相应的保护,使其满足安全性的要求.由于在断言AS中,θH和θL除了大小不同外,完全等价,下面以cos(θ-θL)作为例子进行分析,cos(θ-θL)的变换与之类似.通过如下公式进行θ和θL的分离,并通过可逆矩阵犕对分解的矩阵进行保护[12].cos(θ-θL)=cosθcosθL+sinθsinθL同理得cos(θ-θH)=[cosθsinθ]犕犕-1cosθH上述将cos(θ-θL)分解成[cosθsinθ]犕和sinθ[]L犕-1cosθL实现了对两者的加密保护.矩阵加密的形式可以简化为犆=犘×犕,其中犆为密文,犘=[cosθsinθ],犕为2×2的可逆矩阵,在本文假设的唯密文场景下,如果敌手不知道犕,那么其无法恢复出犘的值[12].所以在本文的场景下,我们可以认为矩阵加密是安全的.上述对θ和θL的分离,使得断言AS可以适用于密文区间检索的应用场景,可以将[cosθsinθ]犕作为区间索引,而矩阵加密的应用,使得在唯密文的场景下,[cosθsinθ]犕的泄露不会影响到真实的敏感数据的安全.3.4安全的密文区间检索方案在本节中,我们结合上述的区间关系维持映射和加密保护来构建一个基于单断言的安全的密文区间检索方案(SRQSAE方案).该方案在唯密文的场景下,区间索引本身不会直接泄露真实的敏感数据,不会泄露敏感数据的大小关系,而且检索区间的陷门可以维护敏感数据的大小关系.其主要包含了如下几个步骤:1.Setup.生成一个2×2的可逆矩阵犕,计算获得犕-1,得到相关密钥K={犕,犕-1}.2.BuildIndex(v,K).对v进行值的圆周映射,获得映射值θ及[cosθsinθ],然后进行矩阵的乘法运算,获得v对应的区间索引犐=[cosθsinθ]犕.3.Trapdoor(L,H,K).将检索区间的上下界分别进行值的圆周映射,获得映射值θL和θH,再进行矩阵乘法运算,获得陷门犜L=犕-1cosθL算陷门Trange=cos(θH-θL),最后,区间陷门T={犜1,犜2,Trange}.其中,陷门犜1、犜2并不是固定地分别对应着犜L、犜H,其对应关系是随机的,当犜1对应犜L时,犜2就对应着犜H,否则相反.4.Search(犐,T).进行单断言Trange<(犐·犜1)·(犐·犜2)判断,如果是真,则返回yes,否则返回no.该方案的主要步骤与一般的密文检索方案[12-14]类似,DO首先需要初始化一个可逆的矩阵犕作为区间索引和区间陷门的加密密钥,在外包敏感数据时,通过值的圆周映射和矩阵加密来生成区间索引犐.当DO进行检索时,对检索区间的上下界同样进行值的圆周映射和矩阵加密来生成相应的区间陷门T,并提交给SP,SP将每个区间索引犐都与Page7区间陷门T进行单断言判断,返回判断结果.4安全性分析密文区间检索方案构建的目的是在保证敏感数据机密性的前提下,实现区间检索的目的.其方案的构建需要考虑在假设的场景下区间索引、区间陷门是否满足安全性的需求.当前我们假设的场景是唯密文场景,SP不了解敏感数据的任何信息,但可以获得DO的多个检索区间陷门,以期望分析出敏感数据的分布特征或大小排列信息等.本节我们将对区间索引和区间陷门的安全分别进行分析,验证该方案满足我们假定的安全性的需要.4.1区间索引安全由于本文只考虑唯密文的场景,敌手对敏感数据的分布情况、敏感数据与区间索引的对应关系都不了解.所以进行区间索引安全考虑时,我们并不需要考虑统计分析攻击、明密文攻击等,只需要考虑区间索引是否会泄露真实的敏感数据,区间索引是否会泄露敏感数据的大小关系信息.后者的安全性要求比前者要求更高,因为单纯从区间索引的角度,区间索引如果泄露了真实敏感数据,那么敏感数据的大小关系必然泄露,而如果区间索引泄露了敏感数据大小关系,那么真实的敏感数据并不一定会泄露.所以,对区间索引来说,保护敏感数据大小排列信息的安全性要求更高.由于敏感数据在经过值的圆周映射后,通过矩阵相乘的方式来生成区间索引,区间索引的安全性依赖于矩阵相乘的安全性.在上文可以看到,在唯密文的场景下,只要不泄露矩阵相乘中的可逆矩阵,那么敏感数据的机密性可以得到保证,敌手无法根据区间索引获得具体的敏感数据.所以方案SRQSAE中,区间索引不会泄露具体的敏感数据.定理4.已知公式犆=犘×犕,其中犘是1×2的矩阵[cosθsinθ],θ∈(0,π),犕是2×2的可逆的未知矩阵,给定任意两个不同犆1和犆2,假设存在与之对应的θ1和θ2,那么θ1和θ2的大小关系是不可区分的.证明.在可逆矩阵犕未知的情况下,给定犆,必然存在多个可能的犘满足公式犆=犘×犕,由于犘=[cosθsinθ],所以存在多个可能的θ.而对于犆1和犆2,在犕未知的情况下,也可能存在多对θ1和θ2满足上述公式.对于任意一对满足犆1和犆2的θ1和θ2,可以记为=[a×cosθ1+c×sinθ1b×cosθ1+d×sinθ1],同理可得犘2=[cosθ2sinθ2],犆2=[a×cosθ2+c×sinθ2b×cosθ2+d×sinθ2].那么对应的,存在元组A={θ1,θ2,犕},其中θ1=π-θ1,θ2=π-θ2,矩阵犕=-a-b[]cd,则犆1=[-cosθ1sinθ1]-a-b[]cd犘1=[cosθ1sinθ1]=[cos(π-θ1)sin(π-θ1)]=[-cosθ1sinθ1],由公式犆1=犘1×犕可得元组A={θ1,θ2,犕},其中[cosθ1sinθ1]犕=犆1且[cosθ2sinθ2]犕=犆2.如果对于任意满足犆1和犆2要求的A={θ1,θ2,犕},其中θ1>θ2,均存在另一个同意满足犆1和犆2的元组A={θ1,θ2,犕},其中θ1和θ2满足θ1<θ2,那么在θ1和θ2值未知的情况下,即使其满足犆1和犆2,θ1和θ2的大小关系是不可区分的,因为无法判断θ1=θ1,θ2=θ2还是θ1=θ1,θ2=θ2.下面来证明对于任意的元组A必然存在元组A与之对应.不妨设存在满足要求的元组A={θ1,θ2,犕},其对应的可逆矩阵为犕=ab[]cd.那么犘1=[cosθ1sinθ1],根据公式可以得到犆1=犘1×犕=[a×cosθ1+c×sinθ1b×cosθ1+d×sinθ1]=犆1,那么同理可以得到犘2=[-cosθ2sinθ2],犆2=犆2.即元组A={θ1,θ2,犕}同样满足犆1和犆2的要求.由上可以看出,对于任意的满足要求的元组A,必然存在对应的另一个满足条件的元组A.如果θ1>θ2,那么必然可以得到π-θ1<π-θ2,而π-θ1和π-θ2,即为A中对应的角度值θ1和θ2.对于任意满足要求的θ1>θ2,必然存在另一对满足要求的θ1<θ2.所以,θ1和θ2的大小是不可区分的.由定理4的证明过程可知,对于任意两个区间索引,其对应的敏感数据的大小关系是不可区分的.上述过程中,我们为一对已知敏感数据找出另一对具有相同区间索引但大小相反的敏感数据.所以,在M安全的情况下,该证明过程不受其它敏感数据大小关系的影响,即敏感数据的大小不可区分性不受其它敏感数据大小关系的影响.而且由于该区间索引是通过矩阵相乘来生成的,在唯密文的场景下,不会泄露真实的敏感数据.所以方案SRQSAE中的区Page8间索引达到了排列安全的要求.4.2区间陷门安全对于区间陷门的安全性,不仅仅需要考虑区间陷门是否会泄露区间上下界,而且需要考虑区间陷门是否泄露归并特征的信息以及检索结果之间的大小关系信息.本文提出的方案中区间陷门是满足这些要求的,即满足定义2和3所说的区间陷门的归并特征安全和检索结果安全的要求.下面将从这两个方面进行分析.定理5.已知存在两个值v1,v2,映射关系F(v)=arccos-vF(v2))的计算值,敌手无法判断|v1-v2|值的大小.证明.不妨设v1,v2的三角计算结果E为value,即value=cos(F(v1)-F(v2)).由value=cos(F(v1)-F(v2))可以得到,value=cosπ妨设存在另外两个值v1,v2,使得arccos-v1D=2-F(v1),arccos-v2D=ππ应的三角计算E的结果cos(F(v1)-F(v2))=cosarccos-v1D-arccos-v2所以,至少存在两对满足三角计算结果为E的v1,v2,如果|v1-v2|≠|v1-v2|,那么我们可以认为敌手无法根据cos(F(v1)-F(v2))判断|v1-v2|的值.由Dsin(F(v))=D1-cos2F(v槡)=D2-v槡2得|v1-v2|=Dcosπ|Dsin(F(v2))-Dsin(F(v1))|=|D2-v槡22-D2-v槡21|.那么,当v1,v2取某个固定值,值域D的大小发生变化时,|v1-v2|的值也随着变化,所以|v1-v2||v1-v2|.因此,敌手无法根据cos(F(v1)-F(v2))判断|v1-v2|的大小.由上述定理5,如果v1,v2为某个检索区间的上下界时,那么向敌手泄露三角计算E:cos(F(v1)-F(v2)),并不影响检索区间的安全性,因为敌手无法判断|v1-v2|的大小,即敌手无法根据三角计算E来获得检索区间的大小.定理6.方案SRQSAE中的区间陷门是归并在方案SRQSAE中,检索区间的陷门为T=特征安全的.sinθ[]L犕-1cosθL烅烄烆sinθ[]H犕-1cosθH烅烄烆矩阵相乘的分析,我们可以知道,在唯密文的情况下,根据陷门SP无法分析出真实的检索区间上下界.且根据定理5,SP无法根据陷门计算出检索区间的大小.所以,SP无法根据检索区间的真实上下界或区间大小去分析该区间内的归并特征.同时该区间陷门是由检索区间的上下界而非归并特征计算生成,所以,该方案中的区间陷门不会泄露检索区间任何归并特征,其区间陷门是归并特征安全的.定理7.假设由SP进行断言SA:value<value1×value2的判断,DO选择θH,θL,θ,计算出value,value1,value2,并提交给SP,其中value=cos(θH-θL),value1和value2分别对应cos(θ-θL)和cos(θ-θH)中的一个.那么在任意两次断言SA为真的情况下,如果DO选择的是相同的θH和θL,不同的θ,那么SP无法判断DO在这两次断言中所选择的θ的大小关系.证明.由于判断相同的θH和θL情况下,两次断言为真时,两个θ的大小不可区分,所以下面的分析都是针对固定的θH和θL进行的,由于固定的θH和θL对应相同的value,下文分析时不再考虑value.我们使用断言元组B来表示某次断言判断过程中,SP获得的数据,B={value1,value2}.由于DO在提交数据给SP时,value1和value2的顺序是随机的,所以对于B1={value1,value2}和B2={value2,value1},SP认为其是无差别的,即B1等价于B2.断言元组B中的数据前后顺序的变化不影响B.由于在一次断言中,SP进行断言数据都包含于断言元组B中.所以,如果两次断言中的断言元组B相同,SP无法判断DO选择的θ是否不同.我们使用断言判断元组A来表示某次断言为真的判断中涉及的相关数据,即A={θ,B},其中θ为DO选择的数值,其对SP保密,B为断言元组.那么A1={θ1,B}和A2={θ2,B}是两次不同的断言,因为DO选择了不同的θ,但生成了等价的断言元组B.对于SP而言,A1和A2两个断言没有任何区别,是不可区分的,我们可以称A2为A1的SP无差别的Page9不同断言判断元组.即虽然本质上这两次断言是针对不同的θ的进行的,但是由于DO提交给SP进行断言的数据集合完全相同,SP无法判断其是否是针对不同的θ进行的断言.对于DO选择的数值θ,由于θ和θH+θL-θ生成相同的断言元组B,即cos((θH+θL-θ)-θL)=cos(θH-θ)=cos(θ-θH),cos((θH+θL-θ)-θH)=cos(θL-θ)=cos(θ-θL).即当DO分别选择θ和θH+θL-θ进行断言时,SP无法区分.所以,对任意θ,都存在一个θH+θL-θ使得针对这两个值进行的断言,SP无法区分.对应的断言判断元组分别为A={θ,B}和A={θH+θL-θ,B},这两个断言判断元组互为无差别的断言判断元组.不妨设存在两次针对不同值的θ和θ的断言,其对应的断言判断元组分别是A={θ,B}和A={θ,B},其中B={value1,value2},B={value1,value2}.那么对于A和A均存在使得SP无从区分的无差别的断言判断元组Aa和Aa,其中Aa={θa,B}={θH+θL-θ,B}和Aa={θa,B}={θH+θL-θ,B},那么当θ>θ或者θ<θ时,(θH+θL-θ)<(θH+θL-θ)或者(θH+θL-θ)>(θH+θL-θ),即θa<θa或θa>θa.所以,对于任意的一对断言元组B和B,如果其分别是针对{θ,θ|θ>θ}进行断言,那么必然存在针对{θH+θL-θ,θH+θL-θ|θ>θ}的断言,其对应断言元组也是B和B.所以,对于任意一对断言元组,SP无法判断DO选择的θ的大小关系.所以当DO选择相同的θH和θL时,在任意两次断言为真的情况下,SP无法判断DO在这两次判断中选择的θ的大小关系.定理8.方案SRQSAE中的区间陷门是检索结果安全的.在方案SRQSAE中,判断一个敏感数据是否属于检索区间时,需要向SP提供检索区间陷门T=sinθ[]L犕-1cosθL烅烄烆数据的索引犐=[cosθsinθ]犕,其中T的前两个数据可以交换位置.由于区间陷门和区间索引本身不会泄露检索区间和敏感数据的真实信息,SP获得区间陷门和区间索引的信息不会影响到检索区间和敏感数据的安全性.同时区间陷门和区间索引都是通过矩阵相乘进行保护的.由定理5可以看出,在唯密文的情况下,区间索引和区间陷门不会泄露真实的敏感数据,而且也可以保护敏感数据之间的大小关系.检索时,需要将检索陷门中的犜1和犜2分别与犐进行相乘,获得cos(θ-θL)和cos(θ-θH)的值,最后与cos(θH-θL)进行比较.由于区间陷门和索引本身不会泄露真实的敏感数据以及敏感数据的大小关系,所以SP根据区间陷门和区间索引无法获得相应的有效信息.检索时,还将向SP泄露cos(θ-θL)、cos(θ-θH)和cos(θH-θL)这3个值.由定理7,当只泄露cos(θ-θL)、cos(θ-θH)和cos(θH-θL)时,SP完全无法区分两个被检索值之间的大小顺序信息.由于定理7的证明过程也是通过寻找两对大小关系相反,且均满足条件的θ来证明的,所以它们的大小关系判断不会受到其它检索结果之间的大小关系的影响.所以方案SRQSAE中的区间陷门是检索结果安全的.综上,方案SRQSAE中的区间索引的安全性可以达到排列安全的要求.根据定理6和定理8,其区间陷门不仅可以满足区间陷门的归并特征安全的需要,而且对于每次检索,均能达到区间陷门的检索结果安全.所以,方案SRQSAE的安全性满足了区间检索的唯密文安全的要求.5复杂性分析本方案是针对外包数据库(ODB)和云存储(CloudStorage)考虑的.由于数据外包主要是在DO不具备强大的存储能力或DO具有可移动的特点的情况下应用的,所以方案的复杂性考虑主要集中于客户端的存储空间复杂性和服务器计算时间复杂性.不妨设总的记录数为n.进行方案部署时,如果客户端需要存储较多的元数据,那么该方案的布署会降低DO的可移动性,降低整个方案的可用性.本方案中,需要在客户端存储可逆矩阵犕以及外包数据的值域D,而逆矩阵犕-1可以通过犕计算获得,所以只需要获得犕和D,就可以计算获得密钥K={犕,犕-1}和D.无论外包数据的分布规律如何,该方案在客户端的存储空间复杂性为O(4r+r)=O(1),r为犕和D中每个数据需要的存储空间.而对于每个桶内均有d个数据的分桶方案而言,DO需要了解每个分桶的范围以及桶标识,其客户端的空间复杂性为O(tn/d)=O(n),t为客户端保存桶的信息所需要的空间.编码方案中,客户端需要保存所有数据的对应的长度为Page10L的编码以及前缀保序加密的密钥,不妨设B+树每层均有一个flip点,那么密钥的存储空间为slog2n,s为密钥的长度,客户端空间复杂度为Ο(Ln+slog2n)=Ο(n).服务器的计算时间主要是在进行密文区间检索时服务器检索花费的时间,其体现了密文区间检索方案的检索效率.本方案在对一个区间索引进行检索时,无论检索区间的上下界为多少,其只涉及1×2矩阵和2×1矩阵相乘两次,数字相乘一次和比较运算一次,可以归纳为五次乘法、两次加法和一次比较运算.其服务器的计算复杂性固定为O(5an+2bn+cn)=O(n),其中a、b、c分别是乘法、加密、比较运算的时间代价.而桶内数据个数恒定的方案中,如果不对区间索引进行运行时优化处理,最优情况是检索区间只覆盖到一个分桶,其计算复杂性O(cn)=O(n);最坏的情况是检索区间覆盖所有的分桶,即n/d个分桶,其计算复杂性O((n/d)cn)=O(n2).编码方案中,最优的情况是检索区间只能分解出一个检索子区间,即O(cn)=O(n),而检索区间能分解出的检索子区间的上限为2(n-1),那么对于每个区间索引,均需要进行2(n-1)次匹配,服务器的计算时间复杂性O(2(n-1)cn)=O(n2).本方案Ο(1)Ο(n)Ο(n)分桶方案Ο(n)Ο(n)Ο(n2)编码方案Ο(n)Ο(n)Ο(n2)注:分析上述区间索引时,均不考虑具体实现时对区间索引的优化处理.为了简化分析,选择的桶的划分方式为每个桶包含固定数目的数据.综述所述,由表1可以看到,本方案所需要客户端的元数据存储空间不随数据量的变化而变化.在检索时,服务器的计算复杂性也不随检索区间的变化而变化.所以,本方案中客户端的空间复杂性和服务器的时间复杂性维持在一个定值上.与现有的两个方案相比,不仅需要较少的客户端元数据存储空间,且在最坏情况下,服务器的时间复杂性也比较有优势.6结论在本文中,我们提出了一种从区间判断到单断言的转换方法,并将该方法应用到密文区间检索方案中,获得了基于单断言的密文区间检索方案.该方案使得区间陷门的构建完全基于检索区间的上下界,避免了区间陷门泄露归并特征的安全隐患,并且减少了客户端元数据的存储空间.同时针对密文区间检索的特点,提出了相关概念来定义区间索引和区间陷门的安全,并证明本文方案满足这些安全要求.本文的密文区间检索方案获得了比现有方案更高的安全性.不仅保护了敏感数据不被泄露,保护了敏感数据的大小关系等信息,使得该方案可以满足高安全的密文区间检索的需要.同时该方案不差于现有密文区间检索的检索效率,使得该方案具有极大的应用前景.目前,本文提出的密文区间检索方案限于唯密文的场景,对于服务器了解敏感数据相关背景或服务器了解部分索引与敏感数据的对应关系等场景均未涉及,这部分研究将在后续工作中进行.
