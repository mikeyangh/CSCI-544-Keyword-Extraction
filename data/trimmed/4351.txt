Page1一种不确定图中最可靠最大流问题的解决方案张柏礼1),2)吕建华1),2)生衍1)田伟3)1)(东南大学计算机科学与工程学院南京211189)2)(计算机网络和信息集成教育部重点实验室(东南大学)南京211189)3)(南京弘毅电气自动化有限公司南京210039)摘要最可靠最大流是不确定图中可靠性最高的最大流,它是传统最大流问题在不确定图上的自然延伸.现有的最可靠最大流算法SDBA时间复杂性较高,无法满足实际中不同应用的需求,为此,文中提出一种具有普遍适用性的最可靠最大流解决方案.该方案包含面向不同需求的3种算法:基于负权群落消去的NWCE算法、基于时间约束优先单环消去的SPEA-t算法和基于概率阈值约束优先单环消去的SPEA-p算法.其中,NWCE算法借鉴最小费用最大流的“流平移”思想并基于文中提出的负权群落概念,在辅助剩余图中不断地消去可使可靠性增加而流量不变的负权群落,可证当消去所有负权群落时对应的最大流即为最可靠最大流.根据负权群落中由单环组成的群落占很高比例且相对于多环组成的群落更易查找和消去的性质,同时考虑到NWCE算法为了获得最优解,往往为了消去最后少数几个对概率提高贡献很小的负权群落却花费了很长时间的现象,提出SPEA-t和SPEA-p两种快速近似算法,前者是以规定时间内尽可能逼近最优解为目标,后者是以最少时间达到预设的概率阈值为目标,它们都采用了优先消去概率-时间效益较好的单环群落的策略,加快对最优解的逼近速度,减少或放弃时间开销较大的多环群落的消去,以满足那些对算法时间性能要求很高而结果以近似最优即可的应用需求.实验表明,相对于SDBA算法,NWCE算法结合概率剪枝策略在时间性能上有了数量级的提高,而SPEA-t算法和SPEA-p算法则具有更高的性能和更好的适用性.关键词不确定图;最大流;流可靠性1引言随着认知水平的提高,人们认识到不确定性是事物的固有特性.当不确定性表现在输配电网、交通运输网等这些网络结构形式的系统中时,可以借助不确定图来描述这类系统中对象之间复杂的数据关系,其数据刻画能力往往优于其它数据模型(其中包括关系数据模型),因而有关不确定图的理论和应用研究,已逐渐引起了人们的关注,很多有价值的问题及其处理方法近年来不断被提出[1-16].首先,对于不确定子图,文献[1-2]就不确定图中如何挖掘最可靠子图进行了深入的研究,依次用路径覆盖、启发式的贪心算法、蒙特卡洛仿真等算法解决该问题;邹兆年、张硕、韩蒙等人[3-7]分别研究了不确定图上频繁子图挖掘、不确定图数据库查询处理等问题,针对挖掘模型构建、降低子图同构的时间复杂度以及k极大频繁模式挖掘等,提出了有效的算法;而Yuan等人[8]使用过滤-验证的思想研究了子图相似性查询,利用概率矩阵索引筛选过滤候选集,再通过取样算法验证相似性.其次,对于不确定图上的可达性、近邻查询等问题,文献[9-12]分别提出了各自的k近邻的定义和高效的查询处理算法解决top-k近邻查询;张应龙等人[13]则提出了基于SimRank度量的方法求解不确定图的k-NN查询;文献[14]则给出了不确定图中AggregateNearestNeighbor(UG-ANN)查询的定义,并提出了基于结构剪枝和距离剪枝的处理方法;文献[15-16]在不确定图上拓展了最短路径问题,并给出了很有参考意义的解决思路和算法.另外,随机流网络的可靠性计算作为运筹学的经典问题同样也是不确定图研究的重要领域,该问题被证明为NP-hard问题[17].文献[17-20]对该问题进行了深入的研究,提出了很多有效的精确算法和近似算法.蔡伟等人在文献[21]中提出的不确定图中s-t最可靠最大流分布问题是传统最大流问题在不确定图中的自然延伸,其研究的是在所有能够传递最大流的分布中选择可靠性最高的一个,作为最大流传递的首选方案.这是一个重要的决策优化问题,关系到如何充分利用现有网络条件去选择最可靠的流传递实施方案,以及从具体流传输方案角度进行网络可靠性评估.然而该文中提出的基于状态空间划分算法SDBA,虽然通过空间划分避免了所有状态空间的枚举,但较高的时间复杂性导致该算法应用受到很大的局限,只适合于中小规模网络或对时间性能要求不高的场合,如网络的静态可靠性分析.为此,本文拟借鉴最小费用最大流的“流平移”思想[22-23],并基于负权群落这一新概念,设想从一个新的角度研究最可靠最大流问题求解的系统性方案,来满足实际网络中各种不同的应用需求.最可靠最大流问题属于带有容量、概率的二元属性最大流问题,从这个意义上看,可以借鉴同类问题———最小费用最大流的“流平移”算法来解决该问题,即在辅助剩余图中不断地消去能使可靠性增加而流量不变的概率意义上的负权环,以期获得最可靠最大流,然而由于可靠性与流量之间是一种分段函数关系,不同于费用与流量之间的线性函数关系,故负权环全部消去后无法保证能够得到最可靠的最大流.为了解决该问题,本文提出负权群落的概念,在此基础上提出一种基于负权群落消去的最可靠最大流算法NWCE(NegativeWeightCommunityEliminationalgorithm),该算法同样也是借鉴最小费用最大流的“流平移”思想,从任一最大流分布开始,通过在辅助剩余图中不断地消去可使可靠性增加而流量不变的负权群落,来得到可靠性更高的最大流,直到消去所有的负权群落.这时对应的最大流分布可证明即为最可靠最大流.NWCE算法虽从时间复杂度上相比于SDBA算法有了很大改进,但由于在负权群落查找和消去过程时间开销较大,导致NWCE算法时间复杂度仍然偏高,其应用同样有较大的局限性,仅适合于对时间性能要求不高的最可靠流问题的精确求解.通过对NWCE算法求解过程的分析,发现在负权群落中由单环组成的负权群落即单环群落占很高比例,且比多环组成的群落更易查找和消去,而多环构成的群落比重很少却需要花费很大比例的时间开销去查找消去,为此,提出两种优先单环消去的快速近似算法即基于时间约束优先单环消去的最可靠最大流近似算法SPEA-t(Single-Page3circlePreferenceEliminationApproximatealgorithmwithatimeconstraint)和基于概率阈值约束优先单环消去的最可靠最大流近似算法SPEA-p(Single-circlePreferenceEliminationApproximatealgorithmwithaprobabilityconstraint),以满足那些对算法速度要求很高而结果能够近似最优即可的应用.其中SPEA-t算法的基本思想是在规定的时间内优先查找、消去单环群落,当不存在单环群落时再寻找、消去多环群落,加快对最优解逼近.而SPEA-p算法考虑到在负权群落消去的过程中,到了最后剩余的负权群落的查找往往需要很大的时间开销,但消去后对可靠性的提升却很有限,故以逼近最优解的程度作为约束,同样优先查找、消去单环群落,当算法达到预设的可靠度阈值就结束,避免花费大量的时间用于那些对可靠性提升很小的负权群落的消去(无论是单环群落或是多环群落).从算法选择使用角度看,上述的3种算法有各自特点和不同的应用范围,具有很好的互补性,故本文将它们组合成一个完整的解决方案,以满足不同的用户需求,为在实际网络得以真正应用创造可能.2相关概念本节对不确定图、不确定图s-t流、不确定图s-t流的可靠性等概念给出了相关的定义,为问题和算法的描述提供方便.定义1.不确定图.一个不确定图G是一个四元组G=(V,E,C,P),其中,V是不确定图G中顶点的集合,E是边的集合,C:E→N是边上容量函数,P:E→(0,1]是边上的概率函数,表明该边存在的概率.为了方便叙述,下文将边e的容量记为c(e),边e的存在概率记为p(e).例1.图1所示为一不确定图,该不确定图的顶点集V={0,1,2,3},边集E={e01,e02,e12,e13,e23},以边e12为例,边上的容量c(e12)=2,概率p(e12)=0.65.定义2.不确定图中s-t流.给定源点s和汇点t,不确定图G上的s-t流f是一个映射,它把每条边e对应到一个非负实数,f:E→R+;值f(e)表示由边e携带的流量,它必须满足下面两个性质:(1)(容量条件)对每条边e∈E,有0f(e)c(e).(2)(守恒条件)除了s和t之外,对每个结点v,有∑e:e→vf(e)=∑e:v→e和等于所有从v出来的流值之和.定义3.不确定图s-t流的可靠性.不确定图s-t流f的可靠性R(f)等于其所有非0流边e的概率之积[21],即R(f)=∏e∈E定义4.不确定图最大流.不确定图G中,在每条边都存在时,能够从源点s到汇点t传输的最大流值fmax为不确定图G的最大流.定义5.不确定图最可靠最大流.一个不确定图最可靠最大流是一个不确定图最大流,其可靠性不小于该不确定图上的任一最大流.例2.图2所示为图1中不确定图中存在的最大流分布f1、f2、f3,其中源点是0,汇点是3,则根据定义3可得到R(f1)=0.6×0.7×0.65×0.7×0.9=0.17199,R(f2)=0.6×0.7×0.7×0.9=0.2646,R(f3)=0.6×0.7×0.65×0.7×0.9=0.17199,根据计算结果可知,流f2的可靠性高于流f1与流f3的可靠性,为最可靠最大流(在二态不确定图中f1和f3,对应于相同的可能子图,故可被视为同一分布).不确定图上的最可靠最大流问题即为给定不确定图G及源点s和汇点t,求G上的一个最可靠最大流.定义6.不确定图的剩余图.给定不确定图G=(V,E,C,P)和G上的流f,则其剩余图Gf为:(1)Gf与G具有相同的节点集;(2)对于G中从i到j的边eij,在Gf中存在正向边eij,其容量等于eij在G中的容量减去eij的流量;同时在G中存在从j到i的反向边eij,其容量等于eij的流量.例3.图3中所示为图2中图的流分布为f1Page4的剩余图.以不确定图中边e13为例,f(e13)=2,c(e13)=4,因为2小于4,运用定义5中的性质2可得到剩余图中边e13、e31的容量分别为2、2.c(e).定义7.循环流cycle_f.循环流cycle_f是一个函数,它把剩余图的每条边e映射到一个非负实数,cycle_f:E→R+;值cycle_f(e)表示由边e携带的流量,它必须满足下面两个性质:(1)(容量条件)对每条边e∈E,有0f(e)(2)(守恒条件)对每个结点v,有∑e:u→vf(e),u∈V,即所有进入结点v的流值之和等∑e:v→u于所有从v出来的流值之和.例4.图4所示为图3剩余图中的一个循环流f,对于流中的结点v1,v2,v3,均有进入结点的流量之和等于从结点流出的流量之和,且各边流量均满足容量条件.的一个循环流,以下简称为“预流”.定义8.预推进流f.预推进流是指剩余图中可假想在不确定图G推进该流,然后配合权重规则来确定其中每一条边的权重.定义9.权重规则.令f(e)为边e的预流,w(e)为权重,eij为正向边,eji为反向边,则权重规则如下:-lnp(eij),w(eji)=0.(1)若f(eij)=0,f(eij)>0,则w(eij)=(2)若f(eij)>0,则w(eij)=0,w(eji)=0,f(eji)<f(eij)定义10.负权环.负权环是剩余图上的一个环形结构,该环形结构上的循环流为f,以f为预推进流,根据权重规则可得到整个环的权重为负.例5.图4为剩余图中相对于图中循环流的一个负权环.其中,边e21上为反向边,且有f(e21)=f(e12),因而其权重为lnp(e12)=ln0.65,边e32同为反向边,但其f(e32)<f(e23),权重为0,边e13为正向边,且f(e13)>0,因而权重为0,所以整个环的权重为ln0.65<0.负权环的一个重要性质就是:负权环消去后,将获得一个可靠性更高的最大流分布.3基于负权群落消去的最可靠最大流算法本节针对不确定图上最可靠最大流问题,分析了最小费用最大流的“流平移”思想在解决该问题时存在的问题,给出了负权群落的概念,进而提出了基于负权群落消去的最可靠最大流算法NWCE.3.1算法的基本思想然而在最小费用最大流问题中,费用的函数为对于二元属性的最大流问题,最小费用最大流问题已经有了较为成熟的算法体系,一种常用的方法是预先求出一个最大流分布,然后在保证最大流不变的前提下,通过最大流的平移来向最小费用推进.最可靠最大流问题属于带有容量、概率的二元属性最大流问题,只是另一元属性由费用变成概率,因此从这个角度看,也可以借鉴最大流的平移思想,通过消去概率意义上的负权环来解决最可靠最大流问题.cost(f)=∑e∈E流值,k(e)为边e上的费用,由该函数可以看出每条边上的费用与流量呈线性关系,流网络中的总体费用为各个边费用之和;在最可靠最大流问题中,流网络中流的可靠性为所有非0流边的概率之积,虽然可通过对乘积取对数,将乘积转化为可靠性概率对数之和,然而从可靠性计算公式可以看出,在每条边上,可靠性与流量呈分段关系,当该边上有流量通过时,不管其大小是多少,只要不超过该边的容量,其可靠性为该边存在的概率p(e).这种分段相关性而非连续线性相关,使得所有消去概率意义上的负权环不一定得到最可靠最大流,为此,本文对负权环的概念进行了扩展,提出负权群落的定义.定义11.负权群落.负权群落是剩余图上的Page5由一或多个环构成的群落,群落中各环通过一条或者多条共享边连接在一起.若在该群落上存在一个循环流f,使得以f为预推进流,按照权重规则,整个群落的权重和为负值.NWCE算法正是基于负权群落的概念被提出来的,以弥补负权环消去无法保证得到最可靠最大流的不足.算法首先在不确定图G的最大子图上求得任一最大流分布f及其对应的剩余图Gf,接着在剩余图中查找的不再是负权环而是负权群落,并将其消去以得到一个可靠性更高的最大流分布,由于将一个负权群落消去后会对最大流分布及对应剩余图产生影响,因此需要对最大流以及对应的剩余图进行更新,然后在更新后的剩余图上查找负权群落,重复上述步骤直至剩余图中不存在负权群落为止,此时对应的最大流分布即为最可靠最大流,3.2算法的实现根据上述分析,下面给出基于负权群落消去的最可靠最大流算法NWCE的算法实现(伪代码).算法1(a).NWCE算法.输入:不确定图G,源点s和汇点t输出:最可靠最大流分布f及其可靠性Pf1.Relabel-to-Front(G,f,s,t);2.ComputeRemain(G,f,Gf);3.whileComCircleexist4.ComCirclesEliminate(G,f,Gf);5.UpdateRemain(G,f,Gf);6.UpdateFlow(G,f,Gf);7.ComputeReliability(G,f,Pf)8.Output(f,Pf)Relabel-to-Front函数是使用重标记与前移算法[23]求得不确定图G中的一个最大流,并存放于向量犳中,ComputeRemain函数用于计算出f对应的剩余图Gf,ComCirclesEliminate是在剩余图Gf中查找负权群落并消去,UpdateRemain对剩余图进行更新和函数,UpdateFlow对最大流分布进行更新,然后继续查找负权群落,函数ComputeReliability计算f对应的可靠性,最后通过Output函数将最可靠最大流分布及对应的可靠性输出.负权群落查找和消去模块ComCirclesEliminate是实现整个算法的核心,其基本思路如下:(1)首先使用Johnson算法[24]查找出剩余图中所有的环;(2)依次对剩余图中的每条边eij进行处理,确定剩余图中包含该边的环,并计算出这些环在除去该边时,路径Pji能通过的最大预推进流f,并在f的基础上求出路径Pji的权值;(3)若该边为正向边,对(2)中的权值由小到大进行排序,按序取权值小于0的环,且这些环中路径Pji的预推进流f之和小于等于边eij的容量.若存在满足上述条件的环,则转到(5);(4)若该边为反向边,列出包含该边的环的所有组合,依次判断这些组合中是否存在负权群落.若存在,则转到(5);(5)保存该负权群落及其对应的预流,并且函数返回true;(6)当所有的边都遍历完成,且函数没有返回true,则函数返回false.下面即为算法的伪代码描述.算法1(b).负权群落查找和消去模块.输入:不确定图G,剩余图G犳输出:存在负权群落返回true并将负权群落及对应的预1.Johnson(Gf,circuits);2.foreijinGf3.ifcirclesContainEdge(circuits,eij,circles);4.ifeijistheforwardedge5.sortthecirclesaccordingtoweight6.getthecircleswhichweight<07.computePreflow(G,NC,preflow)8.weight=computeWeight(G,Gf,NC,preflow);9.ifweight<010.returntrue;11.ifeijisthereverseside12.enumerateallthecombinationofcircles,13.forNCincomb14.computePreflow(G,NC,preflow);15.weight=computeWeight(G,Gf,NC,preflow);16.ifweight<017.returntrue;18.returnfalse;3.3算法的正确性证明为了说明基于负权群落消去算法最终能够正确求得最可靠最大流,下面首先证明了负权群落消去算法中将权值为负的群落消去后可得到一个可靠性更高的最大流的重要性质.然后在该性质的基础上证明了如果算法终止,则求得的最大流是最可靠的.最后证明了算法能够终止.性质1.在最大流分布f对应的剩余图中,若存在一个群落,当该群落中通过一个最大流值为f的循环流时,如该群落为负权群落,那么通过在流分布f增加循环流f消去该负权群落,可以得到一个可靠性更高的流分布f1.证明.将负权群落中的边分为正向边和反向Page6边考虑.根据权重规则定义可知,无论边e是正向边还是反向边,该边上的权重都存在两种情况,即权值为0和非0的情况.由于权值为0的边对整个群落的权值并没有影响,因此对负权群落中权值非0的边进行考虑.设在最大流分布f对应的剩余图中,存在一个群落,且在该群落同过一个最大流值为f的循环流时,根据权重规则可得到整个群落的权值为负,边ei1,ei2,…,eim是负权群落中权值非0的正向边,边ej1,ej2,…,ejn是负权群落中权值非0的反向边.所以该负权群落的权值W(NC)=w(ei1)+w(ei2)+…+w(eim)+w(ej1)+w(ej2)+…+w(ejn)=-lnp(ei1)-lnp(ei2)-…-lnp(eim)+lnp(ej1)+lnp(ej2)+…+lnp(ejn).因为整个群落的权值为负,所以W(NC)<0,所以-lnp(ei1)-lnp(ei2)-…-lnp(eim)+lnp(ej1)+lnp(ej2)+…+lnp(ejn)<0,即有lnp(ej1)+lnp(ej2)+…+lnp(ejn)<lnp(ei1)+lnp(ei2)+…+lnp(eim).通过对不等式的变换即可得到p(ej1)p(ej2)…p(ejn)<p(ei1)p(ei2)…p(eim).从另一方面看,在负权群落中推进预流为f时,最大流分布f1的可靠性变化可根据权值非0的边分为如下两种情况:若该边为正向边,则f1的可靠性等于f的可靠性乘以该边对应的概率值;若该边为反向边,则f1的可靠性等于f的可靠性除以该边对应的正向边上的概率值.则消去该负权群落后的可靠性P(f1)=P(f)(p(ei1)p(ei2)…p(eim))/(p(ej1)p(ej2)…p(ejn))>P(f).因此在最大流分布对应的剩余图中,若存在一个负权群落,将该负权群落消去即可得到一个可靠性更高的最大流分布.性质2.在最大流分布f对应的剩余图中,若该剩余图中不存在负权群落,则f为最可靠最大流.证明.使用反证法证明该性质.假设f为最可靠最大流,f的可靠性为P,且在f对应的剩余图中,存在着权值为W且W<0的群落.根据性质1可知,将权值为W的负权群落消去,可得到一个可靠性为P的最大流f1,且P>P.这与假设中可靠性P最大相矛盾,因此当剩余图中不存在负权群落时,所对应的最大流分布的可靠性最大.定义12.瓶颈边.对于由单个环组成的群落而言,预流值等于群落预流值的边即为瓶颈;对于由多个环组成的群落而言,预流值最小的公共边即为瓶颈边.性质3.若剩余图中存在负权群落,则负权群落查找算法一定能将其找出.证明.负权群落查找算法首先枚举出剩余图中的所有环,然后在通过遍历剩余图中的所有边,判断剩余图中包含该边的环组成的群落中是否含有负权群落.剩余图中的边可分为两类,即正向边和反向边.下面根据边的分类来证明性质3的正确性.(1)正向瓶颈边eij.设环C1,C2,…,Cn包含正向边eij,则这些环中除去边eij外的所有边组成的路径Pji能通过的最大预流为pf1,pf2,…,pfn以及各个路径Pji在取最大预流时对应的权值为W1,W2,…,W3.设正向边eij能通过的最大预流为pf且对应于该预流的权值为W.首先按路径Pji上权值的大小从小到大进行排序,其排序结果如下:Wi1<Wi2<…<Win,则对应的最大预流的顺序为pfi1,pfi2,…,pfin,按如下的两个规则选取剩余图中的包含边eij的环组成群落:①Wij<0,1jn,即只选取对应路径权值为负的环;②pfi1+pfi2+…+pfimpf<pfi1+pfi2+…+pfi(m+1),即在满足①的基础上选取路径上最大预流之和不超过边eij上预流的环.根据上述的两个性质选取环后,即可得到群落C的权值W(C)=Wi1+Wi2+…+Wik+W,km.因为W是边eij上的权值,且所有群落的权值都会加上W,因此分析群落的权值大小只需要考虑选取了哪些环,根据上述的两个性质对群落C的权值进行分析,若pfi1+pfi2+…+pfim+pfi(m+1)+…+pfixpf<pfi1+pfi2+…+pfim+pfi(m+1)+…+pfi(x+1),则说明Wi1<Wi2<…<Wim<0<Wi(m+1)<…<Wix<…<Win.所以在W(C)上加上Wim之后的任一权值W(C)都会增加.若Wi1<Wi2<…<Wim<Wi(m+1)<…<Wix<0<Wi(x+1)<…<Win,则说明pfi1+pfi2+…+pfim的预流刚好不超过边eij上的预流值,又因为pfi1,pfi2,…,pfim对应环的权值是所有权值为负的环中最小的m个.求得的W(C)是最小的.综上所述,根据上述的两个性质选取包含边eij的环组成的群落的权值是最小的.因此,若在包含边eij的群落中含有负权群落,则负权群落查找算法必能找到该负权群落.(2)反向瓶颈边eji.对于反向边而言,是将包含反向边eji的所有环组成的所有群落的组合都枚举出来,然后依次计算这些群落的权值,并判断这些权值是否为负.因此剩余图中存在包含反向边的负权群落时,负权群落查找算法必能将其找出.由于在负权群落中必然存在正向瓶颈边或反向Page7瓶颈边,因此只要剩余图中存在负权群落,负权群落查找算法必然能将其找出.至此性质3得证.性质4.基于负权群落消去的算法在有限次循环后终止.证明.算法是根据将剩余图中的负权群落消去,其对应最大流的可靠性会得到提升以及当求得的最大流可靠性最高时,对应的剩余图中不存在负权群落这两个性质来实现的.通过每次在剩余图中查找负权群落并将其消去,以得到可靠性较高的最大流,随着算法的运行,最大流的可靠性会逐渐提高,直至达到最高,此时剩余图中不存在负权群落,此时算法终止.因此基于负权群落消去的算法必能在有限次循环后找到最可靠最大流并终止.3.4算法的时间复杂性分析基于负权群落消去的算法的运行效率与图的结构有着紧密的联系,图结构对算法的循环次数以及每次循环的时间都有着一定的影响.因此,基于最坏情况对算法的时间复杂度进行分析,并给出了对算法效率有影响的因素以及算法运行时间的上界.算法首先选用重标记与前移算法[23]求出一个基础的最大流分布,该算法是目前最快的最大流算法之一,其时间复杂度为O(|V|3).接着求出最大流分布对应的剩余图,其时间消耗为O(|V|2).接下来对负权群落查找算法进行分析,该算法是基于负权群落消去算法的核心,其先通过时间复杂度为O((|V|+|E|)(|C|+1))的Johnson算法求得剩余图中的所有环,其中V、E、C分别表示剩余图中的顶点数、边数以及环的个数.接着是根据每条边判断是否存在负权群落,时间复杂度为O(|C|3|E|).因此负权群落查找算法的时间复杂度为O((|V|+|E|)(|C|+1)+|C|3|E|)).在求得一个负权群落后都会对最大流分布及相应的剩余图进行更新,其更新时间为O(|V|2).由于每有一个负权群落存在就会调用一次负权群落消去的算法,因此根据负权群落消去算法的伪代码可知算法的整体时间复杂度为O((|NC|+1)((|V|+|E|)(|C|+1)+|C|3|E|+|V|2)),其中NC为负权群落的个数.最后,用于计算最大流分布对应可靠性的函数的时间消耗,以及将最大流分布输出的函数的时间消耗均为O(|V|2).综上分析,整个算法的时间复杂度上界为O((|NC|+1)((|V|+|E|)(|C|+1)+|C|3|E|+|V|2)),由复杂度分析可看出,影响算法运行效率的主要因素有剩余图的点数、边数、环的个数以及负权群落的个数,其均与算法效率呈负相关关系.由于在每次负权群落的查找过程中,在找到一个负权群落后,负权群落查找算法就会返回,因此其时间消耗远远小于上述给出的上界.NWCE的复杂度与SDBA的复杂度O(k|V||E|2)相比有较大的改善,主要因为SDBA存在着指数级的空间划分次数k.另外,算法执行中可以利用类似于SPCA算法[21]的概率剪枝策略,可以进一步降低算法的时间复杂度.4基于时间约束优先单环消去的最可靠最大流近似算法虽然基于负权群落消去的最可靠最大流算法相比于SDBA算法而言在算法效率上有很大程度的提升,但是由于在负权群落查找和消去过程中时间开销较大,导致NWCE算法时间复杂度仍然较高,难以应用于大规模网络中流可靠性问题的快速求解.实际应用中很多时候对算法速度的要求高于算法的精度,如输配电网络出现突发故障或需要临时性检修,为了保证有功/无功潮流的正常传输,这时急需一个可行的流替代方案,其对算法时间效率的要求非常高,希望在极短的时间内完成甚至满足实时调度的需求,而此时其是否是最优方案并不是最重要的.再从另一个方面来看,即使求得了最优解,但在实际中因为其他因素的约束导致其无法选用,所以某种程度上看,花费太多的时空资源追逐最优解有时候没有必要,在很多时候以较小的代价获得一个近似最优解即可,或迅速能获得多个近似最优解为用户提供更多选择或许更有意义.为此,本节基于单环组成的负权群落优先消去的策略提出一种基于时间约束的近似算法SPEA-t.4.1算法的基本思路通过对NWCE算法求解过程的分析,发现由单环组成的负权群落占有很大的比例,而且单环的查找和消去的时间开销较小,相反多环组成的负权群落不仅数量少,而且因为涉及环组合,查找和消去的开销要比单环的大得多,基于这样的认识,SPEA-t算法在规定的约束时间内优先选择消去概率-时间效益较好的单环群落,在消去所有单环群落后如还有时间再考虑查找、消去代价较大的非单环群落,从而可以在很短的时间或规定的时间得到一个近似最优解,以满足那些对算法速度要求很高而结果不一定需要最优解的应用需要.4.2算法的实现根据上述分析,下面给出基于时间约束的单环Page8优先消去近似算法的算法实现(伪代码).算法2.SPEA-t算法.输入:不确定图G,源点s和汇点t输出:最大流分布f及其可靠性Pf1.Relabel-to-Front(G,f,s,t);2.Px=EvaluateMaxReliability(G,f);3.while(SingleCircleexist&&t<T)4.ComputeRemain(G,f,Gf);5.SingleCirclesEliminate(G,f,Gf);6.ComputeReliability(G,f,Pf);7.while(ComCircleexist&&t<T)8.ComputeRemain(G,f,Gf);9.ComCirclesEliminate(G,f,Gf);10.ComputeReliability(G,f,Pf);11.Output(f,Pf)与NWCE算法精确算法一样,SPEA-t算法第1步通过Relabel-to-Front求出一个最大流分布f,然后计算对应的剩余图Gf,接着使用SingleCircles-Eliminate查找由单环组成的负权群落并将其消去,当单环群落全部消去后仍然有剩余时间时才进行非单环群落的消去,最后输出求得最大流分布及对应的概率值.根据第3节的分析可知,在基于单环优先消去的近似算法中,第1行的最大流算法的时间复杂度为O(|V|3),第3行到第6行用于查找并消去由单环组成的负权群落算法的时间复杂度为O(|V|2|C|),则算法前半段时间复杂度为O(|V|3+|V|2|C|),第7行到第9行时间复杂度为多环群落消去的复杂度.5基于概率阈值约束优先单环消去的最可靠最大流近似算法SPEA-p算法也是一种单环优先消去的近似算法,与SPEA-t算法主要的不同在于以逼近最优解的程度作为约束,其出发点是考虑到NWCE算法负权群落消去的过程中,往往到了最后剩余的负权群落的查找需要很大的时间消耗,但消去对可靠性的提升却非常有限,因而意义不大,可以考虑对最后的若干负权群落不予查找消去,即以逼近最优解的程度作为约束,即当算法达到预设的可靠度就结束,以避免花费大量的时间用于那些对可靠性提升很小的负权群落的查找消去.5.1概率阈值的设定与算法SPEA-t相似,算法SPEA-p同样也是优先消去单环群落,当所有单环群落都消去后,如概率仍然达不到设定的阈值,才考虑多环组成的负权群落的消去.其中概率阈值一般根据实际中对可靠性的具体要求,以逼近最优解的程度来设定,如最优解的95%或80%,但由于算法运行时并不知道最可靠最大流的概率即最优解的大小,所以需要研究一定方法进行进行最优解的预测.然而最优解的预测是一个非常复杂的问题,影响的因素非常之多,在有限的时间内要想精确预测几乎不可能,只能结合一些经验公式给出一个大致的范围,为概率阈值的设定提供帮助[25],因文章篇幅关系,关于这方面更详尽的分析和实验过程将另文阐述.5.2算法的实现根据前面关于算法的分析,给出基于概率约束的单环优先消去近似算法的算法实现(伪代码).算法3.SPEA-p算法.输入:不确定图G,源点s和汇点t输出:最大流分布f及其可靠性Pf1.Relabel-to-Front(G,f,s,t);2.Px=EvaluateMaxReliability(G,f);3.while(SingleCircleexistP<βPx)4.ComputeRemain(G,f,Gf);5.SingleCirclesEliminate(G,f,Gf);6.ComputeReliability(G,f,Pf);7.while(ComCircleexist&&P<βPx)8.ComputeRemain(G,f,Gf);9.ComCirclesEliminate(G,f,Gf);10.ComputeReliability(G,f,Pf);11.Output(f,Pf)该算法与SPEA-t算法一样,首先通过Relabel-to-Front函数求出一个最大流分布f,然后计算对应的剩余图Gf,然后优先消去单环群落,只有当单环群落全部消去概率值仍然无法达到概率阈值时才进行非单环群落的消去,关于时间复杂度分析同SPEA-t算法.针对前面所提及的在实际应用中所求得的最大流的最优分布或较优分布,因为其他因素的制约导致无法实施的问题,可以简单改写上面所提的3个算法来解决,即在求解的过程中将前k个较优的最大流分布都予以保存并输出,结合其他约束进行选择,以满足用户的需求.Page96比较实验为了验证文中所提算法的性能,本文进行了一系列的实验,主要分为3个阶段:第1阶段在不同规模不同稠密的合成数据集上,进行了NWCE算法和SDBA算法的性能比较.第2阶段利用不同数据集包括实际的TEPN数据,通过分组实验观察近似算法SPEA-t在分别花费精确算法NWCE的5%、10%、20%、40%时间时,所求得的近似解对最优解即最可靠最大流逼近程度,检验优先消去比重很大的单环群落的效果,也就是检验近似算法的精确性.第3阶段将概率阈值设为最优解的95%、90%、85%时,观察第2个近似算法SPEA-p在不同数据集中表现出的精度损失与时间效益之间关系,检验放弃或部分放弃开销较大负权群落的查找消去以获得算法性能提高这一策略的可行性.6.1实验环境和测试数据集实验平台为一台IntelPeutium(R)Dual的PC机(CPUE21802.00GHz,内存1GB,32位Ubuntu12.04操作系统),算法采用C/C++编写,编译器环境为gcc4.6.3.为了方便与SDBA算法(也移植为Ubuntu版本)进行比较,实验中除了增加了中国台湾电网这个实际的TEPN数据集外[14],基本采用了与文献[21]相同的测试数据集,具体分为以下3种不同情况:(1)通过有向图生成器NETGEN[26]生成V6A10、V8A14、V10A18、V12A22、V14A265组有向图,其中VnAm表示有n个顶点、m条边组成的图集合(本实验中集合大小为5~20之间),与文献[21]类似,实验过程中,选取任意两点之间简单路径数量最多的端点作为起点和终点,以保证s到t有尽可能多的路径方案.(2)在图的顶点个数固定(实验中顶点为14),边的数量按照文献[24]所定义的图稠密度t=2|A|/|V|×(|V|-1)(实验中稠密度t分别取0.25,0.3,0.35,0.4,0.45)的前提下,通过NETGEN产生需要的图,图中边的容量与对应概率满足随机分布,其源点和汇点的选取策略同第1类数据集.(3)使用TEPN中国台湾电网数据作为实际数据集,图5为TEPN网络拓扑结构(其中|V|=25,|A|=58,s=1,t=25),在实验中,从TEPN附带的100个不确定组件库中随机取得58个组件用于构建中国台湾电网的不确定边.6.2算法性能比较本节主要通过在不同数据集、不同图规模以及稠密度的条件下,比较各种算法在时间性能、内存消耗或算法精度方面的差异.实验1.选用第(1)类数据集,图中的容量和对应概率按随机、均匀、正态(σ=0.2,1.0,1.8)进行组合,比较不同图规模下SDBA算法与NWCE算法的性能.图6(a)是边的容量与对应概率满足均匀分布图6图规模分别与时间开销、内存开销的关系Page10时的比较结果(实验中这种分布组合对SDBA算法最有利),可见,NWCE算法相对于SDBA算法在时间性能方面有了数量级的提升,随着图规模(边数)的增大,两个算法所消耗的时间也在增大,这是因为随着边数的增大SDBA算法的状态空间在增大,故其所需要划分的次数也随之增多,所消耗的时间也随之增加.NWCE算法所消耗的时间同样也随着边数的增多而增加,这是因为随着边的增多,不确定图中的环形结构也随之增多,但NWCE基本保持着对SDBA算法数量级上的优势.图6(b)是两种算法内存消耗方面的比较,两者在空间开销方面差别不大,且都随着图规模的增长而增加.实验2.选用第(2)类数据集,考察不同稠密度对SDBA与NWCE性能的影响.图7中所示是在相同顶点数(|A|=14)的情况下,边的稠密度由0.3以0.05的幅度递增到0.5.分析图中数据后可知,随着稠密度的递增两个算法的时间效率总体上是呈递增趋势的,同样相对于SDBA算法,本文提出的算法在保持性能优势的同时,具有较缓的增长幅度.实验3.选取第(1)类数据集中的V12A22、V14A26的两组数据集(每组集合扩大为20,即每组含有顶点边数量相同但拓扑不同的20个图)以及第(3)类数据集即TEPN实际数据集,分别计算近似算法SPEA-t在花费精确算法NWCE的5%、10%、20%、40%时间时,其求得近似解对最优解的逼近程度(对V12A22、V14A26是集合中每一个图的概率值与最优值比的平均值).图8显示SPEA-t算法在开始阶段可以花费较少的时间查找消去比重很大的单环群落,迅速获得近似较优的分布,而算法的后半段花费了大量的时间用于消去多环群落,但对于可靠度的提升有限,因而如果应用中并不要求最优解,则牺牲部分精度来获得计算时间的节省是有意义的也是可行的.另外在实验数据统计的过程中发现,在花费5%~20%的时间消去所有单环群落后,绝大多数可以直接获得最优解(大概90%),只有个别图需要消去多环群落才能最终得到最优解,这验证了单环优先消去近似求解策略可行性.实验4.同样选取第(1)类数据集中的V12A22、V14A26的两组数据集以及第(3)类数据集,分别计算近似算法SPEA-p分布在精度达到最优解的95%,90%,85%时,其花费时间的百分比(与求得最优解比).与SPEA-t算法的结果类似,图9表明,如果可以适当降低算法的精度,算法SPEA-p通过优先消去单环群落,减少或避免非单环群落查找和消去,可以很大幅度上节省算法的时间花费,表明了放弃部分查找开销较大负权群落的消去获得算法性能提高策略的可行性,也体现了近似算法有其重要的存在意义和应用价值.7结论针对现有的解决最可靠最大流问题的SDBA算法性能方面的不足和应用的局限性,借鉴了最小费用最大流的“流平移”思想,本文提出了一个完整的基于负权群落消去的解决方案,该方案包括NWCE、SPEA-t和SPEA-p3种算法,其中NWCE算法通过不断地消去可使可靠性增加的负权群落直到消去所有负权群落最终得到最可靠最大流,实验Page11表明,相对于SDBA算法,NWCE算法结合概率剪枝策略在时间性能上有了数量级的提高.为了进一步提高算法的性能,SPEA-t和SPEA-p在NWCE算法的基础上,在特定的约束条件下通过优先消去比重很大的单环群落,以尽快获得较优解,而减少或避免时间开销较大的非单环群落的消去,满足部分应用对计算时间开销更少的需求.实验结果验证了这种通过适当牺牲算法精度获取更好时间性能的近似算法的有效性和可行性.目前算法仅是单机单线程的版本,对于规模很大的不确定图,后期研究将利用负权群落仅存在于强连通分量这一重要特征,考虑以强连通分量为单位进行图的切割,对算法在分布式多机系统上的移植进行探索,以进一步提高算法的性能,为算法在大规模实际网络中的应用创造可能.
