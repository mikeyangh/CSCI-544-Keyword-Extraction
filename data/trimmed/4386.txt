Page1无核相关向量机在时间序列预测中的应用韩敏许美玲穆大芸(大连理工大学电子信息与电气工程学部辽宁大连116023)摘要针对采用核函数方法预测多元混沌时间序列时存在的高计算复杂度问题,该文在相关向量机的基础上,提出了一种不受核函数约束的无核相关向量机学习模型.利用储备池代替核函数,构建高维特征空间,将原始时间序列预测问题转化成与储备池参数相关的回归问题.在稀疏贝叶斯学习的框架下,给模型参数施加一个条件概率分布的约束,以得到稀疏的解空间,进而降低模型的复杂度,提高计算速度和预测精度.基于Lorenz混沌时间序列及太阳黑子-黄河径流量序列的仿真结果验证了所提模型的有效性.关键词核方法;储备池;相关向量机;时间序列预测;机器学习1引言以支持向量机为代表的核函数方法在时间序列预测领域被广泛使用,涌现了大量的研究成果[1].Page2函数不受Mercer条件限制,在遥感、通信和电力等工业生产过程中得以使用[3-5].然而,不论是支持向量机,还是相关向量机,在处理递归结构问题时,都无法有效地进行动态模式匹配.由于神经网络具有强大的非线性映射能力以及丰富的动态机制,被广泛地应用到时间序列预测研究领域[6],如径向基函数网络(RadialBasisFunctionNeuralNetwork,RBFNN)[7]、极限学习机(ExtremeLearningMachine,ELM)[8-9]和回声状态网络(EchoStateNetwork,ESN)[10-11]等.文献[12]在回声状态网络基础上,提出支持向量状态机(SupportVectorEchoStateMachine,SVESM)模型,利用ESN中的储备池构建特征空间,并在其中运用支持向量回归(SupportVectorRegression,SVR)算法,对混沌时间序列进行预测.但是,在采用SMO(SequentialMinimalOptimization)算法对模型参数进行优化求解时,超参数需要通过交叉检验确定,计算速度较慢[13],无法体现出储备池将非线性问题线性化后求解简单的优势.针对上述问题,本文提出了无核相关向量机(RelevanceVectorEchoStateMachine,RVESM)模型,利用储备池映射输入变量,然后使用稀疏贝叶斯回归方法求解.与一般相关向量机相比,无核相关向量机能够解决一般核方法构造递归核函数困难的问题,降低模型的复杂度,避免模型参数优化过程消耗大量时间,提高模型的运算速度.仿真实验表明,所提模型计算速度快,预测精度高.2回声状态网络回声状态网络由Jaeger和Haas[11]于2001年提出,是一种新型的递归神经网络.一经提出,便引起了国内外学者的广泛关注.网络结构如图1所示,实线表示随机初始化后保持不变的权值,虚线表示待求解的权值.假设输入为狌(t)∈.使用输入信号激发储备池的内部状态,方程为其中狓(t)∈向量,犠x∈M×d表示输入连接矩阵,f(·)取双曲正切函数,犠x和犠in随机初始化后保持不变[14].通常,为保证网络的动态性和稳定性,储备池规模M选为100~1000之间.犠x的稀疏度设定在[1%,5%]之间,谱半径设定在(0,1]之间,回声状态网络的初始状态选为狓(0)=0.经储备池映射后,样本的期望输出d(t)和状态变量狓(t)成线性关系,用网络输出y(t)近似样本的真实输出d(t),方程如下其中,狑∈为消除网络初始暂态的影响,通常舍弃回声状态网络前T个时刻的状态变量,从T+1时刻起,收集状态变量狓(t)和对应的样本输出d(t),构成矩阵犡=[狓(T+1),狓(T+2),…,狓(T+N)]T,犱=[d(T+1),d(T+2),…,d(T+N)]T,N为训练样本个数.采用最小二乘法求解式(2)[15],目标函数为由上述分析可以看出,回声状态网络求解过程简单,能够保证全局最优,避免了一般神经网络存在的局部最小问题.因此,它被广泛应用于混沌时间序列预测中.3无核相关向量机针对相关向量机构造核函数计算复杂的问题,本节提出无核相关向量机模型(RelevanceVectorEchoStateMachine,RVESM),通过储备池结构,将模型的输入变量映射到动态的状态空间中,然后采用稀疏贝叶斯方法求解,进而实现混沌时间序列的预测.3.1稀疏模型稀疏学习模型的表达式[2]为其中,狑=(w1,w2,…,wM)T∈犡M)∈Page3的一般描述式,y(犡)可以逼近任意实变函数[2].假设N个训练样本产生的储备池状态矩阵犡对应的输出为y(犡).稀疏模型通常采用某种策略,将狑的大部分元素设置为0,降低模型的复杂度,避免过拟合,提高泛化能力.稀疏贝叶斯回归是一种典型的稀疏模型,基本原理是为每一个权值配置独立的超参数,当训练结束后,获得稀疏的相关向量,即非零权值的基函数所对应的样本向量.3.2无核相关向量机传统核方法在进行时间序列预测时,需要计算测试样本与所有训练样本间的核函数,因此,训练样本的个数大大约束了传统核方法的计算效率.此外,在处理含有递归结构的实际观测的时间序列时,静态的核方法不能有效地匹配动态模式.为解决上述问题,本文提出一种不受核函数约束的预测模型———无核相关向量机(RVESM)模型,采用储备池代替RVM模型中的核函数,将模型的输入变量映射到状态空间,然后采用稀疏贝叶斯回归方法求解输出权值,避免RVM构造递归核所存在的瓶颈问题.下面介绍模型的建立过程,模型结构如图2所示.给定一组训练样本,由输入数据狌(t)激发产生回声状态网络,计算得到相应的状态向量狓(t),假设目标输出d(t)是标量,则回声状态网络的输出表达式为其中,ε(t)是模型上加入的噪声,y狓(t);()狑是RVESM的预测输出.令犡m为储备池的状态矩阵的第m列,将y(犡;狑)表示为储备池状态变量的线性组合,具有以下形式:假设噪声ε(t)是均值为0、方差为σ2的高斯噪声,即p(ε(t))=N[ε(t)|0,σ2].则由式(5)计算出的d(t)服从均值为y(狓(t);狑)、方差为σ2的高斯分布,即p[d(t)狓(t)]=N[d(t)y(狓(t);狑),σ2](7)全部训练样本的似然函数[2]为p(犱狑,σ2)=(2πσ2)-N/2exp-1其中,犱=[d(1),d(2),…,d(N)]T,犡=[狓(1),狓(2),…,狓(N)]T.模型学习的关键是求取未知参数狑的值.贝叶斯方法结合训练样本信息和先验信息,计算权值向量狑的点估计.但是涉及的参数较多,当训练样本数目很大时,所建立的模型往往出现过拟合现象.为解决上述问题,在一般贝叶斯参数估计的基础上,本文给权值参数狑添加一个零均值高斯先验分布的限制,降低模型的复杂度,表达式如下:其中,α=diag(α1,α2,…,αM).在式(8)所示的训练样本集的似然函数、式(9)所示的狑的先验分布的基础上,由贝叶斯定理计算狑的后验分布:其中超参数β=1/σ2,协方差矩阵Σ、均值μ的计算式[4]如下:上式中犡为储备池状态矩阵.α和β采用EM算法迭代估计[2].综上,无核相关向量机模型步骤如下所示:第1步.给定模型的输入信号,激励产生与之相对应的储备池状态向量.第2步.建立期望输出与储备池状态向量相关的稀疏模型.第3步.由贝叶斯定理计算输出权值向量狑的后验分布,求取输出权值向量[16].4仿真实例为验证本文所提模型的有效性,在WindowsXP操作系统MATLAB仿真实验环境下,将本文所提模型RVESM用于预测Lorenz混沌时间序列和实际的水文数据—年太阳黑子数和黄河年径流时间序列,并与相关向量机等其他模型在预测精度和计Page4算时间方面进行比较.所用计算机内存为512MB,主频是2.53GHz赛扬CPU.4.1Lorenz数据实验仿真Lorenz混沌系统的状态方程为混沌系统对初始条件极其敏感,本文选取a=10,b=28,c=8/3,x(0)=12,y(0)=2,z(0)=9,此时,Lorenz系统表现出明显的混沌特性.采用四阶Runge-Kutta法产生1000组数据,舍弃前100个样本用于消除初始暂态的影响,之后的700组数据用于训练模型,200组数据用于测试.设定RVESM模型中储备池规模为200,犠x的谱半径和稀疏度分别为0.98和2%.犠in在[-1,+1]随机赋值.本文所提模型RVESM对Lorenz混沌时间序列x(t+1),y(t+1),z(t+1)预测效果如图3~图5所示.表1给出了不同模型单步预测Lorenz混沌时间序列x(t+1),y(t+1),z(t+1)的均方根误差和计算时间.其中RVM、SVESM模型的参数设置分别与文献[2]和文献[12]一致.由表1的仿真结果可以看出,RVESM在精度和计算时间方面都占有一定的优势.与RVM相比,本文所提模型采用储备池代替相关向量机中的核函数,储备池具有递归结构,能更加精确地反映混沌时间序列的非线性特性,从而处理实际的动态模式问题,在一定程度上提高了预测精度.此外稀疏贝叶斯方法利用先验知识求取网络输出权值,与SVESM相比,避免了超参数选择过程消耗大量的计算时间,因此本文所提模型既提高了预测精度,又降低了网络的计算时间,避免了模型过学习现象的产生.模型RVESM0.18795.25009.29305.23504.36804.7970RVM[2]0.58717.51309.05957.32544.41876.7410SVESM[12]0.209310.81709.337917.14404.37209.72544.2太阳黑子-黄河年径流数据仿真为验证RVESM模型的有效性,将其应用到1700年~2003年的年太阳黑子数和黄河径流二变量时间序列预测中,并与其他预测模型的仿真结果进行比较.舍弃前26组数据用于消除初始暂态的影响,240组数据用于训练,38组用于测试.不同模型的预测误差如表2所示.RVESM对太阳黑子和黄河径流时间序列的预测曲线分别如图6、图7所示.由表2中4种模型的仿真结果可知,本文所提出的RVESM与其他3种模型相比,减小了误差,提高了精度.从图6、图7中可以看出,拟合曲线较为光滑,说明RVESM在实际观测的水文数据预测中同样具备有效性.Page5模型ERMSE(太阳黑子)ERMSE(黄河径流)RVESMRVM[2]ESN[11]SVESM[12]5结论本文在贝叶斯参数估计研究的基础上,提出了一种不受核函数条件约束的无核相关向量机模型.该模型利用具有递归结构的储备池将输入变量映射到高维状态空间中,原始的非线性映射问题转化为关于储备池输出权值的线性回归问题.在权值参数上增加一个高斯分布的限制,降低模型的复杂度,防止过拟合现象的出现,提高时间序列的预测精度.基于Lorenz混沌时间序列和太阳黑子-黄河径流量序列的仿真实验验证了本文所提模型的有效性.
