Page1基于行为模型的需求可视化研究李琳1),2),3)毋国庆1)黄勃1)万黎4)吴昊1)1)(武汉大学计算机学院武汉430072)2)(武汉科技大学计算机科学与技术学院武汉430065)3)(智能信息处理与实时工业系统湖北省重点实验室武汉430065)4)(中国民生银行科技开发部北京100086)摘要针对复杂软件系统的需求信息难以表达和沟通的问题,提出了一种用动画方式描述需求行为模型的可视化方法.该方法基于行为描述语言(BehaviorDescriptionLanguage,BDL)所建立的需求行为模型,动画的执行机制是采用状态机和状态块分别作为其执行模型和描述模型,每一个状态迁移都对应一个需要进行可视化描述的行为,一个关联元素将状态块模型中的一个迁移与一个动作原语进行关联,控制图形的运动,实现需求行为模型的可视化.该方法的优点在于,需求动画的直观性可以使不同背景的用户发现遗漏和不正确的潜在需求,避免需求变更,并且BDL模型必须通过一系列检测,以确保需求动画的正确性.文中给出了行为模型到状态模型转换规则的正确性证明,为转换提供了相应的理论验证.最后给出了校园通系统实例分析以及所实现的建模工具和动画工具介绍.关键词软件行为;行为描述语言;行为模型;可视化;需求建模1引言需求建模[1-2]无疑是当前软件工程中的关键问题,同时又是软件工程中最复杂的过程之一[3-4].需求建模的目的是要在需求分析过程中从不同的角度建立和检验软件系统的需求模型,为项目相关人员提供一个可以进行沟通和验证需求信息正确性的平台,以获得高质量的需求.需求建模的目标是明确软件系统的需求信息,以某种建模方法建立对应的需求模型,即整个系统要“做什么”.“做什么”即软件行为[5],是指软件运行时作为主体,依照自身的功能对客体的施用、操作或动作的过程,或主体施用一个服务、操作或动作于客体.软件行为由行为主体和客体、操作或动作、行为输入输出和行为属性等组成.1.1研究背景随着软件的复杂程度日益增加,软件的需求建模的重要性也日益凸显.对于相当复杂而又难于理解、难以用言语表达的系统,需求可视化技术提供了一种更加直观和易于理解的方式.可视化是指使用图形、图像或者图片等技术,使一些不可见的对象、表达或者抽象概念变成可见的符号[6].可视化技术和需求建模的结合,给软件的需求工程领域带来了新的机遇和光明的前景.1.2相关的研究可视化技术在其它计算机研究领域(如系统建模、仿真),以及软件工程其它阶段(如软件设计阶段)已经有了广泛的应用,但在软件需求阶段的应用研究还处于初步阶段[7].目前,国内外的相关研究者在软件需求阶段采用了不同方法和技术进行可视化的研究,这些研究从表达技术和表达内容上可大致综合为两类,一类是利用各种图形符号静态地表示需求模型,另一类是动态表示需求模型的方法.静态方法使用直观的和可视化的符号表示不可见的、难以表达的对象和关系,以及一些抽象概念,使项目相关人员能够“看”到需求内容而加深对需求的理解,促进了项目相关人员和开发人员的交流,从而可获取高质量的需求.然而,对于需求中表达目标软件执行动作和动态交互这类的需求内容,特别是在某些软件行为比较复杂的情况下,使用流程图、状态图等静态的图形表达出来的结果[8]往往错综复杂,难以阅读和理解.因此,一些研究者试图使用动态的需求动画来表达系统的动态行为,即利用图形符号或图像动态地表示需求模型的另一类方法和技术.需求动画使用图形符号的动态变化来展示需求模型中的动态内容,模拟目标软件的执行过程,有益于更好地理解和验证需求模型.近几年来,很多研究工作尝试为不同的需求建模方法以及工具提供需求动画功能,这些工具按其自动化程度可粗略归纳为如下两类:一部分工具的动画生产过程自动化程度较高.典型的工作如:Holzmann等人[9]研制出的SPIN工具将Promela的需求规格说明书中的状态转换成执行过程;UPPAAL①使用Autograph工具演示时间自动机中的迁移和状态.此类方法在演示动画时,通过执行需求模型中的过程或状态变换来驱动对应图形符号的改变,在一定程度上能够更加直观地、动态地表达需求模型,便于开发人员调试和理解需求模型.但动画中采用的图形符号与模型中的形式化符号相对应,对于非专业用户,这些符号难以理解.另一部分工具是使用现实世界的图形和图像作为动画执行元素,用需求模型来驱动这些动画元素的执行.这些工具生成的动画便于非专业的用户理解,能够很好地促进用户和开发人员的交流.例如,Heitmeyer等人[10]开发的基于SCR方法的工具集,使用模拟器来模拟目标软件的执行.模拟器使用真实仪表面板的图片部件来模拟显示目标软件的输出、控制以及状态变化.Magee等人②开发的LTSA①②tionSystemAnalyser,ImperialCollege[EB/OL].http://Page3使用时间自动机将标记迁移系统与领域相关动画图片关联起来.动画元素的动作执行是通过调用SceneBeans库中定义的一些基本动作.这种做法需要开发人员控制每一步动画的执行.这类工具的问题是动画生成的自动化程度较低,动画的制作需要大量的人工参与.如LTSA中需要花费大量人力编写描述动画执行的XML脚本.本文的方法汲取了以上两种动态建模方法的优点,使用用户便于理解的图形符号,并且自动化程度较高.1.3论文的结构针对目前的相关研究现状,本文提出的需求可视化技术使用形象直观的图形符号的动态变化来展示需求模型中的动态行为内容,模拟目标软件的主要执行过程,通过执行与行为模型对应的动画,能够辅助不同知识背景下的用户理解需求行为模型,启发用户发现遗漏和不正确的潜在需求,获取有益的用户反馈意见.该需求可视化技术极大程度地减少了需求变更的出现,大大地降低了软件开发的复杂性和开发成本.本文所讨论的问题如图1所示:首先在第2节介绍构建基于行为描述语言BDL的行为模型方法,该方法是制作需求动画的基础;第3节讲述需求可模型构建方法的步骤是首先将与复杂系统对应的问题域分解成若干个子问题域,然后根据不同的用户视点建立系统的需求模型.最后,根据语义模型并利用行为时序逻辑来检验复杂系统的一些重要特性,如信息安全等.在构建基于软件行为的需求模型(简称行为模型)过程中,主要利用行为描述语言以及行为树(或行为图)建立系统的行为模型,并使用操作语义建立行为模型的语义模型,以对行为模型进行各种检测等.其中,行为描述语言可以将系统的行为表示为行为表达式,并通过行为表达式的变化来刻画系统的状态变化.此外,行为描述语言亦能够反映系统的行为踪迹.2.1行为描述语言(BDL)定义行为描述语言(BehaviorDescriptionLanguage,BDL)主要用于描述待开发软件系统的行为,是一种用于以多视点方式描述软件系统需求模型的语言,而且该语言也是对软件系统的性质进行研究的基础.行为树(图)是行为描述语言的语法结构.行为描述语言以场景作为问题域中每个视点需求描述的基本单位,而以组成场景的基本原子行为作为具有独立含义的最小单位.比之自然语言能够对需求目标的定义更加精确和严格,而较之数理逻辑等形式化语言则更加易于理解和构造[11-12].有了需求模型,便可依据其动态语义对其做形式化验证,以检验需求的正确性、有效性等.2.2行为描述语言的语法结构型的结构的描述.下面给出行为描述语言描述视点中场景行为模视化建模的方法;第4节是行为模型到状态模型转换规则的正确性证明;第5节是校园通系统的实例分析和建模工具、动画工具的介绍;第6节是总结和展望.2基于行为描述语言BDL的行为(1)系统行为模型的结构.系统名:视点ID1的行为模型,…视点IDn的行为模型.(2)视点行为模型的结构.视点ID:VPBEGIN[视点内共享数据存储池ID](主要用于存放由其它视Page4点传入的数据或视点内各场景共享的数据等)场景ID1的行为模型,…场景IDn的行为模型.VPBehID=视点行为表达式VPEND(3)场景行为模型的结构.场景ID[,场景ID]:BEGIN[ABEH:(注:原子行为列表)BEH:(注:复合行为标识前缀必须有Beh,以区别于BehID=场景行为表达式[BehID=子行为表达式1],…[BehID=子行为表达式m].END(4)BDL的语法结构定义.令ABehID为原子行为标识,BehID为行为标识.1.原子行为.(1)原子行为表达式:ABehID:f(sub,obj[obj的补充说明][(x1,…,xk)])[When前置条件][INFROM(ID)(u1,…,un)][OUTTO(ID)(v1,…,vm)]f为主体sub施用于客体obj的服务、操作或动作.xi为变量符.例:张某给李某一本书Aα1:Give(张某,李某&一本书);带When的原子行为相当于语句“If前置条件Then行为Fi”.如果有分支的情况可用语句“If前置条件Then行为或行为序列Else行为或行为序列Fi”;INFROM表示从ID获得数据,其中输入参数u1,…,un表示数据名或数据名=数值或字符串,且ID=ABehID或视点内共享数据存储池ID(可以为空)或#外部实体名;当不同的数据来自不同的ID时,需用多个INFROM给予表示;OUTTO表示将数据输出到ID,其中输出参数v1,…,vm表示数据名或数据名=数值或字符串,且ID=ABehID或#视点ID或视点内共享数据存储池ID(可以为空)或#外部实体名或#其它视点ID.当ID=#其它视点ID时,数据v1,…,vm将被放入对应#视点ID的共享数据存储池中.如果要将不同的数据输出到不同的ID时,需用多个OUTTO给予表示.(2)未确定客体的原子行为:ABehID:f(sub,?)[When前置条件][INFROM(ID)(u1,…,un)][OUTTO(ID)(v1,…,vm)](3)空动作:ABehID:Idle.(4)复合行为结束动作:ABehID:Return(ABehID)或Return().注意:Return()表示正常退出系统.2.简单行为.|-ABehID(原子行为构成简单行为).3.复合行为.(1)顺序行为:①|-ABehID1|-ABehID2②|-ABehID|-BehID1③|-BehID1|-ABehID④|-BehID1|-BehID2…|-BehIDn(2)确定选择行为:注意:b是BehID1中最开始原子行为中的前置条件.(3)非确定选择行为:(4)并行行为:2.3行为描述语言的动态语义和α为原子行为标识.令B,B,Bi(i=1,2)为行为表达式,ABehID1.顺序行为.(1)当ABehID为B中不带参数的最开始的原子行为,或是带未确定客体的原子行为,或是复合行为结束的原子行为时,(2)当ABehID(x1,…,xn)为B中带参数的最开始的原子行为时,(3)当空动作Idel为B中最开始的原子行为时,2.非确定选择行为.(1)B1→αB1Page5(2)B2→αB23.并行行为.(1)B1→αB1(2)B2→αB24.确定选择行为.(1)B1→αB1,b的值为真(2)B2→αB2,b的值为假在需求建模过程中,各视点虽然是相对独立的,但不同视点间的需求信息可能会发生重叠.因此,由不同视点产生的需求模型间会产生重叠和差异,从而可能会导致需求模型间出现需求冲突和不一致.此外,有些视点可能使用不同的需求建模方法和技术构建需求模型,更增加了视点间容易发生需求冲突和不一致的可能性.因此,在形成最终需求规约之前,必须检测和处理视点间存在的需求冲突和不一致问题,以保证复杂系统的需求的正确性和一致性.视点检测主要包括3部分,即语法检查、语义检查和系统特性检测.其中,前两项检查需要分别在视点内及视点间进行,系统特性检测主要利用行为时序逻辑系统检查系统的特性等.3需求可视化建模行为模型建立后,需要确定模型所描述的行为是否是用户所期望的目标软件系统的行为.一种较好的方法是采用可视化的技术,该技术使开发人员能够将行为模型转换成形象的动态的执行过程,通过直观地看到需求的动态执行过程,辅助各种知识背景的用户确切地理解需求中的行为过程,并且促使用户加入需求校验过程,获取有效的用户反馈,提高需求分析的效率,减少软件开发后续阶段的需求变更.在使用BDL建立了需求的行为模型后,开发人员首先使用模型转换的方法将行为模型转换成状态机,作为需求动画的模型.再根据工程需要选择需求可视化描述的实体集,并选择对应的图形和图片以直观地表达所选择的实体.然后,根据所选择的实体集,利用状态抽取的方法从模型中提取该演示范围内与这些实体对应的状态块,并将每个状态块中的迁移与提供的动作原语进行关联,作为行为的可视化描述.当状态机执行时,驱动动画引擎根据状态块中对应的迁移,调用相关联的动作原语,控制与对象关联的图形运动,从而直观地表现出需求模型所描述的行为过程.简而言之,需求可视化的制作是通过行为描述语言BDL进行需求建模,提炼出其中的行为模型,将行为模型转换为动画描述模型,最终通过执行引擎转换为需求动画的过程.3.1设置动画元素的内容和用法根据需求建模的过程,可以得到一个基于BDL语句的需求行为模型.由行为模型中选定的主客体对象,可设置与主客体对象对应的动画元素和这些对象活动的“舞台背景图片”.“舞台背景图片”是动画对象显示的背景图片,可以将所有动画过程中不动的背景设计到“舞台背景图片”中.与主客体对象对应的动画元素包括主客体名、关联图片、类型、初始x坐标、初始y坐标、摆放层次深度.动画元素的内容和用法如表1所示.动画元素主客体名动画设计人员所填写的对象列表中的那些对象关联图片类型初始x坐标关联图片左上角在背景图片上面位置的初始横初始y坐标关联图片左上角在背景图片上面位置的初始纵摆放层次深度对于任何一个主客体对象,都需要设置其对应的动画元素,可以逐个地采用“关联图片”的方式设置每一个对象的动画元素.3.2编辑行为动画行为动画是指动画BDL模型原子行为对应的动画操作原语的序列.这些操作序列在BDL模型的驱动控制下,形成了一个完整的动画,而单个的原子行为动画是完整动画的最小组成部分.行为动画采用简单的原语语句来控制图片的显示和运动,这些原语语句的序列组成了一个单个的原子行为动画.Page6提供几个基本的动作原语用于表达动画中对象的基本动作.对于模型中每一个行为,开发人员根据需要将原语进行组合,设置合适的参数,从而较形象地表达出模型中每个行为的执行效果.模型执行的过程中,状态块中的迁移依据语义所描述的时序关系被触发,驱动动画引擎解释执行对应的动画原语,从而动态地表现出模型中所描述的目标软件的行为过程.提供的动作原语及其功能如表2所示.MOV(对象,x坐标,y坐标,毫秒数t);RESHOW(对象);重新显示对象,即在原位置重新显SHOWP(对象,图片名);将对象显示为图片名对应的图片SHOWXYP(对象,x坐标,y坐标,图片名p);DIS(对象);STOP(毫秒数t);SEND(if表达式,真假值);将if表达式的值置为相应的真假需要根据原子行为表达式中的动作、主客体、INFROM、OUTTO描述来设计其对应的行为动画,通过上述动画原语的组合来表达所需的动画效果.当设计完成某一个原子行为对应的行为动画后,可以在相应行为名对应的文本框内填写相应的行为动画原语序列.MOV原语以及STOP原语中的时间取值由开发人员根据同步以及动画效果的需要而确定.SEND原语主要用于行为的迁移过程中控制过程表达式的取值,从而在动画执行过程中动态地控制模型的流程.利用表2中的原语,可以简单直观地描述软件的执行过程,例如需要对“软件模块A发送消息m到模块B”进行动画表达,首先可使用两个标识软件模块的图形分别表示软件模块A和软件模块B,然后用带文本提示的消息块来描述抽象的消息m,再使用MOV原语将消息块m从A移动到B.3.3设置if分支值If表达式是BDL模型中用于确定当前那一分支行为发生的条件语句,在动画的动态运行中其值可以为true或false.由于在动画运行过程中,需要确定if表达式的值,因此必须设置.此外,在初始设置动画模型遇到if分支时采取的措施是:if表达式初始值可设置为:random、true、false.Random方式是当动画模型执行到if分支,随机的选择为true、false.True或false方式即设置为固定的值true、false.完成了包括设置舞台背景和主客体、编写行为动画、设置if分支初始值后,若需运行动画,则先要生成动画的执行模型.3.4动画执行引擎行为模型描述了软件的执行过程,每一个原子行为说明了一个主体与一个客体之间的动作交互.然而,在进行动画描述时,需要明确地知道模型执行过程中,每一个动画实体的状态变化,然后才能将这种状态变化使用图形物理变化的方式表达出来,使得用户能够直观地理解模型的变化.采用状态机和状态块作为动画的执行模型和描述模型,根据需要关注的对象,可以从状态机中抽取出一组状态块,每个状态块描述一个对象的状态迁移模型.为了在动画模拟时展示该对象,需要将该对象与一个图形关联起来.对于对象状态块中的迁移,设计了一组描述图形运动的动作原语(如表2所示),通过将迁移与动作原语进行关联,便可以直观地表达对象状态变化的过程.将行为模型转换成状态机,并且从状态机中抽取出描述每一个对象或者逻辑单位行为及状态变化的状态块,生成的状态机是驱动动画引擎产生动画动作的执行模型,而状态块则是用于描述动画脚本的描述模型,描述了每个对象的状态变迁过程.状态块的形式模型同状态机的一样,状态机及状态块在内部表示时都使用XML文件进行描述,以便于动画执行引擎解释执行.每一个对象的状态块,使用一个以该对象ID为名称的XML文件进行描述,文件内部仅记录该状态块的迁移结构,而并不设计对象与图形的关联信息以及迁移与动作的关联信息.这样的设计使得模型与关联相互独立,一方面便于模型和动画独立地进行修改,另一方面,开发人员可根据需要为同一个模型制作多个需求动画,而这个工作只需要增加新的关联文件即可.每一个状态迁移都对应一个需要进行可视化描述的行为,一个关联元素将状态块模型中的一个迁移与一个动作原语进行关联.需求动画执行时,动画执行引擎驱动状态块发生状态迁移,在关联列表中查询这些迁移对应的动作原语,控制图形的运动.需求动画的执行机制如图2所示,具体执行步骤描述如下:(1)首先根据对象可视化中XML文件所描述Page7的动画背景、对象与图形的关联信息以及图形的初始坐标,布置动画舞台的初始信息;迁移的时序结构进行执行;(2)启动驱动动画执行的状态机,根据状态机(3)在状态机的执行路径中,每次经过一个迁图2需求动画执行机制行为模型中的一个原子行为对应于状态模型中的一个事件迁移,因此在状态机的执行过程中,可以同步将当前执行的迁移所对应的原子行为显示出来,使用户能够看到需求模型与需求动画的同步执行过程.3.5动画演示运行动画以后,系统进入动画演示的界面,动画演示界面由3个部分组成,“运行动画窗口”、“行为踪迹窗口”和“BDL模型窗口”.“运行动画窗口”为主窗口,其功能为控制动画演习的开始、暂停、重新开始,并显示由BDL模型驱动的动画.行为踪迹窗口中,显示和纪录了动画运行过程中原子行为的轨迹,并用红色字亮色背景显示当前正在运行的行为,系统分析员和用户可以根据轨迹和动画效果来考察目标系统的需求.左侧的“BDL模型窗口”,用红色字亮色背景显示了当前运行的原子行为在BDL模型中的位置,并与行为踪迹和动画同步.4模型转换规则的正确性为了对行为模型进行可视化描述,首先需要将行为模型转换成状态模型.行为模型形式化地描述了目标软件系统与问题域中实体之间的交互过程,以及目标软件系统内部模块之间的一些行为;状态移,执行引擎便查询该迁移是否有对应的状态块,若有,则驱动该状态块产生一个对应的迁移;(4)状态块中的迁移跳转时,执行引擎查询并调用与该迁移对应的动作原语,动作原语控制舞台上图形的状态变化,从而产生动画效果.模型则关注系统中某个抽象层次下个体的状态变化.本节研究证明行为模型到状态模型转换规则的正确性:研究了行为表达式的强互模拟、状态结构式的强互模拟以及行为表达式与状态结构式之间互模拟这些关系之间的关系;证明了行为模型与其转换后的状态模型之间是互模拟等价的.考虑到与行为模型的衔接性和研究的通用性,选择使用状态机作为描述对象状态变化的模型.下面给出一种描述状态机结构的结构式,在此基础上可完成从行为模型到状态模型的转换工作.定义1.状态机中的迁移是一个五元组:式中,Ss表示迁移源状态集;St表示迁移目的状态集;G是描述迁移执行前提的布尔表达式集;E和B分别表示迁移产生的事件集和执行的动作集.定义2.一个状态结构式是一个五元组:M=(Sm,Tm,R_FATHERm,sim,som),其中,Sm和Tm分别是状态结构式内的状态集和迁移集,t∈Tm,t.ss∈Sm,t.ds∈Sm;R_FATHERm是状态结构式内状态的层次关系;sim∈Sm是状态结构式内的起始状态,满足:s∈Sm,sims,且若t∈Tm,t.ds=sim,则sim∈Sm∩Sinit;som∈Sm是状态结构式内的结束状态,满足:s∈Sm,ssom,且若t∈Tm,t.ss=som,则t.ds∈Sm∩Sinit.Page8其中,s〈M1〉表示一个复合状态s,复合状态内部结构用M1表示,M1;M2表示两个状态结构之间的顺序关系,M1‖M2表示两个状态结构之间的并行关系,M1+M2表示两个状态结构之间的选择关系.定义3.ψ:BDL→M是事件行为表达式到状态结构式的模型转换,引入Γ:BDL→Μ为事件行为表达式到状态结构式之间的模块映射函数,对任意事件行为表达式B∈BDL,模型转换规则为其中,s0∈Sinit是模型的初始状态;sf∈sfin是模型的最终状态;s0.ot=INT(Γ(B)),sf.it=OUT(Γ(B)),且sf.it∈Tτ.定义4.事件系统与状态系统的伪模拟关系.(C,EB,→,B0)和(M,T,→,M0)分别是事件行为迁移系统和状态结构式迁移系统,称关系ρηC×Μ是事件系统与状态系统的伪模拟关系,若对于所有的BρηM有若B(e,α→)B,则存在t,t.e=e,t.b=α且MtM,若B→1B,则有M1M,使得BρηM.定义5.状态系统与事件系统的伪模拟关系.(C,EB,→,B0)和(M,T,→,M0)分别是事件行为迁移系统和状态结构式迁移系统,称关系ηρM×C状态系统与事件系统的伪模拟关系,若对于所有的MηρB有使得BρηM;状态结构式的语法结构如下:M∷=s|s〈M1〉|M1;M2|M1‖M2|M1+M2,若存在t∈Ta,使得M→tM,存在B以及迁移(e,α),t.e=e,α=t.b且B(e,α→)B,使得BρηM;若M1M,则有B→1B,使得BρηM.定义6.事件系统与状态系统的互模拟关系.事件行为表达式B与状态结构式M是互模拟关系,当且仅当存在事件系统与状态系统的模拟关系ρη使得BρηM,且ρη-1是事件系统与状态系统的伪模拟关系使得(M,B)∈ρη-1.记为B~epM.引入事件互模拟upto~ep,作为模型验证和证明工作的理论基础.首先引入一种事件与结构的互模拟组合关系:给定一个关系RC×M,对于行为表达式B和状态结构式M,如果存在B和M,使得B~evB,BRC,C~pC,则B,C的关系记为B~evR~pC.定义7.称RC×M是事件系统与状态系统的互模拟upto~ep,若存在关系BRM可推导出:若B(e,α→)B,则存在t,t.e=e,t.b=α且MtM,使得B~evR~pM;若B→1B,则有M1M,使得B~evR~pM;若存在t∈Ta,使得M→tM,存在B以及迁移(e,α),t.e=e,α=t.b且B(e,α→)B,使得B~evR~pM;若M1M,则有B→1B,使得B~evR~pM.以上四者之间为或者关系.定理1.如果R是事件系统与状态系统的互模拟upto~ep,则~evR~p~ep,R~ep.证明.证明过程类似事件互模拟upto~ev,此处不再赘述.根据该定理,可知,只要能够验证关系R是upto~ep,则可以证明~evR~p是事件系统与状态结构的互模拟关系.定理2.B~epM当且仅当:若B(e,α→)B,则存在t,t.e=e,t.b=α且MtM,使得B~epM;若B→1B,则有M1M,使得B~epM;若存在t∈Ta,使得M→tM,存在B以及迁移(e,α),e=t.e,α=t.b且B(e,α→)B,使得B~epM;若M1M,则有B→1B,使得B~epM.以上几者之间为或者关系.证明.证明过程类似事件互模拟中的证明,此处不再赘述.该定理说明具有互模拟的一对行为表达式和状态结构式,它们的演化行为表达式和演化状态结构式之间也对应具有互模拟关系.定理3.若B1~epM1,B2~epM2,则(1)B1;B2~epM1;M2;(2)B1‖B2~epM1‖M2;(3)B1+B2~epM1+M2;(4)ifbthenB1elseB2fi~ep证明.这里给出(1)式的证明,其它关系式的(1)式的证明:假设B1~epM1,B2~epM2,需要证明下列命题证明过程类似.成立:Page9使得对任意格局C,B1;B2C,则存在M1;M2M,①若C(e,α→)C,存在M以及迁移t,t.e=e,t.b=α且M→tM,使得C~evM;②若C→1C,则有M→1M,使得C~evM.对任意状态结构式M,M1;M2M,则存在B1;B2C,使得③若存在t∈Ta,使得M→tM,存在C以及迁移(e,α),e=t.e,α=t.b且C(e,α→)C,使得C~evM;④若M→1M,则有C→1C,使得C~evM.证明分以下(i)、(ii)两种情况讨论.(i)构造关系R={(B,M)|B≡B1;B2,M=M1;M2且B1~epM1,B2~epM2},对于任意B1;B2CB2,存在B1B1,使得C≡B1;B2.由于B1~epM1,所以存在M1M1,使得B1~epM1,令M≡M1;M2,则有(C,M)∈R,且有如下推导:C(e,α→)CB1;B2B1~epM1M1;M2tM1;M2.C→1CB1;B2→1B1;B2B1→1B1M11M1,B1~epM1M1;M21M1;M2.其中,t.e=e,t.b=α.令M=M1;M2,可知(C,M)∈R.对于任意M1;M2MM2,存在M1M1,使得M=M1;M2.由于B1~epM1,所以存在B1B1,使得B1~epM1,令C≡B1;B2,则有(C,M)∈R,且有如下推导:M→tMM1;M2→tM1;M2M1→tM1B1M→1MM1;M2→1M1;M2M1→1M1B1→1B1,B1~epM1.其中,t.e=e,t.b=α.令C=B1;B2,M=M1;M2,可知(C,M)∈R.(ii)对于任意B2C,存在B2B2,使得C≡B2.由于B2~epM2,所以存在M2M2,B2~epM2.C(e,α→)CB2B2~epM2.C→1CB2→1B2B2→1B2M21M2,B2~epM2.对于任意M2M,存在M2M2,使得M≡其中,t.e=e,t.b=α.M2.由于B2~epM2,所以存在B2,B2~epM2.M→tMM2→tM2M2→tM1B2B2~epM2.M→1MM2→1M2M2→1M1B2→1B2,B2~epM2.其中,t.e=e,t.b=α.令C=B2;M=M1,则有C~epM.综上(i)、(ii)证明过程可知若B1~epM1,B2~epM2,则B1;B2~epM1;M2.(1)式得征.证毕.引理1.若有B(e,α→)B,则存在t,t.e=e,t.b=α且ψ(B)tM~pψ(B);若B→1B,则ψ(B)1M~pψ(B).证明.原子行为.令B≡α,根据事件行为迁移规则有α(e,α→)1,转换到状态结构式后,根据原子行为转换规则:ψ(α)=s0;sα;sf(s0,s0因为sf=ψ(1),很显然有ψ(α)tsf~psf成立.α,F_PRE(α),eα,α),tf∈Tτ.所以有ψ(α)tsf,假设B1、B2满足题设条件,则进行以下证明.顺序行为.令B≡B1;B2,若B(e,α→)BB1t,t.e=e,t.b=α,使得ψ(B1)tM1,且M1~pψ(B1)s0;Γ(B1);sftM1~ps0;Γ(B1);sfs0;Γ(B1)tM1~ps0;Γ(B1)s0;Γ(B1);Γ(B2);sftM1~ps0;Γ(B1);Γ(B2);sfs0;Γ(B1;B2);sftM1~ps0;Γ(B1;B2);sf即ψ(B1;B2)tM~pψ(B1;B2),即ψ(B)tM~pψ(B1);若B→1B,证明过程与上面类似.证毕.引理2.若有ψ(B)tM,存在B以及迁移(e,α),e=t.e,α=t.b且B(e,α→)B,使得M~pψ(B);若ψ(B)tM,则B→1B,且M~pψ(B).证明.证明过程与引理1类似,不再赘述.定理4.一个事件行为表达式B与其状态结Page10构式的转换模型ψ(B)是事件状态互模拟关系,即B~epψ(B).同理可得B~evR~pM;证明.构造关系R:(B,ψ(B)),若B(e,α→)B,由引理1可知存在t,t.e=e,t.b=α且ψ(B)1M~pψ(B),由B~evB,BRψ(B),ψ(B)~pM可知B~evR~pM;若B→1B,由引理1可知ψ(B)1M~pψ(B),若有ψ(B)1M,由引理2可知存在B以及迁移(e,α),e=t.e,α=t.b且B(e,α→)B,使得M~pψ(B),同理可得B~evR~pM;若ψ(B)1M,则B→1B,且M~pψ(B),同理B~evR~pM.因此,R是事件系统与状态系统的互模拟upto~ep.由定理1可得R~ep,因此B~epψ(B).5建模工具系统及应用本节通过校园通系统的实例,进一步具体说明了构建行为模型和制作需求动画的方法和过程.首先对系统的问题域进行标识和划分.容易发现,本系统包含3个层次,第1层是系统的直接客户,如学生、教师、管理员和家长等,他们与系统进行交互;第2层由终端、门禁设备、固定电话系统和短信网关等外围设备构成,负责为第1层的客户提供交互界面,并接收用户的各种请求和输入,并将数据传输至主机;第3层是本系统的核心部分,即主机,它负责存储、处理各种数据及相应外围设备的各种请求,并将处理结果返回给相应设备.因此,根据校园通系统的层次关系,可将其划分为两个问题域:服务器端问题域:由主机构成;客户端问题域:由终端、门禁设备、固定电话系统、短信网关等外围设备构成.针对这些问题域分别可标识出如下几个视点.(1)对于服务器端问题域:①响应门禁设备视点(VPMenJin);②响应固定电话系统视点(VPPhoneSys);③发送短信视点(VPMesGate);④响应终端视点(VPTerminal);⑤主机工作视点(VPServer).(2)对于客户端问题域:①学生刷卡视点(VPBrushCard);②教师工作视点(VPteacher);③管理员工作视点(VPManager);④家长查询信息视点(VPParent).视点标识后,项目负责人为视点指定责任人,负责视点内需求的编辑工作,基于这些分析,建立的需求行为模型如图3所示.由于整个系统较为复杂,限于篇幅本文仅给出校园通系统的部分BDL描述.响应学生刷卡场景的自然语言描述如下:1.主机接收门禁设备发来的刷卡记录;2.主机验证刷卡的有效性;3.主机发送验证结果给门禁设备;4.若为有效刷卡,则主机存储刷卡记录.门禁设备视点的BDL描述:VPMenJin://门禁设备视点VPBEGIN//视点描述开始//响应学生刷卡并发送短信场景BehBrushCardBEGIN//场景描述开始ABEH//原子行为RecBrushCardInfo:接收(主机,刷卡记录)INFROM()(刷卡记录).ValidBrushCardInfo:验证(主机,刷卡记录)OUTTO()(验证结果).SendValidBCResult:发送(主机,验证结果)INFROM()(验证结果)OUTTO(#VPMenJin)(验证结果).StoreBrushCardInfo:存储(主机,刷卡记录).Return1:return()//退出系统//此处视发短信至短信网关即为发至手机BEH//复合行为//响应刷卡场景行为表达式Page11BehBrushCard=RecBrushCardInfo;SendValidBCResult;If(验证结果=有效刷卡)ThenStoreBrushCardInfoElseReturn1Fi;Return1//退出系统END//接收短信场景描述结束VPMenJin=BehBrushCard;VPEND图4给出了校园通系统的BDL编辑界面的截图,在此编辑窗口可以进行系统BDL语句的修改.在BDL模型建立好之后,即可对其相应的主客体设置图片关联及设定初始坐标.接下来,即可编辑行为动画,动画脚本编辑界面的截图如图5所示.使用动画原语编辑好行为的动画脚本之后,即可生成行为动画,运行动画演示.校园通系统的需求动画运行界面截图如图6所示.本文在MicrosoftVisio的基础上实现了基于软件行为和多视点的需求建模工具以及动画制作工具.提出的建模方法是基于多视点和软件行为的需求建模方法,有别于现有的一些需求建模方法和技术.这主要是考虑到复杂软件系统的特点和软件行为的正确与否决定软件能否满足用户需求,以及软件特性(如可信特性等)可以通过软件行为给予验证等一些重要因素.尽管在需求阶段软件系统还未开发出来,但如果能在需求阶段通过分析用户需求,建立严格的和基于软件行为的需求模型,这将是非常现实和重要的工作.动画制作工具在建模工具生成的行为模型基础上,通过动画元素和动画原语的书写生成需求动画,并且提供了开放的动作库和动作部件库,用户可根据需要,通过制作接口向其中添加新的动作和动作部件.6结束语本文提出了一种用动画方式描述需求行为模型的可视化方法,该方法基于行为描述语言BDL所表述的系统行为序列,在保证该BDL语句语法正确的基础上建立行为模型,通过设置动画元素(如主客体)等的相关内容,以及原子行为和其动画原语的关联实现需求行为模型的可视化.动画执行机制采用状态机和状态块作为动画的执行模型和描述模型,每一个状态迁移都对应一个需要进行可视化描述的行为,一个关联元素将状态块模型中的一个迁移与一个动作原语进行关联,控制图形的运动.该方法是一种动态表示需求模型的方法,使用现实世界的图形和图像作为动画执行元素,用需求模型来驱动这些动画元素的执行.这些工具生成的动画便于非专业的用户理解,能够很好地促进用户和开发人员的交流.需求可视化方法中动画执行模型以及动画描述模型的生成是由行为模型经过模型转换生成的,需要的人工参与相对较少.并且,生成的需求动画与需求模型的一致性也是可以验证的.通过需求动画演Page12示,用户可以直观地理解需求模型,从而可以校验需求中所描述的目标软件行为是否符合用户意愿,从而能够获取有效的用户反馈,提高需求分析的效率,减少软件开发成本.该方法的优点在于需求动画的直观性可以使不同背景的用户发现遗漏和不正确的潜在需求,避免需求变更,并且BDL模型必须通过需求建模系统的一系列检测,可以保证整个行为序列满足相关的语法和语义检测,确保需求动画的正确性.在本阶段研究的基础上,将异类模型转换成行为模型以及将行为描述语言BDL通过状态图实现与其它建模方法的转换是将来的研究方向.
