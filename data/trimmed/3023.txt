Page1基于身份自证实的秘密共享方案裴庆祺1),2)马建峰1)庞辽军1)张红斌3)1)(西安电子科技大学计算机网络与信息安全教育部重点实验室西安710071)2)(中国电子设备系统工程公司研究所北京100141)3)(河北科技大学信息科学与工程学院石家庄050018)摘要为了解决现有秘密共享方案中秘密份额的安全分发问题,基于Girault密钥交换协议,结合基于身份(ID)的公钥密码技术提出了一个新的秘密共享方案,并对其进行了安全性和性能分析.该方案中,用户的私钥作为其秘密份额,无须秘密分发者为每个用户分发秘密份额.用户的私钥可以由用户自己选取,可信第三方无法获取其私钥.同时,任何人都可以以离线方式验证每一个参与者公钥的合法性.分析表明,文中所提出的基于身份的秘密共享方案具有更高的安全性和有效性,能更好地满足应用需求.关键词密钥交换;基于身份的公钥密码技术;秘密共享1引言秘密共享是现代密码学领域中一个非常重要的分支,也是信息安全方向一个重要的研究内容.第一个秘密共享方案是(t,n)门限秘密共享方案,该方案是Shamir[1]和Blakley[2]在1979年分别基于Lagrange插值法和多维空间点的性质提出的.自从Page2秘密共享概念被提出后,许多研究人员对其做了大量的研究,并取得了不少成果[3-7].现有大多数秘密共享方案具有一些共同点:(1)各参与者的秘密份额都是由秘密分发者产生,秘密分发者掌握着所有参与者的秘密份额,如文献[1-2]等.这使得秘密分发者需要保存大量的秘密信息,而且会成为攻击者所攻击的目标;(2)在秘密分发者和各参与者之间需要一条安全信道,利用该信道进行秘密份额的分发,但是维护一条安全信道会提高系统的代价和复杂度.而且在许多秘密共享方案中,为了能够检验在秘密重构过程中合作的参与者是否进行欺骗,秘密分发者需要专门构造一个验证算法和一些验证信息.这必然会增加系统的复杂度,并影响秘密分发的效率.这些特点或多或少会影响秘密共享方案的实际应用,比如,当参与者和秘密分发者不可能存在安全信道时,这些方案也将不再有用.本文利用Girault设计的基于身份的密钥交换协议[10-11],提出了一个(t,n)门限秘密共享方案.它使用参与者的身份作为他们的秘密份额对应的公开信息,秘密分发者和各参与者之间无须进行任何通信和信息交换,因此,他们之间不需要维护安全信道.在秘密重构过程中,每个合作的参与者只需提交一个由秘密份额计算的伪份额,而且不需要暴露其真实的秘密份额值.由于在秘密重构过程中,每个参与者只需提交一个由秘密份额计算的伪份额,而不必暴露他的秘密份额,因此,该方案可以用来共享任意多个秘密,而不必修改参与者的秘密份额.方案的安全性是基于所使用的Girault基于身份的密钥交换协议、所采用对称加密算法和Shamir的(t,n)门限方案的安全性.2Girault基于身份的密钥交换协议Girault方案需要一个可信赖的机构TA(假设它是Trent),TA建立系统参数,并帮助秘密分发者和各参与者建立他们的密钥.2.1系统密钥建立过程等大素数,例如|p|=|q|=512;(p-1)(q-1);Trent生成RSA密钥数据如下:(1)一个公开模数N=pq,其中p,q是长度相(2)一个公开指数e且与(N)互素,其中(N)=(3)一个秘密指数d且满足ed≡1((N));(4)一个公开元素g∈Zn具有最大的乘法阶,为了计算g,Trent找gp作为模p的生成元和gq作为模q的生成元,然后Trent可以运用中国剩余定理来构造.Trent公开系统参数(N,e,g),并秘密保存系统私钥d.2.2用户的密钥数据秘密分发者和各参与者可以通过以下过程与Trent一起生成自己的密钥.假设Alice要建立自己的密钥系统,可以执行以下过程:(1)Alice随机选择一个长度为160bit的整数sA作为私钥,计算并把v发送给Trent.然后,她运用任何一个零知识证明协议向Trent证明她知道sA且不泄漏sA,Alice也发送她的身份IA给Trent.Trent创建Alice的公钥为v-IA的RSA签名:Trent发送PA给Alice作为Alice公钥的一部分.因此,下面的等式成立.表面看来,在密钥的建立过程中,由于PA和v是ZN两个随机数,因此看起来构造(3)似乎并不困难.例如,Alice随机选取PA并根据式(3)用PeA和IA计算v.然而,如果按这种方式来计算v,Alice就不能知道它以g为底模N的离散对数.Alice能够证明她知道以g为底模N的离散对数,即值-sA,这就保证了PA是由Trent发行的.完成这个证明的最简单方法是运用Diffie-Hellman密钥交换协议的一个变形.2.3密钥交换协议假设(sA,PA,IA)是Alice的公钥数据,(sB,PB,IB)是Bob的公钥数据.他们可以通过协商简单地交换一个认证的密钥:KAB≡(PeA+IA)sB≡(PeB+IB)sA≡g-sAsB(modN)在这个密钥协商中,Alice计算(PeB+IB)sA(modN),Bob计算(PeA+IA)sB.因此,这的确是一个Diffie-Hellman密钥协商协议.如果双方能够协商相同的密钥,那么他们就知道另一方已经证明了她/他的身份.3本文提出的新方案3.1系统成员及主要参数n个参与者(participant)P1,P2,…,Pn.系统成员.包括可信的秘密分发者d(dealer)和Page3系统参数.首先,可信第三方Trent生成Girault方案的公开系统参数(N,e,g),并秘密保存系统私钥d,该过程与第2.1节内容相似;假设秘密分发者的公钥数据为(sd,Pd,Id),各参与者Pi的公钥数据为(si,Pi,Ii);令Q是一个随机选取的且大于N的素数;一个公告牌(Noticeboard),只有秘密分发者可以修改、更新公告牌上的内容,其他人只能阅读或下载;以每个参与者的私钥作为其秘密份额;令(Ek,Dk)为某安全的对称密码算法的加、解密算法,其中k为对称密钥;令h(·)是一个单向hash函数.3.2秘密分发算法为了在n个参与者P1,P2,…,Pn中共享秘密s∈ZQ,使得至少t个参与者合作才可以重构该秘密,秘密分发者可以执行如下算法.D1.从[N1/2,N-1]中随机选取一个整数r;D2.对于每一个参与者Pi(i=1,2,…,n),秘密分发者执行以下过程:D2.1.计算Kd,i=(Pei+Ii)sd=g-sdsi(modN);D2.2.利用自己计算的Kd,i作为对称加密密钥对r进行加密,即计算EKd,i(r);D2.3.计算Hd,i=h(EKd,i(r)).D3.利用(n+1)个点(0,s),(x1,EKd,1(r)),(x2,EKd,2(r)),…,(xn,EKd,n(r))和Lagrange插值方法构造n阶多项式f(x):D4.分别计算f(1),f(2),…,f(n-t+1);D5.在公告牌上公开关于秘密s的信息:Msg(s)=(r,f(1),f(2),…,f(n-t+1),Hd,1,…,Hd,n).3.3秘密重构算法为了重构秘密s,需要至少t个参与者合作.不失一般性,假设t个参与者P1,P2,…,Pt准备重构秘密s.注意每一个参与者不需要提供他的秘密份额,即他的私钥,而仅仅需要提供一个由秘密份额计算的伪份额.而且,在这个过程中,任何人都可以立即检验各参与秘密重构的合作者是否诚实地提供自己正确的份额.下面,给出参与者P1,P2,…,Pt如何重构秘密s:密s的公开信息Msg(s).R1.每个合作的参与者Pi从公告牌上读取关于共享秘R2.每个合作的参与者Pi利用自己的私钥计算R3.每个合作的参与者Pi利用自己计算的Ki,d作为对称加密密钥对r进行加密,即计算EKi,d(r),并将其提交给指定的秘密计算者.R4.由Girault方案的性质可知,Ki,d=Kd,i,因此有EKi,d(r)=EKd,i(r).这样就可以得到t个点(x1,EK1,d(r)),(x2,EK2,d(r)),…,(xt,EKn,d(r)),再利用公开的信息Msg(s)可以得到另外的(n-t+1)个点(1,f(1)),(2,f(2)),…,(n-t+1,f(n-t+1)).通过汇集这(n+1)个秘密点,采用Lagrange内插多项式[1]即可重构多项式f(x).为简单起见,如果用(Xi,Yi)i=1,2,…,n+1来表示所得到的(n+1)个数值对,就可以如下方法重构n次Lagrange插值多项式f(x):R5.恢复所共享的秘密s=f(0).4分析与讨论定理1.本文方案能够预防参与者之间的相互欺骗.证明.在任何基于群的密码协议中,均需要考虑预防内部参与者之间的相互欺骗问题,本文方案在设计时已经考虑到预防参与者之间相互欺骗的内部攻击.如果某个参与者Pi想进行欺骗,他可以在秘密恢复过程的第R3步计算EKi,d(r)时进行欺骗.但是,任何参与者均可以通过验证等式Hd,i=h(EKi,d(r))是否成立来验证其提交的份额EKi,d(r)的有效性.因为信息Hd,i是公开的,因此,任何参与者都可以利用该等式对EKi,d(r)进行验证,发现这种欺骗,从而防止内部参与者之间的相互欺骗.证毕.定理2.本文方案能够预防外部攻击者的主动攻击.证明.系统外的攻击者可以通过设法推导出秘密分发者在第D2.1步计算的密钥Kd,i,或各参与者Pi在第R2步计算的密钥Ki,d来对本方案进行攻击.如果他能够设法计算出这些信息,那么,整个秘密共享系统将会被攻破.但是,由于Girault密钥交换协议的安全性,攻击者的这种攻击无法奏效,除非他能够获取秘密分发者或各参与者的私钥.而要获取他们的私钥,攻击者面临着求解离散对数问题的困难性,因此,这种攻击在Girault方案安全假设前提下无法奏效.定理3.本文方案符合门限秘密共享方案的门限规则.证明.在一个(t,n)门限秘密共享方案中,有两个基本条件必须满足:(1)t或t个以上的参与者合作能够很容易恢复出所共享的秘密;(2)(t-1)个或更少的参与者合作却无法恢复出所共享的秘密,Page4甚至不能得到与该秘密相关的任何信息.在本文方案中,要恢复出所共享的秘密,就必须首先重新构造出n次Lagrange插值多项式f(x).由Lagrange内插多项式的性质可知,只有t个或t个以上的参与者合作才可以重构多项式f(x),从而恢复秘密s;而不超过(t-1)个参与者的合作无法重构多项式f(x),从而无法获得秘密s的任何信息.因此,本文所提的方案体现了(t,n)门限秘密共享方案的原则.攻击者即使与(t-1)个参与者串通,由他们所计算的关于秘密s的(t-1)个伪份额及公开信息也无法SchemesIdentityauthenticationSecurechannelReuseofsecretshadowsSecretshadowdistributionmethodForwardsecrecy表1本文方案与现有方案的性能比较文献[1]的方案文献[4]的方案文献[5]的方案文献[6]的方案本文方案证明.本文方案也是一个多秘密共享方案,可使一群参与者利用他们各自的私钥共享任意多个秘密而不必更新他们的私钥.为了共享多个秘密s1,s2,…,sk∈ZQ,秘密分发者在进行秘密分发时,只需在秘密分发过程的第D1步为每个秘密si(i=1,2,…,k)随机选取一个唯一的整数ri.由于对称加密算法的安全性可知,在秘密的分发和重构过程中,每个参与者Pi的私钥不会被其它参与者或系统外的任何人计算出来.而且,根据Girault密钥交换协议的安全性可知,只有秘密分发者和相应的参与者可以计算出某个特定的对称加密算法的加密密钥.另外,即使知道某个参与者Pi关于若干个秘密的伪份额,也不可能计算出他的关于其它秘密的伪份额,这也是由对称加密算法的安全性决定的.可以共享任意多个秘密而不必更新参与者的私钥是本文方案的一个优点,即秘密分发者可以动态地在n个参与者中共享任意秘密.5性能分析本小节通过与现有方案进行比较来简单分析本文方案的性能.为了便于与现有方案进行比较,我们根据秘密份额分发机制对现有方案做一分类,然后每一类选取一个方案作为代表和本文方案进行性能比较.如前文所述,假定实现存在安全信道的秘密共享方案,例如文献[1-4]的方案等,选取文献[1,4]为代表,后者为一个多重秘密共享方案;采用公钥加密技术来分发秘密份额,以文献[5]的方案为代表;采得到其他任何一个参与者的份额.由(t-1)个份额恢复秘密s相当于在ZQ中随机猜测s获得成功,其概率仅为1/Q.因为方案中Q是足够大的数,因此,这种攻击成功的概率几乎为0.(t-1)个或更少的参与者只能最多再提供(t-1)个关于f(x)的数值对.在这种情况下,要计算出共享的秘密等价于攻破Shamir的门限方案[1],这显然是计算上不可行的.因此,本文方案符合门限秘密共享方案的门限规则.证毕.定理4.在共享多个秘密时,参与者私钥的重用不会影响系统的安全性.NoYesYesYesYes用动态协商来建立秘密份额,以文献[6]的方案为代表.下面,我们通过表1将本文方案和这些方案做一简单比较.从表1可以看出,在这些秘密共享方案中:(1)只有本文方案可以提供参与者身份验证,而在文献[1,4-6]的方案中,必须通过公告牌[11]来公布有效的参与者;(2)对于安全信道,本文方案使用了改进的签密技术,不需要安全信道,文献[6]的方案通过DH交换协商秘密份额,也不需要安全信道,而在文献[1,4-5]的方案中,必须维护安全信道;(3)在秘密份额重用方面,本文方案和文献[4-6]的方案一样,每个参与者的秘密份额可以用于多次秘密共享过程而无须更新,仅文献[1]的方案在每次秘密共享过程前都需要重新分发秘密份额,通信量较大;(4)在秘密份额分发形式方面,文献[1,4-6]的方案都需要在秘密分发之前,通过安全信道或消息交换来分发或协商秘密份额,而本文方案可以在秘密分发的同时进行秘密份额的分发,事先无须进行任何处理,因而,效率更高;(5)在安全性方面,文献[1,4-5]的方案通过安全信道进行秘密份额的分发,秘密分发者私钥的泄漏必将影响秘密份额的安全性,从而也影响共享秘密的安全性,而文献[6]的方案通过DH交换协商秘密份额,一方私钥的泄漏不会影响方案的安全性,本文方案基于Girault密钥交换协议,具有DH密钥交互的安全性,因而也继承了其前向保密性[8].通过分析,相比较而言,本文方案比现有这些秘密共享方案更有效、更符合实际应用.Page56结论本文基于Girault密钥交换协议提出了一个基于身份的(t,n)门限秘密共享方案.在提出的新方案中,参与者的秘密份额不是由秘密分发者决定,而是使用他们的私钥作为秘密份额,即使秘密分发者也不能获得每个参与者的秘密份额;秘密分发者和各参与者间不需要进行任何交互,不需要在他们之间维护一条安全信道,这对于秘密分发者与参与者之间不存在安全通信信道甚至不存在任何通信信道的场合尤为有用;秘密重构过程中,任何人可以立即检验每个合作的参与者是否进行了欺骗.利用该方案可以共享任意多个秘密,而不必修改参与者的秘密份额.方案的安全性是基于Girault密钥交换协议、所采用对称加密算法和Shamir的(t,n)门限方案的安全性.
