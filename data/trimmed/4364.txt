Page1主动特征学习及其在盲图像质量评价中的应用高飞1)高新波2)1)(西安电子科技大学电子工程学院西安710071)2)(西安电子科技大学电子工程学院综合业务网及关键技术国家重点实验室西安710071)摘要盲图像质量评价是指在没有原始图像信息的情况下,预测给定图像的视觉感知质量.迄今为止,基于无监督特征学习的盲图像质量评价方法取得了较好的性能,但其质量预测精度随特征维度的降低而显著下降.为了克服这一缺陷,作者将主动学习策略与无监督特征学习相结合,提出了一种主动特征学习框架,以提高图像特征表示的判别性,并利用所学特征进行质量预测.实验表明,在特征维度较低时,与基于无监督特征学习的方法相比,文中方法在图像质量预测精度上提高了8%.同时,文中方法的性能也优于现有的其他盲图像质量评价方法.关键词主动学习;字典学习;特征学习;图像表示;图像质量评价1引言随着手机、相机等图像获取设备的普及和社交网络的迅猛发展,图像在我们日常生活中发挥着越来越重要的作用.然而,受图像处理系统性能的限制,在图像的获取、传输和处理等过程中,会引入各种各样的失真.失真的引入会降低图像的美观性,同Page2时也会阻碍人们从图像中获取信息.因此有必要研究图像质量评价方法,并将其应用于图像获取设备性能的监控、图像处理系统的优选以及图像处理方法的优化.由于人是图像的最终接收者,因此由人主观地评价图像的质量是最为可靠的方法[1].然而,主观质量评价方法耗时耗力,而且难以集成到图像处理系统中.因此,如何设计客观图像质量评价方法[2],使计算机可以自动准确地评测图像的质量,对于图像处理领域具有重要意义.现有的客观图像质量评价方法,可以划分为两类:有参考型图像质量评价方法[2-3]和盲图像质量评价方法[4-10].其中,前者需要全部或部分的原始图像信息,通过比较测试图像与原始图像信息之间的差异,评估测试图像的质量.而盲图像质量评价则是在没有原始图像信息的情况下,预测图像的视觉感知质量.由于在实际应用中,原始图像信息一般是无法获得的,因此对盲图像质量评价的研究将有助于图像质量评价方法在实际应用中的推广.由于对主观感知机制的研究不够深入,如何提取与视觉感知质量高度相关的图像特征成为盲图像质量评价所面临的重要挑战.在现有的盲图像质量评价中,主要有两类图像特征提取方法:(1)基于自然场景统计特性提取特征[4-8];(2)无监督特征学习[9-10].其中,第一种方法假设自然图像具有一定的统计特性,而失真会对这些统计特性产生影响,使得图像看起来“不自然”.因此,可以基于自然图像的统计特性提取特征,并利用特征预测图像的视觉感知质量.Bovik等人最先将自然场景统计特性引入到盲图像质量评价中,并基于图像在像素域以及图像余弦变换系数、小波变换系数和Gabor变换系数的统计规律,提取了对应的图像统计特征,然后进行质量预测,构建了BRISQUE[4]、BRISQUE-L[5]和BLIINDS-II[6]等一系列方法,取得了较为优异的性能.He等人[7]利用图像小波系数的统计特征,并结合稀疏表示,构建了一种新的盲图像质量评价方法框架.之后,Gao等人[8]基于图像小波系数的非高斯性、局部相关性和指数衰减特性分别提取统计特征,并利用多核学习方法[11]构建特征到质量分数的映射,构建了NSS-GS和NSS-TS两种方法,在多个数据库的不同失真上取得了较好的效果.然而,这些方法中的自然场景统计特征对有些失真类型(特别是混合失真)不够有效;并且不同失真之间,特征与质量分数的映射关系差异较大,使得这些方法对于训练集具有较强的依赖性.近年来,Ye等人[9-10]将无监督特征学习引入到盲图像质量评价中.该类方法首先利用无监督学习方法从训练图像集中提取具有表征性的元素构建字典,然后将测试图像在所学字典上进行编码,进而得到测试图像的特征表示,最后利用所学特征进行质量评价,构建了CBIQ[9]与CORNIA[10]两种方法.该类方法在各个数据库上都取得了较高的预测精度,并且对于训练集的依赖性较弱.但实验表明,该类方法的性能随特征维度的降低而显著下降.为了克服无监督特征学习方法的缺点,本文将主动学习(ActiveLearning)策略[12]引入到字典学习中,提出了一种主动特征学习框架,并将其应用于盲图像质量评价中.在该框架中,首先从训练图像中提取图像块,并对图像块进行预处理得到图像的局部特征描述;然后基于主动学习策略,综合考虑了图像块自身的表征性以及图像块之间的差异性,迭代选择最优的图像块构建字典;对于给定的输入图像,首先将其划分为图像块并进行预处理,然后将预处理后的图像块在所学字典上进行编码,进而对所有图像块的编码系数进行综合,得到图像的特征描述.在LIVE标准数据库上的实验表明,在特征维度较低时,与基于无监督特征学习的方法相比,本文方法在图像质量预测精度上提高了8%.同时,本文方法也优于现有的盲图像质量评价方法.本文第2节简要介绍主动学习以及无监督特征学习的基本概念及研究现状;第3节详细介绍本文所提出的主动特征学习框架;第4节介绍如何利用图像特征进行质量预测;第5节对实验设置及结果进行介绍和分析;第6节对本文进行总结.2相关工作2.1主动学习由于有监督学习方法一般需要大量有标记样本的问题,而标记样本需要消耗大量的人力、财力,因此Greg和Cohn[12]首次提出了主动学习技术以降低所需标记样本的数量.以分类问题为例,在主动学习中,观察人员首先随机标记少量样本,用于初始化分类器;然后,研究人员逐次标记少量分类器难以辨别的样本,并更新分类器模型参数,从而提高分类器的辨别能力;依次循环,直到分类器达到预想的分类精度.实验表明,基于主动学习技术可以大幅降低训练分类器所需的样本数量,从而降低了标记样本所需的时间和财力.之后,Klaus[13]对主动学习策略进行了扩展,指Page3出在选择新的样本时,需要考虑样本之间的差异性.Hoi等人[14]进而引入了表征性指标,综合不确定性、差异性和表征性迭代选择样本,并将其应用于图像检索中.此外,研究人员还将主动学习与半监督学习相结合,并用于图像检索等领域中[15].在本文中,作者将主动学习的策略引入到无监督特征学习中,综合样本的表征性与差异性选择样本,用于字典的构建.据作者所知,这是国内外第一个将主动学习策略与无监督学习相结合的方法.2.2无监督特征学习无监督特征学习旨在从未标记的数据样本中学习到比较好的特征表示,并将其应用于分类、回归等高阶任务中.Coates等人[16-17]针对单层特征学习进行了研究,提出了单层无监督特征学习的一般性框架,并验证了其有效性.本节中,我们以无监督特征学习在图像中的应用为例,简要描述无监督特征学习的一般性框架.该框架通过以下4个步骤学习图像的特征表示:集合学习字典;(1)从未标记图像集中随机选取图像块;(2)对图像块进行预处理;(3)使用无监督学习方法从预处理后的图像块(4)给定一幅图像,首先均匀提取图像块并进行预处理,然后将各个图像块分别在字典上进行编码,最后将所有图像块对应的编码系数进行综合,得到最终的图像表示.在CORNIA方法[10]中,Ye等人采用K均值聚类方法对预处理后的图像块进行聚类,并以聚类中心作为字典.实验观察表明,当字典尺寸较小时,COR-NIA的性能会迅速下降.这主要是因为:在字典尺寸较小时,K均值聚类得到的聚类中心之间差异性较小,难以表征所有可能的失真模式,导致所学特征的判别性较差.3主动特征学习本文针对无监督特征学习存在的问题,对其字典学习过程进行了改进,提出了主动特征学习框架.主动特征学习框架的流程与无监督特征学习类似,不过在字典学习阶段,我们引入主动学习策略,综合样本自身的表征性以及样本之间的差异性,迭代选择具有最大信息量的图像块作为字典的原子,从而可以得到更完备的字典,进而可以学习得到更好的图像特征表示.主动特征学习框架的详细流程如图1所示.接下来我们对其具体步骤进行介绍.给定一组未标记图像,我们首先随机地从这些图像中选取M个b×b大小的图像块,并将每一个图像块转化为向量形式.我们将提取的图像块集合表示为P,则有其中,狆i(i=1,…,M)为d维列向量,d是图像块向量的维度.当图像为灰度图像时,d=b×b;当图像为彩色图像时,d=b×b×3.之后,我们对提取的图像块进行预处理.3.1预处理行归一化.归一化方法可以表示为在预处理阶段,我们首先对提取后的图像块进其中,mi和σi分别是狆i像素值的均值和标准差,狆~归一化之后的图像块.归一化后的图像块集合表示为之后,我们使用零成分分析(ZeroComponentsAnalysis,ZCA)对其进行白化,其数学表达为其中,狓i表示白化后的狆~阵,X={狓1,狓2,…,狓M}为白化后的图像块集合.从视觉生理学上分析,零成分分析可以模拟视网膜对图像的处理[18].具体而言,当眼睛观察图像时,由于图像中的局部邻域灰度值一般具有较高的相关性,视觉感知野中相邻的神经元也会感知到相近的数值.如果眼睛利用视觉神经分别处理/传输各个像素会造成“资源”的浪费.因此,视网膜会对图像进行去相关,从而得到具有较少冗余的图像表示,并将其传输到大脑中进行进一步的感知与理解.这一过程与零成分分析的操作类似.因此,白化后的图像Page4块又被称为图像的局部特征描述[16].3.2主动字典学习我们基于主动学习策略,从X中迭代选择信息量最大的图像块构建字典.我们认为,图像块的信息量应该包含两个方面:(1)图像块自身的表征性———选择的图像块应该与尽可能多的图像块相似,这样我们只选择少量的样本就可以表征整个图像块集合;(2)图像块之间的差异性———新选入的图像块应该与已选择的图像块之间具有较大的差异,这样我们构建的字典可以表征更广范围的图像失真模式.在下面的小节中,我们分别对表征性和差异性的度量以及主动字典学习的过程进行介绍.3.2.1表征性(Representativeness)我们使用径向基函数(RadialBasicFunction,RBF)计算样本之间的相似度,并基于样本与对应邻域样本之间的相似度来度量其表征性.本文中,我们通过式(1)估计图像块的表征性:R(狓i)=1其中,R(狓i)为图像块狓i的表征性,狓i-狓j狓j之间的欧氏距离,σR为径向基函数的带宽.本文中,我们通过式(2)自适应地选择σ2其中,median表示取中值;ρ是标量,用来调节σ2尺度.实验表明,当ρ取0.01与1之间的任意数值时,方法都可以取得较优的性能.在本文中,我们选择ρ=0.1.3.2.2差异性(Diversity)我们用S表示已选择的图像块集合(即字典),用U表示未被选择的图像块集合.对于样本狓i∈U,我们基于狓i与S中所有图像块之间的最小夹角计算狓i的差异性.其数学表示为其中,狓i·狓j表示狓i与狓j的内积,cos-1表示反余弦函数,·表示向量的模值.3.2.3主动样本选择因为包含信息量最多的图像块需要同时满足表征性与差异性,因此我们使用表征性与差异性度量的加权平均作为图像块信息量的度量,进而选择出包含信息量最多的图像块作为新的字典原子.样本选择的准则可以表示为其中,λ∈[0,1]是加权系数,用来权衡样本表征性与差异性对字典构建的影响.直接从U中选择出所有最具信息量的图像块是非常困难的.因此,在主动字典学习中,我们采用逐步迭代的方法:在每一次迭代中,综合表征性与差异性选择包含信息量最多的图像块加入字典S,并更新集合U以及狓i∈U的差异性度量;如此循环,直到S中包含了足够多的图像块.需要说明的是,给定X,则所有样本的表征性不再变化,因此在迭代过程中不需要重新计算狓i∈U的表征性度量.主动字典学习的详细步骤如过程1中所述.过程1.主动字典学习.1.初始化:样本集合X,拟构建的字典尺寸K,已选择样本的个数k=0,字典S=,待选样本集U=X;2.利用式(1)估计U中样本的表征性;3.从U中选择1个最具表征性的样本,作为初始字典S,并将其从U中删除:4.利用式(3)计算狓i∈U与S之间的差异性;5.选择信息量最大的样本加入字典S,并将其从U中删除:6.如果k<K,返回4;7.输出字典.为了方便描述,我们将学习到的字典S写为矩阵形式并用犆=[犮1,犮2,…,犮K]d×K表示.其中,犮i是第i个字典原子,i=1,…,K.之后,我们对字典原子使用犮~i=犮i/犮i进行归一化,使各个向量长度为1.归一化后字典表示为为了简便,我们在下文用“字典原子”指代归一化的字典原子.图2显示了本文基于主动字典学习图2基于主动字典学习得到的部分字典原子Page5得到的部分字典原子.可以看出,字典原子可以表征边缘、噪点、纹理等不同的局部结构,同时原子之间具有较大的差异性,这使得所学特征具有较强的判别能力.3.3局部特征编码个图像块并进行预处理,得到其局部特征集合:给定一幅测试图像,我们首先从中均匀提取mi表示第i个局部特征向量,i=1,2,…,m.其中,狓t由于软分配编码(Soft-assignmentcoding)可以提升编码系数的判别能力,并且在图像分类中取得了很好的效果[13],因此我们将狓t行软分配编码.狓t其中,zi,j+K=max{-狓ti·犮~j表示狓t狓t们将测试图像对应的所有编码表示为矩阵形式,即3.4局部特征综合接下来,我们采用最大化综合(max-pooling)的策略对所有图像块的编码系数进行综合,以得到固定维度的图像特征向量犳,即其中,Ψmax表示在犣的每一行取最大值,犳的第j个元素fj可以表示为其中,max表示取最大的操作.4盲图质量评价fj=max{z1,j,z2,j,…,zm,j},j=1,…,2K;犳=Ψmax(犣)=[f1,f2,…,f2K]T∈由于支持向量回归(SupportVectorRegression,SVR)具有较优的泛化能力,并且已成功应用于多种图像处理问题[19],因此我们使用SVR构建图像特征与视觉感知质量之间的数值映射,实现图像质量的盲预测.该方法包含训练和测试两个过程:(1)在训练过程中,我们首先利用主动特征学习方法提取训练集图像的特征向量,然后将训练集图像的特征与主观质量分数输入到SVR模型进行训练,得到最优的模型参数;(2)在测试过程中,对于任意给定的测试图像,我们首先利用主动特征学习方法提取其特征向量,然后将其输入到已训练好的SVR模型中,即可估计出测试图像的视觉质量分数.在本文中,我们采用了v-SVR模型及线性核函数,并利用LIBSVM工具箱①实现该方法.5实验结果及分析5.1数据集在特征学习过程中,我们使用CSIQ数据库[20]中的图像数据作为标记数据.由于CSIQ数据库中的图像与LIVE数据库中的图像在图像内容方面没有重叠,因此利用CSIQ数据库进行特征学习可以更加准确地验证我们方法的有效性.CSIQ数据库包含30幅原始图像以及它们对应的866幅失真图像.CSIQ数据库中包含了6种失真:JPEG压缩、JPEG2000压缩、加性粉红高斯噪声(additivepinkGaussiannoise)、高斯模糊、全局对比度下降(globalcontrastdecrements)和白噪声.此外,我们还生成了一些新的失真类型图像:斑点噪声(specklenoise)、泊松噪声(Poissonnoise)和椒盐噪声(salt-peppernoise).在本文的实验中,我们只使用了图像的亮度成分.我们从这些未标记图像中随机选取105个8×8大小的灰度图像块用来估计ZCA变换矩阵犠ZCA以及构建字典.为了验证本文方法的性能,我们在LIVE标准数据②上进行了实验.LIVE数据库包含29幅原始图像以及由这29幅原始图像生成的5类失真图像(共808幅).这5类失真为:JPEG2000压缩(JP2k)、JPEG压缩(JPEG)、高斯白噪声(GaussianWhiteNoise,WN)、高斯模糊(Gaussianblurring,Gblur)和瑞利信道快衰落(FastfadinginRayliaChannel,FF).数据库中给出了每一幅图像的差分平均主观分数(DifferentialMeanOpinionScore,DMOS).图像的DMOS值越低,表明其视觉感知质量越好.我们使用图像质量评价计算预测的质量分数与图像DMOS值之间的斯皮尔曼等级相关系数(SpearmanRank-orderCorrelationCoefficient,SRCC)和皮尔逊线性相关系数(Pearson’sLinearCorrelationCoefficient,PLCC),将之作为方法性能的指标.SRCC和PLCC值越大,表明方法的性能越好.我们利用100次实验中PLCC和SRCC的中值作为方法性能的估计.在每一次实验中,我们从LIVE数据库中随机选择23幅原始图像及其对应的失真图像作为训练集,并在剩余的图像上进行测试.我们通过在训练集上进行交叉验证得到v-SVR模型的参数估计.在5.2节及5.3节中,本文方法的①②Page6结果对应的主动字典学习中的加权系数为λ=0.5.在5.4节中,我们分析不同的λ对性能的影响.5.2主动特征学习的有效性为了验证主动特征学习框架的有效性,我们将本文方法与基于K均值聚类进行特征学习的方法(即CORNIA方法[10])进行了比较.在质量预测部分,都采用了v-SVR模型及线性核函数.我们分别测试了字典原子个数K为200、400、800、1200、2500、5000和10000时,盲图像质量评价方法的性能.图3显示了这两种方法在整个测试集上的SRCC值随字典原子个数变化的情况.图3SRCC值随字典原子个数K的变化柱状图可以看出,在字典尺寸较高时,两种方法都取得了较好的性能.这是由于,此时使用K均值聚类与主动字典学习都可以得到过完备的字典,从而使得所学特征具有较好的表征能力.然而,当字典尺寸较小(即特征维度较低)时,本文方法较CORNIA方法预测精度提升近8%.这主要是因为:在K均值聚类中,主要考虑了样本的表征性,而忽略了样本之间的差异性,导致在字典尺寸较小时,其字典原子无法表征多种多样的失真模式.而在主动特征学习中,我们综合考虑了样本自身的表征性以及样本之间的差异性,当字典尺寸较小时,所得到的图像特征仍然具有较高的判别能力,从而有效克服了这一缺陷.因此,主动特征学习可以在保持较优性能的同时,大幅降低对于计算机存储与计算资源的消耗.由于手机、平板电脑等电子设备的存储与计算能力较为有限,主动特征学习对图像质量评价的推广和应用具有重要意义.5.3一致性实验在本节中,我们将本文所提方法与现有最优的几种盲图像质量评价方法进行比较.这里进行对比的方法有BLIINDS-II[5]、BRISQUE-L[6]、NSS-TS[8]以及CORNIA[10].其中,对于BLIINDS-II,我们采用支撑向量回归进行质量预测.CORNIA及本文方法的结果对应的字典大小都是10000.表1和表2分别给出了各个方法在LIVE数据库各个失真以及全部测试集上的SRCC和PLCC值,并用粗体显示了最优的性能指标.通过表1和表2,可以看出本文方法在各个失真上都与人眼主观感知质量具有较高的一致性.同时,本文方法的整体性能明显优于其他盲图像质量评价方法,这进一步验证了主动特征学习方法的有效性.表1不同方法在LIVE数据库上的SRCC值方法JP2kJPEGWNGblurFF全部BLIINDS-II0.9340.9000.9460.9410.9070.922BRISQUE-L0.9280.9130.9790.9610.9210.936NSS-TS0.9310.9150.9710.9390.9350.930CORNIA0.9240.9390.9690.9590.9200.946本文方法0.9310.9480.9590.9640.9230.951表2不同方法在LIVE数据库上的PLCC值方法JP2kJPEGWNGblurFF全部BLIINDS-II0.9340.9200.9360.9270.9000.909BRISQUE-L0.9320.9350.9660.9450.9240.926NSS-TS0.9470.9330.9630.9500.9420.926CORNIA0.9490.9640.9770.9540.9400.948本文方法0.9560.9700.9710.9610.9440.9525.4主动特征学习参数对性能的影响为了验证主动特征学习过程中,加权系数λ∈[0,1]对于最终性能的影响,我们选取了不同的λ学习特征,并进行质量预测.图4给出了字典尺寸为800时,本文方法在整个LIVE数据库上的SRCC指标随加权系数λ的变化情况.在其他的字典尺寸下,也有类似的实验现象.同时,PLCC表现出类似的变化情况.可以看出,当λ=0.5时,本文方法可以取得最优的性能.而当λ接近于0或接近于1时,其性能大致呈下降趋势.其中,当λ接近于1时,性能下降更为迅速.此时,差异性在主动字典学习中的权重下降.这说明差异性相比表征性对于主动特征学习更为重要.这也与5.2节中的分析相一致,即差异性的引入使得主动特征学习框架优于无监督特征学习方法.这进一步验证了综合考虑样本的表征性与差异性进行主动字典学习的合理性.Page76结论本文中,作者将主动学习的策略引入到无监督特征学习中,提出了一种主动特征学习框架,并将其应用于盲图像质量评价.实验结果表明本文盲图像质量评价方法与人眼感知高度一致,同时也验证了主动特征学习优于传统无监督特征学习方法.因为主动特征学习可以在保持较优性能的前提下,大幅度降低对计算机存储与计算资源的消耗,这对相关学习问题的推广和应用具有重要意义.在接下来的工作中,我们认为至少还有以下问题有待深入研究和探索:(1)研究主动特征学习框架中,不同初始化方法、不同编码方式以及综合方式等对性能的影响;(2)研究基于批次(batch)的主动特征学习框架,即在每一次迭代中选择多个样本,从而提高主动字典学习的效率;(3)将主动特征学习框架拓展到目标分类等问题中,进一步验证其有效性,并挖掘其可能的改进方案.
