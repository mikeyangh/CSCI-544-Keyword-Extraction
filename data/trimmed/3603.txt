Page1基于成对累计量的自然图像拓扑表示模型王哲黄雅平罗四维王亮(北京交通大学计算机与信息技术学院北京100044)摘要针对传统模型建模复杂、算法效率较低等缺点,提出了一种学习自然图像拓扑表示的新方法.不同于传统的空域汇集操作,文中利用“成对累计量”对初级视皮层复杂细胞之间的二元关系进行建模,并结合向量在高维空间中的分布特点,得到了能够模拟V1区复杂细胞特性的自然图像拓扑表示模型.此外,在模型的估计部分,推导出基于“不动点迭代”的快速学习算法.实验表明,该模型能够有效地捕捉复杂细胞中的非线性依赖关系,从自然图像中学习的基向量具有类似于V1区复杂细胞的特性.与传统方法相比,文中算法不仅适用于完备或超完备基的学习问题,而且具有类似于FastICA算法的收敛性能,比同类算法更加快速可靠.关键词独立分量分析;拓扑表示;二元关系;成对累计量;超完备;不动点算法1引言近年来,对哺乳类生物视觉系统、初级视皮层(V1区)的信息处理方法研究已经成为一个热点问题.众所周知,进化使得视觉系统对外界环境具有自适应性,并能够根据输入的视觉信息(例如自然图像)来调节自己的行为.因此,视觉系统的信息加工过程与自然图像的统计特性密切相关.模拟V1区视觉处理过程的常用方法是设计一个统计生成模型(generativemodel)来处理自然图像等观察信号.从自然图像中提取出有效的特征基向量或滤波器,不仅能够模拟V1区细胞的神经行为特征,并且被广泛应用于图像处理等任务中.构建有效的统计生成模型,关键在于利用V1区细胞的三个重要特性:稀疏性、相关性和超完备性.研究表明V1区的神经细胞主要包括两类:简单细胞(simplecell)和复杂细胞(complexcell)[1].V1区细胞的稀疏性是指当感受野受到外界刺激时,并非所有的简单细胞都被激活.相反,只有极少数的简单细胞会做出响应.很多算法,通过计算自然图像的近似或准确的稀疏表示,得到类似于V1区简单细胞感受野形状的Gabor状基向量[2-5].相关性意味着细胞彼此间并不是完全独立的[1,6].事实上,复杂细胞中存在着大量的拓扑结构,相邻的细胞间具有很强的高阶相关性,而距离较远的细胞则近似独立.超完备性简单来说,就是指V1区处理信息的神经细胞数量远远大于输入信息的维度.近年来,如何捕捉和利用复杂细胞中的非线性相关性引起了广泛的研究.Hyvarinen等人[7]提出了独立子空间模型(ISA)和拓扑独立分量模型(TICA)[8]来提取非线性的依赖关系,得到了类似于V1区复杂细胞的拓扑特征.学生乘积模型(POT)在TICA模型的基础上进行超完备扩展,提取出类似于V1区复杂细胞的超完备拓扑结构[9].其它的一些模型也得到了类似于复杂细胞的特性,并且被成功用于图像恢复和图像识别等任务中[10-12].然而,传统的复杂细胞建模方法具有模型复杂、算法效率较低的缺点.此外,由于巨大的计算量,大多数模型并没有考虑复杂细胞的超完备性,即使一些模型考虑了超完备性,由于计算速度的原因,也难以实用化.因此,如何能够快速有效地实现自然图像完备和超完备的拓扑表示是当前研究的一个重点和难点问题.本文受基于高阶累计量的独立分量分析模型以及著名的FastICA算法启发,提出了一种学习自然图像拓扑表示的新方法.本文从度量视皮层神经元的稀疏性和相关性的角度出发,使用成对累计量(pairwisecumulant)来构建复杂细胞中相邻神经元间的二元关系.在独立分量分析模型的基础上,将表示细胞间邻接关系的拓扑函数与定义的二元关系度量相结合,提出了成对累计量独立分量模型(PairwiseCumulant-basedIndependentComponentAnalysis,PCICA)和相应的不动点学习算法.此外,根据向量在高维空间中的分布特点,本文引入基于准正交性的近似估计方法,在保证算法仍然快速收敛的目标下,实现了自然图像的超完备拓扑表示.实验证实,PCICA能够得到与ISA、TICA和POT等模型相似结果,从自然图像数据集提取出的基向量具有类似于复杂细胞感受野的性质.与传统方法相比,本文算法在学习自然图像完备和超完备拓扑表示上,具有与FastICA相似的收敛性能,超过了ISA和TICA模型在自然图像完备表示上的二阶收敛速度.并且,与POT模型以天或者周为训练代价的学习效率相比,算法效率大大提高.2相关工作2.1自然图像下的独立分量分析模型独立分量分析(ICA)是一个线性的生成模型,在细胞建模和特征提取上有着广泛的应用.一般而言,自然图像下的ICA模型可以表示为式中,犐为某幅自然图像(或者是分割后的图像块).犫i表示自然图像的基向量,si为基向量犫i的特征系数,可以看作是第i个基向量犫i对图像犐的贡献值.这样,自然图像犐就可以表示为n个基向量犫1,犫2,…,犫n的线性组合.假设矩阵犅是满秩的,式(1)可以转换为式中,狑Ti是矩阵犠的第i行,而犠=犅-1.滤波器狑i可以看作初级视皮层简单细胞感受野.变量si表示感受野对图像犐产生的响应,它可以模拟初级视皮层简单细胞的特性,也可以看作ICA模型中的独立分量.这样,估计自然图像基向量集犅的问题就转化为在给定一组观测图像下,估计滤波器集犠.解决此问题的方法有很多,其中广泛选用的是快速独立分量分析算法(FastICA)[4,13].FastICA基于极大Page3化非高斯性原理,并使用不动点迭代方法进行求解,其目标函数定义如下:式中,E{·}表示数学期望,f(·)是非高斯性的度量函数,通常要求是平滑且对称的.传统的非高斯度量指标是四阶累计量或者峰度,其定义如下:峰度值越大,意味着变量v的稀疏性越强.当约束变量v的方差等于1,极大化峰度就等价于极大化四阶累计量E{v4}.但是峰度(或者四阶累计量)具有一些不好的统计特性,例如对噪声比较敏感.在实际中,经常使用其它的高阶累计量或者非线性函数来替代函数f(·),例如负熵[4]等.此外,FastICA采用牛顿法寻找目标函数的极值点,得到的算法收敛速度快,稳定性好.理论和实验证实[4,13],采用峰度或者负熵等度量函数的FastICA算法具有三阶收敛的性能,与梯度法相比具有明显优势.通过使用自然图像进行训练,ICA模型得到的滤波器和基向量具有类似初级视皮层V1区简单细胞感受野的三个显著特性:局部位置选择性、朝向选择性和带通选择性[1].2.2独立子空间和拓扑独立分量模型Hyvrinen等人在ICA的基础上提出了独立子空间模型(ISA)和拓扑独立分量模型(TICA)来解释V1区复杂细胞的拓扑结构.ISA和TICA通过定义的空域汇集操作(spatialpoolingoperation):构造出新的独立分量ui.它将ICA模型中要求各个分量相互独立的条件放松,允许一定区域πi内的分量sj有相关性.ISA将各个分量分成若干个组πi,假设不同的组πi之间并不重叠,这样,不同组之间的分量是相互独立的,而组内的分量可以不独立.TICA规定各个空间邻近的πi之间彼此重叠,这样,距离相近的分量之间相关性较强,而彼此远离的分量之间有较强的独立性.通过ISA和TICA模型得到的基向量与V1区复杂细胞的拓扑特性相类似.然而,并没有证据显示ISA和TICA使用的汇聚操作(5)与V1区复杂细胞的神经处理方式相一致.并且,ISA和TICA模型使用梯度法来估计滤波器W,算法收敛速度十分缓慢.虽然文献[14]提出了ISA模型的快速不动点学习算法(FastISA),但是FastISA最多只有二阶收敛的性能,收敛速度与FastICA相比仍不理想.2.3学生乘积模型Osindero等人对经典的ICA模型和TICA模型进行了超完备扩展,得到了能够同时满足神经细胞稀疏性、相关性和超完备性的学生乘积模型(POT),实现了自然图像的超完备拓扑表示.然而POT模型的训练过程相当复杂,例如,需要使用马尔可夫链蒙特卡洛(MCMC)等方法进行采样逼近,训练时间通常都以天或周来计算,效率较低.在此基础上的其他研究工作[15],也都没有提出能够达到接近FastICA算法收敛速度的有效方法.3成对累计量独立分量模型(PCICA)实验表明,V1区复杂细胞的感受野存在大量的拓扑结构,相邻的感受野具有一些不变的特征属性,如朝向、位置等.这意味着这些相互邻近的细胞间具有很强的依赖性,而相互远离的细胞彼此之间或多或少是独立的.Page4另一方面,在上面提到的经典ICA模型中,细胞响应si是假设彼此独立的,ICA就是寻找一种最优的线性变换使得不同的响应si之间尽可能地相互独立.然而,由于线性模型的限制,ICA估计得到的“独立分量”有时并非完全独立,这些分量间还存在着很强的非线性相关性.因此,如果能够保留分量间有用的高阶依赖关系,那使用基于ICA的系统来捕捉自然图像残留的高阶统计信息,并对复杂细胞进行建模是完全可行的.计算互累计量(crosscumulant)是估计不同分量间的二元依赖结构的一种方法.其中,最常用的是线性累计量,它的定义是E{sisj}.但是在ICA模型中,分量间的线性相关性是没有意义的,甚至是完全不存在的[4,16].实际上,ICA中用于训练的自然图像数据一般要使用主分量分析(PCA)进行“白化”预处理,即其中,犞叫做白化矩阵,它可以由下式给出:式中,犉和犇分别对应于特征值分解E{犐犐T}=犉犇犉T的特征向量和特征值矩阵.这样,对于线性累计量,可以得到因此,我们应该考虑分量间的高阶或者非线性的相关性.本文,根据峰度的定义引入“成对累计量”的概念.成对累计量是对峰度的一种扩展,它不仅能够度量分量的稀疏性,同时,还能度量分量之间的二元高阶相关性.成对累计量的定义如下:其中,g(·)是一个平滑可微的凸函数.函数g(·)的作用是衡量分量的响应强度,一个常见的形式是它可以看成是关于响应能量的度量.代入式(10)就有E{s4i+s4一样度量响应的稀疏性,第三项是度量这两个响应能量之间的相关性.但是,由于峰度不利的统计特性,在实际中,我们选择如下的非线性函数:这个函数对噪声有很好的鲁棒性.接下来,我们考虑复杂细胞间近邻结构的表示方法.ISA模型中是将si划分成组,这样,在同一个组内的si具有相关性,而不同组之间的si是相互独立的.在TICA中使用一个更加接近于复杂细胞空间拓扑结构的方法,取得了很好的效果.在这里,我们定义一个表示细胞间邻接关系的拓扑函数:h(i,j)=1,‖d(i)-d(j)‖r且i≠j其中,d(i)和d(j)定义分量si和sj在拓扑中的位置,r是一个表示邻域宽度的常数.因此,式(12)表示,在拓扑中如果分量si和sj之间的距离不大于r,它们就是近邻的,并标记为1,否则就是0.图2给出了一个2维拓扑结构的例子.在本文中,为了简化运算,如同文献[7-9,11],我们直接给出它的形式.图2分量si的8邻域结构的2维拓扑示意图通过使用拓扑函数以及定义的二元关系度量,并极大化拓扑结构中所有分量间的成对累计量,就得到PCICA模型的目标函数:argmax狑i∑k,k≠i然后,根据梯度法就可以得到滤波器犠的最优Δ狑i∝E犐g(狑Ti犐)∑k估计.关于狑i的梯度为其中,g(·)是非线性函数(·)的一阶导数,狌(i,k)是根据拓扑函数h(i,k)得到的权重向量,具有如下形式:其中,M等于分量si在拓扑中邻居的个数.特别的,如果不考虑分量间的相关性,则PCICA模型就退化为常规的ICA模型.因此,如果使用脉冲函数(deltafunction)来代替权重向量狌(i,k),则梯度式(14)就可以用来进行ICA估计.4PCICA的不动点迭代算法在前一小节,我们构建了一个基于成对累计量的自然图像拓扑表示模型,并采用梯度下降法来寻找目标函数的最优极值点.但是,梯度下降法有一些Page5普遍的缺点:收敛速度慢,对迭代步长需要一个经验的选择.如果选择不恰当的迭代步长,算法很容易震荡甚至不收敛.由于“不动点”算法不牵涉选择迭代步长的问题,同时收敛速度非常快,因此在大多数场合下都优于基于梯度的学习算法.在这里,我们给出一个基于不动点的迭代学习算法来估计模型.为了得到更好的收敛性能,我们引入牛顿迭代方法,这与FastICA中的处理方法类似(更多的细节参见文献[4]).根据拉格朗日条件[17],式(14)可以等价地表示为H(狑i)E犐g(狑Ti犐)∑k式中,β是引入的常数.采用牛顿迭代法求解,得其中狑i是狑i新的取值,并且H(狑i)=H其中,Λ表示单位矩阵.我们对式(17)进行一些简化.首先,在实际处理中,经过预处理后训练数据犐都是“球化”的,因此,式(18)的第1项和第2项可以分别近似为E犐犐Tg(狑Ti犐)∑k{=E{犐犐T}Eg(狑Ti犐)∑k=Eg(狑Ti犐)∑kE{犐犐Tg(狑Ti犐)2}M=E{犐犐T}E{g(狑Ti犐)2}M此外,将式(17)两边同乘以H(狑i),经代数化和简后,得到的不动点算法具有如下的迭代形式:狑i=E犐g(狑Ti犐)∑k{EMg(狑Ti犐)2+g(狑Ti犐)∑k上面提出的迭代方法只是针对单一分量的.如果想估计出矩阵犠中所有的狑i,就需要对每一个狑i都进行上面的迭代算法.为了防止不同的分量都收敛到同一个极值点,并且为了保证算法在单位范数的约束下,必须在每一次迭代完对矩阵犠进行正交单位化,在FastICA也有类似的处理方法.在应用算法之前,还有一个常用的预处理程序,包括对训练数据的中心化(去均值)和白化(式(6)).总之,不动点迭代算法的详细步骤总结如下.算法1.PCICA的不动点迭代算法.1.预处理:犣中心化,←白化犐.2.选择一个初始化的(例如,随机的)矩阵犠,并将矩阵犠进行正交单位化:犠←(犠犠T)-1/2犠.3.更新犠直到收敛:5基于成对累计量的超完备独立分量模型(Overcomplete-PCICA,OPCICA)当分量si的数量大于观察数据(在这里指自然图像)的维度时,矩阵犠不再是一个可逆的方阵,滤波器狑i的数量大于其自身的维度,这样的情况我们称之为超完备(overcomplete)的.这时使用算法1来求解模型就会遇到困难,因为算法1只适合矩阵犠为方阵,即完备(complete)的情况.现在有很多方法可以估计超完备的模型,但其中有些或者不能得到类似于复杂细胞的拓扑表示[18],或者不具有快速迭代学习的特点[9,11,15].本文将文献[18]提出的方法引入基于成对累计量的模型,这种方法的基础就是FastICA,并结合了准正交的概念.一般认为,在n维空间中,最多只有n个向量是彼此正交的.但是在高维空间中,向量具有更大的空间.这时候,如果是一个n维空间,实际上很可能会有2n个向量彼此之间是接近正交的.随着n的增大,趋于准正交的向量数量还会增加,并且它们之间的角度会更加接近于90°.在我们的典型应用中,包括细胞建模和特征提取,处理的训练数据的空间维度通常都很高(几十甚至上百维),因此在其中找到一组满足准正交性质的向量是非常可行的.所以,估计一组超完备的滤波器应该满足如下两个条件:首先,各个分量si应该尽可能的稀疏.其次,滤波器狑i应满足准正交性.算法1已经给出了极大化分量si稀疏性的方法.而滤波器狑i应满足的准正交性,可以通过如下的准正交处理方法实现:这个方法能够极大化矩阵犠中向量狑i之间的角Page6度[18],并且它的计算效率很高,满足我们对超完备学习方法快速迭代的需要.可以看出,除了正交化方法,超完备模型的估计同算法1在各方面都非常相似.因此,用式(22)给出的准正交处理方法替换算法1中的正交单位化处理,就得到OPCICA模型的快速学习算法.6实验及结果我们选用的是ICA和稀疏编码模型中广泛使用的灰度图像数据库(来源于http://www.cis.hut.fi/projects/ica/data/images/),如图3所示.我们从这些图像中随机抽取50000个16×16的图像块,并将每个图像块转化为256维的向量作为输入数据犐.在预处理中,我们去除了数据向量的均值,然后使用PCA对数据向量进行白化,此外,为了减少计算量和数据规模,我们将数据降到196维.为仿真结果显示的需要,实验的最后我们还执行一个与预处理相反的逆操作,并将滤波器转化为基向量.对于非线性函数g(·),我们选择鲁棒性较好的式(11).对于拓扑函数h(i,j),我们分别选用分量的“8邻域”和“24邻域”两个尺度.见图2给出的分量si“8邻域”的拓扑示意图.此外,我们使用环状网格(torusgrid)避免边界效应,这意味着在拓扑结构中,最上方与最下方的边界是相邻的,最左边与最右边的边界是相邻的.6.1收敛性分析我们比较了PCICA、OPCICA的不动点算法与FastISA[14]算法的收敛性能.由于ISA与TICA只是对分量si的空间划分有所不同,我们将TICA模型中的拓扑函数应用于FastISA,就得到了TICA的不动点迭代算法.此外,我们也测试了梯度法的性能,并给出了在使用经验最优的迭代步长下PCICA的收敛情况.我们在相同的环境下执行这些算法,包括相同的训练集、预处理以及初始迭代点.在PCICA中,我们使用“8邻域”的拓扑函数,FastISA也采用类似尺度的拓扑函数.OPCICA中,我们生成了2倍数量的超完备基向量,并使用“24邻域”的拓扑函数.我们通过计算所有算法在迭代过程中各自目标函数值的变化情况来衡量算法的收敛性.为了统一比较,我们将所有算法的最大目标函数值都进行了归一化处理.图4(a)给出各个算法的数值结果.可以看出,使用不动点算法的PCICA和OPCICA的效率很高,迭代500次左右就能够达到收敛.在选择最优迭代步长的情况下,使用梯度法的PCICA效率要略低于快速不动点算法,大约需要800次迭代才能够收敛.而FastISA算法虽然具有二阶收敛的特点,但效果仍不理想,算法在迭代1000次后才能够达到收敛.图4不同算法的收敛次数比较.误差线也同时给出.此外,如果使用脉冲函数来代替权重向量狌(i,k),则PCICA的算法可以用来进行ICA估计.如果ISA和TICA模型使用“1邻域”的拓扑函数,则ISA和TICA模型退化为基本的ICA模型,而FastISA算法也可以进行ICA估计.我们比较了FastICA算法、PCICA的不动点算法和FastISA算法在ICA估Page7计时的收敛性能.如图4(b)所示,可以看出,PCICA的不动点算法与FastICA算法的收敛速度非常接近,经过不到200次的迭代后就能够达到收敛.而FastISA算法收敛较慢,至少需要迭代500次才能够收敛.6.2自然图像基向量使用PCICA、OPCICA模型估计的完备和2倍超完备基向量如图5和图6所示.首先,它们在空间、频率和朝向上具有明显的局部性,这些特征与Gabor函数的性质非常接近.此外,这些基向量展现出清晰的拓扑组织结构,其中频率、朝向、位置具有局部连续性,而相邻基向量的相位则有很大差异.另外,由于在OPCICA模型中使用了范围更大的拓扑函数,可以看到2倍超完备基向量的拓扑结构更加平滑有序.PCICA和OPCICA模型产生的拓扑结构及其特性与复杂细胞中发现的性质非常类似.使用最小二乘法将Gabor函数与基向量进行拟合,得到了每个基向量对应的最优的Gabor参数,包括频率、朝向、位置和相位.图7所示为完备和图6OPCICA模型估计的2倍超完备基向量图7使用Gabor函数拟合基向量得到的参数分布图2倍超完备基向量的参数分布图.可以看出,基向量的朝向和频率是相对独立的,而位置的分布则非常平均.在OPCICA模型中,随着基向量的增多,参数的分布变得更加稠密和均匀.此外,相位的分布表现出了明显的“奇对称”特性,类似于V1区简单细胞的性质[19].ICA和稀疏编码模型估计的简单细胞基向量也能得到类似的分布结果.Page8此外,我们将这些参数画在2维拓扑图上来分析复杂细胞的不变性.图8给出了2倍超完备基向量的相位、频率、朝向和位置的拓扑图.在相位图中,参数的分布看起来是无序的,没有明显的结构特征.而其它图则具有清晰的拓扑组织结构,相邻的两个图8使用Gabor函数拟合2倍超完备基向量得到的参数拓扑图6.3分量间高阶相关性的比较平方后的相关系数,定义如下:在这里,我们主要考察的是能量相关性,即分量其中,D(·)和Cov(·)分别表示方差和协方差运算.我们计算了拓扑中每个分量si分别与其8个邻居分量之间的能量相关性,然后对相关性的大小进行统计.图9分别给出了对FastICA、TICA、PCICA以及OPCICA的统计直方曲线图.结果证实,FastICA中的分量相关性较小,而TICA、PCICA以及OPCICA模型则能够在这些分量中捕捉到非线性的依赖关系.并且,使用了相似拓扑函数的PCICA和TICA模型相比,PCICA中近邻分量间具有较高相关性的图9相邻分量间相关系数的统计直方曲线图基向量具有类似的频率和方向,空间位置也非常接近.这说明,相邻基向量之间的频率、朝向、位置是强相关的,而相位则是不相关的.这些结果与在V1区复杂细胞中发现的性质非常类似.比例更高,这说明PCICA能够更有效地捕捉到分量间的能量相关性.6.4OPCICA中准正交处理的有效性通过验证估计的滤波器是否具有唯一性,即同样的滤波器仅能估计出一次,来确定准正交处理方法是否可靠.因此,我们计算了超完备滤波器集中每一个滤波器狑i与其余滤波器的空间角度.图10给出了OPCICA中滤波器间角度的统计直方图.为了比较,我们同样给出了PCICA的统计直方图.可以看出,PCICA中,由于正交化的处理,所有的角度都等于90°.在OPCICA中,滤波器间的角度低于60°的情况仅占所有角度的0.39%,而绝大部分的角度都非常大,并且多数都接近于90°,这说明估计的超完备滤波器具有良好的准正交特性,OPCICA中准正交处理非常有效.7结论和展望本文根据V1区神经细胞中固有的“稀疏”、“相关”和“超完备”三种重要属性,通过对相邻神经元间的二元关系直接建模,提出了一个基于“成对累计量”的自然图像拓扑表示模型,并在模型的估计部分,给出了快速的不动点迭代算法.PCICA模型可以看作是基于高阶累计量的独立分量分析模型的一Page9(为清楚起见,(b)图纵轴用数量的对数表示)个扩展,而PCICA的不动点算法也与FastICA算法具有相似的性能和特点.实验证实,该模型得到的基向量在频率、朝向和位置的变化非常平滑,具有类似于V1区复杂细胞的特性.此外,算法在完备和超完备的拓扑表示上都能够快速可靠地收敛.与传统方法相比,算法的实用性大大提高.近年来,受生理学的启发,越来越多的研究趋向于构造一个模拟视觉系统信息处理过程的模型来解决图像识别等问题.在图像的特征提取阶段,基于自然图像拓扑表示的特征描述子对于图像的微小变化并不敏感,对于检测不变特征十分有利[11].下一阶段,我们的工作集中在将本文学习得到的滤波器和基向量用于特征提取,并构建一个有效的图像识别模型.
