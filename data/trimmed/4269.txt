Page1Mimir:一种基于密文的全文检索服务系统宋伟1),2)彭智勇2)王骞2)李瑞轩3)程芳权2)崔一辉2)1)(武汉大学软件工程国家重点实验室武汉430072)2)(武汉大学计算机学院武汉430072)3)(华中科技大学计算机科学与技术学院武汉430074)摘要针对海量涉密隐私数据高效安全检索的需求,提出了一种基于密文的全文检索系统———Mimir.Mimir基于B+树构建了一种安全密文全文索引结构,Mimir检索过程完全在密文环境下进行,保证了系统的安全性和存储信息的私密性.与传统的全文检索系统相比,Mimir密文索引中没有存储索引词的位置信息和词频信息,可以有效地抵御已知明文攻击、选择明文攻击和词频统计攻击.对Mimir密文全文检索系统进行了性能测试,实验结果数据表明,Mimir密文全文检索系统在确保高安全性的同时,也具有很好的检索时间和存储空间性能.关键词密文全文检索;密文索引;Mimir;中文分词;B+树;信息安全;网络安全1引言随着计算机信息规模的不断增长以及网络通信技术的飞速发展,很多涉密单位(党政机关、财政金融、国防军工、科研高校等)相关部门中,信息的保有量和交流量都达到了前所未有的数量级.如何在这些海量信息中快速地检索自己需要的信息已成为一种迫切的需求.与此同时,大量涉密信息往往非常敏感,不允许在明文状态下存储和检索.尽管全文检索和信息安全技术都已相当成熟,并且都有了较好的商业产品出现,但是如何在加密、可信的环境下实现海量文本数据的高效、安全检索,仍然是一个急待解决的研究课题.为了实现海量涉密文本信息的高效、安全全文检索,我们结合信息加密和全文检索技术,研究了安全、高效的密文数据查询方法,并实现了一种基于密文的全文检索系统———Mimir密文全文检索系统.Mimir中所有的文档和全文索引都采用安全的加密算法进行加密处理,而且为保证检索过程的安全可靠,整个检索过程都不对密文索引和检索词进行解密操作,实现高安全性的密文全文检索服务.针对传统明文全文索引结构中存在的安全隐患,我们设计了Mimir密文全文索引结构,理论分析了Mimir密文索引结构可以抵御已知明文攻击、选择明文攻击和词频统计攻击,具有很好的安全保密性.我们对Mimir系统进行了实验分析,实验结果表明Mimir密文全文检索系统在保证系统高安全性的同时,也具有很好的全文检索服务性能.本文第2节将分析近年来国内外的相关研究工作;第3节详细介绍Mimir密文全文检索系统,包括Mimir密文索引结构和相应的查询、排序算法;第4节给出实验结果和分析;最后在第5节总结全文并提出下一步需要继续深入研究的工作.2相关工作随着信息系统在各个领域的广泛应用,它在给人们带来极大方便的同时,也带来了诸多安全方面的问题.因此,如何高效且安全地存储和查询文本、网页等非结构化数据是一个很值得关注和研究的问题.这其中的全文检索(Full-TextRetrieval)技术和全文数据库(Full-TextDatabase)技术成为了国内外学者研究的热点.目前虽然全文检索技术和信息加密技术都已经得到了飞速的发展,并且也都有了很好的商业产品出现,但是如何在加密环境下实现密文全文检索,仍然是一个没有解决的难题.加密数据检索的相关研究主要集中在外包数据库环境下如何实现安全的数据存储和加密数据检索.数据加密后会失去原始数据本身所具有的一些特性[1-2],如有序性、相似性等,难以在密文数据上直接进行查询.Hacgümü等人[3]提出了DAS(DatabaseasService)服务模型,DAS模型对数据库数据按照不同粒度进行加密,检索过程中需要进行解密,由于解密操作开销很大,对实际的查询性能会造成较大影响.近年来数据隐私保护的需求越来越迫切,为了加强数据库的安全性和可信性,提高加密数据的可操作性能,国内外研究人员在这个方面做了大量研究工作.Rivest等人[4]使用同态加密函数加密数据,实现加密数据的直接算术运算.这种方法可以实现加密数据的算术比较,但是同态加密方法本身在安全性上有一定的隐患,而且目前构建一个可行的同态加密函数仍然非常困难.2009年IBM研究员Gentry[5]宣布找到了一种全同态加密算法,但其仍然存在诸多的应用限制.IBM研究中心的Agrawal等人[6]提出了一种保持有序的加密方法OPES(OrderPreservingEncryp-tionScheme),但密文保持有序性都具有一定安全隐患.另一类方法主要是对加密方法本身进行改造,使之适应加密安全数据库的应用环境,包括Ge等人[7]提出了一种轻量级的数据库数据加密机制FCE,Bouganim等人[8]采取智能卡技术快速实现加密数据的查询.还有一类方法主要利用过滤和索引技术来缩小解密范围,以提高加密数据库的检索效率.Hacgümü等人[9]基于提出的DAS模型给出了一种使用过滤技术缩小解密范围,从而提高加密数据检索效率的方法.这种方法返回一个比正确结果集合更大一些的集合,其中可能包含一些并不匹配查询条件的密文元组,因此需要再对这个结果集合进行解密和过滤处理.之后Hacgümü等人[10]又深入研究了采用这种方法后实现加密数据的聚集操作,文献[11]依据数据库数据分布实现最优化桶划分以减小解密代价.文献[12]在研究查询分布、查询类型对密文数据查询影响的基础上,提出了一种自适应密文分桶更新策略,针对密文数据库中数据动态更新和非均匀查询分布进行优化.目前加密数据库主要研究加密数据的检索方法和在不可信应用环境下如何保证数据库数据的安全性,并没有解决检索过程的安全性和基于密文的数据全文检索.以上研究主要研究解决加密数值型数据的安全检索问题,与数值型数据的比较查询不同,字符型数据需要处理的大量是匹配查询,而且近年来随着云Page3计算的兴起,外包数据服务成为一种趋势,为解决外包服务环境下的隐私数据安全,近年国内外很多研究学者开始研究云计算环境下的密文数据查询方法,云环境下密文数据查询研究重点关注字符型加密数据的安全查询问题.目前密文字符型数据检索主要是通过对字符数据建立安全索引,从而实施快速查询.哈佛大学的Chang等人[13]提出了一种解决在远程服务器上检索加密数据的方法,但是这种方案基于词频的查询会极大地导致服务器端开销,同时也没有解决删除操作带来的安全更新问题.Boneh等人[14]基于非对称加密提出了一种公钥加密的关键词搜索方法PEKS(PubicEncryptionwithKeywordSearch),但是PEKS需要查询对象和查询关键词逐个比对,不适合于大数据量的加密文本检索.斯坦福大学的Goh[15]提出了一种加密文本搜索方法,但其使用的Bloom过滤器会导致错误结果的产生,因为它们会潜在地使远程用户下载一些不包含查询关键词的额外文件.加利福利亚大学的Song等人[16]采取了序列加密(streamcipher)方法对文本数据进行加密处理,这样无需解密就可以直接对加密文本搜索关键词.但是其方法有一些问题:第一,它与当前已有的一些文件加密方案不兼容;第二,它在针对加密数据的统计分析攻击下并不安全.尽管提出了一些有启发性的补救方法,但是其安全性证据在理论上是不够健壮的.Curtmola等人[17]利用加密Hash表存储关键词和密文文件标识的映射关系实现密文数据查询.2010年Li等人[18]基于关键词编辑距离,研究了云计算环境下的加密字符型数据的模糊匹配查询,但是其需要语义库的支持.黄汝维等人[19]基于关键词字符串向量的欧几里德距离实现隐私数据的模糊查询.除上述研究外,近年还出现了密文检索结果排序、授权访问、安全分析等相关研究,Wang等人[20]基于文本词频研究云计算环境下密文数据查询的结果集排序.但这种方法仅支持单关键词的排序查询.2011年Cao等人[21]在安全kNN密文查询方法的基础上,基于向量内积相似度研究了多关键词的隐私保护排序查询,但由于需要存储关键词词典而给客户端造成较大负担.Wang等人[22]基于ABE(Attribute-BasedEncryption)加密研究了云存储数据访问授权方法.Li等人[23]针对传统密文检索过程的粗粒度授权问题,提出了一种支持密文查询的细粒度授权与撤销机制.现有相关研究主要关注了密文数据的查询方法以及提高密文查询效率,但现有研究在查询功能上还不能满足海量文本数据的高效全文检索服务要求.随着网络和信息技术的飞速发展,数据的安全性和私密性越来越受到重视,但是目前加密信息的全文检索仍然没有得到解决,主要问题是没有解决加密策略和全文检索技术结合的问题.本文提出了Mimir:一种基于B+树的密文全文索引结构和相应的归档、检索策略,在具有较高安全性的同时,也保证具有很好的全文检索服务性能.3Mimir密文全文检索系统3.1传统全文索引结构及其安全性问题实现密文全文检索一个很自然的思路是对目前流行的全文索引进行加密,以实现密文全文检索.按照加密粒度的不同,可以将加密分为两个层次:索引级(IndexLevel)和索引词级(TokenLevel)的信息加密.索引级的密文索引直接对明文全文索引进行加密,信息检索时需要先对密文全文索引进行解密或者部分解密,再在解密的明文全文索引基础上进行全文检索,这种方式最大的问题是检索过程中需要解密,本质上仍然是明文全文检索,存在很大的安全隐患,而且在索引的增量构建过程中加解密代价很大.基于索引词级别加密的信息检索采用原有的明文索引结构,利用一致加密算法对索引词进行加密,从而直接在密文基础上进行索引词比对而实现密文全文检索.目前各种主要的IR模型的全文索引都是基于索引词(Token)偏移地址和词频信息构建的,若这些信息也进行加密处理,由于在查询过程中需要大量的运算操作,会极大地影响全文检索系统的检索效率,若采用明文形式存放又会带来很大的安全隐患,下面详细分析明文索引词偏移地址和词频统计信息所带来的安全隐患.我们首先定义信息检索模型:定义1.一个全文信息检索系统,可以用一个四元组{D,Q,F,R(qi,dj)}来定义,其中D是信息检索系统的文档集合,Q是用户查询请求的一组逻辑视图,F是对文档进行表达、信息提取和查询的逻辑框架,R(qi,dj)是针对查询qi返回的文档结果集合dj的排序策略.基于定义1描述的信息检索系统,对索引词加密,构建密文索引的方法可以描述如下:对于信息检索系统中的某一文档di,设其在归档规则F下,映射为一组索引词集合Ti((t1,p1),(t2,p2),…,(tk,pk)),其中对于任意索引词单元(tj,pj),tj为索引词,偏移位置pj表示了索引词tj在文档Di中的相对偏移地址.获得明文索引词后,利用加密算Page4法对索引词ti进行加密,得到密文索引词集合ETi((e1,p1),(e2,p2),…,(ek,pk)),并构建密文索引EIndex,其处理过程如式(1)所示.di→FTi((t1,p1),(t2,p2),…,(tk,pk))Encryp→tETi((e1,p1),(e2,p2),…,(ek,pk))→IndexEIndex在已知明文的攻击环境下,假定攻击者知道某个文档di的明文信息,也知道全文检索的归档规则F,则攻击者很容易完成式(1)中由di→Ti的处理.由于偏移地址pj在检索过程中需要进行大量的运算操作,为了保证全文检索效率,难以进行加密.因此攻击者通过对密文索引进行分析,基于偏移地址进行对照就可以获得全部或者部分的明文索引词和密文索引词的映射关系ti→ei.因此这种密文索引构建方法具有很大的安全隐患,攻击者不需要攻击密文全文检索的加密算法和密钥本身,直接利用明文索引词和密文索引词的映射关系,就可以通过分析密文索引推导出整个检索系统的明文文档内容,从而完全破坏整个密文检索系统的安全性.索引词位置信息会给密文全文检索系统带来很大的安全风险,索引词词频信息同样也存在着严重的安全隐患.现有的全文检索系统存储索引词t的频率信息ft是排序处理的重要参考指标之一,但是这种词频信息也很容易受到统计攻击.针对一个信图1基于B+树的密文全文索引结构息检索系统的文档集合Di,攻击者可以针对现有已知文档进行词频统计分析,获得敏感词汇的统计分布规律,再分析密文索引词的频率分布,攻击者可以猜测部分敏感密文索引词对应的明文信息,并进而攻击加密算法和密钥.若对词频信息进行加密,则在排序和归档过程中也会增加大量的加、解密操作,从而极大地影响密文全文检索系统效率.综上,目前的全文检索模型(包括索引结构、归档机制、检索策略)都是基于明文状态设计的,并没有考虑检索安全性及信息私密性的要求.因此基于现有明文全文索引结构创建的密文索引难以满足安全性和检索效率的要求,有必要设计一种适应密文全文检索需要的安全可信的密文索引结构.3.2基于B+树的Mimir密文全文索引全文检索系统的文档资源都是海量的,全文索引都采用增量方式构建,因此采用一种稳定、高效的数据结构构建全文索引对于实现高效的密文全文检索是非常重要的.由于B+树当节点分裂时只影响原节点和父亲节点,因此对于全文索引的增量构建在插入索引词时可以有效地保持索引B+树的平衡性,保障全文检索效率.为了保证密文索引服务的安全性和高效性,给出了一种基于B+树密文全文索引结构如图1所示.Page5Mimir密文索引树基于密文索引词构建,对于某个待归档文档di,首先对其进行分词映射(归档策略将详细介绍),映射为一组索引词集合Ti(t1,t2,…,tk),与传统的明文全文检索系统不同,Mimir密文检索系统中并不记录每个索引词的偏移地址,而只记录归档文档出现的不同索引词.获得明文索引词后,利用加密算法对每个索引词ti进行加密,得到密文索引词集合ETi(e1,e2,…,ek),并插入到图1所示的Mimir密文索引树中,构建密文索引EncryptedIndex,Mimir的文档归档过程如式(2)所示.diET(e1,e2,…,en)→indexEncryptedIndex(2)Mimir的检索过程中没有解密操作,检索基于密文索引词的直接匹配实现.Mimir系统收到检索请求后,将检索请求转换为密文检索词的析取或者合取范式,基于Mimir密文全文索引查询到密文检索词命中的文档,再排序处理(排序算法见3.3节)返回.为了保证系统安全性,Mimir采用成熟可靠的加密算法对索引词进行加密处理.在常用的分组加密算法中,对称加密算法具有比非对称加密算法更高的加密效率,同时若针对每个Mimir用户都发布公私密钥对,针对每个密钥对将会产生非常巨大的密文索引量,因此在Mimir密文全文检索系统中,索引词的加密采用对称密钥的分组加密算法,如DES、3DES、AES等.在明文全文检索系统中,基于明文索引中的索引词位置的递增关系,检索系统可以方便地判断一个较长的检索词是否出现在某个文档中,因此在全文检索系统中,索引词的位置信息对于较长检索词的判断是非常重要的.与式(1)直接加密索引词改造明文索引的方法不同,为了保证密文索引本身的高安全性,Mimir密文全文检索系统中并没有标识每个索引词的位置信息,因此如何实现较长检索词的匹配就成为了一个关键问题.如果能够在密文全文索引中存储文档所有可能出现的检索词,则就可以不需要索引词的位置信息.但是首先不可能穷举用户可能提出所有查询关键词,而且大量地插入较长的组合索引词也会极大地增加密文索引的空间规模,而导致密文全文检索效率的下降.同时由于被查询命中的概率很小,词长太长的索引词对于全文检索的贡献也比较小.因此有必要针对Mimir系统特点设计一种不需要索引词位置信息支持的文档归档索引词提取策略,即定义1中的F部分.Mimir设计了一种限制最大归档索引词长的文档归档策略,Mimir归档索引词提取策略如算法1所示,算法1可以提取文档中所有词长不大于k的索引词.算法1.Mimir文档归档索引词构建算法.输入:待归档的文档d,最长索引词长k输出:待归档索引词集合TDocumentToToken(d)BEGIN1.T(t1,t2,…,tn)=Segment(d);//将文档d分割为2.for(inti=1;i<n;i++){3.for(intj=i;∑j4.if((ti+ti+1+…+tj)notinT)//新的索引词5.put(ti+ti+1+…+tj)intoT;//将ti到tj的6.}7.}8.ReturnT;END在全文检索系统中,中文的分词和西文的分词有较大的区别,西文单词之间有天然的分割标识,而中文分词相对来说需要结合上下文进行处理.现在部分全文检索系统的文档索引词提取方法仍然是基于单字的,在全文索引中通过地址信息判断文档中较长词的存在.基于算法1,对于一篇字数为N(Nk)的文档d采用单字划分的分词策略Segment(d)构建索引词集合,则其归档索引词T的规模可以表示为Size(T)=(N-k+1)k+(k-1)k/2≈O(Nk).因此若基于单字划分的分词策略利用算法1构建索引词,则文档的索引词规模将会非常巨大,而且采用单字划分会有很多组合索引词没有实际语义,因此有必要对归档索引词构建策略进行改进.为了控制索引词规模,提高检索效率,Mimir对算法1进行了改进.改进算法中首先利用现有的中文分词算法对文档进行分词,以减少待处理的单元,并使得所有归档关键词都有实际意义.改进算法中进一步利用停用词来控制索引词规模.所谓停用词是被认为不会被用户检索到的内容,主要包括标点、虚词、连接助词等.Mimir系统中把停用词认为是文章语义的局部中断,从而中断归档索引词的提取工作,改进算法Page6如算法2所示.算法.算法2.Mimir文档归档索引词构建改进输入:待归档的文档d,最大索引词长k,停用词列表输出:待归档索引词集合TDocumentToToken(d)BEGIN1.T(t1,t2,…,tn)=Segment(d);//利用中文分词策略2.for(inti=1;i<n;i++){3.if(tiinStopWordsList)continue;4.for(intj=i;∑j5.if(tjinStopWordsList)6.break;7.else8.if((ti+ti+1+…+tj)notinT)//新的索引词9.put(ti+ti+1+…+tj)intoT;//将ti到tj的10.}11.}12.ReturnT;END下面分析一下采用改进归档策略后的密文索引词规模.中文分词领域学者对中文语库统计分析后得到中文词长比例数据如表1所示①.可以认为中文词汇的平均字长如式(3)所示约为2.73(表1中五字以上词按词长五进行计算).对于一篇字数为N(Nk)的文档d,其经过分词处理后的分词单元总数为N/2.73,设定其中停用词比例为p,且均匀分布在文档d中,最大归档词长为k,则其归档索引词T的规模Size(T)如式(4)所示.其中N2.73×k用词时的文档索引词规模,N示考虑停用词后减少的索引词规模.由式(4)可以发现采用改进归档策略后文档索引词规模远远小于由五字词及以上算法1处理得到的索引词规模,同时两种归档算法在有意义的索引词规模上是相同的,对于检索系统的贡献也是等价的.实验4.2节中将对两种归档策略的索引词规模进行测试分析.AVG_chinesewordlength=∑k×proportionofk_lengthword=1×3.61%+2×47.74%+…+5×7.26%=2.73Size(T)=NMimir密文全文检索系统的检索流程如式(5)所示,当用户提交查询请求Q后,首先对查询请求Q进行分解,获得若干查询条件子单元的析取或合取范式q1(∧,∨)q2(∧,∨)q3,…,qn,例如用户提出的查询请求为文档内容中包括武汉大学和密文处理的所有文档,则分解得到的查询条件子单元为“武汉大学”∧“密文处理”.再利用与归档过程中相同的分词算法对每个查询子单元进行分词处理,将每个查询条件子单元解析成为分词的析取表达式.最后得到整个查询请求Q的分词析取与合取范式W(w1,w2,…,wn).再利用构建索引过程一致的加密算法对明文查询请求分词进行加密得到密文检索条件EW(ew1,ew2,…,ewn),并基于图1所示密文索引进行全文检索,得到整个检索系统中所有密文检索词命中的全部文档.最后通过排序策略对全部命中文档集进行排序处理后最终返回给用户,排序策略在3.3节中做详细介绍.Q→q1(∧,∨)q2,…,qnEncryp→tionEW(ew1,ew2,…,ewn)→SearchResults(5)3.3Mimir排序算法全文检索系统中需要处理的文档都是海量的,对于一个查询条件来说命中的文档数量也非常大,结果排序就是将用户最感兴趣的内容优先呈现给用户,对于一个全文检索系统的可用性来说是非常重要的.目前的全文检索系统中通常都采用基于检索关键词词频的评分机制,其排序评分策略通常如
