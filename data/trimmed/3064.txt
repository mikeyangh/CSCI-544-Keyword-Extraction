Page1基于净图描述的通用隐写分析技术毛家发1),2),3)林家骏4)1)(北京邮电大学网络与交换技术国家重点实验室信息安全中心北京100876)2)(北京邮电大学网络与信息攻防技术教育部重点实验室北京100876)3)(上饶师范学院数学计算机系江西上饶334001)4)(华东理工大学信息与控制学院上海200237)摘要针对互联网上大量的隐写软件利用数字图像隐藏秘密消息,文中提出了基于净图描述的通用隐写分析技术.这种隐写分析技术能有效地检测出图像是否含秘密信息,通过提取两种新颖特征,即纹理特征和虚特征值分解(IED)特征,对净图进行完整的定量描述,又经过降维处理,解决了维数灾难问题,提高了检测速度;并且设计了与特征相匹配的柔性化超椭球体一类分类器,提高了检测性能.关键词净图描述;隐写分析;隐写术;纹理特征;IED特征;一类分类器.1引言信息的安全问题日显重要.信息隐藏技术作为信息安全领域的一种新兴技术也随之得到了前所未有的重视和发展.隐写术和隐写分析是信息隐藏技术的随着计算机技术和网络技术的飞速发展,网络两个重要分支.前者通过隐藏通信的存在来获得掩Page2密通信的安全;后者是对隐写术的攻击.隐写分析技术一方面促进了信息隐藏技术的提高,另一方面在监控不法分子利用网络传递有害信息、协调犯罪活动以及维护国家安全行动中起着至关重要的作用.传统的隐写分析技术主要分两类:专用隐写分析技术和通用隐写分析技术.文献[1-2]都是属于专用隐写分析技术,刘文芬等[1]提出了基于污染数据分析实现LSB秘密消息的检测,不仅可以快速有效地检测出图像中的秘密消息的存在,同时可以精确地估计出连续有随机间隔嵌入算法秘密消息的长度;Gul等[2]提出了基于JPEG图像扰动量化(PQ)隐写分析方法,能够较有效地检测出用PQ嵌入的秘密信息.但他们的方法针对性很强,一种是针对LSB隐写术,另一种是针对PQ隐写术,对其它隐写方法,他们的方法就不再有这么好的效果.文献[3-4]是属于通用隐写分析技术,也叫盲检测技术,Lie等[3]认为在空域图像里,掩密图像梯度能量大于等于干净图像的梯度能量;同时,他们认为图像DCT系数中的AC系数是服从Lapalacian分布的,且掩密图像Lapalacian分布模型参数的均值与方差都比干净图像的均值与方差小,并且利用神经网络分类器来实现掩密图像盲检测,取得了一定的分类成效.但是,图像的AC系数Lapalacian分布模型是个有争议的模型,事实上绝大多数图像的AC系数并非服从Lapalacian分布模型.因此,用这种特征来进行隐写分析,性能不会太好;文献[4]和文献[5]都提出了基于共生矩阵(EM)统计分析的盲隐写分析技术,通过EM投影直方图多级度量,产生高维特征向量,利用支持向量机(SVM)进行训练和分类,取得一定的检测效果;Avcibas等[6]提出任何图像质量经平滑或低通滤波后都会退化,这种退化量与图像是否含有秘密信息有一定的关联关系.因此,他们利用回归分析来度量图像质量的退化量进行隐写分析;Wang等[7]提出了一种基于监督学习的隐写分析方法,通过三级小波分解,用每个子带的PDF作为隐写分析特征,取得了较好的检测性能.以上几种隐写分析技术,都具有一定的检测性能.但是,不管是专用隐写分析技术,还是通用隐写分析技术,它们都是基于二类分类来实现的,也就是在训练时不光要训练干净图像,而且还要训练掩密图像.对于基于二类分类器的隐写分析技术,其存在一个重大缺陷:训练样本均来自原始图像和含秘图像,如果有新的隐写算法出现,以前设计好的分类器将无用武之地,因为没有对这种隐写算法生成的掩密图像样本进行训练.针对以上不足,本文提出了基于净图描述的通用隐写分析技术.基于净图描述的通用隐写分析方法能有效地检测出图像是否含秘密信息,通过提取两种新颖特征,即纹理特征和IED特征共50个特征值对净图进行完整描述,又经过降维处理,解决了维数灾难问题,提高了检测速度;设计了与特征相匹配的柔性化超椭球体一类分类器,提高了检测性能.2基于纹理特征的净图描述自然场景图像的许多部分在一大的区域内都没有尖锐的边缘.在这些区域中,场景可以表征为一些一致的结构,这些结构类似于布匹的纹理.一些作者试图定性地描绘纹理.Pickett[8]提出“纹理可以用来描绘二维数组变量.在特征的重复性保留的情况下,间距或排列的要素和规则可以任意布置.Hawkins[9]给出了一个更为详细的纹理描述:“纹理的概念依赖于3个部分:(1)一些局部‘样式’在一个区域内重复出现,该区域的尺寸大于样式的尺寸,(2)该样式的要点是基本部分非随机布置,(3)这些部分是一些大致上均匀的物体,这些物体在纹理区域内的任何地方都有近似相同的尺寸”.虽然这些纹理的描述在感觉上比较合理,但是这些方法却不能直接用于简单地定量描述纹理,因为一些纹理不连续性的描述需要根据纹理的位置、倾斜角度和高度来对纹理定量描述.2.1二维直方图特征如果一个图像区域中包含有细密的纹理,那么像素对的二维直方图将趋向于均匀一致,而对于粗糙的纹理,直方图的值将沿直方图的对角线倾斜.本文采用二维直方图作为图像纹理的统计特性表征.二维直方图是以一对像素的联合概率分布的定义为基础的.假设给定一幅具有灰度级为N的图像I,则图像二维直方图可表示为Mr,θ(a,b)=PI(j,k)=a,I(m,n)=b式(1)中a和b是图像的像素点的灰度值,两个像素I(j,k)和I(m,n),这两个像素之间的距离是r且两点之间的连线与水平方向的夹角为θ.二维直方图可以看成是一N×N矩阵,这样的矩阵称为灰度从属矩阵或叫共生矩阵.如果图像中的像素对高度Page3相关,则Mr,(a,b)中的元素将集中在矩阵的主对角线上.图1是一样本图像,图2是该样本图像的二维直方图M1,0的非零值分布散列图,从图2可以看出,二维直方图高度集中在矩阵的主对角线a=b上.二维分布的直方图估计式为式(2)中M为图像的所有像素的数量,N(a,b)表示I(j,k)=a和I(m,n)=b出现的次数.作为一幅图像的离散直线表示的结果,参数(r,θ)仅可以取为特定的离散值,如(1,0)、(1,π/4)、(1,π/2)和(1,3π/4).2.2纹理特征度量指标Haralick等[10]曾提出了许多对于纹理度量的分布指示器,如自相关、协方差、惯性距、能量和熵等指示器.对于给定的点距集(r,θ),细密纹理的直方图较粗糙纹理的直方图更均匀地分布.纹理的粗糙度可以根据直方图占用单元沿直方图的主对角线的相对分散范围来度量.因此,本文采用惯性距作为图像纹理度量指标.惯性距计算公式如下:如果所感兴趣的纹理区域具有角度不变性,那么就可以在单个度量的度量角度上求得平均来得到平均纹理度量式[8]:式中求和是整个角度和尺度度量区域的,Nθ表示这种度量角度的数量.类似的,一个角度独立纹理变量可以定义为2.3基于纹理特征的净图定量描述图像特征是指图像显著的基本特征或特性.一些图像特征是其本质的特征,在一定程度上这样的特征可以从视觉上分辨出来,另一些则是通过某些变换产生的人为特征.本质特征包括像素区域和灰度纹理区域的亮度.图像像素直方图是属于图像的人为特征,其对于净图纹理特征定量描述技术是很重要的.为了对净图的定量描述,本文选取18个特征构成一个18-D特征向量,用来对净图进行定量描述.其中有12个S(r,θ),它们为{S(r,θ)|r=1,2,3,θ=0,π/2,π/4,3π/4},还有3个E(r),即{E(r)|r=1,2,3},3个V(r),其r取值与E(r)的r取值相同.就图像而言,其相邻行或列像素之间的相关性是很强,随着像素点的距离拉大,其相关性逐渐减弱.由2.1节二维直方图的定义可知,相关性越强,其散列图的点就越集中在主对角线上,那么惯性距就会越小.表1是样本图像的纹理18个特征,固定一个θ,有S(r1,θ)<S(r2,θ)和E(r=1)<E(r=2)<E(r=3)成立,这正与以上分析相吻合的,也就是说实验与理论分析相一致.表1基于纹理特征的样本图像定量描述特征向量值特征名特征值特征名特征值特征名特征值S(1,0)29.777S(2,0)67.146S(3,0)96.455S(1,π/2)59.259S(2,π/2)132.890S(3,π/2)203.090S(1,π/4)76.211S(2,π/4)151.490S(3,π/4)220.540S(1,3π/4)83.863S(2,3π/4)173.310S(3,3π/4)247.860E(r=1)62.277E(r=2)131.21E(r=3)191.99V(r=1)10.769V(r=2)18.584V(r=3)27.4172.4掩密图与净图的纹理特征比较为了研究净图经隐写工具嵌入秘密信息后其纹理特征是否发生变化,本文选取了500幅彩色图像(JPEG图像和BMP图像各250幅)干净图像,并将这些图像嵌入0.3bpp秘密信息,得到500幅掩密图像.由于彩色图像是三维图像,本文先对求每维空间的18个纹理特征,然后相应地求其平均值,这样每幅图像还是18个纹理特征.我们发现,掩密图像与净图的每个纹理特征有Page4一定的差别,但差别相当微弱.对于图3的样本,图4是500幅掩密图与净图的3个特征(E(r=1)、E(r=2)和E(r=3))差三维空间图.图5净图特征S(1,0)及相应的掩密图与净图特征差构成的二维空间图,由图4和图5可以看出,绝大部分的掩密图像的纹理特征比净图的纹理特征大,并且有这种规律,即对于那些净图纹理特征小的图像,经嵌入信息后,其纹理特征值增幅很大,而净图纹理特征大的图像,经嵌入信息后其纹理特征增幅很小.但它们差值一般都在10以内.对于特征值都在几十以上的数值而讲,这些差别不是很大.也就是说,单靠一个或几个纹理特征将净图和掩密图分开,几乎不太可能.因此,为了更好地描述净图,能够很好地将掩密图分开,本文增加了基于虚特征分解的特征进一步对净图进行描述.图3样本图像二维直方图M1,0概率分布图3基于虚特征分解的净图描述3.1虚特征分解IED(ImaginaryEigenvalueDecomposition)在线性代数里,特征值分解是一种及其重要的工具.在线性代数里,对于矩阵犃∈Rn×n,犃能与实对角形矩阵相似的充要条件是犃有n个线性无关的特征向量,对于这个条件在图像矩阵里是不可能达到的,因为图像相邻行或列的像素值很相近,也就是说其相邻行或列的相关度很高.因此,为了能将图像矩阵能够进行特征分解,我们将图像矩阵延拓至虚空间.设图像犐∈Cm×n,犛W是图像犐的W×W的子块,我们简称其为子空间,V是犛W的实秩空间,V⊥是犛W的虚秩空间,即V=span{αk∈R1×W|犛Wαk=λkαk≠狅,λk∈R,V⊥=span{αk∈C1×W|犛Wαk=狅或犛Wαk=λkαk,其中“狅”表示零向量,λk为图像子空间犛W的特征根,R表示实数,C表示虚部不为零的复数.r<W,r是犛W的实秩,{α1,α2,…,αW}是个正交集,{α1,α2,…,αr}是对应犛W非零实特征值的正交特征向量的集合.令矩阵犙=(α1,…,αr),珚犙=(αr+1,…,αW),因为犚W=VV⊥,每个图像子块犛W∈犚W都有一个唯一的分解形式:其中,犛V=犘犛W=犙犙T犛W∈V,犛V⊥=珚犘犛W=珚犙珚犙T犛W∈V⊥,犘和珚犘分别是V和V⊥上的正交投影算子.在这里我们称V和V⊥分别为实特征子空间和虚特征子空间.若实特征子空间的维数为r,则虚特征子空间的维数为W-r.同时,矩阵线性相关的行数或列数是由特征根为零或虚数的个数是相等的.因为实特征根的个数(重根按重数计)与实特征子空间的维数相同,都为r,零和虚特征根的个数就为W-r,虚特征子空间的维数也为W-r,而虚特征子空间的维数就是反应矩阵的行或列线性相关性,因此说矩阵线性相关的行数或列数是由特征值为零和虚数的个数是相等的.3.2基于IED的特征度量指标为了获得净图基于虚特征分解的特征度量指Page5标,本文首先将图像被分解成大小为W×W的子块犛W,并对每一子块进行虚特征分解.定义如下隐写分析特征:度量指标1.F1(W)=18,12,…,32,i=1,2,…,W,δ为脉冲函数,即为δ(k)=1,k∈{0∪C|imag(k)≠0}解成具有50%重叠、大小为W×W的子块总数.度量指标2.F2(W)=112,…,32和i=1,2,…,W,Nr表示实实特征值个数.表2基于IED的样本图像定量描述特征向量值特征名特征值特征名特征值特征名特征值特征名特征值F1(4)3.3563F1(12)9.7379F1(20)16.178F1(28)23.32F2(4)854.63F2(12)1443.4F2(20)2288.6F2(28)3436.4F3(4)0.9562F3(12)1.8119F3(20)2.5198F3(28)2.9082F4(4)2065F4(12)4763.6F4(20)8920.8F4(28)14689F1(8)6.3623F1(16)11.81F1(24)19.458F1(32)25.32F2(8)1355.9F2(16)4130.6F2(24)4923.9F2(32)9980.7F3(8)1.4947F3(16)2.0305F3(24)2.9717F3(32)2.6923F4(8)2186.3F4(16)7508F4(24)13555F4(32)24959从基于IED特征的第1类度量定义来看,F1(W)/W是图像行或列相关性的一种反应,而F3(W)/W是相关性偏差的反应.如表中F1(4)/4=0.839075表示该样本图像按4×4来分,那么它子块平均相关度为0.839075;又从第2类度量来看,F2(W)/W是图像单个像素的平均能量的一种反应,而F4(W)/W是能量偏差的反应.这样,本文从别一个方面描述了图像的相关性及图像能量特征,因为图像经嵌入秘密信息后,其相关性和图像能量必然改变,所以这些特征来进行净图的定量描述及下一步的隐写分析工作是合适的.3.4掩密图与净图的IED特征比较设干净图像零和虚特征值的个数为Nco,掩密图像零和虚特征值的个数为Nst.由文献[3]知,干净图像的梯度能量小于等于掩密图像的梯度能量,也就是说干净图像矩阵的行或列的相关性不会比含秘图像矩阵的行或列相关性弱.即当图像矩阵嵌入秘密信息后,其行或列线性相关性在一定程度上会被削减.实特征子空间的维数将增加,虚特征子空间的维数减少.那么,零或虚特征根的个数就减少.那么,在通常情况下,有成立.征的方差作为特征3.度量指标3.F3(W)=Var(F1(W)),即1类特度量指标4.F4(W)=Var(F2(W)),即2类特征的方差作为特征4.3.3基于IED特征的净图定量描述3.2节已经给出了基于IED的4类度量指标,本文从每类度量指标中选取8个度量值作为对净图IED特性描述,即每类中的W=4,8,12,…,32.这样4类总共有32个特征值,也就是说,每张净图将被提取32个基于IED的特征值.这32个特征值构成32维特征向量,用来对净图进行定量描述.表2是图1中的样本图像32维特征值.本节实验数据与2.4节的实验数据一样,图6是对每幅图像分解成大小为16×16、重叠率为50%图像子块,平均每一个子块零和虚特征值个数的统计结果.图6的连续线是干净图像零和虚特征值的平均个数,间断线是含秘图像的零和虚特征值的平均个数,由图可以清楚地看出,NcoNst成立.定义1.设矩阵的特征值为λ,则我们称λHλ为矩阵的特征值能量,这里λH为特征值λ共轭虚数,如果λ为实数,那么特征值能量就是λ2.假设干净图像矩阵为犐co,嵌入秘密信息犚后得到的掩密图像犐st,即犐st=犐co+犚.在大多数文献Page6中[3,6-7],把犚看作是一个均值为零的高斯模型(E(犚)=0),且原始图像信息与秘密信息是相互统计独立的,所以就E(犐2st)=E(犐2co)+2E(犐co)E(犚)+E(犚2)=E(犐2co)+E(犚2).也就是说在假设嵌入信息为均值为零的高斯模型的条件下,掩密图像的能量等于干净图像能量与秘密信息能量之和.特征值分解是一种能量不变的线性变换,设干净图像实特征值平均能量为Eco,掩密图像实特征值平均能量为Est,则有图7是实特征值平均能量的比较,其中连续线是干净图像实特征值平均能量,间断线是含秘图像实特征值平均能量,连续线始终在间断线下方.因此,实验结果说明了式(10)的成立.4基于净图描述的一类分类器设计隐写分析技术主要包括两个步骤,第1步是特征提取,第2步是分类器的设计.有好的特征而没有好的分类器,那么其分类效果将大打折扣.当然,世界上不存在万能分类器.因此,根据特征自身特点,设计与其相适应的分类器是至关重要的一步.本文根据特征的自身特点,采用基于净图描述的一类分类器作为隐写分析的分类器.4.1一类分类器原理图像隐写分析技术可以大致分为两种方式[11],一种是针对某种具体的嵌入方法提取其专用特征,根据这些专有特征进行判别可称为专用隐写分析技术;另一种是寻找独立于具体的嵌入算法之外的特征,根据这些特征进行判别,可称为通用隐写分析技术.但不管专用还是通用隐写分析技术,它们绝大多数采用二类分类器进行分类判别,即训练样本来自原始图像和掩密图像.对于基于二类分类器的隐写分析技术,其存在一个重大缺陷:训练样本均来自原始图像和含秘图像,如果有新的隐写算法出现,以前设计好的分类器将无用武之地,因为没有对这种隐写算法生成的掩秘图像进行训练.用基于净图描述的一类分类器[12]可以有效地解决上述缺陷.一类分类器只需训练一类样本,这类样本可以从原始图像中提取,它生成的分类边界是一闭合的超椭球体.在检测时如有样本点在超椭球体的外面,则认为这些样本点来自于掩密图像.4.2一类分类器的柔性化设计一类分类器对一类训练样本进行数据描述,用该描述来判断新的对象是否与训练样本同类.与传统分类器不同,一类分类器仅有一类样本可以利用,这类样本对象统称为目标对象,而所有其它对象统称为异常对象.传统分类器遇到的问题,如误差定义、维数灾难、方法的推广性、运算复杂性度量等,也同样存在于一类分类器中,其中某些问题变得更难解决.因为在传统的分类器中,至少有两类数据可以应用,决策边界由两类数据来支持,大多数传统分类器都假设两类样本数据基本平衡,当某一类数据严重缺乏时,分类效果将变差.而对于一类分类器,仅有一类数据可以利用,决策边界仅由一类数据确定,很难发现围绕数据各个方向都适合的边界,也很难决定哪些特征可以最好地区别目标类和异常类.为了合理地解决好这些问题,首先必须对高维特征向量进行降维.假设(f1,f2,…,fN)为表征图像的N维特征向量,将其分解成M个不同属性的特征向量子集,假设第i个特征子集中有qi(i=1,2,…,M)个特征,那么其分解式如下:{(f1,f2,…,fN)}={(f11,f12,…,f1q1),(f21,f22,…,f2q2),…,其中q1+q2+…+qM=N.将每个特征子集采用线性回归方法进行降维,降维公式如下:(fM1,fM2,…,fMqM)}通过式(12)将每个特征子集降至一个特征值,这样就将高维(N维)特征向量降至低维(M维)特征向量.确定式(12)中的权重参数αk是一项很重要的工作.通过2.4节和3.4节中净图与掩密图的特征比较,根据图像经嵌入信息后特征值的变化大小来确定权重参数,也就是取一组权重参数,使得Page7max(|Fcovi-Fstegi|)成立,这是的Fcovi和Fstegi分别表示净图和掩密图的特征.如果权重参数取得合理,那么后面的分类检测效果就会得到显著提高.在本文的实验中,根据特征类型相近似性,通过式(11)和(12)将50维特征向量降至7维特征向量.其中纹理特征按r的取值不同,由原来的18维降至3维,分别是r=1、r=2和r=3(求解权重参数方法为:如在r=1的情况,干净图像与掩密图像相对应的6个特征(按表1出现的顺序),其平均差值分别为3.812,3.050,1.450,0.502,2.950,4.12.根据max(|Fcovi-Fstegi|)原则,差值越大,权重参数就越大,所以相应的权重参数分别取0.2382,0.1590,0.0909,0.0267,0.1850,0.2602.其它情况同理可求);而IED特征根据特征类型划分,由原来32维降至4维,分别是F1、F2、F3和F4.通过以上降维方法,不仅解决了维数灾难问题,而且还提高了分类的速度.基于净图描述的一类分类器是由一个超椭球体构成,决定一个超椭球体,主要有两个要素,(1)球心;(2)每轴方向的轴半径.这两个要素可以通过对大规模的样本数据进行训练、统计及数据分析的办法来得到解决.假设第i维特征的均值为ai,标准差为σi,取ri=2σi那么,超椭球体的一类分类器就可以表示为式中的δi为柔性化因子,用来调节轴半径的.通过调节柔性化因子控制阳性检测率与虚警率.如当柔性化因子增大,那么阳性检测率将降低,而虚警率将增大.它是实践中根据需要而定的,其取值范围一般为-σi/20δiσi/20.在本文实验中,抽取4000幅净图作为训练样本,其中JPEG和BMP各2000幅,对每幅图像进行特征提取、降维,然后计算出各维特征的均值,这样7个特征均值构成7维特征空间中的一个特征点,作为我们一类分类器超椭球体的中心;同时将相应的标准差分别作为超椭球体的轴半径,柔性化因子根据需要而定.这样,我们的一类分类器就设计完毕.5实验结果5.1测试数据的准备对于评估一个盲隐写分析算法的好坏,实验设计是一个很重要的环节.实验设计的关键包括以下几点:(1)通用性.图像特征的提取和与之相适应的分类器能够鉴别出测试图像是否为掩密图像,不管这秘密信息是用哪种隐写算法嵌入的.(2)性能好.一方面,对掩密图像来说,要具有高阳性检测率PD(PositiveDetection)和低漏警率FN(FalseNegative);另一方面,对干净图像应保持较高的阴性检测率ND(NegativeDetection)和较低的虚警率FP(FalsePositive).(3)鲁棒性.分类器能够把经图像处理过的干净图像(如平滑、锐化、缩放、再压缩和剪切等)与掩密图像区分开.基于以上考虑,我们的实验数据由两个部分组成,即净图部分和掩密部分.净图7000幅,这些净图包括频繁在文献中出现的经典图像(如Lenna、Cameraman等)、自已拍摄的图像、计算机生成图像(如经Matlab、Photoshop、ACD等图像处理软件处理过的图像),且这些图像既包含了亮彩色图像、暗彩色图像、纹理和细节细密图像、直线和边缘丰富的图像和具有平滑区域的图像及具有其它特点的图像;有山、水、人物、动物、和植物等彩色图像.这样建立的数据模型具有普遍性和合理性.实验图像用于训练一类分类器的净图4000幅,用于测试的3000幅(原始JPEG图像和BMP图像各1000幅,经平滑、锐化、缩放、再压缩、剪切处理后的图像1000幅).对于目前来讲,根据数据嵌入的领域来分,隐写术可以分为3种方式:扩频SS(SpreadSpectrum)、最低有效比特位LSB(LeastSignificantBit)和量化调制QIM(QuantizationIndexModulation)3种隐写方式.因此,本文选用典型的6种隐写术,对原始图像进行嵌入秘密信息来得到实验所需的掩密图像,这6种隐写术是Cox等的non-blindSS[13](#1)众所周之,如果隐写分析算法是基于统计特征的,那么一幅图像嵌入秘密信息量越多,就越容易检测出,相反,嵌入秘密信息越少则就与原始图像越难分开.因此,嵌入率问题也是制约着正确分类率的一个重要因素.所谓嵌入率(ER),就是嵌入的比特位与图像的像素量或DCT系数量的比值,例如当秘密信息是1k字节嵌入空域图像时,如其像素量为Page850k,则嵌入率ER=(1×8)/50=0.16bpp(bitperpixel);当8比特位秘密信息嵌入到一8×8大小的DCT块时,则嵌入率ER=0.125bpc(bitpercoeffi-cient).我们用6种隐写方法对干净图像进行秘密信息的嵌入,每种方法有4种不同的嵌入量.详细见表3.方法#1、#2、#5、#6对1000幅JPEG干净图像嵌入秘密信息各得4×1000幅掩密图像,用#3和#4对4×1000BMP干净图像嵌入秘密信息各得1000幅掩密图像,这样共有24000幅掩密图像供测试用.表3掩密图像的嵌入率及干净图像、掩密图像的测试结果ER/bpc(ER/bpp)PD/%ER/bpp#1#2#3干净图像类型ND/%ND总平均原始图像平滑锐化缩放再压缩剪切5.2测试结果本实验的实验对象是彩色图像,彩色图像具有3个空间,即R空间、G空间和B空间,每个空间用两种方式进行特征提取,每个空间提取50个特征.首先,把它们输入到降维处理器进行降维,则每个空间得7个特征,然后把它们输入到一类分类器进行训练,也就是确定球心与轴半径,柔性化因子δi暂时取为零.通过4000幅净图的训练,设计出不同空间(RGB3个空间)的基于超椭球体的一类分类器.当对一幅待测图像进行测试判别时,其流程见图8.图中的选举法分类器是指当待测图像通过3个空间分类器时,有两个空间或两个以上空间分类器判为掩密(或干净),那么最终结果就判为掩密(或干净)图像.本实验对9000幅彩色图像(其中干净图像2000幅,经平滑、锐化、缩小、剪切(只做空域)、再压缩(只对JPEG图像)共1000幅,24000幅经以上6种隐写方法嵌过的掩密图像)进行测试,测试结果见表3.5.3性能分析与比较隐写方法#1、#2、#5和#6都是将秘密信息嵌入在DCT域里的,隐写方法#3和#4是将秘密信息嵌入在空域里的,由表3可以看出,它们的阳性检测率(PD)随着嵌入率的增加而呈递增的,也就是说其嵌入率也是与PD成正比关系的.但这规律不是绝对的,如对隐写方法#2的检测,嵌入率0.30bpc的检测率比0.33bpc的高;本文提出的检测方法对不同隐写方法的敏感度也是不一样的,如对隐写方法#2不敏感,嵌入率从0.08增加到0.33时,检测率始终在75.5%左右,而对隐写方法#4却很敏感,其嵌入率的变化幅度比#2小,但检测率却变化很大,相差了将近30个百分点.那些经图像处理工具处理过的图像,不同的处理,其对阴性检测率的影响是不一样的,有些操作影响很大,而有些操作却影响不大.如当图像经过锐化和再压缩处理后,它们就会很容易被错判为掩密图像,因为它们的误判率很高,这是由于经这两种方式处理后,图像像素之间的相关性减弱了;而图像剪切操作,对我们系统的检测影响不大,因为图像剪切并没有改变像素之间的相关关系;对图像进行平滑处理,它的检测率比原始干净图像的检测率还要高,这是平滑处理后,像素间的相关关系增强了的原因.为了比较本文的方法与早期提出的检测方法[3-4,19-22]检测性能,我们根据这些方法进行了相同的模拟实验,表4列出了文献[3-4,19-22]的具体方法.为了公平起见,实验数据采用本文以上图像,性能比较见图9.Page9表4早期文献的特征及其分类器检测方法文献[19]文献[20]文献[21]文献[22]图9中,横坐标是嵌入率(不同的方法采取的单位不同),纵坐标是阳性检测率,在横坐标中,嵌入率为零的表示对干净图像的检测,干净图像的阳性检测率就是虚警率,本文方法的虚警率为最低,仅为18.2%,文献[24]最高,高达46%.在对嵌入率为0.08bpp和0.21bpc的掩密图像检测,本文与文献[4]的检测率差不多(本文的为分别69.15%和72.8%,文献[4]为68.5%和72.9%),而在其它情况下,本文的检测性能都明显更优.同时,从图9可以看出,这些方法都具有一个共同的特性:随着嵌入率的增加,检测率也都呈现出增加的趋势.但是其它算法在训练时都要训练二类样本(掩密图像样本和干净图像样本),即采用二类分类器.那么一旦出现新的隐写方法,那么这些隐写分析系统将会无能为力.而本文提出的基于净图描述的、只训练净图样本的、超椭球体一类分类器的隐写分析方法,抛开了具体的隐写算法,也就是说不管是以前出现的嵌入方式,还是将来新研究出来的嵌入方式,对本文系统都不会有太多的影响.因此,本文提出的系统具有更好的稳健性.6总结与进一步工作在这篇文章里,提出了基于净图描述的通用隐写分析方法能有效地检测出图像是否含秘密信息,通过两种特征,即纹理特征和IED特征共50个特征值对净图进行完整描述,又经过降维处理,解决了维数灾难问题,提高了检测速度;并且设计了与特征相匹配的柔性化超椭球体一类分类器,提高了检测性能.通过对几千幅净图和掩密图像的检测测试及与早期文献提出的方法比较,可以把我们的方法归纳为以下几点:(1)由于我们只对净图的描述,不考虑其它具体的隐写算法,因此我们的方法比其它隐写分析方法更具稳健性.(2)由于我们可以通过调节柔性化因子来协调阳性检测率与虚警率这对矛盾,因此我们的方法比其它隐写分析方法更具柔性化.(3)由表3可以看出,检测性能不仅与隐写方法有关,而且与嵌入率也相关.嵌入率高更容易检测,嵌入率低更难检测;不同的隐写方式检测率也不一样.(4)我们的训练与图像库收集了大量的干净图像和掩图像作为样本,并且用不同的隐写方式(6种)、不同嵌入率(0.08~0.33bpp/bpc)和不同的图像处理(平滑、锐化、缩小、剪切和再压缩),这种多方位性使我们的系统更接近现实应用.从实验的效果来看,大多数掩密图像和干净图像的检测效果都较好.但是,还是有很大的提高空间.特别是经锐化和再压缩处理过的图像,检测效果很不理想,虚警率过高,这也是我们以后需要解决的问题.因此,在进一步工作中,我们将主要解决以下两点:(1)寻找更好更优的特征,既能够对原始净图充分地描述,也能对经处理过的干净图像充分描述;(2)增强柔性化因子的研究,根据每个轴方向的特点,找到每个方向上的最佳柔性化因子,从而提高检测性能.
