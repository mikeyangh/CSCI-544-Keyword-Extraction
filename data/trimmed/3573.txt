Page1无线传感器网络中一种抗无线局域网干扰的信道分配机制张招亮1),2)陈海明1)黄庭培1),2)崔莉1)赵泽1),2)1)(中国科学院计算技术研究所北京100190)2)(中国科学院研究生院北京100049)摘要无线传感器网络(WSN)易受到与其共享信道的无线局域网(Wifi)干扰,造成通信可靠性及吞吐量下降.当具有不同优先级的多个WSN受到Wifi干扰时,如何按优先级分配信道,并兼顾整体通信可靠性及吞吐量是一个重要问题.针对该问题,作者提出了一种抗Wifi干扰的信道分配机制EasiCAP(ChannelAllocationforwirelesssensornetworkswithPriority).该机制利用基于干扰强度和活跃比率的干扰特征模型(ExternalInterferenceModel,EIM)度量WSN中各信道的Wifi干扰;同时,采用以接收端为中心的模型(InternalInterferenceModel,IIM)度量各WSN之间的干扰.然后,各WSN根据EIM和IIM度量的结果,采用局部化贪婪信道分配算法独立、实时地选择信道,通过保持信道、切换信道及抢占信道操作实现按优先级分配信道,并尽可能降低所有网络所受干扰之和.实际测量和仿真结果表明,EasiCAP可为各WSN提供与其优先级相对应的通信可靠性和吞吐量;而且该机制下的平均通信可靠性及吞吐量也比现有方法高.此外,EasiCAP未带来过大的开销.关键词无线传感器网络;信道干扰;无线局域网;差异化的服务质量;包接收率;物联网1引言无线传感器网络(WirelessSensorNetworks,WSN)[1]应用日益广泛,已在军事、农业、交通、医疗等诸多领域产生了重要影响.近年来,随着研究的深入,许多室内应用如智能家居[2]、环境监测[3]、火灾预警[4]等已受到人们重视.目前,无线传感器网络主要基于802.15.4协议,工作在2.4GHz的ISM频段,然而室内环境中已有的大量基于802.11协议的无线局域网(简称为Wifi)设备,也使用该频段.两者采用不同的物理层技术,且Wifi的功率比WSN的功率大1~2个数据级.研究已证实[5],当Wifi网络和WSN网络部署在同一环境中,且Wifi信道与WSN信道重叠时,Wifi通信会对WSN产生较大干扰,严重影响WSN的通信可靠性.在最坏情况下,WSN的丢包率将高于90%[5].所以,近年来,如何提高WSN抗Wifi干扰能力已成为一个重要研究方向[6-9],而信道分配是其中的一个基本问题.目前,在Wifi干扰下的WSN信道分配问题上已有一些初步的研究成果[6,10-11].然而,现有研究仅局限于单个WSN的信道选择,而未考虑多个WSN与Wifi共存时的信道分配问题.随着传感器网络的应用和推广,可能在同一环境中部署多个WSN(或独立子网络[3,12]),且各个WSN对通信可靠性有不同的要求,即各个网络具有不同优先级.例如,在一个智能楼宇应用中,可能同时部署火灾预警、健康监护及环境监测等几种传感器网络.其中,火灾预警网络的可靠性要求高于健康监护网络的可靠性要求,而后者又高于环境监测网络的可靠性要求.因而,火灾预警网络的优先级高于健康监护网络的优先级,而后者又高于环境监测网络的优先级.当这些具有不同优先级的多个WSN同时受到Wifi干扰时,如何为它们分配信道以保证相应的通信可靠性是无法避免的一个重要问题.具有不同优先级的多个WSN的信道分配问题面临着以下两个挑战:(1)WSN度量Wifi干扰较为困难,这是因为Wifi和WSN物理层技术不同,两者无法直接通信;(2)通信质量较好的信道个数有限,各WSN除需要按优先级分配信道外,同时需要兼顾所有WSN的整体通信质量,允许不同WSN共享同一信道.这是因为802.15.4协议具有16个可用信道,每个信道的带宽是2MHz,信道间隔为3MHz,而每个Wifi的信道带宽为22MHz,因此,4个使用不重叠信道的WifiAP(AccessPoint)就可以将所有802.15.4的信道覆盖.实验发现,WSN与Wifi信道重叠的现象普遍存在.例如,通过侦听分析,作者所在实验室附近存在13个AP,且工作时间内通常约有近40台Wifi设备同时与这些AP通信,严重影响了所有的802.15.4信道的通信质量.在此环境中,仅有少量干扰较小的信道.因而,以独占方式分配信道只能满足少量优先级高的WSN,而会使优先级较低的WSN因所分配信道的通信质量过低而无法正常工作.更为合理的作法是允许不同的WSN共享干扰较少的信道,以兼顾WSN的整体通信质量.针对具有不同优先级的多个WSN的信道分配问题,本文提出了一种信道分配机制EasiCAP.EasiCAP首先根据外部干扰强度和活跃比率来构建外部干扰模型(EIM),并基于该模型,利用在线采集的RSSI(ReceivedSignalStrengthIndicator)值来度量WSN各信道的Wifi干扰大小.此外,EasiCAP利用以接收端为中心的内部干扰模型(IIM)来度量WSN之间的内部干扰.然后,基于EIM和IIM模型的度量结果,EasiCAP采用贪婪思想进行实时信道分配,目标是按优先级分配信道,同时尽可能降低所Page3有WSN所受的总干扰.本文的主要贡献如下:(1)通过实验分析了Wifi对WSN的干扰,并发现:可以基于RSSI计算出干扰强度和活跃比率,以此来度量Wifi干扰大小.并基于此,提出了一种度量Wifi干扰大小的外部干扰模型EIM.此外,引入以接收端为中心的内部干扰模型来评价WSN之间的干扰.(2)证明了Wifi干扰下具有不同优先级的多个WSN的信道分配问题为NP-难问题;并提出了一种局部化(基于局部信息的)贪婪信道分配算法.其思想是通过保持信道、切换信道、抢占信道等3种操作尽可能地降低WSN的总带权干扰,以达到按优先级分配信道并兼顾所有WSN的整体通信质量的目标.(3)通过实验床测试和仿真实验,验证了所提出的信道分配机制的有效性.2相关工作目前,在Wifi干扰的度量、Wifi干扰下WSN的信道分配及抗Wifi干扰机制等方面已有一些相关研究.由于WSN无法与Wifi进行通信,难以相互协作测量干扰,所以对Wifi干扰程度的度量不同于传统WSN内部的干扰度量[13].Shin等人[14]建立了802.15.4在IEEE802.11b干扰下的包接收率的理论公式,但要求获得Wifi的包长和到达时间等参数,实际应用较为困难.Musaloiu-E等人[10]提出了一种通过计算高于某阈值的RSSI读数个数来评价Wifi干扰的方法,但未考虑Wifi的信号强度.Yi等人[6]通过控制WSN与Wifi之间的距离和频率间隔来降低WSN所受干扰,并提出了一种跳频方案以减少干扰.Musaloiu-E等人[10]提出以采集数据路径为单位实施动态跳频以降低Wifi干扰.Sha等人[11]提出了一种以期望重传次数ETX为依据、面向接收节点的跳频方案ARCH.以上研究在缓解Wifi干扰方面取得了较好的效果,但上述研究仅关注Wifi干扰下单个WSN的信道选择问题,而没有考虑在Wifi干扰下多个WSN之间如何分配信道.本文将该问题一般化,主要考虑解决具有优先级的多个WSN在Wifi干扰下的信道分配问题.这样就可将无优先级的情况视为优先级相等的情况.此外,相关研究还提出了一些采用编码和信道访问控制技术来降低Wifi干扰的方法,如动态增加冗余[7]和前向纠错码(FEC)、动态调节帧长[9]及利用忙音技术[8].这些方法可以和信道分配技术结合起来,更好地增强WSN的抗干扰能力.本文将EasiCAP与这些方法相结合的策略作为未来的研究工作.3Wifi干扰分析本节通过实验分析Wifi干扰对WSN通信质量的影响及Wifi干扰的特征.实验场景如图1所示,将一对传感收发节点和一对Wifi收发设备放置在实验室的走廊中,将Wifi的信道设置为802.11的信道11,该信道频段与802.15.4的信道21~24重叠.首先,分析Wifi设备以不同速率发送数据包时,传感节点在不同的802.15.4信道上的包接收率PRR(PacketReceptionRate).图2给出了Wifi发送设备距离传感接收节点2m,并分别以3种不同的速率发送数据包时,传感接收节点的PRR统计结果.从该图可以看出,在Wifi干扰下,不同802.15.4信道的质量可能相差很大.例如,当Wifi速率为3Mbps时,22~25信道的PRR分别为6.69%、12.03%、73.97%和97.14%.此外,Wifi速率越高,传感节点的PRR越低.调整Wifi设备与WSN节点之间的距离,所得的结果与图2类似.Page4然后,在同样的实验场景下统计分析传感发送节点所采集的RSSI值.将Wifi发送设备与传感接收节点之间的距离调整为4m,Wifi发送设备的发送速率设置为2.5Mbps,图3给出了传感发送节点在不同信道上所采集的RSSI值,这些RSSI值为滤除噪声后的均值.对比图3和图2的曲线可以发现,PRR越高,非噪声RSSI均值越低,且两种值之间具有很高的相关度.图4统计了非噪声RSSI值比率及对应PRR.从图中可以看出非噪声RSSI值比率与PRR存在很强的相关性,且PRR随着非噪声RSSI值比率的增加而降低.图4不同非噪声RSSI值比率对应的包接收率实验结果表明:(1)存在Wifi干扰的环境中,不同的802.15.4信道的通信质量可能相差很大,且传感节点的通信质量随Wifi通信量的增加而降低.因为不同的WSN对通信可靠性的要求不一样,所以,应使可靠性要求较高的WSN获得更好的信道.(2)非噪声RSSI均值和非噪声RSSI值比率与包接收率之间存在较强的相关性.因而,本文提出一种Wifi干扰模型,结合这两种值来衡量Wifi干扰的大小.4抗Wifi干扰的信道分配本节描述EasiCAP的设计与实现.EasiCAP的框架如图5所示.普通节点部分含外部干扰模型抽取和干扰检测两个模块.Sink(汇聚节点)部分含信道分配和干扰检测控制两个模块.外部干扰模型抽取模块通过测量信道以获得Wifi干扰模型,并将该模型提供给干扰检测模块.在WSN运行过程中,干扰检测控制模块在一定条件下触发并控制干扰检测模块,通过干扰检测模块获得信道当前的内部和外部干扰状态,并将这些状态信息提供给信道分配模块,信道分配模块实现信道的动态分配.4.1外部干扰模型为了评价Wifi对WSN的干扰大小,外部干扰模型抽取模块先构建EIM以度量Wifi干扰大小.包接收率PRR是评价干扰大小的有效指标,由前面的实验结果可知,包接收率PRR与非噪声RSSI均值和非噪声RSSI值比率有较强的相关性.因此,本文提出一种基于非噪声RSSI均值与非噪声RSSI值比率的干扰特征描述方法,并建立干扰特征与PRR之间的映射关系,用于评价外部干扰的大小.为便于理解,以下将非噪声RSSI均值与非噪声RSSI值比率分别定义为干扰强度和活跃比率.记犝rssi为以周期Ts采集的一组RSSI值所组成的向量.用|犝rssi|表示所采集的RSSI的个数.通过一个噪声阈值Noisethr来判断采集的RSSI值是否为噪声,即当RSSI值小于等于Noisethr时,将该值视为信道噪声.本文的实现以目前常用的TICC2420芯片为参考,取Noisethr值为-90dBm.为便于讨论,以下默认信号和噪声的强度都以dBm为单位.定义1.干扰强度.记犝large_rssi为犝rssi去除噪声后的犝rssi向量,则干扰强度为定义2.活跃比率.记犝active为0/1向量:当且仅当犝rssi(i)>Noisethr,犝active(i)=1;否则,犝active(i)=0,则活跃比率为(P,A).定义3.干扰特征.犝rssi的干扰特征为二元组EIM模型的构建及外部干扰的计算过程如下:(1)令Pmin和Pmax分别为可能出现的最小和最Page5大干扰强度,Amax为可能出现的最大活跃比率.以网格划分参数P和A的取值空间,网格在P轴方向的取值范围为[Pmin,Pmax],单元宽度为ΔP;在A轴方向的取值范围为[0,Amax],单元宽度为ΔA.让每个网格点对应一个干扰特征,并建立一个特征映射矩阵犉用于存储所有干扰特征(P,A)所对应的PRR估计值.给定特征(P,A)的一组测量值PRR1,PRR2,…,PRRs,该特征对应的PRR估计值为(2)因Wifi和WSN之间无法相互通信与协作计算PRR估计值,故需以离线方式建立特征映射矩阵犉.此外,为统一评价指标,选择一个参考接收功率Powerref,以此为基准衡量所有节点受到的外部干扰大小.为此,利用一对Wifi设备对传感节点进行离线训练,具体来讲,Wifi设备以一定的发射功率和发送速率广播数据包,以形成各种程度的干扰.选择一对传感节点,将其中一个作为主测节点,另一个作为参考节点,通过调整这两个节点之间的距离使主测节点发送的信号到达参考节点时的功率为Powerref.在一个Tm时段内,主测节点以周期Ts读取RSSI值(本文实现中取Ts=1ms);然后,在接下去的的一个Tm时段内,主测节点持续广播t个测试包,由参考节点统计出包接收率PRR的估计值并发送给主测节点.从而,主测节点可计算出一组(P,A,PRRi)值.当为各干扰特征(P,A)收集足够数量的测量值后,主测节点建立特征映射矩阵犉.稍后,将分析所需采集的PRR测量值的数目s.(3)在建立了特征映射矩阵犉之后,各节点基于犉计算出各信道的外部干扰指数.假设任意节点u在线采集的信道c的干扰特征为(P,A),定义干扰特征(Pi,Ai)和(P,A)之间的距离为d((Pi,Ai),(P,A))=P-Pi令犉中距(P,A)最近的K个干扰特征分别为(P1,A1),(P2,A2),…,(PK,AK),干扰特征(P,A)对应的干扰状态的PRR估计值为PRR(P,A)=∑K取节点u在信道c的外部干扰指数为该值为丢包率的估计值,可较好地反映信道c的Wifi干扰大小.为确保所建立的特征映射模型具有较高的准确度同时降低模型建立的代价,以下定理给出为保证PRR的估计准确度所需的最少PRR测量值数目.定理1.对于干扰特征(P,A),仅需采集个PRR样本就能以1-α的概率保证PRR的估计误差在±e范围内,其中,zα/2为N(0,1)分布的α/2上分位数,t为统计各个PRR时所涉及测试包的数目.证明.假设用测试包pkti1,pkti2,…,pktit来测量PRRi,并用标志变量xij来表示各个测试包是否发送成功,即xij=1表示pktij发送成功,则PRRi为xij(j=1,2,…,t)的统计均值,即所以,可将各个包是否发送成功xij看作独立同分布的0-1型随机变量,其中p(xij=1)=PRR.由二项分布的Wald的置信区间估计可知,s个样本的1-α置信区间为准确度要求置信区间在(1±e)PRR范围内,故可得例如,当α=0.1,e=0.05,PRR=0.5,t=50时,s的最小值为22.在实现时,先取特征(P,A)的少量PRR样本获得一个初步估计值PRR,再计算s的最小值.在一个真实WSN中,选取3对节点,每对节点之间的接收信号强度为Powerref,利用所建立的EIM模型度量Wifi干扰下的丢包率,并与LSSVM(RBF核)模型及文献[14]的理论模型(theoreticalphysicalmodel)进行比较.比较的指标是度量的绝对估计误差.图6给出了各种模型产生的绝对误差的累计分布.由图可知,特征映射模型产生的误差最小,能以约80%的概率保证绝对误差小于7%.Page64.2干扰检测本小节介绍干扰检测模块及干扰检测控制模块.它们的主要作用是在WSN运行过程中检测当前各信道的外部干扰及各WSN之间的内部干扰.对于WSN之间的内部干扰,EasiCAP借鉴文献[15]思想,但采用以接收端为中心的干扰模型(IIM).若WSNNi的节点u被邻居WSNNj干扰,则邻居WSNNj对节点u产生的内部干扰指数为Iin(u,Nj)=|{v|v∈Nj∧u∈D(v,R+v)}|,其中,D(v,R+v)是以节点v为中心,以R+v为半径的圆盘.R+v=(1+r)Rv,r>0,Rv为通信半径.这里假设当节点v发送数据包时,在R+v范围内的节点均被干扰.通常认为v的通信范围Rv为包接收率PRR达到一定值(如90%)的区域.为判断u是否在v的干扰范围内,v节点发送常量Mbeacon个Beacon包.将PRR大于等于M-beacon/Mbeacon的区域视为干扰区域,其中,M-beacon为常量.即只要u节点收到v节点发送的任意M-beacon个Beacon包,则认为节点u被节点v干扰,而整个WSN所受Nj的干扰大小定义为WSN中的节点在运行过程中将自己统计的PRR周期性地附加在数据包内,传送给Sink.当Sink检测到PRR的平均值降低某个百分比阈值PRRthr时,由干扰检测控制模块启动干扰检测.干扰检测的具体流程如下:(1)Sink向全网洪泛干扰检测启动消息,各节点(u)收到检测启动消息后,依次检测各可用信道的干扰大小.如图7所示,各信道的检测时间分为两段,在Tout内,各节点周期性采集RSSI值;在Tin内,各节点广播Mbeacon个带有网络标识及优先级的Beacon消息;其它WSN节点在收到Beacon消息后,广播Mbeacon个Beacon回应消息.Tout和Tin之间有一个保护时间.(2)检测完信道c后,首先根据采集到的RSSI值建立犝rssi向量;然后按照4.1节所述方法计算信道c的外部干扰指数Iout(u,c);接着进行下一个信道的检测.(3)当检测完所有信道后,各节点回到原工作信道,与此同时,各节点利用收到的Beacon回应消息计算各邻居WSN(Nj)相对于自己的内部干扰指数Iin(u,Nj).(4)各节点将测量结果Iout(u,c)及Iin(u,Nj)传送至Sink.Sink根据这两个结果进行信道分配.4.3信道分配假设各个WSN是静止的,可用一个干扰图G=(V,E)描述各个WSN之间的内部干扰关系.每个WSNNi对应集合V中一个结点ni,边集E中存在一条边(ni,nj)当且仅当WSNNi与WSNNj之间可能相互干扰.值得注意的是,Ni表示实际WSN,ni表示干扰图中Ni对应的结点.假设有k个可用信道,信道分配的问题可对应为每个结点ni染色的问题,但允许相邻结点染同一颜色,即允许不同WSN共享同一个信道.记结点ni的染色为ci.即为Ni分配的信道为ci.当(ni,nj)∈E且ci≠cj,即为Ni与Nj分配的信道不同,它们之间不构成干扰.图8给出多个WSN相互干扰的一个实例及对应的干扰图.首先,为了进行信道分配,Sink需要一个指标统一评价各信道的内外干扰程度.基于前两小节描述的方法,Sink可获得所在WSN的任意节点u的外部干扰Iout(u,c)和内部干扰Iin(u,Nj).Sink对任意节点u在各信道上的外部干扰求均值,得到当前WSN(Ni)在各信道的外部干扰:Page7其中Mnode为当前WSN中的节点个数.并对所有节点所受相邻WSN(Nj)的内部干扰求和,得到当前WSN(Ni)受Nj的内部干扰:然后,Sink对Iout(Ni,c)和Iin(Ni,Nj)进行归一化.Iout(Ni,c)的归一化值为Iin(Ni,Nj)的归一化值为其中Mnode_max为预置的单个WSN中的最大节点数,Degreemax为预置的所有WSN中的最大节点度,计算每个节点的度时还需要考虑来自其它WSN的可能构成干扰的节点.并记当前WSN(Ni)在信道c所受内部干扰之和为另一方面,假设链路的通信质量具有双向对称性,则Iin(Ni,Nj)的理论值等于Iin(Nj,Ni).所以可计算Ni在信道c上输出的带权内部干扰之和为Iin_p(Ni,c)=∑cj=cand(ni,nj)∈E其中W(Nj)为Nj的优先级.具体的优先级分配方法较为灵活.可借鉴Internet区分化服务的思想[16],按通信可靠性要求将传感器网络应用划分成多个应用类别,每个应用类别对应一个优先级.然后,根据各WSNNi的所属应用类别为其分配对应的优先级W(Ni).因而,在所有WSN都属于同一管理机构的应用场合,可在部署时根据应用类别静态设置各WSN的优先级.而在不同WSN分别属于不同用户的应用场合,可在WSN的Sink接入Internet时,由Sink注册应用类别,由接入设备为WSN分配相应的优先级.给定两个WSN,记为Ni和Nj,当Ni的优先级W(Ni)大于Nj的优先级W(Nj)时,Ni应受到更好的保护.加权和是一种可以将多个指标综合起来的有效方法.所以,用一个外部干扰和内部干扰的加权和刻画Ni在信道ci上受到的总干扰:I(Ni)=W(Ni)[β,1-β]·[Iout(Ni,ci),Iin(Ni,ci)]T其中操作·为求向量内积,操作T为向量转置.β为一个权值常量,其值决定了外部干扰和内部干扰的重要程度.在实际应用时,因为Wifi的干扰范围无法预知,而各WSN中的节点密度是已知的,所以可以根据节点密度设置合理的β值.各WSN节点密度越高,WSN之间的内部干扰对WSN通信质量的影响就越大,β值应设置得越小.信道分配应使所有WSN的加权干扰之和最小.所以可将带优先级WSN的信道分配问题,即CAP问题(ChannelAllocationforWSNswithPriority)定义如下:给定一个干扰图G=(V,E),k个可用信道c1,c2,…,ck,所有Iout(Ni,cl)及Iin(Ni,Nj),如何为所有Ni分配信道ci,以最小化所有WSN的带权干扰之和Itotal=∑ni∈G以下分析CAP问题的复杂度.定理2.CAP问题为NP-难问题.证明.可将k染色问题归约为CAP问题.考虑k染色问题:图G是否可用k种颜色染色,使得任意相邻结点被染成不同的颜色.令CAP问题中的任意Ni在任意信道c(即颜色)的外部干扰Iout(Ni,c)为0,即不存在外部干扰,并将W(Ni)设置为1,使各WSN优先级相同,权值β置为0.所有内部干扰Iin(Ni,Nj)=1.从而,k染色问题可转化成CAP问题,求出的解为0对应可染,非0对应不可染.因此,k可染色问题可归约为CAP问题.已知k染色问题是NP-完全问题,故CAP问题是NP-难问题.证毕.由定理2知,求解CAP问题最优解的计算复杂度较高.若采用集中式算法,则实施较为困难,且通信代价过大.所以,EasiCAP采用局部化方式以贪婪算法求解该问题,简要来讲,各个WSN的Sink根据自己收集的信息独立计算Iout和Iin;根据计算结果,采用贪婪策略独立选择信道.这样,一方面可以降低通信开销,另一方面也可以保证各个WSN运行的独立性.Sink选择信道的贪婪思想是使当前WSN(Ni)在每次进行信道选择时,都尽可能地降低WSN的带权总干扰Itotal,即最小化ΔItotal.为实现该目的,定义信道选择的3种操作:(1)保持信道(Ni~ci).即Ni保持当前状态,继续占用当前信道ci,此时,Itotal的增量为Page8(2)切换信道至ch(Ni→ch).即不论信道ch当前是否被其它WSN占用,Ni将工作信道切换至ch.这时,Itotal的增量为ΔItotal(Ni→ch)=犅·[W(Ni)Iout(Ni,ch),W(Ni)Iin(Ni,ch),Iin_p(Ni,ch)]T-犅·[W(Ni)Iout(Ni,ci),W(Ni)Iin(Ni,ci),Iin_p(Ni,ci)]T=犅·[W(Ni)(Iout(Ni,ch)-Iout(Ni,ci)),W(Ni)(Iin(Ni,ch)-Iin(Ni,ci)),Iin_p(Ni,ch)-Iin_p(Ni,ci)]T其中犅为[β,1-β,1-β].(3)抢占Nj的信道(NiNj):在许多情况下,低优先级WSN(Nj)会占用干扰较小的信道.此时,Ni需要抢占Nj的信道,首先进入Nj所在信道cj,并通知Nj其信道被抢占,迫使Nj退出信道cj而进入Ni的旧信道ci.该操作引起的Itotal的增量为ΔItotal(NiNj)=犅·[W(Nj)Iout(Nj,ci),虽然Iout(Nj,ci),Iin(Nj,ci),Iin_p(Nj,ci),Iout(Nj,cj),Iin(Nj,cj)及Iin_p(Nj,cj)都为未知量,但因为Ni与Nj地理位置相近,因此其内部干扰值和外部干扰值也接近,故可以用Iout(Ni,ci),Iin(Ni,ci),Iin_p(Ni,ci),Iout(Ni,cj),Iin(Ni,cj)及Iin_p(Ni,cj)分别近似代替以上各未知量,并用Iin(Ni,Nj)代替Iin(Nj,Ni).从而有ΔItotal(NiNj)≈(W(Nj)-W(Ni))[β,1-β]·[Iout(Ni,ci)-Iout(Ni,cj),Iin(Ni,ci)-Iin(Ni,cj)]T-(1-β)[W(Ni)+W(Nj)]Iin(Ni,Nj)(17)Ni的Sink根据采集到的本地信息计算各种操作所引起的ΔItotal,从而选择使得ΔItotal最小的操作.EasiCAP的贪婪信道分配算法如算法1所示.3个for循环的复杂度分别为O(k·Mnode_max)、O(k)和O(Mwsn),其中Mwsn为总网络数.所以该信道分配算法的计算复杂度为O(k·Mnode_max+Mwsn).算法1.贪婪信道分配算法.输入:β,c1,c2,…,ck,Iout(Ni,cl),Iin(Ni,Nj),W(Ni)输出:(新信道id,被抢占信道的网络id)//根据式(11)、式(12)计算Iin及Iin_p1.for(h=1;hk;h++){2.ΔItotal(Ni~ci)=0;3.minDelta=ΔItotal(Ni~ci);minChnl=ci;4.swapWsnId=-1;5.for(h=1;hk;h++){6.for(j=1;jMwsn;j++){7.return(minChnl,swapWsnId).如果算法返回的信道minChnl与当前工作信道不同,则从Sink开始,逐层通知下级子节点切换到信道minChnl.若swapWsnId不是-1,则切换信道后由Beacon消息携带swapWsnId及ci,通知编号为swapWsnId的WSN切换到信道ci.在干扰非常严重的情况下,少量节点可能会因为无法收到Sink的检测启动消息或信道切换消息而变成孤立节点,因此,EasiCAP包含一个信道重发现算法让孤立节点搜索WSN中其它节点所在信道.因篇幅有限,本文省略该算法的具体说明.Page95性能评价本文首先通过一定规模的实验床来验证EasiCAP的有效性,并与现有方法进行性能比较.然后,借助仿真实验测试EasiCAP在大规模网络中的性能.5.1实验床评价本小节通过实验床验证EasiCAP的性能.实验地点为作者所在科研楼7层.为减少实验环境中已有Wifi设备对实验的影响,所有实验都在非工作时间内完成.实验床的部署环境及拓扑结构如图9所示,实验床由16个传感器节点组成4个WSN,分别为WSN1、WSN2、WSN3及WSN4,每个WSN包含4个节点.每个节点为作者所在实验室自主开发的EZ240节点,配有CC2420射频模块,运行Tinyos2.1操作系统.其中,10号、20号、30号和40号节点分别为各WSN的Sink.节点之间的最短和最长距离分别约为1m及6m.为便于评价,将WSN的可用工作信道限制在802.15.4的信道19~24.Wifi的信道9和信道11分别与802.15.4的信道19~22和信道21~24重合.因而,选择分别工作在Wifi的信道9和信道11的两对笔记本电脑9T、9R和11T、11R作为Wifi干扰源.由9T和11T分别直接发送UDP数据包给9R和11R.WSN的主要实验参数如表1如示.其中,设置β为0.5,该值是根据当前实验床的节点密度而设置.参数信道发射功率0dBmK4包长度100bytesβ0.5ΔP2dBmPRRthr20%实验床实验主要在包接收率、吞吐量及通信和存储开销等几个方面评价EasiCAP的性能,并与使用广泛的固定信道分配(FixChnl)机制和目前性能最好的跳频机制ARCH[11]进行性能比较.各种机制下,WSN1、WSN2、WSN3及WSN4启动后的初始信道分别为21~24.5.1.1包接收率的分析为评价不同机制下各WSN的包接收率,将WSN1、WSN2、WSN3和WSN4的优先级分别设置为1、2、3和4,各传感器节点每秒产生5个数据包并以多跳方式转发给Sink.9T和11T分别交替以0.8Mbps及1.5Mbps的速率发送数据,即一段时间内,9T和11T分别以0.8Mbps和1.5Mbps的速率发送数据包,持续12min后,9T和11T对调发送速率.以滑动平均的方式计算包接收率,并统计各WSN内所有节点的包接收率均值.图10(a)~(c)分别给出了一段时间内EasiCAP、FixChnl和ARCH机制下各WSN的包接收率时序图.从图10(a)可看出,EasiCAP机制下各WSN的包接收率与其优先级相一致,即优先级越高的WSN图10采用不同机制时的包接收率时序图(WSN1、WSN2、Page10所获得包接收率也越高.9T及11T在400s及1200s左右对调发送速率,引起了信道切换,可以看出信道切换后,优先级更高的WSN仍具有更高的包接收率.在第一次速率对调前,9T和11T的速率分别为1.5Mbps及0.8Mbps,WSN1、WSN2、WSN3及WSN4工作信道分别为20、19、23和24.对调之后,WSN4和WSN3分别抢占了WSN2和WSN1的信道,4个WSN的工作信道分别变成23、24、20和19.同样,第二次速率对调之后,引起类似的信道抢占.但在此之后,WSN2进入WSN3的工作信道23,并与WSN3共享信道23.如图10(b)所示,在FixChnl机制下,在第一次速率对调之后,11T速率切换为1.5Mbps,WSN3及WSN4的包接收率迅速下降,并且WSN3的包接收率反而低于WSN1.可见,在Wifi干扰比较严重的环境中,固定信道分配难以适应Wifi干扰的变化,从而无法适用于对通信可靠性要求较高的应用,如病症监测、火灾预警等.图10(c)给出了ARCH机制下各WSN的包接收率.可见各WSN的包接收率较为接近,这是因为ARCH机制下各节点以随机方式选择工作信道,无法保证新信道的通信质量比原有信道更好.因此,部分节点工作在干扰较小的信道,而部分节点会工作在干扰较大的信道.此外,由于每次数据发送都需要切换信道,产生了一定的时间开销.图11统计了3小时内不同机制下各WSN的平均包接收率.如图所示,EasiCAP机制下各WSN的平均包接收率大小顺序与其优先级顺序一致.这说明EasiCAP可为各WSN提供与其优先级相对应的通信质量.然而,FixChnl和ARCH机制均无此功能.此外,FixChnl、ARCH和EasiCAP机制下4个WSN总的平均包接收率分别为0.59、0.64和0.68,EasiCAP分别比FixChnl和ARCH高15.3%和6.3%.以上结果说明:EasiCAP可为各WSN提供与其优先级相对应的通信可靠性,并提高了各WSN的平均通信可靠性.5.1.2吞吐量的分析除包接收率外,吞吐量也是衡量通信质量的另一重要指标.本小节着重分析Wifi干扰大小和WSN优先级对吞吐量的影响.这里的吞吐量是指端到端吞吐量,即单位时间内Sink收到各传感节点的平均数据量.为检验Wifi干扰大小对吞吐量的影响,使9T和11T交替两种速率发送数据包,一种速率为0.8Mbps,另一速率为以下之一:0.5Mbps、0.8Mbps、1Mbps、1.5Mbps、2Mbps及2.5Mbps.WSN1、WSN2、WSN3及WSN4的优先级仍分别为1、2、3和4.图12给出了环境中存在不同速率的Wifi干扰时,各WSN采用EasiCAP机制可以获得的吞吐量.从图12可以看出随着Wifi干扰通信量的增加,各WSN的吞吐量逐渐减小,但各WSN的吞吐量仍与其优先级相对应,即优先级越高的WSN吞吐量越高.图13给出采用不同机制时所有WSN的平均吞吐量.由图可知,三种机制下,平均吞吐量均随Wifi通信量的增加而减少.但在不同Wifi通信量下,EasiCAP所得平均吞吐量均高于FixChnl机制及ARCH机制,且EasiCAP的优势随着Wifi通信量的增加而增加.例如,当Wifi的通信量为2.5Mbps时,EasiCAP的平均吞吐量分别比FixChnl和ARCH的平均吞吐量高18.06%和29.77%.这主Page11要是因为在干扰较大时,EasiCAP允许多个WSN占用同一通信质量较好的信道.虽然ARCH也可以使不同WSN的节点共享通信质量较好的信道,但处在干扰较大的信道中的节点由于信道失同步而容易导致WSN短时间不连通.此外,为测试优先级对吞吐量的影响,交替两种发送速率,即1.5Mbps及0.8Mbps,并设置WSN1、WSN2、WSN3及WSN4的优先级分别为1111、1112、1123及1234.图14给出了在各种优先级设置下的吞吐量的统计值.可以看出,无论在哪种优先级设置下,EasiCAP都可以使优先级高的WSN获得更高的吞吐量.因而,可以得出结论:EasiCAP可为WSN提供与其优先级相对应的吞吐量,并显著提高了所有WSN总的平均吞吐量.5.1.3通信及存储开销的分析信开销和存储空间开销.EasiCAP在进行信道分配时会带来少量的通采用与5.1节相同的方法,统计平均每次Wifi速率变换引起单个WSN发送的平均控制包总数.EasiCAP的控制消息包括检测启动消息、信道扫描时主动发送及响应的Beacon消息以及信道状态反馈消息.FixChnl、ARCH和EasiCAP的平均控制包数目分别为0、15.25和87.72.可见,EasiCAP比另外两种机制需要更多的控制开销.但统计发现,在真实的Wifi干扰环境中,WSN每天所需切换信道次数不会很多.所以,EasiCAP的通信开销并不大.图15给出了各机制的编程实现所占的ROM和RAM的空间大小.Tinyos工具链显示,EasiCAP的传感节点部分所占ROM空间比FixChnl和ARCH仅分别增加了1110bytes和450bytes,所占RAM空间比FixChnl和ARCH分别增加了1530bytes和736bytes.Sink所占ROM比传感节点多2670bytes,但Sink通常具有更多的存储资源.目前常用的Telosb节点具有16KBRAM和256KBFlashROM,Imote2节点具有256KBRAM和32MBFlashROM.因此,EasiCAP未带来过大的存储开销.5.2仿真评价本小节使用ns-2.33仿真平台,从包接收率、吞吐量、通信开销及收敛时间等几个方面对大规模网络中EasiCAP的性能进行评价和分析.网络仿真场景为一个50m×200m的长方形区域.沿其长边方向的中心线等距离部署8个WifiAP,另在每个AP周围随机分布1个WifiClient,分别与一个AP通信.8对Wifi设备的工作信道分别为8、9、10、11、8、9、10、11,这些信道的频率与WSN的18~24信道的频率重叠.8、9信道的Wifi设备和10、11信道的Wifi设备交替以1Mbps和2Mbps的速率发送数据,每隔400s交换发送速率.根据节点密度的不同,设置不同的参数β:网络规模低于30个节点,β为0.5;网络规模为40~60个节点,β为0.45;网络规模高于70个节点,β为0.4.除β之外的其它参数,如表1和表2所示.Wifi的通信模式Wifi的发射功率传感节点的数量传感节点的分布传感节点的工作信道传感节点的发送速率5.2.1包接收率及吞吐量分析为了分析大规模网络中EasiCAP机制的包接收率和吞吐量,部署5个WSN:WSN1、WSN2、WSN3、WSN4、WSN5,它们的优先级分别为1、2、3、4、5.各传感节点每秒产生5个数据包,并以多跳Page12方式传送给Sink.在每组实验中,将WSN的网络规模分别设置为10~70个节点.对于每级网络规模,随机生成10个连通网络拓扑,然后运行3种机制的实现各2000s.最后将10次仿真实验结果的算术平均值作为各WSN的包接收率和吞吐量.图16给出了采用EasiCAP机制时不同网络规模下的包接收率.由图可知,优先级高的网络具有更高的包接收率.这表明,对于大规模网络,EasiCAP仍可为各个网络提供与其优先级相对应的包接收率,从而保障相应的通信可靠性.另外,也可以看出,随着网络规模的增大,各个网络的包接收率总体呈递减趋势.图17不同网络规模下单个网络的总吞吐量图17比较了FixChnl、ARCH和EasiCAP机制在不同网络规模下单个网络的总吞吐量,即每个Sink在单位时间内收到的总数据量.如图所示,EasiCAP机制下的总吞吐量高于现有的FixChnl和ARCH机制.但是,这种优势随着网络规模的增大而逐渐缩小,主要原因是节点密度增加之后,同一网络内各节点之间相互干扰越来越严重,从而越来越多的数据包由于网络内的发送冲突而丢失.因而,此时可以将网络划分成多个子网络,各自独立选择信道以提高总吞吐量.5.2.2通信开销分析采用与前面相同的实验方法分析大规模网络中EasiCAP和ARCH的通信开销.表3统计了每次Wifi信道变化时,单个网络产生的平均控制包的数目.表中的a×b表示总共有a个网络且每个网络含b个节点.可以看出,EasiCAP比ARCH产生了更多的控制开销.但如前所述,在真实Wifi干扰环境中,WSN每天所需的信道变换次数不会很多,因而产生的控制开销并不会很大.机制ARCH88193247395EasiCAP4801127150523545.2.3收敛性分析当信道质量改变时,EasiCAP机制的信道分配算法会使各个网络产生一系列的信道切换和信道抢占操作,分配过程的收敛时间会对各个网络的性能产生一定的影响.因而,收敛时间也是衡量抗Wifi干扰的信道分配机制的一个重要指标.为评价EasiCAP的收敛性能,分别部署4个和8个WSN,每个WSN含25个节点.对于2种场景,分别随机生成10个连通网络拓扑,并运行EasiCAP的实现2000s.然后,将Wifi速率切换后的时间以每5s为一个单位切分成多个小时隙,统计各小时隙内信道改变次数的均值.图18给出了40次Wifi速率切换引起的信道改变次数的算术均值.可以看出,各网络在Wifi速率切换后约10s启动了信道分配过程.在4个WSN的实验场景中,EasiCAP的信道分配机制在经历约75s的信道变换过程后,便达到收敛,进入稳定状态.达到收敛状态所需的信道改变总次数的均值为6.1,最小值为3,最大值为10.而对于8个WSN的实验组,收敛时间约为85s,信道改变总次数均值为9.05,最小值为6,最大值为14.以上结果表明:EasiCAP的信道分配过程具有良好的收敛性能,而且网络数目的增加不会使收敛时间大幅度增加.Page136结论针对Wifi干扰下的带优先级WSN的信道分配问题,本文提出了一种信道分配机制EasiCAP.该机制首先通过受控Wifi干扰源建立外部干扰特征,该特征由干扰强度和活跃比率组成;然后基于干扰特征建立外部干扰模型EIM,用于计算外部干扰指数以度量WSN在各信道上所受的Wifi干扰大小;此外,采用以接收端为中心的模型IIM,评价各WSN之间的内部干扰;最后,综合EIM和IIM产生的干扰评价指标,各WSN以此指标为依据,采用贪婪算法独立、实时地选择信道并进行相应操作(保持、切换和抢占),以实现按优先级分配信道,并兼顾所有WSN的整体通信质量的目标.通过实验床测试和仿真实验验证了该机制的有效性.结果表明:(1)EasiCAP可为各WSN提供与其优先级相对应的通信可靠性和吞吐量;(2)与最近提出的ARCH机制[11]相比,EasiCAP也具有更高的平均通信可靠性及吞吐量,在Wifi干扰较大时,可将平均吞吐量提高29.77%;(3)EasiCAP的信道分配过程具有良好的收敛性;(4)EasiCAP也未带来过大的通信和存储开销.EasiCAP开销小且易于实现,因而具有较强的实用性,适用于在多个静态传感器网络共同部署的室内环境中,如智能家居、智能楼宇等.对于移动传感器网络,因各信道的内部干扰和外部干扰变化较快,EasiCAP难以保证干扰度量的准确性,因而并不适用.本文的下一步工作是将信道分配与编码和信道访问控制技术结合起来,进一步改进该机制,以满足移动传感器网络的需求,尤其是解决多个穿戴式医疗传感器网络[17]在Wifi干扰下的信道分配问题.
