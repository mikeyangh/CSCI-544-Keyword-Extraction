Page1面向生物医学命名实体识别的多Agent元学习框架王浩畅1),2)李钰2)赵铁军3)1)(东北石油大学计算机与信息技术学院黑龙江大庆163318)2)(哈尔滨工业大学生命科学与工程系哈尔滨150001)3)(哈尔滨工业大学计算机科学与技术学院哈尔滨150001)摘要生物医学命名实体识别是生物医学数据挖掘的基本任务.文中提出了一种将多Agent系统和元学习方法相结合的多Agent元学习框架,应用于生物医学命名实体识别.基层多个学习Agent分别识别不同类型的生物医学命名实体,并通过相关学习Agent之间的通信来交换有益信息以调节个体Agent的行为提高其学习性能,元层Agent综合决策基层学习Agent的学习结果以获得最终的识别结果.元层Agent和基层学习Agent通过局部特征选择法选择适合不同实体类别的敏感特征集合提高了总体识别性能尤其是小类别识别的性能.文中提出的方法有效改善了传统的单一学习模型和全局特征选择方法不能兼顾各类别命名实体识别性能的不足.实验结果表明,文中提出的全新方法在生物医学命名实体识别上取得了优越的性能,在JNLPBA2004测试语料上获得了77.5%的F测度值.关键词命名实体识别;多Agent元学习框架;元层Agent;基层学习Agent;局部特征选择1引言近年来,生命科学领域研究飞速发展,大量的生物医学知识以非结构化的形式被记载在各种形式的文本文件中.从海量相关文献中直接获取本领域相关信息并使其变为生物学家可直接利用的知识,是一项迫在眉睫的任务.以MEDLINE数据库为例,作为美国国家医学图书馆中规模最大、权威性最高的著名医学文献数据库,其文献总数目前已达到1600万,其中超过300万篇文献是近5年内出版的.因此生物医学领域迫切需要有效方法对其中的知识进行挖掘.生物医学文本知识挖掘的基本任务之一是生物医学文本中命名实体的识别.其目的是从生物医学文本集合中识别出指定类型的名称,例如蛋白质、基因、核糖核酸、脱氧核糖核酸等.这些获取的生物医学知识有着广泛的应用价值,例如疾病的诊断、预防和治疗.生物医学领域命名实体识别是一项具有挑战性的研究.其主要原因是:新的命名实体不断出现,形成了命名实体开放集;相同名称可能表示不同类别的生物医学命名实体,要依据上下文才能区分;很多生物医学命名实体拥有几个不同的名称.此外,还存在着实体名称过长、复合词多、缩写词比例大、实体名称嵌套等现象.目前,已经有很多技术应用到生物医学文本中的命名实体识别当中,大致可分为以下3类方法:基于启发式规则的方法[1-2]、基于字典的方法[3-4]和基于统计机器学习的方法.当前最为普遍应用的是统计机器学习方法,其实现过程就是通过样本集建立适当的统计模型,以此模型对新的数据进行分类识别.统计机器学习方法已经成为生物医学命名实体识别的一类重要方法.在过去的研究中,大部分识别系统建立在单个学习模型的基础上,如贝叶斯模型[5]、隐马尔可夫模型[6]、支持向量机模型[7-8]、条件随机域模型[9]、最大熵模型等[10].这些系统通常选择相同的全局特征集合来识别所有不同类别的实体类型,而使用的训练语料普遍存在数据不平衡问题,即类别间训练样例的数量存在数量级的差距.这样就导致这些系统存在以下缺点:单一的模型不能覆盖所有生物医学命名实体类型的特点,所以不能使所有的生物医学命名实体类型获得满意的识别效果;识别所有生物医学命名实体类型使用相同的特征集合,致使其中有些特征并不适合某一实体类型;由于小类别上的样例有限,分类器学习不够充分,因此在小类上的性能表现相对较差,严重影响了总体性能.实际上不同的学习模型及通过调节模型参数对不同的生物医学命名实体类型有不同的识别效果,不同的实体类型有不同的敏感特征,因此我们可以选择不同的模型识别不同的实体类型并且通过局部特征选择法选择适合不同实体类别的敏感特征集合,通过综合决策不同模型的识别结果,这样可以提高每一类的识别性能尤其是小类别识别的性能.随着分布式人工智能的发展,多Agent系统[11]的研究广泛地开展起来.多Agent系统(Multi-AgentSystems,MAS)建立在资源共享和各个Agent的自主性之上,各个Agent能够协作工作,以实现整体识别的目标.构建具有自学习能力的Agent是多Agent系统研究的一个重点,在这种需求下,为多Agent系统引入学习机制能够使其更好地适应复杂环境、有更强的个体学习能力和社会学习能力.在过去的研究中,统计机器学习无论在应用、算法、理论都取得了令人瞩目的进步.但是机器学习的研究一直独立于Agent的研究,最近才和Agent以及多Agent系统研究结合在一起[12-14].Agent以及多Agent系统可以看作是机器学习系统的另一个应用领域,持有这个观点的研究者或多或少地将机器学习算法直接应用于多Agent系统中的单个Agent.分布式人工智能与机器学习领域相互交叉、渗透,形成了多Agent系统学习这一新兴研究领域.机器学习和多Agent系统研究的结合,对两个研究的领域都起到了推动作用.元学习的概念是由Prodromidis等人于2000年首先提出的,该方法采用集成学习的方式来生成最终的全局预测模型[15].其基本思想是从己经获得的知识中进行再学习,从而得到最终的数据模式.本文在多Agent系统和元学习理论基础上,提出一种新的基于多Agent元学习框架的策略来提高生物医学命名实体的识别的性能,这和多分布式系统中应用元学习的思想有相近之处[16-18].我们的系统定义并描述了多Agent元学习框架的元层和基层构成.在基层中根据不同命名实体类型选择不同的基Page3层学习Agent,并通过局部特征选择方法选择相应的敏感特征集合;基层相关学习Agent之间通过通信交换有益信息以调节个体Agent的行为提高其学习性能;在元层中通过元Agent综合决策多个基层Agent的学习结果,以获得最终的识别结果,从而大幅度提高了生物医学命名实体识别的性能.本文第2节详细描述多Agent元学习框架以及基层Agent的通信方式;第3节介绍面向生物医学命名实体识别的多Agent元学习框架中各个Agent算法和特征的选择;第4节描述实验设置和实验结果,并对实验结果做了详细的分析;最后给出了结论.2多Agent元学习框架元学习基本思想是从已经获得的知识中再进行学习,从而得到最终的数据模式.在基学习阶段,各个结点可以自主地选择合适的学习算法来生成局部的基分类器.与此同时,各结点间不存在任何通信.在元学习阶段,系统可灵活采用各种集成策略,因此最终生成的元分类器具有较高的预测精度.为了介绍元学习过程,约定以下符号.x表示待分类的样本实例,给定K个学习算法Lk(k=1,2,…,K),这些学习算法训练获得的K个分类模型表示为Mk(k=1,2,…,K),每个分类模型对待分类实例x的预测分类结果表示为Ck(x)(k=1,2,…,K),class(x)和attrvec(x)分别表示正确的分类标识和实例x的特征属性向量.给定数据集D={(class(xi),attrvec(xi)),i=1,2,…,I},随机将数据集分成J个大小基本相等的数据集D1,…,Dj,定义Dj和D(-j)=D-Dj分别为J折交叉验证的第J折测试集和训练集.给定的K个学习算法,称为第0层归纳算法.在训练集D(-j)上训练第k个学习算法产生分类器模型k,对于模型M(-j)M(-j)层模型,也称为基分类器.对于测试集Dj中的每一个样本实例xi,Cki(xi)表示分类器模型M(-j)预测.在交叉验证过程结束后,集合从K个分类器模型的输出结果产生新的数据集DCV={(class(xi),C1i(xi),…,CKi(xi)),i=1,…,I},称为第1层训练集,也称为元训练集.使用元训练集训练一个学习算法产生的学习模型MMeta称为第1层模型,也称为元模型或元分类器,算法称为第1层归纳算法.图1描述了J折交叉验证和元模型的生成过程.图1元学习J折交叉验证和元分类器的生成对待分类的新样本实例进行决策时,首先通过第0层归纳算法在训练集D上进行训练学习产生模型Mk(k=1,2,…,K),对给定的一个新实例,模型Mk生成一个预测向量C1(x),…,CK(x),这个向量是元分类器MMeta的输入,其输出为最终预测结果.这种元学习方法也称为叠加法由Wolpert[19]提出.由上述可知,在元学习方法的基学习阶段,各结点算法之间不存在任何通信,这样虽然节省了通信开销,却降低了彼此之间信息的参考和借鉴.Agent之间的通信是多Agent系统的重要内容,也是多Agent系统的主要特色.Agent间通过通信可以相互了解彼此的信息,及时调整各自的策略.本研究将多Agent系统和元学习方法有效结合在一起,建立了多Agent元学习框架,提高了元学习的能力.多Agent元学习框架由元层和基层构成.基层中根据不同命名实体类型选择不同的基层学习Agent和敏感特征,并通过基层相关学习Agent之间的通信交换有益信息以调节个体Agent的行为,提高其学习性能.本研究中的Agent的通信采用被动通信方式.被动通信方式也称为消息传递方式.其通信的原理属于直接通信方式下的消息缓冲通信机制.被动方式的消息传递方式相对于主动方式更为灵活,它是实现灵活复杂的协调策略的基础.在由自治Agent构成的多Agent系统中,Agent之间经常需要协作来完成任务求解.假设系统中有一个Agent集合和一组待求解任务,由于单个Agent无法独立完成某一任务或者通过多个Agent协作能提高求解效率或性能,Agent之间可以通过协商形成Agent组,我们称之为联盟(coalition).通常,系统中很多Agent会形成相对稳定的并且是成功的联盟.那么在以后形成联盟的过程中,我们就可以以那些Agent集合为依据大大减少协商的盲目性,从而降低协商时的通信开销.我们引入熟人集(Acquaintance)的概念.AgentK的熟人集就是跟AgentK达成成功联盟超过一定频度的Agent集Page4合.本研究中Agent的通信采用基于熟人集的联盟,把需要通信的Agent互相请求成为熟人.只有熟人Agent之间才能进行通信,采用基于熟人集的联盟可以减少通信的开销.基层学习Agent只和容易发生识别冲突的Agent进行通信形成熟人集联盟,以消除识别冲突.在我们的识别任务当中,我们发现DNA类和protein类、DNA类和RNA类、cell_type类和cell_line类经常发生识别冲突,识别上述类别的Agent彼此之间即确定为“熟人”.通过启发式规则和统计策略的结合来消除识别冲突.启发式规则举例如下.(1)IFr(Agent1)=“protein”∧r(Agent2)=“DNA”∧“Xligation”∈r(Agent1)THENr(Agent2)≠“DNA”,其中r表示识别结果.(2)IFr(Agent2)=“DNA”∧r(Agent3)=“RNA”∧“XmRNA”∈r(Agent3)THENr(Agent2)≠“DNA”,其中r表示识别结果.(3)IFc(r(Agent4)=“cell-type”)>c(r(Agent5)=“cell-line”)THENr(Agent4)=“cell-type”∧r(Agent5)≠“cell-line”,其中r表示识别结果,c表示在整个识别任务中识别出同一结果的次数.多Agent的自治性使得不同的基层学习Agent可以识别不同类型的命名实体.每个Agent使用自己的知识和资源,即不同的实体类型使用不同的敏感特征.因而能够保证每个类别识别的性能.Agent的社会性使基层学习Agent之间可以交换信息,彼此借鉴信息,从而提高识别的精确率和召回率.元层中元Agent有自己的知识和资源,基层学习Agent的输出结果作为元Agent输入的一部分,元Agent通过将基层学习Agent的学习结果和自身的知识和资源相结合,综合决策以获得最终的识别结果,进一步提高了系统的识别性能.针对我们识别5类生物医学命名实体的识别任务,多Agent的元学习框架如图2所示,任务分解Agent进行任务分解,基层共有5个学习Agent分别识别protein、DNA、RNA、cell-type、cell-line类生物医学命名实体,元Agent做综合决策以获得最终的识别结果.图中的虚线表示基层学习Agent之间的通信关系,当基学习Agent之间存在识别冲突时通过通信调节识别结果以提高基学习Agent的识别性能,这样也有利于元Agent综合决策结果的提升.3算法和特征选择3.1算法在多Agent的元学习框架中,将每个分类模型视为一个基层学习Agent来识别不同类型的生物医学命名实体.综合决策结果取决于基层学习Agent的性能和独立性,即要求基层学习Agent有较低的错误率,至少比随机预测的结果要好,并且产生的错误相互独立.本文研究中,基层学习Agent使用了两种经典的学习算法,即GeneralizedWinnow[20]和条件随机域(CRFs)[21]算法,这两种算法非常适用于自然语言处理研究中的分类问题.实验过程中,我们发现基于我们选择的特征GeneralizedWinnow算法对protein和cell_type类别识别的性能较好,而CRFs算法对DNA、RNA和cell_line类别的识别性能较好.元层中元学习Agent使用了CRFs算法作为综合决策算法,各个Agent的算法分配具体如表1所示.AgentsAgent1识别protein实体类型GeneralizedwinnowAgent2识别DNA实体类型Agent3识别RNA实体类型Agent4识别cell_type实体类型GeneralizedwinnowAgent5识别cell_line实体类型CRFs元Agent综合识别结果得到最终结果CRFs3.2特征选择特征选择的目的是寻找那些帮助识别和分类生物医学命名实体的文本属性.从以往的研究中我们发现生物医学命名实体识别系统都采用全局特征选择方法,即所有的类别都使用一个通用的特征选择过程,并且共享一个特征集合.这就导致存在以下几个问题:所有命名实体类型使用相同的特征,致使有些特征并不适合某一类型的命名实体;如果系统使用的特征类型多,会导致数据稀疏现象,占用更多的CPU资源,而使用的特征类型少又会降低系统的性能;由于大规模分类问题中普遍存在数据不平衡问题,即类别之间训练样例的数量存在数量级的差距,根据一般的特征选择函数进行全局特征选择得到的特征在类别上的分布并不均匀,大多集中于几个容易识别的类别中,主要原因是由于小类别上的样例Page5有限,分类器学习不够充分,就是对小类和难识别类别没有给予足够的重视[22],因此在小类上的性能表现相对较差,严重影响了总体性能.本文研究使用JNLPBA2004语料进行训练和测试.语料中的命名实体分为5类:DNA、RNA、protein、cell_line和cell_type.表2为JNLPBA语料中各个实体类别的分布情况,从表2中我们可以看出JNLPBA训练语料中存在着数据不平衡的问题,最少的RNA类只有951个训练样例,最多的protein类有30269个训练样例,因此必然会引起分类器在小类别上学习不充分的局限性.表2JNLPBA训练语料各个实体类型的数量实体类别proteinDNARNAcell_typecell_line数量30269953495167183830鉴于上述原因,为给予每一类别足够的重视,使用局部特征选择[22-23]的方法,分别对每一类别进行特征选择.局部特征选择是指特征选择针对每个类别进行,不同的类别使用不同的特征集合.本文按照局部特征选择的思想,采用基于启发式的方法进行特征选择,通过分析每类命名实体识别性能的变化得到不同类别命名实体的敏感特征集合.所谓“敏感特征”是指对识别起到决定性作用的特征.在大量的特征中,有可能只有几个特征对某类别命名实体的识别起到决定性的作用,而其它特征贡献非常小或者是多余的,这些多余的特征不仅占据内存空间,而且还影响查询的效率.我们逐类构造最佳特征子集,选择不同生物医学命名实体类别对应的敏感特征集合,最大程度地保证了每个类别尤其是小类和难识别类的识别效果.本文特征选择过程分为基层特征选择和元层特征选择:在基层Agent的特征选择过程中,使用局部特征选择法,分别对每一类别进行特征选择.我们根据每类生物医学命名实体的特点构造其特征集合,每类实体类型包括以下一些各类别独有的特征:一元核心词特征、二元核心词特征、词法特征、不同类别的辞典特征等.有一些特征是各类命名实体共有的特征,比如征词性特征、语块特征、标准化拼写特征及部分词形特征等.在元层Agent的特征选择过程中,基层Agent的识别结果作为元层Agent的输入特征,这些识别特征也可以看作是元Agent的局部特征,除此之外我们还使用了各类别的一元核心词特征、二元核心词特征、词法特征、词性特征、语块特征、标准化拼写特征及部分词形特征.关于各个Agent使用的不同特征集合描述详见表3,关于每类特征的详细描述请参见文献[24].AgentsAgent1protein类的核心词特征、词法特征、Agent2DNA类的核心词特征、词法特征Agent3RNA类的核心词特征、词法特征Agent4cell_line类的核心词特征、词法特征Agent5cell_type类的核心词特征、词法特征元Agent4实验与结果分析本文研究使用JNLPBA2004语料进行训练和测试.JNLPBA的训练语料由GENIA3.0语料中的2000篇MEDLINE摘要组成,测试语料由当时未出版的MEDLINE摘要组成,共404篇.语料中的命名实体分为5类:DNA、RNA、protein、cell_line和cell_type.实验结果的评价标准是精确率(P),召回率(R)和F测度(F)评价.本文使用了全部匹配模式对实验结果进行评测,即识别出的命名实体全部和正确答案的命名实体完全相匹配则认为是正确匹配.实验设置中,J折交叉验证取J值为5.为了验证局部特征选择法和多Agent元学习框架的有效性,我们把使用基于单一学习算法和全局特征选择方法的识别系统作为参照系统进行比较实验,参照系统使用了CRFs算法,并进行了缩写词识别,边界调整和嵌套识别后处理过程,具体参见文献[24],对比实验结果如表4所示.命名实体类型Protein74.483.578.773.280.577.172.778.975.7DNA78.971.374.975.471.173.268.977.172.8RNA72.475.473.970.773.171.967.867.867.8Cell-line64.967.666.262.866.164.460.262.061.1Cell-type86.871.578.484.770.677.080.273.276.5Overall76.778.377.574.976.275.572.976.374.6从实验结果中可以看出,使用局部特征选择方法的基层Agent识别结果优于参照系统,并且未进行例如缩写词识别,边界调整和嵌套识别的等复杂的后处理过程,这说明我们的局部特征选择方法是行之有效的,并且我们发现每类的识别结果都有所提升,尤其是小类别RNA类和Cell-line类的识别Page6结果提升比较显著,RNA类的识别结果F测度提升了4个百分点,Cell-line类的识别结果F测度提升了3个百分点.基于多Agent元学习框架的识别策略明显优于参照系统,并优于基层Agent识别结果,如protein类识别结果F测度提升了1.6个百分点,DNA类的识别结果F测度提升了1.8个百分点,这也说明了通过基层Agent之间的通信和元Agent的综合决策,有效地提高了系统中各个类别的识别性能和总体性能.系统最终结果F测度比参照系统性能高出近3个百分点.表5列出了本文提出的方法和JNLPBA2004任务前3名系统的比较结果.从中可以看出,本文方法比最好的系统结果高出近5个百分点.多Agent元学习框架76.778.377.55结论本文提出了一种基于多Agent元学习框架的的生物医学命名实体识别策略,将多Agent系统学习和元学习方法结合起来应用于生物医学命名实体识别.使用不同的学习Agent和局部特征选择法选择不同的敏感特征集合识别不同类别的命名实体类型,克服了使用单一学习算法选择相同特征集合识别所有命名实体类型的缺点,提高每一类的识别性能尤其是小类别识别的性能;同时通过Agent之间的通信提高了Agent个体的识别性能弥补了元学习中基分类器互不通信的缺点,顶层决策使用元Agent能够利用不同学习Agent的决策结果.最终实验结果表明本系统性能明显优于基于单分类器使用全局特征选择方法的识别系统.在今后的研究工作中将研究更合理的任务分解策略及更合适的Agent学习模型,以进一步提高系统的性能.
