Page1标准模型下增强的基于属性的认证密钥协商协议李强冯登国张立武高志刚(中国科学院软件研究所可信计算与信息保障实验室北京100190)摘要采用一种简洁高效的转化方法将Waters的只能抵抗选择明文攻击(Chosen-PlaintextAttack,CPA)的基于属性的加密方案转化为能够抵抗选择密文攻击(Chosen-CiphertextAttack,CCA)的密钥封装方案,并在此基础上提出了一个标准模型下增强的基于属性的认证密钥协商协议.该协议能够在CK+模型下可证安全.CK+模型是目前关于认证密钥协商协议的最强的安全性定义.本文协议满足弱的完美前向安全性,并能抵抗密钥泄露伪装攻击和临时密钥泄露攻击.相比于现有的基于属性的认证密钥协商协议,本文协议具有更高的通信效率和更强的安全性.关键词认证;密钥协商;基于属性;CK+模型;标准模型1引言认证密钥协商协议能够在开放的网络环境中实现用户的相互认证,并在用户之间建立安全信道以保护用户的通信安全,因此认证密钥协商协议在实Page22005年以来,基于属性的密码体制被首次提出,并得到了广泛的研究和应用,其中基于属性的加密(Attribute-BasedEncryption,ABE)方案[1-4]主要应用于细粒度的访问控制;基于属性的签名(Attribute-BasedSignature,ABS)方案[5-6]虽然能够实现单向的匿名认证,但不能建立安全信道;基于属性的认证密钥协商(Attribute-BasedAuthenticatedKeyAgreement,ABAKA)协议[7-12]在实现双向匿名认证的同时能够建立安全信道.在ABAKA协议中,若协议双方拥有的属性均满足对方指定的认证策略(与、或、门限等),则双方能够实现相互认证并能建立共同的会话密钥,因此ABAKA协议在实现灵活丰富的认证策略的同时更好地保护了用户的隐私,更适合应用于分布式的云环境中.2009年Wang等人[7-9]第1次提出了两方的ABAKA协议,然而上述协议中的认证策略为用户必须拥有消息中所有的属性,因此并没有实现灵活的通用认证策略(与、或、门限等),此外上述协议都是在BR(Bellare-Rogaway)模型下证明的安全性.2010年Yoneyama[10]在Waters[4]的加密方案基础上提出了一个1轮的随机预言机(RandomOracle,RO)模型下支持通用认证策略的ABAKA协议,该协议利用了NAXOS技巧[13]将用户长期私钥和临时密钥作为杂凑函数的输入,并使用其计算结果作为密钥封装方案的随机数,因此该协议能在eCK(extendedCanetti-Krawczyk)模型下可证安全,但由于使用了杂凑函数,该协议只能在RO模型下证明其安全性.Birkett等人[11]提出了第1个标准模型下支持通用认证策略的ABAKA协议,该协议使用了基于属性的签名方案,若所使用的签名方案支持通用认证策略,则该协议也支持同样的策略,但该协议需要运行3轮且安全性证明是在BR模型中进行的.2011年Yoneyama[12]在Waters[4]的加密方案基础上提出了一个1轮的标准模型下的ABAKA协议,该协议支持通用认证策略,并在CK(Canetti-Krawczyk)模型下可证安全.该协议采用了Boneh等人[14]方案中的一次性签名的转化方法将CPA安全的Waters[4]的加密方案转化为CCA安全的密钥封装方案,该方法将一次性签名的验证密钥比特串的每一位(0或1)映射为两个冗余属性,从而导致协议通信量和系统的公共参数都增加了2k个群元素,其中k为一次性签名方案中验证密钥的比特串长度,因此这种转化方法增加了协议的复杂度.2007年LaMacchia等人[13]在前人工作(BR模型和CK模型)的基础上提出了扩展的CK模型即eCK模型,该模型能够证明认证密钥协商协议抵抗密钥泄露伪装(KeyCompromiseImpersonation,KCI)攻击和临时密钥泄露(LeakageofEphemeralKey,LEK)攻击,并能够证明协议满足弱的完美前向安全性(weakPerfectForwardSecrecy,wPFS).然而由于eCK模型不允许攻击者对会话内部状态进行查询,Cremers[15-16]证明了eCK模型与CK模型不可比较,即eCK模型并不比CK模型的安全性更强.2012年Fujioka等人[17]将CK模型与eCK模型整合提出了CK+模型,并采用了Okamoto[18]的twisted-PRF技巧,提出了一个在CK+模型下可证安全的通用构造方案.CK+模型在eCK模型的基础上增加了攻击者对会话内部状态的查询,因此该模型是目前关于认证密钥协商协议的最强的安全性定义.本文借鉴了Lai等人[19]基于身份的加密方案中提出的一个简洁高效的从CPA到CCA的转化方法,将Waters[4]的加密方案转化为一个CCA安全的基于属性的密钥封装方案,使得该方案的公共参数只增加了3个群元素,密文只增加了两个群元素,并在此基础上采用twisted-PRF技巧[18],提出了一个在标准模型和CK+模型下可证安全的ABAKA协议.Fujioka等人[17]的通用构造方案结合了一个CCA安全和一个CPA安全的密钥封装方案,协议运行轮数为2轮.本文通过在协议中增加了一次Diffie-Hellman交换,使得所提协议只需一个CCA安全的基于属性的密钥封装方案,且协议运行轮数为1轮.相比于现有的ABAKA协议,本文所提协议具有更高的通信效率和更强的安全性.2预备知识2.1访问结构定义1[20].令P={P1,P2,…,Pn}是参与方的集合,一个访问结构AA是2P的一个非空子集,即AA2P\{}.称AA是单调的访问结构,则对任意的B,C集合,若B∈AA且BC,则C∈AA.若集合在访问结构AA中,则称为授权集合,否则称为非授权集合.2.2线性秘密分享方案定义2[20].令参与方集合为P={P1,P2,…,Pn},(犕,ρ)表示访问结构AA,其中犕是一个l×n的矩阵,ρ是一个从{1,2,…,l}到P的映射,即矩阵犕中的每一行表示一个参与方.一个线性秘密分享Page3方案(LinearSecretSharingSchemes,LSSS)包含以下两个算法.秘密分享算法.如果分享秘密值s,首先选取一个n维的向量狏=(s,v1,v2,…,vn-1)T,其中v1,v2,…,vn-1∈p,然后将λi=犕i·狏作为参与方ρ(i)所获得的秘密分享值,其中犕i为矩阵第i行所代表的向量.秘密恢复算法.如果参与方的集合为授权集合,即S∈AA,令I={i:ρ(i)∈S},则存在一个算法能够在多项式时间内根据犕计算出一组恢复系数{μi}i∈I,并使得∑i∈Iμi·犕i=(1,0,…,0),因此可以恢复秘密值∑i∈Iμi·λi=∑i∈Iμi·犕i·狏=s.而对非授权集合I,则存在一个算法能够在多项式时间内计算出一个向量ω=(ω1,ω2,…,ωn)T∈且对i∈I,有犕i·ω=0.2.3双线性映射定义3.设G,GT是两个阶均为p的循环群(p为素数),g为G的一个生成元,双线性映射e是G×G→GT的一个映射,若e满足以下3个性质,则称e是一个有效的从G到GT的双线性映射:(1)双线性.a,b∈p,e(ga,gb)=e(g,g)ab.(2)非退化性.e(g,g)≠1.(3)可计算性.对x,y∈G,存在一个有效的多项式时间算法来计算e(x,y).2.4DPBDHE假设定义4[4].设G,GT是两个阶均为p的循环群(p为素数),g为G的一个生成元,e是G×G→GT的一个双线性映射,随机选择a,s,b1,b2,…,bq∈p,并给定以下元组:gs,ga,…,gaq,gaq+2,…,ga2q1jqgsbj,ga/bj,…,gaq/bj,gaq+2/bj,…,ga2q/bj1j,kq,j≠kgasbk/bj,…,gaqsbk/bj若不存在一个算法,能够在多项式时间内以不可忽略的概率区分e(g,g)saq+1和群GT中的随机元素,则称DPBDHE(DecisionalParallelBilinearDiffie-HellmanExponent)假设成立.2.5强随机提取器定义5[12].称一个函数Ext:{0,1}d×{0,1}n→{0,1}m是强随机提取器,若对于任意的{0,1}n上且最小熵H(X)k的均匀分布X,Ext(s,X)和{0,1}m上的随机串统计上不可区分,其中s是在种子空间{0,1}d上随机选择的种子.2.6伪随机函数集定义6[12].称一个函数集F={Fs}s∈K是伪随机的,若不存在一个区分者,能够在多项式时间内以不可忽略的概率区分Fk(·)和RF(·),其中k是在密钥空间K中随机选择的密钥,RF是一个随机选择的真随机函数.3安全模型在本文中,我们对文献[17]中定义的CK+模型进行扩展,使用属性描述协议实体,使该模型能适应基于属性的认证密钥协商协议的安全性分析,能够证明协议满足wPFS,并能抵抗KCI和LEK攻击.弱的完美前向安全性(weakPerfectForwardSecrecy,wPFS):若协议双方的私钥泄露,且私钥泄露前的会话未受到攻击者的主动攻击,即攻击者未对双方的通信消息进行修改,在这种情况下,若攻击者无法获得上述会话的会话密钥,则该协议满足wPFS.抵抗密钥泄露伪装(KeyCompromiseImper-sonation,KCI)攻击:若攻击者获得了协议实体A的私钥,且攻击者不能伪装成其它用户与A成功完成协议,则该协议能够抵抗KCI攻击.协议实体.协议实体U使用属性集SU来描述,且可以同时进行多个会话.若一个由A发起的与B之间的会话产生了消息m1,m2,…,mn,则该会话id被A标识为sid=(I,SA,SB,m1,…,mn),被B标识为sid=(R,SB,SA,m1,…,mn).已完成会话是指在一次会话中协议双方协商出了一个共同的会话密钥.一个已完成会话(I,SA,SB,m1,…,mn)的匹配会话是与其具有相同的通信消息且标识id为(R,SB,SA,m1,…,mn)的会话;反之亦然.攻击者模型.攻击者被模拟为一个概率多项式时间的图灵机,且可以通过执行以下询问来控制协议实体之间的通信:(1)Send(m).攻击者通过发送如下形式的消息激活会话:(I,SA,SB,m1,…,mk)或者(R,SB,SA,m1,…,mk+1),并得到相应的输出消息.(2)KeyReveal(sid).若会话sid已完成,则返回攻击者会话密钥;否则返回终止符号⊥.(3)StateReveal(sid).若会话sid未完成,则返回攻击者该会话的内部状态,包括选取的随机数以及中间的计算结果,但是不包括该会话的私钥;若会话sid已完成,则返回终止符号⊥.Page4(4)Corrupt(U,SU).该询问允许攻击者获取实体U的属性集SU所对应的私钥,并能完全控制该实体的行为.若攻击者对实体U执行了该询问,则称实体U为不诚实的,否则称其为诚实的.定义7(新鲜性).令sid=(I,SA,SB,m1,…,mn)或者(R,SB,SA,m1,…,mn)是诚实实体A和B之间的已完成会话,同时标记sid为sid的匹配会话(若sid存在).若下面的条件都不成立,则称会话sid是新鲜的:(1)攻击者执行了询问KeyReveal(sid),或者在sid存在的情况下执行了询问KeyReveal(sid).(2)sid存在,攻击者执行了StateReveal(sid)或者StateReveal(sid).(3)sid不存在,攻击者执行了StateReveal(sid).安全性游戏.初始时刻,攻击者得到一个诚实协议实体集合,并按照任何顺序执行上述询问.在游戏过程中,攻击者执行以下询问:Test(sid):其中sid是一个新鲜会话.通过公平的掷币协议选择b∈{0,1},若b=0,则返回攻击者会话sid的会话密钥;否则返回一个在密钥空间里随机选择的串.游戏继续进行,直到攻击者输出一个对b的猜测b,若b=b且会话sid仍然是新鲜的,则称攻击者赢得了该攻击游戏,定义攻击者在上述游戏中的优势为定义8(ABCK+安全性).一个ABAKA协议Π在ABCK+模型下是安全的,是指下面的条件同时成立:(1)若两个诚实的协议实体A和B完成了匹配会话且双方属性均满足对方指定的访问结构即SA∈AAB且SB∈AAA,则除了一个可忽略概率,协议双方计算出相同的会话密钥.(2)对任何一个概率多项式时间的攻击者,Π()在下列情况下是可忽略的:①若sid不存在且攻击者获得sid的私钥.②若sid不存在且攻击者获得sid的临时密钥.③若sid存在且攻击者同时获得sid和sid的④若sid存在且攻击者同时获得sid和sid的⑤若sid存在且攻击者同时获得sid的私钥临时密钥.和sid的临时密钥.AdvABAKA私钥.⑥若sid存在且攻击者同时获得sid的临时密钥和sid的私钥.其中,条件③能够证明协议满足wPFS,条件①、⑤、⑥能够证明协议抵抗KCI攻击,条件②、④能够证明协议抵抗LEK攻击.而ABAKA协议Π在ABCK+模型下是选择安全的,是指攻击者在安全游戏初始阶段预先选择要挑战的sid对应的访问结构和sid对应的访问结构(若sid存在).4协议构造4.1基本思想本文协议借鉴了Lai等人[19]的简洁高效的转化方法将Waters[4]的CPA安全的基于属性加密方案转化为CCA安全的密钥封装方案,该方法在系统公共参数中增加了3个群元素δ1、δ2、δ3,在密文中使用上述群元素生成一个冗余信息,从而使得模拟者在回答攻击者的解密询问时能够使用该冗余信息进行解密.本文协议采用了Okamoto[18]的twisted-PRF技巧,该方法与NAXOS技巧相似,由用户长期私钥和临时密钥共同计算出密钥封装方案的随机数,然而该方法使用了两个伪随机函数代替NAXOS技巧中的杂凑函数,以保证协议既能抵抗LEK攻击,又能够在标准模型下可证安全.Fujioka等人[17]的通用构造方案额外使用了一个CPA安全的密钥封装方案以保证协议满足wPFS,协议发起方计算一个临时公钥,然后协议接收方使用该公钥计算出密钥封装方案的密文并返回给发起方,因此该协议需要运行两轮.本文在协议中增加了一次临时的Diffie-Hellman交换,在安全性证明时将困难问题嵌入到上述交换中,从而能够证明协议满足wPFS,且该协议只需运行一轮.4.2具体实现系统建立.选择阶为大素数p的群G、GT,记g为G的一个生成元,e:G×G→GT是双线性映射.系统选择一个抗碰撞杂凑函数H:{0,1}→p,一个强随机提取器Ext(s,·),其中s是在种子空间随机选择的种子.同时选择以下3个伪随机函数:其中Kspace是伪随机函数的密钥空间.令系统中属性个数为m,随机选择α,β∈p,令w=gβ.随机选择h1,…,hm,δ1,δ2,δ3∈G,则系统的主密钥为MSK=α,公开参数为Page5PK=(e(g,g)α,h1…hm,w,δ1,δ2,δ3).用户私钥抽取.该过程为属性集合为SU的用户U产生私钥.系统随机选择r∈p,对任意x∈SU,计算KUx,3=hrx,并计算KU,1=gαgβr,KU,2=gr,同时在伪随机函数的密钥空间中随机选择密钥σU∈Kspace.最终计算用户私钥:SKU=(KU,1,KU,2,{KUx,3}x∈SU,σU).密钥交换.假设协议的参与方为A和B,其中A的属性集合为SA,私钥为SKA,B的属性集合为SB,私钥为SKB.A和B分别指定访问结构AAA和AAB,并分别发送消息memA和memB给对方,若双方属性均满足对方指定的访问结构即SA∈AAB,SB∈AAA,则A和B都能计算出共同的会话密钥KAB,具体过程如下:(1)A指定对方需要满足的访问结构AAA,其对应的访问控制矩阵为((犕A)lA×nA,ρA).A随机选取向量狊A=(xA,sA,2,…,sA,nA)T∈狊A=(xA,sA,2,…,sA,nA)T,其中xA=FσA(xA)FxA(σA),对i∈{2,…,nA}计算sA,i=FσA(sA,i)FsA,i(σA).A随机选取dA,yA,tA,1,tA,2,…,tA,lA∈p,对i∈{1,…,lA}计算tA,i=FσA(tA,i)FtA,i(σA).然后A计算分享向量(λA,1,λA,2,…,λA,lA)T=犕A狊A,并计算CA,1=gxA,CA,2=gyA,对i∈{1,…,lA},计算CAi,1=gβλA,ih-tA,igtA,i,最后A计算CA,3=(δcA1δdAcA=H(犕A,CA,1,CA,2,{CAi,1,CAi,2}i∈{1,…,lA}).A发送给B消息为(2)B指定对方需要满足的访问结构AAB,其对应的访问控制矩阵为((犕B)lB×nB,ρB).B随机选取向量狊B=(xB,sB,2,…,sB,nB)T∈狊犅=(xB,sB,2,…,sB,nB)T,其中xB=FσB(xB)FxB(σB),对i∈{2,…,nB}计算sB,i=FσB(sB,i)FsB,i(σB).B随机选取dB,yB,tB,1,tB,2,…,tB,lB∈p,对i∈{1,…,lB}计算tB,i=FσB(tB,i)FtB,i(σB).然后B计算分享向量(λB,1,λB,2,…,λB,lB)T=犕B狊B,并计算CB,1=gxB,CB,2=gyB,对i∈{1,…,lB},计算CBi,1=gβλB,ih-tB,igtB,i,最后B计算CB,3=(δcB1δdB2δ3)xB,其中B发送给A消息为cB=H(犕B,CB,1,CB,2,{CBi,1,CBi,2}i∈{1,…,lB}).(3)A获取消息memB后,假定A的属性满足B指定的访问结构,即SA∈AAB,令IA={i:ρB(i)∈SA}为授权的属性集合,因此A可以得到恢复系数{μA,i∈p}i∈IA使∑i∈IAe(g,CB,3)=e(CB,1,δcB1δdB2δ3)是否成立,其中cB=H(犕B,CB,1,CB,2,{CBi,1,CBi,2}i∈{1,…,lB}),若上式不成立,则返回⊥;否则A计算:θ1=e(g,g)αxA,θ2=∏i∈IA,x=ρB(i)=e(gαgβr,gxB)∏i∈IA=e(g,g)αxB,θ3=e(CB,2,w)yA=e(g,w)yAyB.同理,B获取消息memA后,假定B的属性满足A指定的访问结构即SB∈AAA,令IB={i:ρA(i)∈SB}为授权属性集合,因此B可以得到恢复系数{μB,i∈p}i∈IB使∑i∈IBe(g,CA,3)=e(CA,1,δcAH(犕A,CA,1,CA,2,{CAi,1,CAi,2}i∈{1,…,lA})若上式不成立,则返回⊥;否则B计算:θ1=∏i∈IB,x=ρA(i)=e(gαgβr,gxA)∏i∈IB=e(g,g)αxA,θ2=e(g,g)αxB,θ3=e(CA,2,w)yB=e(g,w)yAyB.A和B计算出相同的θ1、θ2、θ3后,通过随机提取器计算:θ1=Ext(s,θ1),θ2=Ext(s,θ2),θ3=Ext(s,θ3)令会话id为sid=(memA,memB),最后双方计算共同的会话密钥为KAB=Gθ1(sid)Gθ2(sid)Gθ3(sid).5协议安全性与性能分析5.1安全性证明定理1.若定义4中的DPBDHE假设成立,且F,F,G是伪随机函数,Ext(s,·)是一个强随机Page6提取器,则上述协议在ABCK+模型中是安全的.证明.在ABCK+模型定义的安全游戏中,假设攻击者至多激活N个协议实体,每个实体至多激活L个会话,令sid表示Test阶段攻击者要挑战的测试会话,实体A为该会话的拥有者,实体B为其匹配会话sid的拥有者,Suc表示攻击者赢得该游戏,则以下6种情况覆盖了攻击者的所有行为:(1)情况E1:若sid不存在且攻击者获得sid的私钥.(2)情况E2:若sid不存在且攻击者获得sid的临时密钥.(3)情况E3:若sid存在且攻击者同时获得sid和sid的私钥.(4)情况E4:若sid存在且攻击者同时获得sid和sid的临时密钥.(5)情况E5:若sid存在且攻击者同时获得sid的私钥和sid的临时密钥(6)情况E6:若sid存在且攻击者同时获得sid的临时密钥和sid的私钥.其中,情况(3)能够证明协议满足wPFS,(1)、(5)、(6)能够证明协议抵抗KCI攻击,(2)、(4)能够证明协议抵抗LEK攻击.以下分别证明协议在各种情况下的安全性:Game0.该游戏与实际的安全性游戏一致,因(1)Pr[E1∧Suc]是可忽略的.我们使用一系列攻击游戏证明攻击者在这种情况下的优势是可忽略的.令AdvABAKA者在游戏k中的攻击优势.此攻击者的优势AdvABAKA际协议的优势.Game1.该游戏与Game0的区别在于,若两个不同的会话拥有相同的会话id,即两个不同会话的协议双方以及协议双方产生的消息完全相同,则游戏终止.这种情况发生的概率相当于随机选择两个随机数发生碰撞的概率,因此使用下式表示攻击者在Game1和Game0中的优势是等价的,即两者差异是可忽略的(negl)Game2.该游戏与Game1的区别在于,游戏开始选择协议通信方A,并随机选择一个整数i∈[1,L],若攻击者选择的测试会话是通信方A进行的第i次会话则游戏继续,否则游戏终止.由于攻击者选择的测试会话满足上述条件的概率为1因此AdvABAKAGame3.在该游戏中,使用一个真随机函数RF(·)代替测试会话中的伪随机函数F,除此以外,Game3和Game2相同.若AdvABAKA(2)是不可忽略的,则可以构造一个多项AdvABAKA式时间的区分者能够以不可忽略的概率区分伪随机函数F和真随机函数RF.按照下述步骤模拟安全性游戏:Setup.设置系统主密钥以及所有用户的私钥.接下来,按如下方式生成通信方A的第i次会话的消息memA.令A指定对方需要满足的访问结构为AAA,其对应的访问控制矩阵为((犕A)lρA).随机选取向量狊A=(xA,sA,2,…,sp,并计算向量狊A=(xA,sA,2,…,sA,nnA中xA=FσA(xA)F(σA),对i∈{2,…,nA}计算sA,i=FσA(sA,i)F(σA).随机选取dA,yA,tA,1,tA,2,…,tFσA(tA,i)F(σA).然后计算分享向量(λA,1,λA,2,…,λA,lgyCAi,2=gtcA=H(犕A,CA,1,CA,2,{CAi,1,CAi,2}i∈{1,…,l输出A发送给B消息为A,对i∈{1,…,lA},计算CAi,1=gβλSimulation.用列表记录对会话密钥的询问KeyReveal,然后按照协议规范和安全性游戏规则进行如下模拟:①Send(I,SP,S珚P):若I=A,且该会话是A的第i次会话,则返回在Setup阶段计算的memA,否则依据协议规范进行响应,并记录(SP,S珚P,memP).②Send(R,S珚P,SP,memP)和Send(I,S珚P,SP,mem珚P):依据协议规范计算出会话密钥K并返回,将会话密钥K加入列表,并记录所有的会话状态,标记(SP,S珚P,memP,mem珚P)为已完成会话.③KeyReveal(sid):若会话sid已完成则返回其在列表中对应的会话密钥K,若会话未完成则返回终止符号⊥.④StateReveal(sid):若会话sid未完成则返回记录的该会话的所有内部状态信息,若会话已完成Page7则返回终止符号⊥.用户私钥SKU.钥K并返回给攻击者.⑤Corrupt(U,SU):返回Setup阶段生成的⑥Test(sid):依据协议规范计算出会话密⑦如果输出猜测b=0,则输出F为伪随若F=F,模拟的安全性游戏与Game2相同;若F=RF,则模拟的安全性游戏与Game3相同.若AdvABAKA的,则能够以不可忽略的优势区分伪随机函数F和真随机函数RF.因此机函数F,否则输出F为真随机函数RF.Game4.在该游戏中,随机选择θ1∈GT代替测试会话中计算的θ1=e(g,g)αx和Game3相同.若AdvABAKA是不可忽略的,则可以构造一个多项式时间的挑战者能够以不可忽略的优势解决定义4中的困难问题.假定测试会话中通信方A的意定通信伙伴为B,按照下述步骤模拟安全性游戏:Init.运行攻击者,输出测试会话中要挑战的访问结构AA阵为((犕A)lSetup.首先,生成系统公开参数.随机选择α,z1,z2,…,zm∈p并隐含设置主密钥α=α+aq+1,则可以计算e(g,g)α=e(ga,gaq)e(g,g)α.令w=ga,对任意的1jm,令集合I表示所有ρA(i)=j的集合,若I=,则令hj=gzj;若I≠,则令hj=gzj∏i∈I随机选择d2,d3,e1,e2,e3∈p,并计算其它公开参数:输出系统的公开参数:δ1=gaqge1,δ2=gaqd2ge2,δ3=gaqd3ge3.PK=(e(g,g)α,h1…hm,w,δ1,δ2,δ3).接下来,为属性集合为SU的用户U产生私钥.由定义7中新鲜性的定义知,攻击者不能对满足访问结构AAU的属性集合不能满足访问结构AA则存在一个向量ω=(ω1,ω2,…,ωnω1=-1,对ρA(i)∈SU,有犕A(i)·ω=0.S在伪随机函数的密钥空间中随机选择密钥σU∈Kspace,同时随机选择r∈p,并令r=r+ω1aq+…+ωnAaq+1-n以及KU,1=gαgβr=gα+aq+1g对任意的x∈SU,令集合I表示所有ρA(i)=x集合.若I=,则可以计算KUx,3=hrx=(KU,2)zx,若I≠,由于犕A(i)·ω=0,则可以计算:KUx,3=hrx=(gr)zx∏i∈I∏1kn=(KU,2)zx∏i∈I∏1kn因此能够模拟用户私钥:A最后,按如下方式生成通信方A的第i次会话的消息memA.S令CA,1=gs,随机选取sA,2,sA,3,…,A∈p并隐含设置向量狊A=(s,sa+sA,2,…,sA,nsanA-1+sA,n犕A狊A计算分享向量得λA,i=∑1jn∑2jn犕sbi,计算:CAi,1=gaλ=∏1jn(∏k∈I∏1jn(=∏2jnCAi,2=gt随机选取yA∈p,计算CA,2=gyH(犕A,CA,1,CA,2,{CAi,1,CAi,2}i∈{1,…,ldA=-(cA+d3)/d2,从而可以计算:CA,3=(δcA=((gaqge1)c=(gs)e1cmemA=((犕A,ρA),CA,1,CA,2,CA,3,生成的通信方A的消息为Page8Simulation.用列表记录对会话密钥的询问KeyReveal,然后按照协议规范和安全性游戏规则进行如下模拟:①Send(I,SP,S珚P):若I=A,且该会话是A的第i次会话,则返回在Setup阶段计算的memA,否则依据协议规范进行响应,并记录(SP,S珚P,memP).②Send(R,S珚P,SP,memP)和Send(I,S珚P,SP,mem珚P):依据协议规范将获取的消息memP解析为memP=((犕P,ρP),CP,1,CP,2,CP,3,假定S珚P满足访问结构(犕P,ρP),计算cP=H(犕P,CP,1,CP,2,{CPi,1,CPi,2}i∈[1,…,lP]),判断e(g,CP,3)=e(CP,1,δcP1δdP2δ3)是否成立,若该式不成立则返回终止符号⊥,否则判断cP+dPd2+d3=0是否成立,若成立则模拟失败,否则计算:θ1=e(g,CP,1)αeCP,3=e(g,g)αxP(egaqcP+e1cPgaqd2dP+e2dPgaqd3+e3(ga)1=e(g,g)(α+aq+1)xP.依据协议规则能够计算出θ2、θ3,因此能够计算出会话密钥K并返回,并将会话密钥K加入列表,记录所有的会话状态,标记(SP,S珚P,memP,mem珚P)为已完成会话.③KeyReveal(sid):若会话sid已完成则返回其在列表中对应的会话密钥K,若会话未完成则返回终止符号⊥.④StateReveal(sid):若会话sid未完成则返回记录的该会话的所有内部状态信息,若会话已完成则返回终止符号⊥.户私钥SKU.⑤Corrupt(U,SU):返回Setup阶段生成的用⑥Test(sid):令θ1=e(g,gs)αe(ga,gaq)xθ2、θ3计算出会话密钥K并返回给攻击者.⑦如果输出猜测b,输出b.首先分析挑战者模拟失败的概率,当cP+dPd2+d3=0时模拟失败,该等式成立的概率至多为1/p,从而挑战者模拟失败的概率为qD/p,其中qD为攻击者执行Send(R,S珚P,SP,memP)、Send(I,S珚P,SP,mem珚P)查询的次数,而qD/p在信息论中是可忽略的,因此挑战者模拟失败的概率是可忽略的.若=e(g,g)saq+1,则模拟的安全性游戏与Game3相同,若是随机选择的,则模拟的安全性游戏与Game4相同.若AdvABAKA可忽略的,则能够以不可忽略的优势解决定义4中定义的DPBDHE困难问题.因此若AdvABAKAGame5.在该游戏中,从强随机提取器的值域空间随机选择θ1代替测试会话中计算的θ1=Ext(s,θ1),除此以外,Game5和Game4相同.由于在Game4中θ1是随机选择的,θ1有足够的最小熵.因此,由强随机提取器的定义,(5)-AdvABAKAAdvABAKAGame6.在该游戏中,从伪随机函数的值域空间随机选择γ,并使用K=γGθ代替测试会话K=Gθ3(sid),除此以外,Game6与Game5相同.Gθ的,则可以构造一个多项式时间的区分者能够以不可忽略的概率区分伪随机函数G和一个真随机函数RF.按照下述步骤模拟安全性游戏:Setup.设置系统主密钥以及所有用户的私钥.Simulation.用列表记录对会话密钥的询问KeyReveal,然后按照协议规范和安全性游戏规则进行如下模拟:①Send(I,SP,S珚P):依据协议规范计算memP并返回,同时记录(SP,S珚P,memP).②Send(R,S珚P,SP,memP)和Send(I,S珚P,SP,mem珚P):依据协议规范计算出会话密钥K并返回,将会话密钥K加入列表,并记录所有的会话状态,标记(SP,S珚P,memP,mem珚P)为已完成会话.③KeyReveal(sid):若会话sid已完成则返回其在列表中对应的会话密钥K,若会话未完成则返回终止符号⊥.④StateReveal(sid):若会话sid未完成则返回记录的该会话的所有内部状态信息,若会话已完成则返回终止符号⊥.用户私钥SKU.2(sid)GθGθ机函数G,否则输出F为真随机函数RF.⑤Corrupt(U,SU):返回Setup阶段生成的⑥Test(sid):计算会话密钥K=F(sid)⑦如果输出猜测b=0,则输出F为伪随Page9若F=G,则模拟的安全性游戏与Game5相同;若F=RF,则模拟的安全性游戏与Game6相同.若AdvABAKA的,则能够以不可忽略的优势区分伪随机函数G和真随机函数RF.因此在Game6中,测试会话中的会话密钥是完全随机的,攻击者的优势是可忽略的,即AdvABAKA因此Pr[E1∧Suc]可忽略.(3)-AdvABAKA(2)Pr[E2∧Suc]是可忽略的.E2∧Suc与E1∧Suc的证明基本相同,不同点在于Game3.在E1∧Suc中,Game3使用一个真随机函数RF(·)代替测试会话中的伪随机函数F.而在E2∧Suc中,Game3使用一个真随机函数RF(·)代替测试会话中的伪随机函数F,若AdvABAKA以采用E1∧Suc中相似的方法构造一个多项式时间的区分者能够以不可忽略的概率区分伪随机函数F和真随机函数RF.因此Pr[E2∧Suc]可忽略.(3)Pr[E3∧Suc]是可忽略的.我们使用一系列攻击游戏证明攻击者在这种情况下的优势是可忽略的.令AdvABAKA者在游戏k中的攻击优势.Game0.该游戏与实际的安全性游戏一致,因此攻击者的优势AdvABAKA际协议的优势.Game1.该游戏与Game0的区别在于,若两个不同的会话拥有相同的会话id,即两个不同会话的协议双方以及协议双方产生的消息完全相同,则游戏终止.这种情况发生的概率相当于随机选择两个随机数发生碰撞的概率,因此Game2.该游戏与Game1的区别在于,游戏开始选择协议通信方A及其意定的通信伙伴B,并随机选择一个整数i∈[1,L],若攻击者选择的测试会话是通信方A进行的第i次会话且其通信伙伴为B,则游戏继续;否则游戏终止.由于攻击者选择的测试会话满足上述条件的概率为1AdvABAKAGame3.在该游戏中,随机选择θ3∈GT代替测试会话中计算的θ3=e(g,w)y和Game2相同.若AdvABAKA不可忽略的,则可以构造一个多项式时间的挑战者能够以不可忽略的优势解决定义4中的困难问题.按照下述步骤模拟安全性游戏:Init.运行攻击者,输出要挑战的两个访问结构AA矩阵分别为((犕A)lSetup.随机选择α∈p,同时隐含设置β=s,因此w=gs.随机选择h1,…,hm,δ1,δ2,δ3∈G,则系统的主密钥为MSK=α,公开参数为PK=(e(g,g)α,h1…hm,w,δ1,δ2,δ3).可以使用主密钥生成所有用户的私钥.按照如下方式生成测试会话中通信双方A和B之间的消息memA和memB,测试会话是A进行的第i次会话.首先令CA,2=ga,CB,2=gaq,其它消息都按照协议规则生成.即随机选取向量狊A=(xA,sA,2,…,ssA,2,…,s对i∈{2,…,nA}计算sA,i=FσA(sA,i)Fs随机选取dA,tA,1,tA,2,…,tlA}计算tA,i=FσA(tA,i)Ft量(λA,1,λA,2,…,λ同时对i∈{1,…,lA},计算CAi,1=gβλCAi,2=gtcA=H(犕A,CA,1,CA,2,{CAi,1,CAi,2}i∈{1,…,l输出A发送给B消息为同理可计算memB,随机选取向量狊B=(xB,sB,2,…,sB)T∈sB,n{2,…,nB}计算sB,i=FσB(sB,i)Fs取dB,tB,1,tB,2,…,t算tB,i=FσB(tB,i)Ft(λB,1,λB,2,…,λ时对i∈{1,…,lB},计算CBi,1=gβλCBi,2=gtcB=H(犕B,CB,1,CB,2,{CBi,1,CBi,2}i∈{1,…,l输出B发送给A消息为Page10Simulation.用列表记录对会话密钥的询问KeyReveal,然后按照协议规范和安全性游戏规则进行如下模拟:①Send(I,SP,S珚P):若I=A,且该会话是A的第i次会话,则返回在Setup阶段计算的memA,否则依据协议规范进行响应,并记录(SP,S珚P,memP).②Send(R,S珚P,SP,memP)和Send(I,S珚P,SP,mem珚P):依据协议规范计算出会话密钥K并返回,将会话密钥K加入列表,并记录所有的会话状态,标记(SP,S珚P,memP,mem珚P)为已完成会话.③KeyReveal(sid):若会话sid已完成则返回其在列表中对应的会话密钥K,若会话未完成则返回终止符号⊥.④StateReveal(sid):若会话sid未完成则返回记录的该会话的所有内部状态信息,若会话已完成则返回终止符号⊥.户私钥SKU.⑤Corrupt(U,SU):返回Setup阶段生成的用⑥Test(sid):计算θ1=e(g,g)αxe(g,g)αx密钥K并返回给攻击者.⑦如果输出猜测b,输出b.若=e(g,g)saq+1,则模拟的安全性游戏与Game2相同;若是随机选择的,则模拟的安全性游戏与Game3相同.若AdvABAKA不可忽略的,能够以不可忽略的优势解决定义4中的困难问题.因此Game4.在该游戏中,从强随机提取器的值域空间随机选择θ3代替测试会话中计算的θ3=Ext(s,θ3),除此以外,Game4和Game3相同.由于在Game3中θ3是随机选择的,θ3有足够的最小熵.因此,由强随机提取器的定义,(4)-AdvABAKAAdvABAKAGame5.在该游戏中,从伪随机函数的值域空间随机选择γ,并使用K=Gθγ代替测试会话K=Gθ3(sid),除此以外,Game5与Game4相同.Gθ若AdvABAKA的,则可以构造一个多项式时间的区分者能够以不可忽略的概率区分伪随机函数G和一个真随机函数RF.按照下述步骤模拟安全性游戏:Setup.设置系统主密钥以及所有用户的私钥.Simulation.用列表记录对会话密钥的询问KeyReveal,然后按照协议规范和安全性游戏规则进行如下模拟:①Send(I,SP,S珚P):依据协议规范计算memP并返回,同时记录(SP,S珚P,memP).②Send(R,S珚P,SP,memP)和Send(I,S珚P,SP,mem珚P):依据协议规范计算出会话密钥K并返回,将会话密钥K加入列表,并记录所有的会话状态,标记(SP,S珚P,memP,mem珚P)为已完成会话.③KeyReveal(sid):若会话sid已完成则返回其在列表中对应的会话密钥K,若会话未完成则返回终止符号⊥.④StateReveal(sid):若会话sid未完成则返回记录的该会话的所有内部状态信息,若会话已完成则返回终止符号⊥.⑤Corrupt(U,SU):返回Setup阶段生成的用户私钥SKU.⑥Test(sid):计算会话密钥K=Gθ2(sid)F(sid)并返回给攻击者.Gθ⑦如果输出猜测b=0,则输出F为伪随机函数G,否则输出F为真随机函数RF.若F=G,则模拟的安全性游戏与Game4相同;若F=RF,则模拟的安全性游戏与Game5相同.若AdvABAKA则能够以不可忽略的优势区分伪随机函数G和真随机函数RF.因此在Game5中,测试会话中的会话密钥是完全随机的,攻击者的优势是可忽略的,即AdvABAKA因此Pr[E3∧Suc]可忽略.(4)Pr[E4∧Suc]是可忽略的.E4∧Suc与E2∧Suc的证明相同,在E2∧Suc中,由于没有匹配会话sid,攻击者能够设置任意的临时密钥,相当于在E4∧Suc中获取了sid的临时密钥,因此E4∧Suc与E2∧Suc证明相同,即可证明Pr[E4∧Suc]可忽略.(5)Pr[E5∧Suc]是可忽略的.E5∧Suc与E1∧Suc的证明相同,在E1∧Suc中,由于没有匹配会话sid,攻击者能够设置任意的临时密钥,相当于在E5∧Suc中获取了sid的临时密钥,因此E5∧Suc与E1∧Suc证明相同,即可证明Pr[E5∧Suc]可忽略.Page11(6)Pr[E6∧Suc]是可忽略的.由于协议中通信双方的地位相同,因此E6∧Suc与E5∧Suc的证明相同,即可证明Pr[E6∧Suc]可忽略.综合以上6种情况下Pr[Ei∧Suc]i={1,…,6}均是可忽略的,则有Pr[Suc]是可忽略的,因此定理1得证.5.2安全性与通信效率比较本节将本文所提协议与已有的支持通用认证策略的基于属性的认证密钥协商协议进行比较,其中文献[11]中的协议采用文献[6]中的基于属性的签名方案.在比较协议通信效率时,l和n分别表示访问控制矩阵的行数和列数,sig和vk分别表示一次表1安全性质与通信效率比较文献[10]中协议文献[11]中协议文献[12]中协议6结束语本文借鉴了Fujioka等人[17]的思想,并采用Lai等人[19]简洁高效的转化方法将Waters[4]的CPA安全的基于属性的加密方案转化为CCA安全的密钥封装方案,在此基础上提出了一个在标准模型和CK+模型下可证安全的基于属性的认证密钥协商协议.该协议满足弱的完美前向安全性并能够抵抗密钥泄露伪装攻击和临时密钥泄露攻击.相比于现有的基于属性的认证密钥协商协议,本文协议具有更高的通信效率和更强的安全性,更适于在实际的系统中应用.
