Page1多变量公钥密码扩展方案的安全性分析聂旭云1),2),4)徐赵虎1),2)廖永建1),2),3)钟婷1),2)1)(电子科技大学计算机科学与工程学院成都611731)2)(网络与数据安全四川省重点实验室成都611731)3)(上海市信息安全综合管理技术研究重点实验室上海200240)4)(中国科学院信息工程研究所信息安全国家重点实验室北京100093)摘要扩展的多变量公钥密码方案(ExtendedMultivariatePublicKeyCryptosystem,EMC)是Wang等人在2011年提出的一种新的增强多变量公钥加密体制安全性的方法,其核心是在加密之前先对明文变量进行一次基于杂凑函数的驯顺变换(Hash-basedTameTransformation,简称HT变换)处理.Wang等人将EMC方法和加方法相结合构造出了多变量加密方案HTTP(Hash-basedtameandplus).作者声称HTTP方案可以抵挡现有的对多变量公钥密码体制的攻击.文中对EMC方案和HTTP加密方案进行了安全性分析,分析结果表明EMC方案并没有真正增强原始多变量公钥密码体制的安全性.如果存在一种攻击方法可恢复原始的多变量公钥加密体制的合法密文对应的明文,那么同样可以恢复增强后的加密方案的合法密文对应的明文.计算机实验表明,我们的攻击是有效的.关键词多变量公钥密码;扩展方案;线性化方程;HT变换1引言多变量公钥密码(MPKC)是利用有限域上多变量多项式构造出的公钥密码方案.MPKC的安全性基于求解有限域上随机生成的多变量多项式方程组问题的困难性,这是一个NP-困难问题.目前还没有发现在量子计算机上多项式时间内求解该困难问题的算法.另外,由于MPKC的运算都是在较小的有限域上进行,故运算效率非常高,因而多变量公钥密码方案被认为是一种传统公钥密码的替代方案.目前已经构造出了很多种多变量公钥密码方案,但大部分的MPKC方案都存在着安全性漏洞.因此人们提出了多种安全性增强的方法,来改进现有体制的安全性.目前主要的安全性增强方法有减方法[1]、醋变量方法[2]、内部扰动方法[3]以及噪声扰动[4]方法等.SFLASH[5]是减方法的代表方案之一,在2003年被欧洲NESSIE密码计划接受用于低耗智能卡的推荐算法①.在2007年,Dubois等人[6]利用差分攻击成功地伪造了SFLASH签名体制的合法签名.醋变量方法是Patarin等人根据油醋签名体制的思想提出来的一种扰动方案.这种方法增强了原体制的安全性.Ding等人[7]分析了HFEv(HiddenFieldEquation-vinegar)体制,可将醋变量的扰动效果消除,使其与扰动前的HFE体制[8]的安全性相同.内部扰动是Ding在2004年提出来的一种扰动方法,并将其应用于对MI[9](Matsumoto-Imai)和HFE两种加密体制的扰动,用于增强这两种体制的安全性.这种扰动可以避免原体制的一些弱点,比如将其应用于MI体制后,消除了MI体制中存在的线性化方程.但MI体制和HFE体制的内部扰动在提出后不久被Fouque和Dubois等人[10-11]利用差分攻击给破解了.Wang等人[4]在2010年给出了一种噪声扰动方案.他们引入了一种噪声运算对多变量公钥密码体制进行扰动,并声称扰动后的体制能增强体制的安全,可抵挡差分攻击.孙思维等人对该方案进行了分析,针对文献中提出的实例pSFLASH,在几秒钟的时间内可以实际地伪造出任意消息的合法的pSFLASH签名[12].扩展的多变量公钥密码方案(ExtendedMultivariatepublickeyCryptosystems,EMC)[13]是Wang等人2011年提出的一种多变量公钥密码体制的安全性增强方案,其核心是在加密之前先对明文分量进行一次HT变换处理,然后再用原始的多变量密码方案进行加密,其目的是消除原有体制的安全性弱点,如线性化方程等.EMC的提出者根据这种方法,构造出了HTTP加密方案,并声称可以抵抗现有的攻击,但是通过分析可知,EMC方法并没有真正增强原始多变量公钥密码体制的安全性.本文对EMC加密方案进行了分析,分析发现如果存在一个算法能找到原始体制的合法密文相应的明文,那么对于EMC方案,同样可以找到合法密文相应的明文.随后,本文对以MI体制作为原始体制的HTTP方案进行了分析.分析结果表明,HTTP体制并没有消除原MI体制中存在的线性化方程,因此,可结合线性化方程攻击,成功地恢复合法密文相应的明文.本文第2节简单介绍EMC方案以及HTTP体制构造的思想;第3节给出EMC加密方案的安全性分析;在第4节给出HTTP体制的分析;最后给出本文的结论.2扩展的多变量公钥密码方案(EMC)多变量公钥密码(MultivariatePublicKey令Fq是一个q元有限域,n和m是正整数,TCryptosystem,MPKC)的一般形式如下:和U分别是Fn换.取映射F为一个从Fn性映射.令Y=(y1,…,ym)=P(x1,…,xn)=TFU(x1,…,xn),其中P是一个从Fn成有限域Fq上m个n元多项式,其最高次数等于F的次数.在多变量公钥密码系统中,P的表达式为公钥,它是一组多变量多项式,而私钥为T和U.多变量公钥密码设计的关键在于构造中心映射F.F的表达式可以公开,也可以保密.为了节省公钥多项式的存储,中心映射和公钥多项式通常选取为最简单的非线性函数即二次函数.2.1EMC的主要思想在EMC方案,m=n.EMC方案的核心思想是引入了一个基于Hash函数的变换,称作HT变换.该变换将n个明文变量扩充为n+δ个变量,以期望能消除原体制的弱点,增加原体制的安全性.Fq上的n+δ维和n维向量空间.HT变换描述如下:设Fn+δ①NESSIE.EuropeanprojectIST-1999-12324onNewEuro-Page3定义L:Fn+δh1烄烌烄hn-烆烎δ烅hn-δ+1烄h烎n烆烆其中,δ表示扩展变量的个数,α1是n-δ维的向量,α2是δ维的向量,犃是(n-δ)×(n-δ)的可逆矩阵,犇是δ×δ的对角可逆矩阵,犅是任意的δ×(n-δ)的矩阵,xn+i(1iδ)为扩展变量,其定义为其中H为安全Hash函数,Hk表示提取函数值中的前k个位值.容易看出,这里L是容易求逆的.利用上面的HT变换,就可以构造出EMC方案,其公钥表示为珚P=(p-EMC方案的公钥为珚P中包含的n个二次方程p-i=1,…,n,私钥为L-1,U-1,T-1,F-1.2.2HTTP多变量加密方案HTTP加密方案就是把上述的EMC方案和“+”方法结合产生的新的加密方案.将“+”方法用到EMC方案中,就是随机地确定μ(0μ<n)个二次多项式加入到EMC的中心映射之中.记添加μ个二次多项式之后得到这样,就得到了HTTP多变量加密方案珚P+(x1,…,xn+δ)=T+珚F+=(p-+此时,该方案中T+为(n+μ)×(n+μ)的可逆仿射变换.公钥:珚P+对应的n+μ个二次多项式;私钥:L-1,U-1,T-1+和F-1.(1)加密给定任一明文狓=(x1,…,xn)∈Fnxn+i=Hk(x1‖x2‖…‖xn-δ+i-1),1iδ.然后计算这样就得到了一个合法密文.狔=(y1,…,yn+μ)=珚P+(x1,…,xn+δ).(2)解密给定密文狔=(y1,…,yn+μ),需要依照下面步骤进行解密:删掉最后μ个变量,得到(t1,…,tn);①计算(v1,…,vn+μ)=T-1②计算(z1,…,zn)=珚F-1(v1,…,vn);③计算(h1,…,hn)=U-1(z1,…,zn);④计算(x1,…,xn)=L-1(h1,…,hn).这样就得到了密文狔=(y1,…,yn+μ)相应的明文(x1,…,xn).3EMC密码体制的安全性分析本节以EMC加密体制为例进行分析.如果对于原始的加密体制来说,存在某个算法A,使得对于给定的公钥,在不知道私钥的情形下可以求得合法密文相应的明文,那么对原始方案采用EMC的方法进行改进后的体制,同样可以在不知道私钥的情形下求得合法密文相应的明文.EMC多变量方案中的HT变换L实际上是一个仿射变换,用矩阵表示之后其形式如下:这里,犐为δ×δ单位矩阵,犗为零矩阵.虽然L中的犃犗犗()犅犐犇不是方阵,但是由于其特殊设计以及扩展变量xn+1,…,xn+δ与明文变量x1,…,xn之间的Hash关系,使得L容易求逆,只不过L的逆映射并不是仿射变换,需要通过迭代来实现.在EMC方案中公钥为虽然珚P的输入为(x1,…,xn+δ),但是EMC方案中加密之后得到的密文是由x1,…,xn唯一确定的.命题1.在EMC的公钥表达式中,令所有的包含xn+1,…,xn+δ的项为0,那么所得到的多项式组恰好是在公钥生成过程中令矩阵犇为零矩阵所生成的多项式组.这一命题我们通过计算机实验得到了验证.设L为当L中的矩阵犇为零矩阵时的映射,即L=Page4L对应的矩阵变换为由于犃为可逆矩阵,所以L为可逆仿射变换.用L代替EMC中的L,可得到另外一个加密方案,其公钥为与珚P不同的是,珚PL的表达式中没有包含xn+1,…,xn+δ的项,并且在取相同参数的情况下,把珚P公钥表达式中的包含xn+1,…,xn+δ的项都设为0,就可得到珚PL的公钥表达式.由于U、L都是可逆的仿射变换,故UL也是可逆仿射变换,所以珚PL等价于用UL替换原始的公钥密码体制中的U.因此,利用算法A,同样可在不知道私钥的情况下对珚PL求逆.给定合法密文,考虑这个密文分别在两个映射珚P和珚PL下相应的明文之间的关系.给定密文(y1,…,yn)=(y1,…,yn),分别用珚P和珚PL相对应的私钥来进行解密,其惟一的区别在于L和L不同,因此需要分析对于相同的向量,分别利用L和L对其求出的逆元之间的关系.命题2.L和L的如前述所示,设给定(h1,…,hn)=(h1,…,hn),分别利用L和L求逆得到的原像为(x1,…,xn+δ)和(x1,…,xn),则这两组原像存在以下关系:(1)xi=xi,i=1,…,n-δ;(2)xn-δ+i=xn-δ+i-D[i][i]xn+i,i=1,…,δ,其中D[i][i]表示对角矩阵犇的对角线上第i个元素.证明.通过L和L的表达式很容易得到命题中的结论.结合珚P和珚PL表达式,根据命题2的结论,可以得出珚P生成过程中所使用的矩阵犇.任意选择一个明文狓=(珟x1,…,珟xn),计算其在映射珚P下对应的密文狔=(珘y1,…,珘yn).然后利用算法A求出狔=(珘y1,…,珘yn)在珚PL映射下对应的明文(x≈1,…,x≈D[i][i]=(珟xn-δ+i-x≈n-δ+i)珟x-1n+i,i=1,…,δ.这样就恢复了对角矩阵犇.在得到珚PL的表达式和对角矩阵犇后,可通过以下步骤恢复合法密文相应的明文,具体如下所示:给定EMC的一个合法密文狔=(y1,…,yn),求其相应的明文狓=(x1,…,xn).映射下对应的明文(x1,…,xn).根据命题2有其次,计算xn+i=Hk(x1‖x2‖…‖xn-δ+i-1),1iδ.最后,计算xn-δ+i=xn-δ+i-D[i][i]xn+i,i=1,…,δ.这样,就恢复了密文狔=(y1,…,yn)对应的明文狓=(x1,…,xn).4HTTP加密方案的分析HTTP加密方案是对EMC方案进行了“加”方法的处理,但是如果原体制存在线性化方程,“加”方法并不能消除这些线性化方程,也就是说如果EMC中存在线性化方程,那么应用“加”方法处理之后,HTTP中的线性化方程依然存在,并且线性化方程的个数保持不变[14].本节以文献[13]给出的HTTPv1为例,进行相应的破解和计算机实验验证.HTTPv1的参数如下,设K=Fq是一个q元有限域,q是某个素数的方幂,E为K的n次扩域,取n=20,q=28,θ=4,δ=17,μ=6,其原始中心映射为MI体制的中心映射,即其中V,Z为E中的元素.定义π:E→Kn为K-线性同构,即取E在K的上的一组基{γ1,…,γn},定义:π(a1γ1+…+anγn)=(a1,…,an),a1,…,an∈K.因此,HTTPv1的加密函数定义为珚P+(x1,…,xn+δ)=T+珚F+(x1,…,xn),其中珚F=πFπ-1UL=(珚f1,…,珚fn),珚F+=(珚f1,…,珚fn,珚fn+1,…,珚fn+μ)为珚F添加μ个二次多项式之后所得.MI体制在1995年被Patarin用线性化方程破解[15],给定合法密文可找到其相应的明文.MI+体制仍然满足线性化方程,其破解复杂度比破解原始的MI体制稍高一些.利用线性化方程攻击方法破解MI体制的复杂度是(n+1)6,破解MI+体制的复杂度是(n+1)3(n+1+μ)3,其中n是明文变量个数,μ是加方法中随机添加的多项式的个数.当n=20,μ=6时,两者的破解复杂度分别约等于227和228.HTTPv1体制实际上是对MI+体制应用EMC方法得到的.它同样满足第3节中的命题1.因此可用第3节的方法来进行破解.我们采用计算机实验来进行实际的破解工作.Page5可以恢复其对应的明文.实验中使用的是普通PC机,工具为Magma.具体步骤和实验结果如下.给定合法密文狔=(y1,…,yn),按照如下步骤(1)获得珚PL.将HTTPv1的公钥珚P+中的包含xn+1,…,xn+δ(2)获取珚PL满足的线性化方程.珚PL实际上等价于一个MI+体制,它满足下列线性化方程:∑20i=1∑26的项设置为0,得到了珚PL.要找到所有的一阶线性化方程等价于找到所有的未知向量(a1,1,…,a20,26,b1,…,b20,c1,…,c26,d)张成的K-线性空间的一组基.令W为该线性空间的维数.方程(3)中的未知系数的个数为20×26+20+26+1=567.因此我们选取600个明文(x1,…,x20),将它们代入珚PL中获得以珚PL为加密函数的密文,将600个明文-密文对代入方程(3)可得到以未知系数为未知数的线性方程组.解这个方程组,我们就可得到W个线性无关的向量,记为{(a(k)j,d(k)),1kW},也就是得到了W个线性无关c(k)的一阶线性化方程.对于HTTPv1体制,实验结果表明W=20.(3)恢复对角矩阵犇.任意选择一个明文狓=(珟x1,…,珟xn),计算其在映射珚P下对应的密文狔=(珘y1,…,珘yn).然后结合步(2)中得到的线性化方程,利用线性化方程攻击方法(具体攻击方法可参见文献[16])求出狔=(珘y1,…,珘yn)在珚PL映射下对应的明文(x≈最后,依次计算D[i][i]=(珟xn-δ+i-x≈n-δ+i)珟x-1n+i,i=1,…,δ.(4)恢复狔=(y1,…,yn)的明文信息.利用线性化方程攻击方法求出狔=(y1,…,yn)在珚PL映射下对应的明文(x1,…,xn).根据命题2有其次,计算xn+i=Hk(x1‖x2‖…‖xn-δ+i-1),1iδ.最后,计算xn-δ+i=xn-δ+i-D[i][i]xn+i,i=1,…,δ.这样,就恢复了密文狔=(y1,…,yn)对应的明文狓=(x1,…,xn).实验结果表明,上述方法成功地找到了合法密文相应的明文.以上计算机实验均在普通PC机上利用Magma软件进行实现,PC机配置为GenuineIntel(R)CPUT2300@1.66GHz,504MBRAM.5结语EMC方案尝试利用现有变量引入新的变量来增强多变量公钥密码体制的安全性.通过本文的分析,可发现该改进方案并没有实际增强原有多变量公钥密码体制的安全性.本文给出了EMC加密方案的安全性分析,并利用计算机实验进行了验证,但是未对这种扩展方案进行改进,同时也未对文献[13]中提出的HTTM数字签名体制进行分析,这是我们未来需要做的工作.
