Page1调和聚类-分类方法在电力负荷预测中的应用窦全胜1),2),3)史忠植1)姜平2)马君华3)1)(中国科学院计算技术研究所智能信息处理实验室北京100190)2)(山东工商学院计算机科学与技术学院山东烟台264005)3)(烟台东方电子信息产业集团公司山东烟台264001)摘要分类和聚类是数据挖掘中两个重要的研究领域,分类需要相关的先验知识,而聚类往往依据某种相似性测度,从数据本身来寻找其内在特征.在电力系统负荷预测过程中,依靠先验知识得到的分类结果与聚类结果之间并不协调.针对这一问题,文中给出了调和矩阵的定义,并在此基础上,提出调和聚类-分类算法,将该方法应用于电力系统负荷预测的样本分类中,实际结果表明,通过文中方法得到的分类结果更加客观和科学,预测结果的可靠性得到了保证.关键词聚类;分类;负荷预测;调和矩阵1引言分类(classification)和聚类(clustering)是数据Page2一簇的样本之间彼此具有较好的相似性,而属于不同簇的样本间应具有足够的差异性.当前,关于这方面的研究很多,文献[1-2]用粒度计算来解决分类问题,随着粒度计算理论本身的不断完善,这些方法也将得到更大的发展.文献[3-4]用演化方法来进行分类规则挖掘,这些算法是数据挖掘与计算智能相结合的产物.文献[5]提出了一种将支持向量机与无监督聚类相结合的新分类算法,并应用于网页分类问题,取得了较好的效果.关于聚类方法,文献[6]做了系统地综述,对当前的聚类方法作了高度概括.所有这些研究都代表了这一领域的最新进展,在此不逐一列举.众所周知,分类需要相关先验知识,最理想的先验知识自然是以下的情形:在特征空间中,异类样本之间有明显的界限,相似性测度较小;而同类样本则聚集成一团,相似性测度较大.从聚类的角度说,先验知识规定的属于一个类别的样本,依照选定的特征空间和相似性测度,也应当聚成一类.然而不幸的是,在绝大多数情况下,都不会达到这种理想境界,常常遇到的情况是领域专家认为应该归为一类的点,往往在特征空间中距离特别远,或者说相似性测度特别小,而那些被认为应分别属于不同类别的样本,却相似性测度较大.换句话说,先验知识极有可能和特征以及相似性测度函数不协调.文献[7]应用粒度理论对这个问题进行了深入的分析,并给出了基于信息粒度原理的分类算法,有较强的理论和实际意义.在电力系统负荷预测的过程中,电力专家先将负荷变化特征分成若干类,然后把预测当日的情况归于某一类,相同类别采用相同的预测模式.这种分类方式依靠于这样的一种假设,即相同类型的负荷曲线的波形是类似的,但是由于造成不同负荷特征的原因非常复杂,领域专家的分类相对笼统,只能大体地反映负荷数据本身所具有的特征.在实际负荷预测过程中,存在这样的情况,即部分领域专家认为属于同一类的负荷曲线却表现出了不同的特征.另一方面,同类影响因素引起的负荷变化特征具有较强的相似性,通常能够聚成一类,然而这里存在的问题是,客观上聚成一类的样本集,领域专家却不能给出它们特征之所以相近的原因,从而无法为具体预测提供前提,使得聚类结果难以直接用于预测.针对上述问题,本文提出调和聚类-分类算法,来保证分类和聚类的一致性,将该方法应用于电力系统负荷预报的样本分类中,取得了较好效果.以下就调和聚类-分类方法加以详细论述.2调和聚类-分类方法设U={x1,x2,…,xk}为样本集合,δ为聚类操作,在δ作用下形成聚类谱系G,在某一粒度[7]下,切割谱系G,将U分割成相互独立的子集,即δ(U)={G1,…,Gm},依靠先验知识对U分类,得到分类C={C1,…,Cn},对于Ci∈C(i=1,2,…,n),都被δ(U)分割成了m个子集,Ci=∪mδ(U)中子集的个数,Cij=Ci∩Gj,为Ci和Gj的交集.定义1.设U为样本空间,δ为聚类操作,在某一粒度下对该聚类谱系进行切割得到G=δ(U)={G1,…,Gm},C={C1,…,Cn}为U依赖先验知识得到的分类.称矩阵Λ={λij}n×m为分类C基于G的调和矩阵.其中,λij=|Cij||Cij|、|Ci|分别表示集合Cij和Ci中元素个数.称矩阵Λ中的每一行犚i(i=1,2,…,n)为调和向量.定义2.在定义1基础上设犚i=(ri1,ri2,…,rim)(i=1,2,…,n)为一调和向量,若存在s个分量使得rij1或多项占优,若向量犚i中只有唯一的rij>1犚i单项占优.若rij使犚i单项占优,且rij>0.8,则称犚i是单项充分占优.理想的情况下,我们期望依靠先验知识得到的分类C与聚类谱系在某一粒度下的切割所得到的聚簇集合大体保持一致,此时调和矩阵Λ为方阵,且每一行犚i都是单项充分占优,此时存在置换矩阵θ,使得Λθ为对角充分占优矩阵,如式(1)所示.而最糟糕的情况是,分类与聚类完全无关,每一个分类Ci中的样本平均分布在δ(U)中,事实上,这两种极端情况都是不容易出现的.本文定义的调和矩阵和一些文献中[8]所述的混淆矩阵(confusionmatrix)密切相关,所谓混淆矩阵是描绘样本数据的真实属性与识别结果之间的关系、评价分类器性能的一种方法.具体定义如下:设Page3给定数据集D={T1,T2,…,Tn}包含N类样本,分类器C的混淆矩阵为其中,cmij表示第i类样本被分类器C判断成第j类样本的数据占第i类样本总数的百分率,混淆矩阵中元素的行下标对应目标的真实属性,列下标对应分类器产生的识别属性.对角线元素表示各模式能够被分类器C正确识别的百分率,而非对角线元素则表示发生错误判断的百分率.在电力系统负荷分类问题中,完全正确的分类是不容易得到的,通过聚类得到的结果往往更能够客观地反应负荷变化特征,我们试图通过聚类来修订主观分类,调和矩阵中元素的行下标对应的是依据先验知识所产生的属性,列下标对应聚类产生的识别属性.调和矩阵从本质上可以看成混淆矩阵的一种近似形态.算法1.调和聚类-分类算法.1.依据领域经验对U分类,而得到初始分类,C={C1,C2,…,Cn};2.对U按距离实施聚类操作δ,得到聚类谱系图G,在聚类谱系图G的最顶部处进行切割,得到两个分支,每一分支都构成一类.由此得到调和矩阵:3.设在某一时刻,调和矩阵考察Λ的每一列(λ1Gj,λ2Gj,…,λnGj)T,若存在两个或两个以上分量λ大于μ,且|Gj|>τ|U|,其中,0<τ<μ<1为设定的阈值参数,|Gj|和|U|分别表示Gj和U中的元素个数,则在聚类谱系图Gj的最顶部进行切割,形成新的分支,并修正调和矩阵Λ.反复执行步3,直至Λ中每列只存在唯一的λiGk>μ或|Gj|<τ|U|;4.考察矩阵Λ中的每一列(λ1Gj,λ2Gj,…,λnGj)T,若存在两个或两个以上分量λ在其所在行内充分占优,不防设这些分量为λhGj,λh+1Gj,…,λpGj,则将Ch,Ch+1,…,Cp合并成一类.修正矩阵Λ;5.考察矩阵Λ中每一行犚狅狑i=(λiG1,λiG2,…,λiGm),若犚狅狑i单项充分占优,则将Ci单独作为一类,否则,设定阈值κ,假定犚狅狑i中大于κ的分量有l个,分别为λis,λis+1,…λis+l-1则根据Gs,…,Gs+l-1将Ci分成l类,对于x∈Ci-∪l-1Gs+r,按照与集合中心距离最短原则添加到Ci的某个分r=0类中.算法的第1步和第2步对样本集进行初始分类和聚类.算法第3步可以保证,在C中只有一个分类Ci的绝大多数样本在某一聚类Gj中,如果C中存在两个以上分类绝大部分元素在同一聚类Gj,则在Gj对应的聚类谱系的最顶层分割Gj,在最终时刻,若依然存在两个以上C中分类绝大部分元素在同一聚类Gj中,必有Gj中的样本数量小于一定规模,步4将这些分类并为一类.在步5,若调和矩阵中的某一行犚狅狑i单项充分占优,则将Ci单独置成一类,步3和步4已经确保了不可能存在两个以上分类Ci的绝大多数样本在某一聚类Gj中.如果犚狅狑i不是单项充分占优向量,且Ci中的大部分样本分布在Gs,…,Gs+l-1中,则依据Gs,…,Gs+l-1将Ci分成l类,Ci中不在Gs,…,Gs+l-1中的样本按距离最小原则,添加到Ci的某个分类中.若将算法的步5中的相关调整近似地看成是聚类的结果,则关于算法收敛性有如下结论:存在合适的参数μ、τ使得算法必在某一迭代步骤上停止,停止时刻调和矩阵Λ有k行为单项充分占优,s-k行为多项占优,其中,k0,sn,n为依靠先验知识所得到的分类数,且Λ中不存在使所有行都充分占优的列.如式(4)所示:Λ=|Gj|<τ|U|;证明.不妨设向量狏=(λ1Gj,λ2Gj,…,λnGj)T为调和矩阵Λ的任意一列,只需取0<τ<μ<0.8,由于样本集中的数据是有限的,由算法步3不难看出,算法必在某一迭代步骤上停止,且算法停止时,Λ中的每一列狏必满足下述条件之一:(1)狏中只存在唯一的λiGk>μ;(2)若狏中只存在两个以上的λiGk>μ,则必有(3)对于λiGm∈狏,均有λiGm<μ.首先证明在算法停止时刻,调和矩阵Λ中不存在使所有行都充分占优的列.用反证法,假设狏=(λ1Gj,λ2Gj,…,λnGj)T是Λ中的一列,若该列使Λ所有行都充分占优,即对于λiGm∈狏,λiGm>0.8,则狏必满足以上条件(2),则有|Gm|=∑n与中止条件|Gm|<τ|U|矛盾.Page4设算法中止时,Λ中中止于条件(1)的列有w列,中止于条件(2)的列为h列,设(λ1Gj,λ2Gj,…,λnGj)T是h列中的任意一列,该列中分量为λhGj,λh+1Gj,…,λpGj使其所在行充分占优,由步4将Ch,Ch+1,…,Cp合并成一类.显然,新合成的分类依然是充分占优,设合并操作后产生充分占优的行数为l,则Λ中所有充分占优的行数为k=w+l,不妨设经过步4合并操作后,调和矩阵Λ的行数为s,则Λ中的其它s-k行为多项占优,步5将Λ中的每一行内λ值较小的类按距离最近原则,分配到其它类中,由于Λ中的行与次序无关,经过适当的行次序调整,即为式(4)所示状态.在这里应该强调的是:分类采用的先验知识与聚类使用的测度函数所刻画问题的本质是相同的,否则进行调和就没有任何实际意义.同时,本文所述方法在一定程度上依赖于聚类谱系的划分,在实际应用中我们总是在相关聚类谱系的最顶端进行切割,这种切割方式已经在电力负荷预测中取得了不错的效果,对于不同的问题,是否存在更合理的切割方式,还需要进一步研究.在这里涉及到两种标准,一个是领域专家的先验知识,这种先验知识往往来源于日常生活中的一些规律,由于影响电力负荷变化的因素多且复杂,一些造成负荷特殊变化的原因还不清晰,电力专家依据的先验知识往往只能大体地反映负荷变化的规律,存在一定的不确切性.另一方面,通过聚类方法能够从客观上较好地识别负荷变化的不同特征,但是样本之所以聚成一类的原因还无法确定,这样就使得聚类方法无法直接用于预测.故而我们退而求其次,采取一种相对折衷的办法.调和聚类-分类算法一定程度上保证了主观经验和客观规律的统一.以下就本算法在电力负荷预测中的应用过程加以阐述.3负荷预测问题描述负荷预测是电力系统的一个传统研究问题,是指从已知的电力系统、经济、社会、气象等情况出发,图196点数据p(t)的三层小波分解通过对历史数据的分析和研究,探索事物之间的内在联系和发展变化规律,对负荷发展做出预先估计和推测.负荷预测方法众多[9-11],按照预测期限的不同,电力系统负荷预测分为长期预测、中期预测、短期预测、超短期预测.其中超短期预测是研究最多的,也是最困难的.在电力系统负荷预测过程中,通常需要按照专家经验将样本分成不同类别,然后提取不同类别数据的特征,找出特征和影响因素之间的关系,根据这些影响因素的变化来预测未来某日的电力负荷情况.在这个过程中,合理分类是有效预测的基础,通常情况下,领域专家依靠经验或习惯对样本进行分类,这种方式存在着上面所述的问题,即专家认为应该归为一类的点,往往在特征空间中距离特别远,而不同类别的样本,从特征上看又相当接近.本文对某电力公司近几年的数据样本分别按经验和上节所述调和聚类-分类方法进行分类,在不同分类的基础上,根据气象因素预测负荷情况,并根据实际负荷数据对基于不同分类产生的预测结果加以评估.在这里,不同分类方法采用的预测模型是相同的,下面就本文采用的预测模型加以简单描述.首先,对样本进行分类,应用小波变换针对不同类别对96点数据进行特征的提取.本例中,采用Daubechies小波提取负荷数据的特征.设{p(t)},t=1,2,…,96为某天96点负荷值,令C0(t)=p(t),小波分解如下:式中,珔h[-k]=h[k],珚g[k]=g[-k],g[k]=(-1)k-1h[k-1],h[k]为低通滤波器,g[k]为高通滤波器,L为分解层数Cj[k],Dj[k],j=1,2,…,L分别为第j层小波变换的低通信号(特征)和高通信号(噪声).称{CL,DL,…,D2,D1}为在尺度L下的小波变换序列.通过小波变换,将96点时间序列分解成特征和噪声两部分.在本例中,采用三层小波分解,具体如图1所示.Page5在每一次对Cj的分解中,所得到的低通信号Cj+1和高通信号Dj+1的维度是Cj维度的一半.初始C0为96点负荷数据,经过三层小波分解后,C3,D3,D2,D1的维度分别是12,12,24,48,因此,{C3,D3,D2,D1}的维度依然是96,其中,前12个分量C3包含着{p(t)}总体波动信息,即特征分量,而D3,D2,D1则是{p(t)}在不同尺度空间上的高频信息,即噪声分量.可以通过向量{C3,D3,D2,D1}的重构得到{p(t)}.考察气象因素与特征分量和噪声分量的关系,尽管人们通常用气温来反映环境的冷热,但人体对外界冷热的舒适感并不能通过温度一项因素来评价,因此,本文采用实感温度作为影响负荷的主要因素.实感温度由以下公式计算:Te=37-Q1/Q2-Tr,Q1=ΔT(1.76+1.4V0.75),Q2=(0.68-0.41Rh)(1.76+1.4V0.75)+1,Tr=0.29T(1-Rh),ΔT=37-Tα其中,Te为实感温度,Tα为测量温度,V为风速,Rh为相对湿度.从定义上可以看出:风速可以使实感温度降低,但随着气温的增加,对实感温度的影响越来越小,当温度超过37时,风速增大会使实感温度增加,当风速一定,气温较高时,湿度的增加使实感温度增加,而气温较低时,湿度增大使实感温度降低.计算实感温度的气象因素都可以从气象台获得.考察实感温度和特征分量之间关系,特征分量值随着温度的变化,呈现出一定规律,对这一规律进行回归,从而得到实感温度和特征分量之间的关系多项式.从而根据实感温度的变化可以对特征分量进行预报.噪声分量关于实感温度呈散点分布,无法采用回归的方式确定温度和噪声之间的关系.如上文所述,噪声分量是由96点数据经过三层小波分解得到的不同尺度空间上的高频信息构成,向量长度为84,我们采用如下方式确定噪声分量:96点数据的噪声分量,令f(d)=∑q其中,q为该分类样本总数.通过求解优化问题minf(d)来确定噪声分量珚dj,j=1,2,…,84.由上所述,通过实感温度可以对未来某天的负荷特征进行预测,预测结果与珚dj重构即为当日的电量负荷的预测值.设Di={di1,di2,…,di84},i=1,2,…,q为某天4不同分类方法的预报结果依据先验知识按日期类型对样本进行分类,记作C={C1,C2,…,Cn},对于每一个96点历史负荷数据(p0,p1,…,p95),令Δp=p1-p0对Δp按欧式距离聚类,形成聚类谱系,采用调和聚类-分类方法对上述分类重新分类,在调和聚类-分类方法作用下,原分类{C1,…,Cn}被重新划分,得到的分类为C={C1,…,Cm},考察最终的调和矩阵对于调和矩阵Λ中所有充分占优的行,依据先验知识的分类结果与客观聚类结果大体相同,预报方法与第3节所述方法一致.对于调和矩阵Λ中所有多项占优的行,我们做如下处理,设(0,…,λij,…0…,λim,…,0)为Λ中多项占优的行,不妨设λis,λis+1,…,λis+l-1为其中占优项,则在新分类集合C中必存在分类Cis,Cis+1,…,Cis+l-1与之对应,在这些分类中分别提取特征和噪声,按上节所述方法回归出特征与平均温度之间的关系,并与相应的高频信号重构,得到预测器Pis,Pis+1,…,Pis+l-1,由于Ci被分成Cis,Cis+1,…,Cis+l-1的原因是不得而知的,具体预测时也只能从先验知识入手,该行所对应的一类情况采用如下方式进行预测:为验证本文所述方法的有效性,分别采用不同的分类方式,以预测当年前两年的历史数据作为学习样本,对国内某电力公司2007、2008及2009年上半年的负荷情况进行预测,在负荷预测的过程中一些特殊节假日,如春节、元旦等数据规模较小的类,由于历史数据样本少,进行回归是没有意义的,只能按历史趋势进行预测.表1列举了实验过程中的几组统计结果,其中统计类型A为数据点中误差小于1%数据点的百分比,B为误差点大于1%而小于3%点的百分比,CPage6则是误差大于3%点的百分比,D为预测结果与实际数据的均方根误差的平均值.年份误差200720082009上半年从表1的统计结果中可以看出,基于新分类的预测结果要明显好于原有的基于经验的分类,通过上述分析不难看出,在依据先验知识的分类中,负荷数据往往在客观上存在着不同的特征,将客观上特征并不趋同样本集当作一类进行回归,是造成回归曲线误差相对较大的主要原因,本文中的调和聚类分类方法一定程度上避免了这个问题,预测的准确率有了明显的提高,这也验证了本文提出的方法较好地解决了先验知识和相似性测度函数不协调的问题.5结论分类和聚类是数据挖掘中两个重要的研究领域,然而,在实际应用中,通常存在依靠先验知识得到分类结果与聚类结果之间不协调问题,针对这一问题和电力系统的实际应用背景,本文给出了调和矩阵的定义,并在此基础上,提出调和聚类-分类算法,使分类结果与聚类保持较高的一致性,并将该方法应用于电力系统负荷预测中,实验结果证实了本文方法的有效性.
