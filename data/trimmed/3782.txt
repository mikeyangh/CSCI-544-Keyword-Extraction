Page1基于服务标识的中间级缓存多级多平面分组交换时延保证调度机制研究马祥杰李晓中范兴隆陈洪彦(中国人民解放军空军工程大学北京100195)(中国人民解放军95824部队北京100195)摘要基于服务标识的网络交换调度机制是当前一个重要的研究课题.文中分析了中间级缓存多级多平面交换结构内部阻塞性、模拟最优OQ结构、链路加速比的技术特性,建立了基于均衡指针和动态时延指针的调度模型,设计了采用“请求-响应-确认”策略的均衡迭代和时延保证迭代调度算法.该算法克服了iSLIP和PPS方法在高负载强度下时延发散问题,在突发流量和非均匀diagonal流量下均可实现时延保证性能,在交换平面数p为4和迭代次数Iteration为4条件下可收敛至最优时延曲线.关键词服务标识;多级多平面;中间级缓存;时延保证;并行分组交换1引言随着以物联网为代表的世界信息产业第三次浪潮的出现,网络交换技术的可扩展能力和服务模式面临新的挑战.解决网络交换容量瓶颈问题,一方面要加快研制全光路由器,但目前全光路由器的实用化仍面临诸多技术难题[1-2];另一方面要发展大容量光电混合交换技术,构建并行处理、分散缓存和多级交换结构,解决大容量交换问题的多级交换和多平面交换技术引起了学术界和产业界的广泛重视[3-5].传统的OQ交换结构具有理想的服务保证能力,相关调度算法主要有加权轮询算法[6]、优先级队列加权轮询算法[7]、优先级自适应加权公平队列算法[8]等.但OQ结构过高的内部加速问题限制了其在大容量交换领域的应用.RD和CRRD是多级交换结构中两种经典的并发轮转调度算法.RD算法[9]采用PIM算法[10]的“多次迭代”和“随机选择”交换模式,吞吐量最高仅能达到63.2%[11-12].CRRD算法是Oki等人[13]提出的一种基于RD改进的调度算法,它以“指针轮转”代替了“随机选择”模式,在均匀流量下可以获得100%吞吐量,但在突发流量下的交换性能迅速恶化.美国学者Chao等人[4-5]研究了MPMS结构的最优交换调度问题,该结构在内部加速比S仅为1.6时就可实现模拟OQ结构,在分组排序缓存RAQ空间仅为178个Cell时即可完成保序交换.为了进一步研究MPMS结构的QoS保证机制,文献[14]提出了一种可提供业务带宽保证的调度算法BG-CRRD,可根据业务带宽需求分配调度资源.但BG-CRRD算法没有考虑业务时延保证问题,无法满足日益增多的“时延敏感”业务的网络交换需求.为此,本文研究了基于服务标识的中间级缓存MPMS结构时延保证调度问题,提出了MPMS结构中的时延保证调度模型和时延保证调度算法,通过仿真实验验证了所提方法的时延保证性能和基于交换平面数和迭代次数的最优时延收敛能力.算法延伸性方面,该调度机制摒弃了集中式方法基于全局Cell流量信息导致的延伸性差等缺点,MPMS分布式并行结构特征和局部Cell信息的全分布调度结构,具有比已有的iSLIP和PPS等调度模式更优的延伸性.2缩写语与符号为便于论文论述,论文定义缩写语与符号如下:路器/合路器.DEM/MUX:De-Multiplexer/Multiplexer,分ISU:InputSwitchingUnit,输入交换单元.OSU:OutputSwitchingUnit,输出交换单元.MSU_I/MSU_II:MiddleSwitchingUnit,I型k:MPMS交换结构中ISU或OSU的交换单m:MPMS交换结构中MSU_I和MSU_II的n:MPMS交换结构中ISU的入端口数或OSUp:MPMS交换结构的第p个交换平面.P:MPMS交换结构的交换平面数.中间交换单元/II型中间交换单元.元数.交换单元数.的出端口数.3中间级缓存MPMS交换结构时延保证调度理论分析本文研究的中间级缓存多级多平面分组交换结构如图1所示,该结构仅仅在中间交换单元MSU_I和MSU_II之间设置一级MMU单元,交换过程也分为由DEM分路器至MMU缓存的“到达交换阶段”和MMU缓存到MUX合路器的“离开交换阶段”两个子过程.我们在前期研究中证明[3],对于中间级缓存MPMS交换结构,假设结构中任意顶点对(demi,muxj)之间的交换路径数为SwPC(demi,muxj),i,j∈[1,nk],中间级缓存MPMS交换结构是结构无阻塞的充分必要条件是交换路径数满足SwPC(demi,muxj)=Pkmn或者Pmk2N(1)Page3而输入/输出级缓存MPMS交换结构实现结构无阻塞需要满足的拓扑参数条件为SwPC(demi,muxj)=Pmn或者PmkN(2)由式(1)和式(2)可以得出如下结论:在相同拓扑参数(P、m、k数值)条件下,中间级缓存MPMS交换结构比输入/输出级缓存MPMS交换结构具备更多的交换路径数,或者说中间级缓存MPMS交换结构比输入/输出级缓存交换结构更容易实现结构无阻塞.更多的交换路径数和结构无阻塞特性使得中间级缓存MPMS交换结构在时延保证业务调度中更具优势.OQ交换结构是一种可以提供严格QoS保证的理想交换结构,但由于N倍加速问题无法在高速交换路由设备中实际应用.中国香港科技大学的Wang等人[15]从理论上证明了中间缓存“单平面”多级交换结构模拟OQ交换结构需要满足其中,S为交换结构加速比.基于LBTP最小流量模式[16],我们进一步证明了中间级缓存多级多平面交换结构模拟OQ结构所需的内部加速比S和中间交换单元数m满足[3]图2中间级缓存MPMS交换结构的到达阶段负载均衡调度模型式(4)表明中间级缓存MPMS交换结构在减速和较小m值条件下即可模拟OQ结构,而且交换过程中仅需要1次缓存过程(即Cell信元仅在中间存储单元MMU中缓存)和2个可控的交换阶段(即到达交换阶段和离开交换阶段),因此在时延保证分组调度中具有明显的技术优势.4建立时延保证调度模型(DG-MPMS)根据图1中给出的中间级缓存MPMS交换结构分布式调度模型,时延保证调度包括2个阶段:到达调度阶段和离开调度阶段.论文针对两个调度阶段分别建立了时延保证调度模型.4.1到达阶段调度模型到达阶段是从Cell信元到达分路器DEM到调度缓存到一个中间级缓存单元MMU阶段,该阶段调度模型主要基于当前时隙Cell信元到达信息和给定周期内Cell信元时延信息实现各时隙从DEM单元到MMU单元的选路功能.从图1可以看出,到达调度阶段主要涉及DEM单元、ISU单元和MSU_I单元,包括DEM调度器、ISU调度器和MSU_I调度器.为了保证到达阶段较低的实现复杂度,在上述3类调度器中采用了均衡指针BP(BalancingPointer,BP)技术,中间级缓存MPMS交换结构的到达阶段负载均衡调度模型如图2所示.Page4为了保持Cell分组在当前周期T内经过调度器的均衡性,在DEM调度器、ISU调度器和MSU_I调度器中定义均衡列表BL(BalancingList)如下:{BL(demi),|BL(demi)|=P},i∈[1,nk]烄{BL(isu(p,q,r)),|BL(isu(p,q,r))|=n},p∈[1,P],q∈[1,k],r∈[1,m]烅{BL(msu_i(p,s,t)),BL(msu_i(p,s,t))=k},p∈[1,P],s∈[1,m],r∈[1,k烆其中,|BL()|为均衡列表BL()的维度.4.2离开阶段调度模型与到达阶段相反,离开阶段是Cell信元从中间图3中间级缓存MPMS交换结构的离开阶段调度模型离开阶段调度模型采用独立的动态时延优先级列表DDL(DynamicDelay-priorityList)描述等待调度Cell分组的时延信息,MMU调度器、MSU_II调度器和MUX调度器的动态时延优先级列表DDL定义如下:{DDL(mmu(p,u)),|DDL(mmu(p,s,t))|=m},烄p∈[1,P],s∈[1,m],t∈[1,k]{DDL(msu_ii(p,u,v)),|DDL(msu_ii(p,u,v))|=k},烅p∈[1,P],u∈[1,m],v∈[1,k]{DDL(muxj),|DDL(muxj)|=P},j∈[1,nk烆其中,|DDL()|为动态时延优先级列表DDL()的维度.5时延保证调度算法(DG-MPMS)设计5.1到达阶段均衡调度算法(1)均衡调度器初始化:任意选定所有demi调度器、isu(p,q,r)调度器、msu_i(p,s,t)缓存单元MMU缓存队列到合路器MUX的调度阶段,此阶段调度模型基于缓存Cell信元排队时延信息和给定周期内Cell信元时延信息,实现各时隙从MMU单元到MUX单元的选路功能.离开调度阶段主要涉及MMU单元、MSU_II单元和MUX单元,包括MMU调度器、MSU_II调度器和MUX调度器.为了保证到达阶段较低的实现复杂度,在上述3类调度器中采用了动态时延优先级指针(DynamicDelay-priorityPointer,DDP)技术,中间级缓存MPMS交换结构的离开阶段时延保证调度模型如图3所示.调度器的均衡列表BL(demi)、BL(isu(p,q,r))、BL(msu_i(p,s,t))初始列表值和均衡指针犅犘(demi)∈[1,P]、犅犘(isu(p,q,r))∈[1,n]、犅犘(msu_i(p,s,t))∈[1,k]初始位置值.(2)阶段1.DEM与ISU的均衡匹配:步骤1(请求).当前时隙TSd中所有收到Cell信元且未建立匹配的demi调度器向全部对应的isu(p,q,r)调度器发送请求(Request);步骤2(响应).所有收到demi调度器请求(Request)的isu(p,q,r)调度器在均衡列表BL(isu(p,q,r))中由均衡指针犅犘(isu(p,q,r))以轮转方式选择一个demi,i∈[(i-1)n+1,i×n]调度器返回响应(Response);步骤3(确认).所有收到isu(p,q,r)调度器响应(Response)的demi调度器在均衡列表犅犘(demi)中由均衡指针BL(demi)以轮转方式选择一个isu(p,q,r),p∈[1,P]返回确认(Accept);步骤4(迭代).若存在匹配失败的demi调度器,则迭代步骤1~步骤3;否则阶段1迭代结束.(3)阶段2.DEM与MSU_I的均衡匹配:步骤1(请求).所有在阶段1匹配成功的demi调度器通过匹配的isu(p,q,r)单元向同一交换平面所有msu_i(p,s,t)调度器发送请求(Request);Page5步骤2(响应).所有收到请求(Request)的msu_i(p,s,t)调度器在均衡列表BL(msu_i(p,s,t))中由均衡指针犅犘(msu_i(p,s,t))以轮转方式选择一个isu(p,q,r)q∈[1,k]单元,并向该isu(p,q,r)单元对应的demi调度器返回响应(Response);步骤3(确认).所有收到msu_i(p,s,t)调度器响应(Response)的demi调度器通过匹配的isu(p,q,r)单元向发出响应(Response)的msu_i(p,s,t)调度器返回确认(Accept).(4)(发送).demi分路器通过阶段1匹配的isu(p,q,r)单元和阶段2匹配的msu_i(p,s,t)单元向对应的mmu(p,s,t)单元发送Cell信元.(5)(更新均衡指针).若demi调度器、isu(p,q,r)调度器、msu_i(p,s,t)调度器在当前时隙成功建立匹配,即demi分路器成功发送Cell信元,isu(p,q,r)调度器、msu_i(p,s,t)调度器接收到确认(Accept),则调度器更新均衡指针如式(7):犅犘(demi)=(犅犘(demi)+1)mod(P)烄犅犘(isu(p,q,r))=(犅犘(isu(p,q,r))+1)mod(n)烅烆犅犘(msu_i(p,s,t))=(犅犘(msu_i(p,s,t))+1)mod(k5.2离开阶段时延保证调度算法(1)时延保证调度器初始化:随机选定所有mmu(p,s,t)调度器、msu_ii(p,q,r)调度器、muxj调度器的动态时延列表DDL(mmu(p,s,t))、DDL(msu_ii(p,q,r))、DDL(muxj)初始列表值和动态时延指针犇犇犘(mmu(p,s,t))∈[1,k],犇犇犘(msu_ii(p,q,r))∈[1,k],犇犇犘(muxj)∈[1,P]初始位置值.(2)阶段1.MMU与MSU_II的时延保证匹配:步骤1(标识请求).所有缓存时延“服务标识”Cell信元的mmu(p,s,t)调度器向全部对应的msu_ii(p,q,r)调度器发送标识请求(IDRequest);步骤2(时延列表更新与标识响应).所有收到mmu(p,s,t)调度器标识请求(IDRequest)的msu_ii(p,q,r)调度器首先更新动态时延列表DDL(mmu_ii(p,q,r)),将IDRequest对应的MMU单元依次赋予最高优先级;并由动态时延指针犇犇犘(msu_ii(p,q,r))以轮转方式选择一个mmu(p,s,t)调度器返回标识响应(IDResponse);步骤3(标识确认).所有收到msu_ii(p,q,r)调度器标识响应(IDResponse)的mmu(p,s,t)调度器在动态时延列表犇犇犘(mmu(p,s,t))中由动态时延指针DDL(mmu(p,s,t))以轮转方式选择一个msu_ii(p,q,r),q∈[1,k]返回标识确认(IDAccept);步骤4(迭代).若存在匹配失败的mmu(p,s,t)调度器,则重新执行步骤1~步骤3;否则该阶段匹配结束.(3)阶段2.MMU与MUX的时延保证匹配:步骤1(标识请求).所有在阶段1匹配成功的mmu(p,s,t)调度器通过匹配的MSU_II和OSU单元向对应的muxj调度器发送标识请求(IDRequest);步骤2(时延列表更新与标识响应).所有收到mmu(p,s,t)调度器标识请求(IDRequest)的muxj调度器首先更新动态时延列表DDL(muxj),将IDRequest对应的交换平面依次赋予最高优先级;并由动态时延指针犇犇犘(muxj)以轮转方式选择一个交换平面向对应的mmu(p,s,t)调度器返回标识响应(IDResponse);步骤3(标识确认).所有收到muxj调度器标识响应(IDResponse)的mmu(p,s,t)调度器通过匹配的MMU_II和OSU单元向发出标识响应(IDResponse)的muxj调度器返回标识确认(IDAccept).(4)(Cell信元发送).mmu(p,s,t)存储器通过匹配的MSU_II单元、OSU单元向对应的muxj单元发送Cell信元.(5)(动态时延指针更新).若mmu(p,s,t)调度器、msu_ii(p,q,r)调度器、muxj调度器在当前时隙成功建立匹配,即mmu(p,s,t)存储单元成功发送Cell信元,msu_ii(p,q,r)调度器、muxj调度器接收到标识确认(IDAccept),则调度器更新均衡指针如式(8):犇犇犘(mmu(p,s,t))=犇犇犘(mmu(p,s,t))烄犇犇犘(msu_ii(p,q,r))=犇犇犘(msu_ii(p,q,r))烅烆犇犇犘(muxj)=犇犇犘(muxj)(6仿真实验分析为了有效模拟真实网络流量特效,本文仿真实验输入业务源模型采用了突发流量模型和非均匀Diagonal流量模型.突发流量模型ON-OFF状态长度服从参数为(p,q)的几何分布,Cell信元突发长度为LON,业务流负载为ρ,满足式(9):本文仿真实验中Cell信元突发长度为LON=24,流量强度5%λ100%.实验采用的非均匀Diagonal流量模型归一化平均到达速率为λij,其中i为输入端口,j为输出端口,ω为非均匀概率,该模型分布如式(10):本文仿真实验中ω=0.67,λii=0.67ρ,λi|i+1|=0.33ρ,负载强度5%ρ100%.仿真中,iSLIP算法采用16×16交换单元,迭代次数Iteration=3;PPS交换结构交换平面数P=3,平面内为16×16交换单元;DG-MPMS交换结构采用64×64交换网络,参数为n=8,k=8,m=8.Cell信元长度为48Byte.iSLIP、PPS分别是单级交换结构和并行分组交换结构中经典的交换方式,论文首先在突发流量和非均匀diagonal流量下将所提出的DG-MPMS调Page6度机制与上述两种交换机制进行了时延性能对比实验,实验结果如图4和图5所示.图4表明iSLIP和PPS在突发流量强度较底情况下都可以保证Cell信元时延性能,但iSLIP和PPS在流量强度λ>0.8和λ>0.9时分别进入时延发散区域,无法再保证时延性能;DG-MPMS在所有流量强度(0λ1)下始终处于时延收敛区域.图5表明iSLIP和PPS在流量强度λ>0.7和λ>0.8时表现为时延发散,DG-MPMS即使在最大流量强度(λ=100%)下仍然处于时延收敛区域.图4突发流量下iSLIP、PPS和DG-MPMS时延保证性能对比DG-MPMS不同交换平面数p参数条件下时延收敛特性如图6和图7所示.图6表明,对于突发流量模式,DG-MPMS在所有交换平面数p值下始终处于时延收敛区域,当交换平面p=4时DG-MPMS时延特性即达到最优时延和获得时延收敛曲线.图7表明,对于非均匀diagonal流量模式,DG-MPMS的时延特性出现恶化,在交换平面数p=1和流量强度λ>0.9条件下进入时延发散区域,但在交换平面数p2条件下对于所有流量强度0λ1始终处于时延收敛区域,且在交换平面p=4时同样可以达到最优时延和获得时延收敛曲线.目前经典的iSLIP算法性能收敛需要4~5次迭代,且属于集中式调度算法,算法迭代维度为N×N(N为交换系统全部端口数),迭代周期为L/R,L为Cell信元长度,R为交换系统最大线速.本文研究的多级多平面交换系统时延保证调度机制DG-MPMS在交换平面数p为4和迭代次数Iteration为4条件下即可收敛至最优时延曲线,属于分布式调度算法,算法迭代维度仅为n×k或k×k,比N×N少得多;迭代周期仅为(P×L)/R,明显优于L/R.图6突发流量下DG-MPMS时延平面收敛特性图7非均匀diagonal流量下DG-MPMS时延平面收敛特性为了验证所提时延保证调度算法的迭代时延特性,本文仿真实验结果如图8和图9所示.图8表明,对于突发流量模式,DG-MPMS在所有迭代次数Iteration值下始终处于时延收敛区域,当交换平面Iteration=4时DG-MPMS时延特性收敛于最优时延曲线.图9表明,DG-MPMS在非均匀diagonal流量模式下的时延曲线明显劣于突发流量模式,当迭代次数Iteration=1和流量强度λ>0.9时进入Page7时延发散区域,而对于迭代次数Iteration2和流量强度0λ1,时延特性即进入时延收敛区域,在迭代次数Iteration=4时DG-MPMS获得时延迭代收敛曲线.图8突发流量下DG-MPMS时延迭代收敛特性图9非均匀diagonal流量下DG-MPMS时延迭代收敛特性7结论在综合分析现有提供服务保证的交换技术基础上,本文研究了一种基于服务标识的中间级缓存多级多平面分组交换结构时延保证调度机制,理论分析了中间级缓存MPMS结构在内部阻塞性、模拟最优OQ结构、链路加速比等方面的时延保证优势,提出了基于中间级缓存MPMS结构的分布式调度架构,建立了到达阶段“DEM-ISU-MSU_I”采用均衡指针BP技术的均衡调度模型和离开阶段“MMU-MSU_II-MUX”动态时延指针DDP技术的调度模型,设计了应用“请求-响应-确认”协商策略的两级均衡匹配迭代调度算法和两级时延保证迭代调度算法.仿真实验表明,该算法克服了iSLIP和PPS方法在高负载强度下的时延发散问题,DG-MPMS在突发流量和非均匀diagonal流量下均可实现时延保证性能,在交换平面数p为4条件下可以收敛至最优平面收敛曲线,在迭代次数Iteration为4条件下可以收敛至最优迭代时延曲线.本文研究内容为进一步探讨基于服务标识的网络服务机制和多级多平面分组交换服务保证技术提供了一个很好的交换技术解决方案.
