Page1多元时间序列的子空间回声状态网络预测模型韩敏许美玲王新迎(大连理工大学电子信息与电气工程学部大连辽宁116023)摘要针对采用回声状态网络预测多元混沌时间序列时储备池学习算法可能存在的病态解问题,该文提出了一种基于快速子空间分解方法的回声状态网络预测模型.所提模型利用Krylov子空间分解方法提取储备池状态矩阵的子空间,子空间代替原状态矩阵进行输出权值求解,可以消除储备池状态矩阵的冗余信息,有效地解决伪逆算法存在的病态解问题,并且降低计算复杂度,提高泛化性能和预测精度.基于两组多元混沌时间序列的仿真结果验证了该文所提模型的有效性和实用性.关键词回声状态网络;快速子空间分解;储备池;多元时间序列;预测1引言复杂的混沌系统是介于确定与随机之间的非线Page2被广泛应用于多元混沌时间序列建模预测中[3].然而,一般神经网络学习算法基于梯度下降法,处理大规模数据时,收敛速度慢,易陷入局部最优,上述缺点制约了一般神经网络在更大范围的推广,因此关于神经网络快速学习算法的研究日益增多[4-5].回声状态网络(EchoStateNetwork,ESN)是一种新型的递归神经网络[4],在学习算法和稳定性方面较一般递归神经网络有很大改进.ESN主要由一个稀疏的具有递归结构的储备池和一个线性输出部分构成,储备池参数初始设定后保持不变,只有输出连接权值需要通过线性回归方法求解,训练过程简单快速,解唯一且全局最优.目前,储备池方法的研究领域极为活跃[6],主要集中在储备池结构优化和学习算法两个方面,如Rodan等人[7]简化储备池结构,提出最小复杂度回声状态网络,Gallicchio等人[8]针对树结构数据,提出了树状回声状态网络模型.另一方面,储备池输出权值求解过程存在病态解问题,输出权值幅值较大,过拟合现象严重[9].正则化方法[10]通过添加正则项,控制输出权值幅值,提高泛化性能,但正则项系数通过交叉检验的方法确定,计算代价大.近几年,随着降维技术的发展,有学者使用数据压缩技术解决储备池病态解问题.例如,文献[11]使用主成分分析法(PrincipalComponentAnalysis,PCA)提取多维状态矩阵的主要成分,降低状态矩阵条件数,化病态方程为良性,取得了较好的预测效果.奇异值分解方法(SingularValueDecomposition,SVD)也是一种应用广泛的降维方法[12].吴春国等人[13]借助矩阵的Frobenius范数,证明了SVD与PCA的等价性.然而当储备池规模N很大时,PCA方法和SVD方法降维过程的计算复杂度为O(N3),耗费大量时间,解决病态解问题却增加了计算负担,牺牲了ESN训练速度快的优点.文献[14]在前人研究的基础上,运用Krylov子空间方法迭代求取储备池状态矩阵子空间,若子空间维数为d,提取子空间的计算复杂度为O(N2d),计算效率较PCA或SVD有所提高,可是子空间维数d一般通过广义交叉检验的方法确定,一定程度上限制了整个模型的计算速度.Xu等人[15]提出了快速子空间分解方法,子空间维数d通过有效秩检测方法确定,既保证了Krylov子空间分解方法计算复杂度低的优点,又保证此方法具有较小的逼近误差.目前,这一方法已被广泛应用于多项式逼近、最优控制和信号处理领域[16-17].本文在已有研究基础上,提出了一种快速子空间分解回声状态网络(FastSubspaceDecompositionEchoStateNetwork,FSDESN)预测模型.所提模型将快速子空间分解算法应用于ESN中,采用三Lanczos迭代法构造Krylov子空间,Krylov子空间渐进逼近储备池状态矩阵的子空间,子空间代替原状态矩阵求解输出权值,消除近似共线性,解决状态矩阵病态特性产生的不适定问题.2多元混沌时间序列的ESN预测模型ESN的核心是一个大规模的稀疏连接的具有递归结构的储备池,起到存储历史信息的“回声”作用[18],成百上千个内部单元保证网络强大的非线性映射能力,稀疏的结构保证网络丰富的动态性能、良好的自适应性和自组织性[4].ESN结构分为输入层、内部储备池和输出层3层,结构如图1所示.输入层和状态储备池通过输入权值矩阵连接,储备池内部单元之间由内部权值矩阵连接,构成状态反馈,状态储备池和输出层通过输出权值向量连接.假设连续系统采样得到的离散时间序列为狊(1),狊(2),…,狊(t),…,其中t时刻的采样值狊(t)=[s1(t),s2(t),…,sl(t)]T为l元向量.对时间序列建模,设定t时刻输入为狌in(t)=狊(t),输出为y(t)=狊(t+η),通过改变η的值实现对不同时域的预测.不失一般性,本文建立多输入单输出预测模型,y(t)为标量,只取序列狊(t+η)的第一维观测值s1(t+η).ESN的状态方程为狓(t)=sigmoid犠in狌in(t)+犠x狓(t-1输出方程为式(1)中sigmoid激活函数通常取双曲正切tanh函数[4],犠in和犠x分别为输入连接矩阵和储备池内部连接矩阵,随机初始化后保持不变.狓(t)=[x1(t),x2(t),…,xN(t)]T为t时刻N元储备池内部状态向Page3量,由当前输入狌in(t)和上一时刻状态狓(t-1)激发产生.式(2)中犠out为储备池输出权值向量,是唯一由训练求解的参数.通常,令犠x的谱半径ρ(犠x)<1,以保证ESN网络稳定运行[6].ESN使用最小二乘法求解输出权值,最小化下式所示的目标函数:其中,犡=[狓(Init+1),狓(Init+2),…,狓(Init+p)]T,Init一般大于1以去掉初始暂态的影响,犢=[y(Init+1),y(Init+2),…,y(Init+p)]T,p为训练数据长度,有p>N,犡∈Rp×N,犠out∈RN×1,犢∈Rp×1.将式(3)进一步转化为伪逆解:其中^犠out是对犠out的估计,犡是犡的伪逆,有状态矩阵犡的奇异值分解表示如下其中犝=(狌1,…,狌p)和犞=(狏1,…,狏N)是酉阵,对角阵Σ=diag(σ1,…,σr,σr+1,…,σN),假设犡的秩为r,则有进而伪逆解式(5)表示为有从上式可以看出,输出权值幅值与奇异值大小成反比.当奇异值过小时,会出现病态解问题.实际观测的时间序列通常含有扰动,假设扰动信号为犲,那么含扰动的目标值记为犢~=犢+犲,则输出权值计算公式为当大规模矩阵犡具有病态特性,即奇异值σi很小,条件数很大时,式(10)求得的输出权值幅值较大,扰动信号犲会严重影响珦犠out的精度.大的输出权值往往会降低网络的泛化性能.因为即使网络的测试输入与训练输入有微小的差别,测试输出与训练输出也可能相差很大.因此,病态特性的存在会严重影响网络的预测性能.3FSDESN预测模型针对采用ESN求解输出权值的过程中,储备池状态矩阵存在的病态解问题,本文将快速子空间分解方法引入到ESN模型中,建立快速子空间分解回声状态网络模型(FastSubspaceDecompositionEchoStateNetworkmodel,FSDESN),提高预测精度的同时降低计算复杂度.使用Krylov子空间分解方法对高维状态矩阵进行降维,效果优于传统的最小二乘法,在涉及最优化、多项式逼近及信号处理等实际工程问题中,发挥着重要的作用[15,19].此方法综合运用三Lanczos迭代和Rayleigh-Ritz逼近的概念将求解大规模矩阵转化为求解小规模三对角矩阵(其特征值分解简单),减少大规模矩阵近似共线的成分,相对于传统的特征值分解方法,计算复杂度更低.3.1快速子空间分解算法[15,20]1.求取状态矩阵犡的协方差矩阵^犃N×N,适当选择狉0=犳(单位范数向量),m=1,d^=1,β0=狉0=1,j=0.2.执行三Lanczos迭代.while(βj≠0)狇j+1=狉j/βj;j=j+1;αj=狇H狉j=^犃狇j-αj狇j-βj-1狇j-1;βj=狉j2;end.迭代到第m步(即j=m),得到一组Krylov子空间的正交基Km(^犃,犳)span(犳,…,^犃m-1犳)=狇1,…,狇{}m有以下形式:3.计算Rayleigh-Ritz(RR)值θ(m)设μi是犜m的第i个特征值,则有4.对d^=1,2,…,m-2如式(13)计算检验统计量d^d^=p(N-d^)log其中p是样本个数,d是子空间维数,d^是d的估计.若则令d=d^,转到步5,否则,令m=m+1,返回步2.γd根据自由度为[(N-d)(N-d+1)-1]/2的χ2分布的拖尾大小选择阈值,置信区间取99%.c(p)=log槡p满足d的强一致估计条件[15]由于犙为一组正交基,犜m的特征值θ(m)犃的特征值,为保证式(13)分母不为0,有d^<mrank(犃).5.计算RR向量犵(m)值μi对应的特征向量,有Page4则与Krylov子空间Km(^犃,犳)相关联的d个主RR向量犵(m)构成子空间张成犌span{犵(m)子空间估计为犡(=犡×犌.由于协方差矩阵犃是对称半正定矩阵,犙m是一组正交基,mrank(犃),则犜m是对称正定矩阵,其特征向量狊i(i=1,2,…,m)彼此正交,进而RR向量犵i(i=1,2,…,d)彼此正交,子空间犡(∈Rp×d的秩必为d.3.2FSDESN预测模型将Krylov子空间分解方法与回声状态网络结合,从储备池状态矩阵犡p×N中提取出子空间犡(p×d,其中p是样本个数,N是储备池维数,d是子空间列数,dN.对子空间犡(求伪逆等价于下式:输出权值向量计算公式:参照式(9),写成奇异值分解的形式:当输出中含有扰动信号犲时,输出权值计算公式为犡(T犡(是d×d维小规模非奇异矩阵,较于犡T犡规模减小,特征值集中,条件数降低,子空间代替原状态矩阵求解输出权值,能够消除伪逆解犠out=犡犢的病态特性,防止过拟合,提高泛化能力.基于以上分析,本文建立快速子空间分解回声状态网络模型(FSDESN),预测多元混沌时间序列,网络结构如图2所示.FSDESN预测模型的具体步骤如下.1.预处理输入输出数据,进行归一化和相空间重构,初2.训练模型,输入数据激发储备池内部状态,产生状态始化网络.矩阵3.快速子空间分解方法提取犡的子空间犡(.犡(=犡×span{犵(m)4.根据式(18)求解输出权值向量.5.根据式(1)和(2)对测试集数据进行预测.3.3模型收敛性和稳定性分析FSDESN模型使用三Lanczos迭代算法在Krylov子空间上对状态矩阵犡的协方差矩阵^犃N×N进行Rayleigh-Ritz逼近,若(θ(m)i个RR值和RR向量,(λi,征值和特征向量,则迭代m步后,(θ(m)(λi,i),逼近误差为i-λi=O(p-(m-d)),i=1,2,…,d;θ(m)i-犵(m)由式(13)和(14),md+2,所以θ(m)O(p-2)逼近,犵(m)对于FSDESN模型整体,Krylov子空间方法对状态矩阵降维,不会改变储备池的收敛性,因此,只要犠x的谱半径ρ(犠x)<1,即可保证模型整体收敛.当时间序列目标值有扰动时,犢~=犢+犲,由式(9)和(10)得到ESN输出权值相对变化量同理,由式(19)和(20)得到FSDESN输出权值相对变化量其中犠out和犠(out为无扰动条件下ESN和FSDESN输出权值,珦犠out和犠(扰动下的输出权值,Δ是ESN输出权值变化量上界,Δ(是FSDESN输出权值变化量上界.由于犡(T犡(=犌T犡T犡犌的d个特征值与犡T犡的前d个大特征值相等,故子空间犡(的奇异值σ(1>σ(2>…>σ(d>0与式(7)所示的犡的奇异值满足如下关系因此特别地,对于超大规模矩阵,dr,有σdσr,则Δ(Δ1.从上面的分析可以看出,子空间犡(的奇异值分布集中,条件数小,是一个良性矩阵.与ESN相比,对于同样的扰动信号,FSDESN输出权值变化小,Page5因此,FSDESN模型具有一定的抗干扰能力,泛化性能好.3.4FSDESN计算复杂度分析ESN模型对储备池状态矩阵犡p×N直接求伪逆,计算复杂度为O(N2p+N3),其中p是训练样本数,N是储备池规模.FSDESN模型执行一次Lanczos迭代包括标准化N步,矩阵与向量乘积N2步,正交化4N步,总计N2+5N步,迭代d次,共需(N2+5N)d步[21].所以Krylov子空间方法提取子空间的计算复杂度是为O(N2d),dN.提取出子空间后,对子空间求伪逆,计算复杂度为O(d3+d2p),因此FSDESN模型总体计算复杂度为O(N2d+d3+d2p).除子空间方法外,常用的降维方法还有主成分分析法(PrincipalComponentAnalysis,PCA)[11]和截断奇异值分解法(TruncatedSingularValueDecomposition,TSVD)[12].PCA对状态矩阵的协方差矩阵进行特征值分解,计算特征值的累积误差贡献率,若前d个元素的累积误差贡献率达到某个设定的阈值,则将状态矩阵映射到前d个特征向量张成的空间.TSVD首先计算状态矩阵的奇异值,然后截断前d个大的奇异值对应的成分,d的选取规则为保证条件数σ1/σd小于某一阈值.PCA和TSVD是F范数等价的[13],计算复杂度均为O(N3).故PCAESN[11]模型和基于奇异值截断的T-ESN(TruncatedSingularValueDecompositionforEchoStateNetwork,T-ESN)模型计算复杂度是O(N3+d3+d2p).对于大样本数据,当储备池规模N很大,即pNd时,FSDESN模型计算复杂度最低,PCAESN模型和T-ESN模型其次,ESN模型的计算复杂度最高.因此,FSDESN是一种快速的预测模型.4实验仿真与结果分析为证明本文所提模型的有效性和实用性,将FSDESN模型应用于预测多元混沌时间序列标杆数据Lorenz序列,及实际观测的数据太阳黑子-黄河径流量序列.同时,我们也做了ESN[4]、SVESM[22]、PCAESN[11]和T-ESN模型的仿真实验.ESN模型及其改进模型储备池参数设置与本文所提的FSDESN模型保持一致.选取测试集数据的预测均方根误差(RootMeanSquareError,RMSE)和程序运行时间作为模型预测性能的评价指标.均方根误差计算公式表示如下:其中,y^(t)为ESN网络预测输出值,y(t)为实际观测值,S为测试样本个数.本实验仿真环境为WindowsXP操作系统下MATLAB7.8编程软件,所用计算机内存1.50GB,主频2.66GHz,Pentium(R)4CPU.4.1Lorenz时间序列Lorenz系统是美国气象学家Lorenz模拟大气环流模型建立的三元一阶常微分方程组,表达式如下:当a=10,b=28,c=8/3,x(0)=12,y(0)=2,z(0)=9时,系统具有混沌特性.取步长为0.02,选用四阶Runge-Kutta方法产生2000组时间序列.本文将Lorenz序列的[x(t),y(t)]T作为多元输入,分别设定预测时域η=1和η=6,预测Lorenz序列的x(t+η).首先对输入变量进行相空间重构,根据互信息法计算得到重构参数,分别为τx=8,τy=8,mx=3,my=1.相空间重构后的前100组数据用于消除初始暂态的影响,之后的1000组数据用于训练,250组数据用于测试.FSDESN模型的参数设置如下:谱半径为0.98,稀疏度为0.02,输入变换系数为0.5,子空间算法置信区间选为99%,PCAESN累计误差贡献率阈值选为99.95%,T-ESN截断条件为条件数小于106.仿真过程中,储备池随机初始化,评价指标为50次实验的平均值.表1给出了不同储备池规模下Lorenz单步预测的预测误差ERMSE.表2给出了3种降维技术降维后的维数d、降维时间和模型完成一次预测过程所需的时间.表1Lorenz-狓(狋)单步预测犈RMSE(×10-5)表储备池规模FSDESNPCAESNT-ESNESNSVESM2000.7911.8801.2009.0324.6935000.7675.7850.83318.5894.3648000.9864.5591.85843.0504.301从表1可以看出,FSDESN预测精度略高于其他ESN改进模型,明显高于一般ESN模型.随着储备池维数的增大,基于伪逆算法的ESN模型状态矩阵特征值分散程度增高,条件数变大,不适定性越发严重,产生病态解,预测效果变差.SVESM通过添加正则项,克服病态解问题.FSDESN、PCAESNPage6和T-ESN模型经过降维变换,去掉状态矩阵的过小奇异值的影响.因此,几种ESN改进模型的预测效果随维数增大没有明显变化,相对稳定,预测精度较高,尤其是本文提出的FSDESN模型,均方根误差达到10-6数量级.它应用Krylov子空间方法有效提取出储备池状态矩阵的主要成分,避免了表2不同模型降维后的维数及运行时间表储备池规模FSDESN1110.3209.3441422.54123.6561508.60541.169PCAESN900.90310.0991203.13224.51611817.18251.889T-ESN920.35910.6251302.74223.71012616.55750.090ESNSVESM—在模型效率方面,如表2所示,当储备池规模很小时,模型计算时间普遍很短,3种降维技术提取子空间的速度没有明显差异.但是随着储备池规模增大,快速子空间分解方法(FSD)的优势越来越明显,尤其当储备池规模为800时,对于Lorenz数据,FSD提取子空间的计算时间较TSVD或者PCA分别减少了49.92%和47.06%,模型总体运行时间也小于其他模型.SVESM运行速度最慢,因为它需要搜索最优的储备池参数,耗费了一定的时间.图3给出了FSDESN模型对250组Lorenz混沌时间序列测试数据x(t+1)的单步预测效果图,可以看出预测曲线与期望输出曲线几乎重合,本文所提模型对Lorenz曲线拟合效果很好.图3FSDESN模型Lorenz-x(t+1)预测曲线及误差曲线同时,本文也进行了多步预测,预测步长取η=6,模型参数设置同单步预测.预测x(t+6),子空间方法从储备池状态矩阵犡1000×200的200个列向量中提状态矩阵近似共线性严重,冗余信息多的缺点.从表2可以看出,虽然储备池规模增大,但子空间维数变化很小.此外,文献[23]中FBMNN的预测误差ERMSE为2.046×10-5,由此可以看出,与其他神经网络模型相比,本文的模型也具有更高的预测精度.500—24.250——170.234—取出115个主要列向量得到子空间犡(1000×115.从表3看出,在测试集数据上,FSDESN预测的ERMSE为6.640×10-5,精度较其他方法有所提高.表3Lorenz-狓(狋)6步预测犈RMSE(×10-4)表储备池规模FSDESNPCAESNT-ESNESNSVESM2000.6641.9753.0725.3900.995综上,对于多元时间序列Lorenz数据,不论是单步预测还是多步预测,FSDESN模型均消除了状态向量间的近似共线成分和噪声成分,预测效果优于其他模型.4.2太阳黑子数-黄河年径流量时间序列为进一步验证本文所提方法的有效性和鲁棒性,选取河南省三门峡水文站观测的1700年到2003年的年太阳黑子数-黄河径流量[11]304组二变量数据进行预测分析,此观测数据含有一定量的噪声.FSDESN模型的参数设置如下,储备池内部连接矩阵谱半径为0.98,稀疏度为0.05,输入变换系数为0.1,子空间算法置信区间选为99%,PCAESN误差累积贡献率选为99.99%,T-ESN截断条件为条件数小于105.由关联维数法和伪最近邻域法计算得到相空间重构参数,太阳黑子延迟时间为4,嵌入维数为2,黄河径流量延迟时间为1,嵌入维数为6.因此,相空间重构后得到数据量为304-(6-1)×1=299,将重构后的数据作为输入,预测黄河径流量,单步预测η=1,前20组数据用于消除初始暂态的影响,之后的240组数据用于训练,其余数据用于测试.由于训练样本数据量较小,本实验只在储备池规模为200的条件下,进行仿真实验.表4给出了不同模型预测黄河径流量的50次仿真结果的平均值.图4是FSDESN模型对黄河径流量测试数据的预测曲线及误差曲线.Page7储备池规模维数dERMSE降维时间/s总时间/sFSDESN4942.3050.1360.944PCAESN5046.4820.1561.156T-ESN5349.6810.1671.172ESN—56.141—1.109SVESM—48.569—4.797图4FSDESN模型黄河径流量预测曲线及误差曲线如表4所示,预测黄河径流量,FSDESN模型从状态矩阵犡240×200200个列向量中提取出49个主要列向量构成子空间犡(240×49,去除了状态矩阵近似共线的向量,FSDESN模型预测精度达到42.305,而ESN预测误差为56.141.子空间方法利用Rayleigh-Ritz向量逼近样本协方差矩阵的特征向量,虽然仍存在一定的逼近误差,但是与其他ESN改进模型相比,预测精度较高,很好地描绘出黄河径流量的动力学特性,验证了本文模型的抗干扰性和鲁棒性.在计算时间方面,由于数据量比较少,模型所用时间普遍较短,但仍可以看出FSDESN提取子空间的效率较PCAESN和T-ESN有所提高,并且完成一次完整预测过程的时间较ESN和其他ESN改进模型也有所减少.以上分析验证了本文所提模型对含噪声的多元时间序列预测的有效性.5结束语本文根据多元时间序列预测的特点,构造了基于快速子空间分解方法的回声状态网络(FSDESN)模型,预测多元时间序列.储备池状态矩阵规模庞大且结构稀疏,具有较多冗余信息.Krylov子空间分解方法是一种高效的矩阵成分分析方法,利用快速子空间分解方法提取储备池状态矩阵的子空间,将子空间代替原状态矩阵进行输出权值求解,消除了状态矩阵行向量或列向量的近似共线性,降低了计算复杂度,解决了病态解问题,保证了网络的稳定运行.实验结果表明,FSDESN模型的预测精度和计算效率较其他预测模型有所提高,本文所提模型在多元时间序列预测中具有实际应用价值.
