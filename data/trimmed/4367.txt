Page1几类对称布尔函数的非线性度、代数次数和代数免疫阶孙光洪1)武传坤2)1)(河海大学理学院南京210098)2)(中国科学院信息工程研究所信息安全国家重点实验室北京100190)摘要该文讨论了几类偶数个变元n的对称布尔函数的一些密码性质,包括非线性度、代数次数、代数免疫阶、严格雪崩准则和相关免疫性等.我们的讨论显示这些对称布尔函数有好的非线性度和代数次数,并且有两类对称布尔函数的代数免疫阶达到最大n不满足严格雪崩准则,因此这些布尔函数都不能直接应用到密码系统中.关键词布尔函数;非线性度;代数次数;代数免疫阶;严格雪崩准则;相关免疫性1引言在构造密钥流生成器时,传统的方法一般是采用线性移位寄存器和非线性布尔函数的组合,因此密码系统对应的布尔函数f(x):Fn一定的密码准则,才能提高密码系统抵抗各种密码攻击的能力.常用的攻击方法有Siegenthaler的相关攻击[1]、BerlekampMassey的线性综合[2],其他的线性逼近方法[3]以及代数攻击方法[4-5].目前关于布尔函数的密码准则主要有平衡性、非线性度、代数次数、整体非线性度以及相关免疫性和代数免疫阶等.非线性度主要是衡量函数的线性逼近程度[6-7],而整体非线性度则是衡量函数的扩散程度[8].为了抗击线性逼近攻击,我们构造的布尔函数必须要有高的非线性度.要抗击BerlekampMassey的线性综Page2合攻击,必须要求所构造的布尔函数有高的代数次数.近年来,出现了一种新的强有力的攻击方法[4-5]:代数攻击.它是通过解超定的多元方程组来恢复秘密密钥,这种攻击方法近年来受到很多研究者的青睐.对于n元布尔函数f,代数攻击的核心是发现f或者1+f的次数最低的非零的零化子g,即使得f·g=0或者(1+f)·g=0的布尔函数g.为了实现代数攻击,需要有代数次数低的零化子.相反的,为了避免代数攻击,必要条件是必须要求构造的布尔函数及其补无代数次数低的零化子,即布尔函数的代数免疫阶较高.如何构造代数免疫阶较高的布尔函数,尤其是构造代数免疫阶最优的布尔函数一直是代数攻击方法提出之后在密码学研究中的一个热点问题.布尔函数是很多密码系统的核心构件,因此布尔函数密码学性质直接关系到密码系统的安全性和可靠性.因此在密码学应用中用到的布尔函数必须要求布尔函数具有好的密码学性质,从而可以抗击某些已知的密码学攻击,例如:线性密码攻击、差分攻击、相关攻击和近来提出的代数攻击等.与上面攻击方法相对应的密码学性质分别为布尔函数的非线性度、差分均匀性、相关免疫性和代数免疫阶等.对称布尔函数(定义见第二部分)由于其表示方法的简单性和具有一些有趣的性质[9-13],因此在布尔函数的研究中对对称布尔函数的研究引起很多研究者的兴趣.但是对称布尔函数是否可以用到密码学系统中呢?即对称布尔函数的密码学性质是否比较好?这是我们本文要研究的主要问题,即我们研究了两类达到最大代数免疫阶的布尔函数的其他密码学性质:非线性度、代数次数、相关免疫性、严格雪崩准则等.研究这些密码学性质的目的是发现这些对称布尔函数在密码学意义下的漏洞或者弱点,从而在应用的时候避免这些漏洞和弱点,使得设计的密码系统是安全的和可靠的.Dalai等人在文献[14]中构造了如下偶数个变元的布尔函数,f(x1,x2,…,xn)=,并证明了此类函数的代数免疫阶为n它的一个子类(为对称布尔函数,即布尔函数当输入变量的重量相同时,布尔函数的值也相同)f1(x1,x2,…,xn)=的非线性度为2n-1-Cnx表示不超过x的最大整数.显然f1是f取b全为零时的特殊情况,因此f1的代数免疫阶也为n在f中,当b全取1时,得到对称布尔函数f2:f2(x1,x2,…,xn)=由于f的代数免疫阶为nn2.但在文献[14]中没有讨论f2的代数次数和非线性度.为了解决这一问题,我们引入下面的对称布尔函数,f0(x1,x2,…,xn)=易知它们之间有如下的关系因此它们之间的密码性质应该具有一定的联系.由于f1,f2的代数免疫阶已经达到最大,f0的代数免疫阶是否也会达到最大?这是我们第3节要讨论的问题.虽然对称布尔函数f1,f2的代数免疫阶达到最大,但是在密码分析方法中除了代数攻击外还存在其他一些重要的密码攻击方法,例如:线性密码分析、相关攻击等.因此构造的密码函数除了要能够抗击代数攻击外还必须能够抗击线性攻击、相关攻击等.而且必须要求这些函数满足其他的密码性质,例如:高的非线性度、具有相关免疫性、满足严格雪崩准则等.这是第3节讨论的另一个问题.通过讨论我们发现这些对称布尔函数有好的非线性度和代数次数,并且f1,f2有最大的代数免疫阶,而f0的代数免疫阶为1.但它们几乎不满足严格雪崩准则和相关免疫性,因此它们都不能直接应用到密码系统中.在下一节我们给出了在第3节将要用到的基础知识,最后第4节是结束语.2预备知识设F2是二元域,FnPage3f(1,1,…,0),…,f(1,1,…,1)].2到F2上的函数称为布尔函数,Bn表示从FnFn的全体布尔函数集.布尔函数f(x1,x2,…,xn)最基本的表示方法是通过长为2n的真值表表示:f=[f(0,0,…,0),f(1,0,…,0),f(0,1,…,0),上面这个长为2n的二元串中1的个数称为布尔函数f的重量,记为wt(f).集合supp(f)={x∈Fnf(x)=1}称为布尔函数f的支撑集.两个n元布尔函数f,g的距离d(f,g)为布尔函数f+g真值表中1的个数,即布尔函数f+g的重量,其中+是F2上的加.如果n元布尔函数f的重量为2n-1,称函数f是平衡的.由于布尔函数的真值表表示方法不能很好地研究布尔函数的代数性质,所以我们需要布尔函数的其他表示方法.布尔函数f的另一种表示方法是多元多项式表示,即每一个n元布尔函数f都可以唯一的表示为F2上的多元多项式,即f(x1,x2,…,xn)=a0+∑1in其中系数a0,ai,aij,…,a12…n属于{0,1},+为F2上的加法,称为布尔函数f的代数正规型.函数f的代数次数deg(f)为布尔函数f的代数正规型表示中系数不等于零时单项式中最大的变量个数.代数次数deg(f)小于等于1的布尔函数f称为仿射布尔函数;全体仿射布尔函数用An表示.常数项为零的仿射布尔函数称为线性布尔函数.设f是n元布尔函数,函数f的Walsh变换为其中w=(w1,w2,…,wn),x=(x1,x2,…,xn),w·x=w1x1+w2x2+…+wnxn.称{Ff(w)|w∈2}为布尔函数f的Walsh谱.Fn到所有仿射布尔函数的最小距离,即设f是n元布尔函数,f的非线性度nl(f)为f容易验证布尔函数f的Walsh谱和非线性度有如下关系:由Parseval等式∑w∈Fn2n-1-2nbent函数.从上面容易看出bent函数只可能在n是偶数时存在,并且bent函数是达到最大非线性度的函数.设f是n元布尔函数,如果对满足1wt(w)k的所有w∈Fn阶相关免疫性.平衡的k阶相关免疫函数称为k阶弹性函数,即如果对所有满足wt(w)k的w都有Ff(w)=0,称f是k阶弹性函数.在设计密码函数时必须要求设计的布尔函数满足相关免疫性和弹性,以防止相关攻击.称Δf(w)=∑x∈Fn自相关函数,{Δf(w)|w∈Fn关谱.如果对所有满足wt(w)=1的w都有Δf(w)=0,称布尔函数f满足严格雪崩准则.设f是n元布尔函数,如果存在非零的g∈Bn使得f·g=0,称g为布尔函数f的零化子.称AN(f)={g∈Bn|f·g=0}为f的零化子集.称f或1+f的零化子的最小代数次数为f的代数免疫阶或者代数免疫度,记为AIn(f).为了避免代数攻击,要求所给的布尔函数的代数免疫阶越高越好,但在文献[5]中证明了:对任意布尔函数f∈Bn有AIn(f)nx表示不小于x的最小整数.一个布尔函数f称为对称布尔函数,如果当(x1,x2,…,xn)的重量相同时,f(x1,x2,…,xn)的取值也相同.从而可以将n元布尔函数f简化为n+1比特串ref的形式,即当wt(x1,x2,…,xn)=i时,ref(i)=f(x1,x2,…,xn).明显的,在布尔函数的代数正规型中,对称布尔函数或者含所有相同次数的单项式或者都不含,因此又可以将n元对称布尔函数的代数正规型简化为n+1比特串raf的形式,即当所有次数为i的单项式都出现时raf(i)=1,否则raf(i)=0.故对称布尔函数f的ref,raf都是{0,1,2,…,n}到{0,1}的映射.文献[11]定理3给出了函数ref,raf之间的关系:其中0in.文献[15]第85页给出了两个整数序列的关系:显然由上面两个公式可得Page4为了后面讨论对称布尔函数的非线性度,我们引入Krawtchouk多项式,详见文献[13,16].次数为i的Krawtchouk多项式为并且对满足wt(w)=k的固定的w有因此对称布尔函数f∈Bn,wt(w)=k,有故对称布尔函数f∈Bn,当wt(α)=wt(β)时,有Ff(α)=Ff(β).因此对称布尔函数f的Walsh谱可以简化为rwf(i)的形式,即当wt(w)=i时,rwf(i)=Ff(w).Krawtchouk多项式有性质Ki(k,n)=(-1)kKn-i(k,n),更多的性质参考文献[16].下面我们讨论布尔函数f0,f1,f2的非线性度、代数次数、代数免疫阶等密码学性质.3犳0,犳1,犳2的非线性度、代数次数、代数免疫阶、相关免疫性和严格雪崩准则3.1犳0,犳2的非线性度非线性度衡量布尔函数抗击线性密码攻击的能力,因此布尔函数应用到密码系统中必须要求具有高的非线性度.上面三类对称布尔函数是否具有高的非线性度,即这三类对称布尔函数是否可以抗击线性密码分析?在下面我们给出这三类布尔函数的非线性度.设A={(x1,x2,…,xn)∈Fnxn)=n2},则A可分解为A=B∪C,使得B∩C=,并且B中每个元与C中某个元互补,反之也成立.定理1.布尔函数f0(x1,x2,…,xn)的Walsh谱为Ff0(w)=证明.Ff0(w)=∑x∈Fn特别地,当w=0时,我们有Ff0(0)=2n-2Cnw≠0时,我们有Ff0(w)=-2∑x∈A因此,如果wt(w)=2l,则Ff0(w)=-4∑x∈B如果wt(w)=2l+1,则Ff0(w)=0.因此,Ff0(w)=故定理得证.由于|B|=|A|因此为了求f0的非线性度,我们需要下面的引理.引理1.当n10时,2n4Cn定理2.当n10时,布尔函数f0的非线性度2n.证明.由引理1,当n10时有2n-2Cn为Cn此maxw∈Fn2因此有定理得证.因此要考虑布尔函数f0对任意n的非线性度,现只需分别讨论n=2,4,6,8时,布尔函数f0的非线性度即可.(1)当n=2时,由于f0(0,1)=f0(1,0)=1,f0(0,0)=f0(1,1)=0,故f0(x1,x2)=x1+x2,因此nl(f0)=0.Page5(4)当n=8时,|Ff0(a)|=|Ff0(1,1,1,1,1,1,1,1)|=140,max0≠a∈F82而Ff0(0)=28-2C4Walsh谱.(2)当n=4时,max1,1)|=12,而Ff0(0)=24-2C223-6=2.(3)当n=6时,max1,1,1)|=40,而Ff0(0)=26-2C325-20=12.下面讨论f2的非线性度,为此先分析f2的引理2[17].当w≠0时,有Ff+g(w)=Ff(w)+由于对任意的x,都有f0(x)f1(x)=0.故当Fg(w)-2Ffg(w).w≠0时Ff0f1(w)=∑x∈Fn因此当w≠0时,Ff0+f1(w)=Ff0(w)+Ff1(w).故当wt(w)=k为奇数时,|Ff0+f1(w)|=|Ff0(w)+Ff1(w)|=|Ff1(w)|.从文献[14]定理3的证明知当0kn时有|rwf1(k)|rwf1(1)=2Cnk为奇数时,|Ff0+f1(w)|rwf1(1),即当wt(w)=k为奇数时,|rwf2(k)|rwf1(1).当wt(w)=k≠0为偶数时有rwf2(k)=∑n由于2(k,n)|=∑|Kn故当wt(w)=k为非零偶数时|rwf2(k)|Cn当w=0时,Ff2(0)=∑x∈Fn因此|max2n-1-1定理3.对称布尔函数f2的非线性度为2n-1-2n.12Cn3.2三类对称布尔函数的相关免疫性和严格雪崩准则应用在密码系统中的布尔函数必须满足相关免疫性和严格雪崩准则,以抗击一些密码攻击.在密码函数的设计中,平衡性是布尔函数必须满足的一个最基本的性质,对于上面三类对称布尔函数的平衡性:显然函数f1,f2是不平衡的.而布尔函数f0的平衡性有下面的定理:定理4.布尔函数f0(x1,x2,…,xn)不平衡,证明.由布尔函数f0的定义可知,wt(f0)=除非n=2.由定理1知道f0满足1阶相关免疫性.对称布定理5.对称布尔函数f1,f2不满足一阶相关证明.由一阶相关免疫性的定义,我们需要计2n.因此,要使f0(x1,x2,…,xn)平衡,则只需CnCn2n-1,则只有n=2时成立.尔函数f1,f2的相关免疫性有下面的定理.免疫性,因此也不满足r阶(r1)相关免疫性.算Ff1(w),Ff2(w),其中wt(w)=1.设w∈Fnwt(w)=1,则Ff1(w)=∑x∈Fn=∑wt(x)n=∑wt(x)n=∑x∈Fn=-2∑wt(x)>n=-2∑w·x=1,wt(x)>n2Page6(=-2(-(Cn(Cnn-1+Cn2+12n-1,=2CnFf2(w)=∑x∈Fn=∑wt(x)<n=∑wt(x)<n=-2∑wt(x)n=-2∑wt(x)n=-2(-(Cn(Cn2n-1+Cn=2Cnn-1.2-1由Ff1(w)和Ff2(w)知对任意使wt(w)=1的w不可能使Ff1(w)=0,Ff2(w)=0.因此对称布尔函数f1,f2不满足一阶相关免疫性,显然也不满足r阶(r1)相关免疫性.定理6.对称布尔函数f0不满足严格雪崩准则,f1,f2只在n=2时满足严格雪崩准则.证明.设wt(w)=1,则Δf0(w)=∑x∈FnΔf1(w)=∑x∈FnΔf2(w)=∑x∈Fn4Cn理得证.显然对任意正整数n,2n-4Cn2n-1=0和2n-4Cn因此在n≠2时,上面三类对称布尔函数都不满下面我们讨论布尔函数f0,f2的代数次数.由第二部分及f0的定义:当wt(x1,x2,…,xn)=足扩散准则.3.3犳0,犳2的代数次数n2时,f0(x1,x2,…,xn)=1.故ref0ref0(i)=0,i≠n时,raf0(i)=0;raf02imod2.因此要讨论f0的代数次数,由上面raf(i)Cn的定义,只需讨论最大的i使得Cn的i就是f0的代数次数.定理7.设n=2l,则当2k-1l<2k-1时,f0的代数次数deg(f0)=2k-1.证明.我们只需证明:Cli2l时,Clj,0j<2k-1-1,因此事实上,由于2k-1l<2k-1,故可设l=2k-1+Cl2k-1=Cj首先证明2k-m和m的因子中所含2的方幂数相同,1mj.事实上,设m=2ie,(2,e)=1,则2k-m=2k-2ie=2i(2k-i-e).由于e是奇数,故2k-i-e是奇数.因此(2k-i-e,2)=1,即2k-m和m的因子中所含2的方幂数相同.故(2k-1)(2k-2)…(2k-j)j(j-1)(j-2)…2·1是奇数.下面证明当2ki2l时,Cl(1)ClCl同上面的证明方法可得(2k-1)(2k-2)…(2k-l+1)是奇数.由于2k-1l<2k-1,故可设l=2k-1+j,从而Cl偶数.(2)同上证明方法可得Ci(3)利用递推公式CmPage7Cl-12k+Cl同样的证明方法,通过递推公式Cmn,可得ClCm-1得证.定理8.设n=2l,则当2k-1l<2k-1时,对称布尔函数f2的代数次数deg(f2)=2k.证明.由于f2=f0+f1,并且当2k-1l<2k-1时f0,f1的代数次数分别为2k-1,2k,故f2的代数次数为2k.3.4犳0的代数免疫阶由于f1,f2的代数免疫阶在文献[14]中已经讨论过,并且得到两者都达到代数免疫阶的最大值n那f0=f1+f2的代数免疫阶如何呢,是否也可以达到代数免疫阶的最大值?这是下面要讨论的问题.定理9.f0的代数次数最低的零化子为线性布尔函数或者仿射布尔函数,因此f0的代数免疫阶为1.证明.设g是f0的零化子.由于当wt(x)=n2时,f0(x)=1,故由f0·g=0,得g=0.设g(x1,x2,…,xn)=a0+∑n下面只需证明存在ai≠0使得f0·g=0,i=0,…,n,则g就是f0的代数次数为1的零化子.事实上,如果nf0·g=0.否则取a0=1,ai=1,1in,则有f0·g=0.因此f0的代数次数最低的零化子的次数为1.故f0的代数免疫阶为1.上面我们讨论了三类对称布尔函数的一些密码学性质:代数次数、非线性度、代数免疫阶、相关免疫性和严格雪崩准则等.通过这些讨论可以发现这些对称布尔函数用在具体密码系统中可能存在的密码学漏洞和弱点.从我们的讨论可以发现上面三类对称布尔函数都不能直接用在具体的密码系统中,因此构造可以直接用在具体密码系统中的具有良好密码学性质(高的代数次数、最优代数免疫阶、较高的非线性度、具有相关免疫性、满足雪崩准则等)的布尔函数是众多密码学研究者所关注的重点问题,同时也是一个非常困难的问题.就构造具有较好密码学性质的布尔函数的方法来说总的就两类方法:直接构造法和间接构造法.直接构造法是直接构造具有良好密码学性质的布尔函数,例如上面的三类对称布尔函数就是直接构造方法构造的.通常的做法是先构造布尔函数使一些密码学性质达到最优或者次优,然后通过适当的修改使其他密码学性质也较优.在直接构造方法中通常利用几何、编码理论、代数例如群论等中的方法和结论来构造具有较好密码学性质的布尔函数[18].间接构造法是利用已有的密码学性质较好的布尔函数构造新的密码学性质较好的布尔函数,例如:级联方法就是一种比较常用的间接构造方法,并且可以构造出密码学性质较好的布尔函数[19-20];另一种比较常见的间接构造方法是利用等价关系[21].就我们所知,现阶段所构造的具有最优代数免疫阶的布尔函数,通常研究者讨论比较多的是研究所构造布尔函数的非线性度和代数次数,但是对所构造函数的相关免疫性、雪崩准则等其他密码学性质很少有研究者涉猎[18,22].因此讨论现有的具有最优代数免疫阶的布尔函数的其他密码学性质是我们下阶段关注的问题,当然这也是一个比较困难的问题,尤其是在有限域上讨论布尔函数的相关免疫性、雪崩准则等密码学性质.4结束语本文讨论了几类对称布尔函数的非线性度、代数次数、代数免疫阶、相关免疫性和严格雪崩准则等,通过对这些布尔函数的讨论,我们得到这些布尔函数的非线性度、代数次数都比较高,并且其中两类布尔函数的代数免疫阶达到最大,另一类布尔函数的代数免疫阶为1.虽然它们的非线性度与布尔函数能够达到的最大非线性度2n-1-2n距离,但它们的非线性度还是非常大,因此能够很好的抗击线性密码分析.同样对于代数次数,它们的代数次数也非常高,尤其是当n=2k时,分别达到最大的代数次数2k,2k-1.但是从我们的讨论可以看出这几类对称布尔函数也有一些密码强度不好的性质,比如:不具有平衡性、不具有相关免疫性(弹性)、不具有扩散性等.因此这些布尔函数都不能直接用到密码系统中.其他对称布尔函数的密码学性质有待进一步的研究.致谢审稿人给出了宝贵的审理意见,在此表示感谢!
