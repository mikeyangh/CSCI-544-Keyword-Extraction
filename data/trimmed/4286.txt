Page1基于双域信息融合的鲁棒二值文本图像水印朱新山1),2)陈砚鸣2)董宏辉3)丁杰2)1)(天津大学电气与自动化工程学院天津300072)2)(扬州大学信息工程学院江苏扬州225009)3)(北京交通大学轨道交通控制与安全国家重点实验室北京100044)摘要该文提出了一种适用于二值文本图像的双域水印方案.该方案生成水印模板作为离散余弦变换域信号,然后将其与要嵌入的信息进行调制.在水印嵌入之前,调制后的信号被变换到空间域中,并调整局部嵌入强度使得水印信号适合人类视觉系统的特征.水印提取采用相关检测器,可在变换域内或空间域内操作,而且,从理论上分析了感知整形过程与翻转像素点个数对水印提取的影响.为了抵抗水印同步信息损失,将提出的双域水印方案与一个图像归一化方案相结合.此归一化方案采用了文本倾斜检测与字符分割技术,适合于文本图像的特点.实验表明,提出的方案对常见的图像处理操作、几何攻击和打印-扫描过程具有良好的鲁棒性.关键词数字水印;二值文本图像;双域;鲁棒性;打印-扫描1引言随着印刷、复印与扫描技术的发展,文档的复制、传播变得非常容易,文档信息的安全面临着极为严重的挑战.文本数字水印是一种解决文档安全问题的有效技术.它能实现在不影响文档内容的情况下嵌入水印信息,并通过设计满足不可见性、鲁棒性和信息容量等方面的要求,从而可以适应不同的文档保护需求.目前,文本水印技术的研究得到了广泛的关注[1].一种简单的文本水印方案是通过修改字符间距嵌入隐藏信息[2].这种水印的嵌入位置固定,安全性差,只适合格式化的文本图像.文献[3-5]提出通过改变单个字符的特征嵌入水印.可以利用的特征很多,例如字高、字宽、笔画、字体等,因此这类方案的水印容量很大,但是,水印检测过程依赖于字符特征的提取,甚至要求某一特征在像素变化中的详细数据.自然语言处理技术也被用于水印的嵌入和提取[6-7],但这种方法需要修改文本内容,有损文本信息.另一种文本水印在像素级上进行操作,通过翻转像素改变像素的统计特征嵌入水印信息[8-12].Wu等人[8]利用量化函数改变黑色像素点的个数隐藏水印信息,文献[9-11]则通过量化局部黑色像素点的个数与全局黑色像素点的个数之比嵌入水印信息,在此基础上,Guo等人[12]进一步提出使用多进制的线性调制函数嵌入水印信息.由于选择水印嵌入位置考虑了人眼的感知特性,这种水印一般具有较好的视觉效果.以上几类方案都属于空间域的文本水印,由于只考虑了空间域的信息,它们的鲁棒性普遍较差.众所周知,基于变换域的水印方案可获得更强的鲁棒性[13].然而,对二值图像而言,变换与逆变换过程引入的误差会破坏水印信息和图像质量,因此传统的变换域水印方案不能直接用于二值图像.在文献[14]中,Lu等人提出先将二值图像通过模糊化预处理转换成灰度图像,再进行离散余弦变换(DiscreteCosineTransform,DCT),水印信息则嵌入到图像的直流分量上.显然,模糊化过程会对水印造成不利的影响,而且修改直流分量仅相当于给图像空间域所有像素增加一个相等的常量.文献[15]提出了一种联合DCT和离散小波变换(DiscreteWaveletTransform,DWT)的二值文本水印,对二值图像作DWT,然后对水印图像作DCT并排列之后嵌入到二值图像DWT域的细节子图中去.该方案虽然获得了较好的鲁棒性,但是水印的不可见性较差.Yang等人[16]设计了一种利用形态小波变换的水印方案,不仅提高了水印容量,而且降低了水印嵌入失真.可惜,这是一种脆弱水印,不能抵抗常见的攻击.Xia等人[17]给出了一种二值图像的双水印设计思想,其中一个水印被嵌入到多级小波变换的低频子带分量中,获得了较好的鲁棒性,只是提取水印需要一个很长的密钥.设计适合二值文本图像的鲁棒水印比普通图像更加困难[18-19].这是由该类图像的色彩、字形和语意所决定的[19].同时,还必须考虑抗几何攻击和打印—扫描(Print-Scan,PS)操作,除了信息损失以外,它们会导致同步信息丢失,致使水印检测失败.为此,本文研究了文本图像的归一化方案.让水印嵌入和提取在归一化后的图像上进行,可解决同步信息丢失问题.另一方面,本文将提出一种适合文本图像的双域水印(DoubleDomainWatermarking,DDW).该方案可联合使用空间域和变换域的信息,提升水印对一般图像处理操作的鲁棒性,并避免在变换域中操作二值图像引入的不利影响.本文第2节提出一个文本图像的归一化方案;第3节描述DDW的水印生成与嵌入过程,并解释DDW水印实现所涉及的一些关键问题;第4节致力于设计DDW的水印整形函数;第5节给出DDW水印的提取过程,并分析感知整形过程与翻转像素点个数对水印提取的影响;第6节对提出的水印方案进行了性能测试和评估;第7节为总结.2文本图像的归一化将要操作的文档图像变换为标准图像的过程称为图像归一化.标准图像具有一组预先设定的几何参数值,归一化过程利用图像的信息寻找一组合适的变换参数,将原始图像变换为标准形式.在标准图像上进行水印嵌入和检测可以应对同步信息损失问题[20].图像归一化过程可用仿射变换表示.设图像g(x,y)是图像f(x,y)进行仿射变换后生成的新图像.一个仿射变换对应于一个变换矩阵与坐标向量的乘积.变换矩阵犃是2×2维的,记为犃=(aij)2×2,犱=(d1d2)T表示平移向量,则我们可写g(x,y)=f(xa,ya),其中(xaya)T=犃(xy)T-犱.变换矩阵犃可通过旋转和尺度缩放两步独立的变换获得,即Page3根据上述分析,文本图像归一化过程可分解为此处,θ表示旋转角度,βx和βy分别表示水平方向和垂直方向上的缩放因子.因此,只要设定图像g(x,y)的角度、尺度和平移量,就可以获得相应的变换矩阵犃和平移量犱.如下3个步骤.步骤1.角度归一化.通过找到将原图像f(x,y)变换为标准图像时所需要的旋转角θ可以实现角度归一化.如果规定标准图像的文本行基线是水平的,那么θ应取图像的文本行基线与水平方向夹角的负值.这属于一类文档倾斜度校正问题[21].本文采用基于Hough变换和多角度投影相结合的方法检测θ角.首先,对文档图像进行二值化、滤波和边缘检测等必要的预处理,得到图像fp(x,y)[19].然后,通过对图像fp(x,y)进行Hough变换计算θ角.由于中文笔画的分布存在不均匀性,Hough变换可能得出虚假角度.图1(a)内,虚线区笔画构成两条直线,分别对应Hough变换后的峰值点P2,P3,见图1(b),据此确定旋转角度显然会产生明显的误差.为了剔除虚假角度,沿Hough变换后图1测试图像与测试图的Hough变换结果得到的每个候选角度方向计算文档图像的投影,并选择白点个数方差最大的方向作为图像的倾斜角[21].另外,考虑到计算复杂度,Hough变换得到的θ角精度有限.为了提高精度,以θ角为中心设定一个搜索区域和步长Δθ,再次运用投影法确定该区域内的一个最佳角度.显然,θ角的精度取决于搜索步长Δθ.步骤2.尺度归一化.通过确定缩放比βx和βy可实现尺度归一化.如果规定标准图像中所有文本字符的平均宽度和高度为珚xs×珔ys,则βx和βy应分别取βx=珚xs/珚xo和βy=珔ys/珔yo,其中,珚xo和珔yo分别表示原始图像中所有文本字符的平均宽度和高度.珚xo和珔yo的计算需要使用字符分割技术,这方面已有许多成熟的算法[22].为了展示实验效果,本文采用了一种简单的基于投影的字符分割方案.在分割前需要对fp(x,y)进行倾斜度校正,之后进行水平方向和垂直方向的投影.每个字符图像的投影在其上下左右的起始位置处会形成局部极值点,从而可以确定每个字符的位置,投影效果如图2所示.图3(a)显示了字符分割后的结果.步骤3.平移变换.文档图像普遍都有页边图2测试图像的水平方向投影和垂直方向投影(首行)Page4图4DDW文本水印生成与嵌入过程3.1水印生成水印生成过程可以分解为3步:水印信息编码、水印模板信号生成和水印信号调制.步骤1.水印信息编码.一般,先将m表示为一个长为l的二元双极性序列b,它的每个元素bi满足bi∈{-1,1}.该过程可采用纠错编码技术,以提高水印信息解码的正确率.步骤2.水印模板信号生成.对bi,利用随机数发生器产生一个长为Li的随机数序列,记为wri.然后,通过补零,将wri扩展成一个与图像犡o具有同样尺寸的矩阵信号珦犠ri,wri元素所在的位置就是水印的嵌入位置,记为i.为安全起见,随机数序列wri(i=1,…,l)的生成以秘钥K为种子,同时,嵌入位置i是随机选择的.在提出的DDW方案中,珦犠ri(i=1,…,l)将被视作DCT域内的信号,因此,嵌入位置i应选择在图距,为了剔除平移变换的影响,可以默认标准图像没有页边距,或者说页边距都为零.这样,就可以确定去除左侧和顶部页边距所需要的平移向量犱.原始图像页边距的位置可由字符分割方案获得.利用获得的变换矩阵犃对原始图像进行仿射变换,再去除页边距则获得标准图像.图3(b)显示了图1(a)经过归一化后的结果.水印嵌入和检测可以在归一化后的标准图像上进行,以获得对同步信号损失的鲁棒性.当然,在完成水印嵌入后应实行一个逆向归一化过程将加水印的图像恢复成原始图像的几何参数.注意到,由于对图像的归一化和逆归一化操作也会引入额外的噪声,从而降低水印的性能.为此,可采用一种替代方法,对水印信号实施(逆)归一化操作[20].3DDW水印生成与嵌入设犡o是一幅尺寸为N1×N2的二值文档图象,待嵌入的水印信息为m.图4给出了DDW水印生成与嵌入过程,具体描述如下.像的中频区域,以取得水印鲁棒性和不可见性的良好折中.另外,考虑到DCT变换的能量压缩效果对加水印图像质量的影响,水印模板珦犠ri中的随机数应服从一个均值为零的对称分布.详细解释请参考文献[19].具体地,所用的随机数服从标准正态分布.步骤3.水印信号调制.将得到的l个水印模板信号与嵌入信息实行线性调制,合并为一个调制后的水印信号珦犠m,即为了避免水印提取时珦犠ri与珦犠rj之间的相互干扰,相应的嵌入位置i与j须满足i∩j=,i≠j.3.2水印嵌入现在,将水印信号珦犠m嵌入到图像犡o中,该过程可以分解成3步:逆DCT变换、感知整形和水印信号嵌入.Page5为DCT域内的信号,水印嵌入操作需要在二值图像的DCT域内进行.但是,对二值图像实施DCT变换和DCT逆变换会对水印信号造成很大的损失,为避免此问题,一种代替的方法是对水印信号珦犠m实施逆DCT变换,使水印嵌入在空间域内进行.结果,我们有犠m=IDCT(珦犠m),这里犠m表示珦犠m对应的空间域信号.步骤2.感知整形.为了获得一个理想的水印,既能保证水印的鲁棒性,又能尽量减少对图像质量的影响,需要使用人类视觉模型(HumanVisualModel,HVM)对信号犠m进行感知整形.感知整形后的水印信号犠s可以一般的表示为其中,Ψ(·)是整形函数,犛表示人眼对图像犡o上每个像素点引入噪声的灵敏度,可由HVM确定.Wu等人[8]建立了一种适合二值图像的HVM.该模型根据局部连通性和平滑度计算每个像素点的可修改度,可修改度位于0~0.625之间,并被均匀地分成6个级别,其数值越高表示人眼对噪声的灵敏度越低.本文采用由该模型获得的可修改度作为矩阵犛.整形函数Ψ(·)的设计将在下节中讨论.步骤3.水印嵌入.将获得的信号犠s直接叠加到图像犡o上,得到矩阵犡w,即最后,犡w还需经过一个二值化过程获得最终的加水印文本图像犡b,此处,xw(x,y)和xb(x,y)分别是矩阵犡w和犡b位于(i,j)的元素,τ代表二值化阈值,可设为τ=0.5.采用恒定二值化阈值的原因是通过设计整形函数Ψ(·)同样可以影响控制二值化过程.可以看出,DDW为提升水印性能融合考虑了多种因素:(1)嵌入位置i(i=1,…,l)的选择使用了DCT域的信息;(2)水印模板珦犠ri(i=1,…,l)的构造考虑了DCT变换的特点和随机数的分布特征;(3)水印信号整形使用了空间域HVM.另外,水印嵌入过程中只对水印模板信号进行一次逆DCT操作降低了计算的复杂度.DDW的思想可以扩展用于其它类型的图像和多媒体信号(例如视频和音频),也可以用其它信号变换域来实现.4整形函数的设计整形函数在提升水印图像质量与水印鲁棒性方面扮演着关键角色.为了说明整形函数的设计方案,首先讨论影响二值文档图像质量的因素.4.1影响二值文档图像质量的因素分析在水印领域中,信噪比(Signal-to-NoiseRatio,SNR)常作为一种客观的评价指标,用于衡量加水印图像的质量.SNR是信号能量与噪声能量的比值,定义为ξ=‖犡o‖2/‖犠b‖2,此处,犠b是犡o与犡b的误差信号,写作犠b=犡b-犡o.对于二值文档图像,由于像素点的值非0即1,信号能量‖犡o‖2等于白色像素点的个数Nw,噪声能量‖犠b‖2等于水印嵌入过程中导致的翻转像素点的个数Nf,因此,SNR又可等价的定义为ξ=Nw/Nf.SNR表达了翻转像素点的个数Nf对图像质量的影响.但这是不充分的,因为图像质量还与翻转像素点的位置有关.根据文献[8],可修改度矩阵犛可以较好的体现位置因素对图像质量的影响.另外,文档图像是由许多独立的字符构成的,每个字符是一个独立的子图而且有独立的语意.这一特征决定了对一个字符的修改不会影响到其它字符的质量.因此,我们有必要在设计整形函数时单独考虑每个字符的复杂度.直觉上,每个字符的质量与该字符内被翻转像素的平均修改度成正比,与其中包含像素点的总数成正比.仿此,我们用每个字符中像素点总数与所有像素点的平均修改度的乘积即修改度之和表示字符的复杂度,可写作此处,Ak表示利用字符分割技术得到的第k个字符所占据的坐标区域.利用该定义,我们设计一个新的矩阵犜,定义如下此处,Nt表示目标文档图像中含有独立字符的个数.注意到矩阵犜的元素包括了归一化的复杂度因子和1(对应非字符区域).4.2感知整形根据水印嵌入应优先修改对噪声不敏感的像素Page6点同时侧重修改复杂度高的字符的原则,整形函数可以定义为其中,α表示全局水印嵌入强度,符号“·”表示将两个矩阵/向量的对应元素相乘.式(6)表明在像素点的可修改度高的位置和字符复杂度显著的区域,水印的嵌入强度将被扩大,这符合人的视觉特征,而且通过嵌入强度α可控制翻转像素点的个数.式(2)和(6)可得进一步,如果给定翻转像素点的个数为Nf,由考虑到二值化过程(3)的影响,根据式(7)得出的α不是最佳的.最佳的α可通过在理想α周围搜索获得.设搜索范围为[λ0α,λ1α](λ0<1,λ1>1),搜索步长为Δ,得出一组嵌入强度的参考值,λ0α,λ1α+Δ,…,λ1α.利用它们嵌入水印,并计算出对应的一组翻转像素点的个数,通过找出与设定的Nf距离最小的翻转像素点的个数即可确定α.5DDW水印提取本节将给出DDW的水印提取方案,并讨论有关水印提取的两个问题:水印整形方案对水印提取的影响以及像素点翻转个数与水印提取性能的关系.5.1水印提取设犡u是一幅待提取水印的二值文档图象,尺寸为N1×N2,DDW提取水印过程如图5所示.详细描述如下.步骤1.对图像犡u施行DCT操作,得到DCT系数珟犡u,珟犡u=DCT(犡u).步骤2.根据嵌入位置矩阵1,…,l,从珟犡u中提取l组变换域系数,记为x1,…,xl.步骤3.再次利用密钥K产生l个随机向量狑r1,…,狑rl.步骤4.计算提取向量与随机向量之间的内积,记为ρi,i=1,…,l,即ρi=〈xi,wri〉,这里,符号“〈·〉”表示求两个向量/矩阵的内积.然后,根据得出位序列^犫[23],其中符号函数sgn(·)定义为步骤5.对由式(8)获得的位序列进行水印解码得到水印信息m^.5.2加权整形操作对水印提取的影响式(8)表明DDW使用的是基于相关性的水印提取策略.如果水印嵌入过程中没有感知整形步骤,上述方案的原理无疑是正确的.引入感知整形后,有必要分析该步骤对水印提取的影响.由于DCT是一个正交变换,可得其中,犠ri是与珦犠ri对应的空间域信号,即犠ri=IDCT(珦犠ri).又因为〈珟犡u,珦犠ri〉=〈xi,wri〉,式(8)转化为式(10)表明,水印提取也可以在空间域内进行,这是一个很有用的结论.当水印提取不便在DCT域操作时,例如图像边界信息丢失,可采用式(10)进行水印提取,并可以方便的使用穷搜策略应对平移攻击,但是计算量会增加.假设犡u=犡b以及犡b与犡w近似相等.考虑到水印参考模板信号之间的正交性,并利用式(2)和式(6),可得式(11)表明,在空间域内进行的加权整形操作可以保证提取向量狓i与随机向量狑ri之间具有较高的相关性,从而不会妨碍使用相关检测提取水印信息.5.3像素点翻转个数与水印提取性能的关系DDW水印提取性能依赖于水印嵌入时所给出的可翻转像素点个数Nf.简单的说,Nf越大,提取嵌入信息的可靠性越高.具体地,我们定义位置全集Λc={(i,j)|1iN1,1jN2}及其两个子集Λ1={(i,j)|(i,j)∈Λc,且xo(i,j)=1}和Λ2={(i,j)|(i,j)∈Λc,且wm(i,j)>0}.对于载体图像的一个像素点xo(i,j),如果满足(i,j)∈Λ1∩Λ2或者(i,j)∈珚Λ1∩珚Λ2,xo(i,j)在经过DDW嵌入过程后保持不变,其中珚Λi表示Λi(i=1,2)的补集.由此,我们可以定义一个可能翻转的像素点的位置集合Λp,Λp=Λc-Λ1∩Λ2-珚Λ1∩珚Λ2.将Λp的元素进行排序,使|s(i,j)t(i,j)wm(i,j)|递增,(i,j)∈Λp,其前Nf个位置构成一个翻转像素位置子集,记为Λf.显然,对于坐标(i,j)∈Λf,根据式(2)和(6),水印嵌入将Page7导致像素xo(i,j)被翻转.基于上述定义和犠b的定义,犠b的元素可写作wb(i,j)=1·sgn(wm(i,j)),(i,j)∈Λf这样,对于水印模板犠rk,k=1,…,l,我们有现在,令ρm1=min1il〈犡b,犠ri〉,ρm2=max1il〈犡b,犠ri〉.所以,式(14)给出了内积〈犡b,犠rk〉的取值范围,考虑图6水印嵌入效果(1)水印的不可感知性利用DDW在每个载体图像内嵌入一个长为323位的随机信息,嵌入位置选择在DCT域内以(250,250)为起点大小为190×170的矩形内,每100个DCT系数嵌入1位信息,加水印图像的质量为SNR=18.1dB.图6显示了DDW水印的嵌入效果.从主观上说,虽然信噪比不高,但每个嵌入水印的图像都具有良好的质量,水印嵌入引起的失真是可以接受的.从翻转点分布图更可以看出,被修改的像素点确实都位于字符的边缘,不容易被发现,同时,复杂的字被修改得多,简单的字被修改的少.这到式(10),式(14)在某种程度上刻画了DDW的鲁棒性.由式(13)和(14),集合Λf的势Nf越大,ρm1和ρm2也越大,对水印的鲁棒性也越有利.此外,为了获得良好的水印鲁棒性,可要求ρm1δ,δ是给定的阈值.根据这个限制条件,利用式(13)和ρm1的定义,可以推得对应的Nf的取值范围.6实验结果为了说明本文方案的有效性,我们进行了大量的仿真实验.实验采用了中文、日文和韩文的二值文本图像,尺寸为600×600,如图6所示,从不可感知性和鲁棒性两方面评价水印的性能.所有测试由MatlabR2010a完成.说明水印具有很好的自适应性和不可感知性.这种效果主要归功于HVM的使用.水印的嵌入位置也影响加水印图像的质量.表1显示了在嵌入位置的起始点分别为(100,100)(对应低频)和(340,340)(对应高频)时得出被翻转像素点的可修改度统计结果.由表1可见,在SNR一致时,比较这两种嵌入位置,高频区的水印使被修改的像素点更多的分布在可修改度高的位置(0.25),从而能获得质量更佳的水印图像.因此,使用HVM和选择水印嵌入位置可联合改善水印图像的质量.Page8表1被翻转像素的可修改度统计(犛犖犚=17.8dB,犾=323)可修改度中文0.58197955265332572560.3752346236722592157153316500.251492150320612160285127560.12512760561791570(2)水印的鲁棒性鲁棒性测试以位错误率(BitErrorRatio,BER)和归一化相关系数(NormalizedCorrelation,NC)作为性能评价指标,其中,NC定义为为了公平,所有加水印图像的SNR都设为17.8dB,其他嵌入条件与图6一致.图7画出了在各种攻击下的DDW水印性能曲线,同时,也提供了Wu等人[8]和Qi等人[9]两种方案的实验结果.除非特殊说明,获得的BER和NC是在所有测试图像上的平均值.①对噪声攻击的鲁棒性该测试使用了加性高斯白噪声和椒盐噪声,攻击的强度分别由噪声的标准差σn和噪声的分布概率pn来衡量.图7(a)显示,DDW对高斯噪声具有很强的鲁棒性,当噪声标准差小于0.2时,提取水印信息的BER<0.1,NC>0.8,而且,随着噪声强度的增加,水印性能的变化非常缓慢.图7(b)反映椒盐噪声测试得出了与高斯噪声近似相同的实验结果,只是,椒盐噪声对DDW的攻击相对较弱.在这两种噪声攻击下,本文算法都明显优于Wu与Qi两种方案.②对滤波攻击的鲁棒性接着,水印经过了高斯低通滤波攻击,测试结果如图7(c)所示.很明显,DDW水印对滤波攻击比较敏感,随着滤波器宽度wf的增加,它的性能迅速下降.当滤波器宽度小于1时,DDW提取水印信息的BER<0.3,NC>0.5,优于Wu与Qi两种方案.以上两类测试能反映水印抵抗信息损失的能力.相对于单纯使用空间域信息的其它两种方案,DDW在水印嵌入时结合使用了DCT域和空间域的信息,有效提高了水印的性能.③对旋转和剪切攻击的鲁棒性该测试对每个嵌入水印的图像施行一组带剪切的旋转操作,水印提取前,使用本文提出的方法校正文本倾斜度.图7(d)显示了3种测试方案对旋转攻击的鲁棒性.可见,在整个角度θa的测试范围内,DDW的BER都接近0,NC接近1,表明旋转对DDW水印的影响较小.比较而言,Wu方案对于小角度的旋转攻击鲁棒性最好,但是随着角度的增大,DDW表现了最佳的性能.我们还看到,随着旋转角度的增加,图像周围被剪掉的内容不断增多,Wu和Qi两种方案的性能下降很快,而我们方案的性能则变化不大.因为前两种方案是基于分块的,每一位水印信息只分布在图像的某些局部像素点上,而DDW采用了全局的DCT变换,每一位水印信息被扩展到所有的像素点上,这使得DDW对剪切攻击具有更强的抵抗力.另外,对于单纯的剪切攻击,必须确定被剪切的位置,并用全白或全黑的像素进行补偿,本方案才能正常工作.对于文档图像,剪切的位置容易确定,原因是:(1)原始文档容易被检索到,可以进行对比;(2)可以基于行高或字宽估计剪切面积或者进行有效的搜索.④对尺度缩放攻击的鲁棒性在该测试中,加水印的图像经历了缩放比βa∈[0.5,1.5]的一组尺度缩放操作,水印嵌入和提取在尺度归一化的图像上进行.如图7(e)所示,在这方面,DDW的鲁棒性略强于Wu方案,显著优于Qi方案.所有测试方案对图像放大比缩小的抵抗力强.原因是图像放大引起的信息损失相对少.前面两个测试反映了水印抵抗同步信息损失的能力.本文方案采用了可行的信息同步策略,大大改善了水印对几何攻击的鲁棒性.原始的Wu方案使用的是基于标记的同步策略,安全性差,Qi的方案没有涉及几何攻击问题.在实现同步的情况下,二者的性能都相对较弱.⑤对PS过程和打印-复印-扫描过程(Print-Copy-Scan,PCS)的鲁棒性将加水印的图像经过PS和PCS过程,实验使用了HPLaserJet1020plus激光打印机(分辨率设为600DPI),联想M9215复印机(分辨率设为600DPI)和EPSONPerfectionV30SE扫描仪(分辨率设为300DPI).如表2所示,本文方案能很好的抵抗PS过程,在所有测试图片上都获得了较低的BER和较高的NC,对于PCS过程,它的性能有所降低.其他两种方案在这两方面的性能相对较差.Wu方案中使用了随机置乱过程,水印提取要求严格恢复原始图像的角度和尺寸.Qi方案的性能依赖于字符分割技术,而对经过了PS和PCS过程的图像进行字符分割难以做到与嵌入水印前的图像完全一致.相比之下,我们的方案只需要确定图像的外边界和所有字符尺寸的平均值,受攻击的影响最小,所以获Page9图7在各种攻击下的水印性能曲线(SNR=17.8dB,l=323)Page10得了更高的鲁棒性.表2在PS与PCS攻击下Wu等人[8]、Qi等人[9]与本文评价指标攻击方法PSBER46.430.76.547.141.86.840.336.510.8PSNC0.070.390.870.060.160.860.200.270.78PCSBER40.635.328.244.343.327.643.335.023.2PCSNC0.190.290.440.110.130.450.130.300.54进一步,我们将一个具有实际意义的二值文本图像作为水印信息嵌入到载体图像中,然后,在各种攻击条件下提取水印,并通过观察提取图像的质量来评价水印的鲁棒性.该实验采用了19×17的水印信息图像,如图8所示.该水印图像中含有三组一致的信息,可实现水印信息的重复嵌入,从而在必要的时候能通过重复纠错编码提升水印信息图像的质量.其他嵌入条件与之前的测试相同.图8展示了攻击后的中文图像的局部效果,图9显示了在相应的攻击条件下被测试方案提出的水印图像.图8表明,测试的几种攻击对加水印图像造成了明显的失真.由图9可见,除了PCS操作以外,DDW提取出的水印图像,质量清晰,容易识别,而Wu与Qi两种方案提出的水印图像则不可辨识或者很难辨识.这再一次证明DDW水印拥有更优的鲁棒性.此外,通过纠错编码可进一步提升本文方案的性能,提升水印信息图的质量,尤其对PCS攻击图9经过攻击后提出的水印图像.第1~4行分别由Wu等人[8],Qi等人[9],DDW以及带纠错编码的DDW方案获得,第1~7列对应的攻击分别是高斯噪声、椒盐噪声、滤波、旋转、缩放、PS和PCS,攻击强度见图8而言,从经过纠错解码以后的结果看,只要我们降低嵌入信息的长度,便可以实现DDW水印对PCS过程的鲁棒性,这是很有意义的.图8水印信息图像和攻击效果(局部)(a)水印信息图(19×17);(b)~(h)为攻击后的加水印图像,分别对应高斯噪声(σn=0.08),椒盐噪声(pn=0.14),低通滤波(wf=0.8),图像旋转(σn=30°),图像缩放(βa=0.8),PC和PCS,其中,加水印图像由DDW方案产生(3)与其它方案的比较我们将DDW与文献[10,12,17]进行了比较.它们是本领域中有代表性的研究成果.实验采用了一个400位的随机水印信息,对于DDW,嵌入位置的起始点设为(250,250),并且每100个DCT系数嵌入1位信息.为了公平,所有加水印图像的SNR都被调整为17.8dB.对PS过程引起的几何失真,一律使用了本文提出的校正方案.Page11①与文献[10]比较根据文献[10]提出的方法,将载体图像置乱后分成400个大小相同的图像子块,再将每个块等分为嵌入区和调整区,然后对每个图像子块内嵌入区黑色像素点的个数与整个子块内黑色像素点个数的比值进行调制,嵌入水印信息.表3给出了在几种典型攻击下水印鲁棒性的测试结果.可见,相对于文献[10]的方案,本文方案具有更优的鲁棒性.表3在不同攻击下DDW与文献[10]的犅犈犚(%)攻击操作中文σn=0.04000.30.500高斯噪声σn=0.236.312.543.59.347.09.3pn=0.223.81.829.33.331.57.3椒盐噪声pn=0.438.515.043.513.347.319.8wf=0.60.300.5000低通滤波wf=0.838.333.545.815.549.37.3旋转θa=40°8.00.55.01.05.00.3缩放βa=0.819.82.319.53.819.32.3PS42.37.355.07.042.011.0②与文献[12]比较根据文献[12]提出的方法,对每个载体图像中包含的文字按复杂度由高到低排序,选择前200个文字作为嵌入部分,之后的200个文字作为调整部分,采用4进制线性调制函数操作嵌入部分的每个文字嵌入水印,其参数与文献[12]相同.表4给出了在几种典型攻击下水印鲁棒性的测试结果.显然,相对文献[12]的方案,本文方案具有显著的性能优势.表4在不同攻击下DDW与文献[12]的犅犈犚(%)攻击操作中文σn=0.040.300.50.50.80高斯噪声σn=0.236.012.541.09.341.39.3pn=0.224.31.834.83.336.07.3椒盐噪声pn=0.438.515.041.813.341.019.8wf=0.60.5016.3000低通滤波wf=0.841.333.545.515.543.07.3旋转θa=40°15.80.525.51.024.30.3缩放βa=0.835.32.337.03.837.52.3PS43.57.348.07.039.311.0③与文献[17]比较根据文献[17]提出的方法,将水印信息嵌入到载体图像的第30层小波变换的低频子带内.表5给出了在几种典型攻击下水印鲁棒性的测试结果.很明显,对于所有测试的攻击,本文方案的性能都明显优于文献[17]的方案.表5在不同攻击下DDW与文献[17]的犅犈犚(%)攻击操作σn=0.0424.3026.00.525.00高斯噪声σn=0.271.812.549.59.360.09.3pn=0.269.81.873.03.366.57.3椒盐噪声pn=0.462.515.049.013.359.519.8wf=0.621.3019.8020.00低通滤波wf=0.846.033.559.315.571.37.3旋转θa=40°5.30.56.31.05.30.3缩放βa=1.520.8019.50.320.00PS38.07.337.57.036.011.07结论本文研究了一种鲁棒的二值文本图像水印.首先,给出了一种文本图像的归一化方案.该方案结合使用Hough变换和投影法检测文档倾斜角,利用字符分割技术获得尺度缩放比和页边距.然后,提出了一种称为DDW的水印.DDW在DCT域内选择嵌入位置,生成水印模板信号,但是,在空间域里对其进行感知整形.感知整形函数的设计考虑了翻转像素点个数与位置.水印提取使用了相关检测器,在变换域和空间域内都能操作.而且,我们分析了感知整形过程对水印提取的影响,量化了翻转像素点个数与水印提取性能的关系.DDW实现了在水印嵌入过程中使用两个域的特征提高水印的性能,同时避免了传统变换域水印必须对原始图像进行变换和逆变换的操作.实验表明,DDW具有良好的水印不可感知性,不仅能有效抵抗普通的图像处理操作,而且能抵抗几何攻击与PS过程,与几种典型的方案相比,具有显著的鲁棒性优势.
