Page1抗主密钥泄露和连续泄露的双态仿射函数加密张明武1),2),3)杨波2)TAKAGITsuyoshi3)1)(华南农业大学信息学院广州510642)2)(陕西师范大学计算机学院西安710072)3)(九州大学工业数学研究所福冈819-0395日本)摘要抗密钥泄露安全的加密系统保证在攻击者获得(主)密钥部分信息的情况下仍具有语义安全性.文中设计了一个抗密钥泄露的双态仿射函数加密方案,该方案中加密策略和解密角色定义为仿射空间,并且具有再次委托能力.在双系统加密模型下,实现了自适应安全的抗有界的主密钥泄露和用户密钥连续泄露的加密方案,在标准模型下基于静态子群判定假设证明了该方案的安全性.同时,分析了方案中的主密钥和用户密钥的泄露界和泄露率,通过参数调整可以达到接近73%的泄露率,具有较好的抗泄露性质.关键词函数加密;仿射空间;抗泄露;双系统加密;可证安全1引言现代密码学都假定用户密钥对可能的攻击来说是完全隐藏的,但在实际中通过边信道攻击,例如时间攻击、电源耗损、冷启动攻击以及频谱分析等,都能从保密密钥或加密系统内部获得有关密钥的部分信息.Akavia等人[1]引入密钥泄露概念,攻击者即使从密钥中获得部分信息,而加密方案仍然是语义安全的,则称该加密方案是抗泄露(leakage-resilient)攻击安全的.为了模拟泄露,设定攻击者能够访问泄露谕言机(leakageoracle),从而获得关于密钥的任何函数的输出,即f:f(SK)→{0,1}[2-5].除了具有以往的语义安全所具有的能力外,攻击者还能够自适应地对泄露谕言机进行询问,唯一的限制是攻击者所获得泄露的输出长度总和不能超过预先设定的边界值,该模型也称有界泄露模型(BoundedLeak-ageModel,BLM).Alwen等人[2]首次构建基于边界检索模型(Bounded-RetrievalModel,BRM)的抗密钥泄露的公钥加密方案,它是一种有界泄露模型的方案.Chow等人[6]在基于Hash证明系统[7]的基础上,构建了几种抗泄露的基于身份的加密方案,但不支持主密钥泄露安全,同时把具有委托能力的抗泄露方案作为未解决的公开问题.文献[6-7]的方案只支持每个身份的单次密钥泄露,Brakershi等人[8]提出支持密钥连续泄露的加密方案,但不支持主密钥泄露.Lewko等人[5]提出采用双系统加密技术(DualSystemEncryption,DSE)可以构造抗密钥泄露的方案,同时构建了支持有界泄露的IBE、HIBE和ABE方案.空间加密(SpatialEncryption,SE)[9-11]采用仿射空间作为解密角色,而仿射空间中的点向量作为加密策略.根据仿射空间的包含性可实现密钥的再次委托能力.在标准的SE方案的基础上,Vie和Abdalla采用DSE技术设计抗密钥泄露的空间加密方案,该方案中可泄露界与空间的维度相关联[12].在SE方案中,由于加密策略定义为κ维的点向量,因此无法实现策略的再次委托能力.双态仿射函数加密是一般空间加密的一般性扩展.在双态仿射函数加密方案中,加密策略和解密角色都定义为仿射子空间.角色委托实现解密能力的再次委托,可以实现类似基于代理的密码系统,而加密策略定义于可委托的仿射空间,扩展的加密策略委托能力可以支持重加密的能力.因此,双态仿射空间加密具有广泛的模型,它扩展了PKE[13]、HIBE[14-15]、ABE[16]、HVE[17]、FE[18-19]等方案.本文设计了一个抗密钥泄露安全的双态仿射函数加密方案,在双系统加密模型下,实现自适应安全抗用户密钥多次泄露和主密钥泄露.本方案中,加密策略和解密角色都定义为代数仿射向量子空间,并且可以有再次委托的能力.当解密角色空间与加密策略空间存在一不动点(交集不为空)时,可实现函数的匹配并解密.本方案中通过引入抗泄露组件,提高密钥的抗泄露能力.同时通过密钥生成和委托算法的特殊功能,实现主密钥和用户密钥的更新功能,从而提高系统的抗连续泄露性.本文方案是抗泄露的IBE、HIBE、SE和FE的一般性扩展:特别地,当加密策略和解密角色缩小为仿射空间中两个点向量时,本方案简化为抗泄露IBE方案;当仿射空间定义为树形结构空间而解密角色定义为一个点向量时,本方案为抗泄露HIBE方案;当解密角色变成一个点时,本方案为抗泄露SE方案.1.1基本思路方案采用多维双系统加密技术实现,可以容忍主密钥的泄露和用户密钥的连续泄露,同时达到自适应安全.为实现抗主密钥泄露和连续用户密钥泄露,把一维半功能空间扩展为n维.在双系统加密DSE技术中,密文和密钥都可以定义两种形态:正常(Normal)和半功能(Semi-Functional,SF).正常形态密钥可以解密任何一种形式的密文,但SF的密钥只能解密正常形态密文,不能解密SF密文.目前实现DSE的方法主要有3种:基于标签tag的构建[15]、基于正交双线性子群的构建[14,16]和基于双对向量空间(DualPairingVectorSpaces,DPVS)[18].本文采用正交双线性群来设计抗泄露能力.构建方案的密文和密钥都定义为正常形式,在证明过程中采用混合证明方法,首先密文改变成SF形态的,密钥由正常形式逐步改变成SF形态,我们要证明敌手不能感知到这些改变,主要基于合数阶群的子群判定假设.最后模拟器生成SF形式的密钥和密文,并作为挑战密文提供给敌手,若敌手能正确解密密文,则可利用它来解决SF密钥对SF密文的判定性问题.设计的困难问题是,在密钥由正常形态改变成SF形态的过程中,模拟器要为任何仿射向量空间准备密钥并生成相应的SF密文.本文采用有支配能力的SF功能密钥来实现:从敌手来看,这些密钥与一般SF密钥是同分布的,但从模拟器来看,若解密Page3设狌=(u1,…,un),狏=(v1,…,vn)∈Zn一SF密文,用支配密钥可以解密成功,因此在敌手询问过程中不会暴露密钥是正常还是SF形态的信息.本文扩展SF空间到n维(n2).由于一个密钥的泄露量是有界的,当敌手所获得的泄露量不超过这个量时不能区分正交向量与随机向量.n越大,抗泄露的容忍性越好.1.2本文组织本文第2节介绍所用的一些基础知识;第3节给出抗泄露的双态仿射函数加密框架和安全性模型;第4节给出详细的构造方案;方案的正确性、一致性和安全性的分析和证明在第5节给出;第6节讨论本方案的泄露界;第7节对本文作出小结.2预备知识2.1基本概念向量,〈狌,狏〉是向量的内积.设g是群G的生成元,记g狏为向量g狏··=(gv1,…,gvn)∈Gn.类似,gr狏··=(grv1,…,grvn),g〈狌,狏〉··=g狌狏=g∑iGt,e^)为双线性群描述,满足对任意a,b∈ZN,存在有效可计算的双线性映射e^:e^(ga,gb)=e^(g,g)ab.e^n(g狌,g狏)··=∏n长度为n+d的一组Gr元素的随机向量,(gu1g^1,gu2g^2,…,gung^n,gv1g^n+1,…,gvdg^n+d)简记为(g狌,g狏)犵^[n+d].记r←S为从集合S中随机选取一元素r.negl(λ)是对λ可忽略的函数,即对任意z>0,一函数f(λ):N→R满足f(λ)λ-z.定义1.计算不可区分性.对任一PPT算法A,两个概率总体{X1},{Y2}满足|Pr[A(1λ,X1)=1]-Pr[A(1λ,X2)=1]|negl(λ),则称X1和X2对算法是计算不可区分的.引理1[20].设q是一素数,m,l,d∈ZN满足ml2d,犡1,犡2分别是Zq上选取的m×l和m×d的随机矩阵.T←Rankd(犣l×df:犣m×dq→Ω是矩阵犣m×dDist((犡1,f(犡1T)),(犡1,f(犡2)))negl(·),这里Dist(犡1,犡2)表示两个随机变量犡1和犡2的统计距离.推论1.设m是大于2的整数,q是一大素数.设δ,τ←Zm量空间的正交空间),对任一函数f:ZmDist((δ,f(τ)),(δ,f(τ)))negl(·),应用引理1,置d=1,l=m-1,则犡1对应于向量的正交空间V⊥(δ-)的基,犡2对应于τ-.本文采用正交子群Gq作为这里的正交空间.我们在后面分析和讨论本文方案的泄露界MSK=SK=2+(n-1-2c)log(q),此时negl(·)=q-c是可以忽略的.定义2.仿射空间.设d∈ZN,狓∈ZκZd×κN,我们定义一仿射空间S=Aff(犕,狓)Zκ称d(dκ)为仿射空间S的维度,记为d2Dim(S)=d.T∈Zd1×d2引理2.若两仿射空间S1=Aff(犕1,狓1)维δ度为d1,S2=Aff(犕2,狓2)维度为d2,满足S2S1,则存在一有效可求解的矩阵和向量狕∈Zd1狓1+犕1狕.引理3.若两仿射空间S1=Aff(犕1,狓1)维度为d1,S2=Aff(犕2,狓2)维度为d2,满足S1∩S2≠,则存在一有效可求解的矩阵犜1,犜2和向量狕1,狕2,满足犕1犜1=犕2犜2,狓1-狓2=犕2狕2-犕1狕1.证明.设S1∩S2=S,SS1,SS2,根据引理2,犕=犕1犜1,狓=狓1+犕1狕1,犕=犕2犜2,狓=狓2+犕2狕2,得证.2.2合数阶双线性群一个合数阶的双线性群描述包括(N,G,Gt,e^),阶N是多个不等的素数之积.设N=pqr,这里p、q、r是不相等的素数.除满足双线性群的一般性质外,群G包含阶分别是p、q和r的子群Gp、Gq和Gr,设其子群生成元分别是g、g-和g^,则G中的任一元素都可以表示成ga1g-a2g^a3的形式,这里a1,a2,a3∈ZN.合数阶双线性群具有如下特殊性质.性质1(子群生成元).设h是G的生成元,则hqr是Gp的生成元,hpr是Gq的生成元,hpq是GrM2=M1T的生成元.性质2(子群正交性).设hp∈Gp,hq∈Gq,hr∈Gr,对所有a1,a2,a3∈ZN,e^(ha1p,ha2q)=1,e^(ha1p,ha3r)=1,e^(ha2q,ha3r)=1.2.3数学困难假设为证明所设计方案的安全性,本文使用如下基于合数阶群的(子)群判定问题,该假设在文献[14,16,18]中已作分析.Page4假设1.设(N,G=Gp×Gq×Gr,Gt,e^)是阶N=pqr的双线性群,σ,τ←ZN,g∈Gp,g-∈Gq,g^∈Gr.给定元组Θ=(N,G,Gt,e^;g,g^,T1=gσ∈Gp,T2=gσg-τ∈Gpq),区分T1和T2是个困难问题.假设2.设(N,G,Gt,e^)是阶N=pqr的双线性群,σ,,τ←ZN,g∈Gp,g-∈Gq,g^∈Gr.给定元组Θ=(N,G,Gt,e^;g,g^,X1∈Gpq,X2∈Gqr,T1=gσg^∈Gpr,T2=gσg-τg^∈G),区分T1和T2是个困难问题.假设3.设(N,G,Gt,e^)是阶N=pqr的双线性群,α,s,t,t←ZN,g∈Gp,g-∈Gq,g^∈Gr.给定元组Θ=(N,G,Gt,e^;g,g-,g^,X1∈gαg-t,X2∈gsg-t,T1=e^(gα,gs),T2←Gt),区分T1和T2是个困难问题.3方案模型3.1双态仿射加密模型一个双态仿射函数加密(DASE)由5个PPT算法组成:∏=(Init,KeyGen,Dele,Encr,Decr).Init和KeyGen算法由可信第三方PKG执行,Init算法生成系统公钥和主密钥,KeyGen算法为用户持有的仿射空间生成密钥,同时也可以更新主密钥;Dele算法由一仿射空间钥的持有者为其子空间生成委托密钥,同时也可以更新自己的密钥;Encr和Decr分别由加密者和解密者执行消息的加密和解密操作.为标记用户密钥和主密钥的泄露和更新,我们定义两个特殊的空间:空仿射空间和超仿射空间Λ.(1)Init(1λ,MSK,SK,κ,n).输入系统安全参数1λ、主密钥泄露界MSK、用户密钥泄露界SK、抗泄露容忍度n和仿射空间的维度κ,初始化算法生成系统公钥和主密钥.(2)KeyGen(MPK,MSK,S).密钥生成算法输入系统公钥和主密钥,以及一仿射空间S,若S=Λ则更新主密钥,否则输出S的密钥SKS.(3)Dele(MPK,S1,SK1,S2).密钥委托算法输入系统公钥、仿射空间S1及其密钥SKS1,以及S1的仿射子空间S2,若S2=则更新S1的密钥,否则输出S2的密钥SKS2.(4)Encr(MPK,S,m).加密算法输入系统公钥、接收者仿射空间S以及消息m,输出加密的密文CTS.(5)Decr(MPK,S,SKS,S,CTS).解密算法输入系统公钥、加密策略空间S及密文CTS、解密角色空间S及密钥SKS,输出消息m.正确性与一致性.Q、M和C分别是仿射向量空间、明文空间和密文空间.对所有正确生成的(MPK,MSK)、S仿射空间密钥SKS、S接收者角色的消息m密文CTS∈C.f(·)和f(·)是任意的用户密钥和主密钥的泄露函数,满足∑iSK,∑i密CTS得到m=m.即(MPK,MSK)←Init(1λ,MSK,SK,κ,n)熿S1,S2,S∈Q,S2∩S≠,m∈M∑iCTS←Encr(MPK,S,m)m←Decr(MPK,S2,Dele(MPK,S1,KeyGen(MPK,MSK,S1),S2),S,CTS)m=燀Pr挑战者生成并存储Sj的密钥SKSj.(2)泄露询问(OLeak).敌手提供一仿射空间Sj及概率多项式函数fi:SK→{0,1},挑战者用fi(SKSj)作回答(泄露总长度∑i请求一个主密钥泄露的多项式时间函数fi(MSK)询问.(3)密钥询问(ORevl).敌手提供子空间Sj,挑战者以完整的密钥SKSj作为回答.(4)委托钥询问(ODele).敌手提供两空间S1,S2,挑战者首先查询OCrea的队列是否有SKS1,如果不存在则调用OCrea为SKS1生成密钥,然后调用Dele算法生成并回答委托钥SKS2,同时把SKS2存储于OCrea密钥队列中.(5)解密询问(ODecr).输入一密文CT和一仿射空间S,挑战者生成仿射空间密钥SKS,输出消息m.3.挑战.敌手随机选择两消息m0,m1∈M以及挑战子空间S,要求S不在密钥询问ORevl的队列中,也不是已询问过的空间的仿射子空间,且在泄露询问OLeak获得的比特量小于SK.接下来挑战者随机选择β∈{0,1},计算CTS←Encr(MPK,S,mβ),将密文CTS发送给敌手A.negl(λ).3.2安全性模型如下的游戏框架ExpLR抗泄露安全的双态仿射加密的安全模型定义为1.系统参数.挑战者C运行Init算法生成系统参数MPK和主密钥MSK,并把MPK发送给敌手A.2.询问1.本阶段A自适应地向挑战者进行下列询问:(1)创建密钥询问(OCrea).敌手提供一系列子空间Sj,Page54.询问2.类似询问1,但要满足:不能对主密钥MSK或挑战S的密钥作OCrea和OLeak询问5.输出.敌手输出β,若β=β,敌手赢得该游戏.对双态仿射加密方案DASE的安全游戏中,OCrea、OLeak、ORevl、ODele和ODecr分别是创建密钥谕言机、泄露谕言机、密钥询问谕言机、委托谕言机和解密谕言机,泄露函数f:SK→{0,1},敌手在ExpLR∏,A(λ)中的优势定义为定义3.抗泄露语义安全性.对任一个多项式时间内的敌手A在ExpLR间多次用户密钥泄露最多获得SKbit的密钥信息(∑jSK),最多获得MSK的主密钥信息,敌手所获得的优势AdvLR态仿射函数加密是(MSK,SK)-LR-CCA安全的.若在ExpLRODecr,则称该方案是(MSK,SK)-LR-CPA安全的.本文重点考虑方案的密钥抗泄露性,对消息的保密性方面所设计的方案达到CPA安全.可以利用转换工具使CPA安全的方案达到CCA安全.一般的抗泄露安全只针对用户密钥泄露,本方案在此基础上实现抗主密钥泄露和连续泄露.定义4.抗主密钥泄露.当系统主密钥在泄露量不超过MSK时,系统仍是安全的,称该方案抗主密钥泄露安全的.MSK称为主密钥泄露界.定义5.抗连续泄露.若一个密码方案具有自身密钥更新的能力,产生一个相同分布的重新随机化的密钥,称该方案是抗连续泄露的.实际中,攻击者可以对同一用户的密钥进行多次的密钥泄露询问,因此通过多次的泄露询问获得超出泄露界的密钥信息量.但若密钥可以被更新,则攻击者以前的泄露询问不起作用,需要重新开始对新的密钥进行泄露询问.特别地,每当密钥被使用(或一定周期)就进行一次密钥更新,这样攻击者无法多次获得同一仿射空间的相同密钥上的泄露信息,此加密方案是完全抗连续泄露的.4方案构造本方案中,一个仿射空间S··=Aff(犕,狓)的密钥形式为SKS=(ku,ka,kr,kw)=(g狌,gα+r(a+〈狓,狑〉)-〈狌,狏〉,gr,gr犕狑)g^[n+d+2],其中ku∈Gn,ka,kr∈G,kw∈Gd,g^[n+d+2]∈Gn+d+2r.这里d=Dim(S)是仿射空间的维度,κ是最大仿射空间的维度.系统中n是大于等于2的整数,它控制密钥泄露的容忍度.n越大,系统的抗泄露容忍性越好,n越小,系统的密文和密钥越短.系统初始化参数中,预先设置主密钥的泄露界MSK和用户密钥的泄露界SK,并且要求用户在自定义泄露函数f(·)的获得密钥的总输出长度不能超过这个界.(1)Init(1λ,MSK,SK,κ,n).PKG首先调用双线性群生成器生成(N=pqr,G=Gp×Gq×Gr,Gt,e^),然后随机选取α∈ZN,狌,狏∈Znga∈Gp,g-∈Gq,g^∈Gr.设置并公开系统公钥MPK=(N,G,Gt,e;MSK,SK,g,g^,ga,g狏,g狑,e(g,g)α),同时保存主密钥MSK=(珔ku,珔ka,珔kr,珔kw)=(g狌,gα+ra-〈狌,狏〉,gr,gr狑)犵^[n+κ+2].这里犵^[n+κ+2]是Gr上的一组随机n+κ+2维向量,可以先随机选择η∈Zn算g^η得到.(2)KeyGen(MPK,MSK,S).第1步,PKG为仿射空间S··=Aff(犕,狓)生成导入密钥SKS:设d=Dim(S),SKS=(^犽u,^ka,^kr,^犽w)=(珔犽u,珔ka·∏d=(g狌,gα+r(a+〈狓,狑〉)-〈狌,狏〉,gr,gr犕狑)g^[n+d+2]这里,设仿射矩阵犕=(犡1,…,犡d)∈Zd×κψ(g犕,珔kw)··=(g〈犡1,r狑〉,…,g〈犡d,r狑〉).第2步,对SKS进行随机化处理:随机选择r∈ZN,狌∈ZnSKS=SKS〈g狌,gr(a+〈狓,狑〉)·g〈-狌,狏〉,gr,gr犕狑〉g^η=〈g狌+狌,gα+(r+r)(a+〈狓,狑〉)-〈狌+狌,狏〉,gr+r,g(r+r)犕狑〉g^η+[n+d+2]由于r,r,狌,狌是ZN上随机选取的,因此随机化前后的密钥是同分布的.值得注意的是,当为一个特殊的κ维的仿射空间Λ:SΛ=Aff(犈,0)生成密钥时(犈是单位阵,0是零向量),本质上是在更新主密钥MSK.此时,〈0,狑〉=0,gr犈狑=gr狑,即经过密钥导入和随机化之后,密钥结构没有变化,只是用新随机数代替原来的r和狌.Page6(3)Dele(MPK,S1,SK1,S2).S2=Aff(犕2,狓2)是S1=Aff(犕1,狓1)的仿射子空间,即S2S1,设d1=Dim(S1),d2=Dim(S2),根据引理2,存在一有效的计算求出T和狕满足犕2=犕1T,狓2=狓1+犕1狕.①若S2=S1,则系统更新委托者自身密钥SKS1:采用KeyGen中的更新算法(5),可以获得与原有密钥同分布的新密钥.②若S2S1,S1为S2生成委托密钥(设S1的密钥是SKS1=(犽u,犽a,犽r,犽w)):首先生成导入密钥SKS2=(^犽u,^ka,^kr,^犽w)=(犽u,kagr犕1狕狑,kr,ψ(g犕1,珔kw))=(g狌,gα+r(a+〈狓2,狑〉)-〈狌,狏〉,gr,gr犕2狑〉g^[n+d2+2].第2步,对SKS2再随机化,获得与SKS2同分布的密钥SKS2:随机选择r∈ZN,狌∈ZnGn+d2+2r,计算SKS2=SKS2〈g狌,gr(a+〈狓2,狑〉)·g〈-狌,狏〉,gr,gr犕2狑〉g^η=〈g狌+狌,gα+(r+r)(a+〈狓2,狑〉)-〈狌+狌,狏〉,gr+r,g(r+r)犕2狑〉g^η+[n+d2+2](4)Encr(MPK,S,m)给定一消息m∈Gt和一接收者仿射空间角色S=Aff(犕,狓),本算法随机选取s∈ZN,生成密文CTS.CTS=(cm,犮v,cs,ca,犮w)这里d=Dim(S∩S).输出消息m.=(m·e^(g,g)sα,gs狏,gs,g-s(a+〈狓,狑〉),gs犕狑)特别地,当接收角色空间S缩小为仿射空间的一个点向量狓时,犕=,犮狑=1G.此时加密方案简化为一般的空间加密方案[9-10].(5)Decr(MPK,S,SKS,S,CTS).若解密者的角色空间S=Aff(犕,狓)与加密策略空间S=Aff(犕,狓)的交不为空(S∩S≠),则存在一仿射空间点向量狓∈S∩S.根据线性代数性质及引理3,可以有效地找出向量狕,狕′满足:狓=狓+犕狕=狓+(犕)狕′.ca,犮w),计算解析SKS=(犽u,ka,kr,犽w),CTS=(cm,犮v,cs,kδ=ka·∏d5方案正性与安全性5.1正确性5.1.1解密一致性密文CTS中,cm∈Gt,犮v,ca,cs,犮w∈Gp,而密钥SKS∈Gpr,根据子群的正交性、密钥与密文的双线性运算(cm除外),密钥的Gr子群元素g^[n+d+2]将被约除.因此解密一致性只需考虑子群Gp中元素的计算.根据引理3,狓=狓+犕狕=狓+(犕)狕′.kδ=ka·∏d同理,cδ=g-s(a+〈狓,狑〉),e^(犽u,犮v)=e^(g狌,gs狏)=e^(g,g)s〈狌,狏〉e^(kδ,cr)=e^(gα+r(a+〈狓,狑〉)-〈狌,狏〉,gs)=e^(g,g)sαe^(g,g)rs(a+〈狓,狑〉)e^(g,g)-s〈狌,狏〉e^(ks,cδ)=e^(gr,g-s(a+〈狓,狑〉))=e^(g,g)-rs(a+〈狓,狑〉)e^(犽u,犮v)e^(kδ,cr)e^(ks,cδ)=e^(g,g)sα使用上述盲化因子e^(g,g)sα可以从cm中正确提取消息m.5.1.2密钥生成正确性在KeyGen中,PKG利用主密钥MSK对任一仿射空间S=Aff(犕,狓)生成密钥SKS=(犽u,ka,kr,犽w)∈Gn+d+2们主要验证ka和犽w的正确性.^ka=珔ka·∏d^犽w=ψ(gM,珔kw)=(g〈犡1,r狑〉,…,g〈犡d,r狑〉)g^[d]=gr犕狑g^[d]∈Gd在随机化过程中,密钥的结构和长度没有发生变化,只是用新的随机数狌+狌和r+r代替原密钥中的狌和r,因此不影响密钥的一致性.5.1.3委托钥正确性S2是S1的仿射子空间,根据引理2,存在一有效可求解的矩阵犕和向量狕,满足狓2=狓1+犕狕,故犕狕=-狓1+狓2.对生成的S2的委托密钥中,^犽w的求解过程与式(6)相同.Page7^ka=r犕1狕狑=gα+r(a+〈狓1,狑〉)-〈狌,狏〉gr〈-狓1+狓2,狑〉通过周期性更新主密钥,可以抗主密钥的连续5.2密钥更新5.2.1主密钥更新PKG可以通过对特殊仿射空间SΛ=(犈,0)的密钥提取来更新主密钥MSK:Dim(SΛ)=κ,犈是单位阵,0是零向量.主密钥更新是对密钥中的随机数进行再随机化处理,由于主密钥中每个组件都与随机数关联,因此进行主密钥更新可以容忍系统的泄露,我们很容易得到下面的定理.定理1.在DASE方案中,主密钥更新不影响系统以前和以后产生的密钥,但可以提高系统的抗主密钥泄露安全性.泄露.5.2.2用户密钥更新在Dele算法中,任何密钥持有者除了可以为仿射子空间生成子密钥外,还可以更新自身密钥.在密钥结构和长度不变的情况下,通过再随机化随机数的功能实现密钥更新.定理2.在DASE方案中,密钥更新不影响该密钥生成的子密钥,但可以提高系统的抗主密钥泄露安全性.面讨论.5.3委托路径独立性本方案具有委托路径独立性:一个委托的密钥与路径无关.设有3个仿射空间S1,S2,S3满足S3S2S1,则为S3生成的两个密钥Dele(MPK,S1,SKS1,S3)与Dele(MPK,S2,Dele(MPK,S1,SKS1,S2),S3)是计算不可区分的.5.4安全性与一般加密方案的证明不同之处在于,一般的语义安全性只需要回答敌手的密钥询问,而本方案允许敌手进行额外的主密钥MSK和仿射空间角色密钥SKS的泄露询问.特别地,敌手可以对挑战的仿射子空间作有界长度的密钥泄露询问.可泄露的界MSK,SK是安全参数的多项式表达式,即MSK=MSK(λ),SK=SK(λ).首先,挑战者C运行Init算法生成系统参数和主密钥,并把系统公钥发送给敌手A.同时,C提供给敌手一个记录主密钥MSK及关联的用户密钥SK及泄露量的句柄H··=(Handle,Space,(MSK∪SK),Leaked-bit)),以利敌手进行询问并保持相应关于密钥可泄露的大小与安全强度,我们在后的状态.在询问阶段,由于OKeyGen,ODele都可以由OCrea生成,在询问阶段敌手可以自适应地进行三种询问:OCrea,OLeak和ORevl.在OCrea中,敌手提供一个主密钥的句柄给挑战者,并请求挑战者生成一个密钥,并存储在相应队列中.每次询问后,挑战者要返回一个与相应句柄相应的用户密钥给A,使得A在后面的OLeak和ORevl询问中能够对应它所使用的句柄.在OLeak询问中,A使用句柄可以有选择性地进行泄露询问,所有的泄露函数fi和泄露量由敌手自适应地选择(只要泄露总量不超过MSK和SK).在此询问过程中,挑战者记录敌手每次所泄露过的密钥及泄露量.当敌手请求一个OCrea询问时,挑战者创建一条上述记录并置初值为0.ORevl询问允许敌手获得某一仿射空间的S生成的密钥SKS.为了保持一致性,敌手只需提供一个S的句柄.显然,敌手不能获得主密钥的询问,也不能对挑战的仿射空间作密钥提取询问.为此,挑战者用集合R记录已询问过的仿射空间.方案中KeyGen或Dele产生的密钥和Encr生成的密文都是正常形式的,为了帮助证明,我们设计半功能化的密钥形式.基本方法是对原来密钥和密文组件乘以Gq中的随机元素(Gq在实际方案中没有涉及,仅用于安全性证明中设计半功能化密文或密钥).随机选取g-θ1,g-γ1∈Gn+2功能密钥:槇SKS··=((犽u,ka,kr)g-θ1,犽wg-θ2)∈Gn+d+2半功能密文:槇CTS··=(cm,(犮v,cs,ca)g-γ1,犮wg-γ2)∈Gt×Gn+d+2显然一个半功能密钥要成功解密一个半功能密文,除了加密策略S与解密角色S满足S∩S≠,根据式(8)还要满足〈θ1,γ1〉+〈犕狕θ2,犕狕γ2〉=0modq.为了证明方案的安全性,我们使用一系列不可区分的游戏,最初游戏Leak中密钥和密文均是正常形式,而最后的LeakCK中密钥和密文均是半功能化的,LeakCKM中的消息组件cm是随机化的.定义如下:(1)Leak.本游戏中密文和密钥均为正常形式,即密文和密钥由DASE中算法生成,敌手执行∏,A(λ)定义的游戏模型.ExpLR(2)LeakD.与Leak的区别在于,对敌手的Dele和KeyGen询问,用OCrea代替.由于这两个谕言Page8机所生成的密钥是不可区分的,因此LeakD与Leak是不可区分的.(3)LeakC.本游戏与LeakD的区别在于,在挑战阶段,挑战者用半功能密文槇CTS作为挑战的输出.(4)LeakCKj.与LeakC相同的是,本游戏中密文仍是半功能化的.同时,本游戏产生半功能化的密钥存储于H中,OCrea生成正常的密钥而OLeak和ORevl生成半功能化的密钥.与密钥询问一样,本游戏也生成半功能的主密钥.显然,j=0时,LeakCK0=LeakC;j=qe(qe是询问的最大次数)时,LeakCK中生成的密文和密钥都是半功能化的.当1jqe时,所生成的密钥中前j-1个是半功能化的,后面的都是正常密钥.我们证明对所有j,LeakCKj与LeakCKj+1是不可区分的.同时,我们证明敌手在Leakj+1中不能构造可解密挑战密文的支配型密钥.(5)LeakCKM.与LeakCK不同的是,本游戏中密文中的cm改变成Gt中的随机元素.通过LeakCK与LeakCKM的不可区分性,我们可以证明cm对消息是保密的.定理3.在一个抗泄露的双态仿射函数加密方案中,若Leak,LeakD,LeakC,LeakCK,LeakCKM之间是计算性不可区分的,则该方案是抗泄露安全的.证明.我们采用一系列不可区分的证明引理4~8来证明本抗泄露方案的安全性.Leak是本文提出方案的正常密钥和密文,而LeakCK表明敌手无法区分的半功能化密文和密钥,LeakCKM是对消息隐藏组件与随机元素不可区分.引理7在引理1的分布不可区分性的基础上证明在泄露界中,敌手无法构造一个支配型的密钥去解密挑战密文.因此从敌手来看,这些游戏不可区分,而LeakCK和LeakCKM是完全随机化的密文组件,敌手无法从这些组件中获得密文的有用信息.因此,本方案是(MSK,SK)-LR-CPA安全的.引理4.任何多项式时间内的敌手A无法区分Leak和LeakD.证明.OCrea执行OKeyGen的输出.通过KeyGen和Dele的算法可知,两者的输出是同一分布的,同时ODele的委托密钥也应当在OCrea生成的密钥队列中,因此OKeyGen和ODele都可以由OCrea生成,敌手无法区别一个密钥是哪个谕言机生成.引理5.若安全假设1存在,则任何多项式时间内的敌手A无法区分LeakC和LeakD.证明.假设一多项式时间的敌手A可以以不可忽略的优势区分LeakD和LeakC,则我们可以构建一算法D作为模拟器以相同的优势解决安全假设1.当D收到假设1的实例(N,G,Gt,e^;g,g^),D的目标是猜测一元素T∈Gp还是T∈Gpq.为此,D扮演模拟器并回答敌手A的询问及挑战如下(1)初始化.D随机选择α,a,狌,狏,狑∈Z2n+κ+2,置系统公钥MPK=(N,g,g^,ga,g狏,g狑)并发送给A.(2)询问1.由于D知道系统主密钥α和狏,因此可以为任何仿射空间生成密钥,并且可以回答敌手A的OCrea、OLeak、ORevl、OKeyGen及ODele等询问.(3)挑战.当A提交给D两个挑战的消息Gm0,m1及挑战子空间S=Aff(犕,狓),模拟器D随机选择β∈{0,1},输出密文CTS=(cm,犮v,cs,ca,犮w)=(mβe^(T,gα),T狏,T,T-(a+〈狓,狑〉),T(犕)狑).(4)询问2.与询问1相同,同时要求A不能对S及其超空间作ORevl询问.(5)输出.A输出对密文中消息mβ的猜测β.D以相同的输出β作为对假设1的猜测:β=0则T∈Gp,β=1则T∈Gpq.若T∈Gp,则密文CTS是正常形态的(没有Gq元素),此时B可以正确模拟Leak.若T=gσg-τ∈Gpq,则密文是半功能化的,此时cm=mβe^(T,gα)=me^(g,g)α,θ=τ(狏,1,-a+〈-狓,狑〉,(犕)狑).事实上,虽然a,狌,狏,狑是从ZN中选取.但在公开参数MPK中时都是作为g∈Gp的指数,因此这些值模q是不为0的(p,q,r是互素的阶).对敌手来说密文组件中Gq部分不为1Gq.因此可以正确模拟LeakC.引理6.若安全假设2存在,则任何多项式时间内的敌手A无法区分LeakCKj和LeakCKj+1.证明.若一多项式时间的敌手A以不可忽略的优势区分LeakCKj和LeakCKj+1,我们可以构建一算法D以相同的优势解决安全假设2.D的目标是判断假设2的实例(g,g^,犡1,犡2,T)中T为Gpq还是G中的元素.我们证明当T∈Gpq时,D能成功模拟LeakCKj,当T∈G时,D能成功模拟Leakj+1.(1)初始化.D随机选择α,a,狏,狑∈Zn+κ+2置系统公钥MPK=(g,g^,ga,g狑,g狑,e^(g,g)α).(2)询问1.本阶段对密钥回答分为3种情况①对前面的j-1个密钥,D设置成半功能密钥,即SKS=(g狌,gα+r(a+〈狓,狑〉)-〈狌,狏〉,gr,gr犕狑)Page9g^[n+d+2]X[n+d+2]②对第j个密钥,D将生成挑战项的密钥,SKS=(T狌,gαTa+〈狓,狑〉-〈狌,狏〉,T,T犕狑)g^[n+d+2].显然,当T∈Gpr时,SKS是正常形态的.当T=gσg-τg^∈G(注:G=Gpqr)时,半功能密钥因子θ=τ(狌,a+〈狓,狑〉-〈狌,狏〉,1,犕狑).θ作为g∈Gp的指数(计算时modp)而p与q互素,因此θ≠0,从敌手来看SKS是半功能的.③从j+1密钥开始,D输出正常形式的密钥,即SKS=(g狌,gα+r(a+〈狓,狑〉)-〈狌,狏〉,gr,gr犕狑)g^[n+d+2]∈Gn+d+2pr.槇CTS=(mβe^(X1,gα),X狏1,X1,X-a-〈狓,狑〉因子γ=k2(狏,1,-a-〈狓,狑〉,(犕)狑).(4)设X1=gk1g-k2∈Gpq,挑战密文中半功能化设槇SKS=((犽u,ka,kr)g-θ1,犽wg-θ2),在半功能化密钥生成或委托时,根据式(8),若S使用半功能密钥槇SKS去生成一子空间密钥狓2=狓1+犕狕,则半功能化参数θ=θ1+(0,…,0,〈狕,θ2〉).同样,半功能化密钥参数γ=γ1+(0,…,0,〈狕,γ2〉).〈θ,γ〉=τk2(〈狌,狏〉-a-〈狓,狑〉-〈(犕)狕,狑〉+(3)挑战.D生成一个半功能化的密文:=τk2(〈狓-狓,狑〉+〈(犕)狕-犕狕,狑〉)modq.若敌手解密CTS,则〈θ,γ〉=0modq.若敌手可以区分Leakj和Leakj+1,我们可以不可忽略的优势找出N的因式q,并成功解决安全假设2.引理7.设泄露界SK=(n-1-2c)logq,c是一正整数.对任一PPT敌手A在Leakj+1中把第j个密钥关联到挑战密文向量空间,把第j个半功能密钥替换成支配型密钥去解密挑战密文的优势是可忽略的.证明.假设一个PPT敌手A以不可忽略的优势达到上述的转换,我们可以构造一算法B以相同的优势区分(δ,f(τ))和(δ,f(τ))从而攻击引理1和推论1的结论.在本证明中主要考虑密钥结构,我们把主密钥当成超仿射空间的密钥,这样所有的泄露都由密钥泄露谕言机OLeak生成.B收到推论1的实例后,置m=n+1,q是N的因子.B的目标是借助A证明上述两个分布有不可忽略的优势.B模拟Leakj+1如下:首先运行Init算法生成主密钥MSK和系统公钥MPK,把公钥MPK发送给敌手A.由于B知道系统主密钥,因此可以回答敌手的任何询问.假定在第j个密钥询问中,敌手以不可忽略的优势选择与挑战空间有不动点的空间S(如不能达到不可区分的优势,则敌手无法构造支配密钥去解密密文,同时不能区分两个分布).B接下来回答A的请求生成泄露串.f是一个PPT时间的函数,输入域是Zn+1B收到(δ,f(τ)),这里τ是狓或狓,B使用f(τ)回答敌手的第i个密钥泄露询问如下:选择r1,r2,θ∈q,置Gq子群部分密钥g-υ,这里υ=(υ1,…,υn,Zd+2r1,υn+1+r2,θ).A询问挑战空间S,若第j空间钥队列中不包含S,B失败并随机输出τ是δ正交的猜测.否则,若第j个仿射空间是S=Aff(犕,狓),则存在一算法求解狓=狓+犕狕.B随机选择k2∈Zq满足υn+1+r2,(r1+〈狕,θ〉)k2=0modq,然后使用(δ,k2)∈Zn+2为参数构造挑战密文.若δ与υ正交,则第j个密钥是支配型半功能的,即(υ1,…,υn,r1,υn+1+r2)+(0,…,0,〈狓,θ〉)δ=〈υ,δ〉+δn+1r2+(r1+〈狓,θ〉)k2=0modq.若δ与υ不正交,则挑战密钥是真半功能的,即上式恒不为0.B使用A的挑战输出以不可忽略的优势区分(δ,f(τ))和(δ,f(τ)).这与引理1的推论1矛盾.因此敌手在Leakj+1中把一个半功能密钥替换成支配型半功能密钥的优势是可忽略的.引理8.若安全假设3存在,则任何多项式时间内的敌手A无法区分LeakCK和LeakCKM.证明.假设一多项式时间的敌手A以不可忽略的优势区分LeakCK和LeakCKM,我们可以构建一算法D以相同的优势解决安全假设3.当D收到假设3的实例,D的目标是猜测T=e^(gα,gs)还是T(g,g-,g^,X1=gαg-t,X2=gsg-t,T)只能为Gt中的随机猜测.为此,D扮演模拟器并回答敌手A的询问及挑战如下:(1)初始化.D随机选择a,狏,狑∈Z1+n+κN(此时D并不知道α),公钥组件e^(g,g)α可由e^(X1,g)=e^(g,g)α计算.置系统公钥MPK=(N,g,g^,ga,g狏,g狑,e^(g,g)α)并发送给A.(2)询问1.为回答A的密钥询问,模拟器随机选择狌,r∈ZnX1gr(a+〈狓,狑〉)-〈狌,狏〉,gr,gr犕狑)g^[n+d+2]g-[n+d+2].显然D,SKS是半功能的.(3)挑战.A提交给D两个挑战的消息m0,m1Page10及挑战子空间S=Aff(犕,狓),模拟器D随机选择β∈{0,1},输出密文CTS=(mβ·T,X狏2,X(犕)狑2).X-a-〈狓,狑〉S及其超空间作ORevl询问.(4)询问2.与询问1相同,同时要求A不能对(5)输出X2=gsg-t.当T=e^(gα,gs)时,CTS是半功能化的,其半功能参数γ=t(狌,1,-a-〈狓,狑〉,(犕)狑),成功模拟LeakCK.当T是Gt中的随机元素时,cm是Gt中完全随机的元素,此时密文是一随机消息的半功能密文,β在密文中是信息论隐藏的,成功模拟LeakCKM.若敌手A以不可忽略的优势猜测β,D使用A的输出成功解决安全假设3.定理3得证.6泄露性能分析为分析密钥抗泄露性能,我们给出如下两个定义.定义6.主密钥泄露率(Master-keyLeakageRatio).可泄露的主密钥MSK大小与主密钥长度的比值称为主密钥泄露率MLR.MLR=MSK定义7.密钥泄露率(Secret-keyLeakageRatio).可泄露的用户密钥SKS大小与密钥长度的比值称为密钥泄露率SLR.SLR=SK方案中主密钥长度是固定的,在参数确定的情况下泄露界也是确定的,因此MLR一般是确定的.本方案具有密钥委托的功能,密钥长度在委托中随仿射子空间的维度变化.SLR除与系统的参数有关外,还与仿射空间有关.本方案支持有限界的密钥SKS和主密钥MSK的抗泄露安全.根据引理1、推论1及引理7,对于大素数q,任意泄露函数的输出|Ω|4qm-3(q-1)·negl(·)2=41-1()qqm-2·negl(·)24qm-2·negl(·)2.为达到negl(·)的可忽略性,设negl(·)=q-c,n+1=m,则可泄露的长度k=log2|Ω|=2+(m-2-2c)log2q=2+(n-1-2c)log2qbit.这里n是大于等于2的任意正整数,c是可选择的常数.显然,N=pqr,方案中泄露的界由子群Gq的阶q决定,与p,r无关,我们可以通过调整G子群的大小来实现优化的密钥长度和泄露界.我们考虑AES-80标准的安全性,由于N要不能被因式分解,N=1024bit,G是椭圆曲线上的双a2(n-1-2c)线性群,|G|=log2λ=1024.设|p|=a1λ,|q|=a2λ,|r|=a3λ,(a1,a2,a3>0).MSK∈Gn+κ+21024(n+κ+2)bit.主密钥泄露率MLR=(n+κ+2)(1+a1+a3),而每个仿射子空间的密钥泄露率SLR=a2(n-1-2c)Dim(S).可见,随着委托的深入,d减小,密钥泄露率会变大,主要原因是仿射子空间越小,其密钥越短.我们可以通过调整参数n,c,a1,a2,a3可以得到不同的泄露率.在图1中,在空间的最大维度设定为50,子空间阶的大小分别是160bit、704bit和160bit的情况下,我们分析密钥的泄露率随泄露参数n的变化.结果显示,当n=100时,密钥的可泄露率达到73%仍是安全的.图2显示在n=100,κ=50,c=1的情况下,系统性能随委托深度d的变化情况.可知,随着委托的深入,用户的仿射角色空间变小(d=Dim(S)递减),但用户密钥的抗泄露能力提高.图1公钥MPK/密钥SK/密文CT/泄露率SLR图2公钥MPK/密钥SK/密文CT/泄露率SLR7小结本文提出了一种抗主密钥泄露和连续用户密钥Page11泄露的双态仿射函数加密方案,在标准模型下证明了该方案的安全性,分析了方案中的主密钥和用户密钥的泄露界,通过优化参数可达到73%的泄露率,具有较好的抗泄露性能.改进本文方案达到通过设计高熵不可逆的函数达到支持无界密钥泄露的加密方案是接下来研究的目标.
