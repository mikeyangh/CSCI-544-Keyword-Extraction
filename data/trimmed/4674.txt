Page1BN-Mapping:基于贝叶斯网络的地理空间数据可视分析陈为朱标张宏鑫(浙江大学CAD&CG国家重点实验室杭州310058)摘要地理空间数据指的是带有显式地理位置信息的数据,此类数据通常是多源、多变量的,其各变量之间的因果关系是位置相关的、异构的及多面性的,这给多变量地理空间数据的分析带来了很大的挑战.文中基于贝叶斯网络,针对地理空间数据提出了一种新颖的可视分析方法.首先,文中用一种启发式的方法对原始的多变量地理空间数据进行离散化,将连续的变量转换成离散的变量;然后,该方法对离散化之后的数据进行训练,得到相应的贝叶斯网络模型;接着,该方法针对贝叶斯网络模型的拓扑结构、条件概率表及数据本身基于地理位置的分布关系等分别设计了可视化视图并进行可视化;最后,文中设计了一个可交互的可视分析界面,将多个可视化视图进行了有机的结合,允许用户对变量之间的地理位置相关的隐式关系进行交互的探索、发现及分析.文中对多个数据集进行了包括异常检测、地理分类和因果关系分析在内的多种任务的案例分析,结果表明文中提出的可视分析方法可以十分有效地帮助用户对地理空间数据进行分析.关键词贝叶斯网络;地理空间;可视分析;像素图1引言理解地理相关的异构数据的隐式因果关系是传感器网络和地理位置服务(LocationBasedService,LBS)领域最基础的问题.在地理信息系统和LBS平台中,通常需要将多变量数据进行融合分析以得到一些结论.然而,对多源数据进行简单的叠加分析不仅缺少对多源信息可靠性的考虑,也忽略了数据融合方法本身的不可靠性.贝叶斯网络,也被称为信念网络[1],是概率图模型中的一员,用于多变量数据间的关系及其不确定性的表达.一个贝叶斯网络由两部分组成:(1)以有向无环图(DirectedAcyclicGraph,DAG)表达的随机变量之间的拓扑结构;(2)每个变量的条件概率分布(ConditionalProbabilityDistribution,CPD).一个典型的贝叶斯网络学习过程由结构学习和参数学习两部分组成,分别用于生成上述的贝叶斯网络的两个部分.贝叶斯网络具有对多源数据进行融合分析的能力.贝叶斯网络被广泛应用于人工智能、工业控制和医学诊断等领域.近年来,贝叶斯网络还在犯罪分析等应用领域扮演着重要的角色[2-3].文献[3]提出了一种结合核密度估计的可视方法.然而,这些工作只生成了粗略的可视化结果,并不足以帮助人们更精确地对真实世界进行分析和预测.而地理空间位置往往成为解决这类问题的一个障碍.另一方面,用贝叶斯网络帮助用户直观地理解大规模数据仍是一个挑战.甚至,由于网络拓扑结构的抽象性、复杂性以及变量之间条件概率组合的多样性,对贝叶斯网络自身的理解也是很困难的.本文针对地理空间数据提出了一种基于贝叶斯网络的可视分析方法,称为“BN-mapping”.本文主要的贡献有:(1)提出了一个基于贝叶斯网络的可视分析框架,通过对变量之间CPD、因果关系和互信息的可视化,更好地对贝叶斯网络进行了可视化表达.(2)提出了一种基于像素图对贝叶斯网络中复杂的变量间概率关系进行可视化的方法.这种方法打破了传统方法仅仅对贝叶斯网络中父子节点之间的条件概率进行可视化的做法,允许用户交互地查看任意变量组合的条件概率或联合概率.(3)提出了一种基于glyph和地理映射的可视化方法,将用户交互选择的变量之间的概率关系在地图上进行展示,帮助用户更直观地理解数据.实验结果表明,本文的方法使得贝叶斯网络更为直观、有效.2相关工作本文工作可以看作是贝叶斯网络、可视化和地理信息系统(GeographicInformationSystem,GIS)的融合研究.据我们所知,本文是目前将这三者进行结合,通过可视分析的方式去分析真实数据的唯一工作.本文将从这三者两两之间的关系入手,对相关工作进行总结.2.1GIS可视化可视化常常自然地和GIS结合在一起,以帮助用户更清晰地了解多维数据在地理上的分布情况.尽管有很多基于层次(layered-based)的展示方式,但基于glyph和核密度估计(KernelDensityEstimation,KDE)的方法更适合用以解决此类问题.基于glyph的方法已经被研究了很长一段时间,比如用于特征可视化的Chernoff脸谱图[4]、线条画[5]和三维图标技术[6].文献[7]用彩色的矩形块和像素去描绘独立的特征,矩形块/像素可以被以多种布局形式组合成图标.DICON[8]重新设计了Voronoi图,将其边界用于编码数据的分布.KDE方法[9]适合于表达数据的连续分布.所有的这些方法可以很容易地被应用于GIS的展示部分.然而,已有的方法通常隐藏了数据内在关系的语义.本文的BN-mapping方法介绍了一种新的设计,它利用了贝叶斯网络的优点,可以传达更多的统计信息,帮助用户更好地理解、比较多维数据.2.2贝叶斯网络可视化对于贝叶斯网络的可视化,一类典型的工作着眼于属性关系,对变量间的相关性、边缘概率、互信息等进行研究.这些信息被可视编码到贝叶斯网络拓扑图边的颜色、粗细以及节点间的距离、颜色等可视通道中.Zapata-Rivera等人[10]提出了用节点颜色的色调和饱和度去编码父子节点之间的继承关系及边缘概率,它还使用节点间的距离对变量的相关程度进行了编码,距离越近代表两个节点越相关.Koiter[11]用边的粗细编码了变量之间的相关程度,用边的颜色去区别正相关和反相关.还有部分工作着眼于可视化条件概率表(Condi-tionalProbabilityTable,CPT).Druzdzel[12]允许用户查看节点的条件概率表并用最简单的饼图和直方图去可视化条件概率表中的一列.文献[13]将每个变量的条件概率表以一种像素图的方式进行展示,Page3每个“像素”的颜色编码了变量状态的条件概率,从像素图中,用户可以发现变量的正反相关等情况.Cossalter等人[14]对大规模的贝叶斯网络可视化进行研究,优化了大规模网络中多节点的比较、分析.但是上述工作都仅仅局限在贝叶斯网络自身的可视化,用户不能从地理空间的上下文中去看节点间的关系.2.3贝叶斯网络在GIS中的应用尽管在地理空间数据分析上有很多的工作[15-16],但是只有少部分工作将贝叶斯网络等概率图模型应用于GIS.而Stassopoulou等人[17]的研究表明了将这两者进行结合是一个很好的研究方向.在贝叶斯网络的帮助下,用户可以用一种更合理的方式将不同的数据层进行联合分析,从而挖掘出它们潜在的关联.文献[3]基于历史数据,利用贝叶斯网络对再次犯罪的地点和时间进行预测,并将结果展示在地图视图中.然而,目前仍然没有将与贝叶斯网络紧密相关的概率进行可视化,同时结合地图进行地理空间数据分析的方法.3方法概述3.1数据描述本文针对的数据是通过不同数据来源采集的位于地理位置pi的数据di.这些数据可以是通过特定人群进行手工收集,也可以通过爬虫程序从互联网上抓取.令X={X1,X2,…,Xn}是n个被观察到的随机变量.每个随机变量Xi有mi个状态{xi,1,…,}.假设我们采集了N个数据样本,那么采集到xi,mi的数据可以表示成D(X)={(di=(x1,si为了测试BN-mapping的可行性和性能,本文使用了3组数据集,分别是HZ2,USAC和CENT.以HZ2数据为例,它包含了来自3个不同数据源的数据子集.所有的子集都是地理位置相关的,并且都采集于杭州市的主城区.出租车数据子集包含了8386辆出租车4个月的GPS数据.从2011年11月到2012年2月,平均每月的GPS记录达到了3亿条,数据量达80GB.为了训练贝叶斯网络模型,本文首先对多源数据的各个维度进行离散化.然后根据它们的地理位置进行合并,即将同一个地理位置所对应的各个维度的数据表示成一条多维的记录.最后,本文将对应于不同地理位置的多维记录作为输入,利用基于matlab的贝叶斯网络工具包FullBNT[18]进行贝叶斯网络的训练.以HZ2数据为例,本文首先对杭州主城区在地图上做了均匀网格剖分,然后对每个网格,本文对特定问题感兴趣的属性进行统计并离散化.比如,为了研究房价的影响因素,本文统计了出租车平均速度、数量,二手房的平均价格、面积、建筑年代,暂住人口的数量、平均教育水平、男女比例、平均年龄等属性;为了进行犯罪分析,本文统计了电动车偷盗数量、娱乐场所数量、学校数量等属性.3.2问题描述本文工作与公共安全专家和GIS专家进行了合作,总结出了3个主要的任务:(1)基于地理数据的组成分析人们的日常生活会产生不计其数的数据,另一方面,我们也可以从网络或者其他途径收集更多相关的数据.因此,能否从这些大量的数据中找出潜在的因果关系成了大家关心的问题.(2)对特定事件的预测一旦发现了一个特定的因果模式,对未来特定事件的预测就成了人们进一步的需求.(3)事件模式的发现及迁移如果我们可以分析出某个区域的事件模式,那么是否可以找到另一个具有相似环境的区域,以便将该事件模式应用到这个相似的区域,用以帮助决策.为了解决前面提到的问题,我们需要一个基于地理映射的可视分析平台.该平台需要解决以下几个任务:(1)一个可以集成多个数据集的关系模型分析过程会包含多个异构数据集,包括犯罪类型、住房状态、交通状况和居民信息等.因此需要一个精心设计的数据模型去融合各个数据集以完成分析任务.(2)发现关键因素的组成从大量的变量中挖掘出一个关键因素的子集并不简单,而且这样的子集可能有多个.所以从中找到有意义的子集,并依据领域专家的知识对所有子集进行排序是很有挑战的.(3)全局映射一旦我们发现了一些共性的规则.全局映射可以进一步帮助用户理解整体情况和地理位置的上下文,这对分析是十分关键的.由于所有的这些任务都和地理空间的各层数据相关,统计方法成了建模和预测的首选.除此之外,所有需要专家参与的过程应该是可交互的、视觉上直观的.因此,受近期在犯罪制图方面的工作启发,本文提出了将贝叶斯网络和可视化相结合的解决方案.Page43.3方法流程本文的BN-mapping流程图如图1所示.整个框架由3部分组成:(1)贝叶斯网络自身的可视化;(2)各变量之间条件/联合概率的可视化;(3)基于glyph的地图可视化.多源的输入数据首先由贝叶斯网络学习引擎FullBNT进行结构和参数的学习,然后用本文提出的贝叶斯网络可视化方法对贝叶斯网络的拓扑结构和条件概率进行可视化.接着,用户可以自由地选择感兴趣的条件变量和非条件变量,图1本文方法流程图4贝叶斯网络映射在这一节中,本文介绍了基于贝叶斯网络、用于支持对地理空间数据进行交互分析的可视设计.首先介绍贝叶斯网络的概念和相关术语.然后揭示了几个在贝叶斯网络自动分析方面的难点.最后讨论了4个将贝叶斯网络进行可视化的主要组件.4.1贝叶斯网络初步贝叶斯网络[19]是一种有向的概率图模型,它提供了一种优雅的方式去表达随机变量之间的概率关系.一个贝叶斯网络由以下两部分组成:(1)定性部分g(X)=(V,E).贝叶斯网络的拓扑结构图,是一个有向无环图.每个节点Vi∈V代表一个(或一组)随机变量Xi,每条有向边Ei,j∈E代表两个(或两组)随机变量Xi和Xj之间的因果关系.(2)定量部分p(X).贝叶斯网络中的每个节点都对应一个条件概率表(或分布),该表给出了节点Xi在给定一组父节点状态Pa(Xi)={Xj|Ej,i∈E}情况下,处于各个状态的概率P(X)={P(Xi|Pa(Xi)),i=1,…,n}.相应的,贝叶斯网络也需要两个学习步骤,分别去学习贝叶斯的拓扑结构和条件概率.这两个学习步骤都是NP-hard的,但是一旦给定了变量的父子相应的概率表会在概率表可视化的视图中被可视化,帮助用户理解整体概率分布并发现内在的特征.同时,基于用户选择的结果,本文将每个样本数据编码到一个glyph中,进而在地图可视化视图中进行展示.用户还可以在地图视图上进行圈选,对局部的地理位置的概率分布进行探索.所有的这些部分共同构建了一个可自由交互、迭代分析的可视分析系统,该系统可以帮助用户发现异常、错误数据,辅助分析并完成复杂的分析任务.优先顺序,它们就可以被成熟的方法(比如本文采用的FullBNT库中采用的算法)有效地执行.得到贝叶斯网络后,它就可以被用于执行多个统计操作,比如评估、预测和隐式关系发掘.一个数据di发生的可能性可以简单地通过计算联合概率P(X=di)得到.而预测则可以通过计算期望E(Xj)或者最大化后验概率P(Xj=Xj,k)获得.即便是结构简单的贝叶斯网络,也可以获得比标准的回归方法好的效果.主要原因是即便一些具有解释性的变量没有被观察到,贝叶斯模型也会自动地把它们所带来的不确定性考虑进去.但是另一方面,要使贝叶斯网络在学习和预测方面获得好的效果也是具有挑战性的,因为这部分取决于输入的数据.如果数据本身是具有偏差的,那么预测的结果一般也会有偏差.所以一种更好的解决方案是在初始贝叶斯网络学习完成后,对模型与原始数据的匹配程度进行分析,修正偏差的数据,然后反过来优化最初的结果.由结构学习直接得到的因果关系并不够好,一般还需要融入领域专家的专业知识和经验.因此,本文设计了多个可视分析的视图,允许用户主动地选取关键变量,从而更好地理解其中的因果及概率关系.4.2数据预处理本文针对的是离散化的贝叶斯网络模型,即网络里面的每个变量的状态数都是有限的.因此,在结构学习之前,首先要对数据进行离散化.通常来说,合理的变量离散化需要计算机迭代地去计算贝叶斯Page5网络的描述长度标准[20-21],所以理论上要得到最优的离散化结果需要很长的计算时间.本文提出了一种启发式的数据离散方法用以改善贝叶斯网络的生成结果,它既可以自动完成,也可以手动交互地完成.首先对每个属性的数据进行从大到小的排序,并绘制成折线图.然后我们根据折线图2数据离散化4.3贝叶斯网络可视化给定一组如3.1节所描述的输入数据,本文就可以计算出一个基本的贝叶斯网络统计模型.受到文献[13]的启发,本文在传统的贝叶斯网络可视化基础上进行了增强.图3给出了一个具体的例子,本文方法新增了几个方面的可视编码设计.(1)可视编码设计是有向无环图的布局.本文布局总是将父节点布局在子节点的上方,以更为直观地揭示节点之间的因果关系.(2)可视编码设计是用像素图去编码每个节点关于其父节点的条件概率P(Xi|Pa(Xi)).由于变量Xi有mi个离散的状态,每个父节点Xj∈Pa(Xi)有mj个离散状态,那么像素图的大小就为∏xj∈Pa(Xi)图的形状将其分为3类典型的模式,如图2所示.首先我们找到折线的两个关键点,以使得两个关键点之间的折线基本呈线性,然后再将线性部分均匀地分割成n段.为了平衡模型的效果和计算效率,n设置成3或4即可.这种离散化策略在处理大多数数据上都能获得比均匀离散化更好的效果.(3)可视编码设计是用边的粗细编码父子节点间链接强度(linkstrength)[22]的大小,链接强度是一种很有用的度量,用来衡量一个节点Vi和它的子节点Vj之间因果关系的强弱,它的计算公式为LS(Xi→Xj)=∑Xi最后,本文的贝叶斯网络可视化结果是可交互的,用户可以对节点进行点选,被选中的节点用虚线框进行高亮,背景为白色.其余节点的背景为灰色,其明度编码了与被选中节点之间的互信息大小,明度越大,表明与被选中节点之间的互信息越大.互信息表征了一个变量对于另一个变量的不确定性的影响,对于传达贝叶斯网络中不相连节点的相关性是Page6十分有用的,两个变量之间的互信息越大,表明它们之间的相关性越强.令被选中节点为Vi,则它与任意其他节点Vj之间的互信息大小可以用如下公式计算:MI(Xi,Xj)=∑Xi4.4贝叶斯网络概率可视化当贝叶斯网络的学习完成之后,用户的任务就是根据他们具体的任务,找出有意义的变量子集Y={Yi|Yi∈X}.本文再次采用了像素图的方法去可视化任意变量组合的条件或者联合概率.当涉及的变量很多时,条件概率表会变得很大,但是像素图可以很好地应对.其主要原因是:(1)可以充分利用屏幕的矩形空间;(2)本文实现的像素图可以缩放.总之,理论上它可以应对任意大小的条件概率表,同时又能保持条件概率表的特征.4.4.1两两变量的概率像素图本文首先给出了一个变量两两之间的条件概率像素图,如图4所示.本文给出这个视图是由于用户在交互过程中会时不时地需要了解某两个变量之间的关系,因为相对于更多变量之间的概率关系,两个变量之间的概率关系对用户来说更直观,也更便于理解.通过这个视图,用户可以很快地发现某两个变量是否有很强的相关性,是正相关还是反相关,可以辅助用户进行关键变量子集的选择.4.4.2多变量概率像素图如图5所示,这是一个用像素图来展示多变量之间的条件/联合概率的视图,本文将其称为多变量概率像素图(MultivariateProbabilityPixel-map,MPP).视图上方是变量区,显示了所有可供分析的变量,包括它们的离散区间.下方中间是像素图,它被上下左右4个条状区域包围.用户可以将变量区的任意变量拖拽到下方任意条状区域中,也可以反过来将变量拖回上方变量区.被拖拽到下方的变量在变量区用灰色表示,否则用黑色表示.下方的4个条状区域中,左方和上方区域中的变量将作为条件变量,右方和下方区域中的变量作为非条件变量.以图5为例,它可视化了条件概率P(XYear,XEnt,XTSpeed|XArea,XSchool,XTheft).像素图周围的灰色条指示了各个变量的不同状态,由浅到深依次表示对应变量的第1,2,3,…个状态,而像素图里面的每个像素则编码了被选中变量处于对应状态时的概率大小,概率越大,颜色越深.以图5中矩形框选中的像素为例,它编码了概率P(XYear=3,XEnt=1,XTSpeed=1|XArea=1,XSchool=1,XTheft=2).像素图部分是可缩放的,当变量增多时,用户可以放大查看细节,也可以缩小查看整体概率分布.当用户将鼠标悬停在某个像素上面时,会显示该像素对应的各个变量的状态以及对应的具体概率值.4.5贝叶斯网络地图可视化由于本文着眼于地理空间数据,为了能更好地展示数据的地理分布,本文方法还提供了一个基于Page7图6本文方法的地图视图glyph的地图视图.如图6所示,本文方法将数据样本的属性、对应用户所选取的变量组合的概率值等统一编码到了glyph中,然后将glyph按对应数据的地理位置布局在地图视图里,可以给用户提供一个数据及其概率分布的一个快速的概览.当用户将鼠标悬停在glyph上面,会显示其具体的属性及概率信息.下面对glyph的可视设计进行详细阐述.本文所使用的glyph本质上也是一个像素图,其中第1行3个像素格子编码了以下3个量:(1)P(Y1=y1,…,Yl=yl|Z1=z1,…,Zk=zk):从贝叶斯网络模型中推断出来的条件概率.(2)Pstat(Y1=y1,…,Yl=yl|Z1=z1,…,Zk=zk):直接从原始样本数据中统计得到的条件概率.(3)|P-Pstat|:上述两者差的绝对值.剩下的像素则用于编码每个用户所选中的变量的离散状态.非条件变量排在前面,条件变量排在后面.颜色的饱和度用于编码变量所处的离散状态,由浅到深依次表示第1,2,3…个状态.和一些看起来更为复杂的设计(比如将颜色编码到圆形或者复杂的多边形)相比,像素图的方法更为简洁,它更容易实现、能更快地显示、有更好的拓展性,也更易于理解.由于本文使用的数据按地理空间上的性质分有两种类型,一种是基于均匀剖分网格的,另一种是直接基于地理位置的(比如城市、国家).本文对两种数据采取了两种不同的方式进行可视化:对于均匀剖分的数据,本文将glyph被放置在每个网格的中心,并且为了看起来更整洁,直接略过了没有数据的网格,如图7所示;对于直接基于地理位置的数据,glyph被直接放置在对应的地理位置上,如图6所示.显然,数据过密的时候,这种方式会造成相互遮挡的问题.为了解决这一问题,本文将相互遮挡的glyph进行合并(合并算法如算法1所示),并用所有被合并的glyph的均值去编码新的glyph,并根据合并的glyph的数目决定新的glyph的大小,即被合并的glyph的数目越多,新的glyph的尺寸越大.Page8算法1.glyph合并算法.1.WHILETrueDO2.merged←False3.n←numberofglyphs4.FORi=0ton-1DO5.FORj=i+1tonDO6.IFglyphiintersectsglyphjTHEN7.glyph←merge(glyphi,glyphj)8.glyphs.remove(glyphi)9.glyphs.remove(glyphj)10.glyphs.push(glyph)11.merged←True12.ENDIF13.ENDFOR14.ENDFOR15.IFnotmergedTHEN16.break17.ENDIF18.ENDWHILE5地理空间数据的可视分析在3个主要可视化视图的基础上,本文构建了一个针对地理空间数据进行分析的BN-mapping原型系统,在该系统中,一个典型的分析过程包括以下步骤:Step1.用户选择需要进行分析的数据,系统对数据进行自动的贝叶斯网络结构和参数的学习并将学习的结果进行可视化.Step2.用户进行交互,发现并选取感兴趣的变量作为条件或非条件变量.相应地,多变量概率像素图和基于glyph的地图视图会进行相应的更新.用户可以实时查看是否有感兴趣的特征出现.Step3.当用户找到一些感兴趣的特征(特征可以是像素图中特别的像素,也可以是特别的glyph,或者是地图上一块特殊的区域),他们可以用前文提到的交互进行进一步探索.如果有些由于噪声数据引起的异常特征被发现,用户可以反过来相应地修正原始的数据,然后重新开始新一轮的分析.可视分析中很重要的一步是对于一个特定的分析问题,从已有数据众多的属性中挑选出和该问题密切相关的少数几个关键属性.上述的第1步可以为用户揭示变量之间的因果关系、相关性,有效地辅助用户挑选出这些潜在的关键属性,从而使得分析过程更为高效和准确.其次,由于本文针对的是地理相关的数据,本文系统的基于glyph的地图视图可以直观地展示数据所蕴含的事件分布模式.此外,本文系统是可交互的,用户在尝试不同的关键变量组合的时候可以实时地看到数据分布的变化,这大大提升了本文系统的可用性.基于本文系统,用户可以进行包括异常检测、地理分类和因果关系分析在内的多种任务.6案例分析6.1异常检测位置信息错误:由于相同的商店名、街道名等原因,数据所对应的地理位置经纬度在数据预处理阶段很容易被弄错.本文系统可以帮助用户快速发现此类错误,如图7所示,我们可以快速发现用虚框高亮的glyph第2行的第1个像素颜色很淡而第2个像素颜色较深,和周围的glyph截然相反.通过查看原始的数据,我们发现这是由于Google的逆向地址解析服务返回了错误的经纬度信息造成的.孤立的数据点:如图8所示,我们可以看到在最右侧的glyph(用虚框标出)有明显异常,它第3个像素格子的颜色特别深,表明经由贝叶斯网络推断出来的概率和直接从统计结果中得到的概率差别很Page9大,这是十分不正常的.通过查看原始数据,我们发现该区域对应的条件变量状态的组合在整个数据中只出现了一次,所以Pstat=1,而贝叶斯网络可以抵抗此类噪声并对该处的概率作更好的估计.这个例子也表明了将贝叶斯网络应用于可视分析是有意义的.6.2HZ2数据这是一个从杭州市收集的数据,该数据包含了房屋的平均建筑年代(Year)、面积(Area)、均价(Price)、娱乐场所的数目(Ent)、学校的数目(School)、出租车的数目(TCount)和平均速度(TSpeed)以及电动车偷盗数量(Theft)等维度.在这个案例中,我们希望通过本文系统去发现电动车偷盗的犯罪模式.换言之,我们需要找到引发此类犯罪最显著的因素.首先,通过贝叶斯网络的学习,我们得到了图9(a)所示的贝叶斯网络的可视化结果.由于本文在这个案例中研究的是电动车偷盗的相关因素,因此本文首先选中了Theft属性,可以看到Ent节点的背景明显比其余节点亮,表明电动车的偷盗和娱乐场所的数目之间互信息最大,而娱乐场所数目和房屋的建筑年代之间的边较粗,表明它们之间的链接强度较强,有较强的关联.所以我们首先选取了建筑年代和娱乐场所数目作为条件变量,电动车偷盗数作为非条件变量.通过查看地图视图图9(b)可以看到第1格颜色深的glyph基本集中在老城区,表明电动车偷盗发生在老城区的概率比较高,通过观察glyph可以看到,该区域对应glyph的第2格颜色较浅,表明该区域的建筑年代比较早(在2003年之前),我们由此可以猜测,由于老房子通常照明条件不好、并且伴有很多监控死角,导致电动车偷盗集中.另一方面,我们发现该区域对应的第3格颜色较深,表明该区域娱乐场所的数目多,这可能是由于娱乐场所交通比较方便,便于犯罪分子转移赃物.6.3USAC数据该数据从美国统计局的网站上下载得到,对包括谋杀(Murder)、强奸(Rape)、抢劫(Rob)、故意伤害(Assault)、入室盗窃(Burglary)、扒窃(LTheft)和机动车盗窃(MVTheft)在内的7种不同类型的犯罪进行统计.该数据的采集时间是2000年4月,包含了1265个人口在25000以上的地区的数据,基本覆盖了美国所有的洲.在这个案例中,我们的目标是发掘各种不同犯罪类型间潜在的关联及其在地理上的分布特点.首先,从图10(a)中我们看到,Murder和Rob、Rob和MVTheft之间的边比较粗,且从像素图中可以看到Rob关于Murder的条件概率P(Rob|Murder)以及MVTheft关于Rob的条件概率P(MVTheft|Rob)都呈现明显的对角线模式,表明这三者之间存在着较强的正相关关系.基于这个观察,本文选择了这3个变量,将Murder、Rob作为条件变量,MVTheft作为非条件变量,对它们的条件概率关系进一步进行探索.从图10(c)的地图视图中,可以看到glyph有着很明显的地域分布,本文用虚线将其大致分成了美国东部、中部以及西部.可以看到,美国西部多地glyph的第1个属性格子颜色很深,表明该区域机动车偷盗较多.而美国东部的glyph后两个属性格子颜色较深,表明该区域抢劫、谋杀罪较多.美国中部则所有的属性格子颜色都比较浅,表明该区域这3种类型犯罪都比较少.这是由于美国的人口分布,以及各个地方文化的差异造成的.此外,在放大地图视图进行进一步探索的时候,Page10图10USAC数据的案例分析我们发现芝加哥附近有明显的特征.如图10(b)所示,相对于所有周边城市,芝加哥有着更高的犯罪率,并且从glyph的第1行可以看到芝加哥对应的犯罪模式拥有更大的概率.这可以被解释为人们倾向于从小城市向大城市或港口城市移动,因此大城市有着更多的人口,犯罪数量也会更多.6.4CENT数据CENT数据是一个公开的企业数据,包含了超过26万条中国国内企业的数据,每条数据包含了133个描述一个企业各个方面的属性.为了研究中国纺织企业的产业结构和地理分布,本文从中采样了2000条和纺织企业相关的数据.对每条数据,本文提取了员工数(Employee)、成立年份(Year)、利润(Profit)、债务(Debt)、福利支出(Welfare)、员工培训支出(Train)和总资产(Assets)等7个属性.利润是衡量企业发展状况的很重要的一个指标,所以本文首先选取了Profit属性作为非条件变量,根据训练得到的贝叶斯网络的结果,Employee和Profit间有着直接的因果联系,而Employee和Debt之间又可以看到明显的正相关关系,因此本文选取了Employee和Debt两个属性作为条件变量.在地图视图中本文对京津、长三角、珠三角和武汉等区域的纺织企业分布情况进行了查看.基于对这些地域的分析,本文发现了一个中国纺织企业布局中重要且普遍的模式.和我们的预期不同,从结果(图11(c)~(f))上看,国内纺织企业的热点并不在大城市,而是在大城市周边的小城市.比如,在图11(e)中,可以看到上海、杭州、南京等大城市的纺织企业无论在员工数、债务、利润方面,还是在其模式的普遍性方面,都不及周边的无锡、绍兴等小城市.究Page11其根本原因,是由于在大城市开设工厂的各方面成本较高,对企业污染物排放的标准也较高,纺织这类劳动密集型,且相对污染排放较多的企业对生产及运输成本进行权衡后,更倾向于将工厂安排在大城市周边的小城市,然后将产出的商品运输到大城市进行销售.这种模式也出现在广州和北京等地.另一个有趣的案例发生在武汉图11(c),武汉虽然也是大城市,但是和其周边的孝感一样,都是纺织企业的热点城市.但是通过观察两者的年份属性,图11CENT数据的案例分析本文发现孝感的纺织企业的成立年份要比武汉的晚,这意味着孝感是一个新的热点城市,纺织企业正从武汉向孝感迁移.我们可以据此预测,武汉的纺织企业将在未来几年进一步减少而孝感的纺织企业将进一步增多.在这个案例中,地理信息扮演了一个重要的角色.如果没有在分析的时候可视地提供地理信息的上下文,直接从数据中去进行统计分析很难发现类似的规律.Page127结论和未来工作本文基于贝叶斯网络这个统计模型,针对地理空间数据提出了一种新的可视分析方法.为了解决用户在模式发掘过程中需要选择有意义的关键变量的问题,本文设计了3个主要的视图:贝叶斯网络视图、多变量概率像素图、基于glyph的地图视图.这3个视图也对应了贝叶斯网络分析的3个部分,即结构学习、参数估计和基于概率的分析.贝叶斯网络的结构和概率表可以直观地帮助用户选择关键的变量,从而更好地进行可视分析.本文方法可以被用于修正数据、区分不同的地理区域、发现热点及复杂的因果关系.本文用3个案例证明了本文方法的有效性.将来,我们将考虑将本文方法拓展到时变数据,以提供一个统一的时空数据可视分析解决方案.另外一个研究的方向是提高贝叶斯网络的学习效率,将其和云计算结合并应用近似的方法.除此之外,我们需要指出,目前的离散模型并不是贝叶斯网络自身的局限,我们可以用变分贝叶斯的方法去处理连续概率分布[23].总的来说,本文工作给GIS、可视化和贝叶斯网络三者的交叉研究领域提供了一个起点,也为未来基于地理定位的大规模数据分析和智能化管理提供了一种可行的研究途径.
