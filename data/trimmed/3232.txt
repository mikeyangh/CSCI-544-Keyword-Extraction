Page1一种基于多级弦长函数的傅立叶形状描述子王斌(南京财经大学电子商务省级重点实验室南京210046)(东南大学生物医学工程学院南京210096)摘要提出了一种用于形状检索的基于多级弦长函数的傅立叶形状描述子(MCLFD).它产生于对形状轮廓线的等弧长分割.相对于其它的傅立叶描述子,MCLFD不仅计算非常简单,而且对形状的整体特征和细节信息都能进行很好的描述.作者用MPEG-7的标准轮廓线形状测试集和从野外采集的植物叶片形状库,对MCLFD进行了检索性能测试,并和其它的傅立叶描述子进行了对比,实验结果表明,MCLFD具有更优的检索性能,通过加噪声实验也证明了其鲁棒性.关键词图像分析;形状描述;傅立叶描述子;多级弦长函数1引言形状是目标的非常重要的一个视觉特征,人往往仅从目标的形状特征就能完成对目标的识别[1].因此形状描述,即如何有效地抽取目标的形状特征一直是图像处理和模式识别研究领域的一个热点问Page2致性;(6)分级的由粗到细的描述能力;(7)一般的应用能力.傅立叶描述子是一种具有上述特性的经典的形状描述方法.该方法首先将目标形状的轮廓线表示成一个一维的轮廓线函数,又称为形状签名(shapesignature),然后对该函数作傅立叶变换,由傅立叶系数构成形状描述子[6].尽管该方法自提出迄今已有三十多年[7],但由于其存在着大量的潜在应用,该方法仍然吸引了模式识别和图像处理领域的广大学者的持续关注.概括近些年对傅立叶描述子的研究工作,可以分为如下3类:(1)着眼于提出新的傅立叶描述子,如文献[8]提出了一种基于面积函数和一种基于弦长函数的傅立叶描述子,文献[9]提出了一种基于最远点距离函数的傅立叶描述子,文献[10]则提出了基于一种角度半径复函数的傅立叶描述子;(2)比较研究,即将该方法与其它的形状描述方法进行比较研究,以证明该方法优良的性能,如与自回归模型的比较[11]、与链码和各种矩的比较[12]、与曲率尺度空间描述方法的比较[13]等;(3)应用研究,如应用于字符识别[14]、应用于牙齿咬翼片图像中的牙齿的分类和编号[15]等.傅立叶描述子是一类方法,同一形状的不同轮廓线函数表示将会产生不同的傅立叶描述子.为评估各种傅立叶描述子的性能,文献[8]在MPEG-7标准测试集上,比较了现有的各种傅立叶描述子的检索性能,结果表明不同的傅立叶描述子存在着较大的差异.本文的主要贡献在于:(1)提出了一种新的轮廓线函数———多级弦长函数来产生傅立叶描述子.该方法能更好地描述形状的全局特征和局部细节信息,具有由粗到细的形状描述能力.该方法在MPEG-7标准测试集上的检索精确率,比现有的检索性能最好的傅立叶描述子[8]高出了近10个百分点;(2)将本文提出的方法实际应用于植物叶形的检索和识别,在我们从野外采集到的90种植物的叶片(每种植物采集了12个样本)所构成的图像库中,图1新近提出的几种轮廓线函数其检索精确率则高出了近12个百分点.2相关工作复坐标函数是最早用来产生傅立叶描述子的轮廓线函数[16],其产生过程是:将轮廓线看成复平面的一个封闭的曲线,从曲线的始点出发,沿逆时针方向跟踪曲线,将经过的点的复坐标定义为走过的弧长的函数.而切角函数[17]、曲率函数[18]则分别将在轮廓线的点上的切角和曲率定义为到始点的弧长的函数.轮廓线上的点到形状的几何中心的距离也是形状的一个重要的几何特征量,可以将这个几何特征量定义为到轮廓线始点的弧长的函数,称为中心距离函数[11].近年来,又有一些新的轮廓线函数被提出.文献[8]提出两种新的轮廓线函数———三角形面积函数(TAF)和弦长函数(CLF).三角形面积函数定义为:对轮廓线上的每一个点P,沿逆时针方向在轮廓线上找一点P1使得角∠POP1=5°,将三角形的面积S△POP1定义为到轮廓线始点的弧长的函数(图1(a)所示),这里O是形状的几何中心点.弦长函数的定义为:对轮廓线上的每一点P作轮廓线的切线,设该切线的法线与轮廓线的交点为P1,将弦PP1的长度定义为到轮廓线始点的弧长的函数.当法线与轮廓线有多个交点时(图1(b)所示),取使弦全部落在形状区域的交点,如图1(b)有多个交点P1,P2,P3,因为交点P1使弦PP1全部落在形状区域的内部,所以取弦PP1的长度.文献[10]提出了一种角度半径复函数,该方法将由轮廓线上的点到形状几何中心的距离(也称半径)和在该点的切角构成的复数(前者构成实部,后者构成虚部)定义为到轮廓线始点的弧长的函数(图1(c)所示).由于轮廓线是离散的数字曲线,求取轮廓线上的点的切线非常困难,所以用由该点和其在轮廓线上的邻近点的连线来近似切线(如图1(c)中的直线PP1).文献[9]则提出了一种最远点距离(farthestpointdistance)轮Page3廓线函数,该方法对轮廓线上的每一个点,首先在轮廓线上找到距其最远的点,然后将这两个点到形状中心点的距离和定义为轮廓线始点的弧长的函数(图1(d)所示).文献[8]通过大量的实验测试了分别从复坐标函数、曲率函数、中心距离函数、三角形面积函数和弦长函数导出的傅立叶描述子的检索性能,得出结论:中心距离函数的性能最好、曲率函数的性能较差、三角形面积函数接近中心距离函数的性能,而弦长函数的性能介于中心距离函数和曲率函数之间.但需要指出的是中心距离函数由于利用了形状的几图2两种不同树叶形状的中心距离函数3多级弦长函数3.1多级弦长函数的定义一个二维轮廓线可以表示为一个点的有序集C={X0,X1,…,XN-1},这里N是轮廓线上的点的个数,因轮廓线是闭合的,所以定义XN+i=Xi.定义P=∑N-1d(Xi,Xi+1)为轮廓线的周长,这里d(·)表i=0图3由轮廓线上的一点引出的等弧长分割轮廓线的弦当点Xj沿轮廓线移动的时候,K-1条弦长L1(Xj),L2(Xj),…,LK-1(Xj)也随之发生改变.也就是说弦长Li(Xj)是点Xj的函数.不失一般性,设何中心这个全局特征点,且中心距离能描述形状的内部结构,所以能很好地反应形状的全局特征,但是对形状的细节信息描述能力较弱.这里用一个例子来说明,如图2中的a和b是两种不同的树叶,c是将这两种树叶的轮廓线进行配准.从该图我们可以看出树叶a和b的整体形状特征非常相似,但它们在细节方面又有明显的差异,相对于树叶b,树叶a的叶缘有比较明显的锯齿.图2给出了将它们的中心距离函数绘成的曲线,从该图可以看出两条曲线非常接近,反应出中心距离函数对这两种树叶形状的区分能力非常弱,对形状细节信息的描述能力不足.示两点之间的欧氏距离.对轮廓线上的任一点Xj,从它出发,沿逆时针方向将轮廓线分割成等弧长的K个弧段Xj针方向的第i个等分点,K是预先设定的参数,它是一个大于1的偶数.连接点Xj和其它K-1个等分点Si,得到K-1条弦XjS1,XjS2,…,XjSK-1,这里用Li(Xj)表示第i条弦XjSi的长度.图3给出了一个8等分轮廓线得到7条弦的例子.X0为轮廓线的起始点,那么轮廓线上的任一点Xj可以由X0沿轮廓线、按逆时针方向到达Xj所走过的弧长xj唯一确定.因此,弦长Li(Xj)可以表示为Page4弧长的函数Li(xj).这样,我们得到了K-1个自变量是弧长、因变量是弦长的函数L1(x),L2(x),…,LK-1(x),这里x∈[0,P].从这些函数的产生过程可以看出,函数Li(x)是计算的轮廓线上所有弧长为i·P/K的弧所对应的弦的弦长.这样依据计算的弧长不同,将这些函数分成K-1级,并称这些函数的有序集φ={L1(x),L2(x),…,LK-1(x)}为多级弦长函数,函数Li(x)是多级长函数φ中的第i级弦长函数.从这里也可以看出,φ中的第K/2级弦长函数LK/2(x)的值是将轮廓线等弧长分割成两个弧段的弦长.多级弦长函数显然满足平移和旋转的不变性,因为平移和旋转并不改变各个割点在轮廓线上的相对位置,因而不改变弦长.但是不满足缩放不变性,为此,我们用轮廓线的周长P对弧长进行归一,用各级轮廓线函数的最大值即max(Li(x))对函数值进行归一.这样,我们得到了K-1个满足平移、缩放和旋转不变的多级弦长函数.但是,它们仍然依赖于轮廓线的始点,也就是说当轮廓线的始点发生改变时,函数要发生在x轴方向的平移.对于这个问题,我们将在后面通过傅立叶变换来解决.一个形状描述子应该尽可能紧致.通过多级弦长函数的产生过程,我们发现,对于轮廓线上的任意一点Xj,设S1,S2,…,SK-1是其它的K-1个图4树叶a和b(见图2)的参数K=8的多级弦长函数曲线分割点,我们有L1(Xj)=LK-1(S1),L2(Xj)=LK-2(S2),…,LK/2(Xj)=LK-K/2(SK/2).所以,K-1个函数有一半是冗余的,因此我们将多级弦长函数φ进行压缩,去掉第K/2+1级到第K-1级弦长函数.这样,多级弦长函数φ被压缩为φ={L1(x),L2(x),…,LK/2(x)},它包含K/2级弦长函数.3.2多级弦长函数的描述能力分析一个好的形状描述方法不仅应该能反应形状的整体特征,而且还应该能描述形状的细节,这两部分信息对于区分和识别形状来说同等重要[19].而多级弦长函数由于产生于对轮廓线的等弧长分割,不同级别的弦长函数计算的是不同弧长的弧所对应的弦的弦长.如第一级弦长函数L1(x)计算的是弧长为P/K的弧所对应的弦长,而第K/2级弦长函数LK/2(x)是计算弧长为P/2的弧所对应的弦长,这里P是轮廓线的周长.弧越长,即函数的级越高,所对应的弦越倾向于描述形状的全局信息,反之则倾向于形状的局部细节.我们仍然用图2中的两个树叶形状来说明多级弦长函数的这个特点.计算树叶形状a和形状b的参数K=8的多级弦长函数,分别得到4级弦长函数.图4给出了树叶a和b的4个级别的弦长函数曲线.从该图可以看出,第一级弦长函数(图4(a))曲线差异非常明显,很好地反应了树叶a和树叶bPage5在细节特征方面的差异.而到了第二级、第三级(图4(b)和图4(c))反应出来的差异在减少.到了第四级(图4(d))两条曲线就变得非常接近,跟中心距离对弧长函数一样,反应出了树叶形状a和b整体特征的相似性.从这个例子可以看出,用多级弦长函数描述形状,树叶a和树叶b的整体特征的相似性和细节特征的差异性都能得到很好的反应.所以,多级弦长具有较强的形状描述能力,能由粗到细地描述形状信息.从这个例子可以看出,多级弦长函数的描述能力受参数K的影响.当K=2时,只有一个级别的弦长函数,其第一级弦长函数的曲线如图4(d)所示(与参数K=8的多级弦长函数的第4级相同).显然,此时对形状细节的描述能力非常弱.当K=4时,只有两个级别的弦长函数,其第一级弦长函数的曲线如图4(b)所示(与参数K=8的多级弦长函数的第二级相同),此时多级弦长函数已能反应较多的形状细节信息.而当K=8时,其第一级弦长函数的曲线如图4(a)所示,则能反应更多的信节信息.所以,对于多级弦长函数来说,K越大,对轮廓线等分的段数就越多,分得的弧长就越小,就能描述形状更多的细节信息.但是K太大,分得的弧长就太小,就会在形状描述中引入噪声成份.此外K太大,计算的复杂性也会较高,所需的存储空间也很大.3.3时间复杂度分析因为数字曲线是离散的,而且有噪声的影响,所以相对于弦长,切角和曲率不容易计算而且非常不稳定.文献[8]提出的弦长函数虽然也是用弦长来描述形状的特征,但是,由于其弦长的计算跟轮廓线的点的切线相关,也就是说要计算弦长,要先计算在该点上的切线,因而造成计算出来的弦长也不稳定,而且在产生与轮廓线有多个交点的情况下,对交点的选择也增加了计算复杂度.多级弦长函数产生于对轮廓线的等弧长分割,而从轮廓线上某一个点开始,将轮廓线分割成K个等长弧段的的时间复杂度为O(K),因此将轮廓线上的每一个点作为始点完成这样一次分割的时间复杂度为O(KN),这里N是轮廓线上的点的个数.一般K取的很小而且KN.所以多级弦长函数有较低的计算时间复杂度.4多级弦长函数的离散傅立叶分析4.1基于多级弦长函数的傅立叶描述子(MCLFD)设一个形状的多级弦长函数为φ={L1(x),L2(x),…,LK/2(x)}.因为这些函数是以离散的形式表示的,一般的离散傅立叶变换的时间复杂度为O(N2),而快速傅立叶变换(FFT)的时间复杂度为O(NlogN2),并且当N=2T时,算法的效率最高[20],这里N是函数采样点的个数.所以,这里跟文献[21]一样,我们首先对每一个函数Li(x)对自变量区间[0,1]进行等间隔离散化成N个点x0,x1,…,xN-1,这里N满足N=2T.对多级弦长函数φ中的每一个函数Li(x),进行快速傅立叶变换,得到傅立叶变换系数的复数形式如下:对于每一个傅立叶系数Ui(n)计算它的模|Ui(n)|,取N个系数中的前M个,构造向量μi=[|Ui(0)|,|Ui(1)|,…,|Ui(M-1)|]T.于是向量的有序集μ={μ1,μ2,…,μK/2}就构成了基于多级弦长函数的傅立叶描述子(MCLFD).4.2不变性分析因多级弦长函数满足平移、旋转和缩放的不变性,所以得到的基于多级弦长函数的傅立叶描述子(MCLFD)也是不变的.但是多级弦长函数依赖于轮廓线的起始点.下面我们说明MCLFD是不依赖于轮廓线的始点.设一个多级弦长函数为φ={L1(x),L2(x),…,LK/2(x)},设x0,x1,…,xN-1为对自变量x所在区间[0,1]进行离散化所得到的序列,这里x0为序列的始点.对于φ中的任一函数Li(x),其傅立叶变换系数为Ui(n)=1这里W=expj2π()N,珮W表示W的共轭复数.当序列的起始点发生改变,不失一般性,设起始点变为x1,即序列变为x0,x1,…,xN-1.则函数Li(x)发生改变后的傅立叶变换系数为U^i(n)=1则有U^i(n)·珮Wn=1所以有|U^i(n)·珮Wn|=|Ui(n)|,n=0,1,…,N-1(5)因而有Page6|U^i(n)|=|Ui(n)|,n=0,1,…,N-1(6)所以得出MCLFD是独立于轮廓线的始点的.4.3用MCLFD度量形状的相似性现在,我们得到了一个满足平移、旋转和缩放不变的,以及不依赖于轮廓线始点的形状描述子MCLFD.下面我们用它来度量两个形状的之间的差异.设形状A和形状B的MCLFD分别为μA={μA1,μA和形状B之间的差异用如下公式进行度量:2,…,μA这里|μ(A)距离,可以选用欧氏距离或曼哈顿距离.5实验结果和讨论5.1MPEG-7形状数据库和植物叶片形状数据库MPEG-7形状数据库是近年来被广泛用来测图5MPEG-7形状库和从野外采集的植物叶片形状库5.2用来进行对比的其它形状描述方法因为本文提出的方法MCLFD属于傅立叶描述方法,所以常用的和新近提出的其它傅立叶描述方法将作为主要的比较对象.这些方法有:(1)复坐标函数(CC)[16];(2)中心距离函数(CD)[11];(3)切角函数(AF)[17];(4)曲率函数(CF)[18];(5)三角形面积函数(TAF)[8];(6)最远点距离函数(FPD)[9];(7)弦长函数(CLF)[8];(8)角度半径复函数(ARC)[10].文献[23]提出的一种基于小波变换和傅立叶变换的形状描述子(WFD),在这里也作为比较对象.另外,形状上下文方法(Shapecontexts)[24]、曲率尺度空间方法(CurvatureScaleSpace)[25]、小波描述子(WaveletDescriptor)[26]、保留相位信息的傅立叶描述和动态时间扭曲距离度量方法(WARP)[27],这4种方法的实验结果数据,也直接从相关文献引入,作试形状描述子的检索性能的一个标准测试集[8-9].该数据库含有70种形状,每种形状有20个存在类内差异的样本(如图5(a)所示),整个数据库总共有1400幅图像.植物叶形的检索和识别是一个非常有实际应用价值的研究课题.植物的叶形是传统识别植物的重要和常用的形态特征[22],但植物种类非常多,叶片形态看似接近,实则千差万别,使得人工方式进行叶形的识别存在很大的困难.植物的叶形是一个二维的平面,比较容易进行图像的处理和加工.因此探讨植物叶形的计算机辅助识别具有非常大的实际应用价值.为研究MCLFD在植物叶形状检索和识别中的应用,我们从野外采集了90种植物的叶片,每种植物采集了12个样本,共采集了1080个植物叶片.对采集到的叶片,用扫描仪进行扫描,得到数字化的彩色图片.然后对这些彩色图像进行二值化处理,最后构成一个叶片形状的二值图像库,库中总共有90种植物叶形,每种叶形有12个样本(如图5(b)所示).为跟本文提出的方法的比较.5.3性能评估方法查全与查准率对(recallandprecisionpair)是一种在文献中被广泛使用的检索性能评估方法[8].查准率P和查全率R的定义为P=r/n1,R=r/n2,这里,n1是一次查询返回的形状的个数,r是返回的形状中与查询形状相似,即属于同一类形状的个数.n2是形状库中与查询形状相似的个数.另一种度量检索性能的方法是计算平均检索率.在每一次检索中,在返回的t个形状中(即用差异度公式计算的值最小的前t个),计算与查询形状相似的个数r,那么一次查询的检索率定义为r/m,这里m是数据库中与查询形状相似的所有形状的个数.计算所有查询的平均即得到平均检索率.对于MPEG-7数据库,总的检索次数为70×20,t设定为2×20.对于植Page7物叶片数据库,总的检索次数为90×12,t设定为2×12.5.4实验平台和参数设置实验平台为一台CPU为IntelCore-2Duo2.4GHz,操作系统为WindowsXP的计算机,编程工具为MATLAB6.5.为进行快速傅立叶变换,形状库中的所有形状,在轮廓线被提取后,被重新采样为256个点,植物叶片库,则采样为512个点.每一种用来比较的傅立叶描述子取的长度为M=32,其它参数同相关文献给出的设置.对于MCLFD,取参数K=16,这样就得到8个级别的弦长函数,并且对每一级弦长函数,取的傅立叶变化系数的个数也为M=32.这里所有的傅立叶描述方法都用式(7)来度量形状的相似性,分别采用欧氏距离和曼哈顿距离来度量.5.5检索结果和分析表1给出了MCLFD和其它的形状描述方法在MPEG-7形状库和植物叶片形状库的检索实验中,分别采用欧氏距离和曼哈顿距离这两种形状相似性度量,所得到的平均检索率.对表中列出的Shapecontexts[24]、Curvaturescalespace[25]、Waveletde-scriptor[26]、WARP[27]4种方法的平均检索率,则是相关文献报告的在MPEG-7形状库中的实验结果.图6MCLFD和其他5种方法在MPEG-7形状库和植物叶形库中的查准率/查全率曲线图7MCLFD和CD在MPEG-7测试集和植物叶片形状库中的检索结果的例子表1用不同的形状描述方法进行检索实验所得到的形状描述方法傅立叶描述子WFDShapecontextsCurvaturescalespaceWaveletdescriptorWARP从表1中,选出在MPEG-7测试集中的平均检索率超过了50%的5种傅立叶描述方法:MCLFD、CD、TAF、FPD、CC以及WaveletFourierDescriptor(WFD).在图6中给出了这6种方法在MPEG-7测试集和植物叶片形状库中的查准率/查全率曲线(图(a)为MPEG-7库,图(b)为植物叶片库).从该图可以查到当查全率为10%~100%所对应的查准率.图7则给出了MCLFD和平均检索率在傅立叶Page8描述方法中仅次于MCLFD的CD傅立叶描述子、在MPEG-7测试集和植物叶片库中检索结果的例子.该图的每个表格的左上角是待检索的形状,从左到右、从上到下形状差异度值递增.对于MPEG-7列出了排名前20的结果,对于植物叶片库列出了排名前12的结果.从图6看出,MCLFD在相同的查全率的情况下,所得到的查准率要远高于其它的傅立叶描述子.从表1可以看出,MCLFD比性能排第二的CD傅立叶描述子的平均检索率在MPEG-7测试集中高出了近10个百分点,在植物叶片库中则高出了近12个百分点,从该表也可以看出,MCLFD在MPEG-7测试集中的平均检索率要高于其它几种非傅立叶描述方法.通过图7给出的检索实例可以看出,MCLFD检索正确的形状的个数要明显多于CD傅立叶描述子.所有这些实验结果都表明了图8不同强度的噪声干扰和不同K值的查准率/查全率曲线表2MCLFD在不同的特征数、不同的参数犓、使用的特征数8×266.47250.922073.358×472.67471.162575.198×876.22875.993075.958×1676.781676.953576.428×3276.953277.074076.62为测试选用不同数目的傅立叶特征对检索性能的影响,当K取16,即有8个级别的弦长函数,让每个弦长函数产生的傅立叶特征向量长度取值分别为2、4、8、16、32,即MLCFD的总的特征向量的长度分别为16、32、64、128、256.表2给出了它们的平均检索率.从实验结果可以看出,特征数目增加时,检索性能得到了提高,但当总的特征向量的长度从128变为256时,平均检索率提高并不显著.值得指出的是,当MCLFD的总的特征向量的长度为32时,即MCLFD具有优良的检索性能.5.6参数犓、选用的特征数和噪声对检索性能影响的实验分析这里用MPEG-7形状库测试MLCFD在各种因素影响下的检索性能.参数K是MCLFD的唯一参数,这里通过实验来分析其对检索性能的影响.让参数K分别取2、4、8、16、32.表2给出了不同K值下的平均检索率,图8的图(b)则给出了不同K值下的查准率/查全率曲线.从实验结果可以看出,当K由2增大到4时,平均检索率提高了20余个百分点.而K从4增到32的过程中,平均检索率的增幅在逐渐降低.当K从16增到32时,两者的查准率/查全率曲线已经非常靠近,平均检索率只提高了0.12个百分点,但计算的时间却增加了1倍.所以,从检索的精度和检索的效率综合考虑,参数K设为16比较合适.和其它方法所用的特征向量的长度相同的情况下,平均检索率仍然高出5个百分点.为测试MCLFD对噪声的鲁棒性,对MPEG-7数据库中的每个形状追加信噪比分别为20、25、30、35、40的随机高斯噪声.图9给出了对原来形状加上不同信噪比的随机高斯噪声的一个例子.这样就得到了5个加了不同强度的噪声的新的形状数据库.用MCLFD分别在这5个新数据库中进行检索实验.表2列出了各自的平均检索率,图8中的左图则给出了各自的查准率/查全率曲线.从实验结果可以看出,虽然不同强度的噪声使得MCLFD的平均检索率有所下降,但下降的幅度非常小,在信噪比为20的强噪声下的平均检索率也只下降了3.6个百分点,而一般情况下也只在一个百分点左右.从图8的左图可以看出,5条查准率/查全率曲线相互非常靠近,该实验结果说明了MCLFD对噪声的鲁棒性.Page9图9对原来形状追加不同信噪比的随机高斯噪声的一个例子6结论本文提出了一种基于多级弦长函数的新的傅立叶描述子MCLFD,它产生于对形状轮廓线的等弧长分割.这种傅立叶描述子不仅计算非常简单,而且对形状的整体特征和细节信息都能进行很好的描述.用MPEG-7的形状测试集对MCLFD进行检索性能测试,并将其实际应用于植物叶形的检索和识别都取得了比其它已有的傅立叶描述子更优的检索性能,其中在MPEG-7测试集中的平均检索率比现有的性能最好的傅立叶描述子提高了近10个百分点,在实际应用植物叶形检索实验中,则提高了近12个百分点.通过大量的噪声实验也证明了MCLFD的鲁棒性.
