Page1面向脑网络的新型图核及其在MCI分类上的应用1)(安徽师范大学计算机科学与技术系安徽芜湖241003)2)(南京航空航天大学计算机科学与技术系南京210016)3)(安徽师范大学网络与信息安全工程技术研究中心安徽芜湖241003)摘要作为一种图的相似性度量,图核已经被提出用于计算脑网络的相似性,并用于分类一些脑疾病,如阿尔茨海默病(Alzheimer’sDisease,AD)以及它的早期阶段,即轻度认知功能障碍(MildCognitiveImpairment,MCI).然而,已有图核主要面向一般图而构建,从而忽略了脑网络自身特有的特性,如节点的唯一性(即每个节点对应着唯一的脑区),这可能影响到脑网络分析(分类)性能.为了解决这个问题,构建一种面向脑网络的图核,用于测量一对脑网络的相似性.具体而言就是:首先,以网络中每一个节点为中心,构建一组子网络来反映网络的局部多层次拓扑特性.而后,利用节点的唯一性,构建测量每对子网组之间相似性函数,从而获得用于测量一对脑网络的相似性的图核.不同于已有的图核,提出的图核充分考虑到脑网络自身特有的特性,以及保留了脑网络局部连接特性.在两个真实的MCI数据集上,实验结果表明,相对于现阶段的图核,文中提出的图核能够显著提高分类的性能.关键词阿尔茨海默病;轻度认知功能障碍;脑网络分析;图核;分类1引言人类大脑具有极其复杂的功能和结构,理解它的工作机制,是21世纪人类面临最伟大的挑战之一.脑科学已成为当今国际科学研究的一个热点.2013美国投入38亿美元启动大脑研究计划(BRAINInitiative),欧盟和日本随后分别启动欧洲脑计划(TheHumanBrainProject)和日本脑计划(Brain/MindsProject).人们相信脑科学研究成果一方面能够帮助人类更好地认知、保护和开发大脑,另一方面也有助于对阿尔茨海默病(Alzheimer’sDisease,AD)、帕金森氏症(Parkinson’sDisease,PD)等脑疾病的认知和理解,并最终开发出对其早期诊断和治疗新疗法.大量的研究证据表明人的认知过程要依赖于神经元间的交互[1].最近的一些年,新出现的医学图像成像技术,如磁共振成像(MagneticResonanceImaging,MRI)技术、脑电图(Electroencephalograph,EEG)、脑磁图(Magnetoencephalograph,MEG)以及正电子放射技术(PositronEmissionTechnology,PET)等,提供了更加安全和有效方式来探索大脑及其交互模式[2-4],揭示了以前无法揭示的脑工作机制和特征.脑网络模型是对大脑系统的简单刻画.在脑网络中,通常将神经元或感兴趣区域(Region-Of-Interest,ROI)定义为节点,而它们之间连接模式定义为边.根据边的连接模式,脑网络通常分为以下两种[5-6]:(1)结构性脑网络,指不同神经元间医学结构上的连接模式[7-9],其边对应着(神经元的)轴突或纤维;(2)功能性脑网络,指脑区间功能性关联模式,通过测量神经电生理活动时序信号而构建相应的网络[5,10].如果构建网络的边是有向的,则称为因果连接网.由于可以在整体连接层次上刻画大脑结构或功能的交互[5,11-12],脑网络分析为探索大脑提供了一个新的工具.脑网络应用研究一方面包括探索大脑区域间功能连接和结构性连接之间的关系[13-14],另一方面包括分析一些脑疾病所呈现的非正常连接,从而辅助寻找对脑疾病比较敏感的生物标记物[5,15-19].大量的研究表明许多脑疾病表现出一些异常的连接.理论上,这些疾病通常与脑区间异常中断或整合相关[3,10-11,20].例如:研究人员发现AD病人的脑网络的小世界特性已发生改变,这暗示网络系统的完整性被破坏[21-22].研究人员也发现AD病人以及其早期阶段即轻度认知功能障碍(MildCognitiveImpairment,MCI)病人的海马(Hippocampus)与其他区域功能性连接已发生改变.另外,额叶和其他区域连接改变的证据也已经被发现[23-24].脑网络分析提供了一种新的途径来探索脑区间的异常整合和脑疾病之间的潜在关联[5,18-19,25].随着具有生物学意义的网络测量可靠性的增加,从神经影像中学习脑的连接特性对寻找与疾病相关的生物标志物展现了潜在的应用前景[5,18-19].脑网络分析已成为神经影像学和医学图像分析中一个新的研究热点.在脑网络分析中,图理论提供了一种非常自然的方式来分析大脑的各种连接特性[9].相比较其他方法,图理论的一个重要优势是它提供了一种统一的框架来比较各种不同类型的图数据,包括医学的和功能的数据,同类样本和不同类样本数据.然而,不同于传统特征空间中的数据,图(也就是网络)是一种结构化数据,无法直接计算两个图之间的距离(也就是相似性).因此,对于图数据一个基础性挑战是如何测量一对图之间的相似性.受此挑战的激励,在过去十年里,计算图相似性已经吸引了大量研究人员的注意.在各种方法中,核方法提供了一种通用框架来研究这一问题.在文献中,图核[26-27]已经被提出并应用到很多问题当中,如图像分类[28]、蛋白质功能预测[29]以及神经影像研究[30-31].最近,图核也被应用到脑网络分析中,取得了很好的效果.例如,一些研究人员已经将图核应用到AD和MCI分类[30,32-33];而另外一些研究人员也将图核应用到脑解码的研究[34-35].然而,目前绝大部分图核主要针对一般图而构建,从而忽略了脑网络自身特有的特性,如节点的唯一性,即每个节点唯一地对应着一个神经元或脑区,Page3从而不同脑网络中节点也是一一对应.这可能会造成信息的丢失,从而影响到脑网络分析的性能.为了解决这一问题,受最近工作的启发[36],本文提出了一种面向脑网络的图核,用于脑网络的分析(分类).相比较已有的图核,本文提出的图核不仅考虑到网络节点的内在特性,而且捕获网络的局部拓扑结构特性.提出图核的基本思想是:首先,以脑网络中每一个节点为中心,构建一组子网络来反映网络的局部多层次拓扑特性.而后,利用节点的唯一性和不同网络之间节点的一一对应性,构建测量每对子网组之间相似性函数,最终获得用于测量一对连接网络的相似性的图核.为了评价提出的图核,在两个真实的MCI数据集上实验验证了提出图核的有效性,结果表明相比较现阶段的图核,提出的图核能够有效地刻画脑网络的相似性,从而提高脑网络的分类性能.本文第2节介绍相关工作;第3节给出提出图核的构建方法;第4节给出实验设置;第5节给出在两个MCI数据集上获得的结果;第6节总结全文.2相关工作对脑网络的比较,一种简单的方法是直接从脑网络中提取一些局部特征构成向量,用于脑网络的分析.例如:Chen等人[37]直接利用边权重作为特征用于AD的分类,Wee等人[19]提取权重聚类系数作为特征用于MCI的分类,Zanin等人[38]通过探索16种网络特征(以及它们的组合)的分类能力来寻找网络的最优表示.然而,这类方法的缺点是只考虑到网络的局部连接特征,从而忽略了网络的整体上的拓扑结构特征.另一方面,基于核的方法对脑网络的相似性计算提供了一个新的途径.通俗的讲,核(Kernel)就是测量一对数据点相似性的函数.从数学角度而言,它对应着再生核希尔伯特空间(ReproducingKernelHilbertSpace)的内积.一旦定义了核,许多学习算法,例如支持向量机(SupportVectorMachine,SVM),就可以直接被使用.图核是定义在图上的核,其被称为R-卷积核家族的实例[39].大部分图核通过比较小的子图(如路、路径和graphlet)来定义.例如,Gartner等人[40]通过统计两个图中公共道路构建一种随机游走核.Borgwardt和Kriegel[41]通过比较两个图中所有成对节点之间的最短路径而构建了最短路径核.由于搜索和比较两个图子结构一般非常费时,一些研究人员通过使用一些计算技巧来降低构建图核的计算复杂度[42-43].最近,Johansson等人[44]使用几何嵌入构建了一种全局性图核.Shrivastava和Li[36]在利用ego网络分析社交网络时提出了一种图的新的表示方式,并基于这种表示构建一种有效的图核.目前,已有的图核能被大致分为两个种类:(1)定义在无标记图上的图核[36,41,44].即不考虑图中每个节点是否具有标签,节点除了连接不同外,没有什么其他不同;(2)定义在标记图上的图核[27,40,42-43].即图中每个节点都被分配一个标签.需要注意的是:一些图核(如Weisfeiler-Lehman子树核[27,43])既可以定义在有标记图上,也可以定义在无标记图上.在第1类图核中,图核被定义在无标记图上,忽略了每个节点的标签信息,因此经常不能有效地计算一对标记图之间的相似性.图1给出了一个例子.在图1中,网络G和H分别表示一个正常人和病人的连接网络,其中病人网络由于受疾病影响发出了改变.注意到这两个网络在结构上是同构的,但它们是不同的网络.显然,考虑和不考虑节点标签信息得到的图核应该是不同的.因此,使用定义在无标记图上的图核不能用于测量这两个标记图之间的相似性.图1包含6个节点的脑网络示例(其中网络G为正常人对于第2类图核,即定义在标记图上的图核,一些图核[40]由于它们的计算复杂度不适合用于计算脑网络的相似性.而一些图核,如Vishwanathan等人[26]定义的图核主要针对图中边有标签的情况,Feragen等人[42]定义的图核主要针对节点标签是连续值的情况,亦不适合计算脑网络的相似性.其他图核,如文献[27,43]定义的Weisfeiler-Lehman子树核是基于Weisfeiler-Lehman图同构测试而构建的.然而,注意到,如果考虑节点的唯一性信息,两个脑网络则不存在同构问题(见图1).因此,Weisfeiler-Lehman子树核也不适合用于计算脑网络的相似性.据我们所知,目前还没有提出专门针对脑网络这种特定图而构建的图核.基于此,本文提出了面向脑网络的新型图核,用于测量脑网络的相似性.Page43提出的图核在这一节中,首先简要介绍Shrivastava和Li[36]在ego网络上构建的图核,受他们工作的启发,本文提出了面向脑网络的图核构建方法.给定一个图G(用邻接矩阵犃∈Rm×m来表示)和一个数l,其中m是G中节点的个数.为了有效地表示一个图,Shrivastava和Li[36]定义了一个对称半正定矩阵犆G∈Rl×l,其中元素为其中,cov表示两个向量之间的协方差,犲表示全为1的向量,犃i犲表示在给定向量犲上矩阵犃的第i次幂迭代,l表示幂迭代的次数.Shrivastava和Li[36]已经表明矩阵犆G能够捕获图的基础性关键信息(如图的谱以及小的子结构个数统计),同时拥有很多好的特性(如图不变性,即同构的图具有相同的表示).根据此定义,各种图能被表示在一个公共的数据空间,从而进行相似性比较.因此,基于这种图的数学表示,Shrivastava和Li[36]定义了一种核来测量一对图之间的相似性.给定图G和H,其图核定义如下:k(G,H)=exp-其中,|·|表示矩阵的行列式,并且Σ=(犆G+犆H)/2,犆G和犆H分别根据式(1)定义对称正定矩阵.然而,这种图核是定义在无标记图上,因此只考虑了图的拓扑结构信息,而忽略了脑网络节点的标签信息(也就是每个节点都唯一的对应着一个脑区),从而不能有效地计算一对脑网络间相似性.另外,Shrivastava和Li[36]利用ego网络根据其定义的图核对社交网络分析时,只考虑到与某节点直接相连的节点所构成网络,忽略掉节点间的间接关联,而这种节点间间接关联对社交网络的影响力分析以及节点的相似性度量有着重要作用[45-46].在脑网络分析中,一系列的研究也表明一些脑疾病通常和一些大规模的子网相关,而不仅仅是单个脑区[10,15,17,22].为了解决这些问题,本文提出了一种面向脑网络的新型图核.其基本思路是:首先以脑网络中每一个节点为中心,构建一组子网络来反映网络局部的多层次拓扑结构,而后利用节点的唯一性和不同网络之间节点的一一对应性,构建测量每对子网组之间相似性函数,最终给出用于比较一对脑网络相似性的函数.具体过程如下:让数h.首先,对于连接网络造一组子网络,即其中,Gj络,节点集Vjj的所有节点所构成,边集Ej边所构成.因此,对含有N个节点的连接网络以构造N组子网集,即对连接网络子网集,即i,Ej(Vj同连接网络中节点是一一对应性,可以定义如下函数测量连接网络其中:f(hi,这里,|·|表示矩阵行列式,Σji是根据式(1)分别定义在子网Gj和犆H对称半正定矩阵.算法1总结了提出图核的详细构建过程.算法1.构建面向脑网络的图核k(输入:一对脑网络输出:图核k(1.以网络中每个节点中心,对G和H分别构建N个其中2.根据式(5),计算每对子网组的相似性函数3.根据式(4),计算图核k(定理1.式(4)和式(5)中定义的核是半正定并且是有效核.证明.根据文献[36],式(2)中定义的函数是半正定且是有效核.因此,根据权重核相加原理[47],式(4)和式(5)中定义的核也是半正定的且是有效核.因此,本节构建的核是一种有效核,能被直接应用到基于核的方法中,如支持向量机(SupportVectorMachine,SVM).在下一节,将在两个真实的MCI数据上验证提出图核的性能.Page5il+tj计算复杂度:构造子网的复杂度是Ο(N2),根据文献[36],在每对子网上计算相似性的复杂度是O(sj边数与节点数.注意,sj示连接网络的边数与节点数.因此,计算一对连接网络之间相似度总的时间复杂度要少于Ο(Nh(Sl+Nl2+l3)+N2).最后,总的时间复杂度是少于Ο(N(S+N)+N2),因为lN和hN.需要特别强调的是:(1)对于网络中每一个节点,都以它为中心构造了一组子网,这组子网反映了脑网络的局部多层次拓扑结构特性,并且h决定每组子网的规模.这里,多层次意味着j的值越大,子网中所包含节点与边就可能越多,并且满足Gj如果j<s;(2)式(5)定义了一对子网组之间的相似性,式(4)定义了来自于两个不同脑网络的(所有的)同一节点一对子网组之间的相似性.因此,提出图核考虑了节点唯一性和样本间节点之间一一对应性,并嵌入了网络局部多层次拓扑特性;(3)在子网络相似性时不考虑节点的标签信息,只考虑其拓扑结构信息;(4)参数l定义了图的数学表示时幂迭代的次数,而h控制每组子网的规模,它们的值可以在训练样本上通过交叉验证的方式来获得.另外,提出的图核与Shrivastava和Li[36]提出的图核不同的是:提出的图核以每个节点为中心构建一组子网反映脑连接局部多层次拓扑结构特性,并根据每个节点唯一性和不同样本间节点一一对应性,构建图核来测量脑网络之间的相似性,而Shrivastava和Li[36]的图核只是针对无标记图且仅捕获图的全局拓扑结构信息.4实验环境4.1数据集为了评价提出的图核,在两个真实的MCI数据集验证提出方法的有效性,下面分别介绍这两个数据集.(1)Duke脑网络数据集.该数据集来自于Duke大学医学中心,其中包含了12个MCI病人和25个正常对照组(NormalControl,NC).表1给出了该数据集中所有参与者的统计信息.采用GE磁共振成像系统———SignalExcite3.0T扫描仪获取数据.具体的参数设置如下:翻转角度=77°,TR/TE=2000/32ms,成像矩阵=64×64,FOV=256×256mm2,34slices,体素厚度=4mm.对每个样本采集了150个卷(也就是时间点).扫描期间,要求所有参与者睁开眼睛,持续盯着屏幕中间的固定位置5min.表1Duke脑网络数据集中所有参与者的统计特性MCI6/6NC9/16注:MMSE=Mini-MentalStateExamination.(2)ADNI脑网络数据集:ADNI由国际老年研究所(NationalInstituteonAging,NIA),生物医学成像和生物工程研究所(NationalInstituteofBiomedicalImagingandBioengineering,NIBIB),美国食品和药物管理局(FoodandDrugAdministration,FDA),民营医药企业和非营利组织在2003年启动,资金为60万元美元.ADNI的主要目标是测试是否能通过组合MRI,PET,其他生物标志物,以及临床和神经心理学评估来测定MCI和早期AD的进展(progression).越早确定对AD早期敏感生物标记能帮助研究人员和医生部署新的治疗和监测它们的有效性,以及降低临床试验的时间和成本.本文从ADNI数据库①下载了149个静息态功能性MRI(funtionalMRI,fMRI)样本图像,其中包含了99个MCI病人(包括56个早期MCI(earlyMCI,EMCI)和43个后期MCI(lateMCI,LMCI))和50个正常对照组.表2给出了该数据集中所有参与者统计特性.所有下载的样本利用Philips3.0T扫描仪从多个站点(site)获取.图像在X,Y坐标分辨率位于[2.92mm,3.31mm]区间,切片(slice)厚度是3.31mm,TE=30ms,TR位于[2.2s,3.1s]区间.对每个样本,采集了140个卷.表2ADNI脑网络数据集中所有参与者的统计特性MCINC注:MMSE=Mini-MentalStateExamination.其中有16个病人和6个正常人MMSE未知.4.2图像的预处理和脑网络的构建两个数据集采用基本相同的图像预处理步骤.图像的预处理包括时间片矫正和头动矫正.利用统计参数映射软件包(StatisticalParametricMappingsoftwarepackage,SPM8)②来完成图像预处理.具①②Page6体而言,对每个参与者,丢弃前10幅fMRI图像,对保留的图像再进行切片间采集时间延迟上的矫正,而后进行头部运动矫正,消除头部运动的影响.考虑到脑室区域和白质(WhiteMatter,WM)区域包含较多的噪声[48],仅利用灰质(GrayMatter,GM)提取血氧水平依赖(TheBloodOxygenationLevelDependent,BOLD)信号,并构建功能连接网络,即首先把每个样本的T1加权图像分割为GM、WM和脑脊液(CerebrospinalFluid,CSF).为了消除WM和CSF可能的影响,每个样本的GM组织被进一步用于罩化它们对应的fMRI图像.fMRI时间序列的第一次扫描被配准到同一样本的T1加权图像,所估计的变换被应用到相同样本其他时间序列.矫正后的fMRI图像首先利用HAMMER的变形配准方法[49]将其配准到同一模板空间,并利用自动化解剖学标签(AutomatedAnatomicalLabeling,AAL)模板[50]将大脑划分为90个感兴趣的区域(Region-Of-Interest,ROI).最终,对每个ROI,所有体素上平均fMRI时间序列被作为该ROI的时间序列.每个平均时间序列在频率区间[0.025f0.100Hz]进行带通滤波.对每个样本,构建一个功能连接网络,其中节点对应ROI,而节点上时间序列的Pearson相关系数作为边的权重.最后,对连接网络(矩阵)的元素执行Fisher的z变换,以改善相关系数的正态性,即其中r是Pearson相关系数,z是近似正态分布,其标准差为σz=1/n槡-1,n是ROI的个数.进一步,为提取有意义的网络测量,所有负相关都被置为0.4.3分类框架在利用构建的图核进行分类之前,由于构建的功能性脑网络本质上是带有权重的完全图,为了反映出其拓扑结构,需要对其进行阈值化处理.然而,到目前为止,对阈值的选择没有一个好的标准,并且不同阈值将会产生具有不同拓扑结构的网络,它们可能包含互补信息从而改进分类的性能.因此,本文采用多个不同阈值的方法,同时对脑网络进行阈值化处理,从而反映出多层次的网络拓扑结构.这里,多层次表示大阈值将保留少的连接,从而网络更加稀疏.即给定连接网络(矩阵)和阈值Tm(m=1,…,M),使用下面公式阈值化脑网络:其中N和M分别表示ROI和阈值的个数.因此对每个连接网络可以获得M个阈值化的连接网络m=[犃m(i,j)],用于随后图核的构建.最终,在分类步骤中,C-SVM分类器被用于执行分类.由于采用多个阈值,从而产生多个阈值化的脑网络,本文将采用多核SVM技术[51]来组合从多个阈值化脑网络网中所构建的图核.给定一组训练样本{i,yi}i=1,…,n,其中(也就是病人或正常人),N是样本的个数.通常,通过多个基核的线性组合来学习一个组合核,即其中,km(化脑网络上的图核,后的脑网络,M是阈值的个数,μm是一个非负权重向量,并且满足约束∑用联合学习参数μm和SVM的其他参数[52-53].与这些方法不同的是,本文采用网格搜索(gridsearch)的方法来确定最优μm.一旦确定μm,多个核将能被组合为一个核,则标准SVM将能被用于MCI病人和正常人的分类.图2总结了整个分类框架的详细过程.Page74.4具体设置在实验中,采用留一法(Leave-One-Out,LOO)交叉验证策略评价分类器的性能.具体而言,从所有样本中选取一个样本作为测试样本,其余用作训练样本.这个过程对每个样本重复一次,因此对分类精度会产生一个无偏估计.实验中SVM被用来执行分类,并采用默认参数值(即C=1).对每个数据集,分别选择5个不同的值(即T=[0.20,0.30,0.38,0.40,0.45]和T=[0.30,0.35,0.40,0.45,0.50])来阈值化连接网络,这5个值使得阈值化后脑网络的平均连接密度定位在[30%,75%]区间.文献[38]已报道了当连接密度位于[25%,75%]时通常能够获得较好的分类性能.对于提出模型中参数则通过在训练样本上执行另外一个交叉验证的方式来确定.5实验结果5.1分类性能为了评估提出的方法,首先在杜克大学的脑网络数据集(Duke脑网络数据集)上构造了一个二类分类器,即MCIvs.NC分类.而后,在ADNI脑网络数据集上分别构造了两个二类分类器,即MCIvs.NC分类和EMCIvs.LMCI分类.实验通过计算分类精度、敏感度(病人被正确分类的比例)、特异性(正常人被正确分类的比例)和ROC曲线下的面积(TheAreaUnderReceiverOperatingCharacteristic(ROC)curve,AUC)的值来评价不同方法的性能表现.为了评价提出方法,本文比较了现阶段的一些图核,包括Shervashidze等人[27,43]提出的Weisfeiler-Lehman子树核、Weisfeiler-Lehman最短路径核和Weisfeiler-Lehman边核(分别表示WL-subtree,WL-shortestpath和WL-edge),Shrivastava等人[36]基于ego网络构建的图核(表示为Ego-net),Borgwardt和Kriegel[41]构建的最短路径核(表示为Shortest-path).所有比较的图核都是基于无标记图而构建的,也就是没有考虑连接网络节点的标签(即唯一性)信息.另外,为了比较,本文也从脑网络中直接提取节点的聚类系数[9]特征作为Baseline方法用于分类,其中t-test方法用于特征选择,而线性SVM被用于执行分类.表3和表4分别给出了在两个数据集上所有方法的分类结果.图3和图4分别画出了这些方法在两个数据集上的ROC曲线.为了比较,表5和表6分别给出了在两个数据集上仅使用单个阈值化脑网络时所有方法的分类精度.表3在Duke脑网络数据集上不同方法的分类性能方法BaselineEgo-netShortest-pathWL-edgeWL-subtreeWL-ShortestpathProposed图3在Duke脑网络数据上不同方法的ROC曲线从表3、表4和图3、图4可以看出,在两个数据集上,提出图核的分类精度和AUC值上都要好于比较的图核.具体而言,在Duke脑网络数据集上,提出方法获得了83.8%的分类精度和0.90的AUC值,而比较方法最好分类精度是81.1%,最好AUC值是0.87;在ADNI脑网络数据集上,提出的方法在MCIvs.NC和EMCIvs.LMCI两个分类任务中,分别得到82.6%和67.7%的分类精度,而比较方法的最好结果分别是76.5%和63.6%.此外,在两个分类任务上,提出方法取得AUC值分别是0.80和0.70,而比较方法的最好结果分别是0.72和0.62.这些结果表明提出图核能够捕获脑网络数据内在结构特性,从而更好地用于脑网络的相似性计算及分类.另一方面,从表5和表6可以看出,在单个阈值化连接网络上,提出方法整体上要好于比较的方法,这也再一次表明了提出方法的有效性.进一步,从表5和表6也可以看出,相对于仅使用单一阈值化连接网络,组合多个阈值化连接网络能够获得更好的分类效果,这也表明阈值化网络含有互补信息从而进一步提高分类性能.Page8表4在ADNI脑网络数据集上不同方法分类性能Shortest-pathWL-subtreeWL-Shortestpath图4在ADNI脑网络数据集上不同方法的ROC曲线表5在Duke脑网络数据集上仅单阈值脑网络时方法Ego-netShortest-path67.667.667.667.667.667.6WL-edgeWL-subtree73.073.070.373.075.781.1WL-Shortestpath62.262.254.156.862.270.3Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.表6(a)在ADNI脑网络数据集上仅单阈值脑网络时KernelsEgo-netShortest-path51.759.768.561.164.469.8WL-edgeWL-subtree67.865.869.170.569.176.5WL-Shortestpath53.761.167.163.168.573.2Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.表6(b)在ADNI脑网络数据集上仅单阈值脑网络时KernelsEgo-netShortest-path50.549.545.544.446.555.6WL-edgeWL-subtree55.659.649.552.548.563.6WL-Shortestpath55.661.660.656.651.563.6Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.0.510.600.600.720.720.700.805.2提出图核的判别能力为进一步评价提出图核的判别能力,对每个数据集,根据样本的标签,在每个阈值化的连接网络上构建了两组图核,即构建在同类样本间(即NC之间和MCI之间)的图核和构建在不同类样本间(即MCI和NC之间)的图核,而后利用标准t-test,在两组图核上执行显著性测试.为了更好地比较,同时计算这两组图核的平均值.图5分别给出了两个数据集上仅使用单个阈值化网络上得到两组图核的平均值和相应的p值.从图5可以看出,除了在ANDI数据集的第5个阈值化的脑网上获得p值稍大于0.05(p=0.0509),其他阈值化的脑网络上获得的p值都非常小,这表明同类样本间的图核值要显著大于不同类样本间的图核值.这些结果表明提出图核能很好刻画同类样本间的相似性,不同类样本间的差异性,从而用于脑网络的相似性计算.5.3判别性区域在本小节中,利用提出的图核,在ADNI数据集上评价每个ROI的判别能力.具体而言,在每一个阈值化的连接网络,对每个节点(即ROI),根据算法1中的方法构建一组子网,并根据式(5)构建该组子网上的图核.而后,利用LOO交叉验证策略,采用SVM分类器执行MCI和NC分类,并计算分类精度.对每个ROI重复同样操作,按照每个ROI的Page9图5提出图核在两个脑网络数据集上获得的两组图核的平均值及相应的p值上分类精度进行排序,并选择分类精度最高的前10个ROI.表7给出了从每个阈值化连接网络中选择出的ROI.图6在大脑模板空间画出了选择的所有ROI.从表7中可以看出,绝大多数选择的脑区和以前使用组匹配方法的研究成果是一致的,这些区域包表7从每个阈值化连接网络中选择分类精度最高的10个ROIT2L.inferiorfrontalgyrus(triangular)T4L.superiorfrontalgyrus(media)R.superiorfrontalgyrus(dorsal)R.middlefrontalgyrusR.orbitofrontalcortex(middle)L.inferiorfrontalgyrus(triangular)L.suplementarymotorareaR.superiorfrontalgyrus(media)L.orbitofrontalcortex(medial)L.superiorparietalgyrusR.middletemporalgyrusL.inferiortemporalR.middlefrontalgyrusR.orbitofrontalcortex(middle)L.olfactoryL.insulaL.middlecingulategyrusR.middlecingulategyrusR.posteriorcingulategyrusL.hippocampusL.thalamusL.inferiortemporalR.middlefrontalgyrusL.orbitofrontalcortex(inferior)L.olfactoryR.rectusgyrusL.middlecingulategyrusR.middlecingulategyrusL.posteriorcingulategyrusL.hippocampusR.heschlgyrusL.temporalpole(middle)括海马(hippocampus)[54-55]、扣(cingulate)[54,56-57]、海马旁回(parahippocampalgyrus)[58]、杏仁核(amygdala)[56]、颞横回(heschlgyrus)[59]、颞中回(temporalgyrus)[60-61]和颞极(temporalpole)[62]等.例如海马、杏仁核和颞极已经被广泛认为与AD相关.Page10图6从所有阈值化脑网络中选择出的脑区另一方面,基于每个ROI上构建的图核,实验中也选择一些被认为可能与疾病相关的ROI执行显著性测试.这些ROI包括(左/右)海马、(左/右)杏仁体、(左/右)下颞(inferiortemporal).表8给出表8基于提出图核来评估一些重要ROI的判别能力阈值T1T2T3T4T55.4参数的影响在提出的图核中,包含两个参数,即l与h.l控制着计算图数学表示时算法迭代的次数.h控制每组子网的规模.为了评价l与h对于最终分类结果的影响,在两个数据集上分别测试使用不同l值(l={3,4,5,6,7,8})以及不同h值(h={1,2,3})时提出图核的分类能力.图7和图8分别图形化显示在两个数据集上获得的分类结果.图中每条曲线表示固定h值时,提出图核随l变化所获得的分类精度,不同曲线表示选择不同h值.从图7、图8和表3、表4中可以看出,随着l与h取不同值,在大部分情况下提出方法分类效果都要好于比较方法,这进一步表明提出图核的有效性.同时,从图7和图8中可以看出,当固定h值时,曲线随l值变化比较平滑,这表明提出方法对于参数l了测试结果.结果显示,这些ROI对区分病人与正常人有着很强的判别力(也就是对应着非常小的p值).这也进一步验证提出图核的有效性.图7在Duke脑网络数据集上,参数l和h取的变化非常鲁棒.当固定l值时,分类精度受h值影响很大.这表明h值选择对于提出的图核是非常重要的.这也进一步表明由于h控制着每组子网的规模,因此网络的局部拓扑特性对测量网络相似性有Page11图8在ADNI脑网络数据集上,参数l和h取不同值下提出方法的分类精度着重要的影响.5.5阈值的影响在给出的分类框架中,采用了(多个)绝对阈值的方法对构建的脑网络进行阈值化处理,即所有样本的网络在同一个阈值下比较.为了分析不同阈值化方法对提出图核的分类影响,在Duke和ADNI两个数据集上采用保留相同连接密度的方法(即每个样本的网络保留相同的边的个数)对构建的脑网络进行阈值化处理.在实验中,分别选择了5种连接密度(即[75%,60%,50%,40%,25%])代替表10在ADNI脑网络数据集采用(多个)相同连接密度的阈值化方法的分类性能Shortest-pathWL-subtreeWL-Shortestpath表11在Duke脑网络数据集上采用(单一)相同连接方法Ego-netShortest-path64.8664.8659.4664.8664.8667.6WL-edgeWL-subtree70.2764.8659.4670.2767.5775.7WL-Shortestpath59.4662.1659.4672.9767.5773.0Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.表12(a)在ADNI脑网络数据集上采用(单一)相同连接密度的阈值化方法的分类精度(MCIvs.NC)(单位:%)KernelsEgo-netShortest-path65.866.465.164.465.166.4WL-edgeWL-subtree63.865.864.464.465.867.1WL-Shortestpath65.155.757.063.864.467.1Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.原来的5个绝对阈值.表9和表10分别给了在两个数据集上不同方法的分类性能,表11和表12表9在Duke脑网络数据集上采用(多个)相同方法BaselineEgo-netShortest-pathWL-edgeWL-subtreeWL-ShortestpathProposed0.510.700.560.570.630.620.78表12(b)在ADNI脑网络数据集上采用(单一)相同连接密度的阈值化方法的分类精度(EMCIvs.LMC)(单位:%)KernelsEgo-netShortest-path47.545.546.546.545.546.5WL-edgeWL-subtree58.656.653.563.657.665.7WL-Shortestpath55.657.652.560.651.559.6Proposed注:T1,T2,T3,T4和T5表示仅使用单一阈值化连接网络,‘Combined’表示使用所有阈值化连接网络.相应的给出了每种连接密度下不同方法的实验结果.从表9~表12可以看出提出的图核的性能仍然好于比较的方法,这也进一步验证了提出图核的性能.6总结网络相似性计算是脑网络分析中是一个基础性Page12挑战问题.本文提出了一种面向脑网络的新的图核用来测量脑网络相似性.不同于已有的图核,提出的图核充分考虑了脑网络自身固有的特性,并且保留了网络局部拓扑结构特性.在两个真实的MCI数据集上,实验结果表明,相比较已有的图核,提出图核能有效地刻画脑网络数据的相似性,并改进脑网络分类的性能.进一步的工作将在更多的数据集上评价提出的方法.
