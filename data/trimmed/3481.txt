Page1入侵容忍实时数据库的半马尔可夫生存能力评价模型陈长清裴小兵周恒刘云生(华中科技大学软件学院武汉430074)摘要针对事务和数据的实时特性,给出了具有入侵容忍能力的实时数据库系统的体系架构.基于实时性的要求和入侵检测存在的延迟,提出了半马尔可夫评价模型,对实时数据库在入侵容忍条件下的生存能力进行评价,并根据此模型给出相关的量化准则,定义了完整性与可用性等生存性指标,对实时数据库的生存能力进行了验证.由于误报、检出率和攻击强度等因素会对生存能力造成重大影响,因此利用TPC-C基准测试对其进行了详细的数据分析.实验表明,该模型能较准确地预测实时数据库的行为,所提出的入侵容忍实时数据库在面临攻击时,其基本生存能力没有受到严重的影响.关键词入侵容忍;实时数据库;生存性;评价模型1引言数据库入侵容忍技术改变了传统的以防御、检测、响应和恢复为主的思想,它假定系统中存在一些恶意事务攻击,在系统可容忍的限度内,这些攻击不会对系统的服务造成灾难性影响,系统本身仍能保证最低质量的服务.为了评价一个数据库系统抵抗持续入侵的能力,需要建立定量评价模型,根据该模型还能比较不同的入侵容忍架构.文献[1]提出针对Page2传统数据库的入侵容忍生存评价模型,并假设入侵是由随机的攻击造成的,例如马尔可夫模型.在该模型中,事务状态间的转换概率服从负指数函数分布,事务交互的时间已经给出并且定义为常数.但在实际应用中,许多已经成功的真实入侵却是由人为因素造成的,故而建模时还需综合考虑这些因素.半马尔可夫模型对其进行了拓展,还允许非指数函数分布地存在,由于事务间的交互具有随机性,相比于马尔可夫链,半马尔可夫链模型中的非指数函数更适合模拟这些较实际问题,文献[2]提出了针对传统数据库的基于半马尔可夫的生存评价模型.相对于传统数据库,实时数据库系统的本质特征就是事务和数据有定时限制,系统的正确性不仅依赖于逻辑结果,而且还和逻辑结果所产生的时间有关.为此,结合实时性的要求,提出了入侵容忍实时数据库的半马尔可夫生存评价模型,使其能应用到实时数据库中.因为实时数据库具有时限要求,如果状态定义的粒度较粗,会达不到细粒度要求,也就不能充分评价实时系统的生存能力.本文所提半马尔可夫生存评价模型考虑了实时数据库系统中事务的软硬实时要求、事务T-SQL序列长短、事务与事务执行时间间隔分布不均等因素,是针对实时数据库生存评价的一种实用模型.本文第2节介绍本研究的相关工作;第3节给出改进的入侵容忍实时数据库体系结构;第4节提出相应的半马尔可夫生存评价模型,并予以分析和求解;第5节提出相应的生存性评价准则;第6节通过TPC-C[3]验证模型的有效性;第7节对误报、检出率和攻击强度这3个重要因素的影响进行详细数据分析;最后在第8节得出全文结论.2相关工作大多数关于生存能力的研究是从定性的角度来考虑的,较少有文献讨论定量的生存性评价指标.文献[4]给出了生存性的形式化定义,并和相关的概念,如可靠性、可用性和依赖性进行了比较.文献[5]从几个方面定义了生存性,说明了生存性和可靠性的差别在于:用户能接受可生存系统的降级服务,而可靠性假设系统要么能用要么不能用.但这些文献对生存性的量化和降级服务的程度都没有考虑.文献[6]讨论把现有的基于模型的可靠性评价技术扩展到评估系统的安全性,但困难在于错误的偶然特性和网络攻击的人为特征之间有本质差别.文献[7]把对入侵容忍系统的攻击与响应按随机处理建模,给出了系统的量化的安全属性,实验中模型参数使用了推测值,而缺乏对模型的验证.安全的量化验证常使用形式化方法[8].文献[9]通过随机模型进行概率验证,这是验证入侵容忍的一个有吸引力的手段,该文利用随机行为网络来定量验证一个入侵容忍的复制管理系统,在模型之上提出了几种度量手段,并研究了参数变化对生存性的影响.尽管文献中已提出几种生存性模型和相应的度量,但它们都局限于评估入侵容忍数据库系统的安全属性.文献[10]研究在可生存数据库系统中提供有一致性保证的服务.文献[11]提出针对工作流的在线攻击恢复系统,对恢复系统的行为分析是基于连续时间马尔可夫链模型,包括了稳态和状态转换行为.文献[12]根据入侵检测的缺陷,利用TPC-C定量评价了其对生存性的影响,但没有提到系统性的生存模型和度量标准,文献[2]提出了入侵容忍数据库系统的连续时间半马尔可夫链生存评价模型,基于状态转换是非指数分布的.文献[13]在传统数据库恶意事务修复方案的基础上,采用Petri网模型分析事务撤销冲突和操作执行序列异常检测,进而结合可生存性DBMS特征提出恶意事务静态和在线修复算法,给出随机Petri网恶意事务修复模型,在分析恶意事务修复随机Petri网模型和连续时间马尔可夫链的一致性后,给出了连续时间马尔可夫链的恶意事务修复模型求解.文献[14]在数据库系统内部设计和实现了一种受损数据隔离策略语言,提出了一种有效的受损隔离算法,该算法使用SQL语句动态替换技术尽量保证隔离阶段用户请求数据的完整性,通过子查询动态视图替换法保证数据隔离的有效性.文献[15]提出事务融合策略以缩短修复时间,文献[16]考虑了实时数据库事务的定时特性,将事务融合策略应用到实时数据库的修复中.文献[17]研究利用时间标记进行实时数据库的入侵检测.3入侵容忍实时数据库体系结构入侵容忍实时数据库系统(IntrusionTolerantReal-timeDatabase,ITRDB)要保证:在被入侵之后,系统能在时限内尽快自动定位、控制和修复被损坏的部分,使实时数据库系统在遭受入侵的情况下可以继续被使用.在文献[18]的基础上,我们对国产化实时数据库管理系统ARTs-EDB的入侵容忍体Page3系结构进行了改进,使其能适应半马尔可夫评价模型的要求,如图1所示,主要由策略执行、攻击检测、损害评价、损害修复、隔离等模块构成.ITRDB主要关注已提交的恶意事务,认为即使是未提交的活动,恶意事务也不会产生影响(因为事务的原子属性),一旦提交则会产生影响,而且在检测延迟期内,损害可能已经蔓延到许多其它的数据项中,即恶意事务扩散.为了克服这种局限性,ITRDB采用隔离技术与损害控制相结合的方法.ITRDB中各部件的功能介绍如下:攻击检测器(attackdetector)通过系统日志和审计文件检测恶意事务或可疑事务;损害评价器(damageassessor)通过系统日志和审计文件标识恶意事务所损害的数据;隔离管理器对恶意事务和可疑事务进行隔离;生存评价器(survivabilityestimator)对恶意事务发生后的影响进行完整性与可用性等指标的评价,通过扫描攻击历史(attackhistories),根据数学模型预测数据的生存性和脏数据集;损害修复器(damagerepairer)则用补偿机制来修复损害评价器和生存评价器所报告的受损数据.策略执行管理器(PolicyEnforcementManager,PEM)用于代理用户事务,执行系统级的入侵容忍策略,当事务被攻击检测器判定为可疑事务时,该事务被隔离管理器隔离,对应用户随后提交的事务也都被隔离;当事务被攻击检测器判定为恶意事务时,该用户及其行为被写入“历史记录”中,该用户提交新事务时会由PEM阻止.4入侵容忍实时数据库的生存评价模型为了更加全面地分析和评价ITRDB的生存能力,且能捕捉到系统所处的各种状态,建立了一个半马尔可夫定量评价模型.下面将首先建立半马尔可夫生存评价的简单模型,然后再考虑入侵检测的参数,拓展成一个综合的应用模型.4.1简单评价模型图2显示了一个ITRDB的基本状态转换模型.在该模型中,系统的运行状态主要是由事务特征属性所标识,例如:事务的大小、事务的数量、当前用户的数量和事务的截止时间.将这些数值型变量、标称变量的取值与标准的参数预设值进行比较,然后对不同数值集合进行划分,从而可定义为一定的系统状态,也称状态空间,如下所示.一切正常.防机制失败受到恶意事务感染.主要检疫活动,即判断可疑事务等.时限要求进行修复必要性判断.定义1.良好状态G:表示ITRDB系统状态定义2.感染状态I:表示ITRDB系统由于预定义3.检疫状态Q:表示ITRDB系统进行定义4.判定状态J:表示ITRDB系统根据定义5.修复状态R:表示ITRDB系统进行主要事务修复与恢复活动.定义6.补偿操作:表示ITRDB系统弥补操作,如事务处理回滚、事务检测点恢复、补偿事务执行等.传统上,计算机的安全首先依赖于系统的预防,在图1所示ITRDB系统的事务代理机制中,一般引进预处理过程.如果预防的策略失败,系统在攻击检测阶段将会从良好状态G转变为感染状态I.如果攻击被成功地检测到,入侵容忍系统采取攻击防护策略,从而进入检疫状态Q.在Q状态下,所有“可疑事务”都将会被加载进来,然后对所有的人为攻击的损害进行标记后,把未被损害或者误判的事务释放.传统数据库系统由于没有时限要求,可直接进入修复状态,完成修复后返回到良好状态G.但是,在实时数据库系统中,由于时限的要求,需要先进入判定状态J,根据日志与审计表,判定待修复的事物是否满足硬实时与软实时需求,若是,则进入到修复状Page4态R,进行定义6的补偿操作(修复或者恢复所有的损害),修复完成后返回良好状态G;若否,则将所处理的事务抛弃,返回到良好状态G.在已定义的状态下,为了保证入侵容忍数据库系统的设计及实施的基本要求,ITRDB活动一般分为5个阶段,依次为攻击渗透、错误检测、攻击检疫、损害评价和错误恢复,它们描述了每个入侵容忍数据库系统都将会遇到的基本问题.由于人为攻击的存在,从G状态转换到I状态的转变并不一定服从指数分布,所以该随机过程不是一个连续时间马尔可夫链.半马尔可夫模型相比于马尔可夫链,能更好地适应实际应用,在执行事务之间的逗留时间可以任意分配.考虑实时数据库中事务的截止时间、事务T-SQL序列长短、事务与事务执行时间间隔分布不均等因素,通过ITRDB在面临攻击时的状态转换,从状态空间定义和状态之间的复杂转换关系这两个方面来建模.设E={1,2,3,…,n}表示状态空间,Ω为概率空间.同时定义以下的随机变量:Xn:Ω→E和Tn:Ω→IN,其中Xn表示n个事务转换状态,Tn表示处理n个事务的时间(T0=0),tn表示处理相应的n个事务的时限要求,与事务被创建时所带有的时间戳相对应.设Vk=Tk+1—Tk,表示在第k次诊断状态时的逗留时间(k∈E).那么(X,T,t)过程则是一个半马尔可夫综合过程.半马尔可夫综合过程的核心K,其中K(t)=Kij(t)被定义如下:Kij(t)=P[Xn+1=j,Vkt|X0,…,Xn;T0,…,Tn]=P[Xn+1=j,Vkt|Xn=i].那么,当Pij=limt→Kij(t)时,犘=Pij为包含马设矢量狏=(v1,v2,…,vn)表示包含连续时间马尔可夫链的稳态概率.为了获得稳态概率,求解方程尔可夫链的状态转换概率矩阵.现在可以定义条件分布函数(CDF)在状态i逗留的时间函数:Hi(t)=P[Tn+1-Tnt|Xn=i].一般地,可以采用折扣指标或者平均指标对半马尔可夫进行决策分析,该模型中采用平均指标进行分析,设hi为状态i的平均逗留时间,即其中,max_t表示最大软硬时限数值,积分的时间超过此数值,则时间统计失效.设向量犺=(h1,h2,…,hn),且假定所有i∈E,hi<.半马尔可夫链的稳态概率定义如下:考虑图2中的基本模型,事务处理状态间的转换可能遵从非指数函数分布,例如韦伯尔分布、正态分布与指数分布等,该函数理论上完全可以模拟黑客的行为以及状态G和I之间的转变.韦伯尔分布由此公式给出:F(t)=1-e-(t/β)α,其中α为规模参数,β为形状参数,当α=1时,它就成了指数分布.当α=3.4时则相似于正态分布.在状态G中平均逗留时间hG由以下公式给出:hG=∫max_t其中,Γ是关于整数N的函数,Γ(N)=(N-1)!.简单地,仍假定检测攻击的时间、标记损坏数据项的时间、修复损害时间、错误恢复时间以及判定处理时间服从指数分布,且参数依次为λ,λd,λm,λk和λr,那么,平均逗留时间表示如下:由图2的模型,可得狏=VG,VI,VQ,VR,VJ.为了得到5种状态的稳态概率,求解方程(1)和(2),可得πG=βΓ(1+α)-1烄πI=πQ=烅πR=πJ=烆4.2综合评价模型出于简单考虑,2.1节中的模型并没有考虑入侵检测系统(IDS)本身的性能,只是假定IDS可以毫不拖延地报告入侵.但是在实时环境下,IDS的响应能力却是很重要的,延时过长将会导致大量的恶意事务传播,并不可遏制.在本节,将考虑检测延迟等参数,细化模型,将其拓展为综合评价模型.定义7.未检测状态UD.表示ITRDB未发现检测事项,或者将已检测事项的标记恢复为未检测标识.定义8.虚警状态FA.表示ITRDB系统发出Page5错误警告.误报率和检出率被广泛地用来评价在任何网络入侵检测系统的性能.检测延迟时间是另一个用来评价IDS的指标,该时间被定义为从当攻击侵入数据库系统开始到入侵检测系统成功识别入侵的时间段,且检测的平均时间(MTTD)即为状态I下的平均逗留时间hI.对于不完善的检测,通过IDS可能不会成功地检测到入侵.如果检测失败,系统将从感染状态变成未检测状态UD.对于实时系统来说,系统要求的时限会减去刚才的时间损耗,直至不满足要求为止,而且该事务项也方便在下一轮检测周期中被重新检测.假定Pd表示一个IDS识别入侵检测的概率,则该系统由感染状态I到检疫状态Q的转变概率为Pd,到未检测状态UD的转变概率为1-Pd,如图3所示.未经检测的攻击最终都将被系统管理员所识别,并且遭到感染的数据项也会被恢复.该系统将从未检测状态UD还原到良好状态G.此外,入侵检测系统虚警概率为Pfa.发生虚警时,系统会从良好的状态G转换到错误报警状态FA.下面的状态转换模型充分考虑了IDS的检测延迟等参数的影响,如图3所示.按照状态序列G、I、Q、J、R、FA与UD排列顺序,可得模型中的状态转换概率矩阵犘如下:熿犘=1-Pj00Pj000燀从而可得稳定状态空间为狏=VG,VI,VQ,VR,VFA,VUD,VJ,代入方程(1),求解可得烄VG=VI=VQ=VR=PdPj1-Pf()a烅VJ=VFA=VUD=(1-Pd)(1-Pfa)烆向量狏表示包含持续时间马尔可夫链的稳态概率,设向量犺=(hG,hI,hQ,hR,hFA,hUD,hJ),代表每一个状态的逗留时间,通过解方程(2)可得稳态概率π.5生存性评价指标本文中生存能力是完整性和可用性的量化术生存性,也称生存能力,是指系统的重要部分在受到攻击或事故的损害时仍然能及时提供服务的能力.一般地针对传统数据库,生存性指标主要有完整性、可用性两个,而误报因素、检出率因素、攻击强度等因素会对生存性指标造成重大影响.本节将在实时数据库半马尔可夫生存评价模型的基础上,建立量化指标,从多个方面来对ITRDB进行评价,改进其生存能力.下面将分析与重定义针对实时数据库的生存能力.5.1完整性语.根据生存能力的要求,完整性定义如下.定义9.完整性.在某个时间范围,所有可访问数据项都是干净的和时间有效的.较高的完整性意味着入侵容忍系统为用户提供好的或干净的数据服务的概率较高.显然,在状态G下所有的数据项均是干净的并且是可得到的.当攻击发生时,一些数据项将受到感染.因此,在状态I下,部分数据项是“脏数据”.在入侵被识别后,该“脏数据”首先被隔离,直到完成修复过程后才被释放.把状态空间E分为两个集合:C0和C1,其中C=C0∪C1,C0∩C1≠,子集C0包含所有“完整性”状态,在这些状态下所有能访问的数据项都是干净的,而Page6C1中则有些是不干净的.因此,可得C0={G,Q,J,R},该模型处于完整性状态的概率为MTTA+MTTM+MTTR+MTTJ假设MTTA指攻击的平均时间,表示该系统被损坏的预期时间,也就是系统能保持正常的时间;MTTD指检测的平均时间,表示入侵被检测到的预期时间;MTTM指标记的平均时间,表示该系统标记“脏”数据项的平均时间;MTTJ指判定的平均时间,表示系统进行修复必要性判定的预期时间.MTTR指修复的平均时间,表示系统修复损坏数据项的预期时间;由状态转换模型的定义,可得到Integrity=MTTA+MTTD+MTTM+MTTR+MTTJ(8)5.2可用性对于入侵容忍实时数据库系统而言,除了得到干净的数据服务外,响应的结果集还必须满足软硬实时的要求.可用性定义如下.定义10.可用性.所有干净数据项都能被访问,并且满足实时要求.把状态空间E分为两个集合:A0和A1,其中A=A0∪A1,A0∩A1=.子集A0包含了所有“可用”状态,其中干净数据项都能被访问.由于在检疫状态Q下,一些干净的数据项也会被包含进来,在损害评价完成后,干净数据项才被放行,而损坏数据项在修复状态R下被继续隔离.因此可得I0={G,R}.实时数据库系统中,由于每个事务都有时限要求Li(i=1,2,…,n),那么假定状态空间E中每个事务在模型各阶段运行的时间统计为∑Tpi(假定系统在pi阶段的处理时间为Tpi),定义时限运行参数αi=Li-∑Tpi.如果时间超过时限要求,αi的值肯定为0,表明事务项失效,模型将进行重新评价.根据定义,可得半马尔可夫综合评价模型的可用性为Availability=πG+πR=MTTA+MTTD+MTTM+MTTR+MTTJ6模型验证模型验证的目标是确定模型能提供系统的准确信息.在一组实验条件下,如果一个模型的准确性在可接受范围内,那么模型是正确的,这通常要确定感兴趣的模型输出变量.如果该变量是随机变量,那么常用平均值来验证模型的正确性.在我们提出的半马尔可夫模型中,感兴趣的是某个状态下的稳态概率,下面将比较模型的稳态概率和ITRDB面临攻击时观察到的度量值,以验证所提模型.6.1实验平台实验系统为Windows2003Sever平台,开发环境为VisualStudio.net2005集成开发环境,开发语言为C语言,并在内存DDR1G、CPU为AMD1700+的计算机上进行了实验.本次实验中使用实时数据库管理系统ARTs-EDB[19]作为底层的数据库管理系统,通过事务模拟器,用TPC-C基准模拟批发商的货物管理流程,随机产生合法事务和恶意事务对ITRDB进行仿真测试,恶意事务模拟异常输入和注入攻击.实验中提交了368个合法事务,153个恶意事务,累计执行了2632个SQL语句,其中含有条件SQL语句(如where)短语的事务共236个.下面列出实验中共用的重要参数,如表1所示.参数db_size数据对象数值14660块(2.6M行)Block_size块大小Max_size最大转换量读20行,写20行Min_size最小转换量Write_prob读写状态(写X|读X)70%在选择实验参数时,所选择的数据库和事务的尺寸是要让操作在一定范围内产生感兴趣的结果,保证实验结果能被观测到且不需要花费很长的仿真时间.6.2参数说明在上述模型中,实验者可以通过控制攻击行为、人为干预等对实验加以控制,或者自定义一些参数,例如本模型中的检出率、虚警概率等.可以进行多次实验,通过改变参数的取值来研究它们在系统生存性方面受到的影响.模型中通过PEM使用事务代理,可以控制在实验中所使用的参数,例如事务的大小、事务的数量、当前用户的数量等.模型中的一些参数是有关ITRDB自身的属性,这通常不由实验者来决定.实验中的半马尔可夫综合评价模型可采用最大似然估计来生成这些参数.假定观察k个事件与修复事件,总时耗为Mk,总的修复时间为Rk,判定时间为Jk.并且它们的最大似然估计为hM,hR,hJ,那么Page7相应地,实际观察数据的概率估计取决于系统处于该状态下的时间长度占总的观察时间长度的比率.6.3实验数据统计为了简单描述实验,将实验中所有的参数的集合称为方案.首先验证综合评价模型相对简单评价模型的改进,都取方案1进行实验比较,通过MATLAB计算模型中的公式,结果如表2所示.状态模型理论实验值/%实际观测值/%误差/%G83.11I9.63Q1.48R4.16J1.62同样地,采用方案1的数据,应用于综合评价模型,通过MATLAB计算,得到结果如表3所示.状态模型理论实验值/%实际观测值/%误差/%G81.26I9.81Q1.64R5.13J0.48FA0.54UD1.14比较表2与表3可知,在实际观测值相同的同一运行案例下,综合评价模型相比简单模型更精确,能更好地反映ITRDB系统的状态变化.当其受到恶意事务感染及传播后,半马尔可夫综合评价模型实时响应IDS的动作,根据需要跳转到其它粒度更细的状态(如FA、UD等).因为它允许系统存在事务时间处理间隔,并且评价的时间度量的粒度更细,也符合实时系统的必备要求.而单纯的半马尔可夫链概率模型比较“迟钝”,认为此时系统处于良好状态(G状态)居多,评价粒度较粗,显然不符合实际情况.为了验证系统误差,在MATLAB应用程序中改变方案1中的参数,选用方案2得到结果如表4所示.状态模型理论实验值/%实际观测值/%误差/%G70.75I12.58Q4.25R6.53J0.78FA1.43UD3.68表3与表4的实验结果表明由模型的理论输出结果与实际观测得到的结果匹配得非常相近,误差基本不超过7%,除了R状态为9.80%以外.这也证实了该模型的正确性,表明该模型在入侵容忍实时数据库系统的生存性建模方面与实际情况吻合得很好.表5总结了验证实验的结果.I状态平均逗留时间hI5msQ状态平均逗留时间hQ3msR状态平均逗留时间hR1msJ状态平均逗留时间hJ2msUD状态平均逗留时间hUD40ms40msFA状态平均逗留时间hFA50ms50ms7生存性指标的评价由于入侵检测的三个重要因素:误报、检出率和攻击强度会对生存能力造成重大影响,因此,基于所开发的入侵容忍实时数据库ITRDB,进一步研究第5节提出的生存性度量.在实验中将继续用MATLAB进行数据处理,并通过TPC-C基准测试对其进行详细的数据分析.7.1误报影响误报是评价入侵检测系统性能的关键因素.因为攻击行为的全局特征可能会在训练学习阶段被忽略掉,所以高误报率是基于行为检测技术的主要障碍.其次,高误报率可能给安全子系统带来额外负担和资源代价.下面研究ITRDB对较高虚警概率的容忍性.图4显示了ITRDB在轻度攻击下稳态概率的变化.即使在面临猜测攻击(虚警概率为0.5的临界点)Page8时,ITRDB仍保持完整性大于0.62,可用性大于0.60,这表明该系统在轻度攻击下具有较高的容忍性.在感染状态I、检疫状态Q和修复状态R下,该系统的稳态概率低于0.1,这表明该系统能够高效快捷地检疫、查找和修复攻击.与之相比,图5则显示了ITRDB在高强度攻击下的反应.由图5可知,高强度的攻击和额外的负荷导致了误报,也增加了误报状态、感染状态、检疫状态和修复状态的稳态概率.ITRDB将花更多的时间来处理误报状态以及忙于分析状态变化和修复损害,系统的可用性由于损害检疫时间的增长而减少,评价过程也变得更长,但其完整性仍保持在大于0.51的较高水平上.这表明系统仍具有提供干净数据给用户的较高可能性.7.2检出率的影响研究不同检出概率对系统生存性能的影响.检出率是评价生成性的另一个重要指标,下面ITRDB处于轻度攻击下的检出率影响如图6所示.当检出率为0时,入侵检测则完全取决于人工检测,耗时较长,ITRDB保持在未检测状态UD与良好状态G下的概率均较低,完整性和可用性处于较低水平.反之,当检出率为100%时,未检测状态UD的稳态概率回到0,检疫状态Q和修复状态R的稳态概率随着检出率的增长而增长.这表明随着ITRDB受到更多的攻击,系统将花更多时间进行损伤评价和修复,而且由于人工修复比ITRDB的修复子系统的自动修复缓慢得多,那么完整性和可用性将会随着检出率的增长而提高.当ITRDB面临强攻击时,如图7所示,低检出率明显影响了ITRDB的性能.当检出率为0时,良好状态G的稳态概率低于0.2.因此,当ITRDB无法识别入侵时,可用性和完整性也比较低,仅能维持系统运行.随着检出率增长,G状态下的完整性和可用性都平稳提升.这表明ITRDB遭到高强度攻击时仍可容忍较低的检出率.实验结论表明,要提高入侵容忍实时数据库系检出率相比虚警的影响,对ITRDB生存能力的影响则更加严重.因为检出率若从0提高到100%,可用性和完整性的方差则接近0.5,而当虚警概率从0变化到50%时,方差却低于0.2.其中的主要原因是由于低检出率会给管理员带来更多的工作,如手工标记和人工修理损坏等.如果系统能识别和恢复未检测的入侵的速度比手工操作快,那么低检出率的影响将会很小.统的性能,主要考虑提高ITRDB的检出率.7.3攻击强度的影响定义11.优质系统:优质入侵检测系统的简称,表示一个具有很高的检出率、低误报率、短检测延迟、快速评价损坏及修复的入侵容忍系统.定义12.劣质系统:劣质入侵检测系统的简称,表示一个具有较低的检出率、高误报率、长检测延迟、缓慢的损坏评价及修复的入侵容忍系统.攻击强度对入侵容忍系统的生存能力的影响也不容忽视.高强度攻击使得安全系统忙于防御和修Page9复,由此系统有可能会在安全系统修复损坏之前就崩溃掉.下面用良好状态G状态的逗留时间的长短来量化攻击强度,攻击越重,处于G状态的时间显然越短.图8比较了在不同G状态平均逗留时间下不同系统结构的ITRDB的稳态概率.图8中显示了优质系统的ROC曲线.可以看出状态转换概率比较大,虚警概率相对小,这表示感染状态、检疫状态、修复状态的平均逗留时间相对较短.重度攻击会对ITRDB的生存能力能造成明显影响.如当受到高强度攻击时,G状态取值为5时,完整性只到0.4,可用性只到0.3,处于非常低的水平.随着攻击强度的减轻,G状态取值为50,完整性和可用性也恢复到较高水平.图9中显示了劣质系统的ROC曲线.相对于优质系统,劣质系统的状态转换概率比较小,虚警概率比较大,这表示感染状态、检疫状态、修复状态的平均逗留时间较长.重度攻击增加了标记和修复坏损子系统的工作量.因此,检疫状态和修复状态的稳态概率上升,这使ITRDB忙于分析和屏蔽严重攻击,但对系统完整性造成的影响并不显著.因为ITRDB采用了损害检疫策略,所以当其面临重度攻击时仍能给用户提供干净的数据信息.8结论本文考虑实时数据库系统中事务的时间戳、事务T-SQL序列长短、事务与事务执行时间间隔分布不均等因素,通过ITRDB在面临攻击时的状态转换,对状态空间定义与状态之间的复杂转换关系这两个方面进行建模,建立了半马尔可夫生存评价模型,求解并进行误差分析.再进一步考虑IDS本身性能的影响,逐步细化模型,给出了生存性指标中完整性与可用性的定义.最后,进行仿真比较.实验结果表明,改进后的ITRDB体系结构适应了实际应用的需求,评价指标中的完整性与可用性也满足了实时数据库的生存需求,所提出的半马尔可夫模型是有效的.评价结果表明,遵循半马尔可夫综合模型的ITRDB可以做到以下两点:一是在面临攻击时能在时限范围内提供必要的数据库服务,二是在各种不同系统的缺陷和攻击强度下,系统所需基本生存特性也没有受到严重的影响.
