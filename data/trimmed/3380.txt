Page1一种低耗能的数据融合隐私保护算法杨庚王安琪陈正宇许建王海勇(南京邮电大学宽带无线通信与传感网技术教育部重点实验室南京210003)(南京邮电大学计算机学院南京210003)摘要物联网中的隐私保护是实际应用中要解决的关键问题之一,作为物联网组成部分的无线传感器网络,希望在进行精确数据融合的同时,又能保护个人的隐私.文中提出了一种新的低能耗无线传感器网络数据融合隐私保护算法ESPART.一方面算法依靠数据融合树型结构本身的特性,减少数据通信量;另一方面算法分配随机时间片,避免碰撞.同时限制串通数据范围,降低数据丢失对精确度的影响.仿真结果显示,相比于SMART算法,ESPART可以在有效保护数据隐私的前提下,花费与TAG算法相同的时间和较少的数据通信量,得到精确的数据融合结果.关键词物联网;无线传感器网络;数据融合;隐私保护;低耗能;高效能1引言感知终端的位置信息、采集的数据信息等是物联网的重要信息资源之一,也是需要保护的敏感信息.另外在数据处理过程中同样存在隐私保护问题,如基隐私保护是物联网信息机密性的直接体现,如于数据挖掘的行为分析等等.在物联网的实际应用Page2中,需要解决其信息隐私保护问题.无线传感器网络是物联网的主要组成部分,它的任务主要是依靠分散在环境中的大量节点,收集有用信息,以便人们使用这些信息进行分析与处理.例如,健康监控系统利用无线传感器网络监测病人,收集并汇聚病人实时信息,通过分析这些数据可以得到相应的结论和处理手段.无线传感器网络中的节点通常是资源受限的,同时由于能量资源关系到整个传感网络的生存时间,因此能量消耗通常是传感网中数据融合需要重点考虑的问题.文献[1]表明使用Micadot节点发送1bit数据需消耗能量约4000nJ,处理器执行一条指令需消耗的能量仅约为5nJ,因此减少通信数量可以有效地减少能量消耗.另一方面,在实际应用中,人们希望通过传感器网络收集其覆盖范围内的相关检测数据,但在数据的收集与传输过程中,存在大量的数据冗余与碰撞,影响了传感网有效数据的采集,降低了网络的生存时间.因此,设计有效的数据融合算法是十分必要的[2],它可以剔除感知信息中的冗余数据,在得到有效数据的前提下,减少数据传输量,也相应减少了数据传输过程中的碰撞,减轻网络拥塞,节省节点能量,达到延长网络生命周期的目的。文献[3]中提出的TAG(TinyAGgregation)算法就是一种典型的应用在无线传感器网络中的数据融合技术.基本的数据融合技术一般不提供数据的隐私保护机制.然而在实际应用中,隐私保护机制是不可或缺的,比如在健康监控系统中,节点可以获得病人的体温、血压、脉搏等数据,这些数据属于个人隐私,病人不想其被其它人得到.在基本的数据融合技术中,节点使用无线信道,将数据沿着数据融合技术构造的数据融合树层层向上传递并融合,最终QS(QueryServer)得到需要的融合数据.然而,由于无线传输的特性,节点间传输的数据易于被捕获和偷听,并且网内的可信任父节点可以得到子节点的数据,如果攻击者破解了无线链路或捕获了父节点,病人的隐私便暴露了.无线传感器网络数据融合隐私保护技术就是在保证数据融合结果正确的情况下,即使是传输的数据被外部捕获与解密或是内部其它可信节点被捕获,也能够阻止隐私数据被获取的技术.现有的研究[4-12]已经提出了一些隐私保护方案,它们各自有自己的适用范围,而且部分解决方案还有一些问题需要进一步解决.例如,Girao和Castelluccia提出的一种数据融合隐私保护解决方案[7-8].它们使用同态加密,可以让节点在不需要解密数据的条件下,对数据实施有效的融合,但该种方案对QS不具备隐私保护性.Conti等人提出了一种提高鲁棒性的数据融合隐私保护算法[9].它加强了鲁棒性,而且其节点计算复杂度与数据传输量都不大,但需要基于簇状结构的无线传感器网络.Bista等人提出了一组新型数据融合隐私保护解决方案[10-12].它们都有着计算复杂度与数据传输量小的优点,但是它们都对QS不具备隐私保护性.本文提出了一种能量节省的数据融合隐私保护算法ESPART,它对SMART[4](Slice-Mix-AggRegaTe)做了相应的改进,采用逐跳(hop-by-hop)的数据融合方式,具有计算复杂度与数据传输量小的优点,并对QS具备隐私保护性.它采用给每个节点分配随机时间片的办法,以避免节点间的碰撞,并限制节点间串通(collusion)的数据范围,降低数据丢失对精确度的影响,使得ESPART在精度要求相近的情况下,需要的数据融合时间(EpochDu-ration)较少.ESPART采用依靠数据融合树形结构本身特性的办法,消除SMART算法中不必要的节点通信,使其在同等隐私保护安全性情况下,数据传输数量减少为SMART的50%左右.本文第2节对相关工作进行讨论,详细分析SMART算法的安全性、通信复杂性和精确度等性能;第3节描述本文所采用的系统模型;第4节给出一种新的数据融合方法以及具体的算法;第5节用理论方法和仿真实验,分析本文所述方法在隐私保护和能量消耗等方面的优越性,并与其它方法进行比较。2相关工作Wenbo等提出了数据融合算法PDA(Privacy-preservingDataAggregation)[4],其中包含了两种算法CPDA(Cluster-basedPrivateDataAggregation)和SMART,但是CPDA计算量大,而SMART数据通信量也太大,并且对数据丢失敏感,需要两倍于TAG的时间来获得相对精确的结果.与本文提出的ESPART算法关系最为密切的是SMART算法[4].SMART算法使用逐跳(hop-by-hop)的数据融合方式和点到点(node-to-node)的加解密模式,它能够在保证数据融合结果精确程度的情况下,阻止外部入侵者的攻击,保证内部可信节Page3点以及QS获得隐私数据.SMART算法步骤分成三步,分片算法(Slicing)、混合算法(Mixing)和融合算法(Aggregating).在SMART算法中,节点先将自身测得数据进行分片,然后将这些分片依次发送给随机选取的邻居节点们,最终沿数据融合树向上进行数据融合.SMART算法的节点计算复杂度为O(1),由于对自身测得数据进行分片并相互交换混合的原因,同时SMART需要传输的数据大约是TAG的(J+1)/2倍(J是SMART算法中的分片数目,通常图1SMART性能[4]3系统模型在本文中,无线传感器网络由一个连通图G(V,E)来表示,其中的顶点v(v∈V)表示无线传感器网络中的节点,边e(e∈E)表示节点间的通信链路.记无线传感器网络中节点的数量为N=|V|.在无线传感器网络中,包含了3种类型的节点:QS(QueryServer)节点、融合节点和叶子节点,我们只考虑网络中只有一个QS节点的情况.在传统的数据融合技术中,构造的数据融合树以QS节点为选取J3以达到隐私保护的效果),而且SMART对数据丢失十分敏感,以至于大约需要2倍于TAG的数据融合时间才能得到相对精确的结果[4].图1(a)显示了SMART的隐私保护性,可以看出,当J3时,节点的隐私数据被暴露的概率小于0.5%;图1(b)显示了SMART的数据通信量,可以看出,其值随J的增加而增加;图1(c)显示了SMART的精确度,可以看出,在EpochDuration=25s前,数据融合结果基本不能体现实际的数值.根,得到数据融合的最终结果;融合节点融合从其子节点接收的数据和本身采集到的数据,并向上传递给其父节点;叶子节点只负责采集数据并传给其父节点.我们定义数据融合函数为y(t)=f(d1(t),d2(t),…,dN(t)),di(t)(i=1,2,…,N)表示节点i在t时刻采集到的数据(如图2所示).由于很多典型的数据融合函数,比如count、average、max、min等都可以化简为sum函数[8],因此在本文中我们以sum函数为研究对象,记y(t)=∑NPage4无线传感器网络在很多实际应用中都必须考虑隐私保护,以保证每个节点采集到的数据只能由授权的用户访问.对数据的隐私保护的手段之一是加密.ESPART算法采用逐跳的数据融合方式和节点到节点的加解密模式,其密钥分配与管理策略与SMART算法一样,采用随机密钥分配机制[13],即首先生成一个拥有K个密钥的密钥池,每个节点从这个密钥池中随机选取k个密钥,如果邻居节点与本节共享一个相同的密钥,记为keys,此时这两个相邻节点间就可以通过这个共享密钥keys建立起一条安全链接.任意两个节点能够共享一个相同的密钥的概率为pconnect=1-((K-k)!)2对无法找到共享密钥对的相邻节点可以通过建立一条多跳的链接,实现节点间的加密解密过程[13].同样,在此无线传感器网络中,作为偷听者的第三方节点,采用相同的随机密钥分配机制,即也从这个拥有K个密钥的密钥池中随机选取k个密钥,那么如果在这k个密钥中包含有keys,则此偷听节点可以使用这个密钥keys对已加密信息进行解密,此时先前建立的一条安全链接便不再安全.偷听节点获得keys的概率为poverhear=k假定密钥池中共包含K=10000个密钥,每个节点随机选取k=50个密钥,那么任意两个节点间可以共享相同密钥的概率为pconnect=78%;一旦一对节点选取一个共享密钥keys建立起一条安全链接,那么偷听节点拥有共享密钥keys的概率为poverhear=k小的数.4ESPART:一种低耗能的数据融合隐私保护算法设实际测量数据值的下界为Vlowerbound,上界为Vlowerbound,节点产生的随机数表示为r(r∈(-1,1)),其在(-1,+1)区间内均匀分布.同时为了保证隐私保护性,设节点需要的最小出入度度数为MinDeg;为得到可靠的数据融合结果,设数据融合循环次数为Loop,每个节点分配1byte空间用以记录本节点的循环次数loop.QS为一个时延EpochD(EpochDuration)的时间,节点在这个EpochD时间内分配一个串通时延CollD(CollusionDuration)和一个融合时延AggD(AggregationDuration),所有节点在CollD时间内进行串通,在AggD时间内向上传输并融合.其中MAX_DEPTH表示此无线传感器网络中数据融合树的最大深度.算法1.ESPART算法.1.准备阶段.1.1.计算节点集Si:每一节点i(i=1,2,…,N)随机在h跳内选取一个节点集Si(|Si|=MinDeg),对于稠密的无线传感器网络,h值为1即可.1.2.计算融合树与参数:在一个EpochD时间内,使用TAG算法,产生数据融合树,在每一节点i(i=1,2,…,N)向上进行数据融合时,记录其子节点的数目,记为参数degi.明显有叶子节点的degi=0.此时得到一个结果,并且节点将循环次数loop加1.2.节点串通通信阶段.2.1.计算时间片:由MinDeg的大小确定分配的时间片的多少,记tp(p=1,2,…,MinDeg)为在CollD内分配的时间片,它们在CollD内均匀分布,则有tp=CollD2,…,MinDeg).2.2.串通节点间进行数据通信:首先网络节点处于在CollD内分配的时间片t1内,让节点的degi为0的节点们,即叶子节点们在分配的时间片t1中随机选择时间与其它节点进行串通;接着在分配的时间片t2内,让节点degi为1的节点们在分配的时间片t2中随机选择时间与其它节点进行串通,一直到让节点degi为MinDeg-1的节点在其分配的时间片tMinDeg内与其它节点进行串通.具体为:①节点i在此次循环时实际测得数据记为di,伪数据记为fi,节点首先验证自己的degi是否小于MinDeg.若非,则不需要请求发送串通数据,在CollD内只需接收即可,CollD结束后,直接进入步3;若是,则在Si中顺序选择节点j,向节点j发出种子Seedij,并将degi加1,从节点自身记录的数据(发出或接收第一个种子前,其值为di)中减去Seedij.种子的计算公式为Page5此时节点i中的伪数据为fi=di-Seedij.若节点i收到加密的种子,则使用与邻居节点共享的密钥解密,得到种子Seedij,然后将得到的种子与自身记录的数据相加,并将degi加1,此时得到的伪数据为fi+Seedji.②跳到步①开始执行.3.数据融合阶段.在AggD时间内,依步1中建立的数据融合树,使用TAG算法,从底层节点向上层节点逐步进行数据融合,最终图3ESPART算法示意图图3(a)表示处于准备阶段的无线传感器网络中各节点的情况,在此阶段中节点除了做TAG算法,向上融合数据得到结果外,还要记录其子节点的个数并保存于deg变量中,并将loop加1.由于MinDeg定为3,故将节点间串通通信阶段分为MinDeg=3个时间片,记为t1、t2、t3,它们依结束.在QS得到数据融合结果,此时节点将循环次数loop加1.4.算法循环与结束阶段.若loop小于Loop则跳到步2开始执行,否则算法图3显示了在N=8的无线传感器网络中,并在给定Loop=2,MinDeg=3,h=1的条件下,执行一次ESPART算法的具体步骤.算法中,相邻节点间的每一次数据传输都需要使用随机密钥分配机制[13]生成的密钥进行加密与解密.次进行.图3(b)~(d)分别表示网络中的节点依次处于串通通信阶段时间片t1、t2、t3中,网络中deg变量为0、1、2的节点,向邻居节点们发出种子Seed的过程.节点每发一个Seed或者每收到一个Seed,就将其自身的deg变量加1,直到deg不小于MinDeg.通过约定的串通时间分片通信模式发送数据,可以Page6避免所有节点同时刻发送,减少网络中的碰撞次数.并且通过确定自身deg变量的方法来决定是否需要发送数据,可以减少网络中的数据传输数量.并且每个节点发送的Seed都经过计算控制在一定范围内,可以减小数据丢失带来的影响.图3(e)表示网络中节点依照准备阶段建立好的数据融合树向上融合,最终在QS得到数据融合结果,并将loop加1.此时loop已经等于Loop,算法结束.5性能分析在本节中我们主要从隐私保护性、数据通信量、精确度这三个方面分析ESPART的性能.TAG[3]是应用在无线传感器网络中的一种典型数据融合技术,它不提供隐私保护功能,我们使用它作为ESPART的数据通信量、精确度的对比项.本文采用TOSSIM[14]软件进行TAG和ES-PART算法的仿真,具体的网络环境配置为:600个节点随机分布于400m×400m区域中,无线信道对称,标准室内环境,背景噪声为-105.0dBm,高斯白噪声为4dB,节点的数据传输速率为1Mbps,节点的灵敏度为-108.0dBm,传输距离为50m.5.1隐私保护性对于一个节点来说,记其测得的数据被获取的概率为P(q),q表示节点之间的链接被破解的概率,q≈poverhear.在ESPART算法中,每个节点的度数至少是MinDeg.除非将节点的入度与出度链接都破解,节点的真实数据才会暴露,因此其中,dmax表示网络中节点deg的最大值,P(deg=k)表示网络中节点的度数为k的概率.记网络中度数为k的节点数量为N(deg=k),则P(deg=k)=N(deg=k)N.相应的在SMART[4]中,除非节点所有的J-1个出度与所有的入度链接都被破解,节点的真实数据才会暴露,此时其中,dmax表示网络中节点入度的最大值,P(in_degree=k)表示网络中节点入度为k的概率.记网络中入度为k的节点数量为N(in_degree=k),则P(in_degree=k)=N(in_degree=k)对式(1)和(2)进行对比分析可知,为了保证节点的隐私数据被暴露的概率足够小,ESPART算法与SMART算法不同,它并不保证节点的出度数量J-1,它保证的是节点的出入度之和MinDeg.无线传感器网络隐私保护性强度与节点的隐私数据被暴露的概率成反比.理论上,在MinDeg与J-1相等的情况下,由于ESPART算法串通的次数小于SMART算法串通的次数,ESPART算法的隐私保护性略小于SMART算法.图4显示了ESPART的隐私保护性的仿真结果,从图中可以看出,MinDeg越大ESPART的隐私保护性越好,然而MinDeg越大意味着网络中的数据通信量就越大,在实际应用中,可以采取一种折中的方案,如在保证一定的隐私保护性的同时,尽量减少网络中的数据通信量.如若希望节点之间的链接被破解的概率低于2%,在本模拟环境中,MinDeg取2时,节点的隐私数据被暴露的概率就低于0.02%,可以满足一般的隐私保护要求.将仿真结果ESPART与图1(a)SMART的隐私保护性[4]进行对比可以知道,ESPART中的MinDeg对应着SMART中的J-1.在它们数值相等的情况下,ESPART算法的隐私保护性略低于SMART算法,但在q值很小的情况下,两种算法的隐私保护性相近,基本可视为同等.5.2数据通信量在ESPART算法准备阶段,与TAG[3]相同,先从QS发出Hello信号.每个节点第一次收到Hello信号时,将自己的父节点设置为此Hello信号源节点,然后发送一个Hello信号,以此建立一棵数据融合树;在向上进行数据融合阶段,每一节点需要在时Page7间片内向上传递数据.为了简化,在仿真中,我们给每一层分配相同的时间片,并让它们在时间片内随机发送,以避免冲突.ESPART算法需要每个节点在第一步的融合阶段,记录自己的子节点的个数,并记录于deg中,如图3(a)所示.由于第一步是准备阶段,其产生的数据通信量与TAG相同.在TAG中,每个节点都需要发送2个数据,即1个Hello信号和1个融合数据.但一旦树型结构固定下来,自己子节点个数记录下来,可以让后面节点间的串通通信阶段减少数据传输量,并且可以重复使用,因此准备阶段产生的数据通信量在ESPART算法仿真结果中可以忽略不计.对于ESPART与SMART算法,仿真过程中测量的是网络中节点在一次串通期间发送的总数据包个数.对于TAG算法,我们衡量的是网络节点在一次建树和融合的过程中发送的总的数据包个数.图5说明了ESPART、SMART与TAG的数据通信量与EpochD时间大小无关,ESPART和SMART的数据通信量与MinDeg(J)相关,MinDeg(J)越大,ESPART和SMART的数据通信量越大.我们可以从理论上对仿真结果进行分析.对于ESPART算法,记网络中节点在一次串通通信期间发送的总数据包个数为CE(MinDeg,N)(N表示无线传感器网络中节点的数量).同样对于SMART,记其在一次串通通信期间,网络中节点需要传输的数据包总个数为CS(J,N)(J表示SMART算法中的分片数目,N表示无线传感器网络中节点的数量),则有CS(J,N)≈(J-1)·N.记Ni(i=0,1,…,MinDeg)表示无线传感器网络数据融合树中,子节点数目为i的节点的数量,那么CE(J,N)<MinDeg·N0+(MinDeg-1)·N1+…+上式从理论上说明在SMART算法与ESPART算法隐私保护性相近的情况下,从数据通信量(串通花费)方面比较,ESPART算法要优于SMART算法.从仿真结果可以看出,CS(2600)≈600,CS(3600)≈1200,CS(4600)≈1800,这与理论分析一致.同样可以得到,CE(1600)≈330,CE(2600)≈620,CE(3600)≈1000.因此,在本仿真环境中,ESPART算法的数据通信量大约是SMART算法的1/2.5.3精确度在无数据丢失的理想环境中,TAG、SMART、ESPART的数据融合结果都应该能达到100%的精确度.然而在实际应用中,存在由碰撞、节点间距离过大或时间不足等原因造成数据丢失的现象,从而影响了精确度.我们定义无线传感器网络的精确度为数据融合结果与节点测得真实数据之和的比值.仿真主要针对EpochD的变化对TAG和ESPART算法的影响.在每一个EpochD数值下进行20次仿真,仿真结果是对它们的均值统计,如图6所示.从仿真结果来看,它们的波动较大,各统计数据之间的关系并不能确切表示精确度在一定EpochD数值下的相互关系,但是能表示精确度在一定EpochD数值下的范围与趋势.从图6可以看出,TAG与ESPART算法的精确度都不能达到理想状态下的100%.并且在EpochD值较小的情况下,TAG与ESPART精确度都随着EpochD的增加而增加.当EpochD增大到Page8一定程度时(10s左右),精确度都维持在90%左右.可以说TAG与ESPART算法的精确度相对于EpochD的变化,其范围与趋势是一致的.对于ESPART,MinDeg对精确度的影响并不大.对于SMART算法[4],如图1(c)所示,需要2倍于TAG的EpochD时间才能得到相对精确的结果.理论上的分析可以得到,由于ESPART算法采取了随机分配时间片的方法确定通信时间片,避免了碰撞,且随机数r的取值为在(-1,+1)区间内的均匀分布.由Seedij的计算公式可知,算法可以将串通通信阶段的数据通信量控制在一定范围内.同时随机数以1/2的概率随机选取正负数,以此来降低数据丢失对精确度的影响,得到近似于TAG的精确度.6结论本文提出了一种新的无线传感器网络数据融合隐私保护方案ESPART,它是对SMART方案的一种改进.相比于SMART,它可以在有效保护数据隐私的前提下,花费少量的时间与数据通信量,得到精确的数据融合结果.隐私保护性数据通信量精确性计算量鲁棒性需要时间表1总结了ESPART相对于SMART的优点.ESPART算法中关于依据数据融合树形结构特性,减少网络数据通信量的思想,可以用在其它无线传感器网络数据融合隐私保护算法中,如CPDA[4]与iPDA[5].He提出的iPDA[5]与iCPDA[6]主要提供了SMART与CPDA在完整性保护方向上的扩展,分别继承了SMART与CPDA的缺陷与优势.同时加入了完整性保护方面的算法,但是它们为了保证数据融合的完整性,都大量增加了网络的数据通信量,并且都需要无线传感器网络中节点足够稠密.我们今后将展开对iESPART(anIntegrity-Energy-SavingPrivacy-preservingAggRegaTion)算法的研究,它是ESPART算法在完整性保护方向上的扩展,并着力解决iPDA与iCPDA遗留的问题.
