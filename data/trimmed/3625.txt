Page1一个单方加密-多方解密的公钥加密方案庞辽军1),2)李慧贤3)裴庆祺2)柳毅4)王育民2)1)(西安电子科技大学生命科学技术学院西安710071)2)(西安电子科技大学综合业务网国家重点实验室西安710071)3)(西北工业大学计算机学院西安710072)4)(广东工业大学计算机学院广州510006)摘要以Shamir的门限秘密共享方案和对称密码算法为基础,基于椭圆曲线上的双线性变换提出了一个具有多个解密者的单方加密-多方解密公钥加密方案.在该方案中,消息发送者具有一个唯一的加密密钥,而每个消息接收者都具有不同的解密密钥.使用加密密钥所加密的密文可以被任意解密密钥所解密,得到同样的明文信息.分析发现,该加密方案不仅安全有效,同时,它还具备前向保密性,即使加密者的主密钥泄露,也不会影响之前加密信息的安全性.文中方案具有非常重要的应用价值,尤其可以用来实现安全广播/组播和会议密钥的安全分发.关键词秘密共享;门限方案;双线性对;安全广播;会议密钥;前向保密性1引言随着数字信息业务的不断发展与普及,其安全问题也越来越受到人们的关注,这不仅仅涉及用户身份认证和保密通信问题.例如,在数字电视应用中,提供数字信息内容服务的服务提供商或公司希望只有经过授权并付费的用户能享受该服务,而非授权用户却无法享受这种服务.而在无线局域网(WLAN)、无线城域网(WMAN)、无线传感器网络(WSN)等多种形式的无线网络和有线网络中,安全广播/组播业务也备受关注.如何实现安全广播/组播已成为当前研究热点之一.单播业务的安全性比起广播/组播业务相对较为容易实现.早期通常采用的单播安全方案为共享密钥方式,在通信双方设备上手工设置相同的密钥即可.但随着网络用户数目的增加,这种方法可扩展性差的缺点就暴露出来了.后来,出现了一些密钥协商协议来动态协商单播会话密钥.广播/组播的安全问题较为复杂,目前一般都是基于单播密钥实现的.例如:在WLAN的安全解决方案IEEE802.11i[1]或国内的WAPI协议[2]中,广播/组播密钥都是由接入点(AP)使用其与各移动终端(STA)共享的单播会话密钥加密发送的,效率非常低.假设有n个STA,不妨记为1,…,n,每个STA与AP都共享一个单播会话加密密钥,记为ski(i=1,…,n).AP为了分发一个广播/组播密钥Key,需要使用每一个密钥ski加密Key,并将加密后的密文发送给相应的STAi.很显然,这种方案的效率和实时性随着STA数目的增加而降低,难以满足实际应用需求.公钥加密算法可用来加密传递的秘密信息.但是,由于目前大多数公钥算法只有一个解密私钥,尽管能够很好地解决单播加密问题,但在实现广播加密时就非常低效.例如,对于安全广播问题,大多数采用公钥加密算法的实现方法是这样的:假设有n个广播接收者,不妨记为1,…,n,每个接收者的公私钥对记为(pki,ski).对于发送给接收者i的明文m,发送者用i的公钥pki加密明文m为Ci.在进行了n次加密后,发送者将密文C=C1…Cn广播.接收者i收到密文C后,将子密文Ci提取出来,并使用自己的私钥ski解密获得明文m.很显然,在上述安全广播方案中,具有n个接收者就要求使用公钥加密算法对于每个明文m进行n次加密运算,效率很低,而且同一明文的不同密文一起广播也降低了通信带宽的利用率.如果能有一种加密方案,发送者只加密一次,而每个接收者都可以使用自己独有的解密私钥进行解密,恢复同样的明文信息,就能有效地解决上述的广播/组播安全问题.这样的加密方法通常称为具有多个接收者的公钥加密方案,即单方加密-多方解密的公钥加密方案.具有多个接收者的单方加密-多方解密的公钥加密的概念最初是由Baudron等人[3]和Bellare等人[4]提出的,他们提出可以将在单接收者情况下的公钥加密方案推广到多接收者的情况.后来,文献[5]基于随机重用技术将ElGamal加密方案推广为具有多接收者的公钥方案.文献[6-7]也分别基于椭圆曲线上的双线性对构造了基于身份的具有多接收者的公钥加密方案.本文尝试将秘密共享技术[8]的门限共享思想用于公钥加密方案设计之中,使得所设计的方案能够满足单方加密-多方解密的性质.在安全的对称加密算法基础上,基于双线性变换[7]提出一个可具有多个接收者的单方加密-多方解密的公钥加密方案,并对其正确性、安全性和有效性进行分析.本文第2节介绍本文方案需要用到的相关技术,包括双线性变换和秘密共享概念;第3节介绍本文提出的基于秘密共享和对称加密算法的具有多接收者的公钥加密方案;第4节将从正确性、安全性和有效性等方面对本文所提出的方案进行分析和讨论;最后,在第5节总结全文.2相关技术2.1双线性变换定义1.双线性变换.设(G1,+)和(G2,·)为两个阶数均为素数p的循环群,其中前者为加法群,后者为乘法群;令P为G1的生成元.称变换e:G1×G1→G2,为双线性变换,如果满足下面的性质:(1)双线性.对任意P1、P2和Q∈G1有e(P1+P2,Q)=e(P1,Q)e(P2,Q)及e(Q,P1+P2)=e(Q,P1)e(Q,P2)成立;(2)非退化性.存在P∈G1即e(P,P)≠1,也就是说e(P,P)是G2的生成元;(3)可计算性.对任意P1、P2∈G1,存在有效的算法计算e(P1,P2).双线性变换是现代密码学中一个非常重要的工具,是基于身份(或ID)密码协议不可或缺的组成部分.由于篇幅所限,其相关的安全性质将不再赘述,Page3需要进一步了解的读者可以参阅文献[9].2.2Shamir的门限秘密共享方案Shamir[10]于1979年提出了一个基于Lagrange插值公式构造的(t,n)门限秘密共享方案,具体内容如下:(1)初始化阶段.秘密分发者D随机地从GF(q)(q为素数且q>n)中选取n个不同的非零元素x1,x2,…,xn,使用xi标识每一个参与者Ui(i=1,2,…,n).这里所有xi的值都是公开的.(2)秘密分发阶段.如果D打算让这n个参与者共享秘密s∈GF(q),那么,D随机地选择GF(q)中的t-1个元素a1,a2,…,at-1,构造t-1次多项式f(x)=a0+a1x+…+at-1xt-1.接着,计算yi=f(xi)(i=1,2,…,n),并将yi安全地发送给相应的参与者Ui作为其子秘密.(3)秘密恢复阶段.这n个参与者中的任意t个合作可以恢复上述所共享的秘密s.设访问结构Γ为包含t个参与者的集合,例如:令Γ={x1,x2,…,xt}.为了表达方便,如果我们定义σxi,Γ(x)∏xj∈Γ,j≠i,那么,t-1次多项式f(x)可以描述为很显然,有在本文的加密方案中,发送者的加密主密钥将作为一个秘密在所有接收者中进行共享.2.3DBDH假设到的困难性假设.通过下面的定义介绍构造和分析本文方案所用定义2.双线性Diffie-Hellman判定假设(即BDDH假设).设G1和G2分别是加法和乘法群,其阶均为素数p.设P为G1的生成元.假设e:G1×G1→G2为双线性映射,即对所有的Q,R∈G1和a,b∈Zp满足e(aQ,bR)=e(Q,R)ab,并且e(P,P)≠1.若挑战者随机选择a,b,c,z∈Zp,如果不存在多项式时间算法能以不可忽略的概率区分四元组(aP,bP,cP,e(P,P)abc)和(aP,bP,cP,e(P,P)z),则BDDH假设对(G1,G2,e)成立.一个公钥加密体制称为(t,q0,ε)安全是指对任何攻击时间为t的敌手B,向明文检测谕示最多作q0次查询后,B找到给定密文所对应的明文的优势不大于ε.3多接收方加密方案3.1系统参数建立过程设(G1,+)和(G2,·)为两个阶均为p的循环群,其中前者为加法群,后者为乘法群,p为素数,且满足G1中Diffie-Hellman计算问题为困难问题;令P为G1的生成元;令e为G1和G2上的双线性变换,即e:G1×G1→G2;令(Ek,Dk)为某安全的对称密码算法的加、解密算法,其中k为对称密钥;令h(·)是一个单向Hash函数;令hk(·)是一个由密钥k控制的钥控单向Hash函数.要求假设所选对称加密算法和Hash函数是密码学安全的.假设系统中有一个消息发送方(即加密者)S和n个消息接收方(即解密者)R1,R2,…,Rn.首先,消息发送者S随机选取两个正整数a和b,并在Z以下n+1个向量:犛={v0,1,…,v0,烉烇烋a接着,消息发送者S随机选取自己的加密主密钥SS∈Z然后,S随机选择两个元素Q1,Q2∈G1以及一个a+b-1次多项式f(x)∈Zp[x]满足f(0)=SS,并计算如下信息:犛=f(犛)P={f(v0,1)P,…,f(v0,a)P}(1)={f(vi,1)(Q1+Q2),…,f(vi,b)(Q1+Q2)},到此为止,建立的系统参数表示如下:(1)(p,G1,G2,e,P,QS,Q1,Q2,犛,犚1,…,犚n,(2)SS为消息发送者S的加密主密钥;(3)Ri为消息接收方Ri的解密私钥(i=1,犚i=f(犚i)(Q1+Q2)犛)为系统公共参数;1.随机选择秘密整数r∈Zp并计算P=rP,Q1=rQ1;2.计算k=(k1,k2)=h(S‖R1‖…‖Rn‖SS‖r).其中:密钥k1,k2的长度需要满足方案所使用的对称加密算法和钥控hash函数的密钥长度要求;3.计算c=Ek1(m),I=hk2(m)和U=e(QS,Q2)rk;4.计算犛=r犛={rf(v0,1)P,…,rf(v0,a)P}.最后,发送者S产生的关于m的密文信息为2,…,n).3.2加密过程送信息m.S的加密过程如下:假设发送者S需要向接收者R1,R2,…,Rn发Page4(P,Q1,U,c,I,犛).3.3解密过程任意一个接收者Ri(i=1,2,…,n)可以利用自己的解密密钥解密密文(P,Q1,U,c,I,犛)以获取明文信息m.解密步骤如下:其中,符号Value(X,i)表示返回向量(或数组)X中的第i个分量(或元素)的值.3.计算m=Dk1(c)和I=hk2(m);4.判断I=?I是否相等.如果相等,接受m为合法明文,否则拒绝m.4分析和讨论本节将对本文所提加密方案的正确性、安全性其中,在上述证明过程中标注为(+)的变换依据为等量代换;标注为()的变换依据为第2.2节中所述的Lagrange插值变换;标注为(-)的变换依据为椭圆曲线双向性变换.和有效性进行分析和讨论.4.1正确性分析很显然,在本文所提方案中,消息m的保密性定理1.在解密过程的步2中所计算的密钥k满足k≡k,其中k为加密过程中所使用的对称密钥.证明.e(Q1,QS)U(e(Q1,QS)U()Pe∑b()Pe∑b(j=1j=1e(rQ1,QS)e(QS,Q2)rk1.使用犛和自己拥有的犚i中的所有分量值构造Γ,即Γ={v0,1,…,v0,a,vi,1,…,vi,b}.同时,计算每一个σv0,i,Γ(0)(i=1,2,…,a)和σvi,j,Γ(0)(j=1,2,…,b),具体计算方法见第2.2节;2.使用如下方法计算k:e(Q1,QS)U)))e∑b和完整性分别通过对称加密算法和钥控Hash函数实现.因为我们假设所选对称加密算法和钥控Hash函数是密码学安全的,因此,整个系统的安全性取决于密钥k的安全性.而密钥k如何在接收者中进行安全分发以及能否正确进行恢复是方案正确性的关键.在本文方案中,接收者在解密过程中的步2中所计算的密钥k恒等于加密过程中所使用的密钥k.关于这一点,我们可以通过下面的定理来说明:(σvi,j,Γ(0)·Value(犚i,j)),Pj=1σvi,j,Γ(0)f(vi,j)(Q1+Q2),Pf(vi,j)σvi,j,Γ(0)(Q1+Q2),(f(vi,j)σvi,j,Γ(0j=14.2安全性分析同样,由于我们假设本文方案中所选用的对称加密算法和钥控hash函数是密码学安全的,整个系统的安全性取决于密钥k的安全性,因此,我们仅需Page5要证明本文方案能够保证密钥k的安全性.下面我们在BDDH假设下证明多项式攻击者无法成功攻破方案中密钥k的安全性.定理2.如果存在攻击本文方案的多项式时间敌手A,其优势为ε,运行时间为t,则以A为子程序可以构造求解BDDH问题的算法,其优势为ε=12ε,运行时间为t=O(t).证明.首先,以A为基础来构造求解BDDH问题的算法B.设BDDH问题的实例(P,G1,G2,e,aP,bP,cP,Z0,Z1),其中Z0=e(P,P)abc;Z1=e(P,P)z;zp中随机选择的整数.设B区分(P,aP,bP,为从ZcP,Z0)和(P,aP,bP,cP,Z1)的优势为ε,其运行时间为t.算法B按如下方法生成本文方案的一个实例.Phase1.B令QS=aP和Q2=bP.并分别随机选择r∈Z外,B随机选择Zv0,m},然后,计算Q1=rP并输出系统公共参数(p,Q1,Q2,P,QS,e,G1,G2,犛)给A.ChallengePhase:A选择两个等长明文K0和K1并发送给B.B收到后生成目标密文C+如下:(1)随机选择u,v∈{0,1};(2)返回C+=(cP,bcP,ZvKu,{f(v0,i)cP|v0,i∈{v0,1,…,v0,m}}).对于Zv,如果v=0,因为ZvKu=e(P,P)abcKu=e(aP,bP)cKu,由加密过程可知,C+是Ku的合法密文.如果v=1,则ZvKu=e(P,P)zKu.由z的随机性可知,A不能得到关于u的任何信息.Guess:收到A的猜测u后,如果u=u,B输出(P,aP,bP,cP,Zv)作为正确的BDDH组,否则输出(P,aP,bP,cP,Z1-v).下面,我们来分析B的优势.如果v=1,A不能得到关于u的任何信息.因此,有Prob[u=u|v=1]=Prob[u≠u|v=1]=12,并且B猜测正确的BDDH组的成功概率是Prob[Bsuccess|v=1]=1如果v=0,B返回Ku的合法密文.由定理中所述的条件,A攻击本文方案的优势为ε.因此,Prob[u=u|v=0]=1组的成功概率为Prob[Bsuccess|v=0]=1因此,B区分BDDH组的优势为Prob[Bsuccess]-1Prob[v=1andBsuccess]-1=1=1由此可见,攻击者能够成功攻破密钥k等价于能够成功求解BDDH困难问题,这在计算上是不可行的.在传统公钥加密算法(如RSA)中,有这样一个安全要求,即通过公钥无法计算其对应的私钥信息.同样,对应于本文的单方加密-多方解密方案,要求保证解密者无法恢复加密者的私钥信息.下面我们来说明这个问题.定理3.解密者或多个解密者联合无法恢复发送者的加密密钥SS.证明.首先,我们证明单一解密者无法恢复发送者的加密密钥SS.在本文方案中,通过随机选取a+b-1次多项式f(x)∈Zp[x]并将其用来在a+bn个碎片中隐藏或共享发送者的私钥SS.由Shamir的门限秘密共享的性质可知,在a+bn个碎片中任取a+b个可以恢复主秘密SS,但少于a+b个就得不到关于SS的任何信息.而通过公开参数犛求取关于多项式的信息是不可行的,面临求解G1上椭圆曲线离散对数问题的困难性.很显然,每个接收者具有有关碎片的个数b<a+b(a和b均为正整数),因此,任何一个解密者Ri不能恢复发送者主密钥SS.其次,我们证明本文方案还可以防止合谋攻击,即可以防止多个接收者联合试图获取发送者的主密钥SS.可以看到,发送者给予每个接收者关于多项式f(x)的子秘密都是非直接结果,都是如等式(2)的计算结果.要根据这些结果由f(vi,j)(Q1+Q2)求取f(vi,j)(i=1,2,…,n;j=1,2,…,b)面临G1上椭圆曲线离散对数的困难性.因此,看似多个接收者合作可以占有多达a+b个子信息,但由于它们不是真正的子秘密,所以,任意多个接收者联合试图获取发送者的主密钥SS都是计算上不可行的.同样,上述单个接收者试图获取发送者的主密钥SS也将面临这种困难性.综上所述,解密者或多个解密者联合恢复发送者的加密密钥SS在计算上是不可行的.证毕.Page6最后,需要说明的是,本文方案还具有前向保密性[11],也就是说,即使发送者的主密钥SS泄露,也不会影响之前发送的消息的保密性.由加密过程的步2可知,密钥k的值由SS和秘密随机数r共同控制,即使能够获取SS,但由于不知道r的值,要求取密钥k是不可行的.同样,由解密过程的步2可知,没有解密私钥,即使知道SS也无法计算密钥k.由此可见,发送者的主密钥SS泄露不会对先前的保密信息造成任何安全影响.4.3性能分析本小节将主要分析本文方案的实现性能以及与现有方案的优缺点比较.首先,给出相关的通信复杂度和运算复杂度分析;然后,介绍方案中安全参数选取对方案实现性能的影响;最后,通过将本文方案与现有方案进行比较来说明本文方案在设计方面的新特点.4.3.1通信复杂度对于通信复杂度来说,在本文方案实现和应用中,加密者需要广播发送其加密的密文给各解密者,其密文形式为(P,Q1,U,c,I,犛).假设群G1和G2的长度为l1,对称加密算法的输出长度为l2,Hash算法hk(·)的输出长度为l3,则通信复杂度为(a+3)×l1+l2+l3.而在系统初始化过程中,发送者需要向各接收者广播系统公共参数(p,G1,G2,e,P,QS,Q1,Q2,犛,犚1,…,犚n,犛)并为他们分发私钥.其中,椭圆曲线参数以及发送者公钥(p,G1,G2,e,P,QS)的广播和对各接收者分配解密私钥是任何椭圆曲线公钥算法中所必需的最基本通信内容,这些通信量不是本文方案所特有的,我们仅分析本文方案所特有的通信量.在本文方案初始化过程中,仅(Q1,Q2,犛,犚1,…,犚n,犛)是相对现有方案所特有的通信量,其复杂度为(2a+bn+2)×l1.这里a和b的选取不影响系统安全性,当a=2和b=1时,通信复杂度仅为(n+6)×l1,与接收者数目n成线性关系.4.3.2运算复杂度在方案实现中,最费时的运算是椭圆曲线上的双线性对运算,因此,方案的运算复杂度将忽略对称加表1本文方案与现有方案的性能比较文献[3]和[4]中的方案公钥加密算法对现有算法进行扩展文献[5]的方案ElGamal公钥算法采用随机重用技术文献[6]的方案公钥加密算法采用基于ID的公钥思想本文方案对称加密算法采用秘密共享技术可证明安全、基于对称加密算法密和Hash运算,另外,e(QS,Q2)可以预计算,其复杂性也可以忽略.加密过程中:需要进行a+2次椭圆曲线点群G1上的倍点运算,包括计算(P,Q1,犛),和一次乘法群G2上的指数运算(即计算e(QS,Q2)r),因此,可以记运算复杂度为a+3;加密过程中:需要进行a+b次点乘运算(计算σv0,i,Γ(0)rf(v0,i)P,1ia和σvi,j,Γ(0)f(vi,j)(Q1+Q2),1jb)和三次G2中的运算(两次乘法和一次除法)即可,因此,可以记运算复杂度为a+b+3.同样,当选取a=2和b=1时,加密运算复杂度仅为5,解密运算复杂度仅为6.4.3.3安全参数对性能的影响通过前面的分析我们可以看出,本文方案的通信复杂度和运算复杂度是和参数a、b保持线性关系.在本文方案中,参数a和b主要用来调节所采用的多项式f(x)∈Zp[x]的次数以及各参与者的密钥长度,但通过前面的安全性和正确性分析发现,a和b值的选取不会对系统安全性造成影响.为了达到更高的方案性能,我们可以适当选取a和b的取值.特别地,可以令a=b=1,这时系统的性能会得到很大提高:通信复杂度为4×l1+l2+l3;加密运算复杂度为4;解密运算复杂度为5.但是,如果a=b=1,f(x)将为一次多项式,这会导致子秘密之间存在一些线性的性质.在许多地方都要求避免这种线性问题,因此,一般可以令a+b>2.例如:当a=2,b=1时,运算复杂度和通信复杂度能够保持足够小:通信复杂度为5×l1+l2+l3;加密运算复杂度为5;解密运算复杂度为6.另外,值得注意的是,研究者已经提出了很多优化算法以降低对运算开销,比如Scott等人在文献[12]中的研究表明,利用优化的算法和特定的椭圆曲线可以在主频为32MHz的智能卡上以不高于0.2s的时间完成一次对运算,这更能从本质上提高本文方案的实现效率.4.3.4与现有方案的比较为了便于说明本文方案的设计特点以及在性能方面的优势,我们通过表1将本文方案和现有类似方案做一简单比较.Page7单方加密-多方解密概念最初是由Baudron等人[3]和Bellare等人[4]提出的,由表1可以看出,他们的方法都是基于传统的公钥加密体制,如RSA等,主要缺点是加密效率低,对通信带宽要求高.文献[5]采用随机重用技术基于ElGamal公钥加密算法对其做了改进,但其运算效率相对于应用需求来说还是较低.文献[6]基于身份的公钥算法提出了一个新的方案,但其安全性受到了质疑,无法确保其安全性[7].本文方案采用秘密共享思想,基于对称算法提出了一种新的解决方案,能够避免现有方案基于公钥加密算法引起的加密运算复杂性较大的缺点.另外,对于通信带宽,由于系统参数初始化过程可以离线(off-line)方式操作,而在加密过程和解密过程中,用户之间均无需交互信息,因而,不再对通信带宽有较高要求.本文主要贡献是提供了一种构造单方加密-多方解密算法的新思想,首次给出了基于对称加密算法的实现方案.对称算法的高效性和加密过程的非交互性使得本文方案在计算性能和通信带宽方面都有了很大的改善.5结论本文借鉴门限秘密共享的思想,以对称密码算法为加密基础,基于双线性变换提出了一个可具有多个接收者的公钥加密方案,并对所提出的加密方案进行了正确性、安全性和性能分析.该加密方案具有非常重要的应用前景,例如在付费广播业务中,广播中心可以加密广播内容,在用户注册、申请并付费后,可以提供给他一个解密私钥来解密广播内容,而非授权的接收者因为没有解密密钥而将无法获取广播信息;在圆桌会议上,可以实现会议密钥的安全分发.该方案能够解决目前通信网络中广播/组播会话密钥协商和广播/组播加密等问题,可应用于无线局域网、无线城域网、无线传感器网络等多种形式无线网络和有线网络,是一种安全有效的解决方案.
