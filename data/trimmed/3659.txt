Page1连续属性完全贝叶斯分类器的学习与优化王双成1),2)杜瑞杰1)刘颖1)1)(上海立信会计学院数学与信息学院上海201620)2)(上海立信会计学院开放经济与贸易研究中心上海201620)摘要针对连续属性朴素贝叶斯分类器不能有效利用属性之间的条件依赖信息,而依赖扩展又很难实现属性条件联合密度估计和结构学习协同优化的问题,文中在使用多元高斯核函数估计属性条件联合密度的基础上,建立了具有多平滑参数的连续属性完全贝叶斯分类器,并给出将分类准确性标准与区间异步长划分完全搜索相结合的平滑参数优化方法,再通过时序扩展构建了动态完全贝叶斯分类器.我们使用UCI机器学习数据仓库中连续属性分类数据和宏观经济数据进行实验,结果显示,经过优化的两种分类器均具有良好的分类准确性.关键词连续属性;完全贝叶斯分类器;动态完全贝叶斯分类器;高斯核函数;平滑参数1引言贝叶斯分类器是一个基础概率分类器,它使用Page2性,这样便产生一系列贝叶斯分类器的衍生分类器.朴素贝叶斯分类器(naiveBayesclassifiers,简记为NBC)是最简单的衍生分类器,它以高效率和良好的分类准确性而著称,被广泛用于医疗诊断、文本分类、邮件过滤和信息检索等.NBC基于一个很强的条件独立性假设,这使得属性之间的条件依赖信息无法得到有效的利用,而这部分信息往往也是分类的重要信息.鉴于此,对NBC的依赖扩展便成为贝叶斯分类器衍生分类器的重要研究内容.其中对离散属性NBC的依赖扩展研究较多,如Chow和Liu[1]的依赖树、Friedman和Geiger等人[2]的TAN(TreeaugmentednaiveBayes)分类器、Grossman和Domingos[3]的基于条件似然打分-搜索的贝叶斯网络分类器学习,Jing和Pavlovi'c等人[4]对TAN分类器的属性选择和参数集成、Webb和Boughton等人[5]对NBC的k阶依赖扩展的理论分析和对比实验(如果综合考虑分类器偏差、方差和学习效率,认为二阶依赖扩展分类器具有最好的性能)等.对于连续属性NBC,可采用两种处理方法:一种是连续属性的离散化,最终将其转化为离散属性的分类器问题;另一种是不离散化连续属性,但需要估计属性条件密度.两种方法各有优势和不足,第1种方法适用于具有较少类的大数据集,以保证属性条件概率得到可靠的估计;第2种方法更适合于多类较小数据集(估计属性条件密度不需要很多数据)的情况,能够避免由离散化所导致的信息丢失、引入噪声和类对属性的变化不够敏感等问题.连续属性NBC研究的两个核心问题是属性条件密度估计和属性之间条件依赖信息的利用.在属性条件密度估计方面,John和Langley[6]研究了使用经典的高斯函数和高斯核函数估计属性条件密度而得到的GaussianNaiveBayesClassifier和FlexibleBayesClassifier,并在UCI机器学习数据仓库中选择了一些具有连续属性的数据集,对这两个分类器与C4.5进行了分类准确性比较,结果基于高斯核函数的分类器优于高斯函数分类器,但不如C4.5,其主要原因是:使用高斯函数来估计属性条件密度可能与实际密度有较大的差距,而采用高斯核函数的估计又没有对拟合数据的程度进行控制,再有连续属性之间的依赖信息也得不到有效的利用,这些都会影响分类器的分类准确性.Pérez和Larranga等人[7-8]在John和Langley研究的基础上,为用于估计属性条件密度的高斯核函数引入单平滑参数(smoothingparameter),并使用MISE(MeanIntegratedSquareError)统计标准优化平滑参数,将经过平滑参数优化的分类器称为FlexibleNaiveBayesClassifier,实验结果显示,这种分类器的分类准确性优于FlexibleBayesClassifier和C4.5,其原因是平滑参数的优化使所估计的属性条件密度更接近于真实的密度,从而提高了分类器的分类准确性.Huang[9]对基于高斯核函数估计属性条件密度的NBC与支持向量机进行了比较,发现经过优化的NBC的分类准确性优于支持向量机,并将NBC用于信用风险预测.在连续属性之间依赖信息利用方面,李旭升和郭春香等人[10]基于似然打分对连续属性NBC进行了树结构的依赖扩展,使扩展后分类器的分类准确性有所改进.Pérez和Larranga等人通过连续属性的互信息计算对NBC进行依赖扩展,分别给出了对NBC进行树、k依赖和完全依赖扩展而得到的分类器,但在依赖扩展过程中,属性之间是否增加边取决于属性之间条件互信息的大小,这与对分类的贡献大小可能不一致,从而会影响分类准确性.目前,对连续属性贝叶斯分类器的衍生分类器虽有一些研究,但所建立分类器的分类准确性还有待提高.本文的主要贡献如下:(1)在0-1损失下证明连续属性贝叶斯分类器是最优分类器,并给出贝叶斯分类器衍生分类器家族的构成.(2)将多元高斯核函数用于属性条件联合密度估计,建立与贝叶斯分类器等价的连续属性完全贝叶斯分类器(FullBayesClassifier,FBC).(3)为连续属性完全贝叶斯分类器的每一个属性引入一个平滑参数,并给出平滑参数优化方法,从而实现属性之间依赖信息利用和属性条件联合密度估计优化的统筹兼顾.(4)将连续属性完全贝叶斯分类器与时间序列相结合,建立连续属性动态完全贝叶斯分类器(DynamicFullBayesClassifier,DFBC),并将其用于宏观经济指标波动转折点预测.我们使用UCI机器学习数据仓库①中连续属性分类数据和宏观经济数据进行实验,结果显示,经过优化的连续属性完全贝叶斯分类器和动态完全贝叶斯分类器均具有良好的分类准确性.本文第1节对贝叶斯分类器的衍生分类器的研①MurphySL,AhaDW.UCIrepositoryofmachinelearn-ingdatabases.http://www.ics.uci.edu/~mlearn/MLRe-Page3究现状进行评述;第2节给出连续属性贝叶斯分类器的最优性证明和贝叶斯分类器的衍生分类器家族的构成;第3节在使用多元高斯核函数估计属性条件联合密度的基础上,建立连续属性完全贝叶斯分类器和优化方法;第4节结合连续属性完全贝叶斯分类器与时间序列构建动态完全贝叶斯分类器;第5节是实验和分析;第6节是结论和进一步的工作.2连续属性贝叶斯分类器用X1,X2,…,Xn,C表示连续属性和类,x1,x2,…,xn,c为其值,D是具有N个记录的数据集,数据随机产生于混合分布P,xim(1in,1mN)和cm表示Xi和C在数据集D中第m个记录的观测值.用cF(x1,x2,…,xn)表示分类器F的分类结果,c(x1,x2,…,xn)为真正的结果.定义1.对连续属性分类器F,称pcFx1,x2,…,x((为F的平均0-1损失(或风险),使CR(F)最小的分类器称为最优分类器.定义2.对概率分布p(c,x1,x2,…,xn),称使用满条件分布p(c|x1,x2,…,xn)进行分类的分类器为贝叶斯分类器.定理1.在0-1损失下,连续属性贝叶斯分类图1贝叶斯分类器和它的衍生分类器在NBC结构中,属性结点除类父结点外没有属性父结点(给定类时,属性之间条件独立),这样可以得到p(x1,x2,…,xn|c)=∏n最多只能有一个属性父结点和一个子结点时,器是最优分类器.证明.设F和F分别为任意的分类器和连续属性贝叶斯分类器,对给定的情况x1,x2,…,xn,类C的可能取值为c1,c2,…,crc,记pi=p(ci|x1,x2,…,xn),p=max1ircp(cF(x1,x2,…,xn)=c(x1,x2,…,xn))p(cF(x1,x2,…,xn)=c(x1,x2,…,xn))因此,p(cF(x1,x2,…,xn)=c(x1,x2,…,xn))p(cF(x1,x2,…,xn)=c(x1,x2,…,xn)),从而CR(cF(x1,x2,…,xn))CR(cF(x1,x2,…,xn)),所以连续属性贝叶斯分类器是最优分类器.证毕.虽然连续属性贝叶斯分类器在理论上是最优分类器,但直接计算满条件概率p(c|x1,x2,…,xn)非常困难.根据概率公式,可得p(cx1,x2,…,xn)=p(c,x1,x2,…,xn)其中α是与C无关的量.式(3)将满条件概率p(c|x1,x2,…,xn)计算转化为类先验概率p(c)与属性条件联合密度p(x1,x2,…,xn|c)的计算问题.由对p(x1,x2,…,xn|c)计算方式的不同便产生了下面图1中列出的各种贝叶斯分类器的衍生分类器.p(x1,x2,…,xn|c)=∏n是Xi的属性父结点Ψ(Xi)的取值,得到的是链增强NBC;当属性结点最多只能有一个属性父结点,但可以有多个子结点时,p(x1,x2,…,xn|c)=∏nPage4π(xi),c),其中π(xi)是Xi的属性父结点Π(Xi)的取值,得到的是树增强NBC;当属性结点可以有多个属性父结点和子结点时(不能产生有向环),p(x1,x2,…,xn|c)=∏n属性父结点集Πi的配置,得到的是图(或网络)增强NBC;当属性结点之间构成完全有向无环图(不考虑条件独立关系),p(x1,x2,…,xn|c)=∏nx1,x2,…,xi-1,c),得到的是FBC,这种分类器能够充分利用属性之间的条件依赖信息,但易于导致对数据的过度拟合,需要对分类器与数据的拟合程度进行控制.3连续属性FBC定义3.对概率分布p(c,x1,x2,…,xn),称分类器或argmaxc(x1,x2,…,xn)p(c)p(x1,x2,…,xnc为完全贝叶斯分类器.推论1.在0-1损失下,连续属性完全贝叶斯分类器是最优分类器.FBC不施加任何条件独立性假设,这使得该分类器的结构是一个完全有向无环图(所有的完全有向无环图等价),如图2所示.与NBC一样,FBC也不需要结构学习,建立连续属性FBC的核心是属性条件联合密度估计与优化.3.1属性条件联合密度估计我们采用统计多元核函数方法[11]来估计属性条件联合密度,并在多元核函数中为每个属性引入一个平滑参数,通过平滑参数的调整来控制分类器与数据的拟合程度.用^p(x1x2…xn|c,D)表示在数据集D基础上的属性条件联合密度估计,基于统计多元核函数的属性条件联合密度估计一般形式为我们取Ki(·)为高斯核函数(也可以取其它的N(c)h1h2…hn∑N1其中Ki(·)和hi(i=1,2,…,n)分别是Xi的核函数和平滑参数,signa(cm)=1,cm=c核函数),即Kixi-ximh()i=g(xi;xim,hi),g(xi;xim,hi)=1^p(x1x2…xnc,D)=N(c)h1h2…hn∑N其中N(c)是训练集中C=c的情况数量.结合^p(c)=N(c)叶斯分类器对N+1情况的分类结果为c(x1(N+1),x2(N+1),…,xn(N+1))∑N除采用多元高斯核函数进行属性条件联合密度估计外,还可以使用多元高斯函数、扩展的多元高斯核函数和高斯Copula函数(从计算效率和可靠性方面考虑,扩展的高斯核函数中的平滑参数矩阵和高斯Copula函数中的协方差矩阵可采用三对角对称矩阵)等来估计属性条件联合密度,在实验部分分别给出了几种属性条件联合密度估计方法的对比实验.3.2属性条件联合密度优化基于多元高斯核函数估计属性条件联合密度的优化有许多统计方法(但需要某种分布的假设,如联合高斯分布等),我们通过对平滑参数的打分-搜索来实现属性条件联合密度的优化.以分类器的分类准确性为打分标准,搜索策略采用区间异步长划分完全搜索.分类准确性估计采用10折交叉有效性(10-foldcross-validation)验证方法,Kohavi[12]曾对各种常用的分类准确性估计方法进行过综合实验与统计分析,认为基于10折交叉有效性验证方法所进行的分类准确性估计更加可靠.平滑参数决定着做叠加的高斯函数曲线形状,因此能够控制所估计的属性条件联合密度与数据的拟合程度.随着平滑参数接近于零,所估计的属性条件联合密度会更加拟合数Page5据(也称为噪声估计),并会产生过度拟合现象(欠平滑);而随着平滑参数的增大,将使所估计的属性条件联合密度逐渐趋近于真实密度,直到取得最优平滑参数(具有最佳分类效果的平滑参数).如果平滑参数持续增大,所估计的属性条件联合密度对数据的拟合程度将继续下降,以至于会出现欠拟合(过平滑)现象.对于单平滑参数(h=h1=h2=…=hn)的完全贝叶斯分类器,采用区间异步长划分完全搜索方法发现最优平滑参数.一般根据实验确定平滑参数的界值hmin和hmax,十进位点将hmin,h[]max分成一些子区间,在这些子区间中的步长依次记为Δ1,Δ2,…(为提高效率,步长可逐渐增加),这样便可得到平滑参数的取值集合,通过以分类准确性为标准的遍历打分-搜索来发现最优平滑参数.对于具有多平滑参数的情况,首先根据Quinlan[13]的信息增益率为属性排序,其中的条件密度计算采用高斯核函数,平滑参数使用John和Langley的方法进行设置.采用单平滑参数的优化方法依次进行多平滑参数的优化(将单参数最优值作为多参数的初始配置),最终获得所有平滑参数的局部最优配置.3.3时间复杂性分析建立FBC的主要运算是计算高斯函数,因此,图3DFBC结构依据贝叶斯网络理论、概率公式和图3中所蕴含的条件独立性关系可得p(c[t]|c[1],c[2],…,c[t-1],x1[1],x2[1],…,=p(c[t]|c[t-1],x1[t],x2[t],…,xn[t])=p(c[t],c[t-1],x1[t],x2[t],…,xn[t])p(c[t-1],x1[t],x2[t],…,xn[t])=βp(c[t]|c[t-1])p(x1[t],x2[t],…,xn[t]|c[t])其中β是与c[t]无关的量.DFBC可表示为c[t](c[t-1],x1[t],x2[t],…,xn[t])p(c[t]c[t-1])p(x1[t],x2[t],…,xn[t]c[t{其中,p(c[t]|c[t-1])是类转移概率,p(x1[t],对确定的平滑参数hi,属性条件联合密度估计需要进行Nn次高斯函数计算.用M表示单平滑参数所有可能的取值数量,那么,在多平滑参数优化的过程中需要进行MNn2次高斯函数计算,而M是一个与N和n都无关的量,可以看做是一个常量,因此,建立最优多参数FBC的时间复杂度是O(Nn2).4连续属性DFBCDFBC是FBC与时间序列的结合,能够有效利用类的动态时序信息和时间片内属性之间的依赖信息,是多变量时间序列预测的有力工具.分别用Xi[1],Xi[2],…,Xi[T](1in)和C[1],C[2],…,C[T]表示属性和类序列,xi[1],xi[2],…,xi[T]和c[1],c[2],…,c[T]是具体的取值;D[1],D[2],…,D[T]是累计时间片数据集序列,D[1]D[2]…D[T],N[1],N[2],…,N[T]是对应时序数据集中的例子数量.4.1分类器结构和表示形式在DFBC结构中,类时间序列构成马尔科夫链,给定一个时间片内的类时,所属的时间片属性与其它时间片内的属性和类条件独立,图3给出的是DFBC结构.x2[t],…,xn[t]|c[t])为时间片属性条件联合密度.4.2分类准确性评价标准设有时序数据x1[1],x2[1],…,xn[1],c[1],…,x1[T],x2[T],…,xn[T],c[T],选择一个界值T0,T0的值可依据时间序列的大小T、类转移概率与条件密度估计的有效性或实际需要来确定.用accuracy(dfbc,ρ,D[T],T0)表示DFBC的分类准确率,ρ=(ρ1,ρ2,…,ρn),cprediction[t]是使用D[t-1]进行训练,并依据x1[t],x2[t],…,xn[t]的配置对c[t]的预测结果,ctrue[t]是真正的结果,那么accuracy(dfbc,ρ,D[T],T0)=其中Page6signb(cprediction[t],ctrue[t])=1,cprediction[t]=ctrue[t]5实验与分析首先,在UCI机器学习数据仓库中选择28个连续属性的分类数据集,删除具有丢失数据的记录,对属性数据进行规范化处理,数据集中记录的位置表1UCI数据集描述编号1Ae_train2Arabic_digit3Breast_cancer4Breast_tissue5Cardiotocography726271067Column_3c8Connectionist_Bench528101191011Heart_disease12Horse_colic13Image_segmentation20916714Ionosphere5.2分类准确性比较经过实验发现,平滑参数的峰值一般在0.001~0.1之间.取hmin=0.001,hmax=0.1,Δ1=0.001,Δ2=0.005,分别选择对连续属性离散化的NBC和TAN分类器(DNB,DTAN)、基于高斯函数估计属性条件密度的分类器(GNB)、John等人给出的分类器(FlexibleBayesClassifier,FLBC)、Pérez等人建立的使用MISE标准优化平滑参数的分类器(FlexibleNaiveBayesClassifier,FNBC)、单参数和多参数优化的朴素贝叶斯分类器(SNB,MNB)、使用高斯核函数进行属性之间条件信息计算的朴素贝叶斯分类器树结构依赖扩展分类器(CTAN)、C4.5、支持向量机(SVM)、基于具有三对角协方差矩阵多元高斯函数的完全贝叶斯分类器(GFBC)、具有三对角平滑参数矩阵的多元高斯核函数完全贝叶斯分类器(KFBC)、具有三对角协方差矩阵Copula函数的完全贝叶斯分类器(CFBC)、基于多元高斯核函数的具有单参数和多参数完全贝叶斯分类器(SFB,MFB),采用10折交叉有效性验证方法进行分类器的分类错误率估计,分类器的分类错误率实验结果如表2所示.从表2的总体平均值来看,经过多参数优化的也进行随机初始化,从不同分类器之间的分类准确性比较和平滑参数对分类准确性的影响两方面进行FBC的实验与分析;然后,再使用3个宏观经济指标时序数据集进行DFBC的实验与分析.5.1UCI数据集描述在所选择的UCI数据集中,对几个较大的数据集顺序截取其中的一部分数据,打号的数据集为经过截取的数据集,数据集的基本情况如表1所示.编号1516Liver_disease17Magic_Gamma_telescope71810218192021Sensor_reading22232425262728FBC相对于其它14个分类器具有优势的程度依次是8.23%、6.57%、18.97%、17.89%、14.36%、5.98%、2.43%、10.58%、4.87%、22.69%、9.84%、6.89%、4.87%和3.87%,这显示了经过多参数优化的FBC具有良好的分类准确性,在多类值的数据集中尤其如此.总的来看,FBC优于NBC,这说明FBC能够有效地利用属性之间的依赖信息,提高了分类器的分类准确性.使用表2中的数据所绘制的FBC与其它分类器,关于28个数据集的分类错误率比较散点图如图4所示.图中每一个点的坐标是用于比较的两个分类器的分类错误率,在45°线上方、下方和线上的点分别表示经过多平滑参数优化的完全贝叶斯分类器分类错误率小于、大于和等于用于比较的分类器.从图4中的14个比较图来看,多参数FBC的分类准确率优于其它分类器,在28个数据集中分类准确性占优的百分比依次是92.85%、75.00%、96.42%、96.42%、100.00%、82.14%、53.57%、85.71%、82.14%、100.00%、85.71%、92.85%、78.57%和89.28%.其中具有最小百分比的是MNB,可见,经过优化的MNB也具有良好的分类准确性.Page7图4分类错误率比较散点图Page8表2分类器之间的错分率实验结果数据集DNBDTANGNBFLBCFNBCSNBMNBCTANC4.5SVMGFBCKFBCCFBCSFBMFBAe_train0.26500.26240.20390.20650.19620.18580.17670.15320.20760.19690.18970.09230.18060.08580.0743Arabic_Digit0.27400.27950.34940.32470.34940.32470.31100.27260.32330.23110.27400.23980.32330.22200.1973Breast_cancer0.03580.04860.03720.02580.03770.02430.02430.05000.06010.03720.05720.05580.02430.03770.0286Breast_tissue0.29000.32000.37000.61000.56000.28000.24000.31000.34910.59360.29000.37000.31000.30000.2400Cardiotocography0.25420.23890.54200.62920.58200.32230.24170.43330.21180.71580.38270.36530.30840.27090.1889Cmc0.32850.32710.35040.34020.34750.33950.33360.32700.31760.37220.37450.38840.32780.32120.3154Column_3C0.22590.18710.51620.32260.26780.23230.15810.16770.19350.33550.18390.22910.22910.23550.1549Connectionist_Bench0.40390.38660.33850.42510.26350.18080.13850.22880.21020.65350.54240.02890.18270.02500.0135Ecoli0.10350.10000.07940.08630.06560.06560.04490.06890.09940.12370.07940.06900.04830.06210.0552Glass0.34290.30000.50960.52390.46200.33340.31970.53330.35990.64270.46200.40000.29530.34290.3096Heart_disease0.13340.14450.14080.15930.16670.15550.14080.15550.22600.16670.15190.16670.15560.16300.1445Horse_colic0.28340.28340.34000.33340.34000.32670.30000.36000.31330.33000.29340.30000.30670.29670.2367Image_Segmentation0.14500.13500.23000.28000.23000.13000.07500.22000.11450.49740.15000.19500.14000.12000.1000Ionosphere0.25720.28580.53720.35720.36290.35720.32580.52000.23490.35810.28000.33720.29720.36290.2315Iris0.04000.04000.04000.04670.04670.03340.03340.02670.04670.06010.02000.03340.03340.03340.0267Liver_disease0.30000.28830.44710.39420.37650.37650.34710.41170.32760.42200.30300.37360.33830.35300.3500MAGIC_Gamma0.25220.28170.37090.31980.31980.31980.28620.31980.18940.24220.29300.34790.24510.25080.1958New_thyroid0.04540.04540.05000.10460.08640.03190.02730.05450.09310.18590.08640.06820.04100.04100.0410Parkinsons0.16500.12000.30500.19000.16000.11000.07500.26000.12830.25000.16000.09000.10500.07000.0350Pima0.23900.23560.24810.26110.26110.26110.23770.24410.26570.23820.27150.29490.23770.24030.2377Sensor_readings0.15560.12450.39340.33560.30670.17560.12670.36880.05710.38830.31560.26000.18000.24230.1512Spambase0.16840.14170.39000.38670.36000.16500.13170.15660.16100.38980.18170.15510.16500.24170.1534Statlog0.16570.12300.17640.12520.09320.07260.05650.17700.04960.11680.16490.08250.07260.03440.0252Transfusion0.24140.20400.25070.31600.31600.31600.23470.31600.23000.23820.30810.26400.22670.22400.2240Wine0.14120.12950.02950.05300.04120.02360.01770.017740.10120.04450.05180.00000.02360.04120.0236Wdbc0.04470.03750.06610.06610.05900.05900.04830.05890.07390.06540.01180.08220.05720.03220.0233Wpbc0.42000.36500.42500.27000.27500.18580.17670.15320.20760.23620.20000.22000.22500.23000.2300Yeast0.45480.40070.40880.47100.41150.32470.31100.27260.32330.61550.41760.39190.39800.37840.3717平均值0.22060.20840.29090.28440.26230.20400.17640.23710.19560.31240.23200.21080.19560.18780.1564峰值或高原区间.在0.001~0.1范围内,对5个数据集,分类准确率的最大变化跨度依次是32.87%、54.75%、18.58%、33.33%和13.67%,可见单平滑参数变化对分类器的分类准确性有较大的影响,因为所描述的是所有属性对分类的影响.(2)多平滑参数中单参数变化的影响在5个数据集中,依次选择平滑参数h2、h2、h4、h24和h20.对每一个数据集,除选择的平滑参数外,其它参数取单参数优化后的最优值,所选择的参数变化对分类器分类准确性的影响情况如图6所示.5.3平滑参数变化对分类准确性的影响选择Column_3c、Connectionist_Bench、Glass、Sensor_reading和Spambase这5个数据集,分别从单参和多参变化两方面进行平滑参数对分类准确性的影响程度计算与分析,如图5和图6所示,其中a1=0.001,…,a9=0.009,a10=0.01,a11=0.015,…,a28=0.1.(1)单平滑参数变化的影响单平滑参数(h=h1=h2=…=hn)变化对FBC分类准确性的影响情况如图5所示.从图5能够看到,随着平滑参数的变化,分类器的分类准确率一般也在发生变化,曲线都有明显的图6多平滑参数中的单参数对分类准确性的影响从图6的总体来看,多参数中的单参变化相对更加平缓(个别情况变化较大),但它们的累积影响往往Page9大于单参数,也就是通过局部调整会使所估计的属性条件联合密度更接近于真实密度,从而使经过优化的具有多平滑参数FBC具有更好的分类准确性.5.4DFBC的分类准确性比较选择与GDP(GrossDomesticProduct)、ERF(ExchangeRateFluctuations)和EC(EnergyCon-sumption)相关的3个宏观经济指标集,从国家统计局和相关数据源获取时序数据,时序数据记录数量依次是20、31和25.将3个数据集中的国内生产总值、表3GDP波动转折点预测分类器T0=9T0=10T0=11T0=12T0=13T0=14T0=15T0=16T0=17T0=18T0=19CRF36.3640.0044.4450.0057.1466.6660.0050.0033.3350.000.00GDNB45.4550.0055.5562.5071.4266.6660.0050.0033.3350.000.00SKDNB63.6370.0077.7787.5085.7183.3380.0075.0066.66100.00100.00MKDNB81.8190.00100.00100.00100.00100.00100.00100.00100.00100.00100.00MKDFB81.8190.00100.00100.00100.00100.00100.00100.00100.00100.00100.00表4ERF波动转折点预测分类器T0=20T0=21T0=22T0=23T0=24T0=25T0=26T0=27T0=28T0=29T0=30CRF54.5460.0066.6675.0071.4283.3380.0075.0066.6650.000.00GDNB36.3640.0033.3337.5042.8550.0040.0050.0033.330.000.00SKDNB54.5460.0055.5562.5071.4266.6660.0075.0066.6650.000.00MKDNB63.6360.0066.6675.0085.71100.00100.00100.00100.00100.00100.00MKDFB63.6370.0077.7787.50100.00100.00100.00100.00100.00100.00100.00表5EC波动转折点预测分类器T0=14T0=15T0=16T0=17T0=18T0=19T0=20T0=21T0=22T0=23T0=24CRF81.8180.0077.7775.0071.4266.6660.0050.0066.6650.000.00GDNB54.5460.0055.5550.0057.1466.6660.0050.0066.6650.000.00SKDNB72.7270.0077.7775.0071.4266.6660.0050.0066.6650.000.00MKDNB81.8180.0088.8887.50100.00100.00100.00100.00100.00100.00100.00MKDFB81.8180.0088.88100.00100.00100.00100.00100.00100.00100.00100.00从表3到表5综合来看,经过多参优化的动态朴素贝叶斯分类器,在分类准确率方面优于前面的分类器,而经过多参优化的动态完全贝叶斯分类器还要好于动态朴素贝叶斯分类器.可见,动态完全贝叶斯分类器同样具有良好的分类准确性.6结论和进一步的工作本文在使用具有多平滑参数的多元高斯核函数来估计属性条件联合密度的基础上,建立了能够有效利用属性之间条件依赖信息的完全贝叶斯分类器和动态完全贝叶斯分类器,并给出了将分类准确性标准与平滑参数区间异步长划分完全搜索相结合的分类器优化方法,使属性条件依赖信息利用和属性条件密度估计优化能够统筹兼顾.使用UCI机器学习数据仓库中连续属性分类数据和宏观经济数据的实验结果显示,经过优化的完全贝叶斯分类器和动实际有效汇率指数和能源消费总量,按照是否为时序转折点(时序变化的上下局部极值点为转折点)进行二值离散化作为类变量,进行动态分类准确性实验.分别采用条件随机场(CRF)[14],对基于高斯函数、单平滑参数高斯核函数和多平滑参数高斯核函数估计属性条件密度的动态朴素贝叶斯分类器(GDNB、SKDNB和MKDNB),具有多平滑参数的动态完全贝叶斯分类器(MKDFB)进行比较,T0依次选取后11个时间点,情况如表3到表5所示.态完全贝叶斯分类器具有良好的分类准确性.但以分类准确性为标准的分类器优化对大数据集会存在效率问题,而且多参数贪婪搜索也可能导致局部最优的问题,我们进一步的研究工作是如何提高学习效率和实现多平滑参数的全局优化.
