Page1/ 犔/ 犚/ (/ 犽/ )/ 任意/ 文法/ 位置/ 的/ 断点/ 调试/ 方法/ 许/ 福金/ 茂忠/ 李虎/ 宋淼/ (/ 北京航空航天大学/ 软件工程/ 研究所/ 北京/ 100191/ )/ 摘要/ LR/ (/ k/ )/ 文法/ 能/ 描述/ 所有/ 确定/ 型/ 上下文/ 无关/ 语言/ ,/ 广泛应用/ 于/ 各类/ 分析器/ 生成器/ 中/ ./ 传统/ 的/ LR/ (/ k/ )/ 文法/ 断点/ 调试/ 方法/ 仅/ 支持/ 在/ 产生/ 式/ 右部/ 末尾/ 设置/ 断点/ (/ 后文/ 简称/ 尾部/ 断点/ )/ ,/ 不/ 支持/ 在/ 产生/ 式/ 右部/ 中间/ 位置/ 设置/ 断点/ (/ 后文/ 简称/ 中间/ 断点/ )/ ,/ 这/ 给/ 分析器/ 的/ 开发/ 和/ 调试/ 带来/ 了/ 不便/ ./ 文中/ 提出/ 了/ 一种/ 新颖/ 的/ LR/ (/ k/ )/ 文法/ 断点/ 调试/ 方法/ ,/ 不但/ 支持/ 传统/ 的/ 尾部/ 断点/ ,/ 还/ 支持/ 中间/ 断点/ ./ 该/ 方法/ 可/ 显著/ 增加/ 可/ 利用/ 的/ 断点/ 数量/ ,/ 可以/ 跟踪/ 到/ 更/ 细粒度/ 的/ 文法/ 成分/ ,/ 从而/ 帮助/ 用户/ 更好/ 地/ 进行/ 文法/ 调试/ ,/ 降低/ 分析器/ 的/ 开发/ 难度/ ./ 关键词/ LR/ (/ k/ )/ 文法/ ;/ 文法/ 调试/ ;/ 断点/ 调试/ 1/ 引言/ LR/ (/ k/ )/ 文法/ 广泛应用/ 于/ 计算机/ 语言/ 的/ 语法/ 定义/ ,/ 它/ 只/ 要求/ 向前/ 看/ k/ 个/ 符号/ 即能/ 做/ 正确/ 的/ 自/ 左/ 至/ 右/ 的/ 语法/ 分解/ ,/ 在/ 各类/ 分析器/ 生成器/ 中有/ 广泛应用/ ./ 由于/ 分析器/ 开发/ 的/ 复杂性/ ,/ 目前/ 绝大多数/ 分析器/ 都/ 是/ 通过/ 分析器/ 自动/ 生成/ 工具/ 生成/ 的/ ,/ 越来越/ 多/ 的/ 普通/ 软件/ 开发者/ 利用/ 分析器/ 生成器/ 来/ 构造/ 各种/ 程序/ 分析/ 工具/ [/ 1/ ]/ ./ 与/ 分析器/ 设计/ 领域/ 的/ 专家/ 不同/ ,/ 普通/ 开发/ LL/ (/ k/ )/ 文法/ 采用/ 自顶向下/ 的/ 递归/ 下降/ 分析方法/ ,/ 文法/ 和/ 分析器/ 间/ 有/ 明显/ 的/ 结构/ 对应/ 关系/ ,/ 可以/ 借助/ 传统/ 的/ 源码/ 调试/ 工具/ (/ 如/ GNUgdb/ [/ 2/ ]/ )/ 进行/ 调试/ ./ 然而/ ,/ 对于/ LR/ (/ k/ )/ 文法/ ,/ 却/ 没有/ 类似/ 的/ 源码/ 调试/ 工具/ 可用/ ./ 这/ 是因为/ LR/ (/ k/ )/ 文法/ 采用/ 自/ 底向上/ 的/ 分析方法/ ,/ 文法/ 和/ 分析器/ 间/ 没有/ 明显/ 的/ 结构/ 对应/ 关系/ ,/ 利用/ 源码/ 调试/ 工具/ 难以实现/ 分析器/ 源码/ 和/ 对应/ 文法/ 的/ 直观/ 结构/ 映射/ 关系/ ./ LL/ (/ k/ )/ 文法/ 只是/ LR/ (/ k/ )/ 文法/ 的/ Page2/ 子类/ ,/ 与/ LL/ (/ k/ )/ 相比/ ,/ LR/ (/ k/ )/ 可以/ 处理/ 左/ 递归/ ,/ 能/ 描述/ 所有/ 确定/ 型/ 上下文/ 无关/ 语言/ ,/ 因而/ 绝大多数/ 的/ 分析器/ 生成器/ 均/ 基于/ LR/ (/ k/ )/ (/ 或/ 其子/ 类/ )/ 文法/ ,/ 因此/ 有/ 必要/ 研究/ 适用/ 于/ LR/ (/ k/ )/ 文法/ 的/ 调试/ 技术/ ./ 2/ 基本/ 定义/ 本文/ 假定/ 读者/ 具有/ 文法/ 、/ 语言/ 和/ 程序/ 分析/ 方面/ 的/ 基础知识/ ,/ 有关/ 内容/ 可/ 参见/ 文献/ [/ 3/ -/ 6/ ]/ ./ 下面/ 介绍/ 本文/ 用到/ 的/ 几个/ 相关/ 定义/ ./ 定义/ 1/ ./ 上下文/ 无关/ 文法/ ./ 上下文/ 无关/ 文法/ 是/ 一个/ 四元组/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ ./ 其中/ ,/ N/ 是非/ 终结符/ 的/ 有限/ 集/ ,/ T/ 是/ 终结符/ 的/ 有限/ 集/ ,/ T/ ∩/ N/ =/ / ;/ P/ 是/ 形如/ A/ →/ β/ 的/ (/ 重写/ )/ 规则/ 的/ 有限/ 集/ ,/ A/ 称为/ 规则/ 左部/ ,/ β/ 称为/ 规则/ 右部/ ;/ S/ ∈/ N/ ,/ 是/ 文法/ 的/ 开始符号/ ./ 定义/ 2/ ./ LR/ (/ k/ )/ 文法/ ./ LR/ (/ k/ )/ 文法/ 是/ 上下文/ 无关/ 文法/ 的/ 真/ 子集/ ,/ 可以/ 描述/ 所有/ 确定/ 型/ 上下文/ 无关/ 语言/ ,/ 它/ 采用/ 自/ 底向上/ 的/ 移进/ -/ 归约/ 分析方法/ ,/ 只/ 要求/ 向前/ 看/ k/ 个/ 符号/ 即能/ 做/ 自/ 左/ 至/ 右/ 的/ 语法/ 分解/ ./ 定义/ 3/ ./ 文法/ 位置/ 、/ 主要/ 位置/ 、/ 衍生/ 位置/ ./ 文法/ 位置/ 是/ 一个二元/ 组/ [/ i/ ,/ j/ ]/ ,/ 其中/ i/ 表示/ 产生/ 式/ 编号/ ,/ j/ 表示/ 产生/ 式/ 右部/ 第/ j/ 个/ 符号/ 后/ 的/ 位置/ ,/ j/ 的/ 取值/ 范围/ 为/ 0/ / j/ / (/ 产生/ 式/ i/ 右部/ 符号/ 数目/ )/ ./ 文法/ 开始符号/ 所在/ 的/ 产生/ 式/ 编号/ 为/ 0/ ,/ 其它/ 产生/ 式/ 采用/ 非/ 重复/ 的/ 递增/ 顺序/ 编号/ ./ 文法/ 位置/ [/ 0/ ,/ 0/ ]/ 和/ [/ i/ ,/ j/ ]/ (/ j/ / 1/ )/ 称为/ 主要/ 位置/ ,/ 文法/ 位置/ [/ i/ ,/ 0/ ]/ (/ i/ / 1/ )/ 称为/ 衍生/ 位置/ ./ 图/ 2/ 给出/ 了/ 图/ 1/ 文法/ 对应/ 的/ 文法/ 位置/ ./ 定义/ 4/ ./ 项目/ 、/ 初始/ 项目/ 、/ 主要/ 项目/ 、/ 衍生/ 项目/ ./ 文法/ G/ 的/ 项目/ 是/ 一个/ 三元组/ [/ i/ ,/ j/ ,/ γ/ ]/ ,/ 其中/ [/ i/ ,/ j/ ]/ 表示/ 文法/ 位置/ ,/ γ/ 表示/ 向前/ 看/ 符号/ 集/ ./ 项目/ [/ i/ ,/ j/ ,/ γ/ ]/ 也/ 可以/ 表示/ 为/ A/ →/ α/ ·/ β/ {/ γ/ }/ ./ [/ 0/ ,/ 0/ ,/ $/ ]/ 称为/ 文法/ 的/ 初始/ 项目/ ./ 项目/ [/ i/ ,/ j/ ,/ γ/ ]/ 是/ 一个/ 主要/ 项目/ 当且/ 仅/ 当/ [/ i/ ,/ j/ ]/ 是/ 一个/ 主要/ 位置/ ,/ 项目/ [/ i/ ,/ j/ ,/ γ/ ]/ 是/ 一个/ 衍生/ 项目/ 当且/ 仅/ 当/ [/ i/ ,/ j/ ]/ 是/ 一个/ 衍生/ 位置/ ./ 定义/ 5/ ./ 空非/ 终结符/ ./ 空非/ 终结符/ 是/ 一个/ 特殊/ 的/ 非/ 终结符/ ,/ 它/ 唯一/ 出现/ 在/ 文法/ 中/ 的/ 某条/ 规则/ 左部/ ,/ 该/ 规则/ 右部/ 为/ 空/ 字符串/ ε/ ./ 3/ 断点/ 类型/ 判定/ 算法/ 传统/ 的/ LR/ (/ k/ )/ 文法/ 断点/ 调试/ 方法/ 仅/ 支持/ 尾部/ 断点/ ,/ 不/ 支持/ 中间/ 断点/ ,/ 这是/ LR/ (/ k/ )/ 分析方法/ 的/ 一个/ 固有/ 属性/ ,/ 因为/ 断点/ 可/ 被/ 视为/ 特殊/ 的/ 语义/ 动作/ ,/ 而/ 标准/ 的/ LR/ (/ k/ )/ 分析方法/ 只/ 支持/ 在/ 产生/ 式/ 末尾/ (/ 即/ 在/ 执行/ 归约/ 动作/ 时/ )/ 调用/ 语义/ 动作/ ,/ 不/ 支持/ 在/ 产生/ 式/ 右部/ 中间/ 位置/ 调用/ 语义/ 动作/ [/ 3/ ]/ ,/ 这/ 给/ 分析器/ 的/ 开发/ 和/ 调试/ 带来/ 了/ 不便/ ./ 在/ 产生/ 式/ 右部/ 中间/ 位置/ 设置/ 断点/ ,/ 是/ 很多/ 程序设计/ 语言/ 分析/ 和/ 处理/ 中/ 的/ 一个/ 常见/ 需求/ ,/ 例/ 1/ 给出/ 了/ 一个/ 例子/ ./ 例/ 1/ ./ 图/ 3/ 是/ 一段/ 典型/ 的/ C语言/ if/ 判断/ 语句/ ,/ 其/ 对应/ 的/ 汇编/ 代码/ 如图/ 4/ 所示/ ./ 其中/ 的/ a/ ‖/ b/ 为/ 逻辑/ 表达式/ 语句/ ,/ C/ 语义/ 规定/ ,/ 先/ 计算/ a/ 的/ 值/ ,/ 如果/ a/ 为/ 真/ ,/ 则/ 逻辑/ 表达式/ a/ ‖/ b/ 也/ 为/ 真/ ,/ 不再/ 进一步/ 计算/ b/ 的/ 值/ ,/ 图/ 4/ 地址/ 0040D43D/ 和/ 0040D441/ 处/ 的/ 语句/ 说明/ 了/ 这点/ ./ “/ cmpdwordptr/ [/ ebp/ -/ 4/ ]/ ,/ 0/ ”/ ,/ 首先/ 比较/ “/ dwordptr/ [/ ebp/ -/ 4/ ]/ ”/ (/ 即/ 变量/ a/ )/ 的/ 值/ 是否/ 为/ 0/ ,/ 如果/ 不为/ 0/ ,/ 则/ 表达式/ a/ ‖/ b/ 的/ 值/ 为/ 真/ ,/ 直接/ 执行/ “/ jnemain/ +/ 39h/ (/ 0040d449/ )/ ”/ ,/ 跳转/ 到/ 地址/ 0040D449/ 处/ ,/ 执行/ “/ movdwordptr/ [/ ebp/ -/ 0Ch/ ]/ ,/ 1/ ”/ (/ 即/ 执行/ 语句/ c/ =/ 1/ )/ ./ 图/ 5/ 给出/ 了/ a/ ‖/ b/ 对应/ 的/ 逻辑/ 表达式/ 语句/ 的/ 产生/ 式/ 规则/ ./ 若要/ 开发/ 一个/ C语言/ 动态分析/ 程序/ ,/ 计算/ 逻辑/ 表达式/ a/ ‖/ b/ 的/ 值/ ,/ 就/ 需要/ 在/ ‖/ 前/ 设置/ 断点/ (/ 图/ 6/ )/ ./ Page3/ 通过/ 对/ 文法/ 进行/ 简单/ 变换/ ,/ 给/ 其/ 引入/ 空非/ 终结符/ ,/ 则/ 可以/ 使/ 标准/ 的/ LR/ (/ k/ )/ 分析方法/ 支持/ 产生/ 式/ 右部/ 中间/ 位置/ 的/ 断点/ 调试/ ./ 比如/ ,/ 对于/ 图/ 5/ 所示/ 文法/ ,/ 可以/ 在/ 第一个/ expr/ 后/ 插入/ 一个/ 空非/ 终结符/ X/ ,/ 然后/ 在/ 新/ 添加/ 的/ 产生/ 式/ (/ 图/ 7/ 中/ 的/ 规则/ 2/ )/ 末尾/ 设置/ 断点/ ./ 空非/ 终结符/ 只/ 推导/ 出/ 空串/ ε/ ,/ 因此/ 插入/ 空非/ 终结符/ 后/ 得到/ 的/ 文法/ 与/ 原始/ 文法/ 识别/ 的/ 语言/ 相同/ ./ 然而/ ,/ 并/ 不是/ 所有/ 的/ 文法/ 位置/ 都/ 可以/ 插入/ 空非/ 终结符/ ,/ 在/ LR/ (/ k/ )/ 文法/ 的/ 某些/ 文法/ 位置/ 插入/ 空非/ 终结符/ ,/ 可能/ 会/ 引入/ 分析/ 冲突/ ,/ 导致/ 变换/ 后/ 的/ 文法/ 不是/ LR/ (/ k/ )/ 文法/ ,/ 造成/ 分析/ 算法/ 识别/ 失败/ ,/ 例/ 2/ 给出/ 了/ 一个/ 例子/ ./ 例/ 2/ ./ 图/ 1/ 所示/ 文法/ 是/ LR/ (/ 1/ )/ 文法/ ,/ 如果/ 在/ “/ 规则/ 1/ ”/ 右部/ 的/ 符号/ E/ 之前/ 插入/ 空非/ 终结符/ X/ ,/ 将/ 导致/ 变换/ 后/ 的/ 文法/ 不再/ 是/ LR/ (/ k/ )/ 文法/ (/ 图/ 8/ )/ ./ 由/ 语义/ 处理/ 需要/ 而/ 插入/ 的/ 空非/ 终结符/ ,/ 如果/ 导致/ 了/ 语法分析/ 冲突/ ,/ 一般/ 有/ 两种/ 处理/ 策略/ :/ (/ 1/ )/ 只/ 执行/ 与/ 分析树/ (/ 分析/ 森林/ )/ 构造/ 有关/ 的/ 语义/ 动作/ ,/ 延迟/ 执行/ 其它/ 语义/ 动作/ ,/ 待/ 分析树/ (/ 分析/ 森林/ )/ 构造/ 完毕/ 后/ ,/ 进行/ 第/ 2/ 遍/ 处理/ ,/ 执行/ 其它/ 语义/ 动作/ ./ 有/ 文献/ 称/ 这种/ 策略/ 为/ “/ 两遍/ 编译/ ”/ (/ two/ -/ passcompiling/ )/ [/ 7/ ]/ ;/ (/ 2/ )/ 改写/ 文法/ 消除/ 分析/ 冲突/ ./ YACC/ [/ 8/ ]/ 采用/ 这种/ 处理/ 策略/ ./ 如果/ 插入/ 语义/ 动作/ 后/ 引入/ 了/ 分析/ 冲突/ ,/ YACC/ 要求/ 改写/ 文法/ 消除/ 冲突/ ,/ 否则/ 采用/ YACC/ 的/ 缺省/ 冲突/ 处理/ 规则/ 处理/ :/ ①/ 移进/ -/ 归约/ 冲突/ ,/ 选择/ 移进/ ;/ ②/ 归约/ -/ 归约/ 冲突/ ,/ 选择/ 先/ 声明/ 的/ 产生/ 式/ 执行/ 归约/ ./ 对/ 断点/ 调试/ 来讲/ ,/ 这/ 两种/ 处理/ 策略/ 均/ 不/ 合适/ ./ 第/ 1/ 种/ 策略/ 的/ 缺陷/ 在于/ ,/ 必须/ 在/ 分析树/ (/ 分析/ 森林/ )/ 生成/ 完毕/ 后/ 才能/ 执行/ 相应/ 的/ 语义/ 动作/ ,/ 而/ 断点/ 调试/ 要求/ 在/ 语法分析/ 过程/ 中/ 执行/ 语义/ 动作/ ,/ 这时/ 分析树/ (/ 分析/ 森林/ )/ 尚未/ 生成/ 完毕/ ;/ 第/ 2/ 种/ 策略/ 的/ 缺陷/ 在于/ ,/ 普通/ 软件/ 开发者/ 难以/ 掌握/ 并/ 熟练/ 应用/ 文法/ 改写/ 技巧/ ./ 文法/ 改写/ 是/ 一项/ 高度/ 专业/ 并/ 十分困难/ 的/ 软件开发/ 活动/ ,/ 改写/ 过程/ 中要/ 遵循/ 复杂/ 的/ 等价/ 变换/ 规则/ ,/ 并且/ 改写/ 文法/ 极易/ 出错/ ,/ 导致/ 改写/ 前/ 和/ 改写/ 后/ 的/ 文法/ 定义/ 的/ 语言/ 不/ 一致/ ,/ 而/ 这种/ 不一致性/ 无法/ 通过/ 程序/ 自动/ 验证/ 判断/ ,/ 因为/ 文法/ 的/ 等价/ 性/ 在/ 形式语言/ 理论/ 中/ 属于/ 不可判定/ 问题/ [/ 4/ ]/ ./ 此外/ ,/ 断点/ 本质/ 上/ 不是/ 文法/ 的/ 有效/ 组成部分/ ,/ 调试/ 完毕/ 后/ ,/ 由于/ 断点/ 调试/ 需要/ 而/ 插入/ 的/ 空非/ 终结符/ ,/ 还/ 需要/ 从/ 文法/ 中/ 删除/ ,/ 这/ 需要/ 再次/ 修改/ 文法/ ./ 从/ 上面/ 的/ 分析/ 可/ 看出/ ,/ 通过/ 修改/ 文法/ 解决/ 插入/ 断点/ 造成/ 的/ 分析/ 冲突/ ,/ 在/ 断点/ 插入/ 和/ 删除/ 后/ 需要/ 两次/ 修改/ 文法/ ,/ 工作量/ 很大/ ,/ 因而是/ 不/ 可取/ 的/ ./ 综上/ ,/ 通过/ 简单/ 的/ 文法/ 变换/ ,/ 插入/ 空非/ 终结符/ ,/ 并/ 在/ 新/ 添加/ 的/ 产生/ 式/ 末尾/ 添加/ 断点/ ,/ 不能/ 解决/ 中间/ 断点/ 的/ 文法/ 调试/ 问题/ ./ 因此/ ,/ 需要/ 设计/ 相应/ 的/ 算法/ 来/ 区分/ 不同/ 的/ 断点/ 位置/ ,/ 以/ 判断/ 哪些/ 位置/ 能/ 插入/ 断点/ ,/ 哪些/ 位置/ 不能/ 插入/ 断点/ ./ 本文/ 引入/ 了/ 两个/ 新/ 的/ 概念/ :/ 有效/ 断点/ 位置/ 和/ 无效/ 断点/ 位置/ ,/ 来/ 区分/ 不同/ 的/ 断点/ 类型/ ./ 定义/ 6/ ./ 有效/ 断点/ 位置/ 、/ 无效/ 断点/ 位置/ ./ 对于/ LR/ (/ k/ )/ 文法/ G/ ,/ 令为/ 不/ 包含/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 的/ 其它/ 任意/ 文法/ 位置/ 的/ 集合/ ,/ =/ ∪/ [/ i/ ,/ j/ ]/ ,/ 在/ 插入/ 空非/ 终结符/ 后/ 得到/ 文法/ G/ ,/ 在/ 插入/ 空非/ 终结符/ 后/ 得到/ 文法/ G/ ./ 文法/ 位置/ [/ i/ ,/ j/ ]/ 是/ 一个/ 有效/ 断点/ 位置/ ,/ 当且/ 仅/ 当/ 对/ 所有/ 的/ ,/ 要么/ 文法/ G/ 和/ G/ 都/ 是/ LR/ (/ k/ )/ 文法/ ,/ 要么/ 都/ 不是/ ./ 如果/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 不是/ 有效/ 断点/ 位置/ ,/ 则/ 称/ 其/ 为/ 无效/ 断点/ 位置/ ./ 简单/ 来说/ ,/ 如果/ 在/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 处/ 插入/ 断点/ ,/ 不会/ 造成/ 分析/ 冲突/ ,/ 则/ [/ i/ ,/ j/ ]/ 是/ 有效/ 断点/ 位置/ ,/ 否则/ [/ i/ ,/ j/ ]/ 是/ 无效/ 断点/ 位置/ ./ 根据/ 定义/ 6/ ,/ 算法/ 1/ 给出/ 了/ 一种/ 直观/ 的/ 断点/ 类型/ 判定/ 算法/ ./ 算法/ 1/ ./ 直观/ 断点/ 类型/ 判断/ 算法/ (/ 计算/ 所有/ 文法/ 位置/ )/ ./ 输入/ :/ LR/ (/ k/ )/ 文法/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ 输出/ :/ 文法/ G/ 的/ 每个/ 文法/ 位置/ 的/ 断点/ 类型/ 判定/ ,/ 即/ 有步骤/ :/ 1/ ./ 在/ 文法/ G/ [/ S/ ]/ 的/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 处/ ,/ 插入/ 空非/ 终结符/ X/ ,/ 得到/ 扩展/ 文法/ G/ [/ S/ ]/ ;/ 2/ ./ 为/ 文法/ G/ [/ S/ ]/ 生成/ LR/ (/ k/ )/ 分析/ 表/ ./ 检查/ 分析/ 表中/ 是否/ 存在/ 冲突/ ,/ 如果/ 不/ 存在/ 冲突/ ,/ 则/ 说明/ 位置/ [/ i/ ,/ j/ ]/ 为/ 有效/ 断点/ 位置/ ,/ 否则/ 为/ 无效/ 断点/ 位置/ ;/ 文法/ 位置/ 的/ 断点/ 类型/ ./ 3/ ./ 对/ 所有/ 文法/ 位置/ ,/ 重复/ 执行/ 步/ 1/ 和步/ 2/ ,/ 计算/ 出/ 所有/ 根据/ 定义/ 6/ 可知/ ,/ 算法/ 1/ 是/ 正确/ 的/ ./ 算法/ 1/ 的/ 缺/ Page4/ 陷/ 在于/ 速度/ 太慢/ ,/ 因为/ 对/ 每个/ 文法/ 位置/ ,/ 都/ 要/ 构造/ 一次/ LR/ (/ k/ )/ 分析/ 表/ ./ 文法/ 规模/ 一大/ ,/ 计算/ 开销/ 将/ 迅速/ 增加/ ./ 以/ 本文/ 第/ 5/ 部分/ 提及/ 的/ Java1/ ./ 4/ 文法/ 为例/ ,/ 其/ LALR/ (/ 1/ )/ 文法/ 包含/ 278/ 条/ 产生/ 式/ ,/ 2690/ 个/ 文法/ 位置/ ,/ 生成/ 一次/ LALR/ (/ 1/ )/ 分析/ 表/ 平均/ 耗时/ 0.057/ s/ ./ 根据/ 算法/ 1/ ,/ 计算/ 完/ 2690/ 个/ 文法/ 位置/ 共/ 需要/ :/ 2690/ ×/ 0.057/ s/ =/ 153.33/ s/ ./ 考虑/ 到/ Java/ 文法/ 很/ 规整/ ,/ 在/ 程序设计/ 语言/ 文法/ 中属/ 中等/ 复杂度/ 文法/ ,/ 如果/ 是/ C++/ 等/ 复杂/ 语言/ 文法/ ,/ 耗时/ 会/ 更长/ ,/ 因此/ ,/ 算法/ 1/ 不能/ 满足/ 交互式/ 断点/ 调试/ 的/ 需要/ ./ 如果/ 文法/ 是/ 固定/ 不变/ 的/ ,/ 可以/ 仅/ 执行/ 一次/ 计算/ ,/ 把/ 断点/ 类型信息/ 存储/ 到/ 一个/ 表中/ ./ 以后/ 每次/ 调试/ 时/ ,/ 不再/ 执行/ 计算/ ,/ 直接/ 查询/ 该表/ ,/ 就/ 可以/ 获知/ 每个/ 位置/ 是否是/ 有效/ 断点/ 位置/ ./ 然而/ ,/ 文法/ 调试/ 的/ 主要/ 动机/ 就是/ 修正/ 文法/ 中/ 可能/ 存在/ 的/ 错误/ ,/ 这个/ 阶段/ ,/ 文法/ 一般/ 还/ 未/ 定型/ ,/ 需要/ 频繁/ 修改/ ./ 因此/ ,/ 这种/ 方法/ 也/ 不/ 可行/ ./ 另外/ 一种/ 可能/ 的/ 解决办法/ 是/ ,/ 只/ 对/ 用户/ 实际/ 设置/ 断点/ 的/ 文法/ 位置/ 进行/ 计算/ 判断/ ,/ 而/ 不是/ 像/ 算法/ 1/ 一样/ ,/ 对/ 所有/ 的/ 文法/ 位置/ 进行/ 计算/ ,/ 如/ 算法/ 2/ 所示/ ./ 算法/ 2/ ./ 直观/ 断点/ 类型/ 判断/ 算法/ (/ 计算/ 用户/ 实际/ 插入/ 断点/ 的/ 文法/ 位置/ )/ ./ 输入/ :/ LR/ (/ k/ )/ 文法/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ 输出/ :/ 文法/ G/ 中/ 用户/ 插入/ 断点/ 的/ 文法/ 位置/ 类型/ 判定/ ,/ 即/ 步骤/ :/ 1/ ./ 在/ 用户/ 设置/ 断点/ 的/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 处/ 插入/ 空非/ 终结符/ X/ ,/ 得到/ 扩展/ 文法/ 为/ G/ [/ S/ ]/ ;/ 2/ ./ 为/ 文法/ G/ [/ S/ ]/ 生成/ LR/ (/ k/ )/ 分析/ 表/ ./ 检查/ 分析/ 表中/ 是否/ 存在/ 冲突/ ,/ 如果/ 不/ 存在/ 冲突/ ,/ 则/ 说明/ 位置/ [/ i/ ,/ j/ ]/ 为/ 有效/ 断点/ 位置/ ,/ 否则/ 为/ 无效/ 断点/ 位置/ ;/ 即可/ 判定/ 出/ 所有/ 插入/ 断点/ 位置/ 的/ 断点/ 类型/ ./ 3/ ./ 对/ 所有/ 插入/ 断点/ 的/ 文法/ 位置/ ,/ 重复/ 执行/ 步/ 1/ 和步/ 2/ ,/ 算法/ 2/ 仅/ 计算/ 实际/ 设置/ 断点/ 的/ 文法/ 位置/ ,/ 不/ 计算/ 所有/ 文法/ 位置/ ,/ 因而/ ,/ 算法/ 2/ 比/ 算法/ 1/ 执行/ 速度/ 快/ ./ 算法/ 2/ 的/ 不足/ 有/ 两点/ :/ (/ 1/ )/ 当/ 用户/ 设置/ 的/ 断点/ 数目/ 较多时/ ,/ 计算/ 开销/ 也/ 会/ 很大/ ,/ 因为/ 每个/ 断点/ 都/ 需要/ 生成/ 一次/ LR/ (/ k/ )/ 分析/ 表/ ,/ 难以/ 满足/ 交互式/ 调试/ 的/ 时间/ 响应/ 需求/ ;/ (/ 2/ )/ 断点/ 只能/ 在/ 调试/ 开始/ 前/ 预先/ 设置/ 好/ ,/ 调试/ 过程/ 中/ 不能/ 动态/ 添加/ 断点/ ./ 这/ 是因为/ ,/ 调试/ 前仅/ 判断/ 了/ 用户/ 插入/ 断点/ 的/ 文法/ 位置/ ,/ 没/ 判断/ 其它/ 文法/ 位置/ ,/ 如果/ 调试/ 过程/ 中/ 添加/ 断点/ ,/ 可能/ 引入/ 新/ 的/ 分析/ 冲突/ ,/ 造成/ 分析/ 失败/ ./ 本文/ 算法/ 可以/ 解决/ 算法/ 1/ 和/ 算法/ 2/ 的/ 不足/ ,/ 仅/ 生成/ 一次/ LR/ (/ k/ )/ 分析/ 表/ 即可/ 计算/ 出/ 所有/ 文法/ 位置/ 的/ 断点/ 类型/ ,/ 调试/ 前/ 和/ 调试/ 过程/ 中/ 可以/ 动态/ 添加/ 、/ 删除/ 断点/ ,/ 拥有/ 较/ 高/ 的/ 时间/ 性能/ ,/ 能/ 满足/ 交互式/ 调试/ 的/ 时间/ 需求/ ./ 本文/ 算法/ 借鉴/ 了/ Purdom/ 等/ 提出/ 的/ 部分/ 状态/ 位置图/ [/ 9/ ]/ ,/ 利用/ 部分/ 状态/ 位置图/ 来/ 区分/ 不同/ 的/ 断点/ 类型/ ./ 在/ 正式/ 介绍/ 算法/ 前/ ,/ 先/ 介绍/ 几个/ 相关/ 的/ 定义/ ./ 定义/ 7/ ./ 前驱/ 决定/ 结点/ 、/ 直接/ 前驱/ 决定/ 结点/ ./ 对于/ 有向图/ G/ =/ (/ V/ ,/ A/ ,/ r/ )/ ,/ 其中/ V/ 表示/ 顶点/ 集合/ ,/ A/ 表示/ 有/ 向/ 边/ 集合/ ,/ r/ 表示/ 开始/ 结点/ ,/ V/ 中/ 除了/ 开始/ 结点/ r/ 外/ 的/ 其它/ 结点/ 都/ 可以/ 从/ r/ 经过/ 一条/ 或/ 多条/ 有/ 向/ 边/ 到达/ ./ 如果/ 从/ 结点/ r/ 到/ 结点/ v/ 的/ 每/ 一条/ 路径/ 都/ 经过/ 结点/ w/ ,/ 则/ 称/ 结点/ w/ 为/ 结点/ v/ 的/ 前驱/ 决定/ 结点/ ./ 如果/ p/ 和/ q/ 是/ G/ 的/ 结点/ ,/ p/ 是/ q/ 的/ 前驱/ 决定/ 结点/ 当且/ 仅/ 当/ 从/ r/ 到/ q/ 的/ 每/ 一条/ 路径/ 都/ 经过/ p/ ./ 结点/ p/ 是/ 结点/ q/ 的/ 直接/ 前驱/ 决定/ 结点/ 当且/ 仅/ 当/ p/ 是/ q/ 的/ 前驱/ 决定/ 结点/ ,/ 并且/ q/ 除了/ p/ 以外/ 的/ 其它/ 任何/ 前驱/ 决定/ 结点/ 也/ 是/ p/ 的/ 前驱/ 决定/ 结点/ ./ 定义/ 8/ ./ 部分/ 状态/ (/ x/ ,/ α/ )/ ./ 对于/ 给定/ 的/ 状态/ x/ ,/ (/ x/ ,/ α/ )/ 表示/ 状态/ x/ 的/ 部分/ 状态/ ,/ 其中/ x/ 是/ 状态/ 编号/ ,/ α/ 是/ 向前/ 看/ 符号/ ,/ (/ x/ ,/ α/ )/ 表示/ 状态/ x/ 中以/ α/ 为/ 向前/ 看/ 符号/ 的/ 所有/ 项目/ 的/ 集合/ ./ 任何/ 一个/ 状态/ 都/ 由/ 一个/ 或/ 多个/ 部分/ 状态/ 组成/ ./ 每个/ 部分/ 状态/ (/ x/ ,/ α/ )/ 包括/ 下述/ 项目/ :/ (/ 1/ )/ 任何/ 可/ 移入/ 某个/ 终结符/ 或者/ 用/ 某条/ 产生/ 式/ 归约/ 的/ 项目/ d/ ;/ (/ 2/ )/ 任何/ 可/ 推导/ 出/ d/ 的/ 主要/ 项目/ (/ 令/ 这些/ 主要/ 项目/ 的/ 集合/ 为/ M/ )/ ;/ (/ 3/ )/ 任何/ 在/ M/ 的/ 闭包/ [/ 5/ -/ 6/ ]/ 中/ 并且/ 可以/ 推导/ 出/ d/ 的/ 项目/ ./ 定义/ 9/ ./ 部分/ 状态/ 位置图/ ./ 对于/ 每个/ 部分/ 状态/ (/ x/ ,/ α/ )/ ,/ 都/ 存在/ 一个/ 对应/ 的/ 部分/ 状态/ 位置图/ (/ PartialStatePositionGraph/ ,/ PSPG/ )/ ./ PSPG/ 由/ 一个/ 初始/ 结点/ (/ 用/ I/ 表示/ )/ ,/ 一个/ 或/ 多个/ 终止/ 结点/ (/ 用/ E/ 表示/ )/ ,/ 一个/ 或/ 多个/ 动作/ 结点/ 以及/ 一个/ 或/ 多个/ 中间/ 结点/ 组成/ ./ PSPG/ 是/ 一个/ 有向图/ ,/ 其中/ 的/ 有/ 向/ 边/ 表示/ 项目/ 间/ 的/ ε/ 转换/ 关系/ ./ 比如/ ,/ 有/ 向/ 边/ a/ →/ b/ (/ 其中/ a/ 、/ b/ 既/ 不是/ 初始/ 结点/ ,/ 也/ 不是/ 终止/ 结点/ ,/ 而是/ PSPG/ 中/ 的/ 中间/ 结点/ 或/ 动作/ 结点/ )/ ,/ 表示/ 结点/ a/ 通过/ 一次/ ε/ 转换/ 可/ 变换/ 到/ b/ ./ 从/ 初始/ 结点/ I/ 到/ M/ (/ M/ 的/ 含义/ 见/ 定义/ 8/ )/ 中/ 的/ 每个/ 元素/ 都/ 有/ 一条/ 有/ 向/ 边/ ,/ 从/ d/ (/ d/ 的/ 含义/ 见/ 定义/ 8/ )/ 到/ 终止/ 结点/ E/ 也/ 有/ 一条/ 有/ 向/ 边/ ./ 除/ 初始/ 结点/ 和/ 终止/ 结点/ 外/ 的/ 每个/ 结点/ (/ 即/ 中间/ 结点/ 和/ 动作/ 结点/ )/ 都/ 对应/ 一个/ 文法/ 位置/ ./ 图/ 9/ 是/ 一个/ 算术/ 表达式/ 文法/ ,/ 表/ 1/ 给出/ 了/ 该/ 文法/ 的/ 初始状态/ 0/ 对应/ 的/ LR/ (/ 1/ )/ 分析/ 表/ ./ 从表/ 1/ 可/ 看出/ ,/ 状态/ 0/ 共/ 包含/ 两个/ 部分/ 状态/ :/ (/ 0/ ,/ i/ )/ 和/ (/ 0/ ,/ (/ )/ ,/ 其/ 对应/ 的/ 部分/ 状态/ 位置图/ 如图/ 10/ 和/ 图/ 11/ 所示/ ./ Page5State/ 项/ 0T/ →/ ./ T/ / P/ {/ $/ +/ / }/ S5S6174S/ →/ ./ E/ $/ {/ ε/ }/ E/ →/ ./ E/ +/ T/ {/ $/ +/ }/ T/ →/ ./ T/ {/ $/ +/ }/ T/ →/ ./ P/ {/ $/ +/ / }/ T/ →/ ./ i/ {/ $/ +/ / }/ E/ →/ ./ (/ E/ )/ {/ $/ +/ / }/ 图/ 10/ 部分/ 状态/ (/ 0/ ,/ i/ )/ 对应/ 的/ 部分/ 状态/ 位置图/ 图/ 11/ 部分/ 状态/ (/ 0/ ,/ (/ )/ 对应/ 的/ 部分/ 状态/ 位置图/ 部分/ 状态/ 位置图/ 中/ 的/ 结点/ 可/ 分为/ 两大类/ :/ 特殊/ 结点/ 和/ 中间/ 结点/ ./ (/ 1/ )/ 特殊/ 结点/ 包括/ 3/ 个子/ 类/ :/ ①/ 初始/ 结点/ I/ ,/ 图/ 10/ 中/ 对应/ 结点/ 0/ ;/ ②/ 终止/ 结点/ E/ ,/ 图/ 10/ 中/ 对应/ 结点/ 8/ ;/ ③/ 动作/ 结点/ ,/ 可能/ 的/ 执行/ 动作/ 包括/ 3/ 类/ :/ shift/ 、/ reduce/ 、/ accept/ ,/ 图/ 10/ 中/ 的/ 动作/ 结点/ 为/ 结点/ 7/ ./ (/ 2/ )/ 中间/ 结点/ 根据/ 中间/ 结点/ 和/ 动作/ 结点/ 的/ 关系/ 不同/ ,/ 可/ 把/ 中间/ 结点/ 分为/ 两个/ 子类/ :/ ①/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 图/ 10/ 中/ 对应/ 结点/ 1/ ,/ 3/ ,/ 6/ ;/ ②/ 动作/ 结点/ 的/ 非/ 前驱/ 决定/ 结点/ ,/ 图/ 10/ 中/ 对应/ 结点/ 2/ ,/ 4/ ,/ 5/ ./ 根据/ 结点/ 是否/ 包含/ 自旋/ (/ 可以/ 推导/ 出/ 自身/ 的/ 结点/ 为/ 自旋/ 结点/ ,/ 否则/ 为/ 非/ 自旋/ 结点/ )/ ,/ 可/ 把/ 中间/ 结点/ 分为/ 两个/ 子类/ :/ ①/ 自旋/ 结点/ ,/ 图/ 10/ 中/ 对应/ 结点/ 2/ ;/ ②/ 非/ 自旋/ 结点/ ,/ 图/ 10/ 中/ 对应/ 结点/ 1/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ./ 定理/ 1/ ./ 对于/ LR/ (/ k/ )/ 文法/ G/ [/ S/ ]/ ,/ 其/ 部分/ 状态/ 位置图/ 中/ 的/ 自旋/ 结点/ 对应/ 的/ 文法/ 位置/ 为/ 无效/ 断点/ 位置/ ./ 证明/ ./ 根据/ 定义/ ,/ 自旋/ 结点/ 可以/ 推导/ 出/ 自身/ ,/ 因此/ 自旋/ 结点/ 对应/ 的/ 项目/ 可以/ 抽象/ 为/ E/ →/ ./ E/ γ/ (/ 其中/ γ/ 为/ 一个/ 、/ 多个/ 终结符/ 或非/ 终结符/ 的/ 组合/ )/ ,/ 令该/ 产生/ 式/ 编号/ 为/ i/ ,/ 则/ 自旋/ 结点/ 对应/ 的/ 文法/ 位置/ 为/ [/ i/ ,/ 0/ ]/ ./ 在/ 文法/ 位置/ [/ i/ ,/ 0/ ]/ 处/ 设置/ 断点/ ,/ 需要/ 插入/ 空非/ 终结符/ X/ ,/ 变换/ 后/ 得到/ 的/ 产生/ 式/ 为/ E/ →/ ./ XE/ γ/ ./ 产生/ 式/ E/ →/ ./ XE/ γ/ 迭代/ n/ 次后/ 可/ 得到/ 句型/ Xn/ β/ γ/ n/ η/ ,/ 其中/ β/ 、/ η/ 为/ 一个/ 、/ 多个/ 终结符/ 或非/ 终结符/ 的/ 组合/ ./ 若/ β/ 恒为/ 空串/ ε/ ,/ 说明/ γ/ 和/ E/ 能且/ 只能/ 推导/ 出/ ε/ ,/ 因此/ ,/ 规则/ E/ →/ E/ γ/ 蜕化/ 为/ E/ →/ E/ 和/ E/ →/ ε/ ,/ E/ →/ E/ 是/ 有害/ 规则/ [/ 6/ ]/ ,/ 不/ 应/ 出现/ 在/ 文法/ 定义/ 中/ ,/ 因此/ ,/ β/ 不恒为/ ε/ ./ 同理/ ,/ γ/ 也/ 不恒为/ ε/ ,/ 否则/ E/ →/ E/ γ/ 蜕化/ 为/ E/ →/ E/ ,/ 为/ 有害/ 规则/ ./ 令/ 添加/ 空非/ 终结符/ X/ 后/ 得到/ 的/ 文法/ 为/ G/ [/ S/ ]/ ./ 因为/ Xn/ β/ γ/ n/ η/ 是/ 文法/ G/ [/ S/ ]/ 的/ 句型/ ,/ 若/ G/ [/ S/ ]/ 是/ LR/ (/ k/ )/ 文法/ ,/ 则/ 可/ 通过/ 向前/ 看/ k/ 个/ 符号/ 识别/ 句型/ Xn/ β/ γ/ n/ η/ 中/ 的/ Xn/ ./ 而/ 句型/ Xn/ β/ γ/ n/ η/ 要求/ Xn/ 后/ 必须/ 要/ 跟着/ β/ γ/ n/ ,/ 因为/ β/ 、/ γ/ 不总为/ ε/ ,/ 因此/ ,/ 至少/ 要/ 向后看/ n/ +/ 1/ 个/ 符号/ 才能/ 识别/ Xn/ ./ 产生/ 式/ E/ →/ ./ XE/ γ/ 迭代/ 次数/ n/ 可为/ 任意/ 次/ ,/ 而/ k/ 为/ 固定值/ ./ 令/ n/ >/ k/ ,/ 则/ 实际/ 向前/ 看/ 符号/ 长度/ k/ 小于/ 识别/ Xn/ 必须/ 的/ n/ +/ 1/ ,/ 因而/ G/ [/ S/ ]/ 不是/ LR/ (/ k/ )/ 文法/ ./ 因此/ ,/ 自旋/ 结点/ 对应/ 的/ 文法/ 位置/ 为/ 无效/ 断点/ 位置/ ./ 对于/ LR/ (/ k/ )/ 文法/ ,/ Purdom/ 证明/ 了/ 在/ PSPG/ 的/ 动作/ 结点/ 的/ 非/ 前驱/ 决定/ 结点/ 位置/ 插入/ 语义/ 动作/ ,/ 可能/ 会/ 引入/ 分析/ 冲突/ ,/ 也/ 可能/ 不会/ 引入/ 分析/ 冲突/ [/ 9/ ]/ ./ 根据/ 本文/ 的/ 断点/ 类型定义/ ,/ 这些/ 位置/ 都/ 是/ 无效/ 断点/ 位置/ (/ 定理/ 2/ )/ ./ 定理/ 2/ ./ 部分/ 状态/ 位置图/ 中/ ,/ 动作/ 结点/ 的/ 非/ 前驱/ 决定/ 结点/ 对应/ 的/ 文法/ 位置/ 为/ 无效/ 断点/ 位置/ ./ Purdom/ 方法/ 中/ ,/ 除/ 自旋/ 结点/ 和/ 动作/ 结点/ 的/ 非/ 前驱/ 决定/ 结点/ 外/ ,/ 其它/ 位置/ 都/ 归类/ 为/ 自由/ 位置/ ,/ 可自/ Page6/ 由/ 插入/ 语义/ 动作/ 而/ 不会/ 引入/ 分析/ 冲突/ ./ 这个/ 结论/ 是/ 不/ 正确/ 的/ ,/ 因为/ 一个/ 状态/ 可能/ 有/ 多个/ PSPG/ ,/ 在/ 这些/ PSGP/ 中/ 独立/ 应用/ Purdom/ 方法/ ,/ 有时/ 会/ 得出/ 矛盾/ 的/ 结论/ ./ 比如/ ,/ 图/ 12/ 文法/ 的/ LR/ (/ 1/ )/ 分析/ 表/ 初始状态/ 有/ 两个/ PSPG/ (/ 图/ 13/ )/ ./ 根据/ Purdom/ 方法/ ,/ 图/ 13/ (/ a/ )/ 中/ 的/ 结点/ 2/ 不是/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 因而/ 结点/ 2/ 处/ 不能/ 插入/ 语义/ 动作/ ;/ 图/ 13/ (/ b/ )/ 中/ ,/ 结点/ 10/ 不是/ 自旋/ 结点/ ,/ 且/ 结点/ 10/ 是/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 因此/ 结点/ 10/ 处/ 可/ 插入/ 语义/ 动作/ ./ 实际上/ ,/ 结点/ 2/ 和/ 结点/ 10/ 是/ 同一/ 结点/ ,/ 但/ 从/ 同一/ 状态/ 的/ 两个/ PSPG/ 中/ ,/ 却/ 得出/ 了/ 矛盾/ 的/ 结论/ ,/ 其/ 原因/ 在于/ ,/ 没有/ 把/ 结点/ 2/ 和/ 结点/ 10/ 在/ 所有/ PSPG/ 中/ 比较/ 判断/ ./ 对于/ 某个/ 结点/ n/ ,/ 若/ n/ 为/ 非/ 自旋/ 结点/ ,/ 且/ n/ 在/ 所有/ PSPG/ 中均/ 为/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 结点/ n/ 处才/ 可/ 插入/ 语义/ 动作/ ,/ 即/ 有效/ 断点/ 位置/ ./ 合并/ 某一/ 状态/ 的/ 所有/ 部分/ 状态/ 位置图/ 中/ 的/ 相同/ 结点/ 得到/ 的/ 图/ 称为/ 状态/ 位置图/ (/ StatePositionGraph/ ,/ SPG/ )/ [/ 17/ ]/ ./ 比如/ ,/ 合并/ 图/ 13/ 中/ 的/ 两个/ PSPG/ ,/ 可/ 得到/ 图/ 14/ 的/ SPG/ ./ 图/ 14/ 合并/ PSPG/ 中/ 的/ 相同/ 结点/ 得到/ SPG/ 的/ 过程/ 定理/ 3/ 证明/ 了/ ,/ 结点/ n/ 在/ 所有/ PSPG/ 中均/ 为/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 当且/ 仅/ 当/ n/ 在/ SPG/ 中是/ 所有/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 这样/ ,/ 计算/ 有效/ 断点/ 位置/ 转化/ 为/ 查找/ SPG/ 中/ 的/ 所有/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 定理/ 3/ ./ 对于/ LR/ (/ k/ )/ 文法/ G/ [/ S/ ]/ ,/ 结点/ n/ 在/ SPG/ 对应/ 的/ 所有/ PSPG/ 中/ 都/ 是/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 当且/ 仅/ 当/ 结点/ n/ 是/ SPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 证明/ ./ 充分性/ ./ 若/ n/ 是/ SPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 则/ 在/ SPG/ 对应/ 的/ PSPG/ 中/ n/ 也/ 是/ 各个/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 根据/ SPG/ 定义/ ,/ SPG/ 由/ 各个/ PSPG/ 合并/ 得到/ ,/ 因而/ 各个/ PSPG/ 是/ SPG/ 的/ 子/ 图/ ./ 若/ n/ 是/ SPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 则/ n/ 也/ 必然/ 是/ 各个/ 子图/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ PSPG/ 是/ SPG/ 的/ 子/ 图/ ,/ 因而/ n/ 也/ 是/ 各个/ PSPG/ 中/ 的/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 必要性/ ./ 若/ n/ 是/ 各个/ PSPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 则/ 在/ SPG/ 中/ n/ 也/ 是/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 根据/ 前提条件/ ,/ n/ 是/ 各个/ PSPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 因此/ ,/ 在/ 某个/ PSPG/ 中/ ,/ 从/ 初始/ 结点/ I/ 到/ 动作/ 结点/ A/ ,/ 存在/ 一条/ 路径/ p1/ ,/ 且/ n/ 是/ 路径/ p1/ 上/ 的/ 一个/ 结点/ ./ SPG/ 由/ 各个/ PSPG/ 合并/ 得到/ ,/ 因此/ ,/ 动作/ 结点/ A/ 也/ 是/ SPG/ 的/ 动作/ 结点/ ,/ 且/ p1/ 路径/ 存在/ 于/ SPG/ 中/ ./ 假定/ n/ 不是/ SPG/ 中/ 动作/ 结点/ A/ 的/ 前驱/ 决定/ 结点/ ,/ 则/ 从/ SPG/ 的/ 初始/ 结点/ I/ 到/ 动作/ 结点/ A/ 存在/ 另外/ 一条/ 路径/ p2/ ,/ 且/ p2/ 不/ 经过/ 结点/ n/ ./ 因为/ p1/ 和/ p2/ 都/ 包含/ 动作/ 结点/ A/ ,/ 因此/ 它们/ 在/ 同一个/ PSPG/ 中/ ./ 因为/ n/ 不是/ p2/ 路径/ 上/ 的/ 结点/ ,/ 路径/ p2/ 中/ 从/ 初始/ 结点/ I/ 到/ 动作/ 结点/ A/ 不/ 经过/ n/ ,/ 因此/ ,/ n/ 不是/ 该/ PSPG/ 中/ 动作/ 结点/ A/ 的/ 前驱/ 决定/ 结点/ ,/ 这/ 与/ 前提条件/ 矛盾/ ./ 因此/ ,/ n/ 是/ SPG/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ./ 证毕/ ./ 从/ 定理/ 1/ ~/ 3/ 可/ 看出/ ,/ 可/ 采用/ 算法/ 3/ 来/ 计算/ 算法/ 3/ ./ 断点/ 类型/ 判断/ 算法/ (/ 基于/ SPG/ )/ ./ 输入/ :/ LR/ (/ k/ )/ 文法/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ 输出/ :/ 文法/ G/ 中/ 所有/ 文法/ 位置/ 的/ 断点/ 类型/ 判定/ ,/ 即/ 有/ LR/ (/ k/ )/ 文法/ 的/ 断点/ 类型/ ./ 步骤/ :/ 1/ ./ 为/ LR/ (/ k/ )/ 文法/ 生成/ LR/ (/ k/ )/ 分析/ 表/ ;/ 2/ ./ 为/ LR/ (/ k/ )/ 分析/ 表中/ 的/ 每个/ 状态/ 构造/ SPG/ ;/ 3/ ./ 对步/ 2/ 中/ 每个/ SPG/ ,/ 重复/ 执行/ 步/ 4/ ~/ 6/ ;/ Page74/ ./ 对/ 某个/ SPG/ (/ 令其为/ M/ )/ ,/ 计算/ M/ 中/ 的/ 自旋/ 结点/ ,/ 把/ 自旋/ 结点/ 对应/ 的/ 位置/ 标记/ 为/ 无效/ 断点/ 位置/ ;/ 5/ ./ 计算/ M/ 中/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 把/ 动作/ 结点/ 的/ 非/ 前驱/ 决定/ 结点/ 位置/ 标记/ 为/ 无效/ 断点/ 位置/ ;/ 6/ ./ 把/ M/ 中/ 其它/ 未/ 标记/ 位置/ 标记/ 为/ 有效/ 断点/ 位置/ ./ 下面/ 对/ 算法/ 3/ 各/ 步骤/ 采用/ 的/ 具体/ 算法/ 及/ 每个/ 具体/ 算法/ 的/ 时间/ 复杂度/ 做/ 一下/ 介绍/ 和/ 分析/ ./ 步/ 1/ ,/ 生成/ LR/ (/ k/ )/ 分析/ 表/ ,/ 具体/ 算法/ 可/ 参考文献/ [/ 5/ ]/ ./ 随着/ k/ 的/ 增大/ ,/ 分析/ 表/ 的/ 状态/ 空间/ 在/ 最坏/ 状态/ 下/ 为/ 指数/ 增长/ [/ 4/ ]/ ,/ 分析/ 速度/ 也/ 会/ 变慢/ ./ 因此/ ,/ 实际/ 中/ 一般/ 取/ k/ =/ 1/ ,/ 生成/ LR/ (/ 1/ )/ 分析/ 表可/ 在/ 线性/ 时间/ 内/ 完成/ [/ 4/ ]/ ./ 步/ 2/ ,/ 为/ 每个/ 状态/ 生成/ SPG/ ,/ SPG/ 的/ 具体/ 构造/ 算法/ 见/ 算法/ 4/ ,/ 算法/ 4/ 也/ 可以/ 在/ 线性/ 时间/ 内/ 完成/ ./ 步/ 4/ ,/ 查找/ SPG/ 中/ 的/ 自旋/ 结点/ ,/ 执行/ 速度/ 取决于/ 图中/ 的/ 顶点/ 数/ |/ A/ |/ 和/ 有/ 向/ 边/ 的/ 数目/ [/ V/ ]/ ,/ 本质/ 上/ 是/ 侦测/ 图中/ 的/ 环路/ ,/ 是/ 一个/ 线性/ 复杂度/ 算法/ [/ 10/ ]/ ./ 步/ 5/ ,/ 计算/ 动作/ 结点/ 的/ 前驱/ 决定/ 结点/ ,/ 可/ 采用/ 图论/ 中/ 的/ 决定/ 结点/ 查找/ 算法/ (/ dominatorsearching/ )/ [/ 11/ ]/ ./ Purdom/ 使用/ 了/ 一个/ 近/ 线性/ 时间/ (/ almostlinear/ -/ time/ )/ 算法/ ,/ 速度/ 较慢/ ./ Harel/ [/ 12/ ]/ 、/ Alstrup/ [/ 13/ ]/ 、/ Buchs/ -/ baum/ [/ 14/ ]/ 等/ 提出/ 了/ 一系列/ 改进/ 算法/ ,/ 然而/ ,/ 这些/ 算法/ 仍/ 存在/ 一定/ 缺陷/ ./ 2004/ 年/ Georgiadis/ 和/ Tarjan/ 提出/ 了/ 一个/ 改进/ 的/ 线性/ 时间/ 算法/ [/ 15/ ]/ ,/ 修正/ 了/ 以前/ 算法/ 的/ 不足/ ,/ 本文/ 采用/ 该/ 算法/ 作为/ 动作/ 结点/ 的/ 决定/ 结点/ 查找/ 算法/ ./ 步/ 6/ ,/ 标记/ 其它/ 所有/ 未/ 标记/ 结点/ ,/ 需要/ 的/ 时间/ 取决于/ SPG/ 中/ 的/ 结点/ 数/ ,/ 也/ 可以/ 在/ 线性/ 时间/ 内/ 完成/ ./ 通过/ 上述/ 分析/ 可/ 看出/ ,/ 算法/ 3/ 的/ 每个/ 步骤/ 均/ 可/ 在/ 线性/ 时间/ 内/ 完成/ ,/ 算法/ 3/ 是/ 一个/ 线性/ 时间/ 复杂度/ 算法/ ./ 算法/ 4/ ./ 状态/ 位置图/ (/ SPG/ )/ 构造/ 算法/ ./ 输入/ :/ LR/ (/ k/ )/ 文法/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ 及其/ LR/ (/ k/ )/ 输出/ :/ 每个/ 状态/ 对应/ 的/ SPG/ 步骤/ :/ 1/ ./ 对/ M/ 中/ 的/ 每个/ 状态/ n/ ,/ 执行/ 步/ 2/ ~/ 4/ ;/ 2/ ./ 为/ 状态/ n/ 创建/ SPG/ 的/ 初始/ 结点/ In/ ;/ 3/ ./ 为/ 状态/ n/ 中/ 的/ 每个/ 主要/ 项目/ mi/ 创建/ 新/ 结点/ Nmi/ ,/ 从/ 初始/ 结点/ In/ 到/ Nmi/ 添加/ 一条/ 有/ 向/ 边/ ;/ 4/ ./ 检查/ 步/ 3/ 中/ 的/ 每个/ 主要/ 项目/ mi/ ,/ 从/ 算法/ 4/ 可/ 看出/ ,/ 构造/ SPG/ 的/ 过程/ 和/ LR/ (/ k/ )/ 分析/ 表/ 的/ 生成/ 过程/ 类似/ ,/ 只是/ 增加/ 了/ 生成/ 初始/ 结点/ 、/ 动作/ 结点/ 和/ 终止/ 结点/ 的/ 过程/ ./ 如果/ 把/ SPG/ 的/ 构造/ 过程/ 合并/ 到/ LR/ (/ k/ )/ 分析/ 表/ 的/ 生成/ 过程/ ,/ 则/ 一些/ 公共/ 步骤/ ,/ 如/ 计算/ 项目/ (/ 集/ )/ 闭包/ 等/ ,/ 只/ 需要/ 计算/ 一次/ ,/ 这样/ 可/ 获得/ 更好/ 的/ 时间/ 性能/ ./ 从/ 算法/ 4/ 可/ 看出/ ,/ 除了/ 增加/ 特殊/ 结点/ 外/ ,/ 构造/ SPG/ 的/ 时间/ ,/ 与/ 生成/ LR/ (/ k/ )/ 的/ 分析/ 表/ 生成/ 时间/ 相当/ ./ 4/ 支持/ 中间/ 断点/ 和/ 尾部/ 断点/ 的/ 文法/ 断点/ 调试/ 方法/ 标准/ 的/ LR/ (/ k/ )/ 分析方法/ 不/ 支持/ 在/ 产生/ 式/ 右部/ 中间/ 调用/ 语义/ 动作/ ,/ 要/ 支持/ 产生/ 式/ 右部/ 中间/ 位置/ 的/ 断点/ 调试/ ,/ 必须/ 在/ 相应/ 位置/ 插入/ 空非/ 终结符/ ./ 这些/ 空非/ 终结符/ 应该/ 由/ 调试器/ 自动/ 添加/ ./ 考虑/ 到/ 添加/ 空非/ 终结符/ 可能/ 会/ 引入/ 分析/ 冲突/ ,/ 造成/ 转换/ 后/ 的/ 文法/ 不是/ LR/ (/ k/ )/ 文法/ ,/ 导致/ LR/ (/ k/ )/ 分析方法/ 失效/ ,/ 因此/ ,/ 调试器/ 应该/ 利用/ 算法/ 3/ 来/ 判别/ 断点/ 类型/ ,/ 计算/ 哪些/ 位置/ 可以/ 插入/ 断点/ ,/ 哪些/ 位置/ 不/ 可以/ 插入/ 断点/ ./ 算法/ 5/ 给出/ 了/ 同时/ 支持/ 中间/ 断点/ 和/ 尾部/ 断点/ 的/ LR/ (/ k/ )/ 文法/ 断点/ 调试/ 算法/ ./ 算法/ 5/ ./ 支持/ 中间/ 断点/ 和/ 尾部/ 断点/ 的/ 文法/ 断点/ 调试/ 算法/ ./ 输入/ :/ LR/ (/ k/ )/ 文法/ G/ =/ (/ N/ ,/ T/ ,/ P/ ,/ S/ )/ 和/ 用户/ 设置/ 的/ 断点/ 步骤/ :/ 1/ ./ 利用/ 算法/ 3/ 计算/ 所有/ 有效/ 断点/ 位置/ 集合/ M/ ;/ 2/ ./ 在/ 集合/ M/ 的/ 每个/ 中间/ 断点/ 位置/ 插入/ 空非/ 终结符/ ,/ 为了/ 区分/ 不同/ 的/ 断点/ 位置/ ,/ 插入/ 的/ 空非/ 终结符/ 名称/ 应/ 各不相同/ ,/ 令/ 插入/ 非/ 终结符/ 后/ 得到/ 的/ 文法/ 为/ G/ ;/ Page83/ ./ 为/ G/ 生成/ LR/ (/ k/ )/ 分析器/ ;/ 4/ ./ 调试器/ 加载/ 步/ 3/ 生成/ 的/ 分析器/ 执行/ 调试/ ,/ 对/ 输入/ 串/ 进行/ 分析/ ,/ 直至/ 遇到/ 归约/ 动作/ ./ 检查/ 归约/ 动作/ 对应/ 的/ 产生/ 式/ p/ 和/ 用户/ 设置/ 的/ 断点/ 集合/ B/ ,/ 若/ 产生/ 式/ p/ 中/ 的/ 文法/ 位置/ 不/ 在/ 集合/ B/ 中/ ,/ 则/ 说明/ 用户/ 没有/ 在/ p/ 中/ 设置/ 断点/ ,/ 继续/ 分析/ 过程/ ./ 若/ p/ 中/ 的/ 某个/ 文法/ 位置/ [/ i/ ,/ j/ ]/ 在/ 集合/ B/ 中/ ,/ 检查/ [/ i/ ,/ j/ ]/ 是否/ 在/ 集合/ M/ 中/ ,/ 若/ [/ i/ ,/ j/ ]/ 在/ M/ 中/ ,/ 则/ 说明/ 其为/ 有效/ 断点/ 位置/ ,/ 调试器/ 暂停/ 分析/ 过程/ ,/ 显示/ 调试信息/ ./ 若/ [/ i/ ,/ j/ ]/ 不/ 在/ M/ 中/ ,/ 则/ 说明/ 用户/ 设置/ 了/ 一个/ 无效/ 断点/ ,/ 调试器/ 提示/ 用户/ ,/ 同时/ 忽略/ 该/ 断点/ ,/ 继续/ 分析/ 过程/ ;/ 调试器/ 应/ 根据/ 实际/ 断点/ 设置/ 动态/ 更新/ 集合/ B/ ./ 5/ ./ 调试/ 过程/ 中/ ,/ 根据/ 需要/ 用户/ 可/ 动态/ 添加/ 或/ 删除/ 断点/ ,/ 算法/ 步/ 2/ 之所以/ 在/ 每个/ 有效/ 的/ 中间/ 断点/ 位置/ 都/ 插入/ 空非/ 终结符/ ,/ 主要/ 是/ 为了/ 支持/ 调试/ 过程/ 中/ 动态/ 添加/ 断点/ ./ 从/ 算法/ 5/ 可/ 看出/ ,/ 插入/ 空非/ 终结符/ 后/ 得到/ 的/ 文法/ 是/ G/ ,/ 调试/ 用/ 的/ 分析器/ 是/ 根据/ 文法/ G/ 生成/ 的/ ,/ 在/ 所有/ 有效/ 的/ 中间/ 断点/ 位置/ 都/ 插入/ 空非/ 终结符/ ,/ 可以/ 确保/ 用户/ 在/ 调试/ 前/ 或/ 调试/ 过程/ 中/ 设置/ 在/ 有效/ 断点/ 位置/ 的/ 断点/ ,/ 总能/ 被/ 有效/ 暂停/ ./ 在/ 调试/ 开始/ 前/ ,/ 若/ 只/ 在/ 用户/ 实际/ 设置/ 断点/ 中/ 的/ 有效/ 中间/ 断点/ 处/ 插入/ 空非/ 终结符/ (/ 令/ 变换/ 得到/ 的/ 文法/ 为/ G/ )/ ,/ 调试/ 过程中将/ 不能/ 动态/ 添加/ 断点/ ,/ 因为/ 若/ 动态/ 添加/ 断点/ ,/ 则/ 新/ 得到/ 的/ 变换/ 文法/ 为/ G/ / ,/ G/ / 不同于/ G/ ,/ 而/ 调试器/ 加载/ 的/ 是/ G/ 对应/ 的/ 分析器/ ,/ 因此/ 需要/ 停止/ 分析/ 过程/ ,/ 重新/ 为/ G/ / 生成/ 分析器/ ./ 除步/ 2/ 外/ ,/ 算法/ 的/ 其它/ 步骤/ 均/ 直观/ 易懂/ ,/ 此处/ 不再/ 赘述/ ./ 5/ 实验/ 结果/ 一个/ 实用/ 的/ 调试器/ 必须/ 有/ 足够/ 快/ 的/ 响应速度/ ./ 从/ 算法/ 3/ 、/ 算法/ 4/ 和/ 算法/ 5/ 可/ 看出/ ,/ LR/ (/ k/ )/ 分析/ 表/ 生成/ ,/ SPG/ 构造/ 和/ 断点/ 类型/ 判定/ 是/ 任意/ 文法/ 位置/ 断点/ 调试/ 的/ 3/ 个/ 核心/ 子/ 算法/ ,/ 本文/ 进行/ 了/ 3/ 组/ 实验/ 来/ 测试/ 其/ 性能/ ①/ ./ 5.1/ 犔/ 犚/ (/ 犽/ )/ 分析/ 表/ 自动/ 生成/ 性能/ 与/ LALR/ (/ k/ )/ 分析/ 表/ 相比/ ,/ LR/ (/ k/ )/ 分析/ 表/ 往往/ 包含/ 数目/ 巨大/ 的/ 状态/ 空间/ ./ 尽管/ LALR/ (/ k/ )/ 识别/ 能力/ 比/ LR/ (/ k/ )/ 弱/ ,/ 但/ 状态/ 空间/ 小得多/ ,/ 且/ 识别/ 能力/ 接近/ ,/ 因此/ ,/ LALR/ (/ k/ )/ 在/ 实际/ 中/ 应用/ 更广/ ./ 我们/ 选择/ 实际/ 应用/ 最广/ 的/ LALR/ (/ 1/ )/ 分析/ 表/ ,/ 来/ 测试/ 其/ 自动/ 生成/ 性能/ ./ Earley/ 证明/ 了/ 图/ 15/ 文法/ 的/ LR/ (/ k/ )/ 分析/ 表/ 状态/ 数/ 随着/ n/ 的/ 增大/ 呈/ 指数/ 级/ 增长/ [/ 16/ ]/ ./ 该/ 文法/ 很/ 适合/ 测试/ 分析/ 表/ 的/ 自动/ 生成/ 性能/ ,/ 表/ 2/ 给出/ 了/ 该组/ 文法/ 在/ n/ =/ 2/ ~/ 8/ 时/ 的/ LALR/ (/ 1/ )/ 分析/ 表/ 的/ 自动/ 生成/ 时间/ ./ 表/ 3/ 给出/ 了/ Java1/ ./ 4/ 文法/ 的/ LALR/ (/ 1/ )/ 分析/ 表/ 自动/ 生成/ 时间/ ./ n/ 状态/ CPU/ 时钟/ 2257413443784255586817507829662997278956990971031468143093218835131888599946893579.6477/ 状态/ 448/ 典型/ 的/ 程序设计/ 语言/ 文法/ ,/ 其/ LALR/ (/ 1/ )/ 分析/ 表/ 一般/ 包含/ 几百个/ 状态/ ,/ 即使/ 是/ 比较复杂/ 的/ C++/ 文法/ ,/ 其/ LALR/ (/ 1/ )/ 分析/ 表/ 也/ 仅/ 包含/ 约/ 1200/ 个/ 状态/ [/ 17/ ]/ ,/ 与表/ 2/ 中文/ 法/ n/ =/ 5/ 和/ n/ =/ 6/ 的/ 状态/ 数/ 相当/ ,/ 与/ Java/ 文法/ 的/ 状态/ 数/ 基本/ 在/ 同一/ 数量级/ ,/ 其/ 分析/ 表/ 的/ 自动/ 生成/ 时间/ 与/ Java/ 文法/ 具有/ 可比性/ ./ 从表/ 2/ 和表/ 3/ 可/ 推断出/ ,/ 典型/ 的/ 程序设计/ 语言/ 文法/ ,/ 其/ LALR/ (/ 1/ )/ 分析/ 表/ 的/ 自动/ 生成/ 时间/ 大约/ 在/ 0.1/ s/ 左右/ ,/ 可以/ 满足/ 交互式/ 调试/ 的/ 时间/ 响应/ 需求/ ./ 5.2/ SPG/ 构造/ 性能/ 表/ 4/ 给出/ 了/ 图/ 15/ 文法/ 在/ n/ =/ 2/ ~/ 8/ 时/ 的/ SPG/ 构造/ 时间/ ,/ 表/ 5/ 给出/ 了/ Java1/ ./ 4/ 文法/ 的/ SPG/ 构造/ 时间/ ./ 从表/ 4/ 和表/ 5/ 可/ 看出/ ,/ 与/ Java1/ ./ 4/ 文法/ 规模/ 相当/ 的/ 程序设计/ 语言/ 文法/ ,/ 其/ SPG/ 构造/ 时间/ 大约/ 在/ 0.005/ s/ 左右/ ,/ 可以/ 满足/ 交互式/ 调试/ 的/ 时间/ 响应/ 需求/ ./ n/ 状态/ CPU/ 时钟/ 225583613378111912842555960010586825990414629971167589837103145897130208351312176746289/ ①/ 3/ 组/ 数据/ 均/ 在/ 我们/ 研制/ 的/ VPGE/ 分析器/ 自动/ 生成器/ 原型/ 系/ Page9/ 状态/ 4485.3/ 断点/ 类型/ 判定/ 算法/ 性能/ 在/ 断点/ 类型/ 判定/ 算法/ 中/ ,/ 有/ 两个/ 问题/ 是/ 重要/ 的/ :/ 一个/ 是/ 算法/ 的/ 执行/ 速度/ 有/ 多/ 快/ ;/ 另/ 一个/ 是/ 对于/ 典型/ 的/ 程序设计/ 语言/ 文法/ ,/ 该/ 算法/ 可以/ 增加/ 多少/ 可用/ 断点/ ./ 对于/ 第/ 1/ 个/ 问题/ ,/ 本文/ 测试/ 了/ Java/ 、/ C/ 、/ Pascal3/ 种/ 常用/ 程序设计/ 语言/ 文法/ 的/ 断点/ 类型/ 分类/ 算法/ 执行/ 时间/ ,/ 表/ 6/ 给出/ 了/ 实验/ 结果/ ./ 因为/ 断点/ 类型/ 判定/ 采用/ 的/ 决定/ 结点/ 查找/ 算法/ 是/ 线性/ 的/ ,/ 从表/ 6/ 可/ 推断出/ ,/ 和/ Java/ 规模/ 类似/ 的/ 文法/ ,/ 断点/ 类型/ 判定/ 时间/ 大约/ 在/ 0.03/ s/ ,/ 可以/ 满足/ 交互式/ 断点/ 调试/ 的/ 时间/ 响应/ 需求/ ./ 表/ 63/ 种/ 常用/ 文法/ 的/ 断点/ 类型/ 判断/ 算法/ 性能/ Java4482782690232636448364310/ ./ 0032C4872412178146071856381290/ ./ 0037Pascal3271951592128131137451860/ ./ 0025/ 对于/ 第/ 2/ 个/ 问题/ ,/ 从表/ 6/ 可/ 看出/ ,/ 在/ Java/ 文法/ 中/ ,/ 有效/ 断点/ 和/ 无效/ 断点/ 的/ 百分比/ 分别/ 是/ 86.47/ %/ 和/ 13.53/ %/ ./ 一般/ 情况/ 下/ ,/ 每条/ 产生/ 式/ 右部/ 平均/ 至少/ 有/ 两个/ 符号/ ,/ 即/ 每条/ 产生/ 式/ 平均/ 至少/ 有/ 3/ 个/ 断点/ 位置/ ./ 传统/ 的/ 断点/ 调试/ 方法/ 只/ 支持/ 尾部/ 断点/ ,/ 因此/ 最多/ 有/ 33/ %/ 的/ 可用/ 断点/ 位置/ ./ 考虑/ 到/ 平均/ 情况/ 下/ 产生/ 式/ 右部/ 符号/ 一般/ 远/ 多于/ 两个/ ,/ 因此/ 传统/ 断点/ 调试/ 方法/ 可/ 利用/ 的/ 断点/ 数量/ 一般/ 远/ 低于/ 33/ %/ ./ 以表/ 6/ 的/ Java/ 文法/ 为例/ ,/ 其/ LALR/ (/ 1/ )/ 文法/ 共/ 包含/ 278/ 条/ 产生/ 式/ ,/ 利用/ 传统/ 断点/ 调试/ 方法/ ,/ 最多/ 有/ 278/ 个/ 可用/ 断点/ ,/ 有效/ 断点/ 位置/ 占/ 所有/ 断点/ 位置/ 的/ 百分比/ 为/ 10.33/ %/ ./ 采用/ 本文/ 断点/ 调试/ 方法/ ,/ 可/ 利用/ 的/ 断点/ 数目/ 是/ 2326/ ,/ 远高于/ 传统/ 方法/ 的/ 可用/ 断点/ 数量/ ./ 6/ 结论/ 本文/ 的/ 文法/ 断点/ 调试/ 方法/ ,/ 不仅/ 支持/ 传统/ 的/ 尾部/ 断点/ ,/ 还/ 支持/ 中间/ 断点/ ,/ 可/ 显著/ 增加/ 可/ 供/ 调试/ 的/ 断点/ 数目/ ./ 可用/ 断点/ 数目/ 增加/ 带来/ 的/ 益处/ 是/ 可以/ 跟踪/ 到/ 更/ 细粒度/ 的/ 文法/ 成分/ ,/ 从而/ 帮助/ 开发者/ 更好/ 地/ 理解/ 语法分析/ 过程/ ,/ 有效/ 降低/ 分析器/ 的/ 开发/ 难度/ ./ 本/ 方法/ 的/ 另/ 一个/ 优点/ 是/ 很/ 容易/ 集成/ 到/ 现有/ 的/ 各种/ LR/ (/ k/ )/ (/ 及/ 子类/ )/ 分析器/ 生成器/ 中/ ,/ 具有/ 较为/ 广阔/ 的/ 实际/ 应用/ 价值/ ./ 7/ 进一步/ 工作/ 当/ 用户/ 启动/ 调试器/ 调试/ 文法/ 时/ ,/ 与/ 前次/ 调试/ 过程/ 相比/ ,/ 即使/ 只/ 添加/ 、/ 删除/ 或/ 修改/ 了/ 一条/ 产生/ 式/ ,/ LR/ (/ k/ )/ 分析/ 表/ 生成/ 、/ SPG/ 构造/ 和/ 断点/ 类型/ 判定/ 也/ 必须/ 重新/ 执行/ ./ 对于/ 复杂/ 的/ 大/ 型文法/ ,/ 每次/ 的/ 计算/ 开销/ 会/ 很大/ ./ 因此/ ,/ 在/ 后续/ 的/ 工作/ 中/ ,/ 需要/ 开发/ 增量/ 的/ LR/ (/ k/ )/ 分析/ 表/ 生成/ 、/ SPG/ 构造/ 和/ 断点/ 类型/ 判定/ 算法/ ./ 这样/ ,/ 当/ 变更/ 少量/ 文法/ 产生/ 式/ 时/ ,/ 采用/ 增量/ 算法/ 可以/ 获得/ 更好/ 的/ 时间/ 性能/ ./ 

