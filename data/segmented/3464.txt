Page1/ 广义/ SOM/ 及其/ 在/ 人脸/ 性别/ 识别/ 中/ 的/ 应用/ 於/ 东军/ 1/ )/ ,/ 3/ )/ 吴小俊/ 2/ )/ HANCOCKEdwinR3/ )/ 杨静宇/ 1/ )/ 1/ )/ (/ 南京/ 理工大学/ 计算机科学/ 与/ 技术/ 学院/ 南京/ 210094/ )/ 2/ )/ (/ 江南/ 大学/ 物/ 联网/ 工程学院/ 江苏/ 无锡/ 214122/ )/ 3/ )/ (/ 约克/ 大学/ 计算机系/ YorkYO105DD/ 英国/ )/ 摘要/ 将/ 适用/ 于/ 欧氏/ 空间/ 的/ 经典/ SOM/ 模型/ ,/ 借助于/ 黎曼/ 指数/ 及/ 对数/ 映射/ ,/ 推广/ 至/ 一般/ 黎曼流/ 形/ 空间/ 中/ ,/ 得到/ 了/ 广义/ SOM/ 模型/ (/ G/ -/ SOM/ )/ ,/ 给出/ 了/ G/ -/ SOM/ 模型/ 的/ 序列/ 及/ 批量/ 学习/ 算法/ ./ G/ -/ SOM/ 能够/ 在/ 输出/ 空间/ 中/ 保持/ 模式/ 在/ 输入/ 空间/ 中/ 的/ 内蕴/ 拓扑/ 邻域/ 特性/ ,/ 因此/ ,/ 当/ 输入/ 空间/ 为/ 非线性/ 流形/ 时/ ,/ G/ -/ SOM/ 的/ 性能/ 理论/ 上将/ 优于/ SOM/ ./ FERET/ 人脸/ 图像/ 库上/ 的/ 性别/ 鉴定/ 实验/ 支持/ 了/ 理论/ 结果/ ./ 关键词/ 自/ 组织/ 映射/ ;/ 广义/ 自/ 组织/ 映射/ ;/ 黎曼流/ 形/ ;/ 模式识别/ 1/ 引言/ Kohonen/ [/ 1/ ]/ 提出/ 的/ 自/ 组织/ 映射/ (/ Self/ -/ OrganizingMap/ ,/ SOM/ )/ ,/ 又/ 称为/ 拓扑/ 保持/ 映射/ ,/ 是/ 一种/ 无/ 监督/ 学习/ 模型/ ./ SOM/ 的/ 一个/ 重要/ 特性/ 是/ 可以/ 在/ 没有/ 任何/ 分类/ 信息/ 的/ 条件/ 下/ ,/ 自/ 适应/ 地/ 学习/ 模式/ 在/ 输入/ 空间/ Page2/ 空间/ 中/ 的/ 欧氏/ 拓扑/ 邻域/ 关系/ ,/ 而/ 不能/ 有效/ 发现/ 非欧/ 拓扑/ 邻域/ 信息/ [/ 5/ ]/ ./ 为了/ 能够/ 在/ SOM/ 的/ 输出/ 空间/ 中/ 揭示/ 模式/ 在/ 输入/ 空间/ 中/ 的/ 非欧/ 拓扑/ 邻域/ 信息/ ,/ 有/ 学者/ 提出/ 了/ Kernel/ -/ SOM/ [/ 6/ -/ 7/ ]/ :/ 使用/ 核/ 函数/ 将/ 输入/ 空间/ 中/ 的/ 模式/ 变换/ 到/ 一个/ 高维/ (/ 甚至/ 是/ 无限/ 维/ )/ 的/ 特征/ 空间/ 中/ ;/ 然后/ 将/ 该/ 特征/ 空间/ 作为/ SOM/ 的/ 输入/ 空间/ ./ 然而/ ,/ 这种/ 方法/ 是/ 核/ 函数/ 依赖/ 的/ ,/ 使用/ 不同/ 的/ 核/ 函数/ ,/ Kernel/ -/ SOM/ 在/ 输出/ 空间/ 中/ 保持/ 的/ 输入/ 模式/ 的/ 拓扑/ 邻域/ 信息/ 将/ 是/ 不同/ 的/ ./ 换句话说/ ,/ Kernel/ -/ SOM/ 在/ 输出/ 空间/ 中/ 保持/ 的/ 依然/ 不是/ 模式/ 在/ 输入/ 空间/ 中/ 内蕴/ 的/ 拓扑/ 邻域/ 结构/ ./ 因此/ ,/ 当/ 模式/ 所在/ 的/ 输入/ 空间/ 是/ 非线性/ 流形/ 空间/ 时/ ,/ SOM/ 以及/ Kernel/ -/ SOM/ 模型/ 均/ 不能/ 很/ 好/ 地/ 在/ 输出/ 空间/ 中/ 保持/ 输入/ 模式/ 的/ 内蕴/ 拓扑/ 邻域/ 结构/ ./ 文献/ [/ 8/ ]/ 提出/ 了/ 基于/ 测地/ 距离/ 的/ SOM/ (/ GDBSOM/ )/ ,/ 在/ 学习/ 阶段/ 寻找/ SOM/ 的/ 最佳/ 匹配/ 单元/ (/ BMU/ )/ 时/ ,/ 使用/ 测地/ 距离/ 而/ 不是/ 欧氏/ 距离/ ,/ 以期/ 在/ 输出/ 空间/ 保持/ 输入/ 模式/ 的/ 内蕴/ 邻域/ 信息/ ./ 然而/ GDBSOM/ 在/ 进行/ 输出/ 节点/ 的/ 原型/ 向量/ 更新/ 时/ ,/ 并/ 不能/ 保证/ 更新/ 后/ 的/ 原型/ 向量/ 依旧/ 位于/ 输入/ 空间/ 中/ ,/ 从而/ 降低/ 了/ 在/ 输出/ 空间/ 中/ 保持/ 模式/ 内蕴/ 邻域/ 信息/ 的/ 能力/ ./ 本文/ 借助于/ 黎曼/ 对数/ 及/ 指数/ 映射/ ,/ 将/ SOM/ 从/ 线性/ 欧氏/ 空间/ 推广/ 到/ 一般/ 的/ 非线性/ 黎曼流/ 形/ 空间/ ,/ 得到/ 广义/ SOM/ (/ G/ -/ SOM/ )/ ./ G/ -/ SOM/ 使用/ 黎曼/ 距离/ 度量/ 模式/ 在/ 输入/ 空间/ 中/ 的/ 相似/ 程度/ ,/ 并/ 在/ 权值/ 更新/ 阶段/ 保证/ 更新/ 后/ 的/ 原型/ 向量/ 依旧/ 位于/ 输入/ 空间/ 中/ ,/ 从而/ 最大/ 程度/ 上/ 在/ 输出/ 空间/ 中/ 保持/ 输入/ 模式/ 的/ 内蕴/ 邻域/ 结构/ 信息/ ./ 我们/ 在/ FERET/ 人脸/ 图像/ 库上/ 进行/ 了/ 人脸/ 性别/ 鉴定/ 实验/ :/ 使用/ PGASFS/ [/ 9/ ]/ 技术/ 从/ 2D/ 人脸/ 图像/ 重构/ 3DNeedle/ -/ map/ ,/ 重构/ 出/ 的/ Needle/ -/ map/ 位于/ 黎曼流/ 形/ S2/ (/ n/ )/ 上/ ;/ 使用/ G/ -/ SOM/ 对/ Needle/ -/ map/ 进行/ 学习/ 及/ 分类/ ./ 实验/ 结果表明/ ,/ 当/ 模式/ 所在/ 的/ 输入/ 空间/ 为/ 非线性/ 流形/ 时/ ,/ G/ -/ SOM/ 的/ 性能/ 优于/ SOM/ ./ 2/ 自/ 组织/ 映射/ SOMSOM/ 由/ 两层/ 构成/ :/ 第/ 1/ 层为/ 输入/ 层/ ,/ 第/ 2/ 层为/ 输出/ 层/ ./ 通常/ ,/ 输出/ 神经元/ 在/ 输出/ 层以/ 一维/ 或是/ 二维/ 规则/ 网格/ 结构/ 排列/ ,/ 并且/ 输入/ 神经元/ 和/ 输出/ 神经元/ 是/ 全/ 互联/ 的/ ./ SOM/ 能够/ 将/ 输入/ 空间/ 中/ (/ 欧氏/ 空间/ )/ 的/ 模式/ 以/ 非线性/ 的/ 方式/ 映射/ 至/ 输出/ 空间/ ,/ 并/ 在/ 输出/ 空间/ 中/ 保持/ 输入/ 模式/ 的/ 拓扑/ 邻域/ 特性/ ./ 设/ SOM/ 有/ d/ 个/ 输入/ 神经元/ ,/ K/ 个/ 输出/ 神经元/ ,/ 称/ 输出/ 神经元/ i/ (/ 1/ / i/ / K/ )/ 的/ 权/ 向量/ 狑/ i/ ∈/ Rd/ 为/ 原型/ 向量/ ./ SOM/ 模型/ 可以/ 使用/ 序列/ 学习/ 算法/ 或是/ 批量/ 学习/ 算法/ 进行/ 学习/ [/ 1/ ]/ ./ 2.1/ 序列/ 学习/ 算法/ 给定/ 训练/ 数据/ 集/ {/ 狓/ i/ |/ 狓/ i/ ∈/ Rd/ }/ N/ 习/ 算法/ 的/ 第/ t/ 次/ 学习/ 步骤/ 如下/ [/ 1/ ]/ :/ (/ 1/ )/ 从/ 训练/ 数据/ 集中/ 随机/ 选择/ 一个/ 样本/ 作为/ 当前/ 学习/ 样本/ 狓/ (/ t/ )/ ./ (/ 2/ )/ 从/ 输出/ 神经元/ 中/ 找到/ 输入/ 为/ 狓/ (/ t/ )/ 时/ 的/ 最佳/ 匹配/ 单元/ (/ BMU/ )/ ,/ 记为/ c/ (/ 狓/ (/ t/ )/ )/ :/ 即/ 在/ 所有/ 输出/ 神经元/ 中/ ,/ BMU/ 的/ 原型/ 向量/ 与/ 当前/ 学习/ 样本/ 最为/ 接近/ ./ (/ 3/ )/ 更新/ BMU/ 及其/ 邻域/ 内/ 输出/ 神经元/ 的/ 原型/ 向量/ :/ 狑/ i/ (/ t/ +/ 1/ )/ =/ 狑/ i/ (/ t/ )/ +/ α/ (/ t/ )/ ·/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ ·/ (/ 狓/ (/ t/ )/ -/ 狑/ i/ (/ t/ )/ )/ 其中/ α/ (/ t/ )/ 为/ 学习/ 效率/ ,/ 邻域/ 函数/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ 可以/ 使用/ 高斯型/ :/ 式/ (/ 3/ )/ 中/ 的/ 狉/ i/ 和/ 狉/ c/ (/ 狓/ (/ t/ )/ )/ 分别/ 是/ 输出/ 神经元/ i/ 和/ c/ (/ 狓/ (/ t/ )/ )/ 在/ 输出/ 层/ 的/ 坐标/ 位置/ ./ 2.2/ 批量/ 学习/ 算法/ 序列/ 学习/ 算法/ 中/ ,/ 每/ 一步/ 学习/ 只/ 将/ 训练/ 集中/ 的/ 一个/ 样本/ 输入/ SOM/ ,/ 然后/ 更新/ BMU/ 及其/ 邻域/ 中/ 输出/ 神经元/ 的/ 原型/ 向量/ ;/ 而/ 批量/ 学习/ 算法/ 每次/ 学习/ 将/ 训练/ 集中/ 所有/ 样本/ 一次性/ 输入/ SOM/ ,/ 然后/ 对/ 所有/ 输出/ 神经元/ 的/ 原型/ 向量/ 更新/ ./ 一轮/ 批量/ 学习/ 的/ 基本/ 步骤/ 简要/ 描述/ 如下/ [/ 1/ ]/ :/ (/ 1/ )/ 划分/ 训练/ 数据/ 集/ ./ 依据/ 输出/ 神经元/ 的/ 原型/ 向量/ 集/ {/ 狑/ j/ }/ K/ 狓/ i/ (/ 1/ / i/ / N/ )/ 的/ BMU/ 为/ 输出/ 神经元/ j/ ,/ 则/ 将/ 狓/ i/ 划分/ 到/ Voronoi/ 区域/ Vj/ ./ (/ 2/ )/ 计算/ 每个/ Vj/ 中/ 样本/ 的/ 均值/ ./ 用/ nj/ 表示/ Voronoi/ 区域/ Vj/ 中/ 学习/ 样本/ 的/ 个数/ ,/ 样本/ 的/ 均值/ 记/ 为/ (/ 3/ )/ 更新/ 输出/ 神经元/ 的/ 原型/ 向量/ ./ SOM/ 由于/ 结构/ 简单/ 及/ 有效性/ ,/ 已经/ 在/ 众多/ 领域/ 得到/ 广泛应用/ ./ 当/ 数据分布/ 在/ 欧氏/ 空间/ 中/ 时/ ,/ SOM/ 可以/ 较/ 好/ 地/ 学习/ 得到/ 模式/ 的/ 拓扑/ 邻域/ 结构/ 信息/ ;/ 然/ Page3/ 而/ ,/ 当/ 数据分布/ 在/ 一般/ 的/ 黎曼流/ 形上/ 时/ ,/ 直接/ 应用/ SOM/ 就/ 不再/ 适合/ ./ 3/ 广义/ SOM/ :/ G/ -/ SOM3/ ./ 1/ 黎曼/ 指数/ 映射/ 及/ 黎曼/ 对数/ 映射/ 设/ M/ 是/ 一个/ 黎曼流/ 形/ ,/ 犐/ 是/ 黎曼流/ 形/ M/ 上/ 的/ 一点/ ,/ T/ 犐/ M/ 表示/ 在/ 该/ 点/ 处/ 的/ 切/ 平面/ ,/ 狏/ 是/ 该/ 切/ 平面/ 上/ 的/ 一个/ 向量/ (/ 狏/ ∈/ T/ 犐/ M/ ,/ 狏/ ≠/ 0/ )/ ,/ γ/ 狏/ 方向/ 的/ 测地/ 曲线/ ./ 那么/ ,/ 狏/ 在/ 点/ 犐/ (/ 基点/ )/ 处/ 的/ 黎曼/ 指数/ 映射/ [/ 10/ ]/ Exp/ 犐/ (/ 狏/ )/ 是/ 指/ :/ 将/ 向量/ 狏/ 以/ 犐/ 为/ 基点/ 沿着/ 测地线/ γ/ 狏/ 的/ 黎曼/ 距离/ d/ (/ 犐/ ,/ 犐/ / )/ 为/ ‖/ 狏/ ‖/ ,/ 亦/ 即/ 黎曼/ 对数/ 映射/ [/ 10/ ]/ 是/ 黎曼/ 指数/ 映射/ 的/ 逆映射/ :/ 以/ 二维/ 单位/ 球面/ 流形/ 犛/ 2/ 为例/ :/ 欧氏/ 空间/ 中/ 的/ 单位向量/ 犐/ ∈/ 犚/ 3/ 可以/ 看作/ 是/ 位于/ 二维/ 单位/ 球面/ 流形/ 上/ 的/ 点/ ,/ 亦/ 即/ 犐/ ∈/ 犛/ 2/ ./ 流形/ 犛/ 2/ 上/ 以/ 犐/ 为/ 基点/ 的/ 黎曼/ 指数/ 映射/ 及/ 黎曼/ 对数/ 映射/ 可以/ 用图/ 1/ 表示/ ./ 图/ 1/ 二维/ 单位/ 球面/ 流形/ 上/ 黎曼/ 指数/ 及/ 对数/ 映射/ 给定/ M/ 上/ 的/ N/ 个点/ {/ 狓/ 1/ ,/ 狓/ 2/ ,/ …/ ,/ 狓/ N/ }/ ,/ 其/ 内蕴/ 均值/ 定义/ 为/ 内蕴/ 均值/ 可以/ 使用/ 基于/ 梯度/ 下降/ 的/ 迭代法/ 进行/ 求解/ [/ 11/ ]/ :/ 其中/ ,/ τ/ 为/ 迭代/ 步长/ ./ 若/ wi/ 是/ 狓/ i/ 的/ 权重/ ,/ 带权/ 内蕴/ 均值/ :/ 狓/ -/ =/ WIntrinsicMeanw1/ ,/ 狓/ 1/ ;/ w2/ ,/ 狓/ 2/ ;/ …/ ;/ wN/ ,/ 狓/ =/ argmin/ 狓/ ∈/ M/ ∑/ N/ 可以/ 使用/ 下面/ 的/ 迭代/ 式/ (/ 11/ )/ 加以/ 求解/ :/ 狓/ -/ t/ +/ 1/ =/ Exp/ 狓/ -/ t3/ ./ 2G/ -/ SOM3/ ./ 2.1/ 序列/ 学习/ 算法/ 当/ 数据分布/ 于/ 弯曲/ 的/ 黎曼流/ 形/ 犕/ 上/ 时/ ,/ SOM/ 不能/ 正确/ 学习/ 得到/ 输入/ 模式/ 的/ 内蕴/ 拓扑/ 邻域/ 结构/ 信息/ ./ 以/ 流形/ 犕/ =/ 犛/ 2/ 为例/ ,/ 若/ 使用/ SOM/ 序列/ 学习/ 算法/ ,/ 那么/ 迭代/ 式/ (/ 2/ )/ 的/ 学习/ 结果/ 是/ 将/ 原型/ 向量/ 狑/ i/ (/ t/ )/ 对应/ 的/ 点/ 沿着/ 方向/ 狓/ (/ t/ )/ -/ 狑/ i/ (/ t/ )/ 移动/ 距离/ ‖/ Δ/ ‖/ 到达/ 狑/ i/ (/ t/ +/ 1/ )/ 所/ 对应/ 的/ 点/ ./ 这样/ 存在/ 的/ 问题/ 是/ :/ 学习/ 后/ 的/ 原型/ 向量/ 狑/ i/ (/ t/ +/ 1/ )/ 所/ 对应/ 的/ 点/ 不/ 能够/ 保证/ 仍然/ 位于/ 流形/ 犛/ 2/ 上/ ,/ 从而/ 导致/ 不能/ 准确/ 学习/ 得到/ 输入/ 模式/ 的/ 内蕴/ 拓扑/ 邻域/ 结构/ 信息/ ./ 在/ 这种/ 情形/ 下/ ,/ 最佳/ 的/ 方法/ 是/ 将/ 原型/ 向量/ 狑/ i/ (/ t/ )/ 对应/ 的/ 点/ 沿着/ 狓/ (/ t/ )/ 与/ 狑/ i/ (/ t/ )/ 之间/ 的/ 测地线/ 移动/ 距离/ ‖/ Δ/ ‖/ 到达/ 狑/ i/ (/ t/ +/ 1/ )/ 所/ 对应/ 的/ 点/ ./ 这一/ 目标/ 可以/ 用/ 以下/ 3/ 步来/ 实现/ (/ 如图/ 2/ 所示/ )/ :/ 上/ :/ 狏/ =/ Log/ 狑/ i/ (/ t/ )/ (/ 狓/ (/ t/ )/ )/ ./ Log/ 狑/ i/ (/ t/ )/ (/ 狓/ (/ t/ )/ )/ ./ 流形/ M/ 上/ ./ (/ a/ )/ 使用/ 黎曼/ 对数/ 映射/ 将点/ 狓/ (/ t/ )/ 映射/ 到切/ 平面/ T/ 狑/ i/ (/ t/ )/ M/ (/ b/ )/ 计算/ 在/ 切/ 平面/ 上/ 的/ 调整/ 量/ :/ Δ/ =/ α/ (/ t/ )/ ·/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ ·/ (/ c/ )/ 再/ 以/ 狑/ i/ (/ t/ )/ 为/ 基点/ ,/ 使用/ 黎曼/ 指数/ 映射/ 将/ Δ/ 映射/ 回/ 上述/ 3/ 个/ 步骤/ 可以/ 使用/ 下面/ 的/ 迭代/ 学习/ 公式/ 来/ 统一/ 描述/ :/ 狑/ i/ (/ t/ +/ 1/ )/ =/ Exp/ 狑/ i/ (/ t/ 需要/ 注意/ ,/ 在/ 确定/ 狓/ (/ t/ )/ 所/ 对应/ 的/ BMU/ 时/ ,/ 需要/ 使用/ 黎曼/ 距离/ 而/ 不是/ 欧氏/ 距离/ ,/ 即/ 使用/ G/ -/ SOM/ 的/ 迭代/ 学习/ 公式/ (/ 12/ )/ ,/ 一方面/ 可/ Page4/ 以/ 达到/ 将/ 原型/ 向量/ 向/ 当前/ 学习/ 样本/ 移动/ 的/ 目的/ (/ SOM/ 的/ 学习/ 目标/ )/ ;/ 另一方面/ ,/ 亦/ 可以/ 保证/ 学习/ 得到/ 的/ 原型/ 向量/ 仍然/ 位于/ 输入/ 流形/ 上/ ./ 3.2/ ./ 2/ 批量/ 学习/ 算法/ 当/ 数据分布/ 于/ 弯曲/ 黎曼流/ 形上/ 时/ ,/ SOM/ 的/ 批量/ 学习/ 算法/ 步骤/ 中/ 的/ (/ 4/ )/ 和/ (/ 5/ )/ 同样/ 不能/ 保证/ 学习/ 得到/ 的/ 原型/ 向量/ 所/ 对应/ 的/ 点/ 仍然/ 能够/ 位于/ 流形/ 上/ ./ 为此/ ,/ G/ -/ SOM/ 的/ 批量/ 学习/ 算法/ 在/ SOM/ 的/ 批量/ 学习/ 算法/ 基础/ 上/ 改进/ 如下/ :/ 用式/ (/ 14/ )/ 来/ 代替/ 式/ (/ 4/ )/ 计算/ 每个/ Voronoi/ 区域/ Vj/ 中/ 所有/ 样本/ 的/ 内蕴/ 均值/ 狓/ -/ 式/ (/ 5/ )/ 计算/ 狓/ -/ 狑/ i/ (/ t/ +/ 1/ )/ =/ 其中/ ,/ wj/ 为/ 狓/ -/ WIntrinsicMean/ (/ w1/ ,/ 狓/ -/ 实际上/ ,/ G/ -/ SOM/ 是/ SOM/ 的/ 推广/ ;/ 而/ SOM/ 是/ G/ -/ SOM/ 的/ 一种/ 特殊/ 情形/ ./ 以/ 序列/ 学习/ 算法/ 为例/ ,/ 当/ M/ 为/ 线性/ 流形/ 时/ ,/ 我们/ 有/ 由此/ ,/ 式/ (/ 12/ )/ 的/ 右端/ 为/ Exp/ 狑/ i/ (/ t/ )/ (/ Δ/ )/ =/ 狑/ i/ (/ t/ )/ +/ Δ/ 图/ 3/ =/ 狑/ i/ (/ t/ )/ +/ α/ (/ t/ )/ ·/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ ·/ Log/ 狑/ i/ (/ t/ )/ (/ 狓/ (/ t/ )/ )/ =/ 狑/ i/ (/ t/ )/ +/ α/ (/ t/ )/ ·/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ ·/ 狓/ (/ t/ )/ -/ 狑/ i/ (/ t/ (/ 亦/ 即/ 狑/ i/ (/ t/ +/ 1/ )/ =/ 狑/ i/ (/ t/ )/ +/ α/ (/ t/ )/ ·/ hc/ (/ 狓/ (/ t/ )/ )/ ,/ i/ (/ t/ )/ ·/ (/ 狓/ (/ t/ )/ -/ 狑/ i/ (/ t/ )/ )/ 式/ (/ 20/ )/ 完全/ 等同于/ 式/ (/ 2/ )/ ,/ 亦/ 即/ ,/ 流形/ M/ 退化/ 为/ 线性/ 流形/ 时/ ,/ G/ -/ SOM/ 的/ 序列/ 学习/ 算法/ 就/ 等价/ 于/ SOM/ 的/ 序列/ 学习/ 算法/ ./ 批量/ 学习/ 算法/ 亦/ 有/ 类似/ 的/ 结论/ ,/ 不再/ 赘述/ ./ 4/ 实验/ 及/ 分析/ 4.1/ 数据/ 集及/ 预处理/ FERET/ [/ 12/ ]/ 数据库/ 在/ 人脸识别/ 领域/ 已经/ 成为/ 标准/ 的/ 数据库/ ./ FERET/ 数据库/ 中/ 包含/ 有/ 大量/ 的/ 人脸/ 图像/ 分/ 属于/ 不同/ 的/ 人/ ;/ 每个/ 人均/ 有/ 多幅/ 包含/ 不同/ 姿态/ 、/ 视角/ 、/ 表情/ 、/ 照明/ 的/ 人脸/ 图像/ ./ 此外/ 性别/ 及/ 种族/ 类别/ 信息/ 在/ 该/ 数据库/ 中/ 也/ 得到/ 很/ 好/ 地/ 表达/ ./ 在/ 下面/ 的/ 实验/ 中/ ,/ 使用/ FERET/ 的/ 一个/ 子集/ ,/ 该/ 子集/ 包含/ 200/ 个人/ 的/ 200/ 幅/ 图像/ (/ 103/ 个/ 男性/ ,/ 97/ 个/ 女性/ ,/ 每人/ 一副/ 图像/ )/ ./ 数据/ 集中/ 的/ 每幅/ 图像/ 均/ 进行/ 预处理/ :/ 使用/ 剪切/ 、/ 旋转/ 、/ 缩放/ 、/ 对准/ 等/ 几何/ 运算/ 最终/ 得到/ 解析度/ 为/ 142/ ×/ 124/ 的/ 图像/ ,/ 并/ 对/ 图像/ 进行/ 直方图/ 均衡化/ ./ 图/ 3/ (/ a/ )/ 给出/ 了/ 数据/ 集中/ 的/ 5/ 幅/ 典型/ 的/ 经过/ 预/ Page5/ 处理/ 后/ 的/ 人脸/ 图像/ ./ 图/ 3/ (/ b/ )/ 是/ 使用/ PGASFS/ [/ 9/ ]/ 人脸/ 形状/ 恢复/ 技术/ 得到/ 的/ 对应/ 于图/ (/ a/ )/ 中/ 第一幅/ 和/ 最后/ 一幅/ 人脸/ 图像/ 的/ Needle/ -/ map/ ./ 4.2/ 犛/ 2/ (/ 狀/ )/ 上/ 的/ 黎曼/ 指数/ 及/ 对数/ 映射/ 我们/ 已经/ 知道/ ,/ 给定/ 2D/ 人脸/ 图像/ {/ 狓/ i/ |/ 1/ / i/ / N/ }/ ,/ 那么/ 使用/ PGASFS/ [/ 9/ ]/ 技术/ ,/ 可以/ 得到/ 一个/ 对应/ 的/ 3DNeedle/ -/ map/ 集/ {/ 狀/ i/ |/ 1/ / i/ / N/ }/ ,/ 其中/ 狓/ i/ ∈/ Rn/ ×/ 1/ 为/ 图像/ 向量/ ,/ 其/ 对应/ 的/ Needle/ -/ map/ 为狀/ i/ ∈/ Rn/ ×/ 3/ ,/ 并且/ 狀/ i/ 的/ 第/ p/ 行/ (/ 1/ / p/ / n/ ,/ n/ 是/ 人脸/ 图像/ 像素/ 的/ 个/ i/ ∈/ R1/ ×/ 3/ 是/ 单位向量/ ,/ 其/ 含义/ 是/ :/ 图像/ 狓/ i/ 中/ 第/ p/ 数/ )/ 狀/ p/ 个/ 像素/ 在/ 人脸/ 表面/ 上/ 对应点/ 处/ 的/ 单位/ 法/ 向量/ ./ 向量/ 狀/ p/ 点/ ,/ 亦/ 即/ 狀/ p/ 上/ 的/ 点/ ,/ 即狀/ i/ ∈/ 犛/ 2/ (/ n/ )/ ,/ 其中/ 犛/ 2/ (/ n/ )/ =/ ∏/ n/ 对于/ 流形/ 犛/ 2/ ,/ 当/ 基点/ 犐/ =/ (/ 0/ ,/ 0/ ,/ 1/ )/ 时/ ,/ 那么/ 切/ 平面/ T/ 犐/ 犛/ 2/ 上/ 的/ 一个/ 向量/ 可以/ 记/ 为/ 狏/ =/ (/ v1/ ,/ v2/ ,/ 0/ )/ ./ 因此/ 黎曼/ 指数/ 映射/ 为/ [/ 11/ ]/ Exp/ 犐/ (/ 狏/ )/ =/ v1/ ·/ sin/ ‖/ 狏/ ‖/ 对于/ 犛/ 2/ 上/ 的/ 一点/ 犐/ / =/ (/ x/ ,/ y/ ,/ z/ )/ ,/ 当/ 基点/ 为/ 犐/ =/ (/ 0/ ,/ 0/ ,/ 1/ )/ 时/ ,/ 黎曼/ 对数/ 映射/ 为/ 其中/ θ/ =/ arccos/ (/ z/ )/ ./ 若/ 给定/ 的/ 基点/ 犐/ =/ (/ x/ ,/ y/ ,/ z/ )/ ≠/ (/ 0/ ,/ 0/ ,/ 1/ )/ ,/ 必定/ 可以/ 通过/ 连续/ 的/ 两步/ 旋转/ (/ 先绕/ x/ 轴/ ,/ 再绕/ y/ 轴/ ,/ 反之/ 亦可/ )/ 运算/ 将/ 犐/ 的/ 坐标/ 变换/ 为/ (/ 0/ ,/ 0/ ,/ 1/ )/ ,/ 然后/ 再/ 利用/ 上述/ 两/ 式/ 得到/ 黎曼/ 指数/ 和/ 黎曼/ 对数/ 映射/ ./ 流形/ 犛/ 2/ (/ n/ )/ 上/ 的/ 黎曼/ 指数/ 映射/ 等价/ 于/ n/ 个/ 犛/ 2/ 流形/ 上/ 黎曼/ 指数/ 映射/ 的/ 直积/ ,/ 黎曼/ 对数/ 映射/ 类似/ [/ 9/ ]/ ./ 4.3/ 训练/ 及/ 识别/ 基于/ 减少/ SOM/ 输入/ 维数/ 及/ 使用/ 人脸/ 局部/ 特征/ 的/ 优势/ 的/ 目的/ [/ 3/ ]/ ,/ 在/ 学习/ 阶段/ ,/ 将/ 每个/ Needle/ -/ map/ 分割/ 为/ L/ =/ hw/ 分别/ 是/ 图像/ 的/ 高度/ 和/ 宽度/ ,/ h/ 和/ w/ 分别/ 是/ 子块/ 的/ 高度/ 和/ 宽度/ ./ 每个/ 子块/ 是/ 分布/ 在/ 流形/ 犛/ 2/ (/ m/ )/ 上/ 的/ 一个点/ ,/ m/ =/ h/ ·/ w/ ./ 需要/ 注意/ 的/ 是/ ,/ 在/ 训练/ 阶段/ ,/ 是/ 将/ 每个/ 子块/ 作为/ 输入/ 模式/ ,/ 共有/ N/ ·/ L/ 个/ 输入/ 模式/ ./ 模型/ 学习/ 完毕/ 后/ ,/ 可以/ 得到/ N/ 个/ 用于/ 训练/ 的/ Needle/ -/ map/ 的/ BMU/ 矩阵/ :/ 其中/ bij/ 表示/ 将/ 第/ i/ 个/ 训练/ Needle/ -/ map/ 的/ 第/ j/ 个子/ 块/ 作为/ 输入/ 时/ SOM/ 模型/ 的/ BMU/ ./ 在/ 识别/ 阶段/ ,/ 对于/ 一个/ 待/ 识别/ 的/ Needle/ -/ map/ ,/ 首先/ 将/ 它/ 划分/ 为/ L/ 个子/ 块/ ;/ 依次/ 将/ 这些/ 子块/ 输入/ SOM/ 模型/ ,/ 可/ 得到/ 一个/ BMU/ 向量/ :/ 其中/ ti/ 是/ 第/ i/ 个子/ 块/ 作为/ 输入/ 时/ SOM/ 模型/ 的/ BMU/ ./ 基于/ 犅/ 和/ 犅/ ,/ 使用/ Soft/ -/ KNN/ 机制/ [/ 3/ ]/ ,/ 可以/ 得到/ 一个/ 信度/ 矩阵/ ,/ 用于/ 度量/ 待/ 识别/ 的/ Needle/ -/ map/ 与/ 所有/ 训练样本/ 在/ 各个/ 子块/ 上/ 的/ 相似/ 程度/ :/ 其中/ cij/ 是/ 表示/ 待/ 识别/ 的/ Needle/ -/ map/ 与/ 第/ i/ 训练样本/ 在/ 第/ j/ 个子/ 块/ 上/ 相似/ 的/ 信度/ 值/ ./ 用/ M/ 表示/ 训练样本/ 中/ 男性/ 的/ 集合/ ,/ F/ 表示/ 女性/ 的/ 集合/ ,/ 那么/ 测试/ 样本/ 属于/ 男性/ 或是/ 女性/ 的/ 信度/ 可以/ 用/ 下面/ 两/ 式/ 分别/ 求得/ :/ 依据/ ScoreM/ 和/ ScoreF/ 值/ 的/ 大小/ ,/ 可以/ 完成/ 测试/ 样本/ 的/ 性别/ 判定/ ./ 4.4/ 结果/ 及/ 分析/ 为了/ 便于/ 比较/ ,/ 在/ 实验/ 中/ ,/ G/ -/ SOM/ 及/ SOM/ 的/ 输出/ 层/ 神经元/ 统一/ 配置/ 为/ 30/ ×/ 20/ 的/ 正/ 六边形/ 网格/ ,/ 且/ 均/ 使用/ 批量/ 学习/ 算法/ ./ 对于/ 每种/ 不同/ 的/ 子块/ 配置/ (/ h/ ×/ w/ )/ ,/ 实验/ 进行/ 10/ 次/ ;/ 每次/ 实验/ 中/ ,/ 随机/ 选择/ 50/ %/ 的/ 样本/ 作为/ 学习/ 样本/ (/ 为/ 降低/ 学习/ 过程/ 的/ 偏向/ 性/ ,/ 在/ 随机/ 选择/ 学习/ 样本/ 时/ ,/ 同时/ 需/ 兼顾/ 男女性/ 样本数/ 的/ 平衡/ )/ ,/ 识别/ 正确率/ 取/ 10/ 次/ 实验/ 结果/ 的/ 平均值/ ./ 表/ 1/ 中/ 给出/ 了/ G/ -/ SOM/ 与/ SOM/ 在/ 不同/ 子块/ 配置/ 下/ 识别/ 结果/ 的/ 比较/ ./ 图/ 4/ 则/ 给出/ 了/ G/ -/ SOM/ 在子/ 图/ 4G/ -/ SOM/ 在/ 子块/ 配置/ 为/ 4/ ×/ 4/ 时/ 10/ 次/ 实验/ 的/ Page6/ 块/ 配置/ 为/ 4/ ×/ 4/ 时/ 10/ 次/ 实验/ 的/ 错误/ 识别/ 样本/ 个数/ 分布/ 情况/ ./ 子块/ 大小/ h/ ×/ w4/ ×/ 49790.316283/ ./ 88/ ×/ 812487.617382/ ./ 716/ ×/ 1615384.721278/ ./ 832/ ×/ 3217582.526873/ ./ 2/ 注/ :/ 表中/ 错误/ 识别/ 个数/ 是/ 指/ 10/ 次/ 实验/ 中/ 累计/ 识别/ 错误/ 的/ 样本/ 个数/ ;/ 识别/ 正确率/ 是/ 指/ 10/ 次/ 实验/ 的/ 平均/ 识别/ 正确率/ ./ 从表/ 1/ 可以/ 看出/ ,/ 在/ 子块/ 配置/ 为/ 4/ ×/ 4/ 时/ ,/ G/ -/ SOM/ 及/ SOM/ 的/ 识别/ 正确率/ 均/ 为/ 最高/ ,/ 此时/ ,/ G/ -/ SOM/ 的/ 识别/ 正确率/ 为/ 90.3/ %/ ,/ 比/ SOM/ 的/ 识别/ 正确率/ 高/ 6.5/ 个/ 百分点/ ./ 同时/ ,/ 可以/ 发现/ :/ 随着/ 子块/ 规模/ 逐步/ 变/ 大/ ,/ G/ -/ SOM/ 和/ SOM/ 的/ 识别率/ 都/ 呈/ 下降/ 趋势/ ,/ 但是/ 在/ 相同/ 子块/ 配置/ 下/ ,/ G/ -/ SOM/ 的/ 识别率/ 总是/ 高于/ SOM/ 的/ 识别率/ ./ 图/ 4/ 则/ 给出/ 了/ G/ -/ SOM/ 在/ 子块/ 配置/ 为/ 4/ ×/ 4/ 时/ 10/ 次/ 实验/ 的/ 错误/ 识别/ 样本/ 个数/ 分布/ ./ 观察/ 图/ 4/ 可以/ 发现/ ,/ 10/ 次/ 实验/ 中/ ,/ 每次/ 识别/ 错误/ 的/ 样本/ 个数/ 差异/ 不是/ 很大/ ,/ 表明/ G/ -/ SOM/ 的/ 学习/ 结果/ 是/ 比较稳定/ 的/ ./ 在/ 实验/ 中/ ,/ 模式/ 分布/ 的/ 输入/ 空间/ 是/ 弯曲/ 的/ 黎曼流/ 形/ ./ G/ -/ SOM/ 能够/ 在/ 输出/ 空间/ 中/ 保持/ 模式/ 在/ 输入/ 空间/ 中/ 的/ 内蕴/ 拓扑/ 分布/ 特性/ ;/ 而/ SOM/ 总是/ 假设/ 输入/ 空间/ 是/ 线性/ 的/ 欧氏/ 空间/ ,/ 性能/ 劣于/ G/ -/ SOM/ 在/ 理论/ 上/ 是/ 可以/ 预见/ 的/ ,/ 而/ 实验/ 结果/ 完全/ 支持/ 我们/ 之前/ 的/ 理论/ 分析/ ./ 我们/ 还/ 在/ 同样/ 的/ 数据/ 集/ (/ 恢复/ 得到/ 的/ 200/ 幅/ Needle/ -/ map/ )/ 上/ 实现/ 了/ PCA/ +/ LDA/ [/ 13/ ]/ 及/ PGA/ +/ LDA/ [/ 14/ ]/ 的/ 性别/ 识别方法/ ./ 实验/ 同样/ 进行/ 10/ 次/ ,/ 每次/ 实验/ 中/ ,/ 随机/ 选择/ 50/ %/ 的/ 样本/ 作为/ 学习/ 样本/ ,/ 识别/ 正确率/ 取/ 10/ 次/ 实验/ 结果/ 的/ 平均值/ ./ 表/ 2/ 给出/ 了/ 对比/ 结果/ ./ SOMPCA/ +/ LDAG/ -/ SOMPGA/ +/ LDA/ 文献/ [/ 14/ ]/ 提出/ 的/ PGA/ +/ LDA/ 方法/ 是/ 基于/ 人脸/ 形状/ 信息/ 的/ 性别/ 识别/ 的/ 最新/ 研究成果/ ,/ G/ -/ SOM/ 的/ 识别/ 正确率/ (/ 90.3/ %/ )/ 非常/ 接近/ PGA/ +/ LDA/ 方法/ 的/ 正确率/ (/ 92.4/ %/ )/ ,/ 并且/ 明显/ 地/ 优于/ 通常/ 的/ PCA/ +/ LDA/ 方法/ ./ 这/ 表明/ ,/ 将/ G/ -/ SOM/ 用于/ 人脸/ 性别/ 识别/ 是/ 一种/ 有效/ 且/ 可行/ 的/ 方法/ ./ 5/ 结论/ 本文/ 将/ 经典/ 的/ 适用/ 于/ 线性/ 输入/ 空间/ 的/ SOM/ 算法/ 推广/ 到/ 一般/ 黎曼流/ 形/ 输入/ 空间/ 得到/ G/ -/ SOM/ ,/ 给出/ 了/ G/ -/ SOM/ 序列/ 学习/ 算法/ 及/ 批量/ 学习/ 算法/ ./ 理论/ 分析表明/ :/ G/ -/ SOM/ 是/ SOM/ 的/ 推广/ ;/ SOM/ 是/ G/ -/ SOM/ 的/ 特殊/ 情形/ ./ G/ -/ SOM/ 能够/ 依据/ 模式/ 的/ 实际/ 输入/ 空间/ 特性/ ,/ 在/ 输出/ 空间/ 中/ 保持/ 输入/ 模式/ 的/ 内蕴/ 拓扑/ 分布/ 特性/ ;/ SOM/ 则/ 总是/ 假设/ 模式/ 的/ 输入/ 空间/ 是/ 线性/ 流形/ ./ 因此/ ,/ 当/ 输入/ 模式/ 位于/ 非线性/ 流形/ 上时/ ,/ SOM/ 势必/ 要/ 劣于/ G/ -/ SOM/ ./ 在/ 基于/ 人脸/ 形状/ 的/ 性别/ 识别/ 上/ 的/ 实验/ 结果/ 支持/ 了/ 上述/ 结论/ ./ 需要/ 指出/ 的/ 是/ ,/ 对于/ G/ -/ SOM/ 的/ 序列/ 学习/ 算法/ 及/ 批量/ 学习/ 算法/ 而言/ ,/ 重要/ 的/ 一个/ 步骤/ 是/ 需要/ 知道/ 输入/ 模式/ 所在/ 流形/ 之上/ 的/ 黎曼/ 指数/ 映射/ 及/ 黎曼/ 对数/ 映射/ ./ 如果/ 能够/ 准确/ 知道/ 输入/ 模式/ 位于/ 何种/ 流形/ 之上/ (/ 如/ 文中/ 的/ Needle/ -/ map/ 必定/ 位于/ 流形/ 犛/ 2/ (/ n/ )/ 上/ )/ ,/ 应用/ G/ -/ SOM/ 是/ 自然/ 的/ ./ 但是/ ,/ 在/ 很多/ 应用/ 中/ ,/ 往往/ 只能/ 知道/ 输入/ 模式/ 位于/ 某个/ 特定/ 的/ 流形/ 上/ ,/ 却/ 并/ 不能/ 准确/ 知道/ 是/ 何种/ 流形/ ;/ 也就是说/ ,/ 我们/ 不能/ 显式/ 给出/ 黎曼/ 指数/ 映射/ 及/ 黎曼/ 对数/ 映射/ ./ 这时/ ,/ 应用/ G/ -/ SOM/ 就/ 会/ 存在/ 困难/ ./ 如何/ 根据/ 训练/ 模式/ 集/ 找到/ 或是/ 逼近/ 数据/ 所在/ 流形/ 的/ 黎曼/ 指数/ 映射/ 及/ 黎曼/ 对数/ 映射/ ,/ 这是/ 我们/ 需要/ 进一步/ 研究/ 的/ 工作/ ./ 

