Page1/ 利用/ 平面/ 虚拟/ 点光源/ 的/ 素描/ 图像/ 绘制/ 佟强/ 张松海/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 摘要/ 素描画/ 是/ 一种/ 常见/ 的/ 艺术/ 形式/ ,/ 它/ 通过/ 单色/ 线条/ 来/ 表现/ 直观/ 世界/ 中/ 的/ 事物/ ,/ 而/ 能够/ 体现/ 场景/ 层次/ 的/ 高光/ 和/ 阴影/ 则/ 是/ 表现/ 的/ 重点/ ./ 艺术家/ 经常/ 会/ 对/ 场景/ 的/ 光影/ 进行/ 艺术化/ 的/ 夸张/ ,/ 这种/ 艺术/ 夸张/ 会/ 更好/ 地/ 表现/ 作品/ 主题/ ./ 首先/ 提出/ 一种/ 二维/ 图像/ 平面/ 的/ 虚拟/ 点光源/ 位置/ 估计/ 算法/ ,/ 根据/ 输入/ 的/ 真实/ 图像/ 的/ 距离/ 场/ 和/ 亮度/ 场/ ,/ 计算/ 虚拟/ 点光源/ 位置/ ,/ 使/ 其/ 对/ 原/ 图像/ 的/ 亮度/ 梯度/ 影响/ 最小/ ,/ 即/ 最/ 符合/ 原/ 场景/ 中/ 的/ 光照/ 方向/ ./ 然后/ 提出/ 基于/ 二维/ 虚拟/ 点光源/ 的/ 阴影/ 增强/ 算法/ ,/ 加强/ 了/ 真实/ 图像/ 中/ 的/ 明暗/ 对比/ ,/ 因此/ 能够/ 在/ 最终/ 的/ 素描/ 结果/ 中/ 表现/ 出/ 光影/ 效果/ ./ 使用/ 该/ 方法/ 生成/ 的/ 素描画/ ,/ 在/ 物体/ 边界/ 处/ 具有/ 更好/ 的/ 明暗/ 对比/ ,/ 从而/ 使得/ 最终/ 绘制/ 图像/ 更/ 具有/ 素描画/ 的/ 光影/ 增强/ 特点/ ./ 关键词/ 非/ 真实感/ 绘制/ ;/ 素描/ ;/ 虚拟/ 点光源/ ;/ 亮度/ 梯度/ 场/ ;/ 图像处理/ 1/ 引言/ 素描画/ 是/ 一种/ 单纯/ 使用/ 线条/ 描写/ 的/ 绘画/ 形式/ ,/ 以/ 单色/ 线条/ 的/ 明暗/ 深浅/ 来/ 表现/ 事物/ 的/ 本质/ 与/ 神韵/ ./ 通过/ 对/ 素描画/ 的/ 创作/ 过程/ 进行/ 考察/ ,/ 可以/ 发现/ ,/ 画家/ 在/ 绘制/ 素描画/ 时/ ,/ 不仅/ 是/ 简单/ 地/ 临摹/ 真实/ 场景/ ,/ 更要/ 结合/ 自己/ 的/ 艺术/ 感受/ ,/ 减弱/ 图像/ 中/ 的/ 反光/ ,/ 加强/ 明暗/ 交界线/ ,/ 使/ 明暗/ 对比/ 增强/ ,/ 并/ 加强/ 物体/ 轮廓/ ,/ 以/ 带给/ 画面/ 形体/ 特征/ ./ 尤其/ 是/ 对于/ 在/ 素描画/ 中/ 占据/ 很大/ 比/ Page2/ 重/ 的/ 人物/ 素描/ ,/ 画家/ 往往/ 会/ 使用/ 较强/ 的/ 光线/ 变化/ 和/ 较大/ 的/ 明暗/ 反差/ 来/ 处理/ 人物形象/ ,/ 体现/ 人物/ 的/ 精神/ 品质/ ./ 可以/ 说/ ,/ 对于/ 光影/ 的/ 处理/ ,/ 在/ 素描画/ 绘制/ 中/ ,/ 占据/ 了/ 非常/ 重要/ 的/ 地位/ ./ 本文/ 改进/ 了/ 已有/ 的/ 素描/ 风格/ 铅笔画/ 自动/ 生成/ 算法/ ,/ 在/ 输入/ 的/ 真实/ 场景/ 的/ 二维/ 图像/ 平面/ 中/ 引入/ 一个/ 虚拟/ 的/ 点光源/ ,/ 该/ 虚拟/ 点光源/ 位于/ 二维/ 平面/ 上/ ,/ 而/ 无需/ 还原/ 出/ 三维/ 场景/ ,/ 其/ 计算/ 量/ 远/ 小于/ 三维/ 重构/ 和/ 光照/ 模型/ 计算/ ./ 并/ 提出/ 一种/ 二维/ 图像/ 平面/ 上/ 的/ 虚拟/ 点光源/ 位置/ 估计/ 算法/ ,/ 根据/ 输入/ 的/ 真实/ 图像/ 的/ 距离/ 场/ 和/ 亮度/ 场/ ,/ 计算/ 虚拟/ 点光源/ 位置/ ,/ 使/ 其/ 对/ 原/ 图像/ 的/ 亮度/ 梯度/ 影响/ 最小/ ,/ 即/ 最/ 符合/ 原/ 场景/ 中/ 的/ 光照/ 方向/ ./ 本文/ 还/ 提出/ 了/ 一种/ 阴影/ 增强/ 算法/ ,/ 通过/ 使用/ 二维/ 虚拟/ 点光源/ 照射/ 图像/ 中/ 的/ 各条/ 边缘/ ,/ 在/ 边缘/ 的/ 另一侧/ 产生/ 阴影/ ,/ 从而/ 模拟出/ 素描画/ 中/ 的/ 明暗/ 反差/ 效果/ ,/ 并/ 最终/ 绘制/ 得到/ 具有/ 素描画/ 风格/ 的/ 非/ 真实感/ 图像/ ./ 该/ 方法/ 加强/ 了/ 真实/ 图像/ 中/ 的/ 明暗/ 对比/ ,/ 因此/ 能够/ 更好/ 地/ 表现/ 出/ 素描画/ 中/ 的/ 光影/ 效果/ ./ 本文/ 第/ 2/ 节/ 介绍/ 目前/ 针对/ 素描/ 风格/ 图像/ 生成/ 的/ 一些/ 相关/ 工作/ ;/ 第/ 3/ 节/ 介绍/ 利用/ 二维/ 点光源/ 的/ 素描/ 图像/ 绘制/ 的/ 系统/ 框架/ ;/ 第/ 4/ 节/ 讨论/ 计算/ 虚拟/ 点光源/ 的/ 详细/ 步骤/ 以及/ 该/ 点光源/ 对/ 图像/ 亮度/ 梯度/ 场/ 的/ 影响/ ;/ 第/ 5/ 节/ 描述/ 在/ 点光源/ 影响/ 下/ 的/ 带有/ 阴影/ 的/ 图像/ 强度/ 场/ 的/ 生成/ 过程/ 以及/ 随后/ 的/ 绘制/ 步骤/ ;/ 第/ 6/ 节/ 给出/ 本文/ 算法/ 的/ 一些/ 实验/ 结果/ ,/ 与/ 目前/ 已有/ 的/ 素描/ 图像/ 生成/ 算法/ 进行/ 比较/ ,/ 并/ 在/ 第/ 7/ 节/ 进行/ 总结/ ./ 2/ 相关/ 工作/ 在/ 早期/ 的/ 二维/ 绘制/ 系统/ PencilSketch/ [/ 1/ ]/ 中/ ,/ 使用/ 一个/ 基于/ 鼠标/ 的/ 虚拟/ 写字板/ 来/ 进行/ 交互式/ 的/ 素描/ 风格/ 图像/ 绘制/ ./ Durand/ [/ 2/ ]/ 将/ 笔划/ 和/ 高层/ 属性/ 分/ 离开/ ,/ 以/ 用于/ 交互式/ 绘制/ ./ 在/ 文献/ [/ 3/ ]/ 中/ ,/ Mao/ 等/ 提出/ 将/ 线条/ 积分/ 卷积/ (/ LineIntegralConvolution/ ,/ LIC/ )/ 方法/ 用于/ 铅笔画/ ./ 在/ 文献/ [/ 4/ -/ 5/ ]/ 中/ ,/ Sousa/ 等/ 通过/ 使用/ 电子扫描/ 显微镜/ ,/ 仔细/ 地/ 研究/ 了/ 真实/ 绘画/ 中/ 的/ 铅笔/ 与/ 画纸/ 的/ 交互/ 情况/ ,/ 从/ 物理/ 的/ 角度/ 构建/ 出/ 铅笔/ 笔划/ 模型/ ./ 在/ 文献/ [/ 6/ -/ 7/ ]/ 中/ 作者/ 讨论/ 了/ 笔墨/ (/ pen/ -/ and/ -/ ink/ )/ 模型/ ./ 也/ 有/ 一些/ 研究/ 工作/ 针对/ 输入/ 二维/ 原/ 图像/ ,/ 生成/ 具有/ 素描/ 风格/ 的/ 图像/ ./ Shiraishi/ 等/ [/ 8/ ]/ 使用/ 一种/ 原始/ 图像/ 局部/ 近似/ 的/ 方法/ 来/ 进行/ 绘制/ ,/ 其/ 方法/ 主要/ 分为/ 三个/ 步骤/ :/ 笔划/ 分布/ 估计/ 、/ 笔划/ 生成/ 、/ 笔划/ 排序/ 与/ 绘制/ ./ Hertzmann/ [/ 9/ ]/ 使用/ 样条/ 曲线/ 样式/ 的/ 画/ 刷/ 笔划/ ,/ 在/ 多个/ 层次/ 上/ 进行/ 绘制/ ,/ 较/ 小/ 的/ 画/ 刷/ 绘制/ 了/ 较/ 上层/ 的/ 图像/ ,/ 而/ 较大/ 的/ 画/ 刷/ 绘制/ 了/ 较/ 下层/ 的/ 图像/ ./ 文献/ [/ 10/ ]/ 引入/ 了/ 几何/ 图像/ 矩/ (/ geometricimagemoment/ )/ 的/ 概念/ 来/ 指导/ 计算/ 图像/ 中/ 各个/ 区域/ 的/ 向量/ ,/ 在/ 图像/ 的/ 不同/ 区域/ 上/ 体现/ 出/ 不同/ 的/ 笔划/ 方向/ ,/ 突出/ 了/ 区域/ 之间/ 的/ 边界/ 效果/ ./ 这些/ 素描/ 风格/ 图像/ 绘制/ 方法/ 均/ 由/ 原/ 图像/ 进行/ 直接/ 处理/ ,/ 如/ 边缘/ 提取/ 、/ 滤波/ 等/ 操作/ ,/ 这种/ 做法/ 忠实/ 于原/ 图像/ 的/ 结构/ 与/ 明暗/ 对比/ ./ 在/ 对/ 实际/ 素描/ 作品/ 的/ 观察/ 中/ 可以/ 发现/ ,/ 画家/ 为了/ 体现/ 出所/ 绘制/ 场景/ 的/ 层次感/ ,/ 会/ 采用/ 增强/ 明暗/ 对比/ 等/ 方法/ ,/ 在/ 最终/ 绘制/ 结果/ 中/ 加入/ 一些/ 阴影/ 和/ 高光/ 区域/ ./ 这些/ 区域/ 并非/ 实际/ 场景/ 中/ 真实/ 存在/ 的/ 区域/ ,/ 而是/ 画家/ 为了/ 追求/ 艺术/ 效果/ ,/ 根据/ 其/ 主观/ 感受/ 加入/ 的/ ,/ 而/ 上述/ 的/ 二维/ 图像/ 生成/ 素描/ 风格/ 算法/ 则/ 无法/ 模拟/ 真实/ 素描画/ 中/ 普遍存在/ 的/ 虚拟/ 光影/ 效果/ ./ 图/ 1/ 真实/ 场景/ 与/ 素描/ 作品/ 的/ 对比/ (/ 上图/ 为/ 真实/ 的/ 静物/ 场景/ ,/ 下图/ 为/ 画家/ 根据/ 该/ 场景/ 所/ 创造/ 的/ 素描/ 作品/ ./ 可以/ 发现/ ,/ 在/ 物体/ 边界/ 上/ ,/ 存在/ 着/ 画家/ 根据/ 主观/ 增强/ 的/ 阴影/ 效果/ )/ 为了/ 实现/ 这种/ 素描/ 风格/ 中/ 的/ 阴影/ 效果/ ,/ 已有/ 研究/ 主要/ 基于/ 三维/ 场景/ 的/ 光照/ 模型/ 来/ 实现/ ./ Hertzmann/ 在/ 基于/ 笔划/ 的/ 油画/ 绘制/ 中/ ,/ 引入/ 了/ 笔划/ 高度/ 场/ 并/ 建立/ 了/ 简单/ 的/ Phong/ 光照/ 模型/ [/ 11/ ]/ ,/ 以/ 实现/ 笔划/ 的/ 立体感/ ./ Winkenbach/ 和/ Salesin/ [/ 12/ ]/ 按照/ 深度/ 优先/ 顺序/ 进行/ 绘制/ ,/ 并/ 划分/ 图像/ 平面/ ,/ 来/ 计算/ 可见/ 性/ ./ 他们/ 根据/ 纹理/ 、/ 阴影/ 和/ 方向性/ ,/ 使用/ Salisbury/ [/ 13/ ]/ 的/ 阴影/ 线/ 算法/ 来/ 绘制/ 每个/ 可见/ 曲面/ 的/ 阴影/ 线/ ./ 文献/ [/ 14/ ]/ 使用/ 光照/ 色调/ 来/ 构造/ 一个/ 非/ 真实感/ 光照/ 模型/ ./ 文献/ [/ 15/ ]/ 将/ 场景/ 分为/ 若干层/ ,/ 并/ 根据/ 各层/ 所/ 组合/ 出/ 的/ 颜色/ 温度/ 来/ 决定/ 光照/ 效果/ ./ 这些/ 方法/ 均/ 基于/ 三维/ 场景/ ,/ 当/ 用户/ Page3/ 输入/ 仅为/ 单幅/ 二维/ 图像/ 时/ ,/ 要/ 恢复/ 出/ 准确/ 的/ 三维/ 场景/ 需要/ 大量/ 工作/ ./ 文献/ [/ 16/ ]/ 在/ 图像/ 上/ 构造/ 阴影/ 密度/ 图来/ 获取/ 图像/ 中/ 存在/ 的/ 阴影/ ,/ 但/ 这种/ 方法/ 只/ 适用/ 于/ 较/ 直/ 的/ 物体/ ./ 3/ 虚拟/ 点光源/ 下/ 的/ 素描/ 算法/ 框架/ 本文/ 利用/ 一个/ 虚拟/ 二维/ 点光源/ 来/ 指导/ 白/ 噪声/ 图/ 和/ 图像/ 向量场/ 的/ 生成/ 以及/ 阴影/ 的/ 计算/ ,/ 从而/ 为/ 最终/ 素描/ 图像/ 带来/ 增强/ 的/ 光影/ 效果/ ./ 在/ 该/ 方法/ 中/ ,/ 通过/ 最小化/ 亮度/ 能量/ 来/ 寻找/ 点光源/ ,/ 使用/ 该/ 点光源/ 来/ 调整/ 控制/ 铅笔/ 笔划/ 方向/ 的/ 图像/ 向量场/ ,/ 使得/ 各个/ 笔划/ 方向/ 更/ 趋近/ 于/ 光线方向/ ./ 同时/ ,/ 根据/ 该/ 点光源/ 在/ 图像/ 强度/ 场中/ 生成/ 阴影/ 区域/ ,/ 以/ 获得/ 用来/ 指导/ 白/ 噪声/ 图/ 的/ 阴影/ 强度/ 场/ ./ 图/ 2/ 带有/ 虚拟/ 点光源/ 的/ 素描/ 图像/ 绘制/ 算法/ 流程/ 4/ 虚拟/ 点光源/ 位置/ 估计/ 本文/ 算法/ 在/ 绘制/ 过程/ 中/ 引入/ 了/ 一个/ 虚拟/ 的/ 二维/ 点光源/ ,/ 用于/ 实现/ 最终/ 素描/ 风格/ 图像/ 中/ 的/ 光影/ 效果/ ./ 需要/ 说明/ 的/ 是/ ,/ 该/ 点光源/ 与/ 三维/ 光照/ 模型/ 中/ 使用/ 的/ 点光源/ 有所不同/ ,/ 后者/ 是/ 三维/ 物理/ 世界/ 中/ 真实/ 存在/ 的/ 一个点/ ,/ 且/ 其/ 照明/ 模型/ 符合/ 反射定律/ 、/ 折射/ 定律/ 等/ 与/ 光照/ 有关/ 的/ 物理/ 定律/ ./ 在/ 本文/ 方法/ 中/ 所/ 引入/ 的/ 点光源/ O/ ,/ 只是/ 人工/ 定义/ 在/ 二维/ 图像/ 平面/ 中/ 的/ 一个/ 虚拟/ 点/ ,/ 其/ 对/ 像素/ P/ 的/ 照射/ 方向/ 为/ 二维/ 平面/ 中/ 的/ OP/ 射线/ 方向/ ./ 在/ 素描/ 图像/ 中/ 往往/ 存在/ 高光区/ ,/ 这些/ 区域/ 在/ 实际/ 的/ 三维/ 场景/ 中/ 一般/ 受到/ 光线/ 的/ 直接/ 照射/ ,/ 画家/ 根据/ 自己/ 的/ 主观/ 感受/ 而/ 提高/ 了/ 这些/ 区域/ 的/ 亮度/ ./ 在/ 高光/ 区域/ 内/ 的/ 亮度/ 梯度/ 较/ 平缓/ ,/ 也/ 就是/ 区域/ 内/ 的/ 边缘/ 图/ 2/ 给出/ 了/ 算法/ 的/ 主要/ 流程/ ./ 该/ 素描/ 图像/ 生成/ 算法/ 主要/ 由/ 两/ 部分/ 组成/ ,/ 首先/ 对/ 虚拟/ 点光源/ 的/ 位置/ 进行/ 估计/ ,/ 再/ 根据/ 该/ 结果/ 来/ 指导/ 带有/ 阴影/ 效果/ 的/ 图像/ 噪声/ 图/ 的/ 生成/ ./ 在/ 虚拟/ 点光源/ 位置/ 估计/ 过程/ 中/ ,/ 通过/ 构造/ 一个/ 距离/ 场/ ,/ 计算/ 图像/ 中/ 的/ 各个/ 像素/ 到/ 边缘/ 的/ 距离/ ,/ 并/ 在/ 距/ 边缘/ 较远/ 的/ 区域/ 中/ 寻找/ 一个/ 像素/ 位置/ ,/ 当以/ 该/ 位置/ 作为/ 点光源/ 时/ ,/ 能够/ 最好/ 地/ 符合/ 整个/ 真实/ 图像/ 的/ 亮度/ 方向/ ./ 以该/ 位置/ 作为/ 该/ 图像/ 中/ 的/ 虚拟/ 点光源/ 位置/ ,/ 调整/ 图像/ 向量场/ 的/ 方向/ ,/ 使/ 其/ 在/ 最终/ 绘制/ 时/ 能够/ 体现/ 出/ 光照/ 方向/ ./ 在/ 阴影/ 噪声/ 图/ 生成/ 过程/ 中/ ,/ 利用/ 图像/ 边缘/ 提取/ 的/ 结果/ ,/ 在/ 各条/ 边缘/ 相对/ 点光源/ 的/ 另一侧/ 生成/ 逐渐/ 衰减/ 的/ 阴影/ ,/ 从而/ 获得/ 带有/ 阴影/ 的/ 原/ 图像/ 强度/ 场/ ,/ 再/ 由/ 该/ 强度/ 场/ 指导/ 生成/ 白/ 噪声/ 图/ ,/ 并/ 利用/ LIC/ 方法/ 进行/ 绘制/ ./ 本文/ 将/ 在/ 随后/ 对/ 这/ 两/ 部分/ 内容/ 分别/ 给予/ 详细/ 说明/ ./ 较少/ ./ 当/ 图像/ 中/ 存在/ 一个二维/ 点光源/ 时/ ,/ 该/ 光源/ 所在/ 像素/ 也/ 应当/ 位于/ 较/ 明亮/ 的/ 区域/ 内/ ,/ 即/ 与/ 图像/ 中/ 的/ 边缘/ 相距/ 较远/ ./ 本文/ 首先/ 计算/ 图像/ 中/ 各个/ 像素/ 到/ 最近/ 边缘/ 的/ 距离/ ,/ 再/ 在/ 距离/ 边缘/ 较远/ 的/ 区域/ 中/ 寻找/ 最佳/ 的/ 虚拟/ 点光源/ 的/ 位置/ ./ 4.1/ 距离/ 场/ 构造/ 本文/ 首先/ 使用/ 文献/ [/ 17/ ]/ 中/ 的/ 一致/ 线条/ 画/ 绘制/ 算法/ (/ CoherenceLineDrawing/ ,/ CLD/ )/ 方法/ 生成/ 原/ 图像/ 的/ 线条图/ L/ (/ x/ )/ ∈/ {/ 0/ ,/ 255/ }/ ,/ 其中/ 0/ (/ black/ )/ 表示/ 该/ 像素/ 位于/ 线条/ 上/ ./ 该/ 方法/ 通过/ 基于/ 核/ 的/ 非线性/ 向量/ 平滑/ 方法/ ,/ 计算/ 出/ 一个/ 平滑/ 、/ 保持/ 特征/ 的/ 局部/ 边缘/ 流/ ,/ 称为/ 边缘/ 正切/ 流/ (/ EdgeTangentFlow/ ,/ ETF/ )/ ./ 然后/ ,/ 使用/ 基于/ 流/ 的/ 各向异性/ 的/ 高斯/ 差分/ (/ Difference/ -/ of/ -/ Gaussians/ ,/ DoG/ )/ 方法/ 来/ 直接/ 生成/ 线条/ 效果/ ./ 图/ 3/ (/ b/ )/ 显示/ 了/ 输入/ 图像/ 相应/ 的/ 线条图/ ./ Page4/ 以/ 线条图/ L/ (/ x/ )/ 中/ 的/ 黑色/ 像素/ (/ 也/ 就是/ 边缘/ )/ 作为/ 起始/ 的/ 种子/ 点/ ,/ 利用/ 文献/ [/ 18/ ]/ 中/ 的/ JFA/ (/ JumpFloodingAlgorithm/ )/ 方法/ ,/ 可以/ 构造/ 距离/ 场/ D/ (/ x/ )/ ,/ 用以/ 表示/ 图像/ 中/ 各/ 像素/ 到/ 边缘/ 的/ 距离/ ./ JFA/ 的/ 算法/ 思想/ 是/ 采用/ “/ 跳跃/ ”/ 的/ 方式/ ,/ 传播/ 像素/ 的/ 信息/ ./ 通过/ 迭代/ 地/ 进行/ 步长/ 减半/ 的/ 若干次/ 跳跃/ 计算/ ,/ 当/ 完成/ 了/ 步长/ 为/ 1/ 的/ 跳跃/ 之后/ ,/ 图像/ 中/ 的/ 所有/ 像素/ 都/ 会/ 对应/ 一个/ 距离/ 最近/ 的/ 种子/ 点/ ./ 对于/ 大小/ 为/ n/ ×/ n/ 的/ 图像/ 来说/ ,/ 在/ logn/ 轮后/ 就/ 可以/ 计算/ 出/ 整个/ 距离/ 场/ ./ 将/ 该/ 距离/ 场/ 表示/ 为/ D/ (/ x/ )/ ∈/ {/ 0/ ,/ 255/ }/ ,/ 其中/ 0/ (/ black/ )/ 表示/ 该/ 像素/ 到/ 最近/ 种子/ 点/ 的/ 距离/ 为/ 最远/ ,/ 255/ (/ white/ )/ 表示/ 该/ 像素/ 与/ 最近/ 种子/ 点/ 重叠/ (/ 该/ 像素/ 本身/ 就是/ 种子/ 点/ )/ ./ 图/ 3/ (/ c/ )/ 表示/ 了/ 使用/ JFA/ 方法/ 所/ 构造/ 出/ 的/ 一个/ 图像/ 距离/ 场/ ./ 4.2/ 虚拟/ 点光源/ 估计/ 图像/ 强度/ 场/ 是/ 素描/ 风格/ 图像/ 绘制/ 中/ 常用/ 的/ 方法/ ,/ 它/ 表示/ 了/ 图像/ 中/ 各个/ 像素/ 的/ 颜色/ 强度/ ./ 在/ Luv/ 颜色/ 空间/ 内/ 构造/ 原/ 图像/ 的/ 强度/ 场/ I/ (/ x/ )/ ,/ 在/ 强度/ 场中/ 的/ 各/ 像素/ 的/ 值/ I/ (/ x/ ,/ y/ )/ 表示/ 了/ 像素/ (/ x/ ,/ y/ )/ 的/ 颜色/ P/ (/ x/ ,/ y/ )/ 与/ 指定/ 颜色/ C/ 的/ 相似性/ ./ P/ (/ x/ ,/ y/ )/ 与/ C/ 越/ 相似/ ,/ 则/ I/ (/ x/ ,/ y/ )/ 越大/ ./ 本文/ 使用/ 文献/ [/ 8/ ,/ 10/ ]/ 中/ 的/ 方法/ 将/ 像素/ 强度/ 定义/ 为/ 其中/ ,/ d/ (/ C1/ ,/ C2/ )/ ∈/ R/ 为/ C1/ 和/ C2/ 两种/ 颜色/ 在/ Luv/ 颜色/ 空间/ 中/ 的/ 欧氏/ 距离/ ./ 使用/ 如下/ 式/ 所示/ 的/ 函数/ F/ (/ d/ )/ ∈/ [/ 0/ ,/ 255/ ]/ 将/ 颜色/ 距离/ d/ 映射/ 到/ 强度/ 的/ 值域/ F/ (/ d/ )/ =/ 其中/ d0/ 是/ 根据/ 实验/ 调节/ 的/ 参数/ ./ 令/ 图像/ 强度/ 场中/ 的/ 各/ 像素/ X/ 的/ 强度/ 的/ 梯度/ 幅角/ 为/ θ/ (/ X/ )/ ,/ 该幅角/ 表示/ 了/ 像素/ 在/ 真实/ 三维/ 场景/ 中/ 所/ 受到/ 光照/ 的/ 方向/ ./ 本文/ 按照/ 如下/ 方式/ 定义/ 像素/ X/ 在/ 点光源/ P/ 的/ 照射/ 下/ 所/ 产生/ 的/ 影子/ 像素/ X/ ./ 由/ P/ 出发/ 存在/ 一条/ 经过/ 像素/ X/ 的/ 射线/ PX/ ,/ 图像/ 中/ 与/ 该条/ 射线/ 最/ 接近/ 的/ 下/ 一个/ 像素/ X/ 即为/ X/ 在/ P/ 的/ 照射/ 下/ 所/ 产生/ 的/ 影子/ ./ 射线/ PX/ 与/ PX/ 之间/ 的/ 角度/ 即/ 为/ 像素/ X/ 在/ P/ 的/ 照射/ 下/ 所/ 产生/ 的/ 阴影/ 向量/ 幅角/ ,/ 记/ 为/ θ/ P/ (/ X/ )/ ./ P/ 在/ 图像/ I/ 中/ 的/ 全部/ N/ 个/ 像素/ 上/ 具有/ 的/ 平均/ 向量/ 幅角/ 记为/ θ/ P/ ./ 将/ 该/ 虚拟/ 点光源/ 表示/ 为/ O/ ,/ 利用/ 所/ 生成/ 的/ 距离/ 场/ ,/ 在/ 较/ 暗/ 区域/ (/ 到/ 边缘/ 的/ 距离/ 较远/ 的/ 区域/ )/ 中/ ,/ 通过/ 下/ 式/ 计算/ 出/ O/ ,/ 作为/ 素描/ 图像/ 绘制/ 中/ 所/ 使用/ 的/ 虚拟/ 点光源/ ./ O/ =/ minP/ ∑/ X/ ∈/ I/ 其中/ T/ 表示/ 较暗/ 区域/ 的/ 阈值/ ./ 4.3/ 向量场/ 提取/ 向量场/ 是/ 素描/ 绘制/ 中/ 非常/ 重要/ 的/ 因素/ ,/ 它/ 确定/ 了/ 笔划/ 的/ 方向/ ,/ 而/ 素描画/ 主要/ 是/ 通过/ 笔划/ 方向/ 来/ 表达/ 物体/ 的/ 轮廓/ 和/ 光影/ 效果/ ./ 本文/ 首先/ 通过/ 使用/ 两个/ 3/ ×/ 3/ 的/ 模板/ 对/ 图像/ 亮度/ 进行/ 卷积/ ,/ 提取/ 原/ 图像/ 的/ 亮度/ 在/ 水平/ 和/ 竖直/ 两个/ 方向/ 上/ 的/ 梯度/ 场/ 作为/ 原始/ 向量场/ ,/ 这/ 两个/ 卷积/ 模板/ 分别/ 是/ 从而/ 提取/ 出原/ 图像/ 的/ 亮度/ 场/ 在/ 水平/ 方向/ 和/ 竖直/ 方向/ 的/ 梯度/ h/ 和/ v/ ./ 在/ 素描/ 作品/ 中/ ,/ 画家/ 在/ 同个/ 区域/ 内会/ 使用/ 相同/ 的/ 笔划/ 方向/ 来/ 绘制/ ./ 本文/ 根据/ 像素/ 颜色/ 将/ 原/ 图像/ 分割/ 为/ 若干/ 连通/ 区域/ ./ 在/ 分割/ 过程/ 中/ ,/ 规定/ 每个/ 区域/ 面积/ 不/ 应/ 小于/ 原/ 图像/ 大小/ 的/ 1/ %/ ,/ 图/ 3/ (/ d/ )/ 显示/ 了/ 使用/ MeanShift/ 算法/ 所/ 得到/ 的/ 图像/ 分割/ 结果/ ./ 在/ 分割/ 出/ 的/ 各个/ 图像/ 区域/ 内/ ,/ 分别/ 计算/ 其/ 内部/ 所有/ 像素/ 的/ 梯度/ 均值/ ,/ 作为/ 该/ 区域/ 的/ 整体/ 梯度/ ./ 将/ 区域/ 内/ 的/ 所有/ 像素/ 的/ 梯度/ ,/ 均/ 赋为/ 其/ 所在/ 图像/ 区域/ 的/ 梯度/ ./ 其中/ R/ 为/ 一个/ 图像/ 区域/ ,/ X/ ∈/ R/ 为/ 区域/ R/ 内/ 的/ 一个/ 像素/ ,/ N/ 是/ 区域/ R/ 包含/ 的/ 像素/ 个数/ ./ 这样/ ,/ 对于/ 任何/ 一个/ 区域/ 来说/ ,/ 其/ 内部/ 的/ 所有/ 像/ Page5/ 素均/ 具有/ 相同/ 的/ 向量/ ./ 将/ 像素/ X/ 的/ 梯度/ 幅值/ 标记/ 为/ GX/ ,/ 其/ 梯度/ 幅角/ 标记/ 为/ θ/ X/ ,/ 可以/ 得出/ G/ (/ X/ )/ =/ h2X/ +/ v2/ 槡/ X/ ,/ θ/ (/ X/ )/ =/ 考虑/ 到/ 点光源/ 的/ 光照/ 对/ 整幅/ 图像/ 所/ 产生/ 的/ 影响/ ,/ 重新/ 计算/ 点光源/ 到/ 各个/ 像素/ 方向/ 的/ 光照/ 角度/ δ/ X/ ./ 更新/ 整幅/ 图像/ 的/ 向量场/ ,/ 各个/ 像素/ 的/ 梯度/ 幅角/ 修改/ 为/ θ/ X/ =/ (/ θ/ X/ +/ δ/ X/ )/ // 2/ ,/ 其/ 梯度/ 幅值/ 保持/ 不变/ ,/ 则/ 在/ 光照/ 影响/ 下/ 的/ 图像/ 中/ 的/ 像素/ X/ 的/ 梯度/ 变为/ hX/ =/ GX/ ×/ cos/ θ/ X/ ,/ vX/ =/ GX/ ×/ sin/ θ/ X/ ./ 5/ 有/ 阴影/ 的/ 噪声/ 图/ 生成/ 在/ 本文/ 的/ 素描/ 风格/ 图像/ 生成/ 方法/ 中/ ,/ 由原/ 图像/ 所/ 获取/ 的/ 向量场/ 和/ 白/ 噪声/ 图会/ 影响/ 最终/ 素描/ 图像/ 的/ 整体/ 效果/ ,/ 其中/ 向量场/ 决定/ 了/ 各/ 区域/ 的/ 绘制/ 方向/ ,/ 而白/ 噪声/ 图则/ 决定/ 了/ 图像/ 各/ 区域/ 的/ 明暗/ 程度/ ./ 当/ 计算/ 出/ 虚拟/ 点光源/ 的/ 合适/ 位置/ 时/ ,/ 根据/ 该/ 位置/ 对/ 图像/ 向量场/ 进行/ 了/ 调整/ ,/ 使得/ 绘制/ 结果/ 更能/ 体现/ 出/ 光线/ 照射/ 效果/ ./ 在/ 本节/ 中/ ,/ 将/ 继续/ 讨论/ 如何/ 生成/ 一个/ 合适/ 的/ 白/ 噪声/ 图/ ,/ 其/ 能够/ 很/ 好/ 地/ 表现/ 出/ 素描/ 图像/ 中/ 的/ 明暗/ 对比/ 效果/ ./ 首先/ 根据/ 虚拟/ 点光源/ 的/ 位置/ ,/ 生成/ 带有/ 阴影/ 效果/ 的/ 原/ 图像/ 强度/ 场/ ,/ 再/ 由/ 该/ 阴影/ 强度/ 场/ 指导/ 白/ 噪声/ 图/ 的/ 生成/ ,/ 最后/ 使用/ LIC/ 方法/ 进行/ 绘制/ ,/ 从而/ 获得/ 最终/ 的/ 素描/ 风格/ 图像/ ./ 5.1/ 阴影/ 强度/ 场/ 生成/ 在/ 真实/ 素描/ 作品/ 创作/ 过程/ 中/ ,/ 画家/ 会/ 根据/ 所/ 绘制/ 对象/ 的/ 亮度/ 来/ 决定/ 其/ 明暗/ ,/ 并/ 在/ 边界/ 处/ 主观/ 地/ 增强/ 这种/ 明暗/ 对比/ ,/ 以/ 体现/ 作品/ 的/ 层次感/ ./ 一种/ 解决/ 方法/ 是/ 使用/ 前景/ 抠/ 取/ 方法/ ,/ 将/ 前景/ 与/ 背景/ 分离/ 后/ ,/ 再/ 在/ 其/ 边界/ 上/ 产生/ 阴影/ ./ 但是/ ,/ 许多/ 素描/ 作品/ 中/ 很/ 难/ 区分/ 前景/ 物体/ 和/ 背景/ ,/ 这/ 取决于/ 画家/ 在/ 绘画/ 时/ 对/ 整个/ 绘画/ 场景/ 的/ 理解/ 和/ 主观/ 创作/ ./ 另外/ ,/ 画家/ 也/ 经常/ 会/ 在/ 前景/ 物体/ 中/ 使用/ 这种/ 明暗/ 对比/ 的/ 手法/ ,/ 以/ 突出/ 某种/ 表现力/ ./ 利用/ 第/ 4/ 节所/ 引入/ 的/ 虚拟/ 点光源/ ,/ 可以/ 在/ 图像/ 中/ 的/ 边缘/ 处/ 产生/ 阴影/ ,/ 以/ 实现/ 素描/ 作品/ 中/ 的/ 明暗/ 对比/ 效果/ ./ 首先/ 使用/ Sobel/ 核/ 提取/ 原/ 图像/ 的/ 边缘/ 图/ E/ (/ x/ )/ ∈/ {/ 0/ ,/ 255/ }/ ,/ 其中/ 0/ (/ black/ )/ 表示/ 该/ 像素/ 位于/ 边缘/ 上/ ./ 当/ 点光源/ 照射到/ 这些/ 边缘/ 时/ ,/ 就/ 会/ 在/ 另一侧/ 产生/ 阴影/ ,/ 从而/ 实现/ 素描画/ 中/ 的/ 明暗/ 效果/ ./ 本文/ 使用/ 如下/ 方法/ 计算/ 阴影/ :/ 对于/ 边缘/ 上/ 的/ 一个/ 像素/ A0/ 初始/ 令/ i/ ←/ 0/ ,/ 表示/ 当前/ 像素/ 为/ 阴影/ 上/ 的/ 第/ i/ 个/ 像素/ ,/ 令/ length/ ←/ 0/ 为/ 阴影/ 长度/ WHILElength/ </ 预设值/ Ai/ +/ 1/ =/ FindNextShadowPixel/ (/ O/ ,/ Ai/ )/ ;/ IF/ (/ Ai/ +/ 1/ 位于/ 边缘/ 上/ )/ break/ ;/ ELSEIAi/ +/ 1/ =/ 0.5/ ×/ si/ +/ 1/ ×/ IAi/ +/ 1/ ;/ IF/ (/ IAi/ +/ 1/ / IAi/ +/ 1/ )/ break/ ;/ length/ ←/ length/ +/ 1/ ,/ i/ ←/ i/ +/ 1/ ;/ 在/ 上述/ 流程/ 中/ ,/ IX/ 为/ 像素/ X/ 在/ 强度/ 场中/ 的/ 值/ ,/ IX/ 为/ 像素/ X/ 在/ 阴影/ 强度/ 场中/ 的/ 值/ ,/ s/ 为/ 阴影/ 的/ 衰减/ 速度/ ./ 当/ IAi/ / IAi/ 时/ ,/ 阴影/ 已经/ 完全/ 衰减/ ,/ 则/ 无需/ 继续/ 计算/ A/ 的/ 阴影/ 上/ 的/ 后续/ 像素/ ./ FindNextShadowPixel/ 用来/ 寻找/ 当前/ 像素/ Ai/ 在/ 虚拟/ 点光源/ O/ 下/ 所/ 产生/ 的/ 阴影/ 像素/ Ai/ +/ 1/ 位置/ ./ 由/ 点光源/ O/ 出发/ ,/ 经过/ 像素/ Ai/ ,/ 产生/ 一条/ OAi/ 射线/ ,/ 该/ 射线/ 所/ 到达/ 的/ 下/ 一个/ 像素/ Ai/ +/ 1/ ,/ 即/ 为/ 该/ 像素/ 所/ 产生/ 的/ 阴影/ 像素/ ,/ 因此/ 该/ 阴影/ 像素/ 必然/ 位于/ 当前/ 像素/ 所/ 相对/ 于/ 光源/ 的/ 另一侧/ ./ 重复使用/ 该/ 方法/ ,/ 直到/ 阴影/ 已经/ 足够/ 衰弱/ ,/ 或是/ 阴影/ 像素/ 也/ 落/ 在/ 图像/ 中/ 的/ 某段/ 边缘/ 上/ ./ 该/ 方法/ 可以/ 在/ 物体/ 边缘/ 上/ 远离/ 光源/ 的/ 一侧/ 产生/ 逐渐/ 变淡/ 的/ 阴影/ ./ 对于/ 整个/ 边缘/ 图/ E/ (/ x/ )/ 上/ 的/ 每个/ 位于/ 边缘/ 的/ 像素/ 执行/ 该/ 过程/ ,/ 则/ 可/ 在/ 强度/ 场/ I/ (/ x/ )/ 上/ 生成/ 以/ O/ 为/ 点光源/ 所/ 产生/ 的/ 阴影/ 区域/ 效果/ ,/ 该/ 效果/ 如图/ 4/ 所示/ ./ 可以/ 看出/ ,/ 该/ 方法/ 在/ 物体/ 边界/ 和/ 内部/ 均会/ 产生/ 适当/ 的/ 阴影/ ,/ 从而/ 在/ 体现/ 了/ 前景/ 与/ 背景/ 之间/ 的/ 明暗/ 对比/ 的/ 同时/ ,/ 也/ 表现/ 出/ 了/ 物体/ 内部/ 的/ 层次感/ ./ 5.2/ 白/ 噪声/ 图/ 生成/ 白/ 噪声/ 图/ 决定/ 了/ 最终/ 生成/ 的/ 素描/ 图像/ 的/ 灰度/ 色调/ ./ 通过/ 阴影/ 强度/ 场来/ 指导/ 生成/ 白/ 噪声/ 图/ ,/ 可以/ 很/ 好/ 地/ 匹配/ 最终/ 绘制/ 结果/ 与/ 原/ 图像/ 和/ 阴影/ 区域/ 的/ 色调/ 关系/ ./ 图像/ 像素/ 在/ 阴影/ 强度/ 场中/ 的/ 取值/ ,/ 表示/ 了/ 该/ 像素/ 产生/ 白/ 噪声/ 的/ 概率/ ,/ 即/ 对于/ 阴影/ 强度/ 场中/ 的/ 每个/ 像素/ ,/ 令其值/ 为/ I/ (/ x/ )/ ,/ 生成/ 一个/ 随机数/ r/ ∈/ (/ 0.0/ ,/ 1.0/ )/ ,/ 则/ 噪声/ 图中/ 的/ 对应/ 像素/ 的/ 强度/ 值/ Inoise/ 为/ Page6/ 其中/ ,/ Imax/ 为/ 强度/ 场所/ 可能/ 具有/ 的/ 最大/ 的/ 值/ ,/ 在/ 本文/ 的/ 实现/ 方案/ 中为/ 255/ ./ k/ 为/ 一个/ 用来/ 控制/ 白/ 噪声/ 点/ 数量/ 的/ 权值/ ,/ 随着/ k/ 值/ 的/ 增大/ ,/ 白/ 噪声/ 点/ 的/ 数量/ 也/ 会/ 增加/ ./ 在/ 本文/ 的/ 实现/ 方案/ 中/ ,/ k/ 值/ 选择/ 为/ 0.7/ ./ 图/ 5/ 显示/ 了/ 根据/ 阴影/ 强度/ 场所/ 生成/ 的/ 白/ 噪声/ 图/ 的/ 例子/ ./ 5.3/ 生成/ 素描/ 结果/ 本文/ 使用/ LIC/ 方法/ 进行/ 最终/ 绘制/ 操作/ ./ 该/ 方法/ 沿着/ 给定/ 的/ 向量场/ 对/ 曲线/ 区域/ 的/ 像素/ 进行/ 均值/ 化而图/ 6/ 最终/ 生成/ 的/ 素描/ 图像/ 6/ 实验/ 结果/ 本文/ 使用/ C++/ 实现/ 了/ 第/ 3/ 节中/ 所/ 描述/ 的/ 算法/ 流程/ ./ 附图/ 1/ 中/ 展示/ 了/ 该/ 算法/ 所/ 生成/ 的/ 一些/ 例子/ ./ 可以/ 看出/ ,/ 由于/ 引入/ 了/ 图像/ 中/ 的/ 虚拟/ 点光源/ ,/ 该/ 算法/ 可以/ 很/ 好/ 地/ 模仿/ 出/ 素描画/ 中/ 的/ 阴影/ 和/ 高光/ 效果/ ./ 7/ 结论/ 与/ 未来/ 工作/ 本文/ 通过/ 在/ 二维/ 图像/ 中/ 引入/ 一个/ 图像/ 平面/ 上/ 的/ 虚拟/ 点光源/ ,/ 改进/ 了/ 现有/ 的/ 素描/ 风格/ 图像/ 生成/ 算法/ ./ 通过/ 估计/ 原始/ 图像/ 中/ 的/ 光线/ 照射/ 方向/ ,/ 在/ 原/ 图像/ 平面/ 上/ 设置/ 一个/ 虚拟/ 点光源/ ,/ 利用/ 该/ 点光源/ 对/ 真实/ 图像/ 中/ 的/ 各条/ 边缘/ 进行/ 照射/ 生成/ 阴影/ ,/ 模拟出/ 素描/ 图像/ 的/ 阴影/ 区域/ ,/ 从而/ 让/ 绘制/ 结果/ 对于/ 观察者/ 来说/ 更/ 具有/ 素描画/ 的/ 光影/ 增强/ 特点/ ./ 我们/ 拟将/ 这一/ 工作/ 推广/ 到/ 素描/ 风格化/ 视频/ 的/ 绘制/ 当中/ ,/ 根据/ 视频/ 中/ 的/ 镜/ 实现/ 图像/ 滤波/ ./ 给定/ 一个二维/ 向量场/ ,/ 和/ 同样/ 大小/ 的/ 白/ 噪声/ 图/ ,/ 该/ 算法/ 沿/ 向量场/ 方向/ 对白/ 噪声/ 进行/ 模糊/ 处理/ ,/ 生成/ 一幅/ 具有/ 铅笔/ 素描/ 效果/ 的/ 图像/ ./ 在/ 计算结果/ 图像/ 的/ 像素/ 时/ ,/ 首先/ 在/ 向量场/ 内/ 生成/ 一条/ 通过/ 该/ 像素/ 的/ 局部/ 流线/ ,/ 然后/ 在/ 流线/ 上/ 定义/ 一个/ 1D/ 低/ 通滤波/ 核/ ,/ 将/ 白/ 噪声/ 图像/ 中/ 位于/ 该/ 流线/ 上/ 的/ 像素/ 与/ 该/ 低/ 通滤波/ 核/ 进行/ 卷积/ ,/ 得到/ 结果/ 图像/ 的/ 像素/ 值/ ./ 最后/ ,/ 将/ 利用/ Sobel/ 核所/ 提取/ 的/ 边缘/ 叠加/ 在/ 结果/ 图像/ 上/ ,/ 获得/ 最终/ 的/ 素描/ 效果/ ./ 在/ 素描画/ 中/ ,/ 画家/ 会/ 使用/ 物体/ 边缘/ 线条/ 来/ 表现/ 物体/ 的/ 外形/ 与/ 轮廓/ ./ 在/ 本文/ 的/ 方法/ 中/ ,/ 使用/ Sobel/ 算子/ 从/ 输入/ 图像/ 中/ 提取/ 边缘/ 线条/ ,/ 并/ 将/ 其/ 加入/ 到/ 结果/ 图像/ 中/ ./ 对于/ 检测/ 为/ 物体/ 边缘/ 的/ 像素/ ,/ 按照/ 一定/ 比例/ 降低/ 其/ 灰度/ 值/ ,/ 从而/ 体现/ 出/ 边缘/ 的/ 效果/ ./ 图/ 6/ 显示/ 了/ 未/ 叠加/ 边缘/ 与/ 叠加/ 边缘/ 后/ 的/ 图像/ 的/ 比较/ ./ 由于/ 之前/ 计算/ 出/ 的/ 图像/ 像素/ 值/ 已经/ 考虑/ 了/ 光照/ 的/ 影响/ ,/ 所以/ 这种/ 添加/ 边缘/ 的/ 方法/ 也/ 可以/ 一定/ 程度/ 上/ 体现/ 出/ 光照/ 的/ 影响/ ./ 头/ 运动/ 来/ 估计/ 点光源/ 的/ 位置/ 变化/ 与/ 向量场/ 运动/ ,/ 并/ 对/ 各/ 帧/ 图像/ 生成/ 对应/ 的/ 阴影/ 强度/ 图/ ,/ 从而/ 获得/ 具有/ 较/ 好/ 帧/ 间/ 连续性/ 的/ 素描/ 风格化/ 视频/ 效果/ ./ 致谢/ 本文/ 得到/ 了/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 可视/ 媒体/ 研究/ 中心/ 的/ 老师/ 与/ 同学/ 们/ 的/ 许多/ 帮助/ 和/ 有益/ 建议/ ,/ 在/ 此/ 表示感谢/ !/ 

