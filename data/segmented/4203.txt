Page1SAMS/ :/ 一种/ 新型/ 身份/ // 位置/ 分离/ 方案/ 杨/ 芫/ 1/ )/ ,/ 5/ )/ 徐明伟/ 1/ )/ ,/ 5/ )/ 杨家/ 海/ 2/ )/ ,/ 5/ )/ 董庆洲/ 3/ )/ 陈/ 文龙/ 4/ )/ 王会/ 2/ )/ ,/ 5/ )/ 张志超/ 1/ )/ ,/ 5/ )/ 1/ )/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 2/ )/ (/ 清华大学/ 网络/ 科学/ 与/ 网络空间/ 研究院/ 北京/ 100084/ )/ 3/ )/ (/ 北京邮电大学/ 网络/ 与/ 交换/ 国家/ 重点/ 实验室/ 北京/ 100876/ )/ 5/ )/ (/ 清华/ 信息科学/ 与/ 技术/ 国家/ 实验室/ (/ 筹/ )/ 北京/ 100084/ )/ 4/ )/ (/ 首都师范大学/ 信息/ 工程学院/ 北京/ 100037/ )/ 摘要/ 当前/ 互联网/ 中/ 的/ IP地址/ 同时/ 标识/ 主机/ 身份/ 和/ 主机/ 位置/ ,/ 这种/ 语义/ 重载/ 主要/ 导致/ 了/ 两/ 方面/ 的/ 问题/ ./ 一方面/ ,/ 它/ 使得/ 核心/ 网络/ 路由表/ 项/ 数量/ 急剧/ 增长/ ,/ 引起/ 路由/ 可扩展性/ 问题/ ./ 另一方面/ ,/ 主机/ 难以/ 在/ 不/ 改变/ 身份/ 标识/ 的/ 情况/ 下/ 实现/ 多/ 宿主/ 和/ 移动/ 中/ 的/ 高速/ 切换/ ./ 解决/ 这/ 两个/ 问题/ 的/ 根本/ 办法/ 是/ 主机/ 的/ 身份/ 和/ 位置/ 分离/ ,/ 即/ 分别/ 使用/ 相互/ 独立/ 的/ 身份/ 标识/ 和/ 位置/ 标识/ ./ 目前/ 身份/ // 位置/ 分离/ 方案/ 得到/ 了/ 研究/ 人员/ 的/ 广泛/ 关注/ ,/ 然而/ 现有/ 的/ 方案/ 只是/ 针对/ 某/ 一个/ 问题/ ,/ 不能/ 同时/ 解决/ 这/ 两个/ 问题/ ./ 此外/ 身份/ 位置/ 分离/ 之后/ 的/ 真实/ 身份/ 问题/ 也/ 很/ 重要/ ./ 文中/ 提出/ 了/ 一种/ 新型/ 身份/ // 位置/ 分离/ 方案/ SAMS/ (/ ScalableAuthenticMobileidentifier/ -/ locatorSeparationscheme/ )/ ,/ 它/ 将/ 用户/ 身份/ 标识/ 、/ 主机/ 身份/ 标识/ 、/ 边缘/ 网络/ 位置/ 标识/ 和/ 核心/ 网络/ 位置/ 标识/ 分离/ ,/ 并/ 设计/ 合理/ 的/ 体系结构/ 将/ 这/ 4/ 种/ 标识/ 结合/ 在/ 一起/ ,/ 对/ 路由/ 可扩展性/ ,/ 主机/ 多/ 宿主/ 和/ 移动/ 能力/ 都/ 有/ 很大/ 的/ 提高/ ,/ 并/ 支持/ 真实/ 身份/ ./ 文中/ 实现/ 了/ SAMS/ 的/ 原型/ 系统/ ,/ 并/ 在/ CERNET2/ 主干网/ 上/ 进行/ 了/ 规模/ 部署/ 和/ 实验/ ,/ 验证/ 了/ 方案/ 的/ 有效性/ 和/ 系统/ 的/ 兼容性/ ./ 关键词/ 身份/ // 位置/ 分离/ ;/ 路由/ 可/ 扩展/ ;/ 身份/ 认证/ ;/ 主机/ 移动/ ;/ 多/ 宿主/ 1/ 引言/ 在/ 当前/ 的/ 互联网/ 中/ ,/ IP地址/ 同时/ 起着/ 标识/ 主机/ 身份/ 和/ 标识/ 主机/ 位置/ 的/ 作用/ [/ 1/ ]/ ./ 这种/ IP地址/ 语义/ 的/ 重载/ 主要/ 带来/ 了/ 两/ 方面/ 的/ 影响/ ./ 一方面/ ,/ 它/ 严重/ 影响/ 了/ 互联网/ 路由/ 的/ 可扩展性/ [/ 2/ ]/ ,/ 尤其/ 是/ 当/ 大量/ 用户/ 自治/ 系统/ (/ customer/ ’/ sAS/ )/ 以多/ 宿主/ (/ multi/ -/ homing/ )/ 的/ 方式/ 连接/ 到/ 多个/ 提供者/ 自治/ 系统/ (/ provider/ ’/ sAS/ )/ 并/ 向/ 外/ 公告/ 前缀/ 时/ ,/ 相同/ 的/ 地址/ 前缀/ 将/ 出现/ 在/ 多条/ 域间/ 路由/ 中/ ,/ 造成/ 核心/ 网络/ 路由表/ 急剧/ 膨胀/ [/ 3/ -/ 4/ ]/ ./ 另一方面/ ,/ 它/ 限制/ 了/ 终端/ 主机/ 的/ 移动/ 能力/ ,/ 通常/ 情况/ 下/ 主机/ 位置/ 的/ 改变/ 伴随/ 着/ IP地址/ 的/ 改变/ ,/ 这/ 必将/ 导致/ 传输/ 连接/ 的/ 中断/ ,/ 虽然/ 提出/ 了/ 移动/ IP/ 等/ 技术/ [/ 5/ -/ 6/ ]/ ,/ 但/ 其/ 带来/ 的/ 隧道/ 开销/ 问题/ 和/ 三角/ 路由/ 问题/ 仍/ 未/ 得到/ 很/ 好/ 的/ 解决/ ./ 解决/ 这/ 两个/ 问题/ 最/ 根本/ 的/ 思路/ 是/ 将/ IP地址/ 的/ 这/ 两种/ 语义/ 分离/ [/ 1/ ]/ ,/ 即/ 设计/ 和/ 使用/ 相互/ 独立/ 的/ 身份/ 标识/ 和/ 位置/ 标识/ ./ 这一/ 解决/ 思路/ 受到/ 了/ 广泛/ 关注/ ,/ 已经/ 有/ 很多/ 方案/ 被/ 提出/ [/ 7/ -/ 8/ ]/ ,/ 不妨/ 将/ 它们/ 统称/ 为/ 身份/ // 位置/ 分离/ 方案/ ./ 然而/ 已有/ 的/ 方案/ 只能/ 解决/ 一部分/ 问题/ ,/ 例如/ LISP/ 方案/ [/ 9/ ]/ 是/ 重点/ 针对/ 路由/ 可扩展性/ 问题/ 设计/ 的/ ,/ 主机/ 移动/ 能力/ 较差/ ;/ Shim6/ [/ 10/ ]/ 方案/ 仅仅/ 解决/ 主机/ 多/ 宿主/ 切换/ 的/ 问题/ ;/ HIP/ 方案/ [/ 11/ ]/ 能/ 提供/ 对/ 主机/ 多/ 宿主/ 和/ 移动/ 中/ 切换/ 的/ 支持/ ,/ 但/ 难以/ 在短期内/ 提升/ 核心/ 网路/ 由/ 可扩展性/ ./ 此外/ 还有/ 一些/ 其它/ 方案/ ,/ 但/ 都/ 存在/ 较大/ 的/ 不足/ ./ 为了/ 更加/ 适应/ 新一代/ 互联网/ 的/ 发展/ 和/ 需求/ ,/ 亟需/ 提出/ 一种/ 更好/ 的/ 方案/ ./ 本文/ 提出/ 了/ 一种/ 新型/ 身份/ // 位置/ 分离/ 方案/ SAMS/ (/ ScalableAuthenticMobileidentifier/ -/ locatorSeparationscheme/ )/ ./ SAMS/ 将/ 用户/ 身份/ 标识/ 、/ 主机/ 身份/ 标识/ 、/ 边缘/ 网络/ 位置/ 标识/ 和/ 核心/ 网络/ 位置/ 标识/ 相/ 分离/ ,/ 设计/ 合理/ 的/ 网络体系结构/ 来/ 管理/ 不同/ 标识/ 间/ 的/ 映射/ 并/ 进行/ 正确/ 的/ 路由/ 转发/ ,/ 最终/ 将/ 多种/ 标识/ 有机/ 地/ 结合/ 到/ 一起/ ,/ 提供/ 对/ 多方面/ 的/ 同时/ 支持/ :/ 提高/ 核心/ 网络/ 路由/ 可/ 扩展/ 能力/ ,/ 多/ 宿主/ 和/ 移动/ 中/ 高速/ 透明/ 切换/ ,/ 真实/ 身份/ 认证/ 和/ 会/ 话/ 保证/ ./ 该/ 方案/ 还/ 具有/ 很/ 好/ 的/ 兼容性/ 和/ 可/ 逐步/ 部署/ 能力/ ,/ 这/ 也/ 是/ 现有/ 方案/ 难以/ 做到/ 的/ ./ 本文/ 在/ 真实/ 网络设备/ 上/ 实现/ 了/ SAMS/ 的/ 原型/ 系统/ ,/ 并/ 在/ CERNET2/ [/ 12/ ]/ 主干网/ 上/ 进行/ 了/ 规模/ 部署/ 和/ 实验/ ,/ 结果表明/ 该/ 原型/ 系统/ 在/ 上述/ 几个/ 方面/ 都/ 具有/ 较/ 好/ 的/ 性能/ ./ 2/ 问题/ 分析/ 互联网/ 采用/ 的/ TCP/ // IP/ 体系结构/ 存在/ 跨层/ 操作/ 的/ 现象/ ,/ 这/ 是/ 由/ 互联网/ 最初/ 的/ 设计/ 目标/ 和/ 一定/ 的/ 历史/ 原因/ 造成/ 的/ ./ 跨层/ 操作/ 虽然/ 在/ 一定/ 程度/ 上/ 简化/ 了/ 协议/ 栈/ 的/ 实现/ ,/ 但/ 随着/ 互联网/ 的/ 发展/ 却/ 带来/ 了/ 一些/ 问题/ ,/ 其中/ IP地址/ 语义/ 的/ 重载/ 对/ 当今/ 互联网/ 带来/ 了/ 很大/ 的/ 影响/ ./ 所谓/ IP地址/ 语义/ 重载/ [/ 1/ ]/ ,/ 指/ 的/ 是/ IP地址/ 既/ 用来/ 标识/ 主机/ 或/ 网络/ 所处/ 的/ 位置/ ,/ 又/ 用来/ 标识/ 该/ 主机/ 或/ 网络/ 的/ 身份/ ,/ 即/ IP地址/ 同时/ 拥有/ 位置/ 标识/ 和/ 身份/ 标识/ 的/ 语义/ ./ IP地址/ 的/ 语义/ 重载/ 造成/ 的/ 主要/ 问题/ 包括/ 路由/ 可扩展性/ 、/ 多/ 宿主/ 与/ 移动性/ 两/ 方面/ ./ 路由/ 可扩展性/ 问题/ 指/ 的/ 是/ 由于/ 网络/ 中/ 路由表/ 项/ 数量/ 随着/ 互联网/ 规模/ 的/ 扩大/ 而/ 急剧/ 增长/ ,/ 从而/ 带来/ 巨大/ 的/ 存储/ 开销/ 、/ 路由/ 信息/ 通信/ 开销/ 和/ 路由/ 计算/ 开销/ ,/ 大量/ 的/ 路由/ 信息/ 甚至/ 严重/ 影响/ 了/ 互联网/ 路由/ 的/ 收敛性/ ./ 造成/ 这一/ 问题/ 的/ 主要/ 原因/ 是/ 用户/ AS/ 为了/ 提高/ 网络/ 连通/ 度/ 或/ 实现/ 流量/ 工程/ ,/ 向/ 多个/ 提供者/ AS/ 通告/ 相同/ 的/ 前缀/ ,/ 而/ 其中/ 一些/ 前缀/ 只是/ 某些/ 提供者/ AS/ 提供/ 的/ 前缀/ 的/ 子/ 前缀/ ,/ 这/ 就/ 导致/ 了/ 位置/ 标识/ 空间/ 的/ 聚合/ 性/ 下降/ ./ 在/ 这种/ 情况/ 下/ ,/ 远程/ AS/ 将/ 计算/ 出/ 多条/ 到达/ 该/ 用户/ AS/ 的/ 路由/ ,/ 这种/ 路由/ 随着/ 网络/ 连通/ 度/ 的/ 提高/ 以/ 乘法/ 的/ 速度/ 增长/ ./ 为了/ 提高/ 位置/ 标识/ 空间/ 的/ 聚合/ 性/ ,/ 应该/ 设法/ 将/ 边缘/ 网络/ 位置/ 标识/ 与/ 核心/ 网络/ 位置/ 标识/ 空间/ 分离/ ,/ 使/ 边缘/ 网络/ 保持/ 较完整/ 的/ 前缀/ ./ 这种/ 前缀/ 可以/ 作为/ 该/ 边缘/ 网络/ 的/ 身份/ 标识/ ,/ 再/ 通过/ 设计/ 合理/ 的/ 映射/ 机制/ 将/ 它们/ 与/ 核心/ 网络/ Page3/ 的/ 位置/ 标识/ 对应/ 起来/ ,/ 将/ 本来/ 较/ 复杂/ 的/ 边缘/ 网络/ 的/ 路由/ 问题/ 转化成/ 相对/ 简单/ 的/ 核心/ 网络/ 的/ 路由/ 问题/ ./ 多/ 宿主/ 和/ 移动性/ 已/ 成为/ 当今/ 互联网/ 端系统/ 发展/ 的/ 新/ 方向/ ./ 一台/ 多/ 宿主/ 的/ 主机/ 可以/ 同时/ 接入/ 到/ 不同/ 提供者/ 的/ 网络/ ,/ 作为/ 客户端/ 的/ 多/ 宿主/ 主机/ 可以/ 随时/ 根据/ 应用/ 的/ 需求/ 和/ 网络/ 的/ 具体情况/ 选择/ 能/ 提供/ 较/ 好/ 服务质量/ 的/ 网络/ ,/ 而/ 作为/ 服务器/ 的/ 多/ 宿主/ 主机/ 可以/ 直接/ 为/ 它/ 所/ 接入/ 的/ 网络/ 的/ 用户/ 提供/ 访问/ 服务/ ./ 而/ 端系统/ 移动性/ 则/ 要求/ 网络/ 能够/ 提供/ 随时随地/ 的/ 接入/ ,/ 在/ 主机/ 移动/ 的/ 过程/ 中/ ,/ 正在/ 进行/ 的/ 通信/ 不会/ 中断/ ,/ 服务质量/ 不会/ 剧烈/ 变化/ ./ 然而/ 端系统/ 多/ 宿主/ 与/ 移动性/ 的/ 发展/ 受到/ 了/ IP/ 语义/ 重载/ 的/ 制约/ ,/ 因为/ IP地址/ 既/ 作为/ 网络层/ 路由/ 寻址/ 的/ 依据/ ,/ 又/ 与/ 端口号/ 组成/ 二元/ 组/ 作为/ 传输层/ 的/ 访问/ 点来/ 标识/ 主机/ 上/ 运行/ 的/ 进程/ ./ 一方面/ ,/ 如果/ 要/ 保证/ 多/ 宿主/ 主机/ 切换/ 接入/ 网络/ 或/ 移动/ 主机/ 跨域/ 移动/ 时/ 通信/ 不/ 被/ 中断/ ,/ IP地址/ 就/ 不能/ 改变/ ,/ 但/ 这样/ 就/ 无法/ 通过/ 路由/ 及时/ 找到/ 该/ 主机/ 正确/ 的/ 位置/ ;/ 另一方面/ ,/ 如果/ 要/ 保证/ 路由/ 的/ 正确性/ ,/ 传输层/ 就/ 会/ 由于/ IP地址/ 的/ 改变/ 而/ 无法/ 将/ 分组/ 提交/ 到/ 正确/ 的/ 进程/ ,/ 最终/ 导致/ 为了/ 继续/ 通信/ 只能/ 重新/ 建立/ 连接/ ./ 虽然/ 移动/ IP/ 已经/ 为/ 解决/ 这一/ 问题/ 提供/ 了/ 思路/ ,/ 但/ 最/ 根本/ 的/ 方法/ 还是/ 将/ IP地址/ 的/ 语义/ 分离/ ,/ 即/ 单独/ 设计/ 身份/ 标识/ 来/ 取代/ IP地址/ 标识/ 身份/ 的/ 职能/ ./ 该/ 身份/ 标识/ 被/ 传输层/ 所/ 使用/ ,/ 不/ 包含/ 位置/ 信息/ ,/ 且/ 应该/ 具有/ 全球/ 唯一/ 的/ 特性/ ./ 互联网/ 的/ 安全/ 在/ 很大/ 程度/ 上/ 需要/ 依赖/ 认证/ 技术/ ,/ 其中/ 主机/ 和/ 用户/ 的/ 身份/ 认证/ 是/ 保证/ 可信/ 通信/ 的/ 重要/ 手段/ ./ IP地址/ 同时/ 标识/ 着/ 主机/ 的/ 位置/ 和/ 身份/ ,/ 因此/ 难以/ 作为/ 身份/ 认证/ 的/ 依据/ ,/ 给/ 攻击者/ 利用/ IP地址/ 的/ 这/ 一/ 弱点/ 进行/ 攻击/ 提供/ 了/ 机会/ ,/ 例如/ 伪造/ 源/ IP地址/ 进行/ 大规模/ 拒绝服务/ (/ DoS/ )/ 攻击/ 等/ ./ 虽然/ 可以/ 利用/ MAC/ 地址/ 等/ 信息/ 来/ 进行/ 主机/ 身份/ 认证/ ,/ 但/ MAC/ 地址/ 并/ 不/ 包含/ 用户/ 身份/ 的/ 语义/ ,/ 且/ 也/ 有/ 可能/ 被/ 伪造/ ./ 设计/ 安全性/ 更强/ 的/ 身份/ 标识/ ,/ 并/ 将/ 其/ 与/ 位置/ 标识/ 即/ IP地址/ 分离/ 有利于/ 提高/ 互联网/ 安全性/ 、/ 可控性/ 和/ 可信性/ ,/ 便于/ 网络安全/ 管理/ ./ 3/ 相关/ 研究/ 截止/ 到/ 目前/ ,/ 学术界/ 已经/ 提出/ 了/ 很多/ 身份/ // 位置/ 分离/ 方案/ ./ 其中/ LISP/ 已经/ 在/ 思科/ 路由器/ 上/ 实现/ 并/ 成为/ IETF/ 标准/ ,/ HIP/ 和/ Shim6/ 也/ 已经/ 成为/ IETF/ 标准/ ./ LISP/ 用于/ 实现/ 边缘/ 网络地址/ 空间/ 与/ 核心/ 网络地址/ 空间/ 的/ 分离/ ,/ 从而/ 解决/ 核心/ 网络/ 路由/ 可/ 扩展/ 问题/ ./ 具体来说/ ,/ LISP/ 把/ IPv4/ 地址/ 空间/ 划分/ 为端/ 节点/ 身份/ 标识/ (/ EndpointIdentifier/ ,/ EID/ )/ 和/ 路由/ 标识/ (/ RoutingLocator/ ,/ RLOC/ )/ ./ 主机/ 发送/ 的/ 分组/ 到达/ 边缘/ 网络/ 入口/ 路由器/ (/ IngressTunnelRouter/ ,/ ITR/ )/ 后/ ,/ ITR/ 利用/ 一整套/ 映射/ 系统/ 查询/ 得到/ 目的/ 主机/ 所在/ 边缘/ 网络/ 的/ 出口/ 路由器/ (/ EgressTunnelRouter/ ,/ ETR/ )/ 的/ RLOC/ ,/ 接着/ ITR/ 用/ 含有/ 该/ RLOC/ 的/ 头部/ 封装/ 原来/ 的/ 分组/ ,/ 并/ 使用/ 隧道/ 机制/ 将/ 其/ 发往/ ETR/ ,/ ETR/ 对/ 分组/ 解/ 封装/ 后发/ 往/ 边缘/ 网络/ 中/ 的/ 目的/ 主机/ ./ LISP/ 利用/ 映射/ 系统/ 来/ 保存/ EID/ 与/ RLOC/ 之间/ 的/ 映射/ ,/ 路由器/ 只/ 需要/ 保存/ RLOC/ 的/ 路由/ ,/ 从而/ 减少/ 了/ 路由表/ 项/ 数量/ ./ LISP/ 不/ 对/ 终端/ 主机/ 作/ 任何/ 修改/ ,/ 尽管/ 它/ 显示/ 地/ 提供/ 了/ 对/ 多/ 宿主/ 和/ 流量/ 工程/ 的/ 支持/ ,/ 然而/ 它/ 本身/ 对/ 终端/ 主机/ 提供/ 的/ 安全性/ 以及/ 移动/ 能力/ 的/ 支持/ 较为/ 有限/ ./ 此外/ ,/ 从/ 本质/ 上/ 说/ ,/ LISP/ 是/ 把/ 原有/ 路由表/ 相关/ 的/ 存储/ 和/ 通信/ 开销/ 转移/ 到/ 映射/ 系统/ 中/ ,/ 因此/ 其/ 映射/ 系统/ 的/ 存储/ 和/ 通信/ 开销/ 仍然/ 是/ 一个/ 问题/ ,/ 尤其/ 是/ 由/ ITR/ 发起/ 查询/ 这/ 一点/ [/ 13/ ]/ 会/ 带来/ 一些/ 问题/ ,/ 对于/ 触发/ 查询/ 的/ 分组/ ,/ 如果/ ITR/ 对/ 其/ 进行/ 缓存/ ,/ 会/ 给/ 高速/ 存储资源/ 有限/ 的/ 路由器/ 带来/ 较大/ 的/ 负担/ 且/ 不可/ 扩展/ ,/ 而/ 如果/ ITR/ 丢弃/ 该/ 分组/ ,/ 则/ 会/ 导致/ 终端/ 计时器/ 超时/ 重传/ ,/ 对/ 发起/ 通信/ 时/ 的/ 时延/ 增加/ 较大/ ./ HIP/ 用于/ 支持/ 主机/ 身份/ 标识/ 与/ 位置/ 标识/ 的/ 分离/ ./ HIP/ 采用/ 全球/ 唯一/ 的/ IPv6/ 地址/ 作为/ 主机/ 的/ 身份/ 标识/ ,/ 并/ 在/ 分组/ 的/ 网络层/ 头部/ 与/ 传输层/ 头部/ 之间/ 加入/ 一个/ 新/ 的/ 头部/ 存放/ 身份/ 标识/ ./ 为了/ 处理/ 身份/ 标识/ ,/ HIP/ 在/ 传统/ 互联网/ 体系结构/ 的/ 传输层/ 和/ 网络层/ 之间/ 加入/ 了/ 主机/ 标识/ 层/ (/ HostIdentifyLayer/ ,/ HIL/ )/ ,/ HIL/ 以上/ 使用/ 主机/ 标识/ (/ HostIdentifier/ ,/ HI/ )/ 作为/ 访问/ 点/ ,/ HIL/ 以下/ 则/ 采用/ 传统/ 的/ IP地址/ 进行/ 位置/ 寻址/ ./ 身份/ 标识/ 和/ 位置/ 标识/ 的/ 映射/ 由/ 专门/ 的/ 设备/ 管理/ ,/ HIL/ 的/ 功能/ 是/ 查询/ 并/ 缓存/ 这一/ 映射/ 以便/ 正确处理/ 分组/ 头部/ 并/ 完成/ 路由/ 或/ 递交/ ./ HIP/ 支持/ 主机/ 移动/ 和/ 多/ 宿主/ [/ 14/ -/ 15/ ]/ ,/ 但/ 它/ 的/ 不足之处/ 在于/ :/ 不能/ 解决/ 由/ 用户/ AS/ 多/ 宿主/ 导致/ 的/ 路由/ 可扩展性/ 问题/ ;/ IPv6/ 形式/ 的/ 身份/ 标识/ 不/ 具有/ 用户/ 身份/ 语义/ 且/ 不/ 便于/ 记忆/ ,/ 能/ 提供/ 的/ 安全/ 保障/ 比较/ 有限/ [/ 16/ ]/ ./ 此外/ ,/ HIP/ 协议/ 栈下/ 能/ 运行/ 的/ 应用程序/ 需要/ 重新/ 开发/ ,/ 它们/ 必须/ 使用/ 一类/ 新/ 的/ 套/ 接字/ (/ socket/ )/ 接口/ ,/ 这/ 使得/ HIP/ 不/ 具有/ 兼容性/ ,/ 很难/ 在/ 现实/ 中/ 部署/ ./ Shim6/ 协议/ 用于/ 支持/ 主机/ 使用/ 多个/ 位置/ 标识/ 访问/ 互联网/ ,/ 即/ 主机/ 的/ 多/ 宿主/ ./ 与/ HIP/ 类似/ ,/ 它/ 也/ 将/ 身份/ 标识/ (/ Shim6/ 中/ 称为/ UpperLayerIdentify/ ,/ ULID/ )/ Page4/ 设计/ 成/ IPv6/ 地址/ 的/ 形式/ ,/ 并且/ 也/ 增加/ 了/ 新/ 的/ 分组/ 头部/ 和/ 相应/ 的/ 新/ 协议/ 栈/ 层次/ Shim/ 层/ ./ 不同之处/ 在于/ ,/ Shim/ 层/ 并非/ 独立/ 的/ 一层/ ,/ 而是/ 嵌入/ 到/ IPv6/ 模块/ 中/ ./ 此外/ ,/ Shim6/ 也/ 没有/ 专门/ 的/ 设备/ 来/ 保存/ ULID/ 与/ 位置/ 标识/ (/ Shim6/ 中/ 称为/ 定位/ 符/ )/ 的/ 映射/ ,/ 而是/ 双方/ Shim/ 层/ 进行/ 通信/ 协商/ 来/ 获取/ 映射/ 信息/ ./ 最/ 重要/ 的/ 协商/ 消息/ 包括/ 初始/ 时/ 的/ 四次/ 握手/ 和/ 定位/ 符/ 变换/ 时/ 的/ 通知/ 消息/ ./ 与/ HIP/ 一样/ ,/ Shim6/ 也/ 能/ 支持/ 主机/ 移动/ 与/ 多/ 宿主/ [/ 17/ -/ 18/ ]/ ,/ 但/ 它/ 同样/ 也/ 没有/ 解决/ 路由/ 可扩展性/ 问题/ ,/ 此外/ Shim6/ 也/ 采用/ 了/ 不/ 具有/ 用户/ 身份/ 语义/ 的/ IPv6/ 地址/ ,/ 且/ 映射/ 关系/ 仅/ 由/ 通信/ 双方/ 自行/ 维护/ ,/ 其/ 安全性/ 不如/ HIP/ ./ 在/ 身份/ // 位置/ 分离/ 方案/ 的/ 其它/ 研究成果/ 中/ ,/ 一部分/ 研究/ 以/ 现有/ 的/ 标准/ 或/ 方案/ 为/ 基础/ ,/ 因此/ 基本/ 继承/ 了/ 这些/ 方案/ 的/ 优缺点/ ,/ 例如/ 文献/ [/ 19/ ]/ 和/ 文献/ [/ 20/ ]/ 使用/ 分布式/ 散/ 列表/ (/ DHT/ )/ 来/ 构建/ LISP/ 的/ 映射/ 系统/ ./ 还有/ 的/ 方案设计/ 了/ 新/ 的/ 体系结构/ ,/ 例如/ 文献/ [/ 21/ ]/ 提出/ 的/ MILSA/ 方案设计/ 了/ 一/ 种类/ URI/ 的/ 层次化/ 主机/ 身份/ 标识/ ,/ 能/ 提供/ 多种/ 场景/ 下/ 的/ 移动/ 能力/ 和/ 安全/ 信任/ 机制/ ,/ 但是/ 没有/ 从根本上/ 解决/ 路由/ 可扩展性/ 问题/ ./ 表/ 1/ 对/ 现有/ 身份/ // 位置/ 分离/ 方案/ 提供/ 的/ 功能/ 和/ 存在/ 的/ 问题/ 进行/ 了/ 概括/ 总结/ ./ 总的来说/ ,/ 目前/ 已经/ 提出/ 的/ 方案/ 都/ 不能/ 同时/ 满足/ 路由/ 的/ 可扩展性/ 、/ 安全性/ 以及/ 多/ 宿主/ 和/ 移动性/ 的/ 需求/ ./ 本文/ 提出/ 一种/ 新型/ 身份/ // 位置/ 分离/ 方案/ SAMS/ ,/ 并/ 分析/ 它/ 在/ 解决/ 这/ 3/ 个/ 问题/ 方面/ 的/ 特性/ ./ 方案/ 路由/ 可扩/ LISPHIP/ 短期/ 效果/ 不/ 明显/ ,/ Shim6/ 短期/ 效果/ 不/ 明显/ ,/ MILSA/ 中等/ 4SAMS/ 体系结构/ 4.1/ 设计/ 思想/ 为了/ 同时/ 支持/ 路由/ 可/ 扩展/ 以及/ 主机/ 移动/ 与/ 多/ 宿主/ ,/ 不能/ 简单/ 地/ 照搬/ 现有/ 的/ 标识/ 设计/ 与/ 分离/ 方法/ ./ 首先/ ,/ 路由/ 可扩展性/ 的/ 好坏/ 依赖于/ 路由/ 标识/ 能否/ 很/ 好/ 的/ 聚合/ ,/ 尤其/ 是/ 在/ 核心/ 网络/ 中/ 应当/ 尽可能减少/ 路由/ 数量/ ,/ 这/ 可以/ 通过/ 将/ 边缘/ 网络/ 的/ 地址/ 空间/ 与/ 核心/ 网络/ 的/ 地址/ 空间/ 分离/ 来/ 实现/ ,/ 也/ 就是/ 让/ 边缘/ 网络/ 中/ 的/ 前缀/ 在/ 核心/ 网络/ 中/ 仅仅/ 作为/ 该/ 边缘/ 网络/ 的/ 身份/ 标识/ 而/ 存在/ ./ 其次/ ,/ 主机/ 移动/ 与/ 多/ 宿主/ 需要/ 传输层/ 能/ 适应/ 网络层/ 位置/ 标识/ 的/ 改变/ ,/ 因此/ 可以/ 在/ 网络层/ 以上/ 传输层/ 以下/ 添加/ 一个/ 新/ 的/ 层次/ 即/ “/ 身份/ 标识/ 层/ ”/ ,/ 并/ 改变传统/ 传输层/ 以/ 〈/ IP地址/ ,/ 端口号/ 〉/ 作为/ 访问/ 点/ 的/ 方式/ ,/ 用/ 〈/ 主机/ 身份/ 标识/ ,/ 端口号/ 〉/ 取而代之/ ,/ 而/ 网络层/ 仍然/ 使用/ 传统/ 的/ IP地址/ ./ 这样/ IP地址/ 仅/ 作为/ 主机/ 的/ 位置/ 标识/ ,/ 不起/ 标识/ 主机/ 身份/ 的/ 作用/ ,/ 可以/ 在/ 移动/ 和/ 多/ 宿主/ 情况/ 下/ 进行/ 改变/ ./ 此外/ ,/ 为了/ 实现/ 真实/ 身份/ 并/ 适应/ 现实/ 中/ 用户/ 与/ 主机/ 多/ 对/ 多/ 的/ 关系/ ,/ 可以/ 在/ 主机/ 身份/ 标识/ 之外/ 再/ 设计/ 用户/ 身份/ 标识/ ,/ 用户/ 身份/ 标识/ 可以/ 采取/ 便于/ 记忆/ 的/ 形式/ 以便/ 于/ 查询/ ,/ 并/ 应当/ 与/ 用户/ 真实/ 身份/ 绑定/ 从而/ 为/ 身份/ 认证/ 提供/ 基础/ ./ 总的来说/ ,/ SAMS/ 的/ 核心思想/ 是/ 将/ 用户/ 身份/ 标识/ 、/ 主机/ 身份/ 标识/ 、/ 主机/ 位置/ 标识/ (/ 边缘/ 网络/ 位置/ 标识/ )/ 和/ 核心/ 网络/ 位置/ 标识/ 相互/ 分离/ ./ 下面/ 将/ 对/ SAMS/ 的/ 体系结构/ 进行/ 详细/ 说明/ ./ 4.2/ 体系结构/ 用户/ 身份/ 标识/ (/ UserID/ )/ 用于/ 唯一/ 标识/ 一个/ 用户/ (/ 个人/ 或/ 组织/ )/ ,/ 由/ 用户/ 向/ 权威机构/ 申请/ 获得/ ,/ 并/ 与/ 用户/ 的/ 真实/ 身份/ 信息/ 绑定/ ;/ 主机/ 身份/ 标识/ (/ HostID/ )/ 用于/ 唯一/ 标识/ 一台/ 主机/ ,/ 它/ 与/ 端口号/ 一起/ 组成/ 主机/ 的/ 传输层/ 的/ 访问/ 点/ ;/ 边缘/ 网络/ 位置/ 标识/ (/ EdgeLocator/ ,/ ELOC/ )/ 指出/ 了/ 主机/ 在/ 本地网络/ 中/ 的/ 位置/ ,/ 是/ 边缘/ 网络/ 路由器/ 决定/ 分组/ 向/ 何处/ 转发/ 的/ 依据/ ;/ 核心/ 网络/ 位置/ 标识/ (/ RoutingLocator/ ,/ RLOC/ )/ 指出/ 了/ 一个/ 边缘/ 网络/ 在/ 核心/ 网络/ 中/ 的/ 位置/ ,/ 是/ 核心/ 网络/ 路由器/ 决定/ 分组/ 向/ 何处/ 转发/ 的/ 依据/ ./ 这/ 4/ 种/ 标识/ 在/ 协议/ 栈中/ 所处/ 的/ 位置/ 如图/ 1/ 所示/ ./ 与/ 传统/ 的/ 互联网协议/ 栈/ 相比/ ,/ SAMS/ 的/ 协议/ 栈/ 在/ 网络层/ 之上/ 、/ 传输层/ 之下/ 增加/ 了/ 一个/ 新/ 的/ 层次/ “/ 身份/ 标识/ 层/ ”/ 用于/ 处理/ 身份/ 标识/ ./ UserID/ 可以/ 采用/ 类/ Email/ 地址/ 的/ 格式/ ,/ 由/ 一个/ 标识/ 用户名/ 的/ 字符串/ 、/ 字符/ “/ @/ ”/ 和/ 标识/ 管理/ 本/ 区域/ 服务器/ 的/ 主机名/ (/ 例如/ tsinghua/ ./ edu/ ./ cn/ )/ 组成/ ./ 这样/ 的/ 设计/ 既/ 方便/ 记忆/ ,/ 也/ 有利于/ 借助/ 现有/ DNS/ 系统/ 实现/ 聚合/ ./ HostID/ 需要/ 携带/ 于/ 分组/ 中/ 进行/ 传输/ ,/ 因此/ 可以/ 通过/ 对/ UserID/ 进行/ 编码/ 得到/ 定长/ 的/ HostID/ ,/ 例如/ 使用/ 32/ 比特/ 来/ 标识/ 域/ (/ 例如/ 可以/ 将/ 一个/ AS/ 作为/ 一个/ 域/ )/ ,/ 24/ 比特/ 作为/ 用户/ 编号/ ,/ 8/ 比特/ 作为/ 主机/ 编号/ ./ 用户/ 在/ 申请/ 获得/ UserID/ 的/ 同时/ 还/ 将/ 获得/ 一组/ 属于/ 该/ 用户/ 的/ 公私/ 钥对/ ,/ 以便/ 通过/ 数字签名/ 和/ 加密/ 机制/ 来/ 提供/ 对/ 安全性/ 的/ 支持/ ./ ELOC/ 和/ RLOC/ 可以/ 使用/ 现有/ 地址/ 簇/ ,/ Page5/ 如/ IPv4/ 或/ IPv6/ ./ 新型/ 身份/ // 位置/ 分离/ 方案/ 采用/ 如图/ 2/ 所示/ 的/ 体系结构/ 来/ 将/ 这/ 4/ 种/ 标识/ 统一/ 起来/ ./ 图/ 14/ 种/ 标识/ 在/ 协议/ 栈中/ 的/ 位置/ 该/ 体系结构/ 包括/ 的/ 主要/ 成员/ 和/ 要素/ 有/ 边缘/ 网络/ 映射/ 服务器/ EMS/ (/ EdgeMappingServer/ )/ ,/ 扩展/ 的/ DNS/ 系统/ ,/ 核心/ 网络/ 边缘/ 路由器/ PE/ (/ ProviderEdge/ )/ 以及/ 核心/ 网络/ 映射/ 服务器/ RMS/ (/ RoutingMappingServer/ )/ ./ EMS/ 保存/ 了/ 用户/ 真实/ 身份/ 信息/ 和/ UserID/ ,/ 它/ 的/ 作用/ 主要/ 有/ 三/ 方面/ ./ 首先/ ,/ EMS/ 接受/ 主机/ 的/ 注册/ ,/ 认证/ 用户/ 的/ 身份/ 并/ 为/ 其/ 分配/ HostID/ ./ 其次/ ,/ EMS/ 为/ 已经/ 注册/ 的/ 主机/ 保存/ UserID/ 、/ HostID/ 和/ ELOC/ 的/ 实时/ 映射/ 关系/ ,/ 并/ 通过/ 定期/ 与/ 主机/ 交换/ 消息/ 来/ 随时/ 更新/ ELOC/ ./ 第三/ ,/ EMS/ 接受/ 其它/ 主机/ 的/ 查询/ 请求/ ,/ 并用/ 当时/ 的/ 映射/ 关系/ 予以/ 应答/ ./ 不同/ 的/ EMS/ 负责/ 不同/ 管理/ 范围/ 内/ 的/ 用户/ ,/ 例如/ 可以/ 在/ 每个/ AS/ 内部/ 部署/ 一台/ EMS/ ./ 扩展/ 的/ DNS/ 系统/ 保存/ 了/ 3/ 类新/ 的/ 记录/ ,/ 第/ 1/ 类/ 是/ 域名/ 与/ UserID/ 之间/ 的/ 映射/ 关系/ ,/ 第/ 2/ 类/ 是/ 域名/ 或/ UserID/ 与/ 负责/ 该域/ 的/ EMS/ 的/ ELOC/ 之间/ 的/ 映射/ 关系/ ,/ 第/ 3/ 类/ 是/ 域名/ 或/ UserID/ 与/ HostID/ 之间/ 的/ 映射/ 关系/ ./ 其中/ 第三类/ 记录/ 主要/ 是/ 针对/ 一些/ 长期/ 在/ 固定/ 位置/ 提供/ 服务/ ,/ 并且/ HostID/ 很少/ 变化/ 的/ 服务器/ ./ PE/ 是/ 连接/ 核心/ 网络/ 与/ 边缘/ 网络/ 的/ 路由器/ ,/ 对/ 边缘/ 网络/ 分组/ 进行/ 封装/ 或解/ 封装/ ,/ 并/ 在/ 核心/ 网络/ 中/ 转发/ ./ PE/ 只/ 保存/ 少量/ 常用/ ELOC/ 前缀/ (/ popularprefix/ )/ 到/ RLOC/ 的/ 映射/ 关系/ ,/ 对于/ 其它/ 分组/ 则/ 封装/ 发送到/ RMS/ ./ PE/ 还/ 负责/ 通过/ 扩展/ 的/ BGP/ 协议/ 将/ 它/ 所/ 连接/ 的/ 边缘/ 网络/ 的/ 前缀/ 通告/ 给/ RMS/ ./ (/ 4/ )/ HostA/ 使用/ (/ 3/ )/ 中/ 得到/ 的/ HostID/ 和/ ELOC/ 组装/ 分组/ ,/ 分组/ 被/ 发往/ 该/ 边缘/ 网络/ 的/ 边界/ 路由器/ (/ CustomerEdge/ ,/ CE/ )/ ,/ 并/ 被/ 转发/ 到/ PEA/ ;/ (/ 5/ )/ PEA/ 用/ RMS/ 的/ RLOC/ 对/ 分组/ 进行/ 封装/ ,/ 封装/ 后/ 的/ 分组/ 在/ 核心/ 网络/ 中/ 被/ 发送到/ RMS/ ;/ RMS/ 是/ 核心/ 网络/ 中/ 部署/ 的/ 功能/ 较强/ 的/ 路由器/ ,/ 不仅/ 能/ 从/ 相同/ AS/ 内/ 的/ PE/ 那里/ 学到/ ELOC/ 前缀/ 与/ RLOC/ 之间/ 的/ 映射/ 关系/ ,/ 而且/ 能/ 通过/ 与/ 相邻/ AS/ 建立/ BGP/ 会话/ 学习/ 到/ 全局/ 映射/ 信息/ ./ 因此/ ,/ RMS/ 拥有/ 全局/ 路由表/ ,/ 能/ 将/ 接收/ 到/ 的/ 封装/ 分组/ 解/ 封装/ 后/ 再次/ 封装/ ,/ 并发/ 送到/ 正确/ 的/ 出口/ PE/ ./ RMS/ 还/ 负责/ 将/ 常用/ ELOC/ 前缀/ 通告/ 给/ 相同/ AS/ 内/ 的/ PE/ ./ 4.3/ 工作/ 流程/ 说明/ SAMS/ 的/ 基本/ 工作/ 流程/ ./ A/ )/ 发起/ 注册/ ,/ 经过/ 身份/ 认证/ 后/ 获得/ HostID/ ;/ 以图/ 2/ 中/ HostA/ 发起/ 与/ HostB/ 的/ 通信/ 为例/ ,/ (/ 1/ )/ HostA/ 向/ 其/ 所在/ 管理/ 域/ 的/ EMS/ (/ 即/ EMS/ (/ 2/ )/ HostA/ 向/ 扩展/ 的/ DNS/ 系统/ 发起/ 查询/ ,/ 查询/ 关键字/ 为/ HostB/ 的/ 域名/ ,/ DNS/ 应答/ 返回/ HostB/ 的/ UserID/ 和/ EMSB/ 的/ ELOC/ ;/ (/ 3/ )/ HostA/ 用/ HostB/ 的/ UserID/ 作为/ 关键字/ 向/ EMSB/ 发起/ 查询/ ,/ EMSB/ 应答/ 返回/ HostB/ 的/ HostID/ 和/ ELOC/ ,/ (/ 2/ )/ 和/ (/ 3/ )/ 两步/ 中/ 查询/ 的/ 结果/ 可以/ 暂时/ 保存/ 在/ HostA/ 的/ 缓存/ (/ Cache/ )/ 中/ ,/ 在/ 缓存/ 超时/ 之前/ 如果/ 又/ 有/ 查询/ 需求/ 则/ 可以/ 直接/ 从/ 缓存/ 中/ 获取/ ;/ Page6/ (/ 6/ )/ RMS/ 将/ 分组/ 解/ 封装/ 之后/ ,/ 在/ 映射/ 表中/ 查找/ 目的/ ELOC/ 对应/ 的/ 出口/ PE/ 的/ RLOC/ ,/ 用此/ RLOC/ 将/ 分组/ 再次/ 封装/ ,/ 封装/ 后/ 的/ 分组/ 在/ 核心/ 网络/ 中/ 被/ 发送到/ PEB/ ;/ (/ 7/ )/ PEB/ 将/ 分组/ 解/ 封装/ ,/ 转发/ 到/ HostB/ 所在/ 的/ 边缘/ 网络/ ,/ 分组/ 在/ 该/ 边缘/ 网络/ 中/ 被/ 发送到/ HostB/ ;/ (/ 8/ )/ 最终/ ,/ HostB/ 检查/ 出/ 分组/ 的/ 目的/ HostID/ 与/ 自己/ 的/ HostID/ 一致/ ,/ 于是/ 接收/ 该/ 分组/ ./ 5SAMS/ 特性/ 分析/ 在/ 上/ 一节/ 提出/ 的/ SAMS/ 方案/ 中/ ,/ 路由/ 可扩展性/ 、/ 移动/ 与/ 多/ 宿主/ 以及/ 真实/ 身份/ 认证/ 都/ 能/ 得到/ 很/ 好/ 的/ 支持/ ,/ 本节/ 将/ 分别/ 对/ 这些/ 特性/ 进行/ 分析/ ./ 5.1/ 路由/ 可扩展性/ SAMS/ 的/ 第一个/ 重要/ 特性/ 是/ 能/ 提高/ 核心/ 网络/ 路由/ 的/ 可扩展性/ ./ 路由/ 可扩展性/ 问题/ 主要/ 是/ 由/ 用户/ AS/ 向/ 多个/ 提供者/ AS/ 通告/ 前缀/ 造成/ 的/ ./ 然而/ 在/ SAMS/ 中/ ,/ 虽然/ PE/ 会/ 通告/ 它/ 所/ 连接/ 的/ 边缘/ 网络/ 中/ 包含/ 的/ 前缀/ ,/ 但/ PE/ 本身/ 和/ 核心/ 网络/ 中/ 的/ 普通/ 路由器/ 都/ 不会/ 保存/ 这些/ 前缀/ ./ 换句话说/ ,/ 只有/ 在/ 拥有/ 全局/ 路由表/ 的/ RMS/ 上会/ 产生/ 一些/ 开销/ ,/ 这些/ 开销/ 主要/ 有/ 两/ 部分/ ./ 第一/ 是/ 存储/ 路由表/ 和/ 计算/ 路由/ 的/ 开销/ ,/ 这部分/ 开销/ 与/ 现有/ 的/ 核心/ 网络/ 路由器/ 的/ 开销/ 相同/ ./ 但是/ ,/ 由于/ 一个/ AS/ 内部/ 只有/ 少量/ RMS/ (/ 部署/ 多台/ RMS/ 而/ 不是/ 一台/ 可以/ 预防/ 单点/ 失效/ 问题/ ,/ 并/ 提供/ 可扩展性/ )/ ,/ 因此/ 可以/ 部署/ 高性能/ 的/ 路由器/ 作为/ RMS/ 来/ 存储/ 和/ 计算/ 路由/ ,/ 也/ 就是/ 以较/ 低/ 的/ 成本/ 来/ 解决问题/ ./ 第二/ 是/ 路由/ 信息/ 更新/ 的/ 开销/ ,/ 这部分/ 开销/ 与/ 现有/ 的/ 情况/ 相比/ 得到/ 了/ 有所/ 减小/ ./ 在/ 传统/ 的/ BGP/ 协议/ 中/ ,/ 位于/ 同一个/ AS/ 内部/ 的/ BGP/ 路由器/ 之间/ 以全/ 连通/ (/ full/ -/ mesh/ )/ 的/ 形式/ 建立/ IBGP/ 会话/ ,/ 所有/ 的/ 路由/ 更新/ 消息/ 在/ 每/ 一对/ BGP/ 路由器/ 之间/ 传送/ ,/ 造成/ 极大/ 的/ 带宽/ 消耗/ ,/ 虽然/ 目前/ 很多/ AS/ 采用/ 了/ 路由/ 反射器/ (/ reflector/ )/ 技术/ [/ 22/ ]/ 来/ 取代/ 全/ 连通/ 结构/ 以求/ 减小/ 开销/ ,/ 但/ PE/ 与/ reflector/ 之间/ 的/ 路由/ 更新/ 消息/ 的/ 数据量/ 仍然/ 不可/ 忽视/ ./ 在/ SAMS/ 中/ ,/ AS/ 内部/ 的/ 路由/ 更新/ 消息/ 仅仅/ 涉及/ 与/ 该/ AS/ 所/ 连接/ 的/ 边缘/ 网络/ 的/ 前缀/ ,/ 这/ 只/ 占据/ 了/ 全部/ 路由/ 更新/ 消息/ 的/ 很小/ 一部分/ ;/ 而且/ 两个/ 相邻/ AS/ 之间/ 仅/ 在/ RMS/ 之间/ 建立/ EBGP/ 会话/ ,/ 域间/ 路由/ 更新/ 消息/ 的/ 数量/ 也/ 得到/ 了/ 有效/ 控制/ ./ 5.2/ 移动/ 与/ 多/ 宿主/ SAMS/ 的/ 第二个/ 重要/ 特性/ 是/ 支持/ 大量/ 主机/ 跨/ AS/ 移动/ 或/ 多/ 宿主/ ./ 在/ 当前/ 的/ 互联网/ 中/ ,/ IP地址/ 在/ 标识/ 用户/ 位置/ 的/ 同时/ 还/ 作为/ 传输层/ 的/ 访问/ 点/ 的/ 一部分/ 起着/ 标识/ 主机/ 身份/ 的/ 作用/ ./ 当/ 主机/ 跨越/ AS/ 移动/ 的/ 时候/ IP地址/ 发生变化/ ,/ 会/ 导致/ 两/ 方面/ 的/ 问题/ ,/ 一是/ 远程/ 用户/ 不能/ 及时/ 得到/ 移动/ 主机/ 最新/ 的/ 位置/ 信息/ ,/ 难以/ 与其/ 建立/ 连接/ ,/ 二是/ 已经/ 建立/ 的/ 传输层/ 连接/ 会/ 被/ 中断/ ,/ 需要/ 重新/ 建立/ 连接/ 才能/ 继续/ 传输/ ,/ 这/ 对于/ 一些/ 实时性/ 要求/ 较/ 高/ 的/ 应用/ 如实/ 时/ 视频/ 会/ 造成/ 较大/ 的/ 影响/ ./ 将/ UserID/ 、/ HostID/ 与/ ELOC/ 分离/ 可以/ 使/ 边缘/ 网络/ IP地址/ 较/ 好/ 地/ 聚合起来/ 作为/ 位置/ 标识/ 使用/ ,/ 而/ 当/ 主机/ 发生/ 移动/ // 多/ 宿主/ 时/ 也/ 能/ 通过/ UserID/ 和/ HostID/ 标识/ 出/ 主机/ 的/ 身份/ ./ 一方面/ ,/ 当/ 主机/ ELOC/ 发生变化/ 时/ ,/ 该主/ 机会/ 立即/ 通知/ 管理/ 它/ 的/ EMS/ 和/ 在/ 之前/ 一段时间/ 内/ 通信/ 过/ 的/ 主机/ ,/ 因此/ 在/ ELOC/ 变化/ 之后/ 其它/ 主机/ 也/ 能/ 通过/ 本地/ 缓存/ 或/ EMS/ 查询/ 到/ 该/ 主机/ 当前/ 的/ ELOC/ ,/ 从而/ 发起/ 通信/ ./ 这种/ 方式/ 能/ 适应/ 终端/ 主机/ 游牧/ 方式/ 的/ 移动/ ,/ 即/ 主机/ 从/ 一个/ 地方/ 移动/ 到/ 另/ 一个/ 地方/ 后/ 停留/ 一段时间/ ,/ 通常/ 移动/ 速度/ 较慢/ ,/ 且/ 移动/ 之后/ 需要/ 重新/ 建立/ 新/ 的/ 连接/ ./ 另一方面/ ,/ 当/ 主机/ ELOC/ 变化/ 时/ ,/ 该主/ 机会/ 立即/ 通知/ 正/ 与/ 它/ 进行/ 通信/ 的/ 主机/ ,/ 收到/ 通知/ 的/ 对/ 端/ 主机/ 只/ 需要/ 改变/ 目的/ ELOC/ ,/ 而/ 不用/ 改变/ 目的/ HostID/ ,/ 所以/ 传输/ 连接/ 不会/ 中断/ ,/ 仅仅/ 会/ 产生/ 一定/ 的/ 带宽/ 和/ 延迟/ 变化/ ./ 这种/ 方式/ 能/ 适应/ 终端/ 主机/ 漫游/ 方式/ 的/ 移动/ ,/ 即/ 主机/ 可以/ 任意/ 移动/ 且/ 在/ 移动/ 过程/ 中/ 已/ 建立/ 的/ 传输/ 连接/ 不会/ 被/ 中断/ ./ 主机/ 多/ 宿主/ 的/ 情况/ 与/ 跨域/ 移动/ 的/ 情况/ 十分/ 类似/ ,/ 不同之处/ 在于/ 多/ 宿主/ 主机/ 可以/ 同时/ 使用/ 多个/ 网络/ 接口卡/ 接入/ 到/ 网络/ ./ 这样/ ,/ 多/ 宿主/ 主机/ 在/ 从/ 一个/ ELOC/ 切换/ 到/ 另/ 一个/ ELOC/ 之前/ 可以/ 先由/ 两个/ 接口/ 分别/ 同时/ 接入/ 到/ 提供/ 这/ 两个/ ELOC/ 的/ 网络/ ,/ 切换/ 时/ 分别/ 通知/ EMS/ 和/ 对/ 端/ 主机/ 同时/ 更改/ 本地/ 路由/ ./ 在/ 这个/ 过程/ 中/ ,/ 通信/ 双方/ 的/ 分组/ 仍然/ 能够/ 进行/ 正确/ 收发/ ,/ 所以/ 数据传输/ 受到/ 的/ 影响/ 很小/ ,/ 尤其/ 是/ 当/ 切换/ 前后/ 带宽/ 和/ 端/ 到/ 端/ 延迟/ 比较/ 接近/ 的/ 时候/ ./ 借鉴/ 多/ 宿主/ 切换/ 的/ 这/ 一/ 优点/ ,/ 可以/ 在/ 主机/ 移动/ 时/ 也/ 使用/ 两个/ 接口/ ,/ 这样一来/ ,/ 即使/ 在/ 获取/ 新/ 的/ ELOC/ 和/ 检测/ ELOC/ 变化/ 的/ 时候/ 也/ 能/ 进行/ 正常/ 通信/ ./ SAMS/ 不仅/ 支持/ 单个/ 主机/ 的/ 快速/ 移动/ 和/ 多/ 宿主/ ,/ 也/ 支持/ 包含/ 多个/ 主机/ 的/ 网络/ (/ 例如/ 一辆/ 行使/ 中/ 的/ 列车/ 上/ 的/ 网络/ )/ 的/ 快速/ 移动/ 和/ 多/ 宿主/ ./ 这种/ 网络/ 中/ 需要/ 使用/ 特殊/ 的/ 网关/ ,/ 称为/ 移动/ 网络/ 边缘/ 路由器/ (/ MobileCustomEdge/ ,/ MCE/ )/ ./ MCE/ 一方面/ 充当/ Page7NAT/ 网关/ ,/ 将/ 分组/ 中/ ELOC/ 映射/ 为/ 网关/ 的/ 外部/ 地址/ 和/ 传输层/ 端口号/ 组成/ 的/ 二元/ 组/ ,/ 由于/ 新型/ 身份/ // 位置/ 分离/ 方案/ 中/ 的/ 分组/ 在/ 网络层/ 头部/ 与/ 传输层/ 头部/ 之间/ 增加/ 了/ 一类/ 新/ 的/ 头部/ ,/ 因此/ MCE/ 需要/ 在/ 传统/ NAT/ 网关/ 的/ 基础/ 上/ 进行/ 扩展/ 以便/ 能/ 识别/ 此/ 分组/ 结构/ ;/ 另一方面/ ,/ MCE/ 还要/ 负责/ 实现/ 网络/ 整体/ 移动/ 时/ 的/ 相关/ 功能/ ./ MCE/ 可以/ 使用/ 两个/ 外部/ 接口/ 来/ 帮助/ 切换/ ,/ 这/ 与/ 主机/ 多/ 宿主/ 的/ 情况/ 类似/ ./ 如图/ 3/ 所示/ ,/ 当/ 边缘/ 网络/ 需要/ 整体/ 移动/ 时/ ,/ MCE/ 的/ 一个/ 接口/ 负责/ 在/ 原来/ 的/ 路径/ 上/ 继续/ 收发/ 分组/ ,/ 另/ 一个/ 接口/ 则/ 执行/ 建立/ 新/ 的/ 链接/ 的/ 过程/ ./ 当新/ 的/ 链接/ 建立/ 完成/ 后/ ,/ 由/ MCE/ 而/ 不是/ 主机/ 负责/ 发送/ 通知/ 给/ 当前/ 有/ 通信/ 的/ 所有/ 对端/ 主机/ ,/ 由于/ MCE/ 作为/ NAT/ 网关/ 保存/ 了/ 动态/ 端口映射/ 表/ ,/ 将/ 其/ 做/ 一定/ 扩展/ 就/ 能/ 实现/ 发送/ 消息/ 给/ 通信/ 对/ 端的/ 功能/ ./ 当对端/ 主机/ 收到/ 消息/ 时/ 将/ 发送/ 分组/ 到/ 新/ 的/ 目的/ 地址/ ,/ 此时/ MCE/ 将/ 更新/ 端口映射/ 表/ ,/ 这样/ 就/ 将/ 传输/ 流量/ 转移/ 到/ 了/ 新/ 的/ 路径/ 上/ ./ 5.3/ 真实/ 身份/ 认证/ 在/ 现实/ 中/ ,/ 用户/ 与/ 主机/ 之间/ 存在/ 多/ 对/ 多/ 的/ 映射/ 关系/ ./ 一方面/ ,/ 同一/ 用户/ 可以/ 使用/ 不同/ 的/ 主机/ 连接/ 到/ 互联网/ ,/ 另一方面/ ,/ 有些/ 主机/ 也/ 会/ 被/ 多个/ 用户/ 交替/ 使用/ 甚至/ 同时/ 使用/ ./ 现有/ 的/ 身份/ // 位置/ 分离/ 方案/ 仅/ 定义/ 了/ 一种/ 身份/ 标识/ 即/ 主机/ 身份/ 标识/ ,/ 难以/ 提供/ 对/ 用户/ 身份/ 真实性/ 认证/ 的/ 支持/ ./ SAMS/ 将/ 用户/ 身份/ 标识/ 与/ 主机/ 身份/ 标识/ 相/ 分离/ 的/ 思想/ 能够/ 提供/ 更好/ 的/ 身份/ 认证/ 和/ 安全/ 机制/ ,/ 这/ 与/ 已有/ 的/ 研究/ 有/ 本质/ 上/ 的/ 不同/ ,/ 为/ 验证/ 互联网/ 用户/ 身份/ 的/ 真实性/ 与/ 合法性/ 提供/ 了/ 保障/ ,/ 也/ 为/ 网络攻击/ 源/ 追踪/ 和/ 定位/ 提供/ 了/ 基础/ ./ 用户/ 在/ 向/ 权威机构/ 申请/ 用户/ 身份/ 标识/ 的/ 时候/ ,/ 提供/ 给/ 用户/ 的/ 包括/ 一个/ 类/ Email/ 地址/ 格式/ 的/ UserID/ 和/ 一个/ 用于/ 身份验证/ 的/ Key/ 文件/ ,/ 其中/ 包含/ 用户/ 的/ 公私/ 钥对/ 以及/ 管理/ 该/ 用户/ 的/ EMS/ 的/ 公钥/ ./ 在/ SAMS/ 中/ 身份/ 认证/ 与/ 标识/ 映射/ 机制/ 是/ 集成/ 在/ 同一/ 设备/ 即/ EMS/ 上来/ 实现/ 的/ ,/ 这/ 就/ 大大/ 减小/ 了/ 系统/ 实现/ 和/ 部署/ 的/ 复杂程度/ ./ SAMS/ 提供/ 两/ 方面/ 的/ 身份/ 认证/ 机制/ ./ 一方面/ 是/ EMS/ 对/ 请求/ 注册/ 的/ 用户/ 的/ 认证/ ./ 用户/ 在/ 注册/ 的/ 时候/ 需要/ 使用/ Key/ 文件/ 中/ 包含/ 的/ 用户/ 私钥/ 对/ 注册/ 消息/ 签名/ ,/ 以/ 证明/ 注册/ 用户/ 身份/ 的/ 真实性/ ,/ 同时/ 还/ 可以/ 使用/ EMS/ 的/ 公钥/ 加密/ 以/ 防止/ 消息/ 被/ 篡改/ ./ 已/ 注册/ 的/ 用户/ 需要/ 定时/ 向/ EMS/ 发送/ 保活/ 消息/ 并/ 在/ ELOC/ 发生变化/ 时/ 立即/ 通知/ EMS/ ,/ 这些/ 消息/ 中/ 包含/ EMS/ 与/ 用户/ 主机/ 协商/ 好/ 的/ 序列号/ ,/ 每/ 交换/ 一次/ 消息/ 序列号/ 增大/ 1/ ,/ 如果/ 消息/ 丢失/ 则/ 重新/ 协商/ 序列号/ ./ 在/ 此/ 过程/ 中/ EMS/ 可以/ 随时/ 要求/ 用户/ 主机/ 进行/ 基于/ 签名/ 的/ 身份验证/ ./ 另一方面/ 是/ 通信/ 一端/ 的/ 主机/ 对/ 另一端/ 主机/ 身份/ 的/ 验证/ ,/ 其/ 基本/ 方法/ 仍然/ 是/ 基于/ 数字签名/ 机制/ ./ 主机/ 可以/ 在/ 任何/ 它/ 认为/ 需要/ 的/ 时候/ 向/ 对/ 端/ 索取/ 签名/ ,/ 例如/ 对方/ 主机/ 的/ ELOC/ 发生变化/ 之后/ ./ 6/ 讨论/ 其它/ 一些/ 相关/ 问题/ 进行/ 讨论/ ./ 这/ 一节/ 将/ 对/ SAMS/ 在/ 性能/ 上/ 的/ 一些/ 折衷/ 以及/ (/ 1/ )/ 端到/ 端/ 时延/ SAMS/ 方案/ 可能/ 增大/ 端到/ 端/ 时延/ 的/ 因素/ 包括/ 封装/ 、/ 解/ 封装/ 的/ 时间/ 开销/ ,/ 路径/ 拉伸/ ,/ 以及/ 发起/ 通信/ 前/ 的/ 映射/ 查询/ 时延/ ./ 首先/ ,/ 现有/ 核心/ 路由器/ 的/ 封装/ 和解/ 封装/ 技术/ 已/ 极为/ 成熟/ ,/ 能/ 做到/ 线速/ 转发/ ,/ 因此/ 带来/ 的/ 额外/ 时延/ 时间/ 开销/ 很小/ ./ 其次/ ,/ 路径/ 拉伸/ 仅/ 发生/ 在/ 目的/ 地址/ 为/ 少数/ 非常/ 用/ 前缀/ 的/ 情形/ 中/ ,/ 且/ 可以/ 通过/ RMS/ 的/ 合理/ 部署/ 来/ 减小/ ./ 本文/ 7.1/ 节中/ 通过/ 实验/ 评价/ 了/ 不同/ RMS/ 部署/ 对/ 路径/ 拉伸/ 的/ 影响/ ./ 最后/ ,/ 通过/ 与/ LISP/ 和/ Shim6/ 的/ 比较/ 来/ 讨论/ SAMS/ 的/ 映射/ 查询/ 时延/ ./ 在/ LISP/ 方案/ 中/ ,/ 主机/ 先/ 查询/ DNS/ 从/ 名字/ 解析/ 对/ 端的/ EID/ ,/ 然后/ 发起/ 通信/ ./ 当/ 第一个/ 分组/ 到达/ ITR/ 后/ 可能/ 会/ 出现/ CacheMiss/ ,/ 此时/ 需要/ 借助于/ 映射/ 系统/ 解析/ 对端/ EID/ 到/ RLOC/ 的/ 映射/ ,/ 会/ 引入/ 额外/ 的/ 一个/ RTT/ 的/ 时延/ ,/ 当/ ITR/ 已经/ 缓存/ 了/ 映射/ 时/ 就/ 不会/ 有/ 额外/ 时延/ ./ 然而/ 当/ CacheMiss/ 时/ ,/ ITR/ 对于/ 触发/ 查询/ 的/ 分组/ 有/ 两种/ 可能/ 的/ 处理/ 方式/ ,/ 一是/ 丢弃/ 该/ 分组/ ,/ 二是/ 缓存/ 该/ 分组/ 直到/ 查询/ 到/ 相应/ 的/ 映射/ 信息/ 或/ 计时器/ 超时/ ./ 在/ 前者/ 的/ 情况/ 下/ ,/ 发起/ 通信/ 的/ 终端/ 需要/ 等待/ 计时器/ 超时/ 并重/ 传/ (/ 例如/ TCP/ 协议/ )/ ,/ 造成/ 的/ 时延/ 将/ 远不止/ 一个/ RTT/ ,/ 而/ 后者/ 的/ 情况/ 会/ 占用/ 大量/ 的/ Page8/ 路由器/ 资源/ ,/ 不/ 具有/ 可扩展性/ ./ 在/ Shim6/ 方案/ 中/ ,/ 通信/ 双方/ 在/ 发起/ 通信/ 前/ 需要/ 执行/ 四次/ 握手/ 协议/ ,/ 额外/ 时延/ 为/ 2/ 个/ RTT/ ./ 而/ SAMS/ 在/ 最坏/ 的/ 情况/ 下/ ,/ 需要/ 对/ DNS/ 和/ EMS/ 各/ 查询/ 一次/ ,/ 引入/ 的/ 额外/ 时延/ 与/ Shim6/ 相同/ ,/ 为/ 2/ 个/ RTT/ ./ 然而/ 此/ 额外/ 时延/ 产生/ 于/ 发起/ 通信/ 前/ 的/ 查询/ 请求/ ,/ 可以/ 类比/ 为/ 现有/ 网络/ 中/ 多次/ 查询/ DNS/ 的/ 情况/ ,/ 而/ 实际/ 的/ 通信/ 过程/ 中/ 不会/ 有/ 额外/ 的/ 时延/ ./ 因此/ 与/ LISP/ 相比/ ,/ SAMS/ 将/ 处理/ 查询/ 的/ 开销/ 从/ 网络/ 转移/ 到/ 终端/ ,/ 将/ 时延/ 的/ 代价/ 从/ 通信/ 中/ 转移/ 到/ 通信/ 前/ ,/ 获得/ 了/ 一定/ 的/ 改进/ 效果/ ./ (/ 2/ )/ 映射/ 系统/ 可扩展性/ 一方面/ 讨论/ EMS/ 的/ 可扩展性/ ./ EMS/ 只/ 需要/ 维护/ 它/ 所/ 管辖/ 区域/ 内/ 的/ 用户/ ,/ 即/ 只/ 保存/ 局部/ 的/ 有限/ 的/ 信息/ ,/ 与/ 拥有/ 全局/ 信息/ 的/ DNS/ 相比/ 数据量/ 要少/ 得/ 多/ ./ 跨越/ EMS/ 管辖/ 区域/ 的/ 映射/ 查询/ 是/ 通过/ 扩展/ 的/ DNS/ 系统/ 来/ 实现/ 的/ ,/ 而/ DNS/ 系统/ 具有/ 较/ 好/ 的/ 可扩展性/ ./ 对于/ 用户数量/ 较/ 多/ 的/ AS/ ,/ 可以/ 根据/ 系统/ 的/ 处理/ 能力/ 增设/ 多台/ EMS/ 分别/ 管理/ 不同/ 的/ 用户/ (/ 例如/ 按/ 地址/ 段/ 划分/ )/ 和/ 处理/ 查询/ 请求/ ./ 而/ 对于/ 少量/ 访问/ 较为/ 频繁/ 的/ 地址/ (/ 如/ 知名/ 站点/ )/ ,/ 可以/ 通过/ 扩展/ 的/ DNS/ 系统/ 来/ 保存/ 这些/ 少量/ 的/ 映射/ 信息/ ./ 此外/ ,/ 终端/ 会/ 对/ 映射/ 信息/ 做/ 缓存/ ,/ 因此/ 同一/ 台/ 主机/ 不会/ 在/ 短时间/ 内/ 频繁/ 地向/ 同一/ 台/ EMS/ 查询/ 相同/ 的/ 映射/ 信息/ ./ (/ 4/ )/ RMS/ 会话/ 可扩展性/ 与/ 安全性/ 另一方面/ 讨论/ 扩展/ 的/ DNS/ 系统/ 的/ 可扩展性/ ./ 扩展/ 的/ DNS/ 系统/ 主要/ 保存/ 两类/ 映射/ ./ 第一类/ 是/ 域名/ 到/ EMS/ 的/ ELOC/ 的/ 映射/ ,/ 由于/ 并/ 不是/ 每个/ 用户/ 的/ UserID/ 都/ 需要/ 有/ 一个/ 域名/ 与/ 之/ 对应/ (/ 一般/ 用户/ 仅/ 拥有/ UserID/ ,/ 其/ 映射/ 记录/ 保存/ 在/ EMS/ 中/ )/ ,/ 因此/ 这/ 类/ 映射/ 的/ 管理/ 与/ 现有/ DNS/ 系统/ 享有/ 相同/ 的/ 可/ 扩展/ 能力/ ./ 第二类/ 是/ 个别/ 用户/ (/ 如/ 知名/ 站点/ )/ 的/ 域名/ 与其/ UserID/ 及/ ELOC/ 的/ 映射/ ,/ 这/ 类/ 映射/ 主要/ 是/ 为了/ 加快/ 查询/ 速度/ ,/ 以及/ 减小/ EMS/ 处理/ 查询/ 的/ 负担/ ,/ 由于/ 这/ 类/ 映射/ 记录/ 的/ 数量/ 最多/ 与/ 现有/ DNS/ 记录/ 相同/ ,/ 因此/ 不会/ 对/ DNS/ 系统/ 带来/ 可扩展性/ 问题/ ./ (/ 3/ )/ 核心网/ 流量/ 策略/ SAMS/ 方案/ 中/ ,/ 部分/ 流量/ 会/ 经过/ RMS/ 来/ 转发/ ,/ 而/ 不是/ 通常/ 的/ PE/ 到/ PE/ 的/ 路由/ 方式/ ,/ 这会/ 使得/ 原本/ 的/ 网络流量/ 发生/ 一定/ 变化/ ./ 然而/ PE/ 也/ 缓存/ 了/ 一部分/ 映射/ ,/ 虽然/ 这部分/ 映射/ 数量/ 很少/ ,/ 但是/ 它们/ 对应/ 的/ 是/ 网络/ 中/ 的/ 常用/ 前缀/ ,/ 即/ 大部分/ 流量/ 还是/ 由/ PE/ 来/ 路由/ ,/ 只有/ 少部分/ 流量/ 需要/ 经过/ RMS/ ./ 此外/ ,/ 运营商/ 还/ 可以/ 部署/ 多个/ RMS/ ,/ 并/ 通过/ 控制/ 路由/ 的/ 发布/ 和/ 学习/ 来/ 实现/ 自己/ 的/ 流量/ 策略/ ./ RMS/ 建立/ BGP/ 会话/ 的/ 主要/ 作用/ 是/ 学习/ 和/ 发布/ 全局/ 映射/ 信息/ ,/ 可以/ 分为/ 域间/ 会话/ 和域/ 内会话/ 两种/ 情况/ 来/ 讨论/ 其/ 可扩展性/ ./ 在域/ 间/ 会/ 话/ 方面/ ,/ RMS/ 与/ 现有/ BGP/ 边界/ 路由器/ 之间/ 建立/ 会话/ 的/ 方式/ 一致/ ,/ 部署/ 多少/ 台/ RMS/ 以及/ 每台/ RMS/ 与/ 哪些/ 邻居/ AS/ 的/ RMS/ 建立/ 会话/ 都/ 是/ 通过/ 管理员/ 配置/ 决定/ 的/ ,/ 因此/ 在/ 会/ 话/ 方面/ 的/ 可扩展性/ 与/ 安全性/ 与/ 现有/ 的/ BGP/ 协议/ 一致/ ./ 而在域/ 内会话/ 方面/ ,/ 因为/ RMS/ 只/ 负责/ 维护/ 全局/ 映射/ 信息/ ,/ 会话/ 建立/ 的/ 方式/ 不/ 影响/ 域/ 内/ 路由/ ,/ 所以/ 不/ 需要/ 在/ 每/ 一对/ RMS/ 之间/ 都/ 建立/ 会话/ ,/ 只/ 需要/ 使用/ 较/ 少量/ 的/ 会/ 话/ 以/ 保证/ 全局/ 映射/ 信息/ 在域/ 内/ 的/ 传播/ 即可/ ,/ 这样一来/ 就/ 不会/ 引入/ iBGP/ 协议/ 的/ 域/ 内会话/ 数量/ 平方/ 增长/ 的/ 问题/ (/ 参见/ 路由/ 反射器/ [/ 22/ ]/ )/ ./ (/ 5/ )/ 封装/ // 解/ 封装/ 开销/ 与/ LISP/ 相比/ ,/ SAMS/ 中/ 可能/ 会多/ 引入/ 一次/ 封装/ // 解/ 封装/ 的/ 开销/ ,/ 这次/ 封装/ // 解/ 封装/ 发生/ 在/ 流量/ 经过/ RMS/ 的/ 情况/ 下/ ./ 然而/ 这种/ 情况/ 仅/ 出现/ 在/ 少数/ 非常/ 用/ 前缀/ 的/ 流量/ 中/ ,/ 而/ 大多数/ 流量/ 因为/ PE/ 对/ 常用/ 前缀/ 的/ 映射/ 做/ 了/ 缓存/ ,/ 所以/ 不/ 需要/ 经过/ RMS/ ,/ 因而/ 与/ LISP/ 一样/ ,/ 只/ 需要/ 一次/ 封装/ // 解/ 封装/ ./ 此外/ 正如/ 前面/ 所说/ ,/ 现有/ 路由/ 系统/ 的/ 封装/ // 解/ 封装/ 技术/ 已/ 极为/ 成熟/ ,/ 在/ 我们/ 实现/ 的/ 原型/ 系统/ 中/ 已经/ 能够/ 达到/ 线速/ 处理/ ./ 因此/ ,/ 封装/ 的/ 开销/ 主要/ 在于/ 带宽/ 的/ 额外/ 消耗/ ,/ 这部分/ 开销/ 与/ LISP/ 引入/ 的/ 一样/ ,/ 属于/ 能够/ 承受/ 的/ 范围/ 内/ ./ (/ 6/ )/ 链路/ 失效/ 处理/ SAMS/ 方案/ 并/ 不/ 改变/ 和/ 影响/ 现有/ 网络/ 的/ 故障/ 恢复能力/ ,/ 很多/ 已有/ 方案/ 都/ 可以/ 与/ SAMS/ 共存/ ./ 即使/ 当/ PE/ 和/ CE/ 之间/ 的/ 链路/ 发生/ 故障/ 时/ ,/ 也/ 有/ 一些/ 解决/ 方法/ ,/ 例如/ 可以/ 采用/ AS/ 级别/ 的/ 多/ 宿主/ 连接/ ,/ 当/ 链路/ 出现/ 故障/ 时/ 通过/ 现有/ 的/ 路由/ 系统/ 达到/ 收敛/ ,/ 或者/ 通过/ 构建/ 冗余/ 备份/ 链路/ 来/ 达到/ 处理/ 故障/ 的/ 目的/ ./ 7/ 性能/ 分析/ 与/ 评价/ 为了/ 更好/ 地/ 评价/ SAMS/ 方案/ ,/ 我们/ 实现/ 了/ SAMS/ 原型/ 系统/ ./ 开发/ 的/ 设备/ 包括/ 扩展/ 协议/ 栈/ 的/ 主机/ 、/ 扩展/ 的/ DNS/ 系统/ 和/ EMS/ ,/ 以及/ 支持/ 新型/ 身份/ // 位置/ 分离/ 方案/ 的/ PE/ 路由器/ 和/ RMS/ ./ 原型/ 系统/ 以/ 高性能/ 虚拟/ 网络/ VegaNet/ [/ 23/ ]/ 为/ 平台/ ,/ 在/ CERNET2/ 主干网/ 的/ 10/ 个/ 路由器/ 节点/ 上/ 进行/ 了/ 部署/ ,/ 部署/ 的/ 节点/ 和/ 拓扑/ 结构/ 如图/ 4/ 所示/ ./ 实验/ 网络/ 由/ 3/ 个/ 核心/ AS/ 和/ 4/ 个/ 边缘/ 网络/ 组成/ ./ HostA/ 与/ HostB/ 分别/ 属于/ 不同/ 的/ 边缘/ 网络/ ,/ 且/ HostB/ 能/ 通过/ 不同/ 的/ 接入/ 方式/ Page9/ 分别/ 接入/ 3/ 个/ 边缘/ 网络/ ,/ 包括/ 无线/ 局域网/ (/ WiFi/ )/ 接入/ 和/ 3G/ (/ TD/ -/ SCDMA/ )/ 接入/ ,/ 其中/ 3G/ 接入/ 将/ HostB/ 连接/ 到/ 互联网/ ,/ 通过/ 建立/ 一条/ VPN/ 隧道/ 将/ 流量/ 引/ 回到/ 一个/ 边缘/ 网络/ ./ HostB/ 采用/ 多种/ 接入/ 方式/ 接入/ 到/ 多个/ 边缘/ 网络/ 的/ 目的/ 是/ 实验/ 验证/ 当/ 主机/ 移动/ 或/ 多/ 宿主/ 时/ 的/ 通信/ 情况/ ./ 下面/ 将/ 分别/ 对/ SAMS/ 的/ 多个/ 方面/ 的/ 性能/ 进行/ 分析/ 与/ 评价/ ./ 7.1/ 路由/ 可/ 扩展/ 能力/ 图/ 5/ 给出/ 了/ 采用/ SAMS/ 前后/ CERNET2/ 核心/ 网络/ 路由表/ 项/ 数量/ 的/ 情况/ ./ 总体/ 上/ ,/ 采用/ SAMS/ 之后/ 25/ 个/ 核心/ 路由器/ 节点/ 中/ 的/ 平均/ 路由表/ 数量/ 得到/ 了/ 大幅/ 减少/ ./ 具体来说/ ,/ IGP/ 路由/ 基本/ 保持/ 不变/ ,/ 从/ 用户/ AS/ 学到/ 的/ 路由/ 减少/ ,/ 这/ 两/ 部分/ 在/ 原来/ 总/ 的/ 路由表/ 中/ 占/ 的/ 比例/ 很小/ ;/ 从/ PeerAS/ 学到/ 的/ 路由/ 大幅/ 减少/ ,/ 从/ 占/ 原来/ 路由表/ 的/ 绝大多数/ 减少/ 到/ 与/ IGP/ 路由/ 大致/ 相当/ ,/ 具有/ 很/ 好/ 的/ 可扩展性/ ./ 此外/ ,/ 采用/ 一个/ RMS/ 或/ 采用/ 多个/ RMS/ 对/ 路由表/ 大小/ 的/ 影响/ 不大/ ./ 然而/ ,/ 采用/ 多个/ RMS/ 一方面/ 可以/ 预防/ 单点/ 失效/ 问题/ ,/ 另一方面/ 还/ 可以/ 减小/ 因为/ 部署/ SAMS/ 而/ 产生/ 的/ 分组/ 转发/ 路径/ 拉伸/ ,/ 从而/ 减/ 小S/ AMS/ 对端/ 到/ 端/ 延迟/ 的/ 影响/ ./ 图/ 6/ 对端/ 到/ 端/ 路径/ 拉伸/ 的/ 情况/ 进行/ 了/ 比较/ ,/ 被/ 比较/ 的/ 方案/ 包括/ 仅/ 部署/ 一台/ RMS/ 以及/ 同时/ 部署/ 三台/ RMS/ ./ 从图/ 中/ 可以/ 看出/ ,/ 选择/ 拓扑/ 结构/ 中/ 更/ 合适/ 的/ 节点/ 作为/ RMS/ 可以/ 减少/ 路径/ 拉伸/ ,/ 例如/ 将/ 北京/ 节点/ 作为/ RMS/ 时有/ 70/ %/ 的/ 端/ 到/ 端/ 路径/ 长度/ 不变/ ,/ 而/ 如果/ 将/ 上海/ 节点/ 作为/ RMS/ 则/ 只有/ 30/ %/ ./ 同时/ 使用/ 三台/ RMS/ 可以/ 获得/ 最小/ 的/ 路径/ 拉伸/ ,/ 88/ %/ 的/ 路径/ 长度/ 不变/ ,/ 只有/ 不到/ 5/ %/ 的/ 路径/ 拉伸/ 超过/ 2/ ,/ 而/ 这部分/ 路径/ 拉伸/ 可以/ 通过/ 在/ PE/ 路由器/ 上/ 配置/ 常用/ 前缀/ 来/ 消除/ ./ 7.2/ 标识/ 快速/ 切换/ 为了/ 评价/ SAMS/ 的/ 标识/ 快速/ 切换/ 能力/ ,/ 我们/ 测量/ 了/ HostB/ 在/ 两个/ 接入/ 网络/ 之间/ 每次/ 切换/ 所/ 需/ 的/ 时间/ ,/ 图/ 7/ 和/ 图/ 8/ 给出/ 了/ 实验/ 结果/ ,/ 其中/ 图/ 7/ 按照/ 测试/ 的/ 时间/ 顺序/ 给出/ 了/ 每/ 一次/ 移动/ 切换/ 的/ 时间/ ,/ 而图/ 8/ 给出/ 了/ 切换/ 时间/ 的/ 累积/ 分布/ ./ 可以/ 看到/ 切换/ 的/ 时间/ 大体/ 较为/ 稳定/ ,/ 有/ 大约/ 50/ %/ 的/ 切换/ 的/ 切换/ 时间/ 在/ 1.5/ s/ ~/ 2s/ 之间/ ,/ 平均/ 切换/ 时间/ 为/ 2.28/ s/ ./ 由于/ 一般/ 的/ Page10/ 流媒体/ 应用/ 都/ 会/ 有/ 2s/ ~/ 3s/ 的/ 缓存/ ,/ 因此/ 这/ 一切/ 换/ 时间/ 能为/ 这类/ 应用/ 提供/ 移动/ 中/ 的/ 平滑/ 播放/ ./ 这一/ 实验/ 结果/ 说明/ SAMS/ 能/ 提供/ 很/ 好/ 的/ 多/ 宿主/ 和/ 移动/ 主机/ 跨域/ 高速/ 切换/ 的/ 性能/ ./ 为了/ 分析/ 影响/ 标识/ 切换/ 时间/ 的/ 因素/ ,/ 为/ 进一步/ 优化/ 奠定/ 基础/ ,/ 我们/ 建立/ 了/ 如图/ 9/ 所示/ 的/ 理论/ 模型/ ,/ 它/ 使用/ 广义/ 随机/ Petri/ 网/ [/ 24/ ]/ (/ GeneralizedStochatiscPetriNet/ ,/ GSPN/ )/ 描述/ 了/ 移动/ 主机/ 在/ ELOC/ 变化/ 时/ 通信/ 双方/ 的/ 状态/ ./ 表/ 2/ 给出/ 了/ 模型/ 中/ 各/ 位置/ 和/ 变迁/ 的/ 含义/ ./ 符号/ p1/ 主机/ A/ 发生/ 移动/ 前/ 的/ 瞬间/ t1/ 主机/ A/ 发生/ 移动/ p2/ 对端/ 主机/ B/ 尝试/ 发送/ 分组/ t2p4p5p3/ 主机/ A/ 获取/ ELOC/ ,/ 检测/ ELOC/ 变化/ ,/ 通知/ 端/ 主机/ ELOC/ 变化/ 对端/ 主机/ B/ 等待/ 重传/ 计时器/ 超时/ 对端/ 主机/ B/ 收到/ 了/ ELOC/ 变化/ 的/ 消息/ ,/ 映射/ 缓存/ 更新/ 完成/ 对端/ 主机/ B/ 完成/ 发送/ 分组/ 到/ 新/ 的/ ELOCt6/ 其中/ t2/ 、/ t3/ 、/ t4/ 、/ t6/ 是/ 时间/ 变迁/ ,/ 速率/ 分别/ 是/ λ/ 2/ 、/ λ/ 3/ 、/ λ/ 4/ 、/ λ/ 6/ ./ 通过/ 求解/ 此/ 模型/ 可以/ 得到/ 一个/ 标记/ 从/ 离开/ 位置/ p1/ 到/ 再次/ 返回/ p1/ 的/ 平均/ 时间/ ,/ 即/ 主机/ 进行/ ELOC/ 切换/ 时/ 不能/ 接收/ 到/ 对/ 端/ 发来/ 的/ 分组/ 的/ 平均/ 时间/ 间隔/ :/ p6/ 这/ 一时间/ 间隔/ 由/ 三/ 部分/ 组成/ ,/ 一是/ 获取/ 新/ ELOC/ 的/ 时间/ 加上/ 检测/ 本机/ ELOC/ 变化/ 的/ 时间/ 再/ 加上/ 发送/ 消息/ 通知/ 对/ 端的/ 时间/ ,/ 二是/ 重传/ 计时器/ 超时/ 时间/ 的/ 2/ 倍/ ,/ 三是/ 对/ 端/ 到/ 本/ 主机/ 新/ 路径/ 的/ 传输/ 延迟/ ./ 针对/ 这一/ 结论/ ,/ 可以/ 从/ 两/ 方面/ 入手/ 对/ 主机/ 移动/ 时/ 产生/ 的/ 延迟/ 变化/ 进行/ 优化/ :/ (/ 1/ )/ 改进/ 传输/ 协议/ 在/ ELOC/ 切换/ 时/ 的/ 重传/ 时间/ 间隔/ ;/ (/ 2/ )/ 缩短/ 检测/ 本机/ ELOC/ 变化/ 的/ 时间/ ,/ 可以/ 依靠/ 在/ 内核/ 设计/ 特殊/ 的/ 机制/ 来/ 实现/ 当/ 网卡/ 一旦/ 变成/ 可用/ 状态/ 时/ 就/ 立即/ 发送/ 消息/ ./ 此外/ ,/ 采用/ 双网卡/ 进行/ 位置/ 标识/ 切换/ 也/ 有利于/ 减小/ 切换/ 时间/ ./ 7.3/ 身份/ 认证/ 开销/ 从/ 功能/ 看/ ,/ SAMS/ 将/ 身份/ 标识/ 与/ 位置/ 标识/ 进行/ 区分/ ,/ 并/ 通过/ 签名/ 机制/ 提供/ 对/ 用户/ 身份/ 真实性/ 的/ 认证/ ,/ 从而/ 保证/ 会话/ 的/ 可信/ 与/ 可靠/ ./ 这种/ 身份/ 认证/ 机制/ 的/ 安全/ 性能/ 是/ 由/ 签名/ 算法/ 来/ 保证/ 的/ ,/ 在/ 本文/ 中/ 不/ 做/ 进一步/ 的/ 讨论/ ,/ 这里/ 主要/ 对/ 身份/ 认证/ 的/ 开销/ 进行/ 实验/ 评价/ ,/ 以/ 说明/ SAMS/ 提供/ 的/ 真实/ 身份/ 认证/ 特性/ 不会/ 对/ 基本/ 的/ 转发/ 功能/ 造成/ 影响/ ./ 图/ 10/ 给出/ 了/ 在/ 开启/ 签名/ 和/ 不/ 开启/ 签名/ 这/ 两种/ 情况/ 下/ ,/ 用户/ 主机/ 与/ EMS/ 之间/ 的/ 保活/ 消息/ 的/ 往返/ 时间/ 实验/ 结果/ ,/ 这/ 段时间/ 既/ 包括/ 了/ 用户/ 主机/ 和/ EMS/ 构造/ 消息/ 、/ 计算/ 和/ 验证/ 签名/ 的/ 时间/ ,/ 也/ 包括/ 了/ 消息/ 在/ 网络/ 中/ 传输/ 的/ 时间/ ./ 从图/ 中/ 可以/ 看出/ 开启/ 签名/ 与/ 不/ 开启/ 签名/ 相比/ 额外/ 开销/ 很/ Page11/ 少/ ,/ 两种/ 情况/ 下/ 的/ 平均/ 处理/ 延迟/ 分别/ 为/ 69.28/ ms/ 与/ 64.44/ ms/ ./ 这/ 就/ 说明/ 了/ SAMS/ 可以/ 在/ 不/ 影响/ 正常/ 通信/ 的/ 情况/ 下/ 的/ 提供/ 安全性/ 保证/ ./ 7.4/ 可/ 部署/ 性/ SAMS/ 既/ 需要/ 改动/ 网络/ ,/ 也/ 需要/ 改动/ 主机/ 的/ 协议/ 栈/ ,/ 但/ 它/ 仍然/ 提供/ 了/ 较/ 好/ 的/ 对/ 可/ 部署/ 性/ 的/ 支持/ ./ 总的来说/ ,/ SAMS/ 既能/ 提高/ 核心网/ 的/ 路由/ 可扩展性/ ,/ 也/ 能/ 为/ 终端用户/ 提供/ 很多/ 好处/ ./ 对于/ 网络/ 运营商/ 来说/ ,/ 部署/ SAMS/ 可以/ 帮助/ 他们/ 有效/ 地/ 解决/ 核心/ 网路/ 由/ 可扩展性/ 问题/ ,/ 且/ 不/ 影响/ 流量/ 工程/ 、/ 故障/ 恢复/ 等/ 其它/ 功能/ ./ 对于/ 用户/ 来说/ ,/ SAMS/ 提供/ 了/ 对/ 移动性/ 和/ site/ 级别/ 的/ 多/ 宿主/ 的/ 支持/ ,/ 并且/ 由于/ SAMS/ 支持/ 真实/ 身份/ 认证/ ,/ 当/ 发生/ 攻击/ 时/ ,/ 部署/ 了/ SAMS/ 的/ 非/ 攻击者/ 用户/ 能够/ 最早/ 被/ 排除/ 嫌疑/ ,/ 这种/ 先/ 部署/ 先/ 获益/ 的/ 特性/ 可以/ 促进/ SAMS/ 的/ 部署/ ./ 此外/ ,/ SAMS/ 对/ 主机/ 协议/ 栈/ 的/ 修改/ 很/ 轻量/ ,/ 且/ 与/ 现有/ 协议/ 栈/ 兼容/ ,/ 这/ 使得/ 在/ 终端/ 部署/ SAMS/ 可以/ 通过/ 操作系统/ 升级/ 或/ 打补丁/ 的/ 方式/ 实现/ ,/ 无须/ 用户/ 自己/ 动手/ ./ SAMS/ 原型/ 系统/ 进行/ 了/ 长期/ 实验/ ,/ 在/ 峰值/ 流量/ 达到/ 600Mbps/ 的/ 情况/ 下/ ,/ 主干网/ 设备/ 仍然/ 能/ 很/ 好/ 地/ 完成/ ELOC/ 到/ RLOC/ 之间/ 的/ 映射/ 和/ 分组/ 转发/ 功能/ ./ 此外/ ,/ SAMS/ 原型/ 系统/ 在/ 主机/ 协议/ 栈/ 和/ 应用程序/ 的/ 各种/ 组合/ 情况/ 下/ 都/ 能/ 很/ 好/ 地/ 工作/ ,/ 这些/ 都/ 说明/ SAMS/ 具有/ 很/ 好/ 的/ 可/ 部署/ 性/ ./ 下面/ 给出/ SAMS/ 端到/ 端/ 通信/ 的/ 几种/ 典型/ 的/ 场景/ ./ 当/ 通信/ 双方/ 的/ 协议/ 栈均/ 为/ 新/ 协议/ 栈且/ 已/ 分别/ 向/ 各自/ 的/ EMS/ 注册/ 的/ 时候/ ,/ 可以/ 使用/ 新/ 开发/ 的/ 应用程序/ (/ 用/ UserID/ 或/ HostID/ 进行/ 通信/ )/ ,/ 也/ 可以/ 使用/ 传统/ 的/ 应用程序/ (/ 用/ IP/ 进行/ 通信/ )/ ./ 当/ 使用/ 传统/ 应用程序/ 通信/ 时/ ,/ 需要/ 事先/ 在/ 本地/ 缓存/ 中/ 保存/ 对端/ 主机/ 的/ HostID/ 和/ ELOC/ 的/ 映射/ 信息/ ,/ 这/ 可以/ 通过/ 先/ 运行/ 其它/ 新/ 开发/ 的/ 应用程序/ 来/ 实现/ ,/ 例如/ 以/ 对/ 端的/ UserID/ 为/ 对象/ 运行/ 扩展/ 的/ ping/ 程序/ ./ 无论/ 使用/ 哪/ 种/ 应用程序/ ,/ 双方/ 都/ 是/ 通过/ 发送/ 和/ 接收/ 包含/ ID/ 头部/ 的/ 分组/ 相互/ 通信/ 的/ ./ 当/ 通信/ 双方/ 中/ 只有/ 一端/ 的/ 协议/ 栈为/ 新/ 协议/ 栈/ ,/ 而/ 另一端/ 为/ 传统/ 协议/ 栈时/ ,/ 因为/ 传统/ 协议/ 栈/ 无法/ 对/ 含有/ ID/ 头部/ 的/ 分组/ 进行/ 处理/ ,/ 所以/ 只能/ 依靠/ 发送/ 传统/ 的/ IP/ 分组/ 进行/ 通信/ ./ 此时/ ,/ 使用/ 新/ 协议/ 栈/ 的/ 主机/ 查询/ 不到/ 对端/ 主机/ 的/ HostID/ ,/ 映射/ 缓存/ 中/ 也/ 不会/ 保存/ 此/ 信息/ ,/ 所以/ 协议/ 栈/ 虽然/ 包含/ 身份/ 标识/ 层/ ,/ 但/ 不会/ 对/ 分组/ 添加/ ID/ 头部/ ,/ 分组/ 的/ 发送/ 和/ 接收/ 按照/ 传统/ 的/ 流程/ 进行/ ./ 总的来说/ ,/ 新/ 协议/ 栈/ 的/ 主机/ 能够/ 一边/ 发送/ 包含/ ID/ 头部/ 的/ 分组/ 与/ 另/ 一新/ 协议/ 栈/ 主机/ 通信/ ,/ 同时/ 一边/ 访问/ 互联网/ 上/ 的/ 传统/ 站点/ ,/ 充分体现/ 了/ SAMS/ 的/ 逐步/ 部署/ 能力/ ./ 8/ 总结/ 互联网/ 路由/ 可扩展性/ 问题/ 亟待解决/ ,/ 与此同时/ ,/ 安全性/ 与/ 多/ 宿主/ 以及/ 移动性/ 在/ 未来/ 互联网/ 中/ 的/ 重要/ 程度/ 也/ 越来越/ 高/ ./ 学术界/ 普遍认为/ 将/ IP地址/ 的/ 身份/ 标识/ 语义/ 和/ 位置/ 标识/ 语义/ 分离/ 开来/ 是/ 解决/ 这些/ 问题/ 的/ 根本/ 方法/ ,/ 但/ 现有/ 的/ 身份/ // 位置/ 分离/ 方案/ 不能/ 同时/ 很/ 好地解决/ 这些/ 问题/ ./ 本文/ 提出/ 了/ 一种/ 新型/ 身份/ // 位置/ 分离/ 方案/ SAMS/ ./ SAMS/ 将/ 用户/ 身份/ 标识/ ,/ 主机/ 身份/ 标识/ ,/ 边缘/ 网络/ 位置/ 标识/ 和/ 核心/ 网络/ 位置/ 标识/ 分离/ ,/ 构成/ 方案/ 体系结构/ 的/ 要素/ 包括/ 边缘/ 网络/ 映射/ 服务器/ EMS/ ,/ 扩展/ 的/ DNS/ 系统/ ,/ 核心/ 网络/ 边缘/ 路由器/ PE/ 以及/ 核心/ 网络/ 映射/ 服务器/ RMS/ ,/ 很/ 好/ 地/ 分离/ 了/ IP地址/ 的/ 语义/ ./ SAMS/ 大幅提高/ 了/ 核心/ 网路/ 由/ 可扩展性/ ,/ 为/ 用户/ 真实/ 身份/ 认证/ 提出/ 了/ 一种/ 较/ 好/ 的/ 解决方案/ ,/ 并/ 能/ 很/ 好/ 地/ 支持/ 多/ 宿主/ 和/ 大规模/ 移动/ ./ 我们/ 实现/ 了/ SAMS/ 的/ 原型/ 系统/ ,/ 在/ CERNET2/ 主干网/ 节点/ 上/ 部署/ 了/ 大规模/ 的/ 实验/ 网络/ 并/ 进行/ 了/ 长时间/ 的/ 实验/ ,/ 实验/ 结果表明/ 原型/ 系统/ 具有/ 预期/ 的/ 功能/ 和/ 良好/ 的/ 性能/ ,/ 并/ 具备/ 很强/ 的/ 兼容性/ 和/ 可/ 逐步/ 部署/ 能力/ ./ 

