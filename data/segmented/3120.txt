Page1/ 可信计算/ 平台/ 信任/ 链/ 安全性/ 分析/ 徐明迪/ 张焕国/ 赵恒/ 李峻林/ 严飞/ (/ 武汉/ 数字/ 工程/ 研究所/ 武汉/ 430074/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ (/ 空天/ 信息安全/ 与/ 可信计算/ 教育部/ 重点/ 实验室/ 武汉/ 430072/ )/ 摘要/ 可信计算/ 规范/ 是/ 指导/ 可信计算/ 产品/ 研制/ 的/ 依据/ ,/ 可信计算/ 规范/ 本身/ 的/ 安全性/ 需要/ 得到/ 验证/ ./ 信任/ 链是/ 可信计算/ 平台/ 中/ 保障系统/ 安全可靠/ 的/ 主要/ 技术手段/ ,/ 它/ 是/ 可信计算/ 平台/ 整个/ 系统安全/ 的/ 中心/ 问题/ ./ 针对/ 可信计算/ 平台/ 信任/ 链/ 规范/ 的/ 信息流/ 安全/ 问题/ ,/ 文中/ 通过/ 安全/ 进程/ 代数/ 对/ 信任/ 链/ 系统/ 接口/ 进行/ 形式化/ 建模/ ,/ 用/ 可/ 复合/ 的/ 不可/ 演绎/ 模型/ 刻画/ 信任/ 链/ 实体/ 间/ 的/ 交互/ 关系/ ,/ 把/ 规范/ 定义/ 的/ 信任/ 链/ 行为/ 特性/ 抽象/ 为/ 多级/ 安全/ 输入输出/ 集/ ,/ 在/ 讨论/ 高级/ 和/ 低级/ 输入输出/ 依赖/ 关系/ 的/ 基础/ 之上/ ,/ 对/ 信任/ 链/ 复合/ 系统/ 进行/ 信息流/ 分析/ ,/ 并/ 给出/ 结论/ 和/ 证明/ ./ 关键词/ 信任/ 链/ ;/ 安全/ 进程/ 代数/ ;/ 可/ 复合/ 的/ 不可/ 演绎/ 模型/ 1/ 引言/ 目前/ ,/ 可信计算/ 的/ 相关/ 研究/ 已/ 成为/ 当前/ 国内外/ 信息安全/ 方面/ 的/ 研究/ 热点/ 和/ 趋势/ 之一/ ./ 一方面/ ,/ 可信计算/ 在/ 计算机系统/ 上/ 有着/ 具体/ 的/ 实现/ 和/ 应用/ ,/ 如/ Vista/ 操作系统/ 的/ BitLocker/ 通过/ 信任/ 链/ 机制/ 保护/ 加密/ 分区/ 和/ 卷主/ 密钥/ ,/ 为了/ 实现/ 对/ 虚拟机/ 的/ 动态/ 度量/ ,/ AMD/ 和/ Intel/ 生产/ 的/ CPU/ 增加/ 了/ 支持/ 动态/ 可信度/ 量/ 根/ 的/ 指令/ ./ 另一方面/ ,/ 可信计算/ 产品/ 的/ 安全/ 测评/ 也/ 是/ 业界/ 所/ 关注/ 的/ 问题/ ,/ 可信计算/ 组织/ TCG/ (/ TrustedComputingGroup/ )/ 针对/ 可信/ 平台/ 模块/ Page2TPM/ (/ TrustedPlatformModule/ )/ 的/ 设计/ 安全/ ,/ 给出/ 了/ 相应/ 的/ 保护/ 轮廓/ ,/ 并/ 通过/ 了/ 国际/ 通用/ 标准/ 认证/ CC/ (/ CommonCriteria/ )/ ./ Atmel/ 公司/ 的/ TPM/ 产品/ AT97SC3201/ 通过/ 了/ 认证/ 实验室/ CygnaCom/ 的/ EAL3/ 认证/ ./ Infineon/ 公司/ 已经/ 开始/ 对/ 生产/ 的/ TPM/ 进行/ 最/ 严格/ 的/ 硬件安全/ 评估/ 流程/ 审核/ ,/ 计划/ 要/ 达到/ EAL4/ 硬件安全/ 水平/ ./ 从/ 其/ 保护/ 轮廓/ 的/ 文档/ 描述/ 来看/ ,/ 其/ 主要/ 讨论/ 的/ 是/ TBB/ 与/ 平台/ 的/ 唯一/ 关联性/ 问题/ ,/ 对于/ 其它/ 安全性/ 目标/ 并未/ 涉及/ [/ 1/ ]/ ./ 可信计算/ 产品/ 的/ 设计/ 依据/ 源于/ 规范/ 说明/ ,/ 因此/ 可信计算/ 产品/ 的/ 安全/ 程度/ 和/ 规范/ 说明/ 有着/ 直接/ 联系/ ./ 一般来说/ ,/ 规范/ 通常/ 是/ 采用/ 自然语言/ 或者/ 非/ 形式化/ 语言/ 的/ 一种/ 描述/ ,/ 很难/ 直接/ 从/ 规范/ 中/ 发现/ 其/ 潜在/ 的/ 安全/ 缺陷/ 或/ 漏洞/ ./ 目前/ ,/ TCG/ 尚未/ 对/ 其/ 规范/ 和/ 产品/ 的/ 安全性/ 进行/ 全面/ 的/ 分析/ 和/ 验证/ ./ 从/ 公开/ 的/ 文献/ 来看/ ,/ TCG/ 技术规范/ 中仅/ 对/ 直接/ 匿名/ 认证/ DAA/ (/ DirectAnonymousAttestation/ )/ 等/ 协议/ 进行/ 了/ 较为/ 严格/ 的/ 安全性/ 分析/ ./ 信任/ 链/ 的/ 交互/ 模型/ 建立/ 过程/ 是/ 将/ 信任/ 链/ 由/ 可信计算/ 规范/ 进行/ 粗粒度/ 抽取/ 的/ 过程/ ./ 在/ 这方面/ ,/ 国内外/ 已经/ 有/ 了/ 少量/ 工作/ ,/ Abadi/ 和/ Wobber/ 在/ 文献/ [/ 2/ ]/ 中/ 使用/ 授权/ 逻辑/ 对/ 下一代/ 安全/ 计算/ 基/ NGSCB/ 的/ 基本/ 框架/ 和/ API/ 函数/ 进行/ 了/ 形式化/ 描述/ ,/ Chen/ 等/ 人用/ 谓词/ 逻辑/ 分析/ 了/ 可信/ 启动/ 过程/ 存在/ 的/ 信任/ 链/ 传递/ 所/ 带来/ 的/ 信任/ 损失/ 问题/ ,/ 并/ 提出/ 一种/ 集中式/ 度量/ 的/ 改进/ 启动/ 模型/ [/ 3/ ]/ ,/ 但/ 该文/ 所/ 提出/ 的/ 模型/ 无法/ 应用/ 于/ 信任/ 链/ 的/ 测试/ 研究/ 工作/ ./ G/ ü/ rgens/ 等/ 人/ 使用/ 模型/ 检查/ 器/ 对/ TPM/ 的/ 若干/ 协议/ 进行/ 了/ 分析/ ,/ 发现/ 了/ 授权/ 协议/ 和/ 远程/ 证明/ 协议/ 中/ 存在/ 的/ 问题/ [/ 4/ ]/ ./ Millen/ 等/ 人/ 开发/ 了/ 一个/ 符号/ 模型/ 检查/ 器来/ 描述/ 可信/ 启动/ 过程/ 中/ TPM/ 内部/ 组件/ 、/ BIOS/ 和/ 平台/ 其它/ 组件/ 之间/ 的/ 信任/ 关系/ [/ 5/ ]/ ,/ 但/ 该文/ 主要/ 围绕/ PCR/ 的/ 度量/ 问题/ 对/ 信任/ 启动/ 过程/ 进行/ 建模/ ,/ 并未/ 讨论/ 信任/ 链/ 的/ 具体/ 交互/ 问题/ ./ Lin/ 使用/ Otter/ 和/ Alloy/ 分析/ TPM/ 中/ API/ 调用/ 序列/ 的/ 安全性/ [/ 6/ ]/ ./ 文献/ [/ 7/ -/ 8/ ]/ 通过/ 安全/ 进程/ 代数/ SPA/ (/ SecurityProcessAlgebra/ )/ 和/ 时序/ 逻辑/ 对/ 信任/ 链中/ 的/ 静态/ 度量/ 根/ SRTM/ (/ StaticRootofTrustedMeasurement/ )/ 和/ 动态/ 度量/ 根/ DRTM/ (/ DynamicRootofTrustedMeasurement/ )/ 进行/ 了/ 形式化/ 建模/ 和/ 证明/ ,/ 但是/ 该文/ 对于/ SRTM/ 的/ 一些/ 前提/ 假设/ ,/ 如/ 平台/ 配置/ 寄存器/ PCR/ (/ PlatformConfigurationRegister/ )/ 的/ 写/ 操作/ 问题/ 、/ 内存/ 写/ 保护/ 问题/ ,/ 在/ 现有/ 系统/ 中/ 过于/ 理想/ ./ 同时/ ,/ 信任/ 链/ 由/ 系统/ 中/ 的/ 多个/ 组件/ 构成/ ,/ 它/ 建立/ 于/ 原有/ 计算机硬件/ 系统/ 基础/ 之上/ ,/ 但/ 不是/ 以/ 整体/ 形式/ 存在/ 于/ 系统/ 中/ ,/ 而是/ 各/ 组件/ 与/ 原有/ 系统/ 存在/ 时间/ 、/ 空间/ 上/ 的/ 交错/ 状态/ [/ 9/ ]/ ,/ 这种/ 空间/ 上/ 的/ 离散/ 型/ ,/ 时间/ 上/ 的/ 并行性/ 使得/ 信任/ 链/ 的/ 建模/ 变得/ 困难/ ./ 另一方面/ ,/ 信任/ 链/ 和/ 系统/ 之间/ 通过/ 相互作用/ 形成/ 一个/ 复杂/ 的/ 系统/ 整体/ 结构/ ,/ TPM/ 、/ RTM/ 和/ System/ 都/ 有/ 各自/ 的/ 输入/ 、/ 输出/ 和/ 安全策略/ ,/ 从/ 信息流/ 的/ 角度/ 来看/ ,/ 复合/ 系统/ 中不应/ 出现/ 直接/ 或/ 间接/ 的/ 信息/ 泄露/ ./ 安全/ 性质/ 的/ 可/ 复合性/ 很/ 重要/ ,/ 一方面/ 分解/ 与/ 结合/ 是/ 构造/ 复杂/ 系统/ 的/ 有效/ 方法/ ;/ 另一方面/ ,/ 复杂/ 的/ 计算机系统/ 是/ 开放/ 的/ ,/ 系统配置/ 可以/ 随/ 时间/ 变化/ ,/ 因此/ ,/ 复合/ 安全/ 性质/ 对于/ 定义/ 安全/ 系统/ 是/ 非常/ 必要/ 的/ [/ 10/ ]/ ./ 本文/ 从/ 可/ 复合/ 的/ 不可/ 演绎/ 模型/ 出发/ ,/ 对/ 可信计算/ 信任/ 链/ 规范/ 进行/ 形式化/ 建模/ ,/ 描述/ 信任/ 链/ 传递/ 过程/ 中/ 的/ 实体/ 交互/ 关系/ ,/ 通过/ SPA/ 描述/ 信任/ 链/ 系统/ 的/ 信息流/ 性质/ ,/ 刻画/ 信任/ 链/ 实体/ 动作/ ,/ 抽象/ 出/ 高低/ 安全/ 级/ 进程/ 的/ 输入/ 和/ 输出/ ,/ 最后/ 用/ CoPS/ 工具/ 对/ 安全/ 属性/ 进行/ 验证/ ,/ 找出/ 规范/ 中/ 存在/ 的/ 安全/ 缺陷/ ./ 2/ 研究/ 背景/ 2.1/ 基于/ 语言/ 的/ 安全/ 模型/ 现有/ 的/ 基于/ 语言/ 的/ 安全/ 模型/ 大致/ 上/ 都/ 是/ 扩展/ 无/ 干扰/ 安全/ 的/ 思想/ ,/ 在/ 不同/ 层次/ 上/ 刻划/ 不同/ 安全等级/ 的/ 访问/ 主体/ 之间/ 的/ 无/ 干扰/ 关系/ [/ 11/ ]/ ,/ 如/ Focardi/ 等/ 人/ 扩展/ 了/ Milner/ 的/ CCS/ 建立/ 了/ 安全/ 进程/ 代数/ [/ 12/ ]/ ,/ 将/ 系统/ 中/ 的/ 名/ 赋予/ “/ 高/ ”/ 、/ “/ 低/ ”/ 两种/ 安全级别/ ,/ 对/ 无/ 干扰/ 模型/ 进行/ 重新/ 定义/ 及/ 分类/ ,/ 分析/ 不同/ 安全/ 属性/ 的/ 强度/ ./ Ryan/ 和/ Schneider/ 使用/ CSP/ 得出/ 多个/ 无/ 干扰/ 安全/ 属性/ 的/ 定义/ ,/ 并/ 提出/ 一个/ 建立/ 统一/ 无/ 干扰/ 定义/ 属性/ 的/ 构想/ ./ Volpano/ 等/ 人/ 将/ 系统/ 的/ 可靠性/ 视为/ 某种/ 无/ 干扰/ 属性/ ,/ 通过/ 证明/ 标准/ 程序/ 语义/ 建立/ 系统/ 的/ 可靠性/ ,/ 使得/ 所有/ 类型定义/ 良好/ 的/ 程序/ 都/ 具有/ 无/ 干扰/ 安全/ 属性/ [/ 13/ ]/ ./ 2.2/ 安全/ 进程/ 代数/ 2.2/ ./ 1SPA/ 的/ 基本/ 语法/ 安全/ 性质/ 是/ 信息流/ 性质/ [/ 10/ ]/ ./ 直接/ 或/ 间接/ 的/ 信息/ 泄露/ 都/ 被/ 看作/ 系统/ 中/ 的/ 信息/ 流动/ ,/ 都/ 可以/ 使用/ 信息流/ 分析/ 的/ 技术/ 找到/ 系统/ 中/ 潜在/ 的/ 各种/ 安全/ 问题/ ,/ 对于/ 信息流/ 安全/ 而言/ ,/ 安全/ 属性/ 刻画/ 了/ 一个/ 安全/ 的/ 多级/ 系统/ 应该/ 满足/ 的/ 属性/ ,/ 信息流/ 分析/ 的/ 技术/ 源于/ 基本/ 无/ 干扰/ (/ NI/ )/ 模型/ [/ 14/ ]/ ,/ 后来/ 又/ 相继/ 出现/ 了/ 不可/ 推断/ (/ N/ -/ INF/ )/ 模型/ [/ 15/ ]/ 、/ 输入/ 不可/ 演绎/ (/ NDI/ )/ 模型/ [/ 16/ -/ 17/ ]/ ./ 但/ 这些/ 安全/ 属性/ 都/ 是/ 不可/ 复合/ 的/ ./ 后来/ 又/ 有/ 学者/ 提出/ Page3/ 了/ 策略/ 不可/ 演绎/ (/ NDS/ )/ 模型/ 和/ 可/ 复合/ 的/ 不可/ 演绎/ (/ NDC/ )/ 模型/ [/ 12/ ]/ ./ 进程/ 代数/ 作为/ 描述/ 互/ 作用/ 系统/ 的/ 一般/ 框架/ ,/ 适合/ 于/ 研究/ 安全/ 信息流/ 性质/ ./ 在/ 进程/ 代数/ 框架/ 内/ 研究/ 信息流/ 性质/ ,/ 不仅/ 可以/ 对/ 其/ 进行/ 概括/ 和/ 比较/ ,/ 而且/ 还/ 可以/ 利用/ 进程/ 代数/ 中/ 的/ 某些/ 结果/ 更/ 抽象/ 更/ 深刻/ 地/ 理解/ 安全性/ 及其/ 结合/ 性质/ [/ 10/ ]/ ./ 本文/ 使用/ 的/ 安全/ 进程/ 代数/ 语言/ SPA/ ,/ 是/ CCS/ 的/ 简单/ 扩展/ ./ SPA/ 的/ 基本/ 语法/ 符号/ 包括/ :/ (/ 1/ )/ 进程/ 动作/ 集/ Act/ ./ 它/ 由/ 3/ 部分/ 组成/ :/ 无穷/ 名集/ I/ ,/ I/ 的/ 伴/ 名集/ O/ ,/ 一个/ 称为/ 哑名/ 的/ 元素/ τ/ ./ 其中/ ,/ I/ =/ {/ a/ ,/ b/ ,/ …/ }/ 表示/ 输入/ 动作/ 集/ ;/ O/ =/ {/ 珔/ a/ ,/ 珔/ b/ ,/ …/ }/ 表示/ 输出/ 动作/ 集/ ;/ / =/ I/ ∪/ O/ 表示/ 可见/ 动作/ 集合/ ,/ τ/ 表示/ 不/ 可见/ 动作/ ./ 更进一步/ ,/ 为了/ 描述/ 多级/ 安全/ 系统/ 中/ 不同/ 安全/ 级/ 之间/ 的/ 信息流/ 关系/ ,/ SPA/ 将/ 可见/ 动作/ 集/ / 划分/ 为/ 两个/ 安全/ 级/ :/ 高/ 安全/ 级/ 动作/ ActH/ 和/ 低/ 安全/ 级/ 动作/ ActL/ ,/ 并且/ ActH/ =/ ActHI/ ∪/ ActHO/ ,/ ActL/ =/ ActLI/ ∪/ ActLO/ ,/ ActH/ ∪/ ActL/ =/ / ,/ ActH/ ∩/ ActL/ =/ / ,/ Act/ =/ ActH/ ∪/ ActL/ ∪/ τ/ ,/ 通常/ 用/ μ/ 表示/ 进程/ 动作/ 集/ ./ (/ 2/ )/ 进程/ 变量/ 集/ χ/ ,/ 并/ 以/ X/ ,/ Y/ ,/ Z/ 等/ 表示/ 进程/ 变量/ ;/ 进程/ 常量/ 集/ / ,/ 并/ 以/ A/ ,/ B/ 等/ 表示/ 进程/ 变量/ ./ (/ 3/ )/ 算子/ 符号/ ·/ ,/ +/ ,/ |/ ,/ ‖/ ,/ \/ ,/ // ,/ 分别/ 表示/ 前缀/ 算子/ 、/ 选择/ 算子/ 、/ 并行/ 算子/ 、/ 复合/ 算子/ 、/ 限制/ 算子/ 和/ 隐藏/ 算子/ ./ 定义/ 1/ ./ 无穷/ 名集/ I/ 与/ 伴/ 名集/ O/ 之间/ 的/ 二元关系/ ·/ -/ :/ / →/ / 为/ / a/ ∈/ I/ / a/ -/ ∈/ O/ ,/ / a/ -/ ∈/ O/ / a/ =/ =/ a/ ∈/ I/ ./ 根据/ 定义/ 1/ ,/ 对于/ 集合/ L/ ,/ L/ / / 的/ 伴名/ 集/ 珚/ L/ ,/ 有/ 珚/ L/ =/ {/ μ/ -/ :/ μ/ ∈/ L/ }/ ,/ 为了/ 表示/ 方便/ ,/ 以后/ 我们/ 用/ f/ 表示/ E1/ +/ E2/ →/ / / μ/ E2E2/ →/ / / μ/ E2E1/ |/ E2/ →/ / / μ/ E1/ |/ E2/ ,/ μ/ / LE/ →/ / / μ/ E/ 图/ 1SPA/ 的/ 结构化/ 操作/ 语义/ 二元关系/ ·/ -/ ,/ 对于/ / μ/ ∈/ Act/ 有/ f/ (/ μ/ -/ )/ =/ f/ (/ μ/ )/ ,/ 如果/ μ/ =/ τ/ ,/ 那么/ f/ (/ τ/ )/ =/ τ/ ./ 进程/ 项/ 集合/ / 是/ 如下/ 语法/ 构造/ 的/ 集合/ :/ E/ ∷/ =/ 0/ |/ μ/ ./ E/ |/ E/ +/ E/ |/ E/ |/ E/ |/ E/ \/ L/ |/ E/ \/ IL/ |/ E/ // L/ |/ E/ [/ f/ ]/ |/ χ/ ,/ 其中/ L/ / / ./ 符号/ 0/ 用于/ 表示/ 不/ 做/ 任何/ 动作/ 的/ 空/ 进程/ ;/ μ/ ./ E/ 表示/ 做/ 完/ 动作/ μ/ 后/ 的/ 系统/ 行为/ E/ ;/ E1/ +/ E2/ 表示/ 选择/ E1/ 或者/ E2/ ;/ E1/ |/ E2/ 表示/ 系统/ E1/ 和/ E2/ 之间/ 进行/ 交织/ 并发/ ,/ 并且/ 对/ 互补/ 的/ 输入/ // 输出/ 动作/ 进行/ 同步/ ,/ 将/ 其/ 作为/ 一个/ 内部/ 动作/ τ/ ;/ E/ \/ L/ 执行/ 属于/ E/ 但/ 不/ 属于/ L/ ∪/ 珚/ L/ 集合/ 的/ 动作/ ;/ E/ \/ IL/ 执行/ 属于/ E/ 但/ 不/ 属于/ L/ ∩/ I/ 集合/ 的/ 动作/ ;/ E/ // L/ 将/ E/ 中/ 所有/ 属于/ L/ 的/ 动作/ 转换/ 为/ 内部/ 动作/ τ/ ;/ 如果/ E/ 可以/ 执行/ 动作/ μ/ ,/ 那么/ E/ [/ f/ ]/ 执行/ f/ (/ μ/ )/ ;/ 常量/ χ/ 的/ 定义/ 为/ χ/ =/ defE/ ,/ 也/ 就是/ χ/ 具有/ E/ 的/ 所有/ 功能/ [/ 12/ ]/ ./ SPA/ 除了/ 对/ CCS/ 中/ 的/ 动作/ 集/ L/ 进行/ 高低/ 安全等级/ 划分/ 以外/ ,/ 还/ 引入/ 了/ 两种/ 算子/ :/ 限制/ 算子/ 和/ 隐藏/ 算子/ ./ 限制/ 算子/ E/ \/ L/ 执行/ 属于/ 集合/ {/ E/ -/ L/ ∪/ 珚/ L/ }/ 的/ 动作/ ,/ 带/ 输入/ 限制/ 的/ 算子/ E/ \/ IL/ 执行/ 属于/ 集合/ {/ E/ -/ L/ ∩/ I/ }/ 的/ 动作/ ;/ 隐藏/ 算子/ E/ // L/ 把/ 在/ 集合/ {/ E/ ∪/ L/ }/ 中/ 的/ 动作/ 转换/ 为/ 不/ 可见/ 动作/ τ/ ./ 用/ / (/ E/ )/ 表示/ 进程/ E/ 所有/ 的/ 动作/ 执行/ 迹/ ,/ 那么/ 高/ 安全/ 级/ 进程/ 和/ 低/ 安全/ 级/ 进程/ 分别/ 被/ 定义/ 为/ / H/ =/ def/ {/ E/ ∈/ / |/ / (/ E/ )/ / ActH/ ∪/ {/ τ/ }/ }/ 和/ / L/ =/ def/ {/ E/ ∈/ / |/ / (/ E/ )/ / ActL/ ∪/ {/ τ/ }/ }/ ./ 2.2/ ./ 2SPA/ 的/ 操作/ 语义/ SPA/ 的/ 操作/ 语义/ 模型/ 是/ 标记/ 变迁/ 系统/ 模型/ (/ / ,/ Act/ ,/ →/ )/ ,/ 其中/ 二元关系/ →/ / / ×/ Act/ ×/ / 的/ 结构化/ 操作/ 语义/ [/ 18/ ]/ ,/ 如图/ 1/ 所示/ ./ E/ // L/ →/ / / τ/ E/ // LPage4/ 除了/ 图/ 1/ 中/ 对/ 常用/ 操作/ 算子/ 的/ 描述/ 以外/ ,/ 文献/ [/ 12/ ]/ 还/ 提出/ 了/ 使用/ 并行/ 算子/ 和/ 限制/ 算子/ 来/ 实现/ 复合/ 算子/ 的/ 功能/ ./ 复合/ 算子/ 要求/ 两个/ 系统/ E/ 和/ F/ 通过/ 并行/ 方式/ 构成/ 一个/ 新/ 的/ 复合/ 系统/ ,/ 并/ 同步/ E/ ,/ F/ 之间/ 的/ 互补/ 动作/ ./ 定义/ 2/ ./ 系统/ E/ 和/ F/ 的/ 复合/ 系统/ 为/ 2.2/ ./ 3SPA/ 的/ 迹/ 语义/ 和/ 互/ 模拟/ 语义/ 察/ 动作/ 所/ 组成/ 的/ 一个/ 有限/ 序列/ ./ 迹是/ LTS/ 理论/ 中/ 的/ 重要/ 概念/ ,/ 它/ 是/ 系统/ 中/ 可观/ 定义/ 3/ ./ / E/ ∈/ / ,/ E/ 的/ 迹/ T/ (/ E/ )/ =/ {/ μ/ ∈/ / E/ / μ/ E/ }/ ./ 其中/ μ/ =/ α/ 1/ …/ α/ n/ ∈/ / / E1/ ,/ E2/ ,/ …/ ,/ En/ ∈/ / / E/ / α/ 1E1/ / α/ 2/ …/ / α/ nEn/ ,/ 其中/ En/ =/ E/ ./ E/ / α/ E/ 表示/ E/ (/ →/ τ/ )/ / E1/ →/ α/ E2/ (/ →/ τ/ )/ / E/ ./ (/ →/ τ/ )/ / 表示/ 内部/ 动作/ 序列/ ./ 当/ E/ / μ/ E/ 成立/ ,/ 我们/ 认为/ 系统/ 从/ 状态/ E/ 到达/ 状态/ E/ ,/ 从/ 观察/ 的/ 角度/ 来看/ ,/ 系统/ 从/ 状态/ E/ 到/ 状态/ E/ 所/ 执行/ 的/ 动作/ 轨迹/ 是/ α/ 1/ ,/ α/ 2/ ,/ …/ ,/ α/ n/ ./ 定义/ 4/ ./ / E/ ,/ F/ ∈/ / ,/ E/ 和/ F/ 迹/ 等价/ 当且/ 仅/ 当/ T/ (/ E/ )/ =/ T/ (/ F/ )/ ,/ 记为/ E/ ≈/ TF/ ./ 为了/ 能/ 比较/ 迁移/ 系统/ 的/ 中间状态/ ,/ 文献/ [/ 19/ ]/ 提出/ 了/ 互/ 模拟/ 等价/ 的/ 概念/ ./ 互/ 模拟/ 刻画/ 了/ 两个/ 系统/ 之间/ 的/ 单步/ 模拟/ 思想/ ,/ 也就是说/ ,/ 当/ 进程/ E/ 执行/ 一个/ 动作/ 到达/ E/ 后/ ,/ 进程/ F/ 也/ 必须/ 能够/ 通过/ 执行/ 同样/ 的/ 动作/ 到达/ F/ ,/ 进而/ 模拟/ E/ 所/ 完成/ 的/ 单步/ 过程/ ,/ 进程/ E/ 和/ F/ 继续/ 重复/ 进行/ 接下来/ 的/ 单步/ 过程/ ./ 定义/ 5/ ./ 二元关系/ R/ / / ×/ / 是/ 弱互/ 模拟/ ,/ 如果/ (/ E/ ,/ F/ )/ ∈/ R/ ,/ / μ/ ∈/ Act/ / (/ 1/ )/ 无论/ 何时/ E/ →/ / / μ/ E/ ,/ 都/ 存在/ F/ ∈/ / 使得/ F/ / μ/ ^/ F/ 和/ (/ E/ ,/ F/ )/ ∈/ R/ 成立/ ./ (/ 2/ )/ 无论/ 何时/ F/ →/ / / μ/ F/ ,/ 都/ 存在/ E/ ∈/ / 使得/ E/ / μ/ ^/ E/ 和/ (/ E/ ,/ F/ )/ ∈/ R/ 成立/ ./ 两个/ 进程/ 项/ E/ ,/ F/ ∈/ / 的/ 观察/ 等价/ 记为/ E/ ≈/ BF/ ,/ 如果/ 存在/ 着/ 一个/ 包含/ (/ E/ ,/ F/ )/ 的/ 弱互/ 模拟/ 二元关系/ R/ ./ 3/ 信任/ 链/ 规范/ 安全性/ 分析/ 3.1/ 可/ 复合/ 的/ 不可/ 演绎/ 安全/ 性质/ 复合/ 安全/ 性质/ 是/ 构成/ 复合/ 系统安全/ 理论/ 的/ 基础/ ,/ 可/ 复合/ 安全性/ 是/ McCullough/ 在/ 分析/ 复合/ 系统/ 安全性/ 时/ 引入/ 的/ 一个/ 概念/ [/ 20/ ]/ ./ 可/ 复合性/ 是/ 安全/ 性质/ 的/ 重要/ 特性/ ,/ 所谓/ 一种/ 安全/ 性质/ Φ/ 是/ 可/ 复合/ 的/ ,/ 是/ 指/ 两个/ 或/ 多个/ 满足/ 性质/ Φ/ 的/ 进程/ ,/ 通过/ 复合/ 算子/ 构成/ 的/ 复合/ 进程/ P/ 时/ ,/ 这个/ 复合/ 进程/ P/ 仍/ 满足/ Φ/ ./ 在/ 对/ 不可/ 演绎/ 模型/ 进行/ 形式化/ 描述/ 之前/ ,/ 我们/ 先/ 给出/ 相关/ 的/ 符号/ 说明/ :/ α/ i/ ∈/ ActH/ ∩/ I/ / / j/ :/ i/ =/ k/ γ/ ,/ γ/ (/ j/ )/ ./ T/ :/ 系统/ 的/ 执行/ 序列/ ./ V/ :/ 系统/ 执行/ 序列/ t/ ,/ t/ ∈/ T/ 后/ 的/ 值/ ./ f/ :/ T/ →/ V/ :/ 从/ 执行/ 序列/ T/ 到值/ V/ 的/ 信息/ 函数/ ,/ 表示/ 系统/ 当前/ 视图/ ,/ 或者/ 是/ 一组/ 值/ 或/ 变量/ ./ Image/ (/ f/ )/ :/ 所有/ 执行/ 序列/ 的/ 视图/ 集合/ ,/ 即/ / t/ ∈/ T/ ,/ f/ (/ t/ )/ ∈/ Image/ (/ f/ )/ ./ 定义/ 6/ ./ 令/ γ/ ,/ γ/ ∈/ (/ / )/ / 是/ 两个/ 迹/ ,/ γ/ 是/ γ/ 的/ 一个/ 子/ 序列/ (/ 用/ γ/ / γ/ 表示/ )/ 当且/ 仅/ 当/ γ/ 和/ γ/ 满足/ 关系/ :/ γ/ =/ α/ 1/ …/ α/ n/ ,/ γ/ =/ α/ k/ γ/ ,/ γ/ (/ 1/ )/ …/ α/ k/ γ/ ,/ γ/ (/ m/ )/ ,/ 其中/ m/ / n/ ,/ k/ γ/ ,/ γ/ :/ [/ 1/ ,/ m/ ]/ →/ [/ 1/ ,/ n/ ]/ 是/ 一个/ 单调/ 递增/ 函数/ ,/ α/ i/ ∈/ γ/ 表示/ α/ i/ 出现/ 在/ 序列/ γ/ 中/ ./ 定义/ 7/ ./ 视图/ 函数/ low/ ,/ highinput/ ,/ lowinput/ ,/ input/ 分别/ 被/ 定义/ 为/ (/ 1/ )/ low/ :/ / 那么/ 有/ γ/ =/ low/ (/ γ/ )/ ,/ γ/ / γ/ ,/ 如果/ / α/ i/ ∈/ γ/ ,/ α/ i/ ∈/ (/ 2/ )/ highinput/ :/ / 那么/ 有/ γ/ =/ highinput/ (/ γ/ )/ ,/ γ/ / γ/ ,/ 如果/ / α/ i/ ∈/ γ/ ,/ (/ 3/ )/ lowinput/ :/ / 那么/ 有/ γ/ =/ lowinput/ (/ γ/ )/ ,/ γ/ / γ/ ,/ 如果/ / α/ i/ ∈/ γ/ ,/ (/ 4/ )/ input/ :/ / 那么/ 有/ γ/ =/ input/ (/ γ/ )/ ,/ γ/ / γ/ ,/ 如果/ / α/ i/ ∈/ γ/ ,/ α/ i/ ∈/ I/ / / j/ :/ i/ =/ k/ γ/ ,/ γ/ (/ j/ )/ ./ low/ 得到/ 动作/ 序列/ 中/ 的/ 所有/ 低/ 安全/ 级/ 动作/ ,/ highinput/ 得到/ 动作/ 序列/ 中/ 的/ 高/ 安全/ 级/ 输入/ 动作/ ,/ lowinput/ 得到/ 动作/ 序列/ 中/ 的/ 低/ 安全/ 级/ 输入/ 动作/ ,/ input/ 得到/ 动作/ 序列/ 中/ 的/ 所有/ 输入/ 动作/ ./ 定义/ 8/ ./ 令/ f1/ 和/ f2/ 是/ 两个/ 信息/ 函数/ 且/ / w/ ∈/ Image/ (/ f2/ )/ ./ 对于/ 视图/ w/ 而言/ ,/ 信息/ 从/ f1/ 流向/ f2/ 当且/ 仅/ 当/ / v/ ∈/ Image/ (/ f1/ )/ ,/ / t/ ∈/ T/ ,/ f1/ (/ t/ )/ =/ v/ / f2/ (/ t/ )/ ≠/ w/ ./ 定义/ 8/ 假定/ 了/ f1/ 和/ f2/ 分别/ 对应/ 着/ 高/ 安全/ 级/ 进程/ 和/ 低/ 安全/ 级/ 进程/ ,/ 如果/ 存在/ 从/ f1/ 和/ f2/ 的/ 信息流/ ,/ 那么/ 对于/ 系统/ 中/ 的/ 任意/ 迹/ t/ 来说/ ,/ 即使/ 曾/ 有/ w/ ∈/ Image/ (/ f2/ )/ ,/ 但/ 由于/ 低/ 安全/ 级/ 进程/ f2/ 的/ 当前/ 视图/ 已经/ 被/ 高/ 安全/ 级/ 进程/ f1/ 所/ 影响/ ,/ 因此/ 导致/ 了/ f2/ (/ t/ )/ ≠/ w/ ./ 定义/ 8/ 的/ 另外/ 一层/ 含义/ 是/ :/ 如果/ 信息/ 从/ f1/ 流向/ 了/ ActL/ / / j/ :/ i/ =/ k/ γ/ ,/ γ/ (/ j/ )/ ./ α/ i/ ∈/ ActL/ ∩/ I/ / / j/ :/ i/ =/ k/ γ/ ,/ γ/ (/ j/ )/ ./ Page5f2/ ,/ 说明/ 了/ f1/ 的/ 输入/ 影响/ 了/ f2/ 的/ 输出/ ,/ 那么/ 就/ 认为/ f2/ 能够/ 演绎出/ f1/ 的/ 输入/ ./ 那么/ 在/ 什么/ 情况/ 下/ f2/ 不能/ 演绎出/ f1/ 的/ 输入/ 呢/ ?/ 我们/ 给出/ 如下/ 定义/ ./ 定义/ 9/ ./ 给定/ T/ ,/ f1/ 和/ f2/ ,/ 信息/ 没有/ 从/ f1/ 流向/ f2/ 当且/ 仅/ 当/ 联合/ 函数/ (/ f1/ ,/ f2/ )/ 与/ 视图/ 积/ Image/ (/ f1/ )/ ×/ Image/ (/ f2/ )/ 之间/ 满足/ 映成/ 关系/ (/ ontofunction/ )/ ./ 这里/ 的/ 映成/ 关系/ 指/ (/ f1/ ,/ f2/ )/ 与/ Image/ (/ f1/ )/ ×/ Image/ (/ f2/ )/ 满足/ 一一/ 映射/ ./ 换句话说/ ,/ 如果/ 对于/ 每/ 一个/ γ/ ∈/ Act/ / L/ ,/ 都/ 存在/ 着迹/ t/ ∈/ T/ (/ E/ )/ 使得/ γ/ =/ low/ (/ t/ )/ ,/ 并且/ 对于/ 每/ 一个/ γ/ ∈/ (/ ActH/ ∩/ I/ )/ / ,/ 也/ 都/ 存在/ 着迹/ t/ ∈/ T/ (/ E/ )/ 使得/ γ/ =/ highinput/ (/ t/ )/ ,/ 那么/ 一定/ 存在/ 着/ 一条/ 迹/ t/ ,/ 其低/ 安全/ 级/ 视图/ 是/ γ/ ,/ 高/ 安全/ 级/ 视图/ 是/ γ/ ./ 输入/ 不可/ 演绎/ 模型/ 源自/ Sutherland/ 提出/ 的/ 信息流/ 安全/ 理论/ [/ 16/ ]/ ./ 根据/ 输入/ 不可/ 演绎/ 模型/ ,/ 所谓/ 不/ 存在/ 信息流/ ,/ 意味着/ 从/ 进程/ 行为/ 的/ 低级/ 观察/ 中/ ,/ 不能/ 演绎/ 地/ 推导/ 出/ 关于/ 进程/ 高级/ 行为/ 的/ 任何/ 性质/ ,/ 或者说/ 进程/ E/ 具有/ 不可/ 演绎/ 性质/ ,/ 如果/ 进程/ 的/ 任何/ 低级/ 可/ 观察/ 行为/ low/ 都/ 不能/ 推导/ 出/ 高级/ 输入/ highinput/ 的/ 任何/ 信息/ ./ 前面/ 我们/ 对/ 输入/ 不可/ 演绎/ 模型/ 进行/ 了/ 定义/ ,/ 下面/ 我们/ 用/ SPA/ 给出/ 可/ 复合/ 的/ 不可/ 演绎/ 性质/ 的/ 定义/ ./ 定义/ 10/ ./ 安全/ 性质/ Φ/ 是/ 可/ 复合/ 的/ ,/ 如果/ P/ ,/ 定义/ 11/ ./ 令/ H/ / ActH/ ,/ E/ ∈/ / ,/ 那么/ E/ 具有/ 可/ 复合/ 的/ 不可/ 演绎/ 性质/ 当且/ 仅/ 当/ / Π/ ∈/ / H/ / lowviews/ (/ E/ )/ =/ lowviews/ (/ (/ E/ |/ Π/ )/ \/ H/ )/ ,/ 这里/ 的/ lowviews/ (/ )/ 函数/ 是/ low/ (/ )/ 函数/ 的/ 幂集/ :/ lowviews/ (/ E/ )/ =/ def/ {/ γ/ ∈/ Act/ / L/ |/ / γ/ ∈/ T/ (/ E/ )/ }/ ./ 3.2/ 信任/ 链/ 规范/ 说明/ 我们/ 在/ 文献/ [/ 9/ ]/ 中/ 提出/ 了/ 可信计算/ PC/ 规范/ 说明/ 模型/ ,/ 将/ 可信计算/ 平台/ 抽象/ 为/ TPM/ 、/ RTM/ 和/ System3/ 个/ 实体/ 间/ 的/ 交互/ 模型/ ,/ 该/ 模型/ 描述/ 了/ 信任/ 链/ 建立/ 过程/ 中/ 的/ 实体/ 交互/ 关系/ ./ Q/ / Φ/ / P/ ‖/ Q/ / Φ/ ./ a/ _/ SYSTEM/ _/ ACPI/ ./ smiUpdateLogEvent/ ./ CRTM/ +/ a/ _/ RTM/ _/ ACPI/ ./ smiUpdateLogEvent/ ./ CRTM/ 从/ 安全/ 进程/ 代数/ 的/ 角度/ 考虑/ ,/ 为了/ 能够/ 分析/ 信任/ 链/ 建立/ 过程/ 的/ 信息流/ 安全/ ,/ 我们/ 需要/ 进一步/ 对/ 实体/ 的/ 交互/ 关系/ 进行/ 细化/ ,/ 定义出/ 实体/ 间/ 的/ 输入/ 和/ 输出/ ,/ 从/ 安全/ 的/ 角度/ 对/ 这些/ 输入输出/ 进行/ 等级/ 划分/ ,/ 验证/ 信任/ 链/ 系统/ 所/ 符合/ 的/ 安全/ 属性/ ./ 可信计算/ PC/ 规范/ 给出/ 了/ 静态/ 可信度/ 量根/ (/ SRTM/ )/ 的/ 实现/ 流程/ 和/ 方法/ ,/ 图/ 2/ 刻画/ 了/ SRTM/ 运行/ 期间/ 3/ 个/ 进程/ 间/ 的/ 输入/ 和/ 输出/ ./ 其中/ System/ 包括/ 了/ OptionROMs/ 、/ IPL/ 和/ GRUB/ ./ System/ 通过/ RTM/ 所/ 提供/ 的/ BIOS/ 服务/ 接口/ 对/ TPM/ 进行/ 访问/ 请求/ ;/ RTM/ 包含/ 了/ 3/ 种/ 访问/ TPM/ 的/ 方式/ :/ 应用层/ 驱动/ 、/ TPM/ -/ MA/ 驱动/ 和/ TPM/ -/ MP/ 驱动/ ,/ RTM/ 会/ 自动/ 把/ 来自/ System/ 的/ 应用层/ 驱动/ 请求/ 转换/ 为/ TPM/ -/ MP/ 驱动/ 方式/ 发送给/ TPM/ ,/ TPM/ -/ MA/ 驱动/ 通过/ BBB/ (/ BIOSBootBlock/ )/ 通道/ 与/ TPM/ 进行/ 通信/ ,/ TPM/ -/ MP/ 驱动/ 通过/ SMM/ (/ SystemManagementMode/ )/ 通道/ 与/ TPM/ 进行/ 通信/ ./ 图/ 2/ 给出/ 了/ 这些/ 输入输出/ 接口/ 的/ 函数/ ,/ 可以/ 看出/ ,/ TPM/ -/ MA/ 驱动/ 不/ 对外/ 提供/ 任何/ 服务/ ,/ 仅/ 完成/ CRTM/ 阶段/ 的/ 完整性/ 度量/ ,/ 而/ TPM/ -/ MP/ 驱动/ 则/ 更/ 多/ 地/ 处理/ 来自/ 内部/ 或/ 外部/ 的/ 访问/ 请求/ ./ 下面/ 我们/ 用/ SPA/ 语法/ 对/ 这/ 3/ 个/ 进程/ 实体/ 做/ 进一步/ 说明/ ./ 首先/ ,/ 为了/ 精确/ 刻画/ 文献/ [/ 9/ ]/ 中/ 对/ TPM/ 、/ RTM/ 和/ System3/ 个/ 实体/ 间/ 的/ 交互/ 关系/ ,/ 我们/ 需要/ 细化/ 信任/ 链/ 规范/ 说明/ 中/ 3/ 个/ 实体/ 交互/ 时/ 的/ 输入输出/ ./ 定义/ 12/ ./ 令/ SRTM/ 表示/ 信任/ 链/ 规范/ 说明/ ,/ 则/ SRTM/ / (/ System/ |/ RTM/ |/ TPM/ )/ \/ Sy/ ,/ 其中/ 限制/ 集合/ Sy/ 用于/ 实体/ 间/ 的/ 动作/ 同步/ ./ SRTM/ 主要/ 包含/ 了/ 迭代/ (/ extend/ )/ PCR/ 、/ 度量/ (/ read/ )/ 内存/ 代码/ 、/ 建立/ (/ log/ )/ 度量/ 日志/ 和/ 执行/ (/ call/ )/ 被/ 度量/ 代码/ 等/ 操作/ ,/ 这里/ ,/ 我们/ 把/ read/ 、/ extend/ 、/ call/ 和/ log/ 动作/ 分别/ 定义/ 为读/ (/ r/ )/ 、/ 写/ (/ w/ )/ 、/ 执行/ (/ e/ )/ 和/ 追加/ (/ a/ )/ 操作/ ,/ 并/ 将/ 图/ 2/ 中/ 的/ 接口函数/ 进行/ 归纳/ ,/ 那么/ 可以/ 得到/ 如下/ 描述/ :/ Page6System/ 中/ 的/ 动作/ a/ _/ System/ _/ ACPI/ 和/ tcg/ _/ PassThroughToTPM/ 分别/ 表示/ 创建/ 度量/ 日志/ 请求/ 和/ 应用层/ 访问/ TPM/ 请求/ ;/ RTM/ 中/ 的/ 动作/ ma/ _/ HashAllExtendTPM/ 和/ mp/ _/ TPMTransmit/ 表示/ BIOS/ 层/ 访问/ TPM/ 请求/ ;/ 对于/ 前面/ System/ 和/ RTM/ 的/ 输出/ 动作/ ,/ TPM/ 对应/ 的/ 有/ 3/ 个/ 同步/ 动作/ :/ ma/ _/ HashAllExtendTPM/ ./ w/ _/ PCR/ ./ TPM/ 、/ mp/ _/ TPMTransmit/ ./ w/ _/ PCR/ ./ TPM/ 和/ tcg/ _/ PassThroughToTPM/ ./ w/ _/ PCR/ ./ TPM/ ./ 其余/ 同步/ 动作/ 用于/ 保证/ 代码/ 和/ 数据/ 的/ 完整性/ ,/ 防范/ TOCT/ -/ TOU/ 攻击/ [/ 21/ ]/ ./ 图/ 2/ 可信计算/ 平台/ 规范/ 说明/ 输入输出/ 接口/ 3.3/ 安全性/ 分析/ 我们/ 在/ 文献/ [/ 9/ ]/ 中/ 刻画出/ 了/ 信任/ 链/ 交互/ 模型/ ,/ 其中/ RTM/ 与/ TPM/ 组成/ TBB/ ,/ RTM/ 与/ TPM/ 之间/ 通过/ 位于/ 高端/ 内存/ 的/ 两个/ 驱动程序/ 进行/ 通信/ ,/ 其/ 动作/ 对于/ System/ 来说/ 是/ 不/ 可见/ 的/ ./ 我们/ 再/ 对/ RTM/ 做/ 进一步/ 细化/ ,/ RTM/ 被/ 划分/ 为/ CRTM/ 和/ POSTBIOS/ ,/ CRTM/ 与/ POSTBIOS/ 在/ RTM/ 内部/ 进行/ 复合/ ,/ 其/ 内部/ 动作/ 对于/ TPM/ 和/ System/ 来说/ 也/ 是/ 不/ 可见/ 的/ ./ 并且/ 我们/ 认为/ RTM/ 和/ TPM/ 是/ 绝对/ 可信/ 的/ ,/ 所有/ 的/ 动作/ 都/ 属于/ 高/ 安全/ 级/ 动作/ ./ 另一方面/ ,/ RTM/ 与/ TPM/ 组成/ 的/ TBB/ 需要/ 再次/ 与/ System/ 进行/ 复合/ ,/ 由于/ Page7System/ 中/ 的/ 所有/ 组件/ 的/ 安全级别/ 都/ 要/ 比/ TBB/ 低/ ,/ 因此/ System/ 中/ 的/ 所有/ 动作/ 都/ 属于/ 低/ 安全/ 级/ 动作/ ,/ 这里/ 我们/ 考虑/ 的/ 问题/ 是/ :/ System/ 能够/ 观察/ 出/ TBB/ 中/ 的/ 高/ 安全/ 级/ 动作/ 或者/ 输出/ 策略/ 吗/ ?/ 在/ 分析/ 该/ 问题/ 之前/ ,/ 我们/ 先/ 给出/ 相关/ 的/ 符号/ 定义/ ./ i/ :/ 系统/ E/ 的/ 外部/ 输入/ 序列/ ;/ inEoutEcm/ :/ 系统/ E/ 的/ 指令/ 输入/ 序列/ ;/ m/ :/ 系统/ E/ 的/ 指令/ 输出/ 序列/ ./ c/ -/ dn/ :/ 系统/ E/ 的/ 数据/ 输入/ 序列/ ;/ 珚/ dn/ :/ 系统/ E/ 的/ 数据/ 输出/ 序列/ ./ sy/ :/ 系统/ E/ 的/ 同步/ 输入/ 序列/ ;/ y/ :/ 系统/ E/ 的/ 同步/ 输出/ 序列/ ./ s/ -/ rk/ :/ 系统/ E/ 的/ 结果/ 输入/ 序列/ ;/ k/ :/ 系统/ E/ 的/ 结果/ 输出/ 序列/ ./ r/ -/ 这里/ 的/ 外部/ 输入/ 和/ 外部/ 输出/ 序列/ 是/ 指/ 系统/ 通过/ 吸收/ 外部/ 激励/ 动作/ 或/ 事件/ 而/ 产生/ 的/ 外部/ 输出/ 动作/ 或/ 事件/ ./ 对于/ 信任/ 链/ 复合/ 模型/ 而言/ ,/ System/ 以/ 触发/ 相关/ 动作/ 与/ TBB/ 进行/ 通信/ 而/ 完成/ 某种/ 功能/ ,/ 如/ IPL/ 通过/ RTM/ 来/ 访问/ TPM/ ,/ 进而/ 完成/ 对/ GRUB/ 的/ 完整性/ 度量/ 和/ 完整性/ 存储/ ./ 因此/ IPL/ 的/ 输入/ 事件/ 对于/ RTM/ 来说/ 就是/ 一种/ 外部/ 激励/ 输入/ ,/ 经过/ 内部/ 对/ 该/ 输入/ 动作/ 的/ 处理/ ,/ RTM/ 完成/ 与/ TPM/ 之间/ 的/ 内部/ 同步/ 并/ 将/ 结果/ 作为/ 外部/ 输出/ 返还/ 给/ IPL/ ./ 下面/ 我们/ 对/ CRTM/ 与/ TPM/ 的/ 复合/ 、/ POST/ -/ BIOS/ 与/ TPM/ 的/ 复合/ 、/ System/ 与/ TBB/ 的/ 复合/ 分别/ 进行/ 讨论/ ./ 3.3/ ./ 1CRTM/ 与/ TPM/ 的/ 复合/ 在/ 信任/ 链/ 建立/ 初期/ ,/ CRTM/ 需要/ 通过/ TPM/ -/ MA/ 驱动/ 对/ POSTBIOS/ 进行/ 完整性/ 度量/ 和/ 完整性/ 存储/ ,/ 为了/ 方便/ 表示/ ,/ 这里/ 我们/ 用/ inCRTM/ 别/ 表示/ 完整性/ 度量/ 输入/ 和/ 输出/ ,/ inCRTM/ 表示/ 完整性/ 存储/ 输入/ 和/ 输出/ ,/ 它们/ 都/ 是/ CRTM/ 对外/ 所/ 呈现/ 的/ 视图/ ;/ c0/ ,/ c/ -/ 图/ 4CRTM/ 与/ TPM/ 的/ LTS/ 系统/ 3.3/ ./ 2POSTBIOS/ 与/ TPM/ 的/ 复合/ 当/ CRTM/ 对/ POSTBIOS/ 度量/ 完毕/ 后/ ,/ POST/ -/ BIOS/ 需要/ 对/ System/ 的/ 第一个/ 启动/ 组件/ 进行/ 完整性/ 度量/ 和/ 完整性/ 存储/ ./ 这里/ 的/ 符号/ 描述/ 和/ SPA/ 描述/ 数据/ 序列/ ;/ sy/ ,/ s/ -/ 号/ ,/ 对于/ 实际/ 的/ 信任/ 链/ 系统/ 而言/ 同步/ 信号/ 通常/ 是/ 硬件/ 总线/ ;/ 符号/ r0/ ,/ r/ -/ 整性/ 度量/ 结果/ 和/ 完整性/ 存储/ 结果/ ./ 我们/ 在/ 前面/ 已经/ 说明/ 了/ CRTM/ 和/ TPM/ 中/ 的/ 所有/ 动作/ 都/ 属于/ 高/ 安全/ 级/ 动作/ ,/ 因此/ 当/ CRTM/ 与/ TPM/ 进行/ 复合/ 之后/ ,/ 需要/ 同步/ 的/ 高/ 安全/ 级/ 动作/ 统统/ 都/ 转换/ 为/ 内部/ 动作/ τ/ ,/ 该/ 动作/ 和/ 高/ 安全/ 级/ 动作/ 对于/ 低/ 安全/ 级/ 视图/ 是/ 不/ 可见/ 的/ ./ CRTM/ 与/ TPM/ 的/ 复合/ 模型/ 如图/ 3/ 所示/ ./ 用/ SPA/ 进行/ 描述/ 的/ CRTM/ 与/ TPM/ 复合/ 系统/ 的/ SPA/ 表示/ 如下/ 所示/ :/ 经过/ 复合/ 算子/ 操作/ 后/ 的/ 系统/ 如图/ 4/ 所示/ ,/ 为了/ 图形/ 显示/ 方便/ ,/ 我们/ 只/ 选取/ 了/ 并发/ 系统/ 中/ 的/ 一条/ 分支/ ,/ 可以/ 看出/ ,/ 该/ 分支/ 中/ 含有/ 3/ 个/ 内部/ 动作/ τ/ 和/ 两个/ 高/ 安全/ 级/ 动作/ inCRTM/ 与/ 上/ 一/ 小节/ 基本相同/ ,/ 不再/ 赘述/ ./ 3.3/ ./ 3System/ 与/ TBB/ 的/ 复合/ 从/ 上面/ 两/ 小节/ 可以/ 知道/ ,/ CRTM/ 、/ POSTBIOS/ 和/ TPM/ 所/ 组成/ 的/ TBB/ 中/ 所有/ 的/ 输入输出/ 动/ Page8/ 作/ 都/ 是/ 高/ 安全/ 级/ 动作/ ./ 那么/ 对于/ 动作/ 序列/ inCRTM0/ ./ τ/ ./ τ/ ./ τ/ ./ outCRTM/ 说/ ,/ 由于/ inCRTM/ 安全/ 级/ 输入/ // 输出/ 对/ 高/ 安全/ 级/ 动作/ 的/ 依赖/ ,/ 因此/ 复合/ 系统/ CRTM/ _/ TPM/ 、/ POST/ _/ TPM/ 都/ 满足/ NDI/ 和/ NDS/ 安全/ 属性/ ./ 那么/ 满足/ NDI/ 和/ NDS/ 安全/ 性质/ 的/ TBB/ 与/ System/ 复合/ 之后/ 是否/ 仍然/ 满足/ NDI/ 和/ NDS/ 安全/ 图/ 5System/ 与/ TBB/ 的/ 复合/ 这里/ 我们/ 将/ 同步/ 动作/ 集/ Sy/ 仅/ 包含/ 信号/ 同步/ 动作/ {/ sy/ ,/ s/ -/ y/ }/ ,/ 系统/ System/ 与/ TBB/ 进行/ 交互/ 的/ 动作/ 集/ 包括/ 0/ ,/ 珚/ dSystem/ {/ c/ -/ System/ 完整性/ 度量/ 结果/ 序列/ 和/ 完整性/ 存储/ 结果/ 序列/ ./ TBB/ 的/ 输入输出/ 集/ 分别/ 为/ {/ inPOSTBIOSoutPOSTBIOS1/ }/ ,/ 复合/ 系统/ 的/ SPA/ 描述/ 如下/ 所示/ ./ System/ _/ TBB/ =/ def/ (/ System/ ‖/ TBB/ )/ \/ Sy/ ;/ System/ =/ definSystemTBB/ =/ defsy/ ./ inPOSTBIOSSy/ =/ {/ sy/ ,/ s/ -/ 图/ 6System/ 与/ TBB/ 的/ 部分/ LTS/ 系统/ 属性/ 呢/ ?/ 我们/ 先/ 给出/ System/ 与/ TBB/ 的/ 复合/ 模型/ ,/ 如图/ 5/ 所示/ ./ 该/ 模型/ 和/ 上面/ 两个/ 复合/ 模型/ 的/ 不同之处/ 在于/ ,/ 由于/ System/ 中/ 的/ 所有/ 动作/ 都/ 是/ 低/ 安全/ 级/ 动作/ ,/ 因此/ ,/ 当/ System/ 与/ TBB/ 进行/ 复合/ 的/ 时候/ ,/ 完成/ 完整性/ 度量/ 和/ 完整性/ 存储/ 任务/ 的/ 指令/ 输入输出/ 序列/ 、/ 数据/ 输入输出/ 序列/ 和/ 结果/ 输入输出/ 序列/ ,/ 不能/ 简单/ 地/ 将/ 它们/ 视为/ 同步操作/ 而/ 化简/ 为/ 内部/ 动作/ ,/ 因此/ 这里/ 需要/ 对/ 这些/ 序列/ 进行/ 安全/ 视图/ 上/ 的/ 区分/ ./ 0/ ./ TBB/ \/ Sy/ 时/ ,/ 可以/ 选择/ 动作/ outPOSTBIOS0/ ,/ 由于/ 动作/ outSystemActH/ =/ {/ sy/ ,/ inPOSTBIOS/ 若/ 考虑/ 所有/ 的/ 动作/ 集合/ 那么/ 最终/ 的/ LTS/ 系统/ 将/ 异常/ 庞大/ ,/ 根据上述/ 描述/ ,/ 我们/ 只/ 考虑/ 动作/ 集合/ {/ inSystem0/ ,/ outSystem/ 们/ 对/ 变迁/ 系统/ 的/ 片段/ 进行/ 分析/ ,/ 如图/ 6/ 所示/ ./ 可以/ 看出/ ,/ 当/ 系统/ System/ _/ TBB/ 处于/ 状态/ outSystemoutPOSTBIOSoutSystem/ 达/ 状态/ outSystem/ 动作/ r4/ 或者/ inPOSTBIOS/ 全级/ 输入/ ,/ 也/ 就是/ 低/ 安全/ 级/ 输出/ 依赖/ 高/ 安全/ 级/ 输入/ ,/ 因此/ 复合/ 系统/ System/ _/ TBB/ 不再/ 符合/ NDI/ 安全/ 属性/ ,/ 对于/ 实际/ 的/ 信任/ 链/ 系统/ 而言/ ,/ 我们/ 将/ 在/ 3.5/ 节/ 详细/ 说明/ System/ 中/ 的/ 哪些/ 动作/ 依赖于/ TBB/ 中/ 的/ 动作/ ./ Page93/ ./ 4/ 进一步/ 的/ 分析/ 通过/ 3.3/ 节对/ 信任/ 链/ 复合/ 模型/ 的/ 分析/ 得知/ ,/ System/ 与/ TBB/ 的/ 复合/ 系统/ System/ _/ TBB/ 既然/ 不/ 满足/ NDI/ 安全/ 属性/ ,/ 同样/ 也/ 就/ 不/ 满足/ NDS/ 属性/ ./ 那么/ 究竟/ System/ _/ TBB/ 要/ 满足/ 什么样/ 的/ 条件/ 才能/ 达到/ 这一/ 要求/ 呢/ ?/ 定义/ 11/ 对/ 进程/ E/ 的/ 可/ 复合/ 不可/ 演绎/ 性质/ 定义/ 采用/ 的/ 是/ NDC/ 模型/ ,/ 并/ 采用/ 视图/ 对/ 其/ 进行/ 定义/ ./ 接下来/ 我们/ 将/ 使用/ 迹/ 语义/ 和/ 互/ 模拟/ 语义/ 对/ NDC/ 进行/ 了/ 定义/ ,/ 通过/ 语义/ 表示/ 上/ 的/ 差别/ 对/ NDC/ 进行/ 安全/ 属性/ 上/ 的/ 提升/ ./ 我们/ 先/ 给出/ 迹/ 语义/ 下/ 可/ 复合/ 的/ 不可/ 演绎/ NDC/ 安全/ 属性/ 的/ 定义/ ./ 定义/ 13/ ./ E/ ∈/ / ,/ E/ 满足/ NDC/ 性质/ ,/ 如果/ / Π/ ∈/ / H/ ,/ E/ // ActH/ ≈/ T/ (/ (/ E/ |/ Π/ )/ \/ H/ )/ // ActH/ ./ Focardi/ 在/ 文献/ [/ 12/ ]/ 中/ 认为/ NDC/ 安全/ 属性/ 和/ NDS/ 安全/ 属性/ 是/ 等价/ 的/ ,/ 并用/ 互/ 模拟/ 语义/ 对/ NDC/ 安全/ 属性/ 进行/ 了/ 定义/ ./ 因为/ 对于/ 存在/ 死锁/ 的/ 系统/ 而言/ ,/ 基于/ 迹/ 语义/ 的/ 安全/ 属性/ 不能/ 检测/ 死锁/ 的/ 发生/ ,/ 譬如/ 高/ 安全/ 级/ 进程/ 拒绝/ 进行/ 同步/ 而/ 导致/ 的/ 死锁/ ,/ 那么/ 低/ 安全/ 级/ 进程/ 可以/ 通过/ 有效/ 的/ 尝试/ 去/ 探测/ 高/ 安全/ 级/ 进程/ 的/ 行为/ ,/ 即/ 输入/ 和/ 输出/ ./ 因此/ ,/ 我们/ 需要/ 借助/ CCS/ 中/ 的/ 弱互/ 模拟/ 语义/ [/ 19/ ]/ 解决/ 该/ 问题/ ,/ 基于/ 互/ 模拟/ 语义/ 的/ NDC/ 安全/ 属性/ 表示/ 如下/ ./ 定义/ 14/ ./ E/ ∈/ / ,/ E/ 满足/ BNDC/ 性质/ ,/ 如果/ / Π/ ∈/ / H/ ,/ E/ ∈/ BNDC/ / E/ // ActH/ ≈/ B/ (/ E/ |/ Π/ )/ \/ ActH/ ./ 接下来/ ,/ 我们/ 将/ 使用/ 定义/ 14/ 所/ 定义/ 的/ BNDC/ 性质/ 刻画/ 信任/ 链中/ TPM/ 、/ RTM/ 和/ System/ 之间/ 的/ 关系/ ,/ 并/ 论证/ 在/ 何种/ 情况/ 下/ 这/ 三者/ 组成/ 的/ 复合/ 系统/ 才能/ 满足/ BNDC/ 安全/ 属性/ ,/ 即/ 复合/ 系统/ 中/ 不/ 存在/ 非法/ 信息流/ ./ 命题/ 1/ ./ 令/ TBB/ / (/ RTM/ |/ TPM/ )/ \/ Sy/ ,/ 其中/ Sy/ / (/ f/ (/ ActRTMH/ )/ ,/ 那么/ TBB/ ∈/ BNDC/ ./ ActRTM/ 证明/ ./ 根据/ TBB/ 的/ 定义/ 可知/ ,/ RTM/ 和/ TPM/ 中/ 的/ 所有/ 动作/ 都/ 是/ 高/ 安全/ 级/ 动作/ ,/ 又/ 根据/ 定义/ 1/ ,/ 有/ f/ (/ ActRTMSy/ / (/ f/ (/ ActRTM/ 可以/ 化简/ 为/ Sy/ / ActTPMTPM/ )/ \/ Sy/ 把/ RTM/ 和/ TPM/ 的/ 所有/ 接口/ 动作/ 都/ 转化/ 为/ 内部/ 动作/ τ/ ,/ 令/ 余下/ 的/ 所有/ 高/ 安全/ 级/ 动作/ 集合/ 为/ ActRTM/ _/ TPMH/ ./ 令/ E/ =/ TBB/ ,/ 显然/ / E/ ,/ E/ ,/ μ/ ∈/ / H/ ,/ E/ →/ / / μ/ E/ ,/ E/ →/ / / hE/ ,/ 其中/ μ/ 属于/ 集合/ H/ ,/ 那么/ E/ \/ ActRTM/ _/ TPMActRTM/ _/ TPMActRTM/ _/ TPM/ 消去/ 动作/ 集合/ ActRTM/ _/ TPMActH/ ≈/ BE/ \/ ActH/ 成立/ ./ 综上所述/ ,/ 命题/ 成立/ ./ 命题/ 2/ ./ 令/ SRTM/ / (/ TPM/ |/ RTM/ |/ System/ )/ \/ Sy/ ,/ 其中/ Sy/ / (/ f/ (/ ActRTM/ _/ TPM/ (/ f/ (/ ActSystem/ 证明/ ./ 设/ SRTM/ →/ / / μ/ SRTM/ ,/ SRTM/ →/ / / hH/ ∪/ ActSystem/ 又/ ActH/ =/ ActRTM/ ,/ TPMSRTM/ ,/ 那么/ 有/ μ/ / ActRTM/ ,/ TPMActRTM/ ,/ TPMActH/ ,/ 因此/ 有/ SRTM/ \/ Sy/ =/ (/ SRTM/ \/ Sy/ )/ \/ ActH/ ,/ 只/ 需/ 证明/ SRTM/ \/ Sy/ ≈/ BSRTM/ \/ Sy/ ./ 若/ h/ / Sy/ ,/ 则/ SRTM/ =/ SRTM/ ,/ 命题/ 显然/ 成立/ ./ 若/ h/ / Sy/ ,/ 根据/ 定义/ 3/ 有/ T/ (/ SRTM/ )/ =/ T/ (/ SRTM/ )/ ,/ 根据/ 定义/ 5/ ,/ 显然/ 有/ SRTM/ ≈/ BSRTM/ ,/ 而/ (/ SRTM/ \/ Sy/ )/ / SRTM/ ,/ (/ SRTM/ \/ Sy/ )/ / SRTM/ ,/ 因此/ SRTM/ \/ Sy/ ≈/ BSRTM/ \/ Sy/ ./ 综上所述/ ,/ 命题/ 成立/ ./ 命题/ 1/ 和/ 命题/ 2/ 说明/ 了/ 如果/ 复合/ 系统/ 的/ ActH/ 集合/ 中/ 的/ 元素/ 对偶/ 和/ Sy/ 集合/ 的/ 所有/ 元素/ 存在/ 着/ 双射/ 关系/ ,/ 也/ 就是/ 一一/ 映射/ ,/ 那么/ E/ 一定/ 满足/ BNDC/ 安全/ 性质/ ,/ 这/ 意味着/ 从/ 低级/ 观察/ 中/ 得不到/ 任何/ 高级/ 活动/ 的/ 信息/ ,/ 这/ 与/ Sutherland/ 提出/ 的/ 映成/ 函数/ 的/ 观点/ 是/ 等价/ 的/ ./ 3.5/ 实例/ 分析/ 下面/ 我们/ 以/ 信任/ 链接/ 口/ 安全/ 模型/ 为/ 依据/ ,/ 以/ TCG/ 的/ 可信/ PC/ 信任/ 链/ 规范/ 为/ 对象/ ,/ 刻画/ 信任/ 链/ 实体/ 动作/ ,/ 抽象/ 出/ 高低/ 安全/ 级/ 进程/ 的/ 输入/ 和/ 输出/ ,/ 用/ CoPS/ 工具/ 对/ 安全/ 属性/ 进行/ 验证/ ,/ 找出/ 规范/ 中/ 存在/ 的/ 安全/ 缺陷/ ./ 3.5/ ./ 1/ 接口/ 安全等级/ 划分/ 在/ 信任/ 链/ 运行/ 期间/ ,/ RTM/ 和/ TPM/ 通过/ 接口/ 进行/ 了/ 复合/ ,/ 一方面/ ,/ 我们/ 需要/ 发现/ 这种/ 复合/ 是否/ 能够/ 保护/ 高级/ 输入输出/ ,/ 另一方面/ ,/ RTM/ 和/ TPM/ 所/ 组成/ 的/ TBB/ 子系统/ 与/ System/ 又/ 进行/ 了/ 复合/ ,/ 我们/ 需要/ 进一步/ 发现/ 该/ 复合/ 能否/ 满足/ 不可/ 演绎/ 安全性/ ./ 为了/ 能/ 验证/ 这些/ 安全/ 属性/ ,/ 我们/ 给出/ 了/ 限制/ 集合/ Sy/ 和/ 高/ 安全级别/ 动作/ 集合/ acth/ ,/ 如下/ 所示/ ./ Sy/ =/ {/ ma/ _/ HashAllExtendTPM/ ,/ mp/ _/ TPMTransmit/ ,/ a/ _/ RTM/ _/ ACPI/ ,/ e/ _/ POSTBIOS/ ,/ r/ _/ OptionRoms/ ,/ e/ _/ OptionRoms/ ,/ e/ _/ IPL/ }/ ,/ acth/ =/ {/ ma/ _/ HashAllExtendTPM/ ,/ ma/ _/ HashAllExtendTPM/ ,/ mp/ _/ TPMTransmit/ ,/ mp/ _/ TPMTransmit/ ,/ W/ _/ PCR/ ,/ tcg/ _/ PassThroughToTPM/ ,/ smiUpdateLogEvent/ ,/ a/ _/ System/ _/ ACPI/ ,/ r/ _/ POSTBIOS/ ,/ r/ _/ OptionRoms/ ,/ a/ _/ RTM/ _/ ACPI/ ,/ a/ _/ RTM/ _/ ACPI/ ,/ e/ _/ POSTBIOS/ ,/ Page10e/ _/ POSTBIOS/ ,/ e/ _/ OptionRoms/ ,/ e/ _/ OptionRoms/ ,/ r/ _/ IPL/ ,/ e/ _/ IPL/ }/ ./ Sy/ 集合/ 用于/ 同步/ RTM/ 与/ TPM/ 之间/ 的/ 输入输出/ ,/ 可以/ 看出/ 集合/ drv/ =/ {/ ma/ _/ HashAllExtendTPM/ ,/ 也/ 出现/ 在/ acth/ 中/ ,/ 这/ 是因为/ drv/ 中/ 的/ 动作/ 是/ 运行/ 在/ SMM/ 模式/ 下/ ,/ 此时/ CPU/ 是/ 运行/ 在/ 最高/ 特权/ 级/ 上/ ,/ 因此/ 将/ 集合/ drv/ 中/ 的/ 所有/ 元素/ 都/ 视为/ 高/ 安全/ 级/ 动作/ ,/ tcg/ _/ PassThroughToTPM/ 动作/ 是/ TPM/ 响应/ 应用层/ 请求/ 的/ 输入/ 动作/ ,/ 该/ 动作/ 和/ w/ _/ PCR/ 都/ 应/ 视为/ 高/ 安全/ 级/ 动作/ ,/ a/ _/ RTM/ _/ ACPI/ 动作/ 用于/ 创建/ 度量/ 日志/ ,/ 其/ 后续/ 动作/ 是/ smiUpdateLogEvent/ ,/ 这/ 两个/ 动作/ 的/ 运行/ 环境/ 也/ 同样/ 是/ 在/ SMM/ 模式/ 下/ ./ 除此以外/ ,/ 高/ 安全级别/ 动作/ 集合/ acth/ 中/ 还/ 包括/ 了/ r/ _/ POSTBIOS/ ,/ e/ _/ POSTBIOS/ ,/ r/ _/ OptionRoms/ ,/ e/ _/ OptionRoms/ ,/ r/ _/ IPL/ ,/ e/ _/ IPL/ ./ 附录/ 表/ 1/ 对/ 每个/ 动作/ 的/ 含义/ 给出/ 了/ 描述/ ./ 3.5/ ./ 2/ 接口/ 安全/ 测试/ 为了/ 验证/ 可信计算/ PC/ 规范/ 说明/ 的/ SRTM/ 是/ 图/ 7CoPS/ 验证/ 修改/ 前/ 的/ 信任/ 链/ 规范/ 说明/ 图/ 8CoPS/ 验证/ 修改/ 后/ 的/ 信任/ 链/ 规范/ 说明/ 否/ 满足/ BNDC/ ,/ 我们/ 使用/ CoPS/ 对/ 其/ 进行/ 验证/ ,/ CoPS/ 是/ Pivato/ 等/ 人/ 开发/ 的/ 用于/ 自动化/ 验证/ 多级/ 安全/ 属性/ 的/ 工具/ ,/ 用于/ 验证/ 系统/ 是否/ 满足/ P/ _/ BNDC/ 、/ PP/ _/ BNDC/ 或/ SBNDC/ 等/ 安全/ 性质/ [/ 22/ ]/ ./ 将/ 以上/ 用/ SPA/ 描述/ 的/ System/ 、/ RTM/ 和/ TPM/ 的/ 接口函数/ 转化/ 为/ CoPS/ 后/ ,/ 得到/ 的/ 验证/ 结果/ 如图/ 7/ 所示/ ./ 在/ 验证/ 过程/ 中/ 我们/ 发现/ ,/ 根据上述/ 划分/ 的/ SRTM/ 并/ 不/ 满足/ BNDC/ 安全/ 性质/ ,/ 这/ 是因为/ 在/ Sys/ -/ tem/ 中/ 存在/ 着/ 低/ 安全/ 级/ 动作/ 对/ 高/ 安全/ 级/ 动作/ 的/ 依赖/ ,/ 因此/ 低/ 安全/ 级/ 的/ System/ 就/ 可以/ 通过/ 隐式/ 的/ 方法/ 获得/ TBB/ 中/ 的/ 高级/ 输入/ 或者/ 输出/ ;/ 我们/ 可以/ 通过/ 消除/ 这些/ 依赖/ 使得/ 修改/ 后/ 的/ 信任/ 链/ 规范/ 说明/ 满足/ BNDC/ 安全/ 属性/ ,/ 例如/ ,/ 我们/ 将/ 高/ 安全/ 级/ 输出/ 动作/ w/ _/ PCR/ 作为/ 同步/ 动作/ ,/ 那么/ 也/ 就/ 意味着/ 该/ 动作/ 对于/ TPM/ 之外/ 的/ 实体/ 而言/ 是/ 不/ 可见/ 的/ ,/ 因此/ 就/ 消除/ 了/ 低/ 安全/ 级/ 动作/ 与/ w/ _/ PCR/ 之间/ 的/ 关联/ 关系/ ,/ 这样/ 的/ 系统/ 将/ 满足/ 定义/ 14/ 中所/ 描述/ 的/ BNDC/ 性质/ ,/ 如图/ 8/ 所示/ ,/ 同时/ 也/ 证实/ 了/ 命题/ 2/ 的/ 正确性/ ./ 表/ 1/ 给出/ 了/ SRTM/ 中所/ 存在/ 的/ 低/ 安全/ 级/ 动作/ 对/ 高/ 安全/ 级/ 动作/ 的/ 依赖/ ./ Page11/ 命题/ 1/ 和/ 命题/ 2/ 所/ 提出/ 的/ 信任/ 链/ 复合/ 系统/ 是/ 理想/ 情况/ 下/ 的/ 安全/ 系统/ ,/ 实际/ 情况/ 下/ 的/ 规范/ 说明/ 和/ 系统/ 实现/ 很难/ 全部/ 满足/ 这些/ 安全/ 属性/ ,/ 譬如/ ,/ 低级/ 输出/ tcg/ _/ PassThroughToTPM/ 影响/ 着/ 高级/ 输出/ w/ _/ PCR/ ,/ 这/ 说明/ 低级/ 进程/ 可以/ 间接/ 地/ 对/ PCR/ 进行/ 任意/ 迭代/ ;/ 低级/ 输出/ a/ _/ System/ _/ ACPI/ 影响/ 着/ 高级/ 输出/ smiUpdateLogEvent/ ,/ 这/ 表明/ 低级/ 进程/ 能/ 通过/ 高级/ 进程/ 对/ 度量/ 日志/ 进行/ 追加/ 操作/ ,/ 而/ 这些/ 进程/ 动作/ 都/ 是/ 远程/ 证明/ 协议/ 的/ 一部分/ ,/ 可见/ 它们/ 将/ 直接/ 影响/ 其/ 安全性/ ,/ 关于/ 这/ 一点/ 我们/ 将/ 在/ 以后/ 进行/ 讨论/ ./ 4/ 结论/ 信任/ 链/ 是/ 由/ 不同/ 安全/ 属性/ 的/ 子系统/ 组成/ 的/ 复合/ 系统/ ,/ 复合/ 后/ 的/ 高级/ 子系统/ 安全/ 性质/ 应该/ 保持/ ./ 其中/ 的/ 每/ 一个/ 子系统/ 都/ 满足/ 一定/ 的/ 安全/ 性质/ ,/ 这些/ 子系统/ 组合而成/ 的/ 系统/ 是否/ 仍然/ 满足/ 给定/ 的/ 安全/ 性质/ ?/ 另一方面/ ,/ 在/ 信任/ 链/ 建立/ 阶段/ ,/ 各个/ 子系统/ 之间/ 的/ 访问/ 是否/ 存在/ 违反/ 规范/ 约束/ 的/ 行为/ 或/ 操作/ ,/ 进而/ 破坏/ 信任/ 传递/ ,/ 甚至/ 获取/ 机密信息/ ?/ 针对/ 上述/ 问题/ ,/ 本文/ 将/ 信任/ 链/ 抽象/ 为/ 多个/ 实体/ 的/ 进程/ 交互/ 模型/ ,/ 通过/ 接口/ 细化/ 的/ 方式/ 对/ 进程/ 间/ 的/ 高低/ 安全/ 级/ 动作/ 进行/ 描述/ ,/ 并/ 以/ 信任/ 链/ 规范/ 为/ 实例/ ,/ 通过/ 抽取/ 规范/ 中/ 的/ 高低/ 等级/ 输入输出/ ,/ 找出/ 它们/ 之间/ 的/ 关联/ 规则/ ,/ 把/ 对/ 信任/ 链/ 安全/ 属性/ 的/ 验证/ 转换/ 为/ 对/ 表示/ 进程/ 的/ 代数/ 项/ 的/ 语法/ 检查/ 上/ ,/ 我们/ 认为/ 高级/ 进程/ 的/ 动作/ 元素/ 对偶/ 与/ 限制/ 集合/ 满足/ 双射/ 关系/ 是/ 信任/ 链/ 满足/ 复合/ 安全/ 性质/ 的/ 充分条件/ ./ 结合实际/ 规范/ 说明/ ,/ 我们/ 用/ CoPS/ 对/ 提出/ 的/ 安全/ 模型/ 进行/ 了/ 安全/ 验证/ ,/ 发现/ 其中/ 潜在/ 的/ 安全/ 缺陷/ 及其/ 可能/ 造成/ 的/ 影响/ ./ 

