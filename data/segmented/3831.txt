Page1/ 迭代/ 方法/ 中/ 基于/ 渐近/ 规模/ 的/ 通信/ 与/ 计算/ 比/ 分析/ 徐小文莫则/ 尧/ 武林/ 平/ (/ 北京/ 应用/ 物理/ 与/ 计算/ 数学/ 研究所/ 北京/ 100094/ )/ 摘要/ 迭代/ 方法/ 是/ 科学计算/ 中/ 求解/ 大规模/ 稀疏/ 线性代数/ 方程组/ 最/ 常用/ 的/ 方法/ ./ 大量/ 实际/ 应用/ 表明/ ,/ 迭代/ 方法/ 通常/ 具有/ 较/ 高/ 的/ 通信/ 与/ 计算/ 比/ ,/ 只有/ 在/ 粗粒度/ 并行/ 下/ 才能/ 取得/ 较/ 好/ 的/ 并行/ 可扩展性/ 能/ ./ 而/ 实际/ 应用/ 大规模/ 计算/ 的/ 需求/ 和/ 当前/ 多核/ // 众核/ 体系结构/ 的/ 发展趋势/ 要求/ 迭代/ 方法/ 具备/ 细粒度/ 并行/ 可/ 扩展/ 能力/ ./ 文中/ 引入/ 渐近/ 规模/ ,/ 即/ 满足/ 加速/ 条件/ 的/ 计算/ 规模/ 下界/ ,/ 来/ 反映/ 并行/ 迭代/ 方法/ 适应/ 细粒度/ 并行/ 的/ 能力/ ,/ 并/ 由此/ 刻画/ 通信/ 与/ 计算/ 比/ ./ 基于/ 矩阵/ 的/ 稀疏/ 模式/ 及其/ 通信/ 模式/ 、/ 机器/ 的/ 通信/ 参数/ 和/ 迭代/ 方法/ 的/ 基本/ 运算/ ,/ 给出/ 了/ 渐近/ 规模/ 的/ 理论/ 预测/ 公式/ ./ 在/ 一台/ 包含/ 128/ 个/ 双路/ 4/ 核/ 计算/ 节点/ 的/ 并行机/ 上/ ,/ 分别/ 基于/ 纯/ 进程/ 并行/ (/ MPI/ )/ 和/ 进程/ // 线程/ 混合/ 并行/ (/ MPI/ // OpenMP/ )/ ,/ 以/ 实际/ 应用/ 中/ 3/ 种/ 常用/ 迭代/ 方法/ Jacobi/ 、/ CG/ 、/ BiCGSTAB/ 为例/ ,/ 分析/ 其/ 渐近/ 规模/ ./ 并行/ 可扩展性/ 测试表明/ 了/ 渐近/ 规模/ 用于/ 刻画/ 迭代/ 方法/ 通信/ 与/ 计算/ 比/ 的/ 准确性/ ./ 对于/ 纯/ 进程/ 情形/ ,/ 给出/ 了/ 渐近/ 规模/ 的/ 理论/ 预测/ 与/ 实际/ 测试/ 的/ 对比/ ,/ 表明/ 了/ 理论/ 预测/ 结果/ 的/ 正确性/ ./ 最后/ ,/ 基于/ 这些/ 结果/ ,/ 从/ 迭代/ 方法/ 的/ 算法/ 设计/ 和/ 并行/ 实现/ 等/ 方面/ 讨论/ 了/ 面向未来/ 更/ 大规模/ 的/ 计算/ 系统/ ,/ 降低/ 通信/ 与/ 计算/ 比/ 的/ 途径/ ./ 关键词/ 迭代/ 方法/ ;/ 通信/ 与/ 计算/ 比/ ;/ 并行/ 可/ 扩展/ ;/ 渐近/ 规模/ ;/ 多核/ // 众核/ 体系结构/ 1/ 引言/ 在/ 很多/ 数值/ 模拟/ 应用/ 中/ ,/ 需要/ 求解/ 形/ 如/ 犃/ 狓/ =/ 犫/ 的/ 稀疏/ 线性代数/ 方程组/ ,/ 其中/ ,/ 犃/ ∈/ Rn/ ×/ n/ 是/ 稀疏/ 矩阵/ ,/ 犫/ ∈/ Rn/ 是/ 右端/ 向量/ ,/ 狓/ ∈/ Rn/ 为/ 待/ 求解/ 的/ 未知/ 向量/ ./ 求解/ 该类/ 方程/ 的/ 解法/ 器是/ 科学计算/ 领域/ 的/ 核心/ 共性/ 模块/ ,/ 在/ 很多/ 应用/ 中/ 占据/ 大/ 比例/ 的/ 时间/ 开销/ ./ 受/ 舍入/ 误差/ 、/ 内存/ 和/ 计算/ 复杂度/ 的/ 限制/ ,/ 迭代/ 方法/ 是/ 当前/ 大规模/ 数值/ 模拟/ 中/ 求解/ 该类/ 方程/ 的/ 主要/ 方法/ ./ 例如/ ,/ Krylov/ 子/ 空间/ 迭代/ 方法/ [/ 1/ ]/ 是/ 当前/ 实际/ 应用/ 最/ 常用/ 的/ 方法/ 之一/ ./ 迭代/ 方法/ 通常/ 包含/ 稀疏/ 矩阵/ -/ 向量/ 乘积/ (/ SpMV/ )/ 、/ 向量/ 内积/ (/ dot/ )/ 以及/ 向量/ 校正/ (/ axpy/ )/ 等/ 基本/ 运算/ ./ 在/ 负载/ 均衡/ 的/ 前提/ 下/ ,/ 并行/ 效率/ 取决于/ 通信/ 时间/ 与/ 浮点/ 计算/ 时间/ 之比/ ./ SpMV/ 和/ dot/ 分别/ 需要/ 局部/ 点对点/ 通信/ 和/ 全局/ 归约/ 通信/ ,/ 且/ 均/ 属于/ 低密度/ 型/ 计算/ ,/ 从而/ 导致/ 迭代/ 方法/ 的/ 通信/ 与/ 计算/ 比/ 很/ 高/ ./ 大量/ 实际/ 应用/ 表明/ ,/ 只有/ 单核/ 计算/ 规模/ 足够/ 大时/ (/ 粗粒度/ 并行/ )/ ,/ 迭代/ 方法/ 才能/ 取得/ 理想/ 的/ 并行/ 性能/ ./ 然而/ ,/ 一方面/ ,/ 粗粒度/ 并行/ 无法/ 满足/ 实际/ 应用/ 的/ 需求/ ,/ 实际/ 应用/ 希望/ 在/ 单核/ 规模较/ 小/ 的/ 情况/ 下/ ,/ 仍然/ 能/ 取得/ 较/ 高/ 的/ 并行/ 效率/ ./ 另一方面/ ,/ 多核/ // 众核/ 体系结构/ 是/ 当前/ 和/ 未来/ 高性能/ 计算机/ 的/ 主要/ 特征/ ./ 在/ 这种/ 体系结构/ 上/ ,/ 计算/ 结点/ 呈现/ 多/ CPU/ 、/ CPU/ 内多核/ // 众核/ 的/ 多级/ 结构/ ,/ 单/ 结点/ 的/ 计算/ 性能/ 随着/ 结点/ 内核/ 数/ 增加/ 而/ 大幅度/ 提升/ ./ 同时/ ,/ 单/ 结点/ 的/ 存储容量/ 和/ 带宽/ 却/ 增加/ 缓慢/ ./ 这/ 意味着/ ,/ 单核/ 的/ 内存/ 和/ 带宽/ 可能/ 还会/ 减少/ [/ 2/ ]/ ./ 因此/ ,/ 传统/ 的/ 通过/ 增加/ 单核/ 计算/ 规模/ 来/ 获取/ 较/ 好/ 的/ 并行/ 效率/ 的/ 方式/ 将/ 不再/ 现实/ ,/ 必须/ 考虑/ 迭代/ 方法/ 适应/ 细粒度/ 并行/ 的/ 能力/ ./ 迭代/ 方法/ 的/ 并行/ 可扩展性/ 能/ 面临/ 很大/ 的/ 挑战/ ./ 本文/ 分析/ 迭代/ 方法/ 适应/ 细粒度/ 并行计算/ 的/ 能力/ 和/ 并行/ 性能/ 瓶颈/ ,/ 引入/ 渐近/ 规模/ 来/ 刻画/ 并行/ 迭代/ 方法/ 的/ 通信/ 与/ 计算/ 比/ ./ 所谓/ 渐近/ 规模/ ,/ 是/ 指/ 满足/ 并行/ 加速/ 条件/ (/ 加速/ 比/ 大于/ 1/ )/ 的/ 计算/ 规模/ 下限/ ./ 基于/ 此/ ,/ 在/ 1024/ 个/ CPU/ 核上/ ,/ 对/ 实际/ 应用/ 中/ 几类/ 常用/ 迭代/ 方法/ 进行/ 了/ 渐近/ 规模/ 分析/ ,/ 给出/ 了/ 包括/ 进程/ 和/ 进程/ // 线程/ 混合/ 并行/ 的/ 测试/ 和/ 分析/ 结果/ ./ 本文/ 第/ 2/ 节/ 简单/ 介绍/ 几种/ 常用/ 的/ 迭代/ 方法/ 及其/ 基本/ 运算/ ;/ 第/ 3/ 节/ 介绍/ 渐近/ 规模/ 及其/ 分析方法/ ;/ 第/ 4/ 节/ 给出/ 性能/ 分析/ 结果/ ;/ 第/ 5/ 节/ 讨论/ 和/ 总结/ 全文/ ./ 2/ 迭代/ 方法/ 及其/ 基本/ 运算/ 迭代/ 方法/ 的/ 主要/ 思想/ 是/ 通过/ 构造/ 有效/ 的/ 迭代/ 格式/ ,/ 在/ 有限/ 步内/ 收敛/ 于/ 方程/ 的/ 解/ ,/ 算法/ 的/ 一般/ 流程/ 如下/ :/ 其中/ 狓/ 0/ 为/ 初始/ 解/ 向量/ ,/ G/ (/ 犃/ ,/ 犫/ ,/ 狓/ k/ -/ 1/ )/ 为/ 迭代/ 格式/ ,/ k/ 为/ 迭代/ 次数/ ./ 迭代/ 格式/ G/ (/ 犃/ ,/ 犫/ ,/ 狓/ k/ -/ 1/ )/ 由/ 当前/ 迭代/ 近似/ 解/ 狓/ k/ -/ 1/ 得到/ 新/ 的/ 近似/ 解/ 狓/ k/ ,/ 通常/ 由/ 一系列/ 稀疏/ 矩阵/ -/ 向量/ 乘积/ (/ SpMV/ )/ 、/ 向量/ 内积/ (/ dot/ )/ 和/ 向量/ 校正/ (/ axpy/ )/ 等/ 操作/ 组合/ ./ 记/ 矩阵/ 犃/ =/ (/ aij/ )/ n/ ×/ n/ ,/ 向量/ 狓/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ T/ ,/ 狔/ =/ (/ y1/ ,/ y2/ ,/ …/ ,/ yn/ )/ T/ ,/ 狕/ =/ (/ z1/ ,/ z2/ ,/ …/ ,/ zn/ )/ T/ (/ n/ 为/ 矩阵/ 和/ 向量/ 的/ 规模/ )/ ,/ 常数/ a/ ./ 则/ 3/ 种/ 运算/ 计算方法/ 如下/ :/ (/ 1/ )/ SpMV/ :/ 狔/ =/ 犃/ 狓/ yi/ =/ ∑/ n/ (/ 2/ )/ dot/ :/ d/ =/ (/ 狓/ ,/ 狔/ )/ d/ =/ ∑/ n/ (/ 3/ )/ axpy/ :/ 狕/ =/ 犪/ 狓/ +/ 狔/ zi/ =/ axi/ +/ yi/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 对于/ 稀疏/ 矩阵/ ,/ 这些/ 操作/ 的/ 计算/ 复杂度/ 均/ 为/ O/ (/ n/ )/ ./ 在/ 并行计算/ 环境/ 下/ ,/ 假设/ 矩阵/ 按行/ 进行/ 数据/ 划分/ ,/ 向量/ 也/ 进行/ 相应/ 的/ 划分/ ./ 则/ SpMV/ 需要/ 局部/ 点对点/ 通信/ ,/ dot/ 需要/ 全局/ 归约/ 通信/ ,/ axpy/ 无需/ 通信/ ./ 表/ 1/ 以/ 实际/ 应用/ 中/ 最/ 常用/ 的/ 3/ 种/ 典型/ 迭代/ 方法/ 为例/ ,/ 给出/ 了/ 单次/ 迭代/ 所/ 需/ 的/ 基本/ 运算/ 次数/ ./ 其中/ ,/ Page3Jacobi/ 是/ 最/ 基本/ 的/ 迭代/ 方法/ ,/ CG/ (/ 共轭/ 梯度/ 方法/ )/ 和/ BiCGSTAB/ (/ 双/ 正交/ 共轭/ 梯度/ 稳定化/ 方法/ )/ 属于/ Krylov/ 子/ 空间/ 迭代/ 方法/ [/ 1/ ]/ ,/ 分别/ 适用/ 于/ 求解/ 对称/ 和/ 非对称/ 问题/ ./ JacobiCGBiCGSTAB23/ 通信/ 与/ 计算/ 比/ :/ 渐近/ 规模/ 分析/ 记号/ :/ p/ :/ CPU/ 核数/ (/ 以下/ 简称/ “/ 核数/ ”/ )/ ./ n/ :/ 矩阵/ 规模/ (/ 以下/ 简称/ “/ 规模/ ”/ )/ ./ Tp/ ,/ n/ :/ 规模/ 为/ n/ ,/ 核数/ 为/ p/ 时/ 的/ CPU/ 时间/ ./ pm/ =/ p3/ ./ 1/ 加速/ 条件/ 其/ 加速/ 比/ 和/ 并行/ 效率/ 分别/ 为/ 固定/ 规模/ n/ ,/ 核数/ 从/ pm/ 增加/ 到/ p/ (/ 增加/ m/ 倍/ )/ ,/ 定义/ 并行计算/ 的/ 加速/ 条件/ 为/ Sp/ ,/ n/ >/ 1/ ,/ 即/ 存在/ 0/ </ ε/ </ 1/ -/ 1/ 加速/ 条件/ (/ 4/ )/ 给出/ 了/ 固定/ 规模/ n/ 、/ 核数/ 增加/ m/ 倍/ 时/ 并行/ 效率/ 的/ 下限/ Em/ =/ 1/ 为/ 核数/ 从/ pm/ 增加/ 到/ p/ 时/ 的/ 渐近/ 效率/ ,/ ε/ 称为/ 效率/ 增量/ ./ 在/ 下面/ 的/ 分析/ 中/ ,/ 为/ 简单/ 起/ 见/ ,/ 迭代/ 方法/ 基本/ 运算/ 的/ 并行/ 实现/ 满足/ 如下/ 假设/ :/ (/ 1/ )/ 计算/ 与/ 通信/ 不/ 重叠/ ./ (/ 2/ )/ 各/ CPU/ 核/ 的/ 计算/ 负载/ 和/ 通信/ 负载/ 均衡/ ./ (/ 3/ )/ 单核/ 浮点/ 性能/ 不随/ 核数/ 变化/ 而/ 变化/ ./ 由/ 假设/ (/ 1/ )/ ,/ CPU/ 时间/ Tp/ ,/ n/ 可/ 分为/ 计算/ 时间/ p/ ,/ n/ 和/ 通信/ TcmTcp/ 于/ 3/ 个/ 基本/ 运算/ 的/ 计算/ 量/ 不/ 随核数/ 的/ 变化/ 而/ 变化/ ,/ 基于/ 假设/ (/ 3/ )/ ,/ 有/ Tcp/ 写为/ Ep/ ,/ n/ =/ Tcp/ 则/ 加速/ 条件/ (/ 4/ )/ 意味着/ p/ ,/ n/ / 1Tcp/ 上式/ 给出/ 了/ 满足/ 加速/ 条件/ 的/ 计算/ 时间/ 下限/ ,/ 该/ 下限/ 与/ 两个/ 方面/ 有关/ :/ 通信/ 开销/ TcmTcmp/ ,/ n/ -/ Tcm3/ ./ 2/ 计算/ 通信/ 复杂度/ 对/ 具体/ 迭代/ 方法/ ,/ 记/ c1/ 、/ c2/ 和/ c3/ 分别/ 为/ 基本/ 运算/ SpMV/ 、/ dot/ 和/ axpy/ 的/ 次数/ ,/ f1/ (/ n/ )/ 、/ f2/ (/ n/ )/ 和/ f3/ (/ n/ )/ 分别/ 为/ 相应/ 基本/ 运算/ 的/ 浮点运算/ 次数/ ,/ 则/ 总/ 浮点/ 次数/ 为/ f/ (/ n/ )/ =/ c1f1/ (/ n/ )/ +/ c2f2/ (/ n/ )/ +/ c3f3/ (/ n/ )/ ./ 记/ 矩阵/ 犃/ 的/ 非/ 零元/ 数目/ 为/ nnz/ ,/ 有/ 则/ 迭代/ 方法/ 的/ 浮点运算/ 次数/ 即/ 为/ 记/ η/ 为/ 单核/ 浮点运算/ 速度/ ,/ 基于/ 假设/ (/ 2/ )/ ,/ 有/ f/ (/ n/ )/ =/ 2c1/ ·/ nnz/ +/ 2/ (/ c2/ +/ c3/ )/ n/ -/ c1/ -/ c2/ (/ 7/ )/ 对于/ 点对点/ 通信/ ,/ 考虑/ 基本/ 的/ α/ -/ β/ 模型/ :/ Tcm/ ,/ 1/ 下面/ 考虑/ 通信/ 开销/ ,/ 为/ 简单/ 起/ 见/ ,/ 我们/ 仅/ 考虑/ 进程/ 间/ 的/ 消息传递/ 通信/ 的/ 开销/ ./ 对/ 迭代/ 方法/ ,/ 包括/ SpMV/ 的/ 点对点/ 局部/ 通信/ 时间/ Tcm/ ,/ 1/ 归约/ 通信/ 时间/ Tcm/ ,/ 2ps/ α/ +/ k/ β/ ,/ 其中/ α/ ,/ β/ 分别/ 为/ 通信/ 延迟/ 和/ 带宽/ 的/ 倒数/ ,/ k/ 为/ 消息/ 长度/ (/ 字节/ )/ ,/ ps/ 为/ 本地/ 发送/ 进程/ 个数/ ./ 考虑/ 到/ 实际/ 的/ 通信/ 延迟/ 与/ 两个/ 处理器/ 的/ 距离/ 相关/ ,/ 我们/ 采用/ 文献/ [/ 3/ ]/ 中/ 提出/ 的/ α/ -/ β/ -/ γ/ 模型/ ,/ 该/ 模型/ 中将/ 距离/ 考虑/ 进来/ ,/ 即/ α/ 替换成/ α/ (/ h/ )/ =/ α/ +/ h/ γ/ ./ 其中/ h/ 为/ 消息传递/ 的/ 跳数/ (/ hops/ 数/ )/ ,/ γ/ 则/ 是/ 每个/ hops/ 的/ 额外/ 延迟/ ./ 这些/ 参数/ 与/ 具体/ 网络拓扑/ 相关/ ./ 例如/ ,/ 对/ mesh/ 或/ torus/ 网络/ ,/ h/ 则/ 为/ 网络/ 直径/ ./ 而/ 对/ 胖/ 树结构/ ,/ h/ =/ 4/ ./ 因此/ ,/ 基于/ α/ -/ β/ -/ γ/ 模型/ 的/ 通信/ 开销/ 为/ 对/ 全局/ 归约/ 通信/ ,/ 我们/ 考虑/ 广泛/ 采用/ 的/ 结合/ 二叉树/ 模型/ [/ 4/ ]/ :/ Tcm/ ,/ 2/ 算/ dot/ 只/ 归约/ 一个双/ 精度/ 数/ ,/ 因此/ k/ =/ 1/ ,/ 结合/ 基于/ 点对点/ 的/ α/ -/ β/ -/ γ/ 模型/ ,/ 我们/ 采用/ 如下/ 模型/ :/ 因此/ ,/ 迭代/ 方法/ 的/ 通信/ 为/ Page4Tcmp/ ,/ n/ =/ Tcm/ ,/ 1c2/ (/ hlog2p/ -/ hmlog2pm/ )/ ./ =/ c1/ (/ ps/ ·/ (/ α/ +/ h/ γ/ )/ +/ k/ β/ )/ +/ c2log2p/ ·/ (/ α/ +/ h/ γ/ +/ β/ )/ =/ (/ c1ps/ +/ c2log2p/ )/ α/ +/ (/ c1k/ +/ c2log2p/ )/ β/ +/ (/ c1ps/ +/ c2log2p/ )/ h/ γ/ 基于/ 迭代/ 方法/ 的/ 计算/ 复杂度/ (/ 8/ )/ 和/ 通信/ 复杂度/ 3.3/ 渐近/ 规模/ (/ 11/ )/ ,/ 则/ 加速/ 条件/ (/ 6/ )/ 写为/ 其中/ ,/ f/ (/ n/ ,/ p/ )/ =/ f/ (/ n/ )/ c/ (/ ε/ ,/ m/ ,/ η/ ,/ p/ ,/ α/ ,/ β/ ,/ γ/ )/ =/ η/ m/ -/ 1/ -/ ε/ m/ (/ c/ α/ α/ +/ c/ β/ β/ +/ c/ γ/ γ/ )/ ,/ c/ α/ =/ ε/ m/ (/ c1ps/ +/ c2log2p/ )/ +/ c1log2m/ ,/ c/ β/ =/ ε/ m/ (/ c1k/ +/ c2log2p/ )/ +/ c2log2m/ ,/ c/ γ/ =/ ε/ m/ (/ c1ps/ +/ c2log2p/ )/ h/ +/ c1ps/ (/ h/ -/ hm/ )/ +/ f/ (/ n/ ,/ p/ )/ 为/ 单核/ 的/ 计算/ 复杂度/ ,/ c/ (/ ε/ ,/ m/ ,/ η/ ,/ p/ ,/ α/ ,/ β/ ,/ γ/ )/ 称为/ 通信/ 复杂度/ ./ 通信/ 复杂度/ 可/ 视为/ 将/ 通信/ 时间/ 等价/ 转换/ 为/ 计算/ 时间/ 所/ 需/ 的/ 计算/ 量/ ./ 给定/ 核数/ p/ 、/ 增长/ 倍数/ m/ 以及/ 效率/ 增量/ ε/ ,/ 关系式/ (/ 12/ )/ 给出/ 了/ 满足/ 加速/ 条件/ 计算/ 量/ 与/ 通信量/ 的/ 关系/ ,/ 同时/ 隐含/ 了/ 满足/ 加速/ 条件/ 的/ 规模/ 下限/ ./ 特别/ 地/ ,/ 定义/ 渐近/ 规模/ N/ (/ p/ ,/ m/ )/ 为/ 当/ ε/ →/ 0/ 时/ ,/ 满足/ 加速/ 条件/ 的/ 单核/ 最小/ 规模/ ,/ 即/ N/ (/ p/ ,/ m/ )/ =/ {/ minnp/ :/ f/ (/ n/ ,/ p/ )/ / c/ (/ ε/ ,/ m/ ,/ η/ ,/ p/ ,/ α/ ,/ β/ ,/ γ/ )/ ,/ ε/ →/ 对于/ 给定/ 的/ p/ 和/ m/ ,/ N/ (/ p/ ,/ m/ )/ 越大/ ,/ 则/ 说明/ 满足/ 加速/ 条件/ 的/ 单核/ 最小/ 规模/ 越大/ ,/ 即/ 通信/ 与/ 计算/ 比越/ 大/ ./ 对于/ 具体/ 迭代/ 方法/ ,/ 给定/ p/ 和/ m/ ,/ 其/ 渐近/ 规模/ 主要/ 依赖于/ 如下/ 4/ 个/ 方面/ :/ (/ 1/ )/ 应用/ 参数/ ./ 矩阵/ 非/ 零元/ 数目/ nnz/ ./ (/ 2/ )/ 通信/ 模式/ 参数/ ./ 消息/ 长度/ k/ 和/ 本地/ 发送/ 进程/ 数/ ps/ ./ 取决于/ 应用/ 和/ 数据/ 剖分/ 方式/ ./ (/ 3/ )/ 通信/ 参数/ ./ 通信/ 延迟/ α/ 、/ 带宽/ 倒数/ β/ 、/ 每个/ hops/ 的/ 额外/ 延迟/ γ/ 、/ 消息传递/ hops/ 数/ h/ ./ 取决于/ 具体/ 机器/ ./ (/ 4/ )/ 迭代/ 方法/ 参数/ ./ 基本/ 运算/ 次数/ c1/ 、/ c2/ 和/ c3/ ./ 因此/ ,/ 对于/ 给定/ 的/ 迭代/ 方法/ 、/ 数据/ 剖分/ 和/ 机器/ ,/ 即可/ 通过/ 式/ (/ 13/ )/ 预测/ 相应/ 的/ 渐近/ 规模/ ./ 同样/ ,/ 渐近/ 规模/ 也/ 可/ 用于/ 分析/ 迭代/ 方法/ 各/ 基本/ 运算/ 的/ 通信/ 与/ 计算/ 比/ ,/ 例如/ ,/ 对/ 运算/ SpMV/ 和/ dot/ ,/ 分别/ 取/ c1/ =/ 1/ ,/ c2/ =/ c3/ =/ 0/ 和/ c2/ =/ 1/ ,/ c1/ =/ c3/ =/ 0/ ./ 特别/ 地/ ,/ 如果/ 某类/ 运算/ 没有/ 通信/ 开销/ ,/ 即/ c/ (/ ε/ ,/ m/ ,/ η/ ,/ p/ ,/ α/ ,/ β/ ,/ γ/ )/ =/ 0/ ,/ 则/ 称之为/ 零/ 渐近/ 规模/ 运算/ ./ 例如/ ,/ axpy/ 是/ 零/ 渐近/ 规模/ 运算/ ./ 关于/ 并行/ 可扩展性/ 能/ 度量/ 和/ 评测/ ,/ 已有/ 很多/ 分析方法/ ,/ 可/ 参见/ 文献/ [/ 5/ -/ 8/ ]/ ./ 本文/ 侧重于/ 满足/ 并行/ 加速/ 条件/ 的/ 计算/ 规模/ 下限/ 分析/ ./ 在/ 实际/ 应用程序/ 中/ ,/ 给定/ 核数/ p/ 和/ 增长/ 倍数/ m/ ,/ 如果/ 单核/ 规模/ 小于/ 渐近/ 规模/ ,/ 则/ 无法/ 取得/ 加速/ ./ 这/ 对/ 大规模/ 计算/ 有/ 直接/ 的/ 指导意义/ ./ 注记/ 1/ ./ 在/ 渐近/ 规模/ 的/ 定义/ 式/ (/ 13/ )/ 中/ ,/ 效率/ 增量/ ε/ →/ 0/ 只是/ 具有/ 理论意义/ ./ 实际/ 应用/ 中/ ,/ 通常/ 取/ 某个/ 较小值/ ,/ 例如/ ε/ =/ 0.1/ ×/ (/ 1/ // m/ )/ ./ 也/ 可/ 根据/ 实际/ 需要/ ,/ 取/ 0/ </ ε/ </ 1/ -/ 1/ // m/ 之间/ 的/ 任何/ 数/ ,/ 从而/ 获得/ 更高/ 并行/ 效率/ 的/ 规模/ 下限/ ./ 4/ 数值/ 实验/ 4.1/ 模型/ 、/ 平台/ 和/ 参数/ 测试/ 矩阵/ 来源于/ 二维/ Poisson/ 方程/ 在/ 结构/ 网格/ 上/ 采用/ 5/ 点/ 格式/ 离散/ 得到/ ,/ 除/ 边界/ 网格/ 单元/ 外/ ,/ 矩阵/ 每行/ 的/ 非/ 零元/ 数目/ 为/ 5/ ./ 即/ 矩阵/ 非/ 零元/ 数目/ nnz/ =/ 5n/ ./ 数值/ 实验/ 在/ 并行/ 应用/ 支撑/ 软件/ 框架/ JASMIN/ [/ 9/ ]/ 上/ 进行/ ./ 在/ JASMIN/ 框架/ 中/ ,/ 结构/ 网格/ 被/ 划分/ 为/ 若干个/ 均匀/ 矩形网格/ 片/ (/ patch/ )/ 的/ 集合/ ./ 图/ 1/ 给出/ 了/ 一个/ 规模/ 为/ 20/ ×/ 20/ 的/ 网格/ 包含/ 7/ 个/ 网格/ 片/ 的/ 示意图/ ./ 在/ JASMIN/ 框架/ 中/ ,/ 网格/ 片/ 是/ 并行计算/ 的/ 基本/ 单位/ ,/ 数据/ 剖分/ 基于/ 网格/ 片/ 进行/ ./ 因此/ ,/ 消息/ 长度/ k/ =/ n/ // 槡/ p/ ,/ 本地/ 发送/ 进程/ 数/ ps/ =/ 4/ ./ 图/ 1JASMIN/ 框架结构/ 网格/ 及/ 网格/ 片/ 划分/ 示意图/ 如图/ 1/ 所示/ ,/ 7/ 个/ 网格/ 片/ 被/ 划分/ 在/ 2/ 个/ CPU/ 核/ ,/ 分别/ 包含/ 4/ 个/ 和/ 3/ 个/ 网格/ 片/ ./ 所有/ 数值/ 实验/ 在/ 一台/ 包含/ 128/ 个/ 双路/ 4/ 核/ 计算/ 结点/ 的/ 并行机/ 上/ 完成/ ,/ 共/ 1024/ 个/ 核/ ./ 单核/ 浮点/ 峰值/ 为/ 10.12/ GFlop/ // s/ ./ 每个/ 结点/ 共享/ 16GB/ 内存/ ./ 结点/ 之间/ 采用/ Infiniband/ 网络/ 互连/ ,/ 网络拓扑/ 是/ 两层/ 胖/ 树结构/ ./ 16/ 个/ 结点/ 组成/ 一个/ 机柜/ ./ 结点/ 之间/ 的/ 通信/ 延迟/ α/ =/ 1.66/ μ/ s/ ,/ 通信/ 带宽/ 是/ 1.68/ GB/ // s/ 即/ β/ =/ Page55/ ./ 94ns/ ,/ 每个/ hops/ 的/ 额外/ 延迟/ γ/ =/ 0.91/ μ/ s/ ./ 机柜/ 之间/ 的/ 通信/ 延迟/ α/ =/ 1.89/ μ/ s/ ,/ 每个/ hops/ 的/ 额外/ 延迟/ γ/ =/ 2.86/ μ/ s/ ./ 消息传递/ 的/ hops/ 数/ h/ =/ 4/ ./ 实验/ 中/ ,/ 采用/ O2/ 优化/ 编译/ 选项/ ./ 在/ 实验/ 机器/ 上/ ,/ 我们/ 测得/ 的/ SpMV/ 实际/ 浮点运算/ 速度/ 为/ 0.81/ GFlop/ // s/ ./ 由/ 迭代/ 方法/ 的/ 浮点运算/ 次数/ f/ (/ n/ )/ 可知/ ,/ SpMV/ 是/ 运算量/ 的/ 主要/ 部分/ ./ 因此/ ,/ 实验/ 中/ 我们/ 取/ 迭代/ 方法/ 的/ 单核/ 浮点运算/ 速度/ η/ =/ 0.81/ GFlop/ // s/ ./ 4.2/ 测试/ 结果/ 及/ 分析/ 本/ 小节/ ,/ 测试/ 第/ 2/ 节/ 介绍/ 的/ 几类/ 常用/ 迭代/ 方法/ 及其/ 基本/ 运算/ 的/ 渐近/ 规模/ 及/ 可扩展性/ ,/ 各/ 迭代/ 方法/ 的/ 基本/ 运算/ 次数/ 见表/ 1/ ./ 测试/ 中/ ,/ 核数/ 增长/ 倍数/ m/ =/ 2/ ,/ 效率/ 增量/ ε/ =/ 0.05/ ./ 采用/ 基于/ MPI/ 编程/ 的/ 进程/ 并行/ (/ MPI/ -/ Only/ )/ ./ 渐近/ 规模/ (/ 13/ )/ 的/ 基础/ 是/ 通信/ 性能/ 模型/ (/ 9/ )/ 和/ (/ 10/ )/ 的/ 准确性/ ./ 图/ 2/ 给出/ 了/ SpMV/ 点对点/ 通信/ 与/ dot/ 全局/ 归约/ 通信/ 的/ 模型/ 预测/ 曲线/ 和/ 实测/ 曲线/ ./ 可见/ 两者/ 均/ 吻合/ 较/ 好/ ./ 这/ 验证/ 了/ 通信模型/ 和/ 机器/ 参数/ 的/ 可靠性/ ./ 测试/ 中/ ,/ 固定/ 网格/ 规模/ 1024/ ×/ 1024/ ,/ 单个/ 网格/ 片/ 大小/ 32/ ×/ 32/ ,/ 共/ 1024/ 个/ 网格/ 片/ ,/ 通信/ 次数/ 10000/ ./ 从图/ 2/ 还/ 可/ 看出/ 由/ 两层/ 胖/ 树结构/ 带来/ 的/ 影响/ ,/ 在/ 超过/ 128/ 个/ 核时/ ,/ 预测/ 数据/ 明显/ 表现/ 出/ 通信/ 参数/ 的/ 差异/ ./ 图/ 2SpMV/ 的/ 点对点/ 通信/ 和/ dot/ 归约/ 通信/ 性能/ :/ 图/ 3/ 给出/ 了/ 3/ 种/ 迭代/ 方法/ 及/ 基本/ 运算/ SpMV/ 和/ dot/ 的/ 渐近/ 规模/ 随核数/ 增长/ 的/ 变化趋势/ ,/ 同时/ 给出/ 了/ 基于/ 式/ (/ 13/ )/ 的/ 预测/ 曲线/ 和/ 基于/ 式/ (/ 6/ )/ 的/ 实测/ 曲线/ 的/ 结果/ ./ 可知/ 预测/ 曲线/ 基本上/ 与/ 实测/ 曲线/ 吻合/ 较/ 好/ ,/ 各/ 曲线/ 的/ 趋势/ 一致/ ./ 从图/ 2/ 和/ 图/ 3/ 还/ 可/ 得到/ 如下/ 结论/ :/ (/ 1/ )/ dot/ 具有/ 很大/ 的/ 渐近/ 规模/ ,/ 且/ 随核数/ 增加/ 渐近/ 规模/ 也/ 显著/ 增加/ ./ SpMV/ 的/ 渐近/ 规模较/ 小/ ,/ 随着/ 核数/ 增加/ ,/ 渐近/ 规模/ 增加/ 不/ 明显/ ./ 核数/ 从/ 8/ 增加/ 到/ 图/ 3/ 各/ 迭代/ 方法/ 及/ 基本/ 运算/ 的/ 渐近/ 规模/ 变化/ 曲线/ :/ 1024/ ,/ dot/ 的/ 渐近/ 规模/ 从/ 4096/ 增加/ 到/ 65536/ ,/ 增加/ 了/ 16/ 倍/ ./ 而/ SpMV/ 的/ 渐近/ 规模/ 控制/ 在/ 512/ 之内/ ./ 3/ 个/ 迭代/ 方法/ 的/ 渐近/ 规模/ 变化/ 曲线/ 均/ 处于/ dot/ 和/ SpMV/ 的/ 曲线/ 之间/ ,/ 随着/ 核数/ 增加/ ,/ 变化趋势/ 与/ dot/ 的/ 曲线/ 一致/ ./ 这/ 说明/ ,/ 迭代/ 方法/ 的/ 并行/ 性能/ 受限于/ dot/ 的/ 渐近/ 规模/ ./ 在/ 核数/ 为/ 1024/ 时/ ,/ 3/ 个/ 迭代/ 的/ 渐近/ 规模/ 在/ 8192/ 附近/ ./ 这/ 意味着/ ,/ 在/ 1024/ 个/ 核上/ ,/ 只有/ 单核/ 规模/ 超过/ 8192/ 时/ ,/ 才能/ 取得/ 较/ 好/ 的/ 并行/ 性能/ ./ (/ 2/ )/ dot/ 运算/ 的/ 全局/ 归约/ 通信/ 是/ 迭代/ 方法/ 的/ 性能/ 瓶颈/ ./ 从图/ 3/ 可知/ ,/ 核数/ 超过/ 64/ 时/ ,/ dot/ 全局/ 归约/ 的/ 开销/ 远高于/ SpMV/ 的/ 局部/ 通信/ ./ 核数/ 从/ 8/ 增加/ 到/ 1024/ ,/ dot/ 的/ 全局/ 归约/ 通信/ 开销/ 增加/ 了/ 24/ 倍/ ./ (/ 3/ )/ 需/ 指出/ 的/ 是/ ,/ 核数/ 从/ 16/ 增加/ 到/ 128/ 时/ ,/ SpMV/ 的/ 渐近/ 规模/ 反而/ 从/ 256/ 下降/ 到/ 32/ ./ 注意/ 到/ 加速/ 条件/ (/ 6/ )/ 中/ 包含/ 了/ 通信/ 增量/ 项/ ,/ 这/ 意味着/ 通信/ 开销/ 增加/ 不/ 明显/ ./ 实际上/ ,/ 从图/ 3/ 可知/ ,/ 核数/ 从/ 32/ 增加/ 到/ 128/ 时/ ,/ SpMV/ 的/ 通信/ 开销/ 反而/ 下降/ ,/ 与/ 渐近/ 规模/ 的/ 趋势/ 一致/ ./ 这/ 说明/ 渐近/ 规模/ 可/ 正确/ 反映/ 通信/ 与/ 计算/ 比/ ./ (/ 4/ )/ Jacobi/ 迭代/ 的/ 渐近/ 规模/ 略/ 小于/ CG/ 和/ BiCGSTAB/ ,/ 原因/ 在于/ Jacobi/ 单次/ 迭代/ 的/ 内积/ 次数/ Page6/ 少于/ CG/ 和/ BiCGSTAB/ ./ 4.3/ 进程/ // 线程/ 混合/ 并行/ 的/ 影响/ 从/ 渐近/ 规模/ 的/ 式/ (/ 13/ )/ 和/ 4.2/ 节/ 的/ 测试/ 可知/ ,/ 随核数/ 增加/ ,/ 迭代/ 方法/ 的/ 渐近/ 规模/ 增加/ 较/ 快/ ,/ 进程/ 通信/ 开销/ 尤其/ 是/ 内积/ 计算/ 的/ 全局/ 归约/ 通信/ 是/ 影响/ 迭代/ 方法/ 渐近/ 规模/ 的/ 主要/ 因素/ ./ 本/ 小节/ 考虑/ 进程/ // 线程/ 混合/ 并行/ 对/ 渐近/ 规模/ 的/ 影响/ ./ 采用/ MPI/ // OpenMP/ 编程/ (/ MPI/ -/ OMP/ )/ ,/ 考虑/ 到/ 实验/ 机器/ 是/ 双路/ 4/ 核/ 结构/ ,/ 每个/ 结点/ 启动/ 2/ 个/ MPI/ 进程/ ,/ 每个/ 进程/ 启动/ 4/ 个/ OpenMP/ 线程/ ./ 对/ JASMIN/ 框架/ ,/ 网格/ 片/ 是/ 基本/ 计算/ 单元/ ,/ 因此/ 线程/ 并行/ 的/ 最小/ 单位/ 是/ 网格/ 片/ ,/ 即/ 每个/ 线程/ 包括/ 若干个/ 网格/ 片/ ./ 从/ 通信/ 复杂度/ 的/ 公式/ c/ (/ ε/ ,/ m/ ,/ η/ ,/ p/ ,/ α/ ,/ β/ ,/ γ/ )/ 可/ 大致/ 得到/ 如下/ 趋势/ :/ 在/ 相同/ 核数/ 的/ 前提/ 下/ ,/ 进程/ 间/ 的/ 通信/ 开销/ 随/ 进程/ 数/ p/ 的/ 减少/ 而/ 下降/ ./ 图/ 4/ 给出/ 了/ MPI/ // OMP/ 混合/ 并行/ 下/ 3/ 种/ 迭代/ 方法/ 及/ 基本/ 运算/ SpMV/ 和/ dot/ 的/ 渐近/ 规模/ 随核数/ 增长/ 的/ 变化趋势/ ,/ 图/ 5/ 给出/ 了/ SpMV/ 点对点/ 通信/ 和/ dot/ 归约/ 通信/ 性能/ ./ 测试/ 规模/ 与/ 4.2/ 节/ 的/ 图/ 2/ 和/ 图/ 3/ 相同/ ./ 为了/ 对比/ ,/ 图/ 5/ 中/ 还/ 给出/ 了/ 4.2/ 节中纯/ MPI/ 的/ 结果/ ./ 图/ 5SpMV/ 的/ 点对点/ 通信/ 和/ dot/ 归约/ 通信/ 性能/ :/ 从图/ 4/ 和/ 图/ 5/ 可/ 得到/ 如下/ 结论/ :/ (/ 1/ )/ 从图/ 5/ 可知/ ,/ 相对/ 于/ 纯/ 进程/ 情形/ (/ 图/ 3/ )/ ,/ 在/ 相同/ 核数/ 情况/ 下/ ,/ 混合/ 情形/ 由于/ 进程/ 数目/ 减少/ ,/ 从而/ 减少/ 了/ MPI/ 通信/ 开销/ ./ (/ 2/ )/ 相对/ 于/ 纯/ 进程/ 情形/ (/ 图/ 2/ )/ ,/ dot/ 的/ 渐近/ 规模/ 增长/ 得到/ 较/ 好/ 的/ 控制/ ./ 核数/ 从/ 8/ 增加/ 到/ 1024/ ,/ dot/ 的/ 渐近/ 规模/ 增长/ 倍数/ 从纯/ 进程/ 情形/ 的/ 16/ 倍/ 下降/ 到/ 4/ 倍/ 左右/ ./ 这一/ 改善/ 使得/ 3/ 个/ 迭代/ 方法/ 的/ 渐近/ 规模/ 曲线/ 与/ SpMV/ 的/ 增长/ 曲线/ 一致/ ./ 在/ 核数/ 为/ 1024/ 时/ ,/ 3/ 个/ 迭代/ 的/ 渐近/ 规模/ 控制/ 在/ 512/ 之内/ ,/ 远/ 低于/ 纯/ 进程/ 情形/ 的/ 8192/ ./ 这/ 意味着/ ,/ 进程/ // 线程/ 混合/ 并行/ 改善/ 了/ 迭代/ 方法/ 细粒度/ 计算/ 的/ 可扩展性/ 能/ ./ 最后/ ,/ 图/ 6/ 以/ 迭代/ 方法/ 为例/ ,/ 给出/ 了/ 两种/ 并行/ 策略/ 下/ 的/ 可扩展性/ 能/ ./ 测试/ 中/ ,/ 固定/ 网格/ 规模/ 为/ 1024/ ×/ 1024/ ,/ 包含/ 1024/ 个/ 网格/ 片/ ,/ 网格/ 片/ 大小/ 32/ ×/ 32/ ./ 核数/ 从/ 32/ 增加/ 到/ 1024/ ,/ 则/ 单核/ 规模/ 从/ 32768/ 下降/ 到/ 1024/ ./ 图/ 6BiCGSTAB/ 可扩展性/ 能/ :/ 固定/ 规模/ 1024/ ×/ 1024/ 从图/ 6/ 可知/ ,/ 在/ 进程/ 情形/ ,/ 核数/ 为/ 256/ 时/ CPU/ 时间/ 达到/ 最小/ ./ 注意/ 到/ ,/ 此时/ 单核/ 规模/ 为/ 4096/ ./ 由图/ 2/ 可知/ ,/ BiCGSTAB/ 在/ 256/ 核时/ 的/ 渐近/ 规模/ 正好/ 是/ 4096/ ,/ 说明/ 此时/ 继续/ 增加/ 核数/ 很/ 难/ 有/ 加速/ ./ 在/ 进程/ // 线程/ 混合/ 情形/ ,/ 由于/ 渐近/ 规模/ 减小/ ,/ 在/ 进程/ 情形/ 达到/ 渐近/ 规模/ 之后/ (/ 核数/ 大于/ 128/ )/ ,/ 混合/ 情形/ 仍然/ 能够/ 继续/ 加速/ ,/ 直到/ 1024/ 核/ ./ 可扩展性/ 能/ 得到/ 明显改善/ ./ 这一/ 结果/ 与/ 图/ 2/ 的/ 分析/ 结果/ 吻合/ ./ 说明/ 渐近/ 规模/ 可/ 很/ 好/ 地/ 刻画/ 迭代/ 方法/ 的/ 通信/ 与/ 计算/ 比/ ./ 由于/ 通信模型/ (/ 9/ )/ 和/ (/ 10/ )/ 均/ 没有/ 考虑/ 线程/ 引入/ 及多核/ 结构/ 对/ 通信/ 的/ 影响/ ,/ 本/ 小节/ 仅/ 给出/ 实际/ 测试/ 的/ 结果/ ./ 如何/ 将/ 线程/ 和/ 多/ 核/ 因素/ 考虑/ 到/ 通信模型/ 中/ ,/ 得到/ 更/ 精细/ 的/ 通信模型/ ,/ 是/ 将来/ 需要/ 研究/ 的/ 课题/ ./ 5/ 总结/ 本文/ 引入/ 渐近/ 规模/ 的/ 概念/ 来/ 刻画/ 并行/ 迭代/ 方法/ Page7/ 的/ 通信/ 与/ 计算/ 比/ ,/ 并/ 由此/ 刻画/ 迭代/ 方法/ 适应/ 细粒度/ 并行/ 的/ 可扩展性/ 能/ ./ 基于/ 此/ ,/ 在/ 多/ 核/ 系统/ 上/ 对/ 几种/ 典型/ 迭代/ 方法/ 进行/ 了/ 测试/ 和/ 分析/ ./ 结果表明/ ,/ 基于/ MPI/ 的/ 纯/ 进程/ 并行/ 无法/ 适应/ 细粒度/ 并行/ ,/ 渐近/ 规模/ 较大/ ,/ 其中/ 内积/ 运算/ dot/ 的/ MPI/ 全局/ 归约/ 通信/ 是/ 影响/ 迭代/ 方法/ 并行/ 性能/ 的/ 主要/ 瓶颈/ ./ 基于/ MPI/ // OpenMP/ 的/ 进程/ // 线程/ 混合/ 并行/ 通过/ 降低/ 进程/ 数目/ ,/ 可/ 缓解/ MPI/ 的/ 全局/ 归约/ 通信/ 开销/ ,/ 降低/ 渐近/ 规模/ ,/ 改善/ 并行/ 可扩展性/ 能/ ./ 本文/ 的/ 分析/ 结果/ 可/ 用于/ 指导/ 实际/ 应用程序/ 的/ 大规模/ 计算/ ,/ 渐近/ 规模/ 还/ 可/ 用于/ 其它/ 并行/ 应用/ 的/ 分析/ ./ 随着/ 科学计算/ 向/ 百亿/ 亿次/ 计算/ (/ Exascale/ )/ 迈进/ ,/ 未来/ 计算机系统/ 的/ 结点/ 数目/ 将/ 更/ 多/ ,/ 结点/ 内/ 的/ CPU/ 核数/ 将/ 达到/ 数十/ 数百/ 甚至/ 更多且/ CPU/ 之间/ 呈现/ NUMA/ 访存/ 特征/ [/ 2/ ]/ ,/ 如何/ 在/ 这样/ 的/ 系统/ 上/ 保持/ 较/ 低/ 的/ 渐近/ 规模/ ,/ 实现/ 并行/ 迭代/ 方法/ 的/ 细粒度/ 高效/ 并行/ ,/ 对/ 迭代/ 方法/ 的/ 算法/ 设计/ 和/ 并行/ 实现/ 均/ 是/ 一个/ 很大/ 的/ 挑战/ ./ 今后/ 的/ 研究/ 重点/ 包括/ :/ (/ 1/ )/ 发展/ 适应/ 结点/ 内/ 复杂/ 体系结构/ 的/ 并行/ 编程/ 模型/ 和/ 性能/ 优化/ 方法/ ./ 对于/ 结点/ 内/ 共享/ 存储/ 结构/ (/ SMP/ )/ ,/ OpenMP/ 是/ 有效/ 的/ 编程/ 模型/ ./ 然而/ ,/ 对于/ 结点/ 内/ NUMA/ 结构/ ,/ 需要/ 发展/ 新/ 的/ 编程/ 模型/ 和/ 性能/ 优化/ 方法/ ,/ 以便/ 在/ 降低/ 进程/ 间/ MPI/ 开销/ 的/ 前提/ 下/ ,/ 保持/ 结点/ 内高/ 可扩展性/ ./ 这是/ 科学计算/ 领域/ 的/ 共性/ 问题/ ./ (/ 2/ )/ 降低/ 内积/ 计算/ 全局/ 归约/ 通信/ 的/ 迭代/ 算法/ 和/ 实现/ 技术/ ./ 从表/ 1/ 可知/ ,/ 内积/ 的/ 调用/ 次数/ 通常/ 多于/ 其它/ 基本/ 运算/ 次数/ ./ 因此/ ,/ 设计/ 具有/ 更/ 少/ 内积/ 次数/ 的/ 新/ 迭代/ 算法/ 以及/ 并行/ 实现/ 技术/ 是/ 值得/ 尝试/ 的/ 方向/ ,/ 例如/ 文献/ [/ 10/ ]/ ./ (/ 3/ )/ 发展/ 适应/ 细粒度/ 并行/ 并/ 具有/ 快速/ 收敛/ 性质/ 的/ 并行/ 预/ 条件/ 子/ ./ 预/ 条件/ 子/ 是/ 很多/ 实际/ 应用/ 中/ 必不可少/ 的/ 迭代/ 加速/ 技术/ ./ 限于/ 篇幅/ ,/ 本文/ 没有/ 涉及/ ./ 在/ 算法/ 流程/ 上/ ,/ 预/ 条件/ 子/ 的/ 操作/ 将/ 体现/ 在/ 矩阵/ -/ 向量/ 乘积/ SpMV/ 上/ ,/ 希望/ 通过/ 增加/ SpMV/ 的/ 计算/ 量/ ,/ 降低/ 迭代/ 次数/ ./ 因此/ ,/ 预/ 条件/ 子为/ 迭代/ 方法/ 降低/ 通信/ 与/ 计算/ 比/ 带来/ 了/ 新/ 的/ 机会/ ./ 好/ 的/ 预/ 条件/ 子/ 应该/ 同时/ 具有/ 低/ 渐近/ 规模/ 和/ 快速/ 收敛/ 的/ 性质/ ./ 然而/ ,/ 这/ 两个/ 方面/ 往往/ 是/ 矛盾/ 的/ ,/ 需要/ 基于/ 应用/ 和/ 体系结构/ 特征/ 进行/ 优化/ 设计/ ./ 

