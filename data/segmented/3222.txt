Page1XML/ 的/ 结构/ 完整性/ 约束推理/ 张剑妹/ 1/ )/ ,/ 2/ )/ 陶世群/ 2/ )/ 梁吉业/ 2/ )/ 曹峰/ 2/ )/ 1/ )/ (/ 长治/ 学院/ 计算机系/ 山西/ 长治/ 046011/ )/ 2/ )/ (/ 山西大学/ 计算机/ 与/ 信息技术/ 学院/ 太原/ 030006/ )/ 摘要/ 为了/ 有效/ 地/ 优化/ XML/ 路径/ 表达式/ 查询/ ,/ 给出/ 了/ 一个/ XML/ 结构/ 完整性/ 约束/ 体系/ ,/ 这个/ 体系/ 全面/ 描述/ 了/ XML/ 文档/ 中/ 节点/ 或/ 路径/ 之间/ 的/ 结构/ 关系/ ,/ 包括/ 必需/ 性/ 包含/ 、/ 排他性/ 包含/ 、/ 路径/ 蕴涵/ 、/ 路径/ 互斥/ 和/ 路径/ 同现/ ./ 在/ 此基础/ 上/ 研究/ 了/ XML/ 结构/ 完整性/ 约束/ 的/ 逻辑/ 蕴涵/ 和/ 一致性/ 问题/ ./ 文章/ 首先/ 采用/ 约束/ 重写/ 技术/ 将/ 各种/ 约束/ 改写/ 为/ 路径/ 蕴涵/ 约束/ ;/ 然后/ 给出/ 了/ 一组/ 路径/ 蕴涵/ 的/ 推理/ 规则/ ;/ 最后/ 以/ 路径/ 蕴涵/ 闭包/ 为/ 工具/ 证明/ 了/ 推理/ 规则/ 的/ 完备/ 性/ 并/ 给出/ 了/ XML/ 结构/ 完整性/ 约束/ 的/ 一致性/ 判断/ 方法/ ./ 关键词/ XML/ 结构/ 完整性/ 约束/ ;/ 逻辑/ 蕴涵/ ;/ 一致性/ ;/ 推理/ 规则/ ;/ 路径/ 蕴涵/ 闭包/ 1/ 引言/ 随着/ Web/ 上/ 大量/ XML/ 数据/ 的/ 出现/ ,/ 如何/ 高效/ 地/ 管理/ 和/ 查询/ XML/ 数据/ 成为/ 亟待解决/ 的/ 问题/ ./ 为/ Page2/ 作为/ XML/ 文档/ 的/ 主要/ 模式/ 规范/ ,/ DTD/ (/ DocumentTypeDefinition/ )/ [/ 6/ ]/ 和/ XMLSchema/ [/ 7/ ]/ 虽然/ 定义/ 了/ XML/ 文档/ 中/ 允许/ 出现/ 的/ 元素/ 类型/ 、/ 属性/ 及其/ 顺序/ 和/ 结构/ 嵌套/ 关系/ ,/ 但是/ 不能/ 处理/ 元素/ 或/ 路径/ 之间/ 复杂/ 的/ 结构/ 关系/ ,/ 例如/ :/ 在/ 一个/ 文档/ 中/ ,/ 从/ 一个/ 节点/ 出发/ 的/ 路径/ 要求/ (/ 或/ 排斥/ )/ 另/ 一个/ 路径/ ./ 如果/ 有/ 一种/ 机制/ 能/ 说明/ XML/ 元素/ 或/ 路径/ 之间/ 的/ 这种/ 结构/ 关系/ ,/ 那么/ ,/ 在/ XML/ 查询/ 编译/ 时/ ,/ 便/ 可以/ 有效/ 地/ 识别/ :/ (/ 1/ )/ 路径/ 表达式/ 中/ 的/ 冗余/ 条件/ ;/ (/ 2/ )/ 路径/ 表达式/ 中/ 不相容/ 的/ 条件/ ;/ (/ 3/ )/ 路径/ 表达式/ 中/ 的/ 冗余/ 步/ ;/ 从而/ 删除/ 冗余/ 条件/ ,/ 减少/ 冗余/ 步/ ,/ 以/ 最小化/ 路径/ 表达式/ ,/ 改善/ XML/ 查询/ 的/ 性能/ ./ 为此/ ,/ 我们/ 引入/ 了/ XML/ 结构/ 完整性/ 约束/ 的/ 概念/ ,/ 并/ 研究/ 了/ 它/ 的/ 逻辑/ 蕴涵/ 和/ 一致性/ 问题/ ./ 目前/ ,/ 对/ XML/ 结构/ 完整性/ 约束/ 的/ 研究/ 还/ 比较/ 少/ ,/ 文献/ [/ 8/ -/ 9/ ]/ 等/ 研究/ 了/ 半/ 结构化/ 数据/ 中/ 节点/ 的/ 边/ 约束/ ,/ 这些/ 研究/ 可以/ 说/ 是/ 最早/ 的/ 结构/ 完整性/ 约束/ 的/ 研究/ ./ 文献/ [/ 10/ ]/ 提出/ 了/ 使用/ DTD/ 中/ 隐含/ 的/ 结构/ 完整性/ 约束/ 进行/ XPath/ 路径/ 表达式/ 查询/ 优化/ 的/ 方法/ ./ 文献/ [/ 11/ ]/ 研究/ 了/ XML/ 文档/ 中/ 路径/ 蕴涵/ 、/ 路径/ 互斥/ 和/ 路径/ 同现/ 三种/ 结构/ 约束/ 及其/ 逻辑/ 蕴涵/ 和/ 一致性/ 问题/ ,/ 但/ 其/ 定义/ 是/ 使用/ 仅/ 包含/ 父/ -/ 子/ 关系/ 的/ 简单/ 路径/ 表达式/ 给出/ 的/ ./ 文献/ [/ 12/ ]/ 研究/ 的/ XML/ 树/ 模式/ 约束/ 是/ 使用/ 包含/ “/ // ”/ 、/ “/ // // ”/ 、/ “/ [/ ]/ ”/ 和/ “/ / ”/ 的/ XPath/ 路径/ 表达式/ 子集/ 对/ 文献/ [/ 11/ ]/ 中/ 的/ 结构/ 约束/ 的/ 扩展/ ,/ 而/ 在/ 实际/ 应用/ 中/ 这种/ 树/ 模式/ 约束/ 又/ 显得/ 过于/ 复杂/ ./ 文献/ [/ 13/ ]/ 研究/ 了/ DTD/ 中/ 隐含/ 的/ 元素/ 之间/ 的/ 排他性/ 包含/ 和/ 必需/ 性/ 包含/ 关系/ ,/ 但/ 其/ 目的/ 是/ 为了/ PAT/ 代数/ 表达式/ 的/ 等价/ 转换/ 和/ 充分利用/ 结构/ 索引/ ,/ 因此/ ,/ 排他性/ 包含/ 的/ 概念/ 与/ 本文/ 的/ 排他性/ 包含/ 有着/ 本质/ 的/ 区别/ ./ 本文/ 研究/ 了/ 包含/ 路径/ 蕴涵/ 、/ 路径/ 互斥/ 、/ 路径/ 同现/ 、/ 元素/ 之间/ 的/ 排他性/ 包含/ 和/ 必需/ 性/ 包含/ 5/ 种/ 结构/ 关系/ 的/ XSICs/ 的/ 逻辑/ 蕴涵/ 和/ 一致性/ 问题/ ./ 与/ 文献/ [/ 11/ -/ 12/ ]/ 的/ 结构/ 约束/ 不同/ ,/ 为了/ 既/ 能/ 满足/ 路径/ 表达式/ 查询/ 最小化/ 的/ 需要/ 又/ 便于/ 推理/ 证明/ ,/ XSICs/ 中/ 的/ 路径/ 蕴涵/ 和/ 路径/ 互斥/ 是/ 使用/ 包含/ “/ // ”/ 和/ “/ // // ”/ 的/ 线性/ 路径/ 表达式/ 定义/ 的/ ./ 由于/ “/ // // ”/ 的/ 不确定性/ ,/ 线性/ 路径/ 表达式/ 之间/ 的/ 包含/ 关系/ 要/ 远远/ 复杂/ 于/ 简单/ 路径/ 之间/ 的/ 包含/ 关系/ ,/ 但/ 又/ 不同于/ 文献/ [/ 12/ ]/ 中/ 的/ 树/ 模式/ 之间/ 的/ 包含/ 关系/ ,/ 而/ 这种/ 包含/ 关系/ 的/ 确定/ 恰恰/ 是/ 推理/ 的/ 关键所在/ ./ 如何/ 有效/ 地/ 描述/ 线性/ 路径/ 表达式/ 之间/ 的/ 包含/ 关系/ 是/ 我们/ 必须/ 解决/ 的/ 一个/ 重要/ 问题/ ./ 此外/ ,/ 我们/ 引入/ 了/ 元素/ 必需/ 性/ 包含/ 和/ 排他性/ 包含/ 两种/ 结构/ 包含/ 关系/ ./ 元素/ 之间/ 的/ 结构/ 包含/ 关系/ 与/ 路径/ 之间/ 的/ 结构/ 关系/ 以/ 一种/ 复杂/ 的/ 方式/ 相互作用/ 着/ ,/ 为了/ 对/ XSICs/ 进行/ 有效/ 的/ 逻辑推理/ ,/ 必须/ 将/ 这/ 两类/ 结构/ 关系/ 有机/ 地/ 结合/ 起来/ ./ 如何/ 将/ 这/ 两类/ 结构/ 关系/ 结合/ 起来/ 是/ 我们/ 面临/ 的/ 又/ 一个/ 重要/ 问题/ ./ 毋庸置疑/ ,/ 约束/ 类型/ 和/ 约束/ 定义/ 的/ 不同/ 将/ 导致/ 推理/ 规则/ 及其/ 相关/ 证明/ 的/ 巨大/ 差异/ ,/ 从而/ 直接/ 影响/ 着/ XSICs/ 一致性/ 问题/ 的/ 解决/ 方法/ ./ 文章/ 第/ 2/ 节/ 介绍/ 一些/ 背景/ 知识/ ,/ 并/ 提出/ 了/ 子/ 路径/ 的/ 概念/ ;/ 第/ 3/ 节/ 给出/ XSICs/ 中/ 5/ 种/ 结构/ 关系/ 的/ 语法/ 和/ 语义/ 定义/ ,/ 并/ 详细/ 阐述/ 对/ 这/ 几种/ 结构/ 关系/ 进行/ 约束/ 重写/ 的/ 技术/ ;/ 第/ 4/ 节/ 给出/ 一组/ 推理/ 规则/ 和/ 路径/ 蕴涵/ 闭包/ 的/ 概念/ 及其/ 计算方法/ ,/ 并/ 证明/ 这组/ 推理/ 规则/ 的/ 正确性/ 和/ 完备/ 性/ ;/ 第/ 5/ 节/ 讨论/ XSIC/ 的/ 一致性/ 问题/ ;/ 第/ 6/ 节/ 总结/ 全文/ 并/ 指出/ 未来/ 的/ 研究/ 方向/ ./ 2/ 背景/ 知识/ 2.1/ XML/ 文档/ 树/ XML/ 文档/ 通常/ 可以/ 表示/ 为/ 节点/ 标签/ 的/ 树/ ,/ 树中/ 每个/ 节点/ 与/ 文档/ 的/ 一个/ 元素/ 、/ 属性/ 或值/ (/ 文本/ )/ 相对/ 应/ ,/ 边/ 表示/ 节点/ 之间/ 的/ 嵌套/ 关系/ ./ 这里/ 假定/ 有/ 3/ 个/ 两/ 两/ 不/ 相交/ 的/ 集合/ :/ E/ 是/ 元素/ 类型/ 的/ 有限/ 集/ ;/ A/ 是/ 属性/ 名/ 的/ 有限/ 集/ ,/ 单/ 元素/ 集/ {/ S/ }/ 表示/ 文本/ ./ XML/ 文档/ 树/ 的/ 形式化/ 定义/ [/ 2/ ]/ 如下/ ./ 定义/ 1/ ./ 一个/ XML/ 文档/ 树/ T/ 被/ 定义/ 为/ 一个/ 六元/ 组/ T/ =/ (/ V/ ,/ lab/ ,/ ele/ ,/ att/ ,/ val/ ,/ r/ )/ ,/ 其中/ :/ V/ 是/ 节点/ 的/ 有限/ 集/ ;/ lab/ 是/ 一个/ 从/ V/ 到/ E/ ∪/ A/ ∪/ {/ S/ }/ 的/ 映射/ ./ 每个/ v/ ∈/ V/ ,/ 如果/ lab/ (/ v/ )/ ∈/ E/ ,/ 则/ v/ 是/ 一个/ 元素/ ;/ 如果/ lab/ (/ v/ )/ ∈/ A/ ,/ 则/ v/ 是/ 一个/ 属性/ ;/ 如果/ lab/ (/ v/ )/ =/ S/ ,/ 则/ v/ 是/ 一个/ 文本/ 节点/ ;/ ele/ 和/ att/ 都/ 是从/ V/ 到/ V/ / 的/ 部分/ 映射/ ./ 每个/ v/ ∈/ V/ ,/ 如果/ lab/ (/ v/ )/ ∈/ E/ ,/ 则/ ele/ (/ v/ )/ 是/ V/ 中/ 的/ 一个/ 元素/ 和/ 文本/ 节点/ 序列/ ,/ att/ (/ v/ )/ 是/ V/ 中/ 的/ 一个/ 属性/ 集/ ;/ 每个/ v/ ∈/ ele/ (/ v/ )/ 或/ v/ ∈/ att/ (/ v/ )/ ,/ v/ 叫作/ v/ 的/ 孩子/ 节点/ 且/ 从/ v/ 到/ v/ 有/ 一个/ 边/ ;/ val/ 是/ 一个/ 从/ V/ 到/ 字符串/ 的/ 部分/ 映射/ ./ 每个/ v/ ∈/ V/ ,/ 如果/ lab/ (/ v/ )/ ∈/ A/ 或/ lab/ (/ v/ )/ =/ S/ ,/ 则/ val/ (/ v/ )/ 是/ v/ 的/ 一个/ 字符串/ 值/ ;/ r/ 是/ 文档/ 树中/ 唯一/ 的/ 一个/ 根/ 节点/ (/ 即/ 文档/ 节点/ )/ 且/ r/ ∈/ V/ ./ 图/ 1/ 给出/ 了/ 一个/ 关于/ 论文/ 出版/ 数据/ 的/ XML/ 文档/ 树/ ./ 为了/ 表示/ 简单/ ,/ 图中/ 忽略/ 了/ 文本/ 节点/ 和/ 根/ 节点/ ./ 本文/ 对/ 属性/ 和/ 元素/ 采用/ 相同/ 的/ 处理/ 方法/ ,/ 因此/ 不/ 严格/ 区分/ 属性/ 和/ 元素/ ,/ 即/ 下文/ 的/ 节点/ 类型/ 泛指/ 元素/ 类型/ 或/ 属性/ 名/ ./ Page3/ 图/ 1XML/ 文档/ 树/ 示例/ 2.2/ 路径/ 表达式/ 及/ 相关/ 符号/ 在/ XML/ 文档/ 树上/ ,/ 由/ 节点/ 序列/ 构成/ 的/ 路径/ 唯一/ 确定/ 一个/ 节点/ ,/ 这样/ 的/ 路径/ 叫作/ 文档/ 路径/ ;/ 路径/ 表达式/ 决定/ XML/ 文档/ 中/ 的/ 路径/ 形式/ ,/ 它/ 定义/ 了/ 一种/ 导航/ XML/ 文档/ 的/ 查询/ 并/ 返回/ 指定/ 路径/ 所/ 能/ 访问/ 到/ 的/ 节点/ 集/ 的/ 方法/ ./ 一个/ 路径/ 表达式/ 对应/ 于/ 若干条/ 文档/ 路径/ ,/ 也就是说/ ,/ 从/ 一个/ 起始/ 节点/ 开始/ ,/ 路径/ 表达式/ 将/ 返回/ 一个/ 节点/ 集合/ ./ 除非/ 特别/ 指明/ ,/ 下文/ 中/ 提到/ 的/ 路径/ 均/ 指/ 路径/ 表达式/ ./ 本文/ 的/ 路径/ 表达式/ 是/ 不/ 包含/ 通配符/ “/ / ”/ 的/ XPath/ 表达式/ ,/ 其/ 语法/ 定义/ 如下/ :/ P/ ∷/ =/ e/ |/ ./ |/ // P/ |/ // // P/ |/ P/ // P/ |/ P/ // // P/ |/ P/ [/ P/ ]/ ,/ e/ ∈/ E/ ∪/ A/ ,/ 其中/ ,/ “/ ./ ”/ 表示/ 当前/ 上下文/ 节点/ ;/ “/ // ”/ 和/ “/ // // ”/ 分别/ 表示/ 节点/ 类型/ 之间/ 的/ 直接/ 包含/ 关系/ (/ 父/ -/ 子/ 关系/ )/ 和/ 间接/ 包含/ 关系/ (/ 祖先/ -/ 后代/ 关系/ )/ ;/ “/ [/ ]/ ”/ 中/ 的/ 路径/ 表达式/ 是/ 谓词/ ./ 以/ “/ // ”/ 开始/ 的/ 路径/ 表达式/ 是/ 绝对路径/ ,/ 它/ 从/ 文档/ 的/ 根/ 节点/ 开始/ 定位/ 路径/ ;/ 其它/ 路径/ 表达式/ 为/ 相对路径/ ./ 定义/ 2/ ./ 线性/ 路径/ 表达式/ 的/ 形式/ 为/ P/ =/ c1e1c2e2/ …/ cnen/ ,/ 其中/ ,/ ei/ ∈/ E/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ -/ 1/ )/ ,/ en/ ∈/ E/ ∪/ A/ ,/ ci/ ∈/ {/ // ,/ // // }/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ;/ 特别/ 地/ ,/ 当/ ci/ =/ “/ // ”/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 时/ ,/ P/ 叫作/ 简单/ 路径/ 表达式/ ./ 定义/ 3/ ./ 设/ 线性/ 路径/ 表达式/ P/ =/ c1e1c2e2/ …/ cnen/ ,/ Q/ =/ c1e1c2e2/ …/ cmem/ ,/ 若/ m/ / n/ ,/ ci/ =/ ci/ 且/ ei/ =/ ei/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ ,/ 则/ Q/ 是/ P/ 的/ 路径/ 前缀/ ;/ 当/ m/ =/ n/ 时/ ,/ 称/ P/ 等于/ Q/ ,/ 记为/ P/ =/ Q/ ./ 任何/ 路径/ P/ 都/ 是/ 其/ 自身/ 的/ 路径/ 前缀/ ./ 线性/ 路径/ 表达式/ P/ 中/ 节点/ 类型/ 的/ 个数/ 是/ P/ 的/ 长度/ ,/ 记/ 为/ |/ P/ |/ ./ 下文/ 用/ P/ ∈/ LP/ 表示/ P/ 是/ 一个/ 线性/ 路径/ 表达式/ ./ 类似/ 于/ 文档/ 树/ ,/ 路径/ 表达式/ 也/ 可以/ 表示/ 为/ 树形/ 结构/ ,/ 这种/ 树形/ 结构/ 被/ 叫作/ 树/ 模式/ ./ 图/ 2/ 给出/ 了/ 路径/ 表达式/ // papers/ // paper/ [/ ./ // // section/ ]/ [/ ./ // // section/ // // para/ -/ graph/ ]/ // title/ 的/ 树/ 模式/ ./ 路径/ 表达式/ 中/ 的/ 每个/ 节点/ 类型/ 与/ 树/ 模式/ 中/ 的/ 一个/ 节点/ 相对/ 应/ ,/ 其中/ 实心/ 节点/ 为/ 表达式/ 的/ 返回/ 节点/ ./ 单线/ 边/ (/ 叫作/ 孩子/ 边/ )/ 和/ 双线/ 边/ (/ 叫作/ 后代/ 边/ )/ 分别/ 与/ 表达式/ 中/ 的/ “/ // ”/ 和/ “/ // // ”/ 相对/ 应/ ./ 若/ (/ u/ ,/ v/ )/ 是/ 孩子/ 边/ ,/ 则/ 节点/ v/ 被/ 叫作/ 节点/ u/ 的/ 孩子/ 节点/ ;/ 若/ 从/ u/ 到/ v/ 有/ 一个/ 边/ 序列/ ,/ 则/ 节点/ v/ 被/ 叫作/ 节点/ u/ 的/ 后代/ 节点/ ./ 为了/ 区分/ 绝对路径/ 和/ 相对路径/ ,/ 在/ 树/ 模式/ 中/ 引入/ 了/ 一个/ 根/ 节点/ #./ 和/ 文档/ 树/ 一样/ ,/ lab/ (/ v/ )/ 表示/ 树/ 模式/ 中/ 节点/ v/ 的/ 标签/ ./ 2.3/ 子/ 路径/ 定义/ 4/ ./ / P/ ,/ Q/ ∈/ LP/ ,/ Np/ 和/ Nq/ 分别/ 表示/ P/ 和/ Q/ 的/ 树/ 模式/ 的/ 节点/ 集/ ,/ Q/ 是/ P/ 的/ 子/ 路径/ ,/ 当且/ 仅/ 当/ 存在/ 一个/ 映射/ f/ :/ Nq/ →/ Np/ 满足/ 如下/ 条件/ :/ (/ 1/ )/ 保持/ 节点/ 类型/ ,/ 即/ / v/ ∈/ Nq/ ,/ 若/ lab/ (/ v/ )/ =/ e/ ,/ 则/ lab/ (/ f/ (/ v/ )/ )/ =/ e/ ;/ (/ 2/ )/ 保持/ 边/ 关系/ ,/ 即/ / u/ ,/ v/ ∈/ Nq/ ,/ 若/ (/ u/ ,/ v/ )/ 是/ 孩子/ 边/ ,/ 则/ 在/ P/ 的/ 树/ 模式/ 中/ ,/ f/ (/ v/ )/ 是/ f/ (/ u/ )/ 的/ 孩子/ 节点/ ;/ 若/ (/ u/ ,/ v/ )/ 是/ 后代/ 边/ ,/ 则/ 在/ P/ 的/ 树/ 模式/ 中/ ,/ f/ (/ v/ )/ 是/ f/ (/ u/ )/ 的/ 后代/ 节点/ ./ 根据/ 子/ 路径/ 的/ 定义/ ,/ 线性/ 路径/ 表达式/ “/ // // paper/ // // section/ ”/ 是/ “/ // // paper/ // sections/ // section/ // // paragraph/ ”/ 的/ 子/ 路径/ ,/ 但/ “/ // paper/ // // section/ ”/ 不是/ “/ // // paper/ // sections/ // section/ // // paragraph/ ”/ 的/ 子/ 路径/ ./ 显然/ ,/ 任何/ 路径/ 表达式/ P/ 和/ 其/ 路径/ 前缀/ 都/ 是/ 该/ 路径/ 表达式/ 的/ 子/ 路径/ ,/ 本文/ 使用/ Subpaths/ (/ P/ )/ 表示/ 路径/ 表达式/ P/ 的/ 子/ 路径/ 集/ ./ 3XSICs/ 的/ 定义/ 描述/ 元素/ 或/ 路径/ 之间/ 结构/ 关系/ 的/ 完整性/ 约束/ 叫作/ XML/ 文档/ 的/ 结构/ 完整性/ 约束/ (/ 简称/ XSICs/ )/ ./ Page4XSICs/ 描述/ 元素/ 或/ 路径/ 之间/ 的/ 蕴涵/ 、/ 互斥/ 、/ 同现/ 以及/ 元素/ 之间/ 的/ 结构/ 包含/ 关系/ ./ 这些/ 结构/ 关系/ 可/ 分为/ 两类/ :/ 基于/ 路径/ 的/ XSICs/ 和/ 基于/ 元素/ 的/ XSICs/ ./ 3.1/ 基于/ 路径/ 的/ XSICs/ 基于/ 路径/ 的/ XSICs/ 描述/ 路径/ 之间/ 的/ 蕴涵/ 、/ 互斥/ 和/ 同现/ 关系/ (/ 下文/ 简称/ 为/ 路径/ 约束/ )/ ./ 任意/ 给定/ 一个/ XML/ 文档/ 树/ T/ ,/ V/ 表示/ T/ 中/ 的/ 节点/ 集/ ,/ u/ [/ P/ ]/ 表示/ 在/ T/ 中/ 从/ 节点/ u/ 开始/ 沿着/ 路径/ P/ 可以/ 访问/ 到/ 的/ 节点/ 集/ ./ 若用/ ε/ 表示/ 空/ 路径/ ,/ 则/ u/ [/ ε/ ]/ =/ {/ u/ }/ ,/ r/ [/ ε/ ]/ =/ {/ r/ }/ ./ 路径/ 蕴涵/ 、/ 路径/ 互斥/ 和/ 路径/ 同现/ 定义/ 如下/ ./ 定义/ 5/ ./ / C/ ,/ P/ ,/ Q/ ∈/ LP/ ,/ u/ ,/ v/ ,/ v/ ∈/ V/ ,/ 则/ (/ 1/ )/ 路径/ P/ 蕴涵/ Q/ ,/ 记作/ C/ (/ P/ →/ Q/ )/ ;/ 如果/ / u/ / v/ (/ u/ ∈/ r/ [/ C/ ]/ ∧/ v/ ∈/ u/ [/ P/ ]/ →/ / v/ (/ v/ ∈/ u/ [/ Q/ ]/ )/ )/ ,/ 则/ T/ 满足/ C/ (/ P/ →/ Q/ )/ ,/ 记作/ T/ / C/ (/ P/ →/ Q/ )/ ;/ (/ 2/ )/ 路径/ P/ 与/ Q/ 互斥/ ,/ 记作/ C/ (/ P/ ∨/ Q/ )/ ;/ 如果/ / u/ / v/ (/ u/ ∈/ r/ [/ C/ ]/ ∧/ v/ ∈/ u/ [/ P/ ]/ →/ / / v/ (/ v/ ∈/ u/ [/ Q/ ]/ )/ )/ 且/ / u/ / v/ (/ u/ ∈/ r/ [/ C/ ]/ ∧/ v/ ∈/ u/ [/ Q/ ]/ →/ / / v/ (/ v/ ∈/ u/ [/ P/ ]/ )/ )/ ,/ 则/ T/ 满足/ C/ (/ P/ ∨/ Q/ )/ ,/ 记作/ T/ / C/ (/ P/ ∨/ Q/ )/ ;/ (/ 3/ )/ 路径/ P/ 与/ Q/ 同现/ ,/ 记作/ C/ (/ P/ / Q/ )/ ;/ 如果/ C/ (/ P/ →/ Q/ )/ ∧/ C/ (/ Q/ →/ P/ )/ ,/ 则/ T/ 满足/ C/ (/ P/ / Q/ )/ ,/ 记作/ T/ / C/ (/ P/ / Q/ )/ ./ 其中/ :/ ①/ 路径/ C/ 为/ 约束/ 的/ 上下文/ 路径/ ,/ 它/ 指定/ 路径/ 约束/ 关系/ 在/ 文档/ 树/ 的/ 哪个/ 子/ 树上/ 成立/ ,/ 且/ 规定/ C/ 为/ 简单/ 路径/ 表达式/ ./ 当/ C/ =/ ε/ 时/ ,/ 表明/ 特定/ 的/ 路径/ 约束/ 关系/ 在/ 整个/ 文档/ 树中/ 成立/ ,/ 且/ 上下文/ 路径/ ε/ 可以/ 被/ 缺省/ ./ ②/ P/ 和/ Q/ 分别/ 叫作/ 约束/ 的/ 前件/ 路径/ 和/ 后件/ 路径/ ;/ C/ 是/ P/ 和/ Q/ 的/ 公共/ 路径/ 前缀/ ./ 当/ |/ P/ |/ =/ |/ Q/ |/ =/ |/ C/ |/ +/ 1/ 时/ ,/ 路径/ 蕴涵/ 、/ 互斥/ 和/ 同现/ 表示/ 兄弟/ 元素/ 之间/ 的/ 蕴涵/ 、/ 互斥/ 和/ 同现/ ./ 为了/ 书写/ 简单/ ,/ 在/ 约束/ 实例/ 中/ 通常/ 将/ P/ 和/ Q/ 写成/ 相对/ 于/ C/ 的/ 相对路径/ ./ 例如/ :/ 在/ 图/ 1/ 所示/ 的/ XML/ 文档/ 树中/ ,/ 如下/ 路径/ 约束/ 成立/ :/ φ/ 1/ // papers/ // paper/ (/ subtitle/ →/ authors/ // author/ // name/ )/ φ/ 2/ // papers/ // paper/ (/ title/ / ./ // // author/ // name/ )/ φ/ 3/ // papers/ // paper/ (/ type/ // jourpaper/ ∨/ conference/ )/ 通俗/ 地/ 讲/ ,/ 路径/ 蕴涵/ C/ (/ P/ →/ Q/ )/ 表示/ 在/ C/ 所/ 确定/ 的/ XML/ 文档/ 子/ 树上/ ,/ 如果/ 路径/ P/ 存在/ ,/ 那么/ 路径/ Q/ 也/ 一定/ 出现/ ;/ 如果/ 两个/ 路径/ 相互/ 蕴涵/ 则/ 称/ 这/ 两个/ 路径/ 同现/ ;/ 路径/ 互斥/ C/ (/ P/ ∨/ Q/ )/ 则/ 表示/ 在/ C/ 所/ 确定/ 的/ XML/ 文档/ 子/ 树上/ 路径/ P/ 与/ 路径/ Q/ 不能/ 同时/ 出现/ ./ 3.2/ 基于/ 元素/ 的/ XSICs/ 基于/ 元素/ 的/ XSICs/ 描述/ 了/ 元素/ 之间/ 的/ 蕴涵/ 、/ 互斥/ 、/ 同现/ 和/ 结构/ 包含/ 关系/ ./ 由于/ 元素/ 之间/ 的/ 蕴涵/ 、/ 互斥/ 和/ 同现/ 关系/ 是/ 路径/ 蕴涵/ 、/ 互斥/ 和/ 同现/ 关系/ 的/ 特例/ ,/ 因此/ ,/ 这里/ 只/ 讨论/ 元素/ 的/ 结构/ 包含/ 关系/ ./ 根据/ 元素/ 的/ 结构/ 包含/ 关系/ 在/ 查询/ 优化/ 中/ 的/ 不同/ 作用/ ,/ 将/ 其/ 分为/ 排他性/ 包含/ 和/ 必需/ 性/ 包含/ (/ 下文/ 简称/ 为/ 元素/ 包含/ 约束/ )/ ,/ 定义/ 如下/ ./ 定义/ 6/ ./ / P/ ,/ Q/ ∈/ LP/ ,/ ei/ ∈/ E/ ,/ ej/ ∈/ E/ ∪/ A/ ,/ u/ ,/ v/ ,/ v1/ ,/ v2/ ∈/ V/ ,/ 则/ (/ 1/ )/ 元素/ ei/ 必需/ 包含/ ej/ ,/ 记作/ ei/ / ej/ ;/ 如果/ / u/ (/ lab/ (/ u/ )/ =/ ei/ →/ / v/ (/ lab/ (/ v/ )/ =/ ej/ ∧/ v/ ∈/ u/ [/ P/ ]/ )/ )/ ,/ 则/ T/ 满足/ ei/ / ej/ ,/ 记作/ T/ / ei/ / ej/ ;/ (/ 2/ )/ 元素/ ei/ 排/ 他/ 包含/ ej/ ,/ 记作/ ei/ / ej/ ;/ 如果/ / u/ (/ lab/ (/ u/ )/ =/ ei/ ∧/ / v1/ / v2/ (/ v1/ ∈/ u/ [/ P/ ]/ ∧/ v2/ ∈/ u/ [/ Q/ ]/ ∧/ lab/ (/ v1/ )/ =/ lab/ (/ v2/ )/ =/ ej/ )/ →/ P/ =/ Q/ )/ ,/ 则/ T/ 满足/ ei/ / ej/ ,/ 记作/ T/ / ei/ / ej/ ./ 例如/ :/ 在/ 图/ 1/ 所示/ 的/ XML/ 文档/ 中/ ,/ 下列/ 约束/ 成立/ :/ 定理/ 1/ ./ / ei/ ,/ ej/ ∈/ E/ ,/ / ek/ ∈/ E/ ∪/ A/ ,/ 如果/ ei/ / ej/ 这个/ 定理/ 说明/ 了/ 必需/ 性/ 包含/ 的/ 传递性/ ,/ 其/ 正确/ 且/ ej/ / ek/ ,/ 则/ ei/ / ek/ ./ 性是/ 显然/ 的/ ./ 3.3/ XSICs/ 的/ 约束/ 重写/ 为了/ 便于/ 推理/ ,/ 本文/ 将/ 元素/ 包含/ 约束/ 、/ 路径/ 同现/ 和/ 路径/ 互斥/ 约束/ 表示/ 为/ 等价/ 的/ 路径/ 蕴涵/ 约束/ ./ 由于/ 路径/ 同现/ 是/ 双向/ 的/ 路径/ 蕴涵/ ,/ 因此/ ,/ 下面/ 着重/ 讨论/ 路径/ 互斥/ 约束/ 和/ 元素/ 包含/ 约束/ 的/ 约束/ 重写/ 问题/ ./ 3.3/ ./ 1/ 路径/ 互斥/ 的/ 约束/ 重写/ 如前所述/ ,/ 路径/ 互斥/ C/ (/ P/ ∨/ Q/ )/ 表示/ 在/ C/ 所/ 确定/ 的/ XML/ 文档/ 子/ 树上/ ,/ 一个/ 路径/ P/ 存在/ 必然/ 排斥/ 另/ 一个/ 路径/ Q/ 的/ 存在/ ./ 为了/ 使用/ 路径/ 蕴涵/ 表示/ 这样/ 的/ 语义/ ,/ 引入/ 了/ “/ 逻辑/ 非/ ”/ 运算符/ “/ / ”/ ,/ 即/ / P/ 表示/ P/ 不/ 存在/ ./ 这样/ C/ (/ P/ ∨/ Q/ )/ 就/ 可以/ 表示/ 为/ C/ (/ (/ P/ →/ / Q/ )/ ∧/ (/ Q/ →/ / P/ )/ )/ ./ 引入/ “/ 逻辑/ 非/ ”/ 运算符/ 后/ ,/ 线性/ 路径/ 表达式/ 和/ 线性/ 路径/ 表达式/ 集/ 之间/ 的/ 成员/ 关系/ 定义/ 如下/ :/ 给定/ 任意/ 线性/ 路径/ 表达式/ 集/ B/ 和/ 一个/ 线性/ 路径/ 表达式/ Q/ ,/ Q/ ∝/ B/ 当且/ 仅/ 当/ P/ ∈/ B/ 且/ Q/ ∈/ Subpaths/ (/ P/ )/ ;/ / Q/ ∝/ B/ 当且/ 仅/ 当/ / P/ ∈/ B/ 且/ P/ ∈/ Subpaths/ (/ Q/ )/ ./ 3.3/ ./ 2/ 必需/ 性/ 包含/ 和/ 排他性/ 包含/ 的/ 约束/ 重写/ 由于/ 元素/ 包含/ 约束/ 与/ 路径/ 约束/ 之间/ 的/ 相互作用/ ,/ 如何/ 将/ 两类/ 约束/ 有机/ 地/ 结合/ 起来/ 是/ 进行/ XSICsPage5/ 推理/ 的/ 一个/ 必要条件/ ./ 在/ 关系数据库/ 中/ ,/ 通常/ 采用/ chase/ 技术/ 改写/ 查询/ 使/ 之/ 包含/ 完整性/ 约束/ 的/ 作用/ [/ 14/ ]/ ./ 本文/ 采用/ 同样/ 的/ 技术/ 改写/ 路径/ 约束/ 集使/ 其/ 集成/ 元素/ 包含/ 约束/ 的/ 作用/ ./ 下面/ 的/ 定理/ 陈述/ 了/ 元素/ 包含/ 约束/ 与/ 路径/ 蕴涵/ 之间/ 的/ 关系/ ./ 示/ P/ 中/ 的/ 节点/ 类型/ 集/ ,/ 则/ 有/ 定理/ 2/ ./ 令/ P/ =/ c1e1c2e2/ …/ ckek/ ,/ 用/ Nodes/ (/ P/ )/ 表/ (/ 1/ )/ 若/ ei/ / ej/ 且/ ei/ ,/ ej/ ∈/ Nodes/ (/ P/ )/ (/ i/ </ j/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ -/ 1/ ,/ j/ =/ 2/ ,/ …/ ,/ k/ )/ ,/ 则/ c1e1/ …/ ciei/ // // ej/ …/ ckek/ →/ P/ ;/ (/ 2/ )/ 若/ ek/ -/ 1/ / ek/ 且/ ek/ -/ 1/ ,/ ek/ ∈/ Nodes/ (/ P/ )/ ,/ 则/ c1e1c2e2/ …/ ck/ -/ 1ek/ -/ 1/ →/ P/ ;/ (/ 3/ )/ 若/ ei/ / en/ 且/ ei/ ∈/ Nodes/ (/ P/ )/ ∧/ en/ / Nodes/ (/ P/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ,/ 则/ P/ →/ c1e1c2e2/ …/ ciei/ // // en/ ./ 证明/ ./ (/ 1/ )/ 从/ 排他性/ 包含/ 的/ 定义/ 可以/ 直接/ 得出/ 这个/ 结论/ 是/ 正确/ 的/ ./ (/ 2/ )/ 假设/ ek/ -/ 1/ / ek/ 成立/ ,/ 而/ c1e1c2e2/ …/ ck/ -/ 1ek/ -/ 1/ →/ P/ 不/ 成立/ ,/ 则/ 在/ XML/ 文档/ 中/ 路径/ c1e1c2e2/ …/ ck/ -/ 1ek/ -/ 1/ 存在/ 时/ P/ 不/ 一定/ 存在/ ,/ 即/ 在/ 该/ 文档/ 中/ 有无/ ek/ 作为/ 后代/ 节点/ 的/ ek/ -/ 1/ 节点/ 存在/ ,/ 这/ 与/ 假设/ ek/ -/ 1/ / ek/ 相/ 矛盾/ ,/ 因此/ 假设/ 不/ 成立/ ./ (/ 3/ )/ 从/ 必需/ 性/ 包含/ 的/ 定义/ 可以/ 直接/ 得出/ 这个/ 结论/ 也/ 是/ 正确/ 的/ ./ 从/ 这个/ 定理/ 出发/ ,/ 可以/ 直接/ 得到/ 一个/ 使用/ 元素/ 包含/ 约束/ chase/ 路径/ 约束/ 集/ 的/ 方法/ ./ 给定/ 一个/ 元素/ 包含/ 约束/ 集/ Ω/ 和/ 一个/ 路径/ 约束/ 集/ Σ/ ,/ 首先/ 计算/ 约束/ 集/ Ω/ 的/ 闭包/ Closure/ (/ Ω/ )/ ,/ 然后/ 使用/ Closure/ (/ Ω/ )/ 改写/ 路径/ 约束/ 集/ Σ/ 使/ 之/ 集成/ 元素/ 包含/ 约束/ 的/ 作用/ ./ 方法/ 如下/ :/ (/ 1/ )/ 首先/ 使用/ 约束/ 集/ Ω/ 初始化/ Closure/ (/ Ω/ )/ ,/ 然后/ 根据/ 定理/ 1/ 检查/ Closure/ (/ Ω/ )/ 中/ 的/ 每个/ 约束/ :/ 如果/ ei/ / ej/ 且/ ej/ / ek/ ,/ 则/ 在/ Closure/ (/ Ω/ )/ 中/ 添加/ 约束/ ei/ / ek/ ,/ 直到/ Closure/ (/ Ω/ )/ 不再/ 发生变化/ 为止/ ./ (/ 2/ )/ 依次/ 检查/ Σ/ 中/ 的/ 每个/ 路径/ 表达式/ P/ =/ c1e1c2e2/ …/ ckek/ ,/ 若/ ei/ / ej/ ∈/ Closure/ (/ Ω/ )/ 且/ ei/ ,/ ej/ ∈/ Nodes/ (/ P/ )/ (/ i/ </ j/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ -/ 1/ ,/ j/ =/ 2/ ,/ 3/ ,/ …/ ,/ k/ )/ ,/ 则/ 将/ c1e1/ …/ ciei/ // // ej/ …/ ckek/ →/ P/ 添加/ 到/ Σ/ 中/ ;/ 若/ ek/ -/ 1/ / ek/ 且/ ek/ -/ 1/ ,/ ek/ ∈/ Nodes/ (/ P/ )/ ,/ 则/ 将/ c1e1c2e2/ …/ ck/ -/ 1ek/ -/ 1/ →/ P/ 添加/ 到/ Σ/ 中/ ;/ 若有/ ei/ / en/ ∈/ Closure/ (/ Ω/ )/ 且/ ei/ ∈/ Nodes/ (/ P/ )/ ∧/ en/ / Nodes/ (/ P/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ,/ 则/ 将/ P/ →/ c1e1c2e2/ …/ ciei/ // // en/ 添加/ 到/ Σ/ 中/ ./ (/ 3/ )/ 重复/ (/ 2/ )/ 的/ 操作/ ,/ 直到/ 路径/ 约束/ 集/ Σ/ 不/ 发生变化/ 为止/ ./ 例/ 1/ ./ 给定/ 约束/ 集/ Σ/ =/ {/ φ/ 1/ ,/ φ/ 2/ ,/ φ/ 3/ }/ 和/ Ω/ =/ {/ φ/ 4/ ,/ φ/ 5/ ,/ φ/ 6/ }/ ,/ 其中/ ,/ φ/ 1/ 、/ φ/ 2/ 和/ φ/ 3/ 为/ 3.1/ 节中/ 的/ 路径/ 约束/ ,/ φ/ 4/ 、/ φ/ 5/ 和/ φ/ 6/ 为/ 3.2/ 节中/ 的/ 元素/ 包含/ 约束/ ,/ 使用/ 我们/ 的/ chase/ 技术/ 得/ Closure/ (/ Ω/ )/ =/ {/ φ/ 4/ ,/ φ/ 5/ ,/ φ/ 6/ ,/ paper/ / name/ }/ ;/ chase/ 后/ 的/ 路径/ 约束/ 集/ Σ/ =/ {/ φ/ 1/ ,/ φ/ 2/ ,/ φ/ 3/ ,/ // papers/ // paper/ // // author/ →/ // papers/ // papaer/ // // author/ // name/ ,/ // papers/ // paper/ →/ // papers/ // paper/ // // name/ ,/ // papers/ // paper/ // authors/ // author/ →/ // papers/ // paper/ // authors/ // author/ // name/ ,/ // papers/ // paper/ →/ // papers/ // paper/ // // author/ ,/ // papers/ // paper/ // // author/ // name/ →/ // papers/ // paper/ // authors/ // author/ // name/ }/ ./ 4XSICs/ 的/ 逻辑/ 蕴涵/ 类似/ 于/ 关系数据库/ 中/ 的/ 函数/ 依赖/ ,/ XSICs/ 之间/ 也/ 存在/ 逻辑/ 蕴涵/ 问题/ ,/ XSICs/ 逻辑/ 蕴涵/ 的/ 定义/ 及/ 相关/ 概念/ 如下/ ./ 定义/ 7/ ./ 给定/ 一个/ XSICs/ 集/ Σ/ 和/ 一个/ XSICs/ φ/ ,/ 如果/ 每/ 一个/ 满足/ Σ/ 的/ XML/ 文档/ 也/ 满足/ φ/ ,/ 则/ 称/ Σ/ 逻辑/ 蕴涵/ φ/ ,/ 记/ 为/ Σ/ / φ/ ;/ 一个/ XML/ 文档/ T/ 满足/ 一个/ XSIC/ 集/ Σ/ ,/ 记为/ T/ / Σ/ ./ 定义/ 8/ ./ 给定/ 一个/ XSICs/ 集/ Σ/ ,/ 被/ Σ/ 所/ 蕴涵/ 的/ XSICs/ 集合/ 叫作/ Σ/ 的/ 闭包/ ,/ 记/ 为/ Σ/ +./ 使用/ 3.3/ 节中/ 的/ 约束/ 重写/ 技术/ ,/ 可以/ 将/ 所有/ 的/ 约束/ 改写/ 为/ 路径/ 蕴涵/ 约束/ ./ 因此/ ,/ XSICs/ 逻辑/ 蕴涵/ 问题/ 被/ 转化/ 为/ 路径/ 蕴涵/ 约束/ 的/ 逻辑/ 蕴涵/ 问题/ ./ 解决/ 逻辑/ 蕴涵/ 最/ 有效/ 的/ 方法/ 是/ 给出/ 一个/ 有效/ 的/ 、/ 完备/ 的/ 推理/ 规则/ ./ 不失/ 一般性/ ,/ 下面/ 给出/ 了/ 一个/ 路径/ 蕴涵/ 约束/ 的/ 推理/ 规则/ 集/ ,/ 并/ 证明/ 这个/ 推理/ 规则/ 集/ 的/ 有效性/ 和/ 完备/ 性/ ./ 4.1/ XSICs/ 的/ 推理/ 规则/ C/ (/ P/ →/ Q/ )/ ./ C/ (/ P/ →/ / Q/ )/ ./ 规则/ 1/ ./ C/ (/ P/ →/ Q/ )/ ,/ C/ ∈/ Subpaths/ (/ C/ )/ / 规则/ 2/ ./ C/ (/ P/ →/ / Q/ )/ ,/ C/ ∈/ Subpaths/ (/ C/ )/ / 规则/ 3/ ./ C/ (/ P/ →/ Q/ )/ ,/ C/ (/ Q/ →/ S/ )/ / C/ (/ P/ →/ S/ )/ ./ 规则/ 4/ ./ C/ (/ P/ →/ Q/ )/ ,/ C/ (/ Q/ →/ / S/ )/ / C/ (/ P/ →/ / S/ )/ ./ 规则/ 5/ ./ C/ (/ P/ →/ / Q/ )/ ,/ C/ (/ S/ →/ Q/ )/ / C/ (/ P/ →/ / S/ )/ ./ 规则/ 6/ ./ / P/ ,/ Q/ ∈/ LP/ ,/ Q/ ∈/ Subpaths/ (/ P/ )/ / P/ →/ Q/ ./ 4.2/ 推理/ 规则/ 的/ 有效性/ 推理/ 规则/ 的/ 有效性/ 是/ 指/ 每个/ 能/ 由/ XSICs/ 集/ Σ/ 使用/ 推理/ 规则/ 推导/ 出来/ 的/ 路径/ 蕴涵/ 约束/ 一定/ 被/ Σ/ Page6/ 所/ 逻辑/ 蕴涵/ ,/ 也就是说/ 这些/ 推理/ 规则/ 是/ 正确/ 的/ ./ 定理/ 3/ ./ 推理/ 规则/ 1/ ~/ 规则/ 6/ 是/ 正确/ 的/ ./ (/ 1/ )/ 规则/ 1/ 、/ 2/ 的/ 正确性/ 规则/ 1/ 的/ 正确性/ 是/ 显然/ 的/ ./ 根据/ 路径/ 约束/ 的/ 定义/ ,/ 上下文/ 路径/ 为/ 简单/ 路径/ 表达式/ ./ 这种/ 情况/ 下/ ,/ 路径/ C/ 确定/ 的/ 子树/ 一定/ 在/ 其子/ 路径/ C/ 所/ 确定/ 的/ 子树/ 范围/ 内/ ,/ 既然/ 在/ C/ 所/ 确定/ 的/ 子/ 树上/ P/ 出现/ 时/ Q/ 一定/ 出现/ ,/ 那么/ 在/ 包含/ 该子/ 树/ 的/ 子/ 树上/ P/ 出现/ 时/ Q/ 也/ 一定/ 出现/ ./ 类似/ 于/ 规则/ 1/ ,/ 在/ XML/ 文档/ 树上/ ,/ 路径/ C/ 所/ 确定/ 的/ 子树/ 一定/ 在/ 其子/ 路径/ C/ 所/ 确定/ 的/ 子树/ 范围/ 内/ ,/ 在/ C/ 所/ 确定/ 的/ 子/ 树上/ P/ 出现/ 时/ Q/ 不/ 出现/ ,/ 那么/ 在/ 该子/ 树上/ 的/ 任何/ 子/ 树上/ P/ 出现/ 时/ Q/ 也/ 不会/ 出现/ ./ 因此/ ,/ 规则/ 2/ 也/ 是/ 正确/ 的/ ./ 得到/ ./ 这里/ 不再/ 赘述/ ./ (/ 2/ )/ 规则/ 3/ 、/ 4/ 的/ 正确性/ 规则/ 3/ 、/ 4/ 的/ 正确性/ 可以/ 直接/ 从/ 路径/ 蕴涵/ 的/ 语义/ (/ 3/ )/ 规则/ 5/ 的/ 正确性/ 证明/ ./ 假设/ C/ (/ P/ →/ / Q/ )/ 和/ C/ (/ S/ →/ Q/ )/ 成立/ ,/ 但/ C/ (/ P/ →/ / S/ )/ 不/ 成立/ ,/ 则/ 至少/ 在/ 一个/ C/ 确定/ 的/ XML/ 文档/ 子/ 树上/ (/ 记作/ Ts/ )/ ,/ P/ 和/ S/ 同时/ 存在/ ;/ 又/ 因为/ C/ (/ S/ →/ Q/ )/ 成立/ ,/ 因此/ ,/ 在/ 这个/ 子树/ Ts/ 上/ ,/ P/ 和/ Q/ 同时/ 存在/ ./ 这/ 与/ C/ (/ P/ →/ / Q/ )/ 相/ 矛盾/ ,/ 故/ 假设/ 不/ 成立/ ./ (/ 4/ )/ 规则/ 6/ 的/ 正确性/ 规则/ 6/ 陈述/ 了/ 这样/ 的/ 事实/ ,/ 在/ XML/ 文档/ 的/ 任何/ 子/ 树上/ ,/ 一个/ 路径/ 存在/ ,/ 其子/ 路径/ 必然/ 存在/ ./ 其/ 正确性/ 也/ 是/ 显然/ 的/ ./ 4.3/ 推理/ 规则/ 的/ 完备/ 性/ 4.3/ ./ 1/ 路径/ 蕴涵/ 闭包/ 闭包/ 的/ 概念/ ./ 定义/ 9/ ./ 给定/ 一个/ XSICs/ 集/ Σ/ 和/ 一个/ 上下文/ 路径/ C/ ,/ 路径/ P/ 关于/ Σ/ 和/ C/ 的/ 路径/ 蕴涵/ 闭包/ 是/ 在/ Σ/ 和/ C/ 下/ 路径/ P/ 所/ 蕴涵/ 的/ 全部/ 路径/ 的/ 最小/ 集/ ,/ 记为/ P/ +/ (/ Σ/ ,/ C/ )/ ,/ 即/ P/ +/ (/ Σ/ ,/ C/ )/ =/ {/ X/ |/ C/ (/ P/ →/ X/ )/ 可/ 使用/ 推理/ 规则/ 从/ Σ/ 推出/ ,/ 其中/ X/ ∈/ {/ Q/ ,/ / Q/ }/ }/ ./ 令/ Δ/ 为/ 路径/ 约束/ 集/ ,/ Ω/ 为/ 元素/ 包含/ 约束/ 集/ ,/ Σ/ =/ Δ/ ∪/ Ω/ ,/ Last/ (/ P/ )/ 表示/ P/ 的/ 最后/ 一个/ 节点/ 类型/ ./ P/ +/ (/ Σ/ ,/ C/ )/ 的/ 计算/ 算法/ 如下/ ./ 为了/ 证明/ 推理/ 规则/ 的/ 完备/ 性/ ,/ 引入/ 了/ 路径/ 蕴涵/ 算法/ 1/ ./ Closure/ -/ Comp/ (/ Σ/ ,/ C/ ,/ P/ )/ ./ 输入/ :/ non/ -/ empty/ Σ/ ,/ C/ ,/ P/ ∈/ LP/ 输出/ :/ P/ +/ (/ Σ/ ,/ C/ )/ ifConstraint/ -/ Rewrite/ (/ Δ/ )/ =/ =/ / thenreturn/ / ;/ Σ/ =/ Constraint/ -/ Chase/ (/ Δ/ ,/ Closure/ (/ Ω/ )/ )/ ;/ i/ =/ 0/ ;/ A/ =/ / ;/ Bi/ =/ {/ P/ }/ ;/ Bi/ +/ 1/ =/ / ;/ if/ (/ P/ / Δ/ ei/ ∈/ Nodes/ (/ P/ )/ ei/ / ex/ ∈/ Σ/ )/ ifei/ =/ Last/ (/ P/ )/ thenBi/ =/ {/ P/ // // ex/ }/ ;/ elseforeach/ φ/ =/ =/ C/ (/ P/ →/ Q/ )/ ∈/ Σ/ if/ (/ C/ ∈/ Subpaths/ (/ C/ )/ ‖/ C/ =/ =/ ε/ )/ thenA/ =/ A/ ∪/ {/ φ/ }/ ;/ foreach/ φ/ =/ =/ C/ (/ P/ →/ / Q/ )/ ∈/ Σ/ if/ (/ C/ ∈/ Subpaths/ (/ C/ )/ )/ thenA/ =/ A/ ∪/ {/ φ/ }/ ;/ // / 规则/ 2/ / // dowhileBi/ ≠/ Bi/ -/ 1i/ =/ i/ +/ 1/ ;/ Bi/ =/ Bi/ -/ 1/ ;/ foreachX/ ∈/ Biforeach/ φ/ =/ =/ C/ (/ P/ →/ Y/ )/ ∈/ A/ // / 对/ Bi/ 进行/ 最小化/ 处理/ / // foreachP/ ∈/ Biif/ (/ Q/ ∈/ BiQ/ ∈/ Subpaths/ (/ P/ )/ )/ thenBi/ =/ Bi/ -/ {/ Q/ }/ foreach/ / P/ ∈/ Biif/ (/ / Q/ ∈/ BiP/ ∈/ Subpaths/ (/ Q/ )/ )/ thenBi/ =/ Bi/ -/ {/ Q/ }/ returnBi/ ./ 算法/ 2/ ./ Constraint/ -/ Rewrite/ (/ Δ/ )/ ./ 输入/ :/ 非空/ 路径/ 约束/ 集/ Δ/ 输出/ :/ 改写/ 成/ 路径/ 蕴涵/ 形式/ 的/ 约束/ 集/ Δ/ foreach/ φ/ ∈/ Δ/ if/ φ/ =/ =/ C/ (/ P/ / Q/ )/ thenreplace/ φ/ withC/ (/ P/ →/ Q/ )/ ,/ C/ (/ Q/ →/ P/ )/ ;/ if/ φ/ =/ =/ C/ (/ P/ ∨/ Q/ )/ thenif/ |/ C/ |/ =/ 1thenreturn/ / elsereplace/ φ/ withC/ (/ P/ →/ / Q/ )/ ,/ C/ (/ Q/ →/ / P/ )/ ;/ return/ Δ/ ./ 算法/ Constraint/ -/ Rewrite/ (/ Δ/ )/ 将/ 路径/ 同现/ 和/ 路径/ 互斥/ 约束/ 改写/ 为/ 路径/ 蕴涵/ 约束/ ./ 算法/ Constraint/ -/ Chase/ (/ Δ/ ,/ Closure/ (/ Ω/ )/ )/ 使用/ 元素/ 包含/ 约束/ chase/ 的/ 路径/ 约束/ 集/ Δ/ ,/ 使/ 其/ 集成/ 元素/ 包含/ 约束/ 的/ 作用/ ./ 由于/ chase/ 过程/ 中/ 不能/ 处理/ Δ/ 中/ 没有/ 路径/ P/ 时/ 元素/ 包含/ 约束/ 对/ Δ/ 的/ 影响/ ,/ 因此/ ,/ 在/ 对/ Bi/ 进行/ 初始化/ 时/ 考虑/ 了/ 这种/ 情况/ ./ Page7/ 路径/ P/ 关于/ Σ/ 和/ C/ 的/ 路径/ 蕴涵/ 闭包/ 是/ 在/ Σ/ 和/ C/ 下/ P/ 所/ 蕴涵/ 的/ 全部/ 路径/ 的/ 最小/ 集/ ./ 也就是说/ ,/ 任何/ 路径/ 及其/ 子/ 路径/ (/ 路径/ 的/ 否定/ 及其/ 子/ 路径/ 的/ 否定/ )/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 仅/ 出现/ 一次/ ./ 此外/ ,/ 一个/ 路径/ Q/ 及其/ 否定/ 形式/ / Q/ 也/ 不/ 可能/ 同时/ 出现/ 在/ 路径/ 蕴涵/ 闭包/ P/ +/ (/ Σ/ ,/ C/ )/ 中/ ,/ 否则/ 该/ 约束/ 集是/ 不/ 一致/ 的/ ./ 第/ 5/ 节将/ 讨论/ 结构/ 完整/ 约束/ 集/ 的/ 一致性/ 问题/ ,/ 这里/ 不妨/ 先/ 假设/ 给定/ 的/ 约束/ 集是/ 一致/ 的/ ./ 4.3/ ./ 2/ 完备/ 性/ 证明/ 引理/ 1/ ./ φ/ :/ C/ (/ P/ →/ X/ )/ (/ X/ ∈/ {/ Q/ ,/ / Q/ }/ )/ 可以/ 使用/ XSICs/ 推理/ 规则/ 从/ Σ/ 中/ 推出/ 当且/ 仅/ 当/ X/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 这个/ 引理/ 的/ 证明/ 可以/ 直接/ 从/ 路径/ 蕴涵/ 闭包/ 的/ 定义/ 得出/ ./ 引理/ 2/ ./ 令/ X/ ∈/ {/ Q/ ,/ / Q/ }/ ,/ 如果/ P/ 不/ 出现/ 在/ 文档/ 树/ T/ 中/ ,/ 则/ 对/ T/ 中/ 的/ 任意/ 线性/ 路径/ C/ 和/ Q/ ,/ 都/ 有/ T/ / C/ (/ P/ →/ X/ )/ 成立/ ;/ 如果/ C/ 不/ 出现/ 在/ 文档/ T/ 中/ ,/ 则/ 对/ T/ 中/ 的/ 任意/ 线性/ 路径/ P/ 和/ Q/ ,/ 都/ 有/ T/ / C/ (/ P/ →/ X/ )/ 成立/ ./ 证明/ ./ 由于/ C/ (/ P/ →/ Q/ )/ (/ 或/ C/ (/ P/ →/ / Q/ )/ )/ 表示/ 对/ 任何/ 满足/ C/ (/ P/ →/ Q/ )/ (/ 或/ C/ (/ P/ →/ / Q/ )/ )/ 的/ XML/ 文档/ ,/ 在/ C/ 所/ 确定/ 的/ 文档/ 子/ 树上/ ,/ 如果/ 路径/ P/ 出现/ ,/ 则/ 路径/ Q/ 一定/ 出现/ (/ 或/ 不/ 出现/ )/ ;/ 但/ 如果/ 路径/ P/ 不/ 出现/ ,/ 那么/ 无论/ 路径/ Q/ 是否/ 出现/ ,/ 也/ 无论/ 出现/ 什么样/ 的/ 路径/ Q/ ,/ C/ (/ P/ →/ Q/ )/ (/ 或/ C/ (/ P/ →/ / Q/ )/ )/ 都/ 成立/ ,/ 这/ 既/ 符合/ 逻辑/ 也/ 符合/ 路径/ 蕴涵/ 的/ 语义/ 要求/ ./ 同理/ ,/ 如果/ 路径/ C/ 不/ 出现/ 在/ 文档/ 中/ ,/ 则/ 不论/ 出现/ 什么样/ 的/ 路径/ P/ 和/ Q/ ,/ 也/ 不论/ P/ 和/ Q/ 以/ 什么样/ 的/ 关系/ 出现/ ,/ T/ / C/ (/ P/ →/ X/ )/ 都/ 成立/ ./ 定理/ 4/ ./ 推理/ 规则/ 1/ ~/ 规则/ 6/ 是/ 完备/ 的/ ./ 推理/ 规则/ 的/ 完备/ 性是/ 指/ 给定/ 一个/ 路径/ 蕴涵/ 约束/ 集/ Σ/ ,/ 对/ 任何/ 一个/ 路径/ 蕴涵/ 约束/ φ/ ,/ 如果/ Σ/ / φ/ ,/ 则/ φ/ 一定/ 能/ 使用/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 从/ Σ/ 中/ 推出/ ./ 根据/ 逆否命题/ 的/ 等价/ 性/ ,/ 如果/ 某个/ 路径/ 蕴涵/ φ/ :/ C/ (/ P/ →/ X/ )/ (/ X/ ∈/ {/ Q/ ,/ / Q/ }/ )/ 不能/ 使用/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 从/ Σ/ 推出/ ,/ 则/ φ/ 一定/ 不/ 为/ Σ/ 所/ 逻辑/ 蕴涵/ ./ 也就是说/ 至少/ 存在/ 一个/ XML/ 文档/ 树/ T/ ,/ 使得/ T/ / Σ/ ,/ 但/ T/ |/ ≠/ φ/ ./ 证明/ ./ 假设/ φ/ :/ C/ (/ P/ →/ Q/ )/ (/ 或/ φ/ :/ C/ (/ P/ →/ / Q/ )/ )/ 不能/ 使用/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 从/ Σ/ 推出/ ,/ 证明/ 存在/ 一个/ XML/ 文档/ 树/ 实例/ T/ ,/ T/ 满足/ Σ/ 但/ 不/ 满足/ φ/ ./ (/ 1/ )/ 采用/ 下列/ 方式/ 构造/ 一个/ XML/ 文档/ 树/ T/ ,/ 使得/ P/ +/ (/ Σ/ ,/ C/ )/ 中除/ Q/ (/ 或/ / Q/ )/ 以外/ 的/ 所有/ 路径/ 出现/ 在/ T/ 上/ ./ ①/ 将/ P/ +/ (/ Σ/ ,/ C/ )/ 分为/ 两个/ 子集/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 和/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ ,/ 其/ 方法/ 如下/ :/ 中/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 为/ 所有/ 无/ 逻辑/ 非/ 符号/ 的/ 路径/ 的/ 集合/ ,/ 表示/ 被/ P/ 蕴涵/ 的/ 所有/ 路径/ ;/ 后者/ 是/ 带/ 逻辑/ 非/ 符号/ 的/ 路径/ 组成/ 的/ 集合/ ,/ 表示/ 在/ 路径/ C/ 所/ 确定/ 的/ 子/ 树上/ 被/ P/ 排斥/ 的/ 所有/ 路径/ ;/ ②/ 从/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ (/ 或/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ )/ 中/ 删除/ 路径/ Q/ (/ 或/ / Q/ )/ ,/ 若/ φ/ :/ C/ (/ P/ →/ Q/ )/ ,/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 查找/ 路径/ Q/ ;/ 如果/ 无/ Q/ ,/ 则/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 查找/ 满足/ Q/ ∈/ Subpaths/ (/ Q/ )/ 的/ Q/ ;/ 若/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中有/ Q/ (/ 或/ Q/ )/ ,/ 则/ 从/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 删除/ (/ Q/ 或/ Q/ )/ ;/ 若/ φ/ :/ C/ (/ P/ →/ / Q/ )/ ,/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 中/ 查找/ 路径/ / Q/ ;/ 如果/ 无/ / Q/ ,/ 则/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 查找/ 满足/ Q/ ∈/ Subpaths/ (/ Q/ )/ 的/ / Q/ ;/ 若/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 中有/ / Q/ (/ 或/ / Q/ )/ ,/ 则/ 从/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 中/ 删除/ / Q/ (/ 或/ / Q/ )/ ,/ 且/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 添加/ Q/ (/ 或/ Q/ )/ ./ 如果/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 中/ 找/ 不到/ / Q/ 和/ / Q/ ,/ 则/ 直接/ 在/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 添加/ Q/ ./ ③/ 建立/ 一个/ 文档/ 节点/ D/ ,/ 将/ C/ 的/ 第一个/ 节点/ 类型/ 作为/ 文档/ 的/ 根/ 元素/ 节点/ 连接/ 到/ D/ 上/ ,/ 依次/ 为/ C/ 中/ 的/ 其它/ 元素/ 类型/ 各/ 建立/ 一个/ 节点/ ,/ 并用/ 单线/ 连接/ ./ ④/ 将/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 的/ 路径/ 按/ 其/ 路径/ 表达式/ 规定/ 的/ 结构/ 关系/ 连接/ 在/ 文档/ 的/ C/ 子/ 树上/ ,/ 构成/ 一个/ 子树/ T1/ ;/ 连接/ 方法/ 如下/ :/ i/ ./ 对/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ 中/ 的/ 每个/ 路径/ S/ ,/ 将/ 其/ 转换/ 为/ 以/ C/ 为/ 上下文/ 路径/ 的/ 相对路径/ ,/ 为/ S/ 的/ 第一个/ 节点/ 类型/ 建立/ 一个/ 节点/ 并/ 将/ 其/ 连接/ 在/ C/ 的/ 最后/ 一个/ 节点/ 类型/ 所/ 对应/ 的/ 节点/ 上/ ;/ ii/ ./ 为/ S/ 的/ 其它/ 节点/ 类型/ 各/ 建立/ 一个/ 节点/ ,/ 无论/ 结点/ 类型/ 之间/ 是/ 直接/ 包含/ 关系/ 还是/ 间接/ 包含/ 关系/ ,/ 都/ 用/ 单线/ 连接/ ./ ⑤/ 如果/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 非空/ ,/ 则/ 产生/ 一个/ T1/ 的/ 副本/ T2/ ,/ 从/ T2/ 中/ 删除/ 路径/ P/ (/ 或/ P/ 且/ P/ ∈/ Subpaths/ (/ P/ )/ )/ ./ 将/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ 中/ 的/ 路径/ 连接/ 到/ T2/ 的/ C/ 子/ 树上/ ,/ 连接/ 方法/ 同/ ④/ ;/ ⑥/ 将/ T1/ 的/ 文档/ 节点/ 和/ 根/ 元素/ 节点/ 与/ T2/ 的/ 文档/ 节点/ 和/ 根/ 元素/ 节点/ 合并/ 在/ 一起/ ,/ 构成/ 一个/ 由/ 两个/ 子树/ T1/ 和/ T2/ 组成/ 的/ 无文本/ 节点/ 和/ 属性/ 值/ 的/ 文档/ 树/ 实例/ T/ ./ 当然/ 我们/ 可以/ 给/ T/ 添加/ 任意/ 文本/ 节点/ ,/ 而/ 不/ 影响/ 下文/ 的/ 证明/ ./ 例/ 2/ ./ 假定/ Σ/ 为例/ 1/ 中/ 改写/ 后/ 的/ 约束/ 集/ ,/ 构造/ 一个/ 满足/ Σ/ 但/ 不/ 满足/ 约束/ // papers/ // paper/ (/ type/ // jourpaper/ →/ / conference/ )/ 的/ 文档/ 树/ ./ P/ +/ (/ Σ/ ,/ C/ )/ =/ {/ // papers/ // paper/ // type/ // jourpaper/ ,/ Page8/ 经过/ 第/ ②/ 步/ 处理/ 后/ 得/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ =/ P/ +/ (/ Σ/ ,/ C/ )/ ,/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ =/ / ./ 构造/ 的/ 文档/ 树/ T/ 如图/ 3/ 所示/ ./ 以/ r/ [/ C/ ]/ (/ 即/ paper/ 节点/ )/ 为根/ 的/ 子树/ ./ 注意/ :/ 因为/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ =/ / ,/ 所以/ 该/ 文档/ 树/ 只有/ 一个/ (/ 2/ )/ 证明/ 该/ 文档/ 树/ T/ 满足/ Σ/ ,/ 也/ 即/ 对/ 任何/ ψ/ ∈/ Σ/ ,/ T/ / ψ/ ./ 假设/ 任一/ 路径/ 蕴涵/ ψ/ :/ C/ (/ P/ →/ X/ )/ (/ X/ ∈/ {/ Q/ ,/ / Q/ }/ )/ ,/ ψ/ ∈/ Σ/ ,/ 但/ 文档/ T/ |/ ≠/ ψ/ ,/ 则/ ①/ 若/ C/ 不/ 出现/ 在/ 文档/ T/ 中/ ,/ 则/ 根据/ 引理/ 2/ 得/ T/ / ψ/ ,/ 与/ 假设/ T/ |/ ≠/ ψ/ 相/ 矛盾/ ;/ ②/ 若/ P/ 不/ 出现/ 在/ 文档/ T/ 中/ ,/ 则/ 根据/ 引理/ 2/ 得/ T/ / ψ/ ,/ 与/ 假设/ T/ |/ ≠/ ψ/ 相/ 矛盾/ ;/ ③/ 若/ C/ 和/ P/ 都/ 出现/ 在/ 文档/ T/ 中/ ,/ 则/ 有/ P/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 根据/ 引理/ 1/ 得/ C/ (/ P/ →/ P/ )/ 成立/ ;/ 若/ X/ =/ Q/ ,/ 即/ C/ (/ P/ →/ Q/ )/ ∈/ Σ/ ./ 由于/ 上下文/ 路径/ C/ 出现/ 在/ 文档/ T/ 中/ ,/ 根据/ P/ +/ (/ Σ/ ,/ C/ )/ 的/ 计算方法/ 可知/ C/ =/ C/ 或/ C/ ∈/ Subpaths/ (/ C/ )/ ,/ 由/ 推理/ 规则/ 1/ 得/ C/ (/ P/ →/ Q/ )/ ;/ 再/ 根据/ 推理/ 规则/ 3/ 得/ C/ (/ P/ →/ Q/ )/ ,/ 由/ 引理/ 1/ 知/ Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 因此/ T/ / ψ/ ,/ 与/ 假设/ T/ |/ ≠/ ψ/ 相/ 矛盾/ ;/ 若/ X/ =/ / Q/ ,/ 即/ C/ (/ P/ →/ / Q/ )/ ∈/ Σ/ ./ 由于/ 上下文/ 路径/ C/ 出现/ 在/ 文档/ T/ 中/ ,/ 根据/ P/ +/ (/ Σ/ ,/ C/ )/ 的/ 计算方法/ 可知/ C/ =/ C/ 或/ C/ ∈/ Subpaths/ (/ C/ )/ ,/ 由/ 推理/ 规则/ 2/ 得/ C/ (/ P/ →/ / Q/ )/ ;/ 再/ 根据/ 推理/ 规则/ 4/ 得/ C/ (/ P/ →/ / Q/ )/ ,/ 由/ 引理/ 1/ 知/ / Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 因此/ T/ / ψ/ ,/ 与/ 假设/ T/ |/ ≠/ ψ/ 相/ 矛盾/ ;/ 由此可见/ ,/ T/ / Σ/ ./ (/ 3/ )/ 证明/ 文档/ 树/ T/ 不/ 满足/ φ/ :/ C/ (/ P/ →/ Q/ )/ (/ 或/ φ/ :/ C/ (/ P/ →/ / Q/ )/ )/ ,/ 即/ T/ |/ ≠/ φ/ ./ 设/ T/ / φ/ ,/ 若/ φ/ :/ C/ (/ P/ →/ Q/ )/ ,/ 则/ Q/ 和/ P/ 必/ 出现/ 在/ T/ 的/ 同一/ 子树/ T1/ 上/ ,/ 即/ Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ 1/ ,/ 也/ 即/ Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ;/ 若/ φ/ :/ C/ (/ P/ →/ / Q/ )/ ,/ 则/ P/ 出现/ 在/ T/ 的/ 子树/ T1/ 上且/ Q/ 出现/ 在/ 子树/ T2/ 上/ ,/ 即/ / Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ 2/ ,/ 也/ 即/ / Q/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ;/ 根据/ 引理/ 1/ ,/ φ/ 能/ 由/ Σ/ 使用/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 推出/ ,/ 与/ 假设/ “/ φ/ 不能/ 由/ Σ/ 使用/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 推出/ ”/ 矛盾/ ,/ 因此/ T/ |/ ≠/ φ/ ./ 综上所述/ ,/ 路径/ 蕴涵/ φ/ :/ C/ (/ P/ →/ X/ )/ (/ X/ ∈/ {/ Q/ ,/ / Q/ }/ )/ 不能/ 由/ Σ/ 根据/ 推理/ 规则/ 推出/ ,/ 则/ φ/ 一定/ 不/ 为/ Σ/ 所/ 逻辑/ 蕴涵/ ,/ 所以/ 推理/ 规则/ 1/ ~/ 规则/ 6/ 是/ 完备/ 的/ ./ 5XSICs/ 的/ 一致性/ 和/ 结构/ 完整性/ 约束/ 相关/ 的/ 另/ 一个/ 判定/ 性/ 问题/ 是/ 它/ 的/ 一致性/ 问题/ ./ 类似/ 于/ 文献/ [/ 11/ ]/ ,/ XSICs/ 的/ 一致性/ 定义/ 如下/ ./ 定义/ 10/ ./ 给定/ 一个/ 线性/ 路径/ 表达式/ 的/ 有限/ 集/ B/ 和/ B/ 上/ 的/ 一个/ XSICs/ 集/ Σ/ ,/ 是否/ 存在/ 一个/ 文档/ 树/ T/ ,/ 使得/ / P/ ∈/ B/ ,/ P/ 都/ 出现/ 在/ T/ 中且/ T/ / Σ/ ./ 如果/ 有/ 这样/ 的/ 文档/ 树/ T/ 存在/ ,/ 则/ XSICs/ 集/ Σ/ 是/ 一致/ 的/ (/ 或/ 可/ 满足/ 的/ )/ ./ 造成/ XSICs/ 不可/ 满足/ 的/ 原因/ 是/ XSICs/ 集中/ 的/ 约束/ 本身/ 的/ 不一致性/ 和/ 约束/ 之间/ 的/ 不一致性/ ./ 其/ 可能/ 出现/ 的/ 情况/ 有/ 3/ 种/ :/ 首先/ ,/ 一个/ 路径/ 互斥/ 约束/ 的/ 上下文/ 路径/ 的/ 长度/ 不能/ 等于/ 1/ ,/ 如果/ 上下文/ 路径/ 长度/ 为/ 1/ ,/ 则/ 表明/ 在/ XML/ 文档/ 树/ 的/ 根/ 元素/ 节点/ 下/ ,/ 一条/ 路径/ 的/ 存在/ 排斥/ 另/ 一条/ 路径/ ,/ 这/ 显然/ 是/ 不/ 可能/ 的/ [/ 11/ ]/ ./ 这个/ 问题/ 在/ 约束/ 重写/ 时/ (/ 算法/ 2/ )/ 已/ 得到/ 了/ 解决/ ./ 其次/ ,/ 如果/ 两个/ 路径/ 互斥/ ,/ 则/ 其中/ 的/ 一个/ 不能/ 被/ 另/ 一个/ 直接/ 或/ 间接/ 地/ 蕴涵/ ./ 最后/ ,/ 如果/ 两个/ 路径/ 互斥/ ,/ 则/ 这/ 两个/ 路径/ 不能/ 被/ 同一个/ 路径/ 直接/ 或/ 间接/ 地/ 蕴涵/ ./ 本文/ 利用/ 路径/ 蕴涵/ 闭包/ 解决/ XSICs/ 的/ 一致性/ 问题/ ./ 定理/ 5/ ./ 若/ P/ 为/ 约束/ 集/ Σ/ 中/ 的/ 任意/ 约束/ 的/ 前件/ 路径/ ,/ 如果/ P/ +/ (/ Σ/ ,/ C/ )/ =/ / ,/ 则/ Σ/ 是/ 不可/ 满足/ 的/ ./ 该/ 定理/ 的/ 正确性/ 是/ 显然/ 的/ ,/ P/ +/ (/ Σ/ ,/ C/ )/ =/ / 意味着/ 约束/ 重写/ 后/ 的/ 约束/ 集/ Σ/ 为空/ ;/ 而/ 造成/ 这种/ 结果/ 的/ 直接/ 原因/ 是/ 路径/ 互斥/ 的/ 上下文/ 路径/ 长度/ 等于/ 1/ ./ 引理/ 3/ ./ 若/ C/ (/ X/ →/ Y/ )/ 成立/ ,/ 且/ X/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ,/ 则/ Y/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 证明/ ./ 如果/ X/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ,/ 则/ 有/ C/ (/ P/ →/ X/ )/ ;/ 又/ 因为/ C/ (/ X/ →/ Y/ )/ 成立/ ,/ 根据/ 规则/ 3/ 得/ C/ (/ P/ →/ Y/ )/ ,/ 所以/ Y/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 推论/ 1/ ./ 若/ C/ (/ X/ →/ / Y/ )/ 成立/ ,/ 且/ X/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ,/ 则/ / Y/ ∝/ P/ +/ (/ Σ/ ,/ C/ )/ ./ 引理/ 4/ ./ 如果/ C/ (/ P/ →/ / Q/ )/ 且/ Q/ ∈/ Subpaths/ (/ Q/ )/ ,/ Page9/ 则/ C/ (/ P/ →/ / Q/ )/ 一定/ 成立/ ./ 证明/ ./ 因为/ Q/ ∈/ Subpaths/ (/ Q/ )/ ,/ 根据/ 推理/ 规则/ 6/ 得/ Q/ →/ Q/ 成立/ ;/ 又/ 因为/ C/ (/ P/ →/ / Q/ )/ ,/ 根据/ 推理/ 规则/ 5/ 得/ C/ (/ P/ →/ / Q/ )/ ./ 引理/ 3/ 及其/ 推论/ 说明/ 了/ 如果/ 一个/ 路径/ 蕴涵/ 的/ 前件/ 路径/ 在/ 某个/ 路径/ 蕴涵/ 闭包/ ,/ 则/ 其后/ 件/ 路径/ 也/ 一定/ 在/ 该/ 路径/ 蕴涵/ 闭包/ ,/ 也/ 说明/ 了/ 在/ 一个/ 路径/ 蕴涵/ 闭包/ 中/ 若/ 同时/ 存在/ Q/ 和/ / Q/ ,/ 则/ 表明/ 这个/ 路径/ 既/ 蕴涵/ Q/ 也/ 排斥/ Q/ ,/ 因此/ Σ/ 是/ 不可/ 满足/ 的/ ./ 根据/ 引理/ 3/ 和/ 4/ 可以/ 得出/ :/ 如果/ 在/ 一个/ 路径/ 蕴涵/ 闭包/ 中/ 存在/ Q/ 和/ / Q/ ,/ 若/ Q/ ∈/ Subpaths/ (/ Q/ )/ ,/ 则/ 该/ 路径/ 既/ 蕴涵/ Q/ 又/ 排斥/ Q/ ,/ 因此/ Σ/ 也/ 是/ 不可/ 满足/ 的/ ./ 定理/ 6/ 叙述/ 了/ XSICs/ 集内/ 约束/ 之间/ 不一致性/ 的/ 判断/ 方法/ ./ 定理/ 6/ ./ 令/ / +/ (/ Σ/ ,/ C/ )/ 表示/ 在/ 上下文/ 路径/ C/ 下/ ,/ Σ/ 中/ 所有/ 约束/ 的/ 前件/ 路径/ 的/ 路径/ 蕴涵/ 闭包/ 的/ 集合/ ,/ 即/ / +/ (/ Σ/ ,/ C/ )/ =/ {/ P/ +/ i/ (/ Σ/ ,/ C/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ )/ 中/ 存在/ Q/ 和/ / Q/ 使得/ Q/ ∈/ 某个/ P/ +/ Subpaths/ (/ Q/ )/ ,/ 则/ Σ/ 是/ 不可/ 满足/ 的/ ./ 这个/ 定理/ 的/ 正确性/ 在/ 引理/ 3/ 和/ 4/ 的/ 分析/ 中/ 已经/ 得到/ 证明/ ,/ 这里/ 不再/ 赘述/ ./ 需要/ 强调/ 的/ 是/ 在/ 实际/ 应用/ 中/ ,/ 计算/ 路径/ 蕴含/ 闭包时/ 并不需要/ 穷举/ Σ/ 中/ 的/ 所有/ 约束/ 的/ 上下文/ 路径/ ,/ 而是/ 根据/ Σ/ 中/ 的/ 路径/ 互斥/ 约束/ 决定/ 计算/ 哪些/ 上下文/ 路径/ 下/ 的/ 路径/ 蕴涵/ 闭包/ ./ 限于/ 篇幅/ ,/ 不再/ 给出/ XSICs/ 一致性/ 的/ 判断/ 算法/ ./ 6/ 结束语/ XML/ 结构/ 完整性/ 约束/ 表示/ 了/ XML/ 文档/ 中/ 元素/ 或/ 路径/ 之间/ 的/ 结构/ 关系/ ,/ 本文/ 把/ XML/ 结构/ 完整性/ 约束/ 看成/ 一个/ 独立/ 的/ 模式/ 体系/ 研究/ 了/ 它/ 的/ 推理/ 问题/ ./ 文中/ 定义/ 了/ 5/ 种/ 结构/ 完整性/ 约束/ 的/ 语法/ 和/ 语义/ ,/ 给出/ 了/ 一组/ 有效/ 的/ 、/ 完备/ 的/ XML/ 路径/ 蕴涵/ 约束/ 的/ 推理/ 规则/ ./ 借用/ 关系数据库/ 中/ 函数/ 依赖/ 闭包/ 的/ 概念/ ,/ 本文/ 提出/ 了/ 路径/ 蕴涵/ 闭包/ 的/ 概念/ 及其/ 计算方法/ ./ 以此/ 为/ 工具/ ,/ 证明/ 了/ 推理/ 规则/ 的/ 完备/ 性/ ,/ 解决/ 了/ XML/ 结构/ 完整性/ 约束/ 的/ 一致性/ 判断/ 问题/ ./ 在/ 以后/ 的/ 工作/ 中/ ,/ 我们/ 将/ 进一步/ 研究/ XML/ 结构/ 完整性/ 约束/ 在/ 路径/ 表达式/ 查询/ 优化/ 中/ 的/ 作用/ ,/ 探讨/ 如何/ 利用/ XML/ 结构/ 完整性/ 约束/ 对/ 路径/ 表达式/ 进行/ 最小化/ 处理/ ./ 此外/ ,/ XML/ 结构/ 完整性/ 约束/ 可以/ 看成/ 是/ 对/ DTD/ 的/ 扩展/ 和/ 补充/ ,/ 今后/ 我们/ 的/ 另/ 一个/ 主要/ 研究课题/ 是/ 如何/ 使用/ XSICs/ 来/ 扩展/ DTD/ ,/ 得到/ 所有/ 路径/ 表达式/ 的/ 路径/ 蕴涵/ 闭包/ ,/ 从而/ 对/ 路径/ 表达式/ 查询/ 进行/ 全面/ 的/ 优化/ ./ 

