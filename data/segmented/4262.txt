Page1/ 操作系统/ 形式化/ 设计/ 与/ 安全/ 需求/ 的/ 一致性/ 验证/ 研究/ 钱振江/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 黄皓/ 1/ )/ 宋方敏/ 1/ )/ 1/ )/ (/ 南京大学/ 计算机科学/ 与/ 技术/ 系/ 南京/ 210046/ )/ 2/ )/ (/ 常熟/ 理工学院/ 计算机科学/ 与/ 工程学院/ 江苏/ 常熟/ 215500/ )/ 3/ )/ (/ 伦敦大学/ 国王/ 学院/ 伦敦/ 英国/ WC2R2LS/ )/ 摘要/ 采用/ 数学/ 形式化/ 方法/ 对/ 操作系统/ 进行/ 设计/ 和/ 验证/ 可以/ 保证系统/ 的/ 高度/ 安全性/ ./ 目前/ 已有/ 的/ 操作系统/ 形式化/ 研究/ 工作/ 主要/ 是/ 验证/ 系统/ 的/ 实现/ 在/ 代码/ 级/ 的/ 程序正确性/ ./ 提出/ 一种/ 操作系统/ 形式化/ 设计/ 和/ 验证/ 的/ 方法/ ,/ 采用/ 操作系统/ 对象/ 语义/ 模型/ (/ OSOSM/ )/ 对系统/ 的/ 设计/ 进行/ 形式化/ 建模/ ,/ 使用/ 带有/ 时序/ 逻辑/ 的/ 高阶/ 逻辑/ 对/ 操作系统/ 的/ 安全/ 需求/ 进行/ 分析/ 和/ 定义/ ./ 对象/ 语义/ 模型/ 作为/ 系统/ 设计/ 和/ 形式化/ 验证/ 的/ 联系/ ./ 以/ 实现/ 和/ 验证/ 过/ 的/ 可信/ 微内核/ 操作系统/ VTOS/ 为/ 实例/ ,/ 阐述/ 形式化/ 设计/ 和/ 安全/ 需求/ 分析/ ,/ 并/ 使用/ 定理/ 证明/ 器/ Isabelle/ // HOL/ ①/ 对系统/ 的/ 设计/ 和/ 安全/ 需求/ 的/ 一致性/ 进行/ 验证/ ,/ 表明/ VTOS/ 达到/ 预期/ 的/ 安全性/ ./ 关键词/ 操作系统/ ;/ 形式化/ 设计/ ;/ 安全/ 需求/ ;/ 一致性/ 验证/ ;/ 定理/ 证明/ ;/ 信息安全/ ;/ 网络安全/ 1/ 引言/ 操作系统/ (/ OperatingSystem/ ,/ OS/ )/ 作为/ 系统软件/ ,/ 由于/ 其/ 复杂性/ ,/ 其/ 设计/ 和/ 实现/ 的/ 正确性/ 很/ 难用/ 定量/ 的/ 方式/ 进行/ 描述/ 和/ 说明/ ,/ 而/ 操作系统/ 的/ 正确性/ 是/ 信息安全/ 的/ 基础/ ./ 采用/ 形式化/ 的/ 方法/ 对/ 操作系统/ 进行/ 设计/ 和/ 验证/ [/ 1/ -/ 3/ ]/ 是/ 操作系统/ 领域/ 公认/ 的/ 标准/ 方法/ ./ 澳大利亚/ NICTA/ 实验室/ 主导/ 的/ seL4/ 操作系统/ 项目/ [/ 1/ ,/ 4/ ]/ 在/ 系统/ 设计/ 过程/ 中/ 采用/ 函数/ 式/ 语言/ Haskell/ [/ 5/ ]/ 来/ 搭建/ 系统/ 原型/ ,/ 方便/ 后期/ 直接/ 转换/ 为/ 形式化/ 定理/ 证明/ 器/ Isabelle/ // HOL/ [/ 6/ ]/ 所/ 需/ 的/ 程序逻辑/ 输入/ ./ seL4/ 对系统/ 按照/ 不同/ 的/ 实现/ 层次/ 进行/ 抽象/ ,/ 通过/ 说明/ 各种/ 抽象层次/ 在/ 功能/ 语义上/ 的/ 一致性/ 来/ 达到/ 验证/ 的/ 目的/ [/ 7/ -/ 8/ ]/ ./ Verisoft/ 项目/ 提出/ 对/ 计算机系统/ 进行/ 普适/ 形式化/ 验证/ (/ pervasiveformalverification/ )/ [/ 2/ ]/ ,/ 以/ 实现/ 对/ 操作系统/ 从/ 底层/ 硬件/ 抽象/ 到/ 高层/ 应用软件/ 的/ 完全/ 验证/ [/ 9/ ]/ ,/ 验证/ 的/ 层次/ 是/ 代码/ 级/ 的/ 验证/ ,/ 即/ 系统/ 实现/ 的/ 正确性/ 验证/ [/ 10/ ]/ ./ 耶鲁大学/ Shao/ 等/ 人/ 领导/ 的/ Flint/ 项目/ 对系统/ 的/ 程序验证/ 逻辑/ 进行/ 改进/ [/ 3/ ]/ ,/ 主要/ 是/ 对系统/ 的/ 各种/ 功能模块/ 的/ 混合/ 验证/ 方法/ 进行/ 改进/ ,/ 目的/ 是/ 提高/ 验证/ 的/ 效率/ [/ 11/ -/ 12/ ]/ ./ 本文/ 认为/ ,/ 采用/ 形式化/ 方法/ 对/ 操作系统/ 进行/ 设计/ 和/ 实现/ ,/ 以此/ 来/ 说明/ 系统/ 的/ 正确性/ 和/ 保证系统/ 的/ 安全性/ ,/ 为/ 达到/ 这样/ 的/ 目的/ ,/ 首先/ 需要/ 使用/ 形式逻辑/ 验证/ 操作系统/ 的/ 设计/ 是否/ 满足/ 对系统/ 的/ 安全/ 需求/ ,/ 进而/ 验证/ 操作系统/ 的/ 实现/ 是否/ 满足/ 设计/ 的/ 要求/ ./ 本文/ 提出/ ,/ 不仅/ 对系统/ 实现/ (/ 代码/ 级/ )/ 的/ 验证/ 需要/ 使用/ 形式化/ 的/ 方法/ ,/ 在/ 系统/ 设计/ (/ 设计/ 级/ )/ 的/ 过程/ 中/ 就/ 需要/ 使用/ 形式逻辑/ 来/ 保证/ 设计/ 的/ 正确性/ ,/ 从而/ 最大/ 程度/ 上/ 保证系统/ 的/ 正确性/ ./ 本文/ 提出/ 一种/ 形式化/ 设计/ 和/ 验证/ 相结合/ 的/ 方法/ ,/ 使用/ 对象/ 语义/ 模型/ (/ OperatingSystemObjectSemanticsModel/ ,/ OSOSM/ )/ [/ 13/ ]/ 作为/ 系统/ 设计/ 和/ 验证/ 之间/ 的/ 联系/ ,/ 利用/ 包含/ 时序/ 逻辑/ (/ TemporalLogic/ ,/ TL/ )/ [/ 14/ ]/ 的/ 高阶/ 逻辑/ (/ Higher/ -/ OrderLogic/ ,/ HOL/ )/ [/ 15/ ]/ 描述/ 系统/ 的/ 安全/ 需求/ ,/ 并/ 以/ 我们/ 实现/ 的/ 可信/ 操作系统/ (/ VerifiedTrustedOperatingSystem/ ,/ VTOS/ )/ 为例/ ,/ 阐述/ 使用/ 形式化/ 定理/ 证明/ 器/ Isabelle/ // HOL/ 对系统/ 的/ 设计/ 和/ 安全/ 需求/ 的/ 一致性/ 进行/ 验证/ 的/ 方法/ ./ 本文/ 第/ 2/ 节以/ VTOS/ 微内核/ 为例/ ,/ 采用/ 微内核/ OS/ 对象/ 语义/ 模型/ 进行/ 形式化/ 建模/ ;/ 第/ 3/ 节对/ 微内核/ OS/ 的/ 安全/ 需求/ 进行/ 分析/ ,/ 并/ 使用/ 带有/ 时序/ 逻辑/ 的/ 高阶/ 逻辑/ 进行/ 严格/ 定义/ ;/ 第/ 4/ 节/ 阐述/ 使用/ 定理/ 证明/ 器/ Isabelle/ // HOL/ 对/ 形式化/ 设计/ 与/ 安全/ 需求/ 的/ 一致性/ 验证/ ;/ 第/ 5/ 节对/ 本文/ 的/ 工作/ 进行/ 总结/ ,/ 并/ 对/ 我们/ 进一步/ 的/ 研究/ 方向/ 进行/ 展望/ ./ 2/ 对象/ 语义/ 模型/ 本/ 节/ 阐述/ 对象/ 语义/ 模型/ OSOSM/ 的/ 基本/ 框架/ ./ OSOSM/ 是/ 一种/ 针对/ 操作系统/ 的/ 框架/ 语义/ 模型/ [/ 13/ ]/ ,/ 将/ 系统/ 中/ 各种/ 行为/ 的/ 执行/ 功效/ 看成/ 是/ 对系统/ 状态/ 的/ 改变/ 或者/ 迁移/ ,/ 对应/ 地/ ,/ 将/ 系统/ 行为/ 的/ 主客体/ 作为/ 对象/ 来/ 看待/ ,/ 系统/ 状态/ 的/ 转化/ 看成/ 是/ 系统/ 中/ 行为/ 的/ 主客体/ 对象/ 相互作用/ 的/ 结果/ ./ OSOSM/ 对系统/ 的/ 描述/ 采用/ 状态机/ 的/ 方式/ ,/ 使用/ 状态/ 轨迹/ 来/ 表达/ 系统/ 的/ 运行/ 变化/ ./ 2.1/ OS/ 对象/ 的/ 抽象/ OS/ 为/ 其他/ 各种/ 功能性/ 的/ 上层/ 应用软件/ 提供/ 平台/ 的/ 支撑/ ,/ 是/ 一个/ 服务/ 系统/ ,/ 对/ 其他/ 功能模块/ 提出/ 的/ 服务/ 请求/ 、/ 以及/ 中断/ 事件/ 作出/ 响应/ ./ OS/ 对/ 服务/ 请求/ 和/ 中断/ 事件/ 的/ 响应/ 是/ 通过/ 系统/ 行为/ 来/ 完成/ 的/ ,/ 系统/ 行为/ 的/ 主体/ 通过/ 对/ 内核/ 或者/ 用户/ 数据/ 客体/ 的/ 检索/ 、/ 读取/ 、/ 修改/ 或者/ 创建/ 等/ 动作/ 来/ 完成/ 功效/ ./ 例如/ 用户/ 进程/ 通过/ 发送/ 消息/ 给/ 服务/ 进程/ 请求/ 进行/ 系统/ 调用/ ,/ OS/ 的/ 消息/ 处理/ 行为/ 根据/ 用户/ 进程/ 和/ 服务器/ 的/ 进程/ 控制/ 块/ 、/ 内核/ 数据/ 、/ 系统/ 状态/ 等/ 对象/ 来/ 完成/ 功效/ ./ 我们/ 可以/ 将/ 系统/ 行为/ 的/ 主客体/ 抽象/ 为/ 对象/ ,/ 系统/ 行为/ 的/ 功效/ 是/ 通过/ 主客体/ 的/ 相互作用/ 来/ 完成/ 的/ ,/ 进而/ 实现/ 对系统/ 状态/ 的/ 改变/ ./ 在/ 这样/ 的/ 对象/ 抽象/ 的/ 场景/ 下/ ,/ 下/ 一/ 小节/ 重点/ 阐述/ OSOSM/ 的/ 整体/ 框架/ ./ 2.2/ OSOSM/ 框架/ OSOSM/ 采用/ 分层/ 结构/ ,/ 是/ 一种/ 开放式/ 的/ 框架/ 语义/ 模型/ ,/ 可以/ 描述/ OS/ 的/ 功能模块/ 的/ 行为/ 语义/ ./ OSOSM/ 按照/ 基本/ 功效/ 、/ 具体/ 实现/ 、/ 实现/ 优化/ 的/ 递进/ 层次/ 来/ 分层/ ,/ 区别/ 于/ 按照/ 软件/ 功能模块/ 和/ 硬件/ 抽象/ 的/ 分层/ 方式/ ./ 为此/ ,/ OSOSM/ 层级/ 结构/ 包含/ 基本/ 功效/ 层/ 、/ 实现/ 层/ 和/ 优化/ 层/ ./ 基本/ 功效/ 层/ 描述/ 系统/ 行为/ 动作/ 对系统/ 状态/ 改变/ 的/ 基本/ 功效/ ,/ 关注/ 系统/ 状态/ 改变/ 的/ 结果/ ,/ 不/ 涉及/ 处理/ 的/ 具体/ 细节/ ./ 实现/ 层/ 描述/ 为了/ 实现/ 基本/ 功效/ 层/ 的/ 功能/ 功效/ 而/ 引入/ 的/ 其他/ 关键/ 对象/ 和/ 行为/ 语义/ 函数/ ./ 与/ 指称/ 语义/ [/ 16/ ]/ 的/ 概念/ 相同/ ,/ OSOSM/ 使用/ 对象/ 集合/ 上/ 的/ 语义/ 函数/ 来/ 描述/ 系统/ 行为/ 的/ 功能/ 语义/ ./ 优化/ 层/ 描述/ 为了/ 提高/ 实现/ 层/ 的/ 语义/ 函数/ 和/ 具体/ 实现/ 细节/ 的/ 效率/ 和/ 性能/ 而/ 引入/ 的/ 新/ 的/ 对象/ 和/ 语义/ 函数/ ./ Page3/ 为了/ 表述/ 的/ 方便/ ,/ 我们/ 以/ 完全/ 自主/ 研发/ 的/ 安全/ 可信/ 操作系统/ VTOS/ 为/ 例来/ 阐述/ OSOSM/ 框架/ ./ VTOS/ 是/ 一种/ 微内核/ 架构/ 的/ OS/ ,/ 设计/ 和/ 实现/ 部分/ 均/ 经过/ 形式化/ 的/ 验证/ ,/ 达到/ 一定/ 的/ 安全/ 标准/ 级别/ ./ VTOS/ 拥有/ 安全/ 核/ (/ securekernel/ )/ 和/ 访问控制/ 机制/ ,/ 实现/ 了/ 虚拟内存/ 管理/ 、/ 多核/ 和/ 多线程/ 管理/ 、/ 文件系统/ 管理/ 以及/ 安全/ 网关/ 等/ 功能/ ./ 限于/ 篇幅/ ,/ 我们/ 结合/ 图/ 1VTOS/ 微内核/ OSOSM/ 框架/ 2.2/ ./ 1/ 基本/ 功效/ 层/ (/ 1/ )/ 对象/ 集合/ 基本/ 功效/ 层/ 对象/ 集合/ M1/ 包含/ 以下/ 对象/ :/ ①/ 消息/ message/ =/ (/ m/ _/ source/ ,/ m/ _/ type/ ,/ m/ _/ content/ )/ ,/ m/ _/ source/ 为/ 消息/ 发送/ 进程/ 对象/ 标识/ ,/ m/ _/ type/ 为/ 消息/ 类型/ ,/ m/ _/ content/ 为/ 消息/ 体/ ;/ ②/ 进程/ 对象/ process/ =/ (/ proc/ _/ nr/ ,/ p/ _/ messbuf/ ,/ p/ _/ rts/ _/ flags/ ,/ p/ _/ getfrom/ ,/ p/ _/ sendto/ )/ ,/ proc/ _/ nr/ 为/ 进程/ 对象/ 标识/ ,/ p/ _/ messbuf/ 为/ 消息/ 缓冲区/ ,/ p/ _/ rts/ _/ flags/ 指示/ 进程/ 对象/ 是否/ 处于/ 等待/ 发送/ 消息/ 状态/ 或者/ 是/ 等待/ 接收/ 状态/ ,/ 取值/ 如/ RECEIVING/ 和/ SENDING/ ;/ p/ _/ getfrom/ 为/ 希望/ 接收/ 消息/ 的/ 目标/ 进程/ 对象/ 标识/ ;/ VTOS/ 微内核/ 部分/ 的/ 形式化/ 设计/ 和/ 验证/ 来/ 阐述/ ./ VTOS/ 微内核/ 为/ 服务/ 进程/ 以及/ 设备/ 驱动程序/ 等/ 提供/ 功能/ 服务/ ,/ 主要/ 负责/ 消息/ 处理/ 、/ 进程/ 调度/ 以及/ 中断/ 处理/ ./ VTOS/ 微内核/ OSOSM/ 框架/ 如图/ 1/ 所示/ ./ 以下/ 小节/ ,/ 对/ VTOS/ 微内核/ 的/ 功能/ 语义/ 进行/ 分解/ ,/ 包括/ 对象/ 以及/ 行为/ 语义/ ./ p/ _/ sendto/ 为/ 希望/ 发送/ 消息/ 的/ 目标/ 进程/ 对象/ 标识/ ;/ ③/ 系统/ 状态/ state/ =/ (/ pset/ ,/ process/ _/ q/ ,/ sys/ _/ buffer/ ,/ intr/ _/ source/ ,/ next/ _/ running/ _/ proc/ )/ ,/ pset/ 为/ 当前/ 进程/ 对象/ 的/ 集合/ ,/ process/ _/ q/ 为/ 就绪/ 进程/ 队列/ ;/ sys/ _/ buffer/ 为/ 系统/ 缓冲区/ ,/ intr/ _/ source/ 为/ 中断/ 源/ ;/ next/ _/ running/ _/ proc/ 为/ 下/ 一个/ 将要/ 运行/ 的/ 进程/ 对象/ 标识/ ;/ ④/ 系统/ 状态/ 集/ S/ ,/ S/ 为/ 系统/ 状态/ state/ 的/ 集合/ ./ (/ 2/ )/ 行为/ 语义/ ①/ 消息/ 处理/ 行为/ ./ 在/ 基本/ 功效/ 层/ ,/ 从/ 功效/ 上/ 来说/ ,/ 微内核/ 的/ 消息/ 处理/ 行为/ 是/ 将/ 发送者/ 进程/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲区/ 中/ 的/ 消息/ 体/ 复制到/ 接收者/ 进程/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲/ Page4/ 区中/ ./ 在/ 这/ 一层/ ,/ 我们/ 主要/ 考虑/ 系统/ 行为/ 功效/ 的/ 完成/ ./ 假设/ 在/ 状态/ s/ 时/ 进程/ p1/ 向/ 进程/ p2/ 发送/ 消息/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ sendp1p2/ :/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ s/ ./ pset/ ./ p1/ ./ p/ _/ messbuf/ 烄/ ifs/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ =/ RECEIVING/ ∧/ (/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ ANY/ ∨/ 烅/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ p1/ )/ 烆/ invariableifother/ 假设/ 在/ 状态/ s/ 时/ 进程/ p2/ 接收/ 进程/ 对象/ p1/ 的/ 消息/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ receivep2p1/ :/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ s/ ./ pset/ ./ p1/ ./ p/ _/ messbuf/ 烄/ ifs/ ./ pset/ ./ p1/ ./ p/ _/ rts/ _/ flags/ =/ SENDING/ ∧/ 烅/ s/ ./ pset/ ./ p1/ ./ p/ _/ sendto/ =/ p2/ 烆/ invariableifother/ ②/ 进程/ 调度/ 行为/ ./ VTOS/ 微内核/ 的/ 进程/ 调度/ 行为/ 包括/ schedule/ ,/ dequeue/ 和/ pick/ _/ proc/ 操作/ 行为/ ./ schedule/ 是/ 将/ 被/ 调度/ 的/ 进程/ 对象/ 加入/ 到/ 就绪/ 进程/ 队列/ 中/ ./ 假设/ 在/ s/ 状态/ 下/ 调度/ 进程/ 对象/ p/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ dequeue/ 将/ 进程/ 对象/ 从/ 进程/ 队列/ 中/ 去除/ ./ 如果/ 一个/ 进程/ 对象/ 被/ 阻塞/ ,/ 那么/ 这个/ 进程/ 对象/ 将/ 从/ 进程/ 队列/ 中/ 去除/ ./ 假设/ 在/ s/ 状态/ 下/ 阻塞/ 进程/ 对象/ p/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ pick/ _/ proc/ 选择/ 下/ 一个/ 将要/ 运行/ 的/ 进程/ ./ 在/ 基本/ 功效/ 层/ ,/ pick/ _/ proc/ 不/ 进行/ 调度/ 优化/ ,/ 为此/ 选择/ 进程/ 队列/ 首部/ 的/ 进程/ 对象/ 占有/ 处理器/ CPU/ 资源/ ,/ 这/ 主要/ 通过/ 对系统/ 状态/ state/ 中/ next/ _/ running/ _/ proc/ 域/ 进行/ 赋值/ 来/ 完成/ ./ VTOS/ 微内核/ 将/ 在/ 下/ 一个/ 时钟/ 中断/ 处理/ 完成/ 后/ 切换/ next/ _/ running/ _/ proc/ 域/ 指向/ 的/ 进程/ 对象/ 来/ 运行/ ./ 关于/ 调度/ 优化/ 部分/ ,/ 将/ 在/ 优化/ 层/ 进行/ 阐述/ ./ 假设/ 在/ s/ 状态/ 下/ 选择/ 进程/ 对象/ p/ 占有/ CPU/ 资源/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ 其中/ head/ 操作/ 子/ 表示/ 取/ 队列/ 的/ 首部/ ./ pick/ _/ proc/ :/ w/ ./ next/ _/ running/ _/ proc/ ·/ ·/ =/ heads/ ./ process/ _/ q/ ③/ 中断/ 处理/ 行为/ ./ VTOS/ 微内核/ 对/ 硬件/ 中断/ 的/ 处理/ ,/ 主要/ 是/ 通过/ 发送/ 消息/ 给/ 驱动程序/ 进程/ 对象/ ,/ 由/ 驱动程序/ 进程/ 对象/ 来/ 进行/ 相应/ 的/ 中断/ 服务/ 处理/ ./ 在/ VTOS/ 微内核/ 对象/ 语义/ 模型/ 中/ ,/ 从/ 对象/ 层次/ 来说/ ,/ VTOS/ 微内核/ 的/ 中断/ 处理/ 行为/ 的/ 功效/ 是/ 根据/ 不同/ 的/ 中断/ 源/ ,/ 对系统/ 缓冲区/ 对象/ 进行/ 设置/ ./ 本文/ 主要/ 描述/ 键盘/ 中断/ 和/ 磁盘/ 中断/ ./ 假设/ 在/ s/ 状态/ 下/ 发生/ 键盘/ 中断/ 或者/ 磁盘/ 中断/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 功效/ 用/ 逻辑/ 公式/ 表示/ 如下/ :/ interrupt/ _/ handle/ :/ w/ ./ sys/ _/ buffer/ ·/ ·/ =/ data/ _/ from/ _/ diskifs/ ./ intr/ _/ source/ =/ INTR/ _/ DISK/ 烄/ data/ _/ from/ _/ input/ 烅/ ifs/ ./ intr/ _/ source/ =/ INTR/ _/ KEYBOARD/ 烆/ invariableifother/ 其中/ data/ _/ from/ _/ disk/ 表示/ 从/ 磁盘/ 输入/ 的/ 数据/ ,/ data/ _/ from/ _/ input/ 表示/ 从/ 键盘输入/ 的/ 数据/ ./ 2.2/ ./ 2/ 实现/ 层/ 涉及/ 的/ 其他/ 数据/ 对象/ 和/ 相关/ 的/ 语义/ 函数/ ./ 我们/ 在/ 设计/ 上/ ,/ 对/ VTOS/ 消息/ 处理/ 行为/ 采用/ “/ 汇合/ ”/ 机制/ ,/ 对方/ 进程/ 对象/ 不/ 在/ 接收/ 消息/ 的/ 情况/ 下/ ,/ 发送/ 进程/ 将会/ 阻塞/ ;/ 类似/ 地/ ,/ 对方/ 进程/ 对象/ 不/ 在/ 发送/ 消息/ 的/ 情况/ 下/ ,/ 接收/ 进程/ 将会/ 阻塞/ ./ 同时/ ,/ 由于/ 各种/ 执行/ 主体/ 作为/ 独立/ 的/ 进程/ 对象/ 运行/ ,/ 消息/ 处理/ 的/ “/ 汇合/ ”/ 机制/ 导致系统/ 中/ 进程/ 对象/ 的/ 过分/ 同步/ ,/ 造成/ 性能/ 的/ 下降/ ,/ 有/ 可能/ 引起/ 死锁/ 现象/ ./ 为此/ ,/ 在/ 实现/ 层/ ,/ 我们/ 在/ VTOS/ 的/ 消息/ 处理/ 行为/ 中/ 同时/ 加入/ 异步/ 机制/ ,/ 引入/ 一种/ 特殊/ 的/ 消息/ 方式/ ,/ 称为/ “/ 通知/ ”/ ./ 如果/ 接收者/ 不/ 在/ 等待/ 消息/ 或者/ 通知/ ,/ 通知/ 的/ 发送者/ 也/ 不会/ 阻塞/ ./ 通知/ 信息/ 不会/ 丢失/ ,/ 该/ 通知/ 只是/ 简单/ 地被/ 挂起/ ./ 当/ 目标/ 进程/ 执行/ 接收/ 动作/ 时/ ,/ 通知/ 将/ 优先/ 于/ 消息/ 被/ 处理/ ./ 在/ 通知/ 的/ 设计/ 上/ ,/ 通知/ 体只/ 包含/ 发送者/ 的/ 标识/ 信息/ ,/ 不/ 包含/ 具体/ 的/ 内容/ 信息/ ,/ 接收者/ 如果/ 需要/ 其他/ 的/ 必要/ 信息/ ,/ 可以/ 通过/ 向/ 发送者/ 发送/ 消息/ 来/ 请求/ 相应/ 的/ 内容/ ./ 实现/ 层/ 阐述/ 实现/ 基本/ 功效/ 层/ 的/ 系统/ 行为/ 功效/ 所/ (/ 1/ )/ 对象/ 集合/ 实现/ 层/ 对象/ 集合/ M2/ 的/ 定义/ 如下/ :/ Page5/ ①/ M2/ 包含/ 基本/ 功效/ 层/ 对象/ 集合/ M1/ ;/ ②/ 进程/ 对象/ process/ ./ 实现/ 层/ 的/ 进程/ 对象/ process/ 在/ 基本/ 功效/ 层/ 的/ 基础/ 上/ 增加/ 相应/ 的/ 数据/ 成员/ 对象/ :/ p/ _/ lastcall/ ,/ s/ _/ notify/ _/ pending/ 和/ s/ _/ msg/ _/ pending/ ./ p/ _/ lastcall/ 为/ 进程/ 对象/ 最近/ 一次/ 消息/ 行为/ 语义/ 的/ 标识/ 信息/ ./ 由于/ 消息/ 处理/ 行为/ 的/ 语义/ 函数/ 需要/ 保存/ 结果/ 信息/ ,/ 为此/ 我们/ 在/ 进程/ process/ 对象/ 中/ 引入/ p/ _/ lastcall/ 对象/ 来/ 保存/ 语义/ 函数/ 信息/ ./ p/ _/ lastcall/ =/ (/ nr/ _/ sys/ _/ call/ ,/ result/ )/ ,/ 其中/ nr/ _/ sys/ _/ call/ 是/ 行为/ 标识/ ,/ 取值/ 如/ SEND/ ,/ RECEIVE/ 和/ NOTIFY/ ;/ result/ 是/ 语义/ 函数/ 结果/ 信息/ ,/ 取值/ 如/ ELOCKED/ (/ 标识/ 死锁/ )/ ,/ OK/ (/ 标识/ 消息/ 处理/ 行为/ 完成/ ,/ 发送/ 或者/ 接收/ 行为/ 成功/ 或者/ 进程/ 对象/ 阻塞/ )/ ;/ s/ _/ notify/ _/ pending/ 是/ 记录/ 所有/ 向/ 该/ 进程/ 对象/ 发送/ 通知/ 的/ 进程/ 对象/ 标识/ 链表/ ;/ s/ _/ msg/ _/ pending/ 是/ 记录/ 所有/ 向/ 该/ 进程/ 对象/ 发送/ 消息/ 的/ 进程/ 对象/ 标识/ 链表/ ./ (/ 2/ )/ 行为/ 语义/ 实现/ 层/ 行为/ 语义/ 主要/ 包括/ 消息/ 处理/ 行为/ send/ ,/ notify/ 和/ receive/ ./ ①/ 消息/ 的/ 处理/ 行为/ send/ ./ 假设/ 在/ 状态/ s/ 时/ 进程/ 对象/ p1/ 向/ 进程/ 对象/ p2/ 发送/ 消息/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ send/ 行为/ 在/ 实现/ 层/ 的/ 逻辑/ 语义/ 分/ 情况/ 描述/ 如下/ :/ i/ ./ 当/ 目标/ 进程/ 对象/ p2/ 也/ 在/ 发送/ 消息/ ,/ 并且/ 该/ 消息/ 的/ 目标/ 进程/ 是/ p1/ ,/ 那么/ 就/ 会/ 产生/ 死锁/ ./ 此时/ ,/ 系统/ 状态/ state/ 的/ 变化/ 主要/ 为/ :/ 进程/ 对象/ p1/ 中/ 的/ p/ _/ lastcall/ 值/ 变为/ (/ SEND/ ,/ ELOCKED/ )/ ,/ 即/ 记录/ 发送/ 进程/ 对象/ 在/ 进行/ 发送/ 消息/ 行为/ 时/ 发生/ 死锁/ ,/ 等待/ 系统/ 的/ 处理/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p1/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ SEND/ ,/ ELOCKED/ )/ ii/ ./ 当/ 目标/ 进程/ p2/ 正在/ 等待/ 消息/ ,/ 并且/ 等待/ 消息/ 的/ 来源/ 进程/ 标识/ 是/ ANY/ 或是/ 发送/ 进程/ p1/ ,/ 那么/ 消息/ 就/ 成功/ 发送/ ,/ 并/ 修改/ 目标/ 进程/ p2/ 的/ 状态/ 信息/ ,/ 将/ 目标/ 进程/ p2/ 唤醒/ 加入/ 到/ 进程/ 队列/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p1/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ SEND/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ s/ ./ pset/ ./ p1/ ./ p/ _/ messbufw/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ s/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ -/ RECEIVINGschedule/ (/ p2/ )/ iii/ ./ 当/ 上面/ 两种/ 情况/ 都/ 不/ 符合/ 的/ 情况/ 下/ ,/ 发送/ 进程/ p1/ 进入/ 阻塞状态/ ,/ 同时/ 修改/ 发送/ 进程/ 对象/ 信息/ ,/ 并/ 将/ 发送/ 进程/ 对象/ p1/ 加入/ 到/ 进程/ 对象/ p2/ 的/ 等待/ 发送/ 消息/ 进程/ 对象/ 链表/ (/ s/ _/ msg/ _/ pending/ 域/ )/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p1/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ SEND/ ,/ OK/ )/ w/ ./ pset/ ./ p1/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ w/ ./ pset/ ./ p1/ ./ p/ _/ sendto/ ·/ ·/ =/ p2w/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ ·/ ·/ =/ dequeue/ (/ p1/ )/ ②/ 通知/ 的/ 发送/ 行为/ notify/ ./ 假设/ 在/ 状态/ s/ 时/ 进程/ 对象/ p1/ 向/ 进程/ 对象/ p2/ 发送/ 通知/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ notify/ 行为/ 在/ 实现/ 层/ 的/ 逻辑/ 语义/ 分/ 情况/ 描述/ 如下/ :/ i/ ./ 如果/ 进程/ 对象/ p2/ 处于/ 接收/ 状态/ ,/ 即/ w/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ =/ RECEIVING/ ,/ 并且/ 在/ 等待/ p1/ 或者/ ANY/ ,/ 那么/ p1/ 直接/ 将/ 通知/ 发送给/ p2/ ,/ 并/ 修改/ p2/ 的/ 状态/ ,/ 将/ p2/ 唤醒/ 加入/ 到/ 进程/ 队列/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p1/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ NOTIFY/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ (/ p1/ ,/ Notify/ ,/ NULL/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ s/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ -/ RECEIVINGschedule/ (/ p2/ )/ ii/ ./ 如果/ 进程/ 对象/ p2/ 不/ 处于/ 接收/ 状态/ ,/ 通知/ 不能/ 成功/ 发送/ ,/ 发送/ 进程/ 不会/ 被/ 阻塞/ ./ 同时/ ,/ 该/ 通知/ 需要/ 被/ 挂/ 起/ ,/ 以便/ 将来/ 进程/ 对象/ p2/ 能/ 进行/ 处理/ ,/ 我们/ 采用/ 的/ 方法/ 是/ 在/ 进程/ 对象/ p2/ 的/ s/ _/ notify/ _/ pending/ 链表/ 中/ 记录/ 下/ p1/ 的/ 标识/ 信息/ ./ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p1/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ NOTIFY/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ s/ _/ notify/ _/ pending/ ·/ ·/ =/ s/ ./ pset/ ./ p2/ ./ s/ _/ notify/ _/ pending/ #/ p1/ ③/ 消息/ 的/ 接收/ 行为/ receive/ ./ 假设/ 在/ 状态/ s/ 时/ 进程/ 对象/ p2/ 对/ 发送给/ 它/ 的/ 通知/ 和/ 消息/ 进行/ 处理/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ receive/ 行为/ 在/ 实现/ 层/ 的/ 逻辑/ 语义/ 分/ 情况/ 描述/ 如下/ :/ i/ ./ 如果/ 存在/ 进程/ 对象/ 正在/ 向/ 进程/ 对象/ p2/ 发送/ 通知/ ,/ 则/ 优先/ 处理/ ,/ 这/ 主要/ 通过/ 查看/ 进程/ 对象/ p2/ 的/ s/ _/ notify/ _/ pending/ 域来/ 确定/ ./ s/ _/ notify/ _/ pending/ 记录/ 的/ 通知/ 信息/ 从/ 链表/ 首部/ 开始/ 处理/ ./ 由于/ 采用/ 异步/ 模式/ 发送/ 通知/ ,/ 为此/ 不/ 需要/ 唤醒/ 链表/ 首部/ 对应/ 的/ 发送/ 进程/ ./ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p2/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ RECEIVE/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ (/ heads/ ./ pset/ ./ p2/ ./ s/ _/ notify/ _/ pending/ ,/ Notify/ ,/ NULL/ )/ Page6w/ ./ pset/ ./ p2/ ./ s/ _/ notify/ _/ pending/ ·/ ·/ =/ tails/ ./ pset/ ./ p2/ ./ s/ _/ notify/ _/ pending/ 其中/ ,/ tail/ 操作/ 子/ 表示/ 取/ 链表/ 除/ 首部/ 以外/ 的/ 部分/ ;/ ii/ ./ 如果/ 不/ 存在/ 向/ 进程/ 对象/ p2/ 发送/ 的/ 通知/ ,/ 但/ 存在/ 向/ 进程/ 对象/ p2/ 发送/ 的/ 消息/ ,/ 这/ 通过/ p2/ ./ s/ _/ msg/ _/ pending/ 域/ 进行/ 判断/ ./ 对于/ 消息/ 的/ 处理/ ,/ 如果/ 进程/ 对象/ p2/ 的/ 接收/ 对象/ (/ p/ _/ getfrom/ 域/ )/ 为/ ANY/ ,/ 则/ 顺序/ 从/ 链表/ 首部/ 开始/ 处理/ ;/ 否则/ ,/ 检查/ 接收/ 对象/ 是否/ 在/ s/ _/ msg/ _/ pending/ 链表/ 对象/ 中/ ,/ 并/ 进行/ 相应/ 的/ 处理/ ./ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p2/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ RECEIVE/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ ·/ ·/ =/ w/ ./ pset/ ./ (/ heads/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ )/ ./ p/ _/ messbuf/ 烄/ ifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ ANYw/ ./ pset/ ./ (/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ )/ ./ p/ _/ messbuf/ 烅/ ifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ≠/ ANY/ ∧/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ∈/ s/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ 烆/ invariableifotherw/ ./ pset/ ./ (/ heads/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ )/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ w/ ./ pset/ ./ (/ heads/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ )/ ./ p/ _/ rts/ _/ flags/ -/ RECEIVINGifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ ANYw/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ ·/ ·/ =/ tails/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ 烄/ ifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ ANYs/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ \/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ 烅/ ifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ≠/ ANY/ ∧/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ∈/ s/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ 烆/ invariableifotheriii/ ./ 如果/ 进程/ 对象/ p2/ 的/ 接收/ 对象/ 不/ 处于/ 发送/ 状态/ ,/ 那么/ 接收/ 进程/ p2/ 将/ 被/ 阻塞/ ./ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p2/ ./ p/ _/ lastcall/ ·/ ·/ =/ (/ RECEIVE/ ,/ OK/ )/ w/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ s/ ./ pset/ ./ p2/ ./ p/ _/ rts/ _/ flags/ +/ RECEIVINGdequeue/ (/ p2/ )/ w/ ./ pset/ ./ (/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ )/ ./ p/ _/ rts/ _/ flags/ ·/ ·/ =/ s/ ./ pset/ ./ (/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ )/ ./ p/ _/ rts/ _/ flags/ -/ RECEIVINGifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ≠/ ANY/ ∧/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ∈/ s/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pendingifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ =/ ANYifs/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ≠/ ANY/ ∧/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ ∈/ s/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pendingschedule/ (/ heads/ ./ pset/ ./ p2/ ./ s/ _/ msg/ _/ pending/ )/ schedule/ (/ s/ ./ pset/ ./ p2/ ./ p/ _/ getfrom/ )/ 2.2/ ./ 3/ 优化/ 层/ 优化/ 层/ 描述/ 为了/ 提高/ 实现/ 层/ 的/ 语义/ 函数/ 和/ 具体/ 实现/ 细节/ 的/ 效率/ 和/ 性能/ 而/ 引入/ 的/ 新/ 的/ 对象/ 和/ 语义/ 函数/ ./ 为了/ 高效/ 地/ 组织/ 进程/ 队列/ ,/ 我们/ 按照/ 进程/ 优先级/ 引入/ 多级/ 进程/ 队列/ ./ (/ 1/ )/ 对象/ 集合/ 优化/ 层/ 对象/ 集合/ M3/ 定义/ 如下/ :/ ①/ M3/ 包含/ 实现/ 层/ 对象/ 集合/ M2/ ;/ ②/ 进程/ 对象/ process/ ./ 优化/ 层/ 的/ 进程/ 对象/ process/ 在/ 基本/ 功效/ 层/ 和/ 实现/ 层/ 的/ 基础/ 上/ 增加/ 相应/ 的/ 数据/ 成员/ 对象/ :/ p/ _/ priority/ 和/ p/ _/ ticks/ _/ left/ ./ p/ _/ priority/ 是/ 进程/ 对象/ 的/ 优先级/ ,/ VTOS/ 在/ 设计/ 上/ 包含/ 16/ 级/ 优先级/ 队列/ ,/ 取值/ 范围/ 为/ 0/ ~/ 15/ ,/ 0/ 为/ 最高级/ ;/ p/ _/ ticks/ _/ left/ 是/ 进程/ 对象/ 的/ 剩余时间/ 片/ ,/ 用于/ 衡量/ 和/ 计算/ 进程/ 对象/ 的/ 优先级/ ;/ ③/ 系统/ 状态/ state/ ,/ 优化/ 层/ 的/ 系统/ 状态/ state/ 在/ 基本/ 功效/ 层/ 和/ 实现/ 层/ 的/ 基础/ 上/ 增加/ 相应/ 的/ 数据/ 成员/ 对象/ :/ prev/ _/ proc/ ,/ 记录/ 当前/ 状态/ 的/ 上/ 一个/ 运行/ 的/ 进程/ 对象/ ;/ ④/ 在/ 基本/ 功效/ 层/ 和/ 实现/ 层中/ ,/ 系统/ 状态/ state/ 的/ process/ _/ q/ 数据/ 域/ 是/ 一个/ 进程/ 队列/ 对象/ ,/ 由于/ 我们/ 在/ 优化/ 层/ 引入/ 多级/ 进程/ 队列/ ,/ 为此/ process/ _/ q/ 数据/ 域/ 在/ 优化/ 层/ 作为/ 多级/ 进程/ 队列/ 来/ 看待/ ,/ 具体/ 为/ 一个/ 从/ 进程/ 优先级/ 到/ 对应/ 优先级/ 的/ 进程/ 队列/ 的/ 映射/ ,/ 即/ 输入/ 一个/ 进程/ 优先级/ ,/ 得到/ 该/ 优先级/ 对应/ 的/ 进程/ 队列/ ,/ 从而/ 实现/ 多/ 优先级/ 进程/ 队列/ ./ (/ 2/ )/ 行为/ 语义/ 针对/ 优化/ 层/ 引入/ 的/ 多级/ 进程/ 队列/ 对象/ ,/ 系统/ 行为/ 语义/ 主要/ 涉及/ 对/ 多级/ 进程/ 队列/ 对象/ 的/ 操作/ ,/ 包括/ 进程/ 调度/ 行为/ schedule/ ,/ dequeue/ 和/ pick/ _/ proc/ ./ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ schedule/ ./ 在/ 基本/ 功效/ 层/ ,/ schedule/ 行为/ 将/ 就绪/ 进程/ 对象/ 插入/ 到/ 进程/ 队列/ 中/ ./ 在/ 优化/ 层/ ,/ 由于/ 引入/ 了/ 多/ 优先级/ 进程/ 队列/ ,/ 为此/ 首先/ 需要/ 根据/ 进程/ 的/ 优先级/ 和/ 时间/ 计算/ 进程/ 应该/ 位于/ 哪个/ 队列/ ,/ 以及/ 放在/ 队列/ 的/ 首部/ 或者/ 尾部/ 位置/ ./ 假设/ 在/ 状态/ s/ 时/ ,/ 系统/ 执行/ “/ 将/ 进程/ 对象/ p/ 放进/ 多/ 优先级/ 进程/ 队列/ ”/ 的/ 动作/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ schedule/ 在/ 优化/ 层/ 的/ 逻辑/ 语义/ 分/ 情况/ 描述/ 如下/ :/ ①/ 当/ 进程/ 对象/ p/ 的/ p/ _/ ticks/ _/ left/ 域/ 不/ 为/ 0/ 时/ ,/ 表示/ 进程/ 对象/ p/ 时间/ 片未用/ 完/ ,/ 将/ 进程/ p/ 放入/ 进程/ 对象/ 优先级/ p/ _/ priority/ 域/ 所/ 对应/ 的/ 优先级/ 队列/ 的/ 首部/ ,/ 其/ 语义/ 表示/ 如下/ :/ Page7w/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ ·/ ·/ =/ p/ #/ (/ s/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ )/ ifs/ ./ pset/ ./ p/ ./ p/ _/ ticks/ _/ left/ ≠/ 0/ ②/ 当/ 进程/ 对象/ p/ 的/ p/ _/ ticks/ _/ left/ 域/ 为/ 0/ ,/ 并且/ 进程/ 对象/ p/ 不是/ 内核/ 进程/ (/ proc/ _/ nr/ >/ 0/ )/ ,/ 同时/ 在/ 系统/ 的/ 上/ 一时间/ 片/ 已/ 占有/ CPU/ 资源/ (/ w/ ./ prev/ _/ proc/ =/ p/ )/ ,/ 并且/ 进程/ 对象/ p/ 不是/ 最/ 低优先级/ (/ p/ _/ priority/ </ 15/ )/ 时/ ,/ 那么/ 应该/ 降低/ 进程/ 对象/ p/ 的/ 优先级/ ,/ VTOS/ 采用/ 优先级/ 增加/ 1/ 来/ 实现/ ,/ 同时/ 将/ 进程/ 对象/ p/ 放入/ 新/ 的/ 优先级/ 队列/ 的/ 尾部/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p/ ./ p/ _/ priority/ ·/ ·/ =/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ +/ 1w/ ./ process/ _/ q/ (/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ +/ 1/ )/ ·/ ·/ =/ (/ s/ ./ process/ _/ q/ (/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ +/ 1/ )/ )/ #/ pifs/ ./ pset/ ./ p/ ./ p/ _/ ticks/ _/ left/ =/ 0/ ∧/ ③/ 当/ 进程/ 对象/ p/ 的/ p/ _/ ticks/ _/ left/ 域/ 为/ 0/ ,/ 并且/ 进程/ 对象/ p/ 不是/ 内核/ 进程/ (/ proc/ _/ nr/ >/ 0/ )/ ,/ 同时/ 进程/ 对象/ p/ 在/ 系统/ 的/ 上/ 一时间/ 片未/ 占有/ CPU/ 资源/ (/ w/ ./ prev/ _/ proc/ ≠/ p/ )/ ,/ 并且/ 进程/ 对象/ p/ 不是/ 最高/ 优先级/ (/ p/ _/ priority/ >/ 0/ )/ 时/ ,/ 那么/ 应该/ 提高/ 进程/ 对象/ p/ 的/ 优先级/ ,/ VTOS/ 采用/ 优先级/ 减少/ 1/ 来/ 实现/ ,/ 同时/ 将/ 进程/ 对象/ p/ 放入/ 新/ 的/ 优先级/ 队列/ 的/ 尾部/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ pset/ ./ p/ ./ p/ _/ priority/ ·/ ·/ =/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ -/ 1w/ ./ process/ _/ q/ (/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ -/ 1/ )/ ·/ ·/ =/ (/ s/ ./ process/ _/ q/ (/ s/ ./ pset/ ./ p/ ./ p/ _/ priority/ -/ 1/ )/ )/ #/ pifs/ ./ pset/ ./ p/ ./ p/ _/ ticks/ _/ left/ =/ 0/ ∧/ ④/ 对于/ 其他/ 情况/ ,/ 将/ 进程/ 对象/ p/ 放入/ 进程/ 对象/ 优先级/ p/ _/ priority/ 域/ 所/ 对应/ 的/ 优先级/ 队列/ 的/ 尾部/ ,/ 其/ 语义/ 表示/ 如下/ :/ w/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ ·/ ·/ =/ 队列/ 中/ 去除/ ,/ 其/ 语义/ 表示/ 如下/ :/ (/ s/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ )/ #/ pifother/ 多级/ 进程/ 队列/ 出队/ 操作/ 行为/ dequeue/ ./ 对应/ 地/ ,/ dequeue/ 行为/ 将/ 进程/ 对象/ 从/ 多/ 优先级/ w/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ ·/ ·/ =/ (/ s/ ./ process/ _/ qs/ ./ pset/ ./ p/ ./ p/ _/ priority/ )/ \/ p/ 进程/ 选择/ 操作/ 行为/ pick/ _/ proc/ ./ pick/ _/ proc/ 行为/ 在/ 基本/ 功效/ 层/ 选择/ 下/ 一个/ 将要/ 运行/ 的/ 进程/ ,/ 由于/ 在/ 优化/ 层/ 引入/ 多/ 优先级/ 进程/ 队列/ ,/ pick/ _/ proc/ 将/ 在/ 多级/ 队列/ 中/ 选择/ 就绪/ 进程/ ,/ 按照/ 优先级/ 从/ 高到/ 低/ 的/ 顺序/ 检查/ 各级/ 队列/ ,/ 每个/ 队列/ 中/ 从/ 首部/ 开始/ 选取/ ./ 假设/ 在/ s/ 状态/ 下/ 选择/ 多级/ 进程/ 队列/ 中/ 的/ 进程/ 对象/ 占有/ CPU/ 资源/ ,/ 在/ 状态/ w/ 时/ 完成/ 这一/ 功效/ ./ 其/ 语义/ 表示/ 如下/ :/ pick/ _/ proc/ :/ w/ ./ next/ _/ running/ _/ proc/ ·/ ·/ =/ pick/ _/ ps015/ 子/ 过程/ pick/ _/ ptbeginend/ 定义/ 如下/ :/ pick/ _/ ptbeginend/ ·/ ·/ =/ pick/ _/ pt/ (/ begin/ +/ 1/ )/ end/ 烄/ ift/ ./ process/ _/ qbegin/ =/ NULL/ ∧/ begin/ </ endhead/ (/ t/ ./ process/ _/ qbegin/ )/ 烅/ ift/ ./ process/ _/ qbegin/ ≠/ NULLIDLE/ 烆/ ifother3VTOS/ 系统安全/ 需求/ 本/ 节/ 阐述/ VTOS/ 系统/ 的/ 安全/ 需求/ 分析/ ,/ 并/ 使用/ 带有/ 时序/ 逻辑/ 的/ 高阶/ 逻辑/ 对/ 安全/ 需求/ 进行/ 了/ 严格/ 的/ 定义/ ./ 对于/ VTOS/ 微内核/ 部分/ ,/ 考虑/ 到/ 安全/ 需求/ 的/ 多样性/ 以及/ 可验证/ 性/ ,/ 我们/ 主要/ 分析/ 的/ 安全/ 需求/ 类型/ 包括/ 完整性/ 、/ 隔离/ 性/ 和/ 机密性/ ./ 对于/ 完整性/ ,/ 传统/ 的/ 理解/ 认为/ 在/ 系统/ 运行/ 过程/ 中/ 需要/ 保证系统/ 代码/ 的/ 完整性/ 和/ 数据完整性/ ,/ 即/ 代码/ 和/ 数据/ 不可/ 被/ 恶意/ 地/ 修改/ ,/ 这些/ 可以/ 通过/ 访问/ 控制策略/ 实现/ ./ 除了/ 代码/ 和/ 数据完整性/ ,/ 我们/ 认为/ 还/ 需要/ 做到/ 系统/ 功效/ 的/ 完整性/ ,/ 即/ 系统/ 的/ 功能/ 行为/ 始终/ 能/ 完成/ 系统/ 设计所/ 期望/ 的/ 效果/ ./ 对于/ 隔离/ 性/ ,/ 主要/ 包括/ 进程/ 空间隔离/ 性/ 和/ 进程/ 行为/ 的/ 隔离/ 性/ ./ 进程/ 空间隔离/ 性是/ 指/ 进程/ 对象/ 的/ 页表/ 相互之间/ 不/ 存在/ 交集/ ./ 进程/ 行为/ 隔离/ 性是/ 指/ 进程/ 在/ 运行/ 过程/ 中/ ,/ 相互之间/ 不会/ 干扰/ 对方/ 的/ 行为/ ./ 对于/ 机密性/ ,/ 进程/ 对象/ 无法访问/ 其他/ 进程/ 对象/ 的/ 私有/ 数据/ 部分/ ,/ 即/ 进程/ 对象/ 的/ 私有/ 数据/ 不会/ 泄露/ 给/ 其他/ 进程/ 对象/ ./ 限于/ 篇幅/ ,/ 本文/ 主要/ 从/ 系统/ 功效/ 完整性/ 和/ 进程/ 行为/ 隔离/ 性/ 这/ 两/ 方面/ ,/ 来/ 对/ VTOS/ 微内核/ 的/ 安全/ 需求/ 进行/ 分析/ 、/ 定义/ 和/ 验证/ ./ OSOSM/ 以/ 高阶/ 逻辑/ (/ Higher/ -/ OrderLogic/ ,/ HOL/ )/ 为/ 元逻辑/ ,/ 支持/ 基本/ 的/ 逻辑/ 命题演算/ ,/ 并且/ 包括/ 简单/ 类型/ 理论/ (/ simpletypetheory/ )/ 和/ 类型化/ 的/ λ/ 演算/ (/ typedlambdacalculus/ )/ ,/ 提供/ 丰富/ 的/ 对象/ 表达能力/ ./ 在/ 第/ 2/ 节/ 的/ 基础/ 上/ ,/ 我们/ 使用/ VTOS/ 微内核/ 的/ 语义/ 函数/ 并/ 结合/ 时序/ 逻辑/ 来/ 阐述/ VTOS/ 的/ 安全性/ Page8/ 目标/ ,/ 其中/ 时序/ 逻辑/ 主要/ 是/ 对/ 安全/ 需求/ 中/ 与/ 时间/ 有关/ 的/ 问题/ 进行/ 描述/ ./ 下/ 一/ 小节/ 首先/ 对/ 需求/ 描述/ 用到/ 的/ 时序/ 逻辑/ 进行/ 说明/ ./ 3.1/ 时序/ 逻辑/ 时序/ 逻辑/ 用于/ 描述/ 系统/ 关于/ 时间/ 问题/ 的/ 需求/ ,/ 包括/ 线性/ 时序/ 逻辑/ (/ LinearTemporalLogic/ ,/ LTL/ )/ 和/ 计算/ 树/ 逻辑/ (/ ComputationTreeLogic/ ,/ CTL/ )/ ./ LTL/ 对/ 时间/ 的/ 描述/ 是/ 线性/ (/ 严格/ 偏序/ )/ 的/ ,/ 即/ 在/ 时间/ 序列/ 上/ 任意/ 两个/ 时间/ 点/ 都/ 是/ 有/ 前后/ 关系/ 的/ ;/ CTL/ 主要/ 用于/ 描述/ 分支/ 时间/ (/ branching/ -/ time/ )/ 序列/ 结构/ ,/ 即/ 在/ 时间/ 序列/ 上/ 每个/ 时间/ 点/ 允许/ 存在/ 分支/ 的/ 不同/ 直接/ 前驱/ 和/ 直接/ 后继/ 时间/ 节点/ ./ 时序/ 逻辑/ 中/ 讨论/ 的/ 是/ 时间/ 序列/ ,/ 而/ OSOSM/ 采用/ 状态机/ 的/ 方式/ 对系统/ 进行/ 描述/ ,/ 即/ 描述/ 的/ 是/ 状态/ 序列/ ./ 为此/ 我们/ 在/ 使用/ 时序/ 逻辑/ 对/ VTOS/ 的/ 安全/ 需求/ 进行/ 描述/ 时/ ,/ 将/ 状态/ 序列/ 作为/ 时间/ 序列/ 来/ 看待/ ./ 这/ 存在/ 一个/ 问题/ ,/ 时间/ 序列/ 不/ 存在/ “/ 回归/ ”/ 现象/ ,/ 是/ 一种/ 树结构/ ,/ 而/ 状态/ 序列/ 可能/ 存在/ “/ 回归/ ”/ 现象/ ,/ 即环/ 结构/ ,/ 如/ s0/ →/ s1/ →/ s2/ →/ s3/ →/ s4/ →/ s0/ ,/ 这/ 与/ 时间/ 序列/ 存在/ 不/ 一致/ ./ 为此/ 我们/ 对/ 状态/ 序列/ 的/ 描述/ 进行/ 不/ 回归/ 处理/ ,/ 如/ 上述/ 的/ 状态/ 序列/ 表示/ 成/ s0/ →/ s1/ →/ s2/ →/ s3/ →/ s4/ →/ s5/ ,/ 其中/ s0/ =/ s5/ ./ VTOS/ 在/ 每个/ 状态/ 下/ 可能/ 的/ 后继/ 状态/ 是/ 不/ 确定/ 的/ ,/ 这/ 主要/ 由/ 系统/ 的/ 行为/ 动作/ 决定/ ,/ 因此/ 是/ 分支/ 状态/ 序列/ 结构/ ./ 我们/ 采用/ CTL/ 对/ VTOS/ 的/ 安全/ 需求/ 进行/ 描述/ ./ CTL/ 的/ 时序/ 描述符/ 主要/ 包括/ :/ 路径/ 分支/ 描述/ A/ // E/ 和/ 序列/ 路径/ 描述/ G/ // F/ // X/ ./ 假设/ θ/ 为/ 分支/ 路径/ 命题/ ,/ 时序/ 描述符/ A/ // E/ 定义/ 如下/ :/ s/ / A/ θ/ 表示/ “/ 从/ 状态/ s/ 开始/ ,/ 对于/ 所有/ 状态/ 路径/ ,/ 命题/ θ/ 成立/ ”/ ;/ s/ / E/ θ/ 表示/ “/ 从/ 状态/ s/ 开始/ ,/ 存在/ 某条/ 状态/ 路径/ ,/ 该/ 路径/ 上/ 命题/ θ/ 成立/ ”/ ;/ 假设/ φ/ 为/ 序列/ 路径/ 命题/ ,/ 即/ 对于/ 单条/ 路径/ 的/ 命题/ ,/ 时序/ 描述符/ G/ // F/ // X/ 定义/ 如下/ :/ s/ / F/ φ/ 表示/ “/ 从/ 状态/ s/ 开始/ ,/ 在/ 单/ 路径/ 上/ 将来/ 某个/ 状态/ ,/ 命题/ φ/ 成立/ ”/ ;/ s/ / G/ φ/ 表示/ “/ 从/ 状态/ s/ 开始/ ,/ 在/ 单/ 路径/ 上/ 将来/ 所有/ 状态/ ,/ 命题/ φ/ 成立/ ”/ ;/ s/ / X/ φ/ 表示/ “/ 在/ 单/ 路径/ 上/ ,/ 对于/ 状态/ s/ 的/ 下/ 一个/ 状态/ ,/ 命题/ φ/ 成立/ ”/ ./ 路径/ 分支/ 和/ 序列/ 路径/ 描述符/ 相结合/ 如图/ 2/ 所示/ ./ CTL/ 中/ 没有/ 表示/ “/ 动作/ 对/ 状态/ 路径/ 分支/ 的/ 影响/ ”/ 的/ 方法/ ,/ 我们/ 对/ 其/ 进行/ 扩展/ ,/ 使用/ “/ s/ ,/ action/ ├/ β/ ”/ 来/ 表示/ “/ 在/ 当前/ 状态/ s/ 下/ 执行/ action/ 动作/ 后/ ,/ 在/ 后续/ 状态/ 路径/ 会/ 满足/ β/ ”/ ,/ 即/ 当前/ 状态/ s/ 的/ 直接/ 后继/ 根据/ action/ 动作/ 可以/ 得到/ 确定/ ,/ 如图/ 3/ 所示/ ./ 以下/ 章节/ 从/ 系统/ 功效/ 完整性/ 和/ 进程/ 行为/ 隔离/ 性/ 这/ 两/ 方面/ ,/ 并/ 从/ 消息/ 处理/ 、/ 进程/ 调度/ 和/ 中断/ 处理/ 的/ 角度/ ,/ 开始/ 对/ VTOS/ 微内核/ 行为/ 的/ 安全/ 需求/ 进行/ 分析/ ./ 3.2/ 消息/ 处理/ 行为/ 的/ 功效/ 完整性/ 安全/ 需求/ (/ 1/ )/ 消息/ 发送/ 行为/ send/ 能/ 正确/ 地/ 将/ 发送者/ 进程/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲区/ 中/ 的/ 消息/ 体/ 复制到/ 接收者/ 进程/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲区/ 中/ ./ 谓词/ 公式/ 表示/ 如下/ :/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ sendp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ =/ 其中/ ,/ λ/ 运算/ 用于/ 对/ 完成/ 功效/ 的/ 状态/ 进行/ 抽象/ ./ 对应/ 地/ ,/ 通知/ 发送/ 行为/ notify/ 能/ 正确/ 地/ 将/ 通知/ 发送到/ 接收者/ 进程/ 对象/ ./ 谓词/ 公式/ 表示/ 如下/ :/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ notifyp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ w/ ./ pset/ ./ p2/ ./ p/ _/ messbuf/ =/ Page9/ 对于/ 接收/ 行为/ receive/ ,/ 由于/ 消息/ 、/ 通知/ 发送/ 行为/ 的/ 正确性/ 都/ 依赖于/ 接收/ 行为/ ,/ 在/ φ/ 1/ 和/ φ/ 2/ 安全/ 需求/ 中/ 已/ 隐含/ 接收/ 行为/ 的/ 功效/ 完整性/ ,/ 为此/ 不/ 单独/ 对/ 接收/ 行为/ receive/ 的/ 功效/ 完整性/ 进行/ 定义/ ./ (/ 2/ )/ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何时刻/ ,/ 微内核/ 的/ 消息/ 处理/ 行为/ 都/ 能/ 完成/ 上述/ 第/ 1/ 点/ 的/ 功能/ 需求/ ./ 谓词/ 公式/ 表示/ 如下/ :/ 3.3/ 进程/ 调度/ 行为/ 的/ 功效/ 完整性/ 安全/ 需求/ (/ 1/ )/ 微内核/ 的/ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ schedule/ 能/ 正确/ 地/ 将/ 进程/ 加入/ 到/ 多级/ 进程/ 队列/ 中/ ./ 谓词/ 公式/ 表示/ 如下/ :/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ schedulep/ )/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ / i/ ./ 0/ / i/ / 15/ ∧/ 微内核/ 的/ 多级/ 进程/ 队列/ 出队/ 操作/ 行为/ dequeue/ 能/ 正确/ 地/ 将/ 进程/ 从/ 多级/ 进程/ 队列/ 中/ 删除/ ./ 谓词/ 公式/ 表示/ 如下/ :/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ dequeuep/ )/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ / i/ ./ 0/ / i/ / 15/ →/ / s/ ∈/ S/ ./ (/ s/ ,/ pick/ _/ proc/ ├/ 微内核/ 的/ 进程/ 选择/ 操作/ 行为/ pick/ _/ proc/ 能/ 正确/ 地/ 将/ CPU/ 资源分配/ 给/ 多级/ 进程/ 队列/ 中/ 的/ 进程/ 对象/ ./ 谓词/ 公式/ 表示/ 如下/ :/ AX/ (/ λ/ w/ ∷/ state/ ./ w/ ./ next/ _/ running/ _/ proc/ =/ pick/ _/ ps015/ )/ )/ (/ φ/ 6/ )/ (/ 2/ )/ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何时刻/ ,/ 微内核/ 的/ 进程/ 调度/ 行为/ 都/ 能/ 完成/ 上述/ 第/ 1/ 点/ 的/ 功能/ 需求/ ./ 谓词/ 公式/ 表示/ 如下/ :/ 3.4/ 中断/ 处理/ 行为/ 的/ 功效/ 完整性/ 安全/ 需求/ (/ 1/ )/ 微内核/ 的/ 中断/ 处理/ 行为/ 能/ 正确/ 地/ 根据/ 不同/ 的/ 中断/ 源/ ,/ 对系统/ 缓冲区/ 对象/ 进行/ 设置/ ./ 谓词/ 公式/ 表示/ 如下/ :/ / s/ ∈/ S/ ./ (/ s/ ,/ interrupt/ _/ handle/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ (/ 2/ )/ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何时刻/ ,/ 微内核/ 的/ 中断/ 处理/ 行为/ 都/ 能/ 完成/ 上述/ 第/ 1/ 点/ 的/ 功能/ 需求/ ./ 谓词/ 公式/ 表示/ 如下/ :/ 3.5/ 进程/ 行为/ 隔离/ 性需求/ 微内核/ 的/ 进程/ 行为/ 不会/ 受到/ 其他/ 进程/ 对象/ 的/ 干扰/ ,/ 换句话说/ 微内核/ 的/ 上述/ 消息/ 处理/ 、/ 进程/ 调度/ 以及/ 中断/ 处理/ 行为/ 在/ 初始状态/ s0/ 为/ 可信/ 的/ 情况/ 下/ ,/ 任何/ 后续/ 状态/ 都/ 能/ 完成/ 期望/ 的/ 功效/ ,/ 谓词/ 公式/ 表示/ 如下/ :/ s0/ / AG/ (/ φ/ 1/ ∧/ φ/ 2/ ∧/ φ/ 4/ ∧/ φ/ 5/ ∧/ φ/ 6/ ∧/ φ/ 8/ )/ (/ φ/ 10/ )/ 上述/ 安全/ 需求/ 以/ 初始状态/ s0/ 是/ 可信/ 状态/ 为/ 前提/ ,/ 我们/ 通过/ 可信/ 启动/ 来/ 保证/ 这/ 一点/ ./ VTOS/ 启动/ 过程/ 的/ 安全/ 保护/ 由/ 基于/ TPM/ 的/ 可信/ 启动/ 来/ 完成/ ./ 我们/ 在/ VTOS/ 中/ 整合/ 了/ tboot/ 软件/ ,/ 通过/ 对/ VTOS/ 启动/ 过程/ 中/ 系统/ 镜像/ 进行/ 验证/ 来/ 防止/ 对系统/ 的/ 恶意/ 篡改/ 和/ 破坏/ ,/ 保证系统/ 运行/ 的/ 初始状态/ 的/ 可信性/ ./ 4VTOS/ 设计/ 与/ 安全/ 需求/ 的/ 一致性/ 验证/ 本/ 节/ 阐述/ VTOS/ 形式化/ 设计/ 与/ 安全/ 需求/ 一致性/ 的/ 验证/ ./ 在/ 第/ 2/ 节/ ,/ 我们/ 使用/ OSOSM/ 描述/ VTOS/ 的/ 设计/ ,/ 为此/ ,/ 一致性/ 验证/ 即/ 是/ 验证/ OSOSM/ 模型/ 的/ 语义/ 是否/ 符合/ 第/ 3/ 节/ 提出/ 的/ 安全/ 需求/ ./ 我们/ 借助/ 定理/ 证明/ 器/ Isabelle/ // HOL/ 来/ 实现/ 整个/ 验证/ 过程/ ./ 验证/ 方法/ 分成/ 3/ 个/ 部分/ :/ (/ 1/ )/ 利用/ Isabelle/ // HOL/ 对/ 第/ 2/ 节/ 描述/ 的/ OSOSM/ 模型/ 进行/ 形式化/ 建模/ ;/ (/ 2/ )/ 安全/ 需求/ 的/ 时序/ 逻辑/ 部分/ 在/ Isabelle/ // HOL/ 中/ 的/ 验证/ 方法/ ;/ (/ 3/ )/ 系统/ 设计/ 与/ 安全/ 需求/ 的/ 一致性/ 验证/ ./ 4.1/ Isabelle/ // HOL/ 验证/ 系统/ 这一/ 小节/ 介绍/ 验证/ 过程/ 将/ 用到/ 的/ Isabelle/ // HOL/ 验证/ 系统/ ./ Isabelle/ 是/ 一种/ 定理/ 证明/ 器/ ,/ 主要/ 用于/ 验证/ 使用/ 逻辑系统/ 描述/ 的/ 抽象/ 问题/ ,/ 可以/ 对/ 计算机系统/ 的/ 程序逻辑/ 进行/ 严格/ 的/ 验证/ ./ Isabelle/ // HOL/ 是/ 对/ 高阶/ 逻辑/ 的/ 支持/ ,/ 采用/ 函数/ 式/ 编程/ (/ functionalprogramming/ )/ 的/ 方式/ 提供/ 交互式/ 的/ 验证/ 环境/ ./ Isabelle/ // HOL/ 是/ 一种/ 类型/ 系统/ (/ typesystem/ )/ ,/ 类型/ 变量/ (/ typevariable/ )/ 可以/ 采用/ a/ ,/ b/ 等/ 方式/ 来/ 表达/ ;/ 对于/ 类型/ 的/ 项/ (/ term/ )/ 如/ x/ ∷/ a/ ,/ 表示/ 变量/ x/ 是/ 类型/ a/ 的/ 项/ ./ 对于/ 复杂/ 数据类型/ 的/ 构造/ ,/ 可以/ 采用/ 3/ 种/ 方式/ :/ types/ ,/ datatype/ 和/ record/ ./ types/ 用于/ 定义数据/ 类型/ 的/ 简化/ 别名/ ,/ 如/ typespid/ =/ int/ ,/ 定义新/ 类型/ pid/ 是/ 整数/ 的/ 别名/ ;/ datatype/ 用于/ 定义/ 复合/ 的/ 结构/ 类型/ ,/ 如/ 我们/ 对于/ 消息/ 类型定义/ 为/ Page10/ 表示/ VTOS/ 的/ 消息/ 类型/ 包括/ 6/ 种/ 普通/ 消息/ 格式/ 和/ 通知/ 类型/ ,/ 以/ m/ _/ 1/ ~/ m/ _/ 6/ 和/ Notify/ 表示/ ./ 2.2/ ./ 1/ 节/ 描述/ 的/ 消息/ 对象/ ,/ 可以/ 定义/ 为/ record/ 用于/ 定义/ 带/ 名称/ 的/ 元组/ 类型/ ,/ 如/ 对于/ recordmessage/ =/ m/ _/ source/ ∷/ pid/ 表示/ 消息/ message/ 包含/ 3/ 个/ 部分/ :/ m/ _/ source/ 表示/ 消息/ 的/ 来源/ ,/ 类型/ 是/ pid/ ,/ 即/ 进程/ 标识符/ ;/ m/ _/ type/ 表示/ 消息/ 的/ 类型/ ,/ 类型/ 是/ 新/ 类型/ msg/ ,/ msg/ 描述/ 消息/ 的/ 种类/ ,/ 可以/ 使用/ datatype/ 构造/ ;/ m/ _/ content/ 表示/ 消息/ 体/ ,/ 类型/ 是/ 字符串/ string/ ./ 假设/ m/ 的/ 类型/ 为/ message/ ,/ 引用/ 成员/ 域/ 可以/ 表达/ 为/ 如/ m/ _/ sourcem/ ,/ 表示/ 引用/ m/ 的/ m/ _/ source/ 域/ ./ 对于/ record/ 类型/ 的/ 更新/ 操作/ ,/ 假设/ m/ 拥有/ 值/ (/ |/ m/ _/ source/ =/ 2/ ,/ m/ _/ type/ =/ m/ _/ 1/ ,/ m/ _/ content/ =/ “/ request/ ”/ |/ )/ ,/ 那么/ 更新/ 操作/ 表达/ 为/ 如/ m/ (/ |/ m/ _/ content/ ·/ ·/ =/ “/ ack/ ”/ |/ )/ ,/ 表示/ 对象/ m/ 中/ m/ _/ content/ 域/ 修改/ 为/ “/ ack/ ”/ ,/ 其他/ 域/ 保持/ 不变/ ./ 对于/ 函数/ 定义/ ,/ 采用/ “/ =/ >/ ”/ 符号/ 描述/ 函数/ 从/ 定义域/ 到/ 值域/ 的/ 映射/ 关系/ ./ 函数/ 更新/ 操作/ 表达/ 为/ 如/ g/ (/ x/ ·/ ·/ =/ y/ )/ ,/ 表示/ 函数/ g/ 在/ x/ 处/ 的/ 值/ 修改/ 为/ y/ ,/ 定义域/ 其他/ 点/ 保持/ 不变/ ./ 对于/ 集合/ 操作/ ,/ 可以/ 采用/ “/ {/ s/ ./ Ps/ }/ ”/ 定义/ 一个/ 集合/ ,/ 其中/ 所有/ 的/ 元素/ 满足/ 谓词/ 公式/ P/ ;/ 对于/ 集合/ 的/ “/ 补/ ”/ 操作/ ,/ 可以/ 使用/ “/ -/ A/ ”/ 来/ 表示/ 集合/ A/ 的/ 补集/ ./ Isabelle/ // HOL/ 支持/ lambda/ 演算/ ,/ 例如/ 对于/ 集合/ 运算/ Y/ =/ C/ ∪/ X/ ,/ C/ 为/ 集合/ 常量/ ,/ X/ 、/ Y/ 为/ 集合/ 变量/ ,/ 可以/ 使用/ “/ λ/ X/ ./ C/ ∪/ X/ ”/ 来/ 表示/ 函数/ Y/ 的/ 操作/ 子/ ./ Isabelle/ // HOL/ 将/ 关系/ (/ relation/ )/ 作为/ 2/ 元/ 对/ (/ pair/ )/ 的/ 集合/ 来/ 看待/ ./ 对于/ 关系/ 的/ 转置/ (/ converse/ )/ 定义/ 为/ :/ (/ a/ ,/ b/ )/ ∈/ M/ -/ 1/ ≡/ (/ b/ ,/ a/ )/ ∈/ M/ ,/ M/ -/ 1/ 表示/ 关系/ M/ 的/ 转置/ 关系/ ;/ 关系/ 的/ 自反/ 传递/ 闭包/ (/ reflexivetransi/ -/ tiveclosure/ )/ 使用/ 如/ M/ / 来/ 表示/ ./ 对于/ 集合/ 在/ 关系/ 上/ 的/ “/ 象/ (/ image/ )/ ”/ 集合/ ,/ 使用/ 如/ “/ MA/ ”/ 来/ 表示/ ,/ 定义/ 为/ b/ ∈/ (/ MA/ )/ ≡/ / a/ ∈/ A/ ./ (/ a/ ,/ b/ )/ ∈/ M/ ,/ 即/ “/ MA/ ”/ 表示/ 由/ 集合/ A/ 中/ 元素/ 在/ 关系/ M/ 中/ 的/ 2/ 元/ 对/ 的/ 第/ 2/ 元/ 组成/ 的/ 集合/ ./ 下面/ 我们/ 阐述/ VTOS/ 微内核/ 模型/ OSOSM/ 在/ Isabelle/ // HOL/ 中/ 的/ 建模/ 过程/ ./ 4.2/ OSOSM/ 的/ Isabelle/ // HOL/ 方式/ 建模/ 4.2/ ./ 1/ 对象/ 论域/ Isabelle/ // HOL/ 方式/ 定义/ 如下/ :/ 对于/ 第/ 2/ 节/ 描述/ 的/ VTOS/ 微内核/ 对象/ 论域/ ,/ (/ ELOCKED/ |/ OK/ )/ "/ datatypertsflag/ =/ RECEIVING/ |/ SENDING/ |/ NULLdatatypedata/ =/ data/ _/ from/ _/ disk/ |/ data/ _/ from/ _/ inputtypespid/ =/ inttypesintr/ =/ INTR/ _/ DISK/ |/ INTR/ _/ KEYBOARDrecordmessage/ =/ m/ _/ source/ ∷/ pidm/ _/ type/ ∷/ msgm/ _/ content/ ∷/ stringrecordprocess/ =/ proc/ _/ nr/ ∷/ pidp/ _/ messbuf/ ∷/ messagep/ _/ rts/ _/ flags/ ∷/ rtsflagp/ _/ getfrom/ ∷/ "/ pid/ |/ ANY/ "/ p/ _/ sendto/ ∷/ pidp/ _/ lastcall/ ∷/ "/ (/ SEND/ |/ RECEIVE/ |/ NOTIFY/ )/ ×/ s/ _/ notify/ _/ pending/ ∷/ "/ pidlist/ "/ s/ _/ msg/ _/ pending/ ∷/ "/ pidlist/ "/ p/ _/ priority/ ∷/ natp/ _/ ticks/ _/ left/ ∷/ natrecordstate/ =/ pset/ ∷/ "/ pid/ =/ >/ process/ "/ process/ _/ q/ ∷/ "/ nat/ =/ >/ pidlist/ "/ sys/ _/ buffer/ ∷/ dataintr/ _/ source/ ∷/ intrnext/ _/ running/ _/ proc/ ∷/ pidprev/ _/ proc/ ∷/ pidS/ ∷/ "/ stateset/ "/ 其中/ ,/ rtsflag/ 为/ 消息/ 发送/ 和/ 接收/ 状态/ 的/ 类型/ ;/ intr/ 为/ 中断/ 类型/ ,/ 包括/ 硬盘/ 中断/ INTR/ _/ DISK/ 和/ 键盘/ 中断/ INTR/ _/ KEYBOARD/ ;/ p/ _/ lastcall/ 为/ 进程/ 对象/ 最近/ 一次/ 消息/ 行为/ 语义/ 的/ 标识/ 信息/ ,/ 定义/ 为/ 2/ 元/ 对/ ,/ 第/ 1/ 元/ 取值/ SEND/ |/ RECEIVE/ |/ NOTIFY/ ,/ 第/ 2/ 元/ 取值/ ELOCKED/ |/ OK/ ./ 4.2/ ./ 2VTOS/ 微内核/ 行为/ 语义/ 为/ 语义/ 采用/ Isabelle/ // HOL/ 方式/ 进行/ 表达/ ./ 下面/ 我们/ 对/ 第/ 2/ 节中/ 描述/ 的/ VTOS/ 微内核/ 行/ (/ 1/ )/ 消息/ 处理/ 行为/ 在/ 基本/ 功效/ 层/ ,/ 从/ 功效/ 上/ 来说/ ,/ 微内核/ 的/ 消息/ 处理/ 行为/ 是/ 将/ 发送者/ 进程/ PCB/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲区/ 中/ 的/ 消息/ 体/ 复制到/ 接收者/ 进程/ PCB/ 对象/ 所/ 指示/ 的/ 消息/ 缓冲区/ 中/ ./ VTOS/ 消息/ 处理/ 采用/ “/ 汇合/ 机制/ ”/ ,/ 为此/ 我们/ 使用/ Isabelle/ 描述/ 时/ 需要/ 考虑/ 3/ 个/ 状态/ :/ 消息/ 放送/ 状态/ 、/ 消息/ 接收/ 状态/ 、/ 完成/ 功效/ 状态/ ./ 消息/ 、/ 通知/ 发送/ 行为/ 和/ 接收/ 行为/ 具体/ 定义/ 如下/ :/ Page11definitionSysSend/ ∷/ "/ pid/ =/ >/ pid/ =/ >/ state/ =/ >/ state/ "/ where/ "/ SysSendp1p2s/ ≡/ (/ letnewp1/ _/ 1/ =/ (/ psets/ )/ p1/ (/ |/ p/ _/ lastcall/ ·/ ·/ =/ (/ SEND/ ,/ ELOCKED/ )/ |/ )/ ;/ newp2/ _/ 1/ =/ (/ psets/ )/ p2/ (/ |/ p/ _/ messbuf/ ·/ ·/ =/ (/ p/ _/ messbuf/ (/ (/ psets/ )/ p1/ )/ )/ ,/ p/ _/ rts/ _/ flags/ ·/ ·/ =/ NULL/ |/ )/ ;/ newp2/ _/ 2/ =/ (/ psets/ )/ p2/ (/ |/ s/ _/ msg/ _/ pending/ ·/ ·/ =/ (/ s/ _/ msg/ _/ pending/ (/ (/ psets/ )/ p2/ )/ )/ @/ (/ p1/ #/ [/ ]/ )/ |/ )/ in/ (/ ifp/ _/ rts/ _/ flags/ (/ (/ psets/ )/ p2/ )/ =/ SENDING/ ∧/ thenSysSchedulep2/ (/ s/ (/ |/ pset/ ·/ ·/ =/ (/ psets/ )/ (/ p1/ ·/ ·/ =/ newp1/ _/ 2/ ,/ p2/ ·/ ·/ =/ newp2/ _/ 1/ )/ |/ )/ )/ elseSysDequeuep1/ (/ s/ (/ |/ pset/ ·/ ·/ =/ (/ psets/ )/ (/ p1/ ·/ ·/ =/ newp1/ _/ 3/ ,/ p2/ ·/ ·/ =/ newp2/ _/ 2/ )/ |/ )/ )/ )/ )/ )/ "/ definitionSysNotify/ ∷/ "/ pid/ =/ >/ pid/ =/ >/ state/ =/ >/ state/ "/ where/ "/ SysNotifyp1p2s/ ≡/ (/ letnewp1/ =/ (/ psets/ )/ p1/ (/ |/ p/ _/ lastcall/ ·/ ·/ =/ (/ NOTIFY/ ,/ OK/ )/ |/ )/ ;/ newp2/ _/ 1/ =/ (/ psets/ )/ p2/ (/ |/ p/ _/ messbuf/ ·/ ·/ =/ (/ |/ m/ _/ source/ =/ p1/ ,/ m/ _/ type/ =/ Notify/ ,/ m/ _/ content/ =/ NULL/ |/ )/ ,/ newp2/ _/ 2/ =/ (/ psets/ )/ p2/ (/ |/ s/ _/ notify/ _/ pending/ ·/ ·/ =/ (/ s/ _/ notify/ _/ pending/ (/ (/ psets/ )/ p2/ )/ )/ @/ (/ p1/ #/ [/ ]/ )/ |/ )/ in/ (/ ifp/ _/ rts/ _/ flags/ (/ (/ psets/ )/ p2/ )/ =/ RECEIVING/ ∧/ definitionSysReceive/ ∷/ "/ pid/ =/ >/ pid/ =/ >/ state/ =/ >/ state/ "/ where/ "/ SysReceivep2p1s/ ≡/ (/ letp1/ _/ 1/ =/ hd/ (/ s/ _/ msg/ _/ pending/ (/ (/ psets/ )/ p2/ )/ ;/ m/ _/ type/ =/ Notify/ ,/ m/ _/ content/ =/ NULL/ |/ )/ ,/ newp2/ _/ 4/ =/ (/ psets/ )/ p2/ (/ |/ p/ _/ lastcall/ ·/ ·/ =/ (/ RECEIVE/ ,/ OK/ )/ ,/ p/ _/ rts/ _/ flags/ ·/ ·/ =/ RECEIVING/ |/ )/ in/ (/ ifs/ _/ notify/ _/ pending/ (/ (/ psets/ )/ p2/ )/ ≠/ [/ ]/ Page12/ 其中/ ,/ SysSchedule/ 和/ SysDequeue/ 为/ 调度/ 行为/ ,/ 在/ 下面/ 将/ 定义/ ./ Isabelle/ // HOL/ 中/ 的/ 列表/ “/ 过滤/ ”/ 操作/ 子/ filter/ 将/ 不/ 满足/ 谓词/ 条件/ 的/ 列表/ 元素/ 删除/ ,/ 语义/ 定义/ 为/ filterP/ [/ ]/ ≡/ [/ ]/ filterP/ (/ x/ #/ xs/ )/ ≡/ (/ ifPxthenx/ #/ filterPxsIsabelle/ // HOL/ 中/ 的/ 列表/ “/ 蕴含/ ”/ 操作/ 子/ mem/ 判断/ 元素/ 是否/ 在/ 列表/ 中/ ,/ 语义/ 定义/ 为/ definitionSysSchedule/ ∷/ "/ pid/ =/ >/ state/ =/ >/ state/ "/ where/ "/ SysScheduleps/ ≡/ (/ letpriority/ =/ p/ _/ priority/ (/ (/ psets/ )/ p/ )/ ;/ newprocess/ _/ q/ _/ 4/ =/ (/ process/ _/ qs/ )/ (/ priority/ ·/ ·/ =/ (/ (/ process/ _/ qs/ )/ priority/ )/ @/ (/ p/ #/ [/ ]/ )/ )/ ;/ thens/ (/ |/ process/ _/ q/ ·/ ·/ =/ newprocess/ _/ q/ _/ 2/ ,/ pset/ ·/ ·/ =/ (/ psets/ )/ (/ p/ ·/ ·/ =/ newp/ _/ 1/ )/ |/ )/ definitionSysDequeue/ ∷/ "/ pid/ =/ >/ state/ =/ >/ state/ "/ where/ "/ SysDequeueps/ ≡/ s/ (/ |/ process/ _/ q/ ·/ ·/ =/ definitionSysPick/ _/ proc/ ∷/ "/ state/ =/ >/ state/ "/ where/ "/ SysPick/ _/ procs/ ≡/ s/ (/ |/ next/ _/ running/ _/ proc/ ·/ ·/ =/ pick/ _/ ps015/ |/ )/ "/ primrecpick/ _/ p/ ∷/ "/ state/ =/ >/ nat/ =/ >/ nat/ =/ >/ nat/ "/ where/ "/ pick/ _/ ptbeginend/ =/ (/ if/ (/ process/ _/ qt/ )/ begin/ =/ [/ ]/ ∧/ begin/ </ endthenpick/ _/ pt/ (/ begin/ +/ 1/ )/ endxmem/ [/ ]/ ≡/ Falsexmem/ (/ y/ #/ ys/ )/ ≡/ (/ ify/ =/ xthenTrueelsexmemys/ )/ (/ 2/ )/ 进程/ 调度/ 行为/ 微内核/ 的/ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ schedule/ 是/ 将/ 被/ 调度/ 的/ 进程/ PCB/ 对象/ 加入/ 到/ 进程/ 队列/ 对象/ 中/ ./ dequeue/ 行为/ 将/ 进程/ 对象/ 从/ 多/ 优先级/ 进程/ 队列/ 中/ 去除/ ./ pick/ _/ proc/ 行为/ 从/ 多/ 优先级/ 进程/ 队列/ 中/ 选择/ 将要/ 运行/ 的/ 进程/ ,/ 根据/ 第/ 2/ 节/ 的/ 语义/ 描述/ ,/ Isabelle/ // HOL/ 方式/ 描述/ 如下/ :/ Page13/ 数/ 的/ 定义/ ./ 其中/ ,/ primrec/ 是/ Isabelle/ // HOL/ 对/ 原始/ 递归/ 函/ (/ 3/ )/ 中断/ 处理/ 行为/ definitionSysInterrupt/ _/ handle/ ∷/ "/ state/ =/ >/ state/ "/ where/ "/ SysInterrupt/ _/ handles/ ≡/ 4.3/ 时序/ 逻辑/ 在/ Isabelle/ 中/ 的/ 验证/ 方法/ 第/ 3/ 节/ 采用/ 时序/ 逻辑/ 对/ VTOS/ 微内核/ 的/ 安全/ 需求/ 进行/ 了/ 描述/ ,/ 为了/ 使用/ Isabelle/ // HOL/ 验证/ OSOSM/ 与/ 安全/ 需求/ 的/ 一致性/ ,/ 首先/ 需要/ 解决/ Isabelle/ // HOL/ 验证/ 环境/ 中/ 构建/ 时序/ 逻辑/ 的/ 验证/ 过程/ ./ 时序/ 逻辑/ 在/ 模型/ 检测/ (/ modelchecking/ )/ 中/ 用于/ 描述/ 系统/ 的/ 需求/ 规格/ 说明/ (/ specification/ )/ ,/ 各种/ 模型/ 检测工具/ 都/ 支持/ 时序/ 逻辑/ 的/ 验证/ ./ 在/ 定理/ 证明/ 器/ Isabelle/ // HOL/ 中/ ,/ 使用/ 时序/ 逻辑/ 对/ 被/ 验证/ 的/ 系统/ 进行/ 规格/ 说明/ 并/ 验证/ 的/ 工作/ ,/ 存在/ 如何/ 对/ 时序/ 逻辑/ 进行/ 抽象/ 描述/ 的/ 问题/ ./ VTOS/ 形式化/ 设计/ 首次/ 尝试/ 在/ Isabelle/ // HOL/ 环境/ 、/ 操作系统/ 级/ 的/ 验证/ 过程/ 中/ 实现/ 对/ 时序/ 逻辑/ 的/ 描述/ ./ 下面/ ,/ 我们/ 阐述/ VTOS/ 微内核/ 安全/ 需求/ 的/ 时序/ 逻辑/ 部分/ 在/ Isabelle/ // HOL/ 中/ 的/ 描述/ 方法/ ./ VTOS/ 将/ 各种/ 行为/ 的/ 执行/ 功效/ 看成/ 是/ 对系统/ 状态/ 的/ 改变/ 或者/ 迁移/ ,/ 状态/ 转换/ 集合/ ST/ 定义/ 为/ ST/ ∷/ "/ (/ state/ ×/ state/ )/ set/ "/ ,/ 表示/ 系统/ 中/ 状态/ 之间/ 转换/ 的/ 集合/ ,/ 例如/ s2/ 是/ s1/ 的/ 直接/ 后继/ 状态/ ,/ 则/ 二元/ 对/ (/ s1/ ,/ s2/ )/ ∈/ ST/ ./ 对于/ 第/ 3/ 节/ 描述/ 的/ 安全/ 需求/ 的/ 时序/ 逻辑/ 部分/ 中/ 的/ 命题/ 类型/ ,/ 我们/ 定义/ 如下/ :/ datatypeF/ =/ Atomic/ "/ atomic/ "/ |/ AndFF/ |/ 表示/ 命题/ 公式/ 类型/ F/ 可以/ 是/ “/ 原子/ 命题/ Atomic/ ”/ 、/ “/ 合取/ 命题/ And/ ”/ 、/ “/ 析取/ 命题/ Or/ ”/ 、/ “/ 否定/ 命题/ Negative/ ”/ 以及/ 带/ 时序/ 逻辑/ 的/ 命题/ AG/ // EF/ // AX/ ./ 状态/ 可/ 满足/ 的/ 原子/ 命题/ 集合/ 定义/ 为/ Sat/ _/ Atomic/ ∷/ "/ state/ =/ >/ atomicset/ "/ ,/ 状态/ s/ 下/ 可/ 满足/ 的/ 原子/ 命题/ 集合/ 表示/ 为/ Sat/ _/ Atomics/ ,/ Sat/ _/ Atomics/ ≡/ {/ f/ ./ fs/ =/ True/ }/ ;/ VTOS/ 微内核/ 行为/ 类型/ 包括/ 消息/ 处理/ 、/ 进程/ 调度/ 和/ 中断/ 处理/ 行为/ ,/ 其/ 定义/ 如下/ :/ 微内核/ 的/ 中断/ 处理/ 行为/ 的/ 功效/ 是/ 根据/ 不同/ 的/ 中断/ 源/ ,/ 对系统/ 缓冲区/ 对象/ 进行/ 设置/ ,/ 本文/ 主要/ 描述/ 键盘/ 中断/ 和/ 磁盘/ 中断/ ./ Isabelle/ // HOL/ 方式/ 描述/ 如下/ :/ datatypeaction/ =/ sendpidpid/ 系统/ 行为/ 单步/ 执行/ 引起/ 的/ 状态/ 转换/ 函数/ step/ 定义/ 如下/ :/ funstep/ ∷/ "/ state/ =/ >/ action/ =/ >/ state/ "/ where/ "/ steps/ (/ sendp1p2/ )/ =/ SysSendp1p2s/ "/ |/ "/ steps/ (/ notifyp1p2/ )/ =/ SysNotifyp1p2s/ "/ |/ "/ steps/ (/ receivep2p1/ )/ =/ SysReceivep2p1s/ "/ |/ "/ steps/ (/ schedulep/ )/ =/ SysScheduleps/ "/ |/ "/ stepsinterrupt/ _/ handle/ =/ SysInterrupt/ _/ handles/ "/ 下面/ 我们/ 定义/ 安全/ 需求/ 命题/ 满足/ 性/ 函数/ ,/ 即/ 状态/ 对/ 安全/ 需求/ 命题/ 的/ 可/ 满足/ 性/ ,/ 和/ 第/ 3/ 节/ 保持一致/ ,/ 我们/ 使用/ “/ s/ / f/ ”/ 符号/ 表示/ “/ 在/ s/ 状态/ 下/ ,/ 命题/ f/ 成立/ ”/ ./ 其/ 定义/ 如下/ :/ primrecsat/ ∷/ "/ state/ =/ >/ F/ =/ >/ bool/ "/ (/ "/ _/ / _/ "/ )/ where/ "/ s/ / Atomica/ =/ (/ a/ ∈/ Sat/ _/ Atomics/ )/ "/ |/ "/ s/ / Andbc/ =/ (/ s/ / b/ ∧/ s/ / c/ )/ "/ |/ "/ s/ / Orbc/ =/ (/ s/ / b/ ∨/ s/ / c/ )/ "/ |/ "/ s/ / Negatived/ =/ (/ / (/ s/ / d/ )/ )/ "/ |/ "/ s/ / AGf/ =/ (/ / w/ ./ (/ s/ ,/ w/ )/ ∈/ ST/ / →/ w/ / f/ )/ "/ |/ "/ s/ / EFf/ =/ (/ / w/ ./ (/ s/ ,/ w/ )/ ∈/ ST/ / ∧/ w/ / f/ )/ "/ |/ "/ s/ / AXf/ =/ (/ / w/ ./ (/ s/ ,/ w/ )/ ∈/ ST/ →/ w/ / f/ )/ "/ 在/ 第/ 3/ 节中/ ,/ 我们/ 对/ 时序/ 逻辑/ 进行/ 了/ 扩展/ ,/ 加入/ 了/ 动作/ 对/ 状态/ 路径/ 分支/ 的/ 影响/ ,/ 在/ Isabelle/ // HOL/ 中/ 的/ 定义/ 如下/ :/ definitionstep/ _/ sat/ ∷/ "/ state/ =/ >/ action/ =/ >/ F/ =/ >/ bool/ "/ "/ s/ ,/ a/ ├/ f/ ≡/ stepsa/ / f/ "/ 集/ 的/ 函数/ :/ 接下来/ 我们/ 定义/ 求取/ 满足/ 安全/ 需求/ 命题/ 的/ 状态/ Page14primrecSAT/ ∷/ "/ F/ =/ >/ stateset/ "/ where/ "/ SAT/ (/ Atomica/ )/ =/ {/ s/ ./ a/ ∈/ Sat/ _/ Atomics/ }/ "/ |/ "/ SAT/ (/ Andbc/ )/ =/ SATb/ ∩/ SATc/ "/ |/ "/ SAT/ (/ Orbc/ )/ =/ SATb/ ∪/ SATc/ "/ |/ "/ SAT/ (/ Negatived/ )/ =/ -/ SATd/ "/ |/ "/ SAT/ (/ AGf/ )/ =/ {/ s/ ./ / w/ ./ (/ s/ ,/ w/ )/ ∈/ ST/ / →/ "/ SAT/ (/ EFf/ )/ =/ lfp/ (/ λ/ X/ ./ (/ ST/ -/ 1X/ )/ ∪/ SATf/ )/ "/ |/ "/ SAT/ (/ AXf/ )/ =/ {/ s/ ./ / w/ ./ (/ s/ ,/ w/ )/ ∈/ ST/ →/ 对于/ 上述/ 满足/ 性/ 函数/ SAT/ ,/ 原子/ 命题/ 满足/ 性/ 计算/ 即/ 是/ 求/ 对/ 原子/ 命题/ 满足/ 的/ 状态/ 集合/ ;/ 对于/ “/ 反/ ”/ 命题/ 即/ 是/ 原始/ 命题/ 可/ 满足/ 集合/ 的/ 补集/ ;/ 合取/ 命题/ 即/ 是/ 各/ 命题/ 可/ 满足/ 集合/ 的/ 交集/ ,/ 对应/ 地/ ,/ 析取/ 命题/ 即/ 是/ 各/ 命题/ 可/ 满足/ 集合/ 的/ 合并/ ;/ 对于/ 时序/ 逻辑/ AG/ 命题/ ,/ 即/ 是/ 求/ 状态/ 对象/ 在/ 自反/ 传递/ 闭包/ ST/ / 的/ 后继/ 状态/ (/ 直接/ 或者/ 间接/ 后继/ )/ 的/ 可/ 满足/ 性/ ;/ 对于/ 时序/ 逻辑/ AX/ 命题/ ,/ 即/ 是/ 求/ 直接/ 后继/ 的/ 可/ 满足/ 性/ ./ 对于/ 时序/ 逻辑/ “/ EFf/ ”/ 命题/ 的/ 满足/ 性/ 问题/ ,/ 首先/ 图/ 4VTOS/ 中/ 时序/ 逻辑/ EF/ // AG/ 验证/ 方法/ 4.4/ 一致性/ 验证/ 本/ 小节/ 对/ VTOS/ 的/ 设计/ ,/ 即/ 第/ 2/ 节/ 阐述/ OSOSM/ 语义/ 模型/ ,/ 是否/ 满足/ 第/ 3/ 节/ 的/ VTOS/ 安全/ 需求/ 进行/ 验证/ ,/ 即/ 设计/ 和/ 安全/ 需求/ 的/ 一致性/ 验证/ ./ 引理/ 1/ ./ 消息/ 发送/ 行为/ send/ 功效/ 完整性/ ./ OSOSM/ 微内核/ 消息/ 发送/ 行为/ 满足/ φ/ 1/ 的/ 功效/ 完整性/ 定义/ :/ lemmaSend/ _/ Effectiveness/ :/ "/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ sendp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ p/ _/ messbuf/ (/ (/ psetw/ )/ p2/ )/ =/ 证明/ ./ 我们/ 首先/ 将/ “/ s/ ,/ a/ ├/ f/ ”/ 部分/ 使用/ 单步/ 执行/ 函数/ step/ 的/ 定义/ 展开/ ,/ 然后/ 构造/ 消息/ 发送/ 行为/ 实现/ 语义/ 函数/ SysSend/ 中/ 的/ 接收/ 状态/ 和/ 完成/ 功效/ 状态/ ./ 如果/ 在/ s/ 的/ 后继/ 状态/ t/ (/ 直接/ 或者/ 间接/ 后继/ )/ 执行/ receivep2p1/ 或者/ receivep2ANY/ 行为/ ,/ 这样/ 的/ t/ 即为/ 接收/ 状态/ ,/ 在/ t/ 的/ 直接/ 后继/ 状态/ w/ 时/ ,/ 按照/ SysSend/ 函数/ 的/ 定义/ ,/ 完成/ SysSend/ 的/ 功效/ ,/ 因此/ 计算/ 直接/ 满足/ f/ 的/ 状态/ 集/ ,/ 即/ “/ SATf/ ”/ ,/ 这是/ 基本/ 步/ (/ basestep/ )/ ;/ 然后/ 假设/ 已/ 计算/ 得到/ 的/ 结果/ 状态/ 集合/ 为/ X/ ,/ 接下来/ 计算/ 这些/ 直接/ 满足/ f/ 的/ 状态/ 的/ 直接/ 前续/ 状态/ ,/ 即/ “/ ST/ -/ 1X/ ”/ ,/ 这是/ 推演/ 步/ (/ deductivestep/ )/ ;/ 最后/ 递归计算/ 这些/ 前续/ 状态/ ,/ 即/ 对/ X/ 抽象/ 后/ “/ λ/ X/ ./ (/ ST/ -/ 1X/ )/ ∪/ SATf/ ”/ 的/ 最小/ 不动点/ (/ LeastFixedPoint/ )/ ,/ Isabelle/ // HOL/ 中/ 使用/ lfp/ 函数/ 来/ 计算/ 最小/ 不动点/ ./ 对于/ 第/ 3/ 节/ 描述/ 的/ VTOS/ 微内核/ 安全/ 需求/ φ/ 1/ 和/ φ/ 2/ ,/ 是/ 关于/ 时序/ 逻辑/ “/ EFf/ ”/ 命题/ 的/ 验证/ ,/ 按照/ 上述/ “/ EFf/ ”/ 的/ SAT/ 满足/ 性/ 的/ 计算方法/ ,/ 在/ 验证/ 过程/ 中/ ,/ 我们/ 需要/ 首先/ 计算/ 基本/ 步/ ,/ 这/ 通过/ 构造/ 行为/ 的/ 完成/ 功效/ 状态/ 来/ 实现/ ;/ 然后/ 计算/ 推演/ 步/ ,/ 这/ 通过/ 说明/ 基本/ 步/ 构造/ 的/ 完成/ 功效/ 状态/ 是/ 行为/ 发生/ 状态/ 的/ 后续/ 状态/ 来/ 说明/ ./ φ/ 3/ ,/ φ/ 7/ ,/ φ/ 9/ ,/ φ/ 10/ 是/ 关于/ 时序/ 逻辑/ “/ AGf/ ”/ 命题/ 的/ 验证/ ,/ 在/ 验证/ 过程/ 中/ ,/ 首先/ 说明/ 当前/ 状态/ 满足/ 命题/ f/ ,/ 然后/ 验证/ 在/ 执行/ 系统/ 行为/ 后/ 的/ 状态/ 仍然/ 能/ 满足/ 命题/ f/ ,/ 由此/ 说明/ 从此/ 状态/ 出发/ 的/ 任何/ 状态/ 路径/ 上/ 的/ 所有/ 点/ 都/ 满足/ 命题/ f/ ./ 如图/ 4/ 所示/ ./ (/ EF/ -/ intro/ )/ w/ 即为/ 完成/ 功效/ 状态/ ./ Isabelle/ // HOL/ 证明/ 过程/ 如下/ :/ apply/ (/ simpadd/ :/ step/ _/ sat/ _/ defsat/ _/ defSysSend/ _/ def/ )/ ;/ apply/ (/ subgoal/ _/ tac/ "/ w/ =/ stept/ (/ receivep2p1/ )/ "/ )/ ;/ apply/ (/ blast/ )/ ;/ apply/ (/ simpadd/ :/ SysReceive/ _/ def/ )/ ;/ apply/ (/ auto/ )/ ;/ done/ ;/ 其中/ ,/ apply/ 表示/ 使用/ 规则/ 或者/ 已/ 证明/ 的/ 引理/ 和/ 定理/ 来/ 进行/ 验证/ ;/ simp/ 方法/ 对/ “/ s/ ,/ a/ ├/ f/ ”/ 部分/ 使用/ 单步/ 满足/ 性/ 的/ 定义/ (/ step/ _/ sat/ _/ def/ )/ 和/ 系统/ 行为/ 定义/ (/ SysSend/ _/ def/ )/ 来/ 进行/ 展开/ 并/ 化简/ ;/ subgoal/ _/ tac/ 方法/ 使用/ “/ w/ =/ stept/ (/ receivep2p1/ )/ ”/ 构造/ 接收/ 状态/ 和/ 完成/ 功效/ 状态/ ;/ blast/ 表示/ 使用/ 经典/ 推理方法/ (/ classicalreasoningmethods/ )/ 进行/ 前向/ (/ forward/ )/ 搜索/ 验证/ ;/ auto/ 表示/ 对/ 验证/ 目标/ 进行/ 简化/ ,/ 并/ 根据/ 已有/ 结论/ 和/ 定义/ 进行/ 搜索/ 验证/ ./ 采用/ 类似/ 的/ 基本/ 步/ 和/ 推演/ 步/ 的/ 构造方法/ ,/ 我们/ 可以/ 证明/ 通知/ 发送/ 行为/ 和/ 接收/ 行为/ 的/ 功效/ 完整性/ ./ Page15/ 引理/ 2/ ./ 通知/ 发送/ 行为/ notify/ 功效/ 完整性/ ./ OSOSM/ 微内核/ 通知/ 发送/ 行为/ 满足/ φ/ 2/ 的/ 功效/ 完整性/ 定义/ :/ lemmaNotify/ _/ Effectiveness/ :/ "/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ notifyp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ p/ _/ messbuf/ (/ (/ psetw/ )/ p2/ )/ =/ 定理/ 1/ ./ 消息/ 处理/ 行为/ 完整性/ (/ MessageProcessIntegrity/ ,/ MPI/ )/ ./ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何/ 状态/ 下/ ,/ 微内核/ 都/ 具有/ 消息/ 发送/ 行为/ 功效/ 完整性/ 、/ 通知/ 发送/ 行为/ 功效/ 完整性/ 和/ 接收/ 行为/ 功效/ 完整性/ :/ theoremMPI/ :/ "/ s0/ / AG/ (/ (/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ sendp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ p/ _/ messbuf/ (/ (/ psetw/ )/ p2/ )/ =/ (/ / s/ ∈/ S/ ,/ p1/ ∷/ process/ ,/ p2/ ∷/ process/ ./ (/ s/ ,/ (/ notifyp1p2/ )/ ├/ EF/ (/ λ/ w/ ∷/ state/ ./ p/ _/ messbuf/ (/ (/ psetw/ )/ p2/ )/ =/ 证明/ ./ 从/ 引理/ 1/ ,/ 引理/ 2/ 可知/ ,/ VTOS/ 在/ 完成/ 微内核/ 消息/ 处理/ 行为/ 功效/ 的/ 同时/ ,/ 不会/ 破坏/ 完成/ 功效/ 状态/ 下/ 继续/ 进行/ 消息/ 处理/ 的/ 能力/ ,/ 因此/ 在/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ 的/ 情况/ 下/ ,/ 任何/ 后续/ 状态/ 都/ 能/ 保证/ 消息/ 处理/ 行为/ 的/ 功效/ 完整性/ ./ apply/ (/ simpadd/ :/ step/ _/ sat/ _/ defsat/ _/ def/ )/ apply/ (/ blastintro/ :/ apply/ (/ auto/ )/ done/ 引理/ 3/ ./ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ schedule/ 功效/ 完整性/ ./ VTOS/ 微内核/ 的/ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ schedule/ 能/ 正确/ 地/ 将/ 进程/ 加入/ 到/ 多级/ 进程/ 队列/ 中/ :/ lemmaSchedule/ _/ Effectiveness/ :/ "/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ schedulep/ )/ ├/ pmem/ (/ (/ process/ _/ qw/ )/ i/ )/ )/ )/ )/ "/ 证明/ ./ 从/ SysSchedule/ 的/ 定义/ 可知/ ,/ VTOS/ 微内核/ 根据/ 被/ 调度/ 进程/ 对象/ 的/ 剩余时间/ 片/ 和/ CPU/ 资源/ 的/ 占用/ 情况/ 来/ 设置/ 进程/ 对象/ 的/ 优先级/ ,/ 并/ 将/ 进程/ 对象/ 加入/ 到/ 新/ 优先级/ 对应/ 的/ 进程/ 队列/ 中/ ,/ 为此/ 在/ 完成/ 功效/ 状态/ 下/ ,/ 进程/ 对象/ 必定/ 在/ 优先级/ 从/ 0/ 到/ 15/ 的/ 多级/ 进程/ 队列/ 中/ ./ Isabelle/ // HOL/ 证明/ 过程/ 如下/ :/ apply/ (/ simpadd/ :/ step/ _/ sat/ _/ defsat/ _/ defSysSchedule/ _/ def/ )/ apply/ (/ blast/ )/ apply/ (/ erulemem/ _/ def/ )/ apply/ (/ best/ )/ done/ 其中/ “/ erulemem/ _/ def/ ”/ 表示/ 利用/ Isabelle/ // HOL/ 中/ list/ 的/ mem/ 函数/ 定义/ 来/ 进行/ 消除/ 规则/ (/ elimina/ -/ tionrules/ )/ 的/ 前/ 向/ 推导/ ;/ best/ 方法/ 表示/ 采用/ 最优/ 查找/ (/ best/ -/ firstsearch/ )/ 代替/ 经典/ 推理方法/ 的/ 深度/ 查找/ (/ depth/ -/ firstsearch/ )/ 进行/ 搜索/ 验证/ ./ 证毕/ ./ 采用/ 类似/ 的/ 方法/ ,/ 我们/ 可以/ 证明/ 多级/ 进程/ 队列/ 出队/ 操作/ 行为/ dequeue/ 的/ 功效/ 完整性/ 和/ 选择/ 进程/ 对象/ 行为/ pick/ _/ proc/ 的/ 功效/ 完整性/ ./ 引理/ 4/ ./ 多级/ 进程/ 队列/ 出队/ 操作/ 行为/ dequeue/ 行为/ 功效/ 完整性/ ./ 微内核/ 的/ 进程/ 队列/ 出队/ 操作/ 行为/ dequeue/ 能/ 正确/ 地/ 将/ 进程/ 从/ 多级/ 进程/ 队列/ 中/ 删除/ :/ lemmaDequeue/ _/ Effectiveness/ :/ "/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ dequeuep/ )/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ / i/ ./ (/ 0/ / i/ ∧/ i/ / 15/ →/ / (/ pmem/ (/ (/ process/ _/ qw/ )/ i/ )/ )/ )/ )/ )/ "/ 引理/ 5/ ./ pick/ _/ proc/ 行为/ 功效/ 完整性/ ./ lemmaPick/ _/ proc/ _/ Effectiveness/ :/ "/ / s/ ∈/ S/ ./ (/ s/ ,/ pick/ _/ proc/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ (/ next/ _/ running/ _/ procw/ )/ =/ 定理/ 2/ ./ 进程/ 调度/ 行为/ 完整性/ (/ ProcessDis/ -/ patchIntegrity/ ,/ PDI/ )/ ./ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何/ 状态/ 下/ ,/ 微内核/ 都/ 具有/ 多级/ 进程/ 队/ 列入/ 队/ 操作/ 行为/ 功效/ 完整性/ 、/ 多级/ 进程/ 队列/ 出队/ 操作/ 行为/ 功效/ 完整性/ 和/ 选择/ 进程/ 对象/ 行为/ 功效/ 完整性/ ./ theoremPDI/ :/ "/ s0/ / AG/ (/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ schedulep/ )/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ / i/ ./ (/ 0/ / i/ ∧/ i/ / 15/ ∧/ (/ / s/ ∈/ S/ ,/ p/ ∷/ process/ ./ (/ s/ ,/ (/ dequeuep/ )/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ / i/ ./ (/ 0/ / i/ ∧/ i/ / 15/ →/ Page16/ (/ / s/ ∈/ S/ ./ (/ s/ ,/ pick/ _/ proc/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ (/ next/ _/ running/ _/ procw/ )/ =/ pick/ _/ ps015/ )/ )/ )/ "/ 证明/ ./ 从/ 引理/ 3/ 、/ 引理/ 4/ 、/ 引理/ 5/ 可知/ ,/ VTOS/ 在/ 完成/ 进程/ 调度/ 行为/ 功效/ 的/ 同时/ ,/ 不会/ 破坏/ 完成/ 功效/ 状态/ 下/ 继续/ 进行/ 进程/ 调度/ 的/ 能力/ ,/ 因此/ 在/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ 的/ 情况/ 下/ ,/ 任何/ 后续/ 状态/ 都/ 能/ 保证/ 进程/ 调度/ 行为/ 的/ 完整性/ ./ 类似/ 地/ ,/ 我们/ 有/ 中断/ 处理/ 行为/ 的/ 功效/ 完整性/ ./ 定理/ 3/ ./ 中断/ 处理/ 行为/ 完整性/ (/ InterruptHandleIntegrity/ ,/ IHI/ )/ ./ 假设/ 系统/ 初始状态/ s0/ 为/ 可信/ 状态/ ,/ 在/ s0/ 的/ 将来/ 任何/ 状态/ 下/ ,/ VTOS/ 的/ 中断/ 处理/ 行为/ 能/ 正确/ 地/ 根据/ 不同/ 的/ 中断/ 源/ ,/ 对系统/ 缓冲区/ 对象/ 进行/ 设置/ :/ theoremIHI/ :/ "/ s0/ / AG/ (/ / s/ ∈/ S/ ./ (/ s/ ,/ interrupt/ _/ handle/ ├/ AX/ (/ λ/ w/ ∷/ state/ ./ (/ (/ intr/ _/ sources/ )/ =/ INTR/ _/ DISK/ →/ (/ sys/ _/ bufferw/ )/ =/ data/ _/ from/ _/ disk/ )/ ∨/ (/ (/ intr/ _/ sources/ )/ =/ INTR/ _/ KEYBOARD/ →/ (/ sys/ _/ bufferw/ )/ =/ data/ _/ from/ _/ input/ )/ )/ )/ )/ "/ 证明/ ./ 使用/ 单步/ 执行/ 函数/ step/ 展开/ 后/ ,/ 根据/ SysInterrupt/ _/ handle/ 的/ 定义/ ,/ VTOS/ 微内核/ 对/ 中断/ 的/ 处理/ 将/ 根据/ 中断/ 源/ 的/ 类型/ 如/ 硬盘/ 中断/ 、/ 键盘/ 中断/ ,/ 进行/ 设置/ 系统/ 缓冲区/ ./ apply/ (/ simpadd/ :/ step/ _/ sat/ _/ defsat/ _/ defSysInterrupt/ _/ handle/ _/ def/ )/ apply/ (/ case/ _/ tacintr/ _/ source/ )/ apply/ (/ auto/ )/ done/ 其中/ “/ case/ _/ tacintr/ _/ source/ ”/ 表示/ 对/ 中断/ 源/ 变量/ intr/ _/ source/ 进行/ 分/ 情况/ 展开/ ./ 我们/ 的/ 验证/ 环境/ 配置/ 如表/ 1/ 所示/ ./ VTOS/ 微内核/ 部分/ 的/ Isabelle/ // HOL/ 验证/ 工程/ 代码/ 量/ 大概/ 在/ 23kSLOC/ (/ SourceLinesOfCode/ )/ 左右/ ,/ 完整/ 的/ 验证/ 耗时/ 15min/ 左右/ ./ 名称/ HardwareDellStudioXPS9100StandardInstallationCPUMemoryDDR3SDRAMOSopenSUSEDesktop11/ ./ 3StandardInstallationIsabelleIsabelle2009/ -/ 2/ _/ bundle/ _/ x86/ -/ linuxStandardInstallationIsabelle/ 的/ 验证/ 结果/ 如图/ 5/ 所示/ ./ “/ Nosubgoals/ ”/ 说明/ Isabelle/ 验证/ 逻辑/ 完整/ ,/ 不/ 存在/ 任何/ 未/ 证明/ 的/ 子目标/ ./ 5/ 结束语/ 本文/ 使用/ 形式化/ 方法/ 对/ 操作系统/ 进行/ 设计/ 和/ 验证/ ,/ 阐述/ 在/ VTOS/ 设计/ 过程/ 中/ 构建/ 对象/ 语义/ 模型/ OSOSM/ 的/ 方法/ ,/ 以此/ 来/ 对/ VTOS/ 的/ 设计/ 进行/ 形式化/ 的/ 描述/ ./ 本文/ 从/ 系统/ 行为/ 功效/ 完整性/ 和/ 进程/ 行为/ 隔离/ 性/ 的/ 角度/ 对/ 微内核/ OS/ 的/ 安全/ 需求/ 进行/ 了/ 分析/ ,/ 使用/ 带有/ 时序/ 逻辑/ 的/ 高阶/ 逻辑/ 对/ 安全/ 需求/ 进行/ 严格/ 的/ 定义/ 和/ 描述/ ,/ 并/ 在/ 定理/ 证明/ 器/ Isabelle/ // HOL/ 环境/ 中/ 对系统/ 的/ 设计/ 和/ 安全/ 需求/ 的/ 一致性/ 进行/ 验证/ ,/ 表明/ VTOS/ 微内核/ 系统/ 行为/ 的/ 功效/ 设计/ 符合/ 安全/ 需求/ 的/ 定义/ ./ 本文/ 采用/ 的/ 对象/ 语义/ 模型/ OSOSM/ 是/ 一种/ 开放/ 的/ 框架/ 模型/ ,/ 可以/ 实现/ 对/ OS/ 内核/ 以及/ 功能模块/ 的/ 描述/ ./ 由于/ 系统/ 的/ 各种/ 功能模块/ 往往/ 采用/ 多种不同/ 的/ 程序逻辑/ 进行/ 设计/ ,/ 并且/ 涉及/ 多种不同/ 的/ 抽象层次/ ,/ 如/ C语言/ 层/ 、/ 汇编语言/ 层/ 和/ 硬件/ 实现/ 层/ 等/ ,/ 对于/ 这些/ 功能模块/ 整合/ 在/ 一起/ 的/ 系统/ 的/ 正确性/ 不能/ 简单/ 地/ 认为/ 是/ 各个/ 模块/ 的/ 正确性/ 的/ 合取/ ./ 我们/ 接下来/ 的/ 工作/ 将/ 从域/ 理论/ (/ domaintheory/ )/ 和/ 类型论/ (/ typetheory/ )/ 的/ 角度/ 来/ 对系统/ 的/ 各个/ 经过/ 验证/ 的/ 模块/ 的/ 整合/ 验证/ 进行/ 研究/ ./ 致谢/ 本文/ 作者/ 感谢/ 本文/ 的/ 所有/ 匿名/ 审稿/ 者/ !/ 

