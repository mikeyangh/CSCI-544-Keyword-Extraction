Page1/ 一种/ 基于/ P2P/ 流量/ 规划/ 的/ 网络资源/ 可/ 重构/ 分配/ 方法/ 马东/ 超/ 1/ )/ 王晓亮/ 2/ )/ 杨参/ 2/ )/ 马礼/ 1/ )/ 1/ )/ (/ 北方工业大学/ 信息/ 工程学院/ 北京/ 100041/ )/ 2/ )/ (/ 北京大学/ 软件/ 与/ 微电子/ 学院/ 北京/ 100871/ )/ 摘要/ 现有/ IP/ 网络/ 的/ 无/ 连接性/ 和/ 网络资源/ 的/ 松散/ 管理/ 结构/ 使得/ 网络流量/ 存在/ 全局/ 范围/ 内/ 的/ 分布/ 不均/ 情况/ ,/ 造成/ 网络资源/ 利用率/ 低/ 并且/ 对/ 运营商/ 的/ 一些/ 突发/ 的/ QoS/ 需求/ 很难/ 做到/ 快速/ 响应/ ./ 具备/ 网络资源/ 集中式/ 管理/ 特征/ 的/ 可/ 重构/ 网络/ 虽然/ 弥补/ 了/ 这/ 一/ 不足/ ,/ 但/ 对/ 特定/ 业务/ 的/ 流量/ 优化/ 能力/ 以及/ 按/ 需/ 合理/ 重构/ 网络资源/ 的/ 能力/ 不足/ ,/ 使得/ 可/ 重构/ 网络资源/ 分配/ 及/ QoS/ 保障/ 技术/ 仍/ 有待/ 进一步提高/ ,/ 尤其/ 是/ 占据/ 网络流量/ 主体/ 的/ P2P/ 业务/ 流量/ 和/ 突发性/ 高/ 优先级/ QoS/ 保障/ ./ 当前/ 的/ P2P/ 优化/ 以及/ 流量/ 工程技术/ 不但/ 自身/ 存在/ 不/ 完善/ ,/ 并且/ 也/ 不能/ 高效/ 地/ 直接/ 适用/ 于/ 可/ 重构/ 网络/ 环境/ 中/ ./ 因此/ ,/ 文中/ 站/ 在/ 网络资源/ 全局/ 统筹/ 的/ 角度/ ,/ 提出/ 了/ 一种/ 应用/ 于/ 可/ 重构/ 网络/ 环境/ 中/ 的/ 、/ 基于/ P2P/ 流量/ 规划/ 的/ 网络资源/ 动态/ 可/ 重构/ 技术/ ,/ 使得/ 可/ 重构/ 网络/ 的/ 资源管理/ 机制/ 有/ 能力/ 对/ 全网/ P2P/ 流量/ 进行/ 优化/ 调度/ ,/ 尤其/ 是/ 能够/ 在/ 网络资源/ 不足/ 的/ 情况/ 下/ ,/ 通过/ 调整/ P2P/ 流量/ ,/ 释放/ 指定/ 网络资源/ 以/ 响应/ 突发/ 高/ 优先级/ 需求/ ./ 通过/ 仿真/ 验证/ 可见/ ,/ 以/ P2P/ 流量/ 规划/ 的/ 手段/ 对/ 全网/ 资源/ 进行/ 全局/ 规划/ 、/ 动态/ 重构/ ,/ 形成/ 弹性/ 的/ 可/ 重构/ 网络/ 环境/ 中/ ,/ 网络流量/ 负担/ 、/ P2P/ 节点/ 出/ 、/ 入度/ 等/ 多方面/ 均/ 有/ 较/ 大幅度/ 提升/ ,/ 从而/ 赋予/ 了/ 运营商/ 一种/ 对/ 各种/ 优先级/ 业务/ 的/ 规划/ 手段/ ./ 关键词/ 流量/ 规划/ ;/ 网络资源/ 可/ 重构/ ;/ P2P/ ;/ 突发/ 流量/ 需求/ 1/ 引言/ 当前/ ,/ 运营商/ 对/ 网络设备/ 铺设/ 和/ 升级/ 的/ 速度/ ,/ 已/ 渐渐/ 满足/ 不了/ 网络带宽/ 需求/ 的/ 增长/ [/ 1/ ]/ ./ 同时/ ,/ 传统/ IP/ 网络/ 无/ 连接/ 的/ 特性/ 导致/ 网络流量/ 分布/ 不均/ ,/ 网络资源/ 难以/ 得到/ 高效/ 利用/ ,/ 由此/ 带来/ 的/ 对/ ISP/ 网络/ 规划/ 能力/ 的/ 制约/ ,/ 导致/ 保障/ 业务/ QoS/ 需求/ 时/ 成本/ 很/ 高/ ./ 因此/ ,/ 在/ 现有/ 网络资源/ 紧张/ 的/ 前提/ 下/ ,/ 如何/ 有效/ 地/ 规划/ 网络/ 业务量/ ,/ 从而/ 使得/ 网络/ 的/ 带宽/ 资源/ 得以/ 合理/ 的/ 应用/ 以及/ 业务/ QoS/ 得到/ 保证/ ,/ 已经/ 成为/ 当前/ 网络/ 研究/ 的/ 热点问题/ 之一/ ./ 对于/ 上述/ 问题/ ,/ 当前/ 的/ 流量/ 工程技术/ 虽/ 有/ 一定/ 成效/ [/ 2/ ]/ ,/ 但/ 受制于/ 现行/ 网络/ 松散/ 的/ 资源管理/ 结构/ ./ 具有/ 网络资源/ 集中式/ 管理/ 特征/ 的/ 可/ 重构/ 网络/ 及/ 相关/ 技术/ 的/ 出现/ ,/ 很/ 好/ 弥补/ 了/ 流量/ 规划/ 的/ 不足/ ./ 但/ 其/ 在/ 特定/ 业务/ 的/ 管理/ 优化/ 和/ 网络资源/ 动态/ 调整/ 方面/ 仍/ 存在/ 不足/ ,/ 特别/ 是/ 对/ 占据/ 当前/ 流量/ 主体/ 的/ P2P/ 业务/ ./ 然而/ ,/ 现有/ 的/ P2P/ 优化/ 技术/ 和/ 流量/ 工程/ 自身/ 尚/ 不/ 完善/ ,/ 不能/ 直接/ 适用/ 于/ 可/ 重构/ 网络/ 的/ 新型/ 体系结构/ [/ 2/ -/ 3/ ]/ ./ 可/ 重构/ 网络/ 的/ 新型/ 体系结构/ 的/ 特点/ 是/ 主要/ 网络/ 能够/ 智能/ 地/ 针对/ 新/ 业务/ 的/ 需求/ ,/ 在/ 加载/ 对应/ 协议/ 构件/ 的/ 前提/ 下/ ,/ 面向/ 新/ 业务/ 链接/ 的/ 颗粒/ 度/ 能够/ 动态分配/ 带宽/ 资源/ 满足/ 业务/ 需求/ [/ 4/ -/ 7/ ]/ ./ 于是/ ,/ 本文/ 从/ 运营商/ 统筹规划/ 网络资源/ 的/ 层面/ ,/ 以/ 可/ 重构/ 网络体系结构/ 为/ 基础/ ,/ 从/ 优化/ P2P/ 流量/ 方面/ 另辟蹊径/ ,/ 提出/ 一种/ 基于/ P2P/ 流量/ 规划/ 的/ 网络资源/ 可/ 重构/ 分配/ 方法/ ,/ 旨在/ 完善/ 可/ 重构/ 网络/ 资源管理/ 与/ QoS/ 保障/ 策略/ ,/ 使/ 可/ 重构/ 网络/ 能够/ 对/ 全局/ P2P/ 流量/ 进行/ 动态/ 优化/ ./ 尤其/ 是/ 能够/ 在/ 突发/ 高/ 优先级/ 业务/ 需求/ 的/ 时刻/ 不/ 影响/ P2P/ 使用者/ 的/ 网络/ 感受/ 的/ 前提/ 下/ 有/ 目标/ 地/ 释放/ 指定/ 链路/ 上/ P2P/ 所/ 占/ 的/ 相当/ 部分/ 网络资源/ ,/ 来/ 保证/ 其它/ 高/ 优先级/ 的/ QoS/ 需求/ ,/ 形成/ 按需分配/ 的/ 弹性/ 网络/ 环境/ ,/ 为/ 运营商/ 一定/ 程度/ 上/ 降低/ 网络带宽/ 不足/ 的/ 问题/ ,/ 同时/ 保证/ 高/ 优先级/ 业务/ 的/ 带宽/ 使用/ ,/ 在/ 总体/ 上/ 赋予/ 了/ 运营商/ 对/ 网络资源/ 按/ 需/ 重构/ 的/ 规划/ 能力/ ./ 2/ 研究/ 现状/ 网络/ 中/ 流量/ 分布/ 不均/ 的/ 问题/ 早已/ 广泛/ 受到/ 学术界/ 和/ 业界/ 的/ 关注/ [/ 2/ ]/ ,/ 并/ 就此/ 问题/ 提出/ 了/ 多种/ 流量/ 规划/ 技术/ 加以解决/ [/ 2/ -/ 3/ ,/ 8/ ]/ ,/ 这些/ 技术/ 各有特点/ ,/ 并/ 在/ 均衡/ 网络流量/ 、/ 缓解/ P2P/ 应用/ 引发/ 的/ 网络资源/ 消耗/ 等/ 问题/ 上/ ,/ 起到/ 了/ 一定/ 的/ 积极/ 作用/ [/ 3/ ,/ 8/ ]/ ,/ 但是/ 也/ 存在/ 着/ 一定/ 局限性/ ,/ 特别/ 是/ 缺乏/ 对/ 全网/ 集中/ 全局/ 管理/ 的/ 能力/ ./ 近年/ 可/ 重构/ 网络/ 的/ 提出/ ,/ 弥补/ 了/ 这方面/ 不足/ ,/ 但是/ 其/ 在/ 特定/ 业务/ 的/ 管理/ 优化/ 和/ 网络资源/ 动态/ 调整/ 方面/ 方面/ 仍/ 有待/ 改善/ ,/ 其中/ 首要/ 考虑/ 的/ 就是/ P2P/ 业务/ 优化/ ./ 在/ 这方面/ ,/ 当前/ 措施/ 主要/ 包括/ :/ P2P/ 限制/ 、/ P2P/ 缓存/ 和/ P2P/ 本地化/ 以及/ 流量/ 工程技术/ ,/ 由于/ 网络/ 基础/ 结构/ 的/ 巨大/ 差异/ ,/ 这些/ 优化/ 技术/ 并/ 不能/ 直接/ 高效/ 适于/ 可/ 重构/ 网络/ 环境/ 中/ ./ 以下/ 将/ 分别/ 介绍/ 这些/ 相关/ 研究/ ,/ 在/ 第/ 3/ 节中/ 具体/ 阐述/ 其/ 局限性/ ./ 2.1/ 传统/ 流量/ 规划/ 技术/ 现状/ 在/ 传统/ 流量/ 规划/ 中/ ,/ 网络/ 为/ 每条/ 链路/ 设置/ 权重/ ,/ 通过/ 寻找/ 最/ 短路/ 的/ 方式/ 来/ 确定/ 路由/ 的/ 路径/ ./ 通过/ 信息/ 洪泛/ 的/ 方式/ ,/ 各/ 节点/ 都/ 能够/ 得到/ 域/ 内/ 的/ 拓扑/ 信息/ 并/ 据此/ 判断/ 最短/ 路径/ ./ 例如/ 早期/ 出现/ 的/ 手工/ 配置/ 链路/ cost/ 值/ 、/ Cisco/ 公司/ 推出/ 的/ 增强/ 网关/ 内部/ 路由/ 线路/ 协议/ (/ EnhancedInteriorGatewayRoutingProtocol/ ,/ EIGRP/ )/ 以及/ 策略/ 路由/ 等/ 手段/ [/ 3/ ]/ ./ 自从/ MPLS/ 协议/ 出现/ 后/ ,/ 其/ 在/ 流量/ 规划/ 领域/ 的/ 应用/ 就/ 一直/ 受到/ 各方/ 重视/ ./ MPLS/ 是/ IETF/ 提出/ 的/ 结合/ 二层/ 交换/ 和/ 三层/ 路由/ 的/ 面向/ 连接/ 的/ 数据传输/ 技术/ [/ 8/ ]/ ./ MPLS/ 协议/ 下/ 的/ 流量/ 规划/ 是/ 为/ 业务/ 流/ 选择/ 路径/ 的/ 处理过程/ ,/ 以/ 在/ 网络/ 中/ 不同/ 的/ 链路/ 、/ 路由器/ 和/ 交换机/ 之间/ 均衡/ 业务/ 流/ ./ MPLS/ 由于/ 自身/ 路由/ 与/ 转发/ 分离/ 的/ 特点/ ,/ 适合/ 与/ TE/ (/ TrafficEngneering/ )/ 的/ 结合/ ,/ 形成/ MPLS/ -/ TE/ 技术/ [/ 3/ ,/ 8/ -/ 9/ ]/ ./ MPLS/ -/ T/ E通/ 过/ 感知/ 网络带宽/ 的/ 使用/ 情况/ ,/ 采/ Page3/ 用/ 带有/ 约束条件/ 的/ 最/ 短/ 路径/ 优先/ 算法/ (/ ConstraintsShortestPathFirst/ ,/ CSPF/ )/ 计算/ 满足/ 带宽/ 要求/ 的/ 路径/ ,/ 并/ 通过/ 资源/ 预留/ 协议/ (/ ResourceReserveProtocol/ ,/ RSVP/ )/ 建立/ 带宽/ 预留/ 的/ TE/ 隧道/ (/ Tunnel/ )/ [/ 8/ -/ 9/ ]/ ,/ 可以/ 很/ 好地解决/ 基于/ 内部/ 网关/ 协议/ 的/ 流量/ 工程/ 所/ 不能/ 解决/ 的/ 问题/ ,/ 尽可能/ 提高/ 网络资源/ 的/ 利用率/ [/ 9/ ]/ ./ 2.2/ 当前/ 流行/ 的/ P2P/ 优化/ 研究/ 现状/ P2P/ 自其/ 诞生/ 起/ 就/ 在/ 网络资源/ 分配/ 中/ ,/ 占据/ 了/ 很/ 大部分/ ./ 当前/ ,/ P2P/ 流量/ 优化/ 技术/ 在/ 缓解/ 运营商/ 面对/ 的/ 满足/ 网络带宽/ 需求/ 以及/ 整体/ 网络资源/ 的/ 规划/ 能表/ 1/ 研究/ 现状/ 限制/ P2P/ 应用/ 流量/ 分析/ ,/ 按/ 一定/ 策略/ 控制/ P2P/ 应用/ 部署/ P2P/ 缓存/ 缓存/ P2P/ 流/ ,/ 减小/ 带宽/ 消耗/ 流量/ 本地化/ P2P/ 流量/ 本地/ 消化/ ,/ 减少/ 骨干网/ 和/ 跨域/ 流量/ P4P/ 技术/ 2.3/ 基于/ 可/ 重构/ 网络/ 的/ QoS/ 研究/ 随着/ 信息产业/ 的/ 高速/ 发展/ ,/ 当前/ 面向/ 业务/ 支撑/ 的/ 传统/ 网络/ ,/ 为/ 承载/ 特定/ 业务/ 和/ 融合/ 新兴/ 业务/ 不断/ 构建/ 和/ 改造/ 网络/ ,/ 依靠/ 提升/ 网络设备/ 性能/ ,/ 增加/ 复杂/ 控制算法/ 和/ 协议/ 等/ 技术/ ,/ 不仅/ 难以/ 满足/ 特性/ 差异/ 日益/ 扩大/ 的/ 用户/ 业务/ 承载/ 需求/ ,/ 而且/ 付出/ 了/ 网络/ 复杂度/ 相对/ 较/ 高且/ 传送/ 效率/ 相对/ 低下/ 的/ 代价/ [/ 4/ ]/ ./ 为了/ 摆脱/ 传统/ 网络/ 技术/ 体系/ 束缚/ ,/ 提出/ 了/ 面向/ 服务/ 提供/ 的/ 新型/ 网络/ 技术/ 体系/ —/ —/ —/ 可/ 重构/ 网络/ [/ 4/ ,/ 7/ ,/ 15/ ]/ ./ 体系结构/ 采用/ 如图/ 1/ 所示/ 的/ 分布式/ 管理模式/ ./ 在/ 该/ 体系结构/ 中/ ,/ 多个/ 路由/ 节点/ (/ RouterNode/ ,/ RN/ )/ 组成/ 一个/ 域/ (/ Domain/ )/ ,/ 多个/ 域/ 组成/ 一个/ 区/ (/ Region/ )/ ,/ 全网/ 由/ 多个/ 区/ 组成/ [/ 5/ ]/ ./ 其中/ ,/ 域/ 内/ 控制/ 层/ 部署/ 柔性/ 网力/ 两个/ 问题/ 中/ ,/ 都/ 扮演着/ 非常/ 重要/ 的/ 角色/ [/ 10/ -/ 12/ ]/ ./ 网络/ 运营商/ 和/ 学术界/ 一直/ 没有/ 停止/ 过/ 研究/ 和/ 实施/ 各种/ 流量/ 控制技术/ ,/ 主要/ 分为/ 以下/ 3/ 类/ [/ 10/ -/ 14/ ]/ :/ 进行/ 限制/ ./ (/ 1/ )/ 限制/ P2P/ ,/ 部署/ 流量/ 监控/ 设备/ 对/ P2P/ 应用/ (/ 2/ )/ P2P/ 缓存/ [/ 11/ ]/ ,/ 通过/ 架设/ P2P/ 缓存/ 设备/ 来降/ (/ 3/ )/ 流量/ 本地化/ [/ 12/ -/ 14/ ]/ ,/ 简单/ 重定向/ 到/ 本地/ 来限/ 如表/ 1/ 所示/ ./ 低/ 带宽/ 消耗/ ./ 制/ 网间/ 流量/ ./ 络/ 配置/ 代理/ (/ FlexibleNetworkConfigureBroker/ ,/ FNCB/ )/ ,/ 负责/ 对域/ 内/ 路由/ 节点/ 资源/ 信息/ 和/ 拓扑/ 信息/ 进行/ 管理/ ,/ FNCB/ 的/ 基本/ 目标/ 是/ 避免/ 拥塞/ 问题/ 以及/ 由此/ 引起/ 的/ QoS/ 服务/ 等级/ 下降/ 问题/ [/ 4/ -/ 5/ ]/ ./ 从/ 网络流量/ 的/ 观点/ 来看/ 是/ 对/ 网络/ 中/ 各种/ 业务/ 流量/ 分布/ 的/ 优化/ ,/ 从而/ 提高/ 网络/ 传输/ 效率/ ./ 域间/ 控制/ 层/ 部署/ 根/ 节点/ 服务器/ (/ RootServer/ )/ ,/ 负责/ 协调/ 管理/ 域间/ 资源/ 信息/ 和/ 拓扑/ 信息/ [/ 5/ -/ 6/ ]/ ./ 在/ 可/ 重构/ 网络/ 中/ ,/ 用户/ 业务/ 和/ 网络服务/ 关系/ 是/ 松/ 耦合/ ./ 在/ 资源管理/ 层面/ 引入/ QoS/ 业务管理/ 平台/ ,/ 并/ 在/ 接入/ 设备/ 处/ 部署/ 网络/ 接入/ 控制/ 进行/ 业务/ 申请/ 的/ 集中管理/ [/ 4/ -/ 5/ ]/ ./ 而/ 全网/ 的/ 拓扑/ 结构/ 及/ 网络资源/ 等/ 信息/ 则/ 由/ 各/ FNCB/ 及/ RS/ 管理/ ,/ 并/ 通过/ 它们/ 对/ 网络资源/ 和/ 结构/ 进行/ 重构/ ,/ 通过/ 集中式/ 的/ 网络资源/ 申请/ 及/ 分配/ 管理/ ,/ 保证/ 当前/ QoS/ 策略/ 的/ 实现/ [/ 4/ ,/ 6/ ]/ ./ 3/ 问题/ 分析/ 网络/ 拥塞/ 在/ 某种程度/ 上/ 是因为/ 网络资源/ 不足/ 和/ 流量/ 分布/ 不/ 均匀/ 造成/ 的/ ./ 前者/ 唯一/ 的/ 解决办法/ 是/ 升级/ 基础设施/ ,/ 提供/ 更/ 多/ 的/ 网络资源/ ./ 后者/ 则/ 可以/ 依靠/ 资源/ 调整/ 来/ 优化/ ./ 当前/ 的/ 网络流量/ 工程技术/ 就是/ 出于/ 资源/ 调整/ 这一/ 目的/ 并/ 取得/ 了/ 一定/ 的/ 成绩/ [/ 2/ -/ 3/ ,/ 8/ ]/ ./ 但是/ ,/ 由于/ 当前/ IP/ 网络/ 的/ 无/ 连接性/ 以及/ 现行/ 网络/ 松散/ 的/ 资源/ 组织/ 结构/ ,/ 缺乏/ 资源/ 和/ 信息/ 的/ 集中管理/ 使得/ 当前/ 流量/ 工程/ 的/ 实际效果/ 并/ 不/ 理想/ [/ 8/ ]/ ./ 例如/ 动态/ 路由/ 协议/ RIP/ 、/ OSPF/ 和/ IS/ -/ IS/ ,/ 由于/ 它们/ 总是/ 选择/ 其/ Page4/ 独自/ 判断/ 的/ 最/ 短/ 路径/ 转发/ IP/ 包/ ,/ 都/ 可能/ 会/ 导致/ 不/ 均匀/ 的/ 流量/ 分布/ ./ 结果/ 在/ 两个/ 结点/ 之间/ 沿着/ 最短/ 路径/ 上/ 的/ 路由器/ 和/ 链路/ 可能/ 发生/ 了/ 拥塞/ ,/ 而/ 沿较/ 长/ 路径/ 的/ 路由器/ 和/ 链路/ 却/ 相对/ 负载/ 较/ 轻/ ,/ 如图/ 2/ 所示/ ./ MPLS/ 协议/ 在/ 理想/ 情况/ 下/ 可以/ 使到/ 同一/ 出口/ 的/ 不同/ 路径/ 上/ 公平/ 地/ 装载/ 流量/ ,/ 但/ 由于/ 其/ 路径/ 选择/ 基于/ 对/ 网络/ 状况/ 的/ 感知/ ,/ 而/ 非/ 实际/ 的/ 集中管理/ ,/ 故/ 也/ 会/ 出现/ 网络/ 感知/ 失真/ 、/ 流量/ 失衡/ 的/ 情况/ [/ 3/ ,/ 8/ -/ 9/ ]/ ./ 可/ 重构/ 网络/ 及其/ 相关/ 技术/ 的/ 出现/ ,/ 很/ 好/ 地/ 弥补/ 了/ 现有/ 网络/ 及/ 流量/ 工程/ 的/ 这/ 一/ 不足/ ./ 由于/ 其/ 打破/ 了/ 当前/ 网络/ 的/ 传统/ 结构/ ,/ 采用/ FNCB/ 、/ RS/ 服务器/ 管理/ 全网/ 资源/ ,/ 引入/ QoS/ 管理/ 平台/ 和/ 网络/ 接入/ 的/ 申请/ 机制/ ,/ 在/ 网络结构/ 的/ 层面/ 上/ 对/ QoS/ 的/ 实现/ 和/ 保障/ 明显/ 优于/ 传统/ 网络结构/ [/ 4/ ]/ ./ 然而/ ,/ 可/ 重构/ 网络/ 的/ 资源管理/ 机制/ 在/ 以下/ 两/ 方面/ 仍/ 有待/ 提高/ :/ (/ 1/ )/ 需要/ 根据/ 业务/ 特点/ 进行/ 流量/ 优化/ ,/ 其中/ P2P/ 业务/ 所/ 占/ 比例/ 很大/ ,/ 应/ 重点/ 考虑/ ./ 可/ 重构/ 网络/ 的/ QoS/ 保障/ 中/ 使用/ 的/ 严格/ 优先级/ 划分/ 、/ 域间/ 加权/ 轮询/ 等/ 控制策略/ ,/ 将/ 流量/ 通过/ 业务/ 类别/ 划分/ 到/ 各个/ 传输/ 队列/ 轮询/ 等待/ [/ 4/ -/ 6/ ]/ ,/ 这一/ 方式/ 中/ 如果/ 对/ P2P/ 优先级/ 设置/ 较/ 高/ ,/ 则/ 影响/ 其它/ 业务/ ;/ 如果/ 对/ P2P/ 优先级/ 设计/ 很/ 低/ ,/ 则/ 影响/ P2P/ 用户/ 体验/ ./ 而/ 现有/ P2P/ 优化/ 技术/ 在/ 解决/ 这一/ 问题/ 上/ ,/ 由于/ 网络体系结构/ 的/ 差异/ ,/ 很难/ 高效/ 适用/ 于/ 可/ 重构/ 网络/ 环境/ ,/ 更/ 重要/ 的/ 是/ ,/ 现有/ P2P/ 优化/ 技术/ 也/ 都/ 存在/ 其/ 自身/ 的/ 不足/ :/ ①/ 限制/ P2P/ 应用/ 一方面/ 面临/ P2P/ 应用/ 提供商/ 技术/ 上/ 的/ 反击/ ,/ 造成/ P2P/ 应用/ 与/ ISP/ 的/ 更/ 激烈/ 的/ 对立/ ;/ 另一方面/ ,/ 这/ 也/ 损害/ 了/ ISP/ 用户/ 的/ 合法权益/ ./ ②/ P2P/ 缓存/ 由于/ P2P/ 应用/ 的/ 开放性/ ,/ ISP/ 很/ 可能/ 因为/ 缓存/ 非法/ 内容/ 而/ 遭遇/ 法律/ 问题/ ./ 同时/ 缓存/ 设备/ 和/ 策略/ 的/ 高/ 成本/ 也/ 限制/ 了/ 这/ 一/ 技术/ ./ ③/ 流量/ 本地化/ 简单/ 的/ 重定向/ 机制/ 会/ 面临/ 连接数/ 限制/ 、/ 影响/ 少数/ 用户/ 网络/ 体验/ 以及/ 少数/ 骨干/ 链路/ 负载/ 失衡/ 等/ 问题/ ./ 而/ 以/ P2P/ 提供商/ 与/ ISP/ 合作/ 模式/ 为/ 基础/ 的/ P4P/ 及/ 类似/ 技术/ ,/ 由于/ 缺乏/ 动力/ 和/ 版权/ 问题/ 等/ ,/ P2P/ 提供商/ 的/ 合作/ 积极性/ 势必/ 将/ 受到/ 影响/ ./ (/ 2/ )/ 当/ 面对/ 突发/ 的/ 高/ 优先级/ QoS/ 需求/ ,/ 尤其/ 是/ 网络资源/ 不足/ 的/ 情况/ 下/ ,/ 可/ 重构/ 网络管理/ 机制/ 缺乏/ 有效/ 的/ 规划/ 手段/ 来/ 充分利用/ 全网/ 资源/ ./ 网络/ 灵活/ 调整/ 自身/ 流量/ 的/ 能力/ 不足/ ,/ 很难/ 做到/ 既/ 满足/ 突发/ 资源/ 需求/ ,/ 又/ 能/ 合理/ 调整/ 当前/ 流量/ ,/ 不/ 明显/ 影响/ 现有/ 连接/ 的/ 服务质量/ ,/ 达到/ 全网/ 资源/ 和/ 连接/ 优化/ 配置/ 的/ 目的/ ./ 计算机网络/ 的/ 流量/ 和/ 服务/ 等/ 优化/ 问题/ 是/ 近年来/ 的/ 研究/ 热点/ ,/ 已有/ 一些/ 宏观/ 的/ 指导性/ 文献/ [/ 16/ -/ 17/ ]/ ,/ 但/ 针对/ 本文/ 的/ 具体/ 问题/ ,/ 需要/ 有/ 一个/ 具体/ 优化/ 实例/ ./ 于是/ ,/ 本文/ 基于/ 完善/ 可/ 重构/ 网络流量/ 管理/ 及/ QoS/ 保障/ 技术/ 的/ 目的/ ,/ 从/ 占据/ 当前/ 大部分/ 网络资源/ 的/ P2P/ 流量/ 进行/ 优化/ 的/ 方面/ 另辟蹊径/ (/ 典型/ 低优先级/ 业务/ )/ ,/ 提出/ 一种/ 基于/ P2P/ 流量/ 规划/ 的/ 网络资源/ 可/ 重构/ 分配/ 技术/ P2P/ -/ NRRA/ (/ P2P/ -/ flow/ -/ planningbasedNet/ -/ workResourcesRestructurableAllocation/ )/ ./ 旨在/ 依托/ 可/ 重构/ 网络体系结构/ 的/ 基础/ 上/ ,/ 针对/ P2P/ 流量/ 和/ 突发/ 高/ 优先级/ 业务/ QoS/ 需求/ ,/ 提出/ 网络/ 整体/ 的/ 资源管理/ 技术/ ,/ 实现/ 对/ 全网/ P2P/ 流量/ 的/ 优化/ ,/ 并/ 可/ 按/ 需/ 对/ 指定/ 链路/ 的/ 网络资源/ 进行/ 合理/ 的/ 动态/ 重构/ ,/ 调整/ P2P/ 流量/ 以/ 满足/ 突发/ 的/ 网络资源/ 需求/ ,/ 赋予/ ISP/ 能够/ 对/ 网络资源/ 按/ 需/ 进行/ 灵活/ 的/ 总体规划/ 的/ 能力/ ,/ 最终/ 在/ 提高/ 网络/ 对/ 高/ 优先级/ 业务/ 的/ 容纳/ 能力/ 的/ 同时/ 保障/ 了/ P2P/ 用户/ 体验/ ./ 4P2P/ -/ NRRA/ 方案/ 如上/ 文/ 所述/ ,/ 本/ 方案/ 将/ 从/ 重构/ 、/ 优化/ P2P/ 流量/ 入手/ ,/ 在/ 可/ 重构/ 网络体系结构/ 基础/ 上/ ,/ 通过/ 网内/ 各/ FNCB/ 和/ RS/ 设备/ ,/ 获取/ 全局/ 流量/ 信息/ ,/ 汇总/ 计算/ 当前/ 全网/ 状态/ 的/ 优化/ 流量/ 分布/ 方案/ ,/ 来/ 对/ 网络资源/ 进行/ 重构/ ,/ 避免/ 流量/ 的/ 不/ 均匀分布/ ,/ 实现/ 资源/ 的/ 优化/ 利用/ ./ 从/ 理论/ 上/ 讲/ ,/ 传统/ 的/ 流量/ 工程/ 问题/ 包含/ 解决/ 优化/ 和/ 满足/ 约束/ 两/ 方面/ 问题/ ,/ 通常/ 其/ 形式/ 定义/ 如下/ :/ 令/ 操作符/ T/ 代表/ 流量/ 工程/ 的/ 处理/ ,/ 对于/ 一个/ 给定/ 的/ 网络/ G/ (/ V/ ,/ E/ )/ ,/ D/ =/ ∏/ i/ ∈/ I/ 的/ 网络流量/ D/ ;/ 输出/ :/ 怎样/ 最优化/ 在/ 网络/ 上/ 传输/ 流量/ D/ ./ 算法/ 的/ 目标/ 是/ 决定/ 一个/ 优化/ 的/ 映射/ X/ ,/ 这个/ 映射/ 优于/ 其它/ 映射/ x/ ∈/ X/ ,/ 这/ 需要/ 一个/ 目标/ 函数/ 来/ 辨别/ 优劣/ :/ Page5/ 其中/ 的/ 目标/ 函数/ 即/ 是/ 优化/ 问题/ 的/ 核心/ ,/ 其/ 模型/ 建立/ 和/ 设定/ 部分/ 将/ 在/ 4.1/ 节/ 的/ 问题/ 建模/ 部分/ 详细/ 讨论/ ./ 为了/ 部署/ 和/ 实现/ 本/ 技术/ ,/ 本文/ 对/ 可/ 重构/ 网络/ 的/ 图/ 3/ 可/ 重构/ 网络/ 中/ 的/ P2P/ -/ NRRA/ 部署/ 示意图/ 在/ 可/ 重构/ 网络体系结构/ 中/ ,/ 对/ 网络拓扑/ 和/ 资源管理/ 的/ FNCB/ 以及/ RS/ 设备/ 中/ 部署/ 本文/ 提出/ 的/ P2P/ -/ NRRA/ 技术/ ,/ 将/ 其/ 模块/ 动态/ 加载/ 于/ 上述/ 设备/ ,/ 无需/ 对/ 网络/ 的/ 体系结构/ 、/ 设备/ 等/ 进行/ 任何/ 的/ 调整/ 修改/ ./ 流程/ 方面/ ,/ 在/ 可/ 重构/ 系统/ 获取/ 用户/ 地理位置/ 信息/ 和/ 网络/ 相关/ 信息/ 时/ [/ 4/ -/ 7/ ]/ ,/ 进行/ 业务/ 类型/ 判断/ ,/ 对于/ P2P/ 业务/ 及/ 突发/ 高/ 优先级/ QoS/ 需求/ ,/ 转入/ P2P/ -/ NRRA/ 模块/ 处理/ ,/ 并/ 按照/ 本/ 模块/ 输出/ 的/ 网络资源/ 优化/ 重构/ 方案/ ,/ 调整/ 和/ 分配/ 相应/ 网络资源/ ./ 下面/ 将/ 详细/ 介绍/ P2P/ -/ NRRA/ 的/ 算法/ 设计/ ./ 4.1/ 问题/ 建模/ 网络通信/ 由/ 其/ 内部/ 链路/ 和/ 网间/ 链路/ 组成/ 一个/ 全/ 连接/ 拓扑/ 环境/ ,/ 在/ 这里/ 使用/ 图/ G/ =/ (/ V/ ,/ E/ )/ 描述/ 网络拓扑/ 环境/ ./ 对/ 问题/ 建模/ ,/ 其中/ V/ 是/ 表示/ 网络/ 环境/ 中/ 自治/ 域/ 的/ 节点/ 集合/ ,/ E/ 是/ 边/ 集合/ ,/ 每条/ 边/ 表示/ 相连/ 的/ 自治/ 域间/ 的/ 一个/ 数据/ 连接/ ./ 对于/ 任意/ 一条/ 边/ e/ (/ u/ ,/ v/ )/ ∈/ E/ 都/ 有/ 一个/ 连接/ 开销/ ,/ 表示/ 选择/ 在/ 自治/ 域/ u/ 和/ v/ 之间/ 建立/ 连接/ 的/ 相应/ 成本/ ./ 在/ 此/ 网络/ 环境/ 下/ ,/ 为了/ 描述/ 问题/ 的/ 清晰/ ,/ 进行/ 如下/ 定义/ ./ 定义/ 1/ ./ 定义/ 集合/ P/ ,/ 对于/ P/ ∈/ E/ ,/ 有/ / e/ (/ u/ ,/ v/ )/ ∈/ P/ ,/ 表示/ 在/ u/ ,/ v/ 间/ 的/ 链路/ 存在/ P2P/ 流量/ ./ 定义/ 2/ ./ 定义/ 集合/ H/ ,/ 对于/ H/ ∈/ E/ ,/ 有/ / e/ (/ u/ ,/ v/ )/ ∈/ H/ ,/ 表示/ 在/ u/ ,/ v/ 间/ 的/ 链路/ 存在/ 高/ 优先级/ 流量/ 需求/ ./ 定义/ 3/ ./ 定义/ 集合/ I/ ,/ 对于/ i/ ∈/ I/ ,/ 表示/ 一个/ 端到/ 端/ P2P/ 流量/ 的/ 完整/ 路径/ ./ 于是/ ,/ 假设/ t1/ 时刻/ ,/ 网络/ 环境/ 图/ G/ 中/ 的/ 连接/ 状态/ 为/ S/ ,/ 其中/ 节点/ u/ 和/ v/ 之间/ 存在/ 数据/ 连接/ e/ ∈/ P/ ./ 下/ 一/ 时刻/ t2/ ,/ 网络/ 环境/ 图/ G/ 中/ 的/ 连接/ 状态/ 发生/ 变/ QoS/ 保障机制/ 进行/ 改进/ ,/ 将/ 充分利用/ 可/ 重构/ 网络/ 优异/ 的/ 可扩展性/ ,/ 通过/ 管理/ 平台/ 将/ 本/ 技术/ 构件/ 化/ 并/ 直接/ 动态/ 部署/ 于/ 可/ 重构/ 网络/ 的/ 各层/ FNCB/ 及/ RS/ 设备/ 中/ ,/ 如图/ 3/ 所示/ ./ 化/ ,/ 记为/ S/ ,/ 其中/ 节点/ u/ 和/ v/ 之间/ 出现/ 高/ 优先级/ 业务/ ,/ 释放/ 此/ 段/ 链路/ 上/ P2P/ 占用/ 的/ 网络资源/ ,/ 即/ e/ ∈/ H/ ./ 此时/ ,/ 需要/ 对/ G/ =/ (/ V/ ,/ E/ )/ 网络/ 中/ 的/ P2P/ 流量/ 需要/ 进行/ 重构/ ,/ 使得/ 全网/ 环境/ 下/ 的/ 优化/ 目标/ 达到/ 最优/ ./ 整体/ 的/ 优化/ 为了/ 达到/ 两个/ 目标/ ,/ 其一/ 是/ 使得/ 全网/ 的/ 网络/ 开销/ 尽可能/ 的/ 小/ ;/ 另/ 一个/ 是/ 使得/ 全网/ 的/ 链接/ 变动/ 尽可能/ 的/ 小/ ./ 根据/ 这/ 两个/ 优化/ 目标/ ,/ 设/ 函数/ F/ 为/ 全局/ 优化/ 目标/ 函数/ ,/ 即/ 全局/ 优化/ 目为/ 找到/ 一个/ 全网/ 连接/ 状态/ S/ ,/ 使得/ 式/ (/ 1/ )/ 取得/ 最小值/ :/ F/ (/ S/ )/ =/ ∑/ / i/ ∈/ I/ 其中/ ,/ α/ 和/ β/ 为/ Cost/ 和/ Tran/ 的/ 计算/ 权重/ ;/ Cost/ 为/ 链路/ 的/ 连接/ 开销/ ;/ Tran/ 为/ 链路/ 的/ 变动/ 开销/ ./ Cost/ 的/ 具体/ 定义/ 如下/ :/ 对于/ 任意/ i/ ∈/ I/ ,/ 该/ 链路/ 的/ 连接/ 开销/ 记为/ Cost/ (/ i/ )/ ./ 对于/ 全局/ 连接/ 状态/ S/ ,/ 记某/ 一/ 连接/ i/ ∈/ I/ 的/ 流量/ 为/ H/ (/ i/ )/ ,/ 连接/ 成本/ 为/ V/ (/ i/ )/ ,/ 建立/ 连接/ 和/ 维护/ 开销/ 为/ J/ (/ i/ )/ ,/ 则/ 全网/ 连接/ 开销/ Cost/ (/ S/ )/ 定义/ 如下/ :/ Cost/ (/ S/ )/ =/ ∑/ i/ ∈/ I/ 其中/ ,/ 连接/ 成本/ V/ (/ i/ )/ 旨在/ 量化/ 某一/ P2P/ 连接/ 所/ 占用/ 的/ 网络资源/ ,/ 并/ 以此/ 做/ 为/ 一个/ 重要/ 的/ 参数/ 来/ 指导/ 进行/ 网络资源/ 重构/ 的/ 方案设计/ ./ 对于/ 任意/ 连接/ i/ 上/ 的/ 任意/ 一段/ 物理/ 链路/ e/ ,/ 其/ V/ (/ e/ )/ 正比/ 与/ 物理/ 链路/ 的/ 长度/ Le/ ,/ 该/ 链路/ 上/ 的/ 当前/ 流量/ Flownow/ (/ e/ )/ 以及/ 使用/ 该条/ 物理/ 链路/ 的/ 费用/ Exp/ (/ e/ )/ ,/ 反比/ 于/ 该条/ 链路/ 的/ 带宽/ B/ (/ e/ )/ ,/ 即/ 由此/ 可/ 得/ ,/ 全局/ 优化/ 目标/ 函数/ F/ 中/ 的/ Cost/ (/ S/ )/ Page6/ 的/ 表达式/ 如下/ :/ Cost/ (/ S/ )/ =/ {/ ∑/ i/ ∈/ IH/ (/ i/ )/ ·/ ∑/ e/ ∈/ i/ 全局/ 优化/ 目标/ 中/ 的/ 另/ 一个/ 重要/ 优化/ 项是/ 全网/ 的/ 连接/ 状态/ 变动/ 幅度/ ,/ 记为/ Tran/ (/ S/ )/ ./ 连接/ 状态/ 变动/ 幅度/ 由/ 两个/ 参数/ 来/ 加以/ 描述/ ,/ 分别/ 是/ 变动/ 次数/ Tc/ (/ S/ )/ 以及/ 链路/ 的/ 变动/ 距离/ Δ/ D/ ./ 即/ 由于/ 其中/ 变动/ 次数/ Tc/ (/ s/ )/ 可以/ 使用/ 全网/ 范围/ 内/ 每/ 一条/ 端到/ 端/ P2P/ 流量/ 的/ 路径/ 是否/ 调整/ 来/ 标示/ ,/ 全/ Le/ ·/ Flownow/ (/ e/ )/ ·/ Exp/ (/ e/ )/ 4.2/ 问题/ 的/ 复杂度/ 情况/ 及其/ 证明/ 本文/ 上述/ P2P/ -/ NRRA/ 问题/ 可/ 抽象/ 为/ 求解/ 一个/ 给定/ 无向/ 连通/ 图中/ ,/ 在/ 给/ 每/ 条边/ 赋以/ 权值/ 的/ 情况/ 下/ ,/ 一个/ 指定/ 节点/ 集合/ L/ ∈/ V/ 的/ 最小/ 生成/ 树/ ./ 下面/ 证明/ 该/ 问题/ 是/ NP/ 难/ 的/ ./ 这里/ 将/ 利用/ 基础/ 的/ NP/ 难/ —/ —/ —/ 三/ 精确/ 覆盖/ (/ X3C/ )/ 问题/ 来/ 辅助/ 证明/ P2P/ -/ NRRA/ 的/ NP/ 难/ 属性/ ./ 首先/ ,/ 这里/ 给出/ X3C/ 问题/ 的/ 形式化/ 定义/ 如下/ :/ 对于/ 有限/ 集/ X/ ,/ 有/ |/ X/ |/ =/ 3q/ ,/ 设/ 集合/ R/ 为/ X/ 中/ 元素/ 的/ 三元组/ 集合/ ,/ 即/ R/ =/ {/ R1/ ,/ …/ ,/ Rn/ }/ ,/ Ri/ / X/ ,/ Ri/ =/ 3/ ,/ 1/ / i/ / n/ ./ 在/ 此/ 条件/ 下/ ,/ 存在/ R/ / R/ ,/ 对/ / x/ / X/ ,/ 均/ 有/ x/ / rn/ / R/ ,/ 且/ |/ R/ |/ =/ q/ ./ 下文/ 的/ 证明/ 过程中将/ 利用/ 到/ 一个/ 文献/ 中/ 的/ 辅助/ 结构/ ①/ ,/ 考虑/ 到/ 有助于/ 理解/ 下文/ 的/ 证明/ 部分/ ,/ 这里/ 同样/ 给出/ 这一/ 结构/ 的/ 构造/ 过程/ ./ 定义/ 节点/ 集为/ V/ (/ G/ )/ =/ {/ v/ }/ ∪/ {/ r1/ ,/ …/ ,/ rn/ }/ ∪/ {/ x1/ ,/ …/ ,/ x3q/ }/ ./ 这里/ 加入/ 的/ 节点/ v/ 是/ 为了/ 将/ 以下/ 两个/ 层次/ 的/ 节点/ 联通/ 成/ 一个/ 完整/ 的/ 树结构/ ./ 定义/ 边集/ 为/ E/ (/ G/ )/ =/ {/ vr1/ ,/ …/ ,/ vrn/ }/ ∪/ ∪/ xj/ ∈/ Ri/ 定义/ 生成/ 树/ 节点/ 集/ L/ 为设/ NRRA/ 所/ 需要/ 求解/ 的/ 最优/ 解为/ K/ 为/ 4q/ ./ 为了/ 便于/ 理解/ ,/ 可/ 将/ 上述/ 设定/ 表述/ 如图/ 4/ 所示/ ./ 于是/ ,/ 对于/ 如上所述/ 构造/ 的/ 辅助/ 结构/ ,/ 将/ 证明/ NRRA/ 与/ X3C/ 问题/ 等价/ ./ (/ 1/ )/ 由/ X3C/ 多项式/ 规约/ NRRA/ ./ 网/ 范围/ 内/ ,/ Tran/ (/ S/ )/ 可以/ 由/ 对/ 所有/ i/ ∈/ I/ 的/ Tran/ (/ i/ )/ 求和/ 得到/ ,/ 其中/ 变动/ 距离/ D/ 由/ 经过/ 的/ 子网/ 数来/ 度量/ ./ 于是/ ,/ 可以/ 联立/ 得出/ Tran/ (/ s/ )/ =/ ∑/ i/ ∈/ I/ 烄/ 烅/ / i/ ∈/ I/ ,/ Tran/ (/ i/ )/ =/ 1/ ,/ 链路/ i/ 发生/ 变动/ 烆/ 至此/ ,/ 本文/ 给出/ 了/ 问题/ 的/ 形式化/ 描述/ ,/ 并/ 得出/ 了/ 完整/ 的/ 全网/ 优化/ 目标/ 函数/ ,/ 联/ 立式/ (/ 1/ )/ ~/ (/ 3/ )/ 可/ 得/ 函数/ F/ 的/ 表达式/ 如下/ :/ 没有/ 变动/ 设/ 当前/ 存在/ 一个/ X3C/ 问题/ 的/ 实例/ 解/ R/ ,/ 为/ 不是/ 一般性/ ,/ 假设/ R/ =/ {/ R1/ ,/ R2/ ,/ …/ ,/ Rq/ }/ ,/ 故/ ,/ 一定/ 存在/ 以下/ 边/ vR1/ ,/ …/ ,/ vRq/ 和/ Rixj/ ,/ 其中/ xj/ ∈/ Ri/ ,/ 1/ / i/ / q/ ,/ 所以/ 存在/ 边数/ 为/ q/ +/ 3q/ =/ 4q/ =/ K/ 的/ 生成/ 树/ ./ 设/ NRRA/ 问题/ 中/ / e/ ∈/ E/ ,/ 其权值/ 为/ F/ (/ e/ )/ ./ 定义/ 边长/ 为/ 1/ 的/ 无权/ 值边/ 为/ “/ 标准/ 边/ ”/ e/ θ/ ,/ 其/ 集合/ 为/ E/ ./ 设从/ NRRA/ 边集/ E/ 到/ E/ 的/ 映射/ 为/ f/ ,/ 定义/ 如下/ :/ / e/ ∈/ E/ ,/ 其/ 两个/ 顶点/ vi/ 、/ vj/ 由/ 若干/ e/ θ/ 连接/ ,/ 并/ 满足/ ∑/ e/ θ/ =/ F/ (/ e/ )/ ./ 于是/ ,/ 通过/ 映射/ f/ 将/ NRRA/ 问题/ 转换/ 为/ 求解/ 无向/ 连通/ 图/ G/ (/ V/ ,/ E/ )/ 中/ ,/ 是否/ 存在/ 一个/ 正整数/ K/ ,/ 使得/ 不/ 多于/ K/ 条边/ 即可/ 连接/ L/ 个/ 顶点/ ,/ 形成/ 一个/ 图/ G/ 的/ 生成/ 树/ ,/ 其中/ L/ ∈/ V/ ./ 由/ 上文/ 可知/ ,/ 存在/ 此/ 生成/ 树/ ./ 即/ 该解/ 符合/ NRRA/ 所求/ ./ (/ 2/ )/ 由/ NRRA/ 多项式/ 规约/ X3C/ ./ 设/ 当前/ 存在/ 一个/ NRRA/ 问题/ 的/ 实例/ 解/ ,/ 同/ 上/ ①/ AlessandroSantuari/ ./ SteinerTreeNP/ -/ completenessProofPage7/ 理/ ,/ 对/ NRRA/ 问题/ 中/ 的/ 边集/ 做/ f/ 映射/ ,/ 问题/ 得以/ 转换/ ,/ 即/ 存在/ 一颗/ 生成/ 树/ T/ 拥有/ 最多/ 4q/ 条边/ ,/ 由于/ T/ 为树/ ,/ 故/ T/ 最多/ 拥有/ 4q/ +/ 1/ 个/ 节点/ ./ 由于/ T/ 必须/ 包含/ 的/ 节点/ 集为/ L/ =/ v/ ,/ x1/ ,/ …/ ,/ x3/ {/ 点/ ./ 故/ R/ 类/ 节点/ 最多/ 有/ q/ 个/ (/ 图/ 4/ 第/ 2/ 层/ 节点/ )/ ./ 若/ R/ 类/ 节点/ 少于/ q/ 个/ ,/ 考虑/ 到/ R/ 类/ 节点/ 向下/ 的/ 度/ 为/ 3/ ,/ 则/ 不/ 可能/ 连接/ 所有/ 的/ 3q/ 个/ X/ 类/ 节点/ (/ 图/ 4/ 第/ 3/ 层/ 节点/ )/ ,/ 故/ R/ 类/ 节点/ 刚好/ 有/ q/ 个/ ,/ 为/ 不失/ 一般性/ ,/ 将/ 其/ 假设/ 为/ R1/ ,/ R2/ ,/ …/ ,/ Rq/ ,/ 则/ X3C/ 问题/ 的/ 解即/ 为/ 至此/ ,/ 证明/ 了/ NRRA/ 与/ X3C/ 问题/ 间/ 可以/ 多项式/ 规约/ ,/ 即/ NRRA/ 问题/ 为/ NP/ 难/ ,/ 难以/ 在/ 多项式/ 时间/ 内/ 找到/ 最优/ 解/ ,/ 后文/ 应用/ 一种/ 性能/ 尽量/ 优化/ 的/ 启发式/ 算法/ 来求/ 最优/ 解/ ./ 4.3/ 算法/ 描述/ 按照/ 上/ 一节/ 中/ 对/ 问题/ 的/ 数学/ 描述/ ,/ 以及/ 给出/ 的/ 全局/ 优化/ 目标/ 函数/ ,/ 本文/ 设计/ 使用/ 启发式/ 算法/ 对/ 该/ 优化/ 问题/ 进行/ 求解/ ./ 对于/ 两个/ 优化/ 目标/ :/ 一个/ 是/ 使得/ 全网/ 的/ 网络/ 开销/ 尽可能/ 的/ 小/ ;/ 另/ 一个/ 是/ 使得/ 全网/ 的/ 链接/ 变动/ 尽可能/ 的/ 小/ ,/ 这/ 都/ 要求/ 在/ 系统/ 算法/ 和/ 体系结构/ 上/ 有/ 相应/ 设计/ ,/ 以/ 获取/ 当前/ 的/ 全局/ 信息/ ./ 体系结构/ 上/ 的/ 相关/ 安排/ 已于/ 第/ 4.1/ 节/ 做/ 了/ 详细/ 介绍/ ,/ 主要/ 通过/ 在/ 自治/ 域/ 的/ 接入/ 路由器/ 上/ 部署/ 相应/ 的/ 下载/ 信息/ 统计/ 和/ 路径/ 记录/ 模块/ 来/ 获取/ 相应/ 信息/ ,/ 由此/ ,/ 系统/ 的/ 中心/ 处理/ 集群/ —/ —/ —/ 云端/ 处理/ 平台/ 上将/ 获得/ 当前/ 全局/ P2P/ 下载/ 过程/ 中/ 的/ 热点/ 文件/ 列表/ ,/ 记为/ List/ ,/ 云/ 平台/ 同时/ 掌握/ List/ 中/ 包含/ 的/ 所有/ 文件/ 在/ 全网/ 中/ 的/ 布局/ 情况/ ,/ 即/ 对于/ / f/ ∈/ List/ ,/ 云/ 平台/ 均/ 掌握/ 一个/ 集合/ V/ ,/ 对于/ / v/ ∈/ V/ ,/ v/ 上/ 均/ 有/ 文件/ f/ 的/ 资源/ ,/ 将/ 此/ 映射/ 记为/ RList/ →/ V/ ./ 将/ 得到/ 如下/ 的/ 映射/ 集合/ ,/ 记为/ P/ ,/ 即/ P/ =/ 此外/ ,/ 借助/ 自治/ 域/ 边界/ 的/ 接入/ 路由器/ 上/ 的/ TraceRoute/ 路径/ 记录/ 功能/ ,/ 则/ 可/ 获得/ P2P/ 流量/ 的/ 拓扑/ 映射/ 关系/ ,/ 该/ 映射/ 关系/ 记为/ Ri/ →/ e/ ,/ i/ ∈/ I/ ,/ e/ ∈/ E/ ./ 于是/ ,/ 沿用/ 4.1/ 节对/ 问题/ 的/ 相关/ 定义/ 和/ 描述/ ,/ 当/ 全网/ 在/ 状态/ S/ 下时/ ,/ 由/ 子网/ V1/ 到/ V2/ 链路/ 记/ 为/ 链路/ i/ ,/ 其上/ 出现/ 了/ 高/ 优先级/ 业务/ 需求/ ,/ 需要/ 释放/ 该/ 路径/ 上/ 可压缩/ 的/ P2P/ 流量/ ,/ 以此/ 来/ 满足/ 高/ 优先级/ 业务/ 的/ 网络资源/ 需求/ ./ 此时/ ,/ 优化/ 算法/ 的/ 目标/ 为/ 寻求/ 一个/ 即时/ 条件/ 下/ 的/ 全网/ 连接/ 状态/ S/ ,/ 使得/ 优化/ 目标/ 函数/ 取得/ 最小值/ minF/ (/ S/ )/ ,/ 以此/ 获得/ 当前/ 状态/ 下/ 的/ 最优/ 解/ ./ 首先/ ,/ 需要/ 将/ 链路/ i/ 上/ 的/ P2P/ 流量/ 进行/ 分析/ 汇总/ ,/ 得到/ 该/ 链路/ 上/ P2P/ 流量/ 的/ 所有/ 发起/ 节点/ ,/ 以及/ 各个/ 节点/ 所/ 要求/ 的/ 资源/ 文件/ ./ 即/ ,/ 得到/ 该/ 链路/ 上/ P2P/ 流量/ 发起/ 节点/ 集合/ Vs/ 与/ 热点/ 文件/ 列表/ List/ 之间/ 的/ 映射/ 关系/ RVc/ →/ List/ ,/ 由此/ 可/ 得到/ 形同/ 集合/ P/ 的/ 需求/ 集合/ P/ ./ 之后/ ,/ 按照/ List/ 列表/ 中/ 资源/ 文件/ 的/ 热度/ 高低/ 降序/ 排序/ ,/ 记/ 热度/ 最高/ 的/ 资源/ 文件/ 为/ f1/ ,/ 优先/ 对/ 其/ 进行/ 处理/ ./ 为了/ 方便/ 叙述/ ,/ 这里/ 设即/ 在/ 链路/ i/ 上/ ,/ 有/ V1/ ,/ V2/ ,/ …/ ,/ Vk/ 节点/ 发起/ 的/ 获取/ 资源/ 文件/ f1/ 的/ P2P/ 流量/ ./ 之后/ ,/ 获取/ 文件/ f1/ 的/ 布局/ 映射/ RList/ →/ V/ (/ f1/ )/ 以及/ P2P/ 流量/ 的/ 拓扑/ 映射/ 关系/ Ri/ →/ e/ ,/ i/ ∈/ I/ ,/ e/ ∈/ E/ ./ 此时/ ,/ 在/ 选择/ 新/ 的/ peer/ 节点/ 时/ 面对/ 的/ 困难/ 是/ ,/ P2P/ 连接数/ 是/ 受到/ 来自/ 协议/ 或/ 来自/ P2P/ 应用/ 或/ 用户/ 体验/ 的/ 不同/ 限制/ 的/ ,/ 反应/ 到/ 本文/ 建模/ 的/ 拓扑图/ G/ 上/ ,/ 即/ 对/ 拥有/ 资源/ 文件/ 的/ 节点/ ,/ 其有/ 出入/ 度/ 的/ 限制/ ,/ 于是/ ,/ 对于/ 同一个/ 热点/ 资源/ 的/ 需求/ 队列/ 中/ ,/ 任何/ 一个/ 节点/ 先/ 选定/ 其/ 更新/ 的/ 目标/ peer/ 后/ ,/ 都/ 有/ 可能/ 对/ 其它/ 尚未/ 选定/ 更新/ peer/ 的/ 节点/ ,/ 产生/ 影响/ ./ 如图/ 5/ 所示/ ,/ 节点/ 1/ 和/ 2/ 需要/ 寻找/ 新/ 的/ peer/ ,/ 而/ 节点/ 3/ 、/ 4/ 、/ 5/ 则/ 都/ 是/ 拥有/ 1/ 、/ 2/ 所/ 需/ 的/ 资源/ 文件/ 的/ 节点/ ,/ 从图/ 5/ 上/ 标示/ 的/ 优化/ 目标/ 函数/ F/ 的/ 取值/ 可以/ 看出/ ,/ 对于/ 节点/ 1/ 和/ 2/ 自身/ 来说/ ,/ 节点/ 3/ 是/ 其/ 局部/ 最优/ 解/ ./ 但是/ 此时/ 节点/ 3/ 只/ 剩/ 1/ 个/ 可用/ 连接数/ ,/ 若/ 保证/ F/ 最小值/ 的/ 2/ →/ 3/ 连接/ 建立/ ,/ 则/ 节点/ 1/ 需要/ 与/ 节点/ 4/ 建连/ ,/ 此时/ F/ (/ 1/ ,/ 4/ )/ +/ F/ (/ 2/ ,/ 3/ )/ =/ 110/ ,/ 远远/ 高于/ 1/ 、/ 3/ 建连/ ,/ 2/ 、/ 5/ 建连时/ 的/ F/ (/ 1/ ,/ 3/ )/ +/ F/ (/ 2/ ,/ 5/ )/ =/ 45/ ./ 由此可见/ ,/ 为了/ 避免/ 陷入/ 局部/ 最优/ ,/ 而/ 导致/ 算法/ 的/ 全局/ 失效/ ,/ 需要/ 在/ 算法/ 设计/ 上/ 做/ 相应/ 处理/ ./ 从/ 以上/ 分析/ 得到/ 启发/ ,/ 本/ 算法/ 在/ 此/ 安排/ 选取/ 目标/ peer/ 的/ 优先级/ 时/ ,/ 不是/ 直接/ 安装/ 各个/ 节点/ 所/ 能/ 得到/ 的/ 最优/ 解/ 的/ 优化/ 程度/ (/ 即/ 目标/ 函数/ F/ 的/ 值/ )/ 排序/ ,/ 而是/ 应该/ 根据/ 各个/ 节点/ 所/ 能/ 得到/ 的/ 最优/ 解与/ 次优/ 解/ 之间/ 的/ 差值/ 大小/ 排序/ ./ 据此/ ,/ 分别/ 计算/ V1/ ,/ V2/ ,/ …/ ,/ Vk/ 中/ 各个/ 节点/ 在/ 更换/ 目标/ peer/ 节点/ 后/ ,/ 全网/ 范围/ 内/ ,/ Page8/ 能/ 使得/ 目标/ 优化/ 函数/ F/ 值/ 最优/ (/ 即/ 最小/ )/ 的/ 新/ peer/ 节点/ A/ ,/ 以及/ 使得/ F/ 次优/ 的/ peer/ 节点/ B/ ,/ 分别/ 记录/ 这/ 两个/ 节点/ ,/ 并/ 计算/ Vn/ 选择/ 这/ 两个/ 不同/ 目标/ peer/ 时/ ,/ 目标/ 函数/ F/ 的/ 差值/ ,/ 记/ 为/ Δ/ τ/ (/ Vn/ )/ ./ 计算/ 完成/ 后/ ,/ 将/ Δ/ τ/ (/ V1/ )/ ,/ Δ/ τ/ (/ V2/ )/ ,/ …/ ,/ Δ/ τ/ (/ Vk/ )/ 按照/ 降序/ 排列/ ,/ 优先/ 让/ Δ/ τ/ (/ Vn/ )/ 值/ 最大/ 的/ 节点/ Vn/ 选取/ 最优/ 目标/ peer/ ./ 若/ 在/ Vn/ 连接/ 后/ ,/ Vn/ 的/ 目标/ 节点/ 达到/ 入度/ 上限/ ,/ 则/ 此时/ 对/ V1/ ,/ V2/ ,/ …/ ,/ Vk/ 队列/ 中/ ,/ 将/ 最优/ 解/ 或/ 次优/ 解/ 目标/ 与/ Vn/ 的/ 目标/ 节点/ 相同/ 的/ 节点/ ,/ 更新/ 其/ 最优/ 或/ 次优/ 解/ ,/ 并/ 更新/ 差值/ Δ/ τ/ ./ 依此/ 循环/ 进行/ ,/ 直到/ V1/ ,/ V2/ ,/ …/ ,/ Vk/ 均/ 选定/ 新/ 的/ 目标/ peer/ ,/ 此时/ ,/ 修正/ 全网/ 拓扑/ ,/ 并/ 更新/ 相应/ 个边/ 的/ 连接/ 开销/ ./ 之后/ 代入/ 热点/ 文件/ f2/ ,/ 循环/ 进行/ ,/ 直到/ 将/ 该/ 链路/ 上/ 的/ 所有/ 可/ 释放/ 的/ P2P/ 流量/ 全部/ 重新/ 规划/ 至/ 其它/ 链路/ 上/ ./ 至此/ ,/ 完成/ 了/ 对/ 网络资源/ 进行/ 全局/ 优化/ 的/ 重构/ ,/ 在/ 保证/ 指定/ 链路/ 高/ 优先级/ 业务/ 需求/ 的/ 前提/ 下/ ,/ 整合/ 全网/ 资源/ ,/ 提升/ 网络/ 运营商/ 的/ 整体/ 资源/ 规划/ 能力/ 和/ 服务质量/ ./ 经过/ 以上/ 分析/ ,/ 将/ 算法/ 描述/ 如下/ :/ 1/ ./ 检查/ 指定/ 链路/ i/ 上/ 的/ P2P/ 流量/ ./ 2/ ./ 获得/ 需求/ 集合/ P/ ,/ 即/ 指定/ 链路/ i/ 上/ P2P/ 流量/ 的/ 各个/ 发起/ 节点/ 的/ 资源/ 文件/ 请求/ 情况/ ,/ 并/ 按/ 资源/ 文件/ 热度/ 排序/ ./ 3/ ./ 若/ 此时/ 集合/ P/ 不空/ ,/ 则/ 选择/ 当前/ 集合/ P/ 中/ ,/ 热度/ 最高/ 的/ 文件/ 所/ 映射/ 的/ 各个/ 发起/ 节点/ ./ 否则/ ,/ 算法/ 停止/ ./ 4/ ./ 根据/ 映射/ 关系/ RList/ →/ V/ 和/ Ri/ →/ e/ ,/ i/ ∈/ I/ ,/ e/ ∈/ E/ ,/ 即/ 文件/ 在/ 全网/ 中/ 的/ 布局/ 情况/ 和/ P2P/ 流量/ 的/ 拓扑/ 映射/ 关系/ ,/ 计算/ 步/ 3/ 中/ 选出/ 的/ 各个/ 节点/ 当前/ 的/ 最优/ 解/ 和/ 次优/ 解/ ,/ 计算/ Δ/ τ/ ,/ 按照/ Δ/ τ/ 降序/ 排列/ ,/ 并/ 记此队/ 列为/ L/ ./ 5/ ./ 若/ 此时/ L/ 不为/ 空/ ,/ 则/ 选择/ L/ 中/ 排序/ 第一/ 的/ 节点/ ,/ 优先选择/ 最优/ 解/ 目标/ peer/ ,/ 并/ 将/ 此/ 节点/ 从/ L/ 中/ 删除/ ./ 若/ L/ 为空/ ,/ 则/ 跳转/ 步/ 7.6/ ./ 若/ 在/ 步/ 5/ 选择/ 后/ ,/ 该/ 目标/ peer/ 达到/ 入度/ 上限/ ,/ 则/ 更新/ 其它/ 所有/ 以此/ 目标/ peer/ 为/ 最优/ 解/ 或/ 次优/ 解/ 的/ 节点/ ,/ 并/ 更新/ Δ/ τ/ ,/ 再次/ 对/ L/ 降序/ 排序/ ,/ 跳转/ 步/ 5/ ./ 否则/ ,/ 直接/ 跳转/ 步/ 5/ ./ 步/ 3.7/ ./ 从/ 集合/ P/ 中/ 删除/ 此/ 文件/ 与其/ 起始/ 节点/ 的/ 映射/ ,/ 跳转/ 算法/ 伪码/ 描述/ 0/ ./ NetResRecon/ (/ QueueP/ ,/ RList/ →/ V/ ,/ Ri/ →/ e/ ,/ Req/ )/ {/ 1/ ./ ftop/ ←/ FILM/ ;/ Notetop/ ,/ Notetop/ ←/ NOTE/ ;/ Lf/ ,/ Lf/ ←/ QUEUE/ ;/ 2/ ./ 对/ P/ 按照/ 热点/ 率/ 降序/ 排序/ ;/ 3/ ./ While/ (/ P/ ≠/ / temp/ </ Req/ )/ {/ 4/ ./ ftop/ =/ Move/ (/ P/ )/ ;/ 5/ ./ 获取/ ftop/ 所/ 对应/ 的/ 节点/ 列表/ Lf/ ;/ 6/ ./ While/ (/ Lf/ ≠/ / )/ {/ 7/ ./ Notetop/ =/ Move/ (/ Lf/ )/ ;/ 8/ ./ 根据/ RList/ →/ V/ 和/ Ri/ →/ e/ 计算/ Notetop/ 的/ 最优/ 解/ 、/ 次/ 9/ ./ }/ 10/ ./ 对/ Lf/ 按/ 节点/ Δ/ τ/ 降序/ 排列/ ,/ 得/ Lf/ ;/ 11/ ./ While/ (/ Lf/ ≠/ / temp/ </ Req/ )/ {/ 12/ ./ Notetop/ =/ Move/ (/ Lf/ )/ ;/ 13/ ./ Notetop/ 取/ 最优/ 解/ ,/ 更新/ Lf/ ;/ 14/ ./ temp/ +/ =/ Cost/ (/ Notetop/ )/ ;/ 15/ ./ }/ 16/ ./ }/ 17/ ./ }/ 由/ 算法/ 的/ 伪码/ 描述/ 可以/ 看出/ ,/ 算法/ 框架/ 上/ 成/ 两次/ 循环/ 的/ 嵌套/ 形式/ ./ 设/ 集合/ P/ 中/ 连接/ 总数/ 为/ N/ ,/ 则/ 由于/ 高/ 优先级/ 业务/ 的/ 带宽/ 需求/ Req/ 给定/ ,/ 实际/ 运算/ 中/ 需要/ 处理/ 的/ 连接数/ n/ ∈/ N/ ./ 算法/ 中/ 涉及/ 排序/ 的/ 部分/ 假设/ 实现/ 上/ 采用/ 快速/ 排序/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ nlogn/ )/ ./ 设/ 依据/ 算法/ 分析/ ,/ 所/ 需/ 重构/ 的/ 节点/ 数为/ m/ ,/ 则/ 伪码/ 中/ 6/ ~/ 9/ 行/ 时间/ 复杂度/ 为/ m/ 的/ 常数/ 项/ ,/ 而/ 11/ ~/ 14/ 行/ 的/ 循环/ ,/ 由于/ 其要/ 根据/ 当前/ 节点/ Notetop/ 的/ 最优/ 解/ 更新/ Lf/ ,/ 重置/ 其中/ 最优/ 解/ 或/ 次优/ 解与/ 当前/ 节点/ 冲突/ 的/ 节点/ 备选/ 对象/ ,/ 其中/ 涉及/ 对/ 冲突/ 节点/ 的/ 查找/ 和/ 当前/ 节点/ 的/ 剔除/ ,/ 其/ 时间/ 复杂度/ 应为/ m/ !/ ./ 于是/ ,/ 本/ 算法/ 时间/ 复杂度/ 的/ 估计/ 为/ O/ (/ nm/ !/ )/ ./ 由于/ 上述/ 算法/ 为/ 近似/ 的/ 启发式/ 算法/ ,/ 并/ 不能/ 完全/ 保证/ 在/ 所有/ 情况/ 中均/ 能/ 取得/ 理论/ 最优/ 解/ ,/ 对/ 算法/ 求得/ 的/ 优化/ 解与/ 理论/ 最优/ 解/ 之间/ 的/ 差距/ 会因/ 具体/ 网络/ 环境/ 不同/ 而/ 存在/ 差异/ ,/ 现/ 简要/ 举例/ ./ 如图/ 6/ (/ a/ )/ 所示/ ,/ 释放/ 网络资源/ 的/ 目标/ 链路/ 为/ 1/ -/ 2/ -/ 3/ ,/ 其所/ 需/ 资源/ 在/ 节点/ 4/ 、/ 5/ 、/ 6/ 、/ 7/ 处均/ 有/ 提供/ 且/ 这/ Page94/ 个/ 节点均/ 只/ 剩余/ 1/ 个/ 可用/ 连接数/ ,/ 连接/ 成本/ 如图/ 6/ (/ a/ )/ 所示/ ./ 在/ 此/ 的/ 网络/ 环境/ 中/ ,/ 理论/ 最优/ 解/ 应该/ 为/ 1/ -/ 4/ 、/ 2/ -/ 5/ 、/ 3/ -/ 6/ ,/ 连接/ 成本/ 总计/ 为/ 20/ +/ 15/ +/ 20/ =/ 55/ ./ 而/ 使用/ P2P/ -/ NRRA/ 技术/ ,/ 得到/ 优化/ 解/ 的/ 过程/ 为/ :/ 首先/ 1/ 选择/ 最优/ 解/ ,/ 不/ 存在/ 冲突/ ,/ 与/ 4/ 建连/ ;/ 2/ 选择/ 最优/ 解/ 6/ ,/ 与/ 节点/ 3/ 的/ 最优/ 解/ 冲突/ ,/ 计算/ 两个/ 节点/ 最优/ 解/ 和/ 次优/ 解/ 的/ 差值/ 分别/ 为/ 5/ 、/ 30/ ,/ 故/ 节点/ 3/ 优先/ ,/ 与/ 6/ 建连/ ,/ 节点/ 2/ 与/ 次优/ 解/ 5/ 建连/ ./ 故/ 在/ 此/ 网络/ 环境/ 中/ ,/ P2P/ -/ NRRA/ 技术/ 可以/ 取得/ 理论/ 最优/ 解/ ./ 而/ 如图/ 6/ (/ b/ )/ 所示/ 的/ 网络/ 环境/ 中/ ,/ 本/ 算法/ 最优/ 解/ 选择/ 步骤/ 为/ :/ 节点/ 1/ 选择/ 最优/ 解/ ,/ 由于/ 与/ 2/ 最优/ 解/ 和/ 次优/ 解/ 的/ 差值/ 相等/ (/ 20/ -/ 15/ =/ 25/ -/ 20/ )/ ,/ 故/ 不/ 产生/ 冲突/ ,/ 节点/ 1/ 选择/ 最优/ 解/ 5/ ;/ 节点/ 2/ 则/ 选择/ 次优/ 解/ 6/ ,/ 此时/ 发现/ 节点/ 3/ 无/ 可用/ 备选/ 节点/ ,/ 产生/ 节点/ 饥饿/ ./ 而/ 理论/ 上/ 的/ 最优/ 解/ 应为/ 1/ -/ 4/ 、/ 2/ -/ 5/ 、/ 3/ -/ 6/ 所有/ 节点均/ 得到/ 服务/ ./ 可见/ P2P/ -/ NRRA/ 算法/ 在/ 节点/ 竞争/ 并/ 产生/ 饥饿/ 的/ 环境/ 中/ 并未/ 获得/ 良好/ 最优化/ 性能/ ,/ 有/ 进一步/ 完善/ 优化/ 空间/ ,/ 后续/ 研究/ 中/ 会/ 详细/ 演算/ 近似/ 比/ 并/ 完善/ 本/ 算法/ ./ 图/ 7/ 仿真/ 网络拓扑/ 仿真/ 结果/ 如图/ 8/ ~/ 图/ 12/ 所示/ ,/ 分别/ 从/ 上述/ 方面/ 反映/ 了/ 本文/ 所/ 提出/ 的/ 网络资源/ 可/ 重构/ 分配/ 策略/ 的/ 相关/ 特性/ ./ 下面/ 本文/ 针对/ 这/ 4/ 个/ 方面/ ,/ 对/ 仿真/ 结果/ 分别/ 进行/ 详细/ 说明/ ./ 4.4/ 算法/ 仿真/ 本文/ 采用/ 如图/ 7/ 所示/ 的/ 网络拓扑/ 结构/ ,/ 对/ 基于/ P2P/ 流量/ 规划/ 的/ 网络资源/ 可/ 重构/ 分配/ 策略/ 进行/ NS2/ 仿真/ ./ 子网/ 中/ 包含/ 若干/ 网络/ 终端设备/ ,/ 全网/ 的/ 终端设备/ 总数/ 浮动/ 设置/ ,/ 进行/ 总体/ 规模/ 上限/ 为/ 3000/ 的/ 多/ 阶段/ 仿真/ ./ 各/ 节点/ 间/ 的/ 连线/ 表示/ 仿真/ 拓扑/ 中/ 各/ 子网/ 的/ 物理/ 链路/ ,/ 其中/ 各段/ 链路/ 的/ 主要参数/ 在/ 仿真/ 开始/ 前/ 进行/ 统一/ 设定/ ,/ 在/ 结果/ 统计/ 时/ 根据/ 仿真/ 数据/ 和/ 之前/ 确定/ 的/ 全网/ 相关/ 参数/ (/ 如/ 链路/ 长度/ 、/ 结算/ 费用/ 、/ 带宽/ 等/ )/ ,/ 代入/ 4.1/ 节中/ 的/ 全网/ 开销/ 表达式/ 中/ 进行/ 计算/ ,/ 获得/ 相应/ 开销/ 值/ ,/ 并/ 以此/ 和/ 仿真/ 获得/ 的/ 相关/ 数据/ ,/ 对/ 2/ 个/ 方面/ 的/ 主要/ 变化趋势/ 和/ 性能/ 影响/ 等/ 进行/ 分析/ 验证/ ./ 这/ 2/ 个/ 方面/ 分别/ 为/ (/ 1/ )/ 考察/ 网络/ 高/ 优先级/ 业务/ 突然/ 出现/ 时/ ,/ 本/ 算法/ 在/ 网络/ 重构/ 的/ 收敛/ 速率/ 、/ 对/ 全网/ 性能/ 以及/ 被/ 重构/ 节点/ 性能/ 等/ 方面/ 的/ 影响/ ./ 效果/ 、/ 对/ 网络/ 节点/ 性能/ 等/ 方面/ 的/ 影响/ ./ (/ 2/ )/ 考察/ 本文/ 提出/ 的/ 算法/ 在/ 不同/ 网络/ 规模/ 下/ 的/ 考察/ 网络/ 高/ 优先级/ 业务/ 突然/ 出现/ 时/ ,/ 本/ 算法/ 在/ 网络/ 重构/ 的/ 收敛/ 速率/ 、/ 对/ 全网/ 性能/ 以及/ 被/ 重构/ 节点/ 性能/ 等/ 方面/ 的/ 影响/ ./ 图/ 8/ 为/ 全网/ 环境/ 下/ ,/ 出现/ 高/ 优先级/ 业务/ 时/ ,/ 在/ 使用/ 本文/ 策略/ 进行/ 全网/ 优化/ 的/ 情况/ 下/ ,/ Page10/ 全网/ 的/ 连接/ 开销/ 和/ 平均/ 吞吐/ 率/ 随着/ 时间/ 的/ 变化/ 情况/ ,/ 图/ 9/ 为/ 在/ 同图/ 8/ 情况/ 下/ ,/ 被/ 重构/ 节点/ 的/ 流量/ 随/ 时间/ 的/ 变化/ 情况/ ./ 在/ 图/ 8/ 和/ 图/ 9/ 中/ ,/ 横轴/ 为/ 时间/ ,/ 跨度/ 为/ 0/ 至/ 400s/ ./ 图/ 8/ 纵轴/ 为/ 比率/ ,/ 为了/ 将/ 全网/ 开销/ 和/ 平均/ 吞吐/ 率/ 曲线/ 调整/ 到/ 一个/ 合适/ 的/ 坐标/ 空间/ ,/ 此处/ 将/ 开销/ 值取/ 1/ // 1000/ ,/ 吞吐/ 率取/ 1/ // 20/ ./ 两条/ 曲线/ 分别/ 为/ 全网/ 平均/ 吞吐/ 率/ 随/ 时间/ 的/ 变化/ 情况/ 和/ 全网/ 开销/ 随/ 时间/ 的/ 变化/ 情况/ ,/ 此时/ 的/ 网络/ 规模/ 为/ 3000/ 个/ 节点/ ,/ 在/ 时间/ t/ =/ 150s/ 时/ ,/ 全网/ 范围/ 出现/ 20/ %/ 的/ 高/ 优先级/ 业务量/ ./ 由图/ 8/ 可以/ 看出/ ,/ 当/ 全局/ 范围/ 内/ 出现/ 高/ 优先级/ 业务/ 时/ (/ 即/ t/ =/ 150s/ 时刻/ )/ ,/ 全网/ 的/ 实时/ 吞吐/ 率会/ 在/ 当时/ 受到/ 较大/ 影响/ ,/ 并/ 在/ 25s/ 内/ 达到/ 负/ 影响/ 的/ 极大值/ ,/ 至此/ ,/ 网络/ 重构/ 开始/ 收敛/ ,/ 由于/ 重构/ 算法/ 分层/ 迭代/ 的/ 设计/ ,/ 全网/ 吞吐/ 率/ 开始/ 呈现/ 阶梯状/ 回升/ ,/ 并/ 在/ 175s/ 后/ ,/ 回复/ 到/ 重构/ 前/ 的/ 速率/ 水平/ ,/ 而/ 曲线/ 代表/ 的/ 全网/ 开销/ ,/ 则/ 呈现出/ 在/ 第/ 150s/ 的/ 时刻/ 高/ 优先级/ 业务/ 出现/ ,/ 并/ 引发/ 网络/ 重构/ 后/ ,/ 逐渐/ 降低/ ,/ 并/ 在/ 网络/ 吞吐/ 率/ 稳定/ 前/ 基本/ 达到/ 新/ 的/ 稳定/ 水平/ ,/ 减少/ 了/ 13/ %/ 的/ 全网/ 连接/ 开销/ ./ 而图/ 9/ 中/ ,/ 可以/ 看出/ 被/ 重构/ 节点/ 在/ 第/ 150s/ 的/ 时刻/ ,/ 流量/ 发生/ 锐减/ ,/ 并/ 在/ 之后/ 70s/ 内/ 保持/ 相对/ 平缓/ 的/ 降低/ 并/ 达到/ 极小值/ ,/ 这/ 是因为/ 重构/ 算法/ 在/ 根据/ 重构/ 流量/ 中/ 的/ 文件/ 热点/ 度/ 进行/ 迭代/ 重构/ ./ 此后/ ,/ 流量/ 开始/ 呈现/ 阶段性/ 的/ 回升/ ,/ 达到/ 重构/ 前/ 的/ 流量/ 水平/ ./ 而/ 全网/ 节点/ 流量/ 总体/ 变化/ 较为/ 平缓/ ,/ 当/ 相应/ 节点/ 发生/ 流量/ 重构/ 时/ ,/ 全网/ 节点/ 平均/ 流量/ 出现/ 平缓/ 上升/ ,/ 随着/ 相应/ 节点/ 流量/ 重构/ 结束/ ,/ 全网/ 平均/ 流量/ 平缓/ 回落/ 至/ 初始/ 水平/ ./ 通过/ 图/ 8/ 和/ 图/ 9/ ,/ 可以/ 发现/ ,/ 本文/ 提出/ 的/ 策略/ 是/ 能够/ 在/ 可/ 接受/ 的/ 时间/ 范围/ 内/ 快速/ 收敛/ 的/ ,/ 在/ 保证/ 了/ 高/ 优先/ 业务/ 需求/ 的/ 前提/ 下/ ,/ 降低/ 了/ 全网/ 的/ 连接/ 开销/ ,/ 使得/ 整体/ 结构/ 更加/ 合理/ ,/ 同时/ 有效/ 减少/ 了/ 对/ P2P/ 用户/ 的/ 使用/ 影响/ ./ Page11/ 为/ 讨论/ 本文/ 提出/ 的/ 算法/ 在/ 不同/ 网络/ 规模/ 下/ 的/ 效果/ 、/ 对/ 网络/ 节点/ 性能/ 等/ 方面/ 的/ 影响/ ,/ 给出/ 下面/ 实验/ 结果/ ./ 其中/ ,/ 文件/ 热点/ 率/ 保持/ 为/ 2/ %/ ,/ 图/ 10/ 为/ 全网/ 开销/ 随/ 网络/ 规模/ 的/ 变化/ 曲线图/ ,/ 两/ 曲线/ 表示/ 使用/ 和/ 未/ 使用/ 本文/ 重构/ 策略/ 的/ 网络/ 开销/ 变化趋势/ ./ 图/ 11/ 为/ 全网/ 节点/ 的/ 平均/ 跳数/ 随/ 网络/ 规模/ 的/ 变化/ 图/ ,/ 3/ 根/ 方柱/ 分别/ 是/ 无/ 策略/ 、/ 简单/ 重定向/ 策略/ 和/ 本文/ 策略/ 的/ 情况/ ./ 图/ 12/ 为/ 节点/ 平均/ 入度/ 随/ 网络/ 规模/ 的/ 变化/ ,/ 同图/ 11/ ./ 由图/ 10/ 可/ 看出/ ,/ 全网/ 的/ 开销/ 随/ 网络/ 规模/ 的/ 增大/ 呈现/ 加速/ 增长/ 的/ 趋势/ ,/ 不同/ 的/ 是/ ,/ 未/ 按/ 本文/ 策略/ 进行/ 优化/ 的/ 情况/ 下/ ,/ 网络/ 开销/ 的/ 增长速度/ 则/ 要/ 大于/ 进行/ 全网/ 优化/ 的/ 情况/ ,/ 尤其/ 是/ 随着/ 网络/ 规模/ 的/ 增长/ ,/ 这种/ 差别/ 呈现出/ 逐渐/ 增大/ 的/ 趋势/ ./ 表明/ 本文/ 策略/ 有效/ 控制/ 了/ 随/ 网络/ 规模/ 增大/ 而/ 加速/ 激增/ 的/ 全网/ 连接/ 开销/ ./ 而图/ 11/ 中/ ,/ 文件/ 热点/ 率/ 保持/ 在/ 2/ %/ 不变/ 的/ 情况/ 下/ ,/ 可以/ 看出/ 在/ 1000/ 、/ 1750/ 和/ 2500/ 这/ 3/ 种/ 网络/ 规模/ 上/ ,/ 经过/ 本文/ 策略/ 优化/ 的/ 网络结构/ 下/ ,/ 平均/ 跳数/ 均/ 小于/ 未经/ 优化/ 的/ 网络/ ,/ 而/ 简单/ 重定向/ 机制/ 则/ 介于/ 两者之间/ ./ 从图/ 12/ 中/ 可以/ 看出/ ,/ 按照/ 本文/ 的/ 优化/ 策略/ ,/ 全网/ 范围/ 内/ ,/ 节点/ 入度/ 达到/ 3/ 及/ 以上/ 的/ 节点/ 数要/ 高于/ 未经/ 优化/ 和/ 按照/ 简单/ 重定向/ 机制/ 进行/ 优化/ 后/ 的/ 网络/ ,/ 这/ 给/ 高入度/ 节点/ 带来/ 了/ 一定/ 压力/ ./ 5/ 有关/ 部署/ 方面/ 的/ 局限性/ 关于/ 本文/ 方案/ 在/ 部署/ 中/ 的/ 问题/ 以及/ 与/ P4P/ 的/ 关系/ ,/ 在/ 此/ 做/ 阐述/ ./ 首先/ ,/ 可/ 重构/ 网络体系结构/ 及/ 相关/ 技术/ 的/ 部署/ 实现/ ,/ 需要/ 对/ 当前/ 网络/ 做出/ 重大/ 调整/ ,/ 配备/ 或/ 升级/ 大量/ 的/ 相应/ 网络/ 承载/ 设备/ 加以/ 支持/ ,/ 这一/ 网络/ 升级/ 过程/ 具有/ 一定/ 的/ 困难/ 和/ 阻力/ ./ 但/ 即便如此/ ,/ 可/ 重构/ 网络/ 具备/ 资源配置/ 方面/ 的/ 重大/ 优势/ ,/ 使/ 近年来/ 呼声/ 逐渐/ 提高/ ,/ 在/ 未来/ 确有/ 可能/ 会/ 逐步/ 替代/ 现有/ 网络/ 架构/ ./ 在/ 这种/ 局面/ 下/ ,/ 本文/ 方案/ 可/ 依照/ 第/ 4/ 节中/ 所述/ 方案/ 部署/ 实施/ ./ 同时/ ,/ 考虑/ 到/ 可/ 重构/ 网络/ 全面/ 替代/ 现有/ 网络/ 还/ 需/ 时日/ ,/ 笔者/ 也/ 对/ 本文/ 方案/ 在/ 现实/ 网络/ 环境/ 下/ 的/ 部署/ 实施/ 进行/ 了/ 相应/ 的/ 分析/ 设计/ ,/ 在/ 此/ 做/ 一/ 讨论/ ,/ 其/ 结构/ 如图/ 13/ 所示/ ./ 本文/ 方案/ 在/ 现实/ 网络/ 环境/ 中/ 的/ 部署/ 实施/ ,/ 仅/ 需要/ 网络/ 的/ 边缘/ 汇聚/ 路由器/ 提供/ 相应/ 支持/ ;/ 同时/ ,/ 需要/ 一组/ 中央/ 服务器/ ,/ 在/ 其/ 上/ 部署/ 本/ 技术/ 的/ 规划/ 算法/ ,/ 当/ 网络/ 规模/ 很大/ 时则/ 可以/ 搭建/ 云/ 处理/ 平台/ ,/ 如图/ 13/ 所示/ ./ 受/ 当前/ 网络/ 运营/ 的/ 商业模式/ 所/ 限/ ,/ 云/ 平台/ 无法/ 在/ 不同/ 运营商/ 之间/ 共享/ ,/ 因此/ 针对/ 现实/ 网络/ 的/ 部署/ 实际/ 情况/ 需要/ 各/ 运营商/ 针对/ 自治/ 域/ 或/ 自治/ 域/ 联盟/ 部署/ 自己/ 的/ 云/ 平台/ 管理/ 自治/ 域/ 中/ 各/ 网域/ 之间/ 的/ 流量/ 分配/ ./ 上述/ 部署/ 方法/ 在/ 现网/ 中/ 可行性/ 较强/ ,/ 如下/ 文/ 所述/ :/ 汇聚/ 路由器/ 需要/ 向云/ 平台/ 提供/ 其网/ 内/ 的/ 网络/ 信息/ ./ 当前/ 多数/ 厂商/ 的/ 主流/ 路由器/ 都/ 已/ 具备/ 了/ DPI/ 功能/ ,/ 且/ 运营商/ 也/ 已/ 部署/ 各层/ 别的/ DPI/ 设备/ ,/ 这一/ 信息/ 在/ 当前/ 环境/ 下/ 是/ 可以/ 提供/ 的/ ./ 另一方面/ ,/ 汇聚/ 路由器/ 需要/ 接受/ 云/ 平台/ 返回/ 的/ 优化/ 方案/ ,/ 调整/ 相应/ 流量/ ./ 此时/ ,/ 需要/ 边缘/ 路由器/ 获取/ peerlist/ 信息/ ./ 这种/ 协议/ 干预/ 方面/ 的/ 实验/ ,/ 作者/ 在/ 格林/ 威尔/ 的/ EPON/ 接入/ 的/ OLT/ 设备/ EP6100/ 及/ 比威/ 12008/ 系列/ 路由器/ 上/ 均/ 做/ 过/ 实验/ ,/ 验证/ 了/ 方案/ 的/ 可行性/ ./ 云/ 平台/ 上/ 部署/ P2P/ -/ NRRA/ 规划/ 算法/ ,/ 获取/ 由/ 各域/ 中/ 的/ 汇聚/ 路由器/ 上报/ 的/ 网络/ 信息/ ,/ 优化/ 调配/ 全网/ 资源/ ./ 当网域/ 内/ 某/ 链路/ 出现/ 高/ 优先级/ 业务/ 时/ ,/ 依据/ 当前/ 网络/ 状态/ ,/ 调用/ P2P/ -/ NRRA/ 算法/ ,/ 生成/ 相应/ 规划/ 方案/ 下发/ ,/ 保证/ 高/ 优先级/ 业务/ 的/ 网络资源/ 需求/ ,/ 同时/ 最大/ 限度/ 的/ 降低/ 对/ P2P/ 应用/ 业务/ 的/ 影响/ ./ 另外/ ,/ 本文/ 的/ 方案/ 与/ P4P/ 的/ 主导/ 思想/ 并不矛盾/ ,/ 而是/ 调整/ 和/ 细化/ ./ 一方面/ 针对/ P4P/ 的/ 信息/ 共享/ 提出/ 了/ 基于/ DPI/ 的/ 调整/ 建议/ ,/ 另一方面/ 细化/ 了/ 当/ 网络/ 高/ 优先级/ 业务/ 来临/ 的/ 情况/ 下/ 的/ 一种/ 以/ 调整/ P2P/ 流量/ 来/ 满足/ 高/ 优先级/ 业务/ 的/ 最优化/ 算法/ ./ 6/ 结束语/ 本文/ 针对/ 网络资源/ 分配/ 不均/ 的/ 实际/ 问题/ ,/ 尤其/ 网络/ 面对/ 高/ 优先级/ 业务/ 时/ 的/ 容纳/ 能力/ 有限/ 和/ P2P/ 业务/ 汹涌/ 的/ 现实情况/ ,/ 在/ 可/ 重构/ 网络/ 架构/ 逐渐/ 明朗化/ 的/ 今天/ ,/ 独辟蹊径/ 地/ 提出/ 了/ 一种/ 以/ 调整/ P2P/ 业务/ 为/ 主要/ 手段/ 的/ 网络资源/ 分配/ 方案/ ./ 在/ 保障/ P2P/ 用户/ 感受/ 的/ 前提/ 下/ ,/ 有/ 目标/ 的/ 释放/ 突发/ 需求/ 的/ 指定/ 链路/ 上/ P2P/ 所/ 占/ 的/ 大部分/ 网络资源/ ,/ 来/ 保证/ 其它/ 高/ 优先级/ 的/ 业务/ 应用/ ,/ 形成/ 可/ 由/ 运营商/ 全局/ 统筹/ 的/ 、/ 按需分配/ 的/ 可/ 重构/ 柔性/ 网络/ 环境/ ,/ 为/ 运营商/ 极大/ 减轻/ 了/ 网络带宽/ 的/ 负担/ ./ Page12/ 本文/ 详细/ 仿真/ 验证/ 了/ 方案/ 的/ 可行性/ 和/ 效果/ ./ 通过/ 仿真/ 结果/ 看出/ 本/ 技术/ 可/ 有效/ 优化/ 全网/ P2P/ 流量/ ,/ 并/ 在/ 突发/ 高/ 优先级/ 业务/ 时/ ,/ 以/ P2P/ 应用/ 小幅/ 波动/ 为/ 代价/ ,/ 有效/ 的/ 按/ 需/ 重构/ 指定/ 链路/ 的/ P2P/ 流量/ ,/ 达到/ 全网/ 资源/ 合理/ 分配/ ,/ 形成/ 弹性/ 的/ 网络/ 环境/ ./ 此外/ ,/ 后续/ 针对/ 可/ 重构/ 网络/ 短期内/ 无法/ 迅速/ 铺开/ 的/ 现状/ ,/ 对/ 现有/ 网络/ 架构/ 做出/ 了/ 一种/ 部署/ 方式/ 的/ 讨论/ ,/ 详细/ 说明/ 了/ 现网/ 部署/ 对/ 网络/ 改造/ 的/ 程度/ 不/ 大/ ,/ 论述/ 了/ 其/ 可行性/ ./ 本文/ 的/ 后续/ 研究/ 中/ ,/ 将/ 重点/ 针对/ 当前/ 网络/ 运营/ 商业模式/ 下/ ,/ 运营商/ 各自为政/ 无法/ 有/ 统一/ 云/ 平台/ 管理/ 的/ 部署/ 问题/ 进行/ 深入探讨/ 和/ 思考/ ,/ 拟/ 建立/ 博弈/ 模型/ 对此/ 问题/ 进行/ 分析/ 并/ 考虑/ 统一/ 云/ 平台/ 的/ 可行性/ 方案/ ./ 致谢/ 在/ 此/ ,/ 由衷感谢/ 林闯/ 老师/ 对/ 本文/ 工作/ 提出/ 的/ 宝贵意见/ 和/ 建议/ !/ 

