Page1/ 一种/ 有效/ 的/ 海量/ 数据/ Top/ -/ 犽/ Dominating/ 查询/ 算法/ 韩希先/ 李建中/ 高宏/ (/ 哈尔滨工业大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 摘要/ 在/ 多/ 准则/ 决策/ 支持/ 等/ 多个/ 应用/ 中/ ,/ top/ -/ kdominating/ 查询/ 是/ 一种/ 十分/ 实用/ 的/ 查询/ ,/ 它/ 在/ 潜在/ 的/ 巨大/ 的/ 数据/ 空间/ 中/ 返回/ k/ 个/ 支配/ 分数/ 最大/ 的/ 元组/ ./ 现有/ 算法/ ,/ 要么/ 需要/ 为/ 特定/ 的/ 属性/ 组合/ 构建/ 索引/ ,/ 要么/ 需要/ 较大/ 的/ I/ // O/ 费用/ 或/ 内存/ 费用/ ,/ 从而/ 无法/ 有效/ 处理/ 海量/ 数据/ 上/ top/ -/ kdominating/ 查询/ ./ 文中/ 提出/ 一种/ 新/ 的/ 查询/ 算法/ TDEP/ ,/ 该/ 算法/ 利用/ 以较/ 小/ 代价/ 为/ 每个/ 属性/ 构建/ 的/ 有/ 序列表/ 来/ 有效/ 返回/ 海量/ 数据/ 上/ 的/ top/ -/ kdominating/ 查询/ 结果/ ./ 文中/ 将/ TDEP/ 算法/ 的/ 执行/ 明确/ 地/ 分为/ 两个/ 阶段/ :/ 增长/ 阶段/ 和/ 收缩/ 阶段/ ./ 在/ 每个/ 阶段/ ,/ TDEP/ 算法/ 以/ round/ -/ robin/ 方式/ 读取/ 涉及/ 到/ 的/ 有/ 序列表/ 并/ 维护/ 候选/ 元组/ ,/ 直到/ 满足/ 结束/ 条件/ ./ 文中/ 分析/ 了/ 两个/ 阶段/ 的/ 执行/ 行为/ ,/ 提出/ 一种/ 新/ 的/ 不/ 需要/ 重新/ 读取/ 有/ 序列表/ 的/ 支配/ 分数/ 计算方法/ ./ 同时/ ,/ 文中/ 还/ 提出/ 有效/ 的/ 早/ 剪切/ 操作/ ,/ 可以/ 有效/ 减少/ TDEP/ 算法/ 需要/ 维护/ 的/ 候选/ 元组/ 数量/ ./ 实验/ 结果表明/ :/ 和/ 现有/ 算法/ 相比/ ,/ TDEP/ 算法/ 具有/ 较大/ 的/ 性能/ 优势/ ./ 关键词/ 海量/ 数据/ ;/ top/ -/ kdominating/ 查询/ ;/ TDEP/ 算法/ ;/ 有/ 序列表/ ;/ 早/ 剪切/ 操作/ 1/ 引言/ 在/ 许多/ 应用/ 中/ ,/ 偏好/ 查询/ 是/ 一种/ 十分/ 重要/ 的/ 查询/ 类型/ ,/ 它/ 在/ 潜在/ 的/ 巨大/ 的/ 数据/ 空间/ 中/ 返回/ 用户/ 感兴趣/ 的/ 数据/ ./ 偏好/ 查询/ 主要/ 包括/ 两种/ 查询/ 类型/ :/ top/ -/ k/ 查询/ 和/ skyline/ 查询/ ./ 在/ top/ -/ k/ 查询/ 中/ ,/ 用户/ 通常/ 给定/ 一个/ 单调/ 的/ 评分/ 函数/ 来/ 计算/ 每个/ 元组/ 的/ 分数/ ,/ top/ -/ k/ 查询/ 从/ 数据/ 空间/ 中/ 返回/ k/ 个/ 分数/ 最小/ 的/ 元组/ [/ 1/ ]/ ./ 不失/ 一般性/ ,/ 我们/ 假设/ 人们/ 更/ 喜欢/ 较/ 小/ 的/ 数值/ 而/ 不是/ 较大/ 的/ 数值/ ./ 图/ 1/ 给出/ 的/ 是/ 关于/ 旅馆/ 的/ 数据/ 集/ ,/ 人们/ 关心/ 的/ 属性/ 是/ 旅馆/ 的/ 价格/ (/ x/ )/ 以及/ 其离/ 海滩/ 的/ 距离/ (/ y/ )/ ,/ 给定/ 评分/ 函数/ F/ =/ x/ +/ y/ ,/ top/ -/ 2/ 查询/ 返回/ 的/ 结果/ 是/ p1/ 和/ p8/ ./ Top/ -/ k/ 查询/ 的/ 优点/ 是/ 它/ 可以/ 控制/ 返回/ 的/ 结果/ 数量/ ,/ 但是/ 其/ 问题/ 在于/ ,/ 找到/ 一个/ 合适/ 的/ 评分/ 函数/ 却/ 不是/ 一件/ 容易/ 的/ 事情/ ,/ 而且/ 不同/ 的/ 评分/ 函数/ 通常/ 会/ 产生/ 不同/ 的/ 结果/ ,/ 此外/ ,/ top/ -/ k/ 查询/ 的/ 结果/ 受/ 维度/ 之间/ 的/ 不同/ 标度/ 的/ 影响/ ./ 另一方面/ ,/ 给定/ skyline/ 准则/ 的/ 属性/ 集合/ AS/ ,/ skyline/ 查询/ 返回/ 不/ 被/ 其它/ 对象/ 支配/ 的/ 所有/ 对象/ [/ 2/ ]/ ./ 确切/ 地说/ ,/ 元组/ t1/ 支配/ 元组/ t2/ ,/ 如果/ t1/ 的/ 所有/ AS/ 属性/ 的/ 值/ 都/ 不/ 大于/ t2/ 的/ AS/ 属性/ 的/ 值/ ,/ 并且/ 在/ 其中/ 至少/ 一个/ 属性/ 上/ ,/ t1/ 在/ 该/ 属性/ 的/ 值/ 小于/ t2/ 在/ 该/ 属性/ 的/ 值/ ./ 如图/ 1/ 所示/ ,/ 给定/ 属性/ x/ 和/ y/ 作为/ skyline/ 准则/ ,/ skyline/ 查询/ 返回/ 的/ 结果/ 是/ p1/ 、/ p2/ 和/ p8/ ./ Skyline/ 查询/ 的/ 优点/ 在于/ ,/ 它/ 不/ 需要/ 特定/ 的/ 评分/ 函数/ ,/ 并且/ 它/ 的/ 结果/ 不/ 受/ 维度/ 之间/ 不同/ 标度/ 的/ 影响/ ./ 但是/ ,/ 其/ 问题/ 在于/ skyline/ 查询/ 的/ 结果/ 大小/ 无法控制/ ,/ 而/ 取决于/ skyline/ 准则/ 的/ 大小/ 、/ 元组/ 数量/ 和/ 数据分布/ ./ 近来/ ,/ 研究/ 人员/ 开始/ 关注/ 一种/ 新/ 的/ 类型/ 的/ 偏好/ 查询/ :/ top/ -/ kdominating/ 查询/ [/ 3/ -/ 4/ ]/ ,/ 该/ 查询/ 指定/ 属性/ 集合/ 作为/ skyline/ 准则/ ,/ 以此/ 来/ 确定/ 元组/ 间/ 的/ 支配/ 关系/ ./ 对于/ 每/ 一个/ 元组/ t/ ,/ 该/ 元组/ 的/ 支配/ 分数/ dom/ (/ t/ )/ 被/ 定义/ 为/ 被/ 该/ 元组/ 支配/ 的/ 元组/ 数量/ ,/ top/ -/ kdominating/ 查询/ 返回/ 支配/ 分数/ 最高/ 的/ k/ 个/ 元组/ ./ 如图/ 1/ 的/ 数据/ 集/ 所示/ ,/ top/ -/ 2dominating/ 查询/ 的/ 结果/ 是/ p1/ 和/ p3/ ,/ 其中/ ,/ dom/ (/ p1/ )/ =/ 4/ ,/ dom/ (/ p3/ )/ =/ 3/ ./ 从/ 实际/ 应用/ 的/ 角度/ 来看/ ,/ top/ -/ kdominating/ 查询/ 有效/ 结合/ top/ -/ k/ 查询/ 和/ skyline/ 查询/ 的/ 优势/ ,/ 同时/ 克服/ 其/ 缺点/ ,/ 其/ 优势/ 在于/ :/ (/ 1/ )/ 该/ 查询/ 不/ 需要/ 指定/ 评分/ 函数/ ;/ (/ 2/ )/ 该/ 查询/ 的/ 结果/ 数量/ 是/ 可以/ 控制/ 的/ ;/ (/ 3/ )/ 该/ 查询/ 的/ 结果/ 不/ 受/ 维度/ 间/ 不同/ 标度/ 的/ 影响/ ./ 自从/ Papadias/ 等/ 人/ [/ 3/ ]/ 引入/ top/ -/ kdominating/ 查询/ 的/ 思想/ 来/ 扩展/ skyline/ 计算/ ,/ 研究/ 人员/ 已经/ 提出/ 一系列/ 算法/ 来/ 处理/ 该/ 查询/ ./ 一类/ 算法/ ,/ 例如/ K/ -/ domina/ -/ ting/ _/ BBS/ [/ 3/ ]/ 和/ CBT/ [/ 4/ ]/ ,/ 利用/ 在/ 数据/ 集上/ 构建/ 的/ R/ -/ tree/ 结构/ 来/ 减少/ 需要/ 探索/ 的/ 数据/ 空间/ 并/ 返回/ top/ -/ kdominating/ 结果/ ./ 但是/ ,/ 这/ 类/ 方法/ 的/ 问题/ 在于/ ,/ 为了/ 构建/ 覆盖/ 所有/ skyline/ 准则/ 的/ top/ -/ kdominating/ 查询/ ,/ 这/ 类/ 方法/ 所/ 需要/ 的/ 预/ 构建/ 费用/ 和/ 存储/ 负载/ 太高/ ,/ 其/ 应用/ 受到/ 严重/ 限制/ ,/ 只能/ 为/ 选择/ 的/ 小/ 部分/ 属性/ 组合/ 构建/ 索引/ ./ 另一类/ 算法/ ,/ 例如/ FNP/ [/ 5/ ]/ 和/ DA/ [/ 6/ ]/ ,/ 则/ 不/ 需要/ 在/ 特定/ 属性/ 集合/ 上/ 构建/ 数据结构/ ./ FNP/ 算法/ 可以/ 在/ 非/ 索引/ 的/ 数据/ 集上/ 执行/ top/ -/ kdominating/ 查询/ ,/ 但是/ 该/ 方法/ 需要/ 对/ 数据/ 集/ 执行/ 3/ 轮/ 扫描/ 操作/ ,/ 在/ 海量/ 数据/ 上/ 其/ I/ // O/ 费用/ 过于/ 昂贵/ ./ DA/ 算法/ 要求/ 为/ 每个/ 属性/ 维护/ 一个/ 有/ 序列/ 文件/ ,/ 根据/ 指定/ 的/ skyline/ 准则/ 读取/ 涉及/ 到/ 的/ 有/ 序列/ 文件/ ,/ 渐进/ 地/ 返回/ 查询/ 结果/ ./ 但是/ ,/ 该/ 方法/ 的/ 问题/ 在于/ ,/ 在/ 海量/ 数据/ 上/ 执行/ 时/ ,/ 该/ 方法/ 需要/ 维护/ 的/ 候选/ 元组/ 较/ 多/ ,/ 而且/ 在/ 计算/ 元组/ 的/ 支配/ 分数/ 时该/ 算法/ 需要/ 重新/ 读取/ 有/ 序列/ 文件/ 的/ 元组/ ,/ 这些/ 问题/ 都/ 严重/ 影响/ 了/ 该/ 方法/ 的/ 执行/ 效率/ ./ 综上所述/ ,/ 现有/ 算法/ 无法/ 有效/ 地/ 处理/ 海量/ 数据/ top/ -/ kdominating/ 查询/ ./ 考虑/ 到/ 现有/ 方法/ 存在/ 的/ 问题/ ,/ 本文/ 提出/ 一种/ 新/ 的/ 算法/ TDEP/ (/ Top/ -/ kDominatingwithEarlyPrun/ -/ ing/ )/ 来/ 有效/ 处理/ 海量/ 数据/ 上/ 的/ top/ -/ kdominating/ 查询/ ./ TDEP/ 算法/ 利用/ 较/ 低/ 费用/ 构建/ 的/ 数据结构/ 来/ 有效/ 减少/ 查询/ 涉及/ 到/ 的/ I/ // O/ 费用/ ./ 给定/ 表/ T/ (/ A1/ ,/ A2/ ,/ …/ ,/ AM/ )/ ,/ TDEP/ 算法/ 为/ 每个/ 属性/ Aj/ 构建/ 一个/ 有/ 序列表/ Lj/ (/ 1/ / j/ / M/ )/ ,/ Lj/ 维护/ 对应/ 属性/ 值/ 按/ 升序/ 排列/ 的/ 元组/ 的/ 位置/ 索引/ ./ 给定/ skyline/ 准则/ {/ A1/ ,/ A2/ ,/ …/ ,/ Am/ }/ ,/ TDEP/ 算法/ 明确/ 地/ 把/ top/ -/ kdominating/ 查询/ 的/ 执行/ 过程/ 划分/ 成/ 两个/ 阶段/ :/ 增长/ 阶段/ 和/ 收缩/ 阶段/ ./ 在/ 增长/ 阶段/ ,/ TDEP/ 算法/ 以/ round/ -/ robin/ 方式/ 读取/ 涉及/ 到/ 的/ Page3/ 有/ 序列表/ {/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ }/ ,/ 维护/ 候选/ 元组/ 信息/ ./ 当有/ k/ 个/ 候选/ 元组/ 其/ 对应/ 的/ 属性/ A1/ ,/ A2/ ,/ …/ ,/ Am/ 都/ 出现/ 时/ (/ 这样/ 的/ 元组/ 也/ 称为/ 终结/ 元组/ )/ ,/ 增长/ 阶段/ 结束/ ,/ 此时/ top/ -/ kdominating/ 查询/ 的/ 结果/ 肯定/ 包括/ 在/ 当前/ 已/ 获得/ 的/ 候选/ 元组/ 中/ ./ 接着/ ,/ 在/ 收缩/ 阶段/ ,/ TDEP/ 算法/ 继续/ 对/ {/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ }/ 执行/ round/ -/ robin/ 方式/ 读取/ ,/ 并/ 维护/ 当前/ 支配/ 分数/ 最大/ 的/ k/ 个/ 终结/ 元组/ ./ 当/ top/ -/ kdominating/ 查询/ 结果/ 的/ 阈值/ 超过/ 其它/ 非/ 终结/ 元组/ 的/ 支配/ 分数/ 上界时/ ,/ TDEP/ 算法/ 结束/ 并/ 返回/ 结果/ ./ 类似/ 于/ DA/ 算法/ ,/ TDEP/ 算法/ 也/ 是/ 在/ 面向/ 列/ 存储/ 模型/ 上/ 执行/ ,/ 但是/ 本文/ 的/ 创新/ 之/ 处/ 在于/ :/ (/ 1/ )/ TDEP/ 算法/ 在/ 计算/ 终结/ 元组/ 的/ 支配/ 分数/ 时/ 不/ 需要/ 重新/ 读取/ 有/ 序列表/ 的/ 元组/ ,/ 而/ 只/ 需要/ 利用/ 已/ 获得/ 的/ 候选/ 元组/ 信息/ ./ (/ 2/ )/ TDEP/ 算法/ 在/ 查询/ 执行/ 开始/ 就/ 可以/ 对/ 候选/ 元组/ 执行/ 有效/ 的/ 剪切/ 操作/ ./ 本文/ 提出/ 了/ 对/ TDEP/ 算法/ 的/ 理论/ 分析/ ,/ 估计/ 了/ 增长/ 阶段/ 和/ 收缩/ 阶段/ 的/ 扫描/ 深度/ 和/ 需要/ 维护/ 的/ 候选/ 元组/ 结果/ ,/ 提出/ 了/ 有效/ 的/ 早/ 剪切/ 方法/ 以及/ 其/ 理论/ 剪切/ 效果/ ./ 本文/ 的/ 实验/ 结果表明/ :/ TDEP/ 算法/ 和/ 现有/ 方法/ 相比/ ,/ 其/ 加速/ 比可达/ 2/ 个/ 数量级/ ,/ 需要/ 维护/ 的/ 候选/ 元组/ 减少/ 可达/ 2/ 个/ 数量级/ ./ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 一种/ 新/ 的/ 海量/ 数据/ 上/ 的/ top/ -/ kdomina/ -/ ting/ 查询/ 算法/ ,/ 利用/ 低/ 费用/ 构建/ 的/ 数据结构/ ,/ 来/ 有效/ 返回/ 查询/ 结果/ ./ (/ 2/ )/ 提出/ 一种/ 有效/ 的/ 支配/ 分数/ 计算方法/ ,/ 只/ 需/ (/ 3/ )/ 对/ 增长/ 阶段/ 和/ 收缩/ 阶段/ 的/ 执行/ 行为/ 进行/ 理/ (/ 4/ )/ 提出/ 有效/ 的/ 早/ 剪切/ 方法/ ,/ 并且/ 提出/ 其/ 数学/ (/ 5/ )/ 用/ 实验/ 结果表明/ ,/ TDEP/ 算法/ 相/ 比较/ 于/ 现有/ 方法/ 具有/ 明显/ 的/ 优势/ ./ 本文/ 第/ 2/ 节/ 给出/ 本文/ 的/ 预备/ 知识/ ;/ 第/ 3/ 节/ 给出/ top/ -/ kdominating/ 查询/ 的/ 两/ 阶段/ 执行/ 分析/ ;/ 第/ 4/ 节/ 提出/ TDEP/ 算法/ 的/ 基本/ 执行/ 过程/ ,/ 早/ 剪切/ 方法/ 包括/ 在/ 第/ 5/ 节/ ;/ 第/ 6/ 节/ 评价/ TDEP/ 算法/ 的/ 性能/ ;/ 相关/ 工作/ 和/ 结论/ 分别/ 在/ 第/ 7/ 节/ 和/ 第/ 8/ 节/ ./ 2/ 预备/ 知识/ 2.1/ Top/ -/ 犽/ dominating/ 查询/ 给定/ 具有/ n/ 个/ 记录/ 的/ 表/ T/ (/ A1/ ,/ A2/ ,/ …/ ,/ AM/ )/ ,/ / t/ ∈/ T/ ,/ 令/ t/ [/ i/ ]/ 表示/ 元组/ t/ 的/ 属性/ Ai/ 的/ 值/ ./ 不失/ 一般性/ ,/ 令/ ASsky/ =/ {/ A1/ ,/ A2/ ,/ …/ ,/ Am/ }/ 表示/ top/ -/ kdomina/ -/ 要/ 利用/ 已/ 获得/ 的/ 候选/ 元组/ 信息/ 来/ 进行/ 计算/ ./ 论/ 分析/ ./ 分析/ 及/ 有效/ 的/ 实现/ 方法/ ./ ting/ 查询/ 涉及/ 到/ 的/ skyline/ 准则/ ,/ 元组/ 间/ 的/ 支配/ 关系/ 定义/ 在/ ASsky/ 上/ ./ / t1/ ,/ t2/ ∈/ T/ ,/ 我们/ 称/ t1/ 支配/ t2/ (/ 表示/ 为/ t1/ / t2/ )/ ,/ 如果/ / j/ (/ 1/ / j/ / m/ )/ ,/ t1/ [/ j/ ]/ / t2/ [/ j/ ]/ ,/ 并且/ / j/ (/ 1/ / j/ / m/ )/ ,/ t1/ [/ j/ ]/ </ t2/ [/ j/ ]/ ./ / t/ ∈/ T/ ,/ t/ 的/ 支配/ 值/ dom/ (/ t/ )/ 表示/ T/ 中/ 被/ t/ 支配/ 的/ 元组/ 数量/ ,/ 即/ (/ )/ domt/ =/ t/ ∈/ T/ |/ t/ / {/ Top/ -/ 犽/ dominating/ 查询/ :/ 给定/ 表/ T/ 以及/ skyline/ 准则/ ASsky/ ,/ top/ -/ kdominating/ 查询/ 返回/ 表/ T/ 的/ k/ -/ 子集/ R/ ,/ 使得/ / t1/ ∈/ R/ ,/ / t2/ ∈/ (/ T/ -/ R/ )/ ,/ dom/ (/ t1/ )/ / dom/ (/ t2/ )/ ./ 根据/ 支配/ 分数/ 的/ 定义/ ,/ 如果/ t1/ / t2/ ,/ 那么/ dom/ (/ t1/ )/ >/ dom/ (/ t2/ )/ ./ 本文/ 频繁/ 用到/ 的/ 符号/ 如表/ 1/ 所示/ ./ 符号/ T/ 用于/ top/ -/ k/ 支配/ 查询/ 的/ 数据表/ M/ 表/ T/ 的/ 维度/ n/ 表/ T/ 的/ 元组/ 数量/ ASskyTop/ -/ k/ 支配/ 查询/ 涉及/ 的/ skyline/ 准则/ mASsky/ 的/ 大小/ dpgrw/ 增长/ 阶段/ 的/ 扫描/ 深度/ dpshr/ 收缩/ 阶段/ 的/ 扫描/ 深度/ HTTDEP/ 中/ 维护/ 候选/ 元组/ 的/ Hash/ 表/ MH/ 维护/ 当前/ 具有/ 最大/ 支配/ 分数/ 的/ k/ 个/ 终结/ 元组/ 的/ 最小/ 堆/ domthresTop/ -/ k/ 支配/ 查询/ 结果/ 的/ 分数/ 阈值/ Lj/ 表/ T/ 中/ 属性/ Aj/ 对应/ 的/ 有/ 序列表/ Lj/ [/ 1/ ,/ i/ ]/ 有/ 序列表/ Lj/ 的/ 前/ i/ 个/ 元组/ 2.2/ DA/ 算法/ 在/ 垂直/ 划分/ 的/ 有/ 序列/ 文件/ 上/ ,/ Tiakas/ 等/ 人/ [/ 6/ ]/ 提出/ 一组/ 算法/ 来/ 处理/ 任意/ skyline/ 准则/ 的/ top/ -/ kdomi/ -/ nating/ 查询/ ,/ 其中/ ,/ DA/ 算法/ (/ DifferentialAlgorithm/ )/ 的/ 性能/ 优于/ 其它/ 的/ 算法/ ,/ 因此/ 这/ 一部分/ 主要/ 介绍/ DA/ 算法/ ./ 给定/ skyline/ 准则/ ASsky/ =/ {/ A1/ ,/ A2/ ,/ …/ ,/ Am/ }/ ,/ DA/ 算法/ 以/ round/ -/ robin/ 方式/ 读取/ 涉及/ 到/ 的/ 有/ 序列/ 文件/ {/ SC1/ ,/ SC2/ ,/ …/ ,/ SCm/ }/ ,/ 获得/ 的/ 候选/ 元组/ 存储/ 于/ 辅助/ 的/ B/ -/ 树结构/ Set/ -/ B/ +/ ,/ 并/ 记录/ 每个/ 候选/ 元组/ 的/ 出现/ 次数/ ./ 当/ 扫描/ 深度/ 为/ pos/ 时/ 获得/ 一个/ 终结/ 元组/ t/ ,/ 即该/ 候选/ 元组/ 的/ A1/ ,/ A2/ ,/ …/ ,/ Am/ 属性/ 都/ 已经/ 出现/ ,/ 这里/ 的/ 扫描/ 深度/ 表示/ 文件/ 的/ 位置/ ./ DA/ 算法/ 首先/ 计算/ 该/ 终结/ 元组/ 的/ 支配/ 分数/ (/ 估计值/ )/ dom/ (/ t/ )/ =/ n/ -/ pos/ ①/ ,/ 并/ 将/ 该/ 终结/ 元组/ 插入/ 最大/ 堆/ HP/ ./ 接着/ ,/ DA/ 算法/ 移除/ HP/ 中/ 的/ 最大/ 元素/ t1/ ,/ 如果/ t1/ 的/ 支配/ 分数/ 为/ 估计值/ ,/ 则/ 计算/ 其/ 准确/ 的/ 支配/ 分数/ dom/ (/ t1/ )/ ,/ 比较/ 该值/ 和/ 当前/ HP/ 的/ 最大/ 元素/ t2/ 的/ 支配/ 分数/ dom/ (/ t2/ )/ 的/ 关系/ ,/ 如果/ dom/ (/ t1/ )/ </ dom/ (/ t2/ )/ ,/ 则/ 将/ t1/ 重新/ 插入/ 到/ HP/ ,/ 否则/ ,/ 输出/ t1/ 为/ top/ -/ kdominating/ 查询/ 的/ 结果/ ./ 该/ 过程/ 迭代/ 执行/ ,/ 直到/ 输出/ k/ 个/ 结果/ 为止/ ./ ①/ 本文/ 假设/ 元组/ 处于/ 一般/ 位置/ [/ 7/ ]/ ./ Page4DA/ 算法/ 的/ 关键问题/ 在于/ ,/ 如果/ 当前/ 移除/ 的/ 元素/ t1/ 的/ 支配/ 分数/ 为/ 估计值/ ,/ 如何/ 有效/ 计算/ 其/ 准确/ 的/ 支配/ 分数/ ./ 在/ 获得/ 第/ 1/ 个/ 终结/ 元组/ tf/ 时/ ,/ 令/ tf/ 在/ 列/ 文件/ SC1/ ,/ SC2/ ,/ …/ ,/ SCm/ 的/ 出现/ 位置/ 分别/ 为/ lpos1/ (/ tf/ )/ ,/ lpos2/ (/ tf/ )/ ,/ …/ ,/ lposm/ (/ tf/ )/ ,/ DA/ 算法/ 重新/ 从列/ 文件/ SC1/ ,/ SC2/ ,/ …/ ,/ SCm/ 的/ 起始/ 位置/ 开始/ 扫描/ ,/ 直到/ 分别/ 扫描/ 到列/ 文件/ SCj/ (/ 1/ / j/ / m/ )/ 第/ lposj/ (/ tf/ )/ 个/ 元组/ ,/ 令/ UDj/ 表示/ SCj/ 的/ 前/ lposj/ (/ tf/ )/ -/ 1/ 个/ 元组/ ,/ 则/ domt/ (/ )/ f/ =/ n/ -/ ∪/ mDA/ 算法/ 并/ 没有/ 真正/ 维护/ 集合/ UDj/ ,/ 而是/ 只/ 计算/ 其/ 大小/ ,/ 这是/ 通过/ 利用/ Set/ -/ B/ +/ 中/ 候选/ 元组/ 的/ 出现/ 次数/ 来/ 实现/ 的/ ./ DA/ 算法/ 在/ 执行/ 过程/ 中/ 维护/ 一个/ 合适/ 的/ 已/ 获得/ 准确/ 支配/ 分数/ 的/ 终结/ 元组/ tb/ 及其/ 出现/ 的/ 位置/ lpos1/ (/ tb/ )/ ,/ lpos2/ (/ tb/ )/ ,/ …/ ,/ lposm/ (/ tb/ )/ ,/ 在/ 计算/ 下/ 一个/ 出现/ 的/ 终结/ 元组/ tp/ 的/ 准确/ 支配/ 分数/ 时/ ,/ 令/ tp/ 在/ 列/ 文件/ 中/ 出现/ 的/ 位置/ 分别/ 为/ lpos1/ (/ tp/ )/ ,/ lpos2/ (/ tp/ )/ ,/ …/ ,/ lposm/ (/ tp/ )/ ,/ DA/ 算法/ 不/ 需要/ 从列/ 文件/ SC1/ ,/ SC2/ ,/ …/ ,/ SCm/ 的/ 起始/ 位置/ 开始/ 扫描/ ,/ 而/ 只/ 需要/ 分别/ 从列/ 文件/ SCj/ (/ 1/ / j/ / m/ )/ 的/ 第/ lposj/ (/ tb/ )/ 元组/ 的/ 位置/ 开始/ ,/ 并/ 根据/ lposj/ (/ tb/ )/ 和/ lposj/ (/ tp/ )/ 的/ 大小/ 关系/ ,/ 来/ 决定/ 对列/ 文件/ SCj/ 采用/ 前向/ 扫描/ 或者/ 后/ 向/ 扫描/ ,/ 直到/ 扫描/ 到/ 第/ lposj/ (/ tp/ )/ 个/ 元组/ ,/ 采用/ 与/ 计算/ tf/ 的/ 准确/ 支配/ 分数/ 类似/ 的/ 方式/ 来/ 计算/ tb/ 的/ 准确/ 支配/ 分数/ ./ 这里/ ,/ DA/ 算法/ 维护/ 合适/ 的/ tb/ 的/ 信息/ 来/ 最小化/ 所/ 需要/ 的/ I/ // O/ 费用/ ,/ 即/ 最小化/ ∑/ m/ 行/ 过程/ 中/ ,/ DA/ 算法/ 采用/ minimumabsolutediffer/ -/ enceofpositionspreservation/ 规则/ ,/ 更新/ 维护/ 的/ 合适/ 的/ 终结/ 元组/ 的/ 信息/ ./ 虽然/ DA/ 算法/ 提出/ 了/ 一系列/ 剪切/ 操作/ 来/ 提高/ 其/ 执行/ 效率/ ,/ 但是/ 其/ 提出/ 的/ 剪切/ 规则/ 主要/ 是/ 用于/ 处理/ 获得/ 的/ 终结/ 元组/ ,/ 而/ 对于/ Set/ -/ B/ +/ 维护/ 的/ 候选/ 元组/ ,/ 其/ 剪切/ 效果/ 却/ 不好/ ,/ 尤其/ 是/ 在/ 找到/ k/ 个/ 终结/ 元组/ 之前/ ,/ DA/ 算法/ 无法/ 剪切/ 任何/ 候选/ 元组/ ./ 而且/ ,/ 由于/ 需要/ 计算/ 终结/ 元组/ 的/ 准确/ 支配/ 分数/ ,/ 在/ 找到/ k/ 个/ 终结/ 元组/ 之后/ ,/ DA/ 算法/ 也/ 需要/ 继续/ 维护/ 那些/ 理论/ 上/ 可以/ 剪切/ 的/ 元组/ ./ 从而/ ,/ 在/ 海量/ 数据/ 上/ 执行/ 时/ ,/ DA/ 算法/ 需要/ 维护/ 较/ 多/ 的/ 候选/ 元组/ ,/ 尤其/ 当/ 维护/ 的/ 候选/ 元组/ 超过/ 内存容量/ 时/ ,/ 内存/ 中/ 的/ 候选/ 元组/ 需要/ 利用/ 磁盘/ 作为/ 中转/ 空间/ ,/ 更加/ 影响/ 算法/ 的/ 性能/ ./ 此外/ ,/ DA/ 算法/ 利用/ 重新/ 读取/ 列/ 文件/ 来/ 计算/ 终结/ 元组/ 准确/ 支配/ 分数/ 的/ 方式/ 也/ 增加/ 了/ 其/ 执行/ 的/ 费用/ ./ 因此/ ,/ 通过/ 分析/ 有/ 序列/ 文件/ 上/ 查询/ 的/ 执行/ 行为/ ,/ 本文/ 对/ top/ -/ kdomi/ -/ nating/ 查询/ 的/ 执行/ 过程/ 进行/ 明确/ 划分/ ,/ 提出/ 有效/ 的/ 剪切/ 方法/ 来/ 减少/ 需要/ 维护/ 的/ 候选/ 元组/ ,/ 并且/ 不/ 需要/ 重新/ 读取/ 列/ 文件/ 来/ 计算/ 终结/ 元组/ 的/ 准确/ 支配/ 分数/ ,/ 从而/ 能/ 有效/ 提高/ 算法/ 的/ 性能/ ./ 3/ 两/ 阶段/ 执行/ 分析/ 自从/ Fagin/ 等/ 人/ 的/ 开创性/ 的/ 工作/ [/ 8/ ]/ 以来/ ,/ 在/ 垂直/ 划分/ 的/ 有/ 序列/ 文件/ 上/ 执行/ 偏好/ 查询/ 是/ 研究/ 人员/ 的/ 一个/ 自然选择/ [/ 9/ -/ 10/ ]/ ,/ 即以/ round/ -/ robin/ 的/ 方式/ 读取/ 涉及/ 到/ 的/ 有/ 序列/ 文件/ ,/ 维护/ 候选/ 元组/ ,/ 逐渐/ 更新/ 候选/ 元组/ 的/ 相关/ 信息/ ,/ 直到/ 满足/ 结果/ 输出/ 条件/ ./ 通常/ ,/ 这种/ 方法/ 不/ 需要/ 读取/ 全部/ 的/ 列/ 文件/ 元组/ 就/ 可以/ 返回/ 查询/ 结果/ ./ 对于/ / t/ ∈/ T/ ,/ 令/ t/ / pi/ 表示/ 元组/ t/ 的/ 位置/ 索引/ ,/ 即/ 元组/ t/ 在/ 表/ T/ 中/ 的/ 出现/ 位置/ ./ 如果/ t/ 是/ T/ 的/ 第/ i/ 个/ 元组/ ,/ 则/ t/ / pi/ =/ i/ ,/ 我们/ 令/ T/ (/ i/ )/ 表示/ T/ 中/ 位置/ 索引/ 为/ i/ 的/ 元组/ ./ 在/ 本文/ 提出/ 的/ 算法/ 中/ ,/ 我们/ 只/ 需要/ 考虑/ 每个/ 列/ 文件/ 的/ 值/ 的/ 大小/ 关系/ ,/ 而/ 不/ 需要/ 知道/ 具体/ 的/ 数值/ ,/ 因此/ 用到/ 的/ 有/ 序列/ 文件/ 只/ 包括/ 每个/ 元组/ 的/ 位置/ 索引/ ./ 以下/ ,/ 本文/ 称/ 这样/ 的/ 列/ 文件/ 为/ 有/ 序列表/ ./ 给定/ 表/ T/ (/ A1/ ,/ A2/ ,/ …/ ,/ AM/ )/ ,/ 其/ 对应/ 的/ 有/ 序列表/ 集合/ LS/ =/ {/ L1/ ,/ L2/ ,/ …/ ,/ LM/ }/ 构建/ 方法/ 如下/ :/ (/ 1/ )/ 表/ T/ 被/ 分解/ 为/ 一组/ 列/ 文件/ CS/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ CM/ }/ ,/ 列/ 文件/ Cj/ 的/ 模式/ 为/ Cj/ (/ Aj/ ,/ PI/ )/ ,/ 这里/ PI/ 表示/ 元组/ 的/ 位置/ 索引/ ,/ 而/ Aj/ 则/ 表示/ 元组/ T/ (/ PI/ )/ 的/ 对应/ 属性/ 值/ ./ (/ 2/ )/ 对/ 每个/ 列/ 文件/ Cj/ 根据/ 属性/ Aj/ 的/ 升序/ 执行/ 排序/ ,/ 排序/ 后/ 的/ 列/ 文件/ 保留/ PI/ 属性/ 从而/ 获得/ 有/ 序列表/ Lj/ ./ / i1/ ,/ i2/ ∈/ Lj/ ,/ i1/ / i2/ ,/ TLji/ (/ )/ (/ )/ 1/ [/ j/ ]/ / TLji/ (/ )/ (/ )/ 2/ [/ ]/ j/ ./ 我们/ 发现/ ,/ 在/ 有/ 序列/ 文件/ 上/ 执行/ top/ -/ kdomina/ -/ ting/ 查询/ 的/ 算法/ ,/ 其/ 执行/ 过程/ 可以/ 分为/ 两个/ 阶段/ :/ 增长/ 阶段/ 和/ 收缩/ 阶段/ ./ 增长/ 阶段/ 包括/ top/ -/ kdominating/ 算法/ 的/ 开始/ ,/ 直到/ 该/ 算法/ 获得/ k/ 个/ 终结/ 元组/ 为止/ ./ 在/ 这个/ 阶段/ ,/ 算法/ 不断/ 维护/ 获得/ 的/ 候选/ 元组/ ./ 当/ 算法/ 获得/ k/ 个/ 终结/ 元组/ 后/ ,/ 定理/ 1/ 证明/ 最终/ 的/ top/ -/ kdominating/ 结果/ 肯定/ 在/ 已经/ 获得/ 的/ 候选/ 元组/ 中/ ./ 定理/ 1/ ./ 当/ 增长/ 阶段/ 结束/ 时/ ,/ top/ -/ kdominating/ 结果/ 包括/ 在/ 已经/ 获得/ 的/ 候选/ 元组/ 中/ ./ 证明/ ./ 假设/ 当前/ 算法/ 已经/ 获得/ k/ 个/ 终结/ 元组/ ,/ 令/ tild/ 表示/ 其中/ 支配/ 分数/ 最低/ 的/ 终结/ 元组/ ./ / t/ ∈/ T/ ,/ 如果/ t/ / pi/ 没有/ 在/ 增长/ 阶段/ 出现/ ,/ 那么/ / j/ (/ 1/ / j/ / m/ )/ ,/ tild/ [/ j/ ]/ / t/ [/ j/ ]/ ,/ tild/ / t/ ,/ dom/ (/ tild/ )/ >/ dom/ (/ t/ )/ ./ 元组/ t/ 肯定/ 不是/ top/ -/ kdominating/ 结果/ ./ 增长/ 阶段/ 结束/ 后/ ,/ top/ -/ kdominating/ 算法/ 进入/ Page5/ 收缩/ 阶段/ ./ 在/ 这/ 一/ 阶段/ ,/ 对于/ 任意/ 新/ 获得/ 的/ 候选/ 元组/ ,/ 如果/ 在/ 其/ 之前/ 没有/ 出现/ ,/ 那么/ 该/ 候选/ 元组/ 肯定/ 不是/ top/ -/ kdominating/ 结果/ ./ 同时/ ,/ 利用/ 新/ 获得/ 的/ 信息/ ,/ 算法/ 可以/ 剪切/ 某些/ 新/ 生成/ 的/ 终结/ 元组/ ,/ 从而/ 最终/ 获得/ 查询/ 结果/ ./ 根据/ 这/ 一部分/ 的/ 分析/ ,/ 我们/ 发现/ 现有/ 的/ DA/ 算法/ 在/ 增长/ 阶段/ 没有/ 执行/ 任何/ 剪切/ 操作/ ,/ 而/ 只是/ 剪切/ 在/ 收缩/ 阶段/ 出现/ 的/ 部分/ 终结/ 元组/ ./ 而且/ ,/ DA/ 算法/ 需要/ 重新/ 读取/ 有/ 序列/ 文件/ 的/ 数据/ 来/ 计算/ 每个/ 终结/ 元组/ 的/ 支配/ 分数/ ,/ 增加/ 了/ 查询处理/ 的/ I/ // O/ 费用/ ./ 接下来/ ,/ 我们/ 将/ 提出/ 一种/ 新/ 的/ top/ -/ kdominating/ 查询/ 算法/ ,/ 该/ 方法/ 将/ 有效/ 减少/ 执行/ 过程/ 中/ 需要/ 维护/ 的/ 候选/ 元组/ 数量/ ,/ 而且/ 不/ 需要/ 重新/ 读取/ 列/ 文件/ 来/ 计算/ 支配/ 分数/ ./ 4TDEP/ 算法/ 在/ 这/ 一节/ ,/ 我们/ 将/ 介绍/ TDEP/ 算法/ 在/ 增长/ 阶段/ 和/ 收缩/ 阶段/ 的/ 具体/ 执行/ ./ 4.1/ 增长/ 阶段/ 给定/ top/ -/ kdominating/ 查询/ 的/ skyline/ 准则/ ASsky/ =/ {/ A1/ ,/ A2/ ,/ …/ ,/ Am/ }/ ,/ TDEP/ 算法/ 读取/ 涉及/ 到/ 的/ 有/ 序列表/ 集合/ LS/ =/ {/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ }/ ,/ 并且/ 在/ Hash/ 表/ HT/ 中/ 维护/ 需要/ 的/ 信息/ ./ 这里/ ,/ HT/ 初始/ 为空/ ,/ 每个/ 记录/ 的/ 格式/ 为/ (/ key/ =/ pi/ ,/ value/ =/ (/ counter/ ,/ position/ )/ )/ ,/ 其中/ key/ 表示/ 获得/ 的/ 位置/ 索引/ 值/ ,/ value/ 维护/ 该/ 位置/ 索引/ 值/ 出现/ 的/ 次数/ counter/ 和/ 相应/ 的/ 位置/ 数组/ position/ [/ 1/ ,/ …/ ,/ m/ ]/ ,/ position/ 数组/ 初始值/ 为/ Long/ ./ TDEP/ 算法/ 在/ 增长/ 阶段/ 的/ 执行/ 过程/ 如下/ 所示/ :/ (/ 1/ )/ TDEP/ 算法/ 以/ round/ -/ robin/ 方式/ 读取/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ ./ 对于/ 获得/ 的/ 位置/ 索引/ 值/ pi/ =/ Lj/ (/ pos/ )/ ,/ 算法/ 检查/ HT/ 是否/ 含有/ 以/ pi/ 为键/ 的/ 记录/ ,/ 如果/ 不/ 存在/ ,/ 则/ 在/ HT/ 中/ 插入/ 一条/ 新/ 的/ 记录/ (/ pi/ ,/ (/ 1/ ,/ position/ [/ j/ ]/ =/ pos/ )/ )/ ./ 否则/ ,/ 该/ Hash/ 表/ 存在/ 以/ pi/ 为/ 键值/ 的/ 记录/ (/ pi/ ,/ (/ counter/ ,/ position/ )/ )/ ,/ 更新/ 该/ 记录/ 为/ (/ pi/ ,/ (/ counter/ +/ 1/ ,/ position/ [/ j/ ]/ =/ pos/ )/ )/ ./ 如果/ 该/ 位置/ 索引/ 的/ 出现/ 次数/ 等于/ m/ ,/ 该/ 位置/ 索引/ 对应/ 的/ 元组/ 称为/ 一个/ 终结/ 元组/ ./ (/ 2/ )/ TDEP/ 算法/ 对/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ 的/ round/ -/ robin/ 读取/ 不断/ 执行/ ,/ 直到/ 出现/ k/ 个/ 终结/ 元组/ ./ 此时/ 增长/ 阶段/ 结束/ ,/ 定理/ 1/ 证明/ top/ -/ kdominating/ 查询/ 结果/ 的/ 位置/ 索引/ 包括/ 在/ Hash/ 表/ HT/ 的/ 键值/ 集合/ 中/ ./ 增长/ 阶段/ 结束/ 时/ ,/ TDEP/ 算法/ 首先/ 为/ 生成/ 的/ k/ 个/ 终结/ 元组/ 分别/ 计算/ 其/ 支配/ 分数/ ,/ 然后/ 将/ 这些/ 终结/ 元组/ 插入/ 最小/ 堆/ MH/ 中/ ,/ MH/ 的/ 最小/ 支配/ 分数/ domthres/ 作为/ top/ -/ kdominating/ 查询/ 结果/ 的/ 阈值/ ,/ 任何/ 支配/ 分数/ 低于/ 该/ 阈值/ 的/ 元组/ 都/ 不是/ top/ -/ kdomi/ -/ nating/ 查询/ 结果/ ./ 下面/ ,/ 我们/ 介绍/ 如何/ 不/ 重新/ 读取/ 有/ 序列表/ ,/ 仅仅/ 利用/ Hash/ 表/ 维护/ 的/ 信息/ 来/ 计算/ 终结/ 元组/ 的/ 支配/ 分数/ ./ 给定/ 增长/ 阶段/ 获得/ 的/ 任意/ 终结/ 元组/ ti/ ,/ 该/ 元组/ 对应/ 的/ HT/ 记录/ 的/ 键值/ 为/ ti/ / pi/ ,/ 我们/ 得到/ 该/ 记录/ 的/ 值/ 为/ (/ m/ ,/ positionti/ )/ ,/ positionti/ [/ 1/ ]/ ,/ positionti/ [/ 2/ ]/ ,/ …/ ,/ positionti/ [/ m/ ]/ 维护/ 的/ 分别/ 是/ ti/ / pi/ 在/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ 出现/ 的/ 位置/ ./ 我们/ 遍历/ Hash/ 表/ HT/ 的/ 所有/ 记录/ ,/ 并且/ 维护/ 数组/ sum/ [/ 1/ ,/ …/ ,/ m/ ]/ ,/ 该/ 数组/ 的/ 初始值/ 都/ 为/ 0/ ./ / rec/ ∈/ HT/ ,/ 如果/ 数组/ rec/ / position/ 的/ m/ 个/ 元素/ 满足条件/ rec/ / position/ [/ j/ ]/ </ positionti/ [/ j/ ]/ (/ 1/ / j/ / m/ )/ 的/ 个数/ 为/ jsat/ ,/ 我们/ 对/ sum/ [/ jsat/ ]/ 的/ 值/ 自增/ 1/ ./ 这样/ ,/ 对/ HT/ 遍历/ 完毕/ 后/ ,/ sum/ [/ j/ ]/ 维护/ 的/ 就是/ 在/ 获得/ 终结/ 元组/ ti/ 时/ 位置/ 索引/ 出现/ j/ 次/ 的/ 候选/ 元组/ 数量/ (/ 不/ 考虑/ ti/ / pi/ )/ ,/ 终结/ 元组/ ti/ 的/ 支配/ 分数/ :/ 该/ 计算公式/ 解释/ 如下/ :/ 如图/ 2/ 所示/ ,/ TDEP/ 算法/ 获得/ ti/ / pi/ 时/ ,/ 终结/ 元组/ ti/ 无法/ 支配/ 的/ 元组/ 的/ 位置/ 索引/ 包括/ 在/ ∪/ mpositionti/ [/ 1/ ]/ -/ 1/ ]/ ,/ L2/ [/ 1/ ,/ positionti/ [/ 2/ ]/ -/ 1/ ]/ ,/ …/ ,/ Lm/ [/ 1/ ,/ positionti/ [/ m/ ]/ -/ 1/ ]/ 中/ 分别/ 出现/ 1/ 次/ 、/ 2/ 次/ 、/ …/ 、/ m/ 次/ 的/ 位置/ 索引/ ,/ 同时/ ,/ 在/ 考虑/ 支配/ 关系/ 时/ ,/ 我们/ 也/ 不/ 考虑/ 元组/ 对/ 其/ 自身/ 的/ 支配/ ,/ 因此/ 我们/ 得到/ 如上/ 的/ 计算公式/ ./ 这里/ ,/ Lj/ [/ 1/ ,/ i/ ]/ 表示/ 有/ 序列表/ Lj/ 的/ 前/ i/ 个/ 元组/ ./ 当然/ ,/ 如果/ 维护/ 的/ 候选/ 元组/ 数量/ 较/ 多/ ,/ 内存/ 无法/ 容纳/ 全部/ 的/ 候选/ 元组/ ,/ 那么/ Hash/ 表/ 的/ 一部分/ 数据/ 就/ 需要/ 输出/ 到/ 磁盘/ 上/ ,/ 从而/ 对于/ Hash/ 表/ 相关/ 的/ 操作/ 就/ 需要/ 涉及/ 到/ 磁盘/ 上/ 的/ 数据/ ./ 但是/ 根据/ 如下/ 的/ 描/ Page6/ 述/ ,/ 一般来说/ ,/ TDEP/ 算法/ 在/ 海量/ 数据/ 上/ 维护/ 的/ 候选/ 元组/ 是/ 可以/ 容纳/ 在/ 内存/ 中/ 的/ ./ 增长/ 阶段/ 结束/ 后/ ,/ 最小/ 堆/ MH/ 维护/ 着/ 当前/ 获得/ 的/ k/ 个/ 具有/ 准确/ 支配/ 分数/ 的/ 终结/ 元组/ ,/ TDEP/ 算法/ 进入/ 收缩/ 阶段/ ./ 4.2/ 收缩/ 阶段/ 收缩/ 阶段/ 的/ 执行/ 过程/ 如下/ 所示/ :/ (/ 1/ )/ TDEP/ 算法/ 从/ 增长/ 阶段/ 结束/ 位置/ 继续/ 对/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ 执行/ round/ -/ robin/ 方式/ 读取/ ,/ 以/ 类似/ 于/ 增长/ 阶段/ 的/ 方式/ 在/ Hash/ 表/ HT/ 中/ 维护/ 并/ 更新/ 对应/ 的/ 记录/ 信息/ ./ 令/ pi/ =/ Lj/ (/ pos/ )/ 是/ 当前/ 获得/ 的/ 位置/ 索引/ ,/ 很/ 明显/ ,/ 此时/ 任何/ 非/ 终结/ 元组/ 的/ 支配/ 分数/ 不/ 超过/ (/ n/ -/ pos/ )/ ./ (/ 2/ )/ 当/ 获得/ 一个/ 终结/ 元组/ ti/ 时/ ,/ 计算/ 其/ 精确/ 的/ 支配/ 分数/ dom/ (/ ti/ )/ ,/ 如果/ dom/ (/ ti/ )/ >/ domthres/ ,/ 则/ 移除/ 最小/ 堆/ MH/ 的/ 最小/ 元素/ ,/ 将/ ti/ 插入/ 到/ MH/ 中/ ,/ 并/ 更新/ domthres/ 为/ MH/ 的/ 当前/ 的/ 最小/ 支配/ 分数/ ./ 根据/ 定理/ 2/ ,/ 如果/ domthres/ / n/ -/ pos/ ,/ 则/ TDEP/ 算法/ 结束/ ,/ 最小/ 堆/ MH/ 维护/ 的/ 就是/ top/ -/ kdominating/ 查询/ 的/ 结果/ ./ 否则/ ,/ 继续执行/ 对/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ 的/ round/ -/ robin/ 读取/ 操作/ ./ 定理/ 2/ ./ 在/ 收缩/ 阶段/ ,/ 给定/ TDEP/ 算法/ 的/ 当前/ 扫描/ 深度/ 为/ pos/ ,/ 如果/ domthres/ / n/ -/ pos/ 时/ ,/ TDEP/ 算法/ 结束/ ./ 证明/ ./ 令/ TDEP/ 算法/ 的/ 扫描/ 深度/ 为/ pos/ 时/ ,/ 获得/ 的/ 终结/ 元组/ 集合/ 为/ TISpos/ ,/ 最小/ 堆/ MH/ 维护/ 的/ 是/ TISpos/ 中/ 准确/ 支配/ 分数/ 最大/ 的/ k/ 个/ 终结/ 元组/ ./ 已知/ ,/ / t/ ∈/ (/ T/ -/ TISpos/ )/ ,/ 元组/ t/ 的/ 支配/ 分数/ 肯定/ 不/ 超过/ (/ n/ -/ pos/ )/ ./ 所以/ ,/ 如果/ domthres/ / n/ -/ pos/ ,/ 则/ / t/ ∈/ (/ T/ -/ TISpos/ )/ ,/ t/ 的/ 支配/ 分数/ 小于/ MH/ 的/ 最小/ 支配/ 分数/ ./ 4.3/ 一些/ 改进/ 这/ 一部分/ ,/ 我们/ 介绍/ 如何/ 对/ TDEP/ 算法/ 做/ 进一步/ 的/ 改进/ ./ 方法/ 1/ ./ 在/ 计算/ 终结/ 元组/ 的/ 准确/ 支配/ 分数/ 时/ ,/ TDEP/ 算法/ 不/ 需要/ 重新/ 读取/ 有/ 序列表/ 的/ 元组/ ,/ 而/ 只/ 需要/ 对/ Hash/ 表/ HT/ 执行/ 一轮/ 顺序/ 扫描/ ./ 当/ 内存/ 维护/ 的/ 候选/ 元组/ 较多时/ ,/ 对/ HT/ 的/ 一轮/ 扫描/ 会/ 造成/ 较大/ 的/ 内存/ 费用/ ./ 因此/ ,/ 本文/ 采用/ 批量/ 计算/ 终结/ 元组/ 的/ 精确/ 支配/ 分数/ 的/ 方法/ 来/ 分摊/ 对/ HT/ 一轮/ 扫描/ 的/ 费用/ ./ 对于/ 扫描/ 过程/ 获得/ 的/ 每/ k/ 个/ 终结/ 元组/ ,/ TDEP/ 算法/ 并/ 不是/ 对于/ 单个/ 终结/ 元组/ 进行/ 处理/ ,/ 而是/ 利用/ 对/ HT/ 的/ 一轮/ 扫描/ 来/ 同时/ 计算/ k/ 个/ 终结/ 元组/ 的/ 准确/ 支配/ 分数/ ./ 这样/ 就/ 分摊/ 了/ 对于/ HT/ 一轮/ 扫描/ 的/ 费用/ ./ 方法/ 2/ ./ 在/ 收缩/ 阶段/ ,/ 最小/ 堆/ MH/ 维护/ 着/ 目前/ 出现/ 的/ k/ 个/ 具有/ 最大/ 准确/ 支配/ 分数/ 的/ 候选/ 元组/ ,/ 令/ 其中/ 的/ 最小/ 元素/ 是/ timh/ ,/ 对于/ 收缩/ 阶段/ 获得/ 的/ 任何/ 终结/ 元组/ ti/ ,/ 如果/ timh/ / ti/ ,/ 那么/ TDEP/ 算法/ 不/ 需要/ 计算/ ti/ 的/ 准确/ 支配/ 分数/ ,/ 因为/ dom/ (/ ti/ )/ </ dom/ (/ timh/ )/ ,/ 从而/ ti/ 不是/ top/ -/ kdominating/ 查询/ 的/ 结果/ ./ 当然/ ,/ 在/ 比较/ timh/ 和/ ti/ 的/ 支配/ 关系/ 时/ ,/ TDEP/ 不/ 需要/ 读取/ 它们/ 的/ 真正/ 的/ 属性/ 值/ ,/ 而/ 只/ 需要/ 判断/ 其/ 对应/ 的/ 位置/ 索引/ 在/ 有/ 序列表/ 的/ 位置/ ./ 5/ 剪切/ 技术/ 这/ 一部分/ ,/ 我们/ 介绍/ 如何/ 对/ TDEP/ 算法/ 执行/ 剪切/ 操作/ ,/ 从而/ 改进/ top/ -/ kdominating/ 查询/ 算法/ ./ 由于/ 本节/ 的/ 重点/ 在于/ 讨论/ 剪切/ 操作/ ,/ 为/ 更/ 清晰/ 地/ 分析/ 问题/ ,/ 本/ 节/ 假设/ 表/ T/ 的/ 各/ 属性/ 均匀/ 独立/ 分布/ ./ 5.1/ 候选/ 元组/ 数量/ 首先/ ,/ 我们/ 分析/ TDEP/ 算法/ 需要/ 维护/ 的/ 候选/ 元组/ 数量/ ./ 令/ 增长/ 阶段/ 结束/ 时/ ,/ 算法/ 对/ 有/ 序列表/ 的/ 扫描/ 深度/ 是/ dpgrw/ ,/ 这里/ 的/ 扫描/ 深度/ 指/ 的/ 是/ 对/ L1/ ,/ L2/ ,/ …/ ,/ Lm/ 分别/ 读取/ 的/ 元组/ 数量/ ,/ 令/ 收缩/ 阶段/ 结束/ 时/ ,/ 算法/ 对/ 有/ 序列表/ 的/ 扫描/ 深度/ 是/ dpshr/ ./ / t/ ∈/ T/ ,/ 我们/ 有/ Pt/ / pi/ ∈/ Lj/ [/ 1/ ,/ dpgrw/ 令/ t/ 在/ 增长/ 阶段/ 成为/ 一个/ 终结/ 元组/ 为/ 一次/ 成功/ 事件/ S1/ ,/ 那么/ 成功/ 事件/ S1/ 的/ 概率/ 是/ psuc/ =/ dpgrw/ (/ )/ n/ 成功/ 事件/ S1/ 的/ 次数/ 满足/ 二项分布/ BD1/ (/ n/ ,/ psuc/ )/ ./ 根据/ DeMoivre/ -/ Laplace/ 定理/ [/ 11/ ]/ ,/ 在/ 海量/ 数据/ 上/ 二项分布/ BD1/ 可/ 替换/ 为/ 正态分布/ ND/ (/ n/ ×/ psuc/ ,/ n/ ×/ psuc/ ×/ (/ 1/ -/ psuc/ )/ )/ ./ 我们/ 以极/ 高/ 概率/ (/ 0.999968/ )/ 保证/ ,/ 当时/ ,/ 成功/ 事件/ S1/ 的/ 次数/ 不/ 小于/ k/ ,/ 其中/ a/ =/ n2/ +/ 16n/ ,/ b/ =/ -/ 2nk/ +/ 16/ (/ )/ n/ ,/ c/ =/ k2/ [/ 9/ ]/ ./ 令/ NUM/ (/ t/ / pi/ ,/ dpgrw/ )/ 表示/ 位置/ 索引/ t/ / pi/ 在/ L1/ [/ 1/ ,/ dpgrw/ ]/ ,/ L2/ [/ 1/ ,/ dpgrw/ ]/ ,/ …/ ,/ Lm/ [/ 1/ ,/ dpgrw/ ]/ 中/ 出现/ 的/ 次数/ ,/ 则/ NUM/ (/ t/ / pi/ ,/ dpgrw/ )/ 满足/ 二项分布/ BD2/ (/ m/ ,/ dpgrwn/ )/ ./ 在/ 增长/ 阶段/ ,/ HT/ 维护/ 的/ 记录/ 数量/ NUMgrw/ 计算/ 为/ NUMgrw/ =/ ∑/ mdpgrw/ )/ nPage7m/ -/ j/ 表示/ 位置/ 索引/ t/ / pi/ 在/ 增长/ 阶段/ 出现/ j/ 次/ 的/ 概率/ ./ 当/ 增长/ 阶段/ 结束/ 时/ ,/ top/ -/ kdominating/ 查询/ 的/ 支配/ 分数/ 阈值/ domthres/ / n/ -/ m/ ×/ dpgrw/ ,/ 这个/ 值/ 在/ TDEP/ 算法/ 的/ 执行/ 过程/ 中是/ 单调/ 非/ 递减/ 的/ (/ mono/ -/ tonicallynon/ -/ decreasing/ )/ ./ 在/ 收缩/ 阶段/ ,/ 令/ pos/ 是/ 当前/ 的/ 扫描/ 深度/ ,/ 任何/ 非/ 终结/ 元组/ 的/ 支配/ 分数/ 不/ 超过/ (/ n/ -/ pos/ )/ ,/ 那么/ 当/ domthres/ / n/ -/ m/ ×/ dpgrw/ / n/ -/ dpshr/ 时/ ,/ TDEP/ 算法/ 肯定/ 结束/ ,/ 忽略/ 不等号/ ,/ 我们/ 取/ 利用/ 以上/ 的/ 分析/ 结果/ ,/ 当/ 收缩/ 阶段/ 结束/ 时/ ,/ TDEP/ 算法/ 维护/ 的/ 终结/ 元组/ 个数/ 为/ n/ ×/ dpshr/ (/ )/ nj/ =/ 1Hash/ 表/ HT/ 中/ 维护/ 的/ 记录/ 个数/ 为/ NUMshr/ =/ ∑/ m/ 我们/ 发现/ ,/ TDEP/ 算法/ 在/ 执行/ 期间/ 需要/ 维护/ 的/ 候选/ 元组/ 数量/ 和/ skyline/ 准则/ m/ 的/ 大小/ 成/ 指数/ 关系/ ,/ 和/ 元组/ 数量/ n/ 以及/ 结果/ 数量/ k/ 成/ 线性关系/ ./ 在/ 海量/ 数据/ 上/ 执行/ 时/ ,/ TDEP/ 算法/ 仍然/ 需要/ 维护/ 较/ 多/ 的/ 元组/ ./ 下面/ ,/ 我们/ 介绍/ 如何/ 执行/ 剪切/ 操作/ 来/ 减少/ 需要/ 维护/ 的/ 元组/ 数量/ ./ 5.2/ 剪切/ 思想/ 给定/ 终结/ 元组/ ti/ ,/ 我们/ 重新考虑/ 其/ 支配/ 分数/ 的/ 计/ TDEP/ 算法/ 所/ 维护/ 的/ 候选/ 元组/ 的/ 主要用途/ 为/ (/ 1/ )/ 维护/ 元组/ 位置/ 及/ 出现/ 信息/ 来/ 生成/ 终结/ 元组/ ./ (/ 2/ )/ 计算/ 终结/ 元组/ 的/ 准确/ 支配/ 分数/ ./ 根据/ 5.1/ 节/ 的/ 分析/ 结果/ ,/ 终结/ 元组/ 的/ 数量/ 占/ 所有/ 候选/ 元组/ 的/ 比例/ 较/ 低/ ,/ 如果/ 在/ 计算/ 终结/ 元组/ 分数/ 时/ 不/ 需要/ 维护/ 所有/ 的/ 候选/ 元组/ ,/ 那么/ 我们/ 就/ 可以/ 有效/ 减少/ TDEP/ 算法/ 维护/ 的/ 元组/ 数量/ ./ 算/ 公式/ (/ )/ domti/ =/ n/ -/ ∑/ m/ 表示/ 当/ 出现/ 终结/ 元组/ ti/ 时/ 位置/ 索引/ 出现/ j/ 次/ 的/ 候选/ 元组/ 的/ 数量/ (/ 不/ 考虑/ ti/ / pi/ )/ ./ 对于/ sum/ [/ 1/ ]/ 的/ 值/ 来说/ ,/ 我们/ 实际上/ 可以/ 通过/ 终结/ 元组/ 出现/ 的/ 位置/ 以及/ 其它/ 的/ sum/ [/ j/ ]/ (/ 2/ / j/ / m/ )/ 的/ 值/ 计算/ 获得/ ./ 给定/ 终结/ 元组/ ti/ 对应/ 的/ HT/ 记录/ 值/ (/ m/ ,/ positionti/ )/ ,/ sum/ [/ 1/ ]/ 的/ 值/ 计算/ 为/ sum/ [/ ]/ 1/ =/ ∑/ msum/ [/ j/ ]/ )/ ,/ 该值/ 可以/ 解释/ 如下/ :/ ∑/ m/ 表示/ L1/ [/ 1/ ,/ positionti/ [/ 1/ ]/ -/ 1/ ]/ ,/ L2/ [/ 1/ ,/ positionti/ [/ 2/ ]/ -/ j/ =/ 21/ ]/ ,/ …/ ,/ Lm/ [/ 1/ ,/ positionti/ [/ m/ ]/ -/ 1/ ]/ 出现/ 的/ 总/ 的/ 位置/ 索引/ 值/ 的/ 数量/ ,/ 其中/ 包括/ 出现/ 过/ 一次/ 和/ 多次/ 的/ 位置/ 索引/ ,/ ∑/ m/ 置/ 索引/ 值/ 在/ L1/ [/ 1/ ,/ positionti/ [/ 1/ ]/ -/ 1/ ]/ ,/ L2/ [/ 1/ ,/ positionti/ [/ 2/ ]/ -/ 1/ ]/ ,/ …/ ,/ Lm/ [/ 1/ ,/ positionti/ [/ m/ ]/ -/ 1/ ]/ 出现/ 的/ 总/ 次数/ ,/ 因此/ ,/ ∑/ msum/ [/ j/ ]/ )/ 的/ 结果/ 就是/ 我们/ 需要/ 的/ 出现/ 一次/ 的/ 位置/ 索引/ 的/ 数量/ ./ 所以/ ,/ 支配/ 分数/ 计算公式/ 可以/ 修改/ 为/ (/ )/ domti/ =/ n/ (/ -/ ∑/ msum/ [/ j/ )/ ]/ -/ 1/ ,/ 即/ TDEP/ 算法/ 不/ 需要/ 维护/ 在/ 其/ 执/ ∑/ mj/ =/ 2/ 行/ 期间/ 只/ 出现/ 一次/ 的/ 候选/ 元组/ ,/ 也/ 可以/ 计算/ 每个/ 终结/ 元组/ 的/ 支配/ 分数/ ./ j/ =/ 1/ 根据/ 以上/ 的/ 分析/ ,/ 早/ 剪切/ 规则/ 如下/ 所示/ ./ 早/ 剪切/ 规则/ ./ / t/ ∈/ T/ ,/ 如果/ t/ / pi/ 在/ 收缩/ 阶段/ 结束/ 前/ 只/ 出现/ 一次/ ,/ 那么/ TDEP/ 算法/ 不/ 需要/ 维护/ t/ / pi/ ./ 早/ 剪切/ 规则/ 的/ 直观/ 思想/ 在于/ ,/ 如果/ t/ / pi/ 在/ 收缩/ 阶段/ 结束/ 前/ 只/ 出现/ 一次/ ,/ 那么/ 计算/ 终结/ 元组/ 的/ 支配/ 分数/ 时/ ,/ 该/ 位置/ 索引/ 最/ 多/ 出现/ 一次/ ,/ 我们/ 有/ (/ 1/ )/ 在/ TDEP/ 算法/ 结束/ 时/ ,/ T/ (/ t/ / pi/ )/ 肯定/ 不是/ 终结/ 元组/ ./ (/ 2/ )/ 即使/ 不/ 维护/ 该/ t/ / pi/ ,/ TDEP/ 算法/ 也/ 可以/ 计算/ 终结/ 元组/ 的/ 支配/ 分数/ ./ / t/ ∈/ T/ ,/ 如果/ TDEP/ 算法/ 在/ round/ -/ robin/ 扫描/ 过程/ 读取/ 到/ 位置/ 索引/ t/ / pi/ =/ Lj/ (/ pos/ )/ ,/ 那么/ t/ / pi/ 被/ 剪切/ 的/ 概率/ 该/ 公式/ 解释/ 如下/ :/ TDEP/ 算法/ 要/ 剪切/ t/ / pi/ ,/ 就/ 要求/ 所有/ 1/ / j/ / m/ 且/ j/ ≠/ j/ ,/ t/ / pi/ / Lj1/ ,/ dp/ [/ ]/ shr/ ,/ 而/ t/ / pi/ / Lj1/ ,/ dp/ [/ ]/ shr/ 的/ 概率/ 是/ 1/ -/ dpshrn/ ,/ 因此/ 我们/ 得到/ Ppru/ 的/ 计算公式/ ./ 我们/ 注意/ 到/ ,/ 虽然/ 表/ T/ 的/ 维度/ M/ 可能/ 很大/ ,/ 但是/ 用户/ 每次/ 感兴趣/ 的/ 通常/ 是/ 其中/ 的/ 一小部分/ [/ 6/ ]/ ./ 在/ 实际/ 应用/ 中/ ,/ 决策人员/ 利用/ 的/ skyline/ 准则/ 一般/ 都/ 不大/ ,/ TDEP/ 算法/ 的/ 早/ 剪切/ 操作/ 可以/ 取得/ 较/ 好/ 的/ 剪切/ 效果/ ./ 例如/ ,/ 给定/ n/ =/ 109/ ,/ m/ =/ 3/ ,/ k/ =/ 10/ ,/ 早/ 剪切/ 的/ 剪切/ 比例/ 为/ 0.98/ ,/ 早/ 剪切/ 操作/ 可以/ 剪切/ 绝大多数/ 的/ 候选/ 元组/ ./ 5.3/ 实现/ 方法/ 虽然/ 实现/ 早/ 剪切/ 操作/ 并/ 不/ 容易/ ,/ TDEP/ 算法/ 利/ Page8/ 用/ 指数/ 间距/ bloomfilter/ 表来/ 有效/ 实现/ 这一/ 目标/ ,/ 快速/ 地/ 判断/ 给定/ 位置/ 索引/ 是否/ 在/ 某/ 有/ 序列表/ 的/ 指数/ 间距/ 位置/ 索引/ 范围/ 内/ ./ 定义/ 1/ (/ 指数/ 间距/ bloomfilter/ 表/ )/ ./ 给定/ 具有/ n/ 个/ 元素/ 的/ 有/ 序列表/ Lj/ ,/ EGBFTj/ 是/ Lj/ 上/ 的/ 指数/ 间距/ bloomfilter/ 表/ ,/ 如果/ 它/ 满足条件/ :/ (/ 1/ )/ |/ EGBFTj/ |/ =/ log2n/ ;/ (/ 2/ )/ EGBFTj/ (/ i/ )/ 表示/ 在/ Lj/ [/ 1/ ,/ 2i/ ]/ 的/ 元素/ 上/ 构建/ 的/ bloomfilter/ (/ 0/ / i/ / log2n/ )/ ./ 给定/ 有/ 序列表/ Lj/ ,/ EGBFTj/ 需要/ 的/ 空间/ 大小/ 取决于/ 元素/ 数量/ n/ 和/ 假/ 阳性率/ fpr/ ./ 利用/ a/ -/ bit/ 的/ 位/ 向量/ 和/ b/ 个/ 独立/ Hash/ 函数/ ,/ EGBFTj/ (/ i/ )/ 是/ 构建/ 在/ 2i/ 个/ 元素/ 上/ 的/ bloomfilter/ ./ 如果/ b/ =/ aln2/ 率/ fpr/ =/ (/ )/ 1/ 长度/ a/ =/ 2i/ ×/ log2/ (/ 1/ // fpr/ )/ // ln2/ [/ 12/ ]/ ./ 令/ SIZEEGBFTj/ 表示/ EGBFTj/ 的/ 大小/ ,/ 我们/ 有/ SIZEEGBFTj/ =/ ∑/ log2nlog2/ (/ 1/ // fpr/ )/ // ln2/ ./ 本文/ 设定/ fpr/ =/ 0.001/ ,/ SIZEEGBFTj/ 不到/ 有/ 序列表/ Lj/ 的/ 大小/ 的/ 45/ %/ ./ TDEP/ 算法/ 为/ 每个/ 有/ 序列表/ 都/ 构建/ 指数/ 间距/ bloomfilter/ 表/ ./ 利用/ 5.1/ 节/ 获得/ 的/ dpshr/ ,/ TDEP/ 算法/ 在/ 执行/ 之前/ 将/ EGBFT1/ (/ log2dpshr/ )/ ,/ …/ ,/ EGBFTm/ (/ log2dpshr/ )/ 载入/ 内存/ ./ 对于/ 当前/ 获得/ 的/ 位置/ 索引/ pi/ =/ Lj/ (/ pos/ )/ ,/ TDEP/ 算法/ 判断/ ,/ 如果/ pi/ 没有/ 包含/ 在/ 其它/ 全部/ m/ -/ 1/ 个/ 有/ 序列表/ 的/ 前/ 2log2dpshr/ 个/ 元组/ ,/ 则/ pi/ 被/ 早/ 剪切/ ,/ 否则/ pi/ 就/ 维护/ 在/ Hash/ 表/ HT/ 中/ ./ 这里/ ,/ 收缩/ 阶段/ 的/ 扫描/ 深度/ 被/ 扩展/ 到/ 其/ 最小/ 的/ 指数/ 间距/ 上/ 界/ ,/ 所以/ 估计/ 扫描/ 深度/ 的/ 概率/ 值/ 实际上/ 要/ 超过/ 其/ 原本/ 就/ 极/ 高/ 的/ 理论值/ (/ 0.999968/ )/ ./ 由于/ 收缩/ 阶段/ 的/ 扫描/ 深度/ 扩展/ 以及/ bloomfilter/ 的/ 内在/ 的/ 假/ 阳性/ 问题/ ,/ TDEP/ 算法/ 不能/ 保证/ 将/ 在/ 收缩/ 阶段/ 结束/ 前/ 只/ 出现/ 一次/ 的/ 候选/ 元组/ 全部/ 剪切/ ,/ 所以/ TDEP/ 算法/ 在/ 计算/ 终结/ 元组/ ti/ 的/ 支配/ 分数/ 时/ 的/ 实际/ 计算公式/ 如下/ :/ (/ )/ domti/ =/ n/ (/ -/ ∑/ m/ 理论/ 分析/ 和/ 实验/ 结果表明/ ,/ 早/ 剪切/ 方法/ 需要/ 的/ 额外/ 数据结构/ 的/ 大小/ 远/ 小于/ 减少/ 的/ 候选/ 信息/ 的/ 大小/ ,/ TDEP/ 算法/ 有效/ 减少/ 维护/ 信息/ 所/ 需要/ 的/ 费用/ ./ 当/ 数据/ 的/ 各/ 属性/ 不/ 满足/ 均匀/ 独立/ 分布/ 时/ ,/ 剪切/ 技术/ 的/ 实现/ 可以/ 采用/ 文献/ [/ 9/ ]/ 的/ 方法/ ./ 6/ 实验/ 评价/ 6.1/ 实验/ 设置/ 这/ 一部分/ 评价/ TDEP/ 算法/ 的/ 性能/ ./ 我们/ 利用/ Java/ 语言/ 实现/ TDEP/ 和/ DA/ 算法/ ,/ jdk/ 版本/ 为/ jdk/ -/ 7u21/ -/ windows/ -/ x64/ ,/ 实验/ 在/ LENOVOThinkCentreM8400T/ 上/ 执行/ (/ Intel/ (/ R/ )/ Core/ (/ TM/ )/ i7/ -/ 3770CPU/ @/ 3.40/ GHz/ (/ 8CPUs/ )/ +/ 32GB/ 内存/ +/ 64bitWindows7/ )/ ,/ 数据/ 存储/ 在/ SeagateExpansionST/ -/ BV3000300/ (/ 3TB/ )/ 磁盘/ ./ 其中/ ,/ DA/ 算法/ 根据/ 文献/ [/ 6/ ]/ 实现/ ,/ 同时/ 实现/ 其/ DR1/ -/ DR3/ 剪切/ 、/ EPR1/ -/ EPR6/ 剪切/ 和/ IPR1/ 剪切/ ./ 在/ 实验/ 执行/ 之前/ ,/ 我们/ 对/ 涉及/ 到/ 的/ 列/ 文件/ 执行/ 排序/ 操作/ ,/ 这/ 就/ 使得/ DA/ 算法/ 不/ 需要/ 构建/ 额外/ 的/ B/ +/ -/ 树来/ 读取/ 每个/ 有/ 序列/ 的/ 元组/ ./ 此外/ ,/ 实验/ 都/ 采用/ Hash/ 表来/ 维护/ DA/ 算法/ 和/ TDEP/ 算法/ 的/ 候选/ 元组/ ,/ 我们/ 发现/ Hash/ 表来/ 维护/ 候选/ 元组/ 的/ 性能/ 要/ 优于/ 文献/ [/ 6/ ]/ 中/ 采用/ 单独/ 的/ B/ +/ -/ 树来/ 维护/ 的/ 方法/ ./ 本文/ 选择/ DA/ 算法/ 进行/ 比较/ 的/ 原因/ 在于/ :/ (/ 1/ )/ DA/ 算法/ 和/ TDEP/ 算法/ 都/ 是/ 基于/ 有/ 序列/ 文件/ 的/ 算法/ ./ (/ 2/ )/ 现有/ 的/ top/ -/ kdominating/ 算法/ ,/ 例如/ CBT/ [/ 4/ ]/ 需要/ 构建/ 辅助/ 的/ R/ -/ tree/ 结构/ ,/ FNP/ 算法/ [/ 5/ ]/ 需要/ 对/ 数据文件/ 执行/ 3/ 轮/ 扫描/ 来/ 处理/ top/ -/ kdominating/ 查询/ ,/ 而/ 在/ 文献/ [/ 6/ ]/ 中/ ,/ 这些/ 算法/ 都/ 和/ DA/ 算法/ 进行/ 了/ 比较/ ,/ DA/ 算法/ 的/ 性能/ 优于/ 现有/ 其它/ 算法/ ./ 因此/ ,/ 实验/ 部分/ 和/ DA/ 算法/ 进行/ 比较/ 足够/ 评价/ TDEP/ 算法/ 的/ 性能/ ./ 实验/ 部分/ 从/ 如下/ 几个/ 方面/ 来/ 评价/ TDEP/ 算法/ :/ 元组/ 数量/ (/ n/ )/ 、/ 结果/ 数量/ (/ k/ )/ 和/ skyline/ 准则/ 大小/ (/ m/ )/ ,/ 实验/ 参数/ 的/ 设置/ 如表/ 2/ 所示/ ./ 实验/ 考虑/ 的/ 元组/ 数量/ 分别/ 为/ 1/ ×/ 109/ ,/ 2/ ×/ 109/ ,/ 3/ ×/ 109/ ,/ 4/ ×/ 109/ 和/ 5/ ×/ 109/ ,/ 默认值/ 为/ 1/ ×/ 109/ ;/ 考虑/ 的/ 返回/ 结果/ 数量/ 分别/ 为/ 10/ ,/ 20/ ,/ 30/ ,/ 40/ 和/ 50/ ,/ 默认值/ 为/ 10/ ;/ 考虑/ 的/ skyline/ 准则/ 大小/ 为/ 2/ ,/ 3/ 和/ 4/ ,/ 默认值/ 为/ 3/ ./ Tuplenumber/ (/ 109/ )/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5Skylinecriteriasize2/ ,/ 3/ ,/ 4/ 需要/ 的/ 数据结构/ 在/ 实验/ 之前/ 预/ 构建/ 获得/ ,/ 涉及/ 到/ 的/ 列/ 文件/ 均匀/ 独立/ 分布/ ./ 这里/ 简单/ 介绍/ 预/ 构建/ 的/ 执行/ 结果/ ./ 对于/ 元组/ 数量/ 为/ 1/ ×/ 109/ 的/ 列/ 文件/ ,/ 排序/ 时间/ 为/ 2217.705/ s/ ,/ 生成/ EGBFT/ 结构/ 的/ 时间/ 为/ 622.824/ s/ ./ Page96/ ./ 2/ 实验/ 1/ :/ 元组/ 数量/ 的/ 效果/ 给定/ k/ =/ 10/ 和/ m/ =/ 3/ ,/ 实验/ 1/ 评价/ 当/ 元组/ 数量/ (/ n/ )/ 变化/ 时/ TDEP/ 算法/ 的/ 性能/ ./ 如图/ 3/ (/ a/ )/ 所示/ ,/ TDEP/ 算法/ 的/ 执行/ 速度/ 比/ DA/ 算法/ 快/ 41.14/ 倍/ ,/ 这/ 充分说明/ 在/ 海量/ 数据/ 上/ TDEP/ 算法/ 比/ DA/ 算法/ 的/ 性能/ 优势/ ./ 图/ 3/ (/ b/ )/ 给出/ 了/ TDEP/ 算法/ 的/ 执行/ 时间/ 分解/ ,/ 我们/ 看到/ 增长/ 阶段/ 和/ 收缩/ 阶段/ 的/ 执行/ 时间/ 基本/ 类似/ ./ 图/ 3/ (/ c/ )/ 给出/ TDEP/ 算法/ 和/ DA/ 算法/ 的/ 扫描/ 深度/ ,/ 其中/ 对于/ TDEP/ 算法/ 分别/ 提供/ 了/ 增长/ 阶段/ 深度/ 、/ 收缩/ 阶段/ 深度/ 和/ 估计/ 的/ 增长/ 阶段/ 深度/ ./ 我们/ 发现/ ,/ TDEP/ 算法/ 和/ DA/ 算法/ 结束/ 时/ 的/ 扫描/ 深度/ 很/ 接近/ ,/ 同时/ 估计/ 的/ 增长/ 阶段/ 深度/ 大于/ 实际/ 的/ 增长/ 阶段/ 深度/ ,/ 从而/ 证明/ 了/ 本文/ 的/ 分析/ ./ 图/ 3/ (/ d/ )/ 比较/ TDEP/ 算法/ 和/ DA/ 算法/ 读取/ 的/ 元组/ 数量/ ,/ 可以/ 看到/ TDEP/ 算法/ 需要/ 读取/ 的/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 12.39/ 倍/ ,/ 其/ 原因/ 在于/ ,/ 不同于/ DA/ 算法/ ,/ TDEP/ 算法/ 计算/ 准确/ 图/ 3/ 元组/ 数量/ 的/ 效果/ 支配/ 分数/ 时/ 不/ 需要/ 重新/ 读取/ 有/ 序列表/ 的/ 元组/ ./ 图/ 3/ (/ e/ )/ 给出/ 了/ TDEP/ 算法/ 和/ DA/ 算法/ 维护/ 的/ 候选/ 元组/ 数量/ ,/ 我们/ 看到/ TDEP/ 算法/ 维护/ 的/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 39.89/ 倍/ ./ 如图/ 3/ (/ f/ )/ 所示/ ,/ 早/ 剪切/ 操作/ 可以/ 剪切/ 至少/ 96/ %/ 的/ 候选/ 元组/ ./ 我们/ 看到/ ,/ 实际/ 的/ 剪切/ 比例/ 要/ 小于/ 估计/ 的/ 剪切/ 比例/ ,/ 这/ 是因为/ :/ (/ 1/ )/ 为/ 保证/ 结果/ 的/ 正确性/ ,/ TDEP/ 算法/ 总是/ 保守/ 地/ 估计/ 扫描/ 深度/ ;/ (/ 2/ )/ 在/ 进行/ 实际/ 剪切/ 操作/ 时/ ,/ 指数/ 间距/ bloomfilter/ 表将/ 收缩/ 阶段/ 的/ 扫描/ 深度/ 扩展/ 到/ 最小/ 的/ 指数/ 间距/ 上/ 界/ ;/ (/ 3/ )/ bloomfilter/ 内在/ 的/ 假/ 阳性/ ./ 总的来看/ ,/ 随着/ 元组/ 数量/ 的/ 增大/ ,/ 早/ 剪切/ 的/ 比例/ 也/ 随之/ 增大/ ./ 这里/ 在/ n/ =/ 2/ ×/ 109/ 时/ ,/ 早/ 剪切/ 比例/ 比较突出/ ,/ 其/ 原因/ 在于/ ,/ 虽然/ 此时/ 收缩/ 阶段/ 的/ 深度/ 增加/ 了/ ,/ 但是/ TDEP/ 算法/ 载入/ 的/ bloomfilter/ 的/ 范围/ 仍然/ 和/ n/ =/ 1/ ×/ 109/ 的/ 一样/ (/ 224/ )/ ,/ 而/ 当/ 元组/ 数量/ 继续/ 增加/ 到/ n/ =/ 3/ ×/ 109/ ,/ TDEP/ 算法/ 载入/ 的/ bloomfilter/ 的/ 范围/ 就/ 增大/ 到/ 225/ ./ Page106/ ./ 3/ 实验/ 2/ :/ 返回/ 结果/ 数量/ 的/ 效果/ 给定/ n/ =/ 109/ 和/ m/ =/ 3/ ,/ 实验/ 2/ 评价/ 当/ 结果/ 数量/ (/ k/ )/ 变化/ 时/ TDEP/ 算法/ 的/ 性能/ ./ 如图/ 4/ (/ a/ )/ 所示/ ,/ TDEP/ 算法/ 的/ 执行/ 比/ DA/ 算法/ 平均/ 快/ 93.73/ 倍/ ,/ 并且/ 加速/ 比/ 随着/ k/ 值/ 的/ 增大/ 而/ 增大/ ,/ 当/ k/ =/ 10/ 时/ ,/ 加速/ 比为/ 32.52/ ,/ 而/ 当/ k/ =/ 50/ 时/ ,/ 加速/ 比则/ 提高/ 到/ 152.86/ ,/ 这/ 在/ 图/ 4/ (/ d/ )/ 中/ 可以/ 得到/ 解释/ ./ 图/ 4/ (/ b/ )/ 给出/ 了/ TDEP/ 算法/ 的/ 时间/ 分解/ ./ 如图/ 4/ (/ c/ )/ 所示/ ,/ 我们/ 发现/ DA/ 算法/ 和/ TDEP/ 算法/ 的/ 扫描/ 深度/ 随着/ k/ 值/ 的/ 增大/ 而/ 线性/ 增长/ ,/ 实际/ 的/ 增长/ 阶段/ 深度/ 小于/ 估计/ 的/ 增长/ 阶段/ 深度/ ./ 如图/ 4/ (/ d/ )/ 所示/ ,/ TDEP/ 算法/ 读取/ 的/ 元/ 图/ 4/ 结果/ 数量/ 的/ 效果/ 6.4/ 实验/ 3/ :/ skyline/ 准则/ 大小/ 的/ 效果/ 给定/ n/ =/ 109/ 和/ k/ =/ 10/ ,/ 实验/ 3/ 评价/ 当/ skyline/ 准则/ 大小/ (/ m/ )/ 变化/ 时/ TDEP/ 算法/ 的/ 性能/ ./ 如图/ 5/ (/ a/ )/ 所示/ ,/ 随着/ 涉及/ 到/ 的/ skyline/ 准则/ 的/ 增大/ ,/ TDEP/ 算法/ 和/ DA/ 算法/ 的/ 执行/ 时间/ 都/ 迅速/ 增加/ ,/ TDEP/ 算法/ 的/ 执行/ 时间/ 比/ DA/ 算法/ 平均/ 少/ 31.94/ 倍/ ./ 图/ 5/ (/ b/ )/ 显示/ 组/ 数量/ 平均/ 比/ DA/ 算法/ 少/ 39.77/ 倍/ ,/ 并且/ 随着/ k/ 值/ 的/ 增大/ ,/ DA/ 算法/ 读取/ 的/ 元组/ 数量/ 和/ TDEP/ 算法/ 读取/ 的/ 数量/ 的/ 比值/ 也/ 在/ 增大/ ,/ 这是/ 由于/ DA/ 算法/ 需要/ 重新/ 扫描/ 有/ 序列/ 文件/ 来/ 计算/ 准确/ 支配/ 分数/ ,/ 所以/ 它/ 读取/ 的/ 元组/ 数量/ 随着/ 返回/ 结果/ 数量/ 增加/ 而/ 增长幅度/ 较大/ ,/ 而/ TDEP/ 算法/ 需要/ 读取/ 的/ 元组/ 数量/ 则/ 只/ 和/ 扫描/ 深度/ 相关/ ,/ 其/ 增长速度/ 较/ 缓慢/ ./ 如图/ 4/ (/ e/ )/ 所示/ ,/ TDEP/ 算法/ 维护/ 的/ 候选/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 29.5/ 倍/ ./ 如图/ 4/ (/ f/ )/ 所示/ ,/ 虽然/ 理论/ 剪切/ 比例/ 在/ k/ 值/ 变化/ 时/ 逐渐/ 减小/ ,/ 但是/ TDEP/ 算法/ 的/ 早/ 剪切/ 比例/ 基本/ 保持/ 在/ 96/ %/ ./ 在/ m/ 值/ 较大/ 时/ ,/ 收缩/ 阶段/ 的/ 执行/ 时间/ 逐渐/ 大于/ 增长/ 阶段/ 的/ 时间/ ,/ 这是/ 由于/ 此时/ TDEP/ 算法/ 的/ 收缩/ 阶段/ 获得/ 较/ 多/ 的/ 终结/ 元组/ ,/ 从而/ 需要/ 较/ 多/ 的/ 计算/ 其/ 准确/ 支配/ 分数/ 的/ 费用/ ./ 图/ 5/ (/ c/ )/ 给出/ 算法/ 的/ 扫描/ 深度/ ,/ 可以/ 看到/ 随着/ m/ 值/ 的/ 增大/ ,/ DA/ 算法/ 和/ TDEP/ 算法/ 的/ 扫描/ 深度/ 呈/ 指数/ 增长/ 趋势/ ./ 如图/ 5/ (/ d/ )/ 所示/ ,/ TDEPPage11/ 算法/ 需要/ 读取/ 的/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 24.07/ 倍/ ,/ 并且/ 随着/ m/ 值/ 的/ 增大/ ,/ 两种/ 算法/ 需要/ 读取/ 的/ 元组/ 数量/ 的/ 比值/ 越来越/ 大/ ,/ 这是/ DA/ 算法/ 计算/ 准确/ 支配/ 分数/ 的/ 方式/ 和/ 较/ 多/ 的/ 终结/ 元组/ 引起/ 的/ ./ 如图/ 5/ (/ e/ )/ 所示/ ,/ TDEP/ 算法/ 维护/ 的/ 候选/ 元组/ 数量/ 比/ DA/ 算法/ 少图/ 5skyline/ 准则/ 大小/ 的/ 效果/ 6.5/ 实验/ 4/ :/ 真实/ 数据/ 实验/ 4/ 使用/ 的/ 真实/ 数据/ 来自/ 某/ 通信/ 公司/ 的/ 通讯/ 记录/ ,/ 该/ 通话记录/ 被/ 划分/ 为/ 多个/ 分片/ ,/ 每个/ 分片/ 包括/ 107/ 条/ 元组/ ,/ 每条/ 元组/ 包括/ 72/ 个/ 属性/ ,/ 我们/ 选择/ 其中/ 方差/ 最大/ 的/ 3/ 个/ 属性/ 作为/ skyline/ 准则/ ./ 给定/ m/ =/ 3/ 和/ k/ =/ 10/ ,/ 实验/ 4/ 选择/ 5/ 个/ 分片/ 的/ 数据/ 来/ 评价/ TDEP/ 算法/ ./ 如图/ 6/ (/ a/ )/ 所示/ ,/ TDEP/ 算法/ 的/ 执行/ 时间/ 比/ DA/ 算法/ 快/ 13.71/ 倍/ ./ 由于/ 真实/ 数据/ 的/ 数据量/ 较/ 小/ ,/ 则/ 增长/ 阶段/ 和/ 收缩/ 阶段/ 的/ 执行/ 时间/ 相对/ 较/ 少/ ,/ 如图/ 6/ (/ b/ )/ 所示/ ,/ 相对/ 地/ ,/ 载入/ bloomfilter/ 的/ 时间/ 占/ 执行/ 时间/ 的/ 比例/ 较大/ ./ 图/ 6/ (/ c/ )/ 给出/ 了/ 算法/ 的/ 扫描/ 深度/ ,/ 如图所示/ ,/ 在/ 真实/ 数据/ 上/ ,/ TDEP/ 算法/ 估计/ 的/ 171.04/ 倍/ ,/ 并且/ 两者/ 的/ 比值/ 随着/ m/ 值/ 的/ 增大/ 而/ 减小/ ,/ 这/ 可以/ 从图/ 5/ (/ f/ )/ 中/ 得到/ 解释/ ./ 随着/ m/ 值/ 的/ 增大/ ,/ TDEP/ 算法/ 的/ 早/ 剪切/ 比例/ 下降/ 的/ 幅度/ 较大/ ,/ 从/ m/ =/ 2/ 时/ 的/ 0.997/ 下降/ 到/ m/ =/ 4/ 的/ 0.789/ ,/ 这/ 也/ 符合/ 本文/ 对/ 早/ 剪切/ 操作/ 的/ 数学分析/ ./ 增长/ 阶段/ 的/ 深度/ 接近/ 于/ 其/ 实际/ 的/ 收缩/ 阶段/ 的/ 深度/ ,/ 并且/ 在/ n/ =/ 2/ ×/ 107/ ,/ 3/ ×/ 107/ ,/ 3/ ×/ 107/ 估计/ 的/ 增长/ 阶段/ 深度/ 超过/ 了/ 实际/ 的/ 收缩/ 阶段/ 的/ 深度/ ./ 如图/ 6/ (/ d/ )/ 所示/ ,/ TDEP/ 算法/ 读取/ 的/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 14.18/ 倍/ ./ 同时/ ,/ 根据/ 图/ 6/ (/ e/ )/ ,/ TDEP/ 算法/ 维护/ 的/ 候选/ 元组/ 数量/ 比/ DA/ 算法/ 少/ 23.41/ 倍/ ./ 图/ 6/ (/ f/ )/ 给出/ 了/ 早/ 剪切/ 操作/ 的/ 剪切/ 效果/ ,/ 我们/ 发现/ 在/ 实际/ 数据/ 上/ ,/ TDEP/ 算法/ 的/ 剪切/ 效果/ 不/ 低于/ 86/ %/ ,/ 并且/ 在/ n/ =/ 2/ ×/ 107/ ,/ 3/ ×/ 107/ ,/ 3/ ×/ 107/ 时/ ,/ 实际/ 剪切/ 效果/ 要/ 优于/ 理论/ 剪切/ 效果/ ,/ 这是/ 实际/ 的/ 数据分布/ 以及/ 早/ 剪切/ 操作/ 共同/ 作用/ 的/ 结果/ ./ Page12/ 图/ 6/ 真实/ 数据/ 的/ 效果/ 7/ 相关/ 工作/ Top/ -/ kdominating/ 查询/ 结合/ 了/ top/ -/ k/ 查询/ 和/ skyline/ 查询/ 的/ 优点/ ,/ 从而/ 越来越/ 得到/ 研究/ 人员/ 的/ 关注/ ./ Papadias/ 等/ 人/ [/ 3/ ]/ 首先/ 引进/ top/ -/ kdominating/ 查询/ 的/ 思想/ 来/ 扩展/ skyline/ 查询/ ,/ 并/ 提出/ K/ -/ domina/ -/ ting/ _/ BBS/ 算法/ 来/ 处理/ 该/ 查询/ ./ K/ -/ dominating/ _/ BBS/ 查询/ 首先/ 利用/ BBS/ 算法/ 计算/ 数据/ 集/ 的/ skyline/ 结果/ SKY/ ,/ 同时/ 计算/ 每个/ skyline/ 点/ 的/ 支配/ 分数/ ,/ 在/ SKY/ 中/ 移除/ 并/ 返回/ 其中/ 支配/ 分数/ 最大/ 的/ skyline/ 点/ p1/ 作为/ top/ -/ kdominating/ 查询/ 的/ 一个/ 结果/ ./ 接下来/ ,/ K/ -/ dominating/ _/ BBS/ 在/ p1/ 的/ 支配/ 区域/ 中/ 计算/ 局部/ skyline/ 结果/ SKY/ 及其/ 每个/ 点/ 的/ 支配/ 分数/ ,/ 在/ SKY/ -/ p/ (/ )/ 1/ ∪/ SKY/ 中/ 移除/ 并/ 返回/ 其中/ 支配/ 分数/ 最大/ 的/ 点/ p2/ ,/ 该/ 过程/ 迭代/ 执行/ ,/ 直到/ 返回/ k/ 个/ 结果/ ./ Yiu/ 等/ 人/ [/ 4/ ]/ 提出/ 基于/ aR/ -/ tree/ (/ aggregateR/ -/ tree/ )/ 的/ CBT/ 算法/ 来/ 有效/ 处理/ top/ -/ kdominating/ 查询/ ./ CBT/ 算法/ 从根/ 开始/ 遍历/ aR/ -/ tree/ ,/ 在/ 集合/ S/ 中/ 维护/ 其子/ 节点/ ,/ 同时/ 计算/ 对应/ 的/ 支配/ 分数/ 上界/ 和/ 下界/ ./ 接下来/ ,/ CBT/ 算法/ 选择/ 集合/ S/ 中/ 的/ 优先级/ 最大/ 的/ 一个/ 元素/ 来/ 扩展/ 集合/ S/ ,/ 即/ 移除/ 该/ 元素/ ,/ 插入/ 其子/ 节点/ ,/ 计算/ 对应/ 的/ 支配/ 分数/ 上界/ 和/ 下界/ ,/ 并/ 更新/ 集合/ S/ 中/ 其它/ 元素/ 的/ 支配/ 分数/ 上界/ 和/ 下界/ ,/ 剪切/ S/ 中/ 无用/ 的/ 并/ 不/ 可能/ 包括/ 最终/ 结果/ 的/ 元素/ ,/ 并且/ 在/ 最小/ 堆/ W/ 中/ 维护/ 集合/ S/ 中/ 支配/ 下界/ 最高/ 的/ k/ 个/ 元素/ ./ 该/ 过程/ 一直/ 进行/ 直到/ 集合/ S/ 中/ 不/ 包括/ 非/ 叶子/ 节点/ ,/ 此时/ ,/ 最小/ 堆/ W/ 中/ 维护/ 的/ 就是/ 要求/ 的/ 结果/ ./ Yiu/ 等/ 人/ [/ 5/ ]/ 提出/ FNP/ 算法/ 在/ 非/ 索引/ 数据/ 上/ 处理/ top/ -/ kdominating/ 查询/ ,/ 该/ 算法/ 的/ 执行/ 需要/ 对/ 数据/ 集/ 执行/ 3/ 轮/ 扫描/ :/ counterpass/ 、/ filterpass/ 和/ refinementpass/ ./ Counterpass/ 在/ 内存/ 维护/ 网格/ 文件/ 来/ 记录/ 落入/ 每个/ 单元/ 的/ 点/ 的/ 数量/ ,/ 从而/ 方便/ 接下来/ 的/ 操作/ 中/ 计算/ 支配/ 分数/ 的/ 上界/ 和/ 下界/ ./ Filterpass/ 在/ 扫描/ 的/ 同时/ ,/ 利用/ 网格/ 单元/ 的/ 支配/ 分数/ 的/ 上界/ 和/ 下界/ 以及/ 其/ 之间/ 的/ 支配/ 关系/ 来/ 剪切/ 那些/ 不/ 符合要求/ Page13/ 的/ 点/ ,/ 未/ 剪切/ 的/ 点/ 在/ 查询/ 的/ 候选/ 结果/ 集合/ 中/ 存储/ ./ Refinementpass/ 则/ 通过/ 一轮/ 扫描/ 操作/ 来/ 计算/ 候选/ 结果/ 集合/ 中/ 元素/ 的/ 支配/ 分数/ ,/ 最终/ 获得/ top/ -/ kdominating/ 查询/ 的/ 结果/ ./ Tiakas/ 等/ 人/ [/ 6/ ]/ 提出/ 一组/ 算法/ (/ BSA/ 、/ UA/ 、/ RA/ 和/ TA/ )/ 在/ 垂直/ 划分/ 的/ 有/ 序列/ 文件/ 上/ 渐进/ 地/ 处理/ sub/ -/ spacetop/ -/ kdominating/ 查询/ ./ 这组/ 算法/ 采用/ round/ -/ robin/ 方式/ 扫描/ 涉及/ 到/ 的/ 有/ 序列/ 文件/ ,/ 维护/ 获得/ 的/ 候选/ 元组/ 及其/ 出现/ 次数/ ./ 最大/ 堆/ HP/ 维护/ 获得/ 的/ 终结/ 元组/ ,/ 即/ 所/ 需要/ 的/ 属性/ 在/ 列/ 文件/ 中/ 都/ 已经/ 获得/ 的/ 候选/ 元组/ ./ 对于/ 每次/ 获得/ 新/ 的/ 终结/ 元组/ ,/ 算法/ 计算/ 其/ 支配/ 分数/ (/ 估计值/ )/ ,/ 然后/ 插入/ HP/ ,/ 选择/ 并/ 移除/ HP/ 中/ 当前/ 支配/ 分数/ 最大/ 的/ 终结/ 元组/ t1/ ,/ 如果/ t1/ 的/ 支配/ 值/ 是/ 估计值/ ,/ 则/ 计算/ 其/ 精确/ 支配/ 分数/ ,/ 然后/ 选择/ HP/ 中/ 当前/ 支配/ 分数/ 最大/ 的/ 终结/ 元组/ t2/ ./ 如果/ t1/ 的/ 支配/ 分数/ 小于/ t2/ 的/ 支配/ 分数/ ,/ 则/ 将/ t1/ 重新/ 插入/ 到/ HP/ 中/ ,/ 否则/ 直接/ 输出/ t1/ 为/ 一个/ top/ -/ kdominating/ 查询/ 结果/ ./ 该/ 过程/ 不断/ 执行/ ,/ 直到/ 输出/ k/ 个/ 结果/ 为止/ ./ BSA/ 、/ UA/ 、/ RA/ 和/ DA/ 算法/ 的/ 区别/ 在于/ ,/ 它们/ 计算/ 终结/ 元组/ t1/ 的/ 精确/ 支配/ 分数/ 的/ 方法/ 不同/ ,/ DA/ 算法/ 的/ 性能/ 超过/ 其它/ 3/ 个/ 算法/ ./ DA/ 算法/ 维护/ 一个/ 之前/ 已经/ 计算/ 准确/ 支配/ 分数/ 的/ 终结/ 元组/ tp/ 在/ 列/ 文件/ 中/ 的/ 出现/ 位置/ ,/ 在/ 计算/ 下/ 一个/ 终结/ 元组/ t1/ 的/ 精确/ 支配/ 分数/ 时/ ,/ 根据/ t1/ 在/ 列/ 文件/ 中/ 的/ 位置/ 以及/ tp/ 的/ 位置/ 关系/ ,/ 对列/ 文件/ 执行/ 前/ 向/ 和/ 后/ 向/ 扫描/ 来/ 计算/ 其/ 准确/ 支配/ 分数/ ./ 在/ 其它/ 的/ 领域/ ,/ top/ -/ kdominating/ 查询/ 也/ 得到/ 较为/ 广泛/ 的/ 应用/ ./ Lian/ 等/ 人/ [/ 13/ ]/ 考虑/ 如何/ 在/ 不/ 确定/ 数据库/ 上/ 执行/ 概率/ top/ -/ kdominating/ 查询/ (/ PTD/ )/ ,/ 即/ 在/ 不/ 确定/ 数据库/ 中/ 返回/ 期望/ 动态/ 支配/ 最多/ 不/ 确定/ 元组/ 的/ k/ 个/ 不/ 确定/ 元组/ ./ 文献/ [/ 13/ ]/ 利用/ aR/ -/ tree/ 来/ 有效/ 处理/ PTD/ 查询/ ,/ 提出/ 有效/ 的/ 剪切/ 方法/ 来/ 剪切/ PTD/ 查询/ 的/ 搜索/ 空间/ ./ Skoutas/ 等/ 人/ [/ 14/ ]/ 提出/ 如何/ 搜索/ 基于/ 多/ 准则/ 匹配/ 下/ 的/ top/ -/ kdominatingweb/ 服务/ ,/ 并且/ 提出/ 3/ 种/ 支配/ 分数/ 的/ 定义/ 来/ 评价/ 匹配/ 结果/ :/ dominatedscore/ 、/ dominatingscore/ 和/ dominancescore/ ./ 对于/ 每/ 一种/ 支配/ 分数/ ,/ 文献/ [/ 14/ ]/ 提出/ 有效/ 算法/ 来/ 获得/ top/ -/ kdominantweb/ 服务/ ./ Zhang/ 等/ 人/ [/ 15/ ]/ 定义/ 概率/ 阈值/ top/ -/ kdominating/ 查询/ ,/ 给定/ 概率/ 阈值/ q/ ,/ 该/ 查询/ 在/ 不/ 确定/ 数据库/ 中/ 返回/ 支配/ 其它/ 对象/ 数量/ 最多/ 的/ k/ 个/ 对象/ ./ 通过/ 应用/ 大数/ 定理/ 及其/ 数学/ 特点/ ,/ 文献/ [/ 15/ ]/ 提出/ 一种/ 有效/ 的/ 剪切/ 技术/ 来/ 加速/ 精确/ 算法/ 的/ 执行/ ,/ 还/ 提出/ 一个/ 随机/ 算法/ 来/ 协调/ 执行/ 效率/ 和/ 查询/ 准确度/ ,/ 利用/ gCaR/ -/ tree/ 来/ 返回/ 满足/ 任意/ 精度/ 的/ 近似/ 结果/ ./ Kontaki/ 等/ 人/ [/ 16/ ]/ 提出/ 数据流/ 上/ 的/ 连续/ top/ -/ kdominating/ 查询/ 问题/ ,/ 提出/ 的/ 精确/ 算法/ 利用/ 事件/ 调度/ 技术/ 来/ 有效/ 避免/ 昂贵/ 的/ 支配/ 分数/ 计算/ 费用/ ,/ 提出/ 两个/ 近似算法/ ,/ 以/ 快得多/ 的/ 相应/ 时间/ 返回/ 满足/ 给定/ 概率/ 保证/ 的/ 结果/ ./ 8/ 结论/ 本文/ 考虑/ 在/ 海量/ 数据/ 上/ 执行/ 基于/ 任意/ skyline/ 准则/ 的/ top/ -/ kdominating/ 查询/ 的/ 问题/ ,/ 本文/ 的/ 分析/ 发现/ 现有/ 方法/ 无法/ 有效/ 处理/ 该/ 类型/ 的/ 查询/ ./ 本文/ 提出/ 一种/ 新/ 的/ top/ -/ kdominating/ 查询/ 算法/ TDEP/ ,/ 该/ 算法/ 利用/ 为/ 每个/ 属性/ 构建/ 的/ 有/ 序列表/ ,/ 可以/ 有效/ 减少/ 查询/ 涉及/ 到/ 的/ I/ // O/ 费用/ 和/ 内存/ 费用/ ,/ 从而/ 有效/ 返回/ 查询/ 结果/ ./ TDEP/ 算法/ 的/ 执行/ 分为/ 两个/ 阶段/ :/ 增长/ 阶段/ 和/ 收缩/ 阶段/ ./ 增长/ 阶段/ 对/ 有/ 序列表/ 执行/ round/ -/ robin/ 扫描/ 操作/ ,/ 直到/ 获得/ k/ 个/ 终结/ 元组/ ,/ 而/ 收缩/ 阶段/ 则/ 继续/ 对/ 有/ 序列表/ 进行/ 扫描/ ,/ 直到/ 满足/ 结束/ 条件/ ./ 本文/ 提出/ 一种/ 有效/ 的/ 支配/ 分数/ 计算方法/ ,/ 只/ 需要/ 利用/ 已/ 获得/ 的/ 元组/ 信息/ 就/ 可以/ 获得/ 结果/ ./ 本文/ 提供/ 了/ TDEP/ 算法/ 在/ 两个/ 阶段/ 执行/ 行为/ 的/ 理论/ 分析/ ,/ 并/ 提出/ 有效/ 的/ 早/ 剪切/ 策略/ 来/ 减少/ 其/ 执行/ 期间/ 维护/ 的/ 候选/ 元组/ ,/ 从而/ 提高/ 执行/ 效率/ ./ 本文/ 提供/ 的/ 较/ 全面/ 的/ 实验/ 结果表明/ ,/ TDEP/ 算法/ 和/ 现有/ 算法/ 相比/ 具有/ 较大/ 的/ 性能/ 优势/ ./ 

