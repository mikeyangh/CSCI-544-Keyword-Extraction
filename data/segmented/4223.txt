Page1/ 基于/ 样本/ 的/ 大规模/ 人群/ 快速/ 创作/ 申/ 晶晶/ 王欣捷/ / 倩/ 文金小刚/ (/ 浙江大学/ CAD/ &/ CG/ 国家/ 重点/ 实验室/ 杭州/ 310058/ )/ 摘要/ 人群/ 作为/ 虚拟环境/ 中/ 必不可少/ 的/ 一部分/ ,/ 能够/ 极大地提高/ 场景/ 的/ 真实感/ ./ 文中/ 提出/ 一种/ 基于/ 样本/ 的/ 大规模/ 人群/ 快速/ 创作方法/ ,/ 将/ 人/ 视为/ 具有/ 分布/ 和/ 角色/ 信息/ 的/ 粒子/ ,/ 通过/ 从/ 真实/ 图片/ 中/ 获取/ 包含/ 小规模/ 人群/ 粒子/ 信息/ 的/ 样本/ ,/ 由/ 样本/ 建立/ WangTile/ 集合/ ,/ 使用/ WangTile/ 非周期性/ 拼接/ 覆盖/ 场景/ 区域/ ,/ 从而/ 快速/ 生成/ 任意/ 规模/ 人群/ ./ 文中/ 的/ 创作方法/ 简单/ 快速/ ,/ 用户/ 只/ 需/ 输入/ 若干/ 样本/ 和/ 场景/ 区域/ ./ 同时/ ,/ 用户/ 可以/ 通过/ 调整/ Tile/ 的/ 边/ 颜色/ 快速/ 地/ 进行/ 局部/ 人群/ 修改/ ,/ 也/ 可以/ 使用/ 密度/ 图/ 得到/ 用户/ 需要/ 的/ 效果/ ./ 实验/ 给出/ 了/ 3/ 个/ 场景/ 的/ 人群/ 创作/ 效果/ ,/ 表明/ 文中/ 的/ 方法/ 可以/ 十分迅速/ 地/ 生成/ 大规模/ 具有/ 真实/ 分布/ 信息/ 的/ 多样/ 人群/ ./ 关键词/ 人群/ 创作/ ;/ WangTile/ ;/ 虚拟/ 场景/ 1/ 引言/ 在/ 虚拟环境/ 中/ 创作/ 和/ 模拟/ 人群/ ,/ 能够/ 极大地提高/ 场景/ 的/ 真实感/ 和/ 沉浸/ 感/ ,/ 已/ 被/ 广泛应用/ 于/ 许多/ 领域/ ,/ 如/ 娱乐/ 、/ 广告/ 、/ 建筑/ 、/ 教育/ 、/ 游戏/ 及/ 公共安全/ 辅助设计/ 等/ ./ 近年来/ ,/ 随着/ 计算机硬件/ 的/ 不断/ 发展/ ,/ 所/ 能/ 交互/ 模拟/ 虚拟环境/ 的/ 规模/ 也/ 越来越/ 大/ ,/ 相应/ 的/ 人群/ 规模/ 也/ 随之/ 增加/ ./ 现有/ 群组/ 研究/ 主要/ 关注/ 人群/ 的/ 运动/ 行为/ 控制/ 和/ 实时/ 绘制/ ,/ 而/ 对于/ 如何/ 在/ 虚拟环境/ 中/ Page2/ 进行/ 初始/ 人群/ 的/ 创作/ ,/ 则/ 很少/ 有/ 涉及/ ./ 对于/ 大规模/ 场景/ 及/ 人群/ 模拟/ 来说/ ,/ 如何/ 快速/ 高效/ 地/ 完成/ 人群/ 的/ 初始/ 分布/ 及/ 状态/ 设置/ ,/ 并/ 使/ 其/ 具有/ 多样性/ 和/ 真实性/ ,/ 是/ 一个/ 急需解决/ 的/ 问题/ ./ 对于/ 成千上万/ 的/ 人群/ ,/ 如果/ 需要/ 对/ 每个/ 人物/ 角色/ 进行/ 位置/ 、/ 朝向/ 等/ 模拟/ 相关/ 属性/ 进行/ 设置/ 和/ 修改/ ,/ 对/ 用户/ 来说/ ,/ 依次/ 修改/ 将/ 是/ 一个/ 巨大/ 并且/ 繁琐/ 的/ 任务/ ./ 如果/ 只是/ 随机/ 设置/ 这些/ 属性/ ,/ 则/ 会/ 导致/ 结果/ 不/ 符合/ 真实/ 人群/ 的/ 特点/ ,/ 很难/ 控制/ 达到/ 用户/ 所/ 需/ 效果/ ./ 如果/ 采用/ 简单/ 规则/ 对/ 人群/ 进行/ 排列/ ,/ 又/ 会/ 导致/ 结果/ 过于/ 规整/ 或/ 重复/ ,/ 同时/ ,/ 复杂/ 的/ 人群/ 分布/ 规则/ 难以/ 用/ 数学/ 方程/ 描述/ ./ 基于/ 上述/ 问题/ ,/ 本文/ 提出/ 一种/ 基于/ 样本/ 的/ 大规模/ 人群/ 快速/ 创作方法/ ,/ 将/ 人/ 视为/ 具有/ 分布/ 和/ 角色/ 信息/ 的/ 粒子/ ,/ 通过/ 从/ 真实/ 图片/ 中/ 获取/ 包含/ 小规模/ 人群/ 粒子/ 信息/ 的/ 样本/ (/ 或/ 由/ 用户/ 创作/ 所/ 需/ 样本/ )/ ,/ 建立/ 样本/ 库/ ,/ 基于/ WangTile/ 方法/ ,/ 使用/ 样本/ 制作/ WangTile/ 集合/ ,/ 使用/ WangTile/ 非周期性/ 拼接/ 覆盖/ 场景/ 区域/ ,/ 从而/ 迅速/ 生成/ 任意/ 规模/ 场景/ 内/ 的/ 多样/ 人群/ ./ 本文/ 的/ 创作方法/ 简单/ 快速/ ,/ 用户/ 只/ 需/ 输入/ 若干/ 样本/ 和/ 需要/ 人群/ 覆盖/ 的/ 场景/ 区域/ ./ 另外/ ,/ 用户/ 可以/ 通过/ 调整/ Tile/ 的/ 边/ 颜色/ 快速/ 地/ 修改/ 局部/ 人群/ ,/ 或/ 使用/ 密度/ 图/ 控制/ 全局/ 效果/ ./ 2/ 相关/ 工作/ 人群/ 创作/ 的/ 目标/ 在于/ 如何/ 在/ 虚拟/ 场景/ 中/ 逼真/ 地/ 再现/ 多样/ 的/ 人群/ [/ 1/ -/ 2/ ]/ ./ 人群/ 中/ 每个/ 角色/ 的/ 属性/ 包括/ 初始/ 分布/ 信息/ (/ 位置/ 和/ 朝向/ )/ 、/ 角色/ 属性/ 信息/ (/ 性别/ 、/ 姿态/ 等/ )/ 和/ 模拟/ 属性/ 信息/ (/ 目标/ 点/ 或/ 方向/ 、/ 半径/ 等/ )/ ./ 本文/ 工作/ 关注/ 的/ 是/ 初始/ 分布/ 信息/ 和/ 角色/ 属性/ 信息/ ,/ 模拟/ 相关/ 属性/ 由/ 三维/ 角色/ 模型/ 确定/ ./ 基于/ 规则/ 的/ 方法/ ,/ 如/ Reynolds/ 的/ flocking/ 模型/ [/ 3/ ]/ 、/ Helbing/ 的/ 社会/ 力/ 模型/ [/ 4/ ]/ ,/ 可以/ 模拟/ 具有/ 一定/ 复杂性/ 的/ 人群/ 分布/ ,/ 但/ 很/ 难/ 通过/ 调整/ 局部/ 规则/ 来/ 控制/ 最终/ 效果/ ,/ 也/ 难以/ 模拟/ 到/ 用户/ 指定/ 的/ 效果/ ./ 基于/ 全局/ 速度/ 场/ 的/ 宏观/ 方法/ ,/ 包括/ 基于/ 地图信息/ [/ 5/ -/ 6/ ]/ 、/ 用户/ 交互/ 控制/ 导航/ [/ 7/ -/ 9/ ]/ 、/ 基于/ 连续介质/ 理论/ [/ 10/ -/ 11/ ]/ 、/ 基于/ 流体/ 模型/ [/ 12/ ]/ 等/ ,/ 只能/ 用于/ 全局/ 运动/ 控制/ 效果/ ,/ 无法控制/ 局部/ 人群/ 的/ 分布/ 效果/ ./ 王兆其/ 等/ 人/ [/ 13/ ]/ 的/ Guarder/ 系统/ 提供/ 了/ 人群/ 疏导/ 预案/ 编辑/ 功能/ ,/ 采用/ 手工/ 交互/ 的/ 方法/ 设定/ 人群/ 的/ 初始/ 属性/ ./ Ulicny/ 等/ 人/ [/ 12/ ]/ 的/ Crowdbrush/ 模型/ 提供/ 了/ 一种/ 实时/ 创作/ 和/ 绘制/ 人群/ 的/ 方法/ ,/ 用户/ 可以/ 使用/ 笔刷来/ 编辑/ 和/ 控制/ 人物/ 角色/ 信息/ ,/ 由于/ 操作/ 更/ 多/ 针对/ 的/ 是/ 单个/ 或/ 若干个/ 角色/ ,/ 因此/ 需要/ 大量/ 的/ 用户/ 交互/ ./ Yersin/ 等/ 人/ [/ 14/ ]/ 提出/ 基于/ CrowdPatch/ 的/ 大规模/ 场景/ 人群/ 创作/ 及/ 动画/ 方法/ ,/ 通过/ 预先/ 将/ 人物/ 角色/ 的/ 运动/ 轨迹/ 存储/ 在/ Patch/ 中/ ,/ 再/ 进行/ 拼接/ ,/ 从而/ 得到/ 最终/ 效果/ ,/ 然而/ ,/ 该/ 方法/ 中/ Patch/ 设计/ 过于/ 复杂/ ,/ 需要/ 满足/ 空间/ 及/ 时间/ 连续/ ,/ 因此/ ,/ 所/ 能/ 模拟/ 的/ 人群/ 分布/ 及/ 动画/ 种类/ 十分/ 有限/ ,/ 此外/ ,/ 用户/ 也/ 无法/ 修改/ 拼接/ 后/ 的/ 人群/ 场景/ ./ Ju/ 等/ 人/ [/ 15/ ]/ 提出/ 的/ 基于/ 数据/ 驱动/ 的/ 人群/ 模拟/ 方法/ ,/ 从/ 真实/ 视频/ 中/ 分类/ 学习/ 获得/ 小规模/ 人群/ 分布/ 样本/ ,/ 模拟/ 中/ ,/ 根据/ 每组/ 人群/ 的/ 分布/ 是否/ 在/ 样本/ 集中/ 来/ 进行/ 添加/ 个体/ 及/ 控制/ 运动/ ,/ 由于/ 需要/ 检测/ 每个/ 个体/ 的/ 邻近/ 区域/ 与/ 整个/ 样本/ 集/ 的/ 相似/ 度/ ,/ 因此/ ,/ 人群/ 的/ 合成/ 速度/ 十分/ 缓慢/ ,/ 合成/ 结果/ 也/ 十分/ 规律/ ,/ 不适/ 用于/ 大规模/ 多样/ 人群/ 的/ 快速/ 合成/ ./ Guy/ 等/ 人/ [/ 16/ ]/ 提出/ 了/ 基于/ 心理学/ 模型/ 参数/ 化/ 描述/ 人物/ 角色行为/ 特性/ 的/ 方法/ ,/ 关注/ 的/ 是/ 角色/ 运动/ 相关/ 参数/ 的/ 设置/ ./ WangTile/ ,/ 由/ 数学/ 逻辑/ 家/ 王浩/ [/ 17/ ]/ 在/ 1961/ 年/ 提出/ ,/ 是/ 一组/ 大小/ 相同/ 的/ 正方形/ Tile/ ,/ 对/ Tile/ 的/ 每/ 条边/ 都/ 设定/ 一种/ 颜色/ ,/ 如果/ 一个/ Tile/ 的/ 某/ 条边/ 与/ 另/ 一个/ Tile/ 的/ 某/ 条边/ 的/ 颜色/ 相同/ ,/ 则/ 可以/ 将/ 这/ 两个/ Tile/ 拼接/ 摆放/ ,/ 使用/ 一组/ WangTiles/ 拼接/ 铺满/ 整个/ 平面/ ,/ 生成/ 的/ 图案/ 是/ 非周期性/ 的/ ,/ 如图/ 1/ 所示/ ./ Cohen/ 等/ 人/ [/ 18/ ]/ 提出/ 了/ 基于/ WangTile/ 进行/ 实时/ 纹理/ 合成/ 的/ 方法/ ,/ 由/ 样本/ 纹理/ 拼接/ 预先/ 生成/ WangTile/ ,/ 使用/ WangTile/ 快速/ 拼接/ 合成/ 纹理/ [/ 19/ ]/ ./ Kopf/ 等/ 人/ [/ 20/ ]/ 提出/ 基于/ WangTile/ 生成/ 采样/ 点集/ 的/ 方法/ ./ 3/ 人群/ 快速/ 创作/ 系统/ 本文/ 将/ 人群/ 中/ 的/ 每个/ 角色/ 视为/ 粒子/ ,/ 每个/ 粒子/ 包含/ 其/ 初始/ 分布/ 信息/ 、/ 角色/ 属性/ 信息/ 和/ 附加/ 信息/ ./ 初始/ 分布/ 信息/ 包括/ 位置/ 犘/ (/ Px/ ,/ Py/ )/ 和/ 朝向/ 犗/ (/ Ox/ ,/ Oy/ )/ ,/ 角色/ 属性/ 信息/ 主要/ 是/ 人物/ 三维/ 模型/ 的/ 属性/ 信息/ ,/ 包括/ 性别/ Gender/ 、/ 年龄/ Age/ 、/ 姿态/ Pose/ (/ 即/ 对应/ 动作/ 序列/ )/ ,/ 附加/ 信息/ 包括/ 半径/ Radius/ 和/ 等级/ Rank/ ./ 算法/ 部分/ 主要/ 处理/ 位置/ 信息/ 和/ 朝向/ 信息/ ,/ 角色/ 属性/ 信息/ 用于/ 从/ 三维/ 人物/ 模型库/ 中/ 选择/ 符合条件/ 的/ 角色/ 模型/ 进行/ 显示/ ,/ 附加/ 信息/ 主要/ 用于/ 最后/ 的/ 人群/ 密度/ 调整/ ,/ 等级/ Rank/ 值越/ 小/ 的/ 粒子/ 在/ 该/ 样本/ 中/ 的/ 重要性/ 越高/ ./ 系统/ 的/ 主要/ 流程/ 包括/ :/ Page3/ 本中/ 包含/ 具有/ 局部/ 人群/ 信息/ 的/ 粒子/ 集/ ;/ (/ 1/ )/ 局部/ 区域/ 人群/ 样本/ 库/ 建立/ ./ 每个/ 正方形/ 样/ (/ 2/ )/ WangTile/ 集/ 的/ 合成/ ./ 根据/ 样本/ 库/ 合成/ WangTile/ ,/ 处理/ Tile/ 内部/ 相邻/ 样本/ 重合/ 区域/ 内/ 的/ 粒子/ 的/ 分布/ ;/ (/ 3/ )/ 场景/ 区域/ 拼接/ 覆盖/ ./ 根据/ 用户/ 输入/ 区域/ ,/ 使用/ WangTile/ 快速/ 拼接/ 覆盖/ ,/ 得到/ 场景/ 内/ 人群/ 粒子/ 集合/ ;/ (/ 4/ )/ 用户/ 编辑/ 修改/ ./ 通过观察/ 颜色/ 所/ 代表/ 的/ 样本/ ,/ 直观/ 地/ 调整/ 局部/ 人群/ ,/ 也/ 可以/ 通过/ 调节/ 密度/ 场来/ 控制/ 全局/ 效果/ ;/ 图/ 1WangTile/ 拼接/ 示意图/ (/ 5/ )/ 三维/ 人物/ 角色/ 模型/ 匹配/ ./ 根据/ 粒子/ 的/ 三维/ 人物/ 模型/ 属性/ 信息/ 从/ 模型库/ 中/ 索引/ 获得/ 相应/ 的/ 三维/ 角色/ 模型/ ./ 3.1/ 建立/ 人群/ 样本/ 库/ 本文/ 目标/ 在于/ 在/ 虚拟/ 场景/ 中/ 快速/ 生成/ 人群/ 初始/ 信息/ ,/ 使/ 其/ 具有/ 一定/ 的/ 真实性/ 或/ 满足用户/ 指定/ 类型/ ./ 因此/ ,/ 可以/ 从/ 真实/ 人群/ 图片/ 中/ 提取/ 包含/ 人群/ 信息/ 的/ 样本/ ,/ 或/ 由/ 用户/ 设计/ 指定/ 样本/ ,/ 建立/ 样本/ 库来/ 达到/ 真实/ 的/ 目标/ ./ 每个/ 样本/ 为/ 一个/ 正方形/ 区域/ ,/ 将/ 边长/ 置/ 为/ 1.0/ ,/ 包含/ 的/ 人群/ 位置/ 信息/ 对应/ 缩放/ 至/ 0/ ~/ 1.0/ ./ 如图/ 2/ 所示/ ,/ 从/ 真实/ 图片/ 中/ 选取/ 若干个/ 关注/ 的/ 正方形/ 区域/ (/ 图/ 2/ (/ a/ )/ )/ ,/ 从/ 框定/ 区域/ 中/ 确定/ 想要/ 提取/ 的/ 人群/ 信息/ (/ 图/ 2/ (/ b/ )/ )/ ,/ 选定/ 若干/ 个体/ ,/ 判断/ 并/ 设置/ 其/ 分布/ 信息/ 和/ 角色/ 属性/ 信息/ ./ 确定/ 样本/ 库后/ ,/ 为/ 每个/ 样本/ 设置/ 一/ Page4/ 个/ 不同/ 的/ 颜色/ 编码/ ,/ 即/ 一个/ 颜色/ 代表/ 一个/ 样本/ ./ 图/ 3/ 为/ 样本/ 库/ 示例/ ,/ 包含/ 了/ 12/ 个/ 从/ 不同/ 人群/ 图片/ 中/ 提取/ 的/ 样本/ ,/ 不同/ 样本/ 中/ 个体/ 数/ 也/ 不同/ ,/ 这样/ 能够/ 合成/ 密度/ 各异/ 的/ 人群/ ./ 3.2/ 生成/ WangTile/ 集合/ 在/ 建立/ 了/ 样本/ 库/ 并/ 以/ 颜色/ 编码/ 后/ ,/ 使用/ 样本/ 库/ 制图/ 4WangTile/ 合成/ 与/ 纹理/ 合成/ 中/ 的/ 生成/ 方法/ 不同/ ,/ 本文/ 处理/ 的/ 是/ 粒子/ ,/ 而/ 非/ 像素/ ,/ 因此/ 对于/ 重叠/ 区域/ 的/ 处理/ 方法/ 不同/ ./ 在/ 重叠/ 区域/ 内/ ,/ 粒子/ 之间/ 要/ 保持/ 一定/ 间距/ ,/ 同时/ 尽量/ 保持/ 原/ 分布/ ,/ 使用/ Voronoi/ 划分/ ,/ 选择/ 一条/ 分割线/ ,/ 使得/ 所/ 隔开/ 的/ 粒子/ 距离/ 最远/ ./ 本文/ 建立/ 的/ 是/ 完全/ WangTile/ 集/ ,/ 即/ 每/ 条边/ 可选/ 的/ 颜色/ 为/ 整个/ 样本/ 集/ ./ 另外/ ,/ 由于/ N/ 边/ 只/ 与/ S/ 边/ 拼接/ ,/ W/ 边/ 只/ 于/ E/ 边/ 拼接/ ,/ 可以/ 为/ N/ // S/ 边/ 设置/ 一个/ 可/ 选/ 样本/ 集/ 1/ ,/ 而/ 为/ W/ // E/ 边/ 设置/ 另外/ 一个/ 样本/ 集/ 2/ ,/ 使得/ 人群/ 横向/ 和/ 纵向/ 分布/ 的/ 特点/ 各/ 不/ 不同/ ./ 图/ 5/ 为/ N/ // S/ 边/ 和/ W/ // E/ 边/ 各设/ 2/ 个/ 可选/ 样本/ 组成/ 的/ WangTile/ 集合/ (/ 24/ )/ ./ 为了/ 达到/ 快速/ 地/ 覆盖/ 场景/ 区域/ 的/ 目的/ ,/ 本文/ 规定/ 了/ WangTile/ 集内/ 的/ Tile/ 的/ 排列/ 方式/ ,/ 通过/ 4/ 条作/ WangTile/ 集合/ ./ 每/ 一个/ WangTile/ 的/ 合成/ 步骤/ 如下/ :/ (/ 1/ )/ 从/ 样本/ 库中/ 随机/ 选择/ 4/ 个/ 样本/ (/ 可/ 重复/ )/ ,/ 拼接/ 组成/ 一个/ 较大/ 的/ 样本/ 块/ ,/ 中间/ 包含/ 的/ 菱形/ 区域/ (/ 图/ 4/ (/ a/ )/ 中虚/ 线框/ )/ 即为/ WangTile/ ,/ 重合/ 部分/ Overlap/ _/ size/ ∈/ (/ 0.1/ ,/ 0.35/ )/ ;/ (/ 2/ )/ 在/ 菱形/ 区域/ 内/ ,/ 对/ 相邻/ 样本/ 重叠/ 区域/ 内/ 的/ 粒子/ 集/ 进行/ Voronoi/ 划分/ ,/ 选择/ 一条/ 由/ Voronoi/ 边/ 组成/ 的/ 分割线/ (/ 黑色/ 实线/ )/ ,/ 使得/ 所/ 隔开/ 的/ 粒子/ 距离/ 最远/ ,/ 分别/ 保留/ 位于/ 分割线/ 左侧/ 的/ 左侧/ 样本/ 粒子/ 和/ 位于/ 分割线/ 右侧/ 的/ 右侧/ 样本/ 粒子/ ,/ 保证/ 重叠/ 区域/ 内/ 粒子/ 分布/ 的/ 自然性/ ;/ (/ 3/ )/ 旋转/ 裁剪/ 后/ 的/ 菱形/ 区域/ 及/ 位于/ 其内/ 的/ 粒子/ ,/ 得到/ 正方形/ Tile/ (/ 图/ 4/ (/ b/ )/ )/ ,/ 根据/ 样本/ 颜色/ 设置/ 对应/ WangTile/ 边/ 的/ 颜色/ 编码/ ./ 图/ 516/ 个/ WangTile/ ,/ 每条/ 边/ 2/ 种可选/ 颜色/ (/ Kv/ =/ 2/ )/ 边/ (/ N/ // S/ // W/ // E/ )/ 的/ 颜色/ 计算/ 其/ 在/ 索引/ 列表/ 中/ 位置/ [/ 19/ ]/ ./ 假设/ 我们/ 的/ WangTile/ 的/ 竖直/ 边/ (/ 即/ W/ // E/ 边/ )/ 具有/ Kv/ 个/ 可选/ 的/ 颜色/ ,/ 而/ 横向/ 边/ 只/ 具有/ 一种/ 颜色/ ,/ 使用/ 下述/ 排列/ 方式/ 将/ 这些/ Tile/ 排列成/ 一行/ ,/ 使得/ 相邻/ 边/ 具有/ 相同/ 颜色/ :/ 给定/ 一个/ W/ // E/ 边/ 颜色/ 编/ Page5/ 码为/ (/ e1/ ,/ e2/ )/ 的/ Tile/ ,/ 通过/ 式/ (/ 1/ )/ 计算/ 得到/ 的/ 索引/ 值/ ,/ 确定/ 其/ 在/ 此行/ 中/ 的/ 位置/ ./ 这种/ 索引/ 排列/ 方式/ 保证/ 每个/ Tile/ 只/ 使用/ 一次/ ,/ 每个/ Tile/ 具有/ 一个/ 范围/ 在/ [/ 0/ ~/ Kv/ ]/ 的/ 整数/ index/ ./ TileIndex1D/ (/ e1/ ,/ e2/ )/ =/ 对于/ 二维/ 索引/ ,/ 我们/ 分别/ 获取/ 一维/ 横向/ 索引/ Ih/ 和/ 一维/ 纵向/ 索引/ Iv/ ,/ 对应/ 分别/ 为/ 第/ Ih/ 列/ 和/ 第/ Iv/ 行/ ./ 3.3/ 使用/ WangTile/ 非周期性/ 拼接/ 覆盖/ 场景/ 在/ 虚拟/ 场景/ 中/ ,/ 用户/ 指定/ 需要/ 人群/ 覆盖/ 的/ 多边形/ 区域/ ,/ 系统/ 选择/ 最长/ 边/ 作为/ Tile/ 拼接/ 需要/ 对齐/ 的/ 边界/ ,/ 计算/ 边界/ 矩形/ 区域/ 及/ 所/ 需/ Tile/ 行数/ H/ _/ NUM/ 和/ 列数/ C/ _/ NUM/ ./ 在/ 矩形/ 覆盖/ 区域/ 内/ ,/ 从/ WangTile/ 集合/ 中/ 随机/ 挑选/ (/ 或/ 部分/ 指定/ )/ H/ _/ NUM/ ×/ C/ _/ NUM/ 个/ Tile/ 进行/ 图/ 6/ 场景/ 拼接/ 实例/ 3.4/ 交互/ 编辑/ 用户/ 具有/ 两种/ 编辑/ 人群/ 场景/ 的/ 方式/ :/ (/ 1/ )/ 用户/ 可以/ 通过观察/ 每个/ 颜色/ 所/ 代表/ 的/ 样本/ ,/ 在/ 最后/ 覆盖/ 区域/ 内/ 指定/ 或/ 修改/ 若干/ 位置/ 处/ Tile/ 边/ 颜色/ ,/ 调整/ 局部/ 人群/ 效果/ ;/ (/ 2/ )/ 通过/ 输入/ 密度/ 场/ ,/ 调整/ 人群/ 密度/ ./ 用户/ 可以/ 从/ 图片/ 中/ 提取/ 或/ 设计/ 密度/ 场/ ,/ 作为/ 一张/ 密度/ 图片/ 输入/ ,/ 如图/ 7/ 所示/ ,/ 处理/ 图/ (/ a/ )/ 所示/ 图片/ 获得/ 密度/ 分布/ ,/ 见/ 图片/ (/ b/ )/ ,/ 使用/ 这个/ 密度/ 分布/ ,/ 调整/ Tile/ 拼接/ 覆盖/ 后/ 得到/ 人群/ 粒子/ CrowdParticles/ ,/ 即图/ (/ c/ )/ ,/ 获得/ 最终/ 人群/ 分布/ (/ d/ )/ ./ 调整/ 过程/ 如下/ :/ 首先/ 基于/ 粒子/ Rank/ 信息/ 对/ CrowdParticles/ 进行/ 由小到大/ 排序/ ,/ 然后/ 根据/ 顺序/ 依次/ 判断/ 该/ 粒子/ 是否/ 应该/ 被/ 保留/ ,/ 例如/ 第/ i/ 个/ 粒子/ 位置/ 为/ 犘/ i/ (/ Px/ ,/ Py/ )/ ,/ 使用/ 其/ 周围/ 像素/ 的/ 灰度/ 线性插值/ 或/ 周围/ Border/ ×/ Border/ 个/ 像素/ 的/ 平均/ 密度/ 值/ 作为/ 此点/ 密度/ 值/ sampleDensMap/ (/ Px/ ,/ Py/ )/ ,/ 若/ 符合/ 匹配/ 规则/ 的/ 铺排/ 拼接/ ./ 随机/ 非周期性/ 拼接/ 过程/ 如下/ :/ (/ 1/ )/ 指定/ 矩形/ 区域/ 的/ 边界/ 约束/ ,/ 假设/ 选择/ N/ // W/ 边/ ,/ 则/ 指定/ 其上/ 对应/ 一排/ (/ 一列/ )/ Tile/ 的/ N/ (/ W/ )/ 边/ 颜色/ ,/ 即/ BN/ [/ H/ _/ NUM/ +/ 1/ ]/ 和/ BW/ [/ C/ _/ NUM/ +/ 1/ ]/ 的/ 颜色/ 值/ ;/ (/ 2/ )/ 从/ 约束/ 边界/ 开始/ 选择/ 满足/ 匹配/ 条件/ 的/ Tile/ 铺排/ 区域/ ,/ 铺排/ 方向/ 从/ N/ 到/ S/ ,/ 从/ W/ 到/ E/ ,/ 得到/ 矩形/ 区域/ 内/ 的/ 人群/ 粒子/ CrowdParticles/ ;/ (/ 3/ )/ 根据/ 原/ 输入/ 场景/ 区域/ ,/ 删除/ 位于/ 其外/ 的/ 粒子/ ,/ 如果/ 场景/ 内/ 具有/ 障碍物/ ,/ 删除/ 位于/ 障碍物/ 多边形/ 之内/ 的/ 粒子/ ,/ 得到/ 最终/ 覆盖/ 场景/ 的/ 人群/ 粒子/ CrowdParticles/ ./ 本文/ 在/ 两个/ 场景/ 中/ 使用/ Kv/ =/ 6/ 的/ WangTile/ 集合/ 进行/ 区域/ 覆盖/ ,/ 其/ 结果/ 如图/ 6/ 所示/ ./ 其中/ ,/ 图/ 6/ (/ a/ )/ 场景/ 具有/ 156/ 个/ Tile/ ,/ 1492/ 个人/ ,/ 图/ 6/ (/ b/ )/ 具有/ 1396/ 个/ Tile/ ,/ 9654/ 个人/ ./ sampleDensMap/ (/ Px/ ,/ Py/ )/ </ i/ ×/ FACTOR/ ,/ 舍弃/ 该/ 粒子/ ./ 其中/ ,/ FACTOR/ 与/ 需要/ 生成/ 的/ 人群/ 规模/ 相关/ ,/ FACTOR/ 越大/ ,/ 生成/ 的/ 人群/ 规模/ 越大/ ./ 3.5/ 三维/ 人物/ 角色/ 模型/ 匹配/ 最终/ 场景/ 中/ 人群/ 的/ 多样性/ 主要/ 由/ 两个/ 因素/ 决定/ ,/ 一个/ 是/ 合成/ WangTile/ 集合/ 所/ 使用/ 的/ 样本/ 数量/ ,/ 另/ 一个/ 是/ 所/ 使用/ 的/ 三维/ 人物/ 模型/ 各/ 异性/ ./ 具有/ 相同/ 角色/ 属性/ 的/ 粒子/ 可以/ 使用/ 不同/ 的/ 三维/ 人物/ 模型/ ,/ 可/ 选择/ 模型/ 越/ 多/ ,/ 最后/ 的/ 人群/ 场景/ 更加/ 丰富/ ./ 本文/ 建立/ 一个/ 统一/ 的/ 三维/ 人物/ 模型库/ ,/ 使用/ 部分/ 角色/ 属性/ 信息/ (/ 性别/ Gender/ 、/ 姿态/ Pose/ )/ 对模型/ 进行/ 分类/ 存储/ ./ 根据/ 最后/ 的/ CrowdParticles/ 集/ ,/ 使用/ 粒子/ 信息/ 在/ 模型库/ 中/ 索引/ 到/ 对应/ 的/ 三维/ 人物/ 模型/ ,/ 在/ 多个/ 满足条件/ 的/ 模型/ 中/ 随机/ 选取/ ./ 图/ 8/ 是/ 一个/ 存储/ 示意图/ ./ Page6/ 图/ 7/ 交互/ 编辑/ 处理/ 图/ 8/ 模型库/ 分类索引/ 举例/ Page74/ 结果/ 与/ 分析/ 4.1/ 性能/ 测试/ 本文/ 的/ 测试/ 在/ 处理器/ 为/ Intel/ (/ R/ )/ Core/ (/ TM/ )/ 2Q9550/ @/ 2.83/ GHz/ ,/ 内存/ 为/ 8GB/ ,/ 显卡/ 为/ NVIDIAGeForceGTX280/ 的/ 台式机/ 上/ 完成/ ./ 本文/ 的/ 算法/ 主要/ 分为/ 两/ 部分/ :/ WangTile/ 集合/ 的/ 合成/ 和/ 使用/ Tile/ 拼接/ 覆盖/ 场景/ 区域/ ,/ 因此/ 分别/ 对/ 这/ 两个/ 部分/ 的/ 运行/ 时间/ 进行/ 测试/ ./ 首先/ ,/ 通过/ 变化/ WangTile/ 中/ 每/ 条边/ 可选/ 的/ 颜色/ 数/ K/ (/ 即/ 样本数/ )/ ,/ 测试/ 生成/ 规模/ 为/ K4/ 的/ WangTile/ 集合/ 所/ 需/ 计算/ 时间/ ,/ 测试/ 中/ 使用/ 的/ 每个/ 样本/ 中/ 人数/ 从/ 8/ ~/ 16/ 不/ 等/ ,/ 由于/ 重合/ 区域/ 的/ 设置/ 值/ 对/ 计算/ 时间/ 也/ 具有/ 一定/ 影响/ ,/ 因此/ 实验/ 分别/ 测试/ 了/ Overlap/ _/ size/ 为/ 0.2/ 和/ 0.3/ 时/ 的/ 计算/ 时间/ ./ 测试数据/ 如表/ 1/ 中/ 所示/ ./ 表/ 1/ 合成/ 不同/ 规模/ WangTile/ 集合/ 的/ 所/ 需/ 时间/ 边/ 可选/ 颜色/ 数/ K3810/ ./ 01542560.04756250/ ./ 109612960.250840960/ ./ 63910100001.63812207363/ ./ 18314384166.303166553610/ ./ 498/ 进一步/ 测试/ 使用/ 规模/ 为/ 64/ 的/ WangTile/ 集/ ,/ 拼接/ H/ _/ NUM/ ×/ C/ _/ NUM/ 个/ Tile/ 生成/ 覆盖/ 场景/ 人群/ 的/ 时间/ ,/ 测试数据/ 如表/ 2/ 中/ 所示/ ./ 从/ 结果/ 中/ 可以/ 看出/ ,/ 使用/ WangTile/ 拼接/ 覆盖/ 场景/ 十分/ 快速/ ,/ 使用/ 9/ 万个/ Tile/ 拼接/ 生成/ 百万/ 规模/ 的/ 人群/ 粒子/ 的/ 计算/ 时间/ 不到/ 1s/ ./ H/ _/ NUM/ ×/ C/ _/ NUM/ 计算/ 时间/ // s/ 生成/ 人群/ 规模/ 10/ ×/ 1020/ ×/ 2040/ ×/ 4060/ ×/ 60100/ ×/ 100200/ ×/ 200300/ ×/ 300/ 最后/ ,/ 测试/ 使用/ 本/ 方法/ 与/ 用户/ 手工/ 交互/ 生成/ 虚拟/ 人群/ 方法/ 的/ 时间/ 效率/ 差异性/ ./ 采用/ 6/ 个/ 样本/ (/ 即/ K/ =/ 6/ )/ 共/ 72/ 个/ 个体/ 形成/ 的/ 样本/ 库/ ,/ 产生/ 从/ 103/ ~/ 105/ 个体/ 规模/ 不/ 等/ 的/ 虚拟/ 人群/ ./ 在/ 测试/ 中/ ,/ 我们/ 假设/ 手工/ 交互/ 的/ 软件/ 操作界面/ 非常/ 友好/ 且/ 能够/ 保证/ 实时性/ ,/ 分别/ 针对/ 能够/ 熟练/ 操作/ 软件/ 的/ 专业/ 人员/ 和/ 只/ 简单/ 接触/ 过/ 计算机/ 的/ 一般性/ 非专业/ 人员/ 进行/ 调查/ ,/ 得出/ 表/ 3/ 中/ 的/ 数据/ ./ 表/ 3/ 用户/ 调整/ 一个/ 虚拟人/ 的/ 位置/ 和/ 朝向/ 需要/ 的/ 平均/ 时间/ 创作/ 样本/ 时/ 调整/ 虚拟/ 人群/ 时/ 根据/ 表/ 3/ 的/ 数据/ ,/ 估算/ 出/ 这/ 两种/ 方法/ 生成/ 大规模/ 虚拟/ 人群/ 所/ 需要/ 的/ 时间/ ./ 本/ 方法/ 需要/ 的/ 时间/ 为/ :/ 用户/ 创作/ 样本/ 时间/ +/ 程序/ 的/ 计算/ 时间/ ;/ 用户/ 手工/ 交互/ 生成/ 虚拟/ 人群/ 方法/ 需要/ 的/ 时间/ 为/ :/ 随机/ 方法/ 的/ 计算/ 时间/ +/ 用户/ 调整/ 虚拟/ 人群/ 的/ 时间/ ./ 由于/ 本/ 方法/ 的/ 程序/ 计算/ 时间/ 和/ 随机/ 方法/ 的/ 计算/ 时间/ 都/ 是/ 毫秒/ 级/ ,/ 故可/ 忽略不计/ ./ 最终/ 估算/ 结果/ 如表/ 4/ 所示/ ./ 人群/ 规模/ 手工/ 交互/ 1035/ ×/ 1031.5/ ×/ 10472021605/ ×/ 1032.5/ ×/ 1047.5/ ×/ 10472021601045/ ×/ 1041.5/ ×/ 10572021602/ ×/ 1041053/ ×/ 10572021601055/ ×/ 1051.5/ ×/ 10672021604.2/ 结果/ 测试/ 如图/ 6/ 和/ 图/ 7/ 所示/ ,/ 本文/ 建立/ 了/ 3/ 个/ 场景/ ,/ 使用/ 的/ WangTile/ 集中/ 每对边/ 具有/ 6/ 种可选/ 颜色/ ,/ 使用/ 的/ 人物/ 模型库/ 具有/ 42/ 个/ 模型/ ,/ 分类/ 如图/ 8/ 所示/ ./ 最终/ 的/ 场景/ 结果/ 截图/ 如图/ 9/ 、/ 图/ 10/ 和/ 图/ 11/ 所示/ ./ 合成/ 的/ 大规模/ 人群/ 场景/ 符合实际/ 局部/ 人群/ 分布/ 特点/ ,/ 且/ 具有/ 一定/ 各/ 异性/ ./ 与/ 随机/ 生成/ 大规模/ 人群/ 方法/ 相比/ ,/ 本文/ 的/ 方法/ 在/ 用户/ 设置/ 好/ 若干个/ 初始/ 分布/ 样本/ 之后/ ,/ 即可/ 迅速/ 生成/ 任意/ 规模/ 人群/ ,/ 且/ 生成/ 的/ 人群/ 具有/ 方向/ 信息/ ,/ 局部/ 分布/ 符合实际/ 场景/ ,/ 全局/ 并/ 不会/ 出现/ 明显/ 地/ 周期性/ 重复/ 现象/ ;/ 而/ 对于/ 随机/ 方法/ ,/ 在/ 生成/ 人群/ 之后/ ,/ 用户/ 往往/ 需要/ 进一步/ 调整/ 修改/ 人物/ 角色/ 方向/ 和/ 局部/ 分布/ 等/ ,/ 对于/ 成千上万/ 的/ 人群/ 创造/ 来说/ ,/ 这/ 将/ 是/ 一个/ 巨大/ 并且/ 繁琐/ 的/ 任务/ ./ 图/ 12/ 和/ 图/ 13/ 表明/ ,/ 本/ 方法/ 所/ 生成/ 的/ 虚拟/ 人群/ 更具/ 自然性/ 和/ 真实性/ ./ 随机/ 生成/ 方法/ 产生/ 的/ 虚拟/ 人群/ (/ 图/ 12/ (/ a/ )/ ,/ 图/ 13/ (/ a/ )/ )/ 与/ 本/ 方法/ (/ 图/ 12/ (/ b/ )/ ,/ 图/ 13/ (/ b/ )/ )/ 相比/ ,/ 个体/ 之间/ 缺乏/ 互动性/ ,/ 显得/ 单调/ 、/ 不足以/ 体现/ 自然/ 人群/ 的/ 真实/ 分布/ ./ Page8/ 图/ 9/ 场景/ 1/ :/ 广场/ 截图/ 图/ 10/ 场景/ 2/ :/ 小镇/ 截图/ Page9/ 图/ 11/ 场景/ 3/ :/ 城市/ 截图/ 图/ 12/ 随机/ 生成/ 方法/ 与/ 基于/ 样本/ 的/ WangTile/ 快速/ 拼接/ 方法/ 对比/ (/ 近距离/ )/ 图/ 13/ 随机/ 生成/ 方法/ 与/ 基于/ 样本/ 的/ WangTile/ 快速/ 拼接/ 方法/ 对比/ (/ 远距离/ )/ Page105/ 结论/ 本文/ 着眼于/ 大规模/ 场景/ 中/ 人群/ 的/ 快速/ 创作/ ,/ 提出/ 基于/ 样本/ 合成/ WangTile/ 集/ ,/ 快速/ 拼接/ 生成/ 非周期性/ 任意/ 规模/ 人群/ 的/ 创作/ 系统/ ./ 该/ 系统/ 通过/ 真实/ 数据/ 提取/ 或/ 用户/ 自主/ 设计/ 来/ 建立/ 样本/ ,/ 使得/ 合成/ 人群/ 的/ 分布/ 满足/ 一定/ 真实性/ 及/ 用户/ 的/ 需求/ ;/ 通过/ 合成/ WangTile/ 集/ ,/ 使用/ WangTile/ 快速/ 拼接/ 生成/ 任意/ 规模/ 人群/ ,/ 简单/ 快速/ ,/ 且/ 结果/ 具有/ 一定/ 的/ 多样性/ ;/ 另外/ ,/ 系统/ 为/ 用户/ 提供/ 了/ 直观/ 地/ 编辑/ 控制/ 结果/ 的/ 方法/ ,/ 用户/ 可以/ 通过/ 指定/ 场景/ 中/ 部分/ 区域/ Tile/ 边/ 颜色/ 直观/ 地/ 调整/ 局部/ 人群/ ,/ 也/ 可以/ 通过/ 密度/ 场/ 便利/ 地/ 调整/ 全局/ 人群/ 效果/ ./ 本文/ 所/ 提供/ 的/ 人群/ 创作/ 算法/ 可/ 适用/ 于/ 各种/ 虚拟现实/ 环境/ ,/ 尤其/ 是/ 需要/ 产生/ 自然/ 人群/ 分布/ 的/ 虚拟/ 街景/ 、/ 公路/ 景观/ 等/ ./ 在/ 未来/ 的/ 工作/ 中/ ,/ 我们/ 尝试/ 将/ 本文/ 的/ 算法/ 应用/ 在/ 大规模/ 虚拟/ 交通/ 模拟/ 中/ [/ 21/ -/ 23/ ]/ ,/ 从而/ 产生/ 符合/ 现实/ 的/ 行人/ 人群/ ./ 而且/ ,/ 本文/ 基于/ 样本/ 的/ 思想/ 也/ 可/ 用于/ 汽车/ 群/ 的/ 创作/ ./ 

