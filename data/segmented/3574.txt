Page1/ 一种/ 基于/ IPv6/ 的/ 物/ 联网/ 分布式/ 源地址/ 验证/ 方案/ 胡光武/ 1/ )/ 陈/ 文龙/ 2/ )/ 徐恪/ 1/ )/ 1/ )/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 2/ )/ (/ 首都师范大学/ 信息/ 工程学院/ 北京/ 100048/ )/ 摘要/ 作者/ 在/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 网络/ 环境/ 下/ ,/ 提出/ 了/ 基于/ IPv6/ 的/ 源地址/ 验证/ 整体/ 架构/ ./ 基于/ 该/ 架构/ ,/ 考虑/ 物/ 联网/ 节点/ 资源/ 受限/ 特点/ ,/ 并/ 结合物/ 联网/ 末梢/ 网络/ 的/ 拓扑/ 形态/ 及其/ 路由/ 方式/ 上/ 的/ 特征/ ,/ 设计/ 了/ 基于/ IPv6/ 的/ 物/ 联网/ 末梢/ 网络/ 分布式/ 源地址/ 验证/ 方案/ ./ 分别/ 讨论/ 了/ 静态/ 指定/ 、/ SLAAC/ (/ StatelessAddressAutoConfiguration/ )/ 、/ DHCPv6/ (/ DynamicHostConfigurationProtocolVersion6/ )/ 以及/ DHCPv6/ 与/ SLAAC/ 混合/ 情况/ 下/ 的/ 物/ 联网/ 节点/ IP地址/ 分配/ 及其/ 验证/ 机制/ ./ 模拟实验/ 表明/ ,/ 该/ 方案/ 仅以/ 微小/ 的/ 代价/ 实现/ 了/ 物/ 联网/ 节点/ IP地址/ 的/ 分配/ ,/ 同时/ 还/ 保证/ 了/ 物/ 联网/ 节点/ 之间/ 、/ 物/ 联网/ 节点/ 与/ 互联网/ 端系统/ 之间/ 端到/ 端/ 通信/ 时/ 双方/ IP地址/ 的/ 真实/ 可靠性/ ,/ 从而/ 整体/ 上/ 增强/ 了/ 物/ 联网/ 的/ 安全性/ ./ 关键词/ 物/ 联网/ ;/ IPv6/ ;/ 源地址/ 验证/ ;/ DHCPv6/ ;/ SLAAC1/ 引言/ 器/ 网络/ (/ WirelessSensorNetworks/ ,/ WSNs/ )/ 基础/ 上/ 发展/ 形成/ 的/ 一种/ 融合/ 无线/ 射频/ 识别/ (/ RFID/ )/ 系统/ 、/ 传统/ 有线/ 和/ 无线/ 互联网/ 、/ 移动/ 通信/ 网络/ 以及/ 其它/ 通信/ 物/ 联网/ (/ InternetofThings/ ,/ IoT/ )/ 是/ 在/ 无线/ 传感/ 技术/ 的/ 新兴/ 泛/ 在/ 网络/ ./ 我国/ 对物/ 联网/ 的/ 定义/ 是/ 指/ Page2/ “/ 通过/ 信息/ 传感/ 设备/ ,/ 按照/ 约定/ 的/ 协议/ ,/ 把/ 任何/ 物品/ 与/ 互联网/ 连接起来/ ,/ 进行/ 信息/ 交换/ 和/ 通信/ ,/ 以/ 实现/ 智能化/ 识别/ 、/ 定位/ 、/ 跟踪/ 、/ 监控/ 和/ 管理/ 的/ 一种/ 网络/ ,/ 它/ 是/ 在/ 互联网/ 基础/ 上/ 延伸/ 和/ 扩展/ 的/ 网络/ ”/ ①/ ./ 尽管/ 国际电信联盟/ (/ ITU/ )/ ②/ 、/ 欧盟/ ③/ ④/ 以及/ 我国/ 对物/ 联网/ 的/ 定义/ 稍/ 有/ 不同/ ,/ 但/ 其/ 共识/ 是/ :/ 物/ 联网/ 中/ 的/ 任何/ 物体/ 能/ 在/ 任何/ 时间/ 、/ 任何/ 地点/ 都/ 能够/ 与/ 其它/ 任何/ 物体/ 进行/ 连接/ ,/ 具有/ 在/ 时间/ 、/ 地点/ 、/ 物体/ 三个/ 维度/ 下/ 的/ 任意/ 连接性/ ./ 物/ 联网/ 在/ 仓储/ 物流/ 、/ 智能/ 交通/ 、/ 环境保护/ 、/ 工业/ 监测/ 、/ 智能家居/ 、/ 远程/ 医疗/ 、/ 公共安全/ 以及/ 环境保护/ 等/ 各/ 方面/ 显示/ 出/ 极大/ 的/ 应用/ 前景/ ,/ 许多/ 发达国家/ 已将物/ 联网/ 列为/ 国家/ 战略/ 予以/ 扶持/ 和/ 研发/ ./ 2005/ 年/ 国际电信联盟/ ITU/ 发布/ 了/ 《/ ITUInternetReports2005/ :/ TheInternetofThings/ 》/ ②/ ,/ 2008/ 年/ IBM/ 提出/ 了/ “/ 智慧/ 地球/ ”/ ⑤/ 的/ 概念/ ,/ 2009/ 年/ 6/ 月/ 欧盟委员会/ 提出/ 了/ 物/ 联网/ 行动/ 方案/ [/ 1/ ]/ ,/ 而/ 我国/ 在/ 2009/ 年/ 也/ 提出/ 了/ “/ 感知/ 中国/ ”/ 的/ 物/ 联网/ 发展/ 概念/ ,/ 并/ 将物/ 联网/ 技术/ 及/ 发展/ 规划/ 列入/ 2010/ 年/ 政府/ 工作/ 报告/ 以及/ “/ 十二五/ ”/ 重点/ 开发计划/ ./ 由此可见/ ,/ 物/ 联网/ 应用/ 前景/ 广阔/ ,/ 世界/ 主要/ 国家/ 正对/ 其/ 展开/ 积极/ 的/ 研究/ ./ 物/ 联网/ 与/ 传感器/ 网/ 除了/ 体系/ 架构/ 不同/ 之外/ ,/ 最大/ 的/ 区别/ 在于/ 物/ 联网/ 具有/ “/ 感知/ ”/ 功能/ ./ 物/ 联网/ 中/ 的/ 物品/ 节点/ 能/ 与/ 遵循/ 协议/ 的/ 其它/ 物品/ 联接/ ,/ 交换/ 数据/ ,/ 并/ 能/ 与/ 互联网/ 设备/ 及/ 端系统/ 通信/ ,/ 上传/ 数据/ 并/ 进行/ 智能/ 分析/ 和/ 判别/ ,/ 可以/ 说物/ 联网/ 是/ 在/ 互联网/ 基础/ 上/ ,/ 无限/ 延伸/ 的/ 智能化/ 一体化/ 网络/ ./ 近年来/ ,/ 随着/ 物/ 联网/ 研究/ 的/ 深入/ ,/ 已/ 取得/ 一些/ 重要/ 成果/ ./ 2000/ 年/ 12/ 月/ IEEE/ 标准/ 委员会/ 成立/ 了/ 802.15/ ./ 4/ 协议/ 工作组/ ,/ 目标/ 是/ 开发/ 一个/ 低/ 速率/ 的/ 无线/ 个域/ 网/ LR/ -/ WPAN/ (/ LowRate/ -/ WirelessPersonalAreaNetwork/ )/ 标准/ ;/ 2004/ 年/ 11/ 月/ IETF/ 成立/ 了/ 6LoWPAN/ (/ IPv6overLowpowerWPAN/ )/ 工作组/ ,/ 其/ 目的/ 是/ 制订/ 基于/ IPv6/ 、/ 以/ IEEE802/ ./ 15.4/ 协议/ 作为/ 底层/ 标准/ 的/ 低速/ 无线/ 个域/ 网/ 标准/ [/ 2/ -/ 4/ ]/ ;/ 2008/ 年/ 2/ 月/ IETF/ 成立/ 了/ ROLL/ (/ RoutingOverLow/ -/ PowerandLossyNetworks/ )/ 工作组/ ,/ 目标/ 是/ 使得/ 公共/ 的/ 、/ 可/ 互操作/ 的/ 第/ 3/ 层/ 路由/ 能够/ 穿越/ 任何/ 数量/ 的/ 基本/ 链路层/ 协议/ 和/ 物理/ 媒体/ ;/ 2010/ 年/ 3/ 月/ IETF/ 成立/ 了/ CoRE/ (/ ConstrainedRestfulEnvironments/ )/ 工作组/ ,/ 旨在/ 研究/ 资源/ 受限/ 物体/ 的/ 应用层/ 协议/ ;/ 2011/ 年/ 3/ 月/ IETF/ 又/ 成立/ 了/ LwIP/ (/ Light/ -/ weightIP/ )/ 工作组/ ,/ 其/ 目的/ 是/ 在/ 资源/ 受限/ 的/ 设备/ 上/ 实现/ 轻量级/ IP/ 协议/ 栈/ ./ 物/ 联网/ 中/ 的/ 节点/ 具有/ 与/ 互联网/ 节点/ 一致/ 的/ IP地址/ 后/ ,/ 物/ 联网/ 节点/ 之间/ 、/ 物/ 联网/ 节点/ 与/ 互联网/ 节点/ 之间/ 就/ 具有/ 了/ 端/ 到/ 端的/ 通信/ 能力/ ./ 给/ 每个/ 物/ 联网/ 节点/ 赋予/ IPv6/ 地址/ ,/ 运行/ 简化/ 的/ IPv6/ 协议/ ,/ 不仅/ 能/ 解决/ 物/ 联网/ 末梢/ 网络/ 间/ 、/ 物/ 联网/ 末梢/ 网络/ 与/ Internet/ 间/ 的/ 互连/ 互通/ 问题/ ,/ 同时/ 还/ 克服/ 了/ 无线/ 传感器/ 网络/ 的/ 内在/ 缺点/ ,/ 如需/ 数量/ 巨大/ 的/ 地址/ 资源/ 、/ 缺乏/ 有效/ 的/ 地址/ 管理/ 及/ 安全/ 机制/ 等/ 问题/ ./ 物/ 联网/ 节点/ 被/ 赋/ 与/ 了/ 与/ 互联网/ 终端/ 一致/ 的/ IP地址/ 后/ ,/ 尽管/ 在/ 寻址/ 、/ 路由/ 、/ 通信/ 等/ 方面/ 带/ 了/ 巨大/ 便利/ ,/ 然而/ 传统/ 互联网/ 中/ 所/ 存在/ 的/ 一些/ 安全/ 问题/ 也/ 随之而来/ ./ 其中/ ,/ 最/ 重要/ 的/ 就是/ 物/ 联网/ 节点/ 的/ 认证/ 及/ 节点/ IP/ 源地址/ 的/ 可靠性/ 问题/ ./ 互联网/ 发展/ 之初/ ,/ 基于/ 网络/ 的/ 简单/ 性/ 和/ 用户/ 的/ 可信性/ ,/ 在/ 其/ 协议/ 设计/ 中/ ,/ 路由器/ 并/ 不/ 对/ IP/ 数据/ 分组/ 中/ 的/ 源地址/ 进行/ 检查/ ,/ 而/ 只/ 根据/ 目的/ 地址/ 进行/ 路由/ 转发/ ./ 这种/ 缺陷/ 直接/ 造成/ 了/ DoS/ [/ 5/ ]/ // DDoS/ [/ 6/ ]/ 、/ Smurf/ ⑥/ 、/ SYNflood/ [/ 7/ ]/ 等/ 一系列/ 攻击/ 及/ 病毒/ 侵袭/ 行为/ 发生/ ./ 攻击者/ 为了/ 隐藏/ 其/ 身份/ ,/ 往往/ 使用/ 假冒/ 的/ IP地址/ 以/ 躲避/ 追查/ ./ 与此同时/ ,/ 随着/ 互联网/ 规模/ 急骤/ 增大/ 和/ 用户/ 规模/ 不断/ 增长/ ,/ 这一/ 现象/ 也/ 更加/ 突出/ ./ 据/ 国际电信联盟/ 和/ 中国/ 互联网/ 信息中心/ 的/ 报告/ ,/ 截止/ 到/ 2010/ 年底/ ,/ 全球/ 互联网/ 用户数/ 达/ 20/ 亿/ ⑦/ ,/ 而/ 中国/ 的/ 网民/ 规模/ 已超/ 4.57/ 亿/ ⑧/ ./ 而/ 与此同时/ ,/ 据/ 美国麻省理工学院/ 的/ IPSpoofer/ 项目组/ 统计/ ,/ 截至/ 到/ 2011/ 年/ 7/ 月/ 6/ 日/ ,/ 全球/ 可/ 被/ 假冒/ 的/ 地址/ 块/ 、/ IP地址/ 及/ 自治/ 系统/ 的/ 比例/ 分别/ 达到/ 了/ 10.4/ %/ 、/ 29.8/ %/ 和/ 19.8/ %/ ⑨/ ./ 由于/ IP地址/ 具有/ 身份/ 和/ 位置/ 的/ 双重/ 语义/ ,/ 如果/ ①/ ②/ ③/ ④/ ⑤/ ⑥/ ⑦/ ⑧/ ⑨/ Page3/ 物/ 联网/ 节点/ 的/ 源地址/ 一旦/ 被/ 冒用/ ,/ 那么/ 节点/ 传感器/ 传回/ 数据/ 的/ 真实性/ 将/ 难以/ 保证/ ,/ 这/ 就/ 使/ 该/ 应用/ 场景/ 的/ 安全性/ 大打折扣/ ,/ 甚至/ 可能/ 危及/ 整个/ 系统/ ./ 目前/ ,/ 这个/ 问题/ 的/ 严重性/ 还/ 没有/ 引起/ 研究/ 人员/ 的/ 足够/ 重视/ 和/ 注意/ ./ 基于/ 以上/ 现状/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ IPv6/ 的/ 分布式/ 物/ 联网/ 节点/ 源地址/ 验证/ 机制/ ./ 其/ 贡献/ 在于/ :/ (/ 1/ )/ 在/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 网络/ 环境/ 中/ ,/ 提出/ 了/ 基于/ IPv6/ 的/ 源地址/ 验证/ 方案/ 整体/ 架构/ ;/ (/ 2/ )/ 针对/ 静态/ 指定/ 、/ DHCPv6/ 、/ SLAAC/ 和/ DHCPv6/ 与/ SLAAC/ 混合/ 等/ 地址/ 分配/ 方式/ ,/ 详细描述/ 了/ 物/ 联网/ 节点/ 地址/ 获取/ 、/ 绑定/ 等/ 过程/ 的/ 场景/ 交互/ ,/ 以及/ 地址/ 分配/ 过程/ 中/ 的/ 时序/ 及/ 状态/ 变迁/ 细节/ ;/ (/ 3/ )/ 根据/ 物/ 联网/ 末梢/ 网络/ 中/ 节点/ 规模/ 和/ 地址/ 分配/ 场景/ ,/ 设计/ 了/ 基于/ IPv6/ 的/ 物/ 联网/ 末梢/ 网络/ 分布式/ 源地址/ 验证/ 方案/ ./ 本文/ 在/ 第/ 2/ 节/ 中将/ 概括/ 介绍/ 源地址/ 验证/ 课题/ 上/ 已有/ 的/ 相关/ 工作/ 研究/ ,/ 以便/ 让/ 读者/ 对本/ 研究/ 方向/ 有/ 一个/ 全面/ 的/ 了解/ ;/ 第/ 3/ 节是/ 本文/ 的/ 重点/ ,/ 该节/ 详细/ 介绍/ 了/ 本/ 方案/ 的/ 设计/ 思路/ 和/ 实现/ 细节/ ./ 作者/ 将/ 首先/ 提出/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 源地址/ 验证/ 框架/ ,/ 然后/ 对物/ 联网/ 节点/ 的/ 地址/ 获取/ 方式/ 予以/ 说明/ ,/ 最后/ 对/ 不同/ 地址/ 分配/ 方式/ 下/ 的/ 分布式/ 物/ 联网/ 节点/ 源地址/ 验证/ 方案/ 进行/ 详细/ 阐述/ ./ 此外/ ,/ 与/ 方案/ 相关/ 的/ 问题/ 也/ 在/ 本节/ 进行/ 了/ 讨论/ ;/ 方案/ 的/ 实验/ 模拟/ 及/ 性能/ 评估/ 将/ 在/ 第/ 4/ 节中/ 给出/ ,/ 最后/ 一节/ 我们/ 将/ 对/ 全文/ 进行/ 总结/ ,/ 并/ 说明/ 进一步/ 需要/ 深入研究/ 的/ 工作/ ./ 2/ 相关/ 工作/ 源地址/ 验证/ 是/ 指/ 对/ 终端/ 节点/ 发出/ 的/ IP/ 数据包/ 中/ 的/ 源地址/ 字/ 段/ 数据/ 进行/ 检查和/ 验证/ ,/ 以/ 保证/ 其/ 发送者/ IP地址/ 的/ 真实性/ 和/ 有效性/ ./ 为了/ 达到/ 源地址/ 验证/ 及/ 丢弃/ 假冒/ 数据包/ 的/ 目的/ ,/ 目前/ 已有/ 许多/ 方案/ ,/ 我们/ 简单/ 总结/ 如下/ :/ (/ 1/ )/ 入口/ 过滤/ ./ IngressFiltering/ [/ 8/ ]/ 是/ 一种/ 用于/ 识别/ 和/ 丢弃/ 假冒/ 数据包/ 最/ 常用/ 最/ 直接/ 的/ 办法/ ./ uRPF/ ①/ (/ UnicastReversePathForwarding/ )/ 就是/ 思科公司/ 提出/ 的/ 一种/ 在/ 数据包/ 入口/ 上/ 进行/ 单播/ 反向/ 路由/ 查找/ 以/ 验证/ 和/ 过滤/ 数据包/ 的/ 办法/ ,/ 其/ 主要/ 思想/ 是/ 根据/ 数据包/ 的/ 源地址/ 反查/ 路由表/ ,/ 判断/ 转发/ 端口/ 是否/ 与/ 数据包/ 的/ 入/ 端口/ 一致/ ,/ 从而/ 确定/ 数据包/ 源地址/ 的/ 合法性/ ./ 其/ 缺点/ 是/ 无法/ 防止/ 同方向/ 上/ 的/ 地址/ 假冒/ ,/ 同时/ 路由/ 的/ 非/ 对称性/ 也/ 可能/ 导致/ 假/ 阳性/ 的/ 误判/ ./ SAVI/ ②/ (/ SourceAddressValidationImprovements/ )/ 技术/ 采用/ 在/ 用户/ 接入/ 交换机/ 上/ 嗅/ 探/ 接入/ 主机/ 地址/ 分配/ 协议/ 的/ 方法/ ,/ 实现/ 了/ 主机/ IP/ 和/ MAC/ ,/ 交换机/ 端口/ ,/ 甚至/ 用户名/ 及/ 登录/ 时间/ 等/ 多元/ 信息/ 的/ 绑定/ ,/ 达到/ 了/ 在/ 用户/ 接入/ 交换机/ 中/ 进行/ 假冒/ 数据包/ 过滤/ 的/ 目的/ ,/ 保证/ 了/ 用户/ 身份/ 的/ 可靠性/ ./ 现在/ 已有/ 多家/ 国内/ 厂商/ 开发/ 出其/ 商用/ 产品/ ,/ 但/ 目前/ 仅/ 适用/ 于/ IPv6/ 以太网/ ,/ 并且/ 尚未/ 大规模/ 应用/ ./ (/ 2/ )/ 协议/ 重/ 设计/ ./ SAVE/ [/ 9/ ]/ 方案/ 对/ 路由器/ 及/ 用户/ 主机/ 协议/ 栈/ 进行/ 重新/ 设计/ ,/ 研究/ 出/ 了/ 一整套/ 数据包/ 验证/ 及其/ 路由/ 机制/ ,/ 但/ 该/ 协议/ 过于/ 复杂/ 并且/ 需要/ 修改/ 用户/ 主机/ 协议/ 栈/ ,/ 因此/ 目前/ 无法/ 应用/ 于/ 实际/ ./ 而/ SPM/ [/ 10/ ]/ 、/ Passport/ [/ 11/ ]/ 、/ StackPi/ [/ 12/ ]/ 、/ Base/ [/ 13/ ]/ 等/ 方案/ 在/ IP/ 包头/ 中/ 的/ ToS/ 或/ 其它/ 较/ 少/ 使用/ 的/ 选项/ 字/ 段/ 加入/ 用户/ 身份/ 鉴别/ 标签/ ,/ 当/ 数据包/ 出/ 自治/ 域/ 或/ 管理/ 范围/ 时/ 使用/ 专用设备/ 进行/ 验证/ 并/ 去/ 标签/ ,/ 其/ 缺点/ 是/ 假冒者/ 可以/ 学习/ 标签/ 的/ 添加/ 方法/ ,/ 从而/ 逃避/ 验证/ ./ 另外/ 对/ 数据包/ 包头/ 字段/ 的/ 修改/ 可能/ 会/ 影响/ 自治/ 域/ 内/ 包括/ QoS/ 在内/ 的/ 其它/ 特殊/ 应用/ ./ HIP/ [/ 14/ ]/ 方案/ 则/ 是/ 修改/ 用户/ 终端/ 主机/ 协议/ 栈/ ,/ 在/ IP/ 和/ 传输层/ 之间/ 添加/ “/ 主机/ 标识/ 层/ ”/ ,/ 通过/ 分离/ 主机/ IP地址/ 身份/ 和/ 位置/ 语义/ ,/ 从而/ 达到/ 了/ 源地址/ 验证/ 、/ 加密/ 和/ 扩展性/ 的/ 目的/ ,/ 但/ 端系统/ 的/ 修改/ 、/ 应用/ 还/ 存在/ 着/ 实际困难/ ./ (/ 3/ )/ 源地址/ 加密/ 和/ 跳数/ 推测/ ./ TrueIP/ [/ 15/ ]/ 、/ CGA/ [/ 16/ ]/ 、/ AIP/ [/ 17/ ]/ 等/ 方案/ 将/ 数据包/ 中/ 的/ 源地址/ 用/ 加密/ 后/ 的/ 地址/ 信息/ 取代/ ,/ 以/ 达到/ 识别/ 、/ 验证/ 和/ 防止/ 篡改/ 的/ 目的/ ,/ 但/ 其/ 缺点/ 是/ 需要/ 引入/ 密钥/ 管理/ 服务器/ ,/ 对/ 源地址/ 与/ 对应/ 加密/ 后/ 的/ 地址/ 进行/ 映射/ 和/ 查询/ ,/ 因此/ 引入/ 了/ 额外/ 的/ 开销/ ,/ 甚至/ 有/ 可能/ 成为/ 网络/ 瓶颈/ 点/ ./ 还有/ 方案/ [/ 18/ ]/ 对/ 数据包/ 中/ 的/ TTL/ 值/ 进行/ Hop/ 推测/ ,/ 通过/ 逐步/ 学习/ 建立/ 起/ 正常/ 数据包/ 跳数/ 范围/ 取值/ 区间/ ,/ 对于/ TTL/ 值/ 明显/ 偏离/ 取值/ 范围/ 的/ 数据包/ 则/ 判定/ 为/ 假冒/ 源地址/ 数据包/ ./ 这一/ 方法/ 存在/ 着/ 明显/ 的/ 假/ 阳性/ 或/ 假/ 阴性/ 的/ 可能/ ,/ 从而/ 会/ 造成/ 误判/ 或/ 漏判/ ./ (/ 4/ )/ 整体/ 方案/ ./ 清华大学/ 吴建平/ 教授/ 等/ 人/ 提出/ 了/ SAVA/ [/ 19/ ]/ (/ SourceAddressValidationArchitec/ -/ ture/ )/ 源地址/ 验证/ 整体/ 方案/ 框架/ (/ RFC5210/ )/ ,/ 该/ 方案/ 将/ 互联网/ 整个/ 源地址/ 验证/ 级别/ 分为/ 三/ 部分/ :/ 接入/ 子网/ 验证/ 、/ 域/ 内/ 验证/ 和域/ 间/ 验证/ ./ 不同/ 的/ 级别/ 达到/ 不同/ ①/ ②/ Page4/ 的/ 验证/ 粒度/ :/ 接入/ 子网/ 达到/ 了/ 端系统/ 用户/ 主机/ 的/ 验证/ ;/ 域/ 内/ 验证/ 达到/ 了域/ 内/ 子网/ IP/ 前缀/ 粒度/ 验证/ ;/ 域间/ 验证/ 达到/ 了/ AS/ 粒度/ 的/ 验证/ ./ SAVA/ 在/ 每个/ 别级/ 均/ 有/ 相应/ 的/ 子/ 方案/ ./ 目前/ ,/ 该/ 方案/ 正/ 逐步/ 部署/ 到/ 我国/ 最大/ 的/ 纯/ IPv6/ 网络/ CNGI/ -/ CERNET2/ ./ 由于/ 物/ 联网/ 是/ 一种/ 新兴/ 的/ 网络/ 形态/ ,/ 并且/ 物/ 联网/ 节点/ 在/ 引入/ IP地址/ 后/ ,/ 如何/ 防止/ 源地址/ 假冒/ 的/ 问题/ 还/ 并未/ 得到/ 研究/ 和/ 重视/ ./ 因此/ ,/ 到/ 目前为止/ ,/ 还/ 没有/ 适用/ 于物/ 联网/ 环境/ 的/ 源地址/ 验证/ 研究/ 文献/ ./ 本/ 方案/ 是/ 一种/ 基于/ SAVA/ ,/ 适应/ 于/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 环境/ 下/ 的/ 源地址/ 验证/ 整体/ 方案/ ./ 3/ 基于/ IPv6/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 源地址/ 验证/ 方案/ 根据/ 物/ 联网/ 是/ “/ 按照/ 约定/ 的/ 协议/ ,/ 把/ 任何/ 物品/ 与/ 互联网/ 连接起来/ ,/ 进行/ 信息/ 交换/ 和/ 通信/ ,/ 以/ 实现/ 智能化/ 识别/ 、/ 定位/ 、/ 跟踪/ 、/ 监控/ 和/ 管理/ 的/ 目的/ ,/ 是/ 在/ 互联网/ 基础/ 上/ 延伸/ 和/ 扩展/ 的/ 网络/ ”/ [/ 20/ ]/ 的/ 定义/ ,/ 我们/ 对物/ 联网/ 及其/ 源地址/ 验证/ 方案/ 有/ 如下/ 认识/ :/ (/ 1/ )/ 与/ 互联网/ 的/ 概念/ 类似/ ,/ 物/ 联网/ 也/ 是/ 唯一/ 的/ ,/ 任何/ 物品/ 能/ 连接/ 到/ 以/ IPv6/ 为/ 核心/ 的/ 互联网/ 上/ ,/ 形成/ 的/ 一种/ 智能/ 网络/ ;/ (/ 2/ )/ 物/ 联网/ 节点/ 应/ 具有/ IPv6/ 地址/ ;/ (/ 3/ )/ 物/ 联网/ 的/ 核心/ 应是/ 以/ IPv6/ 为/ 基础/ 的/ 互联网/ ,/ 但/ 不/ 排除/ 物/ 联网/ 节点/ 能/ 通过/ 互联网/ 的/ 双向/ 翻译/ 网关/ 或/ 隧道/ 机制/ 与/ 传统/ 的/ IPv4/ 终端/ 主机/ 通信/ ;/ (/ 4/ )/ 由物/ 联网/ 节点/ 组成/ 的/ 局部/ 网络/ 接入/ 在/ 互联网/ 的/ 边缘/ ,/ 我们/ 称之为/ 物/ 联网/ 接入/ 子网/ 或物/ 联网/ 末梢/ 网络/ ./ 由/ 互联网/ 及/ 全部/ 物/ 联网/ 接入/ 子网/ 所/ 组成/ 的/ 网络/ ,/ 对物/ 而言/ ,/ 我们/ 称之为/ 物/ 联网/ ,/ 对/ IPv6/ 为/ 核心/ 的/ 互联网/ ,/ 我们/ 称之为/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ ;/ (/ 5/ )/ 在/ 物/ 联网/ 节点/ 中/ ,/ 有/ 一部分/ 节点/ 自身/ 具备/ 一个/ 或/ 多个/ 传感器/ ,/ 并/ 将/ 传感器/ 采集/ 的/ 数据/ 上报/ 给/ 互联网/ 的/ 终端/ 主机/ ,/ 并/ 与/ 之/ 进行/ 端到/ 端的/ 通信/ ,/ 我们/ 称/ 这些/ 节点/ 为物/ 联网/ 传感器/ 节点/ ;/ 而/ 还有/ 一部分/ 节点/ 本身/ 并/ 不/ 具有/ 传感器/ ,/ 也/ 不/ 进行/ 环境/ 数据/ 的/ 收集/ ,/ 但/ 它们/ 的/ CPU/ 、/ 内存/ 以及/ 电力/ 等/ 资源/ 较/ 传感器/ 节点/ 相对/ 充足/ ./ 它们/ 运行/ 物/ 联网/ 路由/ 协议/ ,/ 对/ 传感器/ 节点/ 收发/ 的/ 数据/ 进行/ 中继/ 传输/ ,/ 从而/ 保证/ 传感器/ 节点/ 能/ 与/ 互联网/ 上/ 终端/ 主机/ 进行/ 通信/ ,/ 我们/ 称之为/ 物/ 联网/ 可/ 路由/ 节点/ ;/ (/ 6/ )/ 因/ 6LowPAN/ 标准规定/ 物/ 联网/ 物理层/ 最大/ 只能/ 支持/ 127/ 字节/ 的/ 数据包/ ,/ 因此/ 物/ 联网/ 节点/ 只能/ 运行/ 轻量级/ IPv6/ 协议/ ,/ 而/ 互联网/ 以太网/ 上/ IPv6/ 的/ 最大/ 传输/ 单元/ (/ MTU/ )/ 为/ 1500/ 字节/ ,/ 因此/ 物/ 联网/ 接入/ 子网/ 连接/ 到/ 互联网/ 、/ 并/ 与/ 互联网/ 主机/ 进行/ 端到/ 端/ 数据通信/ 过程/ 中/ ,/ 必须/ 在/ 其/ 互联/ 的/ 位置/ 使用/ 专门/ 的/ 设备/ 进行/ 协议/ 的/ 翻译/ 转换/ ,/ 我们/ 称/ 这种/ 设备/ 为/ 多/ 协议/ 网关/ ./ 它/ 与/ 末梢/ 网络/ 通过/ 无线/ 方式/ 进行/ 通信/ ,/ 通过/ 有/ 线或/ 无线/ 的/ 方式/ 与/ 接入/ 互联网/ 进行/ 连接/ ./ 另外/ ,/ 在/ 本文/ 中/ ,/ 物/ 联网/ 节点/ 在/ 末梢/ 网络/ 中均/ 使用/ 64/ 位/ IP地址/ ./ 因此/ 多/ 协议/ 网关/ 除了/ 要/ 完成/ 协议/ 的/ 双向/ 翻译/ 外/ ,/ 还/ 必须/ 完成/ IP地址/ 补齐/ 和/ 去/ 前/ 辍/ 的/ 工作/ ./ (/ 7/ )/ 依据/ 物/ 联网/ 接入/ 子网/ 的/ 规模/ 大小/ 以及/ 物/ 联网/ 可/ 路由/ 节点/ 与物/ 联网/ 传感器/ 节点/ 间/ 的/ 位置/ 关系/ ,/ 我们/ 将物/ 联网/ 接入/ 子网/ 又/ 分为/ 3/ 种/ :/ 单跳/ 网络/ 、/ 层级/ 网络/ 和/ 多/ 跳/ 网络/ ./ 单跳/ 网络/ 是/ 指/ 所有/ 的/ 传感器/ 节点/ 数据/ 只/ 需/ 经过/ 至多/ 一个/ 可/ 路由/ 节点/ 就/ 能/ 到达/ 多/ 协议/ 网关/ (/ 如图/ 1/ 所示/ )/ ;/ 多/ 跳/ 网络/ 是/ 指/ 一部分/ 传感器/ 节点/ 无法/ 直接/ 与/ 可/ 路由/ 节点/ 进行/ 通信/ ,/ 必须/ 通过/ 传感器/ 节点/ 间/ 中继/ 传输/ ,/ 在/ 一个/ 或/ 多个/ 可/ 路由/ 节点/ 的/ 转发/ 下/ 与/ 互联网/ 节点/ 进行/ 通信/ (/ 如图/ 2/ 所示/ )/ ;/ 层级/ 网/ Page5/ 络/ 是/ 单/ 跳/ 网络/ 的/ 扩展/ ,/ 是/ 指/ 所有/ 的/ 传感器/ 节点/ 都/ 能/ 直接/ 与/ 自己/ 所/ 覆盖/ 的/ 可/ 路由/ 节点/ 进行/ 通信/ ,/ 但/ 数据/ 至少/ 需要/ 一个/ 以上/ 的/ 可/ 路由器/ 节点/ 进行/ 中继/ 传输/ 才能/ 到达/ 多/ 协议/ 网关/ (/ 如图/ 3/ 所示/ )/ ./ 物/ 联网/ 与/ 互联网/ 的/ 主要/ 对/ 比如/ 表/ 1/ 所示/ ./ 图/ 4/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 源地址/ 验证/ 架构/ 方案/ (/ 2/ )/ 在/ 自治/ 域/ 内/ ,/ 网络/ 运行/ OSFP/ 、/ RIP/ 、/ IS/ -/ IS/ 等/ 路由/ 协议/ ,/ 采用/ 域/ 内/ 源地址/ 验证/ 方案/ ,/ 保证/ 域/ 内/ 子网/ 间/ 主机/ 无法/ 互相/ 假冒/ ,/ 具体/ 的/ 方案/ 有/ SAVT/ [/ 22/ ]/ 等/ ./ (/ 3/ )/ 在/ 用户/ 接入/ 子网/ 内/ ,/ 采用/ SAVI/ 交换机/ 技术/ ,/ 保证/ 用户/ 身份/ 及/ 主机/ 真实/ 可靠/ ,/ 达到/ 主机/ 粒度/ 的/ 验证/ 级别/ ./ (/ 4/ )/ 在/ 物/ 联网/ 接入/ 子网/ 内/ ,/ 可/ 路由/ 节点/ 运行/ RPL/ ①/ 等/ 路由/ 协议/ ,/ 采用/ 本文/ 所/ 提出/ 的/ 分布式/ 源地/ 对比/ 点/ 主要/ 目标/ 物物/ 相连/ ,/ 数据交换/ 主机/ 互连/ ,/ 高速通信/ 主要/ 组成/ 传感器/ 节点/ 、/ 可/ 路由/ 节点/ 主机/ 、/ 交换机/ 、/ 路由器/ 地址/ 格式/ IPv6/ 或/ 轻量级/ IPv6/ 体系/ 架构/ 6LoWPAN/ ,/ ZigBee/ 路由/ 协议/ 物理层/ RFID/ ,/ Bluetooth/ ,/ 802.11/ ,/ MTU/ 子网/ 形式/ 单跳/ 、/ 层级/ 、/ 多/ 跳/ 网络/ 星形/ 、/ 环形/ 、/ 总线/ 型/ 等/ 地址/ 验证/ 末梢/ 网络/ 分布式/ 验证/ 接入/ 、/ 域/ 内/ 、/ 域间/ 验证/ 3.1/ 融合/ 物/ 联网/ 的/ 下一代/ 互联网/ 源地址/ 验证/ 框架/ 基于/ 以上/ 认识/ ,/ 结合/ SAVA/ 框架/ ,/ 我们/ 提出/ 了/ 如图/ 4/ 所示/ 的/ 融合/ 物/ 联网/ 的/ 新一代/ 互联网/ 源地址/ 验证/ 架构/ ,/ 该/ 方案/ 具有/ 4/ 个/ 层次/ :/ (/ 1/ )/ 在/ 自治/ 域间/ ,/ 运行/ BGP/ 路由/ 协议/ 的/ IPv6/ 骨干/ 网络/ 采用/ 域间/ 源地址/ 验证/ 方案/ ,/ 保证/ 从/ 自治/ 域/ 发出/ 的/ 数据/ 分组/ 中/ 的/ 源地址/ 具有/ 真实/ 可靠性/ ,/ 达到/ 自治/ 域/ 粒度/ 的/ 验证/ 级别/ ,/ 具体/ 的/ 方案/ 有/ SMA/ [/ 21/ ]/ 等/ ./ 址/ 验证/ 方案/ ,/ 保证/ 物/ 联网/ 传感器/ 节点/ IP地址/ 的/ 真实/ 可靠性/ ,/ 达到/ 传感器/ 节点/ 粒度/ 的/ 验证/ 级别/ ./ 3.2/ 物/ 联网/ IPv6/ 接入/ 子网/ 分布式/ 源地址/ 验证/ 方案/ 由于/ 源地址/ 验证/ 方案/ 是/ 与/ IP地址/ 分配/ 方式/ 密切相关/ 的/ ,/ 因此/ 在/ 介绍/ 物/ 联网/ 接入/ 子网/ 分布式/ 源地/ ①/ WinterTetal/ ./ RPL/ :/ IPv6RoutingProtocolforLowPow/ -/ ietf/ -/ roll/ -/ rpl/ -/ 19Page6/ 址/ 方案/ 之前/ ,/ 我们/ 必须/ 对物/ 联网/ 节点/ 地址/ 的/ 分配/ 方式/ 及其/ 验证/ 方式/ 同时/ 进行/ 分析/ ./ 在/ 地址/ 分配/ 方式/ 上/ ,/ 目前/ 在/ IPv6/ 互联网/ 中/ ,/ 有/ 静态/ 地址/ 分配/ 、/ 无/ 状态/ 的/ 地址/ 配置/ (/ StatelessAddressAutoConfiguration/ ,/ SLAAC/ [/ 23/ ]/ )/ 、/ 有/ 状态/ 的/ 地址/ 配置/ (/ DynamicHostConfigurationProtocolVersion6/ ,/ DHCPv6/ [/ 24/ ]/ )/ 和/ DHCPv6/ 与/ SLAAC/ 混合/ 的/ 4/ 种/ 地址/ 分配/ 方式/ ./ 而/ 在/ 验证/ 方式/ 上/ ,/ 有/ 集中式/ 和/ 分布式/ 两种/ 方案/ ./ 集中式/ 是/ 指在物/ 联网/ 接入/ 子网/ 连接/ 的/ 互联网/ 管理网络/ 内/ 增加/ 一台/ 物/ 联网/ 节点/ 源地址/ 管理/ 服务器/ ,/ 管理员/ 将/ 传感器/ 节点/ 的/ EPC/ (/ ElectronicProductCode/ 节点/ 对象/ 的/ 唯一/ 标识/ )/ 编码/ 、/ MAC/ 地址/ 以及/ IP地址/ 等/ 提前/ 输入/ 到/ 服务器/ 的/ 绑定/ 表中/ ,/ 而/ 传感器/ 节点/ 网络接口/ 地址/ 在/ 启用/ 前/ ,/ 必须/ 向/ 服务器发送/ 数据包/ 进行/ 自身/ IP地址/ 验证/ ,/ 而/ 多/ 协议/ 网关/ 将/ 监听/ 该/ 过程/ 并/ 记录/ 验证/ 返回/ 的/ 结果/ ,/ 进而/ 放行/ 或/ 阻止/ 携带/ 该/ IP/ 的/ 数据/ 分组/ 通过/ (/ 当然/ ,/ 多/ 协议/ 网关/ 也/ 可/ 充当/ 源地址/ 管理/ 服务器/ 的/ 角色/ )/ ./ 集中式/ 方案/ 的/ 优点/ 是/ 对/ 节点/ 资源/ 没有/ 影响/ ,/ 但/ 其/ 缺点/ 是/ 只能/ 保证/ 该/ 接入/ 子网/ IP/ 前缀/ 级/ 的/ 真实性/ ,/ 而/ 不能/ 防止/ 子网/ 内部/ 的/ 互相/ 仿冒/ ,/ 而/ 这/ 并/ 不/ 符合/ 我们/ 的/ 设计/ 目标/ ./ 由于/ 每/ 一个/ 物/ 联网/ 可/ 路由/ 节点/ 覆盖/ 一定/ 的/ 区域/ ,/ 并/ 承载/ 对/ 该/ 区域/ 内/ 传感器/ 节点/ 数据/ 中继/ 传输/ 的/ 功能/ ,/ 因此/ 分布式/ 方案/ 是/ 利用/ 可/ 路由/ 节点/ ,/ 验证/ 选择/ 其/ 作为/ 第一/ 跳/ 接入/ 路由/ 节点/ 的/ 传感器/ 节点/ 的/ IP地址/ 的/ 有效性/ ./ 在/ 物/ 联网/ 可/ 路由/ 节点/ 中/ ,/ 在/ 控制/ 层面/ 上/ 存在/ 一个/ 绑定/ 状态表/ BST/ (/ BindingStatusTable/ )/ ,/ 用于/ 监听/ 和/ 维护/ 传感器/ 节点/ 地址/ 绑定/ 状态/ ,/ 主要/ 字段/ 有/ 〈/ Index/ ,/ EPC/ ,/ IP/ ,/ MAC/ ,/ State/ ,/ Lifetime/ ,/ Other/ 〉/ ,/ 其中/ Index/ 为/ 序号/ ,/ 长度/ 为/ 8/ 位/ ,/ 范围/ 为/ 1/ ~/ 256/ ;/ EPC/ 编码/ 是/ 节点/ 对象/ 的/ 唯一/ 标识/ ,/ 由/ 64/ ,/ 96/ 或/ 256/ 位/ 组成/ ;/ IP/ 为/ 节点/ 网络层/ 的/ 地址/ ,/ 类型/ 为/ link/ -/ local/ 或/ global/ ,/ 省去/ 网络/ 前/ 辍/ ,/ 长度/ 为/ 64/ 位/ ;/ MAC/ 为/ 节点/ 在/ 数据/ 链路层/ 的/ 地址/ ,/ 长度/ 为/ 48/ 位/ ;/ State/ 为/ 地址/ 的/ 绑定/ 状态/ ,/ 长度/ 为/ 1/ 个/ 字节/ ,/ 可/ 表达/ 256/ 种/ 状态/ ,/ 其值/ 可为/ 手动/ 静态/ 绑定/ :/ Sta/ _/ Bound/ (/ 0/ )/ ,/ SLAAC/ 监听/ :/ SLA/ _/ SNP/ (/ 1/ )/ ,/ SLAAC/ 绑定/ :/ SLA/ _/ Bound/ (/ 2/ )/ ,/ DHCP/ 监听/ :/ DHCP/ _/ SNP/ (/ 3/ )/ ,/ DHCP/ 绑定/ :/ DHCP/ _/ Bound/ (/ 4/ )/ 等/ ;/ Lifetime/ 是/ 每个/ 状态/ 下/ 的/ 生存/ 时间/ ,/ 如/ DHCP/ 地址/ 续存/ 时间/ 等/ ,/ 长度/ 为/ 2/ 个/ 字节/ ;/ Other/ 为/ 保留字/ 段/ ./ 同时/ ,/ 可/ 路由/ 节点/ 在/ 数据/ 层面/ 上/ 还/ 存在/ 一个/ 过滤/ 表/ FT/ (/ FilteringTable/ )/ ,/ 用来/ 对/ 转发/ 的/ 数据包/ 进行/ 过滤/ ,/ 只有/ 匹配/ 过滤/ 表中/ 登记/ 的/ IP地址/ 的/ 数据包/ 才/ 予以/ 转发/ ,/ 字段/ 有/ 〈/ Index/ ,/ IP/ 〉/ ,/ 其中/ Index/ 为/ 序号/ ,/ 其值/ 与/ 绑定/ 表中/ 的/ 序号/ 一致/ ;/ IP/ 为/ 绑定/ 表中/ 状态/ 为/ 绑定/ 成功/ 的/ 网络层/ 地址/ ./ 我们/ 将/ 具体/ 讨论/ 物/ 联网/ 传感器/ 节点/ 的/ 四种/ 地址/ 分配/ 方式/ 及其/ 分布式/ 验证/ 方式/ ./ 3.2/ ./ 1/ 静态/ 地址/ 分配/ 及/ 验证/ 方式/ 节点/ 静态/ 地址/ 分配/ 适用/ 于物/ 联网/ 接入/ 子网/ 规模/ 不是/ 很大/ ,/ 管理员/ 能/ 将/ 每个/ 节点/ 的/ 地址/ 预先/ 配置/ 后/ 再/ 进行/ 部署/ ./ 在/ 这种/ 情况/ 下/ ,/ 有/ 两种/ 方法/ 支持/ 节点/ 的/ 源地址/ 验证/ ./ (/ 1/ )/ 与/ 集中式/ 验证/ 类似/ ,/ 管理网络/ 内需/ 增加/ 一台/ 地址/ 管理/ 服务器/ ,/ 管理员/ 将/ 传感器/ 节点/ 的/ EPC/ 编码/ 、/ MAC/ 地址/ 以及/ IP地址/ 事先/ 配置/ 到/ 服务器/ 的/ 绑定/ 表中/ ./ 传感器/ 节点/ 网络接口/ 地址/ 启用/ 前/ ,/ 首先/ 需要/ 发送/ 重复/ 地址/ 检测/ 的/ 邻居/ 请求/ DAD/ (/ DuplicateAd/ -/ dressDetection/ )/ -/ NS/ (/ NeighborSolicitation/ )/ 报文/ ,/ 以/ 验证/ 自身/ IP地址/ 的/ 合法性/ ,/ 覆盖/ 该/ 节点/ 的/ 可/ 路由/ 节点/ 充当/ DAD/ -/ Proxy/ ,/ 将/ DAD/ -/ NS/ 报文/ 转发/ 至多/ 协议/ 网关/ ,/ 由/ 多/ 协议/ 网关/ 翻译/ 并/ 将/ 报文/ 转/ 交给/ 验证/ 服务器/ ,/ 得到/ 验证/ 服务器/ 的/ 确认/ 回复/ 后/ ,/ 可/ 路由/ 节点/ 建立/ 该/ 节点/ 的/ 绑定/ 关系/ 和/ 过滤/ 表/ 条目/ ,/ 之后/ 匹配/ 过滤/ 表中/ 的/ IP地址/ 均/ 可以/ 直接/ 发送数据/ 分组/ ./ 其/ 节点/ 地址/ 验证/ 场景/ 如图/ 5/ 所示/ ./ 图/ 5/ 物/ 联网/ 节点/ 静态/ 方式/ 源地址/ 验证/ 场景/ 示意图/ (/ 2/ )/ 管理员/ 事先/ 在/ 可/ 路由/ 节点/ 中/ 建立/ 传感器/ 节点/ 的/ 绑定/ 属性/ 关系/ 并/ 生成/ 过滤/ 表/ ,/ 匹配/ 的/ IP/ 数据包/ 可以/ 直接/ 转发/ ,/ 不/ 匹配/ 或/ 不/ 存在/ 于/ 过滤/ 表项/ 的/ IP地址/ 将/ 被/ 过滤/ ./ Page73/ ./ 2.2/ SLAAC/ 地址/ 分配/ 及/ 验证/ 方式/ SLAAC/ 无/ 状态/ 地址/ 分配/ 是/ 一种/ 无/ 状态/ 、/ 采用/ ICMPv6/ 进行/ 的/ 地址/ 配置/ 方式/ ,/ 在/ 传统/ 互联网/ 中/ 主要/ 经历/ 3/ 个/ 过程/ ./ (/ 1/ )/ 终端/ 发起/ NS/ 报文/ 以/ 请求/ 网络/ 配置/ 参数/ ,/ 终端/ 接入/ 路由器/ 回复/ NA/ (/ NeighborAdvertisement/ )/ 报文/ ,/ 将/ 长度/ 为/ 64/ 位/ 的/ 网络/ 前缀/ 等/ 参数/ 返回/ ./ (/ 2/ )/ 终端/ 再/ 将/ 自己/ 48/ 位/ 的/ MAC/ 地址映射/ 为/ 64/ 位/ 的/ IEEEEUI/ -/ 64/ 地址/ 后/ [/ 25/ ]/ ,/ 与/ 网络/ 前缀/ 一起/ 形成/ 128/ 位/ 的/ IP地址/ 并/ 进行/ 配置/ ./ (/ 3/ )/ 使用/ 该/ 地址/ 前/ ,/ 终端/ 还/ 需要/ 发出/ DAD/ -/ NS/ 报文/ 进行/ 重复/ 地址/ 检测/ ,/ 若/ 一段时间/ 内/ 无/ 响应/ ,/ 则/ 地址/ 可用/ ./ 为了/ 节省/ 带宽/ 、/ 减少/ 资源/ 消耗/ ,/ 针对/ 物/ 联网/ 特点/ ,/ 我们/ 对/ SLAAC/ 协议/ 进行/ 了/ 简化/ ,/ 具体做法/ 是/ 省去/ 以上/ 过程/ 的/ 第一个/ 步骤/ ,/ 即/ 传感器/ 节点/ 在/ 形成/ 64/ 位/ 的/ EUI/ 地址/ 后/ ,/ 直接/ 发出/ DAD/ -/ NS/ 报文/ ,/ 之后/ 与/ 静态/ 地址/ 验证/ 场景/ 方式/ (/ 1/ )/ 类似/ ,/ 可/ 路由/ 节点/ 充当/ DAD/ -/ Proxy/ ,/ 向/ 源地址/ 验证/ 服务器/ 中继/ 请求/ ,/ 并/ 由/ 源地址/ 验证/ 服务器返回/ 正确/ 的/ 验证/ 后/ ,/ 覆盖/ 该/ 传感器/ 节点/ 的/ 可/ 路由/ 节点/ 建立/ 对/ 该/ 传感/ 节点/ 的/ 绑定/ 和/ 过滤/ 表项/ ,/ 不再/ 赘述/ ./ 3.2/ ./ 3DHCPv6/ 地址/ 分配/ 及/ 验证/ 方式/ DHCPv6/ 是/ 一种/ 有/ 状态/ 、/ 采用/ C/ // S/ 模式/ 和/ UDP/ 报文/ 交互/ 的/ 地址/ 分配/ 方式/ ./ 在/ 传统/ 互联网/ 中/ ,/ 通过/ DHCPv6/ 获取/ 地址/ 一般/ 要/ 经过/ 5/ 个/ 过程/ ./ (/ 1/ )/ 客户端/ 首先/ 发送/ 一个/ DHCPSolicit/ 消息/ 到/ 一个/ 特定/ 多播/ 地址/ (/ FF02/ :/ :/ 1/ :/ 2/ ,/ UDP/ 端口/ 547/ )/ ,/ 查找/ 可用/ 的/ DHCP/ 服务器/ ./ 若/ DHCP/ 服务器/ 和/ 客户端/ 并/ 不/ 在/ 一个/ 接入/ 子网/ 内/ ,/ 则/ 由/ 路由器/ 进行/ 报文/ 中继/ ./ 整个/ 过程/ 中/ ,/ 中继/ 代理/ 对于/ 客户端/ 是/ 透明/ 的/ ./ (/ 2/ )/ 所有/ 符合/ 客户端/ 要求/ 的/ DHCP/ 服务器/ 以/ DHCPAdvertise/ 消息/ 进行/ 单播/ 应答/ ,/ 返回/ 给/ 客户端/ ./ (/ 3/ )/ 客户端/ 从/ 所有/ 应答/ 的/ 服务器/ 中/ 选择/ 一个/ (/ 通常/ 是/ 最先/ 到达/ 报文/ 所/ 指向/ 的/ 服务器/ )/ ,/ 并/ 向/ 它/ 发送/ DHCPRequest/ 消息/ 来/ 获取/ 地址/ 和/ 其它/ 配置/ 信息/ ./ (/ 4/ )/ 被/ 选择/ 的/ 服务器/ 以/ 携带/ 了/ 被/ 请求/ 的/ 配置/ 信息/ (/ IP地址/ 、/ DNS/ 、/ 子网掩码/ 等/ )/ 的/ DHCPReply/ 消息/ 进行/ 应答/ ./ (/ 5/ )/ 客户端/ 根据/ 返回/ 的/ 参数/ 配置/ 网络接口/ ,/ 并/ 进行/ 重复/ 地址/ 请求/ DAD/ -/ NS/ ,/ 如果/ 在/ 一段时间/ 内/ 无/ 任何/ 响应/ ,/ 则/ 该/ 地址/ 可用/ ./ 同时/ 所/ 获取/ 的/ IP地址/ 都/ 存在/ 由/ 服务器/ 指定/ 的/ 更新/ 时间/ 和/ 有效/ 时间/ ./ 当时/ 钟/ 到达/ 更新/ 时间/ ,/ 客户端/ 必须/ 向/ 服务器发送/ 一个/ DHCPRenew/ 消息/ 来/ 续租/ 该/ 地址/ ,/ 服务器/ 再/ 向/ 客户端/ 返回/ 一个/ 带有/ 新/ 的/ 更新/ 时间/ 的/ DHCPReply/ 消息/ ./ 如此/ 反复/ ,/ 客户端/ 就/ 可以/ 一直/ 使用/ 该/ 地址/ ./ 如果/ 客户端/ 过/ 了/ 有效/ 时间/ ,/ 服务器/ 仍/ 未/ 收到/ 客户端/ 的/ Renew/ 报文/ ,/ 那么/ 客户端/ 的/ 地址/ 就/ 予以/ 作废/ ,/ 而/ 需要/ 重做/ 以上/ 过程/ 申请/ 新/ 的/ 地址/ ./ 根据/ 物/ 联网/ 的/ 特点/ ,/ 我们/ 对/ DHCPv6/ 过程/ 进行/ 了/ 简化/ ,/ 省去/ 第一/ 和/ 第二步/ 并/ 做出/ 改进/ ,/ 具体/ 过程/ 是/ :/ (/ 1/ )/ 传感器/ 节点/ 发出/ DHCPRequest/ 到/ 多播/ 地址/ FF02/ :/ :/ 1/ :/ 2/ ,/ UDP/ 端口/ 547/ ;/ 可/ 路由/ 节点/ 中继/ 该/ 请求/ ,/ 并/ 直接/ 将/ 该报/ 文/ 发送至/ 多/ 协议/ 网关/ ;/ 之后/ ,/ 多/ 协议/ 网关/ 再/ 将/ 该报/ 文/ 翻译/ 后/ ,/ 单播/ 发送至/ DHCPv6/ 服务器/ ./ (/ 2/ )/ DHCPv6/ 服务器/ 将/ 配置/ 信息/ 以/ DHCPReply/ 消息/ 进行/ 应答/ 给/ 多/ 协议/ 网关/ ;/ 多/ 协议/ 网关/ 翻译/ 后/ 单播/ 发送至/ 请求/ 的/ 传感器/ 节点/ ./ (/ 3/ )/ 传感器/ 节点/ 收到/ 配置/ 信息/ 后/ ,/ 发出/ DAD/ -/ NS/ 报文/ 进行/ 重复/ 地址/ 恳请/ ,/ 在/ 一段时间/ 内/ 无/ 响应/ 即可/ 使用/ 该/ 地址/ ./ 发出请求/ 的/ 传感器/ 节点/ 的/ 第一/ 跳/ 可/ 路由/ 节点/ 将/ 监听/ 传感器/ 节点/ DHCP/ 获取/ 地址/ 的/ 整个/ 过程/ ,/ 在/ 最后/ DAD/ -/ NS/ 超时/ 无/ 回复/ 情况/ 下/ 建立/ 绑定/ 关系/ 并/ 生成/ 过滤/ 表项/ ./ 此外/ ,/ 需要/ 指出/ 的/ 是/ ,/ 在/ 绑定/ 关系/ 建立/ 后/ ,/ 可/ 路由/ 节点/ 还/ 应/ 向/ 绑定/ 的/ 节点/ 定期/ 发送/ 探测/ (/ Probe/ )/ 报文/ ,/ 其/ 主要/ 作用/ 有/ 两点/ :/ (/ 1/ )/ 对/ 节点/ 有效性/ 探测/ ,/ 以/ 防止/ 节点/ 的/ 移动/ 或/ 不可/ 达/ 造成/ 地址/ 浪费/ ./ 探测/ 可/ 通过/ 发送/ NUD/ (/ NeighborUnreachabilityDetection/ )/ 报文/ 完成/ ;/ (/ 2/ )/ 保持/ 绑定/ 关系/ ,/ 以/ 防止/ 因为/ 某些/ 节点/ 长期/ 不/ 进行/ 数据/ 发送/ 而/ 造成/ 地址/ 错误/ 回收/ 的/ 现象/ ,/ 可以/ 通过/ NA/ 报文/ 完成/ ./ 其/ 场景/ 示意/ 如图/ 6/ 所示/ ,/ 时序/ 图/ 和/ 状态/ 变迁/ 如图/ 7/ 、/ 图/ 8/ 所示/ ./ 其中/ 状态/ 变迁/ 图中/ 存在/ 的/ 6/ 个/ 状态/ 分别/ 是/ 地址/ 对应/ 的/ DADNS/ ./ -/ -/ :/ 初态/ ./ START/ :/ 客户端/ 发出/ DHCPRequest/ ,/ 即将/ 触/ LIVE/ :/ DHCP/ 地址/ 被/ DHCPServer/ 告知/ ./ DETECTION/ :/ 可/ 路由/ 节点/ 收到/ 或者/ 主动/ 发送/ BOUND/ :/ 客户端/ 的/ 地址/ 通过/ 了/ 冲突检测/ ,/ 建立/ QUERY/ :/ 可/ 路由/ 节点/ 询问/ 绑定/ 的/ 无/ 状态/ 地址/ 是否/ 依然/ 在/ 使用/ ./ 3.2/ ./ 4DHCPv6/ 与/ SLAAC/ 的/ 混合/ 地址/ 分配/ 方式/ 还有/ 一种/ 是/ 将/ DHCPv6/ 和/ SLAAC/ 结合/ 的/ 混发/ 绑定/ ./ 了/ 绑定/ ./ Page8/ 图/ 6/ 物/ 联网/ 节点/ DHCPv6/ 方式/ 源地址/ 验证/ 场景/ 示意图/ 图/ 7/ 物/ 联网/ 节点/ DHCPv6/ 方式/ 源地址/ 验证/ 过程/ 时序/ 图合/ 地址/ 分配/ 方式/ ,/ 这是/ 一种/ 介于/ 有/ 状态/ 和/ 无/ 状态/ 之间/ 的/ 地址/ 管理/ 方式/ ,/ 即/ 主机/ 首先/ 通过/ SLAAC/ 方式/ 获取/ IPv6/ 地址/ ,/ 然后/ 使用/ DHCPv6/ 获取/ 除/ 地址/ 以外/ 的/ 其它/ 网络/ 配置/ 参数/ ,/ 如/ DNS/ 、/ 域名/ 后缀/ 等/ ./ 就/ 本文/ 而言/ ,/ 我们/ 重点/ 关注/ 的/ 是/ IP地址/ 的/ 真实/ 有效性/ ,/ 而/ 在/ 这种/ 混合/ 模式/ 下/ ,/ 节点/ 获取/ 地址/ 的/ 方式/ 仍/ 是/ 依托/ 于/ SLAAC/ ,/ 故/ 这种/ 混合/ 方式/ 下/ 的/ 源地址/ 验证/ 我们/ 仍/ 归于/ SLAAC/ 方式/ 验证/ ./ 3.2/ ./ 5/ 小结/ 物/ 联网/ 接入/ 子网/ 有单/ 跳/ 网络/ 、/ 层级/ 网络/ 和/ 多/ 跳/ 网络/ 3/ 种/ 形态/ ;/ 而物/ 联网/ 节点/ 地址/ 分配/ 方式/ 有/ 静态/ 图/ 8/ 物/ 联网/ 节点/ DHCPv6/ 方式/ 源地址/ 验证/ 状态/ 变迁/ 图/ 指定/ 、/ SLAAC/ 、/ DHCPv6/ 以及/ DHCPv6/ 与/ SLAAC/ 混合/ 的/ 4/ 种/ 方案/ ,/ 在/ 相应/ 的/ 验证/ 方式/ 中/ ,/ 验证/ 对象/ 均/ 为/ 传感器/ 节点/ ,/ 验证/ 主体/ 为/ 验证/ 对象/ 被/ 覆盖范围/ 内/ 、/ 所/ 选择/ 的/ 第一/ 跳/ 可/ 路由/ 节点/ ;/ 总体/ 上/ ,/ 节点/ IP地址/ 验证/ 方式/ 又/ 有/ 集中式/ 和/ 分布式/ 两种/ ,/ 集中式/ 的/ 优点/ 在于/ 对/ 节点/ 的/ 资源/ 无/ 影响/ ,/ 但/ 无法/ 保证/ 细粒度/ 的/ 地址/ 验证/ ,/ 并且/ 有/ 可能/ 造成/ 瓶颈/ 点/ ;/ 分布式/ 方法/ 的/ 缺点/ 在于/ 对/ 可/ 路由/ 节点/ 的/ 资源/ 有所/ 消耗/ ./ 我们/ 就物/ 联网/ 源地址/ 验证/ 场景/ 及/ 方案/ 进行/ 了/ 总结/ ,/ 如表/ 2/ 所示/ ./ 表/ 2/ 物/ 联网/ 接入/ 子网/ 源地址/ 验证/ 场景/ 及/ 方案/ 总结/ 分配/ 方式/ ManualSLAACDHCPv6Mixed3/ ./ 3/ 讨论/ 在/ 本/ 小节/ 中/ ,/ 我们/ 就/ 方案/ 的/ 相关/ 问题/ 予以/ 讨论/ ./ (/ 1/ )/ 如何/ 保证/ 可/ 路由/ 节点/ 源地址/ 的/ 真实/ 有效性/ ?/ 在/ 本文/ 中/ ,/ 我们/ 并/ 没有/ 考虑/ 物/ 联网/ 可/ 路由/ 节点/ IP/ 源地址/ 的/ 有效性/ ,/ 原因/ 在于/ ,/ 如同/ 互联网/ 路由器/ 、/ 交换机/ 较/ 互联网/ 端系统/ 主机/ 信任度/ 要/ 高/ 一样/ ,/ 可/ 路由/ 节点/ IP地址/ 仿冒/ 的/ 可能性/ 远/ 没有/ 传感器/ 节点/ 高/ ,/ 所以/ 我们/ 重点/ 关注/ 传感器/ 节点/ 源地址/ 验证/ ./ 事实上/ ,/ 由于/ 可/ 路由/ 节点/ 的/ 数量/ 较/ 传感器/ 节点/ 要少/ 得/ 多/ ,/ 因此/ ,/ 我们/ 也/ 可以/ 采用/ 集中/ 验证/ 方式/ 对/ 每个/ 可/ 路由/ 节点/ 单独/ 验证/ ./ (/ 2/ )/ 如果/ 没有/ 可/ 路由/ 节点/ ,/ 如何/ 对/ 传感器/ 节点/ Page9/ 的/ IP地址/ 进行/ 验证/ ?/ 物/ 联网/ 接入/ 子网/ 中/ 如果/ 没有/ 可/ 路由/ 节点/ ,/ 那么/ 传感器/ 节点/ 本身/ 将/ 充当/ 可/ 路由/ 节点/ 的/ 角色/ ,/ 运行/ 路由/ 协议/ ,/ 进行/ 数据/ 的/ 转发/ ./ 这样/ 就/ 加重/ 了/ 节点/ 资源/ 的/ 消耗/ ,/ 这/ 也/ 是/ 不/ 太/ 现实/ 的/ ,/ 否则/ 就/ 形成/ 了/ 类似/ 于/ ad/ -/ hoc/ 自/ 组织/ 网络/ 形态/ ,/ 那么/ 节点/ 间/ 的/ 数据传输/ 将/ 并/ 不/ 依托/ 于/ 网络层/ 地址/ ,/ 因此/ IP地址/ 的/ 功能/ 将会/ 大大/ 被/ 弱化/ ./ 但是/ 为了/ 保证/ 能/ 与/ 互联网/ 端系统/ 靠/ IP地址/ 进行/ 端到/ 端的/ 通信/ ,/ 我们/ 可以/ 采用/ 被/ 验证/ 节点/ 的/ 邻居/ 节点/ 作为/ 验证/ 主体/ ,/ 监听/ 其/ 地址/ 的/ 获取/ 过程/ 并/ 建立/ 绑定/ 关系/ 表/ ./ 由于/ 邻居/ 节点/ 可能/ 存在/ 着/ 多个/ ,/ 因此/ 可以/ 采用/ 所有/ 邻居/ 投票/ 累计/ 或/ 加权/ 的/ 方式/ 进行/ 验证/ ./ 当然/ ,/ 其/ 详细/ 的/ 机理/ 还/ 需/ 进一步/ 的/ 研究/ ./ 4/ 方案/ 评估/ 我们/ 采用/ 了/ UCBerkeley/ 大学/ 推出/ 的/ 针对/ 物/ 联网/ 基于/ TinyOS/ 的/ TOSSIM/ ①/ 模拟器/ 进行/ 了/ 本/ 方案/ 的/ 仿真/ ,/ 主要/ 评估/ 了/ 可/ 路由/ 节点/ 绑定/ 表/ 和/ 过滤/ 表所/ 消耗/ 内存容量/ 以及/ 端到/ 端的/ 时延/ 、/ 丢/ 包率/ 等/ 指标/ ./ 我们/ 首先/ 评估/ 可/ 路由/ 节点/ 绑定/ 表/ 和/ 过滤/ 表所/ 占用/ 的/ 内存/ 比例/ ./ 绑定/ 表项/ 的/ 字/ 段/ 及/ 长度/ 为/ 〈/ Index/ (/ 1B/ )/ ,/ EPC/ (/ 0B/ ,/ 暂时/ 未/ 用/ )/ ,/ IP/ (/ 8B/ )/ ,/ MAC/ (/ 8B/ )/ ,/ State/ (/ 1B/ )/ ,/ Lifetime/ (/ 2B/ )/ ,/ Other/ (/ 0B/ ,/ 暂时/ 未/ 用/ )/ 〉/ ./ 因此/ ,/ 每条/ 记录/ 所/ 占用/ 的/ 内存/ 为/ 20B/ ./ 过滤/ 表/ 的/ 字/ 段/ 及/ 长度/ 为/ 〈/ Index/ (/ 1B/ )/ ,/ IP/ (/ 8B/ )/ 〉/ ,/ 绑定/ 成功/ 的/ 记录/ 同时/ 会/ 生成/ 一条/ 过滤/ 表项/ ./ 因此/ ,/ 每个/ IP/ 成功/ 绑定/ 生成/ 绑定/ 表及/ 过滤/ 表/ 记录/ 所/ 占用/ 的/ 内存/ 为/ 29B/ ./ 在/ 绑定/ 20/ 个/ 节点/ 的/ 情况/ 下为/ 580B/ ./ 假如/ 可/ 路由/ 节点/ 的/ 内存/ 为/ 64KB/ ,/ 则/ 所/ 消耗/ 内存/ 的/ 比例/ 为/ 0.885/ %/ ./ 我们/ 还/ 考察/ 了/ 节点/ 在/ 不/ 进行/ 源地址/ 验证/ 、/ 进行/ 源地址/ 验证/ 、/ 节点/ 移动/ 并/ 进行/ 源地址/ 验证/ 3/ 种/ 情况/ 下/ 的/ 端/ 到/ 端的/ 平均/ 时延/ 及/ 丢/ 包率/ ./ 具体/ 的/ 做法/ 是/ ,/ 采用/ SLAAC/ 地址/ 分配/ 协议/ ,/ 用/ 50/ 个/ 节点/ 模拟/ 物/ 联网/ 节点/ ,/ 其中/ 10/ 个/ 可/ 路由/ 节点/ ,/ 40/ 个/ 传感器/ 节点/ ./ 可/ 路由/ 节点/ 都/ 实现/ 了/ TinyRPL/ 路由/ 协议/ 和/ BLIP/ ②/ 所/ 代表/ 的/ 6LoWPAN/ 协议/ (/ 图/ 9/ 为/ 节点/ 架构/ 的/ 示意图/ )/ ,/ 同时/ 还/ 实现/ 了/ SLAAC/ 协议/ 的/ 监听/ 、/ 绑定/ 以及/ 验证/ 的/ 功能/ ./ 传感器/ 节点/ 不/ 需要/ TinyRPL/ 及/ 地址/ 验证/ 模块/ ./ 我们/ 用/ 1/ 个/ 位置/ 固定/ 的/ 传感器/ 节点/ 模拟/ 互联网/ PC/ 端/ 用于/ 接收数据/ ,/ 用/ 1/ 个/ 传感器/ 节点/ 每隔/ 2s/ 向/ 该/ 节点/ 发送/ 一个/ 固定/ 报文/ ./ “/ PC/ ”/ 节点/ 收到/ 该/ 消息/ 后/ ,/ 会/ 在/ TOSSIM/ 调试/ 窗口/ 显示/ 相关/ 记录/ ./ 表/ 3/ 列出/ 了/ 模拟实验/ 相关/ 参数设置/ ./ 我们/ 针对/ 3/ 种/ 状态/ 、/ 每组/ 10/ 个/ 数据包/ 进行/ 实验/ 结果/ 平均/ 的/ 方法/ ,/ 得到/ 如图/ 10/ 、/ 图/ 11/ 所示/ 的/ 平均/ 时延/ 及/ 丢/ 包率/ 对比/ 结果/ ./ 节点/ 数量/ 可/ 路由/ 节点/ 数量/ 传感器/ 节点/ 数量/ 节点/ 位置/ 地址/ 分配/ 方式/ Tossim/ 加载/ 插件/ SendRadioPackets/ ,/ RadioLink/ ,/ 每次/ 执行/ 时间/ 数据/ 发送/ 间隔/ 发送/ 数据包/ 大小/ 天线/ 范围/ 移动/ 速率/ 节点/ 移动/ 路线/ ①/ ②/ Page10/ 从图/ 10/ 、/ 图/ 11/ 中/ 我们/ 可以/ 看出/ ,/ 节点/ 在/ 没有/ 移动/ 的/ 情况/ 下/ ,/ 进行/ 源地址/ 验证/ 对/ 节点/ 数据/ 的/ 传输/ 几乎/ 不/ 产生/ 任何/ 影响/ ./ 而/ 在/ 节点/ 移动/ 情况/ 下/ ,/ 节点/ 的/ 传输/ 时延/ 及/ 丢/ 包率/ 都/ 会/ 显著/ 增长/ ,/ 分别/ 增长/ 近/ 60/ %/ 和/ 100/ %/ ,/ 分析/ 其/ 主要/ 原因/ 应该/ 在于/ 节点/ 移动/ ,/ 造成/ 重新/ 获取/ 地址/ 带来/ 时延/ 所致/ ./ 5/ 结论/ 及/ 进一步/ 的/ 研究/ 工作/ 物/ 联网/ 是/ 在/ 传感器/ 网络/ 基础/ 上/ 融合/ 了/ 互联网/ 的/ 新一代/ 智能/ 感知/ 网络/ ,/ 也/ 是/ 近年来/ 世界/ 各国/ 大力/ 研究/ 和/ 发展/ 的/ 重点/ ./ 目前/ ,/ 研究/ 大多/ 聚焦/ 在/ 物/ 联网/ 的/ 体系结构/ 、/ 路由/ 机理/ 、/ 协议/ 简化/ 以及/ 与/ 互联网/ 互联互通/ 的/ 机制/ 等/ 方面/ ./ 物/ 联网/ 的/ 安全/ 问题/ 还/ 未/ 引起/ 大家/ 的/ 重视/ ,/ 特别/ 是/ 物/ 联网/ 节点/ 采用/ 了/ IPv6/ 地址/ ,/ 能够/ 与/ 互联网/ 端系统/ 进行/ 点对点/ 通信/ 之后/ ,/ 物/ 联网/ 节点/ 的/ IP地址/ 真实性/ 有效性/ 就/ 变得/ 尤为重要/ ,/ 否则/ 现有/ 互联网/ (/ 包括/ 地址/ 欺骗/ ,/ 数据/ 篡改/ 在内/ )/ 的/ 众多/ 安全/ 问题/ 将会/ 在/ 物/ 联网/ 中/ 继续/ 出现/ ./ 本文/ 首先/ 从/ IP地址/ 真实/ 可靠/ 的/ 必要性/ 出发/ ,/ 论述/ 了/ 物/ 联网/ IP/ 源地址/ 验证/ 的/ 重要性/ ./ 然后/ 调研/ 了/ 现有/ 互联网/ 源地址/ 验证/ 的/ 已有/ 研究成果/ ,/ 并/ 结合/ 对物/ 联网/ 的/ 基本/ 共识/ ,/ 提出/ 了/ 融合/ 物/ 联网/ 的/ 下一代/ 互联网/ 源地址/ 验证/ 框架/ ,/ 同时/ 根据/ 物/ 联网/ 的/ 特点/ 指出/ 了/ 分布式/ 验证/ 方法/ 优于/ 集中式/ 验证/ 方法/ 的/ 思路/ ,/ 并/ 分别/ 讨论/ 了/ 静态/ 指定/ 、/ SLAAC/ 、/ DHCPv6/ 和/ DHCPv6/ 与/ SLAAC/ 混合/ 四种/ 地址/ 分配情况/ 下/ 的/ 场景/ 交互/ 、/ 过程/ 时序/ 以及/ 状态/ 变迁/ 的/ 细节/ ./ 通过/ 在/ 可/ 路由/ 节点/ 上/ 建立/ 自己/ 所/ 覆盖/ 的/ 传感器/ 节点/ 的/ 绑定/ 表/ 和/ 过滤/ 表/ ,/ 建立/ 了/ 分布式/ 源地址/ 验证/ 机制/ ./ 最后/ 的/ 模拟实验/ 也/ 证明/ 了/ 该/ 方案/ 的/ 合理性/ 和/ 有效性/ ./ 需要/ 指出/ 的/ 是/ ,/ 仍/ 有/ 许多/ 研究/ 工作/ 还有/ 待/ 进一步/ 研究/ ./ (/ 1/ )/ 地址/ 分配/ 过程/ 的/ 报文/ 交互/ 安全性/ 有待/ 加强/ SLAAC/ ,/ DHCP/ 地址/ 分配/ 方式/ 本身/ 也/ 存在/ 安全漏洞/ ,/ 比如/ IPv6/ 网络/ 中/ 的/ MAC/ 欺骗/ 、/ 虚假/ RA/ 公告/ 地址/ 前缀/ 等/ ./ 因此/ 我们/ 在/ 强调/ IP地址/ 本身/ 有效性/ 的/ 同时/ ,/ 还应/ 关注/ 几种/ 地址/ 分配/ 方式/ 的/ 安全性/ ./ 通过/ IPSec/ 及/ MD5/ 消息/ 签名/ 等/ 方法/ 可以/ 强化/ 地址/ 获取/ 过程/ 中/ 交互/ 报文/ 的/ 有效性/ ,/ 但/ 具体/ 的/ 机理/ 和/ 手段/ 还/ 需/ 进一步/ 的/ 研究/ ./ (/ 2/ )/ 多/ 协议/ 网关/ 翻译/ 机制/ 需要/ 进一步/ 研究/ 由于/ 物/ 联网/ 节点/ 物理层/ 允许/ 的/ 最大/ 数据/ 长度/ 为/ 127/ 字节/ ,/ 地址/ 分配/ 以及/ 重复/ 地址/ 检测/ 过程/ ,/ 必然/ 会/ 涉及/ 到/ 节点/ 数据/ 分片/ 和/ 协议/ 网关/ 数据包/ 重组/ ./ 数据包/ 翻译/ 机制/ 会/ 对/ 包括/ 源地址/ 验证/ 在内/ 的/ 所有物/ 联网/ 节点/ 与/ 互联网/ 节点/ 互联互通/ 工作/ 起到/ 推动/ 作用/ ./ 因此/ 需要/ 进一步/ 研究/ ./ 

