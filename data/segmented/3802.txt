Page1/ 基于/ 传播/ 引擎/ 的/ 指针/ 引用/ 错误/ 检测/ 衷璐洁/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 霍玮/ 1/ )/ 李丰/ 1/ )/ ,/ 3/ )/ 陈/ 聪明/ 1/ )/ ,/ 3/ )/ 冯晓兵/ 1/ )/ 张兆庆/ 1/ )/ 1/ )/ (/ 中国科学院计算技术研究所/ 计算机/ 体系结构/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 2/ )/ (/ 首都师范大学/ 信息/ 工程学院/ 北京/ 100048/ )/ 3/ )/ (/ 中国科学院/ 研究生院/ 北京/ 100049/ )/ 摘要/ 指针/ 在/ C/ 程序/ 中/ 应用/ 广泛/ ,/ 指针/ 引用/ 错误/ 多发/ 且/ 危害/ 严重/ ./ 目前/ 代表性/ 的/ 检测工具/ 由于/ 使用/ 方便性/ 和/ 检测/ 精度/ 不足/ 以及/ 难以/ 处理/ 大规模/ 程序/ 等/ 原因/ ,/ 并/ 不能/ 满足/ 实用/ 需求/ ./ 文中/ 提出/ 一种/ 新型/ 的/ 错误/ 检测/ 方法/ ,/ 该/ 方法/ 基于/ 域/ 敏感/ 、/ 流/ 敏感/ 和/ 上下文/ 敏感/ 的/ 传播/ 引擎/ ,/ 通过/ 定义/ 错误/ 属/ 性格/ 、/ 在/ 源程序/ 中/ 对/ 错误/ 属/ 性格/ 值/ 进行/ 计算/ 和/ 传播/ 来/ 完成/ 错误/ 检测/ ./ 在/ 开放源码/ 编译器/ Open64/ 中/ 实现/ 了/ 其/ 原型/ 系统/ Propagator/ ./ 以空/ 指针/ 引用/ 错误/ 检测/ 为/ 实例/ 研究/ 内容/ ,/ 使用/ Apache/ 、/ OpenSSH/ 、/ gzip/ 等/ 应用领域/ 广泛/ 的/ 典型/ 应用/ 为/ 实验/ 用例/ ./ 与/ Saturn/ 、/ Splint/ 和/ Clang/ -/ SA/ 进行/ 对比/ ,/ Propagator/ 的/ 平均/ 检测时间/ 仅为/ 12s/ ,/ 误报率/ 平均/ 仅为/ 13/ %/ ,/ 远/ 低于/ 对比/ 工具/ ,/ 且/ 没有/ 发现/ 漏报/ 已知/ 错误/ ./ 上述/ 结果表明/ ,/ Propagator/ 既/ 提高/ 了/ 检测/ 精度/ 又/ 保证/ 了/ 可扩展性/ ,/ 具有/ 很/ 好/ 的/ 实用/ 前景/ ./ 关键词/ 空/ 指针/ 引用/ ;/ 错误/ 属/ 性格/ ;/ 上下文/ 敏感/ ;/ 静态/ 检测/ ;/ 传播/ 引擎/ 1/ 引言/ 在/ C语言/ 程序/ 中/ 指针/ 使用/ 非常/ 广泛/ ,/ 由于/ 其/ 用法/ 灵活/ ,/ 极易/ 在/ 程序/ 中/ 造成/ 错误/ ./ 在/ 诸多/ 程序/ 漏洞/ 隐患/ 中/ ,/ 指针/ 所/ 引发/ 的/ 安全漏洞/ 屡见不鲜/ ,/ 后果严重/ ./ 指针/ 引用/ 错误/ ,/ 特别/ 是/ 未/ 赋值/ 的/ “/ 野/ ”/ 指针/ 、/ 值为/ 空/ 的/ 指针/ ,/ 引用/ 错误/ 出现/ 频率/ 高/ ,/ 危害/ 大/ ./ 以空/ 指针/ 引用/ 为例/ ,/ 它/ 可能/ 引发/ 拒绝服务/ 攻击/ 、/ 提升/ 内核/ 权限/ 、/ 执行/ 任意/ 内核/ 态/ 代码/ 等/ 安全/ 问题/ ,/ 使/ 应用程序/ 、/ 甚至/ 操作系统/ 内核/ 崩溃/ ./ 例如/ 图/ 1/ 所示/ 的/ 中国/ 国家/ 信息安全/ 漏洞/ 库/ ①/ 发布/ 的/ 信息/ :/ 从/ 2004/ ~/ 2011/ 年/ ,/ 空/ 指针/ 引用/ 漏洞/ 数/ 呈现/ 总体/ 上升/ 的/ 趋势/ ./ 空/ 指针/ 引用/ 漏洞/ 涉及/ 应用/ 面/ 广泛/ ,/ 包括/ 操作系统/ (/ 如/ Linux/ 内核/ 、/ FreeBSD/ 等/ )/ 、/ 浏览器/ (/ MicrosoftIE/ 、/ MozillaFirefox/ )/ 、/ 网络协议/ 、/ 服务/ 及/ 应用/ 、/ 文字/ 处理软件/ (/ 如/ MicrosoftOffice/ )/ 等/ ./ 在/ 国家/ 互联网/ 应急/ 中心/ 2010/ 年/ 的/ 网络安全/ 信息/ 与/ 动态/ 周报/ 中曾/ 报道/ :/ Firefox/ 等/ 软件/ 存在/ 的/ 空/ 指针/ 引用/ 等/ 内存/ 漏洞/ 使/ 互联网/ 上/ 的/ 百万/ 服务器/ 受到/ 威胁/ ,/ 这些/ 漏洞/ 可/ 被/ 攻击者/ 利用/ 来/ 执行/ 任意/ 代码/ 或/ 导致/ 主机/ 拒绝服务/ ,/ 对/ 网民/ 的/ 上网/ 安全/ 造成/ 严重/ 影响/ ②/ ./ 因此/ ,/ 指针/ 引用/ 错误/ 检测/ 对于/ 提高/ 软件可靠性/ ,/ 避免/ 漏洞/ 的/ 发生/ 具有/ 重要/ 意义/ ./ 对/ 指针/ 相关/ 错误/ 的/ 检测/ 方法/ 通常/ 可/ 分为/ 动态/ 和/ 静态/ 两大类/ ,/ 其中/ 动态/ 方法/ 需要/ 运行/ 程序/ ,/ 依赖于/ 测试用例/ ,/ 只能/ 发现/ 被/ 执行/ 路径/ 上/ 的/ 错误/ ,/ 且/ 测试用例/ 的/ 构建/ 仍然/ 是/ 一个/ 开放/ 问题/ ./ 相对而言/ ,/ 静态方法/ 直接/ 作用/ 于/ 程序/ 源代码/ ,/ 可以/ 检测/ 程序/ 中/ 所有/ 路径/ ,/ 并且/ 不/ 需要/ 测试用例/ ,/ 具有/ 更好/ 的/ 完备/ 性/ ./ 本文/ 重点/ 关注/ 静态/ 检测/ 方法/ ./ 以空/ 指针/ 引用/ 错误/ 检测/ 为例/ ,/ 采用/ 静态/ 分析方法/ 进行/ 空/ 指针/ 引用/ 错误/ 检测/ 并/ 不是/ 一个/ 新/ 问题/ ,/ 在/ 这些/ 采用/ 静态/ 分析/ 的/ 检测/ 方法/ 或/ 工具/ 中/ ,/ 除了/ 使用/ 传统/ 的/ 流/ 分析/ ,/ 还/ 常常/ 与/ 定理/ 证明/ 、/ 模型/ 检测/ 、/ 符号执行/ 等/ 技术相结合/ ,/ 以/ 达到/ 更/ 高/ 的/ 检测/ 精度/ ./ 其中/ 定理/ 证明/ 和/ 模型/ 检测/ 的/ 方法/ 自身/ 的/ 局限/ 导致/ 可扩展性/ 表现/ 不/ 理想/ ,/ 例如/ 验证/ 条件/ 长度/ 与/ 程序/ 规模/ 呈/ 指数/ 增长/ [/ 1/ ]/ ,/ 穷举/ 遍历/ 程序/ 状态/ 空间/ 的/ 时空/ 开销/ 很大/ [/ 2/ -/ 3/ ]/ 等/ ./ 除此之外/ ,/ 这些/ 形式化/ 方法/ 通常/ 需要/ 用户/ 的/ 参与/ ,/ 需要/ 使用/ 事先/ 定义/ 的/ 规约/ 语言/ 对/ 源程序/ 进行/ 标注/ 或/ 性质/ 描述/ ,/ 如/ Saturn/ [/ 4/ ]/ 、/ Spe/ c#/ [/ 5/ ]/ 、/ Calysto/ [/ 6/ ]/ 等/ ./ 这些/ 工具/ 的/ 标注/ 往往/ 很难/ 编写/ ./ 而/ 符号执行/ 方法/ 虽然/ 无需/ 用户/ 直接/ 干预/ ,/ 但/ 其/ 检错/ 能力/ 和/ 效率/ 也/ 往往/ 受制于/ 约束/ 求解/ 工具/ ,/ 同时/ 因为/ 需要/ 对/ 路径/ 进行/ 逐条/ 推理/ ,/ 其/ 时空/ 开销/ 也/ 非常/ 大/ ,/ 如/ Clang/ 静态/ 分析器/ [/ 7/ ]/ 分析/ 二十几万/ 行/ 的/ Apache/ 代码/ ,/ 需要/ 约/ 2/ 个/ 小时/ 左右/ 的/ 时间/ ./ 可见/ ,/ 目前/ 大多数/ 的/ 采用/ 静态/ 分析/ 的/ 检错/ 方法/ 或/ 工具/ 还/ 不能/ 很/ 好/ 地/ 满足/ 实用/ 需求/ ./ 经过/ 分析/ 不难/ 发现/ ,/ 指针/ 引用/ 错误/ 主要/ 涉及/ 指针/ 非正常/ 的/ 赋值/ 和/ 引用/ ,/ 其本质/ 实际上/ 是/ 广义/ 上/ 的/ 定值/ -/ 引用/ 流/ 分析/ 问题/ ./ 因此/ 我们/ 基于/ 编译/ 技术/ 提出/ 流/ 敏感/ 、/ 域/ 敏感/ 、/ 上下文/ 敏感/ (/ 下文/ 简称/ 多/ 敏感/ )/ 的/ 传播/ 引擎/ ,/ 并/ 利用/ 该/ 引擎/ 准确/ 高效/ 地/ 进行/ 错误/ 属性/ 的/ 计算/ 与/ 传播/ ./ 我们/ 的/ 方法/ 不仅/ 能/ 很/ 好/ 地/ 适用/ 于/ 指针/ 引用/ 错误/ 的/ 检测/ ,/ 对于/ 任何/ 可/ 建模/ 为格值/ 模型/ 的/ 错误/ 类型/ ,/ 均/ 可/ 进行/ 有效/ 的/ 检测/ ./ 本文/ 提出/ 的/ 基于/ 传播/ 引擎/ 的/ 错误/ 检测/ 方法/ 具有/ 以下/ 优势/ :/ (/ 1/ )/ 将/ 检测/ 过程/ 与/ 编译/ 过程/ 紧密结合/ ,/ 用户/ 无需/ 学习/ 或/ 掌握/ 任何/ 规约/ 语言/ ,/ 在/ 程序/ 进行/ 编译/ 的/ 同时/ 即可/ 完成/ 错误/ 的/ 检测/ ./ (/ 2/ )/ 错误/ 检测/ 精度高/ ,/ 精确/ 的/ 程序/ 分析/ 结果/ 能够/ 带来/ 健壮/ 而/ 准确/ 的/ 程序/ 信息/ ,/ 从而/ 获得/ 高精度/ 的/ 检测/ 结果/ ./ (/ 3/ )/ 可扩展性/ 好/ ,/ 成熟/ 编译器/ 具有/ 有效/ 处/ ①/ ②/ Page3/ 理/ 百万/ 行/ 以上/ 程序/ 的/ 能力/ ,/ 为/ 高/ 可扩展性/ 提供/ 了/ 坚实基础/ ./ 本文/ 将/ 重点/ 介绍/ 传播/ 引擎/ 用于/ 空/ 指针/ 引用/ 错误/ 的/ 检测/ ./ 本文/ 的/ 贡献/ 为/ :/ (/ 1/ )/ 提出/ 基于/ 传播/ 引擎/ 的/ 错误/ 检测/ 方法/ ./ 该/ 方法/ 定义/ 了/ 错误/ 属/ 性格/ 模型/ ,/ 将/ 错误/ 检测/ 问题/ 转换/ 为/ 错误/ 属/ 性格/ 值/ 的/ 计算/ 与/ 传播/ ./ (/ 2/ )/ 给出/ 了/ 多项式/ 时间/ 的/ 流/ 敏感/ 、/ 域/ 敏感/ 和/ 上下文/ 敏感/ 的/ 错误/ 属/ 性格/ 值/ 计算方法/ ./ 并/ 在/ Open64/ 编译器/ 中/ 实现/ 了/ 基于/ 传播/ 引擎/ 的/ 错误/ 检测/ 原型/ 系统/ Propagator/ ./ (/ 3/ )/ 以空/ 指针/ 引用/ 错误/ 检测/ 为/ 实例/ 研究/ ,/ 对/ Apache/ 、/ OpenSSH/ 、/ gzip/ 等/ 应用领域/ 进行/ 广泛/ 的/ 典型/ 应用/ 实验/ ,/ 结果表明/ Propagator/ 的/ 平均/ 检测时间/ 为/ 12s/ ,/ 在/ 检测/ 精度/ 方面/ ,/ Propagator/ 的/ 误报率/ 平均/ 为/ 13/ %/ ,/ 没有/ 发现/ 漏报/ 已知/ 错误/ ./ 2/ 相关/ 工作/ 模型/ 检测/ 、/ 符号执行/ 、/ 静态/ 分析/ 是/ 静态/ 检测/ 指针/ 引用/ 错误/ 的/ 典型/ 方法/ ,/ 下面/ 对/ 其中/ 代表性/ 方法/ 和/ 工具/ 进行/ 讨论/ ./ Saturn/ [/ 4/ ]/ 是/ 斯坦福大学/ 开发/ 的/ 研究型/ 静态/ 分析/ 工具/ 的/ 代表/ ,/ 可以/ 用于/ 空/ 指针/ 引用/ 等/ 多种/ 指针/ 错误/ 的/ 检测/ ./ 它/ 首先/ 对待/ 检测/ 的/ 程序/ 进行/ 建模/ ,/ 然后/ 基于/ 可/ 满足/ 性/ 求解/ 的/ 程序/ 分析/ 框架/ 对/ 建模/ 编码/ 后/ 的/ 程序/ 进行/ 分析/ ,/ 最后/ 按照/ 事先/ 编写/ 好/ 的/ 检测/ 目标/ 文件/ 中/ 指定/ 的/ 步骤/ 完成/ 检测/ ./ Saturn/ 将/ 指针/ 建模/ 为/ 条件/ 位置/ 集合/ (/ GLS/ )/ ,/ 以/ 表示/ 指针/ 在/ 某个/ 特定/ 程序/ 点/ 在/ 计算/ 出/ 的/ 条件/ 下/ 可能/ 指向/ 的/ 内存/ 位置/ 集合/ ,/ 这样/ 的/ 指针/ 模型/ 在/ 理论/ 上/ 是/ 精确/ 的/ ,/ 但/ 在/ 实际/ 应用/ 尤其/ 是/ 那些/ 具有/ 复杂/ 分支/ 以及/ 可能/ 组合/ 出/ 复杂/ 路径/ 的/ 程序/ 中/ ,/ 条件/ 的/ 表示/ 和/ 约束/ 求解/ 的/ 难度很大/ ,/ 时空/ 开销/ 会/ 因为/ 路径/ 复杂度/ 而/ 急剧/ 增加/ ,/ 导致/ 分析/ 时间/ 过长/ 或/ 根本无法/ 完成/ ./ 比如/ Saturn/ 分析/ 15/ 万行/ 的/ OpenSSH/ 程序/ 就/ 花费/ 了/ 约/ 1/ 小时/ 的/ 时间/ ,/ 而/ 对于/ SPEC2000/ 中/ 的/ C/ 程序/ 分析/ 也/ 有/ 近/ 半数/ 无法/ 成功/ 结束/ ./ Splint/ [/ 8/ ]/ 是/ 工业界/ 使用/ 得/ 较为/ 广泛/ 的/ 一个/ 工具/ ,/ 原名/ LcLint/ ./ 它/ 采用/ 轻量级/ 静态/ 分析方法/ 实现/ ANSIC/ 程序/ 漏洞/ (/ 包括/ 空/ 指针/ 引用/ 错误/ )/ 的/ 检测/ ./ 但/ Splint/ 的/ 误报/ 和/ 漏报/ 较/ 多/ ,/ 这/ 主要/ 是因为/ Splint/ 仅/ 进行/ 过程/ 内/ 的/ 分析/ ./ Clang/ 静态/ 分析器/ (/ Clang/ -/ SA/ )/ [/ 7/ ]/ ①/ 以/ libAnalysis/ 库/ 的/ 形式/ 内/ 置于/ LLVM/ 的/ Clang/ 编译器/ 中/ ./ Clang/ -/ SA/ 可以/ 检测/ 的/ 错误/ 类型/ 中/ 包含/ 空/ 指针/ 引用/ 在内/ 的/ 多种/ 逻辑/ 错误/ ./ Clang/ -/ SA/ 利用/ 内部/ 编译器/ 结构/ 查找/ 典型/ 程序/ 错误/ ,/ 使用/ 源代码/ 级/ 的/ 控制流/ 图/ ,/ 对/ 源程序/ 进行/ 过程/ 内/ 流/ 敏感/ 、/ 路径/ 敏感/ 的/ 程序/ 分析/ 以及/ 符号执行/ ,/ 其/ 指针/ 分析/ 采用/ 基于/ 区域/ (/ region/ -/ based/ )/ 的/ 内存/ 建模/ 的/ 方法/ [/ 9/ ]/ ./ 但是/ 因为/ 不能/ 对/ 全局/ 指针/ 、/ 函数指针/ 等/ 有效/ 建模/ 并且/ 过程/ 间/ 分析/ 也/ 不够/ 完善/ 等/ 原因/ ,/ Clang/ -/ SA/ 的/ 检测/ 精度/ 还/ 不/ 甚/ 理想/ ,/ 此外/ 它/ 也/ 同样/ 存在/ 因/ 路径/ 组合/ 带来/ 的/ 时空/ 开销/ 问题/ ./ 另/ 一些/ 空/ 指针/ 引用/ 错误/ 的/ 检测/ 研究/ 工作/ 基于/ 数据流/ 分析/ 的/ 扩展/ ,/ 例如/ :/ Manevich/ 等/ 人/ [/ 10/ ]/ 提出/ 一种/ 针对/ 空/ 指针/ 引用/ 检测/ 的/ PSE/ 算法/ ,/ 该/ 算法/ 采用/ 流/ 不/ 敏感/ 的/ 别名/ 分析/ 和/ 后/ 向/ 数据流/ 分析/ ./ 但/ 该/ 方法/ 由于/ 采用/ 流/ 不/ 敏感/ 的/ 别名/ 分析/ ,/ 因此/ 有/ 较/ 多/ 误报/ 产生/ ./ 徐厚峰/ 等/ 人/ [/ 11/ ]/ 基于/ PSE/ 算法/ ,/ 提出/ 了/ 一种/ 需求/ 驱动/ 空/ 指针/ 引用/ 错误/ 检测/ 的/ 后/ 向/ 数据流/ 分析/ 算法/ ,/ 但/ 同样/ 存在/ 指针/ 分析/ 精度/ 不够/ 带来/ 的/ 误报/ 问题/ ./ 张冠楠/ 等/ 人/ [/ 12/ ]/ 提出/ 一种/ 以/ 函数/ 摘要/ 为/ 基础/ 的/ 函数/ 间/ 分析方法/ ,/ 该/ 方法/ 利用/ 状态机/ 对/ 函数/ 间/ 的/ 空/ 指针/ 引用/ 错误/ 进行/ 检测/ ,/ 但/ 他们/ 的/ 方法/ 因为/ 检测/ 算法/ 及空/ 指针/ 错误/ 状态/ 模式/ 不/ 完备/ 等/ 原因/ 不能/ 在/ 实际/ 应用/ 中/ 保证/ 所有/ 类型/ 的/ 函数/ 间/ 的/ 空/ 指针/ 引用/ 故障/ 都/ 被/ 检测/ 出来/ ,/ 漏报/ 率/ 较/ 高/ ./ 工业界/ 也/ 有/ 一些/ 工具/ 可以/ 用于/ 空/ 指针/ 引用/ 错误/ 的/ 检测/ ,/ 代表性/ 的/ 有/ KlocworkInsight/ 、/ Coverity/ 静态/ 分析/ 工具/ 、/ Logiscope/ 等/ ./ 其中/ ,/ Klocwork/ ②/ 是/ 加拿大/ Klocwork/ 公司/ 开发/ 的/ 一个/ 源代码/ 分析/ 工具/ ,/ 可以/ 用于/ 编码/ 缺陷/ 的/ 检查/ ./ Coverity/ 静态/ 分析/ 工具/ ③/ 由/ 美国/ Coverity/ 公司/ 开发/ ,/ 使用/ 抽象/ 解释/ 对/ 程序/ 源代码/ 中/ 错误/ 进行/ 检测/ ./ IBM/ 的/ Logiscope/ ④/ 是/ 一个/ 静态/ 测试工具/ ,/ 主要/ 以/ 3/ 种/ 独立/ 工具/ 的/ 形式/ 出现/ ,/ 分别/ 完成/ 一项/ 主要/ 功能/ ,/ 包括/ 软件/ 质量/ 分析/ 工具/ Audit/ 、/ 代码/ 规范性/ 检测工具/ RuleChecker/ 和/ 测试/ 覆盖率/ 统计/ 工具/ TestChecker/ ,/ 其中/ Audit/ 和/ RuleChecker/ 提供/ 了/ 对/ 软件/ 进行/ 静态/ 分析/ 的/ 功能/ ./ 这些/ 工具/ 因为/ 属于/ 商业用途/ ,/ 其/ 公开/ 资料/ 缺乏/ ,/ 因此/ 未能/ 对/ 其/ 进行/ 过多/ 的/ 评价/ ./ 此外/ ,/ Novillo/ 在/ 2005/ 年/ 提出/ 并/ 实现/ 了/ 一个/ GCC/ 传播/ 引擎/ [/ 13/ ]/ ./ GCC/ 传播/ 引擎/ 实现/ 了/ 一个/ 广义/ 上/ 的/ 传播/ 算法/ ,/ 该/ 算法/ 主要/ 应用/ 于/ 静态/ 单/ 赋值/ 形式/ ①/ ②/ ③/ ④/ Page4/ 上/ 的/ 条件/ 常量/ 传播/ 、/ 复写/ 传播/ 和/ 值/ 范围/ 传播/ ,/ 仅/ 进行/ 了/ 过程/ 内/ 的/ 分析/ ./ 该/ 传播/ 引擎/ 的/ 应用领域/ 主要/ 是/ 编译器/ 内/ 信息/ 的/ 传播/ ,/ 其/ 目标/ 是/ 服务/ 于/ 编译/ 优化/ ,/ 保守/ 的/ 程序/ 分析/ 信息/ 不能/ 有效/ 支持/ 程序/ 错误/ 检测/ ./ 3/ 基于/ 格/ 的/ 多/ 敏感/ 传播/ 引擎/ 3.1/ 研究/ 动机/ 在/ 编译器/ 中有/ 许多/ 变换/ 基于/ 传播/ 的/ 概念/ :/ 在/ 定值/ 点/ 产生/ 的/ 值/ 被/ 传播/ 到/ 使用/ 这些/ 值/ 的/ 引用/ 点/ ./ 例如/ ,/ 常数/ 传播/ 是/ 当/ 赋值/ 语句/ 右部/ 是/ 常数/ 时/ ,/ 按照/ 流/ 分析/ 所得/ 的/ 定值/ -/ 引用/ 链/ ,/ 将/ 常数/ 传播/ 到/ 其/ 左部量/ 的/ 引用/ 点/ ,/ 这样/ 对/ 变量/ 的/ 引用/ 就/ 代替/ 为/ 对/ 常数/ 的/ 引用/ ,/ 达到/ 了/ 优化/ 效果/ ./ 而/ 很多/ 错误/ 的/ 发生/ 也/ 表现/ 出定值/ 引用/ 的/ 特征/ ,/ 特别/ 是/ 指针/ 引用/ 相关/ 的/ 错误/ ,/ 以空/ 指针/ 解/ 引用/ 为例/ ,/ 一般/ 表现/ 为/ 在/ 程序/ 中/ 某个/ 程序/ 点/ 进行/ 了/ 空/ 指针/ 的/ 定值/ ,/ 而/ 在/ 其它/ 程序/ 点/ 进行/ 解/ 引用/ 时/ 引起/ 空/ 指针/ 解/ 引用/ 错误/ ./ 类似/ 地/ ,/ 若/ 将/ 未/ 赋值/ 也/ 看成/ 一种/ 特殊/ 的/ 定值/ 的话/ ,/ 那么/ 未/ 赋值/ 的/ 野/ 指针/ 引用/ 也/ 呈现/ 类似/ 特征/ ./ 此外/ 还有/ 文件/ 打开/ 关闭/ ,/ 内存/ 泄漏/ 等/ 指针/ 相关/ 错误/ 也/ 可/ 归为此类/ ./ 为此/ ,/ 受/ 启发/ 于/ 传统/ 的/ 编译/ 传播/ ,/ 我们/ 将/ 传播/ 的/ 内容/ 扩展/ 至/ 刻画/ 错误/ 特征/ 的/ 属性/ 值/ ,/ 然后/ 通过/ 对/ 属性/ 值/ 的/ 计算/ 和/ 传播/ 达到/ 错误/ 检测/ 的/ 目的/ ./ 基于/ 此/ 想法/ ,/ 我们/ 提出/ 基于/ 传播/ 引擎/ 进行/ 错误/ 检测/ 的/ 方法/ ./ 针对/ 错误/ 检测/ 目标/ ,/ 传播/ 引擎/ 需要/ 解决/ 可扩展性/ 和/ 检测/ 精度/ 的/ 问题/ ./ 为了/ 获得/ 高/ 可扩展性/ ,/ 我们/ 的/ 传播/ 引擎/ 并/ 没有/ 引入/ 大/ 开销/ 的/ 路径/ 敏感/ 分析/ ,/ 而是/ 设计/ 并/ 实现/ 了/ 多项式/ 时间/ 复杂度/ 的/ 错误/ 属性/ 计算/ 与/ 传播/ 算法/ 进行/ 错误/ 检测/ ./ 这样/ 做/ 并/ 不会/ 造成/ 很大/ 的/ 检测/ 精度/ 损失/ ,/ 其/ 主要/ 原因/ 在于/ :/ (/ 1/ )/ 并/ 不是/ 所有/ 错误/ 的/ 检测/ 都/ 需要/ 用到/ 路径/ 敏感/ 的/ 信息/ ,/ 例如/ ,/ 那些/ 所有/ 路径/ 都/ 会/ 触发/ 的/ 错误/ ./ (/ 2/ )/ 在/ 指针/ 引用/ 错误/ 检测/ 中/ ,/ 有/ 很多/ 错误/ 可/ 直接/ 通过/ 单/ 分支/ 条件/ 进行/ 识别/ 或/ 排除/ ,/ 对/ 这些/ 错误/ 只/ 需/ 利用/ 简单/ 的/ 策略/ 即可/ 处理/ ./ 从/ 我们/ 的/ 实验/ 数据/ 看/ ,/ 处于/ 这/ 两种/ 情形/ 的/ 错误/ 所/ 占/ 比例/ 高达/ 86/ %/ ./ 而/ 为了/ 更好/ 地/ 支持/ 高精度/ 的/ 错误/ 检测/ 需求/ ,/ 我们/ 的/ 传播/ 引擎/ 还/ 对/ 传统/ 的/ 面向/ 编译/ 优化/ 的/ 保守/ 程序/ 分析/ 进行/ 了/ 多/ 敏感/ 的/ 扩充/ ,/ 在/ 传播/ 引擎/ 中/ 整合/ 了/ 面向/ 错误/ 检测/ 的/ 更为/ 精确/ 高效/ 的/ 程序/ 分析/ 基础设施/ ./ 并/ 基于/ 全/ 稀疏/ 的/ SSA/ 框架/ 实现/ 了/ 高效/ 准确/ 的/ 分层/ 指针/ 分析/ [/ 14/ ]/ ,/ 为/ 指针/ 引用/ 错误/ 的/ 检测/ 提供/ 了/ 更好/ 的/ 精度/ 支持/ ./ 相对/ 地/ ,/ 采用/ 路径/ 敏感/ 分析方法/ 的/ 检测工具/ 为了/ 获得/ 高/ 检测/ 精度/ ,/ 往往/ 需要/ 对/ 逐条/ 路径/ 进行/ 分析/ 和/ 求解/ 路径/ 可行性/ ,/ 分析/ 开销/ 很大/ ,/ 且/ 极易/ 发生/ 路径/ 爆炸/ 等/ 问题/ ,/ 加之/ 受到/ 约束/ 求解/ 器/ 能力/ 的/ 限制/ ,/ 极大/ 地/ 制约/ 了/ 这些/ 方法/ 的/ 可扩展性/ ./ 另一方面/ ,/ 也/ 正是/ 因为/ 没/ 能/ 完成/ 对/ 程序/ 所有/ 部分/ 的/ 分析/ ,/ 这些/ 检测/ 方法/ 往往/ 也/ 面临/ 精度/ 上/ 的/ 损失/ ./ 3.2/ 低/ 开销/ 、/ 高精度/ 的/ 传播/ 引擎/ 检测/ 方法/ 本文/ 定义/ 了/ 一个/ 基于/ 格/ 的/ 传播/ 引擎/ ,/ 通过/ 定义/ 特定/ 类别/ 的/ 错误/ 属/ 性格/ 值/ 实例/ 化/ 传播/ 引擎/ ,/ 实现/ 了/ 特定/ 类别/ 错误/ 的/ 高效/ 、/ 准确/ 的/ 检测/ ./ 错误/ 属/ 性格/ 模型/ 的/ 引入/ ,/ 实现/ 了/ 将/ 错误/ 检测/ 问题/ 变换/ 为/ 错误/ 属/ 性格/ 值/ 的/ 计算/ 问题/ ,/ 这种/ 变换/ 的/ 好处/ 在于/ 能够/ 简洁/ 、/ 清晰/ 地/ 完成/ 错误/ 属性/ 的/ 刻画/ 与/ 检测/ 算法/ 的/ 描述/ ./ 格上/ 的/ 偏序/ 关系/ 对应/ 了/ 相应/ 的/ 格值/ 计算/ 规则/ ./ 定义/ 2/ ./ 程序/ P/ 中/ 的/ 变量/ 集合/ 记为/ V/ ,/ 函数/ 集合/ 记为/ F/ ,/ 表达式/ 集合/ 记为/ E/ ,/ E/ 有/ 如下/ 3/ 种/ 形式/ :/ 直接/ 变量/ 操作/ v/ ;/ 运算/ 表达式/ op/ (/ e1/ ,/ e2/ ,/ …/ ,/ en/ )/ ;/ 函数/ 我们/ 的/ 传播/ 引擎/ 错误/ 检测/ 方法/ 是/ 一种/ 低/ 开销/ 、/ 高精度/ 的/ 错误/ 检测/ 方法/ ./ 其/ 输入/ 为/ 待/ 检测/ 程序/ 和/ 错误/ 属/ 性格/ 值/ 模型/ ,/ 基于/ 格/ 的/ 定值/ -/ 引用/ 类/ 错误/ 属/ 性格/ 值/ 建模/ 实现/ 了/ 简洁/ 清晰/ 的/ 错误/ 属性/ 刻画/ 并/ 为/ 高效/ 的/ 属/ 性格/ 值/ 计算/ 奠定/ 了/ 基础/ ./ 程序/ 分析/ 基础设施/ 的/ 多/ 敏感/ 扩充/ 提供/ 了/ 更好/ 的/ 精度/ 支持/ ./ 低/ 开销/ 的/ 多项式/ 时间/ 的/ 多/ 敏感/ 错误/ 属性/ 计算/ 与/ 传播/ 算法/ 在/ 属/ 性格/ 值/ 计算/ 和/ 传播/ 的/ 过程/ 中/ 完成/ 错误/ 检测/ (/ 其中/ ,/ 过程/ 内/ 的/ 属/ 性格/ 值/ 计算/ 算法/ 基于/ SSA/ 和域/ 模型/ 对/ 程序/ 中/ 各个/ 函数/ 的/ 属/ 性格/ 相关/ 语句/ 进行/ 属/ 性格/ 值/ 的/ 迭代/ 计算/ 并/ 在/ 有限/ 属/ 性格/ 高度/ 内/ 终止/ ,/ 实现/ 了/ 多项式/ 时间/ 的/ 流/ 敏感/ 、/ 域/ 敏感/ 的/ 过程/ 内属/ 性格/ 值/ 计算/ ./ 而/ 过程/ 间/ 的/ 属/ 性格/ 值/ 计算/ 是/ 基于/ 高精度/ 的/ 程序/ 分析/ 构建/ 的/ 精确/ 的/ 引用/ 输入/ 和/ 定值/ 输出/ 的/ 函数/ 副作用/ 模型/ ,/ 高效/ 准确/ 地/ 实现/ 了/ 针对/ 不同/ 上下文/ 的/ 多项式/ 时间/ 的/ 过程/ 间/ 属/ 性格/ 值/ 计算/ )/ ./ 最后/ ,/ 对/ 错误报告/ 进行/ 输出/ ./ 3.3/ 属/ 性格/ 及格/ 相关/ 语句/ 关联/ 函数/ (/ VAL/ ,/ Fmeet/ ,/ Funion/ )/ ,/ 其中/ :/ 义由/ 所要/ 解决/ 的/ 问题/ 确定/ ./ 定义/ 1/ ./ 属/ 性格/ AL/ 是/ 一个/ 代数/ 系统/ AL/ =/ 属/ 性格/ 上/ VAL/ 、/ 函数/ Fmeet/ 和/ 函数/ Funion/ 的/ 具体/ 定/ VAL/ 是/ 刻画/ 某种/ 类型/ 错误/ 的/ 属/ 性格/ 值/ 集合/ ;/ 函数/ Fmeet/ :/ VAL/ ×/ VAL/ →/ VAL/ 是/ AL/ 上/ 的/ 最大/ 下界/ 函数/ ;/ 函数/ Funion/ :/ VAL/ ×/ VAL/ →/ VAL/ 是/ AL/ 上/ 的/ 最小/ 上/ 界/ 函数/ ./ 用于/ 实现/ 从/ 错误/ 属性/ 的/ 计算/ 到格/ 上/ 运算/ 的/ 映射/ ./ Page5/ 调用/ 表达式/ f/ (/ e1/ ,/ e2/ ,/ …/ ,/ en/ )/ ,/ 其中/ v/ ∈/ V/ ,/ op/ 表示/ 运算符/ ,/ e1/ ,/ e2/ ,/ …/ ,/ en/ ∈/ E/ ,/ f/ ∈/ F/ ./ 语句/ 集合/ S/ 有/ 如下/ 3/ 种/ 形式/ :/ 分支/ 语句/ if/ (/ e/ )/ thens1elses2/ ;/ 跳转/ 语句/ gotoe/ ;/ 赋值/ 语句/ e1/ =/ e2/ ,/ 其中/ e/ ,/ e1/ ,/ e2/ ∈/ E/ ,/ s1/ ,/ s2/ ∈/ S/ ./ 定义/ 函数/ Faccess/ 为/ E/ →/ 2V/ ,/ 用于/ 计算/ 表达式/ 中/ 直接/ 或/ 间接/ 操作/ 的/ 变量/ 集合/ (/ 包括/ 仅/ 含单/ 元素/ 的/ 变量/ 集合/ )/ 的/ 集合/ ./ 定义/ 3/ ./ 属/ 性格/ 相关/ 语句/ 关联/ 函数/ Frelate/ :/ S/ →/ / / ALBOOL/ 用于/ 判断/ 源程序/ 中/ 的/ 语句/ s/ 是否/ 属于/ 属/ 性格/ 相关/ 语句/ 的/ 集合/ ,/ 其中/ 属/ 性格/ 相关/ 语句/ 由/ 具体/ 属/ 性格/ 决定/ ,/ BOOL/ 为/ 布尔值/ 集合/ ./ 通常/ 情况/ 下/ ,/ 条件/ 表达式/ 和/ 跳转/ 语句/ 本身/ 不会/ 传播/ 属/ 性格/ 值/ ,/ 因此/ 不会/ 成为/ 属/ 性格/ 相关/ 语句/ ./ 定义/ 4/ ./ 格值/ 映射函数/ Fattr/ :/ V/ →/ VAL/ 是从/ 源程序/ 变量/ 集合/ V/ 到/ 属/ 性格/ AL/ 上格值/ 集合/ VAL/ 的/ 映射/ ./ 表示/ 对/ 变量/ 求其格值/ ./ 3.4/ 过程/ 内/ 流/ 敏感/ 、/ 域/ 敏感/ 的/ 格值/ 计算/ 定义/ 5/ ./ 语句/ 属/ 性格/ 值/ 计算/ 函数/ Fcompute/ :/ S/ →/ BOOL/ ,/ 用于/ 定义/ 源程序/ 语句/ 中/ 所/ 操作/ 的/ 变量/ 的/ 属/ 性格/ 值/ 的/ 计算/ 逻辑/ ,/ 并/ 返回/ 该/ 语句/ 是否/ 会/ 引起/ 变量/ 格值/ 变化/ 的/ 信息/ ./ 根据/ 属/ 性格/ 值/ 的/ 计算/ 范围/ ,/ Fcompute/ 具体/ 由/ 过程/ 内格值/ 计算/ 和/ 过程/ 间格值/ 计算/ 构成/ ./ 根据/ 定义/ 2/ ,/ 对于/ 过程/ 内格值/ 计算/ 而言/ ,/ 属/ 性格/ 相关/ 语句/ s/ 是/ 赋值/ 语句/ ,/ 记/ e1/ =/ e2/ ,/ Fcompute/ 的/ 计算/ 规则/ 如下/ :/ 假设/ 有/ ve2/ ∈/ Ve2/ ,/ Ve2/ ∈/ Faccess/ (/ e2/ )/ 及/ ve1/ ∈/ Ve1/ ,/ Ve1/ ∈/ Faccess/ (/ e1/ )/ :/ (/ a/ )/ 若/ ve2/ / domain/ (/ Fattr/ )/ ,/ 则/ Fattr/ (/ ve1/ )/ =/ vAL/ ,/ 其中/ vAL/ ∈/ VAL/ ,/ domain/ (/ Fattr/ )/ 表示/ Fattr/ 的/ 定义域/ ./ (/ b/ )/ 若/ ve2/ ∈/ domain/ (/ Fattr/ )/ ,/ 则/ (/ b/ ./ 1/ )/ 若/ Faccess/ (/ e2/ )/ =/ {/ Ve2/ }/ ,/ 那么/ Fattr/ (/ ve1/ )/ =/ Fattr/ (/ v/ )/ ,/ v/ ∈/ Ve2/ ,/ v/ 为/ 各种/ 形式/ 的/ 直接/ 引用/ ./ (/ b/ ./ 2/ )/ 若/ Faccess/ (/ e2/ )/ =/ {/ Ve2i/ |/ 1/ / i/ / n/ }/ ,/ Ve2i/ 为/ e2/ 涉及/ 的/ 变量/ 集合/ ,/ 那么/ Fattr/ (/ ve1/ )/ =/ Fmeet/ (/ Fattr/ (/ τ/ )/ ,/ Fattr/ (/ vt/ )/ )/ 或者/ Fattr/ (/ ve1/ )/ =/ Funion/ (/ Fattr/ (/ τ/ )/ ,/ Fattr/ (/ vt/ )/ )/ ,/ 其中/ ,/ τ/ 为/ 虚拟/ 的/ 变量/ ,/ Fattr/ (/ τ/ )/ =/ Fmeet/ (/ Fattr/ (/ vj/ )/ ,/ Fattr/ (/ vk/ )/ )/ 或/ Fattr/ (/ τ/ )/ =/ Funion/ (/ Fattr/ (/ vj/ )/ ,/ Fattr/ (/ vk/ )/ )/ ,/ vj/ ≠/ vk/ ≠/ vt/ ,/ vj/ ∈/ Ve2j/ ,/ vk/ ∈/ Ve2k/ ,/ vt/ ∈/ Ve2t/ ,/ 1/ / j/ ,/ k/ ,/ t/ / n/ ./ 注/ :/ 函数调用/ 语句/ 的/ 格值/ 计算/ 参见/ 过程/ 间/ 属/ 性格/ 值/ 计算/ 部分/ ./ 算法/ 1/ 中/ 给出/ 了/ 过程/ 内格值/ 计算/ 算法/ 的/ 描述/ ./ 其中/ in/ _/ attr/ 用于/ 过程/ 间格值/ 计算/ ./ 特别/ 地/ ,/ 当/ in/ _/ attr/ 值为/ NULL/ 时/ 表示/ 对/ 该/ 函数/ 进行/ 上下文/ 无关/ 的/ 过程/ 内格值/ 计算/ ./ Sf/ 表示/ 函数/ f/ 中/ 的/ 语句/ 集合/ ./ 该/ 算法/ 复杂度/ 受/ 函数/ f/ 中/ 的/ 语句/ 数/ n/ (/ 内层/ 循环/ 上限/ 为/ 需要/ 对/ 函数/ f/ 中/ 所有/ 的/ 语句/ 进行/ 遍历/ )/ 和/ 属/ 性格/ 的/ 高度/ h/ (/ while/ (/ change/ )/ 的/ 终止/ 取决于/ 属/ 性格/ 的/ 高度/ )/ 的/ 影响/ ,/ 因此/ 时间/ 复杂度/ 为/ O/ (/ h/ ×/ n/ )/ ./ 基于/ SSA/ 对/ 函数/ f/ 内属/ 性格/ 相关/ 语句/ 进行/ 属/ 性格/ 值/ 计算/ ,/ 可以/ 达到/ 流/ 敏感/ 的/ 效果/ ./ 这/ 是因为/ SSA/ 保证/ 程序/ 中/ 每/ 一个/ 变量/ 引用/ 都/ 有/ 唯一/ 的/ 变量/ 定值/ 到达/ ,/ 也/ 就/ 说/ SSA/ 形式/ 上/ 在/ 表示/ 定值/ 引用/ 关系/ 的/ 基础/ 上/ 通过/ 引入/ 不同/ 的/ 变量名/ 来/ 区分/ 同一个/ 变量/ 在/ 不同/ 程序/ 点/ 的/ 定值/ ,/ 这样/ 算法/ 能够/ 自然/ 区分/ 源程序/ 中/ 同一/ 变量/ 在/ 不同/ 程序/ 点/ 的/ 定值/ 情况/ ,/ 从而/ 实现/ 流/ 敏感/ 的/ 分析/ ./ 同时/ ,/ 该/ 算法/ 的/ 域/ 敏感性/ 体现/ 在/ 实现/ Faccess/ 函数/ 时/ 基于/ 域/ 模型/ 计算/ 一个/ 表达式/ 直接/ 或/ 间接/ 操作/ 的/ 变量/ ./ 算法/ 1/ ./ 过程/ 内格值/ 计算/ 算法/ :/ 基于/ SSA/ 对/ 过程/ 内/ 的/ 属/ 性格/ 相关/ 语句/ 进行/ 属/ 性格/ 值/ 的/ 计算/ ./ 1/ ./ procedureintra/ _/ compute/ (/ f/ ,/ in/ _/ attr/ )/ 2/ ./ boolchange/ =/ true/ ;/ 3/ ./ while/ (/ change/ )/ do4/ ./ change/ =/ false/ ;/ 5/ ./ while/ (/ s/ ∈/ Sf/ )/ do6/ ./ if/ (/ Frelate/ (/ s/ )/ &&/ Fcompute/ (/ s/ )/ )/ then7/ ./ change/ =/ true/ ;/ 8/ ./ endif9/ ./ endwhile10/ ./ endwhile11/ ./ end3/ ./ 5/ 过程/ 间/ 上下文/ 与/ 上下文/ 敏感/ 的/ 格值/ 计算/ 上下文/ 敏感/ 的/ 过程/ 间/ 分析方法/ 可以/ 获得/ 更/ 准确/ 的/ 程序/ 信息/ ,/ 其中/ 的/ 一个/ 重要/ 问题/ 是/ 上下文/ 的/ 刻画/ 以及/ 函数/ 副作用/ 的/ 抽象/ ,/ 典型/ 的/ 上下文/ 包括/ 函数/ 形参/ 和/ 全局/ 量/ 等/ ,/ 当/ 调用/ 点/ 数量/ 众多/ 的/ 时候/ ,/ 分析/ 开销/ 很大/ ./ 因此/ ,/ 如何/ 有效/ 避免/ 上下文/ 计算/ 规模/ 随/ 调用/ 点/ 个数/ 呈/ 指数/ 增长/ [/ 15/ ]/ 是/ 关键问题/ 之一/ ./ 本文/ 提出/ 的/ 传播/ 引擎/ 中/ 实现/ 了/ 一种/ 基于/ 摘要/ 的/ 上下文/ 敏感/ 的/ 格值/ 计算方法/ ,/ 充分利用/ 高精度/ 的/ 程序/ 分析/ 获得/ 准确/ 的/ 定值/ -/ 引用/ 信息/ ,/ 并/ 在/ 此基础/ 上/ 构建/ 精确/ 的/ 引用/ 输入/ 和/ 定值/ 输出/ 的/ 函数/ 副作用/ 模型/ ,/ 实现/ 了/ 摘要/ 的/ 高效/ 、/ 准确/ 计算/ ./ (/ 1/ )/ 建模/ ./ 对于/ 属/ 性格/ 值/ 计算/ 与/ 传播/ 中/ 函数/ 副作用/ 的/ 刻画/ ,/ 只/ 需/ 重点/ 关注/ 该/ 函数/ 向上/ 暴露/ 的/ 引用/ 和/ 向下/ 暴露/ 的/ 定值/ ,/ 本文/ 将/ 它们/ 建模/ 为/ 函数/ 的/ 引用/ 输入/ Use/ _/ In/ 集/ Page6/ 合和定/ 值/ 输出/ Def/ _/ Out/ 集合/ ./ 定义/ 6/ ./ 函数/ f/ 的/ 引用/ 输入/ Use/ _/ In/ 集/ :/ 该/ 函数/ 中/ 所有/ 向上/ 暴露/ 引用/ 的/ 形式参数/ 和/ 全局/ 量/ 集合/ ./ 定义/ 7/ ./ 函数/ f/ 的/ 定值/ 输出/ Def/ _/ Out/ 集/ :/ 该/ 函数/ 所有/ 向下/ 暴露/ 定值/ 的/ 返回值/ 和/ 全局/ 量/ 的/ 集合/ ./ 图/ 2/ 所示/ 的/ 工作/ 机制/ 包含/ 两个/ 阶段/ :/ 在/ 函数/ 副作用/ 计算/ 阶段/ ,/ 根据/ 引用/ 输入/ 和/ 定值/ 输出/ ,/ 我们/ 为/ 每个/ 函数/ 计算/ 引用/ 输入/ 的/ “/ 摘要/ ”/ 以/ 获取/ 引用/ 输入/ 在/ 该/ 函数/ 中/ 的/ 引用/ 信息/ ,/ 并/ 为/ 每个/ 定值/ 输出/ 计算/ 具体/ 问题/ 相关/ 的/ “/ 摘要/ ”/ 以/ 获取/ 定值/ 输出/ 在/ 该/ 函数/ 中/ 的/ 定值/ 信息/ ./ 根据/ 是否/ 依赖于/ 引用/ 输入/ 分为/ 两种/ 情形/ :/ 对于/ 不/ 依赖于/ 引用/ 输入/ 的/ 情形/ ,/ 可/ 直接/ 计算/ 完成/ 定值/ 输出/ 的/ 相关/ 属/ 性格/ 值/ ;/ 对于/ 依赖于/ 引用/ 输入/ 的/ 情形/ ,/ 需要/ 在/ 属/ 性格/ 值/ 传播/ 阶段/ 根据/ 具体/ 的/ 上下文/ 进行/ “/ 摘要/ ”/ 计算/ 的/ 更新/ :/ 先/ 在/ 实际/ 的/ 调用/ 点处/ ,/ 将/ 上下文/ 传入/ 给/ 被/ 调/ 函数/ 的/ 引用/ 输入/ ,/ 然后/ 对/ 引用/ 输入/ “/ 摘要/ ”/ 相关/ 的/ 属/ 性格/ 值/ 进行/ 再/ 计算/ ,/ 另一方面/ ,/ 对于/ 依赖于/ 引用/ 输入/ 的/ 定值/ 输出/ 也/ 需/ 重新/ 计算/ 相关/ 变量/ 的/ 属/ 性格/ 值/ ,/ 同时/ 对于/ 定值/ 输出/ 会/ 影响/ 主调/ 函数/ 的/ 情形/ ,/ 还/ 需要/ 进行/ 相应/ 的/ 传出/ 处理/ ,/ 以/ 同步/ 更新/ 调用函数/ 中/ 相关/ 全局/ 量/ 、/ 返回值/ 等/ 的/ 属/ 性格/ 值/ ./ (/ 2/ )/ 上下文/ 敏感/ 的/ 过程/ 间格值/ 计算/ ./ 定义/ 8/ ./ 假设/ 函数/ f/ 中/ 所有/ 被/ 调用函数/ 的/ 调用/ 点/ 的/ 集合/ 为/ CSf/ ,/ 若/ 存在/ cs/ ∈/ CSf/ ,/ 则/ 记/ Actual/ _/ In/ (/ cs/ )/ 是/ 在/ 调用/ 点/ cs/ 处/ 传入/ 函数/ f/ 的/ 实/ 参变量/ 或/ 全局/ 量/ ,/ Actual/ _/ Out/ (/ cs/ )/ 是/ 在/ 调用/ 点/ cs/ 处/ 被/ 函数/ f/ 返回值/ 修改/ 的/ 变量/ 或/ 在/ 函数/ f/ 中/ 修改/ 的/ 全局/ 量/ ,/ ActualIn/ _/ VAL/ (/ cs/ )/ 是/ 在/ 调用/ 点/ cs/ 处/ 传入/ 函数/ f/ 的/ 属/ 性格/ 值/ ,/ DefOut/ _/ VAL/ (/ cs/ )/ 是/ 在/ 调用/ 点/ cs/ 由/ 函数/ f/ 传出/ 的/ 属/ 性格/ 值/ ./ Map/ (/ VAL/ ,/ V/ )/ 表示/ 将/ 属/ 性格/ 值/ 集合/ VAL/ 赋给/ 变量/ 集合/ V/ 中/ 对应/ 变量/ ,/ 即/ Fattr/ (/ v/ )/ =/ vAL/ ,/ 其中/ ,/ v/ ∈/ V/ ,/ vAL/ ∈/ VAL/ ./ 过程/ 间/ 上下文/ 敏感/ 的/ 格值/ 计算/ 需要/ 增加/ 函数调用/ 点处/ 属/ 性格/ 值/ 的/ 传入/ 和/ 传出/ 的/ 工作/ ./ 即/ 过程/ 间/ 上下文/ 敏感/ 的/ 格值/ 计算/ 由/ 3/ 个/ 部分/ 组成/ :/ 将/ 调用/ 点处/ 上下文/ 属/ 性格/ 值/ 传入/ 给/ 引用/ 输入/ (/ Map/ (/ ActualIn/ _/ VAL/ (/ cs/ )/ ,/ Use/ _/ In/ )/ )/ 、/ 函数/ 体内/ 的/ 格值/ 计算/ (/ intra/ _/ compute/ (/ fcs/ _/ callee/ ,/ ActualIn/ _/ VAL/ )/ )/ 以及/ 将/ 定值/ 输出/ 的/ 属/ 性格/ 值/ 传出/ 给/ 主调/ 函数/ 中/ 调用/ 点处/ (/ Map/ (/ DefOut/ _/ VAL/ (/ cs/ )/ ,/ Actual/ _/ Out/ (/ cs/ )/ )/ )/ ./ 规则/ 是/ :/ 对于/ 函数调用/ 语句/ e/ =/ f/ (/ e1/ ,/ e2/ ,/ …/ ,/ en/ )/ 的/ 计算/ (/ a/ )/ 若/ Actual/ _/ Out/ / domain/ (/ Fattr/ )/ ,/ 则/ Fattr/ (/ ve/ )/ =/ vAL/ ,/ 其中/ vAL/ ∈/ VAL/ ,/ ve/ ∈/ Faccess/ (/ e/ )/ ,/ 格值/ 的/ 确定/ 取决于/ 待/ 解决/ 的/ 具体/ 问题/ ./ (/ b/ )/ 若/ Acutal/ _/ Out/ ∈/ domain/ (/ Fattr/ )/ ,/ 则/ Fattr/ (/ ve/ )/ =/ Fmeet/ (/ Finter/ _/ compute/ (/ Fattr/ (/ Actual/ _/ In/ )/ )/ )/ 或者/ Fattr/ (/ ve/ )/ =/ Funion/ (/ Finter/ _/ compute/ (/ Fattr/ (/ Actual/ _/ In/ )/ )/ )/ ,/ ve/ ∈/ Faccess/ (/ e/ )/ ,/ Fmeet/ 或/ Funion/ 函数/ 的/ 选择/ 取决于/ 待/ 解决/ 的/ 具体/ 问题/ 并且/ 可以/ 按照/ 定义/ 5/ 的/ (/ b/ )/ 中/ 方法/ 处理/ 多元/ 集合/ 的/ 情况/ ./ 算法/ 2/ ./ 过程/ 间格值/ 计算/ (/ 上下文/ 敏感/ 的/ 格值/ 传播/ )/ 算法/ ./ 1/ ./ procedureinter/ _/ compute/ (/ P/ )/ 2/ ./ forallf/ ∈/ Pdo3/ ./ intra/ _/ compute/ (/ f/ ,/ NULL/ )/ ;/ 4/ ./ endfor5/ ./ forallf/ ∈/ Pdo6/ ./ forallcs/ ∈/ CSfdo7/ ./ Map/ (/ ActualIn/ _/ VAL/ (/ cs/ )/ ,/ Use/ _/ In/ )/ ;/ 8/ ./ intra/ _/ compute/ (/ fcs/ _/ callee/ ,/ ActualIn/ _/ VAL/ )/ ;/ 9/ ./ Map/ (/ DefOut/ _/ VAL/ (/ cs/ )/ ,/ Actual/ _/ Out/ (/ cs/ )/ )/ ;/ 10/ ./ endfor11/ ./ endfor12/ ./ end/ 算法/ 中/ 第/ 3/ 行处/ 的/ intra/ _/ compute/ (/ f/ ,/ NULL/ )/ 函数/ 用于/ 为/ 一个/ 函数/ f/ 计算/ 摘要/ ./ 第/ 7/ 行处/ 的/ ActualIn/ _/ VAL/ (/ cs/ )/ 可/ 在/ 摘要/ 计算/ 过程/ 中/ 获得/ ./ 第/ 8/ 行处/ 的/ intra/ _/ compute/ (/ fcs/ _/ callee/ ,/ ActualIn/ _/ VAL/ )/ 函数/ 用于/ 在/ 获得/ 具体/ 上下文/ 的/ 情况/ 下/ 对/ 摘要/ 进行/ 实例/ 化/ 计算/ ./ fcs/ _/ callee/ 表示/ 函数/ f/ 在/ 调用/ 点/ cs/ 处所/ 调用/ 的/ 函数/ ,/ 其中/ cs/ 是/ 函数/ f/ 中/ 的/ 一处/ 调用/ 点/ ,/ 在/ 该/ 调用/ 点处/ 的/ 被/ 调用函数/ 用/ fcs/ _/ callee/ 表示/ ./ 在/ 构造/ 函数调用/ 图时/ 我们/ 会/ 使用/ 函数指针/ 分析/ 的/ 结果/ ,/ 将/ 函数指针/ 体现/ 在/ 构造/ 出来/ 的/ 调用/ 图中/ ./ 而/ 对于/ 递归/ 调用/ 的/ 问题/ ,/ 我们/ 会/ 在/ 将/ 函数调用/ 图/ 归约/ 为强/ 连通/ 的/ 有/ 向/ 无环/ Page7/ 图/ ,/ 在/ SCC/ -/ DAG/ 上/ 进行/ 过程/ 间/ 的/ 计算/ 来/ 进行/ 处理/ ./ 假设/ h/ 为格/ 的/ 高度/ ,/ n/ 为/ 程序/ 中/ 的/ 语句/ 数/ ./ 本/ 算法/ 第/ 2/ ~/ 4/ 行对/ 程序/ 中/ 的/ 每/ 一个/ 函数/ f/ 执行/ intra/ _/ compute/ (/ f/ ,/ NULL/ )/ ,/ 其中/ 第/ 3/ 行/ 的/ 执行/ 次数/ 为/ h/ ×/ nf/ ,/ nf/ 表示/ 函数/ f/ 中/ 的/ 语句/ 数/ ,/ 而/ 程序/ 中/ 所有/ 函数/ 的/ 语句/ 数/ 的/ 总和/ 为/ n/ ,/ 因此/ 第/ 2/ ~/ 4/ 行/ 代码段/ 总/ 的/ 执行/ 次数/ 实际/ 为/ h/ ×/ n/ ;/ 第/ 5/ ~/ 11/ 行/ 循环/ 次数/ 受到/ 程序/ 中/ 调用/ 点/ 个数/ 的/ 影响/ ,/ 最坏/ 情况/ 下/ 每条/ 语句/ 都/ 是/ 调用/ 语句/ ,/ 此时/ 循环/ 次数/ 为/ n/ ,/ 而/ 循环/ 内/ 的/ 执行/ 次数/ 同样/ 是/ 不/ 超过/ h/ ×/ n/ ,/ 因此/ 总/ 次数/ 不/ 超过/ h/ ×/ n2/ ./ 考虑/ 到/ 实际/ 应用/ 中属/ 性格/ 的/ 高度/ 通常/ 为/ 一个/ 小/ 常数/ ,/ 因此/ 该/ 算法/ 的/ 实际/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ./ 4/ 实例/ 研究/ :/ 指针/ 引用/ 错误/ 检测/ 很多/ 指针/ 引用/ 错误/ ,/ 如空/ 指针/ 解/ 引用/ 、/ 未/ 赋值/ 引用/ 等/ 都/ 表现/ 为/ 指针/ 变量/ 的/ 定值/ -/ 引用/ 问题/ :/ 在/ 特定/ 的/ 定值/ 点/ 发生/ 了/ 定值/ (/ 未定/ 值/ 、/ 定/ 空值/ 等/ )/ ,/ 而/ 在/ 引用/ 点/ 表现/ 出/ 特定/ 错误/ (/ “/ 野/ ”/ 指针/ 、/ 空/ 指针/ 解/ 引用/ )/ ,/ 我们/ 将/ 这类/ 错误/ 称为/ 定值/ -/ 引用/ 类/ 错误/ ./ 对于/ 这/ 类/ 错误/ ,/ 我们/ 可以/ 利用/ 本文/ 定义/ 的/ 传播/ 引擎/ 来/ 进行/ 检测/ ./ 4.1/ 指针/ 引用/ 错误/ 属/ 性格/ 犃/ 犔/ PTR/ _/ ERR/ 定义/ 9/ ./ 指针/ 引用/ 错误/ 属/ 性格/ ALPTR/ _/ ERR/ 是/ 一个/ 代数/ 系统/ ALPTR/ _/ ERR/ =/ (/ VPTR/ _/ ERR/ ,/ Fmeet/ ,/ Funion/ )/ ,/ 其/ 哈斯/ 图如图/ 3/ 所示/ ./ 图/ 4/ 指针/ 定值/ -/ 引用/ 语法/ 形式/ 4.3/ 指针/ 引用/ 错误/ 格值/ 计算/ 通过/ 使用/ 指针/ 引用/ 错误/ 属/ 性格/ 实例/ 化/ ,/ 本文/ 第/ 3/ 节/ 提出/ 的/ 传播/ 引擎/ 即可/ 完成/ 程序/ 中/ 指针/ 引用/ 错误/ 属/ 性格/ 值/ 的/ 计算/ ./ 为了/ 简化/ 说明/ ,/ 同时/ 也/ 不失/ 一般性/ ,/ 本节/ 以空/ 指针/ 引用/ 错误/ (/ NPD/ )/ 属/ 性格/ 值/ 的/ 计算/ 为/ 实例/ 对/ Fcompute/ 函数/ 的/ 具体/ 规则/ 进行/ 描述/ :/ 在/ 属/ 性格/ ALPTR/ _/ ERR/ 下/ ,/ Fattr/ 函数/ 的/ 定义域/ 为/ 程序/ 中/ 指针/ 变量/ 集合/ ,/ 即/ domain/ (/ Fattr/ )/ =/ {/ v/ |/ v/ ∈/ V/ 且/ v/ 为/ 指针/ 变量/ }/ ./ 对于/ v/ ∈/ domain/ (/ Fattr/ )/ ,/ Fattr/ (/ v/ )/ 的/ 初值/ 为/ BOTTOM/ ./ 当/ 存在/ 右部值/ 为/ NULL/ 的/ 赋值/ 说明/ :/ WRONG/ 表示/ 一定/ 指针/ 引用/ 错误/ ;/ MAYBEWRONG/ 表示/ 可能/ 的/ 指针/ 引用/ 错误/ ;/ MAYBENULL/ 表示/ 指针/ 值/ 可能/ 为/ NULL/ ;/ NULL/ 表示/ 指针/ 值为/ NULL/ ;/ WILD/ 表示/ 指针/ 值未/ 被/ 赋值/ ,/ 即/ “/ 野/ ”/ 指针/ ;/ NORMAL/ 表示/ 指针/ 值为/ 正常/ 的/ 内存地址/ 值/ ;/ BOTTOM/ 对应/ 源程序/ 中/ 的/ 初始/ 属/ 性格/ 值/ ./ 在/ 指针/ 引用/ 错误/ 属/ 性格/ 中/ ,/ VAL/ 即/ VPTR/ _/ ERR/ =/ {/ BOTTOM/ ,/ NULL/ ,/ WILD/ ,/ NORMAL/ ,/ WRONG/ ,/ MAYBEWRONG/ ,/ MAYBENULL/ ,/ TOP/ }/ ./ 4.2/ 指针/ 引用/ 错误/ 的/ 犉/ relate/ 函数/ 产生/ 指针/ 引用/ 错误/ 的/ 定值/ 主要/ 与/ 赋值/ 语句/ 、/ 函数调用/ 语句/ 有关/ ,/ 所以/ 指针/ 引用/ 错误/ 检测/ 主要/ 关心/ 的/ 是/ 指针/ 相关/ 的/ 定值/ 和/ 引用/ ,/ Frelate/ 函数/ 对图/ 4/ 所示/ 形式/ 的/ 语句/ 返回/ 真值/ .#/ RHS/ 为/ 存储/ 对象/ #/ RHS/ 为取/ 变量/ 地址/ #/ RHS/ 为/ 动态存储分配/ ,/ 如/ malloc/ 等/ #/ 指针/ 变量/ #/ 指针/ 解/ 引用/ #/ 数组/ 元素/ #/ 直接/ 结构/ 体/ 成员/ 访问/ #/ 间接/ 结构/ 体/ 成员/ 访问/ #/ 函数/ 名/ #/ 函数指针/ 解/ 引用/ 操作/ 时/ ,/ 左部/ 指针/ 变量/ 的/ 格值/ 会/ 被/ 更新/ 为/ NULL/ ,/ 而/ 对于/ 右部/ 为/ 正常/ 地址/ 值/ 的/ 赋值/ 操作/ ,/ 左部/ 指针/ 变量/ 的/ 格值/ 会/ 被/ 更新/ 为/ NORMAL/ ./ 对于/ WILD/ 的/ 情形/ 在/ 空/ 指针/ 引用/ 错误/ 中/ 实际/ 为/ 未/ 做/ 任何/ 赋值/ 时/ 的/ 格值/ 情形/ ./ Faccess/ (/ e/ )/ 是域/ 敏感/ 的/ ,/ 其/ 定义/ 如下/ :/ (/ 1/ )/ Faccess/ (/ e/ )/ =/ v/ 或/ v/ ./ field/ 或/ v/ [/ i/ ]/ ,/ 如果/ e/ 为/ 直接/ 变量/ 或域/ 或/ 数组/ 元素/ 访问/ ./ (/ 2/ )/ Faccess/ (/ e/ )/ =/ {/ v/ }/ 或/ {/ v/ ./ field/ }/ 或/ {/ v/ [/ i/ ]/ }/ ,/ 如果/ e/ 为/ 指针/ 变量/ 解/ 引用/ 并且/ {/ v/ }/ 或/ {/ v/ ./ field/ }/ 或/ {/ v/ [/ i/ ]/ }/ 为/ Page8/ 相应/ 指针/ 变量/ 的/ 指向/ 集合/ ./ 上述/ 定义/ ./ 可以/ 通过/ 域/ 敏感/ 的/ 指针/ 分析/ 和/ 副作用/ 分析/ 实现/ Use/ _/ In/ 和/ Def/ _/ Out/ 的/ 定义/ 如下/ :/ (/ 1/ )/ Use/ _/ In/ 为/ 函数/ 中/ 所有/ 向上/ 暴露/ 引用/ 的/ 指针/ 型/ 形式参数/ 或/ 全局/ 指针/ 变量/ ./ (/ 2/ )/ Def/ _/ Out/ 为/ 该/ 函数/ 中/ 所有/ 向下/ 暴露/ 定值/ 的/ 指针/ 型/ 返回值/ 或/ 全局/ 指针/ 变量/ ./ 以空/ 指针/ 引用/ 错误/ 问题/ 为例/ ,/ 对于/ 赋值/ 语句/ s/ :/ e1/ =/ e2/ ;/ 属/ 性格/ 值/ 计算/ 需要/ 考虑/ 的/ 情形/ ,/ 我们/ 从/ 以下/ 两个/ 方面/ 进行/ 刻画/ :/ (/ 1/ )/ Faccess/ (/ e2/ )/ 是否/ 属于/ domain/ (/ Fattr/ )/ ./ (/ 2/ )/ 定值/ 和/ 引用/ 是/ 一定/ 发生/ 的/ ,/ 还是/ 可能/ 发/ 具体/ 情形/ 参见/ 表/ 1/ 和表/ 2/ ./ 生/ 的/ .&/ y/ ∨/ &/ y/ ./ a/ ∨/ &/ y/ [/ i/ ]/ ∨/ &/ (/ / y/ )/ ./ b/ ∨/ &/ (/ / py/ )/ [/ i/ ]/ y/ ∨/ y/ ./ a/ ∨/ y/ [/ i/ ]/ op/ (/ e1/ ,/ e2/ ,/ …/ ,/ en/ )/ libfunc/ (/ parm1/ ,/ …/ ,/ parmn/ )/ (/ / y/ )/ ∨/ (/ / y/ )/ ./ a/ ∨/ (/ / py/ )/ [/ i/ ]/ √/ func/ (/ parm1/ ,/ …/ ,/ parmn/ )/ √/ 注/ :/ 将/ phi/ 看作/ 一种/ 特殊/ 的/ op/ ./ phi/ 是/ SSA/ 中/ 的/ 分支/ 汇流/ 处理函数/ ./ Must/ :/ x/ ∨/ x/ ./ a/ ∨/ x/ [/ i/ ]/ May/ :/ / x/ ∨/ (/ / x/ )/ ./ a/ ∨/ (/ / px/ )/ [/ i/ ]/ 可能/ 基于/ 上述/ 表示/ ,/ NPD/ 的/ 属/ 性格/ 值/ 计算/ 规则/ 如下/ :/ 规则/ 1/ ./ e1/ :/ Must/ _/ Defe2/ :/ Must/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ / domain/ (/ Fattr/ )/ ∧/ 上述/ 规则/ 处理/ 赋值/ 语句/ 左部/ 为/ 一定/ 定值/ ,/ 右部/ 为/ Faccess/ (/ e2/ )/ / domain/ (/ Fattr/ )/ 的/ 情形/ (/ 包括/ 右部/ 为/ 取/ 地址/ 形式/ 、/ 直接/ 为/ NULL/ 以及/ 可能/ 返回/ NULL/ 的/ 特殊/ 库/ 函数调用/ 的/ 形式/ )/ ,/ 这些/ 情况/ 下/ ,/ 直接/ 将/ 相应/ 的/ 属/ 性格/ 值赋/ 给/ 左部/ 的/ 指针/ 变量/ ./ 规则/ 2/ ./ e1/ :/ May/ _/ Defe2/ :/ Must/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ / domain/ (/ Fattr/ )/ ∧/ vAL/ ∈/ {/ NULL/ ,/ NORMAL/ ,/ MAYBENULL/ }/ Fattr/ (/ Faccess/ (/ e1/ )/ )/ / Fmeet/ (/ Fattr/ (/ Faccess/ (/ e1/ )/ )/ ,/ vAL/ )/ ./ 规则/ 2/ 与/ 规则/ 1/ 的/ 不同之处/ 在于/ 左部/ 为/ 可能/ 定值/ 的/ 形式/ ,/ 此时/ 需将/ Faccess/ (/ e1/ )/ 中/ 指针/ 变量/ 的/ 属/ 性格/ 值/ 与/ 右部/ 直接/ 获取/ 的/ 属/ 性格/ 值/ 进行/ Fmeet/ 函数/ 运算/ ,/ 这/ 主要/ 是因为/ Faccess/ (/ e1/ )/ 中/ 的/ 指针/ 变量/ 是/ e1/ 可能/ 指向/ 的/ ,/ 若/ 不/ 做/ Fmeet/ 函数/ 运算/ ,/ 而是/ 直接/ 将/ 右部/ 的/ 属/ 性格/ 值赋/ 给/ 这些/ 变量/ 的话/ ,/ 将/ 可能/ 引起/ 漏报/ 或/ 误报/ ./ 例如/ ,/ 假设/ 指针/ 变量/ x/ 之前/ 已有/ 的/ 属/ 性格/ 值为/ NULL/ ,/ 而/ 此次/ 右部/ 的/ 属/ 性格/ 值为/ NORMAL/ ,/ 若/ 简单/ 地/ 认为/ x/ 的/ 属/ 性格/ 值/ 变为/ NORMAL/ 的话/ ,/ 因为/ x/ 是/ 可能/ 指向/ 的/ 指针/ 变量/ ,/ 也/ 即/ 有/ 可能/ 不/ 指向/ ,/ 那么/ x/ 的/ 属/ 性格/ 值/ 将/ 仍/ 是/ NULL/ ,/ 但/ 却/ 会/ 因为/ 被/ 误认为/ 是/ NORMAL/ 而/ 引发/ 漏报/ ./ 类似/ 地/ ,/ 若/ 指针/ 变量/ x/ 之前/ 已有/ 的/ 属/ 性格/ 值为/ 非/ NULL/ ,/ 而/ 此次/ 右部/ 的/ 属/ 性格/ 值为/ NULL/ ,/ 则/ 也/ 可能/ 存在/ 实际/ 属/ 性格/ 值为/ 非/ NULL/ ,/ 却/ 被/ 误认为/ NULL/ 而/ 引起/ 误报/ 的/ 可能/ ./ 规则/ 3/ ./ e1/ :/ Must/ _/ Defe2/ :/ Must/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ ∈/ domain/ (/ Fattr/ )/ 规则/ 3/ 对应/ 左部/ 为/ 一定/ 定值/ 且/ 右部/ 为/ 一定/ 引用/ 的/ 情形/ ,/ 这种/ 情况/ 下/ 只/ 需/ 将/ 右部/ 的/ 属/ 性格/ 值/ 直接/ 赋给/ 左部/ 的/ 指针/ 变量/ ./ Faccess/ (/ e2/ )/ 的/ 具体/ 计算/ 规则/ 参考/ 定义/ 5/ ./ 规则/ 4/ ./ e1/ :/ Must/ _/ Defe2/ :/ May/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ ∈/ domain/ (/ Fattr/ )/ e2/ :/ op/ (/ e21/ ,/ e22/ ,/ …/ ,/ e2n/ )/ ,/ 1/ / i/ / n/ -/ 1Fattr/ (/ Faccess/ (/ e1/ )/ )/ / Fmeet/ (/ Fattr/ (/ Faccess/ (/ e2i/ )/ )/ ,/ 上述/ 规则/ 对应/ 左部/ 为/ 一定/ 定值/ ,/ 右部/ 为/ 运算/ 表达式/ 的/ 情形/ ,/ 在/ 这种/ 情况/ 下/ ,/ 需要/ 对/ 参与/ 运算/ 的/ 各个/ 子/ 表达式/ 分别/ 进行/ Fmeet/ 函数/ 运算/ ,/ 然后/ 再/ 将/ 它们/ 的/ Fmeet/ 函数/ 运算/ 结果/ 赋给/ 左部/ 的/ 指针/ 变量/ ./ 在/ 该/ 规则/ 中/ 包含/ 了/ SSA/ 中/ 分支/ 汇流/ 和/ 函数调用/ 的/ 情形/ ,/ 即将/ SSA/ 中/ 的/ 分支/ 汇流/ 的/ phi/ 运算/ 和/ 函数调用/ 看成/ 是/ 特殊/ 的/ op/ ./ Faccess/ (/ e2i/ )/ 和/ Faccess/ (/ e2i/ +/ 1/ )/ 具体/ 的/ 计算/ 规则/ 参考/ 定义/ 5/ ./ 规则/ 5/ ./ e1/ :/ May/ _/ Defe2/ :/ Must/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ ∈/ domain/ (/ Fattr/ )/ Fattr/ (/ Faccess/ (/ e1/ )/ )/ / Fmeet/ (/ Fattr/ (/ Faccess/ (/ e1/ )/ )/ ,/ 上述/ 规则/ 对应/ 左部/ 为/ 可能/ 定值/ ,/ 右部/ 为/ 一定/ 引/ Page9/ 用/ 的/ 情形/ ,/ 在/ 这种/ 情况/ 下/ ,/ 为了/ 避免出现/ 规则/ 2/ 中/ 说明/ 的/ 漏报/ 和/ 误报/ 的/ 情形/ ,/ 需要/ 将/ Faccess/ (/ e1/ )/ 中/ 指针/ 变量/ 的/ 属/ 性格/ 值/ 与/ Faccess/ (/ e2/ )/ 中/ 指针/ 变量/ 的/ 属/ 性格/ 值/ 进行/ Fmeet/ 函数/ 运算/ ./ Faccess/ (/ e2/ )/ 具体/ 的/ 计算/ 规则/ 参考/ 定义/ 5/ ./ 规则/ 6/ ./ e1/ :/ May/ _/ Defe2/ :/ May/ _/ Use/ ∧/ Faccess/ (/ e2/ )/ ∈/ domain/ (/ Fattr/ )/ e2/ :/ op/ (/ e21/ ,/ e22/ ,/ …/ ,/ e2n/ )/ ,/ 1/ / i/ ,/ j/ / nFattr/ (/ Faccess/ (/ e1/ )/ )/ / Fmeet/ (/ Fattr/ (/ Faccess/ (/ e1/ )/ )/ ,/ Fmeet/ (/ Fattr/ (/ Faccess/ (/ e2i/ )/ )/ ,/ Fattr/ (/ Faccess/ (/ e2j/ )/ )/ )/ )/ 上述/ 规则/ 对应/ 左部/ 为/ 可能/ 定值/ ,/ 右部/ 为/ 可能/ 引用/ 的/ 情形/ ,/ 在/ 这种/ 情况/ 下/ ,/ 需要/ 综合/ 规则/ 2/ 和/ 规则/ 4/ 其中/ :/ ψ/ 表示/ 当前/ 检测/ 环境/ ./ IsErrSource/ (/ ptr/ )/ 表示/ 对/ ptr/ 是否/ 为/ 错误/ 源/ (/ 在/ 传播/ 过程/ 中/ 最先/ 遇到/ 的/ 那些/ 具有/ 错误/ 属/ 性格/ 值/ 的/ 变量/ )/ 的/ 判断/ ,/ IsFirstReport/ (/ ptr/ )/ 用图/ 5NPD/ 判定/ 规则/ 5/ 实验/ 本节/ 以空/ 指针/ 引用/ 错误/ 检测/ 为例/ ,/ 来/ 评估/ 基于/ 传播/ 引擎/ 的/ 错误/ 检测/ 方法/ 的/ 有效性/ ./ 5.1/ 实验/ 环境/ 实验/ 环境/ 为/ AMDOpteron6/ 核/ CPU/ ,/ 主频/ 2.11/ GHz/ ,/ 内存/ 48GB/ 的/ 服务器/ 做单/ 进程/ 实验/ ./ 实验/ 用例/ 包括/ SPEC/ 的/ CINT2000/ 中/ gzip/ 、/ vpr/ 、/ crafty/ 、/ parser/ 以及/ OpenSSH/ 和/ Apache/ 等/ 实用程序/ ./ 这些/ 程序/ 涵盖/ 的/ 应用领域/ 广泛/ ,/ 包括/ 网络应用/ 、/ 数据压缩/ 、/ 集成电路/ 辅助设计/ 、/ 游戏/ 程序/ 、/ 文字处理/ 等/ ,/ 总/ 程序代码/ 量/ 超过/ 48/ 万行/ ,/ 其中/ 最大/ 的/ 超过/ 26/ 万行/ ./ 我们/ 将/ 实验/ 结果/ 与/ 研究型/ 代表/ 工具/ Saturn/ (/ 直接/ 使用/ 1.2/ 版本/ 中/ 提供/ 的/ null/ ./ clp/ 检测/ 文件/ 进行/ 分析/ )/ ,/ 工业界/ 代表/ 工具/ Splint/ 以及/ 同样/ 内/ 置于/ 编译器/ 中/ 的/ 检测工具/ Clang/ -/ SA/ 进行/ 对比/ ,/ 分别/ 从/ 时间/ 开销/ 和/ 检测/ 精度/ (/ 误报率/ 和/ 相对/ 漏报/ 率/ )/ 两个/ 方面/ 进行/ 评价/ ./ 在/ Open64/ 中/ 我们/ 已/ 实现/ 了/ 多/ 敏感/ 的/ 程序/ 分析/ ,/ 主要/ 包括/ 以下/ 特点/ :/ 的/ 处理/ 方式/ ,/ 除了/ 需对/ 右部/ 各子/ 表达式/ 的/ 属/ 性格/ 值/ 进行/ Fmeet/ 函数/ 运算/ 外/ ,/ 还/ 需/ 与/ Faccess/ (/ e1/ )/ 中/ 指针/ 变量/ 的/ 属/ 性格/ 值/ 进行/ Fmeet/ 函数/ 运算/ ./ Faccess/ (/ e2i/ )/ 和/ Faccess/ (/ e2j/ )/ 具体/ 的/ 计算/ 规则/ 参考/ 定义/ 5.4/ ./ 4/ 空/ 指针/ 引用/ 错误/ 检测/ 对空/ 指针/ 引用/ 错误/ 而言/ ,/ 一旦/ 某/ 引用/ 点处/ 指针/ 变量/ 的/ 错误/ 属/ 性格/ 值/ 在/ 检查/ 时/ 被/ 确定/ 为/ NULL/ 或/ MAYBENULL/ (/ 能/ 直接/ 推出/ WRONG/ 和/ MAYBE/ -/ WRONG/ )/ ,/ 就/ 会/ 报告/ 该/ 指针/ 变量/ 发生/ 了/ NPD/ 错误/ 或/ 可能/ 发生/ NPD/ 错误/ ./ 为/ 避免/ 同源/ 错误/ 的/ 过/ 多/ 提示/ ,/ 本文/ 的/ 错误/ 提示/ 机制/ 增加/ 了/ 同源/ 控制/ ,/ 即/ 对于/ 同源/ 的/ 错误/ 仅/ 给出/ 第一处/ 的/ 提示/ ./ 图/ 5/ 给出/ 了/ NPD/ 错误/ 的/ 判定/ 规则/ ./ ptr/ :/ / x/ ∨/ (/ / x/ )/ ./ a/ ∨/ (/ / px/ )/ [/ i/ ]/ Fattr/ (/ Faccess/ (/ ptr/ )/ )/ =/ =/ MAYBENULLIsErrSource/ (/ ptr/ )/ =/ =/ TRUEIsFirstReport/ (/ ptr/ )/ =/ =/ TRUE/ ψ/ / MAYBEWRONG/ 可能/ 空/ 指针/ 解/ 引用/ 错误/ IsFirstReport/ (/ ptr/ )/ =/ =/ FALSE/ 扩展/ 的/ 静态/ 单/ 赋值/ (/ SSA/ )/ 形式/ ,/ 能够/ 在/ 标准/ SSA/ 上/ 有效/ 地/ 表示/ 别名/ 和/ 间接/ 访存/ 操作/ ./ 扩展/ 的/ SSA/ 使用/ μ/ 函数/ 和/ χ/ 函数/ ,/ 分别/ 刻画/ 间接/ 访存/ 或者/ 函数调用/ 语句/ 中/ 可能/ 引用/ 和/ 可能/ 修改/ 的/ 变量/ ,/ 并/ 把/ 这些/ 变量/ 作为/ μ/ 函数/ 和/ χ/ 函数/ 的/ 操作数/ 进行/ 表示/ ./ 域/ 敏感/ 、/ 流/ 敏感/ 、/ 上下文/ 敏感/ 的/ 指针/ 分析/ ,/ 按照/ 指向/ 层次/ 逐层/ 进行/ 指向/ 集/ 的/ 计算/ [/ 14/ ]/ ./ 将/ 多/ 敏感/ 的/ 指针/ 分析/ 与/ 构造/ SSA/ 形式/ 相结合/ ,/ 在/ 指针/ 分析/ 过程/ 中为/ 每个/ 变量/ 构建/ 扩展/ 的/ SSA/ 形式/ ./ 通过/ 层次/ 式/ 分析/ 可以/ 有效/ 构造/ 精确/ 、/ 简洁/ 的/ SSA/ 形式/ ,/ 消除/ 虚假/ 的/ 引用/ 定值/ 点/ ,/ 从而/ 提高/ 引用/ 定值/ 分析/ 的/ 精度/ 和/ 效率/ ./ 5.2/ 检测时间/ 开销/ 分析/ 表/ 3/ 给出/ 了/ OpenSSH/ 、/ Apache/ 以及/ SPECCINT2000/ 中/ 部分/ C/ 程序/ 进行/ NPD/ 错误/ 检测/ 所/ 需/ 的/ 时间/ ,/ 单位/ 为/ s/ ./ 表中/ 每行/ 对应/ 不同/ 检测工具/ 对于/ 同一/ 测试用例/ 所用/ 的/ 检测时间/ ./ 从/ 检测时间/ 数据/ 上/ 看/ ,/ Saturn/ 平均/ 耗时/ 958s/ ,/ Splint/ 平均/ 耗时/ 14s/ ,/ Clang/ -/ SA/ 平均/ 耗时/ 875s/ ,/ Propagator/ 平均/ 耗时/ 12s/ ./ 对于/ 全部/ 的/ 测试用例/ ,/ 传播/ 引擎/ Propagator/ 的/ 检测时间/ 都/ 是/ 最快/ 的/ ./ SaturnPage10/ 表/ 3/ 检测时间/ OpenSSH/ -/ 4.3/ p2Apache/ -/ 2.2/ ./ 4164/ ./ gzip175/ ./ vpr186/ ./ crafty197/ ./ parser/ 几何平均/ “/ -/ ”/ 表示/ 无法/ 成功/ 分析/ 结束/ ./ 注/ :/ 检测时间/ 是/ 使用/ 该/ 工具/ 检查/ 某种/ 类型/ 错误/ 所/ 需/ 的/ 时间/ ,/ 其中/ Clang/ -/ SA/ 未/ 提供/ 单独/ 的/ 空/ 指针/ 引用/ 错误/ 选项/ ,/ 因此/ 为/ 所有/ 检查/ 的/ 时间/ ./ gator/ ,/ 但/ 由于/ Splint/ 缺乏/ 过程/ 间/ 分析/ ,/ 所以/ 检测/ 精/ 和/ Clang/ -/ SA/ 则/ 耗时/ 较长/ ,/ 分别/ 是/ Propagator/ 所用/ 度/ 表现/ 不佳/ ,/ 如/ 5.3/ 节/ 实验/ 数据/ 所示/ ./ 而/ 传播/ 引擎/ 不/ 时间/ 的/ 79/ 倍/ 和/ 72/ 倍/ ./ 这/ 主要/ 是因为/ Saturn/ 进行/ 了/ 仅/ 实现/ 了/ 精确/ 的/ 过程/ 间/ 分析/ ,/ 还/ 实现/ 了/ 高效/ 的/ 检测/ ,/ 可/ 满足/ 性/ 求解/ ,/ Clang/ -/ SA/ 进行/ 了/ 符号执行/ 的/ 缘故/ ./ 它们/ 的/ 方法/ 在/ 理论/ 上/ 是/ 精确/ 的/ ,/ 但/ 由于/ 需要/ 逐条/ 对/ 我们/ 的/ 多项式/ 时间/ 的/ 上下文/ 敏感/ 的/ 检测/ 算法/ 使/ 我们/ 路径/ 进行/ 处理/ ,/ 路径/ 数/ 又/ 是/ 条件/ 分支/ 数/ 的/ 指数/ 级/ ,/ 在/ 在/ 保证/ 检测/ 精度/ 的/ 同时/ 在/ 时间/ 上/ 有/ 明显/ 的/ 优势/ ./ 实际/ 程序/ 中/ 路径/ 数目/ 往往/ 很大/ ,/ 如/ SPECCINT20005/ ./ 3/ 检测/ 精度/ 分析/ 中/ 的/ gzip/ 虽然/ 程序/ 规模/ 只有/ 8/ 千/ 多行/ ,/ 但/ 路径/ 数达表/ 4/ 给出/ 了/ 不同/ 工具/ 对/ 不同/ 测试用例/ 检测/ 所/ 报告/ 的/ 错误/ 数/ 、/ 实错数/ 、/ 误/ 报数/ 和/ 相对/ 漏报/ 的/ 数据/ ./ 其到/ 3.49/ E/ +/ 11/ 条/ [/ 16/ ]/ ./ 因此/ 这/ 两个/ 工具/ 在/ 处理/ 实用程序/ 时/ 往往/ 产生/ 很大/ 的/ 时空/ 开销/ ,/ Saturn/ 甚至/ 因为/ 过中/ 报告/ 数/ 来自/ 于/ 实验/ 收集/ 的/ 数据/ ,/ 实错数/ 、/ 误/ 报数/ 和/ 相对/ 漏报/ 数/ 通过/ 人工/ 分析/ 获得/ ,/ 相对/ 漏报/ 数指/ 的/ 是/ 长/ 的/ 分析/ 时间/ 和/ 过/ 大/ 的/ 存储空间/ 开销/ ,/ 导致/ 不能/ 成功/ 完成/ 分析/ 检测/ ./ Splint/ 的/ 分析/ 时间/ 略大于/ Propa/ -/ 不同/ 工具/ 间/ 的/ 相对/ 漏报/ 个数/ ./ 表/ 4/ 报错/ 情况/ Splint/ 的/ 情况/ 报告/ 实/ 错误/ 报/ 相对/ 漏报/ 程序/ 规模/ OpenSSH4/ ./ 3p2155/ ./ 0514000011211101100Apache/ -/ 2.2/ ./ 4268.9/ -/ -/ -/ -/ 734712/ / 1020111010164/ ./ gzip8/ ./ 60000303000000000175/ ./ vpr17/ ./ 72110202120211100186/ ./ crafty21/ ./ 244053217000910910197/ ./ parser11/ ./ 4/ -/ -/ -/ -/ 523242226420/ 注/ :/ 表中/ “/ -/ ”/ 表示/ 出现/ 错误/ 未/ 成功/ 分析/ 结束/ ;/ 实错/ 包含/ 潜在/ 的/ 实错/ (/ 诸如/ 特定/ 输入/ 才/ 会/ 触发/ 的/ 可能/ 发生/ 的/ 错误/ )/ ;/ “/ / ”/ 表示/ 同源/ 错误/ 仅作/ 单次/ 统计/ ./ 通过/ 对表/ 4/ 中/ 实验/ 数据分析/ 后/ 发现/ ,/ 对于/ 空/ 指针/ 引用/ 错误/ 以下/ 4/ 种/ 情况/ 值得注意/ :/ (/ 1/ )/ 特殊/ 控制流/ 问题/ ./ 在/ 实际/ 程序/ 中/ 经常/ 会/ 存在/ 这样/ 一类/ 处理/ :/ 对/ 指针/ 变量/ 是否/ 为/ NULL/ 进行/ 判定/ ,/ 若为/ NULL/ 则/ 给出/ 错误/ 提示/ 并/ 退出/ 程序执行/ ,/ 因此/ 该/ 指针/ 变量/ 的/ 空/ 指针/ 引用/ 点将/ 不/ 可能/ 到达/ ,/ 如图/ 6/ 中/ 的/ 164/ ./ gzip/ 片段/ 所示/ 的/ 情形/ ,/ 本文/ 称/ 这样/ 的/ 问题/ 为/ 特殊/ 控制流/ 问题/ ./ 这种/ 情况/ 在/ 175/ ./ vpr/ 片段/ ,/ OpenSSH/ 和/ Apache/ 中/ 也/ 存在/ ./ Saturn/ 和/ Clang/ -/ SA/ 均/ 未能/ 处理/ 特殊/ 控制流/ ,/ 这/ 是因为/ Saturn/ 和/ Clang/ -/ SA/ 对/ 各种/ 控制流/ 进行/ 统一/ 处理/ ,/ 无法/ 区别对待/ 特殊/ 控制流/ ./ (/ 2/ )/ 可能/ 返回/ NULL/ 的/ 特殊/ 库/ 函数调用/ 问题/ ./ 一些/ 内存/ 分配/ 函数/ 、/ 字符串/ 处理/ 库函数/ 存在/ 返回值/ 可能/ 为/ NULL/ 的/ 可能/ ,/ 如图/ 6/ (/ b/ )/ 所示/ 的/ 情形/ ,/ 如果/ 检测工具/ 不能/ 识别/ 这种/ 可能/ 为/ NULL/ 的/ 返回值/ ,/ 就/ 会/ 引发/ 漏报/ ./ Saturn/ 和/ Clang/ -/ SA/ 在/ 186/ ./ crafty/ 片段/ 中/ 就/ 因为/ 此/ 原因/ 而/ 存在/ 漏报/ ./ (/ 3/ )/ 汇流点/ 问题/ ./ 在/ 实际/ 程序/ 中/ 会/ 经常出现/ 如下/ 场景/ :/ 将/ 局部/ 指针/ 变量/ 在/ 声明/ 时/ 初始化/ 为/ NULL/ ,/ 之后/ 在/ 分支/ 或/ 循环/ 中/ 进行/ 可能/ 非/ NULL/ 的/ 定值/ ,/ 之后/ 在/ 分支/ 或/ 循环/ 外/ 进行/ 引用/ ,/ 本文/ 将/ 这样/ 的/ 情形/ 称为/ 汇流点/ 问题/ ./ 对于/ 汇流点/ 问题/ ,/ 很多/ 情况/ 下/ 即使/ 进行/ 路径/ 可行性/ 判断/ ,/ 往往/ 也/ 会/ 因为/ 路径/ 表达式/ 过大/ Page11/ 而/ 无法/ 准确/ 判别/ 是否/ 在/ 分支/ 或/ 循环/ 中/ 一定/ 会/ 被/ 定值/ ,/ 如图/ 6/ (/ c/ )/ 所示/ 的/ 186/ ./ crafty/ 的/ 程序/ 片段/ 中/ 给/ 指针/ 变量/ goodmove/ 定非/ NULL/ 值/ 的/ 循环/ 是否/ 一定/ 执行/ 是/ 不/ 确定/ 的/ ,/ 因此/ 在/ 汇流点/ 处/ 指针/ 变量/ 引用/ 时/ 认为/ 相应/ 指针/ 变量/ “/ 可能/ ”/ 为/ NULL/ ,/ 并/ 进而/ 给出/ “/ 可能/ ”/ 为/ NULL/ 的/ 提示/ 是/ 一种/ 折中/ 的/ 处理/ 方式/ ./ 本文/ 的/ 传播/ 引擎/ 即/ 采用/ 了/ 这样/ 的/ 处理/ 方式/ ,/ 虽然/ 可能/ 存在/ 一些/ 的/ 误报/ ,/ 但/ 从/ 开销/ 与/ 收益/ 的/ 综合/ 考虑/ 来说/ 是/ 164/ ./ gzip/ 片段/ :/ 1/ ./ p/ =/ get/ _/ suffix/ (/ name/ )/ ;/ 2/ ./ if/ (/ p/ =/ =/ NULL/ )/ 3/ ./ error/ (/ “/ can/ ’/ trecoversuffix/ \/ n/ ”/ )/ ;/ 4/ ./ / 狆/ =/ ‘/ \/ 0/ ’/ ;/ 175/ ./ vpr/ 片段/ :/ 1/ ./ staticstructs/ _/ bb/ / bb/ _/ coord/ _/ new/ =/ NULL/ ;/ 2/ ./ if/ (/ bb/ _/ coord/ _/ new/ =/ =/ NULL/ )/ 3/ ./ {/ bb/ _/ coord/ _/ new/ =/ (/ structs/ _/ bb/ / )/ my/ _/ malloc/ (/ 2/ / pins/ _/ per/ _/ clb/ / sizeof/ (/ structs/ _/ bb/ )/ )/ ;/ }/ 4/ ./ if/ (/ net/ _/ block/ _/ moved/ [/ k/ ]/ =/ =/ FROM/ )/ 5/ ./ update/ _/ bb/ (/ inet/ ,/ &/ 犫/ 犫/ _/ 犮/ 狅/ 狅/ 狉/ 犱/ _/ 狀/ 犲/ 狑/ [/ bb/ _/ index/ ]/ ,/ &/ bb/ _/ edge/ _/ new/ [/ bb/ _/ index/ ]/ ,/ x/ _/ from/ ,/ y/ _/ from/ ,/ x/ _/ to/ ,/ y/ _/ to/ )/ ;/ 图/ 6/ 实际/ 程序/ 片段/ (/ 其中/ 粗体/ 下划线/ 表示/ 需/ 特殊/ 处理/ 的/ 部分/ ;/ 粗/ 斜体/ 表示/ 可能/ 存在/ 误报/ 或/ 漏报/ 的/ 指针/ 变量/ ;/ (/ d/ )/ 通过/ 对表/ 5/ 数据/ 的/ 观察/ 不难看出/ ,/ 对于/ 所有/ 的/ 实验/ 用例/ ,/ Propagator/ 的/ 平均/ 误报率/ 仅为/ 13/ %/ ,/ 分别/ 为/ Saturn/ 、/ Splint/ 和/ Clang/ -/ SA/ 的/ 28/ %/ 、/ 20/ %/ 和/ 22/ %/ ,/ 并且/ 平均/ 相对/ 漏报/ 率为/ 0/ ,/ 检测/ 精度/ 表现/ 理想/ ./ 而/ 正是/ 因为/ 针对/ 上述/ 4/ 种/ 情况/ 的/ 需求/ ,/ Propagator/ 进行/ 了/ 精确/ 而/ 有效/ 处理/ ,/ 而/ 其它/ 工具/ 受到/ 统一/ 建模/ 和/ 分析方法/ 的/ 限制/ 未能/ 有效/ 进行/ 处理/ ,/ 从而/ Propagator/ 较之/ 对比/ 工具/ 表现/ 出/ 了/ 更/ 多/ 的/ 检测/ 精度/ 优势/ ./ SaturnSplintClang/ -/ SAPropagator/ 相对/ 漏报/ 率/ =/ (/ 相对/ 真实/ 错误/ 总数/ -/ 报告/ 中/ 真实/ 错误/ 数/ )/ // 注/ :/ 误报率/ =/ (/ 报告/ 错误/ 数/ -/ 报告/ 中/ 真实/ 错误/ 数/ )/ // 报告/ 错误/ 总数/ ,/ 6/ 结论/ 与/ 展望/ 本文/ 提出/ 一种/ 基于/ 传播/ 引擎/ 的/ 指针/ 引用/ 错误/ 检测/ 方法/ ,/ 该/ 方法/ 充分利用/ 编译器/ 已有/ 的/ 程序/ 分析/ 技/ 可以/ 接受/ 的/ ./ (/ 4/ )/ 不/ 健全/ 的/ 过程/ 间/ 分析/ 引发/ 的/ 问题/ :/ 例如/ 图/ 6/ (/ d/ )/ 所示/ 的/ 175/ ./ vpr/ 程序/ 片段/ 中/ ,/ bb/ _/ coord/ _/ new/ 为/ NULL/ 时/ 的/ 定值/ 由/ 函数/ my/ _/ malloc/ 的/ 返回值/ 确定/ ,/ 而/ 通过/ 对/ my/ _/ malloc/ 函数/ 分析/ 后/ 发现/ 其/ 返回值/ 不/ 可能/ 为/ NULL/ ,/ 因此/ ,/ 在/ 程序/ 片段/ 第/ 5/ 行处/ 的/ 关于/ bb/ _/ coord/ _/ new/ 的/ 空/ 指针/ 引用/ 错误/ 提示/ 是/ 一处/ 误报/ ./ Splint/ 就/ 存在/ 这样/ 的/ 误报/ ./ 术/ ,/ 实现/ 了/ 流/ 敏感/ 、/ 域/ 敏感/ 和/ 上下文/ 敏感/ 的/ 程序/ 分析/ ,/ 借助/ 流/ 敏感/ 、/ 域/ 敏感/ 和/ 上下文/ 敏感/ 的/ 传播/ 引擎/ 检测/ 框架/ ,/ 获得/ 了/ 很/ 好/ 的/ 检测/ 精度/ 和/ 可扩展性/ ./ 经过/ 应用领域/ 广泛/ 的/ 超过/ 48/ 万行/ 的/ 典型/ 应用/ 检测/ ,/ 实验/ 结果表明/ :/ 基于/ 传播/ 引擎/ 的/ 错误/ 检测/ 技术/ ,/ 检测时间/ 平均/ 12s/ ,/ 误报率/ 仅为/ 13/ %/ ,/ 而且/ 没有/ 相对/ 漏报/ ,/ 达到/ 了/ 既/ 提高/ 检测/ 精度/ 又/ 保证/ 可扩展性/ 的/ 效果/ ,/ 有望/ 发展/ 为/ 实用/ 的/ 检测工具/ ./ 需要/ 说明/ 的/ 是/ 目前/ 传播/ 引擎/ 主要/ 应用/ 于定值/ -/ 引用/ 类/ 错误/ 的/ 检测/ ,/ 这些/ 错误/ 表现/ 为/ 在/ 定值/ 点/ 赋予/ 了/ 危险/ 值/ ,/ 而/ 在/ 引用/ 点/ 进行/ 引用/ 时/ 发生/ 错误/ 的/ 情形/ ./ 例如/ ,/ 未/ 赋值/ 引用/ 、/ 空/ 指针/ 引用/ 、/ 缓冲区/ 溢出/ 等/ 错误/ 的/ 检测/ ./ 下/ 一步/ 我们/ 会/ 将/ 该/ 方法/ 应用/ 到/ 更/ 多/ 类型/ 的/ 错误/ 检测/ 工作/ 中/ 去/ ,/ 并且/ 尝试/ 在/ 不/ 引入/ 过多/ 时空/ 开销/ 的/ 情况/ 下/ 增加/ 对/ 路径/ 条件/ 的/ 考虑/ ,/ 进一步提高/ 检测/ 精度/ ./ 

