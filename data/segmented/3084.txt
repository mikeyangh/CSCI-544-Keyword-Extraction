Page1/ 基因组/ 一般/ 移位/ 排序/ 问题/ 的/ 多项式/ 时间/ 算法/ 尹晓/ 朱大铭/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 摘要/ 基因组/ 移位/ 排序/ 在/ 基因组/ 重组/ 排序/ 计算/ 研究/ 中/ 占有/ 重要/ 位置/ ./ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 均/ 为/ 移位/ 的/ 特殊/ 形式/ ./ 目前/ 见到/ 的/ 多种/ 移位/ 排序/ 算法/ 均/ 是/ 针对/ 交互/ 型/ 移位/ 而/ 得到/ 的/ ,/ 未见/ 基因组/ 一般/ 移位/ 排序/ 计算/ 的/ 研究/ 结果/ ./ 文中/ 讨论/ 包括/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 的/ 一般/ 移位/ 排序/ 问题/ 的/ 求解/ 方法/ ,/ 给出/ 该/ 问题/ 的/ 一个/ 多项式/ 时间/ 算法/ ./ 算法/ 的/ 关键在于/ 将/ 一般/ 移位/ 排序/ 问题/ 在/ 线性/ 时间/ 内/ 归约/ 为/ 交互/ 型/ 移位/ 排序/ 问题/ ,/ 利用/ 交互/ 型/ 移位/ 排序/ 的/ 算法/ 来/ 求解/ 一般/ 移位/ 排序/ ./ 作者/ 的/ 算法/ 证实/ 了/ Ozery/ -/ Flato/ 等/ 关于/ 一般/ 移位/ 排序/ 问题/ 可以/ 多项式/ 时间/ 解决/ 的/ 猜测/ ./ 关键词/ 算法/ ;/ 基因组/ 重组/ ;/ 移位/ ;/ 移位/ 距离/ ;/ 计算/ 生物学/ 1/ 引言/ 过程/ ./ 基因组/ 重组/ 的/ 生化/ 过程/ 非常复杂/ ,/ 但/ 可/ 将/ 其/ 归/ 为/ 3/ 种/ 基本操作/ ,/ 即/ 反转/ (/ reversal/ )/ 、/ 移位/ (/ transloca/ -/ tion/ )/ 和/ 转位/ (/ transposition/ )/ ./ 基因组/ 重组/ 排序/ 要求/ 基因组/ 重组/ 是/ 基因组/ 改变/ 基因/ 排列/ 顺序/ 的/ 生化/ 计算/ 将/ 一个/ 基因组/ 转化/ 为/ 另/ 一个/ 基因组/ 的/ 最/ 短/ 重组/ Page2/ 操作/ 序列/ ,/ 从而/ 推断/ 生命/ 的/ 演化过程/ ./ 基因组/ 重组/ 排序/ 多年/ 来/ 一直/ 是/ 计算/ 生物学/ 的/ 热点问题/ ./ 有/ 向/ 基因组/ 反转/ 和/ 移位/ 排序/ 多项式/ 算法/ 的/ 设计/ 成功/ ,/ 应是/ 20/ 世纪/ 90/ 年代/ 人们/ 用/ “/ 计算/ ”/ 解决/ 分子生物学/ 问题/ 的/ 典型/ 贡献/ [/ 1/ -/ 2/ ]/ ,/ 有关/ 反转/ 和/ 转位/ 排序/ 问题/ 的/ 算法/ 与/ 复杂性/ 主要/ 研究/ 结果/ 见/ 文献/ [/ 3/ -/ 7/ ]/ ./ 本文/ 讨论/ 基因组/ 的/ 移位/ 排序/ 算法/ ./ 移位/ 交换/ 基因组/ 中/ 两条/ 染色体/ 的/ 前缀/ 或/ 后缀/ ./ 若/ 交换/ 的/ 两/ 部分/ 都/ 不/ 为/ 空/ ,/ 则/ 为/ 交互/ 型/ 移位/ ,/ 否则/ 为/ 非/ 交互/ 型/ 移位/ ./ 所谓/ 交互/ 型/ 移位/ 排序/ ,/ 即/ 只/ 通过/ 交互/ 型/ 移位/ 对/ 基因组/ 进行/ 排序/ ./ Hannenhalli/ 最先/ 给出/ 了/ 交互/ 型/ 移位/ 排序/ 问题/ 的/ 多项式/ 时间/ 算法/ ,/ 时间/ 复杂性/ 为/ O/ (/ n3/ )/ [/ 2/ ]/ ,/ 其中/ n/ 为/ 基因组/ 中/ 基因/ 的/ 个数/ ./ 之后/ ,/ 朱等/ 将/ 文献/ [/ 2/ ]/ 算法/ 的/ 时间/ 复杂度/ 改进/ 为/ O/ (/ n2logn/ )/ [/ 8/ ]/ ./ 刘等/ 进一步/ 将/ 算法/ 的/ 时间/ 复杂度/ 改进/ 为/ O/ (/ n2/ )/ [/ 9/ ]/ ./ 最近/ Ozery/ -/ Flato/ 等/ 将/ 交互/ 型/ 移位/ 排序/ 算法/ 的/ 时间/ 复杂度/ 改进/ 为/ O/ (/ nnlog/ 槡/ n/ )/ [/ 10/ ]/ ,/ 这是/ 目前/ 最好/ 的/ 交互/ 型/ 移位/ 排序/ 算法/ ./ 交互/ 型/ 移位/ 排序/ 要求/ 源/ 基因组/ 和/ 目标/ 基因组/ 必须/ 具有/ 相同/ 的/ 尾/ 基因/ 集合/ ./ 然而/ ,/ 在/ 实际/ 的/ 基因组/ 重组/ 排序/ 实例/ 中/ ,/ 源/ 基因组/ 和/ 目标/ 基因组/ 未必/ 具有/ 相同/ 的/ 尾/ 基因/ 集合/ ./ 可以/ 认为/ ,/ 两个/ 基因组/ 具有/ 不同/ 尾/ 基因/ 集合/ ,/ 是/ 因非/ 交互/ 型/ 移位/ 形成/ 的/ ./ 非/ 交互/ 型/ 移位/ 有/ 3/ 种/ 形式/ :/ 合并/ (/ fussion/ )/ 、/ 分裂/ (/ fission/ )/ 与/ 分裂/ -/ 合并/ (/ fission/ -/ fussion/ )/ ./ 合并/ 将/ 两条/ 染色体/ 连接/ 为/ 一条/ ,/ 因而/ 消除/ 两个/ 尾/ 基因/ ;/ 分裂/ 将/ 一条/ 染色体/ 断为/ 两条/ 染色体/ ,/ 从而/ 产生/ 两个/ 新/ 的/ 尾/ 基因/ ;/ 分裂/ -/ 合并/ 先/ 将/ 一条/ 染色体/ 分裂/ 为/ 两段/ ,/ 再/ 将/ 其中/ 一段/ 与/ 另/ 一条/ 染色体/ 合并/ ./ Hannenhalli/ 设计/ 了/ 考虑/ 反转/ 、/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 的/ 多项式/ 算法/ [/ 11/ ]/ ./ Tesler/ 将/ Hannen/ -/ halli/ 的/ 算法/ 实现/ 为/ 基因组/ 排序/ 软件/ [/ 12/ ]/ ,/ 供/ 同行/ 测试/ 和/ 使用/ ./ 但/ 在/ 实际/ 基因组/ 比较/ 中/ ,/ 人们/ 还/ 需/ 经常/ 考虑/ 只/ 包括/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 的/ 基因组/ 重组/ 排序/ 结果/ ./ Ozery/ -/ Flato/ 曾/ 在/ 文献/ [/ 13/ ]/ 中/ 猜测/ ,/ 包括/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 的/ 移位/ 排序/ 问题/ 可以/ 多项式/ 时间/ 解决/ ,/ 但/ 至今/ 未见有人/ 给出/ 该/ 问题/ 的/ 算法/ 与/ 复杂性/ 研究/ 结果/ ./ 我们/ 将/ 包括/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 的/ 移位/ 排序/ 问题/ 称作/ 一般/ 的/ 移位/ 排序/ 问题/ ./ 本文/ 讨论/ 一般/ 移位/ 排序/ 问题/ 的/ 求解/ 方法/ ,/ 给出/ 该/ 问题/ 的/ 一个/ 多项式/ 时间/ 算法/ ./ 本文/ 算法/ 证实/ 了/ Ozery/ -/ Flato/ 的/ 猜测/ ./ 下面/ 将/ 交互/ 型/ 移位/ 排序/ 问题/ 简称/ 为/ SRT/ (/ SortingbyReciprocalTranslocations/ )/ ,/ 将/ 一般/ 移位/ 排序/ 问题/ 简称/ 为/ SGT/ (/ SortingbyGeneralizedTranslocations/ )/ ./ 2/ 预备/ 知识/ 基因组/ 是/ 染色体/ 的/ 集合/ ,/ 每条/ 染色体/ 表示/ 为/ 一个/ 整数/ 序列/ ,/ 其中/ 的/ 整数/ 表示/ 基因/ ./ 在/ 整数/ 前/ 增加/ 一个/ 符号/ ±/ ,/ 表示/ 基因/ 在/ 染色体/ 中/ 的/ 相对/ 方向/ ./ 例如/ ,/ {/ (/ 3/ ,/ -/ 5/ )/ ,/ (/ 2/ ,/ 4/ ,/ -/ 6/ )/ ,/ (/ -/ 1/ ,/ 7/ )/ }/ 表示/ 一个/ 包含/ 7/ 个/ 基因/ 3/ 条/ 染色体/ 的/ 基因组/ ./ 一个/ 基因/ 在/ 同一个/ 基因组/ 中/ 只/ 出现/ 一次/ ,/ 因此/ 若/ 基因组/ A/ 含有/ n/ 个/ 基因/ ,/ 则/ 采用/ 整数/ 集/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ 表示/ A/ 中/ 的/ 所有/ 基因/ ./ 设/ S/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xl/ )/ 为/ 染色体/ 中/ 的/ 一段/ 基因/ 序列/ ,/ -/ S/ =/ (/ -/ xl/ ,/ -/ xl/ -/ 1/ ,/ …/ ,/ -/ x1/ )/ 表示/ S/ 的/ 逆序/ ./ 给定/ 两条/ 染色体/ X/ 和/ Y/ ,/ 若/ X/ =/ Y/ 或/ X/ =/ -/ Y/ ,/ 则/ X/ 与/ Y/ 实际/ 表示/ 同/ 一条/ 染色体/ ,/ 称/ X/ 与/ Y/ 等价/ ./ 若/ 基因组/ A/ 中/ 的/ 每条/ 染色体/ X/ ,/ 在/ 基因组/ B/ 中/ 都/ 存在/ 一条/ 染色体/ Y/ 与/ X/ 等价/ ,/ 则/ 称/ A/ 与/ B/ 等价/ ,/ 记作/ A/ =/ B/ ./ 给定/ 两条/ 染色体/ X/ =/ (/ X1/ ,/ X2/ )/ ,/ Y/ =/ (/ Y1/ ,/ Y2/ )/ ,/ 其中/ X1/ ,/ X2/ ,/ Y1/ ,/ Y2/ 表示/ 基因/ 序列/ ./ 移位/ 将/ X/ 中/ 的/ 基因/ 序列/ X1/ 或/ X2/ ,/ 与/ Y/ 中/ 的/ 基因/ 序列/ Y1/ 或/ Y2/ 交换/ ./ 移位/ 有/ 两种/ 类型/ :/ P/ -/ P/ 移位/ 和/ P/ -/ S/ 移位/ ./ P/ -/ P/ 移位/ 将/ (/ X1/ ,/ X2/ )/ ,/ (/ Y1/ ,/ Y2/ )/ 变为/ (/ Y1/ ,/ X2/ )/ ,/ (/ X1/ ,/ Y2/ )/ ;/ P/ -/ S/ 移位/ 将/ (/ X1/ ,/ X2/ )/ ,/ (/ Y1/ ,/ Y2/ )/ 变为/ (/ -/ Y2/ ,/ X2/ )/ ,/ (/ Y1/ ,/ -/ X1/ )/ ./ 若/ X1/ ,/ X2/ ,/ Y1/ ,/ Y2/ 都/ 不/ 为/ 空/ ,/ 则/ 该/ 移位/ 为/ 交互/ 型/ 移位/ ./ 除了/ 交互/ 型/ 移位/ 外/ ,/ 还有/ 3/ 种非/ 交互/ 型/ 移位/ :/ 分裂/ 、/ 合并/ 、/ 分裂/ -/ 合并/ ./ 分裂/ 将/ 一条/ 染色体/ 断开/ ,/ 形成/ 两条/ 染色体/ ./ X/ 的/ 分裂/ 将/ X/ =/ (/ X1/ ,/ X2/ )/ 变为/ (/ X1/ )/ 和/ (/ X2/ )/ ./ 合并/ 将/ 两条/ 染色体/ 首尾/ 连接/ ,/ 形成/ 一条/ 染色体/ ./ 染色体/ X/ ,/ Y/ 合并/ 后/ 可/ 得到/ (/ X/ ,/ Y/ )/ ,/ (/ -/ X/ ,/ Y/ )/ ,/ (/ X/ ,/ -/ Y/ )/ 或/ (/ -/ X/ ,/ -/ Y/ )/ ./ 分裂/ -/ 合并/ 先/ 将/ 一条/ 染色体/ 分裂/ 为/ 两段/ ,/ 再/ 将/ 其中/ 一段/ 连接/ 到/ 另/ 一条/ 染色体/ 上/ ./ X/ =/ (/ X1/ ,/ X2/ )/ 与/ Y/ 的/ 分裂/ -/ 合并/ 有/ 4/ 种/ 可能/ 的/ 结果/ :/ (/ X1/ )/ ,/ (/ Y/ ,/ X2/ )/ ;/ (/ X1/ )/ ,/ (/ -/ X2/ ,/ Y/ )/ ;/ (/ X1/ ,/ Y/ )/ ,/ (/ X2/ )/ 或/ (/ Y/ ,/ -/ X1/ )/ ,/ (/ X2/ )/ ./ 3/ 种非/ 交互/ 型/ 移位/ 都/ 可/ 看作/ 是/ 移位/ 时/ 交换/ 的/ 某段/ 基因/ 序列/ 为空/ 的/ 特殊/ 情况/ ./ 例如/ ,/ X/ 分裂/ 为/ (/ X1/ )/ 和/ (/ X2/ )/ 可/ 看作/ 是/ (/ X1/ ,/ X2/ )/ 与/ “/ 空/ 染色体/ ”/ (/ / ,/ / )/ 移位/ 得到/ (/ X1/ ,/ / )/ 和/ (/ / ,/ X2/ )/ ./ X/ ,/ Y/ 合并/ 为/ (/ X/ ,/ Y/ )/ 可/ 看作/ 是/ (/ X/ ,/ / )/ 与/ (/ / ,/ Y/ )/ 移位/ 得到/ (/ X/ ,/ Y/ )/ 和/ (/ / ,/ / )/ ;/ X/ =/ (/ X1/ ,/ X2/ )/ 与/ Y/ 分裂/ -/ 合并/ 得到/ (/ X1/ )/ ,/ (/ Y/ ,/ X2/ )/ ,/ 可/ 看作/ 是/ (/ X1/ ,/ X2/ )/ 与/ (/ Y/ ,/ / )/ 移位/ Page3/ 得到/ (/ X1/ ,/ / )/ ,/ (/ Y/ ,/ X2/ )/ ./ 设有/ 一条/ 染色体/ X/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xm/ )/ ,/ 将/ x1/ 和/ -/ xm/ 称作/ X/ 的/ 尾/ 基因/ ./ X/ 的/ 尾/ 基因/ 集合/ 记为/ Tails/ (/ X/ )/ =/ {/ x1/ ,/ -/ xm/ }/ ./ 基因组/ A/ 的/ 尾/ 基因/ 集合/ 记为/ Tails/ (/ A/ )/ =/ ∪/ X/ ∈/ ATails/ (/ X/ )/ ./ 例如/ ,/ Tails/ (/ {/ (/ 1/ ,/ -/ 3/ ,/ -/ 4/ )/ ,/ (/ -/ 5/ ,/ -/ 2/ ,/ 6/ )/ }/ )/ =/ {/ 1/ ,/ 4/ ,/ -/ 5/ ,/ -/ 6/ }/ ./ 若/ 基因组/ A/ 、/ B/ 满足/ Tails/ (/ A/ )/ =/ Tails/ (/ B/ )/ ,/ 则/ 称/ A/ 与/ B/ 是/ 同尾/ 基因组/ ./ 交互/ 型/ 移位/ 排序/ 问题/ 要求/ 源/ 基因组/ 和/ 目标/ 基因组/ 必须/ 是/ 同尾/ 基因组/ ./ 2.1/ 同尾/ 基因组/ 的/ 断点/ 图/ 给定/ 一条/ 染色体/ X/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xm/ )/ ,/ 将/ X/ 的/ 每个/ 基因/ xi/ 都/ 用/ 一个/ 有序/ 的/ 点/ 对/ (/ l/ (/ xi/ )/ ,/ r/ (/ xi/ )/ )/ 代替/ :/ 若/ xi/ 的/ 符号/ 为/ +/ ,/ 则/ l/ (/ xi/ )/ =/ xti/ ,/ r/ (/ xi/ )/ =/ xhi/ ;/ 若/ xi/ 的/ 符号/ 为/ -/ ,/ 则/ l/ (/ xi/ )/ =/ xhi/ ,/ r/ (/ xi/ )/ =/ xti/ ./ 由/ X/ 可/ 得到/ 一个点/ 序列/ l/ (/ x1/ )/ r/ (/ x1/ )/ l/ (/ x2/ )/ r/ (/ x2/ )/ …/ l/ (/ xm/ )/ r/ (/ xm/ )/ ./ 下面/ 我们/ 也/ 将/ 染色体/ X/ 的/ 点/ 序列/ 直接/ 称作/ 染色体/ X/ ./ 对于/ 1/ / i/ / m/ -/ 1/ ,/ 称/ r/ (/ xi/ )/ 与/ l/ (/ xi/ +/ 1/ )/ 在/ X/ 中/ 相邻/ ./ 若/ X/ 是/ 基因组/ A/ 的/ 染色体/ 且点/ u/ ,/ v/ 在/ X/ 中/ 相邻/ ,/ 则/ 称/ u/ ,/ v/ 在/ A/ 中/ 相邻/ ./ 给定/ 同尾/ 基因组/ A/ 、/ B/ ,/ 用/ 以下/ 方法/ 构造/ 断点/ 图/ G/ (/ A/ ,/ B/ )/ :/ 点集/ 为/ V/ =/ {/ u/ :/ u/ =/ xt/ 或/ xh/ ,/ 其中/ x/ 为/ A/ 中/ 的/ 基因/ }/ ./ 设/ u/ ,/ v/ ∈/ V/ ,/ 若/ u/ ,/ v/ 在/ A/ 中/ 相邻/ ,/ 则/ 在/ u/ ,/ v/ 之间/ 连/ 黑边/ ;/ 若/ u/ ,/ v/ 在/ B/ 中/ 相邻/ ,/ 则/ 连灰边/ ./ 设/ A/ (/ 或/ B/ )/ 的/ 基因/ 数为/ n/ ,/ 染色体/ 数为/ N/ ,/ 则/ G/ (/ A/ ,/ B/ )/ 的/ 黑边/ 和/ 灰边/ 数目/ 都/ 为/ n/ -/ N/ ./ 设/ g/ =/ (/ u/ ,/ v/ )/ 为/ G/ (/ A/ ,/ B/ )/ 中/ 的/ 一条/ 灰边/ ,/ 若/ u/ ,/ v/ 在/ A/ 中/ 位于/ 同/ 一条/ 染色体/ ,/ 则/ 称/ g/ 为/ 体内/ 灰边/ ;/ 否则/ ,/ 称/ g/ 为/ 体间/ 灰边/ ./ G/ (/ A/ ,/ B/ )/ 中点/ 的/ 度/ 都/ 为/ 0/ 或/ 2/ ,/ 因而/ G/ (/ A/ ,/ B/ )/ 可/ 唯一/ 地/ 分解/ 为/ 黑边/ 和/ 灰边/ 交替/ 且/ 顶点/ 互不/ 重叠/ 的/ 圈/ ./ 只有/ 一条/ 黑边/ 的/ 圈/ 称作/ 短圈/ ,/ 否则/ 称作/ 长圈/ ./ 当/ A/ =/ B/ 时/ ,/ G/ (/ A/ ,/ B/ )/ 由/ n/ -/ N/ 个/ 短圈/ 构成/ ./ 2.2/ 最/ 小子/ 排列/ 和/ 偶/ 隔离带/ 给定/ 基因组/ A/ 的/ 染色体/ X/ 上/ 的/ 一段/ 基因/ 序列/ I/ =/ xi/ ,/ xi/ +/ 1/ ,/ …/ ,/ xj/ ,/ 则/ I/ 在/ G/ (/ A/ ,/ B/ )/ 中/ 对应点/ 序列/ l/ (/ xi/ )/ r/ (/ xi/ )/ l/ (/ xi/ +/ 1/ )/ r/ (/ xi/ +/ 1/ )/ …/ l/ (/ xj/ )/ r/ (/ xj/ )/ ./ 定义/ V/ (/ I/ )/ =/ ∪/ i/ / k/ / j/ 设/ I/ =/ xi/ ,/ xi/ +/ 1/ ,/ …/ ,/ xj/ 为/ A/ 的/ 染色体/ X/ 的/ 一段/ 基因/ 序列/ ,/ I/ =/ xi/ ,/ permutation/ (/ xi/ +/ 1/ ,/ …/ ,/ xj/ -/ 1/ )/ ,/ xj/ 为/ B/ 的/ 染色体/ Y/ 的/ 一段/ 基因/ 序列/ ,/ 其中/ permutation/ (/ xi/ +/ 1/ ,/ …/ ,/ xj/ -/ 1/ )/ 表示/ xi/ +/ 1/ ,/ …/ ,/ xj/ -/ 1/ 的/ 一个/ 重/ 排列/ ./ 若/ permutation/ (/ xi/ +/ 1/ ,/ …/ ,/ xj/ -/ 1/ )/ ≠/ xi/ +/ 1/ ,/ …/ ,/ xj/ -/ 1/ ,/ 则/ 称/ I/ 为/ 基因组/ A/ 的/ 一个/ 子/ 排列/ ./ 将/ 不/ 包含/ 任意/ 其它/ 更/ 小子/ 排列/ 的/ 子/ 排列/ 称为/ 一个/ 最/ 小子/ 排列/ ,/ 简记/ 为/ MSP/ (/ MinimumSubPermutation/ )/ ./ 子/ 排列/ I/ 在/ G/ (/ A/ ,/ B/ )/ 中/ 表现/ 为/ 由/ 点集/ IN/ (/ I/ )/ 支撑/ 的/ 一个/ 子图/ ,/ 满足/ :/ (/ 1/ )/ 该子/ 图中/ 不/ 存在/ 边/ (/ u/ ,/ v/ )/ 使/ u/ ∈/ IN/ (/ I/ )/ 而/ v/ / IN/ (/ I/ )/ ;/ (/ 2/ )/ 该子/ 图/ 至少/ 包含/ 一个/ 长圈/ ./ 下面/ 也/ 直接/ 将/ (/ 最小/ )/ 子/ 排列/ I/ 在/ G/ (/ A/ ,/ B/ )/ 中/ 对应/ 的/ 子/ 图/ 称为/ (/ 最小/ )/ 子/ 排列/ ./ 若/ G/ (/ A/ ,/ B/ )/ 满足/ :/ (/ 1/ )/ MSP/ 数为/ 偶数/ ;/ (/ 2/ )/ 所有/ 的/ MSP/ 均/ 被/ 同一个/ 子/ 排列/ 所/ 包含/ ,/ 则/ 称/ G/ (/ A/ ,/ B/ )/ 包含/ 一个/ 偶/ 隔离带/ ./ 2.3/ 交互/ 型/ 移位/ 距离/ 同尾/ 基因组/ A/ 和/ B/ 的/ 交互/ 型/ 移位/ 距离/ 即/ 从/ A/ 转化/ 为/ B/ 的/ 最少/ 交互/ 型/ 移位/ 次数/ ,/ 记作/ dr/ (/ A/ ,/ B/ )/ ./ 令/ c/ (/ A/ ,/ B/ )/ 和/ s/ (/ A/ ,/ B/ )/ 分别/ 表示/ G/ (/ A/ ,/ B/ )/ 中/ 的/ 圈数/ 和/ MSP/ 数/ ./ 定义/ 参数/ f/ (/ A/ ,/ B/ )/ ,/ f/ (/ A/ ,/ B/ )/ =/ 定理/ 1/ (/ Hannenhalli/ )/ [/ 2/ ]/ ./ 同尾/ 基因组/ A/ 、/ B/ 的/ 交互/ 型/ 移位/ 距离/ dr/ (/ A/ ,/ B/ )/ =/ n/ -/ N/ -/ c/ (/ A/ ,/ B/ )/ +/ s/ (/ A/ ,/ B/ )/ +/ f/ (/ A/ ,/ B/ )/ ./ 3/ 一般/ 移位/ 排序/ 下面/ 我们/ 讨论/ A/ 、/ B/ 不/ 一定/ 是/ 同尾/ 基因组/ 的/ 一般/ 情况/ ./ 将/ 交互/ 型/ 移位/ 和/ 非/ 交互/ 型/ 移位/ 统称/ 为/ 移位/ ./ 基因组/ 移位/ 排序/ 问题/ 描述/ 如下/ :/ 实例/ —/ —/ —/ 基因组/ A/ 、/ B/ ,/ A/ 和/ B/ 具有/ 相同/ 的/ 基因/ 将/ A/ 转化/ 为/ B/ 的/ 最少/ 移位/ 次数/ 称为/ A/ 与/ B/ 的/ 移位/ 距离/ ,/ 记为/ d/ (/ A/ ,/ B/ )/ ./ 3.1/ 加帽/ 基因组/ 给定/ 两个/ 基因组/ A/ =/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ ,/ B/ =/ {/ Y1/ ,/ Y2/ ,/ …/ ,/ YN/ }/ ,/ 其中/ Xi/ (/ 1/ / i/ / M/ )/ 和/ Yj/ (/ 1/ / j/ / N/ )/ 分别/ 为/ A/ 和/ B/ 的/ 染色体/ ./ 首先/ 给/ A/ 、/ B/ 添加/ 基因/ ,/ 构造/ 同尾/ 基因组/ ^/ A/ 、/ ^/ B/ ./ 所/ 添加/ 的/ 基因/ 集合/ 为/ Caps/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ C2n/ }/ ,/ 其中/ 对于/ 1/ / k/ / 2n/ ,/ Ck/ =/ {/ n/ +/ k/ }/ ./ 将/ Caps/ 中/ 的/ 元素/ 均/ 称作/ 帽子/ ./ ^/ A/ 、/ ^/ B/ 的/ 构造方法/ 如下/ :/ 给/ A/ 的/ 每条/ 染色体/ Xi/ 的/ 左右两端/ 分别/ 添加/ 帽子/ C2i/ -/ 1/ 和/ C2i/ ,/ 并/ 添加/ n/ -/ M/ 条由/ 两个/ 帽子/ 构成/ 的/ “/ 空/ 染色体/ ”/ ,/ 得到/ 基因组/ ^/ A/ =/ {/ ^/ X1/ ,/ ^/ X2/ ,/ …/ ,/ ^/ Xn/ }/ ,/ 其/ 集合/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ./ 和/ 最/ 短/ 移位/ 序列/ ./ 目标/ —/ —/ —/ 计算/ 将/ A/ 转化/ 为/ B/ 的/ 最少/ 移位/ 次数/ Page4i/ / n/ 时/ ,/ ^/ Xi/ =/ (/ C2i/ -/ 1/ ,/ C2i/ )/ ./ 给/ B/ 的/ 每条/ 染色体/ Yi/ 的/ 左右两端/ 分别/ 添加/ (/ -/ 1/ )/ j/ +/ 1Cj/ 和/ (/ -/ 1/ )/ kCk/ ,/ 并/ 添加/ n/ -/ N/ 条/ “/ 空/ 染色体/ ”/ ,/ 得到/ 基因组/ ^/ B/ =/ {/ ^/ Y1/ ,/ ^/ Y2/ ,/ …/ ,/ ^/ Yn/ }/ ,/ 其中/ ,/ 当/ 1/ / i/ / N/ 时/ ,/ ^/ Yi/ =/ (/ (/ -/ 1/ )/ j/ +/ 1Cj/ ,/ Yi/ ,/ (/ -/ 1/ )/ kCk/ )/ ;/ 当/ N/ </ i/ / n/ 时/ ,/ ^/ Yi/ =/ (/ (/ -/ 1/ )/ j/ +/ 1Cj/ ,/ (/ -/ 1/ )/ kCk/ )/ ,/ 1/ / j/ ,/ k/ / 2n/ 且/ 每个/ 帽子/ 在/ ^/ B/ 中/ 只/ 出现/ 一次/ ./ 我们/ 将/ ^/ A/ 、/ ^/ B/ 分别/ 称为/ A/ 、/ B/ 的/ 加帽/ 基因组/ ./ B/ 共有/ (/ 2n/ )/ !/ // 2n/ -/ N/ (/ n/ -/ N/ )/ !/ 个/ 加帽/ 基因组/ ./ 将/ B/ 的/ 加帽/ 基因组/ 的/ 集合/ 记/ 作/ Γ/ ./ 例如/ :/ A/ =/ {/ (/ 3/ ,/ 4/ )/ ,/ (/ 2/ ,/ 1/ )/ }/ ,/ B/ =/ {/ (/ 1/ )/ ,/ (/ 2/ )/ ,/ (/ 3/ ,/ 4/ )/ }/ ,/ A/ 的/ 加帽/ 基因组/ ^/ A/ =/ {/ (/ 5/ ,/ 3/ ,/ 4/ ,/ 6/ )/ ,/ (/ 7/ ,/ 2/ ,/ 1/ ,/ 8/ )/ ,/ (/ 9/ ,/ 10/ )/ ,/ (/ 11/ ,/ 12/ )/ }/ ,/ B/ 的/ 其中/ 一个/ 加帽/ 基因组/ 为/ ^/ B/ =/ {/ (/ 5/ ,/ 1/ ,/ 6/ )/ ,/ (/ 7/ ,/ 2/ ,/ 8/ )/ ,/ (/ 9/ ,/ 3/ ,/ 4/ ,/ 10/ )/ ,/ (/ 11/ ,/ 12/ )/ }/ ./ 3.2/ 用/ 交互/ 型/ 移位/ 模拟/ 一般/ 移位/ 设/ X/ =/ (/ X1/ ,/ X2/ )/ ,/ Y/ =/ (/ Y1/ ,/ Y2/ )/ 为/ A/ 中/ 的/ 两条/ 染色体/ ./ 其中/ ,/ X1/ ,/ X2/ ,/ Y1/ ,/ Y2/ 表示/ 基因/ 序列/ ,/ 并且/ 可以/ 为空/ ./ 相应/ 地/ ,/ ^/ A/ 中/ 一定/ 存在/ 两条/ X/ ,/ Y/ 添加/ 帽子/ 后/ 的/ 染色体/ ^/ X/ =/ (/ ^/ X1/ ,/ ^/ X2/ )/ =/ (/ Ck/ ,/ X1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ,/ ^/ Y/ =/ (/ ^/ Y1/ ,/ ^/ Y2/ )/ =/ (/ Cl/ ,/ Y1/ ,/ Y2/ ,/ Cl/ +/ 1/ )/ ./ 其中/ ,/ ^/ X1/ =/ (/ Ck/ ,/ X1/ )/ ,/ ^/ X2/ =/ (/ X2/ ,/ Ck/ +/ 1/ )/ ,/ ^/ Y1/ =/ (/ Cl/ ,/ Y1/ )/ ,/ ^/ Y2/ =/ (/ Y2/ ,/ Cl/ +/ 1/ )/ ./ 显然/ ,/ ^/ X1/ ,/ ^/ X2/ ,/ ^/ Y1/ ,/ ^/ Y2/ 都/ 不/ 为/ 空/ ,/ 因而/ 对/ X/ ,/ Y/ 做/ 一次/ 交互/ 型/ 移位/ 、/ 合并/ 、/ 分裂/ 或/ 分裂/ -/ 合并/ 一定/ 等价/ 于/ 对/ ^/ X/ ,/ ^/ Y/ 做/ 一次/ 交互/ 型/ 移位/ ./ 反之/ ,/ 设/ ρ/ 为/ 作用/ 于/ ^/ A/ 的/ 染色体/ ^/ X/ ,/ ^/ Y/ 的/ 一个/ 交互/ 型/ 移位/ ./ 用/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ 表示/ 在/ ^/ X/ 的/ X1/ ,/ X2/ 和/ ^/ Y/ 的/ Y1/ ,/ Y2/ 之间/ 断开/ 做/ P/ -/ P/ 移位/ ,/ 用/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ 表示/ 在/ ^/ X/ 的/ X1/ ,/ X2/ 和/ ^/ Y/ 的/ Y1/ ,/ Y2/ 之间/ 断开/ 做/ P/ -/ S/ 移位/ ./ 有/ 如下/ 情况/ :/ (/ 1/ )/ ^/ X/ ,/ ^/ Y/ 都/ 不是/ 空/ 染色体/ ./ 设/ ^/ X/ =/ (/ Ck/ ,/ X1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ,/ ^/ Y/ =/ (/ Cl/ ,/ Y1/ ,/ Y2/ ,/ Cl/ +/ 1/ )/ ,/ 其中/ X1/ ,/ X2/ ,/ Y1/ ,/ Y2/ 为/ 非空/ 的/ 基因/ 序列/ ./ 相应/ 地/ ,/ A/ 中/ 一定/ 存在/ 两条/ 染色体/ X/ =/ (/ X1/ ,/ X2/ )/ ,/ Y/ =/ (/ Y1/ ,/ Y2/ )/ ./ 若/ ρ/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ ,/ 则/ 得到/ 的/ 新/ 染色体/ 为/ (/ Ck/ ,/ X1/ ,/ Y2/ ,/ Cl/ +/ 1/ )/ 和/ (/ Cl/ ,/ Y1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ./ 显然/ ,/ 去掉/ 帽子/ 后/ ,/ ρ/ 等价/ 于/ X/ ,/ Y/ 的/ 交互/ 型/ 移位/ ρ/ pp/ (/ X/ ,/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ ./ 同样/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ 等价/ 于/ ρ/ ps/ (/ X/ ,/ Y/ ,/ X1X2/ ,/ Y1Y2/ )/ ./ 若/ ρ/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ ClY1/ )/ ,/ 则/ 得到/ 新/ 染色体/ (/ Cl/ ,/ X1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ 和/ (/ Ck/ ,/ Y1/ ,/ Y2/ ,/ Cl/ +/ 1/ )/ ./ 这时/ ρ/ 只是/ 在/ ^/ X/ ,/ ^/ Y/ 之间/ 交换/ 帽子/ Ck/ ,/ Cl/ ,/ 并/ 没有/ 改变/ 染色体/ X/ ,/ Y/ ./ 我们/ 将/ 这种/ 操作/ 称作/ 换帽/ ./ 同样/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ Y2Cl/ +/ 1/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ Y2Cl/ +/ 1/ )/ 和/ ρ/ ps/ (/ ^/ X/ ,/ 若/ ρ/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ Y2Cl/ +/ 1/ )/ ,/ 得到/ 新/ 染色体/ (/ Cl/ ,/ Y1/ ,/ Y2/ ,/ X1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ 和/ (/ Ck/ ,/ Cl/ +/ 1/ )/ ./ 这时/ ρ/ 等价/ 于/ X/ ,/ Y/ 的/ 合并/ ./ 同样/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ ClY1/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ ClY1/ )/ 和/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ Y2Cl/ +/ 1/ )/ 都/ 等价/ 于/ X/ ,/ Y/ 的/ 合并/ ./ 若/ ρ/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ ClY1/ )/ ,/ 则/ 得到/ 新/ 染色体/ (/ Ck/ ,/ X1/ ,/ Y1/ ,/ Y2/ ,/ Cl/ +/ 1/ )/ 和/ (/ Cl/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ./ 这时/ ρ/ 等价/ 于/ X/ ,/ Y/ 的/ 分裂/ -/ 合并/ ./ 同样/ 地/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ ClY1/ )/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y2Cl/ +/ 1/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ Y2Cl/ +/ 1/ )/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ Y1Y2/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ Y1Y2/ )/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ Y1Y2/ )/ 和/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ Y1Y2/ )/ 都/ 等价/ 于/ X/ ,/ Y/ 的/ 分裂/ -/ 合并/ ./ (/ 2/ )/ ^/ X/ 不是/ 空/ 染色体/ ,/ ^/ Y/ 是/ 空/ 染色体/ ./ 设/ ^/ X/ =/ (/ Ck/ ,/ X1/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ,/ ^/ Y/ =/ (/ Cl/ ,/ Cl/ +/ 1/ )/ ,/ 其中/ X1/ ,/ X2/ 不为/ 空/ ./ 相应/ 地/ ,/ A/ 中/ 一定/ 存在/ 一条/ 染色体/ X/ =/ (/ X1/ ,/ X2/ )/ ./ 若/ ρ/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ ClCl/ +/ 1/ )/ ,/ 则/ 得到/ 新/ 染色体/ (/ Ck/ ,/ X1/ ,/ Cl/ +/ 1/ )/ ,/ 和/ (/ Cl/ ,/ X2/ ,/ Ck/ +/ 1/ )/ ./ 去掉/ 帽子/ 后/ ,/ ρ/ 等价/ 于/ X/ 的/ 分裂/ ./ 同样/ 地/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X1X2/ ,/ ClCl/ +/ 1/ )/ 也/ 等价/ 于/ X/ 的/ 分裂/ ./ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ ClCl/ +/ 1/ )/ ,/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ ClCl/ +/ 1/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkX1/ ,/ ClCl/ +/ 1/ )/ ,/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ X2Ck/ +/ 1/ ,/ ClCl/ +/ 1/ )/ 都/ 是/ 换帽/ 操作/ ./ (/ 3/ )/ ^/ X/ ,/ ^/ Y/ 都/ 是/ 空/ 染色体/ ./ 设/ ^/ X/ =/ (/ Ck/ ,/ Ck/ +/ 1/ )/ ,/ ^/ Y/ =/ ρ/ pp/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkCk/ +/ 1/ ,/ ClCl/ +/ 1/ )/ 和/ ρ/ ps/ (/ ^/ X/ ,/ ^/ Y/ ,/ CkCk/ +/ 1/ ,/ ClCl/ +/ 1/ )/ 都/ 是/ 换帽/ 操作/ ./ 根据/ 以上/ 讨论/ 可知/ ,/ A/ 的/ 交互/ 型/ 移位/ 、/ 分裂/ 、/ 合并/ 、/ 分裂/ -/ 合并/ 都/ 对应/ 于/ ^/ A/ 的/ 一个/ 交互/ 型/ 移位/ ,/ ^/ A/ 的/ 交互/ 型/ 移位/ 则/ 对应/ 一个/ 换帽/ 操作/ 或者/ A/ 的/ 一个/ 交互/ 型/ 移位/ 、/ 分裂/ 、/ 合并/ 或/ 分裂/ -/ 合并/ ./ 下面/ 我们/ 证明/ A/ 和/ B/ 的/ 移位/ 距离/ d/ (/ A/ ,/ B/ )/ 恰好/ 等于/ ^/ A/ 与/ B/ 的/ 所有/ 加帽/ 基因组/ 的/ 交互/ 型/ 移位/ 距离/ 的/ 最小值/ ./ 定理/ 2/ ./ d/ (/ A/ ,/ B/ )/ =/ minB/ ^/ ∈/ Γ/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ ./ 证明/ ./ 对/ A/ 做/ 移位/ ρ/ 后/ 得到/ 的/ 新/ 基因组/ 记为/ A/ ·/ ρ/ ./ 假设/ A/ 转化/ 为/ B/ 的/ 最/ 短/ 移位/ 序列/ 为/ ρ/ 1/ ,/ ρ/ 2/ ,/ …/ ,/ ρ/ k/ ,/ 即/ A/ ·/ ρ/ 1/ ·/ ρ/ 2/ ·/ …/ ·/ ρ/ k/ =/ B/ ./ 对于/ 1/ / i/ / k/ ,/ ρ/ i/ 都/ 对应/ 基因组/ ^/ A/ 的/ 一个/ 交互/ 型/ 移位/ ρ/ ^/ i/ ,/ 即/ ^/ A/ ·/ ρ/ ^/ 1/ ·/ ρ/ ^/ 2/ ·/ …/ ·/ ρ/ ^/ k/ =/ ^/ B/ ,/ ^/ B/ ∈/ Γ/ ./ 因而/ d/ (/ A/ ,/ B/ )/ =/ k/ / dr/ (/ ^/ A/ ,/ ^/ B/ )/ / minB/ ^/ ∈/ Γ/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ ./ 设/ dr/ (/ ^/ A/ ,/ ^/ BOPT/ )/ =/ minB/ ^/ ∈/ Γ/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ ,/ 假设/ ^/ A/ 转化/ 为/ ^/ BOPT/ 的/ 最/ 短/ 交互/ 型/ 移位/ 序列/ 为/ ρ/ ^/ 1/ ,/ ρ/ ^/ 2/ ,/ …/ ,/ ρ/ ^/ t/ ,/ 即/ ^/ A/ ·/ (/ Cl/ ,/ Cl/ +/ 1/ )/ ./ Page5/ 作/ ,/ 则/ 对应/ A/ 的/ 一个/ 移位/ ./ 设/ ρ/ ^/ 1/ ,/ ρ/ ^/ 2/ ,/ …/ ,/ ρ/ ^/ t/ 中/ 的/ 非换/ 帽/ 操作数/ 为/ s/ ,/ 将/ 这/ s/ 个/ 操作/ 重新/ 编号/ 为/ ρ/ ^/ 1/ ,/ ρ/ ^/ 2/ ,/ …/ ,/ ρ/ ^/ s/ ,/ s/ / t/ ./ 对于/ 1/ / i/ / s/ ,/ ρ/ ^/ i/ 对应/ A/ 的/ 一个/ 移位/ ρ/ i/ ,/ 即/ A/ ·/ ρ/ 1/ ·/ ρ/ 2/ ·/ …/ ·/ ρ/ s/ =/ B/ ./ 因而/ d/ (/ A/ ,/ B/ )/ / s/ / t/ =/ minB/ ^/ ∈/ Γ/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ ./ 根据/ 定理/ 1/ 和/ 定理/ 2/ ,/ 可用/ 如下/ 方法/ 计算/ A/ 和/ B/ 的/ 移位/ 距离/ 与/ 最/ 短/ 移位/ 序列/ :/ 针对/ B/ 的/ 加帽/ 基因组/ 集合/ Γ/ 中/ 的/ 每个/ 基因组/ ^/ B/ ,/ 使用/ 解答/ SRT/ 问题/ 的/ 算法/ 计算/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ ,/ 选择/ 使/ dr/ (/ ^/ A/ ,/ ^/ B/ )/ 达到/ 最小/ 的/ 加帽/ 基因组/ ^/ BOPT/ ,/ 则/ 可/ 由/ ^/ A/ 转化/ 为/ ^/ BOPT/ 的/ 交互/ 型/ 移位/ 距离/ 与/ 最/ 短/ 交互/ 型/ 移位/ 序列/ ,/ 得到/ 由/ A/ 转化/ 为/ B/ 的/ 移位/ 距离/ 与/ 最/ 短/ 移位/ 序列/ ./ 这种/ 计算方法/ 关于/ n/ 是/ 指数/ 时间/ 的/ ./ 下面/ 我们/ 将/ 与/ ^/ A/ 的/ 交互/ 型/ 移位/ 距离/ 最小/ 的/ B/ 的/ 加帽/ 基因组/ 总记作/ ^/ BOPT/ ./ 我们/ 将/ 在/ 断点/ 图/ 的/ 基础/ 上/ 构造/ 部分/ 图/ ,/ 利用/ 部分/ 图/ 的/ 性质/ 和/ 定理/ 1/ 的/ 交互/ 型/ 移位/ 距离/ 公式/ ,/ 设计/ 一个/ 在/ n/ 的/ 多项式/ 时间/ 内/ 计算/ ^/ BOPT/ 的/ 算法/ ,/ 从而/ 给出/ 一般/ 移位/ 排序/ 的/ 图/ 1/ 部分/ 图/ GP/ (/ A/ ,/ B/ )/ 与/ 构造/ 断点/ 图时/ 选择/ 哪个/ B/ 的/ 加帽/ 基因组/ 无关/ ./ GP/ (/ A/ ,/ B/ )/ 由/ 黑边/ 和/ 灰边/ 交错/ 的/ 圈/ 和/ 路径/ 构成/ ./ 若/ 一条/ 路径/ 只有/ 一条/ 黑/ 边/ ,/ 则/ 称之为/ 短/ 路径/ ,/ 否则/ 称作/ 长/ 路径/ ./ 给/ GP/ (/ A/ ,/ B/ )/ 添加/ n/ +/ N/ 条灰边/ 可/ 将/ 其/ 变为/ 完整/ 的/ 断点/ 图/ ,/ 其中/ n/ -/ N/ 条灰边/ 连接/ 两个/ A/ -/ cap/ ,/ 2N/ 条灰边/ 连接/ 一个/ A/ -/ cap/ 和/ 一个/ B/ -/ tail/ ./ 每种/ 添加/ 灰边/ 的/ 方式/ 都/ 确定/ 了/ 一个/ B/ 的/ 加帽/ 基因组/ ./ 根据/ 定理/ 2/ ,/ 要/ 计算/ ^/ BOPT/ ,/ 只/ 需/ 找/ 一种/ 添加/ 灰边/ 的/ 方法/ ,/ 使得/ GP/ (/ A/ ,/ B/ )/ 添加/ 灰边/ 后/ 得到/ 的/ 断点/ 图/ 的/ 交互/ 型/ 移位/ 距离/ 最小/ ./ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ 路径/ 分类/ :/ 两端/ 都/ 为/ A/ -/ cap/ 的/ 路径/ 为/ AA/ 路径/ ;/ 一端/ 为/ A/ -/ cap/ 一端/ 为/ B/ -/ tail/ 的/ 路径/ 为/ AB/ 路径/ ;/ 两端/ 都/ 为/ B/ -/ tail/ 的/ 路径/ 为/ BB/ 路径/ ./ GP/ (/ A/ ,/ B/ )/ 中/ 的/ AA/ 路径/ 数/ 与/ BB/ 路径/ 数之差/ 为/ n/ -/ N/ ./ GP/ (/ A/ ,/ B/ )/ 中圈/ 和/ 路径/ 的/ 总数/ 记作/ l/ (/ A/ ,/ B/ )/ ,/ 多项式/ 算法/ ./ 4/ 基因组/ 移位/ 排序/ 算法/ 4.1/ 部分/ 图/ 在/ Γ/ 中/ 任选/ 一个/ B/ 的/ 加帽/ 基因组/ ^/ B/ ,/ 构造/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ B/ )/ ./ 在/ G/ (/ ^/ A/ ,/ ^/ B/ )/ 中/ ,/ 每个/ 帽子/ 都/ 对应/ 一个/ 度为/ 0/ 的/ 点/ 和/ 一个/ 度为/ 2/ 的/ 点/ ./ 将/ 对应/ 于/ 帽子/ 的/ 度/ 为/ 2/ 的/ 点/ 称作/ A/ -/ cap/ ./ 每个/ A/ -/ cap/ 都/ 通过/ 灰边/ 与/ 另/ 一个/ A/ -/ cap/ 或/ B/ 的/ 尾/ 基因/ 的/ 点/ 邻接/ ./ 若/ A/ -/ cap/ 通过/ 灰边/ 与/ A/ -/ cap/ 邻接/ ,/ 则/ 表示/ ^/ B/ 中/ 的/ 一条/ 空/ 染色体/ ./ 将/ 与/ A/ -/ cap/ 邻接/ 的/ B/ 的/ 尾/ 基因/ 的/ 点/ 称作/ B/ -/ tail/ ./ 在/ G/ (/ ^/ A/ ,/ ^/ B/ )/ 中/ 去掉/ 以/ A/ -/ cap/ 为/ 端点/ 的/ 灰边/ ,/ 得到/ 的/ 图/ 称作/ G/ (/ ^/ A/ ,/ ^/ B/ )/ 的/ 部分/ 图/ ./ 将/ 这个/ 部分/ 图记/ 作/ GP/ (/ A/ ,/ B/ )/ ./ 例如/ ,/ 给定/ 基因组/ A/ =/ {/ (/ 2/ ,/ 1/ ,/ 3/ ,/ 5/ )/ ,/ (/ 6/ ,/ 8/ ,/ -/ 7/ ,/ 4/ ,/ 10/ ,/ -/ 9/ )/ }/ ,/ B/ =/ {/ (/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ )/ ,/ (/ 5/ ,/ 6/ ,/ 7/ )/ ,/ (/ 8/ ,/ 9/ ,/ 10/ )/ }/ ,/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ B/ )/ 如图/ 1/ (/ a/ )/ 所示/ ,/ 部分/ 图/ GP/ (/ A/ ,/ B/ )/ 如图/ 1/ (/ b/ )/ 所示/ ./ BB/ 路径/ 数记/ 作/ p/ (/ A/ ,/ B/ )/ ./ 4.2/ 半/ 最/ 小子/ 排列/ 设/ I/ 为/ ^/ A/ 中/ 的/ 一段/ 基因/ 序列/ ,/ 若点集/ IN/ (/ I/ )/ 支撑/ 的/ GP/ (/ A/ ,/ B/ )/ 的/ 子/ 图/ 满足/ 以下/ 条件/ ,/ 则/ 称/ 该子/ 图为/ 一个/ 真子/ 排列/ :/ (/ 1/ )/ 不/ 存在/ 边/ (/ u/ ,/ v/ )/ 使/ u/ ∈/ IN/ (/ I/ )/ ,/ v/ / IN/ (/ I/ )/ ;/ (/ 2/ )/ 至少/ 包含/ 一个/ 长圈/ ;/ (/ 3/ )/ 不/ 包含/ 路径/ ./ 若/ 一个/ 真子/ 排列/ 不/ 包含/ 其它/ 真子/ 排列/ ,/ 则/ 称之为/ 真/ 最/ 小子/ 排列/ ,/ 简记/ 为/ RMSP/ (/ RealMinimumSubPermutation/ )/ ./ 若/ IN/ (/ I/ )/ 支撑/ 的/ GP/ (/ A/ ,/ B/ )/ 的/ 子/ 图/ 满足/ 以下/ 条件/ ,/ 则/ 称/ 该子/ 图为/ 一个半/ 子/ 排列/ :/ (/ 1/ )/ 不/ 存在/ 边/ (/ u/ ,/ v/ )/ 使/ u/ ∈/ IN/ (/ I/ )/ ,/ v/ / IN/ (/ I/ )/ ;/ (/ 2/ )/ 至少/ 包含/ 一个/ 长圈/ 或长/ 路径/ ;/ (/ 3/ )/ 不/ 包含/ AA/ 路径/ 和/ BB/ 路径/ ./ 若/ 一个半/ 子/ 排列/ 不/ 包含/ 其它/ 半子/ 排列/ 和/ 真子/ 排列/ ,/ 则/ 称之为/ 半/ 最/ 小子/ 排列/ ,/ 简记/ 为/ SMSP/ (/ SemiMinimumSubPermuation/ )/ ./ Page6/ 例如/ ,/ 图/ 1/ (/ b/ )/ 所示/ 部分/ 图中/ 由/ 点集/ {/ 11h/ ,/ 2t/ ,/ 2h/ ,/ 1t/ ,/ 1h/ ,/ 3t/ }/ 支撑/ 的/ 子/ 图/ 是/ 一个/ SMSP/ ./ SMSP/ 和/ RMSP/ 的/ 区别/ 在于/ :/ SMSP/ 一定/ 包含/ AB/ 路径/ ,/ 而/ RMSP/ 不/ 包含/ 任何/ 路径/ ./ 若/ 将/ 一个/ SMSP/ 中/ 的/ AB/ 路径/ 都/ 用/ 灰边/ 闭合/ ,/ 则/ 该/ SMSP/ 变为/ RMSP/ ./ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ SMSP/ 数记/ 作/ sm/ (/ A/ ,/ B/ )/ ,/ RMSP/ 数记/ 作/ r/ (/ A/ ,/ B/ )/ ./ 设/ S1/ ,/ S2/ 是/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ 两个/ SMSP/ ,/ 若图/ 2/ 相互依赖/ 的/ SMSP/ 和/ 路径/ 性质/ 1/ ./ 设/ S1/ 和/ S2/ 为/ 两个/ 相互依赖/ 的/ SMSP/ ,/ 添加/ 一条/ 灰边/ 连接/ S1/ 中/ AB/ 路径/ 的/ A/ -/ cap/ 和/ S2/ 中/ AB/ 路径/ 的/ B/ -/ tail/ ,/ 则/ S1/ 和/ S2/ 合并/ 为/ 一个/ 新/ 的/ SMSP/ ./ 性质/ 2/ ./ 设/ P1/ 为/ 一条/ AA/ 路径/ ,/ P2/ 为/ 一条/ BB/ 路径/ ,/ P1/ 和/ P2/ 相互依赖/ ./ 若/ 添加/ 一条/ 灰边/ 连接/ P1/ 和/ P2/ ,/ 则/ 会/ 产生/ 一个/ 新/ 的/ SMSP/ ./ 引入/ 参数/ ds/ (/ A/ ,/ B/ )/ ./ 若/ GP/ (/ A/ ,/ B/ )/ 满足/ :/ sm/ (/ A/ ,/ B/ )/ =/ 2/ 且/ 这/ 两个/ SMSP/ 相互依赖/ ,/ 则/ 定义/ ds/ (/ A/ ,/ B/ )/ =/ 1/ ;/ 否则/ 定义/ ds/ (/ A/ ,/ B/ )/ =/ 0/ ./ 引理/ 1/ ./ 若/ GP/ (/ A/ ,/ B/ )/ 满足/ ds/ (/ A/ ,/ B/ )/ =/ 0/ ,/ 则/ 总能/ 添加/ sm/ (/ A/ ,/ B/ )/ // 2/ 条灰边/ ,/ 使/ GP/ (/ A/ ,/ B/ )/ 中/ 减少/ 2/ ×/ sm/ (/ A/ ,/ B/ )/ // 2/ 个/ SMSP/ ./ 证明/ ./ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ sm/ (/ A/ ,/ B/ )/ // 2/ 条灰边/ 减少/ 2/ ×/ sm/ (/ A/ ,/ B/ )/ // 2/ 个/ SMSP/ 的/ 方法/ 如下/ :/ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 相互依赖/ 的/ SMSP/ 对/ 的/ 数目/ 记作/ v/ ./ 若/ v/ =/ 1/ ,/ 可知/ 除了/ 相互依赖/ 的/ 一对/ SMSP/ 外/ ,/ GP/ (/ A/ ,/ B/ )/ 中/ 还/ 存在/ 其它/ SMSP/ (/ 否则/ ds/ (/ A/ ,/ B/ )/ =/ 1/ )/ ./ 在/ 相互依赖/ 的/ 一对/ SMSP/ 中取/ 一个/ SMSP/ ,/ 记作/ S1/ ./ 另取/ 一个/ SMSP/ ,/ 记作/ S2/ ./ 添加/ 一条/ 灰边/ 将/ S1/ 中/ 的/ AB/ 路径/ 的/ A/ -/ cap/ 与/ S2/ 中/ AB/ 路径/ 的/ B/ -/ tail/ 连接/ ./ 若/ v/ >/ 1/ ,/ 将/ 相互依赖/ 的/ SMSP/ 对/ 记为/ PS1/ ,/ PS2/ ,/ …/ ,/ PSv/ ./ 对于/ 1/ / i/ / v/ -/ 1/ ,/ 添加/ 一条/ 灰边/ 连接/ PSi/ 中/ 一个/ SMSP/ 的/ AB/ 路径/ 的/ A/ -/ cap/ 与/ PSi/ +/ 1/ 中/ 一个/ SMSP/ 的/ AB/ 路径/ 的/ B/ -/ tail/ ./ 这时/ 图中/ 任意/ 两个/ SMSP/ 都/ 不/ 相互依赖/ ./ 任取/ 两个/ SMSP/ ,/ 添加/ 灰边/ 连接/ 一个/ SMSP/ 的/ AB/ 路径/ 的/ A/ -/ cap/ 与/ 另/ 一个/ SMSP/ 的/ AB/ 路径/ 的/ B/ -/ tail/ ,/ 直到/ 图中/ 的/ SMSP/ 数/ 小于/ 2/ 为止/ ./ 上述/ 过程/ 中/ 每次/ 添加/ 灰边/ 所/ 连接/ 的/ 两个/ SMSP/ 都/ 不/ 相互依赖/ ,/ 因而/ 每次/ 都/ 会/ 减少/ 2/ 个/ SMSP/ ,/ 因此/ 总共/ 减少/ 了/ 2/ ×/ sm/ (/ A/ ,/ B/ )/ // 2/ 个/ SMSP/ ./ 证毕/ ./ (/ 1/ )/ S1/ 和/ S2/ 位于/ 同/ 一半/ 子/ 排列/ 中/ ;/ (/ 2/ )/ S1/ 和/ S2/ 所在/ 的/ 染色体/ 上/ 没有/ RMSP/ ,/ 则/ 称/ S1/ ,/ S2/ 相互依赖/ ./ 例如/ ,/ 图/ 2/ (/ a/ )/ 中/ S1/ ,/ S2/ 相互依赖/ ./ 设/ P1/ ,/ P2/ 分别/ 是/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ AA/ 路径/ 和/ BB/ 路径/ ,/ 若/ (/ 1/ )/ P1/ 和/ P2/ 的/ 所有/ 顶点/ 均/ 位于/ 同一/ 染色体/ X/ ;/ (/ 2/ )/ 除/ P1/ 和/ P2/ 外/ ,/ X/ 上/ 没有/ 其它/ 路径/ ;/ (/ 3/ )/ X/ 上/ 没有/ RMSP/ 或/ 体间/ 灰边/ 的/ 端点/ ,/ 则/ 称/ P1/ ,/ P2/ 相互依赖/ ./ 例如/ ,/ 图/ 2/ (/ b/ )/ 中/ P1/ 和/ P2/ 相互依赖/ ./ 引理/ 2/ ./ 总能/ 添加/ p/ (/ A/ ,/ B/ )/ 条灰边/ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ 每/ 一条/ BB/ 路径/ 都/ 与/ 一条/ AA/ 路径/ 连接/ ,/ 且/ 添加/ 灰边/ 后/ 不/ 产生/ 新/ 的/ SMSP/ ./ 证明/ ./ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ p/ (/ A/ ,/ B/ )/ 条灰边/ 的/ 方法/ 如下/ :/ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 相互依赖/ 的/ 路径/ 对/ 的/ 数目/ 记作/ w/ ./ 若/ w/ =/ 1/ ,/ 可知/ 除了/ 相互依赖/ 的/ 路径/ 对/ 中/ 的/ AA/ 路径/ 外/ ,/ GP/ (/ A/ ,/ B/ )/ 中/ 一定/ 还/ 存在/ 其它/ AA/ 路径/ ./ 添加/ 一条/ 灰边/ 将/ 相互依赖/ 的/ 路径/ 对/ 中/ 的/ BB/ 路径/ 与/ 路径/ 对外/ 的/ 一条/ AA/ 路径/ 连接/ ./ 若/ w/ >/ 1/ ,/ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 相互依赖/ 的/ 路径/ 对/ 记为/ PP1/ ,/ PP2/ ,/ …/ ,/ PPw/ ./ 对于/ 1/ / i/ / w/ -/ 1/ ,/ 添加/ 一条/ 灰边/ 连接/ PPi/ 中/ 的/ BB/ 路径/ 与/ PPi/ +/ 1/ 中/ 的/ AA/ 路径/ ./ 这时/ 图中/ 任意/ 一对/ AA/ 路径/ 和/ BB/ 路径/ 都/ 不/ 相互依赖/ ./ 继续/ 添加/ 灰边/ 将/ 其余/ 的/ BB/ 路径/ 与/ 任意/ AA/ 路径/ 连接/ ,/ 直到/ 图中/ 不/ 存在/ BB/ 路径/ 为止/ ./ 上述/ 过程/ 共/ 添加/ 了/ p/ (/ A/ ,/ B/ )/ 条灰边/ ,/ 且/ 每/ 条灰边/ 连接/ 的/ BB/ 路径/ 与/ AA/ 路径/ 都/ 不/ 相互依赖/ ,/ 因而/ 不会/ 产生/ 新/ 的/ SMSP/ ./ 4.3/ 计算/ 移位/ 距离/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ 灰边/ 后/ 形成/ 的/ 断点/ 图/ 可能/ 包含/ 偶/ 隔离带/ ,/ 下面/ 考察/ 可能/ 导致/ 偶/ 隔离带/ 形成/ 的/ 部分/ 图/ 结构/ ./ (/ 1/ )/ 若/ GP/ (/ A/ ,/ B/ )/ 中有/ 偶数/ 个/ RMSP/ ,/ 且/ 所有/ 的/ RMSP/ 都/ 被/ 同一/ 真子/ 排列/ 包含/ ,/ 则/ 称/ GP/ (/ A/ ,/ B/ )/ 包含/ 一个/ 真偶/ 隔离带/ ./ 图/ 3/ (/ a/ )/ 所示/ 结构/ 就是/ 一个/ 真偶/ 隔离带/ ./ (/ 2/ )/ 若/ GP/ (/ A/ ,/ B/ )/ 中有/ 偶数/ 个/ RMSP/ ,/ 所有/ 的/ RMSP/ 不能/ 被/ 同一/ 真子/ 排列/ 包含/ ,/ 但/ 都/ 被/ 同一个/ 半子/ 排列/ 包含/ ,/ 则/ 称/ GP/ (/ A/ ,/ B/ )/ 包含/ 一个半/ 偶/ 隔离带/ ./ 图/ 3/ (/ b/ )/ 所示/ 结构/ 为/ 一个半/ 偶/ 隔离带/ ./ 半偶/ 隔离带/ 一定/ 包含/ 一条/ 长/ 的/ AB/ 路径/ ,/ 而/ 真/ Page7/ 偶/ 隔离带/ 不/ 包含/ 任何/ 路径/ ./ 若半偶/ 隔离带/ 中/ 的/ AB/ 路径/ 都/ 闭合/ ,/ 则/ 变为/ 真偶/ 隔离带/ ./ (/ 3/ )/ 若/ GP/ (/ A/ ,/ B/ )/ 包含/ 真偶/ 隔离带/ ,/ sm/ (/ A/ ,/ B/ )/ / 2/ ,/ 并且/ 有/ 两个/ SMSP/ 与/ 所有/ 的/ RMSP/ 都/ 被/ 同一个/ 半子/ 排列/ 所/ 包含/ ,/ 则/ 称/ GP/ (/ A/ ,/ B/ )/ 包含/ 强偶/ 隔离带/ ./ 图/ 3/ (/ c/ )/ 所示/ 结构/ 为/ 一个/ 强偶/ 隔离带/ ./ (/ 4/ )/ 若/ GP/ (/ A/ ,/ B/ )/ 有/ 奇数/ 个/ RMSP/ ,/ 所有/ 的/ RMSP/ 都/ 位于/ 同/ 一条/ 染色体/ X/ ,/ 并/ 被/ 同一个/ 真子/ 排列/ 或半图/ 3/ 可能/ 导致/ 偶/ 隔离带/ 形成/ 的/ 部分/ 图/ 结构/ 注意/ ,/ GP/ (/ A/ ,/ B/ )/ 最/ 多/ 只能/ 包含/ 一个/ 真偶/ 隔离带/ 、/ 半偶/ 隔离带/ 、/ 强偶/ 隔离带/ 或弱/ 偶/ 隔离带/ ./ 引入/ 参数/ o/ (/ A/ ,/ B/ )/ 和/ δ/ (/ A/ ,/ B/ )/ ./ o/ (/ A/ ,/ B/ )/ 的/ 取值/ 方法/ 定义/ 为/ :/ 如果/ r/ (/ A/ ,/ B/ )/ 为/ 奇数/ ,/ 则/ o/ (/ A/ ,/ B/ )/ =/ 1/ ;/ 否则/ o/ (/ A/ ,/ B/ )/ =/ 0/ ./ δ/ (/ A/ ,/ B/ )/ ∈/ {/ 0/ ,/ 1/ ,/ 2/ }/ ,/ δ/ (/ A/ ,/ B/ )/ 的/ 取值/ 方法/ 较/ 复杂/ ,/ 我们/ 逐条/ 给出/ 如下/ :/ 若/ GP/ (/ A/ ,/ B/ )/ 满足/ 下列/ 条件/ 之一/ ,/ 则/ δ/ (/ A/ ,/ B/ )/ =/ 2/ ./ (/ α/ 1/ )/ 包含/ 真偶/ 隔离带/ ,/ 且/ sm/ (/ A/ ,/ B/ )/ =/ 0/ ;/ (/ α/ 2/ )/ 包含/ 强偶/ 隔离带/ ,/ 且/ sm/ (/ A/ ,/ B/ )/ =/ 2/ ./ 若/ GP/ (/ A/ ,/ B/ )/ 满足/ 下列/ 条件/ 之一/ ,/ 则/ δ/ (/ A/ ,/ B/ )/ =/ 1/ ./ (/ β/ 1/ )/ 包含/ 强偶/ 隔离带/ ,/ sm/ (/ A/ ,/ B/ )/ >/ 2/ ;/ (/ β/ 2/ )/ 包含/ 真偶/ 隔离带/ ,/ 不/ 包含/ 强偶/ 隔离带/ ,/ (/ β/ 3/ )/ 包含/ 弱偶/ 隔离带/ ,/ 且/ sm/ (/ A/ ,/ B/ )/ =/ 1/ ;/ (/ β/ 4/ )/ 包含/ 半偶/ 隔离带/ ,/ 且/ sm/ (/ A/ ,/ B/ )/ 为/ 偶数/ ;/ (/ β/ 5/ )/ 包含/ 半偶/ 隔离带/ ,/ sm/ (/ A/ ,/ B/ )/ =/ 1/ ,/ 且/ 唯一/ 的/ (/ β/ 6/ )/ ds/ (/ A/ ,/ B/ )/ =/ 1/ 且/ o/ (/ A/ ,/ B/ )/ =/ 0/ ./ 其它/ 情况/ 下/ ,/ δ/ (/ A/ ,/ B/ )/ =/ 0/ ./ 下面/ 在/ 表示/ 部分/ 图/ GP/ (/ A/ ,/ B/ )/ 满足/ δ/ (/ A/ ,/ B/ )/ 取值/ 条件/ 时/ ,/ 直接/ 使用/ 前面/ 给出/ 的/ 条件/ 编号/ ./ 我们/ 将/ 给出/ 移位/ 距离/ 的/ 精确/ 下界/ ,/ 并/ 证明/ 移位/ 距离/ 可以/ 达到/ 这个/ 下界/ ,/ 从而/ 给出/ 基因组/ 一般/ 移位/ 排序/ 算法/ ./ SMSP/ 与/ 半偶/ 隔离带/ 被/ 同/ 一半/ 子/ 排列/ 包含/ ;/ sm/ (/ A/ ,/ B/ )/ >/ 0/ ;/ 假设/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ n/ +/ N/ 条灰边/ g1/ ,/ g2/ ,/ …/ ,/ gn/ +/ N/ 得到/ G/ (/ ^/ A/ ,/ ^/ B/ )/ ,/ 即/ GP/ (/ A/ ,/ B/ )/ =/ G0G1g/ →/ / / 2/ …/ gn/ +/ →/ / / NGn/ +/ N/ =/ G/ (/ ^/ A/ ,/ ^/ B/ )/ ./ Gi/ 的/ 各项/ 参数/ li/ 、/ 子/ 排列/ 包含/ ./ 若/ X/ 上/ 存在/ 一个/ SMSP/ ,/ 该/ SMSP/ 与/ 所有/ 的/ RMSP/ 都/ 被/ 同一个/ 半子/ 排列/ 所/ 包含/ ,/ 则/ 称/ GP/ (/ A/ ,/ B/ )/ 包含/ 弱偶/ 隔离带/ ./ 若/ 将/ 弱/ 偶/ 隔离带/ 中/ 的/ SMSP/ 闭合/ 为/ RMSP/ ,/ 则/ 它/ 会/ 变为/ 真偶/ 隔离带/ 或半偶/ 隔离带/ ./ 例如/ ,/ 图/ 3/ (/ d/ )/ 和/ (/ e/ )/ 所示/ 的/ 两种/ 结构/ 都/ 是/ 弱/ 偶/ 隔离带/ ,/ (/ d/ )/ 中/ 的/ SMSP/ 闭合/ 后/ 变为/ 真偶/ 隔离带/ ,/ (/ e/ )/ 中/ 的/ SMSP/ 闭合/ 后/ 变为/ 半偶/ 隔离带/ ./ pi/ 、/ ri/ 、/ smi/ 、/ dsi/ 、/ oi/ 、/ δ/ i/ 与/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ 定义/ 相同/ ./ 对于/ 参数/ / ,/ 令/ Δ/ / i/ =/ / i/ -/ / i/ -/ 1/ ,/ 设/ Δ/ i/ =/ (/ li/ -/ pi/ -/ ri/ -/ (/ smi/ +/ oi/ )/ // 2/ -/ δ/ i/ )/ -/ (/ li/ -/ 1/ -/ pi/ -/ 1/ -/ ri/ -/ 1/ -/ (/ smi/ -/ 1/ +/ oi/ -/ 1/ )/ // 2/ -/ δ/ i/ -/ 1/ )/ ./ 引理/ 3/ ./ 对于/ i/ ,/ 1/ / i/ / n/ +/ N/ ,/ 任何/ 情况/ 下/ 添加/ 灰边/ gi/ 都/ 满足/ Δ/ δ/ i/ / -/ 1/ ./ 证明/ ./ 因为/ δ/ ∈/ {/ 0/ ,/ 1/ ,/ 2/ }/ ,/ 若/ δ/ i/ -/ 1/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 显然/ 有/ Δ/ δ/ i/ / -/ 1/ ,/ 因而/ 只/ 需/ 证明/ 当/ δ/ i/ -/ 1/ =/ 2/ 时/ δ/ i/ >/ 0/ 即可/ ./ 当/ δ/ i/ -/ 1/ =/ 2/ 时/ ,/ 有/ 以下/ 两种/ 情况/ :/ (/ 1/ )/ Gi/ -/ 1/ 满足条件/ (/ α/ 1/ )/ ./ 若/ gi/ 连接/ 一对/ 相互依赖/ 的/ AA/ 路径/ 和/ BB/ 路径/ ,/ 则/ 会/ 产生/ 一个/ SMSP/ ,/ 这时/ Gi/ 满足条件/ (/ β/ 2/ )/ ,/ δ/ i/ =/ 1/ ./ 其它/ 情况/ 下/ gi/ 都/ 不会/ 增加/ SMSP/ ,/ Gi/ 仍/ 满足条件/ (/ α/ 1/ )/ ,/ δ/ i/ =/ 2/ ./ (/ 2/ )/ Gi/ -/ 1/ 满足条件/ (/ α/ 2/ )/ ./ 若/ gi/ 将/ 一个/ SMSP/ 变为/ RMSP/ ,/ 则/ Gi/ 满足条件/ (/ β/ 3/ )/ ,/ δ/ i/ =/ 1/ ;/ 若/ gi/ 将/ 两个/ SMSP/ 中/ 的/ AB/ 路径/ 连接/ ,/ 则/ 这/ 两个/ SMSP/ 都/ 被/ 破坏/ ,/ smi/ =/ 0/ ,/ 因而/ Gi/ 满足条件/ (/ α/ 1/ )/ ,/ δ/ i/ =/ 2/ ;/ 若/ gi/ 将/ 一个/ SMSP/ 中/ 的/ AB/ 路径/ 与/ 其它/ 路径/ 连接/ ,/ 则/ 会/ 减少/ 一个/ SMSP/ ./ 这时/ Gi/ 满足条件/ (/ β/ 2/ )/ ,/ δ/ i/ =/ 1/ ;/ 若/ gi/ 连接/ 一对/ 相互依赖/ 的/ AA/ 路径/ 和/ BB/ 路径/ ,/ 则/ 会/ 产生/ 一个/ 新/ 的/ SMSP/ ./ 这时/ Gi/ 满足条件/ (/ β/ 1/ )/ ,/ δ/ i/ =/ 1/ ./ 其它/ 情况/ 下/ gi/ 都/ 不会/ 增加/ 或/ 减少/ SMSP/ ,/ Gi/ 仍/ 满足/ (/ α/ 2/ )/ ,/ δ/ i/ =/ 2/ ./ 上述情况/ 都/ 有/ δ/ i/ >/ 0/ ,/ 因而/ 结论/ 得证/ ./ 证毕/ ./ 引理/ 4/ ./ c/ (/ ^/ A/ ,/ ^/ B/ )/ -/ s/ (/ ^/ A/ ,/ ^/ B/ )/ -/ f/ (/ ^/ A/ ,/ ^/ B/ )/ / l/ (/ A/ ,/ B/ )/ -/ p/ (/ A/ ,/ B/ )/ -/ r/ (/ A/ ,/ B/ )/ -/ (/ sm/ (/ A/ ,/ B/ )/ +/ o/ (/ A/ ,/ B/ )/ )/ // 2/ -/ δ/ (/ A/ ,/ B/ )/ ./ Page8/ 证明/ ./ 只/ 需/ 证明/ 对于/ i/ ,/ 1/ / i/ / n/ +/ N/ ,/ 都/ 有/ Δ/ i/ / 0/ ,/ 则/ 结论/ 得证/ ./ 这/ 是因为/ c/ (/ ^/ A/ ,/ ^/ B/ )/ =/ ln/ +/ N/ ,/ s/ (/ ^/ A/ ,/ ^/ B/ )/ =/ rn/ +/ N/ ,/ pn/ +/ N/ =/ smn/ +/ N/ =/ 0/ ,/ f/ (/ ^/ A/ ,/ ^/ B/ )/ =/ on/ +/ N/ +/ δ/ n/ +/ N/ =/ (/ smn/ +/ N/ +/ on/ +/ N/ )/ // 2/ +/ δ/ n/ +/ N/ ,/ 因而/ c/ (/ ^/ A/ ,/ ^/ B/ )/ -/ s/ (/ ^/ A/ ,/ ^/ B/ )/ -/ f/ (/ ^/ A/ ,/ ^/ B/ )/ =/ ln/ +/ N/ -/ pn/ +/ N/ -/ rn/ +/ N/ -/ (/ smn/ +/ N/ +/ on/ +/ N/ )/ // 2/ -/ δ/ n/ +/ N/ / l0/ -/ p0/ -/ r0/ -/ (/ sm0/ +/ o0/ )/ // 2/ -/ δ/ 0/ =/ l/ (/ A/ ,/ B/ )/ -/ p/ (/ A/ ,/ B/ )/ -/ r/ (/ A/ ,/ B/ )/ -/ (/ sm/ (/ A/ ,/ B/ )/ +/ o/ (/ A/ ,/ B/ )/ )/ // 2/ -/ δ/ (/ A/ ,/ B/ )/ ./ 在/ 下面/ 的/ 证明/ 中/ ,/ 对于/ 固定/ 的/ i/ ,/ 略去/ 参数/ 下标/ “/ i/ ”/ ./ 根据/ gi/ 分为/ 下述/ 多种/ 情况/ 讨论/ ./ 情况/ 1/ ./ gi/ 闭合/ 一条/ AB/ 路径/ ./ 若/ gi/ 不/ 改变/ SMSP/ 的/ 数目/ ,/ 则/ Δ/ l/ =/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ Δ/ sm/ =/ 0/ ./ 但/ gi/ 有/ 可能/ 将/ 半偶/ 隔离带/ 变为/ 真偶/ 隔离带/ ,/ 因而/ Δ/ δ/ / 0/ ,/ 显然/ Δ/ / 0/ ;/ 若/ gi/ 将/ 一个/ SMSP/ 变为/ RMSP/ ,/ 则/ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ 1/ ,/ Δ/ sm/ =/ -/ 1/ ./ Δ/ o/ 可能/ 为/ 1/ 或/ -/ 1/ ,/ 下面/ 分别/ 讨论/ :/ 情况/ 1.1/ ./ 若/ Δ/ o/ =/ 1/ ,/ 则/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ ,/ 又/ 由/ 引理/ 3/ 可知/ Δ/ δ/ / -/ 1/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 1.2/ ./ 若/ Δ/ o/ =/ -/ 1/ ,/ 则/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ -/ 1/ ./ 若要/ 证明/ Δ/ / 0/ ,/ 只/ 需/ 证明/ Δ/ δ/ / 0/ 即可/ ./ 若/ δ/ i/ -/ 1/ =/ 0/ ,/ 显然/ Δ/ δ/ / 0/ ./ 由/ Δ/ r/ =/ 1/ 和/ Δ/ o/ =/ -/ 1/ 可知/ ri/ -/ 1/ 为/ 奇数/ ,/ 因而/ δ/ i/ -/ 1/ ≠/ 2/ ./ 若/ δ/ i/ -/ 1/ =/ 1/ ,/ 由/ ri/ -/ 1/ 为/ 奇数/ 可知/ Gi/ -/ 1/ 只能/ 满足条件/ (/ β/ 3/ )/ ./ 添加/ gi/ 后/ ,/ 唯一/ 的/ SMSP/ 变为/ RMSP/ ,/ Gi/ 包含/ 真偶/ 隔离带/ 或半偶/ 隔离带/ 且/ smi/ =/ 0/ ,/ 因而/ 满足条件/ (/ α/ 1/ )/ 或/ (/ β/ 4/ )/ ,/ 显然/ Δ/ δ/ / 0/ ./ 上述情况/ 都/ 满足/ Δ/ δ/ / 0/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 2/ ./ gi/ 连接/ 一条/ AB/ 路径/ 的/ A/ -/ cap/ 和/ 另/ 一条/ AB/ 路径/ 的/ B/ -/ tail/ ,/ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ./ gi/ 最多/ 可/ 减少/ 两个/ SMSP/ ,/ 因而/ Δ/ sm/ 可能/ 为/ 0/ 、/ -/ 1/ 或/ -/ 2/ ,/ 下面/ 分别/ 讨论/ :/ 情况/ 2.1/ ./ 若/ Δ/ sm/ =/ 0/ ,/ 则/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ ./ 又/ 由/ 引理/ 3/ 可知/ Δ/ δ/ / -/ 1/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 2.2/ ./ 若/ Δ/ sm/ =/ -/ 1/ ,/ 则/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ 或/ -/ 1/ ./ 若/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ ,/ 显然/ Δ/ / 0/ ./ 若/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ -/ 1/ ,/ 要/ 证明/ Δ/ / 0/ ,/ 只/ 需/ 证明/ Δ/ δ/ / 0/ 即可/ ./ 若/ δ/ i/ -/ 1/ =/ 0/ ,/ 显然/ Δ/ δ/ / 0/ ./ 由/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ -/ 1/ 和/ Δ/ (/ sm/ +/ o/ )/ =/ -/ 1/ 可知/ smi/ -/ 1/ +/ oi/ -/ 1/ 为/ 奇数/ ,/ 因而/ δ/ i/ -/ 1/ ≠/ 2/ ./ 若/ δ/ i/ -/ 1/ =/ 1/ ,/ 由/ smi/ -/ 1/ +/ oi/ -/ 1/ 为/ 奇数/ 可知/ Gi/ -/ 1/ 只能/ 满足条件/ (/ β/ 1/ )/ 、/ (/ β/ 2/ )/ 或/ (/ β/ 5/ )/ ./ 若/ Gi/ -/ 1/ 满足条件/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ,/ 减少/ 一个/ SMSP/ 后/ ,/ Gi/ 可能/ 满足条件/ (/ β/ 1/ )/ 、/ (/ β/ 2/ )/ 、/ (/ α/ 1/ )/ 或/ (/ α/ 2/ )/ ,/ 显然/ Δ/ δ/ / 0/ ;/ 若/ Gi/ -/ 1/ 满足条件/ (/ β/ 5/ )/ ,/ 减少/ 一个/ SMSP/ 后/ ,/ Gi/ 满足/ (/ β/ 4/ )/ ,/ Δ/ δ/ =/ 0/ ./ 以上/ 情况/ 都/ 满足/ Δ/ δ/ / 0/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 2.3/ ./ 若/ Δ/ sm/ =/ -/ 2/ ,/ 则/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ -/ 1/ ./ 若要/ 证明/ Δ/ / 0/ ,/ 只/ 需/ 证明/ Δ/ δ/ / 0/ ./ 若/ δ/ i/ -/ 1/ =/ 0/ ,/ 显然/ Δ/ δ/ / 0/ ./ 若/ δ/ i/ -/ 1/ =/ 1/ ,/ 又/ 由/ Δ/ sm/ =/ -/ 2/ 可知/ smi/ -/ 1/ / 2/ ,/ 因而/ Gi/ -/ 1/ 可能/ 满足条件/ (/ β/ 1/ )/ 、/ (/ β/ 2/ )/ 或/ (/ β/ 4/ )/ ./ 若/ Gi/ -/ 1/ 满足条件/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ,/ 减少/ 两个/ SMSP/ 后/ ,/ Gi/ 可能/ 满足条件/ (/ β/ 1/ )/ 、/ (/ β/ 2/ )/ 、/ (/ α/ 1/ )/ 或/ (/ α/ 2/ )/ ,/ 显然/ Δ/ δ/ / 0/ ;/ 若/ Gi/ -/ 1/ 满足/ (/ β/ 4/ )/ ,/ 减少/ 两个/ SMSP/ 后/ ,/ Gi/ 仍然/ 满足/ (/ β/ 4/ )/ ,/ Δ/ δ/ =/ 0/ ./ 若/ δ/ i/ -/ 1/ =/ 2/ ,/ 由/ smi/ -/ 1/ / 2/ 可知/ Gi/ 满足条件/ (/ α/ 2/ )/ ,/ 减少/ 两个/ SMSP/ 后/ Gi/ 满足条件/ (/ α/ 1/ )/ ,/ Δ/ δ/ =/ 0/ ./ 以上/ 情况/ 都/ 有/ Δ/ δ/ / 0/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 3/ ./ gi/ 连接/ 一条/ AA/ 路径/ 和/ 一条/ BB/ 路径/ ./ 若/ 这/ 两条/ 路径/ 不/ 相互依赖/ ,/ 则/ SMSP/ 的/ 数目/ 不变/ ,/ Δ/ l/ =/ Δ/ p/ =/ -/ 1/ ,/ Δ/ r/ =/ Δ/ o/ =/ Δ/ sm/ =/ 0/ ./ 但/ gi/ 有/ 可能/ 产生/ 半偶/ 隔离带/ ,/ 因而/ Δ/ δ/ / 0/ ,/ 可/ 得/ Δ/ / 0/ ./ 若/ 这/ 两条/ 路径/ 相互依赖/ ,/ 则/ 会/ 产生/ 一个/ 新/ 的/ SMSP/ ,/ Δ/ l/ =/ Δ/ p/ =/ -/ 1/ ,/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ 1/ ./ Δ/ (/ sm/ +/ o/ )/ // 2/ 可能/ 为/ 0/ 或/ 1/ ,/ 下面/ 分别/ 讨论/ :/ 情况/ 3.1/ ./ 若/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 1/ ,/ 又/ 由/ 引理/ 3/ 可知/ Δ/ δ/ / -/ 1/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 3.2/ ./ 若/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ ./ 要/ 证明/ Δ/ / 0/ ,/ 只/ 需/ 证明/ Δ/ δ/ / 0/ ./ 若/ δ/ i/ -/ 1/ =/ 0/ ,/ 显然/ Δ/ δ/ / 0/ ./ 由/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ 和/ Δ/ (/ sm/ +/ o/ )/ =/ 1/ 可知/ smi/ -/ 1/ +/ oi/ -/ 1/ 为/ 奇数/ ,/ 因而/ δ/ i/ -/ 1/ ≠/ 2/ ./ 若/ δ/ i/ -/ 1/ =/ 1/ ,/ 由/ smi/ -/ 1/ +/ oi/ -/ 1/ 为/ 奇数/ 可知/ Gi/ -/ 1/ 可能/ 满足条件/ (/ β/ 1/ )/ 、/ (/ β/ 2/ )/ 或/ (/ β/ 5/ )/ ./ 若/ Gi/ 满足条件/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ,/ 增加/ 一个/ SMSP/ 后/ Gi/ 仍然/ 满足条件/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ,/ Δ/ δ/ =/ 0/ ;/ 若/ Gi/ 满足条件/ (/ β/ 5/ )/ ,/ 增加/ 一个/ SMSP/ 后/ ,/ Gi/ 满足条件/ (/ β/ 4/ )/ ,/ Δ/ δ/ =/ 0/ ./ 上述情况/ 都/ 有/ Δ/ δ/ / 0/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 4/ ./ gi/ 连接/ 一条/ AB/ 路径/ 的/ B/ -/ tail/ 和/ 一条/ AA/ 路径/ (/ 或/ gi/ 连接/ 一条/ AB/ 路径/ 的/ A/ -/ cap/ 和/ 一条/ BB/ 路径/ ,/ 或/ gi/ 连接/ 一条/ AB/ 路径/ 的/ A/ -/ cap/ 和/ 一条/ AA/ 路径/ )/ ./ gi/ 最多/ 减少/ 一个/ SMSP/ ,/ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ 可能/ 为/ 0/ 或/ -/ 1/ ,/ 根据/ 情况/ 2.1/ 和/ 情况/ 2.2/ 可知/ Δ/ / 0/ ./ 情况/ 5/ ./ gi/ 闭合/ 一条/ AA/ 路径/ ./ 所有/ 参数/ 保持/ 不变/ ,/ Δ/ =/ 0/ ./ 情况/ 6/ ./ gi/ 连接/ 两条/ AB/ 路径/ 的/ A/ -/ cap/ ./ gi/ 最多/ 减少/ 两个/ SMSP/ ,/ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ 1/ ,/ Δ/ r/ =/ 0/ ,/ Δ/ sm/ / -/ 2/ ,/ Δ/ o/ =/ 0/ ,/ 又/ 由/ 引理/ 3/ 可知/ Δ/ δ/ / -/ 1/ ,/ 因而/ Δ/ / 0/ ./ 情况/ 7/ ./ gi/ 连接/ 两条/ AA/ 路径/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ sm/ =/ Δ/ o/ =/ Δ/ δ/ =/ 0/ ,/ Δ/ =/ -/ 1/ ./ 若/ 添加/ 到/ Gi/ -/ 1/ 中/ 的/ 一条/ 灰边/ gi/ 满足/ Δ/ i/ =/ 0/ ,/ 则/ 将/ gi/ 称作/ 有效/ 灰边/ ./ 下面/ 我们/ 证明/ 总能/ 找到/ n/ +/ NPage9/ 条/ 有效/ 灰边/ 依次/ 添加/ 到/ GP/ (/ A/ ,/ B/ )/ 中/ ,/ 将/ 其/ 变为/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ BOPT/ )/ ./ 在/ 下面/ 引理/ 和/ 定理/ 的/ 证明/ 中/ ,/ 对于/ 固定/ 的/ “/ i/ ”/ ,/ 略去/ 参数/ 下标/ ./ 引理/ 5/ ./ 设/ S/ 为/ Gi/ -/ 1/ 中/ 的/ 一个/ SMSP/ 且/ S/ 包含/ 2/ 条/ AB/ 路径/ ./ 若/ gi/ 为/ 闭合/ S/ 中/ 一条/ AB/ 路径/ 的/ 灰边/ ,/ 那么/ gi/ 一定/ 是/ 有效/ 灰边/ ./ 证明/ ./ 因为/ S/ 中/ 包含/ 两条/ AB/ 路径/ ,/ 闭合/ 其中/ 一条/ AB/ 路径/ 后/ ,/ S/ 在/ Gi/ 中/ 仍然/ 是/ SMSP/ ,/ 即/ Gi/ 中/ SMSP/ 的/ 数目/ 不变/ ,/ 其它/ 参数/ 也/ 不变/ ,/ 因而/ Δ/ =/ 0/ ./ 根据/ 引理/ 5/ ,/ 下面/ 可/ 假设/ Gi/ -/ 1/ 中/ 的/ SMSP/ 都/ 只/ 包含/ 一条/ AB/ 路径/ ./ 引理/ 6/ ./ 若/ Gi/ -/ 1/ 满足/ dsi/ -/ 1/ =/ 1/ ,/ 则/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ dsi/ =/ 0/ ./ 证明/ ./ 因为/ dsi/ -/ 1/ =/ 1/ ,/ 可知/ Gi/ -/ 1/ 中/ 存在/ 一对/ 相互依赖/ 的/ SMSP/ ,/ 记作/ S1/ ,/ S2/ ./ 下面/ 给出/ 找/ 满足/ 上述/ 条件/ 的/ 有效/ 灰边/ gi/ 的/ 方法/ :/ (/ 1/ )/ 若/ oi/ -/ 1/ =/ 1/ ,/ 则/ δ/ i/ -/ 1/ =/ 0/ ./ 令/ gi/ 为/ 闭合/ S1/ (/ 或/ S2/ )/ 中/ 的/ AB/ 路径/ 的/ 灰边/ ,/ 则/ S1/ (/ 或/ S2/ )/ 变为/ RMSP/ ,/ dsi/ =/ 0/ ./ 因为/ 新/ 的/ RMSP/ 与/ 原有/ 的/ RMSP/ 位于/ 不同/ 的/ 染色体/ ,/ 因而/ δ/ i/ =/ 0/ ./ gi/ 令/ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ 1/ ,/ Δ/ o/ =/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ 因而/ Δ/ =/ 0/ ./ (/ 2/ )/ 若/ oi/ -/ 1/ =/ 0/ ,/ 则/ Gi/ -/ 1/ 满足条件/ (/ β/ 6/ )/ ,/ δ/ i/ -/ 1/ =/ 1/ ./ 若/ ri/ -/ 1/ >/ 0/ ,/ 令/ gi/ 为/ 闭合/ S1/ (/ 或/ S2/ )/ 的/ AB/ 路径/ 的/ 灰边/ ,/ 则/ S1/ (/ 或/ S2/ )/ 变为/ RMSP/ 且/ 该/ RMSP/ 与/ 原有/ 的/ RMSP/ 位于/ 不同/ 的/ 染色体/ ,/ dsi/ =/ δ/ i/ =/ 0/ ./ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ Δ/ o/ =/ 1/ ,/ Δ/ sm/ =/ Δ/ δ/ =/ -/ 1/ ,/ Δ/ =/ 0/ ./ 若/ ri/ -/ 1/ =/ 0/ ,/ 令/ gi/ 为/ 连接/ S1/ 中/ 的/ A/ -/ cap/ 和/ S2/ 中/ 的/ B/ -/ tail/ 的/ 灰边/ ./ gi/ 将/ S1/ ,/ S2/ 合并/ 为/ 一个/ SMSP/ ,/ dsi/ =/ δ/ i/ =/ 0/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ Δ/ δ/ =/ -/ 1/ ,/ Δ/ (/ sm/ +/ o/ )/ // 2/ =/ 0/ ,/ Δ/ =/ 0/ ./ 引理/ 7/ ./ 若/ Gi/ -/ 1/ 包含/ 真偶/ 隔离带/ 且/ smi/ -/ 1/ >/ 0/ ,/ 则/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 不/ 包含/ 真偶/ 隔离带/ 或者/ Gi/ 满足条件/ (/ α/ 1/ )/ ./ 证明/ ./ Gi/ -/ 1/ 可能/ 满足条件/ (/ α/ 2/ )/ 、/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ./ 下面/ 对/ 这/ 3/ 种/ 情况/ 分别/ 给出/ 找/ 满足/ 上述/ 条件/ 的/ 有效/ 灰边/ gi/ 的/ 方法/ :/ (/ 1/ )/ 若/ Gi/ -/ 1/ 满足/ (/ α/ 2/ )/ ,/ 设强/ 偶/ 隔离带/ 中/ 的/ 两个/ SMSP/ 为/ S1/ ,/ S2/ ./ 令/ gi/ 为/ 连接/ S1/ 的/ AB/ 路径/ 的/ A/ -/ cap/ 和/ S2/ 的/ AB/ 路径/ 的/ B/ -/ tail/ 的/ 灰边/ ./ 添加/ gi/ 后/ ,/ S1/ ,/ S2/ 不再/ 是/ SMSP/ ./ 显然/ dsi/ =/ 0/ 并且/ Gi/ 满足条件/ (/ α/ 1/ )/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 2/ ,/ Δ/ δ/ =/ 0/ ,/ 因而/ Δ/ =/ 0/ ./ (/ 2/ )/ 若/ Gi/ -/ 1/ 满足/ (/ β/ 1/ )/ 或/ (/ β/ 2/ )/ ,/ 用/ 以下/ 方法/ 选择/ 一个/ SMSP/ ,/ 记作/ S/ :/ 若/ Gi/ -/ 1/ 中/ 存在/ 一对/ 相互依赖/ 的/ SMSP/ ,/ 则/ 令/ S/ 为/ 其中/ 一个/ SMSP/ ;/ 否则/ ,/ 令/ S/ 为/ 任意/ 一个/ SMSP/ ./ 令/ gi/ 为/ 闭合/ S/ 中/ AB/ 路径/ 的/ 灰边/ ,/ 则/ S/ 变为/ RMSP/ ,/ δ/ i/ =/ 0/ ./ 上述/ 选择/ S/ 的/ 方式/ 可以/ 保证/ dsi/ =/ 0/ ./ ri/ 为/ 奇数/ ,/ 显然/ Gi/ 不/ 包含/ 真偶/ 隔离带/ ./ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ Δ/ o/ =/ 1/ ,/ Δ/ sm/ =/ Δ/ δ/ =/ -/ 1/ ,/ 因而/ Δ/ =/ 0/ ./ 引理/ 8/ ./ 若/ Gi/ -/ 1/ 包含/ 弱偶/ 隔离带/ 且/ Gi/ -/ 1/ 中/ 至少/ 有/ 一条/ AA/ 路径/ ,/ 则/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 不/ 包含/ 真偶/ 隔离带/ ,/ 弱偶/ 隔离带/ 或半偶/ 隔离带/ ./ 证明/ ./ 下面/ 分/ 3/ 种/ 情况/ 给出/ 找/ 满足/ 上述/ 条件/ 的/ 有效/ 灰边/ gi/ 的/ 方法/ :/ (/ 1/ )/ 若/ smi/ -/ 1/ =/ 1/ ,/ 可知/ Gi/ -/ 1/ 满足条件/ (/ β/ 3/ )/ ,/ δ/ i/ -/ 1/ =/ 1/ ./ 设/ S/ 为/ Gi/ -/ 1/ 中/ 唯一/ 的/ SMSP/ ./ 令/ gi/ 为/ 连接/ S/ 的/ AB/ 路径/ 的/ B/ -/ tail/ 与/ 一条/ AA/ 路径/ 的/ 灰边/ ./ 添加/ gi/ 后/ S/ 不再/ 是/ SMSP/ ,/ 显然/ dsi/ =/ smi/ =/ 0/ 且/ Gi/ 不再/ 包含/ 弱偶/ 隔离带/ ./ 因/ ri/ 为/ 奇数/ ,/ 因而/ Gi/ 也/ 不/ 包含/ 真偶/ 隔离带/ 或半偶/ 隔离带/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ Δ/ δ/ =/ -/ 1/ ,/ 可/ 得/ Δ/ =/ 0/ ./ (/ 2/ )/ 若/ smi/ -/ 1/ =/ 2/ ,/ 则/ δ/ i/ -/ 1/ =/ 0/ ./ 设/ 这/ 两个/ SMSP/ 为/ S1/ ,/ S2/ ./ 令/ gi/ 为/ 连接/ S1/ 的/ AB/ 路径/ 的/ A/ -/ cap/ 和/ S2/ 的/ AB/ 路径/ 的/ B/ -/ tail/ 的/ 灰边/ ./ 添加/ gi/ 后/ S1/ 和/ S2/ 不再/ 是/ SMSP/ ,/ 显然/ dsi/ =/ smi/ =/ 0/ 且/ Gi/ 不/ 包含/ 真偶/ 隔离带/ 、/ 弱偶/ 隔离带/ 或半偶/ 隔离带/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 2/ ,/ Δ/ δ/ =/ 0/ ,/ Δ/ =/ 0/ ./ (/ 3/ )/ 若/ smi/ -/ 1/ >/ 2/ ,/ 则/ Gi/ -/ 1/ 中/ 至少/ 存在/ 一个/ 与/ 弱/ 偶/ 隔离带/ 不同/ 染色体/ 的/ SMSP/ ./ 用/ 以下/ 方法/ 选择/ 一个/ SMSP/ ,/ 记作/ S/ :/ 若/ Gi/ -/ 1/ 中/ 存在/ 一对/ 相互依赖/ 的/ SMSP/ ,/ 则/ 令/ S/ 为/ 其中/ 一个/ SMSP/ ;/ 否则/ ,/ 令/ S/ 为/ 任意/ 一个/ 与/ 弱/ 偶/ 隔离带/ 不同/ 染色体/ 的/ SMSP/ ./ 令/ gi/ 为/ 闭合/ S/ 的/ AB/ 路径/ 的/ 灰边/ ,/ gi/ 将/ S/ 变为/ RMSP/ ./ 选择/ S/ 的/ 方式/ 可以/ 保证/ dsi/ =/ 0/ ./ 在/ Gi/ 中新/ 的/ RMSP/ 与/ 其它/ RMSP/ 不/ 位于/ 同一/ 染色体/ ,/ 因而/ Gi/ 不/ 包含/ 真偶/ 隔离带/ 、/ 弱偶/ 隔离带/ 或半偶/ 隔离带/ ./ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ 1/ ,/ Δ/ o/ =/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ Δ/ =/ 0/ ./ 引理/ 9/ ./ 若/ Gi/ -/ 1/ 包含/ 半偶/ 隔离带/ ,/ dsi/ -/ 1/ =/ 0/ 且/ Gi/ -/ 1/ 中/ 至少/ 有/ 一条/ AA/ 路径/ ,/ 则/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 中/ 不/ 包含/ 真偶/ 隔离带/ 或半偶/ 隔离带/ ./ 证明/ ./ 设/ P/ 为/ 半偶/ 隔离带/ 中/ 的/ 长/ AB/ 路径/ ./ Page10SMSP/ ./ 找/ 满足/ 上述/ 条件/ 有效/ 灰边/ gi/ 的/ 方法/ 如下/ :/ (/ 1/ )/ 若/ smi/ -/ 1/ 为/ 偶数/ ,/ 则/ Gi/ -/ 1/ 满足条件/ (/ β/ 4/ )/ ,/ δ/ i/ -/ 1/ =/ 1/ ./ 令/ gi/ 为/ 连接/ P/ 的/ B/ -/ tail/ 与/ 一条/ AA/ 路径/ 的/ 灰边/ ./ SMSP/ 的/ 数目/ 不变/ ,/ 因而/ dsi/ =/ dsi/ -/ 1/ =/ 0/ ./ 因为/ 一条/ 染色体/ 上/ 只有/ 两个/ A/ -/ cap/ ,/ 因而/ 添加/ gi/ 后/ ,/ 所有/ 的/ RMSP/ 一定/ 不/ 被/ 同/ 一半/ 子/ 排列/ 包含/ ,/ 即/ Gi/ 不/ 包含/ 半偶/ 隔离带/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ Δ/ sm/ =/ 0/ ,/ Δ/ δ/ =/ -/ 1/ ,/ 因而/ Δ/ =/ 0/ ./ (/ 2/ )/ 若/ smi/ -/ 1/ 为/ 奇数/ ,/ 下面/ 分/ 两种/ 子/ 情况/ 讨论/ :/ (/ 2.1/ )/ 若/ smi/ -/ 1/ =/ 1/ ,/ 设/ S/ 为/ Gi/ -/ 1/ 中/ 唯一/ 的/ 若/ Gi/ -/ 1/ 满足条件/ (/ β/ 5/ )/ ,/ 则/ δ/ i/ -/ 1/ =/ 1/ ./ 令/ gi/ 为/ 闭合/ S/ 中/ 的/ AB/ 路径/ 的/ 灰边/ ./ 添加/ gi/ 后/ S/ 变为/ RMSP/ ,/ ri/ 为/ 奇数/ 且/ smi/ =/ 0/ ,/ 因而/ dsi/ =/ 0/ 且/ Gi/ 不/ 包含/ 半偶/ 隔离带/ ./ gi/ 满足/ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ Δ/ o/ =/ 1/ ,/ Δ/ sm/ =/ Δ/ δ/ =/ -/ 1/ ,/ Δ/ =/ 0/ ./ 若/ Gi/ -/ 1/ 不/ 满足条件/ (/ β/ 5/ )/ ,/ 则/ δ/ i/ -/ 1/ =/ 0/ ./ 令/ gi/ 为/ 连接/ S/ 中/ AB/ 路径/ 的/ A/ -/ cap/ 与/ P/ 的/ B/ -/ tail/ 的/ 灰边/ ./ 添加/ gi/ 后/ smi/ =/ dsi/ =/ 0/ ./ 由于/ 在/ Gi/ -/ 1/ 中半偶/ 隔离带/ 与/ S/ 不/ 被/ 同一个/ 半子/ 排列/ 包含/ (/ 否则/ ,/ Gi/ -/ 1/ 满足条件/ (/ β/ 5/ )/ )/ ,/ 因而/ 添加/ gi/ 后/ 所有/ 的/ RMSP/ 不再/ 被/ 同/ 一半/ 子/ 排列/ 包含/ ,/ 即/ Gi/ 不/ 包含/ 半偶/ 隔离带/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ 可/ 得/ Δ/ =/ 0/ ./ (/ 2.2/ )/ 若/ smi/ -/ 1/ >/ 1/ ,/ 则/ δ/ i/ -/ 1/ =/ 0/ ./ 这时/ Gi/ -/ 1/ 中/ 一定/ 存在/ 一个/ 与/ 半偶/ 隔离带/ 不同/ 染色体/ 的/ SMSP/ ,/ 按/ 以下/ 方法/ 选择/ 一个/ SMSP/ ,/ 记为/ S/ :/ 若/ Gi/ -/ 1/ 中有/ 一对/ 相互依赖/ 的/ SMSP/ ,/ 则/ 令/ S/ 为/ SMSP/ 对/ 中/ 的/ 一个/ SMSP/ ;/ 否则/ ,/ 令/ S/ 为/ 任意/ 一个/ 与/ 半偶/ 隔离带/ 不同/ 染色体/ 的/ SMSP/ ./ 令/ gi/ 为/ 连接/ S/ 中/ AB/ 路径/ 的/ A/ -/ cap/ 与/ P/ 的/ B/ -/ tail/ 的/ 灰边/ ./ 显然/ gi/ 是/ 体间/ 灰边/ ,/ 因而/ Gi/ 不再/ 包含/ 半偶/ 隔离带/ ./ 选择/ S/ 的/ 方法/ 可以/ 保证/ dsi/ =/ 0/ ./ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ 可/ 得/ Δ/ =/ 0/ ./ 上述情况/ 中/ gi/ 均/ 没有/ 闭合/ 路径/ P/ ,/ 因而/ Gi/ 也/ 不/ 引理/ 10/ ./ 总能/ 找到/ p/ (/ A/ ,/ B/ )/ 条灰边/ 将/ GP/ (/ A/ ,/ B/ )/ 中/ 的/ 每/ 一条/ BB/ 路径/ 都/ 与/ 一条/ AA/ 路径/ 连接/ ,/ 添加/ 灰边/ 后/ 不/ 产生/ 新/ 的/ SMSP/ ,/ 也/ 不/ 产生/ 半偶/ 隔离带/ ./ 证明/ ./ 由/ 引理/ 2/ 可知/ ,/ 存在/ p/ (/ A/ ,/ B/ )/ 条灰边/ 将/ 每/ 一条/ BB/ 路径/ 都/ 与/ 一条/ AA/ 路径/ 连接/ ,/ 不会/ 产生/ 新/ 的/ SMSP/ ./ 下面/ 我们/ 修改/ 引理/ 2/ 的/ 添加/ 灰边/ 的/ 方法/ ,/ 使/ 之/ 也/ 不/ 产生/ 半偶/ 隔离带/ ./ 按照/ 引理/ 2/ 添加/ 灰边/ 产生/ 半偶/ 隔离带/ 只有/ 一种/ 情况/ :/ GP/ (/ A/ ,/ B/ )/ 中/ 包含/ 偶会/ 包含/ 真偶/ 隔离带/ ./ 数个/ RMSP/ ,/ 这些/ RMSP/ 位于/ 同/ 一条/ 染色体/ X/ ;/ X/ 上/ 没有/ 体间/ 灰边/ 的/ 端点/ ;/ X/ 上/ 有/ 一条/ AA/ 路径/ 和/ 一条/ BB/ 路径/ ,/ 分别/ 记作/ P1/ 和/ P2/ ./ 当且/ 仅/ 当/ 添加/ 灰边/ 连接/ P1/ 和/ P2/ 时会/ 产生/ 半偶/ 隔离带/ ./ 这种/ 情况/ 下/ ,/ 因/ n/ >/ M/ ,/ 可知/ GP/ (/ A/ ,/ B/ )/ 中/ 一定/ 有/ 一条/ 位于/ X/ 之外/ 的/ 短/ AA/ 路径/ ,/ 记作/ P3/ ./ 添加/ 灰边/ 将/ P2/ 与/ P3/ 连接/ ,/ 即可/ 保证/ 不会/ 产生/ 半偶/ 隔离带/ ./ 性质/ 3/ ./ 若/ Gi/ -/ 1/ 满足/ 以下/ 3/ 个/ 条件/ :/ (/ C1/ )/ dsi/ -/ 1/ =/ 0/ ;/ (/ C2/ )/ Gi/ -/ 1/ 不/ 包含/ 弱偶/ 隔离带/ 或半偶/ 隔离带/ ;/ (/ C3/ )/ Gi/ -/ 1/ 不/ 包含/ 真偶/ 隔离带/ 或者/ Gi/ -/ 1/ 满足条件/ (/ α/ 1/ )/ ,/ 在/ Gi/ -/ 1/ 中/ 添加/ 一条/ 灰边/ gi/ ,/ 若/ gi/ 令/ Δ/ ds/ =/ 0/ 且/ gi/ 不/ 在/ Gi/ 中/ 产生/ 新/ 的/ SMSP/ 和/ 半偶/ 隔离带/ ,/ 则/ gi/ 一定/ 满足/ Δ/ δ/ =/ 0/ ./ 定理/ 3/ ./ 总能/ 找到/ n/ +/ N/ 条/ 有效/ 灰边/ 添加/ 到/ GP/ (/ A/ ,/ B/ )/ 中/ ,/ 使/ 其/ 变为/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ BOPT/ )/ ./ 证明/ ./ 假设/ 已经/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ 了/ i/ -/ 1/ (/ S1/ )/ 若/ Gi/ -/ 1/ 中/ 存在/ 包含/ 两条/ AB/ 路径/ 的/ SMSP/ ,/ 则/ 添加/ 灰边/ 闭合/ 其中/ 一条/ AB/ 路径/ ./ 由/ 引理/ 5/ 可知/ ,/ 添加/ 的/ 灰边/ 都/ 是/ 有效/ 灰边/ ./ 条灰边/ 得到/ Gi/ -/ 1/ ./ (/ S2/ )/ 若/ Gi/ -/ 1/ 满足/ dsi/ -/ 1/ =/ 1/ ,/ 则/ 根据/ 引理/ 6/ ,/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ Gi/ 满足/ dsi/ =/ 0/ ./ (/ S3/ )/ 若/ Gi/ -/ 1/ 包含/ 真偶/ 隔离带/ 且/ smi/ -/ 1/ >/ 0/ ,/ 则/ 根据/ 引理/ 7/ ,/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 中/ 不/ 包含/ 真偶/ 隔离带/ 或者/ Gi/ 满足条件/ (/ α/ 1/ )/ ./ (/ S4/ )/ 若/ Gi/ -/ 1/ 包含/ 弱偶/ 隔离带/ ,/ 因为/ n/ >/ M/ 并且/ 前面/ 的/ 步骤/ 中/ 都/ 没有/ 减少/ AA/ 路径/ ,/ 可知/ Gi/ -/ 1/ 至少/ 包含/ 一条/ AA/ 路径/ ,/ 根据/ 引理/ 8/ ,/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 中/ 不/ 包含/ 真偶/ 隔离带/ 、/ 弱偶/ 隔离带/ 或半偶/ 隔离带/ ./ (/ S5/ )/ 若/ Gi/ -/ 1/ 包含/ 半偶/ 隔离带/ 且/ dsi/ -/ 1/ =/ 0/ ,/ 因为/ n/ >/ M/ 并且/ 前面/ 的/ 步骤/ 中/ 都/ 没有/ 减少/ AA/ 路径/ ,/ 可知/ Gi/ -/ 1/ 至少/ 包含/ 一条/ AA/ 路径/ ,/ 根据/ 引理/ 9/ ,/ 总能/ 找到/ 一条/ 有效/ 灰边/ gi/ ,/ 使得/ 添加/ gi/ 后/ 的/ 图/ Gi/ 满足/ :/ (/ 1/ )/ dsi/ =/ 0/ ;/ (/ 2/ )/ Gi/ 中/ 不/ 包含/ 真偶/ 隔离带/ 或半偶/ 隔离带/ ./ 又/ 因为/ 无论如何/ 添加/ 灰边/ 半偶/ 隔离带/ 都/ 不会/ 转化/ 为弱/ 偶/ 隔离带/ ,/ 因而/ Gi/ 中/ 也/ 一定/ 不/ 包含/ 弱偶/ 隔离带/ ./ 先/ 按照/ (/ S1/ )/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ 灰边/ ,/ 使/ 部分/ 图中/ 每个/ SMSP/ 只/ 包含/ 一条/ AB/ 路径/ ./ 再/ 按照/ (/ S2/ ~/ S5/ )/ 在/ 部分/ 图中/ 添加/ 灰边/ ,/ 设/ 得到/ 的/ 新/ 部分/ 图/ 仍/ 为/ Page11Gi/ -/ 1/ ,/ 则/ Gi/ -/ 1/ 一定/ 满足/ 性质/ 3/ 中/ 的/ 条件/ (/ C1/ )/ 、/ (/ C2/ )/ 和/ (/ C3/ )/ ./ 下面/ 的/ 步骤/ 总/ 假设/ Gi/ -/ 1/ 满足/ 这/ 3/ 个/ 条件/ ,/ 并/ 在/ 证明/ 中/ 直接/ 利用/ 性质/ 3/ ./ (/ S6/ )/ 若/ smi/ -/ 1/ / 2/ ,/ 由于/ dsi/ -/ 1/ =/ 0/ ,/ 根据/ 引理/ 1/ 总能/ 找到/ smi/ -/ 1/ // 2/ 条灰边/ 减少/ 2/ / smi/ -/ 1/ // 2/ 个/ SMSP/ ./ 其中/ 每条/ 灰边/ 都/ 满足/ Δ/ ds/ =/ 0/ 且/ 不会/ 产生/ 新/ 的/ SMSP/ 和/ 半偶/ 隔离带/ ,/ 因而/ 都/ 满足/ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 2/ ,/ Δ/ δ/ =/ 0/ ,/ 可/ 得/ Δ/ =/ 0/ ./ (/ S7/ )/ 若/ smi/ -/ 1/ =/ 1/ ,/ 设/ 唯一/ 的/ 一个/ SMSP/ 为/ S/ ./ 因为/ Gi/ -/ 1/ 中/ 存在/ SMSP/ ,/ 显然/ n/ >/ M/ ./ 又/ 因为/ 前面/ 的/ 步骤/ 都/ 没有/ 减少/ AA/ 路径/ ,/ 因而/ Gi/ -/ 1/ 中/ 一定/ 有/ 一条/ AA/ 路径/ ./ 若/ oi/ -/ 1/ =/ 0/ ,/ 添加/ gi/ 将/ S/ 中/ 的/ AB/ 路径/ 的/ B/ -/ tail/ 与/ 一条/ AA/ 路径/ 连接/ ,/ 则/ S/ 不再/ 是/ SMSP/ ./ gi/ 满足/ Δ/ l/ =/ -/ 1/ ,/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ 0/ ,/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ 因而/ Δ/ =/ 0/ ./ 若/ oi/ -/ 1/ =/ 1/ ,/ 添加/ gi/ 闭合/ S/ 中/ 的/ AB/ 路径/ ,/ 则/ S/ 变为/ RMSP/ ,/ gi/ 满足/ Δ/ l/ =/ Δ/ p/ =/ 0/ ,/ Δ/ r/ =/ 1/ ,/ Δ/ o/ =/ Δ/ sm/ =/ -/ 1/ ,/ Δ/ δ/ =/ 0/ ,/ 因而/ Δ/ =/ 0/ ./ (/ S8/ )/ 若/ pi/ -/ 1/ >/ 0/ ,/ 即/ Gi/ -/ 1/ 中/ 存在/ BB/ 路径/ ,/ 因为/ 前面/ 的/ 步骤/ 都/ 不会/ 改变/ BB/ 路径/ 和/ AA/ 路径/ 的/ 数目/ ,/ 根据/ 引理/ 10/ ,/ 总能/ 找到/ pi/ -/ 1/ 条灰边/ 将/ Gi/ -/ 1/ 中/ 的/ 每条/ BB/ 路径/ 都/ 与/ 一条/ AA/ 路径/ 连接/ ./ 该/ 过程/ 中/ 不/ 产生/ 新/ 的/ SMSP/ 和/ 半偶/ 隔离带/ ,/ 因而/ 每条/ 灰边/ 都/ 满足/ Δ/ l/ =/ Δ/ p/ =/ Δ/ r/ =/ Δ/ o/ =/ Δ/ sm/ =/ Δ/ δ/ =/ 0/ ,/ Δ/ =/ 0/ ./ (/ S9/ )/ 若/ Gi/ -/ 1/ 中/ 既/ 没有/ SMSP/ 也/ 没有/ BB/ 路径/ ,/ 添加/ 灰边/ gi/ 闭合/ 任意/ 一条/ 路径/ ,/ gi/ 不/ 改变/ 任何/ 参数/ ,/ 因而/ Δ/ =/ 0/ ./ 循环/ 利用/ 上述/ 方法/ 就/ 能/ 添加/ n/ +/ N/ 条/ 有效/ 灰边/ 到/ GP/ (/ A/ ,/ B/ )/ 中/ ,/ 得到/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ BOPT/ )/ ./ 证毕/ ./ 定理/ 3/ 的/ 证明/ 过程/ 给出/ 了/ 寻找/ n/ +/ N/ 条/ 有效/ 灰边/ 的/ 方法/ ,/ 根据/ 该/ 方法/ 在/ GP/ (/ A/ ,/ B/ )/ 中/ 添加/ n/ +/ N/ 条灰边/ 可/ 将/ 其/ 变为/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ BOPT/ )/ ./ 根据/ 定理/ 2/ ,/ ^/ A/ 和/ ^/ BOPT/ 的/ 交互/ 型/ 移位/ 距离/ 恰好/ 等于/ A/ ,/ B/ 的/ 移位/ 距离/ ./ 用/ SRT/ 的/ 算法/ 对/ ^/ A/ 和/ ^/ BOPT/ 进行/ 交互/ 型/ 移位/ 排序/ ,/ ^/ A/ 和/ ^/ BOPT/ 的/ 最/ 短/ 交互/ 型/ 移位/ 序列/ 即可/ 模拟出/ A/ 和/ B/ 的/ 最/ 短/ 移位/ 序列/ ./ 完整/ 的/ 基因组/ 移位/ 排序/ 算法/ Generalized/ _/ Sorting/ (/ A/ ,/ B/ )/ 给出/ 如下/ ./ 算法/ 1/ ./ Generalized/ _/ Sorting/ (/ A/ ,/ B/ )/ ./ 1/ ./ 任选/ 一个/ B/ 的/ 加帽/ 基因组/ ^/ B/ ,/ 构造/ 断点/ 图/ G/ (/ ^/ A/ ,/ ^/ B/ )/ 2/ ./ 构造/ 部分/ 图/ G/ =/ GP/ (/ A/ ,/ B/ )/ 3/ ./ 对于/ G/ 中/ 所有/ 包含/ 两条/ AB/ 路径/ 的/ SMSP/ ,/ 添加/ 灰/ 4/ ./ ifG/ 中有/ 2/ 个/ SMSP/ ,/ 并且/ 这/ 两个/ SMSP/ 相互依赖/ 5/ ./ 按/ 引理/ 6/ 找/ 一条/ 有效/ 灰边/ g/ 添加/ 到/ G/ 中/ ,/ 即/ 6/ ./ ifG/ 包含/ 真偶/ 隔离带/ ,/ 且/ G/ 中/ 的/ SMSP/ 数/ 大于/ 07/ ./ 按/ 引理/ 7/ 找/ 一条/ 有效/ 灰边/ g/ ,/ G/ =/ G/ +/ {/ g/ }/ 8/ ./ ifG/ 包含/ 弱偶/ 隔离带/ 9/ ./ 按/ 引理/ 8/ 找/ 一条/ 有效/ 灰边/ g/ ,/ G/ =/ G/ +/ {/ g/ }/ 10/ ./ ifG/ 包含/ 半偶/ 隔离带/ 11/ ./ 按/ 引理/ 9/ 找/ 一条/ 有效/ 灰边/ g/ ,/ G/ =/ G/ +/ {/ g/ }/ 12/ ./ whileG/ 中有/ 路径/ 13/ ./ ifG/ 中/ 的/ SMSP/ 数/ 不少/ 于/ 214/ ./ 令/ sm/ 为/ G/ 中/ 的/ SMSP/ 数/ ,/ 按/ 引理/ 1/ 找/ sm/ // 215/ ./ elseifG/ 中/ 只有/ 一个/ SMSP16/ ./ ifG/ 中/ 的/ RMSP/ 数为/ 偶数/ ,/ 17/ ./ 令/ g/ 为/ 连接/ SMSP/ 中/ 的/ AB/ 路径/ 的/ B/ -/ tail18/ ./ else19/ ./ 令/ g/ 为/ 闭合/ SMSP/ 中/ 的/ AB/ 路径/ 的/ 灰边/ ,/ 20/ ./ elseifG/ 中有/ BB/ 路径/ 21/ ./ 令/ p/ 为/ G/ 中/ 的/ BB/ 路径/ 数/ ,/ 根据/ 引理/ 10/ 找/ p22/ ./ else23/ ./ 令/ g/ 为/ 闭合/ 任意/ 一条/ 路径/ 的/ 灰边/ ,/ G/ =/ G/ +/ {/ g/ }/ 24/ ./ endwhile25/ ./ 根据/ G/ 计算/ B/ 的/ 最优/ 加帽/ 基因组/ ^/ BOPT26/ ./ 用/ SRT/ 的/ 算法/ 对/ ^/ A/ 和/ ^/ BOPT/ 进行/ 交互/ 型/ 移位/ 排序/ 27/ ./ 用/ ^/ A/ 和/ ^/ BOPT/ 的/ 交互/ 型/ 移位/ 序列/ 模拟/ A/ 和/ B/ 的/ 移/ 下面/ 我们/ 分析/ 算法/ Generalized/ _/ Sorting/ (/ A/ ,/ B/ )/ 的/ 时间/ 复杂度/ ./ 步/ 1/ ~/ 2/ 构造/ 断点/ 图/ 和/ 部分/ 图需/ O/ (/ n/ )/ 时间/ ,/ 步/ 3/ ~/ 24/ 添加/ n/ +/ N/ 条/ 有效/ 灰边/ 可/ 在/ O/ (/ n/ )/ 时间/ 内/ 完成/ ,/ 步/ 25/ 计算/ ^/ BOPT/ 需/ O/ (/ n/ )/ 时间/ ./ 步/ 26/ 采用/ SRT/ 的/ 算法/ 对/ ^/ A/ 和/ ^/ BOPT/ 排序/ 可/ 在/ O/ (/ nnlog/ 槡/ n/ )/ 时间/ 内/ 完成/ [/ 10/ ]/ ./ 因而/ Generalized/ _/ Sorting/ (/ A/ ,/ B/ )/ 的/ 时间/ 复杂度/ 为/ O/ (/ nnlog/ 槡/ n/ )/ ./ 

