Page1/ 基于/ 光场/ 分析/ 的/ 多/ 线索/ 融合/ 深度/ 估计/ 方法/ 1/ )/ (/ 西北工业大学/ 计算机/ 学院/ 西安/ 710072/ )/ 2/ )/ (/ 中国兵器工业集团/ 有限公司/ 第/ 205/ 研究所/ 西安/ 710065/ )/ 摘要/ 受/ 人类/ 视觉/ 深度/ 感知/ 机理/ 的/ 启发/ ,/ 结合/ 最近/ 光场/ 分析/ 理论/ 的/ 进展/ ,/ 文中/ 提出/ 了/ 一种/ 融合/ 多种/ 深度/ 线索/ 的/ 全局/ 一致/ 深度/ 估计/ 方法/ ./ 该/ 方法/ 首先/ 利用/ 摄像机/ 阵列/ 获取/ 光场/ 数据/ ,/ 然后/ 通过/ 合成孔径/ 成像/ 方法/ 获得/ 指定/ 深度/ 的/ 重/ 投影/ 光场/ ,/ 并/ 从中/ 提取/ 表征/ 深度/ 变化/ 不同/ 维度/ 的/ 模糊/ 与/ 视差/ 线索/ ./ 接着/ 文中/ 采用/ 光场/ 分析方法/ 对比/ 了/ 模糊/ 与/ 视差/ 线索/ 的/ 适用/ 情况/ ,/ 设计/ 了/ 多/ 深度/ 线索/ 的/ 融合/ 算法/ ,/ 以/ 实现/ 不同/ 深度/ 线索/ 的/ 优势互补/ ./ 进而/ 为了/ 获得/ 精确/ 一致/ 的/ 深度/ 结果/ ,/ 文中/ 在/ 马尔可夫/ 随/ 机场/ 模型/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 平滑/ 约束/ 的/ 全局/ 能量/ 函数/ ./ 最终/ ,/ 文中/ 利用/ 图割/ 算法/ 最小化/ 全局/ 能量/ 函数/ ,/ 获得/ 了/ 平滑/ 的/ 高精度/ 深度/ 估计/ 结果/ ./ 文中/ 分别/ 在/ 虚拟/ 数据/ 和/ 真实/ 数据/ 上/ 测试/ 了/ 所/ 提出/ 的/ 方法/ ,/ 与/ 单一/ 深度/ 线索/ 和/ 局部/ 深度/ 估计/ 方法/ 相比/ ,/ 文中/ 方法/ 能/ 结合/ 不同/ 深度/ 线索/ 的/ 优势/ 并/ 获得/ 更加/ 鲁棒/ 的/ 深度/ 结果/ ./ 关键词/ 相机/ 阵列/ ;/ 光场/ 分析/ ;/ 多/ 线索/ 融合/ ;/ 深度/ 估计/ 1/ 引言/ 三维/ 场景/ 几何/ 结构/ 获取/ 是/ 计算机/ 视觉/ 的/ 基础/ 问题/ 之一/ ./ 人类/ 认识/ 和/ 表达/ 世界/ 是/ 以/ 几何/ 结构/ 信息/ 为/ 基础/ 的/ ,/ 获取/ 场景/ 的/ 几何/ 结构/ 能/ 使/ 人/ 更好/ 地/ 理解/ 视觉/ 内容/ ,/ 同时/ 可以/ 为/ 其他/ 计算机/ 视觉/ 任务/ 提供/ 更加/ 有效/ 的/ 数据/ 支持/ ./ 深度/ 结构/ 信息/ 的/ 获取/ 包括/ 主动式/ 和/ 被动式/ 两大类/ 方法/ [/ 1/ ]/ ,/ 主动式/ 深度/ 获取/ 方法/ 主要/ 包括/ 激光/ 扫描/ 、/ TOF/ 相机/ 、/ 结构/ 光法/ 、/ 阴影/ 法等/ ,/ 相关/ 技术/ 的/ 研究/ 比较/ 成熟/ ,/ 但是/ 适用范围/ 有限/ ./ 被动式/ 深度/ 获取/ 方法/ 直接/ 采集/ 复杂/ 场景/ 的/ 图像/ 数据/ ,/ 用/ 数据/ 驱动/ 的/ 方式/ 重建/ 复杂/ 场景/ 的/ 几何/ 结构/ ,/ 具有/ 与/ 主动式/ 方法/ 不同/ 的/ 研究/ 意义/ 和/ 实用价值/ ./ 其中/ 基于/ 图像/ 的/ 被动式/ 深度/ 估计/ 及/ 三维/ 结构/ 恢复/ 方法/ 以/ 其/ 显著/ 的/ 优点/ 得到/ 了/ 迅速/ 发展/ ./ 该类/ 方法/ 主要/ 包括/ 从/ 运动/ 、/ 亮度/ 、/ 模糊/ 、/ 轮廓/ 、/ 纹理/ 等/ 视觉/ 线索/ 恢复/ 场景/ 深度/ [/ 2/ ]/ ./ 虽然/ 不同/ 方法/ 进行/ 深度/ 估计/ 的/ 角度/ 不同/ ,/ 但是/ 具体/ 到/ 某种/ 方法/ ,/ 大都/ 仅/ 使用/ 了/ 人类/ 视觉/ 系统/ 中/ 模糊/ 、/ 视差/ 、/ 阴影/ 、/ 纹理/ 、/ 透视/ 等/ 单一/ 的/ 深度/ 线索/ [/ 3/ ]/ ,/ 使得/ 对/ 场景/ 的/ 深度/ 估计/ 存在/ 精度/ 或/ 鲁棒性/ 不足/ 的/ 问题/ ./ 尤其/ 在/ 处理/ 多/ 深度/ 复杂/ 场景/ 时/ ,/ 采用/ 单一/ 深度/ 线索/ 估计/ 的/ 深度/ 误差/ 更大/ [/ 4/ ]/ ./ 视觉/ 生理学/ 和/ 心理学/ 的/ 研究/ 表明/ ,/ 人类/ 视觉/ 的/ 深度/ 感知/ 融合/ 了/ 模糊/ 、/ 视差/ 、/ 运动/ 、/ 方向/ 、/ 颜色/ 等/ 多种/ 深度/ 线索/ ./ 由/ 不同/ 的/ 脑/ 区分/ 层/ 抽象/ 出/ 不同/ 的/ 概念/ 和/ 深度/ 判断/ ,/ 最终/ 组织/ 成/ 感知/ 深度/ 的/ 一种/ 深层/ 层次结构/ [/ 5/ ]/ ./ Parker/ 等/ 也/ 发现/ ,/ 不同/ 的/ 视觉/ 线索/ 由/ 大脑皮层/ 不同/ 区域/ 响应/ ,/ 然后/ 大脑/ 将/ 这些/ 响应/ 通过/ 融合/ 形成/ 深度/ 感知/ [/ 6/ ]/ ./ 在/ 计算机/ 视觉/ 领域/ ,/ 深度/ 估计/ 最/ 常用/ 的/ 是/ 模糊/ 与/ 视差/ 线索/ ,/ 计算/ 模糊/ 线索/ 需要/ 同一/ 视点/ 不同/ 聚焦/ 变化/ 采集/ 场景/ 不同/ 模糊/ 度/ 的/ 数据/ ,/ 而/ 视差/ 线索/ 的/ 获取/ 则/ 需要/ 从/ 不同/ 视点/ 对/ 目标/ 场景/ 进行/ 图像/ 采集/ ,/ 为了/ 模拟/ 人脑/ 的/ 深度/ 感知/ 机理/ 融合/ 模糊/ 与/ 视差/ 深度/ 线索/ ,/ 需要/ 同时/ 采集/ 更加/ 丰富/ 的/ 场景/ 数据/ ./ 而/ 计算/ 摄影/ 学/ (/ ComputationalPhotography/ )/ 中/ 的/ 光场/ 相机/ (/ LightFieldCamera/ )/ [/ 7/ -/ 10/ ]/ 采集/ 的/ 数据/ 恰能/ 满足/ 这一/ 要求/ ./ 光场/ 相机/ 对/ 三维/ 场景/ 中/ 的/ 光线/ 能/ 同时/ 进行/ 位置/ 和/ 角度/ 采样/ ,/ 进而/ 形成/ 光场/ 数据/ 集/ [/ 11/ -/ 12/ ]/ ./ 以/ 这些/ 稠密/ 的/ 采样/ 数据/ 集/ 为/ 基础/ ,/ 光场/ 成像/ 技术/ 可以/ 实现/ 全/ 聚焦/ (/ All/ -/ in/ -/ focus/ )/ 图像/ 合成/ 、/ 景深/ 扩展/ (/ ExtensionofDepthofField/ )/ 和/ 数字/ 重/ 聚焦/ (/ DigitalRefocus/ )/ [/ 10/ -/ 11/ ,/ 13/ ]/ 等/ 一系列/ 特殊/ 成像/ 效果/ ./ 光场/ 数据/ 中/ 的/ 模糊/ 和/ 视差/ 是/ 场景/ 深度/ 在/ 不同/ 维度/ 上/ 的/ 表现/ ,/ 因此/ 可以/ 将/ 其/ 作为/ 场景/ 三维重建/ 过程/ 的/ 有效/ 深度/ 线索/ ./ 基于/ 上述/ 观点/ ,/ 本文/ 提出/ 一种/ 融合/ 模糊/ 与/ 视差/ 线索/ 的/ 深度/ 估计/ 方法/ ./ 本文/ 首先/ 利用/ 摄像机/ 阵列/ 采集/ 光场/ 数据/ ,/ 然后/ 对/ 获得/ 的/ 光场/ 进行/ 重/ 投影/ ,/ 并/ 从重/ 投影/ 后/ 的/ 光场/ 中/ 提取/ 表示/ 光线/ 角度/ 变化/ 的/ 视差/ 线索/ ,/ 随后/ 对光/ 场/ 进行/ 角度/ 积分/ 获得/ 共/ 聚焦/ 图像/ ,/ 并/ 从中/ 提取/ 模糊/ 线索/ ./ 由于/ 两种/ 线索/ 具有/ 一定/ 的/ 互补性/ [/ 14/ ]/ ,/ 针对/ 不同/ 线索/ 的/ 优势/ ,/ 本文/ 设计/ 了/ 一种/ 自/ 适应/ 权重/ 方法/ 对/ 两种/ 线索/ 进行/ 融合/ ./ 为了/ 获得/ 全局/ 一致/ 的/ 结构化/ 深度/ 结果/ ,/ 本文/ 引入/ 了/ 马尔可夫/ 随/ 机场/ (/ MarkovRandomField/ )/ 模型/ ,/ 并/ 设计/ 了/ 鲁棒/ 的/ 邻域/ 平滑/ 项/ ,/ 最终/ 通过/ 图割/ 算法/ (/ Graphcut/ )/ 最小化/ 目标/ 能量/ 函数/ 估计/ 场景/ 的/ 深度/ ./ 在/ 虚拟/ 数据/ 和/ 真实/ 数据/ 上/ 测试/ 结果显示/ ,/ 相比/ 于/ 单一/ 深度/ 线索/ 和/ 局部/ 深度/ 估计/ 方法/ ,/ 本文/ 所提/ 方法/ 能/ 结合/ 不同/ 深度/ 线索/ 的/ 优势/ 获得/ 更加/ 鲁棒/ 的/ 深度/ 估计/ 结果/ ./ 2/ 相关/ 工作/ 在/ 计算机/ 视觉/ 深度/ 结构/ 重建/ 领域/ ,/ 大量/ 学者/ 的/ 研究/ 实践/ 表明/ ,/ 模糊/ 线索/ 和/ 视差/ 线索/ 是/ 两种/ 非常/ 有效/ 的/ 深度/ 线索/ ,/ 这/ 两种/ 线索/ 对应/ 深度/ 信息/ 在/ 两个/ 典型/ 维度/ 的/ 表现/ ,/ 在/ 恢复/ 场景/ 深度/ 方面/ 被/ 广泛/ 使用/ ./ 单目/ 视觉/ 下/ 的/ 深度/ 估计/ 主要/ 依靠/ 模糊/ 、/ 阴影/ 纹理/ 变化/ 及/ 梯度/ 、/ 运动/ 极差/ 等/ 线索/ ,/ 目前/ 使用/ 较/ 多/ 的/ 是/ 模糊/ 线索/ ./ Krotkov/ [/ 15/ ]/ 和/ Pentland/ [/ 16/ ]/ 首先/ 提出/ 了/ 从/ 聚焦/ 恢复/ 深度/ (/ DepthFromFocus/ ,/ DFF/ )/ 和/ 从/ 散焦/ 恢复/ 深度/ (/ DepthFromDefocus/ ,/ DFD/ )/ 的/ 理论/ 模型/ ,/ 利用/ 图像/ 点/ 模糊/ 程度/ 估计/ 场景/ 深度/ ./ Saxena/ 等/ 人/ [/ 3/ ]/ 建立/ 了/ 基于/ 分层/ 多/ 尺度/ 马尔可夫/ 随/ 机场/ 的/ 有/ 监督/ 学习/ 深度/ 估计/ 方法/ ,/ 利用/ 像素/ 之间/ 的/ 上下文/ 一致性/ 估计/ 其/ 深度/ ./ Burge/ 等/ 人/ [/ 17/ ]/ 从/ 视觉/ 心理学/ 出发/ 分析/ 了/ 模糊/ 产生/ 的/ 生理机制/ ,/ 提出/ 一种/ 基于/ 贝叶斯/ 模型/ 的/ 图像/ 散焦/ 估计/ 方法/ ./ Hasinoff/ 等/ 人/ [/ 18/ ]/ 则/ 提出/ 了/ 共/ 焦/ 一致性/ (/ ConfocalConstancy/ )/ 假设/ 获得/ 图像/ 中/ 每个/ 像素点/ 的/ 散焦/ 度量/ ./ 常用/ 的/ 模糊/ 度量/ 值有/ 灰度/ 方差/ 、/ 局部/ 梯度/ 、/ 局部/ 直方图/ 熵/ 值/ 等/ ./ Nayar/ 等/ 人/ [/ 19/ ]/ 则/ 提出/ 了/ 基于/ 改进/ 拉普拉斯/ 算子/ 的/ SML/ (/ SummedModifiedLaplacian/ )/ 模糊/ 度量/ 方法/ ./ 由于/ DFF/ // DFD/ 方法/ 需要/ 多/ 张/ 关于/ 目标/ 场景/ 不同/ 聚焦/ 参数/ 的/ 图像/ ,/ 单/ 相机/ 必须/ 进行/ 多次/ 拍摄/ ,/ 这使/ 其/ 无法/ 估计/ 动态/ 场景/ 的/ 深度/ 信息/ ./ 而/ 作为/ 光场/ 数据/ 获取/ 系统/ 的/ 一种/ ,/ 摄像机/ 阵列/ 不仅/ 具有/ 一般/ 多/ 摄像机/ 系统/ 的/ 多/ 视点/ 、/ 高/ 信噪比/ 等/ 优点/ ,/ 而且/ 可以/ 虚拟/ 一个/ 大/ 孔径/ 相机/ 以获/ Page3/ 取/ 更/ 高/ 的/ 景深/ 分辨率/ ./ 现有/ 合成孔径/ 重/ 聚焦/ 理论/ [/ 20/ ]/ 仅/ 需/ 一次/ 拍摄/ 就/ 能/ 获得/ 场景/ 任意/ 候选/ 焦深/ 的/ 图像/ [/ 21/ ]/ ./ 基于/ 相机/ 阵列/ 光场/ 数据/ 的/ 深度/ 估计/ 方法/ 可以/ 弥补/ 传统/ 模糊/ 法中/ 孔径/ 小及/ 需要/ 多次/ 拍摄/ 的/ 不足/ ,/ 适用/ 于/ 较/ 远/ 场景/ 以及/ 动态/ 场景/ 的/ 深度/ 估计/ ./ 多/ 视点/ 深度/ 估计/ 的/ 一个/ 主要/ 线索/ 是/ 三维/ 场景/ 经过/ 多个/ 相机/ 成像/ 在/ 不同/ 图像/ 之间/ 形成/ 的/ 视差/ ,/ 在/ 光场/ 数据/ 中即/ 不同/ 角度/ 光线/ 之间/ 的/ 差异/ ,/ 视差/ 的/ 计算/ 过程/ 也/ 即/ 多/ 视点/ 图像/ 之间/ 的/ 特征/ 匹配/ 过程/ ./ 常用/ 的/ 视差/ 匹配/ 值/ 的/ 计算方法/ 有/ SSD/ (/ SummedSquaredDifference/ )/ 、/ SAD/ (/ SummedAbsoluteDifference/ )/ 、/ 灰度/ 相关/ 法/ 、/ 秩/ 方法/ 、/ 归一化/ 互相/ 关法/ (/ NormalizedCrossCorrelation/ ,/ NCC/ )/ 、/ 自/ 适应/ 窗口/ 法/ (/ AdaptiveSupport/ -/ Window/ )/ [/ 22/ ]/ 等/ ./ 虽然/ 这些/ 局部/ 代价/ 集成/ (/ CostAggregation/ )/ 方法/ 计算/ 效率/ 较/ 高/ ,/ 但是/ 对/ 匹配/ 噪声/ 难以/ 抑制/ ,/ 影响/ 深度/ 估计/ 的/ 准确性/ ./ 在/ 视差/ 匹配/ 中/ ,/ 由于/ 真实/ 凸透镜/ 相机/ 存在/ 孔径/ 限制/ ,/ 超出/ 景深/ 的/ 区域/ 会/ 出现/ 一定/ 程度/ 的/ 模糊/ ,/ 从而/ 使得/ 匹配/ 精度/ 降低/ ,/ 影响/ 深度/ 估计/ 的/ 准确性/ ./ 另外/ ,/ 如果/ 场景/ 中/ 出现/ 重复/ 纹理/ 或/ 无/ 纹理/ 区域/ ,/ 视差/ 线索/ 的/ 可靠性/ 也/ 将/ 下降/ ./ 利用/ 深度/ 线索/ 直接/ 进行/ 深度/ 估计/ 的/ 结果/ 往往/ 噪声/ 较大/ ,/ 为了/ 利用/ 邻域/ 平滑/ 约束/ 获得/ 全局/ 一致/ 的/ 深度/ 估计/ 结果/ ,/ 可以/ 利用/ 马尔可夫/ 随/ 机场/ 模型/ 结合/ 深度/ 线索/ 和/ 上下文/ 平滑/ 约束/ ,/ 将/ 深度/ 估计/ 表示/ 为/ 能量/ 泛函/ 最小化/ 过程/ ,/ 并/ 利用/ 图/ 割法/ [/ 23/ ]/ 、/ 置信/ 传播/ 法/ [/ 24/ ]/ 等/ 优化/ 方法/ 获得/ 深度/ 结果/ ./ 传统/ 马尔可夫/ 随/ 机场/ 深度/ 估计/ 模型/ 中/ ,/ 平滑/ 权重/ 参数/ 只能/ 通过/ 一些/ 启发式/ 的/ 方法/ 进行/ 设置/ ,/ 针对/ 这一/ 情况/ ,/ Scharstein/ 等/ 人/ [/ 25/ ]/ 将/ 条件/ 随/ 机场/ (/ ConditionalRandomField/ )/ 引入/ 到/ 视差/ 立体匹配/ 中/ ,/ 利用/ 训练/ 集/ 自动/ 地/ 学习/ 平滑/ 参数/ ,/ 提高/ 结构/ 优化/ 效果/ ./ Li/ 等/ 人/ [/ 26/ ]/ 在/ 最大/ 间隔/ (/ Max/ -/ Margin/ )/ 框架/ 下/ ,/ 利用/ 结构/ 支持/ 向量/ 机/ (/ StructuredSupportVectorMachine/ )/ 学习/ 非参/ 损失/ 函数/ 进行/ 深度/ 估计/ ./ 根据/ 不同/ 深度/ 目标/ 在/ 光场/ 中/ 的/ 差异/ ,/ Wanner/ 等/ 人/ [/ 27/ ]/ 提出/ 了/ 利用/ 结构/ 张量/ 提取/ 光场/ 结构/ 线索/ ./ 为了/ 在/ 无/ 混叠/ 噪声/ 的/ 情况/ 下/ 降低/ 光场/ 的/ 角度/ 采样率/ ,/ [/ 28/ ]/ 提出/ 了/ 与/ 深度/ 相关/ 的/ 视点/ 插值/ 算法/ 提取/ 深/ Liang/ 度/ 线索/ ./ Kim/ 等/ 人/ [/ 29/ ]/ 利用/ 稠密/ 的/ 3D/ 光场/ 提取/ 深度/ 线索/ ,/ 先/ 估计/ 较/ 可靠/ 的/ 目标/ 边缘/ 的/ 深度/ ,/ 然后/ 再/ 重建/ 平滑/ 的/ 内部/ 区域/ ./ 研究/ 表明/ ,/ 模糊/ 与/ 视差/ 线索/ 是/ 场景/ 深度/ 变化/ 在/ 不同/ 维度/ 上/ 的/ 表现/ ./ 因此/ ,/ 借鉴/ 人类/ 视觉/ 的/ 深度/ 感知/ 机制/ ,/ 研究/ 人员/ 从/ 不同/ 角度/ 提出/ 了/ 一些/ 利用/ 多/ 线索/ 融合/ 解决/ 深度/ 估计/ 的/ 方法/ ./ Frese/ 等/ 人/ [/ 30/ ]/ 利用/ 不同/ 焦距/ 的/ 摄像机/ 阵列/ 获取/ 场景/ 深度/ ,/ 该/ 方法/ 融合/ 了/ 视差/ 线索/ 和/ 模糊/ 线索/ ./ Li/ 等/ 人/ [/ 31/ ]/ 提出/ 了/ 一种/ 从/ 不同/ 聚焦/ 参数/ 的/ 双视/ 图像/ 估计/ 模糊/ 核/ 和/ 视差/ 图/ 的/ 方法/ ./ 在/ 相机/ 阵列/ 合成孔径/ 成像/ 的/ 基础/ 上/ [/ 20/ ]/ ,/ Vaish/ 等/ 人/ [/ 32/ ]/ 设计/ 了/ 对/ 遮挡/ 鲁棒/ 的/ 目标/ 函数/ 重建/ 被/ 遮挡/ 目标/ 表面/ 结构/ ./ Wang/ 等/ 人/ [/ 33/ ]/ 对/ 三维/ 显示/ 中/ 影响/ 人眼/ 深度/ 感知/ 的/ 模糊/ 与/ 视差/ 线索/ 的/ 关系/ 进行/ 了/ 量化/ 分析/ ./ 这些/ 方法/ 虽然/ 都/ 涉及/ 利用/ 模糊/ 和/ 视差/ 线索/ 提取/ 场景/ 的/ 深度/ 信息/ ,/ 但是/ 如何/ 将/ 这/ 两种/ 线索/ 自/ 适应/ 融合/ ,/ 构建/ 统一/ 的/ 联合/ 计算/ 模型/ 是/ 一个/ 尚未/ 解决/ 的/ 问题/ ./ 本文/ 正是/ 从/ 这/ 一/ 角度/ 出发/ ,/ 通过/ 统一/ 的/ 光场/ 框架/ 分析/ 模糊/ 与/ 视差/ 线索/ 的/ 适用/ 特性/ ,/ 设计/ 融合/ 算法/ 实现/ 两种/ 深度/ 线索/ 优势互补/ ,/ 最终/ 在/ 马尔可夫/ 随/ 机场/ 模型/ 中/ 结合/ 鲁棒/ 的/ 邻域/ 平滑/ 约束/ 构建/ 多/ 深度/ 线索/ 深度/ 估计/ 的/ 统一/ 计算/ 模型/ ,/ 并/ 以/ 最大/ 后验/ 概率/ 得到/ 深度/ 求解/ 的/ 目标/ 能量/ 函数/ ,/ 采用/ 图割/ 算法/ 进行/ 能量/ 最小化/ 获得/ 一致/ 的/ 深度/ 估计/ 结果/ ./ 3/ 光场/ 多/ 深度/ 线索/ 分析/ 光线/ 在/ 空间/ 中/ 的/ 传播/ 过程/ 可以/ 用七维/ 函数/ 来/ 表示/ ,/ 称之为/ 全光/ 函数/ (/ PlenopticFunction/ )/ [/ 34/ ]/ ./ 全光/ 函数/ P/ (/ x/ ,/ y/ ,/ z/ ,/ θ/ ,/ / ,/ λ/ ,/ t/ )/ 中/ (/ x/ ,/ y/ ,/ z/ )/ 表示/ 空间/ 中/ 任意/ 一点/ 的/ 三维/ 坐标/ ,/ (/ θ/ ,/ / )/ 表示/ 光线/ 的/ 方向/ ,/ λ/ 为/ 光线/ 的/ 波长/ ,/ t/ 为/ 时间/ ./ 全光/ 函数/ 主要/ 用于/ 研究/ 光线/ 与/ 空间/ 几何/ 物体/ 的/ 交互/ 特性/ ,/ 一旦/ 确定/ 了/ 全光/ 函数/ ,/ 我们/ 就/ 可以/ 对光/ 的/ 各种/ 变换/ 进行/ 模拟/ ./ 但是/ 全光/ 函数/ 的/ 采样/ 、/ 存储/ 等/ 是/ 非常/ 困难/ 的/ ,/ 因此/ 必须/ 进行/ 简化/ ,/ 通常/ 只/ 考察/ 静态/ 场景/ 以/ 去掉/ 时间/ 维/ ,/ 同时/ 假设/ 每个/ 颜色/ 通道/ 内/ 光波长/ 的/ 影响/ 可/ 忽略/ ,/ 这样/ 就/ 得到/ 了/ 五维/ 全光/ 函数/ P/ (/ x/ ,/ y/ ,/ z/ ,/ θ/ ,/ / )/ ./ 更进一步/ ,/ 如果/ 去掉/ 光线/ 传播/ 过程/ 中/ 衰减/ 的/ 影响/ ,/ 全光/ 函数/ 可以/ 降/ 至/ 四维/ ,/ Levoy/ 和/ Hanrahan/ [/ 35/ ]/ 将/ 其/ 命名/ 为/ 光场/ (/ LightField/ )/ ,/ Gortler/ 等/ 人/ [/ 36/ ]/ 则/ 称之为/ 流明/ 图/ (/ Lumigraph/ )/ ./ 由于/ 光场/ 包含/ 丰富/ 的/ 场景/ 结构/ 信息/ ,/ 在/ 获得/ 光场/ 数据/ 后/ ,/ 利用/ 计算/ 摄影/ 学/ 的/ 相关/ 算法/ 不仅/ 可以/ 恢复/ 场景/ 几何/ 结构/ ,/ 还/ 可以/ 克服/ 传统/ 成像/ 系统/ 的/ 一些/ 局限性/ ./ 光场/ 有/ 多种不同/ 的/ 参数/ 化/ 形式/ ,/ 在/ Levoy/ 等/ 人/ [/ 35/ ]/ 提出/ 的/ 光场/ 理论/ 中/ ,/ 利用/ 两个/ 平行/ 平面/ 分别/ 记录/ 光线/ 的/ 位置/ 信息/ 和/ 角度/ 信息/ ,/ 即/ 得到/ 光场/ 的/ 双/ 平面/ 参数/ 化/ 模型/ LF/ (/ x/ ,/ y/ ,/ u/ ,/ v/ )/ ,/ 其中/ (/ x/ ,/ y/ )/ 和/ (/ u/ ,/ v/ )/ 分别/ 为/ 光线/ 穿过/ 位置/ 平面/ 和/ 角度/ 平面/ 的/ 坐标/ ./ 为了/ 方便/ 地/ 进行/ 可视化/ 和/ 直观/ 理解/ ,/ 通常/ 将/ 光场/ LF/ (/ x/ ,/ y/ ,/ u/ ,/ v/ )/ 的/ 位置/ 坐标/ y/ 和/ 角度/ 坐标/ v/ 设定/ 为/ 一个/ 固定/ 的/ 值/ ,/ 这/ Page4/ 样/ 就/ 得到/ 了/ 4D/ 光场/ 简化/ 后/ 的/ 2D/ 切片/ LF/ (/ x/ ,/ u/ )/ ,/ 如图/ 1/ 所示/ ./ 其/ 图示/ 称为/ 对极/ 平面图/ (/ EpipolarPlaneImages/ ,/ EPI/ )/ [/ 27/ ]/ 或/ 光线/ 空间/ 图/ (/ Ray/ -/ SpaceDiagram/ ,/ RSD/ )/ [/ 11/ ]/ ./ 当/ 在/ 相机/ 内部/ 以/ 镜头/ 平面/ 和/ 成像/ 平面/ 参数/ 化光图/ 14D/ 光场/ 及其/ 2D/ 切片/ 相机/ 阵列/ 是/ 对/ 整个/ 空间/ 光场/ 的/ 离散/ 采样/ ,/ 每个/ 相机/ 的/ 成像/ 是/ 光场/ 在/ 不同/ 角度/ 范围/ 积分/ 的/ 结果/ :/ Ik/ (/ x/ ,/ y/ )/ =/ ∫/ 其中/ ,/ uk/ ,/ l/ 、/ uk/ ,/ h/ 和/ vk/ ,/ l/ 、/ vk/ ,/ h/ 表示/ 第/ k/ 个/ 相机/ 的/ 角度/ 采样/ 范围/ ./ 当/ 相机/ 排列/ 较/ 分散/ 时/ ,/ 光场/ 的/ 角度/ 采样率/ 不足/ ,/ 会/ 导致/ 合成孔径/ 成像/ 获得/ 的/ 共/ 聚焦/ 图像/ 出现/ 混图/ 2/ 光场/ 重/ 聚焦/ 及/ 模糊/ 与/ 视差/ 线索/ 场时/ ,/ 整个/ 成像/ 过程/ 可以/ 表示/ 为/ 光场/ 对/ 角度/ 的/ 积分/ :/ 其中/ :/ I/ (/ x/ ,/ y/ )/ 为/ 获得/ 的/ 图像/ ;/ G/ (/ θ/ )/ 表示/ 角度/ 的/ 加权/ 值/ ;/ θ/ 是/ 光线/ (/ x/ ,/ y/ ,/ u/ ,/ v/ )/ 与/ 参数/ 平面/ 法向/ 的/ 夹角/ ./ 叠/ 噪声/ ./ 摄像机/ 阵列/ 采集/ 到/ 光场/ 数据/ 后/ ,/ 利用/ 合成孔径/ 成像/ 理论/ 可以/ 将/ 整个/ 相机/ 阵列/ 虚拟/ 成/ 一个/ 大/ 孔径/ 相机/ ,/ 并/ 可以/ 通过/ 重/ 聚焦/ 获得/ 不同/ 焦深/ 的/ 光场/ ./ 如图/ 2/ 所示/ 为/ 摄像机/ 阵列/ 对/ 指定/ 深度/ d/ 重/ 聚焦/ 得到/ 的/ 光场/ ,/ 图/ 2/ (/ a/ )/ 为/ 不同/ 深度/ 目标/ 的/ 光线/ 重/ 聚焦/ 后/ 光线/ 角/ Page5/ 度/ 的/ 分布/ ,/ 图/ 2/ (/ b/ )/ 为/ 由/ 虚拟/ 合成孔径/ 平面/ 和/ 共/ 聚焦/ 成像/ 平面/ 参数/ 化/ 的/ 光场/ ./ 设/ 深度/ d/ 处/ 的/ 合成/ 共/ 聚焦/ 图像/ 为/ Id/ 的/ 过程/ 即/ 是/ 对/ 4D/ 光场/ 进行/ 离散/ 角度/ 积分/ 的/ 过程/ :/ 这里/ θ/ k/ 为/ 第/ k/ 个/ 相机/ 光场/ 采样/ 的/ 角度/ ./ 此时/ ,/ 如果/ 目标/ 处在/ 合成孔径/ 候选/ 焦/ 深处/ ,/ 则/ 其/ 在/ 共/ 聚焦/ 图像/ 中/ 成/ 清晰/ 的/ 像/ ,/ 如图/ 2/ (/ c/ )/ 所示/ ,/ 而/ 不/ 在/ 焦/ 深处/ 的/ 目标/ ,/ 其共/ 聚焦/ 图像/ 会/ 有/ 相应/ 的/ 模糊/ ,/ 模糊/ 程度/ 随着/ 离/ 焦深/ 的/ 距离/ 增加/ 而/ 增大/ ./ 从图/ 2/ (/ b/ )/ 中/ 可以/ 看到/ ,/ 相机/ 阵列/ 不同/ 相机/ 是/ 对光/ 场/ 不同/ 角度/ 的/ 采样/ ,/ 这样/ 合成/ 大/ 孔径/ 相机/ 可以/ 覆盖/ 更大/ 的/ 角度/ 采样/ 范围/ ,/ 极大地提高/ 模糊/ 线索/ 的/ 景深/ 分辨率/ ./ 但是/ 如果/ 只/ 利用/ 模糊/ 线索/ ,/ 则/ 积分/ 过程/ 中/ 的/ 视差/ 信息/ 会/ 丢失/ ,/ 因此/ 本文/ 不仅/ 在/ 合成/ 大/ 孔径/ 共/ 聚焦/ 图像/ 中/ 提取/ 模糊/ 线索/ ,/ 还/ 在/ 原始/ 的/ 重/ 投影图/ 像/ 中/ 提取/ 视差/ 线索/ ,/ 即/ 对/ 某/ 一/ 位置/ 计算/ 不同/ 相机/ 重/ 投影图/ 像/ 的/ 匹配/ 值/ ./ 如图/ 2/ (/ d/ )/ 所示/ ,/ 如果/ 目标/ 在/ 这/ 一/ 合成孔径/ 候选/ 焦/ 深处/ ,/ 则/ 不同/ 角度/ 的/ 光线/ 对应/ 于/ 相同/ 的/ 位置/ ,/ 即/ 垂直于/ 位置/ 轴/ ,/ 因此/ 不同/ 相机/ 重/ 投影图/ 像/ 目标/ 位置/ 处/ 的/ 匹配/ 代价/ 较/ 小/ ,/ 否则/ 匹配/ 代价/ 较大/ ./ 计算/ 多个/ 候选/ 焦深/ 同一/ 位置/ 的/ 匹配/ 代价/ ,/ 可以/ 获得/ 视差/ 深度/ 线索/ ./ 对/ 较弱/ 的/ 纹理/ 区域/ ,/ 不同/ 深度/ 视差/ 匹配/ 值/ 呈/ 单峰/ 变化/ ,/ 视差/ 线索/ 对/ 深度/ 的/ 分辨/ 能力/ 较/ 高/ ;/ 而/ 对/ 强/ 纹理/ 区域/ 如果/ 候选/ 深度/ 与/ 真实/ 深度/ 稍/ 有/ 不同/ ,/ 其/ 视差/ 匹配/ 代价/ 就/ 会/ 很大/ ,/ 与/ 其他/ 远离/ 真实/ 深度/ 的/ 候选/ 深度/ 视差/ 匹配/ 代价/ 差异/ 较/ 小/ ./ 同样/ 地/ ,/ 对/ 重复/ 纹理/ 区域/ ,/ 不同/ 候选/ 深度/ 视差/ 匹配/ 代价/ 呈/ 多峰/ 形式/ ,/ 因此/ 视差/ 线索/ 对强/ 纹理/ 区域/ 和/ 重复/ 纹理/ 区域/ 的/ 匹配/ 鲁棒性/ 不高/ ./ 图/ 3/ 改变/ 光场/ 的/ 位置/ 参数/ 化/ 平面/ 及/ 光线/ 簇/ 位置/ 和/ 根据/ 重/ 聚焦/ 理论/ ,/ 改变/ 合成孔径/ 重/ 聚焦/ 焦深/ 相当于/ 改变/ 了/ 光场/ 的/ 位置/ 参数/ 化/ 平面/ ,/ 与/ 新/ 位置/ 平面/ 相交/ 于/ x/ 的/ 光线/ 与/ 原/ 位置/ 平面/ 相交/ 于/ (/ x/ -/ u/ )/ d/ 如图/ 3/ (/ a/ )/ 所示/ ,/ 这/ 时光/ 场/ 变为/ LF/ (/ x/ ,/ y/ ,/ u/ ,/ v/ )/ =/ LFu/ +/ (/ x/ -/ u/ )/ d/ 即/ 新/ 的/ 光场/ 表示/ 只是/ 原光场/ 的/ 位置/ 参数/ 缩放/ 和/ 平移/ 的/ 结果/ ./ 利用/ 这一/ 特性/ ,/ 在/ 要/ 获得/ 多个/ 候选/ 重/ 聚焦/ 深度/ 的/ 重/ 投影图/ 像/ 时/ ,/ 可以/ 加快/ 计算速度/ ./ 图/ 3/ (/ b/ )/ 为/ 参数/ 化光场/ 中点/ p/ 的/ 光线/ 簇/ 在/ 位置/ 轴/ 和/ 角度/ 轴/ 的/ 相对/ 变化/ 关系/ ,/ 根据/ 文献/ [/ 27/ ]/ 得/ 其中/ :/ f/ 为/ 参数/ 化双/ 平面/ 之间/ 的/ 距离/ ;/ d/ 为点/ p/ 的/ 深度/ ./ 当/ 利用/ 重/ 投影图/ 像/ 平面/ 参数/ 化光场/ 时/ ,/ 相当于/ 对/ 原始/ 光场/ 进行/ 了/ 图/ 3/ (/ a/ )/ 中/ x/ 位置/ 的/ 平移/ ,/ 新/ 的/ 位置/ 轴/ 偏移/ 与/ 原始/ 位置/ 轴/ 偏移/ 符号/ 相反/ ,/ 式/ (/ 5/ )/ 变为/ 即/ 在/ 重/ 聚焦/ 光场/ 中/ 深度/ 小于/ 重/ 聚焦/ 深度/ f/ 的/ 点/ ,/ 其/ 光线/ 簇/ 斜率/ 为/ 正/ ,/ 并且/ 深度/ 越小/ 斜率/ 也/ 越/ 小/ ;/ 深度/ 大于/ 重/ 聚焦/ 深度/ f/ 的/ 点/ ,/ 其/ 光线/ 簇/ 斜率/ 为/ 负/ ,/ 并且/ 深度/ 大/ 斜率/ 也/ 越/ 大/ ./ 即/ 与/ 重/ 聚焦/ 深度/ 差越/ 大/ ,/ 光线/ 簇/ 相对/ 于/ 角度/ 轴/ u/ 倾斜角/ 越大/ ,/ 从而/ 共/ 聚焦/ 图像/ 越/ 模糊/ ,/ 其/ 相应/ 的/ 视差/ 匹配/ 代价/ 也/ 越/ 大/ ./ Wanner/ 等/ 人/ [/ 27/ ]/ 即/ 直接/ 利用光/ 场中/ 不同/ 深度/ 目标/ 的/ 光线/ 簇/ 斜率/ 与/ 深度/ 的/ 关系/ 及/ 一致性/ 约束/ 建立/ 全局/ 目标/ 函数/ ,/ 优化/ 求解/ 获得/ 场景/ 深度/ ,/ 然而/ 这种/ 直接/ 利用光/ 场/ 特性/ 进行/ 深度/ 估计/ 的/ 方法/ 其/ 适用范围/ 有限/ ./ 对/ 不同/ 的/ 候选/ 焦/ 深重/ 聚焦/ ,/ 可以/ 获得/ 一组/ 共/ 聚焦/ 图像/ 和/ 重/ 投影图/ 像/ ./ 图/ 4/ 所示/ 为/ 不同/ 重/ 聚焦/ 深度/ 计算/ 模糊/ 线索/ 的/ 示意图/ ,/ 在/ 共/ 聚焦/ 图像/ 中/ ,/ 与/ 重/ 聚焦/ 深度/ d/ 接近/ 的/ 目标/ 比较/ 清晰/ ,/ 而/ 远离/ 深度/ d/ 的/ 目标/ 则/ 比较/ 模糊/ ,/ 因此/ 可以/ 根据/ 不同/ 重/ 聚焦/ 深度/ 模糊/ 线索/ 值/ 的/ 变化/ ,/ 选择/ 模糊/ 值/ 最小/ 的/ 深度/ 作为/ 目标/ 点/ 的/ 估计/ 深度/ ./ 对强/ 纹理/ 区域/ 或/ 边缘/ ,/ 由于/ 在/ 焦深/ 和/ 远离/ 焦深/ 其/ 模糊/ 线索/ 相差/ 较大/ ,/ 因此/ 模糊/ 线索/ 可靠性/ 较/ 高/ ./ 视差/ 线索/ 中/ 不同/ 光场/ 采样/ 角度/ 之间/ 的/ 匹配/ 也/ 即重/ 投影图/ 像/ 的/ 匹配/ ,/ 如图/ 5/ 所示/ 为/ 不同/ 重/ 聚焦/ 深度/ 的/ 光场/ ,/ 可以/ 看到/ 不同/ 光场/ 采样/ 角度/ 之间/ 匹配/ 代价/ 的/ 变化/ ,/ 只有/ 重/ 聚焦/ 深度/ d2/ 与/ 目标/ 深度/ 相同/ ,/ 匹配/ 代价/ 才/ 最小/ ,/ 否则/ 匹配/ 代价/ 较大/ ,/ 因此/ 可以/ 通过/ 选择/ 最小/ 匹配/ 代价/ 求得/ 目标/ 深度/ ./ 模糊/ 线索/ 度量/ 光场/ 积分/ 后/ 空间/ 位置/ 的/ 变化/ ,/ 而/ 视差/ 线索/ 则/ 是/ 对光/ 场/ 不同/ 角度/ 匹配/ 情况/ 的/ 度量/ ,/ 两种/ 线索/ 代表/ 光场/ 中/ 表征/ 深度/ 变化/ 的/ 两个/ 维度/ ,/ 具有/ 一定/ 的/ 互补性/ ./ Page6/ 图/ 4/ 不同/ 重/ 聚焦/ 深度/ 的/ 模糊/ 线索/ 图/ 5/ 不同/ 重/ 聚焦/ 深度/ 的/ 视差/ 线索/ 4/ 多/ 线索/ 融合/ 全局/ 一致/ 深度/ 估计/ 基于/ 上述/ 对光/ 场/ 数据/ 中/ 包含/ 的/ 模糊/ 与/ 视差/ 线索/ 的/ 分析/ ,/ 结合/ 各个/ 深度/ 线索/ 的/ 适用/ 情况/ ,/ 本文/ 提出/ 了/ 自/ 适应/ 融合/ 模糊/ 与/ 视差/ 线索/ 的/ 全局/ 一致/ 深度/ 估计/ 方法/ ,/ 算法/ 的/ 整体/ 框架/ 如图/ 6/ 所示/ ./ 首先/ 利用/ 重/ 聚焦/ 理论/ 获得/ L/ 个/ 候选/ 深度/ di/ {/ i/ =/ 1/ ,/ …/ ,/ L/ }/ 的/ 重/ 投影图/ 像/ k/ (/ x/ ,/ y/ )/ ,/ 并/ 提取/ 每个/ 位置/ 表示/ 光线/ 角度/ 变化/ 的/ 视/ Idi/ 差/ 线索/ ./ 同时/ 利用/ 重/ 投影图/ 像/ 合成/ 共/ 聚焦/ 图像/ s/ (/ x/ ,/ y/ )/ ,/ 并/ 从中/ 提取/ 表示/ 空间/ 变化/ 的/ 模糊/ 线索/ ,/ 然/ Idi/ 后/ 对/ 获得/ 的/ 不同/ 深度/ 模糊/ 与/ 视差/ 线索/ ,/ 利用/ 自/ 适应/ 权重/ 进行/ 融合/ ./ 为了/ 获得/ 全局/ 一致/ 的/ 结构化/ 深度/ 结果/ ,/ 本文/ 在/ 马尔可夫/ 随/ 机场/ 模型/ 中/ 结合/ 鲁棒/ 的/ 成/ 对/ 结点/ 势函数/ ,/ 通过/ 图割/ 算法/ 进行/ 最大/ 后验/ 概率/ 推理/ 获得/ 场景/ 深度/ ./ 对于/ 任意/ 候选/ 深度/ d/ 的/ 重/ 投影图/ 像/ Id/ 可以/ 利用/ 式/ (/ 3/ )/ 计算/ 这一/ 深度/ 共/ 聚焦/ 图像/ Id/ 度量/ 共/ 聚焦/ 图像/ 中/ 目标/ 点/ 模糊/ 度/ 的/ 算法/ 有/ 很多/ ,/ 由于/ 本文/ 的/ 目标/ 是/ 验证/ 多/ 深度/ 线索/ 融合/ 与/ 优化/ 方法/ ,/ 因此/ 采用/ 传统/ 高效/ 的/ 共/ 聚焦/ 图像/ 的/ 灰度/ 方差/ [/ 15/ ]/ 作为/ 模糊/ 线索/ 的/ 度量/ :/ 其中/ u/ -/ d/ 的/ 邻域/ 内像素/ 的/ 灰度/ 均值/ ,/ Np/ 表示/ 点/ p/ 的/ 邻域/ ,/ zblur/ 为/ 归一化/ 因子/ ./ 如图/ 7/ 所示/ ,/ 点/ p/ 的/ 邻域/ 灰度/ 方差/ 越大/ 表示/ 其越/ 清晰/ ,/ 模糊/ 线索/ 值/ 就/ 越/ 小/ ;/ 相反/ ,/ 灰度/ 方差/ 越小/ 表示/ 其越/ 模糊/ ,/ 模糊/ 线索/ 值/ 就/ 越/ 大/ ./ 在/ 立体匹配/ 中/ ,/ 有/ 多种/ 代价/ 集成/ 方法/ 可以/ 计算/ 像素/ 邻域/ 的/ 视差/ 匹配/ 值/ ,/ 本文/ 采用/ 不同/ 重/ 投影图/ 像/ 中点/ p/ 邻域/ 的/ SSD/ 作为/ 视差/ 线索/ :/ q/ 表示/ 深度/ d/ 的/ 所有/ 重/ 投影图/ 像/ Id/ 其中/ 珔/ IdN/ }/ 在/ 位置/ q/ 的/ 颜色/ 向量/ 平均值/ ,/ zdisp/ 为/ 归一化/ 因子/ ./ 如果/ 点/ p/ 的/ 真实/ 深度/ 与/ 候选/ 深度/ d/ 越/ 接近/ ,/ 其/ 在/ 不同/ 重/ 投影图/ 像/ 中/ 的/ 邻域/ 对应/ 就/ 越/ 准确/ ,/ 相应/ 的/ 视差/ Page7/ 图/ 6/ 模糊/ 与/ 视差/ 融合/ 全局/ 一致/ 深度/ 估计/ 框架图/ 7/ 点/ p/ 在/ 连续/ 7/ 个/ 聚焦/ 深度/ 共/ 聚焦/ 图像/ 及重/ 投影图/ 像/ 中/ 的/ 邻域/ 窗口/ 线索/ 值/ 就/ 越/ 小/ ,/ 即/ 匹配/ 度越/ 高/ ./ 基于/ 第/ 3/ 节/ 的/ 分析/ ,/ 模糊/ 线索/ 对强/ 纹理/ 及/ 边缘/ 深度/ 判别/ 可靠性/ 较/ 高/ ;/ 而/ 视差/ 线索/ 对弱/ 纹理/ 区域/ 效果/ 较/ 好/ ,/ 对强/ 纹理/ 和/ 重复/ 纹理/ 处则/ 不够/ 鲁棒/ ./ 两种/ 不同/ 深度/ 线索/ 表示/ 深度/ 信息/ 在/ 光场/ 数据/ 集/ 的/ 不同/ 特征/ ,/ 彼此/ 具有/ 一定/ 的/ 互补性/ ./ 因此/ 在/ 融合/ 过程/ 中/ ,/ 为了/ 达到/ 优势互补/ ,/ 本文/ 采用/ 了/ 类似/ 文献/ [/ 37/ ]/ 的/ 自/ 适应/ 融合/ 方法/ :/ Vp/ (/ d/ )/ =/ λ/ pblurp/ (/ d/ )/ +/ (/ 1/ -/ λ/ p/ )/ dispp/ (/ d/ )/ (/ 9/ )/ 其中/ λ/ p/ 是/ 自/ 适应/ 权重/ ./ 如果/ 深度/ 线索/ 值/ 在/ 不同/ 的/ 候选/ 深度/ 差别/ 较大/ ,/ 那么/ 该/ 线索/ 对/ 深度/ 的/ 区分/ 性/ 就/ 较/ 强/ ,/ 应该/ 分配/ 其/ 获得/ 更大/ 的/ 融合/ 权重/ ./ 因此/ ,/ 本文/ 设计/ 自/ 适应/ 的/ 权重/ 分配/ 计算/ 方式/ 为/ λ/ p/ =/ Cblur/ (/ p/ )/ +/ Cdisp/ (/ p/ )/ Cblur/ (/ p/ )/ =/ Cdisp/ (/ p/ )/ =/ 其中/ :/ 共有/ L/ 个/ 候选/ 深度/ ,/ blurp/ ,/ min/ 和/ dispp/ ,/ min/ 分别/ 表示/ 点/ p/ 在/ 不同/ 候选/ 深度/ 中/ 模糊/ 线索/ 和/ 视差/ 线索/ 的/ 最小值/ ;/ σ/ blur/ 和/ σ/ disp/ 是/ 相应/ 的/ 参数/ ./ 框架图/ 6/ 中/ 融合/ 阶段/ 的/ 灰度/ 图/ 表示/ 计算/ 得到/ 的/ 自/ 适应/ 权重/ ./ 当/ 获得/ 了/ 点/ 在/ 不同/ 候选/ 深度/ 的/ 判别/ 值后/ ,/ 可以/ 通过/ 直接/ 求解/ :/ 获得/ 每个/ 点/ 的/ 深度/ ,/ 也/ 可以/ 对/ 融合/ 前/ 的/ 模糊/ 与/ 视差/ 线索/ 分别/ 利用/ 式/ (/ 13/ )/ 直接/ 求解/ ,/ 但是/ 直接/ 求解/ 方法/ 获得/ 的/ 深度/ 结果/ 噪声/ 比较/ 大/ ,/ 因为/ 没有/ 利用/ 每个/ 点/ 的/ 邻域/ 信息/ ,/ 为了/ 利用/ 邻域/ 平滑/ 获得/ 全局/ 一致/ 的/ 深度/ 结果/ 犇/ ^/ ,/ 本文/ 利用/ 马尔可夫/ 随/ 机场/ 表示/ 深度/ 估计/ 问题/ ,/ 其后/ 验/ 概率密度/ 为/ Page8/ 其中/ :/ Φ/ (/ dp/ ,/ 犞/ p/ )/ =/ e/ 索/ 犞/ p/ 的/ 匹配/ 似然/ ;/ Ψ/ (/ dp/ ,/ dq/ )/ =/ e/ 夫随/ 机场/ 中/ 邻域/ 节点/ 之间/ 的/ 平滑/ 先验/ ,/ λ/ 表示/ 邻域/ 约束/ 强度/ ./ 最大化/ 后验/ 概率/ 进行/ 深度/ 估计/ :/ 犇/ ^/ =/ argmax/ 化简/ 得到/ 相等/ 的/ 最小化/ 能量/ 函数/ 形式/ :/ 犇/ ^/ =/ argmin/ =/ argmin/ =/ argmin/ 其中/ 数据项/ 为/ 模糊/ 与/ 视差/ 线索/ 的/ 融合/ 结果/ :/ Edata/ (/ 犇/ )/ =/ ∑/ p/ 平滑/ 项/ 表示/ 局部/ 邻域/ 的/ 平滑/ 约束/ ,/ 本文/ 考虑/ 的/ 两个/ 目标/ 是/ :/ (/ 1/ )/ 在/ 图像/ 坐标/ 空间/ 与/ 颜色/ 空间/ 距离/ 相近/ 的/ 点/ 要/ 有/ 相似/ 的/ 深度/ ;/ (/ 2/ )/ 对/ 深度/ 突变/ 处/ 避免/ 过/ 平滑/ 导致/ 结果/ 错误/ ./ 基于/ 以上/ 的/ 两点/ 考虑/ ,/ 本文/ 借鉴/ 立体匹配/ [/ 22/ ]/ 中/ 的/ 思想/ ,/ 定义/ 任意/ 点/ 与其/ 邻域/ 点/ 的/ 平滑/ 约束/ 权重/ w/ (/ p/ ,/ q/ )/ =/ exp/ -/ 其中/ :/ 犐/ p/ 、/ 犐/ q/ 分别/ 表示/ 点/ p/ 、/ q/ 的/ 颜色/ 向量/ ;/ 犌/ p/ 、/ 犌/ q/ 表示/ 点/ p/ 、/ q/ 的/ 坐标/ 向量/ ./ 当/ 两个/ 相邻/ 点/ 距离/ 较近/ 并且/ 颜色/ 较/ 相似/ 时/ ,/ 两个/ 点/ 的/ 深度/ 平滑/ 约束/ 较强/ ,/ 否则/ 平滑/ 约束/ 较弱/ ./ 平滑/ 项/ 计算公式/ 为/ 基于/ 式/ (/ 19/ )/ 得到/ 的/ 平滑/ 约束/ ,/ 既/ 能/ 平滑/ 相似/ 点/ 深度/ 值/ ,/ 又/ 能/ 在/ 深度/ 突变/ 处自/ 适应/ 地/ 减弱/ 约束/ ./ 对式/ (/ 16/ )/ 的/ 目标/ 能量/ 函数/ ,/ 本文/ 用图/ 割/ [/ 23/ ,/ 38/ -/ 39/ ]/ 算法/ 进图/ 8/ 简单/ 虚拟/ 场景/ 的/ 深度/ 估计/ 结果/ 行/ 最小化/ 获得/ 最终/ 的/ 深度/ 结果/ ,/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 多/ 线索/ 融合/ 深度/ 估计/ ./ 输入/ :/ 原始/ 光场/ 数据/ 犔/ 0/ 输出/ :/ 深度/ 犇/ ^/ FORk/ =/ 1ToLDOLkENDFORFOR/ / p/ ∈/ ν/ DO/ 计算/ 融合/ 权重/ λ/ pENDFORFOR/ / {/ p/ ,/ q/ }/ ∈/ ε/ DO/ 计算/ 平滑/ 约束/ 权重/ w/ (/ p/ ,/ q/ )/ // // 式/ (/ 18/ )/ ENDFOR/ 构建/ 马尔可夫/ 随/ 机场/ 模型/ P/ (/ 犇/ |/ 犞/ )/ 用图/ 割/ 算法/ 求解/ 能量/ 最小化/ 得到/ 深度/ 犇/ ^/ // // 式/ (/ 16/ )/ 5/ 实验/ 结果/ 与/ 分析/ 为了/ 验证/ 提出/ 算法/ 的/ 有效性/ ,/ 本文/ 分别/ 在/ 虚拟/ 数据/ 和/ 真实/ 数据/ 上/ 进行/ 了/ 实验/ ,/ 并/ 与/ 现有/ 流行/ 的/ 深度/ 估计/ 方法/ 进行/ 了/ 比较/ ./ 通过/ 对/ 结果/ 精细/ 程度/ 和/ 计算/ 量/ 的/ 权衡/ ,/ 本文/ 选择/ 在/ 场景/ 目标/ 的/ 深度/ 范围/ 内/ 均匀/ 获得/ 100/ 个重/ 投影/ 深度/ ./ 5.1/ 虚拟/ 数据/ 实验/ 虚拟/ 数据/ 是/ 对/ 一个/ 绘制/ 好/ 的/ 三维/ 场景/ ,/ 利用/ 一个/ 8/ ×/ 8/ 的/ 虚拟/ 相机/ 阵列/ 对/ 该/ 场景/ 进行/ 拍摄/ ,/ 从而/ 获得/ 64/ 幅/ 不同/ 视角/ 的/ 原/ 图像/ ,/ 每幅/ 图像/ 的/ 分辨率/ 为/ 780/ ×/ 538/ ./ 如图/ 8/ (/ a/ )/ 所示/ 的/ 简单/ 虚拟/ 场景/ 是/ 由/ 处于/ Page93/ 个/ 不同/ 深度/ 的/ 书/ 组成/ ,/ 对/ 12/ 个/ 不同/ 深度/ 重/ 投影/ 获得/ 的/ 光场/ 如图/ 9/ ,/ 可见/ 在/ 目标/ 所在/ 的/ 焦深/ ,/ 由于/ 目标/ 同一/ 位置/ 不同/ 角度/ 光线/ 来自/ 于/ 空间/ 同/ 一点/ ,/ 其光场/ 本文/ 计算/ 模糊/ 线索/ 的/ 窗口/ 大小/ 为/ 7/ ×/ 7/ ,/ 图/ 7/ 最/ 上面/ 一行/ 显示/ 了/ 一个/ 复杂/ 虚拟/ 场景/ 某点/ p/ 在/ 连续/ 7/ 个/ 聚焦/ 深度/ 共/ 聚焦/ 图像/ 中/ 模糊/ 方差/ 线索/ 的/ 计算/ 窗口/ ,/ 从图/ 中/ 可以/ 看到/ ,/ 在/ 点/ p/ 的/ 真实/ 深度/ dk/ 处/ ,/ 其/ 附近/ 邻域/ 像素/ 梯度/ 较大/ ,/ 式/ (/ 7/ )/ 的/ 模糊/ 方差/ 判别/ 值较/ 小/ ,/ 其他/ 聚焦/ 深度/ 点/ p/ 的/ 邻域/ 则/ 较为/ 模糊/ ./ 视差/ SSD/ 深度/ 线索/ 需要/ 计算/ 某一/ 聚焦/ 深度/ 不同/ 相机/ 重/ 投影图/ 像/ 中同/ 一点/ 的/ 匹配/ 代价/ ,/ 图/ 7/ 最下/ 一/ 行为/ 点/ p/ 在/ 相应/ 聚焦/ 深度/ 的/ 视差/ 邻域/ 窗口/ ,/ 窗口/ 大小/ 为/ 7/ ×/ 7/ ,/ 可以/ 看到/ 在/ 点/ p/ 所在/ 的/ 深度/ dk/ 处/ ,/ 其/ 在/ 不同/ 相机/ 之间/ 邻域/ 较/ 相似/ ,/ 式/ (/ 8/ )/ 视差/ 匹配/ 代价/ 较/ 小/ ./ 图/ 10/ 为点/ p/ 在/ 图/ 7/ 所示/ 窗口/ 中/ 计算/ 所得/ 的/ 模糊/ 方差/ 、/ 视差/ SSD/ 及/ 融合/ 线索/ 值/ 曲线/ ,/ 可见/ 在/ 点/ p/ 的/ 真实/ 深度/ 处/ ,/ 两个/ 线索/ 值均/ 为/ 最小/ ,/ 但是/ 模糊/ 线索/ 值/ 的/ 差异/ 更大/ ,/ 即/ 对/ 深度/ 的/ 区分/ 性/ 更/ 强/ ,/ 所以/ 融合/ 权重/ 更大/ ,/ 融合/ 后/ 的/ 线索/ 也/ 保持/ 了/ 模糊/ 线索/ 的/ 强/ 区分/ 性/ ,/ 从图/ 7/ 中/ 可见/ 点/ p/ 处在/ 边缘/ 处/ ,/ 这/ 就/ 验证/ 了/ 第/ 3/ 节/ 的/ 分析/ ,/ 即/ 在/ 边缘/ 处/ 模糊/ 线索/ 的/ 可靠性/ 要/ 高于/ 视图/ 10/ 图/ 7/ 点/ p/ 处/ 计算/ 的/ 模糊/ 方差/ 、/ 视差/ SSD/ 及/ 融合/ 线索/ 值/ (/ 模糊/ 方差/ 与/ 视差/ SSD/ 的/ 融合/ 权重/ 分别/ 为/ 0.851/ 和/ 0.149/ )/ 不随/ 角度/ 而/ 变化/ ,/ 这时/ 获得/ 的/ 共/ 聚焦/ 图像/ 目标/ 位置/ 模糊/ 判别/ 值/ 小/ ,/ 同样/ 相机/ 阵列/ 不同/ 角度/ 相机/ 之间/ 的/ 视差/ 匹配/ 代价/ 也/ 较/ 小/ ./ 差/ 线索/ ./ 图/ 8/ 为/ 简单/ 虚拟/ 场景/ 目标/ 区域/ 的/ 深度/ 估计/ 结果/ ,/ 其中/ (/ b/ )/ 、/ (/ c/ )/ 、/ (/ d/ )/ 没有/ 邻域/ 平滑/ 与/ 优化/ ,/ 即由式/ (/ 13/ )/ 直接/ 取/ 每个/ 点/ 的/ 最小/ 判别/ 值/ 所在/ 深度/ 为/ 估计/ 结果/ ,/ 其中/ 模糊/ 、/ 视差/ 及/ 融合/ 线索/ 的/ 准确率/ 分别/ 为/ 59.0/ %/ 、/ 98.9/ %/ 和/ 99.8/ %/ ,/ 即/ 自/ 适应/ 融合/ 线索/ 深度/ 准确率/ 相比/ 于/ 单一/ 线索/ 有所提高/ ,/ 图中/ 虚线/ 及/ 实线/ 方框/ 分别/ 表示/ 结果/ 较差/ 和/ 结果/ 较/ 好/ 的/ 区域/ ,/ 可以/ 看到/ 融合/ 后/ 的/ 结果/ 确实/ 利用/ 了/ 不同/ 线索/ 的/ 优势/ ,/ 这/ 证明/ 本文/ 的/ 自/ 适应/ 融合/ 方法/ 是/ 有效/ 的/ ./ 图/ 8/ (/ e/ )/ 为用/ 灰度/ 表示/ 的/ 自/ 适应/ 融合/ 权重/ 图/ ,/ 可见/ 边缘/ 和/ 强/ 纹理/ 处/ 模糊/ 线索/ 权重/ 较大/ ,/ 这些/ 也/ 正是/ 模糊/ 线索/ 可靠性/ 较/ 高/ 的/ 区域/ ;/ 而弱/ 纹理/ 处/ 视差/ 线索/ 权重/ 较大/ ,/ 与/ 第/ 3/ 节/ 分析/ 的/ 视差/ 线索/ 适用/ 区域/ 一致/ ./ 另外/ 由于/ 此/ 虚拟/ 场景/ 较/ 简单/ ,/ 所以/ 不/ 需要/ 邻域/ 平滑/ 准确度/ 就/ 已经/ 很/ 高/ ,/ 当对/ 各个/ 线索/ 利用/ 马尔可夫/ 随/ 机场/ 进行/ 平滑/ 优化/ 时/ ,/ 无论/ 原始/ 单一/ 深度/ 线索/ 还是/ 融合/ 线索/ ,/ 其/ 深度/ 估计/ 结果/ 准确率/ 都/ 几乎/ 达到/ 100/ %/ ,/ 并/ 没有/ 差异/ ./ 复杂/ 虚拟/ 场景/ 的/ 深度/ 估计/ 结果/ 如图/ 11/ 所示/ ./ 由于/ 场景/ 比较复杂/ ,/ 对/ 融合/ 线索/ 直接/ 求解/ 而/ 无/ 邻域/ 平滑/ 与/ 优化/ 的/ 结果/ 噪声/ 还是/ 比较/ 大/ ,/ 但是/ 在/ 有些/ 区域/ 还是/ 获得/ 了/ 模糊/ 与/ 视差/ 中较/ 好/ 的/ 结果/ ./ 图/ 11/ (/ f/ )/ 、/ (/ g/ )/ 、/ (/ h/ )/ 是/ 利用/ 马尔可夫/ 随/ 机场/ 邻域/ 平滑/ 与/ 优化/ 的/ 结果/ ,/ 可见/ 相比/ 于/ 直接/ 求解/ ,/ 利用/ 邻域/ 约束/ 获得/ 的/ 深度/ 估计/ 结果/ 中/ 噪声/ 得到/ 了/ 较/ 好/ 的/ 抑制/ ,/ 图/ 11/ (/ i/ )/ 自/ 适应/ 融合/ 权重/ 和/ 图/ 11/ (/ h/ )/ 深度/ 结果表明/ 本文/ 的/ 方法/ 较/ 好/ 地/ 利用/ 了/ 不同/ 线索/ 的/ 优势/ ,/ 而且/ 目标/ 边缘/ 深度/ 突变/ 处/ 深度/ 结果/ 明显/ 好于/ 直接/ 求解/ 结果/ ,/ 表明/ 本文/ 提出/ 方法/ 的/ 有效性/ ./ 图/ 11/ (/ e/ )/ 为/ 场景/ 的/ 真实/ 深度/ ,/ (/ f/ )/ 、/ (/ g/ )/ 、/ (/ h/ )/ 与/ 真实/ 深度/ 的/ 相对/ 差异/ 显示/ 在/ (/ j/ )/ 、/ (/ k/ )/ 、/ Page10/ (/ l/ )/ ,/ 从图/ 中/ 可见/ 本文/ 方法/ 获得/ 的/ 深度/ 结果/ 大部分/ 深度/ 误差/ 较/ 小/ ,/ 而/ 视差/ SSD/ 的/ 结果/ 由于/ 图像/ 边缘/ 处光场/ 的/ 非/ 均匀/ 采样/ ,/ 导致/ 匹配/ 代价/ 计算/ 不/ 准确/ ,/ 使/ 边缘/ 处/ 结果/ 深度/ 误差/ 较大/ ./ 但是/ 经过/ 多/ 深度/ 线索/ 融合/ 与/ 图/ 11/ 复杂/ 虚拟/ 场景/ 的/ 深度/ 估计/ 结果/ 图/ 12/ 为/ 使用/ 和/ 不/ 使用/ 平滑/ 优化/ 的/ 深度/ 错误率/ 随/ 允许/ 误差/ 的/ 变化/ 曲线/ ,/ 可以/ 看到/ 利用/ 马尔可夫/ 随/ 机场/ 平滑/ 优化/ 后/ 的/ 结果/ 明显/ 好于/ 未/ 平滑/ 优化/ 的/ 结果/ ,/ 证明/ 邻域/ 平滑/ 是/ 有效/ 的/ ./ 同时/ 融合/ 多/ 深度/ 线索/ 也/ 较/ 单一/ 线索/ 能够/ 获得/ 更/ 准确/ 的/ 深度/ 结果/ ./ 5.2/ 真实/ 数据/ 实验/ 由于/ 本文/ 的/ 方法/ 需要/ 相机/ 阵列/ 获得/ 的/ 光场/ 数据/ 用于/ 深度/ 估计/ ,/ 已/ 公开/ 的/ 标准/ 深度/ 估计/ 数据/ 集中/ ,/ 并/ 没有/ 符合要求/ 的/ 相机/ 阵列/ 数据/ ./ 因此/ 为了/ 获取/ 真实/ 马尔可夫/ 随/ 机场/ 平滑/ 约束/ 的/ 传播/ ,/ 视差/ 线索/ 边缘/ 的/ 错误/ 并/ 没有/ 对/ 最终/ 的/ 深度/ 结果/ 造成/ 影响/ ,/ 由此/ 表明/ 本文/ 所/ 提出/ 的/ 模型/ 与/ 单一/ 深度/ 线索/ 方法/ 相比/ 具有/ 较强/ 的/ 鲁棒性/ ./ 场景/ 的/ 光场/ 数据/ ,/ 本文/ 搭建/ 了/ 由/ 64/ 台/ 工业/ 相机/ 组成/ 的/ 相机/ 阵列/ ,/ 采用/ 的/ 相机/ 型号/ 为/ 1H046C/ ./ 两组/ 真实/ 场景/ 深度/ 估计/ 结果/ 如图/ 13/ 和/ 图/ 14/ 所示/ ,/ 其中/ 图/ 13/ (/ b/ )/ 、/ (/ c/ )/ 和/ 图/ 14/ (/ b/ )/ 、/ (/ c/ )/ 利用/ 模糊/ 与/ 视差/ 线索/ 直接/ 求解/ 获得/ 的/ 结果/ 噪声/ 都/ 比较/ 大/ ,/ 而/ 通过/ 马尔可夫/ 随/ 机场/ 进行/ 邻域/ 约束/ 的/ 传播/ ,/ 深度/ 噪声/ 得到/ 了/ 较/ 好/ 的/ 抑制/ ,/ 获得/ 的/ 结果/ 更加/ 平滑/ 准确/ (/ 如图/ 13/ (/ f/ )/ 、/ (/ g/ )/ 、/ 图/ 14/ (/ f/ )/ 、/ (/ g/ )/ )/ ./ 图/ 13/ 和/ 图/ 14/ 的/ 结果表明/ 相比/ 于/ 单一/ 深度/ 线索/ ,/ 融合/ 深度/ 线索/ 在/ 很大/ 程度/ 上/ 能够/ 利用/ 不同/ 深度/ 线索/ 的/ 优势/ ,/ 利用/ 融合/ 深度/ 线索/ 进行/ 深度/ 求解/ 获得/ 的/ 结果/ 更加/ 可靠/ ,/ 对/ 原始/ 深度/ 线索/ 中/ 的/ 噪声/ 不/ 敏感/ ./ 实验/ 中/ 为了/ 验证/ 光场/ 角度/ 采样率/ 对/ 深度/ 估计/ 结果/ 的/ 影响/ ,/ 图/ 14/ 的/ 场景/ 只用/ 了/ 9/ 台/ 相机/ 进行/ 拍摄/ ,/ 其/ 模糊/ 线索/ 的/ 深度/ 估计/ 结果/ 较差/ ,/ 原因/ 主要/ 是/ 进行/ 模糊/ 线索/ 计算/ 的/ 共/ 聚焦/ 图像/ 由式/ (/ 3/ )/ 得到/ ,/ 即/ 是/ 光场/ 的/ 积分/ 过程/ ,/ 相机/ 数量/ 少/ 导致/ 光场/ 角度/ 采样率/ 严重不足/ ,/ 获得/ 的/ 共/ 聚焦/ 图像/ 信号/ 混叠/ 严重/ ,/ 影响/ 了/ 模糊/ 线索/ 的/ 可靠性/ ./ 不过/ ,/ 由于/ 视差/ 线索/ 只/ 需/ 进行/ 不同/ 相机/ 重/ 投影图/ 像/ 之间/ 的/ 匹配/ 计算/ ,/ 所以/ 不受/ 光场/ 角度/ 采样率/ 不足/ 的/ 影响/ ,/ 结果/ 较/ 好/ ./ Page11/ 图/ 138/ ×/ 8/ 相机/ 阵列/ 获取/ 真实/ 场景/ 的/ 深度/ 估计/ 结果/ 图/ 143/ ×/ 3/ 相机/ 阵列/ 获取/ 真实/ 场景/ 的/ 深度/ 估计/ 结果/ 6/ 结论/ 本文/ 提出/ 了/ 一种/ 基于/ 光场/ 数据/ 多/ 线索/ 融合/ 的/ 全局/ 深度/ 估计/ 方法/ ./ 根据/ 对/ 相机/ 阵列/ 光场/ 数据/ 中/ 包含/ 的/ 模糊/ 与/ 视差/ 深度/ 线索/ 的/ 分析/ ,/ 本文/ 首先/ 利用/ 合成孔径/ 重/ 聚焦/ 理论/ 获得/ 指定/ 深度/ 重/ 投影图/ 像/ ,/ 并/ 对/ 重/ 投影图/ 像/ 进行/ 光场/ 积分/ 得到/ 共/ 聚焦/ 图像/ ./ 随后/ ,/ 分别/ 从/ 共/ 聚焦/ 图像/ 和/ 重/ 投影图/ 像/ 提取/ 模糊/ 与/ 视差/ 线索/ ./ 进而/ ,/ 本文/ 对/ 模糊/ 与/ 视差/ 线索/ 进行/ 了/ 自/ 适应/ 融合/ ,/ 并/ 利用/ 马尔可夫/ 随/ 机场/ 平滑/ 优化/ 对/ 深度/ 的/ 计算/ ,/ 以/ 获得/ 鲁棒/ 的/ 深度/ 估计/ 结果/ ./ 实验/ 结果/ 验证/ 了/ 深度/ 线索/ 融合/ 方法/ 能够/ 利用/ 不同/ 线索/ 的/ 优势/ ,/ 自/ 适应/ 的/ 邻域/ 平滑/ 方法/ 使/ 深度/ 估计/ 结果/ 更加/ 鲁棒/ ./ 然而/ 从/ 实验/ 结果/ 也/ 可以/ 看出/ ,/ 本文/ 的/ 方法/ 在/ 深度/ 突变/ 剧烈/ 及/ 不同/ 深度/ 纹理/ 相似/ 度/ 较/ 高/ 的/ 区域/ 结果/ 仍/ 存在/ 一些/ 不足/ ,/ 尤其/ 对于/ 存在/ 遮挡/ 的/ 区域/ ,/ 本文/ 方法/ 未能/ 很/ 好地解决/ 深度/ 信息/ 丢失/ 的/ 问题/ ./ 另外/ ,/ 本文/ 能量/ 函数/ 中/ 的/ 整体/ 平滑/ 项/ 权重/ λ/ 及/ 相邻/ 点/ 之间/ 平滑/ 权重/ 计算/ 中/ 的/ rc/ 、/ rg/ 是/ 通过/ 多次/ 试验/ 获得/ 的/ 较优/ 参数值/ ./ 后续/ 工作/ 中/ ,/ 本文/ 作者/ 将/ 研究/ 更加/ 鲁棒/ 的/ 平滑/ 约束/ 方法/ 和/ 处理/ 遮挡/ 对/ 深度/ 线索/ 的/ 影响/ ,/ 并/ 采用/ 基于/ 统计/ 学习/ 的/ 方法/ 自/ 适应/ 地/ 学习/ 相关/ 参数值/ ./ 

