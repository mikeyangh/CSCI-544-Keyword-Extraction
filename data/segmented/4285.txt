Page1/ 基于/ 切向/ 约束/ 构造/ 复合/ 二次/ B/ 样条/ 插值/ 曲线/ 于谦/ 1/ )/ 李缨/ 1/ )/ 张彩明/ 2/ )/ 1/ )/ (/ 山东/ 女子/ 学院/ 信息技术/ 学院/ 济南/ 255000/ )/ 2/ )/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250100/ )/ 摘要/ 该文/ 提出/ 一种/ 构造/ 二次/ B/ 样条/ 插值/ 曲线/ 的/ 新/ 方法/ ,/ 包括/ 新/ 的/ 参数/ 化/ 方法/ 和/ 新/ 的/ 插值/ 方法/ ./ 新/ 参数/ 化/ 方法/ 中/ ,/ 相邻/ 曲线/ 段/ 的/ 连接处/ 与/ 插值/ 点/ 相一致/ ,/ 以/ 插值/ 点/ 的/ 切/ 向/ 作为/ 约束/ ,/ 利用/ 二次/ B/ 样条/ 曲线/ 本身/ 的/ 几何/ 性质/ 进行/ 参数/ 化/ ,/ 使/ 曲线/ 在/ 每个/ 插值/ 点上/ 都/ 满足/ 指定/ 的/ 切/ 向/ ,/ 可以/ 直观/ 地/ 控制/ 插值/ 曲线/ 的/ 形状/ 以/ 达到/ 预期/ 效果/ ,/ 参数/ 化/ 方法/ 稳定/ ,/ 不必/ 解/ 方程组/ ./ 在/ 新/ 参数/ 化/ 方法/ 的/ 基础/ 上/ 进一步/ 提出/ 了/ 分段/ 构造/ 的/ 思想/ ,/ 将/ 形状/ 不好/ 的/ 段/ 分成/ 多/ 段/ 构造/ ,/ 除/ 插值/ 点/ 的/ 切/ 向/ 外/ 还/ 留有/ 其他/ 的/ 自由度/ 进一步/ 直观/ 调控/ 曲线/ 的/ 形状/ ,/ 使得/ 二次/ B/ 样条/ 插值/ 曲线/ 的/ 形状/ 更/ 自然/ ./ 新/ 方法/ 对于/ 数据/ 点/ 的/ 改变/ 具有/ 良好/ 的/ 局部性/ ./ 实例/ 表明/ 该/ 方法/ 是/ 有效/ 的/ ./ 关键词/ 插值/ ;/ 参数/ 化/ ;/ B/ 样条/ 曲线/ ;/ 插值/ 点/ ;/ 曲线/ 1/ 引言/ B/ 样条/ 是/ 计算机辅助/ 几何/ 设计/ 中/ 曲线/ 插值/ 的/ 常/ Page2/ 造/ 过程/ ./ 其中/ ,/ 参数/ 化/ 的/ 目的/ 是/ 为/ 每/ 一个/ 插值/ 点/ 指定/ 一个/ 具体/ 的/ 参数值/ ,/ 不同/ 的/ 参数/ 化/ 方法/ 得到/ 的/ 参数值/ 不同/ ./ 当/ 节点/ 向量/ 的/ 选取/ 与/ 参数/ 化/ 相一致/ 时/ ,/ 构成/ 整条/ 插值/ 曲线/ 的/ 各/ 曲线/ 段/ 在/ 整/ 节点/ 处/ 连接/ ,/ 插值/ 点正/ 位于/ 连接处/ ./ 若/ 两者/ 不/ 一致/ ,/ 即/ 各/ 曲线/ 段/ 的/ 连接处/ 未取/ 在/ 整/ 节点/ 上/ ,/ 则/ 插值/ 点/ 各自/ 位于/ 一段/ 曲线/ 内/ ,/ 不会/ 正好/ 处在/ 两/ 相邻/ 段/ 之间/ ./ 节点/ 向量/ 的/ 选取/ 与/ 参数/ 化/ 相一致/ 在/ 构造/ 奇次/ B/ 样条/ 插值/ 曲线/ 时有/ 非常/ 好/ 的/ 效果/ ,/ 但/ 并/ 不适/ 用于/ 偶次/ [/ 1/ -/ 2/ ]/ ./ 因此/ 大量/ 关于/ 偶次/ B/ 样条/ 插值/ 曲线/ 的/ 研究/ 集中/ 在/ 不/ 一致/ 的/ 情况/ [/ 3/ -/ 8/ ]/ ,/ 分别/ 采用/ 均匀/ 、/ 向心/ 、/ 二次/ 精度/ [/ 9/ ]/ 、/ Foley/ 等/ 参数/ 化/ 方法/ 将/ 相邻/ 曲线/ 段/ 的/ 连接处/ 取在/ 非整/ 节点/ 上/ ,/ 获得/ 了/ 较/ 好/ 的/ 曲线/ 形状/ ./ 这些/ 方法/ 都/ 是从/ 整体/ 上/ 一次性/ 确定/ 所有/ 的/ 节点/ 值/ ,/ 插值/ 完成/ 后/ 曲线/ 形状/ 不可/ 调/ ,/ 变动/ 局部/ 插值/ 点时/ 曲线/ 整体/ 形状/ 变化/ 较大/ ,/ 在/ 工程/ 应用/ 中/ 受到/ 了/ 限制/ ./ 针对/ 这些/ 不足/ ,/ 潘日晶/ [/ 10/ ]/ 在/ 允许/ 节点/ 向量/ 的/ 选取/ 与/ 参数/ 化/ 不/ 一致/ 的/ 情况/ 下/ ,/ 在/ 二次/ B/ 样条/ 插值/ 过程/ 中/ 递推/ 确定/ 节点/ 值/ ,/ 并/ 充分利用/ 节点/ 向量/ 的/ 自由度/ 调整/ 曲线/ 的/ 形状/ ,/ 同时/ 使/ 曲线/ 的/ 局部性/ 较/ 好/ ./ 但/ 该/ 方法/ 对切/ 矢/ 方向/ 限制/ 过于/ 严格/ ,/ 而且/ 节点/ 向量/ 作为/ 自由度/ 没有/ 固定/ 的/ 通用/ 取值/ ,/ 在/ 一定/ 程度/ 上/ 给/ 用户/ 带来/ 了/ 操作/ 上/ 的/ 不便/ ./ 上述/ 方法/ 都/ 是/ 在/ 节点/ 向量/ 与/ 参数/ 化/ 不/ 一致/ 的/ 情况/ 下/ 构造/ 偶次/ B/ 样条/ 插值/ 曲线/ ,/ 但/ 这/ 并/ 不/ 代表/ 相一致/ 时/ 就/ 不能/ 有/ 好/ 的/ 结果/ ,/ 只要/ 节点/ 选取/ 恰当/ 、/ 选用/ 合适/ 的/ 插值/ 方法/ 偶次/ B/ 样条/ 一样/ 能/ 具有/ 数据/ 点/ 所/ 建议/ 的/ 形状/ ./ Piegl/ 等/ 人/ [/ 11/ ]/ 就/ 做到/ 了/ 这/ 一点/ ,/ 在/ 参数/ 化/ 的/ 过程/ 中/ 利用/ 二次/ B/ 样条/ 曲线/ 的/ 几何/ 性质/ 引入/ 了/ 切/ 向/ 约束/ ,/ 给出/ 了/ 节点/ 向量/ 的/ 确定/ 取值/ ,/ 在/ 需要/ 拐点/ 时/ 就/ 将/ 含有/ 拐点/ 的/ 曲线/ 段/ 分成/ 两/ 部分/ 构造/ ,/ 得到/ 的/ 曲线/ 在/ 数据/ 点较/ 均匀/ 弯度/ 较/ 小时/ 形状/ 自然/ ./ 不足之处/ 是/ 所/ 得到/ 的/ 节点/ 值易/ 重复/ ,/ 会/ 造成/ 曲线/ 的/ 断开/ ,/ 调整/ 形状/ 的/ 自由度/ 与/ 拐点/ 同时/ 存在/ ,/ 而/ 改变/ 自由度/ 的/ 同时/ 拐点/ 也/ 会/ 发生/ 不可/ 预期/ 的/ 变化/ ,/ 形状/ 不易/ 掌控/ ./ 潘日晶/ [/ 12/ ]/ 也/ 在/ 节点/ 向量/ 与/ 参数/ 化/ 相一致/ 的/ 情况/ 下/ 通过/ 指定/ 曲线/ 段/ 相对/ 于/ 所在/ 弦/ 的/ 高度/ 来/ 确定/ 节点/ 值/ ,/ 能/ 获得/ 令人满意/ 的/ 结果/ ,/ 但/ 相对高度/ 的/ 获取/ 在/ 工程/ 上/ 并/ 不/ 容易/ ,/ 因此/ 限定/ 了/ 该/ 方法/ 的/ 应用/ 范围/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 在/ 节点/ 向量/ 的/ 取值/ 与/ 参数/ 化/ 相一致/ 的/ 情况/ 下/ 提出/ 构造/ 二次/ B/ 样条/ 插值/ 曲线/ 的/ 新/ 方法/ ./ 鉴于/ 节点/ 向量/ 与/ 曲线/ 的/ 几何/ 形状/ 之间/ 的/ 密切联系/ ,/ 本文/ 将/ 曲线/ 自身/ 的/ 几何/ 性质/ 考虑/ 到/ 参数/ 化中/ ,/ 利用/ 切矢/ 作为/ 约束/ 递/ 推出/ 节点/ 向量/ ,/ 所/ 产生/ 的/ 节点/ 值/ 不会/ 有/ 重复/ ,/ 节点/ 间/ 的/ 间隔/ 不会/ 很大/ ,/ 而且/ 节点/ 间隔/ 的/ 大小/ 与/ 插值/ 点间/ 的/ 弯度/ 变化/ 相一致/ ,/ 若用/ 粒子/ 的/ 运动/ 模拟/ 参数/ 化/ ,/ 则/ 当/ 路线/ 弯度/ 越/ 小时/ 粒子/ 经过/ 的/ 时间/ 就/ 越短/ ./ 当/ 满足/ 切矢/ 约束/ 所/ 得到/ 的/ 曲线/ 段/ 相对高度/ 过高/ 或切/ 矢/ 建议/ 需要/ 拐点/ 时/ 就/ 将/ 曲线/ 段/ 分成/ 多/ 段/ 插值/ ,/ 称为/ 复合/ 二次/ B/ 样条/ 曲线/ ,/ 所得/ 的/ 曲线/ 既/ 满足/ 于切/ 矢/ 约束/ 又/ 不/ 受切/ 矢/ 方向/ 限制/ ,/ 在/ 构造/ 过程/ 中/ 留有/ 用来/ 调整/ 形状/ 的/ 自由度/ ,/ 拐点/ 位置/ 不随/ 自由度/ 变化/ ,/ 调整/ 后/ 的/ 曲线/ 形状/ 可/ 预期/ ,/ 而且/ 给定/ 自由度/ 的/ 通用/ 取值/ ,/ 便于/ 工程/ 上/ 使用/ ./ 实验/ 结果表明/ 了/ 新/ 的/ 参数/ 化/ 方法/ 和/ 插值/ 方法/ 的/ 有效性/ ./ 2/ 问题/ 描述/ 利用/ 二次/ B/ 样条/ 插值/ 曲线/ 对/ 插值/ 点/ 序列/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ 进行/ 插值/ ./ 本文/ 考虑/ 的/ 是/ 插值/ 点/ 位于/ 各/ 相邻/ 曲线/ 段/ 连接处/ 的/ 情况/ ,/ n/ 个/ 插值/ 点/ 共有/ n/ -/ 1/ 段/ 曲线/ ,/ 令/ 犜/ =/ t0/ ,/ t1/ ,/ …/ ,/ tn/ {/ D0/ ,/ D1/ ,/ …/ ,/ Dn/ ,/ 插值/ 曲线/ 表示/ 为/ 并/ 有/ C/ (/ ti/ +/ 1/ )/ =/ Pi/ ,/ i/ =/ 1/ ,/ …/ ,/ n/ (/ 2/ )/ 成立/ ./ 其中/ Bi/ ,/ 3/ (/ t/ )/ 是/ 规范/ 二次/ B/ 样条/ 基/ 函数/ ,/ t0/ / t1/ / …/ / tn/ +/ 3/ ./ 基于/ 二次/ B/ 样条/ 曲线/ 与/ 控制/ 多边形/ 相切/ 故/ 将/ 曲线/ 在/ Pi/ 处/ 的/ 单位/ 切矢/ 犞/ i/ 考虑/ 在内/ ,/ 以便/ 利用/ 犞/ i/ 调整/ 曲线/ 形状/ ,/ 因此/ 令/ C/ (/ ti/ +/ 1/ )/ // |/ C/ (/ ti/ +/ 1/ )/ |/ =/ 犞/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ n/ (/ 3/ )/ 若/ 工程/ 上/ 不能/ 直接/ 获取/ 犞/ i/ ,/ 则/ 由/ Akima/ [/ 13/ ]/ 方法/ 进行/ 估计/ ./ 本文/ 的/ 目标/ 是/ 在/ 满足/ 式/ (/ 2/ )/ 和/ 式/ (/ 3/ )/ 的/ 前提/ 下求/ 出/ 犜/ 和/ 控制点/ 序列/ ./ 为/ 讨论/ 方便/ ,/ 令/ 所求/ 曲线/ 为/ 端点/ 插值/ ,/ 即/ D0/ =/ P1/ ,/ Dn/ =/ Pn/ ,/ t0/ =/ t1/ =/ t2/ ,/ tn/ +/ 1/ =/ tn/ +/ 2/ =/ tn/ +/ 3.3/ 基于/ 切向/ 约束/ 构造/ 复合/ 二次/ B/ 样条/ 插值/ 曲线/ 3.1/ 二次/ B/ 样条/ 曲线/ 相关/ 概念/ 与/ 公式/ 对应/ 节点/ 段/ [/ ti/ ,/ ti/ +/ 1/ ]/ ,/ i/ =/ 2/ ,/ …/ ,/ n/ ./ 令/ S/ (/ Pi/ -/ 1Pi/ )/ 表示/ 弦/ Pi/ -/ 1Pi/ 所/ 对应/ 的/ 曲线/ 段/ ,/ 定义/ 1/ ./ 肩点/ ./ 若/ S/ (/ Pi/ -/ 1Pi/ )/ 不是/ 线段/ ,/ 则/ 称/ 其/ 上/ 离弦/ Pi/ -/ 1Pi/ 最远/ 的/ 点/ 为/ 肩点/ ./ 根据/ 二次/ B/ 样条/ 曲线/ 段/ 与/ 控制/ 多边形/ 相切/ 的/ 性质/ 可知/ S/ (/ Pi/ -/ 1Pi/ )/ 与/ Pi/ -/ 1Pi/ 形成/ 位于/ △/ Pi/ -/ 1Di/ -/ 1Pi/ 内/ 的/ 三角/ 凸包/ (/ 图/ 1/ )/ ,/ 由/ Li/ 等/ 人/ [/ 14/ ]/ 的/ 研究/ 知/ Page3S/ (/ Pi/ -/ 1Pi/ )/ 上/ 的/ 肩点/ 唯一/ 且/ 其/ 切线/ 平行/ 于/ Pi/ -/ 1Pi/ ,/ 设肩点/ 对应/ 的/ 参数值/ 为/ t/ -/ ,/ 可知/ 以下/ 引理/ ./ 引理/ 1/ ./ 设/ P/ 是/ [/ ti/ ,/ ti/ +/ 1/ ]/ 段/ 肩点/ ,/ 则/ C/ (/ t/ -/ )/ =/ Cti/ +/ ti/ +/ 1/ (/ )/ 2/ ./ 证明/ ./ C/ (/ t/ )/ 表示/ 导数/ 曲线/ ,/ ×/ 表示/ 叉/ 乘/ ,/ 由/ 潘日晶/ [/ 12/ ]/ 的/ 研究/ 知/ Pi/ -/ 1/ =/ C/ (/ ti/ )/ =/ ti/ +/ 1/ -/ titi/ +/ 1/ -/ ti/ -/ 1Di/ -/ 2/ +/ ti/ -/ ti/ -/ 1ti/ +/ 1/ -/ ti/ -/ 1Di/ -/ 1C/ (/ t/ )/ =/ 2/ 由/ 肩点/ 性质/ 可得/ 即/ c/ (/ t/ -/ )/ ×/ [/ c/ (/ ti/ +/ 1/ )/ -/ c/ (/ ti/ )/ ]/ =/ 0/ ,/ 式/ (/ 4/ )/ ~/ (/ 6/ )/ 共/ 推出/ (/ 2t/ -/ -/ ti/ -/ ti/ +/ 1/ )/ (/ Di/ -/ Di/ -/ 1/ )/ ×/ (/ Di/ -/ 1/ -/ Di/ -/ 2/ )/ =/ 0/ ,/ 由/ S/ (/ Pi/ -/ 1Pi/ )/ 与/ Pi/ -/ 1Pi/ 形成/ 三角/ 凸/ 包知/ Di/ -/ 2Di/ -/ 1Di/ 不/ 共线/ ,/ 所以/ t/ -/ =/ (/ ti/ +/ ti/ +/ 1/ )/ // 2/ ./ 引理/ 2/ ./ 若/ Q/ 是/ 弦/ Pi/ -/ 1Pi/ 的/ 中点/ ,/ 则/ 肩点/ P/ 是/ 线段/ Di/ -/ 1Q/ 的/ 中点/ (/ 图/ 1/ )/ ./ 证明/ ./ 由式/ (/ 1/ )/ 和/ B/ 样条/ 曲线/ 及基/ 函数/ 的/ 性质/ 可得/ C/ (/ t/ )/ =/ Di/ -/ 2Ni/ -/ 2/ ,/ 2/ (/ t/ )/ +/ Di/ -/ 1Ni/ -/ 1/ ,/ 2/ (/ t/ )/ +/ DiNi/ ,/ 2/ (/ t/ )/ 其中/ t/ ∈/ [/ ti/ ,/ ti/ +/ 1/ ]/ ./ 由/ 引理/ 1/ 及式/ (/ 4/ )/ 、/ (/ 7/ )/ 可得/ P/ =/ C/ (/ t/ -/ )/ =/ 0.5/ [/ (/ Pi/ -/ 1/ +/ Pi/ )/ // 2/ +/ Di/ -/ 1/ ]/ (/ 8/ )/ 故/ 命题/ 成立/ ./ 引理/ 3/ ./ 若/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 四点/ 共线/ ,/ 则/ [/ ti/ ,/ ti/ +/ 1/ ]/ 段/ 曲线/ 必为/ 线段/ ./ 证明/ ./ 由/ B/ 样条/ 曲线/ 的/ 凸/ 包性/ 可知/ [/ ti/ ,/ ti/ +/ 1/ ]/ 上/ 的/ 曲线/ 段必/ 位于/ △/ Pi/ -/ 1Di/ -/ 1Pi/ 内/ ,/ 而/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 共线/ ,/ 所以/ 该段/ 曲线/ 必为/ 线段/ ./ 证毕/ ./ ti/ +/ 1/ =/ ti/ +/ (/ Di/ -/ 1Pi/ -/ →/ / / / 1/ +/ Di/ -/ 1P/ →/ / / / i/ )/ ×/ Pi/ -/ 1P/ →/ / / / i/ 证明/ ./ 由式/ (/ 7/ )/ 和/ 引理/ 2/ 可得/ 0.25/ (/ Pi/ -/ 1/ +/ Pi/ )/ +/ 0.5/ Di/ -/ 1/ =/ 由基/ 函数/ 的/ 性质/ 上式/ 可/ 表示/ 为/ Di/ -/ 2Ni/ -/ 2/ ,/ 2/ (/ t/ -/ )/ +/ Di/ -/ 1Ni/ -/ 1/ ,/ 2/ (/ t/ -/ )/ +/ DiNi/ ,/ 2/ (/ t/ -/ )/ ./ 引理/ 4/ ./ 当/ [/ ti/ ,/ ti/ +/ 1/ ]/ 段/ 曲线/ 不是/ 线段/ 时/ ,/ Di/ -/ 2/ -/ Di/ -/ 1ti/ +/ 1/ -/ ti/ -/ 1/ +/ Di/ -/ Di/ -/ 1ti/ +/ 2/ -/ ti/ =/ Pi/ -/ 1/ -/ Di/ -/ 1/ +/ Pi/ -/ Di/ -/ 1ti/ +/ 1/ -/ ti/ ./ 两边/ 同时/ 叉/ 乘/ (/ Pi/ -/ Pi/ -/ 1/ )/ :/ (/ Di/ -/ 2/ -/ Di/ -/ 1/ )/ ×/ (/ Pi/ -/ Pi/ -/ 1/ )/ (/ Di/ -/ Di/ -/ 1/ )/ ×/ (/ Pi/ -/ Pi/ -/ 1/ )/ (/ Pi/ -/ 1/ -/ Di/ -/ 1/ +/ Pi/ -/ Di/ -/ 1/ )/ ×/ (/ Pi/ -/ Pi/ -/ 1/ )/ 又/ 由式/ (/ 7/ )/ 和/ 式/ (/ 4/ )/ 得/ 由式/ (/ 9/ )/ 和/ 式/ (/ 10/ )/ 可/ 推出/ 由/ 引理/ 3/ 知若/ 该段/ 曲线/ 不是/ 线段/ ,/ 则/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 四点/ 必/ 不/ 共线/ ,/ 故式/ (/ 11/ )/ 整理/ 为/ ti/ +/ 1/ =/ ti/ +/ (/ Di/ -/ 1Pi/ -/ →/ / / / 1/ +/ Di/ -/ 1P/ →/ / / / i/ )/ ×/ Pi/ -/ 1P/ →/ / / / i3/ ./ 2/ 基于/ 切向/ 约束/ 的/ 参数/ 化/ 方法/ 本/ 小节/ 中先/ 对/ 插值/ 点/ 的/ 单位/ 切矢/ 做出/ 约束/ 以便/ 选取/ 控制点/ ,/ 然后/ 在/ 3.3/ 节中/ 去掉/ 这些/ 约束/ ./ 约束/ 的/ 内容/ 及/ 控制点/ 的/ 选法/ 与/ 潘日晶/ [/ 12/ ]/ 的/ 方法/ 相同/ ./ 如图/ 2/ ,/ 令/ α/ 表示/ 犞/ i/ -/ 1/ 与/ Pi/ -/ 1P/ →/ / / / i/ 的/ 夹角/ ,/ θ/ 表示/ 犞/ i/ 与/ Pi/ -/ 1P/ →/ / / / i/ 的/ 夹角/ ,/ 0/ / α/ ,/ θ/ </ π/ (/ 本文/ 中/ 所有/ 角度/ 均/ 属于/ [/ 0/ ,/ π/ )/ )/ ./ 规定/ :/ α/ =/ 0/ / θ/ =/ 0/ ,/ or/ 烅/ 烄/ (/ 犞/ i/ -/ 1/ ×/ Pi/ -/ 1P/ →/ / / / i/ )/ (/ 犞/ i/ ×/ Pi/ -/ 1P/ →/ / / / i/ )/ </ 0and/ θ/ </ π/ -/ 烆/ 式/ (/ 12/ )/ 表明/ 如果/ 犞/ i/ -/ 1/ 平行/ 于/ Pi/ -/ 1P/ →/ / / / i/ ,/ 则/ 犞/ i/ 也/ 必/ 与/ 之/ 平行/ ,/ 否则/ 两切/ 矢/ 分别/ 指向/ Pi/ -/ 1P/ →/ / / / i/ 的/ 两侧/ 且/ 相交/ 于/ 犞/ i/ -/ 1/ 所/ 指向/ 的/ 一侧/ ./ 基于/ 式/ (/ 12/ )/ 将/ 控制点/ D0/ ,/ D1/ ,/ …/ ,/ Page4Dn/ 取/ 为/ 烅/ 烄/ Di/ =/ 烆/ 直线/ li/ 以/ 犞/ i/ 为/ 方向/ 过/ Pi/ 点/ ./ 此处/ 控制点/ 满足/ 式/ (/ 3/ )/ 条件/ ,/ 保证/ 了/ Pi/ 位于/ Di/ -/ 1Di/ 上/ ,/ 而且/ 只要/ Di/ -/ 2Pi/ -/ 1Pi/ 共线/ 必有/ Pi/ -/ 1Di/ -/ 1Pi/ 共线/ ,/ 即/ Di/ -/ 2Pi/ -/ 1Di/ -/ 1Pi/ 共线/ (/ 图/ 3/ )/ ./ 图/ 3/ 箭头/ 是/ 各点/ 单位/ 切矢/ ,/ 圆点/ 是/ 控制点/ ,/ 十字/ 是/ 插值/ 点/ 确定/ 控制点/ 后/ 定义/ 节点/ 向量/ 犜/ :/ t0/ =/ t1/ =/ t2/ =/ 0/ ,/ t3/ =/ P1P/ →/ / / 2/ ,/ 烄/ ti/ +/ 1/ =/ ti/ +/ ki/ (/ ti/ -/ ti/ -/ 1/ )/ ,/ (/ a/ )/ 烅/ ti/ +/ 1/ =/ ti/ +/ λ/ i1/ -/ λ/ i/ 烆/ tn/ +/ 1/ =/ tn/ +/ 2/ =/ tn/ +/ 3/ 当/ Di/ -/ 2Pi/ -/ 1Di/ -/ 1Pi/ 不/ 共线/ 时/ ti/ +/ 1/ 按式/ (/ 14/ (/ a/ )/ )/ 取值/ ,/ ki/ =/ (/ Di/ -/ 1Pi/ →/ / / / / -/ 1/ +/ Di/ -/ 1P/ →/ / / / i/ )/ ×/ Pi/ -/ 1P/ →/ / / / i/ (/ Pi/ -/ 1Di/ →/ / / / / -/ 2/ +/ PiDi/ →/ / / / -/ 2/ )/ ×/ Pi/ -/ 1P/ →/ / / / i/ (/ 14/ (/ a/ )/ )/ 满足/ 式/ (/ 4/ )/ 即/ 条件/ 式/ (/ 2/ )/ 的/ 约束/ ;/ 当/ 此/ 四点/ 共线/ 时/ 按式/ (/ 14/ (/ b/ )/ )/ 取值/ ,/ λ/ i/ =/ 0.5/ |/ Pi/ -/ 1P/ →/ / / / i/ |/ // |/ Di/ -/ 2Di/ →/ / / / / -/ 1/ |/ ,/ 下面/ 证明/ 式/ (/ 14/ (/ b/ )/ )/ 也/ 满足/ 式/ (/ 2/ )/ 约束/ ./ 证明/ ./ 由/ 引理/ 3/ 及式/ (/ 12/ )/ 、/ (/ 13/ )/ 知/ 此时/ S/ (/ Pi/ -/ 1Pi/ )/ 为/ 线段/ (/ 图/ 3/ )/ ,/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 与/ 弦/ 平行/ 且/ Di/ -/ 1/ =/ (/ Pi/ -/ 1/ +/ Pi/ )/ // 2/ ,/ 因此/ 式/ (/ 14/ (/ b/ )/ )/ 变为/ 其中/ ,/ ai/ =/ |/ Pi/ -/ 1Di/ →/ / / / / -/ 1/ |/ // |/ Di/ -/ 2Di/ →/ / / / / -/ 1/ |/ ./ 而由式/ (/ 4/ )/ 可得/ ti/ +/ 1/ -/ titi/ +/ 1/ -/ ti/ -/ 1Pi/ -/ 1/ -/ Di/ -/ 1/ ,/ 由/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 共线/ ,/ 等式/ 两边/ 同时/ 点/ 乘/ (/ Di/ -/ 2/ -/ Di/ -/ 1/ )/ 可得/ ti/ +/ 1/ -/ titi/ +/ 1/ -/ ti/ -/ 1/ |/ Di/ -/ 2/ -/ Di/ -/ 1/ |/ =/ |/ Pi/ -/ 1/ -/ Di/ -/ 1/ |/ ,/ 整理/ 可得式/ (/ 15/ )/ ,/ 所以/ 式/ (/ 14/ (/ b/ )/ )/ 满足/ 式/ (/ 2/ )/ 约束/ ./ 将/ 犜/ 归/ 到/ [/ 0/ ,/ 1/ ]/ 后/ 取值/ 为/ {/ 0/ ,/ 0/ ,/ 0/ ,/ t3tn/ +/ 1/ 下面/ 是/ 该/ 节点/ 向量/ 所/ 具有/ 的/ 性质/ 和/ 相关/ 概念/ ./ 性质/ 1/ ./ 无重/ 节点/ 且/ 相邻/ 节点/ 值/ 相差/ 不会/ 非常/ 大/ ./ 定义/ 2/ ./ 弯度/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 分别/ 是/ Pi/ -/ 1/ 和/ Pi/ 的/ 切矢/ ,/ 称/ 两切/ 矢间/ 的/ 夹角/ α/ 为/ Pi/ -/ 1/ 和/ Pi/ 间/ 的/ 弯度/ ./ 性质/ 2/ ./ α/ 是/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 间/ 夹角/ ,/ 当/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 不/ 共线/ 时/ α/ 越小/ ki/ 越小/ ,/ 即/ 弯度/ 越小/ 时间/ 越短/ ./ 由式/ (/ 12/ )/ 和/ 式/ (/ 13/ )/ 可知/ 控制点/ 与/ 插值/ 点间/ 的/ 位置/ 关系/ 如图/ 3/ ,/ 当/ 犞/ i/ -/ 1/ 与/ Pi/ -/ 1Pi/ 不/ 平行/ 时必/ 有/ △/ Pi/ -/ 1Di/ -/ 1Pi/ 而且/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 共线/ ,/ Di/ -/ 1/ 、/ Pi/ 、/ Di/ 共线/ ,/ 这是/ 证明/ 上述/ 两/ 性质/ 的/ 基础/ ./ 性质/ 1/ 证明/ ./ 当/ Di/ -/ 2/ 、/ Pi/ -/ 1/ 、/ Di/ -/ 1/ 、/ Pi/ 不/ 共线/ ,/ ti/ +/ 1/ 取式/ (/ 14/ )/ 中/ 的/ 式/ (/ a/ )/ ./ 观察/ 图/ 4/ (/ a/ )/ ,/ 令/ 犜/ 1/ =/ Di/ -/ 1Pi/ →/ / / / / -/ 1/ +/ Di/ -/ 1P/ →/ / / / i/ ,/ 犜/ 2/ =/ Pi/ -/ 1Di/ →/ / / / / -/ 2/ +/ PiDi/ →/ / / / -/ 2/ ,/ 犜/ 1/ 和/ 犜/ 2/ 指向/ Pi/ -/ 1P/ →/ / / / i/ 同侧/ ,/ 故/ ki/ >/ 0/ ,/ 节点/ 值/ 递增/ ./ 继续/ 证明/ ki/ 取值/ 不会/ 非常/ 大/ ./ θ/ 1/ 是/ 犜/ 1/ 与/ Pi/ -/ 1P/ →/ / / / i/ 夹角/ ,/ π/ -/ θ/ 2/ 是/ 犜/ 2/ 与/ Pi/ -/ 1P/ →/ / / / i/ 夹角/ ,/ 则/ ki/ =/ |/ 犜/ 1/ |/ sin/ θ/ 1Pi/ -/ 1Pi/ 分别/ 在/ △/ Pi/ -/ 1Di/ -/ 1Pi/ 和/ △/ Di/ -/ 2Pi/ -/ 1Pi/ 上/ 的/ 高/ ./ 保持/ 犞/ i/ -/ 2/ 和/ 犞/ i/ 不变/ ,/ 需将/ 犞/ i/ -/ 1/ 逆时针/ 旋转/ 才能/ 令/ h2/ 变小/ ,/ 其/ 极限/ 位置/ 是/ 直线/ L1/ 处/ (/ 与/ 犞/ i/ 平行/ )/ ,/ 否则/ 便/ 违背/ 约束/ ,/ 设/ L2/ 是/ 过/ Pi/ -/ 2/ 与/ 犞/ i/ -/ 2/ 同向/ 的/ 直线/ ,/ 令/ d/ 表示/ L1L2/ 交点/ 到/ Pi/ -/ 1Pi/ 的/ 距离/ ,/ 则/ h2/ >/ d/ >/ 0/ ,/ 如果/ d/ 非常/ 小/ ,/ 则/ h1/ 也/ 不会/ 很大/ ,/ 故/ ki/ 的/ 分子/ 与/ 分母/ 之差/ 不会/ 过大/ ;/ 观察/ 图/ 4/ (/ b/ )/ ,/ 将/ 犞/ i/ -/ 1/ 顺时针/ 旋转/ 会/ 使/ h2/ 变小/ ,/ |/ Di/ -/ 1P/ →/ / / / i/ |/ 随之/ 变小/ ,/ 故/ h1/ 也/ 会/ 相应/ 变小/ ,/ 所以/ ki/ 的/ 取值/ 仍然/ 不会/ 非常/ 大/ ,/ 性质/ 成立/ ./ 四点/ 共线/ 的/ 情况/ 证明/ 略/ ./ Page5/ 性质/ 2/ 证明/ ./ 观察/ 图/ 4/ (/ b/ )/ ,/ 在/ 曲线/ S/ (/ Pi/ -/ 1Pi/ )/ 段/ 上/ ,/ 插值/ 点/ 保持/ 不变/ ,/ 通过/ 调整/ 犞/ i/ 来/ 改变/ 弯度/ ./ 若/ 逆时针/ 旋转/ 犞/ i/ 则/ α/ 会/ 减小/ ,/ ∠/ Pi/ -/ 1Di/ -/ 1Pi/ 增大/ ,/ 即/ Pi/ -/ 1/ 和/ Pi/ 之间/ 的/ 弯度/ 减小/ ,/ 同时/ |/ Di/ -/ 1Pi/ →/ / / / / -/ 1/ |/ 也/ 随之/ 减小/ ,/ 而/ ∠/ Di/ -/ 1Pi/ -/ 1Pi/ 不变/ ,/ 故/ h1/ 变小/ ,/ 即/ ki/ 变小/ ,/ 表明/ 粒子/ 在/ 弯度/ 越/ 小/ 的/ 两点/ 之间/ 经过/ 时/ 速度/ 越快/ ./ 3.3/ 构造/ 复合/ 二次/ B/ 样条/ 曲线/ 3.2/ 节/ 参数/ 化时/ 对切/ 矢/ 的/ 方向/ 做/ 了/ 约束/ ,/ 而/ 现实/ 中/ 得到/ 的/ 切/ 矢/ 不/ 可能/ 都/ 符合/ 这种/ 约束/ ,/ 若想/ 该/ 参数/ 化/ 方法/ 得到/ 广泛应用/ 则/ 必须/ 在/ 曲线/ 插值/ 时/ 摆脱/ 角度/ 束缚/ ,/ 使得/ 对/ 任意/ 角度/ 的/ 切/ 矢/ 都/ 能/ 使用/ 新/ 方法/ 构造/ 插值/ 曲线/ ,/ 此处/ 我们/ 采用/ 动态/ 插入/ 新/ 插值/ 点/ 、/ 分多段/ 构造/ 的/ 方式/ 解决/ 这个/ 问题/ ,/ 把/ 不/ 符合/ 约束/ 的/ 段/ 分成/ 2/ ~/ 4/ 段/ 构造/ ,/ 以及/ 使切/ 矢/ 符合/ 约束/ 但/ 曲线/ 形状/ 不好/ 的/ 段/ 得到/ 优化/ ,/ 做到/ 在/ 不/ 增加/ 拐点/ 的/ 前提/ 下/ ,/ 使/ 得到/ 的/ 曲线/ 段数/ 尽可能少/ 、/ 相对高度/ 尽可能/ 小/ ./ 令/ α/ 表示/ 犞/ i/ -/ 1/ 和/ Pi/ -/ 1P/ →/ / / / i/ 间/ 夹角/ ,/ θ/ 表示/ 犞/ i/ 和/ 图/ 5Method0/ ~/ Method4/ 构造方法/ Method1/ ./ 当/ π/ // 3/ / α/ ∩/ θ/ </ π/ -/ α/ 时/ ,/ 切矢/ 符合/ 约束/ 但/ 形状/ 不好/ ,/ 如图/ 5/ (/ b/ )/ ,/ 与/ DQ/ 相交/ 的/ 曲线/ 段/ 相对高度/ 过高/ ,/ 通过/ 插入/ 一个/ 新/ 插值/ 点/ 利用/ 2/ -/ 分段/ 构造/ 来/ 降低/ 其/ 高度/ ./ 取/ △/ Pi/ -/ 1DPi/ 的/ 中线/ DP/ 上/ 的/ 点/ Q/ ,/ 令/ |/ QP/ |/ =/ γ/ i/ -/ 1/ |/ Pi/ -/ 1P/ →/ / / / i/ |/ ,/ γ/ i/ -/ 1/ 是/ 一种/ 自由度/ ,/ 用来/ 调整/ 新/ 曲线/ 相对/ 于/ 弦/ Pi/ -/ 1Pi/ 的/ 高度/ ,/ γ/ i/ -/ 1/ 越小/ 所得/ 曲线/ 段/ 越/ 偏平/ ,/ 我们/ 将/ 之/ 称为/ 形状/ 因子/ ,/ 根据/ 实验/ γ/ i/ -/ 1/ =/ 0.25/ 是/ 其/ 通用/ 值/ ./ 令/ 犞/ Q/ // // Pi/ -/ 1P/ →/ / / / i/ ,/ 直接/ 构造/ Pi/ -/ 1Q/ 和/ QPi/ 段/ ./ 图/ 5/ (/ c/ )/ 与/ 图/ 5/ (/ b/ )/ 情况/ 相同/ ,/ 其角/ 是/ 新/ 插值/ 点/ 的/ 单位/ 切矢/ ,/ 分成/ 以下/ 4/ 种/ 情况/ 6/ 种/ 方法/ (/ Method0/ ~/ Method5/ )/ 构造/ 多/ 段/ 曲线/ :/ 第/ 1/ 种/ 情况/ ./ 相邻/ 切矢/ 符合/ 约束条件/ ./ Method0/ ./ 如图/ 5/ (/ a/ )/ ,/ 当/ 相邻/ 切矢/ 符合/ 约束条件/ 而且/ 曲线/ 段/ 不/ 需要/ 优化/ 时/ ,/ 该段/ 称为/ 理想/ 段/ ./ 曲线/ 段/ 是否/ 理想/ 由/ α/ 和/ θ/ 决定/ ,/ Yong/ 等/ 人/ [/ 15/ ]/ 曾/ 证明/ 当/ cos/ α/ >/ 1/ // 3/ 且/ cos/ θ/ >/ 1/ // 3/ 时/ 对/ {/ Pi/ -/ 1/ ,/ Pi/ ,/ 犞/ i/ -/ 1/ ,/ 犞/ i/ }/ 插值/ 的/ 三次/ Hermite/ 曲线/ 几何/ 最优/ ,/ 考虑/ 到切/ 矢/ 跟/ 二次/ B/ 样条/ 插值/ 曲线/ 之间/ 的/ 关系/ ,/ 此处/ 我们/ 参考/ 这一/ 结论/ ,/ 结合/ 实践/ 规定/ α/ </ π/ // 3/ ∩/ θ/ </ π/ // 3/ ,/ 符合/ 这/ 两个/ 角度/ 值/ 的/ 曲线/ 段/ 就/ 为/ 理想/ 段/ ,/ 直接/ 用式/ (/ 12/ )/ 求/ 控制点/ ,/ 用式/ (/ 13/ )/ 求/ 节点/ ,/ 无需/ 优化/ ./ 实验/ 表明/ π/ // 3/ 可/ 满足/ 一般/ 工程/ 上/ 的/ 应用/ ,/ 我们/ 将/ 其/ 定为/ α/ 和/ θ/ 的/ 通用/ 取值/ ,/ 称之为/ 理想/ 角度/ ./ 理想/ 角度/ 值/ 是/ 一种/ 自由度/ ,/ 在/ 实际/ 应用/ 中/ 可以/ 改变/ ,/ 进而/ 从/ 整体/ 上/ 调整/ 曲线/ 的/ 形状/ ,/ 其值/ 越/ 小/ 所/ 构造/ 的/ 曲线/ 整体/ 上越/ 扁平/ ./ 度/ 在/ α/ / π/ // 3/ ∩/ π/ // 3/ </ θ/ </ π/ -/ α/ 范围/ 内/ ./ 第/ 2/ 种/ 情况/ ./ 犞/ i/ -/ 1/ 和/ 犞/ i/ 指向/ Pi/ -/ 1Pi/ 两侧/ ,/ 但/ θ/ / π/ -/ α/ ,/ 不/ 符合/ 约束/ ./ Method2/ ./ θ/ =/ π/ -/ α/ ,/ 如图/ 5/ (/ d/ )/ 和/ (/ e/ )/ ,/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 平行/ 反向/ ,/ 仍用/ 2/ -/ 分段/ 构造/ ./ P/ 是/ Pi/ -/ 1Pi/ 中点/ ,/ 取新/ 插值/ 点/ Q1/ 令/ PQ/ →/ / / 1/ 与/ 犞/ i/ -/ 1/ 同向/ ,/ 且/ |/ PQ/ →/ / / 1/ |/ =/ γ/ i/ -/ 1/ |/ Pi/ -/ 1P/ →/ / / / i/ |/ ,/ 犞/ Q1/ 与/ Pi/ -/ 1P/ →/ / / / i/ 同向/ ./ 再/ 根据/ 犞/ Q1/ 与/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 的/ 方向/ 按照/ Method0/ 和/ Method1/ 调整/ Pi/ -/ 1Q1/ 和/ Q1Pi/ 段/ 的/ 形状/ ,/ 图/ 5/ (/ d/ )/ 中/ Q2/ 是/ 进一步/ 调整/ 的/ 结果/ ./ Page6Method3/ ./ 如图/ 5/ (/ f/ )/ 和/ (/ g/ )/ ,/ θ/ >/ π/ -/ α/ ./ Pi/ -/ 1Q1/ 平分/ α/ ,/ 若/ α/ / π/ // 3/ 平分/ 一次/ (/ 图/ 5/ (/ f/ )/ )/ ,/ 否则/ 平分/ 两次/ (/ 图/ 5/ (/ g/ )/ )/ ,/ 故/ ω/ / π/ // 4/ ,/ 令/ |/ Pi/ -/ 1Q/ →/ / / / 1/ |/ =/ γ/ i/ -/ 1/ |/ Pi/ -/ 1P/ →/ / / / i/ |/ ,/ 犞/ Q1/ 与/ Pi/ -/ 1P/ →/ / / / i/ 同向/ ,/ 再用/ Method0/ 和/ Method1/ 构造/ Q1/ 两边/ 的/ 段/ ,/ 整个/ S/ (/ Pi/ -/ 1Pi/ )/ 由/ 2/ -/ 分段/ 或/ 3/ -/ 分段/ 组成/ ./ 第/ 3/ 种/ 情况/ ./ 犞/ i/ -/ 1/ 或/ 犞/ i/ 平行/ 于/ Pi/ -/ 1Pi/ ./ Method4/ ./ 如图/ 5/ (/ h/ )/ 和/ (/ i/ )/ ,/ Q/ 是/ 新/ 插值/ 点/ ,/ D1/ 和/ D2/ 是/ 控制点/ ,/ 令/ D1/ =/ Pi/ -/ 1/ +/ 犞/ i/ -/ 1/ // 8/ ,/ D2/ =/ Pi/ -/ 犞/ i/ // 8/ 有/ Q/ =/ (/ D1/ +/ D2/ )/ // 2/ ,/ 犞/ QD1D/ →/ / / / 2/ ,/ 再用/ Method0/ 和/ Method1/ 构造/ 2/ -/ 分段/ ./ 第/ 4/ 种/ 情况/ ./ 犞/ i/ -/ 1/ 和/ 犞/ i/ 指向/ Pi/ -/ 1Pi/ 同侧/ ,/ 要/ 有/ 拐点/ 产生/ ,/ 用/ 3/ -/ 分段/ 或/ 4/ -/ 分段/ 构造/ ./ Method5/ ./ 如图/ 6/ ,/ 用/ Method3/ 的/ 方法/ 取/ Q1/ 和/ 犞/ Q1/ ,/ Pi/ -/ 1Q1/ 段/ 曲线/ 用/ Method0/ 和/ Method1/ 构造/ ./ Q2/ 是/ Pi/ -/ 1Pi/ 的/ 中点/ ,/ q/ 取自/ Q1Q2/ 延长线/ ,/ 由/ |/ Pi/ -/ 1Q/ →/ / / / 2/ |/ =/ 2/ |/ Pi/ -/ 1Q/ →/ / / / 1/ |/ 知/ ∠/ PiQ2q/ =/ ∠/ Q1Q2Pi/ -/ 1/ </ π/ // 6/ ,/ 作/ Q2q/ →/ / / 令/ ∠/ PiQ2q/ =/ ∠/ qQ2q/ ,/ 令/ 犞/ Q2/ 平分/ ∠/ qQ2q/ 以便/ 使/ 曲线/ 形状/ 更/ 自然/ ./ 用/ Method0/ 直接/ 构造/ S/ (/ Q1Q2/ )/ ,/ 而/ S/ (/ Q2Pi/ )/ 则/ 由/ 犞/ i/ 和/ 犞/ Q2/ 的/ 位置/ 关系/ 决定/ ,/ 从/ Method0/ ~/ Method4/ 中/ 根据/ 实际/ 情况/ 选择/ ,/ 整个/ S/ (/ Q1Pi/ )/ 段/ 在/ Q2/ 处/ 产生/ 拐点/ ./ 图/ 6Q1Q2/ 是/ 新/ 插入/ 的/ 点/ ,/ 黑色/ 箭头/ 是/ 其/ 单位/ 切矢图/ 7/ 为/ Method5/ 的/ 实例/ ./ 图/ 7/ (/ a/ )/ 和/ (/ b/ )/ 是/ 犞/ i/ -/ 1/ 犞/ i/ 的/ 情况/ ;/ 图/ 7/ (/ c/ )/ 和/ (/ d/ )/ 中/ ,/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 指向/ Pi/ -/ 1Pi/ 的/ 同侧/ 相交/ 于/ 另一侧/ ;/ 图/ 7/ (/ e/ )/ 和/ (/ f/ )/ 中/ ,/ 两切/ 矢/ 相交/ 的/ 一图/ 7Method5/ 犞/ i/ -/ 1/ 和/ 犞/ i/ 指向/ 弦/ 同侧/ ,/ Q1Q2Q3/ 为/ 新/ 插入/ 的/ 点侧/ 与其/ 指向/ 的/ 一侧/ 相同/ ./ 从图/ 7/ 可知/ ,/ 该/ 方法/ 中/ 拐点/ 位置/ 固定/ ,/ 用/ 自由度/ 调整/ 曲线/ 时/ 曲线/ 的/ 变化/ 是/ 可/ 预知/ 的/ ,/ 完全/ 弥补/ 了/ Piegl/ 方法/ 的/ 不足/ ./ 上述/ 6/ 种/ 方法/ 包含/ 了/ 切/ 矢/ 的/ 所有/ 角度/ ,/ 每/ 确定/ 一个/ 新/ 插值/ 点/ 和/ 单位/ 切矢/ ,/ 相应/ 的/ 控制点/ 也/ 被/ 求出/ ,/ 当/ 检测/ 完/ 所有/ 的/ 原始/ 插值/ 点后/ ,/ 控制点/ 序列/ 和/ 节点/ 向量/ 也/ 得以/ 确定/ ,/ 算法/ 1/ 描述/ 整个/ 过程/ ./ 算法/ 1/ ./ ComplexBspline/ (/ n/ ,/ P/ ,/ V/ )/ ./ 输入/ :/ 原/ 插值/ 点/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ ,/ 单位/ 切矢/ 犞/ 1/ ,/ 犞/ 2/ ,/ …/ ,/ 犞/ n/ 输出/ :/ 二次/ B/ 样条/ 插值/ 曲线/ {/ D0/ =/ P1/ ;/ FORi/ =/ 1TOn/ {/ α/ 是/ 犞/ i/ 与/ PiPi/ →/ / / / +/ 1/ 夹角/ ,/ θ/ 是/ 犞/ i/ +/ 1/ 与/ PiPi/ →/ / / / +/ 1/ 夹角/ ;/ }/ // // 然后/ 确定/ 节点/ 向量/ t0/ =/ t1/ =/ t2/ =/ 0/ ;/ t3/ =/ |/ P1P/ →/ / / 2/ |/ ;/ FORi/ =/ 3TOn/ {/ IF/ (/ Pi/ -/ 1Di/ →/ / / / -/ 2/ +/ PiDi/ →/ / / / -/ 2/ )/ ×/ Pi/ -/ 1P/ →/ / / / i/ ≠/ 0tn/ +/ 3/ =/ tn/ +/ 2/ =/ tn/ +/ 1/ ;/ }/ // // 算法/ 结束/ 4/ 实验/ 下面/ 分/ 各种/ 情况/ 给出/ 新/ 方法/ 的/ 实例/ ./ 工程/ 上/ 若/ 已知/ 插值/ 点/ 的/ 顺序/ 则/ 按/ 既定/ 顺序/ 插值/ ,/ 否则/ 按照/ 插值/ 点/ 的/ 坐标/ 从左到右/ 插值/ ,/ 对于/ 横坐标/ 相同/ 的/ 点/ ,/ 如图/ 8/ 所示/ ,/ B/ 与/ C/ 的/ 插值/ 顺序/ 取决于/ A/ ,/ 距/ A/ 近/ 的/ 点/ 先/ 插值/ ./ 图/ 8B/ 和/ C/ 纵坐标/ 相同/ ,/ 插值/ 的/ 顺序/ 取决于/ ABrodlie/ [/ 16/ ]/ 、/ Akima/ [/ 13/ ]/ 和/ Fritsch/ [/ 17/ ]/ 数据/ 是/ 插值/ Page7/ 曲线/ 研究/ 领域/ 内/ 的/ 经典/ 实验/ 数据/ ,/ 文献/ [/ 18/ ]/ 中/ 的/ B/ 样条/ (/ 我们/ 称为/ 传统/ 方法/ )/ 和/ Marsden/ [/ 4/ ]/ 的/ 二次/ 样条/ 是/ 构造/ 二次/ 插值/ 曲线/ 的/ 常用/ 方法/ ,/ 因此/ ,/ 我们/ 基于/ 经典/ 数据/ 在/ 例/ 1/ 中/ 把/ 新/ 方法/ 和/ 常用/ 方法/ 的/ 结果/ 进行/ 比较/ ,/ 同时/ 将/ Piegl/ 方法/ 也/ 应用/ 在/ 经典/ 数据/ 上/ 与/ 新/ 方法/ 进行/ 对比/ ./ 弯度/ 、/ 局部/ 可/ 调性/ 、/ 自由度/ 等/ 是/ 有效/ 展现/ 曲线/ 性能/ 的/ 几个/ 方面/ ,/ 我们/ 分别/ 在/ 例/ 2/ ~/ 例/ 5/ 将/ 本文/ 方法/ 和/ 潘日晶/ [/ 10/ ]/ 的/ 方法/ 以及/ Piegl/ 方法/ 就/ 这/ 几个/ 方面/ 进行/ 对比/ ./ 所有/ 实例/ 中/ 的/ 切/ 矢/ 皆/ 由/ Bessel/ 或/ Akima/ 方法/ 估计/ ,/ 新/ 方法/ 的/ 自由度/ 除例/ 5/ 外/ 都/ 取前/ 文所定/ 的/ 通用/ 值/ ,/ 例/ 2/ ~/ 例/ 5/ 的/ 数据/ 及/ 潘日晶/ 的/ 方法/ 的/ 图/ 皆/ 取自/ 文献/ [/ 10/ ]/ ./ 例/ 1/ ./ 经典/ 数据/ ./ Brodlie/ 数据/ ./ 观察/ 表/ 1/ ,/ P1/ 和/ 犜/ 1/ 分别/ 是/ 新/ 方法/ 的/ 插值/ 点/ 序列/ 和/ 节点/ 向量/ ,/ P2/ 和/ 犜/ 2/ 是/ Piegl/ 方法/ 的/ 表/ 1/ 插值/ 点/ 序列/ 及/ 对应/ 的/ 节点/ 向量/ 插值/ 点/ 与/ 节点/ 向量/ P1/ 犜/ 1P2/ 犜/ 20/ ,/ 0/ ,/ 0/ ,/ 0.01778/ ,/ 0.035493/ ,/ 0.053206/ ,/ 0.053206/ ,/ 0.053206/ ,/ 0.337109/ ,/ 0.635236/ ,/ 0.75245/ ,/ 0.868810/ ,/ 0.8929530/ ,/ 图/ 9Brodlie/ 数据/ ,/ 虚线/ 是/ 控制/ 多边形/ 图/ 10Akima/ 数据/ 插值/ 点/ 和/ 节点/ 向量/ ,/ 曲线/ 见图/ 9/ (/ a/ )/ 和/ (/ b/ )/ ./ 表中/ 加粗/ 表示/ 的/ 是/ 原始/ 插值/ 点/ ,/ 共/ 11/ 个/ ./ 新/ 方法/ 所/ 产生/ 的/ 新/ 插值/ 点较/ Piegl/ 方法/ 要/ 多/ ,/ 但/ 节点/ 值/ 均匀/ 递增/ ,/ 而/ 犜/ 2/ 中有/ 重/ 节点/ ,/ 导致/ 曲线/ 断开/ ,/ 同时/ 弯度/ 较大/ 时/ Piegl/ 曲线/ 出现/ 交叉/ 现象/ ./ 在/ P2/ 和/ 控制点/ 序列/ 确定/ 以后/ ,/ 将/ Piegl/ 方法/ 倒序/ 插值/ ,/ 得到/ 图/ (/ c/ )/ ,/ 可以/ 看出/ 不同于/ 图/ (/ b/ )/ ,/ 而/ 将/ 新/ 方法/ 在/ P1/ 上/ 倒序/ 插值/ 得到/ 的/ 结果/ 与/ (/ a/ )/ 完全相同/ ,/ 在/ 本文/ 所有/ 实例/ 中/ ,/ 新/ 方法/ 的/ 倒序/ 插值/ 均/ 与其/ 正序/ 结果/ 一致/ ,/ 有力/ 地/ 说明/ 了/ 新/ 方法/ 的/ 稳定性/ ./ Akima/ 数据/ ./ 图/ 10/ ,/ n/ =/ 11/ ;/ Fritsch/ 数据/ ./ 图/ 11/ ,/ n/ =/ 9/ ./ 图/ 10/ (/ c/ )/ 、/ (/ d/ )/ 和/ 图/ 11/ (/ c/ )/ 、/ (/ d/ )/ 中/ 的/ 节点/ 向量/ 由/ 积累/ 弦/ 长/ 参数/ 化/ 求得/ ./ 可以/ 看出/ ,/ 除了/ 前/ 两种/ 方法/ 性能/ 明显/ 优越/ 以外/ ,/ 新/ 方法/ 在/ 有/ 拐点/ 的/ 段/ 中/ 更/ 具有/ 数据/ 点/ 建议/ 的/ 形状/ ./ 值/ Page8/ 例/ 2/ ./ 图/ 12/ ,/ n/ =/ 23/ ,/ 在/ 小/ 弯度/ 情况/ 下/ 各/ 方法/ 的/ 对比/ ,/ 前/ 两种/ 表现/ 良好/ 而/ 潘日晶/ 的/ 方法/ 则/ 不够/ 光顺/ ./ 图/ 11Fritsch/ 数据/ 例/ 3/ ./ 图/ 13/ ,/ n/ =/ 9/ ,/ 在/ 大/ 弯度/ 情况/ 下/ 各/ 方法/ 的/ 对比/ ,/ 插值/ 点/ 分布/ 较/ 均匀/ ,/ 本文/ 和/ 潘日晶/ 方法/ 的/ 曲线/ 形状/ 较/ 好/ ,/ 而/ Piegl/ 方法/ 的/ 曲线/ 相对高度/ 过高/ ./ 例/ 4/ ./ 图/ 14/ ,/ n/ =/ 12/ ./ 图中/ 的/ 实线/ 是/ 直接/ 对/ 原始/ 点/ 插值/ ,/ 点线/ 改/ 了/ P4/ 的/ 位置/ ,/ 点/ 划线/ 改变/ 了/ P8/ 的/ 位置/ ,/ 3/ 种/ 方法/ 都/ 具有/ 良好/ 的/ 局部/ 可/ 调性/ ./ 例/ 5/ ./ 图/ 15/ ,/ n/ =/ 19/ ./ 点/ 划线/ 是/ 使用/ 自由度/ 的/ 通用/ 值/ 插值/ 而/ 得/ ,/ 本例/ 通过/ 改变/ 切矢/ 、/ 理想/ 角度/ 和/ 形状/ 因子/ 调整/ 曲线/ 的/ 形状/ ./ 改变/ 犞/ 3/ ,/ 犞/ 5/ ~/ 犞/ 8/ 和/ 犞/ 11/ 的/ 值/ 后/ 曲线/ 形状/ 如图/ 15/ (/ a/ )/ 中/ 实线/ 所示/ ,/ 改变/ 后/ 的/ 犞/ 5/ 和/ 犞/ 6/ 平行/ 于/ 弦/ P5P6/ ,/ 因此/ S/ (/ P5P6/ )/ 表现/ 为/ 线段/ ./ 将/ 理想/ 角度/ 值/ 由/ π/ // 3/ 改为/ π/ // 5/ ,/ 曲线/ 变化/ 如图/ 15/ (/ b/ )/ 中/ 的/ 深色/ 实线/ 所示/ ,/ 在/ 此基础/ 上/ 再/ 将/ γ/ 3/ ~/ γ/ 6/ ,/ γ/ 10/ ~/ γ/ 13/ 改小/ ,/ 效果/ 如图/ 15/ (/ b/ )/ 中/ 的/ 浅色/ 实线/ 所示/ ./ 可见/ 切矢/ 和/ 形状/ 因子/ 可/ 直观/ 局部/ 地/ 改变/ 曲线/ 形状/ ,/ 理想/ 角度/ 则/ 可/ 达到/ 从/ 整体/ 上/ 调整/ 曲线/ 形状/ 的/ 目的/ ./ Page9/ 图/ 15/ 利用/ 自由度/ 调整/ 曲线/ 形状/ 5/ 结论/ 本文/ 在/ 参数/ 化/ 与/ 节点/ 向量/ 的/ 取值/ 相一致/ 的/ 前提/ 下/ ,/ 将切/ 矢/ 作为/ 约束条件/ 引入/ 到/ 控制点/ 序列/ 的/ 选取/ 中/ ,/ 更/ 充分利用/ 了/ 二次/ B/ 样条/ 曲线/ 本身/ 的/ 几何/ 性质/ 进行/ 参数/ 化/ ,/ 并/ 通过/ 严格/ 的/ 数学/ 证明/ 表明/ 了/ 所/ 得到/ 的/ 节点/ 值/ 无/ 重复/ 、/ 无大/ 间隔/ 递增/ 、/ 弯度/ 变化/ 越小/ 节点/ 值/ 递增/ 幅度/ 越小/ ;/ 在/ 插值/ 过程/ 中/ ,/ 利用/ 分段/ 思想/ 以/ 达到/ 既/ 利用/ 切矢/ 又/ 不/ 受/ 其/ 限制/ 的/ 目的/ ,/ 使/ 每段/ 曲线/ 都/ 具有/ 预期/ 的/ 形状/ ,/ 并/ 留有/ 切矢/ 、/ 形状/ 因子/ 和/ 理想/ 角度/ 3/ 种/ 自由度/ ,/ 既/ 可以/ 从/ 局部/ 角度/ 直观/ 调整/ ,/ 又/ 可以/ 从/ 整体/ 上/ 优化/ ,/ 从而/ 使/ 曲线/ 更/ 具有/ 插值/ 点/ 所/ 建议/ 的/ 形状/ ./ 使用/ 本文/ 方法/ 所/ 得到/ 的/ 顺序/ 插值/ 和/ 逆序/ 插值/ 曲线/ 形状/ 相同/ ,/ 这是/ 现有/ 的/ 二次/ B/ 样条/ 插值/ 曲线/ 方法/ 所/ 不/ 具备/ 的/ ,/ 这/ 说明/ 新/ 方法/ 具有/ 更好/ 的/ 稳定性/ ,/ 再/ 结合/ 实例/ 中/ 所/ 表现/ 出来/ 的/ 良好/ 的/ 局部性/ ,/ 充分证明/ 了/ 新/ 方法/ 的/ 实用价值/ ./ 由于/ 本文/ 方法/ 需要/ 动态/ 插入/ 新/ 的/ 插值/ 点/ ,/ 在/ 数据/ 点/ 所/ 建议/ 的/ 形状/ 拐点/ 较/ 多/ 、/ 弯度/ 较大/ 时会/ 增加/ 运行/ 的/ 时间/ 和/ 存储空间/ ./ 另外/ ,/ 从/ 数学/ 上/ 证明/ 顺序/ 插值/ 和/ 逆序/ 插值/ 所/ 得到/ 的/ 曲线/ 是/ 同/ 一条/ 也/ 是/ 将来/ 的/ 工作/ 之一/ ./ 

