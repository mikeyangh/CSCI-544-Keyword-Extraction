Page1/ 一种/ 基于/ Petri/ 网/ 的/ 隐蔽/ 信息流/ 分析方法/ 周从华/ 鞠/ 时光/ (/ 江苏/ 大学/ 计算机科学/ 与/ 通信/ 工程学院/ 江苏/ 镇江/ 212013/ )/ 摘要/ 隐蔽/ 信息流/ 分析/ 是/ 开发/ 高等级/ 可信/ 计算机系统/ 必须/ 面对/ 的/ 问题/ ./ 以/ Petri/ 网/ 作为/ 开发/ 安全/ 系统/ 的/ 形式化/ 建模/ 工具/ ,/ 给出/ Petri/ 网中/ 隐蔽/ 信息流/ 存在/ 的/ 判定/ 条件/ ./ 提出/ 该/ 条件/ 成立/ 的/ 两种/ 网/ 结构/ ,/ 进而/ 可以/ 在/ 语法/ 层次/ 上/ 预先判断/ 隐蔽/ 信息流/ 的/ 存在/ 性/ ,/ 并/ 使/ 由/ 此类/ 结构/ 引起/ 的/ 隐蔽/ 信息流/ 在/ 系统/ 的/ 设计阶段/ 得以/ 避免/ ./ 开发/ 了/ 一种/ 基于/ Petri/ 网可达/ 图/ 的/ 隐蔽/ 信息流/ 存在/ 性/ 判定/ 算法/ ,/ 算法/ 遵循/ 无/ 干扰/ 方法/ 的/ 思想/ ,/ 但是/ 避免/ 了/ 无/ 干扰/ 方法/ 中/ 等价/ 状态/ 的/ 区分/ 和/ 展开/ 定理/ 的/ 使用/ ./ 另外/ ,/ 算法/ 采用/ 深度/ 优先/ 搜索/ 的/ 策略/ ,/ 避免/ 了/ Petri/ 网/ 全局/ 可达图/ 的/ 构造/ ./ 对/ 复杂/ 的/ 安全/ 系统/ ,/ 分析/ 了/ 子系统/ 的/ 各种/ 组合/ 运算/ 对/ 隐蔽/ 信息流/ 存在/ 性/ 的/ 影响/ ,/ 降低/ 了/ 大规模/ 系统分析/ 的/ 复杂度/ ./ 关键词/ 隐蔽/ 信息流/ ;/ 无/ 干扰/ ;/ Petri/ 网/ ;/ 组合/ ;/ 展开/ 定理/ 1/ 引言/ 保护/ 数据/ 的/ 机密性/ 是/ 安全/ 系统/ 最/ 基本/ 的/ 安全/ 需求/ ./ 目前/ ,/ 安全/ 计算机系统/ 一般/ 采用/ 自主/ 访问控制/ 和/ Page2/ 扩散/ 方式/ 通常/ 被/ 称为/ 隐蔽/ 信息流/ ./ 隐蔽/ 信息流/ 标识/ [/ 1/ ]/ 一直/ 是/ 开发/ 多级/ 安全/ 系统/ 必须/ 解决/ 的/ 关键问题/ ,/ 同时/ 也/ 是/ 一个/ 难题/ ./ 目前/ ,/ 已经/ 诞生/ 了/ 一些/ 隐蔽/ 信息流/ 标识/ 方法/ ,/ 可以/ 概括/ 为/ 两类/ :/ 一类/ 是/ 基于/ 程序结构/ 的/ 静态/ 分析方法/ ,/ 如/ Kemmerer/ 等/ 人/ 提出/ 的/ 共享资源/ 矩阵/ 法/ [/ 2/ ]/ 、/ 隐蔽/ 流树法/ [/ 3/ ]/ ,/ Denning/ 等/ 人/ [/ 4/ ]/ 提出/ 的/ 语法/ 信息流/ 方法/ ,/ Tsai/ 等/ 人/ [/ 5/ ]/ 提出/ 的/ 语义/ 信息流/ 方法/ ,/ 卿斯汉/ 等/ 人/ [/ 6/ ]/ 提出/ 的/ 回溯/ 方法/ 等/ ;/ 另一类/ 是/ 基于/ 程序/ 动态/ 行为/ 的/ 信息流/ 分析法/ ,/ 如/ Gouen/ 等/ 人/ [/ 7/ -/ 8/ ]/ 提出/ 的/ 无/ 干扰/ 分析法/ ./ 静态/ 分析方法/ 均/ 是/ 建立/ 在/ 对/ 程序结构/ 分析/ 的/ 基础/ 上/ ,/ 在/ 实际/ 使用/ 中/ 可以/ 发现/ 一些/ 隐蔽/ 信息流/ ,/ 但是/ 这些/ 方法/ 以/ 手工/ 处理/ 为主/ ,/ 而且/ 依赖于/ 以往/ 经验/ 和/ 个人/ 能力/ ,/ 因此/ 使用/ 时/ 不仅/ 工作量/ 大/ ,/ 而且/ 非常容易/ 出错/ ./ 信息流/ 分析法/ 是/ 一种/ 形式化/ 方法/ ,/ 其本质/ 是/ 一个/ 用户/ 不/ 应当/ 知道/ 他/ 不/ 支配/ 的/ 其他/ 任何/ 用户/ 的/ 任何/ 动作/ ./ 事实上/ ,/ 不管/ 是/ 直接/ 的/ 信息/ 泄露/ 还是/ 间接/ 的/ 信息/ 泄露/ ,/ 都/ 可以/ 看成/ 系统/ 中/ 信息/ 的/ 流动/ ,/ 因此/ 信息流/ 分析法/ 被/ 认为/ 是/ 一种/ 有/ 前景/ 的/ 方法/ [/ 1/ ]/ ./ 其/ 主要/ 缺点/ 是/ 使用/ 时/ 依赖/ “/ 展开/ 定理/ ”/ [/ 9/ ]/ ./ 本文/ 的/ 一个/ 研究/ 点/ 就是/ 如何/ 在/ 基于/ 状态/ 转换/ 系统/ 的/ 无/ 干扰/ 分析法/ 中/ 避免/ 使用/ “/ 展开/ 定理/ ”/ ./ 自/ Gouen/ 等/ 人/ 提出/ 无/ 干扰/ 分析法/ 以来/ ,/ 研究/ 人员/ 一般/ 基于/ 进程/ 代数和/ 事件/ 系统/ 的/ 形式/ 规约/ 来/ 研究/ 无/ 干扰/ 分析法/ ./ 采用/ 这/ 两种/ 规约/ 方式/ 的/ 缺点/ 非常明显/ :/ 进程/ 代数/ 太/ 抽象/ ,/ 不易/ 理解/ ,/ 而且/ 关于/ 进程/ 代数/ 的/ 自动化/ 分析/ 工具/ 不/ 多/ ;/ 事件/ 系统/ 的/ 主要/ 问题/ 在于/ 很难/ 实施/ 归纳/ 证明/ ./ 目前/ 软件/ 规约/ 大多/ 采用/ 基于/ 状态/ 转换/ 的/ 描述/ 方式/ ./ 与/ 进程/ 代数/ 与/ 事件/ 系统/ 相比/ ,/ 这种/ 规约/ 方式/ 具有/ 直观/ 自然/ 的/ 优点/ ,/ 同时/ 存在/ 大量/ 的/ 有效/ 的/ 分析/ 工具/ ./ 因此/ 本文/ 主要/ 研究/ 基于/ 有限/ 状态/ 转换/ 系统/ 的/ 无/ 干扰/ 分析法/ ./ 我们/ 从/ 基于/ 状态/ 转换/ 的/ 安全/ 系统/ 的/ 形式化/ 规约/ 出发/ ,/ 以/ Petri/ 网/ [/ 10/ -/ 11/ ]/ 作为/ 描述/ 安全/ 系统/ 规范/ 的/ 形式化/ 工具/ 来/ 开展/ 我们/ 的/ 研究/ ./ 选择/ Petri/ 网/ 作为/ 安全/ 系统/ 动态/ 行为/ 建模/ 的/ 工具/ ,/ 主要/ 基于/ 以下/ 两点/ 原因/ :/ (/ 1/ )/ Petri/ 网/ 本身/ 的/ 特点/ :/ 既有/ 严格/ 的/ 形式化/ 定义/ ,/ 又/ 有/ 直观/ 的/ 图形/ 表示/ ,/ 存在/ 大量/ 设计/ 和/ 分析/ 的/ 算法/ ,/ 有/ 强大/ 的/ 计算机/ 工具/ 来/ 辅助/ 算法/ 的/ 设计/ 与/ 分析/ ,/ 并且/ 可以/ 表示/ 真/ 并发/ ,/ 可以/ 对系统/ 提供/ 不同/ 层次/ 的/ 描述/ ,/ 使得/ 我们/ 的/ 方法/ 可以/ 应用/ 在/ 系统/ 开发/ 的/ 不同/ 阶段/ ;/ (/ 2/ )/ 多级/ 安全/ 系统/ 的/ 特性/ 在于/ 用户/ 实施/ 的/ 操作/ 受到/ 安全/ 机制/ 的/ 监控/ ,/ 造成/ 不同/ 安全/ 级用户/ 被/ 允许/ 执行/ 的/ 操作/ 和/ 对/ 程序/ 输出/ 的/ 观察/ 力度/ 是/ 不/ 一样/ 的/ ,/ 安全/ 系统/ 的/ 形式化/ 模型/ 应该/ 具有/ 刻画/ 此/ 特性/ 的/ 能力/ ,/ 在/ Petri/ 网中/ 通过/ 对/ 变迁/ 和/ 库/ 所/ 进行/ 划分/ ,/ 很/ 容易/ 实现/ 该/ 能力/ ,/ 从而/ 使得/ 信息流/ 的/ 描述/ 更加/ 自然/ ,/ 容易/ 在/ 实际/ 系统/ 中/ 得到/ 应用/ ./ 文中/ 采用/ 无/ 干扰/ 方法/ 中/ 隐蔽/ 信息流/ 存在/ 的/ 表现形式/ ,/ 从/ 初始状态/ 开始/ ,/ 删除/ 高/ 安全/ 级用户/ 所有/ 的/ 输入/ (/ 等价/ 于/ 从来/ 没有/ 这些/ 输入/ )/ ,/ 低/ 安全/ 级用户/ 的/ 输出/ 没有/ 任何/ 变化/ ,/ 作为/ 隐蔽/ 信息流/ 存在/ 的/ 充分条件/ ./ 并/ 将/ 该/ 条件/ 转化/ 为/ Petri/ 网上/ 的/ 表现形式/ :/ 存在/ 高/ 安全/ 级用户/ 的/ 单个/ 输入/ 引起/ 安全/ 系统/ 的/ 状态/ 发生变化/ ,/ 且/ 这种/ 变化/ 在/ 低/ 安全/ 级用户/ 所见/ 的/ 库/ 所/ 集上/ 有所/ 反映/ ./ 在/ 建立/ 系统/ 的/ Petri/ 描述/ 后/ ,/ 从/ Petri/ 网/ 的/ 语法/ 层面/ 给出/ 了/ 隐蔽/ 信息流/ 存在/ 的/ 两种/ 主要/ 结构/ 关系/ :/ 冲突/ 关系/ 和/ 因果关系/ ./ 这/ 两种/ 关系/ 说明/ 什么样/ 的/ 结构/ 可能/ 会/ 产生/ 隐蔽/ 信息流/ ,/ 这样/ ,/ 在/ 安全/ 系统/ 设计阶段/ ,/ 设计/ 人员/ 就/ 可以/ 考虑/ 避免/ 使用/ 这些/ 结构/ ./ 文中/ 主要/ 通过/ 计算/ Petri/ 网/ 的/ 可达图/ 过程/ 来/ 检测/ 隐蔽/ 信息流/ 的/ 存在/ 性/ ,/ 而且/ 检测/ 过程/ 是/ 在/ 计算/ 可达图/ 的/ 过程/ 中/ 实施/ 的/ ,/ 这样/ 可以/ 避免/ 全局/ 可达图/ 的/ 构造/ ,/ 提高/ 了/ 效率/ ,/ 节省/ 了/ 存储空间/ ./ 与/ 无/ 干扰/ 方法/ 相比/ ,/ 我们/ 方法/ 的/ 优点/ 主要/ 体现/ 在/ 无需/ 区分/ 不同/ 的/ 状态/ 等价/ 类/ ,/ 避免/ 使用/ 展开/ 定理/ ./ 与/ 基于/ 有限/ 状态/ 转换/ 系统/ 的/ 无/ 干扰/ 分析法/ 相关/ 的/ 研究/ 主要/ 有/ 3/ 个/ ./ 在/ 文献/ [/ 12/ ]/ 中/ 訾小超/ 等/ 对/ 无/ 干扰/ 方法/ 进行/ 了/ 改进/ ,/ 提出/ 了/ 一个/ 隐蔽/ 信息流/ 在/ 自动机/ 模型/ 中/ 存在/ 的/ 充分/ 必要条件/ ,/ 并/ 给出/ 了/ 判定/ 算法/ ./ 但是/ 他们/ 的/ 方法/ 仍然/ 没有/ 避免/ 使用/ 展开/ 定理/ ./ 在/ 文献/ [/ 13/ ]/ 中/ vanderMeyden/ 等/ 对/ 确定/ 型/ 多级/ 安全/ 系统/ ,/ 提出/ 了/ 一种/ 算术/ 的/ 方法/ 来/ 验证/ 无/ 干扰/ 属性/ ./ 他们/ 首先/ 定义/ 了/ 系统/ 的/ 双/ 构造/ ,/ 然后/ 将/ 无/ 干扰/ 属性/ 的/ 验证/ 问题归约/ 为/ 双/ 构造/ 系统/ 的/ 可达性/ 问题/ ./ 他们/ 的/ 方法/ 避免/ 了/ “/ 展开/ 定理/ ”/ 的/ 使用/ ,/ 但是/ 增加/ 了/ 分析/ 的/ 系统/ 规模/ ,/ 具体表现/ 为/ :/ 令/ M/ 为/ 一/ 确定/ 型/ 安全/ 系统/ ,/ |/ M/ |/ 表示/ 系统/ 中/ 状态/ 的/ 个数/ ,/ 则/ M/ 的/ 双/ 构造/ 中/ 状态/ 数为/ |/ M/ |/ 2/ ./ 与/ 我们/ 的/ 方法/ 相比/ ,/ 主要/ 的/ 不同点/ 体现/ 在/ 两个/ 方面/ :/ (/ 1/ )/ 时间/ 复杂性/ ./ 文献/ [/ 13/ ]/ 中/ 提出/ 的/ 方法/ 等价/ 于/ 在/ M/ 的/ 双/ 构造/ 中/ 进行/ 深度/ 优先/ 搜索/ ,/ 其/ 时间/ 复杂性/ 为/ O/ (/ |/ M/ |/ 2/ )/ ,/ 而/ 我们/ 的/ 方法/ 等价/ 于/ 在/ 系统/ M/ 上/ 进行/ 深度/ 首先/ 搜索/ ,/ 时间/ 复杂性/ 为/ O/ (/ |/ M/ |/ )/ ;/ (/ 2/ )/ 存储空间/ ./ M/ 的/ 双/ 构造/ 中/ 每个/ 状态/ 的/ 存储空间/ 是/ M/ 中/ 每个/ 状态/ 所/ 需/ 存储空间/ 的/ 两倍/ ./ 文献/ [/ 14/ ]/ 提出/ 一种/ 通过考察/ Petri/ 网中库/ 所/ 的/ 前置/ 集/ 和/ 后置/ 集/ 之间/ 的/ 关系/ 来/ 判断/ 系统/ 是否/ 满足/ 无/ 干扰/ 属性/ 的/ 方法/ ,/ 即/ 如果/ 发现/ 某一库/ 所/ 的/ 前置/ 集中/ 有/ 高/ 安全/ 级/ 的/ 变迁/ ,/ 同时/ 后置/ 集中/ 有/ 低/ 安全/ 级/ 的/ 变迁/ ,/ 则/ 认为/ 系统/ 不/ 满足/ 无/ 干扰/ 安全/ 属性/ ./ 本文/ 对/ 文献/ [/ 14/ ]/ 的/ 这项/ 工作/ 进一步/ 精化/ ,/ 提出/ 了/ 变迁/ 之间/ 的/ 冲/ Page3/ 突/ 关系/ 和/ 因果关系/ ,/ 并/ 分析/ 两者/ 和/ 隐蔽/ 信息流/ 之间/ 的/ 关系/ ./ 此外/ ,/ 文献/ [/ 14/ ]/ 只/ 考察/ 了/ Petri/ 网/ 的/ 语法结构/ ,/ 而/ 没有/ 考虑/ Petri/ 网/ 的/ 语义/ ,/ 从而/ 导致/ 会/ 发现/ 很多/ 伪/ 的/ 隐蔽/ 信息流/ ./ 本文/ 通过/ 引入/ Petri/ 网/ 的/ L1/ 活性/ 有效/ 地/ 避免/ 了/ 该/ 问题/ ./ 本文/ 最后/ 还/ 研究/ 了/ 安全/ 系统/ 的/ 组合/ 问题/ ./ 当/ 多级/ 安全/ 系统/ 规模/ 很大/ 、/ 很/ 复杂/ 时/ 对/ 其/ 直接/ 进行/ 安全性/ 分析/ 是/ 一件/ 十分困难/ 的/ 事情/ ./ 现在/ ,/ 软件工程/ 领域/ 流行/ 的/ 开发方法/ 是/ 基于/ 模块/ 的/ 开发/ ,/ 即将/ 复杂/ 系统化/ 分成/ 很多/ 个/ 模块/ ,/ 每个/ 子/ 模块/ 单独/ 开发/ ,/ 最后/ 再/ 将/ 这些/ 子/ 模块/ 按照/ 一定/ 的/ 组成/ 规则/ 组合成/ 一个/ 复杂/ 的/ 系统/ ./ 因此/ 我们/ 在/ 分析/ 安全/ 系统/ 时/ 也/ 可以/ 按照/ 这种/ 思路/ 进行/ ,/ 从而/ 降低/ 大规模/ 系统分析/ 的/ 复杂度/ ./ 文中/ 在/ 假设/ 单个/ Petri/ 网/ 不/ 存在/ 隐蔽/ 信息流/ 的/ 情况/ 下/ ,/ 讨论/ 了/ 在/ 各种/ 组合/ 操作/ 下/ (/ 顺序/ 、/ 循环/ 、/ 并行/ 、/ 选择/ 、/ 共享/ 、/ 同步/ )/ ,/ 无/ 干扰/ 属性/ 是否/ 得到/ 保持/ ,/ 为/ 开发/ 大规模/ 复杂/ 的/ 安全/ 系统/ 提供/ 了/ 指导/ ./ 2/ 安全/ 系统/ 的/ Petri/ 网/ 模型/ 2.1/ Petri/ 网/ 1962/ 年/ 联邦德国/ 的/ CarlAdamPetri/ 在/ 他/ 的/ 博士论文/ 《/ 用/ 自动机/ 通信/ 》/ 中/ 首次/ 使用/ 网状结构/ 模拟/ 通信/ 系统/ ,/ 这种/ 系统/ 模型/ 就是/ Petri/ 网/ 的/ 雏形/ ./ 目前/ ,/ Petri/ 网/ 的/ 研究/ 相当/ 广泛/ ,/ 在/ 系统/ 建模/ 、/ 分析/ 、/ 模拟/ 、/ 验证/ 方面/ 均/ 获得/ 了/ 有效/ 的/ 应用/ ./ 定义/ 1/ ./ Petri/ 网是/ 一个/ 四元组/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ ,/ 其中/ (/ 1/ )/ P/ 表示/ 库所/ 节点/ 集合/ ,/ T/ 表示/ 变迁/ 节点/ 集合/ ;/ (/ 2/ )/ P/ ∩/ T/ =/ / ,/ P/ ∪/ T/ ≠/ / ;/ (/ 3/ )/ F/ / (/ P/ ×/ T/ )/ ∪/ (/ T/ ×/ P/ )/ ,/ 表示/ 库所/ 节点/ 与/ 变/ (/ 4/ )/ M0/ :/ P/ →/ N/ 为/ 初始状态/ ,/ 这里/ N/ 为/ 自然数/ 集/ ./ 对/ / x/ ∈/ P/ ∪/ T/ ,/ 令/ ·/ x/ =/ {/ y/ |/ (/ y/ ∈/ P/ ∪/ T/ )/ ∧/ (/ (/ y/ ,/ x/ )/ ∈/ F/ )/ }/ 和/ x/ ·/ =/ {/ y/ |/ (/ y/ ∈/ P/ ∪/ T/ )/ ∧/ (/ (/ x/ ,/ y/ )/ ∈/ F/ )/ }/ ,/ 称/ ·/ x/ 和/ x/ ·/ 分别/ 为/ x/ 的/ 前置/ 集/ 和/ 后置/ 集/ ./ 称/ Token/ 在/ 库/ 所/ 节点/ 上/ 的/ 分布/ 为/ Petri/ 网/ 的/ 状态/ ,/ 即/ M/ :/ P/ →/ N/ ./ 文中/ ,/ 采用/ M/ (/ pi/ )/ 表示/ 在/ 库/ 所/ 节点/ pi/ 上/ 的/ Token/ 数/ ./ 变迁/ t/ 在/ 状态/ M/ 下/ 是/ 使/ 能/ 的/ 当且/ 仅/ 当/ / p/ ∈/ ·/ t/ ,/ M/ (/ p/ )/ / 1/ ./ 使能/ 的/ 变迁/ t/ 是/ 可以/ 引发/ 的/ ,/ 引发/ 后/ Petri/ 网/ 的/ 状态/ 发生/ 如下/ 变化/ :/ 迁/ 节点/ 之间/ 的/ 有/ 向/ 弧/ 集合/ ;/ 给定/ Petri/ 网/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ ,/ 在/ 文章/ 中/ 会/ 用到/ 下面/ 几个/ 记号/ :/ (/ 1/ )/ M1/ →/ tM2/ :/ 变迁/ t/ 在/ 状态/ M1/ 是/ 使/ 能/ 的/ ,/ 且/ 在/ 引发/ 后/ 状态/ 由/ M1/ 变成/ M2/ (/ 按式/ (/ 1/ )/ 计算/ )/ ;/ (/ 2/ )/ M1/ →/ M2/ :/ 存在/ 变迁/ t/ 使得/ M1/ →/ tM2/ ;/ (/ 3/ )/ M1/ →/ σ/ M2/ :/ 变迁/ 序列/ σ/ =/ t1/ ,/ …/ ,/ tn/ -/ 1/ 使得/ M1/ →/ t1M2/ →/ t2/ …/ →/ tn/ -/ 1Mn/ ,/ 并称/ M2/ 为/ 在/ M1/ 下/ 输入/ σ/ 的/ 输出/ ;/ (/ 4/ )/ M1/ →/ / M2/ :/ 存在/ 变迁/ 序列/ σ/ 使得/ M1/ →/ σ/ M2/ ;/ (/ 5/ )/ [/ M0/ 〉/ 表示/ PN/ 的/ 可达/ 状态/ 集/ :/ [/ M0/ 〉/ =/ {/ M/ |/ M0/ →/ / M/ }/ ;/ (/ 6/ )/ M1/ →/ t1M2/ →/ t2/ …/ →/ tn/ -/ 1Mn/ 称为/ 路径/ ./ 定义/ 2/ (/ 可达图/ )/ ./ Petri/ 网/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ 的/ 可达图/ RS/ 是/ 一个/ 三元组/ (/ S/ ,/ s0/ ,/ R/ )/ ,/ 这里/ S/ =/ [/ M0/ 〉/ ,/ s0/ =/ M0/ 为/ 可达图/ 的/ 初始状态/ ,/ R/ :/ S/ ×/ T/ →/ S/ 定义/ 为/ s/ =/ R/ (/ s/ ,/ t/ )/ 当且/ 仅/ 当/ s/ →/ ts/ ./ 称/ s1/ →/ t1s2/ →/ t2/ …/ →/ tn/ -/ 1sn/ 为/ RS/ 中/ 的/ 一条/ 路径/ 当且/ 仅/ 当/ / 1/ / i/ / n/ -/ 1/ (/ si/ +/ 1/ =/ R/ (/ si/ ,/ ti/ )/ )/ ./ 称/ Petri/ 网/ PN/ 是/ k/ 界/ 的/ 当且/ 仅/ 当/ / M/ ∈/ [/ M0/ 〉/ ,/ / p/ ∈/ P/ (/ M/ (/ p/ )/ / k/ )/ ./ k/ 界/ Petri/ 网/ 可以/ 转化/ 为/ 与/ 之/ 等价/ 的/ 1/ 界/ Petri/ 网/ ./ 由于/ 很多/ 系统/ 可以/ 用/ 有界/ Petri/ 网/ 进行/ 描述/ ,/ 因此/ 文中/ 假设/ 所/ 讨论/ 的/ Petri/ 网/ PN/ 均/ 是/ 1/ 界/ 的/ ./ 在/ 后面/ 的/ 讨论/ 中/ 会/ 涉及/ 到/ Petri/ 网/ 的/ L1/ 活性/ ,/ 因此/ 下面/ 引入/ L1/ 活性/ 的/ 定义/ ./ 定义/ 3/ (/ L1/ 活性/ )/ [/ 15/ ]/ ./ 给定/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ ,/ 称/ 变迁/ t/ ∈/ T/ 具有/ L1/ 活性/ 当且/ 仅/ 当/ 在/ PN/ 的/ 可达图/ RS/ 中/ 存在/ 路径/ s0/ →/ / s1/ →/ ts2/ ,/ 即/ 存在/ 一个/ 从/ 初始状态/ 可达/ 的/ 状态/ s1/ ,/ 使得/ 在/ s1/ 下/ t/ 是/ 使/ 能/ 的/ ./ 2.2/ 基于/ 等级/ 划分/ 的/ 安全/ 系统/ 的/ Petri/ 网/ 表示/ 为/ 方便/ 讨论/ ,/ 先/ 约定/ 系统/ 的/ 保密性/ 要求/ :/ 系统/ 中/ 只/ 存在/ 高/ 安全/ 级/ (/ 以下/ 简称/ H/ 用户/ )/ 和/ 低/ 安全/ 级/ (/ 以下/ 简称/ L/ 用户/ )/ 两类/ 用户/ ,/ 从/ L/ 用户/ 到/ H/ 用户/ 的/ 信息流/ 是/ 允许/ 的/ ,/ 而/ 从/ H/ 用户/ 到/ L/ 用户/ 的/ 信息流/ 是/ 禁止/ 的/ ./ 这个/ 保密性/ 要求/ 体现/ 了/ 多级/ 安全策略/ ./ 这里/ 需要/ 说明/ 的/ 是/ ,/ 本文/ 主要/ 关心/ 的/ 是从/ 高/ 安全/ 级用户/ 到/ 低/ 安全/ 级用户/ 的/ 信息/ 流动/ ./ 因此/ 和/ 许多/ 文献/ 一样/ ,/ 为/ 讨论/ 的/ 简便/ ,/ 假设/ 系统/ 中/ 只/ 存在/ 两类/ 用户/ ./ 事实上/ 对/ 存在/ 多个/ 安全等级/ 用户/ 的/ 多级/ 安全/ 系统/ ,/ 从/ 信息/ 流动/ 的/ 角度看/ ,/ 第三方/ 主体/ 可能/ 会/ 担当/ 中间人/ 的/ 角色/ ,/ 即/ 信息/ 从/ 高/ 安全/ 级用户/ 流向/ 第三方/ 主体/ ,/ 再/ 由/ 第三方/ 主体/ 流向/ 低/ 安全/ 级用户/ ./ 对于/ 满足/ 传递性/ 的/ 信息流/ 安全策略/ ,/ 这种/ 情况/ 可以/ 归约/ 为/ 高/ 安全/ 级用户/ 到/ 低/ 安全/ 级用户/ 的/ 信息/ 流动/ ,/ 因此/ 两类/ 用户/ 的/ 假设/ 把握住/ 了/ 研究/ 的/ 重点/ ,/ 同时/ 又/ 不失/ 一般性/ 的/ ./ 每个/ 用户/ 都/ 有/ 特定/ 的/ 操作/ 权限/ 和/ 观察/ 能力/ ,/ 有/ Page4/ 些/ 操作/ 对/ 该/ 用户/ 是/ 禁止/ 的/ ,/ 有些/ 输出/ 对/ 该/ 用户/ 是/ 不/ 可见/ 的/ ./ 依据/ L/ 用户/ 的/ 操作/ 和/ 观察/ 能力/ ,/ 输入/ 事件/ 可/ 分为/ H/ 用户/ 输入/ 事件/ 和/ L/ 用户/ 输入/ 事件/ ,/ 分别/ 用/ TH/ 和/ TL/ 来/ 表示/ 由/ 这些/ 事件/ 构成/ 的/ 集合/ ,/ 且/ 满足/ TL/ ∩/ TH/ =/ / ./ TL/ 中/ 的/ 事件/ 对/ L/ 用户/ 是/ 可见/ 的/ ,/ 而/ TH/ 中/ 的/ 事件/ 对/ L/ 用户/ 是/ 不/ 可见/ 的/ ,/ 否则/ 就/ 已经/ 形成/ 了/ 相应/ 的/ 隐蔽/ 信息流/ ./ L/ 用户/ 到/ H/ 用户/ 的/ 信息流/ 不/ 违背/ 保密性/ 要求/ ,/ 我们/ 不/ 关心/ H/ 用户/ 是否/ 能够/ 观察/ 到/ L/ 中/ 的/ 事件/ ./ PL/ 表示/ L/ 用户/ 所/ 能/ 观察/ 到/ 的/ 库/ 所集/ ,/ 对于/ T/ 中/ 事件/ 的/ 发生/ 导致/ 的/ 系统/ 状态/ 发生变化/ ,/ L/ 用户/ 只能/ 通过/ 集合/ PL/ 上/ Token/ 分布/ 的/ 变化/ 来/ 观察/ ./ 从/ 上面/ 的/ 分析/ 看出/ ,/ 对于/ 安全/ 系统/ ,/ 需要/ 区分/ L/ 用户/ 和/ H/ 用户/ 的/ 动作/ ,/ 因此/ 为/ 方便/ 起/ 见/ ,/ 以下/ 假设/ Petri/ 网为/ 一/ 五元/ 组/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ ,/ 这里/ TL/ ∪/ TH/ =/ T/ ,/ TL/ ∩/ TH/ =/ / ./ L/ 用户/ 所/ 能/ 观察/ 到/ 的/ 库/ 所集/ PL/ 定义/ 为/ PL/ =/ ∪/ t/ ∈/ TL/ 系统/ 的/ 运行/ 受/ 输入/ 事件驱动/ ,/ 但是/ 系统/ 中/ 还/ 存在/ 一类/ 输入/ 事件/ ,/ 比如/ 用户/ 不停/ 观察/ 当前/ 状态/ ,/ 这/ 类/ 事件/ 不会/ 改变/ 系统/ 的/ 当前/ 状态/ ./ 我们/ 引入/ 记号/ τ/ 统一/ 表示/ 这/ 类/ 操作/ ,/ 且/ 在/ 任何/ 状态/ M/ 下/ τ/ 都/ 能/ 被/ 引发/ ,/ 同时/ 在/ 引发/ 后/ 状态/ 保持/ 不变/ ./ 为了/ 讨论/ 的/ 方便/ ,/ 在/ 本文/ 的/ 后面/ 部分/ 除非/ 特别强调/ ,/ 否则/ 输入/ 事件/ 均/ 不/ 包含/ τ/ ./ 2.3/ 犘/ 犖/ 的/ 用户/ 视图/ 在/ PN/ 的/ 运行/ 中/ ,/ 由于/ L/ 用户/ 只能/ 观察/ 到/ TL/ 中/ 事件/ 的/ 发生/ 和/ Token/ 在/ PL/ 上/ 的/ 分布/ ,/ L/ 用户/ 并/ 不能/ 精确/ 观察/ 到/ PN/ 的/ 全部/ 执行/ 活动/ ,/ 这/ 相当于/ L/ 用户/ 只能/ 感受/ 到/ PN/ 的/ 部分/ 执行/ ,/ 我们/ 把/ L/ 用户/ 感受/ 到/ 的/ 这/ 一部分/ 称为/ PN/ 在/ L/ 用户/ 层面/ 的/ 投影/ ,/ 记作/ L/ -/ RS/ ./ 定义/ 4/ (/ L/ 可达图/ )/ ./ 给定/ Petri/ 网/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ ,/ 定义/ 其可达/ 图/ RS/ (/ S/ ,/ s0/ ,/ R/ )/ 在/ L/ 用户/ 上/ 的/ 投影/ 为/ L/ -/ RS/ (/ SL/ ,/ s0/ ,/ L/ ,/ RL/ )/ ,/ 这里/ :/ (/ 1/ )/ SL/ =/ {/ s/ ↓/ PL/ |/ s/ ∈/ S/ }/ ,/ 其中/ s/ ↓/ PL/ 定义/ 为/ / p/ ∈/ PL/ ,/ s/ ↓/ PL/ (/ p/ )/ =/ s/ (/ p/ )/ ;/ (/ 2/ )/ s0/ ,/ L/ =/ s0/ ↓/ PL/ ;/ (/ 3/ )/ RL/ :/ SL/ ×/ (/ TL/ ∪/ {/ ε/ }/ )/ →/ SL/ 为/ 状态/ 转换/ 函数/ ,/ RL/ (/ s/ ↓/ PL/ ,/ t/ )/ =/ s/ ↓/ PL/ 当且/ 仅/ 当/ 下面/ 条件/ 中/ 的/ 一个/ 成立/ :/ 如果/ t/ ∈/ TL/ ,/ 则/ R/ (/ s/ ,/ t/ )/ =/ s/ ;/ 如果/ t/ =/ ε/ ,/ 则/ / t/ ∈/ TH/ 使得/ ,/ R/ (/ s/ ,/ t/ )/ =/ s/ ./ 3/ 隐蔽/ 信息流/ 形成/ 条件/ 在/ 实际/ 系统/ 中/ ,/ 隐蔽/ 信息流/ 形成/ 需要/ 两个/ 阶段/ :/ H/ 用户/ 的/ 信息/ 发送/ 和/ L/ 用户/ 的/ 信息/ 接收/ ./ 在/ 发送/ 阶段/ ,/ H/ 用户/ 执行/ 精心设计/ 的/ 操作/ (/ 或/ 操作/ 组合/ )/ ,/ 这些/ 操作/ 隐含/ 了/ 相应/ 的/ 机密信息/ ,/ 并/ 能/ 以/ 一定/ 的/ 方式/ 影响/ 系统/ 行为/ ;/ 在/ 信息/ 接收/ 阶段/ ,/ L/ 用户/ 通过观察/ 系统/ 行为/ ,/ 推断/ H/ 用户/ 对系统/ 所/ 执行/ 的/ 操作/ ,/ 并/ 进一步/ 推出/ 其中/ 所/ 隐含/ 的/ 机密信息/ ./ 从/ 隐蔽/ 信息流/ 的/ 实际/ 形成/ 来看/ ,/ 这/ 两个/ 阶段/ 缺一不可/ ,/ 而/ 形成/ 这/ 两个/ 阶段/ 的/ 关键在于/ :/ L/ 用户/ 能够/ 感知/ 到/ H/ 用户/ 对系统/ 行为/ 的/ 特定/ 影响/ ./ 无/ 干扰/ 方法/ 根据/ L/ 用户/ 观察/ 的/ 系统/ 输出/ 来/ 推断/ H/ 用户/ 对系统/ 所/ 执行/ 的/ 操作/ ./ 设/ w/ 为/ 一个/ 输入/ 序列/ ,/ 它/ 的/ 结尾/ 是/ L/ 的/ 输入/ ,/ w/ // H/ 表示/ 从/ w/ 中/ 删除/ 所有/ H/ 的/ 输入/ 后/ 剩下/ 的/ 子/ 序列/ ./ 在/ 初始状态/ 输入/ w/ 后/ ,/ L/ 得到/ 的/ 输出/ 为/ L/ (/ w/ )/ ./ 显然/ L/ (/ w/ )/ 刻画/ 的/ 是/ Token/ 在/ PL/ 上/ 的/ 分布/ ./ 本节/ 主要/ 考察/ 在/ L/ 可达图/ 上/ 隐蔽/ 信息流/ 的/ 表现形式/ ./ 在此之前/ ,/ 先/ 介绍/ 无/ 干扰/ 方法/ 的/ 核心思想/ ,/ 如/ 定理/ 1/ ./ 定理/ 1/ [/ 7/ -/ 8/ ]/ ./ H/ 与/ L/ 之间/ 存在/ 隐蔽/ 信息流/ 当且/ 仅/ 当/ 存在/ 以/ L/ 的/ 输入/ 为/ 结尾/ 的/ 输入/ 序列/ w/ ,/ 满足/ L/ (/ w/ )/ ≠/ L/ (/ w/ // H/ )/ ./ 据/ 定理/ 1/ 隐蔽/ 信息流/ 的/ 实际/ 关键在于/ :/ L/ 用户/ 能够/ 感知/ 到/ H/ 用户/ 对系统/ 行为/ 的/ 特定/ 影响/ ,/ 这/ 意味着/ L/ 用户/ 所/ 感受/ 到/ 的/ 系统/ 行为/ 并/ 不/ 完全/ 由/ 自己/ 的/ 输入/ 所/ 决定/ ,/ 反映/ 在/ L/ -/ RS/ (/ SL/ ,/ s0/ ,/ L/ ,/ RL/ )/ 上/ 就是/ :/ 对/ 同一/ L/ 用户/ 的/ 输入/ 序列/ ,/ 存在/ 多条/ 可能/ 的/ 转移/ 路径/ ,/ 而且/ 在/ 系统/ 运行/ 中/ ,/ L/ 用户/ 能够/ 知道/ 实际/ 是/ 按/ 哪一条/ 路径/ 进行/ 转移/ 的/ ./ 考察/ 路径/ s1/ →/ l1s2/ →/ ε/ s2/ →/ l2s3/ ,/ s1/ →/ l1s2/ →/ l2s3/ ,/ 在/ 不/ 考虑/ s3/ 以后/ 发生/ 的/ 状态/ 转换/ 关系/ 的/ 情况/ 下/ L/ 用户/ 所/ 观察/ 到/ 的/ 是/ 同/ 一条/ 转移/ 路径/ s1/ →/ l1s2/ →/ l2s3/ ./ 因此/ 不能/ 简单/ 地/ 通过/ 路径/ 的/ 长度/ 来/ 判定/ 不同/ 的/ 转移/ 路径/ ,/ 需要/ 通过/ 下面/ 定义/ 的/ 路径/ 观察/ 函数/ Obs/ 来/ 区分/ ./ 定义/ 5/ (/ 路径/ 观察/ 函数/ )/ ./ 设/ Path/ 为/ L/ -/ RS/ (/ SL/ ,/ s0/ ,/ L/ ,/ RL/ )/ 中/ 的/ 一条/ 路径/ ,/ Obs/ (/ Path/ )/ =/ {/ s1/ →/ ts2/ |/ (/ t/ ∈/ TL/ 且/ s1/ →/ ts2/ 为/ Path/ 上/ 的/ 一个/ 状态/ 转换/ 或者/ (/ t/ =/ ε/ ∧/ s1/ ≠/ s2/ )/ }/ 称为/ Path/ 的/ 观察/ 函数/ ./ 定义/ 6/ (/ 不同/ 的/ 状态/ 转移/ 路径/ )/ ./ 路径/ Path1/ 与/ Path2/ 是/ 不同/ 的/ 当且/ 仅/ 当/ Obs/ (/ Path1/ )/ ≠/ Obs/ (/ Path2/ )/ ./ 以下/ 部分/ 会/ 涉及/ 到/ 在/ L/ 输入/ 序列/ σ/ 下/ L/ 用户/ 的/ 观察/ ,/ 这里/ 的/ 观察/ 指/ 的/ 是/ 对于/ 任意/ 输入/ 序列/ w/ ,/ 只要/ w/ // H/ =/ σ/ ,/ 则/ PN/ 在/ w/ 下/ 的/ 运行/ 路径/ 均/ 是/ L/ 用户/ 在/ 输入/ 序列/ σ/ 下/ 观察/ 到/ 的/ 路径/ ./ 引理/ 1/ ./ PN/ 中/ 存在/ 以/ L/ 的/ 输入/ 为/ 结尾/ 的/ 输入/ 序列/ w/ ,/ 满足/ L/ (/ w/ )/ ≠/ L/ (/ w/ // H/ )/ 当且/ 仅/ 当/ L/ 用户/ 在/ 输入/ 序列/ w/ // H/ 下能/ 观察/ 到/ 不同/ 的/ 状态/ 转移/ 路径/ ./ 证明/ ./ (/ / )/ 设在/ 输入/ w/ 和/ w/ // H/ 下/ ,/ 状态/ 转移/ Page5/ 路径/ 分别/ 为/ Path1/ ,/ Path2/ ./ 因为/ L/ (/ w/ )/ ≠/ L/ (/ w/ // H/ )/ ,/ 所以/ Obs/ (/ Path1/ )/ ≠/ Obs/ (/ Path2/ )/ ./ (/ / )/ 通过/ 对/ L/ 用户/ 输入/ 序列/ (/ 不/ 包括/ τ/ )/ 的/ 长度/ 进行/ 归纳/ 来/ 证明/ ./ (/ 1/ )/ 设/ L/ 用户/ 输入/ 序列/ 的/ 长度/ 为/ 0/ ,/ 此时/ L/ 用户/ 必/ 观察/ 到/ 路径/ Path1/ =/ s1/ →/ ε/ s2/ →/ ε/ …/ →/ ε/ sn/ →/ τ/ sn/ ,/ 且/ / 1/ / i/ / n/ -/ 2/ (/ si/ =/ si/ +/ 1/ )/ ∧/ sn/ -/ 1/ ≠/ sn/ ./ 在/ 状态/ s0/ 下/ ,/ L/ 用户/ 可以/ 输入/ 事件/ τ/ ,/ 并/ 观察/ 到/ 路径/ Path2/ =/ s0/ →/ τ/ s0/ ./ 记/ w/ 为/ Path1/ 上/ 的/ 输入/ 序列/ ,/ 则/ L/ (/ w/ )/ ≠/ L/ (/ w/ // H/ )/ ./ (/ 2/ )/ 设在/ L/ 用户/ 输入/ 序列/ 长度/ 为/ m/ -/ 1/ (/ m/ / 1/ )/ 时/ 结论/ 成立/ ./ (/ 3/ )/ 设在/ L/ 用户/ 输入/ 序列/ l1/ ,/ …/ ,/ lm/ ∈/ TL/ 下/ L/ 用户/ 有/ 不同/ 的/ 观察/ ,/ 且/ 在/ l1/ ,/ …/ ,/ lm/ -/ 1/ 下/ L/ 用户/ 没有/ 不同/ 的/ 观察/ ./ 不妨/ 设/ 两个/ 观察/ 为/ s1/ →/ …/ →/ lm/ -/ 1sn/ -/ x/ →/ ε/ …/ →/ lmsn/ →/ ε/ sn/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ u/ ,/ s1/ →/ …/ →/ lm/ -/ 1sj/ -/ y/ →/ ε/ …/ →/ lmsj/ →/ ε/ sj/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ v/ ./ 因为/ 在/ 序列/ l1/ ,/ …/ ,/ lm/ -/ 1/ 下/ L/ 用户/ 没有/ 不同/ 的/ 观察/ ,/ 所以/ 必然/ 有/ sn/ -/ x/ =/ …/ =/ sn/ -/ 1/ =/ sj/ -/ y/ =/ …/ =/ sj/ -/ 1/ ,/ sn/ =/ sj/ ,/ 路径/ sn/ →/ ε/ sn/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ u/ 与/ sj/ →/ ε/ sj/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ v/ 上/ 的/ 观察/ 函数/ 值/ 不/ 一样/ ./ 不妨/ 设/ 存在/ 0/ / i/ / u/ -/ 1/ 使得/ (/ sn/ +/ i/ ≠/ sn/ +/ i/ +/ 1/ )/ ,/ 任意/ 的/ 0/ / j/ </ i/ (/ sn/ +/ j/ =/ sn/ +/ j/ +/ 1/ )/ ./ 设/ s1/ →/ …/ →/ lm/ -/ 1sn/ -/ x/ →/ ε/ …/ →/ lmsn/ 中/ 的/ 引发/ 序列/ 为/ w1/ ,/ 在/ 输入/ 序列/ w1/ // H/ ,/ w1/ -/ w1/ // H/ 下/ 路径/ 为/ s1/ →/ l1/ …/ →/ lm/ -/ 1sm/ →/ lm/ …/ →/ ε/ sn/ ,/ 则/ 因为/ 在/ 序列/ l1/ ,/ …/ ,/ lm/ -/ 1/ 下/ L/ 用户/ 没有/ 不同/ 的/ 观察/ ,/ 所以/ sn/ =/ sn/ ./ 令/ Path1/ =/ s1/ →/ l1/ …/ →/ lm/ -/ 1sm/ →/ lmsm/ +/ 1/ →/ τ/ sm/ +/ 1/ ,/ Path2/ =/ s1/ →/ l1/ …/ →/ lm/ -/ 1sm/ →/ lmsm/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ →/ ε/ sn/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ i/ →/ ε/ sn/ +/ i/ +/ 1/ →/ τ/ sn/ +/ i/ +/ 1/ ./ 记/ Path2/ 上/ 的/ 输入/ 序列/ 为/ w/ ,/ 则/ Path1/ 上/ 的/ 输入/ 序列/ 为/ w/ // H/ ,/ 且/ L/ (/ w/ )/ ≠/ L/ (/ w/ // H/ )/ ./ 定理/ 2/ ./ PN/ 中/ 存在/ 隐蔽/ 信息流/ ,/ 当且/ 仅/ 当/ 在/ 同一/ 引发/ 序列/ 下/ L/ 用户/ 能/ 观察/ 到/ 不同/ 的/ 状态/ 转移/ 路径/ ./ 定理/ 2/ 直接/ 由/ 定理/ 1/ 和/ 引理/ 1/ 可得/ ./ 为/ 加深/ 对/ 定理/ 2/ 的/ 理解/ ,/ 我们/ 首先/ 讨论/ 空/ 输入/ 事件/ 下/ 的/ 状态/ 转移/ 情况/ ./ 设在/ s0/ ,/ L/ 状态/ 下/ ,/ H/ 用户/ 输入/ 事件/ 序列/ 为/ h1/ ,/ …/ ,/ hn/ ,/ 导致/ s0/ ,/ L/ →/ ε/ …/ →/ ε/ s1/ ,/ s0/ ,/ L/ ≠/ s1/ ./ 在/ 事件/ 序列/ h1/ ,/ …/ ,/ hn/ 没有/ 输入/ 的/ 情况/ 下/ ,/ L/ 用户/ 观察/ 到/ 的/ 是/ 初始状态/ 没有/ 变化/ ;/ 在/ 事件/ 序列/ h1/ ,/ …/ ,/ hn/ 输入/ 的/ 情况/ 下/ ,/ L/ 用户/ 观察/ 到/ 的/ 是/ 初始状态/ 发生/ 了/ 变化/ ./ 因此/ H/ 用户/ 可以/ 通过/ 是否/ 输入/ 事件/ 序列/ h1/ ,/ …/ ,/ hn/ 来/ 控制/ L/ 用户/ 的/ 观察/ ./ 下面/ 考虑/ 在/ 单个/ 输入/ 事件/ 下/ 的/ 状态/ 转移/ 情况/ ./ 设在/ s0/ ,/ L/ 状态/ 下/ ,/ L/ 用户/ 输入/ 事件/ 为/ l1/ ,/ H/ 用户/ 输入/ 事件/ 序列/ 为/ h1/ ,/ …/ ,/ hn/ ,/ 导致/ s0/ ,/ L/ →/ ε/ …/ →/ ε/ s1/ →/ l1s2/ →/ ε/ …/ →/ ε/ s3/ ,/ s2/ ≠/ s3/ ./ 设/ 当前/ 状态/ 为/ s2/ ,/ 在/ 事件/ 序列/ hx/ +/ 1/ ,/ …/ ,/ hn/ 没有/ 输入/ 的/ 情况/ 下/ ,/ L/ 用户/ 观察/ 到/ 的/ 是/ s2/ 没有/ 发生变化/ ;/ 在/ 事件/ 序列/ hx/ +/ 1/ ,/ …/ ,/ hn/ 输入/ 的/ 情况/ 下/ ,/ L/ 用户/ 观察/ 到/ 的/ 是/ s2/ 发生/ 了/ 变化/ ./ 因此/ H/ 用户/ 可以/ 通过/ 是否/ 输入/ 事件/ 序列/ hx/ +/ 1/ ,/ …/ ,/ hn/ 来/ 控制/ L/ 用户/ 的/ 观察/ ./ 多个/ 输入/ 事件/ 下/ 的/ 状态/ 转移/ 情况/ 考察/ ,/ 类似/ 于空/ 和/ 单个/ 输入/ 事件/ ,/ 这里/ 不再/ 赘述/ ./ 综上所述/ ,/ 在/ 同一/ 输入/ 下/ L/ 用户/ 能够/ 观察/ 到/ 不同/ 的/ 输出/ ,/ 也/ 就/ 能够/ 感受/ 到/ H/ 用户/ 对系统/ 行为/ 的/ 影响/ ,/ 也/ 就/ 能够/ 推导/ 出所/ 隐蔽/ 的/ 机密信息/ ;/ 反过来/ ,/ 若/ 对/ 任意/ 一个/ 输入/ ,/ L/ 用户/ 只能/ 观察/ 到/ 一种/ 输出/ (/ 一条/ 转移/ 路径/ ,/ 或者/ 所有/ 转移/ 路径/ 上/ 都/ 具有/ 相同/ 的/ 观察/ )/ ,/ H/ 用户/ 就/ 不能/ 影响/ 到/ L/ 用户/ 的/ 观察/ ,/ 也/ 就/ 不能/ 传递/ 机密信息/ ./ 4/ 隐蔽/ 信息流/ 的/ 判定/ 在/ 第/ 3/ 节中/ 已经/ 给出/ 了/ 隐蔽/ 信息流/ 存在/ 的/ 充分/ 必要条件/ ./ 因此/ 如何/ 有效/ 地/ 判定/ 该/ 条件/ 就/ 显得/ 尤为重要/ ,/ 这/ 一部分/ 我们/ 将/ 展示/ 如何/ 从/ PN/ 的/ 网/ 结构/ 和/ 动态/ 行为/ 两个/ 方面/ 进行/ 判定/ ./ 基于/ 网/ 结构/ 的/ 静态/ 判断/ 可以/ 非常/ 简便/ 地/ 发现/ PN/ 中/ 有没有/ 隐蔽/ 信息流/ ,/ 从而/ 尽早/ 地/ 引导/ PN/ 的/ 修改/ ./ 但/ 该/ 方法/ 是/ 不/ 完全/ 的/ ,/ 因此/ 对于/ 通过/ 网/ 结构/ 判断/ 的/ PN/ ,/ 还/ 需/ 运用/ 基于/ 可达图/ 的/ 动态/ 判定/ 方法/ ./ 动态/ 判定/ 是/ 完全/ 的/ ,/ 即/ 通过/ 该/ 判定/ 的/ PN/ ,/ 肯定/ 不/ 存在/ 隐蔽/ 信息流/ ./ 4.1/ 基于/ 网/ 结构/ 的/ 隐蔽/ 信息流/ 存在/ 性/ 判定/ PN/ 中/ 之所以/ 存在/ 隐蔽/ 信息流/ ,/ 是因为/ H/ 用户/ 的/ 动作/ 可以/ 影响/ L/ 用户/ 的/ 观察/ ,/ 这/ 反映/ 在/ PN/ 的/ 结构/ 上/ 就是/ TH/ 中/ 的/ 变迁/ 和/ TL/ 中/ 的/ 变迁/ 存在/ 某种/ 牵连/ 关系/ ./ 我们/ 主要/ 考虑/ 冲突/ 关系/ 和/ 因果关系/ ./ 定义/ 7/ (/ 冲突/ 关系/ )/ ./ 给定/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ ,/ 称/ PN/ 具有/ 冲突/ 关系/ 当且/ 仅/ 当/ / l/ ∈/ TL/ ,/ / h/ ∈/ TH/ 满足/ ·/ l/ ∩/ ·/ h/ ≠/ / 或者/ l/ ·/ ∩/ h/ ·/ ≠/ / ./ 定义/ 8/ (/ 因果关系/ )/ ./ 给定/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ ,/ 称/ PN/ 具有/ 因果关系/ 当且/ 仅/ 当/ / l/ ∈/ TL/ ,/ / h/ ∈/ TH/ 满足/ l/ ·/ ∩/ ·/ h/ ≠/ / 或者/ ·/ l/ ∩/ h/ ·/ ≠/ / ./ 为了/ 加深/ 对/ 冲突/ 、/ 因果关系/ 的/ 理解/ ,/ 我们/ 给出/ 了/ 几种/ 典型/ 的/ 冲突/ 结构/ (/ 如图/ 1/ (/ a/ )/ ,/ (/ b/ )/ )/ 和/ 因果/ 结构/ (/ 如图/ 1/ (/ c/ )/ ,/ (/ d/ )/ )/ ./ 冲突/ 关系/ 的/ 本质/ 在于/ 变迁/ h/ 的/ 引发/ 导致/ 变迁/ l/ 无法/ 引发/ ,/ 因果关系/ 的/ 本质/ 在于/ 变迁/ h/ 的/ 引发/ 导致/ 变迁/ l/ 可以/ 引发/ ,/ 这样/ 无论是/ 满足/ 冲突/ 关系/ 还是/ 因果关系/ ,/ H/ 都/ 可以/ 通过/ 是否/ 引发/ h/ 向/ L/ 用户/ 传递信息/ ./ Page6/ 图/ 1/ 几种/ 典型/ 的/ 冲突/ 和/ 因果关系/ 定理/ 3/ ./ 如果/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ 既/ 没有/ 冲突/ 关系/ ,/ 也/ 没有/ 因果关系/ ,/ 则/ PN/ 中/ 不/ 存在/ 隐蔽/ 信息流/ ./ 证明/ ./ 设/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ./ 由/ 定理/ 2/ ,/ 在/ PN/ 的/ L/ 可达图/ 中/ ,/ 存在/ 输入/ 变迁/ 序列/ σ/ =/ l1/ ,/ …/ ,/ lm/ ,/ 使得/ 在/ 该/ 序列/ 下/ ,/ L/ 用户/ 有/ 不同/ 的/ 观察/ Obs/ (/ Path1/ )/ ,/ Obs/ (/ Path2/ )/ ./ 由/ 观察/ 函数/ Obs/ 的/ 定义/ 可知/ ,/ 在/ 路径/ Path1/ 或者/ Path2/ 上必/ 存在/ 转换/ (/ s1/ →/ ε/ s2/ ∧/ s1/ ≠/ s2/ )/ ./ 在/ 状态/ s1/ ,/ s2/ 下/ ,/ L/ 用户/ 能够/ 观察/ 到/ 的/ 是/ Token/ 在/ PL/ 上/ 的/ 分布/ ./ s1/ ≠/ s2/ ,/ 所以/ 在/ 状态/ s1/ ,/ H/ 用户/ 的/ 输入/ 变迁/ h/ 的/ 引发/ 导致/ 了/ PL/ 上/ 的/ 分布/ 发生/ 了/ 变化/ ./ 由/ 变迁/ 引发/ 的/ 定义/ ,/ 必有/ ·/ h/ ∩/ PL/ ≠/ / ,/ 或者/ h/ ·/ ∩/ PL/ ≠/ / ./ 不妨/ 设/ l/ ∈/ {/ ·/ h/ ∩/ PL/ }/ ,/ 则/ 存在/ 变迁/ t/ ∈/ TL/ 使得/ l/ ∈/ ·/ t/ 或者/ l/ ∈/ t/ ·/ ./ 设/ l/ ∈/ ·/ t/ ,/ 则/ ·/ h/ ∩/ ·/ t/ ≠/ / ,/ 与/ PN/ 没有/ 冲突/ 关系/ 矛盾/ ./ 定理/ 3/ 也/ 可以/ 从/ 另外/ 一/ 角度/ 理解/ ./ PN/ 没有/ 冲突/ 关系/ ,/ 也/ 没有/ 因果关系/ ,/ 说明/ L/ 用户/ 和/ H/ 用户/ 之间/ 没有/ 传递信息/ 的/ 媒介/ ./ 没有/ 媒介/ ,/ 就/ 不/ 可能/ 有/ 信息/ 的/ 传递/ ./ 定理/ 4/ ./ 给定/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ ,/ (/ 1/ )/ 如果/ PN/ 满足/ 存在/ 变迁/ l/ ∈/ TL/ ,/ h/ ∈/ Th/ 使得/ (/ ·/ l/ ∩/ ·/ h/ ≠/ / )/ ,/ h/ 具有/ L1/ 活性/ ,/ 则/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ;/ (/ 2/ )/ 如果/ PN/ 满足/ 存在/ 变迁/ l/ ∈/ TL/ ,/ h/ ∈/ Th/ 使得/ (/ l/ ·/ ∩/ h/ ·/ ≠/ / )/ ,/ h/ 具有/ L1/ 活性/ ,/ 则/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ;/ (/ 3/ )/ 如果/ PN/ 满足/ 存在/ 变迁/ l/ ∈/ TL/ ,/ h/ ∈/ Th/ 使得/ (/ l/ ·/ ∩/ ·/ h/ ≠/ / )/ ,/ l/ ,/ h/ 具有/ L1/ 活性/ ,/ 则/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ;/ (/ 4/ )/ 如果/ PN/ 满足/ 存在/ 变迁/ l/ ∈/ TL/ ,/ h/ ∈/ Th/ 使得/ (/ h/ ·/ ∩/ ·/ l/ ≠/ / )/ ,/ l/ ,/ h/ 具有/ L1/ 活性/ ,/ 则/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ./ 证明/ ./ 我们/ 只/ 证明/ 该/ 定理/ 中/ 的/ 第一个/ 结论/ ,/ 其它/ 结论/ 的/ 证明/ 与/ 该/ 结论/ 的/ 证明/ 类似/ ./ 变迁/ h/ 具有/ L1/ 活性/ ,/ 因此/ 在/ PN/ 的/ 可达图/ RS/ 中/ 存在/ 路径/ s0/ →/ / s1/ ,/ 且/ 在/ 状态/ s1/ 下/ h/ 是/ 使/ 能/ 的/ ./ 设/ s0/ →/ / s1/ 中/ ,/ L/ 用户/ 的/ 输入/ 序列/ 为/ l1/ ,/ …/ ,/ lm/ ./ 因为/ 在/ 状态/ s1/ 下/ h/ 是/ 使/ 能/ 的/ ,/ H/ 用户/ 可以/ 决定/ 引/ 不/ 引发/ h/ ./ 因此/ 在/ l1/ ,/ …/ ,/ lm/ 下/ 至少/ 可以/ 观察/ 到/ 两条/ 转移/ 路径/ s0/ ↓/ PL/ →/ / s1/ ↓/ PL/ 和/ s0/ ↓/ PL/ →/ / s1/ ↓/ PL/ →/ ε/ s2/ ↓/ PL/ ,/ 且/ Obs/ (/ s0/ ↓/ PL/ →/ / s1/ ↓/ PL/ )/ ≠/ Obs/ (/ s0/ ↓/ PL/ →/ / s1/ ↓/ PL/ →/ ε/ s2/ ↓/ PL/ )/ ./ 由/ 定理/ 2/ ,/ 可知/ PN/ 中/ 存在/ 隐蔽/ 信息流/ ./ 定理/ 3/ 和/ 4/ 说明/ ,/ 在/ 系统/ 的/ 设计阶段/ 应/ 尽量少/ 用/ 这/ 两种/ 结构/ ,/ 从而/ 使得/ 由/ 此类/ 结构/ 引起/ 的/ 隐蔽/ 信息流/ 在/ 系统/ 的/ 设计阶段/ 得以/ 避免/ ./ 另外/ ,/ 从/ 定理/ 4/ 可以/ 看出/ 隐蔽/ 信息流/ 的/ 存在/ 依赖于/ PN/ 的/ 初始状态/ M0/ ./ 以图/ 1/ (/ a/ )/ 结构/ 为例/ ,/ 设在/ 某个/ 初始状态/ M0/ 下/ ,/ 变迁/ l/ 无法/ 被/ 引发/ ,/ 进而/ h/ 也/ 不/ 可能/ 被/ 引发/ ./ 这样/ H/ 就/ 不能/ 通过/ 是否/ 引发/ 变迁/ h/ 来/ 传递信息/ ./ 4.2/ 基于/ 可达图/ 的/ 隐蔽/ 信息流/ 存在/ 性/ 判定/ 定理/ 5/ ./ Petri/ 网/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ 中/ 存在/ 隐蔽/ 信息流/ 当且/ 仅/ 当/ 其/ L/ 可达图/ L/ -/ RS/ (/ SL/ ,/ s0/ ,/ L/ ,/ RL/ )/ 满足/ :/ i/ ∈/ {/ 1/ ,/ …/ ,/ n/ -/ 1/ }/ (/ (/ s1/ →/ ε/ s2/ →/ ε/ …/ →/ ε/ sn/ )/ ∧/ (/ si/ ≠/ si/ +/ 1/ )/ )/ )/ 证明/ ./ (/ / )/ 设/ PN/ 存在/ 隐蔽/ 信息流/ ./ 通过/ 对/ L/ 用户/ 引发/ 序列/ 的/ 长度/ 进行/ 归纳/ 来/ 证明/ 该/ 充分条件/ ./ (/ 1/ )/ 设/ 引发/ 序列/ 的/ 长度/ 为/ 0/ ,/ 由/ 定理/ 2/ 可知/ 存在/ 路径/ Path1/ =/ s0/ ,/ L/ →/ ε/ …/ →/ ε/ s/ ,/ Path2/ =/ s0/ ,/ L/ →/ ε/ …/ →/ ε/ s/ 满足/ Obs/ (/ Path1/ )/ ≠/ Obs/ (/ Path2/ )/ ./ 因为/ Path1/ 与/ Path2/ 的/ 初始状态/ 相同/ ,/ 所以/ 在/ 路径/ Path1/ 或者/ Path2/ 上/ 必然/ 存在/ 状态/ sx/ 使得/ sx/ ≠/ sx/ +/ 1/ ./ 不妨/ 设/ sx/ 在/ 路径/ Path1/ 上/ ,/ 则/ Path1/ 满足条件/ (/ 2/ )/ ./ (/ 2/ )/ 设在/ 输入/ 序列/ 长度/ 为/ m/ -/ 1/ (/ m/ / 1/ )/ 时/ 结论/ 成立/ ./ (/ 3/ )/ 设在/ 输入/ 序列/ l1/ ,/ …/ ,/ lm/ ∈/ TL/ 下/ L/ 用户/ 有/ 不同/ 的/ 观察/ ,/ 且/ 在/ l1/ ,/ …/ ,/ lm/ -/ 1/ 下/ L/ 用户/ 没有/ 不同/ 的/ 观察/ ./ 不妨/ 设/ 两个/ 观察/ 为/ s1/ →/ …/ →/ lm/ -/ 1sn/ -/ x/ →/ …/ →/ lmsn/ →/ ε/ sn/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ u/ ,/ s1/ →/ …/ →/ lm/ -/ 1sj/ -/ y/ →/ …/ →/ lmsj/ →/ ε/ sj/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ v/ ./ 因为/ 在/ 序列/ l1/ ,/ …/ ,/ lm/ -/ 1/ 下/ L/ 用户/ 没有/ 不同/ 的/ 观察/ ,/ 所以/ 必然/ 有/ sn/ -/ x/ =/ …/ =/ sn/ -/ 1/ =/ sj/ -/ y/ =/ …/ =/ sj/ -/ 1/ ./ 再/ 由于/ lm/ 的/ 引发/ 和/ 引发/ 所/ 导致/ 的/ 状态/ 变化/ 只/ Page7/ 涉及/ 到/ ·/ lm/ ,/ lm/ 样/ ,/ 观察/ 不同/ 体现/ 在/ sn/ →/ ε/ sn/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ u/ 与/ sj/ →/ ε/ sj/ +/ 1/ →/ ε/ …/ →/ ε/ sn/ +/ v/ 上/ ,/ 因此/ 下面/ 的/ 两种/ 情况/ 必有/ 一个/ 成立/ :/ (/ a/ )/ / e/ ∈/ {/ 0/ ,/ …/ ,/ u/ -/ 1/ }/ (/ se/ ≠/ se/ +/ 1/ )/ ;/ (/ b/ )/ / e/ ∈/ {/ 0/ ,/ …/ ,/ v/ -/ 1/ }/ (/ se/ ≠/ se/ +/ 1/ )/ ./ 无论/ 哪/ 种/ 情况/ 成立/ ,/ 均/ 有式/ (/ 2/ )/ 成立/ ./ (/ / )/ 设/ / n/ ∈/ N/ (/ s1/ ∈/ SL/ ,/ …/ ,/ sn/ ∈/ SL/ ,/ i/ ∈/ {/ 1/ ,/ …/ ,/ n/ -/ 1/ }/ (/ (/ s1/ →/ ε/ s2/ →/ ε/ …/ →/ ε/ sn/ )/ ∧/ (/ si/ ≠/ si/ +/ 1/ )/ )/ )/ 成立/ ./ 因为/ s1/ ∈/ SL/ ,/ 所以/ 存在/ 从/ 初始状态/ s0/ ,/ L/ 到/ s1/ 的/ 转移/ 路径/ s0/ ,/ L/ →/ / s1/ ,/ 不妨/ 设该/ 转移/ 路径/ 上/ 的/ L/ 用户/ 引发/ 序列/ 为/ l1/ ,/ …/ ,/ lm/ ./ 则/ 由/ 观察/ 的/ 定义/ Obs/ (/ s0/ ,/ L/ →/ / s1/ )/ ≠/ Obs/ (/ s0/ ,/ L/ →/ / s1/ →/ ε/ …/ si/ →/ ε/ si/ +/ 1/ )/ ,/ 即/ 在/ 输入/ 序列/ l1/ ,/ …/ ,/ lm/ 下/ ,/ L/ 用户/ 有/ 不同/ 的/ 观察/ ./ 定理/ 5/ 表明/ ,/ 隐蔽/ 信息流/ 存在/ 的/ 关键在于/ ,/ 在/ PN/ 的/ 可达图/ 中/ 存在/ 引发/ s/ →/ hs/ 满足/ s/ ↓/ PL/ ≠/ s/ ↓/ PL/ ./ 因此/ 有/ 下面/ 的/ 推论/ ./ 推论/ 1/ ./ Petri/ 网/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ 中/ 存在/ 隐蔽/ 信息流/ 当且/ 仅/ 当/ 其/ L/ 可达图/ L/ -/ RS/ (/ SL/ ,/ s0/ ,/ L/ ,/ RL/ )/ 满足/ :/ / s1/ ∈/ SL/ ,/ s2/ ∈/ SL/ (/ s1/ →/ ε/ s2/ ∧/ s1/ ≠/ s2/ )/ (/ 3/ )/ 4.3/ 隐蔽/ 信息流/ 的/ on/ -/ the/ -/ fly/ 判定/ 计算/ 复杂/ 系统/ 的/ 全局/ 可达图/ 是/ 一件/ 十分困难/ 的/ 事情/ ,/ 如何/ 避免/ 计算/ PN/ 的/ 全局/ 可达图/ 对/ 提高/ 隐蔽/ 信息流/ 的/ 判定/ 至关重要/ ./ 这一/ 小节/ ,/ 我们/ 将/ 探讨/ 如何/ 在/ 计算/ PN/ 可达图/ 的/ 过程/ 中/ 判定/ 隐蔽/ 信息流/ 的/ 存在/ 性/ ./ 由/ 推论/ 1/ 可知/ ,/ 隐蔽/ 信息流/ 的/ 判定/ 关键在于/ 检测/ H/ 用户/ 的/ 输入/ 变迁/ 有没有/ 引起/ Token/ 在/ PL/ 上/ 的/ 分布/ 变化/ ./ 而/ 分布/ 变化/ 可以/ 通过/ 比较/ 相连/ 状态/ 在/ PL/ 上/ 的/ 值/ 是否/ 相等/ 来/ 判断/ ./ 算法/ 的/ 基本/ 思想/ 是/ 采用/ 深度/ 优先/ 搜索/ 策略/ 计算/ PN/ 的/ 可达图/ ,/ 在/ 计算/ 可达图/ 的/ 过程/ 通过/ 比较/ 相连/ 状态/ 在/ PL/ 上/ 的/ 值/ 是否/ 相等/ 来/ 完成/ 隐蔽/ 信息流/ 存在/ 性/ 的/ 判定/ ./ 设/ s/ 为/ 当前/ 状态/ ,/ 状态/ s/ 是/ 在/ s/ 下/ 通过/ 引发/ t/ ∈/ T/ 而/ 得到/ 的/ s/ 的/ 后继/ ./ 如果/ t/ ∈/ TH/ 且/ s/ ↓/ PL/ ≠/ s/ ↓/ PL/ ,/ 则/ 断定/ 隐蔽/ 信息流/ 存在/ ,/ 否则/ 继续/ 计算/ s/ 的/ 后继/ ./ 具体/ 的/ 判定/ 过程/ 如下/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ Petri/ 网中/ 的/ 隐蔽/ 信息流/ 判定/ 算法/ ./ 输入/ :/ Petri/ 网/ PN/ =/ (/ P/ ,/ TL/ ,/ TH/ ,/ F/ ,/ M0/ )/ 输出/ :/ PN/ 中/ 是否/ 存在/ 隐蔽/ 信息流/ Main/ (/ )/ {/ 初始化/ :/ 置栈/ stack/ 为空/ ;/ Search/ (/ M0/ )/ }/ ProcedureSearch/ (/ s/ )/ {/ Enabled/ (/ s/ )/ =/ / ;/ While/ (/ Enabled/ (/ s/ )/ ≠/ Enable/ (/ s/ )/ )/ {/ 在/ 集合/ Enable/ (/ s/ )/ -/ Enabled/ (/ s/ )/ 中/ 选择/ 变迁/ t/ ;/ s/ =/ fire/ (/ s/ ,/ t/ )/ ;/ 如果/ t/ ∈/ TH/ 且/ s/ ↓/ PL/ ≠/ s/ ↓/ PL/ ,/ 则/ 输出/ :/ 隐蔽/ 信息流/ 存/ Enabled/ (/ s/ )/ =/ Enabled/ (/ s/ )/ ∪/ {/ t/ }/ ;/ 将/ s/ 压入/ 栈/ stack/ ;/ Search/ (/ s/ )/ ;/ }/ 检查/ 栈/ 是否/ 为空/ ,/ 如果/ 为空/ ,/ 则/ 输出/ :/ 隐蔽/ 信息流/ 不/ 从/ stack/ 中/ 取出/ 栈顶/ 元素/ s/ ;/ Search/ (/ s/ )/ ;/ }/ 算法/ 1/ 中/ 的/ Enable/ (/ s/ )/ 表示/ 在/ 状态/ s/ 下/ 使/ 能/ 的/ 变迁/ 集合/ ,/ s/ =/ fire/ (/ s/ ,/ t/ )/ 表示/ s/ 的/ 计算/ 按照/ 2.1/ 节中/ 的/ 式/ (/ 1/ )/ 计算/ ./ 另外/ ,/ PN/ 是/ 1/ 界/ 的/ ,/ 所以/ 算法/ 肯定/ 会/ 终止/ ./ 4.4/ 示例/ 这一/ 小节/ 我们/ 通过/ 一个/ 简单/ 的/ 隐/ 通道/ 示例/ 来/ 说明/ Petri/ 网中/ 隐蔽/ 信息流/ 的/ 标识/ ./ 限制/ 进程/ p/ 不能/ 与/ 进程/ q/ 通信/ ./ 然而/ ,/ 进程/ p/ 和/ q/ 共享/ 一个/ 临界/ 区/ ,/ 且/ 对/ 临界/ 区均/ 具有/ 写/ 的/ 能力/ ./ 进程/ p/ 和/ q/ 对/ 临界/ 区/ 的/ 写访问/ 满足/ 进程/ 间/ 的/ 互斥/ 关系/ ./ 进程/ p/ 通过/ 周期性/ 的/ 对/ 临界/ 区/ 执行/ 写/ 操作/ 可以/ 向/ 进程/ q/ 传递信息/ ,/ 比如/ 在/ 某个/ 周期/ ,/ 进程/ p/ 对/ 临界/ 区/ 执行/ 写/ 操作/ ,/ 此时/ 进程/ q/ 就/ 不能/ 对/ 临界/ 区/ 执行/ 写/ 操作/ ,/ 这样/ p/ 和/ q/ 依据/ 事先/ 约定/ 的/ 方式/ ,/ q/ 可/ 认为/ p/ 向/ 传递/ 了/ 一个/ 位/ 信息/ 0/ ;/ 相反/ 如果/ 进程/ q/ 可以/ 对/ 临界/ 区/ 执行/ 写/ 操作/ ,/ q/ 可/ 认为/ p/ 向/ 传递/ 了/ 一个/ 位/ 信息/ 1/ ./ 图/ 2/ (/ a/ )/ 是/ 进程/ p/ 和/ q/ 对/ 临界/ 区/ 进行/ 访问/ 的/ 一个/ 抽象/ 模型/ ,/ 其中/ h1/ 表示/ 进程/ p/ 对/ 临界/ 区/ 执行/ 写/ 操作/ ,/ h2/ 表示/ 进程/ p/ 退出/ 访问/ ,/ l1/ 表示/ 进程/ q/ 对/ 临界/ 区/ 执行/ 写/ 操作/ ,/ l2/ 表示/ 进程/ q/ 退出/ 访问/ ,/ p2/ 是/ 临界/ 区/ 是否/ 在/ 执行/ 写/ 操作/ 的/ 标记/ ,/ p3/ ,/ p5/ 是/ 进程/ p/ 对/ 临界/ 区/ 执行/ 写/ 操作/ 的/ 标记/ ,/ p1/ ,/ p4/ 是/ 进程/ q/ 对/ 临界/ 区/ 执行/ 写/ 操作/ 的/ 标记/ ./ 现在/ 依据/ 算法/ 1/ 标识/ PN1/ 中/ 的/ 隐蔽/ 信/ Page8/ 息流/ ./ 首先/ 计算/ PN1/ 的/ 可达图/ ,/ 如图/ 2/ (/ b/ )/ 所示/ ,/ 依据/ 算法/ 1/ ,/ 在/ 计算/ 的/ 过程/ 中/ 发现/ 变迁/ h1/ 的/ 引发/ 导致/ s0/ ↓/ PL/ ≠/ s2/ ↓/ PL/ ,/ 因此/ PN1/ 中/ 存在/ 隐蔽/ 信息流/ ./ 5/ 系统/ 组合/ 下/ 的/ 隐蔽/ 信息流/ 分析/ 大规模/ 复杂/ 系统/ 的/ 分析/ 与/ 验证/ 是/ 经常/ 遇到/ 的/ 难题/ ./ 通过/ 一些/ 较为简单/ 的/ 小/ 系统/ 利用/ 某种/ 运算/ 或/ 组合/ 而/ 得到/ 较为/ 复杂/ 的/ 系统/ ,/ 且/ 在/ 组合/ 过程/ 中/ 保持/ 某些/ 性质/ 不变/ ,/ 对于/ 分析/ 复杂/ 系统/ 提供/ 了/ 很/ 好/ 的/ 途径/ ./ 假设/ 单个/ TCB/ 的/ 隐蔽/ 信息流/ 分析/ 已经/ 完毕/ ,/ 安全/ 系统/ 由/ 多个/ TCB/ 组合而成/ ./ 下面/ 讨论/ 各种/ 组合/ 方式/ (/ 连接/ 、/ 选择/ 、/ 循环/ 、/ 并行/ 、/ 共享/ 合成/ 、/ 同步/ 合成/ )/ 对系统/ 安全性/ 的/ 影响/ ./ 为/ 讨论/ 方便/ ,/ 我们/ 先/ 引入/ 标准/ Petri/ 网/ 的/ 概念/ ./ 文献/ [/ 16/ ]/ 指出/ 任何/ 一个/ Petri/ 网都/ 可以/ 由/ 一个/ 标准/ 的/ Petri/ 网/ 产生/ ./ 这样/ ,/ 讨论/ 连接/ 、/ 选择/ 、/ 循环/ 、/ 并行/ 合成/ 方式/ 对/ 安全性/ 的/ 影响/ 可以/ 直接/ 在/ 标准/ Petri/ 网上/ 进行/ ./ 定义/ 9/ (/ 标准/ Petri/ 网/ )/ ./ 一个/ 标准/ Petri/ 网是/ 一个/ 六元/ 组/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ ,/ 这里/ :/ (/ 1/ )/ P/ ,/ T/ ,/ F/ 与/ 定义/ 1/ 中/ 一样/ ;/ (/ 2/ )/ i/ ,/ o/ 满足/ :/ i/ ,/ o/ ∈/ P/ ∧/ ·/ i/ =/ / ∧/ o/ ·/ =/ / ;/ (/ 3/ )/ M0/ 满足/ :/ M0/ (/ i/ )/ =/ 1/ ,/ / p/ ∈/ P/ \/ {/ i/ }/ (/ M0/ (/ p/ )/ =/ 0/ )/ ;/ (/ 4/ )/ / x/ ∈/ P/ ∪/ T/ :/ (/ i/ ,/ x/ )/ ∈/ F/ / ∧/ (/ x/ ,/ o/ )/ ∈/ F/ / ,/ 其中/ F/ / 表示/ F/ 的/ 自反/ 传递/ 闭包/ ./ 为/ 讨论/ 方便/ ,/ 事先/ 引入/ 几个/ 约定/ :/ (/ 1/ )/ 引入/ 记号/ TL/ (/ PN/ )/ ,/ TH/ (/ PN/ )/ 分别/ 表示/ PN/ 中/ L/ 用户/ ,/ H/ 用户/ 的/ 输入/ 事件/ 集合/ ;/ (/ 2/ )/ 无论/ PN/ 由/ PN1/ ,/ PN2/ 以/ 何种/ 方式/ 合成/ 所得/ ,/ 均/ 有/ TL/ (/ PN1/ )/ ∪/ TL/ (/ PN2/ )/ / TL/ (/ PN/ )/ ,/ TH/ (/ PN1/ )/ ∪/ TH/ (/ PN2/ )/ / TH/ (/ PN/ )/ ;/ (/ 3/ )/ PL/ (/ PN/ )/ =/ {/ ·/ t/ ∪/ t/ ·/ |/ t/ ∈/ TL/ (/ PN1/ )/ ∨/ t/ ∈/ TL/ (/ PN2/ )/ }/ ;/ (/ 4/ )/ 下面/ 涉及/ 到/ 的/ 任意/ 标准/ Petri/ 网/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ ,/ 均/ 有/ i/ ,/ o/ ∈/ PL/ (/ PN/ )/ ./ 定义/ 10/ (/ Petri/ 网/ 的/ 顺序/ 合成/ ,/ 如图/ 3/ )/ [/ 17/ -/ 18/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ ,/ i1/ ,/ o1/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ ,/ i2/ ,/ o2/ )/ 为/ 标准/ Petri/ 网/ ,/ 满足/ P1/ ∩/ P2/ =/ / ,/ T1/ ∩/ T2/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ,/ T/ =/ T1/ ∪/ T2/ ∪/ {/ t/ }/ ,/ t/ ∈/ TL/ (/ PN/ )/ ,/ F/ =/ F1/ ∪/ F2/ ∪/ {/ (/ o1/ ,/ t/ )/ ,/ (/ t/ ,/ i2/ )/ }/ ,/ i/ =/ i1/ ,/ o/ =/ o2/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 顺序/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ ·/ PN2/ ./ 定理/ 6/ ./ 如果/ PN1/ 与/ PN2/ 中/ 没有/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ ·/ PN2/ 中/ 也/ 没有/ 隐蔽/ 信息流/ ./ 证明/ ./ 设/ PN/ 存在/ 隐蔽/ 信息流/ ,/ 则/ 由/ 定理/ 5/ 在/ PN/ 的/ 可达图/ 中/ 存在/ 从/ 初始状态/ s0/ 出发/ 的/ 路径/ Path1/ =/ s0/ →/ t1s1/ →/ t2/ …/ →/ tnsn/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 因为/ PN1/ 中/ 没有/ 隐蔽/ 信息流/ ,/ 所以/ t/ 必然/ 出现/ 在/ Path1/ 中/ ,/ 且/ / 0/ / i/ </ n/ (/ si/ ↓/ PL/ (/ PN1/ )/ =/ si/ +/ 1/ ↓/ PL/ (/ PN1/ )/ )/ ./ 不妨/ 设/ t/ =/ ti/ ,/ 则/ PN2/ 在/ 输入/ ti/ +/ 1/ ,/ …/ ,/ tn/ 下/ ,/ L/ 用户/ 观察/ 到/ 路径/ si/ +/ 1/ ↓/ PL/ (/ PN/ )/ →/ tI/ +/ 1/ …/ →/ tnsn/ ↓/ PL/ (/ PN/ )/ ./ 因为/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ =/ sn/ ↓/ PL/ (/ PN1/ )/ ,/ 所以/ sn/ -/ 1/ ↓/ PL/ (/ PN2/ )/ ≠/ sn/ ↓/ PL/ (/ PN2/ )/ ,/ 由/ 定理/ 5/ 这/ 与/ PN2/ 中/ 没有/ 隐蔽/ 信息流/ 是/ 矛盾/ 的/ ./ 定义/ 11/ (/ Petri/ 网/ 的/ 循环/ 合成/ ,/ 如图/ 4/ )/ [/ 17/ -/ 18/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ ,/ i1/ ,/ o1/ )/ 为/ 标准/ Petri/ 网/ ,/ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ 满足/ P/ =/ P1/ ∪/ {/ i/ ,/ o/ }/ ,/ F/ =/ F1/ ∪/ {/ (/ i/ ,/ t1/ )/ ,/ (/ t1/ ,/ i1/ )/ ,/ (/ o1/ ,/ t2/ )/ ,/ (/ t2/ ,/ o/ )/ ,/ (/ o1/ ,/ t3/ )/ ,/ (/ t3/ ,/ i1/ )/ }/ ,/ {/ t1/ ,/ t2/ ,/ t3/ }/ / TL/ (/ PN/ )/ ,/ T/ =/ T1/ ∪/ {/ t1/ ,/ t2/ ,/ t3/ }/ ,/ 则/ 称/ PN/ 为/ PN1/ 上/ 的/ 循环/ 合成/ 网/ ,/ 记为/ PN/ =/ PN/ / 1/ ./ 定理/ 7/ ./ 如果/ PN1/ 没有/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN/ / 1/ 中/ 也/ 没有/ 隐蔽/ 信息流/ ./ 证明/ ./ 设/ PN/ 存在/ 隐蔽/ 信息流/ ./ 在/ 初始状态/ 下/ 只有/ t1/ 可以/ 被/ 引发/ ,/ 且/ t1/ ∈/ TL/ (/ PN/ )/ ,/ 所以/ 在/ 空/ 输入/ 变迁/ 序列/ 下/ ,/ L/ 无法/ 观察/ 到/ 这样/ 的/ 路径/ :/ s0/ →/ ε/ s1/ →/ ε/ …/ →/ ε/ sn/ (/ n/ / 1/ )/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 不妨/ 设在/ 输入/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ (/ n/ / 1/ )/ 下/ 导致/ 的/ 路径/ Path/ =/ s0/ →/ t1s1/ →/ t1TH/ (/ PN/ )/ ./ 如果/ t2/ 出现/ 在/ σ/ 中/ ,/ 由/ PN/ 的/ 网/ 结构/ 可以/ 断定/ t2/ =/ tn/ ,/ 与/ tn/ ∈/ TH/ (/ PN/ )/ 矛盾/ ,/ 所以/ t2/ 不会/ 出现/ 在/ σ/ 中/ ./ 另外/ ,/ PN1/ 没有/ 隐蔽/ 信息流/ ,/ 所以/ t3/ 一定/ 出现/ 在/ σ/ 中/ ,/ 不妨/ 假设/ tj1/ =/ …/ =/ tjk/ =/ t3/ ./ 将/ t2/ ,/ …/ ,/ tn/ 分成/ :/ σ/ 1/ =/ t2/ ,/ …/ ,/ tj1/ -/ 1/ ,/ …/ ,/ σ/ k/ +/ 1/ =/ tjk/ +/ 1/ ,/ …/ ,/ tn/ ./ 变迁/ t3/ 引发/ 造成/ 的/ 后果/ 是/ 使/ PN1/ 回到/ 了/ 初始状态/ ./ 因此/ ,/ 每/ 一个/ σ/ i/ (/ 1/ / i/ / k/ +/ 1/ )/ 均/ 可以/ 在/ PN1/ 中/ 引发/ ,/ 且/ 在/ σ/ k/ +/ 1/ =/ Page9tjk/ +/ 1/ ,/ …/ ,/ tn/ 下/ 导致/ 的/ 路径/ Path1/ =/ s0/ →/ tjk/ +/ 1sjk/ +/ 1/ →/ tjk/ +/ 2/ …/ →/ tnsn/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ,/ 这/ 与/ PN1/ 没有/ 隐蔽/ 信息流/ 矛盾/ ./ 定义/ 12/ (/ Petri/ 网/ 的/ 选择/ 合成/ ,/ 如图/ 5/ (/ a/ )/ )/ [/ 17/ -/ 18/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ ,/ i1/ ,/ o1/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ ,/ i2/ ,/ o2/ )/ 为/ 标准/ Petri/ 网/ ,/ 满足/ P1/ ∩/ P2/ =/ / ,/ 图/ 5Petri/ 网/ 的/ 合成/ 定理/ 8/ ./ 如果/ PN1/ 与/ PN2/ 中/ 没有/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ +/ PN2/ 中/ 也/ 没有/ 隐蔽/ 信息流/ ./ 证明/ ./ 在/ 初始状态/ 下/ 只有/ t1/ ,/ t3/ 可以/ 被/ 引发/ ,/ 且/ t1/ ,/ t3/ ∈/ TL/ (/ PN/ )/ ,/ 所以/ 在/ 空/ 输入/ 变迁/ 序列/ 下/ ,/ L/ 无法/ 观察/ 到/ 不同/ 的/ 状态/ 转移/ 路径/ ./ 设在/ 序列/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ 下/ ,/ L/ 用户/ 观察/ 到/ 路径/ Path1/ =/ s0/ →/ ε/ s1/ →/ ε/ …/ →/ ε/ sn/ (/ n/ / 2/ )/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 从/ PN/ 的/ 结构/ 上/ 可以/ 看出/ t1/ =/ t1/ 或者/ t1/ =/ t3/ ,/ 不妨/ 设/ t1/ =/ t1/ ./ 当/ t1/ 引发/ 以后/ ,/ PN/ 就/ 按照/ PN1/ 的/ 运行/ 轨迹/ 运行/ ,/ 因此/ 在/ PN1/ 中/ 存在/ 路径/ Path2/ =/ s1/ →/ ε/ …/ →/ ε/ sn/ (/ n/ / 2/ )/ 且/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ ≠/ sn/ ↓/ PL/ (/ PN1/ )/ ,/ 这/ 与/ PN1/ 中/ 没有/ 隐蔽/ 信息流/ 矛盾/ ./ 定义/ 13/ (/ Petri/ 网/ 的/ 并行/ 合成/ ,/ 如图/ 5/ (/ b/ )/ )/ [/ 17/ -/ 18/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ ,/ i1/ ,/ o1/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ ,/ i2/ ,/ o2/ )/ 为/ 标准/ Petri/ 网/ ,/ 满足/ P1/ ∩/ P2/ =/ / ,/ T1/ ∩/ T2/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ∪/ {/ i/ ,/ o/ }/ ,/ T/ =/ T1/ ∪/ T2/ ∪/ {/ t1/ ,/ t2/ }/ ,/ F/ =/ F1/ ∪/ F2/ ∪/ {/ (/ i/ ,/ t1/ )/ ,/ (/ t1/ ,/ i1/ )/ ,/ (/ o1/ ,/ t2/ )/ ,/ (/ t2/ ,/ o/ )/ ,/ (/ t1/ ,/ i2/ )/ ,/ (/ o2/ ,/ t2/ )/ }/ ,/ {/ t1/ ,/ t2/ }/ / TL/ (/ PN/ )/ ,/ i/ =/ i1/ ,/ o/ =/ o2/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 并行/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ ∥/ PN2/ ./ 定理/ 9/ ./ 如果/ PN1/ 与/ PN2/ 中/ 没有/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ ∥/ PN2/ 中/ 也/ 没有/ 隐蔽/ 信息流/ ./ 证明/ ./ 设在/ 序列/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ 下/ ,/ L/ 用户/ 观察/ 到/ 路径/ Path1/ =/ s0/ →/ ε/ s1/ →/ ε/ …/ →/ ε/ sn/ (/ n/ / 1/ )/ ,/ 且/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 从/ PN/ 的/ 结构/ 上/ 可以/ 看出/ ,/ 可以/ 将/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ 分别/ 投影/ 在/ {/ t1/ ,/ t2/ }/ ∪/ T1/ 和/ {/ t1/ ,/ t2/ }/ ∪/ T2/ 上/ ,/ 分别/ 将/ 投影/ 记/ 为/ σ/ 1/ ,/ σ/ 2/ ./ 从/ PN/ 的/ 结构/ 还/ 可以/ 断定/ ,/ σ/ 1/ ,/ σ/ 2/ 的/ 运行/ 互不/ 干扰/ ,/ 因此/ 必有/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ ≠/ sn/ ↓/ PL/ (/ PN1/ )/ 或者/ sn/ -/ 1/ ↓/ PL/ (/ PN2/ )/ ≠/ sn/ ↓/ PL/ (/ PN2/ )/ ./ 无论/ 哪/ 种/ 情况/ 成立/ ,/ 与/ PN1/ ,/ PN2/ 中/ 没/ T1/ ∩/ T2/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ ,/ i/ ,/ o/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ∪/ {/ i/ ,/ o/ }/ ,/ T/ =/ T1/ ∪/ T2/ ∪/ {/ t1/ ,/ t2/ ,/ t3/ ,/ t4/ }/ ,/ F/ =/ F1/ ∪/ F2/ ∪/ {/ (/ i/ ,/ t1/ )/ ,/ (/ t1/ ,/ i1/ )/ ,/ (/ o1/ ,/ t2/ )/ ,/ (/ t2/ ,/ o/ )/ ,/ (/ i/ ,/ t3/ )/ ,/ (/ t3/ ,/ i2/ )/ ,/ (/ o2/ ,/ t4/ )/ ,/ (/ t4/ ,/ o/ )/ }/ ,/ {/ t1/ ,/ t2/ ,/ t3/ ,/ t4/ }/ / TL/ (/ PN/ )/ ,/ i/ =/ i1/ ,/ o/ =/ o2/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 冲突/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ +/ PN2/ ./ 有/ 隐蔽/ 信息流/ 矛盾/ ./ 下面/ 我们/ 讨论/ 共享/ 合成/ 与/ 同步/ 合成/ 对/ 隐蔽/ 信息流/ 的/ 影响/ ,/ 为/ 讨论/ 的/ 方便/ 采取/ 的/ Petri/ 形式/ 为/ 定义/ 1/ 中/ 给出/ 的/ 四元组/ 形式/ ./ 定义/ 14/ (/ 共享/ 合成/ ,/ 如图/ 6/ )/ [/ 19/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ )/ 为/ Petri/ 网/ ,/ 满足/ P1/ ∩/ P2/ ≠/ / ,/ T1/ ∩/ T2/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ,/ T/ =/ T1/ ∪/ T2/ ,/ F/ =/ F1/ ∪/ F2/ ,/ 若/ p/ ∈/ P1/ ∩/ P2/ ,/ M0/ (/ p/ )/ =/ max/ {/ M01/ (/ p/ )/ ,/ M02/ (/ p/ )/ }/ ,/ 若/ p/ ∈/ Pi/ -/ (/ P1/ ∩/ P2/ )/ ,/ M0/ (/ p/ )/ =/ M0i/ (/ p/ )/ (/ i/ ∈/ {/ 1/ ,/ 2/ }/ )/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 共享/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ Δ/ PN2/ ./ 定理/ 10/ ./ 如果/ PN1/ 与/ PN2/ 中/ 不/ 存在/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ Δ/ PN2/ 中/ 可能/ 存在/ 隐蔽/ 信息流/ ./ 图/ 6/ (/ c/ )/ 中/ 的/ Petri/ 网是/ 由/ 图/ 6/ (/ a/ )/ ,/ 图/ 6/ (/ b/ )/ 通过/ 共享/ 合成/ 而/ 得/ ./ 图/ 6/ (/ a/ )/ 中/ 没有/ L/ 用户/ ,/ 图/ 6/ (/ b/ )/ 中/ 没有/ H/ 用户/ ,/ 因此/ 两者/ 均/ 不会/ 存在/ 隐蔽/ 信息流/ ,/ 但是/ 图/ 6/ (/ c/ )/ 中/ 却/ 存在/ 隐蔽/ 信息流/ ./ 定义/ 15/ (/ 同步/ 合成/ Ⅰ/ )/ [/ 20/ -/ 21/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ )/ 为/ Petri/ 网/ ,/ Page10/ 满足/ P1/ ∩/ P2/ =/ / ,/ T1/ ∩/ T2/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ,/ T/ =/ T1/ ∪/ T2/ ,/ F/ =/ F1/ ∪/ F2/ ,/ M0/ (/ p/ )/ =/ M0i/ (/ p/ )/ (/ i/ ∈/ {/ 1/ ,/ 2/ }/ )/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 同步/ Ⅰ/ 型/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ / 1PN2/ ./ 定理/ 11/ ./ 如果/ PN1/ 与/ PN2/ 中/ 不/ 存在/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ / 1PN2/ 中/ 也/ 不/ 存在/ 隐蔽/ 信息流/ ./ 证明/ ./ 设在/ 序列/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ 下/ ,/ L/ 用户/ 观察/ 到/ 路径/ Path1/ =/ s0/ →/ ε/ s1/ →/ ε/ …/ →/ ε/ sn/ (/ n/ / 1/ )/ ,/ 且/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 从/ PN/ 的/ 结构/ 上/ 可以/ 看出/ ,/ 可以/ 将/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ 分别/ 投影/ 在/ T/ (/ PN1/ )/ 和/ T/ (/ PN2/ )/ 上/ ,/ 分别/ 将/ 投影/ 记/ 为/ σ/ 1/ ,/ σ/ 2/ ./ 从/ PN/ 的/ 结构/ 可以/ 断定/ ,/ σ/ 1/ ,/ σ/ 2/ 的/ 运行/ 互不/ 干扰/ ,/ 因此/ 必有/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ ≠/ sn/ ↓/ PL/ (/ PN1/ )/ 或者/ sn/ -/ 1/ ↓/ PL/ (/ PN2/ )/ ≠/ sn/ ↓/ PL/ (/ PN2/ )/ ./ 无论/ 哪/ 种/ 情况/ 成立/ ,/ 与/ PN1/ ,/ PN2/ 中/ 没有/ 隐蔽/ 信息流/ 矛盾/ ./ 定义/ 16/ (/ 同步/ 合成/ Ⅱ/ )/ [/ 20/ -/ 21/ ]/ ./ 设/ PN1/ =/ (/ P1/ ,/ T1/ ,/ F1/ ,/ M01/ )/ ,/ PN2/ =/ (/ P2/ ,/ T2/ ,/ F2/ ,/ M02/ )/ 为/ Petri/ 网/ ,/ 满足/ P1/ ∩/ P2/ =/ / ,/ T1/ ∩/ T2/ ≠/ / ,/ TL/ (/ PN1/ )/ ∩/ TH/ (/ PN2/ )/ =/ / ,/ TH/ (/ PN1/ )/ ∩/ TL/ (/ PN2/ )/ =/ / ./ 如果/ PN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ 满足/ :/ P/ =/ P1/ ∪/ P2/ ,/ T/ =/ T1/ ∪/ T2/ ,/ F/ =/ F1/ ∪/ F2/ ,/ M0/ (/ p/ )/ =/ M0i/ (/ p/ )/ (/ i/ ∈/ {/ 1/ ,/ 2/ }/ )/ ,/ 则/ 称/ PN/ 为/ PN1/ 与/ PN2/ 的/ 同步/ Ⅱ/ 型/ 合成/ 网/ ,/ 记为/ PN/ =/ PN1/ / 2PN2/ ./ 图/ 7/ 新建/ 和/ 删除/ 特权/ 目录/ 第/ 4/ 节/ 的/ 结论/ 说明/ 在/ 使用/ Petri/ 网对/ 该/ 系统/ 进行/ 建模/ 时/ ,/ 只/ 需/ 考察/ 高低/ 进程/ 有/ 交互/ 的/ 部分/ ,/ 即/ 特权/ 目录/ UD/ ./ 在/ 特权/ 目录/ 中/ ,/ 高/ 安全/ 级/ 进程/ 可以/ 读/ 、/ 写/ 、/ 新建/ 、/ 删除/ 文件/ ,/ 而/ 低/ 安全/ 级/ 进程/ 是/ 不/ 允许/ 的/ ./ 在/ Petri/ 网中/ 定义/ 一些/ 变迁/ 来/ 表示/ 高低/ 安全/ 级/ 进程/ 可以/ 执行/ 的/ 操作/ ,/ 如表/ 1/ 所示/ ./ 注意/ 对于/ 低/ 安全/ 级进/ 定理/ 12/ ./ 如果/ PN1/ 与/ PN2/ 中/ 不/ 存在/ 隐蔽/ 信息流/ ,/ 则/ PN/ =/ PN1/ / PN2/ 中/ 也/ 不/ 存在/ 隐蔽/ 信息流/ ./ 证明/ ./ 设在/ 序列/ σ/ =/ t1/ ,/ t2/ ,/ …/ ,/ tn/ (/ tn/ ∈/ TH/ (/ PN/ )/ )/ 下/ ,/ L/ 用户/ 观察/ 到/ 路径/ Path1/ =/ s0/ →/ / s1/ →/ / …/ →/ ε/ sn/ (/ n/ / 1/ )/ ,/ 且/ 满足/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ./ 首先/ 考虑/ tn/ ∈/ T1/ ∩/ T2/ ,/ 因为/ P1/ ∩/ P2/ =/ / ,/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ,/ 所以/ 必有/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ ≠/ sn/ ↓/ PL/ (/ PN1/ )/ 或者/ sn/ -/ 1/ ↓/ PL/ (/ PN2/ )/ ≠/ sn/ ↓/ PL/ (/ PN2/ )/ ./ 无论/ 哪/ 种/ 情况/ 成立/ ,/ 与/ PN1/ ,/ PN2/ 中/ 不/ 存在/ 隐蔽/ 信息流/ 矛盾/ ./ 下面/ 考虑/ tn/ / T1/ ∩/ T2/ ,/ 不妨/ 设/ tn/ ∈/ T1/ ./ 因为/ P1/ ∩/ P2/ =/ / ,/ sn/ -/ 1/ ↓/ PL/ (/ PN/ )/ ≠/ sn/ ↓/ PL/ (/ PN/ )/ ,/ 所以/ 必有/ sn/ -/ 1/ ↓/ PL/ (/ PN1/ )/ ≠/ sn/ ↓/ PL/ (/ PN1/ )/ ,/ 与/ PN1/ 中/ 不/ 存在/ 隐蔽/ 信息流/ 矛盾/ ./ 6/ 实例/ 分析/ 本/ 小节/ 我们/ 将/ 采用/ 文献/ [/ 14/ ]/ 中/ 的/ 一个/ 实例/ 来/ 说明/ 如何/ 标识/ 隐蔽/ 信息流/ ./ 在/ 一个/ 支持/ 强制/ 安全等级/ 的/ 系统/ 中/ ,/ 如/ UNlX/ 操作系统/ ,/ 当/ 进程/ 新建/ 和/ 删除/ 一个/ 特权/ 目录/ 时/ 就/ 会/ 受到/ 某些/ 限制/ ,/ 图/ 7/ 对/ 这种/ 限制/ 给出/ 了/ 说明/ ./ 图/ 7/ (/ a/ )/ 和/ (/ b/ )/ 说明/ 如果/ Lh/ >/ Li/ ,/ 则/ 等级/ 是/ Lh/ 的/ 进程/ 不能/ 创建/ 和/ 删除/ 等级/ 是/ Li/ 的/ 目录/ D/ 中/ 的/ 特权/ 目录/ UD/ ./ 图/ 7/ (/ c/ )/ 和/ (/ d/ )/ 说明/ 特权/ 目录/ 只能/ 被/ 低/ 安全/ 级/ 的/ 进程/ 创建/ 和/ 删除/ ./ 程/ ,/ 只有/ 当/ 特权/ 目录/ 中/ 没有/ 任何/ 文件/ 时/ 才能/ 被/ 删除/ ./ 高/ 安全/ 级/ 进程/ ReadWrite/ ×/ ×/ NewDelete/ 低/ 安全/ 级/ 进程/ ×/ ×/ CreateRemove/ ×/ ×/ Page11/ 图/ 8/ 是/ 高低/ 进程/ 访问/ 特权/ 目录/ UD/ 的/ 抽象/ 过程/ 的/ Petri/ 网/ 模型/ ./ 在/ 该/ 模型/ 中/ LCreat/ 和/ LRemove/ 分别/ 表示/ 低/ 安全/ 级/ 进程/ 创建/ 和/ 删除/ 特权/ 目录/ UD/ ./ HNew/ ,/ HDelete/ ,/ HRead/ // Write/ 分别/ 表示/ 高/ 安全/ 级/ 进程/ 创建/ 文件/ 、/ 删除/ 文件/ 、/ 读/ 和/ 写/ 文件/ ./ 模型/ 描述/ 的/ 主要/ 访问/ 过程/ 是/ 当/ UD/ 创建/ 好/ 之后/ ,/ 如果/ 里面/ 没有/ 文件/ ,/ 则/ 可以/ 直接/ 删除/ ,/ 如果/ 高/ 安全/ 级/ 进程/ 创建/ 了/ 文件/ ,/ 则/ 必须/ 等待/ 文件/ 删除/ 后/ UD/ 才能/ 被/ 删除/ ./ 图/ 8/ 中/ 的/ Petri/ 网/ 比较简单/ ,/ 可以/ 直接/ 看出/ 每/ 一个/ 变迁/ 都/ 具有/ L1/ 活性/ ,/ 且/ ·/ LRemove/ ∩/ ·/ HNew/ ≠/ / ./ 由/ 定理/ 4/ 直接/ 可知/ 存在/ 隐蔽/ 信息流/ ./ 图/ 8/ 高低/ 进程/ 访问/ 特权/ 目录/ UD/ 的/ Petri/ 网/ 模型/ ·/ LRemove/ ∩/ ·/ HNew/ ≠/ / 说明/ HNew/ 的/ 触发/ 与否/ 直接/ 决定/ 了/ LRemove/ 能否/ 被/ 触发/ ./ 直观/ 上/ 的/ 解释/ 就是/ ,/ 当低/ 安全/ 进程/ 创建/ 好/ UD/ 目录/ 后/ ,/ 高/ 安全/ 级/ 进程/ 可以/ 通过/ 是否/ 创建/ 新/ 文件/ 来/ 向/ 低/ 进程/ 传递信息/ ./ 如果/ 高/ 安全/ 级/ 进程/ 创建/ 新/ 文件/ ,/ 则/ 低/ 安全/ 级/ 进程/ 不能/ 删除/ 目录/ UD/ ,/ 此时/ 可以/ 理解/ 为/ 高/ 安全/ 级/ 进程/ 向/ 低/ 安全/ 级/ 进程/ 传递/ 了/ 一个/ 比特/ 信息/ ./ 如果/ 高/ 安全/ 级/ 进程/ 没有/ 创建/ 新/ 文件/ ,/ 则/ 低/ 安全/ 级/ 进程/ 可以/ 成功/ 删除/ 目录/ UD/ ,/ 此时/ 可以/ 理解/ 为/ 高/ 安全/ 级/ 进程/ 向/ 低/ 安全/ 级/ 进程/ 传递/ 了/ 另外/ 一个/ 比特/ 信息/ ,/ 从而/ 造成/ 了/ 信息/ 从/ 高/ 安全/ 级/ 进程/ 向/ 低/ 安全/ 级/ 进程/ 的/ 泄漏/ ./ 7/ 结论/ 隐蔽/ 信息流/ 标识/ 是/ 一个/ 众所周知/ 的/ 难题/ ,/ 目前/ 尚无/ 理论/ 上/ 成熟/ 、/ 实际上/ 可行/ 的/ 标识/ 方法/ ./ 其中/ ,/ 无/ 干扰/ 方法/ 的/ 主要/ 问题/ 在于/ 必须/ 依靠/ “/ 展开/ 定理/ ”/ ./ 本文/ 遵循/ 无/ 干扰/ 方法/ 的/ 思想/ ,/ 以/ 基于/ 状态/ 转换/ 系统/ 的/ 形式化/ 规约/ 为/ 处理/ 对象/ ,/ 使用/ Petri/ 网/ 作为/ 开发/ TCB/ 的/ 形式化/ 建模/ 工具/ ,/ 借助/ Petri/ 网中/ 比较/ 成熟/ 的/ 分析/ 技术/ 对/ TCB/ 中/ 的/ 隐蔽/ 信息流/ 进行/ 分析/ ,/ 并/ 提出/ 一种/ 基于/ Petri/ 网可达/ 图/ 的/ 隐蔽/ 信息流/ 存在/ 性/ 判定/ 算法/ ./ 和/ 无/ 干扰/ 方法/ 相比/ ,/ 该/ 算法/ 的/ 主要/ 优点/ 在于/ 避免/ 了/ 等价/ 状态/ 的/ 区分/ 和/ 展开/ 定理/ 的/ 使用/ ,/ 同时/ 可以/ 直接/ 定位/ 隐蔽/ 信息流/ 的/ 位置/ ./ 另外/ ,/ 还/ 探讨/ 了/ 导致/ 隐蔽/ 信息流/ 发生/ 的/ 网/ 结构特征/ ,/ 从而/ 使得/ 由/ 此类/ 结构/ 引起/ 的/ 隐蔽/ 信息流/ 在/ 系统/ 的/ 早期/ 设计阶段/ 得以/ 避免/ ./ 文中/ 最后/ 还/ 提出/ 可以/ 通过/ 组合分析/ 的/ 方法/ 降低/ 大规模/ 可信/ 系统分析/ 的/ 复杂度/ ,/ 并/ 讨论/ 了/ 各种/ 组合/ 操作/ 下/ 隐蔽/ 信息流/ 的/ 存在/ 性/ ./ 文中/ 采用/ 有界/ Petri/ 网为/ TCB/ 建模/ ,/ 因而/ 其可达/ 图/ 也/ 是/ 有限/ 的/ ./ 对于/ 具有/ 无穷/ 状态/ 的/ TCB/ ,/ 其/ Petri/ 网/ 模型/ 将/ 是/ 无界/ 的/ ,/ 因而/ 其可达/ 图/ 是/ 无穷的/ ./ 如何/ 在/ 无穷的/ 空间/ 上/ 判定/ 隐含/ 信息流/ 的/ 存在/ 性是/ 下/ 一步/ 的/ 主要/ 工作/ ./ 我们/ 可/ 借助于/ 模型/ 检测/ 技术/ [/ 22/ -/ 23/ ]/ 和/ 定理/ 证明/ 器/ PVS/ [/ 24/ ]/ 来/ 完成/ 无穷/ 空间/ 上/ 隐蔽/ 信息流/ 的/ 分析/ :/ (/ 1/ )/ 利用/ 模型/ 检测/ 中/ 的/ 抽象/ 技术/ [/ 25/ ]/ ,/ 在/ 保留/ 全部/ 信息流/ 的/ 前提/ 下/ ,/ 建立/ TCB/ 的/ 有/ 穷/ 状态/ 模型/ ;/ (/ 2/ )/ 假设/ 在/ 当前/ 可/ 达/ 空间/ 上/ 隐蔽/ 信息流/ 不/ 存在/ ,/ 利用/ PVS/ 归纳/ 证明/ 在/ 下/ 一步/ 可/ 达/ 空间/ 上/ 隐蔽/ 信息流/ 也/ 不/ 存在/ ./ 

