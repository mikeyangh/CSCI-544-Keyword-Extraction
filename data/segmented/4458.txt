Page1/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ 王/ ?/ 刘戬/ 王/ 飞宇/ 刘/ 剑峰/ (/ 北京/ 中/ 电/ 华大/ 电子设计/ 有限责任/ 公司/ 北京/ 100102/ )/ 摘要/ 差分/ 频域/ 分析方法/ 是/ 常用/ 的/ 攻击/ 方法/ 之一/ ,/ 当/ 设计/ 中/ 使用/ 随机/ 延时/ 运行/ 等/ 其他/ 防护/ 措施/ 时/ ,/ 现有/ 的/ 差分/ 功耗/ 分析方法/ 已经/ 不能/ 开展/ 攻击/ ,/ 而/ 差分/ 频域/ 分析方法/ 可以/ 对/ 这类/ 防护/ 措施/ 实施/ 攻击/ ./ 但/ 该/ 攻击/ 方法/ 会/ 带入/ 更/ 多/ 噪声/ ,/ 降低/ 攻击/ 效率/ ./ 针对/ 以上/ 问题/ ,/ 文中/ 提出/ 了/ 一种/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ ,/ 该/ 方法/ 可/ 有效/ 地/ 提升/ 攻击/ 效率/ ./ 文中/ 首先/ 介绍/ 了/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ 的/ 基本原理/ ,/ 然后/ 搭建/ 实验/ ,/ 在/ SASEBOGII/ 仿真/ 板上/ 实现/ 一个/ 防护/ 措施/ 为/ 随机/ 延时/ 运行/ 和/ 功耗/ 隐藏/ 的/ DES/ 算法/ 实施/ 攻击/ ./ 实验/ 结果表明/ ,/ 针对/ DES/ 随机/ 延时/ 运行/ 和/ 功耗/ 隐藏/ 防护/ 措施/ ,/ 文中/ 提出/ 的/ 重/ 采样/ 频域/ 攻击/ 方法/ 较之/ DPA/ 方法/ 可/ 攻击/ 成功/ ,/ 是/ 多种/ 防护/ 措施/ 攻击/ 成功/ 的/ 实例/ ./ 同时/ ,/ 采用/ 重/ 采样/ 处理/ 的/ 差分/ 频域/ 分析方法/ 可以/ 有效/ 提高/ 信号/ 的/ 信噪比/ ,/ 将/ 攻击/ 效率/ 提升/ 一倍/ ./ 关键词/ 差分/ 频域/ 分析/ ;/ 重/ 采样/ ;/ DES/ ;/ 防护/ 措施/ ;/ 密码学/ 1/ 引言/ 在/ 信息安全/ 领域/ ,/ 针对/ 密码/ 芯片/ 的/ 安全/ 攻击/ 研究/ 是/ 现今/ 的/ 热点/ 之一/ ./ 自/ Kocher/ 等/ 人/ [/ 1/ ]/ 在/ 1996/ 年/ 首次/ 提出/ 利用/ 芯片/ 的/ 侧/ 信道/ 信息/ 破解/ 芯片/ 密码/ 后/ ,/ Kocher/ 等/ 人/ 又/ 提出/ 了/ 差分/ 功耗/ 分析/ (/ DifferentialPowerAnalysis/ ,/ DPA/ )/ ./ 之后/ ,/ 国内外/ 侧/ 信道/ 研究/ 工/ Page2/ 作/ 不断深入/ [/ 2/ -/ 4/ ]/ ,/ 不同/ 类型/ 的/ 侧/ 信道/ 攻击/ (/ SideChannelAttacks/ ,/ SCA/ )/ 方法/ 相继/ 出现/ ,/ 如/ 相关/ 功耗/ 分析/ (/ CorrelationPowerAnalysis/ ,/ CPA/ )/ [/ 5/ ]/ 、/ 模板/ 攻击/ [/ 6/ ]/ 等/ ./ 差分/ 功耗/ 分析/ 是/ 侧/ 信道/ 攻击/ 技术/ 中/ 应用/ 范围/ 最广/ 的/ 一种/ ./ DPA/ 攻击/ 相对/ 于/ 传统/ 的/ 穷举/ 攻击/ ,/ 省时省力/ ./ 一般来说/ ,/ DPA/ 处理/ 的/ 信息/ 是/ 时域/ 上/ 的/ 信号/ ,/ 因此/ 要求/ 算法/ 的/ 关键/ 运算/ 步骤/ 的/ 时域/ 信号/ 必须/ 精确/ 对齐/ ,/ 才能/ 开展/ 攻击/ [/ 1/ ]/ ./ 针对/ DPA/ 的/ 特点/ ,/ 学者/ 们/ 针对/ 防护/ DPA/ 需要/ 时间/ 上/ 精确/ 对齐/ ,/ 设计/ 出/ 相应/ 的/ 防护/ 措施/ ,/ 如/ 随机/ 抖动/ [/ 7/ ]/ ./ Messerges/ [/ 8/ ]/ 将/ RSA/ 模幂/ 算法/ 的/ 操作/ 随机化/ ,/ 提出/ 了/ 一种/ 伪/ 随机/ 扫描/ 模幂/ 算法/ ,/ 可以/ 抵御/ DPA/ 的/ 攻击/ ./ 使得/ 防护/ DPA/ 攻击/ 的/ 防护/ 措施/ 的/ 研究/ 更进一步/ ./ 若/ 所/ 攻击/ 的/ 算法/ 中/ 加入/ 了/ 随机/ 运行/ 算法/ 的/ 操作/ ,/ 会/ 使得/ 各条/ 功耗/ 曲线/ 相同/ 操作/ 时间/ 点/ 不能/ 精确/ 对齐/ ,/ 那么/ 使用/ 再/ 多/ 的/ 差分/ 曲线/ 条数/ 都/ 不能/ 将/ 正确/ 密钥/ 找/ 出来/ ./ 因此/ ,/ 针对/ 如此/ 防护/ 措施/ 的/ 算法/ 运算/ ,/ 直接/ 应用/ DPA/ 无法/ 攻击/ 成功/ [/ 9/ -/ 10/ ]/ ./ 与此同时/ ,/ 针对/ 防护/ DPA/ 攻击/ 的/ 防护/ 措施/ 的/ 攻击/ 研究/ 也/ 有/ 了/ 进展/ ./ 2000/ 年/ Aigner/ 等/ 人/ 在/ 文献/ [/ 11/ ]/ 中/ 就/ 曾经/ 指出/ :/ 在/ 密码/ 旁路/ 分析/ 中/ 的/ 时域/ 信号/ 差异/ 在/ 频域/ 中/ 同样/ 会/ 体现/ 出来/ ./ 在/ 2005/ 年/ 的/ CHES/ 会议/ 上/ ,/ Gebotys/ 等/ 人/ [/ 12/ ]/ 针对/ 电磁/ 信号/ 的/ 频域/ 分析/ ,/ 在/ PAD/ 上/ 运行/ Rijndael/ 和/ ECC/ 算法/ ,/ 成功/ 获取/ 了/ 算法/ 密钥/ ,/ 验证/ 了/ 频域/ 值/ 同样/ 携带/ 了/ 时域/ 信息/ ./ 邓/ 高明/ 等/ 人/ 针对/ 带/ 防护/ DPA/ 的/ 算法/ 的/ 频域/ 分析/ ,/ 使用/ 模板/ 攻击/ 方法/ 成功/ 获取/ 算法/ 密钥/ [/ 13/ ]/ ./ 由于/ 算法/ 运行/ 中/ ,/ 信息/ 时域/ 信号/ 存在/ 的/ 差异/ 在/ 频域/ 中/ 同样/ 会/ 体现/ 出来/ [/ 14/ -/ 15/ ]/ ,/ 将/ 频域/ 信号/ 的/ 特点/ 引入/ 到/ DPA/ 中/ ,/ 得到/ 一种/ 针对/ 频域/ 信号/ 的/ DPA/ 分析方法/ ,/ 即/ 差分/ 频域/ 分析/ (/ DifferentialFrequencyAnalysis/ ,/ DFqA/ )/ ./ DFqA/ 是/ 差分/ 时域/ 分析/ DPA/ 攻击/ 的/ 一种/ 改进/ 方法/ ./ 根据/ 频域/ 信号/ 的/ 这/ 一/ 特性/ ,/ 本文/ 针对/ 一种/ 防护/ DPA/ 的/ DES/ 算法/ ,/ 使用/ DFqA/ 方法/ ,/ 实验/ 验证/ 了/ DFqA/ 方法/ 较之/ DPA/ 方法/ 的/ 独特/ 之处/ ./ 由于/ DFqA/ 方法/ 需要/ 将/ 全部/ 运行/ 算法/ 部分/ 的/ 信号/ 进行/ 分析/ ,/ 会/ 引入/ 更/ 多/ 的/ 噪声/ ,/ 在/ 实际/ 攻击/ 中/ ,/ 较之/ DPA/ 方法/ ,/ 需要/ 更/ 多/ 曲线/ 条数/ 才能/ 攻击/ 成功/ ./ 信噪比/ 降低/ ,/ 随之而来/ 的/ 是/ 攻击/ 效率/ 较/ 低/ ./ 对于/ DFqA/ 方法/ 的/ 信噪比/ 提升/ 的/ 研究/ 文献/ 较少/ ./ 2011/ 年/ ,/ Hodgers/ 等/ 人/ [/ 16/ ]/ 针对/ 随机/ 抖动/ 防护/ 措施/ 的/ AES/ 使用/ 了/ 滑动/ 窗/ 的/ 信号处理/ 方法/ ,/ 该/ 方法/ 与/ 差分/ 频域/ 分析方法/ 结合/ ,/ 可/ 成功/ 获取/ AES/ 密钥/ ./ 此外/ ,/ 国内外/ 文献/ 研究/ 中/ ,/ 并/ 没有/ 针对实际/ 的/ 功耗/ 干扰/ 的/ 防护/ 措施/ 进行/ 攻击/ 分析/ ./ 而/ 本文/ ,/ 考虑/ 到/ 实际/ 应用/ ,/ 在/ 防护/ 措施/ 中/ 加入/ 功耗/ 干扰/ 措施/ ,/ 并/ 展开/ 攻击/ 分析/ ./ 本文/ 设计/ 了/ 一种/ 防护/ 常规/ DPA/ 的/ DES/ 算法/ ,/ 使用/ DPA/ 攻击/ 不能/ 获取/ 密钥/ ,/ 而/ 使用/ DFqA/ 方法/ ,/ 可以/ 获得/ DES/ 密钥/ ./ 针对/ DFqA/ 攻击/ 中/ 的/ 信噪比/ 问题/ ,/ 提出/ 一种/ 采用/ 重/ 采样/ DFqA/ 攻击/ 方法/ ,/ 该/ 方法/ 可以/ 将/ 攻击/ 成功/ 所/ 需/ 的/ 曲线/ 条数/ 减少/ 至/ 未/ 使用/ 重/ 采样/ DFqA/ 攻击/ 方法/ 的/ 47/ %/ ./ 缩短/ 攻击/ 时间/ ,/ 将/ 攻击/ 效率/ 提高/ 一倍/ ./ 本文/ 第/ 2/ 节为/ 差分/ 频域/ 分析方法/ 的/ 背景/ 介绍/ ;/ 第/ 3/ 节为/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 攻击/ 方法/ 描述/ ;/ 第/ 4/ 节为/ 设计/ 实验/ 实例/ 、/ 实验/ 结果/ 分析/ ;/ 第/ 5/ 节为/ 相关/ 工作/ 介绍/ ;/ 第/ 6/ 节为/ 本文/ 总结/ 和/ 工作/ 展望/ ./ 2/ 背景/ 介绍/ 2.1/ DES/ 算法/ DES/ 算法/ 是/ 美国/ IBM/ 公司/ 于/ 1977/ 年/ 提出/ 的/ 一种/ 分组/ 对称/ 数据/ 加密算法/ ./ DES/ 的/ 整个/ 体制/ 是/ 公开/ 的/ ,/ 系统/ 的/ 安全性/ 全靠/ 密钥/ 的/ 保密/ ./ DES/ 将/ 64/ 位/ 明文/ 依次/ 进行/ 初始/ 置换/ 、/ 16/ 轮/ 迭代/ 变换/ 和/ 逆变换/ 后/ ,/ 生成/ 64/ 位/ 密文/ ./ DES/ 采用/ Feistel/ 结构/ ,/ 共有/ 16/ 个/ 迭代/ 周期/ ,/ DES/ 算法/ 的/ 框架/ 如图/ 1/ 所示/ ./ 本文/ 的/ 贡献/ 在于/ :/ (/ 1/ )/ 提出/ 一种/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ ./ 该/ 方法/ 对/ 差分/ 频域/ 分析/ 的/ 信号处理/ 技术/ 提供/ 应用/ 指导/ ./ (/ 2/ )/ 通过/ 实验/ 验证/ 了/ 基于/ 重/ 采样/ 的/ 信号处理/ 方法/ ,/ 可/ 提高/ 信噪比/ ,/ 提高/ 差分/ 频域/ 分析方法/ 的/ 攻击/ 效率/ ./ 将/ 攻击/ 时间/ 缩短/ 了/ 一倍/ ./ (/ 3/ )/ 通过/ 实验/ 验证/ 传统/ 抵御/ DPA/ 的/ 防护/ 措施/ ,/ 可以/ 被/ 差分/ 频域/ 分析方法/ 攻击/ 成功/ ,/ 已经/ 不再/ 有效/ ./ 也/ 即/ 考虑/ 安全措施/ 时/ ,/ 仅/ 考虑/ 抵御/ DPA/ 防护/ ,/ 已/ 不再/ 安全/ ./ (/ 4/ )/ 本文/ 的/ 防护/ 措施/ 中/ 包含/ 了/ 功耗/ 干扰/ ,/ 较之/ 以前/ 的/ 仅/ 从/ 算法/ 上/ 实现/ 防护/ 措施/ 来/ 研究/ 和/ 分析/ 安全/ 攻击/ 方法/ ,/ 此/ 方法/ 更/ 贴近/ 实际/ 应用/ 场景/ ,/ 为/ 实际/ 应用/ 提供/ 了/ 参考/ ./ Page3/ 本文/ 的/ 算法/ 防护/ 措施/ 实现/ 以及/ 实际/ 攻击/ 算法/ 对象/ ,/ 使用/ DES/ 算法/ ./ 2.2/ 差分/ 功耗/ 分析/ 侧/ 信道/ 攻击/ 方法/ 中/ DPA/ 方法/ 的/ 目标/ 是/ 记录/ 密码/ 设备/ 对/ 大量/ 不同/ 数据/ 分组/ 进行/ 加密/ 或/ 解密/ 操作/ 时/ 的/ 能量/ 曲线/ ,/ 并/ 基于/ 能量/ 曲线/ 恢复/ 出/ 密码/ 设备/ 中/ 的/ 密钥/ ./ DPA/ 攻击/ 方法/ 的/ 基本/ 攻击/ 策略/ 步骤/ 如下/ [/ 17/ ]/ ./ 步骤/ 1/ ./ 选择/ 所/ 执行/ 算法/ 的/ 某个/ 中间/ 值/ ./ 这个/ 中间/ 值/ 必须/ 为/ 一个/ 函数/ f/ (/ d/ ,/ k/ )/ ,/ 其中/ d/ 是/ 已知/ 的/ 数据/ ,/ 如/ 明文/ 或者/ 密文/ ,/ k/ 为/ 密钥/ 的/ 一小部分/ ;/ 步骤/ 2/ ./ 测量/ 能量消耗/ ./ 即/ 测量/ 攻击/ 对象/ 在/ 加密/ 或者/ 解密/ 不同/ 数据/ 时/ 的/ 能量消耗/ ,/ 共/ D/ 条/ 曲线/ ,/ 能量/ 曲线/ 可记/ 为/ 矩阵/ 犜/ ;/ 步骤/ 3/ ./ 计算/ 假设/ 中间/ 值/ ./ 计算/ 不同/ 数据/ 的/ 中间/ 值/ ,/ 将/ 假设/ 值记/ 为/ 犽/ =/ (/ k1/ ,/ …/ ,/ kk/ )/ ,/ 其中/ K/ 为/ 犽/ 的/ 所有/ 可能/ 值/ ,/ 得到/ 矩阵/ 犞/ {/ vi/ ,/ j/ =/ f/ (/ di/ ,/ kj/ )/ |/ i/ =/ 1/ ,/ …/ ,/ D/ ,/ j/ =/ 1/ ,/ …/ ,/ K/ }/ ;/ 步骤/ 4/ ./ 将/ 中间/ 值/ 映射/ 为/ 能量消耗/ 值/ ./ 将/ 假设/ 中间/ 值/ 矩阵/ 犞/ 映射/ 为/ 假设/ 能量消耗/ 值/ 矩阵/ 犎/ ;/ 步骤/ 5/ ./ 比较/ 假设/ 能量消耗/ 值/ 和/ 能量/ 曲线/ ./ 将/ 每/ 一个/ 密钥/ 假设/ 对应/ 的/ 假设/ 能量消耗/ 值/ 矩阵/ 犎/ 与/ 在/ 每/ 一个/ 位置/ 所/ 记录/ 的/ 能量/ 曲线/ 矩阵/ 犜/ 比较/ ,/ 得到/ 矩阵/ 犚/ ,/ 犚/ 中值/ 大/ 的/ 即/ 为/ 匹配/ 度高/ 的/ ,/ 即/ 认定/ 为/ 密钥/ 假设/ 正确/ ./ 本文/ 的/ DFqA/ 攻击/ 方法/ 是/ 基于/ DPA/ 攻击/ 方法/ 的/ 一种/ 改进/ 的/ 攻击/ 方法/ ./ 3/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 攻击/ 方法/ 3.1/ 功率/ 谱/ Aigner/ 等/ 人/ 在/ 文献/ [/ 11/ ]/ 中/ 指出/ 在/ 密码/ 旁路/ 分析/ 中/ 的/ 时域/ 信号/ 差异/ ,/ 在/ 频域/ 中/ 同样/ 会/ 体现/ 出来/ ./ 基于/ 此项/ 研究/ ,/ 侧/ 信道/ 攻击/ 方法/ 面对/ 的/ 对象/ 可以/ 是/ 时域/ 信号/ ,/ 同时/ 也/ 可以/ 是/ 频域/ 信号/ ./ 若/ 算法/ 防护/ 中/ 加入/ 了/ 随机/ 延时/ 运行/ 等/ 防护/ 措施/ ,/ 采集/ 的/ 时域/ 信号/ 中/ 相同/ 操作/ 时间/ 点/ 不/ 固定/ ,/ 会/ 导致/ 关键/ 运算/ 在/ 时域/ 上/ 不能/ 对齐/ ,/ 此时/ DPA/ 失效/ ./ 将/ 采集/ 到/ 的/ 时域/ 信号/ 去除/ 时间/ 特性/ 的/ 方法/ 之一/ 是/ 进行/ 傅立叶/ 变换/ ,/ 将/ 时域/ 信号/ 变换/ 到/ 频域/ 上来/ ,/ 消除/ 了/ 时间/ 参数/ ./ 由/ 快速/ 傅里叶/ 变换/ (/ FastFourierTransform/ ,/ FFT/ )/ 将/ 采集/ 到/ 的/ 时域/ 信号/ 变换/ 到/ 频域/ 上/ ,/ 公式/ 如式/ (/ 1/ )/ 所示/ :/ 将/ 有限/ 的/ 时间/ 信号/ 通过/ 傅立叶/ 变换/ ,/ 转换/ 到/ 频域/ 上/ ,/ 这个/ 过程/ 是/ 符合/ 能量守恒/ 的/ ./ 同时/ ,/ 时域/ 信号/ 进行/ 傅立叶/ 变换/ 后/ 的/ 数据/ 相关性/ 仍然/ 保存/ ./ 由于/ 时域/ 信号/ 中/ 所/ 关心/ 的/ 操作/ ,/ 在/ 时间/ 上/ 是/ 不/ 固定/ 的/ ./ 由/ 离散/ 傅里叶/ 变换/ 的/ 时移/ 特性/ ,/ 当/ 信号/ 在/ 时域/ 上/ 有时/ 移时/ ,/ 体现/ 在/ 频点/ 上/ 为/ 相位/ 差异/ ,/ 如式/ (/ 2/ )/ 所示/ :/ 上式/ 中/ ,/ 当/ 在/ 时域/ 上延/ 时间轴/ 时移/ -/ m/ ,/ 进行/ 傅立叶/ 变换/ 之后/ 等效于/ 其/ 乘以/ 相移/ 因子/ 犠/ mk/ ,/ 也/ 即/ 信号/ 在/ 时域/ 上/ 移动/ ,/ 其/ 幅度/ 谱/ 不变/ ,/ 而/ 相位/ 谱/ 产生/ 了/ 变换/ ./ 对于/ 我们/ 所/ 关心/ 的/ 算法/ 关键步骤/ 的/ 随机/ 延时/ 运行/ 的/ 信息/ 时域/ 信息/ ,/ 经/ 傅立叶/ 变换/ 后/ ,/ 去/ 除了/ 时域/ 信号/ 的/ 时间/ 不/ 对齐/ ,/ 同时/ 引入/ 了/ 关心/ 频域/ 点/ 的/ 相位/ 差异/ ./ 我们/ 进行/ 攻击/ 的/ 过程/ 并/ 不/ 关心/ 相位/ 信息/ ,/ 可以/ 利用/ 功率/ 谱/ 密度/ ,/ 将/ 傅立叶/ 变换/ 后/ 的/ 序列/ 去除/ 相位/ 信息/ ,/ 得到/ 对应/ 频率/ 的/ 能量/ ./ 功率/ 谱/ 密度/ 公式/ ,/ 如式/ (/ 3/ )/ 所示/ :/ P/ (/ ω/ )/ 为/ 功率/ 谱/ 密度/ ,/ 表示/ 单位/ 频带/ 内/ 信号/ 功率/ 随/ 频率/ 的/ 变换/ 情况/ ,/ 反映/ 了/ 信号/ 在/ 频域/ 上/ 的/ 能量/ 分布/ ./ 这样/ ,/ 既/ 去/ 除了/ 时域/ 信号/ 中/ DES/ 关键/ 操作/ 的/ 时间/ 随机/ ,/ 又/ 去/ 除了/ 傅立叶/ 变换/ 后/ 频域/ 上/ 的/ 相位/ 差异/ ./ 获取/ 功率/ 谱/ 分布/ ,/ 需要/ 将/ 算法/ 运行/ 全过程/ 的/ 功耗/ 信号/ 进行/ FFT/ 和/ 功率/ 谱/ 密度/ 函数/ 计算/ ,/ 因此/ 算法/ 运行/ 频率/ 点/ 的/ 能量/ 值会/ 带入/ 整段/ 曲线/ 此/ 频率/ 点/ 的/ 运行/ 噪声/ ./ 3.2/ 重/ 采样/ 处理/ 采集/ 的/ 时域/ 信号/ 中/ 会/ 带入/ 噪声/ 信号/ ,/ 由于/ 对于/ 侧/ 信道/ 攻击/ 的/ 对象/ ,/ 提高/ 其/ 信噪比/ ,/ 会/ 减少/ 攻击/ 所/ 需/ 的/ 曲线/ 条数/ [/ 17/ ]/ ./ 同时/ ,/ 由于/ 功率/ 谱/ 中/ 每个/ 频点/ 所/ 对应/ 的/ 幅值/ 要/ 包含/ 整个/ 算法/ 运行/ 功耗/ 的/ 频点/ 信息/ ./ 因/ Page4/ 此/ ,/ 其/ 引入/ 的/ 噪声/ 要远/ 多于/ 时域/ 信号/ ,/ 更/ 需要/ 降低/ 噪声/ ,/ 提高/ 信噪比/ ./ 对于/ 采集/ 的/ 信号/ 一般/ 由/ 以下/ 部分/ 组成/ :/ 式/ (/ 4/ )/ 中/ ,/ 犛/ noise/ 为/ 噪声/ ,/ 犛/ el/ ./ signal/ 为/ 芯片/ 运行/ 功耗/ 中/ 与/ 算法/ 关键/ 信号/ 无关/ 的/ 部分/ ,/ 犛/ exp/ ./ signal/ 为/ 芯片/ 运行/ 功耗/ 中/ 的/ 算法/ 关键/ 信号/ ./ 对于/ 安全/ 攻击/ 而言/ ,/ 信噪比/ 公式/ 如式/ (/ 5/ )/ 所示/ :/ 为了/ 提高/ 攻击/ 信号/ 的/ 信噪比/ ,/ 需要/ 降低/ 犛/ noise/ 和/ 犛/ el/ ./ signal/ 信号/ ./ 犛/ el/ ./ signal/ 信号/ 是/ 运算/ 中/ 不可/ 去除/ 的/ ,/ 而/ 犛/ noise/ 信号/ 为/ 芯片/ 运算/ 时/ 的/ 噪声/ ./ 芯片/ 在/ 运行/ 过程/ 中/ ,/ 噪声/ 部分/ 主要/ 来源/ 如下/ :/ (/ 1/ )/ 芯片/ 物理/ 特性/ 的/ 固有/ 噪声/ ,/ 如/ 热噪声/ 、/ 散粒/ 噪声/ 、/ 闪烁/ 噪声/ 、/ 猝发/ 噪声/ 等/ [/ 18/ ]/ ;/ (/ 2/ )/ 采集/ 信号/ ,/ 从/ 模拟/ 到/ 数字/ 过程/ 的/ 量化/ 误差/ 引起/ 的/ 噪声/ [/ 19/ ]/ ;/ (/ 3/ )/ 测量/ 中/ 引入/ 的/ 外部/ 环境噪声/ ./ 以上/ 噪声/ 信号/ 的/ 频率/ 不是/ 在/ 芯片/ 的/ 工作频率/ 上/ 产生/ ./ 同时/ ,/ 芯片/ 工作/ 时/ ,/ 当/ 芯片/ 内部/ 时钟/ 的/ 时钟/ 沿/ 到来/ 时/ ,/ 电路/ 翻转/ [/ 17/ ]/ ./ 因此/ ,/ 其/ 主要/ 的/ 翻转/ 功耗/ 集中/ 在/ 时钟/ 沿/ 到来/ 时刻/ ./ 基于/ 信号/ 与/ 噪声/ 的/ 频率/ 不/ 一致/ 的/ 情况/ ,/ 考虑/ 使用/ 基于/ 芯片/ 工作频率/ 来/ 压缩/ 和/ 提取/ 信号/ ./ 将/ 时钟/ 沿处/ 的/ 信号/ 提取/ 出来/ ,/ 同时/ 减小/ 犛/ noise/ 信号/ ,/ 将会/ 大大/ 改善/ 信号/ 的/ 信噪比/ ./ 基于/ 以上/ 分析/ ,/ 基于/ 算法/ 运行/ 的/ 工作频率/ 作为/ 重/ 采样/ 频率/ ,/ 可/ 实现/ 这一/ 设想/ ./ 重/ 采样/ 处理/ 的/ 算法/ 流程图/ ,/ 如图/ 2/ 所示/ ./ 噪声/ 水平/ ,/ 提高/ 信噪比/ ./ 3.3/ 重/ 采样/ 差分/ 频域/ 分析方法/ 策略/ 步骤/ 如下/ :/ 的/ 工作频率/ 进行/ 重/ 采样/ ;/ 由/ 以上/ 分析/ ,/ 给出/ DFqA/ 攻击/ 方法/ 的/ 基本/ 攻击/ 步骤/ 1/ ./ 将/ 算法/ 运行/ 消耗/ 的/ 时域/ 信号/ ,/ 使用/ 芯片/ 步骤/ 2/ ./ 将重/ 采样/ 后/ 的/ 时域/ 信号/ ,/ 进行/ FFT/ 变/ 步骤/ 3/ ./ 将/ 功率/ 谱值/ 作为/ 攻击/ 对象/ ,/ 使用/ DPA/ 给出/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ 的/ 流程/ 使用/ 芯片/ 的/ 工作频率/ 进行/ 重/ 采样/ ,/ 可/ 有效/ 降低/ 换/ ,/ 并/ 得到/ 功率/ 谱值/ ;/ 方法/ 实施/ 攻击/ ./ 图/ ,/ 如图/ 3/ 所示/ ./ 时域/ 信号/ ,/ 使用/ 芯片/ 的/ 工作频率/ 进行/ 重/ 采样/ ,/ 去/ 除了/ 部分/ 噪声/ 信号/ ,/ 提高/ 信噪比/ ./ 得到/ 重/ 采样/ 后/ 的/ 时域/ 信号/ 后/ ,/ 再/ 进行/ FFT/ 以及/ 功率/ 谱/ 密度/ 计算/ ./ 选择/ 工作频率/ 对应/ 的/ 能量/ 值/ ,/ 分别/ 与/ 猜测/ 的/ 0/ ~/ 255/ 的/ 轮/ 密钥/ 所/ 对应/ 的/ 中间/ 值/ 进行/ 差分/ 分析/ ,/ 选取/ 其中/ 峰值/ 最高/ 的/ 猜测/ 轮/ 密钥/ ./ 使用/ 一组/ 明文/ 和/ 密文/ ,/ 通过/ 遍历/ 256/ 次/ ,/ 验证/ 该轮/ 密钥/ 的/ 猜测/ 是否/ 正确/ ./ 若/ 不/ 正确/ ,/ 再/ 选择/ 功率/ 谱/ 密度/ 的/ 下/ 一个/ 频率/ 点/ 对应/ 的/ 能量/ 值/ 进行/ 计算/ ,/ 直到/ 计算/ 完/ 所有/ 频率/ 点/ ;/ 若/ 正确/ ,/ 则/ 输出/ 正确/ 密钥/ ./ 下面/ ,/ 我们/ 将/ 设计/ 一种/ 可以/ 抵御/ DPA/ 攻击/ 的/ Page5/ 并/ 在/ 硬件/ 上/ 实现/ 该/ 安全/ 算法/ ./ DES/ 防护/ 设计/ ,/ 分别/ 使用/ DPA/ 方法/ 和/ DFqA/ 方法/ 进行/ 攻击/ ./ 对/ DFqA/ 方法/ 的/ 信号/ 预处理/ ,/ 使用/ 重/ 采样/ 与/ 未/ 使用/ 重/ 采样/ ,/ 来/ 对比/ 两种/ 信号处理/ 方式/ 影响/ 攻击/ 效率/ 的/ 情况/ ./ 4/ 攻击/ 实验/ 4.1/ 问题/ 为了/ 实验/ 验证/ 针对/ DPA/ 方法/ 的/ 防护/ 措施/ ,/ 对防/ DPA/ 有效/ ,/ 而/ 差分/ 频域/ 分析方法/ 可以/ 将/ 该/ 防护/ 措施/ 攻击/ 成功/ ./ 同时/ ,/ 在/ 同样/ 本下/ ,/ 本文/ 提出/ 的/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ 与/ 未/ 采用/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ 的/ 攻击/ 结果/ 对比/ ./ 因此/ ,/ 本文/ 需要/ 完成/ 以下/ 几个/ 工作/ :/ (/ 1/ )/ 设计/ 防/ DPA/ 攻击/ 的/ 带/ 防护/ DES/ 安全/ 算法/ ,/ (/ 2/ )/ 整个/ 功耗/ 信号/ 采集/ 系统/ 的/ 搭建/ 工作/ ./ (/ 3/ )/ 功耗/ 曲线/ 采集/ 过程/ 中/ ,/ 为了/ 提高/ 功耗/ 信号/ 的/ 质量/ ,/ 需要/ 加入/ 硬件/ 低通滤波器/ ./ (/ 4/ )/ 重/ 采样/ 算法/ 的/ 合理/ 实现/ ,/ 也/ 会/ 对/ 最终/ 的/ 信号处理/ 产生/ 较大/ 的/ 影响/ ./ 以上/ 几个/ 工作/ 中/ ,/ 防护/ 措施/ 的/ 实现/ 以及/ 采集/ 系统/ 的/ 搭建/ 为/ 本次/ 实验/ 的/ 难点/ ,/ 重/ 采样/ 算法/ 的/ 合理/ 实现/ 为本/ 实验/ 的/ 难点/ 和/ 关键/ ./ 4.2/ 实验/ 设置/ 4.2/ ./ 1DES/ 安全/ 算法/ 实现/ 由/ 文献/ [/ 5/ -/ 6/ ]/ 的/ 防/ DPA/ 方法/ ,/ 本/ 实验/ 选择/ 了/ 相似/ 的/ 一种/ 防护/ DPA/ 攻击/ 的/ 防护/ 措施/ ./ 为了/ 避免/ DES/ 算法/ 运行/ 时/ ,/ 在/ 时间/ 上/ 可以/ 精确/ 对齐/ ,/ 我们/ 采用/ 随机数/ 来/ 控制/ DES/ 算法/ 运算/ 的/ 随机/ 启动/ ./ 这种/ 防护/ 措施/ 可以/ 使得/ DES/ 算法/ 的/ 关键/ 运算/ 在/ 时间/ 上/ 不/ 固定/ ,/ 不能/ 在/ 时域/ 上/ 进行/ 对齐/ ,/ 从而/ 达到/ 不能/ 直接/ 攻击/ 的/ 目的/ ./ 同时/ ,/ 为了/ 掩盖/ DES/ 真实/ 运算/ 功耗/ 特征/ 与/ 随机/ 延时/ 的/ 功耗/ 特征/ 差异/ ,/ 避免/ 可以/ 通过/ 对/ DES/ 信号/ 特征/ 进行/ 对齐/ ,/ 从而/ 通过/ 对齐/ 曲线/ 还/ 可以/ 使用/ DPA/ 方法/ 进行/ 攻击/ 成功/ ./ 本文/ 的/ 防护/ 措施/ 中/ 的/ 一项/ 为/ 功耗/ 隐藏/ ,/ 即/ 在/ 整个/ 运行/ 过程/ 中/ 加入/ CPU/ 操作/ 功耗/ ,/ 对/ DES/ 运算/ 功耗/ 进行/ 掩盖/ ./ 固定/ DES/ 整个/ 运行/ 时间/ 为/ 128/ 周期/ ,/ 前后/ 两段/ 随机/ 延时/ 的/ 周期/ 固定/ 为/ 112/ 周期/ ./ 随机/ 运行/ DES/ 操作/ 的/ 防护/ 措施/ 示意图/ ,/ 如图/ 4/ 所示/ ./ 带/ 防护/ 措施/ 的/ DES/ 设计/ 代码/ ,/ 如图/ 5/ 所示/ ./ t/ =/ GerRrnd/ (/ )/ ;/ t/ =/ t/ %/ 112/ ;/ InitDes/ (/ )/ ;/ mencpy/ (/ DestAddr/ ,/ SrcAddr/ ,/ t/ )/ ;/ // // 开启/ 功耗/ 扰动/ StartDes/ (/ )/ ;/ mencpy/ (/ DestAddr/ ,/ SrcAddr/ ,/ 128/ -/ t/ )/ ;/ // // 开启/ 功耗/ 扰动/ getDesRes/ (/ )/ ;/ 使用/ SASEBO/ -/ GII/ 算法/ 设计/ 仿真/ 板/ ,/ 其为/ 算法/ FPGA/ (/ CryptographicFPGA/ )/ ./ 在/ FPGA/ 上/ 实现/ 上述/ 带/ 安全/ 的/ DES/ 算法/ 设计/ ./ 该/ 防护/ 措施/ 主要/ 为/ 两项/ :/ 一为/ 随机/ 运行/ DES/ 算法/ ,/ 二为/ 在/ 整个/ 运行/ 过程/ 中/ 加入/ 随机/ CPU/ 噪声/ ./ SASEBO/ 仿真/ 板/ 自带/ 晶振是/ 24MHz/ ,/ 工程/ 中/ CPU/ 和/ DES/ 运行/ 频率/ 均/ 为/ 12MHz/ ./ SASEBO/ 仿真/ 板/ 的/ 实物图/ ,/ 如图/ 6/ 所示/ ./ 4.2/ ./ 2/ 实验/ 平台/ 集/ 部分/ 、/ 信号处理/ 部分/ 、/ 安全/ 攻击/ 部分/ ./ 整个/ 实验/ 平台/ 分为/ 三个/ 大部分/ ,/ 分别/ 为/ 功耗/ 采/ 安全/ 攻击/ 部分/ 主要/ 为/ PC机/ 安全/ 攻击/ 软件/ ./ 将/ 功耗/ 采集/ 部分/ ,/ 由/ SASEBO/ 仿真/ 板/ 、/ 示波器/ 、/ 读卡器/ 、/ PC机/ 、/ 稳压电源/ 等/ 组成/ ./ 将/ 加入/ 防护/ DPA/ 攻击/ 的/ DES/ 安全/ 算法/ 下载/ 至/ SASEBO/ 仿真/ 板上/ ./ 运行/ DES/ 安全/ 算法/ ,/ 在/ FPGA/ 内核/ 电压/ 上/ 串接/ 了/ 1/ 欧姆电阻/ ,/ 通过/ 测量/ 电阻/ 上/ 的/ 电压/ 变化/ ,/ 可/ 获得/ 功耗/ 信号/ ./ DES/ 的/ 运行/ 具体位置/ ,/ 由/ SASEBO/ 板来/ 引出/ 内部/ 运算/ 指示/ 信号/ ,/ 定位/ 功耗/ 曲线/ 上/ 包含/ 防护/ 措施/ 的/ 整个/ DES/ 运算/ 位置/ ./ 信号处理/ 部分/ 由/ 硬件/ 滤波/ 和/ PC机/ 软件/ 处理软件/ 组成/ ./ 测量/ 得到/ DES/ 功耗/ 信息/ 后/ ,/ 保存/ 在/ PC机/ 上/ ,/ 由/ 软件/ 实现/ 重/ 采样/ 信号处理/ 和/ FFT/ 变换/ 后/ 的/ 频谱/ 能量/ 值/ ./ Page6/ 信号处理/ 之后/ 的/ 能量/ 信息/ ,/ 用于/ 安全/ 攻击/ ,/ 得到/ 最终/ 攻击/ 结果/ ./ 整个/ 实验/ 平台/ 连接/ 示意图/ ,/ 如图/ 7/ 所示/ ,/ 电脑/ 通过/ USB/ 接口/ 控制/ Gemalto/ 的/ PCSC/ 读卡器/ ,/ PCSC/ 读卡器/ 通过/ 7816/ 转/ 接口/ 与/ SASEBO/ 仿真/ 板/ 通信/ ./ SASEBO/ 仿真/ 板上/ 消耗/ 的/ 电流/ 信号/ 通过/ 示波器/ 采集/ 后/ 通过/ UTP/ 网络连接/ 传送/ 至/ 电脑/ ./ SASEBO/ 仿真/ 板/ 使用/ 直流电/ 流源/ 供电/ ./ 4.2/ ./ 3DES/ 的/ DFqA/ 方法/ 实现/ 在/ 对/ DES/ 算法/ 的/ DPA/ 分析/ 中/ ,/ 需要/ 确定/ 和/ 计算/ 出/ 一个/ 和/ 密钥/ 相关/ 的/ 中间/ 数据/ ,/ 用以/ 与/ 频谱/ 幅值/ 进行/ 相关性/ 计算/ ./ 图/ 8/ 给出/ 了/ DES/ 的/ 运算/ 图/ 和/ 可以/ 利用/ 的/ 数据/ 点/ ./ 图/ 8/ 中/ ,/ (/ L0/ ,/ R0/ )/ 组成/ 了/ DES/ 算法/ 64bit/ 明文/ 输入/ ,/ 按照/ DES/ 算法/ 流程/ 分别/ 进行/ E/ 扩张/ 、/ 与/ 轮/ 密钥/ K/ 进行/ 异或/ 操作/ 、/ S/ -/ box/ 操作/ 、/ P/ 置换/ 、/ 与/ L0/ 进行/ 异或/ 操作/ ,/ 之后/ 输出/ 第/ 1/ 轮/ 的/ 轮/ 输出/ (/ L1/ ,/ R1/ )/ ,/ 以上/ 完成/ 了/ DES/ 第/ 1/ 轮/ 运算/ ./ 图/ 8/ 中/ ,/ 标示出/ 了/ 两个/ 输入/ 数据/ 点/ (/ I1/ ,/ I2/ )/ ,/ 两个/ 输出/ 数据/ 点/ (/ O1/ ,/ O2/ )/ ./ 实际/ 攻击/ 中/ ,/ 常用/ 的/ 6/ 个/ 攻击/ 位置/ 点/ 分别/ 如表/ 1/ 所示/ ./ 序号/ 12S/ 盒/ 输出/ 与/ 轮/ 输入/ 的/ 异或/ O1/ / I13S/ 盒/ 输出/ 与/ S/ 盒/ 输入/ 的/ 异或/ O1/ / I2456/ 轮/ 输出/ 与/ S/ 盒/ 输入/ 的/ 异或/ O2/ / I2/ 根据/ 文献/ [/ 17/ ]/ 描述/ ,/ 使用/ 汉明/ 重/ 的/ 功耗/ 模型/ 对/ 寄存器/ 翻转/ 的/ 效果/ 明显/ ./ 因此/ ,/ 本次/ 实验/ 选择/ 轮/ 输出/ 数据/ O2/ 和/ 轮/ 输入/ 数据/ I1/ 的/ 异或/ 作为/ 攻击/ 中间/ 值/ ,/ 功耗/ 模型/ 选择/ 汉明/ 重/ 模型/ ./ 部分/ 攻击/ 程序/ 如图/ 9/ 所示/ ./ IndexOfTrace/ =/ 0Input/ (/ CountOfTrace/ )/ Do/ {/ Input/ (/ Plain/ ,/ Crypto/ ,/ P/ )/ byIndexOfTraceIP/ _/ OUT/ =/ PermuteIP/ (/ Plain/ )/ R/ =/ LOW32Bit/ (/ IP/ _/ OUT/ )/ // // 低/ 32bit/ 数据/ L/ =/ HIGH32Bit/ (/ IP/ _/ OUT/ )/ // // 高/ 32bit/ 数据/ E/ _/ OUT/ =/ PermuteE/ (/ R/ )/ // // 初始/ 置换/ FORi/ =/ 0TO64STEP1/ {/ SBOXIN/ =/ GessKey/ (/ i/ )/ / E/ _/ OUTSBOXOUT/ =/ DesSBox/ (/ SBOXIN/ )/ SBOXOUT/ =/ SBOXOUT/ / InversePermuteP/ (/ L/ )/ hammingWeights/ [/ i/ ]/ =/ CalculateHammingWeight/ (/ SBOXOUT/ )/ // // 计算/ 猜测/ 密钥/ 的/ 中间/ 值/ 汉明/ 重/ }/ Keys/ =/ CalculateCorrlation/ (/ hammingWeights/ ,/ P/ )/ // // 猜测/ 中间/ 值/ 与/ 频域/ 值/ 计算/ 相关性/ FindKey/ =/ VerifyKeys/ (/ Plain/ ,/ Crypto/ ,/ Keys/ )/ // // 使用/ 明/ 密文/ 数据/ 验证/ 猜测/ 密钥/ 是否/ 正确/ IFFindKeyTHENDoOutput/ (/ Keys/ )/ IndexOfTrace/ =/ IndexOfTrace/ +/ 1/ }/ Util/ (/ IndexOfTrace/ >/ =/ CountOfTraceORFindKey/ )/ 4.3/ 攻击/ 实验/ 4.3/ ./ 1/ 功耗/ 数据/ 采集/ 使用/ 搭建/ 的/ 实验/ 平台/ ,/ 运行/ DES/ 算法/ ,/ 采集/ 整个/ DES/ 算法/ 的/ 功耗/ ./ DES/ 算法/ 包含/ 两个/ 防护/ 措施/ ,/ 采集/ 大量/ 曲线/ 条数/ ./ 给出/ 其中/ 一条/ 整体/ 的/ DES/ 功耗/ 曲线/ ,/ 如图/ 10/ 所示/ ./ 图/ 10/ 中/ ,/ 黑框/ 部分/ 为/ 带/ 安全/ 防护/ 的/ 整个/ DES/ 运行/ 过程/ 的/ 功耗/ 特征/ ,/ 其/ 由/ 随机/ 等待/ 和/ DES/ 运行/ 两/ 部分/ 组成/ ,/ 整个/ DES/ 运行/ 过程/ 中均/ 有/ 功耗/ 干扰/ 操作/ ./ 从/ 上/ 图/ 中/ ,/ 不能/ 确定/ DES/ 算法/ 运行/ 特征/ ,/ 并/ 在/ 时/ Page7/ 图/ 10/ 原始/ 采集/ 信号/ 间/ 上/ 不/ 对齐/ ,/ 因此/ 不能/ 使用/ 特征/ 对齐/ 的/ 方式/ 来/ 进行/ 信号/ 预处理/ 再/ 进行/ DPA/ 攻击/ ./ 因而/ ,/ 该/ DES/ 防护/ 措施/ ,/ 在/ 时域/ 上/ 不能/ 进行/ 攻击/ 的/ 情况/ 下/ ,/ 该/ 防护/ 措施/ 可/ 使用/ 差分/ 频域/ 攻击/ 方法/ 来/ 开展/ 攻击/ ./ 4.3/ ./ 2/ 曲线/ 预处理/ (/ 1/ )/ 重/ 采样/ 处理/ 采集/ 的/ 时域/ 信号/ 噪声/ 较/ 多/ ,/ 使用/ DES/ 的/ 工作/ 频图/ 11/ 重/ 采样/ 后/ 信号/ 图/ 12/ 重/ 采样/ 后/ 功率/ 谱/ 图图/ 13/ 原始/ 信号/ 的/ 功率/ 谱/ 图率/ 12MHz/ 作为/ 重/ 采样/ 频率/ ,/ 应用/ 重/ 采样/ 处理/ ,/ 得到/ 重/ 采样/ 后/ 的/ 信号/ ,/ 如图/ 11/ 所示/ ./ 重/ 采样/ 后/ 的/ 信号/ ,/ 噪声/ 减少/ ./ 对重/ 采样/ 后/ 的/ 时域/ 信号/ ,/ 使用/ FFT/ 变换/ ,/ 得到/ 功率/ 谱/ 分布/ ,/ 如图/ 12/ 所示/ ./ (/ 2/ )/ 未/ 进行/ 重/ 采样/ 处理/ 对/ 采集/ 的/ 原始/ 信号/ ,/ 不/ 经过/ 重/ 采样/ 处理/ ,/ 直接/ FFT/ 变换/ 后/ 得到/ 功率/ 谱/ 密度/ ,/ 如图/ 13/ 所示/ ./ Page8/ 使用/ 重/ 采样/ 后/ 的/ 功率/ 谱/ 和/ 未/ 进行/ 重/ 采样/ 的/ 功率/ 谱/ 分别/ 进行/ 攻击/ 实例/ ./ 4.4/ 实验/ 结果/ 与/ 分析/ 4.4/ ./ 1DPA/ 和/ DFqA/ 攻击/ 结果/ 使用/ DPA/ 和/ DFqA/ 两种/ 方法/ ,/ 对/ DES/ 随机/ 延时/ 运行/ 和/ 功耗/ 干扰/ 的/ 防护/ 措施/ 进行/ 攻击/ ./ 对/ 原始/ 信号/ 进行/ DPA/ 攻击/ ,/ 再/ 对/ 原始/ 信号/ 的/ 频率/ 能量/ 信号/ 进行/ DFqA/ 攻击/ ,/ 攻击/ 结果/ 如表/ 2/ 所示/ ./ 序号/ 攻击/ 方法/ 12DFqA353/ 万条/ 曲线/ 攻击/ 出/ 密钥/ 由表/ 2/ ,/ 使用/ 488/ 万条/ 曲线/ ,/ DPA/ 攻击/ 未能/ 获取/ DES/ 密钥/ ,/ 而/ DFqA/ 攻击/ 在/ 353/ 万条/ 曲线/ 时/ ,/ 就/ 成功/ 获取/ 了/ DES/ 密钥/ ./ 将/ 功耗/ 曲线/ 与/ 第/ 1/ 轮/ 可能/ 的/ 64/ 个子/ 密钥/ 进行/ 相关性/ 计算/ ,/ 得到/ 攻击/ 的/ 功耗/ 曲线/ 与子/ 密钥/ 的/ 相关性/ 图/ ,/ 如图/ 14/ 所示/ ./ 如图/ 14/ ,/ (/ a/ )/ 图中/ 使用/ DPA/ 方法/ 攻击/ 488/ 万条/ 曲线/ ,/ 第/ 1/ 轮/ 所有/ 子/ 密钥/ 无/ 任何/ 明显/ 高/ 相关性/ 曲线/ 出现/ ;/ (/ b/ )/ 图中/ 使用/ DFqA/ 方法/ 攻击/ 353/ 万条/ 曲线/ 后/ ,/ 第/ 1/ 轮/ 正确/ 密钥/ 呈现出/ 高/ 相关性/ ./ DPA/ 方法/ 未能/ 获取/ 正确/ 密钥/ ,/ DFqA/ 方法/ 可/ 获取/ 正确/ 密钥/ ./ 4.4/ ./ 2/ 不同/ 信号处理/ 的/ DFqA/ 攻击/ 结果/ 为了/ 对/ 比重/ 采样/ 处理/ 的/ 效果/ ,/ 我们/ 分别/ 使用/ 重/ 采样/ 处理/ 以及/ 原始/ 信号/ 的/ 功率/ 谱/ 进行/ 攻击/ 验证/ ./ 应用/ 差分/ 频率/ 分析/ 算法/ 流程/ 进行/ 攻击/ 分析/ ./ 使用/ DFqA/ 攻击/ 分别/ 对/ 两种/ 功率/ 谱/ 密度/ 曲线/ 进行/ 安全/ 攻击/ ,/ 攻击/ 结果/ 如表/ 3/ 所示/ ./ 序号/ 处理过程/ 获得/ 密码/ 所/ 需/ 曲线/ 条数/ (/ 万条/ )/ 1/ 重/ 采样/ ,/ FFT/ ,/ 功率/ 谱/ 密度/ 166/ 万条/ 攻击/ 出/ 密钥/ 2FFT/ ,/ 功率/ 谱/ 密度/ 353/ 万条/ 攻击/ 出/ 密钥/ 由表/ 3/ ,/ 对/ 原始/ 信号/ 以及/ 重/ 采样/ 处理/ 后/ 的/ 信号/ 进行/ FFT/ 变换/ 后/ 得到/ 的/ 两个/ 功率/ 谱/ 分布/ 信号/ ,/ 使用/ DFqA/ 方法/ ,/ 均/ 可以/ 攻击/ 出/ 正确/ 密钥/ ./ 使用/ 重/ 采样/ 处理/ ,/ 攻击/ 所/ 需/ 曲线/ 减少/ 到/ 未/ 使用/ 重/ 采样/ 处理/ 的/ 曲线/ 条数/ 的/ 一半/ ./ 从图/ 14/ 中/ 的/ 计算/ 相关性/ 曲线/ 可/ 看出/ ,/ 在/ 166/ 万条/ 曲线/ 后/ ,/ 正确/ 的/ 第/ 1/ 轮子/ 密钥/ 的/ 相关性/ 要/ 高于/ 其他/ 子/ 密钥/ ,/ 重/ 采样/ 的/ DFqA/ 攻击/ 方法/ 使用/ 166/ 万条/ 曲线/ 即可/ 攻击/ 出/ 密钥/ ./ 其中/ ,/ 图/ (/ c/ )/ 给出/ 了/ 重/ 采样/ 的/ DFqA/ 攻击/ 的/ 相关性/ 曲线/ ./ Hodgers/ 等/ 人/ [/ 16/ ]/ 针对/ 随机/ 抖动/ 防护/ 措施/ 的/ AES/ 使用/ 了/ 滑动/ 窗/ 的/ 信号处理/ 方法/ 来/ 提高/ 信噪比/ ,/ 其仅/ 对比/ 了/ 未/ 对齐/ 情况/ 下/ 普通/ DPA/ 不能/ 攻击/ 成功/ ,/ 而/ 滑动/ 窗/ 处理/ 后/ 的/ DFqA/ 可以/ 攻击/ 成功/ ,/ 却/ 没有/ 进行/ 滑动/ 窗/ 处理/ 前后/ DFqA/ 攻击/ 情况/ 的/ 分析/ ./ 本文/ 将/ 两种/ 情况/ 均作/ 了/ 对比/ 试验/ ,/ 试验/ 结果表明/ DES/ 算法/ 在/ 带有/ 随机/ 延时/ 和/ 功耗/ 干扰/ 的/ 防护/ 措施/ 下/ ,/ 普通/ DPA/ 不能/ 攻击/ 成功/ ,/ 而/ DFqA/ 使用/ 353/ 万条/ 曲线/ ,/ 可以/ 攻击/ 出/ DES/ 密钥/ ./ 进一步/ 采用/ 基于/ 重/ 采样/ 的/ DFqA/ 使用/ 166/ 万条/ 曲线/ 就/ 能/ 攻击/ 出/ DES/ 密钥/ ./ 从/ 攻击/ 所/ 需/ 曲线/ 条数/ 和/ 相关性/ 系数/ 比较/ ,/ 可/ 确定/ Page9/ 重/ 采样/ 处理/ 大大提高/ 了/ 信噪比/ ,/ 降低/ 了/ 攻击/ 所/ 需/ 的/ 曲线/ 条数/ ,/ 在/ 实际/ 攻击/ 中/ ,/ 将/ 攻击/ 效率/ 提高/ 了/ 一倍/ ./ 5/ 相关/ 工作/ 随着/ 金融/ 智能卡/ 、/ 社保卡/ 等/ 高/ 安全/ 芯片/ 的/ 应用/ ,/ 对/ 智能卡/ 的/ 信息安全/ 要求/ 越来越/ 高/ ./ 各种/ 智能卡/ 芯片/ 要求/ 达到/ 相应/ 的/ 安全级别/ ,/ 安全/ 攻击/ 则/ 是/ 检验/ 安全性/ 的/ 重要/ 手段/ ./ 相应/ 的/ 侧/ 信道/ 的/ 安全/ 攻击/ 方法/ 研究/ 和/ 应用/ 越来越/ 多/ ./ 侧/ 信道/ 的/ 安全/ 攻击/ 方法/ 种类/ 繁多/ ./ 从/ 1996/ 年/ Kocher/ 等/ 人/ [/ 1/ ]/ 首次/ 提出/ 简单/ 功耗/ 分析方法/ 之后/ ,/ 又/ 提出/ 了/ 差分/ 功耗/ 分析方法/ ./ 2002/ 年/ 的/ CHES/ 会议/ 上/ ,/ Chari/ 等/ 人/ [/ 6/ ,/ 17/ ]/ 提出/ 了/ 模板/ 攻击/ 方法/ ,/ 该/ 方法/ 是/ 最/ 强大/ 侧/ 信道/ 攻击/ 方法/ ./ 在/ 2005/ 年/ 的/ CHES/ 会议/ 上/ ,/ Gebotys/ 等/ 人/ [/ 12/ ]/ 针对/ 电磁/ 信号/ 验证/ 了/ 频域/ 分析方法/ ,/ 之后/ DFqA/ 方法/ 研究/ 越来越/ 多/ [/ 13/ -/ 16/ ]/ ./ 除了/ 针对/ 功耗/ 信号/ 之外/ ,/ 还有/ 对/ 电磁/ 信号/ 、/ 射频/ 信号/ 的/ 分析/ ./ 目前/ ,/ 这些/ 流行/ 的/ 攻击/ 方法/ 也/ 是/ 安全性/ 检测/ 机构/ 常用/ 的/ 检测/ 攻击/ 方法/ ./ 在/ 实际/ 安全/ 攻击/ 中/ ,/ 对/ 攻击/ 的/ 信号/ 对象/ 进行/ 预处理/ 的/ 过程/ ,/ 用以/ 提高/ 信号/ 的/ 信噪比/ ,/ 也/ 逐渐/ 被/ 大家/ 关注/ ./ 随之而来/ ,/ 一些/ 学者/ 开始/ 研究/ 侧/ 信道/ 安全/ 攻击/ 中/ 的/ 信号处理/ 技术/ ./ VanWoudenberg/ 等/ 人/ [/ 20/ ]/ 研究/ 了/ 动态/ 时间/ 弯曲/ 算法/ ,/ 将/ 其/ 应用/ 在/ 了/ 信号/ 对齐/ 上/ ,/ 以/ 提高/ 信号/ 的/ 精确/ 对齐/ 从而/ 提高/ DPA/ 攻击/ 效率/ ./ Le/ 等/ 人/ [/ 21/ ]/ 将/ 四阶/ 累计/ 的/ 统计/ 方法/ 应用/ 到/ 了/ 信号处理/ 中/ ,/ 提高/ 了/ 信号/ 信噪比/ ./ Archambeau/ 等/ 人/ [/ 22/ ]/ 研究/ 了/ 独立/ 成分/ 分析/ 的/ 统计/ 方法/ ,/ 并/ 将/ 其/ 应用/ 到/ 了/ 模板/ 攻击/ 中/ ,/ 在/ 不/ 降低/ 信息量/ 的/ 情况/ 下/ ,/ 降低/ 攻击/ 样本/ ./ 这些/ 信号处理/ 方法/ ,/ 可以/ 提高/ 攻击/ 信号/ 的/ 信噪比/ ,/ 提高/ 攻击/ 效率/ ,/ 甚至/ 是/ 攻击/ 成功率/ ./ 因此/ ,/ 在/ 安全/ 攻击/ 中/ ,/ 攻击/ 对象/ 的/ 信号/ 预处理/ 显得/ 格外/ 重要/ ./ DFqA/ 方法/ 较之/ DPA/ 攻击/ 方法/ ,/ 要/ 带入/ 更/ 多/ 的/ 噪声/ ./ 在/ DFqA/ 方法/ 的/ 使用/ 中/ ,/ 对/ 信号/ 的/ 处理/ 也/ 就/ 非常/ 重要/ ./ 然而/ ,/ 对于/ DFqA/ 方法/ 的/ 信号/ 信噪比/ 提升/ 的/ 研究/ 文献/ 较少/ ./ 2011/ 年/ ,/ Hodgers/ 等/ 人/ [/ 16/ ]/ 针对/ 随机/ 抖动/ 防护/ 措施/ 的/ AES/ 使用/ 了/ 滑动/ 窗/ 的/ 信号处理/ 方法/ ,/ 该/ 方法/ 与/ 差分/ 频域/ 分析方法/ 结合/ ,/ 可/ 成功/ 获取/ AES/ 密钥/ ./ 但是/ 该/ 方法/ 实现/ 的/ AES/ 算法/ ,/ 仍/ 可以/ 通过/ 对齐/ 功耗/ 特征/ ,/ 使用/ DPA/ 方法/ 获取/ 正确/ 密钥/ ./ 在/ 现有/ 文献/ 中/ ,/ 并/ 没有/ 对/ DES/ 随机/ 延时/ 运行/ 和/ 功耗/ 干扰/ 两项/ 防护/ 措施/ 的/ 攻击/ 研究/ ,/ 而/ 本文/ 就此/ 进行/ 了/ 攻击/ 研究/ 和/ 攻击/ 实施/ ./ 6/ 结论/ 本文/ 在/ 现有/ 差分/ 频域/ 分析方法/ 上/ ,/ 提出/ 了/ 一种/ 基于/ 重/ 采样/ 的/ 差分/ 频域/ 分析方法/ ./ 此/ 方法/ 的/ 主要/ 特点/ 是/ 采用/ 重/ 采样/ 的/ 信号/ 预处理/ 技术/ 提高/ 信噪比/ ,/ 解决/ 差分/ 频域/ 分析方法/ 引起/ 的/ 噪声/ 问题/ ,/ 将/ 攻击/ 效率/ 提高/ 一倍/ ./ 在/ FPGA/ 上/ 实现/ 了/ 防御/ DPA/ 攻击/ 的/ 随机/ 延时/ 运行/ 以及/ 功耗/ 干扰/ 的/ DES/ 算法/ ./ 在/ 时域/ 上/ 不能/ 确定/ DES/ 关键/ 运算/ 运行/ 位置/ ,/ 而且/ 其/ 运行/ 时刻/ 是/ 不断/ 改变/ 的/ ,/ 在/ DPA/ 不能/ 实施/ 攻击/ 的/ 情况/ 下/ ,/ 使用/ 差分/ 频域/ 分析攻击/ 方法/ ,/ 可以/ 成功/ 获取/ DES/ 密钥/ ./ 同时/ ,/ 实验/ 证明/ ,/ 对/ 采集/ 的/ 时域/ 信号/ 进行/ 重/ 采样/ 处理/ ,/ 可以/ 非常/ 有效/ 地/ 提高/ 信号/ 的/ 信噪比/ ,/ 降低/ 攻击/ 所/ 需/ 的/ 曲线/ 数量/ ,/ 将/ 整个/ 安全/ 攻击/ 的/ 效率/ 提高/ 一倍/ ./ 针对/ DES/ 随机/ 延时/ 运行/ 防护/ 措施/ ,/ 本文/ 提出/ 的/ 重/ 采样/ 频域/ 攻击/ 方法/ 攻击/ 效率/ 更高/ ./ 本文/ 的/ 攻击/ 研究/ ,/ 在/ 设计/ 安全/ 防护/ 措施/ 时/ ,/ 不仅/ 要/ 考虑/ 在/ 时域/ 上/ 防护/ DPA/ ,/ 同时/ 还要/ 考虑/ 在/ 频域/ 上/ 防护/ DFqA/ ./ 频域/ 上/ 防护/ DFqA/ ,/ 可以/ 增加/ 更/ 多/ 噪声/ 或者/ 随机/ 芯片/ 工作频率/ 等/ 措施/ ./ 致谢/ 审稿/ 专家/ 和/ 编辑/ 为/ 本文/ 提出/ 了/ 宝贵/ 的/ 意见/ 和/ 建议/ ,/ 作者/ 在/ 此/ 表示/ 衷心感谢/ !/ 

