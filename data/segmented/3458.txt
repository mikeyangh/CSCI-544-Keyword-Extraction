Page1/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ 马卓/ 1/ )/ 马建峰/ 1/ )/ ,/ 2/ )/ 李兴华/ 1/ )/ 姜奇/ 1/ )/ 1/ )/ (/ 西安电子科技大学/ 计算机/ 学院/ 西安/ 710071/ )/ 2/ )/ (/ 西安电子科技大学/ 计算机网络/ 与/ 信息安全/ 教育部/ 重点/ 实验室/ 西安/ 710071/ )/ 摘要/ 该文/ 作者/ 发现/ 可信计算/ 组织/ TCG/ 提出/ 的/ 可信/ 网络连接/ 架构/ 存在/ 安全/ 缺陷/ ,/ 攻击者/ 利用/ 这一/ 缺陷/ 可以/ 发起/ 一种/ 平台/ 替换/ 攻击/ ,/ 攻击/ 将/ 导致/ 可信/ 网络连接/ 过程/ 中/ 平台/ 身份/ 认证/ 的/ 失败/ 和/ 平台/ 完整性/ 校验/ 错误/ ./ 针对/ 这一/ 情况/ ,/ 文中/ 形式化/ 地/ 给出/ 了/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ ./ 在/ 此基础/ 之上/ ,/ 为了/ 使/ 协议/ 的/ 设计/ 和/ 分析/ 更具/ 一般性/ 和/ 安全性/ ,/ 提出/ 一种/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ (/ TNC/ -/ PS/ )/ ,/ 通过/ 模型/ 中/ 的/ 绑定/ 器/ ,/ 可/ 将/ 理想/ 环境/ 下/ 设计/ 的/ 完整性/ 评估/ 层/ 协议/ ,/ 转化/ 为/ 实际/ 环境/ 下/ 安全性/ 相同/ 的/ 等价/ 协议/ ./ 从而/ 在/ 保持/ 可信/ 网络连接/ 架构/ 不变/ 的/ 基础/ 上/ ,/ 避免/ 其/ 安全/ 缺陷/ 造成/ 的/ 影响/ ./ 最后/ ,/ 利用/ TNC/ -/ PS/ 模型/ 设计/ 了/ 一个/ 完整性/ 评估/ 层/ 协议/ ,/ 该/ 协议/ 能够/ 满足/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ ./ 关键词/ 可信/ 网络连接/ ;/ 平台/ 替换/ 攻击/ ;/ 可/ 证明/ 安全/ 模型/ ;/ 绑定/ 器/ 1/ 引言/ 随着/ 计算机网络/ 与/ 信息化/ 的/ 不断/ 发展/ ,/ 信息安全/ 问题/ 日趋/ 复杂/ ,/ 系统安全/ 问题/ ,/ 特别/ 是/ 计算机/ 平台/ 的/ 开放/ 框架/ 所/ 带来/ 的/ 威胁/ 层出不穷/ ./ 面对/ 严峻/ 的/ 网络安全/ 形势/ ,/ 传统/ 的/ 信息安全/ 系统/ 从/ 架构/ 和/ 强度/ 上/ 已经/ 难有/ 大/ 的/ 突破/ ./ 人们/ 在/ 信息安全/ 的/ 实践/ 中/ 逐渐/ Page2/ 认识/ 到/ ,/ 大多数/ 安全隐患/ 来自/ 于/ 终端/ ,/ 因此/ 必须/ 确保/ 源头/ 的/ 信息安全/ ,/ 即/ 从/ 每/ 一台/ 连接/ 到/ 网络/ 的/ 终端/ 开始/ ,/ 遏制/ 恶意/ 攻击/ ,/ 由此/ 产生/ 出/ 可信计算/ 的/ 基本/ 思想/ [/ 1/ -/ 5/ ]/ ./ 可信计算/ 本质/ 上/ 是/ 要/ 通过/ 增强/ 现有/ 终端/ 体系结构/ 的/ 安全性/ 来/ 保证/ 整个/ 系统/ 的/ 安全/ ,/ 其/ 主要/ 思路/ 是/ 基于/ 安全/ 硬件/ 和/ 安全/ 操作系统/ 来/ 实现/ 一个/ 可信/ 的/ 平台/ ./ 可信计算/ 经过/ 多年/ 的/ 发展/ ,/ 1999/ 年/ 由/ IBM/ 、/ HP/ 等/ 著名/ IT/ 企业/ 发起/ 成立/ 了/ 可信计算/ 平台/ 联盟/ TCPA/ (/ TrustedComputingPlatformAlliance/ )/ ,/ 2003/ 年/ TCPA/ 改组/ 为/ 可信计算/ 组织/ TCG/ (/ TrustedComputingGroup/ )/ ./ 可信计算/ 组织/ 制定/ 了/ 关于/ 可信/ 平台/ 模块/ [/ 6/ ]/ 、/ 可信/ 存储/ [/ 7/ ]/ 等/ 一系列/ 技术规范/ ,/ 在/ 可信计算/ 领域/ 具有/ 较大/ 的/ 影响力/ ./ 其/ 可信/ 网络连接/ 分组/ (/ TNCSubGroup/ ,/ TNC/ -/ SG/ )/ 制定/ 了/ 一个/ 基于/ 可信计算/ 技术/ 的/ 可信/ 网络连接/ TNC/ 架构/ [/ 8/ ]/ ,/ 它/ 本质/ 上/ 就是/ 要/ 从/ 终端/ 的/ 完整性/ 开始/ ,/ 建立/ 连接/ ./ 在/ 传统/ 网络/ 接入/ 认证/ 基础/ 上/ ,/ 增加/ 平台/ 的/ 身份/ 认证/ 和/ 平台/ 的/ 完整性/ 校验/ ,/ 终端用户/ 只有/ 在/ 两层/ 认证/ 通过/ 且/ 平台/ 完整性/ 校验/ 成功/ 后/ 才/ 可以/ 接入/ 网络/ ./ 研究/ 人员/ 对/ TNC/ 架构/ 以及/ 基于/ TNC/ 架构/ 的/ 可信/ 网络连接/ 协议/ 进行/ 了/ 大量/ 的/ 研究/ [/ 9/ -/ 13/ ]/ ./ IBM/ 公司/ 在/ TNC/ 架构/ 基础/ 上/ 提出/ 了/ 一个/ 完整性/ 评估/ 层/ 协议/ —/ —/ —/ 完整性/ 报告/ 协议/ [/ 13/ ]/ ,/ 该/ 协议/ 实现/ TNC/ 架构/ 中/ 完整性/ 评估/ 层/ 平台/ 的/ 身份/ 认证/ 和/ 完整性/ 校验/ ./ 本文/ 通过/ 对/ TNC/ 架构/ 和/ 完整性/ 报告/ 协议/ 的/ 分析/ 发现/ ,/ TNC/ -/ SG/ 提出/ 的/ 可信/ 网络连接/ (/ TNC/ )/ 架构/ 存在/ 一个/ 安全/ 缺陷/ ,/ 即/ 用户/ 与/ 平台/ 之间/ 没有/ 安全/ 绑定/ 关系/ ,/ 这一/ 安全/ 缺陷/ 直接/ 造成/ 基于/ TNC/ 架构/ 的/ 完整性/ 评估/ 层/ 协议/ 漏洞/ ./ 因此/ ,/ 可信/ 网络连接/ 协议/ 的/ 设计/ 应/ 避免/ 这一/ 漏洞/ ./ 为/ 使/ 协议/ 的/ 设计/ 和/ 分析/ 更具/ 一般性/ 和/ 安全性/ ,/ 本文/ 设计/ 了/ 一个/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ ,/ 通过/ 模型/ 指导/ 协议/ 的/ 设计/ 和/ 分析/ ,/ 从而/ 解决/ 了/ TNC/ 架构/ 的/ 安全/ 缺陷/ ./ 可信/ 网络连接/ 架构/ 是/ 在/ 传统/ 网络/ 认证/ 协议/ 接入/ 架构/ 基础/ 上/ 提出/ 的/ ,/ 两者/ 有着/ 密切/ 的/ 联系/ 和/ 本质/ 的/ 区别/ ./ 因此/ 本文/ 基于/ 当前/ 非常/ 流行/ 的/ 可/ 证明/ 安全/ 形式化/ 方法/ —/ —/ —/ CK/ 模型/ [/ 14/ ]/ 的/ 基本/ 思想/ ,/ 结合/ TNC/ 架构/ 的/ 具体/ 规范/ [/ 8/ ]/ ,/ 设计/ 了/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ TNC/ -/ PS/ ./ TNC/ -/ PS/ 模型/ 为/ 两层/ 结构/ :/ 网络/ 访问/ 层/ 模型/ 和/ 完整性/ 评估/ 层/ 模型/ ./ 我们/ 通过/ 对/ 网络/ 访问/ 层/ 协议/ 的/ 内部/ 和/ 外部/ 攻击者/ 以及/ 协议/ 运行/ 环境/ 的/ 分析/ ,/ 指出/ CK/ 模型/ 可以/ 直接/ 作为/ 网络/ 访问/ 层/ 协议/ 的/ 设计/ 和/ 分析模型/ ./ 完整性/ 评估/ 层/ 模型/ 将/ 协议/ 的/ 运行/ 环境/ 抽象/ 为/ 两类/ :/ 可信/ 链路/ 模型/ (/ PTM/ )/ 和/ 非/ 可信/ 链路/ 模型/ (/ PUM/ )/ ./ 可信/ 链路/ 模型/ 是/ 一种/ 理想化/ 的/ 链路/ 模型/ ,/ 在/ 这/ 一/ 模型/ 中/ ,/ 网络/ 访问/ 层/ 用户/ 与/ 完整性/ 评估/ 层/ 平台/ 之间/ 存在/ 安全/ 绑定/ 关系/ ,/ 完整性/ 评估/ 层/ 协议/ 的/ 运行/ 在/ 网络/ 访问/ 层/ 安全/ 信道/ 保护/ 下/ 进行/ ;/ 非/ 可信/ 链路/ 模型/ PUM/ 是/ 现实/ 协议/ 的/ 运行/ 环境/ ,/ 其中/ 不/ 存在/ 上述/ 绑定/ 关系/ ./ 本文/ 还/ 提出/ 了/ 绑定/ 器/ 的/ 概念/ ,/ 它/ 是/ 完整性/ 评估/ 层/ 模型/ 的/ 核心/ ,/ 通过/ 绑定/ 器/ ,/ 可以/ 将/ PTM/ 中/ 设计/ 的/ 安全/ 协议/ 简单/ 的/ 转化/ 为/ PUM/ 中/ 具有/ 同等/ 安全性/ 的/ 协议/ ,/ 从而/ 避免/ TNC/ 架构/ 的/ 安全/ 缺陷/ ./ 本文/ 第/ 2/ 节对/ 背景/ 知识/ 进行/ 介绍/ ,/ 包括/ 可信/ 网络连接/ TNC/ 、/ CK/ 模型/ ;/ 第/ 3/ 节/ 给出/ 针对/ 完整性/ 评估/ 层/ 协议/ 的/ 一种/ 新/ 的/ 攻击/ —/ —/ —/ 平台/ 替换/ 攻击/ ,/ 并/ 指出/ TNC/ 架构/ 的/ 安全/ 缺陷/ ;/ 第/ 4/ 节/ 给出/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ TNC/ -/ PS/ ,/ 并/ 形式化/ 地/ 定义/ 可信/ 网络连接/ 协议/ ;/ 第/ 5/ 节/ 利用/ TNC/ -/ PS/ 模型/ 设计/ 一个/ 满足/ 可信/ 网络连接/ 安全/ 目标/ 的/ 完整性/ 评估/ 层/ 协议/ ;/ 最后/ 一节/ 对/ 全文/ 进行/ 总结/ 并/ 给出/ 下/ 一步/ 的/ 工作/ ./ 2/ 预备/ 知识/ 2.1/ 可信/ 网络连接/ 可信计算/ 组织/ 可信/ 网络连接/ 分组/ (/ TNCSubGroup/ ,/ TNC/ -/ SG/ )/ 制定/ 了/ 一个/ 基于/ 可信计算/ 技术/ 的/ 网络连接/ 规范/ ,/ 它/ 本质/ 上/ 就是/ 要/ 从/ 终端/ 的/ 完整性/ 开始/ ,/ 建立/ 连接/ ./ 即/ 在/ 传统/ 网络/ 接入/ 认证/ 基础/ 上/ ,/ 增加/ 平台/ 的/ 身份/ 认证/ 和/ 平台/ 的/ 完整性/ 校验/ ,/ 终端用户/ 只有/ 在/ 两层/ 认证/ 通过/ 且/ 平台/ 完整性/ 校验/ 成功/ 后/ 才/ 可以/ 接入/ 网络/ ./ 可信/ 网络连接/ (/ TNC/ )/ [/ 8/ ]/ 架构/ 如图/ 1/ 所示/ ,/ 包含/ 3/ 类/ 实体/ :/ 访问/ 请求者/ 、/ 策略/ 执行者/ 和/ 策略/ 决策者/ ,/ 这些/ 都/ 是/ 逻辑/ 实体/ ,/ 可以/ 分布/ 在/ 任意/ 位置/ ./ TNC/ 架构/ 在/ 纵向/ 从下到上/ 分为/ 3/ 个/ 层次/ ./ 网络/ 访问/ 层/ ./ 这/ 一层/ 用于/ 支持/ 传统/ 的/ 网络连接/ 技术/ ,/ 进行/ 用户/ 身份/ 认证/ 和/ 密钥/ 协商/ 并/ 建立/ 安全/ 信道/ ,/ 完成/ 后/ 通知/ 上层/ 进行/ 完整性/ 评估/ 层/ 协议/ ;/ Page3/ 完整性/ 评估/ 层/ ./ 负责/ 评估/ 所有/ 请求/ 访问/ 网络/ 的/ 平台/ 的/ 完整性/ ,/ 这/ 一层/ 协议/ 的/ 运行/ 受/ 网络/ 访问/ 层/ 安全/ 信道/ 的/ 保护/ ;/ 完整性/ 度量/ 层/ ./ 收集/ 和校验/ 请求/ 访问者/ 的/ 完整性/ 相关/ 信息/ 的/ 组件/ ./ 2.2/ Canetti/ -/ Krawczyk/ 模型/ CK/ (/ Canetti/ -/ Krawczyk/ )/ 模型/ 是/ 用于/ 形式化/ 分析/ 密钥/ 交换/ 协议/ 的/ 工具/ [/ 14/ ]/ ./ 该/ 模型/ 给出/ 了/ 会/ 话/ 密钥/ 安全/ 的/ 定义/ 和/ 利用/ 该/ 定义/ 证明/ 认证/ 和/ 密钥/ 交换/ 协议/ 安全性/ 的/ 模块化/ 方法/ ./ CK/ 模型/ 的/ 主要/ 目标/ 是/ ,/ 通过/ 模块化/ 的/ 方法/ 来/ 设计/ 和/ 分析/ 认证/ 和/ 密钥/ 交换/ 协议/ ,/ 以/ 简化/ 协议/ 的/ 安全/ 设计/ 与/ 安全性/ 分析/ ./ CK/ 模型/ 有/ 3/ 个/ 重要/ 的/ 组成部分/ :/ 非/ 认证/ 链路/ 模型/ (/ UM/ )/ 、/ 认证/ 链路/ 模型/ (/ AM/ )/ 和/ 认证/ 器/ (/ authenticator/ )/ ./ (/ 1/ )/ 非/ 认证/ 链路/ 模型/ (/ UM/ )/ 非/ 认证/ 链路/ 模型/ (/ UM/ )/ 中/ 的/ 攻击者/ 除了/ 能够/ 控制/ 通信/ 链路/ 和/ 协议/ 事件/ 的/ 调度/ 外/ ,/ 还/ 能够/ 通过/ 明确/ 的/ 攻击/ 手段/ 得到/ 协议/ 参与者/ 存储器/ 中/ 的/ 秘密/ 信息/ ./ 为了/ 区分/ 各种/ 攻击/ ,/ 确保/ 信息/ 在/ 被/ 暴露/ 情况/ 下/ 最大/ 限度/ 的/ 安全/ ,/ 根据/ 攻击者/ 能够/ 得到/ 信息/ 的/ 实际/ 情况/ ,/ CK/ 模型/ 将/ 攻击/ 分为/ 3/ 类/ :/ 攻陷/ 参与者/ (/ Partycorrup/ -/ tion/ )/ 、/ 会话/ 密钥/ 查询/ (/ Session/ -/ keyquery/ )/ 和/ 会/ 话/ 状态/ 暴露/ (/ Session/ -/ statereveal/ )/ ./ (/ 2/ )/ 认证/ 链路/ 模型/ (/ AM/ )/ AM/ 的/ 定义/ 方式/ 和/ UM/ 的/ 基本相同/ ,/ 一个/ 根本/ 不同之处/ 在于/ ,/ AM/ 中/ 的/ 攻击者/ 只/ 能够/ 传递/ 由/ 参与者/ 产生/ 的/ 真实/ 消息/ ,/ 而/ 不/ 能够/ 改变/ 或/ 增添/ 消息/ 的/ 内容/ ./ 定义/ 1/ (/ 认证/ 器/ authenticator/ )/ [/ 15/ -/ 16/ ]/ ./ 认证/ 器是/ 一种/ 特殊/ 的/ 算法/ ,/ 其/ 作用/ 类似/ 于/ 一个/ 自动/ 的/ 编译器/ ,/ 它/ 能够/ 将/ AM/ 中/ 的/ 协议/ 转化/ 为/ UM/ 中/ 一个/ 安全性/ 相同/ 的/ 等价/ 协议/ ./ (/ 3/ )/ 会话/ 密钥/ 安全/ (/ SK/ -/ secure/ )/ 定义/ 2/ (/ 测试/ 会话/ 查询/ test/ -/ sessionquery/ )/ [/ 14/ ]/ ./ 图/ 2/ 完整性/ 报告/ 协议/ 我们/ 发现/ ,/ 上述/ 协议/ 容易/ 遭受/ 一种/ 新/ 的/ 攻击/ —/ —/ —/ 平台/ 替换/ 攻击/ ./ 可信/ 网络连接/ 架构/ 中/ 完整性/ 评估/ 层/ 的/ 目的/ 是/ 验证/ 接入/ 平台/ 的/ 身份/ 和/ 平台/ 完整性/ ,/ 这一/ 攻击/ 将/ 导致/ 平台/ 身份/ 认证/ 的/ 失败/ 以及/ 平台/ 完整性/ 校/ 针对/ 密钥/ 交换/ 协议/ 的/ 对手/ U/ 可以/ 在/ 它/ 运行/ 的/ 任何时刻/ ,/ 从/ 那些/ 完成/ 的/ 、/ 没/ 过期/ 的/ 、/ 没/ 暴露/ 的/ 会/ 话/ 中/ 选择/ 一个/ 测试/ 会话/ (/ test/ -/ session/ )/ ./ 设/ K/ 是/ 测试/ 会话/ 的/ 会/ 话/ 密钥/ ,/ 当/ U/ 对/ 测试/ 会话/ 查询/ 时/ ,/ 掷币/ b/ ,/ b/ ←/ R/ {/ 0/ ,/ 1/ }/ ./ 若/ b/ =/ 0/ ,/ 把/ K/ 给/ U/ ;/ 否则/ ,/ 从/ 协议/ 产生/ 的/ 密钥/ 的/ 概率分布/ 空间/ 随机/ 选择/ 一个/ 值/ r/ 给/ U/ ./ 除了/ 在/ 测试/ 会话/ 过期/ 前/ 不/ 允许/ 使/ 测试/ 会话/ 暴露/ 外/ ,/ U/ 可以/ 继续/ 进行/ 各种/ 活动/ ./ 最后/ ,/ U/ 输出/ 一个/ 比特/ b0/ ,/ 作为/ b/ 的/ 猜测/ ./ 定义/ 3/ (/ KE/ 对手/ )/ [/ 14/ ]/ ./ 被/ 允许/ 执行/ 测试/ 会话/ 查询/ 的/ 密钥/ 交换/ 协议/ 对手/ 是/ KE/ 对手/ ./ 定义/ 4/ (/ 会话/ 密钥/ 安全/ SK/ -/ secure/ )/ [/ 14/ ]/ ./ 如果/ 对于/ UM/ 中/ 任何/ KE/ 对手/ U/ ,/ 协议/ 能够/ 满足/ 下列/ 两条/ 性质/ ,/ 则/ 我们/ 称该/ 协议/ 在/ UM/ 中是/ 会/ 话/ 密钥/ 安全/ 的/ :/ ①/ 如果/ 两个/ 未/ 被/ 攻陷/ 的/ 参与者/ 完成/ 了/ 匹配/ 的/ 会/ 话/ ./ 它们/ 将/ 输出/ 相同/ 的/ 会/ 话/ 密钥/ ;/ ②/ U/ 进行/ 测试/ 会话/ 查询/ ,/ 它/ 猜中/ b/ 的/ 概率/ 不/ 超过/ 0.5/ +/ ε/ ,/ 其中/ ε/ 为/ 安全/ 参数/ 下/ 可/ 忽略/ 的/ 概率/ ./ 如果/ 上述/ 性质/ 对于/ 任何/ AM/ 中/ 的/ KE/ 对手/ 是/ 满足/ 的/ ,/ 则/ 协议/ 在/ AM/ 中是/ 会/ 话/ 密钥/ 安全/ 的/ ./ 3/ 平台/ 替换/ 攻击/ 及其/ 分析/ 3.1/ 完整性/ 报告/ 协议/ 完整性/ 报告/ 协议/ [/ 13/ ]/ 被/ 用于/ 实现/ 平台/ 身份/ 认证/ 和/ 平台/ 的/ 完整性/ 校验/ ,/ 它/ 基于/ 挑战/ -/ 应答/ 认证/ 协议/ [/ 17/ ]/ ./ 如图/ 2/ 所示/ ,/ 平台/ PA/ 向/ 平台/ PB/ 证明/ 自己/ 的/ 身份/ 和/ 完整性/ ,/ 其中/ nonce/ 为/ 不可/ 预知/ 的/ 随机数/ ,/ AIKpriv/ 和/ AIKpub/ 为/ 证明/ 身份/ 密钥/ 对/ [/ 6/ ]/ ,/ loadkey/ (/ AIKpriv/ )/ 表示/ 使用/ 存储/ 根/ 密钥/ 从/ 可信/ 平台/ 模块/ TPM/ 中/ 读取/ 证明/ 身份/ 密钥/ AIKpriv/ ,/ SML/ 为/ 存储/ 测量/ 日志/ [/ 8/ ]/ ,/ cert/ (/ AIKpub/ )/ 为/ PrivacyCA/ 向/ 平台/ 签发/ 的/ AIK/ 证书/ ,/ Sig/ {/ PCR/ ,/ nonce/ }/ AIKpriv/ 表示/ 以/ AIKpriv/ 为/ 私钥/ 将/ 选择/ 的/ PCR/ 值/ 和/ 收到/ 的/ 随机数/ nonce/ 进行/ 签名/ ./ 验/ 错误/ ,/ 造成/ 可信/ 网络连接/ 的/ 安全/ 目标/ 不能/ 达到/ ./ 3.2/ 平台/ 替换/ 攻击/ 合法/ 用户/ M/ 希望/ 通过/ 不可/ 信/ 的/ 平台/ PM/ 接入/ 平台/ PB/ ,/ 攻击/ 过程/ 如图/ 3/ 所示/ ./ Page4/ 假定/ ./ 用户/ A/ 、/ M/ 和/ B/ 都/ 是/ 合法/ 用户/ ,/ 且/ A/ 与/ M/ 、/ M/ 与/ B/ 之间/ 分别/ 建立/ 了/ 安全/ 信道/ ./ 用户/ A/ 、/ M/ 和/ B/ 分别/ 控制/ 平台/ PA/ 、/ 3/ ./ PA/ 接收/ 到/ PM/ 发来/ 的/ 挑战/ 消息/ nonce/ ,/ 按照/ 3.1/ 节/ 协议/ 规定/ ,/ 使用/ 存储/ 根/ 密钥/ 从/ TPM/ 中/ 读取/ 证明/ 身份/ 密钥/ AIKpriv/ ,/ 并/ 以/ AIKpriv/ 为/ 私钥/ 将/ 选择/ 的/ PCR/ 值/ 和/ 收到/ 的/ 随机数/ nonce/ 进行/ 签名/ Sig/ {/ PCR/ ,/ nonce/ }/ AIKpriv/ ,/ 然后/ 将/ 签名/ 消息/ 连同/ 存储/ 测图/ 3/ 平台/ 替换/ 攻击/ 攻击/ 中/ ,/ 平台/ PM/ 成功/ 地/ 说服/ 平台/ PA/ 对/ 平台/ PB/ 的/ 一次性/ 随机数/ 进行/ 签名/ ,/ 并/ 进而/ 允许/ 平台/ PM/ 成功/ 地/ 欺骗/ 平台/ PB/ ./ 这是/ 一次/ 完美/ 的/ 攻击/ ,/ 因为/ 平台/ PA/ 和/ 平台/ PB/ 都/ 不/ 能够/ 察觉到/ 任何/ 错误/ ./ 攻击/ 结束/ 后/ ,/ 平台/ PB/ 认为/ PM/ 是/ 可信/ 平台/ 并/ 允许/ 其/ 接入/ ,/ 平台/ PA/ 认为/ 它/ 与/ 平台/ PM/ 进行/ 了/ 一次/ 协议/ 交互/ ./ 但/ 实际上/ 平台/ PM/ 是/ 一个/ 不可/ 信/ 平台/ ,/ 它/ 借助/ 可信/ 平台/ PA/ 接入/ PB/ ./ 3.3/ 平台/ 替换/ 攻击/ 产生/ 的/ 原因/ 及/ TNC/ 架构/ 的/ 安全/ 缺陷/ 可信/ 网络连接/ 框架/ 中/ ,/ 完整性/ 评估/ 层/ 协议/ 是/ 在/ 网络/ 访问/ 层/ 用户/ 之间/ 建立/ 的/ 安全/ 信道/ 基础/ 上/ 进行/ 的/ ./ 尽管/ 有/ 安全/ 信道/ 保护/ ,/ 但/ 无法/ 避免/ 平台/ 替换/ 攻击/ ,/ 如图/ 3/ 所示/ ./ 攻击/ 发生/ 的/ 根本原因/ 是/ :/ 一方面/ ,/ 按照/ TPM/ 主/ 规范/ [/ 6/ ]/ 的/ 规定/ ,/ 对于/ 验证/ 平台/ 而言/ ,/ AIK/ 签名/ 只能/ 说明/ 消息/ 来自/ 一个/ 含有/ 真实/ TPM/ 芯片/ 的/ 平台/ ,/ 不能/ 证明/ 签名/ 消息/ 的/ 平台/ 就是/ 议定/ 的/ 通信/ 平台/ ,/ 证明/ 身份/ 密钥/ AIK/ 不能/ 直接/ 用于/ 认证/ 通信/ 平台/ 的/ 身份/ ./ 因此/ ,/ 验证/ 平台/ PB/ 不能/ 确定/ 接收/ 到/ 的/ 消息/ 属于/ 协议/ 议定/ 的/ 响应/ 平台/ PM/ ,/ 而/ 只能/ 确定/ 消息/ 来自/ 一个/ 可信/ 的/ 平台/ ./ 另一方面/ ,/ 在/ 进行/ 可信/ 网络连接/ 过程/ 中/ ,/ 同一/ 用户/ 可以/ 使用/ 不同/ 的/ 计算/ 平台/ ,/ 不同/ 的/ 用户/ 也/ 可以/ 使用/ 同一/ 平台/ 进行/ 连接/ ,/ 这/ 就/ 使得/ 用户/ 与/ 用户/ 所/ 使用/ 的/ 平台/ 之间/ 不/ 存在/ 一一对应/ 的/ 关系/ ./ 网络/ 访问/ 层/ 建立/ 的/ 安全/ 信道/ 只能/ 保证/ 网络/ 访问/ 层/ 用户/ 之间/ 通信/ 的/ 认证/ 性/ 和/ 保密性/ ,/ 不能/ 保证/ 用户/ 所/ 使用/ 的/ 平台/ 之间/ 的/ 认证/ 性/ ./ 可信/ 网络连接/ 架构/ 规定/ ,/ 网络/ 访问/ 层/ 的/ 安全/ 信道/ 能够/ 保护/ 完整性/ 评估/ 层/ 协议/ 的/ 消息/ 交互/ [/ 8/ ]/ ,/ 但/ 实质/ 上/ 用户/ 与/ 平台/ 之间/ 没有/ 绑定/ 关系/ ,/ 不能/ 将/ 两者/ 看作/ 一个/ 整体/ 来/ 处理/ ,/ 平台/ 之间/ 的/ 身份/ 认证/ 和/ 完整性/ 校验/ 不能/ 完全/ 依赖于/ 用户/ 之间/ 的/ 安全/ 信道/ ./ 这是/ 造成/ 平台/ 替换/ 攻击/ 最/ 主要/ 的/ 原因/ ,/ 同时/ 它/ 也/ 是/ TNC/ 架构/ 的/ 设计/ 中/ 没有/ 考虑/ 到/ 的/ 一个/ 安全/ 缺陷/ ./ 4/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ 由于/ TNC/ 架构设计/ 上/ 的/ 缺陷/ (/ 网络/ 访问/ 层/ 用户/ 与/ 完整性/ 评估/ 层/ 平台/ 之间/ 不/ 存在/ 安全/ 绑定/ 关系/ )/ ,/ 基于/ 这一/ 架构设计/ 的/ 协议/ 容易/ 遭受/ 平台/ 替换/ 攻击/ ./ 本文/ 发现/ 在/ 保持/ TNC/ 架构/ 不变/ 的/ 前提/ 下/ ,/ 通过/ 协议/ 的/ 巧妙/ 设计/ 可以/ 实现/ 网络/ 访问/ 层/ 用户/ 与/ 完整性/ 评估/ 层/ 平台/ 之间/ 的/ 动态/ 绑定/ ,/ 从而/ 避免/ 了/ TNC/ 架构/ 安全/ 缺陷/ 造成/ 的/ 影响/ ./ 但/ 协议/ 的/ 设计/ 和/ 分析/ 是/ 一项/ 十分复杂/ 的/ 工作/ ,/ 凭借/ 经验/ 进行/ 协议/ 的/ 设计/ 和/ 分析/ ,/ 是/ 非常容易/ 出错/ 的/ [/ 18/ ]/ ,/ 而且/ 为了/ 使/ 协议/ 的/ 设计/ 和/ 分析/ 更具/ 一般性/ ,/ 需要/ 有/ 可/ 证明/ 安全/ 或/ 形式化/ 的/ 方法/ 来/ 指导/ ./ 现有/ 的/ 可/ 证明/ 安全/ 模型/ 和/ 形式化/ 方法/ (/ 如/ CK/ 模型/ [/ 14/ ]/ 、/ UC/ 模型/ [/ 19/ ]/ 、/ PCL/ 模型/ [/ 20/ ]/ 等/ )/ 在/ 网络/ 接入/ 认证/ 协议/ 方面/ 只/ 针对/ 传统/ 协议/ ,/ 而且/ 这些/ 模型/ 和/ 方法/ 多/ 是/ 基于/ Dolev/ -/ Yao/ 威胁/ 模型/ [/ 19/ ]/ 构造/ 的/ ./ 可信/ 网络连接/ 协议/ 与/ 传统/ 网络/ 接入/ 认证/ 协议/ 有着/ 很大/ 的/ 差别/ :/ 首先/ ,/ 网络连接/ 设备/ 有所不同/ ,/ 可信/ 的/ 网络连接/ 设备/ 具有/ TPM/ 模块/ ,/ 由于/ TPM/ 的/ 物理/ Page5/ 防/ 篡改/ 特性/ ,/ 能够/ 保护/ 系统/ 内部/ 部分/ 敏感数据/ ;/ 其次/ ,/ 可信/ 网络连接/ 架构/ 在/ 传统/ 网络连接/ 架构/ 基础/ 上/ ,/ 增加/ 了/ 完整性/ 评估/ 层/ ,/ 这/ 一层/ 协议/ 的/ 网络/ 运行/ 环境/ 与/ 传统/ 网络/ 访问/ 层/ 协议/ 的/ 运行/ 环境/ 有所不同/ (/ 完整性/ 评估/ 层/ 协议/ 是/ 在/ 网络/ 访问/ 层/ 安全/ 信道/ 上/ 进行/ 的/ )/ ./ 这/ 导致/ Dolev/ -/ Yao/ 威胁/ 模型/ 在/ 可信/ 环境/ 下/ 不再/ 完全/ 适用/ ,/ 相应/ 的/ 基于/ 这一/ 模型/ 构造/ 的/ 可/ 证明/ 安全/ 模型/ 和/ 形式化/ 方法/ 也/ 就/ 不再/ 适用/ ./ 这/ 就/ 要求/ 我们/ 设计/ 一种/ 新/ 的/ 可信/ 环境/ 下/ 的/ 协议/ 设计/ 和/ 分析模型/ ./ 通过/ 对/ TCG/ 可信/ 网络连接/ 架构/ 的/ 深入分析/ ,/ 我们/ 提出/ 了/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ ,/ 在/ 此基础/ 之上/ ,/ 结合/ 可/ 证明/ 安全/ 模型/ CK/ 模型/ 的/ 基本/ 思想/ ,/ 给出/ 一种/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ ./ 4.1/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ 根据/ TNC/ 的/ 规定/ ,/ 可信/ 网络连接/ 架构/ 底层/ 网络/ 访问/ 层/ 采用/ 传统/ 网络连接/ 技术/ (/ 如/ VPN/ [/ 22/ ]/ ,/ 802.1/ x/ [/ 23/ ]/ 等/ )/ ,/ 完整性/ 评估/ 层/ 协议/ 在/ 底层/ 安全/ 信道/ 保护/ 下/ 进行/ ./ 因此/ ,/ 可信/ 网络连接/ 协议/ 的/ 一个/ 最/ 基本/ 要求/ 是/ 底层/ 网络连接/ 协议/ 的/ 安全性/ ./ 目标/ 1/ ./ 网络/ 访问/ 层/ 实现/ 用户/ 身份/ 认证/ ,/ 协商/ 出/ 用户/ 之间/ SK/ 安全/ 的/ 会/ 话/ 密钥/ ,/ 在/ 此基础/ 之上/ ,/ 实现/ 通信/ 用户/ 实体/ 之间/ 的/ 安全/ 信道/ ./ 在/ 网络/ 访问/ 层/ 协议/ 安全/ 基础/ 上/ ,/ 可信/ 网络连接/ 架构/ 提出/ 了/ 新/ 的/ 要求/ ,/ 即/ 要求/ 用户/ 所/ 使用/ 的/ 平台/ 之间/ 进行/ 平台/ 身份/ 认证/ 和/ 平台/ 完整性/ 校验/ ./ 这是/ 可信/ 网络连接/ 协议/ 的/ 又/ 一/ 安全/ 目标/ ./ 目标/ 2/ ./ 完整性/ 评估/ 层/ 在/ 网络/ 访问/ 层/ 安全/ 信道/ 保护/ 下/ ,/ 实现/ 平台/ 身份/ 认证/ 和/ 平台/ 完整性/ 校验/ ./ TNC/ 架构/ 指出/ 用户/ 间/ 建立/ 的/ 安全/ 信道/ 可以/ 直接/ 用来/ 保护/ 平台/ 间/ 的/ 消息/ 交互/ ./ TNC/ 架构/ 没有/ 考虑/ 到/ 用户/ 与/ 平台/ 之间/ 并/ 不是/ 一种/ 固定/ 的/ 绑定/ 关系/ ,/ 同一/ 用户/ 可以/ 使用/ 任意/ 平台/ 进行/ 网络连接/ ,/ 不同/ 用户/ 也/ 可以/ 使用/ 同一/ 平台/ ,/ 用户/ 之间/ 的/ 每/ 一次/ 连接/ 会话/ 都/ 可能/ 使用/ 不同/ 的/ 平台/ ./ TNC/ 架构/ 的/ 这/ 一/ 缺陷/ 直接/ 导致/ 了/ 3.2/ 节/ 攻击/ 的/ 产生/ ./ 所以/ 需要/ 在/ 用户/ 与/ 平台/ 之间/ 建立/ 一种/ 动态/ 的/ 安全/ 绑定/ 关系/ ./ 定义/ 5/ (/ 用户/ 与/ 平台/ 动态/ 授权/ 绑定/ )/ ./ 对于/ 每/ 一次/ 可信/ 网络连接/ 会话/ ,/ 网络/ 访问/ 层/ 用户/ 都/ 与/ 唯一/ 的/ 完整性/ 评估/ 层/ 平台/ 相对/ 应/ ./ 目标/ 3/ ./ 用户/ 与/ 平台/ 之间/ 存在/ 动态/ 授权/ 绑定/ 关系/ ./ 在/ 网络/ 访问/ 层/ 用户/ 之间/ 建立/ 安全/ 信道/ 基础/ 上/ ,/ 通过/ 用户/ 对/ 平台/ 的/ 动态/ 授权/ ,/ 实现/ 用户/ 与/ 平台/ 之间/ 的/ 安全/ 绑定/ ,/ 从而/ 使/ 平台/ 可以/ 安全/ 地/ 使用/ 用户/ 之间/ 建立/ 的/ 安全/ 信道/ ./ 4.2/ 基于/ CK/ 模型/ 的/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ 可信/ 网络连接/ 架构/ 包括/ 相互/ 关联/ 的/ 两个/ 过程/ [/ 8/ ]/ :/ 网络/ 访问/ 层/ 的/ 用户/ 身份/ 认证/ 和/ 密钥/ 协商/ 以及/ 完整性/ 评估/ 层/ 的/ 平台/ 身份/ 认证/ 和/ 平台/ 完整性/ 校验/ ./ 完整性/ 评估/ 层/ 协议/ 是/ 在/ 网络/ 访问/ 层/ 用户/ 身份/ 认证/ 和/ 密钥/ 协商/ 完成/ ,/ 并/ 建立/ 了/ 安全/ 信道/ 基础/ 上/ 进行/ 的/ ./ 因此/ ,/ 本文/ 设计/ 的/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ 是/ 相互/ 关联/ 的/ 两层/ :/ 网络/ 访问/ 层/ 模型/ 和/ 完整性/ 评估/ 层/ 模型/ ./ 4.2/ ./ 1/ 网络/ 访问/ 层/ 模型/ CK/ 模型/ 是/ 一种/ 模块化/ 的/ 协议/ 设计/ 方法/ ,/ 它/ 具有/ 3/ 类/ 攻击者/ 模型/ [/ 14/ ]/ :/ 攻陷/ 参与者/ 、/ 会话/ 密钥/ 查询/ 及会话/ 状态/ 暴露/ ./ 这/ 3/ 类/ 攻击/ 模型/ 是/ 针对/ 计算/ 实体/ 内部/ 的/ 攻击/ ,/ 不/ 涉及/ 对/ 网络/ 上/ 传输/ 消息/ 的/ 攻击/ ./ 认证/ 器/ [/ 15/ -/ 16/ ]/ 保证/ 了/ 协议/ 消息/ 在/ 网络/ 上/ 传输/ 时/ 不会/ 遭受/ 攻击/ ,/ 从而/ 保证/ 了/ AM/ 中/ 安全/ 的/ 协议/ 转化/ 为/ 现实/ 环境/ (/ UM/ )/ 中/ 具有/ 同等/ 安全性/ 的/ 协议/ ./ 从/ 本质/ 上/ 来说/ ,/ CK/ 模型/ 将/ 攻击/ 分为/ 两大类/ ,/ 针对/ 计算/ 实体/ 内部/ 的/ 攻击/ 以及/ 网络/ 上/ 的/ 攻击/ ./ 可信/ 网络连接/ 架构/ 中/ 的/ 网络/ 访问/ 层/ 协议/ 与/ 传统/ 的/ 网络/ 接入/ 认证/ 协议/ 相同/ ,/ 它们/ 具有/ 相同/ 的/ 协议/ 参与者/ 、/ 相同/ 的/ 链路/ 环境/ 以及/ 相同/ 的/ 安全/ 目标/ ./ 对于/ 可信/ 网络连接/ 架构/ 中/ 的/ 网络/ 访问/ 层/ 协议/ ,/ CK/ 模型/ 中/ 的/ 3/ 类/ 内部/ 攻击/ 同样/ 存在/ ./ 对于/ 会话/ 密钥/ 查询/ 来说/ ,/ 协议/ 会话/ 密钥/ 的/ 泄漏/ 可能/ 是/ 密钥/ 拥有者/ 处理不当/ 被/ 攻击者/ 获取/ ,/ 或/ 攻击者/ 通过/ 密码/ 分析/ 的/ 手段/ 也/ 可能/ 造成/ 会话/ 密钥/ 的/ 暴露/ ./ 会话/ 状态/ 暴露/ 查询/ 用来/ 暴露/ 会话/ 的/ 状态/ 信息/ ,/ 网络/ 访问/ 层/ 模型/ 中/ 协议/ 的/ 会/ 话/ 状态/ 与/ CK/ 模型/ 中/ 定义/ 的/ 会/ 话/ 状态/ 相同/ (/ 如/ 在/ DH/ 交换/ 中/ 用于/ 计算/ gx/ 的/ 指数/ x/ )/ ./ 由于/ 会话/ 状态/ 信息/ 需要/ 在/ 内存/ 中/ 进行/ 处理/ ,/ 即使/ 会话/ 状态/ 信息/ 存放/ 于/ TPM/ 内部/ ,/ 但/ 由于/ TPM/ 不能/ 直接/ 对/ 这些/ 状态/ 信息/ 进行/ 处理/ ,/ 因此/ 需要/ 将会话/ 状态/ 信息/ 读入/ 内存/ 中/ ./ 这/ 就/ 有/ 可能/ 造成/ 会话/ 状态/ 信息/ 的/ 泄露/ ./ 对于/ 攻陷/ 实体/ 攻击/ ,/ 除了/ 能够/ 获取/ 上述/ 两种/ 攻击/ 所/ 能/ 获取/ 的/ 信息/ 外/ ,/ 还/ 能够/ 获取/ 实体/ 的/ 长期/ 密钥/ ./ 用户/ 的/ 长期/ 密钥/ 有/ 可能/ 是/ 证书/ 权威/ CA/ 或/ 密钥/ 管理中心/ KMC/ 生成/ 的/ 长期/ 私钥/ ,/ 也/ 可能/ 是/ 预/ 共享/ 的/ 主/ 密钥/ ,/ 这一/ 信息/ 在/ 未/ 存入/ TPM/ 之前/ 、/ 或/ 从/ TPM/ 读入/ 内存/ 进行/ 处理/ 的/ 过程/ 中/ 以及/ 用户/ 的/ 处理不当/ 都/ 有/ 可能/ 被/ 攻击者/ 获取/ ./ Page6/ 对于/ 可信/ 网络连接/ 架构/ 中/ 的/ 网络/ 访问/ 层/ 协议/ ,/ CK/ 模型/ 中/ 的/ 外部/ 攻击/ 同样/ 存在/ ./ 可信/ 网络连接/ 架构/ 网络/ 访问/ 层/ 采用/ 传统/ 网络连接/ 技术/ (/ 如/ VPN/ ,/ 802.1/ x/ 等/ )/ ,/ 可信计算/ 技术/ 没有/ 对/ 网络/ 访问/ 层/ 用户/ 之间/ 的/ 消息/ 交互/ 提供/ 更/ 多/ 的/ 安全/ 保障/ ./ 因此/ 传统/ 网络/ 接入/ 认证/ 协议/ 的/ 漏洞/ ,/ 在/ 可信/ 网络连接/ 架构/ 网络/ 访问/ 层/ 协议/ 中/ 同样/ 存在/ ./ 结论/ 1/ ./ CK/ 模型/ 可以/ 作为/ 可信/ 网络连接/ 架构/ 完整性/ 评估/ 层/ 模型/ 是/ 可/ 证明/ 安全/ 的/ 可信/ 网络/ 连/ 网络/ 访问/ 层/ 协议/ 的/ 分析/ 与/ 设计/ 模型/ ./ 4.2/ ./ 2/ 完整性/ 评估/ 层/ 模型/ 接/ 协议/ 模型/ 的/ 核心/ ./ 根据/ CK/ 模型/ 的/ 设计/ 思想/ ,/ 完整性/ 评估/ 层/ 模型/ 中/ 包括/ 两类/ 攻击/ :/ 平台/ 内部/ 攻击/ 和/ 网络攻击/ ./ 完整性/ 评估/ 层/ 协议/ 完成/ 平台/ 身份/ 认证/ 和/ 平台/ 完整性/ 校验/ ,/ 协议/ 需要/ 交互/ 的/ 秘密/ 信息/ 以及/ 有关/ 平台/ 身份/ 和/ 平台/ 完整性/ 的/ 信息/ (/ 包括/ 签注/ 密钥/ EK/ [/ 6/ ]/ 、/ 认证/ 身份/ 密钥/ AIK/ [/ 6/ ]/ 、/ 平台/ 完整性/ 度量/ 值/ [/ 6/ ]/ 等/ 信息/ )/ 在/ 平台/ 内部/ 是/ 安全/ 的/ ./ 在/ 平台/ 内部/ ,/ 这些/ 秘密/ 信息/ 存放/ 在/ TPM/ 中/ 的/ 受/ 保护/ 区域/ ,/ TPM/ 的/ 安全/ 存储/ 特性/ 保证/ 了/ 攻击者/ (/ 包括/ 非/ 授权/ 用户/ )/ 无法/ 从/ TPM/ 中/ 直接/ 获取/ 这些/ 秘密/ 信息/ ./ 所以/ 攻陷/ 实体/ 攻击/ 在/ 这/ 一层/ 不/ 存在/ ./ 完整性/ 评估/ 层/ 协议/ 交互/ 过程/ 中/ 的/ 状态/ 信息/ 存放/ 在/ TPM/ 内部/ ,/ 协议/ 交互/ 过程/ 中/ 这些/ 状态/ 信息/ 不/ 读入/ 内存/ ,/ 而是/ 直接/ 在/ TPM/ 内部/ 进行/ 签名/ 等/ 操作/ ,/ 然后/ 通过/ 网络/ 传送/ 给/ 通信/ 平台/ ./ 完整性/ 评估/ 层/ 协议/ 中/ 的/ 会/ 话/ 状态/ 信息/ 受/ TPM/ 保护/ ./ 因此/ ,/ 会话/ 状态/ 暴露/ 攻击/ 在/ 这/ 一层/ 不会/ 发生/ ./ 完整性/ 评估/ 层/ 协议/ 的/ 目的/ 是/ 进行/ 平台/ 身份/ 认证/ 和/ 平台/ 完整性/ 校验/ ,/ 平台/ 之间/ 并/ 不/ 协商会/ 话/ 密钥/ ,/ 因此/ 会话/ 密钥/ 查询/ 攻击/ 在/ 这/ 一层/ 没有/ 意义/ ./ 结论/ 2/ ./ 完整性/ 评估/ 层/ 模型/ 中/ 不/ 存在/ 平台/ 内部/ 攻击/ ./ CK/ 模型/ 定义/ 了/ 认证/ 链路/ 模型/ AM/ 和/ 非/ 认证/ 链路/ 模型/ UM/ ,/ 分别/ 用来/ 表示/ 协议/ 的/ 不同/ 运行/ 环境/ [/ 14/ ]/ ./ 完整性/ 评估/ 层/ 协议/ 的/ 运行/ 环境/ 与/ 网络/ 访问/ 层/ 协议/ 的/ 运行/ 环境/ 有所不同/ ./ 完整性/ 评估/ 层/ 协议/ 是/ 在/ 网络/ 访问/ 层/ 用户/ 身份/ 认证/ 和/ 密钥/ 协商/ 结束/ ,/ 并/ 建立/ 安全/ 信道/ 的/ 基础/ 上/ 进行/ 的/ ,/ 完整性/ 评估/ 层/ 协议/ 的/ 消息/ 交互/ 借助/ 网络/ 访问/ 层/ 的/ 安全/ 信道/ 进行/ 传输/ ./ 协议/ 运行/ 环境/ 的/ 差异/ ,/ 导致/ CK/ 模型/ 中/ 的/ 链路/ 模型/ 与/ 完整性/ 评估/ 层/ 协议/ 模型/ 的/ 链路/ 模型/ 有着/ 很大/ 的/ 差别/ ./ 因此/ ,/ 我们/ 给出/ 了/ 完整性/ 评估/ 层/ 的/ 链路/ 模型/ :/ 平台/ 不可/ 信/ 链路/ 模型/ (/ PUM/ )/ 和/ 平台/ 可信/ 链路/ 模型/ (/ PTM/ )/ ./ 4.2/ ./ 2.1/ 平台/ 不可/ 信/ 链路/ 模型/ (/ PUM/ )/ 平台/ 不可/ 信/ 链路/ 模型/ PUM/ 定义/ 了/ 攻击者/ 能力/ 以及/ 攻击者/ 与/ 协议/ 的/ 交互/ ./ 图/ 4/ 总结/ 了/ 在/ 存在/ PUM/ 敌手/ 的/ 情况/ 下/ 协议/ 的/ 执行/ 情况/ ./ 考虑/ 存在/ n/ 个/ 平台/ 的/ 消息/ 驱动/ 协议/ ,/ 其中/ 用/ P1/ …/ Pn/ 表示/ 不同/ 的/ 平台/ ./ 每个/ 平台/ Pi/ 都/ 有/ 输入/ xi/ 和/ ri/ ./ 在/ 这/ 一/ 环境/ 下/ ,/ 存在/ 一个/ PUM/ 敌手/ U/ ./ PUM/ 环境/ 下/ 协议/ π/ 的/ 运行/ 包括/ 不同/ 平台/ 之间/ 的/ 一系列/ 协议/ π/ 的/ 激活/ 行为/ ,/ 这些/ 激活/ 行为/ 被/ 敌手/ U/ 控制/ 和/ 安排/ ./ 参与方/ :/ 平台/ P1/ …/ Pn/ 分别/ 以/ x1/ …/ xn/ 为/ 输入/ 执行/ n/ 方/ 协议/ π/ ,/ 敌手/ U/ ./ 1/ ./ 初始化/ ./ 网络/ 访问/ 层/ 用户/ 之间/ 安全/ 信道/ 建立/ 后/ ,/ 完整性/ 评估/ 层/ 协议/ 开始/ ./ 每个/ 平台/ Pi/ 以/ 本地/ 输入/ xi/ 、/ 秘密/ 参数/ k/ 和/ 随机/ 输入/ ri/ 调用/ 协议/ π/ ./ 2/ ./ 若/ 敌手/ U/ 没有/ 终止/ ,/ 则/ 执行/ 以下/ 操作/ :/ 敌手/ U/ 可以/ 激活/ 一些/ 平台/ Pi/ 之间/ 的/ 协议/ π/ ,/ 这一/ 激活/ 过程/ 可以/ 有/ 两种/ 形式/ :/ i/ ./ 激活/ 请求/ 狇/ :/ 这一/ 激活/ 来自/ 平台/ 内部/ 的/ 程序/ 调用/ ;/ ii/ ./ 输入/ 消息/ 犿/ :/ 这一/ 激活/ 来自/ 网络/ 中/ 的/ 另/ 一个/ 平台/ ./ 如果/ 一个/ 激活/ 发生/ ,/ 那么/ 被/ 激活/ 平台/ Pi/ 执行/ 它/ 的/ 程序/ 并/ 将/ 产生/ 的/ 输出/ 消息/ 和/ 激活/ 请求/ 提交/ 给/ 敌手/ U/ (/ 敌手/ U/ 能够/ 完全/ 控制/ 激活/ 的/ 顺序/ 以及/ 决定/ 输入/ 消息/ 的/ 值/ )/ ./ 协议/ 产生/ 的/ 本地/ 输出/ 不会/ 被/ 敌手/ U/ 获取/ ./ 3/ ./ 协议/ 执行/ 的/ 全局/ 输出/ 是/ 敌手/ U/ 和/ 平台/ P1/ …/ Pn/ 输出/ 的/ 级联/ 组合/ ./ 在/ PUM/ 环境/ 下/ ,/ 虽然/ 完整性/ 评估/ 层/ 协议/ 是/ 在/ 网络/ 访问/ 层/ 安全/ 信道/ 基础/ 上/ 进行/ 的/ ,/ 但/ 由于/ 网络/ 访问/ 层/ 的/ 安全/ 信道/ 是/ 网络/ 用户/ 实体/ 之间/ 建立/ 起来/ 的/ ,/ 用户/ 实体/ 与/ 实体/ 所/ 使用/ 的/ 平台/ 之间/ 并/ 没有/ 一种/ 安全/ 绑定/ 的/ 关系/ ./ 网络/ 访问/ 层/ 用户/ 之间/ 的/ 安全/ 信道/ 不能/ 保护/ 平台/ 之间/ 的/ 消息/ 交互/ ,/ 同样/ 不能/ 保证/ 完整性/ 评估/ 层/ 协议/ 免受/ 网络攻击/ ./ 因此/ ,/ 平台/ 没有/ 得到/ 用户/ 的/ 授权/ 而/ 使用/ 用户/ 之间/ 建立/ 的/ 安全/ 信道/ 是/ 不/ 安全/ 的/ ./ 这一/ 链路/ 模型/ 中/ 的/ 网络/ 攻击者/ 能够/ 决定/ 何时/ 发送/ 什么样/ 的/ 消息/ ,/ 可以/ 修改/ 消息/ 或者/ 任意/ 插入/ 自己/ 产生/ 的/ 消息/ ./ 在/ 这/ 一/ 链路/ 模型/ 中/ ,/ 由/ 结论/ 2/ 可知/ 不/ 存在/ 平台/ 内部/ 攻击/ ./ 全局/ 输出/ :/ 在/ PUM/ 中/ 运行/ 的/ 协议/ 的/ 全局/ 输出/ 是/ 协议/ 参与/ 平台/ Pi/ 和/ 敌手/ U/ 的/ 本地/ 输出/ 的/ 级联/ ./ PUM/ -/ ADV/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ 表示/ 敌手/ U/ 与/ 协议/ 参与/ 平台/ 交互/ 的/ 本地/ 输出/ ,/ 其中/ k/ 表示/ 秘密/ 参数/ ,/ 狓/ =/ x1/ …/ xn/ 表示/ 输入/ ,/ 狉/ =/ r0/ …/ rn/ 表示/ 随机/ 输入/ (/ r0/ 给/ 敌手/ U/ )/ ./ UNPTRUST/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ i/ 表示/ 平台/ Pi/ 的/ 本地/ 输出/ 的/ 级联/ ./ 定义/ 6/ (/ PUM/ 中/ 协议/ 运行/ 的/ 全局/ 输出/ )/ ./ UNPTRUST/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ =/ PUM/ -/ ADV/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ ,/ UNPTRUST/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ 1/ ,/ …/ ,/ UNPTRUST/ π/ ,/ U/ (/ k/ ,/ 狓/ ,/ 狉/ )/ n/ ./ Page74/ ./ 2.2/ ./ 2/ 平台/ 可信/ 链路/ 模型/ (/ PTM/ )/ 在/ 这/ 一/ 链路/ 模型/ 中/ ,/ 平台/ 可以/ 安全/ 地/ 使用/ 网络/ 访问/ 层/ 建立/ 的/ 安全/ 信道/ ,/ 也就是说/ ,/ 在/ 这/ 一/ 链路/ 模型/ 中/ ,/ 用户/ 与/ 平台/ 之间/ 存在/ 安全/ 绑定/ ./ 这一/ 环境/ 中/ 存在/ PTM/ 敌手/ T/ ,/ 与/ PUM/ 敌手/ U/ 不同/ ,/ 敌手/ T/ 只能/ 通过/ 协议/ 中/ 的/ 其它/ 平台/ 产生/ 的/ 输入/ 消息/ 来/ 激活/ 平台/ ./ PTM/ 中/ 的/ 网络/ 攻击者/ ,/ 只/ 能够/ 传递/ 由/ 参与者/ 产生/ 的/ 真实/ 消息/ ,/ 而且/ 不/ 能够/ 改变/ 或/ 增添/ 消息/ 的/ 内容/ ./ 在/ 这/ 一/ 链路/ 模型/ 中/ ,/ 由/ 结论/ 2/ 可知/ 不/ 存在/ 平台/ 内部/ 攻击/ ./ PTM/ 模型/ 下/ 全局/ 输出/ 的/ 定义/ PTRUST/ π/ ,/ T/ 与/ PUM/ 模型/ 下/ UNPTRUST/ π/ ,/ U/ 的/ 定义/ 类似/ ./ 绑定/ 器/ 与/ CK/ 模型/ 中/ 的/ 认证/ 器/ 相仿/ ,/ 是/ 一种/ 特殊/ 的/ 算法/ ,/ 其/ 作用/ 类似/ 于/ 一个/ 自动/ 的/ 编译器/ ,/ 它/ 能够/ 将/ PTM/ 中/ 的/ 协议/ 转化/ 为/ PUM/ 中/ 一个/ 安全性/ 相同/ 的/ 等价/ 协议/ ./ 定义/ 7/ ./ 设/ π/ 和/ π/ 是/ n/ 方/ 消息/ 驱动/ 协议/ ,/ π/ 运行/ 在/ PTM/ 中/ ,/ π/ 运行/ 在/ PUM/ 中/ ./ 我们/ 称/ π/ 在/ PUM/ 中/ 仿真/ (/ emulates/ )/ π/ ,/ 如果/ 对于/ 任何/ PUM/ 对手/ U/ ,/ 存在/ 一个/ PTM/ 对手/ T/ 使得/ 式/ 中/ / 表示/ 计算/ 上/ 是/ 不可/ 区分/ 的/ ./ 算法/ ,/ 它/ 的/ 输入/ 和/ 输出/ 都/ 是/ 协议/ 的/ 描述/ ./ 定义/ 8/ (/ 编译器/ compiler/ )/ ./ 编译器/ C/ 是/ 一个/ 定义/ 9/ (/ 绑定/ 器/ binder/ )/ ./ 若/ 编译器/ C/ 对于/ PTM/ 中/ 的/ 任何/ 协议/ π/ ,/ 协议/ C/ (/ π/ )/ 可以/ 在/ PUM/ 中/ 仿真/ π/ ,/ 则/ 称/ 这个/ 编译器/ 为/ 绑定/ 器/ ./ 绑定/ 器/ 的/ 设计/ 和/ 构造/ 是/ 模块化/ 的/ ,/ 当/ 协议/ 需要/ 增加/ 新/ 的/ 安全/ 属性/ 时/ ,/ 只/ 需要/ 针对/ 这一/ 安全/ 属性/ 设计/ 一个/ 新/ 的/ 绑定/ 器/ 并/ 证明/ 其/ 安全性/ ,/ 那么/ 经过/ 这一/ 绑定/ 器/ 编译/ 的/ 协议/ 就/ 能够/ 保证/ 要求/ 的/ 安全/ 属性/ ./ 我们/ 将/ 设计/ 一个/ 绑定/ 器/ ,/ 它/ 能够/ 实现/ 用户/ 与/ 平台/ 动态/ 授权/ 绑定/ ./ 绑定/ 器/ λ/ bind/ ./ λ/ bind/ 的/ 构造/ 基于/ 公钥/ 签名/ ./ 网络/ 访问/ 层/ 用户/ 实体/ 之间/ 已经/ 协商/ 出/ 了/ SK/ 安全/ 的/ 会/ 话/ 密钥/ kij/ ./ 初始/ 函数/ I/ 进行/ 密钥/ 分配/ ,/ 假设/ AIKprivi/ 和/ AIKpubi/ 分别/ 表示/ 参与者/ pi/ 的/ AIK/ 签名/ 和/ 验证/ 密钥/ ,/ 其中/ I0/ =/ AIKpub1/ …/ AIKpubn/ 为/ 公开/ 信息/ ,/ 发送给/ 每个/ 参与方/ pi/ ,/ Ii/ =/ AIKprivi/ 为/ pi/ 的/ 私有/ 信息/ ./ 当/ 完整性/ 评估/ 层/ 平台/ pi/ 发送/ 消息/ m/ 给/ 平台/ pj/ 的/ 请求/ 被/ 激活/ 时/ ,/ λ/ bind/ 激活/ 一个/ 双方/ 通信协议/ ^/ λ/ bind/ ,/ ^/ λ/ bind/ 过程/ 如下/ (/ 既然/ ^/ λ/ bind/ 仅/ 涉及/ 两个/ 平台/ ,/ 我们/ 使用/ pA/ ,/ pB/ 代替/ pi/ ,/ pj/ )/ ;/ (/ 1/ )/ pA/ 把/ 消息/ m/ 发送给/ pB/ ;/ (/ 2/ )/ pB/ 收到/ 来自/ pA/ 的/ 消息/ m/ 后/ ,/ 选择/ 一个/ 随机数/ NB/ ←/ / / R/ {/ 0/ ,/ 1/ }/ k/ ,/ 把/ 挑战/ {/ m/ ,/ NB/ }/ 发送给/ pA/ ;/ kAB/ }/ AIKprivA/ ,/ 把/ 响应/ m/ ,/ SIGN/ 发送给/ pB/ ;/ 过后/ 接受/ m/ ./ (/ 3/ )/ pA/ 收到/ pB/ 的/ 挑战/ 后/ ,/ 计算/ SIGN/ =/ {/ m/ ,/ NB/ ,/ (/ 4/ )/ pB/ 收到/ pA/ 的/ 响应/ 后/ ,/ 验证/ SIGN/ 和/ kAB/ ,/ 通/ 定理/ 1/ ./ 如果/ 签名/ 算法/ 可/ 抵抗/ 选择/ 消息/ 攻击/ ,/ 则/ 完整性/ 报告/ 协议/ [/ 13/ ]/ 在/ PTM/ 中是/ 安全/ 的/ ./ 则/ 协议/ λ/ bind/ 在/ PUM/ 中/ 仿真/ PTM/ 中/ 的/ 消息/ 传输/ 协议/ ./ 证明/ ./ 设/ U/ 是/ 一个/ 和/ λ/ bind/ 交互/ 的/ PUM/ 对手/ ,/ 我们/ 要/ 构造/ 一个/ PTM/ 对手/ T/ 使/ PTRUSTMT/ ,/ T/ / UNPTRUST/ λ/ bind/ ,/ U/ ,/ 其中/ “/ / ”/ 表示/ 计算/ 上/ 是/ 不可/ 区分/ 的/ ./ 运行/ U/ ,/ U/ 和/ n/ 个/ 运行/ λ/ bind/ 的/ 参与者/ p1/ ,/ …/ ,/ pn/ 进行/ 仿真/ 的/ 交互/ ,/ T/ 同时/ 在/ PTM/ 中/ 和/ p1/ ,/ …/ ,/ pn/ 交互/ (/ 直观/ 上/ ,/ T/ 在/ PTM/ 中/ 和/ p1/ ,/ …/ ,/ pn/ 的/ 交互/ 作为/ λ/ bind/ 协议/ 的/ 上层/ 协议/ )/ ,/ T/ 按照/ 以下/ 规则/ 进行/ :/ (/ 1/ )/ 参与者/ p1/ ,/ …/ ,/ pn/ 拥有/ 平台/ 使用者/ 之间/ 的/ 共享/ 密钥/ ;/ (/ 2/ )/ 当/ U/ 激活/ 某个/ 平台/ pi/ ,/ 把/ 消息/ m/ 发送给/ 参与者/ pj/ 时/ ,/ T/ 在/ PTM/ 中/ 激活/ pi/ 把/ 消息/ m/ 发送给/ pj/ ;/ 在/ PTM/ 中用/ 来自/ pi/ 的/ 消息/ m/ 激活/ pj/ ;/ (/ 3/ )/ U/ 继续/ 与/ 运行/ λ/ bind/ 的/ 参与者/ pj/ 交互/ ;/ (/ 4/ )/ 当/ pj/ 输出/ “/ pj/ 收到/ pi/ 发来/ 的/ 消息/ m/ ”/ 时/ ,/ T/ (/ 5/ )/ U/ 所/ 输出/ 的/ 就是/ T/ 的/ 输出/ ./ 从/ 上面/ 规则/ 容易/ 看出/ ,/ 除了/ 第/ 2/ 条/ 规则/ 外/ ,/ T/ 的/ 行为/ 是/ 合法/ 的/ PTM/ 对手/ ./ 在/ 第/ 2/ 条/ 规则/ 中/ ,/ (/ pi/ ,/ pj/ ,/ m/ )/ 可能/ 没有/ 在/ pi/ 的/ 未/ 送达/ 消息/ 队列/ 中/ ./ 当/ pj/ 输出/ “/ pj/ 收到/ pi/ 发来/ 的/ 消息/ m/ ”/ ,/ 而/ pi/ 没有/ 发送/ m/ 给/ pj/ 或/ pj/ 以前/ 已经/ 收到/ 过/ m/ ,/ 让/ β/ 代表/ 这个/ 事件/ ./ 如果/ β/ 没有/ 出现/ ,/ 则/ T/ 执行/ 规则/ 2/ 时/ 是/ 合法/ 的/ PTM/ 对手/ 行为/ ./ 这时/ T/ 在/ PTM/ 中/ 精确/ 地/ 模仿/ 了/ U/ 的/ 运行/ ,/ 即/ PTRUSTMT/ ,/ T/ =/ UNPTRUST/ λ/ bind/ ,/ U/ ,/ “/ =/ ”/ 表示/ 同一/ 分布/ (/ identicallydistributed/ )/ ./ 如果/ β/ 出现/ ,/ 我们/ 可/ 说明/ 其/ 出现/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ,/ PTRUSTMT/ ,/ T/ / UNPTRUST/ λ/ bind/ ,/ U/ ./ 假设/ β/ 出/ Page8/ 现/ 的/ 概率/ 是/ ε/ ,/ ε/ 是/ 不可/ 忽略/ 的/ ,/ 我们/ 构造/ 一个/ 伪造/ 器/ F/ 以/ 概率/ ε/ // n/ 破坏/ 签名/ 机制/ ./ 伪造/ 器/ F/ ./ 如下/ 定义/ F/ :/ F/ 的/ 输入/ 是/ NB/ 和/ KAB/ ./ F/ 可以/ 访问/ SIGNOracleS/ ,/ 它/ 根据/ 输入/ m/ ,/ N/ ≠/ NB/ 且/ K/ ≠/ KAB/ 计算/ 输出/ {/ m/ ,/ N/ ,/ K/ }/ AIKprivA/ ./ 若/ N/ =/ NB/ 或/ K/ =/ KAB/ ,/ S/ (/ m/ ,/ N/ ,/ K/ )/ =/ ⊥/ ./ F/ 运行/ U/ ,/ U/ 和/ 一组/ 运行/ λ/ bind/ 的/ 参与者/ 进行/ 如下/ 仿真/ 交互/ :/ (/ 1/ )/ F/ 根据/ 初始/ 函数/ I/ 给/ 各个/ 运行/ λ/ bind/ 的/ 参与者/ 分配/ 密钥/ ,/ 除了/ 随机/ 选择/ 的/ 一对/ 参与者/ pA/ 、/ pB/ ,/ pA/ 的/ 验证/ 密钥/ AIKpubi/ 替换/ 为/ AIKpub/ / 发送给/ pB/ ;/ (/ 2/ )/ 对于/ 不是/ pA/ 和/ pB/ 交互/ 的/ 消息/ ,/ 涉及/ 的/ 那些/ 参与者/ 按照/ λ/ bind/ 执行/ ;/ (/ 3/ )/ 设/ L/ 是/ pB/ 从/ pA/ 收到/ 的/ 所有/ 消息/ 的/ 集合/ ,/ m/ / 是/ 在/ 其中/ 随机/ 选择/ 的/ 一个/ 消息/ ;/ (/ 4/ )/ 当/ pB/ 被/ 来自/ pA/ 的/ 消息/ m/ 激活/ 后/ ,/ 若/ m/ =/ m/ / ,/ F/ 让/ pB/ 回应/ 挑战/ NB/ ;/ 否则/ ,/ 随机/ 选择/ N/ ←/ / / R/ {/ 0/ ,/ 1/ }/ k/ 作为/ 挑战/ ;/ (/ 5/ )/ 当/ pA/ 被/ 来自/ pB/ 的/ 挑战/ N/ 激活/ 时/ ,/ 若/ N/ ≠/ NB/ 且/ K/ ≠/ KAB/ ,/ 计算/ 输出/ {/ m/ ,/ N/ ,/ K/ }/ AIKprivA/ ;/ 若/ N/ =/ NB/ 或/ K/ =/ KAB/ ,/ F/ 询问/ 它/ 的/ SIGNOracleS/ 进行/ 计算/ S/ (/ m/ ,/ N/ ,/ K/ )/ =/ ⊥/ ,/ 如果/ 得到/ ⊥/ ,/ 仿真/ 中止/ ,/ F/ 失败/ ./ 从/ U/ 看来/ ,/ 它/ 和/ F/ 的/ 交互/ (/ 在/ F/ 没有/ 中止/ 仿真/ 的/ 情况/ 下/ )/ 与/ 它/ 和/ PUM/ 中/ 参与者/ 的/ 真实/ 交互/ 是/ 没有/ 区别/ 的/ ./ 假设/ β/ / 是/ 指/ β/ 出现/ 在/ U/ 和/ F/ 的/ 仿真/ 交互/ 的/ 事件/ ,/ 这时/ 参与者/ 是/ pA/ ,/ 消息/ 是/ m/ / ./ 既然/ pA/ 、/ pB/ 和/ m/ / 都/ 是/ 随机/ 选择/ 的/ ,/ 若/ β/ 出现/ 的/ 概率/ 是/ ε/ ,/ 则/ β/ / 出现/ 的/ 概率/ 是/ ε/ // n/ ./ 如果/ β/ / 出现/ ,/ 则/ pB/ 最后/ 收到/ 的/ 消息/ 是/ 对/ (/ m/ / ,/ NB/ ,/ KAB/ )/ 的/ 有效/ 签名/ ./ 从/ 上述/ 规则/ 看出/ ,/ pA/ 从来/ 没有/ 产生/ 过/ 这个/ 签名/ ./ (/ 若/ pA/ 没有/ 被/ 激活/ 发送/ 消息/ m/ / ,/ 很/ 明显/ pA/ 不会/ 产生/ 这个/ 签名/ ;/ 若/ pB/ 输出/ 两次/ 相同/ 的/ 值/ ,/ 但/ 所有/ 消息/ 都/ 应该/ 是/ 不同/ 的/ ,/ 因此/ pA/ 只会/ 发送/ 消息/ m/ / 一次/ )/ ./ 因此/ F/ 不会/ 访问/ 他/ 的/ SIGNOracleS/ 进行/ 这个/ 签名/ ./ 所以/ ,/ F/ 可以/ 成功/ 的/ 攻破/ 签名/ 机制/ ,/ 这/ 违反/ 了/ 签名/ 机制/ 的/ 安全/ 假设/ ./ 综上所述/ ,/ β/ 出现/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ,/ 因此/ PTRUSTMT/ ,/ T/ / UNPTRUST/ λ/ bind/ ,/ U/ ./ 证毕/ ./ 4.3/ 可信/ 网络连接/ 的/ 定义/ 定义/ 10/ ./ 如果/ 协议/ 能够/ 满足/ 下列/ 3/ 条/ 性质/ ,/ 则/ 我们/ 称该/ 协议/ 是/ 一个/ 可信/ 网络连接/ 协议/ :/ PUM/ 环境/ 下/ 是/ 匹配/ 会话/ ./ 5/ 一个/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 可信/ 网络连接/ 架构/ 中/ 网络/ 访问/ 层/ 协议/ 采用/ 传统/ 网络连接/ 技术/ ,/ 文中/ 不再/ 考虑/ ./ 我们/ 通过/ 本文/ 提出/ 的/ 模型/ ,/ 将/ 存在/ 平台/ 替换/ 攻击/ 的/ 完整性/ 报告/ 协议/ [/ 13/ ]/ 转换成/ 安全/ 的/ 完整性/ 评估/ 层/ 协议/ ./ 转换成/ 模型/ 所/ 能/ 理解/ 的/ 形式/ 并/ 消除/ 冗余/ 的/ 信息/ :/ 首先/ 对/ 完整性/ 报告/ 协议/ 进行/ 形式化/ 描述/ ,/ 将/ 其/ (/ 1/ )/ 网络/ 访问/ 层/ 用户/ 在/ UM/ 环境/ 下/ 协商/ 出/ SK/ -/ Secure/ 的/ 会/ 话/ 密钥/ ,/ 并/ 建立/ 用户/ 之间/ 的/ 安全/ 信道/ ;/ (/ 2/ )/ 网络/ 访问/ 层/ 用户/ 与/ 完整性/ 评估/ 层/ 平台/ 之间/ 存在/ 动态/ 授权/ 绑定/ ;/ (/ 3/ )/ 完整性/ 评估/ 层/ 平台/ 之间/ 的/ 协议/ 会话/ 在/ (/ 1/ )/ 通信/ 用户/ 双方/ 预/ 共享/ 一个/ 密钥/ kij/ ;/ (/ 2/ )/ 发起方/ pi/ 收到/ 建立/ 会话/ (/ pi/ ,/ pj/ ,/ s/ )/ 的/ 请求/ 后/ ,/ 选择/ 随机数/ ri/ ←/ / / R/ {/ 0/ ,/ 1/ }/ k/ ,/ 然后/ 把/ 消息/ (/ pi/ ,/ s/ ,/ ri/ )/ 发送给/ pj/ ;/ (/ 3/ )/ 响应/ 方/ pj/ 收到/ 消息/ (/ pi/ ,/ s/ ,/ ri/ )/ 后/ ,/ 计算/ tj/ =/ sig/ {/ PCR/ ,/ ri/ }/ AIKprivj/ ,/ 然后/ 把/ 消息/ (/ pj/ ,/ s/ ,/ tj/ )/ 发送给/ pi/ ;/ (/ 4/ )/ pi/ 收到/ 消息/ (/ pj/ ,/ s/ ,/ tj/ )/ 后/ ,/ 验证/ tj/ ,/ 验证/ 通过/ 做出/ 接入/ 判断/ ./ 通过/ 绑定/ 器/ λ/ bind/ ,/ 将/ 完整性/ 报告/ 协议/ 编译/ 为/ 协议/ PSTNCP/ ,/ 如图/ 6/ 所示/ ./ 与/ 完整性/ 报告/ 协议/ 不同/ ,/ 该/ 协议/ 通过/ 两个/ 随机数/ ,/ 保证/ 协议/ 参与/ 双方/ 的/ 消息/ 新鲜/ 性/ ,/ 同时/ 利用网络/ 访问/ 层/ 协商/ 的/ 共享/ 密钥/ ,/ 对/ 完整性/ 评估/ 层/ 协议/ 消息/ 进行/ 加密/ ,/ 实现/ 用户/ 与/ 平台/ 之间/ 的/ 安全/ 绑定/ ./ 钥/ kij/ ;/ (/ 1/ )/ 网络/ 访问/ 层/ 用户/ 之间/ 共享/ SK/ 安全/ 的/ 密/ (/ 2/ )/ 发起方/ pj/ 收到/ 建立/ 会话/ (/ pj/ ,/ pi/ ,/ s/ )/ 的/ 请求/ 后/ ,/ 选择/ 随机数/ rj/ ←/ / / R/ {/ 0/ ,/ 1/ }/ k/ ,/ 然后/ 把/ 消息/ (/ pj/ ,/ s/ ,/ rj/ )/ 发送给/ pi/ ;/ (/ 3/ )/ 响应/ 方/ pi/ 收到/ 消息/ (/ pj/ ,/ s/ ,/ rj/ )/ 后/ ,/ 选择/ 随机数/ ri/ ←/ / / R/ {/ 0/ ,/ 1/ }/ k/ ,/ 然后/ 把/ 消息/ (/ pi/ ,/ s/ ,/ rj/ ,/ ri/ )/ 发送给/ pj/ ;/ (/ 4/ )/ 发起方/ pj/ 收到/ 消息/ (/ pi/ ,/ s/ ,/ rj/ ,/ ri/ )/ 后/ ,/ 计算/ tj/ =/ sig/ {/ PCR/ ,/ ri/ ,/ kij/ }/ AIKprivj/ ,/ 然后/ 把/ 消息/ (/ pj/ ,/ s/ ,/ ri/ ,/ tj/ )/ 发送给/ pi/ ;/ (/ 5/ )/ pi/ 收到/ 消息/ (/ pj/ ,/ s/ ,/ ri/ ,/ tj/ )/ 后/ ,/ 验证/ tj/ ,/ 验证/ 通过/ 做出/ 接入/ 判断/ ./ Page9/ 图/ 6/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ PSTNCP/ 定理/ 2/ ./ 如果/ 签名/ 算法/ 可/ 抵抗/ 选择/ 消息/ 攻击/ ,/ 则/ 完整性/ 报告/ 协议/ [/ 13/ ]/ 在/ PTM/ 中是/ 安全/ 的/ ./ 证明/ ./ 在/ PTM/ 环境/ 下/ 平台/ 可以/ 安全/ 的/ 使用/ 网络/ 访问/ 层/ 建立/ 的/ 安全/ 信道/ ,/ 用户/ 与/ 平台/ 之间/ 存在/ 安全/ 绑定/ ./ 因此/ ,/ 可/ 抵抗/ 选择/ 消息/ 攻击/ 的/ AIK/ 签名/ 能够/ 保证/ 完整性/ 报告/ 协议/ 在/ 该/ 环境/ 下/ 的/ 安全性/ ./ 证毕/ ./ 定理/ 3/ ./ 如果/ 签名/ 算法/ 可/ 抵抗/ 选择/ 消息/ 攻击/ ,/ 则/ 协议/ PSTNCP/ 在/ PUM/ 中是/ 安全/ 的/ ./ 证明/ ./ 由/ 定义/ 7/ 、/ 定理/ 1/ 和/ 定理/ 2/ ,/ 可/ 直接/ 推出/ 结论/ ./ 6/ 结论/ 与/ 下/ 一步/ 工作/ 本文/ 通过/ 对/ TNC/ 架构/ 和/ 完整性/ 报告/ 协议/ 的/ 深入分析/ ,/ 发现/ TNC/ 架构/ 存在/ 安全/ 缺陷/ ,/ 即/ 网络/ 访问/ 层/ 的/ 用户/ 和/ 完整性/ 评估/ 层/ 的/ 平台/ 之间/ 不/ 存在/ 绑定/ 关系/ ,/ 造成/ 网络/ 访问/ 层/ 建立/ 的/ 安全/ 信道/ 不能/ 保护/ 完整性/ 评估/ 层/ 协议/ 的/ 交互/ ./ 这一/ 安全/ 缺陷/ 会/ 引起/ 一种/ 新/ 的/ 攻击/ —/ —/ —/ 平台/ 替换/ 攻击/ ./ 为/ 有效/ 解决/ TNC/ 架构/ 安全/ 缺陷/ 造成/ 的/ 影响/ ,/ 我们/ 形式化/ 的/ 提出/ 了/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ ./ 基于/ 这一/ 目标/ 和/ CK/ 模型/ 的/ 基本/ 思想/ ,/ 本文/ 对/ 可信/ 环境/ 下/ 的/ 攻击者/ 模型/ 和/ 链路/ 模型/ 进行/ 了/ 抽象/ ,/ 提出/ 了/ 一种/ 可/ 证明/ 安全/ 的/ 可信/ 网络连接/ 协议/ 模型/ TNC/ -/ PS/ ./ 该/ 模型/ 在/ 保持/ 可信/ 网络连接/ 架构/ 不变/ 的/ 前提/ 下/ ,/ 通过/ 其中/ 的/ 绑定/ 器/ ,/ 可以/ 建立/ 用户/ 与/ 平台/ 之间/ 的/ 动态/ 绑定/ 关系/ ,/ 使/ 存在/ 安全/ 缺陷/ 的/ 完整性/ 评估/ 层/ 协议/ 转化/ 为/ TNC/ -/ PS/ 模型/ 证明/ 安全/ 的/ 协议/ ,/ 且/ 协议/ 能够/ 达到/ 可信/ 网络连接/ 协议/ 的/ 安全/ 目标/ ,/ 有效/ 解决/ 了/ TNC/ 架构/ 的/ 安全/ 缺陷/ ./ 我们/ 下/ 一步/ 的/ 工作/ 是/ :/ 使/ 绑定/ 器/ 带有/ 隐私/ 保护/ 属性/ ,/ 以/ 解决/ 完整性/ 评估/ 层/ 协议/ 隐私/ 保护/ 的/ 问题/ ./ 另外/ ,/ TNC/ -/ PS/ 模型/ 的/ 设计/ 基于/ CK/ 模型/ 的/ 基本/ 思想/ ,/ 并未/ 考虑/ 协议/ 的/ 并发/ 组合/ 情况/ ./ 因此/ ,/ 我们/ 将/ 从/ 协议/ 组合/ 理论/ 角度/ 出发/ ,/ 对模型/ 进行/ 进一步/ 的/ 完善/ ,/ 使/ 它/ 能够/ 在/ 更为/ 复杂/ 的/ 并行/ 环境/ 下/ 对/ 可信/ 网络连接/ 协议/ 进行/ 设计/ 和/ 分析/ ./ 

