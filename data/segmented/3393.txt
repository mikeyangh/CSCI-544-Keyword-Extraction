Page1/ 图像/ 超/ 分辨率/ 重建/ 的/ 非/ 局部/ 正则/ 化/ 模型/ 与/ 算法/ 研究/ 肖亮/ 韦志辉/ (/ 南京/ 理工大学/ 计算机科学/ 与/ 技术/ 学院/ 南京/ 210094/ )/ 摘要/ 利用/ 图像/ 非/ 局部/ 不连续性/ 测度/ 的/ 概念/ ,/ 建立/ 了/ 面向/ 图像/ 超/ 分辨/ 的/ 非/ 局部/ 正则/ 化/ 能量/ 泛函/ 和/ 相应/ 的/ 变分/ 框架/ ./ 理论/ 分析/ 了/ 该/ 框架/ 与/ 目前/ 关于/ 双边/ 滤波/ 等/ 一类/ 广义/ 邻域/ 滤波器/ 和/ 经典/ 的/ 变分/ 偏/ 微分方程/ 模型/ 之间/ 的/ 联系/ ./ 推导/ 了/ 该/ 非/ 局部/ 泛函/ 约束/ 的/ 变分/ 模型/ 最优/ 解/ 满足/ 的/ 积分/ 形式/ 欧拉/ -/ 拉格朗/ 日/ 方程/ ,/ 并/ 研究/ 了/ 其/ 最速/ 下降/ 流/ 满足/ 的/ 若干/ 重要/ 性质/ ./ 基于/ 图/ 理论/ ,/ 设计/ 了/ 图像/ 超/ 分辨/ 的/ 自/ 适应/ 加权/ 迭代/ 算法/ ./ 最后/ 通过/ 选择/ 不同/ 势函数/ 的/ 非/ 局部/ 正则/ 化泛/ 函/ 进行/ 图像去噪/ 、/ 去/ 马赛克/ 效应/ 和/ 图像/ 超/ 分辨/ 处理/ ,/ 性能/ 分析表明/ :/ 相同/ 势函数/ 下/ ,/ 非/ 局部/ 正则/ 化/ 方法/ 优于/ 同类/ 局部/ 正则/ 化/ 方法/ ,/ 峰值/ 信噪比/ 提高/ 0.5/ ~/ 1.0/ dB/ ./ 关键词/ 图像/ 超/ 分辨/ ;/ 非/ 局部/ 正则/ 化/ ;/ 变分/ 方法/ ;/ 积分/ 方程/ ;/ 尺度空间/ 1/ 引言/ 考虑/ 退化/ 图像/ 数据/ u0/ 中/ 恢复/ 理想/ 的/ 未知/ 图像/ 各种/ 光学/ 传感器/ 成像/ 过程/ 中/ ,/ 由于/ 相机/ 的/ 运动/ 姿态/ 不/ 稳定/ 、/ 成像/ 环境/ 变化/ 、/ 图像/ 传输/ 的/ 信道/ 干扰/ 等/ ,/ 图像/ 的/ 像/ 质/ 都/ 会/ 引起/ 不同/ 程度/ 下降/ ./ 图像/ 超/ 分辨率/ 重建/ 是/ 对/ 像/ 质/ 下降/ 观测/ 图像/ 进行/ 处理/ ,/ 在/ 保证/ 通/ 频带/ 内/ 信息/ 复原/ 的/ 基础/ 上/ ,/ 对/ 截止频率/ 以上/ 的/ 高频/ 信息/ 进行/ 复原/ 而/ 完善/ 图象/ 细节/ 和/ 高频/ 信息/ 的/ 视觉/ 质量/ 提升/ 过程/ ./ 图像/ 超/ 分辨率/ 属于/ 反/ 问题/ 研究/ 范畴/ ,/ 近几年来/ 基于/ 能量/ 泛函/ 正则/ 化/ 的/ 图像/ 超/ 分辨率/ 重建/ 因/ 其/ 高质量/ 处理/ 效果/ 已/ 引起/ 国内外/ 研究者/ 的/ 广泛/ 关注/ [/ 1/ -/ 4/ ]/ ./ Kim/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 基于/ 边缘增强/ 和/ 各向异性/ 扩散/ 的/ 超/ 分辨率/ 复原/ 正则/ 化/ 方法/ ;/ Capel/ 等/ 人/ [/ 6/ ]/ 提出/ 了/ 基于/ 全/ 变差/ 正则/ 化/ 的/ 文本/ 图像/ 序列/ 超/ 分辨率/ 复原/ 算法/ ;/ Farsiu/ 等/ 人/ [/ 7/ ]/ 提出/ 基于/ 双边/ 滤波/ (/ bilateralfiltering/ )/ 思想/ 和/ l1/ 范数/ 耦合/ 的/ 超/ 分辨率/ 复原/ 算法/ ./ 国内/ 韩玉兵/ 等/ 人/ 提出/ 了/ 全/ 变差/ 正则/ 化超/ 分辨率/ 复原/ 的/ 多重/ 网格/ 算法/ [/ 8/ ]/ ,/ 取得/ 了/ 较/ 好/ 的/ 效果/ ./ u/ ,/ 大多数/ 文献/ [/ 1/ -/ 8/ ]/ 中/ 基于/ 退化/ 过程/ 其中/ ,/ n/ 为/ 随机变量/ ,/ 表示/ 具有/ 某种/ 概率分布/ 的/ 噪声/ ,/ R/ 为/ 图像/ 模糊/ 、/ 降/ 采样/ 等/ 降/ 质因素/ 的/ 综合/ 算子/ ./ 例如/ :/ 当/ u/ 为/ 数字图像/ 时/ ,/ 犚/ 可/ 由/ 模糊/ 卷积/ 矩阵/ 犅/ 和/ 降/ 采样/ 矩阵/ 犇/ 组成/ ,/ 犚/ =/ 犅犇/ ./ 图像/ 超/ 分辨率/ 重建/ 问题/ 实质/ 上/ 从/ u0/ 中/ 估计/ 合适/ 的/ u/ ,/ 显然/ 最/ 直接/ 的/ 方法/ 是/ 最小/ 二乘/ 估计/ ,/ 即/ u/ / =/ argminuu0/ -/ Ru2R/ / u0/ -/ R/ / Ru/ =/ 0/ ,/ 这是/ 一个/ 高度/ 病态/ 的/ 不适/ 定/ 问题/ ./ 解决/ 该/ 问题/ 的/ 一条/ 有效途径/ 是/ 通过/ 正则/ 化/ 方法/ ,/ 转化/ 为/ 如下/ 能量/ 泛函/ 的/ 变分/ 问题/ :/ u/ ^/ =/ argminu/ (/ )/ Eu/ =/ ∫/ Ω/ 其中/ :/ 第/ 1/ 项为/ 图像/ 的/ 正则/ 化项/ ;/ 第/ 2/ 项为/ 数据/ 保真/ 项/ ./ 正则/ 化项/ 中/ ,/ φ/ :/ R/ +/ →/ R/ 为/ 特定/ 的/ 光滑/ 函数/ ,/ 按照/ 马尔可夫/ 随/ 机场/ 与/ 局部/ 正则/ 化泛/ 函/ 的/ 关系/ [/ 9/ ]/ ,/ 人们/ 称之为/ 位势/ 函数/ ./ 式/ (/ 2/ )/ 中/ 的/ 正则/ 化项/ 是/ 基于/ 图像/ 梯度/ (/ 或/ 分布/ 意义/ 下/ )/ 的/ ,/ 作为/ 一种/ 图像/ 不连续性/ 刻画/ ,/ 图像/ 梯度/ 是/ 一种/ 局部/ 甚至/ “/ 点态/ ”/ 的/ 不连续性/ 几何/ 特征/ ./ 当/ 观测/ 图像/ 受到/ 噪声/ 干扰/ 、/ 空间/ 分辨率/ 下降/ 和/ 存在/ 边缘/ 锯齿/ 效应/ 时/ ,/ 图像/ 梯度/ 场/ 和/ 曲率/ 会/ 发生/ 明显/ 变化/ ,/ 缺乏/ 鲁棒性/ ./ 因此/ ,/ 虽然/ 上述/ 模型/ 能够/ 有效/ 去除/ 图像/ 的/ 噪声/ ,/ 却/ 不/ 能够/ 很/ 好/ 地/ 克服/ 边缘/ 锯齿/ 效应/ ./ 在/ 图像去噪/ 领域/ ,/ 双边/ 滤波/ 等/ 一类/ 广义/ 邻域/ 滤波/ [/ 10/ -/ 11/ ]/ 由于/ 采用/ 具有/ 距离/ 与/ 灰度/ 各向异性/ 的/ 双重/ 加权/ 机制/ ,/ 使得/ 滤波/ 过程/ 具有/ 更优/ 的/ 噪声/ 抑制性/ 和/ 鲁棒/ 的/ 边缘/ 保持/ 性/ [/ 12/ -/ 13/ ]/ ./ 国内/ 邵文泽等/ 人/ 系统分析/ 了/ 双边/ 滤波/ 框架/ 下/ 17/ 种/ 非线性/ 滤波器/ 的/ 性能/ 比较/ ,/ 但是/ 并/ 没有/ 从/ 理论/ 上/ 严格/ 证明/ 该类/ 滤波器/ 与/ 能量/ 函数/ 最优/ 的/ 内在/ 关系/ 和/ 相关/ 性质/ [/ 14/ ]/ ./ ChenKe/ 也/ 注意/ 到/ 图像/ 的/ 空间/ 梯度/ 在/ 表征/ 图像/ 不连续性/ 特征/ 的/ 缺陷/ ,/ 通过/ 同时/ 考虑/ 像素/ 邻域/ 和/ 邻域/ 周边/ 区域/ 之间/ 的/ 不连续性/ 测度/ ,/ 设计/ 了/ 非线性/ 自/ 适应/ 算法/ ,/ 并且/ 给出/ 了/ 对应/ 的/ 能量/ 泛函/ [/ 15/ ]/ ./ 目前/ 国际/ 上/ 关于/ 非/ 局部/ 滤波/ 算法/ [/ 16/ ]/ 的/ 研究/ 如火如荼/ ./ 除/ 继承/ 双边/ 滤波/ 的/ 优点/ 之外/ ,/ 非/ 局部/ 滤波/ 采取/ 了/ 较大/ 范围/ 内/ 基于/ 相似/ 度/ 模板/ 匹配/ 的/ 加权/ 机制/ ,/ 具有/ 更好/ 的/ 边缘/ 和/ 纹理/ 保持/ 能力/ ./ 文献/ [/ 17/ ]/ 的/ 研究/ 表明/ 非/ 局部/ 化/ 思想/ 在/ 图像去噪/ 和/ 超/ 分辨/ 重建/ 中/ 能够/ 取得/ 很/ 好/ 的/ 效果/ ./ Gilboa/ 和/ Osher/ 等/ 系统地/ 研究/ 了/ 非/ 局部/ 滤波/ 算法/ 的/ 处理/ 机制/ ,/ 提出/ 了/ 两类/ 非/ 局部/ 正则/ 化/ 模型/ [/ 18/ -/ 19/ ]/ :/ 其一/ 为/ 基于/ 加权/ 梯度/ 模/ 的/ 非/ 局部/ 正则/ 化/ 模型/ ,/ 其二/ 为/ 基于/ 加权/ 差分/ 模/ 的/ 非/ 局部/ 正则/ 化/ 模型/ ,/ 并/ 提出/ 非/ 局部/ 算子/ 理论/ 建立/ 新/ 的/ 图像处理/ 模型/ 的/ 理论/ 框架/ ./ 在/ 文献/ [/ 18/ ]/ 中/ ,/ 他们/ 提出/ 基于/ 加权/ 差分/ 模/ 的/ 非/ 局部/ 正则/ 化泛/ 函/ J/ (/ u/ )/ =/ ∫/ Ω/ ∫/ Ω/ 其中/ 加权/ 函数/ ω/ (/ 狓/ ,/ 狔/ )/ 为/ 对称/ 正/ 函数/ ./ 他们/ 讨论/ 了/ 位势/ 函数/ φ/ (/ s/ )/ 满足/ φ/ (/ 0/ )/ =/ 0/ 的/ 非负/ 凸函数/ 情形/ ,/ 在/ 文献/ [/ 19/ ]/ 中/ 特别/ 考虑/ 了/ φ/ (/ s/ )/ =/ s2/ 时变/ 分/ 导出/ 的/ 非/ 局部/ 线性/ 算子/ 以及/ 文献/ [/ 20/ ]/ 中/ 考虑/ φ/ (/ s/ )/ =/ s2/ +/ 槡/ ε/ 时变/ 分/ 导出/ 的/ 非/ 局部/ 算子/ 在/ 图像处理/ 中/ 的/ 应用/ ,/ 但/ 对于/ 如何/ 进一步/ 构造/ 适合/ 超/ 分辨/ 重建/ 的/ 位势/ 函数/ 没有/ 系统/ 研究/ ./ 文献/ [/ 21/ ]/ 考虑/ 了/ φ/ (/ s/ )/ =/ s2/ 时/ 选取/ 具有/ 旋转/ 和/ 平移/ 匹配/ 特性/ 权值/ 函数/ ω/ (/ 狓/ ,/ 狔/ )/ 的/ 情形/ ,/ 在/ 图像去噪/ 中/ 得到/ 很/ 好/ 的/ 效果/ ./ 本文/ 在/ Gilboa/ 和/ Osher/ 的/ 研究/ 基础/ 上/ 展开/ 工作/ ,/ 基于/ 邻域/ 相关性/ 的/ 非/ 局部/ 不连续性/ 测度/ 的/ 概念/ ,/ 建立/ 了/ 面向/ 图像/ 超/ 分辨/ 的/ 非/ 局部/ 正则/ 化变分/ 模型/ ./ 分析/ 了/ 该/ 模型/ 与/ 双边/ 滤波/ 等/ 一类/ 邻域/ 滤波器/ 和/ 经典/ 变分/ 偏/ 微分方程/ 模型/ 的/ 联系/ ,/ 确定/ 了/ 变分/ 模型/ 中/ 位势/ 函数/ 的/ 选取/ 原则/ ./ 理论/ 推导/ 了/ 最优/ 解/ 满足/ 的/ 积分/ 形式/ 欧拉/ -/ 拉格朗/ 日/ 方程/ ./ 在/ 本文/ 给出/ 的/ 一类/ 位势/ 函数/ 下/ ,/ 系统/ 研究/ 了/ 对应/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 最速/ 下降/ 流/ 及其/ 相关/ 性质/ ./ 基于/ 图/ 理论/ ,/ 建立/ 了/ 该/ 连续/ 变分/ Page3/ 模型/ 的/ 离散/ 模型/ 以及/ 相应/ 的/ 自/ 适应/ 加权/ 数字滤波/ 算法/ ./ 最后/ 通过/ 选择/ 不同/ 势函数/ 的/ 非/ 局部/ 正则/ 化泛/ 函/ 进行/ 图像去噪/ 、/ 去/ 马赛克/ 效应/ 和/ 图像/ 超/ 分辨/ 处理/ ,/ 性能/ 分析表明/ :/ 相同/ 势函数/ 下/ ,/ 非/ 局部/ 正则/ 化/ 方法/ 大大/ 优于/ 同类/ 局部/ 正则/ 化/ 方法/ ./ 2/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 提出/ 与/ 相关/ 性质/ 研究/ 2.1/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 导出/ 事实上/ 当/ 观测/ 图像/ 的/ 边缘/ 存在/ 锯齿/ 效应/ 时/ ,/ 不连续性/ 特征/ 应该/ 是/ 像素/ 的/ 某个/ 邻域/ 范围/ 内/ 不连续性/ 的/ 一种/ 稳健性/ 估计/ ./ 考虑/ 到/ 超/ 分辨率/ 复原/ 中/ 观测/ 图像/ 的/ 锯齿/ 效应/ 、/ 噪声污染/ 和/ 模糊/ 效应/ 等/ 几/ 方面/ 的/ 降/ 质因素/ ,/ 本文/ 定义/ 一个/ 具有/ 邻域/ 相关性/ 的/ 非/ 局部/ 不连续性/ 测度/ 槇/ Du/ (/ 狓/ )/ =/ ∫/ 狔/ ∈/ Ω/ (/ 狓/ )/ 其中/ 位势/ 函数/ φ/ :/ R/ →/ R/ +/ 为/ 特定/ 的/ 非负/ 光滑/ 函数/ ,/ 目的/ 是/ 对/ 灰度/ 差/ 进行/ 提升/ ./ g/ (/ 狓/ ,/ 狔/ )/ ∈/ Ω/ ×/ Ω/ 狓/ 为/ 图像/ 中/ 某个/ 像素/ 狓/ ,/ 与其/ 邻域/ 像素/ 狔/ 之间/ 的/ 几何/ 相似性/ 测度/ ,/ 同/ 文献/ [/ 19/ ]/ 定义/ ,/ 满足/ 如下/ 性质/ :/ (/ 1/ )/ 非/ 负性/ ,/ g/ (/ 狓/ ,/ 狔/ )/ >/ 0/ ;/ (/ 2/ )/ 对称性/ ,/ g/ (/ 狓/ ,/ 狔/ )/ =/ g/ (/ 狔/ ,/ 狓/ )/ ;/ (/ 3/ )/ 有界性/ ,/ g/ (/ 狓/ ,/ 狔/ )/ / M/ ;/ (/ 4/ )/ 等值/ 极大/ 性/ ,/ g/ (/ 狓/ ,/ 狓/ )/ / g/ (/ 狓/ ,/ 狔/ )/ ,/ / 狓/ ,/ 狔/ ./ 不妨/ 令则/ 利用/ 上述/ 非/ 局部/ 不连续性/ 测度/ 的/ 概念/ ,/ 基于/ Gilboa/ 和/ Osher/ 的/ 非/ 局部/ 正则/ 化/ 理论/ ,/ 可定义/ 一个/ 图像/ 非/ 局部/ 正则/ 化/ 模型/ ,/ Eregular/ (/ u/ )/ =/ ∫/ Ω/ ∫/ Ω/ 该/ 能量/ 泛函比/ 局部/ 的/ 能量/ 泛函/ 具有/ 更好/ 的/ 一般性/ ./ 例如/ 如果/ g/ (/ 狓/ ,/ 狔/ )/ 取为/ e/ -/ s2/ 函数/ ,/ 而/ φ/ (/ s/ )/ =/ s2/ ,/ 则/ 上述/ 泛函/ 可以/ 对应/ Tomasi/ 和/ Manduchi/ 等/ 人/ [/ 11/ -/ 12/ ]/ 提出/ 的/ 双边/ 滤波/ 方法/ ./ 又/ 如/ ,/ 取/ g/ (/ 狓/ ,/ 狔/ )/ 为/ δ/ -/ 冲击/ 函数/ ,/ 而/ |/ Ω/ (/ 狓/ )/ |/ →/ 0/ ,/ 能量/ 泛函/ (/ 5/ )/ 为式/ (/ 2/ )/ 的/ 形式/ ./ 2.2/ 非/ 局部/ 正则/ 化泛/ 函中/ 位势/ 函数/ 的/ 选取/ 由于/ 式/ (/ 5/ )/ 一方面/ 是/ 式/ (/ 2/ )/ 的/ 正则/ 化泛/ 函/ 的/ 推广/ ,/ 另一方面/ 与非/ 局部/ 邻域/ 滤波/ [/ 11/ -/ 13/ ]/ 存在/ 理论/ 上/ 的/ 联系/ ,/ 因此/ 函数/ φ/ (/ ·/ )/ 的/ 选择/ 完全/ 可以/ 参照/ 局部/ 能量/ 泛函/ 和/ 邻域/ 滤波/ 机制/ 的/ 选取/ 规则/ 进行/ ./ 选取/ 的/ 基本/ 原则/ 包括/ :/ (/ A1/ )/ 能量最优/ 基本/ 条件/ ,/ 主要/ 确保/ 正则/ 化泛/ 函/ 的/ 正则/ 性/ ,/ 能够/ 进行/ 能量/ 最小化/ ;/ (/ A2/ )/ 如果/ 希望/ 得到/ 全局/ 最优/ 的/ 唯一/ 解/ ,/ 需要/ 确保/ 泛函/ 的/ 凸性/ ;/ (/ A3/ )/ 边缘/ 保持/ 条件/ ,/ 从/ 图像处理/ 角度/ 来看/ ,/ 希望/ 能够/ 有效/ 保持/ 图像/ 的/ 边缘/ 、/ 纹理/ 等/ 重要/ 的/ 视觉/ 特征/ ./ 为了/ 给出/ 位势/ 函数/ 的/ 边缘/ 保持/ 条件/ ,/ 首先/ 从/ Perona/ 等/ 人/ [/ 22/ ]/ 提出/ 的/ 各向异性/ 扩散/ 方程/ (/ PM/ 方程/ )/ 来/ 分析/ ,/ 该/ 方程/ 为/ 其中/ ,/ h/ (/ t/ )/ 称为/ 边缘/ 保持/ 函数/ ,/ 图像/ u/ (/ α/ ,/ t/ )/ :/ Ω/ ×/ [/ 0/ ,/ +/ )/ →/ R/ ./ 为了/ 有效/ 去除/ 噪声/ 并/ 保持/ 图像/ 的/ 边缘/ 结构/ ,/ PM/ 方程/ 的/ 思想/ 是/ 在/ 弱/ 梯度/ 区域/ (/ |/ / u/ |/ 较/ 小/ )/ 采取/ 各向同性/ 平滑/ ;/ 相反/ ,/ 在/ 采取/ 强/ 梯度/ 区域/ 各向异性/ 增强/ ./ 因此/ h/ (/ t/ )/ 一般/ 取/ 单调/ 递减/ 的/ 函数/ ,/ 如/ h/ (/ t/ )/ =/ 1/ // (/ 1/ +/ t2/ // σ/ 2/ )/ ,/ σ/ 为/ 正常/ 数/ ./ 事实上/ 如果/ 存在/ 函数/ φ/ 满足/ h/ (/ t/ )/ =/ φ/ (/ t/ )/ // t/ 时/ ,/ 并/ 令/ 犜/ 和/ 犖/ 为/ 图像/ 局部/ 坐标系/ 下/ 当前/ 等/ 照度/ 线/ (/ IsophoteLine/ )/ 的/ 切线/ 方向/ 和/ 法线/ 方向/ ,/ uTT/ 和/ uNN/ 分别/ 为/ 切线/ 和/ 法线/ 方向/ 的/ 2/ 阶/ 导数/ ,/ 则/ / t/ =/ / ·/ (/ h/ (/ |/ / u/ |/ )/ / u/ )/ =/ / ·/ φ/ (/ |/ / u/ |/ )/ / u/ / u/ =/ φ/ (/ |/ / u/ |/ )/ 不难/ 发现/ Perona/ 等/ 人/ 给出/ 的/ h/ (/ t/ )/ 使得/ 函数/ φ/ 满足/ lims/ →/ 0/ +/ φ/ (/ s/ )/ </ ,/ lims/ →/ +/ φ/ (/ s/ )/ </ ;/ lims/ →/ 0/ φ/ (/ s/ )/ // s/ =/ M/ >/ 0/ ,/ lims/ →/ φ/ (/ s/ )/ // s/ =/ 0/ ;/ φ/ (/ s/ )/ // s/ ,/ s/ ∈/ [/ 0/ ,/ +/ )/ 单调/ 下降/ ,/ 从而/ 能够/ 分别/ 控制/ 切线/ 和/ 法线/ 方向/ 的/ 扩散/ 速度/ 达到/ 保持/ 边缘/ 的/ 目的/ ,/ 并且/ 可/ 看作/ 是/ 能量/ 函数/ ∫/ Ω/ 的/ 最速/ 下降/ 求解/ ./ 的/ 离散/ 化形/ 如/ 下面/ 的/ 非线性/ 滤波/ [/ 13/ ]/ 另一方面/ ,/ 稳态/ PM/ 方程/ / ·/ (/ h/ (/ |/ / u/ |/ )/ / u/ )/ =/ 0un/ +/ 1/ (/ α/ )/ =/ ∑/ β/ ~/ α/ 式/ 中/ ,/ β/ ~/ α/ 为/ 像素点/ α/ 的/ 最/ 邻近/ 4/ 邻域/ ./ 如果/ 在/ 式/ (/ 7/ )/ 的/ 基础/ 上/ 加入/ 几何/ 距离/ 相似性/ 度量/ ω/ ,/ 得到/ un/ +/ 1/ (/ α/ )/ =/ ∑/ β/ ~/ α/ 当/ 函数/ ω/ 定义/ 为/ 欧式/ 距离/ 的/ 高斯/ 核/ 函数/ 时/ ,/ 可以/ 看到/ 上述/ 改进/ 的/ 滤波/ 格式/ 是/ Tomasi/ 和/ Manduchi/ 提出/ 的/ 双边/ 滤波/ [/ 11/ ]/ ./ 假设/ 迭代/ 过程/ (/ 8/ )/ 收敛/ ,/ 即/ 满足/ Page4u/ (/ α/ )/ =/ ∑/ β/ ~/ α/ 将式/ (/ 9/ )/ 展开/ ,/ 得/ ∑/ β/ ~/ α/ h/ (/ u/ (/ α/ )/ -/ u/ (/ β/ )/ )/ ·/ (/ u/ (/ α/ )/ -/ u/ (/ β/ )/ )/ ·/ ω/ (/ α/ ,/ β/ )/ =/ 0/ 当/ 存在/ 函数/ φ/ 满足/ h/ (/ t/ )/ =/ φ/ (/ t/ )/ // t/ 时/ ,/ 显然/ 上述/ 离散/ 迭代/ 格式/ 可/ 看作/ 是/ 如下/ 离散/ 能量/ 泛函/ 的/ 求解/ u/ =/ argminu/ ∑/ α/ ∈/ Ω/ ∑/ β/ ~/ α/ 将/ 上述/ 离散/ 目标/ 函数/ 推广/ 至/ 连续/ 情形/ ,/ 可/ 得到/ 非/ 局部/ 正则/ 化泛/ 函/ u/ =/ argminu/ ∫/ Ω/ ∫/ Ω/ 综合/ 上述/ 分析/ ,/ 注意/ 到/ P/ -/ M/ 方程/ 中/ 的/ 函数/ 特性/ 以及/ 该/ 边缘/ 保持/ 函数/ h/ (/ ·/ )/ 与非/ 局部/ 正则/ 化泛/ 函/ (/ 5/ )/ 中/ 位势/ 函数/ 的/ 关系/ ,/ 即/ h/ (/ t/ )/ =/ φ/ (/ t/ )/ // t/ ,/ 本文/ 建议/ 位势/ 函数/ 具有/ 如下/ 9/ 条/ 性质/ ./ limn/ →/ un/ (/ α/ )/ =/ u/ (/ α/ )/ ,/ / α/ ∈/ Ω/ ,/ 从而/ 下/ 式/ 成立/ -/ φ/ (/ -/ s/ )/ ,/ φ/ (/ s/ )/ ·/ s/ / 0/ ;/ A1/ ./ 能量/ 泛函/ 的/ 基本/ 条件/ :/ (/ 1/ )/ 非/ 负性/ ./ φ/ (/ s/ )/ / 0/ ,/ / s/ ∈/ R/ 且/ φ/ (/ 0/ )/ =/ 0/ ;/ (/ 2/ )/ 对称性/ ./ φ/ (/ s/ )/ =/ φ/ (/ -/ s/ )/ ,/ / s/ ∈/ R/ ;/ (/ 3/ )/ 可微性/ ./ φ/ (/ s/ )/ 几乎/ 处处/ 可微/ ;/ (/ 4/ )/ 单调/ 性/ ./ φ/ (/ s/ )/ / 0/ ,/ / s/ / 0/ ;/ (/ 5/ )/ 导/ 函数/ 1/ ,/ 3/ 象限/ 有/ 界/ 反对称性/ ./ φ/ (/ s/ )/ =/ A2/ ./ 泛函/ 的/ 凸性/ 条件/ :/ (/ 6/ )/ φ/ (/ s/ )/ 存在/ ,/ φ/ (/ s/ )/ / 0/ ;/ A3/ ./ 边缘/ 保持/ 条件/ :/ (/ 7/ )/ lims/ →/ 0/ +/ φ/ (/ s/ )/ </ ,/ lims/ →/ +/ φ/ (/ s/ )/ </ ;/ (/ 8/ )/ lims/ →/ 0/ φ/ (/ s/ )/ // s/ =/ M/ >/ 0/ ,/ lims/ →/ φ/ (/ s/ )/ // s/ =/ 0/ ;/ (/ 9/ )/ φ/ (/ s/ )/ // s/ ,/ s/ ∈/ [/ 0/ ,/ +/ )/ 单调/ 下降/ ./ 满足/ 上述/ 条件/ 的/ 位势/ 函数/ 有/ 很多/ ./ 在/ 形如/ (/ 2/ )/ 的/ 经典/ 正则/ 化/ 模型/ 中/ ,/ 不同/ 的/ 位势/ 函数/ 对应/ 不同/ 的/ 正则/ 化/ 模型/ ./ 例如/ :/ Tikhonov/ 正则/ 化/ 方法/ 中/ φ/ (/ s/ )/ =/ s2/ ;/ Rudin/ 和/ Osher/ 等/ 人/ 提出/ 的/ 全/ 变差/ 正则/ 化/ 方法/ [/ 23/ ]/ 中/ φ/ (/ s/ )/ =/ |/ s/ |/ ./ 研究/ 表明/ :/ Tikhonov/ 正则/ 化/ 适合/ 于/ 图像/ 中/ 的/ 平坦/ 区域/ ,/ 容易/ 模糊/ 边缘/ 等/ 重要/ 的/ 视觉/ 特征/ ,/ 而全/ 变差/ 图像/ 模型/ 能够/ 较/ 好/ 保持/ 图像/ 边缘/ [/ 24/ ]/ ./ 由于/ 图像/ 被/ 认为/ 是/ 包含/ 边缘/ 曲线/ 的/ 分片/ 平坦/ 区域/ 组成/ ,/ 因此/ 文献/ [/ 25/ ]/ 根据/ 稳健性/ 统计/ 理论/ 构造/ 了/ Huber/ 位势/ 函数/ ,/ 而/ 利用/ 最大/ 熵/ 原理/ ,/ 构造/ 的/ 位势/ 函数/ 为/ φ/ (/ s/ )/ =/ |/ s/ |/ ,/ 上述/ 两个/ 位势/ 函数/ 都/ 包含/ TV/ 势函数/ ,/ 是/ 介于/ 一次/ 线性/ 和/ 二次/ 非线性/ 函数/ 之间/ 的/ 一种/ 分段/ 耦合/ 函数/ ,/ 并且/ 满足/ A1/ ~/ A3/ 三个/ 条件/ ,/ 因此/ 在/ 图像/ 平坦/ 区域/ 能够/ 执行/ 各向同性/ 的/ 扩散/ 、/ 而/ 在/ 边缘/ 区域/ 的/ 扩散/ 机制/ 是/ 各向异性/ 的/ ,/ 具有/ 边缘/ 结构/ 保持/ 特性/ ,/ 因此/ 是/ 本文/ 推荐/ 使用/ 的/ 位势/ 函数/ ./ 2.3/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 最速/ 下降/ 流/ 的/ 若干/ 性质/ 基于/ 能量/ 泛函/ 最优/ 的/ 图像/ 超/ 分辨/ 算法/ 往往/ 通过/ 变分法/ 导出/ Euler/ -/ Lagrange/ 方程/ ,/ 然后/ 通过/ 最速/ 下降/ 流所/ 表示/ 的/ 演化/ 方程/ 进行/ 求解/ ,/ 因此/ 分析/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 最速/ 下降/ 流/ 的/ 性质/ ,/ 对于/ 研究/ 该/ 非/ 局部/ 泛函/ 的/ 图像/ 超/ 分辨/ 处理/ 机制/ 非常/ 重要/ ./ 下面/ ,/ 给出/ 的/ 定理/ 1/ 揭示/ 了/ 该/ 非/ 局部/ 泛函/ 最优化/ 对应/ 的/ Euler/ -/ Lagrange/ 方程/ ,/ 该/ Euler/ -/ Lagrange/ 方程/ 不再/ 是/ 偏/ 微分方程/ 形式/ ,/ 而是/ 一个/ 积分/ 方程/ ./ 定理/ 1/ ./ 如果/ φ/ (/ s/ )/ 满足/ A1/ :/ 基本/ 条件/ ,/ 相似性/ 函数/ ω/ (/ 狓/ ,/ 狔/ )/ =/ ω/ (/ 狔/ ,/ 狓/ )/ / 0/ ,/ 则/ 非/ 局部/ 正则/ 化泛/ 函/ Eregular/ (/ u/ )/ =/ ∫/ 狓/ ∈/ Ω/ ∫/ 狔/ ∈/ Ω/ (/ 狓/ )/ 的/ 欧拉/ -/ 拉格朗/ 日/ 方程/ 为/ -/ Lu/ =/ 0/ ,/ 其中/ ,/ 如果/ φ/ (/ s/ )/ 满足/ A2/ :/ 凸性/ 条件/ ,/ 则/ 非/ 局部/ 正则/ 化泛/ 函是/ 全局/ 凸/ 的/ ./ 证明/ ./ (/ 1/ )/ 利用/ A1/ 中/ 的/ 条件/ 及/ 变分法/ 进行/ 证明/ :/ 由于/ dd/ τ/ E/ (/ u/ +/ τ/ v/ )/ |/ τ/ =/ 0/ =/ ∫/ Ω/ ∫/ Ω/ =/ ∫/ Ω/ ∫/ Ω/ ∫/ Ω/ ∫/ Ω/ =/ ∫/ Ω/ ∫/ Ω/ ∫/ Ω/ ∫/ Ω/ 由于/ φ/ (/ s/ )/ =/ -/ φ/ (/ -/ s/ )/ ,/ ω/ (/ 狓/ ,/ 狔/ )/ =/ ω/ (/ 狔/ ,/ 狓/ )/ ,/ dd/ τ/ E/ (/ u/ +/ τ/ v/ )/ |/ τ/ =/ 0/ =/ -/ 2/ ∫/ Ω/ ∫/ Ω/ Page5/ 因此/ 由/ 变分/ 引理/ (/ 2/ )/ 另一方面/ ,/ d/ τ/ 2E/ (/ u/ +/ τ/ v/ )/ =/ ∫/ Ω/ ∫/ Ω/ d2/ 因此/ 当/ φ/ (/ s/ )/ / 0/ 时/ ,/ d2/ 泛函/ 是/ 全局/ 凸/ 的/ ./ 下面/ 考察/ 积分/ 方程/ 中/ 积分算子/ 的/ 性质/ ,/ 进而/ 分析/ 最速/ 下降/ 流/ 的/ 性质/ ./ 文献/ [/ 18/ -/ 20/ ]/ 讨论/ 了/ 非/ 局部/ 正则/ 化泛/ 函/ (/ 3/ )/ 及其/ 最速/ 下降/ 流/ 的/ 基本/ 性质/ ,/ 他们/ 给出/ 的/ 证明/ 方法/ 对/ 位势/ 函数/ 满足/ A1/ 、/ A2/ 、/ A3/ 等/ 3/ 个/ 条件/ 下/ 对应/ 的/ L/ 算子/ (/ 5/ )/ 同样/ 适应/ ./ 因此/ 本文/ 利用/ Gilboa/ 和/ Osher/ 的/ 思想/ 给出/ 最速/ 下降/ 流/ 的/ 若干/ 性质/ 并/ 重新/ 给出/ 证明/ ./ 定理/ 2/ ./ 如果/ φ/ (/ s/ )/ 满足/ A1/ :/ 正则/ 性/ 条件/ ,/ 相似性/ 函数/ ω/ (/ 狓/ ,/ 狔/ )/ =/ ω/ (/ 狔/ ,/ 狓/ )/ / 0/ ,/ 由式/ (/ 12/ )/ 定义/ 的/ L/ 算子/ 满足/ 如下/ 性质/ ./ (/ / )/ 0/ ./ u/ (/ 狓/ )/ 〉/ / 0/ ./ 性质/ 1/ ./ u/ (/ 狓/ )/ ≡/ C/ / Lu/ (/ 狓/ )/ ≡/ 0/ ./ 性质/ 2/ ./ u/ (/ 狓/ 0/ )/ / (/ / )/ u/ (/ 狓/ )/ ,/ / 狓/ ∈/ Ω/ / Lu/ (/ 狓/ 0/ )/ / 性质/ 3/ ./ -/ L/ 为/ 非/ 负半/ 正定/ 算子/ ,/ 即/ 〈/ -/ Lu/ (/ 狓/ )/ ,/ 性质/ 4/ ./ ∫/ Ω/ 证明/ ./ 性质/ 1/ 和/ 性质/ 2/ :/ 由/ φ/ (/ s/ )/ / 0/ ,/ / s/ ∈/ R/ 且/ φ/ (/ 0/ )/ =/ 0/ 及/ L/ 算子/ 的/ 定义/ 易证/ ./ 性质/ 3/ 的/ 证明/ :/ 利用/ ω/ (/ 狓/ ,/ 狔/ )/ =/ ω/ (/ 狔/ ,/ 狓/ )/ / 0/ ,/ φ/ (/ s/ )/ =/ -/ φ/ (/ -/ s/ )/ ,/ φ/ (/ s/ )/ ·/ s/ / 0/ 可证/ 〈/ -/ Lu/ (/ 狓/ )/ ,/ u/ (/ 狓/ )/ 〉/ =/ -/ ∫/ Ω/ ∫/ Ω/ =/ φ/ (/ -/ s/ )/ =/ -/ φ/ (/ s/ )/ ∫/ Ω/ ∫/ Ω/ 2/ ∫/ Ω/ ∫/ Ω/ =/ 12/ ∫/ Ω/ ∫/ Ω/ 12/ ∫/ Ω/ ∫/ Ω/ =/ 1/ φ/ (/ s/ )/ s/ / 0/ ,/ ω/ (/ 狓/ ,/ 狔/ )/ / 00/ ./ / 性质/ 4/ 的/ 证明/ :/ 利用/ 积分/ 与/ 积分/ 符号/ 无关/ ,/ 及/ ω/ (/ 狓/ ,/ 狔/ )/ =/ ω/ (/ 狔/ ,/ 狓/ )/ / 0/ ,/ φ/ (/ s/ )/ =/ -/ φ/ (/ -/ s/ )/ 可证/ ∫/ Ω/ Lu/ (/ 狓/ )/ d/ 狓/ =/ ∫/ Ω/ ∫/ Ω/ 定理/ 3/ ./ 最速/ 下降/ 流/ / u/ (/ 狓/ ,/ t/ )/ 0/ )/ =/ u0/ 满足/ 如下/ 性质/ ./ 性质/ 1/ ./ 均值/ 保持/ 性/ 性质/ 2/ ./ 极值/ 原理/ minxu0/ (/ 狓/ ,/ t/ )/ / u/ (/ 狓/ ,/ t/ )/ / maxxu0/ (/ 狓/ ,/ t/ )/ ,/ / 狓/ ∈/ Ω/ ,/ / t/ / 0/ ./ 性质/ 3/ ./ 演化过程/ 中/ 的/ 能量/ 下降/ 性/ 性质/ 4/ ./ 方差/ 递减性/ ,/ 令/ Var/ (/ u/ (/ 狓/ ,/ t/ )/ )/ ·/ ·/ =/ 1/ 则/ 性质/ 5/ ./ 当/ 算子/ L/ 仅/ 具有/ 1/ 重零/ 特征值/ ,/ 则/ 最速/ 下降/ 流/ 收敛/ 于/ 一个/ 常数/ 证明/ ./ 利用/ 定理/ 2/ 容易/ 给出/ 定理/ 3/ 的/ 证明/ ,/ 可/ 参照/ 文献/ [/ 18/ ]/ 中/ 性质/ 3/ 的/ 证明/ 进行/ ./ 证毕/ ./ 定理/ 4/ ./ 若/ φ/ (/ s/ )/ 同时/ 满足/ A1/ 、/ A3/ 条件/ ,/ 最速/ 下降/ 流/ / u/ (/ 狓/ ,/ t/ )/ 有/ 各向异性/ 扩散/ 性质/ ./ 证明/ ./ 若/ φ/ (/ s/ )/ 同时/ 满足/ A1/ 、/ A3/ 条件/ ,/ 则/ φ/ (/ s/ )/ // s/ =/ h/ (/ s/ )/ 且/ 为/ 正/ 函数/ ./ 如果/ 图像/ u/ (/ 狓/ ,/ t/ )/ 在/ 狓/ 点/ 为/ 边缘/ 点/ |/ / u/ (/ 狓/ )/ |/ >/ M/ ,/ 其/ 邻域/ 为/ N/ (/ 狓/ )/ ./ 设/ 通过/ 该/ 边缘/ 点/ 的/ 光滑/ 边缘/ 曲线/ C/ =/ {/ 狓/ |/ / u/ (/ 狓/ )/ |/ >/ M/ }/ ,/ 则/ 该/ 曲线/ 将/ 邻域/ N/ (/ 狓/ )/ 分为/ 两/ 部分/ N/ (/ 狓/ )/ =/ C/ ∪/ Ω/ \/ C/ ,/ 则/ Page6/ 由/ 微分/ 中/ 值/ 定理/ / t/ =/ ∫/ C/ / u/ (/ 狓/ ,/ t/ )/ =/ ∫/ Ch/ (/ (/ u/ (/ 狔/ )/ -/ u/ (/ 狓/ )/ )/ (/ u/ (/ 狔/ )/ -/ u/ (/ 狓/ )/ )/ ω/ (/ 狓/ ,/ 狔/ )/ d/ 狔/ +/ ∫/ Ω/ \/ Ch/ (/ (/ u/ (/ 狔/ )/ -/ u/ (/ 狓/ )/ )/ (/ u/ (/ 狔/ )/ -/ u/ (/ 狓/ )/ )/ ω/ (/ 狓/ ,/ 狔/ )/ d/ 狔/ =/ h/ (/ ξ/ )/ ∫/ Ch/ (/ ζ/ )/ ∫/ Ω/ \/ C/ 令/ 犜/ =/ / ⊥/ u/ |/ / u/ |/ 和/ 犖/ =/ / u/ 等/ 照度/ 线/ 的/ 切线/ 方向/ 和/ 法线/ 方向/ ,/ uT/ 、/ uN/ 、/ uTT/ 和/ uNN/ 分别/ 为/ 切线/ 和/ 法线/ 方向/ 的/ 1/ 阶和/ 2/ 阶/ 导数/ ,/ 则/ 局部/ 坐标系/ 下/ 狔/ =/ 狓/ +/ (/ e1/ ,/ e2/ )/ ,/ |/ e/ |/ =/ e2/ 勒/ 公式/ 展开/ u/ (/ 狔/ )/ =/ u/ (/ 狓/ )/ +/ e1uT/ +/ e2uN/ +/ 1/ 令/ C/ (/ u/ )/ =/ ∫/ C/ ∫/ Ω/ \/ C/ (/ u/ (/ 狔/ )/ -/ u/ (/ 狓/ )/ )/ ω/ (/ 狓/ ,/ 狔/ )/ d/ 狔/ ,/ 前者/ 为线/ 积分/ ,/ 而/ 后者/ 为/ 区域/ 积分/ ./ 将式/ (/ 13/ )/ 代入/ C/ (/ u/ )/ 和/ R/ (/ u/ )/ 转化/ 为/ 关于/ 变量/ e1/ ,/ e2/ 的/ 积分/ ,/ 考虑/ h/ (/ s/ )/ 单调/ 下降/ ,/ 可/ 看出/ :/ ①/ 当/ 狔/ ∈/ C/ ,/ 则/ ξ/ ≈/ 0/ ,/ h/ (/ ξ/ )/ →/ M/ >/ 0/ 且/ C/ (/ u/ )/ ∝/ uTT/ 、/ R/ (/ u/ )/ =/ 0/ ;/ ②/ 而/ 当/ 狔/ ∈/ Ω/ \/ C/ ,/ 则/ ζ/ / 0/ ,/ h/ (/ ζ/ )/ / M/ 且/ C/ (/ u/ )/ ∝/ uTT/ 、/ R/ (/ u/ )/ ∝/ uNN/ ./ 从而/ h/ (/ ξ/ )/ 可/ 看作/ 是/ 切线/ 方向/ 的/ 扩散/ 速度/ ,/ h/ (/ ζ/ )/ 可/ 看作/ 是/ 法线/ 方向/ 的/ 扩散/ 速度/ ./ 因此/ 最速/ 下降/ 流在/ 局部/ 邻域/ 具有/ 各向异性/ 扩散/ 性质/ ./ 定理/ 3/ 中/ 性质/ 1/ 表明/ 非/ 局部/ 泛函/ 所/ 导出/ 的/ 最速/ 下降/ 流/ 能够/ 确保/ 图像/ 滤波/ 过程/ 中/ 平均/ 亮度/ 不变/ ,/ 性质/ 2/ 表明/ 滤波/ 过程/ 是/ 稳定/ 的/ ;/ 而/ 性质/ 3/ ~/ 5/ 表明/ 图像/ 的/ 滤波/ 过程/ 中/ 噪声/ 等/ 非/ 结构性/ 信息/ 被/ 不断/ 去除/ ;/ 同时/ 随着/ 演化/ 的/ 进行/ ,/ 图像/ 的/ 高频/ 细节/ 不断/ 减少/ ,/ 图像/ 越来越/ 平坦/ ,/ 最终/ 收敛/ 到/ 一个/ 常数/ 图像/ ./ 而/ 定理/ 4/ 表明/ ,/ 非/ 局部/ 能量/ 泛函/ 在/ 局部/ 邻域/ 具有/ 各向异性/ 扩散/ 性质/ ./ 作为/ 一个/ 验证/ 的/ 例子/ :/ 本文/ 取/ φ/ (/ s/ )/ =/ |/ s/ |/ ,/ ω/ (/ 狓/ ,/ 狔/ )/ 的/ 定义/ 见/ 第/ 3/ 节/ ,/ 则/ 局部/ 正则/ 化/ 模型/ 为/ TV/ 模型/ [/ 26/ ]/ :/ 而/ 相应/ 的/ 非/ 局部/ 正则/ 化泛/ 函为/ ENLTV/ (/ u/ )/ =/ ∫/ Ω/ ∫/ Ω/ 图/ 1/ 是/ 两者/ 最速/ 下降/ 流对/ “/ House/ ”/ 图像去噪/ (/ 均值/ 为/ 0/ 、/ 方差/ 为/ 20/ 高斯/ 噪声/ )/ 的/ 对比/ 实验/ ,/ 实验/ 中/ 滤波/ 终止/ 时间/ 以/ 滤波/ 图像/ 峰值/ 信噪比/ 达到/ PSNR/ 最大/ 为止/ ./ 由图/ 1/ 可知/ ,/ 虽然/ 经典/ TV/ 滤波/ 能/ 大部分/ 保持/ 图像/ 边缘/ ,/ 但是/ 在/ 阶跃/ 边缘/ 附近/ 产生/ 了/ 部分/ “/ 阶梯/ 效应/ ”/ ,/ 同时/ 树木/ 细小/ 枝干/ 区域/ 不是/ 特别/ 清晰/ ;/ 而/ 非/ 局部/ TV/ 滤波/ 较/ 好/ 地/ 克服/ 了/ 上述/ 问题/ ./ 图/ 2/ 是/ 对/ 一幅/ 加入/ 3/ ×/ 3/ 窗口/ 大小/ 马赛克/ 效应/ 的/ “/ Girl/ ”/ 图像/ 分别/ 应用/ 经典/ TV/ 滤波/ 和/ 非/ 局部/ TV/ 滤波/ (/ RGB/ 三/ 通道/ 逐次/ 处理/ )/ 30/ 次/ 的/ 效果/ 对比/ 图/ ./ 从/ 视觉效果/ 来看/ ,/ 加入/ 马赛克/ 的/ “/ Girl/ ”/ 图像/ 边缘/ 锯齿/ 效应/ 非常明显/ ,/ 滤波/ 后/ 两者/ 都/ 具有/ 去/ 边缘/ 锯齿/ 的/ 能力/ ,/ 但是/ 非/ 局部/ TV/ 滤波/ 图像/ 边缘/ 光滑度/ 更好/ ,/ 轮廓线/ 更加/ 清晰/ ./ Page7/ 图/ 2/ 去/ 马赛克/ 效应/ 3/ 图像/ 超/ 分辨/ 非/ 局部/ 变分/ 模型/ 及/ 算法/ 上述/ 理论/ 分析/ 和/ 实验/ 表明/ ,/ 非/ 局部/ 能量/ 泛函/ 具备/ 很/ 好/ 的/ 去/ 噪/ 、/ 去模糊/ 和/ 去/ 马赛克/ 能力/ ./ 本文/ 将/ 其/ 作为/ 正则/ 化项/ 应用/ 于/ 图像/ 的/ 超/ 分辨率/ 重建/ ,/ 建立/ 如下/ 带/ 约束/ 最优化/ 模型/ u/ ·/ ·/ =/ argminuEregular/ (/ u/ )/ ,/ s/ ./ t/ ./ u0/ -/ Ru2/ 利用/ 拉格朗/ 日/ 乘子法/ ,/ 该/ 带/ 约束/ 最优化/ 问题/ 转化/ 为/ 如下/ 变分/ 问题/ u/ / =/ argminu/ {/ E/ (/ u/ )/ =/ Eregular/ (/ u/ )/ +/ λ/ EData/ (/ u/ ,/ u0/ )/ }/ =/ argminu/ ∫/ Ω/ ∫/ Ω/ 推论/ 1/ ./ 如果/ 变分/ 问题/ 存在/ 最小/ 解/ ,/ 则/ 该/ 最小/ 解/ 满足/ Euler/ -/ lagrange/ 方程/ 特别/ 的/ ,/ 当/ φ/ (/ s/ )/ 存在/ 且/ φ/ (/ s/ )/ / 0/ ,/ 该/ 能量/ 泛函/ 是/ 全局/ 凸/ 的/ ,/ 最小/ 解/ 唯一/ 存在/ ./ 证明/ ./ 由/ 定理/ 1/ 及/ 最小/ 二乘/ 数据项/ 的/ 凸性/ 易证/ ./ 下面/ 考虑/ Euler/ -/ Lagrange/ 方程/ (/ 15/ )/ 对应/ 最速/ 下降/ 流/ 的/ 离散/ 化/ ./ 由于/ 数字图像/ 可/ 看作/ 是/ 图/ 上/ 的/ 数据/ ,/ 运用/ 图/ 的/ 数据结构/ 来/ 描述/ 数字图像/ 非常/ 自然/ [/ 24/ ,/ 26/ ]/ ./ 图/ G/ 是/ 指/ 一个/ 有序/ 的/ 三元组/ (/ Ω/ ,/ E/ ,/ / )/ ,/ 其中/ Ω/ 称为/ 结点/ 集/ (/ 非空/ )/ ,/ E/ 称为/ 边集/ ,/ / 称为/ 关联/ 函数/ ,/ 它/ 使/ G/ 的/ 每/ 条边/ 对应/ 于/ G/ 的/ 无序/ 结点/ 对/ (/ 不必/ 相异/ )/ ./ 若/ e/ ∈/ E/ ,/ / (/ e/ )/ =/ (/ α/ ,/ β/ )/ ,/ 称边/ e/ 连接/ 结点/ α/ 和/ β/ ;/ 结点/ α/ 和/ β/ 称为/ 边/ e/ 的/ 端点/ ;/ 若/ α/ =/ β/ ,/ 边/ e/ 称为/ 环/ ./ 当/ 在/ 边集/ E/ 上/ 定义/ 方向/ ,/ 此时/ 方向/ 边/ e/ 称为/ 弧/ ,/ 图/ G/ 称为/ 有向图/ ./ 当/ 在/ 有向图/ G/ 的/ 每条/ 弧/ e/ 上/ 定义/ 权/ 指标/ w/ (/ e/ )/ ,/ 则/ 称/ 有向图/ G/ 为/ 赋权/ 有向图/ ./ 用/ 赋权/ 有向图/ 结构/ 简单/ 描述/ 图像/ u/ :/ 灰度/ 图像/ u/ 定义/ 在/ 非空/ 结点/ 集/ Ω/ 上/ ,/ 每个/ 结点/ α/ 处/ 的/ 值/ 为/ u/ (/ α/ )/ ;/ 对/ 每个/ 结点/ α/ ∈/ Ω/ ,/ 可定义/ 相应/ 的/ 邻域/ 系统/ Ω/ α/ ;/ 对/ 每个/ 结点/ α/ ∈/ Ω/ ,/ 都/ 有/ 一条/ 由/ 结点/ β/ 指向/ 结点/ α/ ∈/ Ω/ 的/ 弧/ ;/ 每条/ 弧上/ 可定义/ 相应/ 的/ 权函数/ w/ α/ β/ ./ 则/ 方程/ (/ 15/ )/ 对应/ 的/ 最速/ 下降/ 流/ 可以/ 通过/ 时间/ 步进/ 法/ 进行/ 逼近/ :/ u/ (/ n/ +/ 1/ )/ (/ α/ )/ =/ u/ (/ n/ )/ (/ α/ )/ +/ Δ/ t/ ∑/ β/ ∈/ Ω/ α/ 上述/ 自/ 适应/ 加权/ 迭代/ 滤波/ 过程/ 中/ 相似/ 度/ ω/ α/ γ/ 计算/ 涉及/ g/ (/ α/ ,/ β/ )/ 函数/ 和/ 邻域/ 窗口/ 的/ 选择/ ./ 关于/ g/ (/ α/ ,/ β/ )/ 函数/ 的/ 选择/ 可以/ 非常灵活/ ,/ 仅/ 需/ 满足/ 第/ 2/ 节/ 的/ 条件/ 即可/ ,/ 按照/ 文献/ [/ 13/ ,/ 19/ ]/ 模板/ 距离/ (/ Patch/ -/ distance/ )/ 方法/ ,/ 本文/ 取/ g/ (/ α/ ,/ β/ )/ =/ 1/ 其中/ ,/ Ω/ α/ ,/ r/ =/ {/ β/ β/ -/ α/ </ r/ }/ ,/ c/ 为/ 归一化/ 参数/ ,/ h/ 为/ 相似/ 度/ 调整/ 性/ 参数/ ,/ u/ (/ B/ α/ )/ =/ {/ u/ (/ γ/ )/ :/ γ/ ∈/ B/ α/ }/ ,/ B/ α/ 为/ 像素/ α/ 处/ 的/ 邻域/ 窗口/ ./ d/ (/ u/ (/ B/ α/ )/ ,/ u/ (/ B/ β/ )/ )/ 为/ 两/ 邻域/ 模板/ 的/ 距离/ ,/ 取/ d/ (/ u/ (/ B/ α/ )/ ,/ u/ (/ B/ β/ )/ )/ =/ ∑/ Ga/ (/ t/ )/ [/ u/ (/ 犪/ +/ t/ )/ ,/ u/ (/ β/ +/ t/ )/ ]/ ,/ Ga/ 为/ 标准差/ 为/ a/ 的/ 高斯/ 核/ ./ 本文/ 实验/ 中/ 搜索/ 区域/ Ω/ α/ ,/ r/ 大小/ 为/ 11/ ×/ 11/ 的/ 邻域/ 窗口/ ,/ 而/ 距离/ 计算/ 的/ 邻域/ 模板/ 尺寸/ 为/ 5/ ×/ 5/ ./ 不妨/ 假设/ φ/ (/ s/ )/ // s/ =/ h/ (/ s/ )/ ,/ 则/ u/ (/ n/ +/ 1/ )/ (/ α/ )/ =/ u/ (/ n/ )/ (/ α/ )/ +/ Δ/ t/ ∑/ β/ ∈/ Ω/ α/ λ/ Δ/ t/ (/ R/ / u0/ (/ α/ )/ -/ R/ / Ru/ (/ n/ )/ (/ α/ )/ )/ Page8/ 分析/ 上述/ 迭代/ 格式/ 不难/ 发现/ :/ (/ 1/ )/ 滤波/ 过程/ 与/ 灰度/ 相似性/ 相关/ ,/ 当/ 邻域/ 像素/ 与/ 当前/ 像素/ 的/ 灰度/ 差/ 相差/ 很大/ 时/ ,/ 则/ 该/ 邻域/ 像素/ 对/ 当前/ 像素/ 的/ 贡献/ 要/ 小/ ;/ 相反/ ,/ 当/ 邻域/ 像素/ 与/ 当前/ 像素/ 的/ 灰度/ 差/ 相差/ 很/ 小时/ ,/ 则/ 该/ 邻域/ 像素/ 对/ 当前/ 像素/ 的/ 贡献/ 要/ 大/ ./ (/ 2/ )/ 类似/ 的/ 滤波/ 过程/ 与/ 几何/ 相似性/ 相关/ ./ 因此/ 这种/ 滤波/ 过程/ 同时/ 很/ 好/ 地/ 继承/ 了/ 双边/ 滤波/ 机制/ ./ 表/ 1/ 实验/ 中/ 采用/ 的/ 局部/ 和/ 非/ 局部/ 模型/ φ/ (/ s/ )/ =/ s2/ φ/ (/ s/ )/ =/ |/ s/ |/ φ/ (/ s/ )/ =/ s2/ // 2/ ,/ s/ / k/ φ/ (/ s/ )/ =/ |/ s/ |/ ln/ |/ s/ |/ ,/ |/ s/ |/ / 1/ φ/ (/ s/ )/ =/ |/ s/ |/ ,/ 局部/ 模型/ [/ 12/ ]/ :/ u/ ^/ =/ argminuE/ (/ u/ )/ =/ ∫/ Ω/ u/ / =/ argminu/ ∫/ Ω/ ∫/ Ω/ 非/ 局部/ 模型/ :/ 为了/ 定量分析/ 局部/ 正则/ 化/ 模型/ 和/ 本文/ 提出/ 非/ 局部/ 模型/ 的/ 图象/ 超/ 分辨/ 重建/ 效果/ ,/ 本文/ 以/ 峰值/ 信噪比/ 图/ 3/ 图/ 4/ 给出/ 了/ “/ 人工/ 图像/ ”/ 超/ 分辨率/ 重建/ 结果/ ./ 图/ 5/ 给出/ 了/ 不同/ 局部/ 模型/ 和/ 不同/ 非/ 局部/ 模型/ 重建/ 算法/ 的/ PSNR/ 曲线/ ./ 可以/ 看出/ ,/ 两类/ 正则/ 化/ 模型/ 都/ 能/ 取得/ 较/ 好/ 的/ 超/ 分辨率/ 效果/ ,/ 而且/ 具有/ 较/ 好/ 的/ 收敛性/ ./ 相/ 比较而言/ ,/ 在/ 迭代/ 基本/ 稳定/ 时/ ,/ 非/ 局部/ 模型/ 大体上/ 比/ 局部/ 模型/ 提高/ 峰值/ 信噪比/ 0.5/ ~/ 1dB/ 左右/ ./ 由于/ Tikhonov/ 模型/ 不/ 具备/ 各向异性/ 机制/ ,/ PSNR/ 的/ 提高/ 4/ 实验/ 结果/ 与/ 性能/ 分析/ 下面/ ,/ 给/ 本文/ 实验/ 中/ 选择/ 文献/ [/ 12/ ]/ 中/ 局部/ 模型/ 的/ 若干/ 位势/ 函数/ ,/ 表/ 1/ 中/ 第/ 1/ 列/ 列出/ 了/ 函数/ 形式/ ./ 为了/ 很/ 好/ 地区/ 分/ 局部/ 模型/ 和/ 本文/ 提出/ 的/ 非/ 局部/ 模型/ ,/ 本文/ 将/ 其/ 分别/ 给出/ 如表中/ 第/ 3/ 列/ 和/ 第/ 4/ 列/ 的/ 称谓/ ./ (/ PSNR/ )/ 作为/ 度量/ 指标/ ,/ 定义/ 为/ PSNR/ =/ 10log10/ 第/ 1/ 组/ 仿真/ 实验/ ./ 采用/ 人工/ 图像/ 为/ 测试/ 图像/ (/ 图/ 3/ (/ a/ )/ )/ ,/ 大小/ 为/ 512/ ×/ 512/ ,/ 取/ 方差/ 为/ 1/ ,/ 3/ ×/ 3/ 窗口/ 大小/ 的/ 高斯/ 核/ 模糊/ ,/ 降/ 采样/ 因子/ 为/ 4/ ,/ 并/ 加入/ 均值/ 0/ 标准差/ 为/ 8/ 的/ 高斯/ 白/ 噪声/ ,/ 图/ 3/ (/ b/ )/ 为/ 降质/ 后/ 生成/ 的/ LR/ 图像/ ./ 图/ 3/ (/ c/ )/ 为/ 利用/ 双线性/ 法/ 插值/ 图像/ ,/ PSNR/ 为/ 23.62/ dB/ ./ 幅度/ 最低/ ,/ 而且/ 模糊/ 效应/ 明显/ ,/ 而/ 具备/ 各向异性/ 机制/ 的/ TV/ 、/ Huber/ 、/ Entropy/ 和/ MEntropy/ 的/ PSNR/ 提高/ 幅度/ 依次/ 递增/ ,/ 说明/ 不同/ 的/ 图像/ 正则/ 化/ 模型/ 影响/ 图像/ 重建/ 效果/ ./ 另外/ Huber/ 、/ Entropy/ 和/ Mentropy/ 的/ 势函数/ 实际上/ 都/ 包含/ TV/ 势函数/ ,/ 是/ 介于/ 一次/ 线性/ 和/ 二次/ 非线性/ 函数/ 之间/ 的/ 一种/ 分段/ 耦合/ 函数/ ,/ 因此/ 图像/ 被/ 建模/ 为/ 包含/ 边缘/ 曲线/ 的/ 分片/ 平坦/ 区域/ 组/ Page9/ 成/ ,/ 能够/ 较/ 好/ 地/ 自/ 适应/ 于/ 图像/ 的/ 结构/ 特性/ ./ 第/ 2/ 组/ 仿真/ 实验/ ./ 对/ “/ Lena/ ”/ ,/ “/ Girl/ ”/ ,/ “/ Woman/ ”/ 和/ “/ 航空/ 图像/ ”/ 等/ 具有/ 不同/ 结构/ 细节/ 的/ 灰度/ 图像/ 进行/ 处理/ ./ 实验/ 中/ 低分辨率/ 图像/ 由/ 大小/ 为/ 512/ ×/ 512/ 理想/ 图像/ 经过/ 取/ 方差/ 为/ 1/ ,/ 3/ ×/ 3/ 窗口/ 大小/ 的/ 高斯/ 核/ 模糊/ ,/ 4/ 倍/ 降/ 采样/ ,/ 并/ 加入/ 均值/ 0/ 、/ 标准差/ 为/ 6/ 的/ 高斯/ 白/ 噪声/ 等/ 降质/ 后/ 生成/ ./ 由于/ 非/ 局部/ Huber/ 、/ 非/ 局部/ Entropy/ 和/ 非/ 局部/ MEntropy/ 的/ PSNR/ 提高/ 幅度/ 依次/ 递增/ 但/ 相差/ 幅度/ 小于/ 0.3/ dB/ ,/ 视觉/ 上/ 相差无几/ ./ 整体/ 来看/ ,/ 非/ 局部/ MEntropy/ 模型/ 是/ 最佳/ 的/ 模型/ ./ 限于/ 篇幅/ ,/ 以非/ 局部/ MEntropy/ 为例/ ,/ 给出/ 仿真/ 实验/ 中/ 部分/ 实验/ 结果/ ./ 图/ 6/ 中/ 利用/ 双/ 线性插值/ LR/ 图像/ 的/ 结果/ 图像/ (/ b1/ )/ ~/ (/ b4/ )/ 的/ PSNR/ 值/ 分别/ 是/ 24.6/ 、/ 24.5/ 、/ 24.4/ 、/ 23.9/ ;/ 非/ 局部/ MEntropy/ 模型/ 的/ 超/ 分辨率/ 重建/ 图像/ (/ c1/ )/ ~/ (/ c4/ )/ 的/ PSNR/ 值/ 分别/ 是/ 27.84/ 、/ 27.95/ 、/ 28.01/ 、/ 27.79/ ./ 在/ 视觉/ 上/ 看/ ,/ 重建/ 图像/ 基本/ 去/ 除了/ 马赛克/ 或/ 边缘/ 锯齿/ 效应/ ,/ 噪声/ 得到/ 了/ 较/ 好/ 抑制/ ./ 上述/ 实验/ 证明/ 了/ 非/ 局部/ 正则/ 化/ 方法/ 具有/ 很/ 好/ 的/ 分辨率/ 增强/ 效果/ ./ Page10/ 图/ 6/ “/ 自然/ 图像/ ”/ 超/ 分辨率/ 重建/ 结果/ 5/ 结语/ 针对/ 图像/ 超/ 分辨率/ 复原/ 问题/ 的/ 不适/ 定性/ ,/ 本文/ 提出/ 非/ 局部/ 正则/ 化/ 能量/ 泛函/ 和/ 相应/ 的/ 变分/ 框架/ ./ 文中/ 考察/ 了/ 一类/ 满足/ 一定/ 正则/ 性/ 、/ 凸性/ 和/ 边缘/ 保持/ 条件/ 的/ 非/ 局部/ 正则/ 化泛/ 函/ 的/ 最速/ 下降/ 流/ 和/ 相应/ 变分/ 模型/ 的/ 若干/ 性质/ ./ 基于/ 谱/ 图/ 理论/ ,/ 建立/ 了/ 该/ 连续/ 变分/ 模型/ 的/ 离散/ 模型/ 以及/ 自/ 适应/ 加权/ 数字滤波/ 算法/ ./ 通过/ 与/ 取/ 相同/ 势函数/ 的/ 经典/ 变分/ 模型/ :/ Tikhonov/ 模型/ 、/ TV/ 模型/ 、/ Huber/ 模型/ 、/ Entropy/ 模型/ 和/ MEntropy/ 模型/ 进行/ 比较/ 研究/ ,/ 实验/ 证明/ 了/ 非/ 局部/ 正则/ 化/ 方法/ 通常/ 能够/ 更好/ 地/ 去除/ 图像/ 的/ 马赛克/ 或/ 边缘/ 锯齿/ 效应/ ,/ 对/ 噪声/ 的/ 抑制/ 也/ 更为/ 稳健/ ,/ 因此/ 更加/ 适合/ 图像/ 的/ 分辨率/ 增强/ 处理/ ./ 由于/ 文中/ 模型/ 是/ 基于/ 加权/ 差分/ 的/ 非/ 局部/ 能量/ 泛函/ ,/ 能够/ 方便/ 地/ 利用/ 加权/ 图来/ 描述/ ,/ 因此/ 下/ 一步/ 的/ 工作/ 是/ 考虑/ 更/ 一般/ 的/ 加权/ 图/ 框架/ 下/ 的/ 非/ 局部/ 离散/ 正则/ 化/ ,/ 并/ 进一步/ 推广/ 到/ 彩色图像/ 、/ 流形/ 或/ 更/ 高维/ 数据/ 的/ 处理/ ./ 同时/ ,/ 从/ Mumford/ 和/ Shah/ 提出/ 的/ M/ -/ S/ 模型/ 来看/ ,/ 模型/ 中/ 可以/ 进一步/ 考虑/ 包含/ 长度/ Page11/ 项/ 控制/ [/ 27/ -/ 28/ ]/ ,/ 因此/ 非/ 局部/ 方法/ 同样/ 可以/ 推广/ 到/ 一类/ 主动/ 轮廓线/ 模型/ ,/ 有望/ 在/ 图像/ 分割/ 、/ 目标/ 跟踪/ 等/ 获得/ 更好/ 的/ 实际/ 应用/ ./ 

