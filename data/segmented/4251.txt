Page1/ 基于/ CEGAR/ 的/ Web/ 应用/ 验证/ 高洪皓/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 缪淮扣/ 1/ )/ ,/ 3/ )/ 曾红卫/ 1/ )/ 1/ )/ (/ 上海大学/ 计算机/ 工程/ 与/ 科学/ 学院/ 上海/ 200444/ )/ 2/ )/ (/ 上海大学/ 计算中心/ 上海/ 200444/ )/ 3/ )/ (/ 上海市/ 计算机软件/ 评测/ 重点/ 实验室/ 上海/ 201114/ )/ 摘要/ Web/ 应用/ 导航/ 行为/ 的/ 建模/ 和/ 验证/ 是/ 可信/ Web/ 工程/ 研究/ 的/ 重点/ 和/ 难点/ ./ 在/ 深入分析/ 用户/ 和/ Web/ 浏览器/ 交互/ 行为/ 的/ 基础/ 上/ ,/ 文中/ 引入/ On/ -/ the/ -/ fly/ 策略/ 并/ 基于/ 反例/ 引导/ 的/ 抽象/ 精化/ 验证/ 方法/ CEGAR/ 对/ Web/ 应用/ 的/ 导航/ 行为/ 进行/ 建模/ 和/ 验证/ ./ 在/ On/ -/ the/ -/ fly/ 导航/ 模型/ 展开/ 的/ 过程/ 中/ ,/ 根据/ 检验/ 性质/ 采用/ 增量/ 式/ 状态/ 抽象/ 方法/ 构造/ Web/ 应用/ 导航/ 抽象/ 模型/ ,/ 通过/ 确认/ 抽象/ 反例/ 来/ 识别/ 伪/ 反例/ ,/ 借助/ 等价/ 类/ 精化/ 方法/ 消除/ 抽象/ 模型/ 上/ 的/ 伪/ 反例/ ./ 这一/ 方法/ 可/ 有效/ 地/ 缓解/ Web/ 应用/ 验证/ 过程/ 中/ 出现/ 的/ 状态/ 爆炸/ 问题/ ./ 关键词/ Web/ 应用/ ;/ 导航/ 模型/ ;/ 抽象/ 精化/ ;/ 模型/ 检验/ ;/ 伪/ 反例/ 1/ 引言/ 开展业务/ 逐渐/ 成为/ 电子商务/ 的/ 主流/ 趋势/ ./ 越来越/ 多/ 的/ 企业/ 、/ 单位/ 、/ 甚至/ 个人/ 都/ 纷纷/ 开始/ 部署/ Web/ 应用程序/ 和/ 云/ 计算/ 平台/ ,/ 以/ 实现/ 实时/ 双向/ 的/ 商业/ 合作/ 和/ 互联网/ 的/ 快速/ 发展/ 使得/ 通过/ Web/ 求解/ 问题/ 和/ 信息沟通/ ./ 然而/ ,/ 异构/ 性/ 、/ 动态性/ 、/ 连接/ 多样性/ 以及/ 控/ Page2/ 制流/ 可变性/ 等/ 特点/ ,/ 对/ Web/ 应用/ 的/ 设计/ 、/ 实现/ 、/ 维护/ 和/ 管理/ 提出/ 了/ 新/ 的/ 挑战/ ./ 部署/ 于/ 网络/ 中/ 的/ Web/ 应用/ 是否/ 正确/ 实现/ 了/ 业务/ 逻辑/ ,/ 是否/ 存在/ 安全隐患/ ,/ 需要/ 对/ 其/ 进行/ 必要/ 的/ 测试/ ./ Web/ 应用/ 的/ 验证/ 作为/ 测试/ 的/ 一种/ 辅助/ 手段/ ,/ 不仅/ 可以/ 检验/ Web/ 应用/ 的/ 安全性/ ,/ 而且/ 还/ 可以/ 给出/ Bug/ 缺陷/ 所/ 存在/ 的/ 位置/ ./ Web/ 导航/ 模型/ 作为/ Web/ 应用/ 验证/ 的/ 重要/ 模型/ 已经/ 得到/ 了/ 学术界/ 和/ 工业界/ 的/ 广泛/ 认同/ ,/ 其为/ Web/ 页面/ 间/ 的/ 业务/ 逻辑关系/ 建立/ 适合/ 于/ 检验/ 的/ 形式化/ 模型/ ./ 用户/ 与/ Web/ 应用/ 直接/ 进行/ 交互/ ,/ 使得/ Web/ 应用/ 成为/ 网络软件/ 最/ 直接/ 的/ 表现形式/ ./ 然而/ ,/ 一方面/ ,/ 用户/ 不仅/ 可以/ 在/ 浏览器/ 地址栏/ 上/ 输入/ URL/ 直接/ 访问/ 页面/ ,/ 而且/ 可以/ 直接/ 点击/ 网页/ 上/ 的/ 超链接/ 随机/ 地/ 访问/ 动态/ Web/ 页面/ ./ 由于/ 用户/ 交互/ 行为/ 的/ 不确定性/ ,/ 导致/ 设计阶段/ 的/ 静态/ 需求/ 分析方法/ 无法/ 对/ 这/ 一/ 动态/ 行为/ 进行/ 检验/ ./ 另一方面/ ,/ 在/ Cache/ 和/ Session/ 作用/ 下/ ,/ 用户/ 还/ 可以/ 与/ 浏览器/ 按钮/ 进行/ 交互/ ,/ 包括/ 前进/ 和/ 后退/ 等/ 按钮/ ,/ 访问/ 先前/ 已/ 浏览/ 的/ 页面/ ./ 如果/ Web/ 应用/ 导航/ 行为/ 的/ 业务/ 逻辑/ 存在/ 安全性/ 缺陷/ ,/ 这些/ 动作/ 将/ 影响/ Web/ 应用/ 的/ 整体/ 导航/ 功能/ 和/ 性能/ ,/ 尤其/ 是/ 私密/ 数据/ 在/ 用户/ 消极/ 地/ 点击/ 浏览器/ 按钮/ 时/ 可能/ 遭到/ 破坏/ ./ 考虑/ 上述/ 两/ 方面/ 问题/ ,/ 需要/ 对/ Web/ 应用/ 的/ 导航/ 行为/ 进行/ 动态/ 建模/ 以/ 实现/ 携带/ 私密/ 数据/ 页面/ 的/ 安全性/ 验证/ ./ 因此/ ,/ 作为/ Web/ 应用/ 研究/ 的/ 重点/ 和/ 难点/ ,/ 对/ Web/ 应用/ 导航/ 行为/ 进行/ 形式化/ 建模/ 和/ 验证/ 成为/ Web/ 工程/ 亟待解决/ 的/ 实际/ 问题/ ./ 目前/ ,/ 基于/ 模型/ 检验/ (/ ModelChecking/ )/ [/ 1/ ]/ 方法/ 的/ Web/ 应用/ 建模/ 和/ 验证/ 技术/ ,/ 吸引/ 了/ 国内外/ 众多/ 学者/ 对/ 其/ 展开/ 深入研究/ ,/ 并/ 取得/ 了/ 一些/ 初步/ 的/ 研究成果/ [/ 2/ -/ 5/ ]/ ./ Haydar/ 等/ 人/ [/ 2/ ]/ 用/ 通信/ 状态机/ 为/ Web/ 应用/ 建模/ ,/ 提出/ 了/ 一种/ 从/ 浏览器/ 会话/ 记录/ 自动/ 产生/ 通信/ 状态机/ 的/ 方法/ ,/ 该/ 模型/ 可/ 用于/ Web/ 应用/ 的/ 性质/ 验证/ 和/ 回归/ 测试/ ./ Donini/ 等/ 人/ [/ 3/ ]/ 使用/ Web/ 应用/ 图/ WAG/ (/ WebApplicationGraph/ )/ 对/ 窗体/ 、/ 网页/ 以及/ 网页/ 中/ 的/ 链接/ 和/ 动作/ 进行/ 形式/ 建模/ 以/ 支持/ Web/ 应用/ 验证/ ./ Han/ 等/ 人/ [/ 4/ ]/ 研究/ Web/ 应用/ 自/ 适应/ 导航/ 行为/ ,/ 采用/ UML/ 状态图/ 对/ 自/ 适应/ 导航/ 进行/ 建模/ 并/ 手工/ 进行/ 验证/ ./ 然而/ ,/ 这/ 类/ 方法/ 也/ 有/ 其/ 不足/ 的/ 一面/ ./ 随着/ 系统/ 规模/ 的/ 不断/ 增大/ ,/ 刻画/ Web/ 应用/ 导航/ 行为/ 的/ 模型/ 状态/ 及其/ 迁移/ 关系/ 将/ 呈现/ 指数/ 级/ 增长/ ,/ 尤其/ 是/ 针对/ 并发/ Web/ 应用/ 场景/ 时/ 更/ 容易/ 出现/ 状态/ 空间/ 爆炸/ 问题/ [/ 6/ ]/ ,/ 其/ 计算/ 、/ 验证/ 和/ 判定/ 的/ 复杂度/ 也/ 随之/ 增加/ ./ 而/ 实际上/ ,/ 针对/ Bug/ 缺陷/ 而言/ ,/ 其/ 往往/ 存在/ 于/ 模型/ 的/ 某/ 一较/ 小/ 范围/ 内/ ./ 检验/ 性质/ 在/ 建立/ 完整/ 模型/ 之后/ 执行/ ,/ 不仅/ 需要/ 占用/ 大量/ 的/ 状态/ 存储空间/ ,/ 而且/ 需要/ 花费/ 大量/ 的/ 搜索/ 时间/ 用于/ 性质/ 的/ 可/ 满足/ 性/ 判断/ ./ 因此/ ,/ 如何/ 对模型/ 进行/ 抽象/ 精化/ 验证/ 已/ 引起/ 学术界/ 和/ 工业界/ 的/ 共同/ 关注/ ./ Bryant/ 等/ 人/ [/ 7/ ]/ 提出/ 基于/ 状态/ 约/ 减/ 的/ 有序/ 二叉/ 决策/ 图/ (/ OrderedBinaryDecisionDiagrams/ ,/ OBDD/ )/ 方法/ 能/ 将/ 与/ 要/ 验证/ 的/ 性质/ 无关/ 的/ 状态/ 进行/ 合并/ 从而/ 构造/ 简化/ 的/ 等价/ 模型/ ./ Alur/ 等/ 人/ [/ 8/ ]/ 提出/ 基于/ 迹/ (/ trace/ )/ 状态/ 约/ 减/ 技术/ 的/ 偏序/ 规约/ (/ PartialOrderReductions/ ,/ POR/ )/ 方法/ ,/ 通过/ 固定/ 某些/ 状态/ 的/ 次序/ ,/ 使/ 检验/ 只/ 针对/ 所有/ 可能/ 执行/ 路径/ 集合/ 中/ 的/ 一个/ 子集/ ./ Berezin/ 等/ 人/ [/ 9/ -/ 10/ ]/ 提出/ 组合/ 推理/ (/ CompositionalReasoning/ ,/ CR/ )/ 方法/ ,/ 利用/ 系统/ 的/ 组合/ 结构/ 对/ 问题/ 进行/ 分解/ ,/ 通过/ 检验/ 各子/ 模型/ 的/ 性质/ 来/ 综合/ 推导/ 出/ 整体/ 模型/ 的/ 性质/ ./ Clarke/ 等/ 人/ [/ 11/ -/ 12/ ]/ 提出/ 抽象/ 精化/ 技术/ (/ AbstractionRefinementTech/ -/ niques/ )/ ,/ 包括/ 存在/ 性/ 抽象/ 和/ 一致性/ 抽象/ 方法/ ./ 其中/ ,/ 抽象/ (/ Abstraction/ )/ 被/ 认为/ 是/ 处理/ 状态/ 爆炸/ 问题/ 最/ 便捷/ 的/ 方法/ ,/ 但/ 该/ 方法/ 常会/ 引入/ 具体/ 模型/ 中/ 不/ 存在/ 的/ 附加/ 行为/ ,/ 不能/ 说明/ 系统/ 违背/ 性质/ ,/ 这样/ 的/ 反例/ 称为/ 伪/ 反例/ (/ SpuriousCounterexample/ )/ ./ 因此/ ,/ 需要/ 确认/ 反例/ 的/ 有效性/ 并/ 消除/ 伪/ 反例/ ./ 于是/ ,/ 基于/ 精化/ (/ Refinement/ )/ [/ 13/ ]/ 的/ 扩展/ 技术/ 被/ 提出/ 用于/ 处理/ 伪/ 反例/ ./ 它/ 是/ 一种/ 等价/ 状态/ 划分/ 方法/ ,/ 将/ 一个/ 失效/ 状态/ (/ 引起/ 伪/ 反例/ 的/ 具体/ 状态/ 集合/ )/ 分割/ 为/ 多个/ 抽象/ 状态/ ,/ 从而/ 消除/ 抽象/ 模型/ 中/ 的/ 伪反/ 例行/ 为/ ./ Chen/ 等/ 人/ [/ 14/ ]/ 采用/ On/ -/ the/ -/ fly/ 方法/ 对/ Web/ 应用/ 导航/ 建模/ ,/ 重点/ 研究/ 基于/ 浏览器/ 交互/ 覆盖/ 准则/ 产生/ 性质/ 并/ 进行/ 验证/ 的/ 方法/ ./ 这种/ 方法/ 的/ 优点/ 是/ 一旦/ 验证/ 算法/ 找到/ 一个/ 反例/ ,/ 算法/ 即可/ 终止/ ,/ 而/ 不必/ 生成/ 剩余/ 的/ 状态/ 空间/ ./ On/ -/ the/ -/ fly/ 技术/ [/ 5/ ]/ 是/ 一种/ 局部/ 模型/ 检验/ 技术/ ,/ 在/ 构造/ 系统/ 全局/ 模型/ 的/ 过程/ 中/ 检验/ 性质/ 的/ 可/ 满足/ 性/ ,/ 根据/ 所/ 要/ 验证/ 性质/ 的/ 需要/ 逐步/ 展开/ 系统/ 所/ 包含/ 的/ 状态/ ,/ 不/ 需要/ 事先/ 构造/ 完整/ 的/ 系统/ 状态/ 空间/ ./ 上述/ 方法/ 都/ 可以/ 很/ 好地解决/ 内存不足/ 和/ 状态/ 爆炸/ 等/ 问题/ ./ 然而/ 目前/ 关于/ 抽象/ 验证/ 方法/ 在/ Web/ 应用/ 上/ 的/ 研究/ 不多/ ./ Web/ 应用/ 的/ 功能/ 越/ 复杂/ ,/ 导航/ 模型/ 将/ 越/ 庞大/ ./ 为了/ 应对/ Web/ 应用/ 验证/ 中/ 的/ 状态/ 爆炸/ 问题/ ,/ 提高/ 建模/ 和/ 验证/ 的/ 效率/ ,/ 本文/ 结合/ On/ -/ the/ -/ fly/ 方法/ 对/ Web/ 应用/ 导航/ 模型/ 进行/ 建模/ ,/ 改进/ 基于/ 反例/ 引导/ 的/ 抽象/ 精化/ 框架/ (/ Counterexample/ -/ GuidedAbstractionRefinement/ ,/ CEGAR/ )/ [/ 13/ ]/ 以/ 适用/ 于/ Web/ 应用/ 导航/ Page3/ 模型/ 的/ 安全性/ 验证/ ,/ 称为/ 基于/ On/ -/ the/ -/ fly/ 导航/ 模型/ 反例/ 引导/ 的/ 抽象/ 精化/ (/ OTF/ -/ MC/ -/ CEGAR/ )/ 框架/ ./ 基于/ 该/ 框架/ 的/ 验证/ 方法/ 是/ 一个/ “/ 抽象/ -/ 检验/ -/ 精化/ ”/ 的/ 循环/ 过程/ ./ 具体步骤/ 如下/ :/ 根据/ Web/ 应用/ 页面/ 状态/ 之间/ 的/ 导航/ 关系/ 动态/ 构造/ On/ -/ the/ -/ fly/ 导航/ 模型/ ,/ 同时/ 采用/ 等价/ 类/ 抽象/ 方法/ 抽象/ 模型/ ,/ 避免/ 对/ 无关/ 状态/ 进行/ (/ 重复/ )/ 计算/ ./ 在/ 抽象/ 模型/ 上/ 检验/ 给定/ 的/ 性质/ ./ 如果/ 性质/ 不/ 满足/ ,/ 在/ 具体/ 模型/ 上/ 检验/ 抽象/ 反例/ 路径/ 并/ 确认/ 反例/ 的/ 有效性/ ./ 当/ 确认/ 抽象/ 反例/ 是/ 伪/ 反例/ 时/ ,/ 对/ 抽象/ 模型/ 进行/ 精化/ 以/ 消除/ 伪/ 反例/ ./ 如果/ 性质/ 得到/ 满足/ ,/ 根据/ 用户/ 与/ Web/ 应用/ 的/ 交互/ 行为/ 逐渐/ 展开/ 的/ 导航/ 关系/ 上/ 的/ 增量/ 状态/ ,/ 采用/ 增量/ 式/ 状态/ 抽象/ 策略/ 对/ 状态/ 进行/ 抽象/ 并/ 在/ 抽象/ 模型/ 上/ 再次/ 检验/ 性质/ ./ 一直/ 执行/ 这一/ 迭代/ 过程/ 直至/ 完整/ 的/ Web/ 应用/ 导航/ 行为/ 的/ 抽象/ 模型/ 建立/ 完毕/ 并/ 得到/ 检验/ ./ 因此/ ,/ 本文/ Web/ 应用/ 验证/ 方法/ 不再/ 需要/ 为/ Web/ 应用/ 导航/ 行为/ 建立/ 全局/ 的/ 具体/ 状态/ 空间/ ,/ 通过/ 反例/ 确认/ 过程/ 识别/ 伪/ 反例/ ,/ 可以/ 提高/ Web/ 应用/ 验证/ 的/ 有效性/ ,/ 对/ Web/ 应用/ 的/ 验证/ 具有/ 决定性/ 的/ 指导作用/ ./ 本文/ 第/ 2/ 节/ 介绍/ Web/ 应用/ 的/ On/ -/ the/ -/ fly/ 导航/ 模型/ 建模/ 方法/ ;/ 第/ 3/ 节/ 提出/ 基于/ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 抽象/ 精化/ 验证/ 方法/ ;/ 第/ 4/ 节/ 通过/ 对比/ 实验/ 证明/ 本文/ 方法/ 的/ 有效性/ ;/ 最后/ 是/ 本文/ 的/ 相关/ 工作/ 与/ 总结/ 展望/ ,/ 并/ 指出/ 今后/ 的/ 研究/ 方向/ ./ 2Web/ 应用/ 导航/ 模型/ 建模/ 本文/ 考虑/ 的/ Web/ 应用/ 的/ 导航/ 行为/ 不仅/ 与/ Web/ 页面/ 之间/ 的/ 导航/ 关系/ 相关/ 而且/ 还/ 与/ Web/ 浏览器/ 的/ 按钮/ 交互/ 行为/ 有关/ ./ 用户/ 通过/ Web/ 浏览器/ 提供/ 的/ 按钮/ (/ Forward/ 、/ Back/ 、/ Refresh/ 、/ Favorites/ 等/ )/ ,/ 可/ 随时/ 改变/ 或/ 中断/ Web/ 应用/ 的/ 流程/ ,/ 影响/ Web/ 应用/ 的/ 安全性/ ./ 针对/ Back/ 和/ Forward/ 按钮/ 状态/ ,/ 文献/ [/ 15/ -/ 16/ ]/ 基于/ 可/ 缓存/ 机制/ Cache/ 和/ Session/ 将/ Web/ 页面/ 分为/ 4/ 种/ 状态/ :/ (/ 1/ )/ BDFD/ ,/ 即/ Back/ 和/ Forward/ 都/ 是非/ 使能/ 的/ ;/ (/ 2/ )/ BDFE/ ,/ 即/ Back/ 是非/ 使能/ 的/ ,/ Forward/ 是/ 使/ 能/ 的/ ;/ (/ 3/ )/ BEFD/ ,/ 即/ Back/ 是/ 使/ 能/ 的/ ,/ Forward/ 是非/ 使能/ 的/ ;/ (/ 4/ )/ BEFE/ ,/ 即/ Back/ 和/ Forward/ 都/ 是/ 使/ 能/ 的/ ./ Web/ 应用/ 的/ 每个/ 页面/ 根据/ 浏览器/ 动作/ 派生/ 不同/ 的/ 状态/ ,/ 通过/ 组合/ 这些/ 页面/ 间/ 的/ 导航/ 行为/ ,/ 可以/ 构造/ 出/ Web/ 应用/ 的/ 导航/ 模型/ ./ 然而/ ,/ 如果/ 能/ 在/ 模型/ 的/ 小/ 范围/ 内/ 就/ 能/ 发现/ 并/ 返回/ Bug/ 缺陷/ ,/ 那么/ 构造/ 完整/ 的/ Web/ 应用/ 导航/ 模型/ 将/ 是/ 浪费/ 的/ ./ 另一方面/ ,/ 由于/ 每个/ 页面/ 存在/ 前进/ 和/ 后退/ 状态/ ,/ 当/ 参与/ 的/ 页面/ 越多时/ ,/ 导航/ 行为/ 的/ 交互/ 越/ 复杂/ ,/ 建立/ Web/ 应用/ 导航/ 模型/ 的/ 难度/ 越大/ ./ 基于/ 此/ ,/ 为了/ 实现/ 根据/ 所/ 要/ 验证/ 性质/ 的/ 需要/ 逐步/ 展开/ Web/ 应用/ 系统/ 所/ 包含/ 的/ 状态/ 并/ 检验/ 安全性/ ,/ 本文/ 给出/ 了/ 适合/ 于边/ 建模/ 边/ 验证/ 的/ Web/ 应用/ 导航/ 模型/ ./ 定义/ 1/ ./ Web/ 应用/ 导航/ 模型/ ./ Web/ 应用/ 的/ On/ -/ the/ -/ fly/ 导航/ 模型/ [/ 5/ ]/ 是/ 一个/ 扩展/ 的/ Kripke/ 结构/ M/ =/ (/ S/ ,/ I/ ,/ AP/ ,/ L/ ,/ T/ )/ ,/ 其中/ ,/ (/ 1/ )/ S/ 是/ 有限/ 的/ 状态/ 集/ ,/ 表示/ 逐渐/ 展开/ 过程/ 中/ 的/ 状态/ 空间/ ./ 每/ 一个/ 状态/ 由/ 呈现/ 给/ 用户/ 的/ Web/ 页面/ 以及/ 加载/ 该/ Web/ 页/ 浏览器/ 的/ 按钮/ 状态/ 构成/ ./ 题集/ ./ (/ 2/ )/ I/ / S/ 是/ 初始状态/ 集/ ./ (/ 3/ )/ AP/ 是/ 标记/ 网页/ 和/ 动作/ action/ 的/ 原子/ 命/ (/ 4/ )/ T/ / S/ ×/ S/ 是/ 迁移/ 关系/ 集/ ./ (/ 5/ )/ L/ :/ S/ →/ 2AP/ 是/ 状态/ 标记/ 函数/ ,/ L/ (/ s/ )/ 表示/ 状态/ s/ 下/ 所有/ 为/ 真的/ 原子/ 命题/ 集/ ./ 在/ 状态/ 集/ S/ 中/ ,/ 用/ 状态/ P/ (/ XY/ )/ 为/ 每个/ 网页/ 以及/ 加载/ 该/ 网页/ 的/ 浏览器/ 动作/ 进行/ 标记/ ,/ 其中/ X/ 、/ Y/ 分别/ 代表/ 浏览器/ 的/ 按钮/ Back/ 、/ Forward/ 状态/ ./ 令/ 00/ 代表/ BDFD/ ,/ 10/ 代表/ BEFD/ ,/ 01/ 代表/ BDFE/ ,/ 11/ 代表/ BEFE/ ./ 状态/ 间/ 迁移/ 动作/ action/ 由/ Web/ 浏览器/ 的/ 链接/ 和/ 按钮/ 行为/ 决定/ ./ 考虑/ 到/ 登入/ 和/ 登出/ 操作/ 权限/ ,/ 动作/ 主要/ 包括/ link/ 、/ login/ 、/ logout/ 、/ back/ 和/ forward/ 等/ ./ 状态/ 标记/ 函数/ L/ (/ P/ (/ XY/ )/ )/ 表示/ Web/ 页面/ 和/ 浏览器/ 按钮/ 状态/ 所/ 组成/ 的/ 命题/ 公式/ ,/ 例如/ L/ (/ P1/ (/ 10/ )/ )/ =/ P1/ ∧/ back/ ∧/ / forward/ 表示/ 在/ P1/ 页面/ 上/ 可以/ 点击/ Back/ 按钮/ 后退/ ,/ 但/ 不/ 允许/ 点击/ Forward/ 按钮/ 前进/ ./ 此时/ 如果/ 导航/ 行为/ 模型/ 上/ 存在/ Forward/ 动作/ 使得/ 状态/ P1/ (/ 10/ )/ 可/ 转移/ ,/ 那么/ 该/ 导航/ 行为/ 是/ 不/ 正确/ 的/ ,/ 但/ P1/ (/ 10/ )/ 页面/ 允许/ 通过/ 超链接/ link/ 动作/ 进行/ 页面/ 导航/ ./ 实例/ 说明/ :/ 只有/ 授权/ 用户/ 才能/ 访问/ 私密/ 网页/ 集合/ 组成/ 的/ 安全/ 敏感区/ (/ SafetyCriticalRegion/ ,/ SCR/ )/ ./ 如图/ 1/ (/ a/ )/ 所示/ ,/ 是/ 一个/ 审计/ 管理系统/ 实例/ ./ 用户/ 通过/ 页面/ P2/ 登入/ SCR/ 区域/ ,/ 即/ 虚/ 线框/ 表示/ 部分/ {/ P3/ ,/ P4/ ,/ P5/ ,/ P7/ }/ ./ 在/ SCR/ 内/ 允许/ 用户/ 通过/ 浏览器/ 的/ Forward/ 和/ Back/ 按钮/ 浏览/ 和/ 操作/ Web/ 页面/ ./ 当/ 退出/ SCR/ 时/ ,/ 从/ 缓存/ 队列/ 中/ 删除/ 已/ 缓存/ 的/ 私密/ Web/ 页面/ ./ 此时/ ,/ 安全/ 性质/ 描述/ 为/ 不/ 允许/ 用户/ 通过/ 点击/ 浏览器/ Back/ 或/ Forward/ 按钮/ 再次/ 从/ 公共/ 网页/ 直接/ 访问/ SCR/ 区内/ 的/ 页面/ ./ 例如/ 点击/ Back/ 按钮/ 从/ 页面/ P6/ 直接/ 回到/ 页面/ P5/ 将/ 是/ 一个/ 错误/ 的/ 导航/ 行为/ ./ Page4/ 图/ 1Web/ 应用/ 的/ On/ -/ the/ -/ fly/ 导航/ 模型/ 构造/ 过程/ 由于/ 不需/ 预先/ 构造/ 完整/ 的/ 导航/ 模型/ ,/ 每个/ On/ -/ the/ -/ fly/ 导航/ 模型/ 记录/ 了/ Web/ 应用/ 在/ 用户/ 参与/ 交互/ 下/ 逐渐/ 展开/ 的/ 业务/ 逻辑/ 行为/ ./ 例如/ ,/ 应用/ Web/ 应用/ 导航/ 模型/ 的/ 定义/ 得图/ 1/ (/ b/ )/ 模型/ Mb/ ,/ 其中/ S/ =/ {/ P1/ (/ 00/ )/ ,/ P2/ (/ 10/ )/ ,/ P1/ (/ 01/ )/ ,/ P3/ (/ 00/ )/ }/ ;/ I/ =/ {/ P1/ (/ 00/ )/ }/ ;/ AP/ =/ {/ P1/ ,/ P2/ ,/ P3/ ,/ link/ ,/ login/ ,/ back/ ,/ forward/ }/ ;/ L/ (/ P1/ (/ 00/ )/ )/ =/ {/ P1/ ,/ link/ }/ ;/ L/ (/ P2/ (/ 10/ )/ )/ =/ {/ P2/ ,/ back/ ,/ login/ }/ ;/ L/ (/ P1/ (/ 01/ )/ )/ =/ {/ P1/ ,/ link/ ,/ forward/ }/ ;/ T/ =/ {/ (/ P1/ (/ 00/ )/ ,/ P2/ (/ 10/ )/ )/ ,/ (/ P2/ (/ 10/ )/ ,/ P1/ (/ 101/ )/ )/ ,/ (/ P1/ (/ 01/ )/ ,/ P2/ (/ 10/ )/ )/ ,/ (/ P2/ (/ 10/ )/ ,/ P3/ (/ 00/ )/ )/ }/ ./ 随着/ 交互/ 过程/ 的/ 深/ Page5/ 入/ ,/ 状态/ 逐渐/ 被/ 展开/ ./ 图/ 1/ (/ b/ )/ 、/ (/ c/ )/ 和/ 图/ 1/ (/ d/ )/ 是/ 图/ 1/ (/ a/ )/ 实例/ 的/ On/ -/ the/ -/ fly/ 导航/ 模型/ 构造/ 过程/ 示例/ ,/ 每条/ 迁移/ 被/ 标注/ 上/ 动作/ 便于/ 说明/ ,/ 构造/ 顺序/ 依次/ 为/ Mb/ →/ Mc/ →/ Md/ ./ 在/ On/ -/ the/ -/ fly/ 导航/ 模型/ 上/ 执行/ 验证/ ,/ 可以/ 实现/ 边/ 建模/ 边/ 验证/ 的/ 效果/ ./ 为了/ 说明/ 安全性/ 检验/ ,/ 以/ CTL/ 性质/ 公式/ [/ 1/ ,/ 5/ ,/ 17/ ]/ AGp/ 为例/ ,/ 其中/ p/ ·/ ·/ =/ / (/ P2/ →/ (/ (/ back/ ∨/ forward/ )/ ∧/ AX/ (/ P3/ )/ )/ )/ 表示/ 禁止/ 用户/ 通过/ 浏览器/ 按钮/ 动作/ 从/ 非/ 安全/ 敏感区/ No/ -/ SCR/ 直接/ 进入/ 安全/ 敏感区/ SCR/ ,/ 即/ 用户/ 不/ 允许/ 从/ 公共/ 网页/ (/ 如/ P2/ 、/ P6/ )/ 重新/ 访问/ SCR/ 内/ 的/ 私密/ 网页/ (/ 如/ P3/ 、/ P5/ )/ ./ 显然/ ,/ 采用/ On/ -/ the/ -/ fly/ 策略/ ,/ 反例/ 路径/ P2/ (/ 10/ )/ -/ 〈/ 〈/ forward/ 〉/ 〉/ -/ P3/ (/ 00/ )/ 在/ 导航/ 模型/ Mb/ 即可/ 被/ 识别/ 出来/ (/ 图中带/ 箭头/ 的/ 虚线/ 即/ 表示/ 发现/ 的/ 错误/ 迁移/ )/ ./ 此时/ ,/ 结束/ 检验/ 流程/ 并/ 提示/ 用户/ 错误/ 路径/ 以便/ 进一步/ 修改/ 模型/ ./ 相对/ 于/ 完整/ 构造/ 如图/ 1/ (/ d/ )/ 所示/ 的/ 导航/ 模型/ ,/ 这种/ 边/ 构造/ 模型/ 边/ 验证/ 模型/ 的/ 检验/ 方法/ 在/ 整个/ 导航/ 模型/ 空间/ 建立/ 之前/ 就/ 可能/ 给出/ 了/ 性质/ 检验/ 结果/ ,/ 可/ 降低/ 模型/ 检验/ 过程/ 中/ 的/ 内存/ 消耗/ 和/ 时间/ 消耗/ ./ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 优点/ 是/ 不/ 需要/ 事先/ 构造/ 完整/ 的/ 系统/ 状态/ 空间/ ./ 性质/ 检验/ 在/ 最优/ 的/ 情况/ 下/ ,/ 计算/ 复杂度/ O/ (/ 1/ )/ ,/ 然而/ ,/ 在/ 最差/ 的/ 情况/ 下/ ,/ 计算/ 复杂度/ O/ (/ |/ M/ |/ )/ ,/ 其中/ |/ M/ |/ 表示/ 整个/ 导航/ 模型/ 的/ 大小/ ./ 对于/ 存在/ 并发/ 导航/ 行为/ 的/ 系统/ 而言/ (/ 如/ 机票/ 订票/ 系统/ ,/ 一天/ 服务/ 数十/ 万人次/ )/ ,/ 组合/ 模型/ 趋于/ 无穷大/ |/ M/ |/ →/ 时/ ,/ 检验/ 性质/ 的/ 可/ 满足/ 性/ 将/ 会/ 不可避免/ 地/ 出现/ 状态/ 爆炸/ 问题/ ./ 又/ 如/ 在/ 实时/ 系统/ [/ 18/ ]/ 中/ ,/ 如何/ 约/ 减/ 状态/ 并/ 在/ 时间/ 约束/ 范围/ 内/ 发现错误/ 是/ 非常/ 重要/ 的/ ./ 因此/ ,/ 本文/ 将/ 反例/ 引导/ 的/ 抽象/ 精化/ 模型/ 检验/ 方法/ (/ CEGAR/ )/ 应用/ 到/ On/ -/ the/ -/ fly/ 导航/ 模型/ 中/ ,/ 将/ 检验/ 问题/ “/ Web/ 应用/ 导航/ 模型/ M/ 是否/ 满足/ 性质/ φ/ ,/ 即/ M/ / φ/ ”/ 转化/ 为/ “/ Web/ 应用/ 抽象/ 导航/ 模型/ M/ ^/ 是否/ 满足/ 性质/ φ/ ,/ 即/ M/ ^/ / φ/ ”/ ./ 通过/ 抽象/ 技术/ ,/ 将/ 等价/ 状态/ 进行/ 抽象/ 和约/ 减/ ,/ 提取/ 具有/ 性质/ 保持/ 关系/ 的/ 状态/ 及其/ 交互/ 行为/ ,/ 检验/ 抽象/ 模型/ 是否/ 满足/ 给定/ 的/ 安全性/ ./ 如果/ 满足/ ,/ 那么/ 说明/ 原始/ 模型/ 中/ 也/ 保持/ 这一/ 安全性/ 性质/ ;/ 反之/ ,/ 需要/ 鉴别/ 反例/ 真实性/ ./ 如果/ 是/ 伪/ 反例/ ,/ 则/ 需要/ 消除/ 该/ 伪/ 反例/ 并/ 再次/ 迭代/ 地/ 进行/ 性质/ 检验/ ./ 与/ 传统/ 抽象/ 精化/ 验证/ 方法/ 不同/ 的/ 是/ :/ 本文/ 方法/ 实现/ 一边/ 构造/ Web/ 应用/ 导航/ 模型/ ,/ 一边/ 在/ 反例/ 引导/ 下/ 进行/ 抽象/ 精化/ 验证/ ,/ 可/ 有效/ 地/ 缓解/ Web/ 应用/ 验证/ 过程/ 中/ 的/ 状态/ 爆炸/ 问题/ ./ 3On/ -/ the/ -/ fly/ 抽象/ 精化/ 验证/ Clarke/ 提出/ 的/ CEGAR/ 框架/ 分为/ 构造/ 抽象/ 模型/ 、/ 模型/ 检验/ 及/ 对/ 反例/ 进行/ 确认/ 、/ 针对/ 伪/ 反例/ 精化/ 模型/ 3/ 个/ 阶段/ ./ 然而/ ,/ 现有/ 的/ 大多数/ 抽象/ 精化/ 方法/ [/ 11/ ,/ 13/ ,/ 18/ -/ 24/ ]/ 是/ 在/ 全局/ 模型/ 上/ 进行/ 的/ ,/ 抽象/ 效率/ 低且/ 实现/ 难度/ 比较/ 大/ ./ 本文/ 基于/ On/ -/ the/ -/ fly/ 的/ 反例/ 引导/ 抽象/ 精化/ 模型/ 检验/ 的/ 方法/ 能够/ 在/ Web/ 应用/ 导航/ 模型/ 逐渐/ 构造/ 过程/ 中/ ,/ 采用/ 反例/ 引导/ 的/ 抽象/ 精化/ 方法/ 对/ Web/ 应用/ 导航/ 模型/ 进行/ 抽象/ 和/ 验证/ ,/ 可以/ 降低/ Web/ 应用/ 导航/ 模型/ 验证/ 的/ 复杂性/ ./ 如图/ 2/ 所示/ ,/ 是/ 本文/ 设计/ 的/ 用于/ 验证/ Web/ 应用/ On/ -/ the/ -/ fly/ 抽象/ 精化/ 验证/ 工具/ 平台/ 原型/ 的/ 体系结构/ ./ 具体/ 过程/ 说明/ 如下/ :/ (/ 1/ )/ 产生/ 一个/ 初始化/ 状态/ 抽象/ 函数/ ,/ 在/ 已/ 展开/ 的/ Web/ 应用/ 导航/ 模型/ 中/ ,/ 采用/ 等价/ 类/ 状态/ 划分/ 方法/ 抽象/ 状态/ ,/ 并/ 根据/ 验证/ 性质/ 的/ 需要/ 构造/ 抽象/ Web/ 应用/ 状态/ 模型/ ./ (/ 2/ )/ 在/ 抽象/ 模型/ 上/ 进行/ 性质/ 检验/ ,/ 如果/ 抽象/ 模型/ M/ ^/ 满足/ 性质/ ,/ 则/ 说明/ 对应/ 的/ 具体/ 模型/ M/ 也/ 满足/ 性质/ ,/ 转步/ (/ 4/ )/ ;/ 反之/ ,/ 根据/ 模型/ 检验/ 器/ 输出/ 的/ 反例/ ,/ 需在/ 具体/ 模型/ M/ 中/ 检验/ 抽象/ 反例/ 的/ 有效性/ ,/ 当/ 反例/ 为/ 真时/ ,/ 输出/ False/ ;/ 当/ 确认/ 反例/ 为/ 伪/ 反例/ 时/ ,/ 转至步/ (/ 3/ )/ ./ (/ 3/ )/ 通过/ 精化/ 等价关系/ 将/ 状态/ 抽象/ 函数/ 精化/ ./ 基于/ 该/ 新/ 的/ 抽象/ 函数/ 将/ 抽象/ 模型/ M/ ^/ 进行/ 精化/ ,/ 使得/ 抽象/ 模型/ 上/ 不再/ 存在/ 伪/ 反例/ ,/ 并/ 重复/ 执行/ 步/ (/ 2/ )/ ./ (/ 4/ )/ 如果/ Web/ 应用/ 导航/ 模型/ 尚未/ 构造/ 完全/ ,/ 则/ 继续/ 展开/ Web/ 应用/ 导航/ 模型/ ,/ 并/ 转向/ 步/ (/ 1/ )/ ./ 如果/ Web/ 应用/ 的/ 导航/ 模型/ 已/ 完全/ 展开/ 且/ 全局/ 模型/ 已/ 通过/ 性质/ 检验/ ,/ 则/ 输出/ True/ 表明/ 模型/ 满足/ 性质/ ./ 3.1/ 状态/ 抽象/ 抽象/ 技术/ 的/ 重点/ 在于/ 如何/ 进行/ 状态/ 合并/ ./ 用状/ Page6/ 态/ 抽象/ 函数/ h/ :/ S/ →/ S/ ^/ 表示/ 将/ 含有/ 等价关系/ (/ / )/ 的/ 状态/ 进行/ 合并/ ,/ 即/ 任意/ 两个/ 状态/ s1/ ,/ s2/ :/ S/ 满足/ s1/ / s2/ ,/ 当且/ 仅/ 当/ h/ (/ s1/ )/ =/ h/ (/ s2/ )/ ./ 每个/ 抽象/ 状态/ s/ ^/ 对应/ 具体/ 模型/ M/ 中/ 的/ 一个/ 状态/ 集/ (/ 等价/ 类/ )/ ,/ 即/ h/ -/ 1/ (/ s/ ^/ )/ 是/ 等价/ 状态/ 的/ 集合/ ./ 因此/ ,/ 抽象/ 结果/ 是/ 将/ 状态/ s1/ 和/ s2/ 合并/ 为/ 抽象/ 状态/ s/ ^/ ,/ 且/ 满足/ h/ -/ 1/ (/ s/ ^/ )/ =/ {/ s1/ ,/ s2/ }/ ./ 目前/ 普遍/ 应用/ 的/ 抽象/ 方法/ 是/ 存在/ 性/ 抽象/ 方法/ (/ ExistentialAbstract/ )/ [/ 25/ ]/ ,/ 其/ 思想/ 是/ :/ 若/ 两个/ 抽象/ 状态/ 之间/ 存在/ 迁移/ ,/ 当且/ 仅/ 当/ 这/ 两个/ 抽象/ 状态/ 分别/ 存在/ 一个/ 对应/ 的/ 具体/ 状态/ ,/ 即/ (/ t/ ,/ t1/ )/ ∈/ T/ ^/ ,/ 当且/ 仅/ 当/ / s/ :/ h/ -/ 1/ (/ t/ )/ ,/ / s1/ :/ h/ -/ 1/ (/ t1/ )/ 使得/ (/ s/ ,/ s1/ )/ ∈/ T/ ,/ 其中/ T/ ^/ 是/ 抽象/ 状态/ 模型/ 上/ 的/ 迁移/ 关系/ 集/ ./ 定理/ 1/ ./ 抽象/ 状态/ S/ ^/ 保持/ 具体/ 状态/ S/ 的/ 性质/ ./ (/ 1/ )/ 如果/ 状态/ s1/ ,/ s2/ :/ S/ 并且/ s1/ 和/ s2/ 之间/ 存在/ 迁移/ T/ (/ s1/ ,/ s2/ )/ ,/ 抽象/ 状态/ 对应/ 于/ s/ ^/ 1/ =/ h/ (/ s1/ )/ ,/ s/ ^/ 2/ =/ h/ (/ s2/ )/ ,/ 那么/ s/ ^/ 1/ 和/ s/ ^/ 2/ 也/ 存在/ 迁移/ ,/ 即/ / s1/ ,/ s2/ ·/ (/ h/ (/ s1/ )/ =/ s/ ^/ 1/ ∧/ h/ (/ s2/ )/ =/ s/ ^/ 2/ ∧/ T/ (/ s1/ ,/ s2/ )/ )/ →/ T/ ^/ (/ s/ ^/ 1/ ,/ s/ ^/ 2/ )/ ./ (/ 2/ )/ 如果/ 状态/ s/ 是/ 初始状态/ (/ I/ (/ s/ )/ =/ true/ )/ ,/ 那么/ 抽象/ 状态/ s/ ^/ 也/ 是/ 初始状态/ (/ I/ ^/ (/ s/ ^/ )/ =/ true/ )/ ,/ 即/ / s/ ·/ (/ h/ (/ s/ )/ =/ s/ ^/ ∧/ I/ (/ s/ )/ )/ →/ I/ ^/ (/ s/ ^/ )/ ./ 如图/ 3/ 所示/ ,/ 存在/ 4/ 个/ 抽象/ 状态/ 1/ ^/ ,/ 2/ ^/ ,/ 3/ ^/ ,/ 4/ ^/ ,/ 其中/ 状态/ 集合/ {/ 1/ ,/ 2/ ,/ 3/ }/ 的/ 抽象/ 状态/ 为/ 1/ ^/ ,/ 状态/ 集合/ {/ 4/ ,/ 5/ ,/ 6/ }/ 的/ 抽象/ 状态/ 为/ 2/ ^/ ,/ 状态/ 集合/ {/ 7/ ,/ 8/ ,/ 9/ }/ 的/ 抽象/ 为/ 3/ ^/ ,/ 状态/ 集合/ {/ 10/ ,/ 11/ ,/ 12/ }/ 的/ 抽象/ 状态/ 为/ 4/ ^/ ./ 状态/ 集合/ 中/ 的/ 元素/ 之间/ 存在/ 等价关系/ (/ / )/ ,/ 例如/ 状态/ 集合/ S/ =/ {/ 1/ ,/ 2/ ,/ 3/ }/ 中/ ,/ 设/ h1/ ,/ h2/ ,/ h3/ 分别/ 是/ 状态/ 1/ ,/ 2/ ,/ 3/ 对应/ 的/ 抽象/ 映射函数/ ,/ 满足/ 1/ / 2/ / 3/ 使得/ h1/ (/ 1/ )/ ≡/ h2/ (/ 2/ )/ ≡/ h3/ (/ 3/ )/ ≡/ h/ (/ {/ 1/ ,/ 2/ ,/ 3/ }/ )/ =/ 1/ ^/ ./ 抽象/ 状态/ 之间/ 的/ 迁移/ 关系/ 必然/ 对应/ 于/ 具体/ 状态/ 上/ 的/ 迁移/ 关系/ ,/ 如/ 抽象/ 迁移/ T/ ^/ (/ 1/ ^/ ,/ 2/ ^/ )/ 对应/ 具体/ 迁移/ T/ (/ 2/ ,/ 4/ )/ ./ 具体/ 状态/ 的/ 初始状态/ 在/ 抽象/ 状态/ 中/ 也/ 是/ 初始状态/ ,/ 如/ 对应/ 于/ 具体/ 状态/ 中/ 初始状态/ 1/ 的/ 抽象/ 状态/ 1/ ^/ 是/ 抽象/ 模型/ 上/ 的/ 初始状态/ ./ 基于/ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 状态/ 抽象/ 是/ 对/ 存在/ 性/ 抽象/ [/ 26/ ]/ 的/ 一种/ 改进/ 方法/ ./ 首先/ ,/ 根据/ 安全性/ 性质/ 初始化/ 导航/ 模型/ 的/ 抽象/ ;/ 其次/ ,/ 在/ 其后/ 的/ 导航/ 模型/ On/ -/ the/ -/ fly/ 构造/ 过程/ 中/ ,/ 对/ 增量/ 状态/ 进行/ 等价/ 类/ 划分/ 、/ 合并/ ./ 最后/ ,/ 根据/ 存在/ 性/ 抽象/ 原则/ 构造/ 抽象/ 模型/ ./ 定义/ 2/ ./ On/ -/ the/ -/ fly/ 状态/ 抽象/ 方法/ ./ 设/ Web/ 应用/ 导航/ 模型/ Mi/ =/ (/ Si/ ,/ Ii/ ,/ APi/ ,/ Li/ ,/ Ti/ )/ 是/ 一个/ 采用/ On/ -/ the/ -/ fly/ 方法/ 构造/ 产生/ 的/ 第/ i/ 个/ 模型/ ,/ AP/ ^/ / APi/ ./ 令/ R/ / Si/ ×/ Si/ 是/ 状态/ 集/ Si/ 上/ 关于/ AP/ ^/ 的/ 等价关系/ (/ / )/ ,/ 满足/ / s/ ,/ s/ :/ Si/ ,/ 如果/ Li/ (/ s/ )/ ∩/ AP/ ^/ =/ Li/ (/ s/ )/ ∩/ AP/ ^/ ,/ 那么/ s/ 和/ s/ 存在/ 等价关系/ R/ (/ s/ ,/ s/ )/ ,/ 它们/ 可以/ 进行/ 状态/ 合并/ ./ 以/ Mi/ 到/ Mi/ +/ 1/ 的/ 导航/ 模型/ 构造/ 过程/ 为例/ ,/ 说明/ On/ -/ the/ -/ fly/ 状态/ 抽象/ 方法/ 如下/ :/ (/ 1/ )/ 定义/ Mi/ 关于/ AP/ ^/ 和/ R/ 的/ 抽象/ 结果/ M/ ^/ i/ =/ Mi/ // (/ AP/ ^/ ,/ R/ )/ =/ (/ S/ ^/ i/ ,/ I/ ^/ i/ ,/ AP/ ^/ i/ ,/ L/ ^/ i/ ,/ T/ ^/ i/ )/ ,/ 其中/ :/ ①/ S/ ^/ i/ =/ (/ Si/ // R/ )/ ,/ 即/ S/ ^/ i/ 是/ Si/ 关于/ R/ 的/ 等价/ 类/ 划分/ ./ ②/ I/ ^/ i/ =/ {/ s/ ^/ :/ S/ ^/ i/ |/ / s/ :/ h/ -/ 1/ (/ s/ ^/ )/ ·/ s/ ∈/ Ii/ }/ ./ ③/ L/ ^/ i/ (/ s/ ^/ )/ =/ Li/ (/ s/ )/ ∩/ AP/ ^/ ,/ 其中/ s/ ∈/ h/ -/ 1/ (/ s/ ^/ )/ ./ ④/ / s/ ^/ 1/ ,/ s/ ^/ 2/ :/ Si/ ·/ (/ s/ ^/ 1/ ,/ s/ ^/ 2/ )/ ∈/ T/ ^/ i/ ,/ 当且/ 仅/ 当/ / s1/ ,/ s2/ :/ S/ ·/ s1/ ∈/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∧/ s2/ ∈/ h/ -/ 1/ (/ s/ ^/ 2/ )/ ∧/ (/ s1/ ,/ s2/ )/ ∈/ Ti/ ./ (/ 2/ )/ 定义/ 后继/ 模型/ Mi/ +/ 1/ 关于/ AP/ ^/ 和/ R/ 的/ 抽象/ 结果/ 描述/ 为/ M/ ^/ i/ +/ 1/ =/ Mi/ +/ 1/ // (/ AP/ ^/ ,/ R/ )/ =/ (/ S/ ^/ i/ +/ 1/ ,/ I/ ^/ i/ +/ 1/ ,/ AP/ ^/ i/ +/ 1/ ,/ L/ ^/ i/ +/ 1/ ,/ T/ ^/ i/ +/ 1/ )/ ./ 令/ Δ/ S/ 是/ 基于/ On/ -/ the/ -/ fly/ 方法/ 构造/ 的/ 第/ i/ +/ 1/ 个/ 模型/ Mi/ +/ 1/ 和/ 第/ i/ 个/ 模型/ Mi/ 之间/ 增量/ 状态/ 集合/ ./ 每个/ 增量/ 状态/ Δ/ s/ ∈/ Δ/ S/ 而言/ ,/ 抽象/ 过程/ 分为/ 以下/ 两种/ 情况/ 处理/ ./ 如果/ / s/ ^/ :/ S/ ^/ i/ ·/ L/ ^/ i/ (/ s/ ^/ )/ ≠/ Li/ (/ Δ/ s/ )/ ∩/ AP/ ^/ ,/ 则/ (/ 1/ )/ S/ ^/ i/ +/ 1/ =/ S/ ^/ i/ ∪/ Δ/ s/ ./ (/ 2/ )/ I/ ^/ i/ +/ 1/ =/ I/ ^/ i/ ∪/ Δ/ s/ ,/ 当且/ 仅/ 当/ Δ/ s/ ∈/ Ii/ +/ 1/ ;/ 否则/ ,/ (/ 3/ )/ T/ ^/ i/ +/ 1/ =/ T/ ^/ i/ ∪/ (/ Δ/ s/ ,/ s/ )/ ,/ 当且/ 仅/ 当/ / s/ :/ S/ ^/ i/ ·/ (/ Δ/ s/ ,/ 如果/ / s/ ^/ :/ S/ ^/ i/ ·/ L/ ^/ i/ (/ s/ ^/ )/ =/ Li/ (/ Δ/ s/ )/ ∩/ AP/ ^/ ,/ 则/ I/ ^/ i/ +/ 1/ =/ I/ ^/ i/ ./ s/ )/ / T/ ^/ i/ ./ Page7/ (/ 1/ )/ S/ ^/ i/ +/ 1/ =/ S/ ^/ i/ ,/ 其中/ s/ ^/ =/ h/ (/ Δ/ s/ )/ ./ (/ 2/ )/ I/ ^/ i/ +/ 1/ =/ I/ ^/ i/ ./ (/ 3/ )/ T/ ^/ i/ +/ 1/ =/ T/ ^/ i/ ∪/ (/ Δ/ s/ ,/ s/ )/ ,/ 当且/ 仅/ 当/ / Δ/ s/ :/ Δ/ S/ ,/ / s/ :/ S/ ^/ i/ ·/ (/ s/ ,/ s/ )/ ∈/ Ti/ +/ 1/ ∧/ Ti/ +/ 1/ // / T/ ^/ i/ ./ 模型/ Mi/ +/ 1/ 是/ 在/ 模型/ Mi/ 的/ 基础/ 上/ 的/ 增量/ 抽象/ ./ 在/ 构造/ Mi/ +/ 1/ 的/ 抽象/ 过程/ 中/ ,/ 第/ 1/ 种/ 情况/ 表明/ 当前/ 增量/ 状态/ 不/ 与/ 已/ 抽象/ 的/ 状态/ 存在/ 等价关系/ ,/ 需要/ 进行/ 单独/ 抽象/ ./ 第/ 2/ 种/ 情况/ 表明/ 当前/ 增量/ 状态/ 与/ 已/ 抽象/ 的/ 状态/ 存在/ 等价关系/ ,/ 抽象/ 状态/ 不/ 发生变化/ ,/ 只/ 需/ 考虑/ 新增/ 的/ 迁移/ 关系/ ./ 随着/ 导航/ 模型/ 的/ 逐步/ 展开/ ,/ 反复/ 执行/ 增量/ 抽象/ ,/ 直到/ Web/ 应用/ 导航/ 模型/ 完全/ 建立/ 完毕/ 才/ 停止/ ./ 在/ 模型/ 实际/ 构造/ 过程/ 中/ ,/ 等价关系/ 是/ 基于/ 检验/ 性质/ 构造/ 的/ ,/ 结合/ 每个/ 抽象/ 页面/ 的/ AP/ ^/ 及待/ 验证/ 性质/ φ/ 用于/ 抽象/ 模型/ ,/ 即/ AP/ ^/ =/ AP/ ∩/ AP/ φ/ ,/ 其中/ AP/ φ/ =/ {/ p/ |/ p/ ∈/ Atom/ (/ φ/ )/ }/ ,/ Atom/ (/ φ/ )/ 是/ 性质/ 公式/ φ/ 中/ 的/ 原子/ 命题/ ./ 抽象/ 模型/ M/ ^/ =/ M/ // (/ AP/ ^/ ,/ R/ )/ 中/ 就/ 只/ 包含/ 与/ φ/ 相关/ 的/ 原子/ 命题/ ,/ 从而/ 实现/ 将/ 与/ φ/ 无关/ 的/ 其他/ 原子/ 命题/ 从/ 模型/ 中约/ 减/ ./ 实例/ 说明/ :/ 假设/ 图/ 4/ (/ a/ )/ 和/ (/ c/ )/ 是/ 基于/ On/ -/ the/ -/ fly/ 建模/ 过程/ 产生/ 的/ 两个/ 模型/ ./ 采用/ 定义/ 2/ 方法/ ,/ 图/ 4/ (/ b/ )/ 和/ (/ d/ )/ 分别/ 是/ 图/ 4/ (/ a/ )/ 和/ (/ c/ )/ 的/ 抽象/ ./ 以/ 安全性/ φ/ =/ AG/ / (/ P2/ →/ (/ (/ back/ ∨/ forward/ )/ ∧/ AX/ (/ P3/ )/ )/ )/ 为例/ ,/ 由该/ 性质/ 得到/ AP/ φ/ =/ {/ P2/ ,/ P3/ ,/ back/ ,/ forward/ }/ ./ 在/ 图/ 4/ (/ b/ )/ 中/ ,/ 状态/ {/ P1/ (/ 00/ )/ }/ 被/ 抽象/ 成为/ 状态/ P/ ^/ 1/ ,/ 状态/ {/ P2/ (/ 10/ )/ }/ 被/ 抽象/ 成为/ 状态/ P/ ^/ 2/ ,/ 状态/ {/ P3/ (/ 00/ )/ }/ 被/ 抽象/ 成为/ 状态/ P/ ^/ 3/ ,/ 即/ h/ (/ P1/ (/ 00/ )/ )/ =/ P/ ^/ 1/ ,/ h/ (/ P2/ (/ 10/ )/ )/ =/ P/ ^/ 2/ ,/ h/ (/ P3/ (/ 00/ )/ )/ =/ P/ ^/ 3/ ./ 在/ 图/ 4/ (/ d/ )/ 中/ ,/ 检验/ 到/ 状态/ P4/ (/ 00/ )/ 与/ P/ ^/ 1/ 中/ 的/ 状态/ 具有/ 等价/ 性/ ,/ 即/ L/ (/ P/ ^/ 1/ )/ =/ L/ (/ P4/ (/ 00/ )/ )/ ∩/ AP/ φ/ ,/ 因此/ 将/ 其/ 合并/ 到/ 抽象/ 状态/ P/ ^/ 1/ 之中/ ,/ 即/ h/ (/ {/ P1/ (/ 00/ )/ ,/ P4/ (/ 00/ )/ }/ )/ =/ P/ ^/ 1/ ./ 如图/ 4/ (/ b/ )/ 所示/ ,/ 是/ 图/ 4/ (/ a/ )/ 模型/ 的/ 抽象/ 结果/ ,/ 其中/ 增量/ 状态/ 、/ 抽象/ 状态/ 、/ 迁移/ 关系/ 及/ 状态/ 上/ 原子/ 命题/ 的/ 说明/ 如表/ 1/ (/ a/ )/ 所示/ ./ 如图/ 4/ (/ d/ )/ 所示/ ,/ 是/ 随着/ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 展开/ ,/ 对/ 增量/ 状态/ P4/ (/ 00/ )/ 进行/ 的/ 抽象/ ,/ 其中/ 增量/ 状态/ 、/ 抽象/ 状态/ 、/ 迁移/ 关系/ 及/ 状态/ 上/ 原子/ 命题/ 的/ 说明/ 如表/ 1/ (/ b/ )/ 所示/ ./ 增量/ 状态/ 抽象/ 状态/ 迁移/ P1/ (/ 00/ )/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ }/ —/ P2/ (/ 10/ )/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ }/ ,/ P3/ (/ 00/ )/ P3/ (/ 00/ )/ P4/ (/ 00/ )/ 增量/ 状态/ 抽象/ 状态/ 迁移/ P1/ (/ 00/ )/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ }/ —/ P2/ (/ 10/ )/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ }/ ,/ P/ ^/ 2/ =/ {/ P2/ (/ 10/ )/ }/ {/ (/ P1/ ,/ P2/ )/ link/ }/ L/ (/ P/ ^/ 1/ )/ ≠/ L/ (/ P2/ (/ 10/ )/ )/ ∩/ AP/ φ/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ }/ ,/ P/ ^/ 2/ =/ {/ P2/ (/ 10/ )/ }/ ,/ P/ ^/ 3/ =/ {/ P3/ (/ 00/ )/ }/ P/ ^/ 1/ =/ {/ P1/ (/ 00/ )/ ,/ P/ ^/ 2/ =/ {/ P2/ (/ 10/ )/ }/ ,/ P/ ^/ 3/ =/ {/ P3/ (/ 00/ )/ }/ 在/ 该/ 过程/ 中/ ,/ 4/ 个/ 状态/ 和/ 4/ 个/ 迁移/ 分别/ 抽象/ 为/ 3/ 个/ 状态/ 和/ 3/ 个/ 迁移/ ./ 随着/ 导航/ 模型/ 状态/ 不断/ 增加/ ,/ 抽象/ 的/ 效果/ 将/ 更/ 趋于/ 明显/ ./ 由/ 定义/ 2On/ -/ the/ -/ fly/ 状态/ 抽象/ 方法/ 以及/ 定理/ 1/ 的/ 存在/ 性/ 抽象/ 知/ :/ (/ 1/ )/ 如果/ 状态/ s/ 和/ s/ 是/ 等价/ 类/ ,/ 那么/ 在/ 抽象/ 函数/ h/ 上/ 是/ 等价/ 的/ ,/ 并且/ 状态/ 上/ 的/ 原子/ 命题/ 必然/ 也/ 是/ 等价/ 的/ ,/ 即/ L/ (/ s/ )/ =/ L/ (/ s/ )/ ;/ (/ 2/ )/ 每个/ 抽象/ 状态/ 保留/ 着/ 具体/ 状态/ 的/ 原子/ 命题/ ,/ 即/ h/ (/ s/ )/ =/ s/ ^/ →/ L/ ^/ (/ s/ ^/ )/ =/ L/ (/ s/ )/ ./ 因此/ ,/ 可得/ Web/ 应用/ 导航/ 模型/ 的/ 抽象/ 性质/ ./ 定义/ 3/ ./ 导航/ 模型/ 抽象/ 性质/ ./ 通过/ On/ -/ the/ -/ fly/ 方法/ 抽象/ 产生/ 的/ 抽象/ 模型/ M/ ^/ =/ (/ S/ ^/ ,/ I/ ^/ ,/ AP/ ^/ ,/ L/ ^/ ,/ T/ ^/ )/ 是/ 具体/ 模型/ M/ =/ (/ S/ ,/ I/ ,/ AP/ ,/ L/ ,/ T/ )/ 的/ 抽象/ ,/ 记为/ M/ / aM/ ^/ ,/ 它们/ 满足/ 如下/ 性质/ :/ (/ 1/ )/ I/ ^/ (/ s/ ^/ )/ 是/ 抽象/ 初始状态/ ,/ 当且/ 仅/ 当/ / s/ :/ S/ ·/ (/ 2/ )/ T/ ^/ (/ s/ ^/ 1/ ,/ s/ ^/ 2/ )/ 是/ 抽象/ 迁移/ ,/ 当且/ 仅/ 当/ / s1/ ,/ s2/ :/ S/ ·/ h/ (/ s1/ )/ =/ s/ ^/ 1/ ∧/ h/ (/ s2/ )/ =/ s/ ^/ 2/ ∧/ T/ (/ s1/ ,/ s2/ )/ ./ (/ 3/ )/ L/ ^/ (/ s/ ^/ )/ =/ ∪/ h/ (/ s/ )/ =/ s/ ^/ L/ (/ s/ )/ ∩/ AP/ φ/ ./ (/ 4/ )/ AP/ ^/ / AP/ ./ 抽象/ 具有/ 性质/ 保持/ 定理/ [/ 26/ ]/ ./ 本文/ 讨论/ 的/ 安全性/ 性质/ φ/ 是/ 以/ ACTL/ / 描述/ 的/ ,/ 如/ AGp/ ,/ 因为/ 它/ 在/ 抽/ h/ (/ s/ )/ =/ s/ ^/ ∧/ I/ (/ s/ )/ ./ Page8/ 象/ 过程/ 中是/ 保/ 性质/ 的/ ./ 如果/ 抽象/ 模型/ 上/ 满足/ 待/ 验证/ 的/ 性质/ ,/ 那么/ 具体/ 模型/ 也/ 满足/ 该/ 性质/ ./ 但是/ 抽象/ 技术/ 的/ 一个/ 主要/ 缺陷/ 是/ 抽象/ 模型/ 可能/ 引入/ 系统/ 中/ 不/ 存在/ 的/ 附加/ 行为/ ,/ 也/ 可能/ 由于/ 过度/ 的/ 精化/ 导致/ 一些/ 系统/ 行为/ 的/ 丢失/ ./ 因此/ ,/ 出现/ 反例/ 时/ ,/ 并/ 不能/ 说明/ 具体/ 模型/ 也/ 存在/ 反例/ ,/ 而/ 需/ 确认/ 反例/ 的/ 有效性/ ./ 3.2/ 反例/ 确认/ 将/ Web/ 应用/ 的/ 导航/ 抽象/ 模型/ 输入/ 到/ 模型/ 检验/ 器后/ ,/ 模型/ 检验/ 器/ 基于/ 遍历/ 算法/ 检验/ 以/ 时态/ 逻辑/ 性质/ 描述/ 的/ 安全性/ 性质/ ./ 当/ 抽象/ 模型/ 违背/ 性质/ 时/ ,/ 模型/ 检验/ 器/ 输出/ 反例/ ,/ 描述/ 从/ 起始/ 状态/ 到/ 违反/ 性质/ 的/ 状态/ 的/ 路径/ ./ 此时/ ,/ 需/ 确认/ 抽象/ 反例/ 的/ 有效性/ ,/ 即/ 抽象/ 反例/ 是否/ 在/ 具体/ 模型/ 中/ 存在/ 相应/ 的/ 反例/ 路径/ ./ 如果/ 存在/ ,/ 则/ 抽象/ 反例/ 是/ 一个/ 真实/ 的/ 反例/ ;/ 反之/ ,/ 抽象/ 反例/ 是/ 一个/ 伪/ 反例/ ./ 定义/ 4/ ./ 反例/ 路径/ 有效性/ ./ 为了/ 便于/ 说明/ ,/ 令/ 抽象/ 模型/ 反例/ π/ ^/ =/ 〈/ s/ ^/ 1/ ,/ s/ ^/ 2/ ,/ …/ ,/ s/ ^/ n/ 〉/ ,/ 描述/ 从/ 抽象/ 状态/ 页面/ s/ ^/ 1/ 到/ s/ ^/ n/ 的/ 导航/ 路径/ 是/ 违反/ 给定/ 的/ 安全性/ 性质/ 的/ ./ 具体/ 模型/ 上/ 也/ 应该/ 存在/ 对应/ 的/ 反例/ 路径/ [/ 13/ ]/ ,/ 其/ 表示/ 为/ h/ -/ 1/ π/ (/ )/ ^/ =/ {/ 〈/ s1/ ,/ …/ ,/ sn/ 〉/ |/ ∧/ n/ 由于/ 抽象/ 反例/ 路径/ 上/ 的/ 每个/ 状态/ 页面/ 可能/ 对应/ 多个/ 具体/ 状态/ 页面/ ,/ 因此/ 根据/ 抽象/ 反例/ 路径/ 的/ 导航/ 关系/ 组成/ 的/ 具体/ 反例/ 路径/ 集合/ 称为/ 具体/ 反例/ 路径/ ./ 当/ 具体/ 模型/ 的/ 反例/ 路径/ h/ -/ 1/ π/ (/ )/ ^/ ≠/ / 时/ ,/ 说明/ 具体/ 模型/ 亦/ 存在/ 反例/ ,/ 其/ 也/ 违反/ 了/ 安全性/ 性质/ ,/ 此时/ 该/ 反例/ 是/ 真实/ 的/ ./ 否则/ ,/ 说明/ 具体/ 模型/ 上/ 不/ 存在/ 相应/ 的/ 反例/ 路径/ ./ 在/ 实际/ 计算/ 具体/ 反例/ 路径/ 时/ ,/ 令/ 任意/ s/ ^/ i/ 对应/ 于/ 具体/ 模型/ 上/ 的/ 状态/ 可达集/ Si/ ∷/ =/ Img/ (/ Si/ -/ 1/ ,/ T/ )/ ∩/ h/ -/ 1/ (/ s/ ^/ i/ )/ ,/ 其中/ Img/ (/ Si/ -/ 1/ ,/ T/ )/ 表示/ 可/ 达/ 状态/ 集/ Si/ -/ 1/ 在/ 迁移/ 关系/ T/ 的/ 作用/ 下/ 得到/ 的/ 所有/ 后继/ 状态/ 集合/ ./ 令/ S1/ =/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∩/ I/ 表示/ 初始/ 可/ 达/ 状态/ 集/ ./ 抽象/ 反例/ 路径/ 是/ 真实/ 的/ ,/ 当且/ 仅/ 当/ 满足/ :/ (/ 1/ )/ 实际/ 路径/ h/ -/ 1/ (/ π/ ^/ )/ 为/ 非/ 空集合/ ;/ (/ 2/ )/ 对于/ 所有/ 1/ / i/ / n/ ,/ 那么/ Si/ ≠/ / ./ 根据/ 抽象/ 模型/ 上/ 的/ 反例/ 路径/ 计算/ Si/ 可以/ 识别/ 出伪/ 反例/ 存在/ 的/ 位置/ ,/ 即当/ Si/ =/ / 时/ ,/ 抽象/ 模型/ 存在/ 伪/ 反例/ ./ 如图/ 5/ 所示/ ,/ 是/ 图/ 1/ (/ c/ )/ 导航/ 模型/ Mi/ 的/ 一个/ 反例/ 〈/ P/ ^/ 1/ ,/ P/ ^/ 2/ ,/ P/ ^/ 3/ ,/ P/ ^/ 4/ 〉/ ,/ 表示/ 用户/ 在/ Web/ 浏览器/ 上/ 通过/ 直接/ 点击/ Forward/ 按钮/ 进入/ SCR/ 区域/ ,/ 而/ 对应/ 的/ 具体/ 模型/ 上/ 却/ 不/ 存在/ 相应/ 的/ 反例/ 路径/ ./ 由/ 抽象/ 状态/ 和/ 具体/ 状态/ 之间/ 的/ 关系/ ,/ 可达集/ 计算/ 如下/ S1/ =/ {/ P1/ (/ 00/ )/ ,/ P1/ (/ 10/ )/ ,/ P1/ (/ 01/ )/ }/ ,/ S2/ =/ {/ P2/ (/ 10/ )/ }/ ,/ S3/ =/ {/ P3/ (/ 00/ )/ }/ ,/ S4/ =/ Img/ (/ S3/ ,/ T/ )/ ∩/ h/ -/ 1/ (/ P/ ^/ 4/ )/ =/ / ./ 可以/ 发现/ 由于/ S4/ =/ / ,/ 抽象/ 反例/ 是/ 伪/ 反例/ ./ 造成/ 这一伪/ 反例/ 的/ 原因/ 是/ 状态/ P3/ (/ 01/ )/ 和/ P3/ (/ 00/ )/ 被/ 合并/ 为/ 同一/ 抽象/ 状态/ P/ ^/ 3/ ./ 此时/ ,/ 抽象/ 反例/ 的/ 导航/ 行为/ 在/ 具体/ 模型/ 上/ 不/ 存在/ 反例/ ./ 定义/ 5/ ./ 失效/ 状态/ ./ 引起/ 具体/ 模型/ 无法/ 满足/ 抽象/ 反例/ 路径/ 的/ 状态/ 可达集/ Si/ ≠/ / 称为/ 失效/ 状态/ ./ 给定/ 一个/ 最大/ 失效/ 索引/ f/ ,/ 伪/ 反例/ 路径/ π/ ^/ =/ 〈/ s/ ^/ 1/ ,/ s/ ^/ 2/ ,/ …/ ,/ s/ ^/ f/ 〉/ 在/ 具体/ 模型/ 上/ 存在/ 对应/ 的/ 最大/ 反例/ 路径/ ,/ 即可/ 达集/ Sf/ ≠/ / ,/ Sf/ +/ 1/ =/ / ./ 失效/ 状态/ 根据/ Web/ 应用/ 的/ 具体/ 模型/ 上/ 页面/ 导航/ 关系/ 划分/ 为/ 以下/ 几种/ 类型/ :/ (/ 1/ )/ 死/ 状态/ 集/ SD/ (/ Dead/ -/ endState/ )/ ./ 每个/ SD/ 中/ 的/ 状态/ 从/ 初始状态/ 出发/ 都/ 是/ 可达/ 的/ ,/ 但/ 每个/ 状态/ 不/ 存在/ 后继/ 迁移/ 导航/ ./ 此时/ ,/ 状态/ 可达集/ Sf/ ∈/ h/ -/ 1/ (/ s/ ^/ f/ )/ 并且/ Sf/ +/ 1/ =/ Img/ (/ Sf/ ,/ T/ )/ ∩/ h/ -/ 1/ (/ s/ ^/ f/ +/ 1/ )/ =/ / ,/ 每个/ Sf/ 中/ 的/ 元素/ 从/ 初始状态/ 集/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∩/ I/ 都/ 是/ 可达/ 的/ ./ 因此/ SD/ =/ Sf/ ./ (/ 2/ )/ 坏/ 状态/ 集/ SB/ (/ BadState/ )/ ./ 每个/ SB/ 中/ 的/ 状态/ 从/ 初始状态/ 出发/ 都/ 是/ 不可/ 达/ 的/ ,/ 但/ 每个/ 状态/ 存在/ 后继/ 迁移/ 导航/ ,/ 即/ 存在/ 一个/ 从/ s/ ^/ i/ 到/ s/ ^/ i/ +/ 1/ 的/ 抽象/ 迁移/ 导航/ 关系/ ,/ 使得/ h/ -/ 1/ (/ s/ ^/ i/ )/ 中/ 的/ 坏/ 状态/ 与/ h/ -/ 1/ (/ s/ ^/ i/ +/ 1/ )/ 中/ 的/ 状态/ 至少/ 存在/ 一个/ 迁移/ 导航/ 关系/ ./ 此时/ ,/ 坏/ 状态/ 集/ SB/ 中/ 没有/ 任何/ 一个/ 状态/ 与/ h/ -/ 1/ (/ s/ ^/ i/ -/ 1/ )/ 发生/ 联系/ ./ 坏/ 状态/ 从/ 初始状态/ 集是/ 不可/ 达/ 的/ ./ 因此/ SB/ =/ {/ s/ :/ h/ -/ 1/ (/ s/ ^/ f/ )/ |/ / s/ :/ h/ -/ 1/ (/ s/ ^/ f/ +/ 1/ )/ ·/ T/ (/ s/ ,/ s/ )/ }/ ./ (/ 3/ )/ 无关/ 状态/ 集/ SI/ (/ IrrelevantState/ )/ ./ 它/ 既/ 不/ 与/ 前驱/ 的/ 状态/ 发生/ 关联/ ,/ 也/ 不/ 与/ 后继/ 的/ 状态/ 发生/ 关联/ ,/ 即/ 它/ 既/ 不/ 属于/ 死/ 状态/ 集/ 也/ 不/ 属于/ 坏/ 状态/ 集/ 的/ 状态/ ./ 因此/ SI/ =/ h/ -/ 1/ (/ s/ ^/ f/ )/ \/ (/ SB/ ∪/ SD/ )/ ./ 如图/ 5/ 所示/ ,/ P3/ (/ 00/ )/ ∈/ SD/ 是/ 一个/ 死/ 状态/ ,/ 其后/ 不/ 存在/ 任何/ 向外/ 的/ 迁移/ 导航/ 路径/ ;/ P3/ (/ 01/ )/ ∈/ SB/ 是/ 一个/ 坏/ 状态/ ,/ 其后/ 存在/ 迁移/ 导航/ 路径/ ,/ 但是/ 从/ 初始状态/ 是/ 不可/ 达/ 的/ ;/ P3/ (/ 11/ )/ ∈/ SI/ 是/ 无关/ 状态/ ./ 正是/ 因为/ Page9/ 死/ 状态/ P3/ (/ 00/ )/ 和/ 坏/ 状态/ P3/ (/ 01/ )/ 被/ 抽象/ 为/ 同一/ 抽象/ 状态/ ,/ Web/ 应用/ 的/ 抽象/ 模型/ 上/ 附加/ 了/ 一个/ 导航/ 行为/ T/ ^/ (/ P/ ^/ 3/ ,/ P/ ^/ 4/ )/ ,/ 并/ 引起/ 了/ 伪/ 反例/ 的/ 出现/ ./ 定义/ 6/ ./ 导航/ 路径/ 伪/ 反例/ 确认/ 算法/ ./ 定义/ 4/ 表明/ 如果/ h/ -/ 1/ (/ π/ ^/ )/ =/ / ,/ 则/ 反例/ 是/ 一个/ 伪/ 反例/ 使得/ 状态/ 可达集/ Si/ =/ / ./ 为了/ 确认/ 抽象/ 导航/ 模型/ 上/ 的/ 反例/ 是否/ 为/ 伪/ 反例/ ,/ 算法/ 1/ 是/ 用于/ 计算/ Sf/ 失效/ 状态/ 的/ SplitPATH/ 算法/ [/ 13/ ]/ ./ 在/ 初始化/ 时/ S/ =/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∩/ I/ 并/ 设置/ j/ =/ 1/ 表示/ 失效/ 索引/ ,/ 当/ S/ 不为/ 空/ 并且/ 没有/ 达到/ 最大/ 抽象/ 状态/ 时/ ,/ 进行/ 循环/ 处理/ ./ 一旦/ 当前/ 抽象/ 状态/ 满足/ S/ =/ / ,/ 则/ 输出/ 前/ 一个/ 失效/ 状态/ Spre/ 集合/ 和/ 失效/ 状态/ 索引/ j/ ,/ 用于/ 确认/ 反例/ 的/ 真实性/ ./ 算法/ 1/ ./ SplitPATH/ 算法/ ./ 输入/ :/ 抽象/ 模型/ 、/ 具体/ 模型/ 以及/ 抽象/ 模型/ 上/ 的/ 一个/ 反/ 输出/ :/ 如果/ 反例/ 是/ 伪/ 反例/ ,/ 返回/ 抽象/ 反例/ 中/ 的/ 失效/ 状态/ BEGINS/ ·/ ·/ =/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∩/ I/ ;/ j/ ·/ ·/ =/ 1/ ;/ WHILE/ (/ S/ ≠/ / ANDj/ </ n/ )/ {/ j/ ·/ ·/ =/ j/ +/ 1/ ;/ Sprev/ ·/ ·/ =/ S/ ;/ S/ ·/ ·/ =/ Img/ (/ S/ ,/ T/ )/ ∩/ h/ -/ 1/ (/ s/ ^/ j/ )/ ;/ }/ ENDWHILEIFS/ ≠/ / THENoutput/ “/ counterexample/ ”/ ELSEoutputj/ ,/ SprevENDIFEND/ 另/ 一种/ 复杂/ 情况/ 是/ 存在/ 套索/ [/ 26/ ]/ 的/ 反例/ 路径/ π/ ^/ =/ 〈/ s/ ^/ 1/ ,/ s/ ^/ 2/ ,/ …/ ,/ s/ ^/ i/ 〉/ 〈/ s/ ^/ i/ +/ 1/ ,/ s/ ^/ i/ +/ 2/ ,/ …/ ,/ s/ ^/ n/ 〉/ w/ ,/ 即/ 在/ 状态/ s/ ^/ i/ +/ 1/ 和/ s/ ^/ n/ 之间/ 出现/ 无限/ 循环/ ./ 套索/ 用来/ 说明/ 模型/ 违背/ 一个/ 活性/ (/ liveness/ )/ 性质/ ./ 在/ Web/ 应用/ 导航/ 模型/ 的/ SCR/ 区域/ 的/ 边界/ 尤其/ 需要/ 重视/ 套索/ 反例/ 的/ 存在/ ./ 一旦/ 出现/ 套索/ 则/ 可能/ 影响/ 私密/ 数据/ 页面/ 的/ 安全性/ ,/ 此时/ 由于/ Web/ 应用程序/ 中/ 维护/ Session/ 的/ 业务/ 逻辑/ 出现/ bug/ 缺陷/ ,/ 容易/ 导致用户/ 登入/ 和/ 登出/ 信息/ 不/ 一致/ ,/ 以及/ 非法/ 用户/ 获取/ 或/ 继承/ 某些/ 限制/ 级别/ 的/ Web/ 应用/ 使用/ 权限/ ./ 为了/ 检验/ 实际/ 循环/ 是否/ 与/ 抽象/ 循环/ 一致/ ,/ 需/ 将/ 抽象/ 循环/ 中/ 的/ 反例/ 进行/ 展开/ ./ 令/ / k/ :/ [/ i/ +/ 1/ ,/ n/ ]/ ·/ s/ ^/ k/ +/ j/ (/ n/ -/ i/ )/ =/ s/ ^/ k/ ,/ 得到/ 展开/ 后/ 的/ 路径/ 为/ π/ ^/ unwind/ =/ 〈/ s/ ^/ 1/ ,/ s/ ^/ 2/ ,/ …/ ,/ s/ ^/ i/ 〉/ 〈/ s/ ^/ i/ +/ 1/ ,/ …/ ,/ s/ ^/ n/ 〉/ 〈/ s/ ^/ i/ +/ 1/ ,/ …/ ,/ s/ ^/ n/ 〉/ …/ 然而/ ,/ 展开/ 给定/ 的/ 一个/ 抽象/ 循环/ 反例/ ,/ 具体/ 模型/ 可/ 得到/ 多个/ 不同/ 大小/ 的/ 循环/ 路径/ ./ 展开/ 的/ 结果表明/ :/ (/ 1/ )/ 每/ 一个/ 环/ 可以/ 在/ 不同/ 展开/ 阶段/ 重新/ 开始/ 循环/ ;/ (/ 2/ )/ 执行/ 结果/ 将/ 出现/ 周期性/ ;/ (/ 3/ )/ 随着/ 循环展开/ 状态/ 的/ 增加/ ,/ 计算/ 复杂度/ 将/ 呈现/ 指数/ 级/ 增长/ ,/ 且/ 属于/ 多项式/ 计算/ NP/ -/ 难/ 问题/ ./ 因此/ ,/ 展开/ 这/ 类/ 套索/ 反例/ 过程/ 中/ ,/ 需要/ 考虑/ 在/ 最小/ 循环/ 上/ 执行/ 操作/ ./ 如图/ 6/ 所示/ ,/ 图/ 6/ (/ a/ )/ 中/ 的/ 循环/ 反例/ 〈/ P/ ^/ 2/ 〉/ 〈/ P/ ^/ 3/ ,/ P/ ^/ 4/ 〉/ w/ 被/ 部分/ 展平/ 成图/ 6/ (/ b/ )/ ,/ 表明/ 抽象/ 页面/ P/ ^/ 4/ 和/ P/ ^/ 3/ 状态/ 之间/ 存在/ 无限/ 循环/ 操作/ ,/ 那么/ 用户/ 可以/ 通过/ 点击/ Forward/ 和/ Back/ 按钮/ 随意/ 登入/ 审计/ 系统/ ,/ 使得/ P3/ 页面/ 出现/ P3/ (/ 11/ )/ 的/ 错误/ 状态/ ./ 作为/ SCR/ 页面/ ,/ 是/ 不/ 允许/ 出现/ 状态/ P3/ (/ 11/ )/ 的/ ,/ 因为/ P3/ (/ 11/ )/ 表示/ 用户/ 可以/ 通过/ 点击/ Back/ 按钮/ 直接/ 退出/ 系统/ ,/ 或/ 点击/ Forward/ 按钮/ 直接/ 进入/ 系统/ ./ 此时/ ,/ 或者/ 是/ 由于/ Session/ 数据/ 在/ 用户/ 退出/ 之后/ 未/ 做/ 清除/ ,/ 或者/ 是/ 由于/ 当前/ 用户/ 登入/ 过程/ 中/ 读取/ 了/ 其他/ 历史/ 用户/ 的/ Session/ 数据/ ./ 检验/ 和/ 消除/ 类似/ P3/ (/ 11/ )/ 状态/ 的/ 页面/ 可以/ 有效/ 地/ 保护/ SCR/ 区域/ 的/ 安全性/ ./ 定义/ 7/ ./ 循环/ 伪/ 反例/ 确认/ 算法/ ./ 循环/ 伪/ 反例/ 确认/ 算法/ (/ SplitLOOP/ 算法/ )/ 和/ 路径/ 伪/ 反例/ 确认/ 算法/ 非常/ 相似/ ,/ 不同/ 的/ 是/ SplitLOOP/ 算法/ [/ 13/ ]/ 计算/ 最小/ 循环展开/ 中/ 的/ 反例/ ./ 令/ 抽象/ 循环/ 内/ 所有/ 抽象/ 状态/ 中/ 的/ 最小值/ min/ =/ Mini/ +/ 1/ / j/ / n/ (/ |/ h/ -/ 1/ (/ s/ ^/ j/ )/ |/ )/ =/ Min/ {/ |/ h/ -/ 1/ (/ s/ ^/ i/ +/ 1/ )/ |/ ,/ …/ ,/ |/ h/ -/ 1/ (/ s/ ^/ n/ )/ |/ }/ ,/ 展开/ 后/ 的/ 抽象/ 循环/ 路径/ 表示/ 为/ π/ ^/ unwind/ =/ 〈/ s/ ^/ 1/ ,/ s/ ^/ 2/ ,/ …/ ,/ s/ ^/ i/ 〉/ 〈/ s/ ^/ i/ +/ 1/ ,/ …/ ,/ s/ ^/ n/ 〉/ min/ +/ 1/ ./ 它/ 是/ 在/ 最小/ 循环/ 次数/ min/ 上将/ 循环体/ 展开/ 所/ 组成/ 的/ 路径/ ./ 算法/ 2/ 是/ 基于/ SplitPATH/ 算法/ 扩展/ 的/ SplitLOOP/ 算法/ ./ 其中/ π/ ^/ unwind/ 通过/ 函数/ unwind/ (/ )/ 计算/ 将/ 抽象/ 反例/ 展开/ ,/ 并/ 通过/ SplitPATH/ 算法/ 来/ 确认/ 循环/ 反例/ 的/ 有效性/ ./ Page10/ 算法/ 2/ ./ SplitLOOP/ 算法/ ./ 输入/ :/ 带环/ 的/ 抽象/ 套索/ 反例/ 输出/ :/ 上/ 一个/ 可/ 达/ 具体/ 状态/ Sprev/ ,/ 失效/ 状态/ 的/ 索引/ 点/ kBEGINmin/ =/ Min/ {/ |/ h/ -/ 1s/ ^/ i/ +/ 1/ |/ ,/ …/ ,/ |/ h/ -/ 1s/ ^/ n/ |/ }/ ;/ π/ ^/ unwind/ ·/ ·/ =/ unwind/ (/ π/ ^/ ,/ min/ +/ 1/ )/ ;/ computejandSprevasinSplitPATH/ (/ π/ ^/ unwind/ )/ ;/ k/ ·/ ·/ =/ LoopIndex/ (/ j/ )/ ;/ p/ ·/ ·/ =/ LoopIndex/ (/ j/ +/ 1/ )/ ;/ outputSprev/ ,/ k/ ,/ pEND/ 函数/ LoopIndex/ (/ j/ )/ 计算/ 循环/ 反例/ 被/ 展开/ 后/ π/ ^/ unwind/ 在/ 位置/ j/ 上/ 抽象/ 状态/ 的/ 索引/ ./ 当/ j/ / n/ 时/ ,/ LoopIndex/ 函数/ 计算/ LoopIndex/ (/ j/ )/ ;/ 当/ j/ >/ n/ 时/ ,/ LoopIndex/ 函数/ 计算/ LoopIndex/ (/ [/ (/ j/ -/ (/ i/ +/ 1/ )/ )/ mod/ (/ n/ -/ i/ )/ ]/ +/ (/ i/ +/ 1/ )/ )/ ./ 如果/ 抽象/ 反例/ 为/ 伪/ 反例/ ,/ SplitLOOP/ 算法/ 输出/ Sprev/ 和/ 标记/ k/ ,/ p/ 并且/ 满足/ 以下/ 条件/ :/ (/ 1/ )/ 所有/ Sprev/ 中/ 的/ 状态/ 都/ 对应/ s/ ^/ p/ 抽象/ 状态/ ,/ 即/ (/ 2/ )/ 所有/ Sprev/ 中/ 的/ 状态/ 从/ 初始/ 可达集/ S1/ =/ (/ 3/ )/ 假如/ k/ 是/ 循环/ 索引/ p/ 的/ 后继/ ./ 当/ p/ =/ n/ 时/ ,/ (/ 4/ )/ 如果/ 没有/ 从/ 可达/ 状态/ 集/ Sprev/ 到/ h/ -/ 1/ (/ s/ ^/ k/ )/ 的/ Sprev/ / h/ -/ 1/ (/ s/ ^/ p/ )/ ./ h/ -/ 1/ (/ s/ ^/ 1/ )/ ∩/ I/ 出发/ 都/ 是/ 可达/ 的/ ./ k/ =/ i/ +/ 1/ ,/ 否则/ k/ =/ p/ -/ 1/ ./ 迁移/ ,/ 那么/ Img/ (/ Sprev/ ,/ T/ )/ ∩/ h/ -/ 1/ (/ s/ ^/ k/ )/ =/ / ./ h/ -/ 1/ (/ π/ ^/ unwind/ )/ ≠/ / ./ (/ 5/ )/ s/ ^/ p/ 是/ 一个/ 带环/ 的/ 失效/ 状态/ ./ 定理/ 2/ ./ π/ ^/ 是/ 有效/ 的/ 循环/ 反例/ ,/ 当且/ 仅/ 当/ 证明/ ./ 首先/ ,/ 根据/ 迁移/ 函数/ T/ 的/ 迁移/ 关系/ ,/ 将/ 抽象/ 模型/ 上/ 的/ 循环/ 反例/ 映射/ 为/ 具体/ 模型/ 上/ 的/ 路径/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ =/ 〈/ a1/ ,/ …/ ,/ ai/ ,/ b1n/ 〉/ ,/ 该/ 反例/ 路径/ 满足/ :/ (/ 1/ )/ / j/ :/ [/ 1/ ,/ i/ ]/ ·/ aj/ ∈/ bmin/ +/ 1h/ -/ 1/ (/ s/ ^/ j/ )/ ;/ (/ 2/ )/ / (/ j/ ,/ k/ )/ :/ [/ i/ +/ 1/ ,/ n/ ]/ ×/ [/ 1/ ,/ min/ +/ 1/ ]/ ·/ bkh/ -/ 1/ (/ s/ ^/ j/ )/ ./ 设/ 函数/ succ/ (/ )/ 表示/ 后继/ ,/ 例如/ 当/ 1/ / j/ </ n/ 时/ succ/ (/ j/ )/ =/ j/ +/ 1/ ,/ 当/ j/ =/ n/ 时/ ,/ succ/ (/ j/ )/ =/ i/ +/ 1/ ./ 路径/ 长度/ L/ ·/ ·/ =/ i/ +/ (/ min/ +/ 1/ )/ ×/ (/ n/ -/ i/ )/ ./ 可/ 将/ 具体/ 模型/ 路径/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ 改写/ 为/ path/ =/ 〈/ d1/ …/ dL/ 〉/ ,/ 其/ 满足/ (/ 1/ )/ d1/ ∈/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ;/ (/ 2/ )/ 对于/ 每个/ j/ </ L/ ,/ 如果/ dj/ =/ h/ -/ 1/ (/ s/ ^/ k/ )/ ,/ 那么/ dj/ +/ 1/ =/ h/ -/ 1/ (/ s/ ^/ succ/ (/ k/ )/ )/ ,/ succ/ (/ k/ )/ 表示/ k/ 的/ 后继/ ./ 其次/ ,/ 证明/ 循环/ 反例/ π/ ^/ 是/ 有效/ 的/ / h/ -/ 1/ (/ π/ ^/ unwind/ )/ ≠/ 假设/ 具体/ 模型/ 存在/ 反例/ ,/ 一旦/ 反例/ 包含/ 循环/ / ./ 体/ ,/ 那么/ 存在/ 一个/ 无限/ 的/ 路径/ ,/ 标记/ 为/ I/ -/ Path/ =/ 〈/ c1/ ,/ c2/ ,/ …/ 〉/ 满足/ c1/ ∈/ h/ -/ 1/ (/ s/ ^/ 1/ )/ ,/ 对于/ 所有/ j/ ,/ 如果/ cj/ =/ h/ -/ 1/ (/ s/ ^/ k/ )/ ,/ 那么/ cj/ +/ 1/ =/ h/ -/ 1/ (/ s/ ^/ succ/ (/ k/ )/ )/ ./ 根据/ 上文/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ 改写/ 为/ path/ =/ 〈/ c1/ …/ cL/ 〉/ ,/ 那么/ I/ -/ Path/ 的/ 有限/ 前缀/ 满足/ path/ 路径/ 表达/ 必然/ 被/ 包括/ 在/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ 中/ ,/ 因此/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ ≠/ / ./ 最后/ ,/ 证明/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ ≠/ / / 循环/ 反例/ π/ ^/ 是/ 有效/ 的/ ./ 假设/ h/ -/ 1/ (/ π/ ^/ unwind/ )/ ≠/ / ,/ 存在/ 一个/ 状态/ 在/ 路径/ 上/ 至少/ 出现/ 2/ 次/ [/ 26/ ]/ ,/ 那么/ 必然/ 存在/ c/ α/ ,/ c/ β/ 满足/ c/ α/ =/ c/ β/ ./ 由于/ 状态/ 重复/ 出现/ ,/ 存在/ 一条/ 迁移/ 关系/ T/ (/ c/ β/ -/ 1/ ,/ c/ α/ )/ ,/ 使得/ 循环/ 存在/ 于/ c/ α/ 和/ c/ β/ -/ 1/ 之间/ ,/ 即/ 〈/ c1/ ,/ …/ ,/ c/ α/ -/ 1/ 〉/ 〈/ c/ α/ ,/ c/ β/ -/ 1/ 〉/ w/ 反例/ 路径/ 也/ 满足/ 具体/ 模型/ ./ 因此/ ,/ 定理/ 2/ 得证/ ./ 3.3/ 抽象/ 模型/ 精化/ 由于/ 坏/ 状态/ SB/ 和/ 死/ 状态/ SD/ 同时/ 映射/ 到/ 同一/ 抽象/ 状态/ 中/ ,/ 使得/ 抽象/ 模型/ 上/ 的/ 抽象/ 反例/ 无法/ 在/ 具体/ 模型/ 上/ 找到/ 具体/ 反例/ ./ 精化/ 的/ 作用/ 是/ 对/ 抽象/ 模型/ 进行/ 变换/ 以/ 消除/ 已经/ 发现/ 的/ 伪/ 反例/ ./ 若/ 抽象/ 模型/ 过于/ 粗糙/ ,/ 则/ 可能/ 无法/ 证明/ 给定/ 属性/ ;/ 而/ 若/ 抽象/ 模型/ 过于/ 精细/ ,/ 则/ 将/ 增加/ 对/ 空间/ 的/ 需求/ ./ 因此/ ,/ 如何/ 控制/ 抽象/ 的/ 精确/ 程度/ ,/ 构造/ 一个/ 尽可能/ 紧凑/ 又/ 能够/ 验证/ 给定/ 属性/ 的/ 抽象/ 模型/ ,/ 在/ 效率/ 和/ 功能/ 之间/ 求得/ 平衡/ [/ 24/ ,/ 27/ -/ 28/ ]/ ,/ 是/ 精化/ 面临/ 的/ 最大/ 挑战/ ./ 本文/ 消除/ 伪/ 反例/ 的/ 方式/ 是/ 通过/ 精化/ 抽象/ 函数/ 来/ 消除/ 失效/ 状态/ ./ 设/ R1/ 和/ R2/ 是/ 状态/ 集/ S/ 上/ 的/ 两个/ 等价关系/ (/ / )/ ,/ 称/ R2/ 是/ R1/ 的/ 精化/ ,/ 当且/ 仅/ 当/ ,/ / s1/ ,/ s2/ :/ S/ ·/ (/ (/ s1/ ,/ s2/ )/ ∈/ R2/ →/ (/ s1/ ,/ s2/ )/ ∈/ R1/ )/ ./ 定义/ 8/ ./ 抽象/ 模型/ 精化/ ./ 给定/ 一个/ 导航/ 模型/ M/ =/ (/ S/ ,/ I/ ,/ AP/ ,/ L/ ,/ T/ )/ 以及/ 抽象/ 函数/ h/ ./ 令/ 抽象/ 函数/ h/ 是/ 抽象/ 函数/ h/ 的/ 精化/ ,/ 满足/ 如下/ 约束/ :/ (/ 1/ )/ 对于/ / s1/ ,/ s2/ :/ S/ 满足/ (/ h/ (/ s1/ )/ =/ h/ (/ s2/ )/ )/ →/ (/ h/ (/ s1/ )/ =/ h/ (/ s2/ )/ )/ ./ (/ 2/ )/ 对于/ / s1/ ,/ s2/ :/ S/ 满足/ h/ (/ s1/ )/ =/ h/ (/ s2/ )/ 同时/ 也/ 满足/ h/ (/ s1/ )/ ≠/ h/ (/ s2/ )/ ./ (/ 3/ )/ 对于/ / s/ :/ SB/ ,/ / s/ :/ SD/ 满足/ h/ (/ s/ )/ ≠/ h/ (/ s/ )/ ./ 伪/ 反例/ π/ ^/ 产生/ 的/ 原因/ 之一/ 是/ 坏/ 状态/ SB/ ≠/ / ./ 为了/ 使/ 死/ 状态/ SB/ 和/ 坏/ 状态/ SD/ 分离/ 在/ 不同/ 的/ 抽象/ 状态/ 中/ ,/ 定义/ 一个/ 精化/ 的/ 等价关系/ R/ 用于/ 处理/ 失效/ 状态/ s/ ^/ f/ :/ / s1/ ,/ s2/ :/ s/ ^/ f/ ·/ (/ (/ s1/ ,/ s2/ )/ ∈/ R/ / (/ / s1/ ,/ s2/ :/ s/ ^/ f/ +/ 1/ ·/ (/ s1/ ,/ s1/ )/ ∈/ T/ ^/ ∧/ (/ s2/ ,/ s2/ )/ ∈/ T/ ^/ )/ ∨/ (/ / s/ :/ s/ ^/ f/ +/ 1/ ·/ (/ s1/ ,/ s/ )/ / T/ ^/ ∧/ (/ s2/ ,/ s/ )/ / T/ ^/ )/ ,/ 即/ s/ ^/ f/ 中/ 的/ 两个/ 状态/ s1/ ,/ s2/ 具有/ 等价关系/ 当且/ 仅/ 当/ s1/ ,/ s2/ 同时/ 都/ 有/ 到/ s/ ^/ f/ +/ 1/ 的/ 具体/ 状态/ 的/ 迁移/ 或者/ 都/ 没有/ 迁/ Page11/ 移/ ,/ 因此/ R/ 将/ s/ ^/ f/ 划分/ 为/ 两个/ 等价/ 类/ s/ ^/ 1/ (/ SI/ ∪/ SD/ )/ ./ 算法/ 3/ ./ 抽象/ 模型/ 的/ 精化/ 算法/ ./ 输入/ :/ 一个/ 抽象/ 模型/ 以及/ 一个/ 伪/ 反例/ 输出/ :/ 输出/ 一个/ 精化/ 后/ 的/ 抽象/ 模型/ BEGINFOREACHi/ ·/ ·/ =/ 1TOmENDFOREACHEND/ 算法/ 3/ 是/ 抽象/ 模型/ 精化/ 的/ 具体/ 算法/ ./ 算法/ 中/ Sf/ 是/ 根据/ 反例/ 确认/ 算法/ 识别/ 伪/ 反例/ 路径/ 上/ 的/ 失效/ 状态/ ,/ 处理过程/ 使得/ Sf/ 中/ 的/ SD/ 和/ SB/ 得以/ 区分/ ./ 为了/ 识别/ 哪些/ 状态/ 属于/ SD/ ,/ 哪些/ 状态/ 属于/ SB/ ,/ 首先/ 令/ spre/ ∈/ h/ -/ 1/ (/ s/ ^/ i/ -/ 1/ )/ 表示/ Sf/ 前/ 一/ 状态/ ,/ 令/ snext/ ∈/ h/ -/ 1/ (/ s/ ^/ i/ +/ 1/ )/ 是/ Sf/ 的/ 后/ 一/ 状态/ 的/ ./ 接着/ 对/ 每/ 一个/ Sf/ 中/ 的/ 状态/ 进行/ 判断/ ,/ 将/ 属于/ SD/ 或/ SI/ 的/ 状态/ 映射/ 到/ s/ ^/ 1/ 映射/ 到/ s/ ^/ 23/ 种/ 情况/ 进行/ 处理/ :/ (/ 1/ )/ 当/ (/ spre/ ,/ sj/ )/ ∈/ T/ ∧/ (/ sj/ ,/ snext/ )/ / T/ 时/ ,/ 表明/ 当前/ 抽象/ 状态/ 的/ 具体/ 状态/ sj/ 是/ 一个/ 死/ 状态/ ,/ 将/ 其/ 映射/ 到/ 抽象/ 状态/ s/ ^/ 1snext/ )/ / T/ 时/ ,/ 表明/ 当前/ 抽象/ 状态/ 的/ 具体/ 状态/ sj/ 是/ 一个/ 无关/ 状态/ ,/ 将/ 其/ 映射/ 到/ 抽象/ 状态/ s/ ^/ 1sj/ )/ / T/ ∧/ (/ sj/ ,/ snext/ )/ ∈/ T/ 时/ ,/ 表明/ 当前/ 抽象/ 状态/ 的/ 具体/ 状态/ sj/ 是/ 一个/ 坏/ 状态/ ,/ 将/ 其/ 映射/ 到/ 抽象/ 状态/ s/ ^/ 2/ 如图/ 7/ 所示/ ,/ 是/ 对/ 图/ 5/ 发现/ 的/ 伪/ 反例/ 所/ 进行/ 的/ 精化/ ./ 图/ 5/ 产生/ 伪/ 反例/ 的/ 原因/ 是/ 状态/ P3/ (/ 01/ )/ 和/ P3/ (/ 00/ )/ 被/ 合并/ 为/ 同一/ 抽象/ 状态/ P/ ^/ 3/ ./ 根据/ 算法/ 3/ 的/ 精化/ 算法/ ,/ 精化/ 后/ 的/ 结果/ 是/ 分别/ 将/ 坏/ 状态/ P3/ (/ 01/ )/ 和/ 死/ 状态/ P3/ (/ 00/ )/ 映射/ 到/ 抽象/ 状态/ P/ ^/ 31/ 和/ P/ ^/ 32/ 以/ 消除/ 伪/ 反例/ ./ 对/ 当前/ On/ -/ the/ -/ fly/ 导航/ 模型/ Mi/ 进行/ 精化/ 完毕/ 后/ ,/ 需/ 再次/ 检验/ 性质/ 是否/ 在/ 新/ 的/ 抽象/ 模型/ 里/ 得到/ 满足/ ./ 如果/ 仍/ 存在/ 伪/ 反例/ ,/ 则/ 再次/ 精化/ 抽象/ 函数/ 得到/ 精化/ 模型/ ./ 迭代/ 这一/ 过程/ ,/ 直至/ 不再/ 出现/ 伪/ 反例/ 为止/ ./ 4/ 实验/ 与/ 分析/ 在/ 本文/ Web/ 应用/ 的/ 导航/ 模型/ 验证/ 中/ ,/ 安全性/ 性质/ 主要/ 涉及/ 数据/ 私密性/ 确保/ 授权/ 用户/ 的/ 数据/ 权限/ ,/ Cache/ 可/ 缓存/ 性/ 实现/ 了/ 正确/ 的/ 业务/ 逻辑/ ,/ 即/ 导航/ 行为/ 不/ 存在/ 用户/ 对/ SCR/ 页面/ 的/ 非法/ 访问/ ./ 安全性/ 采用/ AG/ (/ / )/ 形式/ 描述/ 所谓/ 的/ “/ 坏/ 的/ 事情/ 不会/ 发生/ ”/ ,/ 旨在/ 限制/ 用户/ 通过/ 点击/ 浏览器/ 按钮/ 从/ 非/ 安全/ 敏感区/ No/ -/ SCR/ 直接/ 到达/ 安全/ 敏感区/ SCR/ ./ 采用/ 点/ 覆盖/ 准则/ 产生/ 检验/ 性质/ ,/ 其中/ / =/ / (/ p/ →/ (/ back/ ∨/ forward/ ∧/ AX/ (/ p1/ ∨/ …/ ∨/ pn/ )/ )/ )/ 用/ 陷阱/ 性质/ [/ 17/ ]/ 描述/ ,/ 表示/ No/ -/ SCR/ 区域/ 页面/ 不能/ 通过/ back/ 或/ forward/ 按钮/ 直接/ 进入/ 并/ 访问/ SCR/ 区域/ 页面/ ,/ p/ ∈/ S/ 是/ No/ -/ SCR/ 区域/ 页面/ ,/ pi/ ∈/ S/ 是/ SCR/ 区域/ 页面/ ./ 以图/ 1/ (/ a/ )/ 所示/ 审计/ 管理系统/ 为例/ ,/ 得/ 如下/ 以/ ACTL/ / 描述/ 的/ 安全性/ 性质/ ./ P4/ ∨/ P5/ ∨/ P7/ )/ )/ )/ ./ 性质/ 1/ ./ AG/ / (/ P1/ →/ (/ back/ ∨/ forward/ ∧/ AX/ (/ P3/ ∨/ 性质/ 2/ ./ AG/ / (/ P2/ →/ (/ back/ ∨/ forward/ ∧/ AX/ (/ P3/ ∨/ P4/ ∨/ P5/ ∨/ P7/ )/ )/ )/ ./ 性质/ 3/ ./ AG/ / (/ P6/ →/ (/ back/ ∨/ forward/ ∧/ AX/ (/ P3/ ∨/ P4/ ∨/ P5/ ∨/ P7/ )/ )/ )/ ./ 将/ 本文/ 方法/ 应用/ 于/ On/ -/ the/ -/ fly/ 导航/ 模型/ 实例/ 中/ ,/ 预先/ 植入/ 了/ 两类/ 错误/ 导航/ 关系/ :/ 一类/ 是/ 用于/ SCR/ 区域/ 安全性/ 检验/ ,/ 构造/ 不/ 安全/ 的/ Session/ 数据/ 控制/ 逻辑/ ,/ 允许/ 用户/ 从/ No/ -/ SCR/ 区域/ 进入/ SCR/ 区域/ ;/ 另一类/ 则/ 刻意/ 去/ 减少/ 一些/ 功能/ 页面/ ,/ 以/ 造成/ 正常/ 功能/ 的/ 不可/ 达/ ./ 为了/ 实验/ 分析/ 本文/ 所述/ 方法/ 的/ 错误/ Page12/ 发现/ 能力/ ,/ 基于/ 图/ 1/ 审计/ 管理系统/ 的/ 实例/ ,/ 在/ SCR/ 区域/ 内/ 增加/ 了/ 多个/ 复杂/ 的/ 业务/ 逻辑/ 与/ No/ -/ SCR/ 区域/ 页面/ 交互/ ./ 如果/ 模型/ 检验/ 工具/ NuSMV/ 返回/ False/ 检验/ 结果/ ,/ 说明/ 抽象/ 模型/ 中/ 存在/ 反例/ ./ 根据/ 本文/ OTF/ -/ MC/ -/ CEGAR/ 方法/ 确认/ 反例/ 的/ 真伪/ ,/ 从而/ 检验/ Web/ 应用/ 模型/ 是否/ 存在/ 安全性/ 问题/ ./ 随着/ On/ -/ the/ -/ fly/ 模型/ 的/ 展开/ ,/ 抽象/ 精化/ 验证/ 也/ 同时/ 进行/ ,/ 并且/ 分别/ 记录/ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 页面/ 数/ (/ #/ S/ )/ 、/ 可能/ 模型/ 状态/ 大小/ (/ #/ PS/ )/ 、/ 抽象/ 模型/ 大小/ (/ #/ AS/ )/ 、/ 迁移/ 数/ (/ #/ R/ )/ 、/ 查找/ 到/ 第一个/ 反例/ 的/ 时间/ (/ #/ T/ ,/ 单位/ 为/ ms/ )/ 、/ 精化/ 后/ 的/ 模型/ 大小/ (/ #/ RS/ )/ 、/ 精化/ 后/ 的/ 迁移/ 数/ (/ #/ RR/ )/ 等/ 参数/ ./ 模型/ 状态/ 大小/ #/ PS/ 是/ 参加/ 交互/ 的/ 页面/ 数/ #/ S/ 的/ 4/ 倍/ ,/ 这/ 是/ 由/ 前进/ // 后退/ 按钮/ 决定/ ./ 检验/ 结果/ (/ #/ O/ )/ 则/ 用于/ 表明/ Web/ 应用/ 导航/ 模型/ 是否/ 符合/ 安全性/ 性质/ ,/ 输出/ No/ 表明/ 不/ 存在/ 安全性/ 性质/ 的/ 反例/ ,/ 输出/ Yes/ 表明/ 存在/ 安全性/ 性质/ 的/ 反例/ ./ 对比/ 精化/ 后/ 的/ 模型/ 大小/ #/ RS/ 和/ 抽象/ 状态/ #/ AS/ ,/ 可知/ 是否/ 存在/ 伪/ 反例/ ./ ID/ #/ S/ #/ PS/ #/ AS/ #/ R/ #/ T/ #/ RS/ #/ RR/ #/ OInitial141/ —/ —/ 1/ —/ —/ 141635/ </ 0.135/ No28325140/ ./ 49616Yes313528253/ ./ 221031Yes430120173212/ ./ 51732No550200315834/ ./ 94266Yes67028054120127/ ./ 059129Yes712048076138432/ ./ 081142Yes/ 表/ 2/ 展示/ 的/ 是/ 本文/ OTF/ -/ MC/ -/ CEGAR/ 方法/ 在/ 实际/ Web/ 应用/ 导航/ 模型/ 验证/ 所/ 得到/ 的/ 实验/ 数据/ ,/ 该/ Web/ 应用/ 的/ 业务/ 逻辑/ 更加/ 复杂/ ./ 例如/ ID/ =/ 1/ 上/ 有/ 4/ 个/ 页面/ 参与/ ,/ 可能/ 的/ 16/ 个/ 模型/ 状态/ 被/ 抽象/ 为/ 3/ 个/ 抽象/ 状态/ ,/ 检验/ 结果表明/ 模型/ 不/ 存在/ 安全性/ 问题/ ./ 在/ ID/ =/ 5/ 上/ 有/ 50/ 个/ 页面/ 参与/ ,/ 可能/ 的/ 200/ 个/ 模型/ 状态/ 被/ 抽象/ 为/ 31/ 个/ 抽象/ 状态/ ,/ 由于/ 伪/ 反例/ 存在/ 并/ 被/ 精/ 化为/ 42/ 个/ 抽象/ 状态/ ,/ 检验/ 结果表明/ 模型/ 存在/ 安全性/ 问题/ ./ 依据/ 表/ 2/ ,/ 可以/ 得出/ 以下/ 结论/ :/ (/ 1/ )/ 每次/ 对/ 抽象/ 模型/ 验证/ 后/ ,/ 通过/ 消除/ 伪/ 反例/ 得到/ 的/ 精化/ 模型/ ,/ 在/ 下次/ On/ -/ the/ -/ fly/ 导航/ 模型/ 的/ 抽象/ 中/ ,/ 只要/ 增量/ 式/ 的/ 进行/ 抽象/ 即可/ ,/ 这样/ 可以/ 提高/ 抽象/ 算法/ 的/ 效率/ 和/ 减少/ 内存/ 消耗/ ./ (/ 2/ )/ 精化/ 的/ 模型/ 由于/ 抽象/ 状态/ 必须/ 在/ 满足/ 不/ 出现/ 伪/ 反例/ 的/ 情况/ 下/ 进行/ 等价/ 划分/ ,/ 因此/ 精化/ 后/ 的/ 模型/ 不但/ 抽象/ 状态/ 增加/ ,/ 而且/ 抽象/ 状态/ 之间/ 迁移/ 也/ 随之/ 增加/ ./ (/ 3/ )/ 采用/ OTF/ -/ MC/ -/ CEGAR/ 方法/ 在/ 初始/ 的/ 几个/ 抽象/ 状态/ 和/ 迁移/ 中/ ,/ 性质/ 检验/ 的/ 效率/ 与/ 一般/ 的/ 模型/ 检验/ 方法/ 没有/ 大/ 的/ 区别/ ./ 但是/ 随着/ 状态/ 的/ 增加/ ,/ 我们/ 发现/ OTF/ -/ MC/ -/ CEGAR/ 更/ 适合/ 于/ 复杂/ 状态/ 建模/ 和/ 验证/ ,/ 如/ ID/ =/ 6/ 和/ ID/ =/ 7/ 情况/ 下/ ,/ 不仅/ 状态/ 大量/ 减少/ ,/ 而且/ 验证/ 的/ 效率/ 大大提高/ ./ 接着/ ,/ 进行/ 对比/ 实验/ ./ 以/ 审计/ 管理系统/ 的/ Web/ 应用/ 检验/ 为例/ ,/ 在/ 图/ 1/ (/ a/ )/ 系统/ 的/ 基础/ 上/ 开发/ 了/ 几个/ 新/ 模块/ ,/ 包括/ 银行/ 对/ 账单/ 模块/ 、/ 邮件系统/ 模块/ 、/ 第三方/ 支付/ 模块/ 等/ ,/ 他们/ 之间/ 含有/ 不同/ 的/ 安全/ 敏感区/ SCR/ ./ 这些/ 页面/ 的/ 访问/ 都/ 需要/ 授权/ ,/ 即/ 不能/ 直接/ 通过/ 点击/ 浏览器/ 按钮/ 从/ 非/ 安全/ 敏感区/ No/ -/ SCR/ 直接/ 进入/ 安全/ 敏感区/ SCR/ ./ 经过/ 扩展/ 的/ Web/ 应用/ 系统/ 具有/ 复杂/ 的/ 用户/ 导航/ 行为/ 模型/ ,/ 因此/ ,/ 不断/ 增加/ 用户/ 访问/ Web/ 应用/ 的/ 请求/ 数/ 以及/ 访问/ 业务/ 逻辑/ 数/ ,/ 构造/ 导航/ 模型/ ,/ 分别/ 将/ 本文/ 的/ OTF/ -/ MC/ -/ CEGAR/ 方法/ 与/ 有序/ 二叉/ 决策/ 图/ (/ OrderedBinaryDecisionDiagrams/ ,/ OBDD/ )/ 方法/ 、/ 偏序/ 归约/ (/ PartialOrderReduction/ ,/ POR/ )/ 技术/ 方法/ 和/ 组合/ 推理/ (/ CompositionalReason/ -/ ing/ ,/ CR/ )/ 方法/ 在/ 不同/ 模型/ 大小/ (/ 分别/ 考察/ 50/ ,/ 100/ ,/ 200/ ,/ 300/ ,/ 500/ )/ 下/ 检验/ 安全性/ 性质/ ./ 表/ 3/ 给出/ 的/ 是/ 错误/ 发现/ 能力/ 的/ 对比/ 实验/ ,/ 其中/ #/ S/ 表示/ Web/ 应用/ 导航/ 模型/ 大小/ ,/ #/ C/ 表示/ 发现/ 的/ 反例/ 数目/ ./ 通过/ 表/ 3/ 可以/ 发现/ 本文/ 方法/ 比/ 其他/ 方法/ 在/ 模型/ 大小/ 比较/ 大/ 情况/ 下/ 具有/ 更强/ 的/ 错误/ 发现/ 能力/ ,/ 因为/ 基于/ On/ -/ the/ -/ fly/ 方式/ 的/ 抽象/ 方法/ 更/ 适合/ 于边/ 建模/ 边/ 验证/ 的/ 实现/ ,/ 在/ 模型/ 展开/ 过程/ 中/ ,/ 抽象/ 精化/ 循环/ 更/ 容易/ 发现/ 反例/ ./ 而/ 其他/ 方法/ 在/ 全局/ 空间/ 上/ 进行/ 约/ 减/ 和/ 抽象/ ,/ 有些/ 错误/ 被/ 隐藏/ 导致/ 其/ 错误/ 发现/ 能力/ 受限/ .#/ COBDD1119406173/ #/ CPOR1623254045/ #/ CCR2127303838/ #/ COTF/ -/ MC/ -/ CEGAR1939627986/ 为了/ 比较/ 发现错误/ 的/ 性能/ ,/ 在/ 不同/ 的/ 模型/ 大小/ 下/ ,/ 第/ 1/ 个/ 对比/ 实验/ 记录/ 发现/ 缺陷/ 所/ 消耗/ 的/ 时间/ ,/ 第/ 2/ 个/ 对比/ 实验/ 记录/ 发现/ 缺陷/ 所/ 消耗/ 的/ 内存/ ./ 预期/ 期望/ 是/ 在/ 不同/ 模型/ 大小/ 下/ ,/ 所/ 消耗/ 的/ 时间/ 越小越/ 好/ ,/ 所/ 消耗/ 的/ 内存/ 越少/ 越/ 好/ ./ 如图/ 8/ 和/ 图/ 9/ 所示/ ,/ 是/ 各种/ 方法/ 在/ 发现/ 反例/ 上/ 所/ 消耗/ 的/ 时间/ 和/ 内存/ 的/ 对比/ 实验/ 数据/ ./ 从/ 时间/ 消耗/ 上/ 来看/ ,/ 本文/ 方法/ 所/ 消耗/ 的/ 时间/ 介/ Page13/ 于/ 其他/ 3/ 种/ 方法/ 之间/ ./ 从/ 内存/ 消耗/ 上/ 来看/ ,/ 本文/ 方法/ 占/ 明显/ 优势/ ./ CR/ 方法/ 需/ 分别/ 建立/ Web/ 应用/ 中/ 各/ 模块/ 的/ 模型/ ,/ 并/ 通过/ 检验/ 各子/ 模型/ 的/ 性质/ 来/ 综合/ 推导/ 出/ 整体/ 模型/ 的/ 性质/ ,/ 因此/ ,/ 组合/ 和/ 推理/ 的/ 时间/ 消耗/ 相对/ 其他/ 3/ 种/ 方法/ 都/ 要/ 大/ ./ POR/ 方法/ 从/ 状态/ 之间/ 的/ 偏序/ 关系/ 进行/ 性质/ 检验/ ,/ 因此/ 效率/ 很/ 高/ (/ 时间/ 消耗/ 很少/ )/ ,/ 然而/ 由于/ POR/ 方法/ 在/ 内存/ 消耗/ 方面/ 比较/ 多/ ,/ 所以/ 维持/ 偏序/ 关系/ 的/ 算法/ 和/ 数据格式/ 的/ 存储/ 消耗/ 是/ 巨大/ 的/ ./ OBDD/ 方法/ 内存/ 消耗/ 相对/ 比较/ 少/ ,/ 但是/ 性质/ 检验/ 的/ 计算/ 时间/ 却/ 很/ 高/ ./ 采用/ On/ -/ the/ -/ fly/ 策略/ 不/ 需要/ 构造/ 全局/ 状态/ 空间/ ,/ 而/ 其他/ 方法/ 需在/ 全局/ 状态/ 模型/ 构造/ 出来/ 后/ 再/ 进行/ 约/ 减/ ,/ 因此/ ,/ 其他/ 方法/ 的/ 内存/ 需求量/ 比较/ 大/ ./ 当/ 模型/ 状态/ 大于/ 100/ 小于/ 300/ 时/ ,/ 本文/ 方法/ 的/ 内存/ 消耗/ 虽然/ 激增/ ,/ 但/ 相对/ 于/ 其他/ 3/ 种/ 方法/ 要少/ ;/ 当/ 模型/ 状态/ 大于/ 300/ 时/ ,/ 内存/ 消耗/ 的/ 增量/ 趋势/ 近于/ 平稳/ ./ 这/ 体现/ 了/ On/ -/ the/ -/ fly/ 方式/ 抽象/ 的/ 优势/ ,/ 值得注意/ 的/ 是/ ,/ 由于/ 抽象/ 可能/ 导致/ 一些/ 附加/ 行为/ 的/ 产生/ ,/ 而/ 这些/ 行为/ 可能/ 导致/ 伪/ 反例/ ./ 检验/ 这些/ 反例/ 的/ 真伪/ 性/ 消耗/ 了/ 部分/ 时间/ ,/ 但/ 相对而言/ 时间/ 消耗/ 还是/ 处于/ 可/ 接受/ 范围/ 之内/ ./ 5/ 相关/ 工作/ 由/ 模型/ 检验/ 器/ 输出/ 的/ 反例/ 能/ 表示/ 模型/ 违反/ 给定/ 检验/ 性质/ 的/ 行为/ 路径/ ./ Beyer/ 等/ 人/ [/ 29/ ]/ 扩展/ 模型/ 检验/ 器/ BLAST/ 从/ 反例/ 中/ 自动化/ 产生/ 测试/ 套件/ 并/ 将/ 该/ 方法/ 用于/ 检查/ C/ 程序/ 的/ 死锁/ 代码/ 位置/ 点/ ./ 为了/ 实现/ 在/ 系统/ 层面/ 对/ 未/ 覆盖/ 分支/ 的/ 可/ 覆盖性/ 分析/ 和/ 测试用例/ 的/ 产生/ ,/ Fantechi/ 等/ 人/ [/ 30/ ]/ 采用/ 回溯/ 算法/ 解析/ 模型/ 检验/ 器/ 输出/ 的/ 反例/ 以/ 增强/ 测试/ 覆盖/ ,/ 利用/ 组合/ 性/ 处理/ 实际/ 应用程序/ 状态/ 空间/ 大/ 的/ 特性/ ./ Stefan/ 等/ 人/ [/ 31/ ]/ 提出/ 了/ 一种/ 基于/ 反例/ 解释/ 的/ 异常/ 检测/ 方法/ 通过/ 对比/ 反例/ 和/ 正确/ 迹/ (/ 无/ 死锁/ )/ ,/ 抽取/ 出/ 动作/ 序列/ 用于/ 帮助/ 模型/ 设计/ 人员/ 定位/ 死锁/ 出现/ 的/ 原因/ ./ 目前/ ,/ 通过/ 解析/ 反例/ 可/ 得到/ 测试/ 序列/ 和/ 测试用例/ 实例/ 化/ ,/ 因此/ 研究/ 反例/ 可/ 用于/ 软件测试/ 、/ 故障/ 定位/ 和/ 分析/ 等/ 工作/ ./ 基于/ 模型/ 的/ 抽象/ 对于/ 理解/ 现实/ 系统/ 的/ 行为/ 至关重要/ ./ 因为/ 对于/ 复杂/ 系统/ 模型/ 而言/ ,/ 模型/ 的/ 检验/ 以及/ 反例/ 的/ 输出/ 都/ 非常/ 困难/ ,/ 需要/ 抽象/ 技术/ 将/ 一组/ 行为/ 等价/ 或/ 相似/ 的/ 动作/ 或/ 状态/ 进行/ 合并/ 从而/ 产生/ 较/ 小/ 的/ 行为/ 模型/ ./ 在/ 抽象/ 应用/ 方面/ ,/ Dams/ 等/ 人/ [/ 32/ ]/ 将/ 抽象/ 技术/ 扩展/ 到/ PI/ 演算/ 方面/ ./ Saidi/ 和/ Shankar/ [/ 33/ ]/ 将/ 谓词/ 抽象/ 集成/ 到/ PVS/ 系统/ 中/ ,/ 该/ 方法/ 有利于/ 确定/ 模型/ 何时/ 进行/ 抽象/ 以及/ 何时/ 进行/ 性质/ 检验/ ./ Henzinger/ 等/ 人/ [/ 34/ ]/ 提出/ 了/ 基于/ 威胁/ 驱动/ 的/ 抽象/ 方法/ ,/ 它/ 是/ 一种/ 懒惰/ 抽象/ 技术/ ,/ 可/ 避免/ 对/ 无关/ 状态/ 进行/ 计算/ ./ 同样/ ,/ 模型/ 检验/ 工具/ BLAST/ 在/ 模型/ 构造/ 、/ 检验/ 、/ 求精/ 的/ 循环/ 中/ 也/ 采用/ 懒惰/ 抽象/ 技术/ ,/ 使得/ 模型/ 检验/ 效率/ 得以/ 提高/ ./ 赵会群/ 等/ 人/ [/ 35/ ]/ 提出/ 了/ 一种/ 基于/ 网构/ 软件/ 代数/ 模型/ 的/ 可达性/ 检测/ 方法/ ,/ 把/ 线性相关/ 的/ 网构/ 进行/ 压缩/ ,/ 从而/ 有效/ 地/ 抑制/ 状态/ 的/ 增长/ ,/ 但/ 该/ 方法/ 实现/ 比较/ 困难/ ./ 何炎祥/ 等/ 人/ [/ 36/ ]/ 提出/ 一种/ 基于/ SMT/ 求解/ 器/ 的/ 路径/ 敏感/ 程序验证/ 方法/ ,/ 利用/ 最大/ 强/ 连通/ 分量/ 压缩/ 循环/ 路径/ ,/ 根据/ 目标/ 断言/ 对/ 控制流/ 图/ 进行/ 切片/ ,/ 使用/ 一种/ 布尔/ 表达式/ 方法/ 对/ 路径/ 空间/ 进行/ 抽象/ ,/ 结合/ 抽象/ 解释/ 和/ 符号执行/ 技术/ 对/ 路径/ 进行/ 验证/ ./ 然而/ ,/ 由于/ 抽象/ 过程/ 中/ 会/ 引入/ 一些/ 额外/ 的/ 行为/ ,/ 导致/ 抽象/ 模型/ 上/ 产生/ 的/ 反例/ 存在/ 真实性/ ./ 在/ 抽象/ 伪/ 反例/ 处理/ 方面/ ,/ Kurshan/ 等/ 人/ [/ 19/ ]/ 采用/ 局部/ 约/ 减/ 方法/ 将/ 并发/ 系统/ 视为/ 连续/ 多个/ L/ -/ Process/ 所/ 组成/ ,/ 局部/ 约/ 减/ 方法/ 迭代/ 地/ 从/ 采用/ 变量/ 依赖图/ 描述/ 的/ 小/ 局部/ 开始/ ,/ 如果/ 发现/ 伪/ 反例/ ,/ 引入/ 一个/ 额外/ 的/ 变量/ 用来/ 消除/ 这一伪/ 反例/ ./ Kurshan/ 的/ 方法/ 需要/ 预知/ 各个/ 部件/ Page14Process/ 的/ 行为/ ,/ 而/ 在/ 实际/ 应用/ 中是/ 很/ 难/ 全面/ 获取/ Web/ 应用/ 的/ 行为/ 的/ ./ Lind/ -/ Nielsen/ 等/ 人/ [/ 20/ ]/ 设计/ 的/ 模型/ 检验/ 工具/ 使用/ 最小/ 和/ 最大/ 近似值/ 来/ 处理/ CTL/ ,/ 这种/ 近似值/ 技术/ 可以/ 避免/ 在/ 精/ 化步骤/ 后/ 重新/ 检验/ 整个/ 模型/ ./ 但/ 合理/ 选取/ 近似值/ 是/ 精化/ 迭代/ 次数/ 的/ 决定/ 因素/ ,/ 另外/ 一方面/ 考虑/ 到/ CTL/ 的/ 反例/ 是/ 树结构/ 反例/ ,/ 精化/ 路由/ 策略/ 是/ 发现/ 伪/ 反例/ 的/ 核心/ ,/ 也/ 是/ 最/ 耗时/ 的/ 一步/ ./ Govindaraju/ 和/ Dill/ [/ 21/ ]/ 给出/ 识别/ 抽象/ 反例/ 发现/ 的/ 第一个/ 伪/ 反例/ 的/ 方法/ ,/ 但/ 该/ 反例/ 与/ 搜索/ 策略/ 有关/ ./ 基于/ 存在/ 性/ 抽象/ 框架/ 扩展/ 的/ 反例/ 引导/ 的/ 抽象/ 精化/ 方法/ (/ CEGAR/ )/ [/ 11/ ,/ 13/ ]/ 已经/ 成为/ 解决/ 模型/ 检验/ 中/ 状态/ 爆炸/ 问题/ 的/ 重要/ 手段/ 和/ 技术/ ./ Aarts/ 等/ 人/ [/ 22/ ]/ 提出/ 了/ 一种/ 基于/ 反例/ 引导/ 的/ 抽象/ 精化/ 技术/ 用于/ 遗产/ 系统/ 行为/ 自动机/ 的/ 学习/ 和/ 构造/ ,/ 可/ 用于/ 检验/ 数据/ 参数/ 的/ 等价/ 性/ ./ Satpathy/ 等/ 人/ [/ 23/ ]/ 给出/ 了/ 一种/ 基于/ 抽象/ 精化/ 和/ 模型/ 检验/ 的/ 测试用例/ 产生/ 方法/ ,/ 通过/ 模型/ 检验/ 器/ 产生/ 反例/ 表示/ 测试用例/ ,/ 采用/ 符号执行/ 方法/ 检验/ 反例/ 真实性/ ,/ 从而/ 实现/ 规格/ 说明/ 的/ 覆盖/ 以及/ 获得/ 精确/ 的/ 覆盖/ 评估/ ./ Clarke/ 等/ 人/ [/ 24/ ]/ 提出/ 了/ 采用/ BDD/ 来/ 证明/ 抽象/ 模型/ ,/ 用/ SAT/ -/ Solvers/ 检验/ 反例/ 是否/ 为/ 伪/ 反例/ ,/ 同时/ 将/ 精化/ 方法/ 运用/ 抽象/ 框架/ 以/ 消除/ 伪/ 反例/ ./ Stepha/ -/ nie/ 等/ 人/ [/ 18/ ]/ 采用/ SAT/ 求解/ 器/ 扩展/ CEGAR/ 方法/ 处理/ 实时/ 系统/ 的/ 安全性/ 检验/ ,/ 提出/ 了/ 快速/ 处理/ 并行/ 组合/ 模型/ 的/ 抽象/ 方法/ ./ 虽然/ SAT/ 求解/ 速度/ 很快/ ,/ 但是/ 该/ 方法/ 处理/ 状态/ 时需/ 考虑/ 时钟/ 变量/ ,/ 因此/ ,/ 计算/ 量/ 比较/ 大且/ 难/ 应用/ 于/ 实际/ ./ 在/ 精化/ 的/ 控制/ 方面/ ,/ Das/ 等/ 人/ [/ 27/ ]/ 提出/ 一种/ 基于/ 需求/ 驱动/ 方式/ 的/ 抽象/ 构造方法/ ,/ 基于/ 反例/ 分析/ ,/ 通过/ 对/ 抽象/ 状态/ 迁移/ 关系/ 的/ 连续/ 逼近/ 实现/ 抽象/ 模型/ 的/ 逐步/ 精化/ ./ Clarke/ 等/ 人/ [/ 24/ ]/ 还/ 提及/ 了/ 采用/ ILP/ 和/ 机器/ 学习/ 的/ 方法/ 来/ 抽象/ 精化/ 大型/ 复杂/ 的/ 系统/ ,/ 特别/ 是/ 采用/ 机器/ 学习/ 的/ 方法/ 将/ 产生/ 伪/ 反例/ 的/ 失效/ 状态/ 进行/ 分隔/ ./ 但/ 该/ 方法/ 的/ 关键因素/ 是/ 如何/ 在/ 机器/ 学习/ 过程/ 中/ 设置/ 训练/ 值/ ,/ 它/ 与/ 精化/ 的/ 效果/ 直接/ 相关/ ./ 基于/ CEGAR/ 的/ 研究/ 正/ 逐渐/ 被/ 研究/ 人员/ 所/ 接受/ 并/ 应用/ 到/ 解决/ 实际/ 问题/ 中/ ./ 在/ CEGAR/ 应用/ 方面/ ,/ Wu/ 等/ 人/ [/ 28/ ]/ 提出/ 了/ 基于/ 反例/ 引导/ 的/ 插值/ 产生/ 算法/ ,/ 将互/ 模拟/ 和/ SAT/ 求解/ 器/ 应用/ 到/ 基于/ 重/ 解释/ 插值/ 的/ 模型/ 检验/ 过程/ 中/ ,/ 用于/ 产生/ 插值/ (/ Interpolation/ )/ ,/ 并/ 基于/ 伪/ 反例/ 来/ 防止/ 插值/ 被/ 过度/ 精化/ ./ 前置条件/ 对于/ 理解/ 、/ 验证/ 和/ 调试程序/ 非常/ 重要/ ./ Seghir/ 等/ 人/ [/ 37/ ]/ 扩展/ 了/ CEGAR/ 并/ 将/ 其/ 应用/ 到/ 自动化/ 前置条件/ 的/ 推理/ 中/ ,/ 同时/ 开发/ 了/ 工具/ P/ -/ Gen/ 用于/ 数组/ 程序/ 操作/ ./ 针对/ 多线程/ 布尔/ 程序/ 的/ 抽象/ 策略/ 问题/ ,/ 结合/ 谓词/ 抽象/ 和/ CEGAR/ 技术/ ,/ Donaldson/ 等/ 人/ [/ 38/ ]/ 提出/ 了/ 多线程/ 感知/ 的/ CEGAR/ 技术/ 并/ 开发/ 了/ 工具/ SymmPa/ 用于/ 共享/ 变量/ 并发程序/ 的/ 代码/ 分析/ ,/ 针对/ 程序/ 重复/ 结构/ 产生/ 布尔/ 程序/ 模板/ ,/ 对/ 其中/ 状态/ 爆炸/ 问题/ 采用/ 对称/ 技术/ 进行/ 简化/ ./ 当然/ ,/ CEGAR/ 也/ 可以/ 应用/ 到/ 多/ 学科/ 交叉/ 领域/ 之中/ ,/ 如大/ 数据/ 、/ 生物/ 计算/ 、/ 智能/ 交通/ 和/ 模式识别/ 等/ 方面/ ./ 目前/ ,/ 一些/ 学者/ 已经/ 开展/ 了/ 这些/ 方面/ 的/ 应用/ 研究/ ./ 此外/ ,/ 针对/ 概率/ 系统/ 的/ 验证/ 问题/ ,/ Rohit/ 等/ 人/ [/ 39/ ]/ 提出/ 适用/ 于/ 马尔科夫/ 检测/ 模型/ 的/ CEGAR/ 方法/ 框架/ ./ Hermanns/ 等/ 人/ [/ 40/ ]/ 提出/ 了/ 概率/ CEGAR/ 方法/ 检验/ 概率/ 可达性/ 性质/ ,/ 判断/ 到达/ 错误/ 状态/ 的/ 概率/ 是否/ 超过/ 给定/ 的/ 概率/ ./ 然而/ ,/ 概率/ 系统/ 的/ 建模/ 和/ 抽象/ 由于/ 引入/ 概率/ 计算/ 问题/ ,/ 复杂度/ 比较/ 高/ ,/ 尤其/ 是/ 概率/ 精度/ 的/ 控制/ ./ 目前/ 概率/ CEGAR/ 在/ 实际/ 应用/ 中未见/ 太多/ 的/ 研究/ ./ 6/ 总结/ 展望/ Web/ 应用/ 与/ 人们/ 的/ 生活/ 密切相关/ ,/ 是/ 用户/ 与/ 互联网/ 接触/ 的/ 桥梁/ 和/ 纽带/ ./ 在/ 信息/ 高度发达/ 的/ 当今社会/ ,/ 确保/ Web/ 应用/ 交互/ 行为/ 的/ 安全性/ 及其/ 所/ 提供/ 的/ 功能/ 的/ 可用性/ ,/ 是/ 可信/ Web/ 应用/ 研究/ 的/ 重点/ 和/ 难点/ ./ 对/ Web/ 应用/ 的/ 导航/ 模型/ 进行/ 形式化/ 验证/ 是/ 保证/ Web/ 设计/ 、/ 开发/ 、/ 实现/ 和/ 运行/ 的/ 重要/ 手段/ 和/ 前提/ 保障/ ./ 基于/ 模型/ 检验/ 的/ Web/ 应用/ 建模/ 与/ 验证/ 是/ 非常/ 有效/ 的/ 检验/ 技术/ 之一/ ,/ 但是/ 在/ 将/ 模型/ 检验/ 应用/ 于/ Web/ 应用/ 验证/ 过程/ 中/ 常常/ 存在/ 状态/ 爆炸/ 问题/ ./ 因此/ ,/ 迫切需要/ 一套/ 系统/ 的/ Web/ 应用/ 建模/ 和/ 验证/ 方法/ 并/ 能/ 有效/ 地/ 缓减/ 状态/ 爆炸/ 问题/ ./ 基于/ 以上/ 目的/ ,/ 本文/ 提出/ 了/ 基于/ On/ -/ the/ -/ fly/ 导航/ 模型/ 反例/ 引导/ 的/ 抽象/ 精化/ OTF/ -/ MC/ -/ CEGAR/ 方法/ ,/ 从/ Web/ 应用/ 的/ On/ -/ the/ -/ fly/ 建模/ 方法/ 出发/ ,/ 增量/ 式/ 抽象/ Web/ 应用/ 导航/ 模型/ ,/ 通过/ 性质/ 检验/ 确认/ 反例/ ,/ 并/ 及时/ 消除/ 伪/ 反例/ ,/ 从而/ 有效/ 地/ 缓解/ Web/ 应用/ 检验/ 过程/ 中/ 出现/ 的/ 状态/ 爆炸/ 问题/ ./ 在/ 进一步/ 研究/ 方面/ ,/ Web/ 应用/ 导航/ 行为/ 除了/ 本文/ 所/ 研究/ 的/ 替换/ 式/ 网页/ 模式/ 外/ ,/ 还/ 涉及/ 新窗口/ 打开/ 模式/ ,/ 以及/ Ajax/ 技术/ 实现/ 的/ 富/ 客户端/ 窗口/ 模式/ ./ 这些/ 复杂/ 模式/ 将/ 是/ 我们/ 下/ 一步/ 工作/ 的/ 重点/ ./ 此外/ ,/ 由于/ 时间/ 约束/ 和/ 概率/ 行为/ 极大/ 影响/ 着/ Web/ 应用/ 的/ 性能/ ,/ 我们/ 还/ 将/ 研究/ 基于/ 概率/ 的/ CEGAR/ 方法/ 在/ 定量/ Web/ 应用/ 验证/ 上/ 的/ 应用/ ,/ 从而/ 实现/ 对/ Web/ 应用/ 的/ 功能性/ 和/ 非/ 功能/ 检验/ ./ Page15/ 致谢/ 在/ 此/ ,/ 我们/ 向/ 对/ 本文/ 的/ 工作/ 给予/ 支持/ 和/ 建议/ 的/ 所有/ 同志/ 表示感谢/ ;/ 感谢/ 上海/ 高校/ 青年教师/ 培养/ 资助/ 计划/ 对/ 本文/ 工作/ 的/ 支持/ !/ 

