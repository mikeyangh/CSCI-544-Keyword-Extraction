Page1/ 基于/ 时间/ 自动机/ 的/ 物/ 联网/ 服务/ 建模/ 和/ 验证/ 李/ 力行/ 1/ )/ ,/ 2/ )/ 金芝/ 1/ )/ ,/ 3/ )/ 李戈/ 3/ )/ 1/ )/ (/ 中国科学院/ 数学/ 与/ 系统/ 科学/ 研究院/ 北京/ 100190/ )/ 2/ )/ (/ 中国科学院/ 研究生院/ 北京/ 100049/ )/ 3/ )/ (/ 高/ 可信/ 软件技术/ 教育部/ 重点/ 实验室/ (/ 北京大学/ )/ 北京/ 100871/ )/ 摘要/ 物/ 联网/ 服务/ 的/ 建模/ 和/ 验证/ 是/ 当前/ 物/ 联网/ 服务/ 提供/ 中/ 的/ 一个/ 重要/ 问题/ ./ 文中/ 将物/ 联网/ 服务/ 的/ 行为/ 建模/ 为/ 其/ 与/ 相关/ 环境/ 实体/ 的/ 交互/ ,/ 并/ 引入/ 环境/ 实体/ 以/ 刻画/ 物理/ 世界/ 各种/ 物体/ 的/ 属性/ 和/ 行为/ ,/ 从而/ 将物/ 联网/ 服务/ 能力/ 建模/ 为/ 它/ 能够/ 导致/ 的/ 环境/ 实体/ 发生/ 的/ 期望/ 变化/ ./ 文中/ 以/ 时间/ 自动机/ 为/ 建模/ 工具/ ,/ 分别/ 为/ 将要/ 监测/ 和/ 要/ 控制/ 的/ 物理/ 环境/ 实体/ 以及/ 不同/ 种类/ 的/ 物/ 联网/ 服务/ 独立/ 建模/ ,/ 以/ 表现/ 它们/ 的/ 独立性/ 和/ 自主性/ ./ 这些/ 时间/ 自动机/ 形成/ 一个/ 网络/ ,/ 刻画/ 完整/ 的/ 物/ 联网/ 服务/ 的/ 通信/ 并发/ 过程/ ,/ 物/ 联网/ 服务/ 的/ 实施/ 过程/ 表现/ 为/ 时间/ 自动机/ 网络/ 上/ 的/ 状态/ 变迁/ 通路/ ./ 最后/ ,/ 文中/ 提出/ 一组/ 物/ 联网/ 服务/ 要/ 满足/ 的/ 性质/ ,/ 并/ 利用/ 模型/ 检测工具/ UPPAAL/ 验证/ 物/ 联网/ 服务/ 的/ 正确性/ ./ 关键词/ 物/ 联网/ 服务/ ;/ 时间/ 自动机/ ;/ 环境/ 实体/ ;/ 服务/ 建模/ ;/ 模型/ 验证/ 1/ 引言/ 由/ MITAuto/ -/ IDCenter/ 于/ 1999/ 年/ 提出/ 的/ 物/ 联网/ (/ InternetofThings/ )/ [/ 1/ ]/ 通过/ 各种/ 信息/ 传感/ 设备/ ,/ 把/ 任何/ 物体/ 与/ 互联网/ 相连接/ ,/ 进行/ 实时/ 信息/ 交换/ 和/ 通信/ ,/ 实现/ 物与物/ 、/ 人与物/ 的/ 互联/ ,/ 以/ 达到/ 智能化/ 识别/ 、/ 定位/ 、/ 跟踪/ 、/ 监控/ 和/ 管理/ 的/ 目的/ ./ 它/ 被誉为/ 继/ 计算机/ 、/ 互联网/ 之后/ 的/ 第三次/ 信息技术/ 革命/ ./ 物/ 联网/ 的/ 相关/ 理论/ 和/ 技术/ 已/ 成为/ 当前/ 学术界/ 的/ 研究/ 热点/ ,/ 其中/ 一个/ 重要/ 的/ 研究/ 领域/ 是/ 物/ 联网/ 服务/ 的/ 按/ 需/ 提供/ ,/ 即/ 如何/ 根据/ 物/ 联网/ 物理/ 环境/ 的/ 动态变化/ ,/ 通过/ 组合/ 各种/ 异构/ 设备/ 上/ 的/ 基础/ 服务/ ,/ 提供/ 智能化/ 的/ 物/ 联网/ 服务/ ./ 目前/ ,/ 已有/ 工作/ 将/ 面向/ 服务/ 的/ 方法/ 应用/ 于物/ 联网/ 系统/ 的/ 构建/ 上/ ,/ 如/ 文献/ [/ 2/ -/ 8/ ]/ ./ 其/ 主要/ 贡献/ 之一/ 是/ 以/ 服务/ 的/ 形式/ 描述/ 设备/ 的/ 功能/ ./ 设备/ 服务/ 为物/ 联网/ 服务/ 的/ 部署/ 打下/ 了/ 很/ 好/ 的/ 基础/ ,/ 但是/ 要/ 实现/ 物/ 联网/ 服务/ 的/ 按/ 需/ 提供/ 仅/ 有/ 设备/ 服务/ 是/ 远远不够/ 的/ ./ 首先/ ,/ 物/ 联网/ 是/ 物理/ 世界/ 和/ 信息/ 世界/ 的/ 无缝/ 融合/ ,/ 物/ 联网/ 设备/ 直接/ 运行/ 于/ 物理/ 环境/ 中/ ,/ 物/ 联网/ 服务/ 不可避免/ 得/ 要/ 同/ 物理/ 环境/ 进行/ 直接/ 交互/ ./ 由于/ 物理/ 环境/ 的/ 连续/ 变化/ 性及/ 不确定性/ ,/ 对物/ 联网/ 服务/ 往往/ 有/ 较/ 高/ 的/ 实时性/ 、/ 动态性/ 、/ 可靠性/ 和/ 安全性/ 要求/ ./ 根据/ 不同/ 的/ 物理/ 环境/ ,/ 物/ 联网/ 服务/ 应/ 作出/ 相应/ 的/ 、/ 合适/ 的/ 反应/ ,/ 这种/ 服务/ 对/ 环境/ 的/ 感应性/ 和/ 适应性/ 是/ 物/ 联网/ 服务/ 按/ 需/ 提供/ 需要/ 关注/ 的/ 重点/ ./ 其次/ ,/ 时间/ 属性/ 在/ 物/ 联网/ 服务/ 按/ 需/ 提供/ 中是/ 重要/ 的/ 关注点/ 之一/ ./ 一方面/ ,/ 物/ 联网/ 服务/ 需要/ 关注/ 物理/ 世界/ 的/ 实时/ 状态/ ./ 各种/ 不同/ 类型/ 的/ 传感器/ 和/ 分布/ 广泛/ 的/ 传感器/ 网络/ ,/ 可以/ 实现/ 对/ 物理/ 世界/ 中/ 实体/ 的/ 实时/ 状态/ 获取/ 和/ 特定/ 行为/ 的/ 监控/ ,/ 如/ 二氧化碳/ 传感器/ 可以/ 监测/ 某一/ 区域/ 的/ 二氧化碳/ 浓度/ ,/ GPS/ 可以/ 实时/ 传送/ 车辆/ 的/ 位置/ 等/ ./ 传感器/ 按/ 一定/ 的/ 频率/ 周期性地/ 采集/ 环境/ 实时/ 信息/ ,/ 物/ 联网/ 服务/ 提供/ 也/ 应该/ 具有/ 与/ 时间/ 相关/ 的/ 行为/ ./ 另一方面/ ,/ 物/ 联网/ 的/ 很多/ 应用/ 场景/ 很多/ 情况/ 下/ 具有/ 及时/ 响应/ 性/ ,/ 如/ 火灾/ 发生/ 后/ ,/ 警报/ 的/ 及时/ 发送/ 和/ 相关/ 应急/ 设备/ 的/ 及时/ 响应/ ./ 要/ 刻画/ 这/ 类/ 特殊/ 应急/ 服务/ 的/ 行为/ ,/ 时间/ 属性/ 是/ 一个/ 重要/ 的/ 方面/ ./ 我们/ 提出/ 一种/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 建模/ 方法/ ./ 目的/ 是/ 在/ 物/ 联网/ 服务/ 建模/ 中/ 引入/ 服务/ 环境/ 的/ 描述/ ,/ 以/ 展示/ 物/ 联网/ 服务/ 与/ 服务/ 环境/ 的/ 适配/ 性/ ,/ 体现/ 根据/ 环境/ 场景/ 变化/ 的/ 服务/ 提供/ 的/ 效果/ ./ 更进一步/ 地/ ,/ 我们/ 以/ 时间/ 自动机/ 为/ 建模/ 工具/ 同时/ 为/ 物理/ 环境/ 和物/ 联网/ 服务/ 建模/ ,/ 可以/ 刻画出/ 物理/ 环境/ 和物/ 联网/ 服务/ 行为/ 的/ 时间/ 属性/ 和/ 时间/ 约束/ ,/ 在/ 此基础/ 上将/ 物理/ 环境/ 和物/ 联网/ 服务/ 一起/ 建模/ 为/ 时间/ 自动机/ 网络/ ./ 最后/ 借助/ UPPAAL/ 工具/ 验证/ 物/ 联网/ 服务/ 的/ 时效/ 正确性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 提出/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ ;/ 第/ 4/ 节/ 首先/ 介绍/ 时间/ 自动机/ 的/ 基本概念/ ,/ 然后/ 分别/ 对/ 环境/ 实体/ 和物/ 联网/ 服务/ 形式化/ 建模/ ;/ 第/ 5/ 节/ 描述/ 物/ 联网/ 服务/ 与/ 环境/ 实体/ 的/ 交互/ ,/ 并/ 给出/ 基于/ 模型/ 检测工具/ UPPAAL/ 的/ 物/ 联网/ 服务/ 正确性/ 验证/ 方法/ ;/ 第/ 6/ 节以/ 智能/ 会议室/ 为例/ 说明/ 如何/ 具体/ 使用/ 本文/ 所/ 提出/ 的/ 建模/ 和/ 验证/ 方法/ ;/ 第/ 7/ 节/ 总结/ 全文/ ,/ 讨论/ 进一步/ 的/ 研究/ 方向/ ./ 2/ 相关/ 工作/ 近年来/ ,/ 国际/ 上/ 许多/ 研究者/ 开始/ 关注/ 于/ 面向/ 服务/ 的/ 方法/ 与物/ 联网/ 的/ 结合/ ./ 由于/ 物理/ 设备/ 绝大多数/ 都/ 是/ 资源/ 受约束/ 的/ ,/ 物/ 联网/ 服务/ 需要/ 的/ 是/ 一种/ 尽量/ 精简/ 的/ 服务/ 标准/ ,/ 传统/ 的/ Web/ 服务/ 标准/ (/ 如/ WSDL/ 、/ SOAP/ 等/ )/ 并/ 不/ 适合/ ./ DPWS/ (/ DeviceProfileforWebServices/ )/ [/ 9/ ]/ 是/ 关于/ 物理/ 设备/ 的/ 一个/ Web/ 服务/ 标准/ 精简/ 子集/ ,/ 是/ 在/ 保证/ 对/ 安全/ 消息/ 通信/ 、/ 服务/ 描述/ 和/ 发现/ 、/ 设备/ 事件/ 等/ 支持/ 的/ 前提/ 下/ ,/ 所/ 定义/ 的/ 一个/ 轻量级/ 的/ 服务/ 协议/ 栈/ ./ 它/ 使得/ 设备/ 所/ 提供/ 的/ 服务/ 能/ 无缝/ 地/ 集成/ 到/ 企业应用/ 中/ ,/ 目前/ 在/ 物/ 联网/ 中正/ 得到/ 越来越/ 广泛/ 的/ 应用/ ./ IBM/ 的/ Deugd/ 等/ 人/ [/ 2/ ]/ 提出/ 了/ SODA/ (/ Service/ -/ OrientedDeviceArchitecture/ )/ ,/ 其/ 目标/ 是/ 为/ 物理/ 世界/ 的/ 设备/ 提供/ 一个/ 高层/ 的/ 抽象/ ,/ 以/ 服务/ 为/ 基础/ 构建/ 起/ 物理/ 世界/ 与/ 数字/ 世界/ 的/ 桥梁/ ./ 他们/ 认为/ ,/ 利用/ 面向/ 服务/ 的/ 架构/ (/ SOA/ )/ ,/ 开发者/ 可以/ 使用/ 各种/ Web/ 服务/ 标准/ 将/ 企业/ 服务/ 通过/ 企业/ 服务/ 总线/ (/ EnterpriseServiceBus/ )/ 连接起来/ ,/ 而/ 当/ SODA/ 出现/ 后/ ,/ 开发者/ 同样/ 可以/ 将/ 由/ 各种/ 设备/ 提供/ 的/ 服务/ 连接/ 到/ 企业/ 服务/ 总线/ 中/ ,/ 用户/ 完全/ 能够/ 像/ 访问/ Web/ 服务/ 一样/ ,/ 访问/ 设备/ 服务/ ./ 文献/ [/ 3/ -/ 5/ ]/ 提出/ 的/ SOCRADES/ ,/ 是/ 一种/ 基于/ WEB/ 服务/ 的/ 设备/ 现场/ 整合/ 架构/ (/ shopfloorintegra/ -/ tioninfrastructure/ )/ ,/ 目标/ 是/ 以/ Web/ 服务/ 为/ 重要/ 连接/ 技术/ 将/ 制造/ 车间/ 中/ 的/ 智能化/ 制造/ 设备/ 同/ 高层/ 后台/ 系统/ 如/ ERP/ 系统/ 紧密/ 地/ 联系/ 起来/ ,/ 以/ 满足/ 未来/ 制造业/ 的/ 要求/ ./ 整个/ 体系结构/ 由/ 设备/ 监测/ 、/ 服务/ 发现/ 、/ 服务/ 生命周期/ 管理/ 、/ 安全/ 支持/ 等/ 一系列/ 关键/ 模块/ 构成/ ,/ Page3/ 从而/ 实现/ 了/ 对/ 设备/ 的/ 实时/ 监测/ 和/ 控制/ ,/ 提高/ 了/ 生产/ 效率/ 和/ 安全/ 保障/ ./ 文章/ 中/ 还/ 给出/ 了/ 一套/ 具体/ 实现/ 方法/ ,/ 其中/ 设备/ 层次/ 上/ 的/ 服务/ 描述/ 采用/ 的/ 是/ DPWS/ ./ Buckl/ 等/ 人/ 认为/ 虽然/ DPWS/ 相比/ 于/ 其它/ Web/ 服务/ 标准/ 精简/ 了/ 许多/ ,/ 但是/ 它/ 对/ 计算能力/ 、/ 资源/ 的/ 要求/ 并/ 不能/ 被/ 所有/ 设备/ 所/ 接受/ ./ 因此/ 需要/ 一种/ 更/ 高效/ 的/ 方法/ 处理/ 资源/ 受限/ 的/ 设备/ ./ 文献/ [/ 6/ -/ 7/ ]/ 提出/ 了/ 服务/ 网关/ (/ Servicegateway/ )/ 的/ 概念/ ,/ 用于/ Web/ 服务/ 与/ 嵌入式/ 系统/ 的/ 信息/ 传递/ ./ 它/ 作为/ 互联网/ 与/ 嵌入式/ 系统/ 间/ 的/ 中介/ (/ mediator/ )/ ,/ 将/ 双方/ 所/ 传送/ 的/ 信息/ 进行/ 解释/ 、/ 转换/ ,/ 使得/ 双方/ 能/ 无缝/ 结合/ ,/ 但/ 又/ 保留/ 着/ 各自/ 的/ 描述语言/ 和/ 通信协议/ ./ 文献/ [/ 8/ ]/ 还/ 在/ 此基础/ 上/ 讨论/ 了/ 服务/ 的/ 语义/ 集成/ ,/ 即/ 把/ 相关/ 领域/ 知识/ 加入/ 到/ 各种/ 服务/ 的/ 描述/ 中/ ,/ 从而/ 使/ 针对/ 用户/ 需求/ 的/ 服务/ 发现/ 更/ 高效/ 、/ 准确/ ./ 上述/ 这些/ 研究/ 的/ 关注点/ 集中/ 在/ 物/ 联网/ 服务/ 整体/ 框架/ 的/ 建立/ 以及/ 服务/ 的/ 具体/ 描述/ 上/ ,/ 但是/ 都/ 没有/ 提供/ 服务/ 形式化/ 建模/ 和/ 正确性/ 验证/ 方法/ ./ 建立/ 一种/ 物/ 联网/ 服务/ 的/ 建模/ 和/ 验证/ 方法/ 是/ 本文/ 的/ 研究/ 动机/ ./ 在/ 服务/ 的/ 形式化/ 建模/ 和/ 验证/ 方面/ ,/ 主要/ 的/ 研究/ 工作/ 侧重/ 在/ 使用/ 的/ 形式化/ 理论/ ,/ 如/ 自动机/ 、/ Petri/ 网/ 和/ 进程/ 代数/ ./ 文献/ [/ 10/ ]/ 提出/ 了/ 一个/ 用于/ 分析/ 和/ 验证/ Web/ 服务/ 组合/ 性质/ 的/ 框架/ ./ 在/ 此/ 框架/ 下/ ,/ 描述/ Web/ 服务/ 组合/ 的/ BPEL/ 进程/ 首先/ 被/ 转换/ 为/ 一种/ 特殊/ 形式/ 的/ 自动机/ ,/ 之后/ 这些/ 自动机/ 被/ 解释/ 为/ 能/ 被/ 模型/ 检测工具/ SPIN/ 所/ 接受/ 的/ Promela/ 语言/ ./ 最后/ ,/ 使用/ SPIN/ 验证/ 服务/ 组合/ 的/ 性质/ ./ Wombacher/ 等/ 人/ [/ 11/ ]/ 提出/ 了/ 一种/ 扩展/ 了/ 逻辑/ 表达式/ 的/ 自动机/ 用于/ 对/ 服务/ 行为/ 形式化/ 建模/ ,/ 并/ 形式化/ 描述/ 了/ 服务/ 的/ 消息/ 序列/ ,/ 从而/ 实现/ 准确/ 的/ 服务/ 行为/ 匹配/ ./ 文献/ [/ 12/ ]/ 提出/ 了/ 一个/ 基于/ Petri/ 网/ 的/ Web/ 服务/ 组合/ 设计/ 和/ 验证/ 框架/ ,/ 该/ 框架/ 可/ 用于/ BPEL/ 进程/ 的/ 可视化/ 、/ 创建/ 和/ 验证/ ./ 文献/ [/ 13/ ]/ 为/ BPEL/ 给出/ 了/ 一套/ 完整/ 的/ 、/ 形式化/ 的/ Petri/ 网/ 语义/ ./ 此外/ ,/ 文中/ 的/ 语法分析/ 器/ 还/ 可以/ 将/ BPEL/ 进程/ 自动/ 转换/ 为/ Petri/ 网/ ,/ 这/ 使得/ 多种/ Petri/ 网/ 验证/ 工具/ 都/ 可以/ 对/ BPEL/ 进程/ 做/ 自动/ 分析/ ./ Sala/ ü/ n/ 等/ 人/ [/ 14/ ]/ 认为/ Web/ 服务/ 的/ 本质/ 特点/ ,/ 特别/ 是/ 服务/ 之间/ 的/ 交互/ ,/ 最/ 适合/ 用/ 进程/ 代数/ (/ CCS/ ,/ CSP/ ,/ π/ 演算/ 等/ )/ 来/ 描述/ ./ 他们/ 建立/ 了/ 一个/ 基于/ Web/ 服务/ 与/ 进程/ 代数/ 映射/ 的/ 通用/ 框架/ ,/ 并/ 说明/ 了/ 如何/ 使用/ 进程/ 代数/ 在/ 抽象层次/ 上/ 对/ Web/ 服务/ 进行/ 表述/ 、/ 组合/ 和/ 推导/ ./ 文献/ [/ 15/ ]/ 结合/ 描述/ 逻辑/ 和/ π/ 演算/ 分别/ 对/ 服务/ 的/ 静态/ 部分/ (/ 数据/ 和/ 架构/ )/ 、/ 动态/ 部分/ (/ 行为/ )/ 建模/ ./ 文献/ [/ 16/ ]/ 提出/ 了/ 使用/ π/ 演算/ 形式化/ 表示/ 服务/ 交互/ 模式/ 的/ 方法/ ./ 同/ 上述/ 关于/ Web/ 服务/ 的/ 建模/ 和/ 分析/ 工作/ 相比/ ,/ 本文/ 关注/ 于物/ 联网/ 服务/ 的/ 建模/ ,/ 并/ 结合物/ 联网/ 服务/ 特点/ ,/ 在/ 上述/ 工作/ 的/ 基础/ 上/ ,/ 增加/ 了/ 对/ 物理/ 环境/ 及/ 时间/ 属性/ 的/ 刻画/ ,/ 强调/ 物/ 联网/ 服务/ 的/ 时效性/ ./ 3/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ 本/ 节/ 我们/ 通过/ 分析/ 物/ 联网/ 的/ 典型/ 应用/ 场景/ ,/ 根据/ 其/ 性质/ 和/ 作用/ 对物/ 联网/ 系统/ 的/ 各/ 组成部分/ 进行/ 分类/ ,/ 研究/ 各类/ 组成部分/ 之间/ 的/ 关系/ ,/ 最后/ 给出/ 一个/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ ./ 3.1/ 一个/ 物/ 联网/ 应用/ 场景/ 图/ 1/ 为/ 一个/ 智能/ 会议室/ 应用/ 场景/ 描述/ ,/ 可以/ 用/ 它/ 示例/ 性/ 说明/ 物/ 联网/ 应用/ 系统/ 的/ 各/ 组成部分/ 及其/ 功能/ ./ 其/ 应用/ 需求/ 为/ :/ 通过/ 温度/ 感知器/ 实时/ 获取/ 室内空气/ 温度/ ,/ 并/ 自动/ 调节/ 空调/ 以/ 维持/ 舒适/ 温度/ ;/ 通过/ 光照/ 感知器/ 采集/ 环境光/ 光照强度/ ,/ 由/ 日光灯/ 和/ 窗帘/ 的/ 自动开关/ 控制/ 调节/ 室内/ 光线/ 强度/ ;/ 当/ 投影仪/ 开启/ 后/ ,/ 日光灯/ 自动/ 关闭/ ./ 整个/ 智能/ 会议室/ 应用/ 场景/ 由/ 两/ 大部分/ 组成/ :/ (/ 1/ )/ 外部环境/ ./ 即/ 整个/ 智能/ 会议/ 系统/ 所处/ 的/ 物理/ 环境/ ./ 我们/ 将/ 与/ 物/ 联网/ 系统/ 发生/ 交互/ 的/ 物理/ 世界/ 中/ 的/ 所有/ 物体/ 称为/ 环境/ 实体/ ,/ 每个/ 环境/ 实体/ 都/ 拥有/ 自己/ 的/ 静态数据/ 部分/ (/ 标识/ 、/ 属性/ )/ 和/ 动态/ 行为/ 部分/ ./ 在/ 智能/ 会议室/ 应用/ 场景/ 中/ 涉及/ 到/ 的/ 环境/ 实体/ 包括/ 空调/ 、/ 日光灯/ 、/ 环境光/ 、/ 人/ 等/ ./ (/ 2/ )/ 物/ 联网/ 系统/ ./ 具体/ 由/ 以下/ 3/ 部分/ 组成/ :/ Page4/ 的/ 控制器/ ,/ 用于/ 控制/ 物理/ 设备/ 的/ 动态/ 行为/ ;/ ①/ 由光/ 感知器/ 和/ 温度/ 感知器/ 所/ 构成/ 的/ 小型/ 传感/ 网络/ ,/ 用于/ 采集/ 会议/ 室内环境/ 实体/ 的/ 各项/ 信息/ ;/ ②/ 各类/ 物理/ 设备/ (/ 空调/ 、/ 窗帘/ 、/ 日光灯/ 、/ 投影仪/ )/ ③/ 基于/ 网络/ 的/ 各类/ 后台/ 处理器/ ,/ 根据/ 所/ 采集/ 到/ 环境/ 信息/ ,/ 按/ 特定/ 处理/ 规则/ 向/ 设备/ 控制器/ 发出/ 合适/ 的/ 指令/ ./ 上述/ 对/ 智能/ 会议室/ 应用/ 场景/ 的/ 分析/ ,/ 可以/ 推广/ 到/ 其它/ 物/ 联网/ 系统/ 应用/ 场景/ ./ 3.2/ 环境/ 实体/ 由图/ 1/ 可以/ 看出/ 物/ 联网/ 系统/ 与其/ 环境/ 的/ 相互作用/ 应/ 满足/ 应用/ 需求/ ,/ 其/ 环境/ 由/ 一组/ 环境/ 实体/ 组成/ ./ 这些/ 环境/ 实体/ 分为/ 两大类/ :/ (/ 1/ )/ 被/ 感知/ 的/ 环境/ 实体/ ./ 这类/ 环境/ 实体/ 仅/ 可/ 被/ 服务/ 以/ 感知/ 的/ 方式/ 获取/ 状态值/ ,/ 但/ 服务/ 无法/ 直接/ 改变/ 这些/ 实体/ 的/ 状态/ ,/ 实体/ 的/ 状态/ 以/ 一种/ 自主/ 的/ 、/ 无法/ 被/ 外界/ 准确/ 预知/ 的/ 方式/ 变化/ 着/ ./ 例如/ ,/ 智能/ 会议室/ 中/ 涉及/ 到/ 的/ 室内空气/ 、/ 光照/ 、/ 人/ 等/ ;/ (/ 2/ )/ 被/ 控制/ 的/ 环境/ 实体/ ./ 这类/ 环境/ 实体/ 不仅/ 其/ 状态值/ (/ 即/ 各项/ 属性/ 值/ )/ 可以/ 被/ 服务/ 获取/ ,/ 并且/ 服务/ 可以/ 向/ 这些/ 环境/ 实体/ 发送/ 事先/ 定义/ 好/ 的/ 指令/ ,/ 改变/ 实体/ 的/ 状态/ ,/ 从而/ 控制/ 实体/ 的/ 状态/ 变化/ ./ 各种/ 嵌入式/ 设备/ 均/ 属于/ 该类/ 实体/ ,/ 如/ 智能/ 会议室/ 中/ 的/ 日光灯/ 、/ 空调/ 、/ 电动/ 窗帘/ 等/ ./ 值得注意/ 的/ 是/ ,/ 环境/ 实体/ 之间/ 存在/ 相互/ 关联/ ,/ 例如/ ,/ 根据/ 会议室/ 内/ 空调/ 的/ 运行/ 状态/ 的/ 变化/ ,/ 会议/ 室内空气/ 的/ 温度/ 、/ 湿度/ 发生/ 相应/ 变化/ ./ 因此/ ,/ 对于/ 被/ 感知/ 的/ 环境/ 实体/ ,/ 服务/ 依然/ 有/ 可能/ 以/ 一种/ 间接/ 的/ 方式/ 影响/ 其/ 状态/ 变化/ ./ 环境/ 实体/ 反映/ 出/ 物理/ 世界/ 的/ 状态/ ,/ 而物/ 联网/ 服务/ 反映/ 出/ 信息/ 世界/ ,/ 两者/ 的/ 交互/ 体现/ 出/ 了/ 物理/ 世界/ 和/ 信息/ 世界/ 的/ 融合/ ,/ 这/ 正是/ 物/ 联网/ 技术/ 的/ 实现目标/ ./ 所有/ 的/ 环境/ 实体/ 都/ 是/ 独立/ 于物/ 联网/ 服务/ 而/ 存在/ 的/ ,/ 即/ 它们/ 并/ 不/ 依附于/ 任何/ 一个/ 物/ 联网/ 服务/ ./ 物/ 联网/ 服务/ 的/ 能力/ 体现/ 在/ 与/ 环境/ 实体/ 的/ 交互/ ,/ 使/ 环境/ 实体/ 的/ 状态/ 发生/ 改变/ ./ 针对/ 每个/ 特定/ 的/ 应用/ 场景/ ,/ 服务/ 关注/ 的/ 将/ 是/ 所有/ 环境/ 实体/ 集合/ 的/ 一个/ 子集/ ./ 例如/ ,/ 在/ 智能/ 会议室/ 系统/ 中/ ,/ 与/ 该/ 系统/ 所/ 提供/ 的/ 服务/ 交互/ 的/ 环境/ 实体/ 包括/ 日光灯/ 、/ 投影仪/ 、/ 空调/ 等/ ,/ 而/ 在/ 对于/ 一个/ 智能/ 交通/ 服务/ ,/ 其所/ 关注/ 的/ 环境/ 实体/ 将会/ 是/ 各种/ 车辆/ 、/ 道路/ 、/ 人/ 等/ ./ 一个/ 物/ 联网/ 服务/ 关注/ 并/ 与/ 之/ 交互/ 的/ 环境/ 实体/ 的/ 集合/ ,/ 称为/ 这个/ 服务/ 的/ 特定/ 环境/ ./ 3.3/ 物/ 联网/ 服务/ 物/ 联网/ 的/ 基础/ 是/ 互联网/ ,/ 同时/ 在/ 此基础/ 上/ 延伸/ 扩展/ 到/ 各种/ RFID/ 、/ 无线/ 传感器/ 、/ 全球定位系统/ 等/ 信息/ 传感/ 设备/ ./ 这些/ 信息/ 传感/ 设备/ 可以/ 提供/ 各类/ 基本/ 服务/ ,/ 我们/ 称为/ 设备/ 服务/ ./ 提供/ 设备/ 服务/ 的/ 各种/ 物理/ 设备/ 部署/ 于/ 自然环境/ 中/ ,/ 往往/ 是/ 资源/ (/ 包括/ 存储容量/ 、/ 计算能力/ 、/ 电量/ 等/ )/ 受约束/ ./ 设备/ 服务/ 一般/ 为/ 原子/ 服务/ ./ 原子/ 服务/ 是/ 指/ 实现/ 自/ 包含/ 的/ ,/ 在/ 执行/ 时/ 不可分割/ ,/ 不可/ 分解/ 为/ 更/ 细粒度/ 的/ 服务/ ./ 设备/ 服务/ 按/ 其/ 功能/ 可/ 分为/ 如下/ 两种/ 类型/ :/ (/ 1/ )/ 感知/ 型/ 服务/ ./ 这类/ 服务/ 通过/ 与/ 环境/ 实体/ 的/ 交互/ ,/ 采集/ 信息/ ,/ 感知/ 外部环境/ 实体/ 的/ 状态/ 变化/ ,/ 并/ 能/ 将/ 获取/ 的/ 信息/ 传输/ 给/ 其它/ 服务/ ./ 通常/ 情况/ 下/ ,/ 感知/ 型/ 服务/ 周期性地/ 采集/ 被/ 感知/ 环境/ 实体/ 的/ 信息/ ,/ 并且/ 单个/ 感知/ 型/ 服务/ 只/ 提供/ 对/ 一类/ 环境/ 实体/ 的/ 某项/ 属性/ 的/ 感知/ 能力/ ./ (/ 2/ )/ 控制/ 型/ 服务/ ./ 这类/ 服务/ 首先/ 从/ 其它/ 服务处/ 接收/ 到/ 对/ 某个/ 环境/ 实体/ 的/ 控制/ 信息/ ,/ 然后/ 将/ 这些/ 信息/ 转换/ 为/ 环境/ 实体/ 可/ 接受/ 的/ 控制/ 命令/ ,/ 并/ 将/ 其/ 发送给/ 相应/ 的/ 实体/ ./ 值得注意/ 的/ 是/ 这类/ 服务/ 只能/ 与/ 可控/ 环境/ 实体/ 发生/ 交互/ ./ 除了/ 设备/ 服务/ 之外/ ,/ 物/ 联网/ 服务/ 中/ 还有/ 一类/ 处理/ 型/ 服务/ ./ 这类/ 服务/ 并/ 不/ 直接/ 与/ 环境/ 实体/ 进行/ 交互/ ,/ 而是/ 负责/ 提供/ 业务/ 逻辑/ ,/ 把/ 从/ 感知/ 型/ 服务/ 中/ 获取/ 的/ 信息/ 进行/ 综合/ 处理/ ,/ 然后/ 根据/ 特定/ 规则/ 将/ 控制/ 信息/ 发送给/ 控制/ 型/ 服务/ ./ 在/ 上述/ 两类/ 原子/ 设备/ 服务/ 的/ 基础/ 上/ ,/ 根据/ 处理/ 型/ 服务/ 所/ 提供/ 的/ 业务/ 逻辑/ ,/ 通过/ 服务/ 的/ 组合/ 可以/ 构建/ 出/ 满足用户/ 不同/ 需求/ 的/ 物/ 联网/ 服务/ ./ 例如/ ,/ 在/ 智能/ 会议室/ 场景/ 中/ ,/ 由/ 气温/ 感知/ 服务/ 、/ 光照/ 感知/ 服务/ 等/ 感知/ 型/ 服务/ 实时/ 采集/ 到/ 关于/ 会议室/ 中/ 的/ 各项/ 环境/ 信息/ ,/ 这些/ 信息/ 被/ 及时/ 发送给/ 相应/ 的/ 处理/ 型/ 服务/ ./ 处理/ 型/ 服务/ 接收/ 到/ 这些/ 不同/ 类型/ 的/ 信息/ 后/ ,/ 对/ 它们/ 进行/ 整合/ 、/ 综合/ 分析/ 和/ 计算/ ,/ 将/ 处理/ 后/ 的/ 结果/ 发送到/ 空调/ 控制/ 服务/ 、/ 日光灯/ 控制/ 服务/ 等/ ./ 这些/ 控制/ 型/ 服务/ 对/ 接收/ 到/ 的/ 信息/ 进行/ 翻译/ ,/ 然后/ 根据/ 预定/ 义/ 的/ 规则/ ,/ 向/ 空调/ 、/ 日光灯/ 、/ 窗帘/ 等/ 可控/ 环境/ 实体/ 发出/ 控制/ 信息/ ./ 这/ 一系列/ 的/ 服务/ 以及/ 环境/ 实体/ 之间/ 的/ 交互/ ,/ 实现/ 了/ 对/ 会议室/ 的/ 智能/ 监控/ ./ 3.4/ 物/ 联网/ 服务/ 提供/ 框架/ 在/ 我们/ 以前/ 提出/ 的/ 基于/ 环境/ 的/ Web/ 服务/ 建模/ [/ 17/ -/ 18/ ]/ 的/ 基础/ 上/ ,/ 本文/ 进一步/ 提出/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ ,/ 如图/ 2/ 所示/ ./ 整个/ 框架/ 由物/ 联网/ 服务/ 池/ 、/ 环境/ 知识库/ 、/ 物/ 联网/ 服务/ 建模/ 和/ 验证/ 模块/ 、/ 物/ 联网/ 服务/ 提供/ 策略/ 模块/ 四大/ 部分/ 组成/ ./ Page5/ 图/ 2/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ 环境/ 知识库/ 存放/ 着/ 各种/ 环境/ 实体/ 的/ 模型/ ,/ 包括/ 环境/ 实体/ 的/ 类型/ 、/ 标识/ 、/ 属性/ 以及/ 行为/ 描述/ ./ 此外/ ,/ 环境/ 实体/ 之间/ 的/ 相关/ 联系/ 在/ 其中/ 被/ 描述/ ,/ 例如/ ,/ 空调/ 的/ 不同/ 运行/ 状态/ 可以/ 导致/ 附近/ 空气/ 温度/ 、/ 湿度/ 的/ 相应/ 变化/ ./ 物/ 联网/ 服务/ 池/ 包括/ 原子/ 服务/ 池/ 和/ 组合/ 服务/ 池/ 两/ 部分/ ./ 原子/ 服务/ 池/ 包含/ 设备/ 服务/ 和/ 具有/ 原子/ 性/ 的/ 处理/ 型/ 服务/ 组成/ ,/ 其中/ 设备/ 服务/ 又/ 分为/ 感知/ 型/ 服务/ 和/ 控制/ 型/ 服务/ 两大类/ ./ 组合/ 服务/ 池由物/ 联网/ 系统/ 的/ 综合性/ 服务/ 构成/ ,/ 它们/ 利用设备/ 感知/ 服务/ 采集/ 被/ 监测/ 的/ 环境/ 实体/ 的/ 状态/ 信息/ ,/ 并/ 通过/ 处理/ 型/ 服务/ 按照/ 预定/ 的/ 业务/ 逻辑/ ,/ 计算/ 需要/ 控制/ 的/ 物理量/ ,/ 再/ 利用设备/ 控制/ 服务/ 对/ 物理/ 设备/ 实施/ 相应/ 的/ 控制/ ,/ 从而/ 满足/ 物/ 联网/ 系统/ 的/ 应用/ 需求/ ./ 物/ 联网/ 服务/ 建模/ 和/ 验证/ 模块/ 用于/ 对物/ 联网/ 服务/ 池中/ 的/ 服务/ 进行/ 形式化/ 建模/ ,/ 并/ 结合/ 环境/ 知识库/ 中/ 的/ 相关/ 环境/ 实体/ 的/ 模型/ ,/ 对/ 所/ 建模/ 的/ 物/ 联网/ 服务/ 进行/ 正确性/ 验证/ ./ 物/ 联网/ 服务/ 提供/ 策略/ 存放/ 着/ 各种/ 物/ 联网/ 服务/ 的/ 组合/ 策略/ ,/ 它们/ 均/ 通过/ 了/ 服务/ 建模/ 和/ 验证/ 模块/ 的/ 严格/ 验证/ ,/ 分别/ 针对/ 不同/ 的/ 应用环境/ ,/ 满足/ 特定/ 的/ 应用/ 需求/ ./ 4/ 基于/ 时间/ 自动机/ 的/ 物/ 联网/ 服务/ 建模/ 我们/ 以/ 时间/ 自动机/ 作为/ 环境/ 实体/ 和物/ 联网/ 服务/ 行为/ 的/ 形式化/ 建模/ 工具/ ./ 下面/ 先/ 简单/ 介绍/ 时间/ 自动机/ 的/ 基本概念/ ./ 4.1/ 时间/ 自动机/ 由/ Alur/ 和/ Dill/ [/ 19/ ]/ 所/ 提出/ 的/ 时间/ 自动机/ ,/ 是/ 一种/ 用于/ 描述/ 、/ 分析/ 实时/ 系统/ 行为/ 的/ 形式化/ 模型/ ./ 它/ 在/ 有限/ 状态/ 自动机/ 的/ 基础/ 之上/ 扩充/ 了/ 取实/ 数值/ 的/ 时钟/ 变量/ (/ clockvariables/ )/ ,/ 用以/ 刻画/ 连续/ 变化/ 的/ 时间/ ./ 该/ 理论/ 的/ 一个/ 重要/ 性质/ 是/ :/ 检测时间/ 自动机/ 中/ 任意/ 一个/ 状态/ 是否/ 可/ 达/ (/ reachable/ )/ 的/ 问题/ 是/ 可/ 判定/ 的/ ./ 人们/ 研发/ 出/ 多种/ 模型/ 检测工具/ ,/ 如/ UPPAAL/ [/ 20/ ]/ 、/ KRONOS/ [/ 21/ ]/ 等/ ./ 这些/ 工具/ 为/ 时间/ 自动机/ 的/ 行为/ 模拟/ 、/ 性质/ 自动检测/ 提供/ 了/ 强有力/ 的/ 支持/ ./ 类/ 动作/ ,/ 本文/ 使用/ 的/ 时间/ 自动机/ 中/ 的/ 符号/ 如下/ :/ Chan/ :/ 所有/ 信道/ 名/ 的/ 集合/ ;/ Act/ :/ 所有/ 动作/ 的/ 集合/ ,/ 包含/ 输入/ 、/ 输出/ 和/ 内部/ 三/ Act/ =/ {/ a/ ?/ |/ a/ ∈/ Chan/ }/ ∪/ {/ a/ !/ |/ a/ ∈/ Chan/ }/ ∪/ {/ τ/ }/ }/ ;/ Clock/ :/ 所有/ 的/ 时钟/ 变量/ ;/ Var/ :/ 所有/ 的/ 数据/ 变量/ ./ 在/ 时钟/ 变量/ 集合/ C/ / Clock/ 和/ 数据/ 变量/ 集合/ V/ / Var/ 的/ 取值/ 上/ 可以/ 建立/ 一些/ 约束条件/ ,/ 统称/ 为/ 保卫/ 公式/ (/ guards/ )/ ,/ 记/ 为/ Φ/ (/ C/ ,/ V/ )/ ,/ 由/ 变量/ 集合/ 、/ 基本/ 运算符/ 和/ 比较/ 运算符/ 按/ 一定/ 语法/ 构成/ ./ 除了/ 对/ 变量/ 取值/ 进行/ 约束/ 外/ ,/ 还/ 可以/ 对/ 变量/ 进行/ 赋值/ 操作/ ./ 假设/ C/ / Clock/ ,/ V/ / Var/ ,/ 则/ 其/ 上/ 的/ 赋/ Page6/ 值/ 操作/ 记为/ R/ (/ C/ ,/ V/ )/ ./ 时钟/ 变量/ 只有/ 重置/ 赋值/ ,/ 即/ c/ ∈/ C/ ,/ c/ ·/ ·/ =/ 0/ ,/ 而/ 数据/ 变量/ 的/ 赋值/ 操作/ 形式/ 为/ v/ ∈/ V/ ,/ v/ ·/ ·/ =/ e/ ,/ e/ 可为/ 常量/ 或/ 各种/ 运算/ 表达式/ ./ 赋值/ 操作/ 序列/ 表示/ 为/ R/ (/ C/ ,/ V/ )/ / ./ 下面/ 给出/ 时间/ 自动机/ 的/ 定义/ ./ 定义/ 1/ ./ 一个/ 时间/ 自动机/ 是/ 一个/ 七元/ 组/ (/ S/ ,/ s0/ ,/ A/ ,/ C/ ,/ V/ ,/ I/ ,/ E/ )/ ,/ 其中/ S/ 是/ 有限/ 状态/ 集合/ ;/ s0/ ∈/ S/ 表示/ 初始状态/ ;/ A/ / Act/ 是/ 动作/ 的/ 集合/ ;/ C/ / Clock/ 是/ 时钟/ 变量/ 的/ 集合/ ;/ V/ / Var/ 是/ 数据/ 变量/ 的/ 集合/ ;/ I/ :/ S/ →/ Φ/ (/ C/ ,/ V/ )/ ,/ 将/ 一个/ 状态/ 映射/ 为/ 一个/ 保卫/ 公式/ ,/ 称为/ 状态/ 的/ 不/ 变量/ (/ invariant/ )/ ;/ E/ / S/ ×/ Φ/ (/ C/ ,/ V/ )/ ×/ A/ ×/ R/ (/ C/ ,/ V/ )/ / ×/ S/ 是/ 有/ 向/ 边/ 的/ 集合/ ,/ 元素/ (/ s/ ,/ φ/ ,/ α/ ,/ r/ ,/ s/ )/ ∈/ E/ 表示/ 从/ 状态/ s/ 到/ 状态/ s/ 的/ 有/ 向/ 边/ ,/ 边上/ 标识/ 有/ 保卫/ 公式/ φ/ ,/ 动作/ α/ 和/ 赋值/ 操作/ 序列/ r/ ./ 多个/ 并发/ 的/ 时间/ 自动机/ 可/ 构成/ 一个/ 时间/ 自动机/ 网络/ (/ TimedAutomataNetwork/ )/ ./ 网络/ 中/ 的/ 多个/ 时间/ 自动机/ 共享/ 一些/ 时钟/ 变量/ 和/ 数据/ 变量/ ,/ 但/ 都/ 有/ 各自/ 的/ 状态/ ./ 格局/ (/ Configuration/ )/ 是/ 用于/ 描述/ 网络/ 中/ 所有/ 自动机/ 运行/ 时/ 的/ 状态/ (/ 即/ 全局/ 状态/ )/ 的/ 概念/ ./ 定义/ 2/ ./ 假设/ 有/ n/ 个/ 时间/ 自动机/ TA1/ ,/ …/ ,/ TAn/ ,/ 其中/ 给定/ 任意/ 自然数/ i/ ,/ 对/ 1/ / i/ / n/ ,/ TAi/ =/ (/ Si/ ,/ s0i/ ,/ Ai/ ,/ Ci/ ,/ Vi/ ,/ Ii/ ,/ Ei/ )/ ,/ 由/ 这/ n/ 个/ 时间/ 自动机/ 构成/ 的/ 网络/ 记为/ N/ ≡/ TA1TA2/ …/ TAn/ ./ 一个/ 格局/ 被/ 表示/ 为/ 一个/ 三元组/ 〈/ s/ -/ ,/ ν/ ,/ ρ/ 〉/ ,/ 其中/ s/ -/ =/ 〈/ s1/ ,/ …/ ,/ sn/ 〉/ ,/ 对/ 1/ / i/ / n/ ,/ si/ ∈/ Si/ ;/ v/ :/ ∪/ n/ ρ/ :/ ∪/ ni/ =/ 1Ci/ →/ Time/ ,/ 表示/ 时钟/ 变量/ 的/ 一个/ 赋值/ ./ ρ/ 必须/ 满足/ ∧/ ni/ =/ 1Ii/ (/ si/ )/ ./ 当/ n/ =/ 1/ 时/ ,/ 上述/ 定义/ 表示/ 单个/ 时间/ 自动机/ 的/ 格局/ ./ 时间/ 自动机/ 之间/ 不能/ 通过/ 信道/ 进行/ 传值/ 通信/ ,/ 因为/ 输入/ 、/ 输出/ 动作/ 没有/ 附加/ 任何/ 数值/ 和/ 变量/ ,/ 但/ 可以/ 通过/ 共享/ 变量/ 的/ 方式/ 来/ 实现/ 同步/ 传值/ 通信/ ./ 为了/ 实现/ 传值/ 通信/ ,/ 可以/ 首先/ 由/ 输出方/ 给/ 一个/ 共享/ 变量/ 赋值/ ,/ 之后/ 输入/ 方再/ 直接/ 访问/ 该/ 共享/ 变量/ ,/ 获取/ 数值/ ./ 4.2/ 环境/ 实体/ 的/ 建模/ 每个/ 环境/ 实体/ 应该/ 具备/ 以下/ 几个/ 基本特征/ :/ (/ 1/ )/ 拥有/ 唯一/ 的/ 身份/ 标识/ ,/ 以/ 区别/ 其它/ 的/ 环境/ (/ 2/ )/ 拥有/ 一定/ 的/ 物理/ 或/ 虚拟/ 属性/ ,/ 如/ 空气/ 具有/ 的/ 属性/ 为/ 温度/ 、/ 湿度/ 等/ ,/ 人/ 的/ 属性/ 有/ 身高/ 、/ 体重/ 等/ ./ 我们/ 将/ 环境/ 实体/ 的/ 所有/ 属性/ 的/ 一个/ 赋值/ ,/ 称为/ 环境/ 实/ 实体/ ;/ 体/ 的/ 一个/ 状态/ ;/ (/ 3/ )/ 具有/ 通信/ 能力/ 或/ 允许/ 被/ 感知/ ,/ 属性/ 值/ 可以/ 通过/ 主动/ 或/ 被动/ 的/ 方式/ 由物/ 联网/ 服务/ 或/ 其它/ 环境/ 实体/ 获取/ ./ 如果/ 将/ 环境/ 实体/ 看成/ 对象/ ,/ 那么/ 具有/ 相同/ 属性/ 、/ 动作/ 的/ 环境/ 实体/ 可以/ 被/ 抽象/ 为类/ ,/ 我们/ 称/ 这些/ 类为/ 环境/ 实体类/ ,/ 其/ 形式化/ 定义/ 如下/ ./ 定义/ 3/ ./ 一个/ 环境/ 实体类/ 表示/ 为/ T/ ≡/ 〈/ Tid/ ,/ Attr/ ,/ Op/ ,/ Dom/ 〉/ ,/ 其中/ Tid/ 为/ 环境/ 实体类/ 的/ 标识符/ ;/ Attr/ 为/ 环境/ 实体/ 属性/ 的/ 集合/ ;/ Op/ 为/ 环境/ 实体/ 允许/ 的/ 操作/ 集合/ ;/ Dom/ :/ Attr/ →/ DataType/ 表示/ 从属性/ 集合/ 到/ 各种/ 数据类型/ 的/ 一个/ 映射/ ,/ 这里/ DataType/ 既/ 包含/ 各种/ 基本/ 数据类型/ 如/ Int/ 、/ Boolean/ 、/ Float/ 等/ ,/ 也/ 包含/ 用户/ 定义/ 的/ 枚举/ 类型/ 和/ 复合/ 类型/ ./ 我们/ 将/ 所有/ 环境/ 实体类/ 的/ 集合/ 记为/ EET/ ,/ 对于/ 任意/ T/ ∈/ EET/ ,/ T/ ./ Attr/ 表示/ 类型/ T/ 的/ 所有/ 属性/ ,/ T/ ./ Op/ 表示/ 类型/ T/ 的/ 所有/ 动作/ ./ 两类/ 不同/ 的/ 环境/ 实体/ 的/ 行为/ 均/ 可以/ 被/ 合理/ 地/ 、/ 以/ 时间/ 自动机/ 的/ 形式/ 表示/ 出来/ ./ 被/ 感知/ 的/ 环境/ 实体/ :/ 这/ 类/ 环境/ 实体/ 的/ 各项/ 属性/ 值/ 可以/ 被/ 外界/ 感知/ ,/ 同时/ 它们/ 也/ 可能/ 有/ 自己/ 的/ 主动/ 行为/ ,/ 这些/ 行为/ 既/ 可能/ 是/ 与/ 其它/ 环境/ 实体/ 的/ 交互/ ,/ 也/ 可能/ 是/ 对/ 服务/ 所/ 关注/ 事件/ 的/ 触发/ ./ 为了/ 表示/ 的/ 方便/ ,/ 我们/ 假设/ 这/ 类/ 环境/ 实体/ 都/ 是/ 主动/ 地/ 将/ 自身/ 的/ 各项/ 属性/ 值/ 输出/ ./ 并且/ 它们/ 一般/ 都/ 具有/ 一个/ 内部/ 动作/ (/ 在/ 时间/ 自动机/ 中/ 用/ τ/ 动作/ 对应/ )/ ,/ 以/ 外界/ 不/ 可见/ 的/ 方式/ 对/ 各项/ 属性/ 值/ 做/ 修改/ ./ 被/ 控制/ 的/ 环境/ 实体/ :/ 这/ 类/ 环境/ 实体/ 不仅/ 属性/ 值/ 可以/ 被/ 获取/ ,/ 而且/ 通过/ 接收/ 指令/ 改变/ 相应/ 状态/ ,/ 从而/ 受控/ ./ 相对/ 于/ 被/ 感知/ 的/ 实体/ ,/ 我们/ 对/ 被/ 控制/ 的/ 实体/ 行为/ 的/ 了解/ 会/ 更/ 全面/ ,/ 同时/ 对/ 它们/ 的/ 描述/ 往往/ 更/ 复杂/ ./ 根据/ 属性/ 值/ 的/ 不同/ 可/ 得到/ 多个/ 状态/ ,/ 状态/ 间/ 的/ 变迁/ 可/ 由/ 指令/ 触发/ ./ 下面/ 分别/ 以/ 被/ 感知/ 的/ 环境/ 实体类/ Air/ 和/ 被/ 控制/ 的/ 环境/ 实体类/ AirCond/ 为例/ 具体/ 说明/ 环境/ 实体类/ 的/ 定义/ :/ Air/ ≡/ 〈/ air/ ,/ {/ loc/ ,/ temp/ ,/ humidity/ }/ ,/ {/ showLoc/ ,/ 其中/ ,/ air/ 为/ Air/ 实体类/ 标识符/ ;/ loc/ ,/ temp/ ,/ humidity/ 分别/ 代表/ Air/ 类应/ 具有/ 3/ 个/ 属性/ :/ 位置/ 、/ 温度/ 、/ 湿度/ ;/ showLoc/ ,/ showTemp/ ,/ showHumi/ 分别/ 表示/ Air/ 类/ 将/ 自身/ 的/ 各种/ 信息/ 告知/ 外界/ 的/ 动作/ ,/ selfAdj/ 表示/ 属于/ Air/ 类/ 的/ 实体/ 的/ 自我调节/ 动作/ ,/ 外界/ 不/ 可见/ ;/ domair/ 定义/ 为/ Page7domair/ (/ loc/ )/ =/ Location/ ,/ domair/ (/ temp/ )/ =/ Float/ ,/ domair/ (/ temp/ )/ =/ Float/ ,/ 这里/ Location/ 为/ 表示/ 地理位置/ 的/ 特殊/ 数据类型/ ,/ Float/ 为/ 浮点数/ 类型/ ./ AirCond/ ≡/ 〈/ ac/ ,/ {/ OpMode/ ,/ FanSpeed/ }/ ,/ {/ TurnOn/ ,/ 其中/ ,/ ac/ 为/ AirCond/ 实体/ 类型/ 标识符/ ;/ OpMode/ 表示/ AirCond/ 类/ 的/ 运行/ 模式/ 属性/ ,/ FanSpeed/ 表示/ AirCond/ 类/ 的/ 风速/ 属性/ ;/ TurnOn/ ,/ TurnOff/ ,/ setOM/ ,/ setFS/ 分别/ 表示/ ac/ 的/ 开/ 、/ 关/ 、/ 运行/ 模式/ 设定/ 以及/ 风速/ 设定/ 操作/ ;/ domac/ 的/ 定义/ 为/ domac/ (/ OpMode/ )/ =/ {/ COOL/ ,/ HEAT/ ,/ FAN/ }/ ,/ domac/ (/ FanSpeed/ )/ =/ {/ LOW/ ,/ MED/ ,/ HIGH/ }/ ./ 根据上述/ 定义/ 所/ 得到/ 的/ 环境/ 实体类/ 和/ 环境/ 实体/ 就/ 构成/ 了/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ 中/ 的/ 环境/ 知识库/ ./ 在/ 环境/ 实体类/ 的/ 基础/ 上/ ,/ 可/ 创建/ 具体/ 的/ 环境/ 实体/ ./ 定义/ 4/ ./ 一个/ 环境/ 实体/ 表示/ 为/ 三元组/ e/ ≡/ 〈/ Eid/ ,/ T/ ,/ TA/ 〉/ ,/ 其中/ Eid/ 为/ 环境/ 实体/ 的/ 唯一/ 标识符/ ;/ T/ ∈/ EET/ 表示/ 该/ 环境/ 实体/ 所属/ 的/ 实体类/ ;/ TA/ =/ (/ S/ ,/ s0/ ,/ A/ ,/ C/ ,/ V/ ,/ I/ ,/ E/ )/ 为/ 符合/ 定义/ 1/ 的/ 时间/ 自动机/ ,/ 用于/ 描述/ 环境/ 实体/ 的/ 动态/ 行为/ ,/ TA/ 的/ 每/ 一个/ 格局/ 〈/ s/ ,/ ν/ ,/ ρ/ 〉/ 表示/ 环境/ 实体/ 的/ 一个/ 状态/ ,/ 并且/ TA/ 还应/ 满足/ 以下/ 要求/ :/ (/ 1/ )/ 存在/ 双射/ op/ :/ T/ ./ Op/ / A/ ;/ (/ 2/ )/ 存在/ 单射/ var/ :/ T/ ./ Attr/ →/ V/ ./ 采用/ 时间/ 自动机/ ,/ 一个/ 属于/ Air/ 类/ 的/ 实体/ 行为/ 可如图/ 3/ 所示/ ,/ 该/ 实体/ 用/ 变量/ Temp/ 和/ Humidity/ 分别/ 存储/ 温度/ 和/ 湿度/ ,/ 通过/ 信道/ showTemp/ 和/ show/ -/ Temp/ 将/ 温度/ 、/ 湿度/ 值/ 告知/ 外界/ ./ 一个/ 属于/ AirCond/ 类/ 的/ 环境/ 实体/ 可/ 表示/ 如图/ 4/ 所示/ ,/ 该/ 实体/ 通过/ 信道/ On/ 与/ Off/ 获取/ 开关/ 指令/ ,/ 通过/ 信道/ Cool/ 和/ Heat/ 接受/ 运行/ 模式/ 信息/ ./ 4.3/ 物/ 联网/ 服务/ 的/ 建模/ 本/ 节/ 我们/ 先/ 给出/ 物/ 联网/ 原子/ 服务/ 的/ 模型/ ,/ 然后/ 在/ 此基础/ 上/ 给出/ 组合/ 服务/ 的/ 定义/ ./ 4.3/ ./ 1/ 原子/ 服务/ 建模/ 物/ 联网/ 服务/ 的/ 功能/ 通过/ 其/ 与/ 环境/ 之间/ 的/ 交互/ 体现/ ,/ 服务/ 通过/ 交互/ 感知/ 到/ 环境/ 的/ 状态/ ,/ 及时/ 地/ 实施/ 对/ 环境/ 的/ 控制/ ,/ 实现/ 改变/ 环境/ 状态/ 的/ 目的/ ./ 在/ 对物/ 联网/ 服务/ 进行/ 建模/ 时/ 需要/ 描述/ 与/ 服务/ 发生/ 交互/ 的/ 环境/ 实体类/ ./ 物/ 联网/ 服务/ 形式化/ 描述/ 如下/ ./ 定义/ 5/ ./ 一个/ 物/ 联网/ 原子/ 服务/ 形式化/ 表示/ 为/ 一个/ 三元组/ 〈/ Sid/ ,/ Eset/ ,/ STA/ 〉/ ,/ 其中/ Sid/ 表示/ 物/ 联网/ 服务/ 的/ 标识符/ ;/ Eset/ / EET/ 表示/ 一个/ 环境/ 实体/ 类型/ 的/ 集合/ ;/ STA/ 为/ 一个/ 时间/ 自动机/ ,/ 用于/ 描述/ 服务/ 的/ 动态/ 行为/ ./ 三类/ 原子/ 服务/ 分别/ 有/ 不同/ 的/ 表示/ 方式/ :/ (/ 1/ )/ 感知/ 型/ 服务/ ./ 因为/ 这/ 类/ 服务/ 的/ 功能/ 在于/ 感知/ 外部环境/ 实体/ 的/ 状态/ ,/ 所以/ 服务/ 的/ Eset/ 必为/ 非空/ ./ 由于/ 能力/ 的/ 限制/ ,/ 一般/ 情况/ 下/ ,/ 原子/ 感知/ 服务/ 只/ 涉及/ 一类/ 环境/ 实体/ ,/ 此时/ Eset/ 中有且/ 仅/ 有/ 一个/ 元素/ ./ 感知/ 行为/ 被/ 表示/ 为/ 一个/ 输入/ 动作/ ,/ 同时/ 读取/ 指定/ 共享/ 变量/ 的/ 值/ ./ 此外/ ,/ 感知/ 服务/ 需要/ 一个/ 时钟/ 变量/ ,/ 用于/ 控制/ 对/ 信息/ 的/ 定时/ 获取/ ./ 例如/ ,/ 一个/ 空气/ 温度/ 感知/ 服务/ 表示/ 为/ 〈/ SensorA/ ,/ {/ Air/ }/ ,/ SA/ 〉/ ,/ 其中/ SA/ 表示/ 如图/ 5/ 所示/ ,/ 该/ 服务/ 每/ 10/ 个/ 单位/ 时间/ 感知/ 一次/ 空气/ 的/ 温度/ ,/ 并且/ 可/ 将/ 该/ 温度/ 信息/ 发送给/ 其它/ 服务/ ,/ 若/ 出现/ 连续/ 10/ 个/ 单位/ 时间/ 没有/ 发生/ 感知/ 动作/ ,/ 说明/ 设备/ 发生/ 故障/ ,/ 服务/ 进入/ Fault/ 状态/ ./ (/ 2/ )/ 控制/ 型/ 服务/ ./ 该/ 类型/ 服务/ 的/ 控制/ 对象/ 为/ 可控/ 环境/ 实体/ ,/ 因此/ 其/ Eset/ 必须/ 非空/ ./ 该类/ 服务/ 的/ 主/ Page8/ 要/ 功能/ 是/ 通过/ 输入/ 动作/ 获取/ 其它/ 服务/ 发来/ 的/ 指令/ ,/ 再/ 通过/ 输出/ 动作/ 将/ 合适/ 的/ 指令/ 发送给/ 受控/ 环境/ 实体/ ./ 例如/ 一个/ 空调/ 控制/ 服务/ 定义/ 为/ 〈/ ControlA/ ,/ {/ AirCond/ }/ ,/ CA/ 〉/ ,/ 其中/ CA/ 的/ 定义/ 如图/ 6/ 所示/ ,/ 该/ 服务/ 通过/ 信道/ ACOn/ ,/ ACOff/ ,/ ACCool/ ,/ ACHeat/ 从/ 其它/ 服务/ 接收/ 到/ 空调/ 控制/ 信息/ ,/ 然后/ 通过/ 信道/ On/ ,/ Off/ ,/ Cool/ ,/ Heat/ 将/ 相应/ 信息/ 发送给/ 空调/ 实体/ ./ (/ 3/ )/ 处理/ 型/ 服务/ ./ 这类/ 服务/ 的/ 特点/ 在于/ 并/ 不会/ 直接/ 与/ 任何/ 环境/ 实体/ 交互/ ,/ 因此/ 其/ Eset/ 为空/ ./ 例如/ ,/ 一个/ 温度/ 调节/ 服务/ 表示/ 为/ 〈/ ProcessA/ ,/ / ,/ PA/ 〉/ ,/ 其中/ 图/ 7/ 温度/ 调节/ 服务/ 时间/ 自动机/ 描述/ 该/ 服务/ 每隔/ 10/ 个/ 单位/ 时间/ 从/ 感知/ 服务处/ 获取/ 空气/ 温度/ ./ 若/ 温度/ 高于/ 20/ ,/ 服务/ 向/ 空调/ 控制/ 服务/ 发出/ 启动/ 及/ 制冷/ 指令/ ,/ 若/ 温度/ 低于/ 5/ ,/ 则/ 发出/ 启动/ 及/ 制热/ 指令/ ./ 当/ 空调/ 启动/ 后/ 一段时间/ ,/ 若/ 温度/ 恢复正常/ ,/ 则/ 发出/ 关闭/ 空调/ 指令/ ./ 4.3/ ./ 2/ 组合/ 服务/ 建模/ 以/ 原子/ 服务/ 模型/ 为/ 基础/ ,/ 利用/ 时间/ 自动机/ 网络/ 可以/ 表示/ 出/ 多个/ 原子/ 服务/ 所/ 构建/ 出/ 的/ 组合/ 服务/ ,/ 其/ 形式化/ 描述/ 如下/ ./ 定义/ 6/ ./ 假设/ 有/ n/ 个物/ 联网/ 服务/ S1/ ,/ …/ ,/ Sn/ ,/ 对/ i/ (/ 1/ / i/ / n/ )/ ,/ Si/ ≡/ 〈/ SIDi/ ,/ Eseti/ ,/ STAi/ 〉/ ,/ 则/ 由/ 这/ n/ 个/ 服务/ 所/ 组合成/ 的/ 服务/ 表示/ 为/ S/ ≡/ 〈/ SID/ ,/ ∪/ n/ 其中/ SID/ 为/ 一个/ 新/ 的/ 服务/ 标识符/ ,/ S1/ ,/ …/ ,/ Sn/ 是/ S/ 的/ 成员/ 服务/ ./ 根据/ 时间/ 自动机/ 网络/ 的/ 操作/ 语义/ [/ 19/ ]/ ,/ 网络/ 中/ 的/ 各/ 时间/ 自动机/ 既/ 可以/ 并发/ 执行/ 各自/ 的/ 动作/ ,/ 又/ 可以/ 在/ 共享/ 的/ 信道/ 上/ ,/ 由/ 一方/ 做/ 输出/ 动作/ ,/ 一方/ 做/ 输入/ 动作/ ,/ 从而/ 实现/ 同步/ 通信/ ./ 这种/ 通信/ 实际上/ 就/ 对应/ 着/ 成员/ 服务/ 之间/ 的/ 交互/ ./ 由于/ 外部环境/ 关注/ 的/ 是/ 服务/ 与/ 环境/ 实体/ 的/ 交互/ ,/ 而/ 服务/ 之间/ 的/ 通信/ 为/ 内部/ 通信/ ,/ 因此/ 这些/ 服务/ 通过/ 同步/ 通信/ 构成/ 了/ 组合/ 服务/ ./ 例如/ ,/ 上文/ 提到/ 的/ 温度/ 感知/ 服务/ 〈/ SensorA/ ,/ {/ Air/ }/ ,/ SA/ 〉/ 、/ 空调/ 控制/ 服务/ 〈/ ControlA/ ,/ {/ AirCond/ }/ ,/ CA/ 〉/ 和/ 温度/ 调节/ 服务/ 〈/ ProcessA/ ,/ / ,/ PA/ 〉/ ,/ 它们/ 组合/ PA/ 的/ 描述/ 如图/ 7/ 所示/ ./ 而成/ 一个/ 新/ 的/ 物/ 联网/ 服务/ :/ 〈/ Comp/ ,/ {/ Air/ ,/ AirCond/ }/ ,/ SACAPA/ 〉/ ./ 其中/ ,/ SA/ 首先/ 定时/ 获取/ 气温/ 信息/ ,/ 再/ 通过/ 与/ PA/ 的/ 共享/ 通道/ 将/ 此/ 信息/ 传输/ 给/ PA/ ,/ PA/ 根据/ 设定/ 好/ 的/ 规则/ 和/ 实时/ 获取/ 的/ 信息/ ,/ 将/ 控制/ 信息/ 通过/ 相应/ 的/ 共享/ 通道/ 传输/ 给/ CA/ ,/ 最终/ 由/ CA/ 控制/ 空调/ 的/ 运行/ ./ 整个/ 组合/ 服务/ 的/ 功能/ 为/ :/ 根据/ 空气/ 温度/ 的/ 实时/ 变化/ ,/ 自动控制/ 空调/ 的/ 运行/ 模型/ ,/ 从而/ 调节/ 温度/ ./ 5/ 物/ 联网/ 服务/ 验证/ 在/ 上/ 文中/ ,/ 我们/ 分别/ 将/ 环境/ 实体/ 和物/ 联网/ 服务/ 的/ 行为/ 建模/ 为/ 时间/ 自动机/ ./ 服务/ 的/ 行为能力/ 通过/ 与/ 环境/ 的/ 交互/ 体现/ 出来/ ,/ 不/ 应该/ 脱离/ 环境/ 而/ 对物/ 联网/ 服务/ 做/ 孤立/ 的/ 分析/ ./ 物/ 联网/ 服务/ 的/ 正确性/ 不仅仅/ 在于/ 其/ 自身/ 的/ 行为/ ,/ 更进一步/ 地要/ 在/ 合适/ 的/ 环境/ 进行/ 合适/ 的/ 行为/ ,/ 即/ 必须/ 与/ 环境/ 的/ 变化/ 适配/ ./ 这/ 一节/ 我们/ 讨论/ 物/ 联网/ 服务/ 的/ 时效/ 正确性/ 验证/ ./ 我们/ 将物/ 联网/ 服务/ 的/ 时效/ 正确性/ 分解/ 为/ 如下/ 4/ 类/ 性质/ ,/ 可以/ 统一/ 采用/ UPPAAL/ 中/ 的/ 时序/ 逻辑/ 公式/ [/ 20/ ]/ 来/ 表达/ :/ (/ 1/ )/ 状态/ 可达性/ (/ reachability/ )/ ./ 表示/ 物/ 联网/ 系统/ 期望/ 到达/ 的/ 的/ 某个/ 状态/ ,/ 存在/ 从/ 初始状态/ 开始/ 到/ 该/ 状态/ 的/ 一条/ 运行/ 轨迹/ ./ 状态/ 可/ 达/ 主要/ 关注/ 环境/ 实体/ 的/ 状态/ ,/ 表示/ 在/ 物/ 联网/ 服务/ 的/ 控制/ 下/ ,/ 环境/ 实体/ 的/ 期望/ 状态/ 可达/ ./ 例如/ 希望/ 空调/ 实体/ 的/ 开启/ 状态/ 是/ 可达/ 的/ ,/ 其/ 逻辑/ 公式/ 表示/ 为/ / ◇/ air/ ./ on/ ;/ Page9/ (/ 2/ )/ 系统/ 安全性/ (/ safety/ )/ ./ 我们/ 不仅/ 期望/ 物/ 联网/ 服务/ 在/ 运行/ 过程/ 中/ 能/ 保证/ 其/ 安全性/ ,/ 同时/ 也/ 希望/ 控制/ 服务/ 使得/ 被/ 控制/ 的/ 环境/ 实体/ 不会/ 进入/ 错误/ 的/ 状态/ ./ 系统/ 安全性/ 表示/ 整个/ 物/ 联网/ 系统/ 不/ 期望/ 的/ 事件/ 永不/ 发生/ ,/ 例如/ 希望/ 整个/ 整个/ 物/ 联网/ 系统/ 的/ 运行/ 不/ 出现/ 死锁/ ,/ 表示/ 为/ / □/ notdeadlock/ ;/ (/ 3/ )/ 系统/ 活性/ (/ liveness/ )/ ./ 表示/ 期望/ 的/ 事件/ 最终/ 能/ 发生/ ,/ 一般/ 用于/ 描述/ 当/ 被/ 感知/ 的/ 环境/ 实体/ 处于/ 某一/ 状态/ 时/ ,/ 被/ 控制/ 的/ 环境/ 实体/ 也/ 最终/ 能/ 进入/ 一个/ 特定/ 的/ 状态/ ./ 例如/ 希望/ 当/ 空气/ 实体/ 的/ 温度/ 高于/ 20/ 时/ ,/ 空调/ 实体/ 将/ 处于/ 制冷/ 状态/ ,/ 可/ 表示/ 为/ air/ _/ temp/ >/ 20/ →/ ac/ ./ cool/ ./ (/ 4/ )/ 时间/ 约束/ (/ timedconstraint/ )/ ./ 这类/ 性质/ 描述/ 中/ 至少/ 包含/ 有/ 一个/ 时间/ 变量/ ,/ 用于/ 强调/ 对/ 服务/ 行为/ 的/ 时间/ 约束/ 是否/ 被/ 满足/ ./ 例如/ ,/ 希望/ 空调/ 在/ 室内/ 温度/ 高于/ 25/ 后/ 60s/ 内/ 自动/ 启动/ ,/ 则/ 该/ 性质/ 表示/ 为/ air/ _/ temp/ >/ 25/ →/ ac/ ./ on/ ∧/ air/ ./ c/ </ 60/ ,/ 其中/ air/ ./ c/ 为/ 时钟/ 变量/ ,/ 它/ 在/ 温度/ 高于/ 25/ 时/ 自动/ 置/ 零/ ./ 物/ 联网/ 服务/ 的/ 定义/ 中/ 包含/ 了/ 与/ 之/ 交互/ 的/ 环境/ 实体类/ 集合/ ./ 将/ 这些/ 类/ 实例/ 化后/ 所/ 得到/ 的/ 环境/ 实体/ 集合/ 就/ 构成/ 了/ 该/ 服务/ 的/ 一个/ 特定/ 环境/ ./ 定义/ 7/ ./ 假设/ 一个/ 物/ 联网/ 服务/ S/ ≡/ 〈/ sid/ ,/ Eset/ ,/ STA/ 〉/ ,/ 环境/ 实体/ 集合/ Env/ ≡/ ∪/ n/ 的/ 一个/ 环境/ ,/ 若/ 满足/ 对于/ 任意/ T/ ∈/ Eset/ ,/ 存在/ 1/ / i/ / n/ ,/ Ti/ =/ T/ ,/ 即/ 对于/ 服务/ 中/ 的/ 每个/ 环境/ 实体类/ ,/ 在/ 环境/ 中/ 都/ 至少/ 存在/ 该类/ 的/ 一个/ 实例/ 化/ 环境/ 实体/ ./ 服务/ S/ 与/ 它/ 的/ 环境/ Env/ 之间/ 的/ 交互/ 用/ 时间/ 自动机/ 网络/ STAETA1/ …/ ETAn/ 的/ 转换/ 关系/ 表示/ ./ 例如/ ,/ 前/ 文/ 提到/ 的/ 气温/ 自动/ 调节/ 服务/ 〈/ Comp/ ,/ {/ Air/ ,/ AirCond/ }/ ,/ SACAPA/ 〉/ ,/ 它/ 的/ 一个/ 可能/ 的/ 运行/ 坏境/ 由/ 一个/ 空气/ 类/ 环境/ 实体/ 〈/ air/ ,/ Air/ ,/ TAa/ 〉/ 和/ 一个/ 空调/ 类/ 环境/ 实体/ 〈/ ac/ ,/ AirCond/ ,/ TAac/ 〉/ 构成/ ./ 它们/ 之间/ 的/ 交互/ 表示/ 为/ 时间/ 自动机/ 网络/ 物/ 联网/ 服务/ 与/ 环境/ 实体/ 的/ 交互/ 行为/ 已经/ 完全/ 建模/ 为/ 时间/ 自动机/ 网络/ ,/ 那么/ 对/ 服务/ 正确性/ 验证/ 实际上/ 转换/ 为了/ 相应/ 时间/ 自动机/ 网络/ 的/ 分析/ ./ 我们/ 选用/ 模型/ 检测工具/ UPPAAL/ [/ 14/ ]/ 作为/ 物/ 联网/ 服务/ 时效/ 正确性/ 验证/ 的/ 工具/ ./ 在/ 由物/ 联网/ 服务/ 和/ 其/ 相关联/ 的/ 环境/ 实体/ 所/ 构成/ 的/ 整个/ 时间/ 自动机/ 网络/ 输入/ 到/ UPPAAL/ 后/ ,/ 用/ UPPAAL/ 协助/ 完成/ 下面/ 的/ 工作/ :/ (/ 1/ )/ 服务/ 行为/ 的/ 模拟/ ./ 通过/ UPPAAL/ 所/ 提供/ 的/ 模拟器/ (/ simulator/ )/ ,/ 我们/ 可以/ 模拟/ 运行/ 物/ 联网/ 服务/ 与/ 环境/ 实体/ 的/ 交互/ 过程/ ,/ 选择/ 希望/ 执行/ 的/ 动作/ ,/ 并/ 观察/ 数据/ 变量/ (/ 记录/ 着/ 环境/ 实体/ 的/ 属性/ 值/ 、/ 服务/ 所/ 使用/ 的/ 数据/ 值/ )/ 的/ 变化/ 过程/ ,/ 整个/ 过程/ 都/ 通过/ 运行/ 轨迹/ (/ trace/ )/ 记录/ ./ (/ 2/ )/ 服务/ 正确性/ 检测/ ./ 我们/ 将/ 上/ 文所/ 提到/ 表达/ 系统/ 性质/ 的/ 逻辑/ 公式/ 输入/ 到/ UPPAAL/ 的/ 验证/ 器/ (/ verifer/ )/ 后/ ,/ 它/ 能/ 自动检测/ 性质/ 是否/ 可/ 被/ 满足/ ,/ 并/ 给出/ 一些/ 相应/ 的/ 运行/ 轨迹/ 用于/ 分析/ ./ 由于/ 引入/ 了/ 取值/ 为/ 实数/ 的/ 时钟/ ,/ 使/ 时间/ 自动机/ 状态/ 空间/ 爆炸/ 的/ 问题/ 更加/ 突出/ ./ 因此/ ,/ 如何/ 利用/ 相关/ 的/ 优化/ 技术/ 来/ 约简/ 时间/ 自动机/ 的/ 状态/ 空间/ ,/ 是/ 我们/ 在/ 服务/ 建模/ 和/ 验证/ 过程/ 中/ 必须/ 关注/ 的/ 问题/ ./ 目前/ 比较/ 流行/ 的/ 时间/ 自动机/ 状态/ 约简/ 技术/ 可/ 分为/ 针对/ 时钟/ 约束/ 和/ 针对/ 路径/ 遍历/ 两大类/ ./ 针对/ 时钟/ 约束/ 方法/ 的/ 基本/ 思想/ 是/ :/ 利用/ 状态/ 之间/ 时钟/ 约束/ 的/ 依赖/ 关系/ ,/ 减少/ 中间状态/ 的/ 生成/ ,/ 以/ 控制/ 状态/ 空间/ 的/ 规模/ ./ 文献/ [/ 22/ ]/ 提出/ 了/ 一种/ 约简/ 不/ 活跃/ 时钟/ 与/ 等价/ 时钟/ 的/ 技术/ ,/ 在/ 模型/ 检测/ 的/ 开始/ 阶段/ 就/ 将/ 不必要/ 的/ 时钟/ 变量/ 消除/ ,/ 从而/ 使得/ 验证/ 需要/ 的/ 状态/ 存储空间/ 减少/ ./ 文献/ [/ 23/ ]/ 提出/ 了/ 通过/ 区分/ 时间/ 自动机/ 时钟/ 的/ 最大/ 上界/ 与/ 下界/ ,/ 来/ 获取/ 比/ 时间/ 区域/ 更加/ 宽泛/ 的/ 表达形式/ ./ 针对/ 搜索/ 路径/ 的/ 研究/ 中/ 最具/ 代表性/ 的/ 是/ 偏序/ 约简/ 技术/ ./ 其/ 基本/ 思想/ 是/ 在/ 检验/ 过程/ 中/ ,/ 对于/ 独立/ 的/ 转换/ ,/ 有/ 许多/ 不同/ 的/ 转换/ 的/ 交叉/ 组合/ ,/ 因为/ 独立/ 转换/ 的/ 发生/ 次序/ 对/ 结果/ 没/ 影响/ ,/ 所以/ 可以/ 用/ 一条/ 代表性/ 的/ 路径/ 来/ 替代/ 多个/ 交叉/ 组合/ ./ 文献/ [/ 24/ ]/ 提出/ 了/ 一种/ 方法/ 消除/ 时间/ 自动机/ 网络/ 中/ 隐含/ 的/ 时钟/ 同步/ 信息/ ,/ 将/ 标准/ 的/ 偏序/ 约简/ 技术/ 应用/ 于/ 时间/ 自动机/ 上/ ./ 文献/ [/ 25/ ]/ 在/ 此基础/ 上/ ,/ 将/ 偏序/ 技术/ 用到/ 了/ 针对/ 时间/ 自动机/ 时间/ 发生/ 的/ LTL/ 模型/ 检验/ 上/ ./ 上述/ 方法/ 均/ 可以/ 约简/ 时间/ 自动机/ 的/ 状态/ 空间/ ./ 我们/ 将/ 考虑/ 结合/ 使用/ 这/ 多种/ 优化/ 方法/ ,/ 提高/ 模型/ 验证/ 的/ 效率/ ./ 6/ 案例/ 研究/ 本节/ 以/ 智能/ 会议室/ 应用/ 场景/ 为例/ ,/ 说明/ 如何/ 基于/ 环境/ 知识库/ ,/ 采用/ 时间/ 自动机/ 对/ 环境/ 实体/ 和物/ 联网/ 服务/ 进行/ 建模/ ,/ 并/ 以/ UPPAAL/ 为/ 工具/ 对物/ 联网/ 服务/ 正确性/ 验证/ ./ 假设/ 一个/ 智能/ 会议室/ 场景/ 为/ :/ 该/ 会议室/ 中/ 装有/ 一盏/ 日光灯/ 和/ 一台/ 投影仪/ ./ 日光灯/ 的/ 开关/ 应/ 按/ 如下/ 要求/ 被/ 自动控制/ :/ 当/ 投影仪/ 开启/ 时/ ,/ 日光灯/ 自动/ 关/ Page10/ 闭/ ;/ 当/ 投影仪/ 关闭/ ,/ 环境/ 光线/ 由亮/ 变暗/ 时/ ,/ 日光灯/ 在/ 20s/ 内/ 将/ 会/ 自动/ 开启/ ;/ 当/ 环境光/ 由暗/ 变亮/ 时/ ,/ 日光灯/ 在/ 20s/ 内/ 自动/ 关闭/ ./ 其/ 建模/ 过程/ 如下/ :/ 1/ ./ 创建/ 环境/ 实体类/ 被/ 感知/ 的/ 环境/ 实体类/ :/ Light/ ≡/ 〈/ Lit/ ,/ {/ Intensity/ }/ ,/ {/ showInt/ }/ ,/ Intensity/ / Bool/ 〉/ ,/ 表示/ 环境光/ 类型/ ./ 其中/ Intensity/ 表示/ 环境光/ 的/ 光照强度/ ,/ 这里/ 假设/ 它/ 只有/ 强和弱/ 两个/ 取值/ ,/ 因此/ 它/ 的/ 值域/ 类型/ 是/ Bool/ ./ 被/ 控制/ 的/ 环境/ 实体类/ :/ Lamp/ ≡/ 〈/ Lamp/ ,/ / ,/ {/ lon/ ,/ loff/ }/ ,/ doml/ 〉/ ,/ 表示/ 日光灯/ Projector/ ≡/ 〈/ Proj/ ,/ / ,/ {/ pon/ ,/ poff/ }/ ,/ domp/ 〉/ ,/ 表示/ 投影/ 2/ ./ 创建/ 环境/ 实体/ 实例/ 化/ 环境/ 实体类/ ,/ 获得/ 被/ 感知/ 的/ 环境/ 实体/ 和/ 被/ 控制/ 类型/ ;/ 仪/ 类型/ ./ 的/ 环境/ 实体/ :/ 〈/ lamp/ ,/ Lamp/ ,/ TAlamp/ 〉/ ,/ 表示/ 一个/ 日光灯/ 实体/ ,/ 其/ 行为/ 描述/ TAlamp/ 如图/ 8/ (/ a/ )/ 所示/ ./ 这里/ 假设/ 日光灯/ 从/ lon/ 和/ loff/ 两个/ 信道/ 分别/ 接收/ 开启/ 和/ 关闭/ 的/ 指令/ ;/ 〈/ light/ ,/ Light/ ,/ TAlight/ 〉/ ,/ 表示/ 一个/ 环境光/ 实体/ ,/ 其/ 行为/ 描述/ TAlight/ 如图/ 8/ (/ b/ )/ 所示/ ./ 这里/ 假设/ 环境光/ 每隔/ 一个/ 固定/ 的/ 时间/ 就/ 会/ 变换/ 一次/ 光照强度/ ,/ 用/ 变量/ intensity/ 记录/ 光照/ 的/ 强弱/ ,/ 并且/ 可/ 通过/ 信道/ showInt/ 输出/ 光照/ 强弱/ 值/ ;/ 〈/ projector/ ,/ Projector/ ,/ TAP/ 〉/ ,/ 表示/ 一个/ 投影仪/ 实体/ ,/ 其/ 行为/ 描述/ TAP/ 如图/ 8/ (/ c/ )/ 所示/ ./ 这里/ 假设/ 投影仪/ 每隔/ 一个/ 固定/ 的/ 时间/ 被/ 轮流/ 开启/ 、/ 关闭/ ,/ 并/ 通过/ 信道/ pon/ 和/ poff/ 表明/ 自身/ 开启/ 或/ 关闭/ 的/ 状态/ ./ 3/ ./ 为物/ 联网/ 服务/ 建模/ 上述/ 场景/ 蕴含/ 4/ 个物/ 联网/ 服务/ :/ 〈/ s1/ ,/ {/ Light/ }/ ,/ S1/ 〉/ ,/ 表示/ 光照/ 感知/ 服务/ ,/ 其/ 行为/ 描述/ S1/ 如图/ 8/ (/ d/ )/ 所示/ ,/ 该/ 服务/ 定时/ 通过/ showInt/ 信道/ 获取/ 光照强度/ 值/ ,/ 存放/ 于/ 变量/ l/ _/ int/ 中/ ,/ 并/ 根据/ 光照强度/ 的/ 不同/ 分别/ 通过/ 信道/ dark/ 和/ bright/ 与/ 其它/ 服务/ 通信/ ;/ 〈/ c1/ ,/ {/ Lamp/ }/ ,/ C1/ 〉/ ,/ 表示/ 日光灯/ 控制/ 服务/ ,/ 其/ 行为/ 描述/ C1/ 如图/ 8/ (/ e/ )/ 所示/ ,/ 该/ 服务/ 通过/ turnOnLamp/ 和/ turnOffLamp/ 两个/ 信道/ 与/ 其它/ 服务/ 通信/ ,/ 并/ 及时/ 将/ 对/ 日光灯/ 的/ 开关/ 指令/ 分别/ 通过/ 信道/ lon/ ,/ loff/ 发出/ ./ 注意/ 到/ 收到/ 消息/ 后/ 的/ 瞬时/ 开关/ 灯/ 指令/ 发出/ 动作/ 可/ 通过/ UPPAAL/ 所/ 提供/ 的/ Committed/ 状态/ 实现/ (/ 图中/ 状态/ 标为/ C/ )/ ;/ 〈/ p1/ ,/ {/ Proj/ }/ ,/ P1/ 〉/ ,/ 表示/ 处理/ 服务/ 1/ ,/ 其/ 行为/ 描述/ P1/ 如图/ 8/ (/ f/ )/ 表示/ ./ 若该/ 服务/ 从/ 信道/ pon/ 接收/ 到/ 投影仪/ 开启/ 的/ 消息/ ,/ 则/ 立即/ 通过/ 信道/ turnOffLamp/ 发出/ 日光灯/ 控制/ 服务/ 发出信号/ ;/ 〈/ p2/ ,/ / ,/ P2/ 〉/ ,/ 表示/ 处理/ 服务/ 2/ ,/ 其/ 行为/ 描述/ P2/ 如图/ 8/ (/ g/ )/ 所示/ ,/ 该/ 服务/ 通过/ 信道/ bright/ 和/ dark/ 获取/ 环境/ 光照/ 的/ 强弱/ 变化/ 情况/ ,/ 当/ 光照强度/ 变弱/ 时/ ,/ 它/ 通过/ 信道/ turnOnLamp/ 向/ 日光灯/ 控制/ 服务/ 发出信号/ ;/ 当/ 光照强度/ 变强/ 时/ ,/ 它/ 通过/ turnOffLamp/ 向/ 日光灯/ 控制/ 服务/ 发出信号/ ./ 上述/ 4/ 个/ 服务/ 组合/ 在/ 一起/ 构成/ 了/ 智能/ 会议室/ 服务/ ,/ 其/ 行为/ 表示/ 为/ 时间/ 自动机/ 网络/ :/ 4/ ./ 验证/ 物/ 联网/ 服务/ 对物/ 联网/ 服务/ 的/ 时效/ 正确性/ 进行/ 验证/ ,/ 需要/ 将/ 该/ 服务/ 与/ 相关/ 环境/ 实体/ 组合成/ 一个/ 整体/ 系统/ :/ 首先/ 我们/ 希望/ 验证/ 一条/ 重要/ 的/ 服务/ 安全/ 特性/ :/ 服务/ 在/ 运行/ 过程/ 中/ 不/ 停机/ ,/ 即/ 整个/ 系统/ 不/ 出现/ 死锁/ ,/ 该/ 性质/ 表示/ 为/ 时序/ 逻辑/ 公式/ :/ / □/ notdeadlock/ ./ 将/ 该/ 公式/ 输入/ 到/ UPPAAL/ 的/ 验证/ 器中/ ,/ 得到/ Page11/ 的/ 结果/ 是/ 性质/ 满足/ ./ 说明/ 上述/ 模型/ 描述/ 的/ 智能/ 会议室/ 服务/ 可/ 正常/ 运行/ ./ 下/ 3/ 条/ 逻辑/ 公式/ :/ 关于/ 日光灯/ 控制/ 的/ 3/ 条/ 性质/ 需要/ 分别/ 转化/ 为/ 以/ (/ 1/ )/ 当/ 投影仪/ 打开/ 时/ ,/ 日光灯/ 自动/ 关闭/ :/ (/ 2/ )/ 当/ 投影仪/ 关闭/ ,/ 环境/ 光线/ 由亮/ 变暗/ 时/ ,/ 日光灯/ 在/ 20s/ 内/ 将/ 会/ 自动/ 开启/ :/ light/ ./ dark/ ∧/ projector/ ./ off/ →/ lamp/ ./ on/ ∧/ light/ ./ c/ </ 20/ ./ (/ 3/ )/ 当/ 环境光/ 由暗/ 变亮/ 时/ ,/ 日光灯/ 在/ 20s/ 内/ 自动/ 关闭/ :/ light/ ./ bright/ →/ lamp/ ./ off/ ∧/ light/ ./ c/ </ 20/ ./ 这/ 3/ 条/ 性质/ 中/ 第/ 1/ 条/ 属于/ 活性/ 性质/ ,/ 后/ 两条/ 属于/ 时间/ 约束/ ./ 下面/ 我们/ 验证/ 其中/ 的/ 第/ 1/ 条/ 性质/ ./ 将/ 第/ 1/ 条/ 性质/ 要求/ 所/ 对应/ 的/ 公式/ 输入/ 到/ UPPAAL/ 的/ 验证/ 器中/ ,/ 得到/ 的/ 结果/ 是/ 该/ 性质/ 不能/ 被/ 满足/ ./ UPPAAL/ 给出/ 了/ 一个/ 导致/ 性质/ 不/ 满足/ 的/ 运行/ 轨迹/ ,/ 如图/ 9/ 所示/ ./ 图/ 9/ 智能/ 会议室/ 时间/ 自动机/ 网络/ 运行/ 轨迹/ 示例/ 图/ 9/ 所/ 表达/ 的/ 运行/ 轨迹/ 中/ ,/ 偶数/ 行/ 表示/ 通信/ 动作/ ,/ 奇数/ 行/ 记录/ 着/ 各/ 时间/ 自动机/ 状态/ 的/ 变化/ ,/ 其中/ 括号/ 内前/ 3/ 项/ 依次/ 记录/ 着/ 环境/ 实体/ Lamp/ ,/ projector/ 和/ light/ 的/ 状态/ ./ 通过/ 对/ 该/ 运行/ 轨迹/ 的/ 分析/ 可以/ 发现/ ,/ 导致/ 错误/ 发生/ 的/ 情况/ 是/ :/ 当/ projector/ 处于/ 开启/ 状态/ 后/ ,/ 尽管/ 服务/ p1/ 将/ 日光灯/ 关闭/ ,/ 但是/ 由于/ 光线/ 的/ 变暗/ ,/ 服务/ p2/ 又/ 将/ 使/ 日光灯/ 重新/ 开启/ ./ 解决/ 这一/ 问题/ 的/ 方法/ 是/ ,/ 为/ 服务/ p2/ 新增/ 一个/ 状态/ (/ 如图/ 10/ )/ ,/ 当/ 投影仪/ 开启/ 后/ ,/ 服务/ 进入/ 到/ 该/ 新/ 状态/ ,/ 并/ 不/ 控制/ 日光灯/ ,/ 直到/ 投影仪/ 关闭/ ./ 根据/ 以上/ 对/ 控制/ 服务/ p2/ 的/ 修改/ ,/ 通过/ UPPAAL/ 可验证/ 上述/ 性质/ 被/ 满足/ ./ 采用/ 同样/ 方法/ 可以/ 验证/ 上面/ 提到/ 的/ 物/ 联网/ 服务/ 的/ 另外/ 两条/ 时间/ 约束/ 相关/ 性质/ 的/ 可/ 满足/ 性/ ./ 从而/ 说明/ ,/ 上述/ 设计/ 的/ 物/ 联网/ 服务/ 满足/ 时效/ 正确性/ ./ 7/ 结束语/ 物/ 联网/ 是/ 物理/ 世界/ 和/ 信息/ 世界/ 的/ 无缝/ 融合/ ,/ 物/ 联网/ 服务/ 的/ 正确/ 建模/ 和/ 验证/ 需要/ 准确/ 地/ 描述/ 物理/ 世界/ 中/ 的/ 物理/ 实体/ ./ 基于/ 以上/ 观点/ ,/ 本文/ 提出/ 了/ 一个/ 基于/ 环境/ 建模/ 的/ 物/ 联网/ 服务/ 提供/ 框架/ ./ 在/ 此/ 框架/ 中/ ,/ 环境/ 实体/ 作为/ 一个/ 重要/ 的/ 概念/ 被/ 引入/ ,/ 用于/ 刻画/ 物理/ 世界/ 中/ 各种/ 物体/ 的/ 属性/ 和/ 行为/ ./ 物/ 联网/ 服务/ 的/ 行为/ 则/ 通过/ 与/ 环境/ 实体/ 的/ 交互/ 体现/ 出来/ ./ 本文/ 以/ 时间/ 自动机/ 为/ 工具/ ,/ 对/ 环境/ 实体/ 和物/ 联网/ 服务/ 的/ 行为/ 进行/ 建模/ ,/ 并用/ 时间/ 自动机/ 网络/ 来/ 刻画/ 服务/ 的/ 组合/ 和/ 它们/ 与/ 环境/ 实体/ 的/ 交互/ ./ 本文/ 以/ UPPAAL/ 为/ 工具/ 并/ 以/ 智能/ 会议室/ 为例/ ,/ 展示/ 了/ 物/ 联网/ 服务/ 建模/ 和/ 验证/ 的/ 完整/ 过程/ ./ 以/ UPPAAL/ 为/ 工具/ 对/ 时间/ 自动机/ 网络/ 做/ 模型/ 检测/ 时/ ,/ 随着/ 时间/ 自动机/ 数量/ 以及/ 自动机/ 内/ 状态/ 的/ 数量/ 、/ 时钟/ 变量/ 的/ 增多/ ,/ 验证/ 过程/ 的/ 复杂性/ 将/ 增高/ 、/ 耗时/ 增加/ ,/ 甚至/ 有/ 可能/ 由于/ 运算/ 资源/ 耗尽/ ,/ 导致/ 验证/ 无法/ 顺利完成/ ./ 因此/ ,/ 下/ 一步/ 工作/ 的/ 重点/ 是/ 刻画出/ 一种/ 合理/ 的/ 服务/ 行为/ 等价关系/ 及/ 服务/ 优化/ 方法/ ,/ 使/ 服务/ 在/ 功能/ 等价/ 的/ 情况/ 下/ ,/ 状态/ 尽可能/ 精简/ ,/ 从而/ 提高/ 正确性/ 验证/ 的/ 效率/ ./ 其次/ ,/ 本文/ 中/ 所/ 涉及/ 的/ 物/ 联网/ 服务/ 组合/ 是/ 一种/ 静态/ 组合/ 方式/ ,/ 即/ 无法/ 直接/ 根据/ 用户/ 所/ 提出/ 的/ 需求/ 由/ 原子/ 服务/ 动态/ 组合/ 出/ 满足要求/ 的/ 服务/ ./ 因此/ ,/ 在/ 本文/ 的/ 基础/ 上/ ,/ 构思/ 一种/ 物/ 联网/ 服务/ 按/ 需/ 动态/ 组合/ 方法/ 也/ 是/ 我们/ 关注/ 的/ 方向/ ./ 此外/ ,/ 我们/ 还/ 将/ 进一步/ 研究/ 环境/ 知识库/ 的/ 构建/ 、/ 管理/ 和/ 应用/ ./ Page12/ 

