Page1/ 合取范式/ 3/ 可/ 满足/ 问题/ 的/ 局部/ 搜索/ 近似算法/ 朱大铭/ 马绍汉张/ 平平/ (/ 山东大学/ 计算机/ 科学技术/ 学院/ 济南/ 250101/ )/ 摘要/ 合取范式/ 最大/ 可/ 满足/ 问题/ 是/ 理论/ 计算机科学/ 的/ 核心/ 问题/ ./ 局部/ 搜索/ 被/ 许多/ 求解/ 实践证明/ 是/ 解答/ 合取范式/ 最大/ 可/ 满足/ 问题/ 十分/ 有效/ 的/ 方法/ ,/ 但/ 未/ 见/ 关于/ 局部/ 搜索算法/ 解答/ 该/ 问题/ 性能/ 分析/ 的/ 结果/ ./ 文中/ 讨论/ 最大/ 3/ 可/ 满足/ 问题/ (/ Max/ -/ (/ 3/ )/ -/ Sat/ )/ 的/ 局部/ 搜索算法/ 并/ 分析/ 算法/ 性能/ ./ 证明/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 一位/ 跳变/ 局部/ 搜索算法/ 的/ 近似/ 性能比/ 为/ 4/ // 3/ ;/ 证明/ 一位/ 跳变/ 局部/ 搜索/ 后/ 跟/ 有/ 条件/ 全体/ 跳变/ 算法/ ,/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 5/ // 4/ ./ 设计/ 一位/ 跳变/ 加/ 全体/ 跳变/ 的/ 新/ 局部/ 搜索算法/ ,/ 证明/ 新/ 算法/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 8/ // 7/ ./ 将/ 8/ // 7/ -/ 近似/ 局部/ 搜索算法/ 推广/ 为/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索算法/ ,/ 证明/ 算法/ 的/ 近似/ 性能比/ 为/ (/ 2k/ +/ 2/ )/ // (/ 2k/ +/ 1/ )/ ,/ k/ / 4/ ./ 设计/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 两位/ 跳变/ 局部/ 搜索算法/ ,/ 证明/ 两位/ 跳变/ 局部/ 搜索算法/ 的/ 近似/ 性能比/ 为/ 1/ +/ 1/ // (/ 2k/ +/ 1/ +/ k/ (/ k/ -/ 1/ )/ // (/ n/ -/ k/ )/ )/ ,/ k/ / 4/ ./ 局部/ 搜索算法/ 经/ 多次/ 运行/ 可/ 进一步提高/ 求解/ 性能/ ./ 文中/ 结果显示/ ,/ 局部/ 搜索算法/ 在/ 合取范式/ 最大/ 可/ 满足/ 问题/ 求解/ 实践/ 中/ 表现/ 出/ 高性能/ ,/ 有/ 其/ 必然性/ ./ 关键词/ 算法/ ;/ 复杂性/ ;/ 近似/ 性能比/ ;/ 可/ 满足/ 性/ ;/ 局部/ 搜索/ 1/ 引言/ 合取范式/ 最大/ 可/ 满足/ 问题/ 是/ 理论/ 计算机科学/ 的/ 核心/ 问题/ ./ 由/ 布尔/ 变量/ 集合/ 与/ 项/ (/ clause/ )/ 集合/ 给定/ 的/ 布尔/ 表达式/ 即/ 是/ 合取范式/ ./ 合取范式/ 最大/ 可/ 满足/ 问题/ 要求/ 计算/ 布尔/ 变量/ 赋值/ ,/ 使/ 可/ 满足/ 的/ 项/ 数目/ 最大/ ./ 该/ 问题/ 简称/ 为/ Max/ -/ Sat/ ./ 因/ Max/ -/ Sat/ 是/ NP/ -/ Hard/ [/ 1/ ]/ ,/ 且/ 是/ Max/ -/ SNP/ -/ Hard/ [/ 2/ ]/ ,/ 因此/ 其/ 近似算法/ 和/ 实用/ 算法/ 设计/ 研究/ 成为/ 该/ 问题/ 研究/ 的/ 重心/ ./ Johnson/ 最先/ 设计/ 了/ 解答/ Max/ -/ Sat/ 问题/ 的/ 近似算法/ ,/ 并/ 证明/ 算法/ 的/ 近似/ 性能比/ 为/ 2/ [/ 3/ ]/ ./ Chen/ 、/ Friesen/ 、/ Zheng/ 证明/ Johnson/ 算法/ 的/ 近似/ 性能比/ 实际/ 为/ 3/ // 2/ [/ 4/ ]/ ./ Yannakakis/ 于/ 1994/ 年/ 给出/ 解答/ Max/ -/ Sat/ 问题/ 的/ 随机/ 算法/ ,/ 平均/ 近似/ 性能比/ 为/ 4/ // 3/ ./ Goemans/ 与/ Williamson/ 利用/ 线性规划/ 松弛法/ ,/ 给出/ 一个/ 更为/ 简单/ 的/ 随机/ 近似算法/ [/ 5/ ]/ ,/ 其/ 近似/ 性能比/ 仍为/ 4/ // 3/ ./ 限制/ 项/ 含有/ 字母/ 数/ 的/ Max/ -/ Sat/ 子/ 问题/ ,/ 在/ Max/ -/ Sat/ 问题/ 研究/ 中/ 占有/ 重要/ 位置/ ,/ 也/ 是/ 计算机科学/ 工作者/ 最早/ 尝试/ 讨论/ 算法/ 与/ 复杂性/ 所/ 研究/ 的/ 问题/ 之一/ ./ 本文/ 将/ 每个/ 项/ 含有/ 不/ 多于/ k/ 个/ 字母/ 的/ Max/ -/ Sat/ 子/ 问题/ 称为/ Max/ -/ k/ -/ Sat/ 问题/ ;/ 将/ 每个/ 项/ 含有/ 不少/ 于/ k/ 个/ 字母/ 的/ Max/ -/ Sat/ 子/ 问题/ 称为/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ ./ 早/ 在/ 1974/ 年/ ,/ Johnson/ 就/ 设计/ 了/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 组合/ 近似算法/ ,/ 近似/ 性能比/ 为/ 2k/ // (/ 2k/ -/ 1/ )/ [/ 3/ ]/ ./ 实际上/ ,/ 为/ 每个/ 布尔/ 变量/ 以/ 1/ 的/ 方法/ ,/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 的/ 平均/ 近似/ 性能比/ 即为/ 2k/ // (/ 2k/ -/ 1/ )/ [/ 6/ ]/ ./ Goemans/ 与/ Williamson/ 于/ 1995/ 年/ 给出/ 了/ 解答/ Max/ -/ 2/ -/ Sat/ 问题/ 的/ 1.139/ -/ 近似/ 随机/ 算法/ [/ 7/ ]/ ,/ 他们/ 所/ 采用/ 的/ 半定/ 规划/ 松弛法/ 突破/ 了/ 原有/ 近似算法/ 的/ 设计/ ,/ 进一步提高/ 了/ 算法/ 性能/ ./ Feige/ 与/ Goemans/ 利用/ 同样/ 方法/ 进一步/ 将/ 算法/ 的/ 近似/ 性能比/ 改进/ 为/ 1.074/ [/ 8/ ]/ ./ 利用/ 半定/ 规划/ 松弛法/ 也/ 可/ 适当/ 改进/ 解答/ Max/ -/ Sat/ 问题/ 的/ 算法/ 性能/ ./ Goemans/ 与/ Williamson/ 将/ 解答/ Max/ -/ Sat/ 问题/ 算法/ 的/ 近似/ 性能比/ 改进/ 为/ 1.32/ [/ 7/ ]/ ,/ Asano/ 与/ Williamson/ 又/ 将/ 算法/ 近/ Trevisan/ 、/ Sorkin/ 、/ Sudan/ 与/ Williamson/ 将/ Max/ -/ 3/ -/ Sat/ 归约/ 为/ Max/ -/ 2/ -/ Sat/ ,/ 得到/ Max/ -/ 3/ -/ Sat/ 问题/ 的/ 1.248/ -/ 近似算法/ [/ 10/ ]/ ,/ Trevisan/ 又/ 将/ 解答/ Max/ -/ 3/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 改进/ 为/ 1.211/ ,/ 并/ 将/ 解答/ Max/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 改进/ 为/ 1.25/ [/ 11/ ]/ ./ 另一方面/ ,/ Hastad/ 证明/ :/ 若/ P/ ≠/ NP/ ,/ 则/ 每个/ 项均/ 含有/ 恰好/ 3/ 个/ 字母/ 的/ Max/ -/ Sat/ 子/ 问题/ 不能/ 多项式/ 时间/ 近似/ 到/ 小于/ 8/ // 7/ [/ 12/ ]/ ./ 因此/ 若/ P/ ≠/ NP/ ,/ 则/ Max/ -/ 3/ -/ Sat/ 问题/ 和/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 均/ 不能/ 多项式/ 时间/ 近似/ 到/ 小于/ 8/ // 7/ ./ 而/ 为/ 布尔/ 变量/ 随机/ 赋值/ 的/ 简单/ 算法/ 解答/ 每个/ 项均/ 含有/ 3/ 个/ 字母/ 的/ Max/ -/ Sat/ 子/ 问题/ ,/ 恰好/ 使/ 平均/ 近似/ 性能比/ 达到/ 8/ // 7/ ./ Karloff/ 与/ Zwick/ 给出/ 解答/ Max/ -/ 3/ -/ Sat/ 问题/ 的/ 半定/ 规划/ 松弛法/ ,/ 解答/ 可/ 满足/ Max/ -/ 3/ -/ Sat/ 实例/ 的/ 近似/ 性能比/ 能够/ 达到/ 8/ // 7/ [/ 13/ ]/ ,/ 后来/ 他们/ 证明/ 该/ 方法/ 解答/ 任意/ Max/ -/ 3/ -/ Sat/ 实例/ 的/ 近似/ 性能比/ 也/ 为/ 8/ // 7/ [/ 14/ ]/ ./ Halperin/ 与/ Zwick/ 又/ 给出/ 了/ 解答/ Max/ -/ 4/ -/ Sat/ 问题/ 的/ 半定/ 规划/ 松弛/ 算法/ ,/ 近似/ 性能比/ 为/ 1.147/ [/ 14/ ]/ ./ Johnson/ 算法/ 是/ 我们/ 所知/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 性能/ 最好/ 的/ 确定/ 近似算法/ ;/ Karloff/ 与/ Zwick/ 给出/ 的/ 半定/ 规划/ 松弛法/ 是/ 我们/ 所知/ 解答/ Max/ -/ 3/ -/ Sat/ 问题/ 性能/ 最好/ 的/ 随机/ 近似算法/ ./ 实际上/ 前述/ 近似算法/ 中/ ,/ 仅/ 有/ Johnson/ 算法/ 为/ 确定/ 算法/ ./ 其他/ 算法/ 均/ 为/ 随机/ 近似算法/ ,/ 因此/ 算法/ 近似/ 性能比/ 均/ 为/ 平均/ 近似/ 性能比/ ./ 因为/ 随机/ 算法/ 去/ 随机/ 过程/ 的/ 时间/ 复杂性/ 太/ 大/ ,/ 这些/ 算法/ 的/ 实用性/ 仍显/ 不足/ ./ 似/ 性能比/ 改进/ 为/ 1.254/ [/ 9/ ]/ ./ 以/ 寻找/ 问题/ 精确/ 解为/ 目标/ 的/ 实用/ 算法/ 设计/ 研究/ 在/ Max/ -/ Sat/ 求解/ 实践/ 中/ 同样/ 显示/ 出/ 活力/ ,/ 这样/ 的/ 算法/ 可/ 分为/ 回溯/ 搜索/ 法/ 和/ 局部/ 最优/ 搜索/ 法/ 两大类/ ./ 回溯/ 算法/ 要/ 得到/ 精确/ 解/ ,/ 总/ 不能/ 摆脱/ 指数/ 时间/ 或弱/ 指数/ 时间/ 复杂性/ [/ 15/ -/ 16/ ]/ ./ 多数/ 程序/ 设计者/ 更/ 倾向/ 于/ 采用/ 局部/ 搜索/ 方法/ 设计/ 解答/ Max/ -/ Sat/ 、/ Max/ -/ k/ -/ Sat/ 及/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 求解/ 算法/ ,/ 这/ 是因为/ 局部/ 搜索算法/ 步骤/ 简单/ ,/ 且/ 实际/ 求解/ 经验/ 表明/ ,/ 局部/ 搜索算法/ 的/ 求解/ 性能/ 往往/ 十分/ 理想/ ./ 最早/ 的/ Max/ -/ Sat/ 局部/ 搜索算法/ 研究/ 可追溯/ 到/ Page3Gu/ [/ 17/ ]/ 与/ Selman/ 等/ [/ 18/ ]/ 的/ 求解/ 实验/ 以及/ Papadimitri/ -/ ou/ [/ 19/ ]/ 与/ Koutsoupias/ [/ 20/ ]/ 的/ 理论/ 分析/ ./ Max/ -/ Sat/ 问题/ 局部/ 搜索算法/ 的/ 基本/ 步骤/ 为/ :/ (/ 1/ )/ 随机/ 为/ 布尔/ 变量/ 赋/ 初值/ ;/ (/ 2/ )/ 重复/ 修正/ 部分/ 布尔/ 变量/ 赋值/ ,/ 以/ 改善/ 当前/ 解/ 质量/ ,/ 直到/ 不能/ 修正/ 为止/ ./ 这种/ 局部/ 搜索算法/ 需要/ 重新/ 选择/ 初始/ 赋值/ ,/ 多次/ 运行/ ,/ 才能/ 保证/ 以/ 较大/ 概率/ 获得/ Max/ -/ Sat/ 精确/ 解/ [/ 21/ ]/ ./ 另一类/ 局部/ 搜索算法/ ,/ 其/ 修正/ 布尔/ 变量/ 赋值/ 的/ 步骤/ 也/ 是/ 随机/ 的/ ,/ 可/ 保证/ 算法/ 只/ 需/ 选择/ 一次/ 初始/ 赋值/ ,/ 就/ 可/ 概率/ 为/ 1/ 地/ 获得/ Max/ -/ Sat/ 精确/ 解/ [/ 22/ ]/ ./ 合取范式/ 可/ 满足/ 问题/ 的/ 算法/ 及其/ 复杂性/ 的/ 其他/ 研究/ 结果/ 可见/ 文献/ [/ 23/ -/ 25/ ]/ ./ 虽然/ 实践/ 表明/ 局部/ 搜索算法/ 的/ 求解/ 性能/ 十分/ 理想/ ,/ 但/ 未见有人/ 给出/ 过/ 局部/ 搜索算法/ 解答/ Max/ -/ Sat/ 问题/ 及其/ 子/ 问题/ 的/ 性能/ 分析/ 结果/ ./ 本文/ 研究/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索算法/ ,/ 并/ 分析/ 算法/ 的/ 求解/ 性能/ ./ 证明/ 一位/ 跳变/ 局部/ 搜索算法/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 4/ // 3/ ;/ 证明/ 一位/ 跳变/ 加/ 全体/ 跳变/ 的/ 局部/ 搜索算法/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 5/ // 4/ ;/ 在/ 前述/ 性能/ 分析/ 的/ 基础/ 上/ ,/ 设计/ 一个/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 新/ 局部/ 搜索算法/ ,/ 证明/ 新/ 局部/ 搜索算法/ 的/ 近似/ 性能比/ 为/ 8/ // 7/ ./ 我们/ 可/ 针对/ 3/ 个/ 算法/ 分别/ 给出/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ ,/ 使/ 算法/ 解答/ 它们/ 的/ 近似/ 性能比/ 恰好/ 达到/ 前面/ 所/ 证明/ 的/ 近似/ 性能比/ ./ 根据/ Hastad/ 的/ 反面/ 结果/ ,/ 新/ 算法/ 所/ 能/ 达到/ 的/ 近似/ 性能比/ ‘/ 8/ // 7/ ’/ ,/ 是/ 多项式/ 时间/ 能够/ 逼近/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 最好/ 近似/ 性能比/ ./ 另外/ 可/ 将/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 8/ // 7/ -/ 近似/ 局部/ 搜索算法/ 推广/ 为/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索算法/ ,/ 近似/ 性能比/ 为/ (/ 2k/ +/ 2/ )/ // (/ 2k/ +/ 1/ )/ ,/ k/ / 4/ ./ 最后/ 设计/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 两位/ 跳变/ 局部/ 搜索算法/ ,/ 证明/ 算法/ 近似/ 性能比/ 为/ 1/ +/ k/ / 4/ ./ 本文/ 局部/ 搜索算法/ 可以/ 运行/ 多次/ ,/ 从中/ 寻找/ 最好/ 的/ 解/ ./ 因为/ 每次/ 运行/ 的/ 近似/ 性能比/ 最大/ 为/ 8/ // 7/ ,/ 所以/ 多次/ 运行/ 后/ ,/ 算法/ 得到/ 的/ 解/ 往往/ 十分/ 接近/ 最优/ 或/ 已经/ 是/ 最优/ 解/ ./ Johnson/ 算法/ 虽然/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 也/ 为/ 8/ // 7/ ,/ 但/ 算法/ 每次/ 运行/ 只能/ 得到/ 同样/ 的/ 解/ ./ 随机/ 算法/ 虽然/ 通过/ 去/ 随机/ 过程/ 可以/ 保证/ 算法/ 能够/ 达到/ 其/ 平均/ 近似/ 性能比/ 8/ // 7/ ,/ 但/ 去/ 随机/ 的/ 时间/ 复杂性/ 太高/ ,/ 影响/ 算法/ 的/ 实用性/ ./ 第/ 2/ 节/ 给出/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 一位/ 跳变/ 局部/ 搜索算法/ ,/ 证明/ 其/ 近似/ 性能比/ 为/ 4/ // 3/ ;/ 第/ 3/ 节/ 给出/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 一位/ 跳变/ 后/ 跟/ 全体/ 跳变/ 局部/ 搜索算法/ ,/ 证明/ 其/ 近似/ 性能比/ 为/ 5/ // 4/ ;/ 第/ 4/ 节/ 仍然/ 利用/ 一位/ 跳变/ 和/ 全体/ 跳变/ ,/ 设计/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 新/ 局部/ 搜索算法/ ,/ 证明/ 其/ 近似/ 性能比/ 为/ 8/ // 7/ ;/ 第/ 5/ 节/ 利用/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索/ 方法/ ,/ 设计/ 解答/ Max/ -/ (/ k/ / 4/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索算法/ ;/ 第/ 6/ 节/ 分析/ 两位/ 跳变/ 局部/ 搜索算法/ 的/ 性能/ ./ 2/ 一位/ 跳变/ 的/ 4/ // 3/ -/ 近似/ 局部/ 搜索算法/ Max/ -/ (/ 3/ )/ -/ SAT/ 问题/ 形式化/ 描述/ 为/ 实例/ ./ 布尔/ 变量/ 集合/ U/ =/ {/ u1/ ,/ …/ ,/ un/ }/ ,/ 项/ 集合/ C/ =/ {/ C1/ ,/ …/ ,/ Cm/ }/ ,/ 每个/ 项均/ 含有/ 不少/ 于/ 3/ 个/ 布尔/ 变量/ 字母/ ./ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ …/ ,/ x/ [/ t/ ,/ kt/ ]/ }/ ,/ 其中/ x/ [/ t/ ,/ j/ ]/ ∈/ {/ u1/ ,/ …/ ,/ un/ ,/ u/ -/ 询问/ ./ 求/ U/ 中/ 布尔/ 变量/ 的/ 赋值/ a/ :/ U/ →/ {/ T/ ,/ F/ }/ ,/ 最大化/ |/ {/ Ct/ :/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ ∨/ …/ ∨/ a/ (/ x/ [/ t/ ,/ kt/ ]/ )/ =/ T/ }/ |/ ./ 在/ Max/ -/ (/ 3/ )/ -/ SAT/ 实例/ 中/ ,/ ui/ 和/ u/ -/ 变量/ 字母/ ,/ ui/ (/ u/ -/ 母/ ,/ 1/ / i/ / n/ ./ 布尔/ 变量/ 赋值/ 也/ 称为/ 布尔/ 变量/ 字母/ 赋值/ ./ a/ (/ x/ [/ t/ ,/ j/ ]/ )/ 表示/ 由/ a/ 为/ U/ 中/ 布尔/ 变量/ 赋值/ 后/ ,/ 布尔/ 变量/ 字母/ x/ [/ t/ ,/ j/ ]/ 的/ 取值/ ./ 为/ 表述/ 简单/ ,/ 我们/ 总是/ 假设/ 每个/ 项/ 含有/ 3/ 个/ 布尔/ 变量/ 字母/ ,/ 并/ 只/ 针对/ 这种/ 问题/ 实例/ 给出/ 算法/ 和/ 性能/ 分析/ ./ 适当/ 修改/ 算法/ 即可/ 用于/ 解答/ 那些/ 每个/ 项/ 含有/ 不少/ 于/ 3/ 个/ 字母/ 的/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ ,/ 近似/ 性能比/ 分析/ 的/ 结论/ 仍然/ 成立/ ./ 设/ U/ 的/ 赋值/ a/ 使/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ ∨/ a/ (/ x/ [/ t/ ,/ 2/ ]/ )/ ∨/ a/ (/ x/ [/ t/ ,/ 3/ ]/ )/ =/ T/ ,/ 则/ 称/ Ct/ 被/ a/ 满足/ ./ 下面/ 也/ 直接/ 称/ Ct/ 被/ 满足/ 为/ Ct/ 满足/ ,/ Ct/ 不/ 被/ 满足/ 为/ Ct/ 不/ 满足/ ./ 若/ 一个/ 项/ 同时/ 含有/ ui/ 和/ u/ -/ 被/ 满足/ ,/ 因此/ 下面/ 总是/ 假设/ Max/ -/ (/ 3/ )/ -/ SAT/ 实例/ 中/ ,/ 任意/ 项均/ 不/ 同时/ 含有/ ui/ 和/ u/ -/ 定义/ 1/ ./ 给定/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 若项/ Ct/ 含有/ 布尔/ 变量/ 字母/ ui/ 且/ a/ (/ ui/ )/ =/ T/ ,/ 或/ Ct/ 含有/ 布尔/ 变量/ i/ 且/ a/ (/ ui/ )/ =/ F/ ,/ 称/ Ct/ 被/ a/ (/ ui/ )/ 满足/ ;/ 若项/ Ct/ 含/ 字母/ u/ -/ 有/ 布尔/ 变量/ 字母/ ui/ 且/ a/ (/ ui/ )/ =/ F/ ,/ 或/ Ct/ 含有/ 布尔/ 变量/ i/ 且/ a/ (/ ui/ )/ =/ T/ ,/ 称/ Ct/ 不/ 被/ a/ (/ ui/ )/ 满足/ ./ 将/ Ct/ 被/ 字母/ u/ -/ a/ (/ ui/ )/ 满足/ 简记/ 为/ a/ (/ Ct/ ,/ ui/ )/ =/ T/ ,/ Ct/ 不/ 被/ a/ (/ ui/ )/ 满足/ 简记/ 为/ a/ (/ Ct/ ,/ ui/ )/ =/ F/ ./ 若/ Ct/ 不/ 含有/ 布尔/ 变量/ 字母/ ui/ ,/ 则/ 记/ a/ (/ Ct/ ,/ ui/ )/ =/ N/ ./ Ct/ 被/ a/ (/ ui/ )/ 满足/ ,/ 则/ Ct/ 肯定/ 被/ a/ (/ U/ )/ 满足/ ./ 考虑/ Page4/ 如下/ 的/ 局部/ 搜索/ 方法/ :/ 先/ 任意/ 选择/ U/ 中/ 布尔/ 变量/ 的/ 赋值/ ,/ 然后/ 选择/ 一个/ 布尔/ 变量/ 将/ 其/ 赋值/ 取反/ ,/ 以/ 增加/ C/ 中/ 被/ 满足/ 的/ 项/ 数目/ ./ 重复/ 选择/ 布尔/ 变量/ 并/ 将/ 赋值/ 取反/ 的/ 步骤/ ,/ 一直/ 进行/ 到/ 不/ 存在/ 布尔/ 变量/ ,/ 将/ 其/ 赋值/ 取反/ 可/ 增加/ C/ 中/ 被/ 满足/ 的/ 项/ 数目/ 为止/ ./ 将/ 这种/ 方法/ 称为/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 一位/ 跳变/ 算法/ ./ 设/ C/ [/ j/ ,/ T/ ]/ 表示/ 被/ a/ (/ uj/ )/ 满足/ ,/ 但/ 不/ 被/ 其它/ 布尔/ 变量/ 赋值/ 满足/ 的/ 项/ 集合/ ,/ C/ [/ j/ ,/ F/ ]/ 表示/ 不/ 被/ a/ (/ uj/ )/ 满足/ ,/ 且/ 不/ 满足/ 的/ 项/ 集合/ ,/ 即/ C/ [/ j/ ,/ T/ ]/ =/ {/ Ct/ |/ a/ (/ Ct/ ,/ uj/ )/ =/ T/ ,/ a/ (/ Ct/ ,/ ux/ )/ ∈/ {/ F/ ,/ N/ }/ ,/ x/ ≠/ j/ }/ ,/ C/ [/ j/ ,/ F/ ]/ =/ {/ Ct/ |/ a/ (/ Ct/ ,/ uj/ )/ =/ F/ ,/ a/ (/ Ct/ ,/ ux/ )/ ∈/ {/ F/ ,/ N/ }/ ,/ x/ ≠/ j/ }/ ,/ 1/ / j/ / n/ ./ 为/ 布尔/ 变量/ 赋值/ 的/ 一位/ 跳变/ 局部/ 搜索算法/ 如下/ ./ 算法/ 1/ ./ one/ -/ flip/ (/ U/ ,/ C/ )/ ./ 1/ ./ a/ (/ uk/ )/ ←/ Rand/ {/ T/ ,/ F/ }/ ,/ 1/ / k/ / n/ ;/ 2/ ./ While/ (/ 存在/ uj/ ,/ 使/ |/ C/ [/ j/ ,/ T/ ]/ |/ </ |/ C/ [/ j/ ,/ F/ ]/ |/ )/ do3/ ./ a/ (/ uj/ )/ ←/ a/ (/ uj/ )/ ;/ 4/ ./ EndWhile5/ ./ Returna/ (/ U/ )/ ./ 算法/ 中/ ,/ Rand/ {/ T/ ,/ F/ }/ 表示/ 随机/ 选择/ ‘/ T/ ’/ 或/ ‘/ F/ ’/ 的/ 函数/ ./ 算法/ 的/ While/ 循环/ 中/ ,/ 执行/ 一次/ 语句/ 3/ 的/ 变量/ 赋值/ 取反/ 操作/ ,/ 则/ C/ [/ j/ ,/ F/ ]/ 中/ 的/ 项/ 由/ 不/ 满足/ 变为/ 满足/ ,/ C/ [/ j/ ,/ T/ ]/ 中/ 的/ 项/ 由/ 满足/ 变为/ 不/ 满足/ ,/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ./ 因/ C/ 中/ 只有/ m/ 个/ 项能/ 被/ 满足/ ,/ 所以/ 算法/ While/ 循环/ 一定/ 能够/ 结束/ ./ 对于/ 每个/ 布尔/ 变量/ ,/ 计算/ C/ [/ ·/ ,/ T/ ]/ 和/ C/ [/ ·/ ,/ F/ ]/ 的/ 时间/ 复杂性/ 为/ O/ (/ m/ )/ ,/ 所以/ 算法/ 在/ While/ 循环/ 中/ 找到/ 一个/ uj/ 满足/ |/ C/ [/ j/ ,/ T/ ]/ |/ </ |/ C/ [/ j/ ,/ F/ ]/ |/ 的/ 时间/ 复杂性/ 为/ O/ (/ mn/ )/ ./ 每/ 循环/ 一次/ ,/ 被/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ,/ 所以/ 算法/ 时间/ 复杂性/ 为/ O/ (/ m2n/ )/ ./ 下面/ 分析/ 算法/ 的/ 性能/ ./ 引理/ 1/ ./ 算法/ 结束/ 时/ ,/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 对于/ 每个/ uj/ ,/ 1/ / j/ / n/ ,/ 总有/ |/ C/ [/ j/ ,/ T/ ]/ |/ / |/ C/ [/ j/ ,/ F/ ]/ |/ ./ 证明/ ./ 若/ 存在/ uj/ ,/ 满足/ |/ C/ [/ j/ ,/ T/ ]/ |/ </ |/ C/ [/ j/ ,/ F/ ]/ |/ ,/ 由/ While/ 循环/ 的/ 条件/ 可知/ 算法/ 循环/ 不会/ 结束/ ./ 引理/ 2/ ./ 设/ 算法/ 结束/ 时/ ,/ 被/ a/ (/ U/ )/ 满足/ 的/ 项集/ 证明/ ./ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ }/ ∈/ 合为/ S/ [/ a/ ]/ ,/ 则/ |/ S/ [/ a/ ]/ |/ / ∑/ nS/ [/ a/ ]/ ,/ x/ [/ t/ ,/ j/ ]/ ∈/ {/ u1/ ,/ …/ ,/ un/ ,/ u/ -/ 若/ Ct/ 中/ 至少/ 有/ 两个/ 布尔/ 变量/ 字母/ 取值/ 为/ T/ ,/ 则/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ 中/ 每个/ 字母/ 赋值/ 取反/ ,/ Ct/ 仍然/ 满足/ ;/ 其它/ 字母/ 赋值/ 取反/ ,/ 不/ 影响/ Ct/ 的/ 可/ 满足/ 性/ ./ 所以/ 由/ C/ [/ j/ ,/ T/ ]/ 的/ 定义/ 可知/ ,/ Ct/ / C/ [/ j/ ,/ T/ ]/ ,/ 1/ / j/ / n/ ./ 若/ Ct/ 中/ 只有/ 一个/ 布尔/ 变量/ 字母/ 取值/ 为/ T/ ,/ 不妨/ 设/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ T/ ,/ 则/ 仅/ 当/ x/ [/ t/ ,/ 1/ ]/ 赋值/ 取反/ 时/ ,/ Ct/ 由/ 满足/ 变为/ 不/ 满足/ ./ 设/ x/ [/ t/ ,/ 1/ ]/ ∈/ {/ uj/ ,/ u/ -/ C/ [/ j/ ,/ T/ ]/ ,/ 但/ 对于/ x/ ≠/ j/ ,/ Ct/ / C/ [/ x/ ,/ T/ ]/ ,/ 即/ Ct/ 最多/ 出现/ 在/ 一个/ C/ [/ j/ ,/ T/ ]/ 中/ ,/ 所以/ |/ S/ [/ a/ ]/ |/ / ∑/ n/ 引理/ 3/ ./ 设/ 算法/ 结束/ 时/ ,/ 不/ 被/ a/ (/ U/ )/ 满足/ 的/ 项/ 集合/ 为/ NS/ [/ a/ ]/ ,/ 则/ ∑/ n/ 证明/ ./ 我们/ 证明/ NS/ [/ a/ ]/ 中/ 的/ 每个/ 项/ 在/ C/ [/ 1/ ,/ F/ ]/ ,/ …/ ,/ C/ [/ n/ ,/ F/ ]/ 中/ 至少/ 出现/ 3/ 次/ ,/ 即/ 任意/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ 存在/ 至少/ 3/ 个/ 正整数/ j1/ ,/ j2/ ,/ j3/ ,/ 使/ Ct/ ∈/ C/ [/ j1/ ,/ F/ ]/ ,/ Ct/ ∈/ C/ [/ j2/ ,/ F/ ]/ ,/ Ct/ ∈/ C/ [/ j3/ ,/ F/ ]/ ./ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ }/ ∈/ NS/ [/ a/ ]/ ,/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ F/ ,/ a/ (/ x/ [/ t/ ,/ 2/ ]/ )/ =/ F/ ,/ a/ (/ x/ [/ t/ ,/ 3/ ]/ )/ =/ F/ ./ x/ [/ t/ ,/ 1/ ]/ 或/ x/ [/ t/ ,/ 2/ ]/ 或/ x/ [/ t/ ,/ 3/ ]/ 赋值/ 取反/ ,/ Ct/ 会/ 由/ 不/ 满足/ 变为/ 满足/ ,/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 1/ ]/ )/ =/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 2/ ]/ )/ =/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 3/ ]/ )/ =/ T/ ./ 设/ x/ [/ t/ ,/ 1/ ]/ ∈/ {/ uj1/ ,/ u/ -/ {/ uj2/ ,/ u/ -/ Ct/ ∈/ C/ [/ j2/ ,/ F/ ]/ ,/ Ct/ ∈/ C/ [/ j3/ ,/ F/ ]/ ./ 所以/ ∑/ n3/ |/ NS/ [/ a/ ]/ |/ ./ 合为/ S/ [/ a/ ]/ ,/ 则/ |/ S/ [/ a/ ]/ |/ / 3/ 定理/ 1/ ./ 设/ 算法/ 结束/ 时/ ,/ 被/ a/ (/ U/ )/ 满足/ 的/ 项集/ j2/ }/ ,/ x/ [/ t/ ,/ 3/ ]/ ∈/ {/ uj3/ ,/ u/ -/ 证明/ ./ 由/ 引理/ 2/ 、/ 引理/ 1/ 和/ 引理/ 3/ 得/ |/ S/ [/ a/ ]/ |/ / ∑/ n/ 所以/ ,/ |/ C/ |/ =/ |/ S/ [/ a/ ]/ |/ +/ |/ NS/ [/ a/ ]/ |/ / 4/ 即/ |/ S/ [/ a/ ]/ |/ / 3/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 不/ 大于/ 4/ // 3/ ./ 由/ 定理/ 1/ 可知/ ,/ 算法/ one/ -/ flip/ (/ ·/ )/ 解答/ Max/ -/ 例/ ./ U/ =/ {/ u1/ ,/ u2/ ,/ u3/ }/ ,/ C/ =/ {/ C1/ =/ {/ u1/ ,/ u2/ ,/ u3/ }/ ,/ C2/ =/ {/ u/ -/ u2/ ,/ u/ -/ 3/ }/ }/ ./ 当/ a/ (/ u1/ )/ =/ a/ (/ u2/ )/ =/ a/ (/ u3/ )/ =/ F/ 时/ ,/ 算法/ one/ -/ flip/ (/ ·/ )/ 得到/ 一个/ 局部/ 最优/ 解/ ,/ C1/ 不能/ 被/ a/ (/ U/ )/ 满足/ ,/ C2/ ,/ C3/ ,/ C4/ 均/ 被/ 满足/ ,/ 算法/ 解答/ 这个/ 实例/ 的/ 近似/ 性能比/ 恰为/ 4/ // 3/ ./ 若/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ 中/ ,/ 某些/ 项/ 含有/ 多于/ 3/ 个/ 布尔/ 变量/ 字母/ ,/ 算法/ one/ -/ flip/ (/ ·/ )/ 并不需要/ 任何/ 改/ Page5/ 变/ ,/ 即可/ 解答/ 这样/ 的/ 实例/ ,/ 近似/ 性能比/ 仍为/ 4/ // 3.3/ 一位/ 跳变/ 加/ 全体/ 跳变/ 5/ // 4/ -/ 近似/ 局部/ 搜索算法/ 一个/ 项/ Ct/ 被/ 满足/ ,/ 其中/ 的/ 3/ 个/ 布尔/ 变量/ 字母/ 可能/ 有/ 1/ 个/ 字母/ 赋值/ 为/ T/ ,/ 或/ 有/ 两个/ 字母/ 赋值/ 为/ T/ ,/ 或/ 有/ 3/ 个/ 字母/ 赋值/ 为/ T/ ./ 还/ 可/ 观察/ 到/ ,/ 前面/ 定义/ 的/ C/ [/ j/ ,/ T/ ]/ (/ 1/ / j/ / n/ )/ 中仅/ 含有/ 一个/ 字母/ 赋值/ 为/ T/ 而/ 被/ a/ (/ U/ )/ 满足/ 的/ 项/ ./ 为/ 更/ 准确/ 地/ 度量/ 被/ 满足/ 的/ 项/ 数目/ ,/ 我们/ 根据/ 一个/ 项中/ 含有/ 的/ 被/ 赋值/ 为/ ‘/ T/ ’/ 的/ 字母/ 数目/ ,/ 进一步/ 将/ 项/ 分类/ ./ 定义/ 2/ ./ 给定/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ U/ ,/ C/ ,/ 设/ a/ :/ U/ →/ {/ T/ ,/ F/ }/ 为/ 布尔/ 变量/ 赋值/ ,/ Ct/ ∈/ C/ 为/ 任意/ 含有/ kt/ (/ / 3/ )/ 个/ 字母/ 的/ 项/ ./ 对于/ j/ ,/ 0/ / j/ / kt/ ,/ 若/ Ct/ 中有/ j/ 个/ 布尔/ 变量/ 字母/ 赋值/ 为/ T/ ,/ 另外/ 字母/ 赋值/ 为/ F/ ,/ 则/ 称/ Ct/ 关于/ a/ (/ U/ )/ 是/ j/ -/ 满足/ 的/ ./ 一个/ 项是/ 0/ -/ 满足/ 即/ 这个/ 项/ 不/ 被/ 满足/ ;/ 一个/ 项是/ j/ (/ / 1/ )/ -/ 满足/ 的/ ,/ 则/ 这个/ 项/ 肯定/ 被/ 满足/ ./ 若/ 一个/ 项/ 含有/ 的/ 所有/ 布尔/ 变量/ 字母/ 均/ 被/ 赋值/ 为/ T/ ,/ 则/ 称/ 这个/ 项为/ 全/ 满足/ 的/ ;/ 若/ 一个/ 项/ 被/ 满足/ ,/ 但/ 不是/ 全/ 满足/ 的/ ,/ 则/ 称/ 这个/ 项为/ 半/ 满足/ 的/ ./ 利用/ 全/ 满足/ 和/ 不/ 满足/ 的/ 项/ 可以/ 因/ 布尔/ 变量/ 赋值/ 全体/ 跳变/ 而/ 相互/ 转化/ ,/ 可/ 给出/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 性能/ 更好/ 的/ 算法/ ./ 下面/ 仍然/ 假设/ 每个/ 项/ 总/ 含有/ 3/ 个/ 布尔/ 变量/ 字母/ ./ 设/ a/ (/ U/ )/ 为/ U/ 的/ 赋值/ ,/ 仍然/ 设/ S/ [/ a/ ]/ 和/ NS/ [/ a/ ]/ 分别/ 表示/ 被/ a/ (/ U/ )/ 满足/ 和/ 不/ 被/ a/ (/ U/ )/ 满足/ 的/ 项/ 集合/ ,/ 其中/ 设/ S/ [/ a/ ,/ 1/ ]/ 、/ S/ [/ a/ ,/ 2/ ]/ 、/ S/ [/ a/ ,/ 3/ ]/ 分别/ 表示/ 关于/ a/ (/ U/ )/ 是/ 1/ -/ 满足/ 、/ 2/ -/ 满足/ 和/ 3/ -/ 满足/ 的/ 项/ 集合/ ./ 显然/ S/ [/ a/ ]/ =/ S/ [/ a/ ,/ 1/ ]/ ∪/ S/ [/ a/ ,/ 2/ ]/ ∪/ S/ [/ a/ ,/ 3/ ]/ ./ 引理/ 4/ ./ 任给/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ a/ -/ (/ U/ )/ 是/ a/ (/ U/ )/ 中/ 每个/ 布尔/ 变量/ 赋值/ 均/ 取反/ 得到/ 的/ 布尔/ 变量/ 赋值/ ,/ 则/ S/ [/ a/ ,/ 1/ ]/ =/ S/ [/ a/ -/ ,/ 2/ ]/ ,/ S/ [/ a/ ,/ 2/ ]/ =/ S/ [/ a/ -/ ,/ 1/ ]/ ,/ S/ [/ a/ ,/ 3/ ]/ =/ NS/ [/ a/ -/ ]/ ,/ NS/ [/ a/ ]/ =/ S/ [/ a/ -/ ,/ 3/ ]/ ./ 证明/ ./ 考察/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ }/ ,/ 若/ Ct/ ∈/ S/ [/ a/ ,/ 1/ ]/ ,/ 不妨/ 设/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 1/ ]/ )/ =/ T/ ,/ 则/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 2/ ]/ )/ =/ F/ ,/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 3/ ]/ )/ =/ F/ ./ 将/ U/ 中/ 布尔/ 变量/ 赋值/ 全部/ 取反/ ,/ 得到/ a/ -/ (/ Ct/ ,/ x/ [/ t/ ,/ 1/ ]/ )/ =/ F/ ,/ a/ -/ (/ Ct/ ,/ x/ [/ t/ ,/ 2/ ]/ )/ =/ T/ ,/ a/ -/ (/ Ct/ ,/ x/ [/ t/ ,/ 3/ ]/ )/ =/ T/ ./ 所以/ Ct/ 关于/ a/ -/ (/ U/ )/ 是/ 2/ -/ 满足/ 的/ ./ 每个/ 关于/ a/ -/ (/ U/ )/ 为/ 2/ -/ 满足/ 的/ 项均/ 可/ 由/ 关于/ a/ (/ U/ )/ 为/ 1/ -/ 满足/ 的/ 项/ 其/ 布尔/ 变量/ 赋值/ 取反/ 得到/ ./ 所以/ S/ [/ a/ ,/ 1/ ]/ =/ S/ [/ a/ -/ ,/ 2/ ]/ ./ 同理可证/ :/ S/ [/ a/ ,/ 2/ ]/ =/ S/ [/ a/ -/ ,/ 1/ ]/ ,/ S/ [/ a/ ,/ 3/ ]/ =/ NS/ [/ a/ -/ ]/ ,/ NS/ [/ a/ ]/ =/ S/ [/ a/ -/ ,/ 3/ ]/ ./ 推论/ 1/ ./ 任给/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 则/ 必有/ |/ S/ [/ a/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ 或/ |/ S/ [/ a/ -/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ -/ ]/ |/ ./ 证明/ ./ 若/ |/ S/ [/ a/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ ,/ 则/ 结论/ 成立/ ./ 否则/ 由/ 引理/ 4/ 的/ 结论/ 立即/ 得到/ |/ S/ [/ a/ -/ ,/ 3/ ]/ |/ =/ |/ NS/ [/ a/ ]/ |/ >/ |/ S/ [/ a/ ,/ 3/ ]/ |/ =/ |/ NS/ [/ a/ -/ ]/ |/ ./ 证毕/ ./ 由/ 引理/ 4/ 和/ 推论/ 1/ ,/ 可以/ 在/ 一位/ 跳变/ 局部/ 搜索/ 结束/ 后/ ,/ 利用/ 所有/ 布尔/ 变量/ 赋值/ 全部/ 取反/ ,/ 进一步/ 改善/ 算法/ 性能/ ./ 算法/ 2/ ./ all/ -/ flip/ (/ U/ ,/ C/ )/ ./ 1/ ./ 调用/ one/ -/ flip/ (/ U/ ,/ C/ )/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ;/ 2/ ./ If/ (/ |/ S/ [/ a/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ )/ thenb/ (/ U/ )/ ←/ a/ (/ U/ )/ ;/ 3/ ./ Elseb/ (/ U/ )/ ←/ a/ -/ (/ U/ )/ ;/ 4/ ./ Endif5/ ./ Returnb/ (/ U/ )/ 因为/ 算法/ one/ -/ flip/ (/ ·/ )/ 一定/ 结束/ ,/ 所以/ 该/ 算法/ 也/ 必定/ 结束/ ./ 调用/ one/ -/ flip/ (/ ·/ )/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 计算/ S/ [/ a/ ,/ 1/ ]/ 、/ S/ [/ a/ ,/ 2/ ]/ 、/ S/ [/ a/ ,/ 3/ ]/ 、/ NS/ [/ a/ ]/ 的/ 时间/ 复杂性/ 为/ O/ (/ m/ )/ ,/ 所以/ 执行/ 算法/ 步/ 2/ ~/ 5/ 的/ 时间/ 复杂性/ 为/ O/ (/ m/ )/ ./ 所以/ 算法/ 时间/ 复杂性/ 与/ one/ -/ flip/ (/ ·/ )/ 的/ 时间/ 复杂性/ 相同/ ,/ 为/ O/ (/ m2n/ )/ ./ m/ ,/ n/ 分别/ 为/ Max/ -/ (/ 3/ )/ -/ SAT/ 实例/ 中项/ 数目/ 和/ 布尔/ 变量/ 数目/ ./ 下面/ 分析/ 算法/ all/ -/ flip/ (/ ·/ )/ 的/ 性能/ ./ 引理/ 5/ ./ 设/ 算法/ all/ -/ flip/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ 为/ b/ (/ U/ )/ ,/ 则/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ / 3/ |/ NS/ [/ b/ ]/ |/ ./ 证明/ ./ 设/ 调用/ 算法/ one/ -/ flip/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ 为/ a/ (/ U/ )/ ,/ 由/ C/ [/ j/ ,/ T/ ]/ 的/ 定义/ 可知/ ,/ 对于/ 任意/ j/ ,/ 1/ / j/ / n/ ,/ 有/ S/ [/ a/ ,/ 3/ ]/ ∩/ C/ [/ j/ ,/ T/ ]/ =/ / 且/ S/ [/ a/ ,/ 2/ ]/ ∩/ C/ [/ j/ ,/ T/ ]/ =/ / ,/ S/ [/ a/ ,/ 1/ ]/ 中/ 的/ 每个/ 项/ 包含/ 在/ 一个/ 且/ 仅/ 一个/ C/ [/ j/ ,/ T/ ]/ 中/ ,/ 所以/ 引理/ 2/ 的/ 结论/ 可/ 更/ 确切/ 地/ 表示/ 为/ |/ S/ [/ a/ ,/ 1/ ]/ |/ =/ ∑/ n/ |/ S/ [/ a/ ,/ 2/ ]/ |/ / ∑/ n/ 得到/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ / 3/ |/ NS/ [/ a/ ]/ |/ ./ 由/ 引理/ 4/ 和/ 推论/ 1/ 知/ ,/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ =/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ ,/ |/ NS/ [/ a/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 所以/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ / 3/ |/ NS/ [/ b/ ]/ |/ ./ 定理/ 2/ ./ 设/ 算法/ all/ -/ flip/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ 为/ b/ (/ U/ )/ ,/ S/ [/ b/ ]/ 和/ NS/ [/ b/ ]/ 为/ 被/ b/ (/ U/ )/ 满足/ 和/ 不/ 被/ b/ (/ U/ )/ 满足/ 的/ 项/ 集合/ ,/ 则/ |/ S/ [/ b/ ]/ |/ / 4Page6/ 证明/ ./ 由/ 算法/ 2/ ~/ 4/ 步/ 的/ 条件/ 语句/ 和/ 推论/ 1/ 可知/ ,/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 由/ 引理/ 5/ ,/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ / 3/ |/ NS/ [/ b/ ]/ |/ ./ 所以/ |/ S/ [/ b/ ]/ |/ =/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ +/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / 4/ |/ NS/ [/ b/ ]/ |/ ./ 所以/ |/ S/ [/ b/ ]/ |/ / 45/ |/ C/ |/ ./ 为/ 5/ // 4/ ./ 由/ 定理/ 2/ 可知/ ,/ 算法/ all/ -/ flip/ (/ ·/ )/ 的/ 近似/ 性能/ 比例/ ./ U/ =/ {/ u1/ ,/ u2/ ,/ u3/ }/ ,/ C/ =/ {/ C1/ =/ {/ u1/ ,/ u2/ ,/ u3/ }/ ,/ C2/ =/ {/ u/ -/ 3/ }/ ,/ C5/ =/ {/ u/ -/ u/ -/ F/ 时/ ,/ 算法/ all/ -/ flip/ (/ ·/ )/ 得到/ 一个/ 局部/ 最优/ 解/ ,/ C1/ 不/ 被/ a/ (/ U/ )/ 满足/ ,/ C2/ 、/ C3/ 、/ C4/ 和/ C5/ 均/ 被/ a/ (/ U/ )/ 满足/ ,/ 算法/ 解答/ 这个/ 实例/ 的/ 近似/ 性能比/ 恰为/ 5/ // 4/ ./ 若/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ 中/ 存在/ 含有/ 多于/ 3/ 个/ 字母/ 的/ 项/ ,/ 则/ 在/ 算法/ all/ -/ flip/ (/ ·/ )/ 中/ ,/ 应/ 比较/ 全/ 满足/ 与/ 不/ 满足/ 的/ 项/ 数目/ ,/ 决定/ 是否/ 将/ 所有/ 布尔/ 变量/ 赋值/ 取反/ ./ 所有/ 布尔/ 变量/ 赋值/ 有/ 条件/ 取反/ 的/ 步骤/ ,/ 使得/ 全/ 满足/ 项/ 的/ 数目/ 不少/ 于/ 不/ 满足/ 项/ 的/ 数目/ ,/ 且/ 不/ 改变/ 半/ 满足/ 项/ 的/ 数目/ ,/ 半/ 满足/ 的/ 项/ 数目/ 仍然/ 不少/ 于/ 不/ 满足/ 项/ 数目/ 的/ 3/ 倍/ ./ 所以/ 算法/ 解答/ 这种/ 实例/ 的/ 近似/ 性能比/ 仍/ 不/ 大于/ 5/ // 4.4/ 一位/ 跳变/ 加/ 全体/ 跳变/ 8/ // 7/ -/ 近似/ 局部/ 搜索算法/ 前面/ 算法/ 考虑/ 的/ 布尔/ 变量/ 赋值/ 所/ 满足/ 的/ 项/ ,/ 仍然/ 未能/ 包括/ 2/ -/ 满足/ 的/ 项/ ./ 下面/ 假设/ 每个/ 项均/ 含有/ 3/ 个/ 布尔/ 变量/ 字母/ ,/ 我们/ 利用/ 一位/ 跳变/ ,/ 最大化/ 1/ -/ 满足/ 和/ 2/ -/ 满足/ 项/ 集合/ 的/ 局部/ 搜索/ 方法/ ,/ 改善/ 算法/ 性能/ ./ 给定/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ./ 选择/ 任意/ 一个/ 布尔/ 变量/ 赋值/ 取反/ ,/ 任意/ 项/ Ct/ 的/ 可/ 满足/ 性/ 变化/ 有/ 如下/ 性质/ :/ 2/ -/ 满足/ 或/ 不/ 满足/ ,/ 不/ 可能/ 变为/ 3/ -/ 满足/ ;/ 1/ -/ 满足/ ,/ 不/ 可能/ 变为/ 2/ -/ 满足/ 或/ 3/ -/ 满足/ ;/ (/ 1/ )/ 若/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ 则/ Ct/ 仍为/ 不/ 满足/ 或/ 变为/ (/ 2/ )/ 若/ Ct/ ∈/ S/ [/ a/ ,/ 1/ ]/ ,/ 则/ Ct/ 仍为/ 1/ -/ 满足/ 或/ 变为/ (/ 3/ )/ 若/ Ct/ ∈/ S/ [/ a/ ,/ 2/ ]/ ,/ 则/ Ct/ 仍为/ 2/ -/ 满足/ 或/ 变为/ (/ 4/ )/ 若/ Ct/ ∈/ S/ [/ a/ ,/ 3/ ]/ ,/ 则/ Ct/ 仍为/ 3/ -/ 满足/ 或/ 变为/ 由此/ ,/ 设/ C/ [/ j/ ,/ 0/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ 1/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 2/ -/ 满足/ ,/ 不/ 可能/ 变为/ 1/ -/ 满足/ 或/ 不/ 满足/ ./ 1/ -/ 满足/ 或/ 3/ -/ 满足/ ,/ 不/ 可能/ 变为/ 不/ 满足/ ;/ 1/ -/ 满足/ 变为/ 不/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ 2/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 2/ -/ 满足/ 变为/ 3/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ 3/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 3/ -/ 满足/ 变为/ 2/ -/ 满足/ 的/ 项/ 集合/ ./ 即/ C/ [/ j/ ,/ 0/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ F/ }/ (/ 2/ )/ C/ [/ j/ ,/ 1/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ 1/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ T/ }/ (/ 3/ )/ C/ [/ j/ ,/ 2/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ 2/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ F/ }/ (/ 4/ )/ C/ [/ j/ ,/ 3/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ 3/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ T/ }/ (/ 5/ )/ 其中/ ,/ 1/ / j/ / n/ ./ 一个/ 布尔/ 变量/ 赋值/ 取反/ 跳变/ ,/ 最大化/ 1/ -/ 满足/ 和/ 2/ -/ 满足/ 项/ 集合/ 的/ 算法/ 如下/ ./ 算法/ 3/ ./ oneflip/ -/ max3sat/ (/ U/ ,/ C/ )/ ./ 1/ ./ a/ (/ uk/ )/ ←/ Rand/ {/ T/ ,/ F/ }/ ,/ 1/ / k/ / n/ ;/ 2/ ./ While/ (/ 存在/ uj/ ,/ 使/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ 2/ ]/ |/ </ 3/ ./ a/ (/ uj/ )/ ←/ a/ (/ uj/ )/ ;/ 4/ ./ EndWhile5/ ./ Returna/ (/ U/ )/ 算法/ 的/ While/ 循环/ 中/ ,/ 执行/ 一次/ 语句/ 3/ 的/ 变量/ 赋值/ 取反/ 操作/ ,/ 则/ C/ [/ j/ ,/ 0/ ]/ 中/ 的/ 项/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ ;/ C/ [/ j/ ,/ 3/ ]/ 中/ 的/ 项/ 由/ 3/ -/ 满足/ 变为/ 2/ -/ 满足/ ;/ C/ [/ j/ ,/ 1/ ]/ 中/ 的/ 项/ 由/ 1/ -/ 满足/ 变为/ 不/ 满足/ ;/ C/ [/ j/ ,/ 2/ ]/ 中/ 的/ 项/ 由/ 2/ -/ 满足/ 变为/ 3/ -/ 满足/ ,/ 1/ -/ 满足/ 与/ 2/ -/ 满足/ 的/ 项/ 数目/ 之/ 和/ 至少/ 增加/ 1/ ./ 因/ C/ 中/ 只有/ m/ 个项/ ,/ 所以/ 算法/ While/ 循环/ 一定/ 能够/ 结束/ ./ 对于/ 每个/ 布尔/ 变量/ ,/ 计算/ |/ C/ [/ j/ ,/ ·/ ]/ 的/ 时间/ 复杂性/ 为/ O/ (/ m/ )/ ,/ 所以/ 算法/ 在/ While/ 循环/ 中/ 找到/ 一个/ uj/ 满足/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ 2/ ]/ |/ </ |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ 3/ ]/ |/ 的/ 时间/ 复杂性/ 为/ O/ (/ mn/ )/ ./ 每/ 循环/ 一次/ ,/ 1/ -/ 满足/ 和/ 2/ -/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ,/ 所以/ 算法/ 时间/ 复杂性/ 为/ O/ (/ m2n/ )/ ./ 下面/ 再/ 分析/ 算法/ 的/ 性能/ ./ 引理/ 6/ ./ 设/ 算法/ oneflip/ -/ max3sat/ (/ U/ ,/ C/ )/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 则/ 对于/ 任意/ uj/ ,/ 有/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ 2/ ]/ |/ / |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ 3/ ]/ |/ ./ 证明/ ./ 若/ 存在/ uj/ ,/ 满足/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ 2/ ]/ |/ </ |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ 3/ ]/ |/ ,/ 由/ 算法/ 的/ 循环/ 条件/ 可知/ While/ 循环/ 不会/ 结束/ ./ 引理/ 7/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 则/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ =/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ 2/ ]/ |/ ./ j/ =/ 1/ 证明/ ./ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ }/ ,/ x/ [/ t/ ,/ j/ ]/ ∈/ {/ u1/ ,/ …/ ,/ un/ ,/ u/ -/ S/ [/ a/ ,/ 1/ ]/ ,/ 不失/ 一般性/ ,/ 设/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ T/ ,/ a/ (/ x/ [/ t/ ,/ 2/ ]/ )/ =/ a/ (/ x/ [/ t/ ,/ 3/ ]/ )/ =/ F/ ./ 当且/ 仅/ 当/ x/ [/ t/ ,/ 1/ ]/ 赋值/ 取反/ 时/ ,/ Ct/ 变为/ 不/ 满足/ ,/ 其它/ 布尔/ 变量/ 赋值/ 取反/ ,/ Ct/ 仍为/ 1/ -/ 满足/ 或/ Page7/ 引理/ 8/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ 变为/ 2/ -/ 满足/ ,/ 设/ x/ [/ t/ ,/ 1/ ]/ ∈/ {/ uj/ ,/ u/ -/ 但/ 对于/ x/ ≠/ j/ ,/ Ct/ / C/ [/ x/ ,/ 1/ ]/ ,/ 即/ Ct/ 出现/ 在/ 一个/ 且/ 仅/ 一个/ C/ [/ j/ ,/ 1/ ]/ 中/ ,/ 所以/ |/ S/ [/ a/ ,/ 1/ ]/ |/ =/ ∑/ n/ 证/ |/ S/ [/ a/ ,/ 2/ ]/ |/ =/ ∑/ n/ |/ S/ [/ a/ ,/ 2/ ]/ |/ =/ ∑/ na/ (/ U/ )/ ,/ 则/ 3/ |/ S/ [/ a/ ,/ 3/ ]/ |/ +/ 3/ |/ NS/ [/ a/ ]/ |/ =/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ 0/ ]/ |/ ./ j/ =/ 1/ 证明/ ./ 我们/ 证明/ 任意/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ 存在/ 3/ 个且/ 仅/ 3/ 个/ 正整数/ j1/ ,/ j2/ ,/ j3/ ,/ 使/ Ct/ ∈/ C/ [/ j1/ ,/ 0/ ]/ ,/ Ct/ ∈/ C/ [/ j2/ ,/ 0/ ]/ ,/ Ct/ ∈/ C/ [/ j3/ ,/ 0/ ]/ ./ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ x/ [/ t/ ,/ 3/ ]/ }/ ∈/ NS/ [/ a/ ]/ ,/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ a/ (/ x/ [/ t/ ,/ 2/ ]/ )/ =/ a/ (/ x/ [/ t/ ,/ 3/ ]/ )/ =/ F/ ./ 只有/ x/ [/ t/ ,/ 1/ ]/ 或/ x/ [/ t/ ,/ 2/ ]/ 或/ x/ [/ t/ ,/ 3/ ]/ 赋值/ 取反/ ,/ Ct/ 会/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ ,/ 即/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 1/ ]/ )/ =/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 2/ ]/ )/ =/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 3/ ]/ )/ =/ T/ ./ 设/ x/ [/ t/ ,/ 1/ ]/ ∈/ {/ uj1/ ,/ u/ -/ {/ uj2/ ,/ u/ -/ Ct/ ∈/ C/ [/ j2/ ,/ 0/ ]/ ,/ Ct/ ∈/ C/ [/ j3/ ,/ 0/ ]/ ,/ 而/ 对于/ 任意/ x/ / {/ j1/ ,/ j2/ ,/ j3/ }/ ,/ 有/ a/ (/ Ct/ ,/ ux/ )/ =/ a/ (/ Ct/ ,/ u/ -/ C/ [/ x/ ,/ 0/ ]/ ./ 所以/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ 3/ ]/ |/ =/ 3/ |/ S/ [/ a/ ,/ 3/ ]/ |/ ./ 所以/ ,/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ 3/ ]/ |/ =/ 3/ |/ NS/ [/ a/ ]/ |/ +/ 3/ |/ S/ [/ a/ ,/ 3/ ]/ |/ ./ 证毕/ ./ j/ =/ 1/ 定理/ 3/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 则/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ / 6min/ {/ |/ NS/ [/ a/ ]/ |/ ,/ |/ S/ [/ a/ ,/ 3/ ]/ |/ }/ ./ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ =/ ∑/ n/ 证明/ ./ 由/ 引理/ 7/ 、/ 引理/ 6/ 和/ 引理/ 8/ 得/ j2/ }/ ,/ x/ [/ t/ ,/ 3/ ]/ ∈/ {/ uj3/ ,/ u/ -/ j/ =/ 1/ 定理/ 得证/ ./ 由/ 定理/ 3/ ,/ 若/ |/ S/ [/ a/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ ,/ 则/ 算法/ one/ -/ flip/ -/ max3sat/ (/ ·/ )/ 得到/ 的/ 解/ a/ (/ U/ )/ ,/ 使/ 1/ -/ 满足/ 与/ 2/ -/ 满足/ 的/ 项/ 数目/ 之/ 和/ 至少/ 为/ 不/ 满足/ 项/ 数目/ 的/ 6/ 倍/ ./ 但/ 若/ |/ S/ [/ a/ ,/ 3/ ]/ |/ </ |/ NS/ [/ a/ ]/ |/ ,/ 如/ |/ S/ [/ a/ ,/ 3/ ]/ |/ =/ 0/ ,/ 则/ 算法/ 得到/ 的/ 解/ 只能/ 保证/ 1/ -/ 满足/ 和/ 2/ -/ 满足/ 的/ 项/ 数目/ 不少/ 于/ 不/ 满足/ 项/ 数目/ 的/ 3/ 倍/ ./ 在/ 算法/ 中/ 增加/ 所有/ 布尔/ 变量/ 赋值/ 有/ 条件/ 取反/ 的/ 步骤/ ,/ 可/ 使/ 算法/ 的/ 近似/ 性能比/ 达到/ 8/ // 7/ ./ 算法/ 4/ ./ allflip/ -/ max3sat/ (/ U/ ,/ C/ )/ ./ 1/ ./ 调用/ oneflip/ -/ max3sat/ (/ U/ ,/ C/ )/ 得到/ 布尔/ 变量/ 赋值/ 2/ ./ If/ (/ |/ S/ [/ a/ ,/ 3/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ )/ thenb/ (/ U/ )/ ←/ a/ (/ U/ )/ ;/ 3/ ./ Elseb/ (/ U/ )/ ←/ a/ -/ (/ U/ )/ ;/ 4/ ./ Endif5/ ./ Returnb/ (/ U/ )/ 该/ 算法/ 的/ 时间/ 复杂性/ 仍为/ O/ (/ m2n/ )/ ,/ 我们/ 不再/ 具体分析/ 算法/ 的/ 时间/ 复杂性/ ./ 引理/ 9/ ./ 设/ 算法/ allflip/ -/ max3sat/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ 为/ b/ (/ U/ )/ ,/ 则/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 证明/ ./ 观察/ 算法/ allflip/ -/ max3sat/ (/ ·/ )/ 的/ 步/ 2/ ~/ 4/ ,/ 由/ 引理/ 4/ 和/ 推论/ 1/ 即得/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 定理/ 4/ ./ 设/ 算法/ allflip/ -/ max3sat/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ 为/ b/ (/ U/ )/ ,/ 则/ |/ S/ [/ b/ ]/ |/ / 7/ 证明/ ./ 设/ 调用/ 算法/ oneflip/ -/ max3sat/ (/ ·/ )/ 得到/ 的/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ./ 由/ 引理/ 4/ 和/ 推论/ 1/ 得/ ,/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ =/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ ,/ 由/ 引理/ 9/ ,/ |/ NS/ [/ b/ ]/ |/ =/ min/ {/ |/ S/ [/ b/ ,/ 3/ ]/ |/ ,/ |/ NS/ [/ b/ ]/ |/ }/ ./ 所以/ 由/ 定理/ 3/ 我们/ 得到/ |/ S/ [/ b/ ]/ |/ =/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ +/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / 6min/ {/ |/ S/ [/ b/ ,/ 3/ ]/ |/ ,/ |/ NS/ [/ b/ ]/ |/ }/ +/ |/ S/ [/ b/ ,/ 3/ ]/ |/ / 7/ |/ NS/ [/ b/ ]/ |/ ./ 所以/ |/ S/ [/ b/ ]/ |/ / 7/ 能比/ 为/ 8/ // 7/ ./ 定理/ 4/ 说明/ 算法/ allflip/ -/ max3sat/ (/ ·/ )/ 的/ 近似/ 性例/ ./ 设/ U/ =/ {/ u1/ ,/ u2/ ,/ u3/ ,/ u4/ ,/ u5/ ,/ u6/ }/ ,/ C/ =/ {/ C1/ ,/ C2/ ,/ C3/ ,/ C4/ ,/ C5/ ,/ C6/ ,/ C7/ ,/ C8/ ,/ C9/ ,/ C10/ ,/ C11/ ,/ C12/ ,/ C13/ ,/ C14/ ,/ C15/ ,/ C16/ }/ ./ 每个/ 项/ 的/ 布尔/ 变量/ 字母/ 集/ 表示/ 如下/ :/ NS/ [/ a/ ]/ C1/ =/ {/ u1/ ,/ u2/ ,/ u3/ }/ ,/ C2/ =/ {/ u4/ ,/ u5/ ,/ u6/ }/ ./ S/ [/ a/ ,/ 3/ ]/ C3/ =/ {/ u/ -/ 1/ ,/ u/ -/ 2/ ,/ u/ -/ 3/ }/ ,/ C4/ =/ {/ u/ -/ 4/ ,/ u/ -/ 5/ ,/ u/ -/ 6/ }/ ./ S/ [/ a/ ,/ 1/ ]/ C5/ =/ {/ u/ -/ 1/ ,/ u4/ ,/ u5/ }/ ,/ C6/ =/ {/ u/ -/ 2/ ,/ u5/ ,/ u6/ }/ ,/ C7/ =/ {/ u/ -/ 3/ ,/ u6/ ,/ u4/ }/ ,/ S/ [/ a/ ,/ 2/ ]/ C11/ =/ {/ u1/ ,/ u/ -/ 4/ ,/ u/ -/ 5/ }/ ,/ C12/ =/ {/ u2/ ,/ u/ -/ 5/ ,/ u/ -/ 6/ }/ ,/ C13/ =/ {/ u3/ ,/ u/ -/ 6/ ,/ u/ -/ 4/ }/ ,/ 当/ a/ (/ u1/ )/ =/ a/ (/ u2/ )/ =/ a/ (/ u3/ )/ =/ a/ (/ u4/ )/ =/ a/ (/ u5/ )/ =/ a/ (/ u6/ )/ =/ F/ 时/ ,/ 算法/ 得到/ 局部/ 最优/ 解/ ,/ NS/ [/ a/ ]/ =/ {/ C1/ ,/ C2/ }/ ,/ S/ [/ a/ ]/ =/ {/ C3/ ,/ …/ ,/ C16/ }/ ,/ S/ [/ a/ ]/ =/ 7/ 法/ 的/ 最优/ 解可使/ 所有/ 项/ 都/ 被/ 满足/ ,/ 算法/ 解答/ 这个/ 实/ Page8/ 例/ 的/ 近似/ 性能比/ 恰为/ 8/ // 7/ ./ 若/ Max/ -/ (/ 3/ )/ -/ Sat/ 实例/ 中/ 存在/ 含有/ 多于/ 3/ 个/ 字母/ 的/ 项/ ,/ 则/ 在/ 算法/ oneflip/ -/ max3sat/ (/ ·/ )/ 中/ ,/ 应/ 利用/ 一位/ 跳变/ 最大化/ 半/ 满足/ 的/ 项/ ,/ 从而/ 可/ 证明/ 局部/ 最优/ 解/ 得到/ 的/ 布尔/ 变量/ 赋值/ 所/ 产生/ 的/ 半/ 满足/ 项/ 数目/ ,/ 不少/ 于全/ 满足/ 和/ 不/ 满足/ 项/ 数目/ 总和/ 的/ 3/ 倍/ ./ 因此/ 在/ 算法/ allflip/ -/ max3sat/ (/ ·/ )/ 中应/ 比较/ 全/ 满足/ 与/ 不/ 满足/ 的/ 项/ 数目/ ,/ 决定/ 是否/ 将/ 所有/ 布尔/ 变量/ 赋值/ 取反/ ./ 所有/ 布尔/ 变量/ 赋值/ 有/ 条件/ 取反/ 的/ 步骤/ ,/ 使得/ 全/ 满足/ 项/ 的/ 数目/ 不少/ 于/ 不/ 满足/ 项/ 的/ 数目/ ,/ 且/ 不/ 改变/ 半/ 满足/ 的/ 项/ 数目/ ./ 因此/ 半/ 满足/ 项/ 与/ 全/ 满足/ 项/ 数目/ 之/ 和/ 不少/ 于/ 不/ 满足/ 项/ 数目/ 的/ 7/ 倍/ ,/ 算法/ 近似/ 性能比/ 仍/ 不/ 大于/ 8/ // 7.5/ Max/ -/ (/ 犽/ )/ -/ Sat/ 问题/ (/ 2/ 犽/ +/ 2/ )/ // (/ 2/ 犽/ +/ 1/ )/ -/ 近似算法/ 每个/ 项均/ 含有/ 不少/ 于/ k/ 个/ 布尔/ 变量/ 字母/ 的/ Max/ -/ Sat/ 子/ 问题/ 即为/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ ./ 不难/ 推知/ ,/ 算法/ one/ -/ flip/ (/ ·/ )/ 解答/ Max/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 2/ ,/ 解答/ Max/ -/ (/ 2/ )/ -/ Sat/ 问题/ 的/ 近似/ 性能比/ 为/ 3/ // 2/ ./ 算法/ all/ -/ flip/ (/ ·/ )/ 解答/ Max/ -/ (/ 2/ )/ -/ Sat/ 问题/ 的/ 近似/ 能比/ 为/ 4/ // 3/ ./ 本节/ 考虑/ k/ / 4/ 的/ 情况/ ,/ 利用/ 类似/ 于/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索/ 方法/ ,/ 给出/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 一位/ 跳变/ 后/ 跟/ 全体/ 跳变/ 的/ 局部/ 搜索算法/ ,/ 使/ 其/ 近似/ 性能比/ 达到/ 2k/ +/ 2/ 设/ k/ / 4/ ,/ 且/ 假设/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 实例/ 中/ ,/ 每个/ 项均/ 含有/ k/ 个/ 布尔/ 变量/ 字母/ ./ 不再/ 讨论/ 实例/ 中/ 存在/ 含有/ 多于/ k/ 个/ 字母/ 项/ 的/ 情况/ ./ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ x/ [/ t/ ,/ 2/ ]/ ,/ …/ ,/ x/ [/ t/ ,/ k/ ]/ }/ ,/ 给定/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ./ 延用/ 前面/ 项/ 关于/ (/ 被/ )/ 布尔/ 变量/ 赋值/ j/ -/ 满足/ 的/ 概念/ ,/ 0/ / j/ / k/ ,/ 其中/ 0/ -/ 满足/ 为/ 不/ 满足/ ;/ k/ -/ 满足/ 为/ 全/ 满足/ ;/ [/ 1/ ~/ k/ -/ 1/ ]/ -/ 满足/ 均/ 为/ 半/ 满足/ ./ 另设/ S/ [/ a/ ,/ j/ ]/ 为/ 关于/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 是/ j/ -/ 满足/ 的/ 项/ 集合/ ./ S/ [/ a/ ]/ 和/ NS/ [/ a/ ]/ 为/ 被/ a/ (/ U/ )/ 满足/ 和/ 不/ 被/ a/ (/ U/ )/ 满足/ 的/ 项/ 集合/ ./ 给定/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 实例/ 的/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 一个/ 布尔/ 变量/ 赋值/ 取反/ ,/ 任意/ 项/ Ct/ 的/ 可/ 满足/ 性/ 变化/ 有/ 如下/ 性质/ :/ (/ 1/ )/ 若/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ 则/ Ct/ 仍为/ 不/ 满足/ 或/ 变为/ 1/ -/ 满足/ ,/ 不/ 可能/ 变为/ j/ (/ / 2/ )/ -/ 满足/ ./ (/ 2/ )/ 若/ Ct/ ∈/ S/ [/ a/ ,/ j/ ]/ ,/ 1/ / j/ / k/ -/ 1/ ,/ 则/ Ct/ 仍为/ j/ -/ 满足/ 或/ 变为/ (/ j/ +/ 1/ )/ -/ 满足/ 或/ (/ j/ -/ 1/ )/ -/ 满足/ ,/ 不/ 可能/ 变为/ (/ j/ +/ x/ )/ -/ 满足/ 或/ (/ j/ -/ y/ )/ -/ 满足/ ,/ 2/ / x/ / k/ -/ j/ ,/ 2/ / y/ / j/ ./ (/ 3/ )/ 若/ Ct/ ∈/ S/ [/ a/ ,/ k/ ]/ ,/ 则/ Ct/ 仍为/ k/ -/ 满足/ 或/ 变为/ (/ k/ -/ 1/ )/ -/ 满足/ ,/ 不/ 可能/ 变为/ (/ k/ -/ x/ )/ -/ 满足/ ,/ 2/ / x/ / k/ ./ 一个/ 布尔/ 变量/ 赋值/ 取反/ ,/ 对于/ 满足/ 2/ / j/ / k/ -/ 2/ 的/ j/ ,/ j/ -/ 满足/ 的/ 项/ 不/ 可能/ 变为/ 不/ 满足/ 或/ k/ -/ 满足/ ;/ 不/ 满足/ 或/ k/ -/ 满足/ 的/ 项/ 也/ 不/ 可能/ 变为/ j/ -/ 满足/ ./ 由此/ 我们/ 仍然/ 假设/ C/ [/ j/ ,/ 0/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ 1/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ 1/ -/ 满足/ 变为/ 不/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ k/ -/ 1/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ (/ k/ -/ 1/ )/ -/ 满足/ 变为/ k/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ j/ ,/ k/ ]/ 表示/ 将/ a/ (/ uj/ )/ 取反/ ,/ 由/ k/ -/ 满足/ 变为/ (/ k/ -/ 1/ )/ -/ 满足/ 的/ 项/ 集合/ ./ 即/ C/ [/ j/ ,/ 0/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ NS/ [/ a/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ F/ }/ (/ 7/ )/ C/ [/ j/ ,/ 1/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ 1/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ T/ }/ (/ 8/ )/ C/ [/ j/ ,/ k/ -/ 1/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ k/ -/ 1/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ F/ }/ C/ [/ j/ ,/ k/ ]/ =/ {/ Ct/ |/ Ct/ ∈/ S/ [/ a/ ,/ k/ ]/ ,/ a/ (/ Ct/ ,/ uj/ )/ =/ T/ }/ (/ 10/ )/ 其中/ ,/ 1/ / j/ / n/ ./ 下面/ 给出/ 一个/ 布尔/ 变量/ 赋值/ 取反/ 跳变/ ,/ 最大化/ 1/ -/ 满足/ 至/ (/ k/ -/ 1/ )/ -/ 满足/ 的/ 项/ 集合/ ,/ 然后/ 所有/ 布尔/ 变量/ 赋值/ 有/ 条件/ 取反/ 的/ 算法/ ./ 算法/ 5/ ./ flip/ -/ maxksat/ (/ U/ ,/ C/ )/ ./ 1/ ./ a/ (/ uk/ )/ ←/ Rand/ {/ T/ ,/ F/ }/ ,/ 1/ / k/ / n/ ;/ 2/ ./ While/ (/ 存在/ uj/ ,/ 使/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ -/ 1/ ]/ |/ </ 3/ ./ a/ (/ uj/ )/ ←/ a/ (/ uj/ )/ ;/ 4/ ./ EndWhile5/ ./ If/ (/ |/ S/ [/ a/ ,/ k/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ )/ thenb/ (/ U/ )/ ←/ a/ (/ U/ )/ ;/ 6/ ./ Elseb/ (/ U/ )/ ←/ a/ -/ (/ U/ )/ ;/ 7/ ./ Endif8/ ./ Returnb/ (/ U/ )/ ./ 在/ 算法/ While/ 循环/ 条件/ 中/ ,/ 仅/ 比较/ 了/ 1/ -/ 满足/ 转化/ 为/ 不/ 满足/ 和/ (/ k/ -/ 1/ )/ -/ 满足/ 转化/ 为/ k/ -/ 满足/ 项/ ,/ 与/ 不/ 满足/ 转化/ 为/ 1/ -/ 满足/ 和/ k/ -/ 满足/ 转化/ 为/ (/ k/ -/ 1/ )/ -/ 满足/ 项/ 的/ 数目/ ,/ 这/ 是因为/ 2/ -/ 满足/ 至/ (/ k/ -/ 2/ )/ -/ 满足/ 的/ 项/ 不/ 可能/ 因/ 一个/ 布尔/ 变量/ 赋值/ 取反/ 转化/ 为/ 不/ 满足/ 或/ k/ -/ 满足/ ,/ 反之亦然/ ./ 算法/ 的/ While/ 循环/ 中/ ,/ 执行/ 一次/ 语句/ 3/ 的/ 变量/ 赋值/ 取反/ 操作/ ,/ 则/ C/ [/ j/ ,/ 0/ ]/ 中/ 的/ 项/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ ;/ C/ [/ j/ ,/ k/ ]/ 中/ 的/ 项/ 由/ k/ -/ 满足/ 变为/ (/ k/ -/ 1/ )/ -/ 满足/ ;/ C/ [/ j/ ,/ 1/ ]/ 中/ 的/ 项/ 由/ 1/ 满足/ 变为/ 不/ 满足/ ;/ C/ [/ j/ ,/ k/ -/ 1/ ]/ 中/ 的/ 项/ 由/ (/ k/ -/ 1/ )/ -/ 满足/ 变为/ k/ -/ 满足/ ,/ [/ 1/ ~/ k/ -/ 1/ ]/ -/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ./ 因/ C/ 中/ 只有/ m/ 个项/ ,/ 所以/ 算法/ While/ 循环/ 一定/ 能够/ 结束/ ./ 注意/ ,/ 执行/ 一次/ 语句/ 3/ 的/ 变量/ 赋值/ 取反/ 操作/ ,/ 1/ -/ 满足/ 和/ (/ k/ -/ 1/ )/ -/ 满足/ 的/ 项/ 数目/ 未必/ 一定/ 增加/ ,/ 这/ 是因为/ 1/ -/ 满足/ 的/ 项/ 可能/ 变为/ 2/ -/ 满足/ ;/ (/ k/ -/ 1/ )/ -/ 满足/ 的/ 项/ 可能/ 变为/ (/ k/ -/ 2/ )/ -/ 满足/ ./ 对于/ 每个/ 布尔/ 变量/ ,/ 计算/ C/ [/ j/ ,/ x/ ]/ 的/ 时间/ 复杂性/ 为/ Page9O/ (/ km/ )/ ,/ 1/ / j/ / n/ ,/ x/ ∈/ {/ 0/ ,/ 1/ ,/ k/ -/ 1/ ,/ k/ }/ ./ 算法/ 在/ While/ 循环/ 中/ 找到/ 一个/ uj/ 满足/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ -/ 1/ ]/ |/ </ |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ ]/ |/ 的/ 时间/ 复杂性/ 为/ O/ (/ kmn/ )/ ./ 每/ 循环/ 一次/ ,/ [/ 1/ ~/ k/ -/ 1/ ]/ -/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ,/ 所以/ 算法/ 时间/ 复杂性/ 为/ O/ (/ km2n/ )/ ./ 下面/ 分析/ 算法/ 的/ 近似/ 性能比/ ./ 引理/ 10/ ./ 设/ 算法/ flip/ -/ maxksat/ (/ U/ ,/ C/ )/ 步/ 1/ ~/ 4/ 的/ While/ 循环/ 结束/ 时/ ,/ 得到/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 则/ 对于/ 任意/ uj/ ,/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ -/ 1/ ]/ |/ / |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ ]/ |/ )/ ./ 证明/ ./ 若/ 存在/ uj/ ,/ 满足/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ -/ 1/ ]/ |/ </ |/ C/ [/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ j/ ,/ k/ ]/ |/ ,/ 由/ 算法/ While/ 循环/ 条件/ 可知/ ,/ While/ 循环/ 不会/ 结束/ ./ 引理/ 11/ ./ 给定/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ 所有/ 布尔/ 变量/ 赋值/ 均/ 取反/ 得到/ a/ -/ (/ U/ )/ ,/ 则/ S/ [/ a/ -/ ,/ 1/ ]/ ∪/ …/ ∪/ S/ [/ a/ -/ ,/ k/ -/ 1/ ]/ =/ S/ [/ a/ ,/ 1/ ]/ ∪/ …/ ∪/ S/ [/ a/ ,/ k/ -/ 1/ ]/ ,/ NS/ [/ a/ -/ ]/ ∪/ S/ [/ a/ -/ ,/ k/ ]/ =/ NS/ [/ a/ ]/ ∪/ S/ [/ a/ ,/ k/ ]/ ./ 证明/ ./ 所有/ 布尔/ 变量/ 赋值/ 取反/ ,/ j/ -/ 满足/ 的/ 项/ 变为/ (/ k/ -/ j/ )/ -/ 满足/ ,/ 因/ 1/ / j/ / k/ -/ 1/ ,/ 所以/ S/ [/ a/ -/ ,/ 1/ ]/ ∪/ …/ ∪/ S/ [/ a/ -/ ,/ k/ -/ 1/ ]/ =/ S/ [/ a/ ,/ 1/ ]/ ∪/ …/ ∪/ S/ [/ a/ ,/ k/ -/ 1/ ]/ ./ 同理/ NS/ [/ a/ -/ ]/ ∪/ S/ [/ a/ -/ ,/ k/ ]/ =/ S/ [/ a/ ,/ ]/ ∪/ S/ [/ a/ ,/ k/ ]/ ./ 证毕/ ./ 推论/ 2/ ./ 设/ 算法/ flip/ -/ maxksat/ (/ ·/ )/ 得到/ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ ,/ 则/ |/ S/ [/ b/ ,/ k/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 证明/ ./ 由/ 算法/ 步/ 5/ ~/ 7/ 和/ 引理/ 11/ 可知/ ,/ |/ NS/ [/ b/ ]/ |/ =/ min/ {/ |/ NS/ [/ a/ ]/ |/ ,/ |/ S/ [/ a/ ,/ k/ ]/ |/ }/ ,/ |/ S/ [/ b/ ,/ k/ ]/ |/ =/ max/ {/ |/ NS/ [/ a/ ]/ |/ ,/ |/ S/ [/ a/ ,/ k/ ]/ |/ }/ ./ 所以/ |/ S/ [/ b/ ,/ k/ ]/ |/ / |/ NS/ [/ b/ ]/ |/ ./ 引理/ 12/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ ,/ 则/ ∑/ k/ -/ 1k/ -/ 1/ |/ ./ 时/ ,/ 得到/ 的/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 满足/ ∑/ k/ -/ 1/ ∑/ n/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ ∑/ n/ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ …/ ,/ x/ [/ t/ ,/ k/ ]/ }/ ,/ x/ [/ t/ ,/ j/ ]/ ∈/ {/ u1/ ,/ …/ ,/ un/ ,/ u/ -/ 失/ 一般性/ ,/ 设/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ T/ ,/ a/ (/ x/ [/ t/ ,/ 2/ ]/ )/ =/ …/ =/ a/ (/ x/ [/ t/ ,/ k/ ]/ )/ =/ F/ ./ 当且/ 仅/ 当/ x/ [/ t/ ,/ 1/ ]/ 赋值/ 取反/ 时/ ,/ Ct/ 变为/ 不/ 满足/ ,/ 其它/ 布尔/ 变量/ 赋值/ 取反/ ,/ Ct/ 仍为/ 1/ -/ 满足/ 或/ 变为/ 2/ -/ 满足/ ./ 设/ x/ [/ t/ ,/ 1/ ]/ ∈/ {/ uj/ ,/ u/ -/ C/ [/ j/ ,/ 1/ ]/ ,/ 但/ 对于/ x/ ≠/ j/ ,/ Ct/ / C/ [/ x/ ,/ 1/ ]/ ,/ 即/ Ct/ 出现/ 在/ 一个/ 且/ 仅/ 一个/ C/ [/ j/ ,/ 1/ ]/ 中/ ,/ 另外/ C/ [/ j/ ,/ 1/ ]/ 中仅/ 含有/ S/ [/ a/ ,/ 1/ ]/ 证明/ ./ 先/ 证明/ 算法/ 步/ 1/ ~/ 4/ 的/ While/ 循环/ 结束/ j/ =/ 1/ 中/ 的/ 项/ ,/ 所以/ |/ S/ [/ a/ ,/ 1/ ]/ |/ =/ ∑/ n/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ =/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ 1/ ]/ |/ +/ ∑/ n/ 由/ 引理/ 11/ ,/ ∑/ k/ -/ 1/ 引理/ 13/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ j/ =/ 1/ 理得证/ ./ b/ (/ U/ )/ ,/ 则/ k/ |/ S/ [/ b/ ,/ k/ ]/ |/ +/ k/ |/ NS/ [/ b/ ]/ |/ =/ ∑/ n/ ∑/ n/ |/ C/ [/ j/ ,/ k/ ]/ |/ ./ j/ =/ 1/ 证明/ ./ 先/ 证明/ 算法/ 步/ 1/ ~/ 4/ 的/ While/ 循环/ 结束/ 时/ ,/ 得到/ 的/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 满足/ ,/ k/ |/ S/ [/ a/ ,/ k/ ]/ |/ +/ k/ |/ NS/ [/ a/ ]/ |/ =/ ∑/ n/ 设/ Ct/ =/ {/ x/ [/ t/ ,/ 1/ ]/ ,/ …/ ,/ x/ [/ t/ ,/ k/ ]/ }/ ∈/ NS/ [/ a/ ]/ ,/ a/ (/ x/ [/ t/ ,/ 1/ ]/ )/ =/ …/ =/ a/ (/ x/ [/ t/ ,/ k/ ]/ )/ =/ F/ ./ Ct/ 中/ 每个/ 布尔/ 变量/ 字母/ 赋值/ 取反/ ,/ Ct/ 会/ 由/ 不/ 满足/ 变为/ 1/ -/ 满足/ ,/ 即/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ 1/ ]/ )/ =/ …/ =/ a/ (/ Ct/ ,/ x/ [/ t/ ,/ k/ ]/ )/ =/ T/ ./ 设/ x/ [/ t/ ,/ y/ ]/ ∈/ {/ uj/ [/ y/ ]/ ,/ u/ -/ 意/ x/ / {/ j/ [/ y/ ]/ :/ 1/ / y/ / k/ }/ ,/ 有/ a/ (/ Ct/ ,/ ux/ )/ =/ a/ (/ Ct/ ,/ u/ -/ N/ ,/ 所以/ Ct/ / C/ [/ x/ ,/ 0/ ]/ ./ 所以/ ∑/ n/ 同理可证/ ∑/ n0/ ]/ |/ +/ ∑/ n/ +/ |/ S/ [/ b/ ,/ k/ ]/ |/ ,/ 所以/ 引理/ 得证/ ./ b/ (/ U/ )/ ,/ 则/ ∑/ k/ 证明/ ./ 由/ 引理/ 12/ 、/ 引理/ 10/ 和/ 引理/ 13/ 得/ ∑/ k/ -/ 1/ |/ S/ [/ b/ ,/ j/ ]/ |/ / ∑/ nj/ =/ 1/ 由/ 引理/ 11/ 得/ ,/ |/ NS/ [/ a/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ ]/ |/ =/ |/ NS/ [/ b/ ]/ |/ 定理/ 5/ ./ 设/ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ j/ =/ 1/ 由/ 推论/ 2/ ,/ |/ NS/ [/ b/ ]/ |/ / |/ S/ [/ b/ ,/ k/ ]/ |/ ,/ 所以/ ∑/ k/ -/ 1j/ =/ 1Page10j/ =/ 1/ 且/ 有/ ∑/ k/ (/ 2k/ +/ 1/ )/ |/ NS/ [/ b/ ]/ |/ ,/ 所以/ ∑/ k/ 由/ 定理/ 5/ 可得/ ,/ 算法/ flip/ -/ maxksat/ (/ ·/ )/ 的/ 近似/ 性能比/ 为/ 2k/ +/ 26/ 两位/ 跳变/ 局部/ 搜索算法/ 直观/ 想法/ 告诉/ 我们/ ,/ 每次/ 将/ 多个/ 布尔/ 变量/ 赋值/ 取反/ 的/ 局部/ 搜索/ 方法/ ,/ 能够/ 尝试/ 更/ 多/ 可能/ 的/ 布尔/ 变量/ 赋值/ ,/ 因而/ 可能/ 获得/ 更好/ 的/ 解/ ./ 现在/ 讨论/ 每次/ 选择/ 两个/ 布尔/ 变量/ 赋值/ 取反/ ,/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 局部/ 搜索/ 方法/ ./ 将/ 这种/ 方法/ 称为/ 两位/ 跳变/ 的/ 局部/ 搜索算法/ ./ 下面/ 叙述/ 中/ 总/ 假设/ k/ / 3/ ,/ 每个/ 项均/ 含有/ k/ 个/ 布尔/ 变量/ 字母/ ./ 给定/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 实例/ :/ U/ 、/ C/ 和/ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ ,/ C/ 中/ 的/ 项/ 分为/ 1/ -/ 满足/ ,/ …/ ,/ k/ -/ 满足/ 和/ 不/ 满足/ ,/ 共/ k/ +/ 1/ 类/ ,/ S/ [/ a/ ,/ j/ ]/ 为/ j/ -/ 满足/ 的/ 项/ 集合/ ,/ 1/ / j/ / k/ ,/ NS/ [/ a/ ]/ 为/ 不/ 满足/ 的/ 项/ 集合/ ./ 另外/ 假设/ C/ [/ i/ ,/ j/ ,/ x/ ]/ 表示/ 布尔/ 变量/ ui/ 和/ uj/ 赋值/ 取反/ ,/ 由/ x/ -/ 满足/ 变为/ 不/ 满足/ 或/ k/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ 表示/ 布尔/ 变量/ ui/ 和/ uj/ 赋值/ 取反/ ,/ 由/ 不/ 满足/ 变为/ x/ -/ 满足/ 的/ 项/ 集合/ ;/ C/ [/ i/ ,/ j/ ,/ k/ ]/ 表示/ 布尔/ 变量/ ui/ 和/ uj/ 赋值/ 取反/ ,/ 由/ k/ -/ 满足/ 变为/ x/ -/ 满足/ 的/ 项/ 集合/ ,/ 其中/ 1/ / x/ / k/ -/ 1/ ./ 为/ 方便/ ,/ 假设/ S/ [/ a/ ,/ 1/ ~/ k/ -/ 1/ ]/ =/ ∪/ k/ -/ 1C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ =/ ∪/ k/ -/ 1S/ [/ a/ ,/ i/ ]/ ∩/ S/ [/ a/ ,/ j/ ]/ =/ / ,/ 所以/ |/ S/ [/ a/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ =/ ∑/ k/ -/ 1/ |/ S/ [/ a/ ,/ j/ ]/ |/ ,/ |/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ =/ ∑/ k/ -/ 1j/ =/ 1/ 对于/ k/ =/ 3/ 和/ k/ / 4/ 两种/ 情况/ ,/ S/ [/ a/ ,/ 1/ ~/ k/ -/ 1/ ]/ 和/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ 中/ 的/ 项/ 无法/ 用/ 统一/ 形式/ 表示/ ,/ 因而/ 算法/ 性能/ 也/ 有所不同/ ./ 我们/ 先/ 给出/ 两位/ 跳变/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 算法/ 的/ 统一/ 描述/ 形式/ ,/ 再分/ k/ =/ 3/ 和/ k/ / 4/ 两种/ 情况/ 分析/ 算法/ 的/ 性能/ ./ 算法/ 6/ ./ twoflip/ -/ maxksat/ (/ U/ ,/ C/ )/ ./ 1/ ./ a/ (/ uk/ )/ ←/ Rand/ {/ T/ ,/ F/ }/ ,/ 1/ / k/ / n/ ;/ 2/ ./ While/ (/ 存在/ uj/ ,/ 使/ |/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ </ |/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ i/ ,/ j/ ,/ k/ ]/ |/ )/ do3/ ./ a/ (/ ui/ )/ ←/ a/ (/ ui/ )/ ;/ a/ (/ uj/ )/ ←/ a/ (/ uj/ )/ ;/ 4/ ./ EndWhile5/ ./ If/ (/ |/ S/ [/ a/ ,/ k/ ]/ |/ / |/ NS/ [/ a/ ]/ |/ )/ thenb/ (/ U/ )/ ←/ a/ (/ U/ )/ ;/ 6/ ./ Elseb/ (/ U/ )/ ←/ a/ -/ (/ U/ )/ ;/ 7/ ./ Endif8/ ./ Returnb/ (/ U/ )/ ./ 算法/ 的/ While/ 循环/ 执行/ 一次/ ,/ 需要/ 针对/ 两个/ 布尔/ 变量/ ui/ ,/ uj/ 分别/ 计算/ 项/ 集合/ S/ [/ a/ ,/ 1/ ]/ ,/ …/ ,/ S/ [/ a/ ,/ k/ ]/ ,/ NS/ [/ a/ ]/ 和/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ ,/ …/ ,/ C/ [/ i/ ,/ j/ ,/ k/ ]/ ,/ 可/ 在/ O/ (/ km/ )/ 时间/ 内/ 完成/ ./ 每/ 执行/ 一次/ 变量/ 赋值/ 取反/ 操作/ ,/ S/ [/ a/ ,/ 1/ ~/ k/ -/ 1/ ]/ 中/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ./ 因/ C/ 中/ 只有/ m/ 个项/ ,/ 所以/ 算法/ While/ 循环/ 一定/ 能够/ 结束/ ./ 算法/ 在/ While/ 循环/ 中/ 找到/ 两个/ 布尔/ 变量/ ui/ ,/ uj/ 满足/ |/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ </ |/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ i/ ,/ j/ ,/ k/ ]/ |/ 的/ 时间/ 复杂性/ 为/ O/ (/ kmn2/ )/ ./ 每/ 循环/ 一次/ ,/ [/ 1/ ~/ k/ -/ 1/ ]/ -/ 满足/ 的/ 项/ 数目/ 至少/ 增加/ 1/ ,/ 所以/ 算法/ 时间/ 复杂性/ 为/ O/ (/ km2n2/ )/ ./ 下面/ 所/ 采用/ 的/ 符号/ 与/ 前面/ 相同/ ,/ 总/ 假设/ S/ [/ a/ ,/ ·/ ]/ 和/ NS/ [/ a/ ]/ 表示/ 算法/ While/ 循环/ 结束/ 时/ ,/ 被/ 赋值/ a/ (/ U/ )/ 满足/ 的/ 项/ 集合/ 和/ 不/ 被/ a/ (/ U/ )/ 满足/ 的/ 项/ 集合/ ;/ S/ [/ b/ ,/ ·/ ]/ 和/ NS/ [/ b/ ]/ 表示/ 算法/ 结束/ 时/ ,/ 被/ 赋值/ b/ (/ U/ )/ 满足/ 的/ 项/ 集合/ 和/ 不/ 被/ b/ (/ U/ )/ 满足/ 的/ 项/ 集合/ ./ 另外/ 我们/ 下面/ 只/ 给出/ 结论/ 的/ 简要/ 证明/ ./ 引理/ 14/ ./ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 满足/ :/ |/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ / |/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ i/ ,/ j/ ,/ k/ ]/ |/ ,/ i/ ≠/ j/ ,/ 1/ / i/ ,/ j/ / n/ ./ 证明/ ./ 若/ 存在/ ui/ ,/ uj/ ,/ 满足/ |/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ </ |/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ |/ +/ |/ C/ [/ i/ ,/ j/ ,/ k/ ]/ |/ ,/ 由/ 算法/ While/ 循环/ 条件/ 可知/ ,/ While/ 循环/ 不会/ 结束/ ./ (/ 1/ )/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 的/ 性能/ 分析/ 引理/ 15/ ./ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ 满足/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 2/ ]/ |/ 证明/ ./ 每个/ S/ [/ a/ ,/ 1/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ 2/ ]/ 中/ 出现/ 1/ +/ (/ n/ -/ 3/ )/ =/ n/ -/ 2/ 次/ ;/ 每个/ S/ [/ a/ ,/ 2/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 1/ ~/ 2/ ]/ 中/ 出现/ 1/ +/ (/ n/ -/ 3/ )/ =/ n/ -/ 2/ 次/ ./ 所以/ (/ n/ -/ 2/ )/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ (/ n/ -/ 2/ )/ |/ S/ [/ a/ ,/ 2/ ]/ |/ 由/ 引理/ 11/ 可知/ ,/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ =/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ ./ 所以/ 引理/ 结论/ 为/ 真/ ./ 引理/ 16/ ./ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ 满足/ 3/ (/ n/ -/ 2/ )/ |/ NS/ [/ b/ ]/ |/ +/ 3/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 3/ ]/ |/ 证明/ ./ 每个/ NS/ [/ a/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ 中/ 出现/ Page113/ +/ 3/ (/ n/ -/ 3/ )/ =/ 3/ (/ n/ -/ 2/ )/ 次/ ;/ 每个/ S/ [/ a/ ,/ 3/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 3/ ]/ 中/ 出现/ 3/ +/ 3/ (/ n/ -/ 3/ )/ =/ 3/ (/ n/ -/ 2/ )/ 次/ ./ 所以/ 3/ (/ n/ -/ 2/ )/ |/ NS/ [/ a/ ]/ |/ +/ 3/ (/ n/ -/ 2/ )/ |/ S/ [/ a/ ,/ 3/ ]/ |/ 由/ 引理/ 11/ 可知/ ,/ |/ NS/ [/ a/ ]/ |/ +/ |/ S/ [/ a/ ,/ 3/ ]/ |/ =/ |/ NS/ [/ b/ ]/ |/ +/ |/ S/ [/ b/ ,/ 3/ ]/ |/ ,/ 所以/ 引理/ 结论/ 为/ 真/ ./ 证毕/ ./ 定理/ 6/ ./ 算法/ 结束/ 时/ 得到/ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ ,/ 则/ |/ S/ [/ b/ ]/ |/ / 7/ 证明/ ./ 由/ 引理/ 15/ 、/ 引理/ 14/ 和/ 引理/ 16/ 得/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 2/ ]/ |/ =/ ∑/ n/ -/ 1i/ =/ 1/ ∑/ n/ / ∑/ n/ -/ 1i/ =/ 1/ ∑/ n/ =/ 3/ (/ n/ -/ 2/ )/ |/ NS/ [/ b/ ]/ |/ +/ 3/ (/ n/ -/ 2/ )/ |/ S/ [/ b/ ,/ 3/ ]/ |/ (/ 14/ )/ 又/ 由/ 算法/ 5/ ~/ 7/ 步/ 的/ 条件/ 语句/ 可知/ ,/ |/ NS/ [/ b/ ]/ |/ / |/ S/ [/ b/ ,/ 3/ ]/ |/ ,/ 所以/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ / 6min/ {/ |/ NS/ [/ b/ ]/ |/ ,/ S/ [/ b/ ,/ 3/ ]/ |/ }/ |/ S/ [/ b/ ]/ |/ =/ |/ S/ [/ b/ ,/ 1/ ]/ |/ +/ |/ S/ [/ b/ ,/ 2/ ]/ |/ +/ |/ S/ [/ b/ ,/ 3/ ]/ |/ 由/ |/ C/ |/ =/ |/ S/ [/ b/ ]/ |/ +/ |/ NS/ [/ b/ ]/ |/ ,/ 即得/ |/ S/ [/ b/ ]/ |/ / 78/ |/ C/ |/ ./ 由/ 定理/ 6/ 我们/ 知道/ ,/ 选择/ 两个/ 布尔/ 变量/ 赋值/ 取反/ 跳变/ 的/ 局部/ 搜索算法/ ,/ 在/ 解答/ Max/ -/ (/ 3/ )/ -/ Sat/ 问题/ 时/ ,/ 近似/ 性能比/ 仍为/ 8/ // 7/ ./ (/ 2/ )/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ (/ k/ / 4/ )/ 问题/ 的/ 性能/ 分析/ 引理/ 17/ ./ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 满足/ (/ n/ -/ k/ )/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 2/ ]/ |/ +/ (/ n/ -/ k/ )/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ =/ ∑/ n/ -/ 1/ 次/ ./ 所以/ 结论/ 为/ 真/ ./ 证明/ ./ 若/ k/ =/ 4/ ,/ 则/ ①/ 每个/ S/ [/ a/ ,/ 1/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 1/ ]/ 中/ 出现/ n/ -/ ②/ 每个/ S/ [/ a/ ,/ 2/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 2/ ]/ 中/ 出现/ 2/ 次/ ;/ ③/ 每个/ S/ [/ a/ ,/ 3/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 3/ ]/ 中/ 出现/ n/ -/ 4/ 若/ k/ / 5/ ,/ 则/ ①/ 每个/ S/ [/ a/ ,/ 1/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 1/ ]/ 中/ 出现/ n/ -/ ②/ 每个/ S/ [/ a/ ,/ 2/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 2/ ]/ 中/ 出现/ 1/ 次/ ;/ ③/ 每个/ S/ [/ a/ ,/ k/ -/ 2/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ k/ -/ 2/ ]/ 中出/ 4/ 次/ ;/ k/ 次/ ;/ 现/ 1/ 次/ ;/ (/ 1/ -/ 现/ n/ -/ k/ 次/ ./ 所以/ 结论/ 为/ 真/ ./ ④/ 每个/ S/ [/ a/ ,/ k/ -/ 1/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ k/ -/ 1/ ]/ 中/ 出/ 引理/ 18/ ./ 布尔/ 变量/ 赋值/ a/ (/ U/ )/ 满足/ (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ NS/ [/ a/ ]/ |/ +/ (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ S/ [/ a/ ,/ k/ ]/ |/ =/ ∑/ n/ -/ 1i/ =/ 1/ ∑/ nj/ =/ i/ +/ 1/ 证明/ ./ 每个/ S/ [/ a/ ,/ 0/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ 0/ ]/ 中/ 出现/ k/ (/ n/ -/ k/ )/ +/ C2k/ 次/ ;/ 每个/ S/ [/ a/ ,/ k/ ]/ 中/ 的/ 项/ 在/ C/ [/ i/ ,/ j/ ,/ k/ ]/ 中/ 出现/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ 次/ ./ 所以/ 结论/ 为/ 真/ ./ 证毕/ ./ 当/ n/ / 5/ 时/ ,/ 只须/ 枚举/ n/ 个/ 布尔/ 变量/ 的/ 25/ 种/ 取值/ ,/ 可/ 得到/ Max/ -/ (/ 4/ )/ -/ Sat/ 问题/ 的/ 精确/ 解/ ./ 另外/ 若/ n/ =/ k/ ,/ 则/ 只要/ m/ </ 2k/ ,/ 即可/ 给出/ 布尔/ 变量/ 赋值/ ,/ 使/ 所有/ 项/ 都/ 满足/ ,/ 而/ 若/ m/ =/ 2k/ ,/ 则/ 任意/ 布尔/ 变量/ 赋值/ 均/ 为/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 的/ 精确/ 解/ ./ 因此/ ,/ 下面/ 总/ 假设/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 实例/ 满足/ :/ ①/ n/ / 6/ ;/ ②/ 若/ k/ / 5/ ,/ 则/ n/ / k/ +/ 1/ ./ 我们/ 在/ 下面/ 的/ 定理/ 证明/ 中/ ,/ 要求/ Max/ -/ (/ k/ )/ -/ Sat/ 实例/ 总/ 满足/ 这个/ 关于/ 布尔/ 变量/ 数目/ 的/ 假设/ ./ 定理/ 7/ ./ 布尔/ 变量/ 赋值/ b/ (/ U/ )/ 满足/ |/ S/ [/ b/ ]/ |/ / 2k/ +/ 2/ +/ k/ (/ k/ -/ 1/ )/ // (/ n/ -/ k/ 证明/ ./ 因/ n/ -/ 4/ / 2/ ,/ 所以/ 算法/ 解答/ Max/ -/ (/ 4/ )/ -/ Sat/ 实例/ 时/ ,/ 可/ 由/ 引理/ 17/ 得到/ (/ n/ -/ 4/ )/ (/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ 3/ ]/ |/ )/ / (/ n/ -/ 4/ )/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ 2/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ (/ n/ -/ 4/ )/ |/ S/ [/ a/ ,/ 3/ ]/ |/ =/ ∑/ n/ -/ 1i/ =/ 1/ ∑/ n/ 又/ 因若/ k/ / 5/ ,/ 则/ n/ / k/ +/ 1/ ,/ 所以/ 算法/ 解答/ Max/ -/ (/ k/ )/ -/ Sat/ 问题/ 实例/ 时/ ,/ 由/ 引理/ 17/ 得到/ (/ n/ -/ k/ )/ (/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ )/ / (/ n/ -/ k/ )/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 2/ ]/ |/ +/ (/ n/ -/ k/ )/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ =/ ∑/ n/ -/ 1i/ =/ 1/ ∑/ n/ 因此/ 对于/ k/ / 4/ ,/ 总有/ (/ n/ -/ k/ )/ (/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ )/ / ∑/ n/ -/ 1/ 由/ 不等式/ (/ 19/ )/ 、/ 引理/ 14/ 和/ 引理/ 18/ 得/ (/ n/ -/ k/ )/ (/ |/ S/ [/ a/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ )/ / (/ n/ -/ k/ )/ (/ |/ S/ [/ a/ ,/ 1/ ]/ |/ +/ |/ S/ [/ a/ ,/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 2/ ]/ |/ +/ |/ S/ [/ a/ ,/ k/ -/ 1/ ]/ |/ )/ / ∑/ n/ -/ 1i/ =/ 1/ ∑/ nPage12j/ =/ i/ +/ 1/ / ∑/ n/ -/ 1i/ =/ 1/ ∑/ n/ =/ (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ NS/ [/ a/ ]/ |/ +/ (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ S/ [/ a/ ,/ k/ ]/ |/ 再/ 由/ 引理/ 11/ 可/ 得到/ (/ n/ -/ k/ )/ (/ |/ S/ [/ b/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ )/ / (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ NS/ [/ b/ ]/ |/ +/ (/ k/ (/ n/ -/ k/ )/ +/ C2k/ )/ |/ S/ [/ b/ ,/ k/ ]/ |/ 即/ |/ S/ [/ b/ ,/ 1/ ~/ k/ -/ 1/ ]/ |/ / k/ +/ k/ (/ k/ -/ 1/ )/ |/ S/ [/ b/ ,/ k/ ]/ |/ )/ ./ 因/ |/ NS/ [/ b/ ]/ |/ / |/ S/ [/ b/ ,/ k/ ]/ |/ ,/ 所以/ |/ S/ [/ b/ ,/ 1/ ~/ k/ ]/ |/ / k/ (/ k/ -/ 1/ )/ (/ 1/ -/ 2k/ +/ 2/ +/ k/ (/ k/ -/ 1/ )/ // (/ n/ -/ k/ 由/ 定理/ 7/ 可知/ ,/ 算法/ twoflip/ -/ maxksat/ (/ ·/ )/ 的/ 近似/ 性能比/ 为/ 1/ +/ 

