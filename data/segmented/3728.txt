Page1/ 具有/ 强/ 匿名性/ 的/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 魏/ 福山/ 马传贵/ (/ 信息工程/ 大学/ 信息/ 工程学院/ 信息/ 研究/ 系/ 郑州/ 450002/ )/ 摘要/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 允许/ 用户/ 和/ 网关/ 在/ 服务器/ 的/ 协助/ 下/ 建立/ 起/ 一个/ 共享/ 的/ 会/ 话/ 密钥/ ,/ 其中/ 用户/ 和/ 服务器之间/ 的/ 认证/ 通过/ 低/ 熵/ 的/ 口令/ 来/ 完成/ ./ 已有/ 的/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 对/ 用户/ 的/ 匿名性/ 研究/ 不足/ ./ 该文/ 基于/ Diffie/ -/ Hellman/ 密钥/ 交换/ 提出/ 了/ 具有/ 强/ 匿名性/ 的/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ ,/ 并且/ 在/ 随机/ 预言/ 模型/ 下/ 基于/ 标准/ 的/ DDH/ 假设/ 证明/ 了/ 协议/ 的/ 安全性/ ./ 新/ 协议/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 并且/ 计算/ 效率高/ ,/ 安全性/ 和/ 计算/ 效率/ 都/ 优于/ 已有/ 的/ 同类/ 协议/ ./ 关键词/ 口令/ 认证/ ;/ 网关/ ;/ 匿名性/ ;/ 随机/ 预言/ 模型/ ;/ DDH/ 假设/ 1/ 引言/ 在/ 很多/ 实际/ 的/ 应用/ 中/ ,/ 如/ 网上银行/ 、/ 移动/ 支付/ 和/ 无线/ 漫游/ 接入/ 等/ ,/ 服务提供商/ 由/ 前置/ 的/ 网关/ 和/ 后/ 端的/ 验证/ 服务器/ 组成/ ./ 网关/ 是/ 提供/ 协议/ 转换/ 、/ 网间/ 连/ Page2/ 个/ 三方/ 口令/ 协议/ ,/ 使得/ 用户/ 和/ 网关/ 在/ 服务器/ 的/ 协助/ 下/ 建立/ 一个/ 认证/ 的/ 会/ 话/ 密钥/ ./ 服务器/ 和/ 用户/ 之间/ 共享/ 口令/ 用于/ 认证/ 用户/ 身份/ ,/ 但是/ 会话/ 密钥/ 是/ 在/ 用户/ 和/ 网关/ 之间/ 建立/ 的/ ./ 由于/ GPAKE/ 协议/ 的/ 模型/ 贴近/ 实际/ ,/ 在/ 很多/ 场景/ 中/ 都/ 具有/ 巨大/ 的/ 应用/ 潜力/ ,/ 因此/ 成为/ 轻量级/ 口令/ 协议/ 研究/ 的/ 一个/ 热点问题/ ./ 2005/ 年/ ,/ Abdalla/ 等/ 人/ [/ 1/ ]/ 提出/ 了/ GPAKE/ 协议/ 的/ 安全/ 模型/ ,/ 设计/ 了/ 第一个/ 在/ 随机/ 预言/ 模型/ 下/ 安全/ 的/ GPAKE/ 协议/ 并且/ 将/ 该/ 协议/ 进一步/ 推广/ 到/ 门限/ 的/ 形式/ ./ 但是/ 在/ 2006/ 年/ ,/ Byun/ 等/ 人/ [/ 2/ ]/ 指出/ Abdalla/ 等/ 人/ 所/ 设计/ 的/ GPAKE/ 协议/ 易/ 遭受/ 不可/ 检测/ 在线/ 字典/ 攻击/ [/ 3/ ]/ ./ 一个/ 恶意/ 的/ 网关/ 可以/ 反复/ 对/ 用户/ 的/ 口令/ 进行/ 在线/ 的/ 猜测/ ,/ 然后/ 从/ 服务器端/ 得到/ 验证/ ,/ 直到/ 猜测出/ 正确/ 的/ 口令/ 为止/ ,/ 而/ 服务器/ 检测/ 不到/ 这种/ 恶意/ 的/ 攻击/ ./ Byun/ 等/ 人/ 提出/ 了/ 一个/ 改进/ 的/ 协议/ ,/ 要求/ 用户/ 和/ 服务器/ 在/ 执行/ GPAKE/ 协议/ 之前/ 运行/ 一次/ 安全/ 的/ 两方/ 口令/ 协议/ ,/ 预先/ 建立/ 一个/ 用于/ 认证/ 消息/ 的/ 共享/ 密钥/ ,/ 并且/ 通过/ 给/ 用户/ 发送/ 的/ 消息/ 增加/ 消息/ 认证码/ 的/ 方式/ 来/ 保护/ 口令/ ./ 但是/ 在/ 2008/ 年/ ,/ Shim/ 发现/ [/ 4/ ]/ Byun/ 等/ 人/ 的/ 改进/ 协议/ 实际上/ 依旧/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 敌手/ 可以/ 重/ 放/ 增加/ 认证码/ 的/ 消息/ 从而/ 对/ 用户/ 的/ 口令/ 进行/ 在线/ 的/ 猜测/ ./ Shim/ 采用/ 类似/ 于/ Byun/ 等/ 人/ 的/ 改进/ 方式/ ,/ 要求/ 用户/ 和/ 服务器/ 执行/ 一次/ 安全/ 的/ 两方/ 口令/ 协议/ 从而/ 建立/ 起/ 共享/ 的/ 加密/ 密钥/ ,/ 利用/ 对称/ 加密/ 体制/ 掩盖/ 口令/ 的/ 信息/ 并/ 提出/ 了/ S/ -/ GPAKE/ 协议/ ./ 同年/ ,/ Abdalla/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 一个/ 可以/ 利用/ 私密/ 信息检索/ (/ PrivateInformationRetrieval/ )/ 协议/ [/ 6/ -/ 7/ ]/ 实现/ 用户/ 匿名性/ 的/ GPAKE/ 协议/ ./ 他们/ 同时/ 提出/ 了/ 一个/ 更强/ 的/ 安全/ 模型/ ,/ 该/ 模型/ 允许/ 对/ 参与者/ 进行/ 腐化/ 从而/ 实现/ 了/ 前/ 向/ 安全性/ ./ 2010/ 年/ ,/ Yoon/ 等/ 人/ [/ 8/ ]/ 指出/ Shim/ 提出/ 的/ S/ -/ GPAKE/ 协议/ 存在/ 设计/ 上/ 的/ 错误/ ,/ 协议/ 无法/ 正常/ 执行/ ,/ 并且/ 计算/ 效率/ 较/ 低/ ./ 他们/ 对/ Shim/ 设计/ 的/ 协议/ 进行/ 改进/ ,/ 提出/ 了/ 称为/ 最优/ 的/ O/ -/ GPAKE/ 协议/ ./ 2011/ 年/ ,/ Wei/ 等/ 人/ 利用/ RSA/ 体制/ 设计/ 了/ GPAKE/ 协议/ [/ 9/ ]/ ,/ 并/ 进一步/ 对/ 该/ 协议/ 进行/ 了/ 改进/ ,/ 提出/ 了/ 效率/ 更高/ 并且/ 可以/ 利用/ 私密/ 信息检索/ 协议/ 实现/ 用户/ 匿名性/ 的/ GPAKE/ 协议/ [/ 10/ ]/ ./ 此外/ ,/ 他们/ 还/ 分别/ 在/ 随机/ 预言/ 模型/ 和/ 标准/ 模型/ 下/ 提出/ 了/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 的/ GPAKE/ 协议/ [/ 11/ -/ 12/ ]/ ./ GPAKE/ 协议/ 适用/ 于/ 移动/ 通信/ 环境/ ,/ 如/ GSM/ 和/ 3GPP/ 等/ ./ 由于/ 移动/ 通信/ 网络/ 不能/ 像/ 传统/ 的/ 有线/ 网络/ 那样/ 通过/ 物理/ 隔离/ 来/ 保护/ 用户/ 隐私/ 信息/ 的/ 数据包/ ,/ 并且/ 敌手/ 更/ 易于/ 窃取/ 用户/ 认证/ 时所/ 提交/ 的/ 身份/ 信息/ 和/ 服务器/ 对/ 用户/ 身份/ 标识/ 的/ 询问/ ,/ 增加/ 了/ 对/ 用户/ 隐私/ 信息/ 保护/ 的/ 难度/ ./ 实现/ 用户/ 匿名性/ 在/ 保护/ 用户/ 的/ 个人隐私/ 的/ 同时/ 还/ 可以/ 减少/ 对/ 用户/ 仿冒/ 攻击/ 的/ 几率/ ,/ 因此/ 研究/ 具有/ 匿名性/ 的/ GPAKE/ 协议/ 有/ 非常/ 重要/ 的/ 现实意义/ ./ 但是/ ,/ 具有/ 匿名性/ 的/ GPAKE/ 协议/ 的/ 研究成果/ 很少/ ,/ 目前/ 只有/ 由/ Abdalla/ 等/ 人/ [/ 5/ ]/ 和/ Wei/ 等/ 人/ [/ 10/ ]/ 分别/ 基于/ Diffie/ -/ Hellman/ 密钥/ 交换/ 和/ RSA/ 体制/ 提出/ 的/ 两个/ 匿名/ GPAKE/ 协议/ ./ 已有/ 的/ 匿名/ GPAKE/ 协议/ 都/ 采用/ 网关/ 和/ 服务器/ 共同/ 执行/ 私密/ 信息检索/ 协议/ 的/ 方法/ 来/ 实现/ 用户/ 的/ 匿名性/ ,/ 只能/ 保证/ 用户/ 身份/ 对/ 服务器/ 的/ 匿名性/ ,/ 网关/ 和/ 攻击者/ 都/ 可以/ 得到/ 用户/ 的/ 真实/ 身份/ ,/ 匿名性/ 较弱/ ;/ 此外/ ,/ 已有/ 的/ 匿名/ GPAKE/ 协议/ 的/ 计算/ 效率/ 较/ 低/ ,/ 需要/ 进一步/ 地/ 提高/ ,/ 并且/ Abdalla/ 等/ 人/ 的/ 匿名/ GPAKE/ 协议/ [/ 5/ ]/ 还/ 存在/ 安全漏洞/ ,/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ./ 针对/ 已有/ 的/ 匿名/ GPAKE/ 协议/ 存在/ 的/ 不足/ ,/ 本文/ 采用/ 匿名/ 认证/ 协议/ 的/ 设计/ 思想/ ,/ 基于/ Diffie/ -/ Hellman/ 密钥/ 交换/ 设计/ 了/ 一个/ 具有/ 强/ 匿名性/ 的/ GPAKE/ 协议/ ,/ 并且/ 在/ 随机/ 预言/ 模型/ 下/ 利用/ 标准/ 的/ DDH/ 假设/ 证明/ 了/ 协议/ 的/ 安全性/ ./ 与/ 已有/ 的/ 匿名/ GPAKE/ 协议/ 相比/ ,/ 新/ 协议/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 并且/ 实现/ 了/ 用户/ 和/ 服务器之间/ 的/ 双向/ 认证/ ,/ 因此/ 具有/ 更强/ 的/ 安全性/ ;/ 在/ 匿名性/ 方面/ ,/ 新/ 协议/ 实现/ 了/ 对/ 用户/ 身份/ 的/ 强/ 匿名/ 保护/ ,/ 无论是/ 攻击者/ 、/ 网关/ 还是/ 服务器/ 都/ 无法/ 得到/ 用户/ 的/ 真实/ 身份/ ;/ 最后/ ,/ 在/ 与/ 已有/ 同类/ 协议/ 具有/ 相同/ 通信/ 效率/ 的/ 情况/ 下/ ,/ 新/ 协议/ 在/ 计算/ 效率/ 方面/ 具有/ 明显/ 的/ 优势/ ./ 因此/ ,/ 本文/ 所/ 提出/ 的/ 匿名/ GPAKE/ 协议/ 具有/ 更强/ 的/ 安全性/ 和/ 更/ 高/ 的/ 效率/ ,/ 更/ 符合/ 移动/ 通信/ 环境/ 的/ 应用/ 需求/ ./ 第/ 2/ 节/ 回顾/ GPAKE/ 协议/ 的/ 安全/ 模型/ ;/ 第/ 3/ 节/ 介绍/ 具有/ 强/ 匿名性/ 的/ GPAKE/ 协议/ 并且/ 给出/ 协议/ 的/ 安全性/ 证明/ ;/ 第/ 4/ 节/ 给出/ 与/ 已有/ 匿名/ GPAKE/ 协议/ 的/ 性能/ 比较/ ;/ 第/ 5/ 节对/ 全文/ 进行/ 总结/ ./ 2/ 安全/ 模型/ 本/ 节/ 简单/ 介绍/ 由/ Abdalla/ 等/ 人/ 在/ 2005/ 年/ 提出/ 的/ GPAKE/ 协议/ 的/ 安全/ 模型/ ,/ 对于/ 安全/ 模型/ 的/ 详细/ 介绍/ 参见/ 文献/ [/ 1/ ]/ ./ 2.1/ 安全/ 模型/ 协议/ 参与方/ ./ GPAKE/ 协议/ 的/ 参与者/ 由/ 用户/ C/ ∈/ / 、/ 网关/ G/ ∈/ / 以及/ 服务器/ S/ ∈/ / 组成/ ./ 用/ / 表示/ 所有/ 参与者/ 组成/ 的/ 集合/ ,/ 即/ 集合/ / =/ / ∪/ / ∪/ / ./ 用/ U/ ∈/ / 表示/ GPAKE/ 协议/ 中/ 的/ 任意/ 一个/ 参与者/ ./ 通信模型/ ./ 在/ GPAKE/ 协议/ 中/ ,/ 通常/ 假设/ 用户/ 和/ Page3/ 网关/ 之间/ 的/ 通信/ 是/ 不/ 安全/ 的/ ,/ 通信/ 被/ 敌手/ 完全/ 控制/ ,/ 敌手/ 可以/ 对/ 用户/ 和/ 网关/ 之间/ 传递/ 的/ 消息/ 进行/ 窃听/ 、/ 删除/ 、/ 修改/ 和/ 延迟/ 发送/ 等/ 操作/ ./ 但是/ 网关/ 和/ 服务器之间/ 的/ 信道/ 是/ 认证/ 的/ 私人/ 信道/ ,/ 即/ 敌手/ 无法/ 窃听/ 网关/ 和/ 服务器之间/ 发送/ 的/ 消息/ ,/ 也/ 不能/ 对/ 网关/ 和/ 服务器之间/ 发送/ 的/ 消息/ 进行/ 修改/ ./ 另外/ ,/ 用户/ 无法/ 和/ 服务器/ 直接/ 进行/ 通信/ ,/ 用户/ 和/ 服务器之间/ 的/ 消息/ 必须/ 经过/ 网关/ 进行/ 传递/ ./ 长期/ 密钥/ ./ 每个/ 用户/ C/ ∈/ / 都/ 拥有/ 一个/ 与/ 服务器/ 共享/ 的/ 用于/ 认证/ 的/ 口令/ pwC/ ./ 每个/ 服务器/ S/ ∈/ / 都/ 持有/ 一个/ 口令/ 列表/ pwS/ =/ 〈/ pwC/ 〉/ C/ ∈/ S/ ,/ 其中/ 每条/ 记录/ 对应/ 一个/ 在/ 服务器/ S/ 处/ 进行/ 注册/ 的/ 用户/ C/ 的/ 口令/ pwC/ ./ pwC/ 和/ pwS/ 分别/ 称为/ 用户/ C/ 和/ 服务器/ S/ 的/ 长期/ 密钥/ ./ 敌手/ 能力/ ./ 敌手/ 的/ 攻击能力/ 通过/ 预言/ 询问/ 来/ 刻画/ ./ 在/ 协议/ 执行/ 的/ 过程/ 中/ ,/ 敌手/ 可以/ 针对/ 某个/ 参与者/ 产生/ 多个/ 并行/ 的/ 会/ 话/ 实例/ ./ 用/ Ui/ 来/ 表示/ 用户/ U/ 的/ 第/ i/ 次会话/ 实例/ ./ 敌手/ 可以/ 进行/ 的/ 预言/ 询问/ 有/ 以下/ 几种/ :/ (/ 1/ )/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ./ 此/ 询问/ 模拟/ 敌手/ 进行/ 的/ 被动/ 攻击/ ,/ 其中/ 敌手/ 对/ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 之间/ 进行/ 的/ 一次/ 协议/ 执行/ 过程/ 进行/ 窃听/ ./ 对此/ 询问/ 的/ 回答/ 是/ 将/ 本次/ 协议/ 执行/ 过程/ 中/ 用户/ 和/ 网关/ 之间/ 传输/ 的/ 所有/ 消息/ 返回/ 给/ 敌手/ ./ (/ 2/ )/ Send/ (/ Ui/ ;/ m/ )/ 询问/ ./ 此/ 询问/ 模拟/ 敌手/ 进行/ 的/ 主动攻击/ ./ 其中/ 敌手/ 伪造/ 一个/ 消息/ m/ 并且/ 将/ 消息/ m/ 发送给/ 用户/ 实例/ 或者/ 网关/ 实例/ Ui/ ./ 敌手/ 将/ 得到/ 实例/ Ui/ 在/ 接收/ 到/ 消息/ m/ 后/ 根据/ 协议/ 描述/ 返回/ 的/ 消息/ ./ (/ 3/ )/ Test/ (/ Ui/ )/ 询问/ ./ 此/ 询问/ 不/ 刻画/ 敌手/ 的/ 攻击能力/ ,/ 只是/ 用来/ 衡量/ 参与者/ 实例/ Ui/ 的/ 会/ 话/ 密钥/ 的/ 语义/ 安全性/ ./ 如果/ 实例/ Ui/ 的/ 会/ 话/ 密钥/ 没有/ 定义/ ,/ 那么/ 返回/ 一个/ 未定义/ 的/ 符号/ ⊥/ ./ 否则/ ,/ 如果/ b/ =/ 1/ 就/ 将/ 真实/ 的/ 会/ 话/ 密钥/ 返回/ 给/ 敌手/ ,/ 如果/ b/ =/ 0/ 则/ 返回/ 一个/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ,/ 其中/ b/ 是/ 在/ 攻击/ 游戏/ 开始运行/ 之前/ 选择/ 的/ 随机/ 比特/ ./ (/ 4/ )/ TestPair/ (/ Ci/ ,/ Gj/ )/ 询问/ ./ 此/ 询问/ 不/ 刻画/ 敌手/ 的/ 攻击能力/ ,/ 而是/ 用来/ 定义/ 会话/ 密钥/ 对于/ 服务器/ 的/ 密钥/ 私密性/ ./ 如果/ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 之间/ 没有/ 建立/ 共享/ 的/ 会/ 话/ 密钥/ ,/ 那么/ 返回/ 一个/ 未定义/ 的/ 符号/ ⊥/ ./ 否则/ ,/ 如果/ b/ =/ 1/ 就/ 将/ 真实/ 的/ 会/ 话/ 密钥/ 返回/ 给/ 敌手/ ,/ 如果/ b/ =/ 0/ 则/ 返回/ 一个/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ,/ 其中/ b/ 是/ 在/ 攻击/ 游戏/ 开始运行/ 之前/ 选择/ 的/ 随机/ 比特/ ./ Abdalla/ 等/ 人/ [/ 13/ ]/ 的/ 安全/ 模型/ 采用/ 了/ ROR/ (/ Real/ -/ Or/ -/ Random/ )/ 模型/ 的/ 定义/ 方式/ ./ 敌手/ 可以/ 进行/ 多次/ Test/ 询问/ ,/ 所有/ Test/ 询问/ 的/ 回答/ 都/ 由/ 一个/ 随机/ 比特/ 来/ 决定/ ./ 即/ 敌手/ 得到/ 的/ 可能/ 全部/ 是/ 真实/ 的/ 会/ 话/ 密钥/ 或者/ 全部/ 是/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ./ 在/ FTG/ (/ Find/ -/ Then/ -/ Guess/ )/ 模型/ 中/ 常见/ 的/ Reveal/ 询问/ 在/ ROR/ 模型/ 中/ 不/ 存在/ ,/ 但是/ 由于/ FTG/ 模型/ 中/ 只/ 允许/ 敌手/ 进行/ 一次/ Test/ 询问/ ,/ ROR/ 模型/ 实际上/ 比/ FTG/ 模型/ 强/ ./ 关于/ ROR/ 模型/ 和/ FTG/ 模型/ 的/ 更/ 多/ 比较/ ,/ 参见/ 文献/ [/ 13/ ]/ ./ 2.2/ 安全/ 定义/ 本/ 小节/ 给出/ 安全/ 模型/ 中/ 的/ 安全性/ 定义/ ./ 如果/ 一个/ 实例/ 生成/ 会话/ 密钥/ 并且/ 完成/ 协议/ 运行/ ,/ 则/ 称/ 该/ 实例/ 接受/ ./ 我们/ 通过/ 会话/ 标识/ 和/ 伙伴/ 标识/ 来/ 定义/ 伙伴/ ./ 一般/ 定义/ 会话/ 标识/ 为/ 协议/ 执行/ 结束/ 后/ 所有/ 消息/ 的/ 级联/ ./ 一个/ 实例/ Ui1/ 的/ 伙伴/ 标识/ 则/ 为/ 其/ 想要/ 与/ 之/ 通信/ 的/ 实例/ Uj2/ ./ 定义/ 1/ (/ 伙伴/ )/ ./ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 被/ 称为/ 伙伴/ ,/ 如果/ :/ ①/ Ci/ 和/ Gj/ 都/ 接受/ ;/ ②/ Ci/ 和/ Gj/ 有/ 相同/ 的/ 会/ 话/ 标识/ ;/ ③/ Ci/ 的/ 伙伴/ 标识/ 为/ Gj/ ,/ 反之亦然/ ;/ ④/ 除了/ Ci/ 和/ Gj/ 外/ ,/ 不/ 存在/ 其它/ 接受/ 实例/ 的/ 伙伴/ 标识/ 为/ Ci/ 或/ Gj/ ./ 敌手/ 只能/ 对/ 新鲜/ 的/ 实例/ 进行/ Test/ 询问/ ,/ 否则/ 敌手/ 可以/ 轻易/ 赢得/ 攻击/ 游戏/ ./ 新鲜/ 性/ 定义/ 就是/ 为了/ 防止/ 敌手/ 可以/ 通过/ 平凡/ 的/ 方式/ 赢得/ 攻击/ 游戏/ ./ 定义/ 2/ (/ 新鲜/ 性/ )/ ./ 一个/ 用户/ 实例/ Ci/ 或者/ 网关/ 实例/ Gj/ 是/ 新鲜/ 的/ ,/ 如果/ 该/ 实例/ 接受/ 协议/ 运行/ 并且/ 生成/ 了/ 会/ 话/ 密钥/ ./ 在/ Abdalla/ 等/ 人/ 的/ 安全/ 模型/ 中有/ 3/ 个/ 安全/ 目标/ ,/ 包括/ 语义/ 安全性/ 、/ 密钥/ 私密性/ 和/ 口令/ 保护/ ./ 其中/ 会话/ 密钥/ 的/ 语义/ 安全性/ 保证/ 了/ 一个/ 外部/ 敌手/ 不/ 能够/ 区分/ 真实/ 的/ 会/ 话/ 密钥/ 和/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ;/ 针对/ 服务器/ 的/ 密钥/ 私密性/ 要求/ 用户/ 和/ 网关/ 之间/ 建立/ 的/ 会/ 话/ 密钥/ 对于/ 诚实/ 而/ 好奇/ 的/ 服务器/ 是/ 不可/ 区分/ 的/ ;/ 针对/ 网关/ 的/ 口令/ 保护/ 是/ 指/ 恶意/ 网关/ 通过/ 协议/ 运行/ 不能/ 得到/ 用户/ 口令/ 的/ 任何/ 信息/ ./ 下面/ 我们/ 分别/ 给出/ 这/ 3/ 个/ 安全/ 目标/ 的/ 严格/ 定义/ ./ 考虑/ 一个/ 对/ GPAKE/ 协议/ / 进行/ 攻击/ 的/ 敌手/ / ,/ 给/ 敌手/ 提供/ Execute/ ,/ Send/ 询问/ 以及/ 对/ 新鲜/ 会话/ 进行/ 多次/ Test/ 询问/ 的/ 能力/ ./ 敌手/ 的/ 目标/ 是/ 猜测/ Test/ 询问/ 中/ 所/ 使用/ 的/ 随机/ 比特/ b/ ./ 我们/ 用/ Succ/ 来/ 表示/ 敌手/ 成功/ 猜测到/ b/ 这一/ 事件/ ./ 定义/ 3/ (/ 语义/ 安全/ )/ ./ 当/ 口令/ 是从/ 字典/ 空间/ / 中/ 随机/ 选择/ 的/ 时候/ ,/ 定义/ 敌手/ / 攻破/ GPAKE/ 协议/ / 的/ 语义/ 安全/ 的/ 优势/ 为/ Page4Advake/ -/ ror/ 定义/ GPAKE/ 协议/ / 的/ 语义/ 安全/ 的/ 优势/ 函数/ 为/ 上式/ 中/ 的/ 最大值/ 遍历/ 所有/ 计算/ 时间/ 至多/ 为/ t/ ,/ 消耗/ 的/ 资源/ (/ 询问/ 不同/ 预言/ 的/ 次数/ )/ 至多/ 为/ R/ 的/ 敌手/ ./ 如果/ 一个/ GPAKE/ 协议/ / 语义/ 安全/ 的/ 优势/ 函数/ / ,/ / (/ t/ ,/ R/ )/ 至多/ 比/ kn/ // / 大/ 一个/ 可/ 忽略/ 的/ 量/ ,/ Advake/ -/ ror/ 那么/ 称/ GPAKE/ 协议/ / 是/ 语义/ 安全/ 的/ ,/ 其中/ n/ 是/ 敌手/ 进行/ 主动攻击/ 的/ 次数/ ,/ / 表示/ 字典/ 空间/ 的/ 规模/ ,/ k/ 是/ 一个/ 常数/ ./ 一般/ k/ =/ 1/ 是/ 最优/ 的/ 结果/ ,/ 因为/ 每次/ 敌手/ 进行/ 主动攻击/ 至少/ 可以/ 排除/ 一个/ 错误/ 的/ 口令/ ./ 考虑/ 一个/ 对/ GPAKE/ 协议/ / 进行/ 攻击/ 的/ 敌手/ / ,/ 给/ 敌手/ 提供/ 所有/ 用户/ 的/ 口令/ 、/ Execute/ 询问/ 以及/ 对/ 伙伴/ 会话/ 进行/ TestPair/ 询问/ 的/ 能力/ ./ 敌手/ 的/ 目标/ 是/ 猜测/ TestPair/ 询问/ 中/ 所/ 使用/ 的/ 随机/ 比特/ b/ ./ 我们/ 用/ Succ/ 来/ 表示/ 敌手/ 成功/ 猜测到/ b/ 这一/ 事件/ ./ 定义/ 4/ (/ 密钥/ 私密性/ )/ ./ 当/ 口令/ 是从/ 字典/ 空间/ / 中/ 随机/ 选择/ 的/ 时候/ ,/ 定义/ 敌手/ / 攻破/ GPAKE/ 协议/ / 的/ 密钥/ 私密性/ 的/ 优势/ 为/ Advake/ -/ kp/ 定义/ GPAKE/ 协议/ / 的/ 密钥/ 私密性/ 的/ 优势/ 函数/ 为/ 上式/ 中/ 的/ 最大值/ 遍历/ 所有/ 计算/ 时间/ 至多/ 为/ t/ ,/ 消耗/ 的/ 资源/ (/ 询问/ 不同/ 预言/ 的/ 次数/ )/ 至多/ 为/ R/ 的/ 敌手/ ./ 称/ 一个/ GPAKE/ 协议/ / 实现/ 了/ 密钥/ 私密性/ ,/ 如果/ 其/ 密钥/ 私密性/ 安全/ 的/ 优势/ 函数/ Advake/ -/ kp/ 相对/ 于/ 安全/ 参数/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 考虑/ 一个/ 恶意/ 的/ 网关/ / 猜测/ 用户/ 的/ 口令/ ,/ 然后/ 通过/ 与/ 服务器/ 执行/ 协议/ 来/ 验证/ 口令/ 是否/ 正确/ ./ 如果/ 一个/ 错误/ 的/ 猜测/ 没有/ 被/ 服务器/ 检测/ 到/ ,/ 则/ 认为/ 恶意/ 的/ 网关/ / 成功/ ./ 我们/ 用/ Advake/ -/ uoda/ 网关/ / 成功/ 的/ 优势/ ./ 定义/ 5/ (/ 口令/ 保护/ )/ ./ 称/ 一个/ GPAKE/ 协议/ / 实现/ 了/ 对/ 恶意/ 网关/ 的/ 口令/ 保护/ ,/ 如果/ 恶意/ 的/ 网关/ / 成功/ 的/ 优势/ Advake/ -/ uoda/ 略/ 的/ 量/ ,/ 其中/ n/ 是/ 敌手/ 进行/ 主动攻击/ 的/ 次数/ ,/ / 表示/ 字典/ 空间/ 的/ 规模/ ,/ k/ 是/ 一个/ 常数/ ./ 对于/ 协议/ 的/ 匿名性/ ,/ 我们/ 采用/ 文献/ [/ 14/ ]/ 中/ 的/ 定义方法/ ./ 称/ 一个/ GPAKE/ 协议/ 是/ 匿名/ 的/ ,/ 如果/ 在/ 用户/ 和/ 网关/ 建立/ 会话/ 密钥/ 的/ 过程/ 中/ ,/ 用户/ 除了/ 证明/ 自己/ 是/ 合法/ 的/ 成员/ 外/ ,/ 不/ 泄露/ 任何/ 身份/ 信息/ 给/ 网关/ 和/ 服务器/ ./ 定义/ 6/ (/ 匿名性/ )/ ./ 对于/ 两个/ 用户/ Ci/ 和/ Cj/ ,/ 分别/ 用/ P/ (/ Ci/ ,/ G/ ,/ S/ )/ 和/ P/ (/ Cj/ ,/ G/ ,/ S/ )/ 表示/ 两个/ 用户/ 执行/ 协议/ 的/ 消息/ 抄本/ ./ 称/ 一个/ GPAKE/ 协议/ / 实现/ 了/ 用户/ 匿名性/ ,/ 如果/ 有/ Dist/ [/ P/ (/ Ci/ ,/ G/ ,/ S/ )/ ]/ =/ Dist/ [/ P/ (/ Cj/ ,/ G/ ,/ S/ )/ ]/ ,/ 其中/ Dist/ [/ P/ (/ C/ ,/ G/ ,/ S/ )/ ]/ 表示/ P/ (/ C/ ,/ G/ ,/ S/ )/ 的/ 概率分布/ ./ 3/ 具有/ 强/ 匿名性/ 的/ AGPAKE/ 协议/ 3.1/ 协议/ 描述/ 设/ Gq/ 是/ 一个/ 阶为/ 大/ 素数/ q/ 的/ 循环群/ ,/ g/ ,/ h/ 为/ 随机/ 选择/ 的/ Gq/ 的/ 两个/ 生成元/ ,/ 且/ h/ 关于/ g/ 的/ 离散/ 对数/ 是/ 难解/ 的/ ;/ 设/ H/ ,/ Hi/ :/ {/ 0/ ,/ 1/ }/ / →/ {/ 0/ ,/ 1/ }/ l/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 是/ 相互/ 独立/ 的/ Hash/ 函数/ ,/ 其中/ l/ 是/ 安全/ 参数/ ./ 假设/ 系统/ 中/ 总共/ 有/ n/ 个/ 用户/ ,/ 每个/ 用户/ Ci/ 分别/ 与/ 服务器/ 共享/ 一个/ 口令/ pwi/ ./ 不失/ 一般性/ ,/ 假设/ 口令/ 已经/ 映射/ q/ 中/ 的/ 元素/ ./ 协议/ 的/ 参与者/ 有/ 用户/ 、/ 网关/ 和/ 服务/ 为/ Z/ / 器/ ,/ 网关/ 和/ 服务器之间/ 是/ 安全/ 的/ 认证/ 通道/ ./ 协议/ 的/ 描述/ 见图/ 1/ ,/ 具体/ 的/ 步骤/ 如下/ ./ 1/ ./ 用户/ Ci/ 选择/ 随机数/ x/ ,/ r1/ ∈/ Z/ / q/ ,/ 计算/ X/ =/ gx/ 以及/ R1/ =/ gr1hpwi/ ,/ 最后/ 用户/ 发送/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ 给/ 网关/ G/ ,/ 其中/ C/ 是/ 系统/ 中/ 所有/ 用户/ 的/ 身份/ ./ 2/ ./ 网关/ G/ 接收/ 到/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ 后/ ,/ 随机/ 选择/ y/ ∈/ Z/ / q/ 并且/ 计算/ Y/ =/ gy/ ,/ 然后/ 将/ Y/ 连同/ 接收/ 到/ 的/ 消息/ 一起/ 发送给/ 服务器/ S/ ./ 3/ ./ 服务器/ S/ 接收/ 到/ 网关/ 发送/ 的/ 消息/ (/ C/ ,/ X/ ,/ R1/ ,/ Y/ )/ 后/ ,/ 随机/ 选择/ r2/ ∈/ Z/ / q/ 和/ MS/ ∈/ {/ 0/ ,/ 1/ }/ l/ ,/ 然后/ 计算/ R2/ =/ gr2/ ./ 对于/ 每/ 一个/ 用户/ Cj/ (/ 1/ / j/ / n/ )/ ,/ 服务器/ 首先/ 计算/ R1/ ,/ j/ =/ R1/ // hpwj/ 和/ Kj/ =/ (/ R1/ ,/ j/ )/ r2/ ,/ 然后/ 利用/ Kj/ 对/ MS/ 进行/ 掩盖/ ,/ 即/ 计算/ Zj/ =/ H/ (/ j/ ,/ Kj/ )/ / MS/ ./ 最后/ 服务器/ 利用/ 随机数/ MS/ 计算/ 认证/ 值/ VS1/ =/ H1/ (/ ID1ID2MS/ )/ 和/ VS2/ =/ H2/ (/ ID1ID2MS/ )/ ,/ 其中/ ID1/ =/ (/ C/ ,/ G/ ,/ X/ ,/ R1/ ,/ Y/ )/ ,/ ID2/ =/ (/ R2/ ,/ {/ Zj/ }/ 1/ / j/ / n/ )/ ./ 服务器发送/ 消息/ (/ ID2/ ,/ VS1/ ,/ VS2/ )/ 给/ 网关/ ./ 4/ ./ 网关/ G/ 接收/ 到/ 消息/ (/ ID2/ ,/ VS1/ ,/ VS2/ )/ 后/ ,/ 先/ 储存/ VS2/ 用于/ 验证/ 用户/ 身份/ ,/ 然后/ 转发/ 消息/ (/ G/ ,/ Y/ ,/ ID2/ ,/ VS1/ )/ 给/ 用户/ ./ 5/ ./ 用户/ Ci/ 接收/ 到/ 消息/ (/ G/ ,/ Y/ ,/ ID2/ ,/ VS1/ )/ 后/ ,/ 首先/ 从/ {/ Zj/ }/ 1/ / j/ / n/ 找到/ 对应/ 于/ 自己/ 的/ Zi/ ,/ 然后/ 计算/ Ki/ =/ Rr12/ 和/ MS/ =/ Zi/ / H/ (/ i/ ,/ Ki/ )/ ./ 用户/ Ci/ 利用/ MS/ 验证/ VS1/ 是否/ 有效/ ./ 如果/ 无效/ 则/ 拒绝/ 协议/ ,/ 否则/ 计算/ 认证/ 值/ VS2/ =/ H2/ (/ ID1ID2MS/ )/ 和/ VS3/ =/ H3/ (/ ID1ID2MS/ )/ 以及/ Diffie/ -/ Hellman/ 密钥/ K/ =/ Yx/ ./ 最后/ 用户/ Ci/ 计算/ 会话/ 密钥/ sk/ =/ H0/ (/ ID1ID2K/ )/ ,/ 发送/ 消息/ (/ C/ ,/ VS2/ ,/ VS3/ )/ 给/ 网关/ 并且/ 接受/ 协议/ 运行/ ./ 6/ ./ 网关/ 接收/ 到/ 消息/ (/ C/ ,/ VS2/ ,/ VS3/ )/ 后/ ,/ 首先/ 验证/ 用户/ Ci/ 发送/ 的/ VS2/ 是否/ 等于/ 所/ 储存/ 的/ VS2/ ./ 如果/ 验证/ 通过/ ,/ 则/ 网关/ 接受/ 协议/ 运行/ 并/ 计算/ Diffie/ -/ Hellman/ 密钥/ K/ =/ Xy/ =/ gxy/ 以及/ 会话/ 密钥/ sk/ =/ H0/ (/ ID1ID2K/ )/ ;/ 否则/ ,/ 网关/ 拒绝/ 协议/ 运行/ 并/ 终止/ ./ 最后/ ,/ 网关/ 发送/ 消息/ (/ C/ ,/ VS3/ )/ 给/ 服务器/ ,/ 服务器/ 验证/ VS3/ 是否/ 有效/ ./ 如果/ 验证/ 通过/ ,/ 说明/ 认证/ 请求/ 确实/ 是/ 一个/ 诚实/ 的/ 用户/ 发送/ 的/ ;/ 否则/ ,/ 认证/ 请求/ 很/ 可能/ 来自/ 一个/ 恶意/ 网关/ 对/ 用户/ 的/ 在线/ 仿冒/ 攻击/ ,/ 服务器/ 将/ 采取/ 进一步/ 的/ 措施/ 以/ 保护/ 用户/ 口令/ ./ Page5/ 图/ 1/ 匿名/ 的/ AGPAKE/ 协议/ 3.2/ 安全性/ 证明/ 本/ 小节/ 给出/ 匿名/ 的/ AGPAKE/ 协议/ 的/ 安全性/ 证明/ ./ 协议/ 的/ 安全性/ 基于/ DDH/ 假设/ ,/ 下面/ 给出/ DDH/ 假设/ 的/ 定义/ ./ DDH/ 假设/ ./ 假设/ Gq/ 为阶为/ 素数/ q/ 的/ 循环群/ ,/ g/ 为/ Gq/ 的/ 一个/ 生成元/ ./ 假设/ / ddh/ 是/ 一个/ 概率/ 多项式/ 时间/ 的/ 敌手/ ,/ 模拟/ 者/ 首先/ 随机/ 选择/ u/ ,/ v/ ,/ w/ ∈/ Zq/ ,/ 并且/ 计算/ U/ =/ gu/ ,/ V/ =/ gv/ 和/ W/ =/ gw/ ,/ 然后/ 随机/ 选择/ 一个/ 比特/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 如果/ b/ =/ 1/ ,/ 那么/ 将/ (/ gu/ ,/ gv/ ,/ guv/ )/ 给/ 敌手/ ,/ 否则/ 将/ (/ gu/ ,/ gv/ ,/ gw/ )/ 给/ 敌手/ ./ 敌手/ 需要/ 猜测/ 随机/ 比特/ b/ 的/ 值/ ,/ 如果/ 敌手/ 猜测/ 正确/ 就/ 认为/ 敌手/ 成功/ ,/ 记此/ 事件/ 为/ Succ/ ./ 定义/ 敌手/ 的/ 优势/ 为/ Adv/ (/ / ddh/ )/ =/ 2/ ·/ Pr/ [/ Succ/ ]/ -/ 1/ ./ 如果/ 对于/ 任意/ 的/ 概率/ 多项式/ 敌手/ ,/ 上述/ 优势/ 都/ 是/ 可/ 忽略/ 的/ ,/ 那么/ 称/ 循环群/ Gq/ 中/ DDH/ 假设/ 成立/ ./ 定理/ 1/ (/ 语义/ 安全/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qSend/ 次/ Send/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 如果/ DDH/ 假设/ 在/ 群/ Gq/ 中/ 成立/ ,/ 那么/ 敌手/ / 破坏/ AGPAKE/ 协议/ 的/ 语义/ 安全/ 的/ 优势/ 至多/ 为/ 其中/ neg/ (/ l/ )/ 表示/ 关于/ 安全/ 参数/ l/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 证明/ ./ 我们/ 采用/ 混合/ 实验/ 的/ 方法/ 来/ 证明/ 协议/ 的/ 语义/ 安全性/ ,/ 证明/ 思路/ 是/ 通过/ 一系列/ 攻击/ 实验/ 对/ 模拟/ 规则/ 逐渐/ 进行/ 改变/ ,/ 直到/ 敌手/ 的/ 优势/ 为/ 可/ 忽略/ 的/ 函数/ 为止/ ./ 我们/ 用/ 事件/ Succ/ 表示/ 敌手/ 正确/ 猜测出/ 了/ 在/ Test/ 询问/ 中/ 所/ 使用/ 的/ 随机/ 比特/ b/ ,/ 用/ Adv/ (/ / ,/ Pi/ )/ 表示/ 敌手/ / 在/ 第/ i/ 个/ 混合/ 实验/ 中/ 的/ 优势/ ./ 实验/ P0/ :/ 此/ 实验/ 模拟/ 在/ 随机/ 预言/ 模型/ 下/ 的/ 真实/ 协议/ 运行/ ,/ 在/ 试验/ 中/ 敌手/ / 可以/ 多次/ 进行/ Execute/ 、/ Send/ 和/ Test/ 询问/ ./ 根据/ 定义/ 有/ 实验/ P1/ :/ 在/ 这个/ 实验/ 中/ ,/ 我们/ 通过/ 维持/ 哈希/ 列表/ 来/ 模拟/ 随机/ 预言/ 函数/ Hi/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 以及/ H/ ./ 另外/ 我们/ 还/ 模拟/ 私有/ 的/ 随机/ 预言/ 函数/ Hi/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 以及/ H/ ,/ 这/ 5/ 个/ 私有/ 的/ 随机/ 预言/ 函数/ 将/ 在/ 后面/ 的/ 实验/ 中/ 用到/ ./ 随机/ 预言/ 函数/ 的/ 模拟/ 规则/ 如下/ ./ (/ 1/ )/ Hi/ 查询/ 列表/ ∧/ Hi/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ ./ 对于/ 每/ 一次/ 随机/ 预言/ 询问/ Hi/ (/ m/ )/ ,/ 如果/ 列表/ ∧/ Hi/ 中/ 存在/ 记录/ (/ i/ ,/ m/ ,/ r/ )/ ,/ 则/ 返回/ r/ ;/ 否则/ ,/ 随机/ 选择/ r/ ∈/ {/ 0/ ,/ 1/ }/ l/ ,/ 将/ r/ 返回/ 给/ 询问者/ ,/ 并且/ 将/ 记录/ (/ i/ ,/ m/ ,/ r/ )/ 添加/ 到/ 列表/ ∧/ Hi/ ./ Page6/ (/ 2/ )/ Hi/ 查询/ 列表/ ∧/ Hi/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ ./ 对于/ 每/ 一次/ 随机/ 预言/ 询问/ Hi/ (/ m/ )/ ,/ 如果/ 列表/ ∧/ Hi/ 中/ 存在/ 记录/ (/ i/ ,/ m/ ,/ r/ )/ ,/ 则/ 返回/ r/ ;/ 否则/ ,/ 随机/ 选择/ r/ ∈/ {/ 0/ ,/ 1/ }/ l/ ,/ 将/ r/ 返回/ 给/ 询问者/ ,/ 并且/ 将/ 记录/ (/ i/ ,/ m/ ,/ r/ )/ 添加/ 到/ 列表/ ∧/ Hi/ ./ (/ 3/ )/ H/ 查询/ 列表/ ∧/ H/ ./ 对于/ 每/ 一次/ 随机/ 预言/ 询问/ H/ (/ m/ )/ ,/ 如果/ 列表/ ∧/ H/ 中/ 存在/ 记录/ (/ m/ ,/ r/ )/ ,/ 则/ 返回/ r/ ;/ 否则/ ,/ 随机/ 选择/ r/ ∈/ {/ 0/ ,/ 1/ }/ l/ ,/ 将/ r/ 返回/ 给/ 询问者/ ,/ 并且/ 将/ 记录/ (/ m/ ,/ r/ )/ 添加/ 到/ 列表/ ∧/ H/ ./ (/ 4/ )/ H/ 查询/ 列表/ ∧/ H/ ./ 对于/ 每/ 一次/ 随机/ 预言/ 询问/ H/ (/ m/ )/ ,/ 如果/ 列表/ ∧/ H/ 中/ 存在/ 记录/ (/ m/ ,/ r/ )/ ,/ 则/ 返回/ r/ ;/ 否则/ ,/ 随机/ 选择/ r/ ∈/ {/ 0/ ,/ 1/ }/ l/ ,/ 将/ r/ 返回/ 给/ 询问者/ ,/ 并且/ 将/ 记录/ (/ m/ ,/ r/ )/ 添加/ 到/ 列表/ ∧/ H/ ./ 除了/ 模拟/ 随机/ 预言/ 函数/ 外/ ,/ 我们/ 还/ 根据/ 协议/ 描述/ 模拟/ 所有/ 的/ Execute/ 、/ Send/ 和/ Test/ 询问/ ./ 由/ 模拟/ 的/ 规则/ 可知/ 实验/ P2/ :/ 为了/ 方便/ 后面/ 的/ 分析/ ,/ 在/ 此/ 实验/ 中/ 我们/ 排除/ 一些/ 发生/ 碰撞/ 的/ 会/ 话/ ./ 具体来说/ ,/ 如果/ 会话/ 中/ 消息/ 抄本/ 发生/ 碰撞/ ,/ 或者/ 随机/ 预言/ 函数/ 的/ 输出/ 发生/ 碰撞/ ,/ 那么/ 我们/ 取消/ 该次/ 会/ 话/ 的/ 运行/ ./ 由/ 生日/ 攻击/ 原理/ 可知/ ,/ 实验/ P2/ 和/ 实验/ P1/ 是/ 不可/ 区分/ 的/ ,/ 因此/ 有/ Adv/ (/ / ,/ P2/ )/ -/ Adv/ (/ / ,/ P1/ )/ / neg/ (/ l/ )/ ./ 实验/ P3/ :/ 从此/ 实验/ 开始/ ,/ 我们/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 具体来说/ ,/ 我们/ 在/ 被动/ 会话/ 中将/ Hash/ 函数/ H/ 以及/ H1/ ,/ H2/ ,/ H3/ 分别/ 替换/ 为/ 实验/ P1/ 中/ 定义/ 的/ 私有/ 随机/ 预言/ 函数/ H/ 和/ H1/ ,/ H2/ ,/ H3/ ,/ 并且/ 随机/ 选择/ 随机/ 预言/ 函数/ 中/ 的/ 输入/ Kj/ 以及/ MS/ ./ 我们/ 现在/ 来/ 证明/ 实验/ P3/ 和/ 实验/ P2/ 是/ 不可/ 区分/ 的/ ./ 敌手/ 如果/ 想要/ 区分/ 实验/ P3/ 和/ 实验/ P2/ ,/ 由于/ 在/ H1/ ,/ H2/ ,/ H3/ 中/ 的/ 输入/ 只有/ MS/ 是/ 秘密/ 的/ 值/ ,/ 其余/ 的/ 都/ 是/ 公开/ 值/ ,/ 因此/ 对于/ 某/ 一次/ 被动/ 会话/ ,/ 敌手/ 如果/ 正确/ 恢复/ 出/ MS/ 则/ 可以/ 区分/ 实验/ P3/ 和/ 实验/ P2/ ./ 由于/ Zj/ =/ H/ (/ j/ ,/ Kj/ )/ / MS/ ,/ 因此/ 对于/ 任意/ 的/ 1/ / j/ / n/ ,/ 敌手/ 需要/ 计算/ 出/ 一个/ 正确/ 的/ Kj/ 才/ 可以/ 正确/ 恢复/ 出/ MS/ ./ 但是/ 因为/ 会话/ 是/ 被动/ 的/ ,/ 并且/ R1/ 对应/ 于/ 用户/ Ci/ ,/ 因此/ 实际上/ 敌手/ 需要/ 恢复/ 出/ 正确/ 的/ Ki/ ./ 用/ 事件/ PassiveAskH/ 表示/ 敌手/ 正确/ 计算/ 出/ Ki/ 并且/ 向/ 随机/ 预言/ 函数/ H/ 进行/ 了/ 相应/ 的/ 询问/ ,/ 显然/ 如果/ PassiveAskH/ 事件/ 发生/ ,/ 那么/ 敌手/ 可以/ 区分/ 实验/ P3/ 和/ 实验/ P2/ ;/ 用/ PassiveAskHi/ 表示/ 在/ PassiveAskH/ 事件/ 没有/ 发生/ 的/ 情况/ 下/ ,/ 敌手/ 用/ 正确/ 的/ MS/ 向/ 随机/ 预言/ 函数/ H1/ ,/ H2/ ,/ H3/ 进行/ 相应/ 的/ 询问/ ./ 如果/ PassiveAskH/ 没有/ 发生/ ,/ 那么/ 敌手/ 不/ 可能/ 知道/ 正确/ 的/ MS/ ,/ 因此/ 事件/ PassiveAskHi/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 我们/ 现在/ 来/ 证明/ ,/ PassiveAskH/ 发生/ 的/ 概率/ 至多/ 为/ 敌手/ 破解/ CDH/ 问题/ 的/ 优势/ ,/ 即/ 敌手/ 区分/ 实验/ P3/ 和/ 实验/ P2/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 给定/ 一个/ CDH/ 实例/ (/ U/ ,/ V/ )/ ,/ 我们/ 定义/ 一个/ 额外/ 的/ 实验/ P3/ ./ 在/ 实验/ P3/ 中/ ,/ 当/ 我们/ 模拟/ Execute/ 询问/ 时/ ,/ 令/ 用户/ Ci/ 计算/ R1/ =/ Ua1ga2/ ×/ hpwi/ ,/ 服务器/ 计算/ R2/ 时令/ R2/ =/ Vb1gb2/ ,/ 其中/ a1/ ,/ a2/ ,/ b1/ ,/ b2/ ∈/ Z/ / 模拟/ 规则/ 和/ 实验/ P3/ 完全相同/ ./ 注意/ 虽然/ 实验/ P3/ 和/ 实验/ P3/ 的/ 模拟/ 规则/ 不同/ ,/ 但是/ 分布/ 却/ 完全相同/ ./ 如果/ 事件/ PassiveAskH/ 发生/ ,/ 我们/ 可以/ 从/ ∧/ H/ 列表/ 中/ 提取/ Ki/ =/ CDH/ (/ Ua1ga2/ ,/ Vb1gb2/ )/ =/ CDH/ (/ U/ ,/ V/ )/ a1b1/ ·/ Ua1b2/ ·/ Va2b1/ ·/ ga2b2/ ,/ 由于/ a1/ ,/ a2/ ,/ b1/ ,/ b2/ 已知/ ,/ 因此/ 可以/ 得到/ CDH/ (/ U/ ,/ V/ )/ =/ (/ Ki/ // (/ Ua1b2/ ·/ Va2b1/ ·/ ga2b2/ )/ )/ -/ a1b1/ ,/ 从而/ 得到/ 了/ CDH/ 问题/ 的/ 解/ ./ 由/ CDH/ 问题/ 的/ 困难性/ 假设/ 可知/ 事件/ PassiveAskH/ 发生/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 由/ 上面/ 的/ 分析/ 可知/ 实验/ P3/ 和/ 实验/ P2/ 是/ 不可/ 区分/ 的/ ,/ 因此/ 有/ 实验/ P4/ :/ 在/ 这个/ 实验/ 中/ ,/ 我们/ 继续/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 我们/ 修改/ 用户/ 和/ 网关/ 的/ 会/ 话/ 密钥/ 的/ 计算/ 方式/ ,/ 即/ 使用/ 私有/ 的/ 随机/ 预言/ 函数/ H0/ 来/ 计算/ 会话/ 密钥/ sk/ ./ 这样/ 的/ 修改/ 使得/ 被动/ 会话/ 中会话/ 密钥/ sk/ 完全/ 与/ 随机/ 预言/ 函数/ H0/ 以及/ Diffie/ -/ Hellman/ 密钥/ K/ 无关/ ./ 由于/ 在/ 上/ 一个/ 实验/ 中/ ,/ 我们/ 令/ 用户/ 和/ 服务器之间/ 的/ 认证/ 值/ 完全/ 与/ MS/ 无关/ ,/ 因此/ 在/ 此/ 实验/ 中/ 可以/ 简化/ 模拟/ 规则/ ,/ 在/ 模拟/ 被动/ 会话/ 时/ 直接/ 从/ Gq/ 中/ 随机/ 选择/ R1/ 和/ R1/ ,/ j/ 以及/ Kj/ 的/ 值/ ./ 在/ 实验/ P4/ 中/ ,/ 所有/ 的/ 被动/ 会话/ 中/ 的/ 认证/ 值和会/ 话/ 密钥/ 都/ 是/ 随机/ 选择/ 的/ ,/ 并且/ 口令/ 在/ 被动/ 会话/ 中/ 也/ 完全/ 没有/ 用到/ ,/ 因此/ 敌手/ 在/ 区分/ 被动/ 会话/ 的/ 会/ 话/ 密钥/ 时/ 没有/ 任何/ 优势/ ,/ 也/ 不能/ 通过/ 被动/ 会话/ 得到/ 口令/ 的/ 任何/ 信息/ ./ 需要/ 说明/ 的/ 是/ ,/ 在/ 主动攻击/ 的/ 会/ 话/ 中/ ,/ 模拟/ 规则/ 依然/ 和/ 真实/ 的/ 实验/ 一样/ ./ 通过/ 和/ 实验/ P3/ 类似/ 的/ 分析/ 可知/ 实验/ P4/ 和/ 实验/ P3/ 是/ 不可/ 区分/ 的/ ,/ 敌手/ 区分/ 这/ 两个/ 实验/ 的/ 优势/ 至多是/ 破解/ CDH/ 问题/ 的/ 优势/ ,/ 因此/ 有/ 实验/ P5/ :/ 在/ 这个/ 实验/ 中/ ,/ 我们/ 处理/ 敌手/ / 通过/ Send/ 询问/ 进行/ 的/ 被动/ 攻击/ ,/ 也就是说/ 敌手/ 只是/ 诚实/ 转发/ 消息/ ,/ 不/ 对/ 消息/ 进行/ 任何/ 改动/ ./ 具体来说/ ,/ 对于/ 这些/ 貌似/ 主动/ 实际/ 还是/ 被动/ 的/ 特殊/ 会话/ ,/ 我们/ 用/ 私有/ 的/ 随机/ 预言/ 函数/ 来/ 计算/ 认证/ 值/ 以及/ 会话/ 密钥/ ,/ 修改/ 的/ 规则/ 和/ 实验/ P4/ 中/ 对/ 被动/ 会话/ 的/ 处理/ 完全相同/ ,/ 并且/ 通过/ 类似/ 的/ 分析/ 有/ Page7Adv/ (/ / ,/ P5/ )/ -/ Adv/ (/ / ,/ P4/ )/ / neg/ (/ l/ )/ ./ 实验/ P6/ :/ 在/ 这个/ 实验/ 中/ ,/ 我们/ 开始/ 处理/ 敌手/ / 通过/ Send/ 询问/ 进行/ 的/ 主动攻击/ ./ 对于/ 敌手/ 的/ (/ Ci/ ,/ Gj/ ,/ start/ )/ 询问/ ,/ 我们/ 首先/ 随机/ 选择/ R1/ ∈/ G/ / q/ 并/ 计算/ X/ =/ gx/ ,/ 然后/ 返回/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ 给/ x/ ∈/ Z/ / 敌手/ ,/ 并且/ 当/ 敌手/ 返回/ 消息/ (/ G/ ,/ Y/ ,/ ID2/ ,/ VS1/ )/ 的/ 时候/ ,/ 我们/ 令/ 用户/ 实例/ 拒绝接受/ 并且/ 终止/ 协议/ 运行/ ./ 实验/ P6/ 与/ 实验/ P5/ 是/ 不可/ 区分/ 的/ ,/ 除非/ 对于/ (/ Ci/ ,/ Gj/ ,/ start/ )/ 询问/ 返回/ 的/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ ,/ 敌手/ 向/ 随机/ 预言/ 函数/ H/ 询问/ 输入/ 为/ (/ i/ ,/ Ki/ )/ 的/ 值/ ,/ 其中/ Ki/ =/ (/ R1/ // hpwi/ )/ r2/ 并且/ R2/ =/ gr2/ ,/ 我们/ 记此/ 事件/ 为/ AskHWithC/ ./ 显然/ 有/ Adv/ (/ / ,/ P6/ )/ -/ Adv/ (/ / ,/ P5/ )/ / Pr/ [/ AskHWithC6/ ]/ ./ 实验/ P7/ :/ 在/ 这个/ 实验/ 中/ ,/ 我们/ 最后/ 一次/ 处理/ 敌手/ / 通过/ Send/ 询问/ 进行/ 的/ 主动攻击/ ./ 对于/ 敌手/ 的/ Send/ (/ Gj/ ,/ (/ C/ ,/ X/ ,/ R1/ )/ )/ 询问/ ,/ 我们/ 返回/ 消息/ (/ G/ ,/ Y/ ,/ ID2/ ,/ VS1/ )/ ,/ 其中/ VS1/ 是/ 通过/ 私有/ 的/ 随机/ 预言/ 函数/ H1/ 计算/ 得到/ 的/ ,/ 其/ 秘密/ 输入/ 为/ 一个/ 随机/ 选择/ 的/ MS/ ./ 另外/ ,/ Zj/ (/ 1/ / j/ / n/ )/ 的/ 值/ 我们/ 也/ 随机/ 选择/ ./ 当/ 敌手/ 返回/ 消息/ (/ C/ ,/ VS2/ ,/ VS3/ )/ 的/ 时候/ ,/ 我们/ 令/ 网关/ 实例/ 直接/ 拒绝/ 并且/ 终止/ 协议/ 运行/ ./ 注意/ 到/ Kj/ 在/ 模拟/ 中/ 没有/ 用到/ ,/ 因此/ 我们/ 可以/ 简化/ 协议/ 的/ 模拟/ ,/ 取消/ 对/ Kj/ 的/ 计算/ ./ 显然/ ,/ 实验/ P7/ 与/ 实验/ P6/ 是/ 不可/ 区分/ 的/ ,/ 除非/ 敌手/ 计算/ 出某/ 一个/ 正确/ 的/ Kj/ 值/ ,/ 然后/ 恢复/ 出/ 正确/ 的/ MS/ ,/ 最后/ 对/ 随机/ 预言/ 函数/ H1/ ,/ H2/ ,/ H3/ 进行/ 询问/ ./ 敌手/ 区分/ 的/ 关键在于/ 计算/ 出/ 一个/ 正确/ 的/ Kj/ 值/ 并且/ 向/ 随机/ 预言/ 函数/ H/ 询问/ (/ j/ ,/ Kj/ )/ ,/ 我们/ 记此/ 事件/ 为/ AskHWithG/ ./ 显然/ 有/ Adv/ (/ / ,/ P7/ )/ -/ Adv/ (/ / ,/ P6/ )/ / Pr/ [/ AskHWithG7/ ]/ ./ 在/ 实验/ P7/ 中/ ,/ 我们/ 现在/ 来/ 计算/ 事件/ AskHWithC7/ 和/ AskHWithG7/ 的/ 概率/ ,/ 并且/ 在/ 此基础/ 上/ 进一步/ 计算/ 敌手/ 破坏/ 协议/ 语义/ 安全/ 的/ 优势/ ./ 首先/ 注意/ 到/ 在/ 实验/ P7/ 中/ ,/ 我们/ 在/ 模拟/ 的/ 时候/ 完全/ 没有/ 用到/ 口令/ 的/ 任何/ 信息/ ,/ 口令/ 可以/ 在/ 模拟/ 的/ 最后/ 阶段/ 来/ 选择/ ./ 所有/ 被动/ 会话/ 的/ 会/ 话/ 密钥/ 都/ 是/ 随机/ 选择/ 的/ ,/ 而/ 敌手/ 进行/ 主动攻击/ 的/ 会/ 话/ 都/ 会/ 被/ 拒绝接受/ ./ 根据/ 上面/ 的/ 分析/ 可知/ ,/ 敌手/ 在/ 实验/ P7/ 区分/ 真实/ 的/ 会/ 话/ 密钥/ 和/ 随机数/ 不会/ 有/ 任何/ 优势/ ,/ 因此/ 有/ Succ7/ =/ 1/ // 2/ ./ 事件/ AskHWithC7/ 实际上/ 对应/ 着/ 敌手/ 冒充/ 网关/ 欺骗/ 诚实/ 用户/ 的/ 攻击/ ,/ 由于/ 敌手/ 产生/ 的/ 认证/ 值/ VS1/ 唯一/ 对应/ 着/ 一个/ MS/ ,/ 相应/ 的/ 唯一/ 对应/ 于/ 一个/ 口令/ 值/ pwi/ ,/ 由于/ 我们/ 在/ 实验/ P3/ 中/ 已经/ 排除/ 了/ 随机/ 预言/ 函数/ 的/ 碰撞/ ,/ 因此/ 有/ 类似/ 的/ ,/ 事件/ AskHWithG7/ 对应/ 于/ 敌手/ 冒充/ 用户/ 来/ 欺骗/ 网关/ 的/ 攻击/ ,/ 类似/ 于/ 事件/ AskHWithC7/ 的/ 分析/ ,/ 我们/ 有/ 综上/ ,/ 定理/ 1/ 得证/ ./ 定理/ 2/ (/ 密钥/ 私密性/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qExecute/ 次/ Execute/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 如果/ DDH/ 假设/ 在/ 群/ Gq/ 中/ 成立/ ,/ 那么/ 敌手/ / 破坏/ AGPAKE/ 协议/ 的/ 密钥/ 私密性/ 的/ 优势/ 至多/ 为/ 证明/ ./ 假设/ / kp/ 是/ 运行/ 时间/ 至多/ 为/ t/ ,/ 进行/ 了/ qExecute/ 次/ Execute/ 询问/ 和/ qTest/ 次/ TestPair/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 下面/ 我们/ 通过/ 调用/ / kp/ 来/ 构造/ 一个/ 可以/ 解决/ DDH/ 问题/ 的/ 敌手/ / DDH/ ./ 设/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 给/ / DDH/ 的/ 输入/ ./ / DDH/ 首先/ 根据/ 口令/ 空间/ / 的/ 分布/ 为/ 所有/ 的/ 用户/ 选择/ 口令/ ./ / DDH/ 随机/ 选择/ 一个/ 随机/ 比特/ b/ 用于/ 模拟/ TestPair/ 询问/ ,/ 然后/ / DDH/ 将/ 所有/ 的/ 口令/ 告诉/ 敌手/ / kp/ 并且/ 开始/ 模拟/ 协议/ 的/ 运行/ ./ 为了/ 模拟/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ / DDH/ 首先/ 随机/ 选择/ 四个/ 随机数/ a1/ ,/ a2/ ,/ b1/ ,/ b2/ ∈/ Z/ / q/ ,/ 计算/ X/ =/ Ua1ga2/ 和/ R1/ =/ gr1hpwi/ ./ / DDH/ 然后/ 将/ 消/ Z/ / 息/ (/ C/ ,/ X/ ,/ R1/ )/ 发送给/ 网关/ ./ 网关/ 接收/ 到/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ 后/ ,/ 计算/ Y/ =/ Vb1gb2/ 并且/ 发送/ (/ C/ ,/ X/ ,/ R1/ ,/ Y/ )/ 给/ 服务器/ ./ / DDH/ 正常/ 模拟/ 协议/ 剩余/ 的/ 步骤/ 直到/ 计算/ Diffie/ -/ Hellman/ 密钥/ K/ 为止/ ,/ / DDH/ 设置/ Diffie/ -/ Hellman/ 密钥/ K/ =/ Wa1b1/ ·/ Ua1b2/ ·/ Wa2b1/ ·/ ga2b2/ ,/ / DDH/ 按照/ 协议/ 的/ 描述/ 完成/ 剩余/ 的/ 模拟/ ./ 为了/ 模拟/ TestPair/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ / DDH/ 首先/ 检查/ 敌手/ / kp/ 是否/ 进行/ 过/ 相同/ 的/ 询问/ ./ 如果/ 是/ ,/ 则/ 返回/ 与/ 上次/ 相同/ 的/ 回答/ ;/ 否则/ / DDH/ 检查/ Ci/ 和/ Gj/ 是否是/ 伙伴/ ,/ 如果/ 不是/ ,/ 则/ 返回/ 错误/ 的/ 符号/ ⊥/ ./ 在/ Ci/ 和/ Gj/ 是/ 伙伴/ 的/ 情况/ 下/ ,/ 如果/ 随机/ 比特/ b/ =/ 1/ ,/ 那么/ / DDH/ 返回/ 真实/ 的/ 会/ 话/ 密钥/ sk/ 给/ 敌手/ / kp/ ,/ 如果/ 随机/ 比特/ b/ =/ 0/ ,/ 那么/ / DDH/ 返回/ 一个/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ 给/ 敌手/ / kp/ ./ 如果/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ Diffie/ -/ Hellman/ 三元组/ ,/ 那么/ 上面/ 的/ 模拟/ 是/ 完美/ 的/ ,/ 因此/ / DDH/ 输出/ 1/ 的/ 概率/ 为/ 1Page8/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ 随机/ 的/ 三元组/ ,/ 那么/ 无论/ b/ 为/ 0/ 或者/ 1/ ,/ 返回/ 给/ 敌手/ / kp/ 的/ 都/ 是/ 随机数/ ,/ 因此/ 不会/ 泄露/ 关于/ b/ 的/ 任何/ 信息/ ,/ 此时/ / DDH/ 输出/ 1/ 的/ 概率/ 为/ 1/ 综上/ ,/ 定理/ 2/ 得证/ ./ 定理/ 3/ (/ 口令/ 保护/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qSend/ 次/ Send/ 询问/ 的/ 概率/ 多项式/ 敌手/ ,/ 那么/ 敌手/ / 对/ AGPAKE/ 协议/ 进行/ 不可/ 检测/ 在线/ 字典/ 攻击/ 成功/ 的/ 优势/ 至多/ 为/ 证明/ ./ 考虑/ 一个/ 恶意/ 网关/ / 冒充/ 诚实/ 用户/ 并且/ 发送/ 接入/ 请求/ 给/ 服务器/ ./ 根据/ 协议/ 的/ 描述/ ,/ 服务器/ 应该/ 随机/ 选择/ r2/ ∈/ Z/ / R2/ =/ gr2/ ./ 对于/ 每/ 一个/ 用户/ Cj/ (/ 1/ / j/ / n/ )/ ,/ 还/ 需要/ 计算/ R1/ ,/ j/ =/ R1/ // hpwj/ 和/ Kj/ =/ (/ R1/ ,/ j/ )/ r2/ 以及/ Zj/ =/ H/ (/ j/ ,/ Kj/ )/ / MS/ ./ 最后/ 服务器/ 利用/ 随机数/ MS/ 计算/ 认证/ 值/ VS1/ =/ H1/ (/ ID1ID2MS/ )/ 和/ VS2/ =/ H2/ (/ ID1ID2MS/ )/ ,/ 其中/ ID1/ =/ (/ C/ ,/ G/ ,/ X/ ,/ R1/ ,/ Y/ )/ ,/ ID2/ =/ (/ R2/ ,/ {/ Zj/ }/ 1/ / j/ / n/ )/ ./ 服务器发送/ 消息/ (/ ID2/ ,/ VS1/ ,/ VS2/ )/ 给/ 网关/ ./ 恶意/ 网关/ 为了/ 欺骗/ 成功/ ,/ 需要/ 相应/ 地/ 返回/ 一个/ 认证/ 值/ VS3/ =/ H3/ (/ ID1ID2MS/ )/ ./ 如果/ 恶意/ 网关/ / 对/ 用户/ 的/ 口令/ 猜测/ 错误/ ,/ 那么/ 计算/ 出/ 的/ Ki/ 是/ 错误/ 的/ ,/ 相应/ 的/ 也/ 无法/ 正确/ 恢复/ 出/ MS/ 的/ 值/ ./ 除非/ 敌手/ 能够/ 在/ 不/ 询问/ H3/ (/ ID1ID2MS/ )/ 的/ 条件/ 下/ 猜测出/ VS3/ ,/ 否则/ 服务器/ 在/ 接收/ 到/ 认证/ 值/ VS3/ 后/ 将/ 会/ 拒绝/ ./ 但是/ 由于/ H3/ 为/ 随机/ 预言/ 函数/ ,/ 因此/ 在/ 不/ 询问/ H3/ (/ ID1ID2MS/ )/ 而/ 正确/ 猜测到/ VS3/ 的/ 值/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 如果/ 恶意/ 网关/ / 对/ 用户/ 的/ 口令/ 猜测/ 正确/ ,/ 那么/ 很/ 容易/ 根据/ 协议/ 描述/ 计算/ 出/ 正确/ 的/ VS3/ ./ 但是/ 注意/ 到/ 恶意/ 网关/ / 从/ 服务器/ 发出/ 的/ 消息/ (/ ID2/ ,/ VS1/ ,/ VS2/ )/ 至多/ 排除/ 一个/ 口令/ ,/ 因此/ 恶意/ 网关/ / 猜测/ 口令/ 正确/ 的/ 概率/ 至多/ 为/ qSend/ 因此/ ,/ 恶意/ 网关/ / 对/ AGPAKE/ 协议/ 进行/ 不可/ 检测/ 在线/ 字典/ 攻击/ 成功/ 的/ 概率/ 至多/ 为/ 定理/ 4/ (/ 匿名性/ )/ ./ 匿名/ 的/ AGPAKE/ 协议/ 实现/ 了/ 用户/ 身份/ 的/ 匿名性/ ,/ 并且/ 一个/ 恶意/ 服务器/ 至多/ 以/ 1/ // n/ 的/ 概率/ 破坏/ 用户/ 的/ 匿名性/ ./ 证明/ ./ 对于/ 用户/ Ci/ (/ 1/ / i/ / n/ )/ 发送/ 的/ 第一条/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ ,/ 因为/ x/ ,/ r1/ 是从/ Z/ / 因此/ (/ C/ ,/ X/ ,/ R1/ )/ 在/ 集合/ C/ ×/ Gq/ ×/ Gq/ 上/ 是/ 均匀分布/ 的/ ;/ 由于/ 所有/ 的/ Zj/ (/ 1/ / j/ / n/ )/ 中/ 使用/ 相同/ 的/ MS/ ,/ 因此/ 用户/ Ci/ 发送/ 的/ 消息/ (/ C/ ,/ VS2/ ,/ VS3/ )/ 不会/ 泄露/ 用户/ 身份/ 的/ 信息/ ./ 对于/ 两个/ 用户/ Ci/ 和/ Cj/ ,/ 显然/ 有/ Dist/ [/ P/ (/ Ci/ ,/ G/ ,/ S/ )/ ]/ =/ Dist/ [/ P/ (/ Cj/ ,/ G/ ,/ S/ )/ ]/ ,/ 因此/ AGPAKE/ 协议/ 实现/ 了/ 用户/ 身份/ 的/ 匿名性/ ./ 考虑/ 一个/ 恶意/ 的/ 服务器/ 试图/ 通过/ 协议/ 运行/ 获得/ 用户/ 身份/ ./ 在/ 用户/ 发送/ 消息/ (/ C/ ,/ X/ ,/ R1/ )/ 给/ 服务器/ 后/ ,/ 服务器/ 如果/ 真实/ 地/ 执行/ 协议/ ,/ 由于/ R1/ 是/ 随机/ 的/ ,/ 并且/ 由于/ 所有/ 的/ Zj/ (/ 1/ / j/ / n/ )/ 中/ 都/ 使用/ 相同/ 的/ MS/ ,/ 那么/ 服务器/ 不/ 可能/ 有/ 任何/ 优势/ 区分/ 用户/ 的/ 身份/ ./ 根据/ 协议/ 的/ 描述/ ,/ 服务器/ 只能/ 通过/ 用户/ 返回/ 的/ 消息/ (/ C/ ,/ VS2/ ,/ VS3/ )/ 来/ 对/ 用户/ 身份/ 进行/ 猜测/ ,/ 注意/ 到/ 认证/ 值/ VS2/ ,/ VS3/ 中/ 只有/ 一个/ 秘密/ 输入/ MS/ ,/ 因此/ 服务器/ 只有/ 针对/ 不同/ 的/ 用户/ Ci/ 选择/ 不同/ 的/ 秘密/ 值/ MSi/ 才能/ 区分/ 用户/ ,/ 但是/ 协议/ 中/ 要求/ 服务器/ 在/ 返回/ 消息/ 的/ 时候/ 计算/ 出/ 一个/ 认证/ 值/ VS1/ ,/ 但是/ 此时/ 服务器/ 不/ 知道/ 用户/ 身份/ 的/ 任何/ 信息/ ,/ 因此/ 服务器/ 只能/ 以/ 1/ // n/ 的/ 概率/ 来/ 猜测/ 用户/ 的/ 身份/ 并且/ 返回/ 相应/ 的/ 认证/ 值/ VS1/ ./ 由于/ 用户/ 将/ 对/ 认证/ 值/ VS1/ 进行/ 验证/ ,/ 那么/ 服务器/ 猜测/ 的/ 认证/ 值/ VS1/ 将/ 以/ n/ -/ 1/ 户/ 将/ 拒绝/ 协议/ 运行/ ./ 因此/ 恶意/ 服务器/ 破坏/ 协议/ 中/ 用户/ 匿名性/ 的/ 优势/ 至多/ 为/ 1/ // n/ ./ 4/ 性能/ 分析/ 本/ 节/ 给出/ 本文/ 提出/ 的/ 协议/ 与/ 已有/ 的/ 匿名/ GPAKE/ 协议/ 在/ 计算/ 效率/ 和/ 安全性/ 方面/ 的/ 比较/ ./ 我们/ 分别/ 用/ AIP/ 协议/ 和/ WMC/ 协议/ 来/ 表示/ 文献/ [/ 5/ ]/ 和/ 文献/ [/ 10/ ]/ 中/ 的/ 协议/ ./ 假设/ 系统/ 中/ 总共/ 有/ n/ 个/ 用户/ ./ 在/ 计算/ 复杂性/ 方面/ ,/ 只/ 考虑/ 模/ 指数/ 运算/ 而/ 忽略/ 其余/ 的/ 运算/ (/ 如/ 哈希/ 函数/ 、/ 模乘/ 等/ 运算/ )/ ,/ 用/ edh/ 表示/ Diffie/ -/ Hellman/ 模/ 指数/ 运算/ ,/ 用/ ersa/ 表示/ RSA/ 的/ 模/ 指数/ 运算/ ./ 一般/ 认为/ 在/ 相同/ 的/ 参数/ 规模/ 下/ ,/ 这/ 两种/ 模/ 指数/ 运算/ 具有/ 近似/ 的/ 计算/ 代价/ ./ 在/ 通信/ 复杂性/ 方面/ ,/ 从/ 协议/ 的/ 通信/ 轮数/ 来/ 比较/ ./ 在/ 安全性/ 方面/ ,/ 主要/ 从/ 是否/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 、/ 匿名性/ 的/ 强弱/ 、/ 是否/ 实现/ 双向/ 认证/ 以及/ 安全性/ 证明/ 基于/ 的/ 困难性/ 假设/ 几/ 方面/ 进行/ 衡量/ ./ 用/ UODA/ 表示/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 用/ PCDDH/ 表示/ 基于/ 口令/ 的/ 选择/ 基/ 判定/ 性/ DDH/ 假设/ [/ 5/ ]/ ,/ 用/ RSA/ 表示/ RSA/ 假设/ ./ AGPAKE/ 协议/ 效率/ 和/ 安全性/ 比较/ 的/ 结果/ 见表/ 1/ 和表/ 2/ ./ Page9/ 比较/ 的/ 协议/ 计算/ 复杂度/ AIP/ 协议/ [/ 5/ ]/ 4edh3edh3nedh4WMC/ 协议/ [/ 10/ ]/ 4ersa2ersa2nersa8AGPAKE/ 协议/ 4edh2edh/ (/ n/ +/ 1/ )/ edh6/ 比较/ 的/ 协议/ UODA/ 匿名性/ 双向/ 认证/ 困难性/ 假设/ AIP/ 协议/ [/ 5/ ]/ 否弱否/ DDH/ ,/ PCDDHWMC/ 协议/ [/ 10/ ]/ 是/ 弱/ 是/ RSAAGPAKE/ 协议/ 是/ 强/ 是/ DDH/ 从/ 上面/ 的/ 比较/ 可以/ 看出/ ,/ 在/ 计算/ 代价/ 方面/ ,/ AGPAKE/ 协议/ 在/ 用户端/ 和/ 网关/ 端的/ 计算/ 量/ 和/ 已有/ 协议/ 大致相同/ ,/ 但是/ 在/ 服务器端/ AGPAKE/ 协议/ 只/ 需要/ n/ +/ 1/ 个/ 指数/ 运算/ ,/ 远/ 少于/ AIP/ 协议/ 和/ WMC/ 协议/ 中/ 所/ 需要/ 的/ 指数/ 运算/ ./ 通常/ 在/ 服务器进行/ 注册/ 的/ 用户/ 个数/ n/ 都/ 比较/ 大/ ,/ 因此/ AGPAKE/ 协议/ 的/ 计算/ 效率/ 与/ 已有/ 的/ 匿名/ GPAKE/ 协议/ 相比/ 具有/ 明显/ 的/ 优势/ ./ 在/ 通信/ 轮数/ 方面/ AGPAKE/ 协议/ 比/ WMC/ 协议/ 少/ 两轮/ ./ 但/ 比/ AIP/ 协议/ 多/ 了/ 两轮/ ./ 在/ 安全性/ 方面/ ,/ AGPAKE/ 协议/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 、/ 实现/ 了/ 双向/ 认证/ 并且/ 具有/ 强/ 匿名性/ ,/ 具有/ 最强/ 的/ 安全性/ ./ AIP/ 协议/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 并且/ 匿名性/ 较弱/ ,/ 如果/ AIP/ 协议/ 想要/ 达到/ 与/ AGPAKE/ 协议/ 相同/ 的/ 安全性/ ,/ 至少/ 还/ 需要/ 增加/ 两轮/ 通信/ ./ 最后/ ,/ AGPAKE/ 协议/ 还有/ 一个/ 优势/ ,/ 即/ 安全性/ 基于/ 标准/ 的/ DDH/ 假设/ ,/ 而/ AIP/ 协议/ 还/ 需要/ 用到/ 非标准/ 的/ PCDDH/ 假设/ ./ 5/ 结语/ 本文/ 研究/ 如何/ 设计/ 具有/ 强/ 匿名性/ 、/ 安全/ 高效/ 的/ GPAKE/ 协议/ ./ 利用/ 匿名/ 认证/ 协议/ 的/ 思想/ ,/ 基于/ Dif/ -/ fie/ -/ Hellman/ 密钥/ 交换/ 设计/ 了/ 一个/ 具有/ 强/ 匿名性/ 、/ 安全/ 高效/ 的/ GPAKE/ 协议/ ./ 与/ 已有/ 协议/ 相比/ ,/ 新/ 协议/ 可以/ 实现/ 用户/ 身份/ 对/ 恶意/ 敌手/ 、/ 网关/ 和/ 服务器/ 的/ 强/ 匿名/ 保护/ ,/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 并且/ 实现/ 了/ 双向/ 认证/ ,/ 因此/ 具有/ 更强/ 的/ 安全性/ ;/ 此外/ ,/ 新/ 协议/ 在/ 相同/ 通信/ 效率/ 的/ 条件/ 下/ ,/ 在/ 计算/ 效率/ 方面/ 具有/ 明显/ 的/ 优势/ ./ 

