Page1/ 基于/ 概率/ SLCA/ 的/ XML/ 过滤/ 张晨静/ 1/ )/ 王晓玲/ 2/ )/ ,/ 3/ )/ 周傲/ 英/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 上海/ 海洋大学/ 信息/ 学院/ 上海/ 201306/ )/ 2/ )/ (/ 华东师范大学/ 软件/ 学院/ 上海/ 200062/ )/ 3/ )/ (/ 复旦大学/ 上海市/ 智能/ 信息处理/ 实验室/ 上海/ 200433/ )/ 摘要/ 不/ 确定/ 数据管理/ 逐渐/ 成为/ 一个/ 重要/ 的/ 研究/ 方向/ ./ 作为/ 网络/ 交换/ 重要/ 标准/ 的/ XML/ 数据/ 的/ 不/ 确定/ 管理/ 也/ 成为/ 一个/ 研究/ 热点/ ./ 基于/ 关键字/ 的/ 概率/ XML/ 检索/ 是/ 其中/ 一个/ 重要/ 的/ 分支/ ./ 目前/ 对于/ 概率/ XML/ 关键字/ 检索/ 的/ 研究/ ,/ 都/ 只/ 考察/ 了/ 结点/ 之间/ 的/ 独立/ (/ IND/ )/ 关系/ 和/ 互斥/ (/ MUX/ )/ 关系/ ./ 由于/ 更/ 普遍/ 的/ 结点/ 依赖/ 关系/ 在/ 表述/ 和/ 计算/ 上/ 的/ 复杂性/ ,/ 较/ 少有/ 工作/ 讨论/ ./ 文中/ 讨论/ 概率/ XML/ 模型/ PrXML/ {/ exp/ ,/ ind/ ,/ mux/ }/ 中/ 基于/ SLCA/ 语义/ 的/ 关键字/ 过滤/ ./ 这种/ 模型/ 中/ 通过/ EXP/ 结点/ 描述/ 更/ 普遍/ 的/ 结点/ 依赖/ 关系/ ./ 文中/ 在/ 定义/ 了/ 子树中/ 关键字/ 概率分布/ 表/ tab/ 及其/ 相关/ 的/ 运算/ 后/ ,/ 分别/ 给出/ 了/ 模型/ 中/ 不同/ 类型/ 结点/ 关键字/ 概率分布/ 表/ 的/ 计算方法/ ,/ 并/ 给出/ 了/ 不/ 需要/ 构造/ 可能/ 世界/ 直接/ 求解/ SLCA/ 结点/ 概率/ 的/ 算法/ ./ 文章/ 通过/ 实验/ 评估/ 了/ 算法/ 的/ 特性/ 和/ 性能/ ./ 关键词/ 不/ 确定/ 数据/ ;/ 概率/ XML/ ;/ 关键字/ 过滤/ ;/ SLCA/ ;/ 关键字/ 概率分布/ 表/ 1/ 引言/ 不/ 确定/ 数据/ 在/ 众多/ 数据处理/ 应用/ 中/ 出现/ ,/ 不/ 确定/ 数据管理/ 成为/ 一个/ 重要/ 的/ 研究/ 方向/ ./ 有/ 很多/ 因素/ 导致/ 数据/ 的/ 不确定性/ ,/ 例如/ 由于/ 监测/ 设备/ 的/ 局限/ ,/ 传感器/ 数据/ 本身/ 具有/ 不确定性/ ;/ 由于/ 人/ 的/ 主观因素/ ,/ 医疗/ 数据/ 本身/ 存在/ 的/ 不确定性/ ;/ 不同/ 来源/ 的/ 数据/ 存在/ 冲突/ 或者/ 不/ 一致/ ,/ 导致/ 数据/ 的/ 不确定性/ ;/ 使用/ 爬虫/ 从/ 网络/ 自动/ 提取/ 数据/ 时/ 或者/ 在/ 数据挖掘/ 系统/ 中/ 出现/ 的/ 数据/ 不确定性/ ./ 在/ 这些/ 不/ 确定/ 数据/ 中/ ,/ 很多/ 时候/ 数据/ 来源/ 本身/ 具有/ 树形/ 结构/ ,/ 或者/ 可以/ 使用/ 父子关系/ 描述/ 数据/ 间/ 的/ 依赖/ 关系/ ./ 这些/ 应用/ 中/ 的/ 不/ 确定/ 数据/ 的/ 管理/ 可以/ 归属于/ 概率/ XML/ 数据管理/ ./ 目前/ ,/ 概率/ XML/ 数据管理/ 的/ 研究/ 主要/ 集中/ 在/ 不/ 确定/ 模型/ 的/ 研究/ 和/ 数据检索/ 等/ 方面/ ./ 关于/ 概率/ XML/ 模型/ 的/ 研究/ 工作/ ,/ 主要/ 有/ 文献/ [/ 1/ -/ 7/ ]/ ./ 目前/ 有/ 几种/ 概率/ XML/ 数据模型/ 的/ 表示/ 方法/ ./ 例如/ 文献/ [/ 5/ ]/ 给出/ 了/ 使用/ 不同/ 符号/ 表示/ 的/ 3/ 种/ 标签/ (/ tag/ )/ ,/ 分别/ 是/ 概率/ 值/ tag/ 、/ 与/ 概率/ 值/ 对应/ 的/ 数据/ 值/ tag/ 、/ 普通/ tag/ ./ 但是/ 文献/ [/ 5/ ]/ 没有/ 给出/ 数据/ 具体/ 表示/ 形式/ 的/ 示例/ ,/ 而且/ 其中/ 只/ 考虑/ 了/ 互斥/ 关系/ 的/ 概率分布/ ./ 文献/ [/ 3/ ]/ 使用/ 有/ 向/ 无/ 环图/ 描述/ 概率/ XML/ ,/ 使用/ 六元/ 组/ (/ probabilisticinstance/ )/ 来/ 表示/ 半/ 结构化/ 实例/ 中/ 对象/ 的/ 信息/ 以及/ 对应/ 概率/ ,/ 用/ 孩子/ 结点/ 集合/ 来/ 描述/ 孩子/ 结点/ 之间/ 的/ 依赖/ 关系/ ./ 文献/ [/ 6/ ]/ 使用/ “/ 模糊/ 树/ ”/ 描述/ 概率/ XML/ ,/ 树中/ 的/ 每个/ 结点/ 与/ 一组/ 概率/ 事件/ 变量/ 的/ 联合/ 有关/ ./ 一个/ 概率/ XML/ 文档/ 记作/ p/ -/ document/ ,/ 其中/ 包含/ 两种/ 结点/ :/ distributional/ 结点/ 和/ ordinary/ 结点/ (/ ORD/ 结点/ )/ ./ ordinary/ 结点/ 来自/ 源/ XML/ 文档/ 的/ 结点/ ,/ distributional/ 结点/ 用来/ 表示/ 源/ XML/ 文档/ 中/ 兄弟/ 结点/ 之间/ 的/ 关系/ ./ distributional/ 结点/ 有/ 5/ 种/ 类型/ :/ IND/ ,/ MUX/ ,/ DET/ ,/ EXP/ 和/ CIE/ ./ 两/ 方面/ 特征/ 进行/ 区分/ [/ 8/ ]/ :/ 概率/ XML/ 文档/ p/ -/ documents/ 模型/ ,/ 主要/ 通过/ (/ 1/ )/ 概率/ XML/ 文档/ p/ -/ documents/ 中/ 使用/ 的/ (/ 2/ )/ 是否/ 直接/ 在/ distributional/ 结点/ 之间/ 构建/ distributional/ 结点/ 的/ 类型/ ./ 层次/ ./ 文献/ [/ 8/ ]/ 定义/ 了/ distributional/ 结点/ 之间/ 不/ 存在/ 直接/ 层次/ 的/ 文档/ 类型/ distributional/ -/ hierarchy/ -/ free/ (/ DHF/ )/ :/ 每/ 一个/ distributional/ 结点/ 只有/ ordinary/ 类型/ 的/ 孩子/ 结点/ 的/ 数据模型/ ./ 例如/ ,/ 给定/ 概率/ XML/ 数据模型/ PrXML/ {/ ind/ ,/ mux/ }/ 指/ 的/ 是/ 只/ 包含/ “/ IND/ ”/ 和/ “/ MUX/ ”/ 类型/ 的/ distributional/ 结点/ ./ 而/ PrXML/ {/ ind/ ,/ mux/ }/ 仅/ 包含/ “/ IND/ ”/ 和/ “/ MUX/ ”/ 类型/ 的/ distributional/ 结点/ 并且/ distributional/ 结点/ 只有/ ordinary/ 类型/ 的/ 孩子/ 结点/ 的/ 数据模型/ ./ 很多/ 地方/ 直接/ 根据/ 包含/ distributional/ 结点/ 的/ 类型/ 进行/ 数据模型/ 的/ 分类/ ./ 文献/ [/ 7/ ]/ 根据/ distributional/ 结点/ 的/ 类型/ 将/ p/ -/ document/ 的/ 家族/ 定义/ 为/ PrXMLC/ ,/ C/ / {/ IND/ ,/ MUX/ ,/ DET/ ,/ EXP/ ,/ CIE/ }/ ./ 关于/ 概率/ XML/ 数据检索/ ,/ 文献/ [/ 8/ -/ 12/ ]/ 进行/ 了/ 结构化/ 查询/ 的/ 研究/ ./ 相比/ 结构化/ 查询/ ,/ 关键字/ 检索/ 更/ 容易/ 被/ 用户/ 接受/ ./ 概率/ XML/ 关键字/ 检索/ 方面/ 的/ 研究/ 有/ 文献/ [/ 13/ -/ 16/ ]/ 等/ ./ 从/ XML/ 关键字/ 语义/ 的/ 角度看/ ,/ 文献/ [/ 13/ ]/ 讨论/ 了/ 概率/ XML/ 中/ 基于/ ELCA/ 语义/ 的/ 关键字/ 检索/ ./ 在/ 文献/ [/ 14/ ]/ 中/ 指出/ ,/ ELCA/ 语义/ 包含/ 了/ SLCA/ 语义/ ,/ 因此/ 尽管/ ELCA/ 语义/ 会/ 有/ 更/ 丰富/ 的/ 结果/ 信息/ ,/ 而/ SLCA/ 语义/ 的/ 结果/ 更/ 精确/ ./ 文献/ [/ 15/ -/ 16/ ]/ 讨论/ 了/ 概率/ XML/ 中/ 基于/ SLCA/ 语义/ 的/ 关键字/ 检索/ ./ 文献/ [/ 15/ ]/ 采用/ 倒排/ 索引/ 的/ 方式/ 实现/ 类似/ SLCA/ 语义/ 的/ 概率/ 范围/ 关键字/ 查询/ ./ 文献/ [/ 16/ ]/ 讨论/ 了/ 数据/ 集中/ 场景/ 下/ PrXML/ {/ ind/ ,/ mux/ }/ 模型/ 中/ 基于/ SLCA/ 语义/ 的/ 关键字/ 查询/ ./ 然而/ 文献/ [/ 15/ -/ 16/ ]/ 包括/ 文献/ [/ 13/ ]/ 只/ 考察/ 了/ 概率/ XML/ 中/ 兄弟/ 结点/ 间/ 的/ 独立/ 、/ 互斥/ 依赖/ 关系/ ./ 尽管/ 在/ 文献/ [/ 2/ ]/ 中/ 提到/ ,/ 概率/ XML/ 的/ 很多/ 重要/ 应用/ 中/ 不/ 要求/ 结点/ 之间/ 的/ 任意/ 依赖/ 关系/ ./ 然而/ ,/ 还有/ 一些/ 常见/ 而且/ 有用/ 的/ 数据/ 依赖/ 值得/ 考察/ ./ 例如/ ,/ 一篇/ XML/ 文档/ 的/ 两个/ 作者/ :/ Hung/ 和/ Tommy/ 都/ 存在/ 不确定性/ ,/ 而且/ Tommy/ 出现/ 的/ 时候/ ,/ Hung/ 以/ 一定/ 概率/ 出现/ (/ 例如/ 师徒关系/ 或者/ 合作/ 关系/ )/ ./ XML/ 数据/ 之间/ 的/ 这种/ 依赖/ 关系/ 很/ 常见/ ,/ 而且/ 这种/ 数据/ 依赖/ 的/ 存在/ 对于/ 维护/ 数据/ 准确性/ 和/ 查询/ 正确性/ 都/ 很/ 有/ 价值/ ./ 本文/ 讨论/ 概率/ XML/ 环境/ 下/ ,/ 具有/ 更/ 通用/ 的/ 兄弟/ 结点/ 依赖/ 关系/ 的/ 模型/ PrXML/ {/ exp/ ,/ ind/ ,/ mux/ }/ 中/ 基于/ SLCA/ (/ SmallestLowestCommonAncestor/ )/ 的/ 关键字/ 过滤/ 问题/ ,/ 给出/ 概率/ XML/ 中/ SLCA/ 结点/ 的/ 定义/ 、/ 结点/ 成为/ SLCA/ 结点/ 的/ 概率/ 计算方法/ 、/ 以及/ 结点/ 概率/ 计算/ 封闭性/ 证明/ ,/ 最后/ 通过/ 实验/ 评估/ 算法/ 的/ 效率/ ./ 2/ 问题/ 定义/ 本文/ 要/ 解决/ 的/ 问题/ 是/ 在/ 概率/ XML/ 中/ 求解/ SLCA/ 结点/ 及其/ 作为/ SLCA/ 结点/ 的/ 概率/ ./ 本节/ 将/ 给出/ 概率/ XML/ 中/ SLCA/ 结点/ 的/ 定义/ ./ 确定/ XML/ 中/ Page3SLCA/ 结点/ 的/ 语义/ 要求/ :/ 子树中/ 包含/ 全部/ 关键字/ ,/ 并且/ 子孙/ 结点/ 不/ 具备/ 前述/ 条件/ ./ 由此/ ,/ 定义/ 1/ 给出/ 概率/ XML/ 环境/ 中/ SLCA/ 结点/ 的/ 语义/ ./ 为/ SLCA/ 结点/ 要/ 满足/ 两个/ 条件/ :/ 定义/ 1/ ./ 在/ 概率/ XML/ 环境/ 中/ ,/ 一个/ 结点/ v/ 成/ (/ 1/ )/ 以/ 结点/ v/ 为根/ 结点/ 的/ 子树/ SubT/ (/ v/ )/ 的/ 可能/ 世界/ 中/ 包含/ 全部/ 关键字/ 的/ 概率/ 大于/ 常数/ C/ (/ 0/ / C/ / 1/ )/ ./ (/ 2/ )/ 任何/ 结点/ v/ 的/ 子孙/ 结点/ 不/ 满足/ 前述/ 条件/ (/ 1/ )/ ./ 以/ 结点/ v/ 为根/ 结点/ 的/ 子树/ SubT/ (/ v/ )/ 的/ 可能/ 世界/ 中/ 包含/ 全部/ 关键字/ 的/ 概率/ 就是/ 结点/ v/ 作为/ SLCA/ 结点/ 的/ 概率/ ,/ 它/ 包括/ 两/ 部分/ :/ 结点/ v/ 存在/ 的/ 概率/ Pr/ (/ pathr/ →/ v/ )/ (/ r/ 表示/ XML/ 文档/ 的/ 根/ 结点/ ,/ 结点/ 存在/ 的/ 概率/ 与/ 从/ 根/ 结点/ 到/ 当前/ 结点/ 的/ 路径/ 上/ 所有/ 结点/ 的/ 概率/ 都/ 有关/ )/ ;/ 子树/ SubT/ (/ v/ )/ 中/ 包含/ 所有/ 关键字/ 的/ 概率/ Prlocal/ (/ v/ )/ ./ 这个/ 概率/ 可以/ 用式/ (/ 1/ )/ 来/ 表示/ ./ 因此/ ,/ 求解/ SLCA/ 结点/ 及其/ 成为/ SLCA/ 结点/ 的/ 概率/ 存在/ 两个/ 主要/ 的/ 挑战/ :/ (/ 1/ )/ 如何/ 计算/ 当前/ 结点/ v/ 的/ 存在/ 概率/ ./ (/ 2/ )/ 如何/ 计算/ 当前/ 结点/ v/ 为根/ 结点/ 的/ 子树/ SubT/ (/ v/ )/ 中/ 包含/ 全部/ 关键字/ 的/ 概率/ ./ 为了/ 解决/ 第/ 1/ 个/ 挑战/ :/ 结点/ v/ 的/ 存在/ 概率/ ,/ 需要/ 得到/ 从根/ 结点/ 到/ 当前/ 结点/ 路径/ 上/ 的/ 所有/ 结点/ 的/ 条件/ 概率/ ./ 以往/ 工作/ 中/ ,/ p/ -/ document/ 中仅/ 包含/ ORD/ 、/ IND/ 、/ MUX/ 结点/ 的/ 情况/ 下/ ,/ 所有/ 结点/ 的/ 条件/ 概率/ 是/ 已知/ 的/ ,/ 但是/ 在/ 包含/ EXP/ 结点/ 的/ 情况/ 下/ ,/ EXP/ 结点/ 的/ 孩子/ 结点/ 以/ 集合/ 概率/ 的/ 形式/ 存在/ ,/ 没有/ 单独/ 的/ 条件/ 概率/ ./ 3.3/ ./ 1/ 小节/ 将/ 讨论/ EXP/ 结点/ 对/ 当前/ 结点/ v/ 存在/ 概率/ 的/ 影响/ ,/ 并/ 给出/ 结点/ v/ 存在/ 概率/ 的/ 计算方法/ ./ 为了/ 解决/ 第/ 2/ 个/ 挑战/ :/ 结/ 点子/ 树中/ 包含/ 全部/ 关键字/ 的/ 概率/ ,/ 本文/ 设计/ 了/ 基于/ stack/ 的/ 自/ 底向上/ 的/ 方法/ ,/ 利用/ 下层/ 结点/ 中/ 关键字/ 分布/ 情况/ 的/ 概率/ 表/ 计算/ 上层/ 结点/ 的/ 关键字/ 概率分布/ 表/ ./ 为此/ ,/ 3.2/ 节/ 定义/ 了/ 结点/ v/ 为根/ 结点/ 的/ 子树/ SubT/ (/ v/ )/ 中/ 关键字/ 分布/ 概率/ 表/ tab/ ,/ 定义/ tab/ 上/ 的/ ·/ 、/ +/ 、/ ×/ 运算/ ,/ 给出/ 了/ 不同/ 类型/ 结点/ 概率分布/ 表/ 的/ 计算方法/ ,/ 并/ 证明/ 了/ 这些/ 计算/ 的/ 封闭性/ ./ 本节/ 给出/ 了/ 本文/ 要/ 解决/ 的/ 主要/ 问题/ ,/ 以及/ 存在/ 的/ 挑战/ ./ 下/ 一节/ 给出/ 这些/ 问题/ 的/ 解决方案/ ./ 3/ 解决方案/ 上/ 一节/ 指出/ 本文/ 要/ 解决/ 的/ 问题/ 和/ 解决/ 这个/ 问题/ 的/ 两个/ 挑战/ ./ 本节/ 首先/ 给出/ 问题/ 的/ 整体/ 解决方案/ ,/ 然后/ 详细/ 介绍/ 求解/ 过程/ 中/ 需要/ 的/ 算子/ ,/ 以及/ 如何/ 解决/ 存在/ 的/ 两个/ 挑战/ ./ 3.1/ 总体方案/ 本文/ 设计/ 了/ 自/ 底向上/ 处理/ p/ -/ document/ 的/ 方案/ ,/ 求解/ SLCA/ 并/ 计算/ SLCA/ 结点/ 的/ 概率/ ./ 具体/ 方案/ 是/ :/ 自/ 底向上/ 扫描/ 文档/ ,/ 对于/ 叶子/ 结点/ ,/ 结点/ 存在/ 概率/ 和/ 结点/ 包含/ 关键字/ 的/ 概率分布/ 都/ 能够/ 简单/ 得到/ ,/ 再/ 利用/ 式/ (/ 1/ )/ 得到/ 其/ 成为/ SLCA/ 结点/ 的/ 概率/ ;/ 对于/ 非/ 叶子/ 结点/ ,/ 根据/ 不同/ 结点/ 类型/ ,/ 结合/ 子孙/ 结点/ 包含/ 关键字/ 的/ 概率/ ,/ 利用/ 不同/ 的/ 公式/ 得到/ 当前/ 结点/ 包含/ 关键字/ 的/ 概率/ ./ 此/ 概率/ 比/ C/ 大/ ,/ 当前/ 结点/ 是/ SLCA/ 结点/ ,/ 从而/ 实现/ 定义/ 1/ 中/ 的/ 第/ (/ 1/ )/ 个/ 条件/ ;/ 在/ 自/ 底向上/ 扫描/ XML/ 文档/ 时/ ,/ 下层/ 结点/ 如果/ 是/ SLCA/ 结点/ ,/ 这一/ 信息/ 将/ 传递/ 给/ 上层/ 结点/ ,/ 阻止/ 上层/ 结点/ 成为/ SLCA/ 结点/ ,/ 保证/ 定义/ 1/ 中/ 的/ 第/ (/ 2/ )/ 个/ 条件/ ./ 由此/ ,/ 求解/ SLCA/ 并/ 计算/ SLCA/ 结点/ 概率/ ./ 结点/ 成为/ SLCA/ 结点/ 的/ 概率/ 包含/ 在/ 结点/ 关键字/ 概率分布/ 表/ tab/ 中/ ./ 在/ 整个/ 计算/ 过程/ 中/ ,/ 需要/ 求解/ 不同/ 类型/ 结点/ 的/ tab/ ./ 因此/ ,/ 下文/ 首先/ 定义/ 结点/ 关键字/ 概率分布/ 表/ tab/ ,/ 然后/ 定义/ 不同/ 类型/ 结点/ tab/ 计算/ 时/ 涉及/ 到/ 的/ tab/ 上/ 的/ 运算/ 算子/ ,/ 最后/ ,/ 给出/ 不同/ 类型/ 结点/ tab/ 的/ 计算方法/ ./ 3.2/ 算子/ 定义/ 结点/ 成为/ SLCA/ 结点/ 的/ 概率/ 包含/ 在/ 结点/ 关键字/ 概率分布/ 表中/ ./ 因此/ ,/ 需要/ 定义/ 结点/ v/ 为根/ 结点/ 的/ 子树/ SubT/ (/ v/ )/ 包含/ 关键字/ 的/ 概率分布/ 表/ tab/ ./ tab/ 的/ 构成/ 如/ 定义/ 2/ ./ 定义/ 2/ ./ tab/ 信息/ :/ 每个/ 结点/ v/ 的/ tab/ 信息/ tabv/ 见式/ (/ 2/ )/ :/ itemi/ =/ 〈/ bitvectori/ ,/ Probi/ 〉/ ,/ 0/ / Prob/ / 1/ ,/ ∑/ itabv/ 描述/ 了/ 结点/ v/ 对应/ 子树/ SubT/ (/ v/ )/ 中/ 各种/ 关键字/ 包含/ 情况/ 的/ 概率分布/ 信息/ ./ 它/ 包含/ 若干项/ ,/ 每一项/ 是/ 一个二元/ 组/ 〈/ bitvector/ ,/ Prob/ 〉/ ./ bitvector/ 中/ 的/ 每/ 一个/ 二进制位/ 代表/ 一个/ 关键字/ ,/ 记录/ 在/ 子树/ SubT/ (/ v/ )/ 中/ 出现/ 的/ 关键字/ ;/ Prob/ 表示/ 当前/ bitvector/ 表示/ 的/ 关键字/ 组合/ 在子/ 树中/ 出现/ 的/ 概率/ ./ 例如/ ,/ 查询/ 中/ 包含/ 两个/ 关键字/ ,/ 那么/ bitvector/ ∈/ {/ “/ 00/ ”/ ,/ “/ 01/ ”/ ,/ “/ 10/ ”/ ,/ “/ 11/ ”/ }/ ,/ ①/ 为了/ 区别/ 下文/ 中/ 定义/ 的/ “/ ·/ ”/ 运算符/ ,/ 本文/ 中/ 用/ “/ / ”/ 表示/ 标量/ Page4/ 在/ 计算/ 上层/ 结点/ 的/ 概率分布/ 表时/ 需要/ 将/ 当前/ 结点/ v/ 的/ 概率分布/ 表与/ 一个/ 概率/ 值/ (/ 例如/ v/ 的/ 存在/ 概率/ )/ 相乘/ ./ 定义/ 3/ 描述/ 了/ 这种/ 乘法/ ./ 定义/ 3/ ./ tab/ 信息/ 的/ 点积/ (/ ·/ )/ :/ tab/ ·/ p/ =/ {/ 〈/ Bt/ ,/ Prob/ 〉/ |/ 〈/ Bt/ ,/ Prob0/ 〉/ ∈/ tab/ ,/ 一个/ 结点/ 的/ tab/ 信息/ 与/ 一个/ 浮点数/ p/ 求点积/ ,/ 就是/ 将/ tab/ 信息/ 中/ 的/ 每个/ 项中/ 的/ 概率/ Prob/ 值/ 放大/ p/ 倍/ ,/ 每个/ 项中/ 的/ bitvector/ 不变/ ./ 引理/ 1/ ./ tab/ 上/ 的/ 点积/ 运算/ 具有/ 封闭性/ ./ 证明/ ./ 根据/ 定义/ 3/ ,/ / 〈/ Bt/ ,/ Prob/ 〉/ ∈/ tab/ ·/ p/ ,/ 有/ 〈/ Bt/ ,/ Prob0/ 〉/ ∈/ tab/ ,/ 那么/ Bt/ 来自/ tab/ ,/ 并且/ 0/ / Prob0/ / 1/ ,/ 二元/ 组中/ 的/ Bt/ 在/ 运算/ 中/ 封闭/ ./ 已知/ 0/ / p/ / 1/ ,/ Prob/ =/ Prob0/ / p/ / p/ / 1/ ,/ 因此/ 运算/ 中/ 概率/ 计算/ 也/ 封闭/ ./ 因此/ ,/ tab/ 上/ 的/ 点积/ 运算/ 封闭/ ./ 在/ 计算/ 当前/ 结点/ v/ 的/ 概率分布/ 表时/ ,/ 根据/ 结点/ v/ 的/ 孩子/ 结点/ 之间/ 的/ 依赖/ 关系/ (/ 例如/ 相互/ 排斥/ )/ ,/ 可能/ 需要/ 将/ v/ 的/ 孩子/ 结点/ 的/ tab/ 信息/ 累加/ ,/ 定义/ 4/ 给出/ tab/ 上/ 的/ 求和/ 运算/ :/ tabv/ 中/ 的/ 一个/ 项/ 〈/ “/ 01/ ”/ ,/ 0.3/ 〉/ 表示/ 在/ 子树/ SubT/ (/ v/ )/ 中/ ,/ 两个/ 关键字/ 中/ 第一个/ 关键字/ 出现/ ,/ 这种/ 仅/ 出现/ 第一个/ 关键字/ 的/ 概率/ 是/ 0.3/ ./ 定义/ 4/ ./ tab/ 信息/ 求和/ (/ +/ )/ :/ S1/ =/ {/ 〈/ Bt/ ,/ Probitemi/ +/ Probitemj/ 〉/ |/ 〈/ Bt/ ,/ Probitemi/ 〉/ ∈/ tab1/ ∧/ 〈/ Bt/ ,/ Probitemj/ 〉/ ∈/ tab2/ }/ ,/ S2/ =/ {/ 〈/ Bt/ ,/ Probitemi/ 〉/ |/ 〈/ Bt/ ,/ Probitemi/ 〉/ ∈/ tab1/ ∧/ (/ / j/ ,/ itemj/ ∈/ tab2/ ∧/ Bt/ ≠/ bitvectoritemj/ )/ }/ ,/ S3/ =/ {/ 〈/ Bt/ ,/ Probitemj/ 〉/ |/ 〈/ Bt/ ,/ Probitemj/ 〉/ ∈/ tab2/ ∧/ (/ / i/ ,/ itemi/ ∈/ tab1/ ∧/ Bt/ ≠/ bitvectoritemi/ )/ }/ (/ 4/ )/ 给定/ 两个/ 结点/ 的/ tab/ 信息/ tab1/ 和/ tab2/ ,/ tab1/ +/ tab2/ 由/ 若干项/ 组成/ :/ tab1/ 和/ tab2/ 中/ bitvector/ 值/ 相同/ 的/ 项/ 保留/ bitvector/ 值/ 并/ 将/ 概率/ 相加/ 得到/ 新/ 的/ 项/ ;/ 只/ 出现/ 在/ tab1/ 中/ 的/ bitvector/ 值/ ,/ 连同/ 其/ Prob/ 值/ 一起/ 作为/ 结果/ 集中/ 的/ 一项/ ;/ 只/ 出现/ 在/ tab2/ 中/ 的/ bitvector/ 值/ 同样/ 连同/ Prob/ 值/ 一起/ 作为/ 结果/ 集中/ 的/ 一项/ ./ 假定/ tab1/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.3/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ,/ tab2/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.1/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0.5/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ./ 那么/ tab1/ +/ tab2/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.4/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0.5/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ./ 在/ 计算/ 当前/ 结点/ v/ 的/ 概率分布/ 表时/ ,/ 根据/ 结点/ v/ 的/ 孩子/ 结点/ 之间/ 的/ 依赖/ 关系/ (/ 例如/ 相互/ 独立/ )/ ,/ 可能/ 需要/ 将/ v/ 的/ 孩子/ 结点/ tab/ 信息/ 相乘/ ./ tab/ 之间/ 的/ 乘法/ (/ 笛卡尔/ 积/ )/ 运算/ 如/ 定义/ 5/ ./ 定义/ 5/ ./ tab/ 信息/ 的/ 笛卡尔/ 积/ (/ ×/ )/ :/ tab1/ ×/ tab2/ =/ {/ itemi/ ×/ itemj/ |/ / itemi/ ∈/ tab1/ ∧/ / itemj/ ∈/ tab2/ }/ (/ 5/ )/ itemi/ ×/ itemj/ =/ {/ 〈/ newBt/ ,/ newProb/ 〉/ |/ newBt/ =/ bitvectoritemi/ |/ bitvectoritemj/ ∧/ newProb/ =/ Probitemi/ / Probitemj/ }/ 给定/ 两个/ 结点/ 的/ tab/ 信息/ tab1/ 和/ tab2/ ,/ tab1/ ×/ tab2/ 表示/ ,/ tab1/ 中/ 所有/ 的/ 项/ 和/ tab2/ 中/ 所有/ 的/ 项/ 分别/ 进行/ bitvector/ 的/ 位/ 或/ 运算/ 得到/ 新/ 的/ bitvector/ ,/ 对应/ 概率/ 相乘/ 得到/ 新/ 的/ 概率/ ./ 在/ 式/ (/ 5/ )/ 的/ 结果/ 中会/ 将/ 式/ (/ 6/ )/ 中/ 得到/ 的/ bitvector/ 相同/ 的/ 项/ 合并/ (/ 概率/ 相加/ )/ ./ 假定/ tab1/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.3/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ,/ tab2/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.1/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0.5/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ./ 那么/ tab1/ ×/ tab2/ =/ {/ 〈/ “/ 01/ ”/ ,/ 0.03/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0.15/ 〉/ ,/ 〈/ “/ 00/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0/ 〉/ }/ ./ 本文/ 的/ 算法/ 中/ ,/ 只有/ 满足/ 特定/ 关系/ tab/ 才能/ 进行/ +/ 、/ ×/ 运算/ ./ 后/ 文中/ 关于/ 父/ 结点/ 包含/ 关键字/ 概率分布/ 的/ 计算/ 中/ ,/ 会/ 证明/ 运算/ 的/ 封闭性/ ./ tab/ 上/ 的/ 多种/ 运算/ 之间/ 的/ 优先级/ 如/ 定义/ 6/ ./ 定义/ 6/ ./ 定义/ tab/ 上/ 运算符/ 的/ 优先级/ :/ +/ ,/ ×/ ,/ ·/ 运算/ 优先级/ 依次/ 递增/ ./ 通过/ 运算/ 化简/ 和/ 转化/ 的/ 方法/ 可以/ 避免/ 构造/ 概率/ 文档/ 的/ 可能/ 世界/ ,/ 优化/ 运算/ ./ 为此/ 引理/ 2/ 证明/ tab/ 上/ +/ 、/ ×/ 运算/ 的/ 分配律/ ./ 引理/ 2/ ./ 任给/ tab1/ 、/ tab2/ 、/ tab3/ ,/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ =/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ ./ 证明/ ./ 假定/ 查询/ 中有/ 两个/ 关键字/ (/ 任意/ 个数/ 的/ 关键字/ 同样/ 方式/ 可以/ 证明/ )/ ,/ 那么/ bitvector/ 的/ 取值/ {/ “/ 00/ ”/ ,/ “/ 01/ ”/ ,/ “/ 10/ ”/ ,/ “/ 11/ ”/ }/ ./ 设/ 3/ 个/ tab/ 信息/ 如表/ 1/ ./ (/ “/ 00/ ”/ ,/ p1/ ,/ 0/ )/ (/ “/ 00/ ”/ ,/ p2/ ,/ 0/ )/ (/ “/ 00/ ”/ ,/ p3/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 10/ ”/ ,/ p1/ ,/ 2/ )/ (/ “/ 10/ ”/ ,/ p2/ ,/ 2/ )/ (/ “/ 10/ ”/ ,/ p3/ ,/ 2/ )/ (/ “/ 11/ ”/ ,/ p1/ ,/ 3/ )/ (/ “/ 11/ ”/ ,/ p2/ ,/ 3/ )/ (/ “/ 11/ ”/ ,/ p3/ ,/ 3/ )/ 要/ 证明/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ =/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ ,/ 只/ 需要/ 证明/ 左边/ 结果/ 集合/ 与/ 右边/ 结果/ 集合/ 的/ 项/ 完全相同/ ./ 首先/ 证明/ 任给/ 左边/ 集合/ 中/ 的/ 一项/ ,/ 在/ 右边/ 集合/ 中有/ 同/ 一项/ ./ 根据/ 定义/ 4/ 和/ 定义/ 5/ 可知/ ,/ 在/ 左/ 、/ 右/ 两边/ 结果/ 集合/ 中/ 包含/ 且/ 仅/ 包含/ 2/ #/ Keywords/ 项/ ,/ 每一项/ 的/ bitvector/ 取值/ 用/ 0/ ~/ 2/ #/ Keywords/ -/ 1/ 之间/ 的/ 数/ 对应/ 的/ 二进制/ 数/ 表示/ ./ 任取/ 一个/ bitvector/ 的/ 值/ ,/ 假定/ 取/ “/ 01/ ”/ ,/ Page5/ 考察/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ 中/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 的/ 概率/ ./ tab/ 的/ 求和/ “/ +/ ”/ 只/ 针对/ 项中/ bitvector/ 相同/ 的/ 项/ 进行/ 概率/ 的/ 算术/ 累加/ ,/ 因此/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ 中/ 的/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 中/ 的/ 概率/ 是/ tab1/ ×/ tab3/ 和/ tab2/ ×/ tab3/ 中/ 的/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 中/ 的/ 概率/ 的/ 和/ ./ 表/ 2/ 给出/ 了/ tab1/ 和/ tab3/ 进行/ ×/ 运算/ 能/ 得到/ “/ 01/ ”/ bitvector/ 值/ 的/ 组合/ ./ tab1/ (/ “/ 00/ ”/ ,/ p1/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 0/ / p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ / p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ )/ (/ “/ 00/ ”/ ,/ p3/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ / p3/ ,/ 0/ )/ 表/ 3/ 给出/ 了/ tab2/ 和/ tab3/ 进行/ ×/ 运算/ 能/ 得到/ “/ 01/ ”/ bitvector/ 值/ 的/ 组合/ ./ tab2/ (/ “/ 00/ ”/ ,/ p2/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 0/ / p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ / p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ )/ (/ “/ 00/ ”/ ,/ p3/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ / p3/ ,/ 0/ )/ 因此/ ,/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ 中/ 的/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 是/ (/ “/ 01/ ”/ ,/ p1/ ,/ 0/ / p3/ ,/ 1/ +/ p1/ ,/ 1/ / p3/ ,/ 1/ +/ p1/ ,/ 1/ / p3/ ,/ 0/ +/ p2/ ,/ 0/ / p3/ ,/ 1/ +/ p2/ ,/ 1/ / p3/ ,/ 1/ +/ p2/ ,/ 1/ / p3/ ,/ 0/ )/ ./ (/ tab1/ +/ tab2/ )/ ×/ tab3/ 中/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ ,/ 是/ 如表/ 4/ 所示/ 的/ 3/ 个/ tab/ 中/ 的/ 项/ 混合/ 运算/ 的/ 结果/ ./ tab1tab2tab3/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ (/ “/ 00/ ”/ ,/ p1/ ,/ 0/ )/ (/ “/ 00/ ”/ ,/ p2/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ (/ p1/ ,/ 0/ +/ p2/ ,/ 0/ )/ / p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ )/ (/ “/ 00/ ”/ ,/ p3/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ (/ p1/ ,/ 1/ +/ p2/ ,/ 1/ )/ / p3/ ,/ 0/ )/ (/ “/ 01/ ”/ ,/ p1/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p2/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ p3/ ,/ 1/ )/ (/ “/ 01/ ”/ ,/ (/ p1/ ,/ 1/ +/ p2/ ,/ 1/ )/ / p3/ ,/ 1/ )/ 将表/ 4/ 中/ 3/ 个/ 结果/ 相加/ ,/ 得到/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ 中/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 是/ :/ (/ “/ 01/ ”/ ,/ (/ p1/ ,/ 0/ +/ p2/ ,/ 0/ )/ / p3/ ,/ 1/ +/ (/ p1/ ,/ 1/ +/ p2/ ,/ 1/ )/ / p3/ ,/ 0/ +/ (/ p1/ ,/ 1/ +/ p2/ ,/ 1/ )/ / p3/ ,/ 1/ )/ ./ 由此可见/ ,/ 在/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ )/ 中有/ 一个/ 和/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ 中/ 的/ bitvector/ 为/ “/ 01/ ”/ 的/ 项/ 相同/ 的/ 项/ ./ 同样/ 可以/ 证明/ 等式/ 左边/ 其他/ 的/ 项/ 在/ 右边/ 都/ 有/ 相同/ 的/ 项/ 存在/ ./ 同理/ 也/ 可以/ 证明/ 右边/ 集合/ 中/ 任意/ 一项/ 在/ 左边/ 也/ 都/ 有/ 相同/ 的/ 项/ 对应/ ./ 因此/ ,/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ =/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ 在/ 含有/ 两个/ 关键字/ 时/ 成立/ ./ 同样/ 的/ 方式/ 可以/ 证明/ 在/ 任何/ 关键字/ 个数/ 情况/ 下/ ,/ tab1/ ×/ tab3/ +/ tab2/ ×/ tab3/ =/ (/ tab1/ +/ tab2/ )/ ×/ tab3/ 成立/ ./ 3.3/ 结点/ 成为/ SLCA/ 结点/ 的/ 概率/ 计算/ 上/ 一/ 小节/ 给出/ 了/ 运算/ 中/ 需要/ 的/ 算子/ ,/ 本/ 小节/ 给出/ 求解/ 结点/ 成为/ SLCA/ 结点/ 的/ 概率/ 时/ 存在/ 的/ 两个/ 挑战/ 的/ 解决/ 方法/ ./ 图/ 1/ 所示/ 是/ 模型/ PrXML/ {/ exp/ ,/ ind/ ,/ mux/ }/ 中/ 的/ 一个/ XML/ 文档/ 树/ ./ 其中/ 包含/ ordinary/ 结点/ 、/ EXP/ 结点/ 和/ MUX/ 结点/ ./ 图中/ 缺少/ IND/ 类型/ distributional/ 结点/ ./ 因为/ IND/ 结点/ 和/ ordinary/ 结点/ 的/ 处理/ 方式/ 相同/ [/ 16/ ]/ ,/ 此图/ 省略/ 了/ 这种/ 类型/ 的/ distributional/ 结点/ ./ 边上/ 的/ 数据表示/ 孩子/ 结点/ (/ 或/ 孩子/ 结点/ 集合/ )/ 在/ 父亲/ 结点/ 存在/ 时/ 的/ 条件/ 概率/ ,/ 缺省/ 条件/ 概率/ 是/ “/ 1/ ”/ ./ 图/ 1/ 中/ ,/ 结点/ “/ Paper/ ”/ 是/ ordinary/ 结点/ ,/ 其/ 孩子/ 结点/ “/ Author/ ”/ 和/ “/ Year/ ”/ 之间/ 相互/ 独立/ ,/ 即/ “/ Author/ ”/ 结点/ 的/ 存在/ 概率/ 与/ “/ Year/ ”/ 结点/ 存在/ 的/ 概率/ 无关/ ./ “/ MUX/ ”/ 结点/ 表示/ 其/ 孩子/ 结点/ 是/ 互斥/ 关系/ ,/ 即/ “/ Year/ ”/ =/ 2008/ 和/ “/ Year/ ”/ =/ 2009/ 的/ 情形/ 互斥/ ./ “/ EXP/ ”/ 结点/ 表示/ 其/ 孩子/ 结点/ “/ Tommy/ ”/ 和/ “/ Hung/ ”/ 这/ 两个/ 作者/ 之间/ 不是/ 单纯/ 的/ 独立/ 或者/ 互斥/ 关系/ ,/ 可能/ 因为/ 某种原因/ (/ 例如/ 师徒关系/ 等/ )/ 存在/ 相互依存/ 关系/ ,/ 这种/ 比较复杂/ 的/ 依赖/ 关系/ 用/ “/ EXP/ ”/ 结点/ 表示/ ,/ 用/ 结点/ 集合/ 的/ 概率/ 来/ 描述/ ./ 图中/ 的/ “/ EXP/ ”/ 结点/ 有/ 两个/ 孩子/ 结点/ ,/ 孩子/ 结点/ 集合/ 分别/ 是/ {/ Tommy/ }/ ,/ {/ Hung/ }/ 和/ {/ Tommy/ ,/ Hung/ }/ ,/ 对应/ 的/ 集合/ 概率/ 分别/ 是/ 0.3/ 、/ 0.2/ 和/ 0.5/ ./ 下面/ 用/ 如例/ 1/ 所示/ 的/ 关键字/ 查询/ 说明/ 结点/ 作为/ SLCA/ 结点/ 的/ 概率/ 计算/ 过程/ ./ 例/ 1/ ./ 关键字/ 查询/ :/ Tommy/ ,/ 2008.3/ ./ 3.1/ 结点/ 存在/ 的/ 概率/ Pr/ (/ pathr/ →/ v/ )/ p/ -/ document/ 中/ 每个/ 结点/ 都/ 是/ 概率/ 存在/ 的/ ,/ 可以/ 使用/ 贝叶斯/ 公式/ 计算/ 概率/ XML/ 文档/ 树中/ 结点/ 存在/ 的/ 概率/ ./ 结点/ 存在/ 的/ 概率/ 只/ 跟/ 从/ 根/ 结点/ 到/ 自身/ 的/ 路径/ 上/ 所有/ 结点/ 的/ 条件/ 概率/ 有关/ ./ IND/ 、/ MUX/ 类型/ 结点/ 的/ 孩子/ 结点/ 的/ 条件/ 概率/ 是/ 已知/ 的/ ./ EXP/ 结点/ ,/ 已知/ 的/ 是/ 孩子/ 结点/ 集合/ 条件/ 概率/ ,/ 不是/ 单个/ 结点/ 的/ 条件/ 概率/ ./ 因此/ ,/ 要/ 讨论/ EXP/ 结点/ 的/ 存在/ 对/ 结点/ 存在/ 概率/ 计算/ 的/ 影响/ ./ Page6EXP/ 结点/ 在/ 当前/ 结点/ 的/ 子孙/ 中/ 出现/ ./ 从根/ 结点/ 到/ 当前/ 结点/ v/ 路径/ 上/ 没有/ EXP/ 结点/ ,/ 那么/ 该/ 路径/ 上/ 所有/ 结点/ 的/ 条件/ 概率/ 都/ 是/ 已知/ 的/ ,/ 可以/ 直接/ 使用/ 路径/ 上/ 各个/ 结点/ 的/ 条件/ 概率/ 累乘/ 得到/ v/ 的/ 存在/ 概率/ ./ EXP/ 结点/ 在/ 当前/ 结点/ 的/ 祖先/ 中/ 出现/ ./ 从根/ 结点/ 到/ 当前/ 结点/ v/ 路径/ 上/ 有/ EXP/ 结点/ ,/ 那么/ EXP/ 结点/ 的/ 孩子/ 结点/ 也/ 在/ 这个/ 路径/ 上/ ,/ 要/ 先/ 根据/ 孩子/ 结点/ 集合/ 的/ 条件/ 概率/ 计算/ 每个/ 孩子/ 结点/ 的/ 条件/ 概率/ ,/ 才能/ 进一步/ 计算/ 当前/ 结点/ 存在/ 的/ 概率/ ./ 如图/ 1/ ,/ ordinary/ 结点/ “/ Author/ ”/ 存在/ 的/ 概率/ 恰好/ 等于/ 其/ 条件/ 概率/ “/ 0.7/ ”/ ./ 结点/ “/ 2008/ ”/ 存在/ 的/ 概率/ 为/ “/ 0.6/ / 1/ / 0.2/ =/ 0.12/ ”/ ./ 结点/ “/ Tommy/ ”/ 是/ EXP/ 结点/ 的/ 孩子/ 结点/ ,/ 通过/ 集合/ 概率/ 计算/ 得到/ 结点/ “/ Tommy/ ”/ 的/ 条件/ 概率/ 是/ “/ 0.3/ +/ 0.5/ =/ 0.8/ ”/ ,/ 最后/ 计算/ 得到/ 结点/ “/ Tommy/ ”/ 存在/ 的/ 概率/ 是/ “/ 0.56/ ”/ ./ 3.3/ ./ 2/ 子树中/ 包含/ 关键字/ 的/ 概率/ Prlocal/ (/ v/ )/ 概率/ XML/ 文档/ 中/ ,/ 在/ 没有/ 子孙/ 结点/ 是/ SLCA/ 的/ 情况/ 下/ ,/ 当前/ 结点/ v/ 成为/ SLCA/ 结点/ 的/ 概率/ 就是/ 子树/ SubT/ (/ v/ )/ 包含/ 所有/ 关键字/ 的/ 可能/ 世界/ 的/ 概率/ 和/ ./ 因此/ ,/ 计算/ 当前/ 结点/ v/ 包含/ 关键字/ 的/ 概率/ 要/ 用到/ 子孙/ 结点/ 包含/ 关键字/ 的/ 概率/ 信息/ ./ 本文/ 自/ 底向上/ 遍历/ 结点/ ,/ 利用/ 下层/ 结点/ 关键字/ 包含/ 情况/ 的/ 概率/ 计算/ 上层/ 结点/ 包含/ 关键字/ 的/ 概率/ ,/ 可以/ 在/ 一遍/ 扫描/ 数据/ 时/ 得到/ SLCA/ 结点/ 及其/ 作为/ SLCA/ 结点/ 的/ 概率/ ./ 要/ 从/ 孩子/ 结点/ 包含/ 关键字/ 的/ 不确定性/ 得到/ 父亲/ 结点/ 包含/ 关键字/ 的/ 不确定性/ ,/ 存在/ 两个/ 问题/ :/ (/ 1/ )/ 结点/ 需要/ 传递/ 什么/ 信息/ 给/ 父亲/ 结点/ ?/ (/ 2/ )/ 父亲/ 结点/ 如何/ 处理/ 来自/ 各个/ 孩子/ 的/ 信息/ ,/ 从而/ 得到/ 以/ 自身/ 为根/ 结点/ 的/ 子树/ 包含/ 关键字/ 的/ 概率/ 信息/ ?/ 本文/ 用/ 包含/ 多种/ 概率/ 信息/ 的/ 二元/ 组/ 〈/ prob/ ,/ tab/ 〉/ 来/ 解决/ 第/ 1/ 个/ 问题/ ./ 针对/ 第/ 2/ 个/ 问题/ ,/ 根据/ 不同/ 结点/ 类型/ ,/ 本文/ 构造/ 了/ 利用/ 孩子/ 结点/ 传递/ 来/ 的/ 信息/ 计算/ 当前/ 结点/ tab/ 信息/ 的/ 计算公式/ ./ 下面/ 给出/ 这/ 两个/ 问题/ 的/ 解决方案/ ./ 传递/ 给/ 父亲/ 结点/ 的/ 元组/ ./ 在/ 概率/ XML/ 中/ ,/ 每个/ 结点/ 传递/ 给/ 父亲/ 的/ 信息/ 是/ 一个二元/ 组/ 〈/ prob/ ,/ tab/ 〉/ ./ prob/ 是/ 孩子/ 结点/ 的/ 条件/ 概率/ ,/ tab/ 是/ 孩子/ 结点/ 对应/ 子树中/ 包含/ 关键字/ 的/ 信息/ ,/ 见/ 定义/ 2/ ./ 图/ 1/ 中/ ,/ “/ Tommy/ ”/ 是/ 叶子/ 结点/ ,/ 直接/ 包含/ 第/ 1/ 个/ 关键字/ ./ 子树/ SubT/ (/ Tommy/ )/ 包含/ 关键字/ 情况/ 的/ 概率/ tabTommy/ 如表/ 5/ 所示/ (/ 所有/ 叶子/ 结点/ 的/ tab/ 信息/ 都/ 可以/ 直接/ 得到/ )/ ./ 000/ 那么/ 结点/ “/ Tommy/ ”/ 传递/ 给/ 父亲/ 结点/ 的/ 信息/ 是/ 二元/ 组/ 〈/ 0.8/ ,/ tabTommy/ 〉/ ./ 叶子/ 结点/ “/ 2008/ ”/ 的/ tab/ 信息/ 如表/ 6/ 所示/ ./ 结点/ “/ 2008/ ”/ 传递/ 给/ 父亲/ 结点/ 的/ 信息/ 是/ 〈/ 0.2/ ,/ tab2008/ 〉/ ./ 000/ 为了/ 节省/ 存储空间/ ,/ 只/ 需要/ 记录/ tab/ 中/ Prob/ 非/ 0/ 的/ 项/ ./ 父亲/ 结点/ 对/ 孩子/ 元组/ 的/ 汇总/ ./ 任何/ 类型/ 的/ 非/ 叶子/ 结点/ 接收/ 到/ 孩子/ 结点/ 的/ 信息/ 后/ 进行/ 的/ 概率/ 计算/ 可以/ 使用/ 下述/ 步骤/ 进行/ :/ 累加/ ./ 所有/ 可能/ 世界/ 的/ 概率/ ./ (/ 1/ )/ 根据/ 孩子/ 结点/ 之间/ 的/ 关系/ ,/ 计算/ 孩子/ 结点/ (/ 2/ )/ 计算/ 各个/ 可能/ 世界/ 中/ 包含/ 关键字/ 的/ 概率/ ./ (/ 3/ )/ 将/ 所有/ 可能/ 世界/ 中/ 包含/ 关键字/ 情况/ 的/ 概率/ 以上/ 步骤/ 得到/ 的/ 就是/ 当前/ 结点/ 的/ tab/ 信息/ ,/ 然后/ 将/ 这些/ 信息/ 向/ 更/ 上/ 一级/ 传递/ ./ 为了/ 避免/ 构建/ 孩子/ 结点/ 所有/ 可能/ 世界/ ,/ 针对/ IND/ (/ 和/ ORD/ )/ 、/ MUX/ 、/ EXP/ 类型/ 结点/ 的/ 概率/ 计算/ ,/ 本文/ 通过/ 公式/ 转化/ 与/ 化简/ ,/ 在/ 不/ 构造/ 可能/ 世界/ 的/ 情况/ 下/ 计算/ 结点/ 的/ tab/ ,/ 降低/ 计算/ 的/ 时间/ 复杂度/ ./ MUX/ 结点/ ./ 任给/ 结点/ M/ 是/ MUX/ 类型/ 的/ distributional/ 结点/ ./ 设/ 它/ 有/ n/ 个/ 互斥/ 的/ 孩子/ 结点/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ ,/ 每个/ 结点/ 的/ 条件/ 概率/ 是/ Pi/ ,/ 结点/ Xi/ 存在/ 时/ 对应/ 子树/ SubT/ (/ Xi/ )/ 包含/ 关键字/ 的/ 情况/ 表记/ 作/ tabXi/ ./ 不/ 包含/ 任何/ 孩子/ 结点/ 的/ 可能/ 世界/ 的/ 概率/ 是/ Pn/ +/ 1/ =/ 1/ -/ ∑/ 1/ / i/ / n/ 是/ tabn/ +/ 1/ =/ {/ 〈/ “/ 00/ ”/ ,/ 1/ 〉/ }/ ./ 那么/ MUX/ 结点/ M/ 包含/ 关键字/ 情况/ 的/ 概率/ 表/ tabM/ 可以/ 表示/ 为式/ (/ 7/ )/ ./ 附录/ 中/ 引理/ 3/ 证明/ 了/ 式/ (/ 7/ )/ 计算/ 得到/ 的/ 概率分布/ 表/ 符合/ 定义/ 2/ 中/ 对于/ 结点/ 包含/ 关键字/ 的/ 概率分布/ 表/ 的/ 要求/ ./ 利用/ 式/ (/ 7/ )/ ,/ 单遍/ 扫描/ 孩子/ 结点/ 数据/ 就/ 可以/ 得到/ MUX/ 类型/ 结点/ 的/ tab/ 信息/ ./ 在/ 图/ 1/ 中/ ,/ 根据/ 孩子/ 结点/ “/ 2008/ ”/ 和/ “/ 2009/ ”/ 的/ tab/ 值/ ,/ 结点/ “/ MUX/ ”/ 的/ tab/ 值/ tabMUX/ 如表/ 7/ 所示/ ./ Page7000/ ./ 8EXP/ 结点/ ./ 不/ 确定/ 数据/ 的/ 概率分布/ 是/ 多/ 粒度/ 多/ 级别/ 的/ [/ 17/ -/ 18/ ]/ ,/ 概率/ XML/ 中/ 的/ 概率分布/ 也/ 是/ 一样/ ./ 给定/ 的/ IND/ 类型/ 和/ MUX/ 类型/ 结点/ 的/ 条件/ 概率/ 都/ 是/ 结点/ 级别/ 的/ 概率/ ./ 而/ EXP/ 类型/ 结点/ 给定/ 的/ 是/ 孩子/ 结点/ 集合/ 条件/ 概率/ ,/ 是/ 集合/ 级别/ 概率/ ./ 给定/ 任意/ EXP/ 结点/ E/ ,/ 每个/ 孩子/ 结点/ 的/ tab/ 值/ 已经/ 计算/ 得到/ ,/ 有/ m/ 个/ 孩子/ 结点/ 子集/ ,/ 对应/ 的/ 概率/ 分别/ 是/ Pi/ (/ 1/ / i/ / m/ )/ ./ 每个/ 孩子/ 结点/ 集合/ 中/ 的/ 结点/ 、/ 这些/ 结点/ 的/ 子孙/ 结点/ 和/ 结点/ E/ 一起/ 构成/ 一个/ SubT/ (/ E/ )/ 的/ 可能/ 世界/ ./ 假定/ 当前/ 孩子/ 结点/ 集合/ 包含/ n/ 个/ 结点/ ,/ 对应/ 的/ tab/ 值/ 分别/ 是/ tab1/ ,/ tab2/ ,/ …/ ,/ tabn/ ,/ 那么/ SubT/ (/ E/ )/ 的/ 当前/ 可能/ 世界/ 包含/ 关键字/ 情况/ 概率/ 表/ tabpw/ 用式/ (/ 8/ )/ 表示/ :/ 以图/ 1/ 中/ 结点/ “/ EXP/ ”/ 为例/ ,/ SubT/ (/ EXP/ )/ 有/ 3/ 个/ 可能/ 的/ 世界/ ,/ pw1/ =/ {/ EXP/ ,/ Tommy/ }/ ,/ pw2/ =/ {/ EXP/ ,/ Hung/ }/ ,/ pw3/ =/ {/ EXP/ ,/ Tommy/ ,/ Hung/ }/ ./ tabpw1/ =/ tabTommy/ ,/ tabpw2/ =/ tabHung/ ,/ tabpw3/ =/ tabTommy/ ×/ tabHung/ ./ 根据/ 式/ (/ 8/ )/ 计算/ 得到/ 3/ 个/ 可能/ 世界/ 的/ tab/ 值/ 分别/ 见表/ 8/ 、/ 表/ 9/ 和表/ 10.000001000/ 附录/ 中/ 引理/ 4/ 证明/ 式/ (/ 8/ )/ 中/ 涉及/ 到/ 的/ tab/ 上/ 的/ ×/ 运算/ 封闭/ ./ 根据/ 附录/ 中/ 引理/ 4/ 可知/ ,/ 式/ (/ 8/ )/ 中/ 的/ tabpw/ 符合/ 定义/ 2/ ./ 如果/ 计算/ 得到/ SubT/ (/ E/ )/ 的/ 所有/ 可能/ 世界/ 包含/ 关键字/ 情况/ 概率/ 表/ 分别/ 是/ tabpw1/ ,/ tabpw2/ ,/ …/ ,/ tabpwm/ ./ 那么/ 子树/ SubT/ (/ E/ )/ 关键字/ 包含/ 情况/ 概率/ 表用式/ (/ 9/ )/ 表示/ :/ tabE/ =/ P1/ ·/ tabpw1/ +/ P2/ ·/ tabpw2/ +/ …/ +/ Pm/ ·/ tabpwm/ ,/ 附录/ 中/ 引理/ 5/ 证明/ 了/ 式/ (/ 9/ )/ 中/ 计算/ 得到/ 的/ “/ EXP/ ”/ 结点/ 的/ 概率分布/ 表/ tabE/ 符合/ 定义/ 2/ ./ 以图/ 1/ 中/ 结点/ “/ EXP/ ”/ 为例/ ,/ 由式/ (/ 9/ )/ 可得子/ 树/ SubT/ (/ EXP/ )/ 包含/ 关键字/ 情况/ 概率/ 表/ tabEXP/ =/ 0.3/ ·/ tabpw1/ +/ 0.2/ ·/ tabpw2/ +/ 0.5/ ·/ tabpw3/ ,/ 见表/ 11.000/ ./ 2/ 实验/ 中/ ,/ EXP/ 结点/ 的/ 子集/ 信息/ 和/ 对应/ 概率/ 信息/ 也/ 作为/ 结点/ 属性/ 存储/ 在/ 文档/ 中/ ./ IND/ 结点/ 和/ ORD/ 结点/ ./ 给定/ IND/ 类型/ 或者/ ORD/ 类型/ 的/ 结点/ ,/ 有/ n/ 个/ 互相/ 独立/ 的/ 孩子/ 结点/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ ./ 所有/ 孩子/ 结点/ 的/ 联合/ 分布/ 是/ P/ (/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ )/ =/ P/ (/ X1/ )/ P/ (/ X2/ )/ …/ P/ (/ Xn/ )/ (/ 10/ )/ 由式/ (/ 10/ )/ 可以/ 得到/ 孩子/ 结点/ 所有/ 可能/ 世界/ 的/ 概率/ ,/ 共/ 2n/ 个/ ./ 每/ 一个/ 可能/ 世界/ 中/ 各种/ 关键字/ 包含/ 情况/ 概率/ 可以/ 用/ 如式/ (/ 11/ )/ 表示/ :/ P/ (/ X1/ )/ ·/ tabX1/ ×/ P/ (/ X2/ )/ ·/ tabX2/ ×/ …/ ×/ P/ (/ Xn/ )/ ·/ tabXn/ (/ 11/ )/ 结点/ Xi/ (/ 1/ / i/ / n/ )/ 存在/ 的/ 概率/ P/ (/ Xi/ =/ 1/ )/ 是/ 给定/ 的/ ,/ 那么/ 可得/ P/ (/ Xi/ =/ 0/ )/ =/ 1/ -/ P/ (/ Xi/ =/ 1/ )/ ./ 结点/ Xi/ 存在/ 时/ ,/ 对应/ 的/ 结点/ Xi/ 的/ tab/ 信息/ 已经/ 由/ Xi/ 的/ 孩子/ 结点/ 信息/ 计算/ 得到/ ./ 如果/ 结点/ Xi/ 不/ 存在/ ,/ 对应/ 的/ tab/ 信息/ tabXi/ =/ 0/ =/ {/ 〈/ “/ 00/ ”/ ,/ 1/ 〉/ ,/ 〈/ “/ 01/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 10/ ”/ ,/ 0/ 〉/ ,/ 〈/ “/ 11/ ”/ ,/ 0/ 〉/ }/ ./ 用/ tabXi/ 表示/ tabXi/ ·/ P/ (/ Xi/ )/ (/ 1/ / i/ / n/ )/ ,/ 式/ (/ 11/ )/ 转化/ 为式/ (/ 12/ )/ ./ 父亲/ 结点/ 的/ tab/ 信息/ tabIND/ ./ 然后/ ,/ 所有/ 可能/ 世界/ 的/ 结果/ 累加/ 就是/ IND/ 类型/ tabIND/ =/ ∑/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ 由/ 引理/ 2/ 可知/ ,/ 式/ (/ 13/ )/ 可以/ 转化成/ 式/ (/ 14/ )/ :/ tabIND/ =/ ∑/ X1/ 附录/ 中/ 引理/ 6/ 证明/ 了/ 式/ (/ 14/ )/ 计算/ 得到/ 的/ “/ IND/ ”/ 结点/ 的/ 概率分布/ 表/ tabIND/ 符合/ 定义/ 2/ ./ 如果/ 是/ ORD/ 类型/ 的/ 结点/ ,/ 因为/ 它/ 本身/ 可能/ 包含/ 关键字/ ,/ 上述/ 式/ (/ 14/ )/ 中要/ 增加/ ORD/ 结点/ 本身/ 包含/ 关键字/ 的/ 信息/ tabORDlocal/ ,/ 最终/ 子树/ SubT/ (/ ORD/ )/ 中/ 包含/ 关键字/ 信息/ tabORD/ 用式/ (/ 15/ )/ 计算/ ./ tabORD/ =/ tabORDlocal/ ×/ ∑/ X1/ 附录/ 中/ 引理/ 7/ 证明/ 了/ 式/ (/ 15/ )/ 计算/ 得到/ 的/ “/ ORD/ ”/ Page8/ 结点/ 的/ 概率分布/ 表/ tabORD/ 符合/ 定义/ 2/ ./ 由式/ (/ 14/ )/ 和/ (/ 15/ )/ 可以/ 看出/ ,/ 通过/ 一遍/ 扫描/ 孩子/ 结点/ 信息/ ,/ 计算/ 各/ 结点/ tab/ 信息/ 的/ 笛卡尔/ 积/ ,/ 就/ 得到/ IND/ 类型/ 或/ ORD/ 类型/ 父亲/ 结点/ 的/ tab/ 信息/ ./ 图/ 1/ 中/ 的/ 结点/ “/ Paper/ ”/ 是/ ORD/ 类型/ 结点/ ./ tabPaper/ =/ (/ 0.7/ ·/ tabAuthor/ +/ 0.3/ ·/ {/ 〈/ “/ 00/ ”/ ,/ 1/ 〉/ }/ )/ ×/ (/ 0.6/ ·/ tabYear/ +/ 0.4/ ·/ {/ 〈/ “/ 00/ ”/ ,/ 1/ 〉/ }/ )/ ./ 而/ tabAuthor/ =/ tabEXP/ ,/ tabYear/ =/ tabMUX/ ./ tabEXP/ 和/ tabMUX/ 见表/ 11/ 和表/ 7/ ./ 计算/ 得到/ tabPaper/ 见表/ 12.000/ ./ 38720.49280/ ./ 05280.0672/ 表/ 12/ 中/ “/ 11/ ”/ 对应/ 的/ 概率/ 0.0672/ 表示/ 当前/ 结点/ “/ Paper/ ”/ 子树/ SubT/ (/ Paper/ )/ 中/ 包含/ 全部/ 关键字/ 的/ 概率/ 是/ 0.0672/ ./ 结点/ “/ Paper/ ”/ 成为/ SLCA/ 结点/ 的/ 概率/ 是/ 0.0672/ ./ 本节/ 针对/ 本文/ 的/ 目标/ 和/ 挑战/ ,/ 给出/ 了/ 详细/ 的/ 解决方案/ ./ 下/ 一节/ 将会/ 给出/ 相应/ 的/ 算法/ 分析/ ./ 4/ 算法/ 上/ 一节/ 介绍/ 了/ 求解/ SLCA/ 结点/ 及其/ 概率/ 的/ 方案/ 以及/ 概率/ 计算/ 过程/ 中/ 涉及/ 到/ 的/ 运算/ 、/ 公式/ ./ 本节/ 给出/ 相应/ 的/ 算法/ 分析/ ./ 在/ SAX/ 解析/ XML/ 文档/ 时/ ,/ 为/ 每/ 一个/ XML/ 结点/ (/ ordinary/ 结点/ 和/ distributional/ 结点/ )/ 保留/ 一条/ (/ level/ ,/ id/ ,/ bt/ ,/ nProb/ ,/ type/ ,/ expInfo/ ,/ tab/ )/ 信息/ ./ level/ ,/ id/ ,/ bt/ 分别/ 表示/ 当前/ 结点/ 的/ 深度/ 、/ 结点/ ID/ 和/ 包含/ 关键字/ 的/ 信息/ ./ nProb/ 记录/ 当前/ 结点/ 在/ 父亲/ 结点/ 存在/ 时/ 的/ 条件/ 概率/ ./ type/ 记录/ 当前/ 结点/ 的/ 类型/ ,/ 可以/ 取/ 的/ 值/ 包括/ ORD/ 、/ IND/ 、/ MUX/ 、/ EXP/ 、/ SLCA/ ,/ type/ =/ “/ SLCA/ ”/ 表明/ 当前/ 结点/ 或者/ 当前/ 结点/ 子孙/ 结点/ 已经/ 是/ SLCA/ 结点/ ,/ 这个/ 信息/ 向上/ 传递/ 阻止/ 祖先/ 结点/ 成为/ SLCA/ 结点/ ./ expInfo/ 是/ 为/ EXP/ 类型/ 的/ 结点/ 记录/ 孩子/ 结点/ 子集/ 的/ 信息/ ./ tab/ 是/ 当前/ 结点/ 所在/ 子树中/ 包含/ 关键字/ 的/ 信息/ ./ 当/ XML/ 文档/ 前序/ 遍历/ 的/ 时候/ ,/ 遍历/ 到/ 的/ 所有/ 结点/ 的/ 信息/ 入栈/ ./ 当/ 子孙/ 结点/ 处理/ 结束/ ,/ 子孙/ 结点/ 的/ 信息/ 会/ 传递/ 给/ 上级/ 结点/ 来/ 更新/ 栈中/ 的/ 信息/ ,/ 一旦/ 发现/ SLCA/ 结点/ 就/ 及时/ 反馈/ ./ 文档/ 解析/ 完毕/ ,/ 所有/ 的/ 计算/ 结束/ ./ 4.1/ 算法/ 描述/ 算法/ 1/ 描述/ 了/ 文档/ 中/ SLCA/ 结点/ 及其/ 概率/ 的/ 计算/ 过程/ ./ 算法/ 1/ ./ FindSLCA/ ./ 输入/ :/ XMLtreenoden/ ,/ tabn/ 输出/ :/ trueifhasfoundSLCAnode/ ,/ falseotherwise1/ ./ found/ =/ false/ ;/ 2/ ./ IFnisleafnodeTHEN3/ ./ computetabn/ ;/ 4/ ./ IFtheprobofallkeywordsappearingintabnis5/ ./ outputnodenanditsprobability/ ;/ 6/ ./ found/ =/ true/ ;/ 7/ ./ ENDIF8/ ./ ELSE9/ ./ FOReachchildnodencDO10/ ./ IFFindSLCA/ (/ nc/ ,/ tabnc/ )/ istrueTHEN11/ ./ found/ =/ true/ ;/ 12/ ./ ENDIF13/ ./ ENDFOR14/ ./ IFfound/ =/ =/ falseTHEN15/ ./ computetabnusingallchildren/ ’/ stabtabnc16/ ./ IFtheprobofallkeywordsappearingin17/ ./ outputnodenanditsprobability/ ;/ 18/ ./ found/ =/ true/ ;/ 19/ ./ ENDIF20/ ./ ENDIF21/ ./ ENDIF22/ ./ RETURNfound/ ;/ 算法/ 1/ 中以/ 文档/ 根/ 结点/ 为/ 输入/ ,/ 递归/ 调用/ 自身/ ,/ 计算/ 文档/ 树/ 的/ SLCA/ 结点/ 及其/ 概率/ ,/ 如果/ 找到/ SLCA/ 结点/ ,/ 算法/ 返回/ true/ ,/ 否则/ 返回/ false/ ./ 算法/ 输入/ 一个/ 文档/ 树/ 结点/ ,/ 以及/ 该/ 结点/ 的/ tab/ 信息/ tabn/ (/ 作为/ 输入/ 参数/ ,/ tabn/ 此时/ 为空/ ,/ 在/ 算法/ 中会/ 被/ 赋值/ )/ ./ 算法/ 第/ 2/ 行/ 首先/ 判断/ 结点/ n/ 是否是/ 叶子/ 结点/ ,/ 如果/ 是/ 叶子/ 结点/ ,/ 可以/ 直接/ 得到/ 结点/ 的/ tab/ 信息/ tabn/ (/ 算法/ 第/ 3/ 行/ )/ ;/ 用/ tabn/ 中/ 的/ 信息/ 可以/ 判断/ 结点/ n/ 是否是/ SLCA/ 结点/ ,/ 如果/ 是/ SLCA/ 结点/ ,/ 输出/ 结点/ 信息/ 并/ 返回/ true/ ./ 如果/ 结点/ n/ 不是/ 叶子/ 结点/ (/ 算法/ 第/ 8/ 行/ )/ ,/ 对于/ 结点/ n/ 的/ 每个/ 孩子/ 结点/ nc/ ,/ 计算/ 其/ tab/ 信息/ tabnc/ (/ 算法/ 第/ 9/ 行/ )/ ./ 如果/ 任何/ 一个/ 孩子/ 结点/ nc/ 的/ 子树中/ 发现/ 了/ SLCA/ 结点/ ,/ 置/ 变量/ found/ 为/ true/ (/ 算法/ 第/ 11/ 行/ )/ ./ 如果/ 所有/ 的/ 孩子/ 子树/ 中/ 都/ 没有/ 发现/ SLCA/ 结点/ ,/ 利用/ 所有/ 孩子/ 结点/ 的/ tab/ 信息/ ,/ 并/ 根据/ 结点/ n/ 的/ 类型/ 使用/ 上/ 文中/ 提到/ 的/ 计算方法/ 计算/ 结点/ n/ 的/ tab/ 信息/ tabn/ (/ 算法/ 第/ 15/ 行/ )/ ./ 如果/ tabn/ 中/ 的/ 相关/ 概/ Page9/ 率/ 显示/ n/ 是/ SLCA/ 结点/ ,/ 输出/ 结点/ n/ 及其/ 概率/ ,/ 置/ found/ 为/ true/ (/ 算法/ 第/ 17/ ~/ 18/ 行/ )/ ./ 最终/ ,/ 算法/ 返回/ found/ 的/ 值/ (/ 算法/ 第/ 22/ 行/ )/ ./ 4.2/ 算法/ 复杂度/ 分析/ 算法/ 的/ 时间/ 复杂度/ 主要/ 与/ 文档/ 中/ 结点/ 的/ 个数/ 、/ 结点/ 的/ 类型/ 有关/ ./ 整个/ 算法/ ,/ 在/ 针对/ 概率/ XML/ 的/ 一次/ 扫描/ 中/ ,/ 对/ 不同/ 类型/ 的/ 结点/ 进行/ 处理/ ,/ 处理/ 的/ 过程/ 就是/ 结点/ 之间/ tab/ 信息/ 的/ ×/ 、/ +/ 运算/ ./ ORD/ 、/ IND/ 、/ MUX/ 类型/ 的/ 结点/ 在/ 处理过程/ 中/ 只/ 需/ 单遍/ 扫描/ ;/ EXP/ 类型/ 的/ 结点/ ,/ 因为/ 同一个/ 结点/ 会/ 出现/ 在/ 不同/ 的/ 集合/ 中/ ,/ 需要/ 访问/ 多次/ ./ 若/ 文档/ 的/ 结点/ 个数/ 是/ n/ ,/ 只/ 考察/ ORD/ 、/ IND/ 、/ MUX/ 结点/ 时/ ,/ 由于/ 算法/ 使用/ stack/ 后序/ 处理/ 概率/ 文档/ ,/ 利用/ 已/ 得到/ 的/ 下层/ 结点/ 的/ 概率/ 表/ 计算/ 上层/ 结点/ 的/ 概率/ 表/ ,/ 所以/ 可以/ 仅/ 扫描/ 一遍/ 就/ 得到/ 结果/ ./ 因此/ ,/ 算法/ 的/ 时间/ 复杂度/ 是/ Ο/ (/ n/ )/ ./ 如果/ 同时/ 考察/ EXP/ 结点/ ,/ EXP/ 结点/ 孩子/ 结点/ 的/ 个数/ 是/ m1/ 个/ ,/ EXP/ 结点/ 孩子/ 结点/ 的/ 集合/ 的/ 个数/ 是/ s/ 个/ ,/ 平均/ 每个/ 集合/ 中/ 结点/ 的/ 个数/ 是/ m2/ 个/ ./ 所以/ EXP/ 结点/ 的/ 孩子/ 结点/ 被/ 扫描/ 的/ 次数/ 是/ s/ / m2/ ,/ 算法/ 的/ 复杂度/ 是/ Ο/ (/ n/ +/ s/ / m2/ -/ m1/ )/ ./ 因此/ ,/ 在/ 文档/ 尺寸/ 固定/ 的/ 情况/ 下/ ,/ 如果/ EXP/ 类型/ 的/ 结点/ 个数/ 多/ 、/ EXP/ 类型/ 结点/ 的/ 孩子/ 集合/ 多/ 、/ 孩子/ 集合/ 中/ 的/ 结点/ 个数/ 多/ ,/ 都/ 会/ 影响/ 算法/ 的/ 时间/ 效率/ ./ 5/ 实验/ 本节/ 对/ 概率/ XML/ 中/ 基于/ SLCA/ 的/ 关键字/ 过滤/ 算法/ 进行/ 实验/ 评估/ ./ 实验/ 分别/ 对/ 算法/ 在/ 数据/ 集/ 特征/ 、/ 查询/ 特征/ 、/ 结果/ 集合/ 大小/ 等/ 方面/ 的/ 特征/ 和/ 性能/ 进行/ 考察/ ./ 实验/ 程序/ 使用/ Java/ 语言/ 编写/ ./ 使用/ 的/ 硬件/ 环境/ 是/ 双核/ 2G/ 内存/ 的/ 台式机/ ./ 实验/ 数据/ 集/ 采用/ 真实/ DBLP/ 数据/ 集/ ./ 数据/ 的/ 大小/ 包括/ 5M/ 、/ 10M/ 、/ 30M/ 、/ 50M/ 、/ 131M/ ./ 对于/ 每/ 一个/ 采用/ 的/ 数据/ 集/ ,/ 按照/ 文献/ [/ 8/ ,/ 16/ ]/ 所述/ 的/ 方法/ 产生/ 不/ 确定/ 数据/ ./ 采用/ 前序/ 遍历/ 的/ 方式/ 扫描/ 源/ 文档/ 中/ 的/ 数据/ ,/ 对于/ 每/ 一个/ 被/ 访问/ 的/ 结点/ v/ ,/ 按照/ 5/ %/ ~/ 20/ %/ 的/ 概率/ 随机/ 产生/ IND/ 、/ MUX/ 或者/ EXP/ 类型/ 的/ 结点/ 作为/ v/ 的/ 孩子/ 结点/ ./ 选择/ 一些/ 结点/ v/ 原来/ 的/ 孩子/ 结点/ 作为/ 新/ 产生/ 的/ distributional/ 结点/ 的/ 孩子/ 结点/ ,/ 并/ 赋以/ 随机/ 的/ 概率分布/ ./ 如果/ 是/ MUX/ 类型/ 的/ 结点/ ,/ 孩子/ 结点/ 的/ 概率/ 之/ 和/ 不/ 超过/ “/ 1/ ”/ ./ EXP/ 类型/ 的/ 子集合/ 的/ 概率/ 和/ 等于/ “/ 1/ ”/ ,/ 平均/ 每个/ EXP/ 结点/ 有/ 2/ 个/ 孩子/ 结点/ 子集合/ ./ 对于/ 包含/ EXP/ 结点/ 的/ 文档/ ,/ 要/ 预先/ 计算/ 孩子/ 结点/ 的/ 单/ 结点/ 概率/ 保存/ 在/ 文档/ 中/ ./ 对应/ 的/ 不/ 确定/ 数据/ 集/ 的/ 特征/ 如表/ 13/ 所示/ ./ IDsize/ // M/ #/ IND/ #/ MUX/ #/ EXP/ #/ OrdinaryS16/ ./ 24701673660130047S26/ ./ 6464348544763130047S312/ ./ 413492141730251581S413/ ./ 1921393449113251581S537/ ./ 241325424370765889S639/ ./ 4277492868728162765889S762/ ./ 2693837216601286098S865/ ./ 84684148489464151286098S9160/ ./ 0830878643003332130S10164/ ./ 05582557390556483332130S11164/ ./ 017954118729903332130S12168/ ./ 01211721246531212683332130S13173/ ./ 026181227145703332130S14177/ ./ 01762281814381756243332130S15180/ ./ 034389335629003332130/ 实验/ 中/ 的/ 查询/ 使用/ 文献/ [/ 16/ ]/ 中/ 的/ 一部分/ 查询/ ,/ 如表/ 14/ ,/ 另外/ 还/ 采用/ 了/ 文献/ [/ 19/ -/ 20/ ]/ 中/ 查询/ (/ 标记/ 为/ kN/ -/ L/ -/ H/ )/ 的/ 产生/ 方式/ ,/ 产生/ 指定/ 频率/ 的/ 随机/ 查询/ ./ 其中/ kN/ 是/ 查询/ 中/ 关键字/ 的/ 个数/ ./ L/ 和/ H/ 是/ 关键字/ 出现/ 的/ 最低/ 频率/ 和/ 最高/ 频率/ ./ 每个/ 查询/ 中/ ,/ 仅/ 有/ 一个/ 关键字/ 的/ 频率/ 取/ 到/ 最低/ 频率/ L/ ,/ 其他/ 所有/ 关键字/ 的/ 频率/ 都/ 是/ 最高/ 频率/ H/ ./ 随机/ 产生/ 一组/ 查询/ 并/ 反复/ 执行/ 5/ 遍/ ./ 以下/ 实验/ 图中/ 记录/ 的/ 是/ 每条/ 查询/ 的/ 平均/ 运行/ 时间/ ./ IDD1D2D3D4D5/ 数据/ 集/ 特征/ 的/ 影响/ ./ 本节/ 从/ 数据/ 结点/ 特征/ (/ distributional/ 结点/ 的/ 比例/ )/ 、/ 数据/ 集/ 尺寸/ 两个/ 方面/ 考察/ 数据/ 集对/ 查询/ 效率/ 的/ 影响/ ./ 为了/ 观察/ distributional/ 结点/ 数量/ 的/ 变化/ 对/ 查询/ 性能/ 的/ 影响/ ,/ 本组/ 实验/ 选用/ 的/ distributional/ 结点/ 的/ 比例/ 为/ 5/ %/ 、/ 10/ %/ 、/ 14.5/ %/ 和/ 20/ %/ ,/ 对应/ 文档/ S9/ 、/ S11/ 、/ S13/ 、/ S15/ ./ 使用/ 表/ 14/ 给出/ 的/ 5/ 个/ 查询/ ./ 对于/ 不/ 含有/ EXP/ 结点/ 的/ 文档/ ,/ 在/ 处理/ 的/ 时候/ 可以/ 采用/ 优化/ 算法/ ./ 图/ 2/ 给出/ 了/ 不同/ 查询/ 在/ 不同/ 数据/ 集上/ 分别/ 采用/ 优化/ 和/ 无/ 优化/ 算法/ 运行/ 的/ 平均/ 查询/ 时间/ ./ 数据/ 显示/ ,/ 针对/ 同一个/ 查询/ ,/ 随着/ distributional/ 结点/ 数量/ 的/ 增加/ 查询处理/ 时间/ 基本/ 成/ 线性/ 增长/ ./ 虽然/ Page10distributional/ 结点/ 的/ 处理/ 会/ 花费/ 一定/ 的/ 时间/ ,/ 但/ 这/ 并/ 不是/ 主要/ 原因/ ./ 主要/ 原因/ 在于/ 随着/ distributional/ 结点/ 比例/ 的/ 增加/ ,/ 整个/ 需要/ 处理/ 的/ 文档/ 的/ 尺寸/ 增长/ 了/ ,/ 算法/ 需要/ 处理/ 的/ 文档/ 尺寸/ 增大/ ,/ 处理/ 时间/ 增长/ ./ 经过/ 优化/ 的/ 算法/ ,/ 在/ 节省/ 存储空间/ 的/ 同时/ ,/ 避免/ 了/ 无关/ 结点/ 的/ 处理/ ,/ 从而/ 节省/ 了/ 查询处理/ 时间/ ./ 图/ 2distributional/ 结点/ 比例/ 变化/ 对/ 查询/ 效率/ 的/ 影响/ 图/ 3/ 考察/ 了/ 数据/ 尺寸/ 对于/ 平均/ 查询/ 时间/ 的/ 影响/ ./ 采用/ 数据/ S1/ ,/ S2/ ,/ …/ ,/ S10/ ,/ 随机/ 产生/ 一组/ 查询/ ,/ 查询/ 类型/ 是/ 2/ -/ 100/ -/ 100/ ./ 数据/ 表明/ 平均/ 查询/ 时间/ 与/ 数据/ 查询/ 基本/ 成/ 线性关系/ ,/ 这/ 也/ 说明/ 了/ 算法/ 的/ 时间/ 复杂度/ 主要/ 与/ 文档/ 中/ 结点/ 的/ 数目/ 有关/ ./ 查询/ 特征/ 对于/ 查询/ 效率/ 的/ 影响/ ./ 在/ 关键字/ 查询/ 实验/ 中/ ,/ 往往/ 考察/ 查询/ 关键字/ 频率/ 、/ 关键字/ 个数/ 、/ 查询/ 数量/ 对于/ 查询/ 性能/ 的/ 影响/ ./ 图/ 4/ 记录/ 了/ 不同/ 关键字/ 频率/ 的/ 查询处理/ 时间/ ./ 采用/ 的/ 文档/ 是/ S11/ 和/ S12/ ,/ 随机/ 产生/ 查询/ ,/ 类型/ 如图/ 4/ 中/ 横坐标/ 所示/ ./ 数据/ 显示/ ,/ 在/ 查询/ 关键字/ 的/ 频率/ 从/ 100/ 增长/ 到/ 10000/ 的/ 过程/ 中/ ,/ 查询处理/ 的/ 平均/ 时间/ 并/ 没有/ 太大/ 的/ 变化/ ./ 因此/ ,/ 算法/ 对于/ 查询/ 关键字/ 的/ 频率/ 不/ 敏感/ ./ 使用/ 文档/ S11/ 和/ S12/ ,/ 图/ 5/ 考察/ 了/ 算法/ 对于/ 查询/ 关键字/ 个数/ 变化/ 的/ 影响/ ./ 关键字/ 个数/ 从/ 2/ 增长/ 到/ 4/ ,/ 关键字/ 的/ 频率/ 是/ 100/ -/ 100/ ./ 数据/ 显示/ 随着/ 关键字/ 个数/ 的/ 增长/ ,/ 查询处理/ 时间/ 线性/ 变化/ ./ 无论/ 数据/ 集/ 的/ 大小/ ,/ 本文/ 的/ 算法/ 都/ 需要/ 且/ 仅/ 需要/ 扫描/ 解析/ 一遍/ 数据/ ./ 在/ 数据/ 固定/ 的/ 情况/ 下/ ,/ 图/ 6/ 考察/ 查询/ 个数/ 的/ 变化/ 对于/ 平均/ 查询/ 性能/ 的/ 影响/ ./ 使用/ 数据/ 集/ S11/ 和/ S12/ ,/ 随机/ 产生/ 查询/ ,/ 查询/ 类型/ 是/ 2/ -/ 100/ -/ 100/ ./ 图/ 6/ 显示/ ,/ 随着/ 查询/ 数量/ 的/ 增大/ ,/ 平均/ 查询/ 时间/ 逐渐/ 减少/ 并/ 趋于平稳/ ./ Page11/ 不同/ C/ 值/ 的/ 影响/ ./ 在/ 定义/ 1/ 中/ 指出/ ,/ 包含/ 全部/ 关键字/ 的/ 概率/ 要/ 大于/ 常数/ C/ ./ 本段/ 给出/ 改变/ C/ 值/ 对/ 算法/ 的/ 影响/ ./ 使用/ 数据/ 集/ S11/ 和/ S12/ ,/ 随机/ 产生/ 查询/ ,/ 查询/ 类型/ 是/ 2/ -/ 100/ -/ 100/ ./ 图/ 7/ 显示/ ,/ 不同/ C/ 值/ ,/ 查询处理/ 时间/ 有/ 毫秒/ 级/ 变化/ ,/ 总体/ 看/ C/ 的/ 变化/ 没有/ 明显/ 影响/ 平均/ 查询/ 时间/ ./ 因为/ ,/ 算法/ 中/ 所有/ 概率/ 的/ 计算/ 与/ C/ 值/ 没有/ 关系/ ,/ C/ 仅/ 与/ 结点/ 包含/ 全部/ 关键字/ 的/ 概率/ 进行/ 了/ 比较/ ,/ 断定/ 该/ 结点/ 是否是/ SLCA/ 结点/ ./ 因此/ C/ 的/ 改变/ 没有/ 明显/ 影响/ 查询处理/ 时间/ ./ 与/ 以往/ 技术/ 的/ 比较/ ./ 在/ 以上/ 实验/ 中/ ,/ 算法/ 扫描/ 一遍/ 文档/ 得到/ 需要/ 的/ SLCA/ 结点/ 及/ 概率/ ,/ 影响/ 本文/ 算法/ 时间/ 的/ 主要/ 因素/ 是/ 问题/ 的/ 规模/ ./ 在/ 4.2/ 小节/ 中/ 指出/ ,/ 设/ 文档/ 结点/ 个数/ 为/ n/ ,/ 本文/ 算法/ 使用/ stack/ 后序/ 处理/ 概率/ 文档/ ,/ 利用/ 已/ 得到/ 的/ 下层/ 结点/ 的/ 概率/ 表/ 计算/ 上层/ 结点/ 的/ 概率/ 表/ ,/ 所以/ 可以/ 仅/ 扫描/ 一遍/ 就/ 得到/ 结果/ ./ 因此/ ,/ 在/ 不/ 考虑/ EXP/ 结点/ 情况/ 下/ ,/ 算法/ 的/ 时间/ 复杂度/ 是/ O/ (/ n/ )/ ./ 同样/ ,/ 设/ 文档/ 结点/ 个数/ 为/ n/ ,/ 而/ 文献/ [/ 16/ ]/ 中/ 算法/ PrStack/ ,/ 首先/ 扫描/ 一遍/ 文档/ 得到/ 关键字/ 结点/ 列表/ (/ 包含/ 结点/ 条件/ 概率/ )/ ,/ 然后/ 通过/ 在/ 关键字/ 结点/ 间/ 进行/ Dewey/ 码/ 匹配/ 计算/ SLCA/ 结点/ ,/ 该/ 步骤/ 扫描/ 结点/ 个数/ 不少/ 于/ n/ ./ 对于/ 这些/ SLCA/ 结点/ ,/ 利用/ 下层/ 结点/ 的/ 概率/ 自/ 底向上/ 计算/ 该/ 结点/ 的/ 概率分布/ 表/ ./ 假定/ 有/ t/ 个/ 这样/ 的/ SLCA/ 结点/ ,/ 平均/ 每个/ 结/ 点子/ 树中/ 包含/ d/ 个/ 子孙/ 结点/ ,/ 那么/ 在/ 计算/ SLCA/ 结点/ 的/ 概率/ 时/ ,/ 需要/ 扫描/ 的/ 结点/ 个数/ 是/ t/ / d/ ./ 从/ 问题/ 规模/ 的/ 角度看/ ,/ 文献/ [/ 16/ ]/ 中/ 算法/ PrStack/ 复杂度/ 是/ Ο/ (/ n/ +/ t/ / d/ )/ ./ 另外/ ,/ 本文/ 除了/ 读取/ 文档/ ,/ 所有/ 的/ 计算/ 不/ 涉及/ 外存/ 访问/ ;/ 而/ 文献/ [/ 16/ ]/ 中/ 算法/ 将/ 关键字/ 结点/ 列表/ 等/ 信息/ 以/ 索引/ 形式/ 在/ 外存/ 存储/ ,/ 因此/ ,/ 除了/ 读取/ 文档/ 之外/ ,/ 计算/ 过程/ 中/ 也/ 涉及/ 外存/ 访问/ ./ 因此/ ,/ 在/ 同样/ 只/ 考虑/ IND/ ,/ MUX/ 结点/ 的/ 情况/ 下/ ,/ 本文/ 算法/ 在/ 时间/ 上/ 较/ 有/ 优势/ ./ 6/ 总结/ 本文/ 讨论/ 了/ 概率/ XML/ 模型/ PrXML/ {/ exp/ ,/ ind/ ,/ mux/ }/ 中/ 基于/ SLCA/ 的/ 关键字/ 过滤/ ./ 该/ 模型/ 中/ 不仅/ 考察/ 了/ 结点/ 间/ 的/ 独立/ (/ IND/ )/ 、/ 互斥/ (/ MUX/ )/ 关系/ ,/ 也/ 考察/ 了/ 结点/ 间/ 更/ 普遍/ 的/ 依赖/ 关系/ (/ 用/ EXP/ 结点/ 描述/ )/ ./ 文章/ 给出/ 了结/ 点子/ 树/ 包含/ 关键字/ 的/ 概率分布/ 表/ tab/ 、/ tab/ 上/ 的/ 各种/ 运算/ ,/ 并/ 证明/ 了/ 运算/ 的/ 封闭性/ ,/ 给出/ 了/ 各种类型/ 结点/ tab/ 的/ 计算方法/ ,/ 进而/ 给出/ 了/ 自/ 底向上/ 计算/ 子树/ 包含/ 关键字/ 概率/ 的/ 算法/ ,/ 从而/ 在/ 单遍/ 扫描/ 数据/ 并且/ 不/ 构造/ 可能/ 世界/ 的/ 情况/ 下/ 求解/ SLCA/ 结点/ 及其/ 成为/ SLCA/ 结点/ 的/ 概率/ ./ 实验/ 数据/ 表明/ ,/ 算法/ 在/ 数据类型/ 、/ 数据/ 尺寸/ 、/ 查询/ 数量/ 等/ 方面/ 有/ 一定/ 的/ 扩展性/ ,/ 尤其/ 对于/ 查询/ 关键字/ 的/ 频率/ 变化/ 不/ 敏感/ ,/ 适合/ 高频/ 的/ 关键字/ 过滤/ ./ 未来/ ,/ 我们/ 会/ 在/ 概率/ XML/ 模型/ 和/ 不/ 确定/ 数据检索/ 方面/ 进行/ 深入研究/ ./ 

