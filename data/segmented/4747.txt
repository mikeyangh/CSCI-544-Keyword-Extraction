Page1/ 左侧/ 带权/ 凸/ 二分/ 图/ 动态/ 权值/ 匹配/ 1/ )/ (/ 同济大学/ 软件/ 学院/ 上海/ 201804/ )/ 2/ )/ (/ 华东师范大学/ 上海市/ 高/ 可信计算/ 重点/ 实验室/ 上海/ 200062/ )/ 摘要/ 动态/ 匹配/ 问题/ 是/ 指/ 在/ 图/ 结构/ 变更/ 的/ 情况/ 下/ 求解/ 某/ 特定/ 匹配/ ,/ 包括/ 添加/ 和/ 删除/ 图中/ 顶点/ 和/ 边/ 的/ 更新/ 操作/ 以及/ 计算/ 匹配/ 信息/ 的/ 查询/ 操作/ ./ 凸/ 二分/ 图是/ 一类/ 特殊/ 二分/ 图/ ,/ 在/ 其/ 顶点/ 二/ 划分/ (/ X/ ,/ Y/ )/ 中/ ,/ Y/ 顶点/ 集/ 为/ 一个/ 全序集/ ,/ 每个/ x/ ∈/ X/ 的/ 邻点集/ 在/ Y/ 中/ 形成/ 一段/ 连续/ 区间/ ./ 已有/ 的/ 凸/ 二分/ 图/ 动态/ 基数/ 匹配/ 算法/ 不能/ 求解/ 权值/ 匹配/ ,/ 因而/ 该文/ 研究/ 左侧/ 顶点/ 带权/ 凸/ 二分/ 图中/ 动态/ 最大/ 权值/ 匹配/ 问题/ ./ 文中/ 提出/ 一种/ 问题/ 求解/ 的/ 框架/ :/ 在/ 更新/ 操作/ 中/ 维护/ 参与/ 匹配/ 的/ 顶点/ 集合/ ,/ 继而/ 在/ 查询/ 操作/ 中/ 计算/ 相应/ 的/ 匹配/ 信息/ ./ 文中/ 基于/ 交错/ 路/ 定义/ 了/ 可/ 替换/ 集/ ,/ 并/ 证明/ 可/ 通过/ 计算/ 可/ 替换/ 集来/ 维护/ 参与/ 匹配/ 的/ 顶点/ 集/ ;/ 提出/ 紧致子/ 图/ 的/ 概念/ ,/ 证明/ 可/ 替换/ 集/ 的/ 求解/ 等价/ 于/ 紧致子/ 图/ 的/ 求解/ ,/ 从而/ 将/ 传统/ 的/ 通过/ 寻找/ 交替/ 路/ 求解/ 匹配/ 的/ 方法/ 改进/ 为/ 通过/ 寻找/ 子图/ 结构/ 来/ 求解/ 匹配/ ./ 文中/ 利用/ 凸/ 二分/ 图/ 的/ 凸/ 性质/ 将/ 紧致子/ 图/ 的/ 计算/ 转化/ 为/ 查找/ 该子/ 图中/ 最大/ 或/ 最小/ y/ 顶点/ 操作/ ,/ 进而/ 结合/ 隐性/ 表征/ 技术/ 在/ 增广/ 平衡/ 二叉/ 查找/ 树/ 数据结构/ 中/ 快速/ 求解/ ,/ 继而/ 设计/ 动态/ 匹配/ 算法/ 在/ O/ (/ log2/ |/ V/ |/ )/ 平摊/ 时间/ 下/ 维护/ 更新/ 操作/ ,/ 在/ 最坏/ 线性/ 时间/ 下/ 维护/ 查询/ 操作/ ./ 较之于/ 已知/ 最好/ 的/ 解决/ 不带/ 权凸/ 二分/ 图/ 动态/ 基数/ 匹配/ 问题/ 的/ 方法/ ,/ 该文/ 提出/ 的/ 方法/ 能/ 在/ 与/ 之/ 相同/ 的/ 时间/ 复杂度/ 下/ 解决/ 难度/ 更/ 高/ 的/ 左侧/ 带权/ 问题/ ./ 关键词/ 凸/ 二分/ 图/ ;/ 动态/ 匹配/ ;/ 交错/ 路/ ;/ 紧致子/ 图/ ;/ 隐性/ 表征/ ;/ 平衡/ 二叉/ 查找/ 树/ 1/ 引言/ 二分/ 图中/ 的/ 匹配/ 问题/ [/ 1/ ]/ 是/ 一类/ 重要/ 的/ 组合/ 优化/ 和/ 图论/ 问题/ ,/ 现实生活/ 中/ 很多/ 实际/ 问题/ 可以/ 基于/ 二分/ 图/ 匹配/ 问题/ 来/ 求解/ ,/ 如/ 调度/ 和/ 指派/ 问题/ [/ 2/ ]/ 、/ 模式识别/ 和/ Web/ 服务/ 中/ 的/ 文本/ 语义/ 分析/ [/ 3/ -/ 4/ ]/ 、/ 生物/ 计算/ [/ 5/ ]/ 和/ 网络安全/ 问题/ [/ 6/ ]/ 等/ ./ 二分/ 图中/ 的/ 动态/ 匹配/ 问题/ 是/ 在/ 图/ 结构/ 动态/ 变更/ 的/ 情况/ 下/ 维护/ 某一/ 特定/ 匹配/ ./ 当图/ 结构/ 规模/ 较大/ 时/ ,/ 对于/ 图/ 的/ 不断/ 变更/ ,/ 若用/ 已有/ 的/ 静态/ 算法/ 来/ 维护/ 特定/ 匹配/ ,/ 则/ 效率/ 较/ 低/ ,/ 故需/ 相应/ 的/ 动态/ 算法/ 以/ 解决/ 这/ 类/ 问题/ ./ 二分/ 图可/ 形式化/ 描述/ 为/ 图/ G/ =/ (/ X/ ,/ Y/ ;/ E/ )/ ,/ 其中/ 顶点/ 集/ V/ =/ X/ ∪/ Y/ ,/ X/ 和/ Y/ 是/ V/ 的/ 一个/ 二/ 划分/ ,/ 边集/ E/ / X/ ×/ Y/ ./ 若/ Y/ 上/ 有/ 一/ 全序/ 序列/ ,/ 每个/ x/ ∈/ X/ 的/ 邻居/ 在/ Y/ 的/ 全序/ 序列/ 中/ 形成/ 一段/ 连续/ 区间/ ,/ 则/ 称图/ G/ 为/ 凸/ 二分/ 图/ (/ convexbipartitegraph/ )/ ;/ 对于/ 任一/ x/ ∈/ X/ ,/ 若/ (/ x/ ,/ y1/ )/ 和/ (/ x/ ,/ y2/ )/ 属于/ 边集/ E/ ,/ 其中/ y1/ 和/ y2/ 属于/ Y/ 且/ y1/ </ y2/ ,/ 则/ 对/ 每个/ y/ ∈/ Y/ 且/ y1/ </ y/ </ y2/ ,/ (/ x/ ,/ y/ )/ ∈/ E/ ./ 若/ X/ 中/ 每个/ x/ 附属/ 一权值/ ,/ 则/ 称/ G/ 为/ 左侧/ 带权/ 凸/ 二分/ 图/ ,/ 其中/ 每条/ 边/ 的/ 权值/ 等于/ 其/ x/ 端点/ 的/ 权值/ ./ 左侧/ 带权/ 凸/ 二分/ 图上/ 的/ 最大/ 权值/ 匹配/ 问题/ 对应/ 着/ 一类/ 经典/ 的/ 调度/ 问题/ [/ 2/ ]/ :/ 给定/ 任务/ 集合/ 和/ 时间/ 片/ 集合/ ,/ 其中/ 每个/ 任务/ 有/ 释放/ 时间/ 、/ 期限/ 和/ 权值/ ,/ 且/ 执行/ 时间/ 为/ 单位/ 时间/ ,/ 其/ 调度/ 目标/ 是/ 寻找/ 最大/ 权值/ 的/ 可行/ 调度/ 任务/ 子集/ ./ 凸/ 二分/ 图/ 动态/ 匹配/ 问题/ 在/ 基因/ 染色体/ 比较/ [/ 7/ ]/ 、/ 频谱/ 拍卖/ [/ 8/ ]/ 和/ 大规模/ 传感器/ 信道/ 分配/ [/ 9/ ]/ 等/ 问题/ 中/ 都/ 有/ 广泛/ 的/ 应用/ ./ 凸/ 二分/ 图上/ 静态/ 匹配/ 问题/ 的/ 研究/ 相对/ 完备/ ./ 文献/ [/ 10/ ]/ 最早/ 提出/ 凸/ 二分/ 图上/ 的/ 最大/ 基数/ 匹配/ 问题/ ,/ 并/ 给出/ 一种/ 贪心/ 算法/ :/ 按/ 递增/ 序列/ 遍历/ Y/ 集合/ ,/ 对/ 每个/ 顶点/ y/ ,/ 在/ 与其/ 相连/ 且/ 当前/ 未/ 匹配/ 的/ x/ 顶点/ 集中/ 选取/ 结束/ 期限/ 最小/ 的/ 顶点/ 与/ 之/ 相匹配/ ;/ 基于/ 快速/ 优先级/ 队列/ [/ 11/ ]/ ,/ 算法/ 可/ 在/ OY/ +/ Xloglog/ 间/ 复杂度/ 下/ 求解/ ./ 随后/ ,/ 文献/ [/ 12/ ]/ 将/ 该/ 问题/ 转换/ 成为/ 最小/ 脱机/ 问题/ [/ 13/ ]/ (/ off/ -/ lineminimumproblem/ )/ ,/ 进而/ 基于/ 并/ 查集/ [/ 14/ ]/ (/ Union/ -/ Find/ )/ 数据结构/ 在/ 接近/ 线性/ 时间/ 复杂度/ 下/ 求解/ ./ 最终/ ,/ 文献/ [/ 15/ ]/ 通过/ 将/ 图/ 划分/ 为/ 独立/ 分支/ (/ distinctcomponent/ )/ 进而/ 在/ (/ )/ 间/ 复杂度/ 下/ 求解/ 该/ 问题/ ./ 权值/ 匹配/ 问题/ 一般/ 比/ 基数/ 匹配/ 问题/ 难度/ 更高/ ./ 根据/ 边/ 的/ 权值/ 的/ 定义/ 不同/ ,/ 凸/ 二分/ 图上/ 的/ 最大/ 权值/ (/ 匹配/ 问题/ 有/ 3/ 种/ 变型/ ./ 在/ 右侧/ 带权/ 凸/ 二分/ 图中/ (/ 每个/ y/ 顶点/ 关联/ 一权值/ )/ ,/ 文献/ [/ 16/ ]/ 给出/ 一/ 贪心/ 算法/ ,/ 在/ OE/ +/ Ylog/ 权值/ 匹配/ ./ 在/ 左侧/ 带权/ 凸/ 二分/ 图中/ (/ 每个/ x/ 顶点/ 关联/ 一权值/ )/ ,/ 文献/ [/ 12/ ]/ 基于/ 拟阵/ 理论/ 给出/ 了/ 一种/ OX2/ +/ [/ 2/ ]/ 基于/ 一种/ 层次/ 数据结构/ 在/ OX/ +/ klog2/ 平摊/ 时间/ 复杂度/ 下/ 求解/ ,/ 其中/ k/ / minX/ ,/ {/ 近期/ ,/ 文献/ [/ 8/ ]/ 指出/ 在/ 普通/ 带权/ 凸/ 二分/ 图中/ (/ 每个/ 顶点/ 关联/ 一权值/ )/ ,/ 可/ 在/ OVlog2/ 下/ 求解/ 最大/ 权值/ 匹配/ ,/ 并/ 针对/ 左侧/ 带权/ 问题/ ,/ 给出/ 了/ (/ 一种/ OVlog/ 凸/ 二分/ 图/ 动态/ 匹配/ 问题/ 通过/ 更新/ 操作/ 和/ 查询/ 操作/ 维护/ 某类/ 特定/ 的/ 匹配/ ,/ 其中/ 更新/ 操作/ 包括/ 添加/ 和/ 删除/ 顶点/ 和/ 边/ ,/ 查询/ 操作/ 包括/ 查询/ 某/ 顶点/ 是否/ 已/ 匹配/ ,/ 以及/ 查询/ 某/ 已/ 匹配/ 顶点/ 的/ 相匹配/ 顶点/ ./ 在/ 此类/ 问题/ 中/ ,/ 一个/ 顶点/ 或/ 一条/ 边/ 的/ 更新/ 可能/ 会/ 导致/ 已有/ 匹配/ 中/ 所有/ 的/ 边/ 的/ 改变/ ,/ 以至于/ 维护/ 动态/ 匹配/ 的/ 难度/ Page3/ 很/ 高/ ./ 文献/ [/ 17/ ]/ 继而/ 指出/ :/ “/ 即使/ 在/ 平摊/ 时间/ ,/ 也/ 不/ 可能/ 在/ 次/ 线性/ (/ sub/ -/ linear/ )/ 时间/ 下/ 维护/ 最大/ 匹配/ 的/ 显性/ 表征/ ”/ ./ 通过/ 隐性/ 表征/ 的/ 技术/ ,/ 文献/ [/ 17/ ]/ 设计/ 了/ 一种/ 算法/ 解决/ 了/ 凸/ 二分/ 图/ 的/ 最大/ 基数/ 动态/ 匹配/ 问题/ ,/ 该/ 算法/ 基于/ 二叉/ 计算/ 树/ 数据结构/ [/ 18/ ]/ ,/ 在/ Olog2/ (/ 摊/ 时间/ 复杂度/ 下/ 维护/ 更新/ 操作/ ,/ 在/ 最坏/ 接近/ 线性/ 时间/ 复杂度/ 下/ 维护/ 查询/ 操作/ ./ 当/ 顶点/ 带权/ 时/ ,/ 不仅/ 需/ 维护/ 匹配/ 的/ 最大/ 边数/ ,/ 而且/ 还/ 需/ 考虑/ 匹配/ 权值/ 的/ 可/ 增广/ 性/ ,/ 这/ 使得/ 动态/ 维护/ 权值/ 匹配/ 有/ 更/ 高/ 的/ 难度/ ./ 本文/ 研究/ 左侧/ 带权/ 凸/ 二分/ 图中/ 最大/ 权值/ 动态/ 匹配/ 问题/ ,/ 发现/ 解决/ 该/ 问题/ 的/ 关键在于/ 维护/ 最大/ 权值/ 匹配/ 所/ 对应/ 的/ 已/ 匹配/ 顶点/ 集合/ ,/ 而/ 维护/ 该/ 集合/ 的/ 关键在于/ 计算/ 从/ 某个/ 未/ 匹配/ 的/ 顶点/ 通过/ 交错/ 路/ 可达/ 的/ 已/ 匹配/ 顶点/ 集合/ ,/ 或/ 称为/ 可/ 替换/ 集/ ./ 进一步/ 地/ ,/ 我们/ 提出/ 紧致子/ 图/ 的/ 概念/ (/ 该子/ 图/ 蕴含/ 有/ 完美/ 匹配/ )/ ,/ 并/ 证明/ 了/ 可/ 替换/ 集/ 的/ 求解/ 等价/ 于/ 紧致子/ 图/ 的/ 求解/ ,/ 同时/ 针对/ 凸/ 二分/ 图/ 结构/ 找到/ 了/ 一种/ 快速/ 求解/ 该子/ 图/ 的/ 方法/ ./ 在/ 此基础/ 之上/ 改进/ 二叉/ 计算/ 树/ 数据结构/ ,/ 结合/ 隐性/ 表征/ 设计/ 算法/ ,/ 使/ 其/ 在/ Olog2/ (/ 时间/ 复杂度/ 下/ 维护/ 查询/ 操作/ ./ 进而/ 与/ 文献/ [/ 17/ ]/ 所/ 考察/ 的/ 不/ 带权/ 问题/ 相比/ ,/ 在/ 与其/ 相同/ 的/ 时间/ 复杂度/ 下/ 解决/ 了/ 难度/ 更/ 高/ 的/ 左侧/ 带权/ 问题/ ./ 本文/ 第/ 2/ 节/ 介绍/ 基本/ 定义/ 和/ 研究/ 问题/ ;/ 第/ 3/ 节/ 界定/ 所/ 提出/ 的/ 可/ 替换/ 集和紧/ 致子/ 图/ 的/ 概念/ ,/ 证明/ 相关/ 的/ 性质/ 和/ 定理/ ,/ 并/ 给出/ 凸/ 二分/ 图中/ 快速/ 求解/ 紧致子/ 图/ 的/ 方法/ ;/ 后面/ 三节/ 设计/ 并/ 分析/ 动态/ 匹配/ 算法/ 和/ 数据结构/ ;/ 最后/ 第/ 7/ 节/ 进行/ 总结/ ./ 2/ 基本/ 定义/ 与/ 问题/ 描述/ 设/ G/ =/ (/ X/ ,/ Y/ ;/ E/ )/ 是/ 一个/ 二分/ 图/ ,/ V/ =/ X/ ∪/ Y/ ,/ X/ (/ G/ )/ =/ X/ ,/ Y/ (/ G/ )/ =/ Y/ ;/ NG/ (/ v/ )/ 表示/ 顶点/ v/ 的/ 邻集/ ;/ NG/ (/ V/ )/ 表示/ 顶点/ 集/ V/ / V/ 中/ 所有/ 顶点/ 的/ 邻集/ 的/ 并/ ;/ G/ [/ V/ ]/ 表示/ 顶点/ 集/ V/ / V/ 的/ 导出/ 子图/ ./ 匹配/ 是/ 图/ 中/ 不/ 相邻/ 的/ 边/ 组成/ 的/ 集合/ ./ 设/ M/ 是/ G/ 的/ 一个/ 匹配/ ,/ 若/ 顶点/ v/ 是/ M/ 中/ 某/ 条边/ 的/ 端点/ ,/ 则/ 称/ v/ 是/ M/ 饱和/ 的/ ,/ 或称/ M/ 饱和/ v/ ;/ 用/ X/ (/ M/ )/ 和/ Y/ (/ M/ )/ 分别/ 表示/ G/ 中/ 所有/ M/ 饱和/ 的/ x/ 顶点/ 和/ y/ 顶点/ 集合/ ./ M/ 交错/ 路/ 指其边/ 在/ E/ -/ M/ 和/ M/ 中/ 交替/ 出现/ 的/ 路/ ;/ 若/ 一条/ M/ 交错/ 路/ 的/ 起点/ 和/ 终点/ 都/ 是/ M/ 非饱和/ 的/ ,/ 则/ 称/ 其/ 为/ M/ 增广/ 路/ [/ 19/ ]/ ./ 由/ G/ 的/ 某/ 一/ 匹配/ M/ 中/ 所有/ 的/ 边/ 的/ x/ 端点/ 组成/ 的/ 集合/ 称为/ G/ 的/ 一个/ X/ 匹配/ 集/ ,/ 用/ MX/ 表示/ ./ 给定/ 二分/ 图/ G/ 的/ X/ 集合/ 上/ 的/ 一个/ 全序/ 关系/ ,/ 下面/ 定义/ G/ 的/ 最优/ X/ 匹配/ 集/ :/ 定义/ 1/ ./ 二分/ 图/ G/ 的/ 最优/ X/ 匹配/ 集是/ 指/ G/ 的/ X/ 匹配/ 集/ MX/ =/ {/ x1/ ,/ …/ ,/ xk/ }/ ,/ x1/ >/ …/ >/ xk/ ,/ 使得/ 对/ 任一/ G/ 的/ X/ 匹配/ 集/ MX/ =/ {/ x1/ ,/ …/ ,/ x/ / }/ ,/ x1/ >/ …/ >/ x/ / ,/ 满足/ 以下/ 性质/ :/ k/ / / ,/ 而且/ / i/ ∈/ [/ 1/ ,/ / ]/ ,/ xi/ / xi/ ./ 设/ G/ =/ (/ X/ ,/ Y/ ;/ E/ )/ 是/ 一个/ 左侧/ 带权/ 凸/ 二分/ 图/ ,/ G/ 中/ 每个/ y/ 顶点/ 表示/ 为/ 一个/ 唯一/ 的/ 整数/ ./ 定义/ Y/ 集合/ 上/ 一种/ 全序/ 关系/ 为/ y1/ </ y2/ ./ 对/ Y/ 集合/ 中/ 的/ 任意/ 子集/ Y/ ,/ Y/ ./ min/ 和/ Y/ ./ max/ 分别/ 表示/ Y/ 中/ 最小/ 的/ 和/ 最大/ 的/ y/ 顶点/ ./ G/ 中/ 每个/ x/ 顶点/ 用/ 一个/ 四元组/ (/ x/ ./ id/ ,/ x/ ./ s/ ,/ x/ ./ e/ ,/ x/ ./ w/ )/ 表示/ ,/ 其中/ x/ ./ id/ 为/ 一个/ 唯一/ 的/ 整数/ ,/ x/ ./ s/ 和/ x/ ./ e/ 分别/ 表示/ x/ 的/ 邻/ 集中/ 最小/ 的/ 和/ 最大/ 的/ y/ 顶点/ ,/ x/ ./ w/ 是/ 一个/ 表示/ x/ 的/ 权值/ 的/ 整数/ ./ 定义/ X/ 集合/ 上/ 的/ 3/ 种/ 全序/ 关系/ :/ 定义/ start/ -/ id/ 序列/ 为/ (/ x/ ./ s/ ,/ x/ ./ id/ )/ 的/ 字典/ 序/ ;/ 定义/ end/ -/ id/ 序列/ 为/ (/ x/ ./ e/ ,/ x/ ./ s/ ,/ x/ ./ id/ )/ 的/ 字典/ 序/ ;/ 定义/ weight/ -/ id/ 序列/ 为/ (/ x/ ./ w/ ,/ -/ x/ ./ e/ ,/ -/ x/ ./ s/ ,/ -/ x/ ./ id/ )/ 的/ 字典/ 序/ ./ 在/ 左侧/ 带权/ 凸/ 二分/ 图/ G/ 中/ ,/ 我们/ 根据/ weight/ -/ id/ 的/ 全序/ 关系/ 定义/ 最优/ X/ 匹配/ 集/ ./ 对/ G/ 的/ 任意/ x/ ∈/ X/ ,/ y/ ∈/ Y/ ,/ 若/ x/ ./ s/ / y/ / x/ ./ e/ ,/ 则/ (/ x/ ,/ y/ )/ ∈/ E/ ,/ 即/ 给定/ X/ 顶点/ 集/ 和/ Y/ 顶点/ 集/ ,/ 边集/ 可/ 由/ 顶点/ 集/ 隐性/ 表征/ ,/ 故/ 左侧/ 带权/ 凸/ 二分/ 图/ 可用/ 二元/ 组/ (/ X/ ,/ Y/ )/ 表示/ ./ 对/ 一个/ x/ 顶点/ x/ / X/ ,/ 用/ G/ +/ x/ 表示/ 左侧/ 带权/ 凸/ 二分/ 图/ G/ =/ (/ X/ ,/ Y/ )/ ,/ 其中/ X/ =/ X/ +/ x/ ,/ Y/ =/ Y/ ./ 同理/ ,/ G/ +/ y/ 表示/ 在/ G/ 中/ 加入/ 顶点/ y/ / Y/ ./ 在/ 左侧/ 带权/ 凸/ 二分/ 图/ 动态/ 匹配/ 问题/ 中/ ,/ 若/ 某/ x/ 顶点的权/ 值为/ 负/ ,/ 则/ 该/ x/ 必然/ 不/ 属于/ 任一/ 最大/ 权值/ 匹配/ ./ 因带/ 负权值/ 的/ x/ 顶点/ 容易/ 识别/ 并/ 去除/ ,/ 故/ 本文/ 假设/ x/ 权值/ 为/ 非负/ ./ 根据/ 文献/ [/ 20/ ]/ 中/ 的/ 引理/ 2/ 可/ 推出/ ,/ 在/ 权值/ 非负/ 的/ 左侧/ 带权/ 凸/ 二分/ 图中/ ,/ 任一/ 饱和/ 最优/ X/ 匹配/ 集/ 的/ 匹配/ M/ 都/ 是/ 一个/ 最大/ 权值/ 匹配/ ,/ 故/ 本文/ 动态/ 匹配/ 算法/ 在/ 更新/ 操作/ 中/ 维护/ 最优/ X/ 匹配/ 集/ ./ 算法/ 维护/ 的/ 更新/ 操作/ 包括/ :/ (/ 1/ )/ insert/ (/ x/ ^/ )/ :/ 添加/ 顶点/ x/ ^/ / X/ ,/ 对于/ Y/ 中/ 每个/ 满足/ x/ ^/ ./ s/ </ y/ </ x/ ^/ ./ e/ 的/ 顶点/ y/ ,/ y/ 与/ x/ ^/ 相连/ ./ (/ 2/ )/ insert/ (/ y/ ^/ )/ :/ 添加/ 顶点/ y/ ^/ / Y/ ,/ 对于/ X/ 中/ 任一/ 满足/ x/ ./ s/ </ y/ ^/ </ x/ ./ e/ 的/ 顶点/ x/ ,/ x/ 与/ y/ ^/ 相连/ ./ (/ 3/ )/ delete/ (/ x/ ^/ )/ :/ 删除/ 顶点/ x/ ^/ ∈/ X/ ;/ 图中/ 所有/ 与/ x/ ^/ 相连/ 的/ 边/ 隐性/ 删除/ ./ (/ 4/ )/ delete/ (/ y/ ^/ )/ :/ 删除/ 顶点/ y/ ^/ ∈/ Y/ ,/ y/ ^/ 不/ 等于/ 任一/ x/ ∈/ X/ 的/ x/ ./ s/ 或/ x/ ./ e/ ;/ 图中/ 所有/ 与/ y/ ^/ 相连/ 的/ 边/ 隐性/ 删除/ ./ 删除/ 任意/ 边/ 的/ 操作/ 将/ 破坏/ 凸/ 性质/ ,/ 因而/ 边/ 的/ 更新/ 操作/ 需/ 加以/ 限制/ ./ 通过/ 相应/ 顶点/ 的/ 更新/ 操作/ 来/ 完成/ 边/ 的/ 加入/ 或/ 删除/ ,/ 即/ 添加/ 边/ (/ x/ ,/ y/ )/ 通过/ 先/ 删除/ x/ 顶点/ ,/ 继而/ 重新加入/ 已/ 修改/ x/ ./ s/ 或/ x/ ./ e/ 的/ x/ 顶点/ 来实/ Page4/ 现/ ;/ 删除/ 边/ 的/ 操作/ 与/ 之/ 类似/ ./ 算法/ 维护/ 的/ 查询/ 操作/ 包括/ :/ (/ 1/ )/ status/ (/ v/ )/ :/ 查询/ 顶点/ v/ 的/ 匹配/ 状态/ ./ (/ 2/ )/ pair/ (/ v/ )/ :/ 查询/ 已/ 匹配/ 顶点/ v/ 的/ 相匹配/ 顶点/ ./ 3/ 紧致子/ 图/ 与/ 可/ 替换/ 集本节/ 界定/ 二分/ 图上/ 的/ 可/ 替换/ 集和紧/ 致子/ 图/ 的/ 概念/ ,/ 证明/ 其/ 性质/ 以及/ 它们/ 之间/ 的/ 关系/ ,/ 并/ 针对/ 凸/ 二分/ 图/ 结构/ 给出/ 一种/ 快速/ 求解/ 紧致子/ 图/ 的/ 方法/ ./ 3.1/ 可/ 替换/ 集在/ 二分/ 图/ G/ 中/ ,/ 当/ x/ 顶点/ x/ ^/ 不能/ 增广/ MX/ 时/ ,/ 即/ MX/ +/ x/ ^/ 不是/ G/ 的/ X/ 匹配/ 集时/ ,/ 我们/ 定义/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ 如下/ ./ 定义/ 2/ ./ 在/ 二分/ 图/ G/ =/ (/ X/ ,/ Y/ ;/ E/ )/ 中/ ,/ 对于/ X/ 匹配/ 集/ MX/ 和/ 顶点/ x/ ^/ ∈/ X/ -/ MX/ ,/ 设/ M/ 为/ 饱和/ MX/ 的/ 任一/ 匹配/ ,/ 若/ x/ ^/ 不能/ 增广/ M/ ,/ 则/ 称/ 从/ x/ ^/ 出发/ 的/ M/ 交错/ 路/ 可达/ 的/ MX/ 中/ 的/ 顶点/ 集/ R/ (/ x/ ^/ ,/ MX/ )/ 为/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ ./ 例如/ ,/ 图/ 1/ 中/ MX/ =/ {/ x1/ ,/ x2/ ,/ x4/ }/ ,/ 从/ x/ ^/ 出发/ 的/ M/ 交错/ 路/ 可达/ x1/ 和/ x2/ ,/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ R/ (/ x/ ^/ ,/ MX/ )/ =/ {/ x1/ ,/ x2/ }/ ./ 由/ 以下/ 命题/ 可知/ x/ ^/ 的/ MX/ 可/ 替换/ 集仅/ 与/ X/ 匹配/ 集/ MX/ 相关/ ,/ 与/ 具体/ 饱和/ MX/ 的/ 匹配/ 无关/ ./ 命题/ 1/ ./ 对于/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 集/ MX/ 和/ 顶点/ x/ ^/ ∈/ X/ -/ MX/ ,/ 若/ x/ ^/ 不能/ 增广/ MX/ ,/ 即/ MX/ +/ x/ ^/ 不是/ G/ 中/ X/ 匹配/ 集/ ,/ 则/ 对于/ 任一/ 饱和/ MX/ 的/ 匹配/ M/ ,/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ 相同/ ./ 证明/ ./ 设/ M1/ ,/ M2/ 为/ 饱和/ MX/ 的/ 任意/ 两个/ 匹配/ ,/ 即/ XM/ (/ )/ 1/ =/ XM/ (/ )/ 2/ =/ MX/ ./ 由/ 文献/ [/ 1/ ]/ 中/ 定理/ 1/ 可知/ 对称/ 差/ G/ =/ M1/ / M2/ 包含/ 由/ M1/ 和/ M2/ 中边/ 交替/ 出现/ 的/ 圈/ 或迹/ ./ 若/ 可/ 证明/ x/ ^/ 所有/ 的/ 邻点/ 都/ 属于/ G/ 中/ 的/ 圈/ ,/ 则/ 命题/ 可证/ ./ 任取/ x/ ^/ 的/ 邻点/ y1/ ,/ y1/ 是/ M1/ 饱和/ 且/ M2/ 饱和/ 的/ ,/ 否则/ x/ ^/ ,/ y/ (/ )/ 1/ 可/ 增广/ M1/ 或/ M2/ ,/ 与/ 前提/ 相/ 矛盾/ ./ 令/ x1/ ,/ y/ (/ x2/ ,/ 得证/ ./ 若/ x1/ ≠/ x2/ ,/ 从/ y1/ 出发/ 经过/ x1/ 的/ 路径/ 必然/ 可沿/ M1/ 和/ M2/ 中/ 的/ 边/ 交替/ 延伸/ ,/ 且/ :/ (/ 1/ )/ 中间/ 经过/ 的/ y/ 顶点/ 必然/ 是/ M1/ 饱和/ 的/ ,/ 否则/ x/ ^/ 增广/ M1/ ;/ (/ 2/ )/ 中间/ 经过/ 的/ x/ 顶点/ 必然/ 是/ M2/ 饱和/ 的/ ,/ 因为/ M2/ 饱和/ MX/ ./ 易/ 推知/ 该/ 路径/ 必然/ 最终/ 延伸/ 回到/ 顶点/ y1/ ./ 故而/ ,/ 所有/ 从/ x/ ^/ 出发/ 的/ M1/ 交错/ 路/ 可达/ 的/ x/ 顶点/ 都/ 可/ 被/ 从/ x/ ^/ 出发/ 的/ M2/ 交错/ 路/ 可达/ ./ 下面/ 两个/ 命题/ 刻画/ 了/ 不同/ X/ 匹配/ 集/ 之间/ 的/ 转换/ 关系/ 以及/ 最优/ X/ 匹配/ 集/ 的/ 性质/ ,/ 为/ 证明/ 定理/ 1/ 做/ 准备/ ./ 命题/ 2/ ./ 若/ MX/ ,/ MX/ 在/ 二分/ 图/ G/ 中是/ X/ 匹配/ 集/ ,/ 其中/ MX/ =/ s/ ,/ MX/ =/ r/ ,/ 且/ s/ >/ r/ ,/ 则/ 存在/ X/ 匹配/ 集/ MX/ ,/ 满足/ MX/ =/ s/ ,/ MX/ / MX/ ,/ 且/ MX/ -/ MX/ / MX/ -/ MX/ ./ 证明/ ./ 设/ M1/ ,/ M2/ 分别/ 为/ G/ 中/ 饱和/ MX/ ,/ MX/ 的/ 任意/ 两个/ 匹配/ ,/ 则/ 在/ M1/ / M2/ 中/ 必然/ 存在/ 至少/ s/ -/ r/ 条/ 顶点/ 不/ 相交/ 的/ M2/ 增广/ 路/ (/ 文献/ [/ 1/ ]/ 中/ 定理/ 1/ )/ ./ 故而/ M2/ 可/ 增广/ 至/ M3/ ,/ 其中/ M3/ =/ s/ ,/ XM/ (/ )/ 2/ / XM/ (/ )/ 3/ 且/ XM/ (/ )/ 3/ -/ XM/ (/ )/ 2/ / XM/ (/ )/ 1/ -/ XM/ (/ )/ 2/ ./ 证毕/ ./ 命题/ 3/ ./ 设/ MX/ 在/ 二分/ 图/ G/ 中是/ 最优/ X/ 匹配/ 集/ ,/ 则/ 对/ / x/ ∈/ X/ -/ MX/ ,/ MX/ 在/ G/ =/ G/ -/ x/ 中/ 也/ 是/ 最优/ X/ 匹配/ 集/ ./ 证明/ ./ (/ 反证法/ )/ 假设/ MX/ 不是/ G/ -/ x/ 的/ 最优/ X/ 匹配/ 集/ ,/ 令/ MX/ ≠/ MX/ 为/ 最优/ ./ 设/ MX/ =/ {/ 珚/ x1/ ,/ …/ ,/ 珚/ xm/ }/ ,/ MX/ =/ x1/ ,/ …/ ,/ xMX/ 在/ G/ 中是/ X/ 匹配/ 集/ ,/ 且/ 珚/ xi/ >/ xi/ ,/ 与/ MX/ 在/ G/ 中是/ 最优/ X/ 匹配/ 集/ 矛盾/ ./ 本文/ 的/ 动态/ 算法/ 通过/ 维护/ 最优/ X/ 匹配/ 集以/ 维护/ 最大/ 权值/ 匹配/ ,/ 以下/ 定理/ 给出/ 了/ 一种/ 通过/ 可/ 替换/ 集/ 维护/ 最优/ X/ 匹配/ 集/ 的/ 方法/ ./ 定理/ 1/ ./ 设/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 配集/ 为/ MX/ ,/ 对于/ 顶点/ x/ / X/ ,/ 若/ MX/ =/ MX/ +/ x/ 为/ G/ =/ G/ +/ x/ 的/ X/ 匹配/ 集/ ,/ 则/ MX/ 为/ G/ 的/ 最优/ X/ 匹配/ 集/ ;/ 否则/ ,/ 令/ Rx/ ,/ (/ 集/ ,/ x/ 为/ Rx/ ,/ (/ 小/ 元素/ ,/ 则/ MX/ +/ x/ -/ x/ 为/ G/ 的/ 最优/ X/ 匹配/ 集/ ./ 证明/ ./ (/ 1/ )/ 先/ 证明/ :/ 若/ MX/ =/ MX/ +/ x/ 为/ G/ =/ G/ +/ x/ 的/ X/ 匹配/ 集/ ,/ 则/ MX/ 为/ G/ 的/ 最优/ X/ 匹配/ 集/ ./ (/ 反证法/ )/ 假设/ MX/ 不是/ G/ 的/ 最优/ X/ 匹配/ 集/ ,/ 令/ MX/ ≠/ MX/ 为/ 最优/ ./ 若/ MX/ >/ MX/ ,/ 则/ MX/ -/ x/ 在/ G/ 中是/ X/ 匹配/ 集/ ,/ 且/ MX/ -/ x/ >/ |/ MX/ |/ ,/ 与/ 已知/ MX/ 在/ G/ 中是/ 最优/ X/ 匹配/ 集相/ 矛盾/ ,/ 故而/ MX/ =/ MX/ ./ 若/ x/ / MX/ ,/ 则/ MX/ 在/ G/ 中是/ X/ 匹配/ 集且/ MX/ >/ MX/ ,/ 矛盾/ ,/ 故而/ x/ ∈/ MX/ ./ 设/ MX/ =/ Page5/ 珚/ x1/ ,/ …/ ,/ 珚/ x/ {/ xm/ }/ ,/ 其中/ x1/ >/ …/ >/ xm/ ,/ 由/ MX/ 是/ G/ 的/ 最优/ X/ 匹配/ 集/ ,/ 可知/ :/ / i/ ∈/ [/ 1/ ,/ m/ ]/ ,/ 珚/ xi/ / xi/ ./ (/ 集合/ 示意/ 关系/ 参看/ 图/ 2/ )/ 令/ 珚/ xk/ =/ x/ ,/ xj/ =/ x/ ,/ 可/ 推知/ k/ / j/ ,/ 否则/ 珚/ xk/ =/ xj/ </ xk/ ,/ 与/ MX/ 最优/ 相/ 矛盾/ ./ 可/ 推知/ / i/ ∈/ [/ j/ ,/ k/ -/ 1/ ]/ ,/ 珚/ xi/ / xi/ +/ 1/ ,/ 即/ 对于/ MX/ [/ j/ ,/ k/ )/ 和/ MX/ (/ j/ ,/ k/ ]/ 中/ 的/ 相同/ 序列/ 元素/ ,/ 前者/ 不/ 小于/ 后者/ ./ 故/ 对于/ 序列/ MX/ -/ x/ =/ MX/ [/ 1/ ,/ j/ )/ +/ MX/ [/ j/ ,/ k/ )/ +/ MX/ (/ k/ ,/ m/ )/ =/ {/ 珚/ x1/ ,/ …/ ,/ 珚/ xm/ -/ 1/ }/ 以及/ 序列/ MX/ -/ x/ =/ MX/ [/ 1/ ,/ j/ )/ +/ MX/ (/ j/ ,/ k/ ]/ +/ MX/ (/ k/ ,/ m/ )/ =/ x1/ ,/ …/ ,/ xm/ [/ 1/ ,/ m/ -/ 1/ ]/ ,/ 珚/ xi/ / xi/ ,/ 这/ 与/ 已知/ MX/ 是/ G/ 中/ 最优/ X/ 匹配/ 集/ 矛盾/ ,/ 故而/ MX/ 为/ G/ 的/ 最优/ X/ 匹配/ 集/ ./ 证明/ ./ (/ 2/ )/ 若/ MX/ +/ x/ 不是/ G/ =/ G/ +/ x/ 的/ X/ 匹配/ 集/ ,/ 则/ MX/ =/ MX/ +/ x/ -/ x/ 为/ G/ 的/ 最优/ X/ 匹配/ 集/ ,/ 其中/ x/ 为/ Rx/ ,/ (/ 下/ 的/ 最小/ 元素/ ./ (/ 反证法/ )/ 假设/ MX/ 不是/ G/ 的/ 最优/ X/ 匹配/ 集/ ,/ 令/ MX/ ≠/ MX/ 为/ 最优/ ./ 假设/ x/ / MX/ ,/ 由/ 命题/ 3/ ,/ MX/ 在/ G/ 中是/ 最优/ X/ 匹配/ 集/ ,/ 若/ MX/ =/ MX/ ,/ 则/ x/ =/ x/ ,/ MX/ =/ MX/ ,/ 矛盾/ ;/ 若/ MX/ ≠/ MX/ ,/ 与/ 已知/ MX/ 最优/ 相/ 矛盾/ ,/ 故可得/ x/ ∈/ MX/ ./ 若/ MX/ >/ MX/ ,/ 根据/ 命题/ 2/ ,/ 存在/ X/ 匹配/ 集/ 槇/ 且/ 槇/ 珚/ x/ =/ x/ ,/ 即/ MX/ +/ x/ 是/ G/ 的/ X/ 匹配/ 集/ ,/ 与/ 已知/ 相/ 矛盾/ ./ 若/ 珚/ x/ ≠/ x/ ,/ 即/ MX/ +/ 珚/ x/ 是/ G/ 的/ X/ 匹配/ 集/ ,/ 与/ MX/ 在/ G/ 中/ 最优/ 矛盾/ ,/ 故而/ MX/ =/ MX/ ./ 设/ MX/ =/ {/ 珚/ x1/ ,/ …/ ,/ 珚/ xm/ }/ ,/ 其中/ 珚/ x1/ / …/ / 珚/ xm/ ;/ 设/ MX/ =/ {/ x1/ ,/ …/ ,/ xm/ }/ ,/ 其中/ x1/ / …/ / xm/ ;/ 设/ MX/ =/ {/ x1/ ,/ …/ ,/ xm/ }/ ,/ 其中/ x1/ / …/ / xm/ ./ MX/ -/ MX/ / MX/ -/ MX/ ,/ 设/ 珚/ x/ ∈/ 可/ 证明/ x/ / MX/ ./ (/ 反证法/ )/ 假设/ x/ ∈/ MX/ ,/ 令/ x/ 和/ x/ 在/ MX/ 中/ 序列/ 分别/ 为/ l/ 和/ k/ ,/ 即/ 珚/ xl/ =/ x/ ,/ 珚/ xk/ =/ x/ ./ 可/ 推知/ MX1/ ,/ k/ [/ k/ ,/ 珚/ xi/ >/ xi/ ,/ 使得/ MX1/ ,/ k/ [/ 集/ ,/ 且/ 与/ MX/ 是/ G/ 中/ 最优/ 相/ 矛盾/ ./ 对于/ G/ 中/ X/ 匹配/ 集/ 槇/ 配集/ 槇/ MX/ =/ MX1/ ,/ [/ ]/ k/ 和/ MX/ ,/ 根据/ 命题/ 2/ ,/ 存在/ X/ 匹/ MX/ 使得/ 槇/ MX/ -/ 其中/ 珚/ x/ ∈/ MX/ [/ k/ ,/ m/ ]/ ,/ 即/ 珚/ x/ ∈/ R/ (/ x/ ,/ MX/ )/ ∪/ x/ 且/ 珚/ x/ </ x/ ,/ 与/ 已知/ 相/ 矛盾/ ./ 故而/ x/ / MX/ ./ 若/ x/ =/ x/ ,/ 由/ 上述/ 证明/ 可知/ x/ ∈/ MX/ 且/ x/ / MX/ ,/ 矛盾/ ./ 若/ x/ >/ x/ ,/ 即/ MX/ =/ MX/ +/ x/ -/ x/ ./ 设在/ MX/ 中/ ,/ xk/ =/ x/ ./ 由/ MX/ 最优/ 可知/ ,/ / i/ / k/ ,/ 珚/ xi/ / xi/ ./ 若/ / i/ / k/ ,/ 珚/ xi/ >/ xi/ ,/ 则/ MX/ [/ 1/ ,/ i/ ]/ -/ x/ 在/ G/ 中是/ X/ 匹配/ 集/ ,/ 且/ 与/ MX/ 是/ 最优/ 相/ 矛盾/ ,/ 故而/ / i/ / k/ ,/ 珚/ xi/ >/ xi/ ./ 由/ MX/ ≠/ MX/ ,/ 设/ r/ >/ k/ 为/ 最小/ 的/ 整数/ 使得/ 珚/ xr/ >/ xr/ =/ xr/ ./ (/ 如图/ 3/ 所示/ )/ 考察/ MX1/ =/ MX/ [/ 1/ ,/ r/ ]/ 和/ MX2/ =/ MX/ [/ 1/ ,/ r/ -/ 1/ ]/ ,/ x/ ,/ 珚/ x/ {/ MX2/ 可/ 与/ x/ 或/ 珚/ xr/ 增广/ 一个/ 单位/ ./ 若/ 珚/ xr/ 可/ 增广/ MX2/ ,/ 则/ MX2/ +/ 珚/ xr/ 在/ G/ 中是/ X/ 匹配/ 集/ ,/ 且/ 珚/ xr/ >/ xr/ ,/ 与/ MX/ 在/ G/ 中是/ 最优/ 相/ 矛盾/ ./ 若/ x/ 可/ 增广/ MX2/ ,/ 考察/ MX/ 和/ MX2/ +/ x/ ,/ 根据/ 命题/ 2/ ,/ MX2/ +/ x/ 可/ 增广/ 至/ MX3/ ,/ MX3/ =/ MX/ ,/ 且/ MX3/ -/ MX2/ -/ x/ / MX/ -/ MX2/ -/ x/ =/ MX/ [/ r/ ,/ m/ ]/ ,/ 可/ 推知/ MX/ -/ MX3/ =/ 珟/ x/ </ x/ ,/ MX3/ -/ MX/ =/ x/ ,/ 即/ 珟/ x/ ∈/ R/ (/ x/ ,/ MX/ )/ 且/ 珟/ x/ </ x/ ,/ 与/ 已知/ 相/ 矛盾/ ./ 故/ MX/ 是/ G/ 的/ 最优/ X/ 匹配/ 集/ ./ 3.2/ 紧致子/ 图/ 与/ 可/ 替换/ 集/ 二分/ 图中/ 一类/ 特殊/ 的/ 子/ 图/ 与/ 可/ 替换/ 集有/ 密切/ 的/ 联系/ ,/ 下面/ 先/ 给出/ 紧致子/ 图/ 的/ 定义/ ./ 定义/ 3/ ./ 二分/ 图/ G/ 中/ 满足/ 下列/ 性质/ 的/ 子/ 图/ H/ 称为/ 紧致子/ 图/ :/ H/ 是/ 一个/ 蕴含/ 完美/ 匹配/ 的/ 点集/ 非空/ 的/ 导出/ 子图/ ,/ 且/ / x/ ∈/ X/ (/ H/ )/ ,/ NG/ (/ )/ x/ / Y/ (/ H/ )/ ./ 更为/ 确切/ 地说/ ,/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 点子/ 集/ X/ / X/ ,/ 其中/ X/ =/ |/ NG/ (/ X/ )/ |/ ,/ 且/ 对于/ 任意/ X/ / X/ ,/ 都/ 满足/ X/ / |/ NG/ (/ X/ )/ |/ ,/ 则/ 称/ 导出/ 子图/ Page6G/ [/ X/ ∪/ NG/ (/ X/ )/ ]/ 是/ G/ 的/ 紧致子/ 图/ ./ 对于/ G/ 的/ 紧致子/ 图/ G/ 和/ G/ ,/ 若/ (/ )/ XG/ / X/ (/ G/ )/ ,/ 则/ 称/ G/ 覆盖/ G/ ./ 根据/ Hall/ 定理/ [/ 21/ ]/ ,/ 易/ 推知/ 满足/ 上述/ 关系/ 的/ 子/ 图/ 蕴含/ 完美/ 匹配/ ./ 我们/ 有/ 如下/ 命题/ ./ 命题/ 4/ ./ 对于/ 二分/ 图/ G/ 的/ 匹配/ M/ 和/ 紧致子/ 图/ G/ ,/ 若/ (/ )/ XG/ / X/ (/ M/ )/ ,/ 则/ (/ )/ YG/ / Y/ (/ M/ )/ ./ 证明/ ./ 假设/ (/ )/ YG/ / Y/ (/ M/ )/ ,/ 即/ Y1/ =/ (/ )/ YG/ -/ (/ )/ YM/ ≠/ / ,/ 任选/ y1/ ∈/ Y1/ ./ 令/ Y2/ 为/ (/ )/ XG/ 中/ 的/ x/ 顶点/ 在/ M/ 中/ 相匹配/ 的/ y/ 顶点/ 集合/ ,/ 易知/ |/ Y2/ |/ =/ |/ X/ (/ G/ )/ |/ 且/ Y2/ / (/ )/ YM/ ./ 因此/ Y2/ +/ y1/ / NG/ (/ )/ NG/ (/ )/ )/ XG/ >/ |/ X/ (/ G/ )/ |/ ,/ 与/ 定义/ 矛盾/ ./ 证毕/ ./ (/ 定义/ 4/ ./ 在/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 匹配/ 集/ MX/ ,/ 顶点/ x/ ^/ ∈/ X/ -/ MX/ ,/ NGx/ (/ )/ ^/ ≠/ / ,/ 若/ G/ 是/ G/ 的/ 紧致子/ 图/ ,/ 其中/ (/ )/ XG/ / MX/ 且/ NGx/ (/ )/ ^/ / (/ )/ YG/ ,/ 则/ 称/ G/ 是/ 图/ G/ 中/ x/ ^/ 的/ MX/ 紧致子/ 图/ ./ 若/ 不/ 存在/ 另/ 一/ x/ ^/ 的/ MX/ 紧致子/ 图/ G/ 使得/ G/ 覆盖/ G/ ,/ 则/ 称/ G/ 为/ 图/ G/ 中/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ./ 例如/ 图/ 4/ 所示/ ,/ 图/ G/ 中/ X/ =/ x1/ ,/ x2/ ,/ x3/ ,/ x/ {/ Y/ =/ y1/ ,/ y2/ ,/ y/ 则/ G/ =/ G/ [/ X/ ∪/ Y/ ]/ 是/ 图/ G/ 的/ 紧致子/ 图/ ,/ G/ 也/ 是/ 图/ G/ 中/ x/ ^/ 的/ MX/ 紧致子/ 图/ ;/ 令/ X/ =/ {/ x1/ ,/ x2/ }/ ,/ Y/ =/ {/ y1/ ,/ y2/ }/ ,/ 则/ G/ =/ G/ [/ X/ ∪/ Y/ ]/ 是/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ./ 由/ 命题/ 4/ 的/ 证明/ 可知/ ,/ 若/ G/ 是/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 对于/ 饱和/ MX/ 的/ 任一/ 匹配/ M/ ,/ NGx/ (/ )/ ^/ / (/ )/ YG/ / Y/ (/ M/ )/ ./ 下面/ 的/ 命题/ 刻画/ 了/ 最小/ 紧致子/ 图/ 的/ 唯一性/ ./ 命题/ 5/ ./ 设/ MX/ 是/ 二分/ 图/ G/ 中/ 一个/ X/ 匹配/ 集/ ,/ 对于/ 顶点/ x/ ^/ ∈/ X/ (/ G/ )/ -/ MX/ ,/ 且/ NGx/ (/ )/ ^/ ≠/ / ,/ 若图/ G/ 中/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ G/ ,/ 则/ 存在/ 唯一/ 的/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ./ 证明/ ./ 假设/ 存在/ 不止/ 一个/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ,/ 设/ 其中/ 任意/ 两个/ 为/ G1/ 和/ G2/ ,/ G1/ ≠/ G2/ ./ 令/ Y1/ =/ YG/ (/ )/ 1/ ,/ Y2/ =/ YG/ (/ )/ 2/ ,/ 易知/ Y1/ ≠/ Y2/ ,/ 否则/ XG/ (/ )/ 1/ =/ XG/ (/ )/ 2/ ,/ G1/ =/ G2/ ./ 因此/ ,/ Y1/ ∩/ Y2/ ≠/ / ,/ Y1/ / Y2/ ,/ Y2/ / Y1/ ./ 令/ Y3/ =/ Y1/ ∩/ Y2/ ,/ 可得/ Y3/ / Y1/ ,/ Y3/ / Y2/ ./ 根据/ x/ 的/ MX/ 紧致子/ 图/ 定义/ ,/ NG/ (/ )/ x/ / Y3/ ./ 设/ M/ 为/ 任一/ 饱和/ MX/ 的/ 匹配/ ./ 令/ X3/ / MX/ 包含/ M/ 中/ 与/ Y3/ 中/ y/ 顶点/ 相匹配/ 的/ x/ 顶点/ 集合/ ,/ 可/ 推知/ X3/ / XG/ (/ )/ 1/ ∩/ XG/ (/ )/ 2/ ,/ 否则/ 集合/ XG/ (/ )/ 1/ / XG/ (/ )/ 2/ 中/ 存在/ 未/ 匹配/ 的/ x/ 顶点/ ./ 令/ Y3/ =/ NGX/ (/ )/ 3/ ,/ 珚/ Y/ =/ Y3/ -/ Y3/ ./ 根据/ 紧致子/ 图/ 定义/ ,/ 珚/ Y/ / Y1/ ∩/ Y2/ ;/ 根据/ Y3/ 定义/ ,/ 珚/ Y/ / Y1/ ∩/ Y2/ ,/ 故而/ 珚/ Y/ =/ / ,/ 可得/ NGX/ (/ )/ 3/ =/ Y3/ ./ 因为/ X3/ =/ Y3/ ,/ 可得/ G3/ =/ G/ [/ X3/ ∪/ Y/ ]/ 是/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 且/ 被/ G1/ 和/ G2/ 覆盖/ ,/ 与/ 假设/ 相/ 矛盾/ ./ 下面/ 的/ 关键/ 引理/ 刻画/ 了/ 匹配/ 的/ 可/ 增广/ 性/ 与/ 紧致子/ 图/ 的/ 存在/ 性/ 之间/ 的/ 关系/ ./ 引理/ 1/ ./ 对于/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 集/ MX/ 和/ 顶点/ x/ ^/ ∈/ X/ -/ MX/ ,/ 且/ NGx/ (/ )/ ^/ ≠/ / ,/ x/ ^/ 不能/ 增广/ MX/ 当且/ 仅/ 当/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ ./ 证明/ ./ (/ 必要性/ )/ 设/ x/ ^/ 不能/ 增广/ MX/ ,/ R/ (/ x/ ^/ ,/ MX/ )/ 为/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ ,/ 令/ M/ 为/ 饱和/ MX/ 的/ 任一/ 匹配/ ./ 令/ X/ =/ R/ (/ x/ ^/ ,/ MX/ )/ ,/ Y/ =/ NG/ (/ X/ )/ ./ 可/ 推知/ NGx/ (/ )/ ^/ / Y/ 成立/ ,/ 否则/ 对于/ / y/ ∈/ NGx/ (/ )/ ^/ -/ Y/ ,/ (/ x/ ^/ ,/ y/ )/ 是/ 一条/ M/ 增广/ 路/ ./ 若/ X/ </ |/ Y/ |/ ,/ 则/ 必有/ y/ ∈/ Y/ 未/ 匹配/ ,/ 且/ 存在/ 从/ x/ ^/ 到/ y/ 的/ M/ 增广/ 路/ ,/ 矛盾/ ,/ 因此/ |/ X/ |/ / |/ Y/ |/ ./ 可知/ / MX/ / MX/ ,/ |/ MX/ |/ / |/ NG/ (/ MX/ )/ |/ ,/ 而/ X/ / MX/ ,/ 故/ X/ / |/ Y/ |/ ./ 因此/ ,/ X/ =/ |/ Y/ |/ ,/ G/ [/ X/ ∪/ Y/ ]/ 是/ x/ ^/ 的/ MX/ 紧致子/ 图/ ./ (/ 充分性/ )/ 设/ G/ =/ G/ [/ X/ ∪/ Y/ ]/ 是/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 令/ M/ 为/ 饱和/ MX/ 的/ 任一/ 匹配/ ./ 由/ 反证法/ ,/ 假定/ x/ ^/ 可/ 增广/ MX/ ,/ 即/ 存在/ 从/ x/ ^/ 到/ 某/ 未/ 匹配/ y/ 顶点/ y/ 的/ 增广/ 路/ 珚/ P/ ./ 因为/ Y/ 中/ 所有/ 顶点/ 均/ 匹配/ ,/ 因此/ y/ / Y/ ./ 故/ 珚/ P/ 从/ x/ ^/ 出发/ ,/ 进入/ NGx/ (/ )/ ^/ / Y/ ,/ 返回/ X/ ,/ 如此/ 前进/ 直至/ 最终/ 从/ 某个/ x/ ∈/ X/ 达到/ 某个/ y/ / Y/ ,/ 矛盾/ ,/ 因为/ / x/ ∈/ X/ ,/ NG/ (/ )/ x/ / Y/ ./ 由/ 引理/ 1/ 可/ 得出/ 下面/ 关于/ 可/ 替换/ 集和紧/ 致子/ 图/ 之间/ 的/ 重要/ 关系/ ./ 推论/ 1/ ./ 对于/ 二分/ 图/ G/ =/ X/ ,/ Y/ ;/ (/ 集/ MX/ 和/ 顶点/ x/ ^/ ∈/ X/ -/ MX/ ,/ 若/ x/ ^/ 不能/ 增广/ MX/ ,/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ Rx/ ^/ ,/ (/ 中/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ./ 证明/ ./ 根据/ 引理/ 1/ 可知/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 设/ G/ ^/ =/ G/ [/ X/ ^/ ∪/ Y/ ^/ ]/ 为/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ,/ M/ 为/ 饱和/ MX/ 的/ 任一/ 匹配/ ./ 令/ X/ =/ R/ (/ x/ ^/ ,/ MX/ )/ ./ X/ / X/ ^/ 成立/ ,/ 因为/ 任一/ 从/ x/ ^/ 出发/ 的/ 交错/ 路/ 不能/ 延伸/ 出/ G/ ^/ ./ 下面/ 证明/ X/ ^/ / X/ ./ 初始/ ,/ 令/ Y/ =/ NG/ (/ x/ ^/ )/ ,/ X/ =/ NG/ [/ M/ ]/ (/ Y/ )/ ,/ 其中/ G/ [/ M/ ]/ 为/ M/ 的/ 边/ 导出/ 子图/ ./ 因为/ G/ ^/ 是/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ Y/ / Y/ ^/ ,/ 可得/ X/ / X/ ^/ ,/ 因此/ X/ / |/ NG/ (/ X/ )/ |/ 且/ NG/ (/ )/ X/ / Y/ ^/ ./ 可/ 推知/ X/ / X/ ^/ 始终/ 满足/ ,/ 故可/ 递归/ 赋值/ :/ Y/ =/ NG/ (/ )/ X/ ,/ X/ =/ NG/ [/ M/ ]/ (/ Y/ )/ ,/ 直到/ X/ =/ Page7/ |/ NG/ (/ X/ )/ |/ ./ 此时/ ,/ 若/ X/ =/ X/ ^/ ,/ 引理/ 得证/ ./ 若/ X/ / X/ ^/ ,/ G/ [/ X/ ∪/ Y/ ]/ 是/ 一个/ x/ ^/ 的/ MX/ 紧致子/ 图且/ 为/ G/ ^/ 所/ 覆盖/ ,/ 与/ G/ ^/ 是/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图相/ 矛盾/ ./ 证毕/ ./ 3.3/ 紧致子/ 图/ 在/ 凸/ 二分/ 图中/ 的/ 求解/ 在/ 凸/ 二分/ 图中/ ,/ 由于/ 图/ 的/ 凸/ 结构/ 性质/ ,/ 图中/ 的/ 紧致子/ 图/ 含有/ 一些/ 特殊/ 性质/ ./ 命题/ 6/ ./ 设/ MX/ 是/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ 中/ 一个/ X/ 匹配/ 集/ ,/ 对于/ 顶点/ x/ ^/ ∈/ X/ -/ X/ (/ M/ )/ ,/ NGx/ (/ )/ ^/ ≠/ / ,/ 若图/ G/ 中/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ G/ ,/ 则/ (/ )/ YG/ 是/ Y/ 上/ 的/ 一个/ 连续/ 区间/ ./ 证明/ ./ 设/ M/ 为/ 任一/ 饱和/ MX/ 的/ 匹配/ ./ 令/ Y0/ =/ NGx/ (/ )/ ^/ ,/ Xi/ =/ NG/ [/ M/ ]/ Y/ (/ )/ i/ ,/ 即/ Xi/ 是/ M/ 上/ 与/ Yi/ 中/ y/ 顶点/ 相匹配/ 的/ x/ 顶点/ 集合/ ,/ Yi/ +/ 1/ =/ NGX/ (/ )/ i/ ./ 下面/ 用/ 归纳法/ :/ 显然/ Y0/ 在/ (/ )/ YG/ 上/ 连续/ ,/ 假设/ Yi/ 在/ (/ )/ YG/ 上/ 连续/ ,/ 证明/ Yi/ +/ 1/ 在/ (/ )/ YG/ 上/ 连续/ ./ 初始/ 地令/ Y/ =/ Yi/ ./ 遍历/ Xi/ ,/ 对于/ 每个/ 顶点/ x/ ∈/ Xi/ ,/ 扩充/ Y/ =/ Y/ ∪/ NG/ (/ x/ )/ ./ 根据/ 凸/ 性质/ 以及/ 已知/ x/ 在/ M/ 中/ 相匹配/ 顶点/ y/ ∈/ Y/ ,/ 即/ NG/ (/ )/ x/ ∩/ Y/ ≠/ / ,/ 可知/ 在/ 每次/ 扩充/ 后/ Y/ 在/ (/ )/ YG/ 上/ 连续/ ./ 因此/ Yi/ +/ 1/ 在/ (/ )/ YG/ 上/ 连续/ ./ 当/ Yi/ =/ (/ )/ YG/ 时/ ,/ 定理/ 得证/ ./ 进而/ 可/ 利用/ 凸/ 性质/ 在/ 凸/ 二分/ 图中/ 快速/ 判断/ 和/ 求解/ 紧致子/ 图/ ./ 定义/ 5/ ./ 给定/ 凸/ 二分/ 图/ G/ =/ (/ X/ [/ 1/ ,/ n/ ]/ ,/ Y/ [/ 1/ ,/ m/ ]/ )/ 和/ 某/ 一/ X/ 匹配/ 集/ MX/ ,/ 定义/ :/ α/ i/ ,/ (/ d/ α/ i/ ,/ (/ β/ j/ ,/ (/ )/ MX/ =/ m/ -/ j/ +/ 1/ -/ β/ j/ ,/ (/ d/ β/ j/ ,/ (/ 若/ d/ α/ k/ ,/ (/ 若/ d/ β/ k/ ,/ (/ 以下/ 引理/ 刻画/ 紧致/ 点/ 与/ 紧致子/ 图间/ 的/ 关系/ ./ 引理/ 2/ ./ 对于/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ 中/ X/ 匹配/ 集/ MX/ ,/ 若/ k/ 为/ α/ -/ MX/ 紧致点/ ,/ 则/ [/ ]/ GV/ 是/ 紧致子/ 图/ ,/ 其中/ V/ =/ MX/ [/ 1/ ,/ k/ ]/ ∪/ Y/ [/ 1/ ,/ k/ ]/ ,/ MX/ 按/ end/ -/ id/ 序列/ 排序/ ;/ 若/ k/ 为/ β/ -/ MX/ 紧致点/ ,/ 则/ [/ ]/ GV/ 是/ 紧致子/ 图/ ,/ 其中/ V/ =/ MX/ [/ |/ MX/ |/ -/ m/ +/ k/ ,/ |/ MX/ |/ ]/ ∪/ Y/ [/ k/ ,/ m/ ]/ ,/ MX/ 按/ start/ -/ id/ 序列/ 排序/ ./ 证明/ ./ 由/ 凸/ 二分/ 图/ 的/ 凸/ 性质/ 以及/ 紧致点/ 、/ 紧致子/ 图/ 定义/ 即可/ 得证/ ./ 下面/ 界定/ 一些/ 特殊/ 的/ 紧致点/ ,/ 它们/ 与/ 求解/ 最小/ 紧致子/ 图/ 相关/ ./ 定义/ 6/ ./ 给定/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ 中/ X/ 匹配/ 集/ MX/ 和/ 顶点/ y/ ∈/ Y/ ,/ 若/ 存在/ α/ -/ MX/ 紧致点/ k/ 且/ Y/ [/ k/ ]/ / y/ ,/ 则/ 称/ 其中/ 最小/ 的/ k/ 为/ α/ Posty/ ,/ (/ 致点/ ;/ 若/ 存在/ α/ -/ MX/ 紧致点/ k/ 且/ Y/ [/ k/ ]/ </ y/ ,/ 则/ 称/ 其中/ 最大/ 的/ k/ 为/ α/ Prey/ ,/ (/ β/ -/ MX/ 紧致点/ k/ 且/ Y/ [/ k/ ]/ / y/ ,/ 则/ 称/ 其中/ 最大/ 的/ k/ 为/ β/ Prey/ ,/ (/ Y/ [/ k/ ]/ >/ y/ ,/ 则/ 称/ 其中/ 最小/ 的/ k/ 为/ β/ Posty/ ,/ (/ 引理/ 3/ 和/ 引理/ 4/ 给出/ 了/ 在/ 凸/ 二分/ 图中/ ,/ 对于/ 几种/ 特殊/ 的/ x/ 顶点/ ,/ 根据/ 紧致点/ 判断/ X/ 匹配/ 集/ 的/ 可/ 增广/ 性/ 和/ 求解/ 可/ 替换/ 集/ 的/ 方法/ ./ 引理/ 3/ ./ 设/ MX/ 为/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ 中/ X/ 匹配/ 集/ ,/ 对于/ 顶点/ x/ ^/ / X/ ,/ 当/ x/ ^/ ./ s/ / Y/ ./ min/ ,/ 或/ 存在/ x/ ∈/ MX/ ,/ 使得/ 从/ x/ ^/ 出发/ 的/ MX/ 交错/ 路/ 可达/ x/ 且/ x/ ./ s/ / Y/ ./ min/ 时/ ,/ 在/ 图/ G/ +/ x/ ^/ 中/ ,/ 若/ 不/ 存在/ α/ -/ MX/ 紧致点/ i/ 且/ Y/ [/ i/ ]/ / x/ ^/ ./ e/ ,/ 则/ x/ ^/ 可/ 增广/ MX/ ;/ 若/ 存在/ 这类/ 紧致点/ ,/ 令/ k/ 为/ α/ Postx/ ^/ ./ e/ ,/ (/ 可/ 替换/ 集/ Rx/ ^/ ,/ (/ end/ -/ id/ 序列/ 排序/ ./ 证明/ ./ 令/ j/ =/ mini/ / Y/ :/ Y/ [/ i/ ]/ / x/ ^/ ./ 察/ 情况/ :/ x/ ^/ ./ s/ / Y/ ./ min/ ./ 在/ 图/ G/ +/ x/ ^/ 中/ ,/ MX/ 仍为/ X/ 匹配/ 集/ ,/ 若/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ G/ ,/ 根据/ 紧致子/ 图/ 的/ 定义/ 则/ 有/ Y/ [/ 1/ ,/ j/ ]/ / (/ )/ YG/ ./ 又/ 根据/ 命题/ 6/ 可知/ ,/ (/ )/ YG/ 是/ Y/ 上/ 的/ 连续/ 区间/ ,/ 令/ Y/ [/ k/ ]/ =/ (/ )/ YG/ ./ max/ ,/ 则/ (/ )/ YG/ =/ Y/ [/ 1/ ,/ k/ ]/ ./ 再/ 根据/ 紧致子/ 图/ 的/ 定义/ ,/ 可知/ |/ X/ (/ G/ )/ |/ =/ k/ ,/ 且/ / x/ ∈/ (/ )/ XG/ ,/ x/ ./ e/ / Y/ [/ k/ ]/ ./ 根据/ α/ -/ MX/ 紧致/ 点/ 的/ 定义/ 可/ 推知/ ,/ k/ 是/ 一个/ α/ -/ MX/ 紧致点/ ,/ 且/ [/ ]/ Yk/ / x/ ^/ ./ e/ ./ 因此/ ,/ 若/ 不/ 存在/ α/ -/ MX/ 紧致点/ i/ 且/ Y/ [/ i/ ]/ / x/ ^/ ./ e/ ,/ 则/ 不/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 此时/ ,/ 根据/ 引理/ 1/ ,/ 则/ x/ ^/ 可/ 增广/ MX/ ./ 若/ 存在/ α/ -/ MX/ 紧致点/ i/ 且/ [/ ]/ Yi/ / x/ ^/ ./ e/ ,/ 令/ k/ 为/ x/ 的/ α/ -/ MX/ 最小/ 紧致点/ ./ 根据/ 定义/ 和/ 引理/ 2/ 不难/ 证明/ ,/ GMX/ [/ 1/ ,/ k/ ]/ ∪/ Y/ [/ 1/ ,/ k/ 其中/ MX/ 按/ end/ -/ id/ 序列/ 排序/ ./ 因此/ ,/ 根据/ 推论/ 1/ ,/ 可得/ Rx/ ^/ ,/ (/ [/ 再/ 考察/ x/ 可/ 被/ x/ ^/ 出发/ 的/ MX/ 交错/ 路/ 可达/ ,/ 且/ x/ ./ s/ / Y/ ./ min/ ,/ 即/ 在/ 图/ G/ +/ x/ ^/ 中/ x/ ∈/ R/ (/ x/ ^/ ,/ MX/ )/ ./ 若/ 存在/ x/ ^/ 的/ MX/ 紧致子/ 图/ ,/ 令/ G/ 是/ x/ ^/ 的/ MX/ 最小/ 紧致子/ 图/ ,/ 则/ 根据/ 推论/ 1/ ,/ 有/ x/ ∈/ R/ (/ x/ ^/ ,/ MX/ )/ =/ X/ (/ G/ )/ ,/ Y/ [/ 1/ ]/ / (/ )/ YG/ 且/ Y/ [/ j/ ]/ / (/ )/ YG/ ./ 根据/ 命题/ 6/ ,/ (/ )/ YG/ 是/ Y/ 上/ 的/ 连续/ 区间/ ,/ 则/ (/ )/ YG/ =/ Y/ [/ 1/ ,/ k/ ]/ ,/ 其中/ Y/ [/ k/ ]/ =/ Y/ (/ G/ )/ ./ max/ ./ 后面/ 的/ 证明/ 与/ x/ ^/ ./ s/ / Y/ ./ min/ 情况/ 下相/ 类似/ ./ 对称/ 地/ ,/ 对应/ 于/ β/ -/ MX/ 最大/ 紧致点/ 情形/ 有/ 如下/ 引理/ ,/ 证明/ 与/ 引理/ 3/ 类似/ ./ 引理/ 4/ ./ 设/ MX/ 为/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ 中/ XPage8/ 匹配/ 集/ ,/ 对于/ 顶点/ x/ ^/ / X/ ,/ 当/ x/ ^/ ./ e/ / Y/ ./ max/ ,/ 或/ 存在/ x/ ∈/ MX/ ,/ 使得/ 从/ x/ ^/ 出发/ 的/ MX/ 交错/ 路/ 可达/ x/ 且/ x/ ./ e/ / Y/ ./ max/ 时/ ,/ 在/ 图/ G/ +/ x/ ^/ 中/ ,/ 若/ 不/ 存在/ β/ -/ MX/ 紧致点/ i/ 且/ Y/ [/ i/ ]/ / x/ ^/ ./ s/ ,/ 则/ x/ ^/ 可/ 增广/ MX/ ;/ 若/ 存在/ 这类/ 紧致点/ ,/ x/ ^/ 的/ MX/ 可/ 替换/ 集/ R/ (/ x/ ^/ ,/ MX/ )/ =/ MX/ [/ |/ MX/ |/ -/ |/ Y/ |/ +/ k/ ,/ |/ MX/ |/ ]/ ,/ 其中/ k/ 为/ β/ Prex/ ^/ ./ s/ ,/ (/ MX/ 按/ start/ -/ id/ 序列/ 排序/ ./ 证明/ ./ 略/ ./ 本节/ 研究/ 了/ 在/ 求解/ 左侧/ 带权/ 凸/ 二分/ 图/ 动态/ 匹配/ 问题/ 中/ 所/ 涉及/ 到/ 的/ 一些/ 关键/ 的/ 概念/ 和/ 定理/ ./ 下文/ 将/ 研究/ 具体/ 的/ 动态/ 匹配/ 算法/ ,/ 包括/ 动态/ 算法/ 和/ 数据结构/ 的/ 设计/ 与/ 分析/ ./ 4/ 改进/ 的/ 二叉/ 计算/ 树/ 二叉/ 计算/ 树/ 数据结构/ 最早/ 由/ 文献/ [/ 18/ ]/ 提出/ 以/ 解决/ 凸/ 二分/ 图上/ 的/ 并行/ 匹配/ 问题/ ./ 随后/ 文献/ [/ 17/ ]/ 基于/ 该/ 结构/ 结合/ 隐性/ 表征/ ,/ 解决/ 不带/ 权凸/ 二分/ 图上/ 的/ 动态/ 匹配/ 问题/ ./ 本节/ 改进/ 二叉/ 计算/ 树/ 隐性/ 表征/ 结构/ ,/ 使/ 其/ 可/ 支持/ 带权/ 问题/ 的/ 求解/ ./ 4.1/ 改进/ 的/ 二叉/ 计算/ 树/ 数据结构/ 二叉/ 计算/ 树是/ 增广/ 的/ 平衡/ 二叉/ 查找/ 树/ (/ 如红/ 黑树/ ,/ 参阅/ 文献/ [/ 22/ ]/ )/ ./ 给定/ 左侧/ 带权/ 凸/ 二分/ 图/ G/ =/ X/ ,/ (/ )/ Y/ ,/ 将/ 集合/ S/ =/ x/ ./ s/ :/ x/ ∈/ 列/ ,/ 进而/ S/ 可/ 表示/ 为/ s1/ ,/ …/ ,/ s/ {/ 1/ ./ 进而/ Y/ 可/ 划分/ 为/ k/ 个/ 连续/ 区间/ :/ [/ si/ ,/ si/ +/ 1/ -/ 1/ ]/ ,/ 1/ / i/ / k/ ./ 在/ 二叉/ 计算/ 树中/ ,/ 从左往右/ 第/ i/ 个/ 叶子/ 节点/ 与子/ 图/ G/ [/ Xi/ ∪/ Yi/ ]/ 相关联/ ,/ 其中/ Xi/ =/ {/ x/ ∈/ X/ :/ x/ ./ s/ =/ si/ }/ ,/ Yi/ =/ [/ si/ ,/ si/ +/ 1/ -/ 1/ ]/ ./ 令/ P/ 为/ 某/ 中间/ 节点/ ,/ L/ 为/ 其/ 左/ 孩子/ 节点/ ,/ R/ 为/ 其右/ 孩子/ 节点/ ./ 节点/ P/ 关联/ 子图/ G/ [/ XP/ ∪/ YP/ ]/ ,/ 其中/ XP/ =/ XL/ ∪/ XR/ ,/ YP/ =/ YL/ ∪/ YR/ ./ 故而/ ,/ 根/ 节点/ 关联/ 图/ G/ ./ 每个/ 节点/ P/ 中/ 增广/ 数个/ 辅助/ 集合/ ,/ 如表/ 1/ 所示/ ./ XPYPFXP/ 游离/ 集/ ,/ FXP/ =/ x/ ∈/ XP/ :/ x/ ./ e/ >/ Y/ ./ MXPUXP/ 未/ 匹配/ 集/ ,/ UXP/ =/ x/ ∈/ XP/ -/ FXP/ -/ MX/ 对于/ 节点/ P/ 中/ 的/ 辅助/ 集合/ ,/ 算法/ 维护/ 一些/ 循环/ 不变式/ ,/ 其中/ 关键/ 的/ 两个/ 为/ :/ (/ 1/ )/ / 1/ :/ MXP/ 是子/ 图/ GP/ ^/ 中/ 的/ 最优/ X/ 匹配/ 集/ ./ (/ 2/ )/ / 2/ :/ 不/ 存在/ x/ ∈/ MXr/ [/ 图/ GMXP/ ∪/ YlMXlP/ ,/ 且/ 在/ end/ -/ id/ 排序/ 下/ x/ </ x/ ./ 由/ / 1/ 可/ 推知/ 当/ P/ 为树/ 中根/ 节点/ 时/ ,/ MXP/ 即/ 为/ 图/ G/ 的/ 最优/ X/ 匹配/ 集/ ./ / 2/ 决定/ MXP/ 的/ 划分/ ,/ 在/ 动态/ 更新/ 操作/ 中/ 保证/ 了/ 算法/ 效率/ (/ 下文/ 5.1/ 节/ 论及/ )/ ./ 4.1/ ./ 1/ 节点/ 内部表征/ 二叉/ 计算/ 树中/ 每个/ 节点/ 的/ 辅助/ 集合/ 同样/ 基于/ 增广/ 的/ 平衡/ 二叉树/ 来/ 表征/ ,/ 因此/ 整体/ 结构/ 是/ 二维/ 树结构/ ./ 节点/ P/ 中/ 的/ 数据结构/ 表征/ 包括/ :/ (/ 1/ )/ 对于/ 辅助/ 集合/ MXlUXP/ ,/ 每个/ 集合/ 有/ 一颗/ 对应/ 的/ 树结构/ 表征/ ;/ (/ 2/ )/ 一颗/ α/ 树/ 表征/ GMXr/ (/ 3/ )/ 一颗/ β/ 树/ 表征/ GMXl/ 辅助/ 集合/ 表征/ :/ 辅助/ 集合/ 树结构/ 的/ 表征/ 方法/ 以/ 集合/ MXr/ 节点/ 对应/ 一个/ x/ ∈/ MXr/ 排序/ ,/ 即/ 叶子/ 节点/ 所/ 关联/ 的/ 关键字/ 为/ (/ x/ ./ e/ ,/ x/ ./ s/ ,/ x/ ./ id/ )/ ./ 对于/ 树中/ 每个/ 节点/ u/ ,/ 增广/ 数个/ 辅助/ 域/ ,/ 包括/ u/ ./ size/ =/ |/ leaves/ (/ u/ )/ |/ ,/ 其中/ leaves/ (/ u/ )/ 表示/ 以/ u/ 为根/ 节点/ 的/ 子树/ 中/ 所/ 包含/ 的/ 叶子/ 节点/ 集合/ ;/ u/ ./ maxe/ ,/ u/ ./ mins/ ,/ u/ ./ minw/ 分别/ 表示/ 集合/ 所/ 关联/ 的/ x/ 集合/ 中/ ,/ end/ -/ id/ 排序/ 下/ 最大/ 的/ x/ ,/ start/ -/ id/ 排序/ 下/ 最小/ 的/ x/ ,/ weight/ -/ id/ 排序/ 下/ 最小/ 的/ x/ ./ 其他/ 辅助/ 集合/ 的/ 树结构/ 可/ 同理/ 表征/ ./ α/ 树/ 表征/ :/ 在/ α/ 树中/ ,/ 每个/ 叶子/ 节点/ 对应/ 一个/ y/ ∈/ P/ ./ 叶子/ 节点/ 的/ 关键字/ 为/ 所/ 关联/ 的/ y/ 顶点/ ,/ 按照/ yYr/ 的/ 增序/ 排列/ ./ 从左往右/ 第/ i/ 个/ 叶子/ 命名/ 为/ yi/ ,/ 叶子/ yi/ 对应/ Yr/ 对于/ 中间/ 节点/ ,/ u/ ./ d/ 的/ 初值/ 为/ 0/ ,/ 对于/ 叶子/ 节点/ yi/ ,/ u/ ./ d/ 的/ 初值/ 为/ i/ (/ 下/ 一/ 小节/ 将会/ 讨论/ :/ 每次/ 基本操作/ 至多/ 影响/ 3/ 条/ 从/ 根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ ,/ 使得/ 其中/ 的/ 节点/ 所/ 对应/ 的/ d/ 的/ 值/ 发生/ 改变/ )/ ./ 定义/ d/ (/ u/ ,/ v/ )/ =/ n/ ./ d/ ,/ 其中/ v/ 是/ u/ 的/ 祖先/ 节点/ ,/ 犘/ [/ u/ ,/ v/ ]/ 代表/ 从/ ∑/ n/ ∈/ 犘/ [/ u/ ,/ v/ ]/ u/ 到/ v/ 的/ 不/ 包含/ v/ 的/ 路径/ ./ 对于/ 节点/ u/ ,/ 定义/ (/ )/ du/ =/ du/ ,/ (/ )/ root/ ,/ root/ 代表/ α/ 树中根/ 节点/ ./ 这样/ ,/ 对于/ 叶子/ yi/ ,/ dy/ (/ )/ i/ =/ d/ α/ i/ ,/ MXr/ 个/ 节点/ u/ 增广/ 辅助/ 域/ dmin/ ,/ 其值/ 为/ min/ {/ dk/ ,/ (/ )/ u/ :/ k/ ∈/ leaves/ (/ v/ )/ }/ ./ 因此/ ,/ 对于/ 节点/ u/ ,/ 等式/ (/ )/ du/ +/ u/ ./ dmin/ =/ min/ (/ )/ dv/ :/ v/ ∈/ 个/ 整型/ 域/ σ/ ,/ 初值/ 为/ 0/ ,/ 随后/ 在/ 每次/ 使用/ 前/ 更新/ 为/ (/ )/ du/ ./ 每个/ 节点/ u/ 增广/ 辅助/ 域/ maxy/ ,/ 表示/ {/ Page9/ 的/ y/ 集合/ 中/ 最大/ 的/ y/ ./ β/ 树结构/ 可/ 同理/ 表征/ ./ 4.2/ 基本操作/ 在/ 上述/ 表征/ 的/ 基础/ 上/ ,/ 二叉/ 计算/ 树/ 数据结构/ 支持/ 如下/ 操作/ :/ (/ 1/ )/ 在/ 辅助/ 集合/ 树结构/ 中/ 查询/ 某子/ 集中/ 的/ 最大/ 或/ 最小/ 元素/ 以及/ 更新/ 集合/ 的/ 操作/ ;/ (/ 2/ )/ 在/ α/ 树/ 查询/ α/ Prey/ ,/ MXr/ 紧致点/ ,/ 以及/ 更新/ 集合/ 的/ 操作/ ;/ (/ 3/ )/ 在/ β/ 树/ 查询/ β/ Prey/ ,/ MXl/ 紧致点/ 以及/ 更新/ 集合/ 的/ 操作/ ./ 该/ 小节/ 分别/ 以/ 一种/ 情况/ 为例/ ,/ 描述/ 和/ 分析/ 这/ 几类/ 基本操作/ 的/ 算法/ 及其/ 时间/ 复杂度/ ./ 辅助/ 集合/ 查询/ 和/ 更新/ :/ 考虑/ 在/ MXr/ 满足/ x/ ./ e/ / y/ 的/ 条件/ 时/ weight/ -/ id/ 排序/ 下/ 最小/ 元素/ 的/ 操作/ ,/ 即/ 寻找/ x/ ^/ =/ minw/ {/ x/ ∈/ MXrP/ 树中/ ,/ 根据/ 域/ maxe/ ,/ 自顶向下/ 遍历/ 路径/ 犘/ (/ root/ ,/ MXrl/ )/ ,/ 其中/ l/ 代表/ 满足/ x/ ./ e/ / y/ 中/ 最大/ 的/ 叶子/ 节点/ ;/ 对于/ 路径/ 中/ 每个/ 节点/ u/ ,/ 若/ 存在/ u/ 的/ 左/ 兄弟/ 节点/ v/ 且/ 在/ weight/ -/ id/ 排序/ 下/ v/ ./ minw/ </ x/ ^/ ,/ 置/ x/ ^/ =/ v/ ./ minw/ ,/ 其中/ x/ ^/ ./ w/ 的/ 初值/ 置/ 为/ +./ 令/ 叶子/ l/ 所/ 关联/ 的/ x/ 顶点/ 为/ x/ ./ 若/ 在/ weight/ -/ id/ 排序/ 下/ x/ ^/ >/ x/ ,/ 则/ 返回/ x/ ./ 否则/ ,/ 自下而上/ 遍历/ 路径/ 犘/ [/ l/ ,/ root/ ]/ ,/ 直到/ 遇到/ 第/ 1/ 个/ 满足/ 下述/ 条件/ 的/ 节点/ u/ :/ u/ 的/ 左/ 兄弟/ 节点/ v/ 中/ v/ ./ minw/ =/ x/ ^/ ./ 以/ v/ 为根/ 节点/ 的/ 子树/ 包含/ 对应/ x/ ^/ 的/ 叶子/ 节点/ ,/ 根据/ 域/ minw/ 可/ 定位/ 该/ 叶子/ ./ 故而/ 在/ MXrweight/ -/ id/ 排序/ 下/ 最小/ 元素/ 的/ 操作/ ,/ 至多/ 遍历/ 从根/ 节点/ 到/ 某/ 叶子/ 节点/ 的/ 路径/ 3/ 次/ ./ 在/ MXr/ 个/ 新/ x/ 顶点/ 时/ ,/ 同样/ 可/ 根据/ 域/ maxe/ 定位/ 加入/ 的/ 叶子/ 节点/ ,/ 进而/ 完成/ 添加/ 操作/ ;/ 若/ 其中/ 涉及/ 到/ 树/ 的/ 平衡/ 操作/ (/ 如/ 旋转/ )/ ,/ 每个/ 节点/ 中/ 所/ 对应/ 的/ 辅助/ 域/ 可/ 在/ 常数/ 时间/ 内/ 进行/ 调整/ ./ α/ 树/ 查询/ :/ 基于/ α/ 树可/ 实现/ 在子/ 图/ G/ (/ 顶点/ y/ 的/ α/ Posty/ ,/ MXr/ α/ Posty/ ,/ MXr/ 在/ x/ 的/ 紧致点/ ,/ 故/ 假设/ y/ / YP/ ./ max/ ./ 在/ α/ 树中/ ,/ 根据/ 域/ maxy/ ,/ 自顶向下/ 遍历/ 路径/ 犘/ (/ root/ ,/ y/ )/ ,/ 对于/ 路径/ 中/ 每个/ 节点/ u/ ,/ 更新/ u/ ./ σ/ ./ 定位/ 到/ y/ 之后/ ,/ 自下而上/ 遍历/ 路径/ 犘/ [/ y/ ,/ root/ ]/ ,/ 直到/ 遇到/ 第/ 1/ 个/ 满足/ 下述/ 条件/ 的/ 节点/ u/ :/ u/ 的/ 右/ 兄弟/ 节点/ v/ 中/ v/ ./ dmin/ +/ v/ ./ d/ +/ u/ ./ parent/ ./ σ/ =/ 0/ ./ 若/ 不/ 存在/ 这样/ 的/ 节点/ ,/ 则/ 当前/ α/ 树中/ 不/ 存在/ x/ 的/ 紧致点/ ;/ 否则/ ,/ 以/ v/ 为根/ 节点/ 的/ 子树/ 包含/ 对应/ x/ 的/ α/ -/ M/ 最小/ 紧致点/ k/ 的/ 叶子/ 节点/ yk/ ,/ 即足/ dy/ (/ )/ i/ =/ 0/ 的/ 最小/ 叶子/ 节点/ yi/ ./ 以/ 如下/ 方法/ 确定/ 从/ v/ 到/ yk/ 路径/ ,/ 对于/ 路径/ 中/ 每个/ 节点/ u/ ,/ 更新/ u/ ./ σ/ ,/ 并/ 从/ u/ 的/ 两个/ 孩子/ 节点/ 中/ 选择/ 满足/ u/ ./ σ/ +/ vd/ +/ v/ ./ dmin/ =/ 0/ 的/ 孩子/ 节点/ v/ (/ 优先选择/ 左/ 孩子/ 节点/ )/ ./ 当/ 定位/ 到/ yk/ 之后/ ,/ 即可/ 通过/ 相似/ 的/ 方法/ 求解/ yk/ 在/ Yr/ 的/ 序列/ 位置/ ,/ 即为/ k/ 的/ 值/ ./ 查找/ x/ ^/ 的/ α/ -/ M/ 最小/ 紧致点/ k/ 的/ 操作/ 遍历/ 从根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ 至多/ 3/ 次/ ./ α/ Prey/ ,/ MXr/ 树中/ ,/ β/ Prey/ ,/ MXl/ 以/ 类似/ 求解/ ./ α/ 树/ 更新/ :/ MXr/ 与/ 上述/ 讨论/ 类似/ ./ 通过/ x/ ^/ ./ e/ 即可/ 找到/ 对应/ 的/ 叶子/ 节点/ y/ ,/ 将/ y/ ./ d/ 减/ 1/ ,/ 然后/ 自下而上/ 遍历/ 路径/ 犘/ [/ y/ ,/ root/ ]/ ,/ 对于/ 路径/ 中/ 的/ 每个/ 节点/ u/ ,/ 若/ u/ 有右/ 兄弟/ 节点/ v/ ,/ 则/ v/ ./ d/ 减/ 1/ ,/ 同时/ 对于/ 路径/ 中/ 的/ 每个/ 节点/ 更新/ 其/ dmin/ 域/ 的/ 值/ ./ 例如/ 图/ 5/ 所示/ ,/ 每个/ 叶子/ 节点/ 下面/ 的/ 数值/ 代表/ d/ 域/ 的/ 初值/ ,/ 设/ x/ ^/ ./ e/ 对应/ 第/ 2/ 个/ 叶子/ 节点/ ,/ 树中/ 的/ 深色/ 节点/ 表示/ d/ 域/ 更新/ 的/ 节点/ ./ 更新/ α/ 树/ 的/ 操作/ 遍历/ 从根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ 至多/ 2/ 次/ ./ 若/ P/ 中/ 发生/ 替换/ 操作/ ,/ 即/ x/ ^/ 替换/ 了/ 其中/ 某个/ x/ ,/ 则/ MXr/ 涉及/ 从/ x/ ^/ ./ e/ 和/ x/ ./ e/ 两个/ 叶子/ 节点/ 到/ 根/ 节点/ 的/ 更新/ 值/ 操作/ ,/ 方法/ 类似/ ./ 在/ β/ 树中/ 的/ 更新/ 和/ 替换/ 操作/ 同理/ 可/ 实现/ ./ 引理/ 5/ ./ 改进/ 的/ 二叉/ 计算/ 树中/ 的/ 基本操作/ 的/ 时间/ 复杂度/ 为/ Olog/ (/ 证明/ ./ 在/ 辅助/ 集合/ 对应/ 的/ 树结构/ 中/ ,/ 查询/ 和/ 更新/ 操作/ 至多/ 遍历/ 从根/ 节点/ 到/ 某/ 叶子/ 节点/ 的/ 路径/ 3/ 次/ ,/ 在/ 每个/ 节点/ 中/ 操作/ 为/ 常数/ 时间/ 复杂度/ ,/ 故而/ 可/ 在/ 对数/ 时间/ 复杂度/ 下/ 完成/ ./ 在/ α/ 树/ 以及/ β/ 树中/ 的/ 查询/ 紧致/ 点/ 和/ 更新/ 树/ 的/ 操作/ 同样/ 至多/ 遍历/ 从根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ 3/ 次/ ,/ 对于/ 树中/ 每个/ 节点/ 中/ 的/ 操作/ 为/ 常数/ 时间/ ,/ 故而/ 可/ 在/ 对数/ 时间/ 复杂度/ 下/ 实现/ ./ 证毕/ ./ 本节/ 我们/ 基于/ 二叉/ 计算/ 树/ ,/ 设计/ 了/ 支持/ 左侧/ 带权/ 凸/ 二分/ 图/ 动态/ 匹配/ 的/ 数据结构/ ,/ 给出/ 了/ 其/ 隐性/ 表征/ 结构/ ,/ 以及/ 该/ 数据结构/ 支持/ 的/ 基本操作/ ./ 下/ 一节/ 将/ 研究/ 动态/ 匹配/ 算法/ ./ Page105/ 动态/ 匹配/ 算法/ 动态/ 匹配/ 算法/ 的/ 设计/ 基于/ 改进/ 的/ 二叉/ 计算/ 树/ 数据结构/ ./ 本节/ 详细描述/ 并/ 证明/ 图中/ 添加/ 新/ 的/ x/ 顶点/ 的/ 动态/ 更新/ 操作/ ,/ 其他/ 更新/ 操作/ 可/ 类似/ 求解/ ;/ 动态/ 查询/ 操作/ 可/ 采用/ 我们/ 已有/ 方法/ [/ 23/ ]/ 来/ 实现/ ./ 5.1/ 犻/ 狀/ 狊/ 犲/ 狉/ 狋/ (/ 狓/ )/ 更新/ 操作/ 动态/ 更新/ 操作/ 保证/ 二叉/ 计算/ 树/ 的/ 每个/ 节点/ P/ 中/ 的/ 辅助/ 集合/ 满足/ 相应/ 的/ 循环/ 不变式/ ,/ 即/ 维护/ 子图/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ )/ ∪/ Y/ 首先/ 定义/ 相对/ 于/ 节点/ P/ 的/ 可/ 替换/ 集/ ./ 定义/ 7/ ./ 设/ MXP/ 为/ 二叉/ 计算/ 树中/ 节点/ P/ 所/ 对应/ 子图/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ )/ ∪/ Y/ 集/ ,/ 给定/ 顶点/ x/ / XP/ 且/ x/ ./ e/ / YP/ ./ max/ ,/ 若/ x/ 不能/ 增广/ MXP/ ,/ 即/ MXP/ +/ x/ 不是/ GP/ ^/ =/ G/ [/ (/ XP/ -/ FXP/ +/ x/ )/ ∪/ YP/ ]/ 的/ X/ 匹配/ 集/ ,/ 则/ 称图/ GP/ ^/ 中/ x/ 的/ MXP/ 可/ 替换/ 集为/ x/ 在/ 节点/ P/ 中/ 的/ 可/ 替换/ 集/ ,/ 记为/ RSx/ ,/ (/ )/ P/ ./ 当/ 不致/ 混淆/ 时/ ,/ 简记/ RSx/ ,/ (/ )/ P/ 为/ (/ )/ RSx/ ./ 易知/ / x/ ∈/ RS/ (/ x/ ,/ P/ )/ ,/ MX/ =/ MXP/ +/ x/ -/ x/ 为子/ 图/ GP/ ^/ 的/ 一个/ X/ 匹配/ 集/ ./ 以下/ 推论/ 由/ 给出/ 了/ 在/ GP/ ^/ 中/ 维护/ 最优/ X/ 匹配/ 集/ 的/ 方法/ ./ 推论/ 2/ ./ 设/ MXP/ 为/ 二叉/ 计算/ 树中/ 节点/ P/ 所/ 对应/ 子图/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ )/ ∪/ Y/ 集/ ,/ 给定/ 顶点/ x/ / XP/ 且/ x/ ./ e/ / YP/ ./ max/ ,/ 若/ MXP/ =/ MXP/ +/ x/ 为/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ +/ x/ )/ ∪/ Y/ 配集/ ,/ 则/ MXP/ 为/ GP/ ^/ 的/ 最优/ X/ 匹配/ 集/ ;/ 否则/ ,/ 令/ rx/ 为/ RSx/ ,/ (/ )/ P/ ∪/ x/ 中/ 按/ weight/ -/ id/ 序列/ 排序/ 下/ 的/ 最小/ 元素/ ,/ MX/ +/ x/ -/ rx/ 为/ GP/ ^/ 的/ 最优/ X/ 匹配/ 集/ ./ 证明/ ./ 由/ 定理/ 1/ 直接/ 推论/ 可证/ ./ 更新/ 操作/ 的/ 计算/ 遍历/ 二叉/ 计算/ 树中/ 从/ 某个/ 叶子/ 节点/ 到/ 根/ 节点/ 的/ 路径/ ,/ 对于/ 该/ 路径/ 中/ 的/ 每个/ 节点/ ,/ 依次/ 进行/ 更新/ 操作/ ,/ 且/ 路径/ 中/ 每个/ 父/ 节点/ 中/ 的/ 操作/ 依赖/ 于其子/ 节点/ 的/ 操作/ 计算结果/ ,/ 该/ 结果/ 用/ 消息/ 机制/ 进行/ 传递/ ./ 在/ 一个/ 五元/ 组/ X/ +/ ,/ MX/ +/ ,/ MX/ -/ ,/ FX/ +/ ,/ UX/ 点/ P/ 传递/ 给/ 其父/ 节点/ ,/ 其中/ X/ +/ 表示/ 当前/ 加入/ 的/ x/ 顶点/ ,/ MX/ +/ 和/ MX/ -/ 分别/ 表示/ 加入/ 和/ 移除/ 出/ MXP/ 集合/ 的/ x/ 顶点/ ,/ FX/ +/ 和/ UX/ +/ 类似/ 定义/ ./ 五元/ 组中/ 元素/ 的/ 值/ 可能/ 为空/ ,/ 用/ 符号/ Λ/ 表示/ ./ 5.1/ ./ 1/ 叶子/ 节点/ 中/ 加入/ x/ 算法/ 1/ 是/ 在/ 一个/ 叶子/ 节点/ 中/ 操作/ ./ 令/ 加入/ 的/ x/ 顶点/ 为/ x/ ^/ ,/ 根据/ x/ ^/ ./ s/ 来/ 定位/ 到/ 相应/ 的/ 叶子/ 节点/ P/ (/ 因为/ / x/ ∈/ XP/ ,/ x/ ./ s/ =/ x/ ^/ ./ s/ =/ YP/ ./ min/ )/ ./ 若/ x/ ^/ ./ e/ >/ YP/ ./ max/ ,/ x/ ^/ 属于/ FXP/ 集合/ ./ 否则/ ,/ 在/ α/ 树中/ 查找/ α/ Postx/ ^/ ./ e/ ,/ MXr/ 则/ MXr/ 存在/ ,/ 则/ 可/ 根据/ 其值/ 来/ 确定/ 可/ 替换/ 集/ RSx/ ^/ ,/ (/ )/ P/ ./ 进而/ 在/ 该/ 叶子/ 节点/ 中/ 维护/ 循环/ 不变式/ ,/ 即/ 维护/ 相对/ 应于/ 该/ 节点/ 子图/ GP/ ^/ +/ x/ ^/ 的/ 最优/ X/ 匹配/ 集/ ./ 上述情况/ 都/ 涉及/ 相关/ 的/ 辅助/ 集合/ 更新/ 以及/ 相应/ 的/ msg/ 消息/ 的/ 赋值/ ;/ 若/ P/ 有父/ 节点/ ,/ 则/ msg/ 作为/ 参数/ 向上/ 传递/ ./ 算法/ 1/ ./ InsertXinLeafx/ (/ )/ ^/ ./ 输入/ :/ 新/ 加入/ 的/ x/ 顶点/ 输出/ :/ msg/ 消息/ 1/ ./ XP/ ←/ XP/ +/ x/ ^/ ,/ msg/ ./ X/ +/ ←/ x/ ^/ 2/ ./ IFx/ ^/ ./ e/ >/ YP/ ./ 3/ ./ FXP/ ←/ FXP/ +/ x/ ^/ ,/ msg/ ./ FX/ +/ ←/ x/ ^/ 4/ ./ ELSEIF/ // / α/ Postx/ ^/ ./ e/ ,/ MXr5/ ./ MXr6/ ./ ELSE7/ ./ α/ ←/ MXr8/ ./ RSx/ ^/ ,/ (/ )/ P/ ←/ {/ x/ ∈/ MXr9/ ./ rx/ ←/ minwx/ ∈/ RSx/ ^/ ,/ (/ )/ P/ ∪/ x10/ ./ MXr11/ ./ msg/ ./ MX/ +/ ←/ x/ ^/ ,/ msg/ ./ MX/ -/ ←/ msg/ ./ UX/ +/ ←/ rx12/ ./ RETURNmsg/ 以下/ 定理/ 保证/ 了/ 算法/ 1/ 的/ 正确性/ ./ 定理/ 2/ ./ 算法/ InsertXinLeaf/ (/ x/ ^/ )/ 在/ 二叉/ 计算/ 树中/ 的/ 叶子/ 节点/ 中/ 维护/ 了/ 循环/ 不变式/ ,/ 时间/ 复杂度/ 为/ Olog/ (/ 证明/ ./ 叶子/ 节点/ P/ 中/ ,/ YlMXrP/ ./ 已知/ 加入/ x/ ^/ 之前/ MXP/ 是子/ 图/ GP/ ^/ =/ G/ [/ (/ XP/ -/ FXP/ )/ ∪/ YP/ ]/ 中/ 的/ 最优/ X/ 匹配/ 集/ ,/ 现/ 证明/ 加入/ x/ ^/ 之后/ MXP/ 是子/ 图/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ +/ x/ )/ ∪/ Y/ 优/ X/ 匹配/ 集/ ./ 根据/ 引理/ 3/ ,/ 通过/ α/ Postx/ ^/ ./ e/ ,/ MXr/ 算/ 结果/ ,/ 即可/ 判断/ x/ ^/ 是否/ 可/ 增广/ MXP/ ./ 若/ 不能/ 增广/ ,/ 则/ 可/ 通过/ MXrRSx/ ^/ ,/ (/ )/ P/ (/ MXr/ 论/ 2/ ,/ 从中/ 替换/ weight/ -/ id/ 序列/ 排序/ 下/ 的/ 最小/ 元素/ 即可/ 求解/ 最优/ X/ 匹配/ 集/ ./ 根据/ 引理/ 5/ ,/ 在/ 算法/ 1/ 中/ ,/ 每/ 一步/ 的/ 操作/ 都/ 可/ 基于/ 辅助/ 集合/ 对应/ 的/ 树结构/ 在/ 对数/ 时间/ 复杂度/ 下/ 实现/ ,/ 故而/ 在/ 叶子/ 节点/ 中/ 加入/ x/ 的/ 操作/ 可/ 在/ 对数/ 时间/ 复杂度/ 实现/ ./ 若/ 加入/ 的/ x/ ^/ 的/ x/ ^/ ./ s/ / {/ x/ ./ s/ :/ X/ -/ x/ ^/ }/ ,/ 则/ 二叉/ 计算/ 树/ 的/ 结构/ 会/ 发生变化/ ,/ 产生/ 新/ 的/ 叶子/ 节点/ ,/ 而/ Page11/ 调整/ 平衡/ 操作/ 的/ 开销/ 使得/ 算法/ 效率/ 成为/ 平摊/ 时间/ 复杂度/ ./ 5.1/ ./ 2/ 中间/ 结点/ 中/ 加入/ x/ 在/ 二叉/ 计算/ 树中/ ,/ 添加/ x/ 顶点/ 的/ 动态/ 更新/ 算法/ 是/ 以/ 自下而上/ 的/ 方式/ 进行/ 计算/ ,/ 即/ 沿着/ 某个/ 叶子/ 节点/ 到/ 根/ 节点/ 的/ 路径/ 进行/ 计算/ ./ 考虑/ 从右/ 孩子/ R/ 到父/ 节点/ P/ 的/ 路径/ ,/ 算法/ 2/ 描述/ 了/ 在/ 这种/ 情况/ 下/ 在/ P/ 中/ 加入/ x/ 节点/ x/ ^/ 的/ 更新/ 操作/ ./ 算法/ 2/ ./ InsertXinR2P/ (/ msg/ )/ ./ 输入/ :/ msg/ 消息/ 输出/ :/ msg/ 消息/ 1/ ./ x/ ^/ ←/ msg/ ./ X/ +/ 2/ ./ IFx/ ^/ ./ e/ >/ YP/ ./ 3/ ./ FXP/ ←/ FXP/ +/ x/ ^/ 4/ ./ ELSEIF/ (/ msg/ ./ UX/ +/ =/ x/ ^/ |/ |/ msg/ ./ UX/ +/ ∈/ MXr5/ ./ P/ 节点/ 中/ 集合/ 更新/ 以及/ msg/ 设置/ 均/ 与/ R/ 节点/ 相同/ 6/ ./ ELSEIF/ // / α/ Post/ (/ x/ ^/ ./ e/ ,/ MXr7/ ./ MXr8/ ./ ELSE9/ ./ α/ ←/ MXr10/ ./ x1/ ←/ minsx/ ∈/ MXr11/ ./ β/ ←/ MXl12/ ./ RSx/ ^/ ,/ (/ )/ P/ ←/ {/ x/ ∈/ MXl13/ ./ rx/ ←/ minwx/ ∈/ RSx/ ^/ ,/ (/ )/ P/ ∪/ x14/ ./ 更新/ 相关/ 辅助/ 集合/ 与/ msg15/ ./ RETURNmsg/ 以下/ 定理/ 保证/ 了/ 算法/ 2/ 的/ 正确性/ ./ 定理/ 3/ ./ 对于/ 从右/ 孩子/ R/ 到父/ 节点/ P/ 的/ 情况/ ,/ 算法/ InsertXinR2P/ (/ msg/ )/ 在/ 节点/ P/ 中/ 维护/ 了/ 循环/ 不变式/ ,/ 时间/ 复杂度/ 为/ Olog/ (/ 证明/ ./ 中间/ 节点/ P/ 中/ ,/ MXP/ =/ MXl/ 已知/ 加入/ x/ ^/ 之前/ MXP/ 是子/ 图/ GP/ ^/ =/ G/ [/ (/ XP/ -/ FXP/ )/ ∪/ YP/ ]/ 中/ 的/ 最优/ X/ 匹配/ 集/ ,/ 现/ 证明/ 加入/ x/ ^/ 之后/ MXP/ 是子/ 图/ GP/ ^/ =/ G/ (/ XP/ -/ FXP/ +/ x/ )/ ∪/ Y/ 配集/ ./ 与/ 叶子/ 节点/ 类似/ ,/ 若/ x/ ^/ ./ e/ >/ YP/ ./ max/ ,/ x/ ^/ 属于/ FXP/ 集合/ ./ 若/ x/ ^/ ./ e/ / YP/ ./ max/ ,/ 有/ 两种/ 情况/ 下/ P/ 节点/ 中/ 的/ 操作/ 与/ R/ 节点/ 相同/ ,/ 故可/ 直接/ 根据/ 消息/ 中/ 的/ 信息/ 来/ 计算/ ./ 第/ 1/ 种/ 情况/ 是/ msg/ ./ UX/ +/ =/ x/ ^/ ,/ 表明/ x/ ^/ 不能/ 增广/ MXR/ ,/ 且/ 在/ weight/ -/ id/ 序列/ 下/ ,/ x/ ^/ 小于/ R/ 中/ x/ ^/ 的/ 可/ 替换/ 集中/ 的/ 最小/ 元素/ ./ 可/ 证明/ 若/ x/ ^/ 在/ 孩子/ 节点/ 中/ 不能/ 增广/ 匹配/ ,/ 则/ 在/ 父/ 节点/ 中/ 也/ 不能/ 增广/ 匹配/ ,/ 且/ x/ ^/ 的/ 可/ 替换/ 集/ 的/ 最小/ 元素/ 单调/ 递增/ ./ 故而/ 在/ P/ 节点/ x/ ^/ 仍然/ 替换/ x/ ^/ 自身/ ,/ 与/ R/ 节点/ 相同/ ./ 第/ 2/ 种/ 情况/ 是/ msg/ ./ UX/ +/ ∈/ MXr/ 节点/ 中/ x/ ^/ 替换/ x/ =/ msg/ ./ UX/ +/ ,/ 且/ 可/ 推知/ x/ ^/ 的/ 可/ 替换/ 集在/ P/ 中/ 与/ R/ 中/ 相同/ ,/ 故而/ P/ 节点/ 中/ x/ ^/ 仍然/ 替换/ x/ ,/ 与/ R/ 节点/ 相同/ ./ 若/ 上述/ 两种/ 情况/ 都/ 不/ 满足/ ,/ 即/ msg/ ./ UX/ +/ =/ Λ/ 或者/ msg/ ./ UX/ +/ ≠/ x/ ^/ &&/ msg/ ./ UX/ +/ / MXr/ 情况/ 下/ ,/ 若/ P/ 中/ 存在/ α/ Postx/ ^/ ./ e/ ,/ MXr/ 存在/ x/ ∈/ FXL/ 加入/ 到/ 图/ GMXr/ 和/ x/ ^/ 之间/ 存在/ 一条/ 交错/ 路/ ./ 故而/ 根据/ 引理/ 3/ ,/ x/ ^/ 不可/ 增广/ MXr/ 集/ ./ 考虑/ 若/ P/ 中/ 不/ 存在/ α/ Postx/ ^/ ./ e/ ,/ MXr/ 设/ x/ ^/ 在/ P/ 中/ 不可/ 增广/ 匹配/ ,/ 因为/ msg/ ./ UX/ +/ =/ Λ/ ,/ 即/ x/ ^/ 在/ R/ 中/ 可/ 增广/ 匹配/ ,/ 则/ 在/ P/ 中必/ 存在/ x/ ∈/ FXL/ 加入/ 到/ 图/ GMXr/ 一条/ 交错/ 路/ ,/ 根据/ 引理/ 3/ ,/ 存在/ α/ -/ MX/ 紧致点/ i/ 且/ [/ ]/ Yi/ / x/ ^/ ./ e/ ,/ 与/ 前提/ 矛盾/ ,/ 故而/ 若/ P/ 中/ 不/ 存在/ (/ x/ ^/ ./ e/ ,/ MXr/ α/ Post/ 的/ 分析/ 类似/ ./ 因此/ ,/ 通过/ α/ Postx/ ^/ ./ e/ ,/ MXrP/ )/ 即可/ 求解/ x1/ 在/ GMXl/ 在/ P/ 中/ 是否/ 可/ 增广/ 匹配/ ;/ 若/ 不可/ 增广/ ,/ 根据/ 引理/ 3/ ,/ 通过/ MXrP/ ]/ 中/ 的/ 可/ 替换/ 集/ ,/ 并/ 在/ 其中/ 取/ x/ ./ s/ 最小/ 的/ 元素/ x1/ ,/ Yr/ 且/ 可/ 推知/ x1/ ./ s/ </ YP/ ./ mid/ ./ 由/ 引理/ 4/ ,/ 根据/ β/ PreMXl/ 由/ / 2/ 可/ 推知/ ,/ 在/ MXlx/ ./ e/ >/ α/ ,/ 意味着/ x1/ 在/ GMXl/ 与/ x/ ^/ 的/ 相同/ ,/ 于是/ x/ ^/ 在/ P/ 中/ 的/ 可/ 替换/ 集/ RSx/ (/ )/ ^/ 可/ 确定/ ./ 根据/ 推论/ 2/ ,/ 从/ RSx/ (/ )/ ^/ ∪/ x/ ^/ 中/ 替换/ weight/ -/ id/ 序列/ 排序/ 下/ 的/ 最小/ 元素/ 即可/ 求解/ 对应/ 于子/ 图/ GP/ ^/ 的/ 最优/ X/ 匹配/ 集/ ./ 需注意/ 的/ 是/ ,/ 在/ 更新/ 相关/ 辅助/ 集合/ 时/ ,/ 需/ 维护/ 不变式/ / 2/ ./ 根据/ 引理/ 5/ ,/ 在/ 算法/ 2/ 中/ ,/ 每/ 一步/ 的/ 操作/ 都/ 可/ 基于/ 辅助/ 集合/ 对应/ 的/ 树结构/ 在/ 对数/ 时间/ 复杂度/ 下/ 实现/ ,/ 故而/ 在/ 从/ 右/ 孩子/ 到父/ 节点/ 的/ 情况/ 加入/ x/ 顶点/ 的/ 动态/ 操作/ 可/ 在/ Olog/ |/ V/ (/ 考虑/ 从/ 左/ 孩子/ L/ 到父/ 节点/ P/ 的/ 路径/ ,/ 算法/ 3/ 描述/ 了/ 此时/ 在/ P/ 中/ 加入/ x/ 顶点/ x/ ^/ 的/ 动态/ 更新/ 操作/ ./ 算法/ 3/ ./ InsertXinL2Pms/ (/ )/ g/ ./ 输入/ :/ msg/ 消息/ 输出/ :/ msg/ 消息/ 1/ ./ x/ ^/ ←/ msg/ ./ X/ +/ 2/ ./ IFx/ ^/ ./ e/ >/ YP/ ./ 3/ ./ FXP/ ←/ FXP/ +/ x/ ^/ Page124/ ./ ELSEIFmsg/ ./ UX/ +/ =/ x/ ^/ |/ |/ msg/ ./ UX/ +/ ∈/ MXr5/ ./ P/ 节点/ 中/ 集合/ 更新/ 以及/ msg/ 设置/ 均/ 与/ L/ 节点/ 相同/ 6/ ./ ELSEIF/ (/ // / β/ Pre/ (/ x/ ^/ ./ s/ ,/ MXl7/ ./ MXl8/ ./ ELSE9/ ./ β/ ←/ MXl10/ ./ x1/ ←/ maxex/ ∈/ MXl11/ ./ α/ ←/ MXr12/ ./ x2/ ←/ minsx/ ∈/ MXr13/ ./ IFx2/ ./ s/ </ β/ (/ 14/ ./ β/ ←/ MXl15/ ./ RSx/ ^/ ,/ (/ )/ P/ ←/ {/ x/ ∈/ MXl16/ ./ rx/ ←/ minwx/ ∈/ RSx/ ^/ ,/ (/ )/ P/ ∪/ x17/ ./ 更新/ 相关/ 辅助/ 集合/ 与/ msg18/ ./ RETURNmsg/ 以下/ 定理/ 保证/ 了/ 算法/ 3/ 的/ 正确性/ ./ 定理/ 4/ ./ 对于/ 从/ 左/ 孩子/ L/ 到父/ 节点/ P/ 的/ 情况/ ,/ 算法/ InsertXinL2P/ (/ msg/ )/ 在/ 节点/ P/ 中/ 维护/ 了/ 循环/ 不变式/ ,/ 时间/ 复杂度/ 为/ Olog/ (/ 证明/ ./ 除了/ 对于/ 可/ 替换/ 集/ 的/ 求解/ ,/ 算法/ 3/ 与/ 从/ 右/ 孩子/ 到父/ 节点/ 的/ 算法/ 2/ 情形/ 类似/ ./ 下面/ 仅/ 证明/ 算法/ 3/ 中/ 求解/ 可/ 替换/ 集/ 的/ 过程/ ./ 若在子/ 图/ G/ [/ MXlP/ ]/ 中/ 存在/ β/ Prex/ ^/ ./ s/ ,/ MXlYl/ 集合/ {/ x/ ∈/ MXl/ 中/ 的/ 可/ 替换/ 集/ ,/ 选取/ 其中/ end/ -/ id/ 排序/ 下/ 最大/ 的/ 元素/ x1/ ./ 可/ 证明/ ,/ x1/ ./ e/ / YP/ ./ mid/ ,/ 且子/ 图/ GMXr/ 必然/ 存在/ x1/ 的/ α/ -/ MX/ 最小/ 紧致点/ ./ 再/ 根据/ 引理/ 4/ ,/ 通过/ α/ =/ MXr/ 图/ G/ [/ MXr/ α/ }/ ,/ 该/ 集合/ 也/ 即/ x/ ^/ 在子/ 图/ G/ [/ MXr/ 换集/ ./ 若该/ 集合/ 中/ 按/ start/ -/ id/ 排序/ 下/ 最小/ 的/ 元素/ x2/ 的/ x2/ ./ s/ </ β/ ,/ 即/ 存在/ 一条/ 从/ x/ ^/ 出发/ 的/ 交错/ 路/ 可达/ 小于/ β/ 的/ y/ 顶点/ ,/ 需/ 根据/ x2/ ./ s/ 更新/ β/ ,/ 进而/ 求解/ 出/ x/ ^/ 在/ P/ 中/ 的/ 可/ 替换/ 集/ RSx/ (/ )/ ^/ ./ 与/ 从/ R/ 到/ P/ 的/ 计算/ 类似/ ,/ 更新/ 辅助/ 集合/ 时需/ 维护/ 不变式/ / 2/ ./ 根据/ 引理/ 5/ ,/ 在/ 算法/ 3/ 中/ ,/ 每/ 一步/ 的/ 操作/ 都/ 可/ 基于/ 辅助/ 集合/ 对应/ 的/ 树结构/ 在/ 对数/ 时间/ 复杂度/ 下/ 实现/ ,/ 故而/ 在/ 从/ 左/ 孩子/ 到父/ 节点/ 的/ 情况/ 下/ ,/ 在/ 节点/ P/ 中/ ,/ insertx/ (/ )/ ^/ 操作/ 的/ 时间/ 复杂度/ 为/ Olog/ (/ 5.1/ ./ 3/ 算法/ 实例/ 图/ 6/ 为/ 一个/ 顺次/ 加入/ 的/ x/ 顶点/ 的/ 四元组/ 信息/ ,/ 中间/ 的/ 3/ 个/ 方框/ 代表/ 二叉/ 计算/ 树中/ 的/ 树/ 节点/ ,/ 节点/ 旁边/ 列出/ 了/ 相应/ 的/ 辅助/ 集合/ ./ 设/ 初始状态/ 存在/ 4/ 个/ y/ 顶点/ ,/ 对应/ 计算/ 树中/ 唯一/ 的/ 节点/ P/ ./ 当/ 加入/ 第一个/ x/ 顶点/ x1/ 时/ ,/ 因为/ x1/ ./ s/ =/ 3/ ≠/ YP/ ./ min/ =/ 1/ ,/ P/ 节点/ 分裂/ 并/ 生成/ 新/ 的/ 叶子/ 节点/ L/ 和/ R/ ./ 算法/ 1/ 先/ 尝试/ 在/ R/ 节点/ 中/ 加入/ x1/ ,/ 根据/ α/ 树/ 计算/ 得出/ 不/ 存在/ x1/ ./ e/ 的/ α/ Postx1/ 在/ R/ 中/ 成功/ 增广/ 匹配/ ,/ 加入/ X/ 匹配/ 集/ MXr/ 步/ ,/ 因为/ R/ 是/ P/ 的/ 右/ 孩子/ ,/ 调用/ 算法/ 2/ ,/ 尝试/ 在/ P/ 节点/ 加入/ x1/ ;/ 由于/ P/ 节点/ 中/ 同样/ 不/ 存在/ x1/ ./ e/ 的/ α/ Post/ 致点/ ,/ 故而/ x1/ 增广/ X/ 匹配/ 集/ MXr/ 类似/ 的/ ,/ x2/ ,/ x3/ ,/ x4/ 都/ 顺次/ 成功/ 加入/ P/ 的/ X/ 匹配/ 集中/ ;/ 其中/ x4/ 在/ 节点/ L/ 中/ 进入/ FXL/ 集合/ ,/ 因为/ x4/ ./ e/ =/ 4/ >/ YL/ ./ max/ =/ 2/ ,/ 再/ 根据/ 算法/ 3/ ,/ 在/ P/ 节点/ x4/ 增广/ 匹配/ 成功/ ./ 对于/ x5/ ,/ 算法/ 1/ 在/ R/ 中/ 尝试/ 添加/ x5/ ;/ 根据/ α/ 树/ 计算/ α/ PostR/ )/ =/ {/ x1/ }/ ;/ 由于/ x1/ ./ w/ =/ 7/ >/ x5/ ./ w/ =/ 5/ ,/ 故而/ rx/ =/ x5/ ,/ R/ 中/ 匹配/ 未/ 增广/ 成功/ ,/ x5/ 被/ 加入/ UXR/ 集合/ ./ 继而/ 算法/ 2/ 在/ P/ 节点/ 尝试/ 加入/ x5/ ,/ 由于/ msg/ ./ UX/ +/ =/ x/ ^/ =/ x5/ ,/ 在/ P/ 节点/ 中/ 仍然/ 不能/ 增广/ 匹配/ ,/ x5/ 加入/ UXP/ 集合/ ./ 下面/ 描述/ 加入/ x6/ 的/ 过程/ ,/ 图/ 6/ 中/ 节点/ P/ 和/ R/ 的/ 辅助/ 集合/ 中/ 的/ 箭头/ 分别/ 指出/ 在/ 此/ 过程/ 中/ 集合/ 的/ 变化/ 情况/ ./ 首先/ 根据/ x6/ ./ s/ 定位/ 到/ R/ 节点/ ,/ 根据/ 算法/ 1/ ,/ 在/ R/ 节点/ 加入/ x6/ 成功/ ./ 继而/ 调用/ 算法/ 2/ ,/ 在/ P/ 节点/ 中/ 加入/ x6/ ./ 根据/ α/ 树/ 计算/ 可/ 得/ α/ Postx6/ ./ s/ ,/ MXr/ 侧/ 的/ 可/ 替换/ 集中/ 找到/ x/ ./ s/ 最小/ 的/ x/ 顶点/ x4/ (/ 参考/ 算法/ 2/ 第/ 10/ 行和图/ 7/ )/ ,/ 计算/ β/ Prex4/ ./ s/ ,/ MXlPage13/ 出/ 可/ 替换/ 集/ RSx6/ ,/ (/ weight/ -/ id/ 排序/ 最小/ 的/ x/ 顶点/ 为/ x2/ ,/ 故而/ x6/ 在/ P/ 的/ X/ 匹配/ 集中/ 替换/ x2/ ./ 6/ 算法/ 复杂度/ 分析/ 与/ 实验/ 仿真/ 在/ 维护/ 最优/ X/ 匹配/ 集/ 的/ 基础/ 上/ ,/ 动态/ 查询/ 操作/ 可/ 采用/ 文献/ [/ 17/ ]/ 或/ [/ 23/ ]/ 中/ 的/ 方法/ 求解/ ./ 我们/ 基于/ 文献/ [/ 23/ ]/ 中/ 的/ 分离/ 匹配/ 区间/ (/ disjointmatchinginterval/ )/ 方法/ ,/ 在/ 最坏/ (/ )/ Ok/ 时间/ 复杂度/ 下/ 求解/ 动态/ 查询/ 操作/ ,/ 其中/ k/ / minX/ ,/ {/ 算法/ ,/ 我们/ 给出/ 以下/ 定理/ ./ 定理/ 5/ ./ 左侧/ 带权/ 凸/ 二分/ 图/ 的/ 最大/ 权值/ 动态/ 匹配/ 问题/ 可/ 在/ Olog2/ (/ 更新/ 操作/ ,/ 在/ 常数/ 时间/ 复杂度/ 下/ 查询/ 是否/ 匹配/ ,/ 在/ 最坏/ (/ )/ Ok/ 时间/ 复杂度/ 下/ 查询/ 某/ 已/ 匹配/ 节点/ 的/ 相匹配/ 节点/ ,/ 其中/ k/ / minX/ ,/ {/ 证明/ ./ 根据/ 定理/ 2/ ~/ 4/ ,/ 算法/ 中/ 每/ 一步/ 操作/ 都/ 可/ 基于/ 辅助/ 集合/ 对应/ 的/ 树结构/ 在/ 对数/ 时间/ 复杂度/ 下/ 实现/ ,/ 故而/ 在/ 中间/ 节点/ 中/ 加入/ x/ 的/ 操作/ 在/ 对数/ 时间/ 复杂度/ 实现/ ./ 加入/ x/ 顶点/ 的/ 计算/ 包含/ 至多/ logV/ 次/ 加入/ 二叉/ 计算/ 树中/ 某/ 节点/ 的/ 操作/ ,/ 因此/ 可/ 在/ O/ (/ log2/ |/ V/ |/ )/ 平摊/ 时间/ 复杂度/ 下/ 求解/ ./ 其他/ 动态/ 操作/ 同理/ 可/ 在/ 相同/ 时间/ 复杂度/ 下/ 进行/ 维护/ ./ 针对/ 不带/ 权凸/ 二分/ 图/ 的/ 最大/ 基数/ 动态/ 匹配/ 问题/ ,/ 文献/ [/ 17/ ]/ 设计/ 了/ 一种/ 算法/ 在/ Olog2/ (/ 复杂度/ 下/ 维护/ 更新/ 操作/ ,/ 在/ 最坏/ 常数/ 时间/ 复杂度/ 下/ 查询/ 某/ 顶点/ 是否/ 已/ 匹配/ ,/ 查询/ 某/ 已/ 匹配/ 顶点/ 的/ 相匹配/ 顶点/ 操作/ 的/ 最坏/ 时间/ 复杂度/ 为/ O/ (/ min/ {/ klog2/ |/ X/ |/ +/ log/ |/ X/ |/ ,/ |/ X/ |/ log/ |/ X/ |/ }/ )/ ,/ 其中/ k/ </ min/ {/ |/ X/ |/ ,/ |/ Y/ |/ }/ ,/ 或者/ 为/ O/ 槡/ Xlog2/ 权凸/ 二分/ 图/ 的/ 最大/ 权值/ 动态/ 匹配/ 问题/ 之前/ 一直/ 未/ 被/ 解决/ ,/ 直到/ 我们/ 在/ 文献/ [/ 23/ ]/ 中/ 提出/ 一种/ 方法/ 在/ Olog3/ (/ 坏/ (/ )/ Ok/ 时间/ 复杂度/ 下/ 维护/ 查询/ 操作/ ,/ 其中/ k/ / minX/ ,/ {/ 下面/ 的/ 表/ 2/ 中/ ,/ 呈现/ 了/ 文献/ [/ 17/ ,/ 23/ ]/ 和/ 本文/ 的/ 工/ 研究/ 问题/ 凸/ 二分/ 图/ 动态/ 最大/ 基数/ 匹配/ 动态/ 更新/ Olog2/ (/ 摊/ 时间/ 动态/ 查询/ 最坏/ 接近/ 线性/ 时间/ 作/ 结果/ 的/ 时间/ 复杂度/ 比较/ ./ 本文/ 基于/ C++/ 实现/ 了/ 左侧/ 带权/ 凸/ 二分/ 图/ 的/ 最大/ 权值/ 动态/ 匹配/ 算法/ ./ 实验/ 评估/ 过程/ 运行/ 在/ 一台/ Lenovo/ -/ X1/ 笔记本/ 上/ ,/ 其/ CPU/ 型号/ 为/ IntelCorei5/ -/ 5200/ ,/ 主频/ 2.2/ GHz/ ,/ 内存/ 8GB/ ,/ 操作系统/ 是/ 64/ 位/ Windows8/ ,/ 程序运行/ 环境/ 是/ VisualStudio2013/ ./ 其中/ 数据/ 集是/ 随机/ 生成/ ./ 图/ 8/ 显示/ 了/ 运行/ 的/ 结果/ ,/ 其中/ 横坐标/ 表示/ 当前/ 图/ 的/ 规模/ ,/ 如/ 1000/ 表示/ 图中/ 含有/ 1000/ 个/ x/ 节点/ 和/ 1000/ 个/ y/ 顶点/ ,/ 纵坐标/ 表示/ 在/ 当前/ 规模/ 的/ 图上/ ,/ 新/ 加入/ 一个/ x/ 节点/ 所花/ 的/ 时间/ ,/ 单位/ 是/ ms/ ./ 7/ 结论/ 本文/ 研究/ 左侧/ 带权/ 凸/ 二分/ 图/ 的/ 最大/ 权值/ 动态/ 匹配/ 问题/ ./ 发现/ 该/ 问题/ 的/ 求解/ 的/ 关键在于/ 维护/ 最优/ X/ 匹配/ 集/ 以及/ 求解/ 可/ 替换/ 集合/ ,/ 提出/ 紧致子/ 图/ 的/ 概念/ ,/ 证明/ 可/ 替换/ 集合/ 的/ 求解/ 等价/ 于/ 紧致子/ 图/ 的/ 求解/ ,/ 将/ 求解/ 匹配/ 问题/ 转换/ 成为/ 求解/ 子图/ 问题/ ./ 同时/ 研究/ 凸/ 二分/ 图/ 结构/ 中/ 的/ 凸/ 性质/ ,/ 找到/ 一种/ 快速/ 求解/ 该子/ 图/ 的/ 方法/ ./ 在/ 此基础/ 之上/ ,/ 基于/ 改进/ 的/ 二叉/ 计算/ 树/ 数据结构/ 和/ 隐性/ 表征/ 技术/ ,/ 设计/ 算法/ 在/ Olog2/ (/ 摊/ 时间/ 下/ 维护/ 图/ 的/ 更新/ 操作/ ,/ 在/ 最坏/ 线性/ 时间/ 复杂度/ 下/ 支持/ 顶点/ 匹配/ 信息/ 的/ 查询/ 操作/ ./ 进而/ 在/ 与/ 文献/ [/ 17/ ]/ 解决/ 不带权/ 问题/ 的/ 相同/ 时间/ 复杂度/ 下/ ,/ 解决/ 了/ 难度/ 更/ 高/ 的/ 左侧/ 带权/ 问题/ ./ 

