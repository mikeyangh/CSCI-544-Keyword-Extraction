Page1/ 适用/ 于/ 广播/ 监视/ 的/ 视频/ 水印/ 协议/ 刘丽/ 1/ )/ 赵学民/ 1/ )/ 彭代渊/ 2/ )/ 高悦翔/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 郑州/ 航空工业/ 管理/ 学院/ 计算机科学/ 与/ 应用/ 系/ 郑州/ 450015/ )/ 2/ )/ (/ 西南/ 交通/ 大学/ 信息科学/ 与/ 技术/ 学院/ 成都/ 610031/ )/ 3/ )/ (/ 四川/ 师范大学/ 计算机科学/ 学院/ 成都/ 610068/ )/ 摘要/ 数字水印/ 技术/ 被/ 广泛应用/ 于/ 多媒体/ 版权保护/ 、/ 广播/ 监视/ 等/ 领域/ 中/ ./ 在/ 广播/ 监视/ 中/ ,/ 广告商/ 首先/ 在/ 他/ 的/ 广告/ 中/ 嵌入/ 水印/ 信息/ ,/ 之后/ 把/ 该/ 广告/ 发送给/ 广播/ 电视台/ ./ 为了/ 防止/ 双方/ 可能/ 产生/ 的/ 欺诈/ ,/ 对/ 一段/ 广告/ 、/ 嵌入/ 的/ 水印/ 能够/ 做出/ 双重/ 认证/ 是/ 必不可少/ 的/ ./ 论文/ 就/ 双重/ 认证/ 提出/ 了/ 一种/ 适合/ 应用/ 在/ 广播/ 监视/ 中/ 的/ 协议/ ,/ 该/ 协议/ 在/ 加密/ 域/ 完成/ 水印/ 的/ 产生/ 和/ 嵌入/ ./ 协议/ 在/ 加密/ 时/ 应用/ 一种/ 同态/ 公钥/ 密码/ 技术/ ,/ 同时/ 利用/ 嵌入/ 的/ 信息/ 绑定/ 广告/ 、/ 嵌入/ 的/ 水印/ 和/ 本次/ 交易/ ./ 应用/ 提出/ 的/ 协议/ ,/ 最/ 常见/ 的/ 问题/ 如/ 消费者/ 的/ 权利/ 问题/ 和/ 非/ 绑定/ 问题/ 都/ 可以/ 被/ 解决/ ,/ 甚至/ 广告商/ 或/ 广播/ 电视台/ 的/ 欺诈/ 行为/ 也/ 可以/ 预防/ ./ 关键词/ 鲁棒/ 水印/ ;/ 广播/ 监视/ ;/ 水印/ 协议/ ;/ 同态/ 公钥/ 密码/ 1/ 引言/ 在/ 当今社会/ ,/ 几乎/ 所有/ 行业/ 数字/ 产品/ 的/ 广播/ 都/ 是/ 通过/ 电视广播/ 进行/ 的/ ,/ 例如/ 新闻/ 、/ 电影/ 、/ 广告/ 等/ 传媒/ 行业/ 以及/ 其它/ 许多/ 行业/ ./ 电视广播/ 是/ 分/ 时段/ 的/ ,/ 且/ 某些/ 时段/ 的/ 购买/ 费用/ 相当/ 高/ ,/ 因此/ ,/ 在/ 广播/ 监视/ 环境/ 中/ ,/ 对于/ 广告/ 客户/ 自己/ 拥有/ 的/ 从/ 广播公司/ 买下/ 的/ 全部/ 广告/ 时间/ 是/ 必须/ 要/ 确认/ 的/ ./ 与此同时/ ,/ 广告公司/ 付给/ 演员/ 应得/ 的/ 版税/ 也/ 是/ 要/ 确保/ 的/ ./ 另外/ ,/ 对/ 持有/ 作品版权/ 的/ 人/ 来说/ ,/ 也/ 不会/ 被/ 侵权/ 电台/ 非法/ 转播/ 他们/ 的/ 所有物/ ./ 数字水印/ 可以/ 用来/ 加密/ 鉴别信息/ ,/ 它/ 可以/ 应用/ 在/ 广播/ 监视/ 中/ ./ 欧洲/ 有/ 一个/ ESPRIT/ 项目/ —/ —/ —/ VIVA/ (/ VisualIdentityVerificationAuditor/ )/ ①/ ,/ 该/ 项目/ 是/ 研究/ 在/ 专业/ 的/ 电视广播/ 监视系统/ [/ 1/ -/ 2/ ]/ 中/ 运用/ 数字水印/ 技术/ ./ 但是/ ,/ 简单/ 的/ 水印/ 不足以/ 作为/ 合法/ 的/ 证据/ 指控/ 有/ 责任/ 方/ ,/ 必须/ 要/ 有/ 一个/ 性能/ 良好/ 的/ 水印/ 协议/ 与/ 之/ 配合/ 才/ 可以/ 指控/ 责任/ 方/ ./ 在/ 水印/ 框架/ 中/ 引入/ 水印/ 协议/ 最先/ 是/ 由/ Qiao/ 等/ 人/ 在/ 文献/ [/ 3/ ]/ 中/ 提出/ 的/ ,/ 其/ 主要/ 目的/ 就是/ 解决/ 关于/ 版权/ 所有者/ 问题/ 以及/ 消费者/ 权利/ 保护/ 问题/ ./ 目前/ ,/ 已有/ 研究/ 人员/ 提出/ 了/ 一些/ 水印/ 协议/ ,/ 这些/ 协议/ 都/ 是/ 在/ 现有/ 水印/ 算法/ 的/ 基础/ 上/ 提出/ 的/ ,/ 并且/ 协议/ 中/ 水印/ 的/ 嵌入/ 过程/ 通常/ 在/ 加密/ 域/ 完成/ ./ 在/ 这样/ 的/ 情况/ 下/ ,/ 由于/ 卖方/ 不/ 可能/ 知道/ 准确/ 的/ 水印/ ,/ 所以/ 他/ 不能/ 用/ 这种/ 含水/ 印/ 的/ 副本/ 去/ 鉴别/ 买方/ ./ 假如/ 买方/ 分发/ 了/ 一个/ 非法/ 复制品/ ,/ 这个/ 复制品/ 只要/ 被/ 察觉/ ,/ 卖方/ 就/ 可以/ 证明/ 买方/ 有罪/ ./ Memon/ 和/ Wong/ 在/ 文献/ [/ 4/ ]/ 中/ 提出/ 一种/ 水印/ 协议/ ,/ 该/ 协议/ 最早/ 解决/ 了/ 消费者/ 权利/ 问题/ ,/ 然而/ 它/ 仍然/ 存在/ 缺陷/ :/ 该/ 协议/ 不能/ 解决/ 非/ 绑定/ 问题/ ,/ 它/ 不能/ 将/ 待/ 嵌入/ 的/ 水印/ 信息/ 、/ 原始/ 载体/ 和/ 本次/ 交易/ 绑定/ 在/ 一起/ ./ 所以/ 就/ 会/ 出现/ 这样/ 一种/ 情况/ :/ 如果/ 卖方/ 从/ 市场/ 上/ 发现/ 了/ 一个/ 盗版/ 作品/ ,/ 他/ 可以/ 从/ 该/ 作品/ 中/ 提取/ 水印/ ,/ 并/ 将/ 其/ 嵌入/ 到/ 一个/ 价格不菲/ 的/ 作品/ 中/ ,/ 以/ 获得/ 高额/ 赔付/ ./ 除此之外/ ,/ 此/ 协议/ 在/ 认证/ 仲裁/ 时/ 必须/ 要/ 有/ 买方/ 参与/ ,/ 如果/ 买方/ 不/ 愿意/ 参与/ 仲裁/ ,/ 那么/ 我们/ 就/ 有/ 理由/ 怀疑/ 他/ ./ 这/ 是因为/ 在/ 多数/ 国家/ 的/ 法律/ 文件/ 中/ 规定/ :/ 若/ 被告/ 有罪/ ,/ 原告/ 是/ 有/ 责任/ 去/ 证明/ 的/ ./ 在/ Memon/ 和/ Wong/ 提出/ 的/ 协议/ 中/ ,/ 买方/ 同/ 卖方/ 及/ 水印/ 认证/ 权威机构/ 的/ 通信联系/ 在/ 业务/ 往来/ 的/ 过程/ 中是/ 必不可少/ 的/ ,/ 如此一来/ 就/ 增大/ 了/ 买方/ 的/ 花销/ ./ 为了/ 处理/ 好/ 上面/ 提及/ 的/ 非/ 绑定/ 问题/ ,/ 同时/ 为了/ 保护/ 在/ 业务/ 往来/ 过程/ 中/ 买方/ 的/ 隐私/ ,/ 文献/ [/ 5/ ]/ 中/ 提出/ 一种/ 匿名/ 的/ 水印/ 协议/ ./ 该/ 协议/ 仍/ 有/ 以下/ 缺点/ :/ 两个/ 能够/ 实施/ 安全/ 鲁棒/ 水印/ 程序/ 的/ 可信/ 网络/ 实体/ 是/ 双/ 水印/ 插入/ 的/ 必要条件/ ;/ 双/ 水印/ 的/ 嵌入/ 必将/ 降低/ 媒体/ 的/ 视觉/ // 听觉/ 质量/ ;/ 在/ 适用/ 于/ 版权保护/ 的/ 数字水印/ 技术/ 中/ ,/ 嵌入/ 第二个/ 水印/ 的/ 一方/ 也/ 可以/ 说/ 版权/ 是/ 他/ 的/ ,/ 这/ 就是/ 所谓/ 的/ 歧义/ 攻击/ ./ 基于/ 加/ 同态/ 公钥/ 密码/ 技术/ ,/ Kuribayashi/ 等/ 人/ 在/ 文献/ [/ 6/ ]/ 中/ 提出/ 一种/ 可/ 用于/ 操作/ 跟踪/ 的/ 数字/ 指纹/ 协议/ ;/ 在/ 互联网/ 上/ ,/ 认证/ 中心/ 的/ 数字证书/ 对/ 买方/ 来说/ 是/ 无法/ 获知/ 的/ ,/ 而且/ 买方/ 也/ 不能/ 独立/ 执行/ 一些/ 安全/ 操作/ ,/ 针对/ 此/ 问题/ ,/ 文献/ [/ 7/ ]/ 提出/ 一种/ 保护/ Web/ 内容/ 的/ 水印/ 协议/ ./ 近几年/ 又/ 出现/ 了/ 一些/ 新/ 的/ 水印/ 协议/ [/ 8/ -/ 10/ ]/ ,/ 这些/ 协议/ 有/ 的/ 适合/ 应用/ 于/ 网上交易/ ,/ 有/ 的/ 适合/ 应用/ 于/ 版权保护/ ,/ 但是/ 它们/ 都/ 不/ 适合/ 应用/ 在/ 广播/ 监视/ 环境/ 下/ ./ 到/ 目前为止/ ,/ 鲜有/ 适用/ 于/ 广播/ 监视/ 环境/ 下/ 的/ 视频/ 水印/ 协议/ 出现/ ./ 本文/ 就/ 广播/ 监视/ 环境/ 中/ 经常出现/ 的/ 问题/ ,/ 提出/ 一种/ 适用/ 于/ 该/ 环境/ 下/ 的/ 视频/ 水印/ 协议/ ,/ 提出/ 的/ 协议/ 采用/ 了/ 一种/ 新/ 的/ 同态/ 公钥/ 密码/ 技术/ ./ 2/ 同态/ ElGamal/ 公钥/ 密码/ 体制/ 在/ 协议/ 的/ 设计/ 过程/ 中/ ,/ 加密技术/ 如果/ 仅/ 采用/ 加/ 同态/ 或/ 乘/ 同态/ 的/ 公钥/ 密码/ ,/ 肯定/ 会/ 在/ 一定/ 程度/ 上/ 限制/ 水印/ 算法/ 选取/ 的/ 灵活性/ ./ 举个/ 例子/ ,/ ElGamal/ 是/ 一种/ 拥有/ 乘/ 同态/ 性质/ 的/ 密码/ 体制/ ,/ 所以/ 在/ 利用/ 加/ 同态/ 密码/ 的/ 水印/ 协议/ [/ 6/ ]/ 中/ ,/ 不/ 适合/ 采用/ ElGamal/ 密码/ 体制/ ./ 下面/ 我们/ 将/ 借助于/ 同态/ 转换/ 的/ 方法/ [/ 11/ ]/ 来/ 增加/ 水印/ 协议/ 设计/ 中/ 水印/ 算法/ 选取/ 的/ 灵活性/ ./ 本文/ 对/ 具有/ 加/ 同态/ 本质/ 的/ ElGamal/ 公钥/ 密码/ 的/ 变异/ 进行/ 详细/ 说明/ 如下/ :/ 随机/ 选取/ 一大/ 素数/ n/ ,/ 假设/ g/ 是/ Z/ / n/ 上/ 一个/ 生成元/ ./ 针对/ 公钥/ y/ ,/ 存在/ 一/ 私钥/ x/ ∈/ Zn/ -/ 1/ ,/ 满足/ y/ =/ gxmodn/ ./ 加密/ 过程/ :/ 假设/ 明文/ 为/ gm/ ,/ 0/ / gm/ / n/ -/ 1/ ,/ 选取/ 一/ 随机数/ r/ (/ r/ ∈/ Zn/ -/ 1/ )/ ,/ 并/ 根据/ 式/ (/ 1/ )/ 计算/ 密文/ :/ 其中/ 解密/ 过程/ :/ 从/ 密文/ 中/ 抽取/ 两/ 部分/ ,/ 按照/ 式/ (/ 2/ )/ 破解/ 加密/ 密文/ :/ ①/ IVAhomepage/ ./ http/ :/ // // www/ ./ intec/ ./ rug/ ./ ac/ ./ be/ // Research/ // Page3D/ (/ E/ (/ m/ ,/ r/ )/ )/ =/ B/ ·/ C/ -/ x/ =/ (/ gm/ ·/ yrmodn/ )/ ·/ (/ g/ -/ x/ ·/ rmodn/ )/ 然后/ 对式/ (/ 2/ )/ 所得/ 结果/ 计算/ 对数/ 得到/ 原始/ 信息/ :/ 因为/ E/ (/ m1/ ,/ r1/ )/ ·/ E/ (/ m2/ ,/ r2/ )/ =/ (/ B/ ;/ C/ )/ ·/ (/ F/ ;/ G/ )/ =/ (/ B/ ·/ F/ ;/ C/ ·/ G/ )/ 因而/ 上面/ 的/ 公式/ 算法/ 有加/ 同态/ 的/ 性质/ ./ 假若/ 犡/ =/ {/ x1/ ,/ x2/ ,/ …/ ,/ xi/ }/ 为/ 特征向量/ ,/ 该/ 特征向量/ 是从/ 数字视频/ 片段/ 中/ 抽取/ 出来/ 的/ ./ 犠/ =/ {/ w1/ ,/ w2/ ,/ …/ ,/ wi/ }/ 是/ 即将/ 嵌入/ 的/ 水印/ 向量/ ,/ 这里/ i/ / j/ ./ 可以/ 用式/ (/ 3/ )/ 表示/ 水印/ 的/ 嵌入/ 过程/ :/ 这里/ 犡/ 表示/ 嵌入/ 水印/ 后/ 视频/ 的/ 特征向量/ ,/ / 表示/ 水印/ 的/ 嵌入/ 操作/ ,/ 对/ / 操作/ 来说/ ,/ 不管/ 是/ 用/ ElGamal/ 乘/ 同态/ 性质/ 的/ 公钥/ 密码/ ,/ 还是/ 采用/ ElGama/ 加/ 同态/ 性质/ 的/ 公钥/ 密码/ 的/ 变异/ ,/ 都/ 有式/ (/ 4/ )/ 存在/ ./ EK/ (/ 犡/ )/ =/ EK/ (/ 犡/ / 犠/ )/ =/ EK/ (/ 犡/ )/ ·/ EK/ (/ 犠/ )/ (/ 4/ )/ 3/ 广播/ 监视/ 应用/ 中/ 的/ 视频/ 水印/ 协议/ 消费者/ 的/ 权利/ 得到/ 保障/ 不仅仅/ 是/ 广播/ 监视/ 唯一/ 要/ 做/ 的/ 事情/ ,/ 如何/ 保证/ 广告/ 的/ 播放/ 质量/ 也/ 是/ 必须/ 要/ 做/ 的/ ./ 为了/ 提高/ 广告/ 的/ 播放/ 质量/ ,/ 应/ 尽量避免/ 双/ 水印/ 的/ 嵌入/ ./ 近些年/ ,/ 数字水印/ 技术/ 被/ 广泛应用/ 于/ 各种/ 领域/ ,/ 但是/ 在/ 这些/ 领域/ 中/ 会/ 产生/ 一些/ 欺诈/ 行为/ ./ 例如/ :/ 在/ 广播/ 监视/ 环境/ 中/ ,/ 广播/ 电视台/ 提取/ 出/ 合法/ 广告商/ 的/ 水印/ ,/ 并/ 将/ 该/ 水印/ 嵌入/ 到/ 其他/ 广告商/ 的/ 广告/ 中/ ,/ 然后/ 代之/ 播放/ ,/ 而/ 广播/ 电视台/ 却/ 依然/ 向/ 合法/ 的/ 广告商/ 收取/ 这/ 一时/ 段/ 的/ 广告费用/ ,/ 获取/ 更大/ 的/ 利润/ ;/ 广告商/ 利用/ 非法/ 的/ 水印/ 替换/ 掉/ 合法/ 的/ 水印/ ,/ 然后/ 诬告/ 广播/ 电视台/ 在/ 他/ 没有/ 购买/ 的/ 时段/ 播放/ 了/ 他/ 的/ 广告/ ,/ 以/ 逃避/ 缴费/ 和/ 应该/ 支付/ 给/ 演员/ 的/ 版税/ ./ 为了/ 在/ 纷争/ 与/ 冲突/ 产生/ 时/ 找出/ 并/ 确定/ 应该/ 负责/ 任/ 的/ 一方/ ,/ 本文/ 提出/ 的/ 应用/ 于/ 广播/ 监视/ 的/ 视频/ 水印/ 协议/ 由/ 水印/ 协议/ 、/ 监视/ 协议/ 和/ 认证/ 仲裁/ 协议/ 这/ 3/ 个子/ 协议/ 组成/ ./ 下面/ 分别/ 用/ B/ 、/ S/ 、/ BMB/ 、/ WCA/ 代表/ 水印/ 协议/ 中/ 涉及/ 到/ 的/ 广告商/ 、/ 广播/ 电视台/ 、/ 监视/ 服务商/ 和/ 水印/ 认证/ 权威机构/ ./ 这里/ 假设/ BMB/ 和/ WCA/ 均/ 为/ 可信/ 的/ 权威机构/ ./ 图/ 1/ 显示/ 了/ B/ 、/ BMB/ 、/ WCA/ 和/ S/ 之间/ 的/ 交互/ 方案/ ./ 这里/ 需要/ 说明/ 的/ 是/ (/ 7.1/ )/ 与/ (/ 7.2/ )/ 需/ 同时/ 执行/ 或者/ (/ 7.1/ )/ 要/ 在/ (/ 7.2/ )/ 之前/ 执行/ ./ 3.1/ 提出/ 的/ 水印/ 协议/ B/ 和/ S/ 在/ 执行/ 该/ 水印/ 协议/ 前/ 首先/ 要/ 商议/ 签订/ 一个/ 合同/ (/ 以下/ 记为/ ARG/ )/ ./ B/ 和/ S/ 要/ 遵守/ 的/ 权力/ 、/ 义务/ 、/ 广告/ 所/ 涉及/ 到/ 的/ 信息/ (/ 如/ 购买/ 的/ 时段/ 、/ 购买/ 的/ 花费/ )/ 等/ 都/ 必须/ 写/ 在/ 合同/ 中/ ./ 这样/ ,/ 即将/ 播放/ 的/ 广告/ 和/ 本次/ 交易/ 就/ 被/ 该/ 合同/ 绑定/ 在/ 了/ 一起/ ,/ 该/ ARG/ 也/ 可以/ 看成/ 是/ B/ 和/ S/ 之间/ 签订/ 的/ 一个/ 订单/ ./ 我们/ 假设/ S/ 将/ 之前/ 与/ 它/ 产生/ 的/ 所有/ 订单/ ARGs/ ,/ 以及/ 广播/ 电视台/ 所/ 要/ 播放/ 的/ 所有/ 广告/ 的/ 目录/ 都/ 挂/ 在/ 它/ 的/ 主页/ 上/ ,/ 并且/ 所有/ 与/ 之/ 签订/ 过/ 订单/ 的/ 广告商/ 都/ 可以/ 匿名/ 访问/ ./ 协议/ 执行/ 过程/ 中/ 的/ 水印/ 嵌入/ 和/ 检测/ 方案/ 采用/ 文献/ [/ 12/ ]/ 中/ 的/ 算法/ ./ (/ 1/ )/ B/ 随机/ 产生/ 一个/ 密钥/ 对/ (/ KB/ ,/ KS/ )/ (/ 其中/ KB/ 为/ 公钥/ ,/ KS/ 为/ 私钥/ )/ ,/ 并/ 将/ 以下/ 信息/ 发送给/ WCA/ :/ 身份证明/ IDB/ 、/ 公钥/ KB/ 、/ ARG/ 、/ SignKS/ (/ IDB/ ,/ ARG/ ,/ T/ )/ (/ 其中/ SignKS/ (/ M/ )/ 表示/ 用/ 私钥/ KS/ 对/ M/ 进行/ 签名/ )/ ,/ 同时/ 请求/ 一个/ 合法/ 标识/ V/ ./ T/ 具有/ 双重身份/ ,/ 可以/ 是/ 随机数/ 也/ 可以/ 是/ 一个/ 时间/ 戳/ ,/ 它/ 只能/ 用于/ 唯一/ 标识/ 一次/ 会话/ ./ (/ 2/ )/ 当/ B/ 把/ 消息/ 发送给/ WCA/ 之后/ ,/ WCA/ 先/ 验证/ 签名/ 是否/ 有效/ ,/ 且/ 在/ 签名/ 验证/ 通过/ 之后/ 先/ 创建/ B/ 的/ 信任/ 状/ ,/ 之后/ 任意/ 选取/ 一/ 合法/ 标识/ V/ ./ 并/ 在/ 此基础/ 上/ 计算/ EKB/ (/ V/ )/ 、/ SignWCA/ (/ EKB/ (/ V/ )/ ,/ KB/ ,/ EKB/ (/ ARG/ )/ ,/ T/ )/ ,/ 再/ 把/ 计算/ 的/ 结果/ 发送给/ B/ (/ 其中/ SignWCA/ (/ M/ )/ 表示/ 用/ WCA/ 的/ 私钥/ 对/ M/ 进行/ 签名/ ;/ EI/ (/ ·/ )/ 表示/ 用公钥/ I/ 加密/ 的/ 函数/ )/ ./ (/ 3/ )/ 当/ B/ 接收/ 到/ WCA/ 发送/ 过来/ 的/ 消息/ 后/ ,/ 将/ 身份证明/ IDB/ 、/ ARG/ 、/ SignKS/ (/ ARG/ )/ 、/ EKB/ (/ V/ )/ 、/ SignWCA/ (/ EKB/ (/ V/ )/ ,/ KB/ ,/ EKB/ (/ ARG/ )/ ,/ T/ )/ 与/ 广告/ X/ (/ 即将/ 要/ 播放/ 的/ 广告/ )/ 一起/ 发送给/ BMB/ ./ (/ 4/ )/ 收到/ B/ 发送/ 过来/ 的/ 信息/ 后/ ,/ BMB/ 首先/ 验证/ Page4/ 签名/ 的/ 有效性/ ./ 如果/ 有效/ ,/ 即可/ 根据/ 某个/ 广告/ 片段/ 犡/ 去/ 计算/ 视频/ Hash/ 值/ H/ (/ 犡/ )/ ,/ 此/ 视频/ Hash/ 值/ 是/ 与/ 犡/ 唯一/ 相关联/ 的/ ./ 计算/ 完/ 之后/ ,/ BMB/ 通过/ B/ 的/ 公钥/ KB/ 对/ H/ (/ 犡/ )/ 加密/ 得到/ EKB/ (/ H/ (/ 犡/ )/ )/ ./ 最后/ 通过/ 一个/ 置乱/ 函数/ σ/ [/ 13/ ]/ 计算/ 出/ σ/ (/ EKB/ (/ H/ (/ 犡/ )/ )/ ·/ EKB/ (/ V/ )/ )/ =/ σ/ (/ EKB/ (/ H/ (/ 犡/ )/ +/ V/ )/ )/ 即可/ 得到/ 加密/ 后/ 的/ 水印/ ./ 这里/ E/ (/ ·/ )/ 采用/ 的/ 是/ 第/ 2/ 部分/ 提出/ 的/ ElGamal/ 同态/ 公钥/ 密码/ 技术/ ,/ 直接/ 在/ 加密/ 域/ 嵌入/ 水印/ ,/ 即/ EKB/ (/ 犡/ )/ =/ EKB/ (/ 犡/ / 犠/ )/ =/ EKB/ (/ 犡/ )/ ·/ EKB/ (/ 犠/ )/ ,/ 其中/ / 可以/ 是/ 两种/ 方案/ —/ —/ —/ 加性/ 嵌入/ 方案/ 或/ 乘性/ 嵌入/ 方案/ ./ 然后/ ,/ BMB/ 发送/ EKB/ (/ 犡/ )/ 给/ B/ ,/ 并且/ 存储/ B/ 的/ 以下/ 信息/ 到/ 交易/ 记录表/ Table/ 中/ :/ IDB/ 、/ KB/ 、/ ARG/ 、/ SignWCA/ (/ EKB/ (/ V/ )/ ,/ KB/ ,/ EKB/ (/ ARG/ )/ ,/ T/ )/ 、/ SignKS/ (/ ARG/ )/ 、/ EKB/ (/ V/ )/ 与/ EKB/ (/ 犠/ )/ ./ (/ 5/ )/ 当/ B/ 接收/ 到/ 他/ 用/ 自己/ 的/ 私钥/ KS/ 解密/ 得到/ 的/ 犡/ =/ DKS/ (/ EKB/ (/ 犡/ )/ )/ (/ 即/ 含水/ 印/ 的/ 广告/ 片段/ )/ 后/ ,/ 将/ 犡/ 、/ SignKS/ (/ 犡/ )/ 发送给/ 广播/ 电视台/ S/ ./ 3.2/ 提出/ 的/ 监视/ 协议/ B/ 发送/ 过来/ 相关/ 的/ 消息/ 以后/ ,/ S/ 首先/ 对/ 这段/ 广告/ 进行/ 验证/ ./ 如果/ 验证/ 通过/ ,/ 该段/ 广告/ 即可/ 播放/ ./ 同时/ ,/ 广播/ 监视/ 客户端/ 软件/ 由/ 可/ 信任/ 机构/ BMB/ 提供/ 给/ S/ ,/ 用以/ 进行/ 对/ 广告/ 的/ 监视/ :/ 首先/ 计算/ 并/ 提取/ 广播/ 电视台/ 播放/ 的/ 广告/ 中/ 的/ 视频/ Hash/ 值/ H/ (/ 犡/ )/ 和/ 水印/ 犠/ ,/ 然后/ 实施/ 水印/ 置/ 乱/ 的/ 逆/ 操作/ ,/ 并用/ 高通/ 滤波器/ 对/ 其/ 结果/ 进行/ 滤波/ ./ 最后/ ,/ 计算/ 滤波/ 后/ 的/ 结果/ 与/ H/ (/ 犡/ )/ 的/ 相关性/ ,/ 若/ 相关性/ 比/ 某/ 一/ 指定/ 的/ 阈值/ 大/ ,/ 就/ 说明/ “/ 广告/ 已/ 被/ 播放/ ”/ ;/ 反之/ ,/ 反馈/ “/ 广告/ 没有/ 被/ 播放/ ”/ ./ 并且/ BMB/ 添加/ 水印/ 犠/ 和/ H/ (/ 犡/ )/ 到/ Table/ 中/ 本次/ 交易/ 记录/ 的/ 后边/ ./ 3.3/ 提出/ 的/ 认证/ 仲裁/ 协议/ 一旦/ “/ 广告/ 没有/ 被/ 播放/ ”/ 的/ 消息/ 被/ 反馈/ 给/ B/ ,/ 认证/ 与/ 仲裁/ 协议/ 可以/ 起到/ 帮忙/ 查找/ 与/ 确定/ 有/ 责任/ 方/ 的/ 作用/ ./ 鉴于/ 要/ 体现/ 公平性/ ,/ 仲裁者/ A/ 必须/ 参与/ ,/ 但/ B/ 和/ S/ 并不需要/ 参与/ ./ 在/ 发生/ 纠纷/ 时/ ,/ A/ 要求/ BMB/ 发送给/ A/ 如下/ 信息/ :/ IDB/ 、/ ARG/ 、/ SignKS/ (/ ARG/ )/ 、/ EKB/ (/ V/ )/ 、/ EKB/ (/ 犠/ )/ 、/ SignWCA/ (/ EKB/ (/ V/ )/ ,/ KB/ ,/ EKB/ (/ ARG/ )/ ,/ T/ )/ 、/ 犠/ 和/ H/ (/ 犡/ )/ ./ 接下来/ A/ 计算/ EKB/ (/ 犠/ )/ ,/ 并/ 将/ 结果/ 与/ EKB/ (/ 犠/ )/ 比较/ ,/ 若/ 结果/ 相等/ 就/ 证明/ 这是/ 合法/ 的/ 水印/ ,/ 即此/ 水印/ 不是/ B/ 换过/ 的/ 非法/ 水印/ ,/ 也/ 就/ 不能/ 诬告/ S/ ;/ 为了/ 进一步/ 锁定/ 责任/ 方/ ,/ 当/ EKB/ (/ 犠/ )/ =/ EKB/ (/ 犠/ )/ 时/ ,/ A/ 再/ 要求/ WCA/ 和/ BMB/ 分别/ 提供/ 水印/ 标识/ V/ 和/ 置/ 乱/ 函数/ σ/ ,/ 同时/ 要/ 查明/ EKB/ (/ σ/ (/ V/ +/ H/ (/ 犡/ )/ )/ )/ =/ EKB/ (/ 犠/ )/ 能否/ 成立/ ./ 如果/ EKB/ (/ σ/ (/ V/ +/ H/ (/ 犡/ )/ )/ )/ ≠/ EKB/ (/ 犠/ )/ ,/ 就/ 证明/ S/ 存在/ 欺诈/ 的/ 行为/ ,/ 也就是说/ S/ 用/ 别人/ 的/ 广告/ (/ 该/ 广告/ 中/ 植入/ 了/ 真正/ 的/ 水印/ 信息/ )/ 代替/ B/ 的/ 已/ 付费/ 的/ 广告/ 播出/ ./ 如果/ EKB/ (/ 犠/ )/ ≠/ EKB/ (/ 犠/ )/ ,/ 由于/ EKB/ (/ 犠/ )/ 是/ BMB/ (/ 可/ 信任/ 的/ 权威机构/ )/ 从/ 其/ 交易/ 记录/ 里/ 取得/ 的/ ,/ 所以/ EKB/ (/ 犠/ )/ 肯定/ 不会/ 是/ 假/ 的/ ,/ 那么/ 就/ 只有/ EKB/ (/ 犠/ )/ 为/ 假/ ,/ 即/ 水印/ 为/ 非法/ 水印/ ./ 因为/ 水印/ 犠/ 是从/ 播放/ 的/ 广告/ 中/ 提取/ 的/ ,/ 所以/ 一定/ 是/ B/ 为了/ 诬陷/ S/ 将/ 水印/ 换成/ 非法/ 的/ 水印/ (/ S/ 不/ 可能/ 将/ 水印/ 换成/ 非法/ 的/ ,/ 因为/ 这样/ 做/ 对/ 他/ 没有/ 一点/ 好处/ )/ ./ 4/ 协议/ 分析/ 一个/ 安全/ 的/ 应用/ 数字水印/ 技术/ 的/ 广播/ 监视系统/ 应该/ 能够/ 经受/ 住/ 主动攻击/ 的/ 干扰/ ,/ 应/ 满足/ 以下/ 方面/ :/ (/ 1/ )/ 提出/ 的/ 协议/ 对/ 广播/ 电视台/ 是/ 安全/ 和/ 公平/ 的/ ./ 若/ 签名/ 体质/ 安全/ ,/ 恶意/ 的/ 广告商/ 则/ 无法/ 将/ 非法/ 的/ 水印/ 替换成/ 合法/ 水印/ ,/ 这样/ S/ 就/ 不/ 可能/ 被/ 诬陷/ ./ 因为/ 关于/ 确切/ 的/ 水印/ 信息/ ,/ 广告商/ 在/ 整个/ 交易过程/ 中/ 都/ 是/ 无法/ 获知/ 的/ ./ 他/ 仅/ 能/ 知道/ 整个/ 水印/ 信息/ EKB/ (/ 犠/ )/ =/ EKB/ (/ σ/ (/ V/ +/ H/ (/ 犡/ )/ )/ )/ 中/ 的/ V/ ,/ 这样一来/ 水印/ 就/ 不能/ 被/ 移除/ ./ 同时/ 在/ 认证/ 仲裁/ 协议/ 中/ ,/ A/ 会/ 比较/ EKB/ (/ 犠/ )/ (/ 其中/ 犠/ 为/ 提取/ 出/ 的/ 水印/ 信息/ )/ 和/ 由/ BMB/ 这一/ 可/ 信任/ 机构/ 发过来/ 的/ 交易/ 记录/ 中/ 的/ EKB/ (/ 犠/ )/ ,/ 若/ EKB/ (/ 犠/ )/ ≠/ EKB/ (/ 犠/ )/ ,/ 就/ 说明/ B/ 存在/ 欺诈/ 行为/ ./ (/ 2/ )/ 提出/ 的/ 协议/ 对/ 广告商/ 是/ 安全/ 和/ 公平/ 的/ ./ 一些/ 广播/ 电视台/ 恶意/ 在/ 其它/ 广告商/ 的/ 广告/ 中/ 使用/ B/ 的/ 合法/ 水印/ ,/ 虽然/ B/ 的/ 已/ 付费/ 广告/ 被/ 替换成/ 其他/ 广告商/ 的/ 广告/ 播出/ ,/ 然而/ 这些/ 恶意/ 的/ 广播/ 电视台/ 却/ 仍/ 希望/ 收取/ B/ 的/ 这/ 一时/ 段/ 的/ 播放/ 费用/ ./ 由于/ 本次/ 交易/ 的/ 合法/ 水印/ 标识/ 由/ WCA/ 产生/ ,/ 广告/ 片段/ 的/ Hash/ 值/ 由/ BMB/ 产生/ ,/ 而/ 合法/ 水印/ 是/ 由/ 水印/ 标识/ 和/ Hash/ 值/ 最后/ 一起/ 生成/ 的/ ./ 因此/ 提出/ 的/ 协议/ 将/ 本次/ 交易/ 、/ 交易/ 中/ 的/ 水印/ 及/ 广告/ 绑定/ 在/ 了/ 一起/ ,/ 解决/ 了/ 非/ 绑定/ 问题/ ./ 仲裁者/ 在/ 认证/ 与/ 仲裁/ 的/ 时候/ ,/ 通过/ 得到/ 的/ H/ (/ 犡/ )/ 、/ EKB/ (/ V/ )/ 以及/ 置乱/ 函数/ σ/ 来/ 计算/ EKB/ (/ σ/ (/ V/ +/ H/ (/ 犡/ )/ )/ )/ ,/ 并/ 将/ 计算结果/ 与/ EKB/ (/ 犠/ )/ 比较/ ./ 如果/ EKB/ (/ σ/ (/ V/ +/ H/ (/ 犡/ )/ )/ )/ ≠/ EKB/ (/ 犠/ )/ ,/ 广播/ 电视台/ 会/ 被/ 仲裁者/ 判定/ 有/ 欺诈/ 行为/ ./ (/ 3/ )/ 提出/ 的/ 协议/ 能够/ 抵御/ 重/ 放/ 攻击/ ,/ 原因/ 在于/ 该/ 协议/ 在/ 消息/ 中/ 添加/ 了/ 时间/ 戳/ // 随机数/ ./ (/ 4/ )/ 为了/ 防止/ 歧义/ 攻击/ ,/ 并且/ 提高/ 广告/ 的/ 播放/ 质量/ ,/ 提出/ 的/ 水印/ 协议/ 不/ 允许/ 嵌入/ 一个/ 以上/ 的/ 水印/ ./ Page5/ 而且/ 整个/ 水印/ 的/ 生成/ 和/ 嵌入/ 都/ 是/ 在/ 加密/ 域/ 完成/ 的/ ,/ 这样/ B/ 、/ S/ 、/ WCA/ 和/ BMB/ 无/ 一方/ 可/ 获知/ 水印/ ,/ 这样/ 消费者/ 的/ 权力/ 问题/ 得到/ 了/ 解决/ ,/ 整个/ 交易/ 的/ 安全性/ 也/ 得到/ 了/ 保证/ ./ (/ 5/ )/ 由于/ 广告商/ 和/ 广播/ 电视台/ 不用/ 参与/ 仲裁/ ,/ 这样/ 双方/ 的/ 公平性/ 与/ 安全性/ 能够/ 得到/ 保证/ ./ 5/ 结论/ 本文/ 提出/ 了/ 一种/ 适用/ 于/ 广播/ 监视/ 的/ 视频/ 水印/ 协议/ ./ 该/ 协议/ 不仅/ 实现/ 了/ 某次/ 交易/ 、/ 此次/ 交易/ 中/ 的/ 广告/ 和/ 水印/ 信息/ 的/ 绑定/ ,/ 也/ 可以/ 解决/ 消费者/ 权力/ 问题/ ./ 与此同时/ ,/ 还/ 可以/ 通过/ 同态/ 公钥/ 密码/ 体制/ 在/ 加密/ 域/ 中/ 锁定/ 并/ 生成/ 和/ 嵌入/ 水印/ ./ 这样一来/ ,/ 无论是/ B/ 、/ S/ 还是/ WCA/ 、/ BMB/ 都/ 得不到/ 准确/ 的/ 关于/ 水印/ 的/ 信息/ ,/ 从而/ 确保/ 公平/ 与/ 安全/ 的/ 交易/ ./ 文中/ 提出/ 的/ 适用/ 于/ 广播/ 监视/ 的/ 视频/ 水印/ 协议/ 充分考虑/ 了/ 广播/ 监视/ 环境/ 下/ B/ 和/ S/ 之间/ 可能/ 出现/ 的/ 欺诈/ 行为/ ,/ 使得/ 这些/ 欺诈/ 行为/ 在/ 水印/ 协议/ 执行/ 阶段/ 就/ 可以/ 被/ 预防/ ,/ 当/ 发生/ 争端/ 的/ 时候/ ,/ 还/ 能够/ 通过/ 认证/ 仲裁/ 协议/ 认定/ 责任/ 方/ ,/ 追究其/ 法律责任/ ./ 

