Page1/ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 的/ 医学/ 图像/ 配准/ 赵/ 海峰/ 陆明/ 卜令斌/ 孙/ 登第/ 罗斌/ (/ 安徽大学/ 计算机科学/ 与/ 技术/ 学院/ 计算/ 智能/ 与/ 信号处理/ 教育部/ 重点/ 实验室/ 合肥/ 230601/ )/ 摘要/ 针对/ 医学/ 图像/ 配准/ 有/ 鲁棒性/ 强/ 、/ 准确性/ 高/ 和/ 速度/ 快/ 的/ 要求/ ,/ 文中/ 提出/ 一种/ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 的/ 医学/ 图像/ 配准/ 算法/ ./ 起初/ 从/ 模板/ 图像/ 与/ 待/ 配准/ 图像/ 中/ 依次/ 提取/ 出多/ 尺度/ 特征/ 点/ ,/ 其次/ 使用/ 其/ 空间/ 坐标/ 计算/ 特征/ 点/ R/ é/ nyi/ 互信息/ 目标/ 函数/ ,/ 实现/ 图像/ 配准/ ./ 该/ 算法/ 有效/ 地/ 避免/ 了/ 多模/ 噪声/ 图像/ 间/ 的/ 灰度/ 差异/ 影响/ ,/ 减少/ 了/ 待处理/ 的/ 数据量/ ,/ 同时/ 使用/ R/ é/ nyi/ 互信息/ 来/ 消除/ 目标/ 函数/ 所受/ 的/ 局部/ 极值/ 的/ 影响/ ,/ 进一步提高/ 了/ 配准/ 精度/ ./ 实验/ 证明/ 该/ 算法/ 适于/ 单模/ 和/ 多模/ 医学/ 图像/ 配准/ ,/ 速度/ 较/ 快/ 、/ 精度高/ 、/ 鲁棒性/ 强/ ,/ 是/ 一种/ 有效/ 的/ 自动/ 配准/ 方法/ ,/ 并且/ 具有/ 较/ 好/ 的/ 临床/ 应用/ 价值/ ./ 关键词/ 医学/ 图像/ 配准/ ;/ 尺度空间/ 特征/ 点/ ;/ R/ é/ nyi/ 互信息/ 1/ 引言/ 医学/ 图像/ 配准/ 的/ 主要/ 任务/ 是/ 通过/ 求解/ 某种/ 空间/ Page2/ 配/ ./ 因此/ 在/ 实际/ 的/ 临床/ 应用/ 中/ ,/ 图像/ 配准/ 具有/ 十分/ 重要/ 的/ 意义/ [/ 1/ ]/ ./ 当前/ ,/ 基于/ 灰度/ 的/ 方法/ 和/ 基于/ 特征/ 的/ 方法/ 是/ 医学/ 图像/ 配准/ 的/ 两类/ 主要/ 方法/ [/ 2/ ]/ ./ 基于/ 灰度/ 的/ 配准/ 方法/ 从/ 图像/ 整体/ 的/ 像素/ 灰度/ 方面/ 来/ 考察/ ,/ 此类/ 方法/ 的/ 原理/ 是/ 利用/ 图像/ 间/ 像素/ 灰度/ 值/ 的/ 某种/ 对应/ 关系/ 来/ 实现/ 配准/ 的/ ,/ 一般/ 只/ 适用/ 于/ 单模/ 图像/ 配准/ ;/ 而/ 基于/ 图像/ 特征/ 的/ 配准/ 方法/ 主要/ 通过/ 提取/ 图像/ 的/ 角点/ 、/ 轮廓/ 等/ 图像/ 的/ 局部/ 特征/ 进行/ 配准/ ,/ 这/ 类/ 方法/ 计算速度/ 快/ 并/ 可/ 应用/ 于/ 多模/ 图像/ 配准/ 中/ ,/ 因而/ 成为/ 当前/ 医学/ 图像/ 配准/ 的/ 热点/ 研究/ 方法/ ./ 在/ 所有/ 基于/ 灰度/ 的/ 配准/ 方法/ 中/ ,/ 互/ 信息测度/ 配准/ 算法/ 在/ 医学/ 图像/ 配准/ 中/ 得到/ 的/ 应用/ 是/ 最/ 广泛/ 的/ [/ 3/ -/ 6/ ]/ ./ 当/ 两幅/ 图像/ 为/ 最佳/ 配/ 准时/ ,/ 两幅/ 图像/ 对应/ 像素/ 的/ 灰度/ 互信息/ 应/ 取得/ 最大值/ ./ Shannon/ 互信息/ 一般/ 被/ 传统/ 的/ 互信息/ 配准/ 方法/ 所/ 采用/ ,/ 而/ 通常/ 含有/ 复杂/ 噪声/ 的/ 医学/ 图像/ 函数/ 具有/ 较/ 多/ 局部/ 极值/ 而/ 难以/ 达到最佳/ 匹配/ ./ R/ é/ nyi/ 互信息/ 是/ Shannon/ 互信息/ 的/ 广义/ 形式/ [/ 7/ ]/ ,/ 在/ 合适/ 的/ 参数/ 水平/ 下/ 其/ 函数/ 比/ Shannon/ 互信息/ 平滑/ ,/ 局部/ 极值/ 少/ ,/ 更/ 适合/ 于/ 图像/ 配准/ 寻优/ ./ 在/ 基于/ 特征/ 的/ 方法/ 中/ ,/ 提取/ 图像/ 特征/ 点/ 并/ 进行/ 医学/ 图像/ 配准/ 的/ 思路/ 已经/ 受到/ 了/ 越来越/ 多/ 的/ 重视/ ./ 目前/ ,/ 许多/ 特征/ 点/ 提取/ 方法/ 已/ 被/ 提出/ ,/ 其中/ LaplacianofGaussian/ [/ 8/ ]/ 与/ HarrisLaplacian/ [/ 9/ ]/ 特征/ 点/ 提取/ 算子/ 具有/ 良好/ 的/ 抗噪性/ 和/ 抗/ 旋转/ 性/ ,/ 可/ 在/ 多/ 尺度空间/ 下/ 提取/ 出/ 稳定/ 特征/ 点/ ,/ 准确/ 描述/ 图像/ 的/ 内容/ 信息/ ,/ 减少/ 运算量/ ,/ 非常适合/ 于/ 医学/ 图像/ 配准/ ./ 本文/ 借鉴/ Shannon/ 互信息/ 的/ 方法/ ,/ 结合/ 图像/ 特征/ 点/ 理论/ ,/ 提出/ 了/ 一种/ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 的/ 多/ 模态/ 医学/ 图像/ 配准/ 算法/ ./ 新/ 算法/ 能够/ 提取/ 图像/ 的/ 多/ 尺度/ 稳定/ 特征/ 点集/ ,/ 并/ 使用/ 了/ 可以/ 消除/ 局部/ 极值/ 的/ R/ é/ nyi/ 互信息/ ,/ 其/ 配准/ 精度高/ 、/ 速度/ 快/ 、/ 鲁棒性/ 强/ ./ 尤其/ 是/ 在/ 多模/ 图像/ 配准/ 中/ ,/ 获得/ 了/ 最佳/ 的/ 配准/ 效果/ ./ 2/ 医学/ 图像/ 多/ 尺度/ 特征/ 点/ 的/ 提取/ 在/ 机器/ 视觉/ 中/ ,/ 稳定/ 的/ 特征/ 点/ 可以/ 准确/ 反映/ 图像/ 内容/ ,/ 降低/ 真实/ 图像/ 中/ 形变/ 、/ 噪声/ 、/ 位置/ 差异/ 等/ 因素/ 造成/ 的/ 影响/ ,/ 并且/ 可以/ 显著/ 减少/ 图像处理/ 的/ 数据量/ ,/ 因而/ 已/ 被/ 大量/ 应用/ 于/ 匹配/ 算法/ 中/ [/ 10/ -/ 12/ ]/ ./ 2.1/ Harris/ 算子/ Harris/ 算子/ [/ 13/ ]/ 是/ Harris/ 等/ 人/ 在/ 1988/ 年/ 提出/ 的/ 一种/ 经典/ 的/ 特征/ 点/ 提取/ 算子/ ./ 计算/ 图像/ 中/ 每个/ 点/ 在/ 两个/ 方向/ 上/ 的/ 梯度/ Ix/ 与/ Iy/ ,/ 生成/ 自/ 相关矩阵/ :/ 局部/ 自/ 相关/ 函数/ 的/ 一阶/ 曲率/ 为/ 矩阵/ 犕/ 的/ 两个/ 特征值/ ./ 当/ 两个/ 曲率/ 值/ 都/ 很大/ 时/ ,/ 窗口/ 沿/ 任意/ 方向/ 移动/ ,/ 都/ 会/ 使/ 检测/ 子/ E/ (/ Δ/ x/ ,/ Δ/ y/ )/ ≈/ [/ Δ/ x/ ,/ Δ/ y/ ]/ M/ [/ Δ/ x/ ,/ Δ/ y/ ]/ T/ 很快/ 增大/ ,/ 则/ 该点/ 就是/ 我们/ 所求/ 的/ 特征/ 点/ ./ 综上/ 可/ 得/ ,/ 在/ 纹理/ 信息/ 丰富/ 的/ 区域/ ,/ Harris/ 算子/ 可以/ 提取/ 出/ 非常/ 有用/ 的/ 特征/ 点/ ;/ 寻求/ 两个/ 方向/ 的/ 曲率/ 最大/ 变化/ 过程/ 中/ ,/ 该/ 算子/ 的/ 计算公式/ 只/ 使用/ 到/ 了/ 一阶/ 导数/ ,/ 因此/ 该/ 算子/ 具有/ 良好/ 的/ 抗噪性/ 与/ 抗/ 旋转/ 性/ ./ 2.2/ LoG/ (/ LaplacianofGaussian/ )/ 算子/ Harris/ 算子/ 对/ 光照/ 变化/ 、/ 旋转/ 和/ 噪声/ 具有/ 很强/ 的/ 鲁棒性/ ,/ 然而/ 对/ 图像/ 间/ 的/ 尺度/ 缩放/ 却/ 较为/ 敏感/ ./ LindebergLoG/ (/ LaplacianofGaussian/ )/ 算子/ 来/ 克服/ 这个/ 缺点/ ./ 将/ 图像/ 与/ 高斯/ 核/ G/ (/ σ/ )/ 卷积/ 得到/ 尺度/ 函数/ L/ (/ x/ ,/ σ/ )/ =/ G/ (/ σ/ )/ ×/ I/ (/ x/ )/ ,/ 通过/ 求/ 偏导/ Lx/ ,/ Ly/ 构造/ 尺度/ 参数/ σ/ 的/ 自/ 相关矩阵/ ,/ 以/ 获得/ Harris/ 算子/ 的/ 尺度空间/ 表示/ ./ 在/ 此基础/ 上/ ,/ Lindeberg/ 提出/ 了/ LoG/ 算子/ :/ LoG/ (/ x/ ,/ σ/ n/ )/ =/ σ/ 2/ 待测/ 特征/ 点/ 及其/ 周围/ 8/ 个/ 近邻/ 的/ LoG/ 值/ ,/ 若/ 当前/ 待/ 测点/ 为/ 局部/ 极小/ 或/ 极大值/ 时/ ,/ 则/ 这个/ 点/ 就是/ 尺度空间/ 中/ 的/ 一个/ LoG/ 特征/ 点/ ./ 2.3/ HL/ (/ Harris/ -/ Laplacian/ )/ 算子/ 通过/ LoG/ 算子/ 取得/ 的/ 特征/ 点/ ,/ 往往/ 位于/ 亮度/ 只/ 在/ 一个/ 方向/ 变化/ 的/ 边缘/ 上/ ./ 为了/ 解决/ 该/ 问题/ ,/ Mikolajczyk/ [/ 9/ ]/ 提出/ 了/ HarrisLaplacian/ (/ HL/ )/ 尺度/ 不变/ 特征/ 检测/ 算法/ ./ 首先/ ,/ 此/ 算法/ 检测/ 每/ 一层/ 尺度/ 图像/ 上/ 的/ Harris/ 特征/ 点/ ,/ 其次/ 用/ Laplace/ 函数/ 选择/ 特征/ 尺度/ ,/ 也就是说/ ,/ 如果/ Laplace/ 函数/ 值/ 在/ 尺度/ 轴上/ 与/ 附近/ 两个/ 点相/ 比较/ ,/ 达到/ 极值/ 并且/ 大于/ 给定/ 阈值/ ,/ 就/ 判断/ 此点/ 为/ 稳定/ 的/ 特征/ 点/ :/ LoG/ (/ x/ ,/ σ/ n/ )/ =/ σ/ 2LoG/ (/ x/ ,/ σ/ n/ )/ >/ LoG/ (/ x/ ,/ σ/ p/ )/ ,/ p/ ∈/ {/ n/ -/ 1/ ,/ n/ +/ 1/ }/ ./ 图/ 1/ 为/ BrainWeb/ 中/ 的/ 一张/ 模拟/ T1/ 加权/ MR/ 噪声/ 图像/ ,/ 左图/ 为/ 提取/ 的/ LoG/ 特征/ 点/ ,/ 右图/ 为/ 提取/ 的/ HL/ 特征/ 点/ ./ 明显/ 可见/ LoG/ 特征/ 点较/ 多/ ,/ 清晰/ 完整/ 地/ 描述/ 出/ 了/ 图像/ 中/ 的/ 颅骨/ 与/ 颅骨/ 内侧/ 空隙/ 以及/ 脑室/ 部分/ ;/ HL/ 特征/ 点较/ 少/ ,/ 出现/ 于脑/ 沟回/ 的/ 根部/ 与/ 脑室/ 的/ 角点/ 处/ 等/ ./ 因此/ LoG/ 适于/ 描述/ 图像/ 突出/ 的/ Blob/ 特征/ ,/ 而/ HL/ 更/ 适合/ 描述/ 图像/ 中/ 的/ 细致/ 部位/ ./ 结合/ 这/ 两种/ 方法/ 提取/ 的/ 特征/ 点将/ 准确/ 反映/ 图像/ 的/ 解剖/ 结构/ 与/ 边缘/ 轮廓/ 信息/ ,/ 有助于/ 后续/ 配准/ 处理/ ./ Page33/ 配准/ 目标/ 函数/ 3.1/ R/ é/ nyi/ 互信息/ 概述/ 互信息/ 是/ 信息论/ 中/ 的/ 重要/ 概念/ ,/ 它/ 描述/ 了/ 变量/ 间/ 的/ 统计/ 相关性/ ,/ 常用/ 的/ 互信息/ 有/ Shannon/ 互信息/ 与/ R/ é/ nyi/ 互信息/ 两种/ ./ 传统/ 的/ 医学/ 图像/ 配/ 准将/ 待/ 配准/ 的/ 两幅/ 图像/ 看作/ 是/ 关于/ 灰度/ 的/ 两个/ 随机变量/ 集/ A/ 与/ B/ ,/ a/ 和/ b/ 是/ 两个/ 随机变量/ 集/ 的/ 取值/ ,/ 即/ 像素/ 灰度/ 值/ ./ 则/ A/ 和/ B/ 的/ Shannon/ 互信息/ 与/ R/ é/ nyi/ 互信息/ 分别/ 为/ H/ (/ A/ ,/ B/ )/ =/ -/ ∑/ a/ ,/ bR/ α/ (/ A/ ,/ B/ )/ =/ 1/ // α/ -/ (/ 其中/ ,/ 联合/ 概率/ PAB/ (/ a/ ,/ b/ )/ 通过/ 归一化/ 的/ 联合/ 灰度/ 直方图/ 求得/ ./ 对/ 含有/ 相同/ 内容/ 的/ 两幅/ 图像/ 进行/ 几何变换/ ,/ 当/ 它们/ 在/ 空间/ 对齐/ 时/ ,/ 它们/ 的/ 互/ 信息量/ 最大/ ./ 显然/ ,/ 这种/ 方法/ 忽略/ 了/ 像素/ 的/ 图像/ 空间/ 位置/ 信息/ ./ 且/ 其/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ,/ n/ 为/ 像素/ 的/ 个数/ ,/ 因而/ 配准/ 速度/ 非常/ 慢/ ./ 3.2/ 特征/ 点集/ 的/ R/ é/ nyi/ 互信息/ 本文/ 在/ 提取/ 图像/ 特征/ 点/ 的/ 基础/ 上/ ,/ 研究/ 特征/ 点集/ 的/ R/ é/ nyi/ 互信息/ ,/ 并/ 应用/ 于/ 图像/ 配准/ 中/ ./ 假定/ 从/ 两幅/ 图像/ 中/ 分别/ 提取/ N1/ 与/ N2/ 个/ 特征/ 点/ 构成/ 集合/ X/ =/ {/ Xi/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ N1/ }/ 和/ Y/ =/ {/ Yj/ ,/ |/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ N2/ }/ ,/ 其中/ Xi/ 与/ Yj/ 表示/ 两幅/ 图像/ 中/ 特征/ 点/ 的/ 二维/ 坐标/ ./ 对于/ 点集/ X/ 与/ Y/ ,/ 定义/ 联合/ 概率/ 为/ Pij/ >/ 0/ ,/ 即/ 表示/ 同时/ 从/ X/ 中/ 选取/ Xi/ 和/ 从/ Y/ 中/ 选取/ Yj/ 的/ 概率/ ./ X/ 与/ Y/ 中/ 单独/ 抽样/ 的/ 概率/ 为/ Pi/ =/ ∑/ 则/ 点集/ X/ 的/ Shannon/ 熵/ 与/ R/ é/ nyi/ 熵/ 分别/ 为/ H/ (/ X/ )/ =/ -/ ∑/ 显然/ ,/ R/ é/ nyi/ 熵/ 是/ Shannon/ 熵/ 的/ 广义/ 形式/ ,/ 当/ α/ →/ 1/ 时/ ,/ R/ α/ →/ H/ ./ 因此/ R/ é/ nyi/ 熵/ 具有/ 更强/ 的/ 泛化/ 能力/ ./ 由/ 互信息/ 定义/ ,/ 点集/ X/ 与/ Y/ 的/ Shannon/ 互信息/ 为/ MI/ (/ X/ ,/ Y/ )/ =/ ∑/ 而/ X/ 与/ Y/ 的/ R/ é/ nyi/ 互信息/ 为/ MI/ α/ (/ X/ ,/ Y/ )/ =/ 为/ 比较/ 特征/ 点集/ 的/ Shannon/ 互信息/ 与/ R/ é/ nyi/ 互信息/ ,/ 我们/ 取/ 同一/ 断层/ 的/ MR/ 图像/ 和/ CT/ 图像/ ,/ 将/ 其中/ 一幅/ 作为/ 浮动/ 图像/ 进行/ 空间/ 变换/ ./ 对/ 两幅/ 图像/ 提取/ 特征/ 点/ 并用/ 式/ (/ 1/ )/ 、/ (/ 2/ )/ 分别/ 计算/ 在/ 不同/ 变换/ 下/ 的/ 点/ 集互/ 信息测度/ ,/ 结果/ 如图/ 1/ 所示/ ./ 在/ 图/ 2/ 中/ 我们/ 比较/ 了/ 归一化/ 的/ Shannon/ 互信息/ 和/ 参数/ 分别/ 为/ 0.5/ 、/ 0.9/ 、/ 1.1/ 、/ 2.1/ 时/ 的/ R/ é/ nyi/ 互信息/ ./ 上下/ 两图/ 分别/ 为/ 平移/ (/ X/ 轴/ 方向/ )/ 、/ 旋转/ 对/ 互信息/ 所/ 产生/ 的/ 影响/ ./ 由于/ 实际/ 图像/ 含有/ 较大/ 噪声/ ,/ 且/ 多模/ 图像/ 的/ 特征/ 点/ 位置/ 并/ 不/ 完全一致/ ,/ 所以/ 用式/ (/ 1/ )/ 计算/ 出/ 的/ Shannon/ 互信息/ 函数/ 曲线/ 不/ 光滑/ ,/ 有/ 很多/ 的/ 局部/ 极值/ ./ 通过/ 调整/ 参数/ α/ ,/ Renyi/ 互信息/ 函数/ 线/ 明显/ 平滑/ ,/ 局部/ 极值/ 较/ 少/ ,/ 抵消/ 了/ 特征/ 点/ 不/ 准确/ 的/ 影响/ ./ 当/ α/ =/ 0.9/ 和/ 1.1/ 时/ ,/ R/ é/ nyi/ 互信息/ 与/ Shannon/ 互信息/ 的/ 形状/ 很/ 相似/ ,/ 这/ 与/ 理论/ 分析/ 一致/ ,/ 同时/ 也/ 表明/ R/ é/ nyi/ 互信息/ 具有/ 更强/ 的/ 泛化/ 能力/ ./ 图/ 2/ 不同/ 参数/ 归一化/ 互信息/ 对/ 平移/ 和/ 旋转/ 的/ 变化/ 曲线/ 3.3/ 联合/ 概率/ 的/ 估计/ 由式/ (/ 2/ )/ 可知/ ,/ 联合/ 概率/ Pij/ 对/ 互信息/ 的/ 计算/ 起/ Page4/ 到/ 至关重要/ 的/ 作用/ ./ 在/ 图像/ 配准/ 中/ ,/ 联合/ 概率/ Pij/ 表示/ A/ 图中/ 的/ 特征/ 点/ Xi/ 与/ B/ 图中/ 的/ 特征/ 点/ Yj/ 配准/ 的/ 概率/ ./ 对/ 浮动/ 图像/ B/ 作/ 空间/ 变换/ ,/ 当/ 某个/ 变换/ T/ 使得/ 两幅/ 图像/ 配/ 准时/ ,/ 其/ 对应/ 联合/ 概率/ Pij/ 将/ 使得/ 变换/ 后/ 的/ 坐标/ T/ (/ Y/ )/ 与/ 参考/ 图像/ 中/ 的/ X/ 的/ 互信息/ MI/ α/ (/ X/ ,/ T/ (/ Y/ )/ )/ 达到/ 极值/ ./ 显然/ ,/ 目标/ 函数/ 是/ 关于/ 变换/ T/ 的/ 函数/ ,/ 而/ 估计/ 特征/ 点/ 联合/ 概率/ Pij/ 则/ 为/ 优化/ 目标/ 函数/ 的/ 关键步骤/ ./ Pij/ 与/ 特征/ 点/ 空间/ 分布/ 位置/ 具有/ 密切联系/ ./ 对/ 特征/ 点集/ X/ 与/ T/ (/ Y/ )/ ,/ 点集间/ 任意/ 两点/ 的/ 欧式/ 距离/ 为/ Dij/ (/ T/ )/ ,/ 则/ 两图/ 特征/ 点/ 之间/ 的/ 期望/ 距离/ 为/ 当/ 两幅/ 图配/ 准时/ ,/ 匹配/ 点/ 坐标/ 最近/ ,/ E/ (/ T/ )/ 最小/ ,/ 因此/ E/ (/ T/ )/ 是/ 关于/ 变换/ T/ 的/ 一个/ 常数/ ./ 我们/ 用/ E/ (/ T/ )/ 作为/ 计算/ 联合/ 概率/ Pij/ 的/ 似然/ 条件/ ,/ 不妨/ 设其为/ d/ ./ 我们/ 用/ 最大/ 熵/ 方法/ ,/ 在/ 期望/ 距离/ 最小化/ 约束条件/ 下/ ,/ 估计/ 出/ 符合/ 最大/ 可能/ 随机性/ 的/ 概率/ Pij/ 合/ 概率/ Pij/ 的/ 最大/ R/ é/ nyi/ 熵/ 估计/ 为/ argminPij/ 满足/ 利用/ 拉格朗/ 日/ 乘子法/ 可以/ 得到/ L/ =/ α/ -/ 1/ ∑/ μ/ Pij/ +/ λ/ ∑/ 其中/ η/ ,/ μ/ 与/ λ/ 为/ 拉格朗/ 日/ 乘子/ ./ 该式/ 对/ Pij/ 求/ 偏导/ (/ 考虑/ 约束条件/ 显然/ 当/ η/ >/ 0/ 时/ ,/ 0/ </ α/ </ 1/ ,/ 当/ η/ </ 0/ 时/ ,/ α/ >/ 1/ ,/ 这/ 也/ 与/ 图/ 2/ 中/ α/ 为/ 0.9/ 与/ 1.1/ 时/ 的/ 两个/ 函数/ 线/ 形式/ 一致/ ./ 由于/ 初始/ 未配/ 准时/ 两幅/ 图像/ 变化/ 差异/ 明显/ ,/ 配准/ 期望/ 距离/ d/ 比较/ 大/ ,/ 这/ 意味着/ α/ →/ 1/ ,/ 此时/ R/ α/ →/ H/ ./ 因此/ 为/ 简化/ 计算/ ,/ 我们/ 采用/ 特征/ 点/ 的/ Shannon/ 互信息/ 来/ 估计/ Pij/ ,/ 其/ 拉格朗/ 日/ 形式/ 为/ N1L/ =/ ∑/ i/ =/ 1/ ∑/ 此处/ ,/ logPij/ 包含/ Pij/ >/ 0/ 的/ 约束/ ./ 对/ 该式/ 求/ 偏导/ 可得/ :/ 这样/ 就/ 消除/ 了/ 未知/ 常数/ d/ 的/ 影响/ ./ 代入/ exp/ {/ -/ λ/ }/ 得/ Pij/ =/ exp/ {/ -/ η/ Dij/ (/ T/ )/ }/ ∑/ 显然/ 式/ (/ 4/ )/ 就是/ 欧式/ 距离/ 高斯/ 核/ 的/ 归一化/ 形式/ ,/ 其中/ η/ 为/ 核/ 参数/ ./ 该式/ 符合/ 最优化/ 理论/ 中/ 的/ KKT/ 条件/ ,/ 算法/ 收敛/ [/ 14/ ]/ ./ 因此/ 可以/ 通过/ 式/ (/ 3/ )/ 、/ (/ 4/ )/ 分别/ 计算/ 出/ 联合/ 概率/ 与/ 相应/ 的/ R/ é/ nyi/ 互信息/ 目标/ 函数/ ./ 待/ 配准/ 的/ 两幅/ 图像/ 基于/ 共同/ 的/ 解剖/ 信息/ ,/ 因此/ 当/ 两幅/ 图像/ 达到/ 空间/ 位置/ 一致/ 时/ ,/ 特征/ 点/ 最近/ 得/ 最/ 多/ ,/ 互信息/ 最大/ ./ 如图/ 3/ ,/ 上下/ 两图/ 分别/ 为/ 配准/ 前后/ 特征/ 点/ 的/ 联合/ 概率/ 直方图/ ,/ x/ ,/ y/ 轴为/ 两图/ 中/ 的/ 特征/ 点/ 编号/ (/ 为/ 方便/ 显示/ ,/ 对/ 特征/ 点/ 事先/ 进行/ 了/ 排序/ )/ ./ 未/ 配准/ 之前/ 直方图/ 分布/ 十分/ 混乱/ ,/ 配准/ 后/ 对应/ 特征/ 点/ 的/ 欧式/ 距离/ 最小/ ,/ Pij/ 值/ 最大/ ,/ 联合/ 概率/ 呈/ 对角/ 型/ 分布/ ./ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 的/ 图像/ 配准/ 可以/ 通过/ 参数/ 调控/ 收敛/ 目标/ 函数/ ,/ 并/ 在/ 求解/ 过程/ 中/ 利用/ 两种/ 互信息/ 间/ 的/ 关系/ 实现/ 对/ 参数/ 的/ 合理/ 控制/ ;/ 该/ 方法/ 采用/ 多/ 尺度/ 算子/ 提取/ 抗噪/ 、/ 抗/ 旋转/ 的/ 特征/ 点/ ,/ 且/ 不/ 需考/ Page5/ 虑/ 特征/ 点/ 的/ 排序/ 和/ 数目/ 限制/ ,/ 只要/ 空间/ 位置/ 整体/ 相对/ 应/ ,/ 其/ 复杂度/ 为/ O/ (/ N1N2/ )/ / O/ (/ n2/ )/ ./ 4/ 配准/ 过程/ 基于/ 上述/ 讨论/ ,/ 通过/ 提取/ 多/ 尺度/ 特征/ 点/ 作为/ 图像/ 内容/ 描述/ ,/ 结合/ R/ é/ nyi/ 互信息/ 作为/ 相似性/ 测度/ 的/ 标准/ ,/ 本文/ 提出/ 一种/ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 的/ 医学/ 图像/ 配准/ 方法/ ./ 4.1/ 空间/ 变换/ 与/ 目标/ 函数/ 的/ 建立/ 临床/ 应用/ 中/ ,/ 图像/ 中/ 的/ 解剖/ 结构/ 相对运动/ 较/ 小/ ,/ 可/ 将/ 图像/ 内容/ 的/ 变化/ 近似/ 看作/ 刚体/ 变形/ 或/ 具有/ 较/ 小/ 放缩/ 比例/ 的/ 相似/ 变换/ ./ 首先/ 取/ 图像/ 左下角/ 为/ 原点/ ,/ 将/ 图像/ 分别/ 沿/ X/ 轴/ 和/ Y/ 轴/ 平移/ Δ/ x/ 与/ Δ/ y/ 到/ 图像/ 中心/ ,/ 再/ 旋转/ Δ/ θ/ 角度/ ,/ 最后/ 进行/ 尺度/ 因子/ s/ 的/ 放缩/ ./ 对/ 图像/ 中/ 任意/ 点/ (/ x/ ,/ y/ )/ ,/ 其/ 变换/ 过后/ 的/ 对应点/ (/ x/ ,/ y/ )/ 为/ xy/ [/ ]/ =/ s/ 其中/ ,/ (/ x0/ ,/ y0/ )/ 为/ 图像/ 的/ 中心/ 位置/ 坐标/ ./ 本文/ 研究/ 在/ 不同/ 的/ 平移/ 和/ 旋转/ 变量/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ 之下/ 的/ 特征/ 点/ R/ é/ nyi/ 互信息/ 值/ MI/ α/ ,/ 建立/ 关于/ 变换/ T/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ 中/ 3/ 个/ 未知量/ 的/ 目标/ 函数/ MI/ α/ (/ T/ )/ ./ 4.2/ 优化/ 策略/ 在/ 提取/ 图像/ 的/ 特征/ 点/ 和/ 确定/ 目标/ 函数/ 后/ ,/ 下/ 一步/ 我们/ 要/ 做/ 的/ 就是/ 对/ 目标/ 函数/ 求/ 极值/ ,/ 获取/ 最优/ 变换/ 解/ ./ 我们/ 所求/ 的/ 问题/ 是/ 一个/ 3/ 维/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ 无约束/ 最优化/ 问题/ ,/ 但/ 目标/ 函数/ 无法/ 求导/ ./ Powell/ 算法/ 是/ 一种/ 直接/ 寻查/ 目标/ 函数/ 极小值/ 的/ 简便/ 而/ 又/ 实用/ 的/ 算法/ ,/ 它/ 是/ 在/ 迭代/ 中/ 逐次/ 产生/ 共轭/ 方向/ 组/ ,/ 而/ 无需/ 计算/ 导数/ 和/ 梯度/ ,/ 很/ 适用/ 于/ 本文/ 配准/ 方法/ 的/ 多维/ 搜索/ ,/ 所以/ 本文/ 选取/ Powell/ 算法/ 作为/ 优化/ 算法/ ./ 4.3/ 优化/ 初始值/ 的/ 选取/ 在/ Powell/ 算法/ 中/ 初值/ 的/ 选择/ 很/ 重要/ ,/ 如果/ 初值/ 选择/ 不/ 适当/ ,/ 会/ 使/ 求解/ 过程/ 陷入/ 局部/ 极值/ ,/ 影响/ 配准/ 的/ 精度/ 和/ 时间/ ./ 在/ 本文/ 中/ ,/ 我们/ 采用/ 主轴/ 矩法/ 对/ 图像/ 进行/ 粗/ 配准/ ,/ 然后/ 用/ 粗/ 配准/ 结果/ 作为/ Powell/ 算法/ 的/ 初始值/ ,/ 这样/ 既/ 缩小/ 了/ 优化/ 方法/ 的/ 搜索/ 范围/ ,/ 节省/ 了/ 时间/ ,/ 又/ 避免/ 了/ Powell/ 算法/ 陷入/ 局部/ 极值/ ./ 4.4/ 算法/ 步骤/ 基于/ 以上/ 所述/ ,/ 并/ 结合/ 图像/ 配准/ 的/ 实际/ 情况/ ,/ 本文/ 提出/ 的/ 算法/ 流程/ 如图/ 4/ 所示/ ./ 5/ 实验/ 对于/ 本文/ 提出/ 的/ 特征/ 点集/ R/ é/ nyi/ 互信息/ 配准/ 算法/ ,/ 为了/ 验证/ 其/ 有效性/ ,/ 我们/ 对/ 多幅/ 颅脑/ 图像/ 进行/ 配准/ 实验/ ,/ 从/ 特征/ 点/ 有效性/ 、/ 配准/ 鲁棒性/ 、/ 准确性/ 与/ 配准/ 时间/ 等/ 多项/ 准则/ 上/ 给出/ 相应/ 的/ 比较/ 结果/ ./ 5.1/ 实验/ 数据库/ 本文/ 将/ 进行/ 同模/ 医学/ 图像/ 配准/ 与/ 多模/ 医学/ 图像/ 配准/ 的/ 实验/ ./ 其中/ ,/ 同模/ 医学/ 图像/ 实验/ 所用/ 的/ 数据/ 来源于/ BrainWeb/ 数据库/ ①/ ,/ BrainWeb/ 数据库/ 是/ 一个/ 仿真/ 数据库/ ,/ 其/ 特点/ 是/ 提供/ 不同/ 灰度/ 一致性/ 、/ 不同/ 模式/ 和/ 不同/ 噪声/ 比/ 的/ 人脑/ 核磁共振/ 图像/ ,/ 所以/ 能够/ 很/ 好/ 地/ 对/ 实验/ 进行/ 定量/ 的/ 分析/ ,/ 该/ 数据库/ 是/ 业内/ 公认/ 的/ 脑部/ 图像/ 仿真/ 分析/ 数据库/ ./ 数据库/ 图像/ 示/ 例如/ 图/ 5/ 所示/ ./ 图/ 5/ 灰度/ 不/ 一致/ 为/ 20/ %/ 情况/ 下/ 的/ BrainWeb/ 数据库/ 图像/ 示例/ 多模/ 图像/ 配准/ 的/ 实验/ 数据库/ 来源于/ 美国/ 范/ 德堡/ 大学/ 的/ 回顾性/ 配准/ 评估/ 项目/ (/ RetrospectiveImageRegistrationEvaluationProject/ )/ 数据库/ ②/ ,/ 该/ 数据库/ 中/ 的/ PET/ 、/ MR/ 、/ CT/ 等/ 不同/ 模式/ 的/ 图像/ 都/ 是/ 真实/ 病人/ 的/ 图像/ ,/ 在/ 拍摄/ 时/ 对/ 病人/ 头部/ 进行/ 了/ 外部/ 标记/ ,/ 得到/ 了/ 称为/ “/ 金/ 标准/ ”/ 的/ 配准/ 参数/ ,/ 然后/ 将/ 外部/ 标识/ 去掉/ ,/ 提供/ 给/ 研究者/ 实验/ 使用/ ./ 各种/ 其他/ 方法/ 所/ 获得/ 的/ 配准/ 参数/ ,/ 与/ “/ 金/ 标准/ ”/ 进行/ 比较/ ,/ 得出/ 该/ 方法/ ①/ ②/ Page6/ 的/ 评分/ 和/ 评价/ ,/ 图/ 6/ 给出/ 了/ 该/ 数据库/ 中/ 一些/ 病人/ 的/ 图像/ 示例/ ./ 图/ 6/ 范/ 德堡/ 大学/ 的/ 回顾性/ 配准/ 评估/ 项目/ RREP5/ ./ 2/ 实验/ 方法/ 对于/ 同模/ 图像/ 配准/ ,/ 我们/ 取/ BrainWeb/ 中/ 一幅/ 清晰/ 的/ MR/ 图像/ 作为/ 模板/ 图像/ A/ ,/ 对/ 施加/ 了/ 10/ %/ 噪声/ 后/ 的/ A/ 图像/ 在/ [/ -/ 20/ ,/ 20/ ]/ 像素/ 、/ [/ -/ 20/ ,/ 20/ ]/ 度/ 范围/ 内/ 随机/ 平移/ 旋转/ 得到/ 浮动/ 图像/ B/ ./ 我们/ 重复/ 上述/ 过程/ 50/ 次/ ./ 经过/ 这个/ 过程/ ,/ 得到/ 很多/ 组配/ 准/ 图像/ A/ 和/ B/ 的/ 配准/ 变换/ 参数/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ ,/ 分别/ 测试/ 得到/ 的/ 配准/ 变换/ 参数/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ ./ 计算/ 真实/ 的/ 人工/ 变换/ 参数/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ θ/ )/ 与/ 配准/ 得到/ 的/ 变换/ 参数/ 之间/ 误差/ 的/ 绝对值/ ./ 当/ 旋转/ 误差/ 小于/ 1/ °/ ,/ 平移/ 误差/ 小于/ 1/ 个/ 像素/ 时/ ,/ 认为/ 配准/ 达到/ 了/ 亚/ 像素/ 级/ ,/ 配准/ 成功/ ./ 对于/ 多模/ 图像/ 配准/ ,/ 我们/ 在/ RREP/ 数据库/ 中先/ 选用/ 20/ 组/ T1/ 加权/ 与/ T2/ 加权/ MR/ 图像/ ,/ 每组/ 中/ 的/ 两幅/ 图像/ 均/ 来自/ 于/ 同一/ 病人/ 且/ 处于/ 同一/ 断层/ ./ 对/ 这/ 20/ 组/ MR/ 图像/ 进行/ 配准/ 并/ 比较/ 效果/ ./ 进一步/ ,/ 我们/ 选取/ 20/ 组/ 来源/ 不同/ 的/ 图像/ ,/ 每组/ 中/ 包含/ 同一/ 病人/ 处于/ 同一/ 断层/ 的/ 一幅/ CT/ 图像/ 与/ 一幅/ MR/ 图像/ ,/ 并/ 进行/ 配准/ 比较/ ./ 5.3/ 特征/ 点/ 有效性/ 比较/ 实验/ 为了/ 验证/ 特征/ 点/ 的/ 有效性/ ,/ 我们/ 设计/ 如下/ 实验/ 来/ 比较/ 不同/ 特征/ 点/ 对/ 本文/ 算法/ 的/ 影响/ :/ 我们/ 分别/ 使用/ Harris/ 特征/ 点/ 、/ HL/ 特征/ 点/ 、/ LoG/ 特征/ 点/ 、/ HL/ 和/ LoG/ 互补/ 特征/ 点/ 一共/ 4/ 种/ 特征/ 点集/ 进行/ 同模/ 与/ 多模/ 图像/ 特征/ 点/ R/ é/ nyi/ 互信息/ 配准/ (/ Harris/ -/ R/ é/ nyi/ ,/ HL/ -/ R/ é/ nyi/ ,/ LoG/ -/ R/ é/ nyi/ ,/ HL/ +/ LoG/ -/ R/ é/ nyi/ )/ ,/ 再/ 比较/ 配准/ 成功率/ ./ 如图/ 7/ 所示/ 的/ 实验/ 结果/ ,/ 在/ 相同/ 情况/ 下/ ,/ 对/ 不同/ 图像/ 配准/ 实验/ 结果表明/ 无/ 尺度/ 信息/ 的/ Harris/ 特征/ 点/ 配准/ 效果/ 最差/ ,/ LoG/ 特征/ 点/ 与/ 单一/ HL/ 特征/ 点/ 配准/ 成功率/ 差不多/ ,/ 但/ 这/ 两种/ 单一/ 的/ 特征/ 点/ 配准/ 效果/ 都/ 不如/ 特征/ 点/ 组合/ HL/ +/ LoG/ ,/ 因此/ ,/ 本文/ 采用/ 的/ HL/ +/ LoG/ 是/ 一种/ 有效/ 稳定/ 的/ 特征/ 点/ 描述/ 子/ ./ 5.4/ 图像/ 配准/ 比较/ 实验/ 为了/ 验证/ 本文/ 配准/ 算法/ 的/ 鲁棒性/ 和/ 准确性/ ,/ 我们/ 比较/ 了/ 多种/ 常用/ 医学/ 图像/ 配准/ 方法/ ./ 5.4/ ./ 1/ 比较/ 实验/ 方法/ 我们/ 选取/ 了/ 3/ 种/ 常见/ 的/ 灰度/ 互信息/ 配准/ 方法/ ,/ 2/ 种/ 特征/ 点/ 配准/ 方法/ 以及/ 1/ 种/ 特征/ 点/ 与/ 互信息/ 结合/ 的/ 配准/ 方法/ 作为/ 比较/ :/ 灰度/ R/ é/ nyi/ 互信息/ 方法/ (/ R/ é/ nyiMI/ )/ [/ 4/ ]/ ./ 该/ 方法/ 采用/ 灰度/ R/ é/ nyi/ 互信息/ 作为/ 目标/ 函数/ 进行/ 配准/ ./ 归一化/ 互信息/ 方法/ (/ NMI/ )/ [/ 15/ ]/ ./ 该/ 方法/ 利用/ 图像/ 灰度/ 的/ 边际/ 熵/ 与/ 联合/ 熵/ 比值/ 构造/ 互信息/ ,/ 考虑/ 了/ 图像/ 重叠/ 区域/ 的/ 影响/ ./ 加权/ 互信息/ 方法/ (/ WMI/ )/ [/ 16/ ]/ ./ 该/ 方法/ 采用/ 加权/ 熵/ 代替/ 香农/ 熵/ 构造/ 互信息/ ,/ 能够/ 平滑/ 互信息/ 局部/ 极值/ ./ 特征/ 点/ Ransac/ 配准/ 方法/ (/ SIFT/ +/ Ransac/ )/ [/ 17/ ]/ ./ 该/ 方法/ 先用/ SIFT/ 算子/ 提取/ 尺度空间/ 特征/ 点/ ,/ 再用/ Ransac/ 方法/ 对/ 特征/ 点/ 进行/ 匹配/ ,/ 并/ 计算/ 出/ 反向/ 映射/ ,/ 得到/ 变化/ 参数/ ./ 轮廓/ 特征/ 点/ 配准/ 方法/ (/ Contour/ )/ [/ 18/ ]/ ./ 该/ 方法/ 通过/ 轮廓/ 直线/ 化/ 提取/ 轮廓/ 特征/ 点/ ,/ 并用/ 轮廓/ 之间/ 的/ 距离/ 与/ 特征/ 点/ 之间/ 的/ 距离/ 的/ 累加/ 和/ 作为/ 目标/ 函数/ 实现/ 配准/ ./ R/ é/ nyi/ 熵/ 图/ 配准/ 方法/ (/ EntropicGraph/ )/ [/ 19/ ]/ ./ 该/ 方法/ 利用/ 特征/ 点集/ 的/ 最小/ 生成/ 树/ 估计/ R/ é/ nyi/ 熵/ 实现/ 图像/ 配准/ ./ 5.4/ ./ 2/ 同模/ 模拟/ 图像/ 配准/ 比较/ 实验/ 我们/ 用/ BrainWeb/ 数据库/ 中/ 的/ 模拟/ 图像/ 进行/ 同模/ 配准/ 实验/ ./ 实现/ 方法/ 如/ 5.2/ 节/ 所述/ ./ 配准/ 的/ 结果/ 如表/ 1/ 所示/ ,/ 精度/ 为/ 50/ 次/ 实验/ 平均值/ ./ 对/ 同模/ 模拟/ 图像/ 配准/ ,/ 虽然/ 其/ 解剖/ 组织/ 结构/ 相/ Page7/ 同/ ,/ 但是/ 噪声/ 严重/ 影响/ 了/ 灰度/ 联合/ 直方图/ 的/ 计算/ ,/ 使得/ 基于/ 灰度/ 的/ 互信息/ 目标/ 函数/ 不/ 准确/ ./ 因此/ 3/ 种基表/ 1/ 同模/ 模拟/ 图像/ 配准/ 结果/ 横轴/ 平移/ 配准/ 误差/ Δ/ x/ 纵轴/ 平移/ 配准/ 误差/ Δ/ y/ 旋转/ 角度/ 配准/ 误差/ Δ/ θ/ 配准/ 时间/ 特征/ 点/ R/ é/ nyi/ 互信息/ SIFT/ -/ RansacR/ é/ nyiEntropicGraphSIFT/ +/ Ransac/ 配准/ 方法/ 使用/ 的/ 是/ 提取/ 出/ 的/ SIFT/ 特征/ 点处/ 梯度/ 特征/ ,/ 噪声/ 影响/ 了/ 特征/ 点/ 梯度/ 的/ 计算/ 和/ 主/ 方向/ 的/ 选取/ ,/ 降低/ 了/ 该/ 方法/ 的/ 配准/ 精度/ ./ 对于/ 同模/ 医学/ 图像/ ,/ 其/ 轮廓/ 十分相似/ ,/ 因此/ 轮廓/ 特征/ 点/ 配准/ 方法/ 较/ 好/ ./ 而/ R/ é/ nyi/ 熵/ 图/ 配准/ 方法/ 由于/ 最小/ 生成/ 树/ 对/ 熵/ 估计/ 的/ 误差/ ,/ 使得/ 其/ 精度/ 略低于/ 轮廓/ 特征/ 点/ 配准/ 方法/ ./ 本文/ 提出/ 的/ 特征/ 点/ R/ é/ nyi/ 互信息/ 方法/ 在/ 提取/ 特征/ 点/ 之后/ 并/ 不/ 使用/ 该点/ 处/ 的/ 像素/ 灰度/ 或/ 梯度/ 信息/ ,/ 而是/ 在/ 配准/ 过程/ 中/ 直接/ 使用/ 特征/ 点/ 的/ 空间/ 位置/ ,/ 避免/ 了/ 图像/ 噪声/ 带来/ 的/ 影响/ ,/ 因此/ 具有/ 较/ 高/ 的/ 配准/ 精度/ 和/ 成功率/ ./ 通过/ 实验/ 结果/ 可以/ 明显/ 看出/ ,/ 基于/ 特征/ 点/ 的/ 方法/ 所用/ 配准/ 时间/ 远远/ 少于/ 基于/ 图像/ 灰度/ 的/ 互信息/ 方法/ 所用/ 配准/ 时间/ ./ 其中/ SIFT/ +/ Ransac/ 方法/ 不/ 需要/ 固定/ 的/ 目标/ 函数/ 形式/ ,/ 算法/ 速度/ 也/ 比/ 本文/ 提出/ 的/ 方法/ 更/ 快/ 一点/ ./ 图/ 8/ 为/ 一幅/ 脑部/ MR/ 图像/ (/ A/ )/ 和/ 经过/ 变换/ 后/ 的/ 噪声/ 图像/ (/ B/ )/ 及/ 对/ 两幅/ 图像/ 提取/ 的/ 特征/ 点/ ./ C/ 为/ 本文/ 方法/ 配准/ 后/ 的/ 融合/ 结果/ ,/ D/ 为/ 特征/ 点集/ 匹配/ 情况/ ./ 从图/ 中/ 结果/ 可见/ 本文/ 采用/ 的/ 多/ 尺度/ 特征/ 点/ 具有/ 良好/ 的/ 抗噪性/ ,/ 且/ 在/ 两幅/ 图像/ 配准/ 的/ 同时/ ,/ 对应/ 的/ 特征/ 点/ 也/ 匹配/ 得/ 较为/ 准确/ ./ 于/ 灰度/ 特征/ 直方图/ 的/ 互信息/ 方法/ 仅/ 在/ 图像/ 变化/ 不大时/ 才/ 能够/ 达到/ 一定/ 精度/ ,/ 总体/ 配准/ 成功率/ 明显/ 偏低/ ./ 5.4/ ./ 3/ 多模/ 图像/ 配准/ 比较/ 实验/ 在/ 实际/ 临床/ 应用/ 和/ 医学/ 图像/ 分析/ 中/ ,/ 单一/ 模态/ 图像/ 通常/ 不能/ 提供/ 医生/ 所/ 需要/ 的/ 足够/ 信息/ ,/ 往往/ 需要/ 将/ 应用/ 各种/ 模式/ 所/ 得到/ 的/ 医学/ 图像/ 信息/ 融合/ 起来/ 进行/ 临床/ 判断/ ./ 为了/ 检验/ 特征/ 点/ R/ é/ nyi/ 互信息/ 在/ 多模/ 图像/ 配准/ 上/ 的/ 精度/ ,/ 我们/ 采用/ 美国/ 范/ 德堡/ 大学/ 的/ CT/ -/ MRI/ 数据库/ 中/ 的/ 数据/ 来/ 做/ 测试/ ./ 图/ 9/ 是/ T1MR/ 图像/ 与/ T2MR/ 图像/ 配准/ 的/ 例子/ ,/ 其中/ T2MR/ 图像/ 中/ 边缘/ 骨骼/ 部分/ 十分/ 明显/ ,/ 在/ 颅骨/ 的/ 内/ 外侧/ 都/ 形成/ 特征/ 点/ (/ A/ )/ ,/ 而/ T1MR/ 图像/ 只/ 在/ 颅骨/ 内侧/ 分布/ 有/ 较/ 密集/ 特征/ 点/ (/ B/ )/ ./ 虽然/ 特征/ 点/ 数目/ 不同/ ,/ 但/ 两图/ 在/ 颅骨/ 内侧/ 的/ 特征/ 点/ 分布/ 位置/ 十分/ 相近/ ,/ 因此/ 在/ 本/ 方法/ 最终/ 的/ 配准/ 结果/ 中/ (/ C/ ,/ D/ )/ ,/ 颅骨/ 内侧/ 的/ 点/ 匹配/ 得/ 很/ 好/ ,/ 而/ 外侧/ 的/ 点/ 规则/ 地/ 分布/ 在/ 周围/ 且/ 不/ 与/ 内侧/ 点/ 发生/ 误配/ ,/ 达到最佳/ 的/ 整体/ 点集/ 配准/ ./ 图/ 10/ 是/ CT/ 与/ MR/ 图像/ 配准/ 的/ 例子/ ./ 对/ CT/ 图像/ 与/ MR/ 图像/ ,/ 特征/ 点/ 提取/ 的/ 数目/ 与/ 位置/ 都/ 不同/ (/ 图/ A/ ,/ B/ )/ ,/ 但/ 颅骨/ 部分/ 的/ 点/ 分布/ 都/ 较完整/ ./ 因此/ 最终/ 的/ 匹配/ 结果/ 中/ 颅骨/ 轮廓/ 得到/ 了/ 很/ 好/ 的/ 配准/ ,/ 而/ 两图/ 在/ 颅内/ 的/ 不同/ 区域/ 提取/ 的/ 特征/ 点/ 恰好/ 错开/ 分布/ ,/ 避免/ 发生/ 误配/ ,/ 整体/ 配准/ 最优/ (/ 图/ C/ ,/ D/ )/ ./ Page8/ 表/ 2/ 和表/ 3/ 分别/ 给出/ 了/ 6/ 种/ 方法/ 的/ 配准/ 实验/ 结果/ ./ 在/ 多模/ 图像/ 配准/ 中/ ,/ 图像/ 成像/ 方式/ 不同/ ,/ 待/ 配准/ 图像/ 内容/ 并/ 不/ 一致/ ,/ 灰度/ 信息/ 差异/ 大/ ,/ 呈/ 明显/ 的/ 非线性/ 关系/ [/ 20/ ]/ 且/ 含有/ 大量/ 噪声/ ,/ 使得/ 基于/ 图像/ 灰度/ 的/ 两表/ 2T1MR/ 与/ T2MR/ 图像/ 配准/ 结果/ 横轴/ 平移/ 配准/ 误差/ Δ/ x/ 纵轴/ 平移/ 配准/ 误差/ Δ/ y/ 旋转/ 角度/ 配准/ 误差/ Δ/ θ/ 配准/ 时间/ 特征/ 点/ R/ é/ nyi/ 互信息/ SIFT/ -/ RansacR/ é/ nyiEntropicGraph/ 特征/ 点/ R/ é/ nyi/ 互信息/ SIFT/ -/ RansacR/ é/ nyiEntropicGraph/ 表/ 3CT/ 与/ MR/ 图像/ 配准/ 结果/ 横轴/ 平移/ 配准/ 误差/ Δ/ x/ 纵轴/ 平移/ 配准/ 误差/ Δ/ y/ 旋转/ 角度/ 配准/ 误差/ Δ/ θ/ 配准/ 时间/ 5.5/ 参数/ 对/ 配准/ 精度/ 的/ 影响/ 本文/ 的/ 目标/ 函数/ 采用/ 的/ 是/ 含有/ 参数/ α/ 的/ R/ é/ nyi/ 互信息/ ./ 前面/ 的/ 证明/ 中/ 我们/ 选取/ 了/ 最佳/ 的/ 参数/ 水平/ 来/ 进行/ 配准/ ./ 然而/ ,/ 该/ 方法/ 依赖于/ 图像/ 、/ 特征/ 点/ 的/ 实际/ 位置/ 与/ 配准/ 期望/ 距离/ d/ ./ 不同/ 的/ 图像/ 在/ 算法/ 中/ 所/ 求得/ 的/ 参数/ α/ 并不相同/ ./ 为/ 测试/ 本文/ 的/ 算法/ 对/ 参数/ 的/ 敏感度/ ,/ 我们/ 选取/ 两幅/ 已/ 对齐/ 的/ 多模/ 图像/ ,/ 对/ 其中/ 一幅/ 进行/ 平移/ 和/ 旋转/ 后/ 作为/ 浮动/ 图像/ ,/ 固定/ 参数/ α/ 的/ 值/ ,/ 分别/ 用/ 本文/ 方法/ 和/ 基于/ 灰度/ 的/ R/ é/ nyi/ 互信息/ 方法/ 进行/ 配准/ ./ 图/ 11/ 描述/ 了/ 上述/ 实验/ 结果/ ./ 其中/ 横坐标/ 为/ 参数值/ ,/ 纵坐标/ 为/ 配准/ 精度/ ,/ 分别/ 单独/ 进行/ 平移/ 或/ 旋转/ 构成/ 浮动/ 图像/ ./ 图中/ 同色/ 的/ 3/ 条/ 曲线/ 表示/ 在/ 不同/ 的/ 参种/ 互信息/ 方法/ 配准/ 精度/ 都/ 较/ 低/ ./ 由于/ 合理/ 参数/ 水平/ 下/ 的/ R/ é/ nyi/ 互信息/ 比/ Shannon/ 互信息/ 函数/ 更/ 平滑/ ,/ 局部/ 极值/ 少/ (/ 如图/ 2/ )/ ,/ 所以/ 基于/ 灰度/ 的/ R/ é/ nyi/ 互信息/ 配准/ 结果/ 略高于/ 归一化/ 互信息/ 与/ 加权/ 熵/ 互信息/ 的/ 结果/ ./ 在/ 多模/ 情况/ 中/ ,/ 两幅/ 图中/ 相近/ 特征/ 点/ 的/ 周围/ 局部/ 空间/ 像素/ 灰度/ 与/ 梯度/ 相差/ 极大/ ,/ 因此/ SIFT/ -/ Ransac/ 配准/ 方法/ 配准/ 成功率/ 非常低/ ./ 同样/ ,/ 由于/ 多模/ 图像/ 的/ 差异/ ,/ 使得/ 脑部/ 轮廓/ 差别/ 很大/ ,/ 轮廓/ 特征/ 点/ 配准/ 方法/ 精度/ 不高/ ./ 而/ 特征/ 点/ 最小/ 生成/ 树/ 的/ 差异/ 也/ 同时/ 影响/ 了/ 对/ R/ é/ nyi/ 熵/ 的/ 估计/ ,/ 使得/ R/ é/ nyi/ 熵/ 图/ 配准/ 方法/ 精度/ 低于/ 灰度/ R/ é/ nyi/ 互信息/ 方法/ 的/ 精度/ ./ 本文/ 方法/ 结合/ 了/ 以上/ 方法/ 的/ 优点/ :/ 既/ 利用/ 了/ R/ é/ nyi/ 互信息/ 函数/ 的/ 优良/ 性质/ ,/ 又/ 采用/ 了/ 特征/ 点/ 的/ 空间/ 位置/ 进行/ 配准/ ,/ 避免/ 了/ 多模/ 图像/ 灰度/ 差异/ 的/ 影响/ ./ 表/ 2/ 和表/ 3/ 也/ 显示/ 了/ 在/ 成功率/ 和/ 速度/ 的/ 评判/ 上/ ,/ 本/ 方法/ 明显/ 优于/ 其他/ 几种/ 方法/ ./ Page9/ 数/ 水平/ 下/ 沿/ X/ ,/ Y/ 轴/ 平移/ 和/ 旋转/ 对/ 配准/ 精度/ 的/ 影响/ ./ 图中/ 基于/ 灰度/ 的/ R/ é/ nyi/ 互信息/ 受/ 参数/ 的/ 影响/ 波动/ 较大/ ,/ 而/ 基于/ 特征/ 点/ 的/ R/ é/ nyi/ 互信息/ 受/ 参数/ 影响/ 不/ 明显/ ,/ 函数/ 线/ 平滑/ 并/ 有/ 相当/ 长/ 的/ 距离/ 趋于/ 水平/ ,/ 精度/ 也/ 高于/ 前者/ ./ 这/ 主要/ 是因为/ 该/ 方法/ 只/ 利用/ 特征/ 点/ 空间/ 位置/ 计算/ 联合/ 概率分布/ ./ 而/ 多模/ 情况/ 下/ 灰度/ 直方图/ 构成/ 的/ 目标/ 函数/ 计算/ 不/ 准确/ ,/ 受/ 参数/ 影响/ 大/ ./ 6/ 结论/ 本文/ 在/ 提取/ 的/ 稳定/ 多/ 尺度/ 噪声/ 点/ 基础/ 上/ ,/ 结合/ R/ é/ nyi/ 互信息/ 理论/ 提出/ 了/ 基于/ 特征/ 点/ R/ é/ nyi/ 互信息/ 医学/ 图像/ 配准/ 方法/ ./ 该/ 方法/ 的/ 目标/ 函数/ 是/ 通过/ 对/ 特征/ 点/ 的/ 空间/ 坐标/ 直接/ 计算/ 得到/ 的/ ,/ 有效/ 避免/ 了/ 多模/ 噪声/ 图像/ 间/ 的/ 灰度/ 差异/ ,/ 处理/ 数据量/ 小/ ,/ 速度/ 快/ ./ 同时/ 吸收/ 了/ R/ é/ nyi/ 互信息/ 局部/ 极值/ 少/ 的/ 优点/ ,/ 进一步提高/ 了/ 配准/ 精度/ ./ 与/ 多种/ 配准/ 方法/ 相比/ ,/ 该/ 方法/ 速度/ 较/ 快/ 、/ 精度高/ ,/ 是/ 一种/ 有效/ 的/ 自动/ 配准/ 方法/ ./ 

