Page1/ 入侵/ 容忍/ 实时/ 数据库/ 的/ 半/ 马尔可夫/ 生存能力/ 评价/ 模型/ 陈长/ 清/ 裴/ 小兵/ 周恒/ 刘云生/ (/ 华中科技大学/ 软件/ 学院/ 武汉/ 430074/ )/ 摘要/ 针对/ 事务/ 和/ 数据/ 的/ 实时/ 特性/ ,/ 给出/ 了/ 具有/ 入侵/ 容忍/ 能力/ 的/ 实时/ 数据库系统/ 的/ 体系/ 架构/ ./ 基于/ 实时性/ 的/ 要求/ 和/ 入侵/ 检测/ 存在/ 的/ 延迟/ ,/ 提出/ 了/ 半/ 马尔可夫/ 评价/ 模型/ ,/ 对/ 实时/ 数据库/ 在/ 入侵/ 容忍/ 条件/ 下/ 的/ 生存能力/ 进行/ 评价/ ,/ 并/ 根据/ 此/ 模型/ 给出/ 相关/ 的/ 量化/ 准则/ ,/ 定义/ 了/ 完整性/ 与/ 可用性/ 等/ 生存性/ 指标/ ,/ 对/ 实时/ 数据库/ 的/ 生存能力/ 进行/ 了/ 验证/ ./ 由于/ 误报/ 、/ 检出率/ 和/ 攻击/ 强度/ 等/ 因素/ 会/ 对/ 生存能力/ 造成/ 重大/ 影响/ ,/ 因此/ 利用/ TPC/ -/ C/ 基准/ 测试/ 对/ 其/ 进行/ 了/ 详细/ 的/ 数据分析/ ./ 实验/ 表明/ ,/ 该/ 模型/ 能/ 较/ 准确/ 地/ 预测/ 实时/ 数据库/ 的/ 行为/ ,/ 所/ 提出/ 的/ 入侵/ 容忍/ 实时/ 数据库/ 在/ 面临/ 攻击/ 时/ ,/ 其/ 基本/ 生存能力/ 没有/ 受到/ 严重/ 的/ 影响/ ./ 关键词/ 入侵/ 容忍/ ;/ 实时/ 数据库/ ;/ 生存性/ ;/ 评价/ 模型/ 1/ 引言/ 数据库/ 入侵/ 容忍/ 技术/ 改变/ 了/ 传统/ 的/ 以/ 防御/ 、/ 检测/ 、/ 响应/ 和/ 恢复/ 为主/ 的/ 思想/ ,/ 它/ 假定/ 系统/ 中/ 存在/ 一些/ 恶意/ 事务/ 攻击/ ,/ 在/ 系统/ 可容忍/ 的/ 限度/ 内/ ,/ 这些/ 攻击/ 不会/ 对系统/ 的/ 服务/ 造成/ 灾难性/ 影响/ ,/ 系统/ 本身/ 仍能/ 保证/ 最低/ 质量/ 的/ 服务/ ./ 为了/ 评价/ 一个/ 数据库系统/ 抵抗/ 持续/ 入侵/ 的/ 能力/ ,/ 需要/ 建立/ 定量/ 评价/ 模型/ ,/ 根据/ 该/ 模型/ 还/ 能/ 比较/ 不同/ 的/ 入侵/ 容忍/ 架构/ ./ 文献/ [/ 1/ ]/ 提出/ 针对/ Page2/ 传统/ 数据库/ 的/ 入侵/ 容忍/ 生存/ 评价/ 模型/ ,/ 并/ 假设/ 入侵/ 是/ 由/ 随机/ 的/ 攻击/ 造成/ 的/ ,/ 例如/ 马尔可夫/ 模型/ ./ 在/ 该/ 模型/ 中/ ,/ 事务/ 状态/ 间/ 的/ 转换/ 概率/ 服从/ 负/ 指数函数/ 分布/ ,/ 事务/ 交互/ 的/ 时间/ 已经/ 给出/ 并且/ 定义/ 为/ 常数/ ./ 但/ 在/ 实际/ 应用/ 中/ ,/ 许多/ 已经/ 成功/ 的/ 真实/ 入侵/ 却是/ 由/ 人为因素/ 造成/ 的/ ,/ 故而/ 建模/ 时/ 还/ 需/ 综合/ 考虑/ 这些/ 因素/ ./ 半/ 马尔可夫/ 模型/ 对/ 其/ 进行/ 了/ 拓展/ ,/ 还/ 允许/ 非/ 指数函数/ 分布/ 地/ 存在/ ,/ 由于/ 事务/ 间/ 的/ 交互/ 具有/ 随机性/ ,/ 相比/ 于/ 马尔可夫/ 链/ ,/ 半/ 马尔可夫/ 链/ 模型/ 中/ 的/ 非/ 指数函数/ 更/ 适合/ 模拟/ 这些/ 较/ 实际/ 问题/ ,/ 文献/ [/ 2/ ]/ 提出/ 了/ 针对/ 传统/ 数据库/ 的/ 基于/ 半/ 马尔可夫/ 的/ 生存/ 评价/ 模型/ ./ 相对/ 于/ 传统/ 数据库/ ,/ 实时/ 数据库系统/ 的/ 本质特征/ 就是/ 事务/ 和/ 数据/ 有/ 定时/ 限制/ ,/ 系统/ 的/ 正确性/ 不仅/ 依赖于/ 逻辑/ 结果/ ,/ 而且/ 还/ 和/ 逻辑/ 结果/ 所/ 产生/ 的/ 时间/ 有关/ ./ 为此/ ,/ 结合/ 实时性/ 的/ 要求/ ,/ 提出/ 了/ 入侵/ 容忍/ 实时/ 数据库/ 的/ 半/ 马尔可夫/ 生存/ 评价/ 模型/ ,/ 使/ 其能/ 应用/ 到/ 实时/ 数据库/ 中/ ./ 因为/ 实时/ 数据库/ 具有/ 时限/ 要求/ ,/ 如果/ 状态/ 定义/ 的/ 粒度/ 较/ 粗/ ,/ 会达/ 不到/ 细粒度/ 要求/ ,/ 也/ 就/ 不能/ 充分/ 评价/ 实时/ 系统/ 的/ 生存能力/ ./ 本文/ 所/ 提半/ 马尔可夫/ 生存/ 评价/ 模型/ 考虑/ 了/ 实时/ 数据库系统/ 中/ 事务/ 的/ 软硬/ 实时/ 要求/ 、/ 事务/ T/ -/ SQL/ 序列/ 长短/ 、/ 事务/ 与/ 事务/ 执行/ 时间/ 间隔/ 分布/ 不均/ 等/ 因素/ ,/ 是/ 针对/ 实时/ 数据库/ 生存/ 评价/ 的/ 一种/ 实用/ 模型/ ./ 本文/ 第/ 2/ 节/ 介绍/ 本/ 研究/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 给出/ 改进/ 的/ 入侵/ 容忍/ 实时/ 数据库/ 体系结构/ ;/ 第/ 4/ 节/ 提出/ 相应/ 的/ 半/ 马尔可夫/ 生存/ 评价/ 模型/ ,/ 并/ 予以/ 分析/ 和/ 求解/ ;/ 第/ 5/ 节/ 提出/ 相应/ 的/ 生存性/ 评价/ 准则/ ;/ 第/ 6/ 节/ 通过/ TPC/ -/ C/ [/ 3/ ]/ 验证/ 模型/ 的/ 有效性/ ;/ 第/ 7/ 节对/ 误报/ 、/ 检出率/ 和/ 攻击/ 强度/ 这/ 3/ 个/ 重要/ 因素/ 的/ 影响/ 进行/ 详细/ 数据分析/ ;/ 最后/ 在/ 第/ 8/ 节/ 得出/ 全文/ 结论/ ./ 2/ 相关/ 工作/ 大多数/ 关于/ 生存能力/ 的/ 研究/ 是从/ 定性/ 的/ 角度/ 来/ 考虑/ 的/ ,/ 较/ 少有/ 文献/ 讨论/ 定量/ 的/ 生存性/ 评价/ 指标/ ./ 文献/ [/ 4/ ]/ 给出/ 了/ 生存性/ 的/ 形式化/ 定义/ ,/ 并/ 和/ 相关/ 的/ 概念/ ,/ 如/ 可靠性/ 、/ 可用性/ 和/ 依赖性/ 进行/ 了/ 比较/ ./ 文献/ [/ 5/ ]/ 从/ 几个/ 方面/ 定义/ 了/ 生存性/ ,/ 说明/ 了/ 生存性/ 和/ 可靠性/ 的/ 差别/ 在于/ :/ 用户/ 能/ 接受/ 可/ 生存/ 系统/ 的/ 降级/ 服务/ ,/ 而/ 可靠性/ 假设/ 系统/ 要么/ 能/ 用/ 要么/ 不能/ 用/ ./ 但/ 这些/ 文献/ 对/ 生存性/ 的/ 量化/ 和/ 降级/ 服务/ 的/ 程度/ 都/ 没有/ 考虑/ ./ 文献/ [/ 6/ ]/ 讨论/ 把/ 现有/ 的/ 基于/ 模型/ 的/ 可靠性/ 评价/ 技术/ 扩展/ 到/ 评估/ 系统/ 的/ 安全性/ ,/ 但/ 困难/ 在于/ 错误/ 的/ 偶然/ 特性/ 和/ 网络攻击/ 的/ 人为/ 特征/ 之间/ 有/ 本质/ 差别/ ./ 文献/ [/ 7/ ]/ 把/ 对/ 入侵/ 容忍/ 系统/ 的/ 攻击/ 与/ 响应/ 按/ 随机/ 处理/ 建模/ ,/ 给出/ 了/ 系统/ 的/ 量化/ 的/ 安全/ 属性/ ,/ 实验/ 中/ 模型/ 参数/ 使用/ 了/ 推测/ 值/ ,/ 而/ 缺乏/ 对模型/ 的/ 验证/ ./ 安全/ 的/ 量化/ 验证/ 常/ 使用/ 形式化/ 方法/ [/ 8/ ]/ ./ 文献/ [/ 9/ ]/ 通过/ 随机/ 模型/ 进行/ 概率/ 验证/ ,/ 这是/ 验证/ 入侵/ 容忍/ 的/ 一个/ 有/ 吸引力/ 的/ 手段/ ,/ 该文/ 利用/ 随机/ 行为/ 网络/ 来/ 定量/ 验证/ 一个/ 入侵/ 容忍/ 的/ 复制/ 管理系统/ ,/ 在/ 模型/ 之上/ 提出/ 了/ 几种/ 度量/ 手段/ ,/ 并/ 研究/ 了/ 参数/ 变化/ 对/ 生存性/ 的/ 影响/ ./ 尽管/ 文献/ 中/ 已/ 提出/ 几种/ 生存性/ 模型/ 和/ 相应/ 的/ 度量/ ,/ 但/ 它们/ 都/ 局限于/ 评估/ 入侵/ 容忍/ 数据库系统/ 的/ 安全/ 属性/ ./ 文献/ [/ 10/ ]/ 研究/ 在/ 可/ 生存/ 数据库系统/ 中/ 提供/ 有/ 一致性/ 保证/ 的/ 服务/ ./ 文献/ [/ 11/ ]/ 提出/ 针对/ 工作/ 流/ 的/ 在线/ 攻击/ 恢复/ 系统/ ,/ 对/ 恢复/ 系统/ 的/ 行为/ 分析/ 是/ 基于/ 连续/ 时间/ 马尔可夫/ 链/ 模型/ ,/ 包括/ 了/ 稳态/ 和/ 状态/ 转换/ 行为/ ./ 文献/ [/ 12/ ]/ 根据/ 入侵/ 检测/ 的/ 缺陷/ ,/ 利用/ TPC/ -/ C/ 定量/ 评价/ 了/ 其/ 对/ 生存性/ 的/ 影响/ ,/ 但/ 没有/ 提到/ 系统性/ 的/ 生存/ 模型/ 和/ 度量/ 标准/ ,/ 文献/ [/ 2/ ]/ 提出/ 了/ 入侵/ 容忍/ 数据库系统/ 的/ 连续/ 时间/ 半/ 马尔可夫/ 链/ 生存/ 评价/ 模型/ ,/ 基于/ 状态/ 转换/ 是非/ 指数分布/ 的/ ./ 文献/ [/ 13/ ]/ 在/ 传统/ 数据库/ 恶意/ 事务/ 修复/ 方案/ 的/ 基础/ 上/ ,/ 采用/ Petri/ 网/ 模型/ 分析/ 事务/ 撤销/ 冲突/ 和/ 操作/ 执行/ 序列/ 异常/ 检测/ ,/ 进而/ 结合/ 可/ 生存性/ DBMS/ 特征/ 提出/ 恶意/ 事务/ 静态/ 和/ 在线/ 修复/ 算法/ ,/ 给出/ 随机/ Petri/ 网/ 恶意/ 事务/ 修复/ 模型/ ,/ 在/ 分析/ 恶意/ 事务/ 修复/ 随机/ Petri/ 网/ 模型/ 和/ 连续/ 时间/ 马尔可夫/ 链/ 的/ 一致性/ 后/ ,/ 给出/ 了/ 连续/ 时间/ 马尔可夫/ 链/ 的/ 恶意/ 事务/ 修复/ 模型/ 求解/ ./ 文献/ [/ 14/ ]/ 在/ 数据库系统/ 内部/ 设计/ 和/ 实现/ 了/ 一种/ 受损/ 数据/ 隔离/ 策略/ 语言/ ,/ 提出/ 了/ 一种/ 有效/ 的/ 受损/ 隔离/ 算法/ ,/ 该/ 算法/ 使用/ SQL/ 语句/ 动态/ 替换/ 技术/ 尽量/ 保证/ 隔离/ 阶段/ 用户/ 请求/ 数据/ 的/ 完整性/ ,/ 通过/ 子/ 查询/ 动态/ 视图/ 替换法/ 保证数据/ 隔离/ 的/ 有效性/ ./ 文献/ [/ 15/ ]/ 提出/ 事务/ 融合/ 策略/ 以/ 缩短/ 修复/ 时间/ ,/ 文献/ [/ 16/ ]/ 考虑/ 了/ 实时/ 数据库/ 事务/ 的/ 定时/ 特性/ ,/ 将/ 事务/ 融合/ 策略/ 应用/ 到/ 实时/ 数据库/ 的/ 修复/ 中/ ./ 文献/ [/ 17/ ]/ 研究/ 利用/ 时间/ 标记/ 进行/ 实时/ 数据库/ 的/ 入侵/ 检测/ ./ 3/ 入侵/ 容忍/ 实时/ 数据库/ 体系结构/ 入侵/ 容忍/ 实时/ 数据库系统/ (/ IntrusionTolerantReal/ -/ timeDatabase/ ,/ ITRDB/ )/ 要/ 保证/ :/ 在/ 被/ 入侵/ 之后/ ,/ 系统/ 能/ 在/ 时限/ 内/ 尽快/ 自动/ 定位/ 、/ 控制/ 和/ 修复/ 被/ 损坏/ 的/ 部分/ ,/ 使/ 实时/ 数据库系统/ 在/ 遭受/ 入侵/ 的/ 情况/ 下/ 可以/ 继续/ 被/ 使用/ ./ 在/ 文献/ [/ 18/ ]/ 的/ 基础/ 上/ ,/ 我们/ 对/ 国产化/ 实时/ 数据库/ 管理系统/ ARTs/ -/ EDB/ 的/ 入侵/ 容忍/ 体/ Page3/ 系/ 结构/ 进行/ 了/ 改进/ ,/ 使/ 其能/ 适应/ 半/ 马尔可夫/ 评价/ 模型/ 的/ 要求/ ,/ 如图/ 1/ 所示/ ,/ 主要/ 由/ 策略/ 执行/ 、/ 攻击/ 检测/ 、/ 损害/ 评价/ 、/ 损害/ 修复/ 、/ 隔离/ 等/ 模块/ 构成/ ./ ITRDB/ 主要/ 关注/ 已/ 提交/ 的/ 恶意/ 事务/ ,/ 认为/ 即使/ 是/ 未/ 提交/ 的/ 活动/ ,/ 恶意/ 事务/ 也/ 不会/ 产生/ 影响/ (/ 因为/ 事务/ 的/ 原子/ 属性/ )/ ,/ 一旦/ 提交/ 则/ 会/ 产生/ 影响/ ,/ 而且/ 在/ 检测/ 延迟/ 期内/ ,/ 损害/ 可能/ 已经/ 蔓延到/ 许多/ 其它/ 的/ 数据项/ 中/ ,/ 即/ 恶意/ 事务/ 扩散/ ./ 为了/ 克服/ 这种/ 局限性/ ,/ ITRDB/ 采用/ 隔离/ 技术/ 与/ 损害/ 控制/ 相结合/ 的/ 方法/ ./ ITRDB/ 中/ 各/ 部件/ 的/ 功能/ 介绍/ 如下/ :/ 攻击/ 检测器/ (/ attackdetector/ )/ 通过/ 系统日志/ 和/ 审计/ 文件/ 检测/ 恶意/ 事务/ 或/ 可疑/ 事务/ ;/ 损害/ 评价/ 器/ (/ damageassessor/ )/ 通过/ 系统日志/ 和/ 审计/ 文件/ 标识/ 恶意/ 事务所/ 损害/ 的/ 数据/ ;/ 隔离/ 管理器/ 对/ 恶意/ 事务/ 和/ 可疑/ 事务/ 进行/ 隔离/ ;/ 生存/ 评价/ 器/ (/ survivabilityestimator/ )/ 对/ 恶意/ 事务/ 发生/ 后/ 的/ 影响/ 进行/ 完整性/ 与/ 可用性/ 等/ 指标/ 的/ 评价/ ,/ 通过/ 扫描/ 攻击/ 历史/ (/ attackhistories/ )/ ,/ 根据/ 数学模型/ 预测/ 数据/ 的/ 生存性/ 和/ 脏/ 数据/ 集/ ;/ 损害/ 修复器/ (/ damagerepairer/ )/ 则/ 用/ 补偿/ 机制/ 来/ 修复/ 损害/ 评价/ 器/ 和/ 生存/ 评价/ 器所/ 报告/ 的/ 受损/ 数据/ ./ 策略/ 执行/ 管理器/ (/ PolicyEnforcementManager/ ,/ PEM/ )/ 用于/ 代理/ 用户/ 事务/ ,/ 执行/ 系统/ 级/ 的/ 入侵/ 容忍/ 策略/ ,/ 当/ 事务/ 被/ 攻击/ 检测器/ 判定/ 为/ 可疑/ 事务时/ ,/ 该/ 事务/ 被/ 隔离/ 管理器/ 隔离/ ,/ 对应/ 用户/ 随后/ 提交/ 的/ 事务/ 也/ 都/ 被/ 隔离/ ;/ 当/ 事务/ 被/ 攻击/ 检测器/ 判定/ 为/ 恶意/ 事务时/ ,/ 该/ 用户/ 及其/ 行为/ 被/ 写入/ “/ 历史记录/ ”/ 中/ ,/ 该/ 用户/ 提交/ 新/ 事务/ 时会/ 由/ PEM/ 阻止/ ./ 4/ 入侵/ 容忍/ 实时/ 数据库/ 的/ 生存/ 评价/ 模型/ 为了/ 更加/ 全面/ 地/ 分析/ 和/ 评价/ ITRDB/ 的/ 生存能力/ ,/ 且/ 能/ 捕捉到/ 系统/ 所处/ 的/ 各种/ 状态/ ,/ 建立/ 了/ 一个半/ 马尔可夫/ 定量/ 评价/ 模型/ ./ 下面/ 将/ 首先/ 建立/ 半/ 马尔可夫/ 生存/ 评价/ 的/ 简单/ 模型/ ,/ 然后/ 再/ 考虑/ 入侵/ 检测/ 的/ 参数/ ,/ 拓展/ 成/ 一个/ 综合/ 的/ 应用/ 模型/ ./ 4.1/ 简单/ 评价/ 模型/ 图/ 2/ 显示/ 了/ 一个/ ITRDB/ 的/ 基本/ 状态/ 转换/ 模型/ ./ 在/ 该/ 模型/ 中/ ,/ 系统/ 的/ 运行/ 状态/ 主要/ 是/ 由/ 事务/ 特征/ 属性/ 所/ 标识/ ,/ 例如/ :/ 事务/ 的/ 大小/ 、/ 事务/ 的/ 数量/ 、/ 当前/ 用户/ 的/ 数量/ 和/ 事务/ 的/ 截止/ 时间/ ./ 将/ 这些/ 数值/ 型/ 变量/ 、/ 标称/ 变量/ 的/ 取值/ 与/ 标准/ 的/ 参数/ 预设值/ 进行/ 比较/ ,/ 然后/ 对/ 不同/ 数值/ 集合/ 进行/ 划分/ ,/ 从而/ 可定义/ 为/ 一定/ 的/ 系统/ 状态/ ,/ 也/ 称/ 状态/ 空间/ ,/ 如下/ 所示/ ./ 一切正常/ ./ 防/ 机制/ 失败/ 受到/ 恶意/ 事务/ 感染/ ./ 主要/ 检疫/ 活动/ ,/ 即/ 判断/ 可疑/ 事务/ 等/ ./ 时限/ 要求/ 进行/ 修复/ 必要性/ 判断/ ./ 定义/ 1/ ./ 良好/ 状态/ G/ :/ 表示/ ITRDB/ 系统/ 状态/ 定义/ 2/ ./ 感染/ 状态/ I/ :/ 表示/ ITRDB/ 系统/ 由于/ 预定/ 义/ 3/ ./ 检疫/ 状态/ Q/ :/ 表示/ ITRDB/ 系统/ 进行/ 定义/ 4/ ./ 判定/ 状态/ J/ :/ 表示/ ITRDB/ 系统/ 根据/ 定义/ 5/ ./ 修复/ 状态/ R/ :/ 表示/ ITRDB/ 系统/ 进行/ 主要/ 事务/ 修复/ 与/ 恢复/ 活动/ ./ 定义/ 6/ ./ 补偿/ 操作/ :/ 表示/ ITRDB/ 系统/ 弥补/ 操作/ ,/ 如/ 事务处理/ 回滚/ 、/ 事务/ 检测点/ 恢复/ 、/ 补偿/ 事务/ 执行/ 等/ ./ 传统/ 上/ ,/ 计算机/ 的/ 安全/ 首先/ 依赖于/ 系统/ 的/ 预防/ ,/ 在/ 图/ 1/ 所示/ ITRDB/ 系统/ 的/ 事务/ 代理/ 机制/ 中/ ,/ 一般/ 引进/ 预处理/ 过程/ ./ 如果/ 预防/ 的/ 策略/ 失败/ ,/ 系统/ 在/ 攻击/ 检测/ 阶段/ 将会/ 从/ 良好/ 状态/ G/ 转变/ 为/ 感染/ 状态/ I/ ./ 如果/ 攻击/ 被/ 成功/ 地/ 检测/ 到/ ,/ 入侵/ 容忍/ 系统/ 采取/ 攻击/ 防护/ 策略/ ,/ 从而/ 进入/ 检疫/ 状态/ Q/ ./ 在/ Q/ 状态/ 下/ ,/ 所有/ “/ 可疑/ 事务/ ”/ 都/ 将/ 会/ 被/ 加载/ 进来/ ,/ 然后/ 对/ 所有/ 的/ 人为/ 攻击/ 的/ 损害/ 进行/ 标记/ 后/ ,/ 把/ 未/ 被/ 损害/ 或者/ 误判/ 的/ 事务/ 释放/ ./ 传统/ 数据库系统/ 由于/ 没有/ 时限/ 要求/ ,/ 可/ 直接/ 进入/ 修复/ 状态/ ,/ 完成/ 修复/ 后/ 返回/ 到/ 良好/ 状态/ G/ ./ 但是/ ,/ 在/ 实时/ 数据库系统/ 中/ ,/ 由于/ 时限/ 的/ 要求/ ,/ 需要/ 先/ 进入/ 判定/ 状态/ J/ ,/ 根据/ 日志/ 与/ 审计/ 表/ ,/ 判定/ 待/ 修复/ 的/ 事物/ 是否/ 满足/ 硬/ 实时/ 与/ 软/ 实时/ 需求/ ,/ 若/ 是/ ,/ 则/ 进入/ 到/ 修复/ 状/ Page4/ 态/ R/ ,/ 进行/ 定义/ 6/ 的/ 补偿/ 操作/ (/ 修复/ 或者/ 恢复/ 所有/ 的/ 损害/ )/ ,/ 修复/ 完成/ 后/ 返回/ 良好/ 状态/ G/ ;/ 若否/ ,/ 则/ 将/ 所/ 处理/ 的/ 事务/ 抛弃/ ,/ 返回/ 到/ 良好/ 状态/ G/ ./ 在/ 已/ 定义/ 的/ 状态/ 下/ ,/ 为了/ 保证/ 入侵/ 容忍/ 数据库系统/ 的/ 设计/ 及/ 实施/ 的/ 基本/ 要求/ ,/ ITRDB/ 活动/ 一般/ 分为/ 5/ 个/ 阶段/ ,/ 依次/ 为/ 攻击/ 渗透/ 、/ 错误/ 检测/ 、/ 攻击/ 检疫/ 、/ 损害/ 评价/ 和/ 错误/ 恢复/ ,/ 它们/ 描述/ 了/ 每个/ 入侵/ 容忍/ 数据库系统/ 都/ 将/ 会/ 遇到/ 的/ 基本/ 问题/ ./ 由于/ 人为/ 攻击/ 的/ 存在/ ,/ 从/ G/ 状态/ 转换/ 到/ I/ 状态/ 的/ 转变/ 并不一定/ 服从/ 指数分布/ ,/ 所以/ 该/ 随机/ 过程/ 不是/ 一个/ 连续/ 时间/ 马尔可夫/ 链/ ./ 半/ 马尔可夫/ 模型/ 相比/ 于/ 马尔可夫/ 链/ ,/ 能/ 更好/ 地/ 适应/ 实际/ 应用/ ,/ 在/ 执行/ 事务/ 之间/ 的/ 逗留/ 时间/ 可以/ 任意/ 分配/ ./ 考虑/ 实时/ 数据库/ 中/ 事务/ 的/ 截止/ 时间/ 、/ 事务/ T/ -/ SQL/ 序列/ 长短/ 、/ 事务/ 与/ 事务/ 执行/ 时间/ 间隔/ 分布/ 不均/ 等/ 因素/ ,/ 通过/ ITRDB/ 在/ 面临/ 攻击/ 时/ 的/ 状态/ 转换/ ,/ 从/ 状态/ 空间/ 定义/ 和/ 状态/ 之间/ 的/ 复杂/ 转换/ 关系/ 这/ 两个/ 方面/ 来/ 建模/ ./ 设/ E/ =/ {/ 1/ ,/ 2/ ,/ 3/ ,/ …/ ,/ n/ }/ 表示/ 状态/ 空间/ ,/ Ω/ 为/ 概率/ 空间/ ./ 同时/ 定义/ 以下/ 的/ 随机变量/ :/ Xn/ :/ Ω/ →/ E/ 和/ Tn/ :/ Ω/ →/ IN/ ,/ 其中/ Xn/ 表示/ n/ 个/ 事务/ 转换/ 状态/ ,/ Tn/ 表示/ 处理/ n/ 个/ 事务/ 的/ 时间/ (/ T0/ =/ 0/ )/ ,/ tn/ 表示/ 处理/ 相应/ 的/ n/ 个/ 事务/ 的/ 时限/ 要求/ ,/ 与/ 事务/ 被/ 创建/ 时所/ 带有/ 的/ 时间/ 戳/ 相对/ 应/ ./ 设/ Vk/ =/ Tk/ +/ 1/ —/ Tk/ ,/ 表示/ 在/ 第/ k/ 次/ 诊断/ 状态/ 时/ 的/ 逗留/ 时间/ (/ k/ ∈/ E/ )/ ./ 那么/ (/ X/ ,/ T/ ,/ t/ )/ 过程/ 则/ 是/ 一个半/ 马尔可夫/ 综合/ 过程/ ./ 半/ 马尔可夫/ 综合/ 过程/ 的/ 核心/ K/ ,/ 其中/ K/ (/ t/ )/ =/ Kij/ (/ t/ )/ 被/ 定义/ 如下/ :/ Kij/ (/ t/ )/ =/ P/ [/ Xn/ +/ 1/ =/ j/ ,/ Vk/ / t/ |/ X0/ ,/ …/ ,/ Xn/ ;/ T0/ ,/ …/ ,/ Tn/ ]/ =/ P/ [/ Xn/ +/ 1/ =/ j/ ,/ Vk/ / t/ |/ Xn/ =/ i/ ]/ ./ 那么/ ,/ 当/ Pij/ =/ limt/ →/ Kij/ (/ t/ )/ 时/ ,/ 犘/ =/ Pij/ 为/ 包含/ 马设/ 矢量/ 狏/ =/ (/ v1/ ,/ v2/ ,/ …/ ,/ vn/ )/ 表示/ 包含/ 连续/ 时间/ 马尔可夫/ 链/ 的/ 稳态/ 概率/ ./ 为了/ 获得/ 稳态/ 概率/ ,/ 求解/ 方程/ 尔/ 可夫/ 链/ 的/ 状态/ 转换/ 概率/ 矩阵/ ./ 现在/ 可以/ 定义/ 条件/ 分布/ 函数/ (/ CDF/ )/ 在/ 状态/ i/ 逗留/ 的/ 时间/ 函数/ :/ Hi/ (/ t/ )/ =/ P/ [/ Tn/ +/ 1/ -/ Tn/ / t/ |/ Xn/ =/ i/ ]/ ./ 一般/ 地/ ,/ 可以/ 采用/ 折扣/ 指标/ 或者/ 平均指标/ 对半/ 马尔可夫/ 进行/ 决策分析/ ,/ 该/ 模型/ 中/ 采用/ 平均指标/ 进行/ 分析/ ,/ 设/ hi/ 为/ 状态/ i/ 的/ 平均/ 逗留/ 时间/ ,/ 即/ 其中/ ,/ max/ _/ t/ 表示/ 最大/ 软硬/ 时限/ 数值/ ,/ 积分/ 的/ 时间/ 超过/ 此/ 数值/ ,/ 则/ 时间/ 统计/ 失效/ ./ 设/ 向量/ 犺/ =/ (/ h1/ ,/ h2/ ,/ …/ ,/ hn/ )/ ,/ 且/ 假定/ 所有/ i/ ∈/ E/ ,/ hi/ </ ./ 半/ 马尔可夫/ 链/ 的/ 稳态/ 概率/ 定义/ 如下/ :/ 考虑/ 图/ 2/ 中/ 的/ 基本/ 模型/ ,/ 事务处理/ 状态/ 间/ 的/ 转换/ 可能/ 遵从/ 非/ 指数函数/ 分布/ ,/ 例如/ 韦伯/ 尔/ 分布/ 、/ 正态分布/ 与/ 指数分布/ 等/ ,/ 该/ 函数/ 理论/ 上/ 完全/ 可以/ 模拟/ 黑客/ 的/ 行为/ 以及/ 状态/ G/ 和/ I/ 之间/ 的/ 转变/ ./ 韦伯/ 尔/ 分布/ 由此/ 公式/ 给出/ :/ F/ (/ t/ )/ =/ 1/ -/ e/ -/ (/ t/ // β/ )/ α/ ,/ 其中/ α/ 为/ 规模/ 参数/ ,/ β/ 为/ 形状/ 参数/ ,/ 当/ α/ =/ 1/ 时/ ,/ 它/ 就/ 成/ 了/ 指数分布/ ./ 当/ α/ =/ 3.4/ 时则/ 相似/ 于/ 正态分布/ ./ 在/ 状态/ G/ 中/ 平均/ 逗留/ 时间/ hG/ 由/ 以下/ 公式/ 给出/ :/ hG/ =/ ∫/ max/ _/ t/ 其中/ ,/ Γ/ 是/ 关于/ 整数/ N/ 的/ 函数/ ,/ Γ/ (/ N/ )/ =/ (/ N/ -/ 1/ )/ !/ ./ 简单/ 地/ ,/ 仍/ 假定/ 检测/ 攻击/ 的/ 时间/ 、/ 标记/ 损坏/ 数据项/ 的/ 时间/ 、/ 修复/ 损害/ 时间/ 、/ 错误/ 恢复/ 时间/ 以及/ 判定/ 处理/ 时间/ 服从/ 指数分布/ ,/ 且/ 参数/ 依次/ 为/ λ/ ,/ λ/ d/ ,/ λ/ m/ ,/ λ/ k/ 和/ λ/ r/ ,/ 那么/ ,/ 平均/ 逗留/ 时间/ 表示/ 如下/ :/ 由图/ 2/ 的/ 模型/ ,/ 可/ 得/ 狏/ =/ VG/ ,/ VI/ ,/ VQ/ ,/ VR/ ,/ VJ/ ./ 为了/ 得到/ 5/ 种/ 状态/ 的/ 稳态/ 概率/ ,/ 求解/ 方程/ (/ 1/ )/ 和/ (/ 2/ )/ ,/ 可/ 得/ π/ G/ =/ β/ Γ/ (/ 1/ +/ α/ )/ -/ 1/ 烄/ π/ I/ =/ π/ Q/ =/ 烅/ π/ R/ =/ π/ J/ =/ 烆/ 4.2/ 综合/ 评价/ 模型/ 出于/ 简单/ 考虑/ ,/ 2.1/ 节中/ 的/ 模型/ 并/ 没有/ 考虑/ 入侵/ 检测/ 系统/ (/ IDS/ )/ 本身/ 的/ 性能/ ,/ 只是/ 假定/ IDS/ 可以/ 毫不/ 拖延/ 地/ 报告/ 入侵/ ./ 但是/ 在/ 实时/ 环境/ 下/ ,/ IDS/ 的/ 响应/ 能力/ 却是/ 很/ 重要/ 的/ ,/ 延时/ 过长/ 将会/ 导致/ 大量/ 的/ 恶意/ 事务/ 传播/ ,/ 并/ 不可/ 遏制/ ./ 在/ 本节/ ,/ 将/ 考虑/ 检测/ 延迟/ 等/ 参数/ ,/ 细化/ 模型/ ,/ 将/ 其/ 拓展/ 为/ 综合/ 评价/ 模型/ ./ 定义/ 7/ ./ 未/ 检测/ 状态/ UD/ ./ 表示/ ITRDB/ 未/ 发现/ 检测/ 事项/ ,/ 或者/ 将/ 已/ 检测/ 事项/ 的/ 标记/ 恢复/ 为/ 未/ 检测/ 标识/ ./ 定义/ 8/ ./ 虚警/ 状态/ FA/ ./ 表示/ ITRDB/ 系统/ 发出/ Page5/ 错误/ 警告/ ./ 误报率/ 和/ 检出率/ 被/ 广泛/ 地/ 用来/ 评价/ 在/ 任何/ 网络/ 入侵/ 检测/ 系统/ 的/ 性能/ ./ 检测/ 延迟时间/ 是/ 另/ 一个/ 用来/ 评价/ IDS/ 的/ 指标/ ,/ 该/ 时间/ 被/ 定义/ 为/ 从/ 当/ 攻击/ 侵入/ 数据库系统/ 开始/ 到/ 入侵/ 检测/ 系统/ 成功/ 识别/ 入侵/ 的/ 时间段/ ,/ 且/ 检测/ 的/ 平均/ 时间/ (/ MTTD/ )/ 即/ 为/ 状态/ I/ 下/ 的/ 平均/ 逗留/ 时间/ hI/ ./ 对于/ 不/ 完善/ 的/ 检测/ ,/ 通过/ IDS/ 可能/ 不会/ 成功/ 地/ 检测/ 到/ 入侵/ ./ 如果/ 检测/ 失败/ ,/ 系统/ 将/ 从/ 感染/ 状态/ 变成/ 未/ 检测/ 状态/ UD/ ./ 对于/ 实时/ 系统/ 来说/ ,/ 系统/ 要求/ 的/ 时限/ 会/ 减去/ 刚才/ 的/ 时间/ 损耗/ ,/ 直至/ 不/ 满足要求/ 为止/ ,/ 而且/ 该/ 事务/ 项/ 也/ 方便/ 在/ 下/ 一轮/ 检测/ 周期/ 中/ 被/ 重新/ 检测/ ./ 假定/ Pd/ 表示/ 一个/ IDS/ 识别/ 入侵/ 检测/ 的/ 概率/ ,/ 则/ 该/ 系统/ 由/ 感染/ 状态/ I/ 到/ 检疫/ 状态/ Q/ 的/ 转变/ 概率/ 为/ Pd/ ,/ 到/ 未/ 检测/ 状态/ UD/ 的/ 转变/ 概率/ 为/ 1/ -/ Pd/ ,/ 如图/ 3/ 所示/ ./ 未经/ 检测/ 的/ 攻击/ 最终/ 都/ 将/ 被/ 系统管理员/ 所/ 识别/ ,/ 并且/ 遭到/ 感染/ 的/ 数据项/ 也/ 会/ 被/ 恢复/ ./ 该/ 系统/ 将/ 从未/ 检测/ 状态/ UD/ 还原/ 到/ 良好/ 状态/ G/ ./ 此外/ ,/ 入侵/ 检测/ 系统/ 虚警/ 概率/ 为/ Pfa/ ./ 发生/ 虚警时/ ,/ 系统/ 会/ 从/ 良好/ 的/ 状态/ G/ 转换/ 到/ 错误/ 报警/ 状态/ FA/ ./ 下面/ 的/ 状态/ 转换/ 模型/ 充分考虑/ 了/ IDS/ 的/ 检测/ 延迟/ 等/ 参数/ 的/ 影响/ ,/ 如图/ 3/ 所示/ ./ 按照/ 状态/ 序列/ G/ 、/ I/ 、/ Q/ 、/ J/ 、/ R/ 、/ FA/ 与/ UD/ 排列/ 顺序/ ,/ 可/ 得/ 模型/ 中/ 的/ 状态/ 转换/ 概率/ 矩阵/ 犘/ 如下/ :/ 熿/ 犘/ =/ 1/ -/ Pj00Pj000/ 燀/ 从而/ 可/ 得/ 稳定/ 状态/ 空间/ 为/ 狏/ =/ VG/ ,/ VI/ ,/ VQ/ ,/ VR/ ,/ VFA/ ,/ VUD/ ,/ VJ/ ,/ 代入/ 方程/ (/ 1/ )/ ,/ 求解/ 可/ 得/ 烄/ VG/ =/ VI/ =/ VQ/ =/ VR/ =/ PdPj1/ -/ Pf/ (/ )/ a/ 烅/ VJ/ =/ VFA/ =/ VUD/ =/ (/ 1/ -/ Pd/ )/ (/ 1/ -/ Pfa/ )/ 烆/ 向量/ 狏/ 表示/ 包含/ 持续时间/ 马尔可夫/ 链/ 的/ 稳态/ 概率/ ,/ 设/ 向量/ 犺/ =/ (/ hG/ ,/ hI/ ,/ hQ/ ,/ hR/ ,/ hFA/ ,/ hUD/ ,/ hJ/ )/ ,/ 代表/ 每/ 一个/ 状态/ 的/ 逗留/ 时间/ ,/ 通过/ 解方程/ (/ 2/ )/ 可/ 得/ 稳态/ 概率/ π/ ./ 5/ 生存性/ 评价/ 指标/ 本文/ 中/ 生存能力/ 是/ 完整性/ 和/ 可用性/ 的/ 量化/ 术/ 生存性/ ,/ 也/ 称/ 生存能力/ ,/ 是/ 指/ 系统/ 的/ 重要/ 部分/ 在/ 受到/ 攻击/ 或/ 事故/ 的/ 损害/ 时/ 仍然/ 能/ 及时/ 提供/ 服务/ 的/ 能力/ ./ 一般/ 地/ 针对/ 传统/ 数据库/ ,/ 生存性/ 指标/ 主要/ 有/ 完整性/ 、/ 可用性/ 两个/ ,/ 而/ 误报/ 因素/ 、/ 检出率/ 因素/ 、/ 攻击/ 强度/ 等/ 因素/ 会/ 对/ 生存性/ 指标/ 造成/ 重大/ 影响/ ./ 本节/ 将/ 在/ 实时/ 数据库/ 半/ 马尔可夫/ 生存/ 评价/ 模型/ 的/ 基础/ 上/ ,/ 建立/ 量化/ 指标/ ,/ 从/ 多个/ 方面/ 来/ 对/ ITRDB/ 进行/ 评价/ ,/ 改进/ 其/ 生存能力/ ./ 下面/ 将/ 分析/ 与/ 重/ 定义/ 针对/ 实时/ 数据库/ 的/ 生存能力/ ./ 5.1/ 完整性/ 语/ ./ 根据/ 生存能力/ 的/ 要求/ ,/ 完整性/ 定义/ 如下/ ./ 定义/ 9/ ./ 完整性/ ./ 在/ 某个/ 时间/ 范围/ ,/ 所有/ 可/ 访问/ 数据项/ 都/ 是/ 干净/ 的/ 和/ 时间/ 有效/ 的/ ./ 较/ 高/ 的/ 完整性/ 意味着/ 入侵/ 容忍/ 系统/ 为/ 用户/ 提供/ 好/ 的/ 或/ 干净/ 的/ 数据服务/ 的/ 概率/ 较/ 高/ ./ 显然/ ,/ 在/ 状态/ G/ 下/ 所有/ 的/ 数据项/ 均/ 是/ 干净/ 的/ 并且/ 是/ 可/ 得到/ 的/ ./ 当/ 攻击/ 发生/ 时/ ,/ 一些/ 数据项/ 将/ 受到感染/ ./ 因此/ ,/ 在/ 状态/ I/ 下/ ,/ 部分/ 数据项/ 是/ “/ 脏/ 数据/ ”/ ./ 在/ 入侵/ 被/ 识别/ 后/ ,/ 该/ “/ 脏/ 数据/ ”/ 首先/ 被/ 隔离/ ,/ 直到/ 完成/ 修复过程/ 后/ 才/ 被/ 释放/ ./ 把/ 状态/ 空间/ E/ 分为/ 两个/ 集合/ :/ C0/ 和/ C1/ ,/ 其中/ C/ =/ C0/ ∪/ C1/ ,/ C0/ ∩/ C1/ ≠/ / ,/ 子集/ C0/ 包含/ 所有/ “/ 完整性/ ”/ 状态/ ,/ 在/ 这些/ 状态/ 下/ 所有/ 能/ 访问/ 的/ 数据项/ 都/ 是/ 干净/ 的/ ,/ 而/ Page6C1/ 中则/ 有些/ 是/ 不/ 干净/ 的/ ./ 因此/ ,/ 可得/ C0/ =/ {/ G/ ,/ Q/ ,/ J/ ,/ R/ }/ ,/ 该/ 模型/ 处于/ 完整性/ 状态/ 的/ 概率/ 为/ MTTA/ +/ MTTM/ +/ MTTR/ +/ MTTJ/ 假设/ MTTA/ 指/ 攻击/ 的/ 平均/ 时间/ ,/ 表示/ 该/ 系统/ 被/ 损坏/ 的/ 预期/ 时间/ ,/ 也/ 就是/ 系统/ 能/ 保持/ 正常/ 的/ 时间/ ;/ MTTD/ 指/ 检测/ 的/ 平均/ 时间/ ,/ 表示/ 入侵/ 被/ 检测/ 到/ 的/ 预期/ 时间/ ;/ MTTM/ 指标/ 记/ 的/ 平均/ 时间/ ,/ 表示/ 该/ 系统/ 标记/ “/ 脏/ ”/ 数据项/ 的/ 平均/ 时间/ ;/ MTTJ/ 指/ 判定/ 的/ 平均/ 时间/ ,/ 表示/ 系统/ 进行/ 修复/ 必要性/ 判定/ 的/ 预期/ 时间/ ./ MTTR/ 指/ 修复/ 的/ 平均/ 时间/ ,/ 表示/ 系统/ 修复/ 损坏/ 数据项/ 的/ 预期/ 时间/ ;/ 由/ 状态/ 转换/ 模型/ 的/ 定义/ ,/ 可/ 得到/ Integrity/ =/ MTTA/ +/ MTTD/ +/ MTTM/ +/ MTTR/ +/ MTTJ/ (/ 8/ )/ 5.2/ 可用性/ 对于/ 入侵/ 容忍/ 实时/ 数据库系统/ 而言/ ,/ 除了/ 得到/ 干净/ 的/ 数据服务/ 外/ ,/ 响应/ 的/ 结果/ 集/ 还/ 必须/ 满足/ 软硬/ 实时/ 的/ 要求/ ./ 可用性/ 定义/ 如下/ ./ 定义/ 10/ ./ 可用性/ ./ 所有/ 干净/ 数据项/ 都/ 能/ 被/ 访问/ ,/ 并且/ 满足/ 实时/ 要求/ ./ 把/ 状态/ 空间/ E/ 分为/ 两个/ 集合/ :/ A0/ 和/ A1/ ,/ 其中/ A/ =/ A0/ ∪/ A1/ ,/ A0/ ∩/ A1/ =/ / ./ 子集/ A0/ 包含/ 了/ 所有/ “/ 可用/ ”/ 状态/ ,/ 其中/ 干净/ 数据项/ 都/ 能/ 被/ 访问/ ./ 由于/ 在/ 检疫/ 状态/ Q/ 下/ ,/ 一些/ 干净/ 的/ 数据项/ 也/ 会/ 被/ 包含/ 进来/ ,/ 在/ 损害/ 评价/ 完成/ 后/ ,/ 干净/ 数据项/ 才/ 被/ 放行/ ,/ 而/ 损坏/ 数据项/ 在/ 修复/ 状态/ R/ 下/ 被/ 继续/ 隔离/ ./ 因此/ 可得/ I0/ =/ {/ G/ ,/ R/ }/ ./ 实时/ 数据库系统/ 中/ ,/ 由于/ 每个/ 事务/ 都/ 有/ 时限/ 要求/ Li/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 那么/ 假定/ 状态/ 空间/ E/ 中/ 每个/ 事务/ 在/ 模型/ 各/ 阶段/ 运行/ 的/ 时间/ 统计/ 为/ ∑/ Tpi/ (/ 假定/ 系统/ 在/ pi/ 阶段/ 的/ 处理/ 时间/ 为/ Tpi/ )/ ,/ 定义/ 时限/ 运行/ 参数/ α/ i/ =/ Li/ -/ ∑/ Tpi/ ./ 如果/ 时间/ 超过/ 时限/ 要求/ ,/ α/ i/ 的/ 值/ 肯定/ 为/ 0/ ,/ 表明/ 事务/ 项/ 失效/ ,/ 模型/ 将/ 进行/ 重新/ 评价/ ./ 根据/ 定义/ ,/ 可得/ 半/ 马尔可夫/ 综合/ 评价/ 模型/ 的/ 可用性/ 为/ Availability/ =/ π/ G/ +/ π/ R/ =/ MTTA/ +/ MTTD/ +/ MTTM/ +/ MTTR/ +/ MTTJ6/ 模型/ 验证/ 模型/ 验证/ 的/ 目标/ 是/ 确定/ 模型/ 能/ 提供/ 系统/ 的/ 准确/ 信息/ ./ 在/ 一组/ 实验/ 条件/ 下/ ,/ 如果/ 一个/ 模型/ 的/ 准确性/ 在/ 可/ 接受/ 范围/ 内/ ,/ 那么/ 模型/ 是/ 正确/ 的/ ,/ 这/ 通常/ 要/ 确定/ 感兴趣/ 的/ 模型/ 输出/ 变量/ ./ 如果/ 该/ 变量/ 是/ 随机变量/ ,/ 那么/ 常用/ 平均值/ 来/ 验证/ 模型/ 的/ 正确性/ ./ 在/ 我们/ 提出/ 的/ 半/ 马尔可夫/ 模型/ 中/ ,/ 感兴趣/ 的/ 是/ 某个/ 状态/ 下/ 的/ 稳态/ 概率/ ,/ 下面/ 将/ 比较/ 模型/ 的/ 稳态/ 概率/ 和/ ITRDB/ 面临/ 攻击/ 时/ 观察/ 到/ 的/ 度量/ 值/ ,/ 以/ 验证/ 所提/ 模型/ ./ 6.1/ 实验/ 平台/ 实验/ 系统/ 为/ Windows2003Sever/ 平台/ ,/ 开发/ 环境/ 为/ VisualStudio/ ./ net2005/ 集成/ 开发/ 环境/ ,/ 开发/ 语言/ 为/ C语言/ ,/ 并/ 在/ 内存/ DDR1G/ 、/ CPU/ 为/ AMD1700/ +/ 的/ 计算机/ 上/ 进行/ 了/ 实验/ ./ 本次/ 实验/ 中/ 使用/ 实时/ 数据库/ 管理系统/ ARTs/ -/ EDB/ [/ 19/ ]/ 作为/ 底层/ 的/ 数据库/ 管理系统/ ,/ 通过/ 事务/ 模拟器/ ,/ 用/ TPC/ -/ C/ 基准/ 模拟/ 批发商/ 的/ 货物/ 管理/ 流程/ ,/ 随机/ 产生/ 合法/ 事务/ 和/ 恶意/ 事务/ 对/ ITRDB/ 进行/ 仿真/ 测试/ ,/ 恶意/ 事务/ 模拟/ 异常/ 输入/ 和/ 注入/ 攻击/ ./ 实验/ 中/ 提交/ 了/ 368/ 个/ 合法/ 事务/ ,/ 153/ 个/ 恶意/ 事务/ ,/ 累计/ 执行/ 了/ 2632/ 个/ SQL/ 语句/ ,/ 其中/ 含有/ 条件/ SQL/ 语句/ (/ 如/ where/ )/ 短语/ 的/ 事务/ 共/ 236/ 个/ ./ 下面/ 列出/ 实验/ 中共/ 用/ 的/ 重要/ 参数/ ,/ 如表/ 1/ 所示/ ./ 参数/ db/ _/ size/ 数据/ 对象/ 数值/ 14660/ 块/ (/ 2.6/ M/ 行/ )/ Block/ _/ size/ 块/ 大小/ Max/ _/ size/ 最大/ 转换/ 量读/ 20/ 行/ ,/ 写/ 20/ 行/ Min/ _/ size/ 最小/ 转换/ 量/ Write/ _/ prob/ 读写/ 状态/ (/ 写/ X/ |/ 读/ X/ )/ 70/ %/ 在/ 选择/ 实验/ 参数/ 时/ ,/ 所/ 选择/ 的/ 数据库/ 和/ 事务/ 的/ 尺寸/ 是/ 要/ 让/ 操作/ 在/ 一定/ 范围/ 内/ 产生/ 感兴趣/ 的/ 结果/ ,/ 保证/ 实验/ 结果/ 能/ 被/ 观测/ 到/ 且/ 不/ 需要/ 花费/ 很长/ 的/ 仿真/ 时间/ ./ 6.2/ 参数/ 说明/ 在/ 上述/ 模型/ 中/ ,/ 实验者/ 可以/ 通过/ 控制/ 攻击行为/ 、/ 人为/ 干预/ 等/ 对/ 实验/ 加以控制/ ,/ 或者/ 自定义/ 一些/ 参数/ ,/ 例如/ 本/ 模型/ 中/ 的/ 检出率/ 、/ 虚警/ 概率/ 等/ ./ 可以/ 进行/ 多次/ 实验/ ,/ 通过/ 改变/ 参数/ 的/ 取值/ 来/ 研究/ 它们/ 在/ 系统/ 生存性/ 方面/ 受到/ 的/ 影响/ ./ 模型/ 中/ 通过/ PEM/ 使用/ 事务/ 代理/ ,/ 可以/ 控制/ 在/ 实验/ 中/ 所/ 使用/ 的/ 参数/ ,/ 例如/ 事务/ 的/ 大小/ 、/ 事务/ 的/ 数量/ 、/ 当前/ 用户/ 的/ 数量/ 等/ ./ 模型/ 中/ 的/ 一些/ 参数/ 是/ 有关/ ITRDB/ 自身/ 的/ 属性/ ,/ 这/ 通常/ 不由/ 实验者/ 来/ 决定/ ./ 实验/ 中/ 的/ 半/ 马尔可夫/ 综合/ 评价/ 模型/ 可/ 采用/ 最大/ 似然/ 估计/ 来/ 生成/ 这些/ 参数/ ./ 假定/ 观察/ k/ 个/ 事件/ 与/ 修复/ 事件/ ,/ 总时/ 耗为/ Mk/ ,/ 总/ 的/ 修复/ 时间/ 为/ Rk/ ,/ 判定/ 时间/ 为/ Jk/ ./ 并且/ 它们/ 的/ 最大/ 似然/ 估计/ 为/ hM/ ,/ hR/ ,/ hJ/ ,/ 那么/ Page7/ 相应/ 地/ ,/ 实际/ 观察/ 数据/ 的/ 概率/ 估计/ 取决于/ 系统/ 处于/ 该/ 状态/ 下/ 的/ 时间/ 长度/ 占/ 总/ 的/ 观察/ 时间/ 长度/ 的/ 比率/ ./ 6.3/ 实验/ 数据/ 统计/ 为了/ 简单/ 描述/ 实验/ ,/ 将/ 实验/ 中/ 所有/ 的/ 参数/ 的/ 集合/ 称为/ 方案/ ./ 首先/ 验证/ 综合/ 评价/ 模型/ 相对/ 简单/ 评价/ 模型/ 的/ 改进/ ,/ 都/ 取/ 方案/ 1/ 进行/ 实验/ 比较/ ,/ 通过/ MATLAB/ 计算/ 模型/ 中/ 的/ 公式/ ,/ 结果/ 如表/ 2/ 所示/ ./ 状态/ 模型/ 理论/ 实验/ 值/ // %/ 实际/ 观测/ 值/ // %/ 误差/ // %/ G83/ ./ 11I9/ ./ 63Q1/ ./ 48R4/ ./ 16J1/ ./ 62/ 同样/ 地/ ,/ 采用/ 方案/ 1/ 的/ 数据/ ,/ 应用/ 于/ 综合/ 评价/ 模型/ ,/ 通过/ MATLAB/ 计算/ ,/ 得到/ 结果/ 如表/ 3/ 所示/ ./ 状态/ 模型/ 理论/ 实验/ 值/ // %/ 实际/ 观测/ 值/ // %/ 误差/ // %/ G81/ ./ 26I9/ ./ 81Q1/ ./ 64R5/ ./ 13J0/ ./ 48FA0/ ./ 54UD1/ ./ 14/ 比较/ 表/ 2/ 与表/ 3/ 可知/ ,/ 在/ 实际/ 观测/ 值/ 相同/ 的/ 同一/ 运行/ 案例/ 下/ ,/ 综合/ 评价/ 模型/ 相比/ 简单/ 模型/ 更/ 精确/ ,/ 能/ 更好/ 地/ 反映/ ITRDB/ 系统/ 的/ 状态/ 变化/ ./ 当其/ 受到/ 恶意/ 事务/ 感染/ 及/ 传播/ 后/ ,/ 半/ 马尔可夫/ 综合/ 评价/ 模型/ 实时/ 响应/ IDS/ 的/ 动作/ ,/ 根据/ 需要/ 跳转/ 到/ 其它/ 粒度/ 更细/ 的/ 状态/ (/ 如/ FA/ 、/ UD/ 等/ )/ ./ 因为/ 它/ 允许/ 系统/ 存在/ 事务/ 时间/ 处理/ 间隔/ ,/ 并且/ 评价/ 的/ 时间/ 度量/ 的/ 粒度/ 更细/ ,/ 也/ 符合/ 实时/ 系统/ 的/ 必备/ 要求/ ./ 而/ 单纯/ 的/ 半/ 马尔可夫/ 链/ 概率模型/ 比较/ “/ 迟钝/ ”/ ,/ 认为/ 此时/ 系统/ 处于/ 良好/ 状态/ (/ G/ 状态/ )/ 居多/ ,/ 评价/ 粒度/ 较/ 粗/ ,/ 显然/ 不/ 符合实际/ 情况/ ./ 为了/ 验证/ 系统误差/ ,/ 在/ MATLAB/ 应用程序/ 中/ 改变/ 方案/ 1/ 中/ 的/ 参数/ ,/ 选用/ 方案/ 2/ 得到/ 结果/ 如表/ 4/ 所示/ ./ 状态/ 模型/ 理论/ 实验/ 值/ // %/ 实际/ 观测/ 值/ // %/ 误差/ // %/ G70/ ./ 75I12/ ./ 58Q4/ ./ 25R6/ ./ 53J0/ ./ 78FA1/ ./ 43UD3/ ./ 68/ 表/ 3/ 与表/ 4/ 的/ 实验/ 结果表明/ 由/ 模型/ 的/ 理论/ 输出/ 结果/ 与/ 实际/ 观测/ 得到/ 的/ 结果/ 匹配/ 得/ 非常/ 相近/ ,/ 误差/ 基本/ 不/ 超过/ 7/ %/ ,/ 除了/ R/ 状态/ 为/ 9.80/ %/ 以外/ ./ 这/ 也/ 证实/ 了/ 该/ 模型/ 的/ 正确性/ ,/ 表明/ 该/ 模型/ 在/ 入侵/ 容忍/ 实时/ 数据库系统/ 的/ 生存性/ 建模/ 方面/ 与/ 实际/ 情况/ 吻合/ 得/ 很/ 好/ ./ 表/ 5/ 总结/ 了/ 验证/ 实验/ 的/ 结果/ ./ I/ 状态/ 平均/ 逗留/ 时间/ hI5msQ/ 状态/ 平均/ 逗留/ 时间/ hQ3msR/ 状态/ 平均/ 逗留/ 时间/ hR1msJ/ 状态/ 平均/ 逗留/ 时间/ hJ2msUD/ 状态/ 平均/ 逗留/ 时间/ hUD40ms40msFA/ 状态/ 平均/ 逗留/ 时间/ hFA50ms50ms7/ 生存性/ 指标/ 的/ 评价/ 由于/ 入侵/ 检测/ 的/ 三个/ 重要/ 因素/ :/ 误报/ 、/ 检出率/ 和/ 攻击/ 强度/ 会/ 对/ 生存能力/ 造成/ 重大/ 影响/ ,/ 因此/ ,/ 基于/ 所/ 开发/ 的/ 入侵/ 容忍/ 实时/ 数据库/ ITRDB/ ,/ 进一步/ 研究/ 第/ 5/ 节/ 提出/ 的/ 生存性/ 度量/ ./ 在/ 实验/ 中将/ 继续/ 用/ MATLAB/ 进行/ 数据处理/ ,/ 并/ 通过/ TPC/ -/ C/ 基准/ 测试/ 对/ 其/ 进行/ 详细/ 的/ 数据分析/ ./ 7.1/ 误报/ 影响/ 误报/ 是/ 评价/ 入侵/ 检测/ 系统/ 性能/ 的/ 关键因素/ ./ 因为/ 攻击行为/ 的/ 全局/ 特征/ 可能/ 会/ 在/ 训练/ 学习/ 阶段/ 被/ 忽略/ 掉/ ,/ 所以/ 高/ 误报率/ 是/ 基于/ 行为/ 检测/ 技术/ 的/ 主要/ 障碍/ ./ 其次/ ,/ 高/ 误报率/ 可能/ 给/ 安全/ 子系统/ 带来/ 额外负担/ 和/ 资源/ 代价/ ./ 下面/ 研究/ ITRDB/ 对/ 较/ 高虚警/ 概率/ 的/ 容忍性/ ./ 图/ 4/ 显示/ 了/ ITRDB/ 在/ 轻度/ 攻击/ 下/ 稳态/ 概率/ 的/ 变化/ ./ 即使/ 在/ 面临/ 猜测/ 攻击/ (/ 虚警/ 概率/ 为/ 0.5/ 的/ 临界点/ )/ Page8/ 时/ ,/ ITRDB/ 仍/ 保持/ 完整性/ 大于/ 0.62/ ,/ 可用性/ 大于/ 0.60/ ,/ 这/ 表明/ 该/ 系统/ 在/ 轻度/ 攻击/ 下/ 具有/ 较/ 高/ 的/ 容忍性/ ./ 在/ 感染/ 状态/ I/ 、/ 检疫/ 状态/ Q/ 和/ 修复/ 状态/ R/ 下/ ,/ 该/ 系统/ 的/ 稳态/ 概率/ 低于/ 0.1/ ,/ 这/ 表明/ 该/ 系统/ 能够/ 高效快捷/ 地/ 检疫/ 、/ 查找/ 和/ 修复/ 攻击/ ./ 与/ 之/ 相比/ ,/ 图/ 5/ 则/ 显示/ 了/ ITRDB/ 在/ 高强度/ 攻击/ 下/ 的/ 反应/ ./ 由图/ 5/ 可知/ ,/ 高强度/ 的/ 攻击/ 和/ 额外/ 的/ 负荷/ 导致/ 了/ 误报/ ,/ 也/ 增加/ 了/ 误报/ 状态/ 、/ 感染/ 状态/ 、/ 检疫/ 状态/ 和/ 修复/ 状态/ 的/ 稳态/ 概率/ ./ ITRDB/ 将/ 花/ 更/ 多/ 的/ 时间/ 来/ 处理/ 误报/ 状态/ 以及/ 忙于/ 分析/ 状态/ 变化/ 和/ 修复/ 损害/ ,/ 系统/ 的/ 可用性/ 由于/ 损害/ 检疫/ 时间/ 的/ 增长/ 而/ 减少/ ,/ 评价/ 过程/ 也/ 变得/ 更长/ ,/ 但/ 其/ 完整性/ 仍/ 保持/ 在/ 大于/ 0.51/ 的/ 较/ 高水平/ 上/ ./ 这/ 表明/ 系统/ 仍/ 具有/ 提供/ 干净/ 数据/ 给/ 用户/ 的/ 较/ 高/ 可能性/ ./ 7.2/ 检出率/ 的/ 影响/ 研究/ 不同/ 检出/ 概率/ 对系统/ 生存/ 性能/ 的/ 影响/ ./ 检出率/ 是/ 评价/ 生成/ 性/ 的/ 另/ 一个/ 重要/ 指标/ ,/ 下面/ ITRDB/ 处于/ 轻度/ 攻击/ 下/ 的/ 检出率/ 影响/ 如图/ 6/ 所示/ ./ 当/ 检出率/ 为/ 0/ 时/ ,/ 入侵/ 检测/ 则/ 完全/ 取决于/ 人工/ 检测/ ,/ 耗时/ 较长/ ,/ ITRDB/ 保持/ 在/ 未/ 检测/ 状态/ UD/ 与/ 良好/ 状态/ G/ 下/ 的/ 概率/ 均/ 较/ 低/ ,/ 完整性/ 和/ 可用性/ 处于/ 较/ 低水平/ ./ 反之/ ,/ 当/ 检出率/ 为/ 100/ %/ 时/ ,/ 未/ 检测/ 状态/ UD/ 的/ 稳态/ 概率/ 回到/ 0/ ,/ 检疫/ 状态/ Q/ 和/ 修复/ 状态/ R/ 的/ 稳态/ 概率/ 随着/ 检出率/ 的/ 增长/ 而/ 增长/ ./ 这/ 表明/ 随着/ ITRDB/ 受到/ 更/ 多/ 的/ 攻击/ ,/ 系统/ 将/ 花/ 更/ 多/ 时间/ 进行/ 损伤/ 评价/ 和/ 修复/ ,/ 而且/ 由于/ 人工/ 修复/ 比/ ITRDB/ 的/ 修复/ 子系统/ 的/ 自动/ 修复/ 缓慢/ 得/ 多/ ,/ 那么/ 完整性/ 和/ 可用性/ 将会/ 随着/ 检出率/ 的/ 增长/ 而/ 提高/ ./ 当/ ITRDB/ 面临/ 强/ 攻击/ 时/ ,/ 如图/ 7/ 所示/ ,/ 低/ 检出率/ 明显/ 影响/ 了/ ITRDB/ 的/ 性能/ ./ 当/ 检出率/ 为/ 0/ 时/ ,/ 良好/ 状态/ G/ 的/ 稳态/ 概率/ 低于/ 0.2/ ./ 因此/ ,/ 当/ ITRDB/ 无法/ 识别/ 入侵/ 时/ ,/ 可用性/ 和/ 完整性/ 也/ 比较/ 低/ ,/ 仅能/ 维持/ 系统/ 运行/ ./ 随着/ 检出率/ 增长/ ,/ G/ 状态/ 下/ 的/ 完整性/ 和/ 可用性/ 都/ 平稳/ 提升/ ./ 这/ 表明/ ITRDB/ 遭到/ 高强度/ 攻击/ 时/ 仍/ 可容忍/ 较/ 低/ 的/ 检出率/ ./ 实验/ 结论/ 表明/ ,/ 要/ 提高/ 入侵/ 容忍/ 实时/ 数据库/ 系/ 检出率/ 相比/ 虚警/ 的/ 影响/ ,/ 对/ ITRDB/ 生存能力/ 的/ 影响/ 则/ 更加/ 严重/ ./ 因为/ 检出率/ 若/ 从/ 0/ 提高/ 到/ 100/ %/ ,/ 可用性/ 和/ 完整性/ 的/ 方差/ 则/ 接近/ 0.5/ ,/ 而/ 当虚警/ 概率/ 从/ 0/ 变化/ 到/ 50/ %/ 时/ ,/ 方差/ 却/ 低于/ 0.2/ ./ 其中/ 的/ 主要/ 原因/ 是/ 由于/ 低/ 检出率/ 会/ 给/ 管理员/ 带来/ 更/ 多/ 的/ 工作/ ,/ 如/ 手工/ 标记/ 和/ 人工/ 修理/ 损坏/ 等/ ./ 如果/ 系统/ 能/ 识别/ 和/ 恢复/ 未/ 检测/ 的/ 入侵/ 的/ 速度/ 比/ 手工操作/ 快/ ,/ 那么/ 低/ 检出率/ 的/ 影响/ 将会/ 很小/ ./ 统的/ 性能/ ,/ 主要/ 考虑/ 提高/ ITRDB/ 的/ 检出率/ ./ 7.3/ 攻击/ 强度/ 的/ 影响/ 定义/ 11/ ./ 优质/ 系统/ :/ 优质/ 入侵/ 检测/ 系统/ 的/ 简称/ ,/ 表示/ 一个/ 具有/ 很/ 高/ 的/ 检出率/ 、/ 低/ 误报率/ 、/ 短/ 检测/ 延迟/ 、/ 快速/ 评价/ 损坏/ 及/ 修复/ 的/ 入侵/ 容忍/ 系统/ ./ 定义/ 12/ ./ 劣质/ 系统/ :/ 劣质/ 入侵/ 检测/ 系统/ 的/ 简称/ ,/ 表示/ 一个/ 具有/ 较/ 低/ 的/ 检出率/ 、/ 高/ 误报率/ 、/ 长/ 检测/ 延迟/ 、/ 缓慢/ 的/ 损坏/ 评价/ 及/ 修复/ 的/ 入侵/ 容忍/ 系统/ ./ 攻击/ 强度/ 对/ 入侵/ 容忍/ 系统/ 的/ 生存能力/ 的/ 影响/ 也/ 不容忽视/ ./ 高强度/ 攻击/ 使得/ 安全/ 系统/ 忙于/ 防御/ 和/ 修/ Page9/ 复/ ,/ 由此/ 系统/ 有/ 可能/ 会/ 在/ 安全/ 系统/ 修复/ 损坏/ 之前/ 就/ 崩溃/ 掉/ ./ 下面/ 用/ 良好/ 状态/ G/ 状态/ 的/ 逗留/ 时间/ 的/ 长短/ 来/ 量化/ 攻击/ 强度/ ,/ 攻击/ 越重/ ,/ 处于/ G/ 状态/ 的/ 时间/ 显然/ 越短/ ./ 图/ 8/ 比较/ 了/ 在/ 不同/ G/ 状态/ 平均/ 逗留/ 时间/ 下/ 不同/ 系统结构/ 的/ ITRDB/ 的/ 稳态/ 概率/ ./ 图/ 8/ 中/ 显示/ 了/ 优质/ 系统/ 的/ ROC/ 曲线/ ./ 可以/ 看出/ 状态/ 转换/ 概率/ 比较/ 大/ ,/ 虚警/ 概率/ 相对/ 小/ ,/ 这/ 表示/ 感染/ 状态/ 、/ 检疫/ 状态/ 、/ 修复/ 状态/ 的/ 平均/ 逗留/ 时间/ 相对/ 较/ 短/ ./ 重度/ 攻击/ 会/ 对/ ITRDB/ 的/ 生存能力/ 能/ 造成/ 明显/ 影响/ ./ 如当/ 受到/ 高强度/ 攻击/ 时/ ,/ G/ 状态/ 取值/ 为/ 5/ 时/ ,/ 完整性/ 只到/ 0.4/ ,/ 可用性/ 只到/ 0.3/ ,/ 处于/ 非常低/ 的/ 水平/ ./ 随着/ 攻击/ 强度/ 的/ 减轻/ ,/ G/ 状态/ 取值/ 为/ 50/ ,/ 完整性/ 和/ 可用性/ 也/ 恢复/ 到/ 较/ 高水平/ ./ 图/ 9/ 中/ 显示/ 了/ 劣质/ 系统/ 的/ ROC/ 曲线/ ./ 相对/ 于/ 优质/ 系统/ ,/ 劣质/ 系统/ 的/ 状态/ 转换/ 概率/ 比较/ 小/ ,/ 虚警/ 概率/ 比较/ 大/ ,/ 这/ 表示/ 感染/ 状态/ 、/ 检疫/ 状态/ 、/ 修复/ 状态/ 的/ 平均/ 逗留/ 时间/ 较长/ ./ 重度/ 攻击/ 增加/ 了/ 标记/ 和/ 修复/ 坏损/ 子系统/ 的/ 工作量/ ./ 因此/ ,/ 检疫/ 状态/ 和/ 修复/ 状态/ 的/ 稳态/ 概率/ 上升/ ,/ 这使/ ITRDB/ 忙于/ 分析/ 和/ 屏蔽/ 严重/ 攻击/ ,/ 但/ 对系统/ 完整性/ 造成/ 的/ 影响/ 并/ 不/ 显著/ ./ 因为/ ITRDB/ 采用/ 了/ 损害/ 检疫/ 策略/ ,/ 所以/ 当其/ 面临/ 重度/ 攻击/ 时/ 仍/ 能/ 给/ 用户/ 提供/ 干净/ 的/ 数据/ 信息/ ./ 8/ 结论/ 本文/ 考虑/ 实时/ 数据库系统/ 中/ 事务/ 的/ 时间/ 戳/ 、/ 事务/ T/ -/ SQL/ 序列/ 长短/ 、/ 事务/ 与/ 事务/ 执行/ 时间/ 间隔/ 分布/ 不均/ 等/ 因素/ ,/ 通过/ ITRDB/ 在/ 面临/ 攻击/ 时/ 的/ 状态/ 转换/ ,/ 对/ 状态/ 空间/ 定义/ 与/ 状态/ 之间/ 的/ 复杂/ 转换/ 关系/ 这/ 两个/ 方面/ 进行/ 建模/ ,/ 建立/ 了/ 半/ 马尔可夫/ 生存/ 评价/ 模型/ ,/ 求解/ 并/ 进行/ 误差/ 分析/ ./ 再进一步/ 考虑/ IDS/ 本身/ 性能/ 的/ 影响/ ,/ 逐步/ 细化/ 模型/ ,/ 给出/ 了/ 生存性/ 指标/ 中/ 完整性/ 与/ 可用性/ 的/ 定义/ ./ 最后/ ,/ 进行/ 仿真/ 比较/ ./ 实验/ 结果表明/ ,/ 改进/ 后/ 的/ ITRDB/ 体系结构/ 适应/ 了/ 实际/ 应用/ 的/ 需求/ ,/ 评价/ 指标/ 中/ 的/ 完整性/ 与/ 可用性/ 也/ 满足/ 了/ 实时/ 数据库/ 的/ 生存/ 需求/ ,/ 所/ 提出/ 的/ 半/ 马尔可夫/ 模型/ 是/ 有效/ 的/ ./ 评价/ 结果表明/ ,/ 遵循/ 半/ 马尔可夫/ 综合/ 模型/ 的/ ITRDB/ 可以/ 做到/ 以下/ 两点/ :/ 一是/ 在/ 面临/ 攻击/ 时能/ 在/ 时限/ 范围/ 内/ 提供/ 必要/ 的/ 数据库/ 服务/ ,/ 二是/ 在/ 各种/ 不同/ 系统/ 的/ 缺陷/ 和/ 攻击/ 强度/ 下/ ,/ 系统/ 所/ 需/ 基本/ 生存/ 特性/ 也/ 没有/ 受到/ 严重/ 的/ 影响/ ./ 

