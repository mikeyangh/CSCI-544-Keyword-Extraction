Page1/ 面向/ 可信/ 移动/ 平台/ 具有/ 用户/ 可控/ 关联性/ 的/ 匿名/ 证明/ 方案/ 岳笑/ 含/ 1/ )/ 周福才/ 2/ )/ 林慕清/ 1/ )/ 李福祥/ 1/ )/ 1/ )/ (/ 东北大学/ 信息科学/ 与/ 工程学院/ 沈阳/ 110004/ )/ 2/ )/ (/ 东北大学/ 软件/ 学院/ 沈阳/ 110004/ )/ 摘要/ 针对/ 可信/ 移动/ 平台/ (/ TrustedMobilePlatform/ ,/ TMP/ )/ 远程/ 认证/ 方式/ 中/ 直接/ 匿名/ 证明/ 方案/ 存在/ 的/ 性能/ 瓶颈/ 、/ R/ 攻击/ 以及/ 跨/ 信任/ 域/ 问题/ ,/ 提出/ 了/ 一种/ 新型/ 的/ 具有/ 用户/ 可控/ 关联性/ 的/ 匿名/ 证明/ (/ AnonymousAttestationwithUser/ -/ controlled/ -/ linkability/ ,/ TMP/ -/ UAA/ )/ 方案/ ./ 通过/ 引入/ 可信/ 第三方/ CA/ 构建/ 了/ 方案/ 的/ 模型/ ,/ 该/ 模型/ 可以/ 有效/ 解决/ 传统/ 直接/ 匿名/ 证明/ 设计/ 中/ 存在/ 的/ R/ 攻击/ 和/ 跨/ 信任/ 域/ 问题/ ,/ 且/ 易于/ 部署/ 实现/ ./ 根据/ 提出/ 的/ 方案/ 模型/ ,/ 首先/ 利用/ Paillier/ 加密/ 系统/ 及/ 可验证/ 加密技术/ 设计/ 了/ 一个/ 安全/ 两方/ 计算/ 协议/ ,/ 该/ 协议/ 用于/ 实现/ TPM/ -/ UAA/ 方案/ 中/ 的/ Join/ 协议/ ;/ 其次/ 运用/ 该/ 协议/ 并/ 结合/ 提出/ 的/ l/ -/ MSDH/ 假设/ 和/ XDH/ 假设/ 给出/ 了/ 方案/ 的/ 具体/ 设计/ ;/ 然后/ 在/ 随机/ 预言/ 模型/ 下/ 对/ 方案/ 的/ 安全性/ 进行/ 了/ 证明/ ,/ 证明/ 表明/ 该/ 方案/ 满足用户/ 可控/ 匿名性/ 以及/ 用户/ 可控/ 可追踪/ 性/ ;/ 此外/ 在/ 性能/ 方面/ 与/ 现有/ 直接/ 匿名/ 证明/ 方案/ 相比/ ,/ 该/ 方案/ 具有/ 更/ 短/ 的/ 签名/ 长度/ 以及/ 更/ 高/ 的/ 计算/ 效率/ ;/ 最后/ 阐述/ 了/ TPM/ -/ UAA/ 方案/ 在/ 可信/ 移动/ 环境/ 下/ 的/ 跨域/ 证明/ ,/ 该/ 证明/ 避免/ 了/ 传统/ 直接/ 匿名/ 证明/ 存在/ 的/ 跨/ 信任/ 域/ 及/ R/ 攻击/ 问题/ ./ 关键词/ 匿名/ 证明/ ;/ 可信/ 移动/ 平台/ ;/ 移动/ 可信/ 模块/ ;/ 跨/ 信任/ 域/ ;/ R/ 攻击/ ;/ 用户/ 可控/ 关联性/ ;/ 移动/ 互联网/ 1/ 引言/ 随着/ 计算能力/ 及/ 普适/ 网络/ 结点/ 的/ 不断/ 增长/ ,/ 移动/ 设备/ (/ 例如/ 智能手机/ 、/ 平板/ 电脑/ 、/ PDA/ 、/ 笔记本电脑/ 等/ )/ 的/ 计算环境/ 变得/ 更加/ 开放/ 和/ 通用/ ,/ 这/ 促使/ 越来越/ 多/ 的/ 服务/ 及/ 应用/ 被/ 开发/ 并/ 部署/ 到/ 这些/ 移动/ 设备/ 中/ ,/ 同时/ 也/ 导致/ 了/ 移动/ 设备/ 的/ 安全性/ 受到/ 来自/ 各个方面/ 的/ 威胁/ ./ 面对/ 移动/ 设备/ 的/ 异构/ 性/ 、/ 应用环境/ 的/ 复杂性/ 以及/ 利益/ 相关者/ (/ stakeholder/ )/ 的/ 多样性/ ,/ 在/ PC机/ 上/ 传统/ 的/ 安全/ 保障/ 措施/ 变得/ 难以/ 适用/ ,/ 也/ 无法/ 从/ 根源/ 上/ 解决/ 安全/ 问题/ ./ 为此/ 可信计算/ 组织/ [/ 1/ -/ 2/ ]/ (/ TrustedComputingGroup/ ,/ TCG/ )/ 针对/ 移动/ 平台/ 的/ 特性/ ,/ 成立/ 了/ 移动电话/ 工作/ 小组/ (/ MobilePhoneWorkGroup/ ,/ MPWG/ )/ 并于/ 2007/ 年/ 发布/ 了/ 移动/ 可信/ 模块/ (/ MobileTrustedModel/ ,/ MTM/ )/ 标准/ ①/ ,/ 旨在/ 移动/ 设备/ 上/ 建立/ 可信/ 执行/ 环境/ 来/ 确保/ 移动/ 平台/ 的/ 安全性/ ./ 同时/ MPWG/ 针对/ 移动/ 设备/ 发布/ 了/ 更加/ 通用/ 的/ 安全/ 体系结构/ 标准/ ,/ 称为/ TCG/ 移动/ 参考/ 体系结构/ ②/ (/ TCGMobileReferenceArchitecture/ ,/ MRA/ )/ ,/ 标准/ 定义/ 了/ 可信/ 移动/ 平台/ (/ TrustedMobilePlatform/ ,/ TMP/ )/ 体系结构/ ,/ 该/ 体系结构/ 由/ 一系列/ 抽象/ 的/ 抗干扰/ 可信/ 引擎/ (/ TrustedEngine/ ,/ TE/ )/ 及/ MTM/ 模块/ 组成/ ,/ 并用/ 不同/ 的/ TE/ 代表/ 不同/ 的/ 利益/ 相关者/ ,/ 这种/ 灵活性/ 与/ 模块化/ 并重/ 的/ 设计/ 思想/ 为/ 移动/ 设备/ 安全/ 体系/ 架构/ 的/ 实现/ 提供/ 了/ 重要/ 的/ 借鉴/ 意义/ ./ 由于/ MTM/ 的/ 标准/ 是/ 对/ TPM/ 标准/ [/ 3/ ]/ 的/ 继承/ 和/ 扩展/ ,/ 因此/ 提供/ 了/ 可信计算/ 技术/ 的/ 多种/ 核心/ 功能/ ,/ 其中/ 就/ 包括/ 了/ 最/ 重要/ 的/ 远程/ 认证/ 功能/ ,/ 这种/ 远程/ 认证/ 实则/ 上/ 是/ 为/ 确保/ 平台/ 隐私/ 性/ 而/ 对/ MTM/ 模块/ 的/ 远程/ 匿名/ 认证/ ,/ 即/ 向/ 验证/ 者/ 证明/ 该/ 可信/ 移动/ 平台/ 上/ 存在/ MTM/ 的/ 真实性/ ./ 出于/ 隐私/ 保护/ ,/ MTM/ 标准/ 提供/ 了/ 两种/ 可选/ 的/ 匿名/ 证明/ 方案/ :/ 基于/ 隐私/ CA/ 匿名/ 证明/ 及/ 直接/ 匿名/ 证明/ (/ DAA/ )/ ./ 起初/ 基于/ 隐私/ CA/ 的/ 匿名/ 证明/ 方案/ 存在/ 没有/ 可/ 参考/ 的/ 商业/ 模型/ 以及/ 效率/ 瓶颈/ 等/ 问题/ ./ 2004/ 年/ ,/ Brickell/ 、/ Camenisch/ 和/ Chen/ [/ 4/ ]/ 提出/ 了/ 一种/ 新型/ 的/ 匿名/ 证明/ 方案/ ,/ 即/ 直接/ 匿名/ 证明/ (/ DirectAnonymousAttestation/ ,/ DAA/ )/ 方案/ ,/ 该/ 方案/ 被/ TCG/ 纳入/ 到/ MTM/ 标准/ 中/ ./ 从/ 密码学/ 角度/ 来讲/ ,/ DAA/ 是/ 一种/ 特殊/ 的/ 群/ 签名/ 原型/ ,/ 能够/ 在/ 保障/ 用户/ 隐私/ 的/ 前提/ 下/ 提供/ 远程/ 证明/ 功能/ ./ DAA/ 方案/ [/ 4/ ]/ 的/ 参与者/ 有/ 3/ 类/ :/ 发布者/ 、/ 签名者/ 及/ 验证/ 者/ ./ 签名者/ 由/ TPM/ // MTM/ 及/ 平台/ 主机/ // 可信/ 引擎/ 构成/ ,/ 其中/ 真正/ 的/ 签名者/ 是/ TPM/ // MTM/ ./ 由于/ 自身/ 资源/ 较/ 小/ ,/ 需要/ 主机/ // 可信/ 引擎/ 辅助/ 执行/ DAA/ 方案/ ./ DAA/ 方案/ 主要/ 由/ 加入/ 协议/ 和/ 签名/ 协议/ 组成/ ,/ 加入/ 协议/ 用于/ 向/ 发布者/ 申请/ DAA/ 证书/ ,/ 签名/ 协议/ 用于/ 产生/ DAA/ 签名/ ./ 在/ 安全性/ 方面/ 与/ 群/ 签名/ 的/ 完全/ 匿名性/ (/ FullAnonymity/ )/ 、/ 完全/ 追踪/ 性/ (/ FullTracea/ -/ bility/ )/ 等/ 安全性/ 需求/ 不同/ ,/ DAA/ 提供/ 了/ 用户/ 可控/ 的/ 匿名性/ (/ User/ -/ controlledAnonymity/ )/ 及/ 用户/ 可控/ 追踪/ 性/ (/ User/ -/ controlledTraceability/ )/ ./ 造成/ 这种/ 不同/ 的/ 主要/ 原因/ 是/ :/ DAA/ 是/ 一种/ 可/ 协商/ 匿名性/ 方案/ ,/ 即/ 用户/ 与/ 验证/ 者/ 通过/ 对/ 基名/ (/ basename/ )/ 的/ 协商/ 来/ 控制/ 该/ 用户/ 生成/ 的/ DAA/ 签名/ 是否/ 可以/ 相关联/ (/ Link/ -/ ability/ )/ ,/ 方案/ 取消/ 了/ 群/ 签名/ 中/ 的/ Open/ 算法/ ,/ 取而代之/ 的/ 是/ Link/ 算法/ ./ 然而/ 针对/ 资源/ 有限/ 的/ 可信/ 移动/ 平台/ ,/ 原有/ DAA/ 方案/ [/ 4/ ]/ 高昂/ 的/ 计算/ 代价/ 会/ 带来/ 方案/ 性能/ 上/ 的/ 瓶颈/ 并/ 降低/ 移动/ 设备/ 的/ 实用性/ ./ 另外/ 在/ 实际/ 部署/ 中/ 还/ 存在/ R/ 攻击/ [/ 5/ ]/ 以及/ 跨/ 信任/ 域/ 问题/ [/ 6/ ]/ ,/ 这些/ 问题/ 会/ 导致/ 可信计算/ 技术/ 无法/ 应用/ 于/ 移动/ 终端/ ./ 因此/ 有/ 必要/ 设计/ 面向/ 可信/ 移动/ 平台/ 的/ 新型/ 匿名/ 证明/ 方案/ 来/ 解决/ DAA/ 方案/ 中/ 存在/ 的/ 问题/ ./ 2/ 相关/ 工作/ 围绕/ 提高/ DAA/ 性能/ 的/ 问题/ ,/ 众多/ 学者/ 和/ 机构/ 分别/ 提出/ 了/ 不同/ 的/ 解决方案/ ./ 目前/ ,/ 提出/ 的/ DAA/ 方案/ 可以/ 分为/ 两类/ :/ 一种/ 是/ 基于/ RSA/ 假设/ 的/ DAA/ 方案/ [/ 4/ ,/ 7/ -/ 8/ ]/ ;/ 另/ 一种/ 为/ 基于/ 椭圆/ 曲线/ 密码学/ 的/ DAA/ 方/ ①/ ②/ Page3/ 案/ ./ 同等/ 安全级别/ 下/ ,/ 基于/ 椭圆/ 曲线/ 的/ DAA/ 方案/ 在/ 计算/ 效率/ 及/ 通信/ 性能/ 上要/ 比/ 基于/ RSA/ 假设/ 的/ DAA/ 方案/ 高/ ./ 在/ 文献/ 中/ 可以/ 找到/ 的/ 基于/ 椭圆/ 曲线/ 的/ DAA/ 方案/ 共有/ 8/ 个/ ./ 按/ 所/ 基于/ 的/ 安全性/ 假设/ ,/ 以上/ 8/ 个/ 方案/ 可/ 分为/ 两类/ :/ 基于/ LRSW/ 和/ DDH/ 或/ DBDH/ 假设/ 的/ 方案/ [/ 9/ -/ 14/ ]/ 以及/ 基于/ l/ -/ SDH/ 和/ DDH/ 假设/ 的/ 方案/ [/ 15/ -/ 16/ ]/ ,/ 其中/ 性能/ 最好/ 的/ DAA/ 方案/ 是/ 由/ Chen/ 等/ 人/ [/ 12/ ]/ 提出/ 的/ ./ 但/ 由于/ 移动/ 设备/ 资源/ 有限/ ,/ 有/ 必要/ 探索/ 新/ 的/ 方法/ 来/ 构建/ 一种/ 性能/ 更好/ 、/ 适用/ 于/ 可信/ 移动/ 平台/ 的/ 匿名/ 证明/ 方案/ ./ 上述/ 的/ 直接/ 匿名/ 证明/ 方案/ 仅/ 是/ 对/ 性能/ 问题/ 的/ 研究/ ,/ 然而/ 在/ 部署/ 实现/ 过程/ 中/ 会/ 遇到/ 各种/ 问题/ ./ 由于/ DAA/ 方案/ 的/ 匿名/ 证明/ 具有/ “/ 直接/ 性/ ”/ ,/ 即/ 无需/ 可信/ 第三方/ 参与/ 的/ 直接证明/ ,/ 这种/ 直接/ 性会/ 造成/ 以下/ 两个/ 问题/ :/ 一是/ 由/ Rudolph/ 提出/ 的/ 隐私/ 性/ 攻击/ ,/ 简称/ R/ 攻击/ [/ 5/ -/ 6/ ]/ ,/ 该/ 攻击/ 的/ 思想/ 是/ 在/ 成员/ 加入/ 阶段/ 恶意/ 发布者/ 可以/ 生成/ 不同/ 的/ 发布者/ 公钥/ ,/ 与/ 不同/ 的/ MTM/ 身份/ 标识/ (/ EK/ 证书/ )/ 一一/ 绑定/ ,/ 在/ DAA/ 签名/ 验证/ 阶段/ ,/ 验证/ 者/ 与/ 发布者/ 合谋/ 就/ 可以/ 通过/ 与/ MTM/ 绑定/ 的/ 公钥来/ 唯一/ 锁定/ 可信/ 平台/ 身份/ ,/ 导致/ 平台/ 用户/ 的/ 隐私/ 遭到/ 破坏/ ,/ 造成/ 这种/ 攻击/ 的/ 主要/ 原因/ 是/ 发布者/ 公钥/ 的/ 合法性/ 得不到/ 验证/ ;/ 二是/ 跨/ 信任/ 域/ 问题/ ,/ 由于/ DAA/ 属于/ 特殊/ 的/ 群/ 签名/ 方案/ ,/ 所以/ 不同/ 的/ 发布者/ 、/ 签名者/ 及/ 验证/ 者/ 形成/ 的/ 群域/ 之间/ 就/ 存在/ 信任/ 的/ 问题/ [/ 17/ ]/ ,/ 导致/ 域/ 中/ 的/ 验证/ 者/ 无法/ 验证/ 其它/ 域/ 中/ 签名者/ 生成/ 的/ DAA/ 签名/ ,/ 这/ 是因为/ 其它/ 域/ 中/ 发布者/ 的/ 公钥/ 合法性/ 得不到/ 验证/ ./ 在/ 移动/ 环境/ 中/ 这个/ 问题/ 尤为/ 突出/ ,/ 由于/ 移动/ 设备/ 很/ 容易/ 从/ 一个/ 区域/ 到/ 另/ 一个/ 区域/ 甚至/ 从/ 一个/ 国家/ 到/ 另/ 一个/ 国家/ ,/ 这样/ 会/ 导致/ 移动/ 设备/ 的/ 可用性/ 受到限制/ ./ 文献/ [/ 6/ ,/ 17/ ]/ 分别/ 给出/ 了/ 这/ 两个/ 问题/ 的/ 解决/ 方法/ ,/ 但/ 这/ 两种/ 解决/ 方法/ 一方面/ 非常复杂/ 并且/ 需要/ 加入/ 多个/ 可信/ 实体/ ,/ 难以/ 部署/ 实现/ ,/ 另一方面/ 对于/ 移动/ 终端/ 这种/ 资源/ 有限/ 的/ 设备/ ,/ 性能/ 也/ 大为/ 降低/ ./ 因此/ 如何/ 设计/ 一种/ 具有/ 可/ 部署/ 性且/ 可/ 避免/ 以上/ 两个/ 问题/ 的/ 匿名/ 证明/ 方案/ 是/ 一个/ 挑战性/ 问题/ ./ 针对/ 上述/ 挑战/ ,/ 本文/ 面向/ 可信/ 移动/ 平台/ 综合/ 考虑/ 了/ 实用性/ 及/ 安全性/ ,/ 提出/ 了/ 面向/ 可信/ 移动/ 平台/ 具有/ 用户/ 可控/ 关联性/ 的/ 匿名/ 证明/ 方案/ (/ AnonymousAttestationwithUser/ -/ controlled/ -/ linkability/ ,/ 简称/ TMP/ -/ UAA/ )/ ./ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 针对/ R/ 攻击/ 和/ 跨/ 信任/ 域/ 的/ 问题/ ,/ 借鉴/ 公钥/ 基础设施/ PKI/ 的/ 构架/ 思想/ 设计/ 了/ 一种/ 合理/ 且/ 具可/ 部署/ 性/ 的/ TMP/ -/ UAA/ 模型/ ,/ 该/ 模型/ 可以/ 有效/ 解决/ R/ 攻击/ 和/ 跨/ 信任/ 域/ 问题/ ;/ 设/ ,/ 并/ 对/ 其/ 进行/ 了/ 归约/ 性/ 证明/ ;/ (/ 2/ )/ 提出/ 了/ 一个/ 新/ 的/ 密码学/ 假设/ ,/ l/ -/ MSDH/ 假/ (/ 3/ )/ 由于/ 加入/ 协议/ 运行/ 次数/ 远/ 小于/ 签名/ 协议/ 运行/ 次数/ ,/ 因此/ 构建/ 了/ 一个/ 在/ 加入/ 阶段/ 使用/ 的/ 安全/ 两方/ 计算/ 协议/ ,/ 利用/ 该/ 协议/ 生成/ 的/ UAA/ 证书/ 可以/ 最小化/ 签名/ 协议/ 的/ 计算/ 代价/ 及/ 签名/ 长度/ ;/ (/ 4/ )/ 基于/ TMP/ -/ UAA/ 模型/ ,/ 给出/ 了/ 方案/ 具体步骤/ ,/ 并/ 在/ 随机/ 预言/ 模型/ 下/ 对/ 该/ 方案/ 的/ 安全性/ 进行/ 了/ 证明/ ./ 在/ 128bit/ 安全级别/ 下/ ,/ 对/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 性能/ 进行/ 了/ 详细/ 的/ 分析/ 比较/ ./ 本文/ 第/ 3/ 节/ 介绍/ TMP/ -/ UAA/ 方案设计/ 所/ 需要/ 的/ 密码学/ 假设/ 及/ 工具/ ;/ 第/ 4/ 节/ 设计/ TMP/ -/ UAA/ 模型/ 及其/ 安全/ 模型/ ;/ 第/ 5/ 节/ 构建/ TMP/ -/ UAA/ 方案/ 中/ 加入/ (/ Join/ )/ 阶段/ 所/ 需/ 的/ 两方/ 计算/ 协议/ ;/ 第/ 6/ 节对/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 进行/ 具体/ 的/ 构建/ ;/ 第/ 7/ 节对/ TMP/ -/ UAA/ 方案/ 的/ 安全性/ 及/ 性能/ 进行/ 详细/ 证明/ 及/ 分析/ ;/ 第/ 8/ 节/ 基于/ 提出/ 的/ TMP/ -/ UAA/ 模型/ 详细/ 阐述/ 移动/ 环境/ 下/ 跨/ 信任/ 域/ 问题/ 的/ 解决/ 方法/ ;/ 第/ 9/ 节/ 总结/ 全文/ ./ 3/ 密码学/ 假设/ 及/ 工具/ 3.1/ 双线性/ 配对/ 令/ G1/ 、/ G2/ 是/ 两个/ p/ 阶/ 循环群/ ,/ 其中/ p/ 为/ 素数/ ,/ g1/ ,/ g2/ 分别/ 是/ G1/ 、/ G2/ 的/ 生成元/ ./ 定义/ 两个/ 群上/ 的/ 双线性/ 映射/ 为/ e/ :/ G1/ ×/ G2/ →/ GT/ ,/ 且/ 满足/ 下面/ 的/ 性质/ :/ a/ ,/ b/ ∈/ / 位元/ ;/ 双线性/ ./ e/ (/ ga/ 非/ 退化/ 性/ ./ e/ (/ g1/ ,/ g2/ )/ ≠/ 1GT/ ,/ 其中/ 1GT/ 是/ GT/ 的/ 单/ 可计算性/ ./ 存在/ 有效/ 算法/ 来/ 计算/ t/ =/ e/ (/ g1/ ,/ g2/ )/ ./ 文献/ [/ 18/ ]/ 将/ 目前/ 在/ 密码学/ 中/ 使用/ 的/ 配对/ 分为/ 3/ 种/ 类型/ ./ 本文/ 方案/ 使用/ 第/ 3/ 种/ 配对/ ,/ 即/ G1/ ≠/ G2/ 且/ G1/ 和/ G2/ 之间/ 不/ 存在/ 有效/ 可/ 计算/ 的/ 同态/ ./ 3.2/ 密码学/ 假设/ 定义/ 1/ ./ DDH/ (/ DecisionalDiffie/ -/ Hellman/ )/ 假设/ ./ 该/ DDH/ 难题/ 在/ 群/ G1/ =/ 〈/ g1/ 〉/ 中/ 的/ 定义/ 如下/ :/ 以/ 四元组/ (/ g1/ ,/ ga/ 率/ 多项式/ 时间/ 算法/ 能够/ 以/ 不可/ 忽略/ 的/ 概率/ ε/ 判断/ c/ 是否/ 等于/ a/ ·/ b/ ./ 定义/ 2/ ./ XDH/ (/ eXternalDiffie/ -/ Hellman/ )/ 假设/ ./ 对于/ 一个/ 非对称/ 双线性/ 配对/ e/ :/ G1/ ×/ G2/ →/ GT/ ,/ 若/ DDH/ 难题/ 在/ 群/ G1/ 中是/ 困难/ 的/ ,/ 那么/ 该/ XDH/ 假设/ 成立/ ./ Page4/ 定义/ 3/ ./ l/ -/ SDH/ (/ l/ -/ StrongDiffie/ -/ Hellman/ )/ 假设/ ./ 该/ l/ -/ SDH/ 假设/ 在/ 群/ (/ G1/ =/ 〈/ g1/ 〉/ ,/ G2/ =/ 〈/ g2/ 〉/ )/ 中/ 定义/ 如下/ :/ 以/ (/ l/ +/ 2/ )/ 个/ 元组/ (/ g1/ ,/ g2/ ,/ gx2/ 作为/ 输入/ ,/ 不/ 存在/ 一个/ 概率/ 多项式/ 时间/ 算/ G1/ ×/ Gl/ +/ 1/ 法/ 能够/ 以/ 不可/ 忽略/ 的/ 概率/ ε/ 输出/ 一个二元/ 组/ (/ A/ ,/ c/ )/ ,/ 使得/ e/ (/ A/ ,/ g/ (/ x/ +/ c/ )/ 下面/ 将/ 给出/ 一个/ 改进/ 的/ SDH/ 假设/ ./ 定义/ 4/ ./ l/ -/ MSDH/ (/ l/ -/ ModifiedStrongDiffie/ -/ Hellman/ )/ 假设/ ./ 该/ l/ -/ MSDH/ 假设/ 在/ 群/ (/ G1/ =/ 〈/ g1/ 〉/ ,/ G2/ =/ 〈/ g2/ 〉/ )/ 中/ 定义/ 如下/ :/ 以/ (/ l/ +/ 2/ )/ 个/ 元组/ (/ g1/ ,/ g2/ ,/ gx2/ ,/ …/ ,/ gxlgx2/ 多项式/ 时间/ 算法/ 能够/ 以/ 不可/ 忽略/ 的/ 概率/ ε/ 输出/ 一个/ 三元组/ (/ Ac/ ,/ A/ ,/ c/ )/ ,/ 使/ 等式/ e/ (/ A/ ,/ gx/ 成立/ ,/ 其中/ c/ ∈/ / 很/ 显然/ 对于/ 任意/ l/ / 1/ 在/ 同样/ 的/ 双线性/ 群中/ ,/ l/ -/ SDH/ 难题/ 的/ 困难性/ 蕴涵/ 了/ l/ -/ MSDH/ 难题/ 的/ 困难性/ ,/ 该/ 难题/ 的/ 归约/ 性/ 证明/ 如下/ ./ 证明/ ./ 假设/ 有/ 敌手/ / 可以/ 在/ 概率/ 多项式/ 时间/ 内/ 输出/ 一个/ l/ -/ MSDH/ 的/ 实例/ ,/ 那么/ 就/ 存在/ 概率/ 多项式/ 时间/ 的/ 模拟器/ / 能够/ 解决/ l/ -/ SDH/ 难题/ ./ 给定/ / 如下/ 参数/ ,/ G1/ =/ 〈/ g1/ 〉/ ,/ G2/ =/ 〈/ g2/ 〉/ ,/ 其中/ g1/ =/ λ/ (/ g2/ )/ ,/ λ/ 是/ 群/ G2/ 到/ 群/ G1/ 的/ 同态/ 以及/ (/ l/ +/ 2/ )/ 个/ 元组/ (/ g1/ ,/ g2/ ,/ gx2/ ,/ …/ ,/ gxlgx2/ 互/ 过程/ 如下/ :/ ·/ ·/ =/ λ/ (/ 珟/ g2/ )/ =/ λ/ (/ gZ/ (/ 1/ )/ / 选择/ 随机数/ α/ ∈/ / p/ 以及/ ci/ ∈/ R/ / p/ ,/ i/ =/ 1/ ,/ …/ ,/ l/ -/ 1/ ,/ 然后/ 利用/ l/ -/ SDH/ 难题/ 的/ (/ l/ +/ 2/ )/ 个/ 元组/ ,/ / 可以/ 获得/ 珟/ g1/ 值得注意/ 的/ 是/ Z/ ≠/ 0/ ,/ 若/ Z/ =/ 0/ 即/ 存在/ x/ =/ -/ ci/ ,/ / 无需/ / 的/ 帮助/ 就/ 可以/ 解决/ SDH/ 难题/ ./ / 将/ 公钥/ (/ 珟/ g1/ ,/ g2/ ,/ Ω/ ·/ ·/ =/ gx/ (/ 2/ )/ 对于/ / 的/ 第/ i/ 次/ 质询/ ,/ 假设/ 质询/ 次数/ 为/ qA/ </ l/ ,/ / 返回/ 一个/ MSDH/ 实例/ ,/ / 计算/ MSDH/ 实例/ 如下/ :/ / 计算/ (/ Aci/ α/ ·/ ∏/ q/ -/ 1j/ ≠/ i/ ,/ j/ =/ 1/ / ./ 显然/ / 可以/ 验证/ 等式/ 成立/ :/ e/ (/ Bi/ ,/ Ω/ )/ =/ e/ (/ 珟/ g1/ // Bi/ ,/ g2/ )/ =/ e/ (/ gZ/ -/ ci/ ·/ Yi1/ ,/ g2/ )/ (/ 3/ )/ / 经过/ qA/ 次/ 质询/ 后/ ,/ 输出/ 一个/ MSDH/ 实例/ (/ B/ ·/ ,/ B/ ·/ ·/ ,/ c/ )/ ,/ 其中/ c/ ≠/ ci/ ,/ i/ ∈/ {/ 1/ ,/ …/ ,/ qA/ }/ 且/ 验证/ 等式/ (/ 4/ )/ 若/ 验证/ 通过/ ,/ 即/ 有/ B/ ·/ =/ gc/ ·/ Z/ // (/ x/ +/ c/ )/ 1/ ,/ 令/ Z/ =/ α/ ·/ (/ X/ (/ x/ )/ (/ x/ +/ c/ )/ +/ C/ )/ ,/ 其中/ X/ (/ x/ )/ 为/ gZ/ // (/ x/ +/ c/ )/ l/ -/ 1/ 阶/ 关于/ x/ 的/ 多项式/ ,/ C/ 为/ 一个/ 可/ 计算/ 的/ 常数/ ,/ 对于/ B/ ·/ ·/ 即/ 有/ A/ =/ (/ (/ B/ ·/ ·/ )/ 1/ // α/ ·/ g/ -/ X/ (/ x/ )/ (/ A/ ,/ c/ )/ 作为/ 对/ SDH/ 难题/ 的/ 解/ ./ 3.3/ Paillier/ 密码/ 系统/ Paillier/ 密码/ 系统/ [/ 19/ ]/ 具有/ 加/ 同态/ (/ AdditiveHomomorphic/ )/ 及/ 自/ 盲化/ (/ SelfBlinding/ )/ 等/ 性质/ ,/ 常用/ 于/ 构建/ 各种/ 密码/ 协议/ ./ 该/ 密码/ 系统/ 由/ 以下/ 3/ 个/ 算法/ 组成/ :/ P/ -/ KeyGen/ (/ 1k/ )/ :/ 输入/ 安全/ 参数/ 1k/ ,/ 选择/ 两个/ 随机/ k/ -/ bit/ 素数/ P/ 和/ Q/ ,/ 并置/ N/ =/ PQ/ ./ 随机/ 选择/ 一个/ 数/ g/ ,/ g/ 要/ 满足/ gcd/ (/ L/ (/ g/ λ/ (/ N/ )/ modN2/ )/ ,/ N/ )/ =/ 1/ ,/ 其中/ 函数/ L/ (/ u/ )/ =/ (/ u/ -/ 1/ )/ // N/ ,/ λ/ (/ N/ )/ =/ lcm/ (/ P/ -/ 1/ ,/ Q/ -/ 1/ )/ ,/ 选择/ 一个/ 随机数/ a/ ∈/ R/ / 在模/ N2/ 下/ 的/ 阶为/ λ/ (/ N/ )/ ./ 加密/ 系统/ 公钥/ 为/ (/ N/ ,/ g/ ,/ h/ )/ ,/ 私钥/ 为/ (/ P/ ,/ Q/ )/ ./ P/ -/ Enc/ (/ m/ )/ :/ 输入/ 消息/ m/ ∈/ / N/ ,/ 选择/ 随机数/ r/ ∈/ / N/ ,/ 计算/ 密文/ c/ =/ gm/ ·/ hrmodN2/ ./ P/ -/ Dec/ (/ c/ )/ :/ 输入/ 密文/ c/ ∈/ / 另外/ ,/ Paillier/ 加密/ 系统/ 加/ 同态/ 可以/ 形式化/ 表示/ (/ L/ (/ c/ λ/ (/ N/ )/ modN2/ )/ // L/ (/ g/ λ/ (/ N/ )/ modN2/ )/ )/ modN/ ./ 为/ P/ -/ Dec/ (/ P/ -/ Enc/ (/ m1/ )/ ·/ P/ -/ Enc/ (/ m2/ )/ )/ =/ m1/ +/ m2/ ./ 3.4/ 可验证/ 加密/ 可验证/ 的/ 加密/ [/ 20/ ]/ (/ VerifiableEncryption/ )/ 是/ 构建/ 多方/ 计算/ 协议/ 的/ 常用/ 密码学/ 工具/ 之一/ ,/ 允许/ 任何/ 实体/ 验证/ 加密/ 的/ 消息/ 和/ 先前/ 承诺/ 的/ 秘密/ 值/ 一样/ ,/ 但/ 不会/ 泄露/ 明文/ 的/ 任何/ 信息/ ./ 安全/ 的/ 可验证/ 加密/ 满足/ 三种/ 性质/ :/ 完备/ 性/ (/ Completeness/ )/ 、/ 有效性/ (/ Soundness/ )/ 和/ 零/ 知识性/ (/ Zero/ -/ Knowledge/ )/ ./ 4/ 面向/ 可信/ 移动/ 平台/ 的/ 匿名/ 证明/ 模型/ 4.1/ TMP/ -/ UAA/ 模型/ 描述/ 括/ :/ 发布者/ / 、/ 签名者/ / 者/ / ./ 下面/ 对/ 各/ 参与者/ 进行/ 说明/ :/ TMP/ -/ UAA/ 模型/ 如图/ 1/ 所示/ ,/ 其中/ 参与/ 实体/ 包/ 发布者/ (/ Issuer/ ,/ / )/ :/ 可/ 为/ 移动/ 设备/ 生产/ 厂商/ ,/ 生成/ 发布者/ 公私/ 钥/ 并/ 为/ 移动/ 可信/ 模块/ / 颁发/ UAA/ 证书/ ;/ 成立/ ;/ 签名者/ (/ Signer/ ,/ / 部分/ 组成/ :/ 可信/ 引擎/ / 及/ 移动/ 可信/ 模块/ / )/ ,/ 能够/ 使/ Page5/ 发布者/ 确信/ 其/ 拥有/ 一个/ 合法/ 的/ MTM/ 并/ 获取/ UAA/ 证书/ ,/ 以此/ 证书/ 来/ 向/ 验证/ 者/ 证明/ 该/ 平台/ 为/ 可信/ 移动/ 平台/ ;/ 证书/ 颁发/ 中心/ (/ CertificateAuthority/ ,/ / / )/ :/ 作为/ 可信/ 第三方/ (/ TrustedThirdParty/ ,/ / / / )/ 提供/ 发布者/ 公钥/ 证书/ 的/ 颁发/ 、/ 验证/ 以及/ 下载/ 等/ 功能/ ,/ 另外/ 的/ 一个/ 职能/ 是/ 为/ 加入/ 协议/ 提供/ RSA/ 公钥/ 参数/ ;/ 验证/ 者/ (/ Verifier/ ,/ / )/ :/ 通常/ 为/ 服务提供者/ ,/ 通过/ 下载/ 发布者/ 公钥/ 证书/ 来/ 校验/ 由/ 签名者/ 生成/ 的/ UAA/ 签名/ ./ 值得/ 说明/ 的/ 是/ ,/ / / 在/ 为/ 发布者/ 颁发/ 公钥/ 证书/ 之后/ 不再/ 参与/ TMP/ -/ UAA/ 方案/ ,/ 而/ 其它/ 实体/ 均/ 直接参与/ TMP/ -/ UAA/ 方案/ ,/ 该/ 方案/ 包括/ 了/ 以下/ 算法/ 及/ 协议/ :/ (/ 1/ )/ Setup/ (/ 1k/ )/ :/ 输入/ 安全/ 参数/ 1k/ ,/ / 使用/ 随机化/ (/ randomized/ )/ 算法/ 生成/ 公私/ 钥对/ (/ IPK/ ,/ ISK/ )/ ,/ / 将/ 生成/ 的/ 部分/ IPK/ 公钥/ 及/ 相关/ 资格/ 凭证/ 等/ 交由/ / / 验证/ ,/ / / 验证/ 发布者/ 合法性/ 并/ 为/ 其/ 颁发/ 发布者/ 公钥/ 证书/ ;/ (/ 2/ )/ Join/ (/ ISK/ ,/ IPK/ ,/ f/ ,/ params2PC/ )/ :/ 不同于/ 现有/ DAA/ 方案/ 加入/ 协议/ 的/ 构建/ 方法/ ,/ 该/ 加入/ 协议/ 基于/ 安全/ 两方/ 计算/ 协议/ ,/ / 及/ / 各自/ 输入/ 秘密/ 值/ ISK/ 及/ f/ 并/ 运行/ 基于/ 公共/ 参数/ (/ IPK/ ,/ params2PC/ )/ 的/ 两方/ 计算/ 协议/ ,/ 最后/ / 获得/ 由/ / 颁发/ 的/ UAA/ 证书/ Cre/ ;/ (/ 3/ )/ Sign/ (/ IPK/ ,/ m/ ,/ bsnV/ ,/ f/ ,/ Cre/ )/ :/ 以/ 私钥/ f/ 、/ 证书/ Cre/ 、/ 验证/ 者/ 基名/ bsnV/ 、/ 消息/ m/ 以及/ 发布者/ 公钥/ IPK/ 作为/ 输入/ ,/ / 及/ / 使用/ 随机化/ 算法/ 生成/ 关于/ 消息/ m/ 的/ UAA/ 签名/ σ/ 并/ 发送给/ / ,/ 值得/ 说明/ 的/ 是/ bsnV/ 用于/ 控制/ UAA/ 签名/ 的/ 关联性/ ;/ (/ 4/ )/ Verify/ (/ m/ ,/ bsnV/ ,/ σ/ ,/ IPK/ ,/ RL/ )/ :/ 以/ 消息/ m/ 、/ UAA/ 签名/ σ/ 、/ 验证/ 者/ 基名/ bsnV/ 、/ 发布者/ 公钥/ IPK/ 以及/ 对应/ 信任/ 域/ 的/ 撤销/ 私钥/ 列表/ RL/ 为/ 输入/ ,/ / 运行/ 确定性/ (/ deterministic/ )/ 算法/ 判定/ 签名/ 是否/ 有效/ ,/ 并/ 输出/ 1/ (/ 有效/ )/ ,/ 0/ (/ 无效/ )/ ./ 需要/ 说明/ 的/ 是/ ,/ 如何/ 建立/ RL/ 列表/ 不/ 在/ 本文/ 讨论/ 范围/ 之内/ ;/ (/ 5/ )/ Link/ (/ σ/ 0/ ,/ σ/ 1/ ,/ bsnV/ ,/ IPK/ )/ :/ 当/ bsnV/ 为/ 非空时/ ,/ 使用/ 确定性/ 算法/ 来/ 判定/ 两个/ 签名/ 并/ 输出/ :/ 1/ (/ 相关联/ )/ 表示/ 两个/ UAA/ 签名/ 由/ 同一/ 签名者/ 产生/ ;/ 0/ (/ 不/ 关联/ )/ 表示/ 由/ 不同/ 签名者/ 产生/ ;/ ⊥/ (/ 无效/ )/ 表示/ 签名/ σ/ 0/ 或/ σ/ 1/ 是/ 无效/ 的/ ./ 在/ 本文/ 第/ 2/ 节中/ 阐述/ 了/ 造成/ R/ 攻击/ 以及/ 跨/ 信任/ 域/ 问题/ 的/ 原因/ ,/ 即/ 发布者/ 公钥/ 合法性/ 得不到/ 验证/ ./ 而/ 在/ 上述/ TMP/ -/ UAA/ 模型/ 中公钥/ 的/ 合法性/ 由/ / / 来/ 保障/ ,/ 一方面/ 避免/ 了/ 恶意/ 发布者/ 滥用/ 公钥/ 而/ 导致/ R/ 攻击/ 产生/ 的/ 问题/ ;/ 另一方面/ ,/ 无论/ 验证/ 者/ 在/ 任何/ 信任/ 域/ 中/ 均/ 可/ 通过/ / / 验证/ 不同/ 发布者/ 公钥/ 证书/ 的/ 合法性/ ,/ 实现/ 了/ 验证/ 者/ 域/ 无关/ 性/ ,/ 同时/ 也/ 有效/ 解决/ 了/ 跨/ 信任/ 域/ 问题/ ,/ 关于/ 该/ 问题/ 的/ 进一步/ 阐述/ 见/ 第/ 8/ 节/ ./ 4.2/ TMP/ -/ UAA/ 安全/ 模型/ (/ 1/ )/ 正确性/ 如果/ 签名者/ 与/ 验证/ 者/ 都/ 是/ 诚实/ 的/ ,/ 意味着/ 签名者/ 私钥/ f/ / RL/ ,/ 那么/ 由该/ 签名者/ 所/ 生成/ 的/ 签名/ 以及/ 签名/ 之间/ 的/ 关联/ 都/ 可/ 被/ 验证/ 者/ 以/ 压倒性/ 的/ 概率/ 验证/ 通过/ ./ 这/ 表明/ 本文/ 所/ 提出/ 的/ 算法/ 及/ 协议/ 必须/ 满足/ 一致性/ 需求/ ./ 其/ 形式化/ 表示/ 如下/ :/ 若/ Setup/ (/ 1k/ )/ →/ (/ ISK/ ,/ IPK/ )/ ,/ Join/ (/ ISK/ ,/ IPK/ ,/ f/ ,/ params2PC/ )/ →/ (/ f/ ,/ Cre/ )/ ,/ 以及/ Sign/ (/ IPK/ ,/ m/ ,/ bsnV/ ,/ f/ ,/ Cre/ )/ →/ (/ m/ ,/ σ/ )/ ,/ 则/ 必有/ Verify/ (/ m/ ,/ bsnV/ ,/ σ/ ,/ IPK/ ,/ RL/ )/ →/ 1/ 以及/ Link/ (/ σ/ 0/ ,/ σ/ 1/ ,/ bsnV/ ,/ IPK/ )/ |/ bsnV/ ≠/ ⊥/ →/ 1/ 成立/ ./ (/ 2/ )/ 用户/ 可控/ 匿名性/ TMP/ -/ UAA/ 方案/ 提供/ 了/ 用户/ 可控/ 匿名性/ (/ user/ -/ controlledanonymous/ )/ ,/ 这个/ 概念/ 需要/ 满足/ 以下/ 两个/ 性质/ ,/ 非/ 形式化/ 描述/ 如下/ :/ 匿名性/ (/ anonymity/ )/ :/ 敌手/ 在/ 不/ 知道/ 签名者/ 私钥/ 的/ 前提/ 下/ ,/ 即使/ 可以/ 获取/ 发布者/ 的/ 私钥/ 及/ 签名者/ 的/ UAA/ 证书/ ,/ 也/ 难以/ 通过/ 签名/ 值来/ 揭示/ 签名者/ 的/ 身份/ ./ 用户/ 可控/ 不可/ 关联性/ (/ user/ -/ controlledunlink/ -/ ability/ )/ :/ 给定/ σ/ 0/ 和/ σ/ 1/ 是/ 分别/ 关于/ 不同/ 非/ 空基/ 名/ bsn0/ 和/ bsn1/ 的/ 签名/ ,/ 敌手/ 在/ 不/ 知道/ 签名者/ 私钥/ 的/ 前提/ 下/ ,/ 难以/ 通过/ 签名/ 值来/ 揭示/ 这/ 两个/ 签名/ 是/ 由/ 同一个/ 签名者/ 产生/ 的/ ./ 可以/ 通过/ 敌手/ / 与/ 挑战者/ / 之间/ 的/ 游戏/ 来形/ Page6/ 式化/ 定义/ 用户/ 可控/ 匿名性/ 的/ 概念/ ./ 私钥/ 对/ (/ IPK/ ,/ ISK/ )/ 发送给/ / ./ Initial/ ./ / 运行/ Setup/ (/ 1k/ )/ 算法/ ,/ 并/ 将/ 生成/ 的/ 公/ JoinInitial/ ./ 由于/ Join/ 协议/ 基于/ 两方/ 计算/ 协议/ ,/ 其/ 安全性/ 模型/ 与/ Sign/ 协议/ 相/ 独立/ ,/ 因此/ 为/ 确保/ 该游戏/ 的/ 进行/ ,/ / 将/ 在/ 该/ 阶段/ 初始化/ 一个/ 足够/ 大/ 的/ UAA/ 证书/ 列表/ LCre/ ./ ID/ 对应/ 的/ 签名者/ 私钥/ 作为/ 对/ / 的/ 响应/ ./ Phase1/ ./ / 对/ / 进行/ 如下/ 质询/ :/ ①/ Join/ -/ Corrupt/ ./ 为/ 确保/ / 能/ 获取/ 关于/ 每个/ 签名者/ 身份/ 标识/ ID/ 的/ UAA/ 证书/ ,/ / 可以/ 进行/ JoinCorrupt/ 质询/ ,/ / 将/ 从/ LCre/ 中/ 选择/ 一个/ UAA/ 证书/ 作为/ 关于/ 该/ ID/ 的/ 返回值/ ./ ②/ Sign/ ./ / 提交/ 它/ 所/ 选择/ 签名者/ 的/ ID/ 以及/ 基名/ bsnV/ (/ 等于/ ⊥/ 或者/ 字符串/ )/ 和/ 消息/ m/ ,/ / 运行/ Sign/ 协议/ 并/ 将/ UAA/ 签名/ 值/ σ/ 发送给/ / ./ ③/ Corrupt/ ./ / 提交/ 它/ 所/ 选择/ 签名者/ 的/ ID/ ,/ / 将/ Challenge/ ./ 在/ 第一阶段/ 结束/ 后/ ,/ / 选择/ 两个/ 签名者/ 的/ 身份/ 标识/ ID0/ 及/ ID1/ ,/ 消息/ m/ 和/ 它/ 所/ 选择/ 的/ 基名/ bsnV/ (/ 等于/ ⊥/ 或者/ 字符串/ )/ 提交/ 给/ / ./ 这里/ 必须/ 要/ 保证/ / 没有/ 对/ ID0/ 及/ ID1/ 进行/ 过/ Corrupt/ 质询/ ,/ 并且/ 在/ bsnV/ ≠/ ⊥/ 的/ 情况/ 下/ 没有/ 用/ 同一个/ bsnV/ 对/ ID0/ 及/ ID1/ 进行/ 过/ Sign/ 质询/ ./ / 选择/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ 并/ 对/ 消息/ m/ 运行/ Sign/ 协议/ ,/ 并/ 将/ 得到/ 的/ 签名/ 值/ σ/ ψ/ 作为/ 挑战/ 值/ 发送给/ / ./ Phase2/ ./ / 用/ 与/ Phase1/ 同样/ 类型/ 的/ 质询/ 继续/ 询问/ / ,/ 这个/ 阶段/ 必须/ 要/ 保证/ 其/ 不/ 允许/ 对/ ID0/ 及/ ID1/ 进行/ Corrupt/ 质询/ ,/ 以及/ 要/ 保证/ 在/ bsn/ ≠/ ⊥/ 的/ 情况/ 下/ 没有/ 用/ 同一个/ bsnV/ 对/ ID0/ 及/ ID1/ 进行/ 任何/ Sign/ 质询/ ./ Response/ ./ / 返回/ 一个/ 比特/ 值/ / ,/ 当/ / =/ ψ/ 时称/ 定义/ 5/ ./ 敌手/ / 破坏/ 用户/ 可控/ 匿名性/ 游戏/ 的/ / 赢得/ 了/ 该游戏/ ./ 优势/ 记为/ Adv/ [/ / 任何/ 概率/ 多项式/ 时间/ 敌手/ / ,/ Adv/ [/ / 的/ ,/ 那么/ 称/ TMP/ -/ UAA/ 方案/ 具有/ 用户/ 可控/ 匿名性/ ./ (/ 3/ )/ 用户/ 可控/ 追踪/ 性/ TMP/ -/ UAA/ 方案/ 提供/ 了/ 用户/ 可控/ 追踪/ 性/ ,/ 该/ 安全性/ 定义/ 继承/ 了/ 群/ 签名/ 完全/ 追踪/ 性/ (/ fulltraceability/ )/ 中/ 的/ 不可/ 伪造/ 性及/ 抗/ 合谋/ 性/ ,/ 但/ 在/ 追踪/ 算法/ 上用/ Link/ 算法/ 代替/ 了/ 群/ 签名/ 的/ Open/ 算法/ ./ 其/ 定义/ 非/ 形式化/ 描述/ 如下/ :/ 不可/ 伪造/ 性/ (/ unforgeability/ )/ :/ 敌手/ 在/ 不/ 知道/ 发布者/ 私钥/ 的/ 情况/ 下/ ,/ 即使/ 它/ 获取/ 了/ 关于/ 签名者/ UAA/ 证书及/ 私钥/ 的/ 一个/ 集合/ ,/ 它/ 也/ 很/ 难/ 伪造/ 一个/ 有效/ 的/ UAA/ 签名/ ,/ 且/ 生成/ 该/ 签名/ 所/ 使用/ 的/ 证书及/ 私钥/ 不/ 在/ 上述/ 集合/ 中/ ./ 用户/ 可控/ 关联性/ (/ user/ -/ controlledlinkability/ )/ :/ 给定/ 敌手/ 一个/ 非/ 空基/ 名/ bsnV/ ,/ 敌手/ 难以/ 伪造/ 关于/ 相同/ 签名者/ 的/ 两个/ 不同/ 签名/ ,/ 使得/ Link/ 算法/ 的/ 输出/ 为/ 0/ ./ 为/ 形式化/ 这个/ 概念/ ,/ 通过/ 敌手/ / 与/ 挑战者/ / 之间/ 的/ 游戏/ 来/ 定义/ 用户/ 可控/ 追踪/ 性/ 的/ 概念/ ./ Initial/ ./ / 运行/ Setup/ (/ 1k/ )/ 算法/ ,/ 并/ 将/ 生成/ 的/ 公钥/ IPK/ 发送给/ / ,/ 并/ 不/ 泄露/ 私钥/ ISK/ ./ JoinInitial/ ./ 同/ 定义/ 5/ 中/ 的/ JoinInitial/ ./ Probing/ ./ / 对/ / 进行/ 如下/ 质询/ :/ ①/ Join/ -/ Corrupt/ ./ 同/ 定义/ 5/ 中/ 的/ Join/ -/ Corrupt/ ./ ②/ Sign/ ./ / 提交/ 它/ 所/ 选择/ 签名者/ 的/ ID/ 以及/ 基名/ bsnV/ (/ 等于/ ⊥/ 或者/ 字符串/ )/ 和/ 消息/ m/ ,/ / 运行/ Sign/ 协议/ 并/ 将/ UAA/ 签名/ 值/ σ/ 发送给/ / ./ ③/ Corrupt/ ./ / 提交/ 它/ 所/ 选择/ 签名者/ 的/ ID/ ,/ / 将/ ID/ 对应/ 的/ 签名者/ 私钥/ 作为/ 对/ / 的/ 响应/ ,/ 并/ 将/ 关于/ 该/ ID/ 的/ 私钥/ 放入/ RL/ 中/ ./ Output/ ./ / 输出/ 一个/ 签名者/ ID/ ,/ UAA/ 签名/ σ/ ,/ 消息/ m/ 以及/ 基名/ bsnV/ ./ 仅当/ 以下/ 两种/ 情况/ 发生/ 时/ ,/ 称/ / 赢得/ 了/ 该游戏/ ./ ①/ Verify/ (/ m/ ,/ bsnV/ ,/ σ/ ,/ IPK/ ,/ RL/ )/ →/ 1/ ,/ 且/ 该/ 签名/ σ/ 不/ 属于/ 已经/ Sign/ 质询/ 的/ 响应/ 集合/ ;/ ②/ 敌手/ 能够/ 生成/ 关于/ 相同/ 基名/ bsnV/ 及/ ID/ 的/ 两个/ 有效/ UAA/ 签名/ σ/ 0/ 、/ σ/ 1/ ,/ 使得/ 关联/ 算法/ Link/ (/ σ/ 0/ ,/ σ/ 1/ ,/ IPK/ )/ |/ bsnV/ ≠/ ⊥/ →/ 0/ ./ 定义/ 6/ ./ 敌手/ / 破坏/ 用户/ 可控/ 匿名性/ 游戏/ 的/ 优势/ 记为/ Adv/ [/ / 概率/ 多项式/ 时间/ 敌手/ / ,/ Adv/ [/ / 那么/ 称/ TMP/ -/ UAA/ 方案/ 具有/ 用户/ 可控/ 追踪/ 性/ ./ 5/ 安全/ 两方/ 计算/ 协议/ 的/ 构建/ TMP/ -/ UAA/ 方案/ 的/ Join/ 协议/ 基于/ 两方/ 计算/ 协议/ ,/ 因此/ 有/ 必要/ 在/ 本节/ 对/ 该/ 协议/ 的/ 构建/ 进行/ 具体/ 阐述/ ./ 文献/ [/ 21/ ]/ 提出/ 了/ 一个/ 安全/ 两方/ 计算/ 协议/ ,/ 该/ 协议/ 使得/ 用户/ 最终/ 得到/ 一个/ 由/ 发布者/ 签发/ 的/ 证书/ Cre/ ·/ ·/ =/ g1/ // (/ isk/ +/ f/ )/ isk/ ∈/ / p/ 是/ 发布者/ 输入/ 秘密/ 值/ ,/ f/ ∈/ / p/ 是/ 用户/ 输入/ 秘密/ 值/ ./ 虽然/ 文献/ [/ 21/ ]/ 构建/ 了/ 该/ 协议/ 的/ 安全/ 模型/ 并进/ Page7/ 行/ 了/ 安全性/ 证明/ ,/ 但是/ 文中/ 该/ 协议/ 只是/ 形式化/ 的/ 描述/ 并未/ 对/ 该/ 协议/ 进行/ 实例/ 化/ ./ 因此/ 本/ 节/ 利用/ Paillier/ 同态/ 加密/ 系统/ [/ 19/ ]/ 及/ 可/ 校验/ 加密/ 方法/ [/ 20/ ,/ 22/ ]/ 实例/ 化该/ 协议/ ./ 协议/ 由/ 3/ 个/ 实体/ 构成/ :/ 发布者/ / 、/ 用户/ / 及/ 可信/ 第三方/ / / / (/ 在/ Join/ 协议/ 中为/ 图/ 1/ 中/ 的/ / / )/ ./ 值得/ 说明/ 的/ 是/ ,/ / / / 不/ 直接参与/ 该/ 协议/ 而仅/ 提供/ 可信/ 的/ 公共/ 参数/ paramsT/ ·/ ·/ =/ {/ n/ ,/ g/ ,/ h/ }/ ,/ 其中/ n/ =/ pq/ 为/ RSA/ 模数/ 并且/ n/ / 2l/ ·/ p2/ (/ l/ 为/ 安全/ 参数/ )/ ,/ p/ 和/ q/ 是/ 其他/ 参与者/ 所/ 不/ 知道/ 的/ ,/ g/ ,/ h/ ∈/ / 如下/ :/ (/ 1/ )/ 发布者/ / 生成/ Paillier/ 加密/ 系统/ 所/ 需/ 的/ 相关/ 参数/ ,/ {/ PK/ ,/ SK/ }/ =/ {/ (/ N/ ,/ g/ ,/ h/ )/ ,/ (/ P/ ,/ Q/ )/ }/ ,/ 其中/ N/ / 2k/ ·/ p2/ ./ / 选取/ 随机数/ r1/ ∈/ R/ / N/ 计算/ 密文/ e1/ ·/ ·/ =/ P/ -/ Enc/ (/ isk/ )/ 以及/ 承诺/ 值/ c1/ ·/ ·/ =/ giskhrmodn/ ,/ 其中/ r/ ∈/ R/ / n/ ,/ 将/ e1/ ,/ c1/ 发送给/ 用户/ / 并/ 进行/ 如下/ 知识/ 证明/ :/ PK/ {/ (/ sk/ ,/ r1/ ,/ r/ )/ :/ e1/ =/ giskhr1modN2/ ∧/ c1/ ·/ ·/ =/ giskhrmodn/ }/ ;/ (/ 2/ )/ 用户/ / 利用/ Paillier/ 加/ 同态/ 的/ 性质/ 进行/ 如下/ 计算/ :/ 首先/ 选择/ 两个/ 随机数/ r2/ ∈/ R/ / p/ ,/ r3/ ∈/ R/ / N/ 分别/ 计算/ 密文/ e2/ ·/ ·/ =/ (/ e1/ )/ r2gf/ ·/ r2hr3/ =/ g/ (/ isk/ +/ f/ )/ ·/ r2hr1r2/ +/ r3modN2/ 及/ 承诺/ 值/ c2/ ·/ ·/ =/ gf/ ·/ hrmodn/ ,/ 其中/ r/ ∈/ R/ / n/ // p/ ,/ 并/ 计算/ 珚/ f/ ·/ ·/ =/ f/ ·/ r2/ 及/ r/ -/ ·/ ·/ =/ r2/ ·/ r/ ./ 用户/ / 将/ e2/ ,/ c2/ 发送给/ 发布者/ / ,/ 并/ 进行/ 如下/ 知识/ 证明/ :/ PK/ {/ (/ f/ ,/ 珔/ f/ ,/ r2/ ,/ r3/ ,/ r/ -/ ,/ r/ )/ :/ e2/ ·/ ·/ =/ (/ e1/ )/ r2gf/ -/ hr3modN2/ ∧/ BilinearSetup/ (/ 1k/ )/ →/ params/ (/ G1/ ,/ G2/ ,/ GT/ ,/ p/ ,/ e/ ,/ g1/ ,/ g2/ ,/ h1/ )/ ,/ c2/ ·/ ·/ =/ gf/ ·/ hrmodn/ ∧/ 1/ =/ cr12/ // (/ gf/ -/ hr/ -/ )/ }/ ;/ (/ 3/ )/ / 接收/ 到/ e2/ ,/ 用/ 私钥/ 对/ e2/ 解密/ 得到/ 明文/ m/ ·/ ·/ =/ P/ -/ Dec/ (/ e2/ )/ =/ (/ isk/ +/ f/ )/ ·/ r2/ ,/ 计算/ Cre/ ·/ ·/ =/ 1modp/ ,/ 并/ 将/ Cre/ 发送给/ 用户/ / ;/ g1/ // m/ (/ 4/ )/ 用户/ / 计算/ Cre/ ·/ ·/ =/ (/ Cre/ )/ r2/ =/ g1/ // (/ isk/ +/ f/ )/ 该/ 2PC/ 协议/ 的/ 安全性/ 由/ 文献/ [/ 21/ ]/ 提出/ 的/ 2PC/ 安全性/ 定理/ 及/ Paillier/ 加密/ 系统/ 、/ PK/ 知识/ 证明/ 系统/ 的/ 安全性/ 保证/ ,/ 其中/ Paillier/ 加密/ 系统/ 和/ 知识/ 证明/ 协议/ 的/ 安全性/ 证明/ 分别/ 参见/ 文献/ [/ 19/ ,/ 22/ ]/ ./ 上述/ 协议/ 的/ 安全性/ 确保/ 了/ 发布者/ 获取/ 不到/ 关于/ 用户/ 私钥/ f/ 的/ 任何/ 信息/ ,/ 可以/ 有效/ 保障/ 用户/ 隐私/ ./ 6TMP/ -/ UAA/ 方案/ 6.1/ 初始化/ (/ Setup/ )/ 输入/ 安全/ 参数/ 1k/ ,/ 该/ 初始化/ 算法/ 执行/ 如下/ :/ (/ 1/ )/ 发布者/ / 产生/ 公共/ 参数/ :/ 其中/ p/ 代表/ 群/ G1/ ,/ G2/ 和/ GT/ 的/ 素数/ 阶/ ,/ e/ 代表/ 一个/ 配对/ 函数/ e/ :/ G1/ ×/ G2/ →/ GT/ ,/ g1/ 是/ 群/ G1/ 中/ 的/ 生成元/ ,/ g2/ 是/ G2/ 群中/ 的/ 生成元/ ;/ (/ 2/ )/ 发布者/ / 选择/ 以下/ 4/ 个/ Hash/ 函数/ ,/ 分别/ 是/ H0/ :/ {/ 0/ ,/ 1/ }/ / →/ / p/ ,/ H1/ :/ {/ 0/ ,/ 1/ }/ / →/ G1/ ,/ H2/ :/ {/ 0/ ,/ 1/ }/ / →/ / p/ ,/ H3/ :/ {/ 0/ ,/ 1/ }/ / →/ / p/ ,/ 并/ 选择/ 私钥/ ISK/ ·/ ·/ =/ γ/ ∈/ R/ / 计算/ Ω/ ·/ ·/ =/ g/ γ/ ;/ (/ IPK/ ,/ ISK/ )/ ·/ ·/ =/ (/ (/ G1/ ,/ G2/ ,/ GT/ ,/ p/ ,/ e/ ,/ g1/ ,/ g2/ ,/ H0/ ,/ H1/ ,/ H2/ ,/ H3/ ,/ Ω/ )/ ,/ γ/ )/ ;/ (/ 4/ )/ 发布者/ / 将/ 公钥/ IPK/ 经由/ 安全/ 通道/ 发送给/ / / ,/ / / 根据/ 该名/ 发布者/ 的/ 相关/ 信息/ 颁发/ 公钥/ 证书/ CertIPK/ ./ (/ 3/ )/ 发布者/ / 输出/ 公钥/ 及/ 私钥/ 为/ 值得/ 说明/ 的/ 是/ ,/ 在/ 实际/ 的/ 实现/ 设计/ 中/ 对于/ 步/ (/ 2/ )/ 中/ Hash/ 函数/ H0/ ,/ H2/ ,/ H3/ 可/ 使用/ 同一个/ Hash/ 函数/ ,/ 这里/ 将/ 其/ 标识/ 为/ 不同/ 的/ Hash/ 函数/ 是/ 为/ 方便/ 第/ 7/ 节/ 的/ 安全性/ 证明/ ./ 6.2/ 加入/ (/ Join/ )/ 协议/ 本/ 小节/ 所/ 提出/ 的/ 加入/ 协议/ 基于/ 第/ 5/ 节/ 提出/ 的/ 安全/ 两方/ 计算/ 协议/ ,/ 协议/ 参与者/ 为/ 发布者/ / 以及/ 移动/ 可信/ 模块/ / 并/ 各自/ 以/ 一个/ 秘密/ 值/ 作为/ 输入/ ,/ 最后/ / 获得/ 发布者/ / 为/ 其/ 颁发/ 的/ UAA/ 证书/ ./ 首先/ 为/ 确保/ 与/ 发布者/ / 通信/ 的/ MTM/ 是/ 真实/ 的/ ,/ 需要/ 在/ 两者之间/ 建立/ 一条/ 单向/ 真实/ 通道/ (/ one/ -/ wayauthenticchannel/ )/ ,/ TCG/ 推荐/ [/ 1/ ]/ 的/ 一种/ 方法/ 是/ 利用/ MTM/ 的/ EK/ (/ 背书/ 密钥/ )/ 公钥/ 加密/ 发布者/ / 向/ / 所/ 发送/ 的/ 每条/ 信息/ ,/ 发布者/ / 与/ / 按/ 如下/ 步骤/ 进行/ :/ (/ 1/ )/ / 获得/ 发布者/ 的/ 公钥/ 证书/ CertIPK/ 后/ ,/ 验证/ 该公钥/ 证书/ 的/ 合法性/ ,/ 然后/ 利用/ MTM/ 的/ 内部/ 密钥/ 种子/ DAAseed/ 值/ 以及/ 发布者/ / 的/ 公钥/ IPK/ 来/ 生成/ 秘密/ 值/ f/ ·/ ·/ =/ H0/ (/ DAAseed/ ‖/ IPK/ )/ ;/ (/ 2/ )/ / 与/ / 分别/ 以/ f/ 和/ ISK/ =/ γ/ 作为/ 秘密/ 输入/ 值/ ,/ 并/ 分别/ 扮演/ 2PC/ 协议/ 中/ 的/ 用户/ / 及/ 发布者/ / 运行/ 本文/ 第/ 5/ 节中/ 所/ 提出/ 的/ 两方/ 计算/ 协议/ ;/ (/ 3/ )/ 通过/ 两方/ 计算/ 协议/ / 得到/ 发布者/ / 所/ 颁发/ 的/ UAA/ 证书/ Cre/ ·/ ·/ =/ g1/ // (/ γ/ +/ f/ )/ (/ (/ Cre/ )/ f/ ,/ Cre/ )/ =/ (/ gf/ // (/ γ/ +/ f/ )/ 校验/ e/ (/ A/ ,/ Ω/ )/ =/ e/ (/ g1/ // A/ ,/ g2/ )/ 是否/ 成立/ ./ 最后/ / 存储/ (/ A/ ,/ A/ )/ ,/ / 将/ f/ 加密/ 保存/ 在/ MTM/ 的/ 非易/ 失性/ 存储/ 区内/ ./ 6.3/ 签名/ (/ Sign/ )/ 协议/ 验证/ 者/ / ,/ 协议/ 按/ 如下/ 步骤/ 进行/ :/ 该/ 协议/ 的/ 参与方/ 为/ MTM/ / ,/ 可信/ 引擎/ / 以及/ Page8/ (/ 1/ )/ 为/ 确保/ 消息/ 的/ 新鲜/ 性/ ,/ / 首先/ 发送/ 一个/ 随机/ 值/ nV/ ←/ {/ 0/ ,/ 1/ }/ ln/ 给/ / ;/ (/ 2/ )/ / 选择/ 随机数/ r/ ∈/ R/ / p/ ,/ 计算/ T1/ ·/ ·/ =/ Ar/ ,/ T2/ ·/ ·/ =/ Ar/ ,/ T3/ ·/ ·/ =/ gr/ (/ 3/ )/ 若/ / 的/ 基名/ (/ basename/ )/ 有/ bsnv/ ≠/ ⊥/ ,/ 则/ 需要/ 计算/ B/ ·/ ·/ =/ H1/ (/ bsnV/ )/ ∈/ G1/ 并令/ V/ ·/ ·/ =/ T2/ ·/ B/ ,/ 否则/ / 令/ B/ ·/ ·/ =/ ⊥/ ,/ V/ ·/ ·/ =/ T2/ ,/ 然后/ 将/ (/ T2/ ,/ B/ ,/ c/ ,/ m/ ,/ bsnV/ )/ 发送给/ / ;/ (/ 4/ )/ 若/ bsnv/ ≠/ ⊥/ / 计算/ K/ ·/ ·/ =/ Bf/ ,/ 否则/ 令/ K/ ·/ ·/ =/ ⊥/ ,/ 然后/ / 选择/ 一个/ 随机数/ rf/ ∈/ / p/ 计算/ U/ ·/ ·/ =/ Vrf/ 以及/ c/ ·/ ·/ =/ H3/ (/ c/ ‖/ K/ ‖/ U/ ‖/ bsnV/ ‖/ m/ ‖/ nM/ )/ ,/ nM/ →/ (/ 0/ ,/ 1/ )/ ln/ ;/ (/ 5/ )/ / 计算/ sf/ 送给/ / ;/ (/ 6/ )/ / 将/ 签名/ 值/ σ/ ·/ ·/ =/ (/ T1/ ,/ T2/ ,/ T3/ ,/ K/ ,/ c/ ,/ sf/ ,/ nM/ )/ 发/ (/ 1/ )/ 校验/ 发布者/ 公钥/ 证书/ 的/ 合法性/ 并/ 检查/ T1/ ,/ 送给/ 验证/ 者/ / ./ 6.4/ 验证/ (/ Verify/ )/ 验证/ 者/ / 接收/ 到/ TMP/ 的/ 签名/ 值/ σ/ 及/ 消息/ m/ 后/ ,/ 利用/ 发布者/ / 的/ 公钥/ IPK/ 及/ 撤销/ 列表/ RL/ (/ 已/ 撤销/ 私钥/ f/ 的/ 列表/ )/ 进行/ 如下/ 校验/ :/ T2/ ,/ T3/ ,/ K/ 是否/ 属于/ G1/ ,/ 及/ sf/ 是否/ 属于/ / p/ ;/ (/ 2/ )/ 对于/ 每个/ f/ ∈/ RL/ 校验/ 是否/ 有/ T1/ =/ Tf/ (/ 3/ )/ 验证/ 等式/ e/ (/ T2/ ,/ Ω/ )/ =/ e/ (/ T3/ // T1/ ,/ g2/ )/ 是否/ 成立/ ;/ (/ 4/ )/ 若/ bsnV/ ≠/ ⊥/ / 令/ B/ ·/ ·/ =/ H1/ (/ bsnV/ )/ 计算/ V/ ·/ ·/ =/ T2/ ·/ B/ 以及/ W/ ·/ ·/ =/ T1/ ·/ K/ ,/ 否则/ 令/ V/ ·/ ·/ =/ T2/ 及/ W/ ·/ ·/ =/ T1/ ·/ / 计算/ U/ ·/ ·/ =/ Vsf/ ·/ W/ -/ c/ ,/ 校验/ c/ 是否/ 等于/ H3/ (/ H2/ (/ T1/ ‖/ T2/ ‖/ T3/ ‖/ nV/ )/ ‖/ K/ ‖/ U/ ‖/ bsnV/ ‖/ m/ ‖/ nM/ )/ ;/ 绝/ )/ ,/ 否则/ 输出/ 1/ (/ 接受/ )/ ./ 6.5/ 关联/ (/ Link/ )/ 非/ 空基/ 名/ bsnV/ 以及/ 公钥/ IPK/ ,/ 关联/ 方法/ 如下/ :/ 输入/ 两个/ 消息/ -/ 签名/ 对/ (/ m0/ ,/ σ/ 0/ )/ 和/ (/ m1/ ,/ σ/ 1/ )/ ,/ 一个/ (/ 1/ )/ 对于/ 上述/ 每个/ 签名/ 运行/ 验证/ 算法/ ,/ 若/ 算法/ (/ 5/ )/ 若/ 以上/ 任意/ 步骤/ 校验/ 失败/ ,/ / 输出/ 0/ (/ 拒/ (/ 2/ )/ 若/ (/ B/ ,/ K/ )/ ∈/ σ/ 0/ 与/ (/ B/ ,/ K/ )/ ∈/ σ/ 1/ 相同/ ,/ 则/ 返回/ 1/ 返回值/ 为/ 0/ ,/ 则/ 该/ 关联/ 算法/ 返回/ ⊥/ (/ 无效/ )/ ;/ (/ 关联/ )/ ;/ 否则/ 返回/ 0/ (/ 不/ 关联/ )/ ./ 7/ 安全性/ 及/ 性能/ 分析/ 7.1/ 安全性/ 分析/ 基于/ 第/ 4/ 节/ 提出/ 的/ 安全性/ 模型/ ,/ 本节/ 对/ 本文/ 提出/ 方案/ 的/ 安全性/ 进行/ 分析/ ./ 一个/ TMP/ -/ UAA/ 方案/ 必/ 方案/ 满足/ 正确性/ ./ 须/ 满足/ 以下/ 安全/ 性质/ :/ 正确性/ 、/ 用户/ 可控/ 匿名性/ 及/ 用户/ 可控/ 追踪/ 性/ ./ (/ 1/ )/ 正确性/ 定理/ 1/ (/ 正确性/ )/ ./ 本文/ 所/ 提出/ 的/ TMP/ -/ UAA/ 证明/ ./ 验证/ 算法/ Verify/ 以及/ 关联/ 算法/ Link/ 的/ 正确性/ 可/ 直观/ 得出/ ./ (/ 2/ )/ 用户/ 可控/ 匿名性/ 定理/ 2/ (/ 用户/ 可控/ 匿名性/ )/ ./ TMP/ -/ UAA/ 方案/ 提供/ 了/ 用户/ 可控/ 匿名性/ ,/ 如果/ 存在/ 一个/ 敌手/ / 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 出/ 不同/ 签名者/ 所/ 产生/ 的/ 签名/ 值/ ,/ 那么/ 就/ 存在/ 一个/ 概率/ 多项式/ 时间/ 的/ 模拟器/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 解决/ XDH/ 难题/ ./ 在/ TMP/ -/ UAA/ 方案/ 中/ ,/ 对于/ bsnV/ 值为/ 空/ 或非/ 空/ 的/ 情况/ 有/ 两种/ 形式/ 的/ 签名/ ,/ 对于/ 这/ 两种/ 情况/ 的/ 签名/ 值/ 在/ XDH/ 难题/ 假设/ 下/ 将/ 分别/ 以/ 引理/ 的/ 形式/ 证明/ 它/ 满足用户/ 可控/ 匿名性/ ./ TMP/ -/ UAA/ 签名/ 满足/ 匿名性/ ./ 引理/ 1/ ./ 当/ bsnV/ =/ ⊥/ 时/ ,/ 在/ XDH/ 假设/ 下/ 证明/ ./ 给定/ 模拟器/ / 一个/ XDH/ 的/ 实例/ ,/ 即/ (/ u/ ,/ v/ =/ ua/ ,/ w/ =/ ub/ ,/ z/ )/ ,/ 其中/ u/ ∈/ G1/ ,/ a/ ,/ b/ ∈/ / p/ 以及/ z/ =/ uab/ 或者/ z/ ∈/ RG1/ ,/ / 为/ 判断/ 所/ 给定/ 的/ z/ 属于/ 哪/ 种/ 情况/ 与/ / 进行/ 如下/ 交互/ :/ Initial/ ./ / 运行/ Setup/ (/ 1k/ )/ 算法/ ,/ 生成/ 发布者/ 公私/ 钥对/ IPK/ ,/ (/ )/ ISK/ =/ (/ (/ G1/ ,/ G2/ ,/ GT/ ,/ p/ ,/ e/ ,/ g1/ ,/ g2/ ,/ H0/ ,/ H1/ ,/ H2/ ,/ H3/ ,/ Ω/ )/ ,/ γ/ )/ ,/ 并/ 将/ 该/ 公私/ 钥对/ 发送给/ / ./ 对于/ / 的/ 质询/ ,/ / 为/ 确保/ 响应/ 的/ 一致性/ 建立/ 如下/ 3/ 个/ 列表/ :/ LH3/ 存储/ 对/ 随机/ 预言/ H3/ 的/ 质询/ 值及/ 响应值/ ;/ LC/ 存储/ 对/ Corrupt/ 的/ 质询/ 及/ 响应值/ ,/ 表项/ 关键字/ 为/ (/ ID/ ,/ f/ ,/ CreDAA/ ,/ d/ )/ ,/ 其中/ d/ 若/ 等于/ 1/ 表示/ 对应/ 的/ 签名者/ 被/ Corrupt/ 质询/ ,/ d/ 等于/ 0/ 则/ 表示/ 对应/ 签名者/ 未/ 被/ Corrupt/ 质询/ ;/ LS/ 存储/ 对/ Sign/ 的/ 质询/ 及/ 响应值/ ,/ 表项/ 关键字/ 为/ (/ ID/ ,/ m/ ,/ σ/ )/ ./ 在/ 模拟/ 的/ 开始/ 阶段/ 各个/ 列表/ 均/ 为/ 空/ ./ 在/ / 的/ 质询/ 过程/ 中/ ,/ 用/ qH/ 、/ qJC/ 、/ qS/ 、/ qC/ 分别/ 表示/ / 对/ Hash/ 函数/ 、/ Join/ -/ Corrupt/ 、/ Sign/ 及/ Corrupt/ 的/ 质询/ 次数/ ./ Join/ -/ Initial/ ./ / 生成/ 了/ 一个/ 足够/ 大/ 的/ UAA/ 证书/ 列表/ LCre/ ·/ ·/ =/ {/ (/ Crej/ ,/ fj/ )/ }/ =/ {/ (/ g1/ // (/ γ/ +/ fj/ )/ ,/ fj/ )/ }/ |/ j/ ∈/ {/ 1/ ,/ …/ ,/ n/ }/ ,/ 其中/ qJC/ </ n/ </ l/ ./ Hash/ 质询/ ./ 令/ H3/ 为/ 随机/ 预言/ ,/ 如果/ 输入/ 的/ 字符串/ str/ 之前/ 没有/ 被/ 质询/ 过/ ,/ 那么/ / 从/ / p/ 中/ 均匀/ 选取/ 一个/ 随机数/ 将/ 其/ 作为/ 对/ / 的/ 返回值/ 并/ 将/ 该值/ 及/ str/ 存放/ 到/ LH3/ 中/ ,/ 否则/ / 返回/ 之前/ 对/ 字符串/ str/ 在/ Page9LH3/ 中/ 对应/ 的/ 结果/ 以/ 确保/ 结果/ 的/ 一致性/ ./ Join/ -/ Corrupt/ 质询/ ./ / 提交/ 一个/ 签名者/ 的/ ID/ ,/ / 随机/ 选择/ i/ / ←/ {/ 1/ ,/ …/ ,/ qJC/ }/ 并分/ 两种/ 情况/ 对/ / 进行/ 响应/ ./ Case1/ ./ 当该/ 质询/ 为/ 第/ i/ 次/ 质询/ 且/ i/ ≠/ i/ / ,/ / 从/ LCre/ 列表/ 中/ 选取/ 一个/ 表项/ 并/ 将/ 表项/ 中/ 的/ UAA/ 证书/ Cre/ 作为/ 对/ / 的/ 返回值/ ,/ 并/ 将/ 该/ 表项/ 从/ LCre/ 删除/ ,/ 将/ (/ IDi/ ,/ fi/ ,/ Crei/ ,/ d/ =/ 0/ )/ 写入/ 列表/ LC/ 中/ ./ Cre/ / ·/ ·/ =/ u/ 并/ 将/ 其/ 作为/ 对/ / 的/ 响应/ ./ Case2/ ./ 当/ i/ =/ i/ / 时/ 标记/ 该/ ID/ 为/ ID/ / ,/ / 令/ Sign/ 质询/ ./ / 提交/ 一个/ 签名者/ 的/ ID/ 、/ 消息/ m/ 及/ 随机/ 值/ nV/ ,/ 并且/ 关于/ 该/ ID/ 的/ 签名者/ 已经/ 加入/ ,/ 同/ 上/ / 要分/ 以下/ 两种/ 情况/ 对/ / 进行/ 响应/ ./ Case1/ ./ 如果/ ID/ ≠/ ID/ / ,/ / 从/ 列表/ LC/ 中/ 获取/ 关于/ 该/ ID/ 对应/ 的/ 表项/ 并/ 运行/ Sign/ 协议/ ,/ 将/ 得到/ 的/ UAA/ 签名/ σ/ 作为/ 对/ / 的/ 响应/ 并/ 存储/ (/ ID/ ,/ m/ ,/ σ/ )/ 到/ LS/ 中/ ./ Case2/ ./ 如果/ ID/ =/ ID/ / ,/ / 则/ 按/ 以下/ 步骤/ 伪造/ 一个/ UAA/ 签名/ :/ ①/ / 选择/ 一个/ 随机数/ r/ ∈/ R/ / p/ ,/ 计算/ T1/ ·/ ·/ =/ vr/ =/ ua/ ·/ r/ ,/ T2/ ·/ ·/ =/ ur/ ,/ T3/ ·/ ·/ =/ vr/ ·/ u/ γ/ ·/ r/ =/ ur/ (/ a/ +/ γ/ )/ 并令/ V/ ·/ ·/ =/ T2/ ,/ W/ ·/ ·/ =/ T1/ ;/ ②/ / 选择/ nM/ →/ (/ 0/ ,/ 1/ )/ ln/ 以及/ c/ ,/ sf/ ∈/ R/ / p/ ,/ 计算/ U/ ·/ ·/ =/ Vsf/ ·/ W/ -/ c/ ;/ ③/ / 令/ str/ ·/ ·/ =/ H2/ (/ T1/ ‖/ T2/ ‖/ T3/ ‖/ nV/ )/ ‖/ U/ ‖/ bsnV/ ‖/ m/ ‖/ nM/ 并/ 通过/ 设置/ H3/ (/ str/ )/ =/ c/ 来/ 修订/ (/ patch/ )/ 随机/ 预言/ H3/ ,/ 如果/ 之前/ 对/ str/ 质询/ 过/ ,/ 那么/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ;/ 存储/ (/ ID/ / ,/ m/ ,/ σ/ )/ 到/ LS/ 中/ ./ ④/ / 输出/ 签名/ σ/ ·/ ·/ =/ (/ T1/ ,/ T2/ ,/ T3/ ,/ c/ ,/ sf/ ,/ nV/ ,/ nM/ )/ 并/ Corrupt/ 质询/ ./ 如果/ / 提交/ 的/ 签名者/ ID/ ≠/ ID/ / ,/ 那么/ / 将/ LC/ 表中/ 对/ 应该/ ID/ 的/ 私钥/ f/ 作为/ 返回值/ 并/ 置/ 表项/ b/ =/ 1/ ,/ 否则/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ./ Challenge/ ./ 在/ 挑战/ 阶段/ ,/ / 选择/ 两个/ 签名者/ 的/ 身份/ 标识/ (/ ID0/ ,/ ID1/ )/ 以及/ 消息/ m/ 、/ 随机/ 值/ nV/ 发送给/ / ./ 如果/ ID/ / / {/ ID0/ ,/ ID1/ }/ 且/ / 对/ ID0/ ,/ ID1/ 做过/ Corrupt/ 质询/ ,/ 那么/ 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ 否则/ / 选择/ / ∈/ {/ 0/ ,/ 1/ }/ 使/ ID/ / =/ ID/ / 并/ 执行/ 以下/ 步骤/ 生成/ 关于/ ID/ / 的/ 签名/ σ/ / :/ ①/ / 选择/ 一个/ 随机数/ r/ ∈/ R/ / p/ ,/ 计算/ T1/ ·/ ·/ =/ zr/ ,/ T2/ ·/ ·/ =/ wr/ ,/ T3/ ·/ ·/ =/ zr/ ·/ w/ γ/ ·/ r/ 并令/ V/ ·/ ·/ =/ T2/ ,/ W/ ·/ ·/ =/ T1/ ;/ ②/ 其余/ 的/ 伪造/ 步骤/ 同/ 上述/ Sign/ 质询/ 中/ Case2/ ;/ ③/ / 将/ 挑战/ 的/ 签名/ σ/ / 发送给/ / ./ 综上/ ,/ 可以/ 获得/ S/ 对于/ XDH/ 难题/ 的/ 判定/ 优势/ Output/ ./ 经过/ 定义/ 5/ 中/ 的/ 两个/ 阶段/ 质询/ 后/ ,/ / 最后/ 将/ 输出/ 关于/ 该/ 签名者/ ID/ 的/ 猜测/ 值/ / ,/ 如果/ / =/ / ,/ 那么/ / 输出/ 它/ 的/ 判定/ ψ/ =/ 1/ 即/ 判断/ 出/ z/ =/ uab/ ,/ 否则/ / 输出/ ψ/ =/ 0/ 表示/ z/ ∈/ RG1/ ./ 下面/ 对/ / 的/ 判定/ 优势/ 进行/ 评估/ ,/ 用/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ 表示/ ψ/ =/ 1/ 时/ z/ =/ uab/ ,/ ψ/ =/ 0/ 时/ z/ ∈/ RG1/ ./ 并用/ abort/ 代表/ S/ 退出/ 的/ 事件/ ,/ 即/ 有/ Pr/ [/ ψ/ =/ ψ/ |/ abort/ ]/ =/ 1/ // 2/ ./ 假设/ S/ 并/ 没有/ 退出/ ,/ 那么/ 若/ ψ/ =/ 0/ ,/ 表示/ z/ ∈/ RG1/ ,/ 则/ 该/ 挑战/ 签名/ σ/ / Pr/ [/ ψ/ =/ 0/ |/ / abort/ ∧/ ψ/ =/ 0/ ]/ =/ 1/ // 2/ ;/ 若/ ψ/ =/ 1/ ,/ 表示/ z/ =/ uab/ ,/ 则/ S/ 与/ A/ 对/ 上述/ 真实/ 游戏/ 进行/ 了/ 完美/ 的/ 模拟/ 并且/ A/ 最终/ 以/ 概率/ ε/ 正确/ 地/ 猜出/ 了/ / =/ / ,/ 因此/ 就/ 有/ Pr/ [/ ψ/ =/ 1/ |/ / abort/ ∧/ ψ/ =/ 1/ ]/ =/ 1/ // 2/ +/ ε/ ./ 概率/ ,/ 如下/ :/ |/ Pr/ [/ S/ (/ (/ u/ ,/ v/ =/ ua/ ,/ w/ =/ ub/ ,/ z/ )/ ∧/ (/ z/ =/ ua/ ·/ b/ )/ )/ =/ 0/ ]/ -/ Pr/ [/ S/ (/ (/ u/ ,/ v/ =/ ua/ ,/ w/ =/ ub/ ,/ z/ )/ ∧/ (/ z/ ∈/ RG1/ )/ )/ =/ 0/ ]/ |/ =/ |/ Pr/ [/ ψ/ =/ 0/ |/ ψ/ =/ 1/ ]/ -/ Pr/ [/ ψ/ =/ 0/ |/ ψ/ =/ 0/ ]/ |/ =/ |/ 1/ -/ Pr/ [/ ψ/ =/ 1/ |/ ψ/ =/ 1/ ]/ -/ Pr/ [/ ψ/ =/ 0/ |/ ψ/ =/ 0/ ]/ |/ =/ |/ 1/ -/ Pr/ [/ abort/ ]/ Pr/ [/ ψ/ =/ 1/ |/ abort/ ∧/ ψ/ =/ 1/ ]/ -/ Pr/ [/ / abort/ ]/ Pr/ [/ ψ/ =/ 1/ |/ / abort/ ∧/ ψ/ =/ 1/ ]/ -/ Pr/ [/ abort/ ]/ Pr/ [/ ψ/ =/ 0/ |/ abort/ ∧/ ψ/ =/ 0/ ]/ -/ Pr/ [/ / abort/ ]/ Pr/ [/ ψ/ =/ 0/ |/ / abort/ ∧/ ψ/ =/ 0/ ]/ |/ =/ |/ 1/ -/ Pr/ [/ abort/ ]/ (/ 1/ // 2/ +/ 1/ // 2/ )/ -/ Pr/ [/ / abort/ ]/ (/ (/ 1/ // 2/ +/ ε/ )/ +/ 1/ // 2/ )/ |/ =/ Pr/ [/ / abort/ ]/ ε/ ./ Pr/ [/ / abort/ ]/ 代表/ / 没有/ 退出/ 的/ 概率/ ,/ 首先/ / 在/ Sign/ 质询/ 中/ 在/ 伪造/ 签名/ 时/ 退出/ 的/ 概率/ 至多/ 为/ qH/ // p5/ ,/ 这是/ 一个/ 可以/ 忽略/ 的/ 值/ ;/ 其次/ 在/ Corrupt/ 质询/ 中/ ,/ / 没有/ 退出/ 的/ 概率/ 为/ 1/ // qJC/ ;/ 最后/ 在/ 挑战/ 阶段/ ,/ 仅当/ A/ 选择/ 了/ ID/ / ∈/ {/ ID0/ ,/ ID1/ }/ 时/ / 才/ 不会/ 退出/ ,/ 这个/ 概率/ 为/ 1/ // qJC/ ./ 计算/ 如下/ 概率/ Pr/ [/ / abort/ ]/ / (/ 1/ -/ qH/ // p5/ )/ ·/ (/ 1/ -/ 1/ // qJC/ )/ ·/ 1/ // qJC/ ,/ 因此/ / 判定/ XDH/ 难题/ 的/ 概率/ 至少/ 为/ ε/ ·/ (/ 1/ -/ qH/ // p5/ )/ ·/ (/ 1/ -/ 1/ // qJC/ )/ ·/ 1/ // qJC/ ./ Initial/ ./ 将/ LS/ 表项/ 关键字/ 设置/ 为/ (/ bsnV/ ,/ ID/ ,/ m/ ,/ σ/ )/ TMP/ -/ UAA/ 签名/ 满足用户/ 可控/ 不可/ 关联性/ ./ 引理/ 2/ ./ 当/ bsnV/ ≠/ ⊥/ 时/ ,/ 在/ XDH/ 假设/ 下/ 证明/ ./ 证明/ 的/ 思路/ 同/ 引理/ 1/ ,/ 给定/ 模拟器/ / 一个/ XDH/ 实例/ ,/ 即/ (/ u/ ,/ v/ =/ ua/ ,/ w/ =/ ub/ ,/ z/ )/ ,/ 其中/ u/ ∈/ G1/ ,/ a/ ,/ b/ ∈/ / p/ 以及/ z/ =/ uab/ 或者/ z/ ∈/ RG1/ ,/ / 为/ 判断/ 所/ 给定/ 的/ z/ 属于/ 哪/ 种/ 情况/ 与/ / 进行/ 如下/ 交互/ :/ Page10Join/ -/ Initial/ ./ 初始化/ 过程/ 与/ 引理/ 1/ 相同/ ./ Hash/ 质询/ ./ 令/ H1/ 、/ H3/ 为/ 随机/ 预言/ ,/ H3/ 质询/ 的/ 定义/ 同/ 引理/ 1/ ./ 对于/ H1/ 的/ 质询/ / 随机/ 选取/ 一次/ 质询/ 索引/ i/ / ←/ {/ 1/ ,/ …/ ,/ qH/ }/ 以及/ 取/ s/ ∈/ R/ / p/ ,/ 设置/ H1/ (/ str/ / )/ =/ ws/ ./ 其它/ 情况/ 下/ / 选取/ s/ ∈/ R/ / p/ ,/ 令/ H1/ (/ str/ )/ =/ us/ 作为/ 对/ / 的/ 应答/ ,/ 并/ 将/ r/ 、/ 字符串/ str/ 及/ 结果/ us/ 存放/ 到/ LH1/ 中/ ,/ 如果/ 质询/ 的/ 字符串/ str/ 之前/ 已经/ 询问/ ,/ / 直接/ 返回/ LH1/ 中/ 对应/ 的/ 结果/ ./ Join/ -/ Corrupt/ 质询/ ./ 在/ 该/ 质询/ 中/ / 提交/ 一个/ 签名者/ 的/ ID/ ,/ 如果/ 该/ 质询/ 为/ 第/ i/ / 次/ 质询/ ,/ / 标记/ 该/ ID/ 为/ ID/ / ,/ 由于/ / 不/ 知道/ f/ =/ a/ =/ logvu/ ,/ 随机/ 选择/ Cre/ / ∈/ RG1/ 作为/ 对/ / 质询/ 的/ 响应/ ./ 其它/ 情况/ ,/ 同/ 引理/ 1/ 中/ 的/ Case1/ ./ Sign/ 质询/ ./ / 提交/ 一个/ 签名者/ 的/ ID/ 、/ 基名/ bsnV/ 、/ 消息/ m/ 及/ 随机/ 值/ nV/ ,/ 并且/ 关于/ 该/ ID/ 的/ 签名者/ 已经/ 加入/ ,/ / 分/ 以下/ 两种/ 情况/ 对/ / 进行/ 响应/ ./ Case1/ ./ 如果/ ID/ ≠/ ID/ / ,/ / 从/ 列表/ LC/ 中/ 获取/ 关于/ 该/ ID/ 对应/ 的/ 表项/ 并/ 运行/ Sign/ 协议/ ,/ 将/ 得到/ 的/ UAA/ 签名/ σ/ 作为/ 对/ / 的/ 响应/ 并/ 存储/ (/ ID/ ,/ m/ ,/ σ/ ,/ bsnV/ )/ 到/ LS/ 中/ ./ Case2/ ./ 如果/ ID/ =/ ID/ / ,/ / 则/ 按/ 以下/ 步骤/ 伪造/ 一/ ①/ 如果/ bsnV/ =/ str/ / ,/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ 否则/ 从/ LH1/ 中/ 查找/ bsnV/ 所/ 对应/ 的/ 结果/ us/ 及/ s/ 值/ 并/ 计算/ K/ ·/ ·/ =/ vs/ ,/ 令/ B/ ·/ ·/ =/ us/ ;/ ②/ / 选择/ 一个/ 随机数/ r/ ,/ t/ ∈/ R/ / p/ 计算/ T1/ ·/ ·/ =/ (/ Cre/ / )/ t/ ·/ r/ ,/ T2/ ·/ ·/ =/ (/ Cre/ / )/ r/ ,/ T3/ ·/ ·/ =/ (/ Cre/ / )/ r/ (/ t/ +/ γ/ )/ 并/ 分别/ 令/ V/ ·/ ·/ =/ T2/ ·/ B/ ,/ W/ ·/ ·/ =/ T1/ ·/ K/ ;/ 个/ UAA/ 签名/ :/ 并/ 添加/ 一个/ Hash/ 列表/ LH1/ 存放/ H1/ 的/ 质询/ -/ 响应值/ ,/ 其它/ 初始化/ 过程/ 与/ 引理/ 1/ 一致/ ./ ③/ / 选择/ nM/ ←/ {/ 0/ ,/ 1/ }/ ln/ 以及/ c/ ,/ sf/ ∈/ R/ / p/ ,/ 计算/ U/ ·/ ·/ =/ Vsf/ ·/ W/ -/ c/ ;/ ④/ 令/ str/ ·/ ·/ =/ H2/ (/ T1/ ‖/ T2/ ‖/ T3/ ‖/ nV/ )/ ‖/ K/ ‖/ U/ ‖/ bsnV/ ‖/ m/ ‖/ nM/ ,/ / 通过/ 设置/ H3/ (/ str/ )/ =/ c/ 来/ 修订/ (/ patch/ )/ 随机/ 预言/ H3/ ,/ 若/ 之前/ 对/ str/ 质询/ 过/ ,/ 那么/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ;/ ⑤/ / 输出/ 签名/ σ/ ·/ ·/ =/ (/ T1/ ,/ T2/ ,/ T3/ ,/ K/ ,/ c/ ,/ sf/ ,/ nV/ ,/ nM/ )/ 并/ 存储/ (/ ID/ / ,/ m/ ,/ σ/ ,/ bsnV/ )/ 到/ LS/ 中/ ./ Corrupt/ 质询/ ./ 如果/ / 提交/ 的/ 签名者/ ID/ ≠/ ID/ / ,/ 那么/ / 将/ LC/ 表中/ 对/ 应该/ ID/ 的/ 私钥/ f/ 作为/ 返回值/ 并/ 置/ 表项/ b/ =/ 1/ ,/ 否则/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ./ Challenge/ ./ 在/ 挑战/ 阶段/ ,/ / 选择/ 两个/ 签名者/ 的/ 身份/ 标识/ (/ ID0/ ,/ ID1/ )/ 以及/ 消息/ m/ 、/ 基名/ bsnV/ 、/ 随机/ 值/ nV/ 发送给/ / ./ 如果/ ID/ / / {/ ID0/ ,/ ID1/ }/ 并且/ bsnV/ ≠/ str/ / ,/ 那么/ / 退出/ 并/ 输出/ ψ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ 否则/ / 选择/ / ∈/ {/ 0/ ,/ 1/ }/ 使得/ ID/ / =/ ID/ / 并/ 执行/ 以下/ 步骤/ 生成/ 关于/ ID/ / 的/ 签名/ σ/ / :/ ①/ / 从/ LH1/ 中/ 查找/ 关于/ str/ / 的/ 表项/ ,/ 并/ 计算/ K/ ·/ ·/ =/ zs/ ,/ 令/ B/ ·/ ·/ =/ ws/ ;/ ②/ 其余/ 的/ 伪造/ 步骤/ 同/ 上述/ Sign/ 质询/ 中/ Case2/ ;/ ③/ / 将/ 挑战/ 的/ 签名/ σ/ / 发送给/ / ./ Output/ ./ A/ 最后/ 将/ 输出/ 关于/ 该/ 签名者/ ID/ 的/ 猜测/ 值/ / ,/ 如果/ / =/ / ,/ 那么/ / 输出/ 它/ 的/ 判定/ ψ/ =/ 1/ 即/ 判断/ 出/ z/ =/ uab/ ,/ 否则/ / 输出/ ψ/ =/ 0/ 表示/ z/ ∈/ RG1/ ./ 同/ 引理/ 1/ ,/ / 的/ 判定/ 优势/ 为/ Pr/ [/ / abort/ ]/ ε/ ,/ 如果/ 游戏/ 可以/ 顺利进行/ ,/ 那么/ / 在/ 各个/ 阶段/ 和/ 质询/ 中/ 不会/ 退出/ ,/ 在/ Sign/ 质询/ 中/ 退出/ 的/ 概率/ 至多/ 为/ (/ qH/ // p6/ )/ ·/ 1/ // qH/ =/ 1/ // p6/ ,/ 在/ Corrupt/ 质询/ 中/ ,/ / 没有/ 退出/ 的/ 概率/ 为/ 1/ // qJC/ ,/ 在/ 挑战/ 阶段/ / 没有/ 退出/ 的/ 概率/ 为/ 1/ // (/ qJC/ ·/ qH/ )/ ,/ 因此/ / 解决/ XDH/ 难题/ 的/ 概率/ 至少/ 为/ ε/ ·/ (/ 1/ -/ 1/ // p6/ )/ ·/ (/ 1/ -/ 1/ // qJC/ )/ ·/ 1/ // (/ qJC/ ·/ qH/ )/ ./ 综上/ 两个/ 引理/ ,/ 在/ XDH/ 假设/ 下/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 具有/ 用户/ 可控/ 匿名性/ ./ (/ 3/ )/ 用户/ 可控/ 追踪/ 性/ 定理/ 3/ (/ 用户/ 可控/ 追踪/ 性/ )/ ./ TMP/ -/ UAA/ 方案/ 提供/ 了/ 用户/ 可控/ 追踪/ 性/ ,/ 如果/ 存在/ 一个/ 敌手/ / 以/ 不可/ 忽略/ 的/ 概率/ 破坏/ 了/ 用户/ 可控/ 追踪/ 性/ ,/ 那么/ 就/ 存在/ 一个/ 概率/ 多项式/ 时间/ 的/ 模拟器/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 解决/ l/ -/ MSDH/ 难题/ ./ 证明/ ./ 给定/ l/ -/ 1/ 个/ MSDH/ 实例/ (/ Afii/ ,/ Ai/ ,/ fi/ )/ ,/ i/ ←/ (/ 1/ ,/ …/ ,/ l/ -/ 1/ )/ 以及/ 发布者/ 的/ 公钥/ (/ g1/ ,/ g2/ ,/ Ω/ =/ g/ γ/ 2/ )/ ,/ / 通过/ 如下/ 与/ / 的/ 交互/ 生成/ 一个/ 新/ 的/ MSDH/ 实例/ ./ Initial/ ./ 通过/ 以上/ 给定/ 的/ 参数/ ,/ / 输出/ TMP/ -/ UAA/ 发布者/ 的/ 公钥/ (/ G1/ ,/ G2/ ,/ GT/ ,/ p/ ,/ e/ ,/ g1/ ,/ g2/ ,/ H0/ ,/ H1/ ,/ H2/ ,/ H3/ ,/ Ω/ )/ 给/ 敌手/ / ./ 表项/ 及/ 询问/ 次数/ 定义/ 同/ 定理/ 2/ 中/ 的/ 引理/ 1/ ./ Hash/ 质询/ ./ 令/ H3/ 为/ 随机/ 预言/ ,/ 如果/ 输入/ 的/ 字符串/ str/ 之前/ 没有/ 被/ 质询/ 过/ ,/ 那么/ / 从/ / p/ 中/ 均匀/ 选取/ 一个/ 随机数/ 将/ 其/ 作为/ 对/ / 的/ 返回值/ 并/ 将/ 该值/ 及/ str/ 存放/ 到/ LH3/ 中/ ,/ 否则/ / 返回/ 之前/ 对/ 字符串/ str/ 在/ LH3/ 中/ 对应/ 的/ 结果/ 以/ 确保/ 结果/ 的/ 一致性/ ./ Join/ -/ Initial/ ./ / 利用/ 给定/ 的/ MSDH/ 实例/ 来/ 模拟/ Join/ 协议/ 输出/ 的/ 结果/ ./ Join/ -/ Corrupt/ 质询/ ./ 对于/ 敌手/ / 提交/ 的/ 签名者/ ID/ ,/ / 选取/ i/ / ←/ {/ 1/ ,/ …/ ,/ qJC/ }/ 并分/ 两种/ 情况/ 给予/ Page11/ 为/ 应答/ ./ 的/ Ai/ 作为/ 应答/ ./ Case1/ ./ 当/ i/ =/ i/ / 时/ ,/ / 随机/ 选取/ Cre/ / ∈/ RG1/ 作/ Case2/ ./ 当/ i/ ≠/ i/ / 时/ ,/ / 选取/ 一个/ MSDH/ 实例/ 中/ / 将/ 以上/ 的/ 结果/ 保存/ 到/ LC/ 中/ ./ Sign/ 质询/ ./ / 提交/ 一个/ 签名者/ 的/ ID/ 、/ 基名/ bsnV/ 、/ 消息/ m/ 及/ 随机/ 值/ nV/ ,/ 并且/ 关于/ 该/ ID/ 的/ 签名者/ 已经/ 加入/ ,/ / 分/ 以下/ 两种/ 情况/ 对/ / 进行/ 响应/ ./ Case1/ ./ 当/ ID/ =/ ID/ / 时/ ,/ / 随机/ 选取/ r/ ,/ s/ ,/ sf/ ,/ 应答/ :/ c/ ∈/ R/ / p/ ,/ 并作/ 如下/ 计算/ :/ G1/ 以及/ K/ ·/ ·/ =/ Bs/ ;/ ①/ 若/ bsnV/ ≠/ ⊥/ / 则/ 分别/ 计算/ B/ ·/ ·/ =/ H1/ (/ bsnV/ )/ ∈/ ②/ / 计算/ T1/ ·/ ·/ =/ Cre/ / r/ ,/ T2/ ·/ ·/ =/ gr/ λ/ (/ Ω/ r/ )/ =/ Cre/ / r/ ·/ g/ γ/ ·/ r/ ③/ / 计算/ U/ ·/ ·/ =/ Vsf/ ·/ W/ -/ c/ ,/ 并/ 选择/ nM/ ←/ {/ 0/ ,/ 1/ }/ ln/ ,/ / 令/ str/ ·/ ·/ =/ H2/ (/ T1/ ‖/ T2/ ‖/ T3/ ‖/ nV/ )/ ‖/ K/ ‖/ U/ ‖/ bsnV/ ‖/ m/ ‖/ nM/ 并/ 通过/ 设置/ H3/ (/ str/ )/ =/ c/ 来/ 修订/ (/ patch/ )/ 随机/ 预言/ H3/ ,/ 如果/ 之前/ 对/ str/ 质询/ 过/ ,/ 那么/ / 退出/ ;/ ④/ / 输出/ 签名/ σ/ ·/ ·/ =/ (/ T1/ ,/ T2/ ,/ T3/ ,/ K/ ,/ c/ ,/ sf/ ,/ nV/ ,/ nM/ )/ 并/ 存储/ (/ ID/ / ,/ m/ ,/ σ/ ,/ bsnV/ )/ 到/ LS/ 中/ ./ Case2/ ./ 当/ ID/ ≠/ ID/ / 时/ ,/ / 运行/ Sign/ 协议/ ,/ 将/ 签名/ σ/ 作为/ 对/ / 的/ 应答/ ,/ 存储/ (/ ID/ / ,/ m/ ,/ σ/ ,/ bsnV/ )/ 到/ LS/ 中/ ./ Corrupt/ 质询/ ./ 如果/ / 提交/ 的/ 签名者/ ID/ ≠/ ID/ / ,/ 那么/ / 将/ LC/ 表中/ 对/ 应该/ ID/ 的/ 私钥/ f/ 作为/ 返回值/ ,/ 置/ 表项/ b/ =/ 1/ 并/ 将/ f/ 放入/ RL/ 中/ ,/ 否则/ / 退出/ ./ Output/ ./ 最后/ / 输出/ 一个/ 伪造/ 的/ 签名/ ,/ 包括/ 消息/ m/ ,/ 签名者/ ID/ 以及/ 签名/ σ/ ./ 对于/ / 有/ 两种/ 情况/ 需要/ 考虑/ :/ Case1/ ./ 如果/ σ/ 可以/ 验证/ 成功/ ,/ 即/ Verify/ (/ m/ ,/ bsnV/ ,/ σ/ ,/ IPK/ ,/ RL/ )/ →/ 1/ ./ 根据/ 分叉/ 引理/ [/ 23/ ]/ ,/ / 可以/ 利用/ 回绕/ (/ rewind/ )/ 技术/ 来/ 提取/ 关于/ 该/ ID/ 的/ 私钥/ f/ / ,/ 即以/ 相同/ 的/ (/ T1/ ,/ T2/ ,/ T3/ ,/ K/ )/ 并/ 控制/ Hash/ 函数/ H3/ 的/ 输出/ 结果/ ,/ 来/ 得到/ 不同/ 的/ c/ ,/ c/ 两个/ 值/ ,/ 对应/ 的/ / 会/ 响应/ sf/ ,/ sf/ 两个/ 值/ ,/ 就/ 有/ f/ / ·/ ·/ =/ (/ sf/ -/ sf/ )/ // (/ c/ -/ c/ )/ ,/ 对于/ f/ / 有/ 以下/ 两种/ 情况/ 要/ 考虑/ :/ e/ (/ g1/ ,/ g2/ )/ 成立/ ,/ 那么/ / 可以/ 获得/ 一个/ MSDH/ 实例/ ,/ 即/ 是/ (/ (/ Cre/ / )/ f/ / ,/ Cre/ / ,/ f/ / )/ ;/ e/ (/ g1/ ,/ g2/ )/ ,/ 那么/ / 将/ (/ T1/ ,/ T2/ ,/ f/ / )/ 作为/ 一个/ 盲化/ 的/ MSDH/ 实例/ ./ ②/ 当/ f/ / / {/ fi/ }/ i/ ←/ (/ 1/ ,/ …/ ,/ l/ -/ 1/ )/ ,/ 且/ e/ (/ Cre/ / ,/ gf/ / ①/ 当/ f/ / / {/ fi/ }/ i/ ←/ (/ 1/ ,/ …/ ,/ l/ -/ 1/ )/ ,/ 且/ e/ (/ Cre/ / ,/ gf/ / Case2/ ./ 若/ bsnV/ ≠/ ⊥/ ,/ / 以/ 同样/ 的/ 基名/ bsnV/ 输出/ 了/ 两个/ 关于/ 同一/ 签名者/ ID/ 的/ 签名/ σ/ 0/ ,/ σ/ 1/ 使得/ Link/ (/ σ/ 0/ ,/ σ/ 1/ ,/ IPK/ )/ |/ bsnV/ ≠/ ⊥/ =/ 0/ ./ 在/ 两个/ 签名/ 中基名/ 相同/ 必有/ B0/ =/ B1/ ,/ 因为/ 不可/ 关联/ 即/ K0/ ≠/ K1/ ,/ 这/ 意味着/ / 为/ 同一/ 签名者/ 产生/ 了/ 两个/ 不同/ 的/ 私钥/ 值/ ,/ 那么/ / 可以/ 利用/ Case1/ 中/ 的/ 方法/ 来/ 提取/ 私钥/ 值/ 产生/ 一个/ 新/ 的/ MSDH/ 实例/ ./ 以上/ 两种/ 情况/ ,/ 如果/ / 以/ 不可/ 忽略/ 的/ 概率/ 可以/ 赢得/ 用户/ 可控/ 追踪/ 性/ 游戏/ ,/ 那么/ / 均/ 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 来/ 解决/ MSDH/ 难题/ ./ 7.2/ 性能/ 分析/ 本节/ 将/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 与/ 现有/ 的/ DAA/ 方案/ [/ 4/ ,/ 9/ ,/ 13/ -/ 16/ ]/ 进行/ 比较/ ./ 在/ 本文/ 中/ 评估/ 的/ 指标/ 有/ 两种/ :/ 签名/ 长度/ 及/ 计算/ 代价/ ./ 在/ 进行/ 方案/ 性能/ 对比/ 之前/ ,/ 各/ 方案/ 的/ 安全级别/ 统一/ 定义/ 为/ 128bit/ 级别/ ./ 另外/ 需要/ 定义/ 安全/ 参数/ 长度/ 及/ 相关/ 算法/ 的/ 计算/ 代价/ ./ 安全/ 参数/ 定义/ :/ (/ 1/ )/ 双线性/ 配对/ 算法/ 安全/ 参数/ ,/ 本文/ 采用/ 了/ 高效/ 的/ BN/ 椭圆/ 曲线/ 算法/ [/ 24/ ]/ ,/ 那么/ 在/ 128bit/ 级别/ 下/ lp/ =/ 255bit/ ,/ 群/ G1/ 中/ 的/ 元素/ 大小/ 为/ 25bit/ ,/ 群/ GT/ 中/ 的/ 元素/ 大小/ 为/ 3072bit/ ,/ Hash/ 函数/ lH/ =/ 255bit/ ;/ (/ 2/ )/ RSA/ 算法/ 的/ 安全/ 参数/ ,/ 在/ 128bit/ 级别/ 下/ ln/ =/ 2048bit/ ,/ l/ ρ/ =/ 208bit/ ,/ 在/ 文献/ [/ 4/ ]/ 中/ 对应/ 的/ le/ =/ 368bit/ ,/ le/ =/ 120bit/ ,/ lv/ =/ 2536bit/ ,/ lH/ =/ 160bit/ ./ 1/ ,/ 2/ ,/ T/ )/ 分别/ 表示/ 在/ 群/ G1/ ,/ G2/ ,/ GT/ 中/ 的/ 单/ (/ m/ =/ 1/ )/ 或/ 多/ (/ m/ >/ 1/ )/ 指数/ 运算/ ,/ 使用/ BN/ 椭圆/ 曲线/ GT/ 计算/ 代价/ 是/ G1/ 约/ 14/ 倍/ ,/ G2/ 是/ G1/ 的/ 约/ 4/ 倍/ [/ 11/ ]/ ,/ 另外/ 用/ Pm/ 来/ 表示/ 单次/ 配对/ 或/ 多次/ 配对/ 幂/ 运算/ ,/ 很/ 明显/ 配对/ 运算/ 要/ 比/ 在/ 群中/ 的/ 运算/ 代价/ 要/ 大/ 很多/ [/ 24/ ]/ ;/ (/ 2/ )/ RSA/ 指数/ 算法/ ,/ 采用/ Gm/ 指数/ 运算/ 及/ 多/ 指数/ 运算/ ,/ 值得/ 说明/ 的/ 是/ GN/ 与/ GT/ 的/ 指数/ 计算/ 代价/ 几乎/ 相同/ [/ 11/ ]/ ,/ 另外/ 用/ n/ 来/ 表示/ 撤销/ 列表/ RL/ 中/ 表项/ 的/ 个数/ ./ 值得/ 说明/ 的/ 是/ ,/ 本文/ 并未/ 比较/ Join/ 协议/ 的/ 计算/ 代价/ ,/ 这/ 是因为/ Join/ 协议/ 的/ 执行/ 次数/ 要远/ 小于/ Sign/ 协议/ 执行/ 次数/ ,/ 且/ Join/ 协议/ 可以/ 在/ 移动/ 设备/ 出厂/ 前/ 完成/ ./ 通过/ 表/ 1/ 可以/ 直观/ 得出/ 本/ 方案/ 在/ 签名/ 、/ 验证/ 计算/ 效率/ 上要/ 高于/ 现有/ 已知/ DAA/ 方案/ ./ 对于/ MTM/ ,/ 当/ 关联性/ 不/ 需要/ 时/ (/ 即/ bsnV/ =/ ⊥/ )/ 只/ 需/ 执行/ 一次/ 指数/ 操作/ ,/ 当/ 需要/ 关联性/ 时/ (/ 即/ bsnV/ ≠/ ⊥/ )/ 仅/ 需/ 两次/ 指数/ 操作/ ,/ 对于/ 其它/ DAA/ 方案/ (/ 除了/ 文献/ [/ 14/ ]/ 的/ 方案/ )/ 至少/ 要/ 执行/ 三次/ 指数/ 操作/ ./ 对于/ 可信/ 引擎/ TE/ ,/ Sign/ 协议/ 只/ 需/ 执行/ 三次/ 指数/ 操作/ ,/ 这比/ 其它/ DAA/ 方案/ 计算/ 代价/ 定义/ :/ (/ 1/ )/ ECC/ 指数/ 算法/ ,/ 采用/ GmPage12/ 效率/ 都/ 要/ 高/ ,/ 且/ 在/ Verify/ 算法/ 计算/ 代价/ 比较/ 中/ ,/ 本/ 方案/ 要/ 优于/ 其它/ DAA/ 方案/ ./ 因此/ 在/ 计算/ 代价/ 方表/ 1/ 本文/ 方案/ 与/ 现有/ DAA/ 方案/ 在/ 128bit/ 安全级别/ 下/ 的/ 计算/ 代价/ 及/ 签名/ 长度/ 比较/ N/ +/ 1G4NBCC/ 方案/ [/ 4/ ]/ 3G/ ρ/ +/ 1G3BCL/ 方案/ [/ 9/ ]/ CPS/ 方案/ [/ 13/ ]/ Chen/ 方案/ [/ 16/ ]/ 2G1/ +/ 1GTBL/ 方案/ [/ 15/ ]/ Chen/ 方案/ [/ 14/ ]/ 1G1/ // 2G1/ 本/ 方案/ 对于/ 签名/ 长度/ ,/ 从表/ 1/ 可以/ 看出/ ,/ 本/ 方案/ 的/ 签名/ 长度/ 是/ 最小/ 的/ ,/ 当/ 签名/ 不/ 需要/ 关联性/ 时仅/ 为/ 1278bit/ ,/ 当/ 需要/ 关联/ 时为/ 1534bit/ ./ 因此/ 在/ 签名/ 长度/ 方面/ ,/ 较/ 其它/ DAA/ 方案/ 本文/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 会/ 使/ 移动/ 设备/ 的/ 通信/ 代价/ 更/ 小/ ,/ 仅/ 为/ 原/ DAA/ 方案/ [/ 4/ ]/ 的/ 6.2/ %/ // 7.5/ %/ (/ 不/ 需要/ 关联/ // 需要/ 关联/ )/ ./ 8/ 移动/ 环境/ 下/ 跨/ 信任/ 域/ 的/ 匿名/ 证明/ 传统/ 的/ DAA/ 方案/ 只/ 适用/ 于单/ 信任/ 域/ 的/ 情况/ ,/ 这是/ 由于/ DAA/ 证书/ 发布者/ 通常/ 是/ 移动/ 可信/ 模块/ MTM/ 或/ 移动/ 设备/ 的/ 生产厂家/ ,/ 这样/ 就/ 形成/ 了/ 以/ 各个/ 发布者/ 为/ 单位/ 相互/ 独立/ 的/ 信任/ 域/ ,/ 在/ 单独/ 的/ 信任/ 域/ 中/ ,/ 签名者/ 可以/ 向域/ 内/ 验证/ 者/ 进行/ 无需/ 可信/ 第三方/ 参与/ 的/ 直接证明/ (/ directproof/ )/ ./ 然而/ 由于/ 不同/ 信任/ 域/ 内/ 的/ DAA/ 方案/ 参与者/ 只/ 信任/ 各自/ 域/ 内/ 的/ 发布者/ ,/ 因此/ 会/ 产生/ 跨域/ 可信/ 问题/ ,/ 例如/ 在/ 信任/ 域/ A/ 内/ 的/ 验证/ 者/ 无法/ 确信/ 信任/ 域/ B/ 内/ 的/ 可信/ 移动/ 平台/ 所/ 产生/ 的/ 直接证明/ 是/ 有效/ 的/ ./ 从/ 另外/ 的/ 角度看/ ,/ 由于/ DAA/ 属于/ 特殊/ 的/ 群/ 签名/ 方案/ ,/ 以/ 更/ 高/ 的/ 层面/ 可以/ 将域/ A/ 和域/ B/ 看作/ 是/ 两个/ 实体/ A/ 和/ B/ ,/ 以上/ 的/ 问题/ 可以/ 转化/ 为/ :/ 对于/ 验证/ 者/ A/ ,/ 签名者/ B/ 产生/ 的/ 签名/ 是/ 不可/ 信/ 的/ ,/ 造成/ 这个/ 问题/ 的/ 直接/ 原因/ 就/ 可以/ 归结为/ A/ 怀疑/ B/ 提供/ 公钥/ 的/ 合法性/ ./ 那么/ 利用/ 本文/ 提出/ 的/ TMP/ -/ UAA/ 模型/ 可以/ 很/ 好/ 解决/ 这个/ 问题/ ./ 由于/ 发布者/ 的/ 公钥/ 受/ 可信/ 第三方/ CA/ 认证/ ,/ 保证/ 了/ 发布者/ 公钥/ 的/ 合法性/ ,/ 因此/ 任意/ 域/ 内/ 的/ 验证/ 者/ 都/ 可以/ 通过/ CA/ 校验/ 与/ 签名/ 相关/ 的/ 公钥/ 的/ 合法性/ ,/ 即可/ 对/ 实体/ A/ 或/ 实体/ B/ 生成/ 的/ UAA/ 签名/ 进行/ 验证/ ,/ 如图/ 2/ 所示/ ./ 另外/ 一个/ 值得/ 考虑/ 的/ 问题/ 是/ 多/ 信任/ 域/ 中/ RL/ 列表/ 的/ 获取/ ,/ 即/ 验证/ 者/ 如何/ 获取/ 相应/ 域/ 中/ 的/ RL/ 列表/ ./ 由于/ TPM/ -/ UAA/ 模型/ 借鉴/ 了/ PKI/ 的/ 架构/ 思想/ ,/ 因面/ ,/ 本文/ 提出/ 的/ TMP/ -/ UAA/ 方案/ 更加/ 适用/ 于/ 移动/ 设备/ ./ 此该/ 问题/ 可以/ 采用/ 类似/ CRL/ 列表/ 的/ 管理/ 方式/ 来/ 解决/ :/ 一种/ 方式/ 是/ 集中式/ 管理/ ,/ 各个/ 域/ 的/ 发布者/ 将/ 各自/ 的/ RL/ 列表/ 提交/ 给/ CA/ 统一/ 管理/ 并/ 定期/ 对/ 提交/ 的/ RL/ 列表/ 进行/ 更新/ ,/ 验证/ 者/ 可以/ 通过/ CA/ 下载/ 对应/ 发布者/ 公钥/ 的/ RL/ 列表/ ;/ 另/ 一种/ 方式/ 是/ 分布式/ 管理/ ,/ 每个/ 域/ 的/ 发布者/ 维护/ 各自/ 域/ 的/ RL/ 列表/ ,/ 当/ 验证/ 者/ 验证/ UAA/ 签名/ 时/ ,/ 可/ 通过/ 发布者/ 公钥/ 证书/ 中/ 的/ RL/ 列表/ 所在/ 的/ 发布/ 点/ 下载/ 列表/ ,/ 例如/ X509/ ./ V3/ 证书/ 提供/ 了/ 这样/ 的/ 功能/ ./ 9/ 结论/ 高性能/ 及/ 可/ 部署/ 性是/ 匿名/ 证明/ 方案/ 在/ 移动/ 环境/ 下/ 的/ 两个/ 重要/ 需求/ ./ 本文/ 针对/ 可信/ 移动/ 平台/ 的/ 特点/ 并/ 以/ 实用性/ 为/ 动机/ 提出/ 了/ 一种/ 新型/ 的/ 匿名/ 证明/ 方案/ ,/ 该/ 方案/ 在/ 保证/ 原有/ DAA/ 安全性/ 及/ 功能性/ 的/ 基础/ 上/ 提供/ 了/ 更/ 高/ 的/ 执行/ 性能/ ,/ 而且/ TMP/ -/ UAA/ 方案/ 的/ 构建/ 方法/ 为/ 移动/ 可信/ 模块/ MTM/ 及/ 可信/ 移动/ 平台/ TMP/ 匿名/ 证明/ 方案/ 的/ 构建/ 提供/ 了/ 新思路/ ;/ 另一方面/ 本文/ 设计/ 的/ TMP/ -/ UAA/ 模型/ 能够/ 有效/ 解决目前/ DAA/ 模型/ 设计/ 中/ 存在/ 的/ R/ 攻击/ 及/ 跨/ 信任/ 域/ 问题/ ,/ 更/ 适于/ 在/ 移动/ 平台/ 上/ 部署/ 实现/ ./ Page13/ 

