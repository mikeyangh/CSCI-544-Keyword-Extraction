Page1/ 物/ 联网/ 安全/ 传输/ 模型/ 吴振强/ 1/ )/ 周彦伟/ 2/ )/ 马建峰/ 3/ )/ 1/ )/ (/ 陕西/ 师范大学/ 计算机科学/ 学院/ 西安/ 710062/ )/ 2/ )/ (/ 陕西/ 师范大学/ 教师/ 专业/ 能力/ 发展/ 中心/ 西安/ 710062/ )/ 3/ )/ (/ 西安电子科技大学/ 计算机网络/ 与/ 信息安全/ 教育部/ 重点/ 实验室/ 西安/ 710071/ )/ 摘要/ 物/ 联网/ 的/ 安全/ 与/ 隐私/ 对/ 参与方/ 有着/ 较大/ 的/ 影响/ ,/ 需要/ 建立/ 相应/ 的/ 安全/ 框架/ 实现/ 数据/ 保密/ 、/ 访问控制/ 、/ 客户端/ 隐私/ 保护/ 等/ 功能/ 以/ 抵抗/ 复杂/ 攻击/ ./ 论文/ 利用/ 可信计算/ 技术/ 和/ 双线性/ 对/ 的/ 签密/ 方法/ 提出/ 了/ 一个/ 物/ 联网/ 安全/ 传输/ 模型/ ,/ 满足/ 了/ 物/ 联网/ 的/ ONS/ 查询/ 及/ 物品/ 信息/ 传输/ 两个/ 环节/ 的/ 安全/ 需求/ ./ 模型/ 包括/ 了/ EPC/ 物/ 联网/ 中/ ONS/ 查询/ 服务/ 的/ 安全/ 体系/ 及/ 相应/ 的/ 安全/ 协议/ ,/ ONS/ 根/ 服务/ 机构/ 利用/ 可信/ 认证/ 服务器/ 对/ 申请/ 查询/ 的/ 本地/ ONS/ 服务器/ (/ L/ -/ ONS/ )/ 的/ 合法/ 身份/ 及/ 平台/ 可信性/ 进行/ 验证/ ,/ 对/ 通过/ 验证/ 的/ L/ -/ ONS/ 签发/ 临时/ 证书/ ,/ 在/ 证书/ 有效/ 时间/ 内/ L/ -/ ONS/ 可持/ 证书/ 多次/ 申请/ 查询/ 服务/ ./ 安全/ ONS/ 查询/ 服务/ 实现/ 了/ 匿名/ 认证/ 功能/ ,/ 仅/ 对/ 授权/ 且/ 可信/ 的/ L/ -/ ONS/ 提供/ 查询/ 服务/ ,/ 阻止/ 了/ 非法/ ONS/ 查询/ 物品/ 信息/ ;/ 在/ 传输/ 过程/ 中/ ,/ 远程/ 物品/ 信息/ 服务器/ 按/ 响应/ 路径/ 中/ 各/ 节点/ 的/ 顺序/ 从后/ 至/ 前用/ 公钥/ 对/ 物品/ 信息/ 嵌套/ 加密/ ./ 加密/ 后/ 的/ 数据/ 每/ 经过/ 一个/ 路由/ 节点/ 被/ 解密/ 一层/ ,/ 直到/ 本地/ 信息/ 服务器时/ 物品/ 信息/ 才/ 被/ 还原成/ 明文/ ,/ 传输/ 过程/ 中/ 每个/ 路由/ 节点/ 可以/ 验证/ 收到/ 数据/ 的/ 完整性/ 及/ 转发/ 路径/ 的/ 真实性/ ./ 分析表明/ ,/ 新/ 的/ 传输/ 模型/ 具有/ 安全性/ 、/ 匿名性/ 、/ 可信性/ 和/ 抗/ 攻击性/ 等/ 特点/ ./ 关键词/ 物/ 联网/ ;/ ONS/ 查询/ ;/ 可信计算/ ;/ 匿名/ 认证/ ;/ 匿名/ 传输/ 1/ 引言/ 物/ 联网/ (/ InternetofThings/ ,/ IoT/ )/ 将/ 感应器/ 嵌入/ 或/ 装备/ 到/ 电网/ 、/ 铁路/ 、/ 桥梁/ 、/ 隧道/ 、/ 公路/ 、/ 建筑/ 、/ 供水系统/ 、/ 大坝/ 、/ 油气/ 管道/ 等/ 物体/ 中/ ,/ 实现/ 物体/ 与/ 现有/ 互联网/ 的/ 融合/ ,/ 实现/ 人类/ 社会/ 、/ 信息/ 空间/ 、/ 物理/ 系统/ 的/ 有机/ 整合/ ./ 在/ 这个/ 整合/ 的/ 网络/ 中/ ,/ 存在/ 能力/ 超强/ 的/ 中心/ 计算机/ 群/ ,/ 用于/ 对/ 网络/ 内/ 的/ 人员/ 、/ 机器/ 、/ 设备/ 和/ 基础设施/ 实施/ 实时/ 的/ 管理/ 与/ 控制/ [/ 1/ ]/ ./ 传统/ EPC/ (/ ElectronicProductCode/ )/ 物/ 联网/ 中/ ,/ 每/ 一个/ 物品/ 都/ 被/ 赋予/ 一个/ 独一无二/ 的/ 代码/ ,/ 将/ 这个/ 代码/ 存储/ 在/ 电子标签/ 中/ 并/ 贴/ 在/ 物品/ 上/ ,/ 同时/ 将/ 这个/ 代码/ 所/ 对应/ 的/ 详细信息/ 和/ 属性/ 存储/ 在/ 物品/ 信息/ 服务/ 系统/ 的/ 服务器/ 中/ ./ 流通/ 环节/ 中/ 利用/ RFID/ 阅读器/ 读取/ 标签/ 代码/ ,/ 通过/ 对象/ 名/ 解析/ 服务/ (/ ObjectNamingService/ ,/ ONS/ )/ 系统/ 解析/ 后/ ,/ 本地/ ONS/ (/ LocalObjectNamingService/ ,/ L/ -/ ONS/ )/ 服务器/ 可/ 获得/ 物品/ 所属/ 信息/ 服务/ 系统/ 的/ 统一/ 资源/ 标识/ ,/ 然后/ L/ -/ ONS/ 将/ 该/ 标识/ 转发/ 到/ 本地/ 物品/ 信息/ 服务器/ (/ LocalInformationServerofThings/ ,/ L/ -/ TIS/ )/ ,/ 进而/ L/ -/ TIS/ 通过/ 网络/ 与/ 远程/ 物品/ 信息/ 服务器/ (/ RemoteInformationServerofThings/ ,/ R/ -/ TIS/ )/ 间/ 的/ 消息/ 交换/ 获得/ 非/ 本地/ 代码/ 所/ 对应/ 的/ 详细/ 物品/ 信息/ 及/ 属性/ ,/ 实现/ 物品/ 的/ 识别/ 、/ 自动/ 追踪/ 和/ 管理/ 功能/ [/ 2/ ]/ ./ 然而/ 传统/ 物/ 联网/ 在/ 用户/ 隐私/ 保护/ 和/ 信息安全/ 传输/ 机制/ 中/ 存在/ 诸多/ 不足/ [/ 3/ -/ 5/ ]/ :/ (/ 1/ )/ 标签/ 被/ 嵌入/ 任何/ 物品/ ,/ 用户/ 在/ 没有/ 察觉/ 的/ 情况/ 下/ 其/ 标签/ 被/ 阅读器/ 扫描/ ,/ 通过/ 对/ 物品/ 的/ 定位/ 可追踪/ 用户/ 的/ 行踪/ ,/ 使/ 个人隐私/ 遭到/ 破坏/ ;/ (/ 2/ )/ 射频/ 识别系统/ 读取/ 速度/ 快/ ,/ 通过/ 对/ 物品/ 的/ 迅速/ 扫描/ 方式/ 跟踪/ 企业/ 销售/ 情况/ 的/ 变化/ 特点/ ,/ 使/ 企业/ 的/ 商业秘密/ 遭到/ 泄露/ ;/ (/ 3/ )/ 物品/ 的/ 详细信息/ 在/ L/ -/ TIS/ 与/ R/ -/ TIS/ 间/ 的/ 传输/ 过程/ 易受/ 流量/ 分析/ 、/ 窃听/ 、/ 嗅探/ 等/ 网络攻击/ ,/ 导致/ 物品/ 信息/ 传输/ 过程/ 存在/ 安全隐患/ ./ 针对/ 物/ 联网/ 安全性/ 问题/ ,/ 文献/ [/ 5/ ]/ 指出/ 应该/ 从/ 容忍/ 攻击/ 方面/ 进行/ 研究/ ,/ 以/ 应对/ 单点故障/ 、/ 数据/ 认证/ 、/ 访问控制/ 和/ 客户端/ 的/ 隐私/ 保护/ 等/ 问题/ ;/ 建议/ 对/ 企业/ 进行/ 必要/ 的/ 风险/ 评估/ 与/ 风险管理/ ./ 文献/ [/ 6/ ]/ 提出/ 在/ 考虑/ 物/ 联网/ 的/ 各种/ 安全/ 因素/ 时/ ,/ 隐私/ 保护/ 强度/ 和/ 特定/ 业务/ 需求/ 之间/ 是/ 有/ 折衷/ ,/ 即/ 在/ 满足/ 业务/ 需求/ (/ 实用性/ 、/ 易用性/ )/ 基础/ 上/ 尽可能/ 地/ 保护/ 用户/ 隐私/ 、/ 定制/ 适度/ 的/ 隐私/ 保护/ 策略/ (/ 实现/ 匿名性/ 和/ 用户/ 行为/ 的/ 不可/ 追踪/ )/ ;/ 并/ 指出/ 物/ 联网/ 的/ 安全/ 机制/ 应该/ 从/ 认证/ 、/ 访问控制/ 、/ 数据/ 加密/ 和/ 立法/ 等/ 方面/ 加强/ 保护/ ./ 文献/ [/ 7/ ]/ 提出/ 物/ 联网/ 安全/ 研究/ 应/ 主要/ 集中/ 在/ 物/ 联网/ 安全/ 体系/ 、/ 个体/ 隐私/ 保护模式/ 、/ 终端/ 安全/ 功能/ 、/ 物/ 联网/ 安全/ 相关/ 法律/ 的/ 制订/ 等/ 方面/ ,/ 并/ 给出/ 了/ 一个/ 物/ 联网/ 的/ 安全/ 层次/ 架构/ ,/ 该/ 架构/ 根据/ 物/ 联网/ 的/ 感知/ 层/ 、/ 网络层/ 和/ 应用/ // 中间件/ 层/ 将/ 安全/ 架构/ 分为/ 感知/ 层/ 安全/ 、/ 网络层/ 安全/ 和/ 应用层/ 安全/ ./ 目前/ 的/ 物/ 联网/ 安全/ 方案/ 更多地/ 是从/ 宏观/ 上/ 进行/ 框架/ 性/ 讨论/ ,/ 涉及/ 到物/ 联网/ 相关/ 的/ 感知/ 、/ 信息/ 传输/ 与/ 信息处理/ 三个/ 阶段/ ./ 在/ 感知/ 阶段/ :/ 文献/ [/ 8/ ]/ 在/ 分析/ RFID/ 协议/ 的/ 安全/ 需求/ 基础/ 上/ ,/ 基于/ 通用/ 可/ 组合/ 安全/ 模型/ ,/ 设计/ 了/ 低成本/ 的/ RFID/ 匿名/ 认证/ 协议/ ,/ 在/ 确定/ 的/ 安全/ 目标/ 下/ 证明/ 了/ 该/ 协议/ 的/ 安全性/ ;/ 文献/ [/ 9/ ]/ 分析/ 了/ 基于/ 密码/ 技术/ RFID/ 安全/ 协议/ 的/ 不足/ ,/ 用/ 可/ 证明/ 安全性/ 理论/ 对/ RFID/ 安全/ 协议/ 模型/ 进行/ 安全性/ 研究/ ;/ 文献/ [/ 10/ ]/ 给出/ 了/ RFID/ 系统/ 中/ 改进/ 的/ 防/ 冲突/ 算法/ ,/ 当/ 大量/ 标签/ 同时/ 识别/ 时/ ,/ 该/ 算法/ 根据/ 上/ 一轮/ 的/ 碰撞/ 情况/ 估计/ 待/ 识别/ 的/ 标签/ 数/ ,/ 然后/ 对/ 其/ 进行/ 分类/ 或/ 改变/ 帧/ 的/ 大小/ 以/ 降低/ 标签/ 发生/ 碰撞/ 的/ 概率/ ,/ 从而/ 提高/ 识别/ 效率/ ./ 文献/ [/ 11/ ]/ 在/ 欧盟/ 提案/ 的/ 基础/ 上/ ,/ 制订/ 了/ 信息/ 感知/ 阶段/ 的/ 隐私/ 及/ 数据保护/ 的/ 评估/ 框架/ ./ 在/ 信息处理/ 阶段/ :/ 文献/ [/ 12/ ]/ 基于/ RFID/ 和物/ 联网/ 技术/ 提出/ 了/ 全球/ 物/ 联网/ 体系/ 架构/ ,/ 并/ 结合/ 该/ 架构/ 给出/ 了/ 物/ 联网/ 信息/ 服务/ 系统/ 的/ 设计方案/ ,/ 为/ 实现/ 物/ Page3/ 联网/ 架构/ 、/ 信息/ 服务/ 系统/ 和物/ 联网/ 管理/ 协议/ 提供/ 了/ 参考/ ;/ 文献/ [/ 13/ -/ 14/ ]/ 系统地/ 介绍/ 了/ 物/ 联网/ 编码/ 、/ 编码/ 转换/ 、/ 名称/ 解析/ 服务/ 、/ 信息/ 发布/ 系统/ 、/ 中间件/ 及/ 网络管理/ 等物/ 联网/ 关键技术/ ,/ 通过/ 大量/ 实例/ 分析/ 了/ 物/ 联网/ 的/ 国内外/ 发展/ 现状/ ,/ 并/ 在/ 此基础/ 上/ 给出/ 了/ 部分/ 设计方案/ ,/ 对物/ 联网/ 的/ 研究/ 起到/ 了/ 指导作用/ ./ 纵观/ 国内外/ 在/ 物/ 联网/ 基础/ 技术/ 方面/ 的/ 相关/ 研究/ ,/ 文献/ [/ 3/ -/ 7/ ]/ 只/ 分析/ 了/ 物/ 联网/ 传输/ 机制/ 中/ 所/ 存在/ 的/ 不足/ ,/ 并未/ 给出/ 相应/ 的/ 解决方案/ ./ 因此/ 有/ 必要/ 进行/ 物/ 联网/ 安全/ 传输/ 机制/ 研究/ ,/ 尤其/ 是/ 增强/ 传输/ 过程/ 中/ 安全/ 协议/ 与/ 隐私/ 保护/ 方法/ 的/ 研究/ ,/ 以/ 提高/ 物/ 联网/ 的/ 安全性/ ./ 物/ 联网/ 在/ 信息/ 传输/ 过程/ 中易/ 出现/ 隐私/ 泄露/ ,/ 其/ 主要/ 原因/ 有/ :/ (/ 1/ )/ 阅读器/ 与/ 标签/ 之间/ 的/ 任意/ 读取/ ,/ 即/ 阅读器/ 无条件/ 读取/ 物品/ 标签/ 编码/ 给/ 用户/ 隐私/ 保护/ 带来/ 隐患/ ;/ (/ 2/ )/ ONS/ 查询/ 系统/ 为/ L/ -/ ONS/ 提供/ 无条件/ 查询/ 功能/ ,/ 即/ 任何/ L/ -/ ONS/ 均/ 可/ 申请/ 查询/ 物品/ 的/ 详细信息/ ;/ (/ 3/ )/ 物品/ 信息/ 由/ R/ -/ TIS/ 以/ 明文/ 形式/ 传送/ 给/ L/ -/ TIS/ ./ 本文/ 在/ 分析/ EPC/ 物/ 联网/ 传输/ 机制/ 的/ 安全性/ 基础/ 上/ ,/ 为/ 解决/ 物/ 联网/ 信息/ 传输/ 过程/ 中/ 隐私/ 保护/ 方面/ 所/ 存在/ 的/ 不足/ ,/ 综合/ 可信计算/ 技术/ 与/ 双线性/ 对/ 的/ 签物/ 联网/ 安全/ 传输/ 模型/ 由/ 可信/ 匿名/ 认证/ 的/ ONS/ 查询/ 机制/ 和/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 组成/ ,/ 其中/ 图/ 1/ 物/ 联网/ 安全/ 传输/ 模型/ 密/ 方法/ 提出/ 了/ 一个/ 物/ 联网/ 安全/ 传输/ 模型/ ./ 本文/ 创新性/ 的/ 工作/ 是/ 给出/ 了/ 物/ 联网/ 安全/ 传输/ 模型/ 的/ 框架/ ,/ 并/ 对/ 安全/ 传输/ 框架/ 下/ 涉及/ 的/ ONS/ 安全/ 查询/ 过程/ 、/ 物品/ 信息安全/ 传输/ 过程/ 进行/ 了/ 协议/ 设计/ 与/ 实现/ ./ 本文/ 第/ 2/ 节/ 详细/ 介绍/ 物/ 联网/ 安全/ 传输/ 模型/ ,/ 对/ 可信/ 匿名/ 认证/ 的/ ONS/ 查询/ 机制/ 和/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 分别/ 进行/ 研究/ ;/ 第/ 3/ 节对物/ 联网/ 安全/ 传输/ 模型/ 的/ 匿名性/ 、/ 可信性/ 和/ 安全性/ 等/ 方面/ 进行/ 分析/ ;/ 第/ 4/ 节/ 给出/ 了/ 基于/ 本/ 模型/ 的/ 安全/ 物/ 联网/ 系统/ 架构/ ;/ 最后/ 总结/ 展望/ 了/ 本文/ 工作/ ./ 2/ 物/ 联网/ 安全/ 传输/ 模型/ 本文/ 提出/ 的/ 物/ 联网/ 安全/ 传输/ 模型/ 是/ 通过/ 引入/ 可信/ 第三方/ —/ —/ —/ 可信/ 认证/ 服务器/ (/ TrustedAuthen/ -/ ticationServer/ ,/ TAS/ )/ 对/ 原有/ 模型/ 进行/ 改进/ :/ 在/ ONS/ 查询/ 机制/ 中/ 增加/ 可信/ 匿名/ 认证/ 过程/ 对/ L/ -/ ONS/ 的/ 身份/ 合法性/ 及/ 平台/ 可信性/ 进行/ 认证/ ;/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 确保/ 物品/ 信息/ 的/ 安全/ 传输/ ,/ 保证/ 了/ 物/ 联网/ 中/ 物品/ 信息/ 的/ 安全性/ 与/ 可信性/ ./ 物/ 联网/ 安全/ 传输/ 模型/ 如图/ 1/ 所示/ ./ TAS/ 在/ 注册/ 阶段/ 为/ L/ -/ ONS/ 生成/ 查询/ 系统/ 的/ 用户名/ ,/ 同时/ 为/ 其/ 生成/ 临时/ 身份/ 信息/ ,/ 完成/ 对/ L/ -/ ONS/ 的/ Page4/ 身份/ 合法性/ 及/ 平台/ 可信性/ 认证/ ;/ 在/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 中/ R/ -/ TIS/ 按/ 响应/ 链路/ 中/ 各/ 节点/ 顺序/ 从后/ 至/ 前用/ 相邻/ 节点/ 的/ 会/ 话/ 密钥/ 对/ 查询/ 信息/ 层层/ 嵌套/ 加密/ ,/ 传输/ 过程/ 中/ ,/ 响应/ 数据/ 每/ 经过/ 一个/ 节点/ 被/ 解密/ 一层/ ,/ 直到/ L/ -/ TIS/ 时/ 数据/ 才/ 被/ 完全/ 解密/ ,/ 且/ 中间/ 节点/ 可/ 根据/ 前驱/ 节点/ 的/ 签密/ 信息/ 验证/ 转发/ 数据/ 的/ 完整性/ ,/ 根据/ 路由/ 信息/ 鉴别/ 转发/ 路径/ 的/ 真实性/ ./ 2.1/ 系统/ 建立/ 设/ G1/ 和/ G2/ 是/ 阶为/ 素数/ q/ 的/ 群/ ,/ G1/ 为/ 加法/ 群/ ,/ G2/ 为/ 乘法/ 群/ ,/ p/ 为/ G1/ 的/ 生成元/ ,/ 设群/ G1/ 和/ G2/ 中/ 离散/ 对数/ 问题/ 是/ 困难/ 的/ ,/ 双线性/ 对/ 是/ 满足/ 下列/ 性质/ 的/ 映射/ e/ :/ G1/ ×/ G1/ →/ G2/ ./ TAS/ 选择/ 满足/ 双线性/ 对/ 要求/ 的/ 参数/ G1/ 、/ G2/ 、/ e/ 、/ q/ 、/ p/ ,/ 其中/ q/ 、/ p/ 为/ G1/ 的/ 生成元/ ./ E/ (/ k/ ,/ m/ )/ 和/ D/ (/ k/ ,/ c/ )/ 是/ 一对/ 单/ 密钥/ 加密/ // 解密/ 算法/ ;/ P/ 是/ 大/ 素数/ ;/ Q/ 是/ P/ -/ 1/ 的/ 大/ 素数/ 因子/ ;/ g/ 是从/ [/ 1/ ,/ …/ ,/ P/ -/ 1/ ]/ 随机/ 选取/ 的/ 模/ P/ 的/ Q/ 阶/ 随机/ 整数/ ;/ H/ (/ k/ ,/ m/ )/ 是/ 带/ 密钥/ 的/ 杂凑/ 函数/ ;/ H/ (/ m/ )/ 为/ 标准/ 散列/ 算法/ SHA/ -/ 1/ ,/ ∈/ C/ 表示/ 随机/ 均匀/ 选取/ 集合/ 中/ 的/ 元素/ ,/ / 为/ 异或/ 运算/ ,/ ‖/ 为/ 连接符/ ./ TAS/ 公开/ 参数/ 〈/ G1/ ,/ G2/ ,/ e/ ,/ q/ ,/ p/ ,/ H/ ,/ P/ ,/ Q/ ,/ g/ 〉/ 及/ 加密/ // 解密/ 函数/ E/ 和/ D/ ./ 假设/ 1/ ./ 根/ ONS/ 服务器/ (/ RootObjectNamingService/ ,/ Root/ -/ ONS/ )/ 与/ TAS/ 都/ 具有/ 物/ 联网/ 管理中心/ CA/ -/ IoT/ 签署/ 的/ 公钥/ 证书/ ./ 如/ 实体/ A/ 的/ 证书/ 格式/ 图/ 2/ 可信/ 匿名/ 认证/ 的/ ONS/ 查询/ 机制/ 2.2/ ./ 1L/ -/ ONS/ 注册/ 查询/ 服务/ 合法性/ 及/ 平台/ 可信性/ 认证/ ./ L/ -/ ONS/ 向/ TAS/ 申请/ 注册/ 查询/ 服务/ ,/ 完成/ 身份/ (/ 1/ )/ L/ -/ ONS/ 向/ TAS/ 发送/ 注册/ 申请/ ;/ (/ 2/ )/ TAS/ 基于/ 平台/ 可信性/ 验证/ 策略/ [/ 15/ ]/ 认证/ L/ -/ ONS/ 平台/ 的/ 可信性/ ,/ 为/ 身份/ 合法/ 且/ 平台/ 可信/ 的/ L/ -/ ONS/ 分配/ 唯一/ 的/ 临时/ 标识号/ TIDL/ -/ ONS/ ,/ 由式/ (/ 1/ )/ 如下/ :/ CertA/ =/ {/ IDA/ ,/ KPA/ ,/ DateA/ ,/ LFA/ ,/ 其中/ KPA/ 是/ A/ 的/ 公钥/ ,/ KPrivCA/ -/ IoT/ 是/ CA/ -/ IoT/ 的/ 私钥/ ,/ DateA/ 是/ 证书/ 的/ 签署/ 日期/ ,/ LFA/ 是/ 证书/ 的/ 有效期/ ,/ 则/ Root/ -/ ONS/ 、/ L/ -/ ONS/ 和/ TAS/ 的/ 密钥/ 对/ 分别/ 为/ {/ KPRoot/ -/ ONS/ ,/ KSRoot/ -/ ONS/ }/ 、/ {/ KPL/ -/ ONS/ ,/ KSL/ -/ ONS/ }/ 和/ {/ KPTAS/ ,/ KSTAS/ }/ ./ 假设/ 2/ ./ 可信/ 匿名/ 认证/ 机制/ 和/ 可信/ 匿名/ 传输/ 机制/ 中/ 随机数/ 的/ 产生/ 、/ 加密/ // 解密/ 、/ Hash/ 运算/ 等/ 操作/ 均/ 可/ 由/ 可信/ 平台/ 模块/ (/ TrustedPlatformModule/ ,/ TPM/ )/ 完成/ ./ 假设/ 3/ ./ R/ -/ TIS/ 基于/ 可信计算/ 技术/ 构建/ 物品/ 信息/ 传输/ 链路/ 的/ 安全性/ 和/ 可信性/ ,/ 且/ 每个/ 节点/ 有/ 密钥/ 协商/ 、/ 数据/ 转发/ 和/ 加密/ // 解密/ 等/ 操作能力/ ./ 假设/ 4/ ./ 物品/ 信息/ 传输/ 链路/ 中/ 节点/ Ri/ 的/ 签密/ 私钥/ 为/ SKi/ ∈/ C/ [/ 1/ ,/ Q/ -/ 1/ ]/ ,/ 其公钥/ PKi/ =/ gSKimodP/ ./ 假设/ 5/ ./ L/ -/ ONS/ 、/ Root/ -/ ONS/ 、/ TAS/ 及/ CA/ -/ IoT/ 间/ 有/ 时钟/ 同步/ 机制/ 可/ 确保/ 本/ 模型/ 中/ 消息/ 时/ 戳/ 的/ 新鲜/ 性/ ./ 2.2/ 可信/ 匿名/ 认证/ 的/ ONS/ 查询/ 机制/ 在/ 查询/ 机制/ 中/ ,/ Root/ -/ ONS/ 在/ TAS/ 的/ 协助/ 下/ 对/ L/ -/ ONS/ 的/ 身份/ 合法性/ 及/ 平台/ 可信性/ 进行/ 认证/ ,/ 详细/ 查询/ 工作/ 流程/ 如图/ 2/ 所示/ ./ 计算/ 产生/ 秘密/ 数/ SL/ -/ ONS/ ,/ 即/ NumTAS/ 为/ TAS/ 随机/ 选取/ 的/ 大数/ ./ 用式/ (/ 2/ )/ 计算/ L/ -/ ONS/ 的/ 临时/ 身份/ TIDL/ -/ ONS/ ,/ 即/ TAS/ 为/ L/ -/ ONS/ 建立/ 账户/ 〈/ IDL/ -/ ONS/ ,/ SL/ -/ ONS/ ,/ TIDL/ -/ ONS/ ,/ NumTAS/ 〉/ ,/ 将/ SL/ -/ ONS/ 和/ TIDL/ -/ ONS/ 交由/ L/ -/ ONSPage5/ 安全/ 存储/ [/ 16/ ]/ ./ 2.2/ ./ 2L/ -/ ONS/ 申请/ 查询/ 服务/ L/ -/ ONS/ 注册/ 成功/ 后/ 即/ 向/ Root/ -/ ONS/ 申请/ 查询/ 服务/ ,/ 以/ 获知/ 相关/ R/ -/ TIS/ 的/ 网络地址/ ./ 具体/ 申请/ 过程/ 如图/ 3/ 所示/ :/ (/ 1/ )/ L/ -/ ONS/ 生成/ 随机数/ X0/ ∈/ [/ 1/ ,/ q/ -/ 1/ ]/ ,/ 同时/ 读图/ 3L/ -/ ONS/ 向/ Root/ -/ ONS/ 申请/ 查询/ 服务/ L/ -/ ONS/ 生成/ 自身/ 的/ 完整性/ 度量/ 信息/ L/ -/ ONSTPM/ =/ E/ (/ key/ ,/ s/ ‖/ SML/ )/ 后/ ,/ 将/ TIDL/ -/ ONS/ ,/ L/ -/ ONSTPM/ 及时/ 戳/ TL/ -/ ONS/ 连同/ 签名/ 信息/ SigL/ -/ ONS/ 一起/ 发给/ Root/ -/ ONS/ ,/ 其中/ SigL/ -/ ONS/ =/ H/ (/ KSL/ -/ ONS/ ,/ TIDL/ -/ ONS/ ‖/ L/ -/ ONSTPM/ ‖/ TL/ -/ ONS/ )/ ./ (/ 2/ )/ Root/ -/ ONS/ 验证/ L/ -/ ONS/ 签名/ 的/ 真实性/ 及时/ 戳/ 的/ 有效性/ ,/ 以/ 防范/ 重/ 放/ 攻击/ ,/ 若/ 验证/ 无效/ ,/ 则/ 拒绝/ 为/ 其/ 提供/ 查询/ 服务/ ,/ 否则/ 将/ 选择/ 随机数/ Nonce/ ,/ 并/ 生成/ 消息/ 签名/ SigRoot/ -/ ONS/ =/ H/ (/ KSRoot/ -/ ONS/ ,/ TIDL/ -/ ONS/ ‖/ TRoot/ -/ ONS/ ‖/ Nonce/ ‖/ L/ -/ ONSTPM/ ‖/ CertRoot/ -/ ONS/ )/ ./ Root/ -/ ONS/ 发送/ 消息/ TIDL/ -/ ONS/ ,/ Nonce/ ,/ L/ -/ ONSTPM/ ,/ SigRoot/ -/ ONS/ ,/ CertRoot/ -/ ONS/ ,/ TRoot/ -/ ONS/ 给/ TAS/ ./ (/ 3/ )/ TAS/ 验证/ Root/ -/ ONS/ 身份证/ 书/ 、/ 消息/ 签名/ 及时/ 戳/ 的/ 有效性/ ,/ 若/ 无效/ 则/ 终止/ 执行/ 并/ 退出/ 认证/ 机制/ ,/ 否则/ TAS/ 按式/ (/ 4/ )/ 验证/ L/ -/ ONS/ 的/ 身份/ 标识/ 是否/ 合法/ ,/ 即/ IDL/ -/ ONS/ =/ TIDL/ -/ ONS/ / H/ (/ IDL/ -/ ONS/ ‖/ NumTAS/ )/ / IDTAS/ 若/ L/ -/ ONS/ 是/ 非法/ 用户/ ,/ TAS/ 终止/ 操作/ ;/ 否则/ 计算/ 密钥/ key/ ,/ 解密/ L/ -/ ONSTPM/ 获知/ 度量/ PCR/ 值及/ 秘密/ 随机数/ X0/ ,/ 结合/ SML/ 及/ PCR/ 值/ 对/ L/ -/ ONS/ 平台/ 可信性/ 进行/ 验证/ ,/ 若/ 验证/ 不/ 通过/ ,/ TAS/ 终止/ 操作/ ;/ 否则/ 发送/ Result/ ,/ Nonce/ ,/ E/ (/ KPRoot/ -/ ONS/ ,/ X0/ )/ ,/ TTAS/ ,/ CertTAS/ ,/ SigTAS/ 给/ Root/ -/ ONS/ ,/ 其中/ SigTAS/ =/ H/ (/ KSTAS/ ,/ Result/ ‖/ Nonce/ ‖/ E/ (/ KPRoot/ -/ ONS/ ,/ X0/ )/ ‖/ TTAS/ ‖/ CertTAS/ )/ ./ (/ 4/ )/ Root/ -/ ONS/ 验证/ TAS/ 身份证/ 书/ 的/ 真实性/ 、/ 时/ 戳/ 的/ 有效性/ ,/ 若/ 无效/ ,/ 则/ 中止执行/ ,/ 否则/ 根据/ 相关/ 信息/ 确认/ L/ -/ ONS/ 的/ 身份/ 合法性/ 与/ 平台/ 可信性/ ,/ 仅/ 为/ 取/ 当前/ 平台/ 配置/ 寄存器/ (/ PlatformConfigurationRegister/ ,/ PCR/ )/ 的/ 值/ ,/ 用/ 私钥/ KSL/ -/ ONS/ 对/ 其/ 加密/ ,/ 得/ s/ =/ E/ (/ KSL/ -/ ONS/ ,/ PCR/ ‖/ X0/ )/ ,/ 读出/ 度量/ 日志/ SML/ ,/ 并用/ 式/ (/ 3/ )/ 计算/ 临时/ 密钥/ key/ ./ 身份/ 合法/ 且/ 平台/ 可信/ 的/ L/ -/ ONS/ 签发/ 成员/ 证书/ TCertL/ -/ ONS/ ./ Root/ -/ ONS/ 解密/ E/ (/ KPRoot/ -/ ONS/ ,/ X0/ )/ ,/ 计算/ k/ =/ X0/ ,/ 并/ 产生/ 随机数/ N0/ ,/ 将/ 消息/ E/ (/ k/ ,/ N0/ ‖/ TCertL/ -/ ONS/ )/ 、/ SigRoot/ -/ ONS/ 发送给/ L/ -/ ONS/ ./ (/ 5/ )/ L/ -/ ONS/ 获得/ TCertL/ -/ ONS/ 和/ N0/ ,/ 并/ 将/ 标签/ 编码/ 、/ 时/ 戳/ 、/ 随机数/ 和/ 签名/ 信息/ 发给/ Root/ -/ ONS/ ./ (/ 6/ )/ Root/ -/ ONS/ 根据/ 收到/ 的/ 标签/ 编码/ 将/ 对应/ R/ -/ TIS/ 的/ 网络地址/ 与/ 时/ 戳/ 、/ 随机数/ 和/ 消息/ 签名/ 发给/ L/ -/ ONS/ ,/ 即/ 完成/ 双方/ 间/ 身份/ 合法性/ 及/ 平台/ 可信性/ 验证/ ./ 2.2/ ./ 3L/ -/ ONS/ 持/ 成员/ 证书/ 申请/ 查询/ 服务/ 当/ L/ -/ ONS/ 获得/ TCertL/ -/ ONS/ 后/ ,/ 在/ 有效期/ 内可持/ 其/ 向/ Root/ -/ ONS/ 多次/ 申请/ 查询/ 服务/ ,/ 申请/ 过程/ 如图/ 4/ 所示/ ./ (/ 1/ )/ L/ -/ ONS/ 再次/ 申请/ 查询/ 时/ ,/ 生成/ 随机数/ Xi/ ∈/ C/ [/ 1/ ,/ q/ -/ 1/ ]/ ,/ 并/ 计算/ 本次/ 查询/ 申请/ 的/ 临时/ 身份/ TIDL/ -/ ONSi/ ,/ 即/ Page6/ 其中/ TIDL/ -/ ONS0/ =/ TIDL/ -/ ONS/ ,/ i/ =/ 1/ ,/ 2/ ,/ 3/ ,/ …/ ,/ n/ ,/ 用式/ (/ 6/ )/ 计算/ 本轮/ 会话/ 密钥/ ki/ ,/ 其中/ k0/ =/ k/ ,/ i/ =/ 1/ ,/ 2/ ,/ 3/ ,/ …/ ,/ n/ ./ L/ -/ ONS/ 计算/ E/ (/ ki/ ,/ TCertL/ -/ ONS/ ‖/ Xi/ )/ 和/ SigL/ -/ ONSi/ ,/ 读取/ 当前/ 时/ 戳/ TL/ -/ ONSi/ ,/ 发送/ 消息/ SigL/ -/ ONSi/ ,/ TIDL/ -/ ONSi/ ,/ E/ (/ ki/ ,/ TCertL/ -/ ONS/ ‖/ Xi/ )/ ,/ TL/ -/ ONSi/ 给/ Root/ -/ ONS/ ./ (/ 2/ )/ Root/ -/ ONS/ 验证/ 时/ 戳/ 和/ TIDL/ -/ ONSi/ 是否/ 有效/ ,/ 若/ 无效/ 则/ 拒绝/ 为/ L/ -/ ONS/ 提供/ 服务/ ,/ 否则/ 计算/ ki/ ,/ 并/ 解密/ E/ (/ ki/ ,/ TCertL/ -/ ONS/ ‖/ Xi/ )/ ,/ 验证/ 消息/ 的/ 完整性/ ,/ 同时/ 验证/ TCertL/ -/ ONS/ 的/ 合法性/ ,/ 若/ 合法/ 则/ 保存/ Xi/ ./ Root/ -/ ONS/ 产生/ 随机数/ Ni/ ,/ 计算/ 消息/ 签名/ SigRoot/ -/ ONSi/ 后/ 发送/ 消息/ SigRoot/ -/ ONSi/ ,/ TRoot/ -/ ONSi/ ,/ E/ (/ ki/ ,/ Ni/ )/ 给/ L/ -/ ONS/ ./ (/ 3/ )/ L/ -/ ONS/ 将/ 标签/ 编码/ 、/ 时/ 戳/ 、/ 消息/ 签名/ 连同/ 随机数/ 一起/ 发送给/ Root/ -/ ONS/ ./ (/ 4/ )/ Root/ -/ ONS/ 根据/ 收到/ 的/ 标签/ 编码/ ,/ 将/ 对应/ R/ -/ TIS/ 的/ 网络地址/ 连/ 同时/ 戳/ 、/ 随机数/ 和/ 消息/ 签名/ 一同/ 发送给/ L/ -/ ONS/ ./ 2.2/ ./ 4/ 成员/ 证书/ (/ 1/ )/ 证书/ 结构/ 过频/ 的/ 申请/ 查询/ 服务/ ,/ 不仅/ 增加/ L/ -/ ONS/ 的/ 完整性/ 度量/ 负载/ ,/ 同时/ 降低/ 了/ 查询/ 系统/ 的/ 工作效率/ ./ 本文/ 使用/ 证书/ 机制/ 减少/ L/ -/ ONS/ 的/ 可信性/ 评估/ 次数/ ,/ 提高/ 查询/ 系统/ 的/ 工作效率/ ,/ 证书/ 的/ 基本/ 信息/ 有/ :/ ①/ 有效/ 图/ 5/ 查询/ 响应/ 路径/ 示意图/ 如图/ 6/ 所示/ ,/ 算法/ 1/ 中/ R/ -/ TIS/ 根据/ 链路/ 中/ 各/ 节点/ 顺序/ 对/ 物品/ 信息/ 依次/ 进行/ 嵌套/ 加密/ 封装/ ,/ 对/ 封装/ 的/ 通信/ 数据/ 进行/ 签密/ 操作/ 后/ 产生/ 查询/ 响应/ 信息/ Message/ ,/ 节点/ R1/ 收到/ 消息/ Message/ 后/ 通过/ 算法/ 2/ (/ 如图/ 7/ 所示/ )/ 进行/ 消息/ 转发/ ,/ 依此类推/ ,/ 链路/ 中/ 其它/ 节点/ 重复/ 执行/ 算法/ 2/ ,/ 直至/ L/ -/ TIS/ ./ 节点/ Rj/ 收到/ 节点/ Rj/ -/ 1/ 发送/ 的/ 查询/ 响应/ 消息/ Message/ 后/ ,/ 根据/ 算法/ 2/ 对/ 其/ 进行/ 转发/ ,/ 首先/ 通过/ 签密/ 信息/ 验证/ 转发/ 数据/ 的/ 完整性/ ,/ 根据/ 路由/ 信息/ 鉴别/ 转发/ 路径/ 的/ 真实性/ ./ 然后/ 将/ 未/ 被/ 篡改/ 的/ 数据/ 消息/ 重新/ 封装/ 后/ 转发/ 到/ 下/ 一/ 节点/ Rj/ +/ 1/ ,/ 在/ 数据包/ 封装/ 过程/ 中/ ,/ 节点/ Rj/ 可/ 在/ Message/ 尾部/ 填充/ 任意/ 字符/ ,/ 并/ 对/ 转发/ 数据/ 进行/ 签密/ 操作/ ,/ 确保/ 通信/ 数据/ 及/ 通信/ 路径/ 的/ 真实性/ ,/ 即/ R/ -/ TIS/ 生成/ 的/ 响应/ 数据/ Message/ 在/ 节期/ :/ 证书/ 的/ 有效/ 时间/ ;/ ②/ 颁发/ 时间/ :/ 证书/ 的/ 颁发/ 时间/ ;/ ③/ 授权/ 对象/ :/ 证书/ 拥有者/ 临时/ 身份/ 信息/ TIDL/ -/ ONS/ ;/ ④/ 签名/ :/ Root/ -/ ONS/ 的/ 签名/ 信息/ ./ (/ 2/ )/ 证书/ 合法性/ 验证/ 在/ 成员/ 证书/ 的/ 有效期/ 内/ ,/ L/ -/ ONS/ 持该/ 证书/ 可/ 多次/ 申请/ 查询/ 服务/ ,/ 通过/ 下述/ 步骤/ 验证/ 成员/ 证书/ 的/ 真实性/ ,/ 以/ 判断/ L/ -/ ONS/ 的/ 身份/ 合法性/ 及/ 平台/ 可信性/ ./ ①/ 通过/ 签名/ 信息/ 验证/ 颁发/ 者/ 身份/ ,/ 同时/ 检查/ 证书/ 内容/ 是否/ 被/ 篡改/ ;/ ②/ 根据/ 证书/ 的/ 有效期/ 、/ 颁发/ 时间/ 等/ 信息/ 验证/ 证/ ③/ 计算/ TIDL/ -/ ONS/ =/ TIDL/ -/ ONSi/ / Ni/ -/ 1/ / Ni/ -/ 2/ / …/ / N0/ ,/ 验证/ TIDL/ -/ ONS/ =/ TIDL/ -/ ONS/ 是否/ 成立/ ,/ 验证/ 持有者/ 是否是/ 证书/ 的/ 申请者/ ./ 若/ 上述/ 验证/ 均/ 通过/ ,/ 表明/ L/ -/ ONS/ 持有/ 真实有效/ 书/ 在/ 当前/ 时间/ 是否/ 有效/ ;/ 的/ 合法/ 成员/ 证书/ ./ 2.3/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ L/ -/ TIS/ 通过/ L/ -/ ONS/ 的/ 查询/ 机制/ 获得/ 相关/ R/ -/ TIS/ 的/ 网络地址/ ,/ 通过/ 与/ R/ -/ TIS/ 间/ 的/ 信息/ 交互/ L/ -/ TIS/ 可/ 获知/ 相关/ 物品/ 的/ 详细信息/ ./ 本文/ 设计/ 的/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 实现/ L/ -/ TIS/ 与/ R/ -/ TIS/ 间/ 物品/ 信息/ 的/ 安全/ 传输/ ./ R/ -/ TIS/ 用/ 合法/ 且/ 可信/ 的/ 中继/ 节点/ 建立/ 如图/ 5/ 所示/ 的/ 物品/ 信息/ 传输/ 链路/ ,/ 与/ 各/ 节点/ 协商会/ 话/ 密钥/ ,/ 并/ 获知/ 各/ 节点/ 的/ 身份/ Hash/ 值/ ./ 点间/ 转发/ 过程/ 中/ 大小/ 不变/ ,/ 防止/ 窃听/ 者/ 根据/ 数据包/ 的/ 大小/ 关系/ 进行/ 流量/ 分析/ 、/ 窃听/ 等/ 攻击/ ./ 链路/ 中/ 的/ 每个/ 节点/ 通过/ 如图/ 7/ 所示/ 的/ 算法/ 2/ 根据/ 消息/ 验证/ 数据/ 的/ 完整性/ 及/ 转发/ 路径/ 的/ 真实性/ ,/ 将/ 完整/ 且/ 真实/ 的/ 数据/ 重新/ 封装/ 后/ 转发给/ 下/ 一/ 节点/ ,/ 直至/ 目标/ L/ -/ TIS/ ./ 3/ 物/ 联网/ 安全/ 传输/ 模型/ 分析/ 本节/ 从/ 安全性/ 、/ 可信性/ 、/ 匿名性/ 等/ 方面/ 对物/ 联网/ 安全/ 传输/ 模型/ 进行/ 分析/ ./ 3.1/ 可信/ 匿名/ 认证/ 的/ ONS/ 查询/ 机制/ 在/ L/ -/ ONS/ 申请/ 查询/ 服务/ 时/ ,/ Root/ -/ ONS/ 在/ TAS/ 的/ 协助/ 下/ 对/ L/ -/ ONS/ 的/ 身份/ 合法性/ 及/ 平台/ 可信性/ 进/ Page7/ 算法/ 1/ ./ R/ -/ TIS/ 响应/ 消息/ Message/ 初始化/ 算法/ ./ 输入/ :/ ①/ R/ -/ TIS/ 、/ L/ -/ TIS/ 及/ 网络/ 节点/ 集合/ {/ R/ -/ TIS/ (/ R0/ )/ ,/ R1/ ,/ R2/ ,/ R3/ ,/ …/ ,/ Rn/ ,/ L/ -/ TIS/ (/ Rn/ +/ 1/ )/ }/ Node/ ;/ 输出/ :/ Message/ =/ E/ (/ KD/ (/ R/ -/ TIS/ ,/ R1/ )/ ,/ H/ (/ IDR1/ )/ ‖/ ST/ ‖/ SP/ ‖/ SQ/ ‖/ TR/ -/ TIS/ ‖/ H/ (/ IDR/ -/ TIS/ )/ ‖/ FR0/ ‖/ w/ ‖/ z/ ‖/ INF/ )/ Begin1/ ./ AddtheRjintothepathofresponse/ ,/ OnlyiftheRjisatrusted/ // / 计算/ R/ -/ TIS/ 与/ 各/ 节点/ 的/ 会/ 话/ 密钥/ k/ (/ R/ -/ TIS/ ,/ Ri/ )/ / // 2/ ./ Form/ =/ 1tom/ =/ nk/ (/ R/ -/ TIS/ ,/ Rm/ )/ =/ e/ (/ qH/ (/ IDR/ -/ TIS/ )/ ,/ H/ (/ IDRm/ )/ )/ ;/ EndFor/ ;/ 3/ ./ k/ (/ R/ -/ TIS/ ,/ L/ -/ TIS/ )/ =/ e/ (/ qH/ (/ IDR/ -/ TIS/ )/ ,/ H/ (/ IDL/ -/ TIS/ )/ )/ ;/ // / 封装/ 查询/ 响应/ 数据/ ,/ 其中/ IPm/ 为/ 节点/ Rm/ 的/ IP地址/ ,/ Information4/ ./ Data/ =/ E/ {/ k/ (/ R/ -/ TIS/ ,/ L/ -/ TIS/ )/ ,/ Information/ }/ ;/ 5/ ./ Data/ =/ E/ {/ k/ (/ R/ -/ TIS/ ,/ Rn/ )/ ,/ IPL/ -/ TIS/ ‖/ Data/ }/ ;/ 6/ ./ Form/ =/ n/ -/ 1tom/ =/ 1/ 为/ 物品/ 的/ 详细信息/ / // Data/ =/ E/ {/ k/ (/ R/ -/ TIS/ ,/ Rm/ )/ ,/ IPRm/ +/ 1/ ‖/ Data/ }/ ;/ EndFor/ ;/ // / 计算/ 各/ 节点/ 的/ 路由/ 鉴别信息/ / // 7/ ./ JR1/ =/ H/ (/ IDR/ -/ TIS/ )/ / H/ (/ IDR1/ )/ / H/ (/ IDR2/ )/ ;/ 8/ ./ Form/ =/ 1tom/ =/ n/ -/ 1JRm/ +/ 1/ =/ H/ (/ IDRm/ )/ / H/ (/ IDRm/ +/ 1/ )/ / H/ (/ IDRm/ +/ 2/ )/ ;/ EndFor/ ;/ 9/ ./ JRn/ +/ 1/ =/ H/ (/ IDRn/ )/ / H/ (/ IDL/ -/ TIS/ )/ / H/ (/ IDR/ -/ TIS/ )/ ;/ 10/ ./ Initial/ (/ ST/ )/ ;/ 11/ ./ Form/ =/ n/ +/ 1tom/ =/ 1EndFor/ ;/ 13/ ./ FR0/ =/ H/ (/ IDR/ -/ TIS/ )/ ;/ 14/ ./ LR0/ =/ H/ (/ FR0/ )/ ;/ 图/ 6/ 响应/ 消息/ 初始化/ 算法/ 算法/ 2/ ./ 节点/ Rj/ 转发/ 来自/ Rj/ -/ 1/ 的/ 响应/ 消息/ Message/ ./ 输入/ :/ Message/ =/ E/ (/ KD/ (/ Rj/ -/ 1/ ,/ Rj/ )/ ,/ H/ (/ IDRj/ )/ ‖/ ST/ ‖/ SP/ ‖/ SQ/ ‖/ H/ (/ IDRj/ -/ 1/ )/ ‖/ FRj/ -/ 1/ ‖/ TRj/ -/ 1/ ‖/ w/ ‖/ z/ ‖/ INF/ )/ 输出/ :/ Message/ =/ E/ (/ KD/ (/ Rj/ ,/ Rj/ +/ 1/ )/ ,/ H/ (/ IDRj/ +/ 1/ )/ ‖/ ST/ ‖/ SP/ ‖/ SQ/ ‖/ H/ (/ IDRj/ )/ ‖/ FRj/ ‖/ TRj/ ‖/ w/ ‖/ z/ ‖/ INF/ )/ elsestopandsenderrormessage/ ;/ BeginEndIf/ ;/ // / 验证/ 转发/ 数据/ 的/ 完整性/ / // 1/ ./ Key1/ =/ (/ gPKw2/ ./ Key2/ =/ H/ (/ KeySKj1modP/ )/ ;/ 3/ ./ Data/ =/ D/ (/ Key2/ ,/ INF/ )/ ;/ 4/ ./ IfH/ (/ Key1/ ,/ INF/ )/ =/ =/ wthengoto5/ ;/ elsestopandsenderrormessage/ ;/ Endif/ // / 鉴别/ 转发/ 路径/ 的/ 真实性/ / // 5/ ./ KD/ (/ Rj/ -/ 1/ ,/ Rj/ )/ =/ H/ (/ IDRj/ -/ 1/ )/ / H/ (/ IDRj/ )/ ;/ 6/ ./ UseKD/ (/ Rj/ -/ 1/ ,/ Rj/ )/ decryptionMessage/ ;/ 7/ ./ RjgettheY/ =/ H/ (/ IDRj/ )/ fromtheMessage/ ;/ // / Rj/ 检查/ H/ (/ IDRj/ )/ 与/ 自身/ 计算/ 的/ 是否/ 相等/ / // 8/ ./ RjcheckH/ (/ IDRj/ )/ withtheY/ =/ H/ (/ IDRj/ )/ whichdecryptionfromMessage/ ;/ 9/ ./ Ifthecheckpassesthengoto10/ ;/ elsestopandsenderrormessage/ ;/ EndIf/ ;/ 10/ ./ LRj/ =/ SP/ ./ Get/ (/ )/ ;/ 11/ ./ SP/ =/ SP/ ./ POP/ (/ )/ ;/ 12/ ./ FRj/ =/ FRj/ -/ 1/ / H/ (/ IDj/ )/ ;/ 13/ ./ If/ (/ LRj/ =/ =/ H/ (/ FRj/ )/ )/ 图/ 7/ 响应/ 消息/ 节点/ 转发/ 算法/ 15/ ./ Form/ =/ 0tom/ =/ n/ -/ 1FRm/ +/ 1/ =/ FRm/ / H/ (/ IDRm/ +/ 1/ )/ ;/ LRm/ +/ 1/ =/ H/ (/ FRm/ +/ 1/ )/ ;/ EndFor/ ;/ 16/ ./ FRn/ +/ 1/ =/ FRn/ / H/ (/ IDL/ -/ TIS/ )/ ;/ 17/ ./ LRn/ +/ 1/ =/ H/ (/ FRn/ +/ 1/ )/ ;/ 18/ ./ Initial/ (/ SP/ )/ ;/ 19/ ./ Form/ =/ n/ +/ 1tom/ =/ 1SP/ ./ Push/ (/ LRm/ )/ ;/ EndFor/ ;/ 20/ ./ KD/ (/ R/ -/ TIS/ ,/ R1/ )/ =/ H/ (/ IDR/ -/ TIS/ )/ / H/ (/ IDR1/ )/ ;/ 21/ ./ Initial/ (/ SQ/ )/ ;/ 22/ ./ SQ/ ./ Push/ (/ PKL/ -/ TIS/ )/ ;/ 23/ ./ Fori/ =/ ntom/ =/ 2SQ/ ./ Push/ (/ PKRi/ )/ ;/ EndFor/ ;/ 24/ ./ Num/ ∈/ C/ [/ 1/ ,/ Q/ -/ 1/ ]/ ;/ 25/ ./ Key1/ =/ gNummodP/ ;/ 26/ ./ Key2/ =/ H/ (/ PKNum1modP/ )/ ;/ 27/ ./ INF/ =/ E/ (/ Key2/ ,/ Data/ )/ ;/ 28/ ./ w/ =/ H/ (/ Key1/ ,/ INF/ )/ ;/ 29/ ./ z/ =/ Num/ (/ 1/ +/ wSK0/ )/ -/ 1modQ/ ;/ 30/ ./ R/ -/ TIS/ (/ R0/ )/ generatedtimestampisTR/ -/ TIS/ ;/ 31/ ./ Message/ =/ E/ (/ KD/ (/ R/ -/ TIS/ ,/ R1/ )/ ,/ H/ (/ IDR1/ )/ ‖/ ST/ ‖/ SP/ ‖/ SQ/ ‖/ 32/ ./ R/ -/ TIS/ (/ R0/ )/ SendMessagetoR1/ ;/ End14/ ./ JRj/ =/ ST/ ./ Get/ (/ )/ ;/ 15/ ./ ST/ =/ ST/ ./ Pop/ (/ )/ ;/ 16/ ./ H/ (/ IDRj/ +/ 1/ )/ =/ H/ (/ IDRj/ -/ 1/ )/ / H/ (/ IDRj/ )/ / JRj/ ;/ 17/ ./ K/ (/ R/ -/ TIS/ ,/ Rj/ -/ 1/ )/ =/ e/ (/ qH/ (/ IDR/ -/ TIS/ )/ ,/ H/ (/ IDRj/ -/ 1/ )/ )/ ;/ 18/ ./ RjuseK/ (/ R/ -/ TIS/ ,/ Rj/ -/ 1/ )/ decryptiontheData/ ;/ 19/ ./ Data/ =/ D/ (/ K/ (/ R/ -/ TIS/ ,/ Rj/ -/ 1/ )/ ,/ Data/ )/ ;/ 20/ ./ Num/ ∈/ C/ [/ 1/ ,/ Q/ -/ 1/ ]/ ;/ 21/ ./ PKRj/ +/ 1/ =/ SQ/ ./ Get/ (/ )/ ;/ 22/ ./ SQ/ =/ SQ/ ./ Pop/ (/ )/ ;/ 23/ ./ Key1/ =/ gNummodP/ ;/ 24/ ./ Key2/ =/ H/ (/ PKNum25/ ./ INF/ =/ E/ (/ Key2/ ,/ Data/ )/ ;/ 26/ ./ w/ =/ H/ (/ Key1/ ,/ INF/ )/ ;/ 27/ ./ z/ =/ Num/ (/ 1/ +/ wSKj/ )/ -/ 1modq/ ;/ 28/ ./ RjgettheIPofRj/ +/ 1fromtheData/ ;/ 29/ ./ KD/ (/ Rj/ ,/ Rj/ +/ 1/ )/ =/ H/ (/ IDRj/ )/ / H/ (/ IDRj/ +/ 1/ )/ ;/ 30/ ./ RjgeneratedtimestampisTRj/ ;/ 31/ ./ Message/ =/ E/ (/ KD/ (/ Rj/ ,/ Rj/ +/ 1/ )/ ,/ H/ (/ IDRj/ +/ 1/ )/ ‖/ ST/ ‖/ SP/ ‖/ 32/ ./ RjSendMessagetoRj/ +/ 1/ ;/ EndPage8/ 行/ 验证/ ,/ 防止/ 非/ 授权/ L/ -/ ONS/ 的/ 查询/ 申请/ ,/ 增强/ 了/ 物/ 联网/ 查询/ 机制/ 的/ 可靠性/ 、/ 安全性/ 及/ 可信性/ ./ 3.1/ ./ 1/ 安全性/ 分析/ 认证/ 机制/ 的/ 安全性/ 是/ 基于/ 求解/ 离散/ 对数/ 的/ 困难性/ ./ L/ -/ ONS/ 利用/ 秘密/ 数/ SL/ -/ ONS/ 和/ 时/ 戳/ 通过/ 散列/ 函数/ 计算/ 临时/ 密钥/ ki/ ,/ 由/ SL/ -/ ONS/ 的/ 机密性/ 和/ 散列/ 函数/ 的/ 安全性/ 保证/ ki/ 的/ 不可/ 伪造/ 性/ ,/ 时/ 戳/ 保证/ 了/ ki/ 的/ 新鲜/ 性/ ./ TAS/ 检查/ 时/ 戳/ 的/ 新鲜/ 性后/ ,/ 计算/ L/ -/ ONS/ 的/ 身份/ 标识/ 验证/ 其/ 合法性/ ,/ 同时/ 结合/ 完整性/ 度量/ 日志/ 及/ PCR/ 值/ 验证/ L/ -/ ONS/ 平台/ 的/ 可信性/ ,/ 即/ Root/ -/ ONS/ 在/ TAS/ 的/ 协助/ 下/ 完成/ 对/ L/ -/ ONS/ 的/ 身份/ 合法性/ 及/ 平台/ 可信性/ 验证/ ./ 其中/ 消息/ 散列/ 运算/ 保证/ 了/ 消息/ 的/ 完整性/ ,/ 并且/ 随机数/ 可/ 防止/ 重/ 放/ 攻击/ ./ L/ -/ ONS/ 再次/ 申请/ 服务/ 时/ ,/ 其/ 成员/ 证书/ 可/ 证明/ 身份/ 的/ 合法性/ 及/ 平台/ 的/ 可信性/ ,/ 并且/ 每次/ 均/ 产生/ 不同/ 的/ 会/ 话/ 密钥/ ki/ ,/ 实现/ 了/ 一次/ 一密/ ,/ 增强/ 了/ 安全性/ ./ 由于/ Xi/ 由/ L/ -/ ONS/ 选择/ 计算/ ,/ 而/ Ni/ 由/ Root/ -/ ONS/ 选择/ 计算/ ,/ 因此/ ki/ 是/ 一次性/ 密钥/ ,/ 且/ 任何一方/ 无法/ 单独/ 计算/ 产生/ ,/ 保证/ 了/ 会/ 话/ 密钥/ 的/ 公正性/ 、/ 新鲜/ 性及/ 前/ 向/ 保密性/ ./ 可信/ 匿名/ ONS/ 查询/ 协议/ 的/ 安全性/ 达到/ 了/ 通用/ 可/ 组合/ 安全/ (/ UC/ 安全/ )/ 等级/ ,/ 详细/ 的/ 证明/ 过程/ 请/ 参见/ 附录/ ./ 3.1/ ./ 2/ 匿名性/ 分析/ (/ 1/ )/ 查询/ 机制/ 的/ 匿名性/ 和/ 不可/ 追踪/ 性/ 通信/ 消息/ 中均/ 未/ 出现/ L/ -/ ONS/ 的/ 真实/ 身份/ ,/ 注册/ 时/ L/ -/ ONS/ 的/ 真实/ 身份/ IDL/ -/ ONS/ 被/ 临时/ 身份/ TIDL/ -/ ONS/ 替代/ ./ 因仅/ 有/ TAS/ 掌握/ 秘密/ 数/ NumTAS/ ,/ 所以/ 只有/ TAS/ 才能/ 通过/ 式/ (/ 2/ )/ 正确/ 验证/ 用户/ 的/ 真实/ 身份/ IDL/ -/ ONS/ ,/ 确保/ L/ -/ ONS/ 身份/ 的/ 匿名性/ ./ 不同/ 的/ L/ -/ ONS/ 对应/ 不同/ 的/ TIDL/ -/ ONS/ 且/ 由/ 互不/ 相同/ 的/ 随机数/ NumTAS/ 计算/ 产生/ ,/ 并且/ 任何/ 合法/ L/ -/ ONS/ 均/ 无法/ 通过/ 自己/ 的/ TIDL/ -/ ONS/ 计算/ 其它/ ONS/ 服务器/ 的/ ID/ 号/ ,/ 当/ 同一/ L/ -/ ONS/ 多次/ 向/ Root/ -/ ONS/ 申请/ 查询/ 时/ ,/ 每次/ 均/ 使用/ 不同/ 的/ 临时/ 身份/ TIDL/ -/ ONS/ ,/ 具有/ 不可/ 跟踪/ 性/ ./ (/ 2/ )/ 证书/ 的/ 匿名性/ 成员/ 证书/ 仅/ 报告/ 持有者/ 身份/ 是否/ 合法/ 、/ 平台/ 是否/ 可信/ ,/ 未/ 包含/ 其/ 配置/ 信息/ 及其/ 身份/ 信息/ ,/ 即/ 成员/ 证书/ 具有/ 匿名性/ ,/ 匿名性/ 的/ 强弱/ 取决于/ 有效/ 授权/ 时间/ 的/ 长短/ ,/ 越短/ 则/ 匿名性/ 越强/ ,/ 同时/ 其/ 匿名性/ 是/ 可控/ 的/ ,/ 可控性/ 依赖于/ 证书/ 持有者/ 的/ 临时/ 身份/ 信息/ ,/ 在/ 有效期/ 内仅/ 允许/ 同一/ 用户/ 用该/ 证书/ 建立/ 查询/ 服务/ ./ 3.1/ ./ 3/ 可信性/ TAS/ 对/ L/ -/ ONS/ 配置/ 信息/ 的/ 安全/ 存储/ ,/ 保证/ 了/ 对/ L/ -/ ONS/ 进行/ 平台/ 可信性/ 验证/ 的/ 同时/ ,/ 有效/ 保护/ 了/ 平台/ 信息/ 的/ 私密性/ ,/ 即使/ L/ -/ ONS/ 的/ 配置/ 信息/ 遭/ 泄露/ ,/ 但/ L/ -/ ONS/ 可信性/ 验证/ 信息/ 是/ 经过/ 密钥/ ki/ 加密/ 处理/ 的/ ,/ 由于/ ki/ 的/ 保密性/ ,/ 避免/ Root/ -/ ONS/ 依/ 平台/ 配置/ 信息/ 推知/ L/ -/ ONS/ 的/ 平台/ 身份/ 及/ 配置/ 状况/ ./ L/ -/ ONS/ 通过/ 向/ TAS/ 提供/ 签名/ 后/ 的/ 平台/ PCR/ 值及/ 度量/ 日志/ SML/ 来/ 证明/ 平台/ 的/ 完整性/ ./ L/ -/ ONS/ 以/ 硬件/ TPM/ 为/ 起点/ 将/ 可信性/ 由/ 底层/ 通过/ 信任/ 链/ 技术/ 传递/ 至/ 应用层/ ,/ 即/ TAS/ 根据/ 完整性/ 度量/ 值及/ 度量/ 日志/ 等/ 信息/ 鉴别/ L/ -/ ONS/ 平台/ 的/ 可信性/ ./ 3.2/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ R/ -/ TIS/ 将/ 物品/ 信息/ 按/ 链路/ 节点/ 顺序/ 从后/ 至/ 前/ 嵌套/ 加密/ ,/ 传输/ 过程/ 中/ 加密/ 后/ 的/ 数据/ 每/ 经过/ 一个/ 节点/ 被/ 解密/ 一层/ ,/ 到/ L/ -/ TIS/ 时/ 数据/ 才/ 被/ 完全/ 解密/ ,/ 并且/ 链路/ 中/ 各/ 节点/ 可/ 根据/ 前驱/ 节点/ 的/ 签密/ 信息/ 验证/ 数据/ 的/ 完整性/ ,/ 根据/ 签名/ 及/ 路由/ 信息/ 鉴别/ 链路/ 的/ 真实性/ ,/ 增强/ 了/ 物品/ 信息/ 传输/ 过程/ 的/ 安全性/ ./ 3.2/ ./ 1/ 匿名性/ 分析/ 匿名/ 通信/ 链路/ 中/ 各/ 节点/ 仅知/ 其/ 前驱/ 和/ 后继/ 节点/ 的/ 身份/ Hash/ 值/ ./ 节点/ Rj/ +/ 1/ 用/ 前驱/ 节点/ Rj/ 的/ H/ (/ IDRj/ )/ 、/ 自己/ 的/ H/ (/ IDRj/ +/ 1/ )/ 和/ 路由/ 鉴别信息/ JRj/ +/ 1/ 进行/ 运算/ 后仅/ 得到/ 后继/ 节点/ Rj/ +/ 2/ 的/ H/ (/ IDRj/ +/ 2/ )/ ,/ 无法/ 获知/ 其它/ 节点/ 的/ 身份/ 信息/ ,/ 即/ 保证/ 了/ R/ -/ TIS/ 和/ L/ -/ TIS/ 身份/ 的/ 匿名性/ ;/ 每个/ 节点/ 通过/ 计算/ 仅能/ 获知/ 相邻/ 节点/ 的/ 网络地址/ ,/ 无法/ 获知/ 其它/ 节点/ 的/ 地址/ 信息/ ,/ 即/ 保证/ 了/ R/ -/ TIS/ 和/ L/ -/ TIS/ 位置/ 的/ 匿名性/ ./ 匿名/ 链路/ 的/ 路由/ 鉴别信息/ 、/ 通信/ 数据/ 及/ 地址/ 信息/ 只有/ 合法/ 的/ 后继/ 节点/ 才能/ 正确/ 解密/ ,/ 保证/ 了/ R/ -/ TIS/ 和/ L/ -/ TIS/ 通信/ 的/ 匿名性/ ./ 3.2/ ./ 2/ 匿名/ 度/ 仿真/ Reiter/ 和/ Rubin/ [/ 17/ ]/ 提出/ 针对/ 共谋/ 攻击/ 的/ 匿名/ 度/ 分析方法/ ,/ 攻击者/ 由/ 多个/ 恶意/ 节点/ 组成/ ,/ 每个/ 恶意/ 节点/ 占据/ 了/ 不同/ 的/ 位置/ ./ 从/ 攻击者/ 而言/ ,/ 发送者/ 是/ 位于/ 第/ 1/ 个/ 恶意/ 节点/ 之前/ 的/ ;/ 接收者/ 是/ 位于/ 最后/ 1/ 个/ 恶意/ 节点/ 之后/ ./ 本文/ 研究/ 的/ 物品/ 信息/ 传输/ 机制/ 由非/ 恶意/ 者/ 发起/ ,/ 同时/ 接收者/ 也/ 为/ 非/ 恶意/ 者/ ./ 假设/ 物品/ 信息/ 匿名/ 传输/ 链路/ 的/ 长度/ 为/ n/ ,/ 其中/ 有/ c/ 个/ 恶意/ 节点/ ,/ 则/ 转发/ 节点/ 是/ 有效/ 节点/ 的/ 概率/ p/ 为/ p/ =/ 1/ -/ cn/ +/ 1/ 号/ 位置/ ,/ 信息/ 传输/ 机制/ 的/ 匿名/ 度为/ d/ ./ Hx/ (/ 1/ / x/ / n/ -/ c/ )/ 表示/ 第/ 1/ 个/ 恶意/ 节点/ 是/ 链路/ 的/ 第/ x/ 个/ 节点/ ;/ Hx/ +/ 表示/ 第/ 1/ 个/ 恶意/ 节点/ 在/ 第/ x/ 个/ Page9/ 节点/ 及/ 之前/ 的/ 事件/ ;/ p/ (/ x/ )/ 表示/ 链路/ 中/ 第/ 1/ 个/ 恶意/ 节点/ 在/ 第/ x/ 个/ 节点/ 的/ 概率/ ,/ I/ 表示/ 事件/ 第/ 1/ 个/ 恶意/ 节点/ 猜中/ 发送者/ 身份/ ,/ 则/ p/ (/ I/ |/ H1/ +/ )/ 表示/ 恶意/ 节点/ 正确/ 推断出/ 消息/ 发送者/ 的/ 概率/ ,/ 即/ 为/ 发送者/ 匿名/ 度/ ./ 第/ 1/ 个/ 恶意/ 节点/ 在/ 链路/ 中/ 第/ x/ 个/ 位置/ 的/ 概率/ p/ (/ Hx/ )/ 为/ p/ (/ Hx/ )/ =/ p/ (/ x/ -/ 1/ )/ (/ 1/ -/ p/ )/ ;/ 第/ 1/ 个/ 恶意/ 节点/ 出现/ 在/ 链路/ 中/ 第/ 1/ 个/ 位置/ 及/ 之后/ 的/ 概率/ p/ (/ H1/ +/ )/ 为/ p/ (/ H1/ +/ )/ =/ (/ 1/ -/ p/ )/ ∑/ n/ -/ c/ 当/ 第/ 1/ 个/ 恶意/ 节点/ 是/ 链路/ 的/ 第/ 1/ 个/ 节点/ 时/ ,/ 它/ 的/ 前驱/ 节点/ 即/ 为/ 发送者/ ,/ 恶意/ 节点/ 猜中/ 发送者/ 的/ 概率/ 为/ 1/ ,/ 即/ p/ (/ I/ |/ H1/ )/ =/ 1/ ;/ 第/ 1/ 个/ 恶意/ 节点/ 在/ 第/ 2/ 个/ 节点/ 或/ 在/ 其/ 之前/ ,/ 它/ 的/ 前驱/ 不/ 可能/ 是/ 发送者/ ,/ 即/ 其/ 猜中/ 发送者/ 的/ 概率/ 为/ 0/ ,/ 即/ p/ (/ I/ |/ H2/ +/ )/ =/ 0/ ./ p/ (/ I/ |/ H2/ +/ )/ ,/ 因为/ p/ (/ I/ )/ =/ p/ (/ H1/ )/ ·/ p/ (/ I/ |/ H1/ )/ +/ p/ (/ H2/ )/ ·/ 又/ 因为/ p/ (/ I/ )/ =/ p/ (/ H1/ +/ )/ ·/ p/ (/ I/ |/ H1/ +/ )/ ,/ 所以/ p/ (/ I/ |/ H1/ +/ )/ =/ 1/ -/ pMx/ (/ c/ / x/ / n/ )/ 表示/ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 链路/ 的/ 第/ x/ 个/ 节点/ ;/ Mx/ -/ 表示/ 最后/ 1/ 个/ 恶意/ 节点/ 在/ 第/ x/ 个/ 节点/ 及/ 之后/ 的/ 事件/ ;/ Q/ (/ x/ )/ 表示/ 链路/ 中/ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 第/ x/ 个/ 节点/ 的/ 概率/ ,/ R/ 表示/ 事件/ 最后/ 1/ 个/ 恶意/ 节点/ 猜中/ 接收者/ 身份/ ,/ 则/ Q/ (/ R/ |/ Mn/ -/ )/ 表示/ 恶意/ 节点/ 正确/ 推断出/ 消息/ 接收者/ 的/ 概率/ ,/ 即/ 为/ 接收者/ 匿名/ 度/ ./ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 链路/ 第/ x/ 个/ 节点/ 的/ 概率/ Q/ (/ Hx/ )/ 为/ Q/ (/ Mx/ )/ =/ (/ 1/ -/ p/ )/ p/ (/ n/ -/ x/ )/ ;/ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 链路/ 中/ 第/ n/ 号位/ 及/ 以后/ 的/ 概率/ Q/ (/ Mn/ -/ )/ 为/ Q/ (/ Mn/ -/ )/ =/ (/ 1/ -/ p/ )/ ∑/ n/ 当/ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 转发/ 路径/ 的/ 第/ n/ 个/ 节点/ 时/ ,/ 它/ 的/ 后继/ 节点/ 即/ 为/ 接收者/ ,/ 恶意/ 节点/ 猜中/ 接收者/ 的/ 概率/ 为/ 1/ ,/ 即/ Q/ (/ R/ |/ Mn/ )/ =/ 1/ ;/ 最后/ 1/ 个/ 恶意/ 节点/ 是/ 第/ n/ -/ 1/ 个/ 节点/ 或/ 在/ 其/ 之后/ 时/ ,/ 它/ 的/ 后继/ 节点/ 不/ 可能/ 是/ 发送者/ ,/ 恶意/ 节点/ 猜中/ 接收者/ 的/ 概率/ 为/ 0/ ,/ 即/ Q/ (/ R/ |/ M/ (/ n/ -/ 1/ )/ -/ )/ =/ 0/ ./ 因为/ Q/ (/ R/ )/ =/ Q/ (/ Mn/ )/ ·/ Q/ (/ R/ |/ Mn/ )/ +/ Q/ (/ M/ (/ n/ -/ 1/ )/ )/ ·/ Q/ (/ R/ |/ M/ (/ n/ -/ 1/ )/ -/ )/ ,/ 又/ 因为/ Q/ (/ R/ )/ =/ Q/ (/ Mn/ -/ )/ ·/ Q/ (/ R/ |/ Mn/ -/ )/ ,/ 所以/ Q/ (/ R/ |/ Mn/ -/ )/ =/ 1/ -/ p/ 综上所述/ ,/ 匿名/ 度/ d/ =/ P/ (/ I/ |/ H1/ +/ )/ ·/ Q/ (/ R/ |/ Mn/ -/ )/ =/ (/ 1/ -/ p/ )/ 2/ 仿真/ 表明/ ,/ 匿名/ 度/ 随/ n/ 和/ p/ 的/ 增大/ 而/ 减小/ ,/ 受/ p/ 的/ 影响/ 较大/ (/ 如图/ 8/ 所示/ )/ ./ 当/ n/ / 10/ ,/ p/ / 0.4/ 时/ 匿名/ 度/ 大小/ 趋近/ 于/ 0/ ,/ 接近/ 绝对/ 匿名/ 的/ 等级/ ,/ 且/ 此时/ 匿名/ 度/ 大小/ 不/ 受/ 节点/ 数/ 影响/ (/ 如图/ 9/ 所示/ )/ ./ 这种/ 结果/ 与/ 现实情况/ 基本一致/ ,/ 说明/ 物品/ 信息/ 可信/ 匿名/ 传输/ 机制/ 具有/ 较强/ 的/ 匿名性/ ./ 3.2/ ./ 3/ 安全性/ 分析/ 安全性/ 是/ 建立/ 在/ 求解/ 双线性/ 难解/ 问题/ 的/ 基础/ 之上/ ./ 当/ 窃听/ 者/ 获得/ 节点/ 的/ 公钥/ H/ (/ IDRi/ )/ 时/ ,/ 因大/ 素数/ q/ 的/ 保密性/ 而/ 无法/ 求解/ 节点/ 私钥/ qH/ (/ IDRi/ )/ ./ 即使/ 当/ 窃听/ 者/ 捕获/ 了/ 节点/ Ri/ ,/ 获得/ 节点/ 的/ 公钥/ 和/ 私钥/ 对/ ,/ 因/ 面临/ 求解/ 双线性/ 难解/ 问题/ 而/ 使/ 窃听/ 者/ 无法/ 求解/ 出/ q/ ,/ 因此/ 即使/ 捕获/ 了/ 一些/ 节点/ ,/ 但/ 其它/ 节点/ 的/ 安全性/ 不受/ 其/ 影响/ ./ (/ 1/ )/ 抗/ 被动/ 攻击/ ./ 若/ 窃听/ 者/ 捕获/ 到/ 节点/ Ri/ -/ 1/ 的/ H/ (/ IDR/ (/ i/ -/ 1/ )/ )/ ,/ 由于/ 没有/ 当前/ 节点/ Ri/ 的/ H/ (/ IDRi/ )/ ,/ 而/ 无法/ 计算/ 共享/ 密钥/ ,/ 从而/ 不能/ 正确/ 解密/ 路由/ 信息/ ,/ 因此/ 仅/ 有/ 合法/ 的/ 路由/ 节点/ 才能/ 得到/ 正确/ 的/ 路由/ 信息/ ;/ 同时/ 响应/ 路径/ 中/ 各/ 节点/ 的/ 填充/ 机制/ 使/ 通信/ 数据包/ 大小/ 不变/ ,/ 方案/ 可/ 抵抗/ 流量/ 分析/ 等/ 攻击/ ./ (/ 2/ )/ 抗/ 主动攻击/ ./ 若/ 窃听/ 者/ 捕获/ Ri/ 与/ Ri/ -/ 1/ 间/ 的/ 共享/ 密钥/ ,/ 窃听/ 者/ 仅/ 能/ 获得/ Ri/ +/ 1/ 的/ H/ (/ IDRi/ +/ 1/ )/ ,/ 并/ 不能/ 获得/ 其它/ 路由/ 节点/ 的/ 任何/ 信息/ ./ 假设/ 窃听/ 者/ 希望/ 跳过/ 节点/ Ri/ +/ 1/ 并/ 把/ 下/ 一/ 节点/ 设为/ Rk/ ,/ 当/ 节点/ Rk/ 收/ Page10/ 到/ 路由/ 信息/ 后/ 根据/ 算法/ 2/ 取出/ 堆栈/ SP/ 的/ 栈顶/ 元素/ LRi/ +/ 1/ =/ SP/ ./ Get/ (/ )/ ,/ 计算/ FRk/ =/ FRk/ -/ 1/ / H/ (/ IDRk/ )/ 后/ ,/ 显然/ LRi/ +/ 1/ !/ =/ H/ (/ FRk/ )/ ,/ 则/ Rk/ 拒绝/ 转发/ 数据/ ,/ 保证/ 了/ 数据/ 转发/ 链路/ 的/ 真实性/ ./ (/ 3/ )/ 信息/ 的/ 极小量/ 泄露/ ./ 链路/ 中/ 各/ 节点/ 仅/ 知晓/ 其/ 前驱/ 节点/ 和/ 后继/ 节点/ 的/ 假名/ 信息/ 及/ 网络地址/ ,/ 无法/ 获知/ 其它/ 节点/ 及/ L/ -/ TIS/ 与/ R/ -/ TIS/ 的/ 相关/ 信息/ ./ (/ 4/ )/ 路由/ 的/ 可/ 鉴别/ 性/ ./ 链路/ 中/ 的/ 各/ 节点均/ 能/ 确认/ 它/ 是/ 链路/ 的/ 一部分/ ,/ 并且/ 每个/ 节点/ 都/ 可/ 确认/ 数据/ 信息/ 来源/ 的/ 真实性/ ./ (/ 5/ )/ 响应/ 数据/ 的/ 可验证/ 性/ ./ 链路/ 中/ 各/ 节点均/ 能/ 通过/ 前驱/ 节点/ 的/ 签密/ 信息/ 验证/ 转发/ 数据/ 的/ 真实性/ ,/ 且/ 只有/ 合法/ 的/ 后继/ 节点/ 才能/ 解密/ 前驱/ 节点/ 的/ 签密/ 信息/ ./ 3.2/ ./ 4/ 可信性/ 分析/ 链路/ 建立/ 阶段/ 对/ 各/ 节点/ 的/ 可信性/ 使用/ 相关/ 策略/ [/ 15/ ]/ 进行/ 验证/ ,/ 只有/ 通过/ 可信性/ 验证/ 的/ 节点/ 才能/ 接入/ ,/ 增强/ 了/ 链路/ 的/ 可信性/ ,/ 物品/ 信息/ 传输/ 过程/ 中/ ,/ 建立/ 了/ 以/ TPM/ 为/ 核心/ 的/ 节点/ 安全/ 保护/ 机制/ ,/ 以及/ 节点/ 接入/ 时/ 的/ 可信性/ 验证/ 机制/ ,/ 确保/ 物/ 联网/ 安全/ 传输/ 模型/ 中/ 查询/ 响应/ 链路/ 的/ 可信性/ ,/ 增强/ 了/ 物品/ 信息/ 传输/ 过程/ 的/ 安全性/ ./ 3.3/ 安全/ 传输/ 模型/ 效率/ 分析/ 物/ 联网/ 安全/ 传输/ 模型/ 中/ 的/ 部分/ 运算/ (/ 如/ 加密/ // 解密/ 、/ 生成/ 随机数/ 、/ 散列/ 运算/ 等/ )/ 是/ 由/ TPM/ 完成/ ,/ 不/ 消耗/ 平台/ CPU/ 的/ 计算能力/ ,/ TPM/ 作为/ 独立/ 的/ 计算/ 单图/ 10/ 物/ 联网/ 安全/ 体系/ 架构/ 元/ ,/ 可以/ 提高/ 物/ 联网/ 安全/ 传输/ 模型/ 中/ 协议/ 的/ 执行/ 效率/ ./ 身份/ 合法/ 且/ 平台/ 可信/ 的/ L/ -/ ONS/ 申请/ 成员/ 证书/ 后/ 可持/ 其/ 多次/ 申请/ 查询/ 服务/ ,/ 证书/ 机制/ 的/ 使用/ 提高/ 了/ 物/ 联网/ 安全/ 传输/ 模型/ 的/ 工作效率/ ,/ 同时/ 有效/ 减少/ L/ -/ ONS/ 的/ 完整性/ 度量/ 负载/ ,/ 防止/ Root/ -/ ONS/ 和/ TAS/ 成为/ 系统/ 瓶颈/ ./ 查询/ 机制/ 中/ 第一轮/ 交互/ 即/ 对/ L/ -/ ONS/ 的/ 身份/ 合法性/ 和/ 平台/ 可信性/ 进行/ 验证/ ,/ 若/ 验证/ 未/ 通过/ ,/ TAS/ 和/ Root/ -/ ONS/ 在/ 第一轮/ 后/ 就/ 终止/ 交互/ ,/ 降低/ 了/ 传输/ 模型/ 的/ 执行/ 负载/ ./ 4/ 物/ 联网/ 安全/ 体系/ 架构/ 基于/ 本/ 传输/ 模型/ 的/ 物/ 联网/ 安全/ 体系/ 架构/ 如图/ 10/ 所示/ ,/ 其中/ 物/ 联网/ 管理中心/ CA/ -/ IoT/ 是/ 一级/ 管理中心/ ,/ 制定/ 和/ 发布/ 总体/ 标准/ ,/ 并/ 对/ 第二级/ 的/ 各/ 地区/ 的/ Root/ -/ ONS/ 和/ TAS/ 进行/ 管理/ (/ Root/ -/ ONS/ 和/ TAS/ 可/ 由/ 物理/ 环境/ 中/ 同一/ 台/ 服务器/ 实现/ ,/ 可合/ 称为/ TRoot/ -/ ONS/ )/ ;/ 第二级/ 为/ 相关/ 地区/ 的/ TRoot/ -/ ONS/ ,/ 负责/ 验证/ 本/ 地区/ L/ -/ ONS/ 身份/ 合法性/ 和/ 平台/ 可信性/ ,/ 响应/ 查询/ 服务/ ,/ 同时/ 可/ 备份/ 本/ 地区/ TIS/ 中/ 相关/ 物品/ 的/ 信息/ ;/ 第三级/ 为/ 本地/ 物/ 联网/ 系统/ ,/ 负责/ 物品/ 标签/ 编码/ 的/ 读取/ 、/ 处理/ 、/ 发送/ 和/ 申请/ 查询/ 服务/ 等/ 操作/ ./ TRoot/ -/ ONS/ 加入/ 安全/ 物/ 联网/ 系统/ 时/ ,/ CA/ -/ IoT/ 对/ 其/ 身份/ 合法性/ 及/ 平台/ 可信性/ 进行/ 验证/ ,/ 仅/ 对/ 通过/ 验证/ 的/ TRoot/ -/ Page11ONS/ 颁发/ 身份证/ 书/ ,/ 同时/ CA/ -/ IoT/ 定期/ 对系统/ 成员/ 进/ 身份/ 合法性/ 和/ 平台/ 可信性/ 验证/ ,/ 将/ 属性/ 发生变化/ 的/ 成员/ 移出/ 系统/ ,/ 确保/ 物/ 联网/ ONS/ 查询/ 系统/ 的/ 可信性/ ,/ 同时/ 各/ 地区/ TRoot/ -/ ONS/ 形成/ 分布式/ 查询/ 系统/ ,/ 来/ 受理/ L/ -/ ONS/ 查询/ 申请/ ./ 本/ 文物/ 联网/ 安全/ 体系/ 架构/ 除/ 安全性/ 、/ 高效性/ 、/ 可信性/ 和/ 匿名性/ 等/ 特点/ 外/ ,/ 其/ 还/ 具有/ 扩展性/ 好/ 、/ 健壮性/ 高和前/ 向/ 安全/ 的/ 特点/ ./ (/ 1/ )/ 扩展性/ 好/ 当/ 某/ 地区/ 需/ 部署/ 新/ 的/ 查询/ 系统/ 时/ ,/ 新/ 成员/ 只/ 需向/ CA/ -/ IoT/ 申请/ 注册/ ,/ CA/ -/ IoT/ 为/ 身份/ 合法/ 且/ 平台/ 可信/ 的/ 新/ 成员/ 颁发/ 身份证/ 书/ ,/ 在/ CA/ -/ IoT/ 的/ 协助/ 下/ 系统/ 成员/ 更新/ 相关/ 成员/ 信息/ ,/ 使/ 各/ 成员/ 形成/ 相互协作/ 的/ 整体/ ./ (/ 2/ )/ 健壮性/ 高/ 本文/ 的/ 安全/ 物/ 联网/ 中/ 采用/ 分布式/ 的/ 查询/ 体系/ ,/ 即/ 各/ 地区/ TRoot/ -/ ONS/ 相互协作/ 完成/ L/ -/ ONS/ 的/ 查询/ 服务/ ,/ 这种/ 任务/ 分级/ 处理/ 的/ 查询/ 体系/ 可/ 有效/ 防止/ 个别/ TRoot/ -/ ONS/ 由于/ 负载/ 过重/ 而/ 成为/ 系统/ 瓶颈/ ,/ 同时/ 物品/ 信息/ 的/ 区域/ 备份/ 机制/ 可/ 保证/ 在/ 相关/ TIS/ 无法/ 正常/ 工作/ 时/ ,/ 物品/ 信息/ 机制/ 可/ 顺利进行/ ./ (/ 3/ )/ 前向/ 安全性/ 假设/ L/ -/ ONS/ 的/ 第/ i/ 次/ 查询/ 申请/ 密钥/ ki/ 泄露/ ,/ 即/ 攻击者/ 获悉/ 信息/ Xi/ -/ 1/ 和/ Ni/ -/ 1/ ,/ 但是/ 攻击者/ 无法/ 从/ 信息/ Xi/ -/ 1/ 和/ Ni/ -/ 1/ 推导/ 出/ 密钥/ ki/ +/ 1/ 与/ ki/ -/ 1/ ,/ 保证/ 了/ 物/ 联网/ 安全/ 体系/ 模型/ 中/ 查询/ 系统/ 的/ 前/ 向/ 安全性/ ./ 5/ 结束语/ 本文/ 提出/ 物/ 联网/ 安全/ 传输/ 模型/ ,/ 该/ 模型/ 对/ 传统/ 物/ 联网/ 中/ ONS/ 查询/ 机制/ 及/ 物品/ 信息/ 传输/ 过程/ 进行/ 改进/ ./ 在/ ONS/ 查询/ 机制/ 中/ 加入/ 匿名/ 认证/ 过程/ ,/ 仅为/ 经过/ 授权/ 且/ 可信/ 的/ L/ -/ ONS/ 提供/ 查询/ 服务/ ,/ 防止/ 非/ 授权/ L/ -/ ONS/ 查询/ 物品/ 信息/ ;/ 采用/ 可信/ 匿名/ 通信/ 过程/ 完成/ 物品/ 详细信息/ 的/ 传输/ ,/ 增强/ 物品/ 信息/ 传输/ 过程/ 的/ 安全性/ ,/ 防止/ 攻击者/ 对/ 其/ 进行/ 流量/ 分析/ 、/ 窃听/ 等/ 网络攻击/ 行为/ ./ 分析表明/ ,/ 物/ 联网/ 安全/ 传输/ 模型/ 具有/ 安全性/ 、/ 匿名性/ 、/ 可信性/ 、/ 高效性/ 和/ 抗/ 攻击性/ 等/ 特点/ ;/ 本文/ 的/ 物/ 联网/ 安全/ 体系/ 架构/ 具有/ 扩展性/ 好/ 、/ 健壮性/ 高和前/ 向/ 安全/ 的/ 特点/ ./ 本/ 模型/ 的/ 创新/ 点/ 是/ 提出/ 了/ 一个/ 传输/ 模型/ 框架/ ,/ 且/ 给出/ 了/ 可行/ 的/ 协议/ 实现/ 方案/ ./ 本/ 模型/ 中/ L/ -/ ONS/ 和/ R/ -/ ONS/ 是/ 对称/ 的/ ,/ 在/ 实际/ 应用/ 中/ 可以/ 将/ 两个/ 功能/ 合并/ 在/ 同一个/ 本地网络/ 之中/ ,/ 以/ 实现/ 本地网络/ 请求/ 服务/ 与/ 远程/ 网络/ 的/ 响应/ 服务/ 功能/ ./ 

