Page1/ 扩展/ 不/ 干扰/ 模型/ (/ ENISM/ )/ 及/ 基于/ CSP/ 的/ 描述/ 和/ 验证/ 方法/ 崔隽/ 黄皓/ 高晓春/ 1/ )/ (/ 南京大学/ 软件/ 新/ 技术/ 国家/ 重点/ 实验室/ 南京/ 210093/ )/ 2/ )/ (/ 南京大学/ 计算机科学/ 与/ 技术/ 系/ 南京/ 210093/ )/ 摘要/ 在/ 不/ 干扰理论/ 的/ 基础/ 上/ ,/ 提出/ 扩展/ 不/ 干扰/ 模型/ ENISM/ 及其/ 验证/ 方法/ ,/ 用以/ 描述/ 和/ 分析/ 操作系统/ 中/ 的/ 信息流/ 策略/ ./ 工作/ 包括/ :/ (/ 1/ )/ 依据/ 系统/ 功能模块/ 定义/ 多个/ 执行/ 域/ ,/ 以/ 即将/ 执行/ 的/ 可能/ 动作/ 序列/ 集合/ 与/ 可/ 读取/ 的/ 数据/ 存储/ 值/ 集合/ 一同/ 作为/ ENISM/ 定义/ 执行/ 域/ 安全/ 状态/ 的/ 基础/ ;/ (/ 2/ )/ 给出/ 判定/ 系统/ 中/ 不/ 存在/ 违反/ 策略/ 的/ 执行/ 轨迹/ 和/ 数据/ 流动/ 的/ 条件/ ENISM/ -/ CC/ ;/ (/ 3/ )/ 基于/ 通信/ 顺序进程/ 给出/ ENISM/ -/ CC/ 的/ 语义/ 及/ 操作系统/ 模块/ 设计/ 的/ 形式化/ 描述/ 和/ 验证/ 方法/ ./ 关键词/ 不/ 干扰/ 模型/ ;/ 通信/ 顺序进程/ ;/ 形式化/ 描述/ ;/ 形式化/ 验证/ ;/ 完整性/ 1/ 引言/ 特性/ ,/ 是/ 目前/ 操作系统/ 安全/ 验证/ 的/ 主要/ 方法/ 之一/ ./ 信息流/ 分析/ 的/ 方法/ 使/ 我们/ 能够/ 清楚/ 地/ 理解/ 系统/ 内部/ 信息/ 的/ 流动/ 方向/ ,/ 从/ 独立/ 于/ 系统/ 操作/ 的/ 另/ 一个/ 角度观察/ 系统/ 的/ 实际/ 行为/ ./ 操作系统/ 的/ 很多/ 安全/ 属性/ 都/ 可用/ 信息流/ 模型/ 来/ 形式化/ 地/ 分析/ 操作系统/ 的/ 安全/ Page2/ 以/ 表述/ 成/ 一系列/ 相关/ 的/ 信息流/ 策略/ ,/ 比如/ 机密性/ 、/ 完整性/ 、/ 隔离/ 性/ 、/ 不可/ 旁路/ 性/ 等/ ./ 通过/ 信息流/ 分析/ ,/ 我们/ 可以/ 证实/ 一个/ 操作系统/ 的/ 设计/ 是否/ 能够/ 满足/ 给定/ 的/ 信息流/ 策略/ 所/ 表达/ 的/ 安全/ 属性/ ./ 信息流/ 分析/ 方面/ 的/ 研究/ 工作/ 很多/ ,/ Goguen/ 和/ Meseguer/ 提出/ 的/ 不/ 干扰/ 模型/ [/ 1/ ]/ 是/ 最/ 主要/ 的/ 研究成果/ 之一/ ./ 不/ 干扰/ 模型/ 通过观察/ 信息/ 域/ 中/ 信息/ 值/ 的/ 改变/ 来/ 感知/ 信息/ 的/ 流动/ ,/ 而/ 不是/ 简单/ 依靠/ 对/ 读写操作/ 的/ 考察/ 来/ 推测/ 信息/ 流向/ ,/ 具有/ 比/ 其它/ 信息流/ 模型/ 更好/ 地/ 发现/ 确定性/ 系统/ 中/ 各种/ 存储/ 隐蔽/ 信道/ 问题/ 的/ 能力/ ./ Haigh/ 、/ Young/ [/ 2/ ]/ 和/ Rushby/ [/ 3/ ]/ 等/ 人/ 在/ 不/ 干扰/ 模型/ 基础/ 上/ 在/ 信道/ 控制/ 方面/ 对/ 其/ 进一步/ 探讨/ ,/ 提出/ 了/ 干扰/ 的/ 非/ 传递性/ ./ 谢钧/ [/ 4/ ]/ 等/ 则/ 将/ 不/ 干扰/ 模型/ 从/ 确定性/ 系统/ 推广/ 到/ 非/ 确定/ 系统/ ./ 虽然/ 不/ 干扰/ 模型/ 在/ 信息流/ 策略/ 的/ 形式化/ 描述/ 和/ 验证/ 方面/ 有/ 很/ 好/ 的/ 表现/ ,/ 但/ 不/ 干扰/ 模型/ 主要/ 关注/ 的/ 仍/ 是/ 存储/ 信息/ 的/ 改变/ ,/ 忽略/ 了/ 执行/ 轨迹/ 的/ 变化/ ./ 尽管/ 广义/ 上/ 讲/ ,/ 信息/ 域/ 执行/ 轨迹/ 的/ 改变/ 也/ 是/ 一种/ 信息/ 的/ 表征/ ,/ 但是/ 在/ 具体/ 的/ 系统/ 策略/ 验证/ 过程/ 中/ 很/ 难/ 直观/ 地/ 判断/ 目标/ 域/ 未来/ 执行/ 的/ 路径/ 是否/ 发生/ 了/ 改变/ ./ 仅/ 依靠/ 考察/ 存储/ 值/ 的/ 改变/ 并/ 不能/ 完全/ 反映/ 出/ 执行/ 轨迹/ 的/ 变化/ ,/ 而/ 执行/ 轨迹/ 的/ 变化/ ,/ 特别/ 是/ 安全控制/ 模块/ 轨迹/ 的/ 改变/ 或/ 被/ 旁路/ 往往/ 会/ 产生/ 极其/ 严重/ 的/ 后果/ ./ 因此/ ,/ 为了/ 更好/ 地/ 表达/ 和/ 分析/ 系统/ 的/ 信息流/ 策略/ ,/ 信息/ 域/ 的/ 行为/ 执行/ 是否/ 受到/ 其它/ 域/ 的/ 干扰/ 也/ 是/ 信息流/ 分析/ 工作/ 必须/ 考察/ 的/ 对象/ ./ Ryan/ [/ 5/ ]/ 、/ Roscoe/ [/ 6/ ]/ 和/ Graham/ [/ 7/ ]/ 都/ 分别/ 使用/ 进程/ 代数/ 的/ 方法/ 从/ 不同/ 的/ 视角/ 描述/ 了/ 不/ 干扰/ 模型/ 的/ 语义/ ,/ 并/ 阐述/ 了/ 高/ 密级信息/ 域/ 的/ 执行/ 轨迹/ 对/ 低/ 密级信息/ 域/ 的/ 输出/ 及/ 可/ 执行/ 动作/ 集合/ 的/ 影响/ ,/ Roscoe/ 和/ Goldsmith/ [/ 8/ ]/ 在/ 此基础/ 上/ 还/ 针对/ 非/ 传递/ 特性/ 作/ 了/ 进一步/ 探讨/ ,/ 并/ 给出/ 了/ 判定/ 干扰/ 性/ 存在/ 的/ 方法/ ./ 马/ 建平/ [/ 9/ ]/ 等/ 则/ 将/ 不/ 干扰/ 关系/ 定义/ 为/ 如果/ 一个/ 信息/ 域/ A/ 不/ 干扰/ 另/ 一个/ 信息/ 域/ B/ ,/ 则/ A/ 的/ 行为/ 既/ 不会/ 改变/ B/ 内/ 存储/ 变量/ 的/ 值/ ,/ 也/ 不会/ 影响/ B/ 当前/ 状态/ 下/ 可/ 执行/ 的/ 动作/ ./ 上述/ 文章/ 表明/ ,/ 对/ 执行/ 序列/ 的/ 描述/ 有助于/ 分析/ 信息/ 域/ 之间/ 的/ 不/ 干扰/ 属性/ ,/ 然而/ ,/ 本文/ 认为/ 还/ 可以/ 在/ 3/ 个/ 方面/ 做/ 进一步/ 探讨/ ./ 首先/ ,/ 用/ 进程/ 代数/ 描述/ 不/ 干扰/ 属性/ ,/ 主要/ 描述/ 的/ 是/ 行为/ 本身/ ,/ 而/ 忽视/ 了/ 输入/ 数据/ 对/ 行为/ 执行/ 的/ 影响/ ,/ 往往/ 将/ 具有/ 不同/ 输入/ 值/ 的/ 同一/ 输入/ 事件/ 视为/ 同一/ 事件/ 来/ 考虑/ ,/ 这/ 就/ 屏蔽/ 或/ 减弱/ 了/ 不同/ 输入/ 值/ 对/ 信息/ 域/ 的/ 干扰/ 作用/ ./ 其次/ ,/ 本文/ 认为/ 当前/ 状态/ 下/ 可/ 执行/ 的/ 序列/ 集合/ 比/ 当前/ 状态/ 下/ 可/ 执行/ 的/ 事件/ 集合/ 更能/ 准确/ 地/ 反映/ 信息/ 域/ 内/ 执行/ 的/ 改变/ ,/ 可/ 执行/ 的/ 序列/ 集合/ 可/ 反映/ 出/ 目标/ 域/ 未来/ 的/ 执行/ 趋势/ ,/ 其/ 不仅/ 可以/ 反映/ 出/ 未来/ 每/ 一个/ 状态/ 的/ 可/ 执行/ 事件/ ,/ 更/ 将/ 各个/ 状态/ 联系/ 起来/ 更/ 精确/ 地/ 考察/ 目标/ 域/ 的/ 执行/ 改变/ ./ 最后/ ,/ 目标/ 域/ 的/ 执行/ 受到/ 了/ 干扰/ 还是/ 信息/ 值/ 受到/ 了/ 干扰/ 并/ 不/ 总是/ 一致/ 的/ ,/ 应/ 分别/ 讨论/ ./ 在/ 实际/ 的/ 信息系统/ 中/ ,/ 两个/ 合作/ 的/ 模块/ 一定/ 存在/ 着/ 合理/ 的/ 信息/ 流动/ (/ 如/ 访问/ 控制器/ 的/ 输入/ 模块/ 和/ 决策/ 模块/ )/ ,/ 但/ 这/ 并/ 不/ 表明/ 合作/ 模块/ 之间/ 一定/ 允许/ 通过/ 交互/ 数据/ 改变/ 对方/ 的/ 执行/ 轨迹/ (/ 如/ 输入/ 模块/ 只许/ 给/ 决策/ 模块/ 传递/ 决策/ 信息/ ,/ 而/ 不/ 允许/ 改变/ 决策/ 模块/ 的/ 决策/ 过程/ )/ ./ 因此/ ,/ 我们/ 认为/ 应/ 针对/ 目标/ 操作系统/ 的/ 执行/ 不/ 干扰/ 和/ 存储/ 不/ 干扰/ 分别/ 制定/ 安全策略/ ./ 基于/ 以上/ 考虑/ ,/ 本文/ 提出/ 更/ 适于/ 描述/ 操作系统/ 的/ 信息流/ 策略/ 的/ 扩展/ 不/ 干扰/ 安全/ 模型/ (/ ENISM/ )/ 及/ 验证/ 系统/ 设计/ 是否/ 满足/ 该/ 策略/ 的/ 验证/ 方法/ ./ 我们/ 将/ 各个/ 功能/ 相对/ 独立/ 的/ 系统/ 模块/ 均/ 视作/ 执行/ 域/ ./ ENISM/ 在/ 传统/ 不/ 干扰/ 模型/ 的/ 基础/ 上/ 增加/ 了/ 未来/ 可能/ 执行/ 的/ 动作/ 序列/ 集合/ 的/ 改变/ 作为/ 分析/ 目标/ 域/ 安全/ 状态/ 是否/ 发生/ 改变/ 的/ 依据/ 之一/ ,/ 动作/ 序列/ 集合/ 和/ 信息/ 存储/ 值/ 集合/ 一同/ 考察/ 更能/ 准确/ 地/ 反映/ 出/ 目标/ 域/ 的/ 当前/ 状态/ ;/ ENISM/ 将/ 输入/ 数据/ 值/ 反映/ 在/ 输入/ 动作/ 中/ ,/ 将/ 能够/ 接收/ 不同/ 输入/ 数据/ 的/ 同一/ 输入/ 动作/ 看作/ 同一/ 动作/ 的/ 不同/ 执行/ ,/ 以/ 反映/ 不同/ 输入/ 对/ 目标/ 域/ 的/ 影响/ ;/ ENISM/ 分别/ 考察/ 目标/ 域/ 的/ 执行/ 不/ 干扰/ 条件/ 和/ 数据/ 存储/ 的/ 不/ 干扰/ 条件/ ,/ 有助于/ 从/ 执行/ 域/ 之间/ 的/ 执行/ 干扰/ 和/ 存储/ 干扰/ 两/ 方面/ 分析/ 、/ 描述/ 和/ 验证/ 系统/ 的/ 信息流/ 策略/ ./ 为了/ 能够/ 形式化/ 描述/ 一个/ 实际/ 的/ 操作系统/ 设计/ ,/ 并/ 正确/ 有效/ 地/ 描述/ 、/ 分析/ 和/ 验证/ 系统/ 的/ 信息流/ 策略/ ,/ 本文/ 还/ 通过/ 通信/ 顺序进程/ (/ CSP/ )/ [/ 10/ -/ 11/ ]/ 来/ 实现/ 系统/ 设计/ 的/ 形式化/ 描述/ 和/ 策略/ 的/ 语义/ 表述/ ./ CSP/ 用/ 一组/ 通信/ 进程/ 来/ 描述/ 系统/ 行为/ ,/ 能够/ 准确/ 地/ 描述/ 系统/ 的/ 执行/ 轨迹/ ,/ 这/ 正是/ 描述/ 行为/ 不/ 干扰/ 属性/ 所/ 需要/ 的/ ./ 本文/ 给出/ 基于/ CSP/ 的/ 形式化/ 描述/ 系统/ 设计/ 的/ 方法/ ,/ 用/ CSP/ 诠释/ ENISM/ 中/ 判定/ 系统/ 安全性/ 条件/ 的/ 语义/ ,/ 并/ 使用/ CSP/ 验证/ 工具/ FDR2/ ①/ 针对/ 操作系统/ 中/ 的/ 引用/ 监视器/ 设计/ 的/ 实例/ 演示/ 策略/ 制定/ 、/ 设计/ 描述/ 、/ 信息流/ 分析/ 、/ 自动化/ 验证/ 的/ 全过程/ ./ 本文/ 第/ 2/ 节/ 给出/ 扩展/ 不/ 干扰/ 模型/ ENISM/ 的/ 定义/ ,/ 提出/ 执行/ 不/ 干扰/ 和/ 存储/ 不/ 干扰/ 的/ 概念/ ,/ 并/ 在/ 此基础/ 上/ 给出/ 基于/ 单步/ 状态/ 的/ 安全/ 展开/ 条件/ (/ unwindingconditions/ )/ ,/ 即/ 设计/ 中/ 存在/ 违背/ 信息流/ 策略/ 的/ 执行/ ①/ FDR2/ 用户手册/ ./ http/ :/ // // www/ ./ fsel/ ./ com/ // documentation/ // Page3/ 轨迹/ 或/ 数据/ 流动/ 的/ 充分条件/ (/ ENISM/ -/ CC/ )/ ;/ 第/ 3/ 节/ 基于/ 通信/ 顺序进程/ CSP/ 给出/ 系统/ 设计/ 的/ 形式化/ 描述/ 方法/ 和/ ENISM/ -/ CC/ 的/ 语义/ ,/ 并/ 给出/ 形式化/ 分析/ 和/ 验证/ 信息流/ 策略/ 的/ 方法/ ;/ 第/ 4/ 节以/ 引用/ 监视器/ 为例/ ,/ 说明/ ENISM/ 的/ 有效性/ 和/ 形式化/ 验证/ 方法/ 的/ 可行性/ ./ 2/ 扩展/ 不/ 干扰/ 模型/ 2.1/ 扩展/ 不/ 干扰/ 模型/ 的/ 定义/ 本文/ 在/ 研究/ 信息/ 域/ 不/ 干扰理论/ 的/ 基础/ 上/ ,/ 提出/ 了/ 扩展/ 不/ 干扰/ 模型/ ENISM/ ./ 该/ 模型/ 将/ 执行/ 域/ 中/ 即将/ 执行/ 的/ 动作/ 序列/ 和/ 执行/ 域/ 主体/ 可/ 观测/ 的/ 存储/ 信息/ 一同/ 作为/ 考察/ 执行/ 域/ 完整性/ 的/ 对象/ ./ 因此/ ,/ 除/ 保留/ 传统/ 不/ 干扰/ 模型/ 所/ 包含/ 的/ 执行/ 域/ 、/ 状态/ 、/ 值域/ 、/ 状态/ 转换/ 函数/ 、/ 取值/ 函数/ 等/ 元素/ 外/ ,/ 还/ 细化/ 了/ 执行/ 域/ 的/ 定义/ ,/ 增加/ 了/ 对/ 执行/ 域/ 上/ 行为/ 集合/ 和/ 数据/ 存储/ 集合/ 的/ 描述/ ,/ 并/ 将/ 输入/ 数据/ 作为/ 输入/ 动作/ 的/ 一个/ 属性/ 引入/ 到/ 定义/ 中/ ,/ 以/ 方便/ 描述/ 输入/ 数据/ 的/ 不同/ 对/ 执行/ 域/ 可/ 观测/ 的/ 存储/ 值/ 和/ 执行/ 序列/ 的/ 影响/ ./ 该/ 模型/ 还/ 定义/ 了/ 执行/ 域/ 上/ 某个/ 执行/ 状态/ 之前/ 和/ 之后/ 的/ 执行/ 序列/ ,/ 通过/ 描述/ 已/ 执行/ 和/ 即将/ 执行/ 的/ 动作/ 序列/ 来/ 推测/ 可能/ 存在/ 的/ 干扰/ ./ 下面/ 首先/ 用/ 状态/ 转换/ 机来/ 描述/ 一个/ 确定/ 系统/ ,/ 然后/ 针对/ 给定/ 的/ 不/ 干扰/ 策略/ 给出/ 系统/ 信息流/ 安全/ 的/ 定义/ 以及/ 单步/ 展开/ 条件/ ./ 定义/ 1/ ./ 系统/ M/ 包括/ 以下/ 元素/ :/ 系统/ 中/ 所有/ 的/ 数据/ 对象/ 的/ 集合/ O/ ;/ 系统/ 中/ 的/ 数据/ 对象/ 可能/ 取值/ 的/ 集合/ V/ ;/ 系统/ 行为/ 集合/ A/ ./ 系统/ 行为/ ax/ ∈/ A/ ,/ x/ 描述/ 了/ 动作/ a/ 的/ 输入/ 值/ ,/ 以/ 区分/ 同一/ 动作/ 接受/ 的/ 不同/ 输入/ ./ 如果/ a/ 没有/ 输入/ ,/ 则/ x/ 取值/ ε/ ;/ 系统/ 状态/ 集合/ S/ ,/ 系统/ 的/ 初始状态/ 记为/ s0/ ;/ 系统/ 执行/ 域/ 集合/ D/ ,/ 一个/ 域/ u/ ∈/ D/ 包含/ 了/ 可/ 在/ 这个/ 域/ 上/ 执行/ 的/ 行为/ 集合/ uI/ 和/ 这个/ 域/ 上/ 可/ 观测/ 的/ 数据/ 存储/ 的/ 集合/ uD/ ./ 且/ D/ 上/ 存在/ 关系/ ∪/ ,/ 有/ / u/ ,/ v/ ∈/ D/ ,/ u/ ∪/ v/ ∈/ D/ ;/ 行为/ 可/ 执行/ 判断/ 函数/ enabled/ :/ S/ ×/ A/ →/ Boolean/ ,/ enabled/ (/ s/ ,/ ax/ )/ 表示/ 在/ 状态/ s/ 下/ 动作/ ax/ 是否/ 可/ 执行/ ;/ 单步/ 状态/ 转换/ 函数/ step/ :/ S/ ×/ A/ →/ S/ ./ 如果/ enabled/ (/ s/ ,/ ax/ )/ =/ true/ ,/ 则/ 在/ 状态/ s/ 下/ 执行/ 动作/ ax/ 后/ 系统/ 由/ 状态/ s/ 转化/ 为/ 状态/ step/ (/ s/ ,/ ax/ )/ ;/ 行为/ 执行/ 域/ 函数/ dom/ :/ A/ →/ D/ ,/ dom/ (/ ax/ )/ 表示/ 了/ 行为/ ax/ 所在/ 的/ 执行/ 域/ ;/ 信息/ 域/ 取值/ 函数/ values/ :/ S/ ×/ 2O/ →/ 2V/ ./ / Objs/ / O/ ,/ values/ (/ s/ ,/ Objs/ )/ 表示/ 在/ 状态/ s/ 下/ ,/ 数据/ 存储/ 集合/ Objs/ 中/ 元素/ 对应/ 取值/ 的/ 集合/ ;/ 系统/ 的/ 行为/ 执行/ 轨迹/ 集合/ Ts/ ./ Ts/ 记录/ 了/ 系统/ 由/ 状态/ s/ 开始/ 到/ 任意/ 时刻/ 为止/ 的/ 所有/ 可能/ 行为/ 序列/ 的/ 集合/ ;/ Ts/ ,/ u/ 则/ 表示/ 了/ Ts/ 在域/ u/ 上/ 的/ 行为/ 序列/ 的/ 集合/ ./ 且/ 有/ ε/ ∈/ Ts/ ,/ u/ ;/ ax/ / α/ ∈/ Ts/ ,/ u/ ,/ ε/ 表示/ 空串/ ,/ / 表示/ 行为/ 或/ 行为/ 序列/ 的/ 复合/ 运算符/ ,/ ax/ / α/ 表示/ 先/ 执行/ 行为/ ax/ ,/ 然后/ 执行/ 行为/ 序列/ α/ ;/ 系统/ 已/ 执行/ 的/ 行为/ 轨迹/ RTs/ ./ RTs/ 记录/ 了/ 系统/ 由/ 初始状态/ s0/ 转化/ 到/ 状态/ s/ 过程/ 中/ 的/ 行为/ 序列/ ;/ RTs/ ,/ u/ 则/ 表示/ 了/ RTs/ 在域/ u/ 上/ 的/ 行为/ 序列/ ;/ 系统/ 执行/ 函数/ run/ :/ S/ ×/ A/ / →/ S/ ,/ α/ ∈/ Ts/ 时/ ,/ run/ (/ s/ ,/ α/ )/ 有/ 定义/ ,/ 并且/ 满足/ run/ (/ s/ ,/ ε/ )/ =/ s/ ,/ run/ (/ s/ ,/ ax/ / α/ )/ =/ run/ (/ step/ (/ s/ ,/ ax/ )/ ,/ α/ )/ ./ 为了/ 能够/ 描述/ 同一/ 行为/ 的/ 不同/ 输入/ ,/ 我们/ 定义/ 集合/ A/ 上/ 的/ 关系/ R/ ./ 对于/ A/ 中/ 的/ 任意/ 两个/ 行为/ ,/ 如果/ 它们/ 是/ 执行/ 的/ 同/ 一段/ 代码/ ,/ 则/ 认为/ 它们/ 满足/ 关系/ R/ ,/ 显然/ 关系/ R/ 满足/ 自/ 反/ 、/ 对称/ 和/ 传递性/ ./ 基于/ 关系/ R/ 可以/ 建立/ 等价/ 类/ 集合/ A/ // R/ ,/ 记为/ RA/ ,/ 有/ 定义/ {/ [/ ax/ ]/ }/ =/ RA/ =/ {/ c/ |/ c/ ∈/ A/ ∧/ cRax/ }/ ./ 为/ 描述/ 方便/ 将/ [/ ax/ ]/ 简记/ 为/ a/ ,/ 下文/ 中会用/ a/ 来/ 描述/ 可/ 接受/ 不同/ 输入/ 的/ 一类/ R/ 等价/ 行为/ ./ 系统/ 的/ 信息流/ 策略/ 可以/ 定义/ 为/ 集合/ Du/ =/ {/ uI/ ,/ uD/ |/ / u/ ∈/ D/ }/ 上/ 的/ 关系/ 及其/ 补/ 关系/ =/ Du/ ×/ Du/ \/ ./ 并/ 分别/ 称/ 和/ 为/ 干扰/ 关系/ 和/ 不/ 干扰/ 关系/ ./ 对于/ 任意/ 的/ u/ ,/ v/ ∈/ D/ ,/ uDvI/ ,/ uIvI/ 反映/ 了域/ v/ 的/ 行为/ 执行/ 可能/ 受到/ 域/ u/ 的/ 执行/ 或/ 可/ 观测/ 数据/ 值/ 的/ 影响/ ,/ 而/ uDvD/ ,/ uIvD/ 反映/ 了域/ v/ 可/ 观测/ 的/ 数据/ 值/ 可能/ 受到/ 域/ u/ 的/ 执行/ 或/ 可/ 观测/ 数据/ 值/ 的/ 影响/ ./ 下面/ 依据/ 给定/ 的/ 信息流/ 策略/ 定义/ 系统/ 的/ 信息流/ 安全/ ./ 在/ 定义/ 系统/ 的/ 信息流/ 安全/ 之前/ ,/ 首先/ 定义/ 系统/ 的/ 执行/ 安全性/ 和/ 存储/ 安全性/ ,/ 以/ 分别/ 描述/ 满足/ 信息流/ 策略/ 的/ 行为/ 和/ 信息/ 流动/ ./ 定义/ 2/ ./ 执行/ 安全性/ ./ 给定/ 系统/ M/ 以及/ 安全策略/ ,/ 如果/ / v/ ∈/ D/ ,/ α/ ∈/ Ts0/ 满足/ PurgeI/ (/ α/ ,/ v/ )/ ∈/ Ts0/ ∧/ Trun/ (/ s0/ ,/ α/ )/ ,/ v/ =/ Trun/ (/ s0/ ,/ PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ ,/ 则/ 称/ 系统/ M/ 满足/ 执行/ 安全性/ ./ 其中/ ,/ 提取/ 函数/ PurgeI/ 从/ 执行/ 序列/ α/ ∈/ A/ / 中/ 去除/ 所有/ 不/ 允许/ 干扰/ vI/ 的/ 行为/ ,/ 从而/ 得到/ 一个/ 新/ 的/ 序列/ ./ 提取/ 函数/ 的/ 定义/ 如下/ :/ PurgeI/ (/ ε/ ,/ v/ )/ =/ ε/ ;/ PurgeI/ (/ ax/ / α/ ,/ v/ )/ =/ ax/ / PurgeI/ (/ α/ )/ ,/ dom/ (/ ax/ )/ IvIPage4/ 定义/ 2/ 说明/ ,/ 如果/ 从/ 任意/ 可/ 执行/ 序列/ 中/ 去掉/ 所有/ 不/ 允许/ 干扰/ 域/ v/ 执行/ 的/ 行为/ 后/ ,/ 余下/ 的/ 行为/ 仍能/ 构成/ 一个/ 可/ 执行/ 序列/ ,/ 且/ 该/ 序列/ 的/ 执行/ 不/ 影响/ 域/ v/ 的/ 执行/ 轨迹/ ./ 定义/ 3/ ./ 存储/ 安全性/ ./ 给定/ 系统/ M/ 以及/ 安全策略/ ,/ / v/ ∈/ D/ ,/ α/ ∈/ Ts0/ ,/ 满足/ PurgeD/ (/ α/ ,/ v/ )/ ∈/ Ts0/ ∧/ values/ (/ run/ (/ s0/ ,/ α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ s0/ ,/ PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ ,/ 则/ 称/ 系统/ M/ 满足/ 存储/ 安全性/ ./ SoursesD/ (/ ε/ ,/ v/ )/ =/ {/ vD/ }/ ,/ SoursesD/ (/ ax/ / α/ ,/ v/ )/ =/ {/ dom/ (/ ax/ )/ I/ }/ ∪/ SoursesD/ (/ α/ )/ ,/ 烄/ {/ dom/ (/ ax/ )/ I/ }/ ∪/ {/ dom/ (/ ax/ )/ D/ }/ ∪/ SoursesD/ (/ α/ )/ ,/ / u/ ∈/ SoursesD/ (/ α/ ,/ v/ )/ ./ dom/ (/ ax/ )/ Iv/ ∧/ dom/ (/ ax/ )/ Dv/ 烅/ SoursesD/ (/ α/ )/ ,/ 烆/ 定义/ 3/ 说明/ ,/ 如果/ 从/ 任意/ 可/ 执行/ 序列/ 中/ 去掉/ 所有/ 不/ 允许/ 干扰/ 域/ v/ 的/ 可/ 观测/ 信息/ 值/ 存储/ 的/ 行为/ 后/ ,/ 余下/ 的/ 行为/ 仍能/ 构成/ 一个/ 可/ 执行/ 序列/ ,/ 且/ 该/ 序列/ 的/ 执行/ 不/ 影响/ 域/ v/ 的/ 可/ 观测/ 数据/ 值/ ./ 从/ SoursesD/ 函数/ 的/ 定义/ 可以/ 看出/ ,/ 要/ 保证/ 提取/ 之后/ 的/ 序列/ 仍/ 是/ 可/ 执行/ 序列/ ,/ 不仅/ 要/ 保留/ 允许/ 改变/ 域/ v/ 的/ 数据/ 值/ 的/ 域/ 行为/ ,/ 也/ 要/ 保留/ 允许/ 影响/ 这些/ 行为/ 执行/ 的/ 其它/ 域/ 的/ 行为/ ./ 由于/ 对/ 目标/ 域/ 执行/ 轨迹/ 集合/ 的/ 考察/ 侧重于/ 分析/ 存储/ 隐蔽/ 通道/ ,/ 而/ 对/ 目标/ 域/ 数据/ 值/ 的/ 考察/ 则/ 侧重于/ 解决/ 信道/ 控制/ 问题/ ,/ 所以/ 从/ 提取/ 函数/ PurgeI/ 、/ PurgeD/ 的/ 定义/ 可以/ 看出/ ,/ 对/ 目标/ 域/ 的/ 行为/ 集合/ 的/ 干扰/ 策略/ 支持/ 传递性/ ,/ 而/ 对/ 目标/ 域/ 的/ 数据/ 集合/ 的/ 干扰/ 策略/ 则/ 不/ 支持/ 传递性/ ./ 即/ 对于/ 任意/ 的/ u/ ,/ w/ ∈/ Du/ ,/ v/ ∈/ D/ ,/ 如果/ 策略/ 允许/ uvI/ 且/ vIw/ ,/ 则/ 策略/ 也/ 同样/ 允许/ uw/ ,/ 但是/ 即使/ 策略/ 允许/ uvD/ 且/ vDw/ ,/ 策略/ 也/ 不/ 一定/ 允许/ uw/ ./ 定义/ 4/ ./ 对于/ 给定/ 的/ 系统/ M/ 以及/ 安全策略/ ,/ 如果/ 对于/ M/ 中/ 的/ 任意/ 安全/ 域/ u/ ∈/ D/ ,/ 同时/ 满足/ 执行/ 安全性/ 和/ 存储/ 安全性/ ,/ 则/ 称/ 系统/ M/ 满足/ 安全策略/ ./ 定义/ 4/ 描述/ 了/ 如果/ 系统/ M/ 中/ 不/ 存在/ 违背/ 安全策略/ 的/ 信息/ 流动/ 和/ 不/ 被/ 安全策略/ 允许/ 的/ 执行/ 轨迹/ ,/ 则/ 可以/ 说/ 系统/ M/ 是/ 安全/ 的/ ./ 因此/ ,/ 定义/ 2/ 和/ 定义/ 3/ 给出/ 的/ 执行/ 安全性/ 和/ 存储/ 安全性/ 条件/ 就是/ 系统/ M/ 满足/ 安全策略/ 的/ 条件/ ./ 为了/ 便于/ 系统验证/ ,/ 下文/ 将/ 给出/ 并/ 证明/ 只/ 涉及/ 单步/ 状态/ 改变/ 的/ 展开/ 条件/ ./ 定理/ 1/ ./ ENISM/ 单步/ 展开/ 定理/ (/ ENISM/ -/ CC/ )/ ./ 对于/ 给定/ 的/ 系统/ M/ 和/ 安全策略/ ,/ 对于/ / s/ ,/ t/ ∈/ S/ ,/ v/ ∈/ D/ ,/ ax/ ∈/ A/ ,/ 如果/ 存在/ 状态/ 等价关系/ ~/ vI/ ,/ ~/ vD/ 满足/ 下列/ 条件/ ,/ 则/ 系统/ M/ 满足/ 安全策略/ ./ 其中/ ,/ 提取/ 函数/ PurgeI/ 从/ 执行/ 序列/ α/ ∈/ A/ / 中/ 去除/ 所有/ 不/ 允许/ 干扰/ vI/ 的/ 行为/ ,/ 从而/ 得到/ 一个/ 新/ 的/ 序列/ ./ 提取/ 函数/ 的/ 定义/ 如下/ :/ PurgeI/ (/ ε/ ,/ v/ )/ =/ ε/ ;/ PurgeI/ (/ ax/ / α/ ,/ v/ )/ =/ ax/ / PurgeI/ (/ α/ )/ ,/ dom/ (/ ax/ )/ IvI/ 其中/ ,/ SoursesD/ 函数/ 计算/ 由/ 所有/ 允许/ 干扰/ vD/ 的/ 执行/ 域/ 构成/ 的/ 集合/ (/ i/ )/ s/ ~/ vIt/ / Ts/ ,/ v/ =/ Tt/ ,/ v/ ;/ (/ ii/ )/ s/ ~/ vIt/ ∧/ enabled/ (/ s/ ,/ ax/ )/ ∧/ dom/ (/ ax/ )/ IvI/ ∧/ RTs/ ,/ TB/ =/ RTt/ ,/ TB/ / enabled/ (/ t/ ,/ ax/ )/ ∧/ step/ (/ s/ ,/ ax/ )/ ~/ vIstep/ (/ t/ ,/ ax/ )/ ;/ (/ TB/ =/ {/ ∪/ u/ |/ / u/ ∈/ D/ ,/ uIvI/ }/ )/ ;/ (/ iii/ )/ (/ dom/ (/ ax/ )/ IvI/ ∧/ enabled/ (/ s/ ,/ ax/ )/ / s/ ~/ vIstep/ (/ s/ ,/ ax/ )/ ;/ (/ iv/ )/ s/ ~/ vDt/ / values/ (/ s/ ,/ v/ )/ =/ values/ (/ t/ ,/ v/ )/ ;/ (/ v/ )/ s/ ~/ vDt/ ∧/ enabled/ (/ s/ ,/ ax/ )/ ∧/ enabled/ (/ t/ ,/ ax/ )/ ∧/ (/ dom/ (/ ax/ )/ DvD/ →/ s/ ~/ dom/ (/ ax/ )/ Dt/ )/ / step/ (/ s/ ,/ ax/ )/ ~/ vDstep/ (/ t/ ,/ ax/ )/ ;/ (/ vi/ )/ (/ dom/ (/ ax/ )/ IuD/ ∧/ enabled/ (/ s/ ,/ ax/ )/ / s/ ~/ vDstep/ (/ s/ ,/ ax/ )/ ;/ s/ ~/ vIt/ 的/ 实际意义/ 表示/ :/ 对于/ 域/ v/ 而言/ ,/ 在/ 状态/ s/ 和/ t/ 下/ 可/ 执行/ 轨迹/ 是/ 完全相同/ 的/ ,/ 简记/ 为/ 执行/ 等价/ ./ 同样/ s/ ~/ vDt/ 的/ 实际意义/ 表示/ :/ 对于/ 域/ v/ 而言/ ,/ 在/ 状态/ s/ 和/ t/ 下/ 可/ 观察/ 到/ 的/ 信息/ 值/ 是/ 完全相同/ 的/ ,/ 简记/ 为/ 存储/ 等价/ ./ 条件/ (/ i/ )/ 和/ (/ iv/ )/ 表示/ :/ 若/ 两/ 状态/ 下/ v/ 满足/ 执行/ 等价/ 或/ 存储/ 等价/ ,/ 则/ 在/ 这/ 两/ 状态/ 下/ 可/ 执行/ 的/ 轨迹/ 集合/ 或/ 可/ 观测/ 的/ 信息/ 值/ 集合/ 相同/ ;/ 条件/ (/ ii/ )/ 表示/ 若/ 两/ 状态/ 下/ v/ 满足/ 执行/ 等价/ ,/ 且/ 在/ 这/ 两个/ 状态/ 下/ ,/ 所有/ 允许/ 干扰/ vI/ 的/ 执行/ 域/ 上/ 已/ 执行/ 了/ 相同/ 的/ 轨迹/ ,/ 则/ 两/ 状态/ 下/ 在/ 上述/ 域/ 上/ 可/ 执行/ 相同/ 的/ 行为/ ax/ ,/ 且/ 执行/ ax/ 后/ v/ 上/ 仍/ 满足/ 执行/ 等价/ ;/ 条件/ (/ v/ )/ 表示/ 若/ 两/ 状态/ 下/ v/ 满足/ 存储/ 等价/ ,/ 且/ 可/ 执行/ 相同/ 的/ 行为/ ax/ ,/ 如果/ 域/ dom/ (/ ax/ )/ 在/ 这/ 两/ 状态/ 下/ 也/ 是/ 存储/ 等价/ 的/ ,/ 则/ 执行/ ax/ 后/ v/ 上/ 仍/ 满足/ 存储/ 等价/ ;/ 条件/ (/ iii/ )/ (/ vi/ )/ 表示/ ,/ 执行/ 不/ Page5/ 允许/ 干扰/ vD/ 或/ vI/ 的/ 行为/ 后/ 达到/ 的/ 状态/ ,/ 与/ 执行/ 前/ 的/ 状态/ 在/ vD/ 或/ vI/ 上/ 是/ 等价/ 的/ ./ 和/ 存储/ 安全性/ 条件/ ./ 即/ 证明/ ./ 证明/ 单步/ 条件/ 能够/ 推导/ 出/ 执行/ 安全性/ (/ i/ )/ (/ ii/ )/ (/ iii/ )/ (/ iv/ )/ (/ v/ )/ (/ vi/ )/ / (/ / v/ ∈/ D/ ,/ α/ ∈/ Ts0/ →/ (/ (/ PurgeI/ (/ α/ ,/ v/ )/ ∈/ Ts0/ ∧/ Trun/ (/ s0/ ,/ α/ )/ ,/ v/ =/ Trun/ (/ s0/ ,/ PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ )/ ∧/ (/ PurgeD/ (/ α/ ,/ v/ )/ ∈/ Ts0/ ∧/ values/ (/ run/ (/ s0/ ,/ α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ s0/ ,/ PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ )/ )/ ./ (/ 1/ )/ 证明/ 单步/ 条件/ 能/ 推出/ 执行/ 安全性/ ./ 由/ s0/ ~/ vIs0/ ,/ RTs0/ ,/ TB/ =/ RTs0/ ,/ TB/ 知/ ,/ 如果/ 能够/ 证明/ / v/ ∈/ D/ ,/ s/ ,/ t/ ∈/ S/ ./ RTs/ ,/ TB/ =/ RTt/ ,/ TB/ ∧/ s/ ~/ vIt/ ∧/ α/ ∈/ Ts/ / PurgeI/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ Trun/ (/ s/ ,/ α/ )/ ,/ v/ =/ Trun/ (/ t/ ,/ PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ 则/ 命题/ 得证/ ./ 对/ α/ 的/ 长度/ 进行/ 归纳/ 证明/ ./ ①/ 当/ α/ =/ ε/ 时/ ,/ 命题/ 显然/ 成立/ ./ ②/ 假设/ α/ 使/ 命题/ 成立/ ,/ 现/ 证明/ a/ / α/ 也/ 同样/ 使/ 命题/ 成立/ ./ 假设/ 对/ a/ 分/ 情况/ 讨论/ :/ a/ )/ 若/ dom/ (/ a/ )/ IvI/ ,/ 则/ 又/ 由/ 条件/ (/ iii/ )/ 得/ 所以/ 又/ 由/ dom/ (/ a/ )/ IvI/ 知则/ 于是/ 由/ 归纳/ 假设/ 和/ 式/ (/ 4/ )/ 、/ (/ 5/ )/ 知/ PurgeI/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ Trun/ (/ step/ (/ s/ ,/ a/ )/ ,/ α/ )/ ,/ v/ =/ Trun/ (/ t/ ,/ PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ 于是/ 由式/ (/ 2/ )/ 和/ run/ 、/ step/ 的/ 定义/ 知/ PurgeI/ (/ a/ / α/ ,/ v/ )/ ∈/ Tt/ ∧/ Trun/ (/ s/ ,/ a/ / α/ )/ ,/ v/ =/ Trun/ (/ t/ ,/ PurgeI/ (/ a/ / α/ ,/ v/ )/ )/ ,/ v/ ./ b/ )/ 若/ dom/ (/ a/ )/ IvI/ ,/ 则/ 由式/ (/ 1/ )/ 和/ 条件/ (/ ii/ )/ 得/ 又/ 由式/ (/ 1/ )/ 和/ RT/ 的/ 定义/ 得/ 则/ 由/ 归纳/ 假设/ 和/ 式/ (/ 8/ )/ 、/ (/ 9/ )/ 得/ RTstep/ (/ s/ ,/ a/ )/ ,/ TB/ =/ RTstep/ (/ t/ ,/ a/ )/ ,/ TB/ ∧/ α/ ∈/ Tstep/ (/ s/ ,/ a/ )/ (/ 9/ )/ PurgeI/ (/ α/ ,/ v/ )/ ∈/ Tstep/ (/ t/ ,/ a/ )/ ∧/ Trun/ (/ step/ (/ s/ ,/ a/ )/ ,/ α/ )/ ,/ v/ =/ Trun/ (/ step/ (/ t/ ,/ a/ )/ ,/ PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ 由/ run/ 、/ step/ 的/ 定义/ 知/ a/ / PurgeI/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ Trun/ (/ s/ ,/ a/ / α/ )/ ,/ v/ =/ Trun/ (/ t/ ,/ a/ / PurgeI/ (/ α/ ,/ v/ )/ )/ ,/ v/ 由式/ (/ 7/ )/ 得/ PurgeI/ (/ a/ / α/ ,/ v/ )/ ∈/ Tt/ ∧/ Trun/ (/ s/ ,/ a/ / α/ )/ ,/ v/ =/ Trun/ (/ t/ ,/ PurgeI/ (/ a/ / α/ ,/ v/ )/ )/ ,/ v/ 综上所述/ ,/ 由/ ①/ 、/ ②/ 的/ 结论/ 可/ 推出/ 执行/ 安全性/ (/ 2/ )/ 证明/ 单步/ 条件/ 能/ 推出/ 存储/ 安全性/ 为/ 证明/ 方便/ ,/ 记/ s/ ~/ SourcesD/ (/ α/ ,/ v/ )/ t/ =/ def/ (/ / w/ ∈/ SourcesD/ (/ α/ ,/ v/ )/ ./ s/ ~/ wt/ )/ ,/ 条件/ ./ 则/ 由/ 其中/ SD/ =/ {/ ∪/ u/ |/ / u/ ,/ w/ ∈/ D/ ,/ wI/ ∈/ SourcesD/ (/ α/ ,/ v/ )/ ,/ uIvI/ }/ 知/ ,/ 如果/ 能够/ 证明/ / v/ ∈/ D/ ,/ s/ ,/ t/ ∈/ S/ ./ RTs/ ,/ SD/ =/ RTt/ ,/ SD/ ∧/ s/ ~/ SourcesD/ (/ α/ ,/ v/ )/ t/ ∧/ α/ ∈/ Ts/ / PurgeD/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ values/ (/ run/ (/ s/ ,/ α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ t/ ,/ PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ ,/ 则/ 命题/ 得证/ ./ 对/ α/ 的/ 长度/ 进行/ 归纳/ 证明/ ./ ①/ 当/ α/ =/ ε/ 时/ ,/ 命题/ 显然/ 成立/ ./ ②/ 假设/ α/ 使/ 命题/ 成立/ ,/ 现/ 证明/ a/ / α/ 同样/ 使/ 命题/ 成立/ ./ 假设/ 对/ a/ 分/ 情况/ 讨论/ :/ a/ )/ 若/ dom/ (/ a/ )/ I/ / SourcesD/ (/ a/ / α/ ,/ v/ )/ ,/ 则/ 又/ 由/ 条件/ (/ iii/ )/ (/ vi/ )/ 及/ SourcesD/ 函数/ 的/ 定义/ 得/ 所以/ 又/ 由/ 假设/ 条件/ (/ 11/ )/ 知/ 于是/ 由/ 归纳/ 假设/ 和/ 式/ (/ 14/ )/ 、/ (/ 15/ )/ 知/ PurgeD/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ values/ (/ run/ (/ step/ (/ s/ ,/ a/ )/ ,/ α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ t/ ,/ PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ ,/ 于是/ 由式/ (/ 12/ )/ 和/ run/ 、/ step/ 的/ 定义/ 知/ PurgeD/ (/ a/ / α/ ,/ v/ )/ ∈/ Tt/ ∧/ values/ (/ run/ (/ s/ ,/ a/ / α/ )/ ,/ v/ )/ =/ Page6PurgeD/ (/ α/ ,/ v/ )/ ∈/ Tstep/ (/ t/ ,/ a/ )/ ∧/ values/ (/ run/ (/ step/ (/ s/ ,/ a/ )/ ,/ α/ )/ ,/ v/ )/ =/ enabled/ (/ t/ ,/ a/ )/ ,/ step/ (/ s/ ,/ a/ )/ ~/ SourcesD/ (/ α/ ,/ v/ )/ step/ (/ t/ ,/ a/ )/ (/ 17/ )/ 又/ 由/ 假设/ 条件/ (/ 11/ )/ 知由/ 归纳/ 假设/ 和/ 式/ (/ 17/ )/ 、/ (/ 18/ )/ 知/ values/ (/ run/ (/ step/ (/ t/ ,/ a/ )/ ,/ PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ 由/ run/ 、/ step/ 的/ 定义/ 知/ values/ (/ run/ (/ t/ ,/ a/ / PurgeD/ (/ α/ ,/ v/ )/ )/ ,/ v/ )/ ./ 由式/ (/ 16/ )/ 得/ a/ / PurgeD/ (/ α/ ,/ v/ )/ ∈/ Tt/ ∧/ values/ (/ run/ (/ s/ ,/ a/ / α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ t/ ,/ PurgeD/ (/ a/ / α/ ,/ v/ )/ )/ ,/ v/ )/ ./ b/ )/ 若/ dom/ (/ a/ )/ I/ ∈/ SourcesD/ (/ a/ / α/ ,/ v/ )/ ,/ 则/ 由/ 条件/ (/ ii/ )/ 、/ (/ v/ )/ 及/ 假设/ RTs/ ,/ SD/ =/ RTt/ ,/ SD/ 得/ PurgeD/ (/ a/ / α/ ,/ v/ )/ ∈/ Tt/ ∧/ values/ (/ run/ (/ s/ ,/ a/ / α/ )/ ,/ v/ )/ =/ values/ (/ run/ (/ t/ ,/ PurgeD/ (/ a/ / α/ ,/ v/ )/ )/ ,/ v/ )/ ./ 综上所述/ ,/ 由/ ①/ 、/ ②/ 的/ 结论/ 可/ 推出/ 存储/ 安全性/ ./ 则/ 由/ 定义/ 4/ 知/ 命题/ 得证/ ./ ENISM/ 不仅/ 可/ 用于/ 描述/ 和/ 分析/ 操作系统/ 的/ 信息流/ 策略/ ,/ 更/ 可以/ 用于/ 类似/ 的/ 具有/ 模块化/ 结构/ 的/ 复杂/ 系统/ 的/ 信息流/ 分析/ 和/ 描述/ ./ 但是/ ,/ 根据/ 不同/ 系统/ 的/ 特点/ ,/ 描述/ 和/ 验证/ 的/ 方法/ 会/ 有所/ 差别/ ,/ 下文/ 将/ 主要/ 针对/ 操作系统/ 的/ 描述/ 和/ 信息流/ 策略/ 的/ 验证/ 给出/ 具体/ 的/ 形式化/ 方法/ ./ 3/ 基于/ CSP/ 的/ 系统/ 描述/ 和/ 信息流/ 策略/ 验证/ 方法/ Rushby/ 在/ 文献/ [/ 3/ ]/ 中/ 通过考察/ 信息/ 域/ 上/ 的/ 主体/ 对/ 信息/ 值/ 的/ 观察/ (/ observe/ )/ 或/ 修改/ (/ alter/ )/ 能力/ 来/ 描述/ 信息/ 的/ 流动/ ,/ 并/ 通过/ 检查/ 是否/ 存在/ 恶意/ 主体/ 拥有/ 不/ 被/ 允许/ 的/ 能力/ 来/ 查找/ 违反/ 安全策略/ 的/ 信息/ 流动/ ./ 但是/ ,/ 信息/ 流动/ 不仅仅/ 反映/ 在/ 数据/ 值/ 的/ 传递/ 上/ ,/ 还/ 反映/ 在/ 一个/ 域/ 的/ 行为/ 执行/ 和/ 信息/ 改变/ 对/ 另/ 一个/ 域/ 上/ 的/ 行为/ 执行/ 的/ 影响/ 上/ ,/ 如/ 影响/ 到/ 上节/ 单步/ 展开/ 条件/ 中/ 描述/ 的/ Ts/ ,/ u/ ./ 而/ 行为/ 序列/ 集合/ Ts/ ,/ u/ 可能/ 包含/ 多个/ 甚至/ 无限/ 多个/ 连续/ 行为/ ,/ 验证/ 行为/ 序列/ 集合/ 的/ 改变/ 无法/ 使用/ Rushby/ 的/ 方法/ 来/ 实现/ ./ 本文/ 通过/ 通信/ 顺序进程/ (/ CSP/ )/ [/ 10/ ]/ 来/ 形式化/ 描述/ 操作系统/ 的/ 设计/ 和/ 安全/ 状态/ ./ CSP/ 用/ 一组/ 通信/ 进程/ 来/ 描述/ 系统/ 行为/ ,/ 能够/ 描述/ 系统/ 的/ 执行/ 轨迹/ ,/ 这/ 正是/ 描述/ 行为/ 不/ 干扰/ 属性/ 所/ 需要/ 的/ ./ 目前/ ,/ 已有/ 许多/ 支持/ CSP/ 的/ 自动化/ 验证/ 工具/ ,/ 可/ 辅助/ 我们/ 进行/ 自动化/ 的/ 系统验证/ ./ 本节/ 即将/ 给出/ 基于/ CSP/ 的/ 形式化/ 描述/ 系统/ 设计/ 的/ 方法/ ,/ 并用/ CSP/ 诠释/ 系统/ M/ 满足/ 安全策略/ 的/ 条件/ ,/ 为/ 进一步/ 利用/ CSP/ 验证/ 工具/ FDR2/ 进行/ 形式化/ 验证/ 做/ 准备/ ./ 为/ 便于/ 理解/ ,/ 先/ 将/ 下文/ 中/ 用到/ 的/ 通信/ 顺序进程/ (/ CSP/ )/ 的/ 部分/ 算子/ 列出/ 如下/ :/ P/ 一个/ 进程/ α/ PP/ 的/ 子/ 母表/ a/ →/ P/ 前缀/ 算子/ ,/ ifathenP/ (/ a/ →/ P/ |/ b/ →/ Q/ )/ 选择/ 算子/ ,/ ifathenPelseifbthenQP/ // s/ 后继/ 算子/ ,/ PaftersP/ ‖/ Q/ 并发/ 算子/ ,/ PinparallelwithQP/ \/ C/ 屏蔽/ 算子/ ,/ PwithChidingP/ Γ/ C/ 约束/ 算子/ ,/ srestrictedtoAP/ □/ Q/ 不/ 确定/ 算子/ ,/ PorQtraces/ (/ P/ )/ P/ 可能/ 执行/ 的/ 迹/ 的/ 集合/ failures/ (/ P/ )/ P/ 当前/ 不/ 接受/ 的/ 动作/ 集合/ 虽然/ ,/ 随着/ 硬件/ 技术/ 和/ 操作系统/ 实现/ 技术/ 的/ 发展/ ,/ 操作系统/ 具有/ 了/ 更/ 复杂/ 的/ 功能/ ,/ 支持/ 对/ 更/ 多/ 资源/ 设备/ 的/ 管理/ ./ 但是/ ,/ 如果/ 我们/ 不/ 考虑/ 信息/ 的/ 载体/ 和/ 获取信息/ 的/ 方式/ ,/ 总/ 可以/ 把/ 信息/ 抽象/ 为/ 对象/ ,/ 把/ 信息/ 的/ 接收/ 、/ 读取/ 、/ 传送/ 抽象/ 为读/ 、/ 写/ 操作/ ./ 于是/ ,/ 在/ 描述/ 一个/ 操作系统/ 设计/ 时/ ,/ 除/ 使用/ 标准/ 的/ CSP/ 算子/ 和/ 定义/ 外/ ,/ 增加/ 定义/ 以下/ 描述/ 规则/ ./ 定义/ 5/ ./ 相关/ 定义/ 和/ 描述/ 规则/ 如下/ ./ (/ 1/ )/ 对应/ 于/ ENISM/ 中/ 的/ 执行/ 域/ u/ ,/ 进程/ U/ 描述/ 域/ u/ 上/ 的/ 执行/ 轨迹/ 集合/ ,/ 并/ 将/ 进程/ 的/ 集合/ 定义/ 为/ DP/ ;/ 将/ 数据/ 存储/ 或/ 外部/ 输入输出/ 设备描述/ 为/ d/ ∈/ uD/ ,/ 读入/ 或/ 写出/ 的/ 系统/ 内/ 变量/ 描述/ 为/ v/ ./ U/ ;/ 将/ 非/ 读写操作/ c/ ∈/ uI/ ,/ 描述/ 为/ c/ ./ U/ ;/ 将/ 读写操作/ 描述/ 为/ d/ ./ read/ ./ v/ ./ U/ 或/ d/ ./ write/ ./ v/ ./ U/ ;/ 规定/ 每/ 一个/ 读写操作/ 只能/ 描述/ 对/ 一个/ 数据/ 存储/ 或/ 外部/ 输入输出/ 设备/ 的/ 读/ 或/ 写/ ./ 系统/ 临时/ 变量/ 之间/ 的/ 值/ 传递/ 也/ 必须/ 描述/ 为/ 通过/ 某个/ 外部/ 存储/ 传递/ ./ (/ 2/ )/ 对于/ 给定/ 系统/ M/ 上/ 的/ 任意/ 进程/ U/ 和/ 任意/ 迹/ tr/ ∈/ Traces/ (/ M/ )/ ,/ 定义/ interferedSet/ (/ tr/ ,/ U/ )/ / aM/ 为/ 执行/ 迹/ tr/ 在/ 执行/ U/ 上/ 操作/ 时/ 读取/ 的/ 数据/ 所/ 能/ 影响/ 的/ 系统/ 变量/ 集合/ ./ 定义/ Acts/ (/ tr/ )/ / A/ 为/ tr/ 中/ 操作/ 的/ 集合/ ,/ 则/ 计算/ interferedSet/ (/ tr/ ,/ U/ )/ :/ ①/ / d/ ./ read/ ./ v/ ./ U/ ∈/ Acts/ (/ tr/ )/ ,/ v/ ./ U/ ∈/ interferedSe/ (/ tr/ ,/ U/ )/ ;/ ②/ / d/ ∈/ α/ M/ ,/ 若/ V/ ,/ W/ ∈/ DP/ ,/ d/ ./ write/ ./ v/ ./ V/ ∈/ α/ V/ ,/ d/ ./ write/ ./ w/ ./ W/ ∈/ α/ W/ ,/ v/ ./ V/ ∈/ interferedSet/ (/ tr/ ,/ U/ )/ ,/ 则/ w/ ./ W/ ∈/ inter/ -/ feredSet/ (/ tr/ ,/ U/ )/ ./ 由此/ 可/ 计算/ U/ 的/ 所有/ 输入/ 数据/ 所/ 能/ 影响/ 到/ 的/ 系统/ M/ 的/ 变量/ 集合/ 为/ {/ a/ |/ a/ ∈/ interferedSet/ (/ tr/ ,/ U/ )/ ,/ tr/ ∈/ Traces/ (/ M/ )/ }/ ,/ 记/ 为/ β/ U/ ./ Page7/ (/ 3/ )/ 将/ 选择/ 语句/ 中/ 的/ 分支/ 选择/ 条件/ 描述/ 为/ 一组/ 操作/ ,/ 分别/ 作为/ 各/ 分支/ 的/ 起始/ 标记/ ./ 如/ tr0/ →/ ifcond1/ (/ v/ )/ thentr1elseifcond2/ (/ v/ )/ thentr2elseifcondn/ (/ v/ )/ …/ elsetrn/ ,/ 可/ 描述/ 为/ tr0/ →/ (/ (/ v/ ./ U/ ./ ct1/ ./ m1/ →/ tr1/ )/ |/ (/ v/ ./ U/ ./ ct1/ ./ m2/ →/ tr2/ )/ |/ …/ |/ (/ v/ ./ U/ ./ ct1/ ./ mn/ →/ trn/ )/ )/ ,/ 其中/ cti/ (/ i/ =/ 1/ ,/ …/ ,/ p/ )/ ,/ mi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 为/ 不同/ 的/ 自然数/ ,/ cti/ 用于/ 区分/ 系统/ 中/ 不同/ 的/ 选择/ 语句/ ,/ mi/ 用于/ 区分/ 选择/ 语句/ 中/ 的/ 不同/ 分支/ ,/ p/ 描述/ 系统/ 中/ 选择/ 语句/ 的/ 数量/ ,/ n/ 描述/ 每/ 一个/ 选择/ 语句/ 的/ 分支/ 数/ ./ 上例/ 中/ v/ ./ U/ ./ ct1/ ./ m2/ 表示/ 这是/ 描述/ 过程/ 中/ 遇到/ 的/ 第/ 1/ 个/ 选择/ 语句/ 的/ 第/ 2/ 个/ 分支/ ./ 定义/ 由/ 任一/ 选择/ 语句/ 中/ 的/ 分支/ 起始/ 标记/ 构成/ 的/ 集合/ 为/ Ecti/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ p/ )/ ,/ 由/ Ecti/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ p/ )/ 构成/ 的/ 集合/ 为/ E/ =/ {/ Ecti/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ p/ }/ ,/ 上例/ 中/ Ecti/ =/ {/ v/ ./ U/ ./ cti/ ./ m1/ ,/ v/ ./ U/ ./ cti/ ./ m2/ ,/ …/ ,/ v/ ./ U/ ./ cti/ ./ mn/ }/ ./ (/ 4/ )/ 函数/ GetChoiceActs/ :/ T/ ×/ DP/ →/ 2E/ ,/ Get/ -/ ChoiceActs/ (/ tr/ ,/ U/ )/ =/ {/ Ecti/ |/ / x/ ./ cti/ ./ mj/ ∈/ Ecti/ ,/ x/ ∈/ interferedSet/ (/ tr/ ,/ U/ )/ }/ ,/ 则/ 函数/ GetChoiceActs/ 描述/ 了/ tr/ 执行/ U/ 的/ 操作/ 时/ 读取/ 的/ 数据/ 所/ 能/ 影响/ 到/ 的/ 选择/ 语句/ 集合/ ./ (/ 5/ )/ 对于/ E/ 的/ 任意/ 子集/ e/ / E/ ,/ 设/ e/ =/ {/ e1/ ,/ e2/ ,/ …/ ,/ en/ }/ ,/ 则/ 定义/ 函数/ Cartesian/ (/ e/ )/ =/ e1/ ×/ e2/ ×/ …/ ×/ en/ ,/ 描述/ e/ 中/ 所有/ 元素/ 的/ 笛卡儿/ 积/ ./ 由于/ ei/ 描述/ 的/ 是/ 某个/ 选择/ 语句/ 的/ 所有/ 分支/ 起始/ 标记/ 的/ 集合/ ,/ Cartesian/ (/ e/ )/ 则/ 反映/ 了/ e/ 中/ 涉及/ 的/ 多个/ 选择/ 语句/ 的/ 所有/ 选择/ 结果/ 的/ 组合/ ./ 对于/ 其中/ 的/ 任意/ 一种/ 选择/ 结果/ α/ ∈/ Cartesian/ (/ e/ )/ ,/ 设/ α/ =/ {/ α/ 1/ ,/ α/ 2/ ,/ …/ ,/ α/ n/ }/ ,/ 定义/ 进程/ Choice/ (/ α/ )/ =/ (/ α/ 1/ |/ α/ 2/ |/ …/ |/ α/ n/ )/ →/ Choice/ (/ α/ )/ ,/ Choice/ (/ α/ )/ 可/ 将/ 分支/ 选择/ 结果/ 反映/ 在/ 与其/ 同步/ 的/ 进程/ 中/ ./ (/ 6/ )/ 对于/ 任意/ 执行/ 迹/ tr/ ∈/ Traces/ (/ M/ )/ ,/ 如果/ 存在/ 某个/ 状态/ s/ ,/ 是/ 由/ 初始状态/ s0/ 执行/ tr/ 后/ 达到/ 的/ ./ 则/ 一定/ 可以/ 由/ tr/ 的/ 输入/ 数据/ 和/ 执行/ 轨迹/ 确定/ GetChoiceActs/ (/ tr/ ,/ M/ )/ 中/ 的/ 一部分/ 选择/ 语句/ 的/ 分支/ 选择/ 结果/ ,/ 即/ 存在/ GetChoiceActs/ (/ tr/ ,/ M/ )/ 的/ 一个/ 子集/ es/ 和/ es/ 上/ 的/ 一种/ 选择/ 组合/ α/ s/ ,/ tr/ ,/ M/ ,/ 有/ α/ s/ ,/ tr/ ,/ M/ ∈/ Cartesian/ (/ es/ )/ ,/ 下文/ 称/ α/ s/ ,/ tr/ ,/ M/ 为/ 系统/ M/ 由/ 初始状态/ s0/ 执行/ 轨迹/ tr/ 到/ 状态/ s/ 时/ 的/ 分支/ 选择/ 向量/ ./ (/ 7/ )/ / d/ ./ read/ ./ v/ ∈/ α/ M/ ,/ 记/ 状态/ s/ 下/ d/ 的/ 取值/ 为/ getData/ (/ d/ ,/ s/ )/ ,/ v/ 的/ 取值/ 为/ getParam/ (/ v/ ,/ s/ )/ ./ (/ 8/ )/ 系统/ 描述/ 中/ 遇到/ 不/ 确定/ 选择/ P/ □/ Q/ ,/ 均/ 表达/ 为/ 确定性/ 选择/ 关系/ (/ a/ →/ P/ |/ b/ →/ Q/ )/ ,/ 在/ 不/ 影响/ 语义/ 的/ 前提/ 下/ 确保/ 系统/ 描述/ 中/ 不/ 存在/ 非/ 确定性/ ./ 下面/ 基于/ CSP/ 和/ 上述/ 描述/ 规则/ 给出/ 一种/ 等价关系/ 定义/ ./ 定义/ 6/ ./ 对于/ 给定/ 的/ 系统/ M/ 和/ 安全策略/ ,/ 任意/ 状态/ s/ ,/ t/ ,/ M/ 中/ 的/ 任意/ 执行/ 域/ w/ ∈/ D/ 上/ 进程/ 的/ 描述/ W/ ./ 如果/ 由/ 初始状态/ s0/ 执行/ 到/ 状态/ s/ 的/ 执行/ 轨迹/ 为/ trs/ ∈/ Traces/ (/ M/ )/ ,/ 产生/ 的/ 分支/ 选择/ 向量/ 为/ α/ s/ ,/ trs/ ,/ M/ ,/ 执行/ 到/ 状态/ t/ 的/ 执行/ 轨迹/ 为/ trt/ ∈/ Traces/ (/ M/ )/ ,/ 产生/ 的/ 分支/ 选择/ 向量/ 为/ α/ t/ ,/ trt/ ,/ M/ ,/ 则/ 有/ s/ ~/ wDtiff/ (/ / d/ ./ read/ ./ v/ ∈/ α/ M/ ,/ getData/ (/ d/ ,/ s/ )/ =/ s/ ~/ wItiff/ (/ (/ (/ M/ // trs/ )/ ‖/ Choice/ (/ α/ s/ ,/ trs/ ,/ M/ )/ )/ Γ/ α/ W/ =/ getData/ (/ d/ ,/ t/ )/ ,/ getParam/ (/ v/ ,/ s/ )/ =/ getParam/ (/ v/ ,/ t/ )/ )/ 定义/ 6/ 基于/ CSP/ 给出/ 了/ 一种/ 状态/ 等价/ 的/ 定义/ ./ 基于/ 进程/ W/ 的/ 存储/ 等价/ 要求/ W/ 可/ 读取/ 的/ 数据/ 存储/ 和/ W/ 中/ 的/ 变量值/ 在/ 两个/ 状态/ 下/ 都/ 必须/ 是/ 相等/ 的/ ;/ 执行/ 等价/ 则/ 由于/ 引入/ 了/ 数据/ 对/ 执行/ 的/ 影响/ ,/ 不再/ 简单/ 地/ 理解/ 为/ (/ M/ // trs/ )/ Γ/ α/ W/ =/ (/ M/ // trt/ )/ Γ/ α/ W/ ,/ 还要/ 考虑/ 输入/ 对/ 分支/ 选择/ 的/ 影响/ ,/ 即/ 引入/ 了/ Choice/ (/ )/ 来/ 体现/ 分支/ 选择/ 的/ 结果/ ./ 只有/ trs/ 、/ trt/ 中/ 的/ 行为/ 及/ 输入/ 值/ 所/ 影响/ 的/ 分支/ 选择/ 结果/ 都/ 不能/ 改变/ 域/ W/ 上/ 行为/ 的/ 执行/ 时/ ,/ 才能/ 认为/ 状态/ s/ ,/ t/ 是/ 执行/ 等价/ 的/ ./ 基于/ 上述/ 等价关系/ 和/ CSP/ 描述/ 规则/ ,/ 我们/ 给出/ 目标/ 系统/ 满足/ 不/ 干扰/ 策略/ 的/ 判定/ 条件/ ./ 定理/ 2/ ./ 对于/ 确定性/ 系统/ M/ 和/ 安全策略/ ,/ 如果/ 对于/ M/ 中/ 的/ 任意/ 执行/ 域/ w/ ∈/ D/ ,/ 存在/ 定义/ 6/ 定义/ 的/ 等价关系/ ~/ wD/ ,/ ~/ wI/ ,/ 并/ 满足/ 以下/ 条件/ ,/ 则/ 称/ 系统/ M/ 满足/ 安全策略/ ./ (/ 1/ )/ 执行/ 安全性/ 条件/ / w/ ∈/ D/ ,/ u/ =/ {/ ∪/ z/ |/ zIwI/ }/ ,/ v/ =/ {/ ∪/ z/ |/ zIwI/ }/ ./ 设/ W/ ,/ U/ ,/ V/ 分别/ 描述/ 域/ w/ ,/ u/ ,/ v/ 上/ 的/ 进程/ ,/ M/ =/ U/ ‖/ V/ ‖/ W/ ,/ 则/ 满足/ Assert/ (/ M/ \/ α/ U/ \/ β/ U/ )/ :/ [/ deterministic/ [/ FD/ ]/ ]/ =/ true/ (/ 表明/ M/ \/ α/ U/ \/ β/ U/ 中/ 不/ 存在/ 非/ 确定性/ )/ ./ (/ 2/ )/ 存储/ 安全性/ 条件/ / u/ ∈/ D/ ,/ uIwD/ ,/ 设/ U/ ,/ W/ 分别/ 描述/ 域/ u/ ,/ w/ 上/ 的/ 进程/ ,/ 且/ 满足/ 执行/ 安全性/ 条件/ 要求/ M/ \/ α/ U/ \/ β/ U/ 是/ 确定/ 的/ ,/ 即/ 通过/ α/ U/ ,/ β/ U/ 反映/ U/ 的/ 执行/ 和/ 输入/ 对/ 其它/ 进程/ 的/ 干扰/ ,/ 而/ 存储/ 安全性/ 条件/ 则/ 主要/ 关心/ 两个/ 域/ 之间/ 是否/ 存在/ 直接/ 的/ 信息/ 传递/ ./ 证明/ ./ (/ 1/ )/ 证明/ 执行/ 安全性/ 条件/ ,/ 即/ 证明/ 满足/ 定理/ 1/ 的/ (/ i/ )/ (/ ii/ )/ (/ iii/ )/ ./ Page8/ ①/ 由/ 定义/ 5/ 和/ 定义/ 6/ 知即/ 为/ Ts/ ,/ w/ ,/ 因此/ 定理/ 1/ (/ i/ )/ 成立/ ./ ②/ 证明/ 定理/ 1/ 的/ (/ ii/ )/ 成立/ 由/ 定义/ 1/ 知/ RTs/ ,/ u/ 是/ 一组/ 行为/ 的/ 执行/ 序列/ ,/ 且/ 有/ RTs/ ,/ {/ v/ ,/ w/ }/ =/ RTs/ ,/ {/ v/ ,/ w/ }/ / trs/ \/ α/ U/ =/ trt/ \/ α/ U/ (/ 19/ )/ 由/ 定理/ 1/ (/ ii/ )/ 的/ 条件/ enabled/ (/ s/ ,/ ax/ )/ ∧/ dom/ (/ ax/ )/ IwI/ 知/ ,/ 存在/ a/ ∈/ α/ M/ -/ α/ U/ ,/ (/ trs/ / 〈/ a/ 〉/ )/ ∈/ traces/ (/ M/ )/ ./ 由/ M/ \/ α/ U/ \/ β/ U/ 的/ 确定性/ 知/ (/ trs/ / 〈/ a/ 〉/ )/ \/ α/ U/ \/ β/ U/ ∈/ traces/ (/ M/ \/ α/ U/ \/ β/ U/ )/ (/ 20/ )/ 假设/ 即由式/ (/ 19/ )/ 得/ 如果/ a/ / β/ U/ ,/ 则/ 同式/ (/ 20/ )/ 有/ (/ trt/ \/ α/ U/ \/ β/ U/ ,/ {/ a/ }/ )/ ∈/ failures/ (/ M/ \/ α/ U/ \/ β/ U/ )/ (/ trs/ \/ α/ U/ \/ β/ U/ ,/ {/ a/ }/ )/ ∈/ failures/ (/ M/ \/ α/ U/ \/ β/ U/ )/ (/ 22/ )/ 根据/ 式/ (/ 20/ )/ 和/ (/ 22/ )/ 知/ 这/ 与/ M/ \/ α/ U/ \/ β/ U/ 的/ 确定性/ 矛盾/ ./ 如果/ a/ ∈/ β/ U/ ,/ 则/ a/ 所在/ 的/ 选择/ 语句/ 必/ 至少/ 还/ 存在/ 另/ 一个/ 分支/ 选择/ 行为/ b/ ∈/ β/ U/ ,/ 满足/ (/ trt/ / 〈/ b/ 〉/ )/ ∈/ traces/ (/ M/ ‖/ Choice/ (/ Choice/ (/ α/ t/ ,/ trt/ ,/ M/ )/ )/ )/ ,/ 因为/ a/ 不是/ U/ 进程/ 上/ 的/ 分支/ 选择/ ,/ 所以/ a/ ,/ b/ 所在/ 分支/ 在/ U/ 进程/ 以外/ 存在/ 分歧/ ./ 不妨/ 设/ 存在/ 行为/ c/ ∈/ α/ M/ -/ α/ U/ -/ β/ U/ ,/ 行为/ 序列/ trx/ 满足/ trx/ ∈/ traces/ (/ M/ \/ (/ trs/ / 〈/ a/ 〉/ )/ )/ ;/ trx/ ∈/ traces/ (/ M/ \/ (/ trt/ / 〈/ b/ 〉/ )/ )/ ;/ (/ trx/ / 〈/ c/ 〉/ )/ ∈/ traces/ (/ M/ \/ (/ trs/ / 〈/ a/ 〉/ )/ )/ ;/ (/ trx/ ,/ {/ c/ }/ )/ ∈/ failures/ (/ M/ \/ (/ trt/ / 〈/ b/ 〉/ )/ )/ ;/ 即/ (/ trs/ / 〈/ a/ 〉/ / trx/ / 〈/ c/ 〉/ )/ ∈/ traces/ (/ M/ )/ ;/ (/ trs/ / 〈/ b/ 〉/ / trx/ ,/ {/ c/ }/ )/ ∈/ failures/ (/ M/ )/ ;/ 于是/ 有/ (/ trs/ / 〈/ a/ 〉/ / trx/ / 〈/ c/ 〉/ \/ α/ U/ \/ β/ U/ )/ ∈/ traces/ (/ M/ \/ α/ U/ \/ β/ U/ )/ (/ trs/ / 〈/ b/ 〉/ / trx/ \/ α/ U/ \/ β/ U/ ,/ {/ c/ }/ )/ ∈/ failures/ (/ M/ \/ α/ U/ \/ β/ U/ )/ ;/ 由式/ (/ 19/ )/ 和/ a/ ,/ b/ ∈/ β/ U/ 知/ (/ trs/ / trx/ / 〈/ c/ 〉/ \/ α/ U/ \/ β/ U/ )/ ∈/ traces/ (/ M/ \/ α/ U/ \/ β/ U/ )/ ,/ (/ trs/ / trx/ \/ α/ U/ \/ β/ U/ ,/ {/ c/ }/ )/ ∈/ failures/ (/ M/ \/ α/ U/ \/ β/ U/ )/ ;/ 这/ 与/ M/ \/ α/ U/ \/ β/ U/ 的/ 确定性/ 矛盾/ ./ 即式/ (/ 21/ )/ 假设/ 不/ 成立/ ,/ 有/ 最后/ 用/ 反证法/ 证明/ step/ (/ s/ ,/ ax/ )/ ~/ wIstep/ (/ t/ ,/ ax/ )/ 即/ 假设/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ Γ/ α/ W/ ≠/ (/ (/ M/ // (/ trt/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ t/ ,/ a/ )/ ,/ trt/ / 〈/ a/ 〉/ ,/ M/ )/ )/ Γ/ α/ W/ 则/ 一定/ 有/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ \/ α/ U/ \/ β/ U/ ≠/ (/ (/ M/ // (/ trt/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ t/ ,/ a/ )/ ,/ trt/ / 〈/ a/ 〉/ ,/ M/ )/ )/ \/ α/ U/ \/ β/ U/ ,/ 即/ 存在/ 不/ 相等/ 的/ 执行/ 序列/ ,/ 不妨/ 设/ 存在/ trx/ ∈/ traces/ (/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ \/ α/ U/ \/ β/ U/ )/ ,/ c/ ∈/ α/ M/ -/ α/ U/ -/ β/ U/ ,/ (/ trx/ / 〈/ c/ 〉/ )/ ∈/ traces/ (/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ \/ α/ U/ \/ β/ U/ )/ (/ trx/ ,/ {/ c/ }/ )/ ∈/ failures/ (/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ \/ α/ U/ \/ β/ U/ )/ ,/ 同式/ (/ 23/ )/ 的/ 证明/ 过程/ 可知/ ,/ 这/ 与/ M/ \/ α/ U/ \/ β/ U/ 的/ 确定性/ 矛盾/ ./ 即式/ (/ 24/ )/ 的/ 假设/ 不/ 成立/ ,/ 即/ 满足/ (/ ii/ )/ ./ 综合/ 式/ (/ 23/ )/ 、/ (/ 25/ )/ 可/ 得/ ,/ 系统/ M/ 满足/ 定理/ 1/ 的/ ③/ 证明/ 此/ 条件/ 满足/ 定理/ 1/ 的/ (/ iii/ )/ ./ 下面/ 同样/ 用/ 反证法/ 证明/ s/ ~/ wIstep/ (/ s/ ,/ ax/ )/ ,/ 假设/ (/ (/ M/ // trs/ )/ ‖/ Choice/ (/ α/ s/ ,/ trs/ ,/ M/ )/ )/ Γ/ α/ W/ ≠/ (/ (/ M/ // (/ trs/ / 〈/ a/ 〉/ )/ )/ ‖/ Choice/ (/ α/ step/ (/ s/ ,/ a/ )/ ,/ trs/ / 〈/ a/ 〉/ ,/ M/ )/ )/ Γ/ α/ W/ 则/ 同/ ②/ 的/ 证明/ 过程/ 可/ 得到/ 该/ 假设/ 同样/ 与/ M/ \/ α/ U/ \/ β/ U/ 的/ 确定性/ 矛盾/ ,/ 即/ 假设/ 错误/ ,/ s/ ~/ wIstep/ (/ s/ ,/ ax/ )/ 得证/ ./ 即/ 满足/ 定理/ 1/ 的/ (/ iii/ )/ ./ 综上所述/ ,/ 系统/ M/ 满足/ 定理/ 1/ 的/ 条件/ (/ i/ )/ (/ ii/ )/ (/ iii/ )/ ,/ 即/ 系统/ M/ 满足/ 安全策略/ ./ (/ 2/ )/ 证明/ 存储/ 安全性/ 条件/ ,/ 即/ 证明/ 满足/ 定理/ 1/ 的/ (/ iv/ )/ (/ v/ )/ (/ vi/ )/ ①/ 由/ 定义/ 5/ 和/ 定义/ 6/ 知/ / d/ ./ read/ ./ v/ ∈/ α/ W/ ,/ getData/ (/ d/ ,/ s/ )/ ,/ getParam/ (/ v/ ,/ s/ )/ 即为/ values/ (/ s/ ,/ v/ )/ ,/ 因此/ 定理/ 1/ (/ iv/ )/ 成立/ ./ ②/ 由/ 定理/ 1/ (/ v/ )/ 知/ ,/ 对于/ 任意/ 两个/ 状态/ s/ ,/ t/ ,/ 若/ s/ ~/ wDt/ ∧/ enabled/ (/ s/ ,/ ax/ )/ ∧/ enabled/ (/ t/ ,/ ax/ )/ ∧/ (/ dom/ (/ ax/ )/ DwD/ →/ s/ ~/ dom/ (/ ax/ )/ Dt/ )/ ,/ 如果/ ax/ 不是/ 写/ 操作/ ,/ 显然/ 满足/ (/ v/ )/ ;/ 否则/ 不妨/ 设/ ax/ =/ d/ ./ write/ ./ v/ ./ / ./ a/ )/ 如果/ ax/ 在/ 不/ 干扰/ w/ 的/ 域/ 中/ 执行/ ,/ 即/ d/ ./ write/ ./ v/ ./ / ∈/ α/ U/ ,/ 根据/ 数据完整性/ 条件/ / d/ ./ write/ ∈/ α/ U/ / d/ ./ read/ / α/ W/ 知/ ,/ d/ ./ read/ / α/ W/ ,/ 即/ d/ 的/ 改变/ 不会/ 被域/ w/ 所/ 观察/ 到/ ,/ 仍/ 有/ values/ (/ step/ (/ s/ ,/ ax/ )/ ,/ w/ )/ =/ values/ (/ step/ (/ t/ ,/ ax/ )/ ,/ w/ )/ ,/ Page9/ 即/ 满足/ (/ v/ )/ ./ b/ )/ 如果/ ax/ 在/ 干扰/ w/ 的/ 域/ 中/ 执行/ ,/ 即/ d/ ./ write/ ./ v/ ./ / / α/ U/ ,/ 则/ 有/ dom/ (/ ax/ )/ DwD/ ./ 根据/ 定理/ 1/ (/ v/ )/ 的/ 条件/ 知/ s/ ~/ dom/ (/ ax/ )/ Dt/ ,/ 即/ getParam/ (/ v/ ,/ s/ )/ =/ getParam/ (/ v/ ,/ t/ )/ ,/ 于是/ 如果/ 有/ d/ ./ read/ ./ v/ ./ / ∈/ α/ W/ ,/ 则/ 在/ 执行/ 动作/ d/ ./ write/ ./ v/ ./ / 后/ ,/ 域/ w/ 上/ 有/ getData/ (/ d/ ,/ step/ (/ s/ ,/ ax/ )/ )/ =/ getData/ (/ d/ ,/ step/ (/ t/ ,/ ax/ )/ )/ ,/ 而/ 对于/ 域/ w/ 上/ 可/ 观察/ 的/ 其它/ 存储/ 或/ 变量/ 不会/ 因/ 动作/ d/ ./ write/ ./ v/ ./ / 的/ 执行/ 而/ 改变/ ,/ 因此/ 满足/ (/ v/ )/ ./ ③/ 如果/ dom/ (/ ax/ )/ IwD/ ,/ 即/ d/ ./ write/ ./ v/ ./ / ∈/ α/ U/ ,/ 根据/ 数据完整性/ 条件/ / d/ ./ write/ ∈/ α/ U/ / d/ ./ read/ / α/ W/ 知/ ,/ d/ ./ read/ / α/ W/ ,/ 即/ d/ 的/ 改变/ 不会/ 被域/ w/ 所/ 观察/ 到/ ,/ 仍/ 有/ / d/ ./ read/ ./ v/ ./ / ∈/ α/ W/ ,/ getData/ (/ d/ ,/ s/ )/ =/ getData/ (/ d/ ,/ step/ (/ s/ ,/ ax/ )/ )/ ,/ getParam/ (/ v/ ,/ s/ )/ =/ getParam/ (/ v/ ,/ step/ (/ s/ ,/ ax/ )/ )/ ,/ 即/ values/ (/ s/ ,/ w/ )/ =/ values/ (/ step/ (/ s/ ,/ ax/ )/ ,/ w/ )/ ,/ 满足/ 定理/ 1/ 的/ (/ vi/ )/ ./ 综上所述/ ,/ 系统/ M/ 满足/ 定理/ 1/ 的/ 条件/ (/ iv/ )/ (/ v/ )/ (/ vi/ )/ ./ 因此/ ,/ 根据/ (/ 1/ )/ 、/ (/ 2/ )/ 的/ 证明/ 结论/ 知/ ,/ 系统/ M/ 满足/ 安全策略/ ./ 下节/ 主要/ 通过/ 操作系统/ 中/ 的/ 一个/ 实例/ 来/ 说明/ 如何/ 通过/ 上述/ 方案/ 来/ 描述/ 系统/ 设计/ 以及/ 分析/ 和/ 验证/ 系统/ 是否/ 满足/ 给定/ 的/ 信息流/ 策略/ ./ 4/ 实例/ 研究/ :/ 引用/ 监控器/ 设计/ 的/ 安全/ 分析/ 与/ 策略/ 验证/ 本文/ 所/ 研究/ 的/ 扩展/ 不/ 干扰/ 模型/ (/ ENISM/ )/ 和/ 基于/ 通信/ 顺序进程/ (/ CSP/ )/ 的/ 描述/ 和/ 验证/ 方法/ 是/ 作者/ 参与/ 的/ “/ 八/ 六三/ ”/ 课题/ “/ 分布式/ 可信计算/ 系统/ 研究/ ”/ 中/ 的/ 研究成果/ 之一/ ,/ 被/ 用/ 在/ 对/ 操作系统/ 的/ 安全/ 服务器/ 、/ 引用/ 监视器/ 以及/ 操作系统/ 微内核/ 等/ 关键/ 模块/ 的/ 正确性/ 、/ 完整性/ 、/ 不可/ 旁路/ 性/ 的/ 验证/ 上/ ./ 本节/ 以/ 引用/ 监控器/ 的/ 设计/ 为例/ ,/ 验证/ 与/ 引用/ 监控器/ 的/ 完整性/ 和/ 不可/ 旁路/ 性/ 相关/ 的/ 信息流/ 策略/ ,/ 即/ 借助/ 形式化/ 验证/ 工具/ FDR2/ 来/ 验证/ 引用/ 监控器/ 是否/ 满足/ 定理/ 2/ 的/ 两个/ 条件/ ./ 通过/ 该/ 实例/ 说明/ ENISM/ 的/ 正确性/ 、/ 有效性/ 和/ 可用性/ ./ 验证/ 的/ 过程/ 主要/ 分为/ 以下/ 几个/ 步骤/ :/ (/ 1/ )/ 系统/ 功能分析/ 和/ 安全/ 域/ 划分/ ./ 该/ 实例/ 是/ 一个/ 有关/ 安全/ 操作系统/ 中/ 的/ 引用/ 监控器/ 的/ 实例/ ./ 任何/ 用户/ 要/ 访问/ 文件系统/ 都/ 必须/ 经过/ 引用/ 监控器/ 来/ 进行/ 访问控制/ ./ 如图/ 1/ 所示/ ,/ 安全/ 服务器/ 用于/ 存放/ 主客体/ 的/ 安全/ 标识/ 、/ 修改/ 安全策略/ 以及/ 协助/ 引用/ 监控器/ 进行/ 访问控制/ 决策/ ./ 引用/ 监控器/ 是/ 访问控制/ 的/ 执行/ 单元/ ,/ 安全/ 服务器/ 才/ 是/ 真正/ 的/ 决策/ 单元/ ,/ 模块/ 交互/ 图/ 如下/ ./ 安全/ 服务器/ 被/ 分为/ 配置管理/ 模块/ 和/ 决策/ 模块/ ./ 配置管理/ 模块/ 负责/ 对/ 策略/ 文件/ 的/ 维护/ 和/ 修改/ ,/ 需要/ 访问/ 文件系统/ 读取/ 策略/ 文件/ ./ 决策/ 模块/ 负责/ 对/ 应用程序/ 的/ 访问/ 请求/ 进行/ 权限/ 判断/ ,/ 也/ 需要/ 通过/ 文件系统/ 读取/ 策略/ 文件/ ./ 应用程序/ 同样/ 需要/ 通过/ 文件系统/ 访问/ 资源/ ./ 文件系统/ 的/ 入口/ 是/ 引用/ 监控器/ ,/ 所有/ 请求/ 都/ 必须/ 首先/ 经过/ 引用/ 监控器/ ,/ 引用/ 监控器/ 通过/ 向/ 安全/ 服务器/ 决策/ 模块/ 请求/ 决策/ 来/ 决定/ 是否/ 执行/ 文件/ 操作/ ./ 下为/ FDR2/ 中/ 源码/ 的/ 部分/ 截图/ )/ :/ (/ 2/ )/ 用/ CSP/ 描述/ 各/ 模块/ 的/ 执行/ 过程/ 和/ 数据/ 资源/ 下面/ 我们/ 用/ CSP/ 来/ 描述/ 各/ 模块/ 的/ 执行/ 过程/ (/ 以/ (/ a/ )/ 引用/ 监控器/ 的/ 描述/ 引用/ 监视器/ (/ RM/ )/ 接收/ 请求/ 访问/ 文件系统/ 的/ 进程/ 信息/ Pinfo/ 、/ 要/ 访问/ 的/ 文件/ 信息/ ,/ 如果/ 是/ 安全/ 服务器/ (/ SS/ )/ 的/ 请求/ (/ 包括/ 配置/ 模块/ (/ SSA/ )/ 和/ 决策/ 模块/ (/ SSD/ )/ )/ ,/ 则/ 通知/ 文件系统/ FS/ 执行/ ,/ 否则/ 向/ SSD/ 发送/ permQuery/ ,/ 询问/ 请求/ 进程/ 是否/ 有/ 访问/ 该/ 文件/ 的/ 权限/ ./ 如果/ SSD/ 返回/ Yes/ ,/ 则/ 通知/ FS/ 执行/ ,/ 否则/ 向/ 请求者/ 返回/ 拒绝/ 信息/ reject/ ./ Page10/ (/ b/ )/ 安全/ 服务器/ 的/ 描述/ 块/ (/ SSD/ )/ ,/ 写/ 策略/ 模块/ (/ SSDc/ )/ ./ 安全/ 服务器/ (/ SS/ )/ 分为/ 配置/ 模块/ (/ SSA/ )/ ,/ 决策/ 模/ SSA/ 接受/ 管理员/ 的/ 命令/ 向/ 文件系统/ FS/ 请求/ 更新/ 策略/ 文件/ ,/ 请求/ 被/ RM/ 截获/ ./ 更新/ 完毕/ ,/ 会/ 发送/ 消/ (/ c/ )/ 客户程序/ 的/ 描述/ 客户程序/ Client/ 接收/ 用户/ 输入/ ,/ 并/ 向/ FS/ 请求/ (/ d/ )/ 文件系统/ 的/ 描述/ 文件系统/ FS/ 接收/ RM/ 的/ 指令/ accessFS/ ,/ 执行/ (/ e/ )/ 消息传递/ 进程/ 的/ 描述/ 实际/ 系统/ 中是/ 由/ 内核/ 实现/ 消息传递/ 的/ ,/ 这里/ 引入/ msgPass/ 进程/ 实现/ 该/ 功能/ ./ 用于/ 接收/ 和/ 转发/ 其它/ 上述/ 各/ 模块/ 并发/ 执行/ ,/ 并/ 通过/ msgPass/ 同步/ ,/ 构成/ 完整/ 的/ 系统/ M/ ,/ 其/ 描述/ 如下/ :/ M/ =/ (/ SSA/ |/ |/ |/ SSD/ |/ |/ |/ SSDc/ |/ |/ |/ Client/ |/ |/ |/ RM/ |/ |/ |/ RM/ |/ |/ |/ RM/ |/ |/ |/ FS/ |/ |/ |/ FS/ |/ |/ |/ FS/ )/ [/ |/ aM/ |/ ]/ msgPass/ ./ 上述/ CSP/ 描述/ 构成/ 了/ 系统/ 的/ 完整/ 描述/ ,/ 以/ ./ csp/ 文件/ 的/ 形式/ 提交/ 给/ 形式化/ 验证/ 工具/ FDR2/ 进一步/ 分析/ ./ (/ 3/ )/ 提出/ 安全/ 目标/ ,/ 制定/ 安全策略/ ,/ 安全策略/ 反映/ 为/ 不/ 干扰/ 关系/ ./ 由于/ 篇幅/ 的/ 限制/ ,/ 我们/ 仅/ 对/ 引用/ 监控器/ 最/ 敏感/ 的/ 不可/ 旁路/ 的/ 安全/ 目标/ 进行/ 验证/ ./ 由于/ 安全/ 服务器/ 配置/ 模块/ SSA/ 和/ 用户/ 模块/ Client/ 都/ 提供/ 了/ 对/ 用户/ 的/ 接口/ ,/ 根据/ 用户/ 请求/ 访问/ 文件系统/ FS/ ,/ 它们/ 是/ RM/ 主要/ 监控/ 的/ 对象/ ./ 因此/ ,/ 本例/ 验证/ 的/ 目标/ 是/ :/ SSA/ 和/ Client/ 不/ 可以/ 绕过/ RM/ 直接/ 干扰/ 文件系统/ FS/ ./ 验证/ 目标/ 描述/ 成/ 不/ 干扰/ 关系/ 是/ :/ 息/ exchangeAD/ 通知/ SSDc/ 修改/ 内存/ 中/ 的/ 策略信息/ ./ SSD/ 接受/ 来自/ RM/ 的/ 权限/ 决策/ 请求/ permQuery/ ,/ 并/ 依据/ permQuery/ 中/ 的/ 用户/ 信息/ 和/ 请求/ 操作/ 查询/ 策略/ 库/ ,/ 得到/ 决策/ 结果/ ,/ 并/ 将/ 决策/ 结果/ 返回/ RM/ ./ 文件/ 访问/ ,/ 文件/ 请求/ 被/ RM/ 截获/ 并/ 处理/ ./ 客户程序/ 等待/ 处理结果/ accqueryResult/ ./ 文件/ 操作/ ,/ 并/ 向/ RM/ 返回/ 结果/ ./ 进程/ 之间/ 的/ 同步/ 消息/ ,/ 以/ 实现/ 进程/ 间/ 同步/ ./ msgPass/ 描述/ 的/ 片断/ 如下/ :/ SSAIRMI/ ;/ ClientIRMI/ ;/ SSAIRMD/ ;/ ClientIRMD/ ;/ SSAIFSI/ ;/ ClientIFSI/ ;/ SSAIFSD/ ;/ ClientIFSD/ ;/ RMIFSI/ ;/ RMIFSD/ ;/ SSDIRMI/ ;/ SSDIRMD/ ;/ SSAISSDI/ ;/ ClientISSDI/ ;/ SSAISSDD/ ;/ ClientISSDD/ ;/ SSDcIRMI/ ;/ SSDcIRMD/ ;/ SSDcIFSI/ ;/ SSDcIFSD/ ;/ SSAISSDcI/ ;/ SSAISSDcD/ ./ 上述/ 不/ 干扰/ 关系/ 表明/ SSA/ 、/ Client/ 、/ SSDc/ 只能/ 向/ RM/ 传递数据/ 而/ 不能/ 改变/ 其/ 执行/ 路径/ ;/ SSA/ 、/ Client/ 、/ SSDc/ 既/ 不能/ 直接/ 向/ SSD/ 、/ FS/ 传递数据/ 也/ 不能/ 改变/ 其/ 执行/ 路径/ ;/ RM/ 可以/ 与/ FS/ 有/ 直接/ 的/ 交互/ ,/ 甚至/ 调用/ FS/ 执行/ ./ (/ 4/ )/ 根据/ 定理/ 2/ (/ 2/ )/ 验证/ 以下/ 对/ 数据/ 存储/ 的/ 不/ 干/ SSAIFSD/ ;/ ClientIFSD/ ;/ SSAISSDD/ ;/ ClientISSDD/ ;/ SSDcIFSD/ ./ 扰/ 关系/ :/ Page11/ 验证/ 过程/ 如下/ :/ SSA/ 写/ 数据/ 集合/ 为/ {/ accquerycont/ ./ write/ ./ ac/ -/ cFile/ ./ SSAn/ ,/ accqueryPinfo/ ./ write/ ./ Pinfo/ ./ SSAn/ ,/ exchangeAD/ ./ write/ ./ result/ ./ SSAn/ }/ ;/ 影响/ 到/ 的/ 读数据/ 集合/ 为/ {/ accquerycont/ ./ read/ ./ accFile/ ./ RMn/ ,/ ac/ -/ cqueryPinfo/ ./ read/ ./ Pinfo/ ./ RMn/ ,/ exchangeAD/ ./ read/ ./ result/ ./ SSDn/ }/ ;/ Client/ 写/ 数据/ 集合/ 为/ {/ accquerycont/ ./ write/ ./ ac/ -/ cFile/ ./ Clientn/ ,/ accqueryPinfo/ ./ write/ ./ Pinfo/ ./ Cli/ -/ entn/ }/ ;/ 影响/ 到/ 的/ 读数据/ 集合/ 为/ {/ accquerycont/ ./ read/ ./ accFile/ ./ RMn/ ,/ accqueryPinfo/ ./ read/ ./ Pinfo/ ./ RMn/ }/ ;/ 修改/ 后/ 的/ SSDc/ 写/ 数据/ 集合/ 为/ {/ accquerycont/ ./ write/ ./ accFile/ ./ SSDn/ ,/ accqueryPinfo/ ./ write/ ./ Pinfo/ ./ SSDn/ ,/ exchangeDA/ ./ write/ ./ policyinfo/ ./ SSDn/ ,/ poli/ -/ cyFlash/ ./ write/ ./ policyInfo/ ./ SSDn/ }/ ;/ 影响/ 到/ 的/ 读数据/ 集合/ 为/ {/ accquerycont/ ./ read/ ./ accFile/ ./ RMn/ ,/ ac/ -/ cqueryPinfo/ ./ read/ ./ Pinfo/ ./ RMn/ ,/ exchangeDA/ ./ read/ ./ policyinfo/ ./ SSAn/ }/ ,/ 即/ 满足/ SSDcIFSD/ ./ (/ 5/ )/ 根据/ 定理/ 2/ (/ 1/ )/ 借助/ FDR2/ 来/ 验证/ 以下/ 执行/ 不/ 干扰/ 关系/ :/ 将/ 上节/ 得到/ 的/ ./ CSP/ 源文件/ 输入/ FDR2/ 中/ ,/ 根据/ 定理/ 2/ (/ 1/ )/ 可知/ 要/ 证明/ 系统/ 满足/ SSAIRMI/ ;/ ClientIRMI/ ;/ SSAIFSI/ ;/ ClientIFSI/ ;/ SSAISSDI/ ;/ ClientISSDI/ ;/ SSDcIRMI/ ;/ SSDcIFSI/ 图/ 3/ 不/ 确定/ 轨迹/ 分析/ 图/ 2/ 表明/ ,/ 表达式/ checkM/ 不/ 满足/ 确定性/ ,/ 图/ 3/ 显示/ 了/ 错误/ 的/ 原因/ ./ 图/ 3/ 的/ 两幅/ 截图/ 显示/ 了/ 两条/ 执行/ 路径/ ,/ 第/ 2/ 幅中/ RM/ 由于/ 接收/ 到/ pinfo/ 传递/ 来/ 的/ 参数值/ 为/ Admin/ ,/ 则/ 可以/ 执行/ access/ ./ write/ ./ accFile/ ./ RMn/ ,/ 而/ 第一幅/ 图则/ 由于/ 接收/ 的/ pinfo/ 的/ 参数值/ 为/ SSDc/ 写/ 数据/ 集合/ 为/ {/ accessFS/ ./ write/ ./ accFile/ ./ SSDn/ ,/ exchangeDA/ ./ write/ ./ policyinfo/ ./ SSDn/ ,/ poli/ -/ cyFlash/ ./ write/ ./ policyInfo/ ./ SSDn/ }/ ;/ 影响/ 到/ 的/ 读数据/ 集合/ 为/ {/ accessFS/ ./ read/ ./ accFile/ ./ FSn/ ,/ exchangeDA/ ./ read/ ./ policyinfo/ ./ SSAn/ }/ 显然/ 满足/ SSAIFSD/ ;/ ClientIFSD/ ;/ SSAISSDD/ ;/ ClientISSDD/ ,/ 但是/ 不/ 满足/ SSDcIFSD/ ,/ 因为/ 在/ SSDc/ 的/ 读数据/ 集合/ 中/ 存在/ accessFS/ ./ read/ ./ accFile/ ./ FSn/ ,/ 即/ SSDc/ 绕过/ RM/ 直接/ 将/ 数据/ 写到/ FS/ 中/ ./ 修改/ SSDc/ 如下/ ./ 即要/ 判定/ 以下/ 表达式/ 的/ 确定性/ (/ β/ U/ 在/ FDR2/ 中/ 写作/ bU/ )/ :/ 结果/ 如图/ 2/ 所示/ ./ Client/ ,/ 不/ 允许/ 执行/ access/ ./ write/ ./ accFile/ ./ RMn/ ,/ 从而/ 产生/ 不/ 确定/ ./ 因此/ ,/ 产生/ 不/ 确定/ 的/ 原因/ 是/ 由于/ SSA/ ,/ Clien/ ,/ SSDc/ 之一/ 传递/ 给/ RM/ 的/ 数据/ 值/ pinfo/ 可能/ 干扰/ 了/ RM/ 的/ 执行/ ,/ 即/ 不/ 满足/ SSAIRMI/ ;/ ClientIRMI/ ;/ SSDcIRMI/ 之一/ ./ 实际/ 的/ 意义/ 是/ :/ Page12/ 当/ SSA/ ,/ Clien/ ,/ SSDc/ 之一/ 被/ 攻破/ 而/ 以/ 管理员/ 的/ 角色/ 访问/ RM/ 时/ ,/ RM/ 不会/ 对/ 该/ 进程/ 的/ 访问/ 请求/ 做/ 实质性/ 的/ 检查/ ,/ 即/ 不会/ 将/ 请求/ 送到/ SSD/ 中/ 验证/ ,/ 因此/ ,/ 该/ 进程/ 可以/ 绕过/ RM/ 执行/ 任意/ 文件/ 访问/ 操作/ ./ 图/ 4/ 修改/ 后/ 的/ 执行/ 结果/ 显然/ ,/ 修改/ 后/ 的/ 系统/ 设计/ 可/ 证明/ 解决/ 了/ 引用/ 监视器/ RM/ 被/ 旁路/ 的/ 问题/ ./ 5/ 总结/ 与/ 展望/ 本文/ 提出/ 的/ 扩展/ 不/ 干扰/ 模型/ ENISM/ 可/ 用于/ 分析/ 操作系统/ 中/ 可能/ 存在/ 的/ 违背/ 信息流/ 策略/ 的/ 执行/ 轨迹/ 和/ 数据/ 流动/ ,/ 从而/ 分析/ 系统/ 中/ 的/ 存储/ 隐蔽/ 通道/ ,/ 解决/ 信道/ 控制/ 问题/ ,/ 验证/ 信息流/ 策略/ ./ 该/ 模型/ 视/ 操作系统/ 的/ 不同/ 功能模块/ 为/ 执行/ 域/ ,/ 强调/ 将/ 未来/ 可能/ 执行/ 的/ 行为/ 序列/ 集合/ 与/ 数据/ 存储/ 值/ 集合/ 一同/ 作为/ 分析/ 执行/ 域/ 安全/ 状态/ 改变/ 的/ 依据/ ./ 并/ 通过/ 分析/ 单步/ 动作/ 的/ 执行/ 对系统/ 执行/ 和/ 信息/ 流动/ 的/ 影响/ 总结/ 出/ 安全/ 的/ 状态/ 转换/ 条件/ ./ 本文/ 还/ 基于/ 通信/ 顺序进程/ CSP/ 给出/ 了/ 形式化/ 的/ 系统/ 设计/ 描述/ 方法/ 和/ ENISM/ 策略/ 表达/ 及/ 验证/ 方法/ ,/ 并/ 通过/ 一个/ 实例/ 展示/ 了/ ENISM/ 及/ 相应/ 策略/ 验证/ 方法/ 的/ 正确性/ 和/ 有效性/ ./ 虽然/ 目前/ 已/ 存在/ 多种/ 形式化/ 验证/ 工具/ ,/ 但是/ 对/ 可验证/ 的/ 系统/ 规模/ 还/ 存在/ 一定/ 的/ 限制/ ,/ 而且/ 系统/ 描述/ 也/ 需要/ 人工/ 的/ 参与/ ./ 因此/ ,/ 在/ 实际/ 的/ 策略/ 验证/ 过程/ 中/ ,/ 如何/ 对/ 复杂/ 的/ 系统/ 实现/ 合理/ 的/ 分解/ ,/ 以/ 提高/ 验证/ 的/ 效率/ ;/ 如何/ 改进/ ENISM/ 模型/ ,/ 使/ 验证/ 条件/ 更/ 简单/ 更/ 便于/ 验证/ ,/ 都/ 是/ 需/ 进一步/ 研究/ 的/ 重点/ ./ 

