Page1/ 类/ 选择/ 排序/ 的/ 可逆/ 逻辑/ 综合/ 算法/ 万四爽/ 陈汉武/ 曹如进/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 210096/ )/ 摘要/ 可逆/ 逻辑/ 综合/ 是/ 指/ 对/ 给定/ 的/ 可逆/ 函数/ 自动/ 构造/ 对应/ 的/ 可逆/ 逻辑电路/ ./ 由于/ 搜索/ 空间/ 随/ 电路/ 规模/ 增长/ 成/ 指数/ 增长/ ,/ 现有/ 的/ 可逆/ 逻辑/ 综合/ 算法/ 虽然/ 能够/ 得到/ 近似/ 最优/ 的/ 解/ ,/ 但是/ 都/ 存在/ 计算/ 时间/ 过长/ 的/ 问题/ ./ 文中/ 提出/ 了/ 一种/ 类似/ 选择/ 排序/ 的/ 可逆/ 逻辑/ 综合/ 算法/ ,/ 其实质/ 为/ 基于/ 变换/ 规则/ 的/ 合成/ 法/ ./ 它/ 采用/ 一个/ 无向/ 无权/ 图/ 表示/ 所有/ 可以/ 进行/ 变换/ 的/ 路径/ ,/ 在/ 综合/ 的/ 过程/ 中/ ,/ 采用/ 选择/ 排序/ 思想/ 每次/ 从小到大/ 的/ 选择/ 需要/ 交换/ 的/ 输出/ 项/ ,/ 然后/ 从/ 路径/ 选择/ 图中/ 找到/ 最优/ 的/ 路径/ 进行/ 变换/ ,/ 最终/ 使得/ 函数/ 的/ 输出/ 序列/ 有序/ 即/ 完成/ 综合/ ./ 此外/ ,/ 文中/ 还/ 对/ 得到/ 的/ 量子/ 电路/ 进行/ 了/ 优化/ ./ 实验/ 表明/ ,/ 相比/ 其它/ 综合/ 算法/ ,/ 该/ 算法/ 不仅/ 总能/ 获得/ 最优/ 解/ 或/ 近似/ 最优/ 解/ ,/ 而且/ 效率高/ 、/ 易于/ 实现/ ./ 关键词/ 量子/ 计算/ ;/ 可逆/ 逻辑/ 综合/ ;/ Toffoli/ 门/ ;/ 选择/ 排序/ ;/ 量子/ 电路/ 1/ 引言/ 量子/ 计算机/ 可/ 等效/ 为/ 一个/ 量子/ 图灵机/ ,/ 而/ 理论/ Page2/ 光/ 计算/ 和/ 信息/ 加密/ 等/ 领域/ 中/ ,/ 因此/ 可逆/ 逻辑/ 的/ 研究/ 已/ 变得/ 越来越/ 重要/ ./ 可逆/ 逻辑/ 综合/ 是/ 指/ 对/ 给定/ 的/ 可逆/ 函数/ 自动/ 构造/ 对应/ 的/ 可逆/ 逻辑电路/ ./ 与/ 经典/ 电路/ 不同/ ,/ 可逆/ 逻辑电路/ 不能/ 有/ 回路/ ,/ 不能/ 出现/ 扇入/ 、/ 扇出/ 操作/ ,/ 正是/ 这些/ 不同/ 决定/ 了/ 经典/ 的/ 电路/ 综合/ 方法/ 不能/ 适用/ 于/ 量子/ 可逆/ 逻辑电路/ 综合/ ./ 目前/ 量子/ 可逆/ 逻辑电路/ 大部分/ 采用/ Toffoli/ 门/ 根据/ 函数/ 的/ 真值表/ 进行/ 构造/ ,/ 主要/ 可以/ 分为/ 两大类/ ./ 一类/ 像/ 采用/ 布尔/ 可/ 满足/ 性/ (/ BooleanSatisfiability/ ,/ SAT/ )/ 方法/ [/ 2/ ]/ 、/ 定量/ 的/ 布尔/ 公式/ (/ Quan/ -/ tifiedBooleanFormula/ ,/ QBF/ )/ 方法/ [/ 3/ ]/ 、/ 动态/ 规划/ (/ DynamicProgramming/ ,/ DP/ )/ 方法/ [/ 4/ ]/ 和/ 符号/ 的/ 可达性/ (/ SymbolicReachability/ )/ [/ 5/ ]/ 等/ 近似/ 穷举/ 的/ 搜索/ 方法/ ,/ 虽然/ 能够/ 产生/ 最优/ 解/ ,/ 但是/ 由于/ 搜索/ 的/ 范围/ 过大/ ,/ 往往/ 需要/ 很长/ 的/ 计算/ 时间/ ,/ 而且/ 随着/ 电路/ 规模/ 的/ 增大/ ,/ 搜索/ 空间/ 会成/ 指数/ 增长/ ,/ 导致/ 运行/ 时间/ 无法忍受/ ./ 另一类/ 采用/ 启发式/ 的/ 搜索/ 方法/ ,/ 如/ Rademacher/ -/ Walsh/ 谱/ 均数/ 方法/ [/ 6/ ]/ 、/ 二进制/ 共享/ 决策/ 图/ 方法/ [/ 7/ ]/ 、/ 基于/ 模板/ 的/ 变换/ 法/ (/ Template/ -/ BasedTransformation/ )/ [/ 8/ ]/ 和/ 基于/ PPRM/ (/ Positive/ -/ PolarityRead/ -/ Muller/ )/ 表达式/ 的/ 变换/ 法/ [/ 9/ ]/ ./ 这类/ 方法/ 是/ 穷举法/ 的/ 改进/ ,/ 在/ 搜索/ 的/ 过程/ 中/ 增加/ 了/ 启发式/ 规则/ ,/ 减少/ 了/ 搜索/ 的/ 范围/ ,/ 缩短/ 了/ 运行/ 时间/ ,/ 但是/ 这/ 类/ 方法/ 合成/ 的/ 电路/ 往往/ 代价/ 不是/ 最小/ ,/ 而且/ 还/ 不能/ 保证/ 合成/ 算法/ 的/ 收敛性/ ./ 此外/ ,/ 还/ 可以/ 将/ 真值表/ 翻译成/ 酉矩阵/ ,/ 通过/ 选取/ 特定/ 的/ 通用/ 门库/ [/ 10/ ]/ 进行/ 分解/ ,/ 其/ 一般/ 的/ 解析/ 表达式/ 最近/ 也/ 已/ 给出/ [/ 11/ ]/ ./ 此外/ ,/ 最近/ 还有/ 新/ 的/ 研究/ 方向/ ,/ 对偶/ 量子/ 计算/ 和/ 对偶/ 量子/ 计算机/ [/ 12/ ]/ ,/ 其/ 变换/ 不再/ 满足/ 酉性/ ,/ 而且/ 可以/ 是/ 不/ 可逆/ 的/ [/ 12/ -/ 13/ ]/ ,/ 不过/ 上述/ 经典/ 的/ 可逆/ 逻辑/ 综合/ 算法/ 依然/ 可能/ 适用/ ./ 本文/ 在/ 真值表/ 的/ 基础/ 上/ 采用/ 一种/ 新/ 的/ 基于/ 变换/ 规则/ 的/ 综合/ 算法/ ,/ 提出/ 了/ 路径/ 选择/ 图/ 的/ 概念/ ,/ 其实质/ 是/ 用/ 一个/ 无向/ 无权/ 图/ 表示/ 变换/ 规则/ ,/ 通过/ 一系列/ 的/ 变换/ ,/ 把/ 输出/ 系列/ 变成/ 输入/ 序列/ ./ 在/ 综合/ 的/ 过程/ 中/ ,/ 采用/ 选择/ 排序/ 的/ 思想/ ,/ 按照/ 递增/ 顺序/ 每次/ 选择/ 相应/ 的/ 输出/ 项/ ,/ 从/ 路径/ 选择/ 图中/ 找到/ 适合/ 的/ 路径/ 进行/ 交换/ ,/ 直到/ 所有/ 输出/ 项/ 有序/ 即/ 把/ 输出/ 变成/ 了/ 输入/ ,/ 此时/ 综合/ 完成/ ./ 这样/ 得到/ 的/ 变化/ 序列/ 对应/ 的/ 量子/ 线路/ 的/ 逆序/ 即/ 为/ 综合/ 的/ 结果/ ./ 为了/ 减少/ 合成/ 线路/ 的/ 代价/ ,/ 本文/ 还/ 提出/ 了/ 一系列/ 的/ 优化/ 规则/ 化简/ 得到/ 的/ 量子/ 线路/ ./ 2/ 一些/ 基本概念/ 定义/ 1/ ./ Toffoli/ 门/ ./ 一个/ n/ 比特/ 的/ Toffoli/ 门/ 表示/ 为/ TOFn/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ ,/ 保持/ 前/ n/ -/ 1/ 个/ 输入/ 不变/ ,/ 只有/ 当前/ n/ -/ 1/ 个/ 输入/ 比特/ 同时/ 为/ 1/ 时才/ 改变/ 第/ n/ 个/ 输入/ 比特/ ./ TOF1/ (/ x1/ )/ 为/ 非门/ (/ NOT/ )/ ;/ TOF2/ (/ x1/ ,/ x2/ )/ 为/ 控制/ 非/ 门/ (/ CNOT/ )/ ;/ TOF3/ (/ x1/ ,/ x2/ ,/ x3/ )/ 为/ 标准/ Toffoli/ 门/ ,/ 如图/ 1/ 所示/ ./ 定义/ 2/ ./ n/ 个/ 输入/ 与/ n/ 个/ 输出/ 变量/ 的/ 布尔/ 函数/ f/ :/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ →/ {/ y1/ ,/ y2/ ,/ …/ ,/ yn/ }/ 是/ 可逆/ 函数/ 当且/ 仅/ 当/ f/ 是/ 双射/ 的/ ./ n/ 变量/ 的/ 可逆/ 函数/ 可以/ 用/ 真值表/ 描述/ ,/ 也/ 可以/ 用/ 整数/ 集合/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2n/ -/ 1/ -/ 1/ }/ 的/ 置换表示/ ./ 例如/ 函数/ f/ =/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 7/ ,/ 4/ ,/ 6/ ,/ 3/ ,/ 5/ }/ 表示/ 的/ 3/ 变量/ 可逆/ 函数/ 真值表/ 和/ 对应/ 的/ 电路/ 如图/ 2/ 所示/ ./ 定义/ 3/ ./ 等长/ 字符串/ p/ 和/ q/ 之间/ 的/ Hamming/ 距离/ H/ (/ p/ ,/ q/ )/ 是/ p/ 和/ q/ 对应/ 位置/ 的/ 不同/ 字符/ 的/ 个数/ ./ 特别/ 地/ ,/ 可逆/ 函数/ f/ 的/ 任一/ 输出/ 项/ 与/ 对应/ 输入/ 项/ 的/ Hamming/ 距离/ 简称/ 为/ 输出/ 项/ 的/ Hamming/ 距离/ ./ 定义/ 4/ ./ 函数/ f/ 的/ 复杂度/ C/ (/ f/ )/ 是/ 其/ 所有/ 输出/ 项/ 的/ Hamming/ 距离/ 之/ 和/ ./ 例如/ 图/ 2/ 中/ 函数/ f/ 的/ 复杂度/ 为/ C/ (/ f/ )/ =/ 0/ +/ 0/ +/ 0/ +/ 1/ +/ 0/ +/ 2/ +/ 2/ +/ 1/ =/ 6.3/ 初步/ 知识/ 在/ 这个/ 章节/ 我们/ 给出/ 类/ 选择/ 排序/ 可逆/ 逻辑/ 综合/ 算法/ 的/ 一些/ 定义/ 和/ 定理/ ./ 定义/ 5/ ./ 对/ n/ 比特/ 的/ 可逆/ 函数/ f/ ,/ 如果/ 存在/ 两个/ 只有/ 1/ 位/ 不同/ 的/ 输出/ 项/ A/ 、/ B/ ,/ 则/ 可/ 将/ A/ 、/ B/ 交换/ 而/ 得到/ 一个/ 新/ 的/ 可逆/ 函数/ f/ ,/ 这个/ 交换/ 操作/ 我们/ 定义/ Page3/ 为/ SWAP/ [/ A/ ,/ B/ ]/ ./ 每个/ SWAP/ 操作/ 都/ 可以/ 用/ 一个/ Toffoli/ 门/ 实现/ ./ 例/ 1/ ./ 考虑/ 图/ 2/ 函数/ f/ =/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 7/ ,/ 4/ ,/ 6/ ,/ 3/ ,/ 5/ }/ ,/ 其中/ 输出/ 项/ [/ 000/ ]/ 与/ [/ 001/ ]/ 只有/ 一位/ 不同/ ,/ 则/ 可以/ 做/ SWAP/ [/ 000/ ,/ 001/ ]/ 操作/ ,/ 从而/ 得到/ 一个/ 新/ 的/ 函数/ f/ =/ {/ 1/ ,/ 0/ ,/ 2/ ,/ 7/ ,/ 4/ ,/ 6/ ,/ 3/ ,/ 5/ }/ ,/ 对应/ 的/ Toffoli/ 门为/ TOF3/ (/ x/ -/ 定理/ 1/ ./ 每个/ SWAP/ 操作/ 改变/ 输出/ 项/ 的/ Hamming/ 距离/ 为/ 1/ ./ 证明/ ./ SWAP/ 操作/ 只/ 改变/ 了/ 输出/ 项/ 的/ 一位/ ,/ 故/ Hamming/ 距离/ 改变/ 为/ 1/ ./ 例如/ ,/ 将/ 输入/ 000/ 的/ 输出/ 000/ 改为/ 001/ ,/ 其/ Hamming/ 距离/ 减少/ 1/ ./ 定义/ 6/ ./ n/ 比特/ 可逆/ 函数/ 的/ 路径/ 选择/ 图/ G/ =/ (/ V/ ,/ E/ )/ 是/ 一个/ 无向/ 无权/ 图/ ,/ 点集/ V/ =/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2n/ -/ 1/ }/ 表示/ 2n/ 个/ 输入/ 或者/ 输出/ ,/ 边集/ E/ =/ {/ eij/ |/ / SWAP/ (/ i/ ,/ j/ )/ ,/ i/ ,/ j/ ∈/ V/ }/ ,/ 即/ 每/ 条边/ 表示/ 连接/ 的/ 2/ 个/ 顶点/ 能够/ 进行/ SWAP/ 操作/ ./ G/ 中/ 两/ 顶点/ A/ 、/ B/ 之间/ 存在/ 一条/ 路径/ ,/ 则/ 表明/ A/ 经过/ 一系列/ 的/ SWAP/ 操作/ 能够/ 到达/ B/ ,/ 路径/ 长度/ 为此/ 路径/ 经过/ 的/ 边数/ ./ 例/ 2/ ./ 对于/ 3/ 比特/ 的/ 路径/ 选择/ 图如图/ 4/ 所示/ ,/ 其中/ 点/ (/ 0/ )/ 2/ =/ 000/ 与/ (/ 1/ )/ 2/ =/ 001/ 之间/ 有/ 一条/ 边/ ,/ 表示/ 0/ ,/ 1/ 之间/ 可/ 进行/ SWAP/ [/ 000/ ,/ 001/ ]/ ./ 如果/ 需要/ 把/ 000/ 和/ 111/ 交换/ ,/ 可以/ 从图/ 中/ 找出/ 其中/ 一条/ 0/ ~/ 7/ 的/ 路径/ 000/ -/ >/ 001/ -/ >/ 101/ -/ >/ 111/ ,/ 则/ 经过/ SWAP/ [/ 000/ ,/ 001/ ]/ ,/ SWAP/ [/ 001/ ,/ 101/ ]/ ,/ SWAP/ [/ 101/ ,/ 111/ ]/ 可以/ 实现/ 0/ 和/ 7/ 的/ 交换/ ./ 定理/ 2/ ./ 可逆/ 函数/ 输出/ 项/ A/ 和/ B/ 的/ Hamming/ 距离/ 为/ k/ ,/ 则/ 在/ 路径/ 选择/ 图中/ A/ 到/ B/ 必然/ 存在/ 一条/ 长度/ 至少/ 为/ k/ 的/ 路径/ ,/ 即/ 交换/ A/ 和/ B/ 要/ 进行/ k/ 步/ SWAP/ 操作/ ./ 证明/ ./ 路径/ 选择/ 图是/ 连通/ 的/ ,/ 故/ A/ 到/ B/ 必然/ 存在/ 一条/ 路径/ ./ 由/ 定理/ 1/ ,/ SWAP/ 操作/ 每次/ 仅/ 改变/ A/ 或者/ B/ 的/ 1/ 位/ ,/ 而/ A/ 和/ B/ 的/ Hamming/ 距离/ 为/ k/ ,/ 故/ 交换/ A/ 、/ B/ 至少/ 需要/ k/ 次/ SWAP/ 操作/ ,/ 即/ A/ 到/ B/ 肯定/ 存在/ 一条/ 长度/ 至少/ 为/ k/ 的/ 路径/ ./ 根据/ 定理/ 2/ ,/ 很/ 容易/ 得出/ 如下/ 引理/ ./ 引理/ 1/ ./ 对于/ n/ 比特/ 可逆/ 函数/ ,/ 假设/ 需要/ 交换/ 的/ 两个/ 输出/ 项/ 分别/ 为/ A/ 和/ B/ ,/ 则/ A/ 与/ B/ 的/ Ham/ -/ ming/ 距离/ 1/ / H/ (/ A/ ,/ B/ )/ / n/ ./ (/ 1/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 1/ ,/ 则/ A/ 、/ B/ 之间/ 有/ 一条/ 直接/ 路径/ (/ 长度/ 为/ 1/ )/ ./ A/ 和/ B/ 可以/ 直接/ 交换/ ,/ 即/ 可以/ 直接/ 进行/ SWAP/ [/ A/ ,/ B/ ]/ 操作/ ./ (/ 2/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 2/ ,/ 则/ A/ 、/ B/ 间/ 有/ 长度/ 为/ 2/ 的/ 路径/ ,/ 即该/ 路径/ 上/ 有/ 一个/ 中间/ 结点/ C/ ,/ 则/ A/ 、/ B/ 交换/ 可以/ 通过/ C/ 实现/ SWAP/ [/ A/ ,/ C/ ]/ ,/ SWAP/ [/ C/ ,/ B/ ]/ ,/ 而/ 中间/ 结点/ C/ 有/ 两种/ 选择/ ,/ 故/ 路径/ 条数/ 为/ 2/ ./ (/ 3/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 3/ ,/ 则/ A/ 、/ B/ 间/ 有/ 长度/ 为/ 3/ 的/ 路径/ ,/ 即该/ 路径/ 上/ 有/ 两个/ 中间/ 结点/ A1/ ,/ B1/ ./ 则/ A/ ,/ B/ 的/ 交换/ 可以/ 通过/ A1/ ,/ B1/ 实现/ ,/ SWAP/ [/ A/ ,/ A1/ ]/ ,/ SWAP/ [/ A1/ ,/ B1/ ]/ ,/ SWAP/ [/ B1/ ,/ B/ ]/ ./ 因为/ A1/ 有/ 3/ 种/ 选择/ ,/ 对/ 特定/ 的/ A1/ 而/ B1/ 有/ 2/ 种/ 选择/ ,/ 故/ 路径/ 条数/ 为/ 3/ ×/ 2/ =/ 6/ ./ (/ 4/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ k/ ,/ 则/ A/ 到/ B/ 有/ 长度/ 为/ k/ 的/ 路径/ ,/ 且/ 路径/ 条/ 数最多/ 有/ k/ !/ 条/ ./ 定理/ 3/ ./ 函数/ f/ 与/ 经过/ SWAP/ 操作/ 后/ 得到/ 的/ 新/ 函数/ f/ 相比/ 复杂度/ 或加/ 2/ 或/ 减/ 2/ 或/ 不变/ ./ 证明/ ./ 假设/ f/ 的/ 两个/ 输出/ 项为/ A/ 、/ B/ 可以/ 进行/ SWAP/ 操作/ ,/ 在/ SWAP/ 之前/ A/ 、/ B/ 的/ Hamming/ 距离/ 分别/ 记为/ HA/ 、/ HB/ ./ 不失/ 一般性/ ,/ 假设/ A/ 、/ B/ 最后/ 一位/ 不同/ ,/ 则/ A/ 、/ B/ 可/ 表示/ 为/ SWAP/ 后/ ,/ 可以/ 看到/ HA/ ,/ HB/ 的/ 值/ 或/ +/ 1/ ,/ 或/ -/ 1/ ,/ 而/ HA/ ,/ HB/ 取值/ 互不/ 影响/ ,/ 故当/ HA/ ,/ HB/ 同时/ 取/ 1/ 时/ 函数/ f/ 的/ 复杂度/ C/ (/ f/ )/ 增加/ 2/ ;/ 当/ 同时/ 取/ -/ 1/ 时/ C/ (/ f/ )/ 减/ 2/ ;/ Page4/ 当取/ 不同/ 值/ 时时/ 复杂度/ C/ (/ f/ )/ 不变/ ./ 引理/ 2/ ./ 假设/ f/ 两个/ 输出/ 项/ A/ 和/ B/ 的/ Ham/ -/ ming/ 距离/ 为/ k/ ,/ 交换/ A/ 、/ B/ 得到/ 的/ 新/ 函数/ 为/ f/ ,/ 则/ 用/ 最少/ 次数/ 的/ SWAP/ 操作/ 后/ f/ 的/ 复杂度/ 至多/ 减少/ 2k/ ,/ 即/ max/ {/ C/ (/ f/ )/ -/ C/ (/ f/ )/ }/ =/ 2/ ×/ k/ ./ 证明/ ./ 根据/ 定理/ 2/ 可知/ ,/ f/ 到/ f/ 最少/ 需要/ 经过/ k/ 步/ SWAP/ 操作/ ./ 而/ 由/ 定理/ 3/ 每次/ SWAP/ 操作/ ,/ 最多能/ 减少/ 复杂度/ 值为/ 2/ ,/ 故/ 交换/ A/ 、/ B/ 后/ ,/ f/ 复杂度/ 至多/ 减少/ 2k/ ./ 从/ 引理/ 2/ 很/ 容易/ 得到/ 如下/ 推论/ ./ 推论/ 1/ ./ 对于/ 3/ 比特/ 可逆/ 函数/ ,/ 假设/ 需要/ 交换/ 的/ 2/ 个/ 输出/ 项/ 分别/ 为/ A/ 、/ B/ ,/ 则/ A/ 和/ B/ 的/ Hamming/ 距离/ 为/ 1/ / H/ (/ A/ ,/ B/ )/ / 3/ :/ (/ 1/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 1/ ,/ 交换/ A/ 、/ B/ 最多能/ 使/ 函数/ 复杂度/ 减少/ 2/ ./ (/ 2/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 2/ ,/ 交换/ A/ 、/ B/ 最多能/ 使/ 函数/ 复/ (/ 3/ )/ 当/ H/ (/ A/ ,/ B/ )/ =/ 3/ ,/ 交换/ A/ 、/ B/ 最多能/ 使/ 函数/ 复杂度/ 减少/ 4/ ./ 杂度/ 减少/ 6.4/ 算法/ 描述/ 算法/ 的/ 目的/ 是/ 通过/ 一系列/ 的/ SWAP/ 操作/ 使得/ 输出/ 序列/ 有序/ ,/ 而/ 每/ 一次/ SWAP/ 就/ 对应/ 一个/ Toffoli/ 门/ ./ 当/ 输出/ 序列/ 有序/ 即/ 输出/ 经过/ 一系列/ 的/ Toffoli/ 门/ 作用/ 变成/ 了/ 输入/ 时/ ,/ 把/ 变换/ 对应/ 的/ Toffoli/ 门/ 按/ 逆序/ 连接/ 组成/ 的/ 线路/ 即/ 为/ 综合/ 结果/ ./ 其/ 过程/ 类似/ 选择/ 排序/ :/ 按照/ 输入/ 从/ 0/ ~/ 2n/ -/ 1/ 的/ 顺序/ ,/ 通过/ 路径/ 选择/ 图中/ 的/ 合适/ 路径/ ,/ 每次/ 把/ 选择/ 最小/ 的/ 输出/ 项/ 将/ 其/ 交换/ 到/ 正确/ 的/ 位置/ ./ 其中/ 路径/ 的/ 选择/ 要/ 使/ 可逆/ 函数/ f/ 的/ 复杂度/ 逐渐/ 减少/ 直到/ 为/ 0/ ,/ 当/ f/ 的/ 复杂度/ 为/ 0/ 即/ 输出/ 项/ 有序/ 时/ 算法/ 终止/ ./ 算法/ 由/ 两/ 部分/ 组成/ :/ 路径/ 的/ 选择/ 和/ 电路/ 的/ 生成/ ./ 下面/ 详细描述/ 了/ 这/ 两步/ 算法/ ,/ 然后/ 给出/ 了/ 一个/ 完整/ 的/ 例子/ 来/ 说明/ 算法/ 是/ 如何/ 进行/ 的/ ./ 4.1/ 路径/ 的/ 选择/ 假设/ 需/ 交换/ 输出/ 项/ A/ 和/ B/ ,/ 其/ Hamming/ 距离/ 为/ k/ ./ 从/ 路径/ 选择/ 图/ 可以/ 看到/ :/ (/ 1/ )/ A/ 、/ B/ 可能/ 存在/ 多条/ 长度/ 不同/ 的/ 路径/ ,/ 而/ 根据/ 定理/ 2/ 只/ 需/ 从/ 路径/ 选择/ 图中/ 找/ 长度/ 为/ k/ 的/ A/ 到/ B/ 的/ 路径/ ;/ (/ 2/ )/ A/ 、/ B/ 可能/ 存在/ 多条/ 长度/ 为/ k/ 的/ 路径/ ,/ 根据/ 定理/ 3/ 如果/ 找到/ 一条/ 能/ 使/ 函数/ 复杂度/ 减少/ 2k/ 的/ 路径/ 则/ 算法/ 终止/ ,/ 否则/ 选择/ 一条/ 能/ 使/ 复杂度/ 减少/ 最多/ 的/ 路径/ ./ 同时/ ,/ 因为/ 已/ 遍历/ 过/ 的/ 输出/ 项/ 已经/ 有序/ ,/ 故可/ 将/ 其/ 对应/ 路径/ 选择/ 图中/ 的/ 结点/ 删除/ ,/ 从而/ 减少/ 路径/ 选择/ 的/ 复杂度/ ./ 由此可见/ ,/ 路径/ 选择/ 的/ 过程/ 是/ 个/ 终止/ 条件/ 很/ 容易/ 满足/ 的/ 深度/ 优先/ 搜索/ 的/ 过程/ ./ 算法/ 1/ ./ 从/ 路径/ 选择/ 图中/ 寻找/ 交换/ A/ ,/ B/ 的/ 路径/ ./ 输入/ :/ 路径/ 选择/ 图/ G/ ,/ 可逆/ 函数/ f/ ,/ 待/ 交换/ 的/ 输出/ 项/ A/ 、/ B/ 输出/ :/ 交换/ A/ 、/ B/ 后能/ 最大/ 地/ 减少/ f/ 复杂度/ 的/ A/ 到/ BFIND/ -/ SWAP/ -/ PATH/ (/ G/ ,/ A/ ,/ B/ )/ 1/ ./ 计算/ f/ 的/ 复杂度/ C/ (/ f/ )/ ;/ 2/ ./ h/ =/ H/ (/ A/ ,/ B/ )/ ,/ H/ (/ A/ ,/ B/ )/ 为/ A/ ,/ B/ 的/ Hamming/ 距离/ ;/ 3/ ./ ifh/ =/ 0return0/ ;/ 4/ ./ ifh/ =/ 1return/ 路径/ L/ :/ A/ →/ B/ ;/ 5/ ./ ifh/ >/ 16/ ./ 采用/ DFS/ 在/ G/ 中/ 寻找/ A/ 到/ B/ 的/ 路径/ ,/ 遍历/ 层数/ 为/ 7/ ./ ifC/ (/ f/ )/ -/ C/ (/ f/ )/ =/ 2/ / k/ ,/ 停止/ 遍历/ ,/ return8/ ./ else/ 遍历/ 所有/ 路径/ ,/ 找到/ Δ/ e/ =/ C/ (/ f/ )/ -/ C/ (/ f/ )/ 最大/ 的/ 9/ ./ returnL/ :/ A/ →/ …/ →/ B/ ;/ 10/ ./ End/ ./ 算法/ 2/ ./ 从/ 路径/ 选择/ 图中/ 删除/ 顶点/ X/ ./ 输入/ :/ 路径/ 选择/ 图/ G/ ,/ 待/ 删除/ 顶点/ X/ 输出/ :/ 新/ 的/ 路径/ 选择/ 图/ DELETE/ -/ VERTEX/ (/ X/ )/ 1/ ./ 在/ 图/ G/ 中/ 找到/ 顶点/ X/ ;/ 2/ ./ 删除/ 所有/ 连接/ 到/ 顶点/ X/ 的/ 边/ ;/ 3/ ./ 删除/ 顶点/ X/ ;/ 4/ ./ returnG/ // // G/ 为/ 删除/ X/ 后/ 的/ 新图/ ;/ 4.2/ 线路/ 生成/ 类似/ 选择/ 排序/ ,/ 按照/ 输入/ 从/ 0/ ~/ 2n/ -/ 1/ 的/ 顺序/ ,/ 每次/ 选择/ 当前/ 最小/ 输出/ 项/ ,/ 通过/ 算法/ 1/ 得到/ 的/ 路径/ 把/ 其/ 交换/ 到/ 正确/ 的/ 位置/ ,/ 直到/ 整个/ 输出/ 序列/ 有序/ ./ 而/ 每/ 一次/ 交换/ 对应/ 一系列/ Toffoli/ 门/ ,/ 将/ 所有/ Toffoli/ 门/ 逆序/ 连接/ 组成/ 的/ 线路/ 即/ 为/ 综合/ 结果/ ./ 算法/ 3/ ./ 根据/ 可逆/ 函数/ f/ 生成/ Toffoli/ 门/ 表示/ 输入/ :/ 可逆/ 函数/ f/ :/ (/ 0/ ,/ 1/ ,/ 2/ ,/ …/ ,/ 2n/ -/ 1/ )/ →/ {/ y1/ ,/ y2/ ,/ …/ ,/ yn/ }/ 输出/ :/ Toffoli/ 门/ 表示/ 的/ 量子/ 线路/ BUILD/ -/ TOFFOLI/ -/ NETWORK/ (/ f/ )/ 1/ ./ fori/ =/ 0to2n/ -/ 22/ ./ ifi/ =/ y/ [/ i/ ]/ donothing/ ;/ 3/ ./ elseL/ =/ FIND/ -/ SWAP/ -/ PATH/ (/ G/ ,/ y/ [/ i/ ]/ ,/ i/ )/ ;/ 4/ ./ 按照/ 路径/ L/ 通过/ 一系列/ SWAP/ 操作/ 把/ i/ 交换/ 至/ 的/ 量子/ 线路/ Circuit/ ./ Page55/ ./ f/ =/ f/ // // 用/ f/ 更新/ f/ ;/ 6/ ./ Endelse7/ ./ DELETE/ -/ VERTEX/ (/ i/ )/ ;/ 8/ ./ Endfor9/ ./ 按照/ SWAP/ 操作/ 的/ 逆序/ 将/ 每个/ SWAP/ 对应/ 的/ 10/ ./ returnCircuit/ :/ {/ t1/ ,/ t2/ ,/ …/ ,/ tm/ }/ ./ 4.3/ 算法/ 正确性/ 证明/ 接下来/ 我们/ 给出/ 算法/ 的/ 正确性/ 证明/ ./ 定理/ 4/ ./ 路径/ 选择/ 图/ 按/ 顺序/ 删除/ 顶点/ 后/ 仍然/ 是/ 连通/ 的/ ./ 证明/ ./ 假设/ 当前/ 删除/ 的/ 顶点/ 为/ V/ (/ V/ ≠/ 2n/ -/ 1/ )/ ,/ 因为/ 是/ 按/ 顺序/ 删除/ ,/ 则/ V/ 中必/ 有/ 一位/ 为/ 0/ ,/ 不失/ 一般性/ 假设/ V/ =/ (/ x0/ ,/ x1/ ,/ …/ ,/ 0/ ,/ …/ ,/ xn/ )/ ,/ 则/ 必/ 存在/ V/ >/ V/ ,/ 其中/ V/ 相比/ V/ 在/ 刚刚/ 假设/ 为/ 0/ 的/ 位/ 上/ 是/ 1/ ,/ 即/ V/ =/ (/ x0/ ,/ x1/ ,/ …/ ,/ 1/ ,/ …/ ,/ xn/ )/ ,/ 故/ 在/ 路径/ 选择/ 图中/ 存在/ 一条/ 直接/ 路径/ 连接/ V/ 和/ V/ ./ 则/ 此/ 命题/ 得证/ ./ 证毕/ ./ 引理/ 3/ ./ 我们/ 提出/ 的/ 类/ 排序/ 可逆/ 逻辑/ 综合/ 算法/ 肯定/ 能/ 得到/ 可行/ 解/ ./ 证明/ ./ 由/ 算法/ 3/ 可以/ 看到/ 随着/ 输入/ 从/ 0/ 到/ 2n/ -/ 2/ ,/ 不断/ 的/ 通过/ 交换/ 使得/ 输出/ 序列/ 变得/ 有序/ ./ 当/ 前面/ 2n/ -/ 1/ 个/ 输出/ 项/ 有序/ 的/ 时/ ,/ 第/ 2n/ 项即/ 输入/ 值为/ 2n/ -/ 1/ 时/ ,/ 对应/ 的/ 输出/ 肯定/ 为/ 2n/ -/ 1/ ./ 而/ 由/ 定理/ 4/ 可以/ 得到/ 从/ 0/ ~/ 2n/ -/ 2/ 的/ 每步/ 中/ 路径/ 选择/ 图/ 都/ 是/ 连通/ 的/ ,/ 即/ 存在/ 交换/ 的/ 路径/ 使得/ 每步/ 的/ 输出/ 与/ 输入/ 相同/ ,/ 当/ 前面/ 2n/ -/ 1/ 个/ 输出/ 变得/ 有序/ 时/ ,/ 第/ 2n/ 项/ 必然/ 也/ 是/ 有序/ 的/ ./ 故类/ 选择/ 排序/ 综合/ 算法/ 能/ 得到/ 可行/ 解/ ./ 例/ 3/ ./ 以/ 可逆/ 函数/ f/ =/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ 为例/ ,/ 其/ 真值表/ 如图/ 5/ 所示/ ,/ 来/ 说明/ 类/ 选择/ 排序/ 算法/ 的/ 流程/ ./ 1/ ./ 类似/ 选择/ 排序/ ,/ 从/ 000/ 开始/ ,/ y/ [/ 000/ ]/ =/ 111/ ≠/ 000/ 即/ 000/ 对应/ 的/ 输出/ 111/ 不/ 在/ 正确/ 位置/ 上/ ,/ 故需/ 交换/ [/ 111/ ,/ 000/ ]/ ,/ 此时/ H/ (/ 000/ ,/ 111/ )/ =/ 3/ ,/ C/ (/ f/ )/ =/ 14/ ./ 根据/ 算法/ 1/ ,/ 通过/ 遍历/ 得到/ 第/ 1/ 条/ 路径/ (/ 1/ )/ 111/ -/ 101/ -/ 001/ -/ 000/ ,/ 按/ 这条/ 路径/ 交换/ 后/ 得到/ 函数/ 的/ 真值表/ 如图/ 6/ (/ a/ )/ 所示/ ,/ 复杂度/ 减少/ Δ/ C/ =/ 14/ -/ 10/ =/ 4/ ,/ 根据/ 推论/ 1/ ,/ 距离/ 为/ 3/ ,/ 复杂度/ 可/ 最/ 多/ 减少/ 6/ ,/ 即/ 还/ 可能/ 存在/ 比/ 4/ 更好/ 的/ 结果/ ,/ 故/ 继续/ 寻找/ 新/ 的/ 路径/ ;/ 接着/ 得到/ 第/ 2/ 条/ 路径/ (/ 2/ )/ 111/ -/ 101/ -/ 100/ -/ 000/ ,/ 按/ 这条/ 路径/ 交换/ 后/ 得到/ 函数/ 的/ 真值表/ 如图/ 6/ (/ b/ )/ 所示/ ,/ 函数/ 复杂度/ 减少/ 了/ 4/ ,/ 故/ 仍/ 需/ 继续/ 寻找/ 新/ 的/ 路径/ ;/ 接着/ 得到/ 第/ 3/ 条/ 路径/ (/ 3/ )/ 111/ -/ 011/ -/ 001/ -/ 000/ ,/ 按/ 这条/ 路径/ 交换/ 后/ 结果/ 如图/ 6/ (/ c/ )/ 所示/ ,/ 此时/ Δ/ C/ =/ 14/ -/ 8/ =/ 6/ ,/ 函数/ 复杂度/ 减少/ 6/ ,/ 根据/ 推论/ 1/ 可知/ 这是/ 最好/ 的/ 结果/ ,/ 故/ 不/ 需要/ 继续/ 寻找/ 新/ 的/ 路径/ ,/ 按/ 111/ -/ >/ 011/ -/ >/ 001/ -/ >/ 000/ 的/ 顺序/ 交换/ 即/ SWAP/ [/ 111/ ,/ 011/ ]/ ,/ SWAP/ [/ 011/ ,/ 001/ ]/ ,/ SWAP/ [/ 001/ ,/ 000/ ]/ 可/ 交换/ [/ 111/ ,/ 000/ ]/ ,/ 得到/ 新/ 的/ 函数/ f1/ =/ [/ 0/ ,/ 1/ ,/ 3/ ,/ 2/ ,/ 7/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ ./ 然后/ 删除/ 路径/ 选择/ 图中/ 的/ 000/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ b/ )/ 所示/ ./ 图/ 6/ 不同/ 路径/ 交换/ 000/ 和/ 111/ 后/ 对应/ 真值表/ 2/ ./ 接着/ 看/ 001/ 项/ ,/ 从图/ 6/ (/ c/ )/ 可以/ 看到/ 经过/ 步/ 1/ 后/ 000/ 对应/ 的/ 输出/ 项/ 已经/ 处于/ 正确/ 的/ 位置/ ,/ 而/ 001/ 输入/ 正好/ 对应/ 001/ 输出/ ,/ 故/ 这步/ 不/ 需要/ 作/ 交换/ 操作/ ,/ 只/ 需/ 删除/ 路径/ 选择/ 图上/ 001/ 的/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ c/ )/ 所示/ ./ 此时/ 可逆/ 函数/ 仍然/ 是/ f1/ =/ [/ 0/ ,/ 1/ ,/ 3/ ,/ 2/ ,/ 7/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ ./ 3/ ./ 当/ 输入/ 为/ 010/ 时/ ,/ 从图/ 6/ (/ c/ )/ 中/ 看到/ 输出/ y/ [/ 010/ ]/ =/ 011/ ≠/ 010/ ,/ 故需/ 交换/ [/ 111/ ,/ 010/ ]/ ,/ 此时/ H/ (/ 010/ ,/ 111/ )/ =/ 1/ ,/ C/ (/ f/ )/ =/ 8/ ./ 根据/ 引理/ 1/ ,/ 可以/ 直接/ 交换/ [/ 010/ ,/ 011/ ]/ 即/ SWAP/ [/ 010/ ,/ 011/ ]/ ,/ 得到/ 新/ 的/ 函数/ f2/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 7/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ ,/ 其/ 真值表/ 如图/ 8/ (/ a/ )/ 所示/ ./ 然后/ 删除/ 路径/ 选择/ 图中/ 的/ 010/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ d/ )/ 所示/ ./ 4/ ./ 当/ 输入/ 为/ 011/ 时/ ,/ 从图/ 8/ (/ a/ )/ 可以/ 看出/ 输出/ y/ [/ 011/ ]/ =/ 011/ =/ 011/ ,/ 故不需/ 进行/ 交换/ 操作/ ,/ 只/ 需/ 删除/ 路径/ 选择/ 图上/ 011/ 的/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ e/ )/ 所示/ ./ 此时/ ,/ 可逆/ 函数/ 依然/ 为/ f2/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 7/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ ./ 5/ ./ 当/ 输入/ 为/ 100/ 时/ ,/ 从图/ 8/ (/ a/ )/ 可以/ 看出/ 输出/ y/ [/ 100/ ]/ =/ 111/ ≠/ 100/ ,/ 需/ 交换/ [/ 111/ ,/ 100/ ]/ ,/ 此时/ H/ (/ 100/ ,/ 111/ )/ =/ 2/ ,/ C/ (/ f/ )/ =/ 6/ ./ 根据/ 算法/ 1/ 找到/ 第/ 1/ 条/ 路径/ (/ 1/ )/ 111/ -/ 101/ -/ 100/ ,/ 按照/ 这/ 条/ 路径/ 交换/ 得到/ 新/ 函数/ 的/ 真值表/ 如图/ 8/ (/ b/ )/ 所示/ ,/ 函数/ 复杂度/ 减少/ Δ/ C/ =/ 14/ -/ 10/ =/ 4/ ,/ 根据/ 推论/ 1/ ,/ 这/ 条/ 路径/ 是/ 最好/ 选择/ ,/ 故/ 不/ 需要/ 继续/ 进行/ 寻找/ 新/ 的/ 路径/ ,/ 按/ 111/ -/ >/ 101/ -/ >/ 100/ 的/ 顺序/ 交换/ 即/ 进行/ SWAP/ [/ 111/ ,/ 101/ ]/ ,/ SWAP/ [/ 101/ ,/ 100/ ]/ 操作/ 得到/ 新/ 函数/ f3/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 7/ ,/ 6/ ]/ ./ 然后/ 删除/ 路径/ 选择/ 图中/ 的/ 100/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ f/ )/ 所示/ ./ 6/ ./ 当/ 输入/ 为/ 101/ 时/ ,/ 从图/ 8/ (/ b/ )/ 可知/ 输出/ y/ [/ 101/ ]/ =/ 101/ =/ 101/ ,/ 故不需/ 进行/ 交换/ 操作/ ,/ 只/ 需/ 删除/ 路径/ 选择/ 图上/ 101/ 的/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ g/ )/ 所示/ ./ 此时/ ,/ f3/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ Page63/ ,/ 4/ ,/ 5/ ,/ 7/ ,/ 6/ ]/ ./ 7/ ./ 当/ 输入/ 为/ 110/ 时/ ,/ 从图/ 8/ (/ b/ )/ 可知/ 输出/ y/ [/ 110/ ]/ =/ 111/ ≠/ 110/ ,/ 故需/ 交换/ [/ 111/ ,/ 110/ ]/ ./ 此时/ H/ (/ 110/ ,/ 111/ )/ =/ 1/ ,/ C/ (/ f/ )/ =/ 2/ ./ 根据/ 引理/ 1/ ,/ 可以/ 直接/ 交换/ [/ 010/ ,/ 011/ ]/ 即/ 直接/ 进行/ SWAP/ [/ 110/ ,/ 图/ 73/ 比特/ 可逆/ 函数/ 路径/ 选择/ 图/ (/ (/ a/ )/ ~/ (/ h/ )/ 对应/ 步/ 1/ ~/ 8/ 分别/ 删除/ 顶点/ 000/ ,/ 001/ ,/ 010/ ,/ 011/ ,/ 100/ ,/ 101/ ,/ 110/ 后/ 的/ 路径/ 图/ )/ 图/ 88/ ./ 根据/ 步/ 1/ ~/ 7/ 得到/ 的/ SWAP/ 序列/ 为/ SWAP/ [/ 111/ ,/ 011/ ]/ ,/ SWAP/ [/ 011/ ,/ 001/ ]/ ,/ SWAP/ [/ 001/ ,/ 000/ ]/ ,/ SWAP/ [/ 010/ ,/ 011/ ]/ ,/ SWAP/ [/ 111/ ,/ 101/ ]/ ,/ SWAP/ [/ 101/ ,/ 100/ ]/ ,/ SWAP/ [/ 110/ ,/ 111/ ]/ ,/ 对应/ 的/ Toffoli/ 门/ 分别/ 为/ TOF3/ (/ x2/ ,/ x1/ ,/ x3/ )/ ,/ TOF3/ (/ x/ -/ TOF3/ (/ x/ -/ TOF3/ (/ x3/ ,/ x/ -/ 的/ 线路/ 如图/ 9/ 即/ 实现/ f/ =/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ ./ 图/ 9f/ =/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ 对应/ 的/ Toffoli/ 门/ 组成/ 的/ 电路图/ 4.4/ 算法/ 复杂度/ 分析/ 根据/ 算法/ 2/ ,/ 可以/ 看出/ 外层/ 循环/ 次数/ 为/ 2n/ -/ 2/ ,/ 在/ 循环/ 内部/ 每次/ 调用/ 算法/ 1FIND/ -/ SWAP/ -/ PATH/ 来/ 找到/ 交换/ 路径/ ,/ 而/ 其中/ 路径/ 个/ 数最多/ 为/ n/ !/ ,/ 所以/ 总/ 的/ 算法/ 复杂度/ 为/ 2n/ ×/ n/ !/ ./ 但/ 这/ 是/ 个/ 非常/ 宽泛/ 的/ 上/ 111/ ]/ 操作/ ,/ 得到/ 新/ 的/ 函数/ f4/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ,/ 7/ ]/ ,/ 其/ 真值表/ 如图/ 8/ (/ c/ )/ 所示/ ./ 然后/ 删除/ 路径/ 选择/ 图中/ 的/ 110/ 结点/ ,/ 得到/ 新/ 的/ 路径/ 选择/ 图如图/ 7/ (/ h/ )/ 所示/ ./ 此时/ ,/ 原函数/ f/ =/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ 已经/ 变成/ 恒等/ 函数/ f4/ =/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ,/ 7/ ]/ ./ 界/ ,/ 因为/ 我们/ 在/ 寻找/ 路径/ 的/ 时候/ ,/ 搜索/ 终止/ 条件/ 很/ 容易/ 满足/ ./ 此外/ ,/ 很/ 明显/ 看出/ 随着/ 算法/ 的/ 进行/ ,/ 可逆/ 函数/ 的/ 输出/ 趋向/ 有序/ ,/ 路径/ 图/ 顶点/ 数/ 越来越少/ ,/ 每次/ 选择/ 的/ 路径/ 越来越/ 短/ ,/ 路径/ 条数/ 越来越少/ ,/ 所以/ 实际/ 所/ 需/ 时间/ 远/ 小于/ 2n/ ×/ n/ !/ ./ 这/ 也/ 体现/ 在/ 后面/ 实验/ 结果/ 上/ ./ 5/ 优化/ 此时/ 算法/ 得到/ 的/ 电路/ 不是/ 最优/ 的/ ,/ 还/ 可以/ 继续/ 优化/ ,/ 接下来/ 给出/ 我们/ 的/ 优化/ 方法/ ./ 定理/ 5/ ./ 当/ Toffoli/ 门/ A/ =/ TOFk/ (/ x1/ ,/ x2/ ,/ …/ ,/ xk/ -/ 1/ ,/ xk/ )/ 与/ B/ =/ TOFl/ (/ y1/ ,/ y2/ ,/ …/ ,/ yl/ -/ 1/ ,/ yl/ )/ 满足/ (/ 1/ )/ xk/ / {/ y1/ ,/ y2/ ,/ …/ ,/ yl/ -/ 1/ }/ 或者/ (/ 2/ )/ / i/ ∈/ [/ 1/ ,/ k/ -/ 1/ ]/ ,/ j/ ∈/ [/ 1/ ,/ l/ -/ 1/ ]/ 满足/ xi/ =/ y/ -/ 证明/ ./ 条件/ 1/ 说明/ 了/ B/ 的/ 控制/ 端前/ 没有/ A/ 的/ 控制/ 端/ ,/ 故/ 无论/ A/ 如果/ 变化/ 都/ 不会/ 影响/ B/ ./ 条件/ 2/ 说明/ 了/ A/ 和/ B/ 的/ 控制/ 端/ 不/ 可能/ 同时/ 满足条件/ ,/ 即/ 输入/ Page7/ 相同/ 时/ ,/ A/ 和/ B/ 中/ 只有/ 一个/ 能起/ 作用/ ,/ 所以/ A/ 可以/ 对/ B/ 不会/ 有/ 影响/ ./ 由/ 定理/ 5/ 很/ 容易/ 得到/ 性质/ 1/ ./ 性质/ 1/ ./ 交换/ 规则/ ./ 若/ Toffoli/ 门/ A/ 与/ B/ 互不/ 影响/ ,/ 则/ 可以/ 交换/ A/ 、/ B/ 的/ 位置/ ./ 例/ 4/ ./ 如图/ 10/ (/ a/ )/ 中/ B/ 受控/ 端前/ 没/ A/ 的/ 控制/ 端/ ,/ A/ 的/ 受控/ 端前/ 没/ B/ 的/ 控制/ 端/ ,/ 则/ A/ 、/ B/ 可/ 交换/ ./ 图/ 10/ (/ b/ )/ 中当/ A/ 成立/ 时/ B/ 肯定/ 不/ 成立/ ,/ 同样/ B/ 成立/ 时/ A/ 肯定/ 不/ 成立/ ,/ 则/ 可/ 将/ A/ 、/ B/ 交换/ ./ 定理/ 6/ ./ 合并/ 规则/ ./ 相邻/ 的/ 2/ 个/ Toffoli/ 门/ ,/ 如果/ 受控/ 端/ 相同/ 而/ 控制/ 端/ 只有/ 一位/ 不同/ ,/ 则/ 可以/ 把/ 不同/ 的/ 控制/ 端/ 去掉/ ,/ 留下/ 相同/ 的/ 控制/ 端/ 和/ 受控/ 端/ 合并/ 成/ 1/ 个/ Toffoli/ 门/ ./ 证明/ ./ 不失/ 一般性/ 假设/ 相邻/ 的/ 2/ 个/ Toffoli/ 门/ A/ 、/ B/ ,/ 前/ n/ -/ 1/ 位为/ 控制/ 端/ ,/ 其中/ 第/ n/ -/ 1/ 位/ 控制/ 端/ 不同/ ,/ 第/ n/ 位为/ 受控/ 端/ ,/ 则/ A/ 表示/ 为/ TOFn/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ -/ 1/ ,/ xn/ )/ ,/ B/ 为/ TOFn/ (/ x1/ ,/ x2/ ,/ …/ ,/ x/ -/ 和/ B/ 作用/ 后/ ,/ 受控/ 端为/ xn/ =/ x1x2/ …/ x/ -/ 而/ 控制/ 端/ 不变/ ,/ 故得证/ ./ 图/ 11/ 中/ 给出/ 了/ Toffoli/ 门/ 的/ 一些/ 合并/ 例子/ ./ 定理/ 7/ ./ 消除/ 规则/ ./ 如果/ 存在/ 连续/ 的/ 两个/ 完全相同/ 的/ Toffoli/ 门/ ,/ 则/ 可以/ 将/ 这/ 2/ 个/ Toffoli/ 门/ 去掉/ ./ tm/ }/ 优化/ ./ 证明/ ./ 不失/ 一般性/ ,/ 假设/ 2/ 个/ 连续/ 的/ Toffoli/ 门为/ A/ 和/ B/ ,/ A/ 和/ B/ 相同/ ,/ 且/ 前/ n/ -/ 1/ 位为/ 控制/ 端/ ,/ 其中/ 第/ n/ 位为/ 受控/ 端/ ,/ 则/ A/ 和/ B/ 均/ 可/ 表示/ 为/ TOFn/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ -/ 1/ ,/ xn/ )/ ,/ 由于/ A/ 、/ B/ 完全相同/ ,/ 故/ 控制/ 端/ 不变/ ,/ 受控/ 端/ 经过/ A/ 和/ B/ 后/ 为/ xn/ =/ x1x2/ …/ xn/ -/ 1/ / (/ x1x2/ …/ xn/ -/ 1/ / xn/ )/ 故/ 经过/ A/ 、/ B/ 后/ 受控/ 端/ 也/ 没/ 变化/ ,/ 则/ 可/ 将/ A/ 、/ B/ 从/ 电路图/ 中/ 去掉/ ./ 根据/ 定理/ 6/ 和/ 定理/ 7/ 可/ 得到/ 如下/ 优化/ 算法/ ./ 算法/ 4/ ./ 对/ 算法/ 3/ 中/ 量子/ 线路/ Circuit/ :/ {/ t1/ ,/ t2/ ,/ …/ ,/ 输入/ :/ 算法/ 3/ 中/ 量子/ 线路/ Circuit/ :/ {/ t1/ ,/ t2/ ,/ …/ ,/ tm/ }/ 输出/ :/ 优化/ 后/ 的/ 量子/ 线路/ Optimal/ -/ CircuitOPTIMAL/ -/ CIRCUIT/ (/ Circuit/ )/ 1/ ./ fori/ =/ 1tom2/ ./ 根据/ 推论/ 2/ 尽可能/ 将/ 与/ t/ [/ i/ ]/ 有/ 相同/ 受控/ 端的/ 3/ ./ 根据/ 定理/ 6/ 尽可能/ 与/ t/ [/ i/ ]/ 后面/ 的/ Toffoli/ 门/ 进行/ 4/ ./ i/ =/ 不能/ 与/ t/ [/ i/ ]/ 合并/ 的/ 第一个/ Toffoli/ 门下/ 标/ ;/ 5/ ./ 得到/ 优化/ 后/ 的/ 量子/ 线路/ Optimal/ -/ Circuit/ ;/ 6/ ./ ifCircuit/ =/ Optimal/ -/ Circuitreturn/ 优化/ 后/ 的/ 量子/ 线路/ Optimal/ -/ Circuit/ ;/ 7/ ./ elseOPTIMAL/ -/ CIRCUIT/ (/ Optimal/ -/ Circuit/ )/ ./ 例/ 5/ ./ 考虑/ 例/ 4/ 中/ 得到/ 的/ 量子/ 电路/ ,/ 对/ 其/ 运用/ 算法/ 4/ ,/ 优化/ 过程/ 如图/ 12/ 所示/ ,/ 其中/ 图/ (/ a/ )/ 为/ 例子/ 中图/ 12f/ =/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ 得到/ Toffoli/ 门/ 的/ 合并/ 过程/ Page8/ 得到/ 的/ 量子/ 电路/ ,/ 步/ 1/ 和步/ 2/ 表示/ 进行/ 交换/ 操作/ ,/ 交换/ 后/ 得到/ 的/ 图/ 如/ (/ b/ )/ 所示/ ,/ 步/ 3/ 和步/ 4/ 表示/ 图/ (/ b/ )/ 中/ 电路/ 前/ 四项/ 和/ 后/ 两项/ 可以/ 分别/ 进行/ 合并/ ,/ 从而/ 可以/ 得到/ 图/ (/ c/ )/ 中/ 所示/ 的/ 最优/ 电路/ ./ 6/ 实验/ 结果/ 和/ 分析/ 为了/ 验证/ 本文/ 提出/ 的/ 算法/ 的/ 正确性/ ,/ 我们/ 用/ C++/ 编写/ 了/ 算法/ 的/ 实现/ 程序/ ,/ 对/ 任意/ 可逆/ 函数/ 均/ 可/ 得到/ 对应/ 的/ 电路图/ ,/ 实验/ 环境/ 是/ IntelCoreTM2CPU2/ ./ 13GHz/ ,/ 2GB/ 内存/ ,/ 操作系统/ 为/ WindowsXPSP2/ ./ 考虑/ 到/ 16/ !/ =/ 2.09227899/ ×/ 1013/ 对/ 计算/ 时间/ 和/ 存储/ 的/ 要求/ 难以实现/ ,/ 故/ 采用/ 流行/ 的/ 3/ ×/ 3/ 量子/ 电路/ 的/ 所有/ 可逆/ 函数/ 的/ 实验/ 来/ 进行/ 统计分析/ ,/ 不/ 进行/ 优化/ 总共/ 用时/ 0.219/ s/ ,/ 优化/ 后/ 总共/ 用时/ 0.410/ s/ ,/ 其/ 结果/ 如表/ 1/ 所示/ ./ 表/ 1/ 中/ 的/ 每/ 一行/ 表示/ 的/ 是/ 使用/ 相同/ 门/ 数量/ 对应/ 的/ 可逆/ 函数/ 的/ 个数/ ,/ 每一/ 列为/ 所有/ 可逆/ 函数/ 的/ 和/ 为/ 8/ !/ =/ 40320/ ./ 最优/ 情况/ 是/ 来自/ 文献/ [/ 4/ ]/ 中/ 的/ 实验/ 结果/ ,/ 使用/ 的/ 门库/ 含有/ NOT/ 、/ CNOT/ 、/ TOF3/ ;/ POT/ 列是/ 文献/ [/ 14/ ]/ 的/ 实验/ 结果/ ,/ 只/ 使用/ 了/ TOF3/ ,/ 是/ 目前/ 快速/ 综合/ 算法/ 中/ 比较/ 好/ 的/ 结果/ ;/ 优化/ 前/ 是/ 指/ 采用/ 本文/ 提出/ 的/ 算法/ 在/ 优化/ 前/ 只/ 使用/ 了/ TOF/ 门/ 的/ 结果/ ;/ 优化/ 后/ 的/ 结果/ 使用/ 了/ NOT/ 、/ CNOT/ 、/ TOF3/ 门/ ./ 从表/ 1/ 中/ 还/ 可以/ 明显/ 看出/ ,/ 优化/ 后/ 我们/ 的/ 算法/ 使用/ 的/ 门/ 数量/ 平均值/ 为/ 6.14/ ,/ 相比/ 文献/ [/ 10/ ]/ 中/ 的/ 6.83/ 更/ 接近/ 最优/ 值/ 的/ 5.87/ [/ 4/ ]/ ,/ 意味着/ 我们/ 的/ 算法/ 能/ 更/ 最近/ 最优/ 解/ ./ 表/ 2/ 和/ 其它/ 启发式/ 算法/ 的/ 比较/ 结果/ [/ 1/ ,/ 0/ ,/ 3/ ,/ 2/ ,/ 5/ ,/ 7/ ,/ 4/ ,/ 6/ ]/ [/ 7/ ,/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ]/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 6/ ,/ 5/ ,/ 7/ ]/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 4/ ,/ 3/ ,/ 5/ ,/ 6/ ,/ 7/ ]/ [/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ,/ 8/ ,/ 7/ ,/ 9/ ,/ 10/ ,/ 11/ ,/ 12/ ,/ 13/ ,/ 14/ ,/ 15/ ]/ 715777/ [/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ,/ 7/ ,/ 0/ ]/ [/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ ,/ 7/ ,/ 8/ ,/ 9/ ,/ 10/ ,/ 11/ ,/ 12/ ,/ 13/ ,/ 14/ ,/ 15/ ,/ 0/ ]/ [/ 0/ ,/ 7/ ,/ 6/ ,/ 9/ ,/ 4/ ,/ 11/ ,/ 10/ ,/ 13/ ,/ 8/ ,/ 15/ ,/ 14/ ,/ 1/ ,/ 12/ ,/ 3/ ,/ 2/ ,/ 5/ ]/ 436143TOF2/ (/ d/ ,/ a/ )/ TOF2/ (/ c/ ,/ b/ )/ TOF2/ (/ d/ ,/ c/ )/ [/ 3/ ,/ 6/ ,/ 2/ ,/ 5/ ,/ 7/ ,/ 1/ ,/ 0/ ,/ 4/ ]/ 门/ 的/ 数量/ 14131211109857778208906498171025310630831080956170499126572397315892149962953811242780183311614471362547634814992102907828210/ 门/ 数量/ 均值/ 5.876/ ./ 837.656/ ./ 14/ 接下来/ 采用/ 文献/ [/ 9/ ,/ 14/ -/ 16/ ]/ 中/ 用到/ 的/ 函数/ 综合/ 例子/ (/ 包括/ 9/ 个/ 3/ 比特/ 函数/ 和/ 3/ 个/ 4/ 比特/ 函数/ )/ ,/ 把/ 我们/ 的/ 算法/ 与/ 其它/ 目前/ 结果/ 较/ 好/ 的/ 算法/ 进行/ 比较/ ,/ 采用/ 的/ 包括/ PPRM/ 表达式/ 方法/ [/ 9/ ]/ 、/ Non/ -/ search/ 方法/ [/ 16/ ]/ 和/ POT/ 方法/ [/ 14/ ]/ ./ 其/ 结果/ 如表/ 2/ 所示/ ,/ 从表中/ 可以/ 看出/ ,/ 虽然/ 本文/ 得到/ 的/ 结果/ 和/ POT/ 方法/ 相同/ ,/ 接近/ PPRM/ 方法/ ,/ 好于/ Non/ -/ search/ 方法/ ,/ 但是/ 从/ 平均/ 时间/ 上/ 来说/ ,/ 在/ 实验/ 环境/ 不/ 优于/ 文献/ [/ 10/ ]/ (/ IntelXeon3GHz/ ,/ 2Gn/ 内存/ 的/ 工作站/ )/ 的/ 情况/ 下/ ,/ 本文/ 综合/ 每个/ 电路/ 的/ 平均/ 时间/ 为/ 0.01/ ms/ ,/ 远好/ 于/ POT/ 方法/ 的/ 0.2/ ms/ 和/ PPRM/ 方法/ 的/ 0.5/ s/ [/ 10/ ]/ ./ 由此可见/ ,/ 在/ 得到/ 近似/ 最优/ 电路/ 的/ 前提/ 下/ ,/ 我们/ 算法/ 的/ 效率/ 是/ 其它/ 算法/ 的/ 几十/ 到/ 几百倍/ ./ Page9/ [/ 1/ ,/ 2/ ,/ 7/ ,/ 5/ ,/ 6/ ,/ 3/ ,/ 0/ ,/ 4/ ]/ [/ 4/ ,/ 3/ ,/ 0/ ,/ 2/ ,/ 7/ ,/ 5/ ,/ 6/ ,/ 1/ ]/ [/ 7/ ,/ 5/ ,/ 2/ ,/ 4/ ,/ 6/ ,/ 1/ ,/ 0/ ,/ 3/ ]/ 此外/ ,/ 相比/ 其它/ 算法/ ,/ 很/ 明显/ 可以/ 看出/ 我们/ 的/ 算法/ 思路/ 简单/ 清晰/ ,/ 并且/ 在/ 任何/ 实验/ 环境/ 条件/ 下均/ 可/ 轻松/ 模拟/ 实现/ ./ 而且/ ,/ 对于/ 该/ 算法/ 得到/ 的/ TOFn/ 门/ ,/ 可以/ 很/ 容易/ 根据/ 文献/ [/ 11/ ]/ 中/ 的/ 方法/ 继续/ 化简/ ,/ 因此/ 该/ 算法/ 具有/ 一定/ 的/ 实用性/ ./ 7/ 结论/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 可逆/ 逻辑/ 综合/ 算法/ ,/ 其实质/ 为/ 基于/ 变换/ 规则/ 的/ 合成/ 法/ ./ 它/ 采用/ 一个/ 无向/ 无权/ 图/ 表示/ 所有/ 可以/ 进行/ 变换/ 的/ 路径/ ,/ 并/ 在/ 综合/ 的/ 过程/ 中/ ,/ 类似/ 选择/ 排序/ 算法/ 的/ 思想/ 从小到大/ 地/ 选择/ 需要/ 交换/ 的/ 输出/ 项/ ,/ 接着/ 从/ 路径/ 选择/ 图中/ 找到/ 最优/ 的/ 路径/ 进行/ 变换/ ,/ 最终/ 综合/ 完成/ 后/ 使/ 输出/ 项/ 序列/ 有序/ ,/ 而/ 每条/ 变换/ 路径/ 即/ 对应/ 一系列/ 的/ 电路/ 门/ 级联/ ./ 在/ 此基础/ 上/ ,/ 本文/ 还/ 提出/ 了/ 一个/ 优化/ 算法/ 化简/ 所/ 得到/ 的/ 量子/ 电路/ ,/ 使/ 最后/ 得到/ 的/ 电路/ 代价/ 减少/ ./ 实验/ 表明/ ,/ 相比/ 其它/ 综合/ 算法/ ,/ 该/ 算法/ 不仅/ 总能/ 获得/ 最优/ 解/ 或/ 近似/ 最优/ 解/ ,/ 而且/ 效率/ 优势/ 明显/ ./ 此外/ ,/ 本文/ 提出/ 的/ 算法/ 易于/ 理解/ ,/ 对于/ 有/ 计算机专业/ 基础/ 的/ 人/ 容易/ 实现/ ,/ 同时/ 基于/ 图论/ 解决/ 可逆/ 逻辑/ 综合/ 问题/ 的/ 思想/ 也/ 有/ 一定/ 的/ 借鉴/ 意义/ ./ 

