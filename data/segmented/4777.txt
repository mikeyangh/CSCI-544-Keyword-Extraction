Page1/ 关系数据/ 中/ 函数/ 依赖/ 检测/ 方法/ 钟评/ 李战怀/ 陈群/ (/ 西北工业大学/ 计算机/ 学院/ 西安/ 710129/ )/ 摘要/ 在/ 数据/ 质量/ 研究/ 中/ 函数/ 依赖/ 被/ 广泛/ 用于/ 关系数据/ 不一致性/ 的/ 修复/ ./ 然而/ ,/ 不/ 一致/ 修复/ 问题/ 面临/ 的/ 一个/ 主要/ 挑战/ 是/ 如何/ 从/ 包含/ 有/ 错误/ 的/ 关系数据/ 中/ 自动/ 发现/ 有效/ 的/ 函数/ 依赖/ (/ FunctionalDependence/ ,/ FD/ )/ ./ 目前/ 基于/ 统计/ 度量/ 置信度/ 的/ FD/ 自动/ 发现/ 方法/ 经常/ 找出/ 大量/ 近似/ 成立/ 但/ 无效/ 的/ FD/ ./ 如果/ 直接/ 利用/ 这些/ FD/ 修复/ 数据/ ,/ 会/ 产生/ 更/ 多/ 错误/ ./ 针对/ 该/ 问题/ ,/ 文中/ 提出/ 了/ 一种/ 基于/ 数据/ 语义/ 分析/ 的/ 函数/ 依赖/ 检测/ 方法/ ./ 该/ 方法/ 通过/ 条件/ 概率/ 来/ 分析属性/ 值/ 和/ 元组/ 的/ 数据/ 置信度/ ,/ 进而/ 计算/ 函数/ 依赖/ 成立/ 的/ 置信度/ ./ 文中/ 同时/ 提出/ 了/ 利用/ 关系数据/ 构建/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ 用以/ 计算/ 数据/ 置信度/ 的/ 方法/ ./ 最后/ 文中/ 通过/ 实验/ 在/ 模拟/ 数据/ 和/ 真实/ 数据/ 上/ 验证/ 了/ 基于/ 数据/ 语义/ 的/ 置信度/ 计算方法/ 在/ 自动检测/ 中/ 的/ 精确度/ 优于/ 基于/ 统计/ 的/ 计算方法/ ,/ 并且/ 在/ 交互式/ 检测/ 应用/ 场景/ 中/ 数据/ 语义/ 的/ 置信度/ 所/ 需/ 用户/ 工作量/ 少于/ 基于/ 统计/ 的/ 方法/ ./ 关键词/ 数据/ 质量/ ;/ 函数/ 依赖/ ;/ 数据/ 置信度/ ;/ 条件/ 概率/ 1/ 引言/ 当前/ 数据/ 不/ 一致/ 是/ 关系数据/ 中/ 普遍存在/ 的/ 问题/ [/ 1/ ]/ ./ 从/ 关系数据/ 中/ 发现/ 函数/ 依赖/ (/ FunctionalDependence/ ,/ FD/ )/ ,/ 再/ 通过/ 删除/ 或/ 修改/ 不/ 一致/ 数据/ 使/ 其/ 满足/ 给定/ 函数/ 依赖/ ,/ 是/ 当前/ 不一致性/ 修复/ 的/ 常用/ 方法/ ./ 然而/ ,/ 在/ 当前/ 不一致性/ 修复/ 中/ ,/ FD/ 自动/ 发现/ 算法/ 得到/ 的/ 近似/ 成立/ FD/ 不/ 一定/ 是/ 真实/ 成立/ 的/ ./ 在/ 给定/ 数据/ 和/ FD/ 集都/ 含有/ 错误/ 的/ 情况/ 下/ ,/ 如果/ 数据/ 违反/ 了/ FD/ ,/ 则/ 有/ 两种/ 可能/ 原因/ :/ (/ 1/ )/ FD/ 成立/ ,/ 数据/ 违反/ 函数/ 依赖/ 需要/ 修复/ ;/ (/ 2/ )/ FD/ 本身/ 不/ 成立/ ,/ 数据/ 不/ 需要/ 修复/ ./ 本文/ 主要/ 研究/ 在/ 数据/ 含有/ 错误/ 的/ 情况/ 下/ FD/ 的/ 检测/ 问题/ ./ 以表/ 1/ 为例/ ,/ 假设/ 表/ 1/ 中/ 存在/ 两个/ 近似/ 成立/ FD/ ,/ 记/ 为/ φ/ 1/ 与/ φ/ 2/ ,/ 分别/ 有/ 其中/ 数据/ 元组/ t1/ 不/ 满足/ 函数/ 依赖/ φ/ 1/ ,/ 但是/ 通过/ 实际/ 验证/ 可以/ 发现/ ,/ t1/ 虽然/ City/ (/ 城市/ 名/ )/ ,/ County/ (/ 郡名/ )/ 属性/ 与/ t3/ ,/ t4/ ,/ t5/ ,/ t6/ 取值/ 相同/ ,/ 但是/ 实际/ 中/ 却是/ 同名/ 的/ 不同/ 城市/ ,/ 因此/ 该/ FD/ 在/ 实际/ 语义/ 中/ 不/ 成立/ ./ 与/ φ/ 1/ 相比/ ,/ 对/ 违反/ φ/ 2/ 的/ 元组/ t9/ 验证/ 可知/ ,/ t9/ 中/ County/ 属性/ 值/ 现实/ 中/ 确实/ 是/ 错误/ 应当/ 修改/ ,/ φ/ 2/ 成立/ ./ 由此可见/ ,/ FD/ 检测/ 通常/ 需要/ 涉及/ 到/ 关系数据/ 在/ 现实/ 世界/ 中/ 的/ 语义/ ./ 虽然/ 现实/ 世界/ 中/ 的/ 语义/ 信息/ 无法/ 完全/ 和/ 精确/ 获取/ ,/ 但/ 本文/ 通过/ 在/ 给定/ 的/ 关系数据/ 中/ 寻找/ 能够/ 反映/ 现实/ 世界/ 语义/ 的/ 信息/ ,/ 即/ 数据/ 语义/ 作为/ 解决/ 当前/ 问题/ 依据/ ./ 目前/ ,/ 仅/ 有/ 部分/ 不一致性/ 修复/ 研究/ 考虑/ 了/ FD/ 不/ 成立/ 的/ 情况/ [/ 2/ -/ 4/ ]/ ,/ 针对/ 关系数据/ 的/ FD/ 自动/ 挖掘/ 仍/ 主要/ 采用/ 基于/ 统计/ 的/ 置信度/ [/ 5/ ]/ 计算方法/ ./ 该/ 方法/ 假定/ 数据/ 中/ 错误/ 仅/ 占/ 很小/ 一部分/ ,/ 因此/ FD/ 中/ 不/ 一致/ 数据/ 越/ 少/ ,/ 其/ 成立/ 的/ 可能性/ 越大/ ./ 然而/ ,/ 由于/ 该/ 方法/ 没有/ 考虑/ 数据/ 语义/ ,/ 除/ 包含/ 真实/ 成立/ 的/ FD/ 以外/ ,/ 检测/ 结果/ 通常/ 也/ 会/ 包含/ 很多/ 无效/ 的/ FD/ ,/ 因此/ 总体/ 的/ 检测/ 精确度/ 仍/ 有/ 可能/ 很/ 低/ ./ 如/ 第/ 6/ 节图/ 4/ (/ e/ )/ ~/ (/ h/ )/ 实验所/ 示/ ,/ 在/ 真实/ 数据/ hospital/ 的/ 精确度/ 实验/ 中/ 置信度/ 前/ 20/ %/ 的/ 近似/ FD/ 中/ 真实/ 成立/ 的/ FD/ 不到/ 30/ %/ ./ 本文/ 贡献/ 如下/ :/ (/ 1/ )/ 针对/ 关系数据/ 提出/ 了/ 一种/ 基于/ 数据/ 语义/ 分析/ 的/ FD/ 检测/ 方法/ ./ 该/ 方法/ 通过/ 条件/ 概率/ 定义/ 属性/ 值/ 和/ 元组/ 的/ 数据/ 置信度/ ,/ 提出/ 相应/ 的/ FD/ 置信度/ 计算方法/ ;/ (/ 2/ )/ 提出/ 了/ 构建/ 并/ 使用/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ 来/ 计算/ 数据/ 置信度/ 的/ 方法/ ;/ (/ 3/ )/ 通过/ 在/ 模拟/ 数据/ 和/ 真实/ 数据/ 集上/ 的/ 实验/ ,/ 验证/ 了/ 基于/ 数据/ 语义/ 的/ 置信度/ 计算方法/ 在/ 自动检测/ 中/ 精确度/ 高于/ 统计/ 置信度/ 方法/ ,/ 并且/ 在/ 交互式/ 检测/ 应用/ 场景/ 中/ 数据/ 语义/ 的/ 置信度/ 所/ 需/ 用户/ 工作量/ 少于/ 基于/ 统计/ 的/ 方法/ ./ 本文/ 第/ 2/ 节为/ 相关/ 工作/ ;/ 第/ 3/ 节/ 概述/ FD/ 概念/ 以及/ FD/ 检测/ 问题/ ;/ 第/ 4/ 节/ 介绍/ 数据/ 置信度/ 和/ FD/ 数据/ 语义/ 分析/ 置信度/ 的/ 定义/ ;/ 第/ 5/ 节/ 介绍/ 使用/ 数据/ 构建/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ 用以/ 计算/ 数据/ 置信度/ 的/ 方法/ ;/ 第/ 6/ 节/ 通过/ 实验/ 验证/ 该/ 方法/ 对/ 函数/ 依赖/ 的/ 检测/ 效果/ ;/ 第/ 7/ 节为/ 结论/ ./ 2/ 相关/ 工作/ 目前/ ,/ 关系数据/ 中/ 不一致性/ 的/ 修复/ 主要/ 通过/ 函数/ 依赖/ 实现/ ./ 文献/ [/ 1/ ,/ 6/ ]/ 对/ 不一致性/ 修复/ 进行/ 了/ 综述/ 性/ 介绍/ ./ 文献/ [/ 7/ ]/ 首先/ 提出/ 了/ 直接/ 修复/ 数据/ 值/ 的/ 代价/ 修复/ 模型/ ./ 该/ 模型/ 通过/ 寻找/ 一个/ 满足/ 给定/ FD/ 集/ 并且/ 修复/ 代价/ 最小/ 的/ 修复/ 方案/ 来/ 修复/ 数据/ ./ 文献/ [/ 8/ ]/ 对/ FD/ 在/ 语义上/ 扩展/ 提出/ 了/ 条件/ 函数/ 依赖/ (/ ConditionalFunctionalDependence/ ,/ CFD/ )/ ,/ CFD/ 可以/ 看做/ 是/ 一种/ 局部/ 的/ FD/ ,/ 文献/ [/ 9/ ]/ 提出/ 了/ 基于/ 代价/ 修复/ 模型/ 使用/ FD/ 和/ CFD/ 共同/ 修复/ 数据/ 的/ 方法/ ./ 文献/ [/ 10/ ]/ 对/ 代价/ 模型/ 修复/ 算法/ 进行/ 优化/ ,/ 提出/ 了/ 近似/ 最优/ 修复/ 的/ 方法/ ./ 文献/ [/ 11/ -/ 12/ ]/ 提出/ 使用/ 采样/ 的/ 方法/ 对/ 海量/ 数据/ 进行/ 修复/ ./ 此外/ ,/ 文献/ [/ 13/ -/ 15/ ]/ 分别/ 提出/ 了/ 不同于/ FD/ 和/ CFD/ 的/ 其他/ 数据/ 修复/ 方法/ ./ 关系数据/ 不一致性/ 修复/ 首先/ 需要/ 自动/ 发现/ 数据/ 中/ 的/ FD/ ./ 文献/ [/ 16/ ]/ 介绍/ 了/ FD/ 自动/ 发现/ 研究/ 现状/ ,/ 文献/ [/ 17/ -/ 18/ ]/ 等/ 分别/ 提出/ 了/ 从/ 数据/ 中/ 发现/ 最小/ FD/ 集/ 的/ 算法/ ./ 文献/ [/ 17/ ]/ 提出/ 的/ TANE/ 算法/ 使用/ 分层/ 搜索/ 策略/ ,/ 将/ FD/ 搜索/ 空间/ 按照/ FD/ 中/ 属性/ 数/ 分层/ 并/ 逐层/ 搜索/ ,/ 同时/ 在/ 搜索/ 过程/ 中/ 对/ 搜索/ 空间/ 剪枝/ ./ 并/ 证明/ 该/ 方法/ 对/ 数据量/ 有/ 良好/ 扩展性/ ./ 文献/ [/ 18/ ]/ 提出/ 算法/ FastFDs/ 通过/ 计算/ 各/ 数据/ 元组/ 的/ 不/ 一致/ 集来/ 发现/ FD/ 集/ ,/ 该/ 方法/ 对/ 数据/ 中/ 属性/ 数量/ 有/ 良好/ 扩展/ ,/ 但/ 复杂度/ 是/ 数据量/ 的/ 平方/ ./ 文献/ [/ 19/ ]/ 将/ FD/ 自动/ 发现/ 算法/ 扩展/ 到/ CFD/ ,/ 提出/ 了/ 分别/ 基于/ TANE/ 算法/ 和/ FastFDs/ 算法/ 的/ CFD/ 发现/ 算法/ CTANE/ 和/ CFDMiner/ ./ 文献/ [/ 20/ ]/ 提出/ 一种/ 深度/ 优先/ 的/ 发现/ 算法/ ,/ 该/ 方法/ 能够/ 用于/ 数据量/ 较大/ 条件/ 下/ 的/ 发现/ ./ 文献/ [/ 21/ ]/ 实验/ 评估/ 了/ 当前/ 多种/ 发现/ 算法/ 的/ 效率/ ./ 当前/ 数据/ 修复/ 流程/ 主要/ 是/ 首先/ 通过/ 上述/ 文献/ [/ 17/ -/ 19/ ]/ 中/ 函数/ 依赖/ 发现/ 算法/ 发现/ 数据/ 中/ 成立/ 或近/ Page3/ 似/ 成立/ 的/ FD/ 或/ CFD/ 等/ 规则/ ./ 再/ 使用/ 文献/ [/ 7/ -/ 15/ ]/ 方法/ 对/ 不/ 满足/ 规则/ 的/ 数据/ 进行/ 修复/ ./ 但/ 这样/ 的/ 方法/ 面临/ 一个/ 问题/ 是/ FD/ 或/ CFD/ 发现/ 方法/ 得到/ 的/ 规则/ 不是/ 语义上/ 成立/ 的/ ,/ 无法/ 直接/ 应用/ 于/ 数据/ 修复/ ./ 当前/ 衡量/ 规则/ 是否/ 成立/ 主要/ 采用/ 文献/ [/ 5/ ]/ 基于/ 统计/ 的/ 置信度/ 的/ 方法/ ,/ 置信度/ 是/ 近似/ 函数/ 依赖/ [/ 15/ ]/ (/ ApproximateFunctionalDependence/ ,/ AFD/ )/ 中/ 使用/ 的/ 概念/ ./ 该/ 方法/ 假定/ 数据/ 中/ 错误/ 仅/ 占/ 很小/ 一部分/ ,/ 则/ FD/ 中/ 不/ 一致/ 数据/ 越/ 少/ ,/ 其/ 成立/ 的/ 可能性/ 越大/ ./ 该/ 方法/ 发现/ 的/ 近似/ 成立/ FD/ 中/ 通常/ 含有/ 大量/ 无效/ 的/ FD/ ,/ 需要/ 进一步/ 的/ 人工/ 判定/ ./ 文献/ [/ 22/ ]/ 分析/ 了/ FD/ ,/ CFD/ 与/ 关联/ 规则/ (/ AssociationRale/ ,/ AR/ )/ 之间/ 的/ 层级/ 关系/ ,/ 并/ 指出/ AR/ 发现/ 算法/ 可/ 适用/ 于/ 所有/ 依赖/ 发现/ 问题/ ./ 由于/ 近似/ 成立/ 的/ FD/ 不/ 一定/ 在/ 语义上/ 真实/ 成立/ ,/ 直接/ 应用/ 其/ 对/ 数据/ 修复/ 会/ 引入/ 更/ 多/ 错误/ ./ 文献/ [/ 2/ -/ 3/ ]/ 研究/ 了/ 给定/ FD/ 集/ 不/ 完全/ 成立/ 条件/ 下/ 的/ 修复/ 方法/ ,/ 同时/ 考虑/ FD/ 和/ 数据/ 的/ 修复/ 代价/ ,/ 但/ 研究/ 局限于/ 修复/ 代价/ 的/ 优化/ 问题/ 上/ ./ 文献/ [/ 4/ ]/ 提出/ 的/ 增量/ 式/ 修复/ 方法/ 通过/ 人为/ 定义/ FD/ 的/ 统计/ 特征/ 作为/ 分类/ 特征/ ,/ 通过/ 人工/ 标注/ 的/ 函数/ 依赖/ 作为/ 训练/ 集/ 进行/ 增量/ 式/ 的/ 有/ 监督/ 学习/ 和/ 修复/ ,/ 再/ 检测/ 其他/ FD/ 是否/ 成立/ 并/ 进行/ 数据/ 修复/ ./ 该/ 方法/ 特征/ 选取/ 有/ 主观性/ ,/ 忽略/ 了/ 不同/ FD/ 可能/ 包含/ 的/ 不同/ 语义/ ./ 而且/ ,/ 该/ 方式/ 是/ 有/ 监督/ 学习/ 方法/ ,/ 需要/ 人工/ 进行/ 样本/ 标注/ ./ 本文/ 针对/ 上述/ 检测/ FD/ 是否/ 成立/ 的/ 问题/ 进行/ 了/ 研究/ ,/ 提出/ 了/ 一种/ 自动检测/ FD/ 方法/ ,/ 实验/ 结果显示/ 本文/ 方法/ 得到/ 的/ FD/ 集/ 拥有/ 较/ 高/ 的/ 精确度/ ./ 3/ 函数/ 依赖/ 概念/ 与/ 检测/ 问题/ 3.1/ 函数/ 依赖/ 概念/ 与/ 定义/ 设/ 数据库/ 关系/ 模式/ R/ 由/ m/ 个/ 属性/ 组成/ ,/ 记/ 为/ (/ A1/ ,/ A2/ ,/ …/ ,/ Am/ )/ ./ Dom/ (/ A/ )/ 记/ 为/ 属性/ A/ 的/ 域/ ,/ I/ 表示/ 数据库/ 中/ 由/ |/ I/ |/ 个/ 元组/ 组成/ 的/ 实例/ ./ 则/ 每/ 一个/ 元组/ 都/ 属于/ 空间/ Dom/ (/ A1/ )/ ×/ …/ ×/ Dom/ (/ Am/ )/ ./ 对于/ 元组/ t/ ∈/ I/ ,/ 记为/ t/ [/ A/ ]/ ,/ 表示/ 元组/ t/ 在/ A/ 属性/ 的/ 取值/ ./ R/ 上/ 的/ 一个/ FD/ 表示/ 为/ X/ →/ Y/ ,/ 其中/ X/ ,/ Y/ / R/ ./ 其中/ X/ 称作/ FD/ 的/ 左部/ (/ Left/ -/ Hand/ -/ Side/ ,/ LHS/ )/ ,/ Y/ 称作/ FD/ 的/ 右部/ (/ Right/ -/ Hand/ -/ Side/ ,/ RHS/ )/ ./ 一个/ FD/ 在/ 数据库/ 实例/ I/ 上/ 成立/ (/ 记为/ I/ / X/ →/ Y/ )/ ,/ 当且/ 仅/ 当/ / t/ ,/ t/ ∈/ r/ ,/ t/ [/ X/ ]/ =/ t/ [/ X/ ]/ / t/ [/ Y/ ]/ =/ t/ [/ Y/ ]/ ./ 在/ R/ 上/ FD/ 集合/ Σ/ 如果/ 是/ 一个/ 最小/ 覆盖/ (/ minimalcover/ )/ ,/ 则/ 满足/ Σ/ 中/ 每个/ FD/ 都/ 是/ 简化/ 的/ 形式/ X/ →/ A/ (/ 即/ FD/ 右部/ 仅/ 有/ 一个/ 属性/ )/ ,/ 并且/ 任意/ φ/ ∈/ Σ/ 不会/ 被/ Σ/ -/ φ/ 蕴涵/ ./ 以表/ 1/ 为例/ ,/ 表/ 1/ 为/ 美国/ 医院/ 数据/ 中/ 的/ 部分/ 信息/ ,/ 主要/ 包含/ 医院/ 所在地/ 、/ 邮编/ 和/ 联系方式/ 等/ ./ 假设/ 有/ FD/ :/ ZipCode/ →/ States/ ./ 表示/ 数据/ 集中/ 所有/ ZipCode/ (/ 邮编/ )/ 取值/ 相同/ 的/ 元组/ ,/ 其/ 对应/ 属性/ States/ (/ 所在/ 州/ )/ 的/ 取值/ 必须/ 相同/ ./ 如果/ 不/ 相等/ ,/ 则/ 该/ 数据/ 是/ 违反/ 函数/ 依赖/ 的/ 不/ 一致/ 数据/ ./ t1LOUISVILLEJEFFERSONGA304344786257000t2MILLENJENKINSGA304424784784221t3LOUISVILLEJEFFERSONKY402025025874011t4LOUISVILLEJEFFERSONKY402025026296560t5LOUISVILLEJEFFERSONKY402025025623000t6LOUISVILLEJEFFERSONKY402075028978100t7BaltimoreBaltimoreCityMD212014103288667t8BaltimoreBaltimoreCityMD212014102258996t9BaltimoreKetchikanGatewayMD2120141060570163/ ./ 2/ 函数/ 依赖/ 检测/ 问题/ FD/ 的/ 检测/ 问题/ 可以/ 形式化/ 描述/ 为/ :/ 给定/ FD/ 候选/ 集/ Σ/ 以及/ 数据库/ 实例/ I/ ,/ 对/ 每/ 一个/ 函数/ 依赖/ φ/ ∈/ Σ/ ,/ 置信/ 函数/ f/ :/ f/ (/ φ/ ,/ I/ )/ 将/ Σ/ 中/ 每个/ FD/ 和/ I/ 作为/ 输入/ ,/ 映射/ 得到/ 一个/ 实数/ d/ (/ φ/ )/ ∈/ [/ 0/ ,/ 1/ ]/ ,/ 作为/ 函数/ 依赖/ 成立/ 的/ 度量/ ./ 当前/ 数据/ 修复/ 领域/ 通常/ 使用/ AFD/ 中/ 的/ 置信度/ 概念/ 来/ 度量/ FD/ 成立/ 的/ 可能性/ ./ 在/ 数据库/ 设计/ 中/ ,/ 当/ 允许/ 一个/ FD/ 含有/ 部分/ 不/ 一致/ 数据/ 时/ ,/ 则/ 该/ 函数/ 依赖/ 是/ 一个/ AFD/ ./ 置信度/ 用来/ 衡量/ 一个/ AFD/ 与/ 对应/ FD/ 在/ 数据/ 上/ 的/ 近似/ 程度/ ,/ 当前/ 主流/ 方法/ 是/ 统计/ 一个/ AFD/ 同/ 对应/ FD/ 元组/ 上/ 的/ 相似/ 比例/ ,/ 一个/ 函数/ 依赖/ φ/ :/ X/ →/ Y/ 的/ 置信度/ con/ (/ φ/ )/ 标准/ 形式/ 为/ con/ (/ φ/ )/ =/ 式/ (/ 1/ )/ 中/ ∏/ X/ 影/ ,/ cX/ (/ x/ )/ 表示/ 属性/ X/ 的/ 取值/ x/ 在/ I/ 上/ 的/ 元组/ 数/ ./ 以表/ 1/ 中/ φ/ 2/ :/ ZipCode/ →/ County/ 为例/ ,/ 可以/ 计算/ 出/ 置信度/ con/ (/ φ/ 2/ )/ =/ 1/ +/ 1/ +/ 3/ +/ 1/ +/ 2/ 与/ 基于/ 统计/ 的/ 置信度/ 计算方法/ 不同/ ,/ 本文/ 提出/ 通过/ 分析/ I/ 中/ 违反/ 待/ 检测/ FD/ 的/ 数据项/ 是否/ 需要/ 修复/ 来/ 计算/ FD/ 成立/ 的/ 置信度/ ./ 为/ 区别/ 起/ 见/ ,/ 本文/ 将/ 基于/ 数据/ 语义/ 分析/ 置信度/ (/ DataSemanticConfidence/ ,/ DSC/ )/ 简称/ DSC/ 置信度/ ,/ 传统/ 基于/ 统计/ 的/ 置信度/ 称为/ SC/ 置信度/ (/ StatisticalConfidence/ ,/ SC/ )/ ./ Page44/ 基于/ 数据/ 语义/ 分析/ 的/ FD/ 检测/ 方法/ 本文/ 目标/ 是/ 通过/ 从/ 给定/ 数据/ 中/ 寻找/ 数据/ 所/ 包含/ 的/ 语义/ 信息/ 来/ 解决/ 检测/ 问题/ ./ 贝叶斯/ 网络/ 作为/ 一种/ 描述/ 数据/ 因果关系/ 的/ 模型/ ,/ 其/ 网络结构/ 蕴含/ 了/ 数据/ 的/ 因果关系/ ./ 基于/ 贝叶斯/ 网/ 的/ 数据/ 语义/ 信息/ 本文/ 提出/ 判断/ 不/ 一致/ 数据/ 是否/ 需要/ 修改/ 的/ 方法/ —/ —/ —/ 数据/ 置信度/ ./ 本文/ 依据/ 第/ 3/ 节中/ 检测/ 问题/ 定义/ ,/ 使用/ 违反/ FD/ 元组/ 的/ 数据/ 置信度/ 来/ 定义/ FD/ 成立/ 的/ 可能性/ ,/ 即/ FD/ 的/ DSC/ 置信度/ ./ 本章/ 介绍/ 数据/ 置信度/ 和/ DSC/ 置信度/ 的/ 定义/ ./ 第/ 5/ 节/ 介绍/ 使用/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ 计算/ 数据/ 置信度/ 的/ 方法/ ./ 4.1/ 数据/ 置信度/ 以表/ 1/ 中为例/ ,/ 元组/ t1/ 属性/ City/ ,/ County/ 取值/ 虽然/ 与/ t3/ ~/ t6/ 相同/ ,/ 但是/ Zipcode/ 与/ Phone/ 取值/ 有/ 很大/ 差异/ ,/ 可以/ 作为/ 支持/ t1/ 是/ 同名/ 的/ 不同/ 城市/ 的/ 证据/ ./ 本文/ 通过/ 为/ 该/ 属性/ 构建/ 贝叶斯/ 网络/ ,/ 并/ 利用网络/ 中/ 相关/ 属性/ E/ 的/ 值/ t/ [/ E/ ]/ =/ e/ 计算/ 元组/ t/ 当前/ 值/ t/ [/ A/ ]/ =/ a/ 的/ 条件/ 概率/ p/ (/ a/ |/ e/ )/ 来/ 推测/ t/ [/ A/ ]/ 是否/ 需要/ 修改/ ./ 其中/ 证据/ 属性/ E通/ 过/ 贝叶斯/ 网络/ 构建/ 获得/ ./ 具体方法/ 在/ 第/ 5/ 节/ 介绍/ ./ 本节/ 首先/ 定义/ 元组/ 单个/ 属性/ 的/ 数据/ 值/ 置信度/ ,/ 对于/ 元组/ t/ ,/ 其/ 属性/ A/ ∈/ U/ 取值/ t/ [/ A/ ]/ =/ a/ 的/ 数据/ 值/ 置信度/ 定义/ 如下/ ./ 定义/ 1/ ./ 数据/ 元组/ t/ ∈/ I/ ,/ I/ 中/ 所有/ 属性/ 记为/ U/ ,/ 属性/ A/ 的/ 取值/ a/ =/ t/ [/ A/ ]/ ,/ 证据/ e/ =/ t/ [/ E/ ]/ ,/ 其中/ E/ / U/ // A/ ,/ 则/ 元组/ t/ 中/ 属性/ A/ 的/ 数据/ 值/ 置信度/ 定义/ 为式/ (/ 2/ )/ 中/ p/ (/ a/ |/ e/ )/ -/ p/ (/ a/ )/ 代表/ 的/ 意义/ 可以/ 用/ 分类/ 的/ 观点/ 解释/ :/ 将/ A/ 的/ 取值/ 范围/ a/ ∈/ Dom/ (/ A/ )/ 中/ 每/ 一个/ 值/ 看作/ 一个/ 类/ 标签/ ,/ p/ (/ a/ )/ 代表/ 没有/ 任何/ 额外/ 信息/ 时/ ,/ 元组/ t/ 分到/ 类/ a/ 的/ 概率/ ./ P/ (/ a/ |/ e/ )/ 为/ 当/ 知道/ 作为/ 证据/ 的/ 属性/ E/ 取值/ 信息/ 时/ 分类/ 为/ a/ 的/ 概率/ ./ 当/ 已知/ 该/ 元组/ 证据/ 属性/ E/ 取值/ e/ 时/ ,/ e/ 使得/ 该/ 元组/ 分类/ 为/ t/ [/ A/ ]/ =/ a/ 的/ 概率/ 发生/ 了/ 变化/ ./ p/ (/ a/ |/ e/ )/ -/ p/ (/ a/ )/ 越大/ ,/ 说明/ 证据/ 属性/ 取值/ 在/ 概率/ 上越/ 支持/ 当前/ 值/ ,/ 则/ a/ =/ t/ [/ A/ ]/ 置信度/ 越大/ ./ 反之/ 如果/ P/ (/ a/ |/ e/ )/ -/ p/ (/ a/ )/ 越小/ ,/ 则/ 认为/ 当前/ 值/ 更/ 应当/ 修改/ ./ 式/ (/ 2/ )/ 中/ r/ (/ t/ ,/ A/ )/ 取值/ 范围/ 为/ -/ 1/ </ r/ (/ t/ ,/ A/ )/ </ 1/ ,/ 为了/ 方便/ 后续/ 计算/ 和/ 排序/ ,/ 因此/ 将/ r/ (/ t/ ,/ A/ )/ 进行/ 归一化/ ,/ 得到/ 归一化/ 后/ 的/ 数据/ 值/ 置信度/ :/ 式/ (/ 2/ )/ 定义/ 单个/ 属性/ t/ [/ A/ ]/ 的/ 数据/ 值/ 置信度/ 后/ ,/ 需要/ 定义/ 元组/ t/ 的/ 数据/ 置信度/ ./ 对于/ 一个/ 违反/ FD/ :/ X/ →/ Y/ 的/ 元组/ t/ ,/ 集合/ X/ ∪/ Y/ 中/ 属性/ 都/ 可能/ 发生/ 错误/ ,/ t/ 的/ 数据/ 置信度/ 应当/ 由/ 所有/ 可能/ 发生/ 错误/ 的/ 属性/ 定义/ ./ 元组/ 中/ 一个/ 属性/ 值有/ 错时/ ,/ 整个/ 元组/ 被/ 看作/ 是/ 不/ 一致/ 数据/ ./ 因此/ 一个/ 元组/ t/ 的/ 数据/ 置信度/ 定义/ 为/ 所有/ 可能/ 错误/ 属性/ 的/ 数据/ 值/ 置信度/ 最小值/ :/ 以表/ 1/ 中/ 元组/ 和/ φ/ 2/ :/ ZipCode/ →/ County/ 为例/ ,/ 要/ 计算/ 违反/ φ/ 2/ 元组/ t9/ 的/ 数据/ 置信度/ ,/ 则/ 需要/ 计算/ t9/ 中/ 所有/ φ/ 2/ 相关/ 属性/ 的/ 属性/ 值/ 置信度/ 并取/ 最小值/ ./ 即/ r/ (/ t9/ ,/ I/ ,/ φ/ 2/ )/ =/ min/ (/ r/ (/ t9/ ,/ ZipCode/ )/ ,/ r/ (/ t9/ ,/ County/ )/ )/ ./ 假设/ ZipCode/ 的/ 证据/ 属性/ 为/ State/ ,/ 则/ r/ (/ t9/ ,/ ZipCode/ )/ =/ p/ (/ 21201/ |/ MD/ )/ -/ p/ (/ 21201/ )/ 该/ 条件/ 概率/ 的/ 计算方法/ 将/ 在/ 第/ 5/ 节/ 介绍/ ./ 4.2/ 数据/ 语义/ 的/ FD/ 置信度/ 计算/ 当/ 给定/ 数据/ 置信度/ 之后/ ,/ 可以/ 进一步/ 定义/ FD/ 的/ 数据/ 语义/ 置信度/ (/ DataSemanticC/ ,/ DSC/ )/ ,/ 任意/ 函数/ 依赖/ φ/ 的/ DSC/ 置信度/ d/ 为/ 其中/ ti/ ∈/ I/ 为/ 不/ 满足/ φ/ 的/ 数据/ 元组/ ./ r/ (/ ti/ ,/ I/ ,/ φ/ )/ 为/ 元组/ 的/ 数据/ 置信度/ ,/ 可/ 简写/ 为/ ri/ ./ 置信/ 函数/ f/ (/ r1/ ,/ …/ ,/ rn/ )/ 利用/ 不/ 一致/ 元组/ 的/ 数据/ 置信度/ ,/ 计算/ φ/ 成立/ 置信度/ ./ 式/ (/ 5/ )/ 定义/ 一个/ FD/ 的/ DSC/ 置信度/ 需要/ 通过/ 所有/ 不/ 一致/ 数据/ 的/ 数据/ 置信度/ 来/ 计算/ ./ 在/ 数据/ 修复/ 应用/ 中/ ,/ 若/ 给定/ 一个/ FD/ 成立/ ,/ 所有/ 违反/ 该/ FD/ 的/ 不/ 一致/ 数据/ 将/ 被/ 修复/ ./ 因此/ 本文/ 根据/ 以下/ 原则/ 定义/ FD/ 的/ 数据/ 语义/ 分析/ 置信度/ :/ 一个/ FD/ 成立/ 的/ DSC/ 置信度/ 越高/ ,/ 则/ 违反/ 该/ FD/ 的/ 不/ 一致/ 数据/ 中/ 被/ 修复/ 部分/ 平均/ 数据/ 置信度/ 越低/ ,/ 因为/ 当/ FD/ 没有/ 错误/ 的/ 时候/ ,/ 数据/ 必然/ 发生/ 了/ 错误/ ./ 因此/ 计算/ DSC/ 置信度/ 需要/ 首先/ 使用/ 式/ (/ 3/ )/ 和/ (/ 4/ )/ 对/ 函数/ 依赖/ 的/ 不/ 一致/ 部分/ 计算/ 数据/ 置信度/ ,/ 再/ 通过/ 各/ 违反/ 元组/ 的/ 置信度/ 利用/ 式/ (/ 5/ )/ 计算/ FD/ 的/ DSC/ 置信度/ ./ 假设/ 元组/ 集/ V/ / I/ 为/ 使用/ FD/ 修复/ 数据/ 后/ 会/ 发生/ 改变/ 的/ 元组/ 集合/ ./ 对于/ FD/ :/ X/ →/ Y/ ,/ 将/ I/ 中/ 所有/ 元组/ 按照/ 属性/ X/ 的/ 取值/ xi/ ∈/ X/ 划分/ 成/ 等价/ 类/ ./ 明显/ 的/ ,/ 数据/ 中/ 与/ FD/ 一致/ 部分/ 不/ 属于/ 集合/ V/ ./ 对于/ 不/ 一致/ 部分/ ,/ 本文/ 假设/ 不/ 一致/ 数据/ 所在/ 的/ 等价/ 类中/ 支持/ 度/ 低/ 的/ 部分/ 需要/ 修复/ ,/ 如图/ 1/ (/ a/ )/ 中/ 可/ 认为/ t/ =/ {/ JEFFERSON/ ,/ KY/ }/ 元组/ 支持/ 度/ 最大/ 没有/ 错误/ ,/ 称为/ 主模式/ (/ majorpattern/ )/ ,/ 记为/ major/ (/ xi/ )/ ,/ 主模式/ 中/ 元组/ t/ ∈/ major/ (/ xi/ )/ 不需/ 修复/ ./ 而/ {/ JEFFERSON/ ,/ Page5GA/ }/ 需要/ 修复/ ,/ 这种/ 情况/ 下仅/ 需要/ 计算/ 主模式/ 外/ 的/ 其他/ 元组/ 的/ 数据/ 置信度/ ./ 但是/ 如图/ 1/ (/ b/ )/ 和/ (/ c/ )/ 所示/ ,/ 即/ 支持/ 度/ 最高/ 的/ 模式/ 不/ 存在/ 或/ 不/ 唯一/ ./ 在/ 这种/ 情况/ 下/ 需要/ 对/ 所有/ 不/ 一致/ 数据/ 元组/ 进行/ 检测/ ./ 并/ 计算/ 每个/ 模式/ (/ 即/ 函数/ 依赖/ 属性/ 的/ 不同/ 取值/ )/ 的/ 数据/ 置信度/ 之/ 和/ ./ 并/ 从中/ 找出/ 支持/ 度/ 最大/ 且/ 数据/ 置信度/ 最大/ 的/ 模式/ 作为/ 主模式/ ./ 因/ 主模式/ 不需/ 修复/ ,/ 则/ 不/ 包含/ 于/ 集合/ V/ 中/ ./ 最终/ ,/ 单个/ 函数/ 依赖/ 成立/ 的/ 数据/ 置信度/ d/ (/ φ/ )/ 可以/ 定义/ 如下/ ./ 定义/ 2/ ./ 对于/ 函数/ 依赖/ φ/ ,/ 以及/ 发生/ 改变/ 的/ 元组/ 集/ V/ ,/ 函数/ 依赖/ 成立/ 的/ DSC/ 置信度/ 为/ 其中/ |/ V/ |/ 表示/ V/ 中/ 元组/ 数/ ./ 5/ 数据/ 置信度/ 计算方法/ 为/ 计算/ 数据/ 置信度/ ,/ 需要/ 计算/ 式/ (/ 2/ )/ 中/ 条件/ 概率/ p/ (/ a/ |/ e/ )/ 与/ 先验概率/ p/ (/ a/ )/ ./ 其中/ p/ (/ a/ )/ 可以/ 通过/ 数据/ 直接/ 统计/ 得到/ ./ 对于/ p/ (/ a/ |/ e/ )/ 的/ 计算/ ,/ 由于/ 数据/ 各/ 属性/ 之间/ 的/ 互相/ 影响/ 会/ 降低/ 判断/ 的/ 准确性/ ,/ 本文/ 采用/ 概率/ 图/ 模型/ 方法/ 由/ 数据/ 集/ I/ 为/ 每个/ 属性/ 构建/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ [/ 23/ ]/ 用以/ 计算/ 每个/ 元组/ 取值/ 的/ 条件/ 概率/ ./ 5.1/ 贝叶斯/ 网络/ 及其/ 推理/ 贝叶斯/ 网络/ [/ 24/ ]/ 是/ 一种/ 表示/ 随机变量/ 集/ 联合/ 分布/ 的/ 概率/ 图/ 模型/ 方法/ ./ 一个/ 贝叶斯/ 网络/ 由/ 网络结构/ BS/ 以及/ 条件/ 概率/ 表/ (/ ConditionalProbabilityTable/ ,/ CPT/ )/ 组成/ ./ 网络结构/ BS/ 是/ 一个/ 如图/ 2/ 所示/ 有/ 向/ 无/ 环图/ ,/ 图中/ 每个/ 顶点/ 对应/ 随机变量/ 中/ 的/ 一个/ 变量/ ./ 两个/ 节点/ 间/ 的/ 有/ 向/ 边/ 表示/ 对应/ 变量/ 之间/ 的/ 直接/ 依赖/ 关系/ ./ 图中点/ A/ 与/ 点/ D/ 之间/ 没有/ 边/ 相连/ ,/ 则/ 表示/ 当/ 已知/ D/ 在/ BS/ 中/ 的/ 双亲/ C/ 取值/ 时/ ,/ D/ 取值/ 概率/ 与/ A/ 、/ B/ 独立/ ,/ p/ (/ D/ |/ CAB/ )/ =/ p/ (/ D/ |/ C/ )/ ./ 在/ 当前/ 应用/ 中/ ,/ 关系数据/ 中/ 的/ 每个/ 属性/ 被/ 看作/ 贝叶斯/ 网络/ 中/ 的/ 一个/ 节点/ ./ 对于/ 每个/ 变量/ 节点/ X/ 都/ 有/ 一个/ 对应/ 的/ CPT/ ,/ CPT/ 表项/ 记录/ 该/ 节点/ 的/ 双亲/ 节点/ parent/ (/ X/ )/ 相对/ 于/ X/ 的/ 条件/ 概率/ ./ 假设/ 图/ 2/ 中/ ABCD/ 四个/ 节点/ 都/ 代表/ 一个/ 2/ 值/ 变量/ ,/ 其/ 取值/ 为/ {/ absence/ ,/ present/ }/ ./ 则/ 其/ 条件/ 概率/ 表如表/ 2/ 所示/ ./ ApresentpresentabsentabsentBpresentabsentpresentabsentpresent0/ ./ 60.150/ ./ 3750.75/ absent0/ ./ 40.850/ ./ 6250.25/ presentabsent/ 贝叶斯/ 网络/ 的/ 优点/ 在于/ 其/ 简化/ 了/ 计算/ 条件/ 概率/ 所/ 涉及/ 到/ 的/ 属性/ ,/ 假设/ 贝叶斯/ 网中/ n/ 个/ 节点/ 集合/ 为/ (/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ )/ ,/ 且/ Xi/ 的/ 双亲/ 节点/ 序号/ 小于/ i/ ./ 其/ 一个/ 实例/ (/ X1/ =/ x1/ ,/ …/ ,/ Xn/ =/ xn/ )/ 根据/ 链式/ 规则/ ,/ 联合/ 概率/ 表示/ 为/ P/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ =/ p/ (/ x1/ )/ ×/ p/ (/ x2/ |/ x1/ )/ ×/ …/ ×/ 由/ 贝叶斯/ 网络/ 的/ 条件/ 独立/ 假设/ ,/ 节点/ 的/ 条件/ 概率/ 只/ 与其/ 双亲/ 节点/ 相关/ ,/ 则/ 联合/ 概率/ 可以/ 简化/ 为/ P/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ =/ ∏/ i/ 式/ (/ 8/ )/ 简化/ 了/ 计算/ 过程/ ,/ 同时/ 贝叶斯/ 网络/ 降低/ 了/ 属性/ 之间/ 互相/ 关联/ 带来/ 的/ 影响/ ./ 例如/ 图/ 2/ 中/ 各/ 节点/ ABCD/ 的/ 联合/ 概率/ p/ (/ ABCD/ )/ =/ P/ (/ A/ )/ P/ (/ B/ )/ P/ (/ C/ |/ AB/ )/ P/ (/ D/ |/ C/ )/ ./ 不同于/ 传统/ 的/ 贝叶斯/ 网络/ 推理/ ,/ 本文/ 应用/ 场景/ 中/ 计算/ 条件/ 概率/ p/ (/ a/ |/ e/ )/ 在/ 通常/ 情况/ 下/ 元组/ t/ 中/ 各/ 属性/ 不/ 包含/ 空值/ ,/ 条件/ 概率/ 可以/ 通过/ 式/ (/ 8/ )/ 中/ 概率/ P/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ ,/ a/ )/ 边缘化/ 得到/ P/ (/ a/ |/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ =/ P/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ ,/ a/ )/ 以图/ 2/ 和表/ 2/ 为例/ ,/ 假设/ 已知/ 图中/ 节点/ A/ =/ present/ ,/ B/ =/ present/ ,/ D/ =/ absent/ 时/ 计算/ 节点/ C/ 的/ 概/ Page6/ 率/ 分布/ ./ 为/ 简便/ 将/ absent/ 记为/ a/ ,/ present/ 记为/ p/ ./ 首先/ 通过/ 表/ 2/ 的/ 条件/ 概率/ 求/ 的/ C/ 各个/ 取值/ 的/ 联合/ 概率分布/ :/ p/ (/ A/ =/ p/ ,/ B/ =/ p/ ,/ C/ =/ a/ ,/ D/ =/ a/ )/ =/ 0.4/ ×/ 0.1/ =/ 0.04/ ,/ p/ (/ A/ =/ p/ ,/ B/ =/ p/ ,/ C/ =/ p/ ,/ D/ =/ a/ )/ =/ 0.6/ ×/ 0.3/ =/ 0.18/ ./ 对/ 这/ 两个/ 联合/ 按照/ 式/ (/ 9/ )/ 进行/ 概率/ 归一化/ 后/ 求得/ 当前/ 条件/ C/ 的/ 条件/ 概率分布/ 为/ p/ (/ C/ =/ a/ |/ A/ =/ p/ ,/ B/ =/ p/ ,/ C/ =/ a/ )/ =/ 0.04/ // (/ 0.04/ +/ 0.18/ )/ p/ (/ C/ =/ a/ |/ A/ =/ p/ ,/ B/ =/ p/ ,/ C/ =/ a/ )/ =/ 0.18/ // (/ 0.04/ +/ 0.18/ )/ 由于/ 当前/ 应用/ 中/ 绝大多数/ 属性/ 没有/ 属性/ 值/ 缺失/ ,/ 同时/ 本文/ 在/ 构建/ 网络/ 时/ 按照/ 下文/ 5.2/ 节/ 方法/ 限制/ 节点/ 的/ 最大/ 邻居/ 数/ maxSize/ ,/ 因此/ 式/ (/ 9/ )/ 可以/ 快速/ 计算/ 出/ 条件/ 概率/ ,/ 无需/ 其他/ 推理/ 算法/ ./ maxSize/ 可以/ 通过/ 经验/ 选取/ ,/ 本文/ 实验/ 中/ 使用/ maxSize/ =/ 4/ ./ 对于/ 所/ 推理/ 元组/ t/ 的/ 条件/ 属性/ 含有/ 空值/ 时/ ,/ 只/ 需/ 将/ 该/ 属性/ 对应/ 的/ 节点/ 从/ 网络/ 中/ 去除/ ,/ 条件/ 概率/ 仍/ 可/ 通过/ 式/ (/ 9/ )/ 快速/ 计算/ ./ 引理/ 1/ ./ 在/ 数据/ 值/ 没有/ 缺失/ 并且/ 限制/ 网络/ 最大/ 邻居/ 数时/ 计算/ 条件/ 概率/ P/ (/ a/ |/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ 的/ 时间/ 复杂度/ 为/ Ο/ (/ r/ )/ ,/ 其中/ r/ =/ max/ (/ |/ Dom/ (/ A/ )/ |/ ,/ A/ ∈/ U/ )/ ,/ 即/ 数据/ 中/ 所有/ 属性/ 取值/ 数量/ 的/ 最大值/ ./ 证明/ ./ 计算/ 式/ (/ 8/ )/ 中/ 联合/ 概率/ P/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ ,/ a/ )/ 的/ 时间/ 复杂度/ 由/ 公式/ 为/ Ο/ (/ p/ +/ c/ )/ ,/ p/ 和/ c/ 分别/ 代表/ A/ 属性/ 在/ 网络/ 中/ parent/ 集合/ 与/ children/ 集合/ 大小/ ./ 由于/ p/ +/ c/ </ maxSize/ ./ 则/ 式/ (/ 8/ )/ 计算/ 复杂度/ 为/ 常量/ ./ 计算/ 式/ (/ 9/ )/ 条件/ 概率/ 的/ 复杂度/ 为/ Ο/ (/ (/ p/ +/ c/ )/ ×/ r/ )/ ,/ 则/ P/ (/ a/ |/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ 时间/ 复杂度/ 为/ Ο/ (/ r/ )/ ./ 证毕/ ./ 定理/ 1/ ./ 使用/ 式/ (/ 5/ )/ 计算/ DSC/ 置信度/ 的/ 时间/ 复杂度/ 为/ Ο/ (/ T/ ×/ m/ ×/ r/ )/ ./ 证明/ ./ 根据/ 式/ (/ 6/ )/ ,/ 设/ 数据/ 中/ 违反/ FD/ :/ X/ →/ Y/ 的/ 元组/ 数为/ T/ =/ |/ V/ |/ ,/ FD/ 中/ 属性/ 个数/ 为/ |/ XY/ |/ ,/ 由于/ |/ XY/ |/ </ m/ ,/ 则/ 计算/ 一个/ FD/ 的/ DSC/ 置信度/ 复杂度/ 为/ Ο/ (/ T/ ×/ m/ ×/ r/ )/ ./ 5.2/ 贝叶斯/ 网络/ 的/ 建立/ 贝叶斯/ 网络/ 可以/ 通过/ 学习/ 当前/ 数据/ 集/ 得到/ 网络结构/ BS/ 和/ 条件/ 概率/ 表/ CPT/ ./ 在/ 结构/ 学习/ 方面/ ,/ 由于/ 当前/ 应用/ 需要/ 计算/ 任意/ 一个/ 属性/ 值/ t/ [/ A/ ]/ 的/ 数据/ 置信度/ ,/ 统一/ 的/ 网络结构/ 使得/ 一些/ 局部/ 属性/ 相邻/ 节点/ 过少/ ,/ 影响/ 推理/ 准确性/ ./ 针对/ 该/ 问题/ 本文/ 采用/ 为/ 每个/ 属性/ 建立/ 一个/ 马尔科夫/ 毯/ 贝叶斯/ 网络/ (/ MBBN/ )/ 来/ 推理/ 条件/ 概率/ ./ 马尔科夫/ 毯/ 是/ 指/ 在/ 贝叶斯/ 网络/ 中/ ,/ 由于/ 条件/ 独立/ 假设/ 任何/ 一个/ 节点/ Xi/ 的/ 概率/ 仅受/ 其/ 双亲/ 节点/ 、/ 孩子/ 节点/ 和/ 孩子/ 节点/ 的/ 双亲/ 这/ 3/ 类/ 节点/ 影响/ ,/ 称为/ Xi/ 的/ 马尔科夫/ 毯/ ./ 因此/ 当/ 推理/ 任意/ 一个/ 节点/ Xi/ 的/ 条件/ 概率/ 时/ ,/ 仅/ 需要/ 计算/ 对应/ 的/ 马尔科夫/ 毯/ 作为/ 网络结构/ ./ 图/ 2/ 中/ C/ 节点/ 的/ 马尔科夫/ 毯为/ {/ A/ ,/ B/ ,/ D/ }/ ,/ A/ 节点/ 为/ {/ B/ ,/ C/ }/ ,/ D/ 节点/ 为/ {/ C/ }/ ./ 本文/ 对/ 文献/ [/ 24/ ]/ 中/ MBBN/ 的/ 3/ 步/ 构建/ 算法/ 进行/ 修改/ ,/ 使/ 其/ 更/ 符合/ 当前/ 应用/ 要求/ ./ 修改/ 后/ 的/ 算法/ 依然/ 使用/ 3/ 步/ 构建/ ,/ 但/ 基于/ 效率/ 考虑/ 做出/ 如下/ 修改/ :/ (/ 1/ )/ 使用/ 信息/ 增益/ 度量/ 属性/ 间/ 相关性/ ;/ (/ 2/ )/ 没有/ 使用/ 计算/ 复杂/ 的/ 贝叶斯/ 概率函数/ 确定/ 加入/ 节点/ 是/ 双亲/ 还是/ 孩子/ ,/ 而是/ 通过/ 属性/ 在/ 数据/ 中取/ 不同/ 值/ 的/ 数量/ 作为/ 判断/ 依据/ 预先/ 给定/ 顺序/ ./ 给定/ 顺序/ 依据/ 主要/ 是/ parent/ 的/ 属性/ 取值/ 不应/ 过/ 多/ ,/ 如果/ parent/ 中/ 属性/ 过多会/ 导致/ 所/ 生成/ 条件/ 概率/ 表中/ 条件/ 过多/ 而/ 每个/ 条件/ 下/ 对应/ 的/ 不同/ 概率/ 过少/ ,/ 不利于/ 条件/ 概率/ 的/ 判断/ ;/ (/ 3/ )/ 由于/ 节点/ 过多会/ 导致/ 计算/ 过于/ 复杂/ ,/ 因此/ 人为/ 限制/ 网络/ 中/ 每个/ 节点/ 最大/ 相邻/ 节点/ 数/ maxSize/ ./ 最大/ 邻居/ 节点/ 主要/ 通过/ 经验/ 设定/ ,/ 本文/ 中设/ 为/ 4/ ,/ 原因/ 在于/ 大于/ 4/ 时/ 大多数/ 节点/ 会/ 出现/ 双亲/ 节点/ 取值/ 过多/ ,/ 造成/ 与/ 上述/ (/ 2/ )/ 中/ 相同/ 的/ CPT/ 条件/ 过多/ 的/ 情况/ ./ 两个/ 属性/ X/ 与/ Y/ 的/ 信息/ 增益/ IG/ (/ X/ ,/ Y/ )/ 可以/ 通过/ 计算/ :/ IG/ (/ X/ ,/ Y/ )/ =/ H/ (/ X/ )/ -/ H/ (/ X/ |/ Y/ )/ =/ H/ (/ Y/ )/ -/ H/ (/ Y/ |/ X/ )/ H/ (/ X/ )/ ,/ H/ (/ X/ |/ Y/ )/ 分别/ 代表/ 随机变量/ 的/ 熵/ 与/ 条件/ 熵/ ./ 为了/ 推理/ 任意/ 属性/ X/ ∈/ U/ 的/ 数据/ 置信度/ ,/ 需要/ 对/ 属性/ X/ 构建/ MBBN/ ./ 算法/ 1/ 描述/ 了/ 为/ X/ 建立/ MBBN/ 的/ 过程/ ./ 算法/ 1/ ./ Create/ _/ MBBN/ _/ for/ _/ X/ ./ 输入/ :/ 属性/ X/ ,/ 数据/ 集/ I/ ,/ 最大/ 邻居/ 数/ maxSize/ 输出/ :/ 网络结构/ mbbn1/ ./ mbbn/ ,/ parent/ (/ X/ )/ ,/ children/ (/ X/ )/ ,/ none/ ←/ / 2/ ./ 计算/ 每个/ IG/ (/ Y/ ,/ Z/ )/ ,/ Y/ ,/ Z/ ∈/ U/ 且/ Y/ ≠/ Z3/ ./ IGLIST/ (/ X/ )/ ←/ 对/ X/ ∈/ U/ // X/ 按照/ IG/ (/ X/ ,/ X/ )/ 排序/ 4/ ./ FOREACHX/ ∈/ IGLIST/ (/ X/ )/ 5/ ./ IF/ (/ |/ parent/ (/ X/ )/ |/ +/ |/ children/ (/ X/ )/ |/ </ maxSize/ )/ 6/ ./ THENIF/ (/ |/ Dom/ (/ X/ )/ |/ >/ |/ Dom/ (/ X/ )/ |/ )/ 7/ ./ THENparent/ (/ X/ )/ =/ parent/ (/ X/ )/ ∪/ X8/ ./ ELSEchildren/ (/ X/ )/ =/ children/ (/ X/ )/ ∪/ X9/ ./ ENDIF10/ ./ ELSEnone/ =/ none/ ∪/ X11/ ./ ENDIF12/ ./ ENDFOR13/ ./ mbbn/ =/ mbbn/ ∪/ parent/ (/ X/ )/ Page714/ ./ FOREACHC/ ∈/ children/ (/ X/ )/ 15/ ./ parent/ (/ C/ )/ ,/ children/ (/ C/ )/ ←/ / 16/ ./ IGLIST/ (/ C/ )/ ←/ 对/ C/ ∈/ parent/ (/ X/ )/ ∪/ non/ 按照/ 17/ ./ FOREACHC/ ∈/ IGLIST/ (/ C/ )/ 18/ ./ IF/ (/ |/ parent/ (/ C/ )/ |/ +/ |/ children/ (/ C/ )/ |/ </ maxSize/ )/ 19/ ./ THENIF/ (/ |/ Dom/ (/ C/ )/ |/ >/ |/ Dom/ (/ C/ )/ |/ )/ 20/ ./ THENparent/ (/ C/ )/ =/ parent/ (/ C/ )/ ∪/ C21/ ./ ELSEchildren/ (/ C/ )/ =/ children/ (/ C/ )/ ∪/ C22/ ./ ENDIF23/ ./ ENDIF24/ ./ ENDFOR25/ ./ ENDFOR26/ ./ FOREACHC/ ∈/ children/ (/ X/ )/ 27/ ./ IGLIST/ (/ C/ )/ ←/ 对/ C/ ∈/ children/ (/ X/ )/ // 28/ ./ FOREACHC/ ∈/ IGLIST/ (/ C/ )/ 29/ ./ IF/ (/ |/ parent/ (/ C/ )/ |/ +/ |/ children/ (/ C/ )/ |/ </ maxSize/ )/ 30/ ./ THENIF/ (/ |/ Dom/ (/ C/ )/ |/ >/ |/ Dom/ (/ C/ )/ |/ )/ 31/ ./ THENparent/ (/ C/ )/ =/ parent/ (/ C/ )/ ∪/ C32/ ./ ELSEchildren/ (/ C/ )/ =/ children/ (/ C/ )/ ∪/ C33/ ./ ENDIF34/ ./ ENDIF35/ ./ ENDFOR36/ ./ mbbn/ =/ mbbn/ ∪/ parent/ (/ C/ )/ 37/ ./ ENDFOR38/ ./ RETURNmbbn/ 算法/ 中/ |/ Dom/ (/ X/ )/ |/ 表示/ 属性/ X/ 在/ 数据/ 集中/ 不同/ 值/ 的/ 数量/ ./ 算法/ 分为/ 3/ 个/ 步骤/ :/ (/ 1/ )/ 算法/ 第/ 4/ 到/ 12/ 行/ ,/ 计算/ 属性/ X/ 与/ 其余/ 属性/ 的/ 联系/ 并/ 排序/ ,/ 依次/ 将/ 最/ 相关/ 的/ 属性/ 加入/ X/ 节点/ 的/ 双亲/ 或/ 孩子/ 集/ ,/ 记为/ parents/ 集合/ 和/ children/ 集合/ ;/ (/ 2/ )/ 算法/ 第/ 14/ 至/ 25/ 行/ 使用/ 第/ (/ 1/ )/ 步/ 相同/ 方法/ 对/ children/ 每个/ 节点/ 在/ children/ 集合/ 外/ 的/ 双亲/ ;/ (/ 3/ )/ 算法/ 第/ 26/ 至/ 37/ 行/ ./ 步骤/ 1/ 方法/ 确定/ children/ 节点/ 在/ children/ 集合/ 外/ 的/ 双亲/ ./ 完成/ 网络结构/ 的/ 构建/ 后/ ,/ 需要/ 使用/ 数据/ 计算/ 该/ 结构/ 下/ 的/ 条件/ 概率/ 表/ CPT/ ,/ 当前/ 应用/ 中/ 构建/ CPT/ 面临/ 两个/ 问题/ :/ (/ 1/ )/ 组合/ 爆炸/ 问题/ ./ 在/ 没有/ 简化/ 的/ 情况/ 下/ ,/ MBBN/ 中/ 任意/ 节点/ CPT/ 的/ 大小/ 是/ ∏/ Y/ ∈/ parent/ (/ X/ )/ |/ dom/ (/ Y/ )/ |/ ·/ |/ dom/ (/ X/ )/ |/ ./ 例如/ 表/ 2/ 中二值/ 属性/ 节点/ C/ 的/ CPT/ 大小/ 为/ 23/ =/ 8/ ,/ 如果/ 节点/ 属性/ 值/ 数量/ 为/ 100/ ,/ 则/ CPT/ 大小/ 为/ 1003/ ./ FD/ 检测/ 应用/ 中/ 使用/ 数据/ 的/ 属性/ 值/ 数量/ 通常/ 较大/ ,/ 会/ 导致/ CPT/ 过大/ 降低/ 存储/ 和/ 计算/ 效率/ ;/ (/ 2/ )/ 过/ 拟合/ 问题/ ./ 由于/ 使用/ 同一/ 数据/ 建立/ 的/ CPT/ 再/ 对/ 数据/ 自身/ 元组/ 数据/ 置信度/ 进行/ 推测/ ,/ 推测/ 结果/ 必定会/ 出现/ 过/ 拟合/ ./ 因此/ 计算/ 元组/ t/ 数据/ 置信度/ 时/ 需要/ 将/ 元组/ 自身/ 的/ 影响/ 从/ 对应/ CPT/ 中/ 去除/ ,/ 如表/ 1/ 中/ 计算/ t1/ 的/ 条件/ 概率/ ,/ 其/ 使用/ 的/ CPT/ 仅/ 由/ t2/ ~/ t9/ 统计/ 得到/ ./ 组合/ 爆炸/ 问题/ 的/ 解决/ 方法/ 是/ 使用/ 简化/ 的/ CPT/ ,/ 即/ CPT/ 仅/ 记录/ 数据/ 中/ 出现/ 的/ 数据/ 值/ 组合/ ./ 由于/ 简化/ 没有/ 改变/ 条件/ 概率/ 的/ 分布/ 情况/ ,/ 因此/ 不会/ 对/ 算法/ 的/ 检测/ 结果/ 产生/ 影响/ ./ 为/ 解决/ 过/ 拟合/ ,/ 本文/ 在/ 实现/ MBBN/ 时/ 并/ 没有/ 直接/ 生成/ 每个/ 节点/ 的/ 条件/ 概率/ ,/ 而是/ 统计/ 各/ 属性/ 值/ 出现/ 的/ 频率/ f/ ,/ 通过/ 计算/ 条件/ 概率/ ./ 在/ 计算/ 元组/ t/ 的/ 条件/ 概率/ 时/ ,/ 通过/ 减去/ 其/ 出现/ 的/ 频率/ 对/ CPT/ 修正/ 去除/ t/ 本身/ 的/ 影响/ ./ 算法/ 2/ 描述/ 了/ 通过/ 网络结构/ 计算/ CPT/ 的/ 过程/ ./ 算法/ 对/ 每个/ 数据/ 元组/ t/ ∈/ I/ ,/ 在/ 对应/ 的/ MBBN/ 网络结构/ 中/ 记录/ 其式/ (/ 11/ )/ 中/ 频率/ f/ (/ a/ ,/ parent/ (/ a/ )/ )/ ,/ f/ (/ parent/ (/ a/ )/ )/ ./ 其中/ a/ ∈/ Dom/ (/ A/ )/ ,/ 为/ 元组/ t/ 中/ A/ 属性/ 的/ 取值/ ./ 算法/ 2/ ./ Compute/ _/ CPT/ ./ 输入/ :/ 数据/ 实例/ I/ ,/ mbbn/ 输出/ :/ cpt1/ ./ cpt/ ←/ / 2/ ./ FOREACHt/ ∈/ I3/ ./ FOREACHX/ ∈/ U4/ ./ FOREACHA/ ,/ parent/ (/ A/ )/ ∈/ MBBN/ (/ X/ )/ 5/ ./ cpt/ 记录/ f/ (/ a/ ,/ parent/ (/ a/ )/ )/ ,/ f/ (/ parent/ (/ a/ )/ )/ 频率/ 6/ ./ ENDFOR7/ ./ ENDFOR8/ ./ ENDFOR9/ ./ RETURNcpt/ 定理/ 2/ ./ 给定/ 网络结构/ 与/ 数据/ I/ ,/ 计算/ CPT/ 的/ 时间/ 复杂度/ 为/ O/ (/ nm2/ )/ ./ 其中/ n/ 为/ 数据/ 元组/ 数/ ,/ m/ 为/ 数据/ I/ 中/ 不同/ 属性/ 数/ ./ 证明/ ./ 计算/ CPT/ 实质/ 为/ 统计/ 网络/ 中/ 所有/ 节点/ 出现/ 的/ 频率/ f/ (/ a/ ,/ parent/ (/ a/ )/ )/ ./ 对/ 单一/ 数据/ 元组/ ,/ 统计/ 该/ 频率/ 需要/ 对/ 每/ 一个/ 属性/ A/ ∈/ U/ 对应/ 的/ MBBN/ 中/ 每个/ 节点/ 进行/ 一次/ 操作/ ,/ 计算/ 量/ 为/ Ο/ (/ ms/ )/ ,/ 其中/ s/ 为/ MBBN/ 节点/ 数/ ./ 又/ 因为/ s/ </ m/ ,/ 则/ 单一/ 元组/ 复杂度/ 为/ Ο/ (/ m2/ )/ ./ 对/ 数据/ I/ ,/ 计算/ CPT/ 复杂度/ 为/ Ο/ (/ nm2/ )/ ./ 6/ 实验/ 及/ 分析/ 本/ 节/ 通过/ 实验/ 对比/ 评估/ 使用/ 数据/ 语义/ 分析/ 置信度/ 的/ 方法/ (/ DataSemanticConfidence/ ,/ DSC/ )/ 和/ 统计/ 置信度/ 的/ 方法/ (/ StatisticalConfidence/ ,/ SC/ )/ ./ 实验/ 算法/ 使/ Page8/ 用/ Java/ 编写/ ,/ 运行/ 在/ 使用/ Intel/ 酷睿/ i3/ -/ 3.3/ GHz/ 的/ CPU/ ,/ 4GB/ 内存/ 的/ Windows/ 计算机/ 上/ ./ 实验/ 使用/ 两个/ 数据/ 集/ ,/ 分别/ 是/ 模拟/ 数据/ TPC/ -/ H/ ①/ 和/ 真实/ 数据/ Hospital/ ②/ 数据/ ./ 6.1/ 节中/ 分别/ 提出/ 了/ 自动/ 和/ 交互式/ 的/ 两种/ 应用/ 场景/ ,/ 实验/ 分别/ 比较/ 了/ DSC/ 和/ SC/ 方法/ 对/ 相同/ FD/ 待/ 检测/ 集/ 使用/ top/ -/ K/ 排序/ 进行/ 自动检测/ ,/ 以及/ 交互式/ 检测/ 两种/ 应用/ 场景/ 下/ 检测/ 的/ 结果/ ./ 此外/ 本文/ 同时/ 对/ CFD/ 集合/ 进行/ 检测/ ,/ 检测/ 结果表明/ 本文/ 提出/ 的/ DSC/ 方法/ 同时/ 适用/ 于/ CFD/ 检测/ ./ 实验/ 分别/ 使用/ 两个/ 数据/ 集/ :/ (/ 1/ )/ 模拟/ 数据/ 集/ TPC/ -/ H/ :/ 本/ 实验/ 选取/ TPC/ -/ H/ 参数/ ScaleFactor/ 为/ 0.002/ 时/ 自动/ 生成/ 交易/ 记录/ ./ 为了/ 增加/ 表中/ 的/ 函数/ 依赖/ ,/ 实验/ 选取/ 生成/ 数据/ 中/ Order/ 和/ Lineitem/ 两表/ 进行/ join/ 操作/ ,/ 并/ 从/ 选取/ 16/ 个/ 属性/ 构成/ 关于/ 订单/ 和/ 项目/ 的/ 数据表/ LineitemOrder/ ,/ 表中/ 包含/ 的/ 元组/ 大小/ 为/ 11957/ ;/ (/ 2/ )/ Hospital/ 为/ 美国/ 医院/ 数据/ ,/ 实验/ 选择/ 了/ 其中/ Outpatient/ _/ Imaging/ _/ Efficiency/ 表项/ ,/ 从/ 该表中/ 选取/ 11/ 个/ 属性/ ,/ 共/ 包含/ 29668/ 条/ 记录/ ./ 实验/ 假定/ 两个/ 数据/ 集/ 没有/ 错误/ ,/ 实验/ 中/ 根据/ 错误率/ e/ 人为/ 引入/ 噪声/ 数据/ ./ 具体方法/ 为/ :/ 数据/ 集中/ 元组/ 数记/ 为/ n/ ,/ 生成/ 噪声/ 方法/ 为/ 元组/ t/ 中/ 任意/ 一个/ 属性/ 值/ t/ [/ a/ ]/ ,/ 更/ 改为/ t/ [/ a/ ]/ ,/ 其中/ a/ ,/ a/ ∈/ A/ 且/ a/ ≠/ a/ ./ 生成/ 噪声/ 的/ 数量/ 为/ e/ ×/ n/ ./ 实验/ 结果/ 中/ DSC/ 表示/ 数据/ 语义/ 分析/ 置信度/ ,/ SC/ 表示/ 统计/ 置信度/ 方法/ ./ 6.1/ 自动检测/ 与/ 交互式/ 检测/ 应用/ 6.1/ ./ 1/ 自动检测/ 在/ 自动检测/ 的/ 应用/ 中/ ,/ 通常/ 应用/ 场景/ 为/ :/ 给定/ 一个/ 待/ 检测/ 集/ ,/ 自动/ 发现/ 方法/ 从待/ 检测/ 集中/ 找出/ 判定/ 为/ 成立/ 的/ FD/ 集合/ ./ 考虑/ FD/ 应用/ 于/ 数据/ 修复/ 时/ ,/ 一个/ FD/ :/ A/ →/ B/ ,/ 往往/ 比/ FD/ 集合/ {/ AC/ →/ B/ ,/ AD/ →/ B/ ,/ ACD/ →/ B/ ,/ …/ }/ 更/ 有效/ ./ 因此/ 为了/ 避免/ 发现/ 重复/ 的/ 冗余/ FD/ ,/ 本文/ 限定/ 待/ 检测/ FD/ 集/ Σ/ 为/ 最小/ (/ Minimal/ )/ 集合/ ./ 本文/ 算法/ 通过/ 式/ (/ 6/ )/ 方法/ 计算/ FD/ 的/ 置信度/ 并/ 排序/ ./ 算法/ 没有/ 给出/ 直接/ 检测/ 结果/ ,/ 通过/ 人工/ 设定/ 一个/ top/ -/ K/ 值/ ,/ 对/ 返回/ 的/ 前/ top/ -/ K/ (/ 实验/ 中/ 按照/ 百分比/ 计算/ )/ 个/ FD/ 检测/ 为/ 成立/ ./ 6.2/ 节中/ 实验/ 比较/ 了/ 不同/ 数据/ 集合/ 和/ 不同/ 错误率/ 情况/ 下/ 检测/ 精确度/ ./ 6.1/ ./ 2/ 交互式/ 检测/ 当/ 需要/ 精确/ 发现错误/ 数据/ 中/ FD/ 时/ ,/ 无法/ 仅靠/ 自动检测/ 完成/ ./ 因此/ 本文/ 提出/ 通过/ DSC/ 方法/ 对/ 候选/ 集/ 进行/ 排序/ 通过/ top/ -/ K/ 形式/ 返回/ 给/ 用户/ 并/ 由/ 用户/ 交互/ 最终/ 发现/ 所有/ 成立/ 的/ FD/ 集/ ,/ 并/ 通过/ 6.3/ 节/ 实验/ 结果/ 证明/ 使用/ DSC/ 方法/ 在/ 交互式/ 系统/ 中/ 可以/ 有效/ 降低/ 用户/ 工作量/ ./ 本文/ 提出/ 了/ 图/ 3/ 中/ 所示/ 的/ 交互式/ 检测/ 流程/ ./ 在/ 该/ 流程/ 中/ ,/ 通过/ 从待/ 检测/ 集/ Σ/ 中/ 计算/ 置信度/ 并/ 排序/ ,/ 返回/ 给/ 用户/ top/ -/ K/ 个/ 最小/ 覆盖/ FD/ 集/ ,/ 记为/ S/ ./ 在/ 用户/ 对/ FD/ 进行/ 确认/ 后/ ,/ 得到/ 用户/ 检测/ 为/ 成立/ 的/ FD/ 集/ F/ 并/ 加入/ 结果/ 集/ F/ ./ 通过/ F/ 对待/ 检测/ FD/ 集/ Σ/ 进行/ 剪枝/ ./ 即/ 对于/ 任意/ 函数/ 依赖/ φ/ i/ ∈/ Σ/ ,/ 如果/ φ/ i/ ∈/ F/ +/ ,/ 则/ φ/ i/ 应当/ 从待/ 检测/ 集/ Σ/ 中/ 删除/ ./ 其中/ F/ +/ 为/ 集合/ F/ 的/ 闭包/ ./ 随后/ 通过/ 待/ 检测/ 集/ 再次/ 计算/ top/ -/ K/ 排序/ 返回/ 给/ 用户/ 交互/ ,/ 直到/ 待/ 检测/ 集为/ 空时/ 结束/ ./ 对于/ 待/ 检测/ 集/ Σ/ ,/ 每次/ 交互/ 都/ 保证/ 将/ 至少/ k/ 个/ (/ 全部/ 不/ 成立/ 时/ )/ FD/ 从/ Σ/ 中/ 删除/ ,/ Σ/ 内待/ 检测/ FD/ 数量/ 不会/ 增加/ ,/ 因此/ 该/ 流程/ 最终/ 必然/ 会/ 终止/ ./ 交互式/ 检测/ 方法/ 中/ ,/ 核心/ 部分/ 在于/ 用户/ 确认/ 后/ 使用/ 检测/ 成立/ 的/ FD/ 集对/ 原有/ 待/ 检测/ 集/ Σ/ 进行/ 剪枝/ ./ 剪枝/ 按照/ Armstrong/ 规则/ (/ Armstrongrules/ )/ ,/ 使用/ 类似/ 于/ FD/ 发现/ 算法/ 中/ 的/ 剪枝/ 方法/ ./ 主要/ 针对/ 两种/ 情况/ 剪枝/ :/ (/ 1/ )/ 对于/ 函数/ 依赖/ X/ →/ A/ 成立/ ,/ 则/ 所有/ XZ/ →/ A/ 应当/ 从待/ 检测/ 集中/ 删除/ ;/ (/ 2/ )/ 若/ X/ →/ A/ 成立/ ,/ 则/ 检测/ XAY/ →/ B/ ,/ 只用/ 检测/ XY/ →/ B/ 是否/ 成立/ ./ 其中/ X/ ∩/ Y/ ≠/ / ,/ A/ ,/ B/ / X/ ,/ A/ ,/ B/ / Y/ 且/ A/ ≠/ B/ ./ 6.2/ top/ -/ 犓/ 自动检测/ 精确度/ 评估/ 为了/ 评估/ 算法/ 对/ 同一/ 待/ 检测/ 数据/ 集/ 检测/ 的/ 精确性/ ./ 精确度/ 定义/ 为/ 排序/ 前/ top/ -/ K/ 个/ 候选/ 中/ 真实/ 成立/ FD/ 所/ 占/ 比例/ ./ 实验/ 通过/ 以下/ 方法/ 生成/ 待/ 检测/ 集/ :/ (/ 1/ )/ 对带/ 噪声/ 的/ 数据/ 集/ ,/ 使用/ 函数/ 依赖/ 挖掘/ 算法/ ①/ ②/ tal/ -/ comparePage9TANE/ ,/ 挖掘/ 所有/ 置信度/ 大于/ θ/ 的/ 函数/ 依赖/ ,/ 实验/ 中/ θ/ =/ 0.95/ ;/ (/ 2/ )/ 对/ 挖掘/ 结果/ 计算/ 最小/ 函数/ 依赖/ 集/ ,/ 得到/ 待/ 检测/ 集/ ./ 实验/ 计算/ 置信度/ 并/ 排序/ ,/ 将/ 前/ top/ -/ K/ 个/ FD/ 判定/ 为/ 成立/ ./ 算法/ 同时/ 比较/ 了/ DSC/ 和/ SC/ 两种/ 置信度/ 在/ 对/ CFD/ 的/ 精确度/ ./ CFD/ 检测/ 精确度/ 实验/ 通过/ 使用/ 文献/ [/ 25/ ]/ 中/ 方法/ FACD/ 作为/ 挖掘/ 算法/ ./ 待/ 检测/ 集/ 的/ 生成/ 同/ FD/ 待/ 检测/ 集/ 生成/ 方法/ 相同/ ./ 使用/ FACD/ 作为/ 挖掘/ 算法/ 的/ 原因/ 在于/ 其/ 挖掘/ 到/ 的/ CFD/ 都/ 是/ 常量/ CFD/ ,/ 即/ CFD/ 中/ 各/ 属性/ 取值/ 固定/ ./ 这样/ 做/ 的/ 原因/ 在于/ 含有/ 变量/ 的/ CFD/ 可以/ 被/ 看作/ 多个/ 常量/ CFD/ 的/ 集合/ ,/ 不/ 便于/ 统计/ 结果/ ./ 因此/ 待/ 检测/ 集合/ 中/ CFD/ 统一/ 为/ 常量/ CFD/ ./ FD/ 实验/ 结果/ 如图/ 4/ 所示/ ,/ 图中/ x/ 轴/ 表示/ top/ -/ K/ 的/ 百分比/ 大小/ ,/ y/ 轴/ 表示/ 返回/ top/ -/ K/ 的/ 精确度/ ./ 图中/ 可以/ 看到/ ,/ DSC/ 置信度/ 排序/ 方法/ 在/ 不同/ 错误率/ 下/ 返回/ 效果/ 均/ 优于/ 置信度/ 方法/ (/ SC/ )/ 排序/ ./ 其中/ 最/ 显著/ 的/ 是/ 在/ hospital/ 数据/ 中/ ,/ DSC/ 置信度/ 返回/ 前/ 20/ %/ 内/ 的/ FD/ 完全/ 准确/ ./ 对于/ 图中/ SC/ 置信度/ 曲线/ 和/ 置信度/ 曲线/ 随着/ top/ -/ K/ 数量/ 增大/ 而/ 逐渐/ 趋近/ ,/ 是因为/ 成立/ 的/ FD/ 已经/ 基本/ 发现/ 完毕/ ,/ 在/ 余下/ 部分/ 中/ 没有/ 成立/ 的/ FD/ ,/ 因而/ 两者/ 准确率/ 会/ 趋于/ 一致/ ./ 图/ 4/ (/ e/ )/ 、/ (/ f/ )/ 中/ ,/ SC/ 曲线/ 在/ 前/ 10/ %/ 的/ 候选/ 中/ 精确度/ 较/ 高/ ,/ 但是/ 直到/ 40/ %/ 候选/ 的/ 排序/ 中/ ,/ 都/ 没有/ 包含/ 真实/ 成立/ 的/ FD/ ,/ 因此/ 精确度/ 下降/ ./ 最后/ 由于/ 随着/ 候选/ 比例/ 增大/ 所有/ 真实/ 成立/ 的/ FD/ 最终/ 都/ 会/ 被/ 发现/ ,/ 因此/ 在/ top/ -/ K/ 为/ 60/ %/ 时/ 精确度/ 增加/ ./ 图/ 4/ (/ d/ )/ 在/ e/ =/ 0.08/ 时/ ,/ DSC/ 曲线/ 走向/ 与/ 前/ 3/ 个/ 的/ 不同/ 是/ 由于/ 实验/ 将/ 使用/ FD/ 发现/ 算法/ 从/ 数据/ 中/ 发现/ 的/ 近似/ FD/ 中/ confidence/ >/ 0.95/ 的/ 候选/ FD/ 作为/ 候选/ 集/ ,/ 在/ e/ =/ 0.2/ ~/ 0.6/ 中前/ 10/ %/ 判断/ 错误/ 的/ FD/ 在/ 错误率/ 增大/ 后/ 其/ confidence/ 小于/ 了/ 0.95/ 而/ 没有/ 成为/ 候选/ 集/ ,/ 因此/ e/ =/ 0.08/ 时/ 曲线/ 在/ 前/ 10/ %/ 上升/ ./ CFD/ 实验/ 结果/ 如图/ 5/ 所示/ ./ DSC/ 方法/ 在/ 各种/ 条件/ 下均/ 优于/ SC/ 方法/ ./ 图/ 5/ (/ a/ )/ 、/ (/ e/ )/ 中/ 图形/ 与/ 相同/ 数据/ 集下/ 的/ 其他/ 结果/ 相差/ 较大/ ,/ 这/ 主要/ 是因为/ 错误率/ 较/ 小时/ ,/ 生成/ 的/ 待/ 检测/ CFD/ 集/ 与/ 其他/ 错误率/ 时待/ 检测/ 集/ 差异/ 较大/ ./ 同时/ 可以/ 发现/ 统计/ 置信度/ 方法/ 在/ 错误率/ 小时/ CFD/ 检测/ 精确度/ 较/ 高/ ,/ 而/ DSC/ 方法/ 受/ 错误率/ 影响/ 较/ 小/ ./ DSC/ 随着/ top/ -/ K/ 增大/ 曲线/ 下降/ 的/ 原因/ 与/ FD/ 中/ 相同/ ./ 图/ 5/ (/ h/ )/ 中/ 两条/ 曲线/ 趋于/ 相同/ ,/ 主要/ 是/ 由于/ 错误率/ 增大/ 后/ 其/ 候选/ 集/ 也/ 同时/ 增大/ ,/ 但是/ 成立/ 的/ CFD/ 数/ 没有/ 改变/ ,/ 因此/ top/ -/ K/ 同/ 比例/ 下/ 的/ 绝对/ 数量/ 增大/ ,/ 导致/ 所有/ 成立/ 的/ FD/ 在/ top/ -/ K/ =/ 40/ %/ 时/ 已经/ 全部/ 发现/ ,/ 因此/ 两条/ 曲线/ 趋于/ 相同/ ./ 6.3/ 交互式/ 检测/ 为/ 评估/ 交互式/ 方法/ 对/ 人工/ 工作量/ 的/ 节省/ 程度/ ,/ 实验/ 数据/ 集/ 通过/ 对带/ 噪声/ 的/ 数据/ 集/ ,/ 使用/ 函数/ 依赖/ 挖掘/ 算法/ TANE/ ,/ 挖掘/ 所有/ 置信度/ 大于/ θ/ 的/ 函数/ 依赖/ 作为/ 待/ 检测/ 集/ ,/ 实验/ 中/ θ/ =/ 0.95/ ./ 交互/ 过程/ 按照/ 6.1/ ./ 2/ 节中/ 描述/ 过程/ 进行/ ./ 其中/ 人工/ 工作量/ 定义/ 为/ 人工/ 确认/ FD/ 是否/ 成立/ 的/ 次数/ ./ 即/ 实验/ 中/ 每/ 返回/ 一次/ top/ -/ K/ 集合/ ,/ 用户/ 的/ 人工/ 工作量/ 增加/ k/ ./ 与/ 6.2/ 节/ 自动检测/ 方法/ 不同/ ,/ 在/ 交互/ 过程/ 中/ top/ -/ K/ 选取/ 可能/ 对/ 实验/ 结果/ 产生/ 影响/ ./ 其/ 原因/ 在于/ 当/ top/ -/ K/ 取值/ 太大时/ ,/ 返回/ 给/ 用户/ 的/ FD/ 最小/ 覆盖/ 集合/ S/ 中/ 可能/ 存在/ φ/ i/ ,/ φ/ j/ ∈/ S/ ,/ 使得/ φ/ j/ 被/ φ/ i/ 和/ 已/ 成立/ 的/ 结果/ 集/ F/ 所/ 共同/ 包含/ ,/ 这样/ φ/ i/ 被/ 用户/ 判定/ 为/ 成立/ 时/ φ/ j/ 仍/ 需要/ 用户/ 确认/ 造成/ 重复/ 的/ 工作/ ./ 由此可知/ ,/ 因此/ top/ -/ K/ 不能/ 太大/ ./ 可以/ 看到/ ,/ 如果/ 每次/ 仅/ 返回/ 一个/ 数据/ ,/ 即/ top/ -/ K/ =/ 1/ 重复/ 判断/ 次数/ 最少/ ./ 但/ 由于/ 算法/ 模拟/ 的/ 是/ 一个/ 返回/ 给/ 用户/ 的/ 过程/ ,/ 每次/ 仅/ 返回/ 1/ 个/ FD/ 可能/ 造成/ 用户/ 交互/ 次数/ 太/ 多/ ,/ 因此/ 实验/ 中/ 经验/ 选取/ top/ -/ K/ =/ 5/ 作为/ 返回/ ./ 在/ 交互式/ 的/ 应用/ 场景/ 中/ 实验/ 对/ 用户/ 确认/ 进行/ 模拟/ ,/ 并/ 比较/ 用户/ 工作量/ (/ userefforts/ )/ 和/ 发现/ 的/ FD/ 比率/ (/ 即/ 召回/ 率/ recall/ )/ 之间/ 的/ 关系/ ./ 实验/ 结果/ 如图/ 6/ 、/ 图/ 7/ 所示/ ,/ 图/ 6/ 中/ x/ 轴/ 表示/ 发现/ 成立/ FD/ 比例/ ,/ y/ 轴/ 代表/ 发现/ 这些/ FD/ 所/ 需要/ 的/ 用户/ 工作量/ ./ 实验/ 结果/ 证明/ 交互式/ 应用/ 中/ DSC/ 方法/ 在/ 不同/ 数据/ 集合/ 以及/ 错误率/ 的/ 情况/ 下/ 用户/ 工作量/ 均/ 少于/ 置信度/ 排序/ ./ 图中/ 可以/ 看到/ ,/ 除了/ (/ a/ )/ 、/ (/ b/ )/ 两图/ 中/ 用户/ 工作量/ 达到/ 50/ %/ 以外/ ,/ 其余/ 用户/ 工作量/ 都/ 在/ 20/ %/ ~/ 40/ %/ 之间/ ,/ 说明/ DSC/ 方法/ 的/ 交互式/ 检测/ 方法/ 可以/ 有效/ 降低/ 人/ 的/ 工作量/ ./ 同时/ 从图/ 中/ 可以/ 看到/ ,/ SC/ 方法/ 往往/ 在/ 刚/ 开始/ 时/ 效果/ 较/ 好/ ,/ 但是/ 随着/ recall/ 增加/ ,/ 其/ 需要/ 的/ 用户/ 工作量/ 大幅/ 增加/ ./ 这/ 是因为/ 置信度/ 隐含/ 的/ 假设/ 是/ 待/ 检测/ FD/ 中/ 不/ 一致/ 数据/ 越/ 少/ ,/ 其/ 真实/ 成立/ 可能/ 越大/ ./ 因此/ 当/ FD/ 待/ 检测/ 集中/ 少部分/ 满足/ 该/ 假设/ 的/ FD/ 被/ 发现/ 后/ ,/ 置信度/ 的/ 检测/ 效果/ 变差/ ./ 相比之下/ 使用/ DSC/ 方法/ 的/ 检测/ 并/ 没有/ 受到/ 太/ 大/ 影响/ ,/ 在/ hospital/ 数据/ 更是/ 保持/ 在/ 线性/ 增长/ ./ 在/ hospital/ 数据/ 中/ ,/ DSC/ 曲线/ 开始/ 时有/ 一小/ 段/ 效果/ 差于/ 置信度/ 排序/ ,/ 这是/ 由于/ FD/ 之间/ 互相/ 影响/ 使得/ 有/ 一些/ FD/ 虽然/ 不/ 成立/ ,/ 但是/ 其/ 不/ 一致/ 部分/ 数据/ 可能/ 被/ 包含/ 在/ 另外/ 一个/ 真实/ 成立/ FD/ 中/ ,/ 因此/ 计算/ DSC/ 排序/ 靠前/ 所致/ ./ CFD/ 的/ 检测/ 同样/ 使用/ FACD/ 方法/ 挖掘/ 候选/ 集/ ,/ 使用/ 相同/ 方法/ 进行/ 检测/ ./ 在/ 图/ 7/ 的/ CFD/ 检测/ 中/ 可以/ 发现/ ,/ DSC/ 曲线/ 在/ 各图/ 中/ 趋势/ 较为/ 一致/ ./ 而/ SC/ 曲线/ Page10/ 图/ 4FD/ 检测/ 精确度/ Page11/ 图/ 5CFD/ 检测/ 精确度/ Page12/ 图/ 6/ 用户/ 工作量/ 与/ FD/ 发现/ Page13/ 图/ 7/ 用户/ 工作量/ 与/ CFD/ 发现/ Page14/ 则/ 显得/ 不/ 稳定/ ,/ 如图/ 7/ (/ e/ )/ 表现/ 较/ 好/ 与/ DSC/ 曲线/ 相似/ ,/ 但是/ DSC/ 在/ 大多数/ 情况/ 下/ 优于/ SC/ 方法/ ,/ 其/ 原因/ 与/ 图/ 5/ (/ e/ )/ 相似/ ,/ 都/ 是因为/ 错误率/ 较/ 少时/ CFD/ 所/ 产生/ 的/ 候选/ 集/ 与/ 其他/ 错误率/ 下/ 产生/ 候选/ 集/ 差异/ 较大/ ./ 另外/ CFD/ 检测/ 曲线/ 中/ 尾部/ 效果/ 变差/ 的/ 原因/ 主要/ 在于/ CFD/ 实验所/ 使用/ 的/ 待/ 检测/ 集中/ 真实/ 成立/ 的/ CFD/ 所/ 占/ 比例/ 较/ 小/ ,/ 仅/ 占/ 全部/ 成立/ CFD/ 的/ 20/ %/ 左右/ ./ 因此/ 部分/ CFD/ 排序/ 靠/ 后/ 所致/ ./ 6.3/ 性能/ 分析/ 本节/ 对/ MBBN/ 快速/ 构建/ 算法/ 以及/ 检测/ 算法/ 进行/ 性能/ 评估/ ,/ 结果/ 如图/ 8/ 所示/ ./ MBBN/ 构建/ 算法/ 主要/ 比较/ 了/ 简化/ 算法/ 和/ 原/ 算法/ 的/ 时间/ 效率/ 扩展性/ ./ 检测/ 算法/ 给出/ 了/ 时间/ 效率/ 的/ 扩展性/ 以及/ CPT/ 是否/ 简化/ 时/ 内存/ 占用/ 情况/ 的/ 实验/ 结果/ ,/ 并/ 讨论/ 了/ 检测/ 算法/ 在/ 大/ 数据/ 场景/ 中/ 的/ 应用/ 方法/ ./ 图/ 8/ (/ a/ )/ 、/ (/ b/ )/ 为/ MBBN/ 快速/ 构建/ 算法/ 和/ 原/ 算法/ 时间/ 效率/ 比较/ 结果/ ./ 图中/ FC/ -/ MBBN/ 表示/ MBBN/ 快速/ 构建/ 算法/ (/ FastConstructingMBBN/ )/ ,/ base/ -/ MBBN/ 表示/ 原/ 算法/ ./ 实验/ 结果表明/ 快速/ 构建/ 算法/ 在/ 时间/ 比原/ 算法/ 有/ 数量级/ 上/ 的/ 改善/ ./ 在/ 时间/ 对比/ 中/ ,/ 快速/ 算法/ 基本上/ 在/ 数百/ 毫秒/ 至/ 数秒/ 内/ 可以/ 完成/ 网络/ 的/ 构建/ ,/ 具有/ 良好/ 的/ 扩展性/ ./ 图/ 8/ 算法/ 性能/ 分析/ 结果/ 图/ 8/ (/ c/ )/ 为/ 检测/ 算法/ CPT/ 内存/ 占用/ 比较/ 实验/ ,/ 图中/ CPT/ -/ S/ (/ CPT/ -/ Simplified/ )/ 为/ 本文/ 所/ 使用/ 的/ 简化/ CPT/ 方法/ ,/ CPT/ -/ O/ (/ CPTOriginal/ )/ 为/ 没有/ 简化/ CPT/ 的/ 方法/ ./ 图中/ 结果显示/ 简化/ 后/ CPT/ 长度/ 在/ 不同/ 数量/ 数据/ 下均/ 比/ 原来/ 的/ CPT/ 长度/ 减少/ 数个/ 数量级/ ./ 这/ 是因为/ 简化/ 方法/ 避免/ 了/ 组合/ 爆炸/ 问题/ ,/ 使得/ 大量/ 在/ 数据/ 中/ 未曾/ 出现/ 的/ 取值/ 组合/ 不/ 需要/ 被/ CPT/ 记录/ ./ 图/ 8/ (/ d/ )/ 为/ 整个/ 检测/ 过程/ 的/ 扩展性/ 实验/ ,/ 结果显示/ 算法/ 在/ 扩展性/ 上/ 并非/ 完全/ 的/ 线性/ 扩展/ ,/ 其/ 主要/ 原因/ 在于/ 检测/ 算法/ 运行/ 时间/ 主要/ 的/ 数据/ 违反/ FD/ 部分/ 的/ 大小/ 所/ 决定/ ,/ 而/ 非受/ 数据/ 元组/ 数/ 的/ 直接/ 影响/ ./ 虽然/ 对于/ 大/ 数据/ 应用/ 而言/ 直接/ 计算/ FD/ 的/ DSC/ 置信度/ 耗时/ 较大/ ,/ 但是/ 由于/ DSC/ 表示/ 的/ 是/ 所有/ 违反/ FD/ 数据/ 需要/ 修复/ 的/ 概率/ 均值/ ,/ 因此/ 对于/ 大/ 数据/ 可以/ 通过/ 对/ 违反/ FD/ 的/ 数据/ 元组/ 进行/ 抽样/ ,/ 通过/ 将式/ (/ 6/ )/ 中/ V/ 更换/ 为/ V/ 的/ 样本/ V/ 计算/ 近似值/ ./ 在/ 大/ 数据/ 检测/ 中/ ,/ 检测/ 过程/ 由于/ 并/ 非线性/ 扩展/ ,/ 可能/ 导致/ 计算/ 过程/ 耗时/ 较长/ ./ 由于/ DSC/ 置信度/ 代表/ 所有/ 违反/ FD/ 的/ 数据/ 需要/ 修复/ 的/ 概率/ 平均值/ ,/ 大/ 数据/ 条件/ 下/ 检测/ 算法/ 可以/ 通过/ 对/ 违反/ FD/ 部分/ 数据/ 进行/ 抽样/ ,/ 根据/ 样本/ 计算公式/ (/ 6/ )/ 置信度/ 的/ 近似值/ ,/ 降低/ 运行/ 时间/ ./ Page157/ 结论/ 针对/ 数据/ 修复/ 中/ 在/ 函数/ 依赖/ 和/ 数据/ 都/ 含有/ 错误/ 的/ 情况/ 下/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 数据/ 语义/ 分析/ 的/ 函数/ 依赖/ 置信度/ 计算方法/ ,/ 该/ 方法/ 使用/ 条件/ 概率/ 定义/ 的/ 数据/ 语义/ 分析/ 置信度/ 作为/ 数据/ 是否/ 含有/ 错误/ 的/ 依据/ ,/ 同时/ 可/ 应用/ 于/ 自动检测/ 和/ 交互式/ 检测/ 两种/ 场景/ 使得/ 检测/ 问题/ 可以/ 有效/ 解决/ ./ 

