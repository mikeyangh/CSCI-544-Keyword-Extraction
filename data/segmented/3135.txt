Page1/ 可信/ 数据库/ 环境/ 下面/ 向/ 服务/ 的/ 自/ 适应/ 密文/ 数据/ 查询方法/ 宋伟/ 彭智勇/ 程芳权/ 李文海/ 胡文斌/ 任毅/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430074/ )/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430074/ )/ 摘要/ 实现/ 加密/ 数据/ 的/ 高效/ 安全/ 查询/ 是/ 保证/ 可信/ 数据库/ 安全性/ 和/ 实用性/ 的/ 关键/ ./ 与/ 目前/ 加密/ 数据/ 查询/ 采用/ 的/ 静态/ 密文/ 分段/ 方法/ 不同/ ,/ 论文/ 基于/ 加密/ 数据/ 的/ 分布/ 和/ 用户/ 查询/ 类型/ 、/ 分布/ 规律/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 加密/ 索引/ AEI/ (/ AdaptiveEncryptedIndex/ )/ ,/ 实现/ 面向/ 服务/ 的/ 加密/ 数据/ 查询/ ./ AEI/ 通过/ 分析/ 查询/ 服务/ 对/ 查询/ 性能/ 的/ 影响/ ,/ 根据/ 承载/ 服务/ 特性/ 、/ 密文/ 数据分布/ 、/ 用户/ 查询/ 分布/ 采用/ 自/ 适应/ 的/ 加密/ 索引/ 划分/ 策略/ ,/ 获得/ 更好/ 的/ 加密/ 数据/ 查询/ 性能/ ./ 基于/ AEI/ 方法/ 可/ 在/ 可信/ 数据库/ 环境/ 下/ 实现/ 密文/ 数据/ 查询/ ,/ 并/ 通过/ 了/ 相关/ 性能/ 测试/ ./ 实验/ 数据/ 表明/ ,/ 与/ 其它/ 加密/ 数据/ 查询方法/ 相比/ ,/ AEI/ 方法/ 具有/ 更好/ 的/ 适应性/ 和/ 更/ 高/ 的/ 加密/ 数据/ 查询/ 效率/ ./ 关键词/ 自/ 适应/ 加密/ 索引/ ;/ DAS/ 模型/ ;/ 可信/ 数据库/ ;/ 密文/ 数据/ 查询/ ;/ 查询/ 假/ 阳性率/ 1/ 引言/ 可信性/ 必须/ 得到/ 保证/ ./ 数据库/ 的/ 可信性/ 主要/ 强调/ 即使/ 在/ 不可/ 信/ 应用环境/ 下/ ,/ 如/ 数据库管理员/ 不可/ 信/ 、/ 存储介质/ 失窃/ 、/ 黑客攻击/ 等/ ,/ 仍然/ 可以/ 保证数据/ 的/ 安全/ 数据库系统/ 是/ 支撑/ 信息系统/ 的/ 基础/ 软件/ ,/ 它/ 的/ 性/ ./ 目前/ 还/ 没有/ 一个/ 可信/ 数据库/ 的/ 明确/ 定义/ ,/ 我们/ 认/ Page2/ 为/ 可信/ 数据库/ 是/ 在/ 传统/ 多级/ 安全/ 数据库/ 基础/ 上/ 利用/ 加密/ 和/ 密文/ 查询/ 机制/ 进一步/ 阻止/ 来自/ 内部/ 的/ 恶意/ 访问/ 和/ 窃取/ ,/ 保护/ 数据库/ 敏感数据/ 的/ 私密性/ 和/ 查询/ 过程/ 的/ 安全性/ [/ 1/ ]/ ./ 目前/ 构建/ 可信/ 数据库/ 的/ 方法/ 主要/ 是/ 对/ 数据库/ 数据/ 进行/ 加密/ 处理/ ,/ 但是/ 数据/ 加密/ 后/ 会/ 失去/ 原始数据/ 本身/ 所/ 具有/ 的/ 很多/ 特性/ ,/ 如/ 有序性/ 、/ 相似性/ 等/ ,/ 这/ 给/ 可信/ 数据库/ 中/ 的/ 数据/ 查询/ 带来/ 了/ 很大/ 困难/ 和/ 挑战/ ./ 本文/ 分析/ 数据库/ 承载/ 服务/ 的/ 特性/ 及其/ 对/ 密文/ 数据/ 查询/ 的/ 影响/ ,/ 给出/ 了/ 一种/ 自/ 适应/ 加密/ 索引/ AEI/ (/ AdaptiveEncryptedIndex/ )/ ,/ 基于/ 数据/ 和/ 用户/ 访问/ 分布/ 进行/ 自/ 适应/ 密文/ 数据/ 分段/ 划分/ ,/ 实现/ 面向/ 服务/ 的/ 高效/ 、/ 安全/ 密文/ 数据/ 查询/ 服务/ ./ 与/ 其它/ 可信/ 加密/ 数据库/ 的/ 查询方法/ 相比/ ,/ AEI/ 能/ 更好/ 地/ 适应/ 数据/ 的/ 动态变化/ 和/ 用户/ 访问/ 的/ 不/ 均衡性/ ./ 针对/ AEI/ 查询方法/ 的/ 相关/ 性能/ 测试/ 结果/ ,/ 进一步/ 验证/ 了/ 相关/ 分析/ ./ 本文/ 第/ 2/ 节/ 分析/ 并/ 比较/ 一些/ 其他/ 学者/ 在/ 本/ 研究/ 方向/ 上/ 的/ 相关/ 研究/ 工作/ 成果/ ;/ 第/ 3/ 节/ 详细/ 介绍/ 提出/ 的/ 面向/ 服务/ 密文/ 数据/ 查询方法/ ;/ 第/ 4/ 节/ 给出/ 模拟实验/ 设计/ 对/ 理论/ 方法/ 进行/ 验证/ ,/ 并/ 对/ 实验/ 结果/ 进行/ 分析/ ;/ 最后/ 在/ 第/ 5/ 节/ 总结/ 全文/ 并/ 提出/ 下/ 一步/ 需要/ 继续/ 研究/ 的/ 工作/ ./ 2/ 相关/ 工作/ 数据库/ 作为/ 信息系统/ 的/ 支撑/ 软件/ ,/ 在/ 各种/ 应用/ 系统/ 中/ 几乎/ 无处不在/ ./ 随着/ 应用/ 的/ 日益/ 丰富/ 和/ 复杂/ ,/ 企业/ 为/ 维护/ 数据库/ 需要/ 付出/ 大量/ 人力/ 、/ 物力/ ./ 2002/ 年/ Hacg/ ü/ m/ ü/ 等/ 人/ 首先/ 提出/ 了/ DAS/ (/ DatabaseAsService/ )/ 服务/ 模式/ 的/ 概念/ [/ 2/ ]/ ,/ 将/ 数据库/ 作为/ 一种/ 外/ 包/ 服务/ 由/ 第三方/ 提供/ ,/ 这种/ 服务/ 模式/ 减轻/ 了/ 企业/ 的/ 维护/ 代价/ 和/ 运营/ 成本/ ,/ 但是/ 数据/ 存储/ 在/ 第三方/ 也/ 带来/ 了/ 一些/ 安全隐患/ ./ 目前/ 数据库/ 数据/ 都/ 以/ 明文/ 形式/ 存储/ ,/ 在/ DAS/ 模型/ 的/ 外包/ 服务/ 模式/ 下/ ,/ 难以/ 保证数据/ 的/ 安全性/ 和/ 私密性/ ,/ DBA/ 本身/ 的/ 不/ 可靠/ ,/ 黑客/ 突破/ DBMS/ 访问控制/ 保护/ 以及/ 数据库/ 物理/ 文件/ 的/ 失窃/ 等/ 都/ 给/ 数据库/ 数据/ 安全性/ 带来/ 了/ 极大/ 威胁/ ./ 如何/ 解决/ 应用/ 系统/ 将/ 数据/ 放在/ 第三方/ 管理/ 的/ 安全隐患/ ,/ 成为/ 可信/ 数据库/ 的/ 研究/ 热点/ 和/ 关键问题/ ./ DAS/ 模型/ 提出/ 对/ 数据库/ 中/ 数据/ 进行/ 信息/ 加密/ ,/ 以/ 保护/ 数据/ 隐私/ 安全/ ./ 数据/ 加密/ 后/ 会/ 失去/ 原始数据/ 本身/ 所/ 具有/ 的/ 一些/ 特性/ [/ 3/ -/ 4/ ]/ ,/ 如/ 有序性/ 、/ 相似性/ 等/ ,/ 难以/ 在/ 密文/ 数据/ 上/ 直接/ 进行/ 查询/ 和/ 运算/ 操作/ ,/ 如果/ 对/ 所有/ 加密/ 数据/ 进行/ 解密/ ,/ 再/ 在/ 明文/ 数据/ 基础/ 上/ 进行/ 查询/ ,/ 由于/ 解密/ 操作/ 开销/ 巨大/ ,/ 会/ 极大/ 影响/ 查询/ 性能/ ,/ 而且/ 对/ 密文/ 数据/ 解密/ 也/ 会/ 引起/ 信息/ 泄漏/ ,/ 破坏/ 可信/ 数据库/ 安全性/ ./ 如何/ 实现/ 可信/ 数据库/ 环境/ 下/ 密文/ 数据/ 的/ 高效/ 查询/ 成为/ 近年来/ 的/ 研究/ 热点问题/ ./ 目前/ 国内外/ 学者/ 和/ 研究/ 人员/ 在/ 可信/ 数据库/ 加密/ 数据/ 查询/ 方面/ 做/ 了/ 大量/ 研究/ 工作/ ,/ 大致/ 可以/ 分为/ 以下/ 3/ 类/ :/ (/ 1/ )/ 不/ 解密/ 而/ 直接/ 操作/ 密文/ 数据/ 的/ 方法/ ./ 这类/ 方法/ 利用/ 秘密/ 同态/ 、/ 保持/ 有序/ 等/ 加密/ 方法/ ,/ 不/ 对/ 密文/ 数据/ 进行/ 解密/ ,/ 直接/ 在/ 密文/ 数据/ 上/ 进行/ 运算/ 操作/ ./ Rivest/ 等/ 使用/ 秘密/ 同态/ (/ privacyhomomorphism/ )/ 函数/ 算法/ 对/ 数据/ 进行/ 加密/ ,/ 无须/ 解密/ 直接/ 可以/ 对/ 加密/ 数据/ 进行/ 算术/ 运算/ 操作/ [/ 3/ ]/ ./ 这种/ 方法/ 提高/ 了/ 加密/ 数据/ 操作/ 性能/ ./ 但是/ 在/ 现实/ 中/ 构造/ 一个/ 可行/ 的/ 同态/ 加密/ 函数/ 非常/ 困难/ ,/ 而且/ 同态/ 加密/ 方法/ 本身/ 也/ 存在/ 一定/ 安全隐患/ ./ Agrawal/ 等/ 提出/ 了/ 一种/ 保持/ 有序/ 的/ 加密/ 方法/ [/ 4/ ]/ ,/ 但/ 加密/ 数据/ 保持/ 有序性/ ,/ 容易/ 遭到/ 选择/ 密文/ 攻击/ ./ Ozsoyoglu/ 等/ 提出/ 了/ 另/ 一种/ 保持/ 有序/ 的/ 加密/ 方法/ [/ 5/ ]/ ,/ 也/ 存在/ 一定/ 安全隐患/ ,/ 容易/ 遭受/ 已知/ 明文/ 攻击/ 和/ 统计/ 攻击/ ./ (/ 2/ )/ 快速/ 解密/ 的/ 方法/ ./ 这类/ 方法/ 通过/ 快速/ 解密/ 可信/ 数据库/ 存储/ 的/ 密文/ 数据/ ,/ 提高/ 系统/ 查询/ 性能/ ./ 目前/ 的/ 研究成果/ 有子/ 密钥/ 加密/ 、/ 智能卡/ 加密/ 等/ ./ David/ 等/ 基于/ 中国/ 剩余/ 定理/ 提出/ 了/ 子/ 密钥/ 加密技术/ [/ 6/ ]/ ,/ 这种/ 方法/ 在/ 解密/ 密文/ 数据/ 时/ ,/ 只/ 需/ 进行/ 一次/ 模/ 运算/ ./ Ge/ 等/ 提出/ 了/ 一种/ 轻量级/ 数据/ 加密/ 机制/ FCE/ [/ 7/ ]/ ,/ Bou/ -/ ganim/ 等/ 采取/ 智能卡/ 技术/ 实现/ 加密/ 数据/ 快速/ 查询/ [/ 8/ ]/ ,/ 但是/ 它/ 不能/ 对/ 实数/ 类/ 数据/ 进行/ 范围/ 查询/ ./ 这种/ 方法/ 主要/ 对/ 加密算法/ 本身/ 进行/ 改造/ ,/ 使/ 之/ 适应/ 可信/ 数据库/ 应用/ 需求/ ,/ 但/ 加密/ 方法/ 经过/ 改造/ 后/ 存在/ 一定/ 安全隐患/ ,/ 而且/ 数据/ 在/ 服务器端/ 解密/ ,/ 也/ 会/ 破坏/ 可信/ 数据库/ 存储/ 数据/ 的/ 私密性/ ./ (/ 3/ )/ 利用/ 密文/ 数据/ 分段/ 过滤/ 的/ 方法/ ./ 这类/ 方法/ 中/ 可信/ 数据库/ 服务器进行/ 中间/ 处理/ 得到/ 一个/ 包含/ 所有/ 结果/ 数据/ 的/ 较/ 小/ 中间/ 结果/ 集/ ,/ 由/ 客户端/ 对/ 中间/ 结果/ 集/ 进行/ 解密/ 过滤/ 获得/ 最终/ 结果/ ,/ 从而/ 减少/ 用户/ 解密/ 工作量/ ,/ 提高/ 查询/ 性能/ ./ Hacigumus/ 等/ 在/ DAS/ 模型/ 基础/ 上/ ,/ 对/ 密文/ 数据/ 构建/ 分段/ 索引/ ,/ 缩小/ 解密/ 范围/ ,/ 返回/ 客户端/ 的/ 记录集/ 包含/ 一些/ 不/ 满足/ 查询/ 条件/ 的/ 记录/ ,/ 需要/ 由/ 客户端/ 进行/ 解密/ 过滤/ 处理/ [/ 9/ ]/ ;/ Hacigumus/ 基于/ 这一/ 方法/ 又/ 研究/ 了/ 如何/ 实现/ 加密/ 数据/ 的/ 聚集/ 操作/ 运算/ [/ 10/ ]/ 以及/ 密文/ 分段/ 的/ 优化/ 方法/ [/ 11/ ]/ ./ Wang/ 等/ 提出/ 了/ 一种/ 桶/ 划分/ 的/ 自/ 适应/ 调整/ 方法/ STBucket/ [/ 12/ ]/ 减小/ 查询/ 的/ 假/ 阳性率/ ./ 此外/ ,/ 还有/ 一些/ 其它/ 加密/ 数据/ 查询方法/ 研究/ ,/ 戴/ Page3/ 一奇/ 等/ 给出/ 了/ 一种/ 在/ 非/ 同态/ 密文/ 上/ 建立/ 索引/ 的/ 方法/ 完成/ 数据/ 的/ 快速/ 检索/ [/ 13/ ]/ ./ 这种/ 方法/ 十分/ 适用/ 于单/ 条件/ 密文/ 检索/ ,/ 同时/ 经过/ 处理/ 也/ 能/ 适用/ 于/ 复合/ 条件/ 的/ 查询/ ./ 文献/ [/ 14/ ]/ 利用/ 查询/ 重写/ 方法/ 实现/ 属性/ 粒度/ 的/ 数据库/ 加密/ ,/ 降低/ 网络通信/ 量/ 提高/ 系统/ 性能/ ./ 秘密/ 信息检索/ PIR/ [/ 15/ -/ 17/ ]/ 保证/ 用户/ 从/ 数据库/ 获得/ 信息/ ,/ 而/ 服务器/ 并不知道/ 用户/ 究竟/ 查询/ 什么/ 信息/ ,/ 保护/ 用户/ 查询/ 的/ 私密性/ ./ 可信/ 数据库/ 密文/ 分段/ 查询方法/ [/ 9/ ]/ 使/ 解密/ 操作/ 只/ 在/ 客户端/ 进行/ ,/ 保证/ 了/ 数据/ 的/ 安全性/ ,/ 但/ 并/ 没有/ 研究/ 密文/ 索引/ 分段/ 对/ 查询/ 效率/ 的/ 影响/ ./ 文献/ [/ 11/ ]/ 研究/ 了/ 索引/ 优化/ 方法/ ,/ 但/ 没有/ 考虑/ 用户/ 查询/ 差异/ 带来/ 的/ 影响/ ./ 目前/ 密文/ 数据/ 分段/ 普遍/ 采用/ 静态/ 划分/ 方法/ ,/ 还/ 无法/ 支持/ 可信/ 数据库/ 数据/ 的/ 更新/ ./ 文献/ [/ 12/ ]/ 提出/ 了/ 一种/ 自/ 适应/ 的/ 密文/ 桶/ 划分/ 调整/ 方法/ ,/ 但/ 并/ 没有/ 考虑/ 不同/ 类型/ 查询/ 对/ 密文/ 查询/ 带来/ 的/ 影响/ ./ 本文/ 首先/ 分析/ 密文/ 数据分布/ 和/ 承载/ 服务/ 特征/ 对/ 密文/ 查询/ 效率/ 的/ 影响/ ,/ 进而/ 提出/ 了/ 一种/ 面向/ 服务/ 的/ 自/ 适应/ 密文/ 分段/ 索引/ AEI/ ,/ 与/ 其它/ 研究/ 方法/ 相比/ ,/ AEI/ 结合/ 数据分布/ 和/ 用户/ 访问/ 服务/ 特征/ 自/ 适应/ 地/ 进行/ 密文/ 数据/ 分段/ 划分/ ,/ 可以/ 更好/ 地/ 适应/ 数据库/ 数据/ 的/ 更新/ ,/ 同时/ 对/ 不同/ 类型/ 数据/ 查询/ 服务/ 也/ 具有/ 更好/ 的/ 适应性/ 和/ 更/ 高/ 的/ 查询/ 效率/ ./ 3/ 面向/ 服务/ 的/ 自/ 适应/ 密文/ 数据/ 查询方法/ 3.1/ 可信/ 数据库/ 环境/ 下/ 的/ 加密/ 数据/ 过滤/ 查询数据库/ 中/ 存储/ 了/ 不同/ 类型/ (/ 主要/ 是/ 字符/ 型/ 和/ 数值/ 型/ )/ 的/ 数据/ ,/ 它们/ 承载/ 的/ 查询/ 服务/ 各不相同/ ,/ 而/ 加密/ 数据/ 的/ 查询/ 差别/ 就/ 更/ 大/ 了/ ,/ 论文/ 主要/ 研究/ 可信/ 数据库/ 中/ 数值/ 型/ 密文/ 数据/ 的/ 高效/ 、/ 安全/ 查询方法/ ./ 相关/ 研究/ [/ 2/ ,/ 9/ ,/ 11/ ]/ 对/ 加密/ 属性/ 值/ 划分/ 密文/ 数据/ 分段/ ,/ 服务器/ 收到/ 查询/ 请求/ 后/ 把/ 密文/ 数据/ 分段/ 内/ 的/ 全部/ 密文/ 元组/ 返回/ 用户/ ,/ 这种/ 方法/ 返回/ 的/ 结果/ 集/ 包含/ 所有/ 正确/ 结果/ ,/ 但/ 也/ 有/ 不/ 符合/ 查询/ 条件/ 的/ 内容/ ,/ 由/ 用户/ 解密/ 过滤/ 获得/ 最终/ 结果/ ./ 如图/ 1/ 可信/ 数据库/ ,/ 原始数据/ 加密/ 后/ 的/ 密文/ 元组/ 如图/ 1/ (/ b/ )/ ,/ salary/ 数据/ 内容/ 采用/ esalary/ =/ Map/ (/ salary/ )/ 函数/ 加密/ 存储/ ,/ salary/ 的/ 密文/ 映射/ 数据/ 分段/ 如图/ 1/ (/ c/ )/ ./ 当/ 用户/ 发起/ 针对/ salary/ 的/ 查询/ (/ 如/ salary/ =/ 55K/ )/ 时/ ,/ 首先/ 将/ 查询/ 值/ 映射/ 到/ 对应/ 的/ 密文/ 数据/ 分段/ 上/ ,/ 服务器/ 将/ 所有/ 可能/ 元组/ (/ (/ 40K/ ,/ 60K/ )/ 分段/ 上/ 的/ 全部/ 密文/ 元组/ )/ 返回/ 客户端/ ,/ 由/ 客户端/ 解密/ 过滤/ 得到/ 最终/ 查询/ 结果/ ./ 110101100100/ …/ 15182310001000110010/ …/ 86111018100100010110/ …/ 47241014001011100011/ …/ 23231019010010011100/ …/ 12171521/ 这种/ 查询方法/ 服务器端/ 无需/ 解密/ ,/ 但/ 客户端/ 需要/ 对/ 全部/ 中间/ 结果/ 进行/ 解密/ 过滤/ ,/ 上/ 例/ 服务器端/ 返回/ (/ 40K/ ,/ 60K/ )/ 上/ 3/ 条/ 密文/ 元组/ ,/ 客户端/ 只有/ 全部/ 解密/ 后/ 才能/ 获得/ 最终/ 的/ 1/ 条/ 正确/ 匹配/ 元组/ ./ 这种/ 查询/ 方式/ 下/ 加解密/ 操作/ 成为/ 决定/ 查询/ 效率/ 的/ 关键/ ./ 论文/ 利用/ 式/ (/ 1/ )/ 所示/ 假/ 阳性率/ (/ falsepositiverate/ )/ [/ 11/ ]/ 、/ 误报率/ 即/ 中间/ 结果/ 集/ 的/ 不/ 匹配/ 元组/ 比例/ ,/ 来/ 反映/ 客户端/ 无效/ 解密/ 操作/ 量/ ./ 针对/ 某/ 查询/ 集合/ ,/ Nfit/ 为/ 符合/ 查询/ 条件/ 的/ 密文/ 元组/ 数/ ,/ Ntotal/ 为/ 返回/ 的/ 全部/ 密文/ 元组/ 规模/ ./ 如何/ 调整/ 加密/ 数据/ 分段/ ,/ 降低/ 查询/ 假/ 阳性率/ ,/ 减少/ 客户端/ 无效/ 解密/ 操作/ 量/ ,/ 成为/ 论文/ 优化/ 可信/ 数据库/ 查询/ 的/ 主要/ 手段/ 和/ 目标/ ./ 3.2/ 面向/ 服务/ 的/ 自/ 适应/ 密文/ 数据/ 查询/ 不同/ 类型/ 用户/ 查询/ 对/ 加密/ 数据/ 查询方法/ 、/ 效率/ 都/ 有/ 很大/ 影响/ ,/ 论文/ 将/ 用户/ 查询/ 分为/ 以下/ 两类/ 加以/ 研究/ :/ (/ 1/ )/ attributeopvalue/ 查询/ ;/ (/ 2/ )/ attribute1opattribute2/ 连接/ 查询/ ;/ 其中/ attribute/ 为/ 可信/ 数据库/ 某/ 加密/ 属性/ ,/ value/ 是/ 针对/ attribute/ 的/ 查询/ 值/ ,/ op/ 是/ 查询/ 操作符/ ,/ 可以/ 为/ “/ =/ ”/ 、/ “/ >/ ”/ 、/ “/ </ ”/ 、/ “/ / ”/ 和/ “/ / ”/ 等/ ./ 3.2/ ./ 1attributeopvalue/ 查询/ (/ 1/ )/ op/ 为/ “/ =/ ”/ 的/ attribute/ =/ value/ 查询/ 操作/ 针对/ 一系列/ attribute/ =/ value/ 查询/ ,/ 设/ 当前/ 加密/ 属性/ A/ 的/ 密文/ 数据/ 分段/ 为/ Range1/ ,/ …/ ,/ Rangek/ 共/ k/ 段/ ,/ 每个/ 数据/ 分段/ 的/ 密文/ 元组/ 规模/ 为/ M1/ ,/ …/ ,/ Mk/ ,/ 查询/ 值落/ 在/ 各个/ 密文/ 数据/ 分段/ 内/ 的/ 次数/ 分别/ 为/ Q1/ ,/ …/ ,/ Qk/ ,/ 每个/ 密文/ 数据/ 分段/ 返回/ 命中/ 的/ 正确/ 结果/ 总/ Page4/ 数为/ H1/ ,/ …/ ,/ Hk/ ,/ 则/ 查询/ 总假/ 阳性率/ 如式/ (/ 2/ )/ ./ 论文/ 采用/ 自/ 适应/ 索引/ 划分/ 策略/ ,/ 随着/ 用户/ 查询/ 和/ 数据/ 的/ 变化/ 动态/ 调整/ 密文/ 分段/ 划分/ ./ 首先/ 分析/ 密文/ 数据/ 分段/ 划分/ 对/ 查询/ 假/ 阳性率/ 的/ 影响/ ,/ 设将/ 当前/ 第/ i/ 个/ 密文/ 数据/ 分段/ 重新/ 划分/ 为/ 两个/ 新/ 的/ 数据/ 分段/ ,/ 各自/ 包含/ 密文/ 元组/ 数/ Mi1/ 和/ Mi2/ (/ Mi1/ +/ Mi2/ =/ Mi/ )/ ,/ 承载/ 查询/ 服务/ 量/ Qi1/ 和/ Qi2/ (/ Qi1/ +/ Qi2/ =/ Qi/ )/ ,/ 正确/ 命中/ 查询/ 结果/ 总数/ 为/ Hi1/ 和/ Hi2/ (/ Hi1/ +/ Hi2/ =/ Hi/ )/ ,/ 在/ 其它/ 密文/ 数据/ 分段/ 不变/ 的/ 前提/ 下/ ,/ 划分/ 前后/ 的/ 假/ 阳性率/ 变化/ 如式/ (/ 3/ )/ ./ Δ/ P/ =/ ∑/ i/ -/ 1MtQt/ +/ Mi1Qi1/ +/ Mi2Qi2/ +/ ∑/ kt/ =/ 1/ =/ ∑/ kMtQt/ ∑/ i/ -/ 1t/ =/ 1/ 上式/ 恒/ 大于/ 等于零/ ,/ 因此/ 对/ 较大/ 密文/ 数据/ 段/ 进一步/ 划分/ 可以/ 降低/ 假/ 阳性率/ ,/ 优化/ 查询/ ./ 下面/ 分析/ 选择/ 哪个/ 密文/ 数据/ 分段进行/ 划分/ 有/ 可能/ 使/ 优化/ 效果/ 最大/ ./ 在/ 确定/ 时间/ 点上/ ∑/ k/ 因此/ 选择/ 划分/ 后/ Mi1Qi2/ +/ Mi2Qi1/ 取得/ 最大值/ 的/ 密文/ 分段/ 可以/ 获得/ 最好/ 的/ 假/ 阳性率/ 优化/ 效果/ ./ 不同/ 类型/ 用户/ 查询/ ,/ AEI/ 索引/ 结构/ 也/ 不/ 相同/ ,/ 针对/ attribute/ =/ value/ 查询/ 其/ 结构/ 如图/ 2/ 所示/ ./ 可信/ 数据库/ 中/ ,/ 为了/ 保证/ 查询/ 请求/ 对/ 服务器端/ 保密/ ,/ 服务器/ 只/ 获得/ 针对/ 某个/ 密文/ 数据/ 分段/ 的/ 查询/ ,/ 而/ 并不知道/ 密文/ 数据/ 分段/ 内/ 用户/ 查询/ 值/ 的/ 具体/ 分布/ ,/ 因此/ 服务器端/ 难以确定/ 对/ 哪个/ 密文/ 数据/ 分段进行/ 划分/ 使得/ Mi1Qi2/ +/ Mi2Qi1/ 最大/ ./ 如图/ 2/ ,/ Query/ 记录/ 每个/ 数据/ 分段/ 承担/ 的/ 查询/ 量/ ,/ 令/ Mi1/ =/ α/ Mi/ ,/ Qi1/ =/ β/ Qi/ (/ 0/ </ α/ ,/ β/ </ 1/ )/ ,/ 则/ Mi2/ =/ (/ 1/ -/ α/ )/ Mi/ ,/ Qi2/ =/ (/ 1/ -/ β/ )/ Qi/ ,/ Mi1Qi2/ +/ Mi2Qi1/ =/ (/ α/ +/ β/ -/ 2/ α/ β/ )/ MiQi/ ~/ MiQi/ ./ 因此/ 可信/ 数据库/ 服务器端/ 总是/ 优先选择/ MiQi/ 最大/ 的/ 加密/ 数据/ 分段/ 作为/ 优化/ 目标/ ./ 110101100100/ …/ 15182310001000110010/ …/ 86111018100100010110/ …/ 47241014001011100011/ …/ 23231019010010011100/ …/ 12171521R/ _/ idesalaryMinimumMaximalQueryJoincost113020000150221200004000018228310400006000058400423600008000042102515800001000009null/ 图/ 2attributeopvalue/ 的/ AEI/ 密文/ 分段/ 索引/ 结构/ AEI/ 设置/ 采样/ 时间/ 窗口/ interval/ 来/ 统计/ 用户/ 访问量/ ,/ Query/ 统计/ interval/ 内/ 每个/ 密文/ 分段/ 的/ 查询/ 访问量/ ,/ 采样/ 周期/ 结束/ 将/ 访问量/ 清零/ ./ 为了/ 使/ interval/ 更/ 准确/ 地/ 反映/ 用户/ 访问量/ 的/ 变化/ ,/ AEI/ 随着/ 用户/ 访问量/ 的/ 变化/ 调整/ 采样/ 时间/ 间隔/ (/ 当/ 用户/ 访问量/ 增加/ 时/ ,/ 缩小/ 采样/ 间隔/ 及时/ 地/ 调整/ 可信/ 数据库/ 密文/ 分段/ ,/ 当/ 用户/ 访问量/ 减小/ 时/ ,/ 扩大/ 采样/ 时间/ 间隔/ ,/ 减低/ 服务器端/ 处理量/ )/ ./ 设/ 当前/ 采样/ 时间/ 间隔/ 为/ intervalnow/ ,/ 则/ 下/ 一/ 周期/ 的/ 采样/ 间隔/ intervalnext/ 如式/ (/ 4/ )/ 所示/ ,/ 其中/ Querynow/ 和/ Querylast/ 分别/ 表示/ 当前/ 和/ 上/ 一个/ 时间/ 间隔/ 内/ 的/ 用户/ 访问量/ ./ 设/ 系统/ 允许/ 的/ 最大/ 密文/ 分段/ 数为/ K/ ,/ 当前/ 密文/ 分段/ 数为/ k/ ,/ 每次/ 时间/ 间隔/ 结束/ ,/ 在/ 密文/ 分段/ 总数/ 不/ 超过/ K/ 的/ 前提/ 下/ ,/ 服务器/ 选择/ 至多/ α/ ×/ k/ (/ 0/ </ α/ </ 1/ )/ 个/ MiQi/ 最大/ 的/ 密文/ 分段/ 作为/ 待/ 划分/ 的/ 目标/ ./ 随着/ 密文/ 分段/ 的/ 划分/ ,/ 直接/ 划分/ 密文/ 分段/ 有/ 可能/ 超出/ 分段/ 总数/ K/ 的/ 限定/ ,/ 为了/ 更好/ 适应/ 用户/ 查询/ 服务/ 变化/ ,/ 有/ 必要/ 对/ 部分/ 数据量/ 和/ 承载/ 服务/ 量/ 较/ 小/ 的/ 密文/ 分段进行/ 合并/ 优化/ ,/ 因此/ 需要/ 衡量/ 划分/ 密文/ 分段/ 和/ 合并/ 之间/ 的/ 代价/ ./ 如图/ 2/ (/ b/ )/ 所示/ ,/ AEI/ 以/ 密文/ 分段/ 和/ 右侧/ 相邻/ 密文/ 分段/ 合并/ 后/ 的/ M/ ×/ Q/ 作为/ 其/ 合并/ 代价/ Joincost/ ./ 当/ 选择/ 某/ 密文/ 分段/ bucket/ 进一步/ 划分/ 超出/ K/ 限制/ 时/ ,/ 将/ bucket/ 的/ 优化/ 判定/ 条件/ MiQi/ 与/ 系统/ 中/ 最小/ 的/ 密文/ 分段/ 合并/ 代价/ Joincost/ 进行/ 比较/ ,/ 当/ 划分/ 优化/ 效果/ 大于/ 合并/ 代价/ 时/ ,/ 说明/ 划分/ 更/ 有利于/ 优化/ 查询/ ,/ 将/ bucket/ 加入/ 待/ 划分/ 列表/ ,/ 合并/ 具有/ 最小/ 合并/ 代价/ Page5/ 的/ 两个/ 密文/ 分段/ 并/ 局部/ 更新/ 合并/ 代价/ ,/ 迭代/ 这一/ 过程/ 直至/ 找到/ α/ k/ 个/ 待/ 划分/ 分段/ ,/ 或/ 划分/ 密文/ 分段/ 的/ 优化/ 判定/ 条件/ 小于/ 最小/ 合并/ 代价/ 为止/ ,/ 选择/ 算法/ 如/ 算法/ 1/ 所示/ ./ 服务器端/ 最坏/ 情况/ 下/ 需要/ 选择/ α/ k/ 个/ 待/ 划分/ 的/ 密文/ 数据/ 分段/ ,/ 因此/ 算法/ 最坏/ 情况/ 下/ 的/ 时间/ 复杂度/ 为/ O/ (/ α/ k/ )/ ./ 如图/ 2/ 所示/ AEI/ 索引/ 结构/ ,/ 服务器/ 增加/ 图/ 2/ (/ b/ )/ 密文/ 索引/ 存储/ 开销/ 与/ 当前/ 密文/ 分段/ 规模/ k/ 成正比/ 为/ O/ (/ k/ )/ ./ 数据库/ 初始状态/ 只有/ 一个/ 数据/ 分段/ ,/ 若/ 单纯/ 利用/ AEI/ 方法/ 调整/ 需要/ 较长时间/ ,/ 不利于/ 服务质量/ 的/ 稳定/ ./ 为/ 加快/ 密文/ 分段/ 的/ 优化/ 调整/ ,/ 初始化/ 时/ 可以/ 采用/ equi/ -/ width/ 、/ equi/ -/ depth/ 或/ QOB/ 等/ 其它/ 方法/ 划分/ 若干/ 密文/ 分段/ ,/ 再/ 随着/ 数据/ 和/ 服务/ 的/ 加载/ 利用/ AEI/ 方法/ 进行/ 动态/ 调整/ 和/ 优化/ ./ 算法/ 1/ ./ attribute/ =/ value/ 查询/ ,/ 划分/ 数据/ 分段/ 选择/ 算法/ ./ 参数/ :/ K/ ,/ 最大/ 分段/ 数/ ;/ α/ ,/ 划分/ 比例/ ;/ k/ ,/ 当前/ 分段/ 数/ ;/ 返回/ :/ list/ _/ buckets/ ,/ 待/ 划分/ 密文/ 分段/ 列表/ ;/ 1/ ./ if/ (/ (/ 1/ +/ α/ )/ k/ >/ K/ )/ {/ // // 有/ 必要/ 进行/ 合并/ 优化/ 调整/ 2/ ./ for/ (/ inti/ =/ 1/ ;/ i/ </ =/ α/ / k/ ;/ i/ ++/ )/ {/ 3/ ./ bucket/ =/ 剩余/ 密文/ 数据/ 分段/ 中/ Mi/ ×/ 4/ ./ if/ (/ i/ +/ k/ </ =/ K/ )/ {/ // // 没有/ 超出/ 最大/ 密文/ 分段/ 数/ 5/ ./ list/ _/ buckets/ ./ add/ (/ bucket/ )/ ;/ 6/ ./ }/ else/ {/ 7/ ./ if/ (/ bucket/ ’/ sMi/ ×/ Qi/ </ Min/ (/ Joincost/ )/ )/ {/ 8/ ./ break/ ;/ // // 划分/ 代价/ 更大/ 停止/ 选择/ 9/ ./ }/ else/ {/ 10/ ./ list/ _/ buckets/ ./ add/ (/ bucket/ )/ ;/ 11/ ./ 合并/ 最小/ Joincost/ 的/ 密文/ 数据/ 分段/ ;/ }/ }/ }/ 12/ ./ }/ elseif/ (/ (/ 1/ +/ α/ )/ k/ </ =/ K/ )/ {/ // // 不/ 超出/ 最大/ 分段/ 数/ 限制/ 13/ ./ 选择/ α/ ×/ k/ 个/ MiQi/ 最大/ 的/ 数据/ 分段/ 进入/ 14/ ./ returnlist/ _/ buckets/ ./ 确定/ 待/ 划分/ 密文/ 数据/ 分段/ 后/ ,/ 如何/ 进行/ 划分/ 也/ 是/ 必须/ 研究/ 的/ ./ 为了/ 保护/ 数据/ 私密性/ ,/ 可信/ 数据库/ 环境/ 下/ 服务器/ 并/ 不能/ 解密/ 存储/ 的/ 数据/ ,/ 无法/ 完成/ 数据/ 分段/ 划分/ 操作/ ./ 可信/ 数据库/ 用户/ 在/ 查询/ 过程/ 中/ 会/ 获得/ 加密/ 数据/ 分段/ 上/ 的/ 全部/ 密文/ 元组/ 并/ 对/ 其/ 进行/ 解密/ 过滤/ ,/ AEI/ 利用/ 可信/ 数据库/ 的/ 这/ 一/ 服务/ 特点/ ,/ 由/ 可信/ 用户/ 前端/ 完成/ 加密/ 数据/ 分段/ 的/ 划分/ 调整/ 优化/ ./ 服务器/ 将/ 密文/ 分段/ 划分/ 请求/ 发送给/ 第一个/ 查询/ 该/ 密文/ 分段/ 的/ 用户/ ,/ 可信/ 用户端/ 在/ 查询/ 解密/ 过滤/ 基础/ 上/ ,/ 基于/ 明文/ 数据/ 元组/ ,/ 选取/ 划分/ 点/ 使得/ Mi1Qi2/ +/ Mi2Qi1/ 取得/ 极大值/ 来/ 划分/ 密文/ 分段/ ./ 但/ 可信/ 数据库/ 中/ 服务器端/ 和/ 客户端/ 都/ 不/ 知道/ 用户/ 查询/ 的/ 分布/ 状况/ ,/ 考虑/ 到/ 每个/ 数据/ 分段/ 跨度/ 较/ 小/ ,/ 可以/ 认为/ 用户/ 查询/ 在/ 数据/ 分段/ 内/ 近似/ 服从/ 均匀分布/ 即/ Q/ ~/ Range/ ,/ 则/ 划分/ 条件/ 可/ 转换/ 为/ 使/ 划分/ 后/ Mi1Rangei2/ +/ Mi2Rangei1/ 取/ 极大值/ ./ 可信/ 前端/ 完成/ 划分/ 后/ ,/ 将/ 数据/ 分段/ 和/ 密文/ 元组/ 分配/ 信息/ 返回/ 服务器/ ,/ 服务器端/ 调整/ 对应/ 密文/ 数据/ 分段/ ,/ 并/ 更新/ 数据/ 分段/ 映射函数/ ,/ AEI/ 密文/ 分段/ 优化/ 算法/ 如/ 算法/ 2/ 所示/ ./ 优化/ 算法/ ./ 算法/ 2/ ./ attribute/ =/ value/ 类型/ 查询/ ,/ 数据/ 分段/ 参数/ :/ r/ ,/ 密文/ 分段/ 最小/ 元组/ 数/ ;/ list/ _/ buckets/ ,/ 待/ 划分/ 密文/ 分段/ 列表/ ;/ 服务器端/ :/ 1/ ./ if/ (/ 客户端/ client/ 查询/ 的/ 密文/ 数据/ 分段/ bucketinlist/ _/ 2/ ./ 服务器端/ 向/ client/ 发起/ 调整/ bucket/ 请求/ ;/ 3/ ./ while/ (/ 收到/ 返回/ 的/ bucket/ 划分/ 信息/ )/ {/ 4/ ./ if/ (/ bucket/ 可以/ 进行/ 划分/ )/ 5/ ./ 调整/ 密文/ 数据/ 分段/ 和/ 分段/ 函数/ ;/ 客户端/ :/ 1/ ./ if/ (/ 客户端/ client/ 收到/ 划分/ 密文/ 分段/ bucket/ 的/ 请求/ )/ {/ 2/ ./ for/ (/ inti/ =/ bucket/ ./ Min/ ,/ temp/ =/ 0/ ;/ i/ </ =/ bucket/ ./ 3/ ./ 以/ i/ 作为/ 分界点/ 试/ 划分/ ;/ 4/ ./ if/ (/ M1/ ./ size/ (/ )/ </ rorM2/ ./ size/ (/ )/ </ r/ )/ 5/ ./ continue/ ;/ // // 不/ 满足/ 最小/ 元组/ 数/ 大于/ r/ 条件/ 6/ ./ elseif/ (/ M1Range2/ +/ M2Range1/ >/ temp/ )/ 7/ ./ temp/ =/ M1Range2/ +/ M2Range1/ ;/ 8/ ./ if/ (/ divide/ _/ point/ =/ =/ 0/ )/ 9/ ./ return/ 最小/ 元组/ r/ 限定/ 条件/ 下/ 无法/ 进行/ 划分/ ;/ 10/ ./ else11/ ./ return/ 新/ 密文/ 数据/ 分段/ 划分/ 信息/ ;/ }/ 可信/ 数据库/ 的/ 数据/ 分段/ 与/ 安全性/ 和/ 查询/ 效率/ 都/ 紧密/ 相关/ ,/ 相同/ 情况/ 下/ 数据/ 分段/ 中/ 包含/ 的/ 密文/ 元组/ 数越/ 少/ ,/ 信息/ 泄漏/ 可能性/ 也/ 越/ 大/ ./ 为了/ 保证/ 可信/ 数据库/ 安全性/ ,/ 在/ AEI/ 的/ 数据/ 分段/ 过程/ 中/ 保证/ 每个/ 密文/ 数据/ 分段/ 至少/ 包含/ r/ 个/ 元组/ ./ 密文/ 数据/ 分段/ 调整/ 算法/ 对于/ 客户端/ 来说/ ,/ 客户端/ 需要/ 比较/ 分段/ 内/ 的/ 所有/ 划分/ 点/ ,/ 其/ 时间/ 开销/ 与/ 密文/ 数据/ 分段/ 跨度/ Range/ 成正比/ ,/ 客户端/ 时间/ 复杂度/ 为/ O/ (/ Range/ )/ ./ 对于/ 服务器端/ ,/ 收到/ 每个/ 密文/ 分段/ 的/ 调整/ 信息/ 后/ ,/ 需要/ 调整/ 的/ 密文/ 元组/ 信息/ 与/ 密文/ 分段/ 内/ 元组/ 数/ Size/ 成正比/ ,/ 当/ 服务器端/ 确定/ 有/ Count/ 个/ 密文/ 数据/ 分段/ 需要/ 调整/ 时/ ,/ 服务器端/ 调整/ 密文/ 数据/ 分段/ 的/ 时间/ 开销/ 为/ O/ (/ Size/ ×/ Count/ )/ ./ AEI/ 密文/ 分段/ 调整/ 交给/ 对/ 密文/ 分段/ 查询/ 的/ 客户端/ 执行/ ,/ 这样/ 既/ 确保/ 数据/ 对/ 服务器/ 的/ 保密性/ ,/ 而且/ 由于/ 客户端/ 查询/ 过程/ 本身/ 需要/ 解密/ 所有/ 密文/ 元组/ ,/ Page6/ 也/ 不会/ 额外/ 增加/ 客户端/ 的/ 解密/ 开销/ ./ AEI/ 加密/ 数据/ 分段/ 函数/ 根据/ 密文/ 数据/ 分段/ 的/ 变化/ 而/ 变化/ ,/ 用户/ 在/ 发起/ 查询/ 请求/ 时/ 需要/ 更新/ 加密/ 数据/ 分段/ 函数/ ./ 操作/ (/ 2/ )/ op/ 为/ 比较/ 操作符/ 的/ attributeopvalue/ 查询/ op/ 为/ 比较/ 操作符/ (/ “/ >/ ”/ ,/ “/ </ ”/ ,/ “/ / ”/ 或/ “/ / ”/ )/ ,/ 针对/ 图/ 1/ 数据/ 查询/ salary/ >/ 50K/ 时/ ,/ 服务器端/ 将/ (/ 40K/ ,/ 60K/ )/ ,/ (/ 60K/ ,/ 80K/ )/ ,/ (/ 80K/ ,/ 100K/ )/ 3/ 个/ 数据/ 分段/ 的/ 密文/ 元组/ 都/ 返回/ 给/ 客户端/ 解密/ 过滤/ 获得/ 最终/ 结果/ ./ 除了/ 查询/ 值/ 所在/ 密文/ 数据/ 分段/ 存在/ 不/ 匹配/ 数据/ 元组/ 外/ ,/ 其它/ 密文/ 分段/ 返回/ 的/ 都/ 是/ 正确/ 的/ 匹配/ 结果/ ./ 和/ 前述/ 分析/ 相同/ ,/ 设/ 属性/ A/ 被/ 划分/ 为/ k/ 个/ 加密/ 数据/ 分段/ ,/ 查询/ 值/ value/ 落/ 在/ 每个/ 加密/ 数据/ 分段/ 内时/ 的/ 正确/ 结果/ 总和/ 为/ H1/ ,/ …/ ,/ Hk/ ./ 针对/ 这种/ 查询/ ,/ 需要/ 返回/ 大于/ 或/ 小于/ 方向/ 上/ 的/ 所有/ 加密/ 数据/ 分段/ 的/ 密文/ 元组/ ,/ 首先/ 考虑/ 比较/ 查询/ 符是/ 大于/ (/ 包括/ “/ >/ ”/ 和/ “/ / ”/ )/ 的/ 情况/ ,/ 其总假/ 阳性率/ 如式/ (/ 5/ )/ ./ ∑/ P/ =/ 1/ -/ ∑/ kj/ =/ t/ +/ 1Mj/ 和/ ∑/ k/ 设将/ 第/ i/ 个/ 数据/ 分段进行/ 重新/ 划分/ ,/ 划分/ 后/ 密文/ 元组/ 数为/ Mi1/ 和/ Mi2/ ,/ 覆盖/ 查询/ 值/ 次数/ 分别/ 为/ Qi1/ 和/ Qi2/ ,/ 对于/ 一个/ 数据/ 分段/ 而言/ ,/ Ht/ 和/ Qi2Mi1/ 相对/ 于/ Qt/ ∑/ k/ 阳性率/ 变化/ 如式/ (/ 6/ )/ 所示/ ./ 其中/ ∑/ k/ 前/ 可信/ 数据库/ 加密/ 数据/ 分段/ 结构/ 和/ 用户/ 查询/ 分布/ 决定/ 并/ 不能/ 改变/ ./ 当/ 查询/ 操作符/ 为/ 小于/ 操作/ 时/ ,/ 可以/ 得到/ 类似/ 的/ 假/ 阳性率/ 变化/ 情况/ ./ Δ/ P/ =/ Qi1Mi2/ ∑/ k/ ∑/ k/ ≈/ Qi1Mi2/ +/ Qi2Mi1M/ (/ )/ j/ ∑/ kt/ =/ 1/ 通过/ 上述/ 分析/ 可以/ 发现/ ,/ 与/ 前述/ attribute/ =/ value/ 类型/ 用户/ 查询/ 相同/ ,/ Qi1Mi2/ +/ Qi2Mi1/ 也/ 可以/ 作为/ attributeopvalue/ (/ op/ 为/ 比较/ 操作符/ )/ 类型/ 用户/ 查询/ 的/ 加密/ 数据/ 分段/ 优化/ 判定/ 条件/ ./ 因此/ AEI/ 同样/ 可以/ 基于/ 图/ 2/ 的/ AEI/ 数据结构/ 和/ 算法/ 1/ 、/ 2/ 实现/ attributeopvalue/ 类型/ 用户/ 查询/ 的/ 优化/ ,/ 本文/ 不进/ t/ =/ 1t/ =/ 1/ 行累述/ ./ 3.2/ ./ 2attributeopattribute/ 查询/ 针对/ 加密/ 属性/ 的/ attributeopattribute/ 表/ 连接/ 查询/ ,/ 为了/ 获得/ 全部/ 查询/ 结果/ ,/ 需要/ 将/ 所有/ 可能/ 的/ 密文/ 分组/ 连接/ 集合/ 返回/ 给/ 客户端/ 进行/ 解密/ 过滤/ ./ 例如/ :/ 在/ 图/ 3/ 所示/ 可信/ 数据库/ 表/ A/ 和表/ B/ 的/ salary/ 属性/ 密文/ 分段/ 中/ ,/ 当/ 用户/ 发起/ A/ ./ salary/ =/ B/ ./ salary/ 查询/ ,/ 可信/ 数据库/ 需要/ 把/ 所有/ 可能/ 的/ 加密/ 数据/ 分段/ 组合/ 返回/ 给/ 客户端/ 进行/ 解密/ 过滤/ ,/ 包括/ (/ (/ 0K/ ,/ 20K/ )/ ,/ (/ 0K/ ,/ 15K/ )/ )/ ,/ (/ (/ 0K/ ,/ 20K/ )/ ,/ (/ 15K/ ,/ 30K/ )/ )/ ,/ (/ (/ 20K/ ,/ 40K/ )/ ,/ (/ 15K/ ,/ 30K/ )/ )/ …/ ,/ 因此/ 针对/ attributeopattribute/ 类型/ 查询/ ,/ 可信/ 客户端/ 需要/ 解密/ 过滤/ 的/ 密文/ 数据/ 元组/ 数量/ 是/ 非常/ 大/ 的/ ./ 图/ 3/ 可信/ 数据库/ attributeopattribute/ 密文/ 分段/ 论文/ 采用/ 一种/ 两级/ 索引/ 方法/ 来/ 优化/ attributeopattribute/ 查询/ ./ 为/ 降低/ 管理/ 代价/ ,/ AEI/ 只/ 在/ 有/ 查询/ 需求/ 的/ 属性/ 对/ 之间/ 构建/ 查询/ 索引/ ./ 首先/ 分析/ 两个/ 属性/ 值域/ 之间/ 的/ 关系/ ,/ 图/ 4/ 将/ 两个/ 属性/ 的/ 值域/ 分成/ 相/ 离/ 、/ 相交/ 、/ 包含/ 和/ 重叠/ 4/ 种/ 相对/ 关系/ ./ 如图/ 4/ 可/ 将/ 两个/ 待/ 比较/ 属性/ 的/ 值域/ Rangea/ (/ Lowera/ ,/ Uppera/ )/ 和/ Rangeb/ (/ Lowerb/ ,/ Up/ -/ perb/ )/ 分为/ 5/ 个子/ 区域/ :/ (/ 1/ )/ Seta/ </ b/ =/ (/ Lowera/ ,/ min/ (/ Uppera/ ,/ Lowerb/ )/ )/ ;/ (/ 2/ )/ Seta/ =/ b/ =/ (/ max/ (/ Lowera/ ,/ Lowerb/ )/ ,/ (/ 3/ )/ Seta/ >/ b/ =/ (/ max/ (/ Lowera/ ,/ Upperb/ )/ ,/ Uppera/ )/ ;/ (/ 4/ )/ Setb/ </ a/ =/ (/ Lowerb/ ,/ min/ (/ Lowera/ ,/ Upperb/ )/ )/ ;/ (/ 5/ )/ Setb/ >/ a/ =/ (/ max/ (/ Lowerb/ ,/ Uppera/ )/ ,/ Upperb/ )/ ./ 两个/ 待/ 比较/ 的/ 密文/ 属性/ 不/ 可能/ 同时/ 具有/ 上述/ 5/ 个子/ 集合/ ,/ 如图/ 4/ (/ a/ )/ 相/ 离/ 关系/ 就/ 只有/ Seta/ </ b/ 和/ Seta/ >/ b/ 两个/ 子集合/ ,/ 其它/ 子集合/ 为/ 空集/ ./ 针对/ 一个/ attributeopattribute/ 查询/ ,/ 除/ Seta/ =/ bPage7/ 集合/ 外/ ,/ 其它/ 子集合/ 对于/ 任一/ 查询/ 都/ 是/ 确定/ 的/ (/ 全部/ 是/ 正确/ 结果/ ,/ 或/ 全部/ 不是/ )/ ,/ 如/ 针对/ a/ </ b/ 的/ 查询/ ,/ Seta/ </ b/ 和/ Setb/ >/ a/ 中/ 的/ 密文/ 元组/ 就/ 全是/ 正确/ 匹配/ 的/ ,/ 而/ Setb/ </ a/ 和/ Seta/ >/ b/ 则/ 肯定/ 不/ 可能/ 匹配/ ./ AEI/ 设计图/ 5/ 所示/ 两级/ 自/ 适应/ 密文/ 分段/ 索引/ 来/ 解决/ 这/ 类/ 查询/ ./ 在/ 两级/ 索引/ 中/ ,/ 第/ 1/ 级/ 记录/ 了/ 密文/ 属性/ 值/ 所属/ 值域/ 子集/ ,/ 由于/ 属性/ 值域/ 相对/ 固定/ ,/ 第/ 1/ 级/ 索引/ 是/ 一个/ 静态/ 索引/ ,/ 针对/ 任何/ 表/ 连接/ 查询/ ,/ 第/ 1/ 级/ 索引/ 可以/ 解决/ 除/ Seta/ =/ b/ 子集/ 外/ 的/ 所有/ 数据/ 查询/ ,/ 而且/ 不会/ 产生/ 不必要/ 的/ 解密/ 操作/ ,/ 下面/ 研究/ 如何/ 利用/ 第/ 2/ 级/ 索引/ 来/ 优化/ Seta/ =/ b/ 区域/ 的/ 查询/ 性能/ ./ (/ 1/ )/ attribute/ =/ attribute/ 查询/ 针对/ table1/ ./ A/ =/ table2/ ./ B/ 查询/ 操作/ ,/ 在/ Seta/ =/ b/ 区间/ 上/ ,/ 设/ 密文/ 属性/ A/ 划分/ 的/ 密文/ 数据/ 分段/ 为/ A/ ./ Range1/ ,/ …/ ,/ A/ ./ Rangek/ 共/ k/ 段/ ,/ 每/ 段/ 含有/ 密文/ 元组/ A/ ./ Mi/ 条/ ,/ 属性/ B/ 划分/ 为/ B/ ./ Range1/ ,/ …/ ,/ B/ ./ Rangel/ 共/ l/ 段/ ,/ 每/ 段/ 包含/ 密文/ 元组/ B/ ./ Mi/ 条/ ,/ 正确/ 匹配/ 元组/ 数为/ H/ ,/ 则/ Seta/ =/ b/ 区间/ 产生/ 的/ 假/ 阳性率/ 如式/ (/ 7/ )/ 所示/ ./ P/ =/ 1/ -/ 其中/ ∑/ A/ ./ Mi/ ∩/ B/ ./ Mj/ ≠/ / 于/ 等于/ A/ ./ Mi/ 和/ B/ ./ Mi/ 的/ 覆盖/ 区域/ ,/ 因此/ 在/ 其它/ 条件/ 相同/ 时/ ,/ 在/ Seta/ =/ b/ 区间/ 上/ ,/ 保证/ 两/ 属性/ 的/ 二级/ 索引/ 具有/ 相同/ 的/ 密文/ 数据/ 分段/ 划分/ ,/ 如图/ 5/ (/ g/ )/ 、/ (/ h/ )/ 每个/ 密文/ 分段/ 覆盖/ 区间/ 相同/ ,/ 可以/ 获得/ 更好/ 的/ 查询/ 性能/ ,/ 此时/ 假/ 阳性率/ 为/ P/ =/ 1/ -/ H/ ∑/ k/ (/ A/ ./ Mj1/ ×/ B/ ./ Mj2/ +/ A/ ./ Mj2/ ×/ B/ ./ Mj1/ )/ H/ 由式/ (/ 8/ )/ 可知/ 选择/ 划分/ 后/ A/ ./ Mj1/ ×/ B/ ./ Mj2/ +/ A/ ./ Mj2/ ×/ B/ ./ Mj1/ 最大/ 的/ 密文/ 分段/ 对/ 可以/ 获得/ 更好/ 的/ 假/ 阳性率/ 优化/ 效果/ ,/ 令/ A/ ./ Mj1/ =/ α/ A/ ./ Mj/ ,/ B/ ./ Mj1/ =/ β/ B/ ./ Mj/ ,/ 则/ A/ ./ Mj2/ =/ (/ 1/ -/ α/ )/ A/ ./ Mj/ ,/ B/ ./ Mj2/ =/ (/ 1/ -/ β/ )/ B/ ./ Mj/ ,/ 所以/ A/ ./ Mj1/ ×/ B/ ./ Mj2/ +/ A/ ./ Mj2/ ×/ B/ ./ Mj1/ =/ (/ α/ +/ β/ -/ 2/ α/ β/ )/ A/ ./ Mj/ ×/ B/ ./ Mj/ ~/ A/ ./ Mj/ ×/ B/ ./ Mj/ ,/ 因此/ 设/ 二级/ 索引/ 当前/ 密文/ 分段/ 数为/ k/ ,/ 在/ 二级/ 索引/ 最大/ 分段/ 数/ K/ 限定/ 条件/ 下/ ,/ AEI/ 优先选择/ α/ k/ (/ 0/ </ α/ </ 1/ )/ 组/ A/ ./ Mj/ ×/ B/ ./ Mj/ 最大/ 的/ 密文/ 数据/ 分段/ 对/ 作为/ 优化/ 划分/ 目标/ 可以/ 获得/ 更大/ 的/ 优化/ 效果/ ./ 最坏/ 情况/ 下/ ,/ 密文/ 分段/ 对/ 选择/ 算法/ 需要/ 选/ idNamesalary012Tom75K013Mary60K014John50K015Jerry65K/ (/ a/ )/ 表/ A/ 原始数据/ etupleLevel/ _/ 1Level/ _/ 21110/ …/ Seta/ >/ b0010/ …/ Seta/ =/ b181011/ …/ Seta/ =/ b140111/ …/ Seta/ =/ b19/ (/ e/ )/ A/ ./ salary/ 两级/ 加密/ 数据/ 分段/ (/ f/ )/ B/ ./ salary/ 两级/ 加密/ 数据/ 分段/ 图/ 5/ 针对/ attributeopattribute/ 的/ 两级/ 自/ 适应/ 密文/ 索引/ 下面/ 分析/ 选择/ 划分/ 两个/ 属性/ 的/ 哪/ 一对/ 密文/ 数据/ 分段/ 对/ 可以/ 获得/ 最好/ 的/ 优化/ 效果/ ./ 假设/ 同时/ 对/ 两个/ 属性/ 的/ 第/ j/ 个/ 密文/ 数据/ 分段进行/ 划分/ ,/ 划分/ 后/ 的/ 两个/ 属性/ 密文/ 数据/ 分段/ 仍然/ 相同/ ,/ 存储/ 密文/ 元组/ 数/ 分别/ 为/ A/ ./ Mj1/ ,/ A/ ./ Mj2/ ,/ B/ ./ Mj1/ ,/ B/ ./ Mj2/ ,/ 其它/ 数据/ 分段/ 情况/ 相同/ ,/ 则/ 假/ 阳性率/ 变化/ 情况/ 如下/ ./ 择/ α/ ×/ k/ 个/ 密文/ 元组/ 乘积/ 最大/ 的/ 密文/ 分段/ 对/ ,/ 因此/ 最坏/ 情况/ 下/ 的/ 密文/ 分段/ 对/ 选择/ 时间/ 复杂度/ 为/ O/ (/ α/ ×/ k/ )/ ./ 服务器端/ 优化/ 分段/ 对/ 选择/ 算法/ 类似/ 算法/ 1/ ,/ 这里/ 不再/ 描述/ ,/ 这时/ 的/ 合并/ 代价/ Joincost/ 是/ 两/ 密文/ 属性/ 密文/ 分段/ 对/ 与/ 右侧/ 密文/ 分段/ 对/ 合并/ 后/ 的/ 密文/ 元组/ 乘积/ ./ 由式/ (/ 8/ )/ 可知/ 这/ 类/ 查询/ 的/ 假/ 阳性率/ 与/ 用户/ 访问量/ 无关/ ,/ 因此/ 不/ 需要/ 记录/ 用户/ 访问量/ ./ 同时/ 由于/ 用户/ 需要/ 解密/ Seta/ =/ b/ 上/ 的/ 所有/ 密文/ 元组/ ,/ 为了/ 不/ 额外/ 增加/ 用户/ 解密/ 操作/ 量/ ,/ AEI/ 算法/ 由/ 查询/ attribute/ =/ Page8attribute/ 的/ 第一个/ 可信/ 用户端/ 在/ 解密/ 过滤/ 基础/ 上/ 完成/ 所有/ 密文/ 分段/ 的/ 划分/ 工作/ ,/ 分段/ 优化/ 算法/ 如/ 算法/ 3/ ./ 算法/ 3/ ./ attributeA/ =/ attributeB/ 二级/ 索引/ 分段/ 优化/ 算法/ ./ 参数/ :/ r/ ,/ 最小/ 元组/ 数/ ;/ list/ _/ buckets/ ,/ 待/ 划分/ 密文/ 分段/ 对/ ;/ 服务器端/ :/ 1/ ./ if/ (/ 客户端/ client/ 第一次/ 查询/ attributeA/ =/ attributeB/ )/ 2/ ./ 服务器端/ 向/ client/ 发起/ 划分/ list/ _/ buckets/ 请求/ ;/ 3/ ./ while/ (/ 收到/ 返回/ 划分/ 信息/ list/ _/ info/ )/ {/ 4/ ./ while/ (/ buckets/ =/ list/ _/ info/ ./ next/ (/ )/ !/ =/ null/ )/ {/ 5/ ./ if/ (/ buckets/ 可以/ 进行/ 划分/ )/ 6/ ./ 修改/ 两个/ 属性/ 的/ 密文/ 数据/ 分段/ 信息/ ;/ }/ }/ 客户端/ :/ 1/ ./ if/ (/ 客户端/ 收到/ 划分/ 请求/ )/ {/ 2/ ./ while/ (/ buckets/ (/ A/ ,/ B/ )/ =/ list/ _/ buckets/ ./ next/ (/ )/ !/ =/ null/ )/ {/ 3/ ./ for/ (/ inti/ =/ A/ ./ Min/ ,/ temp/ =/ 0/ ;/ i/ </ =/ A/ ./ Max/ ;/ i/ ++/ )/ {/ 4/ ./ 以/ i/ 作为/ 分界点/ 试/ 划分/ ;/ 5/ ./ if/ (/ A1/ ./ size/ </ rorA2/ ./ size/ </ rorB1/ ./ size/ </ ror6/ ./ continue/ ;/ // // 不/ 满足/ 最小/ 元组/ 数/ 条件/ 7/ ./ }/ elseif/ (/ A1/ ./ size/ ×/ B2/ ./ size/ +/ A2/ ./ size/ ×/ B1/ ./ size/ >/ 8/ ./ temp/ =/ A1/ ./ size/ ×/ B2/ ./ size/ +/ A2/ ./ size/ ×/ B1/ ./ size/ (/ )/ ;/ 9/ ./ divide/ _/ point/ =/ i/ ;/ }/ }/ 10/ ./ if/ (/ divide/ _/ point/ =/ =/ 0/ )/ {/ 11/ ./ list/ _/ info/ ./ add/ (/ 该/ 密文/ 分段/ 对/ 不能/ 进行/ 划分/ )/ ;/ }/ 12/ ./ else/ {/ 13/ ./ list/ _/ info/ ./ add/ (/ 密文/ 分段/ 对/ 划分/ 信息/ )/ ;/ }/ 14/ ./ }/ Returnlist/ _/ info/ ;/ }/ 如/ 算法/ 3/ 所示/ ,/ 客户端/ 需要/ 对/ 所有/ 待/ 划分/ 密文/ 分段/ 对/ 进行/ 处理/ ,/ 设/ Seta/ =/ b/ 区间/ 跨度/ 之/ 和/ 为/ ∑/ Range/ ,/ 则/ 客户端/ 的/ 时间/ 复杂度/ 为/ O/ ∑/ Rang/ (/ )/ e/ ./ 而/ 服务器端/ 需要/ 对/ 返回/ 的/ 调整/ 密文/ 分段/ 对/ 元组/ 进行/ 分段/ 调整/ ,/ 设待/ 划分/ 密文/ 分段/ 对/ 的/ 元组/ 总数/ 为/ ∑/ Size/ ,/ 则/ 在/ 调整/ 密文/ 分段/ 对时/ 服务器端/ 的/ 时间/ 复杂度/ 为/ O/ ∑/ (/ )/ Size/ ./ 设两/ 属性/ 密文/ 元组/ 规模/ 为/ Size1/ 和/ Size2/ ,/ 在/ Seta/ =/ b/ 子集/ 上/ 的/ 二级/ 密文/ 分段/ 都/ 为/ k/ ,/ 为了/ 实现/ 二级/ AEI/ 索引/ 结构/ ,/ 服务器端/ 首先/ 需要/ 存储/ O/ (/ Size1/ +/ Size2/ )/ 的/ 两级/ 加密/ 数据/ 分段/ 信息/ ,/ 如图/ 5/ (/ e/ )/ 、/ (/ f/ )/ ,/ 同时/ 需要/ 存储/ 2k/ 的/ 二级/ 索引/ 信息/ ,/ 如图/ 5/ (/ g/ )/ 、/ (/ h/ )/ ,/ 因此/ 整个/ 服务器/ 的/ 存储/ 开销/ 为/ O/ (/ Size1/ +/ Size2/ +/ 2k/ )/ ./ (/ 2/ )/ op/ 为/ 比较/ 操作符/ 的/ attributeopattribute/ 查询/ 操作/ 对于/ table1/ ./ Aoptable2/ ./ B/ (/ op/ 为/ “/ >/ ”/ ,/ “/ </ ”/ ,/ “/ / ”/ 或/ “/ / ”/ )/ 查询/ ,/ 也/ 只会/ 在/ Seta/ =/ b/ 区间/ 上/ 产生/ 不/ 匹配/ 返回/ 结果/ ,/ 本节/ 只/ 分析/ Seta/ =/ b/ 区间/ 带来/ 的/ 假/ 阳性率/ ,/ 且/ 保持/ 两/ 属性/ 在/ 二级/ 索引/ 上/ 具有/ 一致/ 的/ 密文/ 分段/ 划分/ ,/ 以/ 减少/ 数据/ 分段/ 交叉/ 覆盖/ 引起/ 的/ 大量/ 解密/ 操作/ ./ 设/ 属性/ A/ ,/ B/ 在/ Seta/ =/ b/ 区间/ 上/ 都/ 被/ 分成/ 相同/ 的/ k/ 段/ ,/ 包含/ 密文/ 元组/ 数/ 分别/ 为/ A/ ./ Mi/ 和/ B/ ./ Mi/ ./ 大于/ 和/ 小于/ 比较/ 操作/ 的/ 假/ 阳性率/ 情况/ 并不相同/ ,/ 下面/ 首先/ 研究/ table1/ ./ A/ </ table2/ ./ B/ 的/ 查询/ ,/ 设/ Seta/ =/ b/ 区间/ 上/ 满足条件/ 的/ 密文/ 元组/ 共/ H/ 条/ ,/ 则/ 假/ 阳性率/ 如下/ 所示/ ./ 设/ 同时/ 对/ A/ ,/ B/ 二级/ 索引/ 中/ 的/ 第/ i/ 个/ 密文/ 数据/ 分段进行/ 重新/ 划分/ ,/ 分割/ 后/ 新/ 密文/ 数据/ 分段/ 元组/ 数/ 分别/ 为/ A/ ./ Mi1/ ,/ A/ ./ Mi2/ 和/ B/ ./ Mi1/ ,/ B/ ./ Mi2/ ,/ 则/ 假/ 阳性率/ 优化/ 情况/ 如下/ 所示/ ./ Δ/ P/ </ =/ 由式/ (/ 10/ )/ 可知/ ,/ 选择/ A/ ./ Mi2/ ×/ B/ ./ Mi1/ 最大/ 的/ 密文/ 数据/ 分段进行/ 划分/ 可以/ 获得/ 更好/ 的/ 优化/ 效果/ ,/ 同理/ 当/ 比较/ 操作符/ 为/ 大于/ 时/ ,/ Δ/ P/ >/ 优化/ 选择/ 条件/ 为/ A/ ./ Mi1/ ×/ B/ ./ Mi2/ ./ 考虑/ 到/ A/ ./ Mi1/ ,/ A/ ./ Mi2/ ~/ A/ ./ Mi/ ,/ B/ ./ Mi1/ ,/ B/ ./ Mi2/ ~/ B/ ./ Mi/ ,/ 则/ 有/ Δ/ P/ </ ,/ Δ/ P/ >/ ~/ A/ ./ Mi/ ×/ B/ ./ Mi/ ,/ 因此/ 服务器/ 总是/ 优先选择/ 不/ 超过/ α/ ×/ k/ 组/ A/ ./ Mi/ ×/ B/ ./ Mi/ 最大/ 的/ 密文/ 数据/ 分段/ 对/ 作为/ 优化/ 目标/ ,/ 优化/ 目标/ 选择/ 算法/ 同样/ 类似/ 算法/ 1/ ,/ 服务器端/ 的/ 时间/ 复杂度/ 为/ O/ (/ α/ ×/ k/ )/ ./ 由于/ 大于/ 和/ 小于/ 比较/ 操作/ 的/ 优化/ 判定/ 条件/ 并不相同/ ,/ 因此/ 为了/ 更好/ 的/ 反映/ 查询/ 服务/ 特性/ ,/ 服务器端/ 记录/ 采样/ 周期/ interval/ 内/ 的/ 大于/ 、/ 小于/ 比较/ 查询/ 比例/ ,/ 设/ 分别/ 为/ Prop/ >/ 和/ Prop/ </ (/ Prop/ >/ +/ Prop/ </ =/ 1/ )/ ,/ 客户端/ 在/ 划分/ 密文/ 分段/ 对时/ 选择/ Prop/ >/ ×/ (/ A/ ./ Mi1/ ×/ B/ ./ Mi2/ )/ +/ Prop/ </ ×/ (/ A/ ./ Mi2/ ×/ B/ ./ Mi1/ )/ 最大/ 点/ 作为/ 新/ 的/ 密文/ 数据/ 分段/ 划分/ 点/ ,/ 二级/ 索引/ 分段/ 优化/ 策略/ 类似/ 算法/ 3/ ,/ 时间/ 和/ 空间/ 复杂度/ 也/ 相同/ ,/ 本/ 节/ 不再/ 累述/ ./ 4/ 性能/ 测试/ 及/ 结果/ 分析/ 4.1/ 实验/ 设置/ 论文/ 采用/ JAVA/ 基于/ Totem/ 数据库/ 实现/ 了/ 面向/ Page9/ 服务/ 的/ 加密/ 数据/ 查询方法/ AEI/ ,/ 将/ AEI/ 方法/ 与/ equi/ -/ depth/ 、/ equi/ -/ width/ [/ 9/ ]/ 、/ QOB/ [/ 11/ ]/ 和/ STBucket/ [/ 12/ ]/ 等/ 加密/ 数据/ 密文/ 分段/ 查询/ 算法/ 进行/ 对比/ ,/ 比较/ 相同/ 实验/ 环境/ 下/ 的/ 查询/ 总假/ 阳性率/ 性能/ ./ 模拟实验/ 在/ 一台/ 双核/ 2.1/ GHz/ ,/ 内存/ 2GB/ 的/ PC机/ 上/ 进行/ ./ 实验/ 中/ AEI/ 算法/ 通过/ 承载/ 用户/ 查询/ 达到/ 一定/ 密文/ 数据/ 分段/ 数后/ 进行/ 查询/ 结果/ 统计/ ,/ 统计/ 各种/ 算法/ 承载/ 10000/ 条/ 用户/ 查询/ 请求/ 的/ 总假/ 阳性率/ ,/ 其它/ 实验/ 设置/ 见表/ 1/ ./ rAEI/ 密文/ 数据/ 分段/ 的/ 最小/ 元组/ 数/ 3interval0AEI/ 采用/ 的/ 初始/ 时间/ 间隔/ α/ 划分/ 密文/ 分段/ 比例图/ 6/ 查询/ 值/ 均匀分布/ 的/ attribute/ =/ value/ 查询/ 假/ 阳性率/ 实验/ 从/ 实验/ 数据/ 可以/ 发现/ ,/ 由于/ AEI/ 和/ STBucket/ 对于/ attribute/ =/ value/ 查询/ 密文/ 数据/ 分段/ 划分/ 策略/ 一致/ ,/ 因此/ 两者/ 的/ 查询/ 假/ 阳性率/ 性能/ 并/ 没有/ 区别/ ./ 而/ 与/ 其它/ 几种/ 密文/ 查询方法/ 比较/ ,/ 当/ 查询/ 值/ 服从/ 均匀分布/ 时/ ,/ 若/ 不/ 考虑/ 数据分布/ (/ 都/ 服从/ 均匀分布/ )/ ,/ 如图/ 6/ (/ a/ )/ ,/ 各种/ 密文/ 分段/ 查询方法/ 的/ 查询/ 效率/ 相当/ ./ 而/ 当/ 数据分布/ 状况/ 发生变化/ 时/ ,/ 如图/ 6/ (/ b/ )/ 、/ (/ c/ )/ ,/ AEI/ 密文/ 数据/ 分段/ 方法/ 具有/ 更好/ 的/ 查询/ 性能/ ,/ 且/ 随着/ 数据/ 分段/ 数/ 的/ 增加/ ,/ AEI/ 能/ 更好/ 地/ 适应/ 用户/ 查询/ 和/ 数据分布/ 变化/ ,/ 获得/ 更好/ 的/ 查询/ 性能/ ./ 从/ 实验/ 结果/ 看/ ,/ 实验/ 数据/ 集/ 服从/ N/ (/ 0/ ,/ 1002/ )/ 分布/ 时/ ,/ 在/ 密文/ 数据/ 模拟实验/ 采用/ 3/ 种/ 不同/ 测试数据/ 集/ :/ (/ 1/ )/ 值域/ [/ 1/ ,/ 10000/ ]/ 服从/ U/ (/ 1/ ,/ 10000/ )/ 均匀分布/ 规模/ 10000/ 的/ 整数/ 数据/ 集/ ;/ (/ 2/ )/ 值域/ [/ -/ ,/ +/ ]/ 上/ 服从/ N/ (/ 0/ ,/ 1002/ )/ 正态分布/ 取整/ 后/ 规模/ 10000/ 的/ 数据/ 集/ ;/ (/ 3/ )/ UCI/ 的/ 个人信用/ 数据/ 集/ ①/ 中/ 的/ 信用/ 保证金/ 真实/ 数据/ ./ 4.2/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ =/ 狏/ 犪/ 犾/ 狌/ 犲/ 类型/ 查询/ 实验/ 模拟实验/ 设计/ 不同/ 查询/ 测试/ 集对/ 各种/ 密文/ 数据/ 查询/ 算法/ 进行/ 测试/ ,/ 分别/ 是/ :/ (/ 1/ )/ 查询/ 值/ 服从/ 属性/ 值域/ 范围/ 内/ 随机/ 均匀分布/ 的/ 用户/ 查询/ ;/ (/ 2/ )/ 考虑/ 到/ 用户/ 查询/ 都/ 应落/ 在/ 属性/ 值域/ 范围/ 内/ ,/ 针对/ (/ 1/ )/ 、/ (/ 2/ )/ 两种/ 数据源/ ,/ 设计/ 查询/ 值/ 服从/ N/ (/ 50/ ,/ 1002/ )/ 正态分布/ 查询/ ;/ 针对/ UCI/ 数据源/ 设计/ 查询/ 值/ 服从/ N/ (/ 5000/ ,/ 1002/ )/ 正态分布/ 的/ 用户/ 查询/ ,/ 实验/ 结果/ 如图/ 6/ 、/ 图/ 7/ 所示/ ./ 分段/ 数/ 500/ 情况/ 下/ ,/ AEI/ 的/ 查询/ 假/ 阳性率/ 约/ 为/ equi/ -/ depth/ 和/ equi/ -/ width/ 的/ 10/ %/ ,/ QOB/ 方法/ 的/ 60/ %/ ./ 对于/ UCI/ 数据/ 集/ 而言/ ,/ 当/ 数据/ 分段/ 较/ 少时/ ,/ 各种/ 方法/ 的/ 查询/ 假/ 阳性率/ 并/ 没有/ 太/ 大/ 区别/ ,/ 随着/ 密文/ 分段/ 数/ 的/ 增加/ ,/ AEI/ 方法/ 优化/ 假/ 阳性率/ 效果/ 更为/ 明显/ ,/ 在/ 分段/ 数为/ 500/ 时/ ,/ AEI/ 的/ 查询/ 假/ 阳性率/ 只有/ 其它/ 方法/ 的/ 约/ 5/ %/ ./ 在/ 图/ 7/ (/ a/ )/ 中/ ,/ 即使/ 数据/ 仍然/ 服从/ 均匀分布/ ,/ 当/ 用户/ 查询/ 不/ 均匀/ 时/ ,/ AEI/ 算法/ 可以/ 更好/ 地/ 适应/ 用户/ ①/ Statlog/ (/ GermanCreditData/ )/ DataSet/ ./ http/ :/ // // archive/ ./ ics/ ./ uci/ ./ edu/ // ml/ // datasets/ ./ htmlPage10/ 图/ 7/ 查询/ 值/ 正态分布/ 的/ attribute/ =/ value/ 查询/ 假/ 阳性率/ 实验/ 查询/ 的/ 变化/ ,/ 其/ 查询/ 假/ 阳性率/ 约/ 只有/ 其它/ 3/ 种/ 方法/ 的/ 60/ %/ ./ 当/ 用户/ 查询/ 不/ 服从/ 均匀分布/ 时/ ,/ 图/ 7/ (/ b/ )/ 与/ 图/ 6/ (/ b/ )/ 相比/ AEI/ 方法/ 的/ 假/ 阳性率/ 性能/ 优势/ 更加/ 明显/ ,/ 更能/ 适应/ 用户/ 查询/ 的/ 变化/ ./ 在/ 图/ 7/ (/ c/ )/ UCI/ 数据/ 环境/ 下/ ,/ AEI/ 查询方法/ 也/ 具有/ 更好/ 的/ 查询/ 效率/ ,/ 但/ 随着/ 密文/ 数据/ 分段/ 的/ 增加/ ,/ 假/ 阳性率/ 比值/ 会/ 上升/ ,/ 深入分析/ 发现/ 其/ 原因/ 是/ 由于/ UCI/ 测试/ 集/ 数据/ 规模较/ 小/ ,/ 随着/ 密文/ 数据/ 分段/ 的/ 增加/ ,/ 密文/ 分段/ 包含/ 的/ 密文/ 元组/ 数/ 很少/ ,/ 从而/ 使/ 各种/ 查询方法/ 的/ 假/ 阳性率/ 都/ 较/ 低/ ,/ 但/ AEI/ 方法/ 仍然/ 具有/ 最高/ 的/ 查询/ 效率/ ./ 4.3/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ 狅/ 狆/ 狏/ 犪/ 犾/ 狌/ 犲/ 类型/ 查询/ 实验/ 采用/ 4.2/ 节中/ 的/ 测试/ 查询/ 值/ 分布/ 集合/ 进行/ 模拟实验/ ,/ 模拟实验/ 过程/ 中/ 保持/ 各种/ 比较/ 操作符/ (/ “/ >/ ”/ ,/ “/ </ ”/ ,/ “/ / ”/ 和/ “/ / ”/ )/ 所/ 占/ 比例/ 大致/ 相等/ ,/ 统计/ 各种/ 算法/ 的/ 假/ 阳性率/ 比值/ ,/ 实验/ 结果/ 如图/ 8/ 、/ 图/ 9/ 所示/ ./ 与/ attribute/ =/ value/ 查询/ 类似/ ,/ 在/ attributeopvalue/ 类型/ 查询/ 中/ AEI/ 和/ STBucket/ 也/ 具有/ 相同/ 的/ 查询/ 假/ 阳性率/ 性能/ ./ 图/ 8/ 中/ 的/ 实验/ 结果显示/ ,/ 当/ 数据/ 和/ 用户/ 查询/ 分布/ 都/ 服从/ 均匀分布/ 时/ ,/ 各种/ 查询方法/ 的/ 假/ 阳性率/ 大致/ 相当/ ./ 当/ 数据/ 集/ 服从/ 正态分布/ 时/ ,/ AEI/ 算法/ 的/ 假/ 阳性率/ 约/ 为/ QOB/ 的/ 80/ %/ ,/ 相对/ 于/ equi/ -/ width/ 和/ equi/ -/ depth/ 方法/ 假/ 阳性率/ 优化/ 效果/ 随/ 密文/ 分段/ 数/ 的/ 增加/ 更加/ 明显/ ,/ 当/ 密文/ 分段/ 足够/ 多时/ 可以/ 节省/ 约/ 90/ %/ 以上/ 的/ 无效/ 解密/ 操作/ ./ 在/ UCI/ 数据/ 集/ 环境/ 下/ ,/ AEI/ 方法/ 的/ 查询/ 假/ 阳性率/ 分别/ 只有/ equi/ -/ width/ 、/ equi/ -/ depth/ 和/ QOB/ 方法/ 的/ 约/ 80/ %/ ,/ 30/ %/ 和/ 45/ %/ ./ 当/ 用户/ 查询/ 值/ 服从/ 正态分布/ 时/ ,/ 与/ 图/ 8/ (/ a/ )/ 实验/ 结果/ 数据/ 相比/ ,/ 图/ 9/ (/ a/ )/ 表明/ AEI/ 方法/ 具有/ 更好/ 的/ 用户/ 查询/ 适应性/ ,/ 其/ 查询/ 假/ 阳性率/ 明显/ 小于/ 其它/ 3/ 种/ 对比/ 方法/ ,/ 当/ 数据/ 和/ 用户/ 查询/ 值/ 都/ 服从/ 正态分布/ 时/ ,/ AEI/ 方法/ 的/ 查询/ 假/ 阳性率/ 只有/ equi/ -/ width/ 、/ equi/ -/ depth/ 和/ QOB/ 方法/ 的/ 约/ 20/ %/ 、/ 40/ %/ 和/ 60/ %/ ./ 在/ UCI/ 数据/ 集/ 环境/ 下/ AEI/ 方法/ 的/ 查询/ 假/ 阳性率/ 分别/ 只有/ 其它/ 3/ 种/ 方法/ 的/ 约/ 35/ %/ 、/ 30/ %/ 和/ 45/ %/ ./ 4.4/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ =/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ 类型/ 查询/ 实验/ AEI/ 方法/ 中/ 利用/ 两级/ 索引/ 结构/ 优化/ 密文/ 属性/ 之间/ 的/ 查询/ 操作/ ,/ 本/ 节/ 设计/ 模拟实验/ 对/ 密文/ 属性/ 间/ 的/ attribute/ =/ attribute/ 查询/ 假/ 阳性率/ 性能/ 进行/ 评估/ ,/ 实验/ 结果/ 如图/ 10/ 所示/ ./ 当/ 相同/ 密文/ 数据/ 属性/ 之间/ 进行/ 等值/ 连接/ 查询/ 时/ ,/ 若/ 两个/ 密文/ 属性/ 列/ 数据/ 都/ 服从/ 均匀分布/ (/ 图/ 10/ (/ a/ )/ )/ ,/ AEI/ 与/ equi/ -/ width/ 、/ equi/ -/ depth/ 和/ QOB/ 的/ 查询/ 效率/ 大致/ 相当/ ,/ 而/ STBucket/ 在/ 动态/ 划分/ 密文/ 数据/ 分段/ 时/ 产生/ 了/ 大量/ 的/ 分段/ 值域/ 的/ 重叠/ ,/ 导致/ 针对/ attribute/ =/ attribute/ 的/ 连接/ 查询/ 操作/ 代价/ 大大增加/ ./ 而/ 当/ 属性数据/ 不/ 服从/ 均匀分布/ 时/ (/ 图/ 10/ (/ b/ )/ ~/ (/ c/ )/ )/ ,/ AEI/ 方法/ 显示/ 出/ 更好/ 的/ 适应性/ ,/ 其/ 查询/ 假/ 阳性率/ 也/ 明显/ 优于/ 其它/ 4/ 种/ 比较/ 方法/ ./ Page11/ 图/ 8/ 查询/ 值/ 均匀分布/ 的/ attributeopvalue/ 查询/ 假/ 阳性率/ 实验/ 图/ 9/ 查询/ 值/ 正态分布/ 的/ attributeopvalue/ 查询/ 假/ 阳性率/ 实验/ 当/ 两个/ 不同/ 密文/ 属性/ 进行/ 等值/ 查询/ 时/ (/ 图/ 10/ (/ d/ )/ ~/ (/ f/ )/ )/ ,/ 其它/ 查询方法/ 两个/ 密文/ 属性/ 的/ 数据/ 分段/ 划分/ 都/ 不/ 相同/ ,/ 存在/ 大量/ 的/ 密文/ 数据/ 段/ 交集/ ,/ 使得/ 查询/ 假/ 阳性率/ 大大/ 上升/ ,/ 而/ AEI/ 采用/ 了/ 两级/ 自/ 适应/ 索引/ 方法/ ,/ 很/ 好地解决/ 了/ 密文/ 数据分布/ 和/ 数据/ 段/ 划分/ 带来/ 的/ 影响/ ,/ 其/ 查询/ 假/ 阳性率/ 性能/ 获得/ 了/ 极大/ 的/ 提高/ ,/ 平均/ 假/ 阳性率/ 只有/ 其它/ 方法/ 在/ 相同/ 情况/ 下/ 的/ 不到/ 50/ %/ ./ Page12/ 图/ 10attribute/ =/ attribute/ 查询/ 假/ 阳性率/ 实验/ 4.5/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ 狅/ 狆/ 犪/ 狋/ 狋/ 狉/ 犻/ 犫/ 狌/ 狋/ 犲/ 类型/ 查询/ 实验/ 本/ 节/ 模拟实验/ 对/ 密文/ 属性/ 之间/ 的/ attributeopattribute/ (/ op/ 为/ 比较/ 操作符/ )/ 查询/ 假/ 阳性率/ 性能/ 进行/ 评估/ ,/ 模拟实验/ 保持/ 各种/ 比较/ 操作符/ (/ “/ >/ ”/ ,/ “/ </ ”/ ,/ “/ / ”/ 和/ “/ / ”/ )/ 比例/ 相当/ ,/ 实验/ 结果/ 如图/ 11/ 所示/ ./ 从图/ 11/ 所示/ 实验/ 结果/ 发现/ 当/ 两/ 属性/ 相同/ 时/ ,/ 当/ 密文/ 属性/ 值/ 服从/ 均匀分布/ 时/ (/ 图/ 11/ (/ a/ )/ )/ ,/ STBucket/ 方法/ 对/ 密文/ 数据/ 分段进行/ 动态/ 调整/ ,/ 产生/ 部分/ 重叠/ 的/ 密文/ 数据/ 分段/ 对/ 使得/ 查询/ 假/ 阳性率/ 上升/ ,/ 而/ 其它/ 各种/ 密文/ 查询方法/ 的/ 效率/ 相当/ ./ 当/ 密文/ 数据分布/ 服从/ 正态分布/ 时/ (/ 图/ 11/ (/ b/ )/ )/ ,/ AEI/ 方法/ 比/ 其它/ 方法/ 假/ 阳性率/ 性能/ 更高/ ,/ 大约/ 为/ QOB/ 和/ STBucket/ 方法/ 的/ 40/ %/ ,/ equi/ -/ width/ 和/ equi/ -/ depth/ 方法/ 的/ 25/ %/ ./ UCI/ 数据/ 集/ 相对/ 较/ 小/ ,/ 密文/ 数据/ 分段/ 也/ 较/ 小/ ,/ AEI/ 方法/ 相对/ 于/ QOB/ 和/ STBucket/ 方法/ 可以/ 获得/ 约/ 30/ %/ 的/ 假/ 阳性率/ 提升/ ,/ 相对/ equi/ -/ width/ 和/ equi/ -/ depth/ 则/ 分别/ 为/ 20/ %/ 和/ 30/ %/ 的/ 性能/ 提升/ ./ 当/ 两/ 不同/ 密文/ 属性/ 进行/ 比较/ 时/ ,/ 由于/ 两/ 属性/ 的/ 值域/ 、/ 密文/ 数据/ 分段/ 的/ 划分/ 都/ 不/ 相同/ ,/ AEI/ 方法/ 显示/ 出/ 更好/ 的/ 适应性/ 和/ 更加/ 明显/ 的/ 优势/ ,/ 从图/ 11/ (/ d/ )/ ~/ (/ f/ )/ 中/ 可以/ 发现/ AEI/ 密文/ 查询方法/ 的/ 查询/ 假/ 阳性率/ 都/ 要/ 大大/ 优于/ 其它/ 几种/ 方法/ ,/ 且/ 随着/ 密文/ 分段/ 的/ 增加/ ,/ 优势/ 更为/ 明显/ ./ 5/ 结论/ 本文/ 分析/ 了/ 查询/ 类型/ 、/ 数据分布/ 和/ 用户/ 查询/ 对/ 可信/ 数据库/ 环境/ 下/ 加密/ 数据/ 查询/ 带来/ 的/ 影响/ ,/ 根据/ 加密/ 数据分布/ 和/ 用户/ 访问/ 情况/ 给出/ 了/ 一种/ 自/ 适应/ 密文/ 索引/ 结构/ ,/ 实现/ 面向/ 服务/ 的/ 加密/ 数据/ 优化/ 查询/ ./ 本/ Page13/ 图/ 11attributeopattribute/ 查询/ 假/ 阳性率/ 实验/ 文中/ 的/ AEI/ 算法/ 基于/ 可信/ 数据库/ 客户端/ 需要/ 解密/ 过滤/ 的/ 服务/ 特点/ 将/ 密文/ 分段/ 调整/ 任务/ 交给/ 可信/ 客户端/ 处理/ 既保证/ 了/ 加密/ 数据/ 的/ 安全性/ ,/ 降低/ 了/ 服务器端/ 的/ 处理/ 压力/ ,/ 而且/ 也/ 不会/ 额外/ 地/ 增加/ 客户端/ 解密/ 开销/ ./ AEI/ 采用/ 动态/ 的/ 密文/ 数据/ 分段/ 划分/ 方法/ 可以/ 解决/ 可信/ 数据库/ 数据/ 更新/ 对/ 密文/ 分段/ 带来/ 的/ 影响/ ,/ 同时/ 也/ 可以/ 实现/ 可信/ 数据库/ 的/ 表/ 连接/ 优化/ 查询/ ,/ 这是/ 目前/ 相关/ 研究/ 并/ 没有/ 很/ 好/ 解决/ 的/ ./ 基于/ 提出/ 的/ 加密/ 数据/ 查询方法/ 已经/ 实现/ 了/ 一种/ 可信/ 加密/ Web/ 电子邮件系统/ ,/ 本文/ 提出/ 的/ 方法/ 很/ 好地解决/ 了/ 加密/ 电子邮件系统/ 中/ 日期/ 型/ 数据/ 的/ 加密/ 查询/ 操作/ ./ 数据库/ 承载/ 的/ 用户/ 查询/ 类型/ 很多/ ,/ 本文/ 研究/ 了/ 两大类/ 主要/ 的/ 可信/ 数据库/ 查询/ 操作/ ,/ 但是/ 数据库/ 需要/ 提供/ 的/ 查询/ 服务/ 种类/ 很多/ ,/ 下/ 一步/ 进一步/ 深入/ 解决/ 可信/ 数据库/ 的/ 其他/ 复杂/ 查询/ 以及/ 应用/ 中/ 面临/ 的/ 各种/ 问题/ ,/ 研究/ 如何/ 实现/ 加密/ 数据/ 的/ 分组/ 、/ 排序/ 以及/ 提供/ 可信/ 数据库/ 基于/ AEI/ 方法/ 的/ 查询/ 接口/ 和/ 标准/ 语言/ ./ 

