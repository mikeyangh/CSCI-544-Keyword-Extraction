Page1/ 一种/ 基于/ 可信计算/ 的/ 分布式/ 使用/ 控制系统/ 初晓/ 博/ 1/ )/ ,/ 2/ )/ 秦宇/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 中国科学院/ 软件/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 2/ )/ (/ 信息安全/ 共性/ 技术/ 国家/ 工程/ 研究/ 中心/ 北京/ 100190/ )/ 摘要/ 随着/ 互联网络/ 等/ 分布式/ 环境/ 的/ 发展/ ,/ 如何/ 控制/ 已经/ 分发/ 的/ 数据/ 成为/ 一个/ 重要/ 的/ 安全/ 问题/ ./ 最近/ 提出/ 的/ 使用/ 控制/ 概念/ 和/ 模型/ 虽然/ 适用/ 于/ 描述/ 该类/ 问题/ ,/ 但/ 其/ 实施/ 机制/ 研究/ 仍/ 处于/ 起步/ 阶段/ ./ 文中/ 给出/ 一种/ 基于/ 可信计算/ 技术/ 的/ 分布式/ 使用/ 控制系统/ ,/ 有效/ 地/ 支持/ 和/ 实现/ 了/ 使用/ 控制/ 模型/ 的/ 3/ 个/ 特点/ :/ 丰富/ 的/ 策略决策/ 因素/ 、/ 控制/ 的/ 持续性/ 和/ 主客体/ 属性/ 的/ 变异性/ ./ 实验/ 证明/ 该/ 方案/ 具有/ 较/ 高性能/ ,/ 是/ 一种/ 分布式计算/ 环境/ 下/ 的/ 行之有效/ 的/ 使用/ 控制/ 实施/ 解决方案/ ./ 关键词/ 可信计算/ ;/ 使用/ 控制/ ;/ 分布式/ 访问控制/ ;/ Linux/ 安全/ 模块/ ;/ 可信/ 扩展/ 访问控制/ 标记/ 语言/ 1/ 引言/ 传统/ 访问控制/ 只/ 关注/ 在/ “/ 服务端/ ”/ 保护/ 数据/ ,/ 而/ 现代/ 分布式/ 环境/ 中/ 出现/ 的/ 新/ 问题/ 要求/ 访问控制/ 的/ 实施/ 范围/ 从/ “/ 服务端/ ”/ 扩展/ 到/ “/ 客户端/ ”/ ./ 即使/ 在/ 自己/ 的/ Page2/ 算/ 标准/ 发展/ 迅速/ :/ 国际/ 上/ ,/ 可信计算/ 组织/ (/ TrustedComputingGroup/ ,/ TCG/ )/ 于/ 2003/ 年/ 推出/ 了/ 可信/ 平台/ 模块/ (/ TrustedPlatformModule/ ,/ TPM/ )/ 1.2/ 版/ 规范/ ①/ ;/ 在/ 国内/ ,/ 国家/ 密码/ 管理局/ 于/ 2007/ 年/ 出台/ 了/ 国家标准/ 《/ 可信计算/ 密码/ 支撑/ 平台/ 功能/ 与/ 接口/ 规范/ 》/ ②/ ,/ 多家/ 厂商/ 推出/ 了/ 可信/ 密码/ 模块/ (/ TrustedCryptographyModule/ ,/ TCM/ )/ 及/ 相关/ 产品/ ./ 基于/ 可信计算/ 的/ 使用/ 控制/ 实施/ 研究/ 尚/ 处于/ 起步/ 阶段/ ,/ 已有/ 的/ 方案/ 存在/ 以下/ 问题/ :/ (/ 1/ )/ 不能/ 充分/ 支持/ 丰富/ 的/ 使用/ 控制/ 决策/ 因素/ ;/ (/ 2/ )/ 控制/ 实施/ 的/ 持续性/ 较差/ ,/ 为/ 敌手/ 的/ 恶意/ 行为/ 留下/ 了/ 时间/ 空隙/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 给出/ 一种/ 新型/ 的/ 基于/ 可信计算/ 的/ 分布式/ 使用/ 控制系统/ ./ 其/ 从/ 策略/ 描述语言/ 和/ 实施/ 机制/ 两个/ 层面/ 支持/ 了/ 丰富/ 的/ 使用/ 控制/ 决策/ 因素/ ,/ 并/ 监视/ 用户/ 所有/ 的/ 访问/ 数据/ 的/ 操作/ ,/ 动态/ 检查/ 访问/ 进程/ 和/ 系统/ 环境/ 的/ 可信性/ ,/ 第一/ 时间/ 发现/ 非法/ 访问/ ,/ 为/ 受控/ 文件/ 提供/ 了/ 持续性/ 的/ 保护/ ./ 实验/ 表明/ ,/ 系统/ 性能/ 良好/ ,/ 可以/ 作为/ 分布式计算/ 环境/ 下/ 的/ 行之有效/ 的/ 使用/ 控制/ 实施方案/ ./ 此外/ 我们/ 还/ 给出/ 一个/ 新式/ 的/ 使用/ 控制数据/ 分发/ 协议/ ,/ 其/ 不但/ 提供/ 了/ 数据/ 机密性/ ,/ 还/ 最大/ 限度/ 保护/ 了/ 以往/ 工作/ 忽略/ 的/ 数据/ 使用者/ 的/ 平台/ 配置/ 隐私/ 性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 可信/ 使用/ 控制/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 定义/ 系统/ 构架/ 以及/ 威胁/ 模型/ ;/ 第/ 4/ 节分/ 数据/ 分发/ 系统/ 和/ 使用/ 控制/ 实施/ 系统/ 两个/ 部分/ ,/ 给出/ 系统/ 框架/ 设计/ 和/ 实现/ 并/ 讨论/ 其/ 如何/ 支持/ 使用/ 控制/ 模型/ 的/ 特性/ ;/ 第/ 5/ 节是/ 对/ 原型/ 系统/ 的/ 测试/ 与/ 分析/ ;/ 最后/ 是/ 全文/ 的/ 小结/ 和/ 下/ 一步/ 工作/ 展望/ ./ 2/ 相关/ 工作/ 基于/ 可信计算/ 的/ 使用/ 控制/ 实施/ ,/ 需要/ 借助于/ 完整性/ 度量/ 、/ 远程/ 证明/ 、/ 密钥/ 认证/ 和/ 安全/ 存储/ 等/ 可信计算/ 机制/ ./ 度量/ 功能/ 用于/ 收集/ 平台/ 软/ 、/ 硬件/ 配置/ ,/ 远程/ 证明/ 用于/ 向/ 远端/ 报告/ 上述/ 配置/ ./ 目前/ 研究者/ 已经/ 在/ 国内外/ 规范/ 的/ 基础/ 上/ 给出/ 了/ 大量/ 度量/ [/ 4/ -/ 5/ ]/ 和/ 远程/ 证明/ 方案/ [/ 6/ -/ 8/ ]/ ./ 特别/ 的/ ,/ 文献/ [/ 6/ ]/ 给出/ 一种/ 保护/ 平台/ 配置/ 隐私/ 的/ 远程/ 证明/ 协议/ ,/ 其/ 思想/ 也/ 可以/ 用于/ 使用/ 控制/ 场景/ 下/ 的/ 数据/ 分发/ ./ 密钥/ 认证/ 是/ TCM/ // TPM/ 提供/ 的/ 简单/ 功能/ ,/ 用于/ 可信/ 平台/ 向/ 对/ 端/ 证明/ 某个/ 自身/ 产生/ 的/ 密钥/ 的/ 信息/ ./ 安全/ 存储/ 功能/ 提供/ 了/ 封装/ 和/ 配置/ 绑定/ 等/ 机制/ 来/ 保证/ 存储/ 的/ 可靠性/ ./ UCLinux/ [/ 9/ ]/ 是/ 目前/ 最/ 典型/ 的/ 可信/ 使用/ 控制/ 实施方案/ ,/ 其/ 在/ 通用/ 的/ Linux/ 内核/ 之上/ 部署/ 安全/ 模块/ [/ 10/ ]/ ,/ 提供/ 可信/ 的/ 数据/ 分发/ 和/ 策略/ 实施/ 功能/ ./ 下载/ 数据/ 前/ ,/ UCLinux/ 向/ 数据/ 提供者/ 远程/ 证明/ 自身/ 的/ 可信/ 配置/ ;/ 数据/ 下载/ 后/ ,/ UCLinux/ 加密/ 数据/ ,/ 封装/ 加密/ 密钥/ ,/ 并/ 截获/ 访问/ 数据/ 产生/ 的/ 系统/ 调用/ 以/ 检查/ 访问/ 是否/ 满足/ 策略/ 要求/ ./ 该/ 方案/ 对/ 现有/ 内核/ 的/ 改动/ 小/ ,/ 策略/ 实施/ 系统/ 具备/ 相当/ 的/ 安全性/ 和/ 不可/ 绕过/ 性/ ,/ 但/ 同时/ 存在/ 下述/ 问题/ :/ (/ 1/ )/ UCLinux/ 未/ 采用/ 专用/ 的/ 使用/ 控制策略/ 描述语言/ ,/ 不能/ 支持/ 丰富/ 的/ 使用/ 控制/ 决策/ 因素/ ;/ (/ 2/ )/ UCLinux/ 控制/ 粒度/ 较/ 粗/ ,/ 其/ 采用/ 的/ 加载/ 时/ 度量/ 机制/ [/ 4/ ]/ 动态性/ 不足/ ,/ 导致/ 控制/ 持续性/ 较差/ ./ 此外/ UCLinux/ 的/ 数据/ 分发/ 系统/ 以/ 普通/ 远程/ 证明/ 机制/ 为/ 基础/ ,/ 暴露/ 数据/ 使用者/ 平台/ 配置/ ,/ 可能/ 带来/ 配置/ 歧视/ 或/ 攻击/ ./ TrustWorthySELinux/ [/ 11/ ]/ 是/ 另/ 一个/ 比较/ 典型/ 的/ 方案/ ,/ 其/ 基本原理/ 和/ 优缺点/ 类似/ 于/ UCLinux/ ,/ 不同/ 的/ 是/ 其/ 在/ 本地/ 实施/ 控制/ 时/ 采用/ 强制/ 访问/ 控制策略/ ③/ ,/ 且/ 存储/ 时未/ 使用/ 安全/ 存储/ 功能/ ./ 文献/ [/ 12/ ]/ 给出/ 了/ 一种/ 使用/ 虚拟机/ 实现/ 可信/ 使用/ 控制/ 的/ 方案/ ,/ 相比/ UCLinux/ 等/ 其/ 安全性/ 和/ 不可/ 绕过/ 性/ 都/ 有/ 较大/ 提高/ ,/ 但/ 实现/ 的/ 难度很大/ ./ 文献/ [/ 13/ ]/ 给出/ 一个/ 基于/ 密钥/ 认证/ 的/ 可信/ 数据/ 分发/ 的/ 协议/ ./ 相比/ UCLinux/ 的/ 基于/ 远程/ 证明/ 的/ 数据/ 分发/ 方案/ ,/ 该/ 协议/ 不/ 需要/ 数据/ 使用者/ 封装数据/ 加密/ 密钥/ ,/ 因而/ 拥有/ 更/ 高/ 的/ 数据/ 机密性/ ,/ 但是/ 目前/ 包括/ 文献/ [/ 13/ ]/ 在内/ 的/ 各种/ 使用/ 控制/ 的/ 数据/ 分发/ 方案/ 都/ 无法/ 保障/ 数据/ 使用/ 平台/ 的/ 配置/ 隐私/ ./ 3/ 系统/ 架构/ 使用/ 控制/ 场景/ 中/ ,/ 数据/ 提供者/ 分发/ 数据/ 及/ 相应/ 的/ 策略/ ,/ 数据/ 使用者/ 下载/ 数据/ 并/ 在/ 本地/ 使用/ ./ 使用者/ 可能/ 是/ 恶意/ 的/ ,/ 其/ 希望/ 逃避/ 使用/ 控制策略/ 的/ 约束/ ,/ 非法/ 访问/ 、/ 执行/ 或/ 传播/ 数据/ ./ 我们/ 假设/ 恶意/ 使用者/ 可以/ 使用/ 任意/ 的/ 软件/ 攻击/ 方法/ ,/ 但/ 无/ 硬件/ 攻击能力/ ./ 本文/ 给出/ 的/ 系统/ 架构/ 如图/ 1/ 所示/ ,/ 主要/ 包括/ 数据/ 分发/ 子系统/ 、/ 使用/ 控制/ 实施/ 子系统/ 以及/ 可信/ 引导/ 和/ 加载/ 时/ 度量/ 两个/ 独立/ 模块/ ./ 数据/ 分发/ 子系统/ 由/ 可信/ 分发/ 、/ 接受/ 模块/ 以及/ 策略/ 生成/ 、/ 解析/ 模块/ 构成/ ./ 可信/ 分发/ 和/ 接收/ 模块/ 负责/ 使/ 数据/ 提供者/ 确认/ 对/ 端的/ 可信/ 配置/ 、/ 协商/ 策略/ 格式/ 并/ 安全/ 地/ 传输数据/ ./ 策略/ 生成/ ①/ ②/ ing/ ./ orgtographicSupportPlatformforTrustedComputing/ ./ http/ :/ ③/ Page3/ 和/ 解析/ 模块/ 支持/ 策略/ 协商/ ,/ 转换/ 策略/ 格式/ ./ 控制/ 实施/ 子系统/ 由/ 安全/ 存储模块/ 、/ 策略/ 判定/ 模块/ 和/ 动态/ 度量/ 模块/ 构成/ ./ 安全/ 存储模块/ 向/ 可信/ 接收/ 模块/ 提供/ 封装/ 接口/ 、/ 加密/ 存储/ 数据/ 以及/ 检查数据/ 与/ 策略/ 的/ 完整性/ ./ 策略/ 判决/ 模块/ 决策/ 是否/ 允许/ 对/ 文件/ 的/ 访问/ ./ 策略/ 判决/ 时/ 可能/ 需要/ 度量/ 访问/ 文件/ 的/ 进程/ ,/ 该/ 功能/ 由/ 动态/ 度量/ 模块/ 完成/ ./ 可信/ 引导/ 和/ 加载/ 时/ 度量/ 模块/ 配合/ 完成/ 认证/ 启动/ ,/ 前者/ 在/ 系统启动/ 时/ 将/ 信任/ 链/ 从/ 底层/ 扩展/ 至/ 操作系统/ ,/ 后者/ 在/ 系统启动/ 后/ 度量/ 和/ 报告/ 平台/ 运行/ 的/ 所有/ 程序/ ,/ 将/ 信任/ 链/ 进一步/ 扩展/ 至/ 应用层/ 程序/ ./ 认证/ 启动/ 是/ 保证/ 系统安全/ 、/ 进行/ 远程/ 证明/ 的/ 基础/ ./ 4/ 系统/ 设计/ 与/ 实现/ 4.1/ 数据/ 分发/ 子系统/ 4.1/ ./ 1/ 工作/ 流程/ 个/ 步骤/ :/ 鲜性/ ;/ 3/ ./ 可信/ 接收/ 模块/ 进行/ 远程/ 证明/ ;/ 如图/ 2/ 所示/ ,/ 一次/ 完整/ 的/ 数据/ 分发/ 过程/ 分为/ 101/ ./ 可信/ 接收/ 模块/ 发送/ 下载/ 数据/ 请求/ ;/ 2/ ./ 可信/ 分发/ 模块/ 发送/ 挑战/ 随机数/ ,/ 用于/ 保证/ 会话/ 的/ 新/ 4/ ./ 双方/ 协商/ 使用/ 控制策略/ 格式/ 以及/ 加密/ 数据/ 使用/ 的/ 密钥/ (/ 可能/ 包含/ 多轮/ 交互/ )/ ;/ 5/ ./ 可信/ 分发/ 模块/ 调用/ 策略/ 生成/ 模块/ ,/ 根据/ 协商/ 要求/ 生成/ 策略/ ;/ 6/ ./ 策略/ 生成/ 模块/ 返回/ 策略/ ;/ 7/ ./ 可信/ 分发/ 模块/ 使用/ 协商/ 好/ 的/ 密钥/ 传输数据/ 及/ 策略/ ;/ 8/ ./ 可信/ 接收/ 模块/ 请求/ 解析/ 策略/ ;/ 9/ ./ 策略/ 解析/ 模块/ 返回/ 适用/ 于/ 本机/ 平台/ 的/ 策略/ 描述/ ;/ 10/ ./ 可信/ 接收/ 模块/ 调用/ 安全/ 存储模块/ ,/ 将/ 数据文件/ 及其/ 策略/ 存储/ 于/ 本地/ 设备/ ./ 4.1/ ./ 2/ 系统/ 实现/ 4.1/ ./ 2.1/ 策略/ 生成/ 和/ 解析/ 模块/ 我们/ 采用/ 可信/ 扩展/ 访问控制/ 标记/ 语言/ TXACML/ [/ 14/ ]/ 来/ 描述/ 和/ 交互/ 使用/ 控制策略/ ./ TXACML/ 扩展/ 自/ XACML/ ,/ 易于/ 构建/ 和/ 解析/ ,/ 互操作/ 和/ 通用性/ 强/ ./ 而且/ 相比/ 以往/ 工作/ [/ 9/ ,/ 11/ ]/ 的/ 相关/ 部分/ ,/ TXACML/ 支持/ 的/ 使用/ 控制/ 因素/ 更加/ 丰富/ ,/ 不但/ 可以/ 描述/ 用户/ 标识/ 和/ 角色/ 等/ 传统/ 访问控制/ 信息/ ,/ 还/ 支持/ 使用/ 控制/ 场景/ 常见/ 的/ 环境/ 条件/ 、/ 系统/ 义务/ 以及/ 使用/ 时间/ 、/ 次数/ 限制/ 等/ ./ 具体/ 地/ ,/ 本文/ 系统/ 的/ 策略/ 主要/ 由/ 以下内容/ 构成/ :/ (/ 1/ )/ 进程/ 属性/ ./ 作为/ 主体/ 的/ 进程/ 的/ 属性/ ,/ 例如/ 进程/ 标识/ 和/ 合法/ 进程/ 的/ 标准/ 度量/ 值/ ;/ (/ 2/ )/ 用户/ 属性/ ./ 作为/ 主体/ 的/ 用户/ 属性/ ,/ 例如/ 用户/ 标识/ 、/ 角色/ 和/ 权限/ 等/ ;/ (/ 3/ )/ 资源/ 属性/ ./ 作为/ 客体/ 的/ 文件/ 资源/ 属性/ ,/ 例如/ 文件名/ 和/ 标准/ 度量/ 值/ 等/ ;/ (/ 4/ )/ 策略管理/ ./ 可/ 用于/ 更新/ 的/ 使用/ 控制/ 信息/ ,/ 例如/ 使用/ 时间/ 限制/ 、/ 次数/ 限制/ 和/ 目的/ 限制/ 等/ ;/ (/ 5/ )/ 环境/ 属性/ ./ 访问/ 发生/ 时应/ 满足/ 的/ 环境/ 条件/ ,/ 例如/ 操作系统/ 、/ 杀毒软件/ 和/ 防火墙/ 版本/ 等/ ./ TXACML/ 描述/ 的/ 使用/ 控制策略/ 示/ 例如/ 图/ 3/ 所示/ ./ Page4/ 〈/ TXACMLversion/ =/ "/ 1.0/ "/ encoding/ =/ "/ UTF/ -/ 8/ "/ ?/ 〉/ 〈/ PolicyPolicyId/ =/ RuleCombiningAlgId/ =/ "/ Deny/ -/ Overrides/ "/ 〉/ 〈/ RuleRuleId/ =/ "/ Rule01/ "/ Effect/ =/ "/ Permit/ "/ 〉/ 〈/ Target/ 〉/ 〈/ Subject/ 〉/ 〈/ SubjectMatchId/ =/ 〈/ AttributeValueDataType/ =/ "/ SecAttrPlatformType/ "/ 〉/ …/ …/ 〈/ // AttributeValue/ 〉/ 〈/ SubjectAttributeDesignatorAttributeId/ =/ "/ urn/ :/ oasis/ :/ names/ :/ tc/ :/ xacml/ :/ 1.0/ :/ environment/ :/ "/ DataType/ =/ "/ "/ // 〉/ 〈/ // SubjectMatch/ 〉/ 〈/ // Subject/ 〉/ 〈/ Resource/ 〉/ 〈/ ResourceMatchId/ =/ 〈/ AttributeValueDataType/ =/ "/ "/ 〉/ …/ …/ 〈/ // AttributeValue/ 〉/ 〈/ ResourceAttributeDesignatorAttributeId/ =/ "/ urn/ :/ oasis/ :/ names/ :/ tc/ :/ xacml/ :/ 1.0/ :/ Resource/ :/ "/ DataType/ =/ "/ "/ // 〉/ 〈/ // ResourceMatch/ 〉/ 〈/ // Resource/ 〉/ 〈/ // Target/ 〉/ 策略/ 必须/ 与/ 数据/ 绑定/ 才能/ 发挥作用/ ./ 类似/ 于/ 文献/ [/ 9/ ]/ 方案/ ,/ 我们/ 将/ 策略/ 存储/ 于/ Linux/ 文件/ 扩展/ 属性/ 中/ ,/ 利用/ 文件/ 与其/ 扩展/ 属性/ 的/ 天然/ 绑定/ 性/ 实现/ 了/ 数据/ 与其/ 策略/ 的/ 绑定/ ./ 可信/ 接收/ 模块/ 在/ 接收/ 到/ 数据/ 和/ 策略/ 后/ ,/ 将/ 数据/ 及/ 策略/ 分别/ 存储/ 于/ 文件/ 及其/ 扩展/ 属性/ 中/ ./ 用户/ 进程/ 查询/ 和/ 修改/ 策略/ 时/ ,/ 只/ 需要/ 针对/ 数据文件/ 的/ 扩展/ 属性/ 执行/ 操作/ 即可/ ./ 由于/ 文件/ 与/ 扩展/ 属性/ 的/ 绑定/ 是/ 纯粹/ 的/ 操作系统/ 功能/ ,/ 故/ 这种/ 绑定/ 方式/ 与/ 应用程序/ 无关/ ./ 4.1/ ./ 2.2/ 可信/ 分发/ 和/ 接收/ 模块/ 可信/ 分发/ 和/ 接收/ 模块/ 最/ 重要/ 的/ 工作/ 是/ 进行/ 远程/ 证明/ ,/ 而/ 远程/ 证明/ 又/ 以/ 认证/ 启动/ 为/ 基础/ ./ 我们/ 在/ 普通/ 的/ 操作系统/ 加载/ 器/ 的/ 基础/ 上/ 增加/ 信任/ 链/ 建立/ 、/ 报告/ 功能/ ,/ 开发/ 了/ 可信/ 配置/ 的/ 可信/ 引导/ 系统/ LoisGrub/ [/ 15/ ]/ ./ 平台/ 系统启动/ 时/ ,/ 主/ 引导/ 记录/ (/ MBR/ )/ 和/ 操作系统/ 内核/ 文件/ 等/ 被/ 依次/ 度量/ ,/ 结果/ 被/ 扩展/ 至/ TCM/ // TPM/ 的/ 平台/ 配置/ 寄存器/ (/ PCR/ )/ 中/ ./ 系统启动/ 后/ ,/ 处于/ 内核/ 层/ 的/ 加载/ 时/ 度量/ 模块/ 将/ 度量/ 和/ 报告/ 所有/ 加/ 载入/ 内存/ 的/ 可执行文件/ 以及/ 动态/ 库/ 等/ ./ 系统/ 远程/ 证明/ 采用/ 简明/ 的/ 证明/ 身份/ 密钥/ (/ AIK/ )/ 方式/ 进行/ ,/ 证明/ 内容/ 是/ 系统启动/ 后/ 所有/ 影响/ 系统/ 状态/ 的/ 软/ 、/ 硬件/ 情况/ ,/ 即/ LoisGrub/ 和/ 加载/ 时/ 度量/ 模块/ 的/ 度量/ 结果/ ./ 为了/ 保证/ 图/ 2/ 所示/ 的/ 步/ ①/ ~/ ④/ 和步/ ⑦/ 交互/ 的/ 安全/ ,/ 我们/ 采用/ 安全/ 传输层/ 协议/ TLSv1/ ./ 0/ ①/ 为/ 消息/ 提供/ 机密性/ 和/ 完整性/ 保护/ ./ TLS/ 是/ 一种/ 成熟/ 的/ 被/ 广泛/ 采纳/ 的/ 互联网安全/ 通信/ 标准/ ,/ 可/ 提高/ 系统/ 的/ 在/ 不同/ 平台/ 和/ 环境/ 下/ 的/ 通用性/ ./ 4.1/ ./ 3/ 保护/ 配置/ 隐私/ 的/ 新型/ 数据/ 分发/ 协议/ 数据/ 分发/ 子系统/ 的/ 步/ ①/ ~/ ④/ 和步/ ⑦/ 实现/ 了/ 一个/ 简单/ 的/ 数据/ 分发/ 协议/ ,/ 其/ 思路/ 直观/ 、/ 实现/ 简便/ 、/ 效率/ 较/ 高/ ,/ 但是/ 也/ 存在/ 暴露/ 数据/ 使用者/ 配置/ 隐私/ 的/ 问题/ ./ 本节/ 非常/ 简要地/ 给出/ 另/ 一种/ 能够/ 保护/ 数据/ 使用者/ 配置/ 隐私/ 的/ 新型/ 数据/ 分发/ 协议/ ./ 此/ 协议/ 需要/ TCM/ // TPM/ 增加/ 新/ 功能/ (/ 认证/ 密钥/ 承诺/ ,/ 协议/ 中/ 抽象化/ 为/ 命令/ TCM/ _/ CertifyKeyCommitment/ )/ 而/ 暂时/ 未/ 实现/ ,/ 但/ 其/ 通过/ 保护/ 隐私/ 有效/ 解决/ 了/ 配置/ 歧视/ 和/ 针对/ 特定/ 配置/ 的/ 攻击/ 等/ 现实/ 且/ 愈发/ 突出/ 的/ 安全/ 问题/ ,/ 目前/ 的/ TCM/ // TPM/ 已/ 具备/ 增加/ 新/ 功能/ 所/ 需/ 的/ 全部/ 运算/ 模块/ ,/ 因而/ 不久/ 的/ 将来/ 实现/ 该/ 协议/ 是/ 必要/ 和/ 可行/ 的/ ./ 由于/ 着重/ 考虑/ 配置/ 隐私/ 保护/ 问题/ ,/ 我们/ 假设/ 协议/ 的/ 传输/ 内容/ (/ 例如/ 数据/ 加密/ 密钥/ ,/ 下文/ 中/ 的/ K/ )/ 的/ 机密性/ 和/ 认证/ 性/ 已经/ 由/ 安全/ 信道/ 进行/ 保护/ ,/ 安全/ 信道/ 可以/ 使用/ 上文/ 所述/ 的/ TLS/ 等/ 成熟技术/ 实现/ ./ 另外/ ,/ 该/ 协议/ 不/ 区分/ 数据/ 和/ 相应/ 的/ 策略/ ,/ 统一/ 将/ 其/ 作为/ 数据/ 进行/ 传输/ ,/ 具体/ 的/ 策略/ 解析/ 以及/ 策略/ 绑定/ 等/ 工作/ 由/ 数据/ 使用者/ 接收/ 到/ 数据/ 后/ 完成/ ./ 4.1/ ./ 3.1/ 协议/ 流程/ 假设/ 数据/ 提供者/ 和/ 使用者/ 已经/ 事先/ 协商/ 好/ 可信/ 平台/ 配置/ 集合/ PC/ =/ {/ pc1/ ,/ pc2/ ,/ …/ ,/ pcN/ }/ ,/ 数据/ 分发/ 协议/ 一方面/ 要/ 保证/ 只有/ 处于/ 可信/ 配置/ 的/ 使用者/ 平台/ 才/ 能够/ 访问/ 数据/ ,/ 另一方面/ 应/ 确保/ 协议/ 结束/ 后/ ,/ 提供者/ 确信/ 使用者/ 平台/ 的/ 配置/ pcDU/ ∈/ PC/ ,/ 但/ 却/ 不/ 清楚/ pcDU/ 的/ 具体/ 配置/ ./ 类似/ 于/ 文献/ [/ 13/ ]/ ,/ 该/ 协议/ 采用/ 密钥/ 认证/ 而/ 非常规/ 的/ 远程/ 证明/ 方式/ 确保/ 访问/ 发生/ 时/ 数据/ 使用者/ 平台/ 的/ 可信/ 配置/ ,/ 进而/ 保证数据/ 的/ 机密性/ ./ 密钥/ 认证/ 通过/ TCM/ // TPM/ 签署/ 的/ 密钥/ 信息/ 承诺/ [/ 16/ ]/ 以及/ 使用者/ 平台/ 签署/ 的/ 环/ 签名/ [/ 17/ ]/ 完成/ ,/ 不会/ 暴露/ 具体/ 配置/ ./ 具体/ 的/ 环/ 签名/ 方案/ 、/ 承诺/ 方案/ 以及/ 其/ 配合/ 使用/ 分别/ 借鉴/ 了/ 文献/ [/ 6/ ,/ 16/ -/ 17/ ]/ ./ 协议/ 准备/ ./ 数据/ 使用者/ DU/ 与/ 数据/ 提供者/ DP/ 协商/ 一个/ 可信/ 配置/ 集/ PC/ ,/ 选定/ 一系列/ 的/ 密码学/ 参数/ ,/ 包括/ 大/ 素数/ P/ 、/ P/ 上/ 的/ 一个/ Q/ 阶/ 子群/ 的/ 生成元/ h/ 和/ 子群/ 的/ 成员/ g/ ,/ 并/ 保持/ g/ 的/ 阶/ 的/ 机密性/ ./ DU/ 使用/ TCM/ 生成/ 用于/ 加密/ 的/ 、/ 不可/ 迁移/ 且/ 与/ 某/ 配置/ pcDU/ ∈/ PC/ 绑定/ 的/ 密钥/ K/ ./ 由此/ ,/ 密钥/ 的/ 信息/ 记为/ KIDU/ =/ ①/ TheTLSprotocol/ :/ Version1/ ./ 0/ ./ http/ :/ // // www/ ./ ietf/ ./ org/ // Page5/ {/ K/ ,/ ES/ _/ SM2/ ,/ non/ -/ migrabtable/ ,/ pcDU/ }/ ./ KI/ 中/ K/ 表示/ 密钥/ 明文/ ,/ 即/ 如果/ 加密/ 密钥/ 是/ 对称/ 的/ ,/ 则/ K/ 为/ 密钥/ 值/ ,/ 如果/ 加密/ 密钥/ 是/ 非对称/ 的/ ,/ 则/ K/ 为/ 公钥值/ ;/ EM/ _/ SM2/ 和/ non/ -/ migrabtable/ 是/ 两个/ 抽象/ 标记/ ,/ 表征/ 密钥/ 的/ 用途/ 和/ 迁移/ 情况/ ./ 协议/ 流程/ ./ 1/ ./ DU/ 请求/ 下载/ 数据/ D/ ;/ 2/ 、/ 3/ ./ DP/ 发送/ 挑战/ 随机数/ NDP/ ;/ DU/ 以/ NDP/ 和/ 加密/ 密钥/ K/ 的/ 句柄/ (/ 依/ TCM/ 规范/ 习惯/ ,/ 使用/ 密钥/ 之前/ 必须/ 加载/ 该/ 密钥/ ,/ 使用/ 时以/ 句柄/ 指代/ 该/ 密钥/ )/ 为/ 参数/ ,/ 调用/ 新/ 命令/ TCM/ _/ CertifyKeyCommitment/ ,/ 请求/ TCM/ 对/ 密钥/ 信息/ KIDU/ 图/ 4/ 数据/ 分发/ 协议/ 协议/ 执行/ 后/ 提供者/ 对/ 使用者/ 平台/ 配置/ 的/ 信心/ 源自/ 于/ 两点/ :/ (/ 1/ )/ TCM/ // TPM/ 的/ 签名/ 确保/ 了/ TCM/ // TPM/ 确实/ 刚刚/ 签署/ 了/ 有关/ 密钥/ 信息/ 的/ 承诺/ ,/ (/ 2/ )/ 环/ 签名/ 确保/ 了/ 承诺/ 确实/ 可以/ 表达/ 为/ Cm/ =/ gmhrmodP/ 的/ 形式/ ,/ 其中/ m/ =/ KIDU/ ,/ 而且/ 伪造/ 这样/ 一个/ 签名/ 是/ 困难/ 的/ ./ 在/ 该/ 方案/ 中/ ,/ 数据/ 离开/ 数据/ 提供者/ 控制/ 域/ 后/ 始终/ 处于/ 密钥/ 保护/ 之下/ ,/ 且/ 只有/ 处于/ 可信/ 配置/ 的/ 数据/ 使用者/ 平台/ 才能/ 使用/ 密钥/ 解密/ ./ 如果/ 密钥/ 认证/ 机制/ 和/ 加密算法/ 可靠/ ,/ 则/ 数据/ 机密性/ 得到/ 保证/ ./ 平台/ 配置/ 的/ 隐私/ 性/ ,/ 由/ 上述/ 协议/ 的/ 步/ 2/ ~/ 8/ 保证/ ./ 4.1/ ./ 3.2/ 安全性/ 分析/ 数据/ 分发/ 协议/ 的/ 目标/ 是/ 保证数据/ 机密性/ 和/ 使用者/ 平台/ 配置/ 的/ 隐私/ 性/ ,/ 故/ 我们/ 分别/ 对/ 这/ 两种/ 安全/ 性质/ 进行/ 讨论/ ./ 数据/ 机密性/ 分析/ ./ 恶意/ 的/ 数据/ 使用者/ A/ 希望/ 破坏/ 数据/ 机密性/ ,/ 即/ 在/ 不/ 安全/ 的/ 平台/ 配置/ 下/ 访问/ 受控/ 数据/ ./ 这/ 只能/ 发生/ 在/ A/ 生成/ 了/ 密钥/ K/ 并/ 使/ 数据/ 提供者/ 相信/ K/ 与/ 某/ 可信/ 状态/ pcDU/ ∈/ PC/ 绑定/ ,/ 但/ K/ 实际/ 绑定/ 的/ 是/ pcNT/ / PC/ ./ 类似/ 于/ 文献/ [/ 6/ ]/ ,/ 我们/ 采用/ 游戏/ 4/ 、/ 5/ ./ TCM/ 选择/ 承诺/ 密钥/ 为/ r/ 、/ 计算/ 密钥/ 信息/ 的/ 承诺/ C/ 以及/ 对/ 该/ 承诺/ 进行/ 签名/ σ/ TCM/ ,/ 最后/ 返回/ C/ 、/ σ/ TCM/ 和/ r/ ;/ 进行/ 认证/ ;/ 6/ 、/ 7/ ./ DU/ 根据/ 密钥/ K/ 和/ 可信/ 平台/ 配置/ 集/ PC/ ,/ 计算/ n/ 个/ 密钥/ 配置/ 信息/ KIi/ ;/ 再/ 根据/ KIi/ 计算/ yi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 并/ 以/ yi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 和/ 其它/ 密码学/ 参数/ 为/ 公钥/ ,/ 承诺/ 密钥/ r/ 为/ 私钥/ ,/ 计算/ 对/ NDP/ 的/ 环/ 签名/ ./ 最后/ 发送/ K/ 、/ ES/ _/ SM2/ 、/ non/ -/ migratable/ 、/ C/ 、/ σ/ TCM/ 和/ σ/ DU/ ./ 7/ 、/ 8/ ./ DP/ 先/ 验证/ TCM/ 对/ 承诺/ 的/ 签名/ ,/ 再/ 以/ 和/ DU/ 同样/ 的/ 方式/ 计算/ 环/ 签名/ 公钥/ 并/ 验证/ 环/ 签名/ ;/ 如果/ 全部/ 都/ 能/ 通过/ 则/ 以/ K/ 加密/ 数据/ 发送给/ DU/ ./ 序列/ 的/ 方法/ ①/ ,/ 证明/ 敌手/ 在/ 各/ 游戏/ 中/ 获胜/ 的/ 概率/ 之差/ 均/ 为/ 可/ 忽略/ 量/ ,/ 进而/ 证明/ 破坏/ 数据/ 机密性/ 是/ 困难/ 的/ ./ 在/ 游戏/ 序列/ 当中/ ,/ Game0/ 为/ 基本/ 游戏/ ,/ 表征/ 证明/ 目标/ ,/ 各/ 游戏/ Gamei/ +/ 1/ 是/ 对/ Gamei/ 的/ 变型/ ./ 与/ A/ 交互/ 的/ 是/ 代表/ 协议/ 诚实/ 参与方/ (/ 数据/ 提供者/ )/ 模拟器/ S/ ,/ 每个/ 游戏/ 中/ 都/ 会/ 引入/ 一个/ “/ 失败/ 事件/ ”/ F/ ,/ 如果/ 在/ Gamei/ +/ 1/ 中/ 发生/ F/ ,/ 则/ S/ 退出/ 游戏/ ,/ A/ 攻击/ 失败/ ;/ 如果/ 不/ 发生/ F/ ,/ Gamei/ 和/ Gamei/ +/ 1/ 将/ 永远/ 一致/ 的/ 运行/ 下去/ ,/ 即/ 事件/ (/ Wini/ ∧/ / F/ )/ 和/ (/ Wini/ +/ 1/ ∧/ / F/ )/ 等价/ (/ 其中/ Wini/ 表示/ A/ 赢得/ Gamei/ 的/ 事件/ )/ ,/ 进而/ 可/ 推出/ |/ Pr/ [/ Wini/ +/ 1/ ]/ -/ Pr/ [/ Wini/ ]/ |/ / Pr/ [/ F/ ]/ ./ 具体/ 证明/ 过程/ 如下/ :/ Game0/ ./ A/ 生成/ 密钥/ K/ ,/ K/ 实际/ 绑定/ 的/ 配置/ 为/ pcNT/ / PC/ ,/ 但/ 敌手/ 成功/ 地使/ S/ 相信/ ,/ K/ 是/ 与/ 某/ 可信/ 状态/ pcDU/ ∈/ PC/ 绑定/ 的/ ,/ 即/ A/ 向/ S/ 提供/ 的/ 承诺/ 和/ 签名/ 三元组/ (/ C/ ,/ σ/ TCM/ 和/ σ/ RING/ )/ 经过/ 了/ S/ 的/ 验证/ ./ 记/ A/ 在/ Game0/ (/ 也/ 即/ 破坏/ 数据/ 机密性/ 的/ 活动/ 中/ )/ 成功/ 的/ 概率/ ①/ ShoupV/ ./ Sequencesofgames/ :/ Atoolfortamingcomplexi/ -/ tyinsecurityproofs/ ./ CryptologyePrintArchive/ ,/ ReportPage6/ 为/ Pr/ [/ Win0/ ]/ ./ Game1/ ./ Game1/ 与/ Game0/ 基本相同/ ,/ 唯一/ 的/ 区别/ 在于/ :/ S/ 刻意/ 记录/ 了/ 已经/ 使用/ 过/ 的/ 挑战/ 随机数/ NDP/ ,/ 如果/ 某次/ 协议/ 运行/ 时/ 随机/ 选择/ 得到/ 的/ NDP/ 为/ 已经/ 使用/ 过/ 的/ 随机数/ ,/ S/ 就/ 立即/ 中断/ 游戏/ ./ 这种/ 情况/ 下/ ,/ “/ 失败/ 事件/ ”/ FNONCE/ 定义/ 为/ 发生/ 随机数/ 碰撞/ ,/ 事件/ (/ Win1/ ∧/ / FNONCE/ )/ 和/ (/ Win0/ ∧/ / FNONCE/ )/ 等价/ ,/ 因而/ 根据/ 概率/ 差异/ 引理/ (/ 即/ 游戏/ 序列/ 的/ 方法/ )/ 有如/ 下结论/ :/ |/ Pr/ [/ Win0/ ]/ -/ Pr/ [/ Win1/ ]/ |/ / Pr/ [/ FNONCE/ ]/ (/ 1/ )/ Game2/ ./ Game2/ 与/ Game1/ 基本相同/ ,/ 唯一/ 的/ 区别/ 在于/ :/ S/ 拥有/ 一个/ TCM/ 签名/ Oracle/ 来/ 获取/ 当前/ 协议/ 运行/ 时/ TCM/ 给出/ 的/ 真实/ 签名/ (/ 不管/ A/ 是否/ 实际/ 请求/ TCM/ 进行/ 签名/ ,/ 我们/ 假设/ TCM/ 在/ 每次/ 协议/ 运行/ 时/ 都/ 对/ A/ 要/ 证明/ 的/ 密钥/ K/ 的/ 信息/ 产生/ 了/ 签名/ ,/ 并/ 将/ 签名/ 值/ 报告/ 给/ Oracle/ )/ ,/ 同时/ S/ 也/ 从/ A/ 处/ 获取/ TCM/ 签名/ ,/ 一旦/ 发现/ 两个/ 签名/ 不符/ (/ 即/ A/ 伪造/ 了/ TCM/ 签名/ )/ 则/ 立即/ 中断/ 游戏/ ./ “/ 失败/ 事件/ ”/ FTCM/ 定义/ 为/ A/ 成功/ 伪造/ TCM/ 签名/ ,/ 类似/ 于/ Game1/ ,/ 有如/ 下结论/ :/ |/ Pr/ [/ Win1/ ]/ -/ Pr/ [/ Win2/ ]/ |/ / Pr/ [/ FTCM/ ]/ (/ 2/ )/ Game3/ ./ Game3/ 与/ Game2/ 基本相同/ ,/ 唯一/ 的/ 区别/ 在于/ :/ S/ 拥有/ 一个/ 敌手/ 信息/ 告知/ Oracle/ ,/ 每次/ 运行/ 协议/ 时/ 数据/ 提供者/ 都/ 能/ 从/ 该/ Oracle/ 获知/ A/ 是否/ 真的/ 知道/ 对应/ 于/ 某个/ 环/ 签名/ 公钥/ yi/ 的/ 私钥/ ri/ ,/ 一旦/ 发现/ A/ 并不知道/ (/ 即/ A/ 无/ 签名/ 私钥/ 的/ 情况/ 下/ 伪造/ 了/ 环/ 签名/ )/ ,/ 则/ 立即/ 中断/ 游戏/ ./ “/ 失败/ 事件/ ”/ FRING/ 定义/ 为/ 无/ 签名/ 私钥/ 的/ 情况/ 下/ 成功/ 伪造/ 环/ 签名/ ./ 类似/ 于/ Game2/ ,/ 我们/ 给出/ 如下/ 结论/ :/ |/ Pr/ [/ Win2/ ]/ -/ Pr/ [/ Win3/ ]/ |/ / Pr/ [/ FRING/ ]/ (/ 3/ )/ 如果/ A/ 能够/ 赢得/ Game3/ ,/ 则/ 说明/ 其/ 面对/ 新鲜/ 的/ 随机数/ 挑战/ ,/ 既/ 未/ 伪造/ TCM/ 签名/ ,/ 又/ 未/ (/ 在/ 无环/ 签名/ 私钥/ 的/ 情况/ )/ 伪造/ 环/ 签名/ ./ 因此/ ,/ 为了/ 给出/ 能够/ 通过/ S/ 验证/ 的/ 环/ 签名/ ,/ A/ 必然/ 设法/ 拥有/ 了/ 对应/ 于/ 某个/ 配置/ pci/ ∈/ PC/ 的/ 承诺/ 密钥/ s/ ,/ 使得/ gPSihS/ =/ C/ =/ gPSDUhr/ ,/ 因而/ 有/ LOGh/ (/ g/ )/ =/ (/ pci/ -/ pcUI/ )/ // (/ s/ -/ r/ )/ ,/ 即/ A/ 可/ 成功/ 求解/ 出/ 协议/ 中/ g/ 关于/ h/ 的/ 离散/ 对数/ ./ 因此/ ,/ 有如/ 下结论/ :/ 其中/ FDLOG/ 表示/ 求解/ h/ 关于/ g/ 的/ 离散/ 对数/ 成功/ 的/ 概率/ ./ 根据/ 式/ (/ 1/ )/ ~/ (/ 4/ )/ ,/ 我们/ 可以/ 得出结论/ :/ Pr/ [/ Win0/ ]/ / Pr/ [/ FDLOG/ ]/ +/ Pr/ [/ FNONCE/ ]/ +/ 根据/ 安全/ 假设/ ,/ 上述/ 不等式/ 右方/ 的/ 4/ 个/ 概率/ 均/ 为/ 关于/ 安全/ 参数/ 的/ 可/ 忽略/ 量/ ,/ 因而/ 概率/ 多项式/ 敌手/ 破坏/ 数据/ 机密性/ 是/ 困难/ 的/ ./ 值得注意/ 的/ 是/ ,/ 虽然/ 目前/ 所有/ 证明/ 均/ 在/ 标准/ 模型/ 下/ 完成/ ,/ 但是/ 环/ 签名/ 的/ 安全性/ 证明/ 在/ 随机/ 预言/ 模型/ 下/ 完成/ ,/ 因而/ 我们/ 的/ 证明/ 结论/ 也/ 仅/ 在/ 随机/ 预言/ 模型/ 下/ 成立/ ./ 配置/ 隐私/ 性/ 分析/ ./ 恶意/ 的/ 数据/ 提供者/ A/ 希望/ 获知/ 数据/ 使用者/ 的/ 平台/ 配置/ ./ 类似/ 于/ 文献/ [/ 6/ ]/ ,/ 我们/ 采用/ 反证/ 的/ 方法/ :/ 使用/ 模拟器/ S/ 来/ 模拟/ 诚实/ 的/ 协议/ 参与方/ 与/ A/ 交互/ ,/ 并/ 证明/ 如果/ A/ 破坏/ 了/ 协议/ 的/ 配置/ 隐私/ 性/ ,/ 则/ S/ 可以/ 破坏/ 协议/ 中/ 的/ 承诺/ 方案/ 的/ 完美/ 隐藏/ 性/ [/ 16/ ]/ 或者/ 环/ 签名/ 方案/ 的/ 签名者/ 模糊性/ [/ 17/ ]/ ./ 记/ S/ 和/ A/ 交互/ 构成/ 的/ 游戏/ 为/ GamePRIV/ ,/ 在/ 两种/ 情况/ 下/ 分别/ 进行/ 此/ 游戏/ ./ GamePRIV1/ ./ 假设/ 环/ 签名/ 方案/ 具有/ 无条件/ 签名者/ 模糊性/ [/ 17/ ]/ ./ S/ 在/ GamePRIV1/ 中/ 模拟/ 数据/ 使用者/ ,/ 其/ 得到/ 一次/ 协议/ 运行/ 中/ 的/ 对/ 密钥/ 信息/ 的/ 承诺/ C/ ,/ 试图/ 获取/ C/ 对应/ 的/ 被/ 承诺/ 值/ KIDU/ (/ 其中/ 配置/ 部分/ pcDU/ ∈/ PC/ )/ 、/ 承诺/ 密钥/ r/ 以及/ TCM/ 的/ 签名/ σ/ TCM/ ./ 如果/ S/ 拥有/ 无限/ 计算能力/ ,/ 则/ 可以/ 计算/ 出/ 协议/ 中/ g/ 相对/ 于/ h/ 的/ 离散/ 对数/ α/ ,/ 并/ 给出/ l/ 满足/ C/ =/ hl/ =/ gCSi/ +/ α/ Si/ ,/ Si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ n/ 为/ PC/ 集合/ 包含/ 的/ 元素/ 个数/ )/ ,/ 其中/ 任意/ Si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 均/ 可/ 作为/ 环/ 签名/ 私钥/ ,/ 因而/ S/ 可以/ 给出/ 相应/ 的/ 环/ 签名/ σ/ RING/ ./ 由此/ ,/ S/ 根据/ 承诺/ C/ (/ 虽然/ 不/ 清楚/ 被/ 承诺/ 值/ 和/ 承诺/ 密钥/ )/ 给出/ 了/ 完整/ 的/ 、/ 可/ 通过/ 验证/ 的/ 证明/ 三元组/ (/ C/ ,/ σ/ TCM/ ,/ σ/ RING/ )/ ./ 敌手/ A/ 得到/ 该/ 三元组/ 后/ ,/ 输出/ 索引/ 值/ i/ ,/ 表示/ 断定/ TCM/ 承诺/ 和/ 签名/ 的/ 密钥/ 信息/ 中/ 包含/ 的/ 是/ 配置/ pci/ ./ S/ 也/ 给出/ 和/ A/ 同样/ 的/ 输出/ ./ 如果/ A/ 可以/ 破坏/ 配置/ 隐私/ 性/ ,/ 即/ Adv/ =/ |/ Pr/ [/ i/ =/ DU/ ]/ -/ 1/ // n/ |/ 为/ 不可/ 忽略/ 量/ ,/ S/ 就/ 同样/ 以/ 不可/ 忽略/ 的/ 概率/ 猜测出/ 平台/ 配置/ 的/ 情况/ ./ 在/ 已经/ 假设/ 环/ 签名/ 方案/ 具有/ 无条件/ 签名者/ 模糊性/ 的/ 情况/ 下/ ,/ 这/ 相当于/ 破坏/ 了/ 承诺/ 方案/ 的/ 完美/ 隐藏/ 性/ ./ GamePRIV2/ ./ 假设/ 承诺/ 方案/ 具有/ 完美/ 的/ 隐藏/ 性/ [/ 16/ ]/ ./ 在/ GamePRIV2/ 中/ S/ 拥有/ 环/ 签名/ Oracle/ ,/ 可/ 对/ 任何/ 消息/ 签名/ ./ 不同于/ GamePRIV2/ ,/ S/ 在/ GamePRIV1/ 中/ 除了/ 模拟/ 数据/ 使用者/ 外/ 还/ 模拟/ TCM/ ,/ 因此/ 它/ 自己/ 随机/ 选择/ l/ ,/ 并/ 给出/ 承诺/ C/ =/ gl/ 以及/ 相关/ 签名/ σ/ TCM/ ,/ 然后/ S/ 请求/ 环/ 签名/ Oracle/ 给出/ σ/ RING/ ./ 敌手/ A/ 接收/ 到/ 证明/ 三元组/ 后/ ,/ 输出/ 索引/ 值/ i/ ,/ 表示/ 断定/ TCM/ 承诺/ 和/ 签名/ 的/ 密钥/ 信息/ 中/ 包含/ 的/ 是/ 配置/ pci/ ./ S/ 也/ 给出/ 和/ A/ 同样/ 的/ 输出/ ./ 如果/ A/ 可以/ 破坏/ 配置/ 隐私/ 性/ ,/ 即/ Adv/ 为/ 不可/ 忽略/ 量/ ,/ S/ 就/ 同样/ 以/ 不可/ 忽略/ 的/ 概率/ 猜测出/ 平台/ 配置/ 的/ 情况/ ./ 在/ 已经/ 假设/ 承诺/ 方案/ 具有/ 完美/ 隐藏/ 性/ 的/ 情况/ 下/ ,/ 这/ 相当于/ 破坏/ 了/ 环/ 签名/ 机制/ 的/ Page7/ 签名者/ 模糊性/ ./ 4.2/ 控制/ 实施/ 子系统/ 4.2/ ./ 1/ 工作/ 流程/ 如前所述/ ,/ 控制/ 实施/ 子系统/ 开始运行/ 前/ ,/ 数据/ 及/ 相应/ 的/ 策略/ 已经/ 加密/ 存储/ 于/ 本地/ 存储器/ ,/ 加密/ 密钥/ 封装/ 于/ 可信/ 配置/ ./ 当/ 用户/ 进程/ 试图/ 访问/ 数据/ 时/ ,/ 控制/ 实施/ 子系统/ 将/ 执行/ 以下/ 工作/ 流程/ ,/ 如图/ 5/ 所示/ :/ 系统/ 的/ 安全/ 存储模块/ 截获/ ;/ 1/ ./ 用户/ 进程/ 发起/ 数据/ 访问/ 请求/ ,/ 该/ 请求/ 被/ 内嵌/ 于/ 文件/ 2/ ./ 安全/ 存储模块/ 调用/ 策略/ 判决/ 模块/ ,/ 判断/ 此次/ 访问/ 请求/ 是否/ 符合/ 与/ 数据/ 关联/ 的/ 使用/ 控制策略/ ;/ 3/ ./ 如果/ 策略/ 规定/ 了/ 进程/ 状态/ 、/ 环境因素/ 等/ 需要/ 动态/ 度量/ 模块/ 执行/ 的/ 内容/ ,/ 则/ 策略/ 判决/ 模块/ 将/ 调用/ 动态/ 度量/ 模块/ ,/ 对/ 用户/ 进程/ 进行/ 完整性/ 状态/ 度量/ ;/ 4/ ./ 动态/ 度量/ 模块/ 将/ 返回/ 度量/ 结果/ ;/ 5/ ./ 策略/ 判决/ 模块/ 根据/ 动态/ 度量/ 结果/ 以及/ 其他/ 信息/ (/ 例如/ 环境因素/ 、/ 用户/ 角色/ )/ ,/ 进行/ 请求/ 判定/ 并/ 返回/ 结果/ ;/ 6/ ./ 如果/ 允许/ 访问/ ,/ 安全/ 存储模块/ 调用/ TCM/ // TPM/ 解封/ 密钥/ (/ 解封/ 时/ 平台/ 的/ 状态/ 必须/ 与/ 密钥/ 封装/ 绑定/ 的/ 状态/ 一致/ )/ 并/ 解密/ 数据/ ./ 如果/ 拒绝/ 访问/ ,/ 则/ 返回/ 出错/ 信息/ 给/ 用户/ 进程/ ./ 4.2/ ./ 2/ 系统/ 实现/ 4.2/ ./ 2.1/ 安全/ 存储模块/ 我们/ 以/ 修改/ Linux/ 内核/ 函数/ 的/ 方式/ 实现/ 安全/ 存储系统/ ./ 具体/ 地/ ,/ 为/ 读写/ 文件/ 及其/ 扩展/ 属性/ 的/ Linux/ 虚拟/ 文件系统/ 函数/ (/ 包括/ vfs/ _/ write/ (/ )/ 、/ vfs/ _/ read/ (/ )/ 、/ vfs/ __/ setxattr/ (/ )/ 和/ vfs/ _/ getxattr/ (/ )/ )/ 增加/ 加解密/ 和/ 完整性检查/ 功能/ ./ 加解密/ 算法/ 是/ 速度/ 快/ 、/ 使用/ 灵活/ 的/ 流/ 密码/ 体制/ ./ 数据/ 和/ 策略/ 的/ 完整性/ 标准值/ 存储/ 于/ 数据文件/ 的/ 扩展/ 属性/ 项/ ,/ 除非/ 主体/ 是/ 特定/ 进程/ ,/ 否则/ 所有/ 修改/ 标准值/ 的/ 操作/ 都/ 将/ 被/ 拦截/ ./ 此外/ 安全/ 存储模块/ 包装/ 了/ TCM/ // TPM/ 的/ 封装/ 功能/ ,/ 支持/ 可信/ 接收/ 模块/ 封装/ 密钥/ ./ 封装/ 功能/ 置于/ 内核/ 层/ 而/ 不是/ 由/ 可信/ 接收/ 模块/ 在/ 应用层/ 直接/ 完成/ ,/ 提高/ 了/ 系统/ 的/ 安全/ 和/ 可靠性/ ./ 4.2/ ./ 2.2/ 策略/ 判决/ 模块/ 策略/ 判决/ 模块/ 以/ Linux/ 内核模块/ 的/ 方式/ 实现/ 并/ 为/ 安全/ 存储模块/ 调用/ ./ 具体/ 地/ ,/ 我们/ 利用/ Linux/ 安全/ 模块/ (/ LSM/ )/ [/ 10/ ]/ 技术/ 安插在/ vfs/ _/ write/ (/ )/ 、/ vfs/ _/ read/ (/ )/ 、/ vfs/ __/ setxattr/ (/ )/ 和/ vfs/ _/ getxattr/ (/ )/ 中/ 钩子/ 函数/ ,/ 包括/ inode/ _/ permission/ (/ )/ ,/ file/ _/ permission/ (/ )/ ,/ inode/ _/ setxattr/ (/ )/ 和/ inode/ _/ removexattr/ (/ )/ ,/ 来/ 截获/ 文件/ 打开/ 、/ 读/ 文件/ 、/ 写/ 文件/ 、/ 写/ 扩展/ 属性/ 和/ 移除/ 扩展/ 属性/ 的/ 请求/ ,/ 同时/ 调用/ 策略/ 判决/ 模块/ ./ 策略/ 判决/ 模块/ 首先/ 根据/ 文件/ 的/ 扩展/ 属性/ 判定/ 当前/ 处理/ 的/ 是否/ 为/ 本文/ 系统/ 所/ 控制/ 的/ 文件/ ,/ 所有/ 该类/ 文件/ 的/ 扩展/ 属性/ 都/ 将/ 以/ 字符串/ “/ linux/ ./ tcwg/ ./ tuc/ ”/ 进行/ 标记/ ;/ 然后/ 调用/ 动态/ 度量/ 模块/ 获取/ 访问/ 文件/ 的/ 用户/ 进程/ 的/ 状态/ ;/ 最后/ 结合/ 其它/ 环境/ 、/ 时间/ 限制/ 和/ 使用/ 次数/ 限制/ 等/ 信息/ 给出/ 策略/ 判决/ 结果/ ./ 需要/ 注意/ 的/ 是/ ,/ 目前/ 我们/ 只/ 允许/ 特定/ 进程/ 操作/ 扩展/ 属性/ ,/ 进程/ 的/ 杂凑/ 值/ 是/ 判决/ 扩展/ 属性/ 操作/ 请求/ 的/ 唯一/ 条件/ ./ 4.2/ ./ 2.3/ 动态/ 度量/ 模块/ 动态/ 度量/ 模块/ 以/ Linux/ 内核模块/ 的/ 方式/ 实现/ ./ 其/ 度量/ 的/ 对象/ 既/ 可为/ 应用层/ 进程/ ,/ 也/ 可以/ 是/ 系统/ 内核/ ./ 对象/ 为/ 应用层/ 进程/ 时/ ,/ 度量/ 模块/ 首先/ 解析/ 进程/ 名称/ ,/ 获取/ 其/ 在/ 内存/ 中/ 的/ 程序段/ 等/ 各段/ 信息/ ;/ 然后/ 将/ 段/ 的/ 线性/ 地址/ 转换/ 为/ 物理地址/ ,/ 并/ 将/ 该/ 进程/ 的/ 段/ 内容/ 映射/ 至/ 度量/ 模块/ 自己/ 的/ 地址/ 空间/ ;/ 最后/ 使用/ TCM/ // TPM/ 对段/ 内容/ 进行/ 杂凑/ 计算/ 和/ 签名/ ./ 我们/ 没有/ 度量/ 进程/ 的/ 数据/ 段/ ,/ 因为/ 该段/ 会/ 在/ 进程/ 生命/ 期内/ 变化/ 而/ 很/ 难/ 确定/ 标准值/ ./ 对象/ 为/ 内核模块/ 时/ ,/ 需要/ 先/ 确定/ 包含/ 了/ 模块/ 重要/ 信息/ 的/ 名为/ Module/ 的/ 结构/ 体/ 的/ 情况/ ,/ 后续/ 步骤/ 与/ 度量/ 普通/ 进程/ 时/ 相同/ ./ 动态/ 度量/ 模块/ 本身/ 的/ 安全性/ 依赖于/ 两点/ :/ 一是/ 基于/ TCM/ // TPM/ 的/ 认证/ 启动/ 对/ 包含/ 动态/ 度量/ 模块/ 的/ 内核/ 进行/ 的/ 检验/ ,/ 二是/ 操作系统/ 自身/ 的/ 安全性/ ./ 由于/ 结合/ 了/ 软/ 、/ 硬件/ 度量/ 方式/ 的/ 优点/ ,/ 动态/ 度量/ 既/ 具有/ 较/ 好/ 的/ 安全性/ ,/ 同时/ 实现/ 较/ 简单/ ,/ 易用性/ 和/ 扩展性/ 较强/ ./ 4.3/ 讨论/ 下面/ 我们/ 说明/ 本文/ 系统/ 如何/ 支持/ 和/ 实现/ 了/ 使用/ 控制/ 模型/ 的/ 3/ 个/ 特点/ :/ 丰富/ 的/ 决策/ 因素/ 、/ 控制/ 的/ 连续性/ 以及/ 主客体/ 属性/ 的/ 变异性/ ,/ 并/ 讨论/ 提高/ 使用/ 控制系统/ 效力/ 的/ 一些/ 考虑/ ./ 我们/ 采用/ 的/ 策略/ 语言/ TXACML/ 不但/ 能/ 描述/ 用户/ 角色/ 等/ 传统/ 访问控制/ 因素/ ,/ 还/ 可/ 表达/ 用/ 控制/ 场景/ 常见/ 的/ 环境/ 条件/ 、/ 系统/ 义务/ 以及/ 使用/ 时间/ 、/ 次数/ 限制/ 等/ ./ 同时/ ,/ 策略/ 判定/ 模块/ 和/ 动态/ 度量/ 模块/ 可以/ 随时/ 获取/ 系统/ 环境/ 状态/ ,/ 忠实/ 实施/ 策略/ ./ 如此/ 本文/ 系统/ 在策/ Page8/ 略/ 和/ 实施/ 机制/ 两个/ 层次/ 均/ 支持/ 了/ 使用/ 控制/ 模型/ 的/ 第/ 1/ 个/ 特点/ :/ 丰富/ 的/ 决策/ 因素/ ./ 通过/ 钩子/ 函数/ ,/ 我们/ 截获/ 了/ 与/ 使用/ 文件/ 有关/ 的/ 请求/ ,/ 包括/ 打开/ 文件/ 、/ 读写/ 文件/ 、/ 设置/ 扩展/ 属性/ 和/ 删除/ 扩展/ 属性/ ,/ 用户/ 对/ 文件/ 的/ 任意/ 操作/ 都/ 受到/ 使用/ 控制系统/ 的/ 监控/ ./ 策略/ 判决/ 的/ 粒度/ 从/ 传统/ 的/ 以/ 访问/ 会话/ 为/ 单位/ ,/ 细化/ 至以/ 原子/ 操作/ 为/ 单位/ ,/ 任意/ 不/ 符合/ 策略/ 规定/ 的/ 文件/ 使用/ 都/ 将/ 在/ 第一/ 时间/ 被/ 发现/ ./ 如此/ 本文/ 系统/ 实现/ 了/ 连续/ 控制/ ./ 我们/ 将/ 主客体/ 属性/ (/ 例如/ 可以/ 播放/ 特定/ 音乐文件/ 的/ 次数/ )/ 作为/ 策略/ 的/ 一部分/ 存入/ 数据文件/ 的/ 扩展/ 属性/ 中/ ,/ 并/ 允许/ 特定/ 的/ 进程/ 对/ 其/ 进行/ 修改/ (/ 例如/ 播放/ 一次/ 音乐文件/ 后/ ,/ 用户/ 剩余/ 播放/ 次数/ 减/ 1/ )/ ,/ 实现/ 了/ 主客体/ 属性/ 的/ 变异性/ ./ 为了/ 防范/ 数据/ 使用者/ 的/ 行为/ ,/ 除了/ 检查/ 策略/ 涉及/ 的/ 、/ 与/ 访问/ 直接/ 相关/ 的/ 因素/ ,/ 还/ 必须/ 监视/ 策略/ 未/ 涉及/ 的/ 数据/ 使用者/ 所在/ 平台/ 的/ 运行状况/ ,/ 限制/ 可能/ 带来/ 攻击/ 的/ 用户/ 权限/ ./ 如果/ 忽略/ 上述/ 第/ 2/ 点/ ,/ 恶意/ 的/ 使用者/ (/ 特别/ 是/ 拥有/ 不/ 受限/ 权力/ 的/ 系统管理员/ )/ 可能/ 通过/ 非常规/ 的/ 手段/ 直接/ 绕开/ 策略/ 实施/ 机构/ ./ 例如/ 某/ 用户/ 首先/ 正常/ 访问/ 数据/ ,/ 然后/ 复制/ 内存/ 中/ 的/ 已经/ 解密/ 的/ 数据/ 明文/ ,/ 就/ 可以/ 得到/ 不/ 受控/ 的/ 数据/ 副本/ ,/ 设置/ 在/ 系统/ 调用/ 处/ 的/ 策略/ 实施/ 机构/ 将/ 无能为力/ ./ 虽然/ 根本/ 上/ 杜绝/ 上述情况/ 必须/ 限制/ 系统/ 用户/ 能力/ (/ UCLinux/ 就/ 严格/ 限制/ 了/ 管理员/ 可以/ 开启/ 的/ 程序/ 的/ 范围/ )/ ,/ 但/ 这种/ 办法/ 必将/ 极大/ 降低/ 系统/ 可用性/ ,/ 在/ 当前/ 条件/ 下/ 不/ 具备/ 可行性/ ./ 本文/ 系统/ 并未/ 显式/ 限制/ 管理员/ (/ 事实上/ 我们/ 尽量避免/ 使用/ 控制系统/ 影响/ 平台/ 整体/ 的/ 使用/ 感受/ )/ ,/ 而是/ 采用/ 认证/ 启动/ 、/ 启动/ 后/ 的/ 加载/ 时/ 度量/ 以及/ 将/ 密钥/ 封装/ 至/ 特定/ 平台/ 状态/ 的/ 方式/ 对/ 平台/ 运行/ 状态/ 进行/ 监视/ ,/ 一定/ 程度/ 上/ 限制/ 了/ 用户/ 的/ 恶意/ 行为/ ,/ 在/ 系统/ 可用性/ 和/ 安全性/ 的/ 权衡/ 中/ 倾向/ 了/ 前者/ ./ 5/ 性能/ 测试/ 及/ 分析/ 根据/ 以上/ 系统/ 设计/ ,/ 我们/ 初步/ 实现/ 了/ 基于/ 可信计算/ 的/ 分布式/ 使用/ 控制系统/ ,/ 并/ 对系统/ 的/ 控制/ 实施/ 子系统/ 的/ 性能/ 进行/ 了/ 测试/ ./ 实验/ 环境/ (/ 数据/ 使用者/ 平台/ 配置/ )/ 为/ IntelP43/ ./ 2GHzCPU/ ;/ 1GB/ 内存/ ;/ Ubuntu7/ ./ 10/ 发行版/ 操作系统/ ,/ 自行/ 编译/ Linux2/ ./ 6.20/ 内核/ ./ 实验/ 场景/ 为/ :/ 文档/ (/ ./ txt/ 格式/ )/ 的/ 使用/ 次数/ 受到限制/ ,/ 用户/ 进程/ 访问/ 文档/ 时/ 控制系统/ 对/ 文件/ 的/ 剩余/ 可/ 访问/ 次数/ 进行/ 检查/ ./ 这/ 是/ 对/ 数字/ 版权/ 管理/ 和/ 隐私/ 保护/ 领域/ 中/ 典型/ 应用/ 的/ 模拟/ ./ 图/ 6/ [/ 18/ ]/ 展示/ 了/ 上述/ 场景/ 下/ ,/ 读取/ 受控/ 文件/ 的/ 时间/ 增量/ (/ 相比/ 正常/ 系统/ 相同/ 操作/ 的/ 运行/ 时间/ )/ 与/ 文件大小/ 的/ 关系/ ./ 实验/ 结果表明/ ,/ 文件/ 较/ 小时/ 访问/ 时间/ 增量/ // 文件大小/ 约/ 为/ 4.5/ ms/ // M/ ,/ 文件/ 逐渐/ 增大/ 时/ 单位/ 时间/ 增量/ 有所/ 减小/ ./ 由于/ 控制系统/ 被/ 调用/ 次数/ 基本/ 正比/ 于/ 文件/ 操作/ 的/ 系统/ 调用/ 的/ 执行/ 次数/ ,/ 而/ 后者/ 与/ 文件大小/ 存在/ 近似/ 线性关系/ ,/ 故/ 时间/ 增量/ 与/ 文件大小/ 存在/ 图示/ 的/ 增长/ 关系/ ./ 从/ 实验/ 可知/ ,/ 在/ 典型/ 场景/ 的/ 控制系统/ 性能/ 处于/ 用户/ 可/ 接受/ 的/ 范围/ 内/ ./ 6/ 结束语/ 针对/ 分布式/ 环境/ 中/ 日益突出/ 的/ 使用/ 控制/ 问题/ ,/ 本文/ 给出/ 一种/ 基于/ 可信计算/ 技术/ 的/ 使用/ 控制/ 实施/ 系统/ ./ 可以/ 有效/ 支持/ 使用/ 控制/ 模型/ 的/ 特性/ ./ 实验/ 证明/ ,/ 本文/ 系统/ 性能/ 良好/ ,/ 可以/ 作为/ 一种/ 通用/ 的/ 使用/ 控制/ 实施/ 解决方案/ ./ 此外/ ,/ 我们/ 给出/ 一个/ 新式/ 的/ 数据/ 分发/ 协议/ ,/ 可以/ 同时/ 兼顾/ 数据/ 机密性/ 和/ 平台/ 配置/ 的/ 隐私/ 性/ ,/ 解决/ 了/ 以往/ 方案/ 暴露/ 平台/ 配置/ 而/ 带来/ 攻击/ 或/ 配置/ 歧视/ 的/ 问题/ ./ 未来/ 的/ 工作/ 主要/ 集中/ 于/ 以下/ 几个/ 方面/ :/ (/ 1/ )/ 进一步/ 完善/ 现有/ 系统/ ,/ 提高/ 文件/ 操作/ 性能/ ;/ (/ 2/ )/ 尝试/ 限制/ 系统管理员/ 的/ 部分/ 权限/ ,/ 如/ 直接/ 拷贝/ 内存/ 页/ 中/ 数据/ ,/ 防止/ 其/ 利用/ 正常/ 的/ 系统/ 功能/ 偷窥/ 数据/ ;/ (/ 3/ )/ 研究/ 新/ 的/ 策略/ 实施/ 构架/ ,/ 例如/ 将/ 实施/ 结构/ 置入/ 虚拟机/ 监控/ 层/ ,/ 在/ 方案设计/ 层面/ 获得/ 更/ 高/ 的/ 自我/ 保护/ 和/ 不可/ 绕过/ 性/ ;/ (/ 4/ )/ 研究/ 更加/ 完善/ 的/ 策略/ 描述语言/ ,/ 支持/ 更加/ 丰富/ 的/ 使用/ 控制/ 需求/ ./ 致谢/ 感谢/ 信息安全/ 国家/ 重点/ 实验室/ 的/ 汪丹/ 、/ 周玲丽/ 在/ 可信/ 接收/ 和/ 分发/ 模块/ ,/ 聂晓伟/ 在/ 策略/ 生成/ 和/ 解析/ 模块/ 以及/ 实验/ 部分/ ,/ 李昊/ 在/ 安全/ 存储模块/ ,/ 于/ 爱民/ 在/ 策略/ 判定/ 模块/ ,/ 胡浩/ 、/ 刘孜文/ 在/ 动态/ 度量/ 和/ 加载/ 时/ 度量/ 模块/ 的/ 工作/ !/ 

