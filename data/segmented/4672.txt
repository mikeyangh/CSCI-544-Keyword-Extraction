Page1/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ 的/ 安全性/ 分析/ 及/ 改进/ 杨波/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 陕西/ 师范大学/ 计算机科学/ 学院/ 西安/ 710119/ )/ 2/ )/ (/ 保密/ 通信/ 重点/ 实验室/ 成都/ 610041/ )/ 3/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100093/ )/ 摘要/ 由于/ 现有/ 的/ 基于/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ 存在/ 计算/ 效率/ 低/ 的/ 不足/ ,/ 因此/ 一种/ 不/ 使用/ 双线性/ 映射/ 的/ 新/ 的/ 无/ 证书/ 签密/ 方案/ 由/ Zhu/ 等/ 人/ 提出/ ;/ 同时/ ,/ 在/ 随机/ 谕言机/ 模型/ 中/ 对/ 该/ 方案/ 的/ 安全性/ 进行/ 了/ 证明/ ./ 该文/ 通过/ 构造/ 具体/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ 攻击/ 算法/ ,/ 证明/ 了/ Zhu/ 等/ 人/ 所/ 提出/ 的/ 方案/ 无法/ 满足/ 其所/ 声称/ 的/ 机密性/ 和/ 对/ 伪造/ 性/ ;/ 针对/ 上述/ 问题/ ,/ 该文/ 提出/ 了/ 安全/ 高效/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 并/ 在/ 随机/ 谕言机/ 模型/ 下/ 基于/ 计算/ 性/ Diffie/ -/ Hellman/ 困难/ 问题/ 和/ 离散/ 对数/ 困难/ 问题/ 证明/ 了/ 该文/ 所提/ 方案/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ ;/ 相较/ 于/ 其他/ 无/ 证书/ 签密/ 方案/ ,/ 该文/ 所提/ 方案/ 的/ 安全性/ 和/ 计算/ 效率/ 更优/ ./ 关键词/ 无/ 证书/ 签密/ 方案/ ;/ 随机/ 谕言机/ 模型/ ;/ 无/ 双线性/ 配对/ ;/ 离散/ 对数/ ;/ 计算/ 性/ Diffie/ -/ Hellman/ ;/ 网络空间/ 安全/ ;/ 信息安全/ 1/ 引言/ 认证/ 性/ 和/ 机密性/ 是/ 安全/ 通信/ 系统/ 的/ 基本/ 要求/ ,/ 其中/ ,/ 消息/ 的/ 认证/ 性/ 通常/ 由/ 签名/ 完成/ ,/ 而/ 消息/ 的/ 机密性/ 则/ 通过/ 加密/ 来/ 实现/ ,/ 然而/ 传统/ 的/ “/ 先/ 签名/ 后/ 加密/ ”/ 方式/ 存在/ 着/ 计算/ 效率/ 低/ 的/ 不足/ ;/ 文献/ [/ 1/ ]/ 首次/ 提出/ 了/ 签密/ 的/ 概念/ ,/ 即/ 在/ 一个/ 逻辑/ 步骤/ 内/ 同时/ 完成/ 签名/ 和/ 加密/ 操作/ ,/ 该/ 机制/ 具有/ 计算成本/ 和/ 通信/ 成本/ 都/ 比较/ 低/ 的/ 优点/ ,/ 是/ 数据/ 信息/ 较为理想/ 的/ 一种/ 安全/ 传输/ 方法/ ./ 无/ 证书/ 公钥/ 密码/ 系统/ (/ CL/ -/ PKC/ )/ 是/ 由/ Al/ -/ Riyami/ 和/ Paterson/ 在/ 文献/ [/ 2/ ]/ 中/ 提出/ 的/ ./ 在/ CL/ -/ PKC/ 中/ ,/ 用户/ 基于/ 密钥/ 生成/ 中心/ (/ KeyGenerationCenter/ ,/ KGC/ )/ 为/ 其/ 计算/ 出/ 的/ 部分/ 私钥/ 和/ 随机/ 选取/ 的/ 秘密/ 值/ 生成/ 用户/ 的/ 完整/ 私钥/ ;/ 公钥/ 由/ 用户/ 的/ 秘密/ 值/ 、/ 身份/ 信息/ 和/ 系统/ 参数/ 计算/ 得出/ ./ CL/ -/ PKC/ 克服/ 了/ 公钥/ 证书/ 的/ 管理/ 问题/ ,/ 同时/ 消除/ 了/ 用户/ 密钥/ 的/ 托管/ 问题/ [/ 3/ ]/ ,/ 提高/ 了/ 密码/ 系统/ 的/ 运行/ 效率/ ./ 自/ Barbosa/ 等/ 人/ [/ 4/ ]/ 提出/ 无/ 证书/ 签密/ 的/ 概念/ 以来/ ,/ 关于/ 无/ 证书/ 签密/ 方案/ 的/ 研究/ 已/ 成为/ 密码学/ 领域/ 当前/ 的/ 研究/ 热点/ 之一/ ./ 随着/ 研究/ 工作/ 的/ 逐渐/ 深入/ ,/ 国内外/ 众多/ 学者/ 分别/ 提出/ 了/ 新/ 的/ 签密/ 方案/ [/ 4/ -/ 12/ ]/ ./ 文献/ [/ 4/ ]/ 提出/ 了/ 一种/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 该/ 方案/ 具有/ 前向/ 安全性/ ,/ 但/ 未/ 进行/ 正式/ 的/ 安全性/ 证明/ ;/ 文献/ [/ 5/ ]/ 利用/ 双线性/ 映射/ 构造/ 了/ 一种/ 无/ 证书/ 签密/ 方案/ ,/ 虽然/ ,/ Sharmila/ 等/ 人/ 指出/ 该/ 方案/ 在/ 机密性/ 上/ 存在/ 不足/ ①/ ,/ 但是/ 并未/ 提出/ 相应/ 的/ 改进/ 方案/ ;/ 文献/ [/ 6/ ]/ 在/ 随机/ 谕言机/ 模型/ 下/ 对/ 所/ 提出/ 的/ 无/ 证书/ 签密/ 机制/ 进行/ 了/ 安全性/ 证明/ ,/ 但/ 该/ 方案/ 需要/ 进行/ 多次/ 双线性/ 映射/ 运算/ ./ 虽然/ 文献/ [/ 4/ -/ 6/ ]/ 分别/ 提出/ 了/ 相应/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 但/ 各/ 方案/ 中均/ 使用/ 双线性/ 映射/ 进行/ 密钥/ 的/ 生成/ 、/ 签密/ 计算/ 或/ 验证/ 签密/ 密文/ 的/ 合法性/ ,/ 各/ 方案/ 的/ 运算量/ 较大/ ,/ 都/ 存在/ 着/ 计算/ 效率/ 低/ 的/ 不足/ ;/ 同时/ ,/ 部分/ 方案/ 也/ 存在/ 着/ 安全性/ 缺陷/ ./ 针对/ 双线性/ 映射/ 计算/ 复杂度/ 较/ 高/ 的/ 问题/ ,/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ [/ 7/ -/ 12/ ]/ 相继/ 被/ 人/ 提出/ ./ 文献/ [/ 7/ -/ 8/ ]/ 分别/ 提出/ 了/ 无需/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 并/ 在/ 随机/ 谕言机/ 模型/ 下/ 基于/ 计算/ 性/ Diffie/ -/ Hellman/ (/ ComputationalDiffie/ -/ Hellman/ ,/ CDH/ )/ 问题/ 和/ 离散/ 对数/ (/ DiscreteLogarithm/ ,/ DL/ )/ 问题/ 的/ 困难性/ 对/ 相应/ 方案/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ 进行/ 了/ 证明/ ,/ 同时/ 对/ 相应/ 方案/ 的/ 执行/ 效率/ 进行/ 了/ 分析/ ;/ 文献/ [/ 9/ ]/ 通过/ 分析/ 发现/ 文献/ [/ 8/ ]/ 无法/ 满足/ 其所/ 声称/ 的/ 不可/ 伪造/ 性/ ,/ 并/ 对/ 该/ 方案/ 进行/ 了/ 改进/ ;/ 在/ 文献/ [/ 10/ -/ 12/ ]/ 中/ 分别/ 提出/ 了/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 并/ 在/ 随机/ 谕言机/ 模型/ 下/ 基于/ 相应/ 的/ 困难性/ 问题/ 证明/ 了/ 各自/ 方案/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ ;/ 文献/ [/ 11/ ]/ 提出/ 了/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 代理/ 签密/ 机制/ ,/ 并/ 分析/ 了/ 计算/ 和/ 通信/ 效率/ 以及/ 安全性/ ./ 文献/ [/ 7/ -/ 12/ ]/ 均/ 未/ 使用/ 双线性/ 映射/ ,/ 一定/ 程度/ 上/ 提高/ 了/ 方案/ 的/ 计算/ 效率/ ,/ 但/ 本文/ 分析/ 发现/ 文献/ [/ 11/ -/ 12/ ]/ 中/ 的/ 点/ 乘/ 运算/ 次数/ 较/ 多/ ,/ 导致/ 计算/ 效率/ 依然/ 较/ 低/ ;/ 并且/ 文献/ [/ 7/ -/ 10/ ]/ 的/ 方案/ 在/ 安全性/ 方面/ 均/ 存在/ 缺陷/ ;/ 而/ 文献/ [/ 11/ ]/ 的/ 密文/ 长度/ 较长/ ,/ 使得/ 该/ 方案/ 的/ 通信/ 开销/ 较大/ ./ 本文/ 通过/ 构造/ 具体/ 的/ 不可/ 伪造/ 性/ 和/ 机密性/ 攻击/ 算法/ ,/ 证明/ 了/ 文献/ [/ 7/ ]/ 的/ 方案/ 无法/ 满足/ 其所/ 声称/ 的/ 对/ / I/ 类/ 敌手/ 的/ 不可/ 伪造/ 性/ 和/ 对/ 任意/ 敌手/ 的/ 机密性/ ;/ 同时/ ,/ 指出/ 文献/ [/ 8/ -/ 10/ ]/ 中/ 的/ 方案/ 均/ 不/ 满足/ 对/ 任意/ 敌手/ 的/ 机密性/ ;/ 并且/ 通过/ 分析/ 发现/ 文献/ [/ 11/ -/ 12/ ]/ 中/ 的/ 相关/ 方案/ 在/ 计算/ 效率/ 方面/ 存在/ 一定/ 的/ 不足/ ;/ 遗憾/ 的/ 是/ 文献/ [/ 7/ -/ 8/ ]/ 的/ 方案/ 没/ 能/ 满足/ 其所/ 声称/ 的/ 机密性/ 和/ / I/ 类/ 敌手/ 的/ 不可/ 伪造/ 性/ ,/ 但/ 上述/ 方案/ 新颖/ 的/ 设计/ 对/ 思路/ ,/ 确实/ 为/ 不/ 使用/ 双线性/ 映射/ 运算/ 的/ 无/ 证书/ 签密/ 方案/ 的/ 设计/ 提供/ 了/ 新/ 的/ 设计/ 思路/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 提出/ 了/ 无需/ 进行/ 双线性/ 映射/ 运算/ 的/ 安全/ 高效/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 并/ 在/ 随机/ 谕言机/ 模型/ 下/ 基于/ CDH/ 和/ DL/ 假设/ 证明/ 了/ 该/ 方案/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ ;/ 相比/ 于/ 现有/ 的/ 无/ 证书/ 签密/ 方案/ [/ 4/ -/ 12/ ]/ ,/ 本文/ 方案/ 的/ 安全性/ 和/ 计算/ 效率/ 更优/ ./ 2/ 预备/ 知识/ 本/ 节/ 介绍/ DL/ 假设/ 、/ CDH/ 假设/ 、/ 无/ 证书/ 签密/ 方案/ 的/ 基本/ 构成/ 算法/ 和/ 安全/ 模型/ 等/ 相关/ 基础知识/ ./ 2.1/ 相关/ 困难性/ 问题/ 离散/ 对数/ (/ DL/ )/ 问题/ :/ 令/ p/ 和/ q/ 是/ 满足条件/ p/ |/ q/ -/ 1/ 的/ 两个/ 大/ 素数/ ,/ 设/ g/ 是/ 群/ Z/ / 元/ ,/ 给定/ 元组/ g/ ,/ gb/ ∈/ Z/ / 题/ 的/ 目的/ 是/ 计算/ b/ ./ 算法/ 的/ 概率/ 为/ AdvDL/ (/ 其中/ 概率/ 来源于/ 算法/ 上/ 的/ 随机/ 选取/ ./ ①/ SharmilaDS/ ,/ VivekSS/ ,/ PanduRC/ ./ OnthesecurityofPage3/ 定义/ 1/ ./ DL/ 假设/ ./ 对于/ 任意/ 的/ 概率/ 多项式/ 时间/ 算法/ 计算/ 性/ Diffie/ -/ Hellman/ (/ CDH/ )/ 问题/ :/ 令/ p/ 和/ q/ 是/ 满足条件/ p/ |/ q/ -/ 1/ 的/ 两个/ 大/ 素数/ ,/ 设/ g/ 是/ 群/ Z/ / 阶为/ q/ 的/ 任意/ 生成元/ ,/ 给定/ 元组/ g/ ,/ ga/ ,/ gb/ ∈/ Z/ / a/ ,/ b/ ∈/ Z/ / 算法/ 题/ 的/ 概率/ 为/ AdvCDH/ (/ 其中/ 概率/ 来源于/ 算法/ Z/ / q/ 上/ 的/ 随机/ 选取/ ./ 定义/ 2/ ./ CDH/ 假设/ ./ 对于/ 任意/ 的/ 概率/ 多项式/ 时间/ 算法/ 2.2/ 安全/ 模型/ 根据/ 文献/ [/ 13/ ]/ 中/ 的/ 安全/ 模型/ ,/ 本文/ 将/ 无/ 证书/ 签密/ 方案/ 的/ 攻击/ 敌手/ 分为/ / I/ :/ 此类/ 敌手/ 无法/ 掌握/ 系统/ 的/ 主/ 密钥/ ,/ 但/ 其/ 具有/ 替换/ 合法/ 用户/ 公钥/ 的/ 能力/ ,/ 则/ 用户/ ./ 本文/ 中/ 攻击/ 方案/ 机密性/ 的/ 敌手/ ,/ 性/ 的/ 敌手/ ./ / II/ :/ 此类/ 敌手/ 可/ 掌握/ 系统/ 的/ 主/ 密钥/ ,/ 但/ 其/ 不/ 具有/ 替换/ 合法/ 用户/ 公钥/ 的/ 能力/ ,/ 则/ KGC/ ./ 本文/ 中是/ 攻击/ 方案/ 机密性/ 的/ 敌手/ ,/ 造性/ 的/ 敌手/ ./ 文献/ [/ 7/ ,/ 13/ ]/ 详细/ 地/ 介绍/ 了/ 无/ 证书/ 签密/ 方案/ 在/ / II/ 两类/ 敌手/ 适应性/ 地/ 选择/ 消息/ 攻击/ 下/ 不可/ 伪/ / I/ 和/ 造性/ 和/ 适应性/ 地/ 选择/ 密文/ 攻击/ 下/ 机密性/ 的/ 定义/ 及/ 相应/ 的/ 游戏/ ,/ 本文/ 不再/ 赘述/ ,/ 安全/ 模型/ 及/ 游戏/ 的/ 具体/ 定义/ 详见/ 文献/ [/ 7/ ,/ 13/ ]/ ./ 3Zhu/ 等/ 人/ 方案/ 的/ 安全性/ 分析/ 本/ 节/ 构造/ 具体/ 的/ 不可/ 伪造/ 性/ 和/ 机密性/ 攻击/ 算法/ ,/ 证明/ 文献/ [/ 7/ ]/ 中/ 的/ 方案/ 无法/ 满足/ 其/ 声称/ 的/ 不可/ 伪造/ 性/ 和/ 机密性/ ./ 3.1/ 不可/ 伪造/ 性/ 攻击/ 令/ 用户/ Alice/ 和/ Bob/ 分别/ 为/ 文献/ [/ 7/ ]/ 方案/ 中/ 的/ 发送者/ 和/ 接收者/ ,/ 则/ Alice/ 和/ Bob/ 的/ 公私/ 钥对/ 分别/ 为/ 〈/ PKa/ =/ (/ wa/ ,/ ua/ )/ ,/ SKa/ =/ (/ ta/ ,/ za/ )/ 〉/ 和/ 〈/ PKb/ =/ (/ wb/ ,/ ub/ )/ ,/ SKb/ =/ (/ tb/ ,/ zb/ )/ 〉/ ./ / I/ 类/ 敌手/ Dave/ (/ Dave/ 为/ 攻击/ 方案/ 不可/ 伪造/ 性/ 的/ 敌手/ )/ 在/ 掌握/ Alice/ 的/ 公钥/ PKa/ =/ (/ wa/ ,/ ua/ )/ 后/ ,/ 使用/ 伪造/ 公钥/ 替代/ Alice/ 的/ 公钥/ 去/ 生成/ 合法/ 的/ 伪造/ 签密/ 密文/ ./ 敌手/ Dave/ 与/ Bob/ 间/ 的/ 消息/ 交互/ 过程/ 如下/ 所示/ :/ (/ 1/ )/ 敌手/ Dave/ 伪造/ Alice/ 的/ 公钥/ ①/ Dave/ 掌握/ Alice/ 的/ 公钥/ PKa/ =/ (/ wa/ ,/ ua/ )/ 和/ 身份/ 标识/ IDa/ 等/ 公开/ 信息/ 后/ ,/ 基于/ 上述/ 公开/ 信息/ 计算/ 部分/ 伪造/ 公钥/ ua/ =/ (/ wayH1/ ②/ Dave/ 使用/ 伪造/ 公钥/ PKa/ =/ (/ wa/ ,/ ua/ )/ 代替/ Alice/ 的/ 原始/ 公钥/ PKa/ =/ (/ wa/ ,/ ua/ )/ ,/ 此时/ Bob/ 将/ 认为/ Alice/ 的/ 公钥/ 就/ 为/ PKa/ =/ (/ wa/ ,/ ua/ )/ ./ (/ 2/ )/ 敌手/ Dave/ 伪造/ Alice/ 的/ 签密/ 密文/ Dave/ 随机/ 选取/ 秘密/ 数/ r/ ∈/ Z/ / 然后/ 计算/ h1/ =/ H1/ (/ IDb/ ,/ wb/ )/ ,/ h/ =/ H2/ (/ IDa/ ,/ R/ ,/ m/ )/ ;/ 最后/ 计算/ S/ =/ r/ (/ h/ )/ -/ 1/ ,/ C/ =/ H3/ (/ ubwbyh1/ )/ r/ / m/ ./ 发送/ 密文/ 消息/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 给/ Bob/ ./ (/ 3/ )/ Bob/ 验证/ 签密/ 密文/ 的/ 合法性/ Bob/ 收到/ 密文/ σ/ 后/ ,/ 对/ σ/ 进行/ 解/ 签密/ 验证/ ./ 若/ 验证/ 证明/ 密文/ σ/ 是/ 合法/ 密文/ ,/ 则/ Dave/ 伪造/ 了/ Alice/ 的/ 合法/ 签密/ 密文/ ,/ 即/ Dave/ 伪造/ 成功/ ;/ 否则/ ,/ Dave/ 伪造/ 失败/ ./ 定理/ 1/ ./ / I/ 类/ 敌手/ Dave/ 伪造/ 了/ Alice/ 的/ 合法/ 签密/ 密文/ ./ 证明/ ./ Bob/ 收到/ 签密/ 密文/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 后/ ,/ 密文/ 的/ 合法性/ 验证/ 过程/ 如下/ :/ ①/ 计算/ h1/ =/ H1/ (/ IDa/ ,/ wa/ )/ ;/ ②/ 计算/ V/ =/ (/ uawayh1gh/ )/ S/ (/ Zb/ +/ tbm/ =/ H3/ (/ V/ )/ / C/ ;/ 由于/ uawayh1gh/ =/ (/ wayH1/ (/ wayH1/ 则/ 有/ V/ =/ (/ uawayh1gh/ )/ S/ (/ zb/ +/ tb/ )/ =/ gr/ (/ zb/ +/ sb/ +/ xh1gr/ (/ zb/ +/ tb/ 中/ h1/ =/ H1/ (/ IDb/ ,/ wb/ )/ )/ ;/ 由/ 上述/ 计算/ 可知/ ③/ 验证/ h/ =/ H2/ (/ IDa/ ,/ (/ uawayh1gh/ )/ S/ ,/ m/ )/ 是否/ 成立/ ,/ 若/ 等式/ 成立/ ,/ 则/ Bob/ 认为/ 签密/ σ/ 是/ 由/ Alice/ 生成/ 的/ 合法/ 签密/ 密文/ ./ 由于/ (/ uawayh1gh/ )/ S/ =/ ghS/ =/ gr/ =/ R/ ;/ 则/ 有/ 由/ 等式/ (/ 1/ )/ 和/ (/ 2/ )/ 可知/ ,/ 伪造/ 密文/ σ/ 通过/ 了/ 密文/ 接收者/ Bob/ 的/ 合法性/ 验证/ ,/ 则/ 伪造/ Alice/ 合法/ 签密/ 密文/ 的/ 能力/ ./ Page4/ 在/ 验证/ 密文/ 合法性/ 时/ ,/ 参数/ h1/ 由/ IDa/ 和/ wa/ 通过/ 哈希/ 计算/ 等到/ ,/ 部分/ 公钥/ za/ 与/ h1/ 之间/ 未/ 形成/ 一一对应/ 的/ 关系/ ,/ 即/ 对/ za/ 的/ 改变/ 并未/ 对/ 参数/ h1/ 造成/ 影响/ ,/ / I/ 类/ 敌手/ 可/ 根据/ 验证/ 等式/ 构造/ 替代/ 公钥/ ,/ 完成/ 不则/ 可/ 伪造/ 性/ 攻击/ ./ 3.2/ 机密性/ 攻击/ 设/ 敌手/ Smart/ 是/ 方案/ 机密性/ 的/ 敌手/ )/ ./ 由/ 文献/ [/ 7/ ]/ 中/ 游戏/ 1/ 和/ 2/ 可知/ :/ Smart/ 向/ 谕言机/ 发送/ 的/ 挑战/ 信息/ 包括/ :/ 两个/ 等长/ 的/ 消息/ {/ m0/ ,/ m1/ }/ 和/ 两个/ 身份/ 标识/ {/ IDS/ ,/ IDV/ }/ ,/ 其中/ 不能/ 对/ IDV/ 执行/ 部分/ 密钥/ 提取/ 询问/ 或/ 私钥/ 提取/ 询问/ ./ 但/ 在/ 挑战/ 阶段/ ,/ Smart/ 可/ 询问/ 谕言机/ 获知/ IDS/ 的/ 公钥/ PKS/ =/ (/ wS/ ,/ uS/ )/ ./ 谕言机/ 收到/ Smart/ 的/ 签密/ 询问/ 后/ ,/ 随机/ 选取/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 并/ 生成/ mb/ 的/ 挑战/ 密文/ σ/ / =/ (/ h/ / ,/ S/ / ,/ C/ / )/ ,/ 当/ Smart/ 收到/ 谕言机/ 的/ 挑战/ 密文/ σ/ / 后/ ,/ Smart/ 首先/ 对/ b/ 做出/ 猜测/ ,/ 令/ b/ =/ 0/ ,/ 然后/ 验证/ 等式/ (/ 3/ )/ 是否/ 成立/ ,/ 若/ 成立/ 则/ 说明/ 消息/ m0/ 是/ 挑战/ 密文/ σ/ / 所/ 对应/ 的/ 明文/ ,/ 否则/ m1/ 是/ σ/ / 所/ 相对/ 应/ 的/ 明文/ ./ 其中/ 公开/ 参数/ y/ =/ g/ 由此可见/ 文献/ [/ 7/ ]/ 方案/ 对/ 有/ 密文/ 机密性/ ./ 使用/ 上述/ 机密性/ 攻击/ 算法/ 同样/ 可/ 证明/ 文献/ [/ 8/ -/ 10/ ]/ 中/ 的/ 方案/ 均/ 无法/ 满足/ 其所/ 声称/ 的/ 对/ 任意/ 敌手/ 的/ 机密性/ ./ 密文/ 的/ 合法性/ 验证/ 过程/ 中/ 的/ 相关/ 参数均/ 为/ 发送者/ 的/ 公开/ 信息/ ,/ 即/ 明文/ m/ 与/ 部分/ 密文/ h/ 之间/ 形成/ 了/ 对应/ 关系/ ,/ 因此/ 敌手/ 可/ 通过/ 尝试/ 验证/ 的/ 策略/ 完成/ 机密性/ 攻击/ ./ 4/ 本文/ 签密/ 方案/ 4.1/ 方案/ 描述/ 本/ 节/ 提出/ 了/ 安全/ 高效/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 具体/ 细节/ 描述/ 如下/ :/ (/ 1/ )/ 系统/ 建立/ 阶段/ (/ Setup/ )/ 系统/ 初始化/ 阶段/ ,/ KGC/ 进行/ 如下/ 操作/ :/ ①/ 输入/ 安全/ 参数/ k/ ,/ 输出/ 满足条件/ p/ |/ q/ -/ 1/ 的/ 两个/ 大/ 素数/ p/ 和/ q/ ./ g/ 为群/ Z/ / 成元/ ;/ ②/ 定义/ 抗/ 碰撞/ 的/ 安全/ 哈希/ 函数/ :/ H1/ :/ {/ 0/ ,/ 1/ }/ L1/ ×/ Z/ / p/ ×/ Z/ / p/ →/ Z/ / H3/ :/ Z/ / p/ →/ {/ 0/ ,/ 1/ }/ L2/ +/ |/ Zp/ →/ Z/ / Z/ / 明文/ 消息/ 的/ 长度/ ,/ |/ Z/ / ③/ 定义/ “/ / ”/ 为/ 异或/ 运算/ ,/ “/ ‖/ ”/ 为/ 连接符/ ;/ ④/ 随机/ 选取/ 系统/ 主/ 密钥/ s/ ∈/ Z/ / 公开/ Params/ =/ 〈/ p/ ,/ q/ ,/ Z/ / / ,/ ‖/ 〉/ ,/ 秘密/ 保存/ 主/ 密钥/ s/ ./ (/ 2/ )/ 用户/ 密钥/ 生成/ (/ KeyExtract/ )/ 用户/ IDi/ 的/ 密钥/ 生成/ 过程/ 如下/ 所述/ :/ ①/ 随机/ 选取/ 秘密/ 值/ xi/ ∈/ Z/ / 身份/ 标识/ IDi/ 和/ 公开/ 参数/ Xi/ 给/ KGC/ ;/ ②/ 给定/ 用户/ 身份/ 标识/ IDi/ 及/ 公开/ 参数/ Xi/ ,/ KGC/ 随机/ 选取/ 秘密/ 数/ ri/ ∈/ Z/ / sH1/ (/ IDi/ ,/ Xi/ ,/ Yi/ )/ ,/ 通过/ 安全/ 信道/ 将/ yi/ 和/ Yi/ 返回/ 给/ 用户/ IDi/ ,/ 其中/ yi/ 为/ 用户/ 的/ 部分/ 私钥/ ,/ Yi/ 为/ 用户/ 的/ 部分/ 公钥/ ./ 因此/ ,/ 用户/ IDi/ 的/ 公私/ 钥对/ 为/ 〈/ PKi/ =/ (/ Xi/ ,/ Yi/ )/ ,/ SKi/ =/ (/ xi/ ,/ yi/ )/ 〉/ ./ 设/ 本文/ 签密/ 密文/ 发送者/ Alice/ (/ 其/ 身份/ 标识/ 为/ IDa/ )/ 和/ 密文/ 接收者/ Bob/ (/ 其/ 身份/ 标识/ 为/ IDb/ )/ 的/ 公私/ 钥对/ 分别/ 为/ 〈/ PKA/ =/ (/ Xa/ ,/ Ya/ )/ ,/ SKA/ =/ (/ xa/ ,/ ya/ )/ 〉/ 和/ 〈/ PKB/ =/ (/ Xb/ ,/ Yb/ )/ ,/ SKB/ =/ (/ xb/ ,/ yb/ )/ 〉/ ./ Alice/ 和/ Bob/ 通过/ 等式/ gya/ =/ YaPgyb/ =/ YbP/ 部分/ 公钥/ 的/ 正确性/ ./ (/ 3/ )/ 签密/ (/ Signcrypt/ )/ 若/ 发送/ 消息/ m/ 给/ Bob/ ,/ Alice/ 则/ 进行/ 下述/ 操作/ ./ ①/ 随机/ 选取/ 秘密/ 数/ a/ ∈/ Z/ / ②/ 计算/ hB/ 和/ U/ =/ d/ (/ xa/ +/ ya/ )/ +/ af/ (/ 其中/ d/ =/ H4/ (/ IDa/ ,/ m/ ,/ Xa/ ,/ R/ )/ ,/ f/ =/ H4/ (/ IDa/ ,/ m/ ,/ Ya/ ,/ R/ )/ )/ ;/ ③/ 生成/ 签密/ 密文/ C/ =/ (/ m/ ‖/ U/ )/ / H3/ (/ V/ )/ ,/ h/ =/ H2/ (/ IDa/ ,/ R/ ,/ C/ )/ 和/ S/ =/ a/ (/ xa/ +/ ya/ +/ h/ )/ -/ 1/ ;/ ④/ 发送/ 签密/ 密文/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 给/ 接收者/ Bob/ ./ (/ 4/ )/ 签密/ 验证/ (/ UnSigncrypt/ )/ 收到/ 密文/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 后/ ,/ Bob/ 进行/ 下述/ 操作/ ./ ①/ 计算/ hA/ 和/ V/ =/ R/ (/ xb/ +/ yb/ ②/ 恢复/ 明文/ 消息/ m/ ‖/ U/ =/ C/ / H3/ (/ V/ )/ ;/ ③/ 验证/ 等式/ gU/ =/ (/ XaYaPH4/ (/ IDa/ ,/ m/ ,/ Xa/ ,/ R/ )/ ,/ f/ =/ H4/ (/ IDa/ ,/ m/ ,/ Ya/ ,/ R/ )/ )/ 和/ h/ =/ H2/ (/ IDa/ ,/ R/ ,/ C/ )/ 是否/ 成立/ ,/ 若/ 等式/ 成立/ ,/ 则/ 接收/ 消息/ m/ ;/ 否则/ 输出/ ⊥/ ./ Page54/ ./ 2/ 正确性/ 定理/ 2/ ./ 密文/ 接收者/ 可以/ 从/ 密文/ 消息/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 中/ 恢复/ 出/ 原始/ 的/ 明文/ 消息/ ,/ 并且/ 能/ 验证/ 发送者/ 身份/ 的/ 合法性/ ./ 证明/ ./ Bob/ 的/ 密文/ 解密/ 过程/ 如下/ 所述/ :/ ①/ 计算/ V/ =/ (/ g/ 其中/ ,/ hA/ ②/ 计算/ V/ =/ (/ g/ 其中/ ,/ hB/ ③/ 因此/ m/ ‖/ U/ =/ (/ m/ ‖/ U/ )/ / H3/ (/ V/ )/ / H3/ (/ V/ )/ ,/ 其中/ V/ =/ V/ ./ 因此/ ,/ 密文/ 接收者/ 能够/ 基于/ 发送者/ 公钥/ 还原/ 出/ 原始/ 的/ 通信/ 消息/ ,/ 同时/ 验证/ 消息/ 发送者/ 的/ 身份/ ./ 证毕/ ./ 定理/ 3/ ./ 密文/ 接收者/ 能够/ 验证/ 签名/ 的/ 合法性/ ./ 证明/ ./ Bob/ 的/ 签名/ 合法性/ 验证/ 过程/ 如下/ 所述/ :/ ①/ 计算/ R/ =/ (/ XaYaP/ ②/ 计算/ gU/ =/ gd/ (/ xa/ +/ ya/ 其中/ ,/ R/ =/ R/ ,/ d/ =/ H4/ (/ IDa/ ,/ m/ ,/ Xa/ ,/ R/ )/ =/ d/ ,/ f/ =/ H4/ (/ IDa/ ,/ m/ ,/ Ya/ ,/ R/ )/ =/ f/ ./ ③/ 则/ 有/ 等式/ gU/ =/ (/ XaYaPH2/ (/ IDa/ ,/ R/ ,/ C/ )/ 成立/ ./ 因此/ ,/ Bob/ 能够/ 验证/ 签名/ 的/ 正确性/ ,/ 即/ Bob/ 能够/ 完成/ 对/ 密文/ σ/ 的/ 合法性/ 及/ 完整性/ 的/ 验证/ ./ 证毕/ ./ 5/ 安全性/ 分析/ 5.1/ 机密性/ 定理/ 4/ ./ / I/ 类/ 敌手/ 的/ 机密性/ ./ 在/ 随机/ 谕言机/ 模型/ 中/ ,/ 若/ 敌手/ 时间/ 内/ 赢得/ 相关/ 游戏/ (/ 游戏/ 具体/ 定义/ 详见/ 文献/ [/ 7/ ]/ ,/ / I/ -/ 1/ 最多/ 进行/ qS/ 次/ 签密/ 询问/ 和/ qSk/ 次/ 私钥/ 生成/ 询问/ )/ ,/ 则/ 算法/ 2/ (/ 1/ -/ qSK/ )/ k/ 时间/ 内/ 解决/ CDH/ 困难/ 问题/ ./ 证明/ ./ 令/ 算法/ (/ 其中/ a/ ,/ b/ ∈/ Z/ / 的/ 是/ 证明/ gab/ ∈/ Z/ / 游戏/ 的/ 挑战者/ ./ / 参数/ Params/ =/ 〈/ p/ ,/ q/ ,/ Z/ / 给/ / I/ -/ 1/ ,/ 其中/ 令/ PPub/ =/ gb/ (/ 系统/ 主/ 密钥/ 为/ b/ ,/ 但/ 掌握/ )/ ;/ 维持/ 列表/ L1/ ,/ L2/ ,/ L3/ ,/ L4/ ,/ LSK/ ,/ LPK/ 用于/ 跟踪/ / I/ -/ 1/ 对/ 谕言机/ H1/ ,/ H2/ ,/ H3/ ,/ H4/ 的/ 询问/ 以及/ 对/ 私钥/ 生成/ 和/ 公钥/ 生成/ 的/ 询问/ ,/ 初始/ 时/ 各/ 列表/ 均/ 为/ 空/ ./ 询问/ :/ 敌手/ H2/ 询问/ :/ 当/ / I/ -/ 1/ ;/ 否则/ ,/ Ci/ 〉/ 时/ ,/ 若/ 存在/ 〈/ IDi/ ,/ Ri/ ,/ Ci/ ,/ h2/ 〉/ ∈/ L2/ ,/ 则/ 返回/ 相应/ 的/ h2/ 给/ (/ 避免/ 碰撞/ 的/ 产生/ )/ 的/ 随机数/ h2/ ∈/ Z/ / Ci/ ,/ h2/ 〉/ 到/ L2/ 中/ ,/ 并/ 返回/ h2/ 给/ H3/ 询问/ :/ 当/ 存在/ 〈/ Vi/ ,/ h3/ 〉/ ∈/ L3/ ,/ 则/ 返回/ 相应/ 的/ h3/ 给/ 选取/ 满足/ 〈/ / ,/ h3/ 〉/ / L3/ 的/ 随机数/ h3/ ∈/ {/ 0/ ,/ 1/ }/ L2/ +/ |/ Z/ 加/ 〈/ Vi/ ,/ h3/ 〉/ 到/ L3/ 中/ ,/ 并/ 返回/ h3/ 给/ H4/ 询问/ :/ 当/ Xi/ (/ Yi/ )/ ,/ Ri/ 〉/ 时/ ,/ 若/ 〈/ IDi/ ,/ mi/ ,/ Xi/ (/ Yi/ )/ ,/ Ri/ ,/ h4/ 〉/ ∈/ L4/ ,/ 则/ 返回/ h4/ 给/ 的/ 随机数/ h4/ ∈/ Z/ / L4/ 中/ ,/ 并/ 返回/ h4/ 给/ 公钥/ 生成/ 询问/ :/ 当/ 询问/ 时/ ,/ ①/ 若/ 存在/ 〈/ IDi/ ,/ Xi/ ,/ Yi/ ,/ ci/ 〉/ ∈/ LPK/ ,/ 则/ 返回/ 元组/ 中/ 相应/ 的/ 公钥/ PKi/ =/ 〈/ Xi/ ,/ Yi/ 〉/ 给/ ②/ 否则/ ,/ δ/ 且/ δ/ =/ q/ ,/ 添加/ 〈/ IDi/ ,/ Xi/ ,/ Yi/ ,/ ci/ 〉/ 到/ LPK/ 中/ ,/ 返回/ PKi/ =/ LPK/ (/ 其中/ Xi/ =/ gh1/ ∈/ Z/ / 〈/ Xi/ ,/ Yi/ 〉/ 给加/ 〈/ IDi/ ,/ Xi/ ,/ Yi/ ,/ h1/ 〉/ 到/ L1/ 中/ ;/ 若/ ci/ =/ 1/ ,/ 则/ 令/ Xi/ =/ 1Know/ 和/ Yi/ =/ grgr/ 的/ 参数/ )/ ,/ 且/ 满足/ 〈/ / ,/ Xi/ ,/ Yi/ ,/ / 〉/ / LPK/ ,/ 选取/ 满足条件/ 为/ 〈/ / ,/ r1/ -/ h1PubgyiP/ 到/ LPK/ 中/ ,/ 返回/ PKi/ =/ 〈/ Xi/ ,/ Yi/ 〉/ 给/ 〈/ IDi/ ,/ xi/ ,/ yi/ 〉/ 到/ LSK/ 中/ ,/ 添加/ 〈/ IDi/ ,/ Xi/ ,/ Yi/ ,/ h1/ 〉/ 到/ L1/ 中/ ./ H1/ 询问/ :/ 当/ Yi/ 〉/ 时/ ,/ 若/ 存在/ 〈/ IDi/ ,/ Xi/ ,/ Yi/ ,/ h1/ 〉/ ∈/ L1/ ,/ 则/ 返回/ 相应/ 的/ Page6/ / I/ -/ 1/ ;/ 否则/ ,/ h1/ 给/ 回/ L1/ 中/ 相应/ 元组/ 的/ h1/ 给/ 私钥/ 生成/ 询问/ :/ 当/ 询问/ 时/ ,/ ①/ 若/ 存在/ 〈/ IDi/ ,/ xi/ ,/ yi/ 〉/ ∈/ LSK/ ,/ 则/ 返回/ 相应/ 的/ 私钥/ SKi/ =/ 〈/ xi/ ,/ yi/ 〉/ 给/ ②/ 否则/ ,/ 对/ IDi/ 进行/ 公钥/ 生成/ 询问/ 后/ ,/ 在/ LSK/ 中/ 查找/ 相应/ 的/ 元组/ 〈/ IDi/ ,/ xi/ ,/ yi/ 〉/ ,/ 并/ 返回/ 相应/ 的/ 私钥/ SKi/ =/ 〈/ xi/ ,/ yi/ 〉/ 给/ 公钥/ 替换/ :/ 〈/ Xi/ ,/ Yi/ 〉/ 替换/ 合法/ 用户/ IDi/ 的/ 原始/ 公钥/ PKi/ ./ 签密/ 询问/ :/ 当/ IDR/ ,/ m/ 〉/ (/ 密/ 询问/ 时/ ,/ XS/ ,/ YS/ ,/ cS/ 〉/ ,/ 并/ 进行/ 下述/ 操作/ :/ ①/ 若/ cS/ =/ 1/ ,/ 则/ ②/ 否则/ ,/ 对应/ 的/ 元组/ 〈/ IDS/ ,/ xS/ ,/ yS/ 〉/ 和/ 〈/ IDR/ ,/ XR/ ,/ YR/ 〉/ ,/ 运行/ 算法/ Signcrypt/ (/ Params/ ,/ IDS/ ,/ SKS/ ,/ IDR/ ,/ PKR/ ,/ m/ )/ 生成/ 相应/ 的/ 密文/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ ,/ 并/ 将/ σ/ 返回/ 给解/ 签密/ 询问/ :/ 当/ σ/ =/ (/ h/ ,/ S/ ,/ C/ )/ 〉/ (/ 的/ 解/ 签密/ 询问/ 时/ ,/ 组/ 〈/ IDR/ ,/ XR/ ,/ YR/ ,/ cR/ 〉/ ,/ 并/ 进行/ 下述/ 操作/ :/ ①/ 若/ 〈/ IDR/ ,/ XR/ ,/ YR/ ,/ cR/ 〉/ ∈/ LPK/ 且/ cR/ =/ 0/ ,/ 别/ 在/ LSK/ 与/ LPK/ 中/ 查询/ IDR/ 及/ IDS/ 相对/ 应/ 的/ 元组/ 〈/ IDR/ ,/ xR/ ,/ yR/ 〉/ 和/ 〈/ IDS/ ,/ XS/ ,/ YS/ 〉/ ,/ 对/ 密文/ σ/ 运行/ 解/ 签密/ 算法/ UnSigncrypt/ (/ Params/ ,/ IDS/ ,/ PKS/ ,/ IDR/ ,/ SKR/ ,/ σ/ )/ ,/ 并/ 返回/ m/ 给/ 终止/ 模拟/ ;/ ②/ 若/ 〈/ IDR/ ,/ XR/ ,/ YR/ ,/ cR/ 〉/ ∈/ LPK/ 且/ cR/ =/ 1/ ,/ 当/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ h1/ 〉/ ∈/ L1/ ,/ 〈/ IDS/ ,/ RS/ ,/ C/ ,/ h2/ 〉/ ∈/ L2/ ,/ 〈/ Vi/ =/ ga/ (/ xR/ +/ yR/ 〈/ IDS/ ,/ mS/ ,/ YS/ ,/ RS/ ,/ hY/ 等式/ gU/ =/ (/ XSYSP/ 终止/ 模拟/ ;/ 否则/ / ③/ 若/ 列表/ LPK/ 中/ 不/ 存在/ 元组/ 〈/ IDS/ ,/ XS/ ,/ YS/ 〉/ (/ 即公钥/ 被/ 替换/ )/ ,/ 当/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ h1/ 〉/ ∈/ L1/ ,/ 〈/ IDS/ ,/ RS/ ,/ C/ ,/ h2/ 〉/ ∈/ L2/ ,/ 〈/ Vi/ =/ ga/ (/ xR/ +/ yRRS/ ,/ hX4/ 〉/ ∈/ L4/ 和/ 〈/ IDS/ ,/ mS/ ,/ YS/ ,/ RS/ ,/ hYU/ =/ C/ / h3/ ,/ 若/ 等式/ gU/ =/ (/ XSYSP/ 返回/ m/ 给/ 挑战/ 和/ 两个/ 等长/ 的/ 明文/ (/ m0/ ,/ m1/ )/ ./ 收到/ 了/ 公钥/ 密钥/ 生成/ 询问/ ,/ 应/ 的/ 元组/ 〈/ IDR/ ,/ XR/ ,/ YR/ ,/ cR/ 〉/ ,/ 并/ 进行/ 下述/ 操作/ ./ ①/ 若/ cR/ =/ 0/ ,/ 则/ ②/ 否则/ ,/ 随机/ 选取/ c/ ←/ {/ 0/ ,/ 1/ }/ ,/ 令/ R/ / =/ ga/ ,/ 满足/ 等式/ gUmc/ ,/ XS/ ,/ R/ / )/ ,/ f/ =/ H4/ (/ IDS/ ,/ mc/ ,/ YS/ ,/ R/ / )/ )/ 的/ 随机数/ U/ / ∈/ Z/ / V/ / ∈/ Z/ / H2/ (/ IDS/ ,/ R/ / ,/ C/ / )/ ;/ 选择/ 满足/ R/ / =/ (/ XSYSP/ 的/ 随机数/ S/ / ∈/ Z/ / / I/ -/ 1/ 经过/ 概率/ 多项式/ 时间/ 次数/ 的/ 上述/ 询问/ 后/ 输出/ 对/ c/ 的/ 猜测/ c/ ←/ {/ 0/ ,/ 1/ }/ ,/ 若/ c/ =/ c/ ,/ (/ V/ / R/ / -/ (/ r/ 否则/ ,/ / / 程中/ 未/ 终止/ ,/ 并且/ 本文/ 方案/ 的/ 机密性/ ,/ 则/ 令/ 事件/ 行/ 私钥/ 生成/ 询问/ ,/ 即/ Pr/ [/ 示/ 询问/ 阶段/ 表示/ 挑战/ 阶段/ 中/ / 不/ 终止/ 的/ 概率/ 为/ Pr/ [/ (/ 1/ -/ δ/ )/ qS/ δ/ ./ 由于/ δ/ =/ 趋向于/ e/ -/ 1/ (/ e/ 是/ 自然对数/ 底数/ )/ ,/ 因此/ ,/ 模拟/ 过程/ 中/ 不/ 终止/ 的/ 概率/ 至少/ 为/ 1/ -/ 综上所述/ ,/ 若/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ 了/ 本文/ 签密/ 方案/ 的/ 机密性/ ,/ 则/ / 能以/ 优势/ Adv/ (/ CDH/ 问题/ 的/ 有效/ 解/ ./ 定理/ 5/ ./ / II/ 类/ 敌手/ 的/ 机密性/ ./ 在/ 随机/ 谕言机/ 模型/ 中/ ,/ 若/ 敌手/ 式/ 时间/ 内/ 赢得/ 相关/ 游戏/ (/ 游戏/ 具体/ 定义/ 详见/ 文献/ / II/ -/ 1/ 最多/ 进行/ qS/ 次/ 签密/ 询问/ 和/ qSK/ 次/ 私钥/ 生成/ [/ 7/ ]/ ,/ 询问/ )/ ,/ 算法/ qSK2/ (/ 1/ -/ 时间/ 内/ 解决/ CDH/ 困难/ 问题/ ./ Page7/ 证明/ 思路/ 与/ 定理/ 4/ 相似/ ,/ 不再/ 赘述/ ./ 5.2/ 不可/ 伪造/ 性/ 定理/ 6/ ./ / I/ 类/ 敌手/ 的/ 不可/ 伪造/ 性/ ./ 在/ 随机/ 谕言机/ 模型/ 中/ ,/ 若/ 敌手/ 项式/ 时间/ 内/ 赢得/ 相关/ 游戏/ (/ 游戏/ 具体/ 定义/ 详见/ 文献/ / I/ -/ 2/ 最多/ 进行/ qS/ 次/ 签密/ 询问/ 和/ qSK/ 次/ 私钥/ 生成/ [/ 7/ ]/ ,/ 询问/ )/ ,/ 算法/ 2/ (/ 1/ -/ qSK/ )/ k/ 间/ 内/ 解决/ DL/ 困难/ 问题/ ./ 证明/ ./ 令/ 算法/ q/ 且/ 未知/ )/ 的/ DL/ 困难/ 问题/ 解决/ 者/ ,/ 其/ 目的/ 是/ 证/ b/ ∈/ Z/ / 明/ b/ ∈/ Z/ / 战者/ ./ / Params/ =/ 〈/ p/ ,/ q/ ,/ Z/ / / I/ -/ 2/ ,/ 令/ PPub/ =/ gb/ ,/ 维持/ 列表/ L1/ ,/ L2/ ,/ L3/ ,/ L4/ ,/ LSK/ ,/ LPK/ 分别/ 用于/ 跟踪/ 以及/ 对/ 私钥/ 生成/ 和/ 公钥/ 生成/ 的/ 询问/ ,/ 初始/ 时/ 各/ 列表/ 均/ 为/ 空/ ./ 询问/ :/ 敌手/ H4/ 的/ 询问/ 、/ 公钥/ 生成/ 询问/ 、/ 私钥/ 生成/ 询问/ 和/ 公钥/ 替换/ 询问/ ./ 签名/ 询问/ :/ 当/ / I/ -/ 2/ 对/ IDS/ 已/ 进行/ 了/ 公钥/ 生成/ 询问/ )/ 的/ 签名/ 询问/ 时/ ,/ 先/ 在/ 列表/ LPK/ 中/ 查询/ IDS/ 所/ 对应/ 的/ 元组/ 〈/ IDS/ ,/ XS/ ,/ / YS/ ,/ cS/ 〉/ :/ ①/ 若/ cS/ =/ 1/ ,/ 则/ ②/ 否则/ ,/ xS/ ,/ yS/ 〉/ ,/ 运行/ 算法/ Sign/ (/ Params/ ,/ IDS/ ,/ SKS/ ,/ m/ )/ 生成/ 相应/ 的/ 签名/ σ/ =/ (/ h/ ,/ S/ ,/ U/ ,/ m/ )/ ,/ 并/ 将/ 其/ 发送给/ 签名/ 验证/ 询问/ :/ 当/ U/ ,/ m/ )/ 〉/ (/ 敌手/ 解/ 签密/ 询问/ 时/ ,/ 元组/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ cS/ 〉/ :/ ①/ 若/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ cS/ 〉/ ∈/ LPK/ 且/ cS/ =/ 0/ ,/ 算法/ UnSign/ (/ Params/ ,/ IDS/ ,/ PKS/ ,/ σ/ )/ ,/ 并/ 返回/ m/ 给/ / I/ -/ 2/ ,/ 若/ 输入/ 的/ 签名/ 无效/ ,/ ②/ 若/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ cS/ 〉/ ∈/ LPK/ 且/ cS/ =/ 1/ ,/ 当/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ h1/ 〉/ ∈/ L1/ ,/ 〈/ IDS/ ,/ RS/ ,/ C/ ,/ h2/ 〉/ ∈/ L2/ ,/ 〈/ IDS/ ,/ mS/ ,/ XS/ ,/ RS/ ,/ hX/ 式/ gU/ =/ (/ XSYSP/ 则/ 停止/ 模拟/ ,/ 并/ 终止/ ;/ / ③/ 若/ 列表/ LPK/ 中/ 不/ 存在/ 元组/ 〈/ IDS/ ,/ XS/ ,/ YS/ 〉/ (/ 即公钥/ 被/ 替换/ )/ ,/ 当/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ h1/ 〉/ ∈/ L1/ ,/ 〈/ IDS/ ,/ RS/ ,/ C/ ,/ h2/ 〉/ ∈/ L2/ ,/ 〈/ IDS/ ,/ mS/ ,/ XS/ ,/ RS/ ,/ hXYS/ ,/ RS/ ,/ hY/ 立/ ,/ 则/ 返回/ m/ 给/ 伪造/ :/ 询问/ 阶段/ 结束/ 后/ ,/ 并/ 计算/ R/ =/ gr/ ;/ 选取/ 满足/ 等式/ gU/ =/ (/ XSYSP/ (/ 其中/ d/ =/ H4/ (/ IDS/ ,/ m/ ,/ XS/ ,/ R/ )/ ,/ f/ =/ H4/ (/ IDS/ ,/ m/ ,/ YS/ ,/ R/ )/ )/ 的/ 随机数/ U/ ∈/ Z/ / 的/ 随机数/ V/ / ∈/ Z/ / (/ f/ ←/ {/ 0/ ,/ 1/ }/ )/ 和/ h/ =/ H2/ (/ IDS/ ,/ R/ ,/ C/ )/ ;/ 选取/ 满足/ R/ =/ (/ XSYSPIDS/ 和/ 消息/ m/ 的/ 伪造/ 签名/ σ/ =/ (/ h/ ,/ S/ ,/ U/ ,/ m/ )/ ,/ 同时/ 道/ 被/ 替换/ 的/ 公钥/ ;/ 若/ LPK/ 中/ 对应/ 的/ 元组/ 〈/ IDS/ ,/ XS/ ,/ YS/ ,/ cS/ 〉/ 中/ 的/ cS/ =/ 1/ ,/ 算法/ / 则/ 输出/ b/ =/ (/ S/ / hS/ 中/ S/ / =/ r/ (/ r1/ 效解/ ;/ 否则/ ,/ 令/ 事件/ 钥/ 生成/ 的/ 询问/ ,/ 即/ Pr/ [/ 阶段/ / / I/ -/ 2/ 伪造/ 合法/ 签名/ 后/ 模拟/ 过程/ 中/ qSK1/ -/ 2/ (/ 时/ ,/ (/ 1/ -/ δ/ )/ qS/ 趋向于/ e/ -/ 1/ (/ e/ 是/ 自然对数/ 底数/ )/ ,/ 因此/ 模拟/ 过程/ 中/ 综上所述/ ,/ 若/ 以/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ 本文/ 方案/ 的/ 不可/ 伪造/ 性/ ,/ 则/ 能/ 以/ 优势/ Adv/ (/ / DL/ 问题/ 的/ 有效/ 解/ ./ 定理/ 7/ ./ / II/ 类/ 敌手/ 的/ 不可/ 伪造/ 性/ ./ 在/ 随机/ 谕言机/ 模型/ 中/ ,/ 若/ 敌手/ 多项式/ 时间/ 内/ 赢得/ 相关/ 游戏/ (/ 游戏/ 具体/ 定义/ 详见/ 文献/ [/ 7/ ]/ ,/ 成/ 询问/ )/ ,/ 算法/ qSK2/ (/ 1/ -/ 间/ 内/ 解决/ DL/ 困难/ 问题/ ./ 证明/ 思路/ 与/ 定理/ 6/ 相似/ ,/ 不再/ 赘述/ ./ 5.3/ 密钥/ 托管/ 本文/ 方案/ 中/ ,/ KGC/ 基于/ 用户/ 身份/ 标识/ IDi/ 和/ 公/ Page8/ 开/ 参数/ Xi/ 为/ 用户/ 生成/ 部分/ 私钥/ yi/ 和/ 部分/ 公钥/ Yi/ ./ 由于/ Xi/ =/ gxi/ ,/ 则/ 其/ 将/ 面临/ 求解/ 离散/ 对数/ 困难/ 的/ 问题/ ,/ 即/ KGC/ 无法/ 掌握/ 用户/ 私钥/ SKi/ =/ (/ xi/ ,/ yi/ )/ ./ 5.4/ 公开/ 验证/ 性/ 由于/ 对/ [/ 11/ ]/ 中/ 的/ 方案/ 不/ 具有/ 公开/ 验证/ 性/ ;/ 而/ 本文/ 的/ 方案/ 中/ ,/ 当/ 签密/ 发送者/ 和/ 密文/ 接收者/ 关于/ 密文/ 的/ 有效性/ 发生争执/ ,/ 需要/ 公开/ 验证/ 发送者/ 身份/ 时/ ,/ 接收者/ 可/ 发送/ 密文/ 消息/ σ/ =/ (/ h/ ,/ S/ ,/ C/ =/ m/ ‖/ U/ )/ 及/ 密文/ 发送者/ 的/ 身份/ 标识/ IDa/ 给/ 任何/ 第/ 3/ 方/ ,/ 第/ 3/ 方/ 无需/ 密文/ 收发/ 双方/ 的/ 任何/ 私有/ 信息/ ,/ 只/ 需/ 验证/ 等式/ gU/ =/ (/ XaYaP/ 和/ h/ =/ H2/ (/ IDa/ ,/ R/ ,/ C/ )/ (/ 其中/ 参数/ d/ ,/ f/ ,/ R/ 均/ 可/ 由/ 相关/ 公开/ 信息/ 计算/ 得到/ )/ 是否/ 成立/ 即可/ ,/ 由于/ 本文/ 方案/ 具有/ 不可/ 伪造/ 性/ ,/ 则/ 当/ 上述/ 等式/ 成立/ 时/ ,/ 即/ 表示/ 密文/ 是/ 由/ 用户/ IDa/ 生成/ 的/ 合法/ 密文/ ./ 5.5/ 不可否认/ 性/ 由于/ 对/ [/ 7/ ]/ 中/ 的/ 方案/ 不/ 具有/ 不可否认/ 性/ ;/ 而/ 本文/ 的/ 方案/ 中/ ,/ 由/ 定理/ 6/ 和/ 定理/ 7/ 可知/ ,/ 该/ 方案/ 对/ 均/ 具有/ 不可/ 伪造/ 性/ ,/ 即/ 密文/ 消息/ 是/ 不可/ 伪造/ 的/ ,/ 因此/ 若/ 签密/ 发送者/ 确实/ 生成/ 了/ 签密/ 密文/ ,/ 那么/ 该/ 发送者/ 就/ 不/ 能够/ 进行/ 否认/ ;/ 同时/ 由/ 公开/ 验证/ 性/ 可知/ ,/ 任何/ 第/ 3/ 方均/ 可/ 公开/ 验证/ 密文/ 发送者/ 的/ 身份/ ./ 5.6/ 前/ // 后/ 向/ 安全性/ 本文/ 方案/ 中/ ,/ 即使/ 在/ 某次/ 签密/ 密文/ 的/ 收发/ 过程/ 中/ ,/ 攻击者/ 获得/ 了/ 签密/ 发送者/ 或/ 密文/ 接收者/ 的/ 相关/ 参数/ ,/ 由于/ 密文/ 生成/ 参数/ 是/ 随机/ 选取/ 的/ ,/ 具有/ 表/ 1/ 与/ 不/ 使用/ 双线性/ 映射/ 的/ 相关/ 方案/ 的/ 比较/ 结果/ 签密/ 方案/ 文献/ [/ 7/ ]/ 文献/ [/ 8/ ]/ 文献/ [/ 9/ ]/ 文献/ [/ 10/ ]/ 文献/ [/ 11/ ]/ 文献/ [/ 12/ ]/ 本文/ 方案/ 注/ :/ √/ 表示/ 方案/ 具有/ 该/ 安全/ 属性/ ;/ ×/ 表示/ 方案/ 不/ 具有/ 该/ 安全/ 属性/ ./ 如表/ 1/ 所示/ ,/ 在/ 安全性/ 方面/ ,/ 文献/ [/ 7/ -/ 10/ ]/ 中/ 方案/ 均/ 存在/ 安全性/ 缺陷/ ,/ 其中/ 本文/ 通过/ 构造/ 具体/ 的/ 攻击/ 算法/ 证明/ 了/ 文献/ [/ 7/ ]/ 的/ 方案/ 无法/ 满足/ 其所/ 声称/ 的/ 不可/ 伪造/ 性/ 和/ 机密性/ ;/ 基于/ 对/ 文献/ [/ 8/ -/ 10/ ]/ 中/ 方案/ 的/ 具体分析/ ,/ 我们/ 发现/ 使用/ 本文/ 的/ 机密性/ 攻击/ 算法/ 可证/ 较/ 强/ 的/ 新鲜/ 性/ ,/ 因此/ 攻击者/ 无法/ 获知/ 先前/ 的/ 密文/ 及/ 相关/ 参数/ ,/ 则/ 攻击者/ 无法/ 获知/ 已/ 发送/ 的/ 明文/ 消息/ ;/ 同时/ ,/ 攻击者/ 也/ 无法/ 猜测/ 发送者/ 即将/ 发送/ 的/ 签密/ 密文/ 及其/ 相关/ 参数/ ,/ 因此/ 无法/ 获知/ 将来/ 要/ 发送/ 的/ 明文/ 消息/ ./ 6/ 性能/ 分析/ 本节/ 将/ 从/ 安全/ 属性/ 、/ 通信/ 开销/ 和/ 计算/ 效率/ 3/ 个/ 方面/ 综合/ 分析/ 本文/ 方案/ 和/ 相关/ 无/ 证书/ 签密/ 方案/ [/ 4/ -/ 17/ ]/ 的/ 性能/ ,/ 并/ 给出/ 具体/ 的/ 性能/ 对比/ 结果/ ./ 由于/ 双线性/ 映射/ 的/ 计算/ 量/ 较大/ [/ 14/ ]/ ,/ 因此/ 相较/ 于/ 现有/ 的/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ [/ 4/ -/ 5/ ]/ 而言/ ,/ 不/ 使用/ 双线性/ 映射/ 的/ 签密/ 方案/ 具有/ 更大/ 的/ 效率/ 优势/ ;/ 并且/ 文献/ [/ 4/ -/ 5/ ]/ 的/ 方案/ 都/ 存在/ 着/ 安全性/ 缺陷/ ,/ 这些/ 方案/ 要么/ 安全性/ 未/ 进行/ 形式化/ 证明/ [/ 4/ ]/ ,/ 要么/ 无/ 机密性/ [/ 5/ ]/ ,/ 所以/ 与/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ 相比/ ,/ 本文/ 的/ 方案/ 在/ 效率/ 和/ 安全性/ 方面/ 有/ 明显/ 的/ 优势/ ./ 与/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ [/ 7/ -/ 12/ ]/ 进行/ 比较/ 时/ ,/ 计算/ 开销/ 主要/ 取决于/ 签密/ 和/ 签密/ 验证/ 算法/ 的/ 计算/ 量/ ,/ 且/ 主要/ 统计/ 群上/ 的/ 点/ 乘/ 运算/ 和/ 指数/ 运算/ 的/ 执行/ 次数/ ,/ 但/ 未/ 统计/ 可/ 提前准备/ 的/ 相关/ 计算/ ;/ 通信/ 开销/ 主要/ 通过/ 密文/ 的/ 长度/ 来/ 衡量/ ;/ 而/ 安全/ 属性/ 主要/ 讨论/ 方案/ 的/ 不可/ 伪造/ 性/ 和/ 机密性/ ./ 表/ 1/ 中/ 相关/ 符号/ 的/ 含义/ 为/ :/ E/ 表示/ 群上/ 的/ 点/ 乘/ 运算/ ;/ Q/ 表示/ 群上/ 的/ 指数/ 运算/ ;/ |/ m/ |/ 表示/ 明文/ 消息/ m/ 的/ 长度/ ;/ |/ G/ |/ 表示/ 群/ Z/ / 示/ Z/ / q/ 上/ 相应/ 元素/ 的/ 长度/ ./ ×/ ×/ ×/ ×/ √/ √/ √/ 明/ 文献/ [/ 8/ -/ 10/ ]/ 中/ 的/ 方案/ 同样/ 不/ 满足/ 机密性/ ;/ 同时/ ,/ 文献/ [/ 9/ ]/ 指出/ 文献/ [/ 8/ ]/ 中/ 的/ 方案/ 对备/ 其/ 所/ 声称/ 的/ 不可/ 伪造/ 性/ ./ 在/ 计算/ 效率/ 方面/ ,/ 由于/ 文献/ [/ 11/ -/ 12/ ]/ 的/ 运算量/ 较大/ ,/ 导致/ 计算/ 效率/ 较/ 低/ ./ 在/ 通信/ 开销/ 方面/ ,/ 由于/ 文献/ [/ 11/ ]/ 的/ 密文/ 较长/ (/ 表/ 1/ 的/ 密文/ 长/ Page9/ 度/ 并未/ 统计/ 密文/ 中/ 的/ 代理/ 授权/ 部分/ )/ ,/ 导致/ 传输/ 代价/ 较大/ ,/ 而/ 其他/ 方案/ [/ 7/ -/ 10/ ,/ 12/ ]/ 和/ 本文/ 方案/ 的/ 传输/ 效率/ 较/ 高/ ./ 综上所述/ ,/ 现有/ 的/ 不/ 使用/ 双线性/ 映射/ 的/ 无/ 证书/ 签密/ 方案/ [/ 7/ -/ 12/ ]/ 在/ 计算/ 效率/ 或/ 安全性/ 方面/ 存在/ 着/ 一定/ 的/ 不足/ ,/ 相比/ 于/ 上述/ 方案/ ,/ 本文/ 方案/ 的/ 计算/ 效率/ 和/ 通信/ 开销/ 以及/ 安全性/ 更优/ ./ 7/ 讨论/ 为了/ 满足/ 隐私/ 保护/ 的/ 需求/ ,/ 通信/ 过程/ 中/ 用户/ 通常/ 会/ 对/ 发送/ 的/ 通信/ 消息/ 进行/ 加密/ 和/ 签名/ 操作/ ,/ 以/ 保护/ 通信/ 消息/ 的/ 秘密性/ 和/ 可验证/ 性/ ;/ 用户/ 也/ 可/ 使用/ 签密/ 操作/ 同时/ 完成/ 对/ 通信/ 消息/ 的/ 加密/ 和/ 签名/ ./ 由于/ 相比/ 于/ 传统/ 签密/ 方案/ [/ 7/ -/ 12/ ]/ ,/ 本文/ 方案/ 在/ 计算/ 效率/ 、/ 通信/ 开销/ 和/ 安全性/ 等/ 方面/ 的/ 性能/ 更佳/ ,/ 因此/ ,/ 本文/ 方案/ 在/ 实际/ 数据传输/ 中/ 有着/ 重要/ 的/ 意义/ ./ 文献/ [/ 15/ ]/ 基于/ 签密/ 方案/ 对/ 移动/ 互联网/ 匿名/ 通信协议/ 进行/ 了/ 相关/ 研究/ ./ 由于/ 篇幅/ 所/ 限/ ,/ 对/ 其/ 具体/ 的/ 通信/ 过程/ ,/ 本文/ 不再/ 赘述/ ./ 8/ 结束语/ 本文/ 通过/ 构造/ 具体/ 的/ 攻击/ 算法/ 证明/ 了/ 文献/ [/ 7/ ]/ 中/ 的/ 原有/ 方案/ 不/ 具备/ 其所/ 声称/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ ;/ 同时/ 本文/ 提出/ 了/ 安全/ 高效/ 的/ 无/ 证书/ 签密/ 方案/ ,/ 并/ 在/ 随机/ 谕言机/ 模型/ 下/ 基于/ CDH/ 和/ DL/ 困难/ 问题/ 证明/ 了/ 本文/ 方案/ 的/ 机密性/ 和/ 不可/ 伪造/ 性/ ;/ 由/ 分析/ 可知/ 除/ 上述/ 安全/ 属性/ 之外/ ,/ 本文/ 方案/ 还/ 具有/ 不可否认/ 、/ 公开/ 验证/ 等/ 安全/ 属性/ ./ 与/ 现有/ 的/ 传统/ 方案/ 相比/ ,/ 本文/ 方案/ 的/ 计算/ 效率/ 和/ 通信/ 开销/ 以及/ 安全性/ 更优/ ./ 致谢/ 评审/ 专家/ 及/ 编辑/ 老师/ 对/ 稿件/ 进行/ 了/ 细致/ 的/ 审阅/ ,/ 在/ 此/ 致谢/ !/ 

