Page1/ 抗/ 适应性/ 选择/ 身份/ 攻击/ 的/ 匿名/ HIBE/ 方案/ 王皓/ 徐秋亮/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 摘要/ 构造/ 了/ 一个/ 新/ 的/ 匿名/ 基于/ 身份/ 加密/ (/ IBE/ )/ 方案/ ,/ 并/ 将/ 其/ 扩展/ 为/ 一个/ 匿名/ 分等级/ 基于/ 身份/ 加密/ (/ HIBE/ )/ 方案/ ./ 新/ 方案/ 的/ 构造/ 中/ 使用/ 了/ 合数/ 阶/ 双线性/ 群/ ,/ 利用/ 相同/ 子群/ 中/ 的/ 元素/ 对/ 公共/ 参数/ 和/ 密文/ 进行/ 盲化/ ,/ 从而/ 实现/ 方案/ 的/ 匿名性/ ;/ 利用/ 不同/ 子群/ 中/ 的/ 元素/ 构造/ 用户/ 私钥/ ,/ 从而/ 达到/ 正确/ 解密/ 的/ 目的/ ./ 其/ 安全性/ 证明/ 使用/ 了/ Lewko/ 和/ Waters/ 提出/ 的/ 构造/ 双系统/ 加密/ 的/ 新/ 技术/ ./ 新/ 的/ 匿名/ HIBE/ 方案/ 具有/ 较/ 短/ 的/ 密文/ ,/ 并且/ 能够/ 在/ 标准/ 模型/ 下/ 达到/ 抗/ 适应性/ 选择/ 身份/ 攻击/ 安全/ ,/ 而/ 此前/ 的/ 匿名/ HIBE/ 方案/ 仅能/ 达到/ 抗/ 选定/ 身份/ 攻击/ 安全/ ./ 关键词/ 匿名/ 分等级/ 基于/ 身份/ 加密/ ;/ 抗/ 适应性/ 选择/ 身份/ 攻击/ ;/ 短/ 密文/ ;/ 无/ 随机/ 预言/ 机/ ;/ 合数/ 阶/ 双线性/ 群/ 1/ 引言/ IBE/ )/ 系统/ [/ 1/ ]/ 是/ 一种/ 特殊/ 的/ 公钥/ 加密/ 系统/ ,/ 加密/ 者/ 仅/ 需要/ 使用/ 接收者/ 的/ 身份/ 信息/ 和/ 一系列/ 全局/ 公共/ 参数/ 即可/ 完成/ 加密/ ,/ 而/ 不再/ 需要/ 使用/ 接收者/ 的/ 公钥/ ,/ 从而/ 基于/ 身份/ 的/ 加密/ (/ Identity/ -/ BasedEncryption/ ,/ 避免/ 了/ 管理/ 公钥/ 证书/ 带来/ 的/ 开销/ ./ 在/ 该/ 系统/ 中/ ,/ 密钥/ Page2/ 生成/ 中心/ (/ KeyGenerationCenter/ ,/ KGC/ )/ 持有/ 主/ 密钥/ ,/ 用来/ 为/ 已/ 认证/ 用户/ 颁发/ 其/ 身份/ 对应/ 的/ 私钥/ ./ 然而/ ,/ 当/ 系统/ 中/ 用户数量/ 较多时/ ,/ KGC/ 对/ 用户/ 密钥/ 管理/ 花费/ 的/ 开销/ 是/ 非常/ 昂贵/ 的/ ./ 为了/ 解决/ 这一/ 问题/ ,/ 同时/ 为了/ 给/ 具有/ 等级/ 结构/ 的/ 组织/ 提供/ 一种/ 更为/ 实用/ 的/ 加密/ 系统/ ,/ Horwitz/ 和/ Lynn/ 在/ EUROCRYPT2002/ 上/ 提出/ 了/ 分等级/ 基于/ 身份/ 加密/ [/ 2/ ]/ (/ HierarchicalIBE/ ,/ HIBE/ )/ 的/ 概念/ ./ 在/ HIBE/ 中/ ,/ 一个/ 处于/ 较/ 高等级/ 的/ 用户/ ,/ 可以/ 使用/ 自己/ 的/ 私钥/ 为/ 处于/ 较/ 低/ 等级/ 的/ 子孙/ 用户/ 生成/ 私钥/ ,/ 因此/ ,/ 密钥/ 生成/ 中心/ 只/ 需/ 管理/ 第/ 1/ 等级/ 上/ 用户/ 的/ 私钥/ ,/ 而/ 更/ 低/ 等级/ 用户/ 的/ 私钥/ 可/ 由/ 其/ 祖先/ 节点/ 上/ 的/ 用户/ (/ 包括/ KGC/ )/ 进行/ 管理/ ./ IBE/ 与/ HIBE/ 自/ 提出/ 以来/ 一直/ 受到/ 广泛/ 的/ 关注/ ,/ 相关/ 研究/ 涉及/ 到/ 密码学/ 与/ 网络安全/ 的/ 许多/ 领域/ ,/ 利用/ (/ H/ )/ IBE/ 为/ 基础/ 构造/ 的/ 大量/ 应用/ 被/ 相继/ 提出/ ./ 其中/ 一个/ 重要/ 的/ 应用/ 是/ “/ 有/ 关键字/ 搜索/ 的/ 公钥/ 加密/ ”/ [/ 3/ ]/ (/ Public/ -/ keyEncryptionwithKeywordSearch/ ,/ PEKS/ )/ ,/ 该/ 加密/ 机制/ 能够/ 在/ 保护/ 数据/ 机密性/ 的/ 同时/ 保持/ 对/ 数据/ 的/ 可/ 搜索/ 性/ ./ Abdalla/ 等/ 人/ 在/ CRYPTO2005/ 上/ 提出/ 了/ 匿名/ IBE/ 以及/ 匿名/ HIBE/ 的/ 概念/ [/ 4/ ]/ ,/ 并/ 给出/ 了/ 一个/ 从/ 匿名/ IBE/ 到/ PEKS/ 的/ 转换/ 技术/ ./ 在/ 一个/ 匿名/ IBE/ 方案/ 中/ ,/ 密文/ 不会/ 暴露/ 接收者/ 的/ 身份/ 信息/ ,/ 而/ 这/ 一/ 性质/ 正/ 可以/ 用来/ 构造/ PEKS/ 系统/ ,/ 从而/ 保持/ 关键字/ 的/ “/ 匿名性/ ”/ ./ 在/ 匿名/ HIBE/ 方案/ 中/ ,/ 分等级/ 的/ 身份/ 能够/ 在/ 提供/ 密钥/ 可/ 委托/ 性/ 的/ 同时/ 保持/ 密文/ 的/ 匿名性/ ./ 利用/ 匿名/ HIBE/ 可以/ 构造/ 许多/ 新/ 的/ 应用/ ,/ 例如/ ,/ 有/ 临时/ 关键字/ 搜索/ 的/ 公钥/ 加密/ ,/ 有/ 关键字/ 搜索/ 的/ 基于/ 身份/ 加密/ 等/ ./ 第一个/ 匿名/ HIBE/ 方案/ 是/ 由/ Boyen/ 和/ Waters/ 在/ 文献/ [/ 5/ ]/ 中/ 给出/ 的/ ,/ 该/ 方案/ 中/ 公共/ 参数/ 及/ 用户/ 私钥/ 的/ 长度/ 为/ O/ (/ l2/ )/ ,/ 密文/ 长度/ 为/ O/ (/ l/ )/ ,/ 其中/ l/ 表示/ 方案/ 中/ 等级/ 的/ 最大/ 深度/ ./ 随后/ ,/ Shi/ 和/ Waters/ 在/ 文献/ [/ 6/ ]/ 中/ 给出/ 了/ 一个/ 匿名/ HIBE/ 方案/ 的/ 一般化/ 构造/ ,/ 称为/ 可/ 委托/ 隐藏/ 向量/ 加密/ (/ delegatableHidden/ -/ VectorEncryption/ ,/ dHVE/ )/ ,/ 在/ 该/ 方案/ 中/ ,/ 公共/ 参数/ 、/ 用户/ 私钥/ 以及/ 密文/ 的/ 长度/ 均/ 为/ O/ (/ l/ )/ ./ 由于/ Boyen/ 及/ Shi/ 的/ 方案/ 中/ 各类/ 效率/ 参数均/ 与/ l/ 有关/ ,/ 因此/ ,/ 它们/ 并/ 不适/ 用于/ 等级/ 深度/ 较大/ 的/ 系统/ ./ 第一个/ 具有/ 短/ 密文/ 的/ 匿名/ HIBE/ 方案/ 是/ 由/ Seo/ 等/ 人/ [/ 7/ ]/ 在/ PKC2009/ 上/ 提出/ 的/ ,/ 其/ 密文/ 由/ 4/ 个群/ 元素/ 组成/ ,/ 与/ 系统/ 中/ 等级/ 的/ 最大/ 深度/ 无关/ ,/ 这/ 在/ 很大/ 程度/ 上/ 提高/ 了/ 匿名/ HIBE/ 方案/ 的/ 实用性/ ./ 然而/ Seo/ 的/ 方案/ 及/ 以上/ 两个/ 方案/ 都/ 是/ 在/ 较弱/ 的/ 选定/ 身份/ 模型/ [/ 8/ ]/ (/ selective/ -/ IDmodel/ )/ 中/ 证明/ 安全性/ 的/ ./ 在/ 该/ 模型/ 中/ ,/ 敌手/ 必须/ 在/ 系统/ 建立/ 之前/ ,/ 公布/ 其/ 将要/ 用于/ 挑战/ 的/ 身份/ ,/ 因此/ ,/ 该/ 模型/ 不能/ 恰当/ 地/ 刻画/ 真实/ 环境/ 中/ 敌手/ 的/ 行为/ ,/ 在/ 该/ 模型/ 中/ 被/ 证明/ 安全/ 的/ 方案/ ,/ 仅能/ 称为/ 抗/ 选定/ 身份/ 攻击/ 安全/ 的/ (/ selective/ -/ IDsecure/ )/ ./ 因此/ ,/ 在/ 标准/ 模型/ 中/ ,/ 构造/ 具有/ 短/ 密文/ 的/ 匿名/ HIBE/ 方案/ ,/ 并/ 使/ 其/ 达到/ 抗/ 适应性/ 选择/ 身份/ 攻击/ 安全/ (/ fulladaptive/ -/ IDsecure/ )/ 是/ 本文/ 的/ 目的/ ./ 本文/ 中/ ,/ 我们/ 首先/ 构造/ 了/ 一个/ 匿名/ IBE/ 方案/ ,/ 然后/ 对/ 其/ 进行/ 了/ 扩展/ ,/ 给出/ 了/ 一个/ 具有/ 短/ 密文/ 的/ 匿名/ HIBE/ 方案/ ./ 这/ 两个/ 方案/ 都/ 可以/ 在/ 标准/ 模型/ 中/ ,/ 被/ 证明/ 达到/ 匿名/ 、/ 抗/ 适应性/ 选择/ 身份/ 和/ 选择/ 明文/ 攻击/ 安全/ (/ ANON/ -/ ID/ -/ CPA/ )/ ./ 新/ 方案/ 使用/ 了/ 合数/ 阶/ 双线性/ 群/ [/ 9/ ]/ 实现/ 密文/ 的/ 匿名性/ ,/ 同时/ 使用/ 了/ 双系统/ 加密技术/ [/ 10/ -/ 11/ ]/ 证明/ 方案/ 的/ 安全性/ ./ 第/ 2/ 节/ 给出/ 匿名/ HIBE/ 方案/ 及其/ 安全性/ 的/ 形式化/ 定义/ ,/ 介绍/ 有关/ 合数/ 阶/ 双线性/ 群/ 的/ 背景/ 知识/ ,/ 并/ 给出/ 用于/ 安全性/ 证明/ 中/ 的/ 6/ 个/ 静态/ 假设/ ;/ 第/ 3/ 节/ 给出/ 一个/ 匿名/ IBE/ 方案/ ,/ 并/ 证明/ 其/ 相应/ 的/ 安全性/ ;/ 第/ 4/ 节是/ 本文/ 的/ 重点/ ,/ 在/ 第/ 3/ 节/ 的/ 基础/ 上/ ,/ 对/ 匿名/ IBE/ 方案/ 进行/ 扩展/ ,/ 给出/ 一个/ 匿名/ HIBE/ 方案/ ,/ 并/ 证明/ 其/ 相应/ 的/ 安全性/ ;/ 第/ 5/ 节将/ 本文/ 提出/ 的/ 匿名/ HIBE/ 方案/ 与/ 已有/ 的/ 方案/ 在/ 效率/ 及/ 安全性/ 上/ 进行/ 全面/ 对比/ ,/ 并/ 给出/ 全文/ 的/ 总结/ ./ 2/ 背景/ 及/ 相关/ 定义/ 2.1/ 符号/ 说明/ 本文/ 中/ ,/ Z/ 表示/ 整数/ 环/ ,/ Z/ / 0/ 表示/ 非负/ 整数/ 集/ ,/ 对于/ 正整数/ k/ ,/ Zk/ 表示/ 模为/ k/ 的/ 整数/ 环/ ./ 当/ a/ 表示/ 某一/ 特定/ 的/ 值/ ,/ ν/ 表示/ 一个/ 变量/ 时/ ,/ 符号/ ν/ ←/ a/ 表示/ 将/ a/ 的/ 值/ 赋予/ 变量/ ν/ ./ 当/ X/ 表示/ 某个/ 集合/ 或/ 某个/ 代数/ 结构/ 时/ ,/ 符号/ x/ ←/ X/ 表示/ 在/ 集合/ X/ (/ 或/ 代数/ 结构/ X/ )/ 中/ 随机/ 选取/ 元素/ x/ ,/ 并且/ 我们/ 用/ x1/ ,/ …/ ,/ xk/ ←/ X/ 表示/ x1/ ←/ X/ ,/ …/ ,/ xk/ ←/ X/ ./ 此外/ 需要/ 特殊/ 说明/ ,/ 在/ 本文/ 中/ ,/ 当/ 多个/ 属于/ 相同/ 代数/ 结构/ 的/ 元素/ 使用/ 同一个/ 字母/ 表示/ 时/ ,/ 如果/ 该/ 元素/ 属于/ Zk/ ,/ 则/ 用/ 带有/ 中括号/ 的/ 符号/ 表示/ ,/ 例如/ a/ [/ i/ ]/ ,/ 如果/ 该/ 元素/ 属于/ 其它/ 代数/ 结构/ ,/ 则/ 用/ 带有/ 下脚/ 标的/ 符号/ 表示/ ,/ 例如/ gi/ ,/ 其中/ i/ 为/ 该/ 元素/ 的/ 标签/ ./ 当/ A/ 表示/ 某个/ 算法/ 时/ ,/ 符号/ A/ (/ a1/ ,/ …/ ,/ am/ )/ →/ b1/ ,/ …/ ,/ bn/ ,/ 表示/ 算法/ A/ 以/ a1/ ,/ …/ ,/ am/ 为/ 输入/ ,/ 输出/ b1/ ,/ …/ ,/ bn/ ./ 2.2/ HIBE/ 方案/ 一个/ HIBE/ 方案/ 由/ 5/ 个/ 算法/ 构成/ :/ 建立/ (/ Setup/ )/ 、/ 密钥/ 提取/ (/ KeyGen/ )/ 、/ 密钥/ 委托/ (/ Delegate/ )/ 、/ 加密/ Page3/ (/ Encrypt/ )/ 、/ 解密/ (/ Decrypt/ )/ ./ Setup/ (/ λ/ ,/ l/ )/ →/ PK/ ,/ MSK/ ./ 建立/ 算法/ 以/ 安全/ 参数/ λ/ 、/ 等级/ 的/ 最大/ 深度/ l/ 为/ 输入/ ,/ 输出/ 为/ 公共/ 参数/ PK/ 和/ 主/ 密钥/ MSK/ ./ KeyGen/ (/ PK/ ,/ MSK/ ,/ 犐/ )/ →/ SK/ 犐/ ./ 密钥/ 提取/ 算法/ 以/ 公共/ 参数/ PK/ 、/ 主/ 密钥/ MSK/ 和/ 一个/ 身份/ 向量/ 犐/ 为/ 输入/ ,/ 输出/ 该/ 身份/ 向量/ 对应/ 的/ 私钥/ SK/ 犐/ ./ Delegate/ (/ PK/ ,/ SK/ 犐/ ,/ I/ )/ →/ SK/ 犐/ :/ I/ :/ 密钥/ 委托/ 算法/ 以/ 公共/ 参数/ PK/ 、/ 深度/ 为/ d/ 的/ 身份/ 向量/ 犐/ 对应/ 的/ 私钥/ SK/ 犐/ 和/ 一个/ 身份/ 元素/ I/ 为/ 输入/ ,/ 输出/ 深度/ 为/ d/ +/ 1/ 的/ 身份/ 向量/ 犐/ :/ I/ 对应/ 的/ 私钥/ SK/ 犐/ :/ I/ ,/ 其中/ 犐/ :/ I/ 表示/ 在/ d/ 维/ 向量/ 犐/ 的/ 末端/ 增加/ 一个/ 元素/ I/ ,/ 使/ 其/ 成为/ d/ +/ 1/ 维/ 向量/ ./ Encrypt/ (/ PK/ ,/ M/ ,/ 犐/ )/ →/ CT/ ./ 加密算法/ 以/ 公共/ 参数/ PK/ 、/ 明文/ 消息/ M/ 以及/ 接收者/ 的/ 身份/ 向量/ 犐/ 为/ 输入/ ,/ 输出/ 密文/ CT/ ./ Decrypt/ (/ PK/ ,/ CT/ ,/ SK/ 犐/ )/ →/ M/ ./ 解密/ 算法/ 以/ 公共/ 参数/ PK/ 、/ 密文/ CT/ 、/ 私钥/ SK/ 犐/ 为/ 输入/ ,/ 输出/ 明文/ M/ ,/ 当且/ 仅/ 当/ 加密/ 时/ 使用/ 的/ 身份/ 向量/ 与/ 私钥/ 对应/ 的/ 身份/ 向量/ 相同/ ./ 解密/ 算法/ 要求/ 密文/ 和/ 私钥/ 对应/ 的/ 身份/ 向量/ 相同/ ./ 如果/ 解密/ 者/ 持有/ 的/ 私钥/ 所/ 对应/ 的/ 身份/ 向量/ 是/ 密文/ 对应/ 的/ 身份/ 向量/ 的/ 前缀/ ,/ 那么/ 他/ 可以/ 调用/ 密钥/ 委托/ 算法/ 生成/ 解密/ 所/ 需/ 的/ 私钥/ ./ 2.3/ 匿名/ HIBE/ 的/ 安全性/ 定义/ 本/ 小节/ 给出/ 匿名/ HIBE/ 的/ 安全性/ 定义/ ,/ 与/ 文献/ [/ 6/ ]/ 中/ 类似/ ,/ 需要/ 记录/ 密钥/ 的/ 生成/ 和/ 委托/ 的/ 过程/ ./ 首先/ ,/ 定义/ 一个/ 挑战者/ 与/ 敌手/ 之间/ 进行/ 的/ 游戏/ ./ 建立/ ./ 挑战者/ 运行/ 建立/ 算法/ ,/ 将/ 公共/ 参数/ PK/ 给/ 敌手/ ./ 挑战者/ 同时/ 初始化/ 一个/ 集合/ S/ =/ / ,/ 用来/ 记录/ 已经/ 被/ 创建/ 但/ 尚未/ 泄露/ 的/ 私钥/ ./ 阶段/ 1/ ./ 敌手/ 可以/ 重复/ 进行/ 如下/ 3/ 类/ 查询/ :/ 创建/ ./ 敌手/ 发送给/ 挑战者/ 一个/ 身份/ 向量/ 犐/ ./ 挑战者/ 创建/ 该/ 向量/ 对应/ 的/ 私钥/ ,/ 但/ 并/ 不/ 直接/ 返回/ 给/ 敌手/ ,/ 而是/ 将/ 它/ 添加/ 到/ 集合/ S/ 中/ ,/ 将/ 集合/ S/ 的/ 索引/ 返回/ 给/ 敌手/ ./ 委托/ ./ 敌手/ 指定/ 集合/ S/ 中/ 的/ 某个/ 私钥/ SK/ 犐/ ,/ 并/ 给/ 挑战者/ 一个/ 身份/ 元素/ I/ ./ 挑战者/ 运行/ 密钥/ 委托/ 算法/ Delegate/ (/ PK/ ,/ SK/ 犐/ ,/ I/ )/ ,/ 生成/ 新/ 的/ 私钥/ SK/ 犐/ :/ I/ ,/ 并/ 将/ 其/ 添加/ 到/ 集合/ S/ 中/ ,/ 将/ 更新/ 后/ 的/ 索引/ 返回/ 给/ 敌手/ ./ 泄露/ ./ 敌手/ 指定/ 集合/ S/ 中/ 的/ 某个/ 元素/ SK/ ,/ 挑战者/ 将/ 其/ 从/ 集合/ S/ 中/ 删除/ ,/ 并/ 将/ 它/ 返回/ 给/ 敌手/ ./ 在/ 对/ 密钥/ 进行/ 泄露/ 查询/ 后/ ,/ 将/ 不再/ 需要/ 对/ 该/ 私钥/ 进行/ 委托/ 查询/ ,/ 因为/ 敌手/ 可以/ 自己/ 运行/ 密钥/ 委托/ 算法/ ./ 挑战/ ./ 敌手/ 提交/ 两个/ 长度/ 相等/ 的/ 消息/ M/ / 0/ 和/ M/ / 1/ ,/ 两个/ 身份/ 向量/ 犐/ / 0/ 和/ 犐/ / 1/ ,/ 要求/ 在/ 阶段/ 1/ 中/ 查询/ 的/ 每个/ 私钥/ 对应/ 的/ 身份/ 向量/ 犐/ 不能/ 是/ 犐/ / 0/ 或/ 犐/ / 1/ 的/ 前缀/ ./ 挑战者/ 进行/ 随机/ 投币/ ,/ 得到/ 两个/ 随机/ 比特/ β/ ,/ γ/ (/ β/ ,/ γ/ ∈/ {/ 0/ ,/ 1/ }/ )/ ,/ 然后/ 使用/ 身份/ 向量/ 犐/ / γ/ 对/ 消息/ M/ / 密/ ,/ 并/ 将/ 得到/ 的/ 密文/ CT/ / 返回/ 给/ 敌手/ ./ 阶段/ 2/ ./ 重复/ 阶段/ 1/ 中/ 的/ 各类/ 查询/ ,/ 要求/ 每个/ 被/ 查询/ 的/ 私钥/ 对应/ 的/ 身份/ 向量/ 犐/ 不能/ 是/ 犐/ / 0/ 或/ 犐/ / 1/ 的/ 前缀/ ./ 猜测/ ./ 敌手/ 输出/ 对/ (/ β/ ,/ γ/ )/ 的/ 猜测/ (/ β/ / ,/ γ/ / )/ ./ 在/ 这个/ 游戏/ 中/ ,/ 敌手/ / 的/ 优势/ 定义/ 为/ 定义/ 1/ ./ 一个/ HIBE/ 方案/ 是/ 匿名性/ 的/ 、/ 抵抗/ 适应性/ 选择/ 身份/ 和/ 选择/ 明文/ 攻击/ 安全/ 的/ (/ ANON/ -/ ID/ -/ CPA/ )/ ,/ 当且/ 仅/ 当/ 任何/ 多项式/ 时间/ 的/ 敌手/ 在/ 上面/ 游戏/ 中/ 的/ 优势/ 都/ 是/ 可/ 忽略/ 的/ ./ 我们/ 省略/ 了/ IBE/ 方案/ 及其/ 安全性/ 的/ 形式化/ 定义/ ,/ 因为/ IBE/ 方案/ 是/ 一种/ 特殊/ 的/ HIBE/ 方案/ ,/ 其/ 等级/ 的/ 最大/ 深度/ l/ =/ 1/ ./ 此外/ ,/ IBE/ 方案/ 中/ 没有/ 密钥/ 委托/ 算法/ ,/ 相应/ 的/ 安全性/ 定义/ 中/ 没有/ 委托/ 查询/ ,/ 因此/ 我们/ 可以/ 认为/ ,/ 当/ 敌手/ 对/ 某个/ 身份/ I/ 进行/ 查询/ 时/ ,/ 挑战者/ 直接/ 将/ 该/ 身份/ 对应/ 的/ 私钥/ 返回/ 给/ 敌手/ ,/ 而/ 无需/ 在/ S/ 中/ 保存/ ./ 2.4/ 合数/ 阶/ 双线性/ 群/ 合数/ 阶/ 双线性/ 群是/ 在/ 文献/ [/ 9/ ]/ 中/ 被/ 提出/ 的/ ,/ 本文/ 利用/ 一个/ 群/ 发生器/ / (/ 可/ 视为/ 一个/ 群/ 生成/ 算法/ )/ 对/ 其/ 定义/ ./ 该/ 算法/ 以/ 安全/ 参数/ λ/ 为/ 输入/ ,/ 输出/ 一个/ 对/ 双线性/ 群/ G/ 的/ 描述/ ./ 本文/ 中/ ,/ / 的/ 输出/ 为/ 一个/ 四元组/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ 其中/ p/ [/ 1/ ]/ ,/ p/ [/ 2/ ]/ ,/ p/ [/ 3/ ]/ ,/ p/ [/ 4/ ]/ 分别/ 是/ 4/ 个/ 安全/ 素数/ ,/ G/ 和/ GT/ 为/ 两个/ N/ 阶/ 循环群/ ,/ 并且/ 有/ 双线性/ 映射/ e/ :/ G/ ×/ G/ →/ GT/ ,/ 满足/ (/ 1/ )/ 双线性/ 性/ ./ 对于/ 任意/ 的/ g/ ,/ h/ ∈/ G/ ,/ a/ ,/ b/ ∈/ ZN/ ,/ 有/ e/ (/ ga/ ,/ hb/ )/ =/ e/ (/ g/ ,/ h/ )/ ab/ ;/ (/ 2/ )/ 非/ 退化/ 性/ ./ 存在/ g/ ∈/ G/ ,/ 使得/ e/ (/ g/ ,/ g/ )/ 在/ GT/ 的/ 阶为/ N/ ./ 我们/ 进一步/ 要求/ 在/ 群/ G/ 和/ GT/ 中/ 的/ 运算/ 以及/ 双线性/ 映射/ e/ 都/ 是/ 多项式/ 时间/ 可/ 计算/ 的/ ./ 同时/ ,/ 假设/ 对群/ G/ 和/ GT/ 的/ 描述/ 中/ 包含/ 了/ 二者/ 的/ 生成元/ ./ 令/ Gp/ [/ 1/ ]/ ,/ Gp/ [/ 2/ ]/ ,/ Gp/ [/ 3/ ]/ ,/ Gp/ [/ 4/ ]/ 分别/ 表示/ 群/ G/ 的/ p/ [/ 1/ ]/ ,/ p/ [/ 2/ ]/ ,/ p/ [/ 3/ ]/ ,/ p/ [/ 4/ ]/ 阶/ 子群/ ./ 当/ hi/ ∈/ Gp/ [/ i/ ]/ ,/ hj/ ∈/ Gp/ [/ j/ ]/ ,/ 且/ i/ ≠/ j/ 时/ ,/ e/ (/ hi/ ,/ hj/ )/ 是/ GT/ 中/ 的/ 单位/ 元/ ./ 例如/ ,/ h1/ ∈/ Gp/ [/ 1/ ]/ ,/ h2/ ∈/ Gp/ [/ 2/ ]/ ,/ g/ 表示/ 群/ G/ 的/ 生成元/ ./ 由于/ gp/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ 为/ 子群/ Gp/ [/ 1/ ]/ 的/ 生成元/ ,/ gp/ [/ 1/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ 为/ 子群/ Gp/ [/ 2/ ]/ 的/ 生成/ Page4/ 元/ ,/ 因此/ 一定/ 存在/ α/ 和/ β/ ,/ 使得/ h1/ =/ (/ gp/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ )/ α/ ,/ h2/ =/ (/ gp/ [/ 1/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ )/ β/ ,/ 从而/ 得到/ e/ (/ h1/ ,/ h2/ )/ =/ e/ (/ gp/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ·/ α/ ,/ gp/ [/ 1/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ·/ β/ )/ 这种/ 性质/ ,/ 称为/ 子群/ Gp/ [/ 1/ ]/ ,/ Gp/ [/ 2/ ]/ ,/ Gp/ [/ 3/ ]/ ,/ Gp/ [/ 4/ ]/ 的/ 正交/ 性/ ,/ 是/ 本文/ 中/ 构造/ 方案/ 的/ 一个/ 重要/ 工具/ ./ 2.5/ 复杂性/ 假设/ 本/ 小节/ 给出/ 文中/ 用到/ 的/ 复杂性/ 假设/ ,/ 这些/ 假设/ 将/ 用于/ 证明/ 文中/ 方案/ 的/ 安全性/ ./ 它们/ 全部/ 为/ 静态/ 假设/ (/ 不/ 依赖于/ 方案/ 中/ 等级/ 的/ 深度/ 以及/ 安全/ 游戏/ 中/ 敌手/ 能够/ 进行/ 查询/ 的/ 次数/ )/ ,/ 并且/ 当/ 群的阶/ (/ 大/ 整数/ )/ 难以/ 分解/ 时/ ,/ 在/ 一般/ 群/ 模型/ 中是/ 成立/ 的/ ./ 这些/ 假设/ 均/ 可以/ 通过/ Katz/ 等/ 人/ 在/ 文献/ [/ 12/ ]/ 中/ 提出/ 的/ 理论/ 进行/ 证明/ ./ 他们/ 的/ 工作/ 同样/ 用到/ 了/ 合数/ 阶/ 双线性/ 群/ 并且/ 提供/ 了/ 一种/ 通用/ 框架/ 用以/ 证明/ 这/ 类/ 假设/ 的/ 安全性/ ./ 在/ 下面/ 的/ 假设/ 中/ ,/ 我们/ 用/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ 等/ 表示/ G/ 中/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ 阶/ 子群/ ./ 假设/ 1/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ Adv1/ / ,/ / (/ λ/ )/ / T1/ ←/ Gp/ [/ i/ ]/ p/ [/ 2/ ]/ ,/ T2/ ←/ Gp/ [/ i/ ]/ ,/ i/ ∈/ {/ 1/ ,/ 3/ ,/ 4/ }/ ./ 我们/ 定义/ 敌手/ / 打破/ 假设/ 1/ 的/ 优势/ 为/ |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv1/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 1/ ,/ 即/ 假设/ 1/ 成立/ ./ 假设/ 2/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ 我们/ 定义/ 敌手/ / 打破/ 假设/ 2/ 的/ 优势/ 为/ Adv2/ / ,/ / (/ λ/ )/ / |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv2/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 2/ ,/ 即/ 假设/ 2/ 成立/ ./ 假设/ 3/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ 我们/ 定义/ 敌手/ / 打破/ 假设/ 3/ 的/ 优势/ 为/ Adv3/ / ,/ / (/ λ/ )/ / |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv3/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 3/ ,/ 即/ 假设/ 3/ 成立/ ./ 假设/ 4/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ X1/ ←/ Gp/ [/ 1/ ]/ ,/ X2/ ,/ Y2/ ,/ Z2/ ←/ Gp/ [/ 2/ ]/ ,/ X3/ ←/ Gp/ [/ 3/ ]/ ,/ 犇/ =/ (/ 犌/ ,/ X1/ ,/ Z2/ ,/ X3/ ,/ X4/ ,/ X/ α/ 我们/ 定义/ 敌手/ / 打破/ 假设/ 4/ 的/ 优势/ 为/ Adv4/ / ,/ / (/ λ/ )/ / |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv4/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 4/ ,/ 即/ 假设/ 4/ 成立/ ./ 假设/ 5/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ X1/ ←/ Gp/ [/ 1/ ]/ ,/ X2/ ,/ Y2/ ,/ Z2/ ←/ Gp/ [/ 2/ ]/ ,/ X3/ ←/ Gp/ [/ 3/ ]/ ,/ 犇/ =/ (/ 犌/ ,/ Z2/ ,/ X3/ ,/ X4/ ,/ X1X2/ ,/ X/ α/ 我们/ 定义/ 敌手/ / 打破/ 假设/ 5/ 的/ 优势/ 为/ Adv5/ / ,/ / (/ λ/ )/ / |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv5/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 5/ ,/ 即/ 假设/ 5/ 成立/ ./ 假设/ 6/ ./ 给定/ 一个/ 群/ 发生器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / (/ λ/ )/ →/ 犌/ =/ (/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ X1/ ,/ Y1/ ←/ Gp/ [/ 1/ ]/ ,/ X2/ ←/ Gp/ [/ 2/ ]/ ,/ X3/ ←/ Gp/ [/ 3/ ]/ ,/ 犇/ =/ (/ 犌/ ,/ X1/ ,/ X3/ ,/ X4/ ,/ X/ κ/ 我们/ 定义/ 敌手/ / 打破/ 假设/ 6/ 的/ 优势/ 为/ Page5Adv6/ / ,/ / (/ λ/ )/ / |/ Pr/ [/ / (/ 犇/ ,/ T1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ 犇/ ,/ T2/ )/ ]/ =/ 1/ |/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv6/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 发生器/ / 满足/ 假设/ 6/ ,/ 即/ 假设/ 6/ 成立/ ./ 3/ 匿名/ IBE/ 方案/ 本节/ 将/ 给出/ 一个/ 新/ 的/ 匿名/ IBE/ 方案/ ,/ 其/ 安全性/ 证明/ 使用/ 了/ 双系统/ 加密技术/ ./ 该/ 方案/ 构造/ 中/ 使用/ 了/ 合数/ 阶/ 双线性/ 群/ ,/ 阶为/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ 其中/ p/ [/ 1/ ]/ ,/ p/ [/ 2/ ]/ ,/ p/ [/ 3/ ]/ ,/ p/ [/ 4/ ]/ 分别/ 为/ 4/ 个/ 安全/ 素数/ ,/ 并且/ 方案/ 中/ 的/ “/ 身份/ ”/ 是/ 在/ ZN/ 中/ 定义/ 的/ ./ 该/ 方案/ 在结构上/ 与/ LW/ -/ IBE/ [/ 11/ ]/ 非常/ 相似/ ,/ 但是/ 在/ 公共/ 参数/ 以及/ 密文/ 中/ 添加/ 了/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ,/ 从而/ 实现/ 了/ 密文/ 的/ 匿名性/ ,/ 这一/ 思想/ 是/ 受到/ Seo/ 的/ 匿名/ HIBE/ [/ 7/ ]/ 的/ 启发/ ./ 与/ LW/ -/ IBE/ 类似/ ,/ 子群/ Gp/ [/ 2/ ]/ 不/ 出现/ 在/ 实际/ 方案/ 中/ ,/ 它/ 仅/ 用于/ 构造/ 半/ 功能/ 的/ (/ semi/ -/ functional/ )/ 密钥/ 和/ 密文/ ,/ 当/ 密钥/ 和/ 密文/ 中/ 包含/ Gp/ [/ 2/ ]/ 中/ 的/ 分量/ 时/ 称为/ 半/ 功能/ 的/ ./ 本/ 方案/ 中/ ,/ 解密/ 将/ 通过/ 密钥/ 元素/ 与/ 密文/ 元素/ 的/ 对/ 运算/ (/ pairing/ )/ 进行/ ,/ 这种/ 解密/ 方式/ 将/ 提供/ 一个/ 重要/ 功能/ :/ 当/ 一个/ 正规/ (/ normal/ )/ 密钥/ 解密/ 一个半/ 功能/ 密文/ 时/ 或者/ 一个/ 正规/ 密文/ 被/ 一个半/ 功能/ 密钥/ 解密/ 时/ ,/ 由于/ Gp/ [/ 2/ ]/ 中/ 的/ 分量/ 在/ 对/ 运算/ 下/ 正交/ 于/ Gp/ [/ 1/ ]/ ,/ Gp/ [/ 3/ ]/ ,/ Gp/ [/ 4/ ]/ 中/ 的/ 分量/ ,/ 因此/ 解密/ 得以/ 正常/ 进行/ ./ 当对/ 运算/ 在/ 半/ 功能/ 密钥/ 和/ 半/ 功能/ 密文/ 间/ 进行/ 时/ ,/ 会/ 有/ 一个/ 额外/ 的/ 扰动/ 分量/ (/ Gp/ [/ 2/ ]/ 中/ 的/ 分量/ )/ 出现/ 在/ 盲化/ 因子/ 中/ ,/ 因此/ 解密/ 无法/ 正常/ 进行/ ./ 3.1/ 匿名/ IBE/ 方案/ Setup/ (/ λ/ ,/ l/ =/ 1/ )/ ./ 建立/ 算法/ 选择/ 一个/ 双线性/ 循环群/ G/ ,/ 阶为/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ 其中/ p/ [/ 1/ ]/ ,/ p/ [/ 2/ ]/ ,/ p/ [/ 3/ ]/ ,/ p/ [/ 4/ ]/ 分别/ 是/ 4/ 个/ 安全/ 素数/ ./ 令/ Gp/ [/ i/ ]/ 表示/ G/ 中/ 的/ p/ [/ i/ ]/ 阶/ 子群/ ,/ gp/ [/ i/ ]/ 表示/ 子群/ Gp/ [/ i/ ]/ 的/ 生成元/ ,/ g/ 表示/ 群/ G/ 的/ 生成元/ ./ 它/ 随后/ 随机/ 选取/ u/ ,/ v/ ,/ w/ ←/ Gp/ [/ 1/ ]/ ,/ Ru/ ,/ Rv/ ,/ Rw/ ←/ Gp/ [/ 4/ ]/ ,/ α/ ←/ ZN/ ,/ 并/ 计算/ U/ =/ u/ ·/ Ru/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ ./ 公布/ 公共/ 参数/ :/ PK/ =/ {/ N/ ,/ gp/ [/ 3/ ]/ ,/ gp/ [/ 4/ ]/ ,/ U/ ,/ V/ ,/ W/ ,/ E/ }/ ./ 保存/ 主/ 密钥/ :/ MSK/ =/ {/ u/ ,/ v/ ,/ w/ ,/ α/ }/ ./ KeyGen/ (/ PK/ ,/ MSK/ ,/ I/ )/ ./ 密钥/ 提取/ 算法/ 随机/ 选择/ r/ ←/ ZN/ ,/ R3/ ,/ R3/ ←/ Gp/ [/ 3/ ]/ ,/ 构造/ 身份/ I/ 对应/ 的/ 密钥/ :/ SK/ 犐/ =/ {/ K1/ ,/ K2/ }/ ,/ 其中/ K1/ =/ vrR3/ ,/ K2/ =/ v/ α/ (/ uIw/ )/ rR3/ ./ Encrypt/ (/ PK/ ,/ M/ ,/ I/ )/ :/ 加密算法/ 随机/ 选择/ s/ ←/ ZN/ ,/ R4/ ,/ R4/ ←/ Gp/ [/ 4/ ]/ ,/ 并/ 计算/ 密文/ :/ CT/ =/ {/ C0/ ,/ C1/ ,/ C2/ }/ ,/ 其中/ C0/ =/ M/ ·/ Es/ ,/ C1/ =/ (/ UIW/ )/ s/ ·/ R4/ ,/ C2/ =/ Vs/ ·/ R4/ ./ Decrypt/ (/ PK/ ,/ CT/ ,/ SKi/ )/ ./ 解密/ 算法/ 计算/ 盲化/ 因子/ :/ Es/ =/ e/ (/ K2/ ,/ C2/ )/ // e/ (/ K1/ ,/ C1/ )/ ,/ 从而/ 解密/ 消息/ :/ M/ =/ C0/ // Es/ ./ 3.2/ 匿名/ IBE/ 方案/ 的/ 安全性/ 证明/ 为了/ 证明/ 本/ 匿名/ IBE/ 方案/ 的/ 安全性/ ,/ 我们/ 使用/ 了/ 文献/ [/ 11/ ]/ 中/ 介绍/ 的/ 构造/ 双系统/ 加密/ 的/ 新/ 技术/ ,/ 定义/ 了/ 两个/ 额外/ 的/ 结构/ :/ 半/ 功能/ 密文/ 和/ 半/ 功能/ 密钥/ ./ 它们/ 并/ 不/ 出现/ 在/ 实际/ 的/ 方案/ 中/ ,/ 仅/ 用于/ 方案/ 的/ 安全性/ 证明/ ./ 半/ 功能/ 密文/ ./ 令/ gp/ [/ 2/ ]/ 表示/ 子群/ Gp/ [/ 2/ ]/ 的/ 生成元/ ,/ 我们/ 通过/ 如下/ 步骤/ 得到/ 一组/ 半/ 功能/ 密文/ :/ 首先/ ,/ 调用/ 加密算法/ 得到/ 一组/ 正规/ 的/ 密文/ C0/ ,/ C1/ ,/ C2/ ;/ 然后/ ,/ 随机/ 选取/ x/ ,/ z/ [/ c/ ]/ ←/ ZN/ ,/ 并/ 将/ C0/ 设置/ 为/ C0/ ,/ C1/ 设置/ 为/ p/ [/ 2/ ]/ ,/ C2/ 设置/ 为/ C2gxC1gx/ ·/ z/ [/ c/ ]/ 半/ 功能/ 密钥/ ./ 我们/ 通过/ 如下/ 步骤/ 得到/ 一组/ 半/ 功能/ 密钥/ :/ 首先/ ,/ 调用/ 密钥/ 提取/ 算法/ 得到/ 一组/ 正规/ 的/ 密钥/ K1/ ,/ K2/ ;/ 然后/ ,/ 随机/ 选取/ y/ ,/ z/ [/ k/ ]/ ←/ ZN/ ,/ 并/ 将/ K1/ 设置/ 为/ K1gy/ 如果/ 一个半/ 功能/ 密钥/ 用于/ 解密/ 一个半/ 功能/ 密文/ ,/ 那么/ 盲化/ 因子/ 中将/ 出现/ 一个/ 额外/ 的/ 扰动/ 分量/ e/ (/ gp/ [/ 2/ ]/ ,/ gp/ [/ 2/ ]/ )/ x/ ·/ y/ ·/ (/ z/ [/ k/ ]/ -/ z/ [/ c/ ]/ )/ ./ 但/ 当/ z/ [/ c/ ]/ =/ z/ [/ k/ ]/ 时/ ,/ 解密/ 仍然/ 能够/ 正常/ 进行/ ./ 在/ 这种/ 情况/ 下/ ,/ 我们/ 称该/ 密钥/ 是/ 象征性/ (/ nominally/ )/ 半/ 功能/ 的/ :/ 它/ 含有/ Gp/ [/ 2/ ]/ 中/ 的/ 分量/ ,/ 但是/ 仍能/ 成功/ 解密/ 半/ 功能/ 密文/ ./ 方案/ 的/ 安全性/ 证明/ 依赖于/ 2.5/ 节中/ 给出/ 的/ 假设/ 1/ ~/ 5/ ./ 我们/ 使用/ 了/ 混合/ 争论/ (/ hybridargument/ )/ 技术/ ,/ 借助/ 一系列/ 两/ 两/ 不可/ 区分/ 的/ 游戏/ (/ GameReal/ ,/ GameRestricted/ ,/ Game0/ ,/ …/ ,/ Gameq/ ,/ GamePre/ -/ Final/ ,/ GameFinal/ )/ 证明/ 方案/ 的/ 安全性/ ./ 第/ 1/ 个/ 游戏/ ,/ GameReal/ ,/ 是/ 真实/ 的/ 游戏/ ,/ 即/ 第/ 2.3/ 节/ 匿名/ (/ H/ )/ IBE/ 的/ 安全性/ 定义/ 中/ 所/ 描述/ 的/ 游戏/ ./ 第/ 2/ 个/ 游戏/ ,/ GameRestricted/ ,/ 与/ GameReal/ 仅/ 有/ 一处/ 区别/ ,/ 敌手/ 不能/ 对/ 那些/ 与/ 用于/ 挑战/ 的/ 身份/ (/ ZN/ 中/ 的/ 元素/ )/ modp/ [/ 2/ ]/ 相等/ 的/ 身份/ 进行/ 私钥/ 查询/ ./ 这是/ 一个/ 比/ 真实/ 游戏/ 中/ 更/ 强/ 的/ 限制/ ,/ 真实/ 游戏/ 仅/ 要求/ 用于/ 挑战/ 的/ 身份/ 与/ 被/ 查询/ 的/ 身份/ modN/ 不/ 等/ ./ 后面/ 定义/ 的/ 一系列/ 游戏/ 都/ 保持/ 这个/ 较强/ 的/ 限制/ ./ 进行/ 这个/ 限制/ 的/ 原因/ ,/ 我们/ 将/ 在/ 引理/ 3/ 的/ 证明/ 中/ 说明/ ./ 下/ 一个/ 游戏/ ,/ Game0/ ,/ 与/ GameRestricted/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ Game0/ 中/ 挑战/ 阶段/ 返回/ 给/ 敌手/ 的/ 密文/ 是/ 半/ 功能/ 的/ ./ 令/ q/ 表示/ 在/ 阶段/ 1/ 和/ 阶段/ 2/ 中/ 敌手/ 能够/ 进行/ 私钥/ 查询/ 的/ 最大/ 次数/ ./ 下面/ 我们/ 定义/ q/ 个/ 游戏/ ,/ {/ Gamek/ }/ k/ ∈/ [/ 1/ ,/ q/ ]/ ,/ 与/ Game0/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ Gamek/ 中/ 返回/ 给/ 敌手/ 的/ 前/ k/ 个/ 私钥/ 为/ 半/ 功能/ 的/ ,/ 其/ Page6/ 它/ 的/ 私钥/ 仍为/ 正规/ 的/ ./ 也就是说/ ,/ 在/ Game0/ 中/ ,/ 返回/ 的/ 密文/ 是/ 半/ 功能/ 的/ ,/ 而/ 返回/ 的/ 所有/ 密钥/ 都/ 是/ 正规/ 的/ ;/ 在/ Gameq/ 中/ ,/ 返回/ 的/ 密文/ 以及/ 所有/ 的/ 密钥/ 都/ 是/ 半/ 功能/ 的/ ./ 倒数第/ 2/ 个/ 游戏/ ,/ GamePre/ -/ Final/ ,/ 与/ Gameq/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ GamePre/ -/ Final/ 中/ ,/ 返回/ 给/ 敌手/ 的/ 是/ 对/ 一个/ 随机/ 消息/ 加密/ 得到/ 的/ 半/ 功能/ 密文/ ./ 最后/ 一个/ 游戏/ ,/ GameFinal/ ,/ 与/ GamePre/ -/ Final/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ GameFinal/ 中/ ,/ 返回/ 给/ 敌手/ 的/ 半/ 功能/ 密文/ 是/ 使用/ 一个/ 随机/ 身份/ 对/ 一个/ 随机/ 消息/ 进行/ 加密/ 所得/ 的/ ./ 我们/ 利用/ 下面/ 的/ 5/ 个/ 引理/ 证明/ 以上/ 游戏/ 是/ 两/ 两/ 不可/ 区分/ 的/ ./ 引理/ 1/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GameRealAdv/ / -/ GameRestrictedAdv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ 大于/ 等于/ ε/ // 3/ 的/ 优势/ 打破/ 假设/ 1/ ./ 证明/ ./ 算法/ / 利用/ X1/ ,/ X3/ ,/ X4/ 作为/ 输入/ ,/ 能够/ 模拟/ GameReal/ ./ 若/ / 能够/ 以/ 概率/ ε/ 生成/ 身份/ I/ 和/ 用于/ 挑战/ 的/ 身份/ I/ [/ γ/ ]/ / (/ γ/ ∈/ {/ 0/ ,/ 1/ }/ )/ ,/ 使得/ I/ ≠/ I/ [/ γ/ ]/ / modN/ ,/ 同时/ p/ [/ 2/ ]/ 整除/ I/ -/ I/ [/ γ/ ]/ / ,/ 则/ / 可以/ 利用/ 这/ 两个/ 身份/ ,/ 计算/ a/ =/ gcd/ (/ I/ -/ I/ [/ γ/ ]/ / ,/ N/ )/ ,/ 从而/ 得到/ 一个/ N/ 的/ 非/ 平凡/ 因子/ ./ 令/ b/ =/ N/ // a/ ./ 由于/ p/ [/ 2/ ]/ 整除/ a/ ,/ 同时/ N/ =/ ab/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ 因此/ 可能/ 存在/ 3/ 种/ 情况/ :/ p/ [/ 1/ ]/ 整除/ b/ ;/ p/ [/ 3/ ]/ 整除/ b/ ;/ p/ [/ 4/ ]/ 整除/ b/ ./ 至少/ 有/ 一种/ 情况/ 发生/ 的/ 概率/ 大于/ 等于/ ε/ // 3/ ./ 在/ 每种/ 情况/ 中/ ,/ / 都/ 能/ 用/ 下面/ 的/ 方式/ 打破/ 假设/ 1/ :/ 给定/ X1/ ,/ X3/ ,/ X4/ ,/ T/ ,/ / 能够/ 通过/ 验证/ Xb/ 确定/ p/ [/ i/ ]/ (/ i/ ∈/ {/ 1/ ,/ 3/ ,/ 4/ }/ )/ 是否/ 整除/ b/ ,/ 进而/ 验证/ Tb/ 是否/ 为/ 单位/ 元/ ./ 如果/ 是/ 单位/ 元/ ,/ 则/ T/ ∈/ Gp/ [/ i/ ]/ ,/ 否则/ T1/ ∈/ Gp/ [/ i/ ]/ p/ [/ 2/ ]/ ./ 引理/ 2/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ 4/ ,/ Ru/ =/ Ra/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 2/ ./ 证明/ ./ / 利用/ X1/ ,/ X3/ ,/ X4/ ,/ T/ 作为/ 输入/ ,/ 模拟/ GameRestricted/ 或/ Game0/ ./ 它/ 设置/ 公共/ 参数/ 如下/ :/ / 随机/ 选取/ a/ ,/ b/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ u/ =/ va/ ,/ w/ =/ vb/ ,/ Rv/ =/ X/ δ/ U/ =/ u/ ·/ Ru/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ }/ 返回/ 给/ / ./ 每当/ / 被/ 查询/ 身份/ I/ [/ i/ ]/ 对应/ 的/ 私钥/ 时/ ,/ 它/ 随机/ 选取/ r/ [/ i/ ]/ ,/ s/ [/ i/ ]/ ,/ t/ [/ i/ ]/ ←/ ZN/ ,/ 并/ 返回/ K1/ =/ vr/ [/ i/ ]/ Xt/ [/ i/ ]/ K2/ =/ v/ α/ (/ uI/ [/ i/ ]/ w/ )/ r/ [/ i/ ]/ Xs/ [/ i/ ]/ / 给/ / 发送/ 两个/ 消息/ ,/ M/ / 0/ ,/ M/ / 1/ ,/ 和/ 两个/ 身份/ I/ [/ 0/ ]/ / ,/ I/ [/ 1/ ]/ / ./ / 选择/ 两个/ 随机/ 比特/ β/ ,/ γ/ (/ β/ ,/ γ/ ∈/ {/ 0/ ,/ 1/ }/ )/ ,/ 产生/ 密文/ 如下/ :/ C0/ =/ M/ / 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 4/ ]/ ,/ 那么/ 这是/ 一个半/ 功能/ 密文/ ,/ 其中/ z/ [/ c/ ]/ =/ aI/ [/ γ/ ]/ / +/ b/ ./ 由于/ z/ [/ c/ ]/ modp/ [/ 2/ ]/ 是/ 一个/ 与/ amodp/ [/ 1/ ]/ 及/ bmodp/ [/ 1/ ]/ 无关/ 的/ 值/ ,/ 因此/ 它/ 的/ 分布/ 是/ 恰当/ 的/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 4/ ]/ ,/ 那么/ 这是/ 一个/ 正规/ 的/ 密文/ ./ 因此/ ,/ / 可以/ 用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 3/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 3/ ./ 证明/ ./ / 利用/ X1/ ,/ X3/ ,/ X4/ ,/ Y1X2Y4/ ,/ Y2Y3/ ,/ T/ 作为/ 输入/ ,/ 模拟/ Gamek/ -/ 1/ 或/ Gamek/ ./ 它/ 随机/ 选取/ a/ ,/ b/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ u/ =/ va/ ,/ w/ =/ vb/ ,/ Rv/ =/ X/ δ/ v/ ,/ Rw/ =/ RbRav/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ }/ 发送给/ / ./ 当/ / 进行/ 第/ i/ 次/ 私钥/ 查询/ 时/ (/ 针对/ 身份/ I/ [/ i/ ]/ )/ :/ 对于/ i/ </ k/ 的/ 情况/ ,/ / 生成/ 一组/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ i/ ]/ ,/ s/ [/ i/ ]/ ,/ t/ [/ i/ ]/ ←/ ZN/ ,/ 并/ 返回/ :/ K1/ =/ vr/ [/ i/ ]/ (/ Y2Y3/ )/ t/ [/ i/ ]/ ,/ K2/ =/ v/ α/ (/ uI/ [/ i/ ]/ w/ )/ r/ [/ i/ ]/ (/ Y2Y3/ )/ s/ [/ i/ ]/ ./ 对于/ i/ >/ k/ 的/ 情况/ ,/ / 生成/ 一组/ 正规/ 的/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ i/ ]/ ,/ s/ [/ i/ ]/ ,/ t/ [/ i/ ]/ ←/ ZN/ ,/ 并/ 返回/ :/ K1/ =/ 3/ ,/ K2/ =/ v/ α/ (/ uI/ [/ i/ ]/ w/ )/ r/ [/ i/ ]/ Xs/ [/ i/ ]/ vr/ [/ i/ ]/ Xt/ [/ i/ ]/ 对于/ i/ =/ k/ 的/ 情况/ ,/ / 设置/ z/ [/ k/ ]/ =/ aI/ [/ k/ ]/ +/ b/ ,/ 随机/ 选取/ s/ [/ k/ ]/ ←/ ZN/ ,/ 并/ 返回/ :/ K1/ =/ T/ ,/ K2/ =/ v/ α/ Tz/ [/ k/ ]/ Xs/ [/ k/ ]/ / 发送给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ 和/ 两个/ 身份/ I/ [/ 0/ ]/ / ,/ I/ [/ 1/ ]/ / ./ / 随机/ 选取/ β/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ./ 构造/ 密文/ 如下/ :/ C0/ =/ M/ / C2/ =/ Y1X2Y4/ ./ 令/ vs/ =/ Y1/ ,/ RsS4/ 是/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 因为/ f/ (/ I/ [/ γ/ ]/ / )/ =/ aI/ [/ γ/ ]/ / +/ bmodp/ [/ 2/ ]/ 是/ 一个/ 两/ 两/ 无关/ 的/ 函数/ ,/ 因此/ 对于/ I/ [/ k/ ]/ ≠/ I/ [/ γ/ ]/ / modp/ [/ 2/ ]/ ,/ / 可/ 将/ z/ [/ k/ ]/ 和/ z/ [/ c/ ]/ 看作/ 是/ 随机/ 分布/ 的/ (/ amodp/ [/ 2/ ]/ 以及/ bmodp/ [/ 2/ ]/ 与/ 它们/ modp/ [/ 1/ ]/ 的/ 值/ 是/ 不/ 相关/ 的/ )/ ./ 如果/ I/ [/ k/ ]/ ≡/ I/ [/ γ/ ]/ / ,/ / 的/ 查询/ 不/ 合法/ ,/ 这/ 正是/ 我们/ 对/ 模数/ 做/ 额外/ 限制/ 的/ 原因/ ./ 虽然/ z/ [/ k/ ]/ 和/ z/ [/ c/ ]/ 之间/ 的/ 关系/ 对/ / 是/ 隐藏/ 的/ ,/ 但是/ 这种/ 关系/ 对/ 我们/ 的/ 证明/ 是/ 至关重要/ 的/ :/ 如果/ / 试图/ 通过/ “/ 自己/ 生成/ 一个/ 用/ I/ [/ k/ ]/ 加密/ 的/ 半/ 功能/ 密文/ 并/ 尝试/ 解密/ ”/ 这种/ 方法/ 来/ 测试/ SKI/ [/ k/ ]/ 是否/ 为/ 半/ 功能/ 的/ ,/ 那么/ 无论/ SKI/ [/ k/ ]/ 是否/ 为/ 半/ 功能/ 的/ ,/ 解密/ 都/ 能/ 正常/ 工作/ ,/ 因为/ z/ [/ k/ ]/ =/ z/ [/ c/ ]/ ./ 换言之/ ,/ 模拟器/ 仅能/ 生成/ 一个/ 象征性/ (/ nominally/ )/ 半/ 功能/ 密钥/ ./ Page7/ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 3/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ Gamek/ -/ 1/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 3/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ Gamek/ ./ 因此/ ,/ / 能够/ 利用/ / 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 4/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 4/ ./ 证明/ ./ / 利用/ X1/ ,/ Z2/ ,/ X3/ ,/ X4/ ,/ X/ α/ T/ 作为/ 输入/ ,/ 模拟/ Gameq/ 或/ GamePre/ -/ Final/ ./ / 随机/ 选择/ a/ ,/ b/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ u/ =/ va/ ,/ w/ =/ vb/ ,/ Rv/ =/ 4/ ,/ Ru/ =/ RaX/ δ/ {/ X3/ ,/ X4/ ,/ U/ =/ u/ ·/ Ru/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ E/ =/ e/ (/ v/ α/ X2/ ,/ v/ )/ }/ ./ 当/ / 查询/ 身份/ I/ [/ i/ ]/ 的/ 密钥/ 时/ ,/ / 生成/ 对应/ 的/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ i/ ]/ ,/ s/ [/ i/ ]/ ,/ t/ [/ i/ ]/ ,/ x/ [/ i/ ]/ ,/ y/ [/ i/ ]/ ←/ ZN/ ,/ 并/ 返回/ :/ K1/ =/ vr/ [/ i/ ]/ Zx/ [/ i/ ]/ v/ α/ (/ uI/ [/ i/ ]/ w/ )/ r/ [/ i/ ]/ Zy/ [/ i/ ]/ / 给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ ,/ 和/ 两个/ 身份/ I/ [/ 0/ ]/ / ,/ I/ [/ 1/ ]/ / ./ / 随机/ 选取/ β/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ,/ 并/ 返回/ 密文/ :/ C0/ =/ β/ ·/ T/ ,/ C1/ =/ (/ XsM/ / 令/ z/ [/ c/ ]/ =/ aI/ [/ γ/ ]/ / +/ b/ ,/ RsGp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 在/ 这里/ ,/ z/ [/ c/ ]/ 仅/ 与其/ modp/ [/ 2/ ]/ 的/ 值/ 有关/ ,/ 由于/ u/ =/ va/ ,/ w/ =/ vb/ 是/ Gp/ [/ 1/ ]/ 中/ 元素/ ,/ 所以/ 当/ a/ 和/ b/ 是/ 在/ ZN/ 中/ 选取/ 时/ ,/ amodp/ [/ 1/ ]/ 以及/ bmodp/ [/ 1/ ]/ 与/ z/ [/ c/ ]/ =/ aI/ [/ γ/ ]/ / +/ bmodp/ [/ 2/ ]/ 是/ 无关/ 的/ ./ 如果/ T/ =/ e/ (/ X1/ ,/ X1/ )/ α/ ·/ s/ ,/ 那么/ 以上/ 密文/ 是/ 消息/ β/ 对应/ 的/ 半/ 功能/ 密文/ ./ 如果/ T/ 为/ GT/ 中/ 的/ 随机/ 元/ M/ / 素/ ,/ 那么/ 该/ 密文/ 是/ 对/ 一个/ 随机/ 消息/ 加密/ 得到/ 的/ 半/ 功能/ 密文/ ./ 因此/ ,/ / 可以/ 用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 5/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GamePre/ -/ FinalAdv/ / -/ GameFinalAdv/ / =/ ε/ ,/ 证明/ ./ / 利用/ Z2/ ,/ X3/ ,/ X4/ ,/ X1X2/ ,/ X/ α/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 5.1/ Z2Z4/ ,/ GT/ ,/ T/ 作为/ 输入/ ,/ 模拟/ GamePre/ -/ Final/ 或/ XsGameFinal/ ./ / 随机/ 选取/ a/ ,/ b/ ←/ ZN/ ,/ 并/ 设置/ V/ =/ X1X/ δ/ U/ =/ Va/ ,/ W/ =/ Vb/ ./ 它/ 将/ 公共/ 参数/ {/ X3/ ,/ X4/ ,/ U/ ,/ V/ ,/ W/ ,/ E/ =/ e/ (/ X/ α/ 的/ 密钥/ 时/ ,/ / 生成/ 对应/ 的/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ i/ ]/ ,/ s/ [/ i/ ]/ ,/ t/ [/ i/ ]/ ,/ x/ [/ i/ ]/ ,/ y/ [/ i/ ]/ ←/ ZN/ ,/ 并/ 返回/ :/ K1/ =/ (/ X1X2/ )/ r/ [/ i/ ]/ Zx/ [/ i/ ]/ K2/ =/ X/ α/ / 发送给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ ,/ 和/ 两个/ 身份/ I/ [/ 0/ ]/ / ,/ I/ [/ 1/ ]/ / ./ / 随机/ 选取/ CR/ ←/ GT/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ,/ 并/ 返回/ 密文/ :/ C0/ =/ CR/ ,/ C1/ =/ (/ T/ )/ aI/ [/ γ/ ]/ / +/ b/ ,/ C2/ =/ Xs/ 令/ z/ [/ c/ ]/ =/ aI/ [/ γ/ ]/ / +/ b/ ,/ Rs/ 群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 如果/ T/ =/ Xs/ 密文/ 是/ 一个/ 使用/ 身份/ I/ [/ γ/ ]/ / 对/ 一个/ 随机/ 消息/ 加密/ 的/ 半/ 功能/ 密文/ ./ 如果/ T/ 是/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ,/ 那么/ 该/ 密文/ 是/ 一个/ 使用/ 随机/ 身份/ 对/ 一个/ 随机/ 消息/ 加密/ 的/ 半/ 功能/ 密文/ ./ 因此/ ,/ / 可以/ 利用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ IBE/ 方案/ 是/ ANON/ -/ ID/ -/ CPA/ 的/ (/ 定义/ 1/ )/ ./ 至此/ ,/ 我们/ 得到/ 如下/ 定理/ ./ 定理/ 1/ ./ 如果/ 假设/ 1/ ~/ 5/ 成立/ ,/ 那么/ 我/ 的/ 匿名/ 证明/ ./ 根据/ 以上/ 5/ 个/ 引理/ 得知/ ,/ 如果/ 假设/ 1/ ~/ 5/ 成立/ ,/ 那么/ 真实/ 游戏/ GameReal/ 与/ GameFinal/ 是/ 不可/ 区分/ 的/ ./ 又/ 因/ GameFinal/ 中/ β/ 与/ γ/ 对/ 敌手/ 是/ 完全/ 隐藏/ 的/ (/ 信息论/ 意义/ 上/ 的/ )/ ,/ 所以/ 敌手/ 在/ GameFinal/ 中/ 的/ 优势/ 为/ 0/ ,/ 从而/ 得知/ 在/ GameReal/ 中/ 敌手/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 4/ 匿名/ HIBE/ 方案/ 我们/ 在/ 第/ 3/ 节/ 提出/ 的/ 匿名/ IBE/ 方案/ 的/ 基础/ 上/ 进行/ 扩展/ ,/ 给出/ 一个/ 具有/ 短/ 密文/ 的/ 匿名/ HIBE/ 方案/ ./ 新/ 方案/ 仍然/ 是/ 在/ 合数/ 阶/ 双线性/ 群中/ 构造/ 的/ ,/ 群的阶/ 为/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ./ 与/ 匿名/ IBE/ 方案/ 类似/ ,/ 本/ 匿名/ HIBE/ 方案/ 使用/ 了/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 元素/ 对/ 公共/ 参数/ 和/ 密文/ 进行/ 了/ 盲化/ 处理/ ,/ 并且/ 将/ 子群/ Gp/ [/ 2/ ]/ 用于/ 方案/ 的/ 安全性/ 证明/ ./ 4.1/ 匿名/ HIBE/ 方案/ Setup/ (/ λ/ ,/ l/ )/ ./ 建立/ 算法/ 选择/ 一个/ 双线性/ 循环群/ G/ ,/ 阶为/ N/ =/ p/ [/ 1/ ]/ ·/ p/ [/ 2/ ]/ ·/ p/ [/ 3/ ]/ ·/ p/ [/ 4/ ]/ ,/ 其中/ p/ [/ 1/ ]/ ,/ p/ [/ 2/ ]/ ,/ p/ [/ 3/ ]/ ,/ p/ [/ 4/ ]/ 分别/ 是/ 4/ 个/ 安全/ 素数/ ./ 令/ l/ 表示/ HIBE/ 方案/ 中/ 等级/ 深度/ 的/ 最大值/ ,/ Gp/ [/ i/ ]/ 表示/ G/ 中/ 的/ p/ [/ i/ ]/ 阶/ 子群/ ,/ gp/ [/ i/ ]/ 表示/ 子群/ Gp/ [/ i/ ]/ 的/ 生成元/ ,/ g/ 表示/ 群/ G/ 的/ 生成元/ ./ 它/ 随后/ 随机/ 选取/ u1/ ,/ …/ ,/ ul/ ,/ v/ ,/ w/ ,/ f/ ←/ Gp/ [/ 1/ ]/ ,/ Ru/ ,/ 1/ ,/ …/ ,/ Ru/ ,/ l/ ,/ Rv/ ,/ Rw/ ,/ Rf/ ←/ Gp/ [/ 4/ ]/ ,/ α/ ←/ ZN/ ,/ 并/ 计算/ U1/ =/ u1/ ·/ Ru/ ,/ 1/ ,/ …/ ,/ Ul/ =/ ul/ ·/ Ru/ ,/ l/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ F/ =/ f/ ·/ Rf/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ ./ 公布/ 公共/ 参数/ :/ PK/ =/ {/ N/ ,/ gp/ [/ 3/ ]/ ,/ gp/ [/ 4/ ]/ ,/ U1/ ,/ …/ ,/ Ul/ ,/ V/ ,/ W/ ,/ F/ ,/ E/ }/ ./ 保存/ 主/ 密钥/ :/ MSK/ =/ {/ u1/ ,/ …/ ,/ ul/ ,/ v/ ,/ w/ ,/ f/ ,/ α/ }/ ./ KeyGen/ (/ PK/ ,/ MSK/ ,/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ )/ ./ 密钥/ 提取/ 算法/ 随机/ 选择/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ←/ ZN/ ,/ P3/ ,/ 0/ ,/ P3/ ,/ 1/ ,/ P3/ ,/ 2/ ,/ Q3/ ,/ j/ +/ 1/ ,/ …/ ,/ Q3/ ,/ l/ ←/ Gp/ [/ 3/ ]/ ,/ 构造/ 身份/ 犐/ 对应/ 的/ 密钥/ :/ SK/ 犐/ =/ {/ Kd/ ,/ Kr/ }/ ,/ 其中/ ,/ Page8Kd/ =/ [/ vr/ [/ 1/ ]/ P3/ ,/ 0/ ,/ vr/ [/ 2/ ]/ P3/ ,/ 1/ ,/ v/ α/ (/ uI/ [/ 1/ ]/ j/ +/ 1Q3/ ,/ j/ +/ 1/ ,/ …/ ,/ ur/ [/ 1/ ]/ ur/ [/ 1/ ]/ Kr/ =/ [/ [/ vs/ [/ 1/ ]/ ,/ vs/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ [/ vt/ [/ 1/ ]/ ,/ vt/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ Delegate/ (/ PK/ ,/ SK/ 犐/ ,/ I/ [/ j/ +/ 1/ ]/ )/ :/ 密钥/ 委托/ 算法/ 以/ 身份/ 向量/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 对应/ 的/ 私钥/ SK/ 犐/ =/ {/ [/ a0/ ,/ 0/ ,/ a0/ ,/ 1/ ,/ a0/ ,/ 2/ ,/ b0/ ,/ j/ +/ 1/ ,/ …/ ,/ b0/ ,/ l/ ]/ ,/ [/ a1/ ,/ 0/ ,/ a1/ ,/ 1/ ,/ a1/ ,/ 2/ ,/ b1/ ,/ j/ +/ 1/ ,/ …/ ,/ b1/ ,/ l/ ]/ ,/ [/ a2/ ,/ 0/ ,/ a2/ ,/ 1/ ,/ a2/ ,/ 2/ ,/ b2/ ,/ j/ +/ 1/ ,/ …/ ,/ b2/ ,/ l/ ]/ }/ 为/ 输入/ ,/ 生成/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ ,/ I/ [/ j/ +/ 1/ ]/ )/ 对应/ 的/ 私钥/ SK/ 犐/ ./ 它/ 随机/ 选择/ γ/ [/ 1/ ]/ ,/ γ/ [/ 2/ ]/ ,/ γ/ [/ 3/ ]/ ,/ δ/ [/ 1/ ]/ ,/ δ/ [/ 2/ ]/ ,/ δ/ [/ 3/ ]/ ←/ ZN/ ,/ R3/ ,/ 0/ ,/ R3/ ,/ 1/ ,/ R3/ ,/ 2/ ,/ S3/ ,/ j/ +/ 2/ ,/ …/ ,/ S3/ ,/ l/ ←/ Gp/ [/ 3/ ]/ ./ 新/ 的/ 密钥/ 产生/ 如下/ :/ 1/ ./ 密钥/ 委托/ 过程/ :/ Kd/ ←/ [/ α/ 0/ ,/ 0/ α/ γ/ [/ 1/ ]/ β/ 0/ ,/ j/ +/ 2/ β/ γ/ [/ 1/ ]/ Kr/ ←/ [/ [/ α/ γ/ [/ 2/ ]/ [/ α/ γ/ [/ 3/ ]/ SK/ 犐/ =/ {/ Kd/ ,/ Kr/ }/ ./ 2/ ./ 重/ 随机/ 过程/ :/ I/ [/ j/ ]/ ,/ I/ [/ j/ +/ 1/ ]/ )/ ./ SK/ 犐/ 是/ 完全/ 随机/ 的/ ,/ 它/ 仅/ 依赖于/ 身份/ 向量/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ Encrypt/ (/ PK/ ,/ M/ ,/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ )/ ./ 加密算法/ 随机/ 选取/ s/ ←/ ZN/ ,/ R4/ ,/ 1/ ,/ R4/ ,/ 2/ ,/ R4/ ,/ 3/ ←/ Gp/ [/ 4/ ]/ ,/ 并/ 计算/ 密文/ :/ CT/ =/ {/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ }/ ,/ 其中/ C0/ =/ M/ ·/ Es/ ,/ C1/ =/ (/ UI/ [/ 1/ ]/ Fs/ ·/ R4/ ,/ 3/ ./ Decrypt/ (/ PK/ ,/ CT/ ,/ SK/ 犐/ )/ ./ 假设/ 解密/ 算法/ 的/ 输入/ 中/ ,/ 密钥/ Kd/ =/ [/ a0/ ,/ 0/ ,/ a0/ ,/ 1/ ,/ a0/ ,/ 2/ ,/ b0/ ,/ j/ +/ 1/ ,/ …/ ,/ b0/ ,/ l/ ]/ 和/ 密文/ CT/ =/ {/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ }/ 对应/ 着/ 相同/ 的/ 身份/ 向量/ 犐/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ ./ 如果/ 密钥/ 对应/ 的/ 身份/ 向量/ 为/ 犐/ 的/ 前缀/ ,/ 那么/ 解密/ 算法/ 首先/ 调用/ 密钥/ 委托/ 算法/ 产生/ 犐/ 对应/ 的/ 私钥/ ,/ 然后/ 计算/ 盲化/ 因子/ :/ Es/ =/ e/ (/ a0/ ,/ 2/ ,/ C2/ )/ // [/ e/ (/ a0/ ,/ 0/ ,/ C1/ )/ ·/ e/ (/ a0/ ,/ 1/ ,/ C3/ )/ ]/ ,/ 从而/ 解密/ 消息/ M/ =/ C0/ // Es/ ./ 4.2/ 匿名/ HIBE/ 方案/ 的/ 安全性/ 证明/ 方案/ 的/ 安全性/ 证明/ 依赖于/ 假设/ 1/ ~/ 6/ ./ 我们/ 首先/ 定义/ 3/ 个/ 额外/ 的/ 结构/ :/ 半/ 功能/ 密文/ 、/ 半/ 功能/ 密钥/ 以及/ 仿制/ 的/ (/ dummy/ )/ 半/ 功能/ 密钥/ ./ 它们/ 并/ 不/ 出现/ 在/ 实际/ 方案/ 中/ ,/ 仅/ 用于/ 方案/ 的/ 安全性/ 证明/ 中/ ./ 半/ 功能/ 密文/ ./ 令/ gp/ [/ 2/ ]/ 表示/ 子群/ Gp/ [/ 2/ ]/ 的/ 生成元/ ,/ 通过/ 如下/ 步骤/ 得到/ 一组/ 半/ 功能/ 密文/ :/ 首先/ ,/ 调用/ 加密算法/ 得到/ 一组/ 正规/ 的/ 密文/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ ;/ 然后/ ,/ 随机/ 选取/ x/ [/ 0/ ]/ ,/ x/ [/ 1/ ]/ ,/ z/ [/ c/ ]/ ←/ ZN/ ,/ 并/ 设置/ :/ C0/ =/ C0/ ,/ C1/ =/ C1gx/ [/ 0/ ]/ ·/ z/ [/ c/ ]/ p/ [/ 2/ ]/ ,/ C2/ =/ C2gx/ [/ 0/ ]/ 半/ 功能/ 密钥/ ./ 通过/ 如下/ 步骤/ 得到/ 一组/ 半/ 功能/ 密钥/ :/ 首先/ ,/ 调用/ 密钥/ 提取/ 算法/ 得到/ 一组/ 正规/ 的/ 密钥/ SK/ =/ {/ [/ a0/ ,/ 0/ ,/ a0/ ,/ 1/ ,/ a0/ ,/ 2/ ,/ b0/ ,/ j/ +/ 1/ ,/ …/ ,/ b0/ ,/ l/ ]/ ,/ [/ a1/ ,/ 0/ ,/ a1/ ,/ 1/ ,/ a1/ ,/ 2/ ,/ b1/ ,/ j/ +/ 1/ ,/ …/ ,/ b1/ ,/ l/ ]/ ,/ [/ a2/ ,/ 0/ ,/ a2/ ,/ 1/ ,/ a2/ ,/ 2/ ,/ b2/ ,/ j/ +/ 1/ ,/ …/ ,/ b2/ ,/ l/ ]/ }/ ;/ 然后/ ,/ 随机/ 选取/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ ,/ z/ [/ k/ ]/ ←/ ZN/ (/ j/ ∈/ [/ 1/ ,/ l/ -/ 1/ ]/ )/ ,/ 并/ 设置/ 半/ 功能/ 密钥/ 为/ SK/ =/ {/ [/ a0/ ,/ 0gy/ [/ a1/ ,/ 0/ ,/ a1/ ,/ 1/ ,/ a1/ ,/ 2/ ,/ b1/ ,/ j/ +/ 1/ ,/ …/ ,/ b1/ ,/ l/ ]/ ,/ [/ a2/ ,/ 0/ ,/ a2/ ,/ 1/ ,/ a2/ ,/ 2/ ,/ b2/ ,/ j/ +/ 1/ ,/ …/ ,/ b2/ ,/ l/ ]/ }/ ./ 当/ 一个半/ 功能/ 密钥/ 用于/ 解密/ 一个半/ 功能/ 密文/ 时/ ,/ 盲化/ 因子/ 中将/ 出现/ 一个/ 额外/ 的/ 扰动/ 分量/ e/ (/ gp/ [/ 2/ ]/ ,/ gp/ [/ 2/ ]/ )/ x/ [/ 0/ ]/ ·/ y/ ·/ (/ z/ [/ k/ ]/ -/ z/ [/ c/ ]/ )/ ./ 如果/ z/ [/ c/ ]/ =/ z/ [/ k/ ]/ ,/ 解密/ 仍然/ 能够/ 正常/ 进行/ ./ 在/ 这种/ 情况/ 下/ ,/ 我们/ 称该/ 密钥/ 是/ 象征性/ (/ nominally/ )/ 半/ 功能/ 的/ ./ 仿制/ 的/ 半/ 功能/ 密钥/ ./ 通过/ 如下/ 步骤/ 得到/ 一组/ 仿制/ 的/ 半/ 功能/ 密钥/ :/ 首先/ ,/ 调用/ 密钥/ 提取/ 算法/ 得到/ 一组/ 正规/ 的/ 密钥/ SK/ =/ {/ [/ a0/ ,/ 0/ ,/ a0/ ,/ 1/ ,/ a0/ ,/ 2/ ,/ b0/ ,/ j/ +/ 1/ ,/ …/ ,/ b0/ ,/ l/ ]/ ,/ [/ a1/ ,/ 0/ ,/ a1/ ,/ 1/ ,/ a1/ ,/ 2/ ,/ b1/ ,/ j/ +/ 1/ ,/ …/ ,/ b1/ ,/ l/ ]/ ,/ [/ a2/ ,/ 0/ ,/ a2/ ,/ 1/ ,/ a2/ ,/ 2/ ,/ b2/ ,/ j/ +/ 1/ ,/ …/ ,/ b2/ ,/ l/ ]/ }/ ;/ 然后/ 随机/ 选/ ξ/ [/ m/ ,/ n/ ]/ ,/ ζ/ [/ m/ ,/ n/ ]/ ←/ ZN/ ,/ 其中/ m/ ,/ n/ ∈/ [/ 0/ ,/ 2/ ]/ ,/ n/ ∈/ [/ j/ +/ 1/ ,/ l/ ]/ ,/ j/ ∈/ [/ 1/ ,/ l/ ]/ ,/ 并/ 设置/ 仿制/ 的/ 半/ 功能/ 密钥/ 为/ SK/ =/ {/ [/ a0/ ,/ 0g/ ξ/ [/ 0/ ,/ 0/ ]/ b0/ ,/ lg/ ζ/ [/ 0/ ,/ l/ ]/ b1/ ,/ j/ +/ 1g/ ζ/ [/ 1/ ,/ j/ +/ 1/ ]/ 2/ ,/ 2/ ,/ b/ ζ/ [/ 2/ ,/ j/ +/ 1/ ]/ a/ ξ/ [/ 2/ ,/ 2/ ]/ p/ [/ 2/ ]/ ]/ ,/ [/ a1/ ,/ 0g/ ξ/ [/ 1/ ,/ 0/ ]/ 仿制/ 的/ 半/ 功能/ 密钥/ 可以/ 正确/ 解密/ 所有/ 正规/ 密文/ ,/ 但/ 在/ 任何/ 情况/ 下均/ 不能/ 解密/ 半/ 功能/ 密文/ ./ 仿制/ 的/ 半/ 功能/ 密钥/ 与/ 半/ 功能/ 密钥/ 之间/ 的/ 唯一/ 区别/ 是/ ,/ 在/ 某些/ 特定/ 的/ 情况/ 下/ (/ z/ [/ c/ ]/ =/ z/ [/ k/ ]/ )/ ,/ 半/ 功能/ 密钥/ 可以/ 定义/ 为/ 象征性/ 的/ (/ nominally/ )/ ,/ 但是/ 仿制/ 的/ 半/ 功能/ 密钥/ 却/ 不行/ ./ 我们/ 仍然/ 使用/ 了/ 混合/ 争论/ (/ hybridargument/ )/ 技术/ ,/ 借助/ 一系列/ 两/ 两/ 不可/ 区分/ 的/ 游戏/ (/ GameReal/ ,/ Page9GameReal/ ,/ GameRestricted/ ,/ Game0/ ,/ …/ ,/ Gameq/ ,/ GamePre/ -/ Final/ -/ 1/ ,/ GamePre/ -/ Final/ -/ 2/ ,/ GameFinal/ )/ 证明/ 方案/ 的/ 安全性/ ./ 第/ 1/ 个/ 游戏/ ,/ GameReal/ ,/ 是/ 真实/ 的/ 游戏/ ./ 第/ 2/ 个/ 游戏/ ,/ GameReal/ ,/ 与/ GameReal/ 仅/ 有/ 一处/ 区别/ ,/ 在/ GameReal/ 中/ 不再/ 允许/ 敌手/ 进行/ 委托/ 查询/ ,/ 也就是说/ 在/ GameReal/ 中/ 所有/ 的/ 密钥/ 查询/ 只/ 调用/ 密钥/ 提取/ 算法/ ,/ 而/ 不再/ 调用/ 密钥/ 委托/ 算法/ ./ 因此/ 我们/ 可以/ 认为/ ,/ 在/ GameReal/ 中/ ,/ 当/ 敌手/ 对/ 某个/ 身份/ 向量/ 犐/ 进行/ 查询/ 时/ ,/ 挑战者/ 直接/ 将/ 该/ 身份/ 对应/ 的/ 私钥/ 返回/ 给/ 敌手/ ,/ 而/ 无需/ 在/ S/ 中/ 保存/ ./ 第/ 3/ 个/ 游戏/ ,/ GameRestricted/ ,/ 与/ GameReal/ 仅/ 有/ 一处/ 区别/ ,/ 敌手/ 不能/ 对/ 那些/ 与/ 用于/ 挑战/ 的/ 身份/ 向量/ 的/ 前缀/ modp/ [/ 2/ ]/ 相等/ (/ 各/ 分量/ modp/ [/ 2/ ]/ 相等/ )/ 的/ 向量/ 进行/ 私钥/ 查询/ ./ 下/ 一个/ 游戏/ ,/ Game0/ ,/ 与/ GameRestricted/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ Game0/ 中/ 挑战/ 阶段/ 返回/ 给/ 敌手/ 的/ 密文/ 是/ 半/ 功能/ 的/ ./ 令/ q/ 表示/ 在/ 阶段/ 1/ 和/ 阶段/ 2/ 中/ 敌手/ 能够/ 进行/ 私钥/ 查询/ 的/ 最大/ 次数/ ./ 下面/ 我们/ 定义/ q/ 个/ 游戏/ ,/ {/ Gamek/ }/ k/ ∈/ [/ 1/ ,/ q/ ]/ ,/ 与/ Game0/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ Gamek/ 中/ 返回/ 给/ 敌手/ 的/ 前/ k/ 个/ 私钥/ 为/ 半/ 功能/ 的/ ,/ 其它/ 的/ 私钥/ 仍为/ 正规/ 的/ ./ 也就是说/ ,/ 在/ Game0/ 中/ ,/ 返回/ 的/ 密文/ 是/ 半/ 功能/ 的/ ,/ 而/ 返回/ 的/ 所有/ 密钥/ 都/ 是/ 正规/ 的/ ;/ 在/ Gameq/ 中/ ,/ 返回/ 的/ 密文/ 以及/ 所有/ 的/ 密钥/ 都/ 是/ 半/ 功能/ 的/ ./ 下/ 一个/ 游戏/ ,/ GamePre/ -/ Final/ -/ 1/ ,/ 与/ Gameq/ 仅/ 有/ 一处/ 区别/ ,/ 在/ GamePre/ -/ Final/ -/ 1/ 中/ ,/ 返回/ 给/ 敌手/ 的/ 是/ 对/ 一个/ 随机/ 消息/ 加密/ 得到/ 的/ 半/ 功能/ 密文/ ./ 倒数第/ 2/ 个/ 游戏/ ,/ GamePre/ -/ Final/ -/ 2/ ,/ 与/ GamePre/ -/ Final/ -/ 1/ 仅/ 有/ 一处/ 区别/ ,/ 在/ GamePre/ -/ Final/ -/ 2/ 中/ ,/ 所有/ 返回/ 给/ 敌手/ 的/ 密钥/ 都/ 为/ 仿制/ 的/ 半/ 功能/ 的/ ./ 最后/ 一个/ 游戏/ 是/ GameFinal/ ,/ 它/ 与/ GamePre/ -/ Final/ -/ 2/ 仅/ 存在/ 一处/ 区别/ ,/ 在/ GameFinal/ 中/ ,/ 返回/ 给/ 敌手/ 的/ 半/ 功能/ 密文/ 是/ 使用/ 一个/ 随机/ 身份/ 对/ 一个/ 随机/ 消息/ 进行/ 加密/ 所得/ 的/ ./ 我们/ 利用/ 下面/ 的/ 7/ 个/ 引理/ 证明/ 了/ 以上/ 游戏/ 是/ 两/ 两/ 不可/ 区分/ 的/ ./ 引理/ 6/ ./ 对于/ 任何/ 算法/ / (/ 敌手/ )/ ,/ GameRealAdv/ / =/ GameRealAdv/ / ./ 证明/ ./ 对于/ 某个/ 确定/ 的/ 身份/ 向量/ ,/ 我们/ 有/ 两种/ 方式/ 为/ 其/ 生成/ 对应/ 的/ 密钥/ ,/ 一种/ 是/ 使用/ 密钥/ 提取/ 算法/ ,/ 另/ 一种/ 是/ 使用/ 密钥/ 委托/ 算法/ (/ 需要/ 其/ 祖先/ 身份/ 对应/ 的/ 密钥/ )/ ./ 无论/ 使用/ 哪/ 种/ 方式/ ,/ 密钥/ 的/ 分布/ 相同/ ./ 因此/ ,/ 对于/ 敌手/ 来说/ ,/ 以上/ 两个/ 游戏/ 并/ 无/ 区别/ ./ 引理/ 7/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GameRealAdv/ / -/ GameRestrictedAdv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ 大于/ 等于/ ε/ // 3/ 的/ 优势/ 打破/ 假设/ 1/ ./ 证明/ ./ 见/ 引理/ 1/ ./ 引理/ 8/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 2/ ./ 证明/ ./ / 利用/ X1/ ,/ X3/ ,/ X4/ ,/ T/ 作为/ 输入/ ,/ 模拟/ GameRestricted/ 或/ Game0/ ./ 它/ 设置/ 公共/ 参数/ 如下/ :/ / 随机/ 选取/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ ,/ c/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ ui/ =/ va/ [/ i/ ]/ ,/ w/ =/ vb/ ,/ f/ =/ vc/ ,/ Rv/ =/ X/ δ/ v/ ,/ Rf/ =/ Rcv/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ l/ ]/ ./ 它/ 将/ 公共/ 参数/ {/ X3/ ,/ X4/ ,/ RbU1/ =/ u1/ ·/ Ru/ ,/ 1/ ,/ …/ ,/ Ul/ =/ ul/ ·/ Ru/ ,/ l/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ F/ =/ f/ ·/ Rf/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ }/ 返回/ 给/ / ./ 每当/ / 被/ 查询/ 身份/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 对应/ 的/ 私钥/ 时/ ,/ 它/ 随机/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ,/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ [/ 1/ ]/ ,/ y/ [/ 2/ ]/ ,/ y/ [/ 3/ ]/ ←/ ZN/ ,/ 并/ 置/ 密钥/ 为/ Kd/ =/ [/ vr/ [/ 1/ ]/ Xy/ [/ 1/ ]/ ur/ [/ 1/ ]/ j/ +/ 1Xx/ [/ j/ +/ 1/ ]/ Kr/ =/ [/ [/ vs/ [/ 1/ ]/ ,/ vs/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ [/ vt/ [/ 1/ ]/ ,/ vt/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ / 给/ / 发送/ 两个/ 消息/ ,/ M/ / 0/ ,/ M/ / 1/ ,/ 和/ 两个/ 身份/ 犐/ / 0/ =/ (/ I/ [/ 0/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 0/ ,/ i/ ]/ / )/ ,/ 犐/ / 1/ =/ (/ I/ [/ 1/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 1/ ,/ j/ ]/ / )/ ./ / 选择/ 两个/ 随机/ 比特/ β/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ,/ 产生/ 密文/ 如下/ :/ C0/ =/ M/ / C2/ =/ T/ ,/ C3/ =/ Tc/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 4/ ]/ ,/ 那么/ 这是/ 一个半/ 功能/ 密文/ ,/ 其中/ z/ [/ c/ ]/ =/ a/ [/ 1/ ]/ I/ [/ γ/ ,/ 1/ ]/ / +/ …/ +/ a/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 4/ ]/ ,/ 那么/ 这是/ 一个/ 正规/ 的/ 密文/ ./ 因此/ ,/ / 可以/ 用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 9/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 3/ ./ 证明/ ./ / 利用/ X1/ ,/ X3/ ,/ X4/ ,/ Y1X2Y4/ ,/ Y2Y3/ ,/ T/ 作为/ 输入/ ,/ 模拟/ Gamek/ -/ 1/ 或/ Gamek/ ./ 它/ 随机/ 选取/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ ,/ c/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ ui/ =/ va/ [/ i/ ]/ ,/ w/ =/ vb/ ,/ f/ =/ vc/ ,/ Rv/ =/ X/ δ/ 中/ i/ ∈/ [/ 1/ ,/ l/ ]/ ./ / 将/ 公共/ 参数/ {/ X3/ ,/ X4/ ,/ U1/ =/ u1/ ·/ Ru/ ,/ 1/ ,/ …/ ,/ Ul/ =/ ul/ ·/ Ru/ ,/ l/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ F/ =/ f/ ·/ Rf/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ }/ 发送给/ / ./ 当/ / 进行/ 第/ i/ 次/ 私钥/ 查询/ 时/ (/ 针对/ 身份/ 犐/ [/ i/ ]/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ )/ :/ 对于/ i/ </ k/ 的/ 情况/ ,/ / 生成/ 一组/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ,/ m/ [/ 1/ ]/ ,/ m/ [/ 2/ ]/ ,/ m/ [/ 3/ ]/ ,/ n/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ n/ [/ l/ ]/ ←/ ZN/ ,/ 并/ 设置/ 密钥/ 为/ Page10Kd/ =/ [/ vr/ [/ 1/ ]/ (/ Y2Y3/ )/ m/ [/ 1/ ]/ ,/ vr/ [/ 2/ ]/ Xm/ [/ 2/ ]/ (/ Y2Y3/ )/ m/ [/ 3/ ]/ ,/ ur/ [/ 1/ ]/ Kr/ =/ [/ [/ vs/ [/ 1/ ]/ ,/ vs/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ [/ vt/ [/ 1/ ]/ ,/ vt/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ 对于/ i/ >/ k/ 的/ 情况/ ,/ / 调用/ 密钥/ 提取/ 算法/ 生成/ 一组/ 正规/ 的/ 密钥/ ./ 对于/ i/ =/ k/ 的/ 情况/ ,/ 假设/ / 设置/ z/ [/ k/ ]/ =/ a/ [/ 1/ ]/ I/ [/ 1/ ]/ +/ …/ +/ a/ [/ j/ ]/ I/ [/ j/ ]/ +/ b/ ,/ 随机/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ,/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ [/ 2/ ]/ ,/ y/ [/ 3/ ]/ ←/ ZN/ 并/ 设置/ 密钥/ 为/ Kd/ =/ [/ Tr/ [/ 1/ ]/ ,/ vr/ [/ 2/ ]/ Xy/ [/ 2/ ]/ Tr/ [/ 1/ ]/ a/ [/ j/ +/ 1/ ]/ Xx/ [/ j/ +/ 1/ ]/ Kr/ =/ [/ [/ vs/ [/ 1/ ]/ ,/ vs/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ [/ vt/ [/ 1/ ]/ ,/ vt/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ / 发送给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ 以及/ 两个/ 身份/ 犐/ / 0/ =/ (/ I/ [/ 0/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 0/ ,/ i/ ]/ / )/ ,/ 犐/ / 1/ =/ (/ I/ [/ 1/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 1/ ,/ j/ ]/ / )/ ./ / 随机/ 选取/ β/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ./ 构造/ 密文/ 如下/ :/ C0/ =/ M/ / C1/ =/ (/ Y1X2Y4/ )/ a/ [/ 1/ ]/ I/ [/ γ/ ,/ 1/ ]/ / +/ …/ +/ a/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ C2/ =/ Y1X2Y4/ ,/ C3/ =/ (/ Y1X2Y4/ )/ c/ ./ 令/ vs/ =/ Y1/ ,/ Rsa/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ 其中/ S4/ 是/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 因为/ 第/ k/ 个/ 密钥/ 对应/ 的/ 身份/ 向量/ 与/ 用于/ 挑战/ 的/ 身份/ 向量/ 的/ 前缀/ modp/ [/ 2/ ]/ 不/ 等/ (/ 各/ 分量/ modp/ [/ 2/ ]/ 不/ 等/ )/ ,/ 所以/ z/ [/ k/ ]/ 和/ z/ [/ c/ ]/ 对/ / 可/ 看作/ 是/ 随机/ 分布/ 的/ ./ 然而/ ,/ z/ [/ k/ ]/ 和/ z/ [/ c/ ]/ 之间/ 的/ 关系/ 是/ 至关重要/ 的/ (/ 尽管/ 这种/ 关系/ 对/ / 是/ 隐藏/ 的/ )/ :/ 如果/ / 试图/ 通过/ “/ 自己/ 生成/ 一个/ 用/ 犐/ [/ k/ ]/ =/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 加密/ 的/ 半/ 功能/ 密文/ 并/ 尝试/ 对/ 其/ 解密/ ”/ 这种/ 方法/ 来/ 测试/ 第/ k/ 个/ 密钥/ SK/ 犐/ [/ k/ ]/ 是否/ 为/ 半/ 功能/ 的/ ,/ 那么/ 无论/ SK/ 犐/ [/ k/ ]/ 是否/ 为/ 半/ 功能/ 的/ ,/ 解密/ 都/ 能/ 正常/ 工作/ ,/ 因为/ z/ [/ k/ ]/ =/ z/ [/ c/ ]/ ./ 换言之/ ,/ 模拟器/ 仅能/ 生成/ 一个/ 象征性/ (/ nominally/ )/ 半/ 功能/ 密钥/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 3/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ Gamek/ -/ 1/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 3/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ Gamek/ ./ 因此/ ,/ / 能够/ 利用/ / 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 10/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GameqAdv/ / -/ GamePre/ -/ Final/ -/ 1Adv/ / =/ ε/ ,/ 证明/ ./ / 利用/ X1/ ,/ Z2/ ,/ X3/ ,/ X4/ ,/ X/ α/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 4/ ./ T/ 作为/ 输入/ ,/ 模拟/ Gameq/ 或/ GamePre/ -/ Final/ -/ 1/ ./ / 随机/ 选择/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ ,/ c/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ ui/ =/ va/ [/ i/ ]/ ,/ w/ =/ vb/ ,/ f/ =/ vc/ ,/ Rv/ =/ X/ δ/ Rf/ =/ Rcv/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ l/ ]/ ./ 它/ 给/ / 发送/ 公共/ 参数/ {/ X3/ ,/ X4/ ,/ U1/ =/ u1/ ·/ Ru/ ,/ 1/ ,/ …/ ,/ Ul/ =/ ul/ ·/ Ru/ ,/ l/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ F/ =/ f/ ·/ Rf/ ,/ E/ =/ e/ (/ X/ α/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 的/ 密钥/ 时/ ,/ / 生成/ 对应/ 的/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ,/ m/ [/ 1/ ]/ ,/ m/ [/ 3/ ]/ ,/ n/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ n/ [/ l/ ]/ ,/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ [/ 1/ ]/ ,/ y/ [/ 2/ ]/ ,/ y/ [/ 3/ ]/ ←/ ZN/ ,/ 并/ 计算/ 密钥/ :/ Kd/ =/ [/ vr/ [/ 1/ ]/ Zm/ [/ 1/ ]/ v/ α/ X2/ (/ uI/ [/ 1/ ]/ ur/ [/ 1/ ]/ Kr/ =/ [/ [/ vs/ [/ 1/ ]/ ,/ vs/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ [/ vt/ [/ 1/ ]/ ,/ vt/ [/ 2/ ]/ ,/ (/ uI/ [/ 1/ ]/ 令/ Rs/ / 给/ / 发送/ 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ 以及/ 两个/ 身份/ 犐/ / 0/ =/ (/ I/ [/ 0/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 0/ ,/ i/ ]/ / )/ ,/ 犐/ / 1/ =/ (/ I/ [/ 1/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 1/ ,/ j/ ]/ / )/ ./ / 随机/ 选取/ β/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ./ 构造/ 密文/ 如下/ :/ C0/ =/ M/ / C2/ =/ Xsa/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ 其中/ S4/ 是/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 在/ 这里/ ,/ z/ [/ c/ ]/ 仅/ 与/ z/ [/ c/ ]/ modp/ [/ 2/ ]/ 有关/ ,/ 由于/ u1/ =/ va/ [/ 1/ ]/ ,/ …/ ,/ ul/ =/ va/ [/ l/ ]/ ,/ w/ =/ vb/ 是/ 子群/ Gp/ [/ 1/ ]/ 中/ 元素/ ,/ 所以/ 当/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ 在/ ZN/ 中/ 选取/ 时/ ,/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ bmodp/ [/ 1/ ]/ 与/ z/ [/ c/ ]/ modp/ [/ 2/ ]/ 是/ 无关/ 的/ ,/ 故/ z/ [/ c/ ]/ 对/ / 可/ 看作/ 是/ 随机/ 分布/ 的/ 如果/ T/ =/ e/ (/ X1/ ,/ X1/ )/ α/ ·/ s/ ,/ 那么/ 以上/ 密文/ 是/ 消息/ β/ 对应/ 的/ 半/ 功能/ 密文/ ./ 如果/ T/ 为/ GT/ 中/ 的/ 随机/ 元/ M/ / 素/ ,/ 那么/ 该/ 密文/ 是/ 对/ 一个/ 随机/ 消息/ 加密/ 得到/ 的/ 半/ 功能/ 密文/ ./ 因此/ ,/ / 可以/ 用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 11/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GamePre/ -/ Final/ -/ 1Adv/ / -/ GamePre/ -/ Final/ -/ 2Adv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 6/ ./ 证明/ ./ / 利用/ X1/ ,/ X3/ ,/ X4/ ,/ X/ κ/ 1X2/ ,/ Y1X2Y4/ ,/ GT/ ,/ T/ 作为/ 输入/ ,/ 模拟/ GamePre/ -/ Final/ -/ 1/ 或/ GamePre/ -/ Final/ -/ 2/ ./ / 随机/ 选取/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ ,/ c/ ,/ α/ ,/ δ/ ←/ ZN/ ,/ 并/ 设置/ v/ =/ X1/ ,/ ui/ =/ va/ [/ i/ ]/ ,/ w/ =/ vb/ ,/ f/ =/ vc/ ,/ Rv/ =/ X/ δ/ Rw/ =/ Rb/ {/ X3/ ,/ X4/ ,/ U1/ =/ u1/ ·/ Ru/ ,/ 1/ ,/ …/ ,/ Ul/ =/ ul/ ·/ Ru/ ,/ l/ ,/ V/ =/ v/ ·/ Rv/ ,/ W/ =/ w/ ·/ Rw/ ,/ F/ =/ f/ ·/ Rf/ ,/ E/ =/ e/ (/ v/ ,/ v/ )/ α/ }/ 发送给/ / ./ / 查询/ 身份/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 对应/ 的/ 密钥/ 时/ ,/ / 设置/ z/ [/ k/ ]/ =/ a/ [/ 1/ ]/ I/ [/ 1/ ]/ +/ …/ +/ a/ [/ j/ ]/ I/ [/ j/ ]/ +/ b/ ,/ 并/ 随机/ Page11/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 2/ ]/ ,/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ [/ 1/ ]/ ,/ y/ [/ 2/ ]/ ,/ y/ [/ 3/ ]/ ←/ ZN/ ,/ 返回/ 密钥/ :/ Kd/ =/ [/ (/ X/ κ/ v/ α/ (/ X/ κ/ 1X2/ )/ r/ [/ 1/ ]/ ·/ a/ [/ j/ +/ 1/ ]/ Xx/ [/ j/ +/ 1/ ]/ Kr/ =/ [/ [/ T/ ,/ Ts/ [/ 2/ ]/ ,/ Tz/ [/ k/ ]/ Tc/ ·/ s/ [/ 2/ ]/ ,/ Ta/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ Ta/ [/ l/ ]/ ]/ ,/ [/ T/ ,/ Tt/ [/ 2/ ]/ ,/ Tz/ [/ k/ ]/ Tc/ ·/ t/ [/ 2/ ]/ ,/ Ta/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ Ta/ [/ l/ ]/ ]/ ]/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ ,/ 以上/ 密钥/ 是/ 半/ 功能/ 的/ ./ 如果/ T/ ∈/ (/ X/ κ/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ ,/ 以上/ 密钥/ 是/ 仿制/ 的/ 半/ 功能/ 的/ ./ / 发送给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ 以及/ 两个/ 身份/ 犐/ / 0/ =/ (/ I/ [/ 0/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 0/ ,/ i/ ]/ / )/ ,/ 犐/ / 1/ =/ (/ I/ [/ 1/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 1/ ,/ j/ ]/ / )/ ./ / 随机/ 选取/ CR/ ←/ GT/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ./ 并/ 生成/ 密文/ :/ C0/ =/ CR/ ,/ C1/ =/ (/ Y1X2Y4/ )/ a/ [/ 1/ ]/ I/ [/ γ/ ,/ 1/ ]/ / +/ …/ +/ a/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ C2/ =/ Y1X2Y4/ ,/ C3/ =/ (/ Y1X2Y4/ )/ c/ ./ 令/ vs/ =/ Y1/ ,/ Rsa/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ 其中/ S4/ 是/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ GamePre/ -/ Final/ -/ 1/ ./ 如果/ T/ ∈/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ ,/ 那么/ / 正确/ 地/ 模拟/ 了/ GamePre/ -/ Final/ -/ 2/ ./ 因此/ ,/ / 能够/ 利用/ / 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 引理/ 12/ ./ 假设/ 存在/ 算法/ / (/ 敌手/ )/ 使得/ GamePre/ -/ Final/ -/ 2Adv/ / -/ GameFinalAdv/ / =/ ε/ ,/ 证明/ ./ / 利用/ Z2/ ,/ X3/ ,/ X4/ ,/ X1X2/ ,/ X/ α/ 那么/ 我们/ 可以/ 构造/ 算法/ / 以/ ε/ 的/ 优势/ 打破/ 假设/ 5.1/ Z2Z4/ ,/ GT/ ,/ T/ 作为/ 输入/ ,/ 模拟/ GamePre/ -/ Final/ -/ 2/ 或/ XsGameFinal/ ./ / 随机/ 选取/ a/ [/ 1/ ]/ ,/ …/ ,/ a/ [/ l/ ]/ ,/ b/ ,/ c/ ←/ ZN/ ,/ 并/ 设置/ V/ =/ X1X/ δ/ [/ 1/ ,/ l/ ]/ ./ 它/ 将/ 公共/ 参数/ {/ X3/ ,/ X4/ ,/ U1/ ,/ …/ ,/ Ul/ ,/ V/ ,/ W/ ,/ F/ ,/ E/ =/ e/ (/ X/ α/ (/ I/ [/ 1/ ]/ ,/ …/ ,/ I/ [/ j/ ]/ )/ 的/ 密钥/ 时/ ,/ / 生成/ 对应/ 的/ 半/ 功能/ 密钥/ ./ 它/ 随机/ 选取/ r/ [/ 1/ ]/ ,/ r/ [/ 2/ ]/ ,/ s/ [/ 1/ ]/ ,/ s/ [/ 2/ ]/ ,/ t/ [/ 1/ ]/ ,/ t/ [/ 2/ ]/ ,/ x/ [/ j/ +/ 1/ ]/ ,/ …/ ,/ x/ [/ l/ ]/ ,/ y/ [/ 1/ ]/ ,/ y/ [/ 2/ ]/ ,/ y/ [/ 3/ ]/ ←/ ZN/ ,/ 并/ 计算/ 密钥/ :/ Kd/ =/ [/ (/ X1X2/ )/ r/ [/ 1/ ]/ Xy/ [/ 1/ ]/ X/ α/ (/ X1X2/ )/ a/ [/ j/ ]/ I/ [/ j/ ]/ (/ X1X2/ )/ b/ )/ r/ [/ 1/ ]/ (/ X1X2/ )/ cr/ [/ 2/ ]/ Xy/ [/ 3/ ]/ (/ X1X2/ )/ a/ [/ j/ +/ 1/ ]/ r/ [/ 1/ ]/ Xx/ [/ j/ +/ 1/ ]/ 表/ 1/ 匿名/ HIBE/ 方案/ 效率/ 及/ 安全性/ 对比/ 文献/ 公共/ 参数/ 的/ 长度/ 私钥/ 的/ 长度/ 密文/ 的/ 长度/ 解密/ 中/ 对/ 运算/ 的/ 个数/ 复杂性/ 假设/ (/ 静/ // 非/ 静态/ )/ 安全/ 模型/ 文献/ [/ 5/ ]/ l2/ +/ 5l/ +/ 73l2/ +/ (/ 14/ -/ k/ )/ l/ -/ 3k/ +/ 152l/ +/ 6/ 文献/ [/ 6/ ]/ 2l/ +/ 6/ (/ l/ -/ k/ )/ (/ k/ +/ 5/ )/ +/ k/ +/ 3l/ +/ 4/ 文献/ [/ 7/ ]/ l/ +/ 4/ 本文/ l/ +/ 4/ 注/ :/ l/ 表示/ 等级/ 的/ 最大/ 深度/ ;/ k/ 表示/ 身份/ 所处/ 的/ 深度/ ;/ w/ // oRO/ 表示/ 无/ 随机/ 预言/ 机/ ;/ f/ -/ ID/ 表示/ 适应性/ 选择/ 身份/ 模型/ ;/ s/ -/ ID/ 表示/ 选定/ 身份/ 模型/ ./ Kr/ =/ [/ [/ (/ X1X2/ )/ s/ [/ 1/ ]/ ,/ (/ X1X2/ )/ s/ [/ 2/ ]/ ,/ (/ (/ X1X2/ )/ a/ [/ 1/ ]/ I/ [/ 1/ ]/ …/ / 发送给/ / 两个/ 消息/ M/ / 0/ ,/ M/ / 1/ 以及/ 两个/ 身份/ 犐/ / 0/ =/ (/ I/ [/ 0/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 0/ ,/ i/ ]/ / )/ ,/ 犐/ / 1/ =/ (/ I/ [/ 1/ ,/ 1/ ]/ / ,/ …/ ,/ I/ [/ 1/ ,/ j/ ]/ / )/ ./ / 随机/ 选取/ CR/ ←/ GT/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ./ 并/ 生成/ 密文/ :/ C0/ =/ CR/ ,/ C1/ =/ (/ T/ )/ a/ [/ 1/ ]/ I/ [/ γ/ ,/ 1/ ]/ / +/ …/ +/ a/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ C2/ =/ Xs/ 令/ Rsa/ [/ h/ ]/ I/ [/ γ/ ,/ h/ ]/ / +/ b/ ,/ 其中/ S4/ 是/ 子群/ Gp/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ./ 如果/ T/ =/ Xs/ 份/ 犐/ / γ/ 对/ 一个/ 随机/ 消息/ 加密/ 的/ 半/ 功能/ 密文/ ./ 如果/ T/ 是/ Gp/ [/ 1/ ]/ p/ [/ 2/ ]/ p/ [/ 4/ ]/ 中/ 的/ 随机/ 元素/ ,/ 那么/ 该/ 密文/ 是/ 一个/ 使用/ 随机/ 身份/ 对/ 一个/ 随机/ 消息/ 加密/ 的/ 半/ 功能/ 密文/ ./ 因此/ ,/ / 可以/ 利用/ / 的/ 输出/ 来/ 区分/ T/ 的/ 不同/ 可能/ ./ 至此/ ,/ 我们/ 得到/ 如下/ 定理/ ./ 定理/ 2/ ./ 如果/ 假设/ 1/ ~/ 6/ 成立/ ,/ 那么/ 我/ 的/ 匿名/ HIBE/ 方案/ 是/ ANON/ -/ ID/ -/ CPA/ 的/ (/ 定义/ 1/ )/ ./ 证明/ ./ 根据/ 以上/ 7/ 个/ 引理/ 得知/ ,/ 如果/ 假设/ 1/ ~/ 6/ 成立/ ,/ 那么/ 真实/ 游戏/ GameReal/ 与/ GameFinal/ 是/ 不可/ 区分/ 的/ ./ 又/ 因/ GameFinal/ 中/ β/ 与/ γ/ 对/ 敌手/ 是/ 完全/ 隐藏/ 的/ (/ 信息论/ 意义/ 上/ 的/ )/ ,/ 所以/ 敌手/ 在/ GameFinal/ 中/ 的/ 优势/ 为/ 0/ ,/ 从而/ 得知/ 在/ GameReal/ 中/ 敌手/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 5/ 结论/ 表/ 1/ 将/ 目前/ 现有/ 的/ 匿名/ HIBE/ 方案/ 与/ 我们/ 的/ 新/ 方案/ ,/ 在/ 效率/ 及/ 安全性/ 方面/ 进行/ 了/ 全面/ 对比/ ./ 通过/ 对比/ 发现/ ,/ 我们/ 的/ 匿名/ HIBE/ 方案/ 与/ Seo/ 的/ 匿名/ HIBE/ 方案/ [/ 7/ ]/ 在/ 效率/ 上/ 是/ 相同/ 的/ ,/ 但是/ 新/ 方案/ 的/ 安全性/ 基于/ 静态/ 假设/ ,/ 并且/ 可以/ 在/ 更/ 强/ 的/ 适应性/ 选择/ 身份/ 模型/ 中/ 证明/ 安全性/ ./ 2/ (/ l/ +/ 2/ )/ Page12/ 本文/ 构造/ 了/ 一个/ 匿名/ IBE/ 方案/ 和/ 一个/ 匿名/ HIBE/ 方案/ ./ 新/ 方案/ 均/ 能够/ 被/ 证明/ 在/ 标准/ 模型/ 中/ (/ 无/ 随机/ 预言/ 机/ )/ 达到/ 匿名/ 、/ 抗/ 适应性/ 选择/ 身份/ 和/ 选择/ 明文/ 攻击/ 安全/ (/ ANON/ -/ ID/ -/ CPA/ )/ ./ 我们/ 的/ 匿名/ HIBE/ 方案/ 中/ ,/ 密文/ 的/ 大小/ 仅为/ 4/ 个群/ 元素/ ,/ 而/ 不/ 依赖于/ 等级/ 的/ 深度/ ./ 公共/ 参数/ 及/ 私钥/ 的/ 长度/ 也/ 是/ 现有/ 匿名/ HIBE/ 方案/ 中/ 最小/ 的/ (/ 与/ Seo/ 的/ 匿名/ HIBE/ 相同/ )/ ./ 在/ 文本/ 的/ 最后/ ,/ 我们/ 留下/ 一个/ 公开/ 问题/ ,/ 即/ 如何/ 在/ 素数/ 阶/ 双线性/ 群中/ 构造/ 抗/ 适应性/ 选择/ 身份/ 安全/ 的/ 匿名/ HIBE/ 方案/ ,/ 并且/ 在/ 方案/ 的/ 安全性/ 证明/ 中/ 使用/ 更为/ 标准/ 的/ 假设/ ,/ 这/ 也/ 是/ 我们/ 后续/ 工作/ 的/ 一个/ 方向/ ./ 

