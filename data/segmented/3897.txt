Page1/ 一种/ 基于/ 构件/ 重构/ 的/ 路由器/ 能耗/ 细粒度/ 调整/ 方法/ 袁博/ 汪斌/ 强/ (/ 国家/ 数字/ 交换/ 系统工程/ 技术/ 研究/ 中心/ 郑州/ 450002/ )/ 摘要/ 可/ 重构/ 路由器/ 采用/ 构件/ 化/ 的/ 体系结构/ ,/ 使以/ 构件/ 为/ 对象/ 的/ 能耗/ 细粒度/ 调整/ 成为/ 可能/ ./ 论文/ 面向/ 路由器/ 低能耗/ 问题/ ,/ 基于/ 部件/ 能耗/ 随/ 业务/ 负载/ 变化/ 的/ 思想/ ,/ 在/ 对/ 构件/ 化/ 路由器/ 低能耗/ 模型/ 分析/ 的/ 基础/ 上/ ,/ 提出/ 了/ 基于/ 构件/ 重构/ 的/ 路由器/ 能耗/ 细粒度/ 调整/ 方法/ ./ 该/ 方法/ 使用/ 布尔/ 二次/ 指数/ 平滑/ 法/ 预测/ 网络/ 负载/ 变化/ ,/ 能够/ 有效/ 避免/ 重构/ 结果/ 滞后/ 于/ 负载/ 变化/ ;/ 使用/ 遗传算法/ 并行/ 搜索/ 构件/ 配置/ 空间/ ,/ 能够/ 快速/ 搜索/ 出/ 最优/ 构件/ 配置/ 方案/ ./ 使用/ 真实/ 网络流量/ 进行/ 实验/ ,/ 结果表明/ ,/ 该/ 方法/ 能够/ 根据/ 负载/ 的/ 动态变化/ 进行/ 构件/ 重构/ ,/ 能够/ 使/ 路由器/ 能耗/ 跟随/ 负载/ 变化/ ,/ 与/ 传统/ 算法/ 相比/ 可以/ 节省/ 60/ %/ 的/ 算法/ 运行/ 时间/ ,/ 降低/ 构件/ 组/ 25/ %/ 能耗/ ./ 关键词/ 低能耗/ ;/ 路由器/ ;/ 可/ 重构/ ;/ 构件/ 化/ ;/ 细粒度/ ;/ 绿色/ 网络/ 1/ 引言/ 随着/ 网络/ 规模/ 和/ 用户/ 业务/ 种类/ 的/ 发展/ ,/ 当前/ 的/ 互联网/ 在/ 用户数量/ 、/ 接入/ 带宽/ 和/ 服务/ 种类/ 等/ 方面/ 呈现出/ 快速增长/ 的/ 特点/ [/ 1/ ]/ ./ 作为/ 互联网/ 重要/ 基础设施/ 的/ Page21/ ./ 65/ 倍/ ,/ 落后/ 于/ 路由器/ 容量/ 的/ 增长/ 速率/ [/ 1/ ]/ ./ 上述/ 发展趋势/ 意味着/ 路由/ 设备/ 性能/ 提升/ 中有/ 一部分/ 以/ 高能耗/ 为/ 代价/ ,/ 仅靠/ 器件/ 本身/ 来/ 降低/ 能耗/ 存在/ 局限/ ,/ 如果/ 要/ 进一步/ 降低/ 路由/ 设备/ 能耗/ ,/ 需要/ 研究/ 器件/ 之外/ 的/ 节能/ 策略/ 和/ 机制/ ./ 目前/ 针对/ 路由器/ 的/ 节能/ 研究/ 大多/ 沿用/ 计算机系统/ 的/ 节能/ 研究/ 思路/ ,/ 主要/ 从/ 休眠/ 器件/ 和/ 调整/ 器件/ 的/ 工作电压/ 或/ 频率/ 入手/ ,/ 大多数/ 研究/ 针对/ 单一/ 可/ 调节/ 资源/ ,/ 研究/ 对象/ 多/ 是/ 处理器/ 、/ 线卡/ 、/ 链路/ 等/ 粗粒度/ 的/ 部件/ [/ 4/ ]/ ./ 随着/ 技术/ 的/ 发展/ ,/ 路由器/ 中/ 越来越/ 多/ 的/ 部件/ 能够/ 进行/ 性能/ 的/ 调节/ ,/ 所以/ 会/ 出现/ 多种/ 可/ 调节/ 部件/ 并/ 存在/ 系统/ 中/ 的/ 情况/ ,/ 如可/ 重构/ 路由器/ ,/ 不同/ 的/ 构件/ 重构/ 方式/ 对应/ 不同/ 的/ 功能/ ./ 在/ 这种/ 多/ 构件/ 集成/ 使用/ 的/ 环境/ 中/ ,/ 由于/ 构件/ 的/ 性能/ 和/ 能耗/ 范围/ 不同/ ,/ 所以/ 影响/ 系统/ 能耗/ 的/ 瓶颈/ 资源/ 也/ 不同/ ,/ 如何/ 选择/ 合适/ 的/ 构件/ 重构/ 方案/ ,/ 在/ 保持/ 较/ 高/ 资源/ 利用率/ 的/ 同时/ 降低/ 设备/ 整体/ 能耗/ ,/ 是/ 路由器/ 节能/ 领域/ 研究/ 的/ 热点/ [/ 5/ ]/ ./ 本文/ 面向/ 路由器/ 低能耗/ 问题/ ,/ 使用/ 构件/ 化/ 体系结构/ ,/ 提出/ 一种/ 基于/ 构件/ 重构/ 的/ 能耗/ 细粒度/ 调整/ 方法/ ./ 该/ 方法/ 基于/ 布尔/ 二次/ 指数/ 平滑/ 法/ 预测/ 网络/ 负载/ 变化/ ,/ 利用/ 遗传算法/ 并行/ 搜索/ 能耗/ 配置/ 空间/ ,/ 能够/ 有效/ 避免/ 重构/ 结果/ 滞后/ 于/ 负载/ 变化/ 并/ 快速/ 搜索/ 出/ 最优/ 构件/ 配置/ ./ 实验/ 表明/ ,/ 该/ 方法/ 能够/ 根据/ 负载/ 的/ 动态变化/ 和/ 路由器/ 的/ 能耗/ 情况/ 快速/ 调整/ 构件/ 的/ 重构/ 方案/ ,/ 能够/ 使/ 路由器/ 能耗/ 跟随/ 负载/ 进行/ 变化/ ,/ 有效/ 降低/ 能耗/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 研究进展/ ;/ 第/ 3/ 节/ 介绍/ 构件/ 化/ 路由器/ 架构/ ;/ 第/ 4/ 节/ 阐述/ 低能耗/ 分析模型/ ;/ 第/ 5/ 节/ 描述/ 能耗/ 细粒度/ 调整/ 算法/ ;/ 第/ 6/ 节/ 介绍/ 仿真/ 实验/ 环境/ 、/ 设计/ 细节/ 和/ 结果/ 分析/ ;/ 最后/ 对/ 全文/ 进行/ 总结/ ./ 2/ 研究/ 现状/ 路由器/ 性能/ 的/ 不断/ 提升/ 以/ 路由器/ 设计/ 复杂度/ 增加/ 和/ 能耗/ 升高/ 为/ 代价/ ./ 新一代/ 路由器/ 能耗/ 往往/ 比/ 之前/ 的/ 路由器/ 高出/ 几个/ 数量级/ [/ 6/ ]/ ./ 在/ 降低/ 路由器/ 能耗/ 方面/ 研究/ 人员/ 开展/ 了/ 大量/ 研究/ ./ 目前/ 研究/ 大体/ 分为/ 3/ 个/ 方向/ :/ (/ 1/ )/ 研究/ 部件/ 休眠/ 机制/ ,/ 将/ 暂时/ 不/ 工作/ 的/ 器件/ 、/ 接口/ 或者/ 板卡/ 置/ 为/ 低功耗/ 模式/ 或者/ 关闭/ ,/ 当前/ 路由器/ 节能/ 研究/ 中/ 应用/ 最多/ 的/ 技术/ 是/ 部件/ 休眠/ 技术/ ,/ 但是/ 这种/ 方法/ 应用/ 场景/ 有限/ ,/ 部件/ 唤醒/ 时间/ 影响/ 了/ 设备/ 性能/ ./ 路由器/ 处理/ 时延/ 的/ 高/ 要求/ 限制/ 了/ 休眠/ 机制/ 的/ 应用/ ;/ (/ 2/ )/ 调整/ 部件/ 工作频率/ ,/ 使/ 其/ 工作/ 在/ 较/ 低/ 频率/ 上/ ,/ 频繁/ 切换/ 工作频率/ 也/ 会/ 造成/ 性能/ 损失/ ;/ (/ 3/ )/ 在/ 满足/ 设备/ 性能需求/ 条件/ 下/ 尽量/ 降低/ 设备/ 能耗/ ,/ 例如/ 在/ 负载/ 较/ 低/ 情况/ 下/ 降低/ 链路/ 速率/ [/ 7/ -/ 9/ ]/ ./ 很多/ 路由/ 设备/ 的/ 能耗/ 管理策略/ 使用/ 了/ 上述/ 策略/ 中/ 的/ 一种/ 或者/ 多种/ 混合策略/ ./ 在/ 文献/ [/ 10/ ]/ 中/ ,/ 作者/ 提出/ 了/ 在/ IP/ 骨干网/ 非/ 峰值/ 时/ 关闭/ 部分/ 节点/ 和/ 链路/ 的/ 算法/ ,/ 实验/ 结果表明/ 该/ 算法/ 至少/ 可以/ 节省/ 骨干/ 网络/ 23/ %/ 的/ 能耗/ ./ 在/ 文献/ [/ 11/ ]/ 中/ ,/ 作者/ 利用/ 硬件/ 电压可调/ 特性/ ,/ 通过/ 改变/ 部件/ 工作/ 时/ 电压/ 配置/ 来/ 达到/ 降低/ 设备/ 能耗/ 的/ 目的/ ./ 有/ 研究者/ 从/ 软件设计/ 角度/ 出发/ ,/ 利用/ 多核/ 的/ 频率/ 独立/ 可调/ 性质/ ,/ 提高/ 了/ 软件/ 路由器/ 的/ 能耗/ 效率/ [/ 12/ ]/ ./ 但是/ 上述/ 研究/ 停留/ 在/ 仿真/ 阶段/ ,/ 仿真/ 环境/ 参数设置/ 比较/ 理想/ ,/ 尤其/ 是/ 路由器/ 负载/ 变化/ 比较/ 理想/ ,/ 与/ 实际/ 情况/ 不符/ ./ 路由器/ 能耗/ 调整/ 对象/ 主要/ 是/ 链路/ 速率/ 和/ 板卡/ ,/ Gunaratne/ 等/ 人/ [/ 13/ ]/ 在/ 2005/ 年/ 首次/ 提出/ 一种/ 能够/ 在/ 全双工/ 传输/ 以太网/ 中/ 根据/ 链路/ 利用率/ 自动/ 切换/ 链路/ 速率/ 的/ 方法/ ,/ 数据/ 表明/ 以太网/ 链路/ 速率/ 从/ 100Mbps/ 增加/ 到/ 1Gbps/ 时/ ,/ 功耗/ 增加/ 了/ 2/ ~/ 4W/ ,/ 增加/ 到/ 10Gbps/ 时/ ,/ 功耗/ 增加/ 10/ ~/ 20W/ ./ 而/ 以太网/ 处于/ 空闲/ 和/ 100/ %/ 链路/ 利用率/ 的/ 情况/ 下/ 功耗/ 几乎/ 相同/ ,/ 即/ 以太网/ 功耗/ 与/ 链路/ 利用率/ 无关/ ./ 通过/ 测量/ 表明/ ,/ 目前/ 以太网/ 链路/ 利用率/ 主要/ 在/ 1/ %/ ~/ 5/ %/ 之间/ ,/ 所以/ 链路/ 处于/ 低/ 利用率/ 时/ 降低/ 链路/ 速率/ 能够/ 有效/ 降低/ 能耗/ ./ 线卡/ 是/ 路由器/ 的/ 一个/ 重要/ 组成/ 部件/ ,/ 有/ 研究/ 人员/ 对/ 线卡/ 节能/ 问题/ 展开/ 研究/ ,/ 文献/ [/ 14/ ]/ 将/ 多/ 核/ 架构/ 和/ 动态/ 电压/ 调整/ 技术/ 应用/ 到/ 线卡/ 设计/ 中/ ,/ 建立/ 到达/ 数据包/ 预测/ 机制/ ,/ 根据/ 待处理/ 数据/ 负载/ 状况/ 决定/ 多核/ 处理器/ 的/ 配置/ ,/ 通过/ 改变/ 参与/ 处理/ 的/ 核/ 的/ 个数/ 和/ 电压/ 降低/ 线卡/ 能耗/ ./ 文献/ [/ 15/ ]/ 对/ 路由器/ 线卡/ 配置/ 进行/ 研究/ ,/ 提出/ 了/ 一个/ 由/ 流量/ 和/ 线卡/ 结构/ 组成/ 的/ 能耗/ 分析/ 框架/ ,/ 依据/ 分析/ 框架/ ,/ 作者/ 给出/ 了/ 不同/ 场景/ 下/ 路由器/ 线卡/ 优化/ 配置/ 模式/ ,/ 在/ 满足/ 转发/ 性能/ 的/ 条件/ 下/ 降低/ 线卡/ 部件/ 能耗/ ./ 上述/ 研究/ 的/ 对象/ 是/ 粗粒度/ 路由器/ 部件/ ,/ 节能/ 效果/ 受到/ 部件/ 的/ 设计/ 局限/ ,/ 随着/ 路由器/ 设计/ 技术/ 的/ 发展/ ,/ 能够/ 进行/ 性能/ 和/ 能耗/ 调节/ 的/ 部件/ 越来越/ 多/ ,/ 上述/ 方法/ 因/ 不能/ 支持/ 细粒度/ 的/ 能耗/ 划分/ 和/ 调整/ ,/ 其/ 适应性/ 和/ 兼容性/ 已显/ 不足/ ./ 本文/ 与/ 前人/ 研究/ 的/ 不同之处/ 在于/ ,/ 我们/ 从/ 路由器/ 体系结构/ 出发/ ,/ 借助/ 构件/ 化/ 的/ 体系结构/ ,/ 重构/ 不同/ 能耗/ 特征/ 的/ 构件/ 使/ 构件/ 组/ 能耗/ 与/ 负载/ 进行/ 一致/ 变化/ ,/ 将/ 路由器/ 服务/ 能力/ 的/ 变化/ 映射/ 为/ 能耗/ 起伏/ ./ 使用/ 预测/ 机制/ 衡量/ 负载/ 变化/ 程度/ ,/ 使用/ 构件/ 作为/ 操作/ 对象/ 降低/ 了/ 能耗/ 调整/ 粒度/ ,/ 使用/ 构件/ 重构/ 技术/ 扩大/ 了/ Page3/ 构件/ 能耗/ 调整/ 范围/ ./ 3/ 路由器/ 构件/ 化/ 体系结构/ 部件/ 休眠/ 或/ 暂时/ 关闭/ 是/ 使用/ 最为/ 广泛/ 的/ 一种/ 节能/ 方法/ ./ 但是/ 路由器/ 使用/ 环境/ 特殊/ ,/ 目前/ 主流/ 高端/ 路由器/ 都/ 是/ Multi/ -/ rack/ 架构/ ,/ 即/ 安装/ 在/ 同一个/ 机架/ 上/ 的/ 多个/ 线卡/ 通过/ 多个/ 并行/ 光/ 链路/ 连接/ 一个/ 交换/ 板卡/ [/ 16/ ]/ ./ 路由器/ 的/ 分割/ 粒度/ 是/ 板卡/ ,/ 但/ 同一个/ 板卡/ 不同/ 接口/ 的/ 到达/ 业务/ 没有/ 规律/ 可循/ ,/ 所以/ 不/ 可能/ 实现/ 整个/ 板卡/ 关闭/ 和/ 休眠/ ,/ 这样/ 就/ 造成/ 在/ 低/ 负载/ 情况/ 下/ 即使/ 仅/ 有/ 一个/ 接口/ 有/ 业务/ ,/ 整个/ 板卡/ 也/ 要/ 加电/ 工作/ ./ 尤其/ 在/ 路由器/ 设计阶段/ ,/ 由于/ 按照/ 峰值/ 负载/ 设计/ 路由器/ 工作/ 能力/ 并且/ 借助/ 冗余技术/ 保证/ 设备/ 可靠性/ ,/ 更是/ 加剧/ 了/ 低/ 业务/ 负载/ 时/ 的/ 能量/ 浪费/ ./ 究其原因/ ,/ 路由器/ 部件/ 的/ 紧/ 耦合/ 是/ 阻碍/ 使用/ 部件/ 休眠/ 技术/ 大幅度降低/ 路由器/ 能耗/ 的/ 瓶颈/ ./ 同时/ 这种/ 部件/ 紧/ 耦合/ 也/ 阻碍/ 了/ 新/ 节能/ 技术/ 的/ 应用/ ,/ 例如/ 部件/ 电压/ 或/ 频率/ 调节/ 技术/ [/ 17/ ]/ ./ 大幅度降低/ 路由器/ 能耗/ 必须/ 使/ 路由器/ 部件/ 能够/ 独立/ 休眠/ 或/ 关闭/ ,/ 而/ 实现/ 这一/ 目标/ 的/ 前提/ 是/ 研究/ 一种/ 部件/ 松/ 耦合/ 的/ 路由器/ 体系结构/ ./ 本文/ 利用/ 业界/ 新/ 提出/ 的/ 构件/ 化可/ 重构/ 路由器/ 架构/ 来/ 研究/ 路由器/ 能耗/ 的/ 细粒度/ 调整/ 问题/ [/ 18/ ]/ ./ 平台/ 化/ 支撑/ 构件/ 化/ 处理/ 技术/ 是/ 构件/ 化可/ 重构/ 路由器/ 得以/ 实现/ 的/ 基础/ ./ 平台/ 、/ 组件/ 和/ 构件/ 三个/ 等级/ 对应/ 于/ 传统/ 系统化/ 支撑/ 模块化/ 处理/ 的/ 三个/ 等级/ —/ —/ —/ 系统/ 、/ 单元/ 和/ 模块/ ,/ 各/ 等级/ 处理/ 的/ 功能/ 和/ 能力/ 基本相同/ ,/ 不同/ 的/ 是/ 开放性/ 和/ 可/ 重构/ 特性/ ./ 系统/ 、/ 单元/ 和/ 模块/ 大多/ 是/ 封闭/ 一体/ 的/ ,/ 平台/ 、/ 组件/ 和/ 构件/ 是/ 开放式/ 可/ 重构/ 的/ ./ 系统/ 只能/ 按/ 固定/ 模式/ 利用/ 功能/ 单元/ 完成/ 单一/ 任务/ ,/ 平台/ 允许/ 以/ 不同/ 组合/ 方式/ 利用/ 功能/ 组件/ 完成/ 多种/ 任务/ ./ 要/ 改变/ 单元/ 的/ 处理/ 功能/ 需要/ 重新/ 设计/ 软硬件/ 模块/ ,/ 但/ 要/ 改变/ 组件/ 的/ 处理/ 功能/ 只/ 需/ 替换/ 或/ 升级/ 构件/ ./ 平台/ 可/ 完成/ 多种/ 转发/ 和/ 交换/ 任务/ ,/ 组件/ 是/ 功能/ 的/ 实现/ 者/ ,/ 构件/ 是/ 组成/ 组件/ 的/ 基础/ ,/ 是/ 可/ 重构/ 路由器/ 实施/ 重构/ 的/ 对象/ ./ “/ 业务/ -/ 服务/ -/ 构件/ ”/ 映射/ 机制/ 是/ 可/ 重构/ 路由器/ 提供/ 网络服务/ 能力/ 的/ 支撑/ [/ 19/ ]/ ./ “/ 业务/ -/ 服务/ ”/ 的/ 映射/ 关系/ 将/ 用户/ 业务/ 进行/ 分类/ ,/ 每/ 一种/ 网络服务/ 可以/ 支撑/ 多种/ 特性/ 相似/ 的/ 用户/ 业务/ ;/ “/ 服务/ -/ 构件/ ”/ 的/ 映射/ 关系/ 将/ 网络服务/ 映射/ 为/ 基础/ 构件/ ,/ 服务/ 指标/ 依托/ 构件实现/ ,/ 通过/ 替换/ 构件/ 或者/ 改变/ 构件/ 的/ 连接/ 方式/ 实现/ 服务/ 能力/ 的/ 变化/ ./ 为了/ 改变传统/ 路由器/ 部件/ 紧/ 耦合/ 的/ 特点/ ,/ 可/ 重构/ 路由器/ 使用/ 了/ 逐级/ 交换/ 的/ 机制/ ,/ 如图/ 1/ 所示/ ,/ 逐级/ 指/ 的/ 是/ 将/ 路由器/ 分为/ 组件/ 间/ 、/ 构件/ 间/ 不同/ 级别/ 的/ 视图/ ,/ 交换/ 指/ 的/ 是/ 组件/ 或/ 构件/ 间/ 不再/ 使用/ 传统/ 的/ 固定/ 线路/ 连接/ 方式/ ,/ 使用/ 交换/ 带有/ 标识/ 的/ 报文/ 来/ 满足/ 组件/ 或/ 构件/ 间/ 的/ 消息/ 交互/ 需求/ ./ 标识/ 内容/ 的/ 多寡/ 影响/ 了/ 交换/ 控制/ 开销/ 和/ 复杂度/ ,/ 根据/ 所/ 处/ 视图/ 的/ 不同/ 可/ 根据/ 实际/ 情况/ 确定/ 交换/ 标识/ 具体内容/ ./ 逐级/ 交换/ 带来/ 的/ 好处/ 是/ 用户/ 在/ 遵循/ 标准接口/ 的/ 前提/ 下/ 可以/ 灵活/ 替换/ 构件/ ,/ 引入/ 新/ 的/ 功能/ ./ 虽然/ 交换/ 技术/ 早有/ 研究/ ,/ 但是/ 传统/ 交换/ 是/ 为了/ 解决/ 多端/ 通信/ 的/ 拥塞/ 问题/ ,/ 面向/ 的/ 是/ TCP/ // IP/ 体系/ 中/ IP/ 报文/ 处理/ ,/ 追求/ 的/ 是/ 高/ 吞吐量/ 和/ 低/ 拥塞/ 率/ ./ 可/ 重构/ 路由器/ 的/ 松/ 耦合/ 思想/ 深化/ 了/ 交换/ 机制/ ,/ 利用/ 交换/ 拓扑/ 可变/ 来/ 更改/ 构件/ 间/ 的/ 通信/ 连接/ ,/ 用户/ 可以/ 专注/ 开发/ 构件/ 的/ 新/ 功能/ ,/ 而/ 不会/ 受到/ 通信/ 对象/ 的/ 限制/ ./ 同样/ 只有/ 在/ 可变/ 连接/ 拓扑/ 的/ 支持/ 下/ ,/ 才能/ 发挥/ 构件/ 休眠/ 或/ 关闭/ 优势/ ;/ 通过/ 替换/ 构件/ ,/ 将/ 支持/ 高/ 负载/ 的/ 高能耗/ 构件/ 替换/ 为/ 低能耗/ 构件/ ./ 在/ 休眠/ 和/ 替换/ 机制/ 支持/ 下/ ,/ 才能/ 实现/ 路由器/ 能耗/ 细粒度/ 调整/ ,/ 使/ 路由器/ 能耗/ 跟随/ 用户/ 业务/ 负载/ 变化/ ./ 可/ 重构/ 路由器/ 和/ 能耗/ 细粒度/ 调整/ 方法/ 的/ 节能/ 特点/ 如图/ 2/ 所示/ ./ 从图/ 2/ 中/ 可以/ 看到/ ,/ 路由器/ 负载/ 随/ 时间/ 发生变化/ ,/ 不/ 采取任何/ 节能/ 措施/ 时/ ,/ 不管/ 负载/ 高低/ 路由器/ 能/ Page4/ 耗/ 不变/ ,/ 如图/ 2/ (/ a/ )/ 所示/ ./ 路由器/ 应用/ 之初/ ,/ 网络流量/ 停留/ 在/ Kbps/ 等级/ ,/ 路由器/ 能耗/ 问题/ 并/ 不/ 突出/ ./ 但是/ 当前/ 网络/ 用户端/ 速率/ 已/ 达到/ Mbps/ 级/ ,/ 骨干/ 链路/ 已达/ Gbps/ 级/ ,/ 路由器/ 已/ 是/ Tbit/ 级/ ,/ 路由器/ 能耗/ 问题/ 已/ 不能/ 忽视/ ./ 业界/ 提出/ 了/ 图/ 2/ (/ b/ )/ 所示/ 的/ 采用/ 部件/ 休眠/ 的/ 节能/ 机制/ ./ 但是/ 这种/ 方法/ 带来/ 了/ 额外/ 的/ 唤醒/ 时延/ ,/ 并且/ 能耗/ 等级/ 只有/ 两种/ 状态/ ,/ 要么/ ON/ ,/ 要么/ OFF/ ./ 部件/ 休眠/ 机制/ 虽能/ 降低/ 能耗/ 但是/ 应用环境/ 受限/ ,/ 不利于/ 时延/ 敏感/ 业务/ ,/ 能耗/ 调整/ 程度/ 有限/ ,/ 设备/ 能耗/ 不能/ 跟随/ 业务/ 负载/ 变化/ ./ 随着/ CPU/ 等/ 硬件/ 元器件/ 支持/ 电压/ 和/ 频率/ 调整/ ,/ 业界/ 将/ 电压/ 和/ 频率/ 调整机制/ 应用/ 到/ 节能/ 领域/ ,/ 图/ 2/ (/ c/ )/ 表示/ 使/ 设备/ 工作/ 在/ 较/ 低/ 频率/ 来/ 降低/ 能耗/ ,/ 但是/ 路由器/ 这种/ 近似/ 实时处理/ 的/ 应用环境/ ,/ 留给/ 系统/ 进行/ 频率/ 选择/ 和/ 调整/ 的/ 时间/ 很/ 短/ ,/ 所以/ 依靠/ 调整/ 电压/ 和/ 频率/ 的/ 节能/ 机制/ 大多/ 应用/ 在/ 软件/ 路由器/ 中/ [/ 20/ -/ 21/ ]/ ./ 图/ 2/ (/ d/ )/ 表示/ 的/ 是/ 本文/ 研究/ 的/ 能耗/ 细粒度/ 调整/ 方法/ ,/ 采用/ 构件/ 休眠/ 和/ 构件/ 重构/ 机制/ ,/ 既/ 能/ 最大/ 程度/ 地/ 降低/ 能耗/ ,/ 又/ 能/ 在/ 负载/ 变化/ 时/ 通过/ 替换/ 不同/ 能耗/ 特征/ 的/ 构件/ 使/ 能耗/ 曲线/ 随/ 负载/ 曲线/ 发生变化/ ./ 尤其/ 是/ 前文/ 描述/ 可/ 重构/ 路由器/ 特有/ 的/ “/ 业务/ -/ 服务/ -/ 构件/ ”/ 映射/ 机制/ ,/ 使用/ 构件/ 组来/ 承载/ 不同/ 特性/ 的/ 业务/ ,/ 使得/ 时延/ 敏感/ 和/ 时延/ 不/ 敏感/ 业务/ 得以/ 区分/ ,/ 为/ 重构/ 构件/ 和/ 唤醒/ 休眠/ 构件/ 提供/ 了/ 时间/ 约束/ ./ 对/ 时延/ 敏感/ 业务/ 侧重/ 使用/ 构件/ 重构/ 机制/ ,/ 不/ 中断/ 业务/ 处理/ ;/ 对/ 时延/ 不/ 敏感/ 业务/ 侧重/ 使用/ 构件/ 休眠/ 机制/ ,/ 最大/ 限度/ 节省/ 能耗/ ./ 4/ 低能耗/ 分析模型/ 此/ 节/ 我们/ 建立/ 构件/ 化/ 路由器/ 的/ 低能耗/ 分析模型/ 并/ 进行/ 分析/ ./ 对/ 路由器/ 负载/ L/ ,/ 假定/ 它/ 可以/ 分为/ n/ 个子/ 任务/ L1/ ,/ L2/ ,/ …/ ,/ Ln/ ,/ 可/ 重构/ 路由器/ 的/ 特点/ 是/ 针对/ 每个/ 子/ 任务/ 可以/ 选择/ 一组/ 合适/ 的/ 构件/ 进行/ 处理/ ./ 因为/ 能耗/ 和/ 功耗/ 之间/ 存在/ 时间/ 关系/ 可/ 相互/ 转化/ ,/ 所以/ 本文/ 不/ 区分/ 能耗/ 和/ 功耗/ ,/ 将/ 两者/ 视为/ 等同/ 衡量/ 参数/ ,/ 我们/ 首先/ 对/ 分析/ 对象/ 做出/ 如下/ 定义/ ./ 定义/ 1/ ./ 能够/ 供/ 可/ 重构/ 路由器/ 选择/ 使用/ 的/ 构件/ 所/ 组成/ 的/ 集合/ 称为/ 构件/ 空间/ ,/ 记/ 为/ Ω/ ./ 为了/ 便于/ 分析/ ,/ 假定/ 构件/ 空间/ 中/ 的/ 构件/ 已/ 进行/ 了/ 初步/ 分类/ ,/ 对子/ 任务/ Li/ 假定/ 有/ m/ 个/ 备选/ 构件/ 可以/ 选择/ ,/ 构件/ 的/ 能耗/ 等级/ 和/ 性能/ 等级/ 一一对应/ ,/ 一种/ 能耗/ 和/ 性能/ 等级/ 对应/ 多个/ 构件/ ./ 设/ 构件/ 能耗/ 等级/ 用/ 1/ ,/ EcEcm/ -/ 1/ ,/ ScSc2/ ,/ …/ ,/ Ec/ 处理/ 负载/ 的/ 情况/ ./ 通常/ 能耗/ 等级/ 不同/ ,/ 性能/ 等级/ 也/ 不同/ ,/ 性能/ 越/ 好/ ,/ 能耗/ 越高/ ./ 当/ 能耗/ 为/ 0/ 时/ (/ 如/ 构件/ 休眠/ ,/ 注意/ 本文/ 中/ 认为/ 休眠/ 的/ 构件/ 不/ 工作/ ,/ 将/ 其/ 能耗/ 置/ 为/ 0/ ,/ 实际/ 情况/ 它会/ 产生/ 较/ 小/ 的/ 能耗/ )/ ,/ 令其/ 性能/ 也/ 为/ 0/ ./ 相同/ 负载/ 情况/ 下/ 不同/ 的/ 性能/ 等级/ 反映/ 了/ 构件/ 工作/ 时间/ 的/ 变化/ ,/ 假定/ 性能/ 越差/ 构件/ 的/ 工作/ 时间/ 越长/ ./ 当前/ 对/ 软件/ 构件/ 进行/ 能耗/ 测量/ 也/ 是/ 一个/ 热点/ 研究/ 方向/ ,/ 本文/ 选择/ 的/ 是/ 文献/ [/ 22/ ]/ 提出/ 的/ 方法/ ,/ 从/ 软件/ 构件/ 体系结构/ 层面/ 出发/ ,/ 假设/ 体系结构/ 级/ 软件/ 特征/ 量/ (/ 如/ 有效/ 代码/ 、/ 代码/ 最差/ 执行/ 周期/ 、/ 运行/ 环境/ 的/ 计算/ 和/ 存储/ 参数/ )/ 与/ 软件/ 构件/ 能耗/ 之间/ 存在/ 非线性/ 函数/ 关系/ (/ 线性/ 函数/ 关系/ 可/ 认为/ 是/ 一种/ 特殊/ 的/ 非线性/ 函数/ 关系/ )/ ,/ 并/ 以此/ 假设/ 为/ 基础/ ,/ 利用/ 如/ BP/ 神经网络/ 等/ 工具/ 估算/ 软件/ 能耗/ ./ BP/ 神经网络/ 经过/ 多次/ 学习/ 后/ 找到/ 构件/ 能耗/ 与/ 构件/ 特征/ 量/ 之间/ 的/ 函数/ 关系/ ,/ 输入/ 不同/ 的/ 构件/ 能耗/ 特征/ 量/ 参数/ 就/ 可以/ 得到/ 软件/ 构件/ 的/ 能耗/ ./ 具体/ 过程/ 本文/ 不再/ 赘述/ ./ 定义/ 2/ ./ 路由器/ 选出/ 的/ 用于/ 处理/ 子/ 任务/ Lj/ 的/ 构件/ 集合/ 称为/ 构件/ 组/ ,/ 记为/ CLj/ ./ 使用/ cij/ 表示/ 构件/ 组中/ 的/ 元素/ ,/ cij/ 表示/ 路由器/ 根据/ 子/ 任务/ Lj/ 在/ m/ 个/ 备选/ 构件/ 中/ 选择/ 使用/ 第/ i/ 个/ 构件/ ./ 我们/ 假定/ 构件/ 组/ 的/ 能耗/ 为/ 各个/ 构件/ 能耗/ 之/ 和/ ,/ 不/ 考虑/ 因/ 构件/ 并行执行/ 隐藏/ 的/ 工作/ 时间/ ,/ 即/ 任务/ 的/ 完成/ 时间/ 也/ 为/ 各个/ 构件/ 工作/ 时间/ 之/ 和/ ./ 替换/ 构件/ 存在/ 一定/ 的/ 能耗/ 和/ 性能/ 损失/ ,/ 单个/ 构件/ 重构/ 能耗/ 开销/ 为/ Δ/ ER/ ,/ 单个/ 构件/ 重构/ 时间/ 开销/ 为/ Δ/ TR/ ./ 定义/ 3/ ./ 构件/ 组/ 的/ 能耗/ 随/ 时间/ 变化/ 的/ 曲线/ 称为/ 构件/ 组/ 时间/ 能耗/ 曲线/ ,/ 构件/ 组/ 时间/ 能耗/ 曲线/ 是/ 每隔/ 一定/ 时隙/ 获得/ 的/ 能耗/ 值/ ,/ 所以/ 是/ 离散/ 曲线/ ./ 构件/ 组/ 的/ 性能/ 也/ 是/ 每隔/ 一定/ 时隙/ 测量/ 得到/ 的/ 离散/ 值/ ./ 路由器/ 有/ 多种/ 构件/ 选择/ 方式/ 处理/ 任务/ ./ 构件/ 的/ 选择/ 方式/ 用/ 矩阵/ 犓/ 表示/ ,/ 如式/ (/ 1/ )/ 所示/ ./ 其中/ ,/ kij/ =/ 1/ 表示/ 第/ Lj/ 子/ 任务/ 选择/ 了/ 可以/ 执行/ 此/ 任务/ 的/ 第/ i/ 个/ 构件/ ,/ 否则/ 为/ 0/ ./ 此/ 构件/ 的/ 能耗/ 等级/ 为/ i/ ,/ 性能/ 等级/ 为/ ScEc/ 的/ 能耗/ EL/ 和/ 工作/ 时间/ TL/ 如式/ (/ 2/ )/ 和/ 式/ (/ 3/ )/ 所示/ ./ 定义/ 4/ ./ 构件/ 组/ 能耗/ 记为/ EL/ ,/ 构件/ 组/ 工作/ 时间/ 记为/ TL/ ./ 其中/ TL/ 包含/ 了/ 构件/ 重构/ 的/ 切换/ 时间/ ,/ 其中/ KR/ 为/ 重构/ 构件/ 个数/ ./ Page5/ 定义/ 5/ ./ 重构/ 时/ 构件/ 组/ 的/ 重构/ 能耗/ 记为/ ER/ 如式/ (/ 4/ )/ 所示/ ,/ 其中/ KR/ 为/ 重构/ 的/ 构件/ 个数/ ./ 为/ 衡量/ 所/ 选/ 构件/ 性能/ 是否/ 满足/ 负载/ 要求/ ,/ 我们/ 引入/ 构件/ 性能/ 根/ 方差/ 来/ 衡量/ 单个/ 构件/ 性能/ 与/ 负载/ 接近/ 程度/ ./ 为了/ 衡量/ 构件/ 组/ 性能/ 与/ 负载/ 接近/ 程度/ ,/ 我们/ 引入/ 构件/ 组/ 性能/ 协方差/ 来/ 衡量/ 构件/ 组与/ 负载/ 接近/ 程度/ ./ 定义/ 6/ ./ 构件/ 性能/ 根/ 方差/ 记为/ D/ (/ Sc/ 单个/ 构件/ 性能/ 偏离/ 构件/ 性能/ 均值/ 分散/ 程度/ 的/ 数字/ 特征/ ,/ 当/ 高于/ 构件/ 性能/ 均值/ 时/ ,/ 构件/ 性能/ 根/ 方差/ 取/ 正值/ ;/ 当/ 低于/ 构件/ 性能/ 均值/ 时/ ,/ 构件/ 性能/ 根/ 方差/ 取/ 负值/ ./ 式/ (/ 5/ )/ 表示/ 构件/ 性能/ 数学/ 期望值/ ,/ 式/ (/ 6/ )/ 表示/ 所/ 选/ 构件/ 的/ 性能/ 根/ 方差/ ./ 定义/ 7/ ./ 构件/ 组/ 性能/ 变量/ 与/ 负载/ 变量/ 协方差/ 记为/ cov/ (/ SL/ ,/ L/ )/ ./ 其中/ SL/ 表示/ 构件/ 组/ 性能/ 变量/ ,/ L/ 表示/ 负载/ 变量/ ./ cov/ (/ SL/ ,/ L/ )/ =/ E/ [/ (/ SL/ -/ E/ (/ SL/ )/ )/ (/ L/ -/ E/ (/ L/ )/ )/ ]/ 协方差/ 适用/ 于/ 构件/ 组/ 性能/ 变量/ 与/ 业务/ 负载/ 变量/ 量纲/ 一致/ 的/ 情况/ ,/ 例如/ 两者/ 均/ 用/ 单位/ 时间/ 内/ 数据包/ 数/ 衡量/ 或/ 负载/ 字节数/ 衡量/ ./ 若/ 两个/ 变量/ 的/ 量纲/ 不/ 一致/ ,/ 我们/ 引入/ 了/ 构件/ 组/ 性能/ 变量/ 与/ 负载/ 变量/ 的/ 相关系数/ 这个/ 定义/ ./ 如/ 定义/ 8/ 所示/ ./ 定义/ 8/ ./ 构件/ 组/ 性能/ 变量/ 与/ 负载/ 变量/ 相关系数/ 记/ 为/ ρ/ cov/ (/ SL/ ,/ L/ )/ ,/ ρ/ cov/ (/ SL/ ,/ L/ )/ ∈/ [/ -/ 1/ ,/ 1/ ]/ ,/ 取值/ 接近/ 1/ 表示/ 构件/ 组/ 性能/ 曲线/ 贴近/ 负载/ 曲线/ ./ 综上/ ,/ 构件/ 重构/ 目标/ 是/ 在/ 保证/ 性能/ 曲线/ 贴近/ 负载/ 曲线/ 的/ 前提/ 下/ 搜索/ 出/ 具有/ 最低/ 能耗/ 特征/ 的/ 构件/ 组合/ 方案/ ./ 这一/ 过程/ 可以/ 建模/ 为/ 多/ 目标/ 优化/ 问题/ ./ 为了/ 简化/ 分析/ ,/ 本文/ 仅/ 考虑/ 构件/ 组/ 的/ 能耗/ 和/ 性能/ 两个/ 特征/ ,/ 可/ 将/ 能耗/ 细粒度/ 调整/ 问题/ 形式化/ 为/ 其中/ ,/ Lj/ 表示/ 路由器/ 的/ 工作/ 负载/ ,/ Lj/ =/ 0/ 表示/ 当前/ 没有/ 负载/ 到达/ ,/ 路由器/ 可以/ 休眠/ 构件/ ;/ ∑/ nTthreshold/ 时间/ 内/ 到达/ 的/ 负载/ 之/ 和/ ,/ 其值/ 等于/ 预测值/ loadTL/ (/ t/ +/ τ/ )/ ,/ 此/ 条件/ 保证/ 可以/ 根据/ 当前/ 条件/ 预测/ 负载/ 变化/ ,/ 为/ 重构/ 算法/ 提供/ 时间/ 保证/ ,/ 提前/ 选择/ 和/ 部署/ 构件/ ./ TL/ / Tthreshold/ 保证/ 构件/ 组在/ 指定/ 时间/ 内/ 完成/ 负载/ 处理/ ./ 特别/ 的/ 是/ ,/ Tthreshold/ 的/ 选择/ 体现/ 了/ 能耗/ 调整/ 方法/ 对/ 时间/ 粒度/ 的/ 控制/ ,/ 可以/ 根据/ 负载/ 时延/ 敏感/ 特性/ 选择/ 不同/ 的/ 时间/ 粒度/ ./ 时间/ 粒度/ 大/ ,/ 时延/ 敏感性/ 差/ ,/ 但/ 节能/ 效果/ 明显/ ./ 时间/ 粒度/ 小/ ,/ 虽能/ 提高/ 时延/ 敏感性/ ,/ 但/ 因/ 构件/ 频繁/ 的/ 替换/ 会/ 减弱/ 节能/ 效果/ ./ 5/ 能耗/ 细粒度/ 调整/ 能耗/ 细粒度/ 调整/ 是/ 在/ 一定/ 时间/ 粒度/ 上/ 根据/ 负载/ 变化/ 重构/ 构件/ ,/ 重构/ 构件/ 指/ 的/ 是/ 调整/ 构件/ 工作/ 状态/ (/ 休眠/ 或/ 替换/ 构件/ )/ 达到/ 使/ 构件/ 组/ 能耗/ 跟随/ 负载/ 变化/ 的/ 目的/ ./ 整个/ 调整/ 过程/ 分为/ 两个/ 部分/ ,/ 一个/ 是/ 对/ 负载/ 变化/ 做出/ 预测/ ,/ 另/ 一个/ 是/ 在/ 寻找/ 合适/ 的/ 构件/ 重构/ 方案/ ./ 5.1/ 负载/ 预测/ 为了/ 使/ 构件/ 组/ 能耗/ 按照/ 负载/ 曲线/ 发生变化/ ,/ 需要/ 对/ 路由器/ 一定/ 时间段/ 内/ 的/ 负载/ 进行/ 预测/ ./ 当前/ 网络/ 测量/ 领域/ 有/ 很多/ 方法/ 能够/ 满足/ 本文/ 的/ 要求/ ,/ 如/ 回归/ 分析/ 、/ 趋势/ 外/ 推/ 等/ ./ 本文/ 关注/ 能够/ 预测/ 负载/ 变化规律/ ,/ 并/ 不/ 关注/ 能否/ 精确测量/ 负载/ ,/ 所以/ 选择/ 布尔/ 二次/ 指数/ 平滑/ 法/ [/ 22/ ]/ 对/ 路由器/ 负载/ 进行/ 预测/ ,/ 此/ 方法/ 通过/ 预测/ 路由器/ 缓存/ 需求/ 数来/ 反映/ 到达/ 负载/ 的/ 变化/ ./ 预测/ 公式/ 为/ 其中/ ,/ load/ (/ t/ )/ 为/ t/ 时刻/ 观察/ 到/ 的/ 缓存/ 请求/ 数/ ,/ load/ (/ t/ +/ τ/ )/ 为/ t/ +/ τ/ 时刻/ 的/ 预测值/ ,/ L/ (/ 1/ )/ 指数/ 平滑/ 值/ 和/ 二次/ 指数/ 平滑/ 值/ ,/ α/ 为/ 平滑/ 参数/ ./ 通过/ Page6/ 式/ (/ 10/ )/ 可以/ 在/ 时刻/ t/ 求得/ t/ +/ τ/ 时刻/ 的/ 预测值/ ,/ 真实/ 值为/ 式/ (/ 11/ )/ 所示/ ,/ 其中/ ε/ j/ 为/ 误差/ ./ 5.2/ 能耗/ 细粒度/ 调整/ 算法/ 随着/ 可/ 重构/ 路由器/ 的/ 发展/ ,/ 构件/ 种类/ 和/ 构件/ 数量/ 都/ 会/ 有/ 较/ 大规模/ 发展/ ,/ 在/ 构件/ 空间/ 内/ 搜索/ 构件/ 组/ 的/ 最优/ 配置/ 方案/ 需要/ 考虑/ 性能/ 约束/ 和/ 能耗/ 约束/ ,/ 是/ 一个/ NP/ -/ 难/ 问题/ ./ 为了/ 快速/ 寻找/ 最优/ 近似/ 解/ ,/ 我们/ 基于/ 遗传算法/ 搜索/ 构件/ 组/ 的/ 能耗/ 最优/ 组合/ ./ 根据/ 遗传算法/ 思想/ ,/ 本文/ 将/ 构件/ 组/ 选择/ 方案/ 看作/ 染色体/ ,/ 根据/ 其/ 适应/ 值/ 大小/ 确定/ 其/ 优越性/ ,/ 适应/ 值越/ 高/ ,/ 生存/ 概率/ 越大/ ,/ 进行/ 繁殖/ 的/ 概率/ 也/ 越/ 大/ ./ 经过/ 若干代/ 遗传/ ,/ 选出/ 构件/ 组/ 最优/ 组合/ 方案/ ./ 每个/ 染色体/ 代表/ 一个/ 备选/ 方案/ ,/ 染色体/ 编码/ 规则/ 表明/ 了/ 构件/ 组由/ 哪些/ 构件/ 组成/ ./ 一个/ 染色体/ 由/ 多个/ 不同/ 基因/ 串/ 构成/ ,/ 每个/ 基因/ 串/ 对应/ 一个/ 构件/ ,/ 一个/ 基因/ 串/ 由/ 两个/ 子串/ 组成/ ,/ 分别/ 表示/ 构件/ 性能/ 等级/ 和/ 能耗/ 等级/ ,/ 具体/ 编码/ 规则/ 如下/ :/ (/ 1/ )/ 子串/ 编码/ 长度/ 由/ 构件/ 性能/ 等级/ 和/ 能耗/ 等级/ 决定/ ,/ 例如/ 本文/ 中/ 我们/ 将/ 构件/ 的/ 性能/ 等级/ 和/ 能耗/ 等级/ 分为/ 10/ 类/ ,/ 相应/ 的/ 子串/ 长度/ 分别编/ 为/ 8/ 位/ ,/ 其中/ 低/ 4/ 位/ 用来/ 表示/ 性能/ 和/ 能耗/ 分类/ ;/ 因串/ 的/ 数量/ ./ (/ 2/ )/ 基因/ 串/ 长度/ 由/ 子串/ 长度/ 之/ 和/ 确定/ ;/ (/ 3/ )/ 根据/ 每个/ 构件/ 组/ 备选/ 方案/ 确定/ 染色体/ 中基/ 这样/ 设计/ 编码/ 规则/ 的/ 优势/ 在于/ :/ 不同/ 基因/ 串中/ 的/ 性能/ 和/ 能耗/ 子串/ 位置/ 相互/ 对应/ ,/ 当/ 染色体/ 之间/ 进行/ 交叉/ 变异/ 时/ ,/ 基因/ 串/ 可以/ 同步/ 隔离/ 进行/ ,/ 大大/ 加快/ 了/ 染色体/ 进化/ 速度/ ;/ 构件/ 性能/ 和/ 能耗/ 通过/ 位数/ 进行/ 区分/ ,/ 同等/ 编码/ 长度/ 的/ 构件/ 可以/ 在/ 编码/ 中/ 加入/ 其它/ 信息/ ,/ 例如/ 时延/ 、/ 编译/ 方式/ 等/ ./ 图/ 3/ 是/ 含有/ 10/ 个/ 构件/ 的/ 染色体/ 编码/ 举例/ ./ 算法/ 中/ 适应/ 值/ 函数/ 包括/ 两个/ 部分/ ,/ 一个/ 是/ 构件/ 组/ 性能/ 与/ 负载/ 的/ 相关系数/ ,/ 一个/ 是/ 构件/ 组/ 能耗/ ./ 我们/ 求得/ 每个/ 染色体/ 与/ 预测/ 负载/ 的/ 相关系数/ ,/ 追求/ 其/ 最大值/ ./ 在/ 构件/ 组/ 性能/ 逼近/ 负载/ 变化/ 的/ 情况/ 下/ ,/ 我们/ 比较/ 染色体/ 能耗/ ,/ 选择/ 能耗/ 最小/ 的/ 染色体/ ./ 能耗/ 细粒度/ 调整/ 算法/ (/ EnergyMeticulous/ -/ grainedScalingAlgorithm/ ,/ EMSA/ )/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 能耗/ 细粒度/ 调整/ 算法/ ./ // // N/ :/ 构件/ 组中/ 构件/ 的/ 种类/ ;/ M/ :/ 每种/ 构件/ 的/ 备选/ 个数/ ;/ gen/ :/ 迭代/ 次数/ ;/ popu/ :/ 染色/ 群体/ 大小/ // // List/ 〈/ char/ [/ ]/ 〉/ chromos/ :/ 染色体/ 基因/ 串/ ;/ Lisr/ 〈/ chromos/ 〉/ clist/ :/ 群体/ 个数/ ,/ 长度/ 为/ popu/ ;/ 输入/ :/ load/ [/ N/ ]/ // // 前端/ 预测/ 的/ 缓存/ 请求/ 数/ 输出/ :/ K/ [/ N/ ]/ [/ M/ ]/ // // 构件/ 空间/ 每种/ 构件/ 选择/ 情况/ 1/ ./ Initializecomlist/ ;/ 2/ ./ FOReachgeningens3/ ./ FOReachchromosincomlist4/ ./ FOR/ (/ i/ =/ 1/ ;/ i/ </ chromos/ ./ size/ ;/ i/ ++/ )/ 5/ ./ str/ =/ string/ ./ value/ (/ chromos/ ./ get/ (/ i/ )/ )/ ;/ 6/ ./ FOR/ (/ j/ =/ 1/ ;/ j/ </ component/ ./ length/ ;/ j/ ++/ )/ 7/ ./ compareenergyandperformance8/ ./ K/ [/ i/ ]/ [/ j/ ]/ =/ 1/ ;/ // // 确定/ 合适/ 的/ 构件/ 9/ ./ ENDFOR10/ ./ ENDFOR11/ ./ computeEL/ ;/ 根据/ 式/ (/ 2/ )/ 、/ 式/ (/ 7/ )/ 计算/ 适应/ 值/ 12/ ./ ENDFOR13/ ./ selection/ (/ )/ ;/ // // 根据/ 适应/ 值/ 大小/ 选择/ 优秀/ 的/ 父代/ ,/ 14/ ./ cross/ (/ )/ ;/ // // 在/ 新/ 个体/ 中/ 随机/ 选择/ 交叉点/ 配对/ ,/ 15/ ./ mutation/ (/ )/ ;/ // // 在/ 新/ 个体/ 中/ 随机/ 选择/ 变异/ 点/ 配对/ ,/ 16/ ./ ENDFOR6/ 仿真/ 与/ 结果/ 分析/ 为了/ 检测/ 本文/ 提出/ 的/ 能耗/ 细粒度/ 调整/ 方法/ 的/ 效果/ ,/ 我们/ 设计/ 了/ 3/ 类/ 实验/ 场景/ 验证/ 负载/ 预测/ 算法/ 和/ EMSA/ 算法/ ./ (/ 1/ )/ 验证/ 负载/ 预测/ 算法/ 准确度/ ;/ (/ 2/ )/ 验证/ 能耗/ 细粒度/ 调整/ 算法/ 的/ 收敛性/ ,/ 分析/ 算法/ 代价/ 和/ 复杂度/ ;/ (/ 3/ )/ 考虑/ 负载/ 预测/ 的/ 条件/ 下/ ,/ 比较/ 本文/ 算法/ 与/ Page7/ 文献/ [/ 24/ ]/ 中/ 算法/ 的/ 有效性/ ./ 文献/ [/ 24/ ]/ 提出/ 了/ 基于/ 构件/ 和/ 流量/ 的/ 能耗/ 分析/ 框架/ ,/ 论文/ 中/ 的/ 算法/ 用来/ 解决/ 不同/ 场景/ 下/ 构件/ 配置/ 问题/ ,/ 首次/ 提出/ 了/ 改变/ 构件/ 配置/ 降低/ 能耗/ 的/ 概念/ ,/ 工作/ 具有/ 代表性/ ,/ 所以/ 选择/ 与/ 该文/ 工作/ 进行/ 比较/ ./ 6.1/ 实验/ 环境/ 设置/ 可/ 重构/ 路由器/ 由/ 构件/ 组成/ ,/ 在/ 实验/ 中/ 我们/ 仿真/ 路由器/ 数据/ 平面/ 的/ 业务/ 处理过程/ ./ 参照/ 可/ 重构/ 路由器/ 构件/ 设置/ ,/ 选择/ 转发/ 过程/ 的/ 10/ 类/ 构件/ ,/ 每/ 类/ 构件/ 能耗/ 和/ 性能/ 分为/ 10/ 个/ 等级/ ,/ 每个/ 等级/ 设置/ 10/ 个/ 备选/ 构件/ ,/ 整个/ 空间/ 有/ 1000/ 个/ 构件/ 样本/ ./ 遗传算法/ 的/ 关键/ 参数/ ,/ 我们/ 选择/ 文献/ [/ 25/ ]/ 提供/ 的/ 经验值/ ./ 参数/ 的/ 取值/ 对/ 算法/ 的/ 效率/ 有/ 十分/ 重要/ 的/ 影图/ 4/ 校园网/ 路由器/ 与/ CERNT/ 接口/ 的/ 流量/ 统计图/ 5/ 伯克利大学/ 与/ Internet/ 接口/ 的/ 流量/ 统计/ 响/ ./ 因为/ 研究/ 重点/ 不同/ ,/ 本文/ 不/ 讨论/ 如何/ 选择/ 最合适/ 的/ 参数值/ ./ 关键/ 参数/ 取值/ 如表/ 1/ 所示/ ./ 为了/ 检测/ 负载/ 预测/ 算法/ 的/ 准确度/ ,/ 实验/ 中/ 我们/ 使用/ 两种/ 典型/ 的/ 业务/ 负载/ 数据/ 样本/ ./ 图/ 4/ 所示/ 样本/ 选/ 自/ 西安交通大学/ 校园网/ 与/ 教育/ 科研/ 网/ (/ CERNT/ )/ 接口/ 流量/ 监测数据/ ①/ ,/ 数据/ 点值/ 取/ 30min/ 采样/ 平均值/ ./ 图/ 5/ 所示/ 样本/ 选/ 自/ 美国/ 加州/ 伯克利大学/ 提供/ 的/ 本校/ 国际/ 互联网/ 出口/ 数据/ ②/ ,/ 数据/ 点/ 取值/ 为/ 负载/ 包数/ ./ 由图/ 4/ 可以/ 获得/ 如下/ 数据/ :/ 对/ 出口/ 数据/ ,/ 一周/ 内/ 最大/ 流量/ 为/ 1.22/ Gbps/ (/ 链路/ 容量/ 为/ 2.5/ Gbps/ ,/ 占/ 链路/ 容量/ 的/ 48.8/ %/ )/ ,/ 平均/ 流量/ 为/ 532.27/ Mbps/ (/ 21.29/ %/ )/ ,/ 最低/ 流量/ 为/ 222.03/ Mbps/ (/ 8.88/ %/ )/ ;/ 对/ 入口/ 数据/ 一周/ 内/ 最大/ 流量/ 为/ 854.23/ Mbps/ (/ 34.16/ %/ )/ ,/ 平均/ 流量/ 为/ 536.47/ Mbps/ (/ 21.46/ %/ )/ ,/ 最低/ 流量/ 为/ 432.24/ Mbps/ (/ 17.28/ %/ )/ ./ 即使/ 在/ 网络/ 最/ 繁忙/ 时期/ ,/ 链路/ 利用率/ 也/ 不足/ 50/ %/ ,/ 部分/ 时段/ 更是/ 低于/ 10/ %/ ./ 相对/ 于/ 出口/ 平均值/ ,/ 出口/ 数据/ 在/ [/ -/ 58.6/ %/ ,/ 129.3/ %/ ]/ 范围/ 内/ 波动/ ,/ 相对/ 于/ 入口/ 平均值/ ,/ 入口/ 数据/ 在/ [/ -/ 19.4/ %/ ,/ 59.2/ %/ ]/ 范围/ 内/ 波动/ ./ 由图/ 5/ (/ a/ )/ 可知/ ,/ 网络流量/ 相对/ 于/ 平均值/ 在/ [/ -/ 84.9/ %/ ,/ 258/ %/ ]/ 范围/ 内/ 波动/ ./ 从图/ 5/ (/ b/ )/ 中/ 可以/ 看出/ ,/ 网络流量/ 变化/ 幅度/ 明显/ ,/ 有/ 很大/ 一部分/ 时间/ 网络流量/ 低于/ 平均值/ ,/ 路由器/ 大量/ 部件/ 在/ 此/ 时间段/ 内/ 处在/ 空转/ 状态/ ,/ 白白浪费/ 能量/ ,/ 这些/ 事实/ 为/ 调整/ 构件/ 组合/ 方案/ 降低/ 路由器/ 能耗/ 提供/ 了/ 依据/ ./ ①/ index/ ./ html/ ②/ Page86/ ./ 2/ 实验/ 结果/ 分析/ 6.2/ ./ 1/ 预测/ 算法/ 的/ 准确度/ 我们/ 以/ 伯克利大学/ 负载/ 变化/ 为例/ ,/ 在/ τ/ =/ 10s/ ,/ α/ =/ 0.3/ ,/ 0.5/ ,/ 0.8/ 时/ 预测/ 算法/ 得到/ 的/ 负载/ 分布/ 与/ 实际/ 负载/ 分布/ 之间/ 的/ 比较/ 如图/ 6/ 所示/ ./ 对/ 结果/ 进行/ 平图/ 6/ 网络流量/ 测量/ 值/ 与/ 预测值/ 6.2/ ./ 2/ 能耗/ 细粒度/ 调整/ 算法/ 的/ 收敛性/ 及/ 复杂度/ 分析/ EMSA/ 算法/ 收敛/ 速度/ 和/ 时间/ 开销/ 受到/ 备选/ 构件/ 数量/ 和/ 负载/ 起伏/ 程度/ 的/ 影响/ ./ 因此/ ,/ 本/ 场景/ 的/ 目的/ 是/ 验证/ 在/ 各种/ 构件/ 数量/ 和/ 负载/ 起伏/ 程度/ 的/ 组合/ 下/ ,/ 算法/ 是否/ 具有/ 稳定/ 的/ 收敛性/ ./ 实验/ 条件/ 设置/ 为/ :/ 负载/ 选择/ 伯克利大学/ 流量/ 数据/ ,/ 构件/ 数量/ 为/ 500/ ~/ 1000/ ,/ 其中/ 10/ 种/ 能耗/ 和/ 性能/ 等级/ 的/ 构件/ 分别/ 占/ 1/ // 10/ ./ 根据/ 图/ 5/ 提供/ 的/ 数据/ ,/ 我们/ 设定/ 负载/ 变化/ 按照/ 起伏/ 范围/ 分为/ 5/ 类/ ,/ 分别/ 对应/ 变化/ 幅度/ 在/ ±/ 10/ %/ ,/ ±/ 20/ %/ ,/ ±/ 30/ %/ ,/ ±/ 50/ %/ ,/ ±/ 80/ %/ ./ 通过/ 仿真/ 发现/ ,/ EMSA/ 算法/ 在/ 备选/ 构件/ 数量/ 和/ 负载/ 变化/ 组合/ 下/ 平均/ 250/ 次/ 迭代/ 就/ 可以/ 收敛/ 到/ 较/ 稳定/ 的/ 数值/ ./ 图/ 7/ (/ a/ )/ ~/ (/ d/ )/ 显示/ 了/ 2/ 种/ 负载/ 起伏/ 500/ 个/ 构件/ 、/ 3/ 种/ 负载/ 起伏/ 600/ 个/ 构件/ 、/ 4/ 种/ 负载/ 起伏/ 800/ 个/ 构件/ 、/ 5/ 种/ 负载/ 起伏/ 1000/ 个/ 构件/ 4/ 种/ 情况/ 下/ 的/ 算法/ 收敛/ 情况/ ,/ 横轴/ 是/ 算法/ 迭代/ 次数/ ,/ 纵轴/ 是/ 构件/ 组/ 性能/ 与/ 负载/ 的/ 相关系数/ ./ 由图/ 7/ 可知/ ,/ EMSA/ 算法/ 的/ 计算/ 复杂度/ 由/ 构件/ 数量/ N/ 、/ 负载/ 变化/ 种类/ M/ 、/ 进化/ 次数/ 和/ 群体/ 规模/ 决定/ ./ 其中/ ,/ 初始/ 群体/ 规模/ 可以/ 设置/ 为/ 固定值/ ,/ 根据/ 仿真/ 的/ 结论/ 算法/ 迭代/ 250/ 次/ 就/ 可/ 收敛/ ,/ 可以/ 将/ 进化/ 次数/ 也/ 设置/ 为/ 固定值/ ,/ 这样/ EMSA/ 算法/ 的/ 计算/ 复杂度/ 可用/ O/ (/ NM/ )/ 来/ 衡量/ ./ 图/ 8/ 和/ 图/ 9/ 描述/ 了/ 在/ 构件/ 数量/ 和/ 负载/ 起伏/ 变化/ 组合/ 下/ EMSA/ 算法/ 迭代/ 250/ 次/ 的/ 时间/ 开销/ ,/ 从图/ 8/ 可以/ 发现/ ,/ 当/ 负载/ 起伏/ 变化/ 一致/ 时/ ,/ 时间/ 开销/ 基本上/ 随/ 构件/ 数量/ 的/ 增加/ 呈/ 线性/ 增长/ ,/ 进行/ 相关度/ 分析/ 后均/ 相对误差/ 分析/ 可以/ 发现/ α/ 的/ 取值/ 对/ 预测/ 结果/ 影响/ 不/ 大/ ,/ α/ =/ 0.3/ ,/ 0.5/ ,/ 0.8/ 时/ 平均/ 相对误差/ 分别/ 为/ 0.073/ ,/ 0.081/ ,/ 0.094/ ./ 由此可知/ 布尔/ 二次/ 预测/ 算法/ 可以/ 准确/ 地/ 预测/ 负载/ 变化/ ,/ 在/ 后续/ 实验/ 中/ α/ =/ 0.8/ ./ 发现/ ,/ 两者/ 线性相关/ 度为/ 97/ %/ ./ 从图/ 9/ 可以/ 发现/ ,/ 当/ 构件/ 数量/ 一定/ 时/ ,/ 算法/ 时间/ 开销/ 基本/ 与/ 负载/ 变化/ 呈/ 线性相关/ ,/ 两者/ 相关度/ 约/ 为/ 98/ %/ ./ 上述/ 数据/ 可以/ 说明/ ,/ 算法/ 时间/ 复杂度/ 可以/ 随/ 构件/ 数量/ 的/ 确定/ 或/ 负载/ 变化/ 程度/ 的/ 确定/ 而/ 降低/ ,/ 这/ 也/ 说明/ 了/ 优化/ 负载/ 预测/ 算法/ 可以/ 降低/ EMSA/ 算法/ 的/ 时间/ 复杂度/ ./ 6.2/ ./ 3EMSA/ 算法/ 有效性/ 比较/ 能耗/ 调整/ 的/ 效果/ 与/ 负载/ 预测/ 算法/ 和/ 构件/ 组/ 方案/ 选择/ 有关/ ,/ 本/ 场景/ 的/ 实验/ 目的/ 是/ 在/ 负载/ 和/ 构件/ 数目/ 变化/ 的/ 条件/ 下/ 检验/ 能耗/ 调整/ 效果/ ,/ 构件/ 的/ 样本空间/ 为/ 1000/ 个/ 构件/ ,/ 负载/ 使用/ 伯克利大学/ 的/ 网络流量/ 样本/ ./ 本文/ 算法/ 用/ EMSA/ 标识/ ,/ 文献/ [/ 25/ ]/ 中/ 的/ 算法/ 使用/ Ramirez09/ 标识/ ./ 图/ 10/ 分别/ 显示/ 了/ 两种/ 算法/ 的/ 运行/ 时间/ 比较/ ,/ 图/ 11/ 显示/ 了/ 两种/ 算法/ 调整/ 下/ 构件/ 组/ 性能/ 曲线/ 与/ 负载/ 流量/ 对比/ ,/ 图中/ 进行/ 了/ 归一化/ 处理/ 以/ 衡量/ 性能/ 曲线/ 变化/ 程度/ ,/ 图/ 12/ 和/ 图/ 13/ 显示/ 了/ 一段/ 时长/ 300s/ 的/ 能耗/ 调整/ 效果/ ./ 图/ 10/ 中/ 可以/ 发现/ 本文/ 的/ EMSA/ 算法/ 相比/ Ramirez09/ 算法/ 节省/ 了/ 大约/ 60/ %/ 的/ 算法/ 运行/ 时间/ ,/ 原因/ 是/ EMSA/ 算法/ 并行/ 搜索/ 构件/ 配置/ 方案/ ,/ 并且/ 使用/ 了/ 特别/ 设计/ 的/ 编码/ 规则/ 使得/ 基因/ 串/ 可以/ 同步/ 隔离/ 进行/ 变异/ ,/ 大大/ 加快/ 了/ 染色体/ 进化/ 的/ 速度/ ,/ 缩短/ 了/ 算法/ 运行/ 的/ 时间/ ./ 但是/ 值得注意/ 的/ 是/ 算法/ 的/ 运行/ 时间/ 随着/ 构件/ 数目/ 增加/ 而/ 变大/ ,/ 在/ 某些/ 时延/ 敏感/ 业务/ 场景/ 时/ 需要/ 限制/ 算法/ 运行/ 时间/ ./ 从图/ 11/ 中/ 可以/ 看出/ 两种/ 算法/ 都/ 能/ 随/ 负载/ 变化/ 调整/ 构件/ 配置/ 方案/ ,/ 但是/ 在/ 调整/ 的/ 粒度/ 和/ 范围/ 上存/ Page9/ 图/ 7/ 不同/ 构件/ 数量/ 和/ 负载/ 起伏/ 变化/ 组合/ 下/ 的/ 算法/ 收敛/ 情况/ Page10/ 在/ 差别/ ./ Ramirez09/ 算法/ 构件/ 性能/ 等级/ 调整/ 粒度/ 较/ 粗/ ,/ 构件/ 配置/ 方案/ 都/ 是/ 提前/ 设置/ ,/ 只能/ 在/ 有限/ 的/ 几个/ 等级/ 进行/ 调整/ ,/ 并且/ 构件/ 组/ 性能/ 曲线/ 没有/ 与/ 负载/ 进行/ 一致/ 变化/ ,/ 造成/ 这种/ 现象/ 的/ 原因/ 是/ Ramirez09/ 算法/ 没有/ 考虑/ 对/ 负载/ 进行/ 预测/ ,/ 所以/ 对/ 构件/ 的/ 调整/ 会/ 滞后/ 于/ 网络/ 负载/ 变化/ ,/ 对/ 负载/ 小幅度/ 的/ 变化/ 并/ 不/ 敏感/ ./ 相比之下/ ,/ EMSA/ 算法/ 采用/ 了/ 负载/ 预测/ ,/ 可以/ 使/ 构件/ 组/ 性能/ 曲线/ 追随/ 负载/ 发生/ 细粒度/ 变化/ ,/ 并且/ 在/ 遗传算法/ 配合/ 下/ 可以/ 选择/ 更为/ 贴近/ 负载/ 曲线/ 的/ 构件/ 重构/ 方案/ ./ EMSA/ 算法/ 中/ ,/ 负载/ 预测/ 效果/ 决定/ 性能/ 曲线/ 是否/ 滞后/ 负载/ 曲线/ ,/ 若/ 预测/ 过程/ 花费/ 时间/ 过长/ 则/ 会/ 影响/ 遗传算法/ 输出/ 合适/ 的/ 构件/ 重构/ 方案/ ,/ 如图/ 中/ 250s/ 处/ ,/ 算法/ 给出/ 的/ 构件/ 重构/ 方案/ 并/ 不是/ 最优/ ./ 后续/ 研究/ 中/ 需要/ 对/ 遗传算法/ 的/ 迭代/ 次数/ 进行/ 调整/ ,/ 根据/ 构件/ 数目/ 和/ 性能/ 等级/ 的/ 多寡/ 快速/ 给出/ 构件/ 重构/ 方案/ ./ 当/ 负载/ 变化/ 剧烈/ 时/ ,/ EMSA/ 算法/ 虽然/ 比/ Ramirez09/ 算法/ 敏感度/ 高/ ,/ 但/ 还/ 存在/ 少部分/ 不/ 敏感/ 情况/ ,/ 如图/ 中/ 130s/ 处/ ./ 性能/ 曲线/ 变化/ 的/ 低/ 敏感度/ 会/ 导致/ 构件/ 重构/ 滞后/ 问题/ ,/ 高/ 敏感度/ 会/ 产生/ 重构/ 过于/ 频繁/ 从而/ 引发/ 重构/ 抖动/ 抵消/ 节能/ 效果/ ./ 后续/ 研究/ 中/ 需要/ 分析/ 负载/ 的/ 变化/ 程度/ 与/ 能耗/ 调整/ 算法/ 之间/ 的/ 关系/ ,/ 根据/ 不同/ 时间尺度/ 给出/ 能耗/ 调整/ 算法/ ./ 图/ 12/ 和/ 图/ 13/ 分别/ 根据/ 两种/ 算法/ 构件/ 配置/ 方案/ 给出/ 了/ 不同/ 构件/ 组合/ 下/ 的/ 能耗/ 调整/ 结果/ ./ 对比/ 图/ 12/ 和/ 图/ 13/ 可以/ 发现/ EMSA/ 算法/ 比/ Ramirez09/ 算法/ 节省/ 了/ 约/ 25/ %/ 的/ 能耗/ ,/ 原因/ 是/ EMSA/ 算法/ 能够/ 依据/ 可/ 重构/ 路由器/ 的/ 构件/ 化/ 体系结构/ 给出/ 更/ 贴近/ 业务/ 负载/ 变化/ 的/ 构件/ 重构/ 方案/ ./ Ramirez09/ 算法/ 之所以/ 发生/ 能耗/ 变化/ 是因为/ 算法/ 调用/ 了/ 不同/ 的/ 构件/ 配置/ 方案/ ,/ 并/ 没有/ 考虑/ 能耗/ 跟随/ 负载/ 变化/ ,/ EMSA/ 算法/ 比/ Ramirez09/ 算法/ 适用/ 于/ 网络/ 负载/ 变化/ 更/ 复杂/ 的/ 情况/ ,/ 从图/ 中/ 可以/ 发现/ ,/ 能耗/ 节省/ 效果/ 取决于/ 构件/ 能耗/ 等级/ 和/ 构件/ 重构/ 方案/ ,/ 如果/ 对/ 路由器/ 进行/ 更/ 细致/ 的/ 构件/ 划分/ 和/ 构件/ 能耗/ 分析/ ,/ 将会/ 取得/ 更/ 明显/ 的/ 节能/ 效果/ ./ 7/ 结束语/ 论文/ 从/ 路由器/ 体系结构/ 节能/ 出发/ ,/ 分析/ 了/ 以/ 构件/ 为/ 单位/ 的/ 能耗/ 细粒度/ 调整/ 问题/ ,/ 建立/ 了/ 构件/ 化/ 路由器/ 低能耗/ 分析模型/ ,/ 提出/ 了/ 能耗/ 细粒度/ 调整/ 方法/ ,/ 使用/ 布尔/ 二次/ 指数/ 平滑/ 法/ 预测/ 网络/ 负载/ 变化/ 和/ 遗传算法/ 并行/ 搜索/ 构件/ 配置/ 空间/ ,/ 达到/ 了/ 部件/ 能耗/ 跟随/ 业务/ 负载/ 变化/ 的/ 效果/ ./ 设置/ 了/ 三种/ 场景/ 对/ 论文/ 提出/ 的/ 负载/ 预测/ 算法/ 和/ 能耗/ 调整/ 算法/ 进行/ 仿真/ 实验/ ./ 结果表明/ 本文/ 提出/ 的/ 能耗/ 细粒度/ 调整/ 方法/ 比/ 传统/ 算法/ 可以/ 节省/ 60/ %/ 的/ 算法/ 运行/ 时间/ 和/ 25/ %/ 的/ 设备/ 能耗/ ./ 下/ 一步/ 计划/ ,/ 一方面/ ,/ 业务/ 的/ 时延/ 特性/ 对/ 有效/ 使用/ 能耗/ 细粒度/ 调整/ 方法/ 有/ 重要/ 影响/ ,/ 需要/ 研究/ 两者之间/ 的/ 约束/ 关系/ ;/ 另一方面/ ,/ 当/ 负载/ 变化/ 较/ 频繁/ 时/ ,/ 如何/ 优化/ 能耗/ 调整/ 方法/ 避免/ 构件/ 的/ 频繁/ 重构/ ,/ 使/ 构件/ 重构/ 开销/ 满足/ 性能/ 和/ 能耗/ 的/ 约束/ 是/ 未来/ 研究/ 的/ 重点/ ./ 

