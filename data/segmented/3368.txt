Page1/ 面向/ CC/ -/ NUMA/ 体系结构/ 的/ 事务/ 内存/ 冲突/ 规避/ 方法/ 王睿伯/ 卢锡城/ 卢凯/ 王绍/ 刚/ (/ 国防科技大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 摘要/ 现有/ 的/ 事务/ 内存/ 研究/ 主要/ 面向/ 多核/ 处理器/ 和/ SMP/ 机器/ ,/ 缺少/ 对/ CC/ -/ NUMA/ 系统/ 的/ 研究/ ./ 而/ CC/ -/ NUMA/ 是/ 高端/ 服务器/ 的/ 重要/ 体系结构/ ,/ 随着/ 用户/ 对/ 并行处理/ 能力/ 需求/ 的/ 不断/ 上升/ ,/ 高端/ 服务器/ 将/ 占据/ 越来越/ 重要/ 的/ 地位/ ./ 文中/ 概要/ 阐述/ 事务/ 内存/ 研究/ 的/ 基本/ 情况/ ,/ 通过/ 详尽/ 的/ 实验/ 数据/ ,/ 深入分析/ 了/ CC/ -/ NUMA/ 结构/ 的/ 本地/ 、/ 远程/ 访存/ 差异/ 特性/ 对/ 事务/ 内存/ 性能/ 的/ 影响/ ,/ 提出/ 了/ 一种/ 面向/ CC/ -/ NUMA/ 体系结构/ 的/ 冲突/ 规避/ 方法/ PBC/ ./ PBC/ 在/ 事务/ 启动/ 之前/ ,/ 对/ 冲突/ 可能性/ 进行/ 预测/ ,/ 并/ 根据/ 预测/ 结果/ 对/ 事务/ 进行/ 调度/ ,/ 以/ 降低/ 事务/ 的/ 失败率/ ./ 实验/ 表明/ ,/ 文中/ 提出/ 的/ PBC/ 方法/ 可以/ 显著/ 提高/ CC/ -/ NUMA/ 机器/ 上/ 运行/ 事务/ 内存/ 的/ 整体/ 性能/ ./ 关键词/ 事务/ 内存/ ;/ CC/ -/ NUMA/ ;/ 冲突/ 规避/ 1/ 引言/ 随着/ 多/ 核技术/ 的/ 普及/ ,/ 处理器/ 提供/ 了/ 充裕/ 的/ 硬件/ 并行/ 能力/ ,/ 而/ 与/ 之/ 形成/ 鲜明对比/ 的/ 是/ ,/ 现在/ 的/ 大多数/ 软件/ 还/ 不是/ 并行/ 的/ ./ 软件/ 的/ 并行/ 编程技术/ 一直/ “/ 曲高和寡/ ”/ ,/ 并行/ 编程/ 作为/ 高性能/ 计算/ 领域/ 常用/ 的/ 编程/ 模式/ ,/ 并/ 没有/ 普及/ 到/ 所有/ 的/ 编程人员/ ,/ 并且/ 一直/ 被/ 当做/ 是/ “/ 专家级/ ”/ 的/ 技术/ [/ 1/ -/ 2/ ]/ ./ 目前/ ,/ 并行/ 编程/ 中/ 关键/ 的/ 共享资源/ 同步/ 技术/ 仍然/ 在/ “/ 锁/ ”/ 机制/ 的/ 基础/ 上/ 实现/ [/ 3/ -/ 6/ ]/ ,/ 通过/ 对/ 共享/ 数据/ “/ 加锁/ ”/ 访问/ 来/ 保证/ 并行程序/ 执行/ 的/ 正确性/ ./ 事实上/ 如何/ 正确/ 地/ 使用/ 锁/ 是/ 一件/ 非/ Page2/ 常/ 困难/ 的/ 事/ ,/ 非常容易/ 造成/ 死锁/ [/ 7/ ]/ 等/ 问题/ ./ 在/ 应用/ 需求/ 的/ 驱动/ 下/ ,/ 学术界/ 已经/ 开始/ 进行/ 了/ 新/ 的/ 同步/ 模型/ 的/ 研究/ ,/ 其中/ 事务/ 内存/ 无疑/ 是/ 最/ 具有/ 吸引力/ 和/ 应用/ 前景/ 的/ 一项/ 新/ 技术/ ,/ 它/ 能够/ 有效/ 地/ 解决/ 并行/ 编程/ 当前/ 所/ 面临/ 的/ 难题/ ,/ 成为/ 近年来/ 的/ 研究/ 热点/ ,/ 也/ 是/ 并行/ 计算机/ 体系结构/ 的/ 前沿/ 研究课题/ 之一/ [/ 8/ -/ 11/ ]/ ./ 目前/ 的/ 事务/ 内存/ 主要/ 面向/ 单个/ 多核/ 处理器/ 以及/ SMP/ 机器/ ,/ 缺少/ 对/ NUMA/ 结构/ 的/ 关注/ ,/ 特别/ 是/ CC/ -/ NUMA/ (/ CacheCoherenceNon/ -/ UniformMemoryAccess/ )/ 结构/ ./ 而/ CC/ -/ NUMA/ 体系结构/ 是/ 当前/ 高性能/ 服务器/ 的/ 主流/ 体系结构/ ,/ 例如/ AMD/ 公司/ Opteron/ 系列/ 处理器/ 的/ HyperTransport/ 互联/ 技术/ ,/ 还有/ Intel/ 公司/ 最新/ 的/ 至/ 强/ 和/ 安腾/ 处理器/ 的/ QuickPath/ 互联/ 技术/ ./ NUMA/ 结构/ 的/ 特点/ ,/ 就是/ 每个/ 处理器/ 访问/ 本地/ 和/ 远程/ 内存/ 的/ 延迟/ 不同/ ,/ 访问/ 远程/ 内存/ 的/ 延迟/ 往往/ 是/ 本地/ 的/ 若干倍/ 或者/ 更/ 多/ ,/ 具体/ 差异/ 取决于/ 处理器/ 互联/ 的/ 层次/ 、/ 距离/ 以及/ 互联/ 接口/ 的/ 带宽/ 和/ 延迟/ ./ 本文/ 通过/ 实验/ ,/ 深入分析/ 了/ 现有/ 的/ 事务/ 内存/ 系统/ 在/ CC/ -/ NUMA/ 结构/ 机器/ 上/ 的/ 运行/ 情况/ ,/ 发现/ 随着/ 远程/ 内存/ 访问/ 延迟/ 的/ 增加/ ,/ 事务/ 之间/ 的/ 冲突/ 开始/ 增多/ ,/ 导致/ 事务/ 的/ 失败率/ 随之/ 增加/ ,/ 极大/ 地/ 影响/ 了/ 系统/ 性能/ ./ 由此/ ,/ 本文/ 提出/ 了/ 面向/ CC/ -/ NUMA/ 的/ 事务/ 冲突/ 规避/ 方法/ PBC/ ,/ 该/ 方法/ 在/ 事务/ 开始/ 之前/ ,/ 预测/ 该/ 事务/ 将来/ 发生冲突/ 的/ 可能性/ ,/ 根据/ 预测/ 结果/ 对/ 事务/ 进行/ 调度/ ./ 实验/ 证明/ ,/ 该/ 方法/ 在/ CC/ -/ NUMA/ 结构/ 机器/ 上/ 可以/ 有效/ 地/ 减少/ 事务/ 冲突/ ,/ 提高/ 事务/ 内存/ 系统/ 的/ 性能/ ./ 2/ 相关/ 研究/ 2.1/ 事务/ 内存/ 事务/ 的/ 概念/ 源自/ 于/ 数据库/ 管理系统/ ./ 在/ 数据库/ 管理系统/ 中/ ,/ 事务/ 必须/ 满足/ ACID/ 性质/ ,/ 即/ 原子/ 性/ 、/ 一致性/ 、/ 隔离/ 性/ 和/ 持久性/ ./ 用户/ 可以/ 使用/ 事务/ 来/ 包装/ 多个/ 数据库/ 操作/ ,/ 在/ 其他/ 用户/ 看来/ ,/ 事务/ 中/ 的/ 多个/ 数据库/ 操作/ 一次性/ 完成/ ,/ 事务/ 执行/ 过程/ 的/ 中间状态/ 对/ 其他/ 用户/ 不/ 可见/ [/ 12/ ]/ ./ 将/ 共享/ 数据/ 的/ 访问/ 对应/ 于/ 数据库/ 操作/ ,/ 事务/ 内存/ 系统/ 可以/ 对应/ 于/ 数据库/ 管理系统/ ,/ 用户/ 用/ 事务/ 来/ 包装/ 多个/ 共享/ 数据/ 的/ 访问/ ,/ 由/ 事务/ 内存/ 系统/ 来/ 保证/ 事务/ 特性/ ./ 在/ 采用/ 事务/ 内存/ 同步/ 方式/ 的/ 程序/ 中/ ,/ 一般/ 使用/ 关键词/ atomic/ 将/ 指令/ 序列/ 包装/ 成/ 事务/ ,/ 由/ 事务/ 内存/ 

