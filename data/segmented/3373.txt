Page1/ 扩展/ 因子/ 预/ 编码/ 的/ 两/ 阶段/ CORDIC/ 旋转/ 算法/ 2S/ -/ PCS/ 牟胜梅/ 1/ )/ 杨晓东/ 2/ )/ 1/ )/ (/ 海军工程大学/ 计算机/ 工程系/ 武汉/ 430033/ )/ 2/ )/ (/ 国防科技大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 摘要/ CORDIC/ 算法/ 常用/ 于/ 高效/ 地用/ 硬件/ 实现/ 向量/ 旋转/ 操作/ ,/ 如何/ 减少/ 迭代/ 次数/ 并/ 保持/ 扩展/ 因子/ 计算/ 与/ 补偿/ 的/ 简单/ 性是/ 算法/ 的/ 难点/ ./ 文中/ 提出/ 一种/ 表/ 驱动/ 的/ 2S/ -/ PCS/ 算法/ ,/ 其/ 流水线/ 较/ 短且/ 扩展/ 因子/ 可/ 预先/ 计算/ 并/ 优化/ 编码/ ./ 算法/ 首先/ 将/ [/ -/ π/ ,/ π/ ]/ 内/ 的/ 旋转/ 角/ 映射/ 到/ [/ 0/ ,/ π/ // 4/ ]/ 内/ ,/ 并/ 产生/ 初值/ 调整/ 和/ 旋转/ 方向/ 控制/ 信号/ ./ 之后/ 的/ 旋转/ 过程/ 分为/ 两/ 阶段/ ,/ 步/ 1/ 进行/ 扩展/ 因子/ 可变/ 的/ 大/ 角度/ 旋转/ ,/ 使/ 剩余/ 旋转/ 角/ 进入/ 步/ 2/ 的/ 收敛/ 域/ ./ 步/ 1/ 的/ 迭代/ 系数/ 和/ 扩展/ 因子/ 均/ 由/ 映射/ 后/ 旋转/ 角/ 的/ 高字段/ 作为/ 地址/ 查表/ 获得/ ./ 步/ 2/ 扩展/ 因子/ 恒为/ 1/ ,/ 迭代/ 系数/ 直接/ 由/ 旋转/ 角/ 的/ 二进制/ 编码/ 决定/ ./ 整个/ 过程/ 不需/ z/ 通道/ 和/ 扩展/ 因子/ 计算/ 通道/ ,/ 节省/ 了/ 面积/ 开销/ ./ 2S/ -/ PCS/ 利用/ 角度/ 分解/ 算法/ 生成/ 步/ 1/ 的/ 迭代/ 系数/ ,/ 约束/ 非零/ 系数/ 的/ 位置/ ,/ 并/ 对/ 扩展/ 因子/ 进行/ 基/ 4/ -/ Booth/ 编码/ ,/ 同时/ 合并/ 相邻/ 的/ 计算/ 量/ 小/ 的/ 迭代/ ,/ 以/ 减少/ 流水线/ 级数/ ./ 2S/ -/ PCS/ 算法/ 利用/ CSA/ 实现/ 三/ 数/ 累加/ ,/ 同时/ 忽略/ 超出/ 精度/ 表示/ 范围/ 的/ 表达式/ ,/ 以/ 减少/ 延迟/ 、/ 降低/ 复杂性/ ./ 短/ 流水线/ 还/ 可/ 减少/ 计算/ 通路/ 的/ 圆整/ (/ rounding/ )/ 误差/ ,/ 提高/ 精度/ ./ 2S/ -/ PCS/ 算法/ 克服/ 了/ 全字段/ 查表/ 可扩展性/ 差/ 的/ 问题/ ,/ 入口/ 数随/ 数据/ 精度/ 的/ 增加/ 而/ 缓慢/ 增长/ ,/ 可扩展性/ 好/ ./ 当/ 采用/ 28/ 位/ 数据通路/ 时/ ,/ 与/ 常规/ CORDIC/ 算法/ 相比/ ,/ 2S/ -/ PCS/ 算法/ 的/ 流水线/ 级数/ 减少/ 约/ 38/ %/ ,/ 面积/ 减少/ 约/ 27.9/ %/ ,/ 精度/ 提高/ 3/ 位/ 左右/ ,/ 具有/ 明显/ 的/ 性能/ 优势/ ./ 关键词/ 向量/ 旋转/ ;/ CORDIC/ 算法/ ;/ 查找/ 表/ ;/ 免/ 扩展/ ;/ 角度/ 重/ 编码/ 1/ 引言/ 向量/ 旋转/ 是/ 数字/ 信号处理/ 和/ 科学计算/ 等/ 领域/ 的/ 常用/ 操作/ ,/ CORDIC/ (/ COordinateRotationalDIgitalComputer/ )/ 算法/ [/ 1/ ]/ 因/ 计算/ 简单/ 、/ 结构/ 规整/ 而/ 被/ 用于/ 硬件/ 实现/ 向量/ 旋转/ ./ 向量/ 旋转/ 可/ 分为/ 两类/ ,/ 一类/ 是/ 旋转/ 角/ 取值/ 随机性/ 强/ 、/ 选取/ 范围/ 较广/ 且/ 不可/ 预知/ 的/ 情况/ ,/ 本文/ 称其为/ I/ 类/ 应用/ ;/ 另一类/ 是/ 旋转/ 角/ 数目/ 有限/ 且/ 可/ 预知/ 的/ 旋转/ 操作/ ,/ 称为/ II/ 类/ 应用/ ./ II/ 类/ 应用/ 算法/ 优化/ 空间/ 较大/ ,/ 可/ 利用/ 搜索算法/ [/ 2/ -/ 5/ ]/ 预先/ 计算/ 迭代/ 系数/ ,/ 求得/ 扩展/ 因子/ 并/ 对/ 其/ 进行/ 优化/ 编码/ ,/ 以较/ 少/ 的/ 迭代/ 次数/ 达到/ 精度/ 要求/ ./ 但/ 对于/ I/ 类/ 应用/ ,/ 较少/ 的/ 迭代/ 次数/ 与/ 简单/ 的/ 扩展/ 因子/ 计算/ 和/ 补偿/ 操作/ 相/ 矛盾/ ,/ 算法/ 较难/ 优化/ ./ 常规/ CORDIC/ 算法/ 的/ 旋转/ 因子/ 只/ 与/ 精度/ n/ 有关/ ,/ 易/ 计算/ 与/ 补偿/ ,/ 但/ 迭代/ 次数/ 较/ 多/ ,/ 计算/ 延迟/ 较大/ ./ 为/ 减少/ 迭代/ 次数/ ,/ 一些/ 优化/ 策略/ 被/ 采用/ ,/ 如/ 合并/ 两次/ 基本/ 旋转/ [/ 6/ ]/ ,/ 利用/ 冗余/ 算术/ 、/ 采用/ CSA/ (/ Carry/ -/ SaveAdder/ )/ 减少/ 加法/ 延迟/ [/ 7/ -/ 8/ ]/ ;/ 允许/ 迭代/ 系数/ 为/ 0/ ,/ 旁路/ 不必要/ 的/ 迭代/ ;/ 采用/ 高基/ CORDIC/ 算法/ [/ 7/ ]/ 等/ ./ 但/ 这些/ 算法/ 多以/ 增加/ 扩展/ 因子/ 的/ 计算/ 复杂性/ 为/ 代价/ ./ 例如/ :/ 允许/ 迭代/ 系数/ 取/ 0/ ,/ 使得/ 扩展/ 因子/ 不/ 固定/ ,/ 必须/ 伴随/ 旋转/ 操作/ 更新/ 扩展/ 因子/ ,/ 增加/ 了/ 计算/ 开销/ ./ 目前/ 面向/ I/ 类/ 应用/ 的/ 改进型/ 向量/ 旋转/ CORDIC/ 算法/ 大多/ 需/ 动态/ 计算/ 扩展/ 因子/ ,/ MVSF/ 算法/ [/ 9/ ]/ 虽/ 支持/ 固定/ 旋转/ 因子/ (/ ±/ 1/ 或/ ±/ 1/ // 槡/ 2/ )/ ,/ 但仅/ 适用/ 于/ 中/ 低/ 精度/ (/ 位/ 宽/ n/ / 17/ )/ ./ 随着/ n/ 的/ 增加/ ,/ 迭代/ 次数/ 呈/ 指数/ 规律/ 剧增/ ./ 文献/ [/ 13/ ]/ 采用/ 分段/ 符号/ 预测/ 加/ 校正/ 的/ 方式/ 提高/ 了/ 系统/ 的/ 并行性/ ,/ 但/ 计算/ 模式/ 不/ 规整/ ./ 本文/ 提出/ 的/ 2S/ -/ PCS/ 算法/ 面向/ I/ 类/ 应用/ ,/ 兼顾/ 了/ 迭代/ 次数/ 与/ 扩展/ 因子/ 的/ 计算/ 复杂性/ ./ 旋转/ 过程/ 分为/ 两个/ 阶段/ ,/ 通过/ 步/ 1/ 的/ 有限/ 几次/ 大/ 角度/ 旋转/ ,/ 使/ 剩余/ 旋转/ 角/ 进入/ 步/ 2/ 的/ 收敛/ 域/ ./ 步/ 1/ 利用/ 旋转/ 角/ 的/ 高位/ 进行/ 查表/ ,/ 获得/ 迭代/ 系数/ (/ 旋转/ 方向/ )/ 和/ 扩展/ 因子/ ./ 其/ 迭代/ 表达式/ 与/ 常规/ CORDIC/ 算法/ 相同/ ,/ 但/ 迭代/ 系数/ 可取/ {/ 0/ ,/ -/ 1/ ,/ 1/ }/ ,/ 以/ 旁路/ 不必要/ 的/ 旋转/ ./ 步/ 2/ 采用/ 扩展/ 因子/ 恒为/ 1/ 的/ 迭代/ 算法/ ,/ 且/ 直接/ 将/ 旋转/ 角/ 的/ 二进制/ 编码/ 作为/ 迭代/ 系数/ ./ 整个/ 过程/ 不需/ 扩展/ 因子/ 与/ 迭代/ 系数/ 计算/ 通路/ ./ 扩展/ 因子/ 采用/ 基/ 4/ -/ Booth/ 编码/ ,/ 每/ 两位/ 组成/ 的/ 位片/ 至多/ 含/ 一个/ 非/ 零位/ ,/ 以/ 减少/ 扩展/ 因子/ 补偿/ 操作/ 的/ 流水线/ 级数/ ./ 这些/ 方法/ 有效/ 地/ 减少/ 了/ 流水线/ 级数/ 、/ 计算/ 延迟/ 和/ 电路/ 的/ 面积/ 开销/ ./ 本文/ 第/ 2/ 节/ 介绍/ 常规/ CORDIC/ 算法/ ;/ 第/ 3/ 节/ 介绍/ SFCORDIC/ 算法/ 与/ Step2/ 的/ 实现/ ;/ 第/ 4/ 节/ 阐述/ Step1/ 的/ 实现/ 思路/ ,/ 包括/ 旋转/ 角/ 区间/ 压缩/ 、/ 角度/ 分解/ 以及/ 查找/ 表/ 的/ 生成/ ;/ 第/ 5/ 节/ 描述/ 算法/ 实现/ 电路/ 的/ 系统结构/ ;/ 第/ 6/ 节对/ 算法/ 性能/ 进行/ 模拟/ 与/ 分析/ ;/ 最后/ 一节/ 总结/ 全文/ ./ 2/ 常规/ CORDIC/ 算法/ CORDIC/ 是/ 一种/ 通用/ 迭代/ 算法/ ,/ 可/ 在/ 线性/ 、/ 圆/ 坐标/ 和/ 双曲/ 坐标/ 模式/ 下/ 进行/ 定向/ 与/ 旋转/ 操作/ ,/ 用于/ 各类/ 初等/ 函数/ 求值/ ./ 其中/ 向量/ 旋转/ 操作/ 应用/ 最为/ 广泛/ ./ CORDIC/ 算法/ 将/ 旋转/ 角/ 分解/ 为/ 若干/ 基本/ 旋转/ 角/ α/ (/ i/ )/ ,/ 每次/ 旋转/ 仅/ 由/ 移位/ 和/ 加法/ 操作/ 完成/ ./ 设/ 向量/ 犈/ (/ i/ )/ (/ x/ (/ i/ )/ ,/ y/ (/ i/ )/ )/ 逆时针/ 旋转/ 角度/ α/ (/ i/ )/ 得到/ 向量/ 犈/ (/ i/ +/ 1/ )/ (/ x/ (/ i/ +/ 1/ )/ ,/ y/ (/ i/ +/ 1/ )/ )/ ,/ 则/ 两/ 向量/ 的/ 端点/ 坐标/ 间/ 存在/ 如下/ 对应/ 关系/ x/ (/ i/ +/ 1/ )/ 烄/ y/ (/ i/ +/ 1/ 烆/ Page3/ 用/ 变量/ z/ 记录/ 向量/ 当前/ 位置/ 到/ 目标/ 位置/ 的/ 转角/ ,/ z/ (/ i/ +/ 1/ )/ =/ z/ (/ i/ )/ -/ α/ (/ i/ )/ (/ 逆时针/ 旋转/ 为/ 正/ )/ ,/ z/ (/ 0/ )/ 表示/ 初始/ 向量/ 到/ 目标/ 位置/ 的/ 转角/ ./ 经过/ 若干次/ 迭代/ ,/ 当/ z/ (/ i/ +/ 1/ )/ →/ 0/ 时/ ,/ 向量/ 便/ 旋转/ 到/ 目标/ 位置/ ./ 多数/ CORDIC/ 算法/ 在/ 迭代/ 过程/ 中/ 忽略/ cos/ α/ (/ i/ )/ 因子/ ,/ 令/ tan/ α/ (/ i/ )/ =/ di2/ -/ i/ (/ di/ ∈/ {/ -/ 1/ ,/ 1/ }/ )/ ,/ 利用/ 式/ (/ 1/ )/ 简化/ 迭代/ ,/ 故/ 迭代/ 结束/ 时/ 需/ 对/ 终值/ x/ (/ n/ )/ y/ (/ n/ (/ )/ )/ T/ 进行/ 校正/ ,/ xfy/ (/ )/ fT/ =/ Kx/ (/ n/ )/ y/ (/ n/ (/ )/ )/ T/ ./ 扩展/ 因子/ K/ =/ ∏/ icos/ α/ (/ i/ )/ =/ 1/ // ∏/ i/ 由于/ 扩展/ 因子/ 只/ 取决于/ 迭代/ 次数/ n/ (/ 数据表示/ 精度/ )/ ,/ 因此/ 不需/ 在/ 旋转/ 过程/ 中/ 临时/ 计算/ ./ 常规/ CORDIC/ 算法/ 的/ 收敛/ 域/ 约/ 为/ [/ -/ 99.88/ °/ ,/ 99.88/ °/ ]/ ./ 烄/ x/ (/ i/ +/ 1/ )/ y/ (/ i/ +/ 1/ 烆/ z/ (/ i/ +/ 1/ )/ =/ z/ (/ i/ )/ -/ α/ (/ i/ )/ =/ z/ (/ i/ )/ -/ ditan/ -/ 12/ -/ i/ ,/ di/ =/ sign/ (/ z/ (/ i/ )/ )/ =/ 1/ ,/ z/ (/ i/ )/ / 03SF/ 算法/ (/ Scaling/ -/ freeCORDIC/ )/ [/ 10/ ]/ 与/ 常规/ CORDIC/ 算法/ 不同/ ,/ SF/ 算法/ 取/ α/ (/ i/ )/ =/ 2/ -/ i/ ,/ 直接/ 将/ cos/ α/ (/ i/ )/ 和/ sin/ α/ (/ i/ )/ 表示/ 为/ 易于/ 迭代/ 的/ 形式/ ./ 因此/ ,/ 每次/ 迭代/ 过程/ 与/ 真正/ 的/ 旋转/ 操作/ 等价/ ,/ 向量/ 长度/ 不变/ ,/ 不需/ 进行/ 扩展/ 因子/ 补偿/ ./ 假设/ 变量/ x/ ,/ y/ 均/ 用/ m/ 位/ 补码/ 表示/ ,/ 角度/ z/ 含/ n/ 位/ 小数/ ,/ 则/ 受/ 操作数/ 表示/ 精度/ 限制/ ,/ 当/ α/ (/ i/ )/ -/ sin/ α/ (/ i/ )/ </ 2/ -/ n/ 时/ ,/ sin/ α/ (/ i/ )/ ≈/ α/ (/ i/ )/ =/ 2/ -/ i/ ,/ sin/ (/ α/ (/ i/ )/ // 2/ )/ ≈/ α/ (/ i/ )/ // 2/ =/ 2/ -/ (/ i/ +/ 1/ )/ ./ 故/ 利用/ 麦克劳/ 林/ (/ Maclaurin/ )/ 公式/ [/ 11/ ]/ 将/ sinx/ 展成/ 级数/ ,/ 利用/ 误差/ 项/ 表达式/ 可/ 求得/ 满足/ α/ (/ i/ )/ -/ sin/ α/ (/ i/ )/ </ 2/ -/ n/ 的/ i/ 值/ 下界/ (/ 非下/ 确界/ )/ :/ / (/ n/ -/ log62/ )/ // 3/ / ./ 实际/ 应用/ 中/ 可验证/ 是否/ 可取/ / (/ n/ -/ log62/ )/ // 3/ / ./ 为/ 简化/ 描述/ ,/ 记/ i/ 的/ 最小值/ 为/ t/ ./ 故/ 算法/ 迭代/ 范围/ 为/ t/ / i/ / n/ -/ 1/ ./ 图/ 1/ 显示/ 了/ n/ 与/ t/ 的/ 对应/ 关系/ ./ 本文/ 步/ 2/ 采用/ 单向/ 旋转/ ,/ di/ 的/ 符号/ 由步/ 1/ 的/ 余角/ / r/ 的/ 符号/ 位/ sr/ 与/ 控制/ 信号/ s1/ (/ 取决于/ 旋转/ 角/ 所在/ 区间/ ,/ 详见/ 第/ 4/ 节/ )/ 共同/ 决定/ ,/ 初始/ 旋转/ 角取/ z/ (/ 0/ )/ =/ |/ / r/ |/ ,/ 其/ 二进制/ 编码/ 决定/ 相应/ 的/ |/ di/ |/ ,/ z/ 通路/ 可省/ ./ 算法/ 迭代/ 公式/ 表示/ 如下/ 烎/ )/ =/ 1/ -/ di2/ -/ (/ 2i/ +/ 1/ )/ -/ di/ ·/ 2/ -/ ix/ (/ i/ +/ 1/ )/ 烄/ 烌/ y/ (/ i/ +/ 1/ 烆/ z/ (/ i/ +/ 1/ )/ =/ z/ (/ i/ )/ -/ di/ ·/ 2/ -/ i/ ,/ di/ ∈/ {/ 0/ ,/ S/ }/ ,/ S/ =/ 1/ ,/ s1/ / sr/ =/ 0/ 当/ 2i/ +/ 1/ / m/ ,/ 即/ i/ / (/ m/ -/ 1/ )/ // 2/ 时/ ,/ 2/ -/ (/ 2i/ +/ 1/ )/ 为/ 机器/ 0/ ,/ 上/ 式/ 可简化/ 为/ 与/ 常规/ CORDIC/ 算法/ 相同/ 的/ 迭代/ 表达式/ :/ 烄/ 烆/ SF/ 算法/ 的/ 收敛/ 域/ 较/ 小/ ,/ 仅为/ [/ -/ f/ (/ n/ )/ ,/ f/ (/ n/ )/ ]/ ,/ f/ (/ n/ )/ =/ ∑/ n/ -/ 1/ 整至/ SF/ 算法/ 收敛/ 域/ 内/ ./ MVSF/ 算法/ [/ 9/ ]/ 通过/ 重复/ 执行/ 多次/ i/ =/ t/ 的/ SF/ 迭代/ 实现/ 该/ 过程/ ,/ 但/ 随/ n/ 的/ 增加/ ,/ 迭代/ 次数/ 呈/ 指数/ 增加/ ./ 2S/ -/ PCS/ 算法/ 则/ 在/ 步/ 1/ 借助/ 查找/ 表/ 实现/ 扩展/ 因子/ 可变/ 的/ 旋转/ 操作/ ,/ 迅速/ 将/ 旋转/ 角/ 调整/ 至/ SF/ 算法/ 收敛/ 域/ 内/ ./ 4/ 迭代/ 系数/ 与/ 扩展/ 因子/ 预/ 编码/ 4.1/ 旋转/ 角/ 区间/ 压缩/ (/ rangereduction/ )/ 向量/ 旋转/ 算法/ 一般/ 需/ 处理/ 周期/ 为/ 2/ π/ 的/ 旋转/ 角/ ./ 若/ 使用/ 常规/ CORDIC/ 算法/ ,/ 需/ 增加/ 两次/ i/ =/ 0/ (/ π/ // 4/ )/ 的/ 旋转/ ,/ 才能/ 将/ 其/ 收敛/ 域/ 扩展/ 至/ [/ -/ π/ ,/ π/ ]/ ./ 2S/ -/ PCS/ 算法/ 为/ 减少/ 第一阶段/ 的/ 查找/ 表/ 入口/ 数/ ,/ 首先/ 通过/ 区间/ 压缩/ 将/ 初始/ 旋转/ 角/ θ/ ∈/ [/ -/ π/ ,/ π/ ]/ 映射/ 到/ [/ 0/ ,/ π/ // 4/ )/ 内/ ./ 图/ 2/ 将/ 旋转/ 角/ θ/ ∈/ [/ -/ π/ ,/ π/ ]/ 划分/ 为/ A0/ ,/ π/ [/ ]/ (/ )/ 4/ 、/ 4/ ,/ π/ [/ ]/ (/ )/ 2/ 、/ C/ π/ B/ π/ -/ 3/ π/ ]/ )/ 4/ 、/ F/ -/ 3/ π/ 4/ ,/ [/ ]/ (/ )/ 08/ 个/ 区间/ (/ 临界角/ 可/ 属于/ 两/ 区间/ 任/ H/ -/ π/ Page4/ 一/ )/ ,/ 利用/ 映射函数/ f/ 将/ θ/ 映射/ 至/ / ∈/ [/ 0/ ,/ π/ // 4/ ]/ ./ 记/ 初始/ 向量/ 为/ (/ x/ (/ 0/ )/ ,/ y/ (/ 0/ )/ )/ ,/ 旋转/ 角/ θ/ 位于/ 区间/ i/ (/ i/ ∈/ {/ A/ ,/ B/ ,/ C/ ,/ D/ ,/ E/ ,/ F/ ,/ G/ ,/ H/ }/ )/ 时/ 的/ 目标/ 向量/ 为/ (/ xi/ ,/ yi/ )/ ,/ 则/ xA/ 烌/ 烄/ =/ cos/ / -/ sin/ / y/ 烎/ A/ 烆/ =/ cos/ (/ -/ / )/ -/ sin/ (/ -/ / )/ xH/ 烌/ 烄/ y/ 烆/ 烎/ H/ =/ cos/ / sin/ / xB/ 烄/ 烌/ =/ y/ 烎/ B/ 烆/ =/ sin/ / -/ cos/ / xC/ 烌/ 烄/ =/ y/ 烎/ C/ 烆/ =/ -/ sin/ / -/ cos/ / =/ cos/ (/ π/ -/ / )/ -/ sin/ (/ π/ -/ / )/ xD/ 烌/ 烄/ y/ 烎/ D/ 烆/ =/ -/ cos/ / -/ sin/ / =/ cos/ (/ -/ π/ +/ / )/ -/ sin/ (/ -/ π/ +/ / )/ xE/ 烄/ 烌/ y/ 烆/ 烎/ E/ =/ -/ cos/ / sin/ / xF/ 烌/ 烄/ =/ y/ 烎/ F/ 烆/ =/ -/ sin/ / cos/ / xG/ 烌/ 烄/ =/ y/ 烎/ G/ 烆/ =/ sin/ / cos/ / 上述/ 各式/ 表明/ ,/ 旋转/ 角/ θ/ 位于/ 区间/ A/ 、/ C/ 、/ E/ 、/ G/ 时/ ,/ 实际/ 旋转/ 角取/ / ,/ 位于/ 区间/ B/ 、/ D/ 、/ F/ 、/ H/ 时/ ,/ 实际/ 旋转/ 角取/ -/ / ,/ x/ ,/ y/ 的/ 初始值/ 作/ 相应/ 的/ 交换/ 与/ 符号/ 变换/ ./ 因此/ ,/ 要/ 计算/ 旋转/ θ/ 后/ 的/ 目标/ 向量/ ,/ 需先/ 判断/ θ/ 所在/ 区间/ ,/ 产生/ 控制/ 信号/ s1s2s3s4/ 调整/ x/ ,/ y/ 的/ 初值/ ,/ 并/ 计算/ 映射/ 后/ 的/ / 值/ ./ s1/ =/ 1/ 则/ 旋转/ 角取/ -/ / ,/ 即/ 查表/ 所得/ 迭代/ 系数/ 取/ 相反数/ ;/ s2/ =/ 1/ 则/ x/ 取/ 相反数/ ,/ s3/ =/ 1/ 则/ y/ 取/ 相反数/ ,/ s4/ =/ 1/ 则/ 交换/ x/ ,/ y/ 值/ ./ θ/ 所在/ 区间/ 与/ 控制/ 信号/ 的/ 对应/ 关系/ 如表/ 1/ 所示/ ./ s2s3s4/ 既/ 可/ 用于/ 调整/ x/ ,/ y/ 的/ 初始值/ ,/ 也/ 可待步/ 1/ 与步/ 2/ 全部/ 结束/ 且/ 进行/ 扩展/ 因子/ 补偿/ 后/ 再/ 调整/ x/ ,/ y/ 的/ 终值/ ,/ 二者/ 等价/ ,/ 但/ 将/ s2s3s4/ 的/ 控制/ 作用/ 前移/ ,/ 可/ 省掉/ 寄存/ s2s3s4/ 信号/ 的/ 开销/ ./ 区间/ s1s2s3s4A0000B1011C0011D1110E0110F1101G0101H1000/ 初始/ 旋转/ 角/ 位于/ [/ -/ π/ ,/ π/ ]/ 时/ ,/ 区间/ 压缩/ 过程/ 需/ 3/ 次/ 减法/ 操作/ (/ 减数/ 为/ 常数/ )/ 和/ 若干次/ 符号/ 判断/ ,/ 比/ 初始/ 旋转/ 角/ 位于/ [/ 0/ ,/ 2/ π/ ]/ 时少用/ 一次/ 减法/ 操作/ ./ 区间/ 压缩/ 模块/ 的/ 结构/ 如图/ 3/ 所示/ ./ Page54/ ./ 2/ 角度/ 分解/ 算法/ CHAR/ 旋转/ 角/ 映射/ 到/ / ∈/ [/ 0/ ,/ π/ // 4/ ]/ 后/ ,/ 需/ 通过/ 若干次/ 迭代/ 将/ / 调整/ 至/ SF/ 算法/ 的/ 收敛/ 域/ 内/ ./ 2S/ -/ PCS/ 算法/ 预先/ 通过/ 角度/ 分解/ 求得/ 步/ 1/ 的/ 迭代/ 系数/ 及/ 剩余/ 角/ ,/ 保存/ 在/ 查找/ 表中/ ./ 角度/ 分解/ 属/ 搜索/ 带/ 约束/ 的/ 最优/ 组合/ 问题/ ,/ 贪婪/ 算法/ [/ 2/ ]/ 可/ 获得/ 局部/ 最优/ 组合/ ,/ 求得/ 的/ 系数/ 序列/ {/ di/ }/ 满足/ ∑/ n/ -/ 1/ 流水/ 实现/ 时/ 不能/ 有效/ 地/ 减少/ 流水线/ 级数/ ./ 本文/ 提出/ 一种/ 带/ 约束/ 的/ 高位/ 角度/ 分解/ 算法/ CHAR/ (/ Con/ -/ strainedHigh/ -/ bitsAngleRecodingAlgorithm/ )/ ,/ 将/ 迭代/ 系数/ 两/ 两/ 分组/ ,/ 每组/ 至多/ 含/ 一个/ 非零值/ ,/ 流水/ 实现/ 时/ 每级/ 处理/ 两个/ 系数/ ,/ 至多/ 进行/ 一次/ 迭代/ ./ 问题/ 描述/ 如下/ :/ 给定/ 用/ t/ 位/ 无/ 符号/ 定点/ 表示/ 的/ 旋转/ 角/ / H/ ∈/ [/ 0/ ,/ π/ // 4/ )/ 和/ 无穷/ 精度/ 的/ 基本/ 旋转/ 角/ {/ α/ (/ i/ )/ =/ atan2/ -/ i/ ,/ i/ =/ 0/ ,/ …/ ,/ t/ -/ 1/ }/ ,/ t/ / n/ ,/ 寻找/ 迭代/ 系数/ 序列/ {/ di/ ,/ i/ =/ 0/ ,/ …/ ,/ t/ -/ 1/ }/ ,/ di/ ∈/ {/ 0/ ,/ ±/ 1/ }/ ,/ 使得/ :/ (/ 1/ )/ / H/ =/ ∑/ t/ -/ 1/ 置/ 顺序/ 两/ 两/ 分组/ ,/ 每组/ 至多/ 含/ 一个/ 非零值/ (/ 若/ t/ 为/ 奇数/ ,/ 则/ 最后/ 一个/ 系数/ 单独/ 成组/ )/ ;/ (/ 3/ )/ |/ ε/ |/ 最小/ ./ 现/ 给出/ 一/ 满足/ 上述/ 条件/ (/ 1/ )/ 、/ (/ 2/ )/ 的/ 迭代/ 系数/ 构造/ 算法/ ,/ 但/ 求得/ 的/ 迭代/ 系数/ 未必/ 最优/ ,/ 即/ |/ ε/ |/ 未必/ 最小/ ./ t/ 较/ 小时/ 可/ 通过/ 穷举/ 搜索/ 确定/ 最优/ 解/ ,/ t/ 较大/ 时/ 利用/ CHAR/ 算法/ 求解/ ./ CHAR/ 算法/ ./ 初始值/ :/ / (/ 0/ )/ =/ / H/ ,/ {/ di/ =/ 0/ ,/ i/ =/ 0/ ,/ …/ ,/ t/ -/ 1/ }/ ;/ For/ (/ k/ =/ 0/ ;/ k/ / tIf/ |/ / (/ k/ )/ |/ </ α/ (/ t/ )/ break/ ;/ |/ / (/ k/ +/ 1/ )/ 2/ |/ =/ |/ |/ / (/ k/ )/ |/ -/ α/ (/ 2k/ )/ |/ ;/ |/ / (/ k/ +/ 1/ )/ 1/ |/ =/ |/ |/ / (/ k/ )/ |/ -/ α/ (/ 2k/ +/ 1/ )/ |/ ;/ |/ / (/ k/ +/ 1/ )/ |/ =/ min/ (/ |/ / (/ k/ +/ 1/ )/ 2/ |/ ,/ |/ / (/ k/ +/ 1/ )/ 1/ |/ ,/ |/ / (/ k/ )/ |/ )/ ;/ If/ |/ / (/ k/ +/ 1/ )/ |/ =/ |/ / (/ k/ +/ 1/ )/ 2/ |/ {/ Elseif/ |/ / (/ k/ +/ 1/ )/ |/ =/ |/ / (/ k/ +/ 1/ )/ 1/ |/ {/ else/ / (/ k/ +/ 1/ )/ =/ / (/ k/ )/ ;/ If/ (/ Odd/ (/ t/ )/ &&/ (/ |/ / (/ k/ )/ |/ / α/ (/ t/ )/ )/ )/ If/ / t/ -/ 1/ (/ )/ 2/ -/ α/ (/ t/ -/ 1/ )/ </ / t/ -/ 1/ (/ )/ 2/ {/ A2i/ +/ 1A2iA2i/ -/ 1A2i/ +/ 1A2i00000001010100101110100/ -/ 101010/ -/ 11100/ -/ 111100m/ =/ n/ 对于/ n/ 位/ 无/ 符号/ 表示/ 的/ 旋转/ 角/ / ∈/ [/ 0/ ,/ π/ // 4/ ]/ ,/ 其高/ t/ 位/ 便是/ / H/ ,/ 记/ / L/ =/ / -/ / H/ ,/ 则/ / L/ </ 2/ -/ t/ ./ 又/ 因/ CHAR/ 算法/ 满足/ |/ ε/ |/ </ α/ (/ t/ )/ </ 2/ -/ t/ ,/ 故/ |/ ε/ +/ / L/ |/ / |/ ε/ |/ +/ |/ / L/ |/ </ 2/ -/ (/ t/ -/ 1/ )/ ,/ 即/ |/ ε/ r/ |/ =/ / H/ -/ ∑/ t/ -/ 12/ -/ (/ t/ -/ 1/ )/ ,/ 已/ 进入/ SF/ 算法/ 的/ 收敛/ 域/ ./ 由于/ 搜索/ 只/ 需/ 针对/ t/ 位/ 表示/ 的/ / H/ 进行/ ,/ 每个/ 角度/ 需/ 3t/ 次/ 穷举/ 搜索/ ,/ 故高/ t/ 位/ 全局/ 最优/ 搜索算法/ 的/ 总开销/ 为/ (/ / 2t/ ×/ π/ // 4/ / +/ 1/ )/ ×/ 3t/ ,/ 而/ n/ 位/ 全局/ 最优/ 搜索算法/ 的/ 总开销/ 为/ (/ / 2n/ ×/ π/ // 4/ / +/ 1/ )/ ×/ 3t/ ,/ 前者/ 仅为/ 后者/ 的/ 2/ -/ (/ n/ -/ t/ )/ ./ 利用/ 搜索/ 得到/ 的/ 系数/ 组合/ 可/ 计算/ 扩展/ 因子/ K/ =/ 1/ ∏/ t/ -/ 1/ (/ 1/ +/ d2i2/ -/ 2i/ )/ 1/ // 2/ ,/ 并/ 对/ 其/ 进行/ 基/ 4/ -/ Booth/ 编码/ ,/ i/ =/ 0/ 转化/ 为/ SD/ (/ SignedDigit/ )/ 格式/ ,/ 每/ 2/ 位/ 组成/ 的/ 位片/ 至多/ 只含/ 一个/ 非零值/ ./ 表/ 2/ 列出/ 了/ 编码/ 前后/ 位片值/ 的/ 对应/ 关系/ ./ 4.3/ 查找/ 表步/ 1/ 的/ 查找/ 表/ 包含/ π/ 为/ T/ )/ ,/ 以/ 映射/ 后/ 旋转/ 角/ / 的/ 高/ t/ 位/ / H/ 作为/ 查表/ 地址/ ,/ 每个/ 表项/ 保存/ t/ 个/ SD/ 编码/ 的/ 迭代/ 系数/ 、/ m/ 位/ SD/ 编码/ 的/ 扩展/ 因子/ (/ 由基/ 4/ -/ Booth/ 编码/ 转化/ 而/ 得/ )/ 和/ n/ -/ t/ +/ 1/ 位/ 补码/ 表示/ 的/ ε/ =/ / H/ -/ ∑/ t/ -/ 1/ 数/ 需用/ 两位/ 表示/ ,/ 可用/ 两个/ 位串/ 组合/ 表示/ 迭代/ 系数/ 和/ 扩展/ 因子/ ,/ 每次/ 迭代/ 时/ 提取/ 两位/ 串中/ 的/ 相应/ 位进/ Page6/ 行/ 译码/ 即可/ ./ 因此/ 查找/ 表/ 的/ 总/ 存储/ 开销/ 为/ M/ =/ T/ (/ 2m/ +/ n/ +/ t/ +/ 1/ )/ 位/ ./ 步/ 1/ 的/ 剩余/ 旋转/ 角/ / r/ =/ / L/ +/ ε/ ./ 表/ 3/ 列举/ 了/ 数据表示/ 精度/ 与/ 存储量/ 开销/ 的/ 对应/ 关系/ ./ 5/ 系统结构/ 与/ 流水线/ 划分/ 2S/ -/ PCS/ 算法/ 实现/ 电路/ 的/ 流水线/ 级数/ 取决于/ n/ 以及/ 由/ n/ 决定/ 的/ t/ ./ 算法/ 的/ 硬件/ 实现/ 电路/ 大致/ 分为/ 区间/ 压缩/ 、/ 查表/ 、/ 步/ 1/ 、/ 步/ 2/ 和/ 扩展/ 因子/ 补偿/ 5/ 个/ 模块/ ,/ 步/ 2/ 又/ 根据/ i/ 的/ 取值/ 细分/ 为/ 两个/ 流水/ 组/ ./ 整条/ 流水线/ 被/ 划分/ 为/ 6/ 个/ 流水/ 组/ ,/ 每组/ 内/ 各级/ 流水线结构/ 相同/ ./ 模块/ 1/ :/ 区间/ 压缩/ ,/ 产生/ / 、/ s1/ ~/ s4/ ,/ 含/ 1/ 级/ 流水线/ ;/ 模块/ 2/ :/ 用/ / H/ 查表/ 获取/ {/ di/ }/ 、/ ε/ 和/ K/ ,/ 计算/ / r/ ,/ 并/ 模块/ 3/ (/ 步/ 1/ )/ :/ 用/ 系数/ {/ di/ }/ 控制/ 旋转/ ,/ 每级/ 处理/ 2/ 模块/ 4/ -/ 1/ (/ 步/ 2/ -/ phase1/ )/ :/ i/ </ (/ m/ -/ 1/ )/ // 2/ ,/ 用/ / r/ 控对/ x/ 、/ y/ 初值/ 进行/ 变换/ ,/ 含/ 1/ 级/ 流水线/ ;/ 数/ (/ 至多/ 1/ 个/ 非/ 零/ )/ ,/ 含/ / t/ // 2/ / 级/ 流水线/ ;/ 制/ 旋转/ ,/ 含/ m/ -/ 3/ 模块/ 4/ -/ 2/ (/ 步/ 2/ -/ phase2/ )/ :/ i/ / (/ m/ -/ 1/ )/ // 2/ ,/ 合并/ 相邻/ 的/ 两次/ 迭代/ ,/ 用/ / r/ 控制/ 旋转/ ,/ 含/ / (/ n/ +/ 1/ -/ / (/ m/ -/ 1/ )/ // 2/ / )/ // 2/ / 级/ 流水线/ ;/ 烌/ 烎/ 1/ 烌/ 烄/ di/ ·/ 2/ -/ i/ 烎/ 1/ 烆/ =/ 1/ -/ di/ ·/ di/ +/ 1/ ·/ 2/ -/ (/ 2i/ +/ 1/ )/ -/ di/ ·/ 2/ -/ i/ -/ di/ +/ 1/ ·/ 2/ -/ (/ i/ +/ 1/ )/ di/ ·/ 2/ -/ i/ +/ di/ +/ 1/ ·/ 2/ -/ (/ i/ +/ 1/ )/ 1/ -/ di/ ·/ di/ +/ 1/ ·/ 2/ -/ (/ 2i/ +/ 1/ 当/ i/ / (/ m/ -/ 1/ )/ // 2/ 时/ ,/ 2/ -/ (/ 2i/ +/ 1/ )/ =/ 0/ ,/ 故上式/ 可简化/ 为/ x/ (/ i/ +/ 2/ )/ 烌/ 烄/ 烎/ )/ =/ y/ (/ i/ +/ 2/ 烆/ 1/ -/ (/ 2di/ +/ di/ +/ 1/ )/ 2/ -/ (/ i/ +/ 1/ )/ 烄/ (/ 2di/ +/ di/ +/ 1/ )/ 2/ -/ (/ i/ +/ 1/ )/ 烆/ x/ 、/ y/ 通路/ 各/ 对应/ 3/ 个/ 加数/ ,/ 可/ 利用/ 一级/ CSA/ 和/ 一级/ 全加器/ 实现/ ,/ 比/ 常规/ CORDIC/ 的/ 两级/ 全加/ 延迟/ 减小/ 了/ 近一半/ ./ 扩展/ 因子/ 补偿/ 操作/ 对应/ 的/ 流水线/ 每级/ 处理/ 4/ 位/ ,/ 至多/ 含/ 2/ 个/ 非/ 零位/ ./ 这样/ 可/ 保证/ 整条/ 流水线/ 每级/ 至多/ 累加/ 3/ 个/ 操作数/ ./ 为/ 降低/ 复杂性/ ,/ 模块/ 3/ (/ 步/ 1/ )/ 每级/ 仅/ 处理/ 2/ 个/ 迭代/ 系数/ ,/ 而/ 未/ 将/ 相邻/ 的/ 两次/ 旋转/ 合并/ ./ 若/ 使/ 其/ 每级/ 处理/ 4/ 个/ 迭代/ 系数/ ,/ 则/ 控制/ 复杂/ ,/ 会/ 使步/ 1/ 成为/ 瓶颈/ ./ 模块/ 5/ :/ 扩展/ 因子/ 补偿/ ,/ 含/ / m/ // 4/ / 级/ 流水线/ ./ 扩展/ 因子/ 补偿/ 操作/ 既/ 可/ 针对/ 迭代/ 初值/ ,/ 也/ 可/ 针对/ 迭代/ 终值/ ,/ 前者/ 寄存/ / r/ 的/ 开销/ 较大/ ,/ 后者/ 寄存/ {/ di/ }/ 与/ K/ 的/ 开销/ 较大/ ,/ 二者/ 性能/ 相当/ ,/ 本文/ 将/ 扩展/ 因子/ 补偿/ 操作/ 置于/ 最后/ ./ 2S/ -/ PCS/ 算法/ 的/ 实现/ 流程/ 如图/ 4/ 所示/ ./ 步/ 2/ -/ phase2/ 每级/ 流水线/ 处理/ 2/ 个/ 迭代/ 系数/ ,/ 合并/ 相邻/ 的/ 两次/ 迭代/ ,/ 并/ 利用/ CSA/ 优化/ 累加/ 操作/ ./ 合并/ 后/ 迭代/ 表达式/ 如下/ x/ (/ i/ +/ 1/ )/ y/ (/ i/ +/ 1/ (/ )/ )/ 6/ 性能/ 分析/ 与/ 误差/ 模拟/ 2S/ -/ PCS/ 算法/ 步/ 1/ 通过/ 查表/ 获取/ 迭代/ 系数/ ,/ 步/ 2/ 则/ 直接/ 将/ 旋转/ 角/ 的/ 二进制/ 编码/ 作为/ 迭代/ 系数/ ,/ 故/ 整个/ 过程/ 不/ 需要/ z/ 通道/ ./ 对于/ I/ 类/ 应用/ ,/ 目前/ 可/ 省略/ z/ 通道/ 的/ 算法/ 只有/ MVSF/ 算法/ ,/ 但/ 其/ 迭代/ 次数/ 随/ 数据表示/ 精度/ 的/ 增加/ 呈/ 指数/ 增加/ ./ 当/ / 落/ 在/ SF/ 算法/ 收敛/ 域外/ 时/ ,/ MVSF/ 算法/ 约/ 需/ 增加/ / / ·/ 2t/ 角为/ 2/ -/ t/ 的/ 迭代/ ./ 以/ / =/ π/ // 8/ 为例/ ,/ 当/ n/ =/ 18/ 时/ ,/ / / ·/ 2t/ / =/ 25/ ;/ 当/ n/ =/ 21/ 时/ ,/ / / ·/ 2t/ / / ·/ 2t/ / =/ 402/ ./ 而/ 2S/ -/ PCS/ 算法/ 步/ 1/ 阶段/ 的/ 迭代/ 次数/ 仅为/ / t/ // 2/ / ,/ 可扩展性/ 好/ ./ 另外/ 2S/ -/ PCS/ 算法/ 通过/ 约束/ 步/ 1/ 非零/ 系数/ 的/ 位置/ 、/ 对/ 扩展/ 因子/ 进行/ 基/ 4/ -/ Booth/ 编码/ 、/ 合并/ 部分/ 相邻/ 的/ 运算/ 级/ 等/ 措施/ 减少/ 流水线/ 级数/ ./ 以/ m/ =/ n/ =/ 28/ 为/ Page7/ 例/ ,/ 常规/ CORDIC/ 算法/ 需/ 2/ +/ 28/ +/ 14/ =/ 44/ 级/ 流水线/ (/ 包含/ 为/ 扩展/ 收敛/ 域/ 而/ 增加/ 的/ 2/ 次/ π/ // 4/ 旋转/ ,/ 并/ 利用/ 基/ 4/ -/ Booth/ 编码/ 将/ 扩展/ 因子/ 补偿/ 操作/ 转化/ 为/ 14/ 级/ 加法/ 流水线/ )/ ,/ 每级/ 流水线/ 延迟/ 约/ 为/ 1/ 个/ 28/ 位/ 加法器/ 延迟/ ./ 而/ 2S/ -/ PCS/ 算法/ 仅/ 需/ 2/ +/ / t/ // 2/ / +/ m/ -/ 3t/ +/ 1/ +/ / (/ n/ +/ 1/ -/ / (/ m/ -/ 1/ )/ // 2/ / )/ // 2/ / +/ / m/ // 4/ / =/ 27/ 级/ 流水线/ ./ 整条/ 流水线/ 每级/ 至多/ 累加/ 3/ 个/ 操作数/ ,/ CSA/ 的/ 使用/ 使/ 每级/ 流水线/ 延迟/ 仅/ 略大于/ 常规/ CORDIC/ 算法/ ,/ 约/ 为/ 1/ 位/ 全加器/ 和/ 1/ 个/ m/ 位/ 加法器/ 延迟/ 之/ 和/ ,/ 再/ 加上/ 简单/ 的/ 判断/ 和/ 选择/ 逻辑/ 的/ 延迟/ ./ x/ 、/ y/ 通路/ 利用/ 固定/ 连线/ +/ 简单/ 的/ 选择/ 逻辑/ 实现/ 移位/ 功能/ ,/ 充分利用/ 了/ 零/ 迭代/ 系数/ ,/ 又/ 不/ 需/ 复杂/ 的/ 桶/ 式/ 移位/ 器/ (/ BarrelShift/ )/ ./ 这些/ 方法/ 使得/ 2S/ -/ PCS/ 算法/ 相对/ 于/ 其他/ 向量/ 旋转/ 算法/ 具有/ 明显/ 的/ 面积/ 优势/ ,/ 若用/ 加法器/ 来/ 衡量/ ,/ 则/ 2S/ -/ PCS/ 算法/ 所/ 需/ 加法器/ 数目/ 为/ :/ 3/ 个/ n/ +/ 3/ 位/ 常数/ 加法器/ ,/ 1/ 个/ n/ -/ t/ +/ 1/ 位/ 加法器/ ,/ S1/ 个/ m/ 位/ 加法器/ 和/ S2/ 个/ CSA/ (/ 1/ 位/ 全加器/ )/ ./ 其中/ S1/ =/ 2/ ×/ / t/ // 2/ / +/ 2/ ×/ m/ -/ 32/ ×/ / (/ n/ +/ 1/ -/ / (/ m/ -/ 1/ )/ // 2/ / )/ // 2/ / +/ 2/ ×/ / m/ // 4/ / ,/ S2/ =/ m/ ×/ m/ -/ 3/ / (/ n/ +/ 1/ -/ / (/ m/ -/ 1/ )/ // 2/ / )/ // 2/ / +/ / m/ // 4/ )/ / ./ 当/ m/ =/ n/ =/ 28/ 时/ ,/ 总/ 的/ 加法器/ 数目/ 约/ 为/ 54/ 个/ 28/ 位/ 加法器/ 和/ 588/ 个/ 1/ 位/ 加法器/ (/ 约合/ 21/ 个/ 28/ 位/ 加法器/ )/ ,/ 合/ 75/ 个/ 28/ 位/ 加法器/ ./ 而/ 常规/ CORDIC/ 算法/ 的/ 旋转/ 过程/ 需/ (/ 2/ +/ n/ )/ ×/ 3/ =/ 90/ (/ 含为/ 扩展/ 收敛/ 域/ 而/ 增加/ 的/ 2/ 次/ π/ // 4/ 旋转/ )/ 个/ m/ 位/ 加法器/ ,/ 扩展/ 因子/ 补偿/ 过程/ 需/ 2/ 个/ m/ 位/ 乘法器/ ,/ 若用/ 基/ 4/ -/ Booth/ 乘法器/ ,/ 需/ m/ // 2/ 个/ m/ 位/ 加法器/ ,/ 整个/ 常规/ CORDIC/ 算法/ 约/ 需/ 90/ +/ 14/ =/ 104/ 个/ 28/ 位/ 加法器/ ./ 故/ 2S/ -/ PCS/ 算法/ 可/ 节省/ 约/ 27.9/ %/ 的/ 面积/ 开销/ ./ 基于/ XilinxVirtex/ 系列/ FPGA/ 以全/ 流水/ 方式/ 分别/ 实现/ 了/ 传统/ CORDIC/ 旋转/ 算法/ 和/ 2S/ -/ PCS/ 算法/ ,/ 综合/ 后/ 发现/ :/ 利用/ IP/ 核/ 实现/ CORDIC/ 需/ 2160/ 个/ slice/ ,/ 而/ 2S/ -/ PCS/ 算法/ 仅/ 需/ 1611/ 个/ slice/ ,/ 二者/ 均/ 用/ 加法/ 代替/ 乘法/ 实现/ 扩展/ 因子/ 图/ 6m/ =/ n/ =/ 28/ (/ 26/ 位/ 小数/ )/ 时/ x/ 通路/ 的/ 误差/ 补偿/ ./ 由/ 理论/ 分析/ 可知/ ,/ 2S/ -/ PCS/ 算法/ 的/ 面积/ 优势/ 主要/ 得益于/ z/ 通路/ 的/ 省略/ 和/ 流水线/ 级数/ 的/ 压缩/ ./ 2S/ -/ PCS/ 算法/ 的/ 误差/ 主要/ 分为/ 角度/ 误差/ 和/ x/ 、/ y/ 通路/ 误差/ ./ 步/ 1/ 过程/ 的/ ε/ 因/ 超出/ 精度/ 表示/ 范围/ 而/ 产生/ 圆整/ 误差/ / r1/ ,/ / H/ 相同/ 的/ 角/ 对应/ 的/ / r1/ 相同/ ,/ 步/ 2/ 过程/ 不/ 产生/ 剩余/ 角/ 误差/ ./ 区间/ 压缩/ 过程/ 会/ 产生/ 圆整/ 误差/ / r0/ ,/ n/ =/ 28/ (/ 区间/ 压缩/ 前/ :/ 1/ 位/ 符号/ +/ 2/ 位/ 整数/ +/ 28/ 位/ 小数/ ,/ 区间/ 压缩/ 后/ :/ 28/ 位/ 无/ 符号/ 小数/ )/ 时/ 的/ 剩余/ 角/ 误差/ 分布/ 如图/ 5/ 所示/ ,/ 纵坐标/ B/ =/ / -/ log2/ (/ |/ / rr/ |/ )/ / ,/ / rr/ =/ / r0/ +/ / r1/ ./ 可见/ ,/ 区间/ 压缩/ 会/ 影响/ 剩余/ 角/ ,/ 但/ 不/ 总是/ 副作用/ ./ 当/ 输入/ 角/ θ/ ∈/ (/ -/ π/ // 4/ ,/ π/ // 4/ )/ 时/ ,/ / r0/ =/ 0/ ;/ |/ θ/ |/ ∈/ (/ π/ // 4/ ,/ π/ // 2/ )/ 时/ ,/ / r0/ 与/ / r1/ 同号/ 概率/ 较大/ ,/ 误差/ 增大/ ,/ 而/ |/ θ/ |/ ∈/ (/ π/ // 2/ ,/ π/ )/ 时/ ,/ / r0/ 与/ / r1/ 异号/ 概率/ 较大/ ,/ 误差/ 减小/ ./ x/ 、/ y/ 通路/ 的/ 误差/ 主要/ 由/ 剩余/ 角/ 和/ 计算/ 过程/ 的/ 圆整/ 操作/ 引起/ ./ m/ =/ n/ =/ 28/ 时/ ,/ 对/ 单位向量/ 的/ 旋转/ 进行/ 模拟/ ,/ 用/ 1/ 位/ 符号/ 位/ +/ 1/ 位/ 整数/ +/ 26/ 位/ 小数/ 表示/ x/ ,/ y/ ,/ 扩展/ 因子/ 也/ 用/ 1/ 位/ 符号/ (/ 扩展/ 因子/ 恒正/ ,/ 符号/ 位恒为/ 0/ ,/ 用/ 补码/ 表示/ 便于/ Booth/ 编码/ )/ +/ 1/ 位/ 整数/ +/ 26/ 位/ 小数/ 表示/ ./ 设/ 初始/ 向量/ 为/ (/ 1/ ,/ 0/ )/ ,/ 则/ x/ 通路/ 的/ 误差/ 曲线/ 如图/ 6/ 所示/ ./ 纵坐标/ 表示/ B/ =/ / -/ log2/ (/ |/ xf/ -/ xr/ |/ )/ / ,/ xf/ 为/ 计算/ 值/ ,/ xr/ 为/ 准确/ 值/ ./ 图/ 6/ (/ a/ )/ 对应/ t/ =/ / (/ 28/ -/ log62/ )/ // 3/ / =/ 9/ ,/ 图/ 6/ (/ b/ )/ 对应/ t/ =/ / (/ 28/ -/ log62/ )/ // 3/ / =/ 8/ ./ 图/ 7/ 为/ y/ 通路/ 误差/ ./ 通过/ 对比/ 可/ 发现/ ,/ t/ =/ 7/ 或/ 9/ 时/ 误差/ 分布/ 类似/ ,/ 最坏/ 情况/ 下/ 的/ 计算精度/ 均/ 可/ 达到/ 22/ 位/ ,/ 因此/ 实际/ 应用/ 中/ 可取/ t/ =/ / (/ n/ -/ log62/ )/ // 3/ / ,/ 以/ 减少/ 查找/ 表/ 的/ 入口/ 数/ 和/ 流水线/ 级数/ ./ Page8/ 图/ 7m/ =/ n/ =/ 28/ (/ 26/ 位/ 小数/ )/ 时/ y/ 通路/ 的/ 误差/ 实验/ 表明/ :/ 2S/ -/ PCS/ 算法/ 具有/ 较/ 高/ 的/ 计算精度/ ./ 常规/ CORDIC/ 算法/ 需/ 使用/ (/ n/ +/ log2n/ +/ 2/ )/ 位/ 数据通路/ [/ 12/ ]/ 才能/ 达到/ n/ 位/ 精度/ ,/ 用/ 28/ 位/ 数据通路/ ,/ 只能/ 达到/ 约/ 21/ 位/ 精度/ ,/ 去掉/ 小数点/ 前/ 两位/ ,/ 精度/ 只能/ 达到/ 小数点/ 后/ 19/ 位/ ,/ 比/ 2S/ -/ PCS/ 算法/ 的/ 精度/ (/ 22/ 位/ 小数/ )/ 低/ 3/ 位/ ./ 2S/ -/ PCS/ 算法/ 的/ 高精度/ 主要/ 得益于/ 短/ 流水线/ ,/ 且/ 利用/ CSA/ 将/ 3/ 个/ 加数/ 化为/ 2/ 个/ ,/ 每级/ 流水线/ 只/ 引发/ 一次/ 圆整/ 误差/ ./ 本例/ 中/ ,/ 整条/ 27/ 级/ 流水线/ 的/ 误差/ 限约/ 为/ 1/ 外/ ,/ di/ 为/ 0/ 的/ 级/ 不/ 存在/ 圆整/ 误差/ ,/ 故/ 2S/ -/ PCS/ 算法/ 的/ 平均/ 精度/ 要/ 比/ 最低/ 精度高/ 1/ ~/ 2/ 位/ ./ 7/ 总结/ 本文/ 提出/ 一种/ 新/ 的/ CORDIC/ 算法/ 和/ 体系结构/ ,/ 减少/ 迭代/ 次数/ 的/ 同时/ 保持/ 了/ 常规/ CORDIC/ 算法/ 扩展/ 因子/ 易/ 计算/ 与/ 补偿/ 的/ 特点/ ,/ 实现/ 了/ 旋转/ 角/ 位于/ [/ -/ π/ ,/ π/ ]/ 的/ 向量/ 旋转/ 操作/ ./ 2S/ -/ PCS/ 算法/ 根据/ 数据通路/ x/ ,/ y/ 以及/ 旋转/ 角/ / 的/ 表示/ 精度/ 确定/ 流水线/ 级数/ 和/ 组织/ 方式/ ./ 步/ 1/ 的/ 迭代/ 系数/ 和/ 扩展/ 因子/ 由/ 查表/ 获得/ ,/ 步/ 2/ 迭代/ 系数/ 直接/ 取/ 目标/ 转角/ 的/ 二进制/ 编码/ ,/ 扩展/ 因子/ 恒为/ 1/ ,/ 因此/ 整个/ 旋转/ 过程/ 不需/ z/ 通路/ 和/ 扩展/ 因子/ 计算/ 通路/ ,/ 大大/ 减小/ 了/ 电路/ 的/ 面积/ 开销/ ./ 通过/ 带/ 约束/ 的/ 角度/ 分解/ 算法/ 、/ 基/ 4/ -/ Booth/ 编码/ 和/ 迭代/ 合并/ 等/ 措施/ ,/ 有效/ 减少/ 了/ 流水线/ 级数/ ./ 2S/ -/ PCS/ 算法/ 在/ 迭代/ 过程/ 中/ 对/ 超出/ 计算精度/ 的/ 表达式/ 预先/ 进行/ 化简/ ,/ 并/ 采用/ CSA/ 累加/ 多个/ 操作数/ ,/ 有效/ 地/ 减少/ 了/ 流水线/ 延迟/ ./ 算法/ 克服/ 了/ 传统/ 全字段/ 查表/ 法/ 可扩展性/ 差/ 的/ 问题/ ,/ 随着/ 数据表示/ 精度/ 的/ 增加/ ,/ 查找/ 表/ 入口/ 数/ 增加/ 缓慢/ ,/ 可扩展性/ 好/ ./ 理论/ 分析/ 与/ 误差/ 模拟/ 表明/ ,/ 2S/ -/ PCS/ 算法/ 在/ 保持/ 高精度/ 的/ 同时/ 具有/ 明显/ 的/ 面积/ 和/ 延时/ 优势/ ,/ 实用性/ 强/ ./ 采用/ 28/ 位/ 数据通路/ 时/ ,/ 与/ 常规/ CORDIC/ 算法/ 相比/ ,/ 2S/ -/ PCS/ 算法/ 的/ 流水线/ 级数/ 减少/ 约/ 38/ %/ ,/ 面积/ 减少/ 约/ 27.9/ %/ ,/ 精度/ 提高/ 3/ 位/ 左右/ ,/ 显示/ 了/ 算法/ 的/ 优良/ 性能/ ./ 

