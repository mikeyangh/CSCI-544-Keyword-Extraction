Page1/ 基于/ 单/ 断言/ 的/ 安全/ 的/ 密文/ 区间/ 检索/ 蔡克/ 张敏/ 冯登国/ (/ 中国科学院/ 软件/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 为/ 解决/ 数据/ 外包/ 所/ 带来/ 的/ 敏感数据/ 的/ 数据安全/ 问题/ ,/ 数据/ 所有者/ 更多地/ 选择/ 外/ 包/ 敏感数据/ 的/ 密文/ ./ 而外/ 包/ 密文/ 的/ 形式/ ,/ 为/ 数据/ 所有者/ 对/ 这些/ 数据/ 的/ 使用/ 带来/ 了/ 不便/ ,/ 如/ 数据/ 所有者/ 无法/ 对/ 密文/ 数据/ 进行/ 区间/ 检索/ 等/ ./ 目前/ 的/ 密文/ 区间/ 检索/ 方案/ 中/ ,/ 为/ 实现/ 密文/ 的/ 区间/ 检索/ ,/ 服务器/ 需要/ 对/ 区间/ 索引/ 进行/ 多次/ 断言/ ./ 而/ 断言/ 次数/ 越/ 多/ ,/ 向/ 服务器/ 泄露/ 的/ 信息/ 也/ 越/ 多/ ./ 文中/ 提出/ 采用/ 单/ 断言/ 实现/ 敏感数据/ 的/ 区间/ 判断/ ,/ 同时/ 使用/ 可逆/ 矩阵/ 对/ 区间/ 索引/ 和/ 区间/ 陷门/ 进行/ 安全/ 保护/ ,/ 不仅/ 减少/ 了/ 整个/ 方案/ 的/ 信息/ 泄露/ ,/ 而且/ 保证/ 了/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全/ ./ 文中/ 对/ 方案/ 复杂性/ 进行/ 了/ 分析/ ./ 该/ 方案/ 在/ 安全性/ 方面/ 的/ 提升/ 并/ 不以/ 效率/ 损失/ 为/ 代价/ ./ 关键词/ 密文/ 检索/ ;/ 区间/ 检索/ ;/ 区间/ 索引/ ;/ 区间/ 陷门/ 1/ 引言/ 存储/ (/ CloudStorage/ )/ 是/ 当前/ 的/ 两个/ 主流/ 数据管理/ 形式/ ./ 由于/ 数据/ 的/ 外包/ 将/ 数据/ 完全/ 暴露/ 给/ 半/ 可信/ 的/ 服务提供商/ ,/ 使得/ 数据/ 脱离/ 了/ 数据/ 所有者/ 的/ 掌控/ ,/ 数据/ 隐私/ 存在/ 着/ 被/ 泄露/ 的/ 可能/ ./ Google/ 、/ Salesforce/ 等/ 外包/ 数据库/ (/ OutsourcedDatabase/ ,/ ODB/ )/ 和/ 云/ Page2/ 公司/ 均/ 发生/ 过云/ 存储/ 泄密/ 事件/ ./ 为/ 保护/ 敏感数据/ ,/ 数据/ 所有者/ 期望/ 在/ 对/ 敏感数据/ 加密/ 后外/ 包/ 存储/ ,/ 使得/ 暴露/ 给/ 服务提供商/ 的/ 是/ 密文/ 形式/ 的/ 数据/ [/ 1/ ]/ ./ 外包/ 数据/ 的/ 密文/ 存储/ ,/ 为/ 数据/ 使用/ 带来/ 了/ 诸多不便/ ,/ 如/ 无法/ 对/ 敏感数据/ 密文/ 进行/ 区间/ 检索/ ./ 通常/ 采用/ 通用/ 的/ 加密算法/ 对/ 敏感数据/ 进行/ 加密/ 保护/ ./ 我们/ 假设/ 加密算法/ 是/ 安全/ 的/ ./ 服务器/ 在/ 不/ 了解/ 密钥/ 的/ 情况/ 下/ ,/ 无法/ 直接/ 对/ 密文/ 进行/ 区间/ 检索/ ./ 如果/ 数据/ 所有者/ 想要/ 获得/ 属于/ 指定/ 区间/ 的/ 数据/ ,/ 其/ 必须/ 向/ 服务器/ 请求/ 全部/ 敏感数据/ ,/ 在/ 本地/ 解密/ 后/ 再/ 进行/ 区间/ 检索/ ./ 整个/ 过程/ 需要/ 服务器返回/ 大量/ 冗余/ 数据/ ,/ 占用/ 了/ 大量/ 网络带宽/ 和/ 客户端/ 计算资源/ ,/ 这/ 并非/ 是/ 有效/ 的/ 解决方案/ ./ 鉴于/ 直接/ 对/ 密文/ 进行/ 区间/ 检索/ 比较/ 困难/ ,/ 目前/ 普遍/ 采用/ 为/ 敏感数据/ 构建/ 区间/ 索引/ 的/ 方法/ 实现/ 区间/ 检索/ ./ 区间/ 索引/ 基于/ 敏感数据/ 明文/ 构建/ ,/ 在/ 一定/ 程度/ 上/ 包含/ 了/ 敏感数据/ 的/ 相关/ 信息/ ./ 如果/ 区间/ 索引/ 不/ 安全/ ,/ 那么/ 区间/ 索引/ 的/ 外包/ ,/ 大大/ 增大/ 了/ 服务器/ 破解/ 敏感数据/ 的/ 概率/ ./ 在/ 对/ 数据安全/ 要求/ 比较/ 高/ 的/ 场景/ 下/ ,/ 不仅/ 需要/ 敏感数据/ 可用/ ,/ 同时/ 还要/ 考虑/ 其/ 安全/ ./ 应该/ 在/ 保证/ 安全性/ 的/ 前提/ 下/ 提升/ 敏感数据/ 的/ 可用性/ ./ 在/ 客户端/ 进行/ 区间/ 检索/ 的/ 解决方案/ [/ 2/ ]/ 不/ 符合/ 数据/ 外/ 包/ 应用/ 场景/ 的/ 要求/ ,/ 不/ 在/ 本文/ 考虑/ 范围/ 之内/ ./ 早期/ 对/ 密文/ 区间/ 检索/ 的/ 研究/ 主要/ 集中/ 于/ 保证/ 敏感数据/ 的/ 可用性/ ./ 最/ 简单/ 的/ 是/ 直接/ 应用/ 保序/ 加密算法/ [/ 3/ -/ 4/ ]/ ./ 区间/ 索引/ 继承/ 了/ 敏感数据/ 的/ 大小/ 排列/ 性质/ ,/ 服务器/ 可以/ 直接/ 基于/ 密文/ 进行/ 大小/ 比较/ ,/ 从而/ 获得/ 检索/ 结果/ ./ 该类/ 方案/ 使得/ 敏感数据/ 的/ 大小/ 信息/ 完全/ 暴露/ 给/ 服务器/ ,/ 安全性/ 方面/ 的/ 牺牲/ 比较/ 大/ ./ Hacig/ ü/ m/ ü/ 等/ 人/ 提出/ 通过/ 对/ 敏感数据/ 进行/ 分桶/ [/ 5/ -/ 8/ ]/ 的/ 方式/ 实现/ 密文/ 区间/ 检索/ ,/ 各/ 区间/ 索引/ 组成/ 了/ 对/ 敏感数据/ 的/ 一次/ 划分/ ./ 这个/ 方案/ 中/ ,/ 服务器/ 可以/ 直接/ 获得/ 敏感数据/ 的/ 归并/ 特征/ ,/ 即/ 多个/ 敏感数据/ 对应/ 同一个/ 区间/ 索引/ ./ 归并/ 特征/ 数量/ 少/ 的/ 特点/ ,/ 使得/ 破解/ 难度/ 很/ 低/ ./ 而且/ 归并/ 特征/ 的/ 破解/ 对/ 获得/ 敏感数据/ 的/ 分布/ 规律/ 非常/ 有利/ ./ 后来/ ,/ 有/ 学者/ 注意/ 到/ 了/ 密文/ 区间/ 检索/ 方案/ 在/ 安全性/ 方面/ 的/ 缺陷/ ,/ 提出/ 了/ 通过/ 编码/ [/ 9/ ]/ 的/ 方式/ 来/ 实现/ 密文/ 区间/ 检索/ ./ 该/ 方案/ 通过/ 对/ 敏感数据/ 进行/ 前缀/ 保序/ 编码/ 获得/ 区间/ 索引/ ,/ 使用/ 前缀/ 匹配/ 获得/ 区间/ 检索/ 结果/ ./ 安全性/ 有所/ 提升/ ,/ 但是/ 在/ 获知/ 多个/ 区间/ 陷门/ 的/ 情况/ 下/ ,/ 服务器/ 可以/ 获得/ 敏感数据/ 的/ 排列/ 信息/ [/ 9/ ]/ ./ 现有/ 方案/ 中/ ,/ 要/ 实现/ 密文/ 区间/ 检索/ ,/ 服务器/ 均/ 需要/ 对/ 区间/ 索引/ 进行/ 多次/ 断言/ ./ 每次/ 断言/ 都/ 意味着/ 服务器/ 要/ 进行/ 一次/ 判断/ ,/ 如/ 等值/ 匹配/ 判断/ 或/ 大小/ 比较/ 判断/ 等/ ./ 任何/ 一次/ 断言/ 都/ 会/ 向/ 服务器/ 泄露/ 敏感数据/ 的/ 相关/ 信息/ ,/ 如分桶/ [/ 1/ -/ 3/ ]/ 的/ 方案/ 中/ ,/ 检索/ 区间/ 涵盖/ 多个/ 分桶/ ,/ 检索/ 时/ 需要/ 将/ 区间/ 索引/ 与/ 区间/ 陷门/ 的/ 每个/ 值/ 进行/ 一次/ 断言/ ,/ 泄露/ 了/ 敏感数据/ 属于/ 其中/ 某个/ 分桶/ 的/ 信息/ ,/ 而/ 不是/ 只/ 泄露/ 敏感数据/ 是否/ 属于/ 检索/ 区间/ 的/ 信息/ ./ 所以/ 断言/ 次数/ 越/ 多/ ,/ 检索/ 过程/ 向/ 服务器/ 泄露/ 的/ 信息/ 也/ 就/ 越/ 多/ ,/ 泄露/ 信息/ 的/ 增多/ ,/ 增大/ 了/ 密文/ 区间/ 检索/ 方案/ 的/ 安全隐患/ ./ 本文/ 针对/ 上述/ 的/ 问题/ ,/ 第一个/ 提出/ 基于/ 单/ 断言/ 来/ 实现/ 密文/ 的/ 区间/ 检索/ ,/ 即/ 服务器/ 只/ 需要/ 对/ 区间/ 索引/ 进行/ 一次/ 断言/ ,/ 就/ 可以/ 获知/ 敏感数据/ 是否/ 属于/ 该/ 检索/ 区间/ ./ 这/ 在/ 一定/ 程度/ 上/ 减少/ 了/ 区间/ 检索/ 过程/ 中/ 的/ 信息/ 泄露/ ,/ 使得/ 密文/ 区间/ 检索/ 方案/ 的/ 安全性/ 得到/ 了/ 一定/ 程度/ 的/ 保障/ ./ 对于/ 必须/ 提供/ 给/ 服务器/ 的/ 信息/ ,/ 比如/ 区间/ 索引/ 和/ 区间/ 陷门/ ,/ 方案/ 对/ 这些/ 信息/ 进行/ 了/ 相应/ 的/ 保护/ 处理/ ./ 该/ 方案/ 中/ ,/ 敏感数据/ 的/ 排列/ 信息/ 和/ 敏感数据/ 的/ 归并/ 信息/ 不会/ 被/ 泄露/ ,/ 与/ 现有/ 方案/ 相比/ ,/ 它/ 在/ 不/ 影响/ 敏感数据/ 可用性/ 的/ 情况/ 下/ ,/ 获得/ 了/ 更/ 高/ 的/ 安全性/ ./ 本文/ 在/ 第/ 2/ 节中/ 对/ 方案/ 的/ 安全/ 模型/ 进行/ 假设/ ,/ 同时/ 针对/ 密文/ 区间/ 检索/ 的/ 特征/ ,/ 给出/ 了/ 相关/ 的/ 安全性/ 描述/ 的/ 定义/ ;/ 第/ 3/ 节/ 分析/ 方案/ 的/ 基本/ 框架/ ,/ 并/ 描述/ 了/ 区间/ 检索/ 方案/ 中/ 涉及/ 的/ 一些/ 方法/ ;/ 第/ 4/ 节对本/ 方案/ 中/ 的/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全性/ 进行/ 分析/ ;/ 第/ 5/ 节对本/ 方案/ 的/ 时间/ 和/ 空间/ 复杂性/ 进行/ 分析/ ,/ 并/ 与/ 现有/ 方案/ 进行/ 比较/ ;/ 第/ 6/ 节/ 总结/ 全文/ 并/ 给出/ 对/ 后续/ 工作/ 的/ 展望/ ./ 2/ 相关/ 知识/ 2.1/ 应用/ 场景/ 假设/ 本文/ 考虑/ 的/ 应用/ 场景/ 包含/ 如下/ 两种/ 角色/ :/ 数据/ 所有者/ (/ DataOwner/ ,/ DO/ )/ 和/ 服务提供商/ (/ ServiceProvider/ ,/ SP/ )/ ./ 如图/ 1/ 所示/ ,/ 其中/ DO/ 是/ 敏感数据/ 的/ 拥有者/ ,/ 该/ 角色/ 不/ 具备/ 强大/ 的/ 数据/ 存储/ 和/ 管理/ 能力/ ./ 为/ 获得/ 针对/ 敏感数据/ 密文/ 的/ 区间/ 检索/ 能力/ ,/ 该/ 角色/ 在/ 将/ 密文/ 数据/ 外包/ 的/ 同时/ ,/ 为/ 敏感数据/ 构建/ 了/ 区间/ 索引/ 并/ 进行/ 上传/ ./ SP/ 是/ 服务提供商/ ,/ 具有/ 强大/ 的/ 存储/ 和/ 计算能力/ ./ 对于/ DO/ 发起/ 的/ 区间/ 检索/ 请求/ ,/ SP/ 承担/ 大量/ 的/ 处理/ 任务/ ,/ 并/ 向/ DO/ 返回/ 检索/ 结果/ ./ SP/ 是/ 半/ 可信/ 的/ ,/ 即/ SP/ 会/ 忠实/ 地/ 执行/ DO/ 提交/ Page3/ 的/ 区间/ 检索/ 请求/ ,/ 并/ 返回/ 根据/ 检索/ 请求/ 得到/ 的/ 检索/ 结果/ ./ 但是/ SP/ 对/ 敏感数据/ 比较/ 好奇/ ,/ 可能/ 会/ 利用/ 所/ 掌握/ 的/ 一切/ 信息/ (/ 如/ 敏感数据/ 的/ 区间/ 索引/ 和/ 区间/ 陷门/ 等/ )/ 来/ 进行/ 分析/ ,/ 期望/ 获得/ 真实/ 的/ 敏感数据/ ./ 当前/ 我们/ 主要/ 考虑/ 唯/ 密文/ 模型/ ,/ 即/ SP/ 只/ 了解/ 存放/ 在/ SP/ 的/ 敏感数据/ 的/ 区间/ 索引/ 以及/ DO/ 进行/ 区间/ 检索/ 时/ 提供/ 的/ 区间/ 陷门/ 信息/ ./ SP/ 事先/ 并/ 不/ 了解/ 敏感数据/ 的/ 值域/ 、/ 分布/ 情况/ 、/ 敏感数据/ 与/ 索引/ 的/ 对应/ 关系/ 等/ 信息/ ./ 所以/ ,/ 本文/ 需要/ 考虑/ 唯/ 密文/ 模型/ 下/ 的/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全性/ ./ 2.2/ 安全性/ 定义/ 我们/ 主要/ 研究/ 唯/ 密文/ 模型/ 下/ 的/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全/ ./ 现有/ 研究/ 中/ 涉及/ 索引/ 和/ 陷门/ 安全/ 的/ 概念/ 主要/ 有/ :/ 索引/ 安全/ 、/ 陷门/ 安全/ 和/ 关键词/ 安全/ [/ 10/ -/ 11/ ]/ ./ 索引/ 安全/ 是/ 在/ 密文/ 文档/ 的/ 关键词/ 检索/ 中/ 提出/ 的/ ,/ 考虑/ 的/ 是/ 关键词/ 索引/ 是否/ 会/ 泄露/ 关键词/ 与/ 加密/ 文档/ 之间/ 的/ 对应/ 关系/ ;/ 关键词/ 安全/ 考虑/ 的/ 是/ 检索/ 关键词/ ,/ 要求/ 检索/ 陷门/ 不能/ 泄露/ 检索/ 关键词/ ;/ 而/ 陷门/ 安全/ 要求/ 敌手/ 无法/ 根据/ 已知/ 的/ 陷门/ 生成/ 未知/ 的/ 有效/ 陷门/ ./ 上述/ 概念/ 都/ 是/ 针对/ 密文/ 检索/ 领域/ 的/ 关键词/ 检索/ 提出/ 的/ ,/ 比较/ 适合/ 于/ 用于/ 描述/ 关键词/ 检索/ 中/ 的/ 索引/ 和/ 陷门/ 的/ 安全/ ./ 由于/ 这些/ 概念/ 不能/ 完全/ 覆盖/ 常见/ 的/ 区间/ 检索/ 中/ 的/ 安全隐患/ ,/ 所以/ 这些/ 概念/ 在/ 区间/ 检索/ 领域/ 的/ 使用/ 具有/ 一定/ 的/ 局限性/ ./ 密文/ 区间/ 检索/ 拥有/ 下述/ 特征/ ./ 一方面/ 区间/ 检索/ 不再/ 是/ 简单/ 的/ 单值/ 匹配/ ,/ 需要/ 考虑/ 区间/ 陷门/ 是否/ 会/ 泄露/ 检索/ 区间/ 上/ 下界/ 的/ 信息/ ,/ 以及/ 是否/ 会/ 泄露/ 检索/ 区间/ 的/ 归并/ 特征/ ;/ 另一方面/ ,/ 敏感数据/ 之间/ 还/ 附带/ 了/ 具有/ 某种/ 实际意义/ 的/ 大小/ 关系/ ,/ 使得/ 返回/ 的/ 检索/ 结果/ 不再/ 只/ 包含/ 单值/ 敏感数据/ ./ 所以/ 我们/ 不仅/ 需要/ 考虑/ 区间/ 索引/ 是否/ 会/ 泄露/ 敏感数据/ 的/ 排列/ 信息/ ,/ 而且/ 需要/ 考虑/ 在/ 检索/ 过程/ 是否/ 会/ 泄露/ 检索/ 结果/ 中/ 各个/ 敏感数据/ 的/ 排列/ 信息/ ./ 本文/ 针对/ 密文/ 区间/ 检索/ 的/ 独特/ 安全隐患/ ,/ 提出/ 了/ 相关/ 的/ 安全性/ 描述/ ./ 它/ 主要/ 分/ 区间/ 索引/ 和/ 区间/ 陷门/ 两个/ 方面/ ./ 其一/ ,/ 区间/ 索引/ 是否/ 会/ 泄露/ 敏感数据/ 的/ 排列/ 信息/ ;/ 其二/ ,/ 区间/ 陷门/ 是否/ 会/ 泄露/ 检索/ 区间/ 的/ 归并/ 特征/ ,/ 是否/ 会/ 泄露/ 检索/ 结果/ 中/ 敏感数据/ 的/ 排列/ 信息/ ./ 定义/ 1/ (/ 区间/ 索引/ 的/ 排列/ 安全/ )/ ./ 已知/ 一个/ 密文/ 区间/ 检索/ 方案/ 的/ 区间/ 索引/ 集合/ I/ =/ {/ I1/ ,/ I2/ ,/ …/ ,/ dn/ }/ 和/ 函数/ F/ (/ d/ ,/ k/ )/ ,/ 敏感数据/ 集合/ D/ =/ {/ d1/ ,/ d2/ ,/ …/ ,/ dn/ }/ 和/ 密钥/ k/ 均/ 未知/ ,/ 其中/ Ii/ =/ F/ (/ di/ ,/ k/ )/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 根据/ I/ 和/ F/ 如果/ 能/ 得到/ 如下/ 结果/ 密文/ 的/ 区间/ 检索/ 不同于/ 关键词/ 检索/ ,/ 区间/ 检索/ 涉及/ 到/ 区间/ 陷门/ 是否/ 泄露/ 敏感数据/ 的/ 归并/ 特征/ 的/ 问题/ ./ 由于/ 每个/ 归并/ 特征/ 均/ 表示/ 一组/ 敏感数据/ ,/ 每次/ 检索/ 也/ 是/ 基于/ 归并/ 特征/ 进行/ 的/ ./ SP/ 可以/ 通过/ 多个/ 区间/ 陷门/ 获得/ 归并/ 特征/ 排列/ 信息/ ,/ 这/ 对/ 获得/ 真实/ 的/ 敏感数据/ 非常/ 有利/ ./ (/ 1/ )/ Ij/ / dj/ ,/ 其中/ j/ ∈/ [/ 1/ ,/ n/ ]/ ;/ (/ 2/ )/ P/ (/ di/ >/ dj/ )/ =/ 0.5/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ j/ ∈/ (/ 3/ )/ P/ (/ di/ >/ dj/ |/ dk/ >/ dl/ )/ =/ P/ (/ di/ >/ dj/ )/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ i/ ≠/ j/ ;/ [/ 1/ ,/ n/ ]/ ,/ j/ ∈/ [/ 1/ ,/ n/ ]/ ,/ i/ ≠/ j/ ,/ 且/ {/ i/ ,/ j/ }/ ≠/ {/ k/ ,/ l/ }/ ,/ 那么/ 我们/ 称该/ 区间/ 索引/ 是/ 排列/ 安全/ 的/ ./ 其/ 要求/ :/ (/ 1/ )/ 敌手/ 无法/ 根据/ 区间/ 索引/ 直接/ 获得/ 真实/ 的/ 敏感数据/ ;/ (/ 2/ )/ 无法/ 根据/ 区间/ 索引/ 获得/ 任意/ 两个/ 敏感数据/ 之间/ 的/ 大小/ 关系/ ,/ 即/ 敏感数据/ 的/ 大小/ 关系/ 不可/ 区分/ ;/ (/ 3/ )/ 即使/ 敌手/ 获得/ 某/ 两个/ 敏感数据/ 之间/ 的/ 大小/ 关系/ ,/ 剩下/ 的/ 敏感数据/ 的/ 之间/ 的/ 大小/ 关系/ 仍然/ 是/ 不可/ 区分/ 的/ ,/ 即/ 无法/ 判断/ 其余/ 任意/ 两个/ 敏感数据/ 之间/ 的/ 大小/ 关系/ ./ 所以/ ,/ 如果/ 区间/ 索引/ 是/ 排列/ 不/ 安全/ 的/ ,/ 那么/ 敌手/ 可以/ 获得/ 所有/ 敏感数据/ 的/ 一个/ 排列/ ,/ 排列/ 可能/ 是/ 升序/ 的/ 也/ 可能/ 是/ 降序/ 的/ ./ 敏感数据/ 排列/ 信息/ 的/ 泄露/ ,/ 使/ 敌手/ 在/ 了解/ 所有/ 敏感数据/ 分布/ 信息/ 的/ 情况/ 下/ ,/ 可以/ 方便/ 地/ 获得/ 真实/ 的/ 敏感数据/ ./ 定义/ 2/ (/ 区间/ 陷门/ 的/ 归并/ 特征/ 安全/ )/ ./ 已知/ 一个/ 密文/ 区间/ 检索/ 方案/ 中/ 区间/ 陷门/ T/ (/ T1/ ,/ T2/ ,/ …/ ,/ Tt/ )/ ,/ 如果/ (/ 1/ )/ T/ / H/ -/ L/ ,/ 其中/ L/ 和/ H/ 分别/ 是/ 区间/ 陷门/ T/ 对应/ 的/ 检索/ 区间/ [/ L/ ,/ H/ ]/ 的/ 下界/ 和/ 上界/ ;/ (/ 2/ )/ L/ ,/ H/ ,/ K/ →/ Ti/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ t/ ]/ ,/ K/ 为/ 密钥/ ,/ 那么/ 我们/ 称该/ 区间/ 陷门/ 是/ 归并/ 特征/ 安全/ 的/ ./ 区间/ 陷门/ 的/ 归并/ 特征/ 安全/ 是/ 指/ 区间/ 陷门/ 只能/ 由/ 区间/ 上/ 下界/ 生成/ ,/ 并且/ 不会/ 泄露/ 检索/ 区间/ 大小/ ./ 所以/ ,/ 敌手/ 无法/ 根据/ 区间/ 陷门/ 获得/ 检索/ 区间/ 真实/ 的/ 上/ 下界/ 以及/ 检索/ 区间/ 的/ 大小/ ,/ 并且/ 无法/ 获得/ 检索/ 区间/ 内/ 敏感数据/ 的/ 归并/ 特征/ ./ Page4/ 定理/ 1/ ./ 设/ 存在/ n/ 个/ 互不/ 相等/ 的/ 数字/ ,/ 只/ 需要/ n/ -/ 1/ 个/ 特定/ 的/ 区间/ 检索/ 就/ 可以/ 获得/ 这/ n/ 个/ 数字/ 的/ 排列/ ./ 证明/ ./ 设/ n/ 个/ 数字/ 为/ A/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ an/ }/ ,/ 存在/ 的/ n/ -/ 1/ 个/ 区间/ 检索/ Q/ =/ {/ q1/ ,/ q2/ ,/ …/ ,/ qn/ -/ 1/ }/ 对应/ 的/ 检索/ 结果/ 为/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rn/ -/ 1/ }/ ./ 其中/ qi/ 的/ 检索/ 结果/ ri/ =/ {/ ai/ ,/ ai/ +/ 1/ |/ 1/ / i/ / n/ }/ ./ 那么/ ,/ 根据/ r1/ ,/ r2/ 可以/ 得到/ {/ a1/ </ ai/ |/ i/ =/ 2/ ,/ 3/ }/ 或/ {/ a1/ >/ ai/ |/ i/ =/ 2/ ,/ 3/ }/ ,/ 根据/ r2/ ,/ r3/ 可以/ 得到/ {/ a2/ </ ai/ |/ i/ =/ 3/ ,/ 4/ }/ 或/ {/ a2/ >/ ai/ |/ i/ =/ 3/ ,/ 4/ }/ ,/ …/ ./ 而且/ 如果/ a1/ </ a2/ ,/ 那么/ {/ ai/ </ aj/ |/ i/ </ j/ }/ ./ 否则/ {/ ai/ >/ aj/ |/ i/ </ j/ }/ ./ 根据/ 这些/ 可以/ 得出/ a1/ ,/ a2/ ,/ …/ ,/ an/ 是/ 以/ 升序/ 或/ 降序/ 排列/ 的/ 信息/ ./ 所以/ ,/ 只/ 需要/ n/ -/ 1/ 个/ 特定/ 的/ 区间/ 检索/ 就/ 可以/ 获得/ n/ 个/ 数字/ 的/ 排列/ 信息/ ./ 证毕/ ./ 由/ 定理/ 1/ 可以/ 看到/ ,/ 假如/ n/ 是/ 指/ 敏感数据/ 个数/ ,/ 且/ n/ 比较/ 大/ ,/ 那么/ 这时/ 需要/ 大量/ 的/ 特定/ 区间/ 检索/ 才能/ 让/ SP/ 获得/ 敏感数据/ 的/ 排列/ 信息/ ./ 而/ 当/ n/ 是/ 指/ 归并/ 特征/ 个数/ 时/ ,/ 由于/ 每个/ 归并/ 特征/ 代表/ 了/ 一组/ 敏感数据/ ,/ 敏感数据/ 比较/ 多时/ ,/ 对应/ 的/ 归并/ 特征/ 也/ 不会/ 很多/ ,/ 即/ n/ 比较/ 小/ ./ 这时/ 根据/ 少量/ 的/ 区间/ 检索/ 就/ 可以/ 获得/ 归并/ 特征/ 的/ 排列/ 信息/ ./ 根据/ 归并/ 特征/ 的/ 排列/ 信息/ 可以/ 获得/ 敏感数据/ 的/ 分布/ 情况/ ./ 这/ 对于/ 获得/ 真实/ 的/ 敏感数据/ 非常/ 有利/ ./ 所以/ ,/ 一个/ 区间/ 检索/ 方案/ 的/ 区间/ 陷门/ 满足/ 归并/ 特征/ 安全/ 是/ 非常/ 有/ 必要/ 的/ ./ 定义/ 3/ (/ 区间/ 陷门/ 的/ 检索/ 结果/ 安全/ )/ ./ 已知/ 一个/ 区间/ 陷门/ T/ 和/ 基于/ 该/ 陷门/ 进行/ 检索/ 的/ 检索/ 结果/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rs/ }/ ,/ 而/ 检索/ 结果/ 集/ 对应/ 的/ 敏感数据/ 集为/ D/ =/ {/ d1/ ,/ d2/ ,/ …/ ,/ ds/ }/ ,/ 如果/ 根据/ T/ 和/ R/ 可以/ 得到/ (/ 1/ )/ P/ (/ di/ >/ dj/ )/ =/ 0.5/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ j/ ∈/ (/ 2/ )/ P/ (/ dk/ >/ dl/ |/ di/ >/ dj/ )/ =/ P/ (/ dk/ >/ dl/ )/ ,/ 其中/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ i/ ≠/ j/ ;/ [/ 1/ ,/ n/ ]/ ,/ j/ ∈/ [/ 1/ ,/ n/ ]/ ,/ i/ ≠/ j/ ,/ 且/ {/ i/ ,/ j/ }/ ≠/ {/ k/ ,/ l/ }/ ,/ 那么/ 我们/ 称/ 区间/ 陷门/ 是/ 检索/ 结果/ 安全/ 的/ ./ 区间/ 陷门/ 的/ 检索/ 结果/ 安全/ 是/ 指/ 区间/ 陷门/ 和/ 检索/ 结果/ 集/ 不会/ 泄露/ 敏感数据/ 的/ 大小/ 关系/ ,/ 而且/ 这个/ 判断/ 不/ 受/ 其它/ 敏感数据/ 的/ 大小/ 关系/ 影响/ ./ 密文/ 的/ 区间/ 检索/ 不同于/ 关键词/ 检索/ ,/ 区间/ 检索/ 中/ ,/ 各/ 检索/ 结果/ 之间/ 具有/ 大小/ 关系/ ./ 如果/ 区间/ 检索/ 的/ 结果/ 之间/ 可以/ 简单/ 地/ 判断/ 出/ 大小/ 关系/ ,/ 那么/ 只要/ 获得/ 多个/ 特定/ 区间/ 陷门/ ,/ 敌手/ 就/ 可以/ 获得/ 所有/ 敏感数据/ 的/ 顺序/ 信息/ ./ 所以/ ,/ 区间/ 陷门/ 的/ 检索/ 结果/ 安全/ 对于/ 区间/ 检索/ 的/ 安全性/ 非常/ 重要/ ./ 定义/ 4/ (/ 区间/ 检索/ 的/ 唯/ 密文/ 安全/ )/ ./ 如果/ 一个/ 密文/ 区间/ 检索/ 方案/ 在/ 唯/ 密文/ 场景/ 下/ ,/ 其/ 区间/ 陷门/ 是/ 排列/ 安全/ 的/ ,/ 区间/ 陷门/ 是/ 归并/ 特征/ 安全/ 和/ 检索/ 结果/ 安全/ 的/ ,/ 那么/ 称该/ 方案/ 是/ 唯/ 密文/ 安全/ 的/ ./ 由/ 上述/ 可以/ 看出/ ,/ 无论是/ 区间/ 陷门/ 的/ 排列/ 安全/ ,/ 还是/ 区间/ 陷门/ 的/ 归并/ 特征/ 安全/ 和/ 检索/ 结果/ 安全/ ,/ 均/ 可以/ 归约/ 为/ 尽可能/ 地/ 保护/ 敏感数据/ 的/ 大小/ 关系/ ./ 由于/ 密文/ 区间/ 检索/ 与/ 关键词/ 检索/ 相比/ ,/ 其/ 特征/ 在于/ 敏感数据/ 之间/ 是/ 具有/ 某种/ 实际意义/ 的/ 大小/ 关系/ 的/ ./ 所以/ 区间/ 检索/ 的/ 唯/ 密文/ 安全/ 的/ 描述/ 重心/ 就/ 是从/ 区间/ 索引/ 和/ 区间/ 陷门/ 方面/ 考虑/ ,/ 尽可能/ 保护/ 敏感数据/ 的/ 大小/ 关系/ 信息/ 不/ 被/ 敌手/ 获得/ ./ 2.3/ 单/ 断言/ 实现/ 区间/ 判断/ 当前/ 的/ 密文/ 区间/ 检索/ 方案/ 都/ 是/ 基于/ 多次/ 断言/ 实现/ 的/ ./ 桶/ 式/ 索引/ 的/ 方案/ [/ 5/ ]/ ,/ 检索/ 时/ 需要/ 对/ 检索/ 区间/ 中/ 各个/ 预定/ 义/ 的/ 桶/ 标识/ 进行/ 断言/ ;/ 编码/ 索引/ 方案/ [/ 9/ ]/ ,/ 检索/ 时/ 需要/ 对/ 检索/ 区间/ 包含/ 的/ 所有/ 最小/ 前缀/ 编码/ 进行/ 断言/ ;/ 而/ 保序/ 加密/ [/ 1/ -/ 2/ ]/ ,/ 需要/ 对/ 索引/ 分别/ 进行/ 区间/ 上/ 下界/ 两次/ 断言/ 判断/ ./ 所以/ ,/ 当前/ 并/ 不/ 存在/ 基于/ 单/ 断言/ 实现/ 密文/ 的/ 区间/ 检索/ 方案/ ./ 本节/ 将/ 介绍/ 一种/ 可以/ 将/ 区间/ 匹配/ 转换成/ 单/ 断言/ 判断/ 的/ 方法/ ./ 该/ 断言/ 将/ 一个/ 被/ 断言/ 值/ 和/ 一个/ 断言/ 区间/ 作为/ 输入/ ,/ 服务器进行/ 相关/ 计算/ 和/ 单次/ 比较/ 判断/ 获得/ 断言/ 结果/ ./ 其中/ 被/ 断言/ 值/ 即/ 为/ 敏感数据/ 的/ 区间/ 索引/ ,/ 断言/ 区间/ 即/ 为/ 检索/ 区间/ 对应/ 的/ 区间/ 陷门/ ,/ 断言/ 结果/ 就是/ 敏感数据/ 是否/ 属于/ 检索/ 区间/ ./ 该/ 方法/ 是/ 基于/ 单位/ 圆/ 的/ 不同/ 半径/ 的/ 位置/ 关系/ 转化/ 而来/ 的/ ./ 定理/ 2/ ./ 由图/ 2/ ,/ 已知/ 在/ 一个/ 原点/ 为/ O/ 的/ 坐标系/ 中/ 存在/ 一个/ 单位/ 圆/ ,/ 上半/ 圆周/ 上/ 有/ A/ 、/ B/ 、/ C3/ 个/ 不同/ 的/ 点/ ,/ OA/ 和/ OB/ ,/ OB/ 和/ OC/ ,/ OA/ 和/ OC/ 之间/ 的/ 夹角/ 分别/ 为/ θ/ 1/ ,/ θ/ 2/ ,/ θ/ 3/ ,/ 其中/ 0/ </ θ/ i/ </ π/ ,/ i/ =/ 1/ ,/ 2/ ,/ 3/ ./ 那么/ 当且/ 仅/ 当/ cos/ θ/ 3/ </ cos/ θ/ 1cos/ θ/ 2/ 时/ ,/ OB/ 位于/ OA/ 和/ OC/ 之间/ (/ 仅/ 考虑/ 上/ 半圆/ )/ ./ sin/ θ/ 1/ >/ 0/ ,/ sin/ θ/ 2/ >/ 0/ ,/ 即/ sin/ θ/ 1sin/ θ/ 2/ >/ 0/ ./ 不会/ 重叠/ ,/ 即/ cos/ θ/ 3/ ≠/ cos/ θ/ 1cos/ θ/ 2/ ./ 证明/ ./ 由于/ θ/ 1/ ∈/ (/ 0/ ,/ π/ )/ 且/ θ/ 2/ ∈/ (/ 0/ ,/ π/ )/ ,/ 那么/ 由于/ A/ 、/ B/ 、/ C/ 是/ 3/ 个/ 不同/ 的/ 点/ ,/ OA/ 、/ OB/ 、/ OC/ 并/ 不妨/ 设/ OB/ 位于/ OA/ 、/ OC/ 之间/ ,/ 那么/ θ/ 3/ =/ θ/ 1/ +/ Page5/ θ/ 2/ ,/ cos/ θ/ 3/ =/ cos/ (/ θ/ 1/ +/ θ/ 2/ )/ =/ cos/ θ/ 1cos/ θ/ 2/ -/ sin/ θ/ 1sin/ θ/ 2/ ,/ 由/ sin/ θ/ 1sin/ θ/ 2/ >/ 0/ ,/ 得/ cos/ θ/ 3/ </ cos/ θ/ 1cos/ θ/ 2/ ./ 当/ OB/ 位于/ OA/ 、/ OC/ 之外/ 时/ ,/ θ/ 3/ =/ |/ θ/ 1/ -/ θ/ 2/ |/ ,/ cos/ θ/ 3/ =/ cos/ (/ θ/ 1/ -/ θ/ 2/ )/ =/ cos/ θ/ 1cos/ θ/ 2/ +/ sin/ θ/ 1sin/ θ/ 2/ ,/ 由/ sin/ θ/ 1sin/ θ/ 2/ >/ 0/ ,/ 得/ cos/ θ/ 3/ >/ cos/ θ/ 1cos/ θ/ 2/ ./ 所以/ ,/ 当且/ 仅/ 当/ cos/ θ/ 3/ </ cos/ θ/ 1cos/ θ/ 2/ 时/ ,/ OB/ 位于/ OA/ 和/ OC/ 之间/ ./ 由/ 定理/ 2/ ,/ 断言/ cos/ θ/ 3/ </ cos/ θ/ 1cos/ θ/ 2/ 可以/ 用来/ 表示/ 半径/ 线段/ OB/ 位于/ 线段/ OA/ 、/ OC/ 之间/ ,/ OB/ 的/ 位置/ 看作/ 是/ 要/ 被/ 检索/ 的/ 值/ ,/ 而/ OA/ 和/ OC/ 的/ 位置/ 看/ 作为/ 检索/ 区间/ ,/ 断言/ cos/ θ/ 3/ </ cos/ θ/ 1cos/ θ/ 2/ 可以/ 表示/ 一个/ 区间/ 判断/ ./ 为/ 更/ 贴切/ 地/ 表达/ 被/ 检索/ 值/ 和/ 检索/ 区间/ 的/ 关系/ ,/ 我们/ 将/ 3/ 个/ 线段/ 之间/ 的/ 位置/ 关系/ 用/ 线段/ 与/ 横轴/ 正/ 半轴/ 的/ 夹角/ 来/ 表示/ ./ 推论/ 1/ ./ 已知/ 在/ 一个/ 原点/ 为/ O/ 的/ 坐标系/ 中/ 存在/ 一个/ 圆/ ,/ 上半/ 圆周/ 上/ 有/ V/ 、/ VL/ 、/ VH3/ 个/ 不同/ 的/ 点/ ,/ 其/ OV/ 、/ OVL/ 、/ OVH/ 与/ 横坐标/ 的/ 夹角/ 分别/ 是/ θ/ 、/ θ/ L/ 、/ θ/ H/ ,/ 其中/ 0/ </ θ/ ,/ θ/ L/ ,/ θ/ H/ </ π/ ./ 那么/ 当且/ 仅/ 当/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 时/ ,/ θ/ L/ </ θ/ </ θ/ H/ ./ 证明/ ./ 由于/ OV/ 与/ OVL/ 、/ OV/ 与/ OVH/ 、/ OVL/ 与/ OVH/ 的/ 夹角/ 分别/ 是/ θ/ -/ θ/ L/ ,/ θ/ -/ θ/ H/ ,/ θ/ H/ -/ θ/ L/ ./ 由/ 定理/ 2/ 得/ ,/ 当且/ 仅/ 当/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 时/ ,/ OB/ 位于/ OA/ 和/ OC/ 之间/ ,/ 即/ θ/ L/ </ θ/ </ θ/ H/ ./ 证毕/ ./ 3/ 方案/ 3.1/ 基本/ 框架/ 一个/ 唯/ 密文/ 安全/ 的/ 密文/ 区间/ 检索/ 方案/ ,/ 不仅/ 要求/ 构造/ 的/ 区间/ 索引/ 是/ 排列/ 安全/ 的/ ,/ 而且/ 构造/ 的/ 陷门/ 是/ 归并/ 特征/ 安全/ 和/ 检索/ 结果/ 安全/ 的/ ./ 本文/ 将/ 给出/ 一种/ 将/ 区间/ 判断/ 转换成/ 单/ 断言/ 的/ 方法/ ,/ 并/ 基于/ 该/ 方法/ 构建/ 一个/ 安全/ 的/ 密文/ 区间/ 检索/ 方案/ ./ 密文/ 的/ 区间/ 检索/ 的/ 方案/ 构建/ 与/ 通用/ 的/ 密文/ 检索/ 方案/ [/ 12/ ]/ 类似/ ,/ 涉及/ 的/ 两个/ 流程/ 分别/ 是/ 构建/ 区间/ 索引/ 和/ 区间/ 检索/ ./ 对/ 这/ 两个/ 流程/ 进行/ 分解/ ,/ 可以/ 获得/ 如下/ 几个/ 过程/ :/ 1/ ./ Setup/ ./ 初始化/ 并/ 生成/ 一个/ 密钥/ K/ ./ 2/ ./ BuildIndex/ (/ v/ ,/ K/ )/ ./ DO/ 根据/ 敏感数据/ v/ 生成/ 与其/ 对应/ 的/ 索引/ ,/ 并/ 使用/ 密钥/ K/ 进行/ 加密/ 保护/ ,/ 得到/ 区间/ 索引/ I/ ./ 3/ ./ Trapdoor/ (/ L/ ,/ H/ ,/ K/ )/ ./ DO/ 根据/ 检索/ 区间/ 上/ 下界/ L/ 和/ H/ ,/ 生成/ 与/ 之/ 对应/ 的/ 陷门/ ,/ 并/ 使用/ 密钥/ K/ 进行/ 加密/ 保护/ ,/ 得到/ 区间/ 陷门/ T/ ./ 4/ ./ Search/ (/ I/ ,/ T/ )/ ./ SP/ 根据/ 区间/ 索引/ I/ 和/ 区间/ 陷门/ T/ 进行/ 单/ 断言/ 判断/ ,/ 获知/ 区间/ 索引/ 对应/ 的/ 敏感数据/ 是否/ 满足/ 检索/ 区间/ ./ 构建/ 具体/ 方案/ 时/ ,/ 首先/ DO/ 为/ 外包/ 的/ 敏感数据/ 构建/ 索引/ ,/ 涉及/ Setup/ 和/ BuildIndex/ 两个/ 过程/ ./ 在/ 初始化/ 加密/ 密钥/ 后/ ,/ 对/ 每个/ 敏感数据/ 进行/ 区间/ 索引/ 的/ 构建/ ,/ 并/ 将/ 这些/ 区间/ 索引/ 上/ 传到/ SP/ ./ 然后/ ,/ DO/ 发起/ 基于/ [/ L/ ,/ H/ ]/ 的/ 区间/ 检索/ ,/ 其/ 涉及/ Trapdoor/ 和/ Search/ 两个/ 过程/ ,/ 即/ DO/ 在/ 基于/ L/ 和/ H/ 构建/ 了/ 区间/ 陷门/ 后/ ,/ 将/ 区间/ 陷门/ 提交/ 给/ SP/ 进行/ 检索/ ./ SP/ 对/ 区间/ 索引/ 和/ 区间/ 陷门/ 进行/ 判断/ ,/ 获得/ 被/ 检索/ 的/ 敏感数据/ 是否/ 属于/ 检索/ 区间/ 的/ 信息/ ./ 3.2/ 区间/ 判断/ 到/ 单/ 断言/ 的/ 映射/ 上/ 一节/ 介绍/ 了/ 一种/ 可以/ 获得/ 区间/ 判断/ 效果/ 的/ 断言/ ,/ 我们/ 虽然/ 可以/ 通过/ 单个/ 断言/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 来/ 表示/ 一个/ 区间/ 判断/ θ/ L/ </ θ/ </ θ/ H/ ,/ 但是/ 由/ 推论/ 1/ 知该/ 区间/ 判断/ 的/ 数值/ 存在/ 着/ 大小/ 的/ 限制/ ./ 由/ 定理/ 2/ 可以/ 知道/ ,/ 被/ 判断/ 的/ 值/ 只能/ 属于/ (/ 0/ ,/ π/ )/ ./ 对于/ 大部分/ 的/ 应用/ 场景/ ,/ (/ 0/ ,/ π/ )/ 无法/ 表示/ 敏感数据/ 的/ 值域/ ,/ 所以/ 需要/ 一种/ 将/ 值域/ D/ 的/ 数值/ 映射/ 到/ 0/ 到/ π/ 之间/ 的/ 方法/ ,/ 我们/ 设计/ 了/ 如下/ 的/ 值/ 的/ 圆周/ 映射/ 方法/ ./ 值/ 的/ 圆周/ 映射/ (/ F/ )/ ./ 假设/ 映射/ 关系/ 原像/ 的/ 值域/ 为/ D/ ,/ 二维/ 坐标系/ 中/ 存在/ 一个/ 半径/ 为/ D/ 的/ 上/ 半圆/ ,/ 在/ 横轴/ 找到/ 映射/ 值/ v/ ,/ 取其/ 与/ O/ 相对/ 称/ 的/ -/ v/ ,/ 并/ 将/ 其/ 投影/ 到/ 上半/ 圆周/ 获得/ 点/ A/ ,/ 那么/ OA/ 与/ x/ 正/ 半轴/ 的/ 夹角/ θ/ 就/ 为/ v/ 的/ 映射/ 值/ ./ 如图/ 3/ ,/ cos/ θ/ =/ -/ v/ 其中/ v/ 是/ 要/ 进行/ 映射/ 的/ 值/ ,/ D/ 是/ v/ 所在/ 值域/ 的/ 大小/ ./ 将/ 值域/ 为/ D/ 的/ 数值/ 映射/ 到/ 0/ 到/ π/ 之间/ 的/ 方法/ 有/ 很多/ ./ 我们/ 这里/ 要求/ 的/ 方法/ 是/ 在/ 映射/ 后/ ,/ 断言/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 仍然/ 可以/ 表示/ 区间/ 判断/ θ/ L/ </ θ/ </ θ/ H/ ,/ 其中/ 0/ </ θ/ ,/ θ/ L/ ,/ θ/ H/ </ π/ ,/ 即该/ 映射/ 必须/ 维持/ 断言/ 对于/ 区间/ 关系/ 的/ 判断/ ./ 所以/ ,/ 我们/ 定义/ 了/ 区间/ 关系/ 维持/ 映射/ 来/ 表述/ 这样/ 的/ 映射/ ./ 定义/ 5/ (/ 区间/ 关系/ 维持/ 映射/ )/ ./ 一个/ 映射/ F/ ,/ 对于/ 任意/ 区间/ [/ L/ ,/ H/ ]/ 和/ 值/ v/ ,/ 至少/ 存在/ 一个/ 断言/ ASF/ (/ L/ )/ -/ F/ (/ H/ )/ (/ F/ (/ v/ )/ )/ 与/ 该/ 区间/ 相对/ 应/ ,/ 使得/ 只有/ 当/ L/ </ v/ </ H/ 时/ ,/ 断言/ ASF/ (/ L/ )/ -/ F/ (/ H/ )/ (/ F/ (/ v/ )/ )/ 才/ 为/ 真/ ,/ 那么/ Page6/ 该/ 映射/ F/ 被/ 称为/ 是/ 区间/ 关系/ 维持/ 映射/ ./ 区间/ 关系/ 维持/ 映射/ 表述/ 了/ ,/ 数据/ 进行/ 映射/ 之后/ ,/ 仍然/ 存在/ 一个/ 可以/ 表示/ 区间/ 关系/ 的/ 判断/ 的/ 断言/ ./ 定理/ 3/ ./ 值/ 的/ 圆周/ 映射/ 是/ 一个/ 区间/ 关系/ 维持/ 证明/ ./ 如果/ 存在/ v1/ >/ v2/ ,/ 由于/ 值/ 的/ 圆周/ 映射/ 映射/ ./ θ/ =/ arccos/ -/ v/ 么/ v1/ ,/ v2/ 经过/ 映射/ 后/ ,/ 对应/ 的/ 映射/ 值/ θ/ 1/ 和/ θ/ 2/ 满足/ θ/ 1/ >/ θ/ 2/ ,/ 其中/ θ/ 1/ ∈/ [/ 0/ ,/ π/ ]/ ,/ 且/ θ/ 2/ ∈/ [/ 0/ ,/ π/ ]/ ./ 假设/ 存在/ 3/ 个值/ v/ ,/ vL/ ,/ vH/ ,/ 其中/ vL/ </ v/ </ vH/ ,/ 那么/ 对应/ 的/ 映射/ 值/ 分别/ 为/ θ/ ,/ θ/ L/ ,/ θ/ H/ ,/ 且/ 满足/ 关系/ θ/ L/ </ θ/ </ θ/ H/ ./ 由/ 推论/ 1/ 可知/ ,/ 当且/ 仅/ 当/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 时/ ,/ 满足/ θ/ L/ </ θ/ </ θ/ H/ ,/ 即/ vL/ </ v/ </ vH/ ./ 所以/ ,/ 区间/ 判断/ 可以/ 由/ 断言/ AS/ :/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 来/ 表示/ ./ 那么/ 对于/ 值/ 的/ 圆周/ 映射/ 而言/ ,/ 任意/ 区间/ [/ vL/ ,/ vH/ ]/ 和/ 值/ v/ ,/ 对应/ 的/ 映射/ 值/ 分别/ 为/ [/ θ/ L/ ,/ θ/ H/ ]/ 和/ θ/ ./ 必然/ 存在/ 与/ 区间/ [/ θ/ L/ ,/ θ/ H/ ]/ 对应/ 的/ 断言/ AS/ :/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ ,/ 使得/ 只有/ 当/ vL/ </ v/ </ vL/ 时/ ,/ 断言/ AS/ 才/ 为/ 真/ ./ 所以/ ,/ 值/ 的/ 圆周/ 映射/ 是/ 一个/ 区间/ 关系/ 维持/ 映射/ ,/ 其/ 对应/ 的/ 断言/ 为/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ ./ 3.3/ 映射/ 值/ 的/ 加密/ 保护/ 单/ 断言/ cos/ (/ θ/ H/ -/ θ/ L/ )/ </ cos/ (/ θ/ -/ θ/ L/ )/ cos/ (/ θ/ -/ θ/ H/ )/ 可以/ 实现/ 区间/ 判断/ ./ 如果/ 直接/ 应用/ 于/ 区间/ 检索/ 方案/ 中/ ,/ 虽然/ 可以/ 达到/ 区间/ 检索/ 的/ 目的/ ,/ 但/ 无法/ 满足/ 区间/ 索引/ 安全/ 的/ 要求/ ./ SP/ 进行/ 断言/ 判断/ 时/ ,/ 需要/ DO/ 向/ 其/ 提供/ 敏感数据/ 的/ 映射/ 值/ ,/ SP/ 可以/ 利用/ 映射/ 值/ ,/ 方便/ 地/ 获得/ 真实/ 的/ 敏感数据/ ./ 所以/ ,/ 需要/ 对/ 上述/ 断言/ 进行/ 相应/ 的/ 保护/ ,/ 使/ 其/ 满足/ 安全性/ 的/ 要求/ ./ 由于/ 在/ 断言/ AS/ 中/ ,/ θ/ H/ 和/ θ/ L/ 除了/ 大小/ 不同/ 外/ ,/ 完全/ 等价/ ,/ 下面/ 以/ cos/ (/ θ/ -/ θ/ L/ )/ 作为/ 例子/ 进行/ 分析/ ,/ cos/ (/ θ/ -/ θ/ L/ )/ 的/ 变换/ 与/ 之/ 类似/ ./ 通过/ 如下/ 公式/ 进行/ θ/ 和/ θ/ L/ 的/ 分离/ ,/ 并/ 通过/ 可逆/ 矩阵/ 犕/ 对/ 分解/ 的/ 矩阵/ 进行/ 保护/ [/ 12/ ]/ ./ cos/ (/ θ/ -/ θ/ L/ )/ =/ cos/ θ/ cos/ θ/ L/ +/ sin/ θ/ sin/ θ/ L/ 同理/ 得/ cos/ (/ θ/ -/ θ/ H/ )/ =/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ 犕/ -/ 1cos/ θ/ H/ 上述/ 将/ cos/ (/ θ/ -/ θ/ L/ )/ 分解成/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ 和/ sin/ θ/ [/ ]/ L/ 犕/ -/ 1cos/ θ/ L/ 实现/ 了/ 对/ 两者/ 的/ 加密/ 保护/ ./ 矩阵/ 加密/ 的/ 形式/ 可以/ 简化/ 为/ 犆/ =/ 犘/ ×/ 犕/ ,/ 其中/ 犆/ 为/ 密文/ ,/ 犘/ =/ [/ cos/ θ/ sin/ θ/ ]/ ,/ 犕/ 为/ 2/ ×/ 2/ 的/ 可逆/ 矩阵/ ,/ 在/ 本文/ 假设/ 的/ 唯/ 密文/ 场景/ 下/ ,/ 如果/ 敌手/ 不/ 知道/ 犕/ ,/ 那么/ 其/ 无法/ 恢复/ 出/ 犘/ 的/ 值/ [/ 12/ ]/ ./ 所以/ 在/ 本文/ 的/ 场景/ 下/ ,/ 我们/ 可以/ 认为/ 矩阵/ 加密/ 是/ 安全/ 的/ ./ 上述/ 对/ θ/ 和/ θ/ L/ 的/ 分离/ ,/ 使得/ 断言/ AS/ 可以/ 适用/ 于/ 密文/ 区间/ 检索/ 的/ 应用/ 场景/ ,/ 可以/ 将/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ 作为/ 区间/ 索引/ ,/ 而/ 矩阵/ 加密/ 的/ 应用/ ,/ 使得/ 在/ 唯/ 密文/ 的/ 场景/ 下/ ,/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ 的/ 泄露/ 不会/ 影响/ 到/ 真实/ 的/ 敏感数据/ 的/ 安全/ ./ 3.4/ 安全/ 的/ 密文/ 区间/ 检索/ 方案/ 在/ 本节/ 中/ ,/ 我们/ 结合/ 上述/ 的/ 区间/ 关系/ 维持/ 映射/ 和/ 加密/ 保护/ 来/ 构建/ 一个/ 基于/ 单/ 断言/ 的/ 安全/ 的/ 密文/ 区间/ 检索/ 方案/ (/ SRQSAE/ 方案/ )/ ./ 该/ 方案/ 在/ 唯/ 密文/ 的/ 场景/ 下/ ,/ 区间/ 索引/ 本身/ 不会/ 直接/ 泄露/ 真实/ 的/ 敏感数据/ ,/ 不会/ 泄露/ 敏感数据/ 的/ 大小/ 关系/ ,/ 而且/ 检索/ 区间/ 的/ 陷门/ 可以/ 维护/ 敏感数据/ 的/ 大小/ 关系/ ./ 其/ 主要/ 包含/ 了/ 如下/ 几个/ 步骤/ :/ 1/ ./ Setup/ ./ 生成/ 一个/ 2/ ×/ 2/ 的/ 可逆/ 矩阵/ 犕/ ,/ 计算/ 获得/ 犕/ -/ 1/ ,/ 得到/ 相关/ 密钥/ K/ =/ {/ 犕/ ,/ 犕/ -/ 1/ }/ ./ 2/ ./ BuildIndex/ (/ v/ ,/ K/ )/ ./ 对/ v/ 进行/ 值/ 的/ 圆周/ 映射/ ,/ 获得/ 映射/ 值/ θ/ 及/ [/ cos/ θ/ sin/ θ/ ]/ ,/ 然后/ 进行/ 矩阵/ 的/ 乘法/ 运算/ ,/ 获得/ v/ 对应/ 的/ 区间/ 索引/ 犐/ =/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ ./ 3/ ./ Trapdoor/ (/ L/ ,/ H/ ,/ K/ )/ ./ 将/ 检索/ 区间/ 的/ 上/ 下界/ 分别/ 进行/ 值/ 的/ 圆周/ 映射/ ,/ 获得/ 映射/ 值/ θ/ L/ 和/ θ/ H/ ,/ 再/ 进行/ 矩阵/ 乘法/ 运算/ ,/ 获得/ 陷/ 门/ 犜/ L/ =/ 犕/ -/ 1cos/ θ/ L/ 算/ 陷门/ Trange/ =/ cos/ (/ θ/ H/ -/ θ/ L/ )/ ,/ 最后/ ,/ 区间/ 陷门/ T/ =/ {/ 犜/ 1/ ,/ 犜/ 2/ ,/ Trange/ }/ ./ 其中/ ,/ 陷/ 门/ 犜/ 1/ 、/ 犜/ 2/ 并/ 不是/ 固定/ 地/ 分别/ 对应/ 着/ 犜/ L/ 、/ 犜/ H/ ,/ 其/ 对应/ 关系/ 是/ 随机/ 的/ ,/ 当/ 犜/ 1/ 对应/ 犜/ L/ 时/ ,/ 犜/ 2/ 就/ 对应/ 着/ 犜/ H/ ,/ 否则/ 相反/ ./ 4/ ./ Search/ (/ 犐/ ,/ T/ )/ ./ 进行/ 单/ 断言/ Trange/ </ (/ 犐/ ·/ 犜/ 1/ )/ ·/ (/ 犐/ ·/ 犜/ 2/ )/ 判断/ ,/ 如果/ 是/ 真/ ,/ 则/ 返回/ yes/ ,/ 否则/ 返回/ no/ ./ 该/ 方案/ 的/ 主要/ 步骤/ 与/ 一般/ 的/ 密文/ 检索/ 方案/ [/ 12/ -/ 14/ ]/ 类似/ ,/ DO/ 首先/ 需要/ 初始化/ 一个/ 可逆/ 的/ 矩阵/ 犕/ 作为/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 加密/ 密钥/ ,/ 在外/ 包/ 敏感数据/ 时/ ,/ 通过/ 值/ 的/ 圆周/ 映射/ 和/ 矩阵/ 加密/ 来/ 生成/ 区间/ 索引/ 犐/ ./ 当/ DO/ 进行/ 检索/ 时/ ,/ 对/ 检索/ 区间/ 的/ 上/ 下界/ 同样/ 进行/ 值/ 的/ 圆周/ 映射/ 和/ 矩阵/ 加密/ 来/ 生成/ 相应/ 的/ 区间/ 陷门/ T/ ,/ 并/ 提交/ 给/ SP/ ,/ SP/ 将/ 每个/ 区间/ 索引/ 犐/ 都/ 与/ Page7/ 区间/ 陷门/ T/ 进行/ 单/ 断言/ 判断/ ,/ 返回/ 判断/ 结果/ ./ 4/ 安全性/ 分析/ 密文/ 区间/ 检索/ 方案/ 构建/ 的/ 目的/ 是/ 在/ 保证/ 敏感数据/ 机密性/ 的/ 前提/ 下/ ,/ 实现/ 区间/ 检索/ 的/ 目的/ ./ 其/ 方案/ 的/ 构建/ 需要/ 考虑/ 在/ 假设/ 的/ 场景/ 下/ 区间/ 索引/ 、/ 区间/ 陷门/ 是否/ 满足/ 安全性/ 的/ 需求/ ./ 当前/ 我们/ 假设/ 的/ 场景/ 是/ 唯/ 密文/ 场景/ ,/ SP/ 不/ 了解/ 敏感数据/ 的/ 任何/ 信息/ ,/ 但/ 可以/ 获得/ DO/ 的/ 多个/ 检索/ 区间/ 陷门/ ,/ 以/ 期望/ 分析/ 出/ 敏感数据/ 的/ 分布/ 特征/ 或/ 大小/ 排列/ 信息/ 等/ ./ 本节/ 我们/ 将/ 对/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全/ 分别/ 进行/ 分析/ ,/ 验证/ 该/ 方案/ 满足/ 我们/ 假定/ 的/ 安全性/ 的/ 需要/ ./ 4.1/ 区间/ 索引/ 安全/ 由于/ 本文/ 只/ 考虑/ 唯/ 密文/ 的/ 场景/ ,/ 敌手/ 对/ 敏感数据/ 的/ 分布/ 情况/ 、/ 敏感数据/ 与/ 区间/ 索引/ 的/ 对应/ 关系/ 都/ 不/ 了解/ ./ 所以/ 进行/ 区间/ 索引/ 安全/ 考虑/ 时/ ,/ 我们/ 并不需要/ 考虑/ 统计/ 分析攻击/ 、/ 明/ 密文/ 攻击/ 等/ ,/ 只/ 需要/ 考虑/ 区间/ 索引/ 是否/ 会/ 泄露/ 真实/ 的/ 敏感数据/ ,/ 区间/ 索引/ 是否/ 会/ 泄露/ 敏感数据/ 的/ 大小/ 关系/ 信息/ ./ 后者/ 的/ 安全性/ 要求/ 比/ 前者/ 要求/ 更高/ ,/ 因为/ 单纯/ 从/ 区间/ 索引/ 的/ 角度/ ,/ 区间/ 索引/ 如果/ 泄露/ 了/ 真实/ 敏感数据/ ,/ 那么/ 敏感数据/ 的/ 大小/ 关系/ 必然/ 泄露/ ,/ 而/ 如果/ 区间/ 索引/ 泄露/ 了/ 敏感数据/ 大小/ 关系/ ,/ 那么/ 真实/ 的/ 敏感数据/ 并不一定/ 会/ 泄露/ ./ 所以/ ,/ 对/ 区间/ 索引/ 来说/ ,/ 保护/ 敏感数据/ 大小/ 排列/ 信息/ 的/ 安全性/ 要求/ 更高/ ./ 由于/ 敏感数据/ 在/ 经过/ 值/ 的/ 圆周/ 映射/ 后/ ,/ 通过/ 矩阵/ 相乘/ 的/ 方式/ 来/ 生成/ 区间/ 索引/ ,/ 区间/ 索引/ 的/ 安全性/ 依赖于/ 矩阵/ 相乘/ 的/ 安全性/ ./ 在上文/ 可以/ 看到/ ,/ 在/ 唯/ 密文/ 的/ 场景/ 下/ ,/ 只要/ 不/ 泄露/ 矩阵/ 相乘/ 中/ 的/ 可逆/ 矩阵/ ,/ 那么/ 敏感数据/ 的/ 机密性/ 可以/ 得到/ 保证/ ,/ 敌手/ 无法/ 根据/ 区间/ 索引/ 获得/ 具体/ 的/ 敏感数据/ ./ 所以/ 方案/ SRQSAE/ 中/ ,/ 区间/ 索引/ 不会/ 泄露/ 具体/ 的/ 敏感数据/ ./ 定理/ 4/ ./ 已知/ 公式/ 犆/ =/ 犘/ ×/ 犕/ ,/ 其中/ 犘/ 是/ 1/ ×/ 2/ 的/ 矩阵/ [/ cos/ θ/ sin/ θ/ ]/ ,/ θ/ ∈/ (/ 0/ ,/ π/ )/ ,/ 犕/ 是/ 2/ ×/ 2/ 的/ 可逆/ 的/ 未知/ 矩阵/ ,/ 给定/ 任意/ 两个/ 不同/ 犆/ 1/ 和/ 犆/ 2/ ,/ 假设/ 存在/ 与/ 之/ 对应/ 的/ θ/ 1/ 和/ θ/ 2/ ,/ 那么/ θ/ 1/ 和/ θ/ 2/ 的/ 大小/ 关系/ 是/ 不可/ 区分/ 的/ ./ 证明/ ./ 在/ 可逆/ 矩阵/ 犕/ 未知/ 的/ 情况/ 下/ ,/ 给定/ 犆/ ,/ 必然/ 存在/ 多个/ 可能/ 的/ 犘/ 满足/ 公式/ 犆/ =/ 犘/ ×/ 犕/ ,/ 由于/ 犘/ =/ [/ cos/ θ/ sin/ θ/ ]/ ,/ 所以/ 存在/ 多个/ 可能/ 的/ θ/ ./ 而/ 对于/ 犆/ 1/ 和/ 犆/ 2/ ,/ 在/ 犕/ 未知/ 的/ 情况/ 下/ ,/ 也/ 可能/ 存在/ 多/ 对/ θ/ 1/ 和/ θ/ 2/ 满足/ 上述/ 公式/ ./ 对于/ 任意/ 一对/ 满足/ 犆/ 1/ 和/ 犆/ 2/ 的/ θ/ 1/ 和/ θ/ 2/ ,/ 可以/ 记/ 为/ =/ [/ a/ ×/ cos/ θ/ 1/ +/ c/ ×/ sin/ θ/ 1b/ ×/ cos/ θ/ 1/ +/ d/ ×/ sin/ θ/ 1/ ]/ ,/ 同理/ 可/ 得/ 犘/ 2/ =/ [/ cos/ θ/ 2sin/ θ/ 2/ ]/ ,/ 犆/ 2/ =/ [/ a/ ×/ cos/ θ/ 2/ +/ c/ ×/ sin/ θ/ 2b/ ×/ cos/ θ/ 2/ +/ d/ ×/ sin/ θ/ 2/ ]/ ./ 那么/ 对应/ 的/ ,/ 存在/ 元组/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ ,/ 其中/ θ/ 1/ =/ π/ -/ θ/ 1/ ,/ θ/ 2/ =/ π/ -/ θ/ 2/ ,/ 矩阵/ 犕/ =/ -/ a/ -/ b/ [/ ]/ cd/ ,/ 则/ 犆/ 1/ =/ [/ -/ cos/ θ/ 1sin/ θ/ 1/ ]/ -/ a/ -/ b/ [/ ]/ cd/ 犘/ 1/ =/ [/ cos/ θ/ 1sin/ θ/ 1/ ]/ =/ [/ cos/ (/ π/ -/ θ/ 1/ )/ sin/ (/ π/ -/ θ/ 1/ )/ ]/ =/ [/ -/ cos/ θ/ 1sin/ θ/ 1/ ]/ ,/ 由/ 公式/ 犆/ 1/ =/ 犘/ 1/ ×/ 犕/ 可/ 得/ 元组/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ ,/ 其中/ [/ cos/ θ/ 1sin/ θ/ 1/ ]/ 犕/ =/ 犆/ 1/ 且/ [/ cos/ θ/ 2sin/ θ/ 2/ ]/ 犕/ =/ 犆/ 2/ ./ 如果/ 对于/ 任意/ 满足/ 犆/ 1/ 和/ 犆/ 2/ 要求/ 的/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ ,/ 其中/ θ/ 1/ >/ θ/ 2/ ,/ 均/ 存在/ 另/ 一个/ 同意/ 满足/ 犆/ 1/ 和/ 犆/ 2/ 的/ 元组/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ ,/ 其中/ θ/ 1/ 和/ θ/ 2/ 满足/ θ/ 1/ </ θ/ 2/ ,/ 那么/ 在/ θ/ 1/ 和/ θ/ 2/ 值/ 未知/ 的/ 情况/ 下/ ,/ 即使/ 其/ 满足/ 犆/ 1/ 和/ 犆/ 2/ ,/ θ/ 1/ 和/ θ/ 2/ 的/ 大小/ 关系/ 是/ 不可/ 区分/ 的/ ,/ 因为/ 无法/ 判断/ θ/ 1/ =/ θ/ 1/ ,/ θ/ 2/ =/ θ/ 2/ 还是/ θ/ 1/ =/ θ/ 1/ ,/ θ/ 2/ =/ θ/ 2/ ./ 下面/ 来/ 证明/ 对于/ 任意/ 的/ 元组/ A/ 必然/ 存在/ 元组/ A/ 与/ 之/ 对应/ ./ 不妨/ 设/ 存在/ 满足要求/ 的/ 元组/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ ,/ 其/ 对应/ 的/ 可逆/ 矩阵/ 为/ 犕/ =/ ab/ [/ ]/ cd/ ./ 那么/ 犘/ 1/ =/ [/ cos/ θ/ 1sin/ θ/ 1/ ]/ ,/ 根据/ 公式/ 可以/ 得到/ 犆/ 1/ =/ 犘/ 1/ ×/ 犕/ =/ [/ a/ ×/ cos/ θ/ 1/ +/ c/ ×/ sin/ θ/ 1b/ ×/ cos/ θ/ 1/ +/ d/ ×/ sin/ θ/ 1/ ]/ =/ 犆/ 1/ ,/ 那么/ 同理/ 可以/ 得到/ 犘/ 2/ =/ [/ -/ cos/ θ/ 2sin/ θ/ 2/ ]/ ,/ 犆/ 2/ =/ 犆/ 2/ ./ 即/ 元组/ A/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ 犕/ }/ 同样/ 满足/ 犆/ 1/ 和/ 犆/ 2/ 的/ 要求/ ./ 由/ 上/ 可以/ 看出/ ,/ 对于/ 任意/ 的/ 满足要求/ 的/ 元组/ A/ ,/ 必然/ 存在/ 对应/ 的/ 另/ 一个/ 满足条件/ 的/ 元组/ A/ ./ 如果/ θ/ 1/ >/ θ/ 2/ ,/ 那么/ 必然/ 可以/ 得到/ π/ -/ θ/ 1/ </ π/ -/ θ/ 2/ ,/ 而/ π/ -/ θ/ 1/ 和/ π/ -/ θ/ 2/ ,/ 即为/ A/ 中/ 对应/ 的/ 角度/ 值/ θ/ 1/ 和/ θ/ 2/ ./ 对于/ 任意/ 满足要求/ 的/ θ/ 1/ >/ θ/ 2/ ,/ 必然/ 存在/ 另/ 一对/ 满足要求/ 的/ θ/ 1/ </ θ/ 2/ ./ 所以/ ,/ θ/ 1/ 和/ θ/ 2/ 的/ 大小/ 是/ 不可/ 区分/ 的/ ./ 由/ 定理/ 4/ 的/ 证明/ 过程/ 可知/ ,/ 对于/ 任意/ 两个/ 区间/ 索引/ ,/ 其/ 对应/ 的/ 敏感数据/ 的/ 大小/ 关系/ 是/ 不可/ 区分/ 的/ ./ 上述/ 过程/ 中/ ,/ 我们/ 为/ 一对/ 已知/ 敏感数据/ 找出/ 另/ 一对/ 具有/ 相同/ 区间/ 索引/ 但/ 大小/ 相反/ 的/ 敏感数据/ ./ 所以/ ,/ 在/ M/ 安全/ 的/ 情况/ 下/ ,/ 该/ 证明/ 过程/ 不/ 受/ 其它/ 敏感数据/ 大小/ 关系/ 的/ 影响/ ,/ 即/ 敏感数据/ 的/ 大小/ 不可/ 区分/ 性不受/ 其它/ 敏感数据/ 大小/ 关系/ 的/ 影响/ ./ 而且/ 由于/ 该/ 区间/ 索引/ 是/ 通过/ 矩阵/ 相乘/ 来/ 生成/ 的/ ,/ 在/ 唯/ 密文/ 的/ 场景/ 下/ ,/ 不会/ 泄露/ 真实/ 的/ 敏感数据/ ./ 所以/ 方案/ SRQSAE/ 中/ 的/ 区/ Page8/ 间/ 索引/ 达到/ 了/ 排列/ 安全/ 的/ 要求/ ./ 4.2/ 区间/ 陷门/ 安全/ 对于/ 区间/ 陷门/ 的/ 安全性/ ,/ 不仅仅/ 需要/ 考虑/ 区间/ 陷门/ 是否/ 会/ 泄露/ 区间/ 上/ 下界/ ,/ 而且/ 需要/ 考虑/ 区间/ 陷门/ 是否/ 泄露/ 归并/ 特征/ 的/ 信息/ 以及/ 检索/ 结果/ 之间/ 的/ 大小/ 关系/ 信息/ ./ 本文/ 提出/ 的/ 方案/ 中/ 区间/ 陷门/ 是/ 满足/ 这些/ 要求/ 的/ ,/ 即/ 满足/ 定义/ 2/ 和/ 3/ 所说/ 的/ 区间/ 陷门/ 的/ 归并/ 特征/ 安全/ 和/ 检索/ 结果/ 安全/ 的/ 要求/ ./ 下面/ 将/ 从/ 这/ 两个/ 方面/ 进行/ 分析/ ./ 定理/ 5/ ./ 已知/ 存在/ 两个/ 值/ v1/ ,/ v2/ ,/ 映射/ 关系/ F/ (/ v/ )/ =/ arccos/ -/ vF/ (/ v2/ )/ )/ 的/ 计算/ 值/ ,/ 敌手/ 无法/ 判断/ |/ v1/ -/ v2/ |/ 值/ 的/ 大小/ ./ 证明/ ./ 不妨/ 设/ v1/ ,/ v2/ 的/ 三角/ 计算结果/ E/ 为/ value/ ,/ 即/ value/ =/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ ./ 由/ value/ =/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ 可以/ 得到/ ,/ value/ =/ cos/ π/ 妨设/ 存在/ 另外/ 两个/ 值/ v1/ ,/ v2/ ,/ 使得/ arccos/ -/ v1D/ =/ 2/ -/ F/ (/ v1/ )/ ,/ arccos/ -/ v2D/ =/ π/ π/ 应/ 的/ 三角/ 计算/ E/ 的/ 结果/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ =/ cosarccos/ -/ v1D/ -/ arccos/ -/ v2/ 所以/ ,/ 至少/ 存在/ 两对/ 满足/ 三角/ 计算结果/ 为/ E/ 的/ v1/ ,/ v2/ ,/ 如果/ |/ v1/ -/ v2/ |/ ≠/ |/ v1/ -/ v2/ |/ ,/ 那么/ 我们/ 可以/ 认为/ 敌手/ 无法/ 根据/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ 判断/ |/ v1/ -/ v2/ |/ 的/ 值/ ./ 由/ Dsin/ (/ F/ (/ v/ )/ )/ =/ D1/ -/ cos2F/ (/ v/ 槡/ )/ =/ D2/ -/ v/ 槡/ 2/ 得/ |/ v1/ -/ v2/ |/ =/ Dcos/ π/ |/ Dsin/ (/ F/ (/ v2/ )/ )/ -/ Dsin/ (/ F/ (/ v1/ )/ )/ |/ =/ |/ D2/ -/ v/ 槡/ 22/ -/ D2/ -/ v/ 槡/ 21/ |/ ./ 那么/ ,/ 当/ v1/ ,/ v2/ 取/ 某个/ 固定值/ ,/ 值域/ D/ 的/ 大小/ 发生变化/ 时/ ,/ |/ v1/ -/ v2/ |/ 的/ 值/ 也/ 随着/ 变化/ ,/ 所以/ |/ v1/ -/ v2/ |/ / |/ v1/ -/ v2/ |/ ./ 因此/ ,/ 敌手/ 无法/ 根据/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ 判断/ |/ v1/ -/ v2/ |/ 的/ 大小/ ./ 由/ 上述/ 定理/ 5/ ,/ 如果/ v1/ ,/ v2/ 为/ 某个/ 检索/ 区间/ 的/ 上/ 下界/ 时/ ,/ 那么/ 向/ 敌手/ 泄露/ 三角/ 计算/ E/ :/ cos/ (/ F/ (/ v1/ )/ -/ F/ (/ v2/ )/ )/ ,/ 并/ 不/ 影响/ 检索/ 区间/ 的/ 安全性/ ,/ 因为/ 敌手/ 无法/ 判断/ |/ v1/ -/ v2/ |/ 的/ 大小/ ,/ 即/ 敌手/ 无法/ 根据/ 三角/ 计算/ E/ 来/ 获得/ 检索/ 区间/ 的/ 大小/ ./ 定理/ 6/ ./ 方案/ SRQSAE/ 中/ 的/ 区间/ 陷门/ 是/ 归并在/ 方案/ SRQSAE/ 中/ ,/ 检索/ 区间/ 的/ 陷门/ 为/ T/ =/ 特征/ 安全/ 的/ ./ sin/ θ/ [/ ]/ L/ 犕/ -/ 1cos/ θ/ L/ 烅/ 烄/ 烆/ sin/ θ/ [/ ]/ H/ 犕/ -/ 1cos/ θ/ H/ 烅/ 烄/ 烆/ 矩阵/ 相乘/ 的/ 分析/ ,/ 我们/ 可以/ 知道/ ,/ 在/ 唯/ 密文/ 的/ 情况/ 下/ ,/ 根据/ 陷门/ SP/ 无法/ 分析/ 出/ 真实/ 的/ 检索/ 区间/ 上/ 下界/ ./ 且/ 根据/ 定理/ 5/ ,/ SP/ 无法/ 根据/ 陷门/ 计算/ 出/ 检索/ 区间/ 的/ 大小/ ./ 所以/ ,/ SP/ 无法/ 根据/ 检索/ 区间/ 的/ 真实/ 上/ 下界/ 或/ 区间/ 大小/ 去/ 分析/ 该/ 区间/ 内/ 的/ 归并/ 特征/ ./ 同时/ 该/ 区间/ 陷门/ 是/ 由/ 检索/ 区间/ 的/ 上/ 下界/ 而/ 非/ 归并/ 特征/ 计算/ 生成/ ,/ 所以/ ,/ 该/ 方案/ 中/ 的/ 区间/ 陷门/ 不会/ 泄露/ 检索/ 区间/ 任何/ 归并/ 特征/ ,/ 其/ 区间/ 陷门/ 是/ 归并/ 特征/ 安全/ 的/ ./ 定理/ 7/ ./ 假设/ 由/ SP/ 进行/ 断言/ SA/ :/ value/ </ value1/ ×/ value2/ 的/ 判断/ ,/ DO/ 选择/ θ/ H/ ,/ θ/ L/ ,/ θ/ ,/ 计算/ 出/ value/ ,/ value1/ ,/ value2/ ,/ 并/ 提交/ 给/ SP/ ,/ 其中/ value/ =/ cos/ (/ θ/ H/ -/ θ/ L/ )/ ,/ value1/ 和/ value2/ 分别/ 对应/ cos/ (/ θ/ -/ θ/ L/ )/ 和/ cos/ (/ θ/ -/ θ/ H/ )/ 中/ 的/ 一个/ ./ 那么/ 在/ 任意/ 两次/ 断言/ SA/ 为/ 真的/ 情况/ 下/ ,/ 如果/ DO/ 选择/ 的/ 是/ 相同/ 的/ θ/ H/ 和/ θ/ L/ ,/ 不同/ 的/ θ/ ,/ 那么/ SP/ 无法/ 判断/ DO/ 在/ 这/ 两次/ 断言/ 中/ 所/ 选择/ 的/ θ/ 的/ 大小/ 关系/ ./ 证明/ ./ 由于/ 判断/ 相同/ 的/ θ/ H/ 和/ θ/ L/ 情况/ 下/ ,/ 两次/ 断言/ 为/ 真时/ ,/ 两个/ θ/ 的/ 大小/ 不可/ 区分/ ,/ 所以/ 下面/ 的/ 分析/ 都/ 是/ 针对/ 固定/ 的/ θ/ H/ 和/ θ/ L/ 进行/ 的/ ,/ 由于/ 固定/ 的/ θ/ H/ 和/ θ/ L/ 对应/ 相同/ 的/ value/ ,/ 下文/ 分析/ 时/ 不再/ 考虑/ value/ ./ 我们/ 使用/ 断言/ 元组/ B/ 来/ 表示/ 某次/ 断言/ 判断/ 过程/ 中/ ,/ SP/ 获得/ 的/ 数据/ ,/ B/ =/ {/ value1/ ,/ value2/ }/ ./ 由于/ DO/ 在/ 提交/ 数据/ 给/ SP/ 时/ ,/ value1/ 和/ value2/ 的/ 顺序/ 是/ 随机/ 的/ ,/ 所以/ 对于/ B1/ =/ {/ value1/ ,/ value2/ }/ 和/ B2/ =/ {/ value2/ ,/ value1/ }/ ,/ SP/ 认为/ 其是/ 无差别/ 的/ ,/ 即/ B1/ 等价/ 于/ B2/ ./ 断言/ 元组/ B/ 中/ 的/ 数据/ 前后/ 顺序/ 的/ 变化/ 不/ 影响/ B/ ./ 由于/ 在/ 一次/ 断言/ 中/ ,/ SP/ 进行/ 断言/ 数据/ 都/ 包含/ 于/ 断言/ 元组/ B/ 中/ ./ 所以/ ,/ 如果/ 两次/ 断言/ 中/ 的/ 断言/ 元组/ B/ 相同/ ,/ SP/ 无法/ 判断/ DO/ 选择/ 的/ θ/ 是否/ 不同/ ./ 我们/ 使用/ 断言/ 判断/ 元组/ A/ 来/ 表示/ 某次/ 断言/ 为/ 真的/ 判断/ 中/ 涉及/ 的/ 相关/ 数据/ ,/ 即/ A/ =/ {/ θ/ ,/ B/ }/ ,/ 其中/ θ/ 为/ DO/ 选择/ 的/ 数值/ ,/ 其/ 对/ SP/ 保密/ ,/ B/ 为/ 断言/ 元组/ ./ 那么/ A1/ =/ {/ θ/ 1/ ,/ B/ }/ 和/ A2/ =/ {/ θ/ 2/ ,/ B/ }/ 是/ 两次/ 不同/ 的/ 断言/ ,/ 因为/ DO/ 选择/ 了/ 不同/ 的/ θ/ ,/ 但/ 生成/ 了/ 等价/ 的/ 断言/ 元组/ B/ ./ 对于/ SP/ 而言/ ,/ A1/ 和/ A2/ 两个/ 断言/ 没有/ 任何/ 区别/ ,/ 是/ 不可/ 区分/ 的/ ,/ 我们/ 可以/ 称/ A2/ 为/ A1/ 的/ SP/ 无差别/ 的/ Page9/ 不同/ 断言/ 判断/ 元组/ ./ 即/ 虽然/ 本质/ 上/ 这/ 两次/ 断言/ 是/ 针对/ 不同/ 的/ θ/ 的/ 进行/ 的/ ,/ 但是/ 由于/ DO/ 提交/ 给/ SP/ 进行/ 断言/ 的/ 数据/ 集合/ 完全相同/ ,/ SP/ 无法/ 判断/ 其/ 是否是/ 针对/ 不同/ 的/ θ/ 进行/ 的/ 断言/ ./ 对于/ DO/ 选择/ 的/ 数值/ θ/ ,/ 由于/ θ/ 和/ θ/ H/ +/ θ/ L/ -/ θ/ 生成/ 相同/ 的/ 断言/ 元组/ B/ ,/ 即/ cos/ (/ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ -/ θ/ L/ )/ =/ cos/ (/ θ/ H/ -/ θ/ )/ =/ cos/ (/ θ/ -/ θ/ H/ )/ ,/ cos/ (/ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ -/ θ/ H/ )/ =/ cos/ (/ θ/ L/ -/ θ/ )/ =/ cos/ (/ θ/ -/ θ/ L/ )/ ./ 即当/ DO/ 分别/ 选择/ θ/ 和/ θ/ H/ +/ θ/ L/ -/ θ/ 进行/ 断言/ 时/ ,/ SP/ 无法/ 区分/ ./ 所以/ ,/ 对/ 任意/ θ/ ,/ 都/ 存在/ 一个/ θ/ H/ +/ θ/ L/ -/ θ/ 使得/ 针对/ 这/ 两个/ 值/ 进行/ 的/ 断言/ ,/ SP/ 无法/ 区分/ ./ 对应/ 的/ 断言/ 判断/ 元组/ 分别/ 为/ A/ =/ {/ θ/ ,/ B/ }/ 和/ A/ =/ {/ θ/ H/ +/ θ/ L/ -/ θ/ ,/ B/ }/ ,/ 这/ 两个/ 断言/ 判断/ 元组/ 互为/ 无差别/ 的/ 断言/ 判断/ 元组/ ./ 不妨/ 设/ 存在/ 两次/ 针对/ 不同/ 值/ 的/ θ/ 和/ θ/ 的/ 断言/ ,/ 其/ 对应/ 的/ 断言/ 判断/ 元组/ 分别/ 是/ A/ =/ {/ θ/ ,/ B/ }/ 和/ A/ =/ {/ θ/ ,/ B/ }/ ,/ 其中/ B/ =/ {/ value1/ ,/ value2/ }/ ,/ B/ =/ {/ value1/ ,/ value2/ }/ ./ 那么/ 对于/ A/ 和/ A/ 均/ 存在/ 使得/ SP/ 无从/ 区分/ 的/ 无差别/ 的/ 断言/ 判断/ 元组/ Aa/ 和/ Aa/ ,/ 其中/ Aa/ =/ {/ θ/ a/ ,/ B/ }/ =/ {/ θ/ H/ +/ θ/ L/ -/ θ/ ,/ B/ }/ 和/ Aa/ =/ {/ θ/ a/ ,/ B/ }/ =/ {/ θ/ H/ +/ θ/ L/ -/ θ/ ,/ B/ }/ ,/ 那么/ 当/ θ/ >/ θ/ 或者/ θ/ </ θ/ 时/ ,/ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ </ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ 或者/ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ >/ (/ θ/ H/ +/ θ/ L/ -/ θ/ )/ ,/ 即/ θ/ a/ </ θ/ a/ 或/ θ/ a/ >/ θ/ a/ ./ 所以/ ,/ 对于/ 任意/ 的/ 一对/ 断言/ 元组/ B/ 和/ B/ ,/ 如果/ 其/ 分别/ 是/ 针对/ {/ θ/ ,/ θ/ |/ θ/ >/ θ/ }/ 进行/ 断言/ ,/ 那么/ 必然/ 存在/ 针对/ {/ θ/ H/ +/ θ/ L/ -/ θ/ ,/ θ/ H/ +/ θ/ L/ -/ θ/ |/ θ/ >/ θ/ }/ 的/ 断言/ ,/ 其/ 对应/ 断言/ 元组/ 也/ 是/ B/ 和/ B/ ./ 所以/ ,/ 对于/ 任意/ 一对/ 断言/ 元组/ ,/ SP/ 无法/ 判断/ DO/ 选择/ 的/ θ/ 的/ 大小/ 关系/ ./ 所以/ 当/ DO/ 选择/ 相同/ 的/ θ/ H/ 和/ θ/ L/ 时/ ,/ 在/ 任意/ 两次/ 断言/ 为/ 真的/ 情况/ 下/ ,/ SP/ 无法/ 判断/ DO/ 在/ 这/ 两次/ 判断/ 中/ 选择/ 的/ θ/ 的/ 大小/ 关系/ ./ 定理/ 8/ ./ 方案/ SRQSAE/ 中/ 的/ 区间/ 陷门/ 是/ 检索/ 结果/ 安全/ 的/ ./ 在/ 方案/ SRQSAE/ 中/ ,/ 判断/ 一个/ 敏感数据/ 是否/ 属于/ 检索/ 区间/ 时/ ,/ 需要/ 向/ SP/ 提供/ 检索/ 区间/ 陷门/ T/ =/ sin/ θ/ [/ ]/ L/ 犕/ -/ 1cos/ θ/ L/ 烅/ 烄/ 烆/ 数据/ 的/ 索引/ 犐/ =/ [/ cos/ θ/ sin/ θ/ ]/ 犕/ ,/ 其中/ T/ 的/ 前/ 两个/ 数据/ 可以/ 交换/ 位置/ ./ 由于/ 区间/ 陷门/ 和/ 区间/ 索引/ 本身/ 不会/ 泄露/ 检索/ 区间/ 和/ 敏感数据/ 的/ 真实/ 信息/ ,/ SP/ 获得/ 区间/ 陷门/ 和/ 区间/ 索引/ 的/ 信息/ 不会/ 影响/ 到/ 检索/ 区间/ 和/ 敏感数据/ 的/ 安全性/ ./ 同时/ 区间/ 陷门/ 和/ 区间/ 索引/ 都/ 是/ 通过/ 矩阵/ 相乘/ 进行/ 保护/ 的/ ./ 由/ 定理/ 5/ 可以/ 看出/ ,/ 在/ 唯/ 密文/ 的/ 情况/ 下/ ,/ 区间/ 索引/ 和/ 区间/ 陷门/ 不会/ 泄露/ 真实/ 的/ 敏感数据/ ,/ 而且/ 也/ 可以/ 保护/ 敏感数据/ 之间/ 的/ 大小/ 关系/ ./ 检索/ 时/ ,/ 需要/ 将/ 检索/ 陷门/ 中/ 的/ 犜/ 1/ 和/ 犜/ 2/ 分别/ 与/ 犐/ 进行/ 相乘/ ,/ 获得/ cos/ (/ θ/ -/ θ/ L/ )/ 和/ cos/ (/ θ/ -/ θ/ H/ )/ 的/ 值/ ,/ 最后/ 与/ cos/ (/ θ/ H/ -/ θ/ L/ )/ 进行/ 比较/ ./ 由于/ 区间/ 陷门/ 和/ 索引/ 本身/ 不会/ 泄露/ 真实/ 的/ 敏感数据/ 以及/ 敏感数据/ 的/ 大小/ 关系/ ,/ 所以/ SP/ 根据/ 区间/ 陷门/ 和/ 区间/ 索引/ 无法/ 获得/ 相应/ 的/ 有效/ 信息/ ./ 检索/ 时/ ,/ 还/ 将/ 向/ SP/ 泄露/ cos/ (/ θ/ -/ θ/ L/ )/ 、/ cos/ (/ θ/ -/ θ/ H/ )/ 和/ cos/ (/ θ/ H/ -/ θ/ L/ )/ 这/ 3/ 个值/ ./ 由/ 定理/ 7/ ,/ 当/ 只/ 泄露/ cos/ (/ θ/ -/ θ/ L/ )/ 、/ cos/ (/ θ/ -/ θ/ H/ )/ 和/ cos/ (/ θ/ H/ -/ θ/ L/ )/ 时/ ,/ SP/ 完全/ 无法/ 区分/ 两个/ 被/ 检索/ 值/ 之间/ 的/ 大小/ 顺序/ 信息/ ./ 由于/ 定理/ 7/ 的/ 证明/ 过程/ 也/ 是/ 通过/ 寻找/ 两对/ 大小/ 关系/ 相反/ ,/ 且/ 均/ 满足条件/ 的/ θ/ 来/ 证明/ 的/ ,/ 所以/ 它们/ 的/ 大小/ 关系/ 判断/ 不会/ 受到/ 其它/ 检索/ 结果/ 之间/ 的/ 大小/ 关系/ 的/ 影响/ ./ 所以/ 方案/ SRQSAE/ 中/ 的/ 区间/ 陷门/ 是/ 检索/ 结果/ 安全/ 的/ ./ 综上/ ,/ 方案/ SRQSAE/ 中/ 的/ 区间/ 索引/ 的/ 安全性/ 可以/ 达到/ 排列/ 安全/ 的/ 要求/ ./ 根据/ 定理/ 6/ 和/ 定理/ 8/ ,/ 其/ 区间/ 陷门/ 不仅/ 可以/ 满足/ 区间/ 陷门/ 的/ 归并/ 特征/ 安全/ 的/ 需要/ ,/ 而且/ 对于/ 每次/ 检索/ ,/ 均/ 能/ 达到/ 区间/ 陷门/ 的/ 检索/ 结果/ 安全/ ./ 所以/ ,/ 方案/ SRQSAE/ 的/ 安全性/ 满足/ 了/ 区间/ 检索/ 的/ 唯/ 密文/ 安全/ 的/ 要求/ ./ 5/ 复杂性/ 分析/ 本/ 方案/ 是/ 针对/ 外/ 包/ 数据库/ (/ ODB/ )/ 和/ 云/ 存储/ (/ CloudStorage/ )/ 考虑/ 的/ ./ 由于/ 数据/ 外/ 包/ 主要/ 是/ 在/ DO/ 不/ 具备/ 强大/ 的/ 存储/ 能力/ 或/ DO/ 具有/ 可/ 移动/ 的/ 特点/ 的/ 情况/ 下/ 应用/ 的/ ,/ 所以/ 方案/ 的/ 复杂性/ 考虑/ 主要/ 集中/ 于/ 客户端/ 的/ 存储空间/ 复杂性/ 和/ 服务器/ 计算/ 时间/ 复杂性/ ./ 不妨/ 设/ 总/ 的/ 记录/ 数为/ n/ ./ 进行/ 方案/ 部署/ 时/ ,/ 如果/ 客户端/ 需要/ 存储/ 较/ 多/ 的/ 元/ 数据/ ,/ 那么/ 该/ 方案/ 的/ 布署/ 会/ 降低/ DO/ 的/ 可/ 移动性/ ,/ 降低/ 整个/ 方案/ 的/ 可用性/ ./ 本/ 方案/ 中/ ,/ 需要/ 在/ 客户端/ 存储/ 可逆/ 矩阵/ 犕/ 以及/ 外/ 包/ 数据/ 的/ 值域/ D/ ,/ 而/ 逆/ 矩阵/ 犕/ -/ 1/ 可以/ 通过/ 犕/ 计算/ 获得/ ,/ 所以/ 只/ 需要/ 获得/ 犕/ 和/ D/ ,/ 就/ 可以/ 计算/ 获得/ 密钥/ K/ =/ {/ 犕/ ,/ 犕/ -/ 1/ }/ 和/ D/ ./ 无论/ 外/ 包/ 数据/ 的/ 分布/ 规律/ 如何/ ,/ 该/ 方案/ 在/ 客户端/ 的/ 存储空间/ 复杂性/ 为/ O/ (/ 4r/ +/ r/ )/ =/ O/ (/ 1/ )/ ,/ r/ 为/ 犕/ 和/ D/ 中/ 每个/ 数据/ 需要/ 的/ 存储空间/ ./ 而/ 对于/ 每个/ 桶/ 内/ 均/ 有/ d/ 个/ 数据/ 的/ 分桶/ 方案/ 而言/ ,/ DO/ 需要/ 了解/ 每个/ 分桶/ 的/ 范围/ 以及/ 桶/ 标识/ ,/ 其/ 客户端/ 的/ 空间/ 复杂性/ 为/ O/ (/ tn/ // d/ )/ =/ O/ (/ n/ )/ ,/ t/ 为/ 客户端/ 保存/ 桶/ 的/ 信息/ 所/ 需要/ 的/ 空间/ ./ 编码方案/ 中/ ,/ 客户端/ 需要/ 保存/ 所有/ 数据/ 的/ 对应/ 的/ 长度/ 为/ Page10L/ 的/ 编码/ 以及/ 前缀/ 保序/ 加密/ 的/ 密钥/ ,/ 不妨/ 设/ B/ +/ 树/ 每层/ 均/ 有/ 一个/ flip/ 点/ ,/ 那么/ 密钥/ 的/ 存储空间/ 为/ slog2n/ ,/ s/ 为/ 密钥/ 的/ 长度/ ,/ 客户端/ 空间/ 复杂度/ 为/ Ο/ (/ Ln/ +/ slog2n/ )/ =/ Ο/ (/ n/ )/ ./ 服务器/ 的/ 计算/ 时间/ 主要/ 是/ 在/ 进行/ 密文/ 区间/ 检索/ 时/ 服务器/ 检索/ 花费/ 的/ 时间/ ,/ 其/ 体现/ 了/ 密文/ 区间/ 检索/ 方案/ 的/ 检索/ 效率/ ./ 本/ 方案/ 在/ 对/ 一个/ 区间/ 索引/ 进行/ 检索/ 时/ ,/ 无论/ 检索/ 区间/ 的/ 上/ 下界/ 为/ 多少/ ,/ 其/ 只/ 涉及/ 1/ ×/ 2/ 矩阵/ 和/ 2/ ×/ 1/ 矩阵/ 相乘/ 两次/ ,/ 数字/ 相乘/ 一次/ 和/ 比较/ 运算/ 一次/ ,/ 可以/ 归纳/ 为/ 五次/ 乘法/ 、/ 两次/ 加法/ 和/ 一次/ 比较/ 运算/ ./ 其/ 服务器/ 的/ 计算/ 复杂性/ 固定/ 为/ O/ (/ 5an/ +/ 2bn/ +/ cn/ )/ =/ O/ (/ n/ )/ ,/ 其中/ a/ 、/ b/ 、/ c/ 分别/ 是/ 乘法/ 、/ 加密/ 、/ 比较/ 运算/ 的/ 时间/ 代价/ ./ 而桶/ 内/ 数据/ 个数/ 恒定/ 的/ 方案/ 中/ ,/ 如果/ 不/ 对/ 区间/ 索引/ 进行/ 运行/ 时/ 优化/ 处理/ ,/ 最优/ 情况/ 是/ 检索/ 区间/ 只/ 覆盖/ 到/ 一个/ 分桶/ ,/ 其/ 计算/ 复杂性/ O/ (/ cn/ )/ =/ O/ (/ n/ )/ ;/ 最坏/ 的/ 情况/ 是/ 检索/ 区间/ 覆盖/ 所有/ 的/ 分桶/ ,/ 即/ n/ // d/ 个/ 分桶/ ,/ 其/ 计算/ 复杂性/ O/ (/ (/ n/ // d/ )/ cn/ )/ =/ O/ (/ n2/ )/ ./ 编码方案/ 中/ ,/ 最优/ 的/ 情况/ 是/ 检索/ 区间/ 只能/ 分解/ 出/ 一个/ 检索/ 子/ 区间/ ,/ 即/ O/ (/ cn/ )/ =/ O/ (/ n/ )/ ,/ 而/ 检索/ 区间/ 能/ 分解/ 出/ 的/ 检索/ 子/ 区间/ 的/ 上限/ 为/ 2/ (/ n/ -/ 1/ )/ ,/ 那么/ 对于/ 每个/ 区间/ 索引/ ,/ 均/ 需要/ 进行/ 2/ (/ n/ -/ 1/ )/ 次/ 匹配/ ,/ 服务器/ 的/ 计算/ 时间/ 复杂性/ O/ (/ 2/ (/ n/ -/ 1/ )/ cn/ )/ =/ O/ (/ n2/ )/ ./ 本/ 方案/ Ο/ (/ 1/ )/ Ο/ (/ n/ )/ Ο/ (/ n/ )/ 分桶/ 方案/ / Ο/ (/ n/ )/ Ο/ (/ n/ )/ Ο/ (/ n2/ )/ 编码方案/ Ο/ (/ n/ )/ Ο/ (/ n/ )/ Ο/ (/ n2/ )/ 注/ :/ 分析/ 上述/ 区间/ 索引/ 时/ ,/ 均/ 不/ 考虑/ 具体/ 实现/ 时/ 对/ 区间/ 索引/ 的/ 优化/ 处理/ ./ / 为了/ 简化/ 分析/ ,/ 选择/ 的/ 桶/ 的/ 划分/ 方式/ 为/ 每个/ 桶/ 包含/ 固定/ 数目/ 的/ 数据/ ./ 综述/ 所述/ ,/ 由表/ 1/ 可以/ 看到/ ,/ 本/ 方案/ 所/ 需要/ 客户端/ 的/ 元/ 数据/ 存储空间/ 不随/ 数据量/ 的/ 变化/ 而/ 变化/ ./ 在/ 检索/ 时/ ,/ 服务器/ 的/ 计算/ 复杂性/ 也/ 不/ 随/ 检索/ 区间/ 的/ 变化/ 而/ 变化/ ./ 所以/ ,/ 本/ 方案/ 中/ 客户端/ 的/ 空间/ 复杂性/ 和/ 服务器/ 的/ 时间/ 复杂性/ 维持/ 在/ 一个/ 定值/ 上/ ./ 与/ 现有/ 的/ 两个/ 方案/ 相比/ ,/ 不仅/ 需要/ 较少/ 的/ 客户端/ 元/ 数据/ 存储空间/ ,/ 且/ 在/ 最坏/ 情况/ 下/ ,/ 服务器/ 的/ 时间/ 复杂性/ 也/ 比较/ 有/ 优势/ ./ 6/ 结论/ 在/ 本文/ 中/ ,/ 我们/ 提出/ 了/ 一种/ 从/ 区间/ 判断/ 到/ 单/ 断言/ 的/ 转换方法/ ,/ 并/ 将/ 该/ 方法/ 应用/ 到/ 密文/ 区间/ 检索/ 方案/ 中/ ,/ 获得/ 了/ 基于/ 单/ 断言/ 的/ 密文/ 区间/ 检索/ 方案/ ./ 该/ 方案/ 使得/ 区间/ 陷门/ 的/ 构建/ 完全/ 基于/ 检索/ 区间/ 的/ 上/ 下界/ ,/ 避免/ 了/ 区间/ 陷门/ 泄露/ 归并/ 特征/ 的/ 安全隐患/ ,/ 并且/ 减少/ 了/ 客户端/ 元/ 数据/ 的/ 存储空间/ ./ 同时/ 针对/ 密文/ 区间/ 检索/ 的/ 特点/ ,/ 提出/ 了/ 相关/ 概念/ 来/ 定义/ 区间/ 索引/ 和/ 区间/ 陷门/ 的/ 安全/ ,/ 并/ 证明/ 本文/ 方案/ 满足/ 这些/ 安全/ 要求/ ./ 本文/ 的/ 密文/ 区间/ 检索/ 方案/ 获得/ 了/ 比/ 现有/ 方案/ 更/ 高/ 的/ 安全性/ ./ 不仅/ 保护/ 了/ 敏感数据/ 不/ 被/ 泄露/ ,/ 保护/ 了/ 敏感数据/ 的/ 大小/ 关系/ 等/ 信息/ ,/ 使得/ 该/ 方案/ 可以/ 满足/ 高/ 安全/ 的/ 密文/ 区间/ 检索/ 的/ 需要/ ./ 同时/ 该/ 方案/ 不差/ 于/ 现有/ 密文/ 区间/ 检索/ 的/ 检索/ 效率/ ,/ 使得/ 该/ 方案/ 具有/ 极大/ 的/ 应用/ 前景/ ./ 目前/ ,/ 本文/ 提出/ 的/ 密文/ 区间/ 检索/ 方案/ 限于/ 唯/ 密文/ 的/ 场景/ ,/ 对于/ 服务器/ 了解/ 敏感数据/ 相关/ 背景/ 或/ 服务器/ 了解/ 部分/ 索引/ 与/ 敏感数据/ 的/ 对应/ 关系/ 等/ 场景/ 均/ 未/ 涉及/ ,/ 这部分/ 研究/ 将/ 在/ 后续/ 工作/ 中/ 进行/ ./ 

