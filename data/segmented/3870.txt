Page1/ 基于/ 粗精调/ 技术/ 的/ 求解/ 带/ 平衡/ 约束/ 圆形/ Packing/ 问题/ 的/ 拟物/ 算法/ 何琨/ 莫旦/ 增许/ 如初/ 黄文奇/ (/ 华中科技大学/ 计算机科学/ 与/ 技术/ 学院/ 武汉/ 430074/ )/ 摘要/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ 是/ 以/ 卫星舱/ 布局/ 为/ 背景/ 的/ 具有/ NP/ 难度/ 的/ 布局/ 优化/ 问题/ ./ 文中/ 建立/ 了/ 此/ 问题/ 相应/ 的/ 数学模型/ ,/ 同时/ 提出/ 了/ 两个/ 新/ 的/ 物理/ 模型/ ,/ 并/ 受/ 工艺/ 加工过程/ 中/ “/ 粗/ 精加工/ ”/ 现象/ 的/ 启发/ ,/ 提出/ 了/ 基于/ 粗精调/ 技术/ 的/ 拟物/ 算法/ QPCFA/ ./ 该/ 算法/ 既/ 兼顾/ 了/ 搜索/ 空间/ 的/ 多样性/ 以利于/ 全局/ 搜索/ ,/ 又/ 能/ 对/ 有/ 前途/ 的/ 局部/ 区域/ 进行/ 精细/ 搜索/ 以/ 找到/ 相应/ 的/ 局部/ 最优/ 解/ ./ 同时/ ,/ 在/ 计算/ 过程/ 中/ 引入/ 禁忌/ 技术/ 和/ 跳/ 坑/ 策略/ ,/ 以/ 提高/ 算法/ 的/ 求解/ 质量/ ./ 对/ 国际/ 上/ 11/ 个/ 代表性/ 的/ 算例/ 进行/ 了/ 计算/ ,/ QPCFA/ 更新/ 了/ 其中/ 7/ 个算例/ 的/ 最好/ 记录/ ,/ 其余/ 4/ 个/ 与/ 目前/ 的/ 最好/ 记录/ 基本/ 持平/ ,/ 且/ 与/ 目前/ 的/ 最好/ 结果/ 相比/ 在/ 计算精度/ 上/ 均/ 有/ 较大/ 的/ 提高/ ./ 关键词/ Packing/ 问题/ ;/ 布局/ 优化/ ;/ 拟物/ ;/ 平衡/ 约束/ ;/ 粗精调/ 技术/ 1/ 引言/ 现实生活/ 中/ 存在/ 着/ 很多/ NP/ 难度/ 问题/ ,/ 如/ Pack/ -/ ing/ 问题/ 、/ SAT/ 问题/ 、/ Scheduling/ 问题/ 、/ Covering/ 问题/ 等/ ./ 这些/ 问题/ 看似/ 简单/ 且/ 很/ 容易/ 构造/ 其解/ 空间/ ,/ 但用/ 传统/ 的/ 穷举/ 策略/ 求解/ 时/ 往往/ 需要/ 指数/ 级/ 的/ 计算/ 时间/ ./ 随着/ 问题/ 规模/ 的/ 增大/ ,/ 用/ 传统/ 的/ 穷举/ 方法/ 显然/ 已/ 不/ 可行/ ./ 因此/ ,/ 人们/ 开始/ 向/ 生物/ 世界/ [/ 1/ -/ 2/ ]/ 、/ 物理/ 世界/ [/ 3/ -/ 5/ ]/ 和/ 人类/ 社会/ [/ 3/ -/ 4/ ,/ 6/ ]/ 寻求/ 灵感/ ,/ 从中/ 受到/ 启发/ 以/ 得到/ 求解/ 原始/ 问题/ 的/ 高效率/ 近似算法/ ./ 其中/ 拟物法/ [/ 3/ -/ 5/ ]/ 是/ 借助/ 物理/ 世界/ 的/ 知识/ 或/ 模拟/ 物理现象/ 来/ 求解/ 问题/ ,/ 通过/ 寻找/ 与/ 原始/ 数学/ 问题/ 等价/ 的/ 物理现象/ 并/ 观察/ 其中/ 物质/ 运动/ 的/ 生动/ 形象/ ,/ 从中/ 得到/ 启发/ 并/ 逐步/ 形式化/ 为/ 求解/ 原始/ 问题/ 的/ 确切/ 算法/ ./ 本文/ 拟/ 研究/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ ./ 该/ 问题/ 是/ 在/ 典型/ 的/ NP/ 难度/ 问题/ —/ —/ —/ 圆形/ Packing/ 问题/ 的/ 基础/ 上/ 又/ 增加/ 了/ 一项/ 静平衡/ (/ staticequilibri/ -/ um/ )/ 约束/ ,/ 是/ 一个/ 以带/ 自旋/ 的/ 返回式/ 卫星舱/ 中/ 的/ 设备/ 布局/ 问题/ 为/ 背景/ 的/ 全局/ 优化/ 问题/ ./ 相关/ 的/ 求解/ 算法/ 包括/ 改进/ 的/ 拟物/ 算法/ [/ 5/ ]/ 、/ 快速/ 局部/ 搜索算法/ [/ 7/ ]/ 、/ 改进/ 的/ 散射/ 搜索/ 法/ [/ 8/ ]/ 、/ 吸引/ 盘/ 填充/ 算法/ [/ 9/ ]/ 和/ 自/ 适应/ 粒子/ 群/ 优化/ 算法/ [/ 10/ ]/ 等/ ./ 本文/ 提出/ 了/ 一种/ 改进/ 的/ 拟物/ 方法/ ,/ 给出/ 了/ 嵌入/ 物体/ 的/ 一种/ 更/ 自然/ 、/ 更/ 合理/ 的/ 运动/ 方程/ ./ 然后/ ,/ 受/ 工艺/ 加工过程/ 中/ “/ 粗/ 精加工/ ”/ 现象/ 的/ 启发/ ,/ 将/ 拟物/ 方法/ 与/ 粗/ 精调/ 技术相结合/ ,/ 提出/ 了/ 一种/ 基于/ 粗精调/ 技术/ 的/ 改进型/ 拟物/ 算法/ (/ Quasi/ -/ physicalAlgorithmBasedonCoarseandFineAdjustment/ ,/ QPCFA/ )/ ./ 并且/ 通过/ 进一步/ 结合/ 禁忌/ 和/ 跳/ 坑/ 策略/ ,/ 使/ 所得/ 算法/ 既/ 具有/ 局部收敛/ 快/ 又/ 具有/ 全局/ 寻优/ 的/ 特点/ ./ 对/ 11/ 个/ 代表性/ 算例/ 的/ 实验/ 计算/ 表明/ ,/ QPCFA/ 算法/ 是/ 求解/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ 的/ 一种/ 高效/ 算法/ ./ 2/ 问题/ 的/ 定义/ 2.1/ 问题/ 描述/ 已知/ n/ 个/ 实心/ 圆饼/ (/ n/ 为/ 任意/ 给定/ 的/ 正整数/ )/ ,/ 其/ 半径/ Ri/ 、/ 质量/ mi/ 为/ 分别/ 任意/ 给定/ 的/ 正/ 实数/ (/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ ,/ 又/ 知/ 一个/ 小/ 的/ 正/ 实数/ δ/ r/ ,/ 要求/ 给出/ 这些/ 圆饼/ 的/ 一种/ 紧密/ 布局/ ,/ 使得/ 其/ 外/ 包络/ 圆/ 的/ 半径/ 尽可能/ 的/ 小/ ./ 要求/ 所/ 给/ 布局/ 满足/ 以下/ 3/ 个/ 约束/ :/ (/ 1/ )/ 各/ 圆饼/ 完全/ 在外/ 包络/ 圆内/ ,/ 不/ 超出/ 外/ 包络/ 圆/ 的/ 边界/ ;/ (/ 2/ )/ 任两/ 圆饼/ 间/ 互不/ 嵌入/ ,/ 即交/ 的/ 面积/ 为/ 0/ ;/ (/ 3/ )/ 这/ n/ 个/ 圆饼/ 的/ 整体/ 质心/ 与/ 外/ 包络/ 圆圆/ 心/ 的/ 距离/ 小于/ δ/ r/ ./ 在/ 实际/ 应用/ 中/ ,/ 所得/ 布局/ 对应/ 卫星舱/ 的/ 一个/ 横截面/ ./ 卫星舱/ 以外/ 包络/ 圆/ 的/ 圆心/ 为/ 轴/ ,/ 要求/ 给出/ 相关/ 设备/ 的/ 一种/ 布局/ ,/ 使得/ 卫星舱/ 的/ 半径/ 尽可能/ 的/ 小/ ,/ 以/ 减少/ 卫星/ 飞行/ 的/ 阻力/ ./ 同时/ ,/ 由于/ 卫星舱/ 是/ 带/ 自旋/ 的/ ,/ 而/ 当/ 旋转体/ 的/ 静/ 不平/ 衡量/ 即合/ 力矩/ 大于/ 零时/ ,/ 物体/ 的/ 转动/ 速度/ 就/ 不/ 可能/ 均匀/ ,/ 震动/ 、/ 发热/ 、/ 噪音/ 、/ 磨损/ 等/ 随之/ 产生/ ./ 因此/ ,/ 约束/ (/ 3/ )/ 要求/ n/ 个/ 圆饼/ 的/ 整体/ 质心/ 到/ 外/ 包络/ 圆圆/ 心/ 的/ 距离/ 小于/ 一个/ 小/ 的/ 正/ 实数/ δ/ r/ ,/ 从而/ 使得/ 自旋/ 时/ 所有/ 设备/ 产生/ 的/ 合/ 力矩/ 即静/ 不平/ 衡量/ 小于/ δ/ J/ =/ ∑/ n2/ ./ 2/ 问题/ 的/ 形式化/ 定义/ 如图/ 1/ 所示/ ,/ 在/ 二维/ 欧氏/ 空间/ 中/ 建立/ 笛卡尔/ 坐标系/ ,/ 设外/ 包络/ 圆圆/ 心/ 的/ 坐标/ 为/ (/ 0/ ,/ 0/ )/ ,/ 用/ (/ xi/ ,/ yi/ )/ 表示/ 圆饼/ i/ 的/ 圆心/ 坐标/ (/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ ,/ 则/ 此/ 问题/ 为求/ 一个/ 布局/ X/ =/ x1/ ,/ y1/ ,/ x2/ ,/ y2/ ,/ …/ ,/ xn/ ,/ y/ 足/ 以下/ 目标/ 和/ 约束/ :/ minR0/ =/ max/ (/ x2i/ +/ y2/ 槡/ i/ +/ Ri/ |/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ s/ ./ t/ ./ (/ 1/ )/ x2i/ +/ y2/ 槡/ i/ / R0/ -/ Ri/ ,/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ;/ (/ 2/ )/ xi/ -/ x/ (/ )/ j/ (/ 3/ )/ Rc/ =/ ∑/ n/ 其中/ R0/ 即为/ 待求/ 的/ 最小/ 外/ 包络/ 圆/ 的/ 半径/ ./ 约束/ (/ 1/ )/ 中/ ,/ x2i/ +/ y2/ 槡/ i/ 即为/ 圆饼/ i/ 之/ 圆心/ 到/ 原点/ 的/ 距离/ ;/ 当/ x2i/ +/ y2/ 槡/ i/ +/ Ri/ / R0/ 时/ ,/ 圆饼/ i/ 完全/ 落/ 在外/ 包络/ 圆内/ ./ 约束/ (/ 2/ )/ 中/ ,/ xi/ -/ x/ (/ )/ j/ 槡/ 之间/ 的/ 距离/ ;/ 当/ xi/ -/ x/ (/ )/ j/ 圆饼/ i/ 与/ 圆饼/ j/ 互不/ 嵌入/ ./ 设图/ 1/ 中/ c/ 点为/ n/ 个/ 圆饼/ 的/ 质心/ ,/ 则/ 约束/ (/ 3/ )/ 中/ ∑/ n/ ∑/ nmi/ 为/ 质点/ c/ 到/ 原点/ 的/ 距离/ Rc/ ;/ 当/ Rc/ </ δ/ r/ 时/ ,/ 对应/ 的/ 静/ 不平/ 衡量/ J/ =/ ∑/ n/ 中/ ,/ 取/ δ/ r/ 的/ 值/ 为/ 10/ -/ 12/ ./ i/ =/ 1Page32/ ./ 3/ 问题/ 的/ 简化/ 情形/ 上述/ 求/ 最小/ 外/ 包络/ 圆/ 半径/ R0/ 的/ 问题/ P/ 属于/ 优化/ 问题/ ./ 由于/ R0/ 未知/ ,/ 直接/ 求解/ 该/ 问题/ 有/ 一定/ 的/ 难度/ ./ 因此/ 可/ 考虑/ 先/ 求解/ 判定/ 形式/ 的/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ P/ ,/ 即/ 对/ 给定/ 的/ R0/ ,/ 要求/ 判定/ 是否/ 存在/ 一种/ 布局/ 满足/ 约束/ (/ 1/ )/ 、/ (/ 2/ )/ 和/ (/ 3/ )/ ;/ 若/ 回答/ 是/ ,/ 则/ 给出/ 相应/ 的/ 布局/ ./ 若/ 问题/ P/ 能够/ 得到/ 有效/ 的/ 解决/ ,/ 那么/ 再/ 结合/ 二分法/ 即可/ 求解/ 问题/ P/ ./ 具体/ 过程/ 如下/ :/ 1/ ./ 设定/ 一个/ 较/ 小/ 的/ 外/ 包络/ 圆/ 半径/ Rlow0/ (/ 例如/ Rlow0/ 为/ 某/ 一圆/ 的/ 半径/ ,/ 使得/ 该/ 圆/ 的/ 面积/ 与/ 所有/ 圆饼/ 的/ 面积/ 和/ 相等/ )/ ,/ 使得/ 这/ n/ 个/ 圆饼/ 明显/ 放不下/ ;/ 再/ 设定/ 一个/ 较大/ 的/ 外/ 包络/ 圆/ 半径/ Rhigh0/ (/ 例如/ Rhigh0/ 为/ 所有/ 圆饼/ 半径/ 的/ 和/ )/ ,/ 使得/ 这/ n/ 个/ 圆饼/ 明显/ 放得/ 下/ ./ 2/ ./ 选择/ 二分点/ Rmid0/ =/ Rhigh0/ +/ Rlow/ (/ )/ 0/ // 2/ ,/ 令/ R0/ =/ Rmid0/ ,/ 连续/ 求解/ 问题/ P/ 多次/ (/ 本文/ 为/ 5/ 次/ )/ ./ 若/ 至少/ 有/ 一次/ 回答/ 为/ 是/ ,/ 则/ 修改/ Rhigh0/ 为/ Rmid0/ ,/ Rlow0/ 不变/ ;/ 否则/ 修改/ Rlow0/ 为/ Rmid0/ ,/ Rhigh0/ 不变/ ./ 3/ ./ 重复/ 步/ 2/ ,/ 直至/ Rlow0/ 与/ Rhigh0/ 充分/ 接近/ (/ 例如/ 两者/ 之差/ 小于/ 10/ -/ 6/ )/ ,/ 则/ Rhigh0/ 即为/ 原始/ 问题/ P/ 的/ 解/ ./ 3/ 问题/ 犘/ 对应/ 的/ 物理/ 模型/ 本/ 节/ 给出/ 问题/ P/ 对应/ 的/ 物理/ 模型/ ./ 3.1/ 弹力/ 模型/ 将/ 外/ 包络/ 圆/ 之/ 边界/ 及其/ 外部/ 全部/ 点/ 所/ 构成/ 的/ 集合/ 视为/ 物体/ 0/ ,/ 将/ 圆饼/ i/ (/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ 视为/ 物体/ i/ ./ 物体/ 0/ 为/ 一个/ 圆形/ 的/ 空腔/ ,/ 物体/ i/ (/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ 视为/ 一/ 弹性/ 实体/ ,/ 则/ 所有/ 物体/ 形成/ 一个/ 体系/ ./ 下面/ 给出/ 该/ 体系/ 中/ 若干/ 概念/ 的/ 定义/ ./ 定义/ 1/ ./ 格局/ ./ 在/ 任一/ 时刻/ ,/ 称/ 圆饼/ 集合/ S/ =/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ 中/ 各/ 圆饼/ 的/ 圆心/ 坐标/ 所/ 形成/ 的/ 2n/ 元组/ X/ =/ x1/ ,/ y1/ ,/ x2/ ,/ y2/ ,/ …/ ,/ xn/ ,/ y/ (/ 定义/ 2/ ./ 嵌入/ 深度/ Dij/ ./ 若任/ 两/ 物体/ 相交/ 的/ 面积/ 大于/ 0/ ,/ 则/ 相互之间/ 形成/ 嵌入/ ./ 用/ Dij/ 表示/ 物体/ i/ 与/ 物体/ j/ 之间/ 的/ 嵌入/ 深度/ ,/ 如式/ (/ 1/ )/ 所示/ ./ 烄/ Dij/ =/ 烅/ 烆/ Dij/ (/ j/ ≠/ 0/ )/ 如图/ 2/ 所示/ ,/ Dij/ (/ j/ =/ 0/ )/ 如图/ 3/ 所示/ ,/ 可见/ Dij/ =/ Dji/ ./ 文献/ [/ 3/ -/ 4/ ]/ 中/ ,/ 根据/ 此/ 嵌入/ 深度/ 的/ 定义/ 使/ 物体/ i/ 、/ j/ 之间/ 产生/ 相应/ 的/ 弹性力/ 的/ 作用/ ./ 当/ i/ 、/ j/ 均/ 为/ 圆饼/ 时/ ,/ 两者/ 在/ 弹性力/ 的/ 作用/ 下/ 相互/ 弹开/ 并/ 移动/ 相/ Page4/ 等/ 的/ 距离/ ./ 在/ 本文/ 中/ ,/ 通过/ 进一步/ 地/ 观察/ ,/ 我们/ 发现/ 大小/ 不同/ 的/ 两/ 弹性/ 物体/ 在/ 发生/ 挤压/ 的/ 情况/ 下/ 所/ 产生/ 的/ 形变/ 是/ 不同/ 的/ ./ 一般来说/ ,/ 大/ 圆饼/ 产生/ 的/ 形变/ 要/ 小于/ 小/ 圆饼/ 产生/ 的/ 形变/ ./ 因此/ ,/ 本文/ 进一步/ 给出/ 形变/ 度/ 的/ 定义/ ./ 定义/ 3/ ./ 形变/ 度/ dij/ ./ 用/ dij/ 表示/ 物体/ i/ 因/ 与/ 物体/ j/ 相/ 嵌入/ 而/ 产生/ 的/ 形变/ 度/ ./ (/ 1/ )/ 当/ i/ ,/ j/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ,/ 即均/ 为/ 圆饼/ 时/ ,/ dij/ (/ i/ ≠/ j/ )/ 如式/ (/ 2/ )/ 所示/ :/ 烄/ Ri/ +/ λ/ xk/ -/ x/ (/ )/ i2/ +/ yk/ -/ y/ (/ )/ ixi/ -/ x/ (/ )/ jRi/ -/ Rj/ -/ xi/ -/ x/ (/ )/ jdij/ =/ 烅/ xi/ -/ x/ (/ )/ j2Ri/ ,/ xi/ -/ x/ (/ )/ j0/ ,/ 烆/ 否则/ xk/ -/ x/ (/ )/ i/ ·/ xk/ -/ x/ (/ )/ j/ +/ yk/ -/ y/ (/ )/ i/ ·/ yk/ -/ y/ (/ )/ jxk/ -/ x/ (/ )/ i/ ·/ xk/ -/ x/ (/ )/ j/ +/ yk/ -/ y/ (/ )/ i/ ·/ yk/ -/ y/ (/ )/ j/ 如图/ 2/ 中/ ,/ 当/ 两/ 圆饼/ 未/ 完全/ 嵌入/ 时/ (/ 即/ 其中/ ,/ λ/ =/ xi/ -/ x/ (/ )/ j/ 槡/ 线/ 之/ 交点/ 为/ a/ 、/ b/ ,/ 令/ 两/ 圆饼/ 圆心/ 之/ 连线/ 与/ 线段/ ab/ 的/ 交点/ 为/ Pij/ (/ xk/ ,/ yk/ )/ ,/ 若点/ Pij/ 在/ 两/ 圆心/ 之间/ ,/ 则/ λ/ 为/ -/ 1/ ,/ 否则/ 为/ 1/ ,/ dij/ 和/ dji/ 如图/ 2/ (/ a/ )/ 中/ 所示/ ;/ 当/ j/ 完全/ 嵌入/ 到/ i/ 内时/ (/ 即/ xi/ -/ x/ (/ )/ jRj/ )/ ,/ dij/ 和/ dji/ 如图/ 2/ (/ b/ )/ 中/ 所示/ ./ (/ 2/ )/ 当/ j/ =/ 0/ ,/ 即/ 物体/ j/ 为/ 空腔/ 时/ ,/ di0/ (/ i/ ≠/ 0/ )/ 如式/ (/ 3/ )/ 所示/ :/ di0/ =/ x2i/ +/ y2/ 槡/ i/ +/ Ri/ -/ R0/ ,/ x2i/ +/ y2/ 槡/ i/ +/ Ri/ >/ R0/ 当/ i/ 与/ 物体/ 0/ 嵌入/ 时/ ,/ 则/ di0/ 如图/ 3/ 所示/ ./ 可见/ Dij/ =/ dij/ +/ dji/ ./ 当/ Ri/ >/ Rj/ (/ i/ ,/ j/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ 时/ ,/ dij/ </ dji/ ;/ 当/ j/ =/ 0/ 时/ ,/ 由于/ 物体/ 0/ 为/ 刚体/ ,/ 不/ 产生/ 形变/ ,/ 则/ di0/ =/ Di0/ ,/ d0i/ =/ 0/ ./ 当/ 弹性/ 物体/ 因/ 受到/ 挤压/ 而/ 产生/ 形变/ 时/ ,/ 在/ 弹性力/ 的/ 作用/ 下/ 有/ 恢复/ 自己/ 原形/ 的/ 趋势/ ./ 因此/ ,/ 我们/ 给出/ 弹性力/ 的/ 定义/ ,/ 使拟物/ 模型/ 中/ 物体/ 在/ 此/ 弹性力/ 的/ 作用/ 下/ 做/ 一系列/ 运动/ ./ 定义/ 4/ ./ 弹性力/ 犉/ 弹/ ij/ ./ 用/ 犉/ 弹/ ij/ 表示/ 物体/ i/ 因/ 与/ 物体/ j/ 相/ 嵌入/ 而/ 受到/ 的/ 弹性力/ ,/ 则/ 犉/ 弹/ ij/ 如式/ (/ 4/ )/ 所示/ :/ 犉/ 弹/ ij/ =/ k/ 弹/ ·/ dij/ ·/ 狉/ ij/ 狉/ ij/ 其中/ ,/ k/ 弹为/ 相应/ 的/ 倔强/ 系数/ ;/ dij/ 为/ 形变/ 度/ ;/ 狉/ ij/ 如式/ (/ 5/ )/ 所示/ ,/ 当/ i/ ,/ j/ 均/ 为/ 圆饼/ 时/ ,/ 狉/ ij/ 表示/ 圆饼/ j/ 的/ 圆心/ 指向/ 圆饼/ i/ 的/ 圆心/ 之/ 向量/ ;/ 当/ 其中/ 之一/ 例如/ j/ 为/ 空腔/ 时/ ,/ 狉/ ij/ 表示/ 圆饼/ i/ 的/ 圆心/ 指向/ 空腔/ 圆心/ 的/ 向量/ ./ 犉/ 弹/ ij/ (/ j/ ≠/ 0/ )/ 如图/ 2/ 所示/ ,/ 犉/ 弹/ ij/ (/ j/ =/ 0/ )/ 如图/ 3/ 定义/ 5/ ./ 弹性/ 合力/ 犉/ 弹/ i/ ./ 物体/ i/ 受到/ 的/ 弹性/ 合/ 所示/ ./ 力/ 犉/ 弹/ i/ 如式/ (/ 6/ )/ 所示/ :/ 于/ 它们/ 之间/ 嵌入/ 深度/ 的/ 平方/ ./ Uij/ 如式/ (/ 7/ )/ 所示/ :/ 根据/ 弹性/ 力学/ ,/ 二/ 弹性/ 物体/ 间/ 的/ 弹性/ 势能/ 正比/ 定义/ 6/ ./ 弹性/ 势能/ Uij/ ./ 物体/ i/ 、/ j/ 间/ 的/ 弹性/ 势能/ Uij/ =/ k/ 弹/ ·/ D2ij/ ,/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ n/ }/ ,/ i/ ≠/ j/ (/ 7/ )/ 定义/ 7/ ./ 总/ 弹性/ 势能/ U/ 弹/ (/ X/ )/ ./ 对/ 给定/ 的/ 格局/ X/ ,/ 整个/ 体系/ 的/ 总/ 弹性/ 势能/ U/ 弹/ (/ X/ )/ 如式/ (/ 8/ )/ 所示/ :/ 当/ U/ 弹/ (/ X/ )/ =/ 0/ 时/ ,/ 任两/ 物体/ 间/ 均/ 无/ 嵌入/ ,/ 对应/ 将/ 圆饼/ 集合/ S/ 视为/ 其/ 质心/ 处/ 的/ 一个点/ c/ ,/ 其质/ 格局/ X/ 满足/ 问题/ 的/ 约束/ (/ 1/ )/ 和/ (/ 2/ )/ ./ 3.2/ 拉力/ 模型/ 量/ 为/ ∑/ n/ 皮筋/ 相连/ ./ 当/ 两点/ 间/ 的/ 距离/ 大于/ 0/ 时/ ,/ 点/ c/ 受到/ 橡皮筋/ 的/ 拉力/ ./ 下面/ 给出/ 相关/ 概念/ 的/ 定义/ ./ 定义/ 8/ ./ 质心/ 坐标/ (/ 珚/ X/ ,/ 珡/ Y/ )/ ./ 质心/ 的/ 坐标/ (/ 珚/ X/ ,/ 珡/ Y/ )/ 如式/ (/ 9/ )/ 所示/ :/ i/ =/ 1/ 定义/ 9/ ./ 拉力/ 犉/ 拉/ ./ 当/ 质心/ 坐标/ 与/ 原点/ 不/ 重合/ 时/ ,/ 质心/ 受到/ 的/ 拉力/ 犉/ 拉/ 如式/ (/ 10/ )/ 所示/ :/ 其中/ k/ 拉为/ 该/ 橡皮筋/ 的/ 倔强/ 系数/ ,/ 这里/ 假设/ 橡皮筋/ 很/ 紧/ ,/ 在/ 微小/ 的/ 形变/ 下/ 其/ 拉力/ 的/ 大小/ 不变/ ./ 定义/ 10/ ./ 偏移/ 势能/ U/ 拉/ (/ X/ )/ ./ 由于/ 质心/ 与/ 空腔/ 圆心/ 不/ 重合/ ,/ 而/ 产生/ 的/ 偏移/ 势能/ U/ 拉/ (/ X/ )/ 如式/ (/ 11/ )/ 所示/ :/ 当/ U/ 拉/ (/ X/ )/ </ k/ 拉/ ·/ δ/ r/ 时/ ,/ 对应/ 格局/ X/ 中/ 质心/ 与/ 原点/ 的/ 距离/ 满足/ 问题/ 的/ 约束/ (/ 3/ )/ ./ Page5/ 将/ 上述/ 两个/ 物理/ 模型/ 相结合/ ,/ 即可/ 得出/ 一个/ 综/ 定义/ 11/ ./ 总体/ 势能/ U/ 总/ (/ X/ )/ ./ 对/ 给定/ 格局/ X/ ,/ 当/ U/ 总/ (/ X/ )/ =/ 0/ 时/ ,/ 对应/ 格局/ X/ 同时/ 满足/ 问题/ 的/ 3.3/ 综合/ 模型/ 合/ 的/ 物理/ 模型/ ,/ 其/ 总体/ 势能/ U/ 总/ (/ X/ )/ 的/ 定义/ 如下/ ./ 定义/ 其/ 总体/ 势能/ U/ 总/ (/ X/ )/ =/ U/ 弹/ (/ X/ )/ +/ U/ 拉/ (/ X/ )/ ./ 3/ 个/ 约束/ ./ 4/ 算法/ 描述/ 基于/ 上述/ 物理/ 模型/ ,/ 对/ 问题/ P/ ,/ 其拟物/ 求解/ 的/ 基本思路/ 是/ :/ 首先/ ,/ 随机/ 生成/ 一个/ 格局/ ;/ 然后/ ,/ 让/ 该/ 格局/ 中/ 的/ 诸/ 圆饼/ 在/ 弹性力/ 和/ 拉力/ 的/ 作用/ 下/ 做/ 一系列/ 的/ 运动/ ;/ 若/ 运动/ 终止/ 时/ 相应/ 格局/ 的/ 总体/ 势能/ 为/ 0/ ,/ 则/ 得到/ 一个/ 合法/ 的/ 解/ 格局/ (/ 但/ 在/ 实际/ 计算/ 中/ ,/ 由于/ 电子计算机/ 的/ 精度/ 有限/ ,/ 不/ 可能/ 使/ 势能/ 严格/ 为/ 0/ ,/ 所以/ ,/ 我们/ 约定/ 总体/ 势能/ 小于/ 10/ -/ 20/ 即可/ 成功/ 停机/ )/ ;/ 否则/ ,/ 采用/ 跳坑/ 策略/ ,/ 以/ 生成/ 一个/ 新格局/ ,/ 再/ 进入/ 下/ 一轮/ 的/ 拟物/ 迭代/ 过程/ ./ 在/ 拟物/ 过程/ 中/ ,/ 为了/ 不/ 在/ 局部/ 最小值/ 点/ 的/ 附近/ 花费/ 过多/ 的/ 时间/ ,/ 又/ 不/ 轻易/ 错过/ 有/ 前景/ 的/ 格局/ (/ 即此/ 格局/ 有/ 可能/ 达到/ 全局/ 最小值/ 点/ )/ ,/ 我们/ 将/ 拟物/ 算法/ 分成/ 粗/ 调和/ 精调/ 两个/ 阶段/ ./ 若/ 当前/ 格局/ X/ 的/ 总体/ 势能/ 较大/ ,/ 则/ 进行/ 粗调/ ,/ 主要/ 考虑/ 诸/ 圆饼/ 在/ 弹性力/ 作用/ 下/ 的/ 运动/ ,/ 偶尔/ 考虑/ 空腔/ 圆心/ 对/ 圆饼/ 整体/ 质心/ 的/ 拉力/ 作用/ ,/ 从而/ 较/ 快/ 地/ 得到/ 一个/ 基本/ 无/ 嵌入/ 的/ 新格局/ ./ 若该/ 格局/ 的/ 总体/ 势能/ 较大/ ,/ 则/ 进行/ 跳坑/ 以/ 搜索/ 不同/ 的/ 区域/ ./ 只有/ 在/ 粗调/ 过程/ 中/ 找到/ 了/ 一个/ 总体/ 势能/ 较/ 小/ 的/ 格局/ X/ 后/ ,/ 才/ 进入/ 精调/ 阶段/ ,/ 在/ 圆饼/ 的/ 每/ 一步/ 运动/ 中/ 同时/ 考虑/ 弹性力/ 和/ 拉力/ 的/ 作用/ ,/ 从而/ 在/ 格局/ X/ 的/ 附近/ 精确/ 地/ 找到/ 一个/ 势能/ 最小/ 的/ 格局/ X/ ./ 下面/ 给出/ 实际/ 计算/ 中/ 涉及/ 到/ 的/ 若干/ 概念/ 的/ 定义/ 、/ 粗精调/ 算法/ A1/ 和/ 精调/ 算法/ A2/ 两个/ 子/ 算法/ 以及/ 具体/ 的/ 跳/ 坑/ 策略/ ./ 4.1/ 相关/ 概念/ 的/ 定义/ 在/ 当前/ 时刻/ ,/ 可/ 通过/ 执行/ 一个/ 动作/ 而/ 进入/ 下/ 一/ 时刻/ ./ 以下/ 给出/ 3/ 种/ 动作/ 的/ 定义/ ./ 定义/ 12/ ./ 动作/ 1/ ./ 在/ t/ 时刻/ ,/ 若/ 诸/ 圆饼/ 在/ 所/ 受/ 弹性/ 合力/ 的/ 作用/ 下/ 按/ 运动/ 方程/ (/ 12/ )/ 移动/ 一步/ ,/ 则/ 称此/ 运动/ 过程/ 为/ 动作/ 1/ ./ 狉/ (/ t/ +/ 1/ )/ i/ 表示/ t/ 时刻/ 圆饼/ i/ 的/ 位置/ ;/ h/ 弹为/ 弹性/ 合力/ 其中/ ,/ 狉/ (/ t/ )/ 作用/ 下/ 的/ 移动/ 步长/ ./ 定义/ 13/ ./ 动作/ 2/ ./ 在/ t/ 时刻/ ,/ 若/ 诸/ 圆饼/ 在/ 拉力/ 的/ 作用力/ 下/ 按/ 运动/ 方程/ (/ 13/ )/ 移动/ 一步/ ,/ 则/ 称此/ 运动/ 过程/ 为/ 动作/ 2/ ./ 狉/ (/ t/ +/ 1/ )/ 其中/ h/ 拉为/ 拉力/ 作用/ 下/ 的/ 移动/ 步长/ ./ 定义/ 14/ ./ 动作/ 3/ ./ 在/ t/ 时刻/ ,/ 若/ 诸/ 圆饼/ 在/ 所/ 受/ 弹性/ 合力/ 和/ 拉力/ 的/ 共同/ 作用/ 下/ 按/ 运动/ 方程/ (/ 14/ )/ 移动/ 一步/ ,/ 则/ 称此/ 运动/ 过程/ 为/ 动作/ 3/ ./ 狉/ (/ t/ +/ 1/ )/ i/ =/ 狉/ (/ t/ )/ 另外/ ,/ 在/ 实际/ 的/ 计算/ 过程/ 中/ ,/ 往往/ 会/ 碰到/ “/ 卡壳/ ”/ 的/ 情形/ ,/ 即/ 计算/ 落入/ 局部/ 极小值/ 点/ 的/ 陷阱/ ,/ 对此/ 我们/ 给出/ 卡壳/ 格局/ 的/ 定义/ 和/ 相应/ 的/ 判断/ 方法/ ./ 定义/ 15/ ./ 卡壳/ 格局/ ./ 若/ 当前/ 格局/ 中/ ,/ 各/ 物体/ 受到/ 的/ 弹性/ 合力/ 为/ 0/ ,/ 但/ 它们/ 之间/ 仍/ 存在/ 嵌入/ ,/ 即/ 整个/ 体系/ 的/ 弹性/ 势能/ 大于/ 0/ ,/ 则/ 称此/ 格局/ 为/ 卡壳/ 格局/ ./ 在/ 实际/ 计算/ 时/ ,/ 由于/ 在/ 每个/ 格局/ 中均/ 计算/ 每个/ 物体/ 的/ 弹性/ 合力/ 的/ 大小/ 较为/ 耗时/ ,/ 本文/ 采用/ 弹性/ 势能/ 的/ 下降/ 比/ 来/ 判断/ 一个/ 格局/ 是否/ 卡壳/ ./ 具体/ 过程/ 为/ :/ 从/ 格局/ X/ 出发/ ,/ 各/ 圆饼/ 在/ 弹性力/ 的/ 作用/ 下/ 经过/ 多个/ 动作/ (/ 例如/ 200/ 个/ )/ 后/ 形成/ 格局/ X/ ,/ 若/ |/ U/ 弹/ (/ X/ )/ -/ U/ 弹/ (/ X/ )/ |/ // U/ 弹/ (/ X/ )/ </ 10/ -/ 4/ ,/ 即/ 格局/ X/ 经过/ 多个/ 动作/ 后/ ,/ 其/ 总/ 弹性/ 势能/ 几乎/ 没有/ 变化/ ,/ 则/ 认为/ 格局/ X/ 为/ 一个/ 卡壳/ 格局/ ./ 4.2/ 粗精调/ 算法/ 犃/ 1/ 粗精调/ 算法/ 的/ 流程/ 如图/ 4/ 所示/ ./ 对/ 一个/ 给定/ 的/ 格局/ X/ ,/ 若此/ 格局/ 的/ 总/ 势能/ U/ 总/ (/ X/ )/ 满足要求/ ,/ 则/ 粗/ 精调/ 算法/ 成功/ 退出/ ;/ 否则/ 判断/ 其/ 弹性/ 势能/ 是否/ 足够/ 小/ (/ 小于/ 10/ -/ 10/ )/ ,/ 即/ 判断/ 各/ 物体/ 间/ 的/ 嵌入/ 大小/ ./ 若/ Page6U/ 弹/ (/ X/ )/ / 10/ -/ 10/ ,/ 即/ 认为/ 各/ 物体/ 间/ 嵌入/ 较/ 多/ ,/ 则/ 只/ 进行/ 拟物/ 下降/ ,/ 即/ 各/ 圆饼/ 做/ 动作/ 1/ ,/ 并/ 根据/ 弹性/ 势能/ 的/ 变化/ 调整/ 步长/ h/ 弹/ ,/ 拟物/ 下降/ 过程/ 直到/ 其/ 弹性/ 势能/ 小于/ 10/ -/ 10/ 或/ 拟物/ 下降/ 失效/ (/ 格局/ 处于/ 卡壳/ 状态/ 或/ 步长/ 足够/ 小/ 称为/ 拟物/ 下降/ 失效/ )/ 而/ 结束/ ;/ 否则/ 认为/ 格局/ X/ 中/ 各/ 物体/ 间/ 的/ 嵌入/ 较/ 少/ ,/ 此时/ 判断/ 格局/ 是否/ 达到/ 精调/ 要求/ ,/ 即/ 判断/ U/ 总/ (/ X/ )/ 是否/ 小于/ 10/ -/ 10/ ./ 若/ U/ 总/ (/ X/ )/ </ 10/ -/ 10/ ,/ 则/ 已/ 达到/ 精调/ 要求/ ,/ 调用/ 精调/ 算法/ A2/ ;/ 否则/ 执行/ 与/ 拟物/ 下降/ 失效/ 或/ 卡壳/ 后/ 相同/ 的/ 操作/ ,/ 即/ 各/ 圆饼/ 在/ 拉力/ 的/ 作用/ 下/ 移动/ 一步/ ,/ 即/ 做/ 动作/ 2/ ,/ 并/ 根据/ 偏移/ 势能/ 的/ 变化/ 调整/ 步长/ h/ 拉/ ,/ 此时/ 便/ 完成/ 一次/ 完整/ 的/ 迭代/ ,/ 即/ 迭代/ 步数/ 加/ 1/ ./ 若/ 迭代/ 步数/ 达到/ 上限/ ,/ 则/ 粗/ 精调/ 算法/ 失败/ 退出/ ,/ 否则/ 开始/ 下/ 一轮/ 的/ 迭代/ ./ 粗精调/ 算法/ A1/ 的/ 伪/ 代码/ 如下/ ./ ProcedureA1/ (/ X/ ,/ count/ )/ 输入/ :/ 格局/ X/ ,/ 迭代/ 步数/ 上限/ count/ 输出/ :/ 粗调/ 结束/ 后/ 的/ 格局/ X1/ ./ 迭代/ 步数/ j/ =/ 0/ ,/ 时刻/ t/ =/ 0/ ;/ 2/ ./ do/ {/ 3/ ./ 计算/ 总/ 势能/ U/ 总/ (/ X/ )/ ;/ 4/ ./ if/ (/ U/ 总/ (/ X/ )/ </ 10/ -/ 20/ )/ 5/ ./ 返回/ 格局/ X/ ,/ 成功/ 退出/ ;/ 6/ ./ else/ {/ 7/ ./ 保存/ U/ 拉/ old/ =/ U/ 拉/ (/ X/ )/ ;/ 8/ ./ while/ (/ U/ 弹/ / 10/ -/ 10/ )/ {/ 9/ ./ 计算/ t/ 时刻/ 每个/ 圆饼/ 所受/ 的/ 弹性/ 合力/ ,/ 执行/ 动作/ 1/ ,/ 10/ ./ 得到/ 新格局/ X/ ;/ 11/ ./ t/ =/ t/ +/ 1/ ;/ 12/ ./ if/ (/ U/ 弹/ (/ X/ )/ >/ U/ 弹/ (/ X/ )/ )/ 13/ ./ 调整/ 步长/ h/ 弹/ =/ h/ 弹/ ·/ 0.75/ ;/ 14/ ./ X/ =/ X/ ;/ 15/ ./ if/ (/ 卡壳/ orh/ 弹/ </ 10/ -/ 7/ )/ 16/ ./ break/ ;/ 17/ ./ }/ // // while18/ ./ if/ (/ U/ 总/ </ 10/ -/ 10/ )/ 19/ ./ 调用/ A2/ (/ X/ )/ ;/ 20/ ./ else/ {/ 20/ ./ 计算/ t/ 时刻/ 整个/ 体系/ 的/ 拉力/ ,/ 执行/ 动作/ 2/ ,/ 21/ ./ 得到/ 新格局/ X/ ;/ 22/ ./ t/ =/ t/ +/ 1/ ;/ 23/ ./ if/ (/ U/ 拉/ (/ X/ )/ >/ U/ 拉/ old/ )/ 24/ ./ 调整/ 步长/ h/ 拉/ =/ h/ 拉/ ·/ 0.4/ ;/ 25/ ./ X/ =/ X/ ;/ 26/ ./ }/ // // endifU/ 总/ (/ X/ )/ </ 10/ -/ 1027/ ./ }/ // // endifU/ 总/ (/ X/ )/ </ 10/ -/ 2028/ ./ j/ =/ j/ +/ 1/ ;/ 29/ ./ }/ while/ (/ j/ </ count/ )/ ;/ EndProcedure4/ ./ 3/ 粗精调/ 算法/ 犃/ 2/ 当/ U/ 总/ (/ X/ )/ </ 10/ -/ 10/ 即/ 当前/ 格局/ X/ 已/ 落入/ 一个/ 前景/ 较/ 好/ 的/ 区域/ 时/ ,/ 则/ 运行/ 精调/ 算法/ A2/ ./ 其/ 基本/ 流程/ 如图/ 5/ 所示/ ./ 若/ 偏移/ 势能/ U/ 拉/ (/ X/ )/ </ k/ 拉/ ·/ δ/ r/ 即/ 已/ 满足/ 静/ 不/ 平衡/ 约束/ 时/ ,/ 各/ 圆饼/ 只/ 在/ 弹性力/ 的/ 作用/ 下/ 运动/ (/ 即/ 做/ 动作/ 1/ )/ ,/ 否则/ 在/ 弹性力/ 和/ 拉力/ 的/ 合力/ 作用/ 下/ 运动/ (/ 即/ 做/ 动作/ 3/ )/ ./ 若/ U/ 总/ (/ X/ )/ </ 10/ -/ 18/ 即/ 认为/ 计算/ 接近/ 全局/ 最小值/ 点/ ,/ 则/ 不再/ 判断/ 格局/ 是否/ 会/ 卡壳/ ./ 重复/ 此/ 计算/ 过程/ ,/ 直至/ 总/ 势能/ U/ 总/ (/ X/ )/ </ 10/ -/ 20/ 成功/ 退出/ ,/ 或者/ 拟物/ 下降/ 法已/ 失效/ (/ 即/ 格局/ 卡壳/ 或/ 弹性力/ 移动/ 步长/ 足够/ 小/ )/ ,/ 失败/ 退出/ ./ 精调/ 算法/ A2/ 的/ 伪/ 代码/ 如下/ ./ ProcedureA2/ (/ X/ )/ 输入/ :/ 格局/ X/ 输出/ :/ 精调/ 结束/ 后/ 的/ 格局/ X1/ ./ 时刻/ t/ =/ 0/ ,/ 初始化/ 移动/ 步长/ h/ 弹/ ,/ h/ 拉/ ;/ 2/ ./ do/ {/ 3/ ./ if/ (/ U/ 拉/ (/ X/ )/ </ k/ 拉/ ·/ δ/ r/ )/ {/ 4/ ./ 计算/ t/ 时刻/ 每个/ 圆饼/ 所受/ 的/ 弹性/ 合力/ ,/ 执行/ 动作/ 1/ ,/ 5/ ./ 得到/ 新格局/ X/ ;/ 6/ ./ if/ (/ U/ 弹/ (/ )/ X/ >/ U/ 弹/ (/ X/ )/ )/ 7/ ./ 调整/ 步长/ h/ 弹/ =/ h/ 弹/ ·/ 0.75/ ;/ 8/ ./ }/ else/ {/ 9/ ./ 计算/ t/ 时刻/ 每个/ 圆饼/ 所受/ 的/ 弹性/ 合力/ 和/ 整个/ 体系/ 的/ 10/ ./ 拉力/ ,/ 执行/ 动作/ 3/ ,/ 得到/ 新格局/ X/ ;/ 11/ ./ }/ // // endifPage712/ ./ t/ =/ t/ +/ 1/ ,/ X/ =/ X/ ;/ 13/ ./ 计算/ 总/ 势能/ U/ 总/ (/ X/ )/ ;/ 14/ ./ if/ (/ U/ 总/ (/ X/ )/ </ 10/ -/ 20/ )/ {/ 15/ ./ 返回/ 格局/ X/ ,/ 成功/ 退出/ ;/ 16/ ./ }/ elseif/ (/ U/ 总/ (/ X/ )/ / 10/ -/ 18/ )/ {/ 17/ ./ if/ (/ 卡壳/ )/ 18/ ./ 返回/ 当前/ 格局/ X/ ,/ 失败/ 退出/ ;/ 19/ ./ }/ 20/ ./ if/ (/ h/ </ 10/ -/ 7/ )/ 21/ ./ 返回/ 当前/ 格局/ X/ ,/ 失败/ 退出/ ;/ 22/ ./ }/ while/ (/ 1/ )/ ;/ EndProcedure4/ ./ 4/ 基于/ 禁忌/ 技术/ 的/ 跳/ 坑/ 策略/ 当/ 粗/ 精调/ 算法/ A1/ 陷入/ 局部/ 极小值/ 点/ 的/ 陷阱/ 时/ ,/ 为了/ 寻找/ 更/ 有/ 前景/ 的/ 区域/ 并/ 进行/ 搜索/ ,/ 从而/ 有利于/ 找到/ 全局/ 最小值/ 点/ ,/ 本文/ 采用/ 基于/ 禁忌/ 技术/ 的/ 跳/ 坑/ 策略/ 来/ 跳出/ 当前/ 局部/ 极小值/ 点/ 的/ 陷阱/ ./ 具体做法/ 是/ :/ 在/ 当前/ 格局/ 中/ 挑选/ 某个/ 嵌入/ 较/ 多/ 的/ 圆饼/ 进行/ 重新/ 放置/ ,/ 以/ 形成/ 一个/ 处于/ 不同/ 搜索/ 区域/ 的/ 新格局/ ./ 同时/ ,/ 为了/ 避免/ 每次/ 跳坑/ 时/ 总是/ 挑中/ 同一个/ 圆饼/ ,/ 本文/ 进一步/ 结合/ 禁忌/ 技术/ ,/ 这样/ 在/ 一定/ 程度/ 上/ 就/ 可/ 避免/ 重复/ 搜索/ 相同/ 的/ 区域/ ,/ 从而/ 提高/ 算法/ 的/ 效率/ ./ 通常/ 以/ 相对/ 痛苦/ 度来/ 衡量/ 一个/ 圆饼/ 的/ 嵌入/ 情况/ ,/ 圆饼/ 嵌入/ 越/ 多/ 表示/ 其越/ 痛苦/ ./ j/ =/ 0/ ,/ j/ ≠/ i/ 定义/ 16/ ./ 相对/ 痛苦/ 度/ ./ 格局/ X/ 中/ ,/ 圆饼/ i/ (/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ )/ 的/ 相对/ 痛苦/ 度为/ 其/ 因/ 挤压/ 产生/ 的/ 弹性/ 势能/ 与其/ 半径/ 的/ 比/ ,/ 即/ Ui/ // Ri/ (/ 其中/ Ui/ =/ 1/ ∑/ nUij/ 表示/ 圆饼/ i/ 因/ 挤压/ 产生/ 的/ 弹性/ 势能/ )/ ./ 具体/ 的/ 禁忌/ 方法/ 与/ 跳/ 坑/ 策略/ 如下/ ./ 禁忌/ 方法/ 若/ 跳/ 坑/ 时/ 同一个/ 圆饼/ 被/ 多次/ 挑中/ (/ 本文/ 中设/ 为/ 3/ 次/ )/ ,/ 则/ 将/ 之/ 放入/ 到/ 一个/ 禁忌/ 表中/ ,/ 同时/ 设置/ 其/ 禁忌/ 长度/ 为/ l/ ./ 表中/ 每/ 增加/ 一个/ 禁忌/ 圆饼/ ,/ 则/ 将/ 该/ 禁忌/ 表中/ 的/ 其它/ 圆饼/ 的/ 禁忌/ 长度/ 减/ 1/ ,/ 同时/ 将/ 禁忌/ 长度/ 为/ 0/ 的/ 圆饼/ 从表中/ 删除/ ,/ 即/ 解除/ 禁忌/ ./ 跳坑/ 策略/ 当/ 计算/ 陷入/ 局部/ 极小值/ 点/ 的/ 陷阱/ 时/ ,/ 从/ 当前/ 格局/ 中/ 挑选/ 一个/ 相对/ 痛苦/ 度/ 最大/ 且/ 未/ 被/ 禁忌/ 的/ 圆饼/ 并/ 将/ 其/ 圆心/ 随机/ 地/ 放到/ 一个/ 空位/ 点/ (/ 在/ 空腔/ 内/ 但/ 不/ 在/ 任何/ 圆饼/ 区域/ 内/ 的/ 一个点/ )/ 上/ ,/ 以/ 得到/ 一个/ 新/ 的/ 格局/ ./ 4.5/ 完整/ 的/ QPCFA/ 算法/ 综合/ 基于/ 粗精调/ 技术/ 的/ 拟物/ 下降/ 算法/ 和/ 跳/ 坑/ 策略/ ,/ 我们/ 得到/ 求解/ 带/ 平衡/ 约束/ 圆形/ Packing/ 问题/ 的/ 完整/ 算法/ ,/ 其/ 主要/ 过程/ 如下/ ./ 1/ ./ 初始化/ :/ 2/ ./ 执行/ 一步/ 迭代/ :/ 3/ ./ 若/ 运行/ 总/ 时间/ T/ 总/ 达到/ 某个/ 限定/ 的/ 值/ ,/ 则/ 失败/ 退出/ ./ 4/ ./ 跳坑/ :/ 5/ ./ 用/ 跳/ 坑/ 产生/ 的/ k/ ·/ m/ // k/ =/ m/ 个/ 新格局/ 更新/ X1/ ,/ X2/ ,/ 6/ ./ 返回/ 2.5/ 实验/ 结果/ 与/ 比较/ 我们/ 将/ 基于/ 粗精调/ 技术/ 的/ 拟物/ 算法/ (/ QPCFA/ )/ 用/ C++/ 语言/ 实现/ 并/ 将/ 之/ 放在/ CPU/ 主频/ 为/ 1.90/ GHz/ ,/ 内存/ 为/ 1GB/ 的/ PC机/ 上/ 运行/ ./ 在/ 实验/ 计算/ 中/ ,/ 相关/ 的/ 参数设置/ 与/ 分析/ 如下/ ./ 在/ 粗/ 精调/ 算法/ 中/ ,/ 倔强/ 系数/ k/ 弹/ =/ 1/ ,/ k/ 拉/ =/ 10/ -/ 8/ ,/ δ/ r/ =/ 10/ -/ 12/ ,/ 从而/ 使/ U/ 拉/ </ k/ 拉/ ·/ δ/ r/ =/ 10/ -/ 20/ 时/ 满足/ 静/ 不/ 平衡/ 约束/ ;/ 当/ U/ 总/ </ 10/ -/ 10/ 时/ 进入/ 精调/ 过程/ ,/ 当/ U/ 总/ </ 10/ -/ 20/ 时/ 可/ 成功/ 停机/ ./ 在/ 拟物/ 下降/ 过程/ 中/ ,/ 若/ 将/ 移动/ 步长/ h/ 弹/ 设置/ 为/ 1.0/ ,/ 则/ 两/ 嵌入/ 圆饼/ 做/ 一次/ 动作/ 1/ 后/ 刚好/ 相切/ ,/ 但/ 在/ 整个/ 拟物/ 下降/ 过程/ 中/ ,/ 经过/ 小规模/ 实验/ 发现/ ,/ 将/ h/ 弹/ 的/ 初始值/ 设为/ 1.2/ 时/ ,/ 在/ h/ 弹/ ∈/ [/ 0.5/ ,/ 2.0/ ]/ 中/ 下降/ 速度/ 是/ 最快/ 的/ ;/ 在/ 做/ 动作/ 2/ 时/ ,/ 当/ h/ 拉/ 的/ 值/ 为/ 1.0/ 时/ ,/ 动作/ 结束/ 后/ 系统/ 的/ 质心/ 与/ 外/ 包络/ 圆/ 的/ 圆心/ 重合/ ,/ 这样/ 可以/ 使/ 格局/ 尽快/ 满足/ 约束/ (/ 3/ )/ ./ 综合/ 以上/ 两点/ ,/ 在/ A1/ 和/ A2/ 中/ ,/ 移动/ 步长/ h/ 弹/ 和/ h/ 拉/ 的/ 初始值/ 分别/ 设置/ 为/ 1.2/ 和/ 1.0/ ./ 当/ h/ 弹/ </ 10/ -/ 7/ 时/ ,/ 则/ 认为/ 对应/ 的/ 拟物/ 下降/ 过程/ 已/ 完成/ ./ 在/ 粗/ 精调/ 计算/ 过程/ 中/ ,/ 我们/ 发现/ 从/ 一个/ 格局/ 出发/ ,/ A1/ 最多/ 经过/ 10/ 次/ 左右/ 的/ 迭代/ 便/ 找到/ 该/ 领域/ 内/ 的/ 局部/ 最小值/ 点/ ,/ 因此/ 将/ A1/ 迭代/ 次数/ 的/ 上界/ count/ 设为/ 10/ ;/ 当/ 连续/ 做/ 200/ 个/ 动作/ 后/ ,/ 势能/ 相对/ 变化率/ 小于/ 0.01/ %/ 时/ ,/ 则/ 认为/ 格局/ 处于/ 卡壳/ 状态/ ./ 在/ 禁忌/ 方法/ 中/ ,/ 若/ 将/ 禁忌/ 长度/ 设置/ 过/ 短/ 或/ 过长/ ,/ Page8/ 都/ 有/ 可能/ 使/ 搜索/ 局限于/ 同一个/ 领域/ ,/ 丧失/ 搜索/ 空间/ 的/ 多样性/ ,/ 因此/ 将/ 禁忌/ 长度/ l/ 设置/ 为/ 3/ ./ 若/ 同一个/ 圆饼/ 被/ 连续/ 挑中/ 3/ 次则/ 入表/ ,/ 禁忌/ 长度/ l/ 设为/ 3/ ./ 在/ 总算/ 法中/ ,/ 需要/ 在/ 扩大/ 搜索/ 范围/ 和/ 提高/ 搜索/ 速度/ 两/ 方面/ 取得/ 平衡/ ,/ 因此/ ,/ 总/ 格局/ 数/ 不宜/ 设置/ 过/ 小/ 或/ 过/ 大/ ./ 经/ 实验/ 测试/ 发现/ ,/ 将/ 当前/ 总/ 格局/ 数/ m/ 设为/ 20/ 能/ 达到/ 较/ 好/ 的/ 计算结果/ ;/ 每步/ 迭代/ 后/ 保留/ 最好/ 的/ k/ =/ 2/ 个/ 格局/ ,/ 使/ 算法/ 不会/ 因/ 过度/ 贪心/ 而/ 过早地/ 陷入/ 局部/ 值/ 的/ 陷阱/ ;/ 跳坑/ 时/ ,/ 对/ 这/ 最好/ 的/ 2/ 个/ 格局/ 中/ 的/ 每/ 一个/ 生成/ m/ // k/ =/ 10/ 个/ 新格局/ ,/ 从而/ 得到/ m/ 个/ 新/ 的/ 格局/ ./ 另外/ ,/ 为了/ 控制/ 总/ 的/ 运行/ 时间/ ,/ 算法/ 在/ 运行/ 总/ 时间/ T/ 总/ / 1000/ (/ s/ )/ 时/ ,/ 则/ 失败/ 停机/ ./ 在/ 国内外/ 文献/ 中/ ,/ 关于/ 带/ 平衡/ 约束/ 圆形/ Pack/ -/ 表/ 1QPCFA/ 算法/ 与/ MPSO/ [/ 13/ ]/ 、/ APSO/ [/ 10/ ]/ 、/ IQP/ [/ 5/ ]/ 、/ ISS/ [/ 8/ ]/ 和/ BF/ [/ 9/ ]/ 在/ 第/ 1/ 组算例/ 上/ 的/ 计算结果/ 比较/ 算例/ 算例/ 1.1/ (/ n/ =/ 5/ )/ 120.7112/ ./ 712/ ×/ 10/ -/ 3287120.71077/ ./ 03/ ×/ 10/ -/ 4263120.7107/ ./ 63/ ×/ 10/ -/ 43.82/ 算例/ 1.2/ (/ n/ =/ 9/ )/ —/ 算例/ 1.3/ (/ n/ =/ 5/ )/ —/ 算例/ 1.4/ (/ n/ =/ 7/ )/ 31.9851/ ./ 82/ ×/ 10/ -/ 2100231.8852/ ×/ 10/ -/ 698231.9814/ ./ 11/ ×/ 10/ -/ 376.33/ 算例/ 1.5/ (/ n/ =/ 40/ )/ 843.9403/ ./ 9/ ×/ 10/ -/ 32523820.9877/ ./ 26/ ×/ 10/ -/ 42318742.755/ ./ 4/ ×/ 10/ -/ 412.27/ 算例/ BF/ 的/ 结果/ R0JTime/ // s/ 算例/ 1.1/ (/ n/ =/ 5/ )/ 120.71028/ ./ 45/ ×/ 10/ -/ 81.275120/ ./ 71067823.89/ ×/ 10/ -/ 90.594120/ ./ 71067829.55/ ×/ 10/ -/ 132.11/ ×/ 10/ -/ 100.046/ 算例/ 1.2/ (/ n/ =/ 9/ )/ 1.0000051/ ./ 78/ ×/ 10/ -/ 44.631/ ./ 0000009.70/ ×/ 10/ -/ 92.8911/ ./ 00000007.92/ ×/ 10/ -/ 132.00/ ×/ 10/ -/ 120.172/ 算例/ 1.3/ (/ n/ =/ 5/ )/ —/ 算例/ 1.4/ (/ n/ =/ 7/ )/ 31.9545/ ./ 68/ ×/ 10/ -/ 1420.1831/ ./ 85461.50/ ×/ 10/ -/ 954.82831/ ./ 84250005.33/ ×/ 10/ -/ 134.11/ ×/ 10/ -/ 101.406/ 算例/ 1.5/ (/ n/ =/ 40/ )/ 740.5804/ ./ 01/ ×/ 10/ -/ 520.21725/ ./ 04352.47/ ×/ 10/ -/ 97.187712/ ./ 40625004.09/ ×/ 10/ -/ 131.60/ ×/ 10/ -/ 10171.719/ 表/ 2QPCFA/ 在/ 算例/ 1.5/ 上/ 的/ 布局/ 坐标/ 序号/ 133.6752834392142419/ ./ 056568232296021/ -/ 21.2693514130649/ -/ 604.03189462935902/ -/ 374.8283256693330/ -/ 141.139430424391022/ -/ 342.3161478494570285/ ./ 91025638393503/ -/ 602.4663880092440/ -/ 120.537510170726023382/ ./ 8906303885850/ -/ 168.02747248212704/ -/ 172.1663553154680372/ ./ 686106138574024/ -/ 196.2826053500670169/ ./ 10956897314405/ -/ 615.43567460052606112/ ./ 8105106839630/ -/ 420.8216462150590265/ ./ 8395435443323208.89193851431307629/ ./ 4002933894370848.7758521034264617/ ./ 482808498066028/ -/ 148.2877567686720583/ ./ 33703191731409244.9959673442620542/ ./ 665254576071029584.4552319881560/ -/ 150.037276504008010/ -/ 330.2892549427610536/ ./ 225943388334030368.4355146368750163/ ./ 279109290871011/ -/ 79.1216468440339/ -/ 415.718029198883031/ -/ 234.4379027266300/ -/ 553.830612465765012281/ ./ 2818105224380/ -/ 322.625815699022032457/ ./ 727790322500013/ -/ 517.9789698750800/ -/ 309.510725672343033/ -/ 552.3264224512010253/ ./ 4698067670430142.7302479076602/ -/ 1.085041844573434/ -/ 457.4194707002230420/ ./ 372983816901015137.5221609785070/ -/ 173.689039975242035/ -/ 82.8580236143787/ -/ 207.770915492948016562/ ./ 5139518908780215.572131703456036485/ ./ 4728406705990/ -/ 349.865918617819017224/ ./ 0628873920580308.817916838638037435/ ./ 2884991902530404.774891157742018176/ ./ 2351981230330108.731586798243038/ -/ 412.7691159220190/ -/ 472.504242816953019286/ ./ 7598944873780/ -/ 21.749413709759539173/ ./ 7038547878660/ -/ 600.799424409599020/ -/ 403.2143651870430/ 第/ 2/ 组共/ 6/ 个算例/ 是/ 由/ Huang/ 等/ 人于/ 2006/ 年/ [/ 5/ ]/ 提出/ 的/ ,/ 对/ 该组/ 算例/ 仅/ Huang/ 等/ 人/ [/ 5/ ]/ 进行/ 了/ 计算/ ./ 表/ 3/ 中/ 给出/ 了/ QPCFA/ 算法/ 的/ 计算结果/ 及/ 与/ IQP/ 的/ 结果/ 比较/ ./ 由于/ IQP/ 算法/ 中/ R0/ 的/ 精度/ 为/ 小数/ ing/ 问题/ 的/ 算例/ 有/ 2/ 组/ ./ 第/ 1/ 组共/ 5/ 个算例/ 是/ 由/ 滕弘飞/ 等/ 人于/ 1994/ 年/ [/ 11/ ]/ 、/ 1999/ 年/ [/ 2/ ]/ 和/ 2001/ 年/ [/ 12/ ]/ 陆续/ 提出/ 的/ ,/ 对/ 该组/ 算例/ ,/ 滕弘飞/ 等/ 人/ [/ 8/ ,/ 12/ ]/ 、/ 李宁/ 等/ 人/ [/ 13/ ]/ 、/ 雷开友/ 等/ 人/ [/ 10/ ]/ 、/ Huang/ 等/ 人/ [/ 5/ ]/ 以及/ 刘景发/ 等/ 人/ [/ 9/ ]/ 分别/ 给出/ 了/ 计算/ 的/ 结果/ ./ 表/ 1/ 中/ 给出/ 了/ QPCFA/ 算法/ 的/ 计算结果/ 及/ 与/ 以上/ 算法/ 的/ 结果/ 比较/ ,/ 其中/ ,/ R0/ 为外/ 包络/ 圆/ 半径/ ;/ J/ 为静/ 不平/ 衡量/ ;/ Rc/ 为/ 圆饼/ 集/ 质心/ 与/ 外/ 包络/ 圆圆/ 心/ 的/ 距离/ ;/ Time/ 为/ 运行/ 时间/ ./ 每个/ 算例/ 的/ 最好/ 结果/ 用/ 粗体/ 显示/ ./ 可见/ QPCFA/ 算法/ 在/ 算例/ 1.2/ 上平/ 了/ 记录/ ,/ 在/ 算例/ 1.3/ 、/ 1.4/ 和/ 1.5/ 上/ 取得/ 了/ 更好/ 的/ 结果/ ./ 图/ 6/ 为/ 算法/ QPCFA/ 在/ 第/ 1/ 组算例/ 上/ 的/ 布局/ 结果/ 图/ ,/ 表/ 2/ 为/ QPCFA/ 在/ 算例/ 1.5/ 上/ 的/ 布局/ 坐标/ ./ APSO/ 的/ 结果/ —/ —/ 序号/ 点后/ 2/ 到/ 3/ 位/ ,/ 可见/ QPCFA/ 算法/ 在/ 前/ 两个/ 算例/ 上平/ 了/ 记录/ ,/ 后/ 4/ 个算例/ 上/ 取得/ 了/ 更好/ 的/ 结果/ ./ 图/ 7/ 为/ QPCFA/ 算法/ 在/ 第/ 2/ 组算例/ 上/ 的/ 布局/ 结果/ 图/ ,/ 表/ 4/ 为/ QPCFA/ 在/ 算例/ 2.6/ 上/ 的/ 布局/ 坐标/ ./ Page9/ 图/ 6/ 算法/ QPCFA/ 在/ 第/ 1/ 组算例/ 上/ 的/ 布局/ 结果/ 图表/ 3/ 算法/ QPCFA/ 与/ IQP/ [/ 5/ ]/ 在/ 第/ 2/ 组算例/ 上/ 的/ 计算结果/ 比较/ 算例/ 算例/ 2.1/ (/ n/ =/ 7/ )/ 60.003/ ./ 6/ ×/ 10/ -/ 37.7860/ ./ 00000009.47/ ×/ 10/ -/ 132.66/ ×/ 10/ -/ 90.015/ 算例/ 2.2/ (/ n/ =/ 12/ )/ 215.479/ ./ 5/ ×/ 10/ -/ 3444.78215/ ./ 47005397.21/ ×/ 10/ -/ 132.92/ ×/ 10/ -/ 80.391/ 算例/ 2.3/ (/ n/ =/ 15/ )/ 39.787/ ./ 6/ ×/ 10/ -/ 3/ 算例/ 2.4/ (/ n/ =/ 17/ )/ 49.725/ ./ 1/ ×/ 10/ -/ 3157.9249/ ./ 35901254.20/ ×/ 10/ -/ 138.51/ ×/ 10/ -/ 1010.562/ 算例/ 2.5/ (/ n/ =/ 37/ )/ 135.1766/ ./ 7/ ×/ 10/ -/ 3/ 算例/ 2.6/ (/ n/ =/ 50/ )/ 159.578/ ./ 0/ ×/ 10/ -/ 3348.97158/ ./ 96440002.98/ ×/ 10/ -/ 135.96/ ×/ 10/ -/ 9842.906/ 表/ 4QPCFA/ 在/ 算例/ 2.6/ 上/ 的/ 布局/ 坐标/ 序号/ 140.5614260348176/ -/ 51.63932600708582622/ ./ 17921279102722/ -/ 138.50926666247903115/ ./ 5182602344440/ -/ 77.244003131431628/ -/ 2.923770402823732/ ./ 91336844026424/ -/ 76.0597694115735591/ ./ 69497999186466/ -/ 4.83063535671647/ -/ 24.3344097324541/ -/ 136.8171808302380324/ ./ 5863757049520/ -/ 34.15230928714258/ -/ 61.9105969169925/ -/ 123.104771972849033133/ ./ 661434897387038.0226943881165999/ ./ 432917037141710/ -/ 135.0675918439340/ -/ 32.6485136441308358/ ./ 7973161483504/ -/ 114.40538170213301193/ ./ 2134223877926/ -/ 34.97351133274033619/ ./ 1521852823584137.638287791848012/ -/ 54.5642474705934/ -/ 24.00429361006223758/ ./ 1542631208816/ -/ 15.715906302624613/ -/ 130.959260804559014132/ ./ 7353980953450/ -/ 41.1390150566750395/ ./ 7008218883174/ -/ 74.136781394497715/ -/ 81.5100422056505109/ ./ 71147109742304057.5645928501329126/ ./ 480916020399016/ -/ 95.3243426519939/ -/ 101.115647480126041/ -/ 57.117825855913915/ ./ 914113640601017/ -/ 45.456334578463718/ -/ 11.8352473627850112/ ./ 34443442662104391.2075503475726104/ ./ 844109166694019117.293608093225020138/ ./ 954892744711021/ -/ 87.3861006602401/ -/ 46.867494462020546/ -/ 38.451722572394451/ ./ 291741998204622/ -/ 20.51660748891002356/ ./ 78337455850072484.7880822788126/ -/ 110.100343191299049/ -/ 29.5364083609000/ -/ 55.20697409586502530/ ./ 6973168128570/ 另外/ ,/ 从表/ 1/ 、/ 3/ 可以/ 看出/ ,/ 除/ ISS/ 算法/ 在/ 算例/ 1.4/ 上/ 的/ 结果/ 以外/ ,/ QPCFA/ 算法/ 得到/ 的/ 静/ 不平/ 衡量/ 比/ 上述/ 算法/ 得到/ 的/ 最小/ 静/ 不平/ 衡量/ 还要/ 小/ 1/ ~/ 5/ 个/ 数量级/ ,/ 从而/ 可/ 更好/ 地/ 满足/ 卫星/ 舱内/ 设备/ 的/ 布局/ 要求/ ./ R0/ 序号/ 最后/ ,/ 由于/ 各/ 算法/ 运行/ 的/ 硬件/ 环境/ 和/ 算法/ 实现/ 语言/ 不尽相同/ ,/ 如/ MPSO/ 所用/ 机器/ 的/ CPU/ 主频/ 为/ 166MHz/ ,/ 内存/ 和/ 编程语言/ 未/ 报道/ ;/ APSO/ 所用/ 机器/ 的/ CPU/ 主频/ 为/ 2.0/ GHz/ ,/ 内存/ 为/ 256MB/ ,/ 算法/ 用/ Page10/ 图/ 7/ 算法/ QPCFA/ 在/ 第/ 2/ 组算例/ 上/ 的/ 布局/ 结果/ 图/ MATLAB/ 编程/ 实现/ ;/ IQP/ 和/ ISS/ 所用/ 机器/ 的/ CPU/ 主频/ 为/ 2.4/ GHz/ ,/ 内存/ 为/ 512MB/ ,/ 用/ C语言/ 编程/ 实现/ ;/ BF/ 所用/ 机器/ 的/ CPU/ 主频/ 为/ 1.6/ GHz/ ,/ 内存/ 为/ 1GB/ ,/ 用/ Java/ 语言/ 编程/ 实现/ ;/ 本文/ QPCFA/ 算法/ 所用/ 机器/ 的/ CPU/ 主频/ 为/ 1.9/ GHz/ ,/ 内存/ 为/ 1GB/ ,/ 用/ C++/ 语言/ 编程/ 实现/ ./ 因此/ ,/ 在/ 计算/ 时间/ 上/ 各/ 算法/ 基本/ 在/ 同一/ 数量级/ 上/ ./ 6/ 结论/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ 在/ 理论/ 上/ 属于/ NP/ 难度/ ,/ 它/ 比/ 一般/ 的/ 圆形/ Packing/ 问题/ 要/ 更/ 难/ 求解/ ,/ 在实践上/ 具有/ 深远/ 的/ 应用/ 价值/ ,/ 如/ 人造卫星/ 舱/ 、/ 组合/ 机床/ 多/ 轴箱/ 、/ 旋转/ 结构/ 等/ 布局/ 方案设计/ 领域/ ./ 本文/ 对/ 该/ 问题/ 建立/ 了/ 相应/ 的/ 数学模型/ ,/ 提出/ 了/ 两种/ 新/ 的/ 物理/ 模型/ ,/ 并/ 借鉴/ 人类/ 社会/ 在/ 工艺/ 加工过程/ 中/ “/ 粗/ 精加工/ ”/ 的/ 经验/ ,/ 将/ 拟物/ 下降/ 过程/ 分为/ 粗/ 调和/ 精调/ 两个/ 阶段/ ,/ 这样/ 既/ 不会/ 在/ 没有/ 前景/ 的/ 坑/ (/ 即/ 可能/ 达到/ 局部/ 极小值/ 点/ )/ 内/ 花费/ 过多/ 的/ 时间/ ,/ 又/ 不会/ 错过/ 一个/ 有/ 前景/ 的/ 坑/ (/ 即极/ 有/ 可能/ 达到/ 全局/ 最小值/ 点/ )/ ./ 对/ 2/ 组共/ 11/ 个/ 代表性/ 算例/ 的/ 计算/ 结果表明/ ,/ 基于/ 粗精调/ 技术/ 的/ 拟物/ 算法/ 是/ 求解/ 带/ 平衡/ 约束/ 的/ 圆形/ Packing/ 问题/ 的/ 有效/ 算法/ ./ 

