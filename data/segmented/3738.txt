Page1Piccolo/ 算法/ 的/ 差分/ 故障/ 分析/ 赵/ 光耀/ 1/ )/ 李瑞林/ 2/ )/ 孙兵/ 3/ )/ ,/ 4/ )/ 李超/ 1/ )/ ,/ 3/ )/ 1/ )/ (/ 国防科学技术大学/ 计算机/ 学院/ 网络/ 技术/ 与/ 信息安全/ 研究所/ 长沙/ 410073/ )/ 2/ )/ (/ 国防科学技术大学/ 电子/ 科学/ 与/ 工程学院/ 长沙/ 410073/ )/ 3/ )/ (/ 国防科学技术大学/ 理学院/ 数学/ 与/ 系统/ 科学系/ 长沙/ 410073/ )/ 4/ )/ (/ 中国科学院/ 软件/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ Piccolo/ 算法/ 是/ CHES2011/ 上/ 提出/ 的/ 一个/ 轻量级/ 分组/ 密码/ 算法/ ,/ 它/ 的/ 分组/ 长度/ 为/ 64/ -/ bit/ ,/ 密钥/ 长度/ 为/ 80/ // 128/ -/ bit/ ,/ 对应/ 迭代/ 轮数/ 为/ 25/ // 31/ 轮/ ./ Piccolo/ 算法/ 采用/ 一种/ 广义/ Feistel/ 结构/ 的/ 变种/ ,/ 轮/ 变换/ 包括/ 轮/ 函数/ S/ -/ P/ -/ S/ 和/ 轮/ 置换/ RP/ ,/ 能够/ 较/ 好/ 地/ 抵抗/ 差分/ 分析/ 、/ 线性/ 分析/ 等/ 传统/ 密码/ 攻击/ 方法/ ./ 该文/ 将/ Piccolo/ 算法/ 的/ S/ -/ P/ -/ S/ 函数/ 视为/ 超级/ S/ 盒/ (/ SuperSbox/ )/ ,/ 采用/ 面向/ 半/ 字节/ 的/ 随机/ 故障/ 模型/ ,/ 提出/ 了/ 一种/ 针对/ Piccolo/ -/ 80/ 算法/ 的/ 差分/ 故障/ 分析方法/ ./ 理论/ 分析/ 和/ 实验/ 结果表明/ :/ 通过/ 在/ 算法/ 第/ 24/ 轮/ 输入/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 各/ 诱导/ 1/ 次/ 随机/ 半/ 字节/ 故障/ ,/ 能够/ 将/ Piccolo/ -/ 80/ 算法/ 的/ 密钥/ 空间/ 缩小/ 至约/ 22/ -/ bit/ ./ 因此/ ,/ 为/ 安全/ 使用/ Piccolo/ 算法/ ,/ 在/ 其实/ 现时/ 必须/ 做/ 一定/ 的/ 防护/ 措施/ ./ 关键词/ 差分/ 故障/ 分析/ ;/ 超级/ S/ 盒/ ;/ 轻量级/ 分组/ 密码/ ;/ Piccolo/ 算法/ 1/ 引言/ 来/ 越/ 受到/ 人们/ 的/ 重视/ ./ 由于/ 物/ 联网/ 中/ 许多/ 设备/ 的/ 计算能力/ 较/ 低/ 、/ 存储空间/ 小/ 、/ 资源/ 有限/ ,/ 传统/ 的/ 加密算法/ 不能/ 得到/ 很/ 好/ 的/ 应用/ ./ 在/ 此/ 情况/ 下/ ,/ 设计/ 一种/ 执行/ 随着/ 物/ 联网/ 技术/ 的/ 不断/ 发展/ ,/ 数据安全/ 问题/ 越/ 效率高/ 、/ 资源/ 消耗/ 少/ 的/ 密码/ 算法/ 来/ 保护/ 微型/ 设备/ 间/ Page2/ 的/ 信息/ 传输/ 安全/ 显得/ 越来越/ 重要/ ./ 近年来/ ,/ 轻量级/ 密码/ 算法/ 的/ 设计/ 与/ 分析/ 受到/ 了/ 人们/ 的/ 广泛/ 关注/ ,/ 密码/ 学者/ 提出/ 了/ 许多/ 轻量级/ 密码/ 算法/ ,/ 如/ MIBS/ [/ 1/ ]/ 、/ LED/ [/ 2/ ]/ 、/ HIGHT/ [/ 3/ ]/ 、/ LBlock/ [/ 4/ ]/ 、/ PRESENT/ [/ 5/ ]/ 、/ KLEIN/ [/ 6/ ]/ 等/ ./ Piccolo/ [/ 7/ ]/ 算法/ 是/ 在/ CHES2011/ 上/ 提出/ 的/ 一种/ 轻量级/ 密码/ ,/ 由/ 日本索尼公司/ 的/ Shibutani/ 等/ 学者/ 设计/ ,/ 它/ 的/ 分组/ 长度/ 为/ 64/ -/ bit/ ,/ 密钥/ 长度/ 可以/ 为/ 80/ -/ bit/ 或/ 128/ -/ bit/ ./ 与/ 其它/ 的/ 轻量级/ 算法/ 相比/ ,/ Piccolo/ 算法/ 最大/ 的/ 优点/ 是/ 其/ 能耗/ 极小/ ,/ 而且/ 只/ 需/ 额外/ 增加/ 少量/ 的/ 硬件/ 开销/ ,/ 便/ 可/ 同时/ 支持/ 加解密/ ,/ 因而/ 尤其/ 适用/ 于/ 低能耗/ 设备/ ./ Biham/ 和/ Shamir/ 首次/ 在/ 文献/ [/ 8/ ]/ 中将/ 差分/ 分析/ [/ 9/ ]/ 的/ 思想/ 推广/ 至/ 差分/ 故障/ 分析/ ,/ 用来/ 对/ DES/ 类/ 的/ 密码/ 算法/ 进行/ 攻击/ ,/ 使得/ 现实/ 环境/ 中/ 的/ 分组/ 密码/ 受到/ 了/ 更/ 大/ 的/ 威胁/ ./ 近些年来/ ,/ 人们/ 利用/ 该/ 思想/ 陆续/ 对/ 一些/ 轻量级/ 密码/ 算法/ 进行/ 了/ 分析/ ,/ 包括/ Keeloq/ [/ 10/ -/ 11/ ]/ 、/ MIBS/ [/ 12/ ]/ 、/ LED/ [/ 13/ -/ 14/ ]/ ①/ 、/ LBlock/ [/ 15/ ]/ 、/ HIGHT/ [/ 16/ ]/ 等/ ./ 差分/ 故障/ 分析/ 的/ 一个/ 关键问题/ 是/ 如何/ 合理/ 地/ 建立/ 故障/ 模型/ ,/ 包括/ 故障/ 诱导/ 的/ 时间/ 、/ 位置/ 和/ 取值/ ./ 在/ 实际/ 攻击/ 当中/ ,/ 需要/ 根据/ 加密算法/ 的/ 结构/ 、/ 轮/ 函数/ 的/ 特点/ 、/ 算法/ 实现/ 的/ 软硬件/ 环境/ 以及/ 攻击/ 所/ 采用/ 的/ 设备/ [/ 17/ -/ 18/ ]/ 来/ 确定/ 究竟/ 采取/ 哪/ 一个/ 模型/ 更加/ 适合/ ./ 目前/ ,/ 对/ Piccolo/ 算法/ 的/ 传统/ 安全性/ 分析/ 主要/ 有/ Biclique/ 攻击/ [/ 19/ ]/ ./ 本文/ 在/ 对/ 算法/ 组件/ 进行/ 深入分析/ 后/ ,/ 提出/ 了/ 一种/ 针对/ Piccolo/ -/ 80/ 算法/ 的/ 差分/ 故障/ 攻击/ 方法/ ,/ 能够/ 以较/ 少/ 的/ 故障注入/ 次数/ ,/ 在/ 较/ 短/ 的/ 时间/ 内/ 恢复/ 出/ 种子/ 密钥/ ./ 理论/ 分析/ 和/ 实验/ 验证/ 表明/ ,/ 诱导/ 2/ 个/ 故障/ 即可/ 将/ 80/ -/ bit/ 的/ 种子/ 密钥/ 空间/ 减少/ 到/ 约/ 22/ -/ bit/ ./ 本文/ 第/ 2/ 节/ 简单/ 介绍/ Piccolo/ 算法/ ;/ 第/ 3/ 节/ 给出/ 算法/ 的/ 一个/ 等价/ 结构/ ,/ 并/ 对/ Piccolo/ 算法/ 的/ S/ 盒/ 以及/ S/ -/ P/ -/ S/ 结构/ 的/ 差分/ 特性/ 进行/ 描述/ ;/ 第/ 4/ 节/ 给出/ 对/ Piccolo/ 算法/ 的/ 差分/ 故障/ 分析/ ,/ 包括/ 基本/ 思想/ 、/ 详细/ 的/ 攻击/ 步骤/ 和/ 攻击/ 的/ 复杂度/ 分析/ ;/ 第/ 5/ 节/ 给出/ 攻击/ 的/ 实验/ 结果/ ;/ 第/ 6/ 节对/ 全文/ 进行/ 总结/ ;/ 附录/ 给出/ 攻击/ 的/ 一组/ 实验/ 结果/ ./ 2Piccolo/ 算法/ 首先/ 给出/ 本文/ 所用/ 记号/ ,/ 然后/ 简要/ 介绍/ Piccolo/ 算法/ ./ 2.1/ 符号/ 及/ 术语/ 说明/ a/ (/ b/ )/ :/ 长度/ 为/ b/ -/ bit/ 的/ 数据/ a/ ;/ a/ |/ b/ :/ 数据/ a/ 与/ b/ 的/ 级联/ ;/ a/ ←/ b/ :/ 将/ b/ 的/ 值/ 赋/ 给/ a/ ./ Δ/ OUTFi/ :/ 第/ i/ 轮/ F/ 变换/ 层/ 的/ 输出/ 差分/ ,/ Δ/ OUTFi/ =/ Δ/ OUTFi/ Δ/ OUTi/ :/ 第/ i/ 轮/ 的/ 输出/ 差分/ ,/ Δ/ OUTi/ =/ Δ/ OUTi/ Δ/ OUTiXL/ 或/ XR/ :/ X/ 的/ 左/ (/ 或右/ )/ 半/ 部分/ ./ 若/ X/ 为/ 16/ 位/ ,/ 则/ XL/ 表示/ X/ 的/ 高/ 8/ 位/ ;/ 半/ 字节/ :/ 长度/ 为/ 4/ -/ bit/ 的/ 向量/ ./ 2.2/ Piccolo/ 算法/ Piccolo/ 算法/ 分组/ 长度/ 为/ 64/ -/ bit/ ,/ 密钥/ 长度/ 可为/ 80/ -/ bit/ 和/ 128/ -/ bit/ ,/ 对应/ 的/ 算法/ 分别/ 记为/ Piccolo/ -/ 80/ 和/ Piccolo/ -/ 128/ ,/ 迭代/ 轮数/ 分别/ 为/ 25/ 和/ 31/ ./ 本文/ 研究/ 对象/ 为/ Piccolo/ -/ 80/ ./ 为/ 表述/ 方便/ ,/ 以下/ 如/ 无/ 特别/ 说明/ ,/ Piccolo/ 均/ 指/ Piccolo/ -/ 80/ ./ Piccolo/ 算法/ 所/ 采用/ 的/ 结构/ 是/ 广义/ Feistel/ 结构/ 的/ 一种/ 变体/ ,/ 如图/ 1/ 所示/ ,/ 该/ 结构/ 包括/ 4/ 个/ 分支/ (/ 寄/ ①/ 另/ 可/ 参见/ :/ ZhaoXin/ -/ Jie/ ,/ GuoShi/ -/ Ze/ ,/ ZhangFan/ ,/ WangPage3/ 存器/ )/ ,/ 每个/ 分支/ (/ 寄存器/ )/ 包含/ 16/ -/ bit/ 数据/ ./ Piccolo/ 算法/ 每轮/ 包含/ 两类/ 变换/ :/ 轮/ 函数/ F/ :/ (/ 0/ ,/ 1/ )/ 16/ →/ (/ 0/ ,/ 1/ )/ 16/ 和/ 轮/ 置换/ RP/ :/ (/ 0/ ,/ 1/ )/ 64/ →/ (/ 0/ ,/ 1/ )/ 64/ (/ 最后/ 一轮/ 除外/ ,/ 仅/ 包含/ 轮/ 函数/ F/ )/ ,/ 其中/ F/ 函数/ 采用/ S/ -/ P/ -/ S/ 三层/ 结构/ (/ 见图/ 2/ )/ ,/ P/ 变换/ 采用/ 有限/ 域/ GF/ (/ 16/ )/ 上/ 的/ 矩阵/ ,/ 定义/ 如下/ 轮/ 置换/ RP/ 则/ 是/ 基于/ 字节/ 的/ 位置/ 变换/ ,/ 如图/ 3/ 所示/ ./ Piccolo/ 算法/ 的/ 密钥/ 扩展/ 算法/ 比较简单/ ,/ 采用/ 基于/ 置换/ 的/ 实现/ 方法/ ,/ 这/ 在/ 一定/ 程度/ 上/ 减少/ 了/ 硬件/ 开销/ ,/ 同时/ 也/ 使得/ 轮/ 密钥建立/ 时间/ 更/ 短/ ./ 密钥/ 扩展/ 算法/ 使用/ 80/ -/ bit/ 的/ 种子/ 密钥/ k/ (/ 80/ )/ 作为/ 输入/ ,/ 输出/ 4/ 个/ 16/ -/ bit/ 的/ 白化/ 密钥/ wki/ (/ 16/ )/ (/ 0/ / i/ </ 4/ )/ 和/ 50/ 个/ 16/ -/ bit/ 的/ 轮/ 密钥/ rkj/ (/ 16/ )/ (/ 0/ / j/ </ 50/ )/ ./ 首先/ 将/ 80/ -/ bit/ 的/ 种子/ 密钥/ k80/ 划分/ 为/ 5/ 个/ 16/ -/ bit/ 的/ 字/ :/ k/ (/ 80/ )/ =/ k0/ (/ 16/ )/ |/ k1/ (/ 16/ )/ |/ k2/ (/ 16/ )/ |/ k3/ (/ 16/ )/ |/ k4/ (/ 16/ )/ ,/ 轮/ 密钥/ 可/ 按/ 如下/ 方式/ 得到/ :/ wk0/ ←/ kL0/ |/ kR1/ ,/ wk1/ ←/ kL1/ |/ kR0/ ,/ wk2/ ←/ kL4/ |/ kR3/ ,/ wk3/ ←/ kL3/ |/ kR4/ ;/ fori/ ←/ 0to/ (/ r/ -/ 1/ )/ do/ :/ (/ rk2i/ ,/ rk2i/ +/ 1/ )/ ←/ (/ con2i/ ,/ con2i/ +/ 1/ )/ / 其中/ 的/ 轮/ 常数/ 为/ 如下/ 形式/ :/ (/ con2i/ ,/ con2i/ +/ 1/ )/ ←/ (/ ci/ +/ 1/ |/ c0/ |/ ci/ +/ 1/ |/ {/ 00/ }/ 2/ |/ ci/ +/ 1/ |/ c0/ |/ ci/ +/ 1/ )/ / {/ 0f1e2d3c/ }/ 16/ ,/ 这里/ ci/ 是/ 将/ i/ 表示/ 成/ 5/ -/ bit/ 的/ 二进制/ 数/ ,/ 如/ c13/ =/ {/ 01101/ }/ 2/ ./ 不难/ 发现/ ,/ 白化/ 密钥/ wk2/ 和/ wk3/ 对应/ 于/ 种子/ 密钥/ 中/ 的/ k3/ 、/ k4/ ,/ 最后/ 一轮/ 的/ 轮/ 密钥/ rk48/ 、/ rk49/ 与/ 种子/ 密钥/ 中/ 的/ k0/ 、/ k1/ 则/ 只/ 相差/ 一个/ 轮/ 常数/ ./ 3Piccolo/ 算法/ 组件/ 性质/ 3.1/ Piccolo/ 算法/ 的/ 一个/ 等价/ 结构/ 及/ 差分/ 传播/ 性质/ 通过/ 分析/ ,/ 我们/ 发现/ 可以/ 根据/ 轮/ 置换/ 的/ 逆变换/ ,/ 将/ Piccolo/ 算法/ 的/ 第/ 25/ 轮轮/ 密钥/ 进行/ 拆分/ 重组/ ,/ 上移/ 一轮/ 后/ 作为/ 第/ 24/ 轮/ 的/ 白化/ 密钥/ ./ 图/ 4/ 所示/ 为/ 算法/ 最后/ 两轮/ 等价/ 结构/ ,/ 其中/ rk46/ ,/ rk47/ 用/ 虚线/ 表示/ ,/ 旨在/ 说明/ 对应/ 的/ 轮/ 密钥/ 也/ 可以/ 上移/ 至前/ 一轮/ ./ Piccolo/ 算法/ 结构/ 属于/ 广义/ Feistel/ 结构/ 的/ 变种/ ,/ 且/ RP/ 变换/ 是/ 基于/ 字节/ 的/ 置换/ ,/ 容易/ 得到/ 以下/ 差分/ 传播/ 性质/ :/ Δ/ OUTFi1/ =/ (/ Δ/ OUTi/ +/ 10/ )/ L/ |/ (/ Δ/ OUTi/ +/ 12/ )/ R/ (/ 1/ )/ Δ/ OUTFi3/ =/ (/ Δ/ OUTi/ +/ 12/ )/ L/ |/ (/ Δ/ OUTi/ +/ 10/ )/ R/ (/ 2/ )/ 3.2/ Piccolo/ 算法/ S/ 盒/ 的/ 差分/ 特性/ 本/ 节/ 简单/ 描述/ Piccolo/ 算法/ 中/ S/ 盒/ (/ S/ :/ / 的/ 差分/ 特性/ ./ 假设/ 给定/ α/ ∈/ / {/ z/ ∈/ / 42/ |/ S/ (/ z/ / α/ )/ / S/ (/ z/ )/ =/ β/ }/ ,/ N/ (/ α/ ,/ β/ )/ =/ #/ IN/ (/ α/ ,/ β/ )/ ,/ 称/ α/ 为/ S/ 盒/ 的/ 输入/ 差分/ ,/ β/ 为/ S/ 盒/ 的/ 输出/ 差分/ ./ Piccolo/ 算法/ S/ 盒/ 差分/ 分布/ 性质/ 如表/ 1/ 所示/ ./ N/ (/ α/ ,/ β/ )/ 出现/ 次数/ 概率/ N/ (/ α/ ,/ β/ )/ ≠/ 0/ 时/ 所/ 占/ 比重/ 平均值/ 01590.6212720/ ./ 2814240.0941610/ ./ 004/ 表/ 1/ 说明/ ,/ 当/ 给定/ α/ ∈/ / Page4S/ (/ z/ / α/ )/ / S/ (/ z/ )/ =/ β/ ,/ 62.1/ %/ 的/ 情况/ 无/ 解/ ,/ 而/ 在/ 有解/ 的/ 情况/ 下/ ,/ 74.2/ %/ 的/ 情况/ 下有/ 2/ 个解/ ,/ 24.7/ %/ 的/ 概率/ 有/ 4/ 个解/ ,/ 且解/ 的/ 平均/ 个数/ 为/ 2.65/ (/ =/ 1.484/ +/ 0.988/ +/ 0.176/ )/ ./ 3.3/ S/ -/ P/ -/ S/ 结构/ 差分/ 特性/ Piccolo/ 算法/ 中/ F/ 函数/ 采用/ S/ -/ P/ -/ S/ 三层/ 结构/ ,/ 与/ 传统/ 的/ S/ -/ P/ 结构/ 相比/ ,/ 其/ 混淆/ 性能/ 更强/ ./ 由于/ Picco/ -/ lo/ 算法/ 采用/ 的/ S/ 盒/ 是/ 有限/ 域/ GF/ (/ 16/ )/ 上/ 的/ 一个/ 置换/ ,/ P/ 置换/ 采用/ 的/ 是/ GF/ (/ 16/ )/ 上/ 的/ 矩阵/ 犕/ ,/ 所以/ 将/ S/ -/ P/ -/ S/ 结构/ 看成/ 一个/ 大/ 的/ S/ 盒/ ,/ 其/ 输入/ 和/ 输出/ 均/ 为/ 16/ -/ bit/ ,/ 可/ 视为/ 有限/ 域/ GF/ (/ 216/ )/ 上/ 的/ 一个/ 置换/ ./ 这/ 类似/ 于/ 文献/ [/ 20/ ]/ 中/ 提出/ 的/ 超级/ S/ 盒/ (/ SuperSbox/ )/ 的/ 概念/ ①/ ,/ 只/ 需/ 将/ 密钥/ 加/ 部分/ 的/ 密钥/ 取为/ 全零/ 即可/ ,/ 如图/ 5/ 所示/ ,/ 其中/ 灰色/ 底纹/ 表示/ 活跃/ 的/ 半/ 字节/ ./ 将/ 3.2/ 节中/ 定义/ 的/ IN/ (/ α/ ,/ β/ )/ 及/ N/ α/ ,/ (/ )/ β/ 推广/ 至/ 超级/ S/ 盒/ ,/ 即/ IN/ (/ α/ ,/ β/ )/ =/ {/ x/ ∈/ / N/ α/ ,/ (/ )/ β/ =/ #/ IN/ (/ α/ ,/ β/ )/ ,/ 其中/ SS/ 表示/ 超级/ S/ 盒/ ,/ α/ ∈/ 162/ ,/ β/ ∈/ / / 特性/ :/ 下面/ 给出/ 几种/ 特殊/ 情形/ 下/ 超级/ S/ 盒/ 的/ 差分/ 传播/ (/ 1/ )/ 输入/ 差分/ 仅/ 在/ 单个/ 半/ 字节/ 上非/ 零/ 的/ 情形/ ./ 这种/ 情况/ 下/ ,/ 输入/ 差分/ 有/ 4/ ×/ (/ 24/ -/ 1/ )/ =/ 60/ 个/ 可能/ 取值/ ,/ 我们/ 考虑/ 输出/ 差分/ 的/ 分布/ 情况/ ,/ 此时/ 输入/ // 输出/ 差分/ 对/ (/ α/ ,/ β/ )/ 取值/ 共有/ 60/ ×/ 216/ =/ 3932160/ 种/ ,/ 统计/ N/ (/ α/ ,/ β/ )/ 的/ 取值/ 情况/ ,/ 结果/ 见表/ 2/ ./ 表/ 2/ 说明/ ,/ 当/ 超级/ S/ 盒/ 的/ 输入/ 差分/ 只有/ 单个/ 半/ 字节/ 非/ 零时/ ,/ 在/ 所有/ 输入/ // 输出/ 差分/ 对/ (/ α/ ,/ β/ )/ 中/ ,/ 平均/ 意义/ 下/ ,/ 有/ 15.3/ %/ 的/ (/ α/ ,/ β/ )/ 对应/ 的/ N/ (/ α/ ,/ β/ )/ ≠/ 0/ ,/ 且/ N/ (/ α/ ,/ β/ )/ 的/ 平均值/ 为/ 6.53/ ./ 表/ 2/ 输入/ 差分/ 在/ 单个/ 半/ 字节/ 上非/ 零时/ 超级/ S/ 盒/ 差分/ 特性/ N/ (/ α/ ,/ β/ )/ 出现/ 次数/ 最大值/ 概率/ 累加/ 值/ 平均值/ 0332972400.84700/ ≠/ 0602436960.15339321606/ ./ 53/ (/ 2/ )/ 输入/ 差/ 分为/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ 或/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ (/ α/ i/ 非零/ )/ 的/ 情形/ ./ 此时/ ,/ 输入/ 差分/ 共有/ 2/ ×/ (/ 24/ -/ 1/ )/ 2/ =/ 510/ 个/ 可能/ 取值/ ,/ 考虑/ 输出/ 差分/ 的/ 分布/ 情况/ ,/ 输入/ // 输出/ 差分/ 对/ 共有/ 510/ ×/ 216/ 种/ 取值/ ,/ 统计/ N/ (/ α/ ,/ β/ )/ 的/ 取值/ 情况/ ,/ 结果/ 如表/ 3/ 所示/ ./ 表/ 3/ 说明/ ,/ 当/ 超级/ S/ 盒/ 的/ 输入/ 差分/ 形式/ 为/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ 和/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ ,/ 其中/ α/ i/ 非/ 零时/ ,/ 平均/ 意义/ 下/ ,/ 26.3/ %/ 的/ 概率/ N/ (/ α/ ,/ β/ )/ ≠/ 0/ ,/ 且/ 当/ N/ (/ α/ ,/ β/ )/ ≠/ 0/ 时/ ,/ 其/ 平均值/ 为/ 3.8/ ./ 表/ 3/ 输入/ 差/ 分为/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ 和/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ 时/ N/ (/ α/ ,/ β/ )/ 出现/ 次数/ 最大值/ 概率/ 累加/ 值/ 平均值/ 02462668400.73700/ ≠/ 08796676960.263334233603/ ./ 80/ (/ 3/ )/ 超级/ S/ 盒/ 的/ 扰动/ 差分/ 传播/ 特性/ ./ 为了/ 确切/ 地/ 研究/ Piccolo/ 算法/ 故障/ 攻击/ 时/ 超级/ S/ 盒/ 的/ 差分/ 传播/ 性质/ ,/ 我们/ 根据/ 攻击/ 算法/ 所示/ 的/ 差分/ 传播/ 特点/ (/ 图/ 9/ ,/ 图/ 10/ )/ ,/ 建立/ 图/ 6/ 所示/ 的/ 差分/ 分析模型/ ./ 仍然/ 考虑/ 输入/ 差/ 分为/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ 或/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ (/ α/ i/ 非零/ )/ 的/ 情形/ ./ 假设/ 给定/ 输入/ 差分/ α/ 时/ ,/ 输出/ 差分/ 共有/ n/ 个/ 可能/ 值/ ./ 图/ 6/ 中/ β/ i/ 表示/ α/ 对应/ 的/ 第/ i/ 个/ 输出/ 差/ 分值/ ;/ θ/ 表示/ 输出/ 差分/ 的/ 未知/ 部分/ (/ 扰动/ )/ ,/ 经过/ 分析/ ,/ θ/ 共有/ 32/ 个/ 可能/ 值/ ,/ θ/ i/ 表示/ θ/ 的/ 第/ i/ 个/ 可能/ 取值/ ./ ①/ 输入/ 差分/ α/ ∈/ {/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ |/ α/ i/ ≠/ 0/ }/ ./ 对/ 随机/ 给定/ 的/ α/ ,/ 首先/ 获得/ 其/ 所有/ 可能/ 的/ 输出/ 差分/ 组成/ 的/ 集合/ OUTD/ α/ ,/ 因此/ 对于/ 任意/ β/ ∈/ OUTD/ α/ ,/ 必有/ N/ (/ α/ ,/ β/ )/ >/ 0/ ,/ 此时/ 我们/ 对/ β/ 进行/ 一个/ 扰动/ 获得/ γ/ =/ β/ / θ/ ,/ 其中/ θ/ ∈/ {/ (/ θ/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ θ/ 2/ ,/ 0/ ,/ 0/ )/ |/ θ/ i/ ∈/ / N/ (/ α/ ,/ γ/ )/ >/ 0/ 是否/ 成立/ ./ 对/ 随机/ 给定/ 的/ α/ 和/ θ/ ,/ 我们/ 可以/ 利用/ 如下/ 的/ 算法/ 1/ 得到/ N/ (/ α/ ,/ γ/ )/ >/ 0/ 成立/ 的/ 平均/ 概率/ P/ 以及/ 成立/ 时/ 方程/ SS/ (/ α/ / x/ )/ / SS/ (/ x/ )/ =/ γ/ 解/ 的/ 平均/ 数目/ M/ ./ ①/ 另/ 可/ 参见/ :/ DaemenJ/ ,/ RijmenV/ ./ Two/ -/ roundAESdifferen/ -/ tials/ ./ CryptologyePrintArchive/ ,/ 2006/ ,/ http/ :/ // // eprint/ ./ ia/ -/ Page5/ 算法/ 1/ ./ 超级/ S/ 盒/ 的/ 扰动/ 差分/ 传播/ 特性/ ./ 输入/ :/ Set/ (/ α/ )/ =/ {/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ |/ α/ i/ ≠/ 0/ }/ ,/ 输出/ :/ P/ 及/ MCOUNT/ (/ α/ ,/ β/ )/ =/ 0/ ,/ A/ γ/ (/ α/ ,/ β/ )/ =/ 0For/ α/ ∈/ Set/ (/ α/ )/ OUTD/ α/ ←/ {/ β/ |/ N/ (/ α/ ,/ β/ )/ >/ 0/ }/ P/ (/ α/ )/ =/ ∑/ β/ ∈/ OUTD/ α/ M/ (/ )/ α/ =/ ∑/ β/ ∈/ OUTD/ α/ EndForP/ =/ ∑/ α/ ∈/ Set/ (/ α/ )/ M/ =/ ∑/ α/ ∈/ Set/ (/ α/ )/ ②/ 输入/ 差分/ α/ ∈/ {/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ |/ α/ i/ ≠/ 0/ }/ ./ 分析/ 过程/ 与/ ①/ 类似/ ,/ 区别/ 仅为/ θ/ ∈/ {/ (/ 0/ ,/ 0/ ,/ θ/ 3/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ θ/ 4/ )/ |/ θ/ i/ ∈/ / ①/ ②/ 情形/ 下/ ,/ 输入/ 差分/ 均/ 有/ (/ 24/ -/ 1/ )/ 2/ =/ 225/ 个/ 可能/ 取值/ ./ 按照/ 图/ 6/ 所示/ 的/ 模型/ 分别/ 得到/ 超级/ S/ 盒图/ 7Piccolo/ 差分/ 故障/ 分析/ 的/ 相关/ 记号/ 示意图/ 4.2/ Piccolo/ 算法/ 差分/ 故障/ 分析/ 的/ 模型/ 和/ 原理/ Piccolo/ 算法/ 采用/ 的/ S/ 盒/ 输入输出/ 均/ 为/ 4/ -/ bit/ ,/ 所以/ 我们/ 采用/ 基于/ 半/ 字节/ 的/ 随机/ 故障/ 诱导/ 模型/ ./ 假定/ 攻击者/ 可以/ 对/ 算法/ 运行/ 过程/ 中/ 某/ 时刻/ 的/ 指定/ 存储/ 单/ 对应/ 的/ 扰动/ 差分/ 传播/ 性质/ ,/ 见表/ 4/ ./ 表/ 4/ 超级/ S/ 盒/ 的/ 扰动/ 差分/ 传播/ 特性/ (/ α/ 犻/ 非/ 零/ )/ α/ 的/ 取值/ 形式/ (/ α/ 1/ ,/ α/ 2/ ,/ 0/ ,/ 0/ )/ (/ 0/ ,/ 0/ ,/ α/ 3/ ,/ α/ 4/ )/ 4/ 对/ Piccolo/ 算法/ 的/ 差分/ 故障/ 分析/ 4.1/ 基本/ 记号/ 和/ 符号/ 为/ 简单/ 起/ 见/ ,/ 给出/ 以下/ 基本/ 记号/ 和/ 符号/ (/ 见图/ 7/ )/ :/ 记/ 明文/ 为/ P/ =/ (/ X0/ |/ X1/ |/ X2/ |/ X3/ )/ ,/ 密文/ 为/ C/ =/ (/ C0/ |/ C1/ |/ C2/ |/ C3/ )/ ;/ INi/ :/ 第/ i/ 轮/ 的/ 输入/ ,/ INi/ =/ INi0/ |/ INi1/ |/ INi2/ |/ INi3/ ,/ IN0/ =/ P/ ;/ OUTi/ :/ 第/ i/ 轮/ 的/ 输出/ ,/ OUTi/ =/ OUTi0/ |/ OUTi1/ |/ OUTi2/ |/ OUTi3/ ,/ OUT25/ =/ C/ ;/ OUTFi/ :/ 第/ i/ 轮/ F/ 变换/ 层/ 的/ 输出/ ,/ OUTFi/ =/ OUTFi0/ |/ OUTFi1/ |/ OUTFi2/ |/ OUTFi3/ ,/ RP/ (/ OUTFi/ )/ =/ OUTi/ ;/ INSSiL/ 或/ INSSiR/ :/ 第/ i/ 轮/ 左边/ (/ 或/ 右边/ )/ F/ 函数/ (/ 超级/ S/ 盒/ )/ 的/ 输入/ ;/ OUTSSiL/ 或/ OUTSSiR/ :/ 第/ i/ 轮/ 左边/ (/ 或/ 右边/ )/ F/ 函数/ (/ 超级/ S/ 盒/ )/ 的/ 输出/ ;/ 〈/ X/ 〉/ :/ X/ 所有/ 可能/ 取值/ 的/ 集合/ ;/ 〈/ X/ 〉/ :/ X/ 所有/ 可能/ 取值/ 的/ 个数/ ;/ Δ/ X/ :/ X/ 的/ 差/ 分值/ ,/ 即/ 假设/ 有/ 两个/ X/ :/ x1/ ,/ x2/ ,/ 则/ Δ/ X/ =/ x1/ / x2/ ./ 元/ (/ 如/ 第/ i/ 个/ 寄存器/ )/ 诱导/ 随机/ 的/ 半/ 字节/ 故障/ ,/ 但/ 不/ 知道/ 故障/ 对应/ 的/ 半/ 字节/ 在/ 存储单元/ 中/ 的/ 位置/ 及/ 具体/ 取值/ ./ 对于/ 同一个/ 明文/ P/ ,/ 攻击者/ 可以/ 获得/ 其/ 在/ 某/ 一/ 未知/ 密钥/ MK/ 下/ 加密/ 所得/ 的/ 正确/ 密文/ 和/ 错误/ 密文/ ./ Page6/ 对/ Piccolo/ 算法/ 的/ 差分/ 故障/ 分析/ 原理/ 如下/ :/ 对/ 任意/ 明文/ P/ 进行/ 加密/ ,/ 获取/ 对应/ 的/ 正确/ 密文/ C/ ./ 当/ 加密/ 过程/ 运行/ 到/ 第/ 24/ 轮时/ ,/ 在/ 输入/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 中/ 各/ 诱导/ 一次/ 半/ 字节/ 随机/ 故障/ ,/ 并/ 记录/ 相应/ 的/ 错误/ 密文/ CA/ 和/ CB/ ./ 根据/ 收集/ 到/ 的/ 正确/ 密文/ 与/ 错误/ 密文/ ,/ 利用/ 超级/ S/ 盒/ 的/ 差分/ 特性/ 对白/ 化/ 密钥/ wk2/ 和/ wk3/ 进行/ 筛选/ ./ 然后/ 利用/ 剩余/ 的/ wk2/ 和/ wk3/ 值/ 对/ 密文/ C/ 作/ 一轮/ 解密/ ,/ 同样/ 利用/ 超级/ S/ 盒/ 的/ 差分/ 特性/ 确定/ rkL49/ |/ rkR48/ 以及/ rkL48/ |/ rkR49/ 的/ 候选/ 值/ ,/ 依据/ 密钥/ 扩展/ 算法/ ,/ 得到/ MK/ 的/ 所有/ 可能/ 取值/ ,/ 最后/ 利用/ P/ 和/ C/ 进行/ 验证/ ,/ 确定/ 唯一/ 正确/ 的/ MK/ ./ 注意/ 到/ 很多/ 采用/ 广义/ Fesitel/ 结构/ 的/ 分组/ 密码/ 的/ 故障/ 分析方法/ 均/ 采用/ 了/ 上述/ 类似/ 模型/ ,/ 而/ 在/ 实际/ 攻击/ 过程/ 中/ ,/ 根据/ 攻击者/ 拥有/ 的/ 攻击/ 设备/ 和/ 条件/ ,/ 诱导/ 的/ 故障/ 可能/ 并/ 不/ 在/ 我们/ 期望/ 的/ 存储单元/ 中/ (/ 如/ 第/ 24/ 轮/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 中/ )/ ,/ 这时/ 我们/ 可/ 借助于/ 错误/ 密文/ 与/ 正确/ 密文/ 的/ 差分/ 来/ 判断/ 故障/ 诱导/ 的/ 位置/ 是否/ 恰好/ 在/ 所/ 需/ 的/ 寄存器/ 上/ ./ 如图/ 8/ 所示/ ,/ 若/ 故障/ 发生/ 在/ 第/ 24/ 轮/ 输入/ 的/ 第/ 2/ 个/ 寄存器/ 上/ (/ 不论/ 发生/ 在/ 哪个/ 半/ 字节/ 位置/ )/ ,/ 则/ 对应/ 密文/ 差分/ 的/ 活跃/ 字节数/ 不/ 超过/ 3/ 个/ ./ 类似/ 地/ ,/ 若/ 故障/ 发生/ 在/ 第/ 24/ 轮/ 的/ 第/ 4/ 个/ 寄存器/ 上/ ,/ 则/ 对应/ 密文/ 差分/ 的/ 活跃/ 字节数/ 也/ 不/ 超过/ 3/ 个/ ./ 而/ 由/ 图/ 9/ 和/ 图/ 10/ 可知/ ,/ 若/ 故障/ 发生/ 在/ 第/ 24/ 轮/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 上/ ,/ 则/ 对应/ 密文/ 差分/ 的/ 活跃/ 字节数/ 超过/ 4/ 个/ ./ 进一步/ ,/ 若/ (/ Δ/ C0/ )/ R/ =/ 0/ ,/ 则/ 故障/ 位于/ 第/ 1/ 个/ 寄存器/ ;/ 若/ (/ Δ/ C0/ )/ R/ ≠/ 0/ ,/ 则/ 故障/ 位于/ 第/ 3/ 个/ 寄存器/ ./ 图/ 8/ 在/ 第/ 24/ 轮/ 输入/ 的/ 第/ 2/ 个/ 寄存器/ 处/ 诱导/ 随机/ 半/ 字节/ 由/ 以上/ 分析/ 可知/ ,/ 通过/ 观测/ 正确/ 密文/ 与/ 对应/ 错误/ 密文/ 的/ 差分/ ,/ 可以/ 有效/ 地/ 判断/ 故障/ 所在/ 的/ 寄存器/ ,/ 快速/ 筛选/ 出/ 有效/ 的/ 错误/ 密文/ 进行/ 分析/ ,/ 从而/ 提高/ 攻击/ 的/ 效率/ ./ 图/ 9/ 诱导/ 的/ 随机/ 半/ 字节/ 故障/ 在/ A/ 处时/ 差分/ 传播/ 示意图/ 图/ 10/ 诱导/ 的/ 随机/ 半/ 字节/ 故障/ 在/ B/ 处时/ 差分/ 传播/ 示意图/ 4.3/ 攻击/ 的/ 详细/ 步骤/ 攻击/ 过程/ 按照/ 如下/ 5/ 个/ 步骤/ 进行/ :/ 1/ ./ 故障/ 诱导/ 和/ 数据/ 收集/ ./ 任意/ 选择/ 一个/ 明文/ P/ ,/ 在/ 种子/ 密钥/ MK/ 的/ 作用/ 下/ 加密/ ,/ 记录/ 正确/ 密文/ C/ ,/ 当/ 算法/ 运行/ 至/ 第/ 24/ 轮时/ ,/ 在/ 输入/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 中/ 分别/ 诱导/ 随机/ 半/ 字节/ 故障/ ,/ 并/ 记录/ 相应/ 的/ 错误/ 密文/ CA/ 和/ CB/ ./ 这里/ ,/ CA/ 表示/ 故障/ 位于/ IN240/ 处/ (/ 图/ 9/ 中/ 的/ A/ 所示/ 位置/ )/ 时/ 对应/ 的/ 错误/ 密文/ ,/ CB/ 表示/ 故障/ 位于/ IN242/ 处/ (/ 图/ 10/ 中/ 的/ B/ 所示/ 位置/ )/ 时/ 对应/ 的/ 错误/ 密文/ ./ 故障/ 诱导/ 后/ 引入/ 的/ 差分/ 传播/ 如图/ 9/ 和/ 图/ 10/ 所示/ ./ 2/ ./ 获取/ wk2/ ,/ wk3/ ,/ rk48/ ,/ rk49/ 的/ 所有/ 可能/ 候选/ 值/ ./ 2a/ ./ 通过/ 正确/ 密文/ C/ 与/ 错误/ 密文/ CA/ ,/ 得到/ F/ 函数/ 亦/ 即/ 超级/ S/ 盒/ 的/ 输入/ // 输出/ 差分/ ,/ 根据/ 超级/ S/ 盒/ 的/ 差分/ 特性/ 进行/ 筛选/ ,/ 获得/ 所有/ 可能/ 的/ 输入/ 值/ INSS25L/ 及/ INSS25R/ ,/ 由于/ IN/ -/ SS25L/ / wk2/ =/ C0/ ,/ INSS25R/ / wk3/ =/ C2/ ,/ 可得/ wk2/ 的/ 候选/ 值/ 集合/ 〈/ wk2A/ 〉/ ,/ wk3/ 的/ 候选/ 值/ 集合/ 〈/ wk3A/ 〉/ ./ 进一步/ ,/ 利用/ C/ 与/ 错误/ 密文/ CB/ 进行/ 分析/ ,/ 可/ 得到/ wk2/ 的/ 候选/ 值/ 集合/ 〈/ wk2B/ 〉/ 及/ wk3/ 的/ Page7/ 候选/ 值/ 集合/ 〈/ wk3B/ 〉/ ./ 求/ 〈/ wk2A/ 〉/ 与/ 〈/ wk2B/ 〉/ 的/ 交集/ ,/ 得到/ 筛选/ 后/ 的/ wk2/ 候选/ 值/ 集合/ 〈/ wk2/ 〉/ ;/ 求/ 〈/ wk3A/ 〉/ 与/ 〈/ wk3B/ 〉/ 的/ 交集/ ,/ 得到/ 筛选/ 后/ 的/ wk3/ 候选/ 值/ 集合/ 〈/ wk3/ 〉/ ./ 2b/ ./ 利用/ 步/ 2a/ 中/ 得到/ 的/ wk2/ ∈/ 〈/ wk2/ 〉/ ,/ wk3/ ∈/ 〈/ wk3/ 〉/ ,/ 对/ C/ 及/ CA/ 、/ CB/ 进行/ 一轮/ 解密/ ,/ 并/ 记录/ 对应/ 的/ 差/ 分值/ (/ Δ/ OUTF24/ )/ A/ 及/ (/ Δ/ OUTF24/ )/ B/ 及/ 由/ 正确/ 密文/ C/ 进行/ 一轮/ 解密/ 得到/ 的/ OUTF240/ 及/ OUTF242/ ./ 利用/ 超级/ S/ 盒/ 的/ 差分/ 特性/ ,/ 可/ 获得/ 所有/ 可能/ 的/ 输入/ 值/ INSS24L/ 及/ INSS24R/ ,/ 由于/ INSS24L/ / (/ rkL49/ |/ rkR48/ )/ =/ OUTF240/ ,/ INSS24R/ / (/ rkL48/ |/ rkR49/ )/ =/ OUTF242/ ,/ 可得/ rkL49/ |/ rkR48/ 及/ rkL48/ |/ rkR49/ 的/ 候选/ 值/ 集合/ 〈/ rkL49/ |/ rkR48/ 〉/ 、/ 〈/ rkL48/ |/ rkR49/ 〉/ ./ 3/ ./ 根据/ 密钥/ 扩展/ 算法/ ,/ 得到/ MK/ 中/ 对应/ 的/ k3/ ,/ k4/ ,/ k0/ ,/ k1/ 对应/ 的/ 候选/ 值/ 集合/ 〈/ k3/ 〉/ ,/ 〈/ k4/ 〉/ ,/ 〈/ k0/ 〉/ ,/ 〈/ k1/ 〉/ ./ 4/ ./ 穷/ 搜索/ k2/ ,/ 得到/ MK/ 的/ 候选/ 值/ 集合/ 〈/ MK/ 〉/ ./ 5/ ./ 利用/ P/ 和/ C/ ,/ 通过/ EMK/ (/ P/ )/ =/ C/ 验证/ ,/ 得到/ 唯一/ 正确/ 密钥/ MK/ ./ 4.4/ 复杂度/ 分析/ 步/ 2a/ 的/ 复杂度/ ./ 通过/ 步/ 1/ 中/ 收集/ 到/ 的/ 正确/ 密文/ C/ 与/ 错误/ 密文/ CA/ ,/ 可以/ 确定/ Δ/ INSS25L/ ,/ Δ/ INSS25R/ 的/ 值/ ,/ 由于/ 故障/ 位置/ 未知/ ,/ Δ/ OUTSS25L/ 及/ Δ/ OUTSS25R/ 分别/ 有/ 2/ ×/ 24/ =/ 32/ 种/ 可能/ 取值/ ./ 按照/ 3.3/ 节/ 所述/ 分析模型/ ,/ 超级/ S/ 盒/ 的/ 输入/ 差分/ α/ 值/ 已经/ 确定/ ,/ 但/ 它/ 对应/ 的/ 输出/ 差分/ β/ 未知/ ,/ 但/ 我们/ 知道/ 输出/ 差分/ 候选/ 值/ 共有/ 32/ 个/ ,/ 在/ 这/ 32/ 个/ 可能/ 取值/ 中/ ,/ 31/ 个/ 可以/ 视为/ 对/ β/ 扰动/ 之后/ 得到/ 的/ 差分/ γ/ ,/ 根据/ 超级/ S/ 盒/ 的/ 扰动/ 差分/ 传播/ 特性/ (/ 表/ 4/ )/ ,/ 平均/ 意义/ 下/ α/ 和/ γ/ 能够/ 匹配/ 的/ 概率/ 为/ 42.6/ %/ 且/ 匹配/ 后/ 的/ 平均值/ 为/ 3.675/ ./ 由此/ 可/ 得/ ,/ 平均/ 意义/ 下/ INSS25L/ 共有/ 3.8/ +/ 31/ ×/ 0.426/ ×/ 3.675/ ≈/ 52/ 个/ 可能/ 取值/ ;/ 类似/ 地/ ,/ INSS25R/ 约/ 有/ 3.8/ +/ 31/ ×/ 0.43/ ×/ 3.684/ ≈/ 53/ 种/ 可能/ 取值/ ,/ 对应/ 可/ 得/ 〈/ wk2A/ 〉/ ≈/ 52/ ,/ 〈/ wk3A/ 〉/ ≈/ 53/ ;/ 同样/ 地/ ,/ 利用/ C/ 与/ 错误/ 密文/ CB/ 进行/ 分析/ ,/ 可/ 得/ 平均/ 意义/ 下/ ,/ 〈/ wk2B/ 〉/ 与/ 〈/ wk3B/ 〉/ 也/ 分别/ 为/ 53/ 和/ 52/ ./ 由于/ 正确/ 的/ wk2/ 和/ wk3/ 一定/ 会/ 包含/ 在/ 各个/ 候选/ 值/ 集合/ 中/ ,/ 而/ 216/ ×/ (/ 52/ // 216/ )/ ×/ (/ 53/ // 216/ )/ </ 1/ ,/ 所以/ 平均/ 意义/ 下/ ,/ 对/ 两次/ 的/ 候选/ 值/ 集合/ 求/ 交集/ 后/ ,/ 〈/ wk2/ 〉/ =/ 1/ ,/ 〈/ wk3/ 〉/ =/ 1/ ./ 步/ 2b/ 的/ 复杂度/ ./ 由/ 3.2/ 节/ 所述/ 差分/ 传播/ 性质/ (/ 1/ )/ 和/ (/ 2/ )/ 可知/ ,/ (/ Δ/ OUTF241/ )/ A/ 、/ (/ Δ/ OUTF243/ )/ B/ 可/ 直接/ 由/ 对应/ 的/ 密文/ 差分/ 观测/ 到/ ./ 求/ 交集/ 后/ 〈/ wk2/ 〉/ =/ 1/ ,/ 〈/ wk3/ 〉/ =/ 1/ ,/ 利用/ wk2/ 和/ wk3/ 进行/ 一轮/ 解密/ 后/ ,/ (/ Δ/ OUTF240/ )/ A/ 及/ (/ Δ/ OUTF242/ )/ B/ 的/ 取值/ 也/ 可/ 相应/ 确定/ ,/ 即/ 超级/ S/ 盒/ 的/ 输入/ // 输出/ 差分/ 均/ 可/ 确定/ ./ 根据/ 超级/ S/ 盒/ 差分/ 特性/ (/ 表/ 2/ )/ ,/ 可/ 得/ 平均/ 意义/ 下/ rkL49/ |/ rkR48/ 的/ 候选/ 值/ 个数/ 为/ 6.53/ 个/ ,/ rkL48/ |/ rkR49/ 的/ 候选/ 值/ 个数/ 也/ 为/ 6.53/ 个/ ./ 步/ 3/ 的/ 复杂度/ ./ 根据/ 密钥/ 扩展/ 算法/ 知/ 〈/ k3/ 〉/ =/ 1/ ,/ 〈/ k4/ 〉/ =/ 1/ ,/ 〈/ k0/ 〉/ ×/ 〈/ k1/ 〉/ =/ (/ 6.53/ )/ 2/ ≈/ 25.4/ ./ 步/ 4/ 的/ 复杂度/ ./ 穷/ 搜索/ k2/ ,/ 可/ 得到/ MK/ 的/ 候选/ 值/ 个数/ 为/ N/ =/ 1/ ×/ 1/ ×/ 25.4/ ×/ 216/ ≈/ 221.4/ 个/ ./ 注意/ 到/ 在/ 随机/ 给定/ 超级/ S/ 盒/ 输入/ // 输出/ 差分/ 的/ 情况/ 下/ ,/ 要/ 找到/ 所有/ 合适/ 的/ 输入/ 值/ ,/ 需/ 进行/ 216/ 次/ 搜索/ ./ 步/ 2a/ 需要/ 2/ ×/ 216/ ×/ 32/ =/ 222/ 次/ 搜索/ ,/ 步/ 2b/ 需要/ 2/ ×/ 216/ 次/ 搜索/ ,/ 即/ 在/ 得到/ MK/ 候选/ 值前/ 共/ 需要/ 约/ 222/ 次/ 搜索/ ./ 若/ 采用/ 预计/ 算/ 模式/ ,/ 即/ 事先/ 计算/ 并/ 存储/ 超级/ S/ 盒/ 输入/ // 输出/ 差分/ 与/ 输入/ 值/ 的/ 对应/ 关系/ ,/ 则/ 可/ 省去/ 搜索/ 时间/ ,/ 但/ 需要/ 耗费/ 约/ 60/ ×/ 216/ ×/ 16/ +/ 510/ ×/ 216/ ×/ 16bits/ ≈/ 226Bytes/ 的/ 存储空间/ ./ 分析/ 结果表明/ ,/ 通过/ 在/ 第/ 24/ 轮/ 输入/ 状态/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 各/ 诱导/ 1/ 个/ 随机/ 半/ 字节/ 故障/ ,/ 利用/ 正确/ 密文/ 与/ 2/ 个/ 错误/ 密文/ 进行/ 分析/ ,/ 能够/ 将/ Piccolo/ 算法/ 80/ -/ bit/ 的/ 密钥/ 空间/ 缩小/ 至约/ 22/ -/ bit/ ./ 5/ 实验/ 及/ 结果/ 在/ PC机/ 上/ (/ CPU/ :/ PentiumDual/ -/ CoreE67003/ ./ 20GHz/ ,/ RAM/ :/ 2GB/ )/ 使用/ C++/ 语言/ 编程/ (/ Visual/ C++/ 6.0/ )/ 对/ 本文/ 给出/ 的/ 攻击/ 方法/ 进行/ 了/ 200/ 次/ 模拟实验/ ./ 对/ k0/ ,/ k1/ ,/ k3/ ,/ k4/ 共/ 64/ -/ bit/ 的/ 种子/ 密钥/ 搜索/ 空间/ 分布/ 情况/ 进行/ 统计/ ,/ 结果/ 如图/ 11/ 所示/ ,/ 64/ -/ bit/ 种子/ 密钥/ 的/ 平均/ 搜索/ 空间/ 约/ 为/ 6/ -/ bit/ ,/ 加上/ 对/ k2/ 的/ 搜索/ ,/ 对/ 种子/ 密钥/ 的/ 搜索/ 空间/ 平均/ 约/ 为/ 22/ -/ bit/ ./ 附录/ 给出/ 了/ 一组/ 实际/ 的/ 攻击/ 实验/ 数据/ 及其/ 结果/ ./ 图/ 11/ 对/ 64/ -/ bit/ 密钥/ (/ k0/ ,/ k1/ ,/ k3/ ,/ k4/ )/ 的/ 搜索/ 量/ 分布图/ 6/ 结语/ 本文/ 提出/ 了/ 在/ 半/ 字节/ 随机/ 故障/ 诱导/ 模型/ 下/ 对/ Piccolo/ -/ 80/ 算法/ 的/ 差分/ 故障/ 分析方法/ ,/ 给出/ 了/ Piccolo/ 算法/ 的/ 一个/ 等价/ 结构/ ,/ 将/ S/ -/ P/ -/ S/ 结构/ 整体/ 视为/ 超级/ S/ 盒/ ,/ 并/ 根据/ 所/ 采用/ 的/ 故障/ 模型/ 研究/ 了/ 超级/ S/ 盒/ 的/ 部分/ 差分/ 传播/ 性质/ ./ 理论/ 分析/ 和/ 实验/ 结果表明/ ,/ 在/ 第/ 24/ 轮/ 的/ 第/ 1/ 个/ 和/ 第/ 3/ 个/ 寄存器/ 各/ 诱导/ 1/ 个/ 随机/ 半/ 字节/ 故障/ ,/ 可/ 将/ 80/ -/ bit/ 的/ 密钥/ 空间/ 缩小/ 至约/ 22/ -/ bit/ ./ Page8/ 这/ 表明/ 为/ 安全/ 使用/ Piccolo/ 算法/ ,/ 在/ 其实/ 现时/ 必须/ 做/ 一定/ 的/ 防护/ 措施/ ./ 

