Page1/ 基于/ 非/ 下/ 采样/ Contourlet/ 变换/ 的/ 视网膜/ 分割/ 钟桦/ 焦/ 李成/ 侯鹏/ (/ 西安电子科技大学/ 智能/ 感知/ 与/ 图像/ 理解/ 教育部/ 重点/ 实验室/ 西安/ 710071/ )/ 摘要/ 基于/ 非/ 下/ 采样/ Contourlet/ 变换/ (/ NSCT/ )/ 良好/ 的/ 多/ 尺度/ 、/ 多/ 方向/ 和/ 平移/ 不变性/ 等/ 优点/ ,/ 提出/ 了/ 一种/ 基于/ NSCT/ 的/ 视网膜/ 图像/ 分割/ 方法/ ./ 该/ 方法/ 首先/ 通过/ 分析/ NSCT/ 变换/ 对/ 血管/ 的/ 系数/ 响应/ ,/ 提出/ 基于/ NSCT/ 的/ 线状/ 特征提取/ 算法/ ./ 随后/ 对/ 所/ 提取/ 的/ 特征向量/ 利用/ 高斯/ 混合/ 模型/ (/ GMM/ )/ 进行/ 建模/ ,/ 并/ 采用/ EM/ 算法/ 估计/ 其/ 参数/ ./ 最后/ 采用/ 贝叶斯/ 规则/ 对/ 血管/ 和/ 非/ 血管/ 像素/ 进行/ 分类/ ,/ 以/ 达到/ 图像/ 分割/ 的/ 目的/ ./ 在/ DRIVE/ 和/ STARE/ 两个/ 数据库/ 上/ 的/ 实验/ 结果表明/ ,/ 基于/ NSCT/ 的/ 线状/ 特征提取/ 算法/ 能够/ 很/ 好/ 地/ 表征/ 血管/ 目标/ ,/ 在/ 血管/ 的/ 分割/ 正确率/ 和/ 定位精度/ 等/ 指标/ 上/ 表现/ 出/ 良好/ 的/ 性能/ ./ 关键词/ 视网膜/ 分割/ ;/ NSCT/ ;/ 线状/ 特征/ ;/ 高斯/ 混合/ 模型/ ;/ 贝叶斯/ 规则/ 1/ 引言/ 在/ 医学/ 领域/ ,/ 视网膜/ 图像/ 越来越/ 广泛/ 的/ 用于/ 病理学/ 诊断/ ./ 通过/ 对/ 视网膜/ 血管/ 系统/ 的/ 检查/ 可以/ 发现/ 高血压/ 、/ 糖尿病/ 、/ 动脉硬化/ 等/ 疾病/ ./ 在/ 视网膜/ 图像/ 中/ ,/ 血管/ 占/ 支配/ 地位/ 并且/ 结构/ 稳定/ ./ 因此/ ,/ 可靠/ 的/ 血管/ 提取/ 是/ 视网膜/ 图像/ 分析/ 和/ 处理/ 的/ 先决条件/ ./ 目前/ ,/ 国内外/ 的/ 专家/ 们/ 提出/ 了/ 许多/ 视网膜/ 血管/ 增强/ 和/ 分割/ 的/ 方法/ ,/ 包括/ 基于/ 血管/ 跟踪/ 的/ 方法/ [/ 1/ -/ 3/ ]/ 、/ 基于/ 匹配/ 滤波/ 的/ 血管/ 增强/ [/ 4/ -/ 6/ ]/ 以及/ 基于/ 非线性/ 滤波器/ [/ 7/ ]/ 和/ 数学/ 形态学/ 滤波/ 的/ 方法/ [/ 8/ ]/ ./ Jiang/ 等/ 人/ [/ 9/ ]/ 提出/ 了/ 一种/ 基于/ 验证/ 的/ 多/ 阈值/ 探查/ 方案/ 以/ 实现/ 自/ 适应/ 局部/ 阈值/ 分割/ ,/ 即先/ 通过/ 假定/ 的/ 阈值/ 进行/ 二值化/ 得到/ 假定/ 的/ 目标/ ,/ 然后/ 通过/ 验证/ 程序/ 决定/ 接受/ 还是/ 放弃/ 该/ 目标/ ./ Staal/ 等/ 人/ [/ 10/ ]/ 利用/ 脊/ 检测/ 的/ 方法/ 提取/ 视网膜/ 血管/ 特征向量/ ./ 这/ 两种/ 方法/ 均/ 取得/ 了/ 较/ 好/ 的/ 效果/ ./ Yao/ 等/ 人/ [/ 11/ ]/ 则/ 采用/ 向量场/ 散度/ 及/ 改进/ 的/ 定向/ 局部/ 对比度/ 等/ 方法/ ,/ 先/ 获取/ 血管/ 中心线/ 再/ 分割/ 出/ 最终/ 的/ 血管/ 网络/ ./ 针对/ 光照/ 影响/ ,/ Du/ 等/ 人/ [/ 12/ ]/ 在/ 传统/ Mumford/ -/ Shah/ 模型/ 的/ 基础/ 上/ 引入/ Gabor/ 小波/ 变换/ 取得/ 了/ 较/ 好/ 结果/ ,/ 而/ Lam/ 等/ 人/ [/ 13/ ]/ 提出/ 一种/ 多/ 触点/ 模型/ ,/ 很/ 好/ 地/ 克服/ 了/ 光照/ 影响/ ,/ 对/ 正常/ 及/ 病态/ 视网膜/ 均/ 取得/ 了/ 优异/ 的/ 性能/ ./ 基于/ 监督/ 的/ 血管/ 分割/ 方法/ 在/ 近几年/ 取得/ 了/ 较大/ 进展/ ,/ 其/ 关键问题/ 在于/ 血管/ 特征/ 的/ 提取/ ./ Salem/ 等/ 人/ [/ 14/ ]/ 利用/ 窗口/ 估计/ 提取/ 绿色/ 分量/ 灰度/ 值/ 、/ 局部/ 梯度/ 最大值/ 和/ 局部/ 最大/ 特征值/ 作为/ 特征向量/ ./ Soares/ 等/ 人/ [/ 15/ ]/ 提出/ 利用/ Gabor/ 小波/ 的/ 多/ 尺度/ 和/ 多/ 方向/ 特性/ 来/ 产生/ 特征向量/ ,/ 取得/ 了/ 较/ 好/ 的/ 结果/ ./ 但是/ 由于/ Gabor/ 小波基/ 函数/ 的/ 非/ 正交/ 性/ 、/ 倍频/ 性能/ 不够/ 显著/ 等/ 缺点/ ,/ 对/ 血管/ 奇异/ 性/ 的/ 描述/ 存在/ 本质/ 的/ 不足/ ./ Gabor/ 小波/ 的/ 另/ 一个/ 缺点/ 是/ 参数/ 调整/ 比较复杂/ ,/ 限制/ 了/ 其/ 应用/ ./ 近几年/ ,/ 多/ 尺度/ 几何/ 理论/ 的/ 发展/ 为/ 图像处理/ 提供/ 了/ 新/ 的/ 思路/ ./ 其中/ Contourlet/ 以其/ 良好/ 的/ 多/ 尺度/ 、/ 多/ 方向/ 、/ 平移/ 不变/ 等/ 性能/ ,/ 获得/ 了/ 较为/ 广泛/ 的/ 应用/ [/ 16/ ]/ ./ 在/ Contourlet/ 的/ 基础/ 上/ ,/ daCunha/ 等/ 人/ [/ 17/ ]/ 给出/ 了/ 其/ 平移/ 不变/ 形式/ ,/ 即/ NSCT/ (/ NonsubsampledContourletTransform/ )/ ./ 在/ NSCT/ 变换/ 的/ 基础/ 上/ 图像去噪/ 、/ 融合/ 、/ 增强/ 等/ 算法/ 均/ 取得/ 了/ 较/ 好/ 的/ 效果/ [/ 18/ -/ 20/ ]/ ./ 本文/ 提出/ 一种/ 基于/ NSCT/ 的/ 血管/ 特征提取/ 算法/ 并/ 用于/ 视网膜/ 图像/ 分割/ ./ 该/ 特征/ 的/ 优点/ 是/ :/ (/ 1/ )/ 由于/ NSCT/ 可以/ 从/ 多/ 方向/ 、/ 多/ 分辨/ 等/ 角度/ 对/ 图像/ 中/ 的/ 轮廓/ 和/ 纹理/ 等/ 方向/ 信息/ 进行/ 稀疏/ 表示/ ,/ 基于/ NSCT/ 的/ 血管/ 特征/ 对/ 图像/ 中/ 的/ 线状/ 奇异/ 性/ 具有/ 很强/ 的/ 表征/ 能力/ ;/ (/ 2/ )/ NSCT/ 变换/ 是/ 一种/ 固定/ 框架/ 的/ 多/ 尺度/ 多/ 方向/ 的/ 变换/ ,/ 能够/ 有效/ 地/ 避免/ Soares/ 等/ 人/ 提取/ Gabor/ 小波/ 特征/ 的/ 多/ 参数设置/ 问题/ ,/ 结果/ 更加/ 稳定/ ./ 实验/ 结果表明/ ,/ 本文/ 算法/ 在/ 分割/ 正确率/ 和/ 分割/ 精度/ 等/ 指标/ 上/ 表现/ 出/ 良好/ 的/ 性能/ ,/ 同时/ 具有/ 血管/ 虚警率/ 低/ 、/ 血管/ 粘连/ 现象/ 少/ 等/ 优点/ ,/ 有利于/ 视网膜/ 图像/ 的/ 自动/ 分析/ 和/ 诊断/ ./ 本文/ 第/ 2/ 节/ 首先/ 简要/ 介绍/ NSCT/ 的/ 基本原理/ ;/ 第/ 3/ 节/ 详细/ 介绍/ 基于/ NSCT/ 的/ 视网膜/ 血管/ 分割/ 算法/ ;/ 实验/ 结果/ 在/ 第/ 4/ 节中/ 给出/ ;/ 最后/ 在/ 第/ 5/ 节/ 给出/ 小结/ ./ 2/ 非下/ 采样/ Contourlet/ 变换/ (/ NSCT/ )/ 小波/ 对/ 具有/ 点状/ 奇异/ 的/ 目标/ 函数/ 是/ 最优/ 的/ 基/ ,/ 在/ 分析/ 这/ 类/ 目标/ 时小波/ 系数/ 是/ 稀疏/ 的/ ,/ 可是/ 小/ 波/ 分析/ 在/ 处理/ 一维/ 信号/ 时/ 表现/ 出/ 的/ 优异/ 特性/ 并/ 不能/ 简单/ 地/ 推广/ 到/ 二维/ 或/ 更/ 高维/ ./ 小波基/ 函数/ 在/ 描述/ 高维/ 数据/ 时/ 表现/ 出来/ 的/ 非/ 稀疏/ 性/ 以及/ 对/ 多/ 方向/ 信息/ 表示/ 的/ 缺乏/ ,/ 使得/ 多/ 尺度/ 几何/ 分析方法/ 应运而生/ ./ Contourlet/ 是/ Do/ 和/ Vetterli/ 于/ 2002/ 年/ 提出/ 的/ 一种/ 真正/ 的/ 图像/ 二维/ 表示/ 方法/ [/ 16/ ]/ ,/ 又/ 称为/ 塔形/ 方向/ 滤波器/ 组/ (/ PDFB/ )/ ./ 它/ 不仅/ 继承/ 了/ 小波/ 变换/ 的/ 多/ 分辨率/ 时频/ 分析/ 特性/ ,/ 而且/ 拥有/ 良好/ 的/ 各向异性/ 特征/ ,/ 能用/ 比小波/ 更少/ 的/ 系数/ 来/ 表示/ 光滑/ 的/ 曲线/ ./ 但是/ Contourlet/ 在/ 变换/ 过程/ 中/ ,/ 对/ 图像/ 进行/ 下/ 采样/ 操作/ ,/ 使得/ Contourlet/ 变换/ 不/ 具有/ 平移/ 不变性/ ./ 非下/ 采样/ Contourlet/ 变换/ (/ NSCT/ )/ 去掉/ 了/ Contourlet/ 变换/ 中/ 的/ 下/ 采样/ 操作/ ,/ 因此/ 具有/ 平移/ 不变性/ ,/ 能/ 更/ 准确/ 地/ 捕获/ 图像/ 中/ 的/ 几何/ 结构/ 信息/ ./ NSCT/ 由/ 非下/ 采样/ 拉普拉斯/ 塔型/ 分解/ (/ NSLP/ )/ 和/ 非下/ 采样/ 方向/ 滤波器/ 组/ (/ NSDFB/ )/ 组成/ ,/ 如图/ 1/ 所示/ ./ 图像/ 的/ NSCT/ 分解/ 分为/ 两/ 部分/ ,/ 首先/ 经过/ NSLP/ 分解/ 得到/ 不同/ 的/ 频率/ 子带/ ,/ 然后/ 再/ 由/ NSDFB/ 分解/ 得到/ 不同/ 的/ 方向/ 子带/ ,/ 其/ 2/ 层/ 分解/ 示意图/ 如图/ 1/ (/ a/ )/ 所示/ ;/ 图/ 1/ (/ b/ )/ 是/ NSCT/ 分解/ 后/ 图像/ 在/ 频率/ 平面/ 的/ 楔形/ 频带/ 划分/ ./ Page3/ 图/ 1/ 非下/ 采样/ Contourlet/ 变换/ 示意图/ 3/ 基于/ NSCT/ 的/ 视网膜/ 血管/ 分割/ 本节/ 在/ NSCT/ 的/ 多/ 尺度/ 性/ 、/ 多/ 方向性/ 、/ 平移/ 不变性/ 基础/ 上/ ,/ 通过/ 分析/ 视网膜/ 图像/ 中/ 血管/ 的/ 线状/ 奇异/ 性/ ,/ 提出/ 了/ 基于/ NSCT/ 的/ 特征提取/ 算法/ ./ 对/ 所/ 提取/ 的/ 特征向量/ 利用/ 高斯/ 混合/ 模型/ (/ GMM/ )/ 进行/ 建模/ ,/ 其中/ 参数估计/ 采用/ EM/ 算法/ ./ 最后/ 采用/ 贝叶斯/ 规则/ 对/ 血管/ 和/ 非/ 血管/ 进行/ 分类/ ,/ 以/ 达到/ 图像/ 分割/ 的/ 目的/ ./ 3.1/ 图像/ 预处理/ 由于/ 视网膜/ 圆形/ 基底/ 与/ 孔径/ 外/ 区域/ 存在/ 较强/ 的/ 对比度/ ,/ 分类/ 结果/ 在/ 孔径/ 边缘/ 处会/ 产生/ 大量/ 的/ 误判/ ./ 为/ 消除/ 这一/ 影响/ ,/ 通常/ 对/ 彩色/ 视网膜/ 图像/ 的/ 绿色/ 分量/ 进行/ 预处理/ ./ 这/ 是因为/ 绿色/ 分量/ 一般/ 具有/ 较/ 好/ 的/ 血管/ -/ 背景/ 对比度/ ./ 预处理/ 采用/ 迭代/ 算法/ 来/ 消除/ 视网膜/ 基底/ 和/ 孔径/ 图/ 2/ 视网膜/ 图像/ 预处理/ 3.2/ 特征分析/ 及/ 提取/ 视网膜/ 图像/ 像素/ 可/ 分为/ 血管/ 和/ 非/ 血管/ (/ 即/ 背景/ )/ 两类/ 目标/ ./ 其中/ 血管/ 目标/ 具有/ 明显/ 的/ 线状/ 奇异/ 性/ ,/ 而/ 背景/ 相对/ 比较/ 平滑/ ,/ 因此/ 非常适合/ 用/ NSCT/ 进行/ 稀疏/ 表示/ ./ 2/ ./ 对/ 像素/ 集合/ A/ 中/ 任一/ 像素/ ,/ 计算/ 其/ 邻域/ 均值/ 以/ 代替/ 该/ 像素/ 值/ ;/ 外/ 区域/ 的/ 强/ 对比度/ ./ 这种/ 迭代/ 算法/ 从/ 由/ 照相机/ 孔径/ 决定/ 的/ 感兴趣/ 区域/ ROI/ (/ RegionOfInterest/ )/ 开始/ ,/ 迭代/ 生长/ 该/ 区域/ ./ 设/ 感兴趣/ 区域/ 模板/ 为/ mask/ ,/ 算法/ 的/ 步骤/ 如下/ [/ 15/ ]/ :/ 1/ ./ 利用/ mask/ 找到/ ROI/ 区域/ 的/ 边界/ 像素/ 集合/ A/ ./ 边界/ 定义/ 为/ 位于/ ROI/ 区域/ 外部/ ,/ 但是/ 与/ 区域/ 内/ 的/ 像素/ 满足/ 4/ 邻域/ 关系/ 的/ 像素/ 集合/ ;/ 3/ ./ 将/ 集合/ A/ 中/ 像素/ 加入/ ROI/ 区域/ ;/ 返回/ 步/ 1/ ./ 迭代/ 执行/ 一定/ 次数/ 即可/ 减弱/ 视网膜/ 基底/ 和/ 孔径/ 外/ 区域/ 的/ 对比度/ ./ 本文/ 设定/ 迭代/ 次数/ 为/ 80/ ,/ 邻域/ 大小/ 为/ 5/ ×/ 5/ 时/ ,/ 预处理/ 结果/ 基本/ 令人满意/ ./ 图/ 2/ 给出/ 了/ 预处理/ 结果/ 的/ 示例/ ,/ 其中/ 图/ 2/ (/ a/ )/ 是/ 原图/ ,/ 图/ 2/ (/ b/ )/ 是/ 其/ 绿色/ 分量/ ,/ 可以/ 看出/ 中间/ 圆形/ 基底/ 区域/ 即/ 孔径/ 的/ 亮度/ 远大于/ 外部/ 区域/ ./ 图/ 2/ (/ c/ )/ 是/ 对/ 图/ 2/ (/ b/ )/ 进行/ 迭代/ 生长/ 的/ 结果/ ./ 对/ 视网膜/ 图像/ 的/ 绿色/ 分量/ 进行/ L/ 层/ NSCT/ 分解/ ,/ 每/ 一层/ 利用/ NSDFB/ 进一步/ 分解/ 为/ Dl/ 个/ 方向/ 子带/ ./ 设/ 图像/ 像素/ 为/ x/ (/ i/ ,/ j/ )/ ,/ 空间/ 上/ 相应/ 的/ NSCT/ 系数/ 为/ cl/ ,/ d/ (/ i/ ,/ j/ )/ ,/ l/ =/ 1/ ,/ 2/ ,/ …/ ,/ L/ ,/ d/ =/ 1/ ,/ 2/ ,/ …/ ,/ Dl/ ,/ 其中/ l/ 表示/ 尺度/ 参数/ ,/ 也/ 即/ 变换/ 层数/ ;/ d/ 表示/ 方向/ 子带/ 的/ 索/ Page4/ 引/ ./ 可见/ 分解/ 后/ 系数/ 子带/ 所处/ 的/ 尺度/ 和/ 方向/ 对应/ 于/ 血管/ 的/ 宽度/ 特征/ 和/ 方向/ 信息/ ./ 小波基/ 函数/ 是/ 用/ “/ 点/ ”/ 的/ 方式/ 来/ 实现/ 对/ 线状/ 奇异/ 性/ 的/ 描述/ ,/ 而/ NSCT/ 的/ 基/ 函数/ 为/ 线状/ ,/ 这/ 使得/ NSCT/ 可以/ 用/ 更/ 少/ 的/ 系数/ 来/ 完成/ 线状/ 奇异/ 性/ 的/ 标准/ ./ 根据/ NSCT/ 变换/ 的/ 性质/ 可知/ ,/ NSCT/ 基/ 函数/ 随/ 尺度/ l/ 的/ 增大/ 而/ 变宽/ ./ 考虑/ 给定/ 宽度/ 的/ 血管/ ,/ 在/ 不同/ 尺度/ NSCT/ 基/ 函数/ 的/ 情况/ 下/ ,/ 血管/ 的/ 响应/ 系数/ 可/ 归类/ 为/ 3/ 种/ 情况/ :/ (/ 1/ )/ 当/ 血管/ 宽度/ 大于/ 基/ 函数/ 宽度/ 时/ ,/ 此时/ 系数/ 在/ 血管/ 两侧/ 边界/ 均会/ 出现/ 局部/ 极值/ ;/ (/ 2/ )/ 当/ 血管/ 宽度/ 与/ 基/ 函数/ 宽度/ 相当/ 时/ ,/ NSCT/ 系数/ 可以/ 看作/ 是/ 匹配/ 响应/ ./ 此时/ 系数/ 最为/ 稀疏/ 且/ 仅/ 图/ 3/ 血管/ 的/ NSCT/ 响应/ 示意图/ 对于/ 实际/ 视网膜/ 图像/ 中/ ,/ 如何/ 设计/ 有效/ 的/ 特征提取/ 算法/ 是/ 下/ 一步/ 的/ 目标/ ./ 图/ 4/ 所示/ 为/ 一幅/ 视网膜/ 图像/ 在/ 不同/ 分解/ 尺度/ 同一/ 方向/ 上/ 的/ 局部/ 系数/ ,/ 其中/ 箭头/ 所指/ 是/ 血管/ 的/ 法向/ 方向/ ./ 可以/ 看出/ 血管/ 呈/ 黑色/ 线状/ ,/ 对应/ 局部/ 极小值/ ;/ 两侧/ 白色/ 线状/ 为/ 血管/ 与/ 背景图/ 4NSCT/ 变换/ 同一/ 方向不同/ 尺度/ 上/ 的/ 局部/ 系数/ 实际/ 视网膜/ 图像/ 中/ 背景/ 一般/ 为/ 灰色/ 区域/ ,/ 但是/ 由于/ 噪声/ 干扰/ 其系/ 数值/ 在/ 零点/ 附近/ 波动/ ,/ 呈现/ 黑白/ 交替/ 的/ 纹理/ ./ 这一/ 现象/ 在/ 高频/ 子带/ ,/ 例如/ l/ =/ 1/ 即图/ 4/ (/ f/ )/ 中/ 尤其/ 严重/ ./ 实验/ 表明/ 在/ 最小/ 尺度/ 时/ 很多/ 极细/ 血管/ 的/ 系数/ 响应/ 与/ 背景噪声/ 的/ 分布/ 混叠/ ,/ 极大/ 地/ 影响/ 了/ 较/ 粗/ 血管/ 的/ 分割/ ./ 综合/ 以上/ 分析/ ,/ 可以/ 从/ 像素/ 精度/ 设计/ 特征提取/ 方法/ ./ 为/ 避免/ 噪声/ 的/ 影响/ ,/ 这里/ 舍弃/ l/ =/ 1/ 时/ 的/ 特征/ ,/ 则/ 对应/ 于/ 像素/ x/ (/ i/ ,/ j/ )/ 的/ 系数/ 特征向量/ 可/ 表示/ 为/ 其中/ vl/ (/ i/ ,/ j/ )/ 表示/ 像素/ x/ (/ i/ ,/ j/ )/ 在/ 第/ l/ 层/ 的/ 特征/ 图/ 出现/ 一个/ 局部/ 极值/ ;/ (/ 3/ )/ 当/ 血管/ 宽度/ 小于/ 基/ 函数/ 宽度/ 时/ ,/ 血管/ 的/ 边缘/ 会/ 沿法/ 向/ 方向/ 拓宽/ ,/ 导致/ 虚警/ ./ 由于/ 血管/ 亮度/ 较/ 低/ ,/ 对应/ 的/ 系数/ 极值/ 为/ 波谷/ ./ 图/ 3/ (/ a/ )/ 和/ (/ b/ )/ 分别/ 给出/ 了/ 上述情况/ (/ 1/ )/ 和/ (/ 2/ )/ 时/ ,/ 沿/ 血管/ 法向/ 方向/ 的/ 理想/ 系数/ 波形/ ,/ 其中/ 过/ 零点/ 为/ 血管/ ./ 在/ 情况/ (/ 1/ )/ 时/ ,/ 随着/ 血管/ 宽度/ 的/ 不断/ 减小/ ,/ 两个/ 过/ 零点/ 会/ 不断/ 靠近/ ,/ 导致/ 由/ 情况/ (/ 1/ )/ 转化/ 为/ 情况/ (/ 2/ )/ ,/ 即/ 由/ 图/ 3/ (/ a/ )/ 演化/ 为/ 图/ 3/ (/ b/ )/ ./ 当/ 血管/ 宽度/ 继续/ 减小/ 时/ ,/ 情况/ (/ 3/ )/ 则/ 会/ 出现/ ,/ 但是/ 仍用/ 图/ 3/ (/ b/ )/ 来/ 表示/ ./ 对于/ 非/ 血管/ 部分/ ,/ 其/ 响应/ 系数/ 在/ 不同/ 尺度/ NSCT/ 基/ 函数/ 下/ 统计/ 均值/ 为/ 0/ ./ 由此/ 可以/ 导出/ 血管/ 分割/ 的/ 基本思路/ ./ 的/ 交界处/ ,/ 表现/ 为/ 极大值/ ./ 这/ 一点/ 符合/ 上述/ 分析/ ./ 对/ 各个/ 尺度/ 上/ 的/ 系数/ 进行/ 分析/ 可知/ ,/ 图/ 4/ (/ c/ )/ 表示/ 第/ 4/ 个/ 尺度/ 系数/ ,/ 出现/ 了/ 一定/ 的/ 虚警/ ,/ 对应/ 于/ 情况/ (/ 3/ )/ ;/ 随着/ 尺度/ 减小/ ,/ 虚警/ 现象/ 减弱/ ,/ 如图/ 4/ (/ d/ )/ 和/ (/ e/ )/ 所示/ ./ 由于/ 不同/ 方向/ 的/ 血管/ 对应/ NSCT/ 变换/ 的/ 系数/ 极值/ 会/ 出现/ 在/ 不同/ 方向/ 子带/ ,/ 式/ (/ 2/ )/ 可以/ 很/ 好/ 地/ 处理/ 这一/ 问题/ ./ 而/ 背景/ 处/ 系数/ 的/ 特征值/ 一般/ 较/ 小/ ./ 大量/ 实验/ 结果表明/ ,/ 取/ L/ =/ 4/ ,/ 方向/ 个数/ Dl/ =/ 8/ 时/ 可以/ 获得/ 较/ 好/ 的/ 结果/ ./ 在/ 特征向量/ 中/ 加入/ 绿色/ 分量/ 的/ 空域/ 灰度/ 值/ x/ (/ i/ ,/ j/ )/ ,/ 最终/ 得到/ 这里/ 省去/ 像素/ 坐标/ (/ i/ ,/ j/ )/ ./ 对图/ 2/ (/ b/ )/ 所示/ 灰度/ 图/ 进行/ 上述/ NSCT/ 变换/ 和/ 特征提取/ ,/ 得到/ 的/ 特征/ 图如图/ 5/ 所示/ ./ 通过/ 图/ 5/ (/ a/ )/ 、/ (/ b/ )/ 和/ (/ c/ )/ 可以/ 看出/ ,/ 不同/ 宽度/ 的/ 血管/ 极值/ 都/ 得到/ 了/ 体现/ ,/ 背景噪声/ 也/ 抑制/ 得/ 较/ 好/ ./ Page5/ 图/ 5/ 利用/ NSCT/ 得到/ 的/ 特征/ 图/ 由于/ 图像/ 的/ 亮度/ 存在/ 差异/ ,/ 需要/ 对/ 每/ 一幅/ 图像/ 的/ 特征向量/ 狏/ 单独/ 进行/ 归一化/ ./ 特征/ 的/ 归一化/ 如下/ 其中/ vt/ 表示/ 特征向量/ 狏/ 的/ 第/ t/ 维/ 特征/ ,/ μ/ t/ 和/ σ/ t/ 分别/ 是/ 第/ t/ 维/ 特征/ 的/ 均值/ 和/ 标准差/ ./ 最终/ 特征/ 服从/ 均值/ 为/ 0/ 、/ 标准差/ 为/ 1/ 的/ 分别/ ./ 3.3/ 监督/ 分类/ 视网膜/ 图像/ 中/ 的/ 血管/ 像素/ 记为/ C1/ ,/ 背景/ 像素/ 记做/ C2/ ,/ 利用/ 贝叶斯/ 规则/ 可/ 决策/ 如下/ [/ 15/ ]/ :/ x/ ∈/ C1/ ,/ 若/ p/ (/ 狏/ |/ C1/ )/ P/ (/ C1/ )/ >/ p/ (/ 狏/ |/ C2/ )/ P/ (/ C2/ )/ 烅/ 烄/ 烆/ 其中/ p/ (/ 狏/ |/ Ci/ )/ 表示/ 类/ 条件/ 概率/ ./ p/ (/ Ci/ )/ 表示/ 类别/ Ci/ 的/ 先验概率/ ,/ 可以/ 根据/ Ci/ 中/ 的/ 样本/ 比率/ 来/ 估计/ 其中/ Ni/ 表示/ 第/ i/ 类/ 样本/ 的/ 个数/ ,/ 满足/ N/ =/ N1/ +/ N2/ ./ 类/ 条件/ 概率密度/ p/ (/ 狏/ |/ Ci/ )/ 可/ 通过/ 高斯/ 混合/ 模型/ 来/ 表示/ 其中/ ki/ 表示/ 高斯/ 混合/ 模型/ p/ (/ 狏/ |/ Ci/ )/ 中/ 高斯/ 函数/ 的/ 个数/ ./ 根据/ 式/ (/ 3/ )/ ,/ p/ (/ 狏/ |/ j/ ,/ Ci/ )/ 表示/ 维数/ 为/ L/ 的/ 高维/ 高斯/ 函数/ ,/ 其/ 权重/ 为/ wij/ ./ 实验/ 中/ 使用/ 若干幅/ 人工/ 标记/ 的/ 视网膜/ 图像/ 建立/ 训练/ 数据/ 集/ ./ 对/ 第/ i/ 类/ Ci/ ,/ 给定/ ki/ 个/ 高斯分布/ ,/ 通过/ 期望/ 最大化/ (/ EM/ )/ 算法/ 来/ 估计/ 每个/ 高斯分布/ 的/ 参数/ 和/ 权重/ ,/ 从而/ 得到/ GMM/ 分类器/ ./ 4/ 实验/ 结果/ 及/ 分析/ 4.1/ 实验/ 数据/ 数据库/ DRIVE/ 和/ STARE/ ./ 实验/ 数据/ 来自/ 国际/ 公用/ 的/ 两个/ 彩色/ 视网膜/ 图像/ DRIVE/ 数据库/ 由/ 40/ 幅/ 彩色图像/ 及其/ 人工/ 分割/ 结果/ 组成/ [/ 10/ ]/ ./ 图像/ 大小/ 为/ 768/ ×/ 584/ ,/ 视场/ (/ FOV/ )/ 直径约/ 为/ 540/ 像素/ ./ 40/ 幅/ 图像/ 被/ 分为/ 训练/ 集/ 和/ 测试/ 集/ ,/ 各/ 包含/ 20/ 幅/ 图像/ ./ 人工/ 分割/ 结果/ 由/ 经过/ 专业训练/ 的/ 3/ 个人/ 人工/ 分割/ 得到/ ,/ 其中/ 训练/ 集/ 和/ 测试/ 集/ 图像/ 均/ 被/ 前/ 两个/ 观察者/ 人工/ 分割/ ,/ 结果/ 保存/ 在/ SetA/ ,/ 而/ 测试/ 集/ 还/ 被/ 第/ 3/ 个/ 观察者/ 进行/ 了/ 人工/ 分割/ ,/ 结果/ 保存/ 在/ SetB/ 中/ ./ SetA/ 和/ SetB/ 得到/ 的/ 分割/ 结果/ 相似/ ./ 在/ SetA/ 中/ 12.7/ %/ 的/ 像素/ 被/ 标记/ 为/ 血管/ ,/ 而/ 在/ SetB/ 中/ 12.3/ %/ 的/ 像素/ 被/ 标记/ 为/ 血管/ ./ STARE/ 数据库/ 由/ 20/ 幅/ 数字化/ 的/ 幻灯片/ 组成/ [/ 8/ ]/ ./ 这些/ 幻灯片/ 被/ 数字化/ 为/ 700/ ×/ 605/ 像素/ 的/ 图像/ ,/ 视场/ 约/ 为/ 650/ ×/ 550/ ./ 人工/ 分割/ 由/ 两个/ 观察者/ 完成/ ,/ 结果/ 分别/ 保存/ 在/ ahset/ (/ SetA/ )/ 和/ vkset/ (/ SetB/ )/ 中/ ./ SetA/ 中/ 结果/ 相对/ 保守/ ,/ 仅/ 10.4/ %/ 的/ 像素/ 被/ 标记/ 为/ 血管/ ;/ 而/ 在/ SetB/ 中/ 14.9/ %/ 的/ 像素/ 被/ 标记/ 为/ 血管/ ,/ 其中/ 包括/ 更/ 多/ 的/ 极细/ 血管/ ./ 由于/ 观察者/ 都/ 具有/ 一定/ 的/ 主观性/ 和/ 倾向性/ ,/ 这/ 导致/ 不同/ 观察者/ 的/ 分割/ 结果/ 之间/ 变化/ 较大/ ./ 因此/ 实验/ 中/ 分别/ 从/ 客观/ 评价/ 指标/ 即/ 分割/ 正确率/ ,/ 以及/ 主观/ 评价/ 即/ 血管/ 定位精度/ 两个/ 方面/ 对/ 本文/ 方法/ 进行/ 评估/ ./ 分割/ 正确率/ 是/ 指/ 正确/ 分类/ 的/ 像素/ 个数/ 所/ 占/ 比例/ ./ 血管/ 定位精度/ 定义/ 为/ 血管/ 的/ 检测/ 位置/ 与/ 实际/ 位置/ 的/ 重合/ 程度/ ./ 4.2/ 分割/ 正确率/ 对于/ DRIVE/ 数据库/ ,/ 分类器/ 由/ 训练/ 集/ 得到/ ,/ 再/ 对/ 测试/ 集/ 进行/ 分类/ ./ 对于/ STAR/ 数据库/ 则/ 采用/ 留一法/ 进行/ 训练/ 和/ 测试/ ./ 训练/ 用/ 的/ 分割/ 模板/ 均/ 采用/ SetA/ ,/ 但是/ 在/ 分析测试/ 结果/ 时/ 也/ 用/ SetB/ 作为/ 参考/ ./ 由于/ 训练样本/ 规模/ 相当/ 大/ ,/ 实验/ 随机/ 选取/ 训练/ 集合/ 中/ 100/ 万个/ 像素/ 样本/ 来/ 训练/ 分类器/ ./ GMM/ 分类器/ 中/ 血管/ 和/ 背景/ 两类/ 的/ 高斯/ 模型/ 个数/ 取为/ 相同/ 的/ 值/ k/ =/ k1/ =/ k2/ ./ Page6/ 由于/ 观察者/ 都/ 具有/ 一定/ 的/ 主观性/ 和/ 倾向性/ ,/ 这/ 导致/ 不同/ 观察者/ 的/ 分割/ 结果/ 之间/ 变化/ 较大/ ./ 因此/ 实验/ 中/ 分别/ 采取/ 客观/ 评价/ 指标/ 和/ 主观/ 评价/ 相结合/ 的/ 方法/ 对/ 本文/ 方法/ 进行/ 评估/ ,/ 并/ 与/ 视网膜/ 分割/ 中/ 的/ 一些/ 经典/ 方法/ 进行/ 比较/ ,/ 如表/ 1/ 所示/ ./ Soares/ 等/ 人/ [/ 15/ ]/ 本文/ 方法/ 从表/ 1/ 的/ 结果/ 可以/ 看出/ ,/ 本文/ 方法/ 对/ DRIVE/ 和/ STARE/ 两个/ 数据库/ 都/ 得到/ 了/ 很/ 好/ 的/ 效果/ ./ 对于/ DRIVE/ 数据库/ ,/ 本文/ 方法/ 和/ Soares/ 等/ 人均/ 优于/ Jiang/ 等/ 人/ 和/ Staal/ 等/ 人/ 的/ 方法/ ./ Lam/ 等/ 人/ 的/ 方法/ 属于/ 非/ 监督/ 方法/ ,/ 其多/ 触点/ 模型/ 表现/ 出/ 最优/ 的/ 性能/ ./ 本文/ 方法/ 属于/ 监督/ 类/ 方法/ ,/ 重点/ 在于/ 验证/ NSCT/ 变换/ 及/ 线状/ 特征提取/ 算法/ 的/ 有效性/ ./ 与/ 基于/ Gabor/ 特征/ 的/ Soares/ 等/ 人/ 的/ 方法/ 相比/ ,/ 本文/ 方法/ 在/ k/ =/ 10/ 时略/ 占优/ ,/ 当/ k/ =/ 15/ 和/ 20/ 时/ ,/ 本文/ 方法/ 仅/ 低/ 0.05/ ~/ 0.1/ 个/ 百分点/ ./ 对于/ STARE/ 数据库/ ,/ 本文/ 方法/ 和/ Staal/ 等/ 人/ 的/ 方法/ 表现/ 较/ 好/ ./ 而/ 当/ k/ =/ 20/ 时/ ,/ 本文/ 方法/ 比/ Staal/ 等/ 人/ 的/ 方法/ 高出/ 0.18/ 个/ 百分点/ ,/ 比图/ 6DRIVE/ 数据库/ 图像/ 分割/ 结果/ (/ k/ =/ 20/ )/ 图/ 7STARE/ 数据库/ 图像/ 分割/ 结果/ (/ k/ =/ 20/ )/ Soares/ 等/ 人/ 的/ 方法/ 高出/ 0.54/ 个/ 百分点/ ./ 这些/ 结果/ 说明/ 了/ 本文/ 基于/ NSCT/ 变换/ 的/ 特征提取/ 算法/ 的/ 有效性/ ./ 表/ 1/ 中/ 还/ 给出/ 了/ SetB/ 人工/ 分割/ 结果/ 的/ 分割/ 正确率/ ./ 由/ 数据/ 可以/ 看出/ ,/ 不论是/ DRIVE/ 数据库/ 还是/ STARE/ 数据库/ 上/ ,/ SetB/ 的/ 人工/ 分割/ 均/ 与/ SetA/ 的/ 人工/ 分割/ 有/ 一定/ 差别/ ./ 但是/ 总的来说/ ,/ 上述/ 的/ 各种/ 方法/ 与/ SetB/ 的/ 人工/ 分割/ 在/ 正确率/ 达到/ 了/ 相当/ 的/ 程度/ ./ 这/ 一方面/ 说明/ 建立/ 可靠/ 的/ 视网膜/ 人工/ 分割/ 图是/ 一个/ 难点/ ,/ 另一方面/ 则/ 说明/ 了/ 现有/ 方法/ 在/ 正确率/ 上/ 的/ 微弱/ 差别/ 实际意义/ 不/ 大/ ,/ 而/ 本文/ 方法/ 在/ 正确率/ 上/ 可以/ 取得/ 与/ 其它/ 方法/ 相当/ 的/ 结果/ ./ 4.3/ 血管/ 定位精度/ 为/ 方便/ 从/ 主观/ 上/ 加以/ 评估/ ./ 由于/ Soares/ 等/ 人/ 的/ 方法/ 所/ 使用/ 的/ Gabor/ 小波/ 特征/ 与/ NSCT/ 特征/ 在/ 多/ 分辨/ 和/ 多/ 方向性/ 上/ 具有/ 相似性/ ,/ 通过/ 对比/ 可以/ 说明/ NSCT/ 变换/ 的/ 优越性/ ./ 图/ 6/ 和/ 图/ 7/ 分别/ 给出/ DRIVE/ 数据库/ 和/ STARE/ 数据库/ 分割/ 结果/ 示例/ ./ 由于/ NSCT/ 在/ 多/ 方向/ 、/ 多/ 分辨/ 等/ 角度/ 对/ 图像/ 中/ 的/ 轮廓/ 和/ 纹理/ 等/ 方向/ 信息/ 具有/ 更/ 稀疏/ 的/ 表示/ ,/ 基于/ NSCT/ 的/ 血管/ 特征/ 对/ 图像/ 中/ 的/ 线状/ 奇异/ 性/ 具有/ 很强/ 的/ 表征/ 能力/ ./ 在/ 整体/ 效果/ 上/ 两种/ 方法/ 基本/ 相当/ ,/ 但是/ Soares/ 等/ 人/ 的/ 方法/ 容易/ 出现/ 血管/ 粘连/ 现象/ ,/ 如图/ 6/ (/ d/ )/ 和/ 图/ 7/ (/ d/ )/ 中/ 圆形/ 标记/ 区域/ 所示/ ./ 而/ 本文/ 方法/ 的/ 血管/ 分割/ 比较/ 清晰/ ,/ 这/ 从/ 一个/ 方面/ 说明/ 本文/ 方法/ 在/ 单个/ 血管/ 的/ 定位/ 上/ 更加/ 精确/ ./ 对于/ 图/ 8/ (/ a/ )/ 中/ 的/ 圆形/ 标记/ 区域/ ,/ Soares/ 等/ 人/ 的/ 方法/ 和/ 本文/ 方法/ 的/ 分割/ 结果/ 可以/ 得到/ 相同/ 的/ 结论/ ,/ 分别/ 如图/ 8/ (/ b/ )/ 和/ (/ c/ )/ 所示/ ./ Page7/ 图/ 8/ 本文/ 方法/ 与/ Soares/ 等/ 人/ 的/ 方法/ 结果/ 对比/ 示意图/ 为/ 进一步/ 说明/ 本文/ 方法/ 的/ 优势/ ,/ 图/ 8/ (/ d/ )/ 给出/ 了/ Soares/ 等/ 人/ 的/ 方法/ 与/ 模板/ 结果/ 的/ 差别/ 图像/ ,/ 其中/ 灰色/ 区域/ 表示/ Soares/ 等/ 人/ 的/ 方法/ 和/ 模板/ 在/ 分割/ 结果/ 上/ 的/ 相同/ 部分/ ,/ 白色/ 区域/ 表示/ Soares/ 等/ 人/ 的/ 方法/ 对/ 血管/ 的/ 虚警/ 区域/ ,/ 即/ 模板/ 中为/ 标记/ 出来/ 的/ 区域/ ,/ 黑色/ 区域/ 表示/ Soares/ 等/ 人/ 的/ 方法/ 的/ 漏检/ 区域/ ./ 可以/ 看出/ :/ (/ 1/ )/ 灰色/ 区域/ 面积/ 占/ 绝大部分/ ,/ 说明/ Soares/ 等/ 人/ 的/ 方法/ 有/ 较/ 好/ 的/ 分割/ 正确率/ ;/ (/ 2/ )/ 白色/ 区域/ 主要/ 集中/ 在/ 血管/ 的/ 两侧/ ,/ 即/ 分割/ 得到/ 的/ 血管/ 宽度/ 大于/ 实际/ 宽度/ ./ 这/ 说明/ 虚警/ 较大/ ,/ 也/ 正好/ 给出/ 了/ 其/ 粘连/ 现象/ 产生/ 的/ 原因/ ;/ (/ 3/ )/ 黑色/ 区域/ 主要/ 是/ 极细/ 血管/ 处/ ./ 本文/ 方法/ 与/ 模板/ 结果/ 的/ 差别/ 图像/ 如图/ 8/ (/ e/ )/ 所示/ ./ 与/ Soares/ 等/ 人/ 的/ 方法/ 相比/ ,/ 可以/ 看出/ :/ (/ 1/ )/ 本文/ 方法/ 的/ 白色/ 区域/ 较/ 少/ ,/ 说明/ 分割/ 得到/ 的/ 血管/ 宽度/ 小于/ 实际/ 宽度/ ,/ 虚警/ 现象/ 低于/ Soares/ 等/ 人/ 的/ 方法/ ,/ 因此/ 不/ 容易/ 产生/ 粘连/ 现象/ ;/ (/ 2/ )/ 黑色/ 区域/ 较/ 多/ ,/ 一部分/ 集中/ 在/ 极细/ 血管/ 处/ ,/ 另/ 一部分/ 则/ 集中/ 在/ 血管/ 两侧/ ,/ 说明/ 漏警/ 较大/ ./ 图/ 8/ (/ f/ )/ 给出/ 了/ Soares/ 等/ 人/ 的/ 方法/ 与/ 本文/ 方法/ 的/ 差值/ 图像/ ,/ 其/ 结果/ 可以/ 进一步/ 证实/ 以上/ 结论/ ./ 需要/ 说明/ 的/ 是/ ,/ 黑色/ 区域/ 中/ 对/ 极细/ 血管/ 处/ 的/ 漏检/ 普遍存在/ 于/ 目前/ 的/ 方法/ 中/ ,/ 可以/ 作为/ 进一步/ 研究/ 的/ 方向/ ;/ 而/ 本文/ 方法/ 对/ 血管/ 两侧/ 的/ 漏检/ 仅/ 导致/ 血管/ 宽度/ 变小/ ,/ 这/ 一点/ 对/ 血管/ 的/ 细化/ 、/ 矢量化/ 等/ 后续/ 操作/ 是/ 有利/ 的/ ,/ 因此/ 也/ 有利于/ 视网膜/ 图像/ 的/ 自动/ 分析/ 和/ 诊断/ ./ 血管/ 两侧/ 的/ 虚/ 检则/ 极容易/ 导致/ 误诊/ 为/ 病变/ 区域/ ./ 综上/ 结果/ 可以/ 说明/ ,/ 本文/ 方法/ 对/ 血管/ 区域/ 的/ 分割/ 较为/ 保守/ ./ 在/ 此/ 前提/ 下/ 本文/ 方法/ 一方面/ 可以/ 获得/ 与/ Soares/ 等/ 人/ 的/ 方法/ 相当/ 或/ 更好/ 的/ 分割/ 正确率/ ;/ 另一方面/ ,/ 从/ 视网膜/ 图像/ 的/ 自动/ 分析/ 和/ 诊断/ 的/ 角度/ 来/ 考虑/ ,/ 本文/ 方法/ 的/ 血管/ 定位精度/ 更高/ ,/ 可以/ 有效/ 地/ 避免/ 血管/ 粘连/ 现象/ ./ 5/ 结束语/ 本文/ 提出/ 基于/ NSCT/ 变换/ 的/ 血管/ 特征提取/ 方法/ 并/ 用于/ 视网膜/ 图像/ 分割/ ./ 利用/ NSCT/ 在/ 多/ 方向/ 、/ 多/ 分辨/ 、/ 稀疏/ 表示/ 等/ 方面/ 的/ 优点/ ,/ 本文/ 详细分析/ 了/ 视网膜/ 图像/ 的/ NSCT/ 变换/ 响应/ 并/ 给出/ 了/ 对/ 血管/ 的/ 线状/ 特征提取/ 算法/ ./ 该/ 方法/ 具有/ 参数设置/ 少/ ,/ 虚警率/ 低/ 、/ 粘连/ 现象/ 少/ 等/ 特点/ ./ 在/ 对/ 血管/ 保守/ 分割/ 的/ 前提/ 下/ ,/ 本文/ 方法/ 在/ 正确/ 分割/ 率/ 和/ 血管/ 定位精度/ 上/ 都/ 具有/ 较/ 好/ 的/ 效果/ ./ 实验/ 结果/ 证明/ 了/ 其/ 有效性/ ./ 由于/ 人工/ 分割/ 模板/ 以及/ 视网膜/ 图像/ 的/ 基底/ 噪声/ 和/ 极细/ 血管/ 的/ Page8/ 影响/ ,/ 视网膜/ 分割/ 方法/ 仍然/ 存在/ 一些/ 尚待/ 解决/ 的/ 问题/ ./ 视网膜/ 极细/ 血管/ 的/ 检测/ 以及/ 病变/ 检测/ 等/ 可以/ 作为/ 今后/ 的/ 研究/ 方向/ ./ 

