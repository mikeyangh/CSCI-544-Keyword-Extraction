Page1/ 列/ 存储/ 数据/ 区级/ 压缩/ 模式/ 与/ 压缩/ 策略/ 选择/ 方法/ 王振玺/ 1/ )/ 乐嘉锦/ 1/ )/ 王梅/ 1/ )/ 刘/ 国华/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 东华大学/ 计算机科学/ 与/ 技术/ 学院/ 上海/ 201620/ )/ 2/ )/ (/ 南京大学/ 计算机软件/ 新/ 技术/ 国家/ 重点/ 实验室/ 南京/ 210093/ )/ 摘要/ 压缩/ 技术/ 是/ 列/ 存储/ 数据管理/ 的/ 重要/ 研究/ 内容/ 之一/ ./ 目前/ 多数/ 方法/ 对/ 同一/ 列/ 数据/ 使用/ 单一/ 压缩/ 方法/ 进行/ 压缩/ ,/ 忽略/ 了/ 数据/ 的/ 局部/ 分布/ 特性/ ,/ 极大/ 地/ 影响/ 了/ 压缩/ 性能/ ./ 该文/ 提出/ 一种/ 区级/ 压缩/ 模式/ ,/ 并/ 在/ 此/ 模式/ 下/ 提出/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ ./ 首先/ 该文/ 将/ 数据/ 列/ 进一步/ 划分/ 为区/ ,/ 并/ 分别/ 定义/ 相邻/ 区/ 信息/ 与/ 区/ 所在/ 列/ 的/ 统计/ 信息/ 为/ 参照/ 信息/ ,/ 进而/ 通过/ 学习/ 参照/ 信息/ 与/ 当前/ 区/ 之间/ 的/ 相似性/ 和/ 差异性/ 进行/ 策略/ 推荐/ ./ 最后/ 该文/ 对区/ 进行/ 局部/ 学习/ 从而/ 对/ 推荐/ 压缩/ 策略/ 进行/ 修正/ ,/ 保证/ 压缩/ 策略/ 的/ 有效性/ ./ 在/ 数据仓库/ 基准/ 数据/ 集/ SSB/ 上/ 的/ 实验/ 结果/ 验证/ 了/ 该文/ 方法/ 的/ 有效性/ ./ 关键词/ 列/ 存储/ ;/ 数据压缩/ ;/ 区级/ 压缩/ 模式/ ;/ 压缩/ 策略/ 选择/ 1/ 引言/ 随着/ 数据仓库/ 技术/ 的/ 不断/ 发展/ ,/ 数据仓库/ 中包/ Page2/ 进行/ 存储/ ,/ 数据表/ 记录/ 中/ 的/ 同一/ 属性/ 值/ 被/ 存储/ 在/ 一起/ ./ 在/ 进行/ 查询/ 的/ 时候/ ,/ 列/ 存储/ 数据仓库/ 系统/ 只/ 需要/ 将/ 需要/ 的/ 列/ 读入/ 内存/ ,/ 一定/ 程度/ 上/ 减少/ 了/ 读入/ 的/ 数据量/ ,/ 使得/ 系统/ 的/ 查询/ 效率/ 得到/ 提高/ [/ 1/ ]/ ./ 然而/ ,/ 数据仓库/ 需要/ 处理/ 的/ 数据量/ 是/ 非常/ 庞大/ 的/ ,/ 这/ 造成/ 查询/ 时/ 大量/ 的/ I/ // O/ ./ 由于/ CPU/ 处理/ 与/ 磁盘/ 访问/ 发展/ 的/ 不/ 平衡/ ,/ 造成/ 了/ I/ // O/ 成为/ 了/ 查询/ 的/ 瓶颈/ ./ 因此/ ,/ 减少/ I/ // O/ 的/ 次数/ 能/ 显著/ 提高/ 查询/ 的/ 效率/ ./ 而/ 数据压缩/ 则/ 能/ 在/ 一定/ 程度/ 上/ 减少/ I/ // O/ 的/ 次数/ ,/ 因此/ ,/ 数据压缩/ 成为/ 了/ 一个/ 研究/ 的/ 热点/ ./ 对于/ 列/ 存储/ 来说/ ,/ 数据/ 具有/ 相同/ 的/ 数据类型/ ,/ 增加/ 了/ 相邻/ 数据/ 之间/ 的/ 相似性/ ,/ 使得/ 列/ 存储系统/ 和/ 传统/ 的/ 行/ 存储系统/ 相比/ 具有/ 更好/ 的/ 压缩/ 效率/ ./ 数据压缩/ 一直/ 以来/ 是/ 数据管理/ 领域/ 长期/ 关注/ 的/ 研究/ 问题/ ,/ 目前/ 存在/ 众多/ 的/ 压缩/ 方法/ ,/ 如/ Huffman/ 编码/ [/ 2/ ]/ 、/ 算术/ 编码/ [/ 3/ ]/ 、/ 字典/ 编码/ (/ Dictionary/ -/ basedcompression/ )/ 、/ 空值/ 抑制/ (/ NullSuppression/ )/ [/ 4/ ]/ 、/ 游程/ 编码/ (/ Run/ -/ LengthEncoding/ )/ [/ 5/ ]/ 、/ LZ/ 系列/ 编码/ 等/ [/ 6/ ]/ ./ Oracle/ ,/ DB2/ ,/ SQLSever2008/ 等/ 基于/ 行/ 存储/ 的/ 数据库/ 管理系统/ 主要/ 采用/ 字典/ 编码/ 、/ 空值/ 编码/ 等/ 压缩/ 方法/ 来/ 实现/ 压缩/ ./ C/ -/ Store/ [/ 7/ -/ 8/ ]/ 等列/ 存储系统/ 则/ 主要/ 采用/ 游程/ 编码/ 、/ 字典/ 编码/ 、/ 空值/ 编码/ 等/ 压缩/ 方法/ ./ 研究/ 表明/ :/ 不同/ 压缩/ 方法/ 对/ 同种/ 数据类型/ 的/ 压缩/ 效果/ 是/ 不同/ 的/ ,/ 同样/ 相同/ 压缩/ 方法/ 对/ 不同/ 类型/ 数据/ 的/ 压缩/ 效果/ 也/ 是/ 不同/ 的/ ./ 因此/ ,/ 对/ 不同/ 的/ 数据类型/ 采用/ 不同/ 的/ 压缩/ 方法/ 十分必要/ ./ 然而/ 目前/ 在/ 压缩/ 策略/ 选择/ 方面/ 的/ 研究/ 非常少/ ./ Abadi/ 等/ 人/ [/ 7/ -/ 8/ ]/ 通过/ 实验/ 提出/ 了/ 一个/ 决策树/ ,/ 通过/ 该/ 决策树/ 进行/ 压缩/ 策略/ 选择/ ,/ 然而/ 这种/ 压缩/ 是/ 建立/ 在/ 整个/ 列/ 上面/ 的/ ,/ 即该/ 方法/ 将/ 一个/ 列/ 的/ 数据/ 采用/ 同/ 一种/ 压缩/ 方式/ 进行/ 压缩/ ./ 但是/ 该/ 方法/ 忽略/ 了/ 局部/ 数据/ 在/ 分布/ 上/ 存在/ 着/ 差异性/ ./ 如图/ 1/ 所示/ ,/ 一个/ 列中/ 第/ 101/ 个/ 和/ 第/ 102/ 个区/ 的/ 数据/ 的/ 特点/ 相似/ ,/ 可以/ 采用/ 游程/ 编码/ ,/ 但是/ 第/ 301/ 个区/ 中/ 的/ 数据/ 与/ 上面/ 两个/ 区/ 的/ 差异/ 就/ 比较/ 大/ ,/ 如果/ 采用/ 游程/ 编码/ ,/ 压缩/ 效率/ 就/ 非常低/ ./ 对/ 该区/ 采用/ 字典/ 编码/ 则/ 可以/ 很/ 好地解决/ 这个/ 问题/ ./ 由此看来/ 在/ 较/ 小/ 的/ 粒度/ 上面/ 进行/ 压缩/ 可以/ 提高/ 压缩率/ ./ 然而/ ,/ 为/ 每个/ 区/ 进行/ 学习/ 时间/ 复杂度/ 高/ ,/ 并/ 不/ 可行/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 提出/ 一种/ 区级/ 压缩/ 模式/ 下/ 的/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ ./ 首先/ 本文/ 将/ 数据/ 列/ 进一步/ 划分/ 为区/ ,/ 并/ 分别/ 定义/ 相邻/ 区/ 信息/ 与/ 区/ 所在/ 列/ 的/ 统计/ 信息/ 为/ 参照/ 信息/ ,/ 在/ 此基础/ 上/ 提出/ 两种/ 不同/ 的/ 压缩/ 策略/ 选择/ 方法/ :/ 基于/ 相邻/ 区/ 的/ 参照/ 学习/ 方法/ 通过/ 定义/ 连续区/ 之间/ 的/ 相似/ 因子/ 来/ 判定/ 连续/ 两个/ 区中/ 数据分布/ 的/ 相关性/ 和/ 差异性/ ,/ 从而/ 预测/ 当前/ 区中/ 数据/ 的/ 分布/ 特点/ ,/ 得到/ 推荐/ 的/ 压缩/ 策略/ ;/ 基于/ 统计/ 参照/ 区/ 学习/ 方法/ 通过/ 估计/ 当前/ 区和区/ 所在/ 列/ 的/ 整体/ 分布/ 相似性/ 进行/ 策略/ 推荐/ ./ 在/ 此基础/ 上/ ,/ 本文/ 对区/ 进行/ 局部/ 学习/ 从而/ 对/ 推荐/ 压缩/ 策略/ 进行/ 修正/ ,/ 保证/ 压缩/ 策略/ 的/ 有效性/ ./ 上述/ 两种/ 方法/ 都/ 有效/ 地/ 利用/ 数据/ 的/ 局部/ 分布/ 特点/ 进行/ 压缩/ ,/ 并/ 降低/ 了/ 单独/ 为/ 每个/ 区/ 进行/ 学习/ 的/ 额外/ 开销/ ./ 在/ 数据仓库/ 基准/ 数据/ 集/ SSB/ 上/ 与/ C/ -/ Store/ 的/ 方法/ 进行/ 比较/ ,/ 经过/ 实验/ 验证/ 本文/ 的/ 方法/ 较/ C/ -/ Store/ 决策树/ 的/ 压缩率/ 有/ 较大/ 的/ 提高/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 介绍/ 本文/ 定义/ 的/ 一些/ 变量/ 和/ 概念/ ;/ 第/ 4/ 节/ 介绍/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 的/ 详细/ 内容/ ;/ 第/ 5/ 节/ 描述/ 本文/ 提出/ 的/ 两种/ 方法/ 在/ 数据仓库/ 基准/ 数据/ 集/ SSB/ 上/ 进行/ 的/ 实验/ ,/ 并/ 对/ 实验/ 结果/ 进行/ 详尽/ 的/ 分析/ 和/ 说明/ ;/ 最后/ 一部分/ 是/ 总结/ 和/ 展望/ ./ 2/ 相关/ 工作/ 列/ 存储/ 思想/ 的/ 出现/ 可以/ 追溯到/ 1975/ 年/ [/ 9/ ]/ ./ 后来/ ,/ Wong/ 等/ 人/ 提出/ 了/ 移项/ 文件/ [/ 10/ ]/ 的/ 技术/ 用于/ 解决/ 对/ 大型/ 科学/ 数据库/ 的/ 检索/ 速度/ 问题/ ./ 他/ 提出/ 将/ 一个/ 关系/ 的/ 不同/ 列/ 的/ 值/ 存放/ 在/ 不同/ 的/ 文件/ 中/ ,/ 并且/ 对/ 这些/ 列值/ 进行/ 了/ 压缩/ 以/ 节省/ 空间/ ./ 这/ 是/ 列/ 存储/ 的/ 雏形/ ./ Copeland/ 等/ 人/ 提出/ 了/ DSM/ (/ DecompositionStorageModel/ )/ [/ 11/ ]/ 存储/ 模型/ 的/ 概念/ ./ Ailamaki/ 在/ DSM/ 存储/ 模型/ 的/ 基础/ 上/ 提出/ 了/ PAX/ (/ PartitionAttributesAcross/ )/ [/ 12/ ]/ 技术/ ,/ 这种/ 技术/ 通过/ 将/ 数据/ 块/ 分割/ 为/ 小/ 的/ 数据/ 区/ ,/ 在/ 每个/ 数据/ 区中/ 存储/ 一个/ 属性/ 的/ 值/ ,/ 提高/ 了/ 数据/ 的/ 查询/ 性能/ ./ Ramamurthy/ 等/ 人/ 提出/ 了/ 碎片/ 镜像/ (/ FracturedMirrors/ )/ 技术/ [/ 13/ ]/ ,/ 这种/ 方法/ 实质/ 上/ 是/ 一种/ 行/ 存储/ 和/ 列/ 存储/ 的/ 折中/ ,/ 通过/ 在/ 一个/ 系统/ 中/ Page3/ 保存/ 两种/ 版本/ (/ NSM/ 存储/ 模型/ 和/ DSM/ 存储/ 模型/ )/ 的/ 数据/ 副/ 本来/ 提高/ 查询/ 性能/ ./ 后来/ ,/ Abadi/ 等/ 人/ 提出/ 了/ C/ -/ Store/ [/ 7/ -/ 8/ ]/ 存储/ 架构/ 并且/ 实现/ 了/ 一个/ 实验/ 性质/ 的/ 系统/ C/ -/ Store/ ,/ 这个/ 系统/ 的/ 特点/ 是/ 上层/ 查询/ 执行/ 仍然/ 采用/ 行/ 存储/ 即/ 元组/ 的/ 方式/ 执行/ 而/ 在/ 磁盘/ 上/ 采用/ 列/ 存储/ 的/ 方式/ 存储/ 数据/ ,/ 在/ 上层/ 和/ 底层/ 之间/ 有/ 一个/ 称为/ TupleMover/ 的/ 组件/ 用于/ 上层/ 和/ 下层/ 数据/ 之间/ 的/ 迁移/ ./ 由于/ 列/ 存储/ 数据/ 是/ 以/ 属性/ 或/ 列为/ 单位/ 进行/ 存储/ 的/ ,/ 数据/ 具有/ 相同/ 的/ 数据类型/ ,/ 使得/ 列/ 存储系统/ 和/ 传统/ 的/ 行/ 存储系统/ 相比/ 具有/ 更好/ 的/ 压缩/ 效率/ ./ 压缩/ 技术/ 成为/ 列/ 存储/ 数据管理/ 的/ 重要/ 研究/ 内容/ 之一/ ./ 适用/ 于/ 数据库/ 上面/ 的/ 压缩/ 方法/ 有/ 很多/ ,/ 主要/ 有/ 空值/ 悬挂/ [/ 4/ ]/ 、/ 游程/ 编码/ [/ 5/ ]/ 、/ 位/ 图/ 编码/ 、/ 字典/ 编码/ [/ 4/ ]/ 以及/ LZ/ 系列/ 的/ 字典/ 编码/ [/ 6/ ]/ 等/ ,/ 如表/ 1/ 所示/ ./ 从/ 压缩/ 粒度/ 的/ 角度/ 来说/ ,/ 目前/ 压缩/ 主要/ 在/ 以下/ 5/ 种/ 不同/ 的/ 粒度/ 中/ 进行/ :/ 表级/ 、/ 块级/ 、/ 元组/ 级/ 、/ 属性/ 级/ 以及/ 比/ 特级/ 压缩/ [/ 1/ ]/ ./ 表级/ 粒度/ 下/ 的/ 压缩/ 方案/ ,/ 具有/ 代表性/ 的/ 是/ IBM/ 公司/ 的/ DB29/ (/ 又名/ DB2Viper/ )/ ,/ DB29/ 中/ 采用/ 全表级/ 数据库/ 压缩/ 方案/ ,/ 但是/ 全表级/ 压缩/ 方案/ 使得/ 在/ 解压/ 记录/ 时/ 需要/ 大量/ 的/ I/ // O/ ./ 其中/ 元组/ 级/ 的/ 压缩/ 方案/ 很少/ 见/ ./ 块级/ 粒度/ 下/ 的/ 压缩/ 方案/ 就/ 比较/ 多/ 了/ ./ Eggers/ ,/ Shoshani/ 提出/ 了/ 一种/ 对/ 多维/ 稀疏/ 数组/ 进行/ 数据/ 页级/ 压缩/ 的/ 方法/ ,/ 其/ 具有/ forwardmapping/ 和/ backwardmapping/ 这种/ mappingcomplete/ 性质/ ;/ Goldstein/ 等/ 人/ 给出/ 了/ 基于/ frameofreference/ 的/ 数据/ 页级/ 压缩算法/ ,/ 该/ 算法/ 找出/ 每/ 一页/ 中/ 元组/ 之间/ 的/ 共同/ 信息/ ,/ 称之为/ frameofreference/ ,/ 其它/ 数据/ 参照/ 此/ 进行/ 压缩/ ,/ 将/ 多个/ 压缩/ 数据/ 页/ 结合/ 起来/ 就/ 形成/ 了/ 文件/ 级/ 的/ 压缩/ ;/ Oracle/ 的/ 压缩算法/ 采用/ 了/ 基于/ 字典/ 的/ 压缩/ 方法/ [/ 14/ ]/ ,/ 其/ 将/ 字典/ 和/ 数据/ 放在/ 同/ 一页/ 中/ ,/ 但是/ 这种/ 方法/ 的/ 压缩/ 效率/ 相对/ 全表级/ 压缩/ 来说/ ,/ 压缩率/ 较/ 低/ ./ 比/ 特级/ 粒度/ 下/ 的/ 压缩/ 方案/ 也/ 有/ 很多/ ,/ 但是/ 应用/ 的/ 领域/ 有/ 限制/ ./ Wong/ 等/ 人/ 给出/ 了/ 基于/ Bit/ 级/ 压缩/ 的/ BitTranspositionFile/ (/ BTF/ )/ 系统/ [/ 15/ ]/ ,/ 该/ 系统/ 针对/ 科学/ 统计/ 数据库/ 中/ 属性/ 的/ 候选/ 集/ 有限/ 的/ 特点/ ,/ 将/ 属于/ 相同/ 列/ 的/ Bit/ 存放/ 在/ 同一/ 数据/ 块/ 中/ 实现/ 压缩/ ;/ 而/ 对于/ 那些/ 不能/ 压缩/ 的/ 属性/ ,/ BTF/ 仍然/ 按照/ Bit/ 列/ 存储/ ./ BTF/ 只/ 考虑/ 了/ 单表/ 的/ 查询/ 操作/ ,/ 没有/ 给出/ 连接/ 操作/ ./ 除了/ 在/ 行/ 存储/ 上面/ 取得/ 了/ 很多/ 的/ 研究成果/ 之外/ ,/ 列/ 存储/ 上面/ 的/ 数据压缩/ 研究/ 也/ 取得/ 了/ 一定/ 的/ 成果/ [/ 7/ -/ 8/ ,/ 16/ -/ 17/ ]/ ./ Abadi/ 等/ 人/ 提出/ 一种/ 按/ 属性/ 列/ 存储/ 、/ 读/ 优化/ 的/ 、/ 压缩/ 的/ 数据库/ 管理系统/ C/ -/ Store/ [/ 7/ -/ 8/ ]/ ,/ 主要/ 采用/ 游程/ 编码/ 、/ 字典/ 编码/ 、/ 位/ 图/ 编码/ 、/ LZ/ 系列/ 编码/ 等/ 压缩/ 方法/ ./ 以/ 哈尔滨工业大学/ 的/ 李建中/ 教授/ 为首/ 的/ 研究/ 小组/ 针对/ 科学/ 与/ 统计/ 数据库/ 的/ 特点/ 提出/ 了/ 一个/ 比/ 特级/ 压缩/ 方案/ [/ 17/ ]/ ./ 该/ 方案/ 对于/ 值域/ 有限/ 的/ 属性/ ,/ 采用/ K/ -/ of/ -/ N/ +/ Unary/ 进行/ 压缩/ 编码/ ,/ 并/ 将/ 编码/ 结果/ 按照/ Bit/ 列/ 存储/ ,/ 实现/ 压缩/ ;/ 对于/ 主键/ 属性/ 采用/ Double/ -/ Key/ -/ Btree/ 按/ 属性/ 列/ 存储/ ;/ 对于/ 其它/ 属性/ 则/ 按照/ Tu/ -/ pleID/ -/ Btree/ 按/ 属性/ 列/ 存储/ ./ 但是/ 该/ 压缩/ 方案/ 将/ 一个/ 数据库/ 表拆/ 分为/ 两个/ 数据库/ 表/ 的/ 方式/ 使得/ 插入/ 、/ 删除/ 和/ 更新/ 操作/ 的/ 执行/ 变得/ 十分复杂/ ,/ 使得/ 该/ 拆分/ 压缩/ 方案/ 的/ 使用/ 范围/ 过于/ 狭窄/ ./ 在/ 压缩/ 技术/ 不断/ 发展/ 的/ 同时/ ,/ 对/ 压缩/ 策略/ 选择/ 的/ 研究/ 也/ 在/ 不断/ 的/ 发展/ ./ Abadi/ 等/ 人/ 提出/ 了/ 的/ 数据库/ 管理系统/ C/ -/ Store/ [/ 7/ -/ 8/ ]/ ./ 它/ 通过/ 建立/ 一个/ 决策树/ 来/ 判定/ 一个/ 列/ 采用/ 何种/ 压缩算法/ ./ 但是/ 这种/ 方法/ 忽视/ 了/ 数据/ 在/ 局部/ 上/ 的/ 特殊性/ ,/ 过于/ 粗糙/ ,/ 造成/ 压缩率/ 相对/ 比较/ 低/ ./ 序号/ 压缩算法/ 1/ 字典/ 编码/ 2/ 游程/ 编码/ 字符/ (/ 串/ )/ ,/ 数值/ ,/ 日期/ ,/ 布尔/ 3/ 位图/ 编码/ 字符/ (/ 串/ )/ ,/ 数值/ ,/ 日期/ ,/ 布尔/ 4/ 空值/ 编码/ 字符/ (/ 串/ )/ ,/ 数值/ ,/ 日期/ ,/ 数值/ ,/ 文本/ 5/ 整数/ 编码/ 6LZ/ 编码/ 3/ 定义/ 和/ 符号/ 给定/ 关系/ 模式/ R/ =/ {/ A1/ ,/ A2/ ,/ …/ ,/ An/ }/ ,/ 其中/ n/ 表示/ 关系/ 的/ 目的/ 度/ ,/ Ai/ 表示/ 第/ i/ 个/ 属性/ 列/ ./ 在/ 列/ 存储/ 中/ ,/ 任意/ 一个/ 列/ Ai/ 中/ 的/ 数据/ 在/ 逻辑/ 上/ 对应/ 一个/ 数据/ 段/ Si/ ∈/ S/ ./ 本文/ 中将/ 段/ 分为/ 若干个/ 区/ ,/ 区/ 是/ 一系列/ 连续/ 块/ 的/ 集合/ ./ 第/ i/ 个/ 属性/ 列/ 对应/ 的/ 段/ 记为/ Si/ =/ {/ ei1/ ,/ ei2/ ,/ …/ ,/ ein/ }/ ,/ 其中/ ej/ -/ 1/ 和/ ej/ 是/ 两个/ 连续/ 的/ 区/ ./ 区/ 由/ 16/ 个/ 连续/ 的/ 数据库/ 块/ 构成/ ./ 区中/ 的/ 第一块/ 是/ 区/ 的/ 控制/ 块/ ,/ 保存/ 区中/ 所有/ 块/ 的/ 控制/ 信息/ ./ 区/ 的/ 结构/ 如图/ 2/ 所示/ ./ 区中/ 存放/ 着/ 连续/ 的/ 列值/ ,/ 每/ 一个/ 列值/ 称为/ 一个/ 项/ (/ item/ )/ ./ 本文/ 为/ 每/ 一个/ 区/ 定义/ 一组/ 统计/ 信息/ ,/ 记/ 为/ 集合/ T/ =/ {/ r/ ,/ s/ ,/ a/ ,/ d/ ,/ n/ ,/ c/ ,/ l/ }/ ,/ 其中/ r/ 表示/ 第/ i/ 个区/ 中/ item/ 的/ 数目/ ,/ s/ 表示/ 区中/ 相同/ 值/ 的/ 数目/ ,/ a/ 表示/ 区中/ 相同/ 值/ 的/ 总/ 的/ item/ 条数/ ,/ d/ 表示/ 区中/ 不同/ 值/ 的/ 数/ Page4/ 目/ ,/ n/ 表示/ 区中/ 空值/ 的/ 数目/ ,/ c/ 表示/ 区中/ 相同/ 值/ 连续/ 的/ 平均/ 数目/ ,/ l/ 表示/ 区中/ item/ 的/ 平均/ 长度/ ./ 基于/ 上述/ 统计/ 信息/ ,/ 本文/ 为/ 每/ 一个/ 区/ 定义/ 了/ 一组/ 统计/ 量/ qi/ =/ {/ q1i/ ,/ q2i/ ,/ q3i/ ,/ q4i/ ,/ q5i/ }/ ,/ qi/ 描述/ 了/ 第/ i/ 个区/ 的/ 数据分布/ 的/ 一些/ 特点/ ,/ 详细/ 如下/ :/ 定义/ 统计/ 量/ 1/ :/ q1i/ 表示/ 区中/ 相同/ 值/ 所/ 占/ 的/ 百分比/ ,/ q1i/ =/ a/ ×/ 100/ // r/ ./ 定义/ 统计/ 量/ 2/ :/ q2i/ 表示/ 区中/ 空值/ 记录/ 所/ 占/ 的/ 百分比/ ,/ q2i/ =/ n/ ×/ 100/ // r/ ./ 定义/ 统计/ 量/ 3/ :/ q3i/ 表示/ 区中/ 相同/ 值/ 连续/ 的/ 平均/ 数目/ ,/ 也/ 就是/ q3i/ =/ c/ ./ 定义/ 统计/ 量/ 4/ :/ q4i/ 表示/ 区中/ 不同/ 值/ 的/ 数目/ ,/ 也/ 就是/ q4i/ =/ d/ ./ 定义/ 统计/ 量/ 5/ :/ q5i/ 表示/ 区中/ item/ 的/ 平均/ 长度/ ,/ 也/ 就是/ q5i/ =/ l/ ./ 例如/ ,/ 一个/ 区/ 中共/ 有/ r/ =/ 1000/ 条/ 的/ 记录/ ,/ 其中/ 相同/ 值/ 的/ 数目/ s/ =/ 20/ ,/ 相同/ 值/ 的/ 总/ 记录/ 条数/ 为/ a/ =/ 960/ ,/ 区中/ 不同/ 值/ 的/ 数目/ d/ =/ 30/ ,/ 区中/ 空值/ 的/ 数目/ n/ =/ 10/ ,/ 区中/ 相同/ 值/ 连续/ 的/ 平均/ 数目/ c/ =/ 5/ ,/ 区中/ item/ 的/ 平均/ 长度/ l/ =/ 10/ ,/ 那么/ ,/ q1i/ =/ 960/ ×/ 100/ // 1000/ =/ 96/ ,/ q2i/ =/ 10/ ×/ 100/ // 1000/ =/ 1/ ,/ q3i/ =/ 5/ ,/ q4i/ =/ 30/ ,/ q5i/ =/ 10/ ./ 令/ 压缩算法/ 集合/ m/ =/ {/ m1/ ,/ m2/ ,/ …/ ,/ mn/ }/ ,/ n/ 为/ 算法/ 数量/ ,/ mi/ 中/ 的/ 压缩算法/ 分别/ 取自/ 表/ 1/ 中/ 的/ 算法/ ./ 定义/ 函数/ f/ :/ T/ →/ mT/ 表示/ 根据/ 区/ 的/ 统计/ 信息/ T/ 得到/ 适合/ 区中/ 数据分布/ 的/ 最优/ 压缩算法/ mT/ ./ 4/ 区级/ 压缩/ 模式/ 与/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 如前所述/ ,/ 在/ 一列/ 上/ 采用/ 单一/ 的/ 压缩算法/ 进行/ 压缩/ 忽略/ 了/ 数据/ 的/ 局部/ 分布/ 特点/ ,/ 因此/ 本文/ 提出/ 区级/ 压缩/ 模式/ ./ 所谓/ 区级/ 压缩/ 模式/ 是/ 指/ 压缩/ 的/ 基本/ 单位/ 是/ 区/ ./ 不论/ 采用/ 什么/ 类型/ 的/ 压缩算法/ ,/ 这种/ 算法/ 针对/ 的/ 对象/ 是/ 一个/ 区中/ 的/ 数据/ ./ 例如/ 对于/ 字典/ 编码/ 来说/ ,/ 字典/ 的/ 建立/ 是/ 在/ 对区/ 中/ 的/ 数据/ 进行/ 统计/ 之后/ 得到/ 的/ ,/ 这个/ 区/ 和/ 另/ 一个/ 区/ 的/ 字典/ 的/ 内容/ 是/ 不/ 一样/ 的/ ,/ 字典/ 存放/ 在/ 区/ 控制/ 块/ 中/ ;/ 对于/ 位/ 图/ 编码/ 来说/ ,/ 区中/ 的/ 不同/ 值/ 的/ 数目/ 决定/ 了/ 要/ 采用/ 的/ 位图/ 编码/ 的/ 向量/ 的/ 数目/ ./ 然而/ ,/ 列中/ 数据分布/ 的/ 一致性/ 和/ 相似性/ 决定/ 了/ 为/ 每个/ 区/ 单独/ 学习/ 会/ 造成/ 巨大/ 的/ 时间/ 和/ 空间/ 的/ 浪费/ ./ 为此/ ,/ 本文/ 提出/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ ,/ 通过/ 学习/ 当前/ 区/ 与/ 参照/ 区/ 之间/ 的/ 相关性/ 和/ 差异性/ ,/ 进行/ 策略/ 推荐/ ,/ 从而/ 在/ 得到/ 较优/ 压缩/ 策略/ 的/ 同时/ 减少/ 时间/ 复杂度/ ./ 4.1/ 基于/ 相邻/ 参照/ 区/ 的/ 压缩/ 策略/ 选择/ 基于/ 相邻/ 参照/ 区/ 的/ 压缩/ 策略/ 选择/ 方法/ 的/ 基本/ 思想/ 是/ :/ 局部/ 连续区/ 之间/ 的/ 数据分布/ 一般/ 情况/ 下/ 具有/ 一致性/ 和/ 相似性/ ,/ 可以/ 采用/ 相同/ 压缩/ 方法/ ./ 因此/ ,/ 本文/ 首先/ 利用/ 区/ 的/ 统计/ 量/ 估计/ 相邻/ 两区/ 数据分布/ 的/ 相似性/ ./ 为此/ ,/ 这里/ 定义/ 连续区/ ri/ 和/ ri/ +/ 1/ 的/ 相似/ 因子/ 为/ S/ =/ {/ S1/ ,/ S2/ ,/ …/ ,/ S5/ }/ ,/ 其中/ j/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ 5/ }/ ./ 若/ / Sj/ 区/ 近似/ ,/ 可以/ 用/ 相邻/ 区/ 进行/ 策略/ 推荐/ ,/ 可/ 得到/ mi/ =/ mtemp/ ,/ 其中/ 推荐/ 压缩/ 方案/ 为/ mtemp/ ./ 否则/ 则/ 认为/ 两者/ 不/ 相似/ ,/ 需要/ 对/ 当前/ 待/ 压缩/ 区/ 进行/ 局部/ 学习/ ,/ 从而/ 对/ 压缩/ 策略/ 进行/ 修正/ ./ 临界值/ 是/ 不同/ 的/ ,/ 其/ 最优/ 值/ 需要/ 在/ 实验/ 中/ 确定/ ./ 如下/ ./ 这里/ 的/ δ/ i/ ∈/ δ/ 为/ 一些/ 临界值/ ,/ 不同/ 的/ q/ 对应/ 的/ 基于/ 相邻/ 参照/ 区/ 的/ 压缩/ 策略/ 选择/ 的/ 算法/ 总结/ 算法/ 1/ ./ FunctionCompression/ _/ Strategies/ (/ segments/ )/ 输入/ :/ s/ 需要/ 压缩/ 的/ 段/ 输出/ :/ 压缩/ 是否/ 成功/ (/ 0/ :/ 失败/ ,/ 1/ :/ 成功/ )/ 1/ ./ 设置/ i/ =/ 1/ 为/ 段/ s/ 的/ 第/ 1/ 个区/ 的/ 区/ 号/ 2/ ./ 设置/ m1/ =/ 0/ ,/ 推荐/ 压缩/ 策略/ mtemp/ =/ m13/ ./ whileei/ 不是/ 最后/ 一个/ 区/ 4/ ./ ifi/ =/ =/ 15/ ./ 计算/ 统计/ 信息/ Ti/ =/ {/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ ,/ li/ }/ 6/ ./ mtemp/ =/ f/ (/ Ti/ )/ 7/ ./ else8/ ./ 根据/ mtemp/ ,/ 获得/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ ,/ li/ 中/ 的/ 相关/ 信息/ 9/ ./ 根据/ 式/ (/ 1/ )/ 计算/ 对应/ 的/ 相似/ 因子/ Sj10/ ./ if/ / Sj11/ ./ mtemp/ =/ mi/ -/ 112/ ./ else13/ ./ 获得/ 当前/ 区/ 的/ 统计/ 信息/ Ti/ =/ {/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ }/ 14/ ./ mtemp/ =/ f/ (/ Ti/ )/ 15/ ./ endif16/ ./ endif17/ ./ mi/ =/ mtemp18/ ./ 按照/ mi/ 的/ 压缩/ 方式/ 对/ 本区/ 的/ 数据/ 进行/ 压缩/ 19/ ./ i/ =/ i/ +/ 120/ ./ endwhile21/ ./ endFunction/ 步/ 3/ ~/ 步/ 20/ 是/ 算法/ 的/ 主要/ 部分/ ,/ 实现/ 整个/ 列/ 的/ 压缩/ ./ 步/ 4/ ~/ 步/ 6/ 统计/ 第一个/ 区/ 的/ 统计/ 信息/ ,/ 并/ 获得/ 第一个/ 区/ 的/ 压缩算法/ ./ 步/ 7/ ~/ 步/ 17/ 处理/ 列中/ 其它/ 区/ 的/ 信息/ :/ 步/ 8/ 根据/ 推荐/ 压缩算法/ 来/ 推断/ 需要/ 统计/ 的/ 信息/ ;/ 步/ 9/ 计算/ 出/ 相似/ 因子/ ,/ 如果/ 相似/ ,/ 则/ 本区/ 的/ 压/ Page5/ 缩/ 算法/ 就/ 采用/ 推荐/ 的/ 压缩算法/ ,/ 否则/ 就/ 重新/ 统计/ 区中/ 的/ 相关/ 信息/ 并/ 得到/ 压缩算法/ ./ 以图/ 1/ 中/ 的/ 数据/ 为例/ ,/ 比较/ 适合/ 第/ 101/ 个区/ 中/ 的/ 压缩算法/ 为/ 游程/ 编码/ ,/ 那么/ 第/ 102/ 个区/ 的/ 推荐/ 压缩算法/ 也/ 就/ 为/ 游程/ 编码/ ,/ 那么/ 判断/ 游程/ 编码/ 是否/ 适合/ 第/ 102/ 个区/ ,/ 只/ 需/ 通过/ 统计/ 第/ 102/ 个区/ 中/ 相同/ 值/ 连续/ 的/ 平均/ 数目/ 即可/ ,/ 如果/ 不/ 小于/ 4/ ,/ 则/ 适合/ 采用/ 游程/ 编码/ ,/ 否则/ 需要/ 重新/ 进行/ 学习/ ,/ 对/ 推荐/ 压缩算法/ 进行/ 修正/ ./ 根据/ 图/ 1/ 所示/ ,/ 第/ 102/ 个区/ 的/ 数据/ 可以/ 采用/ 游程/ 编码/ ./ 以此类推/ ,/ 当到/ 第/ 301/ 个区/ 时/ ,/ 不/ 满足/ 游程/ 编码/ 的/ 条件/ ,/ 因此/ 这个/ 区/ 需要/ 重新学习/ ,/ 从而/ 得到/ 第/ 301/ 个区/ 的/ 压缩/ 方案/ 为/ 字典/ 编码/ ./ 那么/ 下/ 一个/ 区/ 的/ 推荐/ 压缩/ 方案/ 为/ 字典/ 编码/ ./ 上面/ 的/ f/ 是/ 通过/ 统计/ 量/ 获得/ 合适/ 压缩算法/ ,/ 这里/ 令/ f/ =/ Get/ _/ Compression/ _/ Method/ ,/ 算法/ 如下/ :/ 算法/ 2/ ./ FunctionGet/ _/ Compression/ _/ Method/ (/ 统计/ 信息/ Ti/ )/ 输入/ :/ 当前/ 区/ 的/ 统计/ 信息/ Ti/ =/ {/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ }/ 输出/ :/ 压缩/ 策略/ 1/ ./ 推荐/ 压缩/ 策略/ mtemp/ =/ 不/ 压缩/ 2/ ./ 计算/ qi/ =/ {/ q1i/ ,/ q2i/ ,/ q3i/ ,/ q4i/ ,/ q5i/ }/ 的/ 值/ 3/ ./ if/ 区中/ 的/ 数据/ 是/ 布尔/ 类型/ 4/ ./ if/ 数据/ 是/ 有序/ 的/ 5/ ./ mtemp/ =/ 游程/ 编码/ 6/ ./ else7/ ./ mtemp/ =/ 位/ 图/ 编码/ 8/ ./ endif9/ ./ elseifq2i/ >/ σ/ 110/ ./ 编码方式/ 为/ 空值/ 编码/ 11/ ./ elseifq1i/ >/ σ/ 512/ ./ ifq3i/ / σ/ 213/ ./ mtemp/ =/ 游程/ 编码/ 14/ ./ elseifq4i/ / σ/ 315/ ./ mtemp/ =/ 位/ 图/ 编码/ 16/ ./ else17/ ./ mtemp/ =/ 字典/ 编码/ 18/ ./ endif19/ ./ elseif/ 区中/ 的/ 数据/ 是/ 整数/ 类型/ 20/ ./ mtemp/ =/ 整数/ 压缩/ 编码/ 21/ ./ elseifq5i/ >/ σ/ 422/ ./ mtemp/ =/ LZ23/ ./ else24/ ./ mtemp/ =/ 不/ 压缩/ 25/ ./ endif26/ ./ Returnmtemp27/ ./ endFunction/ 算法/ 中/ 的/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ ,/ σ/ 4/ ,/ σ/ 5/ 是/ 用来/ 估计/ 压缩算法/ 的/ 阈值/ ,/ 其/ 具体/ 取值/ 在/ 实验/ 部分/ 给出/ ./ 例如/ 算法/ 第/ 9/ 步/ q2i/ >/ σ/ 1/ 表示/ 区中/ 空值/ 大于/ 一定/ 阈值/ ,/ 则/ 推荐/ 压缩算法/ 为/ 空值/ 压缩/ ./ 这里/ 的/ 空值/ 编码/ 是/ 指/ 对于/ item/ 的/ 值/ 为/ 空值/ 时/ ,/ 数据库/ 将/ 不/ 分配/ 空间/ ,/ 只是/ 给/ 一个/ 标记/ 用来/ 表示/ item/ 的/ 值/ 为/ 空/ ./ 整数/ 编码/ 采用/ 的/ 是/ 文献/ [/ 2/ ]/ 的/ 算法/ ./ 算法/ 的/ 步/ 3/ ~/ 步/ 8/ 是/ 处理/ 布尔/ 类型/ 的/ 数据/ ,/ 这/ 是因为/ 布尔/ 类型/ 的/ 数据/ 只有/ 两个/ 值/ ,/ 那么/ 统计/ 量/ q1i/ =/ 100/ ,/ q4i/ =/ 2/ 或/ q5i/ =/ 1/ ,/ 因此/ 需要/ 特殊/ 处理/ ./ 当/ 数据/ 是/ 有序/ 的/ 情况/ 下/ ,/ 则/ 意味着/ 区中/ 的/ 数据/ 的/ 结构/ 为/ 图/ 3/ 中/ 的/ 3/ 种/ 类型/ 中/ 的/ 一个/ ,/ 因此/ ,/ 用/ 游程/ 编码/ 是/ 最合适/ 的/ ;/ 当/ 数据/ 是/ 没有/ 排序/ 的/ 情况/ 下/ ,/ 采用/ 位/ 图/ 编码/ 是/ 比较/ 合适/ 的/ ./ 算法/ 的/ 步/ 9/ ~/ 步/ 10/ 是/ 用来/ 处理/ 区中/ 空值/ 比较/ 多/ 的/ 情况/ ./ 步/ 11/ ~/ 步/ 18/ 是/ 用来/ 处理/ 区中/ 公共/ 值/ 比较/ 多/ 的/ 情况/ 的/ ./ 其中/ 步/ 12/ ~/ 步/ 13/ 用来/ 处理/ 区中/ 的/ 公共/ 值/ 大多/ 是/ 连续/ 出现/ 的/ 情况/ 的/ ,/ 因此/ 采用/ 游程/ 编码/ ;/ 步/ 14/ ~/ 步/ 15/ 则/ 是/ 针对/ 不同/ 值/ 相当/ 少/ 的/ 情况/ 的/ ,/ 同时/ 也/ 避免/ 了/ 数据/ 是/ 经过/ 排序/ 的/ 情况/ ,/ 因此/ 采用/ 位/ 图/ 编码/ 还是/ 比较/ 好/ 的/ 选择/ ;/ 在/ 其它/ 情况/ 下/ ,/ 则/ 采用/ 字典/ 编码/ ,/ 这/ 就是/ 步/ 16/ ~/ 步/ 17/ 的/ 内容/ ./ 步/ 19/ ~/ 步/ 20/ 则/ 处理/ 数值/ 类型/ 中/ 既/ 没有/ 太多/ 的/ 空值/ ,/ 又/ 没有/ 太多/ 的/ 相同/ 值/ 的/ 情况/ 下/ 的/ 压缩/ ,/ 这种/ 时候/ 采用/ 整数/ 压缩/ 编码/ 还是/ 很/ 好/ 的/ 选择/ ./ 4.2/ 基于/ 参照/ 列/ 的/ 压缩/ 策略/ 选择/ 基于/ 参照/ 列/ 的/ 压缩/ 策略/ 选择/ 的/ 基本/ 思想/ 是/ :/ 数据/ 在/ 整个/ 列上/ 的/ 分布/ 具有/ 一致性/ ,/ 因此/ 可以/ 用/ 整个/ 列/ 的/ 统计/ 信息/ 作为/ 参照/ 推断/ 待/ 压缩/ 区/ 的/ 数据分布/ ,/ 从而/ 进行/ 策略/ 推荐/ ./ 这里/ 从待/ 压缩/ 的/ 段/ 中/ 随机/ 抽取/ 若干个/ 区/ (/ 如段/ 中区/ 的/ 数目/ 的/ 1/ // 20/ )/ 作为/ 样本/ ,/ 将/ 这些/ 抽取/ 出来/ 的/ 区/ 中/ 数据/ 的/ 分布/ 代表/ 整个/ 段/ 中/ 的/ 数据/ 的/ 分布/ 特点/ ./ 通过/ 对/ 这些/ 抽取/ 出来/ 的/ 区/ 的/ 数据/ 进行/ 统计/ ,/ 得到/ 与/ 统计/ 信息/ 相匹配/ 的/ 压缩算法/ ,/ 从而/ 确定/ 这个/ 段/ 的/ 推荐/ 压缩/ 方式/ ./ 与/ 该段/ 中/ 统计数据/ 分布/ 相似/ 的/ 区/ ,/ 将/ 采用/ 推荐/ 的/ 压缩/ 策略/ 压缩/ ,/ 否则/ 将/ 重新学习/ 来/ 确定/ 压缩算法/ ./ 这里/ 将/ 随机/ 抽取/ 的/ 区/ 中/ 的/ 数据/ 的/ 相关/ 统计/ 信息/ 记为/ T/ =/ {/ r/ ,/ s/ ,/ a/ ,/ d/ ,/ n/ ,/ c/ }/ ,/ 统计/ 量/ 为/ q/ =/ {/ q1/ ,/ q2/ ,/ q3/ ,/ q4/ ,/ q5/ }/ ,/ 这里/ 定义/ 了/ 当前/ 区/ ri/ 和/ 样本/ 区/ r/ 的/ 相似/ 因子/ 为/ S/ =/ {/ S1/ ,/ S2/ ,/ …/ ,/ S5/ }/ ,/ 推荐/ 压缩/ 方案/ mtemp/ =/ f/ (/ T/ )/ ,/ 其中/ T/ 为/ 抽取/ 出来/ 的/ 区/ 的/ 统计/ 信息/ ./ Page6/ 若/ / Sj/ 似/ ,/ 可以/ 进行/ 策略/ 推荐/ ,/ 可/ 得到/ mj/ =/ mtemp/ ./ 否则/ 则/ 认为/ 两者/ 不/ 相似/ ,/ 需要/ 对/ 当前/ 待/ 压缩/ 区/ 进行/ 局部/ 学习/ ,/ 从而/ 对/ 压缩/ 策略/ 进行/ 修正/ ./ 其中/ δ/ i/ ∈/ δ/ 为/ 一些/ 临界值/ ,/ 和/ 4.1/ 节/ 相同/ ./ 那么/ 通过/ 算法/ 2/ 获得/ 合适/ 的/ 压缩/ 方法/ ./ 基于/ 参照/ 列/ 的/ 压缩/ 策略/ 选择/ 的/ 算法/ 如下/ ./ 算法/ 3/ ./ FunctionCompression/ _/ Strategies/ (/ segments/ )/ ./ 输入/ :/ s/ 需要/ 压缩/ 的/ 段/ 输出/ :/ 压缩/ 是否/ 成功/ (/ 0/ :/ 失败/ ,/ 1/ :/ 成功/ )/ 1/ ./ 设置/ m1/ =/ 0/ ,/ 推荐/ 压缩/ 策略/ mtemp2/ ./ 从段/ s/ 中/ 随机/ 挑选出/ 约/ 1/ // 20/ 的/ 区/ 3/ ./ 获得/ 这些/ 区/ 的/ 统计/ 信息/ T/ =/ {/ r/ ,/ s/ ,/ a/ ,/ d/ ,/ n/ ,/ c/ }/ 4/ ./ 得到/ 推荐/ 压缩算法/ mtemp/ =/ f/ (/ T/ )/ 5/ ./ whiles/ 中/ 的/ 数据/ 没有/ 压缩/ 完毕/ 6/ ./ 根据/ mtemp/ ,/ 获得/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ ,/ li/ 中/ 的/ 相关/ 信息/ 7/ ./ 计算/ 相似/ 因子/ Si8/ ./ if/ / Sj9/ ./ 采用/ mtemp/ 进行/ 数据压缩/ 10/ ./ else11/ ./ 获得/ 当前/ 区/ 的/ 统计/ 信息/ Ti/ =/ {/ ri/ ,/ si/ ,/ ai/ ,/ di/ ,/ ni/ ,/ ci/ }/ 12/ ./ 调用/ f/ (/ Ti/ )/ 来/ 得到/ 合适/ 的/ 压缩算法/ 并/ 压缩/ 数据/ 13/ ./ endif14/ ./ i/ =/ i/ +/ 115/ ./ endwhile16/ ./ endFunction/ 算法/ 的/ 步/ 2/ ~/ 步/ 4/ 主要/ 是/ 获得/ 随机/ 区中/ 的/ 数据/ 并/ 进行/ 统计/ 得到/ 推荐/ 压缩算法/ ./ 步/ 5/ ~/ 步/ 15/ 则/ 是/ 对/ 每/ 一个/ 区/ 的/ 处理过程/ ./ 步/ 8/ ~/ 步/ 9/ 是/ 对/ 与/ 段/ 的/ 数据分布/ 相同/ 的/ 区/ 的/ 压缩算法/ 采用/ 推荐/ 压缩算法/ ,/ 而/ 与/ 段/ 的/ 数据分布/ 不/ 相同/ 的/ 区/ 的/ 处理/ 则/ 是/ 在/ 步/ 10/ ~/ 步/ 13/ 中/ ./ 以图/ 1/ 中/ 的/ 数据/ 为例/ ,/ 通过/ 对/ 抽取/ 一部分/ 随机/ 的/ 区/ 的/ 数据/ 的/ 分析/ ,/ 可以/ 得出/ 这个/ 段/ 的/ 推荐/ 压缩/ 方案/ 为/ 游程/ 编码/ ./ 在/ 处理/ 第/ 101/ 个区/ 时/ ,/ 推荐/ 压缩/ 方案/ 为/ 游程/ 编码/ ,/ 而/ 第/ 101/ 个区/ 的/ 数据分布/ 的/ 特点/ 满足/ 游程/ 编码/ 的/ 要求/ ,/ 因此/ 不用/ 进行/ 学习/ ./ 当/ 处理/ 到/ 第/ 301/ 个区/ 时/ ,/ 统计分析/ 的/ 结果/ 不/ 满足/ 右侧/ 很/ 难过/ 编码/ 的/ 特点/ ,/ 因此/ 第/ 301/ 个区/ 需要/ 重新学习/ ,/ 从而/ 得到/ 适合/ 的/ 压缩/ 方案/ 为/ 字典/ 编码/ ,/ 但是/ 此时/ 下/ 一个/ 区/ 的/ 推荐/ 压缩/ 方案/ 仍为/ 游程/ 编码/ ,/ 而/ 不是/ 字典/ 编码/ ,/ 这/ 和/ 算法/ 1/ 有着/ 明显/ 的/ 区别/ ./ 5/ 实验/ 验证/ (/ 1/ )/ 实验/ 环境/ Intel/ (/ R/ )/ Pentium/ (/ R/ )/ 4CPU2/ ./ 80GHz/ ,/ 内存/ DDR512MB/ ,/ 缓存/ L1/ :/ 8KBytes/ ,/ L2/ :/ 12Kuops/ ,/ L3/ :/ 512KBytes/ ./ 软件/ 环境/ 操作系统/ 为/ WindowsXPProfessionalVersion2002ServicePack3/ ,/ 开发/ 环境/ 为/ MicrosoftVisual/ C++/ 6.0/ ./ 本文/ 用/ C语言/ 实现/ 了/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ ,/ 在/ 此基础/ 上/ ,/ 设计/ 了/ 两个/ 实验/ ,/ 用来/ 和/ C/ -/ Store/ 的/ 决策树/ 进行/ 相比/ ,/ 从/ 压缩率/ 和/ 压缩/ 所/ 需要/ 的/ 时间/ 两个/ 方面/ 进行/ 对比/ ./ (/ 2/ )/ 数据/ 集/ 描述/ 本文/ 实验/ 的/ 数据/ 是/ 采用/ 数据仓库/ 基准/ 数据/ 集/ SSB/ 中/ 的/ customer/ 表/ 的/ 数据/ ./ 本文/ 选择/ customer/ 表/ 的/ mktsegment/ 列来/ 进行/ 测试/ ./ 这/ 是因为/ 在/ 数据库/ 使用/ 的/ 压缩/ 方法/ 中/ ,/ 字典/ 编码/ 、/ 游程/ 编码/ 和/ 位图/ 编码/ 是/ 最/ 常用/ 也/ 是/ 最/ 重要/ 的/ 3/ 种/ 压缩/ 方法/ ./ 在/ mktsegment/ 列中/ 一共/ 只有/ 5/ 个/ 不同/ 的/ 值/ ./ 根据/ 观察/ 可以/ 看出/ ,/ 如果/ 基于/ C/ -/ Store/ 决策树/ 的/ 方法/ ,/ 那么/ 根据/ C/ -/ Store/ 决策树/ 分析/ ,/ 应该/ 采用/ 位/ 图/ 编码/ 来/ 对/ 数据/ 进行/ 压缩/ ./ 而/ 本文/ 提出/ 的/ 基于/ 学习/ 的/ 区级/ 压缩/ 模式/ 下/ 的/ 策略/ 选择/ 方法/ 则/ 可以/ 采用/ 的/ 压缩/ 方案/ 为/ 字典/ 编码/ 、/ 位/ 图/ 编码/ 和/ 游程/ 编码/ ./ 因此/ 本文/ 提出/ 的/ 两种/ 实现/ 方法/ 和/ 基于/ C/ -/ Store/ 决策树/ 的/ 方法/ 就/ 可以/ 很/ 好/ 地/ 在/ 同样/ 的/ 数据/ 中/ 进行/ 比较/ ,/ 由此看来/ mktsegment/ 列有/ 很/ 强/ 的/ 代表性/ ./ 本/ 实验/ 中/ 采用/ 的/ 区/ 的/ 大小/ 为/ 16KB/ ,/ 可以/ 存放/ 大约/ 2000/ 个/ 左右/ 的/ 数据/ ./ 本文/ 分别/ 对/ 660KB/ ,/ 1980KB/ ,/ 3300KB/ ,/ 4620KB/ ,/ 5940KB/ ,/ 7260KB/ ,/ 8580KB/ ,/ 9900KB/ ,/ 11220KB9/ 种/ 不同/ 大小/ 的/ 数据/ 进行/ 了/ 测试/ ./ 根据/ 不同/ 压缩算法/ 的/ 特点/ ,/ 本文/ 方法/ 中/ 涉及/ 的/ 一些/ 参数/ 取值/ 如下/ :/ σ/ 1/ =/ 30/ ,/ σ/ 2/ =/ 4/ ,/ σ/ 3/ =/ 4/ ,/ σ/ 4/ =/ 20/ ,/ σ/ 5/ =/ 20/ ,/ δ/ 1/ =/ 5/ ,/ δ/ 2/ =/ 5/ ,/ δ/ 3/ =/ 1/ ,/ δ/ 4/ =/ 3/ ,/ δ/ 5/ =/ 5/ ./ (/ 3/ )/ 实验/ 结果/ 与/ 分析/ 本文/ 从/ 以下/ 两个/ 方面/ 对/ 3/ 种/ 不同/ 压缩/ 策略/ 选择/ 方法/ :/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 、/ 基于/ 统计分析/ 的/ 压缩/ 策略/ 选择/ 方法/ 和/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ 进行/ 比较/ :/ a/ )/ 压缩率/ 比较/ ./ 通过/ 在/ 同/ 一种/ 数据类型/ (/ 这里/ 为/ 字符串/ 类型/ )/ 不同/ 数据量/ 上/ 进行/ 比较/ ,/ 如图/ 4/ 所示/ ./ 图中/ 的/ 数据/ 不/ 包含/ 槽/ 的/ 长度/ (/ 每/ 一个/ 项/ (/ item/ )/ 对应/ 一个/ 槽/ ,/ 每个/ 槽/ 的/ 长度/ 为/ 13B/ )/ ,/ 指/ 的/ 是/ 每/ 一个/ Page7item/ 压缩/ 之后/ 的/ 长度/ ./ 从图/ 4/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 两种/ 压缩/ 策略/ 选择/ 方法/ 要/ 比/ 基于/ 学习/ 的/ 区级/ 压缩/ 模式/ 下/ 的/ 策略/ 选择/ 方法/ 的/ 压缩/ 效果/ 好/ ./ 这/ 是因为/ ,/ 当/ 数据量/ 大/ 的/ 时候/ ,/ 数据/ 的/ 整体/ 的/ 特点/ 虽然/ 变得/ 比较/ 清晰/ ,/ 但是/ 在/ 局部/ 的/ 地方/ ,/ 数据/ 的/ 分布/ 和/ 整体/ 还是/ 有/ 很大/ 的/ 区别/ ./ 并且/ 随着/ 数据量/ 的/ 增大/ ,/ 和/ 整体/ 数据/ 具有/ 不同/ 分布/ 的/ 局部/ 变得/ 越来越/ 多/ ,/ 这/ 也/ 就/ 造成/ 了/ 这些/ 局部/ 的/ 数据/ 需要/ 用/ 更加/ 合适/ 的/ 方法/ 进行/ 压缩/ ,/ 才能/ 提高/ 压缩率/ ./ 在/ 实验/ 中/ ,/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ 为/ 整个/ 列/ 得到/ 的/ 压缩/ 方法/ 为位/ 图/ 编码/ ,/ 而/ 本文/ 提出/ 的/ 策略/ 选择/ 方法/ 采用/ 局部/ 学习/ 获得/ 的/ 压缩/ 方案/ 包括/ 位/ 图/ 编码/ 、/ 游程/ 编码/ 和/ 字典/ 编码/ ./ 绝大部分/ 的/ 区/ 的/ 压缩/ 方案/ 为/ 字典/ 编码/ ,/ 一少部分/ 区/ 的/ 压缩/ 方案/ 为位/ 图/ 编码/ 和/ 游程/ 编码/ ./ 表/ 2/ 显示/ 的/ 是/ 一个/ item/ 在/ 一部分/ 压缩/ 方案/ 压缩/ 之后/ 的/ 表示/ 形式/ 以及/ 压缩/ 之后/ 的/ 占用/ 的/ 空间/ 的/ 大小/ ./ 其中/ X/ 为/ 0/ 或者/ 1/ ,/ N/ 表示/ 参与/ 位/ 图/ 编码/ 的/ 不同/ 值/ 的/ 数目/ ./ 例如/ customer/ 表/ 的/ mktseg/ -/ ment/ 列/ 中共/ 有/ 5/ 个/ 不同/ 的/ 值/ ,/ 采用/ 位/ 图/ 编码/ 的话/ ,/ 那么/ 这里/ 的/ N/ 就/ 为/ 5/ ./ 显然/ ,/ 采用/ 字典/ 编码/ 更/ 节省/ 空间/ (/ 位/ 图/ 编码/ 还有/ 另外/ 一种/ 实现/ 方式/ ,/ 用/ 一个/ 位来/ 表示/ 压缩/ 之后/ 的/ 数据/ ,/ 这样/ 有/ 一个/ 缺点/ ,/ 很难/ 定位/ 一个/ item/ ,/ 不利于/ 查询/ ,/ 如果/ 再用/ 一条/ 记录/ 来/ 标记/ 位置/ 的话/ ,/ 占用/ 的/ 空间/ 则/ 更/ 大/ )/ ./ 压缩/ 方法/ 压缩/ 之后/ 的/ 结构/ 压缩/ 之后/ 占用/ 的/ 空间/ 字典/ 编码/ (/ 字典/ 编号/ )/ 位/ 图/ 编码/ (/ XXXXXXXX/ )/ N/ 个/ 字节/ 游程/ 编码/ (/ value/ ,/ begin/ _/ id/ ,/ len/ )/ Length/ (/ value/ )/ +/ 8/ +/ 8/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 和/ 基于/ 统计分析/ 的/ 压缩/ 策略/ 选择/ 方法/ 的/ 压缩/ 效果/ 相差/ 不大/ ./ 但是/ 随着/ 数据量/ 的/ 增大/ ,/ 前者/ 的/ 压缩/ 效果/ 要/ 稍/ 优于/ 后者/ ./ 这/ 是因为/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 在/ 每/ 一个/ 区上/ 都/ 实现/ 了/ 最大/ 限度/ 的/ 压缩/ ,/ 而/ 基于/ 统计分析/ 的/ 压缩/ 策略/ 选择/ 方法/ 则/ 是/ 通过/ 随机/ 抽取/ 一定量/ 的/ 区/ 的/ 统计/ 信息/ 来/ 得到/ 整个/ 列/ 的/ 统计/ 信息/ ,/ 从而/ 得到/ 推荐/ 压缩/ 方法/ ,/ 这/ 也/ 就/ 意味着/ 这种/ 方法/ 在/ 采样/ 随机性/ 的/ 影响/ ,/ 因此/ ,/ 无法/ 保证/ 对/ 每/ 一个/ 区上/ 的/ 推荐/ 压缩算法/ 是/ 适当/ 的/ 压缩算法/ ,/ 造成/ 了/ 压缩比/ 稍/ 低于/ 前者/ ./ b/ )/ 压缩/ 时间/ 的/ 比较/ ./ 主要/ 是/ 指/ 对/ 同样/ 大小/ 的/ 数据/ ,/ 完成/ 压缩/ 所/ 需要/ 的/ 时间/ ./ 如图/ 5/ 所示/ ./ 从图/ 5/ 可以/ 看出/ ,/ 在/ 数据量/ 比较/ 小/ 的/ 时候/ ,/ 3/ 种/ 方法/ 所用/ 的/ 压缩/ 时间/ 相差/ 不/ 大/ ,/ 而/ 当/ 数据量/ 增大/ 的/ 时候/ ,/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ 需要/ 的/ 时间/ 要/ 稍/ 长于/ 本文/ 提出/ 的/ 两种/ 压缩/ 策略/ 选择/ 方法/ ./ 这/ 是因为/ ,/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ 需要/ 对/ 整个/ 列/ 的/ 数据/ 的/ 全部/ 统计/ 信息/ 进行/ 统计/ ,/ 而/ 本文/ 提出/ 的/ 两种/ 区级/ 压缩/ 模式/ 下/ 的/ 压缩/ 策略/ 选择/ 方法/ 则/ 不同/ ,/ 在/ 大部分/ 区中/ 只/ 需要/ 统计/ 部分/ 的/ 统计/ 信息/ 来/ 验证/ 本区/ 适合/ 采用/ 推荐/ 的/ 压缩算法/ ,/ 只有/ 在/ 不/ 满足/ 推荐/ 压缩算法/ 的/ 区/ 才/ 统计/ 全部/ 的/ 统计/ 信息/ ,/ 这样一来/ ,/ 随着/ 数据量/ 的/ 增大/ ,/ 这种/ 差别/ 就/ 变得/ 比较/ 明显/ ./ 从图/ 5/ 中/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 和/ 基于/ 统计分析/ 的/ 压缩/ 策略/ 选择/ 方法/ 在/ 压缩/ 相同/ 大小/ 的/ 数据/ 时/ 需要/ 的/ 压缩/ 时间/ 相差/ 很小/ ,/ 偶尔/ 后者/ 需要/ 的/ 压缩/ 时间/ 要/ 稍/ 大于/ 前者/ ,/ 这/ 是因为/ 后者/ 采用/ 的/ 是/ 通过/ 随机/ 抽取/ 一定/ 数量/ 区/ 的/ 数据/ 作为/ 样本/ 来/ 估计/ 整个/ 列/ 的/ 数据分布/ ,/ 从而/ 推测/ 出/ 最/ 适合/ 这个/ 列/ 的/ 压缩/ 方法/ ,/ 但是/ 有时/ 会/ 发生/ 估算/ 错误/ ,/ 也/ 就/ 意味着/ 样本/ 数据/ 的/ 分布/ 特点/ 和/ 这个/ 列/ 的/ 数据分布/ 特点/ 不/ 相符/ ,/ 这/ 就/ 意味着/ 更/ 多/ 的/ 区/ 需要/ 学习/ ,/ 也/ 就/ 会/ 造成/ 时间/ 的/ 浪费/ ./ 6/ 结论/ 通过/ 第/ 5/ 节/ 的/ 分析/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 两种/ 区级/ 压缩/ 模式/ 下/ 的/ 压缩/ 策略/ 选择/ 方法/ 要/ 优于/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ ./ 本文/ 的/ 两种/ 区级/ 压缩/ 模式/ 下/ 的/ 策略/ 选择/ 方法/ 通过/ 对/ 局部/ 数据/ 的/ 学习/ 来/ 推断/ 后面/ 的/ 数据/ 的/ 分布/ ,/ 并/ 通过/ 对下/ 一部分/ 的/ 数据/ 的/ 统计/ 信息/ 进行/ 分析/ 来/ 验证/ 是否/ 符合/ 推荐/ 压缩/ 方式/ 的/ 特点/ ,/ 从而/ 对/ 压缩算法/ 进行/ 校正/ ,/ 找到/ 适合/ 本/ 部分/ 的/ 压缩/ 方法/ ,/ 这/ 也/ 就/ 意味着/ ,/ 每/ 一个/ 部分/ 都/ 得到/ 了/ 较/ 好/ 的/ 压缩/ ,/ 从而/ 表现/ 出/ 优于/ 基于/ C/ -/ Store/ 决策树/ 的/ 压缩/ 策略/ 选择/ 方法/ 的/ 特点/ ./ 通过/ 压缩比/ 和/ 压缩/ 时间/ 的/ 比较/ ,/ 本文/ 提出/ 的/ 基于/ 学习/ 的/ 压缩/ 策略/ 选择/ 方法/ 要/ 优于/ 基于/ 统计分析/ 的/ 压缩/ 策略/ 选择/ 方法/ ./ Page8/ 虽然/ 在/ 压缩比/ 和/ 压缩/ 时间/ 上/ 表现/ 出比/ C/ -/ Store/ 决策树/ 更优/ 的/ 性能/ ,/ 但是/ 区/ 的/ 大小/ 也/ 是/ 一个/ 影响/ 压缩/ 效果/ 的/ 重要/ 因素/ ./ 区过/ 大/ 或者/ 过小多/ 是/ 不利于/ 压缩/ 的/ ./ 因此/ 需要/ 更进一步/ 的/ 实验/ 来/ 确定/ 区/ 的/ 大小/ ,/ 并/ 对/ 数据仓库/ 最/ 重要/ 的/ 两类/ 查询/ :/ 范围/ 查询/ 和/ 聚集/ 查询/ 进行/ 测试/ ./ 另外/ 本文/ 的/ 算法/ 中/ 使用/ 到/ 了/ 一些/ 阈值/ ,/ 这些/ 阈值/ 在/ 下/ 一步/ 的/ 工作/ 中/ 进行/ 测试/ 确定/ ./ 

