Page1/ 抗主/ 密钥/ 泄露/ 和/ 连续/ 泄露/ 的/ 双态/ 仿射/ 函数/ 加密/ 张/ 明武/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 杨波/ 2/ )/ TAKAGITsuyoshi3/ )/ 1/ )/ (/ 华南农业大学/ 信息/ 学院/ 广州/ 510642/ )/ 2/ )/ (/ 陕西/ 师范大学/ 计算机/ 学院/ 西安/ 710072/ )/ 3/ )/ (/ 九州/ 大学/ 工业/ 数学/ 研究所/ 福冈/ 819/ -/ 0395/ 日本/ )/ 摘要/ 抗/ 密钥/ 泄露/ 安全/ 的/ 加密/ 系统/ 保证/ 在/ 攻击者/ 获得/ (/ 主/ )/ 密钥/ 部分/ 信息/ 的/ 情况/ 下/ 仍/ 具有/ 语义/ 安全性/ ./ 文中/ 设计/ 了/ 一个/ 抗/ 密钥/ 泄露/ 的/ 双态/ 仿射/ 函数/ 加密/ 方案/ ,/ 该/ 方案/ 中/ 加密/ 策略/ 和/ 解密/ 角色/ 定义/ 为/ 仿射/ 空间/ ,/ 并且/ 具有/ 再次/ 委托/ 能力/ ./ 在/ 双系统/ 加密/ 模型/ 下/ ,/ 实现/ 了/ 自/ 适应/ 安全/ 的/ 抗有界/ 的/ 主/ 密钥/ 泄露/ 和/ 用户/ 密钥/ 连续/ 泄露/ 的/ 加密/ 方案/ ,/ 在/ 标准/ 模型/ 下/ 基于/ 静态/ 子群/ 判定/ 假设/ 证明/ 了/ 该/ 方案/ 的/ 安全性/ ./ 同时/ ,/ 分析/ 了/ 方案/ 中/ 的/ 主/ 密钥/ 和/ 用户/ 密钥/ 的/ 泄露/ 界/ 和/ 泄露/ 率/ ,/ 通过/ 参数/ 调整/ 可以/ 达到/ 接近/ 73/ %/ 的/ 泄露/ 率/ ,/ 具有/ 较/ 好/ 的/ 抗/ 泄露/ 性质/ ./ 关键词/ 函数/ 加密/ ;/ 仿射/ 空间/ ;/ 抗/ 泄露/ ;/ 双系统/ 加密/ ;/ 可证/ 安全/ 1/ 引言/ 现代/ 密码学/ 都/ 假定/ 用户/ 密钥/ 对/ 可能/ 的/ 攻击/ 来说/ 是/ 完全/ 隐藏/ 的/ ,/ 但/ 在/ 实际/ 中/ 通过/ 边/ 信道/ 攻击/ ,/ 例如/ 时间/ 攻击/ 、/ 电源/ 耗损/ 、/ 冷启动/ 攻击/ 以及/ 频谱/ 分析/ 等/ ,/ 都/ 能/ 从/ 保密/ 密钥/ 或/ 加密/ 系统/ 内部/ 获得/ 有关/ 密钥/ 的/ 部分/ 信息/ ./ Akavia/ 等/ 人/ [/ 1/ ]/ 引入/ 密钥/ 泄露/ 概念/ ,/ 攻击者/ 即使/ 从/ 密钥/ 中/ 获得/ 部分/ 信息/ ,/ 而/ 加密/ 方案/ 仍然/ 是/ 语义/ 安全/ 的/ ,/ 则/ 称/ 该/ 加密/ 方案/ 是/ 抗/ 泄露/ (/ leakage/ -/ resilient/ )/ 攻击/ 安全/ 的/ ./ 为了/ 模拟/ 泄露/ ,/ 设定/ 攻击者/ 能够/ 访问/ 泄露/ 谕言机/ (/ leakageoracle/ )/ ,/ 从而/ 获得/ 关于/ 密钥/ 的/ 任何/ 函数/ 的/ 输出/ ,/ 即/ f/ :/ f/ (/ SK/ )/ →/ {/ 0/ ,/ 1/ }/ / [/ 2/ -/ 5/ ]/ ./ 除了/ 具有/ 以往/ 的/ 语义/ 安全/ 所/ 具有/ 的/ 能力/ 外/ ,/ 攻击者/ 还/ 能够/ 自/ 适应/ 地/ 对/ 泄露/ 谕言机/ 进行/ 询问/ ,/ 唯一/ 的/ 限制/ 是/ 攻击者/ 所/ 获得/ 泄露/ 的/ 输出/ 长度/ 总和/ 不能/ 超过/ 预先/ 设定/ 的/ 边界值/ ,/ 该/ 模型/ 也/ 称/ 有界/ 泄露/ 模型/ (/ BoundedLeak/ -/ ageModel/ ,/ BLM/ )/ ./ Alwen/ 等/ 人/ [/ 2/ ]/ 首次/ 构建/ 基于/ 边界/ 检索/ 模型/ (/ Bounded/ -/ RetrievalModel/ ,/ BRM/ )/ 的/ 抗/ 密钥/ 泄露/ 的/ 公钥/ 加密/ 方案/ ,/ 它/ 是/ 一种/ 有/ 界/ 泄露/ 模型/ 的/ 方案/ ./ Chow/ 等/ 人/ [/ 6/ ]/ 在/ 基于/ Hash/ 证明/ 系统/ [/ 7/ ]/ 的/ 基础/ 上/ ,/ 构建/ 了/ 几种/ 抗/ 泄露/ 的/ 基于/ 身份/ 的/ 加密/ 方案/ ,/ 但/ 不/ 支持/ 主/ 密钥/ 泄露/ 安全/ ,/ 同时/ 把/ 具有/ 委托/ 能力/ 的/ 抗/ 泄露/ 方案/ 作为/ 未/ 解决/ 的/ 公开/ 问题/ ./ 文献/ [/ 6/ -/ 7/ ]/ 的/ 方案/ 只/ 支持/ 每个/ 身份/ 的/ 单次/ 密钥/ 泄露/ ,/ Brakershi/ 等/ 人/ [/ 8/ ]/ 提出/ 支持/ 密钥/ 连续/ 泄露/ 的/ 加密/ 方案/ ,/ 但/ 不/ 支持/ 主/ 密钥/ 泄露/ ./ Lewko/ 等/ 人/ [/ 5/ ]/ 提出/ 采用/ 双系统/ 加密技术/ (/ DualSystemEncryption/ ,/ DSE/ )/ 可以/ 构造/ 抗/ 密钥/ 泄露/ 的/ 方案/ ,/ 同时/ 构建/ 了/ 支持/ 有/ 界/ 泄露/ 的/ IBE/ 、/ HIBE/ 和/ ABE/ 方案/ ./ 空间/ 加密/ (/ SpatialEncryption/ ,/ SE/ )/ [/ 9/ -/ 11/ ]/ 采用/ 仿射/ 空间/ 作为/ 解密/ 角色/ ,/ 而/ 仿射/ 空间/ 中/ 的/ 点/ 向量/ 作为/ 加密/ 策略/ ./ 根据/ 仿射/ 空间/ 的/ 包含/ 性可/ 实现/ 密钥/ 的/ 再次/ 委托/ 能力/ ./ 在/ 标准/ 的/ SE/ 方案/ 的/ 基础/ 上/ ,/ Vie/ 和/ Abdalla/ 采用/ DSE/ 技术/ 设计/ 抗/ 密钥/ 泄露/ 的/ 空间/ 加密/ 方案/ ,/ 该/ 方案/ 中/ 可/ 泄露/ 界/ 与/ 空间/ 的/ 维度/ 相关联/ [/ 12/ ]/ ./ 在/ SE/ 方案/ 中/ ,/ 由于/ 加密/ 策略/ 定义/ 为/ κ/ 维/ 的/ 点/ 向量/ ,/ 因此/ 无法/ 实现/ 策略/ 的/ 再次/ 委托/ 能力/ ./ 双态/ 仿射/ 函数/ 加密/ 是/ 一般/ 空间/ 加密/ 的/ 一般性/ 扩展/ ./ 在/ 双态/ 仿射/ 函数/ 加密/ 方案/ 中/ ,/ 加密/ 策略/ 和/ 解密/ 角色/ 都/ 定义/ 为/ 仿射/ 子/ 空间/ ./ 角色/ 委托/ 实现/ 解密/ 能力/ 的/ 再次/ 委托/ ,/ 可以/ 实现/ 类似/ 基于/ 代理/ 的/ 密码/ 系统/ ,/ 而/ 加密/ 策略/ 定义/ 于/ 可/ 委托/ 的/ 仿射/ 空间/ ,/ 扩展/ 的/ 加密/ 策略/ 委托/ 能力/ 可以/ 支持/ 重/ 加密/ 的/ 能力/ ./ 因此/ ,/ 双态/ 仿射/ 空间/ 加密/ 具有/ 广泛/ 的/ 模型/ ,/ 它/ 扩展/ 了/ PKE/ [/ 13/ ]/ 、/ HIBE/ [/ 14/ -/ 15/ ]/ 、/ ABE/ [/ 16/ ]/ 、/ HVE/ [/ 17/ ]/ 、/ FE/ [/ 18/ -/ 19/ ]/ 等/ 方案/ ./ 本文/ 设计/ 了/ 一个/ 抗/ 密钥/ 泄露/ 安全/ 的/ 双态/ 仿射/ 函数/ 加密/ 方案/ ,/ 在/ 双系统/ 加密/ 模型/ 下/ ,/ 实现/ 自/ 适应/ 安全/ 抗/ 用户/ 密钥/ 多次/ 泄露/ 和/ 主/ 密钥/ 泄露/ ./ 本/ 方案/ 中/ ,/ 加密/ 策略/ 和/ 解密/ 角色/ 都/ 定义/ 为/ 代数/ 仿射/ 向/ 量子/ 空间/ ,/ 并且/ 可以/ 有/ 再次/ 委托/ 的/ 能力/ ./ 当/ 解密/ 角色/ 空间/ 与/ 加密/ 策略/ 空间/ 存在/ 一/ 不动点/ (/ 交集/ 不为/ 空/ )/ 时/ ,/ 可/ 实现/ 函数/ 的/ 匹配/ 并/ 解密/ ./ 本/ 方案/ 中/ 通过/ 引入/ 抗/ 泄露/ 组件/ ,/ 提高/ 密钥/ 的/ 抗/ 泄露/ 能力/ ./ 同时/ 通过/ 密钥/ 生成/ 和/ 委托/ 算法/ 的/ 特殊/ 功能/ ,/ 实现/ 主/ 密钥/ 和/ 用户/ 密钥/ 的/ 更新/ 功能/ ,/ 从而/ 提高/ 系统/ 的/ 抗/ 连续/ 泄露/ 性/ ./ 本文/ 方案/ 是/ 抗/ 泄露/ 的/ IBE/ 、/ HIBE/ 、/ SE/ 和/ FE/ 的/ 一般性/ 扩展/ :/ 特别/ 地/ ,/ 当/ 加密/ 策略/ 和/ 解密/ 角色/ 缩小/ 为/ 仿射/ 空间/ 中/ 两个/ 点/ 向量/ 时/ ,/ 本/ 方案/ 简化/ 为抗/ 泄露/ IBE/ 方案/ ;/ 当/ 仿射/ 空间/ 定义/ 为/ 树形/ 结构/ 空间/ 而/ 解密/ 角色/ 定义/ 为/ 一个点/ 向量/ 时/ ,/ 本/ 方案/ 为抗/ 泄露/ HIBE/ 方案/ ;/ 当/ 解密/ 角色/ 变成/ 一个点/ 时/ ,/ 本/ 方案/ 为抗/ 泄露/ SE/ 方案/ ./ 1.1/ 基本思路/ 方案/ 采用/ 多维/ 双系统/ 加密技术/ 实现/ ,/ 可以/ 容忍/ 主/ 密钥/ 的/ 泄露/ 和/ 用户/ 密钥/ 的/ 连续/ 泄露/ ,/ 同时/ 达到/ 自/ 适应/ 安全/ ./ 为/ 实现/ 抗主/ 密钥/ 泄露/ 和/ 连续/ 用户/ 密钥/ 泄露/ ,/ 把/ 一维/ 半/ 功能/ 空间/ 扩展/ 为/ n/ 维/ ./ 在/ 双系统/ 加密/ DSE/ 技术/ 中/ ,/ 密文/ 和/ 密钥/ 都/ 可以/ 定义/ 两种/ 形态/ :/ 正常/ (/ Normal/ )/ 和/ 半/ 功能/ (/ Semi/ -/ Functional/ ,/ SF/ )/ ./ 正常/ 形态/ 密钥/ 可以/ 解密/ 任何/ 一种/ 形式/ 的/ 密文/ ,/ 但/ SF/ 的/ 密钥/ 只能/ 解密/ 正常/ 形态/ 密文/ ,/ 不能/ 解密/ SF/ 密文/ ./ 目前/ 实现/ DSE/ 的/ 方法/ 主要/ 有/ 3/ 种/ :/ 基于/ 标签/ tag/ 的/ 构建/ [/ 15/ ]/ 、/ 基于/ 正交/ 双线性/ 子群/ 的/ 构建/ [/ 14/ ,/ 16/ ]/ 和/ 基于/ 双对/ 向量/ 空间/ (/ DualPairingVectorSpaces/ ,/ DPVS/ )/ [/ 18/ ]/ ./ 本文/ 采用/ 正交/ 双线性/ 群来/ 设计/ 抗/ 泄露/ 能力/ ./ 构建/ 方案/ 的/ 密文/ 和/ 密钥/ 都/ 定义/ 为/ 正常/ 形式/ ,/ 在/ 证明/ 过程/ 中/ 采用/ 混合/ 证明/ 方法/ ,/ 首先/ 密文/ 改变/ 成/ SF/ 形态/ 的/ ,/ 密钥/ 由/ 正常/ 形式/ 逐步/ 改变/ 成/ SF/ 形态/ ,/ 我们/ 要/ 证明/ 敌手/ 不能/ 感知/ 到/ 这些/ 改变/ ,/ 主要/ 基于/ 合数/ 阶群/ 的/ 子群/ 判定/ 假设/ ./ 最后/ 模拟器/ 生成/ SF/ 形式/ 的/ 密钥/ 和/ 密文/ ,/ 并/ 作为/ 挑战/ 密文/ 提供/ 给/ 敌手/ ,/ 若/ 敌手/ 能/ 正确/ 解密/ 密文/ ,/ 则/ 可/ 利用/ 它/ 来/ 解决/ SF/ 密钥/ 对/ SF/ 密文/ 的/ 判定/ 性/ 问题/ ./ 设计/ 的/ 困难/ 问题/ 是/ ,/ 在/ 密钥/ 由/ 正常/ 形态/ 改变/ 成/ SF/ 形态/ 的/ 过程/ 中/ ,/ 模拟器/ 要/ 为/ 任何/ 仿射/ 向量/ 空间/ 准备/ 密钥/ 并/ 生成/ 相应/ 的/ SF/ 密文/ ./ 本文/ 采用/ 有/ 支配/ 能力/ 的/ SF/ 功能/ 密钥/ 来/ 实现/ :/ 从/ 敌手/ 来看/ ,/ 这些/ 密钥/ 与/ 一般/ SF/ 密钥/ 是/ 同/ 分布/ 的/ ,/ 但/ 从/ 模拟器/ 来看/ ,/ 若/ 解密/ Page3/ 设/ 狌/ =/ (/ u1/ ,/ …/ ,/ un/ )/ ,/ 狏/ =/ (/ v1/ ,/ …/ ,/ vn/ )/ ∈/ Zn/ 一/ SF/ 密文/ ,/ 用/ 支配/ 密钥/ 可以/ 解密/ 成功/ ,/ 因此/ 在/ 敌手/ 询问/ 过程/ 中/ 不会/ 暴露/ 密钥/ 是/ 正常/ 还是/ SF/ 形态/ 的/ 信息/ ./ 本文/ 扩展/ SF/ 空间/ 到/ n/ 维/ (/ n/ / 2/ )/ ./ 由于/ 一个/ 密钥/ 的/ 泄露/ 量/ 是/ 有界/ 的/ ,/ 当/ 敌手/ 所/ 获得/ 的/ 泄露/ 量/ 不/ 超过/ 这个/ 量/ 时/ 不能/ 区分/ 正交/ 向量/ 与/ 随机/ 向量/ ./ n/ 越大/ ,/ 抗/ 泄露/ 的/ 容忍性/ 越好/ ./ 1.2/ 本文/ 组织/ 本文/ 第/ 2/ 节/ 介绍/ 所用/ 的/ 一些/ 基础知识/ ;/ 第/ 3/ 节/ 给出/ 抗/ 泄露/ 的/ 双态/ 仿射/ 函数/ 加密/ 框架/ 和/ 安全性/ 模型/ ;/ 第/ 4/ 节/ 给出/ 详细/ 的/ 构造/ 方案/ ;/ 方案/ 的/ 正确性/ 、/ 一致性/ 和/ 安全性/ 的/ 分析/ 和/ 证明/ 在/ 第/ 5/ 节/ 给出/ ;/ 第/ 6/ 节/ 讨论/ 本/ 方案/ 的/ 泄露/ 界/ ;/ 第/ 7/ 节对/ 本文/ 作出/ 小结/ ./ 2/ 预备/ 知识/ 2.1/ 基本概念/ 向量/ ,/ 〈/ 狌/ ,/ 狏/ 〉/ 是/ 向量/ 的/ 内积/ ./ 设/ g/ 是/ 群/ G/ 的/ 生成元/ ,/ 记/ g/ 狏/ 为/ 向量/ g/ 狏/ ·/ ·/ =/ (/ gv1/ ,/ …/ ,/ gvn/ )/ ∈/ Gn/ ./ 类似/ ,/ gr/ 狏/ ·/ ·/ =/ (/ grv1/ ,/ …/ ,/ grvn/ )/ ,/ g/ 〈/ 狌/ ,/ 狏/ 〉/ ·/ ·/ =/ g/ 狌/ / 狏/ =/ g/ ∑/ iGt/ ,/ e/ ^/ )/ 为/ 双线性/ 群/ 描述/ ,/ 满足/ 对/ 任意/ a/ ,/ b/ ∈/ ZN/ ,/ 存在/ 有效/ 可/ 计算/ 的/ 双线性/ 映射/ e/ ^/ :/ e/ ^/ (/ ga/ ,/ gb/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ ab/ ./ e/ ^/ n/ (/ g/ 狌/ ,/ g/ 狏/ )/ ·/ ·/ =/ ∏/ n/ 长度/ 为/ n/ +/ d/ 的/ 一组/ Gr/ 元素/ 的/ 随机/ 向量/ ,/ (/ gu1g/ ^/ 1/ ,/ gu2g/ ^/ 2/ ,/ …/ ,/ gung/ ^/ n/ ,/ gv1g/ ^/ n/ +/ 1/ ,/ …/ ,/ gvdg/ ^/ n/ +/ d/ )/ 简记/ 为/ (/ g/ 狌/ ,/ g/ 狏/ )/ / 犵/ ^/ [/ n/ +/ d/ ]/ ./ 记/ r/ ←/ S/ 为/ 从/ 集合/ S/ 中/ 随机/ 选取/ 一/ 元素/ r/ ./ negl/ (/ λ/ )/ 是/ 对/ λ/ 可/ 忽略/ 的/ 函数/ ,/ 即/ 对/ 任意/ z/ >/ 0/ ,/ 一/ 函数/ f/ (/ λ/ )/ :/ N/ →/ R/ 满足/ f/ (/ λ/ )/ / λ/ -/ z/ ./ 定义/ 1/ ./ 计算/ 不可/ 区分/ 性/ ./ 对/ 任一/ PPT/ 算法/ A/ ,/ 两个/ 概率/ 总体/ {/ X1/ }/ ,/ {/ Y2/ }/ 满足/ |/ Pr/ [/ A/ (/ 1/ λ/ ,/ X1/ )/ =/ 1/ ]/ -/ Pr/ [/ A/ (/ 1/ λ/ ,/ X2/ )/ =/ 1/ ]/ |/ / negl/ (/ λ/ )/ ,/ 则/ 称/ X1/ 和/ X2/ 对/ 算法/ 是/ 计算/ 不可/ 区分/ 的/ ./ 引理/ 1/ [/ 20/ ]/ ./ 设/ q/ 是/ 一/ 素数/ ,/ m/ ,/ l/ ,/ d/ ∈/ ZN/ 满足/ m/ / l/ / 2d/ ,/ 犡/ 1/ ,/ 犡/ 2/ 分别/ 是/ Zq/ 上/ 选取/ 的/ m/ ×/ l/ 和/ m/ ×/ d/ 的/ 随机/ 矩阵/ ./ T/ ←/ Rankd/ (/ 犣/ l/ ×/ df/ :/ 犣/ m/ ×/ dq/ →/ Ω/ 是/ 矩阵/ 犣/ m/ ×/ dDist/ (/ (/ 犡/ 1/ ,/ f/ (/ 犡/ 1T/ )/ )/ ,/ (/ 犡/ 1/ ,/ f/ (/ 犡/ 2/ )/ )/ )/ / negl/ (/ ·/ )/ ,/ 这里/ Dist/ (/ 犡/ 1/ ,/ 犡/ 2/ )/ 表示/ 两个/ 随机变量/ 犡/ 1/ 和/ 犡/ 2/ 的/ 统计/ 距离/ ./ 推论/ 1/ ./ 设/ m/ 是/ 大于/ 2/ 的/ 整数/ ,/ q/ 是/ 一大/ 素数/ ./ 设/ δ/ ,/ τ/ ←/ Zm/ 量/ 空间/ 的/ 正交/ 空间/ )/ ,/ 对/ 任一/ 函数/ f/ :/ ZmDist/ (/ (/ δ/ ,/ f/ (/ τ/ )/ )/ ,/ (/ δ/ ,/ f/ (/ τ/ )/ )/ )/ / negl/ (/ ·/ )/ ,/ 应用/ 引理/ 1/ ,/ 置/ d/ =/ 1/ ,/ l/ =/ m/ -/ 1/ ,/ 则/ 犡/ 1/ 对应/ 于/ 向量/ 的/ 正交/ 空间/ V/ ⊥/ (/ δ/ -/ )/ 的/ 基/ ,/ 犡/ 2/ 对应/ 于/ τ/ -/ ./ 本文/ 采用/ 正交/ 子群/ Gq/ 作为/ 这里/ 的/ 正交/ 空间/ ./ 我们/ 在/ 后面/ 分析/ 和/ 讨论/ 本文/ 方案/ 的/ 泄露/ 界/ / MSK/ =/ / SK/ =/ 2/ +/ (/ n/ -/ 1/ -/ 2c/ )/ log/ (/ q/ )/ ,/ 此时/ negl/ (/ ·/ )/ =/ q/ -/ c/ 是/ 可以/ 忽略/ 的/ ./ 定义/ 2/ ./ 仿射/ 空间/ ./ 设/ d/ ∈/ ZN/ ,/ 狓/ ∈/ Z/ κ/ Zd/ ×/ κ/ N/ ,/ 我们/ 定义/ 一/ 仿射/ 空间/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ / Z/ κ/ 称/ d/ (/ d/ / κ/ )/ 为/ 仿射/ 空间/ S/ 的/ 维度/ ,/ 记为/ d2Dim/ (/ S/ )/ =/ d/ ./ T/ ∈/ Zd1/ ×/ d2/ 引理/ 2/ ./ 若/ 两/ 仿射/ 空间/ S1/ =/ Aff/ (/ 犕/ 1/ ,/ 狓/ 1/ )/ 维/ δ/ 度为/ d1/ ,/ S2/ =/ Aff/ (/ 犕/ 2/ ,/ 狓/ 2/ )/ 维度/ 为/ d2/ ,/ 满足/ S2/ / S1/ ,/ 则/ 存在/ 一/ 有效/ 可/ 求解/ 的/ 矩阵/ 和/ 向量/ 狕/ ∈/ Zd1/ 狓/ 1/ +/ 犕/ / 1/ 狕/ ./ 引理/ 3/ ./ 若/ 两/ 仿射/ 空间/ S1/ =/ Aff/ (/ 犕/ 1/ ,/ 狓/ 1/ )/ 维度/ 为/ d1/ ,/ S2/ =/ Aff/ (/ 犕/ 2/ ,/ 狓/ 2/ )/ 维度/ 为/ d2/ ,/ 满足/ S1/ ∩/ S2/ ≠/ / ,/ 则/ 存在/ 一/ 有效/ 可/ 求解/ 的/ 矩阵/ 犜/ 1/ ,/ 犜/ 2/ 和/ 向量/ 狕/ 1/ ,/ 狕/ 2/ ,/ 满足/ 犕/ 1/ 犜/ 1/ =/ 犕/ 2/ 犜/ 2/ ,/ 狓/ 1/ -/ 狓/ 2/ =/ 犕/ / 2/ 狕/ 2/ -/ 犕/ / 1/ 狕/ 1/ ./ 证明/ ./ 设/ S1/ ∩/ S2/ =/ S/ ,/ S/ / S1/ ,/ S/ / S2/ ,/ 根据/ 引理/ 2/ ,/ 犕/ =/ 犕/ 1/ 犜/ 1/ ,/ 狓/ =/ 狓/ 1/ +/ 犕/ / 1/ 狕/ 1/ ,/ 犕/ =/ 犕/ 2/ 犜/ 2/ ,/ 狓/ =/ 狓/ 2/ +/ 犕/ / 2/ 狕/ 2/ ,/ 得证/ ./ 2.2/ 合数/ 阶/ 双线性/ 群/ 一个/ 合数/ 阶/ 的/ 双线性/ 群/ 描述/ 包括/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ )/ ,/ 阶/ N/ 是/ 多个/ 不/ 等/ 的/ 素数/ 之积/ ./ 设/ N/ =/ pqr/ ,/ 这里/ p/ 、/ q/ 、/ r/ 是/ 不/ 相等/ 的/ 素数/ ./ 除/ 满足/ 双线性/ 群/ 的/ 一般/ 性质/ 外/ ,/ 群/ G/ 包含/ 阶/ 分别/ 是/ p/ 、/ q/ 和/ r/ 的/ 子群/ Gp/ 、/ Gq/ 和/ Gr/ ,/ 设/ 其子/ 群/ 生成元/ 分别/ 是/ g/ 、/ g/ -/ 和/ g/ ^/ ,/ 则/ G/ 中/ 的/ 任一/ 元素/ 都/ 可以/ 表示/ 成/ ga1g/ -/ a2g/ ^/ a3/ 的/ 形式/ ,/ 这里/ a1/ ,/ a2/ ,/ a3/ ∈/ ZN/ ./ 合数/ 阶/ 双线性/ 群/ 具有/ 如下/ 特殊/ 性质/ ./ 性质/ 1/ (/ 子群/ 生成元/ )/ ./ 设/ h/ 是/ G/ 的/ 生成元/ ,/ 则/ hqr/ 是/ Gp/ 的/ 生成元/ ,/ hpr/ 是/ Gq/ 的/ 生成元/ ,/ hpq/ 是/ GrM2/ =/ M1T/ 的/ 生成元/ ./ 性质/ 2/ (/ 子群/ 正交/ 性/ )/ ./ 设/ hp/ ∈/ Gp/ ,/ hq/ ∈/ Gq/ ,/ hr/ ∈/ Gr/ ,/ 对/ 所有/ a1/ ,/ a2/ ,/ a3/ ∈/ ZN/ ,/ e/ ^/ (/ ha1p/ ,/ ha2q/ )/ =/ 1/ ,/ e/ ^/ (/ ha1p/ ,/ ha3r/ )/ =/ 1/ ,/ e/ ^/ (/ ha2q/ ,/ ha3r/ )/ =/ 1.2/ ./ 3/ 数学/ 困难/ 假设/ 为/ 证明/ 所/ 设计方案/ 的/ 安全性/ ,/ 本文/ 使用/ 如下/ 基于/ 合数/ 阶群/ 的/ (/ 子/ )/ 群/ 判定/ 问题/ ,/ 该/ 假设/ 在/ 文献/ [/ 14/ ,/ 16/ ,/ 18/ ]/ 中/ 已作/ 分析/ ./ Page4/ 假设/ 1/ ./ 设/ (/ N/ ,/ G/ =/ Gp/ ×/ Gq/ ×/ Gr/ ,/ Gt/ ,/ e/ ^/ )/ 是/ 阶/ N/ =/ pqr/ 的/ 双线性/ 群/ ,/ σ/ ,/ τ/ ←/ ZN/ ,/ g/ ∈/ Gp/ ,/ g/ -/ ∈/ Gq/ ,/ g/ ^/ ∈/ Gr/ ./ 给定/ 元组/ Θ/ =/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ ;/ g/ ,/ g/ ^/ ,/ T1/ =/ g/ σ/ ∈/ Gp/ ,/ T2/ =/ g/ σ/ g/ -/ τ/ ∈/ Gpq/ )/ ,/ 区分/ T1/ 和/ T2/ 是/ 个/ 困难/ 问题/ ./ 假设/ 2/ ./ 设/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ )/ 是/ 阶/ N/ =/ pqr/ 的/ 双线性/ 群/ ,/ σ/ ,/ / ,/ τ/ ←/ ZN/ ,/ g/ ∈/ Gp/ ,/ g/ -/ ∈/ Gq/ ,/ g/ ^/ ∈/ Gr/ ./ 给定/ 元组/ Θ/ =/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ ;/ g/ ,/ g/ ^/ ,/ X1/ ∈/ Gpq/ ,/ X2/ ∈/ Gqr/ ,/ T1/ =/ g/ σ/ g/ ^/ / ∈/ Gpr/ ,/ T2/ =/ g/ σ/ g/ -/ τ/ g/ ^/ / ∈/ G/ )/ ,/ 区分/ T1/ 和/ T2/ 是/ 个/ 困难/ 问题/ ./ 假设/ 3/ ./ 设/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ )/ 是/ 阶/ N/ =/ pqr/ 的/ 双线性/ 群/ ,/ α/ ,/ s/ ,/ t/ ,/ t/ ←/ ZN/ ,/ g/ ∈/ Gp/ ,/ g/ -/ ∈/ Gq/ ,/ g/ ^/ ∈/ Gr/ ./ 给定/ 元组/ Θ/ =/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ ;/ g/ ,/ g/ -/ ,/ g/ ^/ ,/ X1/ ∈/ g/ α/ g/ -/ t/ ,/ X2/ ∈/ gsg/ -/ t/ ,/ T1/ =/ e/ ^/ (/ g/ α/ ,/ gs/ )/ ,/ T2/ ←/ Gt/ )/ ,/ 区分/ T1/ 和/ T2/ 是/ 个/ 困难/ 问题/ ./ 3/ 方案/ 模型/ 3.1/ 双态/ 仿射/ 加密/ 模型/ 一个双/ 态/ 仿射/ 函数/ 加密/ (/ DASE/ )/ 由/ 5/ 个/ PPT/ 算法/ 组成/ :/ ∏/ =/ (/ Init/ ,/ KeyGen/ ,/ Dele/ ,/ Encr/ ,/ Decr/ )/ ./ Init/ 和/ KeyGen/ 算法/ 由/ 可信/ 第三方/ PKG/ 执行/ ,/ Init/ 算法/ 生成/ 系统/ 公钥/ 和/ 主/ 密钥/ ,/ KeyGen/ 算法/ 为/ 用户/ 持有/ 的/ 仿射/ 空间/ 生成/ 密钥/ ,/ 同时/ 也/ 可以/ 更新/ 主/ 密钥/ ;/ Dele/ 算法/ 由/ 一/ 仿射/ 空间/ 钥/ 的/ 持有者/ 为/ 其子/ 空间/ 生成/ 委托/ 密钥/ ,/ 同时/ 也/ 可以/ 更新/ 自己/ 的/ 密钥/ ;/ Encr/ 和/ Decr/ 分别/ 由/ 加密/ 者/ 和/ 解密/ 者/ 执行/ 消息/ 的/ 加密/ 和/ 解密/ 操作/ ./ 为/ 标记/ 用户/ 密钥/ 和/ 主/ 密钥/ 的/ 泄露/ 和/ 更新/ ,/ 我们/ 定义/ 两个/ 特殊/ 的/ 空间/ :/ 空/ 仿射/ 空间/ / 和/ 超/ 仿射/ 空间/ Λ/ ./ (/ 1/ )/ Init/ (/ 1/ λ/ ,/ / MSK/ ,/ / SK/ ,/ κ/ ,/ n/ )/ ./ 输入/ 系统安全/ 参数/ 1/ λ/ 、/ 主/ 密钥/ 泄露/ 界/ / MSK/ 、/ 用户/ 密钥/ 泄露/ 界/ / SK/ 、/ 抗/ 泄露/ 容忍度/ n/ 和/ 仿射/ 空间/ 的/ 维度/ κ/ ,/ 初始化/ 算法/ 生成/ 系统/ 公钥/ 和/ 主/ 密钥/ ./ (/ 2/ )/ KeyGen/ (/ MPK/ ,/ MSK/ ,/ S/ )/ ./ 密钥/ 生成/ 算法/ 输入/ 系统/ 公钥/ 和/ 主/ 密钥/ ,/ 以及/ 一/ 仿射/ 空间/ S/ ,/ 若/ S/ =/ Λ/ 则/ 更新/ 主/ 密钥/ ,/ 否则/ 输出/ S/ 的/ 密钥/ SKS/ ./ (/ 3/ )/ Dele/ (/ MPK/ ,/ S1/ ,/ SK1/ ,/ S2/ )/ ./ 密钥/ 委托/ 算法/ 输入/ 系统/ 公钥/ 、/ 仿射/ 空间/ S1/ 及其/ 密钥/ SKS1/ ,/ 以及/ S1/ 的/ 仿射/ 子/ 空间/ S2/ ,/ 若/ S2/ =/ / 则/ 更新/ S1/ 的/ 密钥/ ,/ 否则/ 输出/ S2/ 的/ 密钥/ SKS2/ ./ (/ 4/ )/ Encr/ (/ MPK/ ,/ S/ ,/ m/ )/ ./ 加密算法/ 输入/ 系统/ 公钥/ 、/ 接收者/ 仿射/ 空间/ S/ 以及/ 消息/ m/ ,/ 输出/ 加密/ 的/ 密文/ CTS/ ./ (/ 5/ )/ Decr/ (/ MPK/ ,/ S/ ,/ SKS/ ,/ S/ ,/ CTS/ )/ ./ 解密/ 算法/ 输入/ 系统/ 公钥/ 、/ 加密/ 策略/ 空间/ S/ 及/ 密文/ CTS/ 、/ 解密/ 角色/ 空间/ S/ 及/ 密钥/ SKS/ ,/ 输出/ 消息/ m/ ./ 正确性/ 与/ 一致性/ ./ Q/ 、/ M/ 和/ C/ 分别/ 是/ 仿射/ 向量/ 空间/ 、/ 明文/ 空间/ 和/ 密文/ 空间/ ./ 对/ 所有/ 正确/ 生成/ 的/ (/ MPK/ ,/ MSK/ )/ 、/ S/ 仿射/ 空间/ 密钥/ SKS/ 、/ S/ 接收者/ 角色/ 的/ 消息/ m/ 密文/ CTS/ ∈/ C/ ./ f/ (/ ·/ )/ 和/ f/ (/ ·/ )/ 是/ 任意/ 的/ 用户/ 密钥/ 和/ 主/ 密钥/ 的/ 泄露/ 函数/ ,/ 满足/ ∑/ i/ / SK/ ,/ ∑/ i/ 密/ CTS/ 得到/ m/ =/ m/ ./ 即/ (/ MPK/ ,/ MSK/ )/ ←/ Init/ (/ 1/ λ/ ,/ / MSK/ ,/ / SK/ ,/ κ/ ,/ n/ )/ 熿/ S1/ ,/ S2/ ,/ S/ ∈/ Q/ ,/ S2/ ∩/ S/ ≠/ / ,/ m/ ∈/ M/ ∑/ iCTS/ ←/ Encr/ (/ MPK/ ,/ S/ ,/ m/ )/ m/ ←/ Decr/ (/ MPK/ ,/ S2/ ,/ Dele/ (/ MPK/ ,/ S1/ ,/ KeyGen/ (/ MPK/ ,/ MSK/ ,/ S1/ )/ ,/ S2/ )/ ,/ S/ ,/ CTS/ )/ m/ =/ 燀/ Pr/ 挑战者/ 生成/ 并/ 存储/ Sj/ 的/ 密钥/ SKSj/ ./ (/ 2/ )/ 泄露/ 询问/ (/ OLeak/ )/ ./ 敌手/ 提供/ 一/ 仿射/ 空间/ Sj/ 及/ 概率/ 多项式/ 函数/ fi/ :/ SK/ →/ {/ 0/ ,/ 1/ }/ / ,/ 挑战者/ 用/ fi/ (/ SKSj/ )/ 作/ 回答/ (/ 泄露/ 总长度/ ∑/ i/ 请求/ 一个/ 主/ 密钥/ 泄露/ 的/ 多项式/ 时间/ 函数/ fi/ (/ MSK/ )/ 询问/ ./ (/ 3/ )/ 密钥/ 询问/ (/ ORevl/ )/ ./ 敌手/ 提供/ 子/ 空间/ Sj/ ,/ 挑战者/ 以/ 完整/ 的/ 密钥/ SKSj/ 作为/ 回答/ ./ (/ 4/ )/ 委托/ 钥/ 询问/ (/ ODele/ )/ ./ 敌手/ 提供/ 两/ 空间/ S1/ ,/ S2/ ,/ 挑战者/ 首先/ 查询/ OCrea/ 的/ 队列/ 是否/ 有/ SKS1/ ,/ 如果/ 不/ 存在/ 则/ 调用/ OCrea/ 为/ SKS1/ 生成/ 密钥/ ,/ 然后/ 调用/ Dele/ 算法/ 生成/ 并/ 回答/ 委托/ 钥/ SKS2/ ,/ 同时/ 把/ SKS2/ 存储/ 于/ OCrea/ 密钥/ 队列/ 中/ ./ (/ 5/ )/ 解密/ 询问/ (/ ODecr/ )/ ./ 输入/ 一/ 密文/ CT/ 和/ 一/ 仿射/ 空间/ S/ ,/ 挑战者/ 生成/ 仿射/ 空间/ 密钥/ SKS/ ,/ 输出/ 消息/ m/ ./ 3/ ./ 挑战/ ./ 敌手/ 随机/ 选择/ 两/ 消息/ m0/ ,/ m1/ ∈/ M/ 以及/ 挑战/ 子/ 空间/ S/ / ,/ 要求/ S/ / 不/ 在/ 密钥/ 询问/ ORevl/ 的/ 队列/ 中/ ,/ 也/ 不是/ 已/ 询问/ 过/ 的/ 空间/ 的/ 仿射/ 子/ 空间/ ,/ 且/ 在/ 泄露/ 询问/ OLeak/ 获得/ 的/ 比特/ 量/ 小于/ / SK/ ./ 接下来/ 挑战者/ 随机/ 选择/ β/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 计算/ CTS/ / ←/ Encr/ (/ MPK/ ,/ S/ / ,/ m/ β/ )/ ,/ 将/ 密文/ CTS/ / 发送给/ 敌手/ A/ ./ negl/ (/ λ/ )/ ./ 3.2/ 安全性/ 模型/ 如下/ 的/ 游戏/ 框架/ ExpLR/ 抗/ 泄露/ 安全/ 的/ 双态/ 仿射/ 加密/ 的/ 安全/ 模型/ 定义/ 为/ 1/ ./ 系统/ 参数/ ./ 挑战者/ C/ 运行/ Init/ 算法/ 生成/ 系统/ 参数/ MPK/ 和/ 主/ 密钥/ MSK/ ,/ 并/ 把/ MPK/ 发送给/ 敌手/ A/ ./ 2/ ./ 询问/ 1/ ./ 本/ 阶段/ A/ 自/ 适应/ 地向/ 挑战者/ 进行/ 下列/ 询问/ :/ (/ 1/ )/ 创建/ 密钥/ 询问/ (/ OCrea/ )/ ./ 敌手/ 提供/ 一系列/ 子/ 空间/ Sj/ ,/ Page54/ ./ 询问/ 2/ ./ 类似/ 询问/ 1/ ,/ 但/ 要/ 满足/ :/ 不能/ 对主/ 密钥/ MSK/ 或/ 挑战/ S/ / 的/ 密钥/ 作/ OCrea/ 和/ OLeak/ 询问/ 5/ ./ 输出/ ./ 敌手/ 输出/ β/ ,/ 若/ β/ =/ β/ ,/ 敌手/ 赢得/ 该游戏/ ./ 对/ 双态/ 仿射/ 加密/ 方案/ DASE/ 的/ 安全/ 游戏/ 中/ ,/ OCrea/ 、/ OLeak/ 、/ ORevl/ 、/ ODele/ 和/ ODecr/ 分别/ 是/ 创建/ 密钥/ 谕言机/ 、/ 泄露/ 谕言机/ 、/ 密钥/ 询问/ 谕言机/ 、/ 委托/ 谕言机/ 和/ 解密/ 谕言机/ ,/ 泄露/ 函数/ f/ :/ SK/ →/ {/ 0/ ,/ 1/ }/ / ,/ 敌手/ 在/ ExpLR/ ∏/ ,/ A/ (/ λ/ )/ 中/ 的/ 优势/ 定义/ 为/ 定义/ 3/ ./ 抗/ 泄露/ 语义/ 安全性/ ./ 对任/ 一个/ 多项式/ 时间/ 内/ 的/ 敌手/ A/ 在/ ExpLR/ 间/ 多次/ 用户/ 密钥/ 泄露/ 最/ 多/ 获得/ / SKbit/ 的/ 密钥/ 信息/ (/ ∑/ / j/ / / SK/ )/ ,/ 最/ 多/ 获得/ / MSK/ 的/ 主/ 密钥/ 信息/ ,/ 敌手/ 所/ 获得/ 的/ 优势/ AdvLR/ 态/ 仿射/ 函数/ 加密/ 是/ (/ / MSK/ ,/ / SK/ )/ -/ LR/ -/ CCA/ 安全/ 的/ ./ 若/ 在/ ExpLRODecr/ ,/ 则/ 称/ 该/ 方案/ 是/ (/ / MSK/ ,/ / SK/ )/ -/ LR/ -/ CPA/ 安全/ 的/ ./ 本文/ 重点/ 考虑/ 方案/ 的/ 密钥/ 抗/ 泄露/ 性/ ,/ 对/ 消息/ 的/ 保密性/ 方面/ 所/ 设计/ 的/ 方案/ 达到/ CPA/ 安全/ ./ 可以/ 利用/ 转换/ 工具/ 使/ CPA/ 安全/ 的/ 方案/ 达到/ CCA/ 安全/ ./ 一般/ 的/ 抗/ 泄露/ 安全/ 只/ 针对/ 用户/ 密钥/ 泄露/ ,/ 本/ 方案/ 在/ 此基础/ 上/ 实现/ 抗主/ 密钥/ 泄露/ 和/ 连续/ 泄露/ ./ 定义/ 4/ ./ 抗主/ 密钥/ 泄露/ ./ 当/ 系统/ 主/ 密钥/ 在/ 泄露/ 量/ 不/ 超过/ / MSK/ 时/ ,/ 系统/ 仍/ 是/ 安全/ 的/ ,/ 称该/ 方案/ 抗主/ 密钥/ 泄露/ 安全/ 的/ ./ / MSK/ 称/ 为主/ 密钥/ 泄露/ 界/ ./ 定义/ 5/ ./ 抗/ 连续/ 泄露/ ./ 若/ 一个/ 密码/ 方案/ 具有/ 自身/ 密钥/ 更新/ 的/ 能力/ ,/ 产生/ 一个/ 相同/ 分布/ 的/ 重新/ 随机化/ 的/ 密钥/ ,/ 称该/ 方案/ 是/ 抗/ 连续/ 泄露/ 的/ ./ 实际/ 中/ ,/ 攻击者/ 可以/ 对/ 同一/ 用户/ 的/ 密钥/ 进行/ 多次/ 的/ 密钥/ 泄露/ 询问/ ,/ 因此/ 通过/ 多次/ 的/ 泄露/ 询问/ 获得/ 超出/ 泄露/ 界/ 的/ 密钥/ 信息量/ ./ 但/ 若/ 密钥/ 可以/ 被/ 更新/ ,/ 则/ 攻击者/ 以前/ 的/ 泄露/ 询问/ 不起作用/ ,/ 需要/ 重新/ 开始/ 对/ 新/ 的/ 密钥/ 进行/ 泄露/ 询问/ ./ 特别/ 地/ ,/ 每当/ 密钥/ 被/ 使用/ (/ 或/ 一定/ 周期/ )/ 就/ 进行/ 一次/ 密钥/ 更新/ ,/ 这样/ 攻击者/ 无法/ 多次/ 获得/ 同一/ 仿射/ 空间/ 的/ 相同/ 密钥/ 上/ 的/ 泄露/ 信息/ ,/ 此/ 加密/ 方案/ 是/ 完全/ 抗/ 连续/ 泄露/ 的/ ./ 4/ 方案/ 构造/ 本/ 方案/ 中/ ,/ 一个/ 仿射/ 空间/ S/ ·/ ·/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ 的/ 密钥/ 形式/ 为/ SKS/ =/ (/ ku/ ,/ ka/ ,/ kr/ ,/ kw/ )/ =/ (/ g/ 狌/ ,/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ )/ / g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ ,/ 其中/ ku/ ∈/ Gn/ ,/ ka/ ,/ kr/ ∈/ G/ ,/ kw/ ∈/ Gd/ ,/ g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ ∈/ Gn/ +/ d/ +/ 2r/ ./ 这里/ d/ =/ Dim/ (/ S/ )/ 是/ 仿射/ 空间/ 的/ 维度/ ,/ κ/ 是/ 最大/ 仿射/ 空间/ 的/ 维度/ ./ 系统/ 中/ n/ 是/ 大于/ 等于/ 2/ 的/ 整数/ ,/ 它/ 控制/ 密钥/ 泄露/ 的/ 容忍度/ ./ n/ 越大/ ,/ 系统/ 的/ 抗/ 泄露/ 容忍性/ 越/ 好/ ,/ n/ 越小/ ,/ 系统/ 的/ 密文/ 和/ 密钥/ 越短/ ./ 系统/ 初始化/ 参数/ 中/ ,/ 预先/ 设置/ 主/ 密钥/ 的/ 泄露/ 界/ / MSK/ 和/ 用户/ 密钥/ 的/ 泄露/ 界/ / SK/ ,/ 并且/ 要求/ 用户/ 在/ 自定义/ 泄露/ 函数/ f/ (/ ·/ )/ 的/ 获得/ 密钥/ 的/ 总/ 输出/ 长度/ 不能/ 超过/ 这个/ 界/ ./ (/ 1/ )/ Init/ (/ 1/ λ/ ,/ / MSK/ ,/ / SK/ ,/ κ/ ,/ n/ )/ ./ PKG/ 首先/ 调用/ 双线性/ 群/ 生成器/ 生成/ (/ N/ =/ pqr/ ,/ G/ =/ Gp/ ×/ Gq/ ×/ Gr/ ,/ Gt/ ,/ e/ ^/ )/ ,/ 然后/ 随机/ 选取/ α/ ∈/ ZN/ ,/ 狌/ ,/ 狏/ ∈/ Znga/ ∈/ Gp/ ,/ g/ -/ ∈/ Gq/ ,/ g/ ^/ ∈/ Gr/ ./ 设置/ 并/ 公开/ 系统/ 公钥/ MPK/ =/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ;/ / MSK/ ,/ / SK/ ,/ g/ ,/ g/ ^/ ,/ ga/ ,/ g/ 狏/ ,/ g/ 狑/ ,/ e/ (/ g/ ,/ g/ )/ α/ )/ ,/ 同时/ 保存/ 主/ 密钥/ MSK/ =/ (/ 珔/ ku/ ,/ 珔/ ka/ ,/ 珔/ kr/ ,/ 珔/ kw/ )/ =/ (/ g/ 狌/ ,/ g/ α/ +/ ra/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 狑/ )/ / 犵/ ^/ [/ n/ +/ κ/ +/ 2/ ]/ ./ 这里/ 犵/ ^/ [/ n/ +/ κ/ +/ 2/ ]/ 是/ Gr/ 上/ 的/ 一组/ 随机/ n/ +/ κ/ +/ 2/ 维/ 向量/ ,/ 可以/ 先/ 随机/ 选择/ η/ ∈/ Zn/ 算/ g/ ^/ η/ 得到/ ./ (/ 2/ )/ KeyGen/ (/ MPK/ ,/ MSK/ ,/ S/ )/ ./ 第/ 1/ 步/ ,/ PKG/ 为/ 仿射/ 空间/ S/ ·/ ·/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ 生成/ 导入/ 密钥/ SKS/ :/ 设/ d/ =/ Dim/ (/ S/ )/ ,/ SKS/ =/ (/ ^/ 犽/ u/ ,/ ^/ ka/ ,/ ^/ kr/ ,/ ^/ 犽/ w/ )/ =/ (/ 珔/ 犽/ u/ ,/ 珔/ ka/ ·/ ∏/ d/ =/ (/ g/ 狌/ ,/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ )/ / g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ 这里/ ,/ 设/ 仿射/ 矩阵/ 犕/ =/ (/ 犡/ 1/ ,/ …/ ,/ 犡/ d/ )/ / ∈/ Zd/ ×/ κ/ ψ/ (/ g/ 犕/ / ,/ 珔/ kw/ )/ ·/ ·/ =/ (/ g/ 〈/ 犡/ 1/ ,/ r/ 狑/ 〉/ ,/ …/ ,/ g/ 〈/ 犡/ d/ ,/ r/ 狑/ 〉/ )/ ./ 第/ 2/ 步/ ,/ 对/ SKS/ 进行/ 随机化/ 处理/ :/ 随机/ 选择/ r/ ∈/ ZN/ ,/ 狌/ ∈/ ZnSKS/ =/ SKS/ / 〈/ g/ 狌/ ,/ gr/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ ·/ g/ 〈/ -/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ 〉/ / g/ ^/ η/ =/ 〈/ g/ 狌/ +/ 狌/ ,/ g/ α/ +/ (/ r/ +/ r/ )/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ +/ 狌/ ,/ 狏/ 〉/ ,/ gr/ +/ r/ ,/ g/ (/ r/ +/ r/ )/ 犕/ / 狑/ 〉/ / g/ ^/ η/ +/ [/ n/ +/ d/ +/ 2/ ]/ 由于/ r/ ,/ r/ ,/ 狌/ ,/ 狌/ 是/ ZN/ 上/ 随机/ 选取/ 的/ ,/ 因此/ 随机化/ 前后/ 的/ 密钥/ 是/ 同/ 分布/ 的/ ./ 值得注意/ 的/ 是/ ,/ 当为/ 一个/ 特殊/ 的/ κ/ 维/ 的/ 仿射/ 空间/ Λ/ :/ S/ Λ/ =/ Aff/ (/ 犈/ ,/ 0/ )/ 生成/ 密钥/ 时/ (/ 犈/ 是/ 单位/ 阵/ ,/ 0/ 是/ 零/ 向量/ )/ ,/ 本质/ 上/ 是/ 在/ 更新/ 主/ 密钥/ MSK/ ./ 此时/ ,/ 〈/ 0/ ,/ 狑/ 〉/ =/ 0/ ,/ gr/ 犈/ / 狑/ =/ gr/ 狑/ ,/ 即/ 经过/ 密钥/ 导入/ 和/ 随机化/ 之后/ ,/ 密钥/ 结构/ 没有/ 变化/ ,/ 只是/ 用/ 新/ 随机数/ 代替/ 原来/ 的/ r/ 和/ 狌/ ./ Page6/ (/ 3/ )/ Dele/ (/ MPK/ ,/ S1/ ,/ SK1/ ,/ S2/ )/ ./ S2/ =/ Aff/ (/ 犕/ 2/ ,/ 狓/ 2/ )/ 是/ S1/ =/ Aff/ (/ 犕/ 1/ ,/ 狓/ 1/ )/ 的/ 仿射/ 子/ 空间/ ,/ 即/ S2/ / S1/ ,/ 设/ d1/ =/ Dim/ (/ S1/ )/ ,/ d2/ =/ Dim/ (/ S2/ )/ ,/ 根据/ 引理/ 2/ ,/ 存在/ 一/ 有效/ 的/ 计算/ 求出/ T/ 和/ 狕/ 满足/ 犕/ 2/ =/ 犕/ 1T/ ,/ 狓/ 2/ =/ 狓/ 1/ +/ 犕/ / 1/ 狕/ ./ ①/ 若/ S2/ =/ S1/ ,/ 则/ 系统/ 更新/ 委托/ 者/ 自身/ 密钥/ SKS1/ :/ 采用/ KeyGen/ 中/ 的/ 更新/ 算法/ (/ 5/ )/ ,/ 可以/ 获得/ 与/ 原有/ 密钥/ 同/ 分布/ 的/ 新/ 密钥/ ./ ②/ 若/ S2/ / S1/ ,/ S1/ 为/ S2/ 生成/ 委托/ 密钥/ (/ 设/ S1/ 的/ 密钥/ 是/ SKS1/ =/ (/ 犽/ u/ ,/ 犽/ a/ ,/ 犽/ r/ ,/ 犽/ w/ )/ )/ :/ 首先/ 生成/ 导入/ 密钥/ SKS2/ =/ (/ ^/ 犽/ u/ ,/ ^/ ka/ ,/ ^/ kr/ ,/ ^/ 犽/ w/ )/ =/ (/ 犽/ u/ ,/ kagr/ 犕/ / 1/ 狕/ 狑/ ,/ kr/ ,/ ψ/ (/ g/ 犕/ / 1/ ,/ 珔/ kw/ )/ )/ =/ (/ g/ 狌/ ,/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ 2/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 2/ 狑/ 〉/ / g/ ^/ [/ n/ +/ d2/ +/ 2/ ]/ ./ 第/ 2/ 步/ ,/ 对/ SKS2/ 再/ 随机化/ ,/ 获得/ 与/ SKS2/ 同/ 分布/ 的/ 密钥/ SKS2/ :/ 随机/ 选择/ r/ ∈/ ZN/ ,/ 狌/ ∈/ ZnGn/ +/ d2/ +/ 2r/ ,/ 计算/ SKS2/ =/ SKS2/ / 〈/ g/ 狌/ ,/ gr/ (/ a/ +/ 〈/ 狓/ 2/ ,/ 狑/ 〉/ )/ ·/ g/ 〈/ -/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 2/ 狑/ 〉/ / g/ ^/ η/ =/ 〈/ g/ 狌/ +/ 狌/ ,/ g/ α/ +/ (/ r/ +/ r/ )/ (/ a/ +/ 〈/ 狓/ 2/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ +/ 狌/ ,/ 狏/ 〉/ ,/ gr/ +/ r/ ,/ g/ (/ r/ +/ r/ )/ 犕/ / 2/ 狑/ 〉/ / g/ ^/ η/ +/ [/ n/ +/ d2/ +/ 2/ ]/ (/ 4/ )/ Encr/ (/ MPK/ ,/ S/ ,/ m/ )/ 给定/ 一/ 消息/ m/ ∈/ Gt/ 和/ 一/ 接收者/ 仿射/ 空间/ 角色/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ ,/ 本/ 算法/ 随机/ 选取/ s/ ∈/ ZN/ ,/ 生成/ 密文/ CTS/ ./ CTS/ =/ (/ cm/ ,/ 犮/ v/ ,/ cs/ ,/ ca/ ,/ 犮/ w/ )/ 这里/ d/ =/ Dim/ (/ S/ ∩/ S/ )/ ./ 输出/ 消息/ m/ ./ =/ (/ m/ ·/ e/ ^/ (/ g/ ,/ g/ )/ s/ α/ ,/ gs/ 狏/ ,/ gs/ ,/ g/ -/ s/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ ,/ gs/ 犕/ / 狑/ )/ 特别/ 地/ ,/ 当/ 接收/ 角色/ 空间/ S/ 缩小/ 为/ 仿射/ 空间/ 的/ 一个点/ 向量/ 狓/ 时/ ,/ 犕/ =/ / ,/ 犮/ 狑/ =/ 1G/ ./ 此时/ 加密/ 方案/ 简化/ 为/ 一般/ 的/ 空间/ 加密/ 方案/ [/ 9/ -/ 10/ ]/ ./ (/ 5/ )/ Decr/ (/ MPK/ ,/ S/ ,/ SKS/ ,/ S/ ,/ CTS/ )/ ./ 若/ 解密/ 者/ 的/ 角色/ 空间/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ 与/ 加密/ 策略/ 空间/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ 的/ 交不为/ 空/ (/ S/ ∩/ S/ ≠/ / )/ ,/ 则/ 存在/ 一/ 仿射/ 空间/ 点/ 向量/ 狓/ / ∈/ S/ ∩/ S/ ./ 根据/ 线性代数/ 性质/ 及/ 引理/ 3/ ,/ 可以/ 有效/ 地/ 找出/ 向量/ 狕/ ,/ 狕/ ′/ 满足/ :/ 狓/ / =/ 狓/ +/ 犕/ / 狕/ =/ 狓/ +/ (/ 犕/ )/ / 狕/ ′/ ./ ca/ ,/ 犮/ w/ )/ ,/ 计算/ 解析/ SKS/ =/ (/ 犽/ u/ ,/ ka/ ,/ kr/ ,/ 犽/ w/ )/ ,/ CTS/ =/ (/ cm/ ,/ 犮/ v/ ,/ cs/ ,/ k/ δ/ =/ ka/ ·/ ∏/ d5/ 方案/ 正性/ 与/ 安全性/ 5.1/ 正确性/ 5.1/ ./ 1/ 解密/ 一致性/ 密文/ CTS/ 中/ ,/ cm/ ∈/ Gt/ ,/ 犮/ v/ ,/ ca/ ,/ cs/ ,/ 犮/ w/ ∈/ Gp/ ,/ 而/ 密钥/ SKS/ ∈/ Gpr/ ,/ 根据/ 子群/ 的/ 正交/ 性/ 、/ 密钥/ 与/ 密文/ 的/ 双线性/ 运算/ (/ cm/ 除外/ )/ ,/ 密钥/ 的/ Gr/ 子群/ 元素/ g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ 将/ 被/ 约/ 除/ ./ 因此/ 解密/ 一致性/ 只/ 需/ 考虑/ 子群/ Gp/ 中/ 元素/ 的/ 计算/ ./ 根据/ 引理/ 3/ ,/ 狓/ / =/ 狓/ +/ 犕/ / 狕/ =/ 狓/ +/ (/ 犕/ )/ / 狕/ ′/ ./ k/ δ/ =/ ka/ ·/ ∏/ d/ 同理/ ,/ c/ δ/ =/ g/ -/ s/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ ,/ e/ ^/ (/ 犽/ u/ ,/ 犮/ v/ )/ =/ e/ ^/ (/ g/ 狌/ ,/ gs/ 狏/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ s/ 〈/ 狌/ ,/ 狏/ 〉/ e/ ^/ (/ k/ δ/ ,/ cr/ )/ =/ e/ ^/ (/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gs/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ s/ α/ e/ ^/ (/ g/ ,/ g/ )/ rs/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ e/ ^/ (/ g/ ,/ g/ )/ -/ s/ 〈/ 狌/ ,/ 狏/ 〉/ e/ ^/ (/ ks/ ,/ c/ δ/ )/ =/ e/ ^/ (/ gr/ ,/ g/ -/ s/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ -/ rs/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ e/ ^/ (/ 犽/ u/ ,/ 犮/ v/ )/ e/ ^/ (/ k/ δ/ ,/ cr/ )/ e/ ^/ (/ ks/ ,/ c/ δ/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ s/ α/ 使用/ 上述/ 盲化/ 因子/ e/ ^/ (/ g/ ,/ g/ )/ s/ α/ 可以/ 从/ cm/ 中/ 正确/ 提取/ 消息/ m/ ./ 5.1/ ./ 2/ 密钥/ 生成/ 正确性/ 在/ KeyGen/ 中/ ,/ PKG/ 利用/ 主/ 密钥/ MSK/ 对/ 任一/ 仿射/ 空间/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ 生成/ 密钥/ SKS/ =/ (/ 犽/ u/ ,/ ka/ ,/ kr/ ,/ 犽/ w/ )/ ∈/ Gn/ +/ d/ +/ 2/ 们/ 主要/ 验证/ ka/ 和/ 犽/ w/ 的/ 正确性/ ./ ^/ ka/ =/ 珔/ ka/ ·/ ∏/ d/ ^/ 犽/ w/ =/ ψ/ (/ gM/ / ,/ 珔/ kw/ )/ =/ (/ g/ 〈/ 犡/ 1/ ,/ r/ 狑/ 〉/ ,/ …/ ,/ g/ 〈/ 犡/ d/ ,/ r/ 狑/ 〉/ )/ / g/ ^/ [/ d/ ]/ =/ gr/ 犕/ / 狑/ / g/ ^/ [/ d/ ]/ ∈/ Gd/ 在/ 随机化/ 过程/ 中/ ,/ 密钥/ 的/ 结构/ 和/ 长度/ 没有/ 发生变化/ ,/ 只是/ 用/ 新/ 的/ 随机数/ 狌/ +/ 狌/ 和/ r/ +/ r/ 代替/ 原/ 密钥/ 中/ 的/ 狌/ 和/ r/ ,/ 因此/ 不/ 影响/ 密钥/ 的/ 一致性/ ./ 5.1/ ./ 3/ 委托/ 钥/ 正确性/ S2/ 是/ S1/ 的/ 仿射/ 子/ 空间/ ,/ 根据/ 引理/ 2/ ,/ 存在/ 一/ 有效/ 可/ 求解/ 的/ 矩阵/ 犕/ 和/ 向量/ 狕/ ,/ 满足/ 狓/ 2/ =/ 狓/ 1/ +/ 犕/ / 狕/ ,/ 故/ 犕/ / 狕/ =/ -/ 狓/ 1/ +/ 狓/ 2/ ./ 对/ 生成/ 的/ S2/ 的/ 委托/ 密钥/ 中/ ,/ ^/ 犽/ w/ 的/ 求解/ 过程/ 与/ 式/ (/ 6/ )/ 相同/ ./ Page7/ ^/ ka/ =/ r/ 犕/ / 1/ 狕/ 狑/ =/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ 1/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ gr/ 〈/ -/ 狓/ 1/ +/ 狓/ 2/ ,/ 狑/ 〉/ 通过/ 周期性/ 更新/ 主/ 密钥/ ,/ 可以/ 抗主/ 密钥/ 的/ 连续/ 5.2/ 密钥/ 更新/ 5.2/ ./ 1/ 主/ 密钥/ 更新/ PKG/ 可以/ 通过/ 对/ 特殊/ 仿射/ 空间/ S/ Λ/ =/ (/ 犈/ ,/ 0/ )/ 的/ 密钥/ 提取/ 来/ 更新/ 主/ 密钥/ MSK/ :/ Dim/ (/ S/ Λ/ )/ =/ κ/ ,/ 犈/ 是/ 单位/ 阵/ ,/ 0/ 是/ 零/ 向量/ ./ 主/ 密钥/ 更新/ 是/ 对/ 密钥/ 中/ 的/ 随机数/ 进行/ 再/ 随机化/ 处理/ ,/ 由于/ 主/ 密钥/ 中/ 每个/ 组件/ 都/ 与/ 随机数/ 关联/ ,/ 因此/ 进行/ 主/ 密钥/ 更新/ 可以/ 容忍/ 系统/ 的/ 泄露/ ,/ 我们/ 很/ 容易/ 得到/ 下面/ 的/ 定理/ ./ 定理/ 1/ ./ 在/ DASE/ 方案/ 中/ ,/ 主/ 密钥/ 更新/ 不/ 影响/ 系统/ 以前/ 和/ 以后/ 产生/ 的/ 密钥/ ,/ 但/ 可以/ 提高/ 系统/ 的/ 抗主/ 密钥/ 泄露/ 安全性/ ./ 泄露/ ./ 5.2/ ./ 2/ 用户/ 密钥/ 更新/ 在/ Dele/ 算法/ 中/ ,/ 任何/ 密钥/ 持有者/ 除了/ 可以/ 为/ 仿射/ 子/ 空间/ 生成/ 子/ 密钥/ 外/ ,/ 还/ 可以/ 更新/ 自身/ 密钥/ ./ 在/ 密钥/ 结构/ 和/ 长度/ 不变/ 的/ 情况/ 下/ ,/ 通过/ 再/ 随机化/ 随机数/ 的/ 功能/ 实现/ 密钥/ 更新/ ./ 定理/ 2/ ./ 在/ DASE/ 方案/ 中/ ,/ 密钥/ 更新/ 不/ 影响/ 该/ 密钥/ 生成/ 的/ 子/ 密钥/ ,/ 但/ 可以/ 提高/ 系统/ 的/ 抗主/ 密钥/ 泄露/ 安全性/ ./ 面/ 讨论/ ./ 5.3/ 委托/ 路径/ 独立性/ 本/ 方案/ 具有/ 委托/ 路径/ 独立性/ :/ 一个/ 委托/ 的/ 密钥/ 与/ 路径/ 无关/ ./ 设有/ 3/ 个/ 仿射/ 空间/ S1/ ,/ S2/ ,/ S3/ 满足/ S3/ / S2/ / S1/ ,/ 则/ 为/ S3/ 生成/ 的/ 两个/ 密钥/ Dele/ (/ MPK/ ,/ S1/ ,/ SKS1/ ,/ S3/ )/ 与/ Dele/ (/ MPK/ ,/ S2/ ,/ Dele/ (/ MPK/ ,/ S1/ ,/ SKS1/ ,/ S2/ )/ ,/ S3/ )/ 是/ 计算/ 不可/ 区分/ 的/ ./ 5.4/ 安全性/ 与/ 一般/ 加密/ 方案/ 的/ 证明/ 不同之处/ 在于/ ,/ 一般/ 的/ 语义/ 安全性/ 只/ 需要/ 回答/ 敌手/ 的/ 密钥/ 询问/ ,/ 而本/ 方案/ 允许/ 敌手/ 进行/ 额外/ 的/ 主/ 密钥/ MSK/ 和/ 仿射/ 空间/ 角色/ 密钥/ SKS/ 的/ 泄露/ 询问/ ./ 特别/ 地/ ,/ 敌手/ 可以/ 对/ 挑战/ 的/ 仿射/ 子/ 空间/ 作有界/ 长度/ 的/ 密钥/ 泄露/ 询问/ ./ 可/ 泄露/ 的/ 界/ / MSK/ ,/ / SK/ 是/ 安全/ 参数/ 的/ 多项式/ 表达式/ ,/ 即/ / MSK/ =/ / MSK/ (/ λ/ )/ ,/ / SK/ =/ / SK/ (/ λ/ )/ ./ 首先/ ,/ 挑战者/ C/ 运行/ Init/ 算法/ 生成/ 系统/ 参数/ 和/ 主/ 密钥/ ,/ 并/ 把/ 系统/ 公钥/ 发送给/ 敌手/ A/ ./ 同时/ ,/ C/ 提供/ 给/ 敌手/ 一个/ 记录/ 主/ 密钥/ MSK/ 及/ 关联/ 的/ 用户/ 密钥/ SK/ 及/ 泄露/ 量/ 的/ 句柄/ H/ ·/ ·/ =/ (/ Handle/ ,/ Space/ ,/ (/ MSK/ ∪/ SK/ )/ ,/ Leaked/ -/ bit/ )/ )/ ,/ 以利/ 敌手/ 进行/ 询问/ 并/ 保持/ 相应/ 关于/ 密钥/ 可/ 泄露/ 的/ 大小/ 与/ 安全/ 强度/ ,/ 我们/ 在/ 后/ 的/ 状态/ ./ 在/ 询问/ 阶段/ ,/ 由于/ OKeyGen/ ,/ ODele/ 都/ 可以/ 由/ OCrea/ 生成/ ,/ 在/ 询问/ 阶段/ 敌手/ 可以/ 自/ 适应/ 地/ 进行/ 三种/ 询问/ :/ OCrea/ ,/ OLeak/ 和/ ORevl/ ./ 在/ OCrea/ 中/ ,/ 敌手/ 提供/ 一个/ 主/ 密钥/ 的/ 句柄/ 给/ 挑战者/ ,/ 并/ 请求/ 挑战者/ 生成/ 一个/ 密钥/ ,/ 并/ 存储/ 在/ 相应/ 队列/ 中/ ./ 每次/ 询问/ 后/ ,/ 挑战者/ 要/ 返回/ 一个/ 与/ 相应/ 句柄/ 相应/ 的/ 用户/ 密钥/ 给/ A/ ,/ 使得/ A/ 在/ 后面/ 的/ OLeak/ 和/ ORevl/ 询问/ 中/ 能够/ 对应/ 它/ 所/ 使用/ 的/ 句柄/ ./ 在/ OLeak/ 询问/ 中/ ,/ A/ 使用/ 句柄/ 可以/ 有/ 选择性/ 地/ 进行/ 泄露/ 询问/ ,/ 所有/ 的/ 泄露/ 函数/ fi/ 和/ 泄露/ 量/ 由/ 敌手/ 自/ 适应/ 地/ 选择/ (/ 只要/ 泄露/ 总量/ 不/ 超过/ / MSK/ 和/ / SK/ )/ ./ 在/ 此/ 询问/ 过程/ 中/ ,/ 挑战者/ 记录/ 敌手/ 每次/ 所/ 泄露/ 过/ 的/ 密钥/ 及/ 泄露/ 量/ ./ 当/ 敌手/ 请求/ 一个/ OCrea/ 询问/ 时/ ,/ 挑战者/ 创建/ 一条/ 上述/ 记录/ 并/ 置/ 初值/ 为/ 0/ ./ ORevl/ 询问/ 允许/ 敌手/ 获得/ 某一/ 仿射/ 空间/ 的/ S/ 生成/ 的/ 密钥/ SKS/ ./ 为了/ 保持/ 一致性/ ,/ 敌手/ 只/ 需/ 提供/ 一个/ S/ 的/ 句柄/ ./ 显然/ ,/ 敌手/ 不能/ 获得/ 主/ 密钥/ 的/ 询问/ ,/ 也/ 不能/ 对/ 挑战/ 的/ 仿射/ 空间/ 作/ 密钥/ 提取/ 询问/ ./ 为此/ ,/ 挑战者/ 用/ 集合/ R/ 记录/ 已/ 询问/ 过/ 的/ 仿射/ 空间/ ./ 方案/ 中/ KeyGen/ 或/ Dele/ 产生/ 的/ 密钥/ 和/ Encr/ 生成/ 的/ 密文/ 都/ 是/ 正常/ 形式/ 的/ ,/ 为了/ 帮助/ 证明/ ,/ 我们/ 设计/ 半/ 功能化/ 的/ 密钥/ 形式/ ./ 基本/ 方法/ 是/ 对/ 原来/ 密钥/ 和/ 密文/ 组件/ 乘以/ Gq/ 中/ 的/ 随机/ 元素/ (/ Gq/ 在/ 实际/ 方案/ 中/ 没有/ 涉及/ ,/ 仅/ 用于/ 安全性/ 证明/ 中/ 设计/ 半/ 功能化/ 密文/ 或/ 密钥/ )/ ./ 随机/ 选取/ g/ -/ θ/ 1/ ,/ g/ -/ γ/ 1/ ∈/ Gn/ +/ 2/ 功能/ 密钥/ :/ 槇/ SKS/ ·/ ·/ =/ (/ (/ 犽/ u/ ,/ ka/ ,/ kr/ )/ / g/ -/ θ/ 1/ ,/ 犽/ w/ / g/ -/ θ/ 2/ )/ ∈/ Gn/ +/ d/ +/ 2/ 半/ 功能/ 密文/ :/ 槇/ CTS/ ·/ ·/ =/ (/ cm/ ,/ (/ 犮/ v/ ,/ cs/ ,/ ca/ )/ / g/ -/ γ/ 1/ ,/ 犮/ w/ / g/ -/ γ/ 2/ )/ ∈/ Gt/ ×/ Gn/ +/ d/ +/ 2/ 显然/ 一个半/ 功能/ 密钥/ 要/ 成功/ 解密/ 一个半/ 功能/ 密文/ ,/ 除了/ 加密/ 策略/ S/ 与/ 解密/ 角色/ S/ 满足/ S/ ∩/ S/ ≠/ / ,/ 根据/ 式/ (/ 8/ )/ 还要/ 满足/ 〈/ θ/ 1/ ,/ γ/ 1/ 〉/ +/ 〈/ 犕/ / 狕/ θ/ 2/ ,/ 犕/ / 狕/ γ/ 2/ 〉/ =/ 0modq/ ./ 为了/ 证明/ 方案/ 的/ 安全性/ ,/ 我们/ 使用/ 一系列/ 不可/ 区分/ 的/ 游戏/ ,/ 最初/ 游戏/ Leak/ 中/ 密钥/ 和/ 密文/ 均/ 是/ 正常/ 形式/ ,/ 而/ 最后/ 的/ LeakCK/ 中/ 密钥/ 和/ 密文/ 均/ 是/ 半/ 功能化/ 的/ ,/ LeakCKM/ 中/ 的/ 消息/ 组件/ cm/ 是/ 随机化/ 的/ ./ 定义/ 如下/ :/ (/ 1/ )/ Leak/ ./ 本/ 游戏/ 中/ 密文/ 和/ 密钥/ 均/ 为/ 正常/ 形式/ ,/ 即/ 密文/ 和/ 密钥/ 由/ DASE/ 中/ 算法/ 生成/ ,/ 敌手/ 执行/ ∏/ ,/ A/ (/ λ/ )/ 定义/ 的/ 游戏/ 模型/ ./ ExpLR/ (/ 2/ )/ LeakD/ ./ 与/ Leak/ 的/ 区别/ 在于/ ,/ 对/ 敌手/ 的/ Dele/ 和/ KeyGen/ 询问/ ,/ 用/ OCrea/ 代替/ ./ 由于/ 这/ 两个/ 谕言/ Page8/ 机所/ 生成/ 的/ 密钥/ 是/ 不可/ 区分/ 的/ ,/ 因此/ LeakD/ 与/ Leak/ 是/ 不可/ 区分/ 的/ ./ (/ 3/ )/ LeakC/ ./ 本/ 游戏/ 与/ LeakD/ 的/ 区别/ 在于/ ,/ 在/ 挑战/ 阶段/ ,/ 挑战者/ 用半/ 功能/ 密文/ 槇/ CTS/ 作为/ 挑战/ 的/ 输出/ ./ (/ 4/ )/ LeakCKj/ ./ 与/ LeakC/ 相同/ 的/ 是/ ,/ 本/ 游戏/ 中/ 密文/ 仍/ 是/ 半/ 功能化/ 的/ ./ 同时/ ,/ 本/ 游戏/ 产生/ 半/ 功能化/ 的/ 密钥/ 存储/ 于/ H/ 中/ ,/ OCrea/ 生成/ 正常/ 的/ 密钥/ 而/ OLeak/ 和/ ORevl/ 生成/ 半/ 功能化/ 的/ 密钥/ ./ 与/ 密钥/ 询问/ 一样/ ,/ 本/ 游戏/ 也/ 生成/ 半/ 功能/ 的/ 主/ 密钥/ ./ 显然/ ,/ j/ =/ 0/ 时/ ,/ LeakCK0/ =/ LeakC/ ;/ j/ =/ qe/ (/ qe/ 是/ 询问/ 的/ 最大/ 次数/ )/ 时/ ,/ LeakCK/ 中/ 生成/ 的/ 密文/ 和/ 密钥/ 都/ 是/ 半/ 功能化/ 的/ ./ 当/ 1/ / j/ / qe/ 时/ ,/ 所/ 生成/ 的/ 密钥/ 中前/ j/ -/ 1/ 个/ 是/ 半/ 功能化/ 的/ ,/ 后面/ 的/ 都/ 是/ 正常/ 密钥/ ./ 我们/ 证明/ 对/ 所有/ j/ ,/ LeakCKj/ 与/ LeakCKj/ +/ 1/ 是/ 不可/ 区分/ 的/ ./ 同时/ ,/ 我们/ 证明/ 敌手/ 在/ Leakj/ +/ 1/ 中/ 不能/ 构造/ 可/ 解密/ 挑战/ 密文/ 的/ 支配/ 型/ 密钥/ ./ (/ 5/ )/ LeakCKM/ ./ 与/ LeakCK/ 不同/ 的/ 是/ ,/ 本/ 游戏/ 中/ 密文/ 中/ 的/ cm/ 改变/ 成/ Gt/ 中/ 的/ 随机/ 元素/ ./ 通过/ LeakCK/ 与/ LeakCKM/ 的/ 不可/ 区分/ 性/ ,/ 我们/ 可以/ 证明/ cm/ 对/ 消息/ 是/ 保密/ 的/ ./ 定理/ 3/ ./ 在/ 一个/ 抗/ 泄露/ 的/ 双态/ 仿射/ 函数/ 加密/ 方案/ 中/ ,/ 若/ Leak/ ,/ LeakD/ ,/ LeakC/ ,/ LeakCK/ ,/ LeakCKM/ 之间/ 是/ 计算/ 性/ 不可/ 区分/ 的/ ,/ 则/ 该/ 方案/ 是/ 抗/ 泄露/ 安全/ 的/ ./ 证明/ ./ 我们/ 采用/ 一系列/ 不可/ 区分/ 的/ 证明/ 引理/ 4/ ~/ 8/ 来/ 证明/ 本抗/ 泄露/ 方案/ 的/ 安全性/ ./ Leak/ 是/ 本文/ 提出/ 方案/ 的/ 正常/ 密钥/ 和/ 密文/ ,/ 而/ LeakCK/ 表明/ 敌手/ 无法/ 区分/ 的/ 半/ 功能化/ 密文/ 和/ 密钥/ ,/ LeakCKM/ 是/ 对/ 消息/ 隐藏/ 组件/ 与/ 随机/ 元素/ 不可/ 区分/ ./ 引理/ 7/ 在/ 引理/ 1/ 的/ 分布/ 不可/ 区分/ 性/ 的/ 基础/ 上/ 证明/ 在/ 泄露/ 界/ 中/ ,/ 敌手/ 无法/ 构造/ 一个/ 支配/ 型/ 的/ 密钥/ 去/ 解密/ 挑战/ 密文/ ./ 因此/ 从/ 敌手/ 来看/ ,/ 这些/ 游戏/ 不可/ 区分/ ,/ 而/ LeakCK/ 和/ LeakCKM/ 是/ 完全/ 随机化/ 的/ 密文/ 组件/ ,/ 敌手/ 无法/ 从/ 这些/ 组件/ 中/ 获得/ 密文/ 的/ 有用/ 信息/ ./ 因此/ ,/ 本/ 方案/ 是/ (/ / MSK/ ,/ / SK/ )/ -/ LR/ -/ CPA/ 安全/ 的/ ./ 引理/ 4/ ./ 任何/ 多项式/ 时间/ 内/ 的/ 敌手/ A/ 无法/ 区分/ Leak/ 和/ LeakD/ ./ 证明/ ./ OCrea/ 执行/ OKeyGen/ 的/ 输出/ ./ 通过/ KeyGen/ 和/ Dele/ 的/ 算法/ 可知/ ,/ 两者/ 的/ 输出/ 是/ 同一/ 分布/ 的/ ,/ 同时/ ODele/ 的/ 委托/ 密钥/ 也/ 应当/ 在/ OCrea/ 生成/ 的/ 密钥/ 队列/ 中/ ,/ 因此/ OKeyGen/ 和/ ODele/ 都/ 可以/ 由/ OCrea/ 生成/ ,/ 敌手/ 无法/ 区别/ 一个/ 密钥/ 是/ 哪个/ 谕言机/ 生成/ ./ 引理/ 5/ ./ 若/ 安全/ 假设/ 1/ 存在/ ,/ 则/ 任何/ 多项式/ 时间/ 内/ 的/ 敌手/ A/ 无法/ 区分/ LeakC/ 和/ LeakD/ ./ 证明/ ./ 假设/ 一/ 多项式/ 时间/ 的/ 敌手/ A/ 可以/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ LeakD/ 和/ LeakC/ ,/ 则/ 我们/ 可以/ 构建/ 一/ 算法/ D/ 作为/ 模拟器/ 以/ 相同/ 的/ 优势/ 解决/ 安全/ 假设/ 1/ ./ 当/ D/ 收到/ 假设/ 1/ 的/ 实例/ (/ N/ ,/ G/ ,/ Gt/ ,/ e/ ^/ ;/ g/ ,/ g/ ^/ )/ ,/ D/ 的/ 目标/ 是/ 猜测/ 一/ 元素/ T/ ∈/ Gp/ 还是/ T/ ∈/ Gpq/ ./ 为此/ ,/ D/ 扮演/ 模拟器/ 并/ 回答/ 敌手/ A/ 的/ 询问/ 及/ 挑战/ 如下/ (/ 1/ )/ 初始化/ ./ D/ 随机/ 选择/ α/ ,/ a/ ,/ 狌/ ,/ 狏/ ,/ 狑/ ∈/ Z2n/ +/ κ/ +/ 2/ ,/ 置/ 系统/ 公钥/ MPK/ =/ (/ N/ ,/ g/ ,/ g/ ^/ ,/ ga/ ,/ g/ 狏/ ,/ g/ 狑/ )/ 并/ 发送给/ A/ ./ (/ 2/ )/ 询问/ 1/ ./ 由于/ D/ 知道/ 系统/ 主/ 密钥/ α/ 和/ 狏/ ,/ 因此/ 可以/ 为/ 任何/ 仿射/ 空间/ 生成/ 密钥/ ,/ 并且/ 可以/ 回答/ 敌手/ A/ 的/ OCrea/ 、/ OLeak/ 、/ ORevl/ 、/ OKeyGen/ 及/ ODele/ 等/ 询问/ ./ (/ 3/ )/ 挑战/ ./ 当/ A/ 提交/ 给/ D/ 两个/ 挑战/ 的/ 消息/ Gm0/ ,/ m1/ 及/ 挑战/ 子/ 空间/ S/ / =/ Aff/ (/ 犕/ / ,/ 狓/ / )/ ,/ 模拟器/ D/ 随机/ 选择/ β/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 输出/ 密文/ CTS/ / =/ (/ cm/ ,/ 犮/ v/ ,/ cs/ ,/ ca/ ,/ 犮/ w/ )/ =/ (/ m/ β/ e/ ^/ (/ T/ ,/ g/ α/ )/ ,/ T/ 狏/ ,/ T/ ,/ T/ -/ (/ a/ +/ 〈/ 狓/ / ,/ 狑/ 〉/ )/ ,/ T/ (/ 犕/ / )/ / 狑/ )/ ./ (/ 4/ )/ 询问/ 2/ ./ 与/ 询问/ 1/ 相同/ ,/ 同时/ 要求/ A/ 不能/ 对/ S/ / 及其/ 超/ 空间/ 作/ ORevl/ 询问/ ./ (/ 5/ )/ 输出/ ./ A/ 输出/ 对/ 密文/ 中/ 消息/ m/ β/ 的/ 猜测/ β/ ./ D/ 以/ 相同/ 的/ 输出/ β/ 作为/ 对/ 假设/ 1/ 的/ 猜测/ :/ β/ =/ 0/ 则/ T/ ∈/ Gp/ ,/ β/ =/ 1/ 则/ T/ ∈/ Gpq/ ./ 若/ T/ ∈/ Gp/ ,/ 则/ 密文/ CTS/ / 是/ 正常/ 形态/ 的/ (/ 没有/ Gq/ 元素/ )/ ,/ 此时/ B/ 可以/ 正确/ 模拟/ Leak/ ./ 若/ T/ =/ g/ σ/ g/ -/ τ/ ∈/ Gpq/ ,/ 则/ 密文/ 是/ 半/ 功能化/ 的/ ,/ 此时/ cm/ =/ m/ β/ e/ ^/ (/ T/ ,/ g/ α/ )/ =/ me/ ^/ (/ g/ ,/ g/ )/ α/ ,/ θ/ =/ τ/ (/ 狏/ ,/ 1/ ,/ -/ a/ +/ 〈/ -/ 狓/ / ,/ 狑/ 〉/ ,/ (/ 犕/ / )/ / 狑/ )/ ./ 事实上/ ,/ 虽然/ a/ ,/ 狌/ ,/ 狏/ ,/ 狑/ 是从/ ZN/ 中/ 选取/ ./ 但/ 在/ 公开/ 参数/ MPK/ 中时/ 都/ 是/ 作为/ g/ ∈/ Gp/ 的/ 指数/ ,/ 因此/ 这些/ 值模/ q/ 是/ 不/ 为/ 0/ 的/ (/ p/ ,/ q/ ,/ r/ 是/ 互素/ 的/ 阶/ )/ ./ 对/ 敌手/ 来说/ 密文/ 组件/ 中/ Gq/ 部分/ 不为/ 1Gq/ ./ 因此/ 可以/ 正确/ 模拟/ LeakC/ ./ 引理/ 6/ ./ 若/ 安全/ 假设/ 2/ 存在/ ,/ 则/ 任何/ 多项式/ 时间/ 内/ 的/ 敌手/ A/ 无法/ 区分/ LeakCKj/ 和/ LeakCKj/ +/ 1/ ./ 证明/ ./ 若/ 一/ 多项式/ 时间/ 的/ 敌手/ A/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ LeakCKj/ 和/ LeakCKj/ +/ 1/ ,/ 我们/ 可以/ 构建/ 一/ 算法/ D/ 以/ 相同/ 的/ 优势/ 解决/ 安全/ 假设/ 2/ ./ D/ 的/ 目标/ 是/ 判断/ 假设/ 2/ 的/ 实例/ (/ g/ ,/ g/ ^/ ,/ 犡/ 1/ ,/ 犡/ 2/ ,/ T/ )/ 中/ T/ 为/ Gpq/ 还是/ G/ 中/ 的/ 元素/ ./ 我们/ 证明/ 当/ T/ ∈/ Gpq/ 时/ ,/ D/ 能/ 成功/ 模拟/ LeakCKj/ ,/ 当/ T/ ∈/ G/ 时/ ,/ D/ 能/ 成功/ 模拟/ Leakj/ +/ 1/ ./ (/ 1/ )/ 初始化/ ./ D/ 随机/ 选择/ α/ ,/ a/ ,/ 狏/ ,/ 狑/ ∈/ Zn/ +/ κ/ +/ 2/ 置/ 系统/ 公钥/ MPK/ =/ (/ g/ ,/ g/ ^/ ,/ ga/ ,/ g/ 狑/ ,/ g/ 狑/ ,/ e/ ^/ (/ g/ ,/ g/ )/ α/ )/ ./ (/ 2/ )/ 询问/ 1/ ./ 本/ 阶段/ 对/ 密钥/ 回答/ 分为/ 3/ 种/ 情况/ ①/ 对/ 前面/ 的/ j/ -/ 1/ 个/ 密钥/ ,/ D/ 设置/ 成半/ 功能/ 密钥/ ,/ 即/ SKS/ =/ (/ g/ 狌/ ,/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ )/ / Page9g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ / X/ [/ n/ +/ d/ +/ 2/ ]/ ②/ 对/ 第/ j/ 个/ 密钥/ ,/ D/ 将/ 生成/ 挑战/ 项/ 的/ 密钥/ ,/ SKS/ =/ (/ T/ 狌/ ,/ g/ α/ Ta/ +/ 〈/ 狓/ ,/ 狑/ 〉/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ T/ ,/ T/ 犕/ / 狑/ )/ / g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ ./ 显然/ ,/ 当/ T/ ∈/ Gpr/ 时/ ,/ SKS/ 是/ 正常/ 形态/ 的/ ./ 当/ T/ =/ g/ σ/ g/ -/ τ/ g/ ^/ / ∈/ G/ (/ 注/ :/ G/ =/ Gpqr/ )/ 时/ ,/ 半/ 功能/ 密钥/ 因子/ θ/ =/ τ/ (/ 狌/ ,/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ 1/ ,/ 犕/ / 狑/ )/ ./ θ/ 作为/ g/ ∈/ Gp/ 的/ 指数/ (/ 计算/ 时/ modp/ )/ 而/ p/ 与/ q/ 互素/ ,/ 因此/ θ/ ≠/ 0/ ,/ 从/ 敌手/ 来看/ SKS/ 是/ 半/ 功能/ 的/ ./ ③/ 从/ j/ +/ 1/ 密钥/ 开始/ ,/ D/ 输出/ 正常/ 形式/ 的/ 密钥/ ,/ 即/ SKS/ =/ (/ g/ 狌/ ,/ g/ α/ +/ r/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ )/ / g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ ∈/ Gn/ +/ d/ +/ 2pr/ ./ 槇/ CTS/ / =/ (/ m/ β/ e/ ^/ (/ X1/ ,/ g/ α/ )/ ,/ X/ 狏/ 1/ ,/ X1/ ,/ X/ -/ a/ -/ 〈/ 狓/ / ,/ 狑/ 〉/ 因子/ γ/ =/ k2/ (/ 狏/ ,/ 1/ ,/ -/ a/ -/ 〈/ 狓/ / ,/ 狑/ 〉/ ,/ (/ 犕/ / )/ / 狑/ )/ ./ (/ 4/ )/ 设/ X1/ =/ gk1g/ -/ k2/ ∈/ Gpq/ ,/ 挑战/ 密文/ 中半/ 功能化/ 设/ 槇/ SKS/ =/ (/ (/ 犽/ u/ ,/ ka/ ,/ kr/ )/ / g/ -/ θ/ 1/ ,/ 犽/ w/ / g/ -/ θ/ 2/ )/ ,/ 在/ 半/ 功能化/ 密钥/ 生成/ 或/ 委托/ 时/ ,/ 根据/ 式/ (/ 8/ )/ ,/ 若/ S/ 使用/ 半/ 功能/ 密钥/ 槇/ SKS/ 去/ 生成/ 一/ 子/ 空间/ 密钥/ 狓/ 2/ =/ 狓/ 1/ +/ 犕/ / 狕/ ,/ 则/ 半/ 功能化/ 参数/ θ/ =/ θ/ 1/ +/ (/ 0/ ,/ …/ ,/ 0/ ,/ 〈/ 狕/ ,/ θ/ 2/ 〉/ )/ ./ 同样/ ,/ 半/ 功能化/ 密钥/ 参数/ γ/ =/ γ/ 1/ +/ (/ 0/ ,/ …/ ,/ 0/ ,/ 〈/ 狕/ ,/ γ/ 2/ 〉/ )/ ./ 〈/ θ/ ,/ γ/ 〉/ =/ τ/ k2/ (/ 〈/ 狌/ ,/ 狏/ 〉/ -/ a/ -/ 〈/ 狓/ / ,/ 狑/ 〉/ -/ 〈/ (/ 犕/ / )/ / 狕/ ,/ 狑/ 〉/ +/ (/ 3/ )/ 挑战/ ./ D/ 生成/ 一个半/ 功能化/ 的/ 密文/ :/ =/ τ/ k2/ (/ 〈/ 狓/ -/ 狓/ / ,/ 狑/ 〉/ +/ 〈/ (/ 犕/ / )/ / 狕/ -/ 犕/ / 狕/ ,/ 狑/ 〉/ )/ modq/ ./ 若/ 敌手/ 解密/ CTS/ ,/ 则/ 〈/ θ/ ,/ γ/ 〉/ =/ 0modq/ ./ 若/ 敌手/ 可以/ 区分/ Leakj/ 和/ Leakj/ +/ 1/ ,/ 我们/ 可以/ 不可/ 忽略/ 的/ 优势/ 找出/ N/ 的/ 因式/ q/ ,/ 并/ 成功/ 解决/ 安全/ 假设/ 2/ ./ 引理/ 7/ ./ 设/ 泄露/ 界/ / SK/ =/ (/ n/ -/ 1/ -/ 2c/ )/ logq/ ,/ c/ 是/ 一/ 正整数/ ./ 对/ 任一/ PPT/ 敌手/ A/ 在/ Leakj/ +/ 1/ 中/ 把/ 第/ j/ 个/ 密钥/ 关联/ 到/ 挑战/ 密文/ 向量/ 空间/ ,/ 把/ 第/ j/ 个/ 半/ 功能/ 密钥/ 替换成/ 支配/ 型/ 密钥/ 去/ 解密/ 挑战/ 密文/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 证明/ ./ 假设/ 一个/ PPT/ 敌手/ A/ 以/ 不可/ 忽略/ 的/ 优势/ 达到/ 上述/ 的/ 转换/ ,/ 我们/ 可以/ 构造/ 一/ 算法/ B/ 以/ 相同/ 的/ 优势/ 区分/ (/ δ/ ,/ f/ (/ τ/ )/ )/ 和/ (/ δ/ ,/ f/ (/ τ/ )/ )/ 从而/ 攻击/ 引理/ 1/ 和/ 推论/ 1/ 的/ 结论/ ./ 在/ 本/ 证明/ 中/ 主要/ 考虑/ 密钥/ 结构/ ,/ 我们/ 把/ 主/ 密钥/ 当成/ 超/ 仿射/ 空间/ 的/ 密钥/ ,/ 这样/ 所有/ 的/ 泄露/ 都/ 由密钥/ 泄露/ 谕言机/ OLeak/ 生成/ ./ B/ 收到/ 推论/ 1/ 的/ 实例/ 后/ ,/ 置/ m/ =/ n/ +/ 1/ ,/ q/ 是/ N/ 的/ 因子/ ./ B/ 的/ 目标/ 是/ 借助/ A/ 证明/ 上述/ 两个/ 分布/ 有/ 不可/ 忽略/ 的/ 优势/ ./ B/ 模拟/ Leakj/ +/ 1/ 如下/ :/ 首先/ 运行/ Init/ 算法/ 生成/ 主/ 密钥/ MSK/ 和/ 系统/ 公钥/ MPK/ ,/ 把/ 公钥/ MPK/ 发送给/ 敌手/ A/ ./ 由于/ B/ 知道/ 系统/ 主/ 密钥/ ,/ 因此/ 可以/ 回答/ 敌手/ 的/ 任何/ 询问/ ./ 假定/ 在/ 第/ j/ 个/ 密钥/ 询问/ 中/ ,/ 敌手/ 以/ 不可/ 忽略/ 的/ 优势/ 选择/ 与/ 挑战/ 空间/ 有/ 不动点/ 的/ 空间/ S/ / (/ 如/ 不能/ 达到/ 不可/ 区分/ 的/ 优势/ ,/ 则/ 敌手/ 无法/ 构造/ 支配/ 密钥/ 去/ 解密/ 密文/ ,/ 同时/ 不能/ 区分/ 两个/ 分布/ )/ ./ B/ 接下来/ 回答/ A/ 的/ 请求/ 生成/ 泄露/ 串/ ./ f/ 是/ 一个/ PPT/ 时间/ 的/ 函数/ ,/ 输入/ 域/ 是/ Zn/ +/ 1B/ 收到/ (/ δ/ ,/ f/ (/ τ/ )/ )/ ,/ 这里/ τ/ 是/ 狓/ 或/ 狓/ ,/ B/ 使用/ f/ (/ τ/ )/ 回答/ 敌手/ 的/ 第/ i/ 个/ 密钥/ 泄露/ 询问/ 如下/ :/ 选择/ r1/ ,/ r2/ ,/ θ/ ∈/ q/ ,/ 置/ Gq/ 子群/ 部分/ 密钥/ g/ -/ υ/ ,/ 这里/ υ/ =/ (/ υ/ 1/ ,/ …/ ,/ υ/ n/ ,/ Zd/ +/ 2r1/ ,/ υ/ n/ +/ 1/ +/ r2/ ,/ θ/ )/ ./ A/ 询问/ 挑战/ 空间/ S/ / ,/ 若/ 第/ j/ 空间/ 钥/ 队列/ 中/ 不/ 包含/ S/ / ,/ B/ 失败/ 并/ 随机/ 输出/ τ/ 是/ δ/ 正交/ 的/ 猜测/ ./ 否则/ ,/ 若/ 第/ j/ 个/ 仿射/ 空间/ 是/ S/ =/ Aff/ (/ 犕/ ,/ 狓/ )/ ,/ 则/ 存在/ 一/ 算法/ 求解/ 狓/ / =/ 狓/ +/ 犕/ 狕/ ./ B/ 随机/ 选择/ k2/ ∈/ Zq/ 满足/ υ/ n/ +/ 1/ +/ r2/ ,/ (/ r1/ +/ 〈/ 狕/ ,/ θ/ 〉/ )/ k2/ =/ 0modq/ ,/ 然后/ 使用/ (/ δ/ ,/ k2/ )/ ∈/ Zn/ +/ 2/ 为/ 参数/ 构造/ 挑战/ 密文/ ./ 若/ δ/ 与/ υ/ 正交/ ,/ 则/ 第/ j/ 个/ 密钥/ 是/ 支配/ 型/ 半/ 功能/ 的/ ,/ 即/ (/ υ/ 1/ ,/ …/ ,/ υ/ n/ ,/ r1/ ,/ υ/ n/ +/ 1/ +/ r2/ )/ +/ (/ 0/ ,/ …/ ,/ 0/ ,/ 〈/ 狓/ ,/ θ/ 〉/ )/ / δ/ =/ 〈/ υ/ ,/ δ/ 〉/ +/ δ/ n/ +/ 1r2/ +/ (/ r1/ +/ 〈/ 狓/ ,/ θ/ 〉/ )/ k2/ =/ 0modq/ ./ 若/ δ/ 与/ υ/ 不/ 正交/ ,/ 则/ 挑战/ 密钥/ 是/ 真半/ 功能/ 的/ ,/ 即/ 上式/ 恒不为/ 0/ ./ B/ 使用/ A/ 的/ 挑战/ 输出/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ (/ δ/ ,/ f/ (/ τ/ )/ )/ 和/ (/ δ/ ,/ f/ (/ τ/ )/ )/ ./ 这/ 与/ 引理/ 1/ 的/ 推论/ 1/ 矛盾/ ./ 因此/ 敌手/ 在/ Leakj/ +/ 1/ 中/ 把/ 一个半/ 功能/ 密钥/ 替换成/ 支配/ 型/ 半/ 功能/ 密钥/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 引理/ 8/ ./ 若/ 安全/ 假设/ 3/ 存在/ ,/ 则/ 任何/ 多项式/ 时间/ 内/ 的/ 敌手/ A/ 无法/ 区分/ LeakCK/ 和/ LeakCKM/ ./ 证明/ ./ 假设/ 一/ 多项式/ 时间/ 的/ 敌手/ A/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ LeakCK/ 和/ LeakCKM/ ,/ 我们/ 可以/ 构建/ 一/ 算法/ D/ 以/ 相同/ 的/ 优势/ 解决/ 安全/ 假设/ 3/ ./ 当/ D/ 收到/ 假设/ 3/ 的/ 实例/ ,/ D/ 的/ 目标/ 是/ 猜测/ T/ =/ e/ ^/ (/ g/ α/ ,/ gs/ )/ 还是/ T/ (/ g/ ,/ g/ -/ ,/ g/ ^/ ,/ X1/ =/ g/ α/ g/ -/ t/ ,/ X2/ =/ gsg/ -/ t/ ,/ T/ )/ 只能/ 为/ Gt/ 中/ 的/ 随机/ 猜测/ ./ 为此/ ,/ D/ 扮演/ 模拟器/ 并/ 回答/ 敌手/ A/ 的/ 询问/ 及/ 挑战/ 如下/ :/ (/ 1/ )/ 初始化/ ./ D/ 随机/ 选择/ a/ ,/ 狏/ ,/ 狑/ ∈/ Z1/ +/ n/ +/ κ/ N/ (/ 此时/ D/ 并不知道/ α/ )/ ,/ 公钥/ 组件/ e/ ^/ (/ g/ ,/ g/ )/ α/ 可/ 由/ e/ ^/ (/ X1/ ,/ g/ )/ =/ e/ ^/ (/ g/ ,/ g/ )/ α/ 计算/ ./ 置/ 系统/ 公钥/ MPK/ =/ (/ N/ ,/ g/ ,/ g/ ^/ ,/ ga/ ,/ g/ 狏/ ,/ g/ 狑/ ,/ e/ ^/ (/ g/ ,/ g/ )/ α/ )/ 并/ 发送给/ A/ ./ (/ 2/ )/ 询问/ 1/ ./ 为/ 回答/ A/ 的/ 密钥/ 询问/ ,/ 模拟器/ 随机/ 选择/ 狌/ ,/ r/ ∈/ ZnX1gr/ (/ a/ +/ 〈/ 狓/ ,/ 狑/ 〉/ )/ -/ 〈/ 狌/ ,/ 狏/ 〉/ ,/ gr/ ,/ gr/ 犕/ / 狑/ )/ / g/ ^/ [/ n/ +/ d/ +/ 2/ ]/ / g/ -/ [/ n/ +/ d/ +/ 2/ ]/ ./ 显然/ D/ ,/ SKS/ 是/ 半/ 功能/ 的/ ./ (/ 3/ )/ 挑战/ ./ A/ 提交/ 给/ D/ 两个/ 挑战/ 的/ 消息/ m0/ ,/ m1Page10/ 及/ 挑战/ 子/ 空间/ S/ / =/ Aff/ (/ 犕/ / ,/ 狓/ / )/ ,/ 模拟器/ D/ 随机/ 选择/ β/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 输出/ 密文/ CTS/ / =/ (/ m/ β/ ·/ T/ ,/ X/ 狏/ 2/ ,/ X/ (/ 犕/ / )/ / 狑/ 2/ )/ ./ X/ -/ a/ -/ 〈/ 狓/ / ,/ 狑/ 〉/ S/ / 及其/ 超/ 空间/ 作/ ORevl/ 询问/ ./ (/ 4/ )/ 询问/ 2/ ./ 与/ 询问/ 1/ 相同/ ,/ 同时/ 要求/ A/ 不能/ 对/ (/ 5/ )/ 输出/ X2/ =/ gsg/ -/ t/ ./ 当/ T/ =/ e/ ^/ (/ g/ α/ ,/ gs/ )/ 时/ ,/ CTS/ / 是/ 半/ 功能化/ 的/ ,/ 其半/ 功能/ 参数/ γ/ =/ t/ (/ 狌/ ,/ 1/ ,/ -/ a/ -/ 〈/ 狓/ / ,/ 狑/ 〉/ ,/ (/ 犕/ / )/ / 狑/ )/ ,/ 成功/ 模拟/ LeakCK/ ./ 当/ T/ 是/ Gt/ 中/ 的/ 随机/ 元素/ 时/ ,/ cm/ 是/ Gt/ 中/ 完全/ 随机/ 的/ 元素/ ,/ 此时/ 密文/ 是/ 一/ 随机/ 消息/ 的/ 半/ 功能/ 密文/ ,/ β/ 在/ 密文/ 中是/ 信息论/ 隐藏/ 的/ ,/ 成功/ 模拟/ LeakCKM/ ./ 若/ 敌手/ A/ 以/ 不可/ 忽略/ 的/ 优势/ 猜测/ β/ ,/ D/ 使用/ A/ 的/ 输出/ 成功/ 解决/ 安全/ 假设/ 3/ ./ 定理/ 3/ 得证/ ./ 6/ 泄露/ 性能/ 分析/ 为/ 分析/ 密钥/ 抗/ 泄露/ 性能/ ,/ 我们/ 给出/ 如下/ 两个/ 定义/ ./ 定义/ 6/ ./ 主/ 密钥/ 泄露/ 率/ (/ Master/ -/ keyLeakageRatio/ )/ ./ 可/ 泄露/ 的/ 主/ 密钥/ MSK/ 大小/ 与/ 主/ 密钥/ 长度/ 的/ 比值/ 称/ 为主/ 密钥/ 泄露/ 率/ MLR/ ./ MLR/ =/ / MSK/ 定义/ 7/ ./ 密钥/ 泄露/ 率/ (/ Secret/ -/ keyLeakageRatio/ )/ ./ 可/ 泄露/ 的/ 用户/ 密钥/ SKS/ 大小/ 与/ 密钥/ 长度/ 的/ 比值/ 称为/ 密钥/ 泄露/ 率/ SLR/ ./ SLR/ =/ / SK/ 方案/ 中主/ 密钥/ 长度/ 是/ 固定/ 的/ ,/ 在/ 参数/ 确定/ 的/ 情况/ 下/ 泄露/ 界/ 也/ 是/ 确定/ 的/ ,/ 因此/ MLR/ 一般/ 是/ 确定/ 的/ ./ 本/ 方案/ 具有/ 密钥/ 委托/ 的/ 功能/ ,/ 密钥/ 长度/ 在/ 委托/ 中随/ 仿射/ 子/ 空间/ 的/ 维度/ 变化/ ./ SLR/ 除/ 与/ 系统/ 的/ 参数/ 有关/ 外/ ,/ 还/ 与/ 仿射/ 空间/ 有关/ ./ 本/ 方案/ 支持/ 有限/ 界/ 的/ 密钥/ SKS/ 和/ 主/ 密钥/ MSK/ 的/ 抗/ 泄露/ 安全/ ./ 根据/ 引理/ 1/ 、/ 推论/ 1/ 及/ 引理/ 7/ ,/ 对于/ 大/ 素数/ q/ ,/ 任意/ 泄露/ 函数/ 的/ 输出/ |/ Ω/ |/ / 4qm/ -/ 3/ (/ q/ -/ 1/ )/ ·/ negl/ (/ ·/ )/ 2/ =/ 41/ -/ 1/ (/ )/ qqm/ -/ 2/ ·/ negl/ (/ ·/ )/ 2/ / 4qm/ -/ 2/ ·/ negl/ (/ ·/ )/ 2/ ./ 为/ 达到/ negl/ (/ ·/ )/ 的/ 可/ 忽略/ 性/ ,/ 设/ negl/ (/ ·/ )/ =/ q/ -/ c/ ,/ n/ +/ 1/ =/ m/ ,/ 则/ 可/ 泄露/ 的/ 长度/ / k/ =/ log2/ |/ Ω/ |/ =/ 2/ +/ (/ m/ -/ 2/ -/ 2c/ )/ log2q/ =/ 2/ +/ (/ n/ -/ 1/ -/ 2c/ )/ log2qbit/ ./ 这里/ n/ 是/ 大于/ 等于/ 2/ 的/ 任意/ 正整数/ ,/ c/ 是/ 可/ 选择/ 的/ 常数/ ./ 显然/ ,/ N/ =/ pqr/ ,/ 方案/ 中/ 泄露/ 的/ 界/ 由/ 子群/ Gq/ 的/ 阶/ q/ 决定/ ,/ 与/ p/ ,/ r/ 无关/ ,/ 我们/ 可以/ 通过/ 调整/ G/ 子群/ 的/ 大小/ 来/ 实现/ 优化/ 的/ 密钥/ 长度/ 和/ 泄露/ 界/ ./ 我们/ 考虑/ AES/ -/ 80/ 标准/ 的/ 安全性/ ,/ 由于/ N/ 要/ 不能/ 被/ 因式分解/ ,/ N/ =/ 1024bit/ ,/ G/ 是/ 椭圆/ 曲线/ 上/ 的/ 双/ a2/ (/ n/ -/ 1/ -/ 2c/ )/ 线性/ 群/ ,/ |/ G/ |/ =/ log2/ λ/ =/ 1024/ ./ 设/ |/ p/ |/ =/ a1/ λ/ ,/ |/ q/ |/ =/ a2/ λ/ ,/ |/ r/ |/ =/ a3/ λ/ ,/ (/ a1/ ,/ a2/ ,/ a3/ >/ 0/ )/ ./ MSK/ ∈/ Gn/ +/ κ/ +/ 21024/ (/ n/ +/ κ/ +/ 2/ )/ bit/ ./ 主/ 密钥/ 泄露/ 率/ MLR/ =/ (/ n/ +/ κ/ +/ 2/ )/ (/ 1/ +/ a1/ +/ a3/ )/ ,/ 而/ 每个/ 仿射/ 子/ 空间/ 的/ 密钥/ 泄露/ 率/ SLR/ =/ a2/ (/ n/ -/ 1/ -/ 2c/ )/ Dim/ (/ S/ )/ ./ 可见/ ,/ 随着/ 委托/ 的/ 深入/ ,/ d/ 减小/ ,/ 密钥/ 泄露/ 率会/ 变大/ ,/ 主要/ 原因/ 是/ 仿射/ 子/ 空间/ 越小/ ,/ 其/ 密钥/ 越短/ ./ 我们/ 可以/ 通过/ 调整/ 参数/ n/ ,/ c/ ,/ a1/ ,/ a2/ ,/ a3/ 可以/ 得到/ 不同/ 的/ 泄露/ 率/ ./ 在/ 图/ 1/ 中/ ,/ 在/ 空间/ 的/ 最大/ 维度/ 设定/ 为/ 50/ ,/ 子/ 空间/ 阶/ 的/ 大小/ 分别/ 是/ 160bit/ 、/ 704bit/ 和/ 160bit/ 的/ 情况/ 下/ ,/ 我们/ 分析/ 密钥/ 的/ 泄露/ 率/ 随/ 泄露/ 参数/ n/ 的/ 变化/ ./ 结果显示/ ,/ 当/ n/ =/ 100/ 时/ ,/ 密钥/ 的/ 可/ 泄露/ 率/ 达到/ 73/ %/ 仍/ 是/ 安全/ 的/ ./ 图/ 2/ 显示/ 在/ n/ =/ 100/ ,/ κ/ =/ 50/ ,/ c/ =/ 1/ 的/ 情况/ 下/ ,/ 系统/ 性能/ 随/ 委托/ 深度/ d/ 的/ 变化/ 情况/ ./ 可知/ ,/ 随着/ 委托/ 的/ 深入/ ,/ 用户/ 的/ 仿射/ 角色/ 空间/ 变小/ (/ d/ =/ Dim/ (/ S/ )/ 递减/ )/ ,/ 但/ 用户/ 密钥/ 的/ 抗/ 泄露/ 能力/ 提高/ ./ 图/ 1/ 公钥/ MPK/ // 密钥/ SK/ // 密文/ CT/ // 泄露/ 率/ SLR/ 图/ 2/ 公钥/ MPK/ // 密钥/ SK/ // 密文/ CT/ // 泄露/ 率/ SLR7/ 小结/ 本文/ 提出/ 了/ 一种/ 抗主/ 密钥/ 泄露/ 和/ 连续/ 用户/ 密钥/ Page11/ 泄露/ 的/ 双态/ 仿射/ 函数/ 加密/ 方案/ ,/ 在/ 标准/ 模型/ 下/ 证明/ 了/ 该/ 方案/ 的/ 安全性/ ,/ 分析/ 了/ 方案/ 中/ 的/ 主/ 密钥/ 和/ 用户/ 密钥/ 的/ 泄露/ 界/ ,/ 通过/ 优化/ 参数/ 可/ 达到/ 73/ %/ 的/ 泄露/ 率/ ,/ 具有/ 较/ 好/ 的/ 抗/ 泄露/ 性能/ ./ 改进/ 本文/ 方案/ 达到/ 通过/ 设计/ 高/ 熵/ 不/ 可逆/ 的/ 函数/ 达到/ 支持/ 无/ 界/ 密钥/ 泄露/ 的/ 加密/ 方案/ 是/ 接下来/ 研究/ 的/ 目标/ ./ 

