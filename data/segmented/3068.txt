Page1/ 基于/ Snake/ 模型/ 的/ 血管/ 树/ 骨架/ 三维重建/ 技术/ 曹/ 治国/ 1/ )/ 彭博/ 1/ )/ ,/ 2/ )/ 桑农/ 1/ )/ 张天序/ 1/ )/ 1/ )/ (/ 华中科技大学/ 图像识别/ 与/ 人工智能/ 研究所/ 武汉/ 430074/ )/ 2/ )/ (/ 湖北/ 航天技术/ 研究院/ 总体设计/ 所/ 武汉/ 430034/ )/ 摘要/ 从/ 两幅/ 不同/ 角度/ 的/ 造影/ 图像/ 实现/ 血管/ 树/ 的/ 三维/ 骨架/ 重建/ ,/ 传统/ 重建/ 方法/ 常常/ 需要/ 较/ 多/ 的/ 人工干预/ ,/ 才能/ 为/ 每/ 一点/ 找到/ 准确/ 的/ 对应点/ ./ 文中/ 研究/ 了/ 一种/ 基于/ Snake/ 模型/ 的/ 重建/ 方法/ ./ 它/ 在/ 采用/ 多/ 尺度/ Gabor/ 滤波/ 提取/ 造影/ 血管/ 中轴线/ 的/ 基础/ 上/ ,/ 选取/ 血管/ 树/ 分叉/ 点/ ,/ 优化/ 几何变换/ 矩阵/ ,/ 提高/ 用以/ 初始化/ Snake/ 的/ 对应点/ 的/ 准确性/ ;/ 然后/ ,/ 针对/ 血管/ 的/ 特性/ ,/ 文中/ 采用/ GVF/ (/ GradientVectorFlow/ )/ 流量/ 场/ 作为/ 三维/ Snake/ 的/ 外部/ 能量/ 场/ ,/ 并/ 给出/ 最小化/ 血管/ Snake/ 模型/ 能量/ 函数/ 的/ 表达式/ ,/ 使/ Snake/ 保持/ 自身/ 平滑/ 连续/ 的/ 同时/ 在/ 空间/ 中/ 发生/ 形变/ 以/ 逼近/ 真实/ 轮廓/ ./ 实验/ 结果表明/ ,/ 该/ 方法/ 与/ 传统/ 的/ 重建/ 方法/ 相比/ ,/ 不但/ 减少/ 了/ 人工干预/ ,/ 而且/ 有效/ 地/ 提高/ 了/ 重建/ 精度/ ./ 关键词/ 血管/ 造影/ ;/ 三维重建/ ;/ Snake/ 模型/ ;/ GVF1/ 引言/ 依据/ ./ 血管/ 的/ 三维重建/ 技术/ 不仅/ 能为/ 医生/ 提供/ 形象/ 、/ 直观/ 的/ 三维/ 血管/ 形状/ 图像/ ,/ 而且/ 可以/ 辅助/ 测量/ 血管/ 的/ 有关/ 参数/ (/ 如/ 直径/ 大小/ 、/ 血管/ 长度/ 和/ 截面积/ 等/ )/ ,/ 从/ 血管/ 造影/ 图像/ (/ DSA/ )/ 是/ 临床/ 诊治/ 冠心病/ 的/ 主要/ 而/ 有助于/ 冠心病/ 的/ 诊断/ 和/ 治疗/ ./ 因此/ 根据/ 血管/ 造影/ Page2/ 图像/ 重建/ 血管/ 的/ 三维/ 骨架/ 具有/ 很/ 好/ 的/ 临床意义/ 和/ 很/ 高/ 的/ 应用/ 价值/ ./ 在/ 传统/ 的/ 双/ 平面/ 造影/ 图像/ 重建/ 方法/ 中/ ,/ 大部分/ 都/ 是/ 采用/ 自/ 底向上/ 的/ 重建/ 方法/ ,/ 这种/ 方法/ 是/ 基于/ 图像/ 的/ 特征提取/ 并/ 通过/ 找到/ 每/ 一对/ 对应点/ 进行/ 重建/ [/ 1/ -/ 2/ ]/ ./ 这类/ 方法/ 最大/ 的/ 问题/ 是/ ,/ 找到/ 全部/ 完全/ 准确/ 的/ 对应点/ 很/ 困难/ ,/ 从而/ 使得/ 重建/ 结果/ 不/ 精确/ ./ 一些/ 研究/ 人员/ 在/ 寻找/ 对应点/ 方面/ 做/ 了/ 大量/ 的/ 改进/ [/ 3/ -/ 4/ ]/ ,/ 这些/ 方法/ 虽然/ 提高/ 了/ 寻找/ 的/ 对应点/ 的/ 精确度/ ,/ 但/ 同时/ 也/ 大大增加/ 了/ 计算/ 的/ 复杂性/ 和/ 计算/ 量/ ./ 文献/ [/ 5/ ]/ 提出/ 了/ 采用/ Snake/ 模型/ [/ 6/ ]/ 重建/ 血管/ 造影/ 图像/ 的/ 自顶向下/ 的/ 方法/ ,/ 与/ 传统/ 的/ 方法/ 相比/ ,/ 它/ 只/ 需/ 选用/ 少量/ 可以/ 描述/ 血管/ 轮廓/ 的/ 点/ 作为/ 对应点/ 即可/ ,/ 并且/ Snake/ 的/ 自动性/ 较/ 好/ ,/ 它/ 通过/ 同时/ 结合/ 两幅/ 图像/ 上/ 的/ 特征/ ,/ 使/ Snake/ 在/ 空间/ 中/ 不断/ 发生/ 形变/ ,/ 从而/ 逼近/ 真实/ 轮廓/ ,/ 获得/ 较/ 高/ 的/ 重建/ 精度/ ./ Radeva/ 和/ Toledo/ 等/ 在/ 此基础/ 上/ 重新/ 定义/ 了/ Snake/ 的/ 外部/ 能量/ 场/ ,/ 并/ 给出/ 了/ 基于/ 三维/ Snake/ 模型/ 重建/ 任意/ 角度/ 的/ 造影/ 图像/ 的/ 一般/ 方法/ [/ 7/ ]/ ./ 上述/ 这些/ 工作/ 都/ 只/ 给出/ 单根/ 血管/ 的/ 重建/ 方法/ ,/ 并且/ 他们/ 是/ 将/ 血管/ 分割/ 与/ 重建/ 同时/ 进行/ 的/ ,/ 由于/ 成像/ 质量/ 的/ 影响/ 和/ 分割/ 技术/ 的/ 局限性/ ,/ 影响/ 了/ 寻找/ 的/ 对应点/ 之间/ 的/ 准确性/ ,/ 并/ 最终/ 影响/ 重建/ 精度/ ./ 文献/ [/ 8/ ]/ 则/ 是/ 采用/ Snake/ 模型/ 实现/ 血管/ 树/ 骨架/ 三维重建/ ,/ 不过/ ,/ 它/ 与/ 上述/ 文献/ 均/ 未/ 考虑/ 对/ 成像/ 参数/ 的/ 校正/ ,/ 而/ 未经/ 校正/ 的/ 造影/ 系统/ 的/ 参数/ (/ 如/ 造影/ 角度/ 、/ X射线/ 源到/ 接受/ 平面/ 的/ 距离/ 等/ )/ 总是/ 不可避免/ 地/ 存在/ 一定/ 的/ 误差/ ,/ 从而/ 造成/ 在/ 实际/ 应用/ 中/ 所得/ 结果/ 也/ 会/ 产生/ 一定/ 误差/ ./ 针对/ 这些/ 问题/ ,/ 本文/ 研究/ 了/ 一种/ 基于/ Snake/ 模型/ 的/ 血管/ 树/ 骨架/ 三维重建/ 方法/ ./ 它/ 在/ 采用/ 多/ 尺度/ Gabor/ 滤波/ 提取/ 造影/ 血管/ 中轴线/ 的/ 基础/ [/ 9/ ]/ 上/ ,/ 根据/ 血管/ 中轴/ 的/ 树状/ 结构/ 选取/ 血管/ 树/ 分叉/ 点/ ,/ 用以/ 优化/ 几何变换/ 矩阵/ ,/ 提高/ 用以/ 初始化/ Snake/ 的/ 对应点/ 的/ 准确性/ ;/ 然后/ ,/ 本文/ 针对/ 血管/ 的/ 特性/ ,/ 提出/ 采用/ GVF/ (/ GradientVectorFlow/ )/ 流量/ 场/ [/ 10/ ]/ 作为/ 三维/ Snake/ 模型/ 的/ 外部/ 能量/ 场/ ,/ 并/ 给出/ 血管/ 的/ 非/ 闭合/ 轮廓/ 能量/ 函数/ 最小化/ 的/ 最佳/ 表达式/ ,/ 使/ Snake/ 保持/ 自身/ 平滑/ 连续/ 的/ 同时/ 在/ 空间/ 中/ 发生/ 形变/ 以/ 逼近/ 真实/ 轮廓/ ./ 由于/ 采用/ 多/ 尺度/ Gabor/ 滤波器/ 提取/ 中轴/ 的/ 方法/ 我们/ 已/ 在/ 文献/ [/ 9/ ]/ 中/ 进行/ 了/ 详细/ 的/ 描述/ ,/ 因此/ ,/ 本文/ 不再/ 赘述/ ,/ 其它/ 内容/ 则/ 按/ 以下/ 结构/ 组织/ :/ 第/ 2/ 节/ 简单/ 给出/ X射线/ 造影/ 系统/ 的/ 几何/ 描述/ 和/ 基于/ 几何/ 关系/ 重建/ 的/ 一般/ 方法/ ;/ 第/ 3/ 节/ 介绍/ 初始化/ Snake/ ,/ 并/ 给出/ 利用/ 对应点/ 对/ 优化/ 几何变换/ 矩阵/ 方法/ ;/ 第/ 4/ 节/ 分析/ 利用/ Snake/ 重建/ 三维/ 血管/ 树/ 的/ 过程/ ;/ 最后/ ,/ 对/ 实验/ 结果/ 进行/ 讨论/ 并出/ 结论/ ./ 2/ 造影/ 图像/ 几何/ 关系/ 标准/ 的/ 造影/ 设备/ 由/ 两个/ 独立/ 的/ 、/ 可以/ 自由/ 旋转/ 的/ X光/ 系统/ 组成/ [/ 11/ ]/ ./ 两个/ 旋转轴/ 可以/ 在/ 水平/ 和/ 垂直/ 方向/ 上/ 运动/ ./ 两/ 光轴/ 交于/ 光心/ O/ ,/ X光/ 源/ A/ ,/ B/ 到/ 两/ 图像/ 平面/ 的/ 距离/ SIDA/ ,/ SIDB/ 已知/ ./ 三维/ 的/ 坐标/ 重建/ 需要/ 一个/ 世界/ 坐标系/ ./ 我们/ 假设/ 两/ 光轴/ 互相/ 垂直/ ,/ 世界/ 坐标系/ 的/ 原点/ 在/ 光心/ ,/ X/ ,/ Y/ ,/ Z/ 轴如图/ 1/ 所示/ ,/ A/ 点/ 发出/ 的/ 光线/ 与/ X/ 轴/ 重合/ ,/ B/ 点/ 发出/ 的/ 光线/ 与/ Z/ 轴/ 重合/ ./ A/ ,/ B/ 各自/ 的/ 坐标系/ 如图/ 1/ ,/ uAvA/ 为/ 平面/ A/ 上/ 的/ 坐标/ 系统/ ,/ uBvB/ 为/ 平面/ B/ 上/ 的/ 坐标/ 系统/ ./ 另外/ 存在/ 世界/ 坐标系/ 的/ 同时/ ,/ 光源/ A/ ,/ B/ 也/ 存在/ 各自/ 的/ 坐标系/ ./ 在/ 图/ 1/ 中/ ,/ A/ 光源/ 坐标系/ 的/ x/ 轴/ 与/ 世界/ 坐标系/ 的/ X/ 轴/ 重合/ ,/ y/ ,/ z/ 轴/ 分别/ 与/ Y/ ,/ Z/ 轴/ 平行/ ./ 假设/ P/ 点/ 在/ 光源/ A/ 坐标系/ 下/ 的/ 坐标/ 为/ (/ xA/ ,/ yA/ ,/ zA/ )/ ,/ 在/ 光源/ B/ 坐标系/ 下/ 的/ 坐标/ 为/ (/ xB/ ,/ yB/ ,/ zB/ )/ ./ 则/ 它们/ 之间/ 满足/ 的/ 关系/ 可以/ 写为/ 其中/ (/ 犚/ ,/ 狋/ )/ 为/ 几何变换/ 矩阵/ ,/ 与/ 造影/ 角度/ 和/ X射线/ 源到/ 接受/ 平面/ 的/ 距离/ 等/ 有关/ [/ 11/ ]/ ./ 犚/ 是/ 旋转/ 矩阵/ ,/ 狋/ 是/ 平移/ 向量/ ./ 图/ 1/ 双/ 平面/ 造影/ 系统结构/ (/ 两/ 光源/ 夹角/ 为/ 90/ °/ )/ 在/ 此/ 三维空间/ 中/ ,/ 一个点/ P/ 在/ 一幅/ 图像/ 上/ 的/ 投影/ 可以/ 定义/ 为/ 光源/ 发出/ 的/ 光束/ 经过/ 该点/ 与/ 图像/ 平面/ 的/ 交点/ PA/ ,/ PB/ ,/ 如图/ 即/ 为/ 直线/ APA/ ,/ BPB/ 的/ 交点/ ./ 当/ 两幅/ 图像/ 上/ 的/ 对应点/ 已知/ ,/ 两条/ 光线/ 将/ 在/ 空间/ 中交于/ 一点/ ./ 在/ 这种/ 情况/ 下/ ,/ 如果/ 成像/ 系统/ 的/ 几何/ 关系/ 已知/ ,/ 并且/ 一对/ 对应点/ 已/ 找到/ ,/ 空间/ 中/ 的/ 三维/ 点/ 是/ 可以/ 重建/ 出来/ 的/ ./ 然而/ 实际/ 的/ 情况/ 是/ ,/ 这/ 两束/ 光线/ 可能/ 并/ 不/ 相交/ ,/ Page3/ 如图/ 2/ ,/ 这/ 主要/ 是因为/ 系统/ 的/ 误差/ 和/ 图像/ 间/ 几何/ 关系/ 的/ 不/ 精确度/ 造成/ 的/ ./ 为了/ 解决/ 这个/ 问题/ ,/ 一般/ 是/ 将/ 到/ 两条/ 直线/ 距离/ 最近/ 的/ 点/ 作为/ 真实/ 的/ 点/ 的/ 存在/ 位置/ [/ 2/ ]/ ,/ 如图/ 2.3/ 基于/ 几何变换/ 矩阵/ 优化/ 的/ Snake/ 模型/ 初始化/ 对于/ 传统/ 的/ 重建/ 方法/ 而言/ ,/ 找到/ 准确/ 的/ 对应点/ 是/ 十分/ 重要/ 的/ 工作/ ./ 其/ 准确/ 与否/ 直接/ 影响/ 到/ 重建/ 的/ 结果/ ./ 文献/ [/ 3/ -/ 4/ ]/ 在/ 寻找/ 对应点/ 方面/ 做/ 了/ 大量/ 的/ 改进/ ./ 而/ 一些/ 研究/ 人员/ [/ 5/ ,/ 7/ -/ 8/ ]/ 则/ 把/ 三维/ 的/ Snake/ 模型/ 应用/ 于/ 血管/ 的/ 重建/ 上/ ,/ 避免/ 了/ 为/ 血管/ 上/ 的/ 每/ 一点/ 寻找/ 对应点/ 的/ 问题/ ,/ 只/ 需要/ 寻找/ 若干/ 对/ 对应点/ (/ 如/ 起止/ 和/ 分叉/ 点/ )/ 即可/ 描述/ 出/ 血管/ 的/ 大致/ 轮廓/ ./ 再/ 结合/ Snake/ 投影/ 到/ 两幅/ 图像/ 上/ 的/ 信息/ 使/ Snake/ 不断/ 发生/ 形变/ ,/ 直到/ 它/ 的/ 投影/ 与/ 两幅/ 图像/ 完全/ 重合/ ./ Snake/ 是/ 一个/ 含有/ 参数/ 的/ 模型/ [/ 6/ ]/ ,/ 它/ 实际上/ 是/ 一个/ 可以/ 不断/ 发生/ 形变/ 的/ 参数/ 样条/ 曲线/ ,/ 三维/ Snake/ 模型/ 定义/ 为/ v/ (/ s/ )/ =/ (/ x/ (/ s/ )/ ,/ y/ (/ s/ )/ ,/ z/ (/ s/ )/ )/ ,/ 其中/ x/ (/ s/ )/ ,/ y/ (/ s/ )/ ,/ z/ (/ s/ )/ 为/ Snake/ 上/ 沿/ X/ ,/ Y/ ,/ Z/ 轴/ 的/ 分量/ ,/ s/ 为/ 弧长/ 参数/ ,/ 在/ [/ 0/ ,/ 1/ ]/ 之间/ ./ 为了/ 得到/ 血管/ 的/ 三维/ Snake/ 模型/ ,/ 我们/ 需要/ 重建/ 几/ 对/ 对应点/ 作为/ 样条/ 曲线/ 的/ 控制点/ ,/ 从而/ 能够/ 表达/ 三维/ 血管/ 的/ 大致/ 轮廓/ ./ 一旦/ 定义/ 了/ 初始/ 的/ Snake/ 模型/ ,/ Snake/ 就/ 可以/ 根据/ 它/ 在/ 两幅/ 图像/ 上/ 的/ 投影/ 与/ 原图/ 特征/ 的/ 结合/ 使/ Snake/ 自身/ 的/ 形态/ 逐渐/ 发生/ 改变/ ./ 与此同时/ ,/ Snake/ 自身/ 的/ 特点/ 也/ 会/ 保持/ 本身/ 的/ 平滑/ 与/ 连续性/ ./ 为了/ 得到/ 血管/ 的/ 初始/ Snake/ 轮廓/ ,/ 对于/ 单根/ 血管/ 而言/ ,/ 需要/ 两对/ 以上/ 的/ 对应点/ 按照/ 第/ 2/ 节/ 所述/ 的/ 几何/ 关系/ 对/ 它们/ 进行/ 重建/ ,/ 从而/ 得到/ 三维空间/ 中/ 血管/ 的/ 大致/ 轮廓/ ,/ 初始化/ Snake/ ./ 对于/ 血管/ 树/ ,/ 由于/ 其/ 特殊/ 的/ 树状/ 结构/ ,/ 文献/ 中/ 一般/ 给出/ 血管/ 的/ 起止点/ ,/ 并/ 选定/ 分叉/ 点/ 描述/ 血管/ ,/ 进行/ Snake/ 初始化/ ,/ 如图/ 3/ (/ a/ )/ 所示/ ./ 如果/ 血管/ 形态/ 较为/ 复杂/ ,/ 则/ 对于/ 弯曲/ 度/ 较大/ 的/ 部分/ ,/ 只/ 选取/ 起止/ ,/ 分叉/ 点/ 描述/ 血管/ 的/ 初始/ 轮廓/ 是/ 不够/ 的/ ,/ 此时/ 需要/ 多/ 寻找/ 几个/ 点/ 才能/ 较/ 好/ 表达/ 血管/ 形状/ 如图/ 3/ (/ b/ )/ 中/ 的/ 参考点/ ./ 在/ 一幅/ 已/ 提取/ 血管/ 中轴/ 的/ 图像/ 上/ 选定/ 了/ 一组/ 描述/ 血管/ 大致/ 轮廓/ 的/ 点/ 后/ ,/ 需要/ 在/ 另/ 一幅/ 图上/ 找到/ 它们/ 的/ 对应点/ ./ 虽然/ 采用/ Snake/ 模型/ 后/ ,/ 需要/ 求取/ 的/ 对应点/ 大为/ 减少/ ,/ 但/ 对应点/ 间/ 的/ 匹配/ 准确性/ 仍/ 非常/ 重要/ ./ 尽管/ 对于/ 血管/ 树/ 特殊/ 的/ 树状/ 结构/ 而言/ ,/ 可/ 认为/ 分叉/ 点/ 是/ 准确/ 对应/ 的/ ,/ 但/ 对于/ 除/ 分叉/ 点/ 之外/ 的/ 点/ 则/ 都/ 需要/ 用外/ 极线/ 方法/ 寻找/ 对应点/ ,/ 并/ 寻找/ 匹配/ 的/ 血管/ 分支/ [/ 8/ ]/ ./ 不过/ ,/ 由于/ 获取/ 的/ 图像/ 中/ 有些/ 来源于/ 未经/ 校正/ 的/ 造影/ 系统/ ,/ 其/ 系统/ 参数/ (/ 如/ 造影/ 角度/ 、/ X射线/ 源到/ 接受/ 平面/ 的/ 距离/ 等/ )/ 不可避免/ 地/ 存在/ 一定/ 的/ 误差/ ,/ 因此/ 原/ 参数/ 不能/ 很/ 好/ 地/ 反映/ 两幅/ 图像/ 间/ 的/ 几何/ 变化/ 关系/ ,/ 这样/ 会/ 导致/ 外极线/ 的/ 位置/ 发生/ 偏移/ ,/ 从而/ 影响/ 外极线/ 匹配/ 的/ 准确性/ ,/ 并/ 最终/ 影响/ 到/ 重建/ 结果/ ./ 针对/ 这样/ 的/ 问题/ ,/ 本文/ 提出/ 利用/ 准确/ 对应/ 的/ 血管/ 树上/ 的/ 分叉/ 点来/ 优化/ 几何变换/ 矩阵/ 犌/ 犜/ ,/ 在/ 此基础/ 上/ ,/ 再/ 通过/ 外极线/ 法/ 求取/ 其它/ 表达/ 初始/ 轮廓/ 的/ 点/ 的/ 对应点/ ,/ 从而/ 提高/ 对应点/ 的/ 匹配/ 准确性/ ./ 具体方法/ 如下/ ./ 假设/ 已经/ 匹配/ 好/ 的/ 共轭点/ 对/ (/ 本文/ 选择/ 血管/ 树/ 中轴/ 上/ 的/ 分叉/ 点/ 对/ )/ 是/ [/ (/ p11/ ,/ p21/ )/ ,/ …/ ,/ (/ p1n/ ,/ p2n/ )/ ]/ ,/ 可以/ 按照/ 第/ 2/ 节/ 所述/ 方法/ 计算/ 出/ 三维/ 点/ [/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ ]/ 的/ 坐标/ ./ 将/ [/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ ]/ 按原/ 投影/ 角度/ 分别/ 反投影/ 得到/ 新/ 的/ 对应点/ 对/ [/ (/ p11/ ,/ p21/ )/ ,/ …/ ,/ (/ p1n/ ,/ p2n/ )/ ]/ ./ 通过/ 比较/ (/ p1i/ ,/ p1i/ )/ ,/ (/ p2i/ ,/ p2i/ )/ ,/ 这里/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ 可以/ 计算/ 重建/ 误差/ :/ ε/ (/ p1i/ ,/ p2i/ )/ =/ ‖/ p1i/ -/ p1i/ ‖/ +/ ‖/ p2i/ -/ p2i/ ‖/ (/ 2/ )/ 由此/ 得到/ 目标/ 函数/ :/ F/ (/ 犚/ ,/ 狋/ )/ =/ ∑/ nPage4/ 其中/ ‖/ ·/ ‖/ 表示/ 2/ -/ 范数/ ,/ ‖/ p1i/ -/ p1i/ ‖/ 表示/ p1i/ 与/ p1i/ 之间/ 的/ 欧式/ 距离/ ./ N/ 表示/ n/ 对/ 从/ 图像/ 中/ 提取/ 的/ 对应点/ ,/ 公式/ 中/ 头/ 两个/ 表达式/ 是/ 计算/ 原/ 第一幅/ 图像/ 上/ 的/ 二维/ 输入/ 点/ 与/ 通过/ 计算/ 得到/ 的/ 相应/ 第/ i/ 个/ 三维/ 点/ 重新/ 投影/ 到/ 第一个/ 图像/ 平面/ 上/ 的/ 二维/ 点/ 之间/ 距离/ 的/ 平方/ ./ 后/ 两个/ 表达式/ 同样/ 也/ 是/ 定义/ 在/ 第二幅/ 图像/ 上/ 的/ 二维/ 误差/ ./ 由于/ 两个/ 成像/ 系统/ 间/ 的/ 关系/ 可以/ 由/ 旋转/ 矩阵/ 犚/ 和/ 平移/ 向量/ 狋/ 来/ 表示/ ,/ 因此/ 式/ (/ 3/ )/ 可以/ 表示/ 为/ F/ (/ 犚/ ,/ 狋/ )/ =/ ∑/ n/ 上式/ 中/ 犮/ k/ 表示/ 矩阵/ 犚/ 中/ 第/ k/ 列/ 向量/ ./ 通过/ 最小化/ 目/ F/ (/ 珘/ q/ ,/ 狋/ )/ =/ ∑/ n/ η/ i/ -/ 并且/ 上述/ 公式/ 还有/ 以下/ 约束条件/ :/ C1/ :/ s2/ +/ w21/ +/ w22/ +/ w23/ =/ 1/ ,/ C2/ :/ zi/ >/ 0/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ C3/ :/ 2/ (/ w1w3/ +/ sw2/ )/ xi/ +/ 2/ (/ w2w3/ -/ sw1/ )/ yi/ +/ 其中/ 约束条件/ C1/ 是/ 四/ 元素/ 的/ 标准规范/ ,/ 约束条件/ C2/ ,/ C3/ 保证/ 了/ 深度/ 信息/ zi/ ,/ zi/ 必须/ 在/ X射线/ 光源/ 的/ 前面/ ./ 另外/ 对于/ 心血管/ 而言/ 约束条件/ C2/ ,/ C3/ 还/ 可/ 写成/ C2C3/ :/ d/ -/ δ/ h/ </ zi/ =/ 2/ (/ w1w3/ +/ sw2/ )/ xi/ +/ 2/ (/ w2w3/ -/ sw1/ )/ yi/ +/ 2s2/ +/ w23/ -/ (/ )/ 1/ 如图/ 4/ 所示/ ,/ 其中/ d/ 为/ 焦点/ S/ 到/ 光心/ O/ 的/ 距离/ ./ δ/ h/ ≈/ 12.5/ ±/ 2.0/ cm/ 表示/ 心脏/ 在/ 长轴/ 上/ 的/ 最大/ 长度/ ./ 对/ 空间/ 中/ 每/ 一个三维/ 点/ 而言/ ,/ 发/ 光源/ 发出/ 的/ 光线/ ,/ 经过/ 空间/ 中/ 的/ 点/ 并/ 与/ 图像/ 平面/ 相交/ ,/ 因此/ 除了/ 上/ 面对/ zi/ 和/ zi/ 的/ 约束/ ,/ 还有/ 两个/ 约束条件/ 限制/ 空间/ 中/ 每/ 一个三维/ 点/ 的/ x/ ,/ x/ ,/ y/ ,/ y/ 坐标/ :/ z/ (/ )/ iC4/ :/ ξ/ i/ -/ xi/ 标/ 函数/ 优化/ 几何变换/ 矩阵/ 犌/ 犜/ ,/ 使得/ 造影/ 图像/ 与/ 反投影/ 图像/ 上/ 对应点/ 的/ 欧式/ 距离/ 最小/ ./ 对于/ 形态/ 简单/ 的/ 血管/ ,/ 采用/ 上/ 式/ 目标/ 函数/ 即可/ ./ 若能/ 获取/ 大量/ 匹配/ 准确/ 对应点/ ,/ 可以/ 采用/ 更优/ 的/ 优化/ 方法/ ./ 众所周知/ ,/ 刚体/ 变换/ 可以/ 由绕/ 通过/ 坐标/ 原点/ 的/ 的/ 单位向量/ 狏/ u/ 旋转/ 的/ θ/ 角度/ 分解/ 为/ 旋转/ 矩阵/ 和/ 平移/ 矩阵/ ,/ 用/ 四/ 元素/ 法/ 表示/ :/ 令/ w/ =/ sin/ (/ θ/ // 2/ )/ 狏/ u/ ,/ s/ =/ cos/ (/ θ/ // 2/ )/ ,/ 珘/ q/ =/ (/ s/ ,/ w/ )/ =/ (/ s/ ,/ w1/ ,/ w2/ ,/ w3/ )/ ./ 可以/ 得出/ 下/ 式/ :/ s2/ +/ w21/ -/ 1/ 熿/ 犚/ =/ 2/ 燀/ 采用/ 这种/ 四/ 元素/ 表示法/ ,/ 式/ (/ 4/ )/ 可以/ 重新/ 写为/ )/ 12xi/ +/ 2/ (/ w1w2/ +/ sw3/ )/ yi/ +/ 2/ (/ w1w3/ -/ sw2/ )/ zi/ +/ txC5/ :/ ξ/ i/ -/ xiz/ (/ )/ i/ 如图/ 4/ 约束条件/ δ/ c/ 表示/ 图中/ 圆面/ 的/ 半径/ ,/ 比如/ 是/ 20/ 个/ 像素/ ,/ 圆面/ 的/ 中心/ 在/ (/ ξ/ i/ ,/ η/ i/ )/ 或者/ (/ ξ/ i/ ,/ η/ i/ )/ ./ 正如/ 图中/ 所示/ ,/ 约束条件/ C3/ 到/ C5/ 为/ 每/ 一个/ 空间/ 三维/ 点/ 形成/ 了/ 一个/ 锥形/ 边界/ 区域/ ,/ 并且/ 每/ 一个/ 这样/ 的/ 锥形/ 区域/ 的/ 顶点/ 是/ 焦点/ ,/ 底面/ 则/ 是/ 以/ (/ ξ/ i/ ,/ η/ i/ )/ 或者/ (/ ξ/ i/ ,/ η/ i/ )/ 为/ 圆心/ ,/ δ/ c/ 为/ 半径/ 的/ 圆面/ ./ 因此/ 所求/ 之点/ 被/ 限定/ 在/ 这样/ 一个/ 空间/ 的/ 圆锥/ 中/ ./ 结合/ 这些/ 约束条件/ ,/ 对/ 目标/ 函/ Page5/ 数/ F/ (/ 珘/ q/ ,/ 狋/ )/ 进行/ 优化/ ,/ 从而/ 得到/ 更/ 准确/ 的/ 几何变换/ 矩阵/ 犌/ 犜/ ./ 与/ 文献/ [/ 8/ -/ 9/ ]/ 提到/ 的/ 重建/ 方法/ 不同/ 的/ 是/ ,/ 本文/ 通过/ 分叉/ 点/ 优化/ 几何变换/ 矩阵/ ,/ 使/ 找到/ 的/ 描述/ 血管/ 初始/ 轮廓/ 的/ 对应点/ 更加/ 准确/ ,/ 从而/ 为/ 精确/ 得到/ 血管/ 中轴/ Snake/ 模型/ 的/ 位置/ 和/ 完整/ 的/ 血管/ 轮廓/ 奠定/ 了/ 基础/ ./ 4/ 采用/ Snake/ 进行/ 三维重建/ 在/ 对/ Snake/ 模型/ 初始化/ 后/ ,/ Snake/ 将要/ 在/ 空间/ 中/ 不断/ 发生/ 形变/ ,/ 使/ 它/ 在/ 两幅/ 图上/ 的/ 投影/ 逐渐/ 逼近/ 真实/ 的/ 血管/ 位置/ ./ Snake/ 不断/ 趋近/ 于/ 图像/ 特征/ 与/ Snake/ 的/ 外部/ 能量/ 有关/ ,/ 与此同时/ 令/ Snake/ 保持/ 平滑/ 连续/ 是/ 与/ 它/ 内部/ 能量/ 有关/ 的/ ,/ 解决/ Snake/ 问题/ 就是/ 要/ 解决/ 能量/ 最小化/ 问题/ ./ 4.1/ 能量/ 函数/ 定义/ Snake/ 能量/ 函数/ [/ 6/ ]/ :/ 其中/ v/ (/ s/ )/ =/ (/ x/ (/ s/ )/ ,/ y/ (/ s/ )/ ,/ z/ (/ s/ )/ )/ 是/ Snake/ 曲线/ 的/ 三维空间/ 表达式/ ./ Eint/ 为/ 内部/ 能量/ ,/ 定义/ 为/ Eint/ =/ (/ α/ (/ s/ )/ vs/ (/ s/ )/ 2/ +/ β/ (/ s/ )/ vss/ (/ s/ )/ 2/ )/ // 2/ (/ 8/ )/ 从/ 物理/ 意义/ 上/ 来说/ ,/ 内部/ 能量/ 使/ Snake/ 具有/ 张力/ 和/ 硬度/ ,/ α/ (/ s/ )/ ,/ β/ (/ s/ )/ 分别/ 表示/ Snake/ 弹力/ 和/ 硬度/ 的/ 权值/ ,/ 为了/ 简单/ 起/ 见/ ,/ 设定/ 它们/ 为/ 常数/ α/ ,/ β/ ./ 由于/ 在/ 透视/ 投影/ 的/ 情况/ 下/ 不能/ 保证/ 物体/ 的/ 平滑/ 性/ 这/ 一/ 属性/ ,/ 因此/ 为了/ 保证/ 在/ 三维空间/ 中/ 重建/ 出来/ 的/ 形状/ 是/ 平滑/ 的/ ,/ 我们/ 应该/ 在/ 三维空间/ 中/ 定义/ Snake/ 的/ 内部/ 能量/ ,/ 而/ 不是/ 在/ 每/ 一幅/ 二维/ 的/ 投影图/ 上/ 定义/ ./ 外部/ 能量/ 使/ Snake/ 收敛/ 于/ 图像/ 的/ 明显/ 的/ 特征/ ,/ 如/ 明亮/ 的/ 或者/ 黑暗/ 的/ 区域/ 、/ 边缘/ 等/ ./ 最/ 简单/ 的/ 外部/ 能量/ 函数/ 是/ 未/ 处理/ 的/ 图像/ 强度/ 本身/ Eext/ =/ I/ (/ x/ ,/ y/ )/ [/ 6/ ]/ ,/ 如果/ 以此/ 为/ 外部/ 能量/ 函数/ ,/ 则/ Snake/ 将会/ 吸引/ 到/ 图像/ 中/ 的/ 明亮/ 的/ 曲线/ 部分/ ./ 求解/ Snake/ 模型/ 的/ 目标/ 就是/ 要/ 找到/ 在/ 式/ (/ 7/ )/ 中/ 定义/ 的/ E/ 的/ 局部/ 最小值/ [/ 6/ ]/ ./ 要/ 满足/ 该/ 条件/ ,/ 基于/ 变量/ 的/ 微积分学/ 知识/ ,/ 只有/ 当/ Eular/ -/ Lagrange/ 微分方程/ 满足/ 其中/ vss/ (/ s/ )/ ,/ vssss/ (/ s/ )/ 分别/ 为/ v/ (/ s/ )/ 对/ s/ 的/ 二阶/ 和/ 四阶/ 导数/ ./ / Eext/ 表示/ 对/ x/ ,/ y/ 或者/ z/ 分量/ 求导/ ./ 当/ Snake/ 在/ 两幅/ 图像/ 上/ 的/ 投影/ 与/ 血管/ 中轴/ 重合/ 时/ 外部/ 能量/ Eext/ 达到/ 最小值/ ./ 为/ 使/ Snake/ 在/ 三维空间/ 中/ 不断/ 发生/ 形变/ ,/ 需要/ 结合/ 从/ 两幅/ 投影图/ 像/ 上/ 得到/ 的/ 外部/ 能量/ ./ 文献/ [/ 7/ ]/ 提出/ 了/ 三维/ Snake/ 外部/ 能量/ 的/ 一般/ 表达式/ ,/ 本文/ 为了/ 便于/ 解释/ ,/ 抽象/ 出/ 造影/ 角度/ 为/ 90/ °/ 的/ 特殊/ 情况/ ,/ 对/ 此时/ Snake/ 的/ 外部/ 能量/ 作出/ 直观/ 的/ 分析/ ./ Snake/ 上/ 每/ 一个点/ 的/ 外部/ 能量/ 函数/ 是/ 一个/ 包含/ X/ ,/ Y/ ,/ Z/ 方向/ 上/ 的/ 三维/ 的/ 向量/ 犈/ ext/ (/ X/ ,/ Y/ ,/ Z/ )/ ./ 在/ 图/ 1/ 中/ ,/ 两/ 光轴/ 互相/ 垂直/ ,/ 并且/ 世界/ 坐标系/ 中/ X/ 轴/ 与/ 光源/ A/ 的/ 光轴/ 重合/ ,/ Z/ 轴/ 与/ 光源/ B/ 的/ 光轴/ 重合/ ./ 这/ 意味着/ 在/ 世界/ 坐标系/ 中/ ,/ 只有/ 一个/ 轴能/ 同时/ 投影/ 到/ 两个/ 图像/ 平面/ 上/ ,/ 在/ 图/ 1/ 中即/ 为/ Y/ 轴/ ,/ 而/ X/ 和/ Z/ 轴/ 只能/ 分别/ 在/ 平面/ A/ 和/ 平面/ B/ 上/ 有/ 投影/ ./ 于是/ 反映/ 到/ Snake/ 上/ 每/ 一点/ 的/ 能量/ 函数/ 的/ 分量/ 犈/ ext/ (/ X/ )/ ,/ 犈/ ext/ (/ Z/ )/ 可以/ 分别/ 从/ 图像/ 平面/ A/ ,/ B/ 中/ 得到/ ,/ 犈/ ext/ (/ Y/ )/ 则/ 是从/ 两幅/ 图像/ 上/ 获得/ 的/ 能量/ 的/ 平均/ ./ 如前所述/ ,/ 外部/ 能量/ 从/ 图像/ 特征/ 中/ 获得/ ,/ 最/ 简单/ 的/ 外部/ 能量/ 可以/ 定义/ 为/ Eext/ =/ I/ (/ x/ ,/ y/ )/ ,/ 若/ 是/ 令/ Snake/ 吸引/ 到/ 具有/ 较大/ 图像/ 梯度/ 的/ 边缘/ ,/ 则/ 定义/ :/ Eext/ =/ -/ |/ / I/ (/ x/ ,/ y/ )/ |/ 2/ [/ 6/ ]/ ,/ / 表示/ 图像/ 的/ 梯度/ ./ 但是/ 由于/ 血管/ 弯曲/ 的/ 特性/ ,/ 必然/ 存在/ 许多/ 弯曲/ 度/ 较大/ 的/ 区域/ ,/ 在/ Snake/ 中/ ,/ 深度/ 凹陷/ 区域/ 的/ 拟合/ 是/ 一个/ 难点/ ,/ 为此/ 我们/ 采用/ 文献/ [/ 10/ ]/ 提出/ 的/ GVFSnake/ 模型/ 极大/ 地/ 改善/ 了/ 这个/ 问题/ ./ 将/ 原始/ 的/ 能量/ 场/ 方程/ (/ 9/ )/ 中/ 的/ / Eext/ 由/ GVF/ 场/ G/ (/ x/ ,/ y/ )/ 代替/ ,/ α/ vss/ (/ s/ )/ -/ β/ vssss/ (/ s/ )/ +/ G/ =/ 0/ ,/ G/ (/ x/ ,/ y/ )/ =/ (/ u/ (/ x/ ,/ y/ )/ ,/ v/ (/ x/ ,/ y/ )/ )/ 是/ 可以/ 最小化/ 能量/ 方程/ ε/ =/ / μ/ (/ u2x/ +/ u2/ 的/ 向量场/ ,/ 其中/ f/ (/ x/ ,/ y/ )/ 是/ 边缘/ 信息/ ,/ μ/ 为/ 归一化/ 参数/ ./ 4.2/ 最小化/ 能量/ 函数/ 总/ 的/ Snake/ 能量/ 为/ 内部/ 能量/ 和/ 外部/ 能量/ 之/ 和/ E/ =/ Eint/ +/ Eext/ ./ Snake/ 模型/ 的/ 目标/ 就是/ 要/ 找到/ 在/ 式/ (/ 10/ )/ 中/ 定义/ 的/ E/ 的/ 局部/ 最小值/ ./ 由于/ 该/ 能量/ 函数/ 可以/ 得到/ 独立/ 的/ 欧拉/ 方程/ (/ 9/ )/ ,/ 因此/ ,/ 寻找/ 能量/ 最小化/ 的/ Snake/ 的/ 运动/ 过程/ 就/ 等同于/ 找到/ 这个/ 偏/ 微分方程/ 的/ 解/ ./ 假设/ Snake/ 上/ 有/ N/ 个点/ ,/ vj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ )/ 为/ 其中/ 一点/ ./ 我们/ 采用/ semi/ _/ implicit/ 最小化/ 方法/ [/ 12/ ]/ 得到/ 迭代/ 函数/ :/ pvt/ +/ 1/ 其中/ t/ 代表/ 迭代/ 次数/ ,/ p/ ,/ q/ ,/ r/ 分别/ 代表/ 相应/ 的/ 权/ Page6/ 值/ [/ 15/ ]/ ,/ 由此可见/ Snake/ 上/ 的/ 每/ 一点/ 是/ 受/ 其/ 前后/ 5/ 个点/ 共同/ 影响/ 的/ ,/ 于是/ 可/ 得到/ 矩阵/ 方程/ :/ rqppq/ 熿/ qrqpppqrqp/ / / / / / ppqrq/ 燀/ qppq/ 但/ 由此/ 方程/ 可以/ 看到/ ,/ 头/ 两点/ v0/ ,/ v1/ 受尾/ 两点/ vN/ -/ 1/ ,/ vN/ -/ 2/ 影响/ ,/ 反之/ ,/ 尾/ 两点/ vN/ -/ 1/ ,/ vN/ -/ 2/ 也/ 是/ 受头/ 两点/ v0/ ,/ v1/ 影响/ ,/ 由于/ 血管/ 的/ Snake/ 模型/ 并/ 不是/ 一个/ 闭合/ 轮廓/ ,/ 因此/ 需要/ 对此/ 方程/ 做/ 相应/ 的/ 变化/ ./ 在/ 这里/ ,/ 通过/ 第/ 3/ 节/ 的/ Snake/ 模型/ 的/ 初始化/ ,/ 我们/ 认为/ 选定/ 的/ 初始/ 点/ 是/ 准确/ 的/ ,/ 则/ 需要/ 对/ 由/ 每/ 两个/ 相邻/ 的/ 初始/ 点/ 确定/ 的/ 线段/ 做/ Snake/ 形变/ ./ 令/ 每条/ 这样/ 的/ 线段/ 的/ 头尾/ 点为/ v0/ ,/ vN/ -/ 1/ ,/ 因为/ 他们/ 是/ 选定/ 的/ 初始/ 点/ ,/ 因此/ 他们/ 不/ 需要/ 在/ 空间/ 中有/ 任何/ 变化/ ./ 并且/ 由于/ Snake/ 上/ 的/ 点/ 是/ 紧密/ 相连/ 的/ ,/ 认为/ 紧/ 挨着/ 初始/ 点/ 的/ Snake/ 上/ 的/ 第/ 2/ 个点/ v1/ ,/ vN/ -/ 2/ 也/ 是/ 不变/ 的/ ./ 为此/ ,/ 我们/ 将/ 方程/ (/ 11/ )/ 重新/ 写为/ rqp/ 熿/ qrqppqrqp/ / / / / / 燀/ 燅/ 烐/ 烏/ 其中/ 于是/ ,/ 结合/ GVF/ 外部/ 能量/ 函数/ 原/ 方程/ 可/ 简写/ 为/ vt/ +/ 1/ =/ 犕/ -/ 1/ (/ vt/ +/ δ/ t/ ·/ G/ -/ 犆/ )/ ./ 令此/ 目标/ 函数/ 分别/ 对/ x/ (/ s/ )/ ,/ y/ (/ s/ )/ ,/ z/ (/ s/ )/ 进行/ 迭代/ ,/ 直到/ 重建/ 出来/ 的/ 血管/ 在/ 两幅/ 图像/ 上/ 的/ 投影/ 与/ 血管/ 的/ 真实/ 轮廓/ 间/ 的/ 误差/ 达到/ 要求/ 的/ 误差/ 范围/ 即可/ ./ 5/ 实验/ 结果/ 这里/ 我们/ 采用/ 两幅/ 经过/ 预处理/ 的/ 成像/ 夹角/ 为/ 90/ °/ 的/ 血管/ 造影/ 图像/ 来/ 进行/ 重建/ ,/ 如图/ 5/ ./ 其中/ ,/ 已知/ X光/ 源到/ 两个/ 平面/ 的/ 距离/ SID/ 为/ 600mm/ ,/ 到/ 光心/ 的/ 距离/ 为/ 200mm/ ,/ 图像/ 分辨率/ 为/ 28/ 像素/ // cm/ ./ 图/ 6/ 为/ 采用/ Gabor/ 滤波器/ 提取/ 的/ 中轴/ ,/ 并/ 选定/ 左图/ 中/ 血管/ 的/ 起止点/ ,/ 分叉/ 点/ 描述/ 血管/ 树/ 大致/ 轮廓/ ,/ 在/ 右图/ 中/ 采用/ 外极线/ 方法/ 寻找/ 匹配/ 的/ 血管/ 分支/ ,/ 并/ 找到/ 相应/ 的/ 对应点/ ./ 其中/ 不同/ 的/ 血管/ 分支/ 上/ 的/ 点用/ 不同/ 的/ 形状/ 的/ 点/ 表示/ ./ 图/ 6/ 采用/ Gabor/ 滤波器/ 提取/ 中轴/ 并/ 选定/ 对应点/ (/ 1/ )/ 优化/ 几何变换/ 矩阵/ 前后/ 的/ 实验/ 结果/ 比较/ 图/ 7/ (/ a/ )/ 为/ 未/ 经过/ 几何变换/ 矩阵/ 优化/ 的/ 初始/ Snake/ 在/ 平面/ 图像/ 上/ 的/ 投影/ ,/ 可以/ 看到/ 由于/ 造影/ 角度/ ,/ X射线/ 源到/ 接受/ 平面/ 的/ 距离/ 等/ 存在/ 一定/ 的/ 误差/ ,/ 不能/ 很/ 好/ 地/ 反应/ 两幅/ 图像/ 间/ 的/ 几何/ 变化/ 关系/ ./ 从而/ 图/ 7/ 经过/ 几何变换/ 矩阵/ 优化/ 前后/ 的/ 初始/ Snake/ 形态/ 对比/ Page7/ 导致/ 外极线/ 的/ 位置/ 发生/ 偏移/ ,/ 从而/ 影响/ 外极线/ 匹配/ 的/ 准确性/ ,/ 并且/ 直接/ 影响/ 到/ 重建/ 结果/ ,/ 使/ 由/ 对应点/ 重建/ 出来/ 的/ 三维/ 控制点/ 的/ 投影/ 与/ 原/ 对应点/ 不能/ 完全/ 重合/ ,/ 存在/ 一定/ 的/ 误差/ ./ 在/ 优化/ 几何变换/ 矩阵/ 之后/ ,/ 我们/ 得到/ 两幅/ 图像/ 真实/ 的/ 夹角/ 约/ 为/ 89.5/ °/ ,/ 两/ 光源/ 到/ 左右两/ 图像/ 平面/ 的/ 距离/ 分别/ 为/ 591mm/ 和/ 595mm/ ./ 可以/ 看到/ 在/ 这种/ 情况/ 下/ 将/ 重建/ 出/ 的/ 控制点/ 投影/ 到/ 图像/ 上/ 的/ 与/ 原/ 对应点/ 完全/ 重合/ ./ (/ 2/ )/ 选择/ 不同/ 外部/ 能量/ 场/ 的/ 实验/ 结果/ 比较/ 图/ 8/ 为/ 对/ 图/ 6/ 已/ 提取/ 中轴/ 的/ 图像/ 采用/ 图像/ 强度/ I/ 作为/ 外部/ 能量/ 场/ 与/ 采用/ GVF/ 计算/ 外部/ 能量/ 场/ 的/ 图/ 8/ 采用/ 图像/ 强度/ I/ 作为/ 外部/ 能量/ 场/ 与/ 采用/ GVF/ 图/ 9/ 未/ 经过/ 几何变换/ 矩阵/ 优化/ 和/ 采用/ 标准/ 能量/ 场/ 的/ Snake/ 重建/ 血管/ 中轴/ 的/ 过程/ (/ 实线/ 表示/ 真实/ 造影/ 血管/ 中/ 区别/ 示意图/ ,/ 从图/ 8/ (/ a/ )/ 和/ (/ b/ )/ 中/ 可以/ 看出/ ,/ 传统/ 的/ 外部/ 能量/ 场中/ ,/ 在/ 远离/ 血管/ 轮廓/ 的/ 时候/ 外部/ 能量/ 迅速/ 消失/ ,/ 而/ 在/ GVF/ 能量/ 场中/ ,/ 可以/ 看到/ 它/ 拥有/ 更大/ 的/ 外部/ 能量/ 捕获/ 范围/ ,/ 这/ 将/ 使得/ 即使/ Snake/ 初始/ 轮廓/ 在/ 离/ 真实/ 轮廓/ 较远/ 的/ 位置/ ,/ 也/ 能/ 被/ 迅速/ 吸引/ 到/ 真实/ 轮廓/ 处/ ./ 从图/ 8/ (/ d/ )/ 局部/ 放大/ 的/ 能量/ 场中/ 可以/ 看出/ 在/ GVF/ 向量/ 血管/ 顶端/ 的/ 的/ 凹陷处/ 有/ 向上/ 和/ 向/ 两侧/ 的/ 分量/ ,/ 由此/ 可以/ 将/ Snake/ 吸引/ 到/ 血管/ 中/ 的/ 凹陷/ 部分/ ,/ 而/ 这个/ 与/ 标准/ 外部/ 能量/ 场图/ 8/ (/ c/ )/ 中/ 方向/ 杂乱/ 的/ 向量/ 有着/ 很大/ 的/ 区别/ ,/ 也/ 是/ 对/ 其/ 很/ 明显/ 的/ 改善/ ./ (/ 3/ )/ 不同/ 方法/ 的/ 重建/ 精度/ 实验/ 结果/ 比较/ 图/ 9/ 、/ 图/ 10/ 显示/ 了/ 重建/ 过程/ 中/ Snake/ 不断/ 发生/ 形变/ 的/ 过程/ ,/ 其中/ T/ 表示/ 迭代/ 次数/ ,/ T/ =/ 0/ 时/ ,/ 为/ 初始/ 的/ Snake/ 到/ 两幅/ 已/ 提取/ 血管/ 中轴/ 的/ 图像/ 的/ 投影/ ./ 图/ 9/ 表示/ 的/ 是/ 未/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采用/ 标准/ 能量/ 场/ 的/ Snake/ 的/ 重建/ 过程/ ./ 图/ 10/ 表示/ 的/ 是/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采用/ GVF/ 能量/ 场/ 代替/ 标准/ 能量/ 场/ 的/ Snake/ 的/ 重建/ 过程/ ./ 可以/ 看出/ 图/ 9/ 中/ ,/ 由于/ 没有/ 得到/ 准确/ 的/ 图像/ 间/ 的/ 几何/ 关系/ ,/ 造成/ 血管/ 的/ 重建/ 精度/ 不高/ ./ 另外/ 由图/ 9/ 、/ 图/ 10/ 对比/ 看出/ 在/ 使用/ GVF/ 能量/ 场/ 代替/ 标准/ 能量/ 场后/ ,/ Snake/ 的/ 收敛/ 速度/ 较快/ ./ 在/ 经过/ 60/ 次/ 的/ 迭代/ 后/ ,/ 图/ 10/ 空间/ 中/ 的/ Snake/ 在/ 两幅/ 图像/ 上/ 的/ 投影/ 与/ 真实/ 的/ 血管/ 中轴/ 轮廓/ 重合/ ,/ 而/ 在/ 图/ 9/ 中/ 明显/ 还/ 未/ 达到/ ./ 我们/ 以式/ (/ 4/ )/ 来/ 表示/ 三维/ 血管/ 树上/ 每/ 一点/ 的/ 重建/ 误差/ ./ 图/ 11/ 是/ 迭代/ 过程/ 中/ ,/ 不同/ 重建/ 方法/ 的/ 误差/ 示意图/ ,/ 它/ 表示/ 了/ 未/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采/ Page8/ 图/ 10/ 经过/ 几何变换/ 矩阵/ 优化/ 和/ 采用/ GVF/ 作为/ 能量/ 场/ 的/ Snake/ 三维重建/ 血管/ 中轴/ 的/ 过程/ (/ 实线/ 表示/ 真实/ 用/ 标准/ 能量/ 场/ 的/ Snake/ 与/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采用/ GVF/ 能量/ 场/ 代替/ 标准/ 能量/ 场/ 的/ Snake/ 的/ 重建/ 平均误差/ (/ 分别/ 以/ 和/ 表示/ ,/ 每/ 迭代/ 10/ 次/ 计算/ 一次/ 平均误差/ )/ ./ 其中/ 横轴/ 表示/ 迭代/ 次数/ ,/ 纵轴/ 表示/ 重建/ 平均误差/ ,/ 单位/ 为/ 像素/ ./ 可以/ 看到/ ,/ 两种/ 情况/ 下/ ,/ 初始状态/ 时/ ,/ 误差/ 在/ 8/ 像素/ 左右/ ,/ 在/ 迭代/ 过程/ 中/ ,/ 采用/ GVF/ 能量/ 场/ 的/ Snake/ 的/ 重建/ 误差/ 迅速/ 下降/ ,/ 当/ 迭代/ 次数/ 到达/ 60/ 左右/ 的/ 时候/ ,/ 平均误差/ 趋于稳定/ 在/ 不到/ 一个/ 像素/ 的/ 范围/ ./ 而/ 采用/ 标准/ 能量/ 场/ 的/ Snake/ 迭代/ 80/ 次后/ 才/ 基本/ 达到/ 稳定/ ,/ 同时/ 平均误差/ 在/ 不到/ 2/ 个/ 像素/ 的/ 范围/ 内/ ./ 图/ 11/ 不同/ 重建/ 方法/ 的/ 平均误差/ 示意图/ (/ 表示/ 未/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采用/ 标准/ 能量/ 场/ 的/ Snake/ 的/ 平均/ 重建/ 误差/ ./ 表示/ 经过/ 几何变换/ 矩阵/ 优化/ 并且/ 采用/ GVF/ 能量/ 场/ 代替/ 标准/ 能量/ 场/ 的/ Snake/ 的/ 平均误差/ )/ 表/ 1/ 为/ 两种/ 情况/ 下/ 的/ 重建/ 误差/ 统计表/ ,/ 从表中/ 可以/ 看到/ 优化/ 并/ 采用/ GVF/ 能量/ 场/ 的/ 重建/ 结果/ 明显/ 好于/ 未/ 优化/ 并/ 采用/ 标准/ 能量/ 场/ 的/ 重建/ 结果/ ,/ 达到/ 了/ 较/ 高/ 的/ 重建/ 精度/ ./ 未/ 优化/ 并/ 采用/ 标准/ 能量/ 场/ 3.201/ ./ 00.22/ 优化/ 并/ 采用/ GVF/ 能量/ 场/ 0.500/ ./ 30.12/ 图/ 12/ 为/ 从/ 两个/ 视角/ 观察/ 重建/ 的/ 三维/ 血管/ 的/ 结果/ ./ 在/ 重建/ 过程/ 中/ ,/ 所有/ 的/ 中间/ 过程/ Snake/ 的/ 形态/ 都/ 代表/ 了/ 可能/ 的/ 重建/ 结果/ ./ 在/ 规定/ 了/ 重建/ 误差/ 之后/ ,/ 可以/ 令/ Snake/ 反复/ 迭代/ 直到/ 达到/ 误差/ 范围/ 之内/ 停止/ ./ 图/ 12/ 从/ 两个/ 视角/ 观察/ 三维重建/ 血管/ 的/ 结果/ 6/ 结论/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 基于/ Snake/ 模型/ 的/ 血管/ 树/ 骨架/ 三维重建/ 方法/ ./ 首先/ ,/ 采用/ 基于/ 多/ 尺度/ Gabor/ 滤波/ 的/ 方法/ 对/ DSA/ 图像/ 自动/ 提取/ 血管/ 中轴/ ,/ 该/ 方法/ 能够/ 很/ 好/ 地/ 跟踪/ 血管/ 粗细/ 的/ 变化/ ,/ 从而/ 保证/ 了/ 血管/ 中轴/ 的/ 准确性/ ./ 在/ 中轴/ 上/ 选取/ 对应点/ 比起/ 直接/ 在/ 血管/ 上/ 选取/ 对应点/ 更/ 有利于/ 提高/ 准确性/ 和/ 稳定性/ ,/ 并且/ 在/ 提取/ 中轴/ 的/ 同时/ ,/ 还/ 可/ 记录/ 下/ 中轴/ 上/ 每/ 一点/ 对/ Page9/ 应/ 的/ 血管/ 半径/ 的/ 大小/ ,/ 为/ 最后/ 恢复/ 血管/ 表面/ 打下基础/ ./ 其次/ ,/ 本文/ 根据/ 血管/ 树/ 特殊/ 的/ 树状/ 结构/ ,/ 利用/ 血管/ 树上/ 的/ 分叉/ 点来/ 优化/ 几何变换/ 矩阵/ ,/ 根据/ 透视/ 投影/ 的/ 特点/ 提出/ 6/ 大/ 约束条件/ ,/ 从而/ 得到/ 准确/ 的/ 成像/ 参数/ ,/ 以/ 保证/ 接下来/ 的/ 对应点/ 的/ 寻找/ 和/ 重建/ 的/ 准确度/ ./ 然后/ 我们/ 给定/ 一幅/ 图像/ 上/ 一组/ 能够/ 表达/ 血管/ 中轴/ 大致/ 轮廓/ 的/ 点/ ,/ 并/ 采用/ 外极线/ 方法/ 寻找/ 另/ 一幅/ 图像/ 上/ 匹配/ 的/ 血管/ 分支/ 和/ 血管/ 上/ 的/ 对应点/ ,/ 将/ 这些/ 对应点/ 作为/ 固定点/ 用以/ 确定/ Snake/ 模型/ 的/ 初始/ 轮廓/ ,/ 这样/ 将/ Snake/ 应用/ 于/ 这些/ 固定点/ 之间/ 的/ 部分/ ,/ 从而/ 使/ 血管/ 上/ 的/ 每/ 一点/ 都/ 对/ 重建/ 工作/ 有/ 贡献/ ./ 在/ Snake/ 模型/ 迭代/ 求解/ 过程/ 中/ ,/ 深度/ 凹陷/ 区域/ 的/ 拟合/ 是/ 一个/ 难点/ ,/ 而/ 弯曲/ 的/ 血管/ 又/ 必然/ 存在/ 许多/ 凹陷/ 的/ 区域/ ,/ 因此/ ,/ 本文/ 提出/ 了/ 采用/ GVF/ 流量/ 场/ 作为/ Snake/ 的/ 外部/ 能量/ 场/ ,/ 从而/ 可以/ 较/ 好/ 地/ 表达/ 血管/ 的/ 这/ 一/ 特性/ ./ 在/ 求解/ 能量/ 最小化/ 时/ ,/ Snake/ 的/ 运动/ 是/ 以/ 一个/ 偏/ 微分方程/ 为/ 模型/ ,/ 寻找/ 能量/ 最小化/ 的/ 过程/ 等同于/ 找到/ 这个/ 方程/ 的/ 解/ ./ 本文/ 采用/ 了/ semi/ _/ implicit/ 最小化/ 方法/ ,/ 但是/ 此/ 方法/ 是/ 基于/ 一个/ 闭合/ 的/ 轮廓/ ,/ 由于/ 血管/ 的/ Snake/ 模型/ 是/ 一个/ 非/ 闭合/ 轮廓/ ,/ 因此/ 本文/ 对原/ 方程/ 做/ 了/ 相应/ 的/ 改造/ ,/ 重新得到/ 了/ 非/ 闭合/ 轮廓/ 能量/ 函数/ 最小化/ 的/ 最佳/ 表达式/ ,/ 从而/ 最终/ 得到/ 了/ 精确/ 的/ 重建/ 结果/ ,/ 为/ 恢复/ 血管/ 表面/ 的/ 工作/ 打下/ 了/ 良好/ 的/ 基础/ ./ 实验/ 结果表明/ ,/ 本文/ 提出/ 的/ 重建/ 方法/ 与/ 传统/ 的/ 重建/ 方法/ 相比/ ,/ 不但/ 减少/ 了/ 人工干预/ ,/ 还/ 在/ 重建/ 精度/ 上/ 得到/ 了/ 较大/ 的/ 改善/ ./ 论文/ 下/ 一步/ 的/ 工作/ 将/ 在/ 恢复/ 了/ 三维/ 血管/ 树/ 骨架/ 的/ 基础/ 上/ ,/ 利用/ 记录/ 的/ 血管/ 粗细/ 和/ 血管/ 分割/ 的/ 结果/ 实现/ 血管/ 表面/ 三维重建/ ./ 

