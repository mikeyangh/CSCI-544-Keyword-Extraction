Page1/ 改进/ 的/ 选择/ 密文/ 安全/ 公钥/ 加密/ 方案/ 陈泯融/ 1/ )/ ,/ 2/ )/ 张席/ 3/ )/ 何凯/ 4/ )/ 关超文/ 4/ )/ 刘丹/ 4/ )/ 1/ )/ (/ 深圳大学/ 信息/ 工程学院/ 广东/ 深圳/ 518060/ )/ 2/ )/ (/ 华南/ 师范大学/ 计算机/ 学院/ 广州/ 510631/ )/ 3/ )/ (/ 深圳大学/ 计算机/ 与/ 软件/ 学院/ 广东/ 深圳/ 518060/ )/ 4/ )/ (/ 暨南大学/ 计算机系/ 广州/ 510632/ )/ 摘要/ 如何/ 设计/ 在/ 标准/ 模型/ 下/ 满足/ 适应性/ 选择/ 密文/ 安全/ (/ IND/ -/ CCA2/ )/ 的/ 高效/ 公钥/ 加密/ 方案/ ,/ 是/ 公钥/ 密码学/ 领域/ 中/ 的/ 一个/ 重要/ 研究课题/ ./ 康立/ 等/ 人/ 提出/ 了/ 一个/ 高效/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 认为/ 他们/ 的/ 方案/ 在/ 标准/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ ./ 文中/ 首先/ 对/ 该/ 方案/ 进行/ 分析/ ,/ 通过/ 给出/ 具体/ 的/ 攻击/ 方法/ 表明/ 该/ 方案/ 并/ 不/ 满足/ IND/ -/ CCA2/ 安全/ ./ 然后/ 对/ 该/ 方案/ 进行/ 改进/ 得到/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ 新/ 方案/ 的/ IND/ -/ CCA2/ 安全性/ ./ 关键词/ 公钥/ 加密/ ;/ 标准/ 模型/ ;/ 适应性/ 选择/ 密文/ 攻击/ ;/ 双线性/ 配对/ 1/ 引言/ 码学/ 领域/ 的/ 一个/ 重要/ 研究课题/ ./ 如何/ 设计/ 高效/ 安全/ 的/ 公钥/ 加密/ 方案/ ,/ 是/ 公钥密/ Rackoff/ 和/ Simon/ [/ 1/ ]/ 在/ 1991/ 年/ 提出/ 了/ 适应性/ 选择/ 密文/ 安全/ (/ IND/ -/ CCA2/ )/ 的/ 概念/ ./ 目前/ ,/ IND/ -/ CCA2/ 已/ 成为/ 公钥/ 加密/ 体制/ 的/ 标准/ 安全性/ 要求/ ./ 在/ ACMCCS/ ’/ 93/ 上/ ,/ Bellare/ 和/ Rogaway/ [/ 2/ ]/ 提出/ 了/ 随机/ 预言/ 机/ 模型/ (/ randomoraclemodel/ )/ 的/ 概念/ ,/ 并/ 构建/ 了/ 一/ Page2/ 个/ 在/ 随机/ 预言/ 机/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ 的/ 公钥/ 加密/ 方案/ ./ 然而/ ,/ 正如/ Canetti/ 等/ 人/ [/ 3/ ]/ 所/ 指出/ 的/ ,/ 在/ 随机/ 预言/ 机/ 模型/ 下/ 证明/ 安全/ 的/ 公钥/ 密码/ 方案/ 在/ 实际/ 中/ 可能/ 是/ 不/ 安全/ 的/ ,/ 因为/ 随机/ 预言/ 机/ 模型/ 与/ 真实世界/ 存在/ 着/ 一定/ 的/ 差距/ ,/ 在/ 真实/ 环境/ 中/ 攻击者/ 掌握/ Hash/ 函数/ 的/ 细节/ 信息/ 而/ 在/ 随机/ 预言/ 机/ 模型/ 中/ Hash/ 函数/ 对于/ 攻击者/ 是/ 个/ 黑盒子/ ./ 因此/ ,/ 不/ 依赖/ 随机/ 预言/ 机/ 模型/ (/ 即/ 标准/ 模型/ )/ 下/ 满足/ IND/ -/ CCA2/ 安全/ 的/ 公钥/ 加密/ 方案/ 更加/ 具有/ 吸引力/ ./ 在/ Crypto/ ’/ 98/ 上/ ,/ Cramer/ 和/ Shoup/ [/ 4/ ]/ 提出/ 了/ 首个/ 在/ 标准/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ 的/ 高效/ 公钥/ 加密/ 方案/ (/ 简称/ 为/ “/ CS/ 方案/ ”/ )/ ,/ 该/ 方案/ 的/ 安全性/ 是/ 基于/ 判定/ 型迪菲/ -/ 赫尔曼/ (/ DDH/ )/ 假设/ 的/ ./ 在/ ACMCCS/ ’/ 05/ 上/ ,/ Boyen/ 等/ 人/ [/ 5/ ]/ 利用/ 双线性/ 配对/ (/ bilinearpairing/ )/ 这一/ 工具/ ,/ 提出/ 了/ 一个/ 标准/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ 的/ 公钥/ 加密/ 方案/ (/ 简称/ 为/ “/ BMW/ 加密/ 方案/ ”/ )/ ,/ 该/ 方案/ 能够/ 支持/ 密文/ 公开/ 可验证/ 性/ (/ 即/ 任何人/ 无需/ 私钥/ 都/ 可以/ 验证/ 密文/ 的/ 有效性/ )/ ./ 随后/ ,/ 学术界/ 提出/ 了/ 一些/ 标准/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ 的/ 公钥/ 加密/ 方案/ ,/ 如/ 文献/ [/ 6/ -/ 10/ ]/ 等/ ./ 近年/ ,/ 康立/ 等/ 人/ [/ 11/ ]/ 提出/ 了/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ./ 该/ 方案/ 具有/ 很/ 高/ 的/ 效率/ ,/ 能够/ 支持/ 密文/ 公开/ 可验证/ ,/ 并/ 认为/ 可以/ 在/ 标准/ 模型/ 下/ 满足/ IND/ -/ CCA2/ 安全/ ./ 然而/ ,/ 遗憾/ 的/ 是/ ,/ 本文/ 通过/ 给出/ 的/ 具体/ 攻击/ 方法/ ,/ 表明/ 康立/ 等/ 人/ 的/ 公钥/ 加密/ 方案/ 并/ 不/ 满足/ IND/ -/ CCA2/ 安全/ ./ 需要/ 特别/ 指出/ 的/ 是/ ,/ 虽然/ 他们/ 的/ 方案/ 没/ 能/ 满足/ IND/ -/ CCA2/ 安全/ ,/ 但是/ 其/ 方案/ 具有/ 较/ 巧妙/ 的/ 设计/ 思想/ ,/ 确实/ 为/ 公钥/ 加密/ 体制/ 的/ 设计/ 作出/ 了/ 贡献/ ./ 本文/ 在/ 康立/ 等/ 人/ 加密/ 方案/ 的/ 基础/ 上/ ,/ 设计/ 了/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ 所/ 提/ 方案/ 满足/ IND/ -/ CCA2/ 安全/ ./ 本文/ 第/ 2/ 节/ 介绍/ 公钥/ 加密/ 体制/ 定义/ 和/ 安全/ 模型/ 、/ 双线性/ 配对/ 及/ 相关/ 困难/ 问题/ 假设/ 以及/ 目标/ 防/ 碰撞/ Hash/ 函数/ 等/ 基础知识/ ;/ 第/ 3/ 节/ 回顾/ 康立/ 等/ 人/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 通过/ 给出/ 具体/ 的/ 攻击/ 方法/ 表明/ 其/ 方案/ 并/ 不/ 满足/ IND/ -/ CCA2/ 安全/ ;/ 第/ 4/ 节/ 提出/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 该/ 方案/ 满足/ IND/ -/ CCA2/ 安全/ ;/ 第/ 5/ 节对/ 本文/ 进行/ 了/ 总结/ ./ 2/ 预备/ 知识/ 2.1/ 符号/ 说明/ 对于/ 一个/ 有限/ 集合/ S/ ,/ 令/ x/ ∈/ S/ 表示/ 从/ S/ 中/ 随机/ 均匀/ 选取/ 元素/ x/ ./ 令/ A/ (/ x/ ,/ y/ ,/ …/ )/ 表示/ 一个/ 输入/ 为/ (/ x/ ,/ y/ ,/ …/ )/ 的/ 算法/ A/ ,/ 而/ z/ ←/ A/ (/ x/ ,/ y/ ,/ …/ )/ 表示/ 运行/ 算法/ A/ (/ x/ ,/ y/ ,/ …/ )/ 来/ 得到/ 输出/ z/ ./ 对于/ 一个/ 函数/ f/ (/ ·/ )/ ,/ 若/ 对于/ 任意/ 多项式/ p/ (/ ·/ )/ ,/ 均/ 存在/ 一个/ 自然数/ N/ ,/ 使得/ 对于/ 所有/ n/ >/ N/ ,/ 均/ 有/ f/ (/ N/ )/ </ 1/ 是/ 可/ 忽略/ 的/ ./ 2.2/ 公钥/ 加密/ 定义/ 及/ 安全/ 模型/ 一个/ 公钥/ 加密/ 方案/ 由/ 如下/ 3/ 个/ 算法/ 组成/ :/ (/ 1/ )/ 密钥/ 生成/ 算法/ Setup/ (/ k/ )/ ./ 给定/ 安全/ 参数/ k/ ,/ 该/ 算法/ 输出/ 公钥/ pk/ 和/ 相应/ 的/ 私钥/ sk/ ./ (/ 2/ )/ 加密算法/ Enc/ (/ pk/ ,/ m/ )/ ./ 给定/ 公钥/ pk/ 和/ 明文/ m/ ,/ 该/ 算法/ 输出/ 密文/ C/ ./ (/ 3/ )/ 解密/ 算法/ Dec/ (/ sk/ ,/ C/ )/ ./ 给定/ 私钥/ sk/ 和/ 密文/ C/ ,/ 该/ 算法/ 输出/ 明文/ M/ 或/ ⊥/ ./ 此处/ ⊥/ 意味着/ C/ 为/ 非法/ 密文/ ./ 公钥/ 加密/ 方案/ 的/ IND/ -/ CCA2/ 安全/ 模型/ 可以/ 通过/ 下面/ 的/ 挑战者/ C/ 与/ 敌手/ A/ 之间/ 的/ 游戏/ 来/ 定义/ :/ 系统/ 建立/ 阶段/ ./ 挑战者/ C/ 运行/ 算法/ Setup/ 产生/ 公/ // 私钥/ 对/ (/ pk/ ,/ sk/ )/ ,/ 然后/ 将/ pk/ 交给/ 敌手/ A/ ,/ 而/ 将/ sk/ 秘密/ 保留/ ./ 查询/ 阶段/ 1/ ./ 在/ 本/ 阶段/ ,/ 敌手/ A/ 进行/ 一系列/ 的/ 解密/ 查询/ ./ 当/ 敌手/ A/ 对/ 密文/ C/ 进行/ 解密/ 查询/ 时/ ,/ 挑战者/ C/ 运行/ Dec/ (/ sk/ ,/ C/ )/ 并/ 将/ 结果/ 返回/ 给/ 敌手/ A/ ./ 挑战/ 阶段/ ./ 当/ 敌手/ A/ 决定/ 结束/ 查询/ 阶段/ 1/ 时/ ,/ 它/ 输出/ 两个/ 长度/ 相等/ 的/ 明文/ M0/ ,/ M1/ ./ 挑战者/ C/ 随机/ 选取/ β/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 将/ 挑战/ 密文/ 设定/ 为/ C/ / =/ Enc/ (/ pk/ ,/ M/ β/ )/ ,/ 然后/ 将/ C/ / 返回/ 给/ 敌手/ A/ ./ 查询/ 阶段/ 2/ ./ 敌手/ A/ 继续/ 进行/ 一系列/ 的/ 解密/ 查询/ ,/ 挑战者/ C/ 采取/ 与/ Phase1/ 相同/ 的/ 方法/ 进行/ 应答/ ./ 此处/ 要求/ 敌手/ A/ 不能/ 对/ C/ / 进行/ 解密/ 查询/ ./ 猜测/ 阶段/ ./ 最后/ ,/ 敌手/ A/ 输出/ 对/ β/ 的/ 猜测/ β/ ./ 将/ 上述/ 敌手/ A/ 称为/ IND/ -/ CCA2/ 敌手/ ,/ 并/ 将/ 它/ 攻击/ 上述/ 公钥/ 加密/ 方案/ 的/ 优势/ 定义/ 为/ 若/ 对于/ 任意/ 概率/ 性/ 多项式/ 时间/ (/ PPT/ )/ 敌手/ A/ ,/ 它/ 针对/ 一个/ 公钥/ 加密/ 方案/ 的/ 优势/ AdvIND/ -/ CCA2/ 忽略/ 的/ (/ negligible/ )/ ,/ 则/ 称/ 该/ 公钥/ 加密/ 方案/ 是/ IND/ -/ CCA2/ 安全/ 的/ ./ 2.3/ 双线性/ 配对/ 映射/ 及/ 困难性/ 问题/ 设/ G/ 和/ GT/ 为/ 素数/ p/ 阶/ 循环群/ ./ 满足/ 如下/ 3/ 个/ 条件/ 的/ 映射/ e/ :/ G/ ×/ G/ →/ GT/ 称为/ 双线性/ 配对/ 映射/ :/ (/ 1/ )/ 双线性/ ./ 对于/ / g1/ ,/ g2/ ∈/ G/ 及/ / a/ ,/ b/ ∈/ Z/ / 有/ e/ (/ ga1/ ,/ gb2/ )/ =/ e/ (/ g1/ ,/ g2/ )/ ab/ 成立/ ;/ (/ 2/ )/ 非/ 退化/ 性/ ./ / g1/ ,/ g2/ ∈/ G/ 满足/ e/ (/ g1/ ,/ g2/ )/ ≠/ 1GT/ ,/ 其中/ 1GT/ 为群/ GT/ 的/ 一个/ 单位/ 元/ ./ Page3/ 若/ 对于/ 任意/ PPT/ 算法/ β/ ,/ 它/ 针对/ 群组/ (/ G/ ,/ GT/ )/ 上/ (/ 3/ )/ 可计算性/ ./ 存在/ 有效/ 算法/ ,/ 对于/ / g1/ ,/ g2/ ∈/ G/ ,/ 均/ 可/ 计算/ e/ (/ g1/ ,/ g2/ )/ 的/ 值/ ./ 设/ G/ 和/ GT/ 均/ 为/ 素数/ p/ 阶群/ ,/ 则/ 群组/ (/ G/ ,/ GT/ )/ 上/ 的/ 判断/ 型/ 双线性/ Diffie/ -/ Hellman/ (/ DBDH/ )/ 问题/ 为/ :/ 给定/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ )/ ∈/ G4/ ×/ GT/ ,/ 对于/ 未知/ 的/ a/ ,/ b/ ,/ p/ ,/ 判断/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ 是否/ 成立/ ./ 对于/ 一个/ PPTc/ ∈/ Z/ / 算法/ β/ ,/ 将/ 其/ 针对/ 群组/ (/ G/ ,/ GT/ )/ 上/ 的/ DBDH/ 问题/ 的/ 优势/ 定义/ 为/ β/ =/ |/ Pr/ [/ β/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ ]/ -/ AdvDBDH/ 其中/ a/ ,/ b/ ,/ c/ ,/ z/ ∈/ RZ/ / 的/ DBDH/ 问题/ 的/ 优势/ AdvDBDH/ (/ G/ ,/ GT/ )/ 上/ 的/ DBDH/ 假设/ 成立/ ./ 2.4/ 目标/ 防/ 碰撞/ Hash/ 函数/ 设/ F/ 是/ 一个/ Hash/ 函数/ 族/ ,/ 该/ 函数/ 族/ 内/ 的/ 任意/ Hash/ 函数/ H/ 均是由/ 定义域/ D/ 到/ 值域/ R/ 的/ 映射/ ,/ 即/ H/ :/ D/ →/ R/ ./ 对于/ Hash/ 函数/ 族/ F/ 中/ 任意/ 给定/ 的/ Hash/ 函数/ H/ ,/ 将/ 一个/ PPT/ 敌手/ 针对/ H/ 的/ 目标/ 防/ 碰撞/ 性/ (/ TargetCollisionResistance/ ,/ TCR/ )/ 的/ 优势/ 定义/ 为/ AdvTCRPr/ [/ x/ ∈/ D/ ,/ y/ ←/ A/ (/ H/ ,/ x/ )/ :/ H/ (/ x/ )/ =/ H/ (/ y/ )/ ∧/ y/ ≠/ x/ ]/ ./ 若/ 对于/ Hash/ 函数/ 族/ F/ 任意/ 随机/ 选取/ 的/ Hash/ 函数/ H/ 及/ 任意/ PPT/ 敌手/ A/ ,/ 均/ 有/ AdvTCR/ 称该/ Hash/ 函数/ 族/ F/ 是/ 目标/ 防/ 碰撞/ 的/ ./ 在/ 实际/ 应用/ 中/ ,/ 通常/ 可以/ 采用/ 诸如/ SHA/ -/ 1/ 等/ 密码学/ Hash/ 函数/ 作为/ 目标/ 防/ 碰撞/ 的/ Hash/ 函数/ H/ ./ 为/ 方便/ 起/ 见/ ,/ 后文/ 将/ 假定/ 目标/ 防/ 碰撞/ 的/ Hash/ 函数/ H/ 为/ 一个/ 固定/ 的/ 函数/ ./ 3/ 对康立/ 等/ 人/ 方案/ 的/ 安全性/ 分析/ 3.1/ 康立/ 等/ 人/ 的/ 公钥/ 加密/ 方案/ A/ =/ 其公钥/ 加密/ 方案/ 由/ 如下/ 算法/ 组成/ [/ 11/ ]/ :/ (/ 1/ )/ 系统/ 建立/ 算法/ Setup/ (/ k/ )/ ./ 选取/ kbit/ 素数/ p/ 阶/ 双线性/ 配对/ 群组/ (/ G/ ,/ GT/ )/ ,/ 其中/ g/ 为/ G/ 的/ 生成元/ ./ 选取/ 目标/ 防/ 碰撞/ Hash/ 函数/ H1/ :/ {/ 0/ ,/ 1/ }/ / →/ Zp/ 和/ H2/ :/ G/ →/ G/ ./ 随机/ 选取/ a/ ∈/ Z/ / g1/ =/ ga/ ./ 最后/ 输出/ 公钥/ pk/ =/ (/ g/ ,/ g1/ ,/ X1/ ,/ X2/ )/ 和/ 私钥/ sk/ =/ a/ ./ (/ 2/ )/ 加密算法/ Enc/ (/ pk/ ,/ M/ )/ ./ 随机/ 选取/ r/ ,/ τ/ ∈/ Z/ / 然后/ 计算/ 密文/ C0/ =/ H2/ (/ gr/ 其中/ w/ =/ H1/ (/ C0/ ,/ C1/ )/ ./ 最后/ 输出/ 密文/ C/ =/ (/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ )/ ./ (/ 3/ )/ 解密/ 算法/ Dec/ (/ sk/ ,/ C/ )/ ./ 给定/ 密文/ C/ =/ (/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ )/ ,/ 该/ 算法/ 首先/ 计算/ w/ =/ H1/ (/ C0/ ,/ C1/ )/ ,/ 然后/ 验证/ e/ (/ C1/ ,/ Xw/ 则/ 拒绝/ 该/ 密文/ ;/ 否则/ 利用/ 私钥/ sk/ =/ a/ 按照/ 如下/ 方法/ 恢复/ 明文/ :/ M/ ←/ C03/ ./ 2/ 攻击/ 方法/ 加密/ 方案/ 的/ IND/ -/ CCA2/ 安全性/ :/ 钥/ pk/ =/ (/ g/ ,/ g1/ ,/ X1/ ,/ X2/ )/ ./ 下面/ 给出/ 一个/ PPT/ 敌手/ 来/ 攻破/ 康立/ 等/ 人公钥/ (/ 1/ )/ 在/ 系统/ 建立/ 阶段/ ,/ 敌手/ 从/ 挑战者/ 处/ 获得/ 公/ (/ 2/ )/ 在/ 查询/ 阶段/ 1/ ,/ 敌手/ 无需/ 进行/ 任何/ 解密/ 查询/ ./ (/ 3/ )/ 在/ 挑战/ 阶段/ ,/ 敌手/ 提交/ 两个/ 等长/ 的/ 明文/ M0/ 和/ M1/ ,/ 然后/ 获得/ 挑战/ 密文/ C/ / =/ Enc/ (/ pk/ ,/ M/ β/ )/ ./ 根据/ 康立/ 等/ 人/ 的/ 方案/ 描述/ ,/ 挑战/ 密文/ C/ / =/ (/ C/ / 0/ ,/ C/ / 1/ ,/ C/ / 2/ ,/ C/ / 3/ )/ 为/ 如下/ 形式/ :/ C/ / 0/ =/ H2/ (/ gr/ 其中/ w/ / =/ H1/ (/ C/ / 0/ ,/ C/ / 1/ )/ ./ (/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ )/ :/ (/ 4/ )/ 在/ 查询/ 阶段/ 2/ ,/ 敌手/ 首先/ 构造/ 如下/ 密文/ C/ =/ C0/ =/ 2C/ / 0/ =/ H2/ (/ grC2/ =/ (/ C/ / 2/ )/ wC3/ =/ τ/ =/ w/ 其中/ w/ =/ H1/ (/ C0/ ,/ C1/ )/ ./ 注意/ 到/ C/ =/ (/ C0/ ,/ C1/ ,/ C2/ ,/ C3/ )/ 实际上/ 是/ 针对/ 明文/ 2M/ β/ 的/ 一个/ 密文/ ,/ 且/ 可以/ 通过/ 密文/ 有效性/ 检验/ :/ e/ (/ C1/ ,/ Xw/ 然后/ ,/ 敌手/ 对/ C/ 进行/ 解密/ 查询/ ./ 注意/ 到/ 由于/ C/ ≠/ C/ / ,/ 敌手/ 对/ C/ 进行/ 解密/ 查询/ 是/ 合法/ 的/ ./ 因此/ ,/ 敌手/ 将/ 可以/ 获得/ 密文/ C/ 对应/ 的/ 明文/ 2M/ β/ ,/ 进而/ 获得/ M/ β/ ./ 知道/ M/ β/ 的/ 值/ ,/ 敌手/ 当然/ 可以/ 通过/ 与/ (/ M0/ ,/ M1/ )/ 进行/ 比较/ 来/ 获得/ β/ 的/ 值/ ,/ 从而/ 攻破/ 康立/ 等/ 人/ 加密/ 方案/ 的/ IND/ -/ CCA2/ 安全性/ ./ 4/ 改进/ 方案/ 本节/ 在/ 康立/ 等/ 人/ 的/ 公钥/ 加密/ 方案/ 的/ 基础/ 上/ ,/ 给出/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 所提/ 方案/ 满足/ IND/ -/ CCA2/ 安全/ ./ Page44/ ./ 1/ 方案/ 描述/ 本文/ 的/ 改进/ 方案/ 由/ 如下/ 算法/ 组成/ :/ (/ 1/ )/ 系统/ 建立/ 算法/ Setup/ (/ k/ )/ ./ 选取/ kbit/ 素数/ p/ 阶/ 双线性/ 配对/ 群组/ (/ G/ ,/ G1/ )/ ,/ 其中/ g/ 为/ G/ 的/ 生成元/ ./ 选取/ 目标/ 防/ 碰撞/ Hash/ 函数/ H/ :/ G2/ →/ Zp/ ./ 随机/ 选取/ 和/ X1/ ,/ X2/ ,/ X3/ ∈/ G/ ,/ 并/ 计算/ g1/ =/ gx/ ./ 最后/ 输出/ 公钥/ pk/ =/ (/ g/ ,/ g1/ ,/ X1/ ,/ X2/ ,/ X3/ )/ 和/ 私钥/ sk/ =/ x/ ./ (/ 2/ )/ 加密算法/ Enc/ (/ pk/ ,/ M/ )/ ./ 给定/ 明文/ M/ ∈/ GT/ ,/ 该/ 算法/ 首先/ 随机/ 选取/ τ/ ,/ τ/ ∈/ Z/ / C0/ =/ e/ (/ g1/ ,/ X3/ )/ rM/ ,/ C1/ =/ gr/ ,/ C2/ =/ (/ Xw/ 其中/ w/ =/ H/ (/ C0/ ,/ C1/ )/ ./ 最后/ 输出/ 密文/ C/ =/ (/ τ/ ,/ C0/ ,/ C1/ ,/ C2/ )/ ./ (/ 3/ )/ 解密/ 算法/ Dec/ (/ sk/ ,/ C/ )/ ./ 给定/ 密文/ C/ =/ (/ τ/ ,/ C0/ ,/ C1/ ,/ C2/ )/ ,/ 该/ 算法/ 首先/ 计算/ w/ =/ H/ (/ C0/ ,/ C1/ )/ ,/ 然后/ 验证/ e/ (/ C1/ ,/ Xw/ 拒绝/ 该/ 密文/ ;/ 否则/ 利用/ 私钥/ sk/ =/ x/ 恢复/ 明文/ 4.2/ 安全性/ 证明/ 定理/ 1/ ./ 假设/ H/ 是/ 一个/ 目标/ 防/ 碰撞/ 的/ Hash/ 函数/ 且/ 群组/ (/ G/ ,/ GT/ )/ 中/ 的/ DBDH/ 假设/ 成立/ ./ 那么/ ,/ 本文/ 方案/ 是/ IND/ -/ CCA2/ 安全/ 的/ ./ 证明/ ./ 不失/ 一般性/ ,/ 假设/ H/ 是/ 一个/ 目标/ 防/ 碰撞/ 的/ Hash/ 函数/ ./ 若/ 存在/ 一个/ 多项式/ 时间/ 敌手/ A/ 能够/ 以/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ 本文/ 所提/ 方案/ 的/ IND/ -/ CCA2/ 安全性/ ,/ 那么/ 将/ 可以/ 构造/ 多项式/ 时间/ 算法/ B/ 以/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ 群组/ (/ G/ ,/ GT/ )/ 中/ 的/ DBDH/ 假设/ ,/ 其中/ ε/ 满足/ 其中/ qd/ 为/ 敌手/ 进行/ 解密/ 查询/ 的/ 次数/ ./ 给定/ DBDH/ 实例/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ )/ ∈/ G4/ ×/ GT/ ,/ 其中/ a/ ,/ b/ ,/ c/ 为/ Z/ / 是/ 判断/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ 是否/ 成立/ ./ 按照/ IND/ -/ CCA2/ 游戏/ 的/ 规则/ ,/ 算法/ B/ 和/ 敌手/ A/ 按照/ 如下/ 方式/ 进行/ 交互/ :/ 系统/ 建立/ 阶段/ ./ B/ 选取/ α/ 1/ ,/ α/ 2/ ,/ α/ 3/ ,/ β/ 1/ ,/ β/ 2/ ,/ β/ 3/ ∈/ Z/ / 然后/ 计算/ g1/ =/ ga/ ,/ X1/ =/ (/ gb/ )/ α/ 1g/ β/ 1/ ,/ X2/ =/ (/ gb/ )/ α/ 2g/ β/ 2/ ,/ X3/ =/ (/ gb/ )/ α/ 3g/ β/ 3/ ,/ 并/ 将/ 公钥/ pk/ =/ (/ g/ ,/ g1/ ,/ X1/ ,/ X2/ ,/ X3/ )/ 交给/ 敌手/ A/ ./ 查询/ 阶段/ 1/ ./ 如/ IND/ -/ CCA2/ 游戏/ 所述/ ,/ 敌手/ A/ 在/ 本/ 阶段/ 可以/ 进行/ 一系列/ 解密/ 查询/ ./ 当/ 敌手/ A/ 对/ 密文/ C/ =/ (/ τ/ ,/ C0/ ,/ C1/ ,/ C2/ )/ 进行/ 解密/ 查询/ 时/ ,/ 算法/ B/ 首先/ 计算/ w/ =/ H/ (/ C0/ ,/ C1/ )/ ,/ 并/ 检查/ e/ (/ C1/ ,/ Xw/ 是否/ 成立/ ./ 若/ 不/ 成立/ ,/ 则/ 拒绝/ 该/ 密文/ ;/ 否则/ ,/ 进一步/ 检查/ α/ 1w/ +/ α/ 2/ τ/ +/ α/ 3/ =/ 0modp/ 是否/ 成立/ ./ 若/ 成立/ ,/ 算法/ B/ 输出/ 一个/ 随机/ 位/ 并/ 终止/ 游戏/ ;/ 否则/ ,/ 算法/ B/ 计算/ 3/ ←/ (/ (/ gb/ )/ r/ )/ α/ 3C/ β/ 31/ =/ (/ (/ gb/ )/ r/ )/ α/ 3/ (/ gr/ )/ β/ 3/ =/ (/ (/ gb/ )/ α/ 3g/ β/ 3/ )/ rXr/ 然后/ 将/ 明文/ M/ ←/ C0/ 需要/ 指出/ 的/ 是/ ,/ 在/ 公钥/ 参数/ X1/ =/ (/ gb/ )/ α/ 1g/ β/ 1/ ,/ X2/ =/ (/ gb/ )/ α/ 2g/ β/ 2/ 和/ X3/ =/ (/ gb/ )/ α/ 3g/ β/ 3/ 中/ ,/ α/ 1/ ,/ α/ 2/ 和/ α/ 3/ 分别/ 被/ β/ 1/ ,/ β/ 2/ 和/ β/ 3/ 所/ 盲化/ ,/ 因此/ 敌手/ A/ 无法/ 获得/ α/ 1/ ,/ α/ 2/ 和/ α/ 3/ 的/ 任何/ 信息/ ./ 从而/ α/ 1w/ +/ α/ 2/ τ/ +/ α/ 3/ =/ 0modp/ 的/ 概率/ 最多为/ 1/ 挑战/ 阶段/ ./ 敌手/ A/ 输出/ 两个/ 等长/ 的/ 明文/ M0/ ,/ M1/ ∈/ GT/ ./ 算法/ B/ 计算/ C/ / 0/ =/ Q/ α/ 3e/ (/ ga/ ,/ gc/ )/ β/ 3M/ β/ ,/ C/ / 1/ =/ gc/ ,/ w/ / =/ H/ (/ C/ / 0/ ,/ C/ / 1/ )/ ,/ τ/ / =/ -/ α/ 1w/ / +/ α/ 3/ (/ gc/ )/ β/ 1w/ / +/ β/ 2/ τ/ / +/ β/ 3/ ,/ 然后/ 将/ C/ / =/ (/ τ/ / ,/ C/ / 0/ ,/ C/ / 1/ ,/ C/ / 2/ )/ 作为/ 挑战/ 密文/ 交给/ 敌手/ A/ ./ 若/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ 成立/ ,/ 上面/ 所得/ 的/ C/ / 是/ 一个/ 有效/ 密文/ ,/ 这/ 是因为/ :/ C/ / 0/ =/ Q/ α/ 3e/ (/ ga/ ,/ gc/ )/ β/ 3M/ β/ =/ (/ e/ (/ g/ ,/ g/ )/ abc/ )/ α/ 3e/ (/ ga/ ,/ gc/ )/ β/ 3M/ β/ =/ e/ (/ ga/ ,/ (/ gb/ )/ α/ 3/ )/ ce/ (/ ga/ ,/ g/ β/ 3/ )/ cM/ β/ =/ e/ (/ ga/ ,/ (/ gb/ )/ α/ 3g/ β/ 3/ )/ cM/ β/ =/ e/ (/ g1/ ,/ X3/ )/ cM/ β/ ,/ C/ / 1/ =/ gc/ ,/ C/ / 2/ =/ (/ gc/ )/ β/ 1w/ / +/ β/ 2/ τ/ / +/ β/ 3/ =/ (/ g/ β/ 1w/ / +/ β/ 2/ τ/ / +/ β/ 3/ )/ c/ =/ (/ (/ gb/ )/ α/ 1w/ / +/ α/ 2/ -/ α/ 1w/ / +/ α/ 3/ =/ (/ (/ gb/ )/ α/ 1w/ / +/ α/ 2/ τ/ / +/ α/ 3g/ β/ 1w/ / +/ β/ 2/ τ/ / +/ β/ 3/ )/ c/ =/ (/ (/ (/ gb/ )/ α/ 1g/ β/ 1/ )/ w/ / (/ (/ gb/ )/ α/ 2g/ β/ 2/ )/ τ/ / (/ gb/ )/ α/ 3g/ β/ 3/ )/ c/ =/ (/ Xw/ / 查询/ 阶段/ 2/ ./ 在/ 本/ 阶段/ ,/ 敌手/ A/ 继续/ 进行/ 一系列/ 解密/ 查询/ ./ 当/ 敌手/ A/ 对/ 密文/ C/ =/ (/ τ/ ,/ C0/ ,/ C1/ ,/ C2/ )/ 进行/ 查询/ 时/ ,/ 算法/ B/ 首先/ 计算/ w/ =/ H/ (/ C0/ ,/ C1/ )/ ,/ 并/ 检查/ e/ (/ C1/ ,/ Xw/ 拒绝/ 该/ 密文/ ;/ 否则/ ,/ 算法/ 按/ 如下/ 情况/ 进行/ 处理/ :/ (/ 1/ )/ 若/ (/ τ/ =/ τ/ / )/ ∧/ (/ C0/ =/ C/ / 0/ )/ ∧/ (/ C1/ =/ C/ / 1/ )/ ,/ 这/ 意味着/ C2/ =/ C/ / 2/ ,/ 即/ C/ =/ C/ / ./ 根据/ 安全/ 模型/ ,/ 算法/ B/ 拒绝/ 进行/ 解密/ 应答/ ./ (/ 2/ )/ 若/ (/ (/ C0/ ≠/ C/ / 0/ )/ ∨/ (/ C1/ ≠/ C/ / 1/ )/ )/ ∧/ (/ H/ (/ C0/ ,/ C1/ )/ =/ H/ (/ C/ / 0/ ,/ C/ / 1/ )/ )/ ,/ 算法/ B/ 输出/ 一个/ 随机/ 位/ 并/ 终止/ 游戏/ ./ 然而/ ,/ 根据/ H/ 的/ 目标/ 防/ 碰撞/ 性/ ,/ 整个/ 仿真/ 过程/ 中/ 这种/ 情况/ 发生/ 的/ 概率/ 最多为/ AdvTCRPage5/ (/ 3/ )/ 其它/ 情形/ :/ 算法/ B/ 按照/ 查询/ 阶段/ 1/ 的/ 方法/ 进行/ 解密/ ./ 值得/ 指出/ 的/ 是/ ,/ 虽然/ 敌手/ 可以/ 从/ 挑战/ 密文/ 中/ 获知/ α/ 1w/ / +/ α/ 2/ τ/ / +/ α/ 3/ =/ 0modp/ 这一/ 信息/ ,/ α/ 1w/ +/ α/ 2/ τ/ +/ α/ 3/ =/ 0modp/ 发生/ 的/ 概率/ 仍然/ 最多为/ 1/ 此处/ 只有/ 两个/ 方程/ 而/ 有/ 3/ 个/ 未知数/ ./ 猜测/ 阶段/ ./ 最后/ ,/ 敌手/ A/ 输出/ 一个/ 猜测/ β/ ∈/ {/ 0/ ,/ 1/ }/ ./ 若/ β/ =/ β/ ,/ 算法/ B/ 输出/ 1/ 来/ 猜测/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ ;/ 否则/ ,/ B/ 输出/ 0/ 来/ 猜测/ Q/ =/ e/ (/ g/ ,/ g/ )/ z/ ./ 令/ Abort/ 表示/ 仿真/ 过程/ 中/ 算法/ B/ 发生/ 失败/ 而/ 终止/ 的/ 事件/ ,/ 则/ 可得/ Pr/ [/ Abort/ ]/ =/ 1/ -/ qd/ (/ )/ p/ (/ 1/ -/ A/ )/ ./ 注意/ 到/ ,/ 一方面/ ,/ 若/ 事件/ Abort/ 不/ 发生/ 且/ AdvTCRQ/ =/ e/ (/ g/ ,/ g/ )/ abc/ ,/ 则/ 从/ 敌手/ A/ 的/ 角度/ 来看/ ,/ 算法/ B/ 提供/ 的/ 仿真/ 与/ 真实/ 环境/ 是/ 不可/ 区分/ 的/ ,/ 因此/ 可得/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ / Abort/ ]/ =/ 12/ +/ ε/ ./ 另一方面/ ,/ 由/ 仿真/ 过程/ 可知/ ,/ 若/ 事件/ Abort/ 发生/ 且/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ ,/ 则/ 算法/ B/ 输出/ 1/ 的/ 概率/ 为/ 1Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1Abort/ ]/ =/ 12/ ./ 因此/ 可得/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ ]/ =/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ |/ / Abort/ ]/ Pr/ [/ / Abort/ ]/ +/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1Abort/ ]/ Pr/ [/ Abort/ ]/ 2/ +/ (/ )/ ε/ Pr/ [/ / Abort/ ]/ +/ 1/ =/ 12/ +/ (/ )/ ε/ Pr/ [/ / Abort/ ]/ +/ 1/ =/ 1/ 表/ 1/ 本文/ 方案/ 与/ 相关/ 加密/ 方案/ 的/ 比较/ 方案/ Kiltz/ 公钥/ 长度/ 5G/ (/ n/ +/ 1/ )/ G/ +/ 1G1/ (/ n/ +/ 1/ )/ G/ 私钥/ 长度/ 5Zp1G/ +/ (/ n/ +/ 1/ )/ Zp/ (/ n/ +/ 1/ )/ Zp/ 密文/ 长度/ 3G/ +/ 1M2G/ +/ 1M2G/ +/ 1M2G/ +/ 1Zp/ +/ 1M2G/ +/ 1Zp/ +/ 1M/ 加密/ 运算量/ 3te/ +/ 1tme2te/ +/ 1tme/ 解密/ 运算量/ 1te/ +/ 1tme1te/ +/ 1tme/ +/ 3tp/ 密文/ 公开/ 可验证/ ?/ NoCCA2/ 安全/ ?/ 紧/ 归约/ ?/ 5/ 结束语/ 本文/ 对康立/ 等/ 人/ 最近/ 提出/ 的/ 公钥/ 加密/ 方案/ 进行/ 了/ 分析/ ,/ 指出/ 其/ 方案/ 并/ 不/ 满足/ IND/ -/ CCA2/ 安全/ ./ 然后/ 提出/ 一个/ 新/ 的/ 公钥/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下证/ =/ 12/ +/ Pr/ [/ / Abort/ ]/ ·/ ε/ ./ 此外/ ,/ 若/ Q/ 为群/ GT/ 中/ 的/ 随机/ 元素/ (/ 即/ Q/ =/ e/ (/ g/ ,/ g/ )/ z/ )/ ,/ 从/ 敌手/ A/ 的/ 角度/ 来看/ ,/ C/ / 与/ β/ 是/ 互相/ 独立/ 的/ ,/ 因而/ 可得/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ z/ )/ =/ 1/ ]/ =/ 1/ 此/ ,/ 算法/ B/ 针对/ 群组/ (/ G/ ,/ GT/ )/ 中/ DBDH/ 假设/ 的/ 优势/ 为/ ε/ =/ Pr/ [/ B/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ ]/ -/ =/ 1/ =/ Pr/ [/ / Abort/ ]/ ·/ ε/ =/ 1/ -/ qd/ (/ )/ p/ (/ 1/ -/ AdvTCR/ 上述/ 优势/ 显然/ 是/ 不可/ 忽略/ 的/ ./ 再/ 由/ 仿真/ 过程/ 来看/ ,/ 算法/ B/ 的/ 运行/ 时间/ 也/ 是/ 多项式/ 时间/ 的/ ./ 因此/ 定理/ 获证/ ./ 4.3/ 效率/ 比较/ 表/ 1/ 对/ 本文/ 所提/ 的/ 加密/ 方案/ 与/ CS98/ 方案/ [/ 4/ ]/ 、/ BMW/ 加密/ 方案/ [/ 5/ ]/ 、/ Kiltz/ 加密/ 方案/ (/ 文献/ [/ 8/ ]/ 附录/ 中/ 的/ 方案/ )/ 、/ 康立/ 等/ 人/ 方案/ [/ 11/ ]/ 在/ 效率/ 和/ 所/ 具备/ 性质/ 方面/ 进行/ 了/ 比较/ ./ 在/ 表/ 1/ 中/ ,/ M/ 、/ G/ 、/ G1/ 和/ Zp/ 分别/ 表示/ 明文/ 空间/ 、/ 群/ G/ 、/ G1/ 和/ Zp/ 中/ 的/ 一个/ 元素/ 的/ 位/ 长度/ ./ te/ 、/ tme/ 和/ tp/ 分别/ 表示/ 一个/ 模/ 指数/ 乘法/ 、/ 多重/ 模/ 指数/ 乘法/ 和/ 双线性/ 配对/ 的/ 运算/ 代价/ ./ 从表/ 1/ 可见/ ,/ 与/ CS98/ 方案/ 相比/ ,/ 本文/ 方案/ 具有/ 更/ 短/ 的/ 私钥/ 长度/ ,/ 并且/ 密文/ 具有/ 公开/ 可验证/ 性/ ./ 与/ BMW/ 方案/ 和/ Kiltz/ 方案/ 相比/ ,/ 本文/ 的/ 公/ // 私钥/ 长度/ 更/ 短/ ,/ 并且/ 具有/ 更紧/ 的/ 安全性/ 归约/ ./ 与/ 康立/ 等/ 人/ 方案/ 相比/ ,/ 本文/ 方案/ 能够/ 满足/ CCA2/ 安全/ ./ 2teYesYesNo/ 明/ 了/ 新/ 方案/ 的/ IND/ -/ CCA2/ 安全性/ ./ 

