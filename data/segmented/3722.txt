Page1/ 基于/ 发布/ 订阅/ 结构/ 的/ 计算机/ 视觉/ 跟踪/ 研究/ 刘海洋/ 刘元安高/ 锦春/ 马晓雷/ 刘春旭/ (/ 北京邮电大学/ 安全/ 生产/ 智能/ 监控/ 北京市/ 重点/ 实验室/ 北京/ 100876/ )/ 摘要/ 文中/ 报道/ 了/ 使用/ 发布/ 订阅/ 中间件/ 搭建/ 的/ 一个/ 跟踪/ 系统/ ,/ 通过/ 单/ 摄像头/ 采集/ 图像/ ,/ 经过/ 分析/ 处理/ ,/ 计算/ 出/ 运动/ 物体/ 的/ 相对/ 位置/ ,/ 同时/ 控制/ 摄像头/ 转动/ ,/ 对/ 运动/ 物体/ 进行/ 实时/ 追踪/ ./ 整个/ 系统/ 主要/ 包括/ 4/ 个/ 方面/ ,/ 以/ 发布/ // 订阅/ 为/ 中心/ 结构/ 连接/ 3/ 个/ 子系统/ 、/ 目标/ 获取/ 、/ 目标/ 跟踪/ 、/ 采集/ 摄像头/ 控制/ ./ 文中/ 为/ 卡尔曼滤波/ 定义/ 了/ 新/ 的/ 向量/ ,/ 预测/ 目标/ 运动/ 趋势/ ;/ 根据/ 物体/ 的/ 运动/ 信息/ 自行设计/ 了/ 摄像头/ 控制程序/ ./ 算法/ 有/ 充分/ 的/ 理论依据/ 和/ 实验/ 验证/ ./ 关键词/ 发布/ 订阅/ ;/ 视觉/ 追踪/ ;/ 背景/ 减除/ ;/ CamShift/ ;/ 卡尔曼滤波/ 器/ 1/ 引言/ 视觉/ 跟踪/ 是/ 计算机/ 研究/ 领域/ 中/ 的/ 一个/ 重要/ 课题/ ,/ 是/ 指/ 对/ 图像/ 序列/ 中/ 的/ 运动/ 目标/ 进行/ 检测/ 、/ 提取/ 、/ 识别/ 和/ 跟踪/ ,/ 获得/ 运动/ 目标/ 的/ 运动/ 参数/ ,/ 如/ 位置/ 、/ 速度/ 以及/ 运动/ 轨迹/ ,/ 从而/ 进一步/ 处理/ 与/ 分析/ ,/ 实现/ 对/ 运动/ 目标/ 的/ 追踪/ ./ 本文/ 采用/ 了/ 发布/ 订阅/ 机制/ 把/ 整个/ 系统/ 分成/ 3/ 部分/ ,/ 第/ 1/ 个/ 子系统/ 只/ 负责/ 由/ 外部/ 采集/ 设备/ 中/ 不断/ 地/ 从/ 视频/ 中/ 采集/ 帧/ ;/ 第/ 2/ 个/ 子系统/ 由/ 多台/ 工作站/ 组成/ ,/ 从/ 发布/ 订阅/ 中间件/ 中/ 获得/ 采集/ 帧/ 进行/ Page22/ 发布/ 订阅/ 构架/ 由于/ 视觉/ 跟踪/ 中/ 图像处理/ 计算/ 量/ 大/ ,/ 如果/ 把/ 采集/ 系统/ 、/ 分析/ 系统/ 、/ 控制系统/ 放在/ 一台/ 服务器/ 上/ ,/ 很难/ 保证/ 跟踪/ 过程/ 中/ 的/ 实时性/ ./ 以/ 数据/ 为/ 中心/ 的/ 发布/ 订阅/ [/ 1/ ]/ 系统/ 主要/ 的/ 特点/ 包括/ 松/ 耦合/ 性/ 和/ 实时性/ ,/ 正好/ 可以/ 满足/ 视觉/ 跟踪/ 系统/ 的/ 结构/ ./ 采集/ 节点/ 作为/ 原始/ 图像/ 发布者/ ,/ 不断/ 地向/ 分析/ 节点/ 发送/ 图像/ ;/ 分析/ 节点/ 得到/ 原始/ 图像/ 后/ 分析/ 当前/ 运动/ 物体/ 位移/ 和/ 运动/ 趋势/ ,/ 再/ 以/ 发布者/ 的/ 身份/ 发布/ 数据/ 到/ 控制/ 节点/ ;/ 控制/ 节点/ 得到/ 信息/ 后/ 对/ 采集/ 设备/ 进行/ 控制/ ./ 发布/ 订阅/ 结构/ 可以/ 采用/ DDS/ [/ 2/ ]/ (/ DataDistributeService/ )/ 规范/ 进行/ 构建/ (/ DDS/ 是/ 对象/ 管理/ 组织/ OMG/ [/ 3/ ]/ 的/ 有关/ 分布式/ 实时/ 系统/ 中/ 数据/ 发布/ 的/ 一个/ 规范/ )/ ./ DDS/ 以/ 数据/ 为/ 中心/ 来/ 进行/ 数据/ 分发/ ,/ 用/ QoS/ 参数/ 对/ 资源/ 状况/ 、/ 期待/ 程度/ 、/ 网络/ 情况/ 等/ 进行/ 描述/ ,/ 提高/ 系统/ 的/ 灵活性/ ./ 在/ 研究/ 过程/ 中/ ,/ 遇到/ 实时性/ 和/ 各/ 流程/ 间/ 的/ 并行处理/ 问题/ ,/ 经/ 多方/ 调研/ 分析/ ,/ 本文/ 提出/ 了/ 采用/ 实时/ 发布/ 订阅/ [/ 4/ ]/ 机制/ 构建/ 系统/ ,/ 适用/ 于/ 采用/ 多/ 终端/ 视频/ 采集/ 设备/ 的/ 环境/ ,/ 部署/ 集中/ // 分布式/ 视觉/ 追踪/ 构架/ ,/ 消除/ 过程/ 间/ 的/ 依赖性/ ,/ 此/ 方法/ 有/ 如下/ 优势/ :/ (/ 1/ )/ 摄像头/ 采集/ 图像/ 的/ 速度/ 远远/ 大于/ 进行/ 图像/ 分析/ 的/ 速度/ ./ 如果/ 只有/ 一台/ 工作站/ 分析/ 图像/ ,/ 很/ 可能/ 在/ 分析/ 过程/ 中/ ,/ 大量/ 新/ 采集/ 到/ 的/ 实时/ 图像/ 被/ 遗漏/ ;/ 如果/ 采用/ 几台/ 工作站/ 协同/ 进行/ 图像/ 分析/ ,/ 因为/ 图像/ 分析/ 算法/ 的/ 处理/ 时间/ 不/ 确定/ ,/ 图像/ 采集/ 系统/ 不能/ 按照/ 顺序/ 发送数据/ ,/ 同时/ 还要/ 考虑/ 网络连接/ 、/ 图像/ 重/ 发/ 、/ 选择/ 图像处理/ 工作站/ 等/ 问题/ ./ 在/ 图像/ 采集/ 端/ 和/ 图像/ 分析/ 端/ ,/ 增加/ 一个/ 发布/ 订阅/ 中间件/ 可以/ 降低/ 整个/ 系统/ 的/ 复杂度/ ,/ 多个/ 工作站/ 可/ 平衡/ 图像/ 分析/ 的/ 负载/ ./ (/ 2/ )/ 在/ 增加/ 发布/ 订阅/ 中间件/ 后/ ,/ 控制系统/ 不用/ 再/ 考虑/ 数据/ 的/ 来源/ ,/ 直接/ 从/ 中间件/ 中/ 取得/ 最新/ 的/ 数据源/ 的/ 位置/ ,/ 取得/ 最新/ 的/ 数据/ ,/ 保证/ 了/ 控制/ 的/ 实时性/ 与/ 连续性/ ./ (/ 3/ )/ 这种/ 结构设计/ 有/ 很/ 好/ 的/ 扩充性/ ,/ 可以/ 根据/ 所/ 采用/ 摄像头/ 的/ 功能/ ,/ 增加/ 其它/ 的/ 实际/ 要求/ ,/ 只/ 需/ 简单/ 的/ 扩充/ 其它/ 图像/ 分析/ 功能/ 的/ 工作站/ ,/ 配置/ 发布/ 订阅/ 主题/ 控制/ 端/ 增加/ 一点/ 逻辑/ ,/ 就/ 可以/ 改进/ 系统/ ./ 本文/ 只/ 讨论/ 根据/ 运动/ 物体/ 的/ 位移/ 方面/ 的/ 需求/ ,/ 进行/ 云台/ 的/ 控制/ ,/ 如果/ 需要/ 添加/ 新/ 的/ 功能/ ,/ 例如/ :/ 对于/ 多/ 目的/ 视觉/ 跟踪/ 系统/ ,/ 根据/ 运动/ 物体/ 的/ 像素数/ ,/ 调整/ 摄像头/ 的/ 焦距/ ,/ 都/ 可以/ 在/ 这种/ 系统结构/ 下/ 很/ 轻松/ 的/ 改造/ 升级/ ./ 3/ 目标/ 检测/ 与/ 跟踪/ 分析/ 首先/ 要/ 对/ 采集/ 的/ 图像/ 进行/ 预处理/ ,/ 包括/ 边缘/ 处理/ 、/ 高斯/ 平滑/ ./ 图像/ 经过/ 处理/ 后/ ,/ 通过/ 背景/ 差/ 的/ 方法/ ,/ 分离/ 运动/ 目标/ ./ 背景/ 差法/ 的/ 第/ 1/ 步是/ 在/ 背景/ 稳定/ 且/ 没有/ 物体/ 进入/ 检测/ 范围/ 时/ ,/ 采集/ 连续/ 的/ 背景/ 序列/ 图像/ ,/ 通过/ 计算/ 每帧/ 平均值/ 的/ 算法/ 建立/ 背景/ 模型/ [/ 5/ ]/ ./ 经过/ 背景/ 差/ 得到/ 的/ 运动/ 目标/ 区域/ ,/ 由于/ 光线/ 的/ 原因/ 常/ 连带/ 着/ 一些/ 阴影/ ,/ 所以/ 需要/ 通过/ 阴影/ 检测/ [/ 6/ ]/ ,/ 将/ 阴影/ 分/ 离开/ ,/ 让/ 目标/ 跟踪/ 的/ 更加/ 准确/ ./ 经过/ 阴影/ 祛除/ 后/ ,/ 可以/ 较/ 精确/ 地/ 确定/ 运动/ 目标/ 点/ ./ 将/ 采集/ 的/ RGB/ 图像/ 转化/ 为/ HSV/ 图像/ ,/ 分离/ H/ 通道/ 建立/ 彩色/ 直方图/ ,/ 给/ CamShift/ [/ 7/ ]/ 跟踪/ 算法/ 提供/ 判断/ 依据/ ./ CamShift/ 算法/ 的/ 基础/ 是/ 均值/ 移位/ 算法/ —/ —/ —/ MeanShift/ [/ 8/ ]/ 算法/ ,/ 又称/ 均值/ 移位/ 算法/ ,/ 是/ 一个/ 非常/ 实用/ 的/ 进行/ 局部/ 最优/ 解/ 求取/ 的/ 算法/ ,/ 具有/ 快速/ 高效/ 的/ 特点/ ,/ 从/ 候选/ 目标/ 中/ 找到/ 最/ 接近/ 已/ 给定/ 的/ 目标/ 模型/ ./ MeanShift/ 算法/ 是/ 一种/ 密度/ 函数/ 估计/ 的/ 非/ 参数/ 方法/ ,/ 它/ 依据/ 概率分布/ 的/ 梯度/ 寻找/ 最近/ 的/ 极值/ ,/ 基于/ 目标/ 的/ 颜色/ 概率分布/ 信息/ 进行/ 快速/ 有效/ 的/ 跟踪/ ,/ 还/ 可以/ 有效/ 地/ 去除/ 序列/ 图像/ 中/ 的/ 噪声/ 及/ 干扰/ ,/ 算法/ 鲁棒性/ 好/ ./ MeanShift/ 算法/ 在/ 视觉/ 跟踪/ 中/ ,/ 采用/ 不断/ 调整/ 区域/ 质心/ ,/ 使/ 质心/ 不断/ 地/ 趋近/ 于/ 获取/ 区域/ 的/ 中心/ 位置/ ,/ 来/ 达到/ 跟踪/ 目的/ ./ 计算/ 出/ 搜索/ 区域/ 的/ 质心/ 位置/ 后/ ,/ 把/ 搜索/ 窗口/ 的/ 中心/ 位置/ 移/ 到/ 质心/ 位置/ ,/ 根据/ 新/ 的/ 中心/ 位置/ 再/ 计算/ 质心/ ,/ 不断/ 地/ 迭代/ 计算/ ,/ 直到/ 计算/ 出/ 的/ 质心/ 收敛/ ./ 此时/ 检测/ 设备/ 就/ 锁定/ 了/ 跟踪目标/ ./ 搜索/ 窗口/ 的/ 质心/ 位置/ 可以/ 由/ 零阶矩/ 和/ 一阶矩/ 确定/ ./ 零阶矩/ 的/ 计算公式/ :/ x/ 和/ y/ 的/ 一阶矩/ 计算/ :/ Page3/ 搜索/ 窗口/ 的/ 质心/ 计算/ :/ 连续/ 自/ 适应/ 的/ MeanShift/ 算法/ (/ 即/ CamShift/ 算法/ )/ 在/ 跟踪/ 过程/ 中/ 可以/ 不断/ 地/ 调整/ 搜索/ 窗口/ 的/ 大小/ ,/ 保证/ 搜索/ 窗口/ 能/ 跟随/ 采集/ 物体/ 图像/ 的/ 面积/ 的/ 变化/ 而/ 变化/ ,/ 这样/ 就/ 可以/ 连续不断/ 地/ 实时/ 而/ 准确/ 地/ 跟踪/ 物体/ ./ 计算/ 在/ 采集/ 图像/ 中/ 已/ 被/ 匹配/ 窗口/ 的/ 二阶/ 矩/ :/ x/ ,/ y/ ,/ xy/ 方向/ 的/ 二阶/ 矩/ M20/ ,/ M02/ ,/ M11/ 为/ 计算/ 3/ 个/ 运算/ 参数/ :/ 注/ ./ M00xcyc/ 是/ 匹配/ 成功/ 后/ 窗口/ (/ 当/ 搜索/ 窗口/ 超出/ 采集/ 图像/ 的/ 边界/ 时/ ,/ 需要/ 对/ 窗口/ 进行/ 调整/ 再/ 计算/ )/ 的/ 零阶矩/ 和/ xy/ 中心/ ./ 搜索/ 窗口/ 的/ 追踪/ 方向/ 角度/ 、/ 长宽/ 为/ CamShift/ 算法/ 流程/ 如下/ :/ 1/ ./ 初始化/ 搜索/ 窗口/ ./ 把/ 在/ 目标/ 检测/ 阶段/ 获得/ 的/ 坐标/ 信息/ ,/ 处理/ 为/ 矩形/ 区域/ ,/ 作为/ 初始/ 的/ 搜索/ 窗口/ ./ 搜索/ 窗口/ 包括/ 窗口/ 的/ 大小/ 、/ 窗口/ 在/ 整个/ 图像/ (/ 原始/ 图像/ 的/ 反向/ 投影/ )/ 的/ 位置/ ./ 2/ ./ 提取/ 搜索/ 窗口/ ./ 根据/ 搜索/ 窗口/ 的/ 信息/ 从/ 图像/ 中/ 抽取/ ,/ 需要/ 计算/ 的/ 矩形/ 子/ 图像/ ./ 3/ ./ 计算/ 质心/ 与/ 中心/ ./ 获取/ 搜索/ 窗口/ 的/ 宽/ 高中/ 点/ 得到/ 中心/ 位置/ ,/ 质心/ 通过/ 一阶矩/ 比/ 零阶矩/ 的/ 方法/ 获得/ ./ 4/ ./ 改变/ 搜索/ 窗口/ 信息/ ./ 根据/ 质心/ 与/ 中心/ 的/ 距离/ 修改/ 搜索/ 窗口/ 的/ 信息/ (/ 主要/ 是/ 搜索/ 窗口/ 在/ 图像/ 中/ 位置/ 的/ 信息/ )/ ,/ 回到/ 第/ 2/ 步/ ./ 程序/ 已经/ 完成/ 了/ 给定/ 的/ 执行/ 次数/ 时/ ,/ 退出/ 搜索/ 程序/ ./ 5/ ./ 搜索/ 完成/ ./ 当/ 质心/ 与/ 中心/ 的/ 距离/ 小于/ 设定/ 参数/ ,/ 或者/ CamShift/ 算法/ 需要/ 不断/ 的/ 迭代/ 计算/ ,/ 以上/ 一个/ 位置/ 为/ 基准/ ,/ 逐步/ 匹配/ 到/ 目标/ 在/ 当前/ 时刻/ 出现/ 的/ 位置/ ./ 为了/ 提高/ 系统/ 效率/ ,/ 需要/ 引用/ 一个/ 预估/ 器/ 对/ 目标/ 的/ 运动/ 趋势/ 进行/ 预测/ ,/ 计算/ 出/ 在/ 下/ 一/ 时刻/ 运动/ 目标/ 可能/ 出现/ 的/ 位置/ ,/ 以此/ 位置/ 为/ 基准/ 进行/ 迭代/ 计算/ ,/ 其中/ 卡尔曼/ 预估/ 器/ [/ 9/ ]/ 就是/ 一个/ 很/ 好/ 的/ 选择/ ./ 4/ 运动/ 趋势/ 预测/ 卡尔曼滤波/ 是/ 一种/ 高效率/ 的/ 递归/ 滤波器/ ,/ 能够/ 从/ 一系列/ 不/ 包含/ 噪声/ 的/ 测量/ 中/ ,/ 估计/ 动态/ 系统/ 的/ 状态/ ./ 卡尔曼滤波/ 器/ 由/ 一系列/ 递归/ 数学公式/ 描述/ ./ 它们/ 提供/ 了/ 一种/ 高效/ 可/ 计算/ 的/ 方法/ 来/ 估计/ 过程/ 的/ 状态/ ,/ 并/ 使/ 估计/ 均方/ 误差/ 最小/ ./ 卡尔曼滤波/ 器/ 应用/ 的/ 领域/ 广泛/ 并且/ 功能强大/ ,/ 在/ 不/ 确定/ 模型/ 的/ 确切/ 性质/ 的/ 情况/ 下/ ,/ 不但/ 能/ 估计/ 信号/ 过去/ 和/ 当前/ 的/ 状态/ ,/ 还/ 能/ 估计/ 将来/ 的/ 状态/ ./ 卡尔曼滤波/ 器用/ 反馈/ 控制/ 的/ 方法/ 估计/ 过程/ 状态/ :/ 滤波器/ 估计/ 过程/ 某一/ 时刻/ 的/ 状态/ ,/ 然后/ 以/ (/ 含/ 噪声/ 的/ )/ 测量/ 变量/ 的/ 方式/ 获得/ 反馈/ ./ 因此/ 卡尔曼滤波/ 器/ 可/ 分为/ 两个/ 部分/ :/ 时间/ 更新/ 方程/ 和/ 测量/ 更新/ 方程/ ./ 时间/ 更新/ 方程/ 负责/ 及时/ 向前/ 推算/ 当前/ 状态变量/ 和/ 误差/ 协方差/ 估计/ 的/ 值/ ,/ 以便/ 为/ 下/ 一个/ 时间/ 状态/ 构造/ 先验/ 估计/ ./ 测量/ 更新/ 方程/ 负责/ 反馈/ ,/ 将/ 先验/ 轨迹/ 和/ 新/ 的/ 测量/ 变量/ 结合/ 构造/ 改进/ 的/ 后验/ 估计/ ./ 卡尔曼滤波/ 器/ 时间/ 更新/ 方程/ (/ 离散/ )/ :/ 卡尔曼滤波/ 器/ 状态/ 更新/ 方程/ (/ 离散/ )/ :/ 为了/ 预测出/ 在/ 下/ 一时间/ ,/ 追踪/ 目标/ 的/ 位置/ ,/ 需要/ 为/ 控制/ 摄像头/ 系统/ 提供/ 位移/ 、/ 速度/ 信息/ ,/ 将/ 向量/ 定义/ 为/ 一个/ 四维/ 向量/ :/ α/ (/ k/ )/ =/ [/ x/ (/ k/ )/ ,/ vx/ (/ k/ )/ ,/ y/ (/ k/ )/ ,/ vy/ (/ k/ )/ ]/ T/ ./ x/ (/ k/ )/ 为/ x/ 轴/ 方向/ 位移/ ;/ vx/ (/ k/ )/ 为/ x/ 轴/ 方向/ 速度/ ;/ y/ (/ k/ )/ 为/ y/ 轴/ 方向/ 位移/ ;/ vy/ (/ k/ )/ 为/ y/ 轴/ 方向/ 速度/ ./ 状态/ 增益/ 矩阵/ 设置/ 为/ 犃/ =/ 移/ 进行/ 预测/ ,/ 并且/ 对/ 向量/ 不/ 进行/ 额外/ 控制/ ./ 矩阵/ 中/ 速度/ 设置/ 为/ 1/ ,/ 表示/ 以/ 每次/ 采集/ 间隔时间/ 会/ 逐渐/ 趋近/ 于/ 相同/ ./ 犎/ =/ Page4/ 由/ CamShift/ 跟踪/ 算法/ 得到/ 质点/ 坐标/ 以及/ 物体/ 的/ 速度/ 矢量/ ,/ 不再/ 进行/ 别的/ 加工/ 处理/ ./ 预测/ 位置/ zk/ =/ 犃/ ×/ α/ (/ k/ )/ ,/ 线性/ 预测出/ 运动/ 目标/ 出现/ 的/ 位置/ ,/ CamShift/ 算法/ 根据/ 预测出/ 的/ 追踪/ 目标/ 位置/ ,/ 进行/ 追踪/ ,/ 可以/ 提高/ 匹配/ 的/ 速度/ ,/ 降低/ 迭代/ 的/ 次数/ ,/ 保持稳定/ 的/ 跟踪/ 状态/ ,/ 并且/ 使/ 每次/ 的/ 运算/ 时间/ 相对/ 稳定/ ,/ 可以/ 反过来/ 为/ 卡尔曼滤波/ 的/ 稳定/ 估值/ 提供/ 帮助/ ./ 目前/ 在/ 研究/ 卡尔曼滤波/ 预测/ 的/ 视觉/ 跟踪/ 算法/ 中/ 向量/ 只是/ 定义/ 了/ 两个/ 位置/ 坐标/ 的/ 分量/ ,/ 在/ 固定/ 的/ 采集/ 设备/ 中是/ 可以/ 满足需要/ 的/ ,/ 但/ 并/ 不/ 扩展/ 满足/ 自动/ 跟踪/ 系统/ ,/ 分量/ 中/ 没有/ 描述/ 目标/ 的/ 运动/ 方向/ 和/ 速度/ ,/ 所以/ 在/ 向量/ 中/ 增加/ 速度/ 矢量/ ,/ 并/ 加以/ 完善/ 分析/ ,/ 是/ 本文/ 对/ 向量/ 定义/ 的/ 重要/ 改进/ :/ 第一/ ,/ 在/ 向量/ 中/ ,/ vx/ (/ k/ )/ ,/ vy/ (/ k/ )/ 的/ 速度/ 与/ 通常/ 定义/ 的/ 速度/ 是/ 不/ 一致/ 的/ ,/ 通常/ 定义/ 速度/ 是/ :/ 距离/ // 单位/ 时间/ (/ 秒/ 、/ 分/ 或/ 小时/ )/ ,/ 而/ 在/ 这里/ 单位/ 时间/ 并/ 不是/ 一个/ 标准值/ ,/ 而是/ 以/ 每次/ 跟踪目标/ 的/ 处理/ 时间/ 为/ 单位/ ,/ 运动/ 目标/ 在/ 采集/ 图像/ 中/ 移动/ 了/ 多少/ 像素/ ./ 因此/ ,/ 一/ 开始/ 由于/ 系统/ 的/ 处理速度/ 不/ 稳定/ ,/ 导致/ 每次/ 的/ 处理/ 时间/ 也/ 不/ 稳定/ ,/ 所以/ 每次/ 采集/ 到/ 图像/ 的/ 间隔时间/ 也/ 不同/ ,/ 而/ 导致/ 物体/ 在/ 每次/ 处理/ 期间/ 内/ 移动/ 的/ 距离/ 也/ 不/ 相同/ ./ 但是/ ,/ 随着/ 卡尔曼/ 估计/ 器/ 的/ 估计/ 误差/ 越来越/ 稳定/ ,/ 预测/ 的/ 位置/ 与/ 追踪/ 目标/ 的/ 实际/ 位置/ 越来越/ 接近/ ,/ 并/ 保持/ 在/ 一个/ 稳定/ 的/ 范围/ 时/ ,/ CamShift/ 跟踪/ 算法/ 的/ 迭代/ 次数/ 也/ 会/ 保持稳定/ ,/ 运算/ 时间/ 也/ 就/ 会/ 接近/ 一个/ 常量/ ,/ 从而/ 保证/ 了/ 每次/ 采集/ 图像/ 中/ ,/ 追踪/ 目标/ 移动/ 距离/ 的/ 稳定/ ./ 第二/ ,/ 考虑/ 控制/ 摄像头/ 转动/ ,/ 使/ 物体/ 保持/ 在/ 监控/ 范围/ 内/ ,/ 需要/ 使用/ 速度/ 矢量/ ,/ 因为/ 位移/ 信息/ 只能/ 表示/ 物体/ 当前/ 的/ 位置/ ,/ 而/ 不能/ 表示/ 当前/ 物体/ 的/ 运动/ 方向/ 和/ 趋势/ ,/ 控制系统/ 可/ 据此/ 预判出/ 转动/ 方向/ 和/ 速度/ ,/ 从而/ 更加/ 有效/ 地/ 跟踪目标/ ./ 5/ 控制算法/ 本文/ 除了/ 部署/ 系统/ 的/ 新/ 构架/ 和/ 改进/ 运动/ 目标/ 向量/ ,/ 最/ 重要/ 的/ 就是/ 设计/ 摄像头/ 控制算法/ ,/ 首先/ 要/ 维持/ 运动/ 目标/ 不/ 脱离/ 监控/ 范围/ ,/ 然后/ 维持/ 运动/ 目标/ 在/ 监控/ 坐标系/ 内/ 保持/ 平稳/ 、/ 连续/ ,/ 保证/ 视觉/ 分析/ 系统/ 效率/ 和/ 准确性/ ,/ 对于/ 非/ 固定/ 视频/ 采集/ 设备/ 场景/ ,/ 有/ 长远/ 的/ 研究/ 价值/ 和/ 实用/ 意义/ ./ 控制算法/ 需要/ 运动/ 目标/ 的/ 速度/ 矢量/ ,/ 来/ 判断/ 物体/ 的/ 运动/ 趋势/ ,/ 根据/ 运动/ 趋势/ 控制/ 云台/ 转动/ ,/ 调整/ 检测/ 画面/ 中/ 的/ 物体/ 趋近/ 于/ 中心/ 位置/ ./ 由于/ 监测/ 系统/ 需/ 自动/ 地/ 从/ 静止/ 开始/ 捕捉到/ 目标/ ,/ 再/ 保持/ 跟踪目标/ ,/ 所以/ 控制/ 云台/ 转动/ 速度/ 的/ 快慢/ 分为/ 两个/ 阶段/ ,/ 一个/ 是/ 当/ 追踪/ 系统/ 捕捉到/ 运动/ 目标/ 新/ 的/ 位置/ 和/ 速度/ 时/ ,/ 对/ 云台/ 转动/ 速度/ 进行/ 合理/ 的/ 调整/ ./ 另/ 一个/ 是/ 在/ 控制系统/ 不能/ 得到/ 新/ 的/ 跟踪目标/ 的/ 运动/ 信息/ 时/ ,/ 对/ 云台/ 转动/ 速度/ 进行/ 保守/ 的/ 调整/ ,/ 使/ 物体/ 的/ 成像/ 逐渐/ 趋近/ 于/ 中心/ ./ 这/ 两个/ 阶段/ 是/ 必不可少/ 的/ ,/ 需要/ 在/ 刚/ 获得/ 物体/ 的/ 运动/ 信息/ 处于/ 相对/ 准确/ 时/ ,/ 迅速/ 调整/ 云台/ 转动/ 速度/ ,/ 保持/ 和/ 运动/ 物体/ 之间/ 的/ 运动/ 趋势/ 相对/ 静止/ ,/ 也/ 需要/ 在/ 没有/ 新/ 的/ 信息/ 时/ ,/ 维持/ 物体/ 仍/ 在/ 监控/ 范围/ 内/ ,/ 为/ 下/ 一次/ 的/ 追踪/ 提供/ 准备/ ./ 整个/ 控制系统/ 以/ 监控/ 中心/ 为/ 坐标/ 原点/ ,/ 控制/ 的/ 预期/ 目标/ 就是/ 使/ 运动/ 目标/ 位置/ 趋近/ 于/ 原点/ ,/ 处于/ 相对/ 静止/ 的/ 位置/ ./ 当/ 运动/ 目标/ 的/ 速度/ 大于/ 0/ 时/ ,/ 说明/ 目标/ 远离/ 中心/ ,/ 有/ 移动/ 到/ 监控/ 边缘/ 的/ 趋势/ ,/ 于是/ 要/ 增加/ 摄像头/ 的/ 转动/ 速度/ ,/ 相对/ 使/ 目标/ 的/ 速度/ 降低/ ,/ 回归/ 于/ 原点/ ./ 当/ 目标/ 的/ 位移/ 已经/ 处于/ 监控/ 边缘/ ,/ 需/ 立刻/ 调整/ 最大/ 的/ 速度/ ,/ 使/ 监控/ 系统/ 能/ 继续/ 捕捉到/ 目标/ ./ 当/ 运动/ 速度/ 的/ 方向/ 与/ 上次/ 不/ 一致/ ,/ 同时/ 位移/ 却/ 在/ 同一个/ 方向/ 时/ ,/ 说明/ 目标/ 运动/ 与/ 采集/ 设备/ 转动/ 处于/ 相对/ 静止/ 的/ 位置/ ./ 这是/ 由于/ 控制/ 采集/ 设备/ 是/ 数字/ 量/ 输出/ ,/ 很难/ 保证/ 与/ 运动/ 目标/ 速度/ 相同/ ,/ 才/ 会/ 出现/ 速度/ 不同/ ,/ 位移/ 方向/ 相同/ 的/ 情况/ ./ 应当/ 在/ 保证/ 采集/ 设备/ 转动/ 的/ 速度/ 不变/ 的/ 情况/ 下/ ,/ 在/ 当前/ 的/ 控制/ 流程/ 中/ ,/ 略微/ 调整/ 速度/ ,/ 慢慢/ 使/ 目标/ 趋于/ 中心/ 位置/ ./ 控制算法/ 如下/ :/ While/ (/ 是否/ 停止/ 跟踪/ )/ 【/ 取得/ 位置/ 信息/ :/ 坐标/ 速度/ 】/ if/ 新/ 采集/ 位置/ !/ =/ 上次/ 位置/ else/ 结合/ 图像/ 跟踪/ 分析/ 系统/ 设计/ 出/ 的/ 控制/ 设备/ 系统/ ,/ 是/ 在/ 当前/ 视觉/ 追踪/ 的/ 研究/ 中/ 很少/ 提及/ 的/ ,/ 这种/ 设计/ 显然/ 有/ 更好/ 的/ 实用价值/ ,/ 形成/ 一个/ 完整/ 的/ 系统/ ,/ 因为/ 采集/ 设备/ 的/ 转动/ 使/ 目标/ 尽量/ 保持/ 在/ 中心/ ,/ 减少/ 了/ 此/ Page5/ 次/ 位置/ 与/ 下次/ 位置/ 之间/ 的/ 距离/ ,/ 可以/ 提高/ CamShift/ 算法/ 的/ 效率/ ,/ 即/ 增加/ 了/ 跟踪/ 效率/ ;/ 由于/ 采集/ 设备/ 的/ 自行/ 转动/ ,/ 在/ 确定/ 运动/ 目标/ 后/ ,/ 增加/ 了/ 可/ 监控/ 的/ 范围/ ./ 而且/ ,/ 由于/ 自动/ 调节/ 转动/ 速度/ ,/ 可以/ 极大/ 地/ 减少/ 由于/ 目标/ 的/ 非线性/ 运动/ 而/ 引起/ 的/ 卡尔曼滤波/ 估算/ 错误/ ./ 所以/ 本文/ 中/ 提出/ 的/ 将/ 视觉/ 跟踪/ 系统/ 与/ 控制系统/ 整体/ 考虑/ 的/ 方案/ ,/ 是/ 非常/ 有/ 实际意义/ 的/ ./ 6/ 实验/ 验证/ 硬件/ 环境/ 使用/ 了/ 4/ 台/ 计算机/ 进行/ 模拟/ ,/ 3/ 台/ 计算机上安装/ 了/ MicrosoftWindowsXP/ ,/ 一台/ 安装/ 了/ 图/ 2/ 物体/ 跟踪/ 结果/ 的/ 帧/ 截图/ 图/ 3/ 根据/ 目标/ 的/ 运动/ 信息/ 制作/ 的/ 图表/ LinuxRedHat/ ./ 采集/ 摄像头/ 使用/ SONYEVID70P/ ,/ 该/ 摄像头/ 支持/ SONY/ 公司/ 的/ VISCA/ 协议/ ,/ 通过/ 串口/ 可/ 对/ 摄像头/ 进行/ 操作/ ./ Windows/ 计算机/ 上/ 使用/ 了/ OpenCV/ [/ 10/ ]/ 开源/ 软件/ ,/ 对/ 视频/ 进行/ 采集/ 和/ 分析/ ./ 一台/ 图像/ 模拟/ 采集/ 工作站/ ,/ 一台/ 模拟/ 图像/ 分析/ 工作站/ ,/ 一台/ 模拟/ 设备/ 控制/ 工作站/ ./ Linux/ 计算机上安装/ 了/ OpenDDS/ 开源/ 软件/ ,/ 模拟/ 订阅/ 发布/ 系统/ 的/ 结构/ ./ 物体/ 运动/ 位移/ 及/ 速度/ 如图/ 3/ ./ 图/ 3/ (/ a/ )/ 是/ 根据/ 手/ 的/ 质心/ 移动/ 的/ 轨迹/ ,/ 横/ 纵坐标/ 是/ 像素/ 的/ 位置/ ./ 图/ 3/ (/ b/ )/ 是/ 每次/ 采集/ 分析/ 运动/ 物体/ 移动/ 像素/ 的/ 个数/ ,/ 当/ 物体/ 刚/ 进入/ 检测/ 范围/ 时/ ,/ 由于/ 控制算法/ 为/ 使/ 运动/ 物体/ 在/ 监/ 采集/ 分析/ 实验/ 过程/ 如图/ 2/ ./ Page6/ 测/ 中心/ 位置/ ,/ 所以/ 反向/ 朝/ 物体/ 转动/ ,/ 导致/ 一/ 开始/ 的/ 速度/ 最大/ ./ 经过/ 运动/ 趋势/ 的/ 预测/ ,/ 控制算法/ 逐渐/ 保持/ 运动/ 物体/ 在/ 监测中心/ ./ 如果/ 运动/ 物体/ 始终保持/ 匀速运动/ ,/ 摄像头/ 通过/ 一定/ 的/ 速率/ 转动/ 可/ 实时/ 跟踪/ 到/ 运动/ 物体/ ,/ 图/ 3/ (/ a/ )/ 是/ 当/ 运动/ 物体/ 改变/ 运动/ 速度/ 时/ ,/ 调整/ 摄像头/ 的/ 转动/ 速度/ ./ 一般/ 摄像头/ 的/ 转动/ 控制/ ,/ 不能/ 做到/ 模拟量/ 输出/ 的/ 精确/ 控制/ ,/ 只能/ 设置/ 数字/ 量/ 为/ 转动/ 参数/ ,/ 进行/ 控制/ ./ 图/ 4/ 所示/ 为/ 控制系统/ 根据/ 目标/ 的/ 运动/ 信息/ ,/ 判断/ 出以/ 开关/ 量/ 输出/ 的/ 数值/ 控制/ 速度/ 转动/ 摄像头/ ./ 速度/ 补偿/ 不是/ 一个/ 恒定/ 的/ 速度/ 设置/ ,/ 每次/ 只/ 对/ 当前/ 控制/ 周期/ 应用/ 一次/ ,/ 下次/ 控制/ 再/ 根据/ 运动/ 物体/ 的/ 位移/ 情况/ ,/ 进行/ 判断/ 补偿/ ./ 主要/ 应用/ 在/ 两种/ 情况/ 下/ :/ (/ 1/ )/ 摄像头/ 转动/ 的/ 速度/ 已经/ 与/ 物体/ 的/ 速度/ 保持/ 相对/ 静止/ ,/ 可以/ 不断/ 地/ 调整/ 速度/ 补偿/ 使/ 监控/ 中心/ 逐渐/ 靠近/ 运动/ 目标/ ;/ (/ 2/ )/ 物体/ 已经/ 运动/ 到/ 采集/ 范围/ 边界/ ,/ 必须/ 紧急/ 调整/ 速度/ ,/ 避免/ 物体/ 逃离/ 监控/ 范围/ ,/ 不图/ 5/ 摄像头/ 补偿/ 速度/ 的/ 调整/ 7/ 结论/ 本文/ 基于/ 发布/ 订阅/ 结构设计/ 了/ 一个/ 视频/ 跟踪/ 系统/ ,/ 多个/ 研究/ 问题/ 结合/ 在/ 一起/ ,/ 搭建/ 了/ 整体/ 的/ 框架/ ,/ 其较/ 已有/ 系统/ 更具/ 实用价值/ :/ (/ 1/ )/ 改进/ 运动/ 目标/ 的/ 速度/ 参数/ ./ 为/ 采集/ 时间/ 间隔/ 内/ 移动/ 的/ 像素数/ ,/ 调整/ 了/ 当前/ 研究/ 中/ 速度/ 是/ 以/ 秒/ 为/ 单位/ 移动/ 的/ 距离/ ,/ 使/ 卡尔曼滤波/ 器/ 更加/ 适用/ 于/ 图像处理/ 时间/ 不/ 恒定/ 的/ 情况/ ./ (/ 2/ )/ 有效/ 地/ 把/ 图像/ 跟踪/ 分析/ 系统/ 与/ 采集/ 设备/ 控制系统/ 结合/ 在/ 一起/ ,/ 在/ 当前/ 的/ 研究/ 中/ ,/ 视觉/ 跟踪/ 理论/ 与/ 采集/ 设备/ 控制/ 理论/ 处于/ 分离/ 状态/ ,/ 跟踪/ 系统/ 不/ 考虑/ 如何/ 为/ 采集/ 设备/ 提供/ 运动/ 信息/ ,/ 所以/ 当前/ 的/ 研究/ 只/ 提供/ 目标/ 的/ 位移/ 信息/ ,/ 而/ 不/ 考虑/ 运动/ 趋势/ (/ 速度/ 矢量/ )/ ./ 同时/ 已有/ 采集/ 系统/ 理想/ 地/ 认为/ 每次/ 都/ 可以/ 得到/ 处理/ 后/ 的/ 最新/ 数据/ ,/ 不/ 考虑/ 运动/ 信息/ 未/ 及时/ 更新/ 或/ 部分/ 数据/ 丢失/ 的/ 情况/ ,/ 因此/ 本文/ 的/ 控制算法/ 很/ 好地解决/ 了/ 这方面/ 的/ 问题/ ./ 能/ 再/ 捕捉到/ 新/ 的/ 图像/ ./ 图/ 5/ 给出/ 了/ 一个/ 补偿/ 示意图/ ./ 一/ 开始/ 物体/ 刚/ 出现/ 在/ 检测/ 范围/ 边缘/ 时/ ,/ 系统控制/ 摄像头/ 的/ 速度/ 方向/ 与/ 物体/ 的/ 运动/ 方向/ 相反/ ,/ 立刻/ 捕捉到/ 物体/ ./ 在/ 运动/ 平稳/ 后/ 速度/ 补偿/ 只有/ 几次/ 变化/ ,/ 是/ 在/ 运动/ 物体/ 速度/ 方向/ 突然/ 发生变化/ 时/ 产生/ 的/ ./ (/ 3/ )/ 创新/ 地/ 将/ 发布/ 订阅/ 机制/ 应用/ 于/ 视觉/ 跟踪/ 系统/ ,/ 可以/ 更好/ 地/ 协调/ 采集/ 、/ 分析/ 、/ 控制/ 子系统/ 的/ 运行/ ./ 已有/ 系统/ 的/ 局限性/ 主要/ 在于/ 当/ 目标/ 的/ 速度/ 快/ 并且/ 非线性/ 运动/ 时/ ,/ 控制系统/ 快速/ 地/ 调整/ 方向/ 及/ 转动/ 速度/ ,/ 导致/ CamShfit/ 的/ 匹配/ 速度/ 降低/ ,/ 卡尔曼滤波/ 的/ 预估/ 与/ 实际/ 值/ 误差/ 较大/ ./ 解决/ 跟踪/ 非线性/ 快速/ 移动/ 物体/ 的/ 问题/ ,/ 需要/ 目标/ 运动/ 的/ 具体/ 实际/ 条件/ 并/ 根据/ 情况/ 建立/ 模型/ ,/ 设计/ 特定/ 的/ 算法/ 进行/ 搜索/ ./ 实验/ 证明/ ,/ 本/ 系统/ 是/ 一个/ 实时性/ 好/ 、/ 扩展性/ 强/ 、/ 有/ 实用价值/ 的/ 视频/ 跟踪/ 系统/ ./ 

