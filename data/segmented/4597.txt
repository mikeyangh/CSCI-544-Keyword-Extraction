Page1/ 利用/ 社交/ 关系/ 的/ 实值/ 条件/ 受限/ 玻尔兹曼/ 机/ 协同/ 过滤/ 推荐/ 算法/ 何洁/ 月/ 马贝/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 210096/ )/ (/ 东南大学/ 计算机网络/ 和/ 信息/ 集成/ 教育部/ 重点/ 实验室/ 南京/ 210096/ )/ 摘要/ 利用/ 受限/ 玻尔兹曼/ 机/ (/ RestrictedBoltzmannMachine/ ,/ RBM/ )/ 解决/ 推荐/ 问题/ 已/ 成为/ 一个/ 很/ 有/ 意义/ 的/ 研究/ 方向/ ./ 目前/ 用于/ 推荐/ 的/ RBM/ 模型/ 中/ 使用/ 的/ 仅仅/ 是/ 用户/ 评分/ 数据/ ,/ 但/ 用户/ 评分/ 数据/ 存在/ 着/ 严重/ 的/ 数据/ 稀疏/ 性/ 问题/ ./ 随着/ 互联网/ 对/ 人们/ 生活/ 的/ 不断/ 渗透/ ,/ 社交/ 网络/ 已经/ 成为/ 人们/ 生活/ 中/ 不可/ 缺少/ 的/ 一部分/ ,/ 利用/ 社交/ 网络/ 中/ 的/ 好友/ 信任/ 关系/ ,/ 有助于/ 缓解/ 评分/ 数据/ 的/ 稀疏/ 性/ 问题/ ,/ 提高/ 推荐/ 系统/ 的/ 性能/ ./ 因此/ ,/ 该文/ 首先/ 提出/ 基于/ 实值/ 的/ 状态/ 玻尔兹曼/ 机/ (/ Real/ -/ ValuedConditionalRestrictedBoltzmannMachine/ ,/ R/ _/ CRBM/ )/ 模型/ ,/ 此/ 模型/ 不/ 需要/ 将/ 评分/ 数据/ 转化/ 为/ 一个/ K/ 维/ 的/ 0/ -/ 1/ 向量/ ,/ 并且/ R/ _/ CRBM/ 模型/ 在/ 训练/ 过程/ 中/ 使用/ 了/ 训练/ 数据/ 中/ 潜在/ 的/ 评分/ // 未/ 评分/ 信息/ ;/ 同时/ 该文/ 将/ 最近/ 信任/ 好友/ 关系/ 应用/ 到/ R/ _/ CRBM/ 模型/ 推荐/ 过程/ 中/ ./ 在/ 百度/ 数据/ 集/ 和/ Epinions/ 数据/ 集上/ 的/ 实验/ 结果表明/ R/ _/ CRBM/ 模型/ 和/ 引入/ 的/ 最近/ 信任/ 好友/ 关系/ 均/ 有助于/ 提高/ 推荐/ 系统/ 的/ 预测/ 精度/ ;/ 最后/ ,/ 针对/ 大/ 数据/ 环境/ 下/ ,/ 普通/ 平台/ 很难/ 完成/ R/ _/ CRBM/ 模型/ 训练/ 的/ 问题/ ,/ 该文/ 提出/ 基于/ Spark/ 的/ 并行/ 化/ 方案/ ,/ 较/ 好地解决/ 了/ 该/ 问题/ ./ 关键词/ 受限/ 玻尔兹曼/ 机/ ;/ 数据/ 稀疏/ 性/ ;/ R/ _/ CRBM/ ;/ 社交/ 网络/ ;/ 信任/ 关系/ ;/ 大/ 数据/ 1/ 引言/ 随着/ 互联网/ 和/ 信息技术/ 的/ 快速/ 发展/ ,/ 微博/ 、/ 即时通讯/ 、/ 搜索引擎/ 、/ 电子商务/ 、/ 网络游戏/ 等/ 网络/ 业务/ 越来越/ 普及/ ,/ 网络/ 信息/ 服务/ 已经/ 渗透到/ 人们/ 生活/ 的/ 各个方面/ ,/ 导致/ 互联网/ 用户/ 的/ 数量/ 急剧/ 增长/ ./ 急剧/ 增加/ 的/ 不仅仅/ 是/ 互联网/ 用户/ 的/ 数量/ ,/ 还/ 包括/ 各种/ 繁多/ 的/ 交易/ 数据/ ./ 面对/ 互联网/ 上/ 如此/ 海量/ 的/ 商品/ ,/ 用户/ 不得不/ 浪费/ 大量/ 的/ 时间/ 来/ 选择/ 自己/ 感兴趣/ 的/ 商品/ ./ 基于/ 此/ ,/ 推荐/ 系统/ 应运而生/ ,/ 出现/ 了/ 很多/ 商用/ 推荐/ 系统/ ,/ 比如/ 为/ 用户/ 推荐/ 图书/ 和/ 其它/ 商品/ 的/ Amazon/ ,/ 中国/ 最大/ 的/ 电子商务/ 平台/ 淘宝网/ ,/ 电影/ 推荐/ 系统/ MovieLens/ ,/ 文章/ 推荐/ 系统/ GroupLens/ 等/ ./ 协同/ 过滤/ 推荐/ 系统/ 的/ 应用/ 最为/ 广泛/ 和/ 成功/ ./ 协同/ 过滤/ 算法/ 分成/ 两类/ [/ 1/ ]/ :/ 基于/ 内存/ 的/ 协同/ 过滤/ (/ Memory/ -/ basedCF/ )/ 、/ 基于/ 模型/ 的/ 协同/ 过滤/ (/ Model/ -/ basedCF/ )/ ./ 基于/ 内存/ 的/ 协同/ 过滤/ ,/ 首先/ 是/ 计算/ 用户/ (/ 或/ 项目/ )/ 之间/ 的/ 相似/ 度/ ,/ 然后/ 是/ 聚合/ 最/ 相似/ 的/ 若干/ 用户/ (/ 或/ 项目/ )/ 的/ 评分/ 进行/ 预测/ ./ 推荐/ 过程/ 中/ 主要/ 根据/ 评分/ 矩阵/ 来/ 进行/ ,/ 评分/ 矩阵/ 就/ 好像/ 是/ 在/ 内存/ 中/ 一样/ ./ 基于/ 模型/ 的/ 协同/ 过滤/ 是从/ 已有/ 的/ 评分/ 矩阵/ 中/ 学习/ 出/ 一个/ 紧凑/ 的/ 模型/ ,/ 后续/ 推荐/ 中/ 用/ 这个/ 模型/ 进行/ 预测/ ./ 建立/ 用户/ 模型/ 是/ 该/ 方法/ 的/ 核心/ ,/ 目前/ 常用/ 的/ 模型/ 包括/ 回归/ 模型/ 、/ 贝叶斯/ 模型/ 、/ 聚类/ 模型/ 、/ 马尔可夫/ 模型/ 、/ 隐/ 语义/ 模型/ 、/ 奇异/ 值/ 分解/ 模型/ 、/ 受限/ 玻尔兹曼/ 机/ (/ RestrictedBoltzmannMachine/ ,/ RBM/ )/ 模型/ [/ 2/ ]/ 等/ ./ 其中/ RBM/ 模型/ 因/ 其/ 准确度/ 较/ 高/ 近年来/ 受到/ 较大/ 关注/ ./ RBM/ (/ 图/ 3/ (/ a/ )/ )/ 可以/ 被/ 视为/ 一个/ 无向/ 图/ 模型/ ,/ 它/ 由/ 两层/ 二进制/ 单元/ 组成/ :/ 一个/ 可见/ 层/ ,/ 表示/ 数据/ ;/ 一个/ 隐层/ ,/ 可/ 视为/ 特征提取/ 器/ 增加/ 学习/ 能力/ [/ 3/ ]/ ,/ 并且/ 层内/ 无/ 连接/ ./ RBM/ 模型/ 已经/ 被/ 实验/ 证明/ 是/ 一种/ 有效/ 的/ 解决/ 推荐/ 问题/ 的/ 方法/ [/ 2/ ,/ 4/ ]/ ./ 2007/ 年/ Salakhutdinov/ 等/ 人/ [/ 2/ ]/ 首次/ 将/ RBM/ 模型/ 应用/ 于/ 解决/ 推荐/ 问题/ ,/ 作者/ 对/ 传统/ 的/ RBM/ 做/ 了/ 两点/ 改变/ :/ 首先/ ,/ 可见/ 层用/ 一个/ 长度/ 为/ K/ 的/ 0/ -/ 1/ 向量/ 单元/ 表示/ 评分/ 数据/ ;/ 其次/ ,/ 用户/ 可能/ 只/ 对/ 若干个/ 项目/ 进行/ 评分/ ,/ 对/ 没有/ 评分/ 的/ 项目/ 使用/ 一种/ 特殊/ 的/ (/ Missing/ )/ 单元/ 表示/ ,/ 这种/ 单元/ 不/ 与/ 任何/ 隐层/ 的/ 单元/ 连接/ ./ 每/ 一个/ 用户/ 都/ 有/ 一个/ 单独/ 的/ RBM/ ,/ 这些/ RBMs/ 对应/ 一个/ 共同/ 的/ 隐层/ ./ 所有/ 的/ RBMs/ 之间/ 的/ 权重/ 和/ 偏置/ 是/ 共享/ 的/ ,/ 所以/ 如果/ 两个/ 用户/ 对/ 同一/ 项目/ 进行/ 了/ 评分/ ,/ 那么/ 将会/ 使用/ 同一个/ 权重/ ./ 作者/ 同时/ 提出/ 了/ 条件/ 受限/ 玻尔兹曼/ 机/ (/ ConditionalRBM/ ,/ CRBM/ )/ 模型/ ,/ CRBM/ 训练/ 过程/ 中/ 利用/ 潜藏在/ 评分/ 数据/ 中/ 的/ 评分/ // 未/ 评分/ 数息/ ,/ 更加/ 突出/ 评分/ 数据/ 的/ 作用/ ./ 但是/ Salakhutdinov/ 等/ 人/ [/ 2/ ]/ 所提/ 模型/ 的/ 缺陷/ 是/ :/ 需要/ 将/ 实值/ 的/ 评分/ 数据/ 转化/ 为/ 一个/ K/ 维/ 的/ 0/ -/ 1/ 向量/ ,/ 可见/ 层/ 与/ 隐藏/ 层/ 之间/ 的/ 连接/ 权重/ 变为/ M/ ×/ K/ ×/ S/ 维/ ,/ 维数/ 变为/ 了/ 原来/ 的/ K/ 倍/ ,/ 从而/ 导致/ 参数/ 过多/ 、/ 训练/ 过程/ 复杂/ 、/ 模型/ 训练/ 时间/ 较长/ ;/ 而且/ 该/ 模型/ 只能/ 将/ 整型/ 的/ 评分/ 数据/ 转化/ 为/ 一个/ K/ 维/ 的/ 0/ -/ 1/ 向量/ ,/ 如果/ 训练/ 数据/ 中/ 的/ 评分/ 是/ Double/ 型/ 的/ 就/ 无法/ 转化/ ./ 2013/ 年/ Georgiev/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ 可/ 直接/ 处理/ 实值/ 评分/ 数据/ 的/ RBM/ 模型/ 并且/ 改进/ 了/ 模型/ 的/ 训练/ 过程/ ,/ 使/ RBM/ 的/ 可见/ 单元/ 可以/ 直接/ 表示/ 实值/ ,/ 模型/ 的/ 训练/ 和/ 预测/ 过程/ 得到/ 了/ 简化/ ,/ 但是/ 模型/ 只/ 利用/ 评分/ 数据/ ,/ 未能/ 解决/ 数据/ 的/ 稀疏/ 性/ 问题/ ;/ 此外/ ,/ 虽然/ 作者/ 改进/ 了/ RBM/ 的/ 训练/ 过程/ ,/ 提高/ 了/ 模型/ 的/ 推荐/ 效果/ ,/ 但是/ 此/ 模型/ 使/ 所有/ 用户/ 对/ 同一/ 项目/ 的/ 预测/ 评分/ 都/ 相同/ ,/ 缺乏/ 可/ 解释性/ ./ 近年来/ ,/ 随着/ 社交/ 网络/ 的/ 流行/ ,/ 利用/ 社交/ 网络/ 中/ 的/ 社交/ 关系/ 来/ 提供/ 推荐/ 服务/ 受到/ 了/ 越来越/ 多/ 学者/ 的/ 关注/ 和/ 研究/ ./ 相对/ 于/ 传统/ 的/ 推荐/ 系统/ ,/ 基于/ 社交/ 网络/ 的/ 推荐/ 系统/ 具有/ 可靠性/ 高/ 、/ 转化/ 潜在/ 需求/ 为/ 实际/ 购买力/ 强/ 等/ 特点/ ./ 由于/ 人们/ 在/ 社交/ 网络/ 中/ 表达/ 了/ 很多/ 隐含/ 的/ 兴趣/ 、/ 爱好/ 等/ 社会/ 媒体/ 信息/ ,/ 因此/ 基于/ 社交/ 网络/ 的/ 推荐/ 系统/ 可以/ 充分利用/ 这些/ 隐含/ 的/ 社会/ 媒体/ 信息/ ./ 目前/ 基于/ 社交/ 网络/ 的/ 推荐/ 系统/ 中/ 一种/ 常用/ 的/ 社会/ 媒体/ 信息/ 是/ 社会/ 信任/ 网络/ ./ Golbeck/ [/ 5/ ]/ 假设/ 用户/ 精确/ 提供/ 了/ 对/ 社交/ 网络/ 中/ 其他/ 用户/ 的/ 信任/ 评分/ ,/ 使用/ 信任/ 值/ 取代/ 相似性/ 的/ 查找/ ,/ 解决/ 数据/ 稀疏/ 性/ 问题/ ./ 但/ 用户/ 提供/ 对/ 社交/ 网络/ 中/ 所有/ 用户/ 的/ 信任/ 评分/ 是/ 不/ 可能/ 的/ ,/ 于是/ 作者/ 提出/ 了/ 一种/ TidalTrust/ [/ 6/ ]/ 推测/ 机制/ :/ 以/ 广度/ 优先/ 搜索/ 方式/ 推测/ 与/ 其他/ 用户/ 之间/ 的/ 间接/ 信任/ 值/ ./ Massa/ 等/ 人/ [/ 7/ -/ 8/ ]/ 使用/ 类似/ 于/ Golbeck/ [/ 5/ ]/ 的/ 方法/ ,/ 但/ 其/ 推导/ 间接/ 用户/ 间/ 之间/ 的/ 信任/ 值/ 的/ 主要/ 思想/ 是/ :/ 考虑/ 预先/ 设定/ 的/ 距离/ 范围/ 内/ 的/ 所有/ 用户/ ,/ 对/ 所有/ 到达/ 用户/ 的/ 路径/ 上/ 的/ 信任/ 值/ 进行/ 加权/ 和/ ,/ 该/ 方法/ 被/ 称为/ MoleTrust/ [/ 7/ -/ 8/ ]/ 算法/ ./ Ma/ 等/ 人/ [/ 9/ -/ 10/ ]/ 提出/ 了/ 一种/ 基于/ 概率/ 矩阵/ 分解/ 的/ 因子分析/ 方法/ ,/ 该/ 方法/ 利用/ 用户/ 的/ 评分/ 信息/ 和/ 社交/ 网络/ 信息/ ,/ 可以/ 很/ 好/ 的/ 解决/ 推荐/ 系统/ 数据/ 稀疏/ 性/ 和/ Page3/ 预测/ 精度/ 低/ 的/ 问题/ ./ Huang/ 等/ 人/ [/ 11/ ]/ 研究/ 了/ 口碑/ 推荐/ 的/ 后/ 影响/ ,/ 发现/ 口碑/ 推荐/ 可以/ 提高/ 用户/ 对/ 项目/ 的/ 后/ 评价/ ./ 这些/ 方法/ 均/ 很/ 好/ 地/ 利用/ 了/ 社交/ 网络/ 信息/ ,/ 提高/ 了/ 推荐/ 系统/ 的/ 预测/ 效果/ ./ 本文/ 借鉴/ Georgiev/ 等/ 人/ [/ 4/ ]/ 提出/ 的/ 实值/ RBM/ 的/ 思想/ ,/ 对/ Salakhutdinov/ 等/ 人/ [/ 2/ ]/ 提出/ 的/ CRBM/ 模型/ 进行/ 了/ 改进/ ,/ 提出/ 了/ R/ _/ CRBM/ 模型/ ./ 此/ 模型/ 不/ 需要/ 将/ 评分/ 数据/ 转化/ 为/ 一个/ K/ 维/ 的/ 0/ -/ 1/ 向量/ ,/ 而且/ 对/ 训练/ 数据/ 的/ 类型/ 没有/ 要求/ ,/ 降低/ 了/ 模型/ 的/ 训练/ 难度/ ,/ 训练/ 过程/ 中/ 使用/ 了/ 潜藏/ 的/ 评分/ // 未/ 评分/ 信息/ ,/ 以/ 提高/ 模型/ 的/ 推荐/ 效果/ ;/ 其次/ ,/ 本文/ 创新性/ 地/ 将/ 最近/ 信任/ 好友/ 的/ 概念/ 加入/ R/ _/ CRBM/ 模型/ ,/ 提出/ 了/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ ./ 在/ 百度/ 数据/ 集/ 和/ Epinions/ 数据/ 集上/ 的/ 实验/ 结果表明/ R/ _/ CRBM/ 模型/ 以及/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ ,/ 均/ 提高/ 了/ 推荐/ 系统/ 的/ 推荐/ 效果/ ./ 本文/ 第/ 2/ 节/ 论述/ R/ _/ CRBM/ 模型/ 和/ 基于/ Mole/ -/ Trust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ ;/ 第/ 3/ 节/ 给出/ 了/ 本/ 模型/ 和/ 算法/ 的/ 实验/ 结果/ 及其/ 分析/ ;/ 最后/ 总结/ 本文/ 的/ 工作/ 并/ 提出/ 下/ 一步/ 的/ 研究/ 方向/ ./ 2/ 算法/ 描述/ 本/ 节/ 首先/ 论述/ 本文/ 提出/ 的/ R/ _/ CRBM/ 模型/ 的/ 原理/ 以及/ 模型/ 中/ 各/ 参数/ 的/ 训练方法/ ;/ 然后/ 论述/ 了/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ ./ 条件/ 受限/ 玻尔兹曼/ 机/ (/ CRBM/ [/ 2/ ]/ )/ 模型/ ,/ 虽然/ 能/ 利用/ 潜藏在/ 评分/ 数据/ 中/ 的/ 评分/ // 未/ 评分/ 数据/ 信息/ ,/ 但/ 实值/ 的/ 评分/ 数据/ 需/ 转化/ 为/ 一个/ K/ 维/ 的/ 0/ -/ 1/ 向量/ ,/ 参数/ 过多/ 、/ 训练/ 过程/ 复杂/ 、/ 模型/ 训练/ 时间/ 较长/ ./ 为此/ ,/ 我们/ 借鉴/ 文献/ [/ 3/ ]/ 的/ 思想/ ,/ 提出/ 直接/ 利用/ 实值/ 的/ R/ _/ CRBM/ 模型/ ,/ 同时/ 在/ 模型/ 中/ 加入/ 最近/ 好友/ 关系/ 以/ 进一步/ 强化/ 推荐/ 的/ 有效性/ ./ 2.1/ 节/ 和/ 2.2/ 节将/ 分别/ 介绍/ R/ _/ CRBM/ 模型/ 和/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ ./ 2.1/ Real/ -/ ValuedConditionalRBM/ (/ R/ _/ CRBM/ )/ 模型/ 在/ 此/ ,/ 我们/ 基于/ 文献/ [/ 4/ ]/ 的/ 思想/ 提出/ R/ _/ CRBM/ 模型/ ,/ 如图/ 1/ 所示/ ./ 此/ 模型/ 中/ 可见/ 单元/ 可/ 直接/ 表示/ 实值/ 的/ 评分/ 数据/ ./ R/ _/ CRBM/ 可以/ 被/ 视为/ 一个/ 无向/ 图/ 模型/ ,/ v/ 为/ 可见/ 层/ ,/ 表示/ 数据/ ;/ h/ 为/ 隐层/ ,/ 可/ 视为/ 特征提取/ 器/ ;/ W/ 为/ 可见/ 层/ 与/ 隐层/ 之间/ 的/ 连接/ 权重/ 矩阵/ ;/ 犇/ 为/ r/ 层/ 和/ 隐层/ 之间/ 的/ 连接/ 权重/ 矩阵/ ;/ c/ 表示/ 可见/ 单元/ 的/ 偏置/ ;/ b/ 表示/ 隐/ 单元/ 的/ 偏置/ ./ 在/ 给定/ 可见/ 单元/ 状态/ (/ 输入/ 数据/ )/ 以及/ 评分/ // 未/ 评分/ 信息/ 时/ ,/ 各隐/ 单元/ 的/ 激活状态/ 条件/ 独立/ ;/ 反之/ ,/ 在/ 给定/ 隐/ 单元/ 状态/ 时/ ,/ 可见/ 层/ 单元/ 的/ 激活状态/ 亦/ 条件/ 独立/ ,/ 并且/ 可/ 通过/ Gibbs/ 采样/ 有效/ 得到/ 服从/ R/ _/ CRBM/ 所/ 表示/ 分布/ 的/ 随机样本/ ./ R/ _/ CRBM/ 考虑/ 了/ 评分/ // 未/ 评分/ 这种/ 潜藏/ 信息/ ,/ 用/ r/ ∈/ {/ 0/ ,/ 1/ }/ M/ 表示/ 评分/ // 未/ 评分/ 信息/ ,/ 其中/ M/ 表示/ 数据/ 集中/ 总/ 的/ 项目数/ ,/ 0/ 表示/ 未/ 对/ 项目/ 评分/ ,/ 1/ 表示/ 已评/ 过分/ ./ 由于/ 将/ 评分/ // 未/ 评分/ 信息/ 纳入/ 考虑/ ,/ 因此/ 向量/ r/ 也/ 将/ 影响/ 隐/ 单元/ 的/ 状态/ (/ 见图/ 1/ )/ ./ R/ _/ CRBM/ 将/ 潜藏在/ 评分/ 数据/ 中/ 的/ 评分/ // 未/ 评分/ 数据/ 信息/ 应用/ 到/ 模型/ 的/ 训练/ 过程/ 中/ ,/ 更加/ 突出/ 评分/ 数据/ 的/ 作用/ ./ R/ _/ CRBM/ 的/ 原理/ 是/ :/ 从隐/ 单元/ 的/ 偏置/ 中/ 减去/ 一部分/ 权重/ 放到/ 权重/ 矩阵/ 犇/ 中/ ,/ 因为/ 权重/ 犇/ 是/ r/ 层/ 和/ 隐/ 单元/ 之间/ 的/ 连接/ 权重/ (/ 见图/ 1/ )/ 而/ r/ 表示/ 评分/ // 未/ 评分/ 信息/ ,/ 因此/ 若/ 用户/ 对/ 项目/ 评分/ ,/ 那么/ 从隐/ 单元/ 的/ 偏置/ 中/ 减去/ 的/ 放到/ 犇/ 中/ 的/ 权重/ 将加/ 回隐/ 单元/ 的/ 偏置/ 中/ (/ 见式/ (/ 1/ )/ )/ ,/ 所以/ 若/ 用户/ 对/ 项目/ 评分/ ,/ 那么/ 从隐/ 单元/ 的/ 偏置/ 中/ 减去/ 的/ 放到/ 犇/ 中/ 的/ 权重/ 不会/ 对隐/ 单元/ 或/ 可见/ 单元/ 产生/ 任何/ 影响/ ./ 但是/ 如果/ 评分/ 缺失/ ,/ 那么/ 从隐/ 单元/ 的/ 偏置/ 中/ 减去/ 的/ 放到/ 犇/ 中/ 的/ 权重/ 将/ 不会/ 加到/ 隐/ 单元/ 的/ 偏置/ 中/ ,/ 因此/ 缺失/ 评分/ 将/ 影响/ 隐/ 单元/ 的/ 特征提取/ ./ 根据/ R/ _/ CRBM/ 层间/ 全/ 连接/ 、/ 层内/ 无/ 连接/ 的/ 特殊/ 结构/ 可知/ :/ 可见/ 层/ 和/ 隐层/ 之间/ 是/ 相互/ 独立/ 的/ ./ 当/ 给定/ 可见/ 单元/ 状态/ 时/ (/ 包括/ 评分/ // 未/ 评分/ 信息/ )/ ,/ 第/ j/ 个/ 隐/ 单元/ 的/ 激活/ 概率/ 为/ P/ (/ hj/ =/ 1/ |/ v/ ,/ r/ )/ =/ σ/ bj/ +/ ∑/ i/ 其中/ ,/ σ/ (/ x/ )/ =/ 1/ // 1/ +/ exp/ (/ -/ x/ )/ ./ 当/ 给定/ 隐/ 单元/ 的/ 状态/ 时/ ,/ 第/ i/ 个/ 可见/ 单元/ 的/ 值/ 为/ [/ 12/ ]/ 2002/ 年/ ,/ Welling/ 和/ Hinton/ [/ 13/ ]/ 提出/ 了/ RBM/ 的/ 快速/ 学习/ 算法/ ,/ 即/ 对比/ 散度/ (/ ContrastiveDivergence/ ,/ Page4CD/ )/ 算法/ ./ R/ _/ CRBM/ 也/ 采用/ 该/ 算法/ ,/ R/ _/ CRBM/ 模型/ 中/ 的/ 参数/ 更新/ 准则/ 为/ Δ/ Wij/ =/ ε/ (/ 〈/ vihj/ 〉/ data/ -/ 〈/ vihj/ 〉/ recon/ )/ vi/ >/ 0/ (/ 3/ )/ Δ/ ci/ =/ ε/ (/ 〈/ vi/ 〉/ data/ -/ 〈/ vi/ 〉/ recon/ )/ vi/ >/ 0/ Δ/ bi/ =/ ε/ (/ 〈/ hj/ 〉/ data/ -/ 〈/ hj/ 〉/ recon/ )/ Δ/ Dij/ =/ ε/ (/ 〈/ hj/ 〉/ data/ -/ 〈/ hj/ 〉/ recon/ )/ ri/ 其中/ :/ 〈/ ·/ 〉/ 表示/ 数学/ 期望/ ;/ 〈/ ·/ 〉/ data/ 表示/ 可见/ 单元/ 已知/ 的/ 情况/ 下/ ,/ 隐层/ 的/ 概率分布/ ;/ 〈/ ·/ 〉/ recon/ 表示/ 用/ CD/ 算法/ 重构/ 后/ 模型/ 定义/ 的/ 分布/ ;/ ε/ 是/ 学习/ 率/ ;/ r/ ∈/ {/ 0/ ,/ 1/ }/ M/ 是/ 一个/ 长度/ 等于/ 评分/ 矩阵/ 中/ 项目数/ 的/ 0/ -/ 1/ 向量/ ,/ 用于/ 指示/ 项目/ 是否/ 被/ 用户/ 评分/ ,/ 即/ 评分/ // 未/ 评分/ 信息/ ./ 训练/ R/ _/ CRBM/ 模型/ 的/ 伪/ 代码/ 见/ 算法/ 1/ ./ 算法/ 1/ ./ 基于/ R/ _/ CRBM/ 模型/ 的/ 协同/ 过滤/ 推荐/ 算法/ (/ 其中/ CD/ 的/ 步长/ 为/ 1/ )/ 的/ 伪/ 代码/ ./ 输入/ :/ 训练/ 数据/ 集/ ,/ 评分/ // 未/ 评分/ 数据/ 输出/ :/ 训练/ 好/ 的/ R/ _/ CRBM/ 模型/ 1/ ./ FORt/ =/ 1/ :/ NumberEpochsDO/ :/ 2/ ./ FORn/ =/ 1/ :/ NumberDataSamplesDO/ :/ 3/ ./ PositivePhase/ :/ P/ (/ hj/ =/ 1v/ ,/ r/ )/ =/ σ/ bj/ +/ ∑/ i4/ ./ NegativePhase/ :/ ①/ :/ P/ (/ vih/ )/ =/ Ν/ ci/ +/ ∑/ j/ 或者/ ②/ :/ 可见/ 单元/ 的/ 值/ 等于/ 该/ 单元/ 和/ 所有/ 隐/ 单元/ 的/ 连接/ 权重/ 的/ 和/ 再/ 加上/ 该/ 可见/ 单元/ 的/ 偏置/ 5/ ./ UpdatePhase/ :/ Δ/ Wij/ =/ ε/ (/ 〈/ vihj/ 〉/ data/ -/ 〈/ vihj/ 〉/ recon/ )/ vi/ >/ 0/ Δ/ ci/ =/ ε/ (/ 〈/ vi/ 〉/ data/ -/ 〈/ vi/ 〉/ recon/ )/ vi/ >/ 0/ Δ/ bi/ =/ ε/ (/ 〈/ hj/ 〉/ data/ -/ 〈/ hj/ 〉/ recon/ )/ Δ/ Dij/ =/ ε/ (/ 〈/ hj/ 〉/ data/ -/ 〈/ hj/ 〉/ recon/ )/ ri6/ ./ ENDFOR7/ ./ ENDFORR/ _/ CRBM/ 模型/ 的/ 训练/ 过程/ 主要/ 分为/ 3/ 个/ 阶段/ :/ 即/ PositivePhase/ 、/ NegativePhase/ 和/ UpdatePhase/ ./ 第/ 1/ 行/ :/ NumberEpochs/ 为/ 训练/ 数据/ 集/ 参与/ 训练/ 的/ 次数/ ;/ 第/ 2/ 行/ :/ NumberDataSamples/ 表示/ 训练/ 数据/ 集/ 的/ 行数/ (/ 或者/ 列数/ )/ ,/ 即将/ 训练/ 数据/ 集中/ 的/ 每行/ 数据/ (/ 或者/ 每列/ 数据/ )/ 依次/ 输入/ 模型/ 参与/ 模型/ 的/ 训练/ ;/ 第/ 3/ 行/ :/ PositivePhase/ 阶段/ ,/ 已知/ 可见/ 单元/ 状态/ 时/ (/ 包括/ 评分/ // 未/ 评分/ 信息/ )/ ,/ 求隐/ 单元/ 的/ 激活/ 概率/ ;/ 第/ 4/ 行/ :/ NegativePhase/ 阶段/ ,/ 已知/ 隐/ 单元/ 的/ 状态/ 时/ ,/ 求/ 可见/ 单元/ 的/ 值/ ./ 在/ 该/ 阶段/ 求/ 可见/ 单元/ 的/ 值/ 有/ 两种/ 方法/ :/ 第/ 1/ 种/ 是/ P/ (/ vi/ |/ h/ )/ =/ Ν/ ci/ +/ ∑/ j/ 第/ 2/ 种/ 方法/ 是/ 可见/ 单元/ 的/ 值/ 等于/ 该/ 单元/ 和/ 所有/ 隐/ 单元/ 的/ 连接/ 权重/ 的/ 和/ 再/ 加上/ 该/ 可见/ 单元/ 的/ 偏置/ ./ 第/ 5/ 行/ :/ UpdatePhase/ 阶段/ ,/ 该/ 阶段/ 更新/ 模型/ 的/ 所有/ 参数/ ./ 值得注意/ 的/ 是/ 计算/ Δ/ W/ 和/ Δ/ c/ 时/ 训练/ 数据/ 中该/ 可见/ 单元/ 的/ 值应/ 大于/ 0/ (/ 即/ 用户/ 对/ 该/ 项目/ 评分/ )/ ./ 2.2/ 基于/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 算法/ 2.2/ ./ 1/ 直接/ 信任度/ 计算/ 用户/ 之间/ 的/ 直接/ 信任/ 关系/ 可以/ 用/ 直接/ 信任/ 网络/ 来/ 表示/ ./ 直接/ 信任/ 网络/ 可以/ 用/ 一个/ 有向图/ G/ =/ (/ U/ ,/ E/ )/ 表示/ ,/ U/ 是/ 图/ 中/ 节点/ 集合/ ,/ 每个/ 节点/ 代表/ 一个/ 用户/ ,/ E/ 是/ 网络/ 中边/ 的/ 集合/ ,/ 每条/ 边上/ 的/ 值/ 表示/ 朋友/ 间/ 的/ 信任/ 值/ ,/ 如图/ 2/ 所示/ ./ 直接/ 信任/ 网络/ 中/ 的/ 信任/ 值/ 一般/ 可以/ 表示/ 成/ [/ 0/ ,/ 1/ ]/ 之间/ 的/ 实数/ ,/ 表达/ 信任/ 的/ 程度/ ,/ 0/ 代表/ 完全/ 不/ 信任/ ,/ 1/ 代表/ 完全/ 信任/ ./ 然而/ ,/ 社交/ 网络/ 只是/ 一个/ 二值/ 网络/ ,/ 0/ 代表/ 不是/ 好友/ ,/ 1/ 代表/ 是/ 好友/ ./ 社交/ 网络/ 中/ 好友/ 关系/ 大量/ 存在/ ,/ 但是/ 好友/ 之间/ 的/ 信任/ 值/ 却/ 无法/ 获得/ ./ 本文/ 的/ 算法/ 中/ 使用/ Pearson/ 系数/ 计算/ 社交/ 网络/ 中/ 好友/ 之间/ 的/ 直接/ 信任/ 值/ ./ Pearson/ 相关系数/ 表示/ 两个/ 变量/ 之间/ 的/ 关联性/ ./ 用户/ u/ 和/ 用户/ v/ 的/ Pearson/ 相关系数/ ,/ 如式/ (/ 7/ )/ 所示/ ./ sim/ (/ u/ ,/ v/ )/ =/ 其中/ :/ Iu/ ,/ v/ 表示/ 用户/ u/ 和/ v/ 共同/ 评分/ 的/ 项目/ 集合/ ;/ Ru/ ,/ c/ 表示/ 用户/ u/ 对/ 项目/ c/ 的/ 评分/ ;/ RPage5/ 练/ 集中/ 用户/ u/ 和/ v/ 对/ 项目/ 的/ 平均/ 评分/ ./ 利用/ Pearson/ 系数/ 计算/ 社交/ 网络/ 中/ 好友/ 之间/ 的/ 直接/ 信任/ 值/ ,/ 基本/ 思想/ 是/ :/ 首先/ 用/ 训练/ 数据/ 训练/ 一个/ R/ _/ CRBM/ 模型/ ,/ 模型/ 训练/ 好/ 以后/ 若/ 两个/ 用户/ 是/ 好友/ 关系/ ,/ 那么/ 对/ 这/ 两个/ 用户/ 的/ 所有/ 项目/ 进行/ 预测/ 评分/ ,/ 然后/ 使用/ Pearson/ 系数/ 计算/ 两个/ 用户/ 的/ 相似性/ ,/ 从而/ 就/ 获得/ 了/ 两个/ 直接/ 好友/ 之间/ 的/ 信任/ 值/ ./ 2.2/ ./ 2/ 间接/ 信任度/ 计算/ 间接/ 信任/ 表示/ 间接/ 好友/ 间/ 的/ 信任/ 程度/ ./ 在/ 社交/ 网络/ 中/ ,/ 用户/ 对/ 其他/ 所有/ 用户/ 提供/ 信任/ 评分/ 是/ 不/ 可能/ 的/ ./ MoleTrust/ 提供/ 了/ 一种/ 推测/ 机制/ ,/ 用/ 好友/ 之间/ 的/ 直接/ 信任/ 值/ 推测/ 间接/ 好友/ 的/ 信任/ 值/ ,/ 其/ 主要/ 思想/ 是/ :/ 考虑/ 预先/ 设定/ 的/ 距离/ 范围/ 内/ 的/ 所有/ 用户/ ,/ 对/ 所有/ 到达/ 用户/ 的/ 路径/ 上/ 的/ 信任/ 值/ 进行/ 加权/ 和/ ./ 2.2/ ./ 3/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ R/ _/ CRBM/ 所谓/ 最近/ 信任/ 好友/ 关系/ 是/ 指/ 和/ 用户/ 是/ 好友/ 关系/ ,/ 同时/ 两人/ 之间/ 的/ 信任/ 值/ 大于/ 阈值/ 0.6/ [/ 6/ ]/ ,/ 并且/ 该/ 好友/ 对/ 用户/ 要/ 预测/ 的/ 项目/ 已/ 评分/ 过/ ,/ 我们/ 将/ 这种/ 好友/ 关系/ 称为/ 最近/ 信任/ 好友/ 关系/ (/ NearestTrustedFriends/ ,/ NTF/ )/ ./ 如图/ 3/ 所示/ ,/ 在/ 图/ 3/ (/ a/ )/ 表示/ 标准/ 的/ RBM/ 的/ 模型/ 图/ ,/ 图/ 3/ (/ b/ )/ 表示/ 我们/ 提出/ 的/ R/ _/ CRBM/ 模型/ 的/ 结构图/ ./ 在/ 利用/ R/ _/ CRBM/ 模型/ 进行/ 推荐/ 时/ ,/ 每/ 一个/ 用户/ 都/ 有/ 一个/ 单独/ 的/ R/ _/ CRBM/ ,/ 这些/ R/ _/ CRBMs/ 对应/ 一个/ 共同/ 的/ 隐层/ ,/ 所有/ 的/ R/ _/ CRBMs/ 之间/ 的/ 权重/ 和/ 偏置/ 是/ 共享/ 的/ ,/ 所以/ 如果/ 两个/ 用户/ 对/ 同一/ 项目/ 进行/ 了/ 评分/ ,/ 那么/ 将会/ 使用/ 同一个/ 权重/ ./ Ziegler/ 和/ Golbeck/ [/ 14/ ]/ 研究/ 了/ 用户/ 兴趣/ 相似性/ 与/ 用户/ 间/ 信任/ 的/ 联系/ ,/ 结果表明/ 两者之间/ 存在/ 着/ 正/ 相关性/ ,/ 即/ 用户/ 之间/ 的/ 信任度/ 较/ 高/ ,/ 则/ 他们/ 兴趣/ 相似性/ 也/ 相对/ 较/ 高/ ./ 如图/ 3/ (/ b/ )/ ,/ 假设/ 要/ 预测/ 用户/ 1/ 对/ 第/ 2/ 个/ 项目/ 的/ 评分/ ,/ 用户/ u/ 是/ 用户/ 1/ 的/ 好友/ 那么/ 他们/ 的/ 兴趣/ 也/ 必然/ 比较/ 相似/ ,/ 恰好/ 此时/ 用户/ u/ 对/ 第/ 2/ 项目/ 已/ 评分/ 过/ ,/ 因此/ ,/ 用户/ u/ 是/ 用户/ 1/ 关于/ 第/ 2/ 个/ 项目/ 的/ 最近/ 信任/ 好友/ ./ R/ _/ CRBM/ 模型/ 训练/ 好/ 以后/ 就/ 可以/ 利用/ 用户/ u/ 对/ 第/ 2/ 个/ 项目/ 的/ 预测/ 评分/ 来/ 改善/ 用户/ 1/ 对/ 第/ 2/ 个/ 项目/ 的/ 评分/ ./ 利用/ MoleTrust/ 算法/ 得到/ 的/ 信任/ 网络/ ,/ 在/ 信任/ 网络/ 中/ 寻找/ 最近/ 信任/ 好友/ ,/ 从而/ 利用/ 最近/ 信任/ 好友/ 的/ 预测/ 评分/ 来/ 改善/ 预测/ 效果/ ./ 基于/ 此/ 我们/ 提出/ 了/ 基于/ MoleTrust/ 推理/ 的/ 最近/ 信任/ 好友/ (/ NearestTrustedFriendsBasedonMoleTrust/ ,/ NTFMT/ )/ R/ _/ CRBM/ 算法/ ,/ 称其为/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ./ 该/ 算法/ 在/ 预测/ 评分/ 过程/ 中/ 考虑/ 了/ 均值/ 因素/ 的/ 影响/ ,/ 因为/ 即使/ 两个/ 用户/ 的/ 平均/ 评分/ 不同/ ,/ 但是/ 利用/ Pearson/ 系数/ 求得/ 的/ 相似性/ 也/ 可能/ 很/ 高/ ./ R/ _/ CRBM/ _/ NTFMT/ 算法/ 中/ 用户/ u/ 对/ 项目/ i/ 的/ 预测/ 评分/ 如式/ (/ 8/ )/ 所示/ ./ R/ ^/ u/ ,/ i/ =/ meanui/ +/ 其中/ 其中/ :/ user/ _/ meanu/ 表示/ 训练/ 集中/ 用户/ u/ 的/ 平均/ 评分/ ;/ item/ _/ meani/ 为/ 训练/ 集中/ 项目/ i/ 的/ 平均/ 评分/ ;/ meanui/ 表示/ 用户/ u/ 的/ 平均/ 评分/ 和/ 项目/ i/ 的/ 平均/ 评分/ 的/ 平均/ ,/ 综合/ 考虑/ 用户/ 平均/ 评分/ 和/ 项目/ 平均/ 评分/ 的/ 影响/ ;/ meanki/ 表示/ 用户/ k/ 的/ 平均/ 评分/ 和/ 项目/ i/ 的/ 平均/ 评分/ 的/ 平均/ ;/ F/ 为/ 最近/ 信任/ 好友/ 的/ 数目/ ;/ friendski/ 表示/ 最近/ 信任/ 好友/ k/ 的/ R/ _/ CRBM/ 模型/ 对/ 项目/ i/ 的/ 预测/ 评分/ ;/ trust/ _/ valueuk/ 表示/ 用户/ u/ 和/ k/ 之间/ 的/ 信任/ 值/ (/ 大于/ 阈值/ 0.6/ [/ 7/ ]/ )/ ./ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 基本/ 思想/ 是/ :/ 首先/ 用/ 训练/ 数据/ 训练/ 一个/ R/ _/ CRBM/ 模型/ ,/ 然后/ 在/ 用户/ 的/ 信任/ 网络/ 中/ 寻找/ 最近/ 信任/ 好友/ 关系/ ,/ 最后/ 利用/ 最近/ 信任/ 好友/ 的/ 预测/ 评分/ 来/ 改善/ 用户/ 对/ 项目/ 的/ 预测/ 评分/ ./ 其伪/ 代码/ 如/ 算法/ 2/ 和/ 算法/ 3/ 所示/ ./ 算法/ 2/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 输入/ 是/ 训练/ 数据/ 集/ 、/ 评分/ // 未/ 评分/ 数据/ 、/ 好友/ 社交/ 关系/ 网络/ 和/ 距离/ 参数/ Distance/ 的/ 值/ ,/ 输出/ 是/ 预测/ 评分/ ./ 而/ 算法/ 3/ 的/ ConstructTrustNet/ 函数/ 的/ 功能/ 是/ 用/ 好友/ 社交/ 关系/ 网络/ 构建/ 信任/ 网络/ ,/ 其/ 输入/ 为/ 训练/ 好/ 的/ R/ _/ CRBM/ 模型/ 、/ 好友/ 社交/ 关系/ 网络/ 以及/ 距离/ Distance/ 的/ 值/ ,/ 输出/ 是/ 信任/ 网络/ Trust/ _/ net/ ./ Page6/ 算法/ 2/ ./ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 伪/ 代码/ ./ 输入/ :/ 训练/ 数据/ 集/ 、/ 评分/ // 未/ 评分/ 数据/ 、/ 好友/ 社交/ 关系网/ 输出/ :/ 预测/ 评分/ // // Trust/ _/ net/ 表示/ 信任/ 网络/ // // F/ 是/ 用户/ u/ 关于/ 项目/ i/ 的/ 最近/ 信任/ 好友/ 的/ 数目/ 1/ ./ 训练/ 一个/ R/ _/ CRBM/ 模型/ 2/ ./ 调用/ ConstructTrustNet/ 函数/ 构建/ Trust/ _/ net3/ ./ FORallratingswhichneedtobepredictedDO/ :/ 4/ ./ 寻找/ 用户/ u/ 关于/ 项目/ i/ 的/ 所有/ 最近/ 信任/ 好友/ ;/ 5/ ./ meanui/ =/ 6/ ./ meanki/ =/ 7/ ./ R/ ^/ 8/ ./ ENDFOR/ 算法/ 3/ ./ ConstructTrustNet/ 函数/ 的/ 伪/ 代码/ ./ 输入/ :/ R/ _/ CRBM/ 模型/ 、/ 好友/ 社交/ 关系/ 网络/ 和/ 距离/ 参数/ 输出/ :/ Trust/ _/ net/ // // Trust/ _/ net/ 表示/ 信任/ 网络/ // // Trust/ _/ net/ _/ direct/ 表示/ 直接/ 信任/ 网络/ 1/ ./ FORallfriendship/ (/ u1/ ,/ u2/ )/ inSocial/ _/ networkDO/ :/ 2/ ./ 使用/ R/ _/ CRBM/ 模型/ 预测/ 用户/ u1/ ,/ u2/ 对/ 所有/ 项目/ 3/ ./ 使用/ Pearson/ 相关系数/ 计算/ u1/ 和/ u2/ 之间/ 的/ 信任/ 值/ ;/ 4/ ./ 将/ u1/ 和/ u2/ 之间/ 的/ 信任/ 值/ 加入/ Trust/ _/ net/ _/ direct5/ ./ ENDFOR/ // // 使用/ Trust/ _/ net/ _/ direct/ 构建/ Trust/ _/ net6/ ./ 使用/ MoleTrust/ 算法/ 推理/ 得到/ Trust/ _/ net7/ ./ END/ 从/ 算法/ 2/ 可/ 看出/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 实现/ 推荐/ 的/ 过程/ 主要/ 可/ 划分/ 为/ 3/ 步/ :/ 第/ 1/ 行/ :/ 用/ 训练/ 数据/ 训练/ 一个/ R/ _/ CRBM/ 模型/ ;/ 第/ 2/ 行/ :/ 调用/ ConstructTrustNet/ 函数/ ,/ 获得/ 信任/ 网络/ ;/ 第/ 3/ 行/ ~/ 结尾/ :/ 首先/ ,/ 在/ 信任/ 网络/ 中/ 寻找/ 用户/ u/ 关于/ 项目/ i/ 的/ 最近/ 信任/ 好友/ ;/ 然后/ ,/ 根据/ 式/ (/ 8/ )/ ~/ (/ 10/ )/ 计算/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 对/ 相应/ 预测/ 项目/ 的/ 预测/ 评分/ ,/ 即用/ 最近/ 信任/ 好友/ 的/ 预测/ 评分/ 来/ 改善/ 用户/ 对/ 项目/ 的/ 预测/ 评分/ ./ 算法/ 3/ 是/ ConstructTrustNet/ 函数/ 的/ 伪/ 代码/ ,/ 该/ 函数/ 的/ 功能/ 是/ 用/ 好友/ 社交/ 关系/ 网络/ 构建/ 信任/ 网络/ ,/ 主要/ 可/ 划分/ 为/ 两步/ :/ 第/ 1/ 行/ ~/ 第/ 5/ 行/ :/ 若/ (/ u1/ ,/ u2/ )/ 是/ 社交/ 网络/ 中/ 的/ 好友/ 关系/ ,/ 用/ 训练/ 好/ 的/ R/ _/ CRBM/ 模型/ 预测/ u1/ ,/ u2/ 对/ 所有/ 项目/ 的/ 评分/ ;/ 然后/ 用/ Pearson/ 系数/ 计算/ u1/ ,/ u2/ 的/ 信任/ 值/ ,/ 从而/ 构建/ 了/ 好友/ 之间/ 的/ 直接/ 信任/ 网络/ ;/ 第/ 6/ 行/ ~/ 结尾/ :/ 用/ 直接/ 信任/ 网络/ ,/ 通过/ Mole/ -/ Trust/ 算法/ 推理/ 得到/ 用户/ 之间/ 的/ 信任/ 网络/ ./ 3/ 实验/ 结果/ 及/ 分析/ 本/ 节/ 通过/ 实验/ 验证/ 我们/ 所提/ 算法/ 的/ 性能/ ,/ 实验/ 数据/ 采用/ 百度/ 推荐/ 大赛/ 数据/ 集/ 和/ Epinions/ 数据/ 集/ ,/ 其中/ 80/ %/ 的/ 数据/ 作为/ 训练/ 数据/ ,/ 20/ %/ 的/ 数据/ 作为/ 测试数据/ ,/ MoleTrust/ 算法/ 和/ RBM/ [/ 4/ ]/ 模型/ (/ 包括/ 文献/ [/ 4/ ]/ 改进/ 的/ 训练/ 过程/ )/ 作为/ 对比/ 结果/ ./ 文献/ [/ 4/ ]/ 改进/ 了/ 标准/ CD/ 算法/ 的/ 训练/ 过程/ ,/ 改进/ 思想/ 是/ :/ 可见/ 单元/ 的/ 值/ 等于/ 对应/ 隐/ 单元/ 连接/ 权重/ 的/ 和/ (/ sumweight/ )/ 再/ 加上/ 偏置/ ,/ 我们/ 将/ 此时/ 的/ RBM/ 模型/ 我们/ 称其为/ S/ _/ RBM/ ./ 3.1/ 数据/ 集/ 百度/ 推荐/ 大赛/ 的/ 数据/ 集/ ,/ 可/ 从/ http/ :/ // // www/ ./ datatang/ ./ com/ // data/ // 44268/ 下载/ ./ 首先/ 对/ 数据/ 集/ 进行/ 了/ 预处理/ ,/ 将/ 评分/ 数据/ 中/ 没有/ 好友/ 关系/ 的/ 用户/ 的/ 数据/ 剔除/ ,/ 得到/ 一个/ 3193/ 个/ 用户/ 对/ 7889/ 部/ 电影/ 的/ 评分/ 数据/ ,/ 包括/ 其/ 好友/ 关系/ 网络/ ./ Epinions/ 数据/ 集由/ Massa/ 等/ 人/ [/ 15/ ]/ 从/ Epinions/ ./ com/ 网站/ 上/ 收集/ 得到/ ,/ 包含/ 40163/ 个/ 用户/ 对/ 139529/ 个/ 项目/ 的/ 评分/ ./ 我们/ 从/ 该/ 数据/ 集中/ 抽取/ 了/ 一个/ 1963/ 名/ 用户/ 对/ 2436/ 个/ 项目/ 的/ 评分/ 数据/ 集/ 作为/ 实验/ 数据/ ,/ 包括/ 其/ 好友/ 关系/ ./ 3.2/ 评价/ 指标/ 目前/ ,/ 绝大多数/ 的/ 推荐/ 系统/ 都/ 使用/ 预测/ 准确度/ 来/ 评价/ 推荐/ 算法/ 的/ 性能/ ,/ 预测/ 准确度/ 是/ 比较/ 推荐/ 算法/ 的/ 预测/ 评分/ 与/ 用户/ 实际/ 评分/ 的/ 相似/ 程度/ ./ 预测/ 准确度/ 的/ 常用/ 度量/ 方法/ 有/ 平均/ 绝对误差/ (/ MAE/ [/ 16/ -/ 17/ ]/ )/ 、/ 根均方/ 误差/ (/ RMSE/ [/ 18/ ]/ )/ ./ 平均/ 绝对误差/ 计算/ 预测/ 评分/ 与/ 用户/ 实际/ 评分/ 之间/ 的/ 平均/ 绝对误差/ 值/ ./ 它/ 的/ 计算公式/ 如式/ (/ 11/ )/ 所示/ ./ 其中/ :/ Rtest/ 表示/ 测试/ 集/ 数据/ ;/ Ru/ ,/ i/ 表示/ 用户/ u/ 对/ 项目/ i/ 的/ 实际/ 评分/ ;/ R/ ^/ Rtest/ 是/ 测试/ 集中/ 数据/ 的/ 个数/ ./ 推荐/ 算法/ 的/ 准确度/ 是/ 所有/ 用户/ 预测/ 评分/ 与/ 用户/ 实际/ 评分/ 之差/ 的/ 平均/ ./ 根均方/ 误差/ 计算/ 用户/ 实际/ 评分/ 与/ 预测/ 评分/ 之间/ Page7/ 的/ 根均方/ 误差/ ./ 它/ 的/ 计算公式/ 如式/ (/ 12/ )/ 所示/ ./ 其中/ :/ Rtest/ 表示/ 测试/ 集/ 数据/ ;/ Ru/ ,/ i/ 表示/ 用户/ u/ 对/ 项目/ i/ 的/ 实际/ 评分/ ;/ R/ ^/ Rtest/ 是/ 测试/ 集中/ 数据/ 的/ 个数/ ./ 根均方/ 误差/ 在/ 求和/ 之前/ 对系统/ 预测/ 评分/ 与/ 用户/ 实际/ 评分/ 的/ 误差/ 进行/ 平方/ ,/ 因此/ 评分/ 之间/ 的/ 误差/ 越大/ ,/ 其/ 对/ 根均方/ 误差/ 的/ 影响/ 会/ 比/ 平均/ 绝对误差/ 更大/ ./ 3.3/ 百度/ 数据/ 集/ 实验/ 结果/ 及/ 分析/ 3.3/ ./ 1MoleTrust/ 算法/ 中/ 参数/ Distance/ 值/ 的/ 确定/ MoleTrust/ 算法/ 考虑/ 预先/ 设定/ 的/ 距离/ (/ Distance/ )/ 范围/ 内/ 的/ 所有/ 用户/ ./ 为了/ 计算/ 用户/ u/ 对/ 用户/ v/ 的/ 信任/ 值/ ,/ 前/ 节点/ 用户/ 的/ 信任/ 值以/ 信任/ 边为/ 权值/ 进行/ 加权/ 和/ ,/ 即/ 构建/ 了/ 一个/ 以/ 用户/ u/ 为/ 核心/ 的/ 距离/ Distance/ 范围/ 内/ 的/ 信任/ 网络/ ./ 图/ 4/ 和/ 图/ 5/ 验证/ MoleTrust/ 算法/ 中距离/ Distance/ 对/ 预测/ 结果/ 的/ 影响/ ./ 图/ 4MoleTrust/ 算法/ 中/ 参数/ Distance/ 值/ 对/ MAE/ 值/ 的/ 影响/ 图/ 5MoleTrust/ 算法/ 中/ 参数/ Distance/ 值/ 对/ RMSE/ 值/ 的/ 影响/ 图/ 4/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 最大/ 距离/ Distance/ 的/ 值/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ./ 图/ 5/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 距离/ Distance/ 的/ 值/ ,/ 纵坐标/ 为/ RMSE/ 的/ 值/ ./ 从/ 两张/ 图中/ 可/ 明显/ 看出/ 当/ Distance/ 达到/ 6/ 以后/ ,/ MAE/ 和/ RMSE/ 基本/ 就/ 不再/ 减少/ ./ 因此/ 在/ 下面/ 的/ 实验/ 中/ 我们/ 使用/ MoleTrust/ 算法/ 中/ Distance/ 为/ 6/ 所/ 对应/ 的/ 信任/ 网络/ ,/ 并且/ 将/ Distance/ 为/ 6/ 所/ 对应/ MoleTrust/ 算法/ 的/ 预测/ 结果/ 作为/ 一个/ 对比/ 结果/ ./ 3.3/ ./ 2RBM/ 模型/ 中隐/ 单元/ 数目/ 的/ 确定/ 本/ 实验/ 的/ 目的/ 是/ 考察/ RBM/ [/ 4/ ]/ 模型/ 中隐/ 单元/ 数目/ 对/ 推荐/ 结果/ 的/ 影响/ ,/ 确定/ 隐/ 单元/ 的/ 数目/ 使/ RBM/ 模型/ 的/ 推荐/ 结果/ 最优/ ,/ 实验/ 是/ 基于/ 训练/ 次数/ Epochs/ 为/ 10/ 进行/ 的/ ,/ 实验/ 结果/ 如图/ 6/ 和/ 图/ 7/ 所示/ ./ 图/ 6RBM/ 模型/ 中隐/ 单元/ 数目/ 对/ MAE/ 值/ 的/ 影响/ 图/ 7RBM/ 模型/ 中隐/ 单元/ 数目/ 对/ RMSE/ 值/ 的/ 影响/ 图/ 6/ 坐标系/ 中/ ,/ 横坐标/ 表示/ RBM/ 模型/ 中隐/ 单元/ 数目/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ./ 图/ 7/ 坐标系/ 中/ ,/ 横坐标/ 表示/ RBM/ 模型/ 中隐/ 单元/ 数目/ ,/ 纵坐标/ 为/ RMSE/ 的/ 值/ ./ 从图/ 6/ 和/ 图/ 7/ 可/ 发现/ 随着/ 隐/ 单元/ 数目/ 的/ 增加/ ,/ MAE/ 与/ RMSE/ 值/ 先降/ 后升/ ,/ 说明/ 模型/ 的/ 效果/ 呈现/ 了/ 先变/ 好/ 后/ 变差/ 的/ 趋势/ ./ 隐/ 单元/ 用于/ 提取/ 数据/ 的/ 特征/ ,/ 当/ 模型/ 提取/ 的/ 特征/ 较/ 少时/ 这些/ 特征/ 不足以/ 表达/ 数据/ 的/ 特征/ ,/ 此时/ 增加/ 提取/ 的/ 特征/ 数/ ,/ 模型/ 的/ 效果/ 会/ 逐渐/ 变/ 好/ ,/ 但是/ 当/ 模型/ 提取/ 的/ 特征/ 达到/ 一定/ Page8/ 程度/ 后/ ,/ 此时/ 增加/ 提取/ 的/ 特征/ 会/ 导致/ 特征/ 过多/ 反而/ 影响/ 模型/ 的/ 效果/ ./ 从图/ 6/ 中/ 可/ 发现/ 隐/ 单元/ 数为/ 80/ 时/ 对应/ 的/ MAE/ 值/ 最小/ ,/ 图/ 7/ 中隐/ 单元/ 数为/ 90/ 时/ 对应/ 的/ RMSE/ 值/ 最小/ ,/ 综合/ 考虑/ 隐/ 单元/ 为/ 80/ 和/ 90/ 时/ 的/ MAE/ 、/ RMSE/ 值/ ,/ 隐/ 单元/ 数为/ 80/ 时/ 效果/ 更好/ ,/ 因此/ 下面/ 的/ 实验/ 中/ RBM/ 、/ S/ _/ RBM/ 和/ R/ _/ CRBM/ 模型/ 的/ 隐/ 单元/ 数目/ 都/ 为/ 80.3/ ./ 3.3/ 训练/ 数据/ 参与/ 训练/ 次数/ Epochs/ 对/ 推荐/ 结本/ 实验/ 中/ 使用/ MoleTrust/ 算法/ 中/ Distance/ 为/ 6/ 所/ 对应/ 的/ 信任/ 网络/ ,/ RBM/ 、/ S/ _/ RBM/ 和/ R/ _/ CRBM/ 模型/ 的/ 隐/ 单元/ 数目/ 均/ 为/ 80/ ./ 实验/ 结果/ 如图/ 8/ 和/ 图/ 9/ 所示/ ./ 图/ 8/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 训练/ 集/ 参与/ 训练/ 的/ 次数/ Epochs/ 的/ 值/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ;/ 图/ 9/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 训练/ 集/ 参与/ 训练/ 的/ 次数/ Epochs/ 的/ 值/ ,/ 纵坐标/ 为/ 评价/ 指标/ RMSE/ 的/ 值/ ./ 两图/ 中/ MoleTrust/ 表示/ MoleTrust/ 算法/ 中/ Distance/ 为/ 6/ 所/ 对应/ 的/ 预测/ 结果/ ./ 从/ 两图/ 中/ 可/ 发现/ R/ _/ CRBM/ 模型/ 的/ 实验/ 结果/ 均略/ 优于/ RBM/ 模型/ ,/ 说明/ 潜藏/ 的/ 评分/ // 未/ 评分/ 信息/ 可以/ 改善/ 预测/ 效果/ ./ S/ _/ RBM/ 模型/ 推荐/ 效果/ 比/ RBM/ 模型/ 有/ 了/ 一定/ 程度/ 的/ 提高/ ,/ 但是/ 其/ 缺点/ 是/ 使/ 所有/ 用户/ 对/ 同一/ 项目/ 的/ 预测/ 评分/ 均/ 相同/ ,/ 这/ 缺乏/ 可/ 解释性/ ./ 从/ 两图/ 中/ 可/ 看出/ 我们/ 提出/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 预测/ 性能/ 优于/ 所有/ 的/ 算法/ ,/ 而且/ 是/ 一种/ 比较稳定/ 的/ 算法/ ,/ 其/ MAE/ 和/ RMSE/ 基本/ 是/ 稳定/ 的/ ,/ 受/ Epochs/ 的/ 影响/ 不/ 大/ ,/ 达到/ 了/ 较/ 好/ 的/ 预测/ 效果/ ./ 3.3/ ./ 4/ 数据/ 稀疏/ 性/ 实验/ 本/ 实验/ 通过/ 改变/ 训练/ 数据/ 集/ 和/ 测试数据/ 集占/ 评分/ 数据/ 的/ 比例/ ,/ 观测/ 数据/ 在/ 不同/ 稀疏/ 性/ 的/ 情况/ 下/ 对/ 实验/ 结果/ 的/ 影响/ ./ 本/ 实验/ 分别/ 将/ 评分/ 数据/ 中/ 的/ 20/ %/ 、/ 40/ %/ 、/ 60/ %/ 、/ 80/ %/ 作为/ 训练/ 数据/ 集/ ,/ 相应/ 地/ 测试数据/ 集占/ 评分/ 数据/ 的/ 比例/ 分别/ 为/ 80/ %/ 、/ 60/ %/ 、/ 40/ %/ 、/ 20/ %/ ./ 实验/ 结果/ 如图/ 10/ 和/ 图/ 11/ 所示/ ./ 图/ 10/ 中/ ,/ 横坐标/ 表示/ 不同/ 稀疏/ 度/ 的/ 训练/ 数据/ 集/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ;/ 图/ 11/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 不同/ 稀疏/ 度/ 的/ 训练/ 数据/ 集/ ,/ 纵坐标/ 为/ 评价/ 指标/ RMSE/ 的/ 值/ ./ 从/ 两图/ 中/ 可/ 发现/ 随着/ 训练/ 数据/ 集占/ 整个/ 数据/ 集/ 比例/ 的/ 提高/ ,/ 也就是说/ 随着/ 数据/ 稀疏/ 性/ 的/ 减少/ ,/ 几种/ 算法/ 的/ MAE/ 值/ 和/ RMSE/ 值均/ 减小/ ,/ 也/ 就是/ 推荐/ 效果/ 不断/ 变好/ ./ 两图/ 中/ R/ _/ CRBM/ 模型/ 的/ 推荐/ 效果/ 均/ 优于/ RBM/ 模型/ 的/ 结果/ ,/ 表明/ 评分/ // 未/ 评分/ 信息/ 确实/ 有利于/ 提高/ 推荐/ 结果/ ,/ 在/ 一定/ 程度/ 上/ 解决/ 了/ 数据/ 稀疏/ 性/ 问题/ ;/ S/ _/ RBM/ 模型/ 的/ 效果/ 较/ Page9RBM/ 模型/ 也/ 有/ 了/ 一定/ 程度/ 的/ 提高/ ;/ 我们/ 提出/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 推荐/ 结果/ 远远/ 优于/ RBM/ 和/ S/ _/ RBM/ 模型/ ,/ 表明/ 我们/ 利用/ 的/ 最近/ 信任/ 好友/ 关系/ 确实/ 有利于/ 提高/ 推荐/ 效果/ ,/ 而且/ 数据/ 越/ 稀疏/ 预测/ 效果/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 提高/ 的/ 越/ 多/ ./ 当/ 训练/ 数据/ 占/ 20/ %/ 时/ ,/ 我们/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ,/ MAE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 6.92/ %/ 和/ 4.25/ %/ ,/ RMSE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 10.70/ %/ 和/ 8.55/ %/ ;/ 当/ 训练/ 数据/ 占/ 80/ %/ 时/ ,/ 我们/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ,/ MAE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 3.06/ %/ 和/ 2.27/ %/ ,/ RMSE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 4.76/ %/ 和/ 4.03/ %/ ./ 3.4/ Epinions/ 数据/ 集/ 实验/ 结果/ 及/ 分析/ 参数/ Distance/ 和/ 隐/ 单元/ 数目/ 的/ 确定/ 与/ 百度/ 数据/ 集/ 类似/ ,/ 这里/ 不再/ 展示/ ./ 实验/ 中/ 使用/ MoleTrust/ 算法/ 中/ Distance/ 为/ 3/ 所/ 对应/ 的/ 信任/ 网络/ ,/ 并且/ 将/ Distance/ 为/ 3/ 所/ 对应/ MoleTrust/ 算法/ 的/ 预测/ 结果/ 作为/ 一个/ 对比/ 结果/ ,/ RBM/ 、/ S/ _/ RBM/ 和/ R/ _/ CRBM/ 模型/ 的/ 隐/ 单元/ 数目/ 均/ 为/ 80.3/ ./ 4.1/ 训练/ 数据/ 参与/ 训练/ 次数/ Epochs/ 对/ 推荐/ 结本/ 实验/ 主要/ 考查/ 随着/ 训练/ 数据/ 集/ 参与/ 训练/ 次数/ Epochs/ 的/ 增加/ ,/ 各/ 算法/ 的/ 推荐/ 结果/ 的/ 变化/ 情况/ ./ 实验/ 结果/ 如图/ 12/ 和/ 图/ 13/ 所示/ ./ 图/ 12/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 训练/ 集/ 参与/ 训练/ 的/ 次数/ Epochs/ 的/ 值/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ;/ 图/ 13/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 训练/ 集/ 参与/ 训练/ 的/ 次数/ Epochs/ 的/ 值/ ,/ 纵坐标/ 为/ 评价/ 指标/ RMSE/ 的/ 值/ ./ 两图/ 中/ MoleTrust/ 表示/ MoleTrust/ 算法/ 中/ Distance/ 为/ 3/ 所/ 对应/ 的/ 预测/ 结果/ ,/ 可/ 发现/ MoleTrust/ 算法/ 在/ Epinions/ 数据/ 集上/ 取得/ 了/ 较/ 好/ 的/ 推荐/ 效果/ ./ S/ _/ RBM/ 、/ R/ _/ CRBM/ 模型/ 在/ 此/ 数据/ 集上/ 的/ 实验/ 结果/ 仍然/ 优于/ RBM/ 模图/ 12Epinions/ 数据/ 集上/ 各/ 方法/ 的/ MAE/ 值图/ 13Epinions/ 数据/ 集上/ 各/ 方法/ 的/ RMSE/ 值型/ ./ 我们/ 提出/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 取得/ 了/ 最好/ 的/ 预测/ 效果/ ./ 3.4/ ./ 2/ 数据/ 稀疏/ 性/ 实验/ 本/ 实验/ 将/ 评分/ 数据/ 中/ 的/ 20/ %/ 、/ 40/ %/ 、/ 60/ %/ 、/ 80/ %/ 作为/ 训练/ 数据/ 集/ ,/ 相应/ 地/ 测试数据/ 集占/ 评分/ 数据/ 的/ 比例/ 分别/ 为/ 80/ %/ 、/ 60/ %/ 、/ 40/ %/ 、/ 20/ %/ ./ 实验/ 结果/ 如图/ 14/ 和/ 图/ 15/ 所示/ ./ 图/ 14/ 中/ ,/ 横坐标/ 表示/ 不同/ 稀疏/ 度/ 的/ 训练/ 数据/ 集/ ,/ 纵坐标/ 为/ 评价/ 指标/ MAE/ 的/ 值/ ;/ 图/ 15/ 坐标系/ 中/ ,/ 横坐标/ 表示/ 不同/ 稀疏/ 度/ 的/ 训练/ 数据/ 集/ ,/ 纵坐标/ 为/ 评价/ 指标/ RMSE/ 的/ 值/ ./ 从/ 两图/ 中/ 可/ 发现/ 随着/ 训练/ 数据/ 集占/ 整个/ 数据/ 集/ 比例/ 的/ 提高/ ,/ 几种/ 算法/ 推荐/ 效果/ 均/ 不断/ 变好/ ./ 两图/ 中/ R/ _/ CRBM/ 和/ S/ _/ RBM/ 模型/ 的/ 效果/ Page10/ 较为/ 接近/ ,/ R/ _/ CRBM/ 和/ S/ _/ RBM/ 模型/ 的/ 推荐/ 结果/ 均/ 优于/ RBM/ 模型/ 的/ 结果/ ,/ 表明/ 评分/ // 未/ 评分/ 信息/ 确实/ 有利于/ 提高/ 推荐/ 结果/ ,/ 在/ 一定/ 程度/ 上/ 解决/ 了/ 数据/ 稀疏/ 性/ 问题/ ;/ 我们/ 提出/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 推荐/ 结果/ 远远/ 优于/ RBM/ 和/ S/ _/ RBM/ 模型/ ,/ 表明/ 我们/ 利用/ 的/ 最近/ 信任/ 好友/ 关系/ 确实/ 有利于/ 提高/ 推荐/ 效果/ ,/ 而且/ 数据/ 越/ 稀疏/ 预测/ 效果/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 提高/ 的/ 越/ 多/ ,/ 充分说明/ 我们/ 的/ 算法/ 能/ 有效/ 缓解/ 数据/ 稀疏/ 性/ 问题/ ./ 当/ 训练/ 数据/ 占/ 20/ %/ 时/ ,/ 我们/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ,/ MAE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 15.11/ %/ 和/ 6.23/ %/ ,/ RMSE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 17.45/ %/ 和/ 13.14/ %/ ;/ 当/ 训练/ 数据/ 占/ 80/ %/ 时/ ,/ 我们/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ,/ MAE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 5.89/ %/ 和/ 2.20/ %/ ,/ RMSE/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 分别/ 提高/ 5.06/ %/ 和/ 2.95/ %/ ./ 综合/ 对比/ 两个/ 数据/ 集上/ 的/ 实验/ 结果/ ,/ 可/ 发现/ R/ _/ CRBM/ 模型/ 比/ RBM/ 模型/ 取得/ 了/ 更好/ 的/ 推荐/ 效果/ ,/ 说明/ R/ _/ CRBM/ 模型/ 中/ 利用/ 的/ 潜在/ 的/ 评分/ // 未/ 评分/ 信息/ 有助于/ 提高/ 推荐/ 精度/ ;/ 我们/ 提出/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 取得/ 了/ 最好/ 的/ 推荐/ 效果/ ,/ 推荐/ 效果/ 比/ RBM/ 、/ R/ _/ CRBM/ 和/ S/ _/ RBM/ 模型/ 均/ 有/ 了/ 较大/ 程度/ 地/ 提高/ ,/ 说明/ 我们/ 算法/ 中/ 使用/ 的/ 最近/ 信任/ 好友/ 关系/ 是/ 值得/ 信赖/ 的/ ./ 至此/ 我们/ 得出结论/ :/ 我们/ 的/ R/ _/ CRBM/ 模型/ 和/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 中/ 使用/ 的/ 评分/ // 未/ 评分/ 信息/ 和/ 社交/ 关系/ 信息/ 均/ 有助于/ 提高/ 推荐/ 效果/ ,/ 有效/ 地/ 解决/ 了/ 数据/ 稀疏/ 性/ 问题/ ./ 图/ 16R/ _/ CRBM/ 模型/ 并行/ 化/ 3.5/ ./ 2/ 可扩展性/ 实验/ 结果/ 本/ 实验/ 中/ ,/ R/ _/ CRBM/ 模型/ 的/ 隐/ 单元/ 数量/ 为/ 180/ ,/ 训练/ 次数/ Epochs/ 为/ 10/ ,/ 实验/ 结果/ 如图/ 17/ 和/ 图/ 18/ 所示/ ./ 图/ 17/ 中/ ,/ 横坐标/ 表示/ 集群/ 的/ 节点/ 数/ ,/ 纵坐标/ 表/ 3.5/ 基于/ Spark/ 的/ 大/ 数据/ 环境/ 下/ 的/ 并行/ 化/ 实验/ 在/ 大/ 数据/ 环境/ 下/ ,/ 由于/ 数据量/ 巨大/ ,/ 普通/ 平台/ 无法/ 处理/ 大/ 数据/ 问题/ 并且/ 此时/ R/ _/ CRBM/ 模型/ 的/ 参数/ 数量/ 将/ 变得/ 极其/ 巨大/ ,/ R/ _/ CRBM/ 模型/ 的/ 训练/ 将/ 面临/ 巨大/ 的/ 挑战/ ,/ 因此/ ,/ 针对/ 大/ 数据/ 下/ 的/ R/ _/ CRBM/ 模型/ ,/ 本文/ 提出/ 了/ 基于/ Spark/ 的/ 并行/ 化/ 方案/ ./ 本/ 实验/ 的/ 数据/ 集/ 采用/ 完整/ 的/ Epinions/ 数据/ 集/ ,/ 包含/ 40163/ 个/ 用户/ 对/ 139529/ 个/ 项目/ 的/ 评分/ 以及/ 用户/ 之间/ 的/ 关系数据/ ./ 本/ 实验/ 使用/ IBM/ 高性能/ 计算/ 平台/ ,/ 使用/ 其中/ 10/ 个/ 计算/ 节点/ ,/ 每个/ 节点/ 8GB/ 内存/ ./ 3.5/ ./ 1/ 基于/ Spark/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ Spark/ 是/ 一个/ 基于/ 内存/ 计算/ 的/ 开源/ 集群/ 计算/ 系统/ ,/ 其/ 目的/ 是/ 更/ 快速/ 地/ 进行/ 数据分析/ ./ Spark/ 创新/ 地/ 提出/ 了/ “/ 弹性/ 分布式/ 数据/ 集/ ”/ (/ ResilientDistributedDatasets/ ,/ RDD/ )/ 的/ 概念/ ,/ RDD/ 是/ 一种/ 内存/ 分布式/ 数据/ 集/ ,/ 它/ 可以/ 将/ 中间/ 结果/ 缓存/ 在/ 内存/ 中/ 从而/ 省去/ 不必要/ 的/ 磁盘/ 读写/ ,/ 提高/ 运行/ 速度/ ./ 图/ 16/ 为/ R/ _/ CRBM/ 模型/ 的/ 并行/ 化/ 方案/ ./ 图中/ 参数/ θ/ =/ {/ W/ ,/ b/ ,/ c/ ,/ D/ }/ ./ 在/ 并行/ 化/ 分解/ 样本/ 阶段/ 将/ 训练/ 数据/ 集/ 切分/ 到/ 各个/ 分片/ 上/ ;/ 并行/ 化/ 阶段/ 针对/ 每个/ 分片/ 上/ 的/ 训练/ 数据/ 进行/ 参数/ 学习/ ,/ 得到/ 各/ 参数/ 的/ 更新/ 值/ ,/ 即/ 为/ 式/ (/ 3/ )/ ~/ (/ 6/ )/ ;/ 汇总/ 阶段/ 汇总/ 每个/ 分片/ 上/ 的/ 参数/ 得到/ 平均/ 后/ 的/ 参数/ ./ 本文/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 在/ R/ _/ CRBM/ 模型/ 训练/ 好/ 以后/ 有/ 一个/ 寻找/ 最近/ 邻居/ 的/ 过程/ ,/ 其/ 基本/ 思想/ 与/ R/ _/ CRBM/ 模型/ 的/ 并行/ 化/ 方案/ 类似/ ./ 示/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 运行/ 时间/ ,/ 时间/ 单位/ 为/ 分钟/ ;/ 图/ 18/ 中/ 横坐标/ 表示/ 集群/ 的/ 节点/ 数/ ,/ 总/ 坐标/ 表示/ 加速/ 比/ ./ 从/ 两图/ 中/ 可/ 发现/ 随着/ 集群/ 节点/ 数/ 的/ 增加/ ,/ 算法/ 的/ 运行/ 时间/ 越来越少/ ,/ 说明/ 基于/ Spark/ 的/ 并行/ 化/ 方案/ 是/ 有效/ 的/ ;/ 当/ 集群/ 从/ 1/ 个/ 节点/ 增加/ 到/ 4/ 个/ Page11/ 节点/ 时/ 算法/ 加速/ 非常明显/ ,/ 加速/ 比是/ 2.64/ ,/ 但是/ 随着/ 集群/ 数量/ 的/ 继续/ 增加/ ,/ 算法/ 的/ 加速/ 情况/ 变得/ 较为/ 缓慢/ ,/ 此时/ 节点/ 之间/ 的/ 通讯/ 开销/ 逐渐/ 占据/ 主导/ ./ 本/ 实验/ 中/ 使用/ 到/ 3/ 个/ 数据/ (/ 训练/ 数据/ 、/ 测试数据/ 、/ 社交/ 数据/ )/ ,/ 3/ 个/ 数据/ 总/ 的/ 数据量/ 约/ 为/ 23GB/ ,/ 使用/ Spark/ 读取/ 这/ 3/ 个/ 数据/ 仅/ 需/ 20s/ 左右/ ,/ 很/ 好地解决/ 了/ 普通/ 环境/ 无法/ 处理/ 大/ 数据/ 的/ 问题/ ./ 同时/ 10/ 个/ 节点/ 时/ 基于/ Spark/ 的/ 并行/ 化/ 方案/ 实现/ 了/ 2.84/ 倍/ 左右/ 的/ 加速/ ,/ 较/ 好地解决/ 了/ 大/ 数据/ 环境/ 下/ R/ _/ CRBM/ 模型/ 的/ 训练/ 问题/ ./ 4/ 总结/ 及/ 展望/ 当前/ ,/ 以/ RBM/ 为/ 基本/ 模块/ 的/ 深度/ 置信/ 网/ 模型/ 被/ 认为/ 是/ 最/ 有效/ 的/ 深度/ 学习/ 算法/ ,/ 也/ 使/ 其/ 在/ 深度/ 学习/ 领域/ 中/ 占据/ 着/ 核心/ 位置/ ,/ RBM/ 目前/ 已/ 被/ 应用/ 于/ 多种/ 机器/ 学习/ 问题/ ,/ 协同/ 过滤/ 便是/ 其中/ 之一/ ./ 目前/ 的/ 研究/ 中/ RBM/ 使用/ 的/ 还/ 仅仅/ 是/ 用户/ 的/ 评分/ 数据/ ,/ 众所周知/ 推荐/ 领域/ 中/ 存在/ 严重/ 的/ 数据/ 稀疏/ 性/ 问题/ ,/ 以/ 我们/ 实验所/ 采用/ 的/ 百度/ 推荐/ 大赛/ 的/ 数据/ 集为例/ ,/ 其/ 超过/ 97.4/ %/ 的/ 数据/ 是/ 缺失/ 的/ ,/ 这/ 将/ 大大/ 影响/ RBM/ 模型/ 的/ 训练/ 效果/ ./ 基于/ 此/ ,/ 本文/ 提出/ 了/ R/ _/ CRBM/ 模型/ 并/ 将/ R/ _/ CRBM/ 模型/ 和/ 用户/ 的/ 社交/ 关系/ 相结合/ 提出/ 了/ R/ _/ CRBM/ _/ NTFMT/ 算法/ ./ 实验/ 结果表明/ 我们/ 的/ 方法/ 很/ 好地解决/ 了/ 数据/ 稀疏/ 性/ 问题/ ,/ 并且/ 在/ 数据/ 越/ 稀疏/ 的/ 情况/ 下/ 我们/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 的/ 预测/ 效果/ 比/ RBM/ 和/ S/ _/ RBM/ 模型/ 提高/ 的/ 越/ 多/ ./ 最后/ ,/ 针对/ 大/ 数据/ 环境/ 下/ 算法/ 面临/ 的/ 挑战/ ,/ 本文/ 提出/ 了/ 基于/ Spark/ 的/ R/ _/ CRBM/ _/ NTFMT/ 算法/ 并行/ 化/ 方案/ ,/ 取得/ 了/ 一些/ 初步/ 的/ 有效/ 结果/ ,/ 未来/ 将/ 进一步/ 优化/ 其/ 性能/ 以/ 适应/ 在/ 大/ 数据/ 下/ 的/ 推荐/ 预测/ ./ 本/ 论文/ 中/ 采用/ 了/ 文献/ [/ 4/ ]/ 中/ 的/ 训练方法/ (/ 包括/ 其所作/ 的/ 改进/ )/ ,/ 本质/ 上/ 都/ 是/ CD/ 算法/ ,/ 但/ 在/ 深度/ 学习/ 领域/ ,/ 一些/ 研究者/ 在/ CD/ 算法/ 的/ 基础/ 上/ ,/ 已经/ 对/ 其作/ 了/ 一系列/ 的/ 改进/ ,/ 例如/ ,/ Tieleman/ [/ 19/ ]/ 提出/ 了/ 持续/ 对比/ 散度/ (/ PersistentContrastiveDivergence/ ,/ PCD/ )/ 算法/ ;/ Tieleman/ 和/ Hinton/ [/ 20/ ]/ 进一步/ 改进/ 了/ PCD/ 算法/ ,/ 引入/ 一组/ 辅助/ 参数/ 以/ 加快/ 马氏链/ 的/ 混合/ 率/ ,/ 提出/ 了/ 快速/ 持续/ 对比/ 散度/ (/ FastPersistentContrastiveDivergence/ ,/ FPCD/ )/ 算法/ ;/ Desjardins/ 等/ 人/ [/ 21/ ]/ 提出/ 了/ ParallelTempering/ (/ PT/ )/ 算法/ ,/ 通过/ 交换/ 相邻/ 两个/ 分布/ 的/ 状态/ ,/ 可以/ 将/ 低温/ 下/ 的/ 状态/ 传递/ 到/ 高温/ 状态/ 中/ ,/ 这样/ 便/ 可以/ 从/ 局部/ 最优/ 值中/ 跳出/ ,/ 有/ 更/ 大/ 的/ 概率/ 转移/ 到/ 距离/ 较远/ 的/ 峰值/ 中/ 去/ ;/ Ji/ 等/ 人/ [/ 22/ ]/ 提出/ 了/ ParallelTemperingwithEqui/ -/ Energy/ (/ PTEE/ )/ 算法/ ,/ 用于/ 解决/ PT/ 算法/ 中当/ 相邻/ 两个/ 状态/ 的/ 能量/ 差距/ 很大/ 时/ 交换/ 概率/ 低/ 的/ 问题/ 等等/ ,/ 但是/ 这些/ 方法/ 的/ 应用领域/ 都/ 是/ 传统/ 的/ 0/ -/ 1/ 数据/ ,/ 因此/ 如何/ 改进/ 这些/ 方法/ 使/ 其/ 适用/ 于/ 像/ 推荐/ 这种/ 数据/ 是/ 实值/ 并且/ 数据/ 大量/ 缺失/ 的/ 应用领域/ ,/ 将/ 是/ 我们/ 未来/ 的/ 研究/ 工作/ ./ 

