Page1/ 两层/ 传感器/ 网络/ 中/ 可验证/ 隐私/ 保护/ Top/ -/ 犽/ 查询/ 协议/ 范永健/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 陈红/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 中国人民大学/ 数据/ 工程/ 与/ 知识/ 工程/ 教育部/ 重点/ 实验室/ 北京/ 100872/ )/ 2/ )/ (/ 中国人民大学/ 信息/ 学院/ 北京/ 100872/ )/ 3/ )/ (/ 河北/ 工程/ 大学/ 信息/ 与/ 电气/ 工程学院/ 河北/ 邯郸/ 056038/ )/ 摘要/ 无线/ 传感器/ 网络/ 中/ 隐私/ 保护/ 技术/ 已经/ 成为/ 研究/ 热点/ ,/ 其中/ 隐私/ 保护/ 精确/ Top/ -/ k/ 查询/ 协议/ 已/ 成为/ 富有/ 挑战性/ 的/ 研究/ 问题/ ./ 文中/ 提出/ 了/ 一种/ 两层/ 传感器/ 网络/ 中/ 可验证/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ SafeTQ/ (/ SafeTop/ -/ kQuery/ )/ ,/ SafeTQ/ 由/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 和/ 两种/ 完整性/ 验证/ 模式/ 组成/ ./ SafeTQ/ 使用/ 加/ 随机数/ 扰乱/ 、/ 加密/ 和/ 高/ 资源/ 节点/ 之间/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 等/ 策略/ ,/ 能够/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 精确/ 地/ 完成/ 传感器/ 网络/ Top/ -/ k/ 查询/ ./ SafeTQ/ 中/ 两种/ 完整性/ 验证/ 模式/ 分别/ 使用/ 邻居/ 数据项/ 形成/ 加密/ 链/ 和/ 空间/ 邻居/ 节点/ 概率/ 发送/ 验证/ 消息/ 策略/ ,/ 使/ Sink/ 能够/ 检测/ 和/ 拒绝/ 不/ 正确/ 或/ 不/ 完整/ 查询/ 响应/ ./ 文中/ 通过/ 理论/ 分析/ 和/ 使用/ 真实/ 数据/ 集/ 实验/ 验证/ 了/ SafeTQ/ 的/ 安全性/ 和/ 有效性/ ./ 关键词/ 物/ 联网/ ;/ 无线/ 传感器/ 网络/ ;/ Top/ -/ k/ 查询/ ;/ 隐私/ 保护/ ;/ 完整性/ 验证/ ;/ 安全/ 计算/ 1/ 引言/ 无线/ 传感器/ 网络/ (/ 以下/ 简称/ 为/ 传感器/ 网络/ )/ 作为/ 物/ 联网/ 的/ 重要/ 组成部分/ ,/ 在/ 环境监测/ 、/ 医疗卫生/ 、/ 智能/ 交通/ 、/ 国防/ 军事/ 等/ 领域/ 具有/ 广阔/ 的/ 应用/ 前景/ ./ 随着/ 传感器/ 网络应用/ 发展/ ,/ 在/ 实际/ 应用/ 部署/ 过程/ 中/ 暴露出/ 严重/ 的/ 隐私/ 泄漏/ 威胁/ ./ 在/ 野生动物/ 监测/ 应用/ 中/ ,/ 珍/ Page2/ 贵/ 野生动物/ 的/ 位置/ 信息/ 可能/ 被/ 用于/ 非法/ 捕猎/ ;/ 在/ 医疗/ 应用领域/ ,/ 患者/ 的/ 体征/ 敏感数据/ 可能/ 被/ 泄漏/ ;/ 在/ 车载/ 传感/ 网/ 应用/ 中/ ,/ 车载/ 实体/ 的/ 位置/ 和/ 运动/ 轨迹/ 等/ 敏感/ 信息/ 可能/ 被/ 泄漏/ ;/ 在/ 军事/ 应用领域/ ,/ 重要/ 数据/ 、/ 基站/ 或/ 事件/ 源/ 位置/ 等/ 敏感/ 信息/ 泄漏/ 可能/ 造成/ 严重后果/ ./ 传感器/ 网络/ 中/ 这些/ 严重/ 的/ 隐私/ 泄漏/ 威胁/ ,/ 极大/ 地/ 影响/ 了/ 传感器/ 网络/ 的/ 应用/ 发展/ ./ 研究/ 和/ 解决/ 传感器/ 网络/ 中/ 的/ 隐私/ 保护/ 问题/ ,/ 对/ 传感器/ 网络/ 的/ 大规模/ 应用/ 具有/ 重要/ 意义/ ./ 传感器/ 网络/ 中/ 数据/ 隐私/ 保护/ 技术/ 已经/ 成为/ 研究/ 热点/ ,/ 现有/ 研究/ 内容/ 主要/ 集中/ 在/ SUM/ 、/ MIN/ 、/ MAX/ 或/ Median/ 等/ 聚集/ 操作/ 中/ 隐私/ 保护/ 技术/ [/ 1/ -/ 3/ ]/ 和/ 范围/ 查询/ 隐私/ 保护/ 和/ 验证/ 技术/ [/ 4/ -/ 6/ ]/ ./ 文献/ [/ 7/ ]/ 研究/ 了/ Top/ -/ k/ 查询/ 完整性/ 验证/ 技术/ ,/ 但/ 该/ 文献/ 没有/ 考虑/ 数据/ 隐私/ 问题/ ./ Top/ -/ k/ 查询/ 是/ 传感器/ 网络/ 中/ 重要/ 的/ 查询/ 类型/ ./ 由于/ 传感器/ 网络/ 可验证/ 隐私/ 保护/ 精确/ Top/ -/ k/ 查询/ 协议/ 面临/ 诸多/ 挑战/ ./ 据/ 作者/ 所知/ ,/ 目前/ 相关/ 成果/ 基本/ 还是/ 空白/ ./ 传感器/ 网络/ Top/ -/ k/ 查询/ 隐私/ 保护/ 和/ 验证/ 技术/ 面临/ 的/ 挑战/ 主要/ 表现/ 在/ 以下/ 方面/ :/ (/ 1/ )/ Top/ -/ k/ 查询/ 执行/ 需要/ 查询/ 区域/ 的/ 全局/ 数据/ 信息/ ,/ 并且/ 执行/ 过程/ 中/ 不能/ 泄漏/ 数据/ 值/ 等/ 敏感/ 信息/ ;/ (/ 2/ )/ 应/ 同时/ 保证/ Top/ -/ k/ 查询/ 的/ 正确性/ 和/ 精确性/ ;/ (/ 3/ )/ 传感器/ 节点/ 资源/ 严重/ 受限/ ,/ 应/ 减少/ 传感器/ 节点/ 能量消耗/ ,/ 尽量/ 利用/ 高/ 资源/ 节点/ (/ 两层/ 传感器/ 网络/ 中/ )/ ;/ (/ 4/ )/ 将/ Top/ -/ k/ 查询/ 隐私/ 保护/ 和/ 验证/ 技术/ 结合/ ,/ 同时/ 保证数据/ 的/ 隐私/ 性/ 和/ 完整性/ ./ 本文/ 研究/ 两层/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 的/ 安全性/ 问题/ ./ 两层/ 传感器/ 网络/ 具有/ 寿命长/ 等/ 优点/ ,/ 已/ 成为/ 研究/ 热点/ [/ 4/ -/ 7/ ]/ ./ 在/ 两层/ 传感器/ 网络/ 中/ ,/ 由于/ 单元/ 头/ 节点/ 需要/ 聚集/ 数据/ 和/ 执行/ 查询/ ,/ 往往/ 成为/ 被/ 攻击/ 的/ 对象/ ./ 单元/ 头/ 节点/ 被/ 俘获/ 后常/ 进行/ 破坏/ 隐私/ 性/ 和/ 破坏/ 完整性/ 两种/ 模式/ 的/ 攻击/ ./ 本文/ 在/ 单元/ 头/ 节点/ 不/ 安全/ 的/ 情况/ 下/ ,/ 为/ 应对/ 破坏/ 隐私/ 性/ 攻击/ 威胁/ ,/ 采用/ 加/ 随机数/ 扰乱/ 、/ 加密/ 和/ 高/ 资源/ 节点/ 之间/ 进行/ 安全/ 计算/ 等/ 策略/ ,/ 能够/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 精确/ 地/ 完成/ 传感器/ 网络/ Top/ -/ k/ 查询/ ;/ 为/ 应对/ 破坏/ 完整性/ 攻击/ 威胁/ ,/ 采用/ 邻居/ 数据项/ 形成/ 加密/ 链/ 和/ 空间/ 邻居/ 节点/ 概率/ 发送/ 验证/ 消息/ 策略/ ,/ 能够/ 使/ Sink/ 检测/ 和/ 拒绝/ 不/ 正确/ 或/ 不/ 完整/ 查询/ 响应/ ./ 本文/ 主要/ 贡献/ 有/ :/ (/ 1/ )/ 提出/ 两层/ 传感器/ 网络/ 中/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ ,/ 首次/ 实现/ 了/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 精确/ 地/ 完成/ 传感器/ 网络/ Top/ -/ k/ 查询/ ;/ (/ 2/ )/ 提出/ 两种/ 新颖/ 的/ 两层/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 完整性/ 验证/ 模式/ ,/ 能够/ 使/ Sink/ 检测/ 和/ 拒绝/ 不/ 正确/ 或/ 不/ 完整/ 查询/ 响应/ ;/ (/ 3/ )/ 将/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 与/ 完整性/ 验证/ 模式/ 结合/ ,/ 形成/ 两层/ 传感器/ 网络/ 中/ 可验证/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ SafeTQ/ (/ SafeTop/ -/ kQuery/ )/ ;/ (/ 4/ )/ 通过/ 理论/ 分析/ 和/ 使用/ 真实/ 数据/ 集/ 仿真/ 实验/ ,/ 分析/ 和/ 验证/ 了/ SafeTQ/ 的/ 安全性/ 和/ 有效性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节/ 给出/ 本文/ 研究所/ 基于/ 的/ 模型/ 和/ 安全/ 设计/ 目标/ ;/ 第/ 4/ 节对/ SafeTQ/ 进行/ 形式化/ 描述/ ;/ 第/ 5/ 节/ 给出/ 安全性/ 分析/ 和/ 证明/ ;/ 第/ 6/ 节/ 使用/ 公开/ 真实/ 数据/ 集/ 进行/ 仿真/ 实验/ 证明/ 了/ SafeTQ/ 的/ 有效性/ ;/ 第/ 7/ 节/ 进行/ 总结/ ./ 2/ 相关/ 工作/ (/ 1/ )/ 隐私/ 保护/ 技术/ 目前/ ,/ 隐私/ 保护/ 技术/ 研究成果/ 主要/ 集中/ 在/ 数据挖掘/ 和/ 数据/ 发布/ 两个/ 领域/ [/ 8/ ]/ ./ 综合/ 现有/ 的/ 研究成果/ ,/ 隐私/ 保护/ 技术/ 主要/ 可/ 分为/ 三类/ :/ 数据/ 扰乱/ 技术/ 、/ 数据/ 加密技术/ 和/ 数据/ 匿名/ 化/ 技术/ ./ 数据/ 扰乱/ 技术/ 使用/ 加/ 随机数/ 、/ 交换/ 等/ 技术/ 对/ 原始数据/ 进行/ 扰动/ ,/ 但/ 需要/ 保证/ 处理/ 后/ 数据/ 能够/ 满足/ 相关/ 应用/ 需求/ ;/ 在/ 数据/ 加密技术/ 中/ ,/ 安全/ 多方/ 计算/ (/ SecureMultipartyComputation/ ,/ SMC/ )/ 是/ 目前/ 研究/ 热点/ 之一/ ;/ 数据/ 匿名/ 化/ 技术/ 主要/ 成果/ 有/ k/ -/ anonymity/ 、/ l/ -/ diversity/ 、/ t/ -/ Closeness/ 等/ 模型/ ./ 没有/ 任何/ 一种/ 隐私/ 保护/ 技术/ 适用/ 于/ 所有/ 应用/ ./ 适用/ 于/ 多方/ 参与/ 通信/ 环境/ 的/ 安全/ 多方/ 计算/ 是/ 基于/ 可/ 交换/ 加密/ 等/ 技术/ 实现/ 的/ ,/ 通信/ 和/ 计算/ 开销/ 都/ 较大/ ,/ 不/ 适合/ 直接/ 在/ 资源/ 严重/ 受限/ 的/ 传感器/ 节点/ 间/ 运行/ ,/ 传感器/ 节点/ 能量/ 消耗量/ 直接/ 影响/ 传感器/ 网络/ 的/ 寿命/ ./ 本文/ 将/ 消耗/ 能量/ 较/ 高/ 的/ 安全/ 比较/ 计算/ 设计/ 在/ 两个/ 高/ 资源/ 节点/ 之间/ 完成/ ,/ 在/ 性能/ 上/ 适用/ 于/ 两层/ 传感器/ 网络/ 环境/ ./ k/ -/ anonymity/ 等/ 匿名/ 化/ 技术/ 是/ 基于/ 泛化/ 等/ 技术/ 实现/ 的/ ,/ 往往/ 在/ 隐私/ 披漏/ 风险/ 和/ 数据/ 精度/ 之间/ 进行/ 折中/ ./ 为/ 保证/ Top/ -/ k/ 查询/ 的/ 精确度/ ,/ 本文/ 采用/ 加/ 随机数/ 扰乱/ 技术/ ,/ 通过/ 安全/ 比较/ 算法/ 能够/ 精确/ 完成/ Top/ -/ k/ 查询/ ,/ 加/ 随机数/ 扰乱/ 技术/ 的/ 隐私/ 安全/ 程度/ 高于/ k/ -/ anonymity/ 模型/ ./ (/ 2/ )/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 技术/ 近年来/ ,/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 技术/ 成为/ 研究/ 热点/ ,/ 有/ 许多/ 有/ 价值/ 的/ 研究成果/ 发表/ ./ 文献/ [/ 1/ -/ 3/ ]/ 针对/ 攻击者/ 俘获/ 聚集/ 节点/ 企图/ 获取/ 敏感/ 信息/ 的/ 攻击/ 模型/ ,/ 提出/ 了/ 具有/ 保护/ 隐私/ 功能/ 的/ SUM/ 、/ MIN/ 、/ MAX/ 和/ Median/ 等/ 数据/ 聚集/ 算法/ ,/ 文献/ [/ 4/ -/ 6/ ]/ 在/ 两/ Page3/ 层/ 传感器/ 网络/ 中/ 存储/ 节点/ 被/ 俘获/ 的/ 情况/ 下/ ,/ 研究/ 范围/ 查询/ 隐私/ 保护/ 和/ 可验证/ 技术/ ./ 文献/ [/ 7/ ]/ 采用/ 加密/ 数据/ 关系/ 链/ 技术/ ,/ 嵌入/ 额外/ 附加/ 信息/ outlier/ ,/ 在/ 两层/ 传感器/ 网络/ 中/ 存储/ 节点/ 被/ 俘获/ 的/ 情况/ 下/ ,/ 实现/ Top/ -/ k/ 查询/ 的/ 完整性/ 验证/ ,/ 但/ 没有/ 考虑/ 隐私/ 保护/ 问题/ ./ Top/ -/ k/ 查询/ 是/ 传感器/ 网络/ 中/ 重要/ 的/ 查询/ 类型/ ,/ 用于/ 对/ 污染/ 、/ 干旱/ 或易/ 发生/ 火灾/ 等/ 区域/ 的/ 污染/ 指数/ 、/ 湿度/ 或/ 温度/ 值/ 等/ 数据/ 的/ 查询/ 和/ 监测/ ./ 在/ 这方面/ 有/ 一些/ 研究成果/ [/ 9/ -/ 11/ ]/ ,/ 这些/ 研究成果/ 集中/ 在/ 以/ 减少/ 能量/ 为/ 目标/ 的/ 查询/ 优化/ 方面/ ,/ 没有/ 考虑/ 隐私/ 保护/ 问题/ ./ (/ 3/ )/ 分布式/ 隐私/ 保护/ Top/ -/ k/ 查询/ 技术/ 在/ 分布式/ Top/ -/ k/ 查询/ 隐私/ 保护/ 研究/ 方面/ ,/ 文献/ [/ 12/ ]/ 提出/ 在/ 分布/ 的/ 多/ 站点/ 中/ 安全/ 计算/ 第/ k/ 位值/ 的/ 算法/ ./ 文献/ [/ 13/ ]/ 针对/ 分布式/ 垂直/ 划分/ 的/ 数据/ 集/ ,/ 提出/ 隐私/ 保护/ Top/ -/ k/ 算法/ ./ 上述/ 算法/ 通信/ 和/ 计算/ 代价/ 大/ ,/ 特别/ 是/ 在/ 多/ 站点/ 中/ 安全/ 发现/ 数据项/ 并集/ 和/ 计算/ 交集/ 数据项/ 个数/ 时/ ,/ 使用/ 安全/ 多方/ 计算技术/ 需要/ 很/ 高/ 的/ 通信/ 和/ 计算/ 代价/ ,/ 该/ 协议/ 不适/ 用于/ 传感器/ 网络/ 中/ 的/ Top/ -/ k/ 查询/ ./ 3/ 模型/ 3.1/ 网络/ 模型/ 两层/ 传感器/ 网络/ 存在/ 大量/ 资源/ 相对/ 较少/ 的/ 传感器/ 节点/ 和/ 少数/ 资源/ 充裕/ 的/ 高/ 资源/ 节点/ ./ 传感器/ 节点/ 构成/ 下层/ 网络/ ,/ 将/ 数据/ 传送/ 至/ 高/ 资源/ 节点/ ;/ 高/ 资源/ 节点/ 构成/ 上层/ 网络/ ,/ 完成/ 数据/ 聚集/ 和/ 执行/ 查询/ 任务/ ./ 本文/ 采用/ 的/ 两层/ 传感器/ 网络/ 模型/ 如图/ 1/ 所示/ ./ 两层/ 传感器/ 网络/ 被/ 划分/ 为/ 若干个/ 单元/ (/ cell/ )/ ,/ 单元/ 划分/ 时应/ 保证/ 每个/ 单元/ 区域/ 至少/ 存在/ 2/ 个/ 高/ 资源/ 节点/ ./ 选择/ 单元/ 内/ 一个/ 高/ 资源/ 节点/ 作为/ 单元/ 头/ 节点/ (/ cellheader/ )/ ,/ 另外/ 指定/ 一个/ 高/ 资源/ 节点/ 作为/ 辅助/ 计算/ 节点/ (/ computingnode/ )/ ,/ 即/ 每个/ 单元/ 由/ 单元/ 头/ 节点/ 、/ 辅助/ 计算/ 节点/ 和/ 若干个/ 传感器/ 节点/ 组成/ ./ 单元/ 头/ 节点/ 与/ 单元/ 头/ 节点/ 之间/ 能够/ 进行/ 长距离/ 、/ 高速率/ 通信/ ,/ 形成/ 多/ 跳/ 的/ 上层/ 网络/ ,/ Sink/ 与/ 一些/ 单元/ 头/ 节点/ 进行/ 无线/ 链接/ ,/ 这种/ 无线/ 链接/ (/ 如/ 卫星/ 链接/ )/ 往往/ 具有/ 不/ 稳定/ 、/ 高/ 代价/ 、/ 低/ 速率/ 等/ 特点/ ./ 这/ 就/ 要求/ 隐私/ 保护/ Top/ -/ k/ 查询/ 操作/ 应/ 在/ 单元/ 内/ 进行/ ,/ 以/ 尽量减少/ 单元/ 头/ 节点/ 与/ Sink/ 之间/ 的/ 通信量/ ./ 单元/ 头/ 节点/ 拥有/ 本/ 单元/ 内/ 网络拓扑/ 信息/ ,/ Sink/ 拥有/ 全局/ 网络拓扑/ 信息/ ./ 由于/ 两层/ 传感器/ 网络/ 具有/ 寿命长/ 、/ 易/ 扩展/ 等/ 优点/ ,/ 使/ 其/ 具有/ 良好/ 的/ 发展/ 空间/ ./ 目前/ 很多/ 研究/ [/ 4/ -/ 7/ ]/ 采用/ 了/ 两层/ 传感器/ 网络/ 模型/ ./ 3.2/ 查询/ 模型/ 式化/ 表示/ 为/ 本文/ 采用/ 的/ 传感器/ 网络/ Top/ -/ k/ 查询/ / t/ 模型/ 形/ 其中/ C/ 为/ 查询/ 单元/ ,/ G/ 为/ 查询/ 区域/ ,/ t/ 为/ 查询/ 周期/ ,/ k/ 为/ 查询/ 需要/ 返回/ 的/ 最大/ (/ 或/ 最小/ )/ 的/ 数据项/ 数/ ./ Top/ -/ k/ 查询/ {/ C/ ,/ G/ ,/ t/ ,/ k/ }/ 在/ 指定/ 查询/ 区域/ G/ 和/ 查询/ 周期/ t/ 内所/ 采集/ 的/ 全体/ 数据/ 中/ 查询/ Top/ -/ k/ 数据/ ,/ 本文/ 研究/ Top/ -/ k/ 查询/ / t/ 中/ 隐私/ 保护/ 技术/ 和/ 完整性/ 验证/ 机制/ ./ 与/ 文献/ [/ 7/ ]/ 相似/ ,/ SafeTQ/ 仅/ 描述/ 查询/ 区域/ 在/ 同一/ 单元/ 内/ 的/ 情况/ ,/ 对于/ 查询/ 区域/ 为/ 多个/ 单元/ 的/ 情况/ 能够/ 进行/ 分解/ 处理/ ./ 3.3/ 攻击/ 模型/ 与/ 安全/ 目标/ 单元/ 头/ 节点/ 需要/ 完成/ 数据/ 聚集/ 和/ 查询/ 任务/ ,/ 攻击者/ 俘获/ 单元/ 头/ 节点/ 对/ 传感器/ 网络/ 安全性/ 将/ 造成/ 严重/ 的/ 威胁/ ./ 本文/ 假设/ 攻击者/ 企图/ 俘获/ 单元/ 头/ 节点/ ,/ 通过/ 单元/ 头/ 节点/ 进行/ 攻击/ 的/ 情况/ 下/ ,/ 研究/ Top/ -/ k/ 查询/ 的/ 隐私/ 保护/ 技术/ 和/ 完整性/ 验证/ 机制/ ./ 传感器/ 节点/ 被/ 俘获/ 的/ 情况/ 下/ ,/ 攻击者/ 仅能/ 获取/ 或/ 修改/ 被/ 俘获/ 节点/ 采集/ 的/ 数据/ ,/ 对/ Top/ -/ k/ 查询/ 隐私/ 性/ 和/ 完整性/ 威胁/ 较/ 小/ ,/ 本文/ 不/ 考虑/ 传感器/ 节点/ 被/ 俘获/ 的/ 情况/ ./ 不失/ 一般性/ ,/ 本文/ 假设/ 攻击者/ 俘获/ 单元/ 头/ 节点/ 后/ ,/ 具有/ 的/ 特征/ 和/ 背景/ 知识/ 为/ :/ (/ 1/ )/ 能够/ 获得/ 单元/ 头/ 节点/ 收到/ 和/ 存储/ 的/ 明文/ 数据/ ,/ 这些/ 数据/ 可能/ 来自/ 传感器/ 节点/ 或/ Sink/ ;/ (/ 2/ )/ 不能/ 解密/ 使用/ 传感器/ 节点/ 和/ Sink/ 共享/ 密钥/ 加密/ 的/ 数据/ ;/ (/ 3/ )/ 能够/ 获得/ 单元/ 头/ 节点/ 的/ 背景/ 知识/ ,/ 如/ 网络拓扑/ 等/ 信息/ ./ 对/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 隐私/ 性/ 和/ 完整性/ 定义/ 如下/ ./ 定义/ 1/ ./ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 隐私/ 性/ ./ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ / t/ =/ {/ C/ ,/ G/ ,/ t/ ,/ k/ }/ 正确/ 执行/ 时/ ,/ 如果/ 攻击者/ 不能/ 获得/ 以下/ 敏感/ 信息/ ,/ 则/ 查询/ / t/ 满足/ 隐私/ 性/ :/ (/ 1/ )/ 查询/ 区域/ G/ 内/ 传感器/ 节点/ 采集/ 数据/ 集/ Vt/ =/ ∪/ si/ ∈/ GVsi/ 中/ 数据项/ ,/ 其中/ Vsi/ 为/ 传感器/ 节点/ Page4si/ ∈/ G/ 采集/ 的/ 数据/ 集/ ;/ (/ 2/ )/ Top/ -/ k/ 数据/ 集/ / t/ =/ {/ vq/ |/ vq/ ∈/ Vt/ 且/ vq/ / vkth/ }/ 中/ 数据项/ ,/ 其中/ vkth/ 为/ Vt/ 中/ 第/ k/ 位/ 数据/ 值/ ;/ (/ 3/ )/ Top/ -/ k/ 节点/ 集/ {/ si/ |/ / si/ ≠/ / }/ 中/ 节点/ ID/ ,/ 其中/ / si/ =/ {/ vq/ |/ vq/ ∈/ Vsi/ 且/ vq/ / vkth/ }/ ./ 定义/ 2/ ./ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 完整性/ ./ 传感器/ 网络/ 中/ 单元/ 头/ 节点/ 返回/ 的/ 响应/ Top/ -/ k/ 查询/ / t/ =/ {/ C/ ,/ G/ ,/ t/ ,/ k/ }/ 结果/ 集/ / t/ 满足/ 以下/ 条件/ ,/ 则/ 查询/ / t/ 满足/ 完整性/ :/ (/ 1/ )/ 结果/ 集/ / t/ 中/ 任何/ 数据项/ 都/ 是/ 查询/ 区域/ G/ 内/ 传感器/ 节点/ 采集/ 的/ 真实/ 数据/ ,/ 即/ / t/ / Vt/ ,/ 其中/ Vt/ 为/ 采集/ 数据/ 集/ ;/ (/ 2/ )/ 结果/ 集/ / t/ 中/ 任何/ 数据/ 都/ 大于/ 等于/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ 即/ / v/ ∈/ / t/ ,/ 有/ v/ / vkth/ ;/ (/ 3/ )/ 采集/ 数据/ 集/ Vt/ 中/ 任何/ 大于/ 等于/ 第/ k/ 位/ 数据/ 值/ vkth/ 的/ 数据/ 都/ 在/ 结果/ 集/ / t/ 中/ ,/ 即/ / v/ ∈/ Vt/ 且/ v/ / vkth/ ,/ 有/ v/ ∈/ / t/ ./ 本文/ 假设/ 单元/ 头/ 节点/ 被/ 俘获/ 后/ 采用/ 如下/ 两种/ 模式/ 进行/ 攻击/ :/ (/ 1/ )/ 破坏/ 隐私/ 性/ 攻击/ 模式/ ,/ 攻击者/ 企图/ 记录/ 或/ 推测/ 定义/ 1/ 中/ 描述/ 的/ 敏感/ 信息/ ,/ 破坏/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 隐私/ 性/ ;/ (/ 2/ )/ 破坏/ 完整性/ 攻击/ 模式/ ,/ 攻击者/ 企图/ 通过/ 插入/ 、/ 篡改/ 或/ 删除/ 查询/ 响应/ 结果/ ,/ 破坏/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 完整性/ ./ 本文/ 的/ 完全/ 目标/ 为/ :/ SafeTQ/ 能够/ 应对/ 以上/ 两种/ 模式/ 的/ 攻击/ ,/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ 精确/ 地/ 完成/ Top/ -/ k/ 查询/ ,/ 并且/ 能够/ 使/ Sink/ 检测/ 和/ 拒绝/ 不/ 正确/ 或/ 不/ 完整/ 查询/ 响应/ ./ 4SafeTQ/ 协议/ 两层/ 传感器/ 网络/ 中/ 可验证/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ SafeTQ/ 由/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 和/ 两种/ 完整性/ 验证/ 模式/ 组成/ ./ 两种/ 完整性/ 验证/ 模式/ 分别/ 为/ 数据项/ 加密/ 链/ 验证/ 模式/ 和/ 概率/ 空间/ 邻居/ 验证/ 模式/ ./ 根据/ 使用/ 的/ 完整性/ 验证/ 模式/ 不同/ ,/ SafeTQ/ 分为/ SafeTQ/ -/ L/ 和/ SafeTQ/ -/ N/ ,/ 其中/ SafeTQ/ -/ L/ 使用/ 数据项/ 加密/ 链/ 验证/ 模式/ ,/ SafeTQ/ -/ N/ 使用/ 概率/ 空间/ 邻居/ 验证/ 模式/ ./ 4.1/ 隐私/ 保护/ Top/ -/ 犽/ 查询/ 协议/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 的/ 基本思路/ 为/ :/ 接到/ Top/ -/ k/ 查询/ / t/ 后/ ,/ 传感器/ 节点/ si/ ∈/ G/ 产生/ 随机数/ ri/ ,/ 将/ 周期/ t/ 内/ 采集/ 的/ 数据/ 集/ Vsi/ 中前/ k/ 个/ 数据/ {/ vi/ ,/ 1/ ,/ vi/ ,/ 2/ ,/ …/ ,/ vi/ ,/ k/ }/ 分别/ 与/ 随机数/ ri/ 求和/ ,/ 将/ 求和/ 结果/ 传送/ 到/ 单元/ 头/ 节点/ ,/ 同时/ 将/ 该/ 随机数/ ri/ 传送/ 到/ 辅助/ 计算/ 节点/ ,/ 由/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 通过/ 安全/ 比较/ ,/ 计算/ 出/ 周期/ t/ 内/ 查询/ 区域/ G/ 中/ 采集/ 的/ 全体/ 数据/ 集/ Vt/ =/ ∪/ si/ ∈/ GVsi/ 中/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ 单元/ 头/ 节点/ 将/ vkth/ 作为/ 阈值/ 下发/ 至/ 查询/ 区域/ 内/ 所有/ 传感器/ 节点/ ,/ 传感器/ 节点/ si/ ∈/ G/ 将/ Vsi/ 中/ 每个/ 数据/ vi/ ,/ j/ 与/ vkth/ 比较/ ,/ 大于/ 等于/ vkth/ 的/ 数据/ 即为/ Top/ -/ k/ 数据/ ,/ 这些/ Top/ -/ k/ 数据/ 构成/ 传感器/ 节点/ si/ 查询/ 响应/ 结果/ 集/ / si/ ,/ 根据/ 所/ 选用/ 的/ 完整性/ 验证/ 模式/ 不同/ 进行/ 相应/ 处理/ 后/ ,/ 使用/ 传感器/ 节点/ 与/ Sink/ 共享/ 的/ 密钥/ 加密/ 并/ 传送/ 到/ 单元/ 头/ 节点/ ,/ 由/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ ,/ Sink/ 解密/ 并/ 确定/ 查询/ / t/ 结果/ 集/ / t/ =/ ∪/ si/ ∈/ G/ / si/ (/ 即/ Top/ -/ k/ 数据/ 集/ )/ ./ 述/ 如下/ :/ 结合/ 图/ 2/ ,/ 对/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 进行/ 描/ (/ 1/ )/ 传感器/ 节点/ 数据/ 加/ 随机数/ 处理/ Sink/ 将/ Top/ -/ k/ 查询/ / t/ =/ {/ C/ ,/ G/ ,/ t/ ,/ k/ }/ 发送给/ 单元/ 头/ 节点/ ,/ 单元/ 头/ 节点/ 将/ 查询/ 参数/ {/ t/ ,/ k/ }/ 下/ 发给/ 查询/ 区域/ G/ 内/ 的/ 传感器/ 节点/ si/ ∈/ G/ ./ 传感器/ 节点/ si/ ∈/ G/ 对/ 在/ 周期/ t/ 内/ 采集/ 的/ 数据/ 集/ Vsi/ 进行/ 排序/ ,/ 并/ 取前/ k/ 个/ 数据/ 构成/ {/ vi/ ,/ 1/ ,/ vi/ ,/ 2/ ,/ …/ ,/ vi/ ,/ k/ }/ (/ vi/ ,/ 1/ / vi/ ,/ 2/ / …/ / vi/ ,/ k/ 且/ / l/ ≠/ j/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ,/ vi/ ,/ l/ / vi/ ,/ j/ )/ ,/ 传感器/ 节点/ si/ ∈/ G/ 产生/ 随机数/ ri/ ,/ 将/ ri/ 与/ 前/ k/ 个/ 数据/ 集/ {/ vi/ ,/ 1/ ,/ vi/ ,/ 2/ ,/ …/ ,/ vi/ ,/ k/ }/ 中/ 每一项/ 数据/ 分别/ 进行/ 求和/ ,/ 数据项/ vi/ ,/ j/ ∈/ {/ vi/ ,/ 1/ ,/ vi/ ,/ 2/ ,/ …/ ,/ vi/ ,/ k/ }/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ 与/ ri/ 求和/ 结果/ 记为/ vri/ ,/ j/ =/ vi/ ,/ j/ +/ ri/ ,/ 传感器/ 节点/ si/ 将/ 求和/ 结果/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ ,/ 发送到/ 单元/ 头/ 节点/ :/ si/ (/ si/ ∈/ G/ )/ →/ cellheader/ :/ i/ ,/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ ./ 发送到/ 辅助/ 计算/ 节点/ :/ 同时/ ,/ 传感器/ 节点/ si/ 将/ 本/ 节点/ 产生/ 的/ 随机数/ ri/ ,/ si/ (/ si/ ∈/ G/ )/ →/ computingnode/ :/ i/ ,/ {/ ri/ }/ ./ (/ 2/ )/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 通过/ 4.2/ 节/ 描述/ 的/ 算法/ ,/ 在/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 不能/ 获知/ 任何/ 数据项/ 值/ 的/ 情况/ 下/ ,/ 计算/ 出/ 数据/ 集/ Vt/ =/ ∪/ si/ ∈/ GVsi/ 中/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ vkth/ 将/ 数据/ 集/ Vt/ 中/ 数据/ 值/ 最大/ 的/ 前/ k/ 项/ 与/ 第/ k/ +/ 1/ 项/ 及其/ 之后/ 的/ 数据/ 区分/ 开来/ ./ 单元/ 头/ 节点/ 将/ 阈值/ vkth/ 发送至/ 查询/ 区域/ 内/ 所有/ 传感器/ 节点/ si/ ∈/ G/ :/ Page5/ (/ 3/ )/ 生成/ 查询/ 响应/ 结果/ 集/ 并/ 加密/ 上传/ 传感器/ 节点/ si/ ∈/ G/ 将/ vkth/ 与/ 周期/ t/ 内/ 采集/ 的/ 数据/ 集/ Vsi/ 进行/ 比较/ ,/ 大于/ 等于/ vkth/ 的/ 数据/ (/ 即为/ Top/ -/ k/ 数据/ )/ 形成/ 节点/ si/ 的/ 查询/ 响应/ 结果/ 集/ / si/ =/ {/ vq/ |/ vq/ ∈/ Vsi/ 且/ vq/ / vkth/ }/ ./ SafeTQ/ 使用/ 传感器/ 节点/ 与/ Sink/ 共享/ 的/ 密钥/ ,/ 对/ 需要/ 上传/ 的/ 数据/ 进行/ 加密/ ,/ 单元/ 头/ 节点/ 没有/ 解密/ 能力/ ./ 为了/ 增加/ 安全性/ ,/ 本/ 协议/ 采用/ 文献/ [/ 4/ ]/ 中/ 周期/ 更换/ 密钥/ 方式/ ,/ 用/ ki/ ,/ t/ 表示/ 周期/ t/ 内/ 传感器/ 节点/ si/ 与/ Sink/ 共享/ 的/ 密钥/ ,/ 则/ 有/ ki/ ,/ t/ =/ hash/ (/ ki/ ,/ t/ -/ 1/ )/ ./ 对/ / si/ 分/ 情况/ 进行/ 加密/ 处理/ ,/ 使用/ 数据项/ 加密/ 链/ 验证/ 模式/ 时/ ,/ 需要/ 按/ 4.3/ ./ 1/ 节/ 要求/ 进行/ 加密/ 并/ 形成/ 数据项/ 加密/ 链/ ;/ 使用/ 概率/ 空间/ 邻居/ 验证/ 模式/ 时/ ,/ 对/ / si/ 直接/ 进行/ 整体/ 加密/ ./ 加密/ 后经/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ si/ (/ / si/ ≠/ / )/ →/ cellheader/ →/ Sink/ :/ i/ ,/ Eki/ ,/ t/ {/ / si/ }/ ./ (/ 4/ )/ 使用/ 完整性/ 验证/ 模式/ 生成/ 验证/ 消息/ 根据/ 所/ 选用/ 完整性/ 验证/ 模式/ 进行/ 不同/ 的/ 处理/ ./ 使用/ 数据项/ 加密/ 链/ 验证/ 模式/ ,/ 需要/ 所有/ 非/ Top/ -/ k/ 节点/ si/ (/ / si/ =/ / )/ )/ 产生/ 验证/ 消息/ / vl/ (/ 详见/ 4.3/ ./ 1/ 节/ )/ ;/ 使用/ 概率/ 空间/ 邻居/ 验证/ 模式/ ,/ 需要/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 的/ 邻居/ 节点/ 以/ 概率/ p/ 发送/ 验证/ 消息/ / vn/ (/ 详见/ 4.3/ ./ 2/ 节/ )/ ./ 不/ 使用/ 完整性/ 验证/ 模式/ 的/ 情况/ 下/ ,/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 需要/ 部分/ 非/ Top/ -/ k/ 节点/ 发送/ 虚假/ 消息/ / f/ ,/ 以/ 避免/ 单元/ 头/ 节点/ 能够/ 将/ 上传/ 加密/ 数据/ 的/ 节点/ 准确/ 地/ 判断/ 为/ Top/ -/ k/ 节点/ ,/ 造成/ 敏感/ 信息/ 泄漏/ ./ 为了/ 下/ 式/ 描述/ 方便/ ,/ 将/ / vn/ 、/ / vl/ 或/ / f/ 统一/ 表示/ 为/ / ./ 使用/ 传感器/ 节点/ si/ 与/ Sink/ 共享/ 的/ 密钥/ ki/ ,/ t/ 对/ / 进行/ 直接/ 加密/ 后/ ,/ 经/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ si/ (/ si/ ∈/ G/ )/ →/ cellheader/ →/ Sink/ :/ i/ ,/ Eki/ ,/ t/ {/ / }/ ./ (/ 5/ )/ Sink/ 解密/ 并/ 处理/ 数据/ Sink/ 解密/ 数据/ ,/ 并/ 进行/ 如下/ 处理/ :/ 根据/ 消息/ 标志/ 判断/ 验证/ 消息/ 或/ 虚假/ 数据/ ,/ 根据/ 完整性/ 验证/ 模式/ 进行/ 相应/ 的/ 完整性/ 验证/ (/ 详见/ 4.3/ ./ 1/ 节/ 和/ 4.3/ ./ 2/ 节/ )/ ,/ 求/ 所有/ / si/ 并集/ 得到/ 查询/ / t/ 结果/ 集/ / t/ =/ ∪/ si/ ∈/ G/ / si/ ,/ 即/ Top/ -/ k/ 数据/ 集/ ./ 4.2/ 安全/ 计算/ 第/ 犽/ 位/ 数据/ 值/ 算法/ 本/ 节/ 给出/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 算法/ ./ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 算法/ 利用/ 二分/ 查找/ 和/ 安全/ 比较/ 算法/ [/ 12/ -/ 14/ ]/ ,/ 在/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 不能/ 获知/ 任何/ 数据项/ 值/ 的/ 情况/ 下/ ,/ 安全/ 计算/ 出/ 数据/ 集/ Vt/ 中/ 第/ k/ 位/ 的/ 数据/ 值/ vkth/ ./ 1986/ 年/ 发表/ 的/ 文献/ [/ 14/ ]/ 提出/ 的/ 安全/ 比较/ 算法/ ,/ 实现/ 了/ 在/ 参与/ 计算/ 双方/ 不能/ 获知/ 对方/ 数据/ 值/ 的/ 情况/ 下/ 进行/ 安全/ 比较/ 计算/ ./ 传感器/ 节点/ si/ ∈/ G/ 将/ 产生/ 的/ 随机数/ ri/ 与/ 前/ k/ 个/ 数据项/ 求和/ vri/ ,/ j/ =/ vi/ ,/ j/ +/ ri/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ,/ 并/ 将/ 求和/ 结果/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ 传送/ 给/ 单元/ 头/ 节点/ ,/ 同时/ 将/ 随机数/ ri/ 传送/ 到/ 辅助/ 计算/ 节点/ ,/ 显然/ 有/ vi/ ,/ j/ =/ vri/ ,/ j/ -/ ri/ ./ 为了/ 表述/ 简单/ ,/ 将/ 单元/ 头/ 节点/ 收到/ 的/ 所有/ 求和/ 结果/ ∪/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ 统一/ 表示/ 为/ {/ a1/ ,/ a2/ ,/ …/ ,/ an/ }/ (/ n/ =/ |/ ∪/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ |/ )/ ,/ 辅助/ 计算/ 节点/ 将/ 收到/ 的/ 所有/ 随机数/ 求/ 相反数/ 后/ 得/ 集合/ ∪/ {/ -/ ri/ }/ ,/ 将/ 集合/ ∪/ {/ -/ ri/ }/ 相应/ 项/ 表示/ 为/ {/ b1/ ,/ b2/ ,/ …/ ,/ bn/ }/ (/ n/ =/ |/ ∪/ {/ vri/ ,/ 1/ ,/ vri/ ,/ 2/ ,/ …/ ,/ vri/ ,/ k/ }/ |/ )/ ,/ 则/ / m/ ,/ vm/ =/ am/ +/ bm/ ,/ 有/ vm/ ∈/ {/ vi/ ,/ j/ }/ ./ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 算法/ ,/ 使用/ 二分/ 查找/ 法/ 搜索/ 第/ k/ 位/ 数据/ 值/ vkth/ ./ 用/ middle/ 表示/ 中间/ 探测/ 值/ ,/ 对于/ 每/ 一个/ 数据项/ ,/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 运用/ 安全/ 比较/ 算法/ ,/ 比较/ middle/ 与/ vm/ =/ am/ +/ bm/ 的/ 大小/ 关系/ ,/ 根据/ middle/ 与/ vm/ 的/ 大小/ 关系/ ,/ 产生/ 相应/ 输出/ ./ 在/ 全部/ 数据项/ 安全/ 比较/ 完成/ 后/ ,/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 对/ 各自/ 所得/ 输出/ 结果/ 求和/ ,/ 使用/ 安全/ 比较/ 算法/ 将/ 该/ 求和/ 结果/ 与/ k/ 进行/ 比较/ ,/ 依/ 此/ 判断/ middle/ 与/ vkth/ 的/ 大小/ 关系/ ,/ 如/ 相等/ 则/ 返回/ vkth/ ,/ 否则/ ,/ 按/ 二分/ 查找/ 算法/ 进行/ 下/ 一轮/ 处理/ ,/ 直到/ 找到/ 并/ 返回/ vkth/ ./ 假设/ 共有/ x/ 项/ 数据/ 上传/ 至/ 单元/ 头/ 节点/ ,/ 用/ M/ 表示/ 数据/ 值域/ 上/ 界/ ,/ 算法/ 能够/ 在/ log/ |/ M/ |/ 轮内/ 找到/ 第/ k/ 位/ 数据/ 值/ ,/ 在/ 每轮/ 中/ 所有/ x/ 项/ 数据/ 都/ 需要/ 参与/ 安全/ 比较/ ,/ 算法/ 复杂度/ 为/ O/ (/ xlog/ |/ M/ |/ )/ ./ 算法/ 1/ ./ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ ./ 输入/ :/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 各自/ 输入/ 数据/ 集/ 输出/ :/ 第/ k/ 位/ 数据/ 值/ vkth1/ ./ lbound/ ←/ 0/ // // 数据/ 值域/ 下界/ 2/ ./ ubound/ ←/ M/ // // 数据/ 值域/ 上界/ M3/ ./ whiletruedo4/ ./ middle/ ←/ (/ lbound/ +/ ubound/ )/ // 25/ ./ form/ =/ 1/ ,/ 2/ ,/ …/ ,/ ndo6/ ./ 使用/ 文献/ [/ 14/ ]/ 的/ 安全/ 比较/ 算法/ ,/ 输入/ am/ ,/ bm/ ,/ 7/ ./ endfor8/ ./ 单元/ 头/ 节点/ :/ lla/ ←/ ∑/ n9/ ./ 辅助/ 计算/ 节点/ :/ llb/ ←/ ∑/ nPage610/ ./ ifllam/ +/ llbm/ (/ mod/ |/ M/ |/ )/ >/ kthen/ // // middle/ >/ vkth11/ ./ ubound/ ←/ middle12/ ./ elseifllam/ +/ llbm/ (/ mod/ |/ M/ |/ )/ </ kthen/ // // middle/ </ vkth13/ ./ lbound/ ←/ middle14/ ./ else/ // // middle/ =/ vkth15/ ./ returnmiddle/ // // 返回/ 第/ k/ 位/ 数据/ 值/ vkth16/ ./ endif17/ ./ endwhile4/ ./ 3/ 完整性/ 验证/ 模式/ 单元/ 头/ 节点/ 可能/ 通过/ 插入/ 虚假/ 数据/ 、/ 篡改/ 和/ 删除/ 数据/ ,/ 破坏/ 3.3/ 节中/ 定义/ 2/ 定义/ 的/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 完整性/ ./ 插入/ 虚假/ 数据/ 破坏/ 定义/ 2/ 中/ 条件/ 1/ ,/ 同时/ 可能/ 破坏/ 条件/ 2/ ;/ 篡改/ 数据/ 破坏/ 条件/ 1/ 和/ 条件/ 3/ ,/ 可能/ 破坏/ 条件/ 2/ ;/ 删除/ 数据/ 破坏/ 条件/ 3/ ./ SafeTQ/ 使用/ 传感器/ 节点/ 与/ Sink/ 共享/ 的/ 密钥/ 进行/ 加密/ ,/ 在/ 假设/ 传感器/ 节点/ 没有/ 被/ 俘获/ 的/ 前提/ 下/ ,/ 单元/ 头/ 节点/ 不能/ 获得/ 密钥/ 即/ 没有/ 解密/ 和/ 加密/ 能力/ ,/ 所以/ 单元/ 头/ 节点/ 插入/ 虚假/ 数据/ 和/ 篡改/ 数据/ 时/ ,/ 破坏/ 了/ 加密/ 数据包/ 的/ 完整性/ ,/ Sink/ 不能/ 正确/ 解密/ ,/ 从而/ 能够/ 检测/ 到/ 该/ 攻击/ ./ 但是/ ,/ 如果/ 被/ 俘获/ 的/ 单元/ 头/ 节点/ 删除/ 传感器/ 节点/ 上传/ 的/ 加密/ 数据包/ ,/ 则/ 破坏/ 了/ 查询/ / t/ 的/ 完整性/ ,/ 需要/ 使用/ 完整性/ 验证/ 模式/ 进行/ 完整性/ 验证/ ./ 本文/ 设计/ 的/ 两种/ 完整性/ 验证/ 模式/ 分别/ 为/ 数据项/ 加密/ 链/ 验证/ 模式/ 和/ 概率/ 空间/ 邻居/ 验证/ 模式/ ,/ 分别/ 与/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 结合/ 形成/ SafeTQ/ -/ L/ 和/ SafeTQ/ -/ N/ ./ 4.3/ ./ 1/ 数据项/ 加密/ 链/ 验证/ 模式/ 数据项/ 加密/ 链/ 验证/ 模式/ 使用/ 数据项/ 加密/ 链/ 技术/ 检测/ 对/ / si/ 的/ 部分/ 删除/ 攻击/ ,/ 并/ 使用/ 非/ Top/ -/ k/ 节点/ 发送/ 验证/ 消息/ 策略/ 检测/ 对/ / si/ 的/ 整体/ 删除/ 攻击/ ,/ 由/ 数据项/ 加密/ 链/ 和/ 验证/ 消息/ 共同完成/ Top/ -/ k/ 查询/ 完整性/ 验证/ ./ 本文/ 针对/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ 设计/ 了/ 相应/ 的/ 数据项/ 加密/ 链/ 数据结构/ ./ 数据项/ 加密/ 链/ 技术/ [/ 7/ -/ 8/ ]/ 通过/ 对/ 有序/ 数据/ 集/ 填充/ 冗余/ 数据/ ,/ 分段/ 加密/ 形成/ 数据项/ 加密/ 链/ ,/ 使得/ 解密/ 后/ 能够/ 检测/ 数据/ 集/ 的/ 完整性/ ./ 通过/ 示例/ 对/ 数据项/ 加密/ 链/ 技术/ 进行/ 演示/ ,/ 假设/ 有序/ 数据/ 集/ 为/ {/ 2/ ,/ 4/ ,/ 6/ ,/ 8/ }/ ,/ 使用/ 密钥/ ki/ ,/ t/ 加密/ 后/ 形成/ 的/ 数据项/ 加密/ 链为/ {/ (/ Min/ |/ 2/ )/ ki/ ,/ t/ ,/ (/ 2/ |/ 4/ )/ ki/ ,/ t/ ,/ (/ 4/ |/ 6/ )/ ki/ ,/ t/ ,/ (/ 6/ |/ 8/ )/ ki/ ,/ t/ ,/ (/ 8/ |/ Max/ )/ ki/ ,/ t/ }/ ./ 分别/ 使用/ / -/ -/ 和/ / 用/ ni/ 表示/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 形成/ 查询/ 响应/ 结果/ 集/ / si/ 中/ 数据项/ 个数/ ,/ 即/ ni/ =/ |/ / si/ |/ ./ 对/ 数据项/ 加密/ 链/ 验证/ 模式/ 进行/ 描述/ 如下/ :/ (/ 1/ )/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 对/ / si/ 排序/ ,/ 排序/ 后/ 表示/ 为/ {/ vqi/ ,/ 1/ ,/ vqi/ ,/ 2/ ,/ …/ ,/ vqi/ ,/ ni/ }/ (/ vqi/ ,/ 1/ >/ vqi/ ,/ 2/ >/ …/ >/ vqi/ ,/ ni/ )/ ,/ 使用/ 传感器/ 节点/ 与/ Sink/ 共享/ 的/ 密钥/ ki/ ,/ t/ ,/ 对/ 排序/ 后/ 的/ / si/ 加入/ 冗余/ 数据/ 和/ 公共/ 极值/ / -/ -/ 和/ / 加密/ 后/ 形成/ 数据项/ 加密/ 链/ {/ (/ / -/ -/ |/ vqi/ ,/ 1/ )/ ki/ ,/ t/ ,/ (/ vqi/ ,/ 1/ |/ vqi/ ,/ 2/ )/ ki/ ,/ t/ ,/ …/ ,/ (/ vqi/ ,/ ni/ -/ 1/ |/ vqi/ ,/ ni/ )/ ki/ ,/ t/ ,/ (/ vqi/ ,/ ni/ |/ / 数据项/ 加密/ 链/ 经过/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ si/ (/ / si/ ≠/ / )/ →/ cellheader/ →/ Sink/ :/ (/ 2/ )/ 查询/ 区域/ G/ 内/ 所有/ 非/ Top/ -/ k/ 节点/ si/ (/ / si/ =/ / )/ 生成/ 验证/ 消息/ / vl/ ,/ 采用/ 传感器/ 节点/ 与/ Sink/ 共享/ 的/ 密钥/ ki/ ,/ t/ 加密/ ,/ 经/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ si/ (/ / si/ =/ / )/ →/ cellheader/ →/ Sink/ :/ i/ ,/ {/ (/ / vl/ )/ ki/ ,/ t/ }/ ./ (/ 3/ )/ Sink/ 解密/ 并/ 进行/ 完整性/ 验证/ Sink/ 对/ 所有/ 收到/ 的/ 加密/ 数据/ 进行/ 解密/ ,/ 本/ 模式/ 需要/ Sink/ 进行/ 两类/ 验证/ :/ (/ i/ )/ 所有/ 数据项/ 加密/ 链/ 的/ 完整性/ ;/ (/ ii/ )/ 是否/ 查询/ 区域/ G/ 内/ 所有/ 节点均/ 上传/ 了/ 加密/ 数据/ ./ 如果/ 有/ 数据项/ 加密/ 链/ 不/ 完整/ 或/ 查询/ 区域/ G/ 内有/ 节点/ 未/ 上传/ 加密/ 数据/ ,/ 则/ 判断/ 为/ Top/ -/ k/ 查询/ / t/ 不/ 完整/ ./ 下面/ 讨论/ 攻击者/ 进行/ 不同/ 方式/ 的/ 完整性/ 攻击/ 时/ ,/ 数据项/ 加密/ 链/ 验证/ 模式/ 进行/ 完整性/ 验证/ 的/ 情况/ ./ 传感器/ 节点/ 和/ Sink/ 共享/ 密钥/ 的/ 加密/ 方式/ ,/ 使/ Sink/ 能够/ 检测/ 出/ 攻击者/ 插入/ 虚假/ 数据/ 和/ 篡改/ 数据/ 的/ 攻击方式/ ./ 所以/ ,/ 完整性/ 验证/ 模式/ 仅/ 需要/ 考虑/ 攻击者/ 部分/ 或/ 全部/ 删除/ 加密/ 数据/ 的/ 情况/ :/ (/ i/ )/ 如果/ {/ (/ vqi/ ,/ j/ |/ vqi/ ,/ j/ -/ 1/ )/ ki/ ,/ t/ }/ (/ 1/ </ j/ / ni/ )/ 被/ 单元/ 头/ 节点/ 删除/ ,/ 因/ 不能/ 形成/ 完整/ 的/ 数据项/ 加密/ 链/ ,/ 而/ 能够/ 被/ Sink/ 检测/ 出/ ;/ (/ ii/ )/ 如果/ {/ (/ / -/ -/ |/ vqi/ ,/ 1/ )/ ki/ ,/ t/ }/ 或/ {/ (/ vqi/ ,/ ni/ |/ / 元头/ 节点/ 删除/ ,/ 因/ 数据项/ 加密/ 链/ 缺少/ 公共/ 极少/ 值/ / -/ -/ 或/ 公共/ 极大值/ / (/ iii/ )/ 如果/ 某/ 数据项/ 加密/ 链/ 被/ 整体/ 删除/ ,/ Sink/ 根据/ 网络拓扑/ 信息/ ,/ 能够/ 检测/ 出未/ 收到/ 加密/ 数据/ 的/ 节点/ ,/ 因为/ 本/ 模式/ 要求/ 查询/ 区域/ G/ 内/ 所有/ 节点/ 发送/ 加密/ 数据/ ,/ Sink/ 据此/ 判断/ 受到/ 了/ 完整性/ 攻击/ ./ 此/ 模式/ 需要/ 查询/ 区域/ G/ 内/ 所有/ 节点/ 发送/ 加密/ 数据/ ,/ 即/ 查询/ 区域/ G/ 内非/ Top/ -/ k/ 节点/ 也/ 需要/ 发送/ 加密/ 的/ 验证/ 消息/ ,/ 并且/ 需要/ 冗余/ 数据/ 形成/ 数据项/ 加密/ Page7/ 链/ ,/ 则/ 此/ 模式/ 需要/ 较/ 高/ 的/ 通信/ 代价/ ./ 下面/ 给出/ 通信/ 代价/ 较/ 小/ 的/ 概率/ 空间/ 邻居/ 验证/ 模式/ ./ 4.3/ ./ 2/ 概率/ 空间/ 邻居/ 验证/ 模式/ 概率/ 空间/ 邻居/ 验证/ 模式/ 的/ 基本/ 步骤/ 为/ :/ 需要/ 响应/ 查询/ 的/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ ,/ 对/ 查询/ 响应/ 结果/ 集/ / si/ 整体/ 加密/ 后/ 上传/ ,/ 同时/ 向/ 邻居/ 节点/ 广播/ 消息/ 点/ 生成/ 验证/ 消息/ / vn/ ,/ 将/ / vn/ 与/ Top/ -/ k/ 节点/ si/ 的/ 编号/ i/ 一起/ 加密/ 后/ ,/ 以/ 给定/ 概率/ p/ 上传/ ,/ Sink/ 解密/ 后/ 使用/ 验证/ 消息/ 进行/ 完整性/ 验证/ ./ / ,/ 表明/ 本/ 节点/ 为/ Top/ -/ k/ 节点/ ,/ 收到/ / / / 播/ 消息/ / 对/ 概率/ 空间/ 邻居/ 验证/ 模式/ 进行/ 描述/ 如下/ :/ 在/ 传感器/ 网络/ 隐私/ 保护/ Top/ -/ k/ 算法/ 中/ ,/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 形成/ 查询/ 响应/ 结果/ 集/ / si/ 后/ ,/ 进行/ 以下/ 操作/ :/ (/ 1/ )/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 使用/ 与/ Sink/ 共享/ 密钥/ ki/ ,/ t/ ,/ 对/ / si/ 进行/ 整体/ 加密/ 后/ ,/ 经/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ si/ (/ / si/ ≠/ / )/ →/ cellheader/ →/ Sink/ :/ i/ ,/ {/ / si/ }/ ki/ ,/ t/ ./ (/ 2/ )/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 向/ 空间/ 邻居/ 节点/ 广/ si/ (/ / si/ ≠/ / )/ →/ neighbourhood/ :/ i/ ,/ / (/ 3/ )/ Top/ -/ k/ 节点/ si/ 的/ 邻居/ 节点/ sj/ 收到/ 广播/ 消息/ / 后/ ,/ 生成/ 验证/ 消息/ / vn/ ,/ 使用/ 与/ Sink/ 共享/ 的/ 密钥/ kj/ ,/ t/ ,/ 将/ / vn/ 与/ Top/ -/ k/ 节点/ si/ 的/ 编号/ i/ 一起/ 加密/ ,/ 为了/ 减少/ 通信量/ ,/ 以/ 给定/ 概率/ p/ 经/ 单元/ 头/ 节点/ 上传/ 至/ Sink/ :/ p/ :/ sj/ →/ cellheader/ →/ Sink/ :/ j/ ,/ {/ i/ ,/ / vn/ }/ kj/ ,/ t/ ./ (/ 4/ )/ Sink/ 解密/ 并/ 进行/ 完整性/ 验证/ Sink/ 对/ 加密/ 数据/ 进行/ 解密/ ./ 对于/ 与/ 验证/ 消息/ / vn/ 一起/ 加密/ 的/ 节点/ 编号/ i/ ,/ Sink/ 检测/ 是否/ 收到/ 其/ 对应/ 节点/ si/ ∈/ G/ 的/ 查询/ 响应/ 结果/ 集/ / si/ ,/ 如/ 没收/ 到/ ,/ 则/ 判断/ 为/ 查询/ / t/ 结果/ 集/ / t/ =/ ∪/ si/ ∈/ G/ / si/ 不/ 完整/ ./ 在/ 概率/ 空间/ 邻居/ 验证/ 模式/ 中/ ,/ 传感器/ 节点/ si/ 使用/ 与/ Sink/ 节点/ 共享/ 的/ 密钥/ ki/ ,/ t/ ,/ 对/ 查询/ 结果/ 集/ / si/ 进行/ 整体/ 加密/ ,/ 因此/ 单元/ 头/ 节点/ 插入/ 虚假/ 数据包/ 、/ 篡改/ 数据/ 将/ 被/ 检测/ 出/ ,/ 其仅/ 能够/ 通过/ 整体/ 删除/ 加密/ 后/ 的/ 查询/ 响应/ 结果/ {/ / si/ }/ ki/ ,/ t/ 来/ 破坏/ 查询/ 完整性/ ./ Sink/ 通过/ 空间/ 邻居/ 节点/ 发送/ 的/ 验证/ 消息/ ,/ 能够/ 判断/ 攻击者/ 是否/ 删除/ {/ / si/ }/ ki/ ,/ t/ ,/ 以/ 完成/ 完整性/ 验证/ ./ 5/ 安全性/ 分析/ 5.1/ 隐私/ 性/ 分析/ 定理/ 1/ ./ SafeTQ/ 正确/ 完成/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 单元/ 头/ 节点/ 不能/ 获得/ Top/ -/ k/ 查询/ 隐私/ 性/ 定义/ (/ 定义/ 1/ )/ 中/ 描述/ 的/ 敏感/ 信息/ ./ 证明/ ./ SafeTQ/ 在/ 完成/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 单元/ 头/ 节点/ 可能/ 在/ 以下/ 环节/ 获取/ 定义/ 1/ 中/ 描述/ 的/ 敏感/ 信息/ :/ (/ 环节/ 1/ )/ 为/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ 而/ 收集/ 数据/ 信息/ 时/ ,/ 获取/ 采集/ 数据/ 值/ ;/ (/ 环节/ 2/ )/ 与/ 辅助/ 计算/ 节点/ 合作/ 计算/ k/ 位/ 数据/ 值/ vkth/ 时/ ,/ 获取/ 采集/ 数据/ 值/ 和/ Top/ -/ k/ 数据/ 值/ ;/ (/ 环节/ 3/ )/ 接收/ Top/ -/ k/ 节点/ 上传/ 的/ 查询/ 响应/ 结果/ 集/ / si/ 时/ ,/ 获取/ Top/ -/ k/ 数据/ 值/ 并/ 推测/ Top/ -/ k/ 节点/ ./ 在/ SafeTQ/ 执行/ 时/ ,/ 在/ 环节/ 1/ 中/ 传感器/ 节点/ 将/ 数据/ 与/ 本/ 节点/ 产生/ 的/ 随机数/ 求和/ 后/ 上传/ ,/ 单元/ 头/ 节点/ 无法/ 获得/ 真实/ 数据/ ;/ 在/ 环节/ 2/ 中/ 使用/ 二分/ 查找/ 和/ 安全/ 比较/ 计算/ 第/ k/ 位/ 数据/ 值/ ,/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 不能/ 获知/ 任何/ 数据项/ 值/ ,/ 安全/ 比较/ 算法/ [/ 14/ ]/ 保证/ 了/ 参与/ 计算/ 的/ 双方/ 不能/ 获知/ 对方/ 的/ 数据/ 值/ ;/ 在/ 环节/ 3/ 中/ ,/ 一方面/ ,/ 使用/ 传感器/ 节点/ 和/ Sink/ 共享/ 密钥/ 加密/ 数据/ ,/ 单元/ 头/ 节点/ 不能/ 通过/ 解密/ 获取/ Top/ -/ k/ 数据/ 值/ ,/ 另一方面/ ,/ SafeTQ/ 要求/ 部分/ 非/ Top/ -/ k/ 节点/ 产生/ 扰乱/ 数据/ ,/ 使/ 单元/ 头/ 节点/ 不能/ 将/ 上传/ 加密/ 数据/ 的/ 节点/ 准确/ 地/ 推测/ 为/ Top/ -/ k/ 节点/ ./ 综上所述/ ,/ 在/ SafeTQ/ 执行/ 过程/ 中/ ,/ 单元/ 头/ 节点/ 不能/ 获得/ 定义/ 1/ 中/ 描述/ 的/ 敏感/ 信息/ ./ 定理/ 2/ ./ SafeTQ/ 正确/ 完成/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 辅助/ 计算/ 节点/ 不能/ 获得/ Top/ -/ k/ 查询/ 隐私/ 性/ 定义/ (/ 定义/ 1/ )/ 中/ 描述/ 的/ 敏感/ 信息/ ./ 证明/ ./ SafeTQ/ 执行/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 辅助/ 计算/ 节点/ 仅/ 负责/ 接收/ 传感器/ 节点/ si/ ∈/ G/ 传送/ 的/ 随机数/ ri/ ,/ 与/ 单元/ 头/ 节点/ 使用/ 安全/ 比较/ 算法/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ ./ 安全/ 比较/ 算法/ [/ 14/ ]/ 保证/ 辅助/ 计算/ 节点/ 不能/ 获得/ 单元/ 头/ 节点/ 的/ 数据/ 信息/ ./ SafeTQ/ 执行/ 过程/ 中/ 采集/ 的/ 数据/ 和/ 查询/ 响应/ 的/ Top/ -/ k/ 数据/ 不向/ 辅助/ 计算/ 节点/ 传送/ ./ 所以/ ,/ 定理/ 2/ 成立/ ./ 证毕/ ./ 定理/ 3/ ./ SafeTQ/ 正确/ 完成/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 在/ 传感器/ 节点/ 没有/ 被/ 俘获/ 的/ 情况/ 下/ ,/ SafeTQ/ 满足/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 隐私/ 性/ 定义/ (/ 定义/ 1/ )/ ./ 证明/ ./ 根据/ 定理/ 1/ 、/ 2/ ,/ SafeTQ/ 执行/ Top/ -/ k/ 查询/ / t/ 过程/ 中/ ,/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 不能/ 获得/ 定义/ 1/ 中/ 敏感/ 信息/ ./ 在/ 传感器/ 节点/ 没有/ 被/ 俘获/ 的/ 情况/ 下/ ,/ SafeTQ/ 执行/ 过程/ 中/ 攻击者/ 不能/ 获得/ 定义/ 1/ 中/ 敏感/ 信息/ ./ 所以/ ,/ SafeTQ/ 满足/ 传感器/ 网络/ 中/ Top/ -/ k/ 查询/ 隐私/ 性/ 定义/ ./ 5.2/ 完整性/ 分析/ 定理/ 4/ ./ 在/ 没有/ 传感器/ 节点/ 被/ 俘获/ 发起/ 攻击/ Page8/ 的/ 情况/ 下/ ,/ SafeTQ/ -/ L/ 检测/ 出/ 单元/ 头/ 节点/ 被/ 俘获/ 发起/ 完整性/ 攻击/ 的/ 概率/ 为/ 100/ %/ ./ 证明/ ./ 单元/ 头/ 节点/ 可能/ 通过/ 插入/ 虚假/ 数据包/ 、/ 篡改/ 数据/ 和/ 删除/ 数据/ 操作/ 进行/ 完整性/ 攻击/ ,/ 破坏/ 定义/ 2/ 定义/ 的/ Top/ -/ k/ 查询/ 完整性/ ./ 在/ 没有/ 传感器/ 节点/ 被/ 俘获/ 发起/ 攻击/ 的/ 情况/ 下/ ,/ 由于/ SafeTQ/ -/ L/ 使用/ 传感器/ 节点/ 与/ Sink/ 共享/ 密钥/ 的/ 加密/ 方式/ ,/ Sink/ 检测/ 出/ 单元/ 头/ 节点/ 插入/ 虚假/ 数据/ 和/ 篡改/ 数据/ 的/ 概率/ 为/ 100/ %/ ;/ 由于/ SafeTQ/ -/ L/ 使用/ 数据项/ 加密/ 链/ 技术/ ,/ Sink/ 检测/ 出/ 单元/ 头/ 节点/ 删除/ 数据项/ 加密/ 链中/ 任意/ 项/ 的/ 概率/ 为/ 100/ %/ ;/ 由于/ SafeTQ/ -/ L/ 要求/ 查询/ 区域/ G/ 内/ 所有/ 节点/ 全部/ 发送/ 加密/ 数据/ ,/ 且/ Sink/ 拥有/ 网络拓扑/ 信息/ ,/ 所以/ Sink/ 检测/ 出/ 单元/ 头/ 节点/ 删除/ 某/ 传感器/ 节点/ 上传/ 的/ 全部/ 加密/ 数据/ 的/ 概率/ 为/ 100/ %/ ./ 综上所述/ ,/ 在/ 没有/ 传感器/ 节点/ 被/ 俘获/ 发起/ 攻击/ 的/ 情况/ 下/ ,/ SafeTQ/ -/ L/ 检测/ 出/ 单元/ 头/ 节点/ 被/ 俘获/ 发起/ 完整性/ 攻击/ 的/ 概率/ 为/ 100/ %/ ./ 定理/ 5/ ./ 没有/ 传感器/ 节点/ 被/ 俘获/ 发起/ 攻击/ 的/ 情况/ 下/ ,/ 在/ SafeTQ/ -/ N/ 的/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 和/ 其/ 空间/ 邻居/ 节点/ 传送/ 到/ 单元/ 头/ 节点/ 的/ 加密/ 数据/ 中/ ,/ 单元/ 头/ 节点/ 随机/ 删除/ 某/ 加密/ 数据项/ ,/ 使得/ 完整性/ 被/ 破坏/ 且/ 被/ 检测/ 出/ 的/ 概率/ 为/ 1/ -/ (/ 1/ -/ p/ )/ n/ // (/ p/ ×/ n/ +/ 1/ )/ ,/ 其中/ p/ 为/ SafeTQ/ -/ N/ 中/ 邻居/ 节点/ 发送/ 验证/ 消息/ 的/ 概率/ ,/ n/ 为/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 空间/ 邻居/ 的/ 个数/ ./ 证明/ ./ 在/ SafeTQ/ -/ N/ 使用/ 的/ 概率/ 空间/ 邻居/ 验证/ 模式/ 中/ ,/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 将/ 消息/ / 给/ 空间/ 邻居/ 节点/ ,/ 空间/ 邻居/ 节点/ 以/ 概率/ p/ 向/ 单元/ 头/ 节点/ 发送/ 验证/ 消息/ ,/ 设/ Top/ -/ k/ 节点/ si/ 有/ n/ 个/ 空间/ 邻居/ 节点/ ,/ 则/ 没有/ 任何/ 空间/ 邻居/ 节点/ 发送/ 验证/ 消息/ 的/ 概率/ 为/ (/ 1/ -/ p/ )/ n/ ,/ 向/ 单元/ 头/ 节点/ 发送/ 验证/ 消息/ 的/ 邻居/ 节点/ 个数/ 的/ 期望值/ 为/ p/ ×/ n/ ./ SafeTQ/ -/ N/ 将/ 验证/ 消息/ 与/ 响应/ 查询/ 数据项/ 设计/ 为/ 相同/ 长度/ ,/ 使得/ 单元/ 头/ 节点/ 不/ 容易/ 区分/ 加密/ 的/ 查询/ 响应/ 数据项/ 和/ 加密/ 的/ 验证/ 消息/ 项/ ./ 只有/ 单元/ 头/ 节点/ 删除/ 加密/ 查询/ 响应/ 数据项/ ,/ Top/ -/ k/ 查询/ 完整性/ 才/ 被/ 破坏/ ./ 在/ SafeTQ/ -/ N/ 的/ Top/ -/ k/ 节点/ si/ (/ / si/ ≠/ / )/ 和/ 其/ 空间/ 邻居/ 上传/ 的/ 加密/ 数据包/ 中/ ,/ 单元/ 头/ 节点/ 随机/ 删除/ 的/ 加密/ 数据项/ 为/ 加密/ 查询/ 响应/ 数据项/ 的/ 概率/ 为/ 1/ // (/ p/ ×/ n/ +/ 1/ )/ ,/ 此/ 情况/ 下/ Sink/ 不能/ 检测/ 到/ 的/ 概率/ 为/ (/ 1/ -/ p/ )/ n/ // (/ p/ ×/ n/ +/ 1/ )/ ./ 所以/ ,/ 没有/ 传感器/ 节点/ 被/ 俘获/ 发起/ 攻击/ 的/ 情况/ 下/ ,/ 单元/ 头/ 节点/ 随机/ 删除/ 某/ 数据项/ ,/ 使得/ 完整性/ 被/ 破坏/ 且/ 被/ 检测/ 出/ 的/ 概率/ 为/ 1/ -/ (/ 1/ -/ p/ )/ n/ // (/ p/ ×/ n/ +/ 1/ )/ ./ 证毕/ ./ 定理/ 6/ ./ SafeTQ/ 执行/ Top/ -/ k/ 查询/ / t/ 时/ ,/ 能够/ 检测/ 出/ 辅助/ 节点/ 被/ 俘获/ 发起/ 的/ 完整性/ 攻击/ ./ 证明/ ./ SafeTQ/ 执行/ 过程/ 中/ ,/ 辅助/ 计算/ 节点/ 负责/ 接收/ 传感器/ 节点/ si/ ∈/ G/ 传送/ 的/ 随机数/ ri/ ,/ 与/ 单元/ 头/ 节点/ 使用/ 安全/ 比较/ 算法/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ ./ 辅助/ 计算/ 节点/ 被/ 俘获/ 仅/ 能够/ 通过/ 插入/ 、/ 篡改/ 和/ 删除/ 其/ 接收/ 的/ 随机数/ ,/ 进行/ 完整性/ 攻击/ ./ 根据/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 算法/ (/ 详见/ 4.2/ 节/ )/ ,/ 辅助/ 计算/ 节点/ 接收/ 到/ 的/ 随机数/ ri/ 与/ 单元/ 头/ 节点/ 收到/ 的/ 求和/ 结果/ vri/ ,/ j/ =/ vi/ ,/ j/ +/ ri/ 一一对应/ ./ 当/ 辅助/ 计算/ 节点/ 插入/ 或/ 删除/ 随机数/ 项后/ ,/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 算法/ 执行/ 时/ 将/ 出错/ ,/ 从而/ 检测/ 出此/ 攻击/ ./ 如果/ 辅助/ 计算/ 节点/ 篡改/ 随机/ 数值/ ,/ 将/ 计算/ 出/ 错误/ 的/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ 使/ 传感器/ 节点/ 筛选/ 出/ 的/ 查询/ 响应/ 结果/ 集/ / si/ 不/ 完整/ 或/ 不/ 正确/ ,/ 进而/ 使/ Sink/ 解密/ 汇总/ 的/ 查询/ 结果/ 集/ / t/ 不/ 完整/ ,/ 此时/ / t/ 中/ 数据项/ 数/ 不/ 等于/ k/ (/ |/ / t/ |/ ≠/ k/ )/ ./ 执行/ SafeTQ/ -/ L/ 时/ ,/ Sink/ 确认/ 所有/ 数据项/ 加密/ 链/ 完整/ 且/ 已/ 收到/ 所有/ 传感器/ 节点/ 上传/ 的/ 加密/ 数据/ 后/ ,/ 如/ 检测/ |/ / t/ |/ 不/ 等于/ k/ 值/ ,/ 则/ 判断/ 为/ 辅助/ 节点/ 被/ 俘获/ 并/ 发起/ 完整性/ 攻击/ ;/ 执行/ SafeTQ/ -/ N/ 时/ ,/ Sink/ 确认/ 验证/ 消息/ 携带/ 编号/ 对应/ 节点/ 上传/ 的/ 加密/ 数据/ 全部/ 收到/ 后/ ,/ 如/ 检测/ |/ / t/ |/ 不/ 等于/ k/ 值/ ,/ 则/ 判断/ 为/ 辅助/ 节点/ 被/ 俘获/ 并/ 发起/ 完整性/ 攻击/ ./ 6/ 实验/ 与/ 分析/ 本文/ 设计/ 的/ SafeTQ/ 协议/ 代价/ 主要/ 由/ 三/ 部分/ 组成/ :/ 传感器/ 节点/ 采集/ 、/ 计算/ 和/ 传输数据/ 消耗/ 的/ 代价/ ;/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 两个/ 高/ 资源/ 节点/ 之间/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ 的/ 代价/ ;/ 单元/ 头/ 节点/ 与/ Sink/ 之间/ 传输数据/ 的/ 代价/ ./ 4.2/ 节已/ 给出/ 单元/ 头/ 节点/ 与/ 辅助/ 计算/ 节点/ 之间/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 的/ 算法/ 复杂度/ ./ 对于/ 传感器/ 节点/ ,/ 通信/ 能量消耗/ 远大于/ 计算/ 能量消耗/ ,/ 如/ 文献/ [/ 7/ ,/ 15/ ]/ ,/ 本文/ 使用/ 数据通信/ 量/ 评价/ 算法/ 的/ 有效性/ ./ 本/ 实验/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 和/ 单元/ 头/ 节点/ 与/ Sink/ 之间/ 的/ 外部/ 通信量/ 分别/ 进行/ 考查/ ,/ 前者/ 影响/ 整个/ 网络/ 寿命/ ,/ 后者/ 使用/ 高/ 代价/ 、/ 低/ 速率/ 的/ 无线/ 链接/ (/ 如/ 卫星/ 链接/ )/ ,/ 要求/ 通信量/ 尽量/ 小/ ./ 分/ 构成/ :/ 单元/ 内/ 传感器/ 节点/ 传输数据/ 通信量/ 主要/ 由/ 4/ 部/ (/ 1/ )/ 为/ 安全/ 计算/ 阈值/ vkth/ 向/ 单元/ 头/ 节点/ 传输/ 采集/ 数据/ 和/ 随机数/ 之/ 和/ ,/ 数据项/ 格式/ 为/ (/ 2/ )/ 为/ 安全/ 计算/ 阈值/ vkth/ 向/ 辅助/ 计算/ 节点/ 传输/ 随机数/ ,/ 数据项/ 格式/ 为/ 节点/ ID/ :/ 4B/ 随机数/ :/ 4B/ ;/ Page9/ (/ 3/ )/ 传感器/ 节点/ 对/ 查询/ 响应/ 数据/ 加密/ 后/ 向/ 单元/ 头/ 节点/ 传输/ ,/ 数据格式/ 为/ 日期/ :/ 4B/ 时间/ :/ 4B/ 节点/ ID/ :/ 4BTop/ -/ k/ 数据/ :/ 4B/ ;/ (/ 4/ )/ 传输/ 验证/ 消息/ ,/ 在/ 数据项/ 加密/ 链/ 验证/ 模式/ 中/ ,/ 非/ Top/ -/ k/ 节点/ 对/ 验证/ 消息/ 加密/ 后/ 向/ 单元/ 头/ 节点/ 传输/ ,/ 数据格式/ 为/ 节点/ ID/ :/ 4B/ 验证/ 信息/ :/ 4B/ ,/ 在/ 概率/ 空间/ 邻居/ 验证/ 模式/ 中/ ,/ Top/ -/ k/ 节点/ 向/ 邻居/ 节点/ 广播/ 数据/ 的/ 格式/ 为/ 节点/ ID/ :/ 4B/ 广播/ 消息/ :/ 4B/ ,/ 邻居/ 节点/ 对/ 验证/ 消息/ 加密/ 后/ 向/ 单元/ 头/ 节点/ 传输/ ,/ 数据格式/ 为/ Top/ -/ k/ 节点/ ID/ :/ 4B/ 验证/ 信息/ :/ 12B/ ,/ 将/ 邻居/ 节点/ 发送/ 的/ 验证/ 消息/ 设计/ 为/ 16/ 字节/ ,/ 使得/ 攻击者/ 不/ 容易/ 区分/ 验证/ 消息/ 和/ 查询/ 响应/ 消息/ ./ 本文/ 采用/ 文献/ [/ 4/ ,/ 7/ ]/ 中/ 密钥/ 机制/ ,/ 使用/ 16/ 位/ 密钥/ 进行/ 加密/ ./ 本文/ 使用/ 真实/ 数据/ 集在/ OMNeT/ ++/ 平台/ 上/ 对/ SafeTQ/ 进行/ 仿真/ 实验/ ./ 本文/ 使用/ 公开/ 可/ 获得/ 的/ 真实/ 数据/ 集/ LUCEdataset/ ①/ ,/ 该/ 数据/ 集为/ 2006/ 年/ 11/ 月/ 至/ 2007/ 年/ 5/ 月/ 采集/ 的/ 环境温度/ 、/ 土壤湿度/ 等/ 11/ 维/ 属性数据/ ,/ 本文/ 使用/ 环境温度/ 数据/ 进行/ 仿真/ ./ 根据/ LUCEdataset/ 中/ 节点/ 位置/ 数据/ ,/ 88/ 个/ 传感器/ 节点/ 分布/ 在/ 半径/ 280m/ 的/ 圆形/ 区域/ 内/ ,/ 这些/ 传感器/ 节点/ 和/ 单元/ 头/ 节点/ 、/ 辅助/ 计算/ 节点/ 一起/ 构成/ 两层/ 传感器/ 网络/ 的/ 划分/ 单元/ ,/ 作为/ 仿真/ 实验/ 查询/ 区域/ ./ 本文/ 仿真/ 实验/ 中/ ,/ 单元/ 头/ 节点/ 位于/ 单元/ 中心/ ,/ 假设/ 传感器/ 节点/ 有效/ 传输/ 距离/ 为/ 60m/ ,/ 使用/ TAG/ (/ tinyaggregationserviceforadhocsensornetworks/ )/ 算法/ 建立/ 路由/ ,/ 传感器/ 节点/ 向/ 单元/ 头/ 节点/ 传输数据/ 平均/ 需要/ 3.13/ 跳/ ,/ 每个/ 传感器/ 节点/ 平均/ 有/ 10.97/ 个/ 邻居/ 节点/ ./ 本/ 实验/ 的/ 前/ 两组/ 实验/ 分别/ 考查/ 查询/ 参数/ k/ 值/ 和/ 查询/ 周期/ t/ 对/ 以下/ 3/ 种/ 协议/ 单元/ 内/ 传感器/ 节点/ 通信量/ 和/ 单元/ 外/ 通信量/ 影响/ :/ 使用/ 数据项/ 加密/ 链/ 验证/ 模式/ 的/ SafeTQ/ -/ L/ 、/ 使用/ 概率/ 空间/ 邻居/ 验证/ 模式/ 的/ SafeTQ/ -/ N/ 和/ 没有/ 隐私/ 保护/ 和/ 验证/ 机制/ 的/ Top/ -/ k/ 查询/ 协议/ Topk/ -/ TAG/ ./ 为了/ 增加/ 可比性/ ,/ Topk/ -/ TAG/ 和/ SafeTQ/ 使用/ 同样/ 的/ Top/ -/ k/ 查询/ 策略/ 和/ TAG/ 路由/ ./ 第/ 3/ 组/ 实验/ 考察/ SafeTQ/ -/ N/ 中/ 空间/ 邻居/ 节点/ 发送/ 验证/ 消息/ 的/ 概率/ p/ 对/ SafeTQ/ -/ N/ 协议/ 通信量/ 的/ 影响/ ./ 为/ 便于/ 描述/ ,/ 本/ 实验/ 假设/ 1/ 个/ 时间/ 单位/ 传感器/ 节点/ 采集/ 1/ 轮/ 数据/ ,/ 即/ 查询/ 周期/ t/ 内/ 采集/ t/ 轮/ 数据/ ./ 第/ 1/ 组/ 实验/ 考查/ k/ 值/ 对/ 通信量/ 的/ 影响/ ./ 实验/ 在/ 参数/ t/ =/ 10/ 和/ p/ =/ 0.6/ 下/ 进行/ ./ 图/ 3/ 显示/ k/ 值/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 影响/ ,/ 可以/ 看出/ SafeTQ/ -/ L/ 和/ SafeTQ/ -/ N/ 通信量/ 高于/ 没有/ 隐私/ 保护/ 和/ 验证/ 机制/ 的/ Topk/ -/ TAG/ ,/ SafeTQ/ -/ L/ 通信量/ 略高于/ SafeTQ/ -/ N/ ./ 同时/ ,/ 三者/ 趋势/ 基本相同/ ,/ 当/ k/ </ 10/ 时/ ,/ 通信量/ 随/ k/ 值/ 接近/ 于/ 线性/ 增长/ ,/ 当/ k/ / 10/ 时/ ,/ 通信量/ 增长/ 缓慢/ ./ 这/ 是因为/ 单元/ 内/ 传感器/ 节点/ 通信量/ 主要/ 由/ 传感器/ 节点/ 将/ 采集/ 数据/ 的/ 前/ k/ 项/ 或/ 全部/ 数据传输/ 到/ 单元/ 头/ 节点/ 产生/ ,/ 以/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ ./ 在/ 本组/ 实验/ 中/ t/ =/ 10/ ,/ 根据/ 假设/ 在/ 查询/ 周期/ t/ 内/ 传感器/ 节点/ 采集/ 10/ 项/ 数据/ ./ 为/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ 当/ k/ </ t/ 时/ ,/ 传感器/ 节点/ 上传/ 前/ k/ 项/ 数据/ ,/ 通信量/ 随/ k/ 值/ 呈/ 近似/ 线性/ 增长/ ,/ 当/ k/ / t/ 时/ ,/ 传感器/ 节点/ 上传/ 全部/ 的/ t/ 项/ 数据/ ,/ 此时/ 通信量/ 随/ k/ 值/ 增长/ 不再/ 显著/ ./ SafeTQ/ 中/ 由于/ 传输/ 随机数/ 、/ 验证/ 消息/ 和/ 对/ 响应/ 查询/ 数据/ 加密/ ,/ 使得/ SafeTQ/ -/ L/ 和/ SafeTQ/ -/ N/ 通信量/ 高于/ Topk/ -/ TAG/ ./ 图/ 4/ 显示/ k/ 值/ 对/ 单元/ 头/ 节点/ 和/ Sink/ 之间/ 通信量/ 的/ 影响/ ,/ 可以/ 看出/ SafeTQ/ -/ L/ 通信量/ 明显/ 高于/ SafeTQ/ -/ N/ 和/ Topk/ -/ TAG/ ,/ 这/ 是因为/ SafeTQ/ -/ L/ 使用/ 的/ 数据项/ 加密/ 链/ 验证/ 模式/ 要求/ 使用/ 增加/ 冗余/ 数据/ 形成/ 数据项/ 加密/ 链/ ,/ 并且/ 需要/ 全部/ 非/ Top/ -/ k/ 节点/ 发送/ 验证/ 消息/ ,/ 使得/ 其/ 通信量/ 高于/ SafeTQ/ -/ N/ ./ 图/ 3k/ 值/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 的/ 影响/ (/ t/ =/ 10/ ,/ p/ =/ 0.6/ )/ 图/ 4k/ 值/ 对/ 单元/ 外部/ 通信量/ 的/ 影响/ (/ t/ =/ 10/ ,/ p/ =/ 0.6/ )/ 第/ 2/ 组/ 实验/ 考查/ 查询/ 周期/ t/ 对/ 通信量/ 的/ 影响/ ./ 实验/ 在/ 参数/ k/ =/ 10/ 和/ p/ =/ 0.6/ 下/ 进行/ ./ 根据/ 假设/ 查询/ 周期/ t/ 内/ 传感器/ 节点/ 采集/ t/ 轮/ 数据/ ./ 图/ 5/ 考查/ 查询/ 周期/ t/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 影响/ ,/ 通信量/ 增长/ 的/ 主体/ 趋势/ 和/ 原因/ 与/ 图/ 3/ 相似/ ./ 为/ 计算/ 第/ k/ 位/ 数据/ 值/ vkth/ ,/ 当/ t/ </ k/ 时/ ,/ 传感器/ 节点/ 上传/ 全部/ 的/ t/ 项/ 数据/ ,/ 通信量/ 随/ t/ 值/ 接近/ 于/ 线性/ 增长/ ,/ 当/ t/ / k/ 时/ ,/ 传感/ ①/ http/ :/ // // sensorscope/ ./ epfl/ ./ ch/ // index/ ./ php/ // Environmental/ _/ DataPage10/ 器/ 节点/ 上传/ 前/ k/ 项/ 数据/ ,/ 此时/ 通信量/ 随/ t/ 值/ 增长/ 不再/ 显著/ ./ 在/ 图/ 5/ 、/ 图/ 6/ 中/ ,/ t/ =/ 1/ 时/ ,/ SafeTQ/ -/ N/ 的/ 通信量/ 高于/ SafeTQ/ -/ L/ ,/ 这/ 是因为/ 从/ 统计/ 意义/ 上/ 看/ ,/ k/ 值/ 相同/ 时/ ,/ t/ 值越/ 小/ Top/ -/ k/ 节点/ 数目/ 越/ 多/ ,/ 当/ t/ =/ 1/ 时/ ,/ Top/ -/ k/ 节点/ 个数/ 为/ k/ ,/ 而/ SafeTQ/ -/ N/ 要求/ 每个/ Top/ -/ k/ 节点/ 广播/ 消息/ 给/ 邻居/ 节点/ ,/ 邻居/ 节点/ 再/ 以/ 概率/ 发送/ 验证/ 消息/ ,/ 所以/ Top/ -/ k/ 节点/ 数量/ 对/ SafeTQ/ -/ N/ 通信量/ 影响/ 较大/ ./ 图/ 6/ 显示/ t/ 值/ 对/ 单元/ 头/ 节点/ 和/ Sink/ 之间/ 通信量/ 的/ 影响/ ,/ 可以/ 看出/ t/ 值/ 对/ SafeTQ/ -/ N/ 影响/ 较大/ ,/ 对/ SafeTQ/ -/ L/ 影响/ 较/ 小/ ,/ 而/ Topk/ -/ TAG/ 不受/ t/ 值/ 影响/ ./ 图/ 5/ 查询/ 周期/ t/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 的/ 影响/ 图/ 6/ 查询/ 周期/ t/ 对/ 单元/ 外部/ 通信量/ 的/ 影响/ (/ k/ =/ 10/ ,/ p/ =/ 0.6/ )/ 第/ 3/ 组/ 实验/ 考查/ SafeTQ/ -/ N/ 发送/ 验证/ 消息/ 概率/ p/ 对/ 通信量/ 的/ 影响/ ./ 实验/ 在/ 参数/ k/ =/ 10/ 和/ t/ =/ 10/ 下/ 进行/ ./ 从图/ 7/ 、/ 图/ 8/ 可以/ 看出/ ,/ 单元/ 内/ 传感器/ 节点/ 通信量/ 和/ 单元/ 外/ 通信量/ 均/ 随/ 概率/ 增大/ 而/ 单调/ 递增/ ./ 同时/ 可以/ 看出/ ,/ 无论/ p/ 取何值/ ,/ SafeTQ/ -/ N/ 通信量/ 均/ 低于/ SafeTQ/ -/ L/ ,/ 但/ 高于/ Topk/ -/ TAG/ ./ 图/ 7/ 概率/ p/ 对/ 单元/ 内/ 传感器/ 节点/ 通信量/ 的/ 影响/ (/ k/ =/ 10/ ,/ t/ =/ 10/ )/ 图/ 8/ 概率/ p/ 对/ 单元/ 外部/ 通信量/ 的/ 影响/ (/ k/ =/ 10/ ,/ t/ =/ 10/ )/ 7/ 总结/ 目前/ 传感器/ 网络/ 中/ 隐私/ 保护/ 精确/ Top/ -/ k/ 查询/ 协议/ 研究/ 已/ 成为/ 富有/ 挑战性/ 的/ 研究/ 问题/ ./ 本文/ 提出/ 了/ 一种/ 两层/ 传感器/ 网络/ 中/ 可验证/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ SafeTQ/ ./ 根据/ 使用/ 的/ 完整性/ 验证/ 模式/ 不同/ ,/ SafeTQ/ 分为/ SafeTQ/ -/ L/ 和/ SafeTQ/ -/ N/ ./ 对/ SafeTQ/ 的/ 安全性/ 和/ 有效性/ 评价/ 总结/ 如下/ :/ (/ 1/ )/ SafeTQ/ 使用/ 随机数/ 扰乱/ 、/ 加密/ 和/ 高/ 资源/ 节点/ 之间/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 策略/ ,/ 首次/ 实现/ 了/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 精确/ 地/ 完成/ 传感器/ 网络/ Top/ -/ k/ 查询/ ,/ 并/ 能够/ 对/ 完整性/ 攻击/ 进行/ 有效/ 检测/ ./ 利用/ 两层/ 传感器/ 网络/ 中/ 高/ 资源/ 节点/ 的/ 资源/ 和/ 通讯/ 优势/ ,/ 使/ 其/ 承担/ 安全/ 计算/ 第/ k/ 位/ 数据/ 值/ 任务/ ,/ 减少/ 传感器/ 节点/ 能量消耗/ ,/ 增强/ SafeTQ/ 有效性/ 和/ 可行性/ ./ (/ 2/ )/ 根据/ 安全性/ 分析/ ,/ SafeTQ/ 在/ 完成/ Top/ -/ k/ 查询/ 过程/ 中/ ,/ 单元/ 头/ 节点/ 和/ 辅助/ 计算/ 节点/ 不能/ 获得/ 定义/ 1/ 中/ 描述/ 的/ 3/ 类/ Top/ -/ k/ 查询/ 敏感/ 信息/ ;/ SafeTQ/ -/ L/ 检测/ 出/ 破坏/ 完整性/ 攻击/ 的/ 概率/ 高于/ SafeTQ/ -/ N/ ./ (/ 3/ )/ 从/ 真实/ 数据/ 仿真/ 实验/ 结果/ 看/ ,/ 在/ 单元/ 内/ 传感器/ 节点/ 通信量/ 方面/ ,/ SafeTQ/ -/ L/ 、/ SafeTQ/ -/ N/ 通信量/ 比/ 没有/ 隐私/ 保护/ 的/ Topk/ -/ TAG/ 的/ 通信量/ 增加/ 的/ 倍数/ ,/ 远/ 小于/ 文献/ [/ 1/ ]/ 中/ 使用/ 隐私/ 保护/ 技术/ 的/ CPDA/ 、/ SMART/ 通信量/ 比/ TAG/ 通信量/ 增加/ 的/ 倍数/ ;/ 在/ 单元/ 外/ 通信量/ 方面/ ,/ 在/ 本/ 实验/ 设定/ 的/ 参数/ 范围/ 内/ ,/ SafeTQ/ -/ L/ 、/ SafeTQ/ -/ N/ 和/ Topk/ -/ TAG/ 通信量/ 都/ 小于/ 5000bytes/ ;/ SafeTQ/ -/ N/ 平均/ 通信量/ 高于/ SafeTQ/ -/ L/ ./ 致谢/ 感谢/ 本文/ 审稿/ 专家/ 和/ 编辑/ 老师/ 所/ 提出/ 的/ 宝贵意见/ 和/ 建议/ !/ 

