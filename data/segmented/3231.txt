Page1/ 多/ 摄像机/ 监控/ 中/ 基于/ 贝叶斯/ 因果/ 网/ 的/ 人物/ 角色/ 识别/ 明/ 安龙/ 马/ 华东/ 傅慧源/ (/ 北京邮电大学/ 智能/ 通信软件/ 与/ 多媒体/ 北京市/ 重点/ 实验室/ 北京/ 100876/ )/ 摘要/ 很多/ 传统/ 视觉/ 监控/ 的/ 研究/ 工作/ 集中/ 于/ 行人/ 跟踪/ 、/ 行为/ 和/ 事件/ 检测/ 、/ 步态/ 或/ 人脸识别/ 等/ ,/ 然而/ 角色/ 识别/ 却/ 研究/ 较少/ ./ 针对/ 多/ 摄像机/ 监控/ 中/ 角色/ 识别/ 的/ 应用/ 问题/ ,/ 该文/ 作者/ 提出/ 了/ 一种/ 基于/ 贝叶斯/ 因果/ 网/ 的/ 角色/ 识别方法/ ./ 该/ 方法/ 不仅/ 用到/ 了/ 通常/ 的/ 一些/ 人物/ 视觉/ 特征/ ,/ 而且/ 还/ 考虑/ 了/ 时间/ 特征/ 、/ 空间/ 统计/ 特征/ 和/ 一些/ 其它/ 特征/ ./ 作者/ 将/ 这些/ 特征向量/ 的/ 概率分布/ 参数/ 化/ ,/ 特征向量/ 成员/ 之间/ 的/ 因果关系/ 通过/ 有/ 向/ 无/ 环图/ 的/ 方式/ 来/ 表达/ ,/ 然后/ 通过/ 提取/ 的/ 特征/ 来/ 计算/ 概率/ 以/ 识别/ 人物/ 角色/ ./ 实验/ 的/ 结果/ 证明/ 了/ 方法/ 的/ 有效性/ ./ 关键词/ 监控/ ;/ 多/ 摄像头/ ;/ 角色/ 识别/ ;/ 贝叶斯/ 因果/ 网/ 1/ 引言/ 我们/ 将/ 一个/ 人/ “/ 角色/ ”/ 理解/ 为/ 其/ 在/ 视觉/ 监控/ 场景/ 中/ 伴随/ 着/ 某种/ 责任/ 的/ 表现形式/ ,/ 如/ 医生/ 和/ 病人/ 、/ 售货员/ 和/ 顾客/ 等/ ./ 传统/ 的/ 监控/ 活动/ 一般/ 是/ 跟踪/ 行人/ 和/ 识别/ 可疑/ 的/ 行为/ ,/ 如/ DOTS/ [/ 1/ ]/ 研究/ 了/ 新颖/ 的/ 监控/ 用户/ 接口/ ,/ 这些/ 接口/ 主要/ 是/ 基于/ 行人/ 跟踪/ 技术/ ./ 然而/ ,/ 一/ Page2/ (/ 1/ )/ 他们/ 通常/ 穿着/ 职业/ 相关/ 的/ 工作服/ ,/ 如/ 大楼/ 保安员/ 一般/ 穿着/ 保安/ 专用/ 服装/ 、/ 佩戴/ 通话/ 机/ 或/ 手持/ 警棍/ ;/ 场景/ ,/ 即/ 他们/ 和/ 其他人/ 一样/ 混杂/ 在/ 监控/ 视频/ 中/ ;/ (/ 2/ )/ 他们/ 工作/ 的/ 场所/ 通常/ 也/ 是/ 视频/ 监控/ 关注/ 的/ (/ 3/ )/ 他们/ 的/ 活动/ 区域/ 通常/ 是/ 相对/ 固定/ 的/ ,/ 如/ 售货员/ 通常/ 位于/ 柜台/ 附近/ ,/ 清洁员/ 有/ 自己/ 负责/ 的/ 清洁/ 区域/ ,/ 而/ 大楼/ 保安员/ 有/ 自己/ 固定/ 的/ 巡视/ 区域/ ;/ 某人/ 的/ 角色/ 通常/ 被/ 视为/ 高层/ 信息/ 而/ 隐藏/ 在/ 多媒体/ 数据/ 中/ ./ 高层/ 信息/ 一般/ 不/ 直接/ 在/ 数据/ 中/ 表明/ ,/ 但是/ 这些/ 信息/ 有/ 可能/ 通过/ 一个/ 自动化/ 过程/ 被/ 提取/ 出来/ [/ 4/ ]/ ./ 角色/ 识别/ 将/ 不同/ 的/ 实体/ 与/ 不同/ 的/ 角色/ 一一对应/ 起来/ ./ 在/ 监控/ 视频/ 、/ 视频/ 分析/ 和/ 视频/ 挖掘/ 中/ ,/ 识别/ 或/ 辨别/ 一个/ 人物/ 所/ 扮演/ 的/ 角色/ ,/ 从/ 某种意义/ 上/ 讲/ 是/ 一个/ 语义/ 信息提取/ 的/ 过程/ ./ 这些/ 角色/ 可能/ 是/ 室内/ 的/ 清洁员/ 、/ 大楼/ 保安员/ 或/ 商场/ 售货员/ 等/ ./ 我们/ 可以/ 总结/ 出/ 这些/ 角色/ 的/ 一些/ 共有/ 的/ 特点/ ,/ 而/ 这些/ 特点/ 一般/ 是/ 这些/ 角色/ 的/ 工作/ 性质/ 所/ 决定/ 的/ :/ (/ 4/ )/ 他们/ 出现/ 在/ 被/ 监控/ 的/ 场所/ 中/ 时间/ 长度/ 和/ 频率/ 是/ 有/ 规律/ 的/ ,/ 如/ 保安/ 巡视/ 的/ 时间/ 比较/ 有/ 规律/ ;/ 清洁员/ 一般/ 在/ 早上/ 、/ 中午/ 、/ 晚上/ 人少/ 的/ 时候/ 做/ 清洁/ 等/ ./ 角色/ 识别/ 在/ 视觉/ 监控/ 、/ 视频/ 分析/ 和/ 视频/ 数据挖掘/ 中/ 非常/ 重要/ ./ 在/ 视觉/ 监控/ 中/ ,/ 那些/ 特殊/ 角色/ 的/ 人/ 往往/ 被/ 认为/ 是/ 拥有/ 较/ 高/ 或者/ 较/ 低/ 安全系数/ 的/ 实体/ ./ 从/ 实时/ 监测/ 中/ 减少/ 系统/ 负载/ 的/ 角度/ 出发/ ,/ 我们/ 可以/ 忽略/ 这些/ 人/ 或者/ 相反/ 地/ 仅仅/ 集中/ 注意力/ 在/ 这些/ 人/ 身上/ ./ 从/ 视觉/ 监控/ 的/ 语义/ 提取/ 角度/ ,/ 一些/ 行为/ 可能/ 对/ 普通人/ 来讲/ 是/ 禁止/ 的/ (/ 如/ 购物者/ 进入/ 工作/ 车间/ )/ ,/ 但是/ 这些/ 行为/ 对/ 特殊/ 角色/ 的/ 人/ 来说/ 却是/ 允许/ 的/ ,/ 如果/ 不/ 考虑/ 角色/ 的话/ 可能/ 会/ 产生/ 错误/ 的/ 警报/ ./ 同样/ 的/ ,/ 在/ 视频/ 分析/ 和/ 视频/ 数据挖掘/ 中/ 很/ 有/ 必要/ 排除/ 那些/ 特殊/ 角色/ 的/ 人/ ,/ 因为/ 不/ 排除/ 的话/ 往往/ 得出/ 的/ 统计/ 结果/ 也/ 会/ 是/ 错误/ 的/ ,/ 如某/ 场所/ 的/ 人员/ 计数/ 、/ 大楼/ 保安员/ 或/ 清洁员/ 等/ 很/ 容易/ 被/ 重复/ 计数/ ,/ 而/ 实际上/ 他们/ 不是/ 我们/ 所/ 关注/ 的/ 过客/ ./ 视频/ 中/ 的/ 角色/ 识别/ 不同于/ 传统/ 的/ 目标/ 识别/ 、/ 目标/ 分类/ 和/ 事件/ 检测/ ./ 视频/ 中/ 的/ 事件/ 检测/ 是从/ 视频/ 中/ 检索/ “/ 故事/ ”/ ,/ 属于/ 新/ 的/ 或是/ 事先/ 未定义/ 的/ 事件/ 识别/ 而/ 不是/ 一个/ 人/ 的/ 角色/ 识别/ ./ 换言之/ ,/ 视频/ 中/ 事件/ 检测/ 是/ 一个/ 无/ 监督/ 的/ 学习/ 任务/ (/ 没有/ 标定/ 的/ 训练样本/ )/ ,/ 而/ 视频/ 中/ 的/ 角色/ 识别/ 则/ 是/ 一个/ 推理/ 的/ 过程/ ./ 目前/ ,/ 基于/ 视频/ 的/ 事件/ 检测/ 方法/ 一般/ 是/ 基于/ 预先/ 定制/ 的/ 语法/ 规则/ 或者/ 语义/ 描述/ ,/ 通过/ 一些/ 变量/ 的/ 概率分析/ 来/ 达到/ 分类/ 或者/ 识别/ 的/ 目的/ ./ 此外/ ,/ 角色/ 识别/ 和/ 传统/ 的/ 目标/ 识别/ 的/ 区别/ 或/ 差异/ 可/ 总结/ 如下/ :/ 的/ ,/ 而/ 角色/ 识别/ 则/ 是/ 基于/ 一个/ 推理/ 过程/ ;/ (/ 1/ )/ 传统/ 的/ 目标/ 识别/ 或/ 分类/ 是/ 基于/ 观察/ 特征/ (/ 2/ )/ 角色/ 识别/ 相对/ 于/ 传统/ 的/ 目标/ 识别/ 而言/ 属于/ 更/ 高层/ 的/ 语义/ 信息/ ,/ 这/ 意味着/ 目标/ 识别/ 的/ 结果/ 可能/ 被/ 用于/ 角色/ 识别/ ;/ (/ 3/ )/ 在/ 传统/ 的/ 目标/ 识别/ 中/ ,/ 经常/ 使用/ 的/ 仅仅/ 是/ 相对/ 底层/ 的/ 特征/ ,/ 如/ 视觉/ 特征/ 、/ 音频/ 特征/ 等/ ;/ 而/ 角色/ 识别/ 不仅/ 考虑/ 底层/ 特征/ ,/ 而且/ 包括/ 其它/ 高层/ 特征/ ;/ (/ 4/ )/ 传统/ 的/ 目标/ 识别/ 中/ ,/ 特征向量/ 的/ 各个/ 成员/ 变量/ 经常/ 是/ 独立/ 统计/ 的/ ;/ 而/ 角色/ 识别/ 中/ 所/ 使用/ 特征向量/ 的/ 各个/ 成员/ 变量/ 则/ 往往/ 是/ 统计/ 相关/ 的/ ,/ 我们/ 必须/ 考虑/ 成员/ 变量/ 之间/ 的/ 因果关系/ ./ 在/ 本文/ 中/ ,/ 我们/ 提出/ 了/ 一种/ 使用/ 贝叶斯/ 因果/ 网来/ 进行/ 多/ 摄像机/ 监控/ 环境/ 下/ 的/ 人物/ 特殊/ 角色/ 识别/ 的/ 方法/ ./ 多/ 视角/ 将/ 有利于/ 移动/ 目标/ 的/ 定位/ 和/ 克服/ 遮挡/ ./ 本文/ 方法/ 的/ 特点/ 如下/ :/ (/ 1/ )/ 综合/ 视觉/ 特征/ 、/ 时空/ 特征/ 和/ 其它/ 特征/ 用于/ (/ 2/ )/ 特征向量/ 中/ 成员/ 变量/ 之间/ 的/ 因果关系/ 通过/ (/ 3/ )/ 视觉/ 特征/ 和/ 一些/ 统计/ 特征/ 从/ 存在/ 重叠/ 视域/ 的/ 多/ 摄像机/ 监控/ 的/ 视频/ 中/ 获取/ 以/ 获得/ 更大/ 场景/ 的/ 表示/ ./ 2/ 相关/ 工作/ 基于/ 贝叶斯/ 因果/ 网/ 的/ 有/ 向/ 无/ 环图/ 的/ 形式/ 表示/ ;/ 角色/ 识别/ ;/ 角色/ 识别/ 试图/ 从/ 多媒体/ 数据/ 记录/ 中/ 提取/ 高层/ 语义/ 信息/ ,/ 因为/ 人物/ 角色/ 通常/ 并/ 没有/ 直接/ 在/ 数据/ 中/ 表示/ 出来/ 而/ 需要/ 一个/ 推理/ 的/ 过程/ 才能/ 得到/ ./ 相似/ 的/ 工作/ 还/ 包括/ Barzilay/ 等/ [/ 5/ ]/ 提出/ 了/ 一个/ 基于/ 词汇/ 特殊性/ 的/ 方法/ 来/ 进行/ 电台/ 广播/ 中/ 的/ 角色/ 识别/ ,/ 这种/ 方法/ 使用/ 的/ 是/ 音频/ 特征/ ;/ Javed/ 等/ [/ 6/ ]/ 描述/ 了/ 考虑/ 视觉/ 通道/ 的/ 技术/ 来/ 划分/ 电视节目/ 片段/ 中/ 主持人/ 和/ 嘉宾/ 的/ 一种/ 方法/ (/ 视觉/ 通道/ 指/ 的/ 是/ 一种/ 图像/ 序列/ 端到/ 端的/ 传输方式/ )/ ,/ 但是/ 这种/ 方法/ 主要/ 依赖于/ 传输/ 过程/ 中/ 的/ 某些/ 信息/ 而/ 不是/ 对/ 视频/ 场景/ 的/ 内容/ 进行/ 分析/ 来/ 得到/ 角色/ 识别/ 的/ 结果/ ;/ Vinciarelli/ [/ 4/ ]/ 提出/ 了/ 一种/ 电台/ 广播/ 新闻/ 的/ 参与者/ 中/ 说话/ 人/ 角色/ 识别/ 的/ 方法/ ,/ 例如/ 主持人/ 和/ 嘉宾/ ,/ 该/ 方法/ 使用/ 了/ 伯努利/ 分布/ 来/ 进行/ 角色/ 的/ 建模/ 和/ 识别/ ;/ Hung/ 等/ [/ 3/ ]/ 提出/ 了/ 一个/ 系统/ 架构/ 来/ 检测/ 一个多/ 人/ 会议/ 中起/ 主导作用/ 的/ 那个/ 人/ ,/ 在/ 这个/ 架构/ 中/ 使用/ 了/ 不同/ 的/ 音频/ 和/ 视频/ 线索/ ,/ Hung/ 等/ 独立/ 地/ 提取/ 每种/ 测量/ 值/ ,/ 然后/ 选择/ 那个/ 总分/ 最高/ 的/ 人/ 作为/ 整个/ 会场/ 的/ 主持人/ ./ 总体而言/ ,/ 角色/ 识别/ 是/ 一件/ 具有/ 挑战性/ 的/ 事情/ ,/ 它/ 需要/ 在/ 内容/ 理解/ 的/ 基础/ 上/ 进行/ 分析/ Page3/ 和/ 判断/ ./ 按照/ 所/ 采用/ 特征/ 种类/ 的/ 不同/ ,/ 角色/ 识别/ 的/ 相关/ 工作/ 大致/ 可/ 被/ 划分/ 为/ 下面/ 3/ 类/ :/ (/ 1/ )/ 基于/ 文本/ 的/ 方法/ ./ 首先/ 将/ 相关/ 文件/ 转换成/ 文本/ ,/ 然后/ 基于/ 文本/ 内容/ 进行/ 检索/ ./ 这类/ 方法/ 相对/ 简单/ ,/ 文献/ [/ 5/ ]/ 就/ 属于/ 这种/ 方法/ ./ 然而/ ,/ 通常/ 包含/ 在/ 视频/ 中/ 的/ 内容/ 比较/ 文本/ 而言/ 要/ 丰富/ 得/ 多/ ,/ 主观/ 上/ 和/ 客观/ 上/ 都/ 很/ 难/ 转换成/ 文本/ 的/ 描述/ ./ (/ 2/ )/ 基于/ 组合/ 底层/ 特征/ 的/ 方法/ ./ 这类/ 方法/ 单独/ 考虑/ 不同/ 的/ 底层/ 特征/ 并/ 将/ 这些/ 特征/ 组合/ 起来/ ,/ 文献/ [/ 3/ ]/ 就是/ 属于/ 这/ 类/ 方法/ ./ 然而/ 在/ 这类/ 方法/ 中/ ,/ 不同/ 特征/ 与/ 待/ 识别/ 角色/ 之间/ 、/ 特征/ 之间/ 的/ 相互/ 关系/ 被忽略了/ ./ (/ 3/ )/ 基于/ 高层/ 特征/ 的/ 方法/ ./ 这类/ 方法/ 试图/ 提取/ 若干/ 高层/ 信息/ 作为/ 特征/ 来/ 进行/ 角色/ 识别/ ,/ 如/ 身份/ 、/ 情绪/ 状态/ 、/ 有/ 说服力/ 的/ 内容/ 和/ 各种/ 不同/ 类型/ 的/ 事件/ 等/ ./ 文献/ [/ 4/ ,/ 6/ ]/ 等/ 就是/ 属于/ 这/ 一类/ 方法/ ./ 然而/ 这/ 类/ 方法/ 存在/ 一些/ 不确定性/ ,/ 一是/ 特征/ 的/ 层次/ 越高/ ,/ 当/ 特征提取/ 错误/ 时/ 对/ 结果/ 的/ 负面影响/ 越大/ ;/ 二是/ 如何/ 将/ 这些/ 高层/ 特征/ 有效/ 合理/ 地/ 组合/ 起来/ ./ 在/ 本文/ 提出/ 的/ 方法/ 中/ ,/ 不仅/ 是/ 底层/ 的/ 视觉/ 特征/ ,/ 还有/ 时空/ 统计/ 特征/ 以及/ 其它/ 的/ 高层/ 特征/ 都/ 被/ 用于/ 角色/ 识别/ ./ 在/ 某些/ 情况/ 下/ 我们/ 可以/ 安全/ 地/ 直接/ 假设/ 特征/ 之间/ 是否/ 相关/ ./ 我们/ 用/ 有/ 向/ 无环/ 图来/ 表达/ 这种/ 因果/ 依赖/ 关系/ ./ 当/ 一个/ 分类器/ 使用/ 的/ 各种/ 特征/ 之间/ 的/ 依赖/ 关系/ 是/ 不/ 可知/ 的/ 时候/ ,/ 我们/ 会/ 认为/ 它们/ 之间/ 的/ 条件/ 是/ 独立/ 的/ ./ 本文/ 给出/ 一个/ 贝叶斯/ 因果/ 网/ 的/ 模型/ 样例/ 和/ 相应/ 的/ 条件/ 概率/ ,/ 然后/ 通过/ 已知/ 的/ 证据/ 就/ 可以/ 对/ 角色/ 的/ 结果/ 进行/ 推理/ ./ 3/ 方法/ 概述/ 角色/ 识别/ 问题/ 有/ 一些/ 重要/ 的/ 特点/ :/ (/ 1/ )/ 它/ 是/ 一个多/ 角色/ 分类/ 问题/ ;/ (/ 2/ )/ 我们/ 可以/ 利用/ 的/ 事实/ 是/ 有限/ 的/ ;/ (/ 3/ )/ 即使/ 这些/ 有限/ 的/ 事实/ 在/ 某些/ 时候/ 也/ 可能/ 部分/ 缺失/ ,/ 缺失/ 的/ 部分/ 对/ 识别/ 没有/ 贡献/ ./ 我们/ 尝试/ 选择/ 一个/ 模型/ 将/ 所有/ 这些/ 有限/ 的/ 事实/ 融合/ 在/ 一起/ ./ 这个/ 模型/ 不仅仅/ 可/ 从/ 目前/ 已知/ 的/ 有限/ 事实/ 中/ 形成/ 一个/ 图/ 1/ 角色/ 识别/ 解决方案/ 的/ 框架图/ 如/ 经常/ 在/ 某些/ 固定/ 的/ 地方/ 停留/ 、/ 徘徊/ ;/ 最好/ 的/ 角色/ 识别/ 结果/ ,/ 而且/ 当/ 部分/ 事实/ 缺失/ 的/ 时候/ 依然/ 可以/ 知道/ 怎么/ 去/ 推断/ ./ 3.1/ 角色/ 特征/ 为了/ 实现/ 角色/ 识别/ ,/ 需要/ 知道/ 一些/ 有/ 相互依赖/ 关系/ 的/ 特征/ ,/ 这些/ 特征/ 有的是/ 从/ 视频/ 中/ 提取/ 得到/ 的/ ,/ 有的是/ 从/ 先验/ 知识/ 得到/ 的/ ./ 为了/ 从/ 视频/ 中/ 区分/ 角色/ ,/ 必须/ 基于/ 一些/ 事实/ 和/ 证据/ ./ 通过观察/ 我们/ 发现/ :/ (/ 1/ )/ 活动/ 时间/ ./ 通常/ 监控/ 场所/ 中/ 特殊/ 角色/ 的/ 人/ 活动/ 时间/ 是/ 非常/ 有/ 规律/ 的/ ,/ 如/ 主要/ 集中/ 在/ 上班时间/ ;/ (/ 2/ )/ 热点/ 区域/ ./ 特殊/ 角色/ 的/ 人/ 活动/ 比较/ 有/ 规律/ ,/ (/ 3/ )/ 频率/ 规律/ ./ 特殊/ 角色/ 的/ 人/ 通常/ 在/ 一段时间/ (/ 4/ )/ 衣着/ 特征/ ./ 特殊/ 角色/ 的/ 人/ 一般/ 身穿/ 工作服/ ;/ (/ 5/ )/ 随身/ 物品/ ./ 特殊/ 角色/ 的/ 人/ 身边/ 通常/ 有/ 一些/ 特殊/ 物品/ ,/ 如/ 大楼/ 保安员/ 经常/ 会/ 携带/ 对讲机/ 或者/ 警棍/ ./ 3.2/ 贝叶斯/ 因果/ 网/ 的/ 选用/ 本文/ 选择/ 贝叶斯/ 因果/ 网/ 作为/ 执行/ 角色/ 识别/ 的/ 模型/ ./ 因果/ 网是/ 一系列/ 随机变量/ 的/ 联合/ 概率分布/ 的/ 表示/ ,/ 它/ 由/ 两个/ 部分/ 组成/ :/ (/ 1/ )/ 一个/ 有/ 向/ 无/ 环图/ ,/ 其中/ 节点/ 表示/ 随机变量/ 而/ 边缘/ 线/ 表示/ 变量/ 之间/ 的/ 依赖/ 关系/ ;/ (/ 2/ )/ 每个/ 变量/ 的/ 条件/ 概率分布/ ./ 相较/ 于/ 其它/ 方法/ ,/ 如非/ 单调/ 逻辑/ [/ 7/ ]/ 、/ D/ -/ S/ 证据/ 理论/ [/ 8/ ]/ 和/ 模糊/ 逻辑/ [/ 9/ ]/ ,/ 因果/ 网在/ 解决/ 推理/ 问题/ 方面/ 更具/ 优势/ ./ 它/ 是/ 严格/ 的/ 数学/ 语言/ ,/ 有/ 完全/ 的/ 语义/ 表达能力/ ,/ 适合/ 计算机/ 处理/ [/ 10/ ]/ ;/ 内/ 反复/ 出现/ 于/ 一些/ 区域/ ;/ 相关/ 缺失/ 证据/ 对于/ 被/ 查询/ 变量/ 的/ 影响/ 会/ 减弱/ ;/ 它/ 直观/ 易懂/ ,/ 可以/ 很/ 方便/ 地/ 扩展/ 到/ 多/ 角色/ 分类/ ;/ 提供/ 了/ 一个/ 推理模型/ ,/ 当/ 某些/ 事实/ 缺失/ 的/ 时候/ ,/ 此外/ ,/ Laskey/ 等/ [/ 11/ ]/ 曾经/ 提出/ 使用/ 一个/ 因果/ 网来/ 解决/ 战斗机/ 身份/ 识别/ 中/ 固有/ 的/ 不确定性/ 、/ 复杂性/ 和/ 短时间/ 限制/ 的/ 问题/ ,/ 但/ 该/ 方法/ 主要/ 利用/ 的/ 是/ 雷达/ 信息/ ./ 3.3/ 本文/ 的/ 解决方案/ 本文/ 角色/ 识别/ 解决方案/ 的/ 框架图/ 如图/ 1/ 所示/ ./ 该/ 方案/ 逻辑/ 上/ 主要/ 分为/ 两个/ 部分/ :/ 特征提取/ 部分/ 和/ Page4/ 角色/ 识别/ 部分/ ./ 在/ 特征提取/ 阶段/ ,/ 我们/ 提取/ 时间/ 特征/ 、/ 统计/ 特征/ 、/ 颜色/ 形状/ 特征/ 以及/ 其它/ 特征/ ./ 所有/ 这些/ 特征/ 由/ 贝叶斯/ 因果/ 网/ 进行/ 融合/ ,/ 输出/ 的/ 结果/ 是/ 检测/ 出/ 的/ 或/ 跟踪/ 到/ 人/ 以及/ 他们/ 的/ 角色/ ./ 4/ 特征提取/ 与/ 分析/ 4.1/ 时间/ 特征/ 通常/ ,/ 特殊/ 角色/ 的/ 人会/ 有/ 一个/ 相对/ 稳定/ 的/ 工作/ 时间表/ ,/ 这/ 与/ 具体/ 的/ 工作/ 环境/ 有关/ ./ 在/ 不/ 应该/ 出现/ 的/ 时候/ 特殊/ 角色/ 的/ 人/ 却/ 出现/ 在/ 场景/ 中/ ,/ 对于/ 监控/ 而言/ 是/ 需要/ 关注/ 的/ ./ 如/ 我们/ 通过观察/ 发现/ 一个/ 大楼/ 清洁员/ 每天/ 大体/ 的/ 活动/ 规律/ 如表/ 1/ 所示/ ./ 如果/ 将表/ 1/ 所示/ 的/ 工作/ 时间表/ 视为/ 先验/ 知识/ ,/ 我们/ 可以/ 依据/ 古典/ 概率/ 理论/ 来/ 进行/ 时间/ 特征/ 概率分布/ 的/ 初始化/ ./ 4.2/ 统计/ 特征/ 统计/ 特征/ 所/ 依据/ 的/ 一个/ 事实/ 是/ 特殊/ 角色/ 的/ 人/ 拥有/ 相对/ 固定/ 的/ 活动/ 区域/ ./ 根据/ 这一/ 现象/ ,/ 我们/ 在/ 监控/ “/ Hot/ / spot/ ”/ 图/ 2/ 实验/ 场景/ 的/ 俯视图/ 建模/ 视频/ 中/ 划定/ 一些/ “/ 热区/ ”/ ,/ 如/ 本文/ 在/ 垃圾桶/ 附近/ 划定/ “/ 热区/ ”/ ,/ 然后/ 计算/ 监控/ 目标/ 在/ 监控/ 场景/ 逗留/ 期间/ 进入/ “/ 热区/ ”/ 的/ 次数/ 和/ 停留时间/ ./ 特殊/ 角色/ 的/ 人/ 因为/ 职责/ 所/ 限/ ,/ 与/ “/ 热区/ ”/ 相关/ 的/ 这个/ 统计/ 值会/ 很/ 高/ ./ 而要/ 提取/ 统计/ 特征/ ,/ 我们/ 需要/ 对/ 场景/ 进行/ 俯视图/ 建模/ 、/ 目标/ 跟踪/ 、/ 目标/ 定位/ 及/ 统计分析/ ./ (/ 1/ )/ 俯视图/ 建模/ ./ 本文/ 选取/ 某/ 教学楼/ 9/ 层/ 的/ 大厅/ 作为/ 实验/ 场景/ ./ 图/ 2/ 以/ 俯视图/ 的/ 形式/ 展示/ 了/ 摄像机/ 在/ 场景/ 中/ 的/ 部署/ 情况/ ./ 本文/ 按图/ 2/ 所示/ 建立/ 场景/ 的/ 世界/ 坐标系/ (/ Z/ 轴正/ 方向/ 向上/ )/ ./ “/ 热点/ ”/ 区域/ 设置/ 在/ 垃圾桶/ 附近/ ,/ 有/ 了/ 俯视图/ 模型/ 后/ ,/ 我们/ 就/ 可以/ 通过/ 目标/ 跟踪/ 和/ 目标/ 定位/ 来/ 确定/ 运动/ 目标/ 是否/ 在/ “/ 热区/ ”/ 之中/ ,/ 最后/ 确定/ 统计/ 特征/ ./ (/ 2/ )/ 目标/ 跟踪/ ./ 目标/ 跟踪/ 采用/ 基于/ 隐/ 马尔可夫/ 模型/ 的/ 粒子/ 滤波/ 算法/ ,/ 并/ 在/ 跟踪/ 的/ 过程/ 中/ 考虑/ 跳帧/ 的/ 负面影响/ ,/ 利用/ 一个/ 全局/ 的/ 运动/ 检测器/ 来/ 修正/ 跟踪/ ;/ 不同/ 视角/ 的/ 目标/ 匹配/ 算法/ 采用/ 基于/ 区域/ SIFT/ 的/ 目标/ 匹配/ 算法/ ,/ 具体/ 算法/ 描述/ 参见/ 文献/ [/ 12/ ]/ ./ 通过/ 目标/ 跟踪/ 算法/ ,/ 我们/ 得到/ 的/ 输出/ 是/ 一个/ 人体/ 的/ 矩形/ 区域/ ./ 这个/ 矩形/ 区域/ 在/ 目标/ 匹配/ 和/ 目标/ 定位/ 中将/ 作为/ 输入/ ./ 目标/ 跟踪/ 将/ 人体/ 的/ 矩形/ 区域/ 作为/ 输出/ 结果/ ,/ 不妨/ 选取/ 人体/ 矩形框/ 的/ 下边/ 中点/ 为/ 接触点/ ,/ 也/ 就是/ 用于/ 计算/ 的/ 特征/ 点/ ./ 当然/ ,/ 这样/ 选取/ 的/ 特征/ 点/ 肯定/ 引入/ 了/ 误差/ ,/ 图像/ 分析/ 所/ 勾勒/ 出/ 的/ 人体/ 范围/ 矩形框/ 下/ 底边/ 中心/ 并/ 不是/ 精确/ 的/ 人体/ 与/ 地面/ 接触/ Page5/ 范围/ 的/ 中心点/ ,/ 特别/ 是/ 当人/ 处于/ 移动/ 状态/ 下时/ ,/ 误差/ 还会/ 更/ 大/ ,/ 我们/ 在下文/ 的/ 目标/ 定位/ 中/ 需要/ 充分考虑/ 到/ 这个/ 误差/ ./ (/ 3/ )/ 目标/ 定位/ ./ 由于/ 大多数/ 情况/ 下/ 人体/ 目标/ 是/ 位于/ 场景/ 中/ 地面/ 上/ 的/ ,/ 从/ 计算机/ 视觉/ 的/ 世界/ 坐标系/ 来看/ ,/ 俯视图/ 下/ 的/ 目标/ 定位/ 只/ 需/ 关心/ X/ 和/ Y/ 轴/ 坐标/ ,/ Z/ 轴/ 坐标/ 在/ 需要/ 三维重建/ 的/ 时候/ 才/ 是/ 必须/ 的/ ./ 如果/ 将/ 人体/ 看作/ 一条/ 垂直于/ 地面/ 的/ 直线/ ,/ 定位/ 时/ 关心/ 的/ X/ 和/ Y/ 轴/ 坐标/ 就是/ 这/ 条/ 直线/ 与/ 地面/ 的/ 交点/ 坐标/ (/ X/ ,/ Y/ ,/ 0/ )/ ./ 此时/ 目标/ 定位/ 演变成/ 估算/ 人体/ 与/ 地面/ 接触/ 的/ 点/ ,/ 即人脚/ 的/ 位置/ ./ 在/ 实际/ 场景/ 中/ ,/ 人/ 与/ 地面/ 接触/ 的/ 范围/ 远不止/ 一个点/ ,/ 所以/ 需要/ 确定/ 在/ 这个/ 接触/ 范围/ 内/ 选取/ 一个/ 具有/ 代表性/ 的/ 点/ 来/ 进行/ 计算/ ./ 现在/ 介绍/ 计算/ 特征/ 点/ p/ ,/ 也/ 就是/ 人/ 与/ 地面/ 的/ 接触点/ 的/ 方法/ ./ 根据/ 立体/ 视觉/ 原理/ ,/ 用点/ p/ 的/ 图像/ 点/ 坐标/ (/ up/ ,/ vp/ )/ ,/ 可以/ 得到/ 从/ 摄像机/ 光心/ C/ 引出/ 的/ 射线/ Cp/ ./ 双目/ 视觉/ 的/ 定位/ 需要/ 从/ 另/ 一幅/ 图像/ 中/ 找出/ p/ 的/ 对应点/ p/ ,/ 根据/ 另一台/ 摄像机/ 的/ 光心/ C/ 也/ 引出/ 一条/ 射线/ Cp/ ,/ 联立方程/ 求/ 两条/ 射线/ 的/ 交点/ 以/ 得到/ p/ 的/ 世界坐标/ ./ 在/ 这里/ ,/ 由于/ 事先/ 引入/ 了/ 一个/ 约束条件/ :/ p/ 点必/ 在/ Z/ =/ 0/ 平面/ 上/ ,/ 所以/ 计算/ p/ 点/ 世界坐标/ 的/ 几何/ 意义/ 就/ 演变成/ 了/ 求/ Cp/ 这条/ 射线/ 与/ Z/ =/ 0/ 平面/ 的/ 交点/ ./ 具体/ 实现/ 上/ ,/ 摄像机/ 内外/ 参数估计/ 我们/ 使用/ Zhang/ 等/ [/ 13/ ]/ 提出/ 的/ 方法/ ,/ 该/ 方法/ 的/ 代码/ 已经/ 作为/ Intel/ 公司/ OpenCv/ 开源/ 视觉/ 处理/ 库/ 的/ 一部分/ ,/ 其中/ 涉及/ 到/ 的/ 标定/ 物是/ 一个/ 黑白相间/ 的/ 国际象棋/ 棋盘/ ,/ 我们/ 使用/ 的/ 是/ 大/ 的/ 棋盘/ 模型/ (/ 1.05/ m/ ×/ 1.05/ m/ )/ ./ 这样/ 我们/ 就/ 可以/ 得到/ 4/ 个/ 摄像机/ 分别/ 对应/ 的/ 平移/ 视点/ 间/ 的/ 4/ 个/ 单应/ 矩阵/ ./ 最后/ ,/ 我们/ 使用/ Sankaranarayanan/ 等/ [/ 14/ ]/ 提出/ 的/ 方法/ 对/ 视角/ 重合/ 的/ 两/ 两/ 摄像机/ 之间/ 的/ 目标/ 位置/ 的/ 估计/ 结果/ 进行/ 融合/ ,/ 以/ 得到/ 目标/ 定位/ 结果/ ./ (/ 4/ )/ 统计分析/ ./ 为了/ 进行/ 运动/ 目标/ 的/ 角色/ 识别/ ,/ 我们/ 对/ 该/ 运动/ 目标/ 在/ 监控/ 场景/ 的/ “/ 进入/ ”/ 状态/ 到/ “/ 离开/ ”/ 状态/ 这个/ 时间/ 区间/ 的/ 空间/ 位置/ 分布/ 进行/ 统计/ ./ 我们/ 约定/ :/ 一个/ 从/ 前面/ 的/ 监控/ 视频/ 跟踪/ 到/ 当前/ 视频/ 的/ 目标/ 称为/ TrackedObject/ ,/ 简称/ TO/ ;/ 而/ 从/ 当前/ 视频/ 开始/ 分割/ 出来/ 的/ 目标/ 称为/ DetectedObject/ ,/ 简称/ DO/ ./ 则/ 一个/ TO/ 的/ 统计/ 特征/ (/ StatisticalLocationFeature/ ,/ SLF/ )/ 的/ 计算/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 统计/ 特征提取/ ./ 输入/ :/ TO/ ,/ DO/ ,/ TO/ 相应/ 的/ SLF/ // // TO/ ,/ DO/ 为/ 矩形/ 区域/ 输出/ :/ TO/ 的/ SLF/ // // SLF/ 为/ 整数/ Begin1/ ./ if/ (/ 只/ 存在/ 一个/ TO/ ,/ 并且/ 这个/ TO/ 对应/ 到/ 一个/ DO/ )/ 2/ ./ if/ (/ TO/ 的/ 空间/ 位置/ 在/ “/ 热区/ ”/ 中/ )/ 3/ ./ ThenSLF/ ←/ SLF/ +/ 1/ ,/ returnSLF/ ./ 4/ ./ endif5/ ./ elseif/ (/ 存在/ 多个/ TO/ 对应/ 到/ 一个/ DO/ )/ 6/ ./ if/ (/ DO/ 的/ 空间/ 位置/ 在/ “/ 热区/ ”/ 中/ )/ 7/ ./ ThenSLF/ ←/ SLF/ +/ 1/ ,/ returnSLF/ ./ 8/ ./ endif9/ ./ elseif/ (/ 存在/ 一个/ DO/ 没有/ 任何/ 一个/ TO/ 与/ 之/ 对应/ )/ 10/ ./ Then/ 设/ 这个/ DO/ 为/ 新/ 的/ TO/ ,/ 新/ To/ 的/ SLF/ 置/ 为/ 0.11/ ./ endif12/ ./ returnSLF/ ./ End/ ./ 在/ 实际/ 的/ 系统/ 中/ 每秒/ 会/ 采集/ 至少/ 10/ 帧/ 以上/ 的/ 数据/ ,/ 逐帧/ 的/ 处理/ 没有/ 必要/ 而且/ 无法/ 满足/ 实时性/ 的/ 需求/ ./ 实际/ 处理/ 中/ 可/ 采用/ 输入/ 一个/ 时间/ 间隔/ ,/ 每个/ 时间/ 间隔/ 中/ 抽样/ 一帧/ 进行/ 统计/ ./ 4.3/ 颜色/ 形状/ 特征/ 特殊/ 角色/ 的/ 人/ 可能/ 包括/ 大楼/ 清洁员/ 、/ 大楼/ 保安员/ 、/ 售货员/ 、/ 送货员/ 等/ ./ 这些/ 人/ 的/ 一个/ 共同/ 特点/ 是/ 穿着/ 统一/ 的/ 职业服装/ ./ 基于/ 这种/ 先验/ 知识/ ,/ 我们/ 可以/ 考虑/ 从/ 视频/ 中/ 提取/ 一些/ 底层/ 视觉/ 特征/ 来/ 帮助/ 我们/ 进行/ 推理/ 和/ 判断/ ./ 首先/ ,/ 我们/ 使用/ 一个/ 简单/ 的/ 分类器/ 去/ 区分/ 人/ 和/ 其它/ 的/ 移动/ 目标/ ./ 其次/ ,/ 如果/ 一个/ 移动/ 目标/ 被/ 确定/ 识别/ 为/ 人/ ,/ 我们/ 会/ 给出/ 一个/ YCbCr/ 颜色/ 空间/ 的/ 一个/ 统计分析/ ,/ 这个/ 分析/ 的/ 结果/ 可以/ 作为/ 底层/ 颜色/ 特征/ ./ 我们/ 使用/ 一个/ 垂直/ 方向/ 的/ 投影/ 直方图/ [/ 15/ ]/ 来/ 区分/ 任何/ 其它/ 移动/ 的/ 目标/ ,/ 前提/ 是/ 一个/ 人/ 的/ 形状/ 可以/ 由/ 其/ 投影/ 直方图/ 表示/ ./ 设/ I/ (/ x/ ,/ y/ )/ 是/ 一个/ 检测/ 出来/ 的/ 运动/ 区域/ 的/ 二值/ 图/ ,/ x/ 和/ y/ 分别/ 是/ 代表/ 水平/ 和/ 垂直/ 方向/ 的/ 坐标/ ./ 设/ H/ 和/ W/ 分别/ 是/ 这个/ 分割/ 出来/ 的/ 运动/ 区域/ 的/ 高/ 和/ 宽/ ,/ Y/ 轴/ 的/ 垂直/ 投影/ 直方图/ 是/ 相同/ 水平/ 坐标/ 的/ 所有/ 像素/ 个数/ 总计/ ,/ 这样/ 我们/ 可以/ 得到/ S/ :/ 一个/ 垂直/ 投影/ 直方图/ 的/ 分布/ ./ 其中/ h/ 是/ 垂直/ 投影/ 直方图/ ,/ 其/ 结果/ 是/ 由/ 前景/ 中/ 的/ 像素/ 投影/ 到/ 垂直/ 方向/ 得到/ ./ 其中/ 1/ / x/ / W/ ,/ 1/ / y/ / H/ ./ 通常/ 来讲/ 一个/ 孤立/ 的/ 人/ 的/ 垂直/ 投影/ 从/ 外表/ 上/ 看/ 要/ 比/ 其它/ 非人/ 目标/ 的/ 垂直/ 投影/ 要/ 显得/ 陡峭/ ,/ 因此/ 其/ 分布/ S/ 的/ 值/ 也/ 要/ 大于/ 其它/ 非人/ 目标/ ./ 同时/ 一个/ 非人/ 的/ 移动/ 目标/ 的/ 前景/ 像素/ 的/ 边/ Page6/ 缘/ 往往/ 要/ 比/ 一群/ 人/ 的/ 前景/ 像素/ 的/ 边缘/ 平滑/ ,/ 因此/ 一群/ 人/ 的/ 分布/ S/ 的/ 值/ 也/ 要/ 大于/ 其它/ 非人/ 目标/ ./ 基于/ 以上/ 分析/ ,/ 我们/ 可以/ 确定/ 一个/ 阈值/ 来/ 区分/ 人/ 和/ 非人/ 目标/ ./ 在/ 一个/ 被/ 跟踪/ 的/ 矩形/ 区域/ 内/ ,/ 我们/ 可以/ 给出/ 一个/ YCbCr/ 颜色/ 空间/ 的/ 统计/ ./ 如/ :/ 我们/ 知道/ 一个/ 大楼/ 清洁员/ 通常/ 穿着/ 一件/ 蓝色/ 的/ 制服/ ,/ 我们/ 首先/ 将/ 图像/ 从/ RGB/ 颜色/ 空间/ 转化/ 至/ YCbCr/ 颜色/ 空间/ ,/ 给定/ 一个/ 阈值/ 向量/ (/ Cbl/ ,/ Cbh/ ,/ Crl/ ,/ Crh/ )/ 、/ 一个/ 跟踪/ 的/ 矩形/ 区域/ Rvi/ ,/ 则/ 我们/ 可以/ 得到/ 颜色/ 特征值/ CS/ :/ CS/ =/ |/ {/ p/ |/ p/ ∈/ Rvi/ ,/ Cbl/ / “/ Cbvalueofp/ ”/ / Cbh/ ]/ and/ 其中/ ,/ p/ 为/ 像素点/ ,/ CS/ 可/ 理解/ 为/ 形状/ 为/ 人体/ 的/ 区域/ 中/ 服装/ 区域/ 主体/ 颜色/ 的/ 统计/ ./ 4.4/ 补充/ 特征/ 除了/ 上述/ 的/ 几个/ 特征/ 以外/ ,/ 识别/ 特殊/ 角色/ 的/ 人/ 还有/ 其它/ 一些/ “/ 蛛丝马迹/ ”/ 可以/ 参考/ ./ 如/ 一个/ 大楼/ 清洁员/ 一般/ 会/ 推着/ 一个/ 用于/ 盛放/ 垃圾/ 的/ 手推车/ ,/ 或者/ 拿/ 着/ 扫帚/ 、/ 拖把/ 等/ 物品/ ./ 本文/ 中/ ,/ 我们/ 使用/ 一个/ 前景/ 提取/ 并/ 结合/ 支撑/ 向量/ 机/ 的/ 算法/ 来/ 检测/ 手推车/ ./ 4.5/ 一个/ 因果/ 网/ 实例/ 给定/ 标定/ 的/ 节点/ T/ ,/ S/ ,/ R/ ,/ C/ ,/ A/ (/ T/ 代表/ 时间段/ 特征/ ,/ S/ 代表/ 统计/ 特征/ ,/ C/ 代表/ 颜色/ 形状/ 等/ 特征/ ,/ A/ 代表/ 其它/ 特征/ ,/ R/ 代表/ 人物/ 角色/ )/ ./ 每个/ 节点/ 表示/ 一个/ 系统/ 成员/ ,/ 其/ 取值/ 是/ 离散/ 的/ (/ 每个/ 系统/ 成员/ 的/ 变量/ 以/ 它/ 相应/ 的/ 小写/ 字符/ 来/ 表示/ )/ ./ 设/ e/ (/ 与/ T/ ,/ S/ ,/ C/ ,/ A/ 相应/ )/ 代表/ 从/ 多/ 摄像机/ 视觉/ 监控/ 视频/ 中/ 提取/ 出来/ 的/ 证据/ ./ 那么/ 问题/ 是/ :/ 我们/ 如何/ 设计/ 一个/ 贝叶斯/ 因果/ 网/ 模型/ ,/ 该/ 模型/ 可以/ 求解/ 条件/ 概率/ P/ (/ r/ |/ e/ )/ ?/ 设/ 条件/ 概率/ P/ (/ r/ |/ e/ )/ 表示/ 在/ 证据/ e/ 的/ 情况/ 下/ 人物/ 为/ 某种/ 角色/ 的/ 概率/ ./ 每个/ 节点/ 可能/ 的/ 取值/ 是/ 离散/ 的/ ,/ 如/ R/ 可以/ 取/ r1/ =/ “/ 清洁员/ ”/ ,/ r2/ =/ “/ 保安/ ”/ ,/ r3/ =/ “/ 行人/ ”/ ./ 在/ 这些/ 离散/ 的/ 状态/ ,/ P/ (/ r/ |/ e/ )/ 可能/ 有/ 连续/ 取值/ ./ 在/ 贝叶斯/ 因果/ 网中/ ,/ 每个/ 链接/ 是/ 有/ 方向/ 的/ 并/ 连接/ 两个/ 节点/ ,/ 链接/ 的/ 方向/ 代表/ 了/ 一个/ 节点/ 对/ 另/ 一个/ 节点/ 的/ 因果关系/ ./ 我们/ 考虑/ 通过/ 以下/ 的/ 证据/ 来/ 判别/ 人物/ 角色/ 的/ 状态/ :/ (/ 1/ )/ 时间/ 特征/ ./ 什么/ 时间/ 特殊/ 角色/ 的/ 人/ 最/ 有/ 可能/ 出现/ ?/ (/ 2/ )/ 统计/ 特征/ ./ 什么/ 地方/ 特殊/ 角色/ 的/ 人/ 最/ 有/ 可能/ 反复/ 出现/ ?/ (/ 3/ )/ 颜色/ 和/ 形状/ 特征/ ./ 是/ 人/ 还是/ 物/ ?/ 人/ 的/ 衣着/ 的/ 颜色/ ?/ (/ 4/ )/ 其它/ 特征/ ./ 周围/ 有/ 什么/ 东西/ ?/ 这些/ 特征/ 之间/ 的/ 关系/ 我们/ 可以/ 根据/ 知识/ 来/ 推断/ ,/ 如/ 时间/ 特征/ 和/ 统计/ 特征/ 不/ 存在/ 着/ 因果/ 联系/ ,/ 而/ 角色/ 类型/ 和/ 颜色/ 特征/ 之间/ 存在/ 因果/ 联系/ ./ 上述/ 证据/ 中/ ,/ 知道/ (/ 1/ )/ 、/ (/ 2/ )/ 和/ (/ 3/ )/ ,/ 则/ 可推断/ 人物/ 角色/ ;/ 而/ 若/ 人物/ 为/ 大楼/ 清洁员/ 的话/ ,/ 必有/ 证据/ (/ 3/ )/ 、/ (/ 4/ )/ ./ 所以/ 人物/ 角色/ 依赖于/ (/ 1/ )/ 、/ (/ 2/ )/ 和/ (/ 3/ )/ ,/ 证据/ (/ 4/ )/ 依赖于/ 人物/ 角色/ ./ 这些/ 特征/ 之间/ 可/ 认为/ 是/ 条件/ 独立/ 的/ ./ 根据/ 以上/ 分析/ ,/ 我们/ 设计/ 了/ 一个/ 贝叶斯/ 因果/ 网/ 模型/ 实例/ (/ 图/ 3/ )/ ./ 该/ 模型/ 拥有/ 5/ 个/ 节点/ ,/ 分别/ 用/ 5/ 个/ 大写/ 英文/ 字符/ 表示/ ,/ 每个/ 节点/ 相关/ 的/ 状态/ 用/ 相应/ 的/ 小写/ 字符/ 表示/ ,/ 如/ 节点/ T/ 拥有/ 状态/ {/ t1/ ,/ t2/ ,/ …/ }/ ,/ 这些/ 状态/ 总体/ 简单/ 表示/ 为/ 狋/ ;/ 节点/ S/ 拥有/ 状态/ {/ s1/ ,/ s2/ ,/ …/ }/ ,/ 这些/ 状态/ 总体/ 简单/ 表示/ 为/ 狊/ ./ 简单/ 概率/ 可/ 表示/ 为/ P/ (/ 狋/ )/ 、/ P/ (/ 狊/ )/ 、/ P/ (/ 犮/ )/ 和/ P/ (/ 犪/ )/ ,/ 条件/ 概率/ 可/ 表示/ 为/ P/ (/ 狉/ |/ 狋/ )/ 、/ P/ (/ 狉/ |/ 狊/ )/ 、/ P/ (/ 犮/ |/ 狉/ )/ 和/ P/ (/ 犪/ |/ 狉/ )/ ./ 其中/ ,/ P/ (/ 狋/ )/ 等/ 可以/ 表示/ 一个/ 成员/ 为/ P/ (/ ti/ )/ 的/ 概率/ 值/ 向量/ ,/ P/ (/ 狉/ |/ 狋/ )/ 可/ 被/ 描述/ 为/ 一个/ 以/ P/ (/ ri/ |/ tj/ )/ 为/ 元素/ 的/ 概率/ 值/ 矩阵/ ./ 设/ eX/ ,/ eY/ ,/ …/ 等/ 表示/ 从/ 多/ 摄像机/ 监控/ 视频/ 中/ 提取/ 出来/ 的/ X/ ,/ Y/ ,/ …/ 等/ 节点/ 的/ 证据/ ./ 这样/ 问题/ 就/ 可以/ 转化/ 为/ 求解/ P/ (/ 狉/ |/ eT/ ,/ S/ ,/ C/ ,/ A/ )/ ./ 从图/ 3/ 可知/ :/ 而/ 我们/ 有/ P/ (/ eC/ ,/ A/ |/ 狉/ )/ =/ P/ (/ eC/ ,/ eA/ |/ 狉/ )/ =/ P/ (/ eC/ |/ 狉/ )/ P/ (/ eA/ |/ 狉/ )/ 但是/ P/ (/ 狉/ |/ eT/ ,/ S/ )/ 则/ 要/ 复杂/ 得/ 多/ :/ P/ (/ 狉/ |/ eT/ ,/ S/ )/ =/ P/ (/ 狉/ |/ eT/ ,/ eS/ )/ 其中/ P/ (/ t1/ ,/ t2/ ,/ …/ ,/ s1/ ,/ s2/ ,/ …/ |/ eT/ ,/ eS/ )/ 可/ 进一步/ 求解/ :/ P/ (/ t1/ ,/ t2/ ,/ …/ ,/ s1/ ,/ s2/ ,/ …/ |/ eT/ ,/ eS/ )/ =/ ∏/ T/ 根据上述/ 的/ 式/ (/ 4/ )/ ~/ (/ 7/ )/ ,/ 我们/ 就/ 可以/ 求出/ P/ (/ 狉/ |/ eT/ ,/ S/ ,/ C/ ,/ A/ )/ ,/ 其/ 结果/ 最后/ 还/ 需要/ 归一化/ ./ 5/ 实验/ 结果/ 与/ 分析/ 本文/ 给出/ 的/ 实验/ 是/ 一个/ 大楼/ 清洁员/ 的/ 角色/ 识别/ ./ 下面/ 从/ 大楼/ 的/ 楼道/ 多/ 摄像机/ 监控/ 的/ 具体/ 应用/ 背/ Page7/ 景/ 出发/ ,/ 描述/ 一下/ 角色/ 识别/ 的/ 任务/ 和/ 需求/ :/ 因为/ 北京高校/ 老师/ 和/ 学生/ 防盗/ 意识/ 不/ 强/ ,/ 经常/ 发生/ 高校/ 内/ 笔记本电脑/ 或者/ 其它/ 物品/ 失窃/ 事件/ ./ 因此/ 在/ 大楼/ 室内/ 智能/ 视觉/ 监控/ 中/ ,/ 如何/ 实时/ 地/ 发现/ 可疑人物/ 和/ 事件/ ,/ 或者/ 事后/ 从/ 监控/ 录像/ 中/ 挖掘出/ 可疑人物/ 和/ 事件/ ,/ 是/ 一项/ 很大/ 的/ 挑战/ ,/ 这/ 将/ 大大/ 地/ 节约/ 人力/ 和/ 时间/ 成本/ ./ 要/ 达到/ 这样/ 的/ 目标/ ,/ 必须/ 首先/ 区分/ 可疑人物/ 和/ 安全/ 人物/ ./ 众所周知/ ,/ 楼道/ 清洁员/ 虽然/ 在/ 楼道/ 中/ 形迹可疑/ (/ 在/ 某些/ 时段/ 频繁/ 出现/ 、/ 可能/ 拿走/ 一些/ 物品/ 、/ 徘徊/ 在/ 实验室/ 门口/ 等/ )/ ,/ 但是/ 我们/ 在/ 监控/ 和/ 事后/ 挖掘/ 中/ 需要/ 把/ 他们/ 排除/ 掉/ ./ 图/ 4/ 实验/ 所用/ 视频/ 素材/ 5.1/ 特征/ 状态/ 上/ 文中/ 我们/ 已经/ 构建/ 了/ 一个/ 贝叶斯/ 因果/ 网/ ,/ 下面/ 给出/ 模型/ 中/ 节点/ 状态/ 的/ 设置/ ./ 节点/ R/ 表示/ 角色/ 的/ 种类/ ,/ 本文/ 中仅/ 进行/ 大楼/ 清洁员/ 的/ 识别/ ,/ 所以/ r1/ 代表/ 大楼/ 清洁员/ ,/ r2/ 代表/ 行人/ ./ 节点/ T/ 表示/ 活动/ 时间/ ,/ t1/ :/ [/ 0700/ ,/ 0800/ ]/ ,/ t2/ :/ [/ 0800/ ,/ 1800/ ]/ ,/ t3/ :/ [/ 1800/ -/ 1900/ ]/ ,/ t4/ :/ [/ 1900/ ,/ 0700/ ]/ ./ 节点/ S/ 表示/ 统计/ 特征/ ,/ s1/ :/ SLF/ / θ/ ,/ s2/ :/ SLF/ </ θ/ ./ 节点/ S/ 如表/ 2/ 所示/ ./ s1SLF/ / θ/ P/ (/ r1/ |/ s1/ )/ P/ (/ r1/ |/ s1/ )/ s2SLF/ </ θ/ P/ (/ r1/ |/ s2/ )/ P/ (/ r2/ |/ s2/ )/ 节点/ C/ 颜色/ 形状/ 特征/ ,/ c1/ :/ 穿/ 蓝色/ 衣服/ 的/ 人/ ,/ c2/ :/ 穿/ 其它/ 颜色/ 衣服/ 的/ 人/ ./ 节点/ C/ 如表/ 3/ 所示/ ./ 条件/ 穿/ 蓝色/ 衣服/ 的/ 人/ 穿/ 其它/ 颜色/ 衣服/ 的/ 人/ r1r2/ 节点/ A/ 表示/ 其它/ 特征/ ,/ a1/ :/ 场景/ 中/ 至少/ 有/ 一个/ 手推车/ 且/ 离/ 人物/ 较近/ ,/ a2/ :/ 场景/ 中/ 至少/ 有/ 一个/ 手推车/ 且/ 离/ 人物/ 较/ 远/ ,/ a3/ :/ 场景/ 中/ 没有/ 手推车/ ./ 节点/ A/ 如表/ 4/ 所示/ ./ 实验/ 使用/ 4/ 个/ D/ -/ Link/ 的/ DSC/ -/ 5300/ 型/ 无线网络/ 摄像头/ 参与/ 目标/ 定位/ ./ 实验/ 中/ 采用/ 标定/ 块/ 的/ 方法/ [/ 13/ ]/ 对/ 4/ 个/ 摄像头/ 内/ 参数/ 进行/ 了/ 分别/ 标定/ ./ 实验/ 中/ 所/ 使用/ 的/ 视频/ 分别/ 由/ 4/ 个/ 摄像机/ 分别/ 从/ 不同/ 的/ 视角/ 拍摄/ ,/ 时间跨度/ 约/ 为/ 5/ 天/ ./ 然而/ 这些/ 视频/ 中/ 的/ 很/ 大部分/ 没有/ 人/ 出现/ 在/ 场景/ 中/ ,/ 我们/ 随机/ 选取/ 了/ 44/ 个/ 视频/ 片段/ (/ 总共/ 约/ 113/ 人次/ 出现/ )/ ,/ 图/ 4/ 显示/ 了/ 一些/ 片段/ 的/ 截图/ )/ 来/ 进行/ 网络/ 学习/ 和/ 角色/ 识别/ ,/ 并且/ 将/ 识别/ 的/ 结果/ 与/ 手动/ 标注/ 的/ 真实/ 的/ 结果/ 进行/ 比较/ ./ 这/ 4/ 段/ 视频/ 分成/ 11/ 个组/ (/ #/ 1/ ~/ #/ 11/ )/ ,/ 每组/ 4/ 段/ 视频/ ,/ 分别/ 对应/ 4/ 个/ 摄像机/ 拍摄/ 的/ 内容/ ./ 条件/ 存在/ 手推车/ (/ 近/ )/ 存在/ 手推车/ (/ 远/ )/ 不/ 存在/ 手推车/ r1P/ (/ a1/ |/ r1/ )/ P/ (/ a2/ |/ r1/ )/ P/ (/ a3/ |/ r1/ )/ r2P/ (/ a1/ |/ r2/ )/ P/ (/ a2/ |/ r2/ )/ P/ (/ a3/ |/ r2/ )/ 表中/ “/ 远/ ”/ 和/ “/ 近/ ”/ 的/ 定义/ 如下/ :/ “/ 近/ ”/ :/ 某人/ 处于/ 视角/ 1/ 或/ 3/ (/ 分别/ 对应/ 摄像机/ 1/ 或/ 3/ )/ ,/ 同时/ 手推车/ 也/ 位于/ 视角/ 1/ 或/ 3/ ;/ 某人/ 处于/ 视角/ 2/ 或/ 4/ ,/ 同时/ 手推车/ 也/ 位于/ 视角/ 2/ 或/ 4/ ;/ “/ 远/ ”/ :/ 某人/ 处于/ 视角/ 2/ 或/ 4/ ,/ 但/ 手推车/ 位于/ 视角/ 1/ 或/ 3/ ;/ 某人/ 处于/ 视角/ 1/ 或/ 3/ ,/ 但/ 手推车/ 也/ 位于/ 视角/ 2/ 或/ 4/ ./ 具体/ 参数估计/ 的/ 结果/ 将/ 在/ 下面/ 讨论/ ./ 5.2/ 网络/ 参数估计/ 因果/ 网在/ 给定/ 一些/ 变量值/ 的/ 情况/ 下/ 是/ 最为/ 有效/ 的/ ,/ 而/ 其/ 网络/ 参数估计/ 是/ 得到/ 所有/ 变量/ 的/ 概率分布/ ,/ 如/ 各种/ 证据/ ./ 然而/ 在/ 本文/ 的/ 这种/ 情况/ 下/ ,/ 我们/ 首先/ 需要/ 得到/ 变量/ 的/ 条件/ 概率/ 表/ ./ 一般来说/ ,/ 条件/ 概率/ 的/ 分布/ 可以/ 从/ 数据分析/ 中/ 估计/ 得到/ ,/ 当然/ 某种/ 情况/ 下/ 也/ 可以/ 通过/ 问题/ 性质/ 的/ 分析/ 得到/ ./ 这里/ 我们/ 的/ 任务/ 是/ 在/ 一个/ 有/ 条件/ 的/ 参数/ 限制/ 下/ (/ 实验/ 中/ θ/ =/ 8/ )/ 进行/ 参数估计/ ,/ 并且/ 因果/ 网/ 的/ 网络结构/ 已知/ ./ 为了/ 完成/ 这个/ 任务/ ,/ 我们/ 使用/ 最大/ 似然/ 估计/ (/ 因为/ 本文/ 是/ 小/ 样本/ 训练/ )/ ./ 考虑/ 一个/ 由/ n/ 个/ 变量/ X/ =/ {/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ }/ 组成/ Page8/ 的/ 因果/ 网/ / ./ 不失/ 一般性/ ,/ 设/ 其中/ 节点/ Xi/ 共有/ ri/ 个/ 取值/ ,/ 其父/ 节点/ parent/ (/ Xi/ )/ 的/ 取值/ 共有/ qi/ 个/ 组合/ ./ 若/ Xi/ 无父/ 节点/ ,/ 则/ qi/ =/ 1/ ./ 那么/ 网络/ 参数/ 为/ / i/ ,/ j/ ,/ k/ =/ P/ (/ Xi/ =/ k/ )/ |/ parent/ (/ Xi/ )/ =/ j/ )/ ,/ 其中/ i/ 的/ 取值/ 范围/ 是/ 1/ ~/ n/ ,/ 而/ 对于/ 一个/ 固定/ 的/ i/ ,/ j/ ,/ k/ 的/ 取值/ 范围/ 分别/ 是从/ 1/ ~/ qi/ 和/ 1/ ~/ ri/ ./ 用/ / 表示/ 所有/ / i/ ,/ j/ ,/ k/ 组成/ 的/ 向量/ ./ 设/ / =/ (/ / ,/ / / )/ 表示/ 一个/ 因果/ 网/ ,/ 其中/ / 为/ 网络结构/ ./ 用/ P/ / (/ X/ )/ 表示/ / 的/ 联合/ 概率分布/ ./ 在/ / 中/ ,/ 把/ 参数/ 替换成/ 最大/ 似然/ 估计/ / / ,/ 得到/ 另/ 一个/ 贝叶斯/ 网/ / =/ (/ / ,/ / / )/ ,/ 将/ 其/ 联合/ 概率分布/ 记为/ P/ / (/ X/ )/ ./ 设/ 珚/ P/ (/ X/ )/ 是/ 基于/ 数据/ 组/ / 的/ 经验/ 分布/ ,/ 即/ 对/ X/ 的/ 任一/ 取值/ x/ ,/ 珚/ P/ (/ X/ )/ =/ / 中/ 满足/ X/ =/ x/ 的/ 样本/ 数目/ 据/ 文献/ [/ 16/ ]/ ,/ 当/ 珚/ P/ (/ parent/ (/ Xi/ )/ =/ j/ )/ >/ 0/ 时有/ / i/ ,/ j/ ,/ k/ =/ P/ / (/ Xi/ =/ k/ |/ parent/ (/ Xi/ )/ =/ j/ )/ =/ 由/ 公式/ (/ 8/ )/ ,/ 我们/ 就/ 可以/ 通过/ 小/ 样本/ 学习/ 得到/ 网络/ 参数/ ./ 实验/ 中/ 我们/ 使用/ 8/ 个组/ (/ #/ 4/ ~/ #/ 11/ ,/ 共有/ 54/ 人次/ )/ 来/ 进行/ 参数估计/ ./ 参数估计/ 的/ 结果/ 如图/ 5/ 所示/ ./ 图/ 5/ 使用/ 最大/ 似然/ 估计/ 的/ 网络/ 参数估计/ 结果/ 5.3/ 比较/ 与/ 分析/ 前/ 文中/ 我们/ 设置/ 了/ 参数/ ,/ 并/ 根据/ 参数/ 推导/ 出/ 了/ 每个/ 角色/ 的/ 概率/ ,/ 参数/ 的/ 取值/ 可以/ 通过/ 有/ 监督/ 的/ 学习/ 得到/ ./ 下面/ 比较/ 我们/ 的/ 方法/ 与/ 使用/ 时间/ 特征/ 、/ 统计/ 特征/ 、/ 颜色/ 形状/ 特征/ 或者/ 其它/ 特征/ 进行/ 角色/ 识别/ 的/ 识别率/ ./ 实验/ 中/ 使用/ t1/ 、/ t2/ 、/ t33/ 个/ 时段/ 的/ 3/ 份/ 样本/ 视频/ (/ #/ 1/ ,/ #/ 2/ ,/ #/ 3/ )/ 作为/ 测试/ 集/ ,/ t4/ 时段/ 大楼/ 监控/ 场景/ 中/ 人/ 很少/ ,/ 通常/ 很/ 长时间/ 都/ 见/ 不到/ 人/ 出现/ ,/ 所以/ 没有/ 考虑/ ./ 从图/ 6/ 、/ 图/ 7/ 比较/ 的/ 结果/ 可知/ 我们/ 的/ 方法/ 得到/ 了/ 最高/ 的/ 召回/ 率/ 和/ 准确率/ ,/ 这/ 说明/ 我们/ 算法/ 的/ 性能/ 相对/ 比较突出/ ./ 此外/ ,/ 本文/ 的/ 方法/ 即使/ 某些/ 特征/ 的/ 信息/ 缺失/ (/ 按/ 缺省值/ )/ ,/ 也/ 能/ 得出/ 一个/ 角色/ 识别/ 的/ 结果/ ,/ 避免/ 了/ 此种/ 情况/ 下/ 不能/ 识别/ 的/ 问题/ ./ 从图/ 6/ 知/ 我们/ 方法/ 的/ 召回/ 率/ 未/ 超过/ 80/ %/ ,/ 这/ 是因为/ 约/ 有/ 17.4/ %/ 人次/ 没有/ 被/ 系统/ 检测/ 到/ 或者/ 跟踪/ 到/ ./ 这是/ 由于/ 目标/ 检测/ 和/ 跟踪/ 精度/ 的/ 问题/ 所致/ ./ 6/ 总结/ 与/ 将来/ 的/ 工作/ 本文/ 提出/ 了/ 一种/ 使用/ 贝叶斯/ 因果/ 网来/ 进行/ 多/ 摄像机/ 监控/ 环境/ 下/ 的/ 人物/ 角色/ 识别/ 的/ 方法/ ./ 多/ 视角/ 将/ 有利于/ 移动/ 目标/ 的/ 定位/ 和/ 克服/ 遮挡/ ./ 而/ 在/ 因果/ 网/ 的/ 框架/ 下/ ,/ 本文/ 的/ 方法/ 可/ 适用/ 多/ 角色/ 识别/ ./ 然而/ ,/ 特征提取/ 的/ 误差/ 会/ 对/ 角色/ 识别/ 的/ 结果/ 造成/ 负面/ 的/ 影响/ ,/ 怎样/ 定量/ 的/ 分析/ 这种/ 影响/ 、/ 并且/ 进一步/ 的/ 克服/ 或/ 减小/ 这种/ 影响/ 还/ 需要/ 深入/ 的/ 研究/ ./ 此外/ ,/ 当/ 角色/ 的/ 种类/ 增加/ 时/ ,/ 如何/ 构建/ 可靠/ 的/ 因果/ 网/ 模型/ 也/ 是/ 我们/ 将来/ 的/ 工作/ ./ 

