Page1/ 基于/ 虚拟/ 图像/ 金字塔/ 序列/ 融合/ 的/ 快速/ 图像增强/ 算法/ 戴霞/ 1/ )/ 李辉/ 2/ )/ 杨红雨/ 2/ )/ 张军/ 3/ )/ 1/ )/ (/ 西华/ 大学/ 数学/ 与/ 计算机/ 学院/ 成都/ 610039/ )/ 2/ )/ (/ 四川大学/ 计算机/ 学院/ 图形图像/ 研究所/ 成都/ 610064/ )/ 3/ )/ (/ 上海交通大学/ 航空航天/ 学院/ 上海/ 200240/ )/ 摘要/ 针对/ 图像增强/ 算法/ 的/ 快速/ 计算/ 问题/ ,/ 文中/ 提出/ 一种/ “/ 全局/ 尝试/ 、/ 局部/ 精炼/ ”/ 的/ 图像增强/ 策略/ ,/ 利用/ 虚拟/ 图像/ 金字塔/ 序列/ 融合/ 方法/ 构建/ 出/ 一种/ 具有/ 高度/ 可扩展性/ 和/ 线性/ 时间/ 复杂度/ 的/ 图像增强/ 算法/ 框架/ ./ 在/ 此/ 框架/ 下/ ,/ 输入/ 图像/ 先/ 经过/ 各种/ 全局/ 增强/ 重/ 映射函数/ 的/ 处理/ 而/ 形成/ 备选/ 图像/ 序列/ ,/ 再/ 依据/ 像素/ 级保/ 边缘/ 图像/ 融合/ 规则/ 从/ 该/ 图像/ 序列/ 中/ 精选/ 出/ 有效/ 像素/ 信息/ ,/ 形成/ 最终/ 的/ 图像增强/ 结果/ ./ 为/ 避免/ 光环/ 效应/ ,/ 所有/ 图像/ 融合/ 计算/ 都/ 在/ 输入/ 图像/ 的/ 拉普拉斯/ 金字塔/ 分解/ 域/ 上/ 进行/ ./ 通过/ 对/ 局部/ 拉普拉斯/ 滤波/ 算法/ 进行/ 加速/ 的/ 实际/ 应用/ 表明/ ,/ 文中/ 提出/ 算法/ 框架/ 可/ 导出/ 一种/ 快速/ 保/ 边缘/ 图像增强/ 算法/ ,/ 其/ 处理/ 效果/ 与/ 原/ 局部/ 拉普拉斯/ 滤波/ 算法/ 极为/ 相似/ ,/ 但/ 计算速度/ 提高/ 了/ 两个/ 数量级/ ./ 关键词/ 保/ 边缘/ 图像处理/ ;/ 图像/ 金字塔/ ;/ 序列/ 图像/ 融合/ ;/ 函数/ 逼近/ 1/ 引言/ 图像增强/ 算法/ 是/ 信号/ 和/ 图像处理/ 领域/ 里/ 最/ 重要/ 的/ 研究课题/ 之一/ ,/ 在/ 实际/ 工程/ 中/ 具有/ 广泛/ 的/ 应用/ ./ 近年来/ ,/ 保/ 边缘/ 图像增强/ 算法/ 更/ 成为/ 了/ 许多/ 计算机/ 视觉/ 、/ 图像/ 理解/ 方法/ 的/ 基石/ ,/ 得到/ 广泛/ 关注/ ./ 包括/ 图像/ 动态/ 范围/ 压缩/ [/ 1/ -/ 4/ ]/ 、/ 图像/ 滤波/ [/ 5/ -/ 9/ ]/ 、/ 图像去噪/ [/ 10/ -/ 11/ ]/ 、/ 图像/ 风格化/ [/ 7/ ,/ 12/ -/ 18/ ]/ 、/ 视频/ 抽象/ [/ 19/ ]/ 、/ 图像/ 去/ 雾/ [/ 20/ -/ 21/ ]/ 、/ 数字/ 抠/ 图/ [/ 22/ ]/ 、/ 图像复原/ [/ 15/ ]/ 等/ 诸多/ 热点问题/ 都/ 将/ 受益/ 于/ 一个/ 稳健/ 、/ 高效/ 的/ 保/ 边缘/ 图像增强/ 算法/ ./ 双向/ 滤波器/ 算法/ [/ 23/ ]/ (/ BilateralFilter/ )/ 使用/ 空间/ 可变/ 的/ 加权/ 函数/ 在/ 高于/ 信号/ 维数/ 的/ 空间/ 对/ 信号/ 进行/ 加权/ 平均/ 处理/ ,/ 其/ 计算/ 过程/ 无需/ 迭代/ ,/ 滤波器/ 参数/ 意义/ 明显/ ,/ 具有/ 显著/ 的/ 保/ 边缘/ 特性/ ,/ 成为/ 了/ 保/ 边缘/ 图像增强/ 算法/ 设计/ 的/ 最/ 重要/ 思想/ 来源/ 之一/ ./ 然而/ ,/ 在/ Buades/ 等/ 人/ [/ 24/ ]/ 指出/ 双向/ 滤波器/ 可能/ 产生/ 伪/ 轮廓/ 的/ 缺点/ 后/ ,/ 各类/ 试图/ 改进/ 双向/ 滤波器/ 边界/ 响应/ [/ 13/ ,/ 25/ -/ 26/ ]/ 和/ 计算/ 效率/ [/ 16/ ,/ 27/ -/ 28/ ]/ 的/ 保/ 边缘/ 图像/ 滤波器/ 被/ 相继/ 提出/ ./ 由于/ 人眼/ 视觉/ 系统/ [/ 29/ ]/ 更/ 偏向/ 于/ 对/ 图像/ 梯度/ 的/ 响应/ ,/ 且/ 具有/ 较强/ 的/ 多/ 尺度/ 效应/ [/ 30/ ]/ ,/ 大量/ 在/ 梯度/ 域/ 设计/ 滤波器/ [/ 3/ ,/ 13/ -/ 14/ ]/ 并/ 采用/ 多/ 尺度/ 分解/ [/ 1/ -/ 2/ ,/ 12/ ,/ 15/ ,/ 31/ -/ 35/ ]/ 的/ 算法/ 在/ 近年来/ 大量/ 涌现/ ./ 另外/ ,/ 局部/ 直方图/ 变换/ [/ 36/ ]/ 、/ 全局/ 优化/ [/ 37/ ]/ 等/ 方法/ 也/ 取得/ 良好/ 的/ 保/ 边缘/ 图像增强/ 效果/ ./ 更加/ 详细/ 的/ 关于/ 保/ 边缘/ 图像增强/ 算法/ 的/ 研究/ 工作/ 回顾/ 可/ 参考文献/ [/ 13/ -/ 14/ ,/ 34/ ]/ ./ 图像/ 的/ 拉普拉斯/ 金字塔/ 变换/ [/ 38/ ]/ 已经/ 为/ 广大/ 工程/ 人员/ 所/ 熟知/ ,/ 其/ 计算/ 过程/ 仅/ 涉及/ 已经/ 存在/ 大量/ 程序库/ 的/ 图像/ 缩放/ 操作/ ,/ 是/ 图像增强/ 算法/ 领域/ 里/ 非常/ 优秀/ 的/ 变换/ 工具/ 之一/ ./ Dippel/ 等/ 人/ [/ 31/ ]/ 认为/ 拉普拉斯/ 金字塔/ 变换/ 比小波/ 变换/ 更加/ 适合/ 大/ 尺度/ 图像/ 结构/ 的/ 增强/ ./ 而/ Paris/ 等/ 人/ [/ 39/ ]/ 的/ 工作/ 也/ 打破/ 了/ 前人/ 对/ 拉普拉斯/ 金字塔/ 图像处理/ 会/ 产生/ 光环/ 现象/ 的/ 一贯/ 认识/ [/ 2/ ,/ 34/ ]/ ,/ 取得/ 了/ 良好/ 的/ 保/ 边缘/ 图像/ 滤波/ 效果/ ./ 这些/ 因素/ 使/ 本文/ 作者/ 坚信/ ,/ 基于/ 拉普拉斯/ 金字塔/ 变换/ 的/ 图像/ 滤波器/ 设计/ 具有/ 达到/ Bhat/ 等/ 人/ [/ 14/ ]/ 对/ 滤波器/ 设计/ 要求/ 的/ 潜力/ ./ 然而/ ,/ Paris/ 等/ 人/ 提出/ 的/ 局部/ 拉普拉斯/ 滤波器/ (/ LocalLaplacianFilter/ ,/ LLF/ )/ 算法/ 的/ 时间/ 复杂度/ 是/ 非线性/ 的/ O/ (/ NlogN/ )/ ,/ 其/ 对/ 高分辨率/ 图像/ 的/ 处理速度/ 远远/ 低于/ 那些/ 具有/ 线性/ 时间/ 复杂度/ 的/ 保/ 边缘/ 图像增强/ 算法/ [/ 13/ ]/ ,/ 无法/ 满足/ Bhat/ 等/ 人/ 对/ 滤波器/ 设计/ 的/ 计算速度/ 要求/ ./ 同时/ ,/ Paris/ 等/ 人/ 提出/ 的/ LLF/ 算法/ 仅/ 针对/ 单幅/ 图像/ ,/ 其/ 对/ 不同/ 应用/ 问题/ 的/ 适应性/ 只能/ 通/ 目前/ ,/ 已有/ 多种/ 算法/ 潜在/ 的/ 应用/ 了/ “/ 全局/ 尝试/ 、/ 过/ 调节/ 重/ 映射函数/ 来/ 实现/ ,/ 可扩展性/ 较/ 低/ ./ 本文/ 提出/ 一种/ “/ 全局/ 尝试/ 、/ 局部/ 精炼/ ”/ 的/ 图像增强/ 策略/ ,/ 建立/ 完全/ 满足/ Bhat/ 等/ 人/ 对/ 滤波器/ 设计/ 要求/ 的/ 基于/ 虚拟/ 图像/ 金塔/ 子/ 序列/ (/ VirtualImagePyramidSequence/ ,/ VIPS/ )/ 融合/ 的/ 图像增强/ 算法/ 框架/ ./ 在/ 该/ 框架/ 下/ ,/ 本文/ 通过/ 对/ LLF/ 算法/ 中重/ 映射函数/ 的/ 低维/ 线性化/ 逼近/ ,/ 成功/ 构建/ 出/ 一种/ LLF/ 算法/ 的/ 快速/ 近似算法/ ./ 该/ 算法/ 可/ 在/ 线性/ 时间/ 复杂度/ O/ (/ N/ )/ 内/ 产生/ 与/ 原/ LLF/ 算法/ 极为/ 接近/ 的/ 结果/ ,/ 大大提高/ 其/ 计算速度/ 的/ 竞争力/ ./ 1.1/ 相关/ 工作/ 局部/ 精选/ ”/ 的/ 策略/ ./ Fattal/ 等/ 人/ [/ 33/ ]/ 提出/ 基于/ 多幅/ 不同/ 光照/ 条件/ 下/ 成像/ 的/ 图像/ 序列/ 进行/ 图像/ 细节/ 增强/ 的/ 方法/ ./ 该/ 方法/ 引入/ 固定/ 视角/ 下/ 同一/ 场景/ 在/ 不同/ 方向/ 光源/ 照射/ 下/ 成像/ 的/ 一组/ 图像/ 序列/ 作为/ 输入/ 条件/ ,/ 通过/ 双向/ 滤波器/ 对/ 图像/ 序列/ 进行/ 多/ 尺度/ 分解/ ,/ 并/ 将/ 图像/ 序列/ 里/ 分解/ 后/ 的/ 显著/ 细节/ 特征/ 系数/ 重/ 组成/ 输出/ 图像/ 的/ 多/ 分辨/ 金字塔/ ,/ 最后/ 从/ 该/ 图像/ 金字塔/ 中/ 重建/ 出/ 最终/ 的/ 输出/ 图像/ ./ 不同/ 光源/ 下/ 成像/ 的/ 图像/ 序列/ 对应/ 于/ 对/ 场景/ 图像/ 进行/ 的/ 一系列/ 全局/ 变换/ ,/ 多/ 尺度/ 分解/ 后/ 的/ 图像/ 细节/ 提取/ 相当于/ 对/ 图像/ 序列/ 的/ 局部/ 自/ 适应/ 精选/ ./ 由于/ 其/ 算法/ 采用/ 原始/ 双向/ 滤波/ 算法/ 作为/ 图像/ 多/ 尺度/ 分解/ 的/ 工具/ ,/ 其/ 计算/ 时间/ 复杂度/ 为/ O/ (/ N2logN/ )/ ,/ 计算/ 效率/ 不具/ 优势/ ./ 为/ 提高/ 图像增强/ 算法/ 的/ 计算/ 效率/ 和/ 鲁棒性/ ,/ Fattal/ 等/ 人/ [/ 15/ ]/ 提出/ 一种/ 基于/ 数据/ 降维/ 思想/ 的/ 图像/ 低维/ 线性/ 逼近/ 方法/ ./ 该/ 方法/ 通过/ 双向/ 滤波器/ 和/ 数据/ 聚类/ 运算/ ,/ 在/ 多个/ 尺度空间/ 上/ 建立/ 原始/ 输入/ 图像/ 的/ 近似/ 逼近/ 图像/ 序列/ ./ 将/ 输入/ 图像/ 向/ 由/ 该/ 基/ 图像/ 序列/ 张成/ 的/ 低维/ 线性/ 子/ 空间/ 投影/ 后/ ,/ 可/ 得到/ 对/ 输入/ 图像/ 的/ 一个/ 具有/ 较/ 高精度/ 的/ 低维/ 逼近/ ./ 这样/ ,/ 当/ 其它/ 图像增强/ 算法/ 通过/ 作用/ 在/ 这些/ 基/ 图像/ 上/ 而/ 达到/ 间接/ 增强/ 原始/ 输入/ 图像/ 的/ 效果/ 时/ ,/ 可/ 得到/ 更/ 高/ 的/ 计算/ 效率/ 和/ 保/ 边缘/ 特性/ ./ 然而/ ,/ 该/ 方法/ 对/ 输入/ 图像/ 的/ 低维/ 线性/ 逼近/ 自身/ 涉及/ 求解/ 一个/ 大型/ 稀疏/ 线性方程组/ ,/ 其/ 对/ 图像增强/ 算法/ 的/ 计算/ 效率/ 提升/ 空间/ 有限/ ./ Wu/ [/ 25/ ]/ 提出/ 利用/ 线性规划/ 对/ 图像/ 对比度/ 进行/ 增强/ 的/ 方法/ ,/ 将/ 图像/ 对比度/ 增益/ 和/ 色调/ 保持/ 度/ 作为/ 目标/ 函数/ ,/ 在/ 像素/ 值/ 改变/ 区间/ 限制/ 的/ 约束条件/ 下/ 形成/ 线性规划/ 问题/ ,/ 使用/ 单纯形/ 算法/ 进行/ 求解/ ./ 线性规划/ 问题/ 的/ 可行/ 域/ 是/ 凸集/ ,/ 单纯形/ 求解/ 策略/ 本质/ 上/ 是/ 穷举/ 该/ 凸集/ 的/ 所有/ 角点/ 来/ 找到/ 最优/ 解/ ./ 基于/ 此/ 分析/ ,/ Page3Wu/ 的/ 方法/ 中/ 所/ 涉及/ 线性规划/ 的/ 基础/ 可行/ 解可/ 被/ 视为/ 待选/ 的/ 虚拟/ 对比度/ 增强/ 图像/ 序列/ ,/ 其/ 最终/ 图像增强/ 结果/ 是从/ 该/ 图像/ 序列/ 中/ 精炼/ 出来/ 的/ ./ 从/ 这个/ 意义/ 上/ 说/ ,/ Wu/ 的/ 方法/ 是/ 隐式/ 的/ 使用/ 了/ “/ 全局/ 尝试/ 、/ 局部/ 精选/ ”/ 的/ 策略/ ./ Sunkavalli/ 等/ 人/ [/ 12/ ]/ 针对/ 图像/ 混合/ 问题/ 提出/ 了/ 多/ 尺度/ 图像/ 调和/ 方法/ ,/ 将/ 待/ 混合/ 的/ 两幅/ 输入/ 图像/ 同步/ 的/ 进行/ 多/ 分辨率/ 分解/ ,/ 形成/ 两个/ 待/ 混合/ 候选/ 图像/ 序列/ ./ 图像/ 混合/ 是/ 通过/ 灰度/ 直方图/ 匹配/ 的/ 形式/ 从/ 候选/ 图像/ 序列/ 中/ 挑选/ 出来/ 的/ 混合/ 图像/ 序列/ ,/ 通过/ 求解/ 一个/ 大型/ 稀疏/ 线性方程组/ ,/ 该/ 混合/ 图像/ 序列/ 可以/ 重建/ 为/ 最终/ 两幅/ 输入/ 图像/ 的/ 混合/ 结果/ ./ 从/ 实验/ 结果/ 上/ ,/ 该/ 方法/ 在/ 较/ 少/ 人为/ 干预/ 条件/ 下/ 取得/ 了/ 较为/ 优秀/ 的/ 混合/ 视觉效果/ ./ Yang/ 等/ 人/ [/ 28/ ]/ 利用/ 支持/ 向量/ 机/ 原理/ 给出/ 了/ 一个/ 双向/ 滤波器/ 的/ 加速/ 算法/ ./ 该/ 方法/ 将/ 图像/ 滤波/ 算法/ 表述/ 为/ 向量/ 映射/ 的/ 线性/ 逼近/ 过程/ ,/ 即/ 滤波/ 后/ 的/ 图像/ 向量/ 是/ 由/ 输入/ 图像/ 自身/ 及其/ 幂次/ 向量/ 和/ 经由/ 高斯/ 低/ 通滤波/ 后/ 的/ 输入/ 图像/ 及其/ 幂次/ 所/ 组成/ 的/ 向量/ 组/ 的/ 线性组合/ ./ 支持/ 向量/ 机/ 的/ 引入/ 是/ 为了/ 从/ 图像/ 训练/ 库中/ 学习/ 出/ 一组/ 合适/ 的/ 线性组合/ 系数/ ,/ 用于/ 拟合/ 双向/ 滤波器/ 的/ 输出/ 效果/ ./ 该/ 方法/ 本质/ 上/ 是/ 对/ 图像/ 进行/ 了/ 一系列/ 全局/ 映射/ (/ 自身/ 幂次/ 及/ 自身/ 幂次/ 的/ 低/ 通滤波/ 输出/ )/ 而/ 形成/ 一个/ 基/ 图像/ 序列/ ,/ 算法/ 输出/ 结果/ 是/ 这个/ 基/ 图像/ 序列/ 的/ 局部/ 融合/ 的/ 结果/ ./ 由于/ 该/ 方法/ 的/ 局部/ 融合/ 准则/ 是/ 由/ 机器/ 学习/ 过程/ 建立/ 的/ ,/ 其/ 图像增强/ 效果/ 较为/ 依赖/ 训练/ 集/ 的/ 质量/ ./ Paris/ 等/ 人/ [/ 39/ ]/ 提出/ 的/ LLF/ 算法/ 同样/ 隐式/ 的/ 使用/ 了/ “/ 全局/ 尝试/ 、/ 局部/ 精选/ ”/ 的/ 策略/ ./ 在/ 确定/ 每个/ 输出/ 图像/ 拉普拉斯/ 金字塔/ 系数/ 时/ ,/ 该/ 方法/ 都/ 对/ 原/ 输入/ 图像/ 进行/ 一次/ 全局/ 映射/ ./ 由于/ 这个/ 过程/ 形成/ 了/ 数量/ 可观/ 的/ 备选/ 图像/ 序列/ ,/ 原始/ LLF/ 算法/ 具有/ O/ (/ N2/ )/ 时间/ 复杂度/ ./ 虽然/ Paris/ 等/ 人/ 通过/ 减小/ 每次/ 全局/ 映射/ 运算/ 时所/ 涉及/ 的/ 图像/ 区域/ 而/ 提高/ 计算/ 效率/ ,/ 其/ 改进/ 后/ 的/ LLF/ 算法/ 时间/ 复杂度/ 仍为/ O/ (/ NlogN/ )/ ,/ 并/ 不/ 具有/ 计算/ 效率/ 优势/ ./ Aubry/ 等/ 人/ ①/ 提出/ 利用/ 亚/ 采样/ 技术/ 加速/ LLF/ 方法/ ,/ 其/ 计算/ 方式/ 与/ 本文/ 提出/ 的/ 图像/ 算法/ 框架/ 较为/ 接近/ ,/ 且/ 有/ 相同/ 的/ 计算/ 性能/ ./ 该/ 方法/ 通过/ 对/ 映射函数/ 的/ 亚/ 采样/ 来/ 逼近/ 原始/ LLF/ ,/ 可/ 视为/ 本文/ 提出/ 的/ 图像增强/ 算法/ 框架/ 下/ 的/ 一个/ 具体/ 实现/ ./ 本文/ 提出/ 的/ 快速/ 图像增强/ 算法/ 框架/ 显式/ 地/ 使用/ “/ 全局/ 尝试/ 、/ 局部/ 精选/ ”/ 策略/ ,/ 使/ 在/ 此/ 框架/ 下/ 构造/ 出/ 的/ 图像增强/ 算法/ 具有/ 线性/ 时间/ 复杂度/ O/ (/ N/ )/ ,/ 并且/ 具有/ 简单/ 、/ 易于/ 编程/ 、/ 无/ 人工/ 痕迹/ 的/ 优势/ ./ 2/ 基于/ VIPS/ 融合/ 的/ 图像增强/ 算法/ 图像增强/ 算法/ 通过/ 特定/ 方式/ 调整/ 图像/ 中/ 每个/ 像素/ 的/ 像素/ 值/ ,/ 并/ 尽量/ 使/ 调整/ 后/ 的/ 图像/ 具有/ 较少/ 的/ 人工/ 痕迹/ ./ 本节/ 利用/ “/ 全局/ 尝试/ 、/ 局部/ 精选/ ”/ 策略/ 在/ 金字塔/ 图像/ 变换/ 的/ 基础/ 上/ ,/ 提出/ 一种/ 具有/ 线性/ 时间/ 复杂度/ 的/ 快速/ 图像增强/ 算法/ 框架/ ./ 2.1/ 原始/ 局部/ 拉普拉斯/ 滤波/ 算法/ Paris/ 等/ 人/ [/ 39/ ]/ 提出/ 的/ 局部/ 拉普拉斯/ 滤波/ 算法/ 根据/ 每个/ 像素/ 位置/ 自身/ 的/ 像素/ 值/ 信息/ 对/ 输入/ 图像/ 的/ 一个/ 局部/ 领域/ 进行/ 变换/ ,/ 并/ 将/ 变换/ 结果/ 以/ 拉普拉斯/ 金字塔/ 系数/ 的/ 形式/ 保存/ ./ 最终/ 的/ 输出/ 图像增强/ 结果/ 是/ 由/ 这些/ 已经/ 被/ 计算/ 出/ 的/ 多/ 尺度/ 分解/ 系数/ 进行/ 重建/ ./ 本质/ 上/ ,/ 局部/ 拉普拉斯/ 滤波/ 算法/ 是/ 一个/ 在/ 频率/ 域/ 进行/ 逐点/ 局部/ 变换/ 的/ 图像/ 滤波/ 算法/ ./ 虽然/ 原始/ LLF/ 算法/ 流程/ 简单/ ,/ 易于/ 编程/ 实现/ ,/ 但/ 其/ 对/ 输出/ 图像/ 拉普拉斯/ 金字塔/ 中/ 每个/ 系数/ 的/ 计算/ 都/ 需要/ 对原/ 图像/ 进行/ 一次/ 非线性/ 映射/ 和/ 金字塔/ 分解/ 运算/ ,/ 其/ 计算速度/ 并/ 不/ 具有/ 优势/ ,/ 且/ 存在/ 大量/ 冗余/ 计算/ ./ 在/ 原始/ LLF/ 算法/ 中/ ,/ 输出/ 图像/ 拉普拉斯/ 金字塔/ {/ Ll/ }/ nl/ =/ 0/ 的/ 第/ l/ 层/ 、/ (/ u/ ,/ v/ )/ 处/ 的/ 系/ 数值/ Ll/ (/ u/ ,/ v/ )/ 是/ 根据/ 输入/ 图像/ 犐/ 的/ 高斯/ 金字塔/ 相应/ 位置/ 系/ 数值/ 对原/ 图像/ 犐/ 进行/ 点/ 变换/ 后/ ,/ 再/ 重新/ 进行/ 拉普拉斯/ 金字塔/ 分解/ 后/ 的/ 新/ 金字塔/ 相应/ 位置/ 的/ 系/ 数值/ :/ Ll/ (/ u/ ,/ v/ )/ =/ [/ Ll/ (/ f/ (/ 犐/ ;/ Gl/ (/ u/ ,/ v/ )/ )/ )/ ]/ (/ u/ ,/ v/ )/ (/ 1/ )/ 其中/ f/ 是/ Paris/ 设计/ 的/ 根据/ 图像/ 高斯/ 金字塔/ 相应/ 位置/ 系数/ Gl/ (/ u/ ,/ v/ )/ 和/ 阈值/ σ/ f/ >/ 0/ 对/ 图像/ 边界/ 和/ 细节/ 有/ 不同/ 相应/ 的/ 点/ 变换/ 函数/ :/ 其中/ ,/ rd/ (/ x/ )/ 和/ re/ (/ x/ )/ 分别/ 为/ 细节/ 映射函数/ 和/ 边缘/ 映射函数/ :/ rd/ (/ x/ ;/ θ/ )/ =/ θ/ +/ sign/ (/ x/ -/ θ/ )/ σ/ f/ (/ |/ x/ -/ θ/ |/ // σ/ f/ )/ α/ ,/ re/ (/ x/ ;/ θ/ )/ =/ θ/ +/ sign/ (/ x/ -/ θ/ )/ [/ β/ (/ |/ x/ -/ θ/ |/ -/ σ/ f/ )/ +/ σ/ f/ ]/ (/ 3/ )/ 由式/ (/ 2/ )/ 、/ (/ 3/ )/ 可以/ 看到/ ,/ 点/ 变换/ 函数/ f/ 本质/ 上/ 是/ 一个/ 带有/ 可调/ 参数/ θ/ 的/ 非线性/ 函数/ ,/ 其/ 内部/ 固定/ ①/ AubryM/ ,/ ParisS/ ,/ HasinoffSW/ ,/ etal/ ./ FastandRobustPage4/ 参数/ 组/ (/ σ/ f/ ,/ α/ ,/ β/ )/ 可以/ 根据/ 不同/ 领域/ 对/ 图像增强/ 效果/ 的/ 差异/ 进行/ 人为/ 制定/ ./ Paris/ 将/ 函数/ 的/ 可调/ 参数设置/ 成/ θ/ =/ Gl/ (/ u/ ,/ v/ )/ ,/ 使该/ 方法/ 具有/ 极强/ 的/ 局部/ 特性/ :/ 每个/ 输出/ 图像/ 拉普拉斯/ 金字塔/ {/ Ll/ }/ n/ (/ u/ ,/ v/ )/ 处/ 的/ 系/ 数值/ 都/ 是/ 根据/ 该/ 位置/ 自身/ 高斯/ 金字塔/ 系/ 数值/ 而/ 对/ 图像/ 犐/ 进行/ 全局/ 变换/ 得到/ 的/ ./ 2.2/ VIPS/ 融合/ 的/ 理论/ 描述/ 方程/ (/ 1/ )/ 的/ 计算/ 复杂度/ 主要/ 来源于/ 非线性/ 局部/ 映射函数/ f/ (/ x/ ;/ θ/ )/ 中/ 参数/ θ/ 的/ 取值/ 与/ 局部/ 图像/ 信息/ 相关/ ,/ 造成/ 每个/ 像素/ 位置/ 的/ 计算/ 都/ 需要/ 重新/ 计算/ 图像/ 金字塔/ ./ 考虑/ 到/ 数字图像/ 的/ 像素/ 值/ 总是/ 在/ 有限/ 的/ 数集/ 上/ ,/ 可调/ 参数/ θ/ 值/ 一般/ 分布/ 在/ 一维/ 有限/ 区间/ (/ 对/ Lum/ 进行/ 增强/ )/ 或/ 有限/ 体积/ (/ 对/ RGB/ 分量/ 进行/ 增强/ )/ 上/ ./ 这使/ 寻找/ 若干/ 全局/ 映射函数/ 的/ 局部/ 线性组合/ 来/ 近似/ 非线性/ 局部/ 映射函数/ f/ (/ x/ ;/ θ/ )/ 成为/ 可能/ ./ 令/ f/ (/ x/ ;/ θ/ )/ ≈/ ∑/ KLl/ (/ u/ ,/ v/ )/ =/ [/ Ll/ (/ f/ (/ 犐/ ;/ Gl/ (/ u/ ,/ v/ )/ )/ )/ ]/ (/ u/ ,/ v/ )/ 写成/ :/ 利用/ 金字塔/ 图像/ 变换/ 的/ 线性/ 特性/ ,/ 方程/ (/ 4/ )/ 可/ 看成/ 对/ 虚拟/ 序列/ 图像/ {/ 犐/ k/ =/ fk/ (/ 犐/ )/ }/ K/ 拉斯/ 金字塔/ 分解/ 的/ 图像/ 融合/ 算法/ :/ 其中/ 融合/ 系数/ wk/ 是/ 关于/ 图像/ 高斯/ 金字塔/ 分解/ 的/ 函数/ ,/ 可/ 视为/ 最优/ 融合/ 准则/ :/ 对于/ 序列/ 图像/ ,/ 可以/ 使用/ 更加/ 一般/ 的/ 最优/ 融合/ 准则/ ,/ 通过/ 综合/ 序列/ 图像/ 的/ 高斯/ 金字塔/ 分解/ 系数/ 计算/ 最优/ 融合/ 准则/ :/ 2.3/ 基于/ VIPS/ 融合/ 的/ 图像增强/ 算法/ 方程/ (/ 5/ )/ 、/ (/ 7/ )/ 共同/ 决定/ 的/ 图像/ 融合/ 算法/ 是/ 一种/ 具有/ 一般性/ 的/ 基于/ 虚拟/ 金字塔/ 序列/ 融合/ (/ VIPS/ )/ 的/ 快速/ 图像增强/ 算法/ 框架/ ,/ 可/ 适应/ 单幅/ 或/ 序列/ 图像增强/ 问题/ ,/ 可/ 嵌入/ 不同/ 的/ 虚拟/ 再/ 映射函数/ 和/ 图像/ 融合/ 准则/ ,/ 且/ 具有/ 线性/ 时间/ 复杂度/ 的/ 高效/ 计算/ 过程/ ,/ 具有/ 更好/ 的/ 可扩展性/ 和/ 更/ 高/ 的/ 计算/ 效率/ ./ 本文/ 提出/ 的/ 具有/ O/ (/ N/ )/ 时间/ 复杂度/ 的/ 图像增强/ 框架/ 的/ 详细描述/ 如下/ ./ 算法/ 1/ ./ 基于/ VIPS/ 算法/ 的/ 图像增强/ 框架/ ./ 输入/ :/ 图像/ 犐/ 和/ 重/ 映射函数/ fk/ (/ x/ )/ (/ 或者/ 图像/ 序列/ 输出/ :/ 图像增强/ 结果/ 犐/ 步骤/ :/ if/ (/ 单幅/ 图像/ I/ )/ endiffork/ =/ 0/ :/ Kendforforall/ (/ k/ ,/ l/ )/ endfor3/ 应用/ 实例/ 本节/ 从/ 原始/ LLF/ 算法/ 中/ 非线性/ 映射函数/ 的/ 分段/ 线性/ 逼近/ 入手/ ,/ 给出/ 本文/ 提出/ 的/ 基于/ VIPS/ 的/ 快速/ 图像增强/ 算法/ 框架/ 对/ 原始/ LLF/ 算法/ 的/ 具体/ 应用/ ,/ 形成/ 一个/ 原始/ LLF/ 算法/ 的/ 快速/ 近似算法/ ./ 该/ 算法/ 与/ Aubry/ 等/ 人/ 利用/ 亚/ 采样/ 技术/ 加速/ LLF/ 方法/ 本质/ 上/ 是/ 一致/ 的/ ,/ 但/ 具有/ 更加/ 清晰/ 的/ 算法/ 流程/ 和/ 更好/ 的/ 可扩展性/ (/ 可/ 选择/ 更/ 多/ 种类/ 的/ 数值/ 逼近/ 函数/ )/ ./ 设/ 输入/ 图像/ 犐/ 的/ 高斯/ 金字塔/ 分解/ {/ Gl/ }/ n/ 有/ 系数/ 的/ 最大/ 、/ 最小值/ 分别/ 为/ θ/ min/ 和/ θ/ max/ ,/ 则/ 固定/ 一个/ 离散/ 采样/ 个数/ K/ 后/ ,/ 对/ θ/ 是/ 一维/ 变量/ 的/ 情况/ 可/ 形成/ 含有/ K/ 个/ 非线性/ 全局/ 变换/ 函数/ 的/ 一维/ 序列/ :/ 条件/ 连续/ 的/ ,/ 即/ / δ/ >/ 0/ 使得/ 由于/ f/ (/ x/ ;/ θ/ )/ 对于/ 可调/ 参数/ θ/ 是/ 满足/ 李普希/ 兹/ ∫/ b/ 则/ 函数/ 序列/ {/ fk/ (/ x/ )/ }/ Kf/ (/ x/ ;/ θ/ )/ 的/ ,/ 故/ 融合/ 准则/ 为/ Page5wk/ =/ opt/ (/ Gl/ (/ 犐/ 0/ )/ ,/ Gl/ (/ 犐/ 1/ )/ …/ Gl/ (/ 犐/ K/ )/ )/ 烄/ =/ 烅/ 烆/ 且/ 当/ K/ →/ 时/ ,/ ∑/ K/ 对/ RGB/ 分量/ 进行/ 增强/ 的/ 情况/ 将/ 使/ θ/ 成为/ 三维/ 变量/ ,/ 即/ θ/ =/ (/ θ/ R/ ,/ θ/ G/ ,/ θ/ B/ )/ T/ ./ 对/ θ/ 离散/ 化将/ 在/ 3/ 个/ 分量/ 上/ 同时/ 进行/ ,/ 形成/ 含有/ K3/ 个/ 非线性/ 函数/ 族/ 的/ 三维/ 阵列/ ./ 对/ 快速/ LLF/ 计算/ 过程/ 的/ 直观/ 表述/ 见图/ 1/ ,/ 输入/ 图像/ 经过/ 所有/ 可能/ 的/ 全局/ 变换/ (/ 由/ 离散/ 化/ 采样/ 的/ 参数/ θ/ 控制/ )/ 形成/ 一个/ 虚拟/ 图像/ 备选/ 序列/ ,/ 再/ 对/ 该/ 序列/ 的/ 每/ 一帧/ 图像/ 进行/ 拉普拉斯/ 金字塔/ 分解/ ,/ 并/ 根据/ 源/ 图像/ 的/ 高斯/ 金字塔/ 分解/ 系数/ 从/ 序列/ 图像/ 的/ 拉普拉斯/ 金字塔/ 分解/ 系数/ 集合/ 中/ 逐个/ 像素/ 地/ 提取/ 有效/ 信息/ ,/ 从而/ 得到/ 输出/ 图像/ 的/ 拉普拉斯/ 金字塔/ 分解/ 系数/ ./ 这个/ 过程/ 是/ 显式/ 的/ 采用/ “/ 全局/ 变换/ ,/ 局部/ 精选/ ”/ 的/ 策略/ ,/ 以/ 牺牲/ 存储空间/ 为/ 代价/ ,/ 换取/ 计算/ 过程/ 的/ 高度/ 并行/ 化/ 和/ 时间/ 复杂度/ 的/ 线性化/ ./ 4/ 计算结果/ 及/ 讨论/ 本/ 节/ 给出/ 对/ 快速/ LLF/ 算法/ 性能/ 测试/ 的/ 若干/ 实验/ 来/ 证明/ 在/ 本文/ VIPS/ 融合/ 算法/ 框架/ 下/ 的/ 快速/ LLF/ 算法/ 可以/ 产生/ 与/ 原始/ LLF/ 算法/ 极为/ 贴近/ 的/ 图像增强/ 效果/ ,/ 但/ 其/ 计算/ 效率/ 被/ 显著/ 提高/ ./ 4.1/ 实验/ 环境/ 所有/ 实验/ 结果/ 都/ 在/ 一个/ 搭载/ 有/ 2.4/ GHzAMDPhenomCPU/ 的/ PC/ 平台/ 上/ 得到/ ,/ 实验/ 编程/ 环境/ 为/ Matlab2011b/ ,/ 前人/ 算法/ 的/ 程序代码/ 皆/ 为/ 相关/ 作者/ 公布/ 的/ 实验/ 测试程序/ ./ 性能/ 测试/ 时/ 运行/ 时间/ 统计/ 采用/ tic/ // toc/ 命令/ 自动/ 计时/ ,/ 其/ 精度/ 为/ 毫秒/ 级/ ./ 4.2/ 快速/ LLF/ 算法/ 对/ 原始/ LLF/ 滤波器/ 逼近/ 度/ 的/ 检验/ 快速/ LLF/ 算法/ 对/ 原始/ LLF/ 滤波器/ 线性化/ 逼近/ ,/ 其/ 逼近/ 程度/ 受到/ 采样/ 点/ 个数/ K/ 和/ 重/ 映射函数/ 复杂程度/ 共同/ 影响/ ./ 本/ 小节/ 用/ 对/ 图像/ 细节/ 调整/ 的/ 实验/ 测试/ 快速/ LLF/ 算法/ 对/ 原始/ LLF/ 算法/ 的/ 逼近/ 程度/ ,/ 并/ 给出/ 逼近/ 度/ 与/ 计算/ 性能/ 之间/ 关系/ 的/ 实验/ ./ 4.2/ ./ 1/ 细节/ 调整/ 对/ 两个/ 常见/ 实验/ 输入/ 图像/ (/ 图/ 2/ )/ ,/ 图/ 3/ 、/ 图/ 4/ 和/ 图/ 5/ 给出/ 了/ 在/ 不同/ 重/ 映射/ 方式/ 和/ 彩色图像/ 处理/ 方式/ 下/ 快速/ LLF/ 对/ 原始/ LLF/ 算法/ 的/ 逼近/ 程度/ ,/ 并/ 对/ 采样/ 点/ 个数/ 、/ 重/ 映射函数/ 非线性/ 程度/ 对/ 逼近/ 误差/ 和/ 计算/ 性能/ 的/ 映像/ 做/ 了/ 对比/ 分析/ ./ 在/ 图/ 3/ 中/ ,/ Lum/ 标记/ 表示/ 图像增强/ 处理/ 是/ 在/ 亮度/ 单通道/ 下/ 进行/ 的/ ,/ 其/ 快速/ LLF/ 算法/ 是/ 对/ 一维/ 区间/ 的/ 离散/ 化/ 采样/ (/ 8/ )/ ,/ 采样/ 点/ 个数/ 为/ K/ =/ 64/ ;/ RGB/ 标记/ 表示/ 图像增强/ 处理/ 是/ 在/ RGB/ 三/ 通道/ 下/ 进行/ 的/ ,/ 其/ 快速/ LLF/ 算法/ 是/ 对/ 三维/ 区域/ 的/ 离散/ 化/ 采样/ ,/ 采样/ 点/ 个数/ 为/ K3/ =/ 512/ ./ α/ 表示/ 式/ (/ 3/ )/ 的/ 指数/ ,/ 其值/ 偏离/ 1/ 的/ 程度/ 与/ 重/ 映射函数/ 的/ 非线性/ 度/ 成反比/ ./ 实验/ 结果/ 图/ 3/ 显示/ ,/ 快速/ LLF/ 对/ 原始/ LLF/ 算法/ 的/ 最大/ 平均/ 逼近/ 误差/ 不/ 超过/ 7/ 个/ 灰度级/ ,/ 远/ 低于/ 人眼/ 能/ 感知/ 的/ 程度/ ./ 而/ 运行/ 效率/ 测试/ 结果/ 表/ 1/ 显示/ ,/ 快速/ LLF/ 最大/ 可/ 将/ 原始/ LLF/ 算法/ 的/ 速度/ 提高/ 两个/ 数量级/ ,/ 具有/ 显著/ 的/ 加速/ 特性/ ./ 图/ 3/ 实验/ 结果/ 还/ 显示/ 出/ ,/ 快速/ LLF/ 对/ 图像/ 细节/ 降低/ 情况/ 的/ 逼近/ 误差/ 远/ 小于/ 对/ 细节/ 提升/ 情况/ ,/ 这/ 是/ 重/ 映射函数/ 非线性/ 程度/ 差/ Page6/ 图/ 3/ 快速/ LLF/ 及/ 原始/ LLF/ 滤波器/ 对/ Flower/ 图像/ 的/ 细节/ 调整/ 的/ 计算结果/ 图/ 4/ 采样/ 数/ K/ 对/ 快速/ LLF/ 算法/ 逼近/ 程度/ 影响/ 的/ 直观/ 效果/ 异/ 引起/ 的/ ;/ 在/ 单通道/ 上/ 的/ 逼近/ 误差/ 远/ 小于/ 在/ 多通道/ 上/ 的/ 逼近/ 误差/ ,/ 这是/ 采样/ 点/ 个数/ 差异/ 引起/ 的/ ./ 表/ 1/ 本文/ 快速/ LLF/ 对/ 原始/ LLF/ 逼近/ 误差/ 及/ 加速/ 比/ 数据/ 图/ 3/ 最大/ 差异/ (/ i/ )/ Lum846/ ./ 9577393.62/ ./ 4164.0/ (/ j/ )/ RGB4229/ ./ 6377553.151/ ./ 410.8/ (/ k/ )/ Lum165/ ./ 5835391.62/ ./ 1186.5/ (/ l/ )/ RGB843/ ./ 3686542.951/ ./ 310.6/ 图/ 4/ 和/ 图/ 5/ 给出/ 了/ 固定/ 重/ 映射函数/ 非线性/ 特性/ ,/ 不同/ 采样/ 点数/ 对/ 快速/ LLF/ 算法/ 逼近/ 误差/ 影响/ 的/ 实验/ 结果/ ./ 图/ 4/ 实验/ 结果显示/ ,/ 采样/ 点/ 不足/ 会/ 引起/ 快速/ LLF/ 算法/ 计算结果/ 出现/ 视觉/ 上/ 的/ 伪/ 轮廓/ ,/ 并/ 在/ 细节/ 提升/ 情况/ 下/ 更为/ 明显/ ./ 图/ 5/ 实验/ 结果/ 给出/ 定量化/ 的/ 采样/ 点数/ 与/ 逼近/ 误差/ 间/ 的/ 关系/ 图/ :/ 随着/ 采样/ 点/ 个数/ 增加/ ,/ 快速/ LLF/ 的/ 逼近/ 误差/ 快速/ 减小/ ,/ 而/ 计算/ 性能/ 缓慢/ 的/ 呈现/ 线性/ 降低/ ./ 从/ 实验/ 经验/ 上/ 看/ ,/ 64/ / K/ / 128/ 的/ 采样/ 策略/ 是/ 计算/ 性能/ 和/ 逼近/ 误差/ 之间/ 一个/ 较为/ 合适/ 的/ 折衷/ ./ 图/ 5/ 采样/ 数/ K/ 对/ 快速/ LLF/ 逼近/ 误差/ 及/ 计算/ 性能/ 的/ 影响/ 4.3/ 快速/ LLF/ 算法/ 计算/ 效率/ 对比/ 分析/ 计算/ 效率/ 实验/ 图/ 6/ 的/ 实际/ 测试数据/ 表明/ ,/ 在/ 本文/ VIPS/ 融合/ 算法/ 框架/ 下/ 的/ 快速/ LLF/ 算法/ 的/ 计算/ 时间/ 复杂度/ 是/ 输入/ 图像/ 中/ 像素/ 个数/ 的/ 线性/ 函数/ ,/ 在/ 计算/ 性能/ 上/ 具有/ 较为/ 突出/ 的/ 优势/ ./ 而/ 采样/ 点/ 个数/ K/ 对/ 本文/ 算法/ 的/ 影响/ 也/ 是/ 可控/ 的/ ,/ 可/ 根据/ 实际/ 计算/ 精/ Page7/ 度/ 的/ 需要/ 进行/ 调节/ ./ 5/ 结论/ 本文/ 通过/ 提出/ “/ 全局/ 尝试/ 、/ 局部/ 精炼/ ”/ 的/ 图像增强/ 策略/ ,/ 成功/ 地/ 提出/ 一种/ 具有/ 高/ 扩展性/ 和/ 计算/ 效率/ 的/ 一般性/ 图像增强/ 算法/ 框架/ ,/ 可/ 适应/ 包括/ 单幅/ 或/ 序列/ 图像增强/ 问题/ 的/ 广泛应用/ 领域/ ./ 在/ 此/ 算法/ 框架/ 下/ ,/ 本文/ 引入/ 线性/ 函数/ 子/ 空间/ 逼近/ LLF/ 算法/ 中重/ 映射函数/ ,/ 使原/ LLF/ 算法/ 中/ 频繁/ 进行/ 的/ 图像/ 局部/ 重/ 映射/ 及/ 金字塔/ 分解/ 过程/ 简化/ 成/ 少量/ 输入/ 图像/ 的/ 全局/ 重/ 映射/ 及/ 拉普拉斯/ 金字塔/ 分解/ ,/ 大大降低/ 了/ 原/ LLF/ 算法/ 的/ 时间/ 复杂度/ ,/ 达到/ 加速/ 目的/ ./ 快速/ LLF/ 算法/ 继承/ 了/ 原/ LLF/ 算法/ 的/ 所有/ 优势/ ,/ 可以/ 产生/ 高质量/ 的/ 具有/ 保/ 边缘/ 的/ 图像增强/ 效果/ ./ 与/ 其它/ 保/ 边缘/ 图像增强/ 算法/ 相比/ ,/ 本文/ 算法/ 可/ 在/ 保持/ 较/ 高/ 计算/ 效率/ 的/ 前提/ 下/ ,/ 产生/ 高质量/ 的/ 图像增强/ 效果/ ,/ 并/ 具有/ 更加/ 宽/ 的/ 可扩展性/ ./ 由于/ 本文/ 算法/ 的/ 核心/ 计算/ 可/ 完全/ 表述/ 为/ 对/ 图像/ 像素/ 值/ 矩阵/ 的/ 简单/ 运算/ (/ 加法/ 和/ 数乘/ )/ ,/ 可/ 使用/ 现有/ 基本/ 线性代数/ 计算/ 程序库/ 实现/ CPU/ 指令/ 优化/ 或/ GPU/ 并行计算/ 功能/ ,/ 具有/ 突出/ 的/ 易/ 编程/ 实现/ 的/ 优势/ ./ 最后/ ,/ 本文/ 提出/ 的/ 算法/ 框架/ 具有/ 较/ 高/ 扩展性/ ,/ 作者/ 将/ 在/ 后续/ 工作/ 中/ 应用/ 此/ 算法/ 框架/ 到/ 图像/ 去/ 雾/ 、/ 高/ 动态/ 范围/ 图像/ 色调/ 映射/ 等/ 领域/ ,/ 期望/ 能/ 构建/ 出/ 更/ 多/ 优秀/ 图像增强/ 技术/ 的/ 快速/ 逼近/ 算法/ ./ 

