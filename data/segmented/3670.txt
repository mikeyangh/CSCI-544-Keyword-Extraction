Page1/ 时间/ 依赖/ 代价/ 函数/ 下/ 的/ 最优/ 路径/ 查询/ 问题/ 研究/ 杨雅君/ 高宏/ 李建中/ (/ 哈尔滨工业大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 摘要/ 作者/ 研究/ 了/ 时间/ 依赖图/ 下/ ,/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 的/ 查询/ 问题/ ./ 目前/ 有关/ 时间/ 依赖图/ 上/ 的/ 最/ 短/ 路径/ 查询/ 的/ 研究/ 工作/ 解决/ 的/ 是/ 最/ 短/ 旅行/ 时间/ 问题/ (/ TDSP/ )/ ,/ 这些/ 工作/ 都/ 利用/ 了/ 以下/ 性质/ :/ 到达/ 某个/ 顶点/ 的/ 最早/ 时刻/ 可以/ 通过/ 到达/ 其/ 邻居/ 的/ 最早/ 时刻/ 计算/ 得出/ ./ 然而/ ,/ 在/ 计算/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 时/ ,/ 该/ 性质/ 并/ 不/ 成立/ ./ 因此/ ,/ 目前/ 解决/ TDSP/ 问题/ 的/ 方法/ 均/ 不能/ 解决/ 文中/ 面对/ 的/ 问题/ ./ 对此/ 作者/ 提出/ 一个/ 新/ 的/ 算法/ 用于/ 计算/ 时间/ 依赖图/ 模型/ 上/ 的/ 满足/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ ./ 该/ 算法/ 适用/ 于/ 有向图/ 和/ 无/ 向/ 图/ ./ 作者/ 证明/ 了/ 算法/ 的/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ 分别/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ 和/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ./ 最后/ ,/ 作者/ 通过/ 真实/ 数据/ 集上/ 的/ 实验/ ,/ 验证/ 了/ 该/ 算法/ 的/ 有效性/ ./ 关键词/ 时间/ 依赖图/ ;/ 代价/ 函数/ ;/ 最优/ 路径/ 1/ 引言/ 图/ 模型/ 被/ 广泛/ 地/ 用来/ 刻画/ 现实/ 世界/ 中/ 各种各样/ 实体/ 间/ 的/ 复杂/ 关系/ ,/ 如/ 交通网/ 、/ 生物/ 信息学/ 、/ XML/ 数据库/ 以及/ 社交/ 网络/ 等等/ ./ 随着/ 信息技术/ 的/ 发展/ ,/ 各个/ 应用领域/ 的/ 信息量/ 都/ 呈现/ 了/ 爆炸性/ 增长/ 趋势/ ./ 因此/ ,/ 图/ 模型/ 数据/ 的/ 规模/ 也/ 变得/ 越来越/ 大/ ./ 最短/ 路径/ 查询/ Page2/ 是/ 图上/ 一类/ 经典/ 的/ 查询/ 问题/ 并/ 有着/ 重要/ 的/ 应用/ ./ 目前/ ,/ 大多数/ 的/ 最/ 短/ 路径/ 查询/ 都/ 是/ 定义/ 在/ 静态/ 图上/ 的/ ./ 然而/ ,/ 在/ 现实/ 应用/ 中/ ,/ 图/ 模型/ 往往/ 不是/ 固定/ 不变/ 的/ ,/ 而是/ 随着/ 时间/ 发生/ 着/ 演绎/ 与/ 变化/ ./ 例如/ ,/ 在/ 交通网/ 中/ ,/ 很多/ 的/ 交通管理/ 系统/ 能够/ 向/ 用户/ 提供/ 实时/ 的/ 交通/ 信息/ ./ 这些/ 系统/ 包括/ :/ 车辆/ 信息/ 和/ 通信/ 系统/ (/ VICS/ )/ 和/ 欧洲/ 交通/ 信息/ 频道/ (/ TMC/ )/ ./ VICS/ 被/ 应用/ 于/ 日本/ 的/ 城市/ 交通管理/ ,/ TMC/ 则/ 被/ 广泛应用/ 于/ 欧洲/ 、/ 北美/ 和/ 澳大利亚/ 的/ 城市/ 交通管理/ ./ 这些/ 交通系统/ 所/ 管理/ 的/ 交通网/ 都/ 可以/ 被/ 刻画/ 为/ 大规模/ 的/ 图/ 数据模型/ ./ 在/ 这些/ 模型/ 中/ ,/ 通过/ 一条/ 边/ (/ 道路/ )/ 的/ 代价/ 不是/ 一成不变/ 的/ ,/ 而是/ 会/ 随着/ 时间/ 的/ 变化/ 而/ 变化/ ./ 因此/ ,/ 如何/ 在/ 与/ 时间/ 相关/ 的/ 动态图/ 模型/ 上/ 计算/ 最短/ 路径/ ,/ 就/ 成为/ 了/ 一个/ 有着/ 十分/ 重要/ 研究/ 意义/ 的/ 问题/ ./ 我们/ 考虑/ 物流网/ 中/ 的/ 一个/ 应用/ ./ 快递/ 公司/ 需要/ 从/ 城市/ A/ 运输/ 一批/ 货物/ 到/ 城市/ B/ ,/ 假设/ 出发/ 时间/ 为/ t1/ ,/ 且/ 客户/ 要求/ 在/ 时刻/ t2/ 之前/ 收到/ 货物/ ./ 在/ 该/ 物流网/ 中/ ,/ 通过/ 每条/ 公路/ 有/ 一个/ 时间/ 开销/ 和/ 价格/ 开销/ ./ 根据/ 时间/ 开销/ 我们/ 可以/ 计算/ 某条/ 路径/ p/ 是否/ 满足/ 时间/ 限制/ ,/ 即/ 是否/ 能/ 在/ 时刻/ t2/ 之前/ 到达/ 城市/ B/ ./ 满足/ 时间/ 限制/ 的/ 路径/ 可能/ 有/ 很多/ ,/ 因此/ ,/ 从/ 这些/ 满足/ 时间/ 限制/ 的/ 路径/ 中/ ,/ 找到/ 价格/ 花费/ 最少/ 的/ 路径/ ,/ 是/ 一个/ 有着/ 十分/ 重要/ 应用/ 意义/ 的/ 问题/ ./ 一个/ 交通/ 物流网/ 可以/ 刻画/ 为/ 一个/ 大规模/ 图/ 模型/ ./ 图/ 模型/ 上/ 的/ 边/ (/ 道路/ )/ 可以/ 用/ 时间/ 代价/ wi/ ,/ j/ 和/ 费用/ 代价/ fi/ ,/ j/ (/ t/ )/ 来/ 描述/ ./ 时间/ 代价/ 表示/ 通过/ 这条/ 边/ 所/ 需要/ 花费/ 的/ 时间/ ,/ 费用/ 代价/ 表示/ 通过/ 这条/ 边/ 所/ 要花费/ 的/ 费用/ (/ 金钱/ )/ ./ 对图/ 中/ 的/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ ,/ 通过/ (/ vi/ ,/ vj/ )/ 的/ 费用/ 代价/ fi/ ,/ j/ (/ t/ )/ 会/ 随着/ vi/ 上/ 的/ 出发/ 时刻/ t/ 的/ 变化/ 而/ 变化/ ,/ 即/ fi/ ,/ j/ (/ t/ )/ 为/ 出发/ 时刻/ t/ 的/ 函数/ ./ 我们/ 称/ 这样/ 的/ 图/ 模型/ 为/ 时间/ 依赖图/ 模型/ ./ 因此/ ,/ 上面/ 的/ 查询/ 问题/ 可以/ 表示/ 为/ :/ 给定/ 起点/ vs/ 和/ 终点/ ve/ ,/ 最早/ 出发/ 时刻/ td/ 和/ 最晚/ 到达/ 时刻/ ta/ ,/ 计算/ 一条/ 由/ vs/ 到/ ve/ 的/ 路径/ p/ ,/ 该/ 路径/ p/ 需要/ 满足/ 两个/ 条件/ :/ (/ 1/ )/ 时间/ 限制/ ./ 即/ 要求/ 路径/ p/ 在/ 时刻/ td/ 之后/ 从/ vs/ 出发/ ,/ 在/ 时刻/ ta/ 之前/ 到达/ ve/ ;/ (/ 2/ )/ 在/ 所有/ 满足条件/ (/ 1/ )/ 的/ 路径/ 中/ ,/ 路径/ p/ 的/ 通行/ 费用/ 总和/ 最小/ ./ 目前/ ,/ 关于/ 时间/ 依赖图/ 上/ 的/ 最/ 短/ 路径/ 查询/ 问题/ (/ Time/ -/ DependentShortestPath/ ,/ TDSP/ )/ 已经/ 有/ 了/ 很多/ 的/ 研究/ 工作/ [/ 1/ -/ 6/ ]/ ./ 然而/ ,/ 这些/ 工作/ 主要/ 解决/ 的/ 是/ 最/ 短/ 旅行/ 时间/ 问题/ ,/ 即/ 给定/ 一个/ 出发/ 时刻/ t0/ ,/ 计算/ 一个/ 最早/ 到达/ 终点/ 的/ 时刻/ 并/ 找到/ 其/ 对应/ 的/ 路径/ ;/ 或者/ 给定/ 一个/ 出发/ 时间/ 区间/ T/ ,/ 找到/ 一条/ 最优/ 路径/ ,/ 其/ 出发/ 时间/ ts/ ∈/ T/ ,/ 使得/ 从/ 起点/ vs/ 到/ 终点/ ve/ 的/ 旅行/ 时间/ 总和/ 最小/ ./ 这些/ 工作/ 仅仅/ 假设/ 图中/ 的/ 边/ 只/ 存在/ 一个/ 时间/ 代价/ 函数/ wi/ ,/ j/ (/ t/ )/ ,/ 即/ 通过/ 图中/ 某条/ 边/ 的/ 时间/ 和/ 该/ 边/ 起点/ 上/ 的/ 出发/ 时刻/ 有关/ ./ 在/ 用/ 时间/ 代价/ 函数/ 刻画/ 边上/ 代价/ 的/ 时间/ 依赖图/ 模型/ 中/ ,/ 我们/ 用/ ti/ 表示/ 到达/ 顶点/ vi/ 的/ 最早/ 时刻/ ,/ 则/ ti/ 满足/ 以下/ 递归/ 关系/ :/ ti/ =/ min/ {/ tj/ +/ wj/ ,/ i/ (/ t/ )/ |/ vj/ ∈/ N/ -/ (/ vi/ )/ }/ ./ vj/ ∈/ N/ -/ (/ vi/ )/ 表示/ vj/ 是/ vi/ 的/ 入边/ 邻居/ ,/ tj/ 表示/ vj/ 的/ 最早/ 到达/ 时刻/ ./ 该/ 递归/ 关系/ 表示/ :/ 顶点/ vi/ 的/ 最早/ 到达/ 时刻/ 可以/ 根据/ 其入/ 边/ 邻居/ 的/ 最早/ 到达/ 时刻/ 计算/ 得出/ ./ 目前/ ,/ 解决/ TDSP/ 问题/ 的/ 研究/ 工作/ 都/ 利用/ 了/ 这/ 一/ 性质/ ./ 然而/ ,/ 在/ 费用/ 代价/ 函数/ 存在/ 的/ 时间/ 依赖图/ 模型/ 上/ ,/ 该/ 关系/ 并/ 不/ 成立/ (/ 详见/ 2.2/ 节/ )/ ./ 因此/ ,/ 目前/ 解决/ TDSP/ 问题/ 的/ 方法/ 均/ 不能/ 解决/ 本文/ 面对/ 的/ 问题/ ./ 运筹学/ 领域/ 中/ 的/ 一些/ 工作/ 研究/ 了/ 时间/ 依赖图/ 上/ 的/ 费用/ 代价/ 最优/ 路径/ 查询/ 问题/ [/ 7/ -/ 11/ ]/ ./ 然而/ ,/ 这些/ 工作/ 假定/ 时间/ 模型/ 是/ 离散/ 的/ ./ 在/ 离散/ 时间/ 模型/ 下/ ,/ 时间/ 区间/ 被/ 表示/ 为/ 一系列/ 离散/ 时间/ 点/ 的/ 集合/ [/ t1/ ,/ t2/ ,/ …/ ,/ tT/ ]/ ./ 对图/ 上/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ ,/ 用户/ 只能/ 选择/ 在/ 某个/ 给定/ 时刻/ ti/ 从/ vi/ 出发/ ./ 这些/ 工作/ 的/ 主要/ 问题/ 有/ :/ (/ 1/ )/ 离散/ 时间/ 模型/ 下/ 不能/ 找到/ 精确/ 的/ 最优/ 解/ ./ 比如/ 用户/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ ,/ ti/ -/ 1/ </ t/ </ ti/ ,/ ti/ -/ 1/ 和/ ti/ 是/ 给定/ 离散/ 时间/ 区间/ 内/ 的/ 两个/ 相邻/ 的/ 离散/ 时间/ 点/ ./ 用户/ 能/ 选择/ 的/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 的/ 最早/ 出发/ 时刻/ 为/ ti/ ./ 然而/ ,/ 可能/ 在/ 时刻/ t/ 出发/ 才/ 会/ 使得/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 的/ 代价/ 最小/ ,/ 这里/ t/ </ t/ </ ti/ ;/ (/ 2/ )/ 这些/ 方法/ 只是/ 从/ 理论/ 上/ 给出/ 计算/ 最优/ 路径/ 的/ 方法/ ,/ 并/ 没有/ 从/ 提高/ 算法/ 实际/ 运行/ 效率/ 的/ 角度/ 来/ 设计/ 算法/ 和/ 优化/ 算法/ ,/ 也/ 没有/ 应用/ 数据处理/ 中/ 的/ 优化/ 技术/ ./ 所以/ ,/ 这些/ 方法/ 需要/ 承受/ 较/ 高/ 的/ 时间/ 和/ 空间/ 开销/ ./ 因此/ ,/ 运筹学/ 领域/ 中/ 的/ 这些/ 工作/ 并/ 不能/ 很/ 好/ 解决/ 本文/ 所/ 要/ 面对/ 的/ 问题/ ./ 本文/ 中/ ,/ 我们/ 研究/ 了/ 时间/ 依赖图/ 模型/ 上/ 的/ 满足/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 的/ 查询/ 问题/ ,/ 本文/ 中/ 的/ 时间/ 模型/ 是/ 连续/ 的/ ,/ 且/ 允许/ 存在/ 等待时间/ 以/ 期待/ 找到/ 费用/ 代价/ 最小/ 的/ 路径/ ./ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 给出/ 了/ 一个/ 新/ 的/ 算法/ 计算/ 时间/ 依赖图/ 模型/ 上/ 的/ 满足/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ ./ 该/ 算法/ 适用/ 于/ 有向图/ 和/ 无/ 向/ 图/ ./ (/ 2/ )/ 证明/ 了/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ ,/ 空间/ 复杂度/ 为/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ,/ 这里/ n/ 和/ m/ 分别/ 为/ 图/ 中/ 顶点/ 和/ 边/ 的/ 数量/ ;/ k/ 为/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 上/ 的/ 分段/ 区间/ 数量/ (/ 详见/ 3.1/ 节/ )/ ./ (/ 3/ )/ 通过/ 真实/ 数据/ 集上/ 的/ 实验/ ,/ 验证/ 了/ 我们/ 算法/ 的/ 有效性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 问题/ 定义/ 、/ 现有/ 的/ 最/ 有效/ 的/ 方/ Page3/ 法/ 以及/ 它们/ 存在/ 的/ 主要/ 问题/ ;/ 第/ 3/ 节/ 介绍/ 如何/ 计算/ 时间/ 限制/ 下/ 的/ 费用/ 代价/ 最优/ 的/ 路径/ ,/ 该/ 算法/ 分为/ 两个/ 阶段/ :/ 最小/ 费用/ 代价/ 计算/ 阶段/ 和/ 路径/ 选择/ 阶段/ ;/ 第/ 4/ 节/ 通过/ 真实/ 数据/ 集上/ 的/ 实验/ 验证/ 方法/ 的/ 有效性/ ;/ 第/ 5/ 节/ 讨论/ 相关/ 工作/ ;/ 最后/ ,/ 总结/ 本文/ ./ 2/ 问题/ 定义/ 本节/ 中/ ,/ 将/ 介绍/ 时间/ 依赖图/ 的/ 定义/ 和/ 时间/ 依赖图/ 上/ 的/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 查询/ 问题/ 的/ 定义/ ./ 2.1/ 时间/ 依赖图/ 模型/ 的/ 概念/ 定义/ 1/ ./ 时间/ 依赖图/ ./ 时间/ 依赖图/ 是/ 一个/ 有向图/ ,/ 记作/ GT/ (/ V/ ,/ E/ ,/ W/ ,/ F/ )/ ,/ 其中/ V/ =/ {/ vi/ }/ 是/ 图/ 上/ 的/ 顶点/ 集合/ ;/ E/ =/ V/ ×/ V/ 是/ 图/ 上/ 的/ 边/ 集合/ ;/ W/ 是/ 边上/ 的/ 时间/ 代价/ 取值/ 集合/ ;/ F/ 是/ 边上/ 的/ 费用/ 代价/ 函数/ 集合/ ./ 对图/ 中/ 每/ 条边/ (/ vi/ ,/ vj/ )/ ∈/ E/ ,/ 存在/ 一个/ 时间/ 代价/ wi/ ,/ j/ ∈/ W/ 和/ 一个/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ ∈/ F/ ./ wi/ ,/ j/ 是/ 一个/ 常数/ ,/ 它/ 表示/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 所/ 要花费/ 的/ 时间/ ./ fi/ ,/ j/ (/ t/ )/ 是/ 一个/ 分段/ 常量/ 函数/ ,/ fi/ ,/ j/ (/ t/ )/ 的/ 直观/ 意义/ 是/ :/ 如果/ 在/ 时刻/ t/ 从/ 顶点/ vi/ 出发/ ,/ 则/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 所/ 要花费/ 的/ 费用/ 代价/ 为/ fi/ ,/ j/ (/ t/ )/ ./ 无向/ 图/ 可以/ 转化/ 为/ 有向图/ ,/ 即/ 一条/ 无向边/ 等价/ 于/ 两条/ 方向/ 相反/ 的/ 有/ 向/ 边/ ./ 本文/ 中/ 我们/ 假设/ 通过/ 图中/ 任意/ 一条/ 边/ 的/ 时间/ 代价/ wi/ ,/ j/ / 0/ ./ 该/ 假设/ 是/ 合理/ 的/ ,/ 因为/ 在/ 现实/ 世界/ 中/ ,/ 不/ 存在/ 小于/ 零/ 的/ 时间/ 开销/ ./ 类似/ 地/ ,/ 我们/ 假设/ fi/ ,/ j/ (/ t/ )/ 在/ 任意/ 时刻/ t/ 的/ 取值/ 为/ 正值/ ,/ 因为/ 现实/ 世界/ 中/ 不/ 存在/ 小于/ 零/ 的/ 费用/ 开销/ ./ 本文/ 中/ ,/ fi/ ,/ j/ (/ t/ )/ 定义/ 为/ 分段/ 常量/ 函数/ ,/ 其/ 形式/ 如下/ :/ 这里/ ,/ [/ t0/ ,/ tp/ ]/ 是/ 函数/ fi/ ,/ j/ (/ t/ )/ 的/ 定义域/ ;/ 常数/ ck/ 为/ 函数/ fi/ ,/ j/ (/ t/ )/ 在/ 时间/ 片段/ [/ tk/ -/ 1/ ,/ tk/ ]/ 上/ 的/ 取值/ ./ 对/ fi/ ,/ j/ (/ t/ )/ 的/ 分段/ 常量/ 假设/ 是/ 合理/ 的/ ./ 现实/ 世界/ 中/ 费用/ 代价/ 函数/ 取值/ 是/ 分段/ 常量/ 的/ 情况/ 十分/ 普遍/ ./ 比如/ ,/ 道路网/ 中/ 的/ 某/ 一条/ 公路/ ,/ 在/ 每天/ 不同/ 的/ 时间/ 区间/ 内/ 的/ 收费/ 标准/ 不同/ ./ 因此/ ,/ 通过/ 该/ 公路/ 的/ 费用/ 代价/ 函数/ 即/ 是/ 一个/ 分段/ 常量/ 函数/ ./ 给定/ 起点/ vs/ 和/ 终点/ ve/ ,/ 最早/ 出发/ 时刻/ td/ 和/ 最晚/ 到达/ 时刻/ ta/ ,/ 本文/ 的/ 目的/ 是/ 找到/ 一条/ 路径/ p/ / ,/ 使得/ (/ 1/ )/ p/ / 在/ 时刻/ td/ 之后/ 离开/ vs/ ,/ 且/ 在/ 时刻/ ta/ 之前/ 到达/ ve/ ;/ (/ 2/ )/ 在/ 所有/ 满足条件/ (/ 1/ )/ 的/ 路径/ 中/ ,/ p/ / 的/ 费用/ 代价/ 总和/ 最小/ ./ 给定/ 一条/ 路径/ p/ ,/ 其/ 到达/ 终点/ ve/ 的/ 费用/ 代价/ 与/ 时间/ 有关/ ./ 对于/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ ∈/ p/ ,/ 离开/ vi/ 的/ 时刻/ 不同/ ,/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 的/ 费用/ 也/ 就/ 不同/ ./ 因此/ ,/ 路径/ p/ 的/ 费用/ 代价/ 也/ 不同/ ./ 本文/ 中/ ,/ 允许/ 等待时间/ ,/ 即/ 到达/ 顶点/ vi/ 后/ ,/ 允许/ 在/ vi/ 等待/ 一段时间/ ω/ (/ vi/ )/ ,/ 以/ 期待/ 路径/ p/ 的/ 费用/ 代价/ 更/ 小/ ./ 下文/ 中/ ,/ 我们/ 用/ arrive/ (/ vi/ )/ 和/ depart/ (/ vi/ )/ 分别/ 表示/ 到达/ vi/ 的/ 时刻/ 和/ 离开/ vi/ 的/ 时刻/ ./ 对/ / vi/ ∈/ V/ ,/ 有令/ 路径/ p/ =/ v1/ →/ v2/ →/ …/ →/ vh/ ,/ 给定/ 最早/ 出发/ 时刻/ td/ ,/ 和/ 顶点/ vi/ 上/ 的/ 等待时间/ ω/ (/ vi/ )/ ,/ 有/ 因此/ ,/ 给定/ 最早/ 出发/ 时刻/ td/ 和/ 顶点/ vi/ 上/ 的/ 等待时间/ ω/ (/ vi/ )/ ,/ 对/ 路径/ p/ 上/ 的/ 每个/ 顶点/ vi/ ,/ 沿/ 路径/ p/ 到达/ vi/ 的/ 代价/ costp/ (/ vi/ )/ 可/ 递归/ 的/ 定义/ 为/ costp/ (/ v1/ )/ =/ 0/ ,/ costp/ (/ v2/ )/ =/ costp/ (/ v1/ )/ +/ f1/ ,/ 2/ (/ depart/ (/ v1/ )/ )/ ,/ …/ costp/ (/ vh/ )/ =/ costp/ (/ vh/ -/ 1/ )/ +/ fh/ -/ 1/ ,/ h/ (/ depart/ (/ vh/ )/ )/ ./ 我们/ 定义/ 路径/ p/ 的/ 代价/ cost/ (/ p/ )/ =/ costp/ (/ vh/ )/ ./ 下面/ ,/ 我们/ 给出/ 时间/ 依赖图/ 上/ 最优/ 路径/ 查询/ 问题/ 的/ 定义/ ./ 定义/ 2/ ./ 时间/ 依赖图/ 上/ 的/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 查询/ 问题/ ./ 给定/ 一个/ 时间/ 依赖图/ GT/ (/ V/ ,/ E/ ,/ W/ ,/ F/ )/ ,/ 起点/ vs/ ,/ 终点/ ve/ ,/ 最早/ 出发/ 时刻/ td/ 和/ 最晚/ 到达/ 时刻/ ta/ ./ 时间/ 依赖图/ 上/ 具有/ 时间/ 限制/ 的/ 费用/ 最优/ 路径/ 查询/ 问题/ 的/ 目的/ 是/ 找到/ 一条/ 路径/ p/ / 以及/ p/ / 上/ 每个/ 顶点/ vi/ 的/ 最佳/ 等待时间/ ω/ / (/ vi/ )/ ,/ 使得/ (/ 1/ )/ depart/ (/ vs/ )/ / td/ ∧/ arrive/ (/ ve/ )/ / ta/ ;/ (/ 2/ )/ cost/ (/ p/ / )/ 在/ 所有/ 满足条件/ (/ 1/ )/ 的/ vs/ 到/ ve/ 的/ 路径/ 中/ 最小/ ./ 图/ 1/ 给出/ 了/ 一个/ 时间/ 依赖图/ 的/ 示例/ ,/ 图/ 1/ (/ a/ )/ 是/ 一个/ 时间/ 依赖图/ GT/ ,/ 该图/ 包含/ 4/ 个/ 顶点/ 和/ 5/ 条边/ ./ 边/ (/ vi/ ,/ vj/ )/ 上/ 的/ 数字/ 表示/ 该边/ 的/ 时间/ 代价/ wi/ ,/ j/ ,/ 即/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 要花费/ 的/ 时间/ ./ 图/ 1/ (/ b/ )/ ~/ (/ f/ )/ 分别/ 给出/ 了/ 边/ (/ v1/ ,/ v2/ )/ ,/ (/ v1/ ,/ v3/ )/ ,/ (/ v2/ ,/ v3/ )/ ,/ (/ v2/ ,/ v4/ )/ 和/ (/ v3/ ,/ v4/ )/ 的/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ ./ 给出/ 一个/ 图/ GT/ 上/ 的/ 费用/ 最优/ 路径/ 查询/ ,/ vs/ =/ v1/ ,/ ve/ =/ v4/ ,/ td/ =/ 0/ ,/ ta/ =/ 60/ ,/ 则/ 费用/ 最优/ 路径/ 为/ p/ / :/ v1/ →/ v2/ →/ v3/ →/ v4/ ,/ 在/ 顶点/ v1/ ,/ v2/ 和/ v3/ 上/ 的/ 最佳/ 等待时间/ 分别/ 为/ ω/ / (/ v1/ )/ =/ 0/ ,/ ω/ / (/ v2/ )/ =/ 5/ 和/ ω/ / (/ v3/ )/ =/ 0/ ,/ 路径/ p/ / 的/ 代价/ 为/ cost/ (/ p/ / )/ =/ 20/ ./ Page4/ 图/ 1/ 时间/ 依赖图/ GT2/ ./ 2/ 现有/ 方法/ 介绍/ 及/ 存在/ 问题/ 分析/ 目前/ ,/ 时间/ 依赖图/ 模型/ 上/ 的/ 最优/ 路径/ 查询/ 问题/ 主要/ 集中/ 于/ 解决/ 最短/ 旅行/ 时间/ 的/ 问题/ (/ TDSP/ )/ [/ 1/ -/ 7/ ]/ ,/ 即/ 给定/ 出发点/ vs/ 、/ 目的/ 点/ ve/ 和/ 出发/ 时间/ 区间/ I/ ,/ 找到/ 一条/ 由/ vs/ 到/ ve/ 的/ 最优/ 路径/ 和/ 最佳/ 出发/ 时间/ ts/ ∈/ I/ ,/ 使得/ 该/ 路径/ 的/ 旅行/ 时间/ 最短/ ./ 在/ 该类/ 问题/ 中/ ,/ 通过/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ 的/ 时间/ wi/ ,/ j/ (/ t/ )/ 会/ 随着/ vi/ 的/ 出发/ 时刻/ t/ 的/ 变化/ 而/ 变化/ ,/ wi/ ,/ j/ (/ t/ )/ 是/ 一个/ 与/ 离开/ vi/ 时刻/ 有关/ 的/ 函数/ ./ 我们/ 将/ 介绍/ 两种/ 计算/ 最短/ 旅行/ 时间/ 路径/ 的/ 最/ 有效/ 的/ 方法/ ,/ 并/ 分析/ 这些/ 方法/ 为什么/ 不能/ 用于/ 本文/ 所/ 要/ 面对/ 的/ 问题/ ./ A/ / 算法/ ./ 文献/ [/ 3/ ]/ 提出/ 了/ 一种/ 基于/ A/ / 算法/ 的/ 扩展/ 算法/ KDXZ/ ./ KDXZ/ 算法/ 的/ 思想/ 是/ 利用/ 优先/ 队列/ 来/ 维护/ 所有/ 待/ 扩展/ 的/ 路径/ ./ 假设/ pi/ 为/ 一条/ 从/ 起点/ vs/ 到/ 顶点/ vi/ 的/ 路径/ ,/ 需要/ 注意/ 的/ 是/ ,/ vs/ 到/ vi/ 可能/ 存在/ 许多条/ 路径/ ,/ 这些/ 路径/ 可能/ 同时/ 被/ 维护/ 在/ 优先/ 队列/ 中/ ./ 每/ 一条/ vs/ 到/ ve/ 的/ 路径/ 的/ 旅行/ 时间/ 代价/ 可以/ 用/ 以下/ 函数/ 计算/ :/ fpi/ (/ t/ )/ =/ gpi/ (/ t/ )/ +/ di/ ,/ e/ -/ t/ ./ 这里/ ,/ gpi/ (/ t/ )/ 表示/ 在/ 时刻/ t/ 离开/ vs/ ,/ 并/ 沿/ 路径/ pi/ 到达/ vi/ 的/ 时刻/ ;/ di/ ,/ e/ 是/ 一个/ 估计/ 的/ vi/ 到/ ve/ 的/ 旅行/ 时间/ 下界/ ,/ di/ ,/ e/ =/ decu/ (/ vi/ ,/ ve/ )/ // vmax/ ,/ decu/ (/ vi/ ,/ ve/ )/ 表示/ vi/ 和/ ve/ 之间/ 的/ 欧氏/ 距离/ ,/ vmax/ 表示/ 网络/ 中/ 的/ 最大/ 速度/ ./ fpi/ (/ t/ )/ 表示/ 在/ 时刻/ t/ 离开/ vs/ ,/ 并/ 沿/ 路径/ pi/ 到达/ ve/ 的/ 估计/ 时间/ 开销/ ./ 每/ 一次/ 迭代/ 中/ ,/ 算法/ 从/ 队列/ 中/ 挑选/ 一条/ 路径/ pi/ ,/ 使得/ mint/ {/ fpi/ (/ t/ )/ }/ 在/ 被/ 队列/ 维护/ 的/ 所有/ 路径/ 中/ 最小/ ./ 算法/ 在/ 路径/ pi/ 末尾/ 加入/ 边/ (/ vi/ ,/ vj/ )/ 得到/ 一条/ 新/ 路径/ pj/ ,/ 并/ 将/ pj/ 加入/ 到/ 优先/ 队列/ ./ 当/ vs/ 到/ ve/ 的/ 路径/ pe/ 第一次/ 从/ 队列/ 中弹/ 出时/ ,/ 算法/ 终止/ ./ KDXZ/ 算法/ 不/ 允许/ 等待时间/ 的/ ω/ (/ vi/ )/ 存在/ ./ KDXZ/ 算法/ 主要/ 存在/ 3/ 方面/ 的/ 问题/ :/ (/ 1/ )/ KDXZ/ 算法/ 需要/ 两点/ 间/ 的/ 欧式/ 距离/ 和/ 网络/ 中/ 的/ 最高/ 速度/ 来/ 估计/ 旅行/ 时间/ 开销/ 的/ 下界/ ./ 然而/ ,/ 在/ 本文/ 面对/ 的/ 问题/ 中/ ,/ 边上/ 的/ 费用/ 代价/ 函数/ 是/ 任意/ 的/ ,/ 且/ 费用/ 代价/ 与/ 时间/ 开销/ 不同/ ,/ 无法/ 通过/ “/ 距离/ // 速度/ ”/ 的/ 公式/ 估计/ ./ 因此/ ,/ KDXZ/ 算法/ 无法/ 用于/ 本文/ 的/ 问题/ ;/ (/ 2/ )/ KDXZ/ 算法/ 的/ 效率/ 取决于/ 所/ 估计/ 的/ 下界/ 对/ 搜索/ 空间/ 的/ 裁剪/ 能力/ ./ 然而/ ,/ 在/ 大规模/ 图上/ ,/ KDXZ/ 算法/ 很难/ 计算/ 出/ 一个/ 较/ 准确/ 的/ 下界/ ./ 当图/ 的/ 规模/ 很大/ ,/ 或者/ 起点/ 和/ 终点/ 的/ 距离/ 很远时/ ,/ KDXZ/ 算法/ 的/ 效率/ 很/ 低/ ;/ (/ 3/ )/ 在/ 最坏/ 情况/ 下/ ,/ KDXZ/ 算法/ 可能/ 要/ 枚举/ 每/ 一条/ 起点/ 到/ 终点/ 的/ 路径/ 并/ 将/ 其/ 维护/ 在/ 优先/ 队列/ 中/ ./ 因此/ ,/ KDXZ/ 算法/ 的/ 时间/ 和/ 空间/ 复杂度/ 是/ 图/ 中/ 顶点/ 规模/ 的/ 指数/ 级/ ./ 2S/ 算法/ ./ 文献/ [/ 5/ ]/ 中/ 提出/ 了/ 目前/ 解决/ TDSP/ 问题/ 的/ 最/ 有效/ 算法/ 2S/ ,/ 该/ 算法/ 基于/ Dijkstra/ 算法/ 的/ 思想/ ./ 2S/ 算法/ 主要/ 分为/ :/ (/ 1/ )/ 最早/ 到达/ 时刻/ 函数/ 计算/ 阶段/ ;/ (/ 2/ )/ 路径/ 选择/ 阶段/ ./ 在/ 阶段/ (/ 1/ )/ ,/ 算法/ 根据/ 以下/ 公式/ 计算/ 最早/ 到达/ 时刻/ 函数/ :/ gi/ (/ t/ )/ =/ minvj/ ∈/ N/ -/ (/ vi/ )/ ,/ ω/ (/ vj/ )/ gi/ (/ t/ )/ 是/ 一个/ 与/ 出发/ 时刻/ t/ 相关/ 的/ 函数/ ,/ 它/ 表示/ 在/ 时/ Page5/ 刻/ t/ 离开/ 起点/ vs/ 的/ 所有/ 路径/ 中/ ,/ 到达/ 顶点/ vi/ 的/ 最早/ 时刻/ ./ N/ -/ (/ vi/ )/ 表示/ 顶点/ vi/ 的/ 入边/ 邻居/ 集合/ ,/ 即/ N/ -/ (/ vi/ )/ =/ {/ vj/ |/ (/ vj/ ,/ vi/ )/ ∈/ E/ }/ ./ 算法/ 用/ 优先/ 队列/ 维护/ 图中/ 所有/ 顶点/ vi/ 的/ 最早/ 到达/ 时间/ 函数/ gi/ (/ t/ )/ 和/ 一个/ 时间/ 区间/ [/ ts/ ,/ τ/ i/ ]/ ./ gi/ (/ t/ )/ 在/ 区间/ [/ ts/ ,/ τ/ i/ ]/ 内/ 的/ 取值/ 是/ 准确/ 的/ ./ 当/ 顶点/ vi/ 从/ 队列/ 中弹/ 出时/ ,/ 算法/ 根据/ 式/ (/ 1/ )/ 来/ 更新/ 函数/ gi/ (/ t/ )/ 和/ 区间/ [/ ts/ ,/ τ/ i/ ]/ ./ 若/ 更新/ 后/ 的/ 时间/ 区间/ [/ ts/ ,/ τ/ i/ ]/ ≠/ I/ ,/ I/ 为/ 给定/ 的/ 出发/ 时间/ 区间/ ,/ 则/ 算法/ 将/ vi/ 重新/ 插回/ 队列/ ./ 当/ 终点/ ve/ 的/ 最早/ 到达/ 时间/ 函数/ ge/ (/ t/ )/ 在/ 整个/ 区间/ I/ 内/ 取值/ 确定/ 后/ ,/ 算法/ 结束/ ./ 在/ 阶段/ (/ 2/ )/ ,/ 算法/ 根据/ ge/ (/ t/ )/ ,/ 找到/ 起点/ vs/ 到/ 终点/ ve/ 旅行/ 时间/ 最短/ 的/ 路径/ ./ 该/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ (/ nlogn/ +/ m/ )/ α/ (/ T/ )/ )/ ,/ n/ 为/ 图/ GT/ 中/ 顶点/ 数量/ ,/ m/ 为/ 图/ GT/ 中边/ 的/ 数量/ ,/ α/ (/ T/ )/ 为/ 更新/ ge/ (/ t/ )/ 和/ 区间/ [/ ts/ ,/ τ/ e/ ]/ 的/ 次数/ ./ 2S/ 算法/ 是/ 一个/ 两/ 阶段/ 搜索算法/ ,/ 它/ 存在/ 的/ 主要/ 问题/ 有/ :/ (/ 1/ )/ 2S/ 算法/ 的/ 核心/ 是/ 利用/ 式/ (/ 1/ )/ 计算/ 最早/ 到达/ 时间/ 函数/ ./ 然而/ ,/ 式/ (/ 1/ )/ 所/ 蕴含/ 的/ 关系/ 在/ 本文/ 所/ 面对/ 的/ 问题/ 中/ 并/ 不/ 成立/ ./ 我们/ 用/ 例子/ 说明/ ./ 图/ 1/ 中/ ,/ 目标/ 为/ 计算/ v1/ →/ v4/ 的/ 代价/ 最小/ 的/ 路径/ ./ 对/ 顶点/ v4/ 的/ 入边/ 邻居/ v3/ ,/ 我们/ 发现/ 到达/ v3/ 的/ 最小/ 费用/ 代价/ 为/ g3/ (/ 15/ )/ =/ 5/ ,/ 即/ 在/ 时刻/ 15/ 离开/ v1/ ,/ 通过/ 边/ (/ v1/ ,/ v3/ )/ 到达/ v3/ 的/ 费用/ 代价/ 最小/ (/ 费用/ 为/ 5/ )/ ./ 此时/ ,/ 到达/ v3/ 的/ 时刻/ 为/ 30/ ./ 因此/ ,/ 根据/ 式/ (/ 1/ )/ ,/ 通过/ 顶点/ v3/ 到达/ v4/ 的/ 最小/ 费用/ 代价/ 为/ g3/ (/ 15/ )/ +/ w3/ ,/ 4/ (/ 30/ )/ =/ 5/ +/ 35/ =/ 40/ ./ 显然/ ,/ 该/ 结果/ 是/ 错误/ 的/ ./ 因为/ ,/ 从/ v1/ 出发/ ,/ 通过/ 顶点/ v3/ 到达/ v4/ 的/ 最优/ 路径/ 为/ v1/ →/ v2/ →/ v3/ →/ v4/ ,/ 其/ 费用/ 代价/ 为/ 20/ ./ 造成/ 该/ 问题/ 的/ 原因/ 是/ :/ 一条/ 费用/ 代价/ 最优/ 路径/ 上/ 的/ 子/ 路径/ 未必/ 是/ 费用/ 代价/ 最优/ 的/ ./ 考虑/ 一条/ vs/ 到/ vi/ 的/ 费用/ 代价/ 最小/ 的/ 路径/ pi/ ,/ vj/ 为/ vi/ 的/ 入边/ 邻居/ ,/ vs/ 到/ vj/ 的/ 费用/ 代价/ 最小/ 的/ 路径/ 为/ pj/ ,/ 沿/ pj/ 到达/ vj/ 的/ 时间/ 为/ tj/ ./ 此时/ ,/ 可能/ 存在/ 另外/ 一条/ vs/ 到/ vj/ 的/ 路径/ pj/ ,/ 其/ 到达/ vj/ 的/ 时间/ 为/ tj/ ,/ pj/ 的/ 费用/ 略微/ 大于/ pj/ 的/ 费用/ ,/ 但/ 在/ 时刻/ tj/ 后/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 的/ 最小/ 费用/ 远远/ 大于/ 在/ 时刻/ tj/ 后/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 的/ 最小/ 费用/ ,/ 即/ min/ {/ wj/ ,/ i/ (/ t/ )/ |/ t/ / tj/ }/ / min/ {/ wj/ ,/ i/ (/ t/ )/ |/ t/ / tj/ }/ ./ 因此/ ,/ 式/ (/ 1/ )/ 不能/ 通过/ 到达/ 顶点/ vj/ 的/ 最小/ 费用/ 计算/ 出/ 到达/ 顶点/ vi/ 的/ 最小/ 费用/ ./ 如图/ 1/ 例中/ ,/ v1/ 到/ v4/ 的/ 最优/ 路径/ 为/ v1/ →/ v2/ →/ v3/ →/ v4/ ,/ 其子/ 路径/ v1/ →/ v2/ →/ v3/ 并/ 不是/ v1/ 到/ v3/ 的/ 最优/ 路径/ ;/ (/ 2/ )/ 该/ 算法/ 的/ 更新/ 次数/ α/ (/ T/ )/ 没有/ 上/ 界/ 保证/ ,/ 如果/ 对图/ 中/ 顶点/ 估计/ 的/ 最早/ 到达/ 时间/ 函数/ 不/ 准确/ ,/ α/ (/ T/ )/ 取值/ 可能/ 很大/ ,/ 从而/ 影响/ 了/ 算法/ 的/ 效率/ ./ 综上所述/ ,/ 与/ TDSP/ 问题/ 不同/ ,/ 费用/ 代价/ 最优/ 路径/ 并/ 不/ 具备/ 子/ 路径/ 最优/ 的/ 性质/ ,/ 因此/ 解决/ TDSP/ 问题/ 的/ 方法/ 并/ 不能/ 解决/ 本文/ 所/ 要/ 面对/ 的/ 问题/ ./ 运筹学/ 领域/ 中/ 的/ 一些/ 工作/ 研究/ 了/ 时间/ 依赖图/ 上/ 的/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 问题/ [/ 7/ -/ 11/ ]/ ./ 然而/ ,/ 这些/ 工作/ 中/ 假定/ 时间/ 模型/ 是/ 离散/ 的/ ./ 在/ 离散/ 时间/ 模型/ 中/ ,/ 时间/ 区间/ 被/ 表示/ 为/ 一系列/ 离散/ 时间/ 点/ 的/ 集合/ [/ t1/ ,/ t2/ ,/ …/ ,/ tT/ ]/ ./ 给定/ 图中/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ ,/ 用户/ 只能/ 选择/ 在/ 某个/ 给定/ 时间/ 点/ ti/ 离开/ vi/ ./ 这些/ 工作/ 的/ 主要/ 问题/ 有/ :/ (/ 1/ )/ 在/ 离散/ 时间/ 模型/ 下/ 无法/ 找到/ 问题/ 的/ 最优/ 解/ ./ 例如/ ,/ 假设/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ ,/ ti/ -/ 1/ </ t/ </ ti/ ,/ 这里/ ti/ -/ 1/ 和/ ti/ 是/ 给定/ 离散/ 时间/ 区间/ 内/ 的/ 两个/ 相邻/ 的/ 离散/ 时间/ 点/ ./ 离散/ 时间/ 模型/ 下/ ,/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 离开/ vi/ 的/ 最早/ 时刻/ 为/ ti/ ./ 然而/ ,/ 在/ 时刻/ t/ 出发/ 才能/ 使得/ 通过/ 边/ (/ vi/ ,/ vj/ )/ 的/ 代价/ 最小/ ,/ 这里/ t/ </ t/ </ ti/ ,/ 离散/ 时间/ 模型/ 无法/ 取/ 到/ 时刻/ t/ ,/ 因此/ 也/ 就/ 不能/ 找到/ 费用/ 最优/ 的/ 路径/ ;/ (/ 2/ )/ 这些/ 方法/ 只是/ 从/ 理论/ 上/ 给出/ 计算/ 费用/ 最优/ 路径/ 的/ 方法/ ,/ 并/ 没有/ 从/ 提高/ 算法/ 实际/ 运行/ 效率/ 的/ 角度/ 来/ 设计/ 算法/ 和/ 优化/ 算法/ ,/ 也/ 没有/ 应用/ 数据处理/ 中/ 的/ 优化/ 技术/ ./ 因此/ ,/ 这些/ 方法/ 需要/ 承受/ 较/ 高/ 的/ 时间/ 和/ 空间/ 开销/ ./ 本文/ 中/ ,/ 我们/ 给出/ 了/ 一种/ 有效/ 的/ 计算/ 时间/ 依赖图/ 上/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 的/ 算法/ ,/ 该/ 算法/ 是/ 一个/ 两/ 阶段/ 搜索算法/ ./ 在/ 第/ 1/ 阶段/ ,/ 我们/ 计算/ 起点/ vs/ 到达/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ (/ 详见/ 3.1/ 节/ 和/ 3.2/ 节/ )/ ./ 在/ 第/ 2/ 阶段/ ,/ 我们/ 根据/ 第/ 1/ 阶段/ 的/ 结果/ ,/ 找到/ 起点/ vs/ 到/ ve/ 的/ 最优/ 路径/ 和/ 路径/ 上/ 每个/ 点/ 的/ 最佳/ 等待时间/ ./ 我们/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ ,/ 空间/ 复杂度/ 为/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ./ 3/ 两/ 阶段/ 搜索算法/ 在/ 本节/ 中/ ,/ 我们/ 提出/ 一个/ 有效/ 的/ 两/ 阶段/ 搜索算法/ ./ 首先/ 介绍/ 如何/ 根据/ 顶点/ vj/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 更新/ 其/ 邻居/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ;/ 然后/ ,/ 介绍/ 算法/ 的/ 第/ 1/ 阶段/ ,/ 即/ 计算/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ ;/ 再次/ ,/ 介绍/ 算法/ 的/ 第/ 2/ 阶段/ ,/ 即/ 如何/ 根据/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ ,/ 找到/ 满足/ 时间/ 限制/ 的/ vs/ 到/ ve/ 的/ 费用/ 最优/ 路径/ 和/ 路径/ 上/ 每个/ 顶点/ 的/ 最佳/ 等待时间/ ;/ 最后/ ,/ 分析/ 算法/ 的/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ ./ 算法/ 1/ 给出/ 了/ 两/ 阶段/ 搜索算法/ 的/ 流程/ ./ 算法/ 1/ ./ 两/ 阶段/ 搜索算法/ ./ Two/ -/ Step/ -/ Search/ (/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ )/ 输入/ :/ 依赖图/ GT/ ,/ 起点/ vs/ ,/ 终点/ ve/ ,/ 最早/ 出发/ 时刻/ td/ ,/ 最/ Page6/ 输出/ :/ 费用/ 代价/ 最优/ 路径/ p/ / ,/ p/ / 上/ 各点/ 等待时间/ ω/ / (/ vi/ )/ 1/ ./ Computing/ -/ g/ / e/ (/ t/ / )/ (/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ )/ ;/ 2/ ./ ifg/ / e/ (/ t/ / )/ ≠/ then3/ ./ Path/ -/ Selection/ (/ g/ / e/ (/ t/ / )/ ,/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ )/ ;/ 4/ ./ returnp/ / ,/ ω/ / (/ vi/ )/ foreachvi/ ∈/ p/ / ;/ 5/ ./ elsereturn/ / ./ 3.1/ 更新/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 首先/ 介绍/ 什么/ 是/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ 对/ 任意/ 一个/ 顶点/ vi/ ∈/ GT/ ,/ 在/ 时刻/ td/ 之后/ 离开/ 起点/ vs/ ,/ 并且/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ 的/ 路径/ p/ 可能/ 存在/ 很多/ ,/ 我们/ 用/ Ps/ ,/ i/ ,/ td/ (/ t/ )/ 表示/ 这些/ 路径/ 的/ 集合/ ./ 用/ gi/ (/ t/ )/ 表示/ 所有/ 这些/ 路径/ 中/ 的/ 最小/ 代价/ ,/ 即/ 需要/ 注意/ 的/ 是/ ,/ 路径/ p/ 上/ 允许/ 等待时间/ 的/ 存在/ ,/ 只要/ 路径/ p/ 能够/ 满足/ 出发/ 时刻/ 和/ 到达/ 时刻/ 的/ 要求/ ,/ 即/ 满足/ departp/ (/ vs/ )/ / td/ ,/ 表示/ 路径/ p/ 在/ 时刻/ td/ 之后/ 离开/ 起点/ vs/ ;/ arrivep/ (/ vi/ )/ =/ t/ ,/ 表示/ 路径/ p/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ ./ gi/ (/ t/ )/ 是/ 一个/ 随着/ t/ 变化/ 的/ 函数/ ,/ 我们/ 称之为/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ,/ 它/ 反映/ 了/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ 所/ 要花费/ 的/ 最小/ 费用/ ./ 引理/ 1/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ 若图/ 中/ 任意/ 一条/ 边上/ 的/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ 是/ 分段/ 常量/ 函数/ ,/ 则/ 对/ / vi/ ∈/ V/ ,/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ 也/ 是/ 分段/ 常量/ 函数/ ./ 证明/ ./ 因为/ 用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ 是/ 分段/ 常量/ 函数/ ,/ gi/ (/ t/ )/ 的/ 取值/ 为/ 路径/ 所/ 经过/ 边上/ 各个/ 常量/ 值/ 的/ 求和/ ,/ 因此/ ,/ gi/ (/ t/ )/ 也/ 为/ 分段/ 常量/ 函数/ ./ 证毕/ ./ 下面/ ,/ 介绍/ 如何/ 计算/ gi/ (/ t/ )/ ./ 令/ 顶点/ vj/ 是/ 顶点/ vi/ 的/ 一个/ 入边/ 邻居/ ,/ 即/ vj/ ∈/ N/ -/ (/ vi/ )/ ./ 假设/ gj/ (/ t/ )/ 已知/ ,/ 我们/ 可以/ 根据/ gj/ (/ t/ )/ 更新/ gi/ (/ t/ )/ ./ 更新过程/ 分为/ 两步/ :/ (/ 1/ )/ 计算/ gj/ →/ i/ (/ t/ )/ ,/ gj/ →/ i/ (/ t/ )/ 表示/ :/ 通过/ 顶点/ vj/ 到达/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ;/ (/ 2/ )/ 利用/ gj/ →/ i/ (/ t/ )/ 更新/ gi/ (/ t/ )/ ./ 显然/ ,/ 如果/ 不/ 允许/ 等待时间/ 的/ 存在/ ,/ 即/ ω/ (/ vj/ )/ =/ 0/ ,/ 则/ 有/ 该/ 公式/ 的/ 意义/ 如下/ :/ 如果/ 在/ 时刻/ t/ -/ wj/ ,/ i/ 到达/ 顶点/ vj/ ,/ 其/ 最小/ 费用/ 代价/ 为/ gj/ (/ t/ -/ wj/ ,/ i/ )/ ./ 因为/ ω/ (/ vj/ )/ =/ 0/ ,/ 所以/ 需要/ 立即/ 离开/ 顶点/ vj/ ,/ 此时/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 的/ 费用/ 为/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ ./ 因为/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 的/ 时间/ 开销/ 为/ wj/ ,/ i/ ,/ 所以/ 通过/ 顶点/ vj/ 且/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ 的/ 最小/ 费用/ 代价/ 为/ gj/ (/ t/ -/ wj/ ,/ i/ )/ +/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ ./ 本文/ 中/ ,/ 我们/ 允许/ 存在/ 等待时间/ ω/ (/ vj/ )/ ,/ 以/ 期待/ 在/ 时刻/ t/ ,/ gj/ →/ i/ (/ t/ )/ 能取/ 到/ 最小/ 的/ 费用/ 代价/ ./ 因此/ ,/ gj/ →/ i/ (/ t/ )/ =/ gj/ (/ t/ -/ wj/ ,/ i/ )/ +/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ ./ gj/ →/ i/ (/ t/ )/ =/ mint/ ,/ ω/ (/ vj/ )/ {/ gj/ (/ t/ )/ +/ fj/ ,/ i/ (/ t/ +/ ω/ (/ vj/ )/ )/ }/ 这里/ ,/ t/ +/ ω/ (/ vj/ )/ 为/ 离开/ 顶点/ vj/ 的/ 时间/ ,/ 即/ 在/ 时刻/ t/ 到达/ 顶点/ vj/ 后/ ,/ 等待/ ω/ (/ vj/ )/ 时间/ 后/ 再/ 离开/ 顶点/ vj/ ./ 因此/ ,/ 当/ 在/ 时刻/ t/ 到达/ 顶点/ vj/ 后/ ,/ 如果/ 要/ 保证/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ ,/ 则/ 需要/ 选取/ 合适/ 的/ 等待时间/ ω/ (/ vj/ )/ ,/ 满足/ t/ =/ t/ +/ ω/ (/ vj/ )/ +/ wj/ ,/ i/ ./ 在/ 允许/ 等待时间/ 存在/ 的/ 情况/ 下/ ,/ 给定/ 时刻/ t/ ,/ 计算/ gj/ →/ i/ (/ t/ )/ 的/ 问题/ 等价/ 于/ 找到/ 一个/ 最优/ 的/ t/ 和/ ω/ (/ vj/ )/ ,/ 满足/ t/ -/ wj/ ,/ i/ =/ t/ +/ ω/ (/ vj/ )/ ,/ 使得/ 式/ (/ 2/ )/ 中/ gj/ →/ i/ (/ t/ )/ 最小/ ./ 给定/ 到达/ 顶点/ vi/ 的/ 时刻/ t/ ,/ 离开/ 顶点/ vj/ 的/ 时刻/ 也/ 就/ 被/ 确定/ 为/ t/ -/ wj/ ,/ i/ ./ 因此/ ,/ 此时/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 的/ 费用/ 代价/ 也/ 就/ 被/ 确定/ 为/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ ./ 根据/ gj/ →/ i/ (/ t/ )/ 的/ 定义/ ,/ 我们/ 知/ :/ gj/ →/ i/ (/ t/ )/ =/ mint/ / t/ -/ wj/ ,/ i/ 根据/ 以上/ 式/ (/ 3/ )/ ,/ 计算/ gj/ →/ i/ (/ t/ )/ 等价/ 于/ 找到/ 最优/ 的/ 时刻/ t/ ,/ t/ / t/ -/ wj/ ,/ i/ ,/ 使得/ gj/ (/ t/ )/ 最小/ ,/ 也就是说/ ,/ 对于/ 每/ 一个/ 出发/ 时刻/ t/ -/ wj/ ,/ i/ ,/ 我们/ 只/ 需/ 找到/ 一个/ 与/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ 对应/ 的/ 最优/ gj/ (/ t/ )/ ,/ 并/ 与/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ 求和/ 即可/ ./ 我们/ 给出/ 一个/ 有效/ 的/ 算法/ 计算/ 函数/ gj/ →/ i/ (/ t/ )/ ./ 给定/ 顶点/ vj/ 的/ 到达/ 时间/ -/ 代价/ 函数/ gj/ (/ t/ )/ ,/ gj/ (/ t/ )/ 的/ 定义域/ 为/ [/ λ/ j/ ,/ ta/ ]/ ./ λ/ j/ 为/ 在/ 时刻/ td/ 离开/ vs/ ,/ 能够/ 到达/ 顶点/ vj/ 的/ 最早/ 时刻/ ,/ 也就是说/ ,/ 当/ 在/ 最早/ 出发/ 时刻/ td/ 从/ 起点/ vs/ 出发/ 时/ ,/ 我们/ 不/ 可能/ 早/ 于/ 时刻/ λ/ j/ 到达/ 顶点/ vj/ ./ 进一步/ 地/ ,/ 通过/ 顶点/ vj/ 到达/ 顶点/ vi/ 的/ 最早/ 时刻/ 为/ λ/ j/ →/ i/ =/ λ/ j/ +/ wj/ ,/ i/ ./ 我们/ 只/ 需/ 计算/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ 内/ 的/ 取值/ 即可/ ./ 对于/ 边/ (/ vj/ ,/ vi/ )/ 的/ 费用/ 代价/ 函数/ fj/ ,/ i/ (/ t/ )/ ,/ 只/ 需/ 考虑/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ ,/ ta/ -/ wj/ ,/ i/ ]/ 内/ 的/ 取值/ 即可/ ./ 因为/ 当/ 离开/ 顶点/ vj/ 的/ 时刻/ 晚于/ ta/ -/ wj/ ,/ i/ 时/ ,/ 不/ 可能/ 在/ 最晚/ 到达/ 时刻/ ta/ 前/ 到达/ 顶点/ vi/ ,/ 所以/ 也/ 不/ 可能/ 在/ 最晚/ 到达/ 时刻/ ta/ 前/ 到达/ 终点/ ve/ ./ 算法/ 2/ ./ 更新/ 算法/ ./ Updating/ -/ gi/ (/ t/ )/ (/ gi/ (/ t/ )/ ,/ gj/ (/ t/ )/ ,/ fj/ ,/ i/ (/ t/ )/ )/ 输入/ :/ gi/ (/ t/ )/ ,/ gj/ (/ t/ )/ ,/ fj/ ,/ i/ (/ t/ )/ 输出/ :/ gi/ (/ t/ )/ 1/ ./ α/ j/ ←/ ta/ -/ wj/ ,/ i/ ;/ 2/ ./ while/ α/ j/ ≠/ λ/ jdo3/ ./ g/ / α/ j/ ←/ min/ {/ gj/ (/ t/ )/ |/ t/ / α/ j/ }/ ;/ 4/ ./ φ/ α/ j/ ←/ min/ {/ t/ |/ gj/ (/ t/ )/ =/ g/ / α/ j/ ,/ t/ / α/ j/ }/ ;/ 5/ ./ foreachtimesub/ -/ interval/ [/ tx/ -/ 1/ ,/ tx/ ]/ / [/ φ/ α/ j/ ,/ α/ j/ ]/ do6/ ./ gj/ →/ i/ (/ t/ +/ wj/ ,/ i/ )/ =/ fj/ ,/ i/ (/ t/ )/ +/ g/ / α/ j/ ;/ 7/ ./ α/ j/ ←/ φ/ α/ j/ ;/ Page78/ ./ gi/ (/ t/ )/ ←/ min/ {/ gi/ (/ t/ )/ ,/ gj/ →/ i/ (/ t/ )/ }/ ;/ 9/ ./ returngi/ (/ t/ )/ ./ 算法/ 2/ 给出/ 了/ 计算/ gj/ →/ i/ (/ t/ )/ 的/ 流程/ ./ 我们/ 用/ [/ λ/ j/ ,/ α/ j/ ]/ 表示/ fj/ ,/ i/ (/ t/ )/ 的/ 未/ 处理/ 区间/ ,/ 即/ 区间/ [/ λ/ j/ ,/ α/ j/ ]/ 内/ 的/ fj/ ,/ i/ (/ t/ )/ 没有/ 找到/ 最优/ 的/ gj/ (/ t/ )/ 使得/ 式/ (/ 3/ )/ 取值/ 最小/ ./ 初始化/ 阶段/ ,/ α/ j/ =/ ta/ -/ wj/ ,/ i/ ./ 算法/ 1/ 不断更新/ 未/ 处理/ 区间/ [/ λ/ j/ ,/ α/ j/ ]/ ,/ 当/ fj/ ,/ i/ (/ t/ )/ 在/ 全部/ 时间/ 区间/ [/ λ/ j/ ,/ ta/ -/ wj/ ,/ i/ ]/ 内/ 都/ 找到/ 对应/ 的/ 最优/ gj/ (/ t/ )/ 时/ ,/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ 内/ 的/ 取值/ 即/ 被/ 确定/ ,/ 算法/ 结束/ ./ 值/ ,/ 即/ 我们/ 用/ g/ α/ / 初始化/ 阶段/ ,/ 由于/ gj/ (/ t/ )/ 为/ 分段/ 常量/ 函数/ ,/ 令/ φ/ α/ j/ 为/ t/ / α/ j/ 条件/ 下/ 使得/ gj/ (/ t/ )/ 取值/ 为/ g/ α/ / φ/ α/ j/ 实质/ 上/ 是/ gj/ (/ t/ )/ 在/ 取值/ 为/ g/ α/ / 端点/ ./ 因此/ ,/ g/ α/ / 应/ 的/ 最优/ gj/ (/ t/ )/ ./ 我们/ 考虑/ 代价/ 函数/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ [/ φ/ α/ j/ ,/ α/ j/ ]/ 内/ 的/ 取值/ ./ 因为/ fj/ ,/ i/ (/ t/ )/ 为/ 分段/ 常量/ 函数/ ,/ 所以/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ [/ φ/ α/ j/ ,/ α/ j/ ]/ 内/ 也/ 是/ 分段/ 常量/ 函数/ ./ 不失/ 一般性/ ,/ 我们/ 设/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ fj/ ,/ i/ (/ t/ )/ 内/ 分为/ q/ 个子/ 区间/ [/ t0/ ,/ t1/ ]/ ,/ [/ t1/ ,/ t2/ ]/ ,/ …/ ,/ [/ tq/ -/ 1/ ,/ tq/ ]/ ,/ 这里/ ,/ t0/ =/ φ/ α/ j/ ,/ tq/ =/ α/ j/ ./ 假设/ fj/ ,/ i/ (/ t/ )/ 在子/ 区间/ [/ tx/ -/ 1/ ,/ tx/ ]/ 内/ 取值/ 为/ cx/ ,/ 则/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ tx/ -/ 1/ +/ wj/ ,/ i/ ,/ tx/ +/ wj/ ,/ i/ ]/ 内/ 的/ 取值/ 为/ j/ ./ cx/ +/ g/ α/ / 需要/ 注意/ 的/ 是/ ,/ 为了/ 方便/ 讨论/ ,/ 本文/ 假设/ gj/ (/ t/ )/ 和/ fj/ ,/ i/ (/ t/ )/ 上/ 的/ 所有/ 分段/ 区间/ 均/ 为/ 闭/ 区间/ ./ 开区间/ 存在/ 时/ ,/ 我们/ 的/ 方法/ 仍然/ 有效/ ./ 对/ gj/ (/ t/ )/ ,/ 当/ g/ α/ / 时间/ 区间/ 为/ 开区间/ 时/ ,/ φ/ α/ j/ 取值/ 为/ 该/ 开区间/ 的/ 左/ 端点/ 即可/ ./ 在/ 计算/ gj/ →/ i/ (/ t/ )/ 时/ ,/ 如果/ g/ α/ / fj/ ,/ i/ (/ t/ )/ 上/ 的/ 子/ 区间/ 的/ 一端/ 为/ 开区间/ ,/ 则/ 计算/ 出/ 的/ gj/ →/ i/ (/ t/ )/ 在/ 对应/ 区间/ 上/ 的/ 对应/ 一端/ 也/ 为/ 开区间/ ./ 当/ 在/ 区间/ [/ φ/ α/ j/ ,/ α/ j/ ]/ 内/ 的/ fj/ ,/ i/ (/ t/ )/ 都/ 找到/ 其/ 对应/ 的/ 最优/ gj/ (/ t/ )/ 后/ ,/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ φ/ α/ j/ +/ wj/ ,/ i/ ,/ α/ j/ +/ wj/ ,/ i/ ]/ 内/ 的/ 取值/ 即/ 计算/ 完毕/ ./ 此时/ ,/ 我们/ 令/ α/ j/ ←/ φ/ α/ j/ ,/ 并/ 在/ 区间/ [/ λ/ j/ ,/ α/ j/ ]/ 内/ 重复/ 以上/ 过程/ ./ 当/ φ/ α/ j/ =/ λ/ j/ 时/ ,/ 意味着/ 区间/ [/ λ/ j/ ,/ α/ j/ ]/ 内/ 的/ fj/ ,/ i/ (/ t/ )/ 均/ 可/ 找到/ 对应/ 的/ 最优/ gj/ (/ t/ )/ ,/ 因此/ ,/ 我们/ 可/ 计算/ 出/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ +/ wj/ ,/ i/ ,/ α/ j/ +/ wj/ ,/ i/ ]/ 内/ 的/ 取值/ ./ 至此/ ,/ gj/ →/ i/ (/ t/ )/ 在/ 全部/ 区间/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ 内/ 的/ 取值/ 计算/ 完毕/ ,/ 算法/ 结束/ ./ 我们/ 用图/ 2/ 中/ 的/ 例子/ 说明/ gj/ →/ i/ (/ t/ )/ 的/ 计算/ 过程/ ./ 如图/ 2/ 所示/ ,/ 图中/ 实线/ 代表/ 函数/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ ,/ ta/ -/ wj/ ,/ i/ ]/ 内/ 的/ 取值/ ,/ 图中/ 虚线/ 代表/ 函数/ gj/ (/ t/ )/ ./ 初始化/ 阶段/ ,/ α/ j/ =/ ta/ -/ wj/ ,/ i/ ./ 当/ t/ / α/ j/ 时/ ,/ gj/ (/ t/ )/ 的/ 最小/ 取值/ 为/ g/ α/ / α/ j/ ,/ 即/ 此时/ φ/ α/ j/ =/ φ/ 1/ 为/ φ/ 1/ α/ j/ ,/ ta/ -/ wj/ ,/ i/ ]/ 内/ 找到/ 对应/ 的/ 最优/ gj/ (/ t/ )/ ,/ 我们/ 可/ 根据/ [/ φ/ 1j/ 和/ fj/ ,/ i/ (/ t/ )/ 在/ 区间/ [/ φ/ 1g/ α/ / gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ φ/ 1/ 在/ 区间/ [/ φ/ 115/ +/ 10/ =/ 25/ ./ 第/ 2/ 次/ 迭代/ 中/ ,/ 算法/ 2/ 将/ α/ j/ 更新/ 为/ φ/ 1/ 此时/ ,/ t/ / α/ j/ 下能/ 取到/ gj/ (/ t/ )/ 的/ 最小值/ g/ α/ / 应/ 的/ φ/ α/ j/ 为/ λ/ j/ ./ 因为/ φ/ α/ j/ =/ λ/ j/ ,/ 算法/ 2/ 在/ 区间/ [/ λ/ j/ ,/ φ/ 1/ 内/ 找到/ fj/ ,/ i/ (/ t/ )/ 对应/ 的/ 最优/ gj/ (/ t/ )/ 为/ g/ α/ / 将/ gj/ →/ i/ (/ t/ )/ 在/ 区间/ [/ λ/ j/ →/ i/ ,/ φ/ 1j/ +/ fj/ ,/ i/ (/ t/ )/ =/ 20/ +/ 10/ =/ 30/ ./ 此时/ ,/ 在/ 全部/ 区间/ g/ α/ / [/ λ/ j/ ,/ ta/ -/ wj/ ,/ i/ ]/ 内/ ,/ fj/ ,/ i/ (/ t/ )/ 都/ 找到/ 与/ 之/ 对应/ 的/ 最优/ 的/ gj/ (/ t/ )/ ,/ 进而/ 函数/ gj/ →/ i/ (/ t/ )/ 在/ 全部/ 区间/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ 的/ 取值/ 也/ 计算/ 完毕/ ,/ 算法/ 结束/ ./ 下面/ ,/ 我们/ 给出/ 定理/ 证明/ 算法/ 2/ 的/ 正确性/ ./ 定理/ 1/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ vi/ ,/ vj/ ∈/ GT/ 且/ vj/ ∈/ N/ -/ (/ vi/ )/ ./ 令/ gj/ (/ t/ )/ 为/ 顶点/ vj/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ,/ 则/ 算法/ 2/ 计算/ 的/ gj/ →/ i/ (/ t/ )/ 是/ 在/ 此/ gj/ (/ t/ )/ 下/ 最优/ 的/ ,/ 即/ 如果/ 顶点/ vj/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 为/ gj/ (/ t/ )/ ,/ 则/ 对/ / t/ ∈/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ ,/ gj/ →/ i/ (/ t/ )/ 是/ 所有/ 通过/ 顶点/ vj/ 并且/ 在/ 时刻/ t/ 到达/ 顶点/ vi/ 的/ 路径/ 中/ 最小/ 的/ 费用/ 代价/ 取值/ ./ 证明/ ./ 不失/ 一般性/ ,/ 对/ / t/ ∈/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ ,/ 令/ j/ →/ i/ (/ t/ )/ 为/ 通过/ 顶点/ vj/ 并且/ 在/ 时刻/ t/ 到达/ vi/ 的/ 最/ 小费/ g/ / 用/ 代价/ ./ 我们/ 只/ 需/ 证明/ gj/ →/ i/ (/ t/ )/ =/ g/ / j/ →/ i/ (/ t/ )/ 为/ 最优/ 的/ 费用/ 代价/ ,/ 所以/ 有/ g/ / g/ / gj/ →/ i/ (/ t/ )/ ./ 下面/ ,/ 我们/ 证明/ gj/ →/ i/ (/ t/ )/ / g/ / j/ →/ i/ (/ t/ )/ 和/ gj/ →/ i/ (/ t/ )/ 所/ 代表/ 的/ 路径/ 都/ 是/ 在/ 时刻/ t/ 到达/ g/ / 顶点/ vi/ ,/ 所以/ 他们/ 离开/ 顶点/ vj/ 的/ 时刻/ 均/ 为/ t/ -/ wj/ ,/ i/ ,/ 从而/ 他们/ 通过/ 边/ (/ vj/ ,/ vi/ )/ 所/ 花费/ 的/ 费用/ 也/ 均/ 为/ fj/ ,/ i/ (/ t/ -/ wj/ ,/ i/ )/ ./ 由/ g/ / Page8/ 和/ 其中/ ,/ g/ / 代表/ 的/ 路径/ 中/ 到达/ 顶点/ vj/ 时/ 的/ 花费/ 的/ 费用/ 代价/ ,/ t/ / 和/ t/ 分别/ 为/ 其/ 到达/ 顶点/ vj/ 的/ 时刻/ ./ 显然/ ,/ 我们/ 有/ t/ / / t/ -/ wj/ ,/ i/ 和/ t/ / t/ -/ wj/ ,/ i/ ./ 根据/ 算法/ 2/ 可知/ ,/ gj/ (/ t/ )/ 选取/ 的/ 是/ t/ / t/ -/ wj/ ,/ i/ 条件/ 下/ 函数/ gj/ (/ t/ )/ 能/ 取得/ 的/ 最小/ 函数/ 值/ ,/ 因此/ ,/ 我们/ 有/ gj/ (/ t/ )/ / g/ / gj/ →/ i/ (/ t/ )/ / g/ / 定理/ 1/ 说明/ 了/ 算法/ 2/ 得到/ 的/ gj/ →/ i/ (/ t/ )/ 是/ 最优/ 的/ ./ 令/ gi/ (/ t/ )/ 为/ 顶点/ vi/ 上/ 现有/ 的/ 到达/ 时间/ -/ 代价/ 函数/ (/ 可能/ 不是/ 最优/ 的/ )/ ,/ 可以/ 根据/ gj/ →/ i/ (/ t/ )/ 来/ 更新/ gi/ (/ t/ )/ ./ 对/ / t/ ∈/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ ,/ 有/ 由于/ gi/ (/ t/ )/ 和/ gj/ →/ i/ (/ t/ )/ 均/ 为/ 分段/ 常量/ 函数/ ,/ 在/ 对应/ 的/ 每个/ 时间/ 子/ 区间/ 内/ ,/ 只/ 需取/ gj/ →/ i/ (/ t/ )/ 和/ gi/ (/ t/ )/ 的/ 最小值/ 作为/ 更新/ 后/ gi/ (/ t/ )/ 的/ 函数/ 值/ 即可/ ./ 图/ 3/ 中/ 的/ 例子/ 展示/ 了/ 如何/ 更新/ gi/ (/ t/ )/ ./ 图/ 3/ (/ a/ )/ 中/ ,/ 虚线/ 为/ gj/ →/ i/ (/ t/ )/ ,/ 实线/ 为/ 现有/ 的/ gi/ (/ t/ )/ ./ 我们/ 发现/ 在/ 区间/ [/ 5/ ,/ 15/ ]/ 内/ ,/ gj/ →/ i/ (/ t/ )/ 取值/ 为/ 20/ ,/ 小于/ gi/ (/ t/ )/ 取值/ ./ 因此/ ,/ 区间/ [/ 5/ ,/ 15/ ]/ 内/ 的/ gi/ (/ t/ )/ 取值/ 更新/ 为/ 20/ ./ 区间/ [/ 25/ ,/ 30/ ]/ 和/ [/ 30/ ,/ 35/ ]/ 内/ gj/ →/ i/ (/ t/ )/ 取值/ 分别/ 为/ 15/ 和/ 20/ ,/ 均/ 小于/ gi/ (/ t/ )/ ./ 因此/ ,/ 区间/ [/ 25/ ,/ 30/ ]/ 内/ gi/ (/ t/ )/ 更新/ 为/ 15/ ,/ 区间/ [/ 30/ ,/ 35/ ]/ 内/ gi/ (/ t/ )/ 更新/ 为/ 20/ ./ 图/ 3/ (/ b/ )/ 中/ 给出/ 了/ 更新/ 后/ 的/ gi/ (/ t/ )/ 函数/ ./ gi/ (/ t/ )/ =/ min/ {/ gj/ →/ i/ (/ t/ )/ ,/ gi/ (/ t/ )/ |/ t/ ∈/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ }/ ./ 在/ 本节/ 中/ ,/ 我们/ 介绍/ 算法/ 1/ 的/ 第/ 1/ 阶段/ ,/ 即/ 如何/ 3.2/ 计算/ 到达/ 终点/ 的/ 最小/ 费用/ 代价/ 计算/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ ./ 3.2/ ./ 1/ 计算/ 到达/ 终点/ 的/ 最小/ 费用/ 代价/ 预处理/ 阶段/ ,/ 我们/ 需/ 计算/ 起点/ vs/ 到/ 图/ 中/ 任意/ 顶点/ vi/ 的/ 最早/ 到达/ 时间/ λ/ i/ ./ 考虑/ 仅以/ 时间/ 代价/ wi/ ,/ j/ 为/ 权值/ 的/ 图/ GT/ ,/ 我们/ 在/ GT/ 上/ 运行/ 现有/ 最快/ 的/ 单源/ 最/ 短/ 路径/ 算法/ ,/ 即可/ 计算/ 出/ 到达/ 各个/ 顶点/ vi/ 的/ 最小/ 时间/ 代价/ ./ 将/ 该/ 时间/ 代价/ 与/ 最早/ 出发/ 时刻/ td/ 相加/ ,/ 即可/ 计算/ 出/ 各个/ 顶点/ vi/ 的/ 最早/ 到达/ 时刻/ λ/ i/ ./ 目前/ ,/ 最快/ 的/ 单源/ 最/ 短/ 路径/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ nlogn/ +/ m/ )/ ./ 我们/ 用/ g/ / e/ (/ t/ / )/ 表示/ 终点/ ve/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ge/ (/ t/ )/ 在/ 区间/ [/ λ/ e/ ,/ ta/ ]/ 上/ 的/ 最小值/ ,/ 则/ g/ / e/ (/ t/ / )/ 即/ 为/ 满足/ 时间/ 限制/ 的/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ ./ 本节/ 的/ 目标/ 即/ 是/ 计算/ g/ / e/ (/ t/ / )/ ./ 算法/ 3/ 给出/ 了/ 计算/ g/ / e/ (/ t/ / )/ 的/ 流程/ ./ 对图/ 中/ 任意/ 顶点/ vi/ ,/ 我们/ 用/ Ti/ 表示/ 顶点/ vi/ 最早/ -/ 最/ 晚/ 到达/ 时刻/ 区间/ ,/ 即/ Ti/ =/ [/ λ/ i/ ,/ ta/ ]/ ./ 算法/ 3/ 逐步/ 地/ 更新/ 区间/ [/ λ/ i/ ,/ ta/ ]/ 内/ 的/ 函数/ gi/ (/ t/ )/ ./ 我们/ 用/ Si/ 表示/ gi/ (/ t/ )/ 已/ 确定/ 取值/ 的/ 区间/ ,/ 用/ τ/ i/ 表示/ 当前/ 的/ gi/ (/ t/ )/ 在/ Ti/ -/ Si/ 上/ 的/ 最小/ 取值/ ./ 算法/ 3/ ./ 最小/ 费用/ 代价/ 计算/ 算法/ ./ Computing/ -/ g/ / e/ (/ t/ / )/ (/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ )/ 输入/ :/ 时间/ 依赖图/ GT/ ,/ 起点/ vs/ ,/ 终点/ ve/ ,/ 最早/ 出发/ 时刻/ 输出/ :/ g/ / e/ (/ t/ / )/ 1/ ./ gs/ (/ t/ )/ ←/ 0/ ;/ τ/ s/ ←/ 0/ ;/ Ss/ ←/ Ts2/ ./ QbethepriorityqueueinitiallycontainingV/ ;/ vi/ ←/ vs/ ;/ 3/ ./ whilevi/ ≠/ vedo4/ ./ Let/ [/ tai/ ,/ tbi/ ]/ bethetimeslot/ τ/ icorrespondingto/ ;/ 5/ ./ gi/ (/ t/ |/ t/ ∈/ [/ tai/ ,/ tbi/ ]/ )/ ←/ τ/ i/ ;/ Si/ ←/ Si/ ∪/ [/ tai/ ,/ tbi/ ]/ ;/ 6/ ./ foreachvj/ ∈/ N/ +/ (/ vi/ )/ do7/ ./ Updating/ -/ gj/ (/ t/ )/ (/ gj/ (/ t/ )/ ,/ gi/ (/ t/ )/ ,/ fi/ ,/ j/ (/ t/ )/ )/ ;/ 8/ ./ τ/ j/ ←/ min/ {/ gj/ (/ t/ )/ |/ t/ ∈/ Tj/ -/ Sj/ }/ ;/ 9/ ./ ifSi/ ≠/ Tithen10/ ./ τ/ i/ ←/ min/ {/ gi/ (/ t/ )/ |/ t/ ∈/ Tj/ -/ Sj/ }/ ;/ 11/ ./ enqueue/ (/ Q/ ,/ vi/ )/ ;/ 12/ ./ vi/ ←/ dequeue/ (/ Q/ )/ ;/ 13/ ./ g/ / e/ (/ t/ / )/ ←/ τ/ i/ ;/ 14/ ./ returng/ / e/ (/ t/ / )/ ./ 初始化/ 阶段/ ,/ 对于/ 起点/ vs/ ,/ 其/ gs/ (/ t/ )/ 、/ Ss/ 和/ τ/ s/ 被/ 初始化/ 为/ gs/ (/ t/ )/ ←/ 0/ ,/ Ss/ ←/ Ts/ ,/ τ/ s/ ←/ 0/ ./ 显然/ ,/ 如果/ 从/ 起点/ vs/ 出发/ ,/ 则/ 在/ 任何时刻/ t/ 到达/ 起点/ vs/ 的/ 最小/ 费用/ 代价/ 均/ 为/ 0/ ./ 因此/ ,/ 函数/ gs/ (/ t/ )/ 在/ 全部/ 区间/ 上/ 是/ 一个/ 取值/ 为/ 零/ 的/ 常数/ ./ 对于/ 其它/ 任意/ 顶点/ vi/ ≠/ vs/ ,/ 其/ gi/ (/ t/ )/ 、/ Si/ 和/ τ/ i/ 分别/ 被/ 初始化/ 为/ gi/ (/ t/ )/ ←/ ,/ Si/ ←/ / ,/ τ/ i/ ←/ ./ 这/ 意味着/ 在/ 任何/ 区间/ 上/ 都/ 没有/ 确定/ 函数/ gi/ (/ t/ )/ 的/ 取值/ ./ 我们/ 使用/ 一个/ 优先/ 队列/ Q/ 维护/ 图中/ 的/ 顶点/ ./ 优先/ 队列/ Q/ 根据/ τ/ i/ 的/ 取值/ 由小至/ 大地/ 弹/ 出/ 队列/ 中/ 的/ 顶点/ ./ 初始/ 阶段/ ,/ 队列/ Q/ 包括/ 全部/ 顶点/ vi/ ∈/ V/ ./ 当/ 终点/ ve/ 第/ 1/ 次/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ 算法/ 结束/ ./ 在/ 每次/ 迭代/ 中/ ,/ τ/ i/ 取值/ 最小/ 的/ 顶点/ vi/ 从/ 队列/ Q/ 中弹/ 出/ ./ 令/ τ/ i/ 取值/ 对应/ 的/ 区间/ 为/ [/ tai/ ,/ tbi/ ]/ ./ 因此/ ,/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ 在/ [/ tai/ ,/ tbi/ ]/ 上/ 的/ 取/ Page9/ 值/ 即/ 为/ τ/ i/ ./ 这一/ 事实/ 我们/ 将/ 在/ 下面/ 给出/ 定理/ 证明/ ./ 我们/ 将/ 区间/ [/ tai/ ,/ tbi/ ]/ 加入/ 顶点/ vi/ 的/ 已/ 确定/ 区间/ 集合/ Si/ 来/ 更新/ Si/ ,/ 即/ Si/ ←/ Si/ ∪/ [/ tai/ ,/ tbi/ ]/ ./ 然后/ ,/ 对/ 顶点/ vi/ 的/ 所有/ 出边/ 邻居/ vj/ ∈/ N/ +/ (/ vi/ )/ ,/ 根据/ 算法/ 2/ 更新/ 区间/ [/ λ/ i/ →/ j/ ,/ ta/ ]/ 内/ 的/ gj/ (/ t/ )/ ./ 同时/ ,/ 算法/ 更新/ τ/ i/ ./ 当/ 算法/ 更新/ 完/ 顶点/ vi/ 的/ 所有/ 出边/ 邻居/ vj/ 的/ gj/ (/ t/ )/ 后/ ,/ 算法/ 判断/ gi/ (/ t/ )/ 的/ 取值/ 是否/ 在/ 全部/ 区间/ 上/ 已经/ 被/ 确定/ ,/ 即/ 是否/ Si/ =/ Ti/ ./ 如果/ Si/ =/ Ti/ ,/ 则/ 函数/ gi/ (/ t/ )/ 在/ 全部/ 区间/ Ti/ =/ [/ λ/ i/ ,/ ta/ ]/ 内/ 的/ 取值/ 已经/ 确定/ ,/ 这/ 说明/ gi/ (/ t/ )/ 在/ 任意/ 时刻/ t/ ∈/ Ti/ 的/ 取值/ 不/ 可能/ 被/ 更新/ 得/ 更/ 小/ ./ 因此/ ,/ 我们/ 可以/ 将/ 顶点/ vi/ 从/ 队列/ Q/ 中/ 移除/ ./ 如果/ Si/ ≠/ Ti/ ,/ 我们/ 则/ 计算/ 当前/ gi/ (/ t/ )/ 在/ 区间/ Ti/ -/ Si/ 内/ 的/ 最小值/ τ/ i/ ,/ 并/ 将/ 顶点/ vi/ 重新/ 插回/ 队列/ Q/ 中/ ./ 这里/ 注意/ 的/ 是/ :/ 当前/ 的/ gi/ (/ t/ )/ 不/ 一定/ 是/ 最优/ 的/ ,/ 当/ 顶点/ vi/ 的/ 入边/ 邻居/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ gi/ (/ t/ )/ 可能/ 会/ 被/ 更新/ ,/ 同时/ ,/ τ/ i/ 也/ 会/ 被/ 更新/ ./ 当/ 终点/ ve/ 第/ 1/ 次/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ ve/ 对应/ 的/ τ/ e/ 是/ 即/ 函数/ ge/ (/ t/ )/ 在/ 全部/ 区间/ [/ λ/ e/ ,/ ta/ ]/ 上/ 的/ 最小/ 取值/ g/ / e/ (/ t/ / )/ (/ 此/ 事实/ 我们/ 将/ 给出/ 定理/ 证明/ )/ ./ 因此/ ,/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ g/ / e/ (/ t/ / )/ 已经/ 被/ 计算出来/ ,/ 图/ 4/ 图/ 1/ 例中/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 更新过程/ 第/ 2/ 次/ 迭代/ 中/ ,/ 我们/ 发现/ 顶点/ v3/ 在/ 未确定/ 区间/ T3/ -/ S3/ 上/ 的/ 最小/ 取值/ 为/ τ/ 3/ =/ 5/ ./ τ/ 3/ 取值/ 在/ 队列/ Q/ 中/ 最小/ ,/ 因此/ 顶点/ v3/ 被/ 弹出/ ./ 如图/ 4/ (/ b/ )/ 所示/ ,/ 我们/ 发现/ τ/ 3/ =/ 5/ 对应/ 的/ 取值/ 区间/ 为/ [/ 30/ ,/ 60/ ]/ ,/ 因此/ ,/ 区间/ [/ 30/ ,/ 60/ ]/ 内/ 的/ g3/ (/ t/ )/ 取值/ 即/ 被/ 确定/ 为/ 5/ ./ 我们/ 将/ 区间/ [/ 30/ ,/ 60/ ]/ 加入/ S3/ ,/ 即/ 此时/ S3/ =/ [/ 30/ ,/ 60/ ]/ ./ 顶点/ v4/ 为/ 顶/ 算法/ 终止/ ./ 3.2/ ./ 2/ 例子/ 演示/ 说明/ 我们/ 用图/ 1/ 中/ 所示/ 的/ 例子/ 来/ 演示/ 运算/ 过程/ ./ 在/ 该/ 例中/ ,/ 我们/ 给出/ 费用/ 最优/ 路径/ 查询/ ,/ 该/ 查询/ 中/ ,/ vs/ =/ v1/ ,/ ve/ =/ v4/ ,/ td/ =/ 0/ ,/ ta/ =/ 60/ ./ 首先/ 利用/ 现有/ 的/ 最/ 短/ 路径/ 算法/ 计算/ 出/ GT/ 中/ 各个/ 顶点/ v1/ ,/ v2/ ,/ v3/ ,/ v4/ 的/ 最早/ 到达/ 时间/ :/ t1/ =/ 0/ ,/ t2/ =/ 10/ ,/ t3/ =/ 15/ ,/ t4/ =/ 25/ ./ 因此/ ,/ 函数/ g1/ (/ t/ )/ ,/ g2/ (/ t/ )/ ,/ g3/ (/ t/ )/ 和/ g4/ (/ t/ )/ 的/ 取值/ 区间/ 分别/ 为/ T1/ =/ [/ 0/ ,/ 60/ ]/ ,/ T2/ =/ [/ 10/ ,/ 60/ ]/ ,/ T3/ =/ [/ 15/ ,/ 60/ ]/ 和/ T4/ =/ [/ 25/ ,/ 60/ ]/ ./ 图/ 4/ 给出/ 了/ 计算/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ 的/ 过程/ ./ 初始化/ 阶段/ ,/ 优先/ 队列/ Q/ 仅/ 包含/ 起点/ v1/ ,/ 其/ 对应/ 的/ τ/ 1/ =/ 0/ ,/ S1/ =/ T1/ ,/ g1/ (/ t/ )/ =/ 0/ ./ 这/ 意味着/ ,/ 在/ 任何时刻/ t/ ∈/ T1/ ,/ 到达/ v1/ 的/ 费用/ 代价/ 为/ 0/ ./ 因为/ ,/ 从/ v1/ 到/ v1/ 不/ 需要/ 花费/ 任何/ 费用/ ./ 当/ v1/ 从/ 队列/ 中弹/ 出后/ ,/ 对/ v1/ 的/ 两个/ 出边/ 邻居/ v2/ ,/ v3/ ,/ 算法/ 分别/ 计算/ g1/ →/ 2/ (/ t/ )/ 和/ g1/ →/ 3/ (/ t/ )/ ,/ 并/ 更新/ g2/ (/ t/ )/ 和/ g3/ (/ t/ )/ ./ g2/ (/ t/ )/ 和/ g3/ (/ t/ )/ 在/ 本次/ 迭代/ 后/ 的/ 取值/ 如图/ 4/ (/ a/ )/ 和/ 图/ 4/ (/ b/ )/ 所示/ ./ 顶点/ v2/ 和/ v3/ 插入/ 队列/ ./ 因为/ S1/ =/ T1/ ,/ 即/ g1/ (/ t/ )/ 在/ 全部/ 区间/ 上/ 的/ 取值/ 已经/ 确定/ ,/ 所以/ ,/ v1/ 从/ 队列/ Q/ 中/ 移除/ ./ 点/ v3/ 的/ 出边/ 邻居/ ,/ 我们/ 计算/ g3/ →/ 4/ (/ t/ )/ 并/ 更新/ g4/ (/ t/ )/ ./ 本次/ 迭代/ 后/ 的/ g4/ (/ t/ )/ 在/ 图/ 4/ (/ c/ )/ 中/ 给出/ ./ 顶点/ v4/ 插入/ 队列/ ./ 此时/ ,/ g3/ (/ t/ )/ 的/ 未确定/ 取值/ 区间/ 变为/ T3/ -/ S3/ =/ [/ 15/ ,/ 30/ ]/ ,/ 且/ 当前/ g3/ (/ t/ )/ 在/ T3/ -/ S3/ 上/ 的/ 最小值/ 为/ 20/ ./ 因此/ ,/ τ/ 3/ 被/ 赋值/ 20/ ,/ 顶点/ v3/ 被/ 重新/ 插回/ 队列/ Q/ 中/ ./ 第/ 3/ 次/ 迭代/ 中/ ,/ 顶点/ v2/ 在/ 未确定/ 区间/ T2/ -/ S2/ 内/ Page10/ 的/ 最小/ 取值/ 为/ τ/ 2/ =/ 10/ ./ τ/ 2/ 取值/ 在/ 队列/ Q/ 中/ 最小/ ,/ 因此/ 顶点/ v2/ 被/ 弹出/ ./ 如图/ 4/ (/ a/ )/ 所示/ ,/ 我们/ 发现/ τ/ 2/ =/ 10/ 对应/ 的/ 取值/ 区间/ 为/ [/ 10/ ,/ 60/ ]/ ,/ 因此/ ,/ g2/ (/ t/ )/ 在/ 全部/ 区间/ T2/ 上/ 的/ 取值/ 即/ 被/ 确定/ 为/ 10/ ./ 顶点/ v3/ 和/ 顶点/ v4/ 为/ 顶点/ v2/ 的/ 两个/ 出边/ 邻居/ ,/ 我们/ 分别/ 更新/ g3/ (/ t/ )/ 和/ g4/ (/ t/ )/ ,/ 更新/ 后/ 的/ g3/ (/ t/ )/ 和/ g4/ (/ t/ )/ 分别/ 在/ 图/ 4/ (/ d/ )/ 和/ 图/ 4/ (/ e/ )/ 中/ 给出/ ./ 此时/ ,/ g3/ (/ t/ )/ 在/ 未确定/ 区间/ T3/ -/ S3/ 内/ 的/ 最小值/ τ/ 3/ 也/ 被/ 更新/ 为/ 15/ ./ 由于/ g2/ (/ t/ )/ 在/ 全部/ 区间/ T2/ 上/ 的/ 取值/ 已经/ 确定/ ,/ 因此/ ,/ 顶点/ v2/ 从/ 队列/ Q/ 中/ 移除/ ./ 第/ 4/ 次/ 迭代/ 中/ ,/ 顶点/ v3/ 在/ 未确定/ 区间/ T3/ -/ S3/ =/ [/ 15/ ,/ 30/ ]/ 内/ 的/ 最小/ 取值/ 为/ τ/ 3/ =/ 15/ ,/ τ/ 3/ 取值/ 在/ 队列/ Q/ 中/ 最小/ ,/ 顶点/ v3/ 被/ 弹出/ ./ 如图/ 4/ (/ d/ )/ 所示/ ,/ τ/ 3/ =/ 15/ 对应/ 的/ 区间/ 为/ [/ 20/ ,/ 30/ ]/ ,/ g3/ (/ t/ )/ 在/ 区间/ [/ 20/ ,/ 30/ ]/ 内/ 的/ 取值/ 即/ 被/ 确定/ 为/ 15/ ./ 我们/ 将/ 区间/ [/ 20/ ,/ 30/ ]/ 加入/ S3/ ./ 此时/ ,/ S3/ =/ [/ 20/ ,/ 60/ ]/ ./ g3/ (/ t/ )/ 的/ 未确定/ 取值/ 区间/ 变为/ T3/ -/ S3/ =/ [/ 15/ ,/ 20/ ]/ ./ 根据/ 当前/ 的/ g3/ (/ t/ )/ 更新/ v3/ 的/ 出边/ 邻居/ v4/ 的/ g4/ (/ t/ )/ ,/ 更新/ 结果/ 在/ 图/ 4/ (/ f/ )/ 中/ 给出/ ./ 当前/ g3/ (/ t/ )/ 在/ 未确定/ 取值/ 区间/ [/ 15/ ,/ 20/ ]/ 内/ 的/ 最小值/ 为/ 20/ ,/ 因此/ ,/ τ/ 3/ 被/ 更新/ 为/ 20/ ,/ 顶点/ v3/ 被/ 重新/ 插入/ 队列/ Q/ 中/ ./ 第/ 5/ 次/ 迭代/ 中/ ,/ 顶点/ v4/ 在/ 未确定/ 区间/ T4/ 上/ 的/ 最小/ 取值/ 为/ τ/ 4/ =/ 20/ ,/ τ/ 4/ 取值/ 在/ 队列/ Q/ 中/ 最小/ ,/ 顶点/ v4/ 被/ 弹出/ ./ 因为/ v4/ 为/ 终点/ ,/ 算法/ 结束/ ./ 起点/ v1/ 到/ 终点/ v4/ 的/ 最小/ 代价/ 即为/ 20/ ,/ τ/ 4/ 对应/ 的/ 时间/ 区间/ 为/ [/ 30/ ,/ 35/ ]/ ./ 3.2/ ./ 3/ 正确性/ 证明/ 下面/ 证明/ 算法/ 3/ 的/ 正确性/ ,/ 我们/ 首先/ 给出/ 定理/ 2/ 证明/ 当/ 顶点/ vi/ 从/ 队列/ 中弹/ 出时/ ,/ 在/ τ/ i/ 取值/ 对应/ 的/ 区间/ 内/ ,/ 真正/ 的/ gi/ (/ t/ )/ 的/ 取值/ 即/ 为/ τ/ i/ ./ 定理/ 2/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ 令/ vi/ 为/ 算法/ 3/ 第/ k/ 次/ 迭代/ 过程/ 中/ 从/ 队列/ Q/ 中弹/ 出/ 的/ 顶点/ ,/ 其/ τ/ i/ 对应/ 区间/ 为/ [/ tai/ ,/ tbi/ ]/ ,/ 则/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ 在/ 区间/ [/ tai/ ,/ tbi/ ]/ 上/ 的/ 取值/ 即/ 为/ τ/ i/ ./ 证明/ ./ 只/ 需/ 证明/ 对/ 任意/ 时刻/ t0/ ∈/ [/ tai/ ,/ tbi/ ]/ ,/ gi/ (/ t0/ )/ =/ τ/ i/ 即可/ ./ 因为/ gi/ (/ t/ )/ 是/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ,/ 根据/ 定义/ ,/ 我们/ 可知/ gi/ (/ t0/ )/ / τ/ i/ ./ 下面/ ,/ 证明/ τ/ i/ / gi/ (/ t0/ )/ ./ 不失/ 一般性/ ,/ 设在/ 时刻/ t0/ 到达/ 顶点/ vi/ 且/ 费用/ 代价/ 为/ gi/ (/ t0/ )/ 的/ 路径/ 为/ 因此/ ,/ 沿着/ 该/ 路径/ p/ ,/ 到达/ 顶点/ vx/ (/ 1/ / x/ / h/ )/ 的/ 时刻/ 和/ 费用/ 代价/ 分别/ 为/ tx/ 和/ gx/ (/ tx/ )/ ./ 以示/ 区分/ ,/ 我们/ 用/ gkx/ (/ tx/ )/ 表示/ 在/ 第/ k/ 次/ 迭代/ 时/ 顶点/ vx/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ./ 这里/ 需要/ 注意/ 的/ 是/ ,/ gkx/ (/ t/ )/ 不/ 一定/ 等于/ 顶点/ vx/ 真正/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gx/ (/ t/ )/ ./ 我们/ 首先/ 考虑/ 顶点/ vh/ ,/ 在/ 第/ k/ 次/ 迭代/ 时/ ,/ gk/ 的/ 取值/ 为/ gkgh/ (/ th/ )/ ;/ (/ 2/ )/ gk/ 优的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 在/ 时刻/ th/ 的/ 取值/ ,/ 则/ 不/ 可能/ 出现/ gkfh/ ,/ i/ (/ t0/ -/ wh/ ,/ i/ )/ 又/ 分为/ 两种/ 情况/ :/ (/ a/ )/ fh/ ,/ i/ (/ t0/ -/ wh/ ,/ i/ )/ =/ 0/ ;/ (/ b/ )/ fh/ ,/ i/ (/ t0/ -/ wh/ ,/ i/ )/ ≠/ 0/ ./ 在/ 情况/ (/ a/ )/ 下/ ,/ 若/ 时刻/ th/ 的/ gh/ (/ t/ )/ 的/ 取值/ 已经/ 被/ 确定/ ,/ 则/ 意味着/ 顶点/ vh/ 已经/ 在/ h/ (/ th/ )/ 时/ 从/ 队列/ Q/ 中弹/ 出过/ ./ 因此/ ,/ 算法/ 3/ 已经/ τ/ h/ =/ gkh/ (/ th/ )/ 更新/ 过/ gi/ (/ t/ )/ 的/ 取值/ ./ 根据/ 算法/ 2/ 的/ 正确/ 利用/ gk/ 性/ ,/ 我们/ 有/ τ/ i/ / gk/ 取值/ 未/ 被/ 确定/ ,/ 则/ τ/ i/ =/ gk/ τ/ i/ ,/ 此时/ 应该/ 弹/ 出/ 顶点/ vh/ ,/ 与/ 条件/ 矛盾/ ./ 注意/ :/ gk/ 不/ 可能/ 大于/ τ/ i/ ./ 因为/ gk/ 和/ gi/ (/ t0/ )/ / τ/ i/ ,/ 所以/ gk/ 们/ 得出/ τ/ i/ / gh/ (/ th/ )/ =/ gh/ (/ th/ )/ +/ fh/ ,/ i/ (/ t0/ -/ wh/ ,/ i/ )/ =/ gi/ (/ t0/ )/ ./ 我们/ 考虑/ 情况/ (/ b/ )/ ,/ 因为/ fh/ ,/ i/ (/ t0/ -/ wh/ ,/ i/ )/ ≠/ 0/ ,/ 所以/ h/ (/ th/ )/ =/ gh/ (/ th/ )/ </ gi/ (/ t0/ )/ ./ 这/ 意味着/ 顶点/ vh/ 已经/ 在/ gkh/ (/ th/ )/ 时/ 从/ 对列/ Q/ 中弹/ 出过/ ./ 因此/ ,/ 算法/ 3/ 已经/ τ/ h/ =/ gkh/ (/ th/ )/ 更新/ 过/ gi/ (/ t/ )/ 的/ 取值/ ./ 根据/ 算法/ 2/ 的/ 正确/ 利用/ gk/ 性/ ,/ 我们/ 有/ τ/ i/ / gk/ 因此/ ,/ 在/ 情况/ (/ 1/ )/ 下/ ,/ 有/ τ/ i/ / gi/ (/ t0/ )/ ./ 下面/ ,/ 讨论/ 情况/ (/ 2/ )/ ,/ 我们/ 证明/ 情况/ (/ 2/ )/ 不/ 可能/ 发生/ ./ 为/ 证明/ 此/ 事实/ ,/ 我们/ 考虑/ 顶点/ vh/ -/ 1/ ,/ 在/ 第/ k/ 次/ 迭代/ 时/ ,/ gkh/ -/ 1/ (/ th/ -/ 1/ )/ 同样/ 分为/ 两种/ 情况/ :/ gkh/ -/ 1/ (/ th/ -/ 1/ )/ =/ gh/ -/ 1/ (/ th/ -/ 1/ )/ 和/ gkh/ -/ 1/ (/ th/ -/ 1/ )/ >/ gh/ -/ 1/ (/ th/ -/ 1/ )/ ./ 类似/ 证明/ 情况/ (/ 1/ )/ 下/ 的/ τ/ i/ =/ gi/ (/ t0/ )/ ,/ 我们/ 证明/ 在/ gkh/ -/ 1/ (/ th/ -/ 1/ )/ =/ gh/ -/ 1/ (/ th/ -/ 1/ )/ 时/ ,/ 有/ gk/ 因此/ ,/ 只/ 需/ 证明/ gkh/ -/ 1/ (/ th/ -/ 1/ )/ >/ gh/ -/ 1/ (/ th/ -/ 1/ )/ 不/ 可能/ 发生/ ./ 类似/ 地/ ,/ 我们/ 仅/ 需要/ 证明/ gkh/ -/ 2/ (/ th/ -/ 2/ )/ >/ gh/ -/ 2/ (/ th/ -/ 2/ )/ 不/ 可能/ 发生/ ,/ 递归/ 地/ ,/ 仅/ 需/ 证明/ gk1/ (/ t1/ )/ >/ g1/ (/ t1/ )/ 不/ 可能/ 发生/ ./ 因为/ g1/ (/ t1/ )/ 在/ 第/ 1/ 次/ 迭代/ 中/ ,/ 即/ 起点/ vs/ 从/ 队列/ Q/ 中弹/ 出时/ 已经/ 被/ 计算/ 出/ ,/ 则/ gk1/ (/ t1/ )/ =/ g1/ (/ t1/ )/ ./ 矛盾/ ./ 因此/ ,/ 情况/ (/ 2/ )/ 不/ 可能/ 发生/ ./ 综上所述/ ,/ 我们/ 得出/ τ/ i/ / gi/ (/ t0/ )/ ./ 因此/ ,/ τ/ i/ =/ gi/ (/ t0/ )/ ./ 定理/ 2/ 说明/ ,/ 每次/ 顶点/ vi/ 根据/ τ/ i/ 的/ 取值/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ 在/ τ/ i/ 对应/ 区间/ 上/ 的/ 取值/ 即/ 为/ τ/ i/ ./ 当/ 算法/ 3/ 把/ 全部/ 区间/ 上/ 的/ gi/ (/ t/ )/ 取值/ 确定/ 时/ ,/ 该/ gi/ (/ t/ )/ 即/ 为/ 真正/ 的/ gi/ (/ t/ )/ ./ 下面/ 给出/ 定理/ 3/ 证明/ ,/ τ/ i/ 即为/ 顶点/ vi/ 的/ 真正/ 的/ gi/ (/ t/ )/ 在/ 区间/ Ti/ -/ Si/ 内/ 的/ 最小/ 取值/ ./ 定理/ 3/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ 令/ vi/ 为/ 算法/ 3/ 第/ k/ 次/ 迭代/ 时/ 从/ 队列/ Q/ 中弹/ 出/ 的/ 顶点/ ,/ gi/ (/ t/ )/ 为/ 顶点/ vi/ 的/ 真正/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ,/ 则/ 此时/ 的/ τ/ i/ 即为/ Page11gi/ (/ t/ )/ 在/ 区间/ Ti/ -/ Si/ 上/ 的/ 最小值/ ./ 证明/ ./ 反证法/ ./ 假设/ 存在/ 时刻/ t0/ ∈/ Ti/ -/ Si/ ,/ 使得/ gi/ (/ t0/ )/ </ τ/ i/ ./ 不失/ 一般性/ ,/ 我们/ 设在/ 时刻/ t0/ 到达/ 顶点/ vi/ 且/ 费用/ 代价/ 为/ gi/ (/ t0/ )/ 的/ 路径/ 为/ 沿着/ 该/ 路径/ p/ ,/ 到达/ 顶点/ vx/ (/ 1/ / x/ / h/ )/ 的/ 时刻/ 和/ 费用/ 代价/ 分别/ 为/ tx/ 和/ gx/ (/ tx/ )/ ./ 与/ 定理/ 1/ 证明/ 类似/ ,/ 我们/ 用/ gkx/ (/ t/ )/ 表示/ 在/ 第/ k/ 次/ 迭代/ 时/ 顶点/ vx/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ ./ gki/ (/ t0/ )/ 的/ 取值/ 只能/ 分为/ 两种/ 情况/ :/ (/ 1/ )/ gki/ (/ t0/ )/ =/ gi/ (/ t0/ )/ ;/ (/ 2/ )/ gki/ (/ t0/ )/ >/ gi/ (/ t0/ )/ ./ 在/ 情况/ (/ 1/ )/ 下/ ,/ 因为/ gki/ (/ t0/ )/ =/ gi/ (/ t0/ )/ </ τ/ i/ ,/ 所以/ 顶点/ vi/ 会/ 根据/ gki/ (/ t0/ )/ 取值/ 弹/ 出/ ,/ 与/ 条件/ 矛盾/ ./ 因此/ ,/ 我们/ 只/ 需/ 证明/ 情况/ (/ 2/ )/ 不会/ 发生/ ./ 此/ 证明/ 过程/ 与/ 证明/ 定理/ 1/ 中/ 情况/ (/ 2/ )/ 的/ 过程/ 相同/ ./ 因为/ 情况/ (/ 1/ )/ 下/ 出现/ 矛盾/ ,/ 情况/ (/ 2/ )/ 不会/ 发生/ ,/ 所以/ 假设/ 不/ 正确/ ,/ 定理/ 得证/ ./ 证毕/ ./ 定理/ 3/ 说明/ 了/ 顶点/ vi/ 跟据/ τ/ i/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ τ/ i/ 即为/ gi/ (/ t/ )/ 在/ 未确定/ 取值/ 区间/ Ti/ -/ Si/ 内/ 的/ 最小/ 取值/ ./ 因此/ ,/ 当/ 终点/ ve/ 首次/ 从/ 队列/ Q/ 中弹/ 出时/ ,/ 其/ τ/ e/ 即为/ ge/ (/ t/ )/ 全部/ 区间/ Te/ 上/ 的/ 最小值/ ,/ 即/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最小/ 费用/ 代价/ g/ / e/ (/ t/ / )/ ./ 推论/ 1/ ./ 给定/ 时间/ 依赖图/ GT/ ,/ 对于/ 顶点/ vi/ ,/ 设/ i/ 和/ τ/ qi/ 为/ 顶点/ vi/ 第/ p/ 次/ 和/ 第/ q/ 次/ 从/ 队列/ Q/ 中弹/ 出/ τ/ p/ 时/ 的/ τ/ i/ 取值/ ,/ 若/ p/ </ q/ ,/ 则/ τ/ p/ 队列/ Q/ 中弹/ 出时/ 的/ Si/ ,/ 因为/ p/ </ q/ ,/ 所以/ Sp/ 此/ ,/ Ti/ -/ Spi/ 和/ Ti/ -/ SqSp3/ ./ 3/ 寻找/ 最优/ 路径/ 和/ 最佳/ 等待时间/ 下面/ 介绍/ 算法/ 的/ 第/ 2/ 阶段/ ,/ 即/ 如何/ 根据/ 最小/ 费用/ 代价/ g/ / e/ (/ t/ / )/ 找到/ 起点/ vs/ 到/ 终点/ ve/ 的/ 最优/ 路径/ p/ / ,/ 以及/ p/ / 上/ 的/ 每个/ 顶点/ 的/ 最佳/ 等待时间/ ω/ / (/ vi/ )/ ,/ 使得/ 路径/ p/ / 的/ 代价/ 等于/ 最小/ 费用/ 代价/ g/ / e/ (/ t/ / )/ ./ 算法/ 4/ 给出/ 了/ 计算/ 最优/ 路径/ p/ / 和/ 最佳/ 等待时间/ ω/ / (/ vi/ )/ 的/ 过程/ ./ 算法/ 4/ 的/ 基本/ 思想/ 是/ :/ 从/ 终点/ ve/ 开始/ ,/ 依次/ 找到/ 顶点/ vi/ 在/ 路径/ p/ / 上/ 的/ 前驱/ 邻居/ 顶点/ vj/ ./ 初始化/ 阶段/ ,/ 我们/ 令/ vi/ ←/ ve/ ./ 算法/ 4/ ./ 路径/ 选择/ 算法/ ./ Path/ -/ Selection/ (/ g/ / e/ (/ t/ / )/ ,/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ 输入/ :/ g/ / e/ (/ t/ / )/ ,/ GT/ ,/ vs/ ,/ ve/ ,/ td/ ,/ ta/ 输出/ :/ p/ / ,/ p/ / 上/ 各点/ 等待时间/ ω/ / (/ vi/ )/ 1/ ./ vi/ ←/ ve/ ;/ p/ / ←/ / ;/ gi/ (/ ti/ )/ ←/ g/ / e/ (/ t/ / )/ ;/ ti/ ←/ t/ / ;/ 2/ ./ whilevi/ ≠/ vsdo3/ ./ foreachvj/ ∈/ N/ -/ (/ vi/ )/ do4/ ./ if/ / tj/ / ti/ -/ wj/ ,/ i/ ,/ gi/ (/ ti/ )/ =/ gj/ (/ tj/ )/ +/ fj/ ,/ i/ (/ ti/ -/ wj/ ,/ i/ )/ 证明/ ./ 令/ Sp5/ ./ p/ / ←/ p/ / +/ vj/ ;/ ω/ / (/ vj/ )/ =/ ti/ -/ wj/ ,/ i/ -/ tj/ ;/ 6/ ./ vi/ ←/ vj/ ;/ ti/ ←/ tj/ ;/ break/ ;/ 7/ ./ returnp/ / ,/ ω/ / (/ vi/ )/ foreachvi/ ∈/ p/ / ./ 每次/ 迭代/ 过程/ 中/ ,/ 我们/ 计算/ 顶点/ vi/ 在/ 路径/ p/ / 上/ 的/ 前驱/ 邻居/ 顶点/ vj/ ./ 设在/ 路径/ p/ / 上/ ,/ 到达/ 顶点/ vi/ 的/ 费用/ 代价/ 为/ gi/ (/ ti/ )/ ,/ 到达/ 顶点/ vi/ 的/ 时刻/ 为/ ti/ ./ 初始化/ 阶段/ ,/ gi/ (/ ti/ )/ ←/ g/ / e/ (/ t/ / )/ ,/ ti/ ←/ t/ / ./ t/ / 可取/ 为/ ge/ (/ t/ )/ 上/ g/ / e/ (/ t/ / )/ 取值/ 所/ 对应/ 时间/ 区间/ 内/ 的/ 任意/ 一个/ 时刻/ ./ 对于/ 任意/ vj/ ∈/ N/ -/ (/ vi/ )/ ,/ 即/ vj/ 为/ vi/ 的/ 入边/ 邻居/ ,/ 如果/ / tj/ ,/ tj/ / ti/ -/ wj/ ,/ i/ ,/ 使得/ 则/ 顶点/ vj/ 为/ 顶点/ vi/ 在/ 路径/ p/ / 上/ 的/ 前驱/ 邻居/ 顶点/ ,/ tj/ 为/ 路径/ p/ / 上/ 到达/ 顶点/ vj/ 的/ 时刻/ ./ 这样/ 的/ vj/ 一定/ 存在/ ,/ 因为/ 在/ 算法/ 3/ 中/ ,/ gi/ (/ ti/ )/ 的/ 取值/ 是/ 根据/ 此/ gj/ (/ tj/ )/ 计算/ 得到/ 的/ ./ 因此/ ,/ 在/ 顶点/ vj/ 上/ 的/ 最佳/ 等待时间/ 为/ 当/ 算法/ 4/ 找到/ 起点/ vs/ ,/ 即/ vi/ =/ vs/ 时/ ,/ 算法/ 结束/ ./ 此时/ ,/ 路径/ p/ / 上/ 的/ 所有/ 顶点/ 和/ 每个/ 顶点/ 上/ 的/ 等待时间/ 均/ 已经/ 计算出来/ ./ 我们/ 用图/ 1/ 和/ 图/ 4/ 中/ 的/ 例子/ 说明/ 该/ 计算/ 过程/ ./ 从图/ 4/ 中/ ,/ 我们/ 得知/ 到达/ 顶点/ v4/ 的/ 最小/ 费用/ 代价/ 为/ g/ / 4/ (/ t/ / )/ =/ 20/ ,/ 其/ 对应/ 区间/ 为/ [/ 30/ ,/ 35/ ]/ ,/ 我们/ 任取/ 其中/ 一个/ 时刻/ t/ / =/ 30/ ./ 因此/ 对于/ 顶点/ v3/ ,/ 离开/ 顶点/ v3/ 的/ 时刻/ 为/ t/ / -/ w3/ ,/ 4/ =/ 30/ -/ 10/ =/ 20/ ./ 我们/ 发现/ 在/ t3/ =/ 20/ 时/ ,/ g3/ (/ t3/ )/ =/ 15/ ,/ 则/ g3/ (/ t3/ )/ +/ f3/ ,/ 4/ (/ t/ / -/ w3/ ,/ 4/ )/ =/ g3/ (/ 20/ )/ +/ f3/ ,/ 4/ (/ 30/ -/ 10/ )/ 因此/ ,/ 顶点/ v3/ 为/ 终点/ v4/ 在/ 最优/ 路径/ p/ / 上/ 的/ 前驱/ 邻居/ 顶点/ ,/ 且/ 顶点/ v3/ 上/ 的/ 最佳/ 等待时间/ ω/ / (/ v3/ )/ =/ 0/ ./ 第/ 2/ 次/ 迭代/ 中/ ,/ 因为/ t3/ =/ 20/ ,/ 所以/ 对于/ 顶点/ v2/ ,/ 离开/ 顶点/ v2/ 的/ 时刻/ 为/ t3/ -/ w2/ ,/ 3/ =/ 20/ -/ 5/ =/ 15/ ./ 我们/ 发现/ 对于/ 时刻/ t2/ =/ 10/ ,/ 有/ g2/ (/ t2/ )/ =/ 10/ ,/ 且/ 满足/ g2/ (/ t2/ )/ +/ f2/ ,/ 3/ (/ t3/ -/ w2/ ,/ 3/ )/ =/ 10/ +/ 5/ =/ 15/ =/ g3/ (/ t3/ )/ ,/ 因此/ ,/ 顶点/ v2/ 为/ 顶点/ v3/ 在/ 路径/ p/ / 上/ 的/ 前驱/ 顶点/ ,/ 且/ 顶点/ v2/ 上/ 的/ 最佳/ 等待时间/ ω/ / (/ v2/ )/ =/ 5/ ./ 同理/ ,/ 在/ 第/ 3/ 次/ 迭代/ 中/ ,/ 我们/ 找到/ 顶点/ v2/ 的/ 前驱/ 邻居/ 顶点/ v1/ ./ 因为/ v1/ 为/ 起点/ ,/ 所以/ 算法/ 结束/ ./ 3.4/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ 分析/ 3.4/ ./ 1/ 时间/ 复杂度/ 我们/ 首先/ 分别/ 分析/ 算法/ 2/ 、/ 算法/ 3/ 和/ 算法/ 4/ 的/ 时间/ 复杂度/ ,/ 最后/ 给出/ 整体/ 算法/ 1/ 的/ 时间/ 复杂度/ ./ 设图/ 中/ 顶点/ 数量/ 和/ 边/ 的/ 数量/ 分别/ 为/ n/ 和/ m/ ,/ 图中/ 顶点/ vi/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ 的/ 平均/ 的/ 分段/ 区间/ 数量/ 为/ k/ ./ Page12/ 引理/ 2/ ./ 算法/ 2/ 的/ 时间/ 复杂度/ 为/ O/ (/ klogk/ )/ ./ 证明/ ./ 算法/ 2/ 中/ ,/ 需要/ 计算/ g/ / α/ j/ ,/ 所以/ 需要/ 将/ 这/ k/ 个/ 分段/ 区间/ 上/ 的/ 常数/ 取值/ 排序/ ,/ 该/ 过程/ 时间/ 复杂度/ 为/ O/ (/ klogk/ )/ ./ 计算/ φ/ α/ j/ 只/ 需/ 找到/ g/ / α/ j/ 对应/ 时间/ 区间/ 的/ 左/ 端点/ 即可/ ,/ 该/ 操作/ 需要/ O/ (/ 1/ )/ 的/ 时间/ ./ 在/ 计算/ gj/ →/ i/ (/ t/ )/ 过程/ 中/ ,/ 需要/ 计算/ 出/ gj/ →/ i/ (/ t/ )/ 在/ 全部/ 区间/ [/ λ/ j/ →/ i/ ,/ ta/ ]/ 内/ 的/ 不同/ 分段/ 上/ 的/ 取值/ ./ 因此/ ,/ 计算/ gj/ →/ i/ (/ t/ )/ 的/ 过程/ 时间/ 复杂度/ 为/ O/ (/ k/ )/ ./ 同样/ 地/ ,/ 更新/ gi/ (/ t/ )/ 的/ 时间/ 复杂度/ 也/ 为/ O/ (/ k/ )/ ./ 因此/ ,/ 算法/ 2/ 的/ 时间/ 复杂度/ 为/ O/ (/ klogk/ )/ ./ 引理/ 3/ ./ 算法/ 3/ 的/ 时间/ 复杂度/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ ./ 证明/ ./ 算法/ 3/ 中/ 的/ 每次/ 迭代/ 过程/ 中/ ,/ 最多/ 有/ n/ 个/ 顶点/ 同时/ 被/ 维护/ 于/ 队列/ Q/ 中/ ./ 我们/ 利用/ Fibonacci/ 堆/ [/ 12/ ]/ ,/ 则/ 将/ 顶点/ vi/ 弹出/ 队列/ 的/ 操作/ 需要/ 花费/ O/ (/ logn/ )/ 时间/ ,/ 而/ 插入/ 队列/ 的/ 操作/ 需要/ O/ (/ 1/ )/ 时间/ ./ 当/ 顶点/ vi/ 从/ 队列/ Q/ 中弹/ 出后/ ,/ 需要/ 更新/ vi/ 的/ 出边/ 邻居/ vj/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gj/ (/ t/ )/ ./ 令/ d/ +/ (/ vi/ )/ 为/ 顶点/ vi/ 的/ 出度/ ,/ 则/ 这/ 一/ 操作/ 的/ 时间/ 复杂度/ 为/ O/ (/ d/ +/ (/ vi/ )/ klogk/ )/ ./ 因此/ ,/ 算法/ 3/ 中/ 一次/ 迭代/ 过程/ 的/ 时间/ 复杂度/ 为/ O/ (/ logn/ +/ d/ +/ (/ vi/ )/ klogk/ )/ ./ 由/ 定理/ 3/ 和/ 推论/ 1/ 可知/ ,/ 算法/ 3/ 依据/ gi/ (/ t/ )/ 在/ 不同/ 分段/ 的/ 取值/ 大小/ 依次/ 弹/ 出/ 顶点/ vi/ ./ 最坏/ 情况/ 下/ ,/ 顶点/ vi/ 被/ 弹出/ 的/ 次数/ 为/ O/ (/ k/ )/ 次/ ./ 因此/ ,/ 算法/ 3/ 的/ 时间/ 复杂度/ 为/ O/ ∑/ vi/ ∈/ V/ 引理/ 4/ ./ 算法/ 4/ 的/ 时间/ 复杂度/ 为/ O/ (/ mk/ )/ ./ 证明/ ./ 算法/ 4/ 的/ 每次/ 迭代/ 过程/ 中/ ,/ 对/ 一个/ 顶点/ vi/ ,/ 需要/ 检查/ 其/ 所有/ 入边/ 邻居/ vj/ ./ 对/ 每/ 一个/ 入边/ 邻居/ vj/ ,/ 需要/ 检查/ 其/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gj/ (/ t/ )/ 在/ t/ / ti/ -/ wj/ ,/ i/ 时/ ,/ 是否/ 存在/ 取值/ 满足/ 公式/ gi/ (/ ti/ )/ =/ gj/ (/ tj/ )/ +/ fj/ ,/ i/ (/ ti/ -/ wj/ ,/ i/ )/ ,/ 该/ 操作/ 的/ 时间/ 复杂度/ 为/ O/ (/ k/ )/ ./ 因此/ ,/ 每/ 一次/ 迭代/ 中/ ,/ 对/ 顶点/ vi/ ,/ 计算/ 其/ 前驱/ 邻居/ 顶点/ 的/ 时间/ 复杂度/ 为/ O/ (/ d/ -/ (/ vi/ )/ k/ )/ ./ 因为/ 最优/ 路径/ p/ / 上/ 不/ 存在/ 环/ ,/ 对图/ 中/ 任意/ 一个/ 顶点/ vi/ 最多/ 计算/ 一次/ 其/ 前驱/ 邻居/ 顶点/ ,/ 所以/ ,/ 算法/ 4/ 的/ 时间/ 复杂度/ (/ d/ -/ (/ vi/ )/ k/ (/ 为/ O/ ∑/ vi/ ∈/ V/ 定理/ 4/ ./ 算法/ 1/ 的/ 时间/ 复杂度/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ ./ 算法/ 1/ 是/ 计算/ 起点/ vs/ 到/ 终点/ ve/ ,/ 具有/ 时间/ 限制/ 的/ 费用/ 最优/ 路径/ p/ / 和/ p/ / 上/ 每个/ 顶点/ vi/ 的/ 最佳/ 等待时间/ ω/ / (/ vi/ )/ 的/ 算法/ ./ 证明/ ./ 因为/ 算法/ 3/ 和/ 算法/ 4/ 是/ 算法/ 1/ 的/ 两个/ 阶段/ ,/ 所以/ 根据/ 引理/ 3/ 和/ 引理/ 4/ ,/ 我们/ 可知/ 算法/ 1/ 的/ 时间/ 复杂度/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ ./ 证毕/ ./ 3.4/ ./ 2/ 空间/ 复杂度/ 定理/ 5/ ./ 算法/ 1/ 的/ 空间/ 复杂度/ 为/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ./ 证明/ ./ 算法/ 3/ 和/ 算法/ 4/ 为/ 算法/ 1/ 的/ 两个/ 阶段/ ./ 在/ 优先/ 队列/ Q/ 中/ ,/ 算法/ 3/ 至多/ 维护/ n/ 个/ 顶点/ ./ 对/ 每个/ 顶点/ vi/ ,/ 算法/ 需要/ 维护/ 其/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ gi/ (/ t/ )/ ./ 对图/ 中/ 每/ 条边/ ,/ 算法/ 3/ 和/ 算法/ 4/ 需要/ 维护/ 其/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ ./ 因此/ ,/ 算法/ 1/ 的/ 空间/ 复杂度/ 为/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ./ 4/ 实验/ 结果/ 和/ 分析/ 我们/ 在/ 真实/ 的/ 数据/ 集上/ 实现/ 了/ 本文/ 的/ 算法/ ,/ 并/ 与/ TCSP/ -/ AWT/ 算法/ [/ 7/ ]/ 进行/ 了/ 对比/ ./ TCSP/ -/ AWT/ 算法/ 是/ 目前/ 解决/ 具有/ 时间/ 限制/ 的/ 费用/ 最优/ 路径/ 查询/ 的/ 最/ 有效/ 的/ 算法/ ,/ TCSP/ -/ AWT/ 算法/ 用于/ 计算/ 离散/ 时间/ 模型/ 下/ 的/ 费用/ 最优/ 路径/ ./ 所有/ 实验/ 均/ 在/ 主频/ 为/ 2.5/ GHz/ 的/ IntelCorei5CPU/ 和/ 内存/ 为/ 4GB/ 的/ PC机/ 上/ 完成/ ./ 我们/ 使用/ 的/ 操作系统/ 为/ Windows7/ ./ 4.1/ 数据/ 集/ 描述/ 和/ 实验/ 设置/ 我们/ 在/ 以下/ 真实/ 数据/ 集上/ 进行/ 了/ 算法/ 的/ 测试/ :/ Californiaroadnetwork/ ./ 本/ 数据/ 集/ 描述/ 的/ 是/ 美国/ 加利福尼亚州/ 道路交通/ 网/ ,/ 包括/ 21047/ 个/ 顶点/ 和/ 21692/ 条边/ ./ 其中/ ,/ 顶点/ 代表/ 道路/ 的/ 交叉口/ 或者/ 道路/ 的/ 端点/ ,/ 边/ 代表/ 道路/ 片段/ ./ 本/ 数据/ 来自/ http/ :/ // // www/ ./ maproom/ ./ psu/ ./ edu/ // dcw/ ./ 我们/ 在/ 该/ 数据/ 集上/ 生成/ 了/ 4/ 个/ 规模/ 不同/ 的/ 时间/ 依赖图/ ,/ 其/ 顶点/ 规模/ 分别/ 为/ 2K/ ,/ 5K/ ,/ 10K/ 和/ 20K/ ./ 在/ 这些/ 时间/ 依赖图/ 上/ 分别/ 进行/ 了/ 算法/ 测试/ ,/ 以/ 考察/ 算法/ 的/ 可扩展性/ ./ 针对/ 数据/ 集中/ 的/ 每/ 一条/ 边/ ,/ 我们/ 随机/ 生成/ 其/ 时间/ 代价/ wi/ ,/ j/ 和/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ ./ 对于/ fi/ ,/ j/ (/ t/ )/ ,/ 限定/ 其/ 定义域/ 为/ [/ 0/ ,/ 2000/ ]/ ./ 2000/ 表示/ 2000/ 个/ 时间/ 单位/ (/ 秒/ 或者/ 分/ )/ ./ 将/ fi/ ,/ j/ (/ t/ )/ 的/ 定义域/ 随机/ 分成/ k/ 个/ 片段/ ,/ 在/ 每/ 一个/ 片段/ 上/ 赋予/ 一个/ 常数/ 取值/ ./ 因此/ ,/ fi/ ,/ j/ (/ t/ )/ 为/ 一个/ 分段/ 常量/ 函数/ ./ 对/ 算法/ TCSP/ -/ AWT/ ,/ 我们/ 每隔/ 一个/ 时间/ 单位/ 采样/ 一个/ 离散/ 时间/ 点/ ./ 例如/ ,/ 对/ 查询/ 区间/ [/ 0/ ,/ 1000/ ]/ ,/ 采样/ 的/ 离散/ 时间/ 点/ 个数/ 即为/ 500/ 个/ ./ 对/ 每组/ 数据/ 集/ ,/ 分别/ 生成/ 规模/ 为/ 1000/ 的/ 查询/ 集合/ ,/ 实验/ 中/ 的/ 结果/ ,/ 是/ 每个/ 查询/ 集合/ 结果/ 的/ 平均值/ ./ 用/ TWO/ -/ STEP/ 标记/ 我们/ 的/ 算法/ ./ 我们/ 在/ 实验/ 中/ 考察/ 了/ 以下/ 几/ 方面/ 的/ 内容/ :/ Page13/ (/ 1/ )/ 图中/ 顶点/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ;/ (/ 2/ )/ 图中边/ 的/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ;/ (/ 3/ )/ 起点/ vs/ 和/ 终点/ ve/ 之间/ 距离/ 对/ 算法/ 性能/ 的/ 影响/ ;/ (/ 4/ )/ 最早/ 出发/ 时刻/ 和/ 最晚/ 到达/ 时刻/ 的/ 时间/ 区间/ [/ td/ ,/ ta/ ]/ 对/ 算法/ 性能/ 的/ 影响/ ;/ (/ 5/ )/ 费用/ 代价/ 函数/ fi/ ,/ j/ (/ t/ )/ 上/ 分段/ 区间/ 数量/ k/ 对/ 算法/ 性能/ 的/ 影响/ ./ 算法/ 性能/ 考察/ 的/ 指标/ 为/ :/ (/ 1/ )/ 算法/ 运行/ 时间/ ;/ (/ 2/ )/ 算法/ 运行/ 时/ 的/ 内存/ 开销/ ;/ (/ 3/ )/ 每个/ 顶点/ 从/ 队列/ 中弹/ 出/ 的/ 平均/ 次数/ ;/ (/ 4/ )/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ ,/ 我们/ 将/ 其/ 定义/ 为/ (/ c/ -/ c/ / )/ // c/ / ,/ 这里/ ,/ c/ 为/ TCSP/ -/ AWT/ 算法/ 结果/ 的/ 代价/ ,/ c/ / 为/ 最优/ 结果/ 的/ 代价/ ./ 我们/ 的/ 算法/ 基于/ 连续/ 时间/ 模型/ ,/ 所以/ 不/ 存在/ 误差/ ./ 4.2/ 实验/ 结果/ 实验/ 1/ ./ 顶点/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 在/ 图/ 5/ 中/ ,/ 我们/ 考察/ 顶点/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 本组/ 实验/ 图/ 5/ 顶点/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ 实验/ 2/ ./ 边/ 的/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 图/ 6/ 中/ ,/ 我们/ 考察/ 图中边/ 的/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 本组/ 实验/ 中/ ,/ 我们/ 固定/ 图中/ 顶点/ 数量/ 为/ 10K/ ,/ 边/ 的/ 数量/ 从/ 10K/ 变化/ 到/ 80K/ ,/ 费用/ 代价/ 函数/ 的/ 分段/ 数量/ k/ =/ 10/ ,/ 最早/ 出发/ 时刻/ 和/ 最晚/ 到达/ 时刻/ 区间/ T/ =/ [/ 0/ ,/ 1000/ ]/ ,/ TCSP/ -/ AWP/ 算法/ 的/ 时间/ 点/ 个数/ l/ =/ 500/ ./ 通过/ 图/ 6/ 中/ ,/ 边/ 的/ 费用/ 代价/ 函数/ 的/ 分段/ 数量/ 为/ k/ =/ 10/ ,/ 最早/ 出发/ 时刻/ 和/ 最晚/ 到达/ 时刻/ 区间/ T/ =/ [/ 0/ ,/ 1000/ ]/ ,/ TCSP/ -/ AWP/ 算法/ 的/ 时间/ 点/ 个数/ l/ =/ 500/ ./ 如图/ 5/ (/ a/ )/ 和/ 图/ 5/ (/ b/ )/ 所示/ ,/ 我们/ 的/ 算法/ 的/ 运行/ 时间/ 和/ 内存/ 开销/ 均/ 远远/ 小于/ TCSP/ -/ AWT/ 算法/ ./ 这/ 是因为/ TCSP/ -/ AWT/ 算法/ 需要/ 计算/ 在/ 每个/ 时刻/ 到达/ 图中/ 每个/ 顶点/ 的/ 代价/ ,/ 并/ 对/ 这些/ 代价/ 进行/ 组合/ 以/ 求得/ 最小/ 代价/ ./ 我们/ 的/ 算法/ 比/ TCSP/ -/ AWT/ 算法/ 快/ 了/ 20/ 倍/ ,/ 内存/ 开销/ 少/ 了/ 近/ 500/ 倍/ ./ 我们/ 发现/ ,/ 算法/ 的/ 运行/ 时间/ 和/ 内存/ 开销/ 都/ 随着/ 顶点/ 数量/ 的/ 增加/ 而/ 增大/ ./ 在/ 图/ 5/ (/ c/ )/ 中/ ,/ 我们/ 发现/ 每个/ 顶点/ 从/ 队列/ 中弹/ 出/ 的/ 平均/ 次数/ 与/ 顶点/ 数量/ 变化/ 无关/ ./ 在/ 图/ 5/ (/ d/ )/ 中/ ,/ 我们/ 发现/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 随着/ 顶点/ 数量/ 的/ 增加/ 而/ 增大/ ./ 这/ 是因为/ ,/ 顶点/ 规模/ 变大时/ ,/ 起点/ 和/ 终点/ 之间/ 的/ 距离/ 增大/ ./ 因此/ ,/ 在/ 路径/ 上/ 累积/ 的/ 误差值/ 就会/ 变大/ ./ (/ a/ )/ 和/ 图/ 6/ (/ b/ )/ ,/ 我们/ 同样/ 发现/ ,/ 我们/ 的/ 算法/ 在/ 时间/ 和/ 空间/ 上/ 都/ 要/ 优于/ TCSP/ -/ AWT/ 算法/ ./ 图/ 6/ (/ c/ )/ 中/ ,/ 我们/ 发现/ ,/ 随着/ 边/ 的/ 数量/ 的/ 增加/ ,/ 每个/ 顶点/ 从/ 队列/ 中弹/ 出/ 的/ 平均/ 次数/ 有所/ 减少/ ./ 这/ 是因为/ ,/ 边/ 的/ 数量/ 增加/ 导致/ 图/ 的/ 密度/ 增大/ ,/ 进而/ 图中/ 任意/ 两点/ 之间/ 的/ 距离/ 减少/ ./ 因此/ ,/ 算法/ 可以/ 更快/ 地/ 计算/ 出/ 到达/ 终点/ 的/ 最小/ 费用/ ,/ Page14/ 从而/ 减少/ 了/ 每个/ 顶点/ 的/ 弹出/ 次数/ ./ 然而/ ,/ 边/ 的/ 数量/ 增加/ ,/ 导致/ 了/ 顶点/ 的/ 邻居/ 数/ 增加/ ,/ 当/ 顶点/ 从/ 队列/ 弹出/ 时/ ,/ 更新/ 其/ 所有/ 邻居/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 的/ 时间/ 开销/ 也/ 就/ 增大/ ./ 因此/ ,/ 在/ 图/ 6/ (/ a/ )/ 中/ ,/ 算法/ 运行/ 时间/ 会图/ 6/ 边/ 的/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ 实验/ 3/ ./ 起点/ 和/ 终点/ 之间/ 距离/ 对/ 算法/ 性能/ 的/ 影响/ ./ 图/ 7/ 中/ ,/ 我们/ 研究/ 了/ 起点/ 与/ 终点/ 之间/ 距离/ 变化/ 对/ 算法/ 性能/ 的/ 影响/ ./ 本组/ 实验/ 中/ ,/ 图中/ 顶点/ 数量/ 为/ 20K/ ,/ 起点/ 与/ 终点/ 之间/ 的/ 距离/ 从/ 5/ 变化/ 到/ 10/ ./ 费用/ 代价/ 函数/ 的/ 分段/ 数量/ k/ =/ 10/ ,/ 最早/ 出发/ 时刻/ 和/ 最晚/ 到达/ 时刻/ 区间/ T/ =/ [/ 0/ ,/ 1000/ ]/ ,/ TCSP/ -/ AWP/ 算法/ 的/ 时间/ 点/ 个数/ l/ =/ 500/ ./ 通过/ 图/ 7/ (/ a/ )/ 和/ 图/ 7/ (/ b/ )/ ,/ 我们/ 发现/ ,/ 算法/ 的/ 运行/ 时间/ 和/ 内存/ 开销/ 对/ 起点/ 和/ 终点/ 之间/ 距离/ 的/ 变化/ 并/ 不/ 敏感/ ./ 这/ 是因为/ ,/ 起点/ 和/ 终点/ 之间/ 距离/ 最短/ 的/ 路径/ 在/ 很多/ 情况/ 下/ 并/ 不是/ 费用/ 代价/ 函数/ 下/ 最优/ 的/ 路径/ ./ 与/ 边/ 的/ 数量/ 变化/ 不同/ ,/ 本组/ 实验/ 中/ ,/ 图/ 的/ 密度/ 没有/ 增加/ ,/ 仅仅/ 是/ 起点/ 和/ 终点/ 之间/ 的/ 距离/ 发生变化/ ./ 因此/ ,/ 在/ 图/ 7/ (/ c/ )/ 中/ ,/ 顶点/ 从/ 队列/ 中弹/ 出/ 的/ 平均/ 次数/ 也/ 没有/ 显著/ 变化/ ./ 在/ 图/ 7/ (/ d/ )/ 中/ ,/ 我们/ 发现/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 随着/ 起点/ 和/ 终点/ 之间/ 距离/ 的/ 增大/ 而/ 增大/ ,/ 其/ 原因/ 是/ ,/ 随着/ 起点/ 与/ 终点/ 之间/ 距离/ 增大/ ,/ 路径/ 上/ 的/ 累积/ 误差/ 也/ 会/ 增大/ ./ 随着/ 边/ 的/ 数量/ 的/ 增加/ 而/ 增加/ ./ 图/ 6/ (/ d/ )/ 中/ ,/ 我们/ 发现/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 随着/ 边/ 的/ 增加/ 而/ 减小/ ./ 这/ 是因为/ ,/ 边/ 的/ 增加/ 使得/ 起点/ 和/ 终点/ 之间/ 的/ 距离/ 减小/ ,/ 所以/ ,/ 路径/ 上/ 累积/ 的/ 误差/ 也/ 会/ 减小/ ./ 实验/ 4/ ./ 查询/ 时间/ 区间/ 的/ 距离/ 对/ 算法/ 性能/ 的/ 影响/ ./ 图/ 8/ 中/ ,/ 我们/ 考察/ 了/ 查询/ 时间/ 区间/ 对/ 算法/ 性能/ 的/ 影响/ ./ 本组/ 实验/ 中/ ,/ 图中/ 顶点/ 数量/ 为/ 10K/ ,/ 最早/ 出发/ 时刻/ 固定/ 为/ 0/ ,/ 最/ 晚/ 到达/ 时刻/ 从/ 600/ 变化/ 到/ 1200/ ,/ 因此/ ,/ TCSP/ -/ AWP/ 算法/ 的/ 时间/ 点/ 个数/ 从/ 300/ 变化/ 到/ 600/ ./ 费用/ 代价/ 函数/ 的/ 分段/ 数量/ k/ =/ 10/ ./ 图/ 8/ (/ a/ )/ 和/ 图/ 8/ (/ b/ )/ 中/ ,/ 我们/ 的/ 算法/ 时间/ 和/ 空间/ 开销/ 受/ 查询/ 时间/ 区间/ 变化/ 的/ 影响/ 很小/ ./ 这/ 是因为/ ,/ 虽然/ 查询/ 时间/ 区间/ 变/ 大/ ,/ 但/ 费用/ 代价/ 函数/ 分段/ 数量/ 没有/ 改变/ ./ 相反/ 地/ ,/ 因为/ 查询/ 时间/ 区间/ 变/ 大/ ,/ 导致/ TCSP/ -/ AWT/ 算法/ 的/ 离散/ 时间/ 点/ 增多/ ,/ 所以/ ,/ TCSP/ -/ AWT/ 算法/ 的/ 时间/ 和/ 空间/ 开销/ 都/ 增加/ ./ 图/ 8/ (/ c/ )/ 中/ ,/ 每个/ 顶点/ 的/ 平均/ 弹/ 出/ 次数/ 没有/ 受到/ 明显/ 影响/ ./ 图/ 8/ (/ d/ )/ 中/ ,/ 我们/ 发现/ ,/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 也/ 没有/ 明显/ 变化/ ./ 实验/ 5/ ./ 费用/ 代价/ 函数/ 的/ 分段/ 区间/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 在/ 图/ 9/ 中/ ,/ 我们/ 研究/ 了/ 费用/ 代价/ 函数/ 分段/ 区间/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ ./ 本组/ 实验/ 中/ ,/ 图中顶/ Page15/ 图/ 7/ 起点/ 和/ 终点/ 间/ 距离/ 对/ 算法/ 性能/ 的/ 影响/ 图/ 8/ 查询/ 时间/ 区间/ 对/ 算法/ 性能/ 的/ 影响/ Page16/ 点/ 数量/ 为/ 10K/ ,/ 边上/ 的/ 费用/ 代价/ 函数/ 的/ 分段/ 区间/ 数量/ 从/ 5/ 变化/ 到/ 20/ ,/ 最早/ 出发/ 时刻/ 和/ 最晚/ 到达/ 时刻/ 区间/ T/ =/ [/ 0/ ,/ 1000/ ]/ ,/ TCSP/ -/ AWP/ 算法/ 的/ 离散/ 时间/ 点/ 的/ 个数/ l/ =/ 500/ ./ 通过/ 图/ 9/ (/ a/ )/ 和/ 图/ 9/ (/ b/ )/ ,/ 我们/ 发现/ ,/ 算法/ 的/ 运行/ 时间/ 和/ 内存/ 开销/ 均/ 随着/ 函数/ 分段/ 区间/ 数量/ 的/ 增加/ 而/ 增加/ ./ 这/ 是因为/ ,/ 当/ 函数/ 分段/ 区间/ 数量/ 增加/ 时/ ,/ 更新/ 图中/ 顶点/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 的/ 开销/ 增大/ ./ 我们/ 的/ 算法/ 在/ 时间/ 和/ 空间/ 上/ 都/ 要/ 优于/ TCSP/ -/ AWP/ 算法/ ./ 通过/ 图/ 9/ (/ c/ )/ ,/ 我们/ 发现/ ,/ 每个/ 顶点/ 从/ 队列/ 中/ 的/ 弹出/ 次数/ 随着/ 函数/ 分段/ 数量/ 的/ 增加/ 而/ 增加/ ./ 这/ 是因为/ ,/ 当/ 费用函数/ 分段/ 区间/ 数量/ 增加/ 时/ ,/ 顶点/ 上图/ 9/ 费用/ 代价/ 函数/ 分段/ 数量/ 对/ 算法/ 性能/ 的/ 影响/ 5/ 相关/ 工作/ 目前/ ,/ 关于/ 时间/ 依赖图/ 上/ 的/ 最/ 短/ 路径/ 查询/ 问题/ (/ TDSP/ )/ 已经/ 有/ 了/ 很多/ 的/ 研究/ 工作/ [/ 1/ -/ 6/ ,/ 13/ -/ 15/ ]/ ./ 然而/ ,/ 这些/ 工作/ 主要/ 解决/ 的/ 是/ 最/ 短/ 旅行/ 时间/ 问题/ ,/ 即/ 在/ 时间/ 依赖图/ 模型/ 上/ 找到/ 一条/ 起点/ 到/ 终点/ 的/ 路径/ ,/ 使得/ 该/ 路径/ 的/ 时间/ 代价/ 总和/ 最小/ ./ 这些/ 工作/ 主要/ 分为/ 两类/ ,/ 一类/ 基于/ 离散/ 的/ 时间/ 模型/ ,/ 另外/ 一类/ 基于/ 连续/ 的/ 时间/ 模型/ ./ 文献/ [/ 13/ -/ 15/ ]/ 研究/ 了/ 离散/ 时间/ 模型/ 下/ 的/ 时间/ 的/ 到达/ 时间/ -/ 最小/ 代价/ 函数/ 的/ 分段/ 数量/ 也/ 会/ 增加/ ./ 所以/ ,/ 顶点/ 从/ 队列/ 中弹/ 出/ 次数/ 也/ 就/ 会/ 增加/ ./ 在/ 图/ 9/ (/ d/ )/ 中/ ,/ 我们/ 发现/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 也/ 随着/ 函数/ 分段/ 数量/ 的/ 增加/ 而/ 增加/ ./ 这/ 是因为/ ,/ 当/ 分段/ 数量/ 增加/ 时/ ,/ 费用/ 代价/ 函数/ 的/ 取值/ 数量/ 也/ 会/ 增加/ ,/ 所以/ ,/ 费用/ 代价/ 函数/ 取值/ 发生变化/ 时刻/ 位于/ 两个/ 离散/ 时间/ 点/ 之间/ 的/ 机会/ 也/ 就/ 增加/ ./ 当/ 到达/ 某个/ 顶点/ 时/ ,/ TCSP/ -/ AWT/ 算法/ 无法/ 找到/ 通行/ 下/ 一条/ 边/ 的/ 最优/ 代价/ 的/ 机会/ 也/ 就/ 增加/ ./ 因此/ ,/ TCSP/ -/ AWT/ 算法/ 的/ 相对误差/ 会/ 随着/ 函数/ 分段/ 区间/ 数量/ 的/ 增加/ 而/ 增加/ ./ 依赖/ 最短/ 路径/ 查询/ ./ 文献/ [/ 14/ ]/ 中/ ,/ 图上/ 每/ 一条/ 边/ 被/ 赋予/ 一组/ 聚集/ 属性/ ,/ 该/ 聚集/ 属性/ 表示/ 了/ 这/ 条边/ 在/ 不同/ 时刻/ 所/ 呈现/ 的/ 状态/ ./ 文献/ [/ 13/ ]/ 将/ 出发/ 时间/ 区间/ 平滑/ 地/ 离散/ 为/ k/ 个/ 时间/ 点/ ,/ 并/ 依据/ 这/ k/ 个/ 时间/ 点将/ 图中/ 顶点/ 和/ 边/ 复制/ k/ 次/ ,/ 因此/ ,/ 时间/ 依赖图/ 被/ 转化/ 了/ 一个/ 规模/ 增大/ k/ 倍/ 的/ 静态/ 图/ ./ 文献/ [/ 13/ ]/ 进而/ 给出/ 了/ 如何/ 在/ 这个/ 静态/ 图上/ 完成/ 最短/ 路径/ 查询/ 的/ 方法/ ./ 这些/ 基于/ 离散/ 时间/ 模型/ 的/ 方法/ 并/ 不能/ 回答/ 连续/ 时间/ 模型/ 下/ 的/ 最/ 短/ 路径/ 查询/ 问题/ ./ 文献/ [/ 1/ -/ 6/ ]/ 研究/ 了/ 连续/ 时间/ 模型/ 下/ 的/ 最/ 短/ 路径/ 查询/ 问题/ ./ 文献/ [/ 1/ ]/ 提出/ 了/ 一种/ 基于/ Page17Bellman/ -/ Ford/ 算法/ 思想/ 的/ 方法/ ./ 对图/ 中/ 任意/ 顶点/ vi/ ,/ 该/ 方法/ 迭代/ 的/ 计算/ 到达/ 顶点/ vi/ 的/ 最早/ 时刻/ ,/ 并/ 利用/ 这些/ 中间/ 结果/ ,/ 最终/ 计算/ 出/ 到达/ 终点/ ve/ 的/ 最早/ 时刻/ ./ 最后/ ,/ 根据/ 该/ 时刻/ 找到/ 旅行/ 时间/ 最短/ 的/ 路径/ ./ 文献/ [/ 2/ ]/ 提出/ 了/ 道路网/ 中/ 的/ 速度/ 流/ 模型/ ,/ 该/ 模型/ 下/ ,/ 图中/ 每/ 条边/ 的/ 通过/ 速度/ 可以/ 用/ 一个/ 分段/ 线性/ 的/ 函数/ 表示/ ./ 该文/ 作者/ 提出/ 一个/ 基于/ Dijkstra/ 算法/ 思想/ 的/ 方法/ 计算速度/ 流/ 模型/ 下/ 的/ 最快/ 路径/ 查询/ 问题/ ./ 文献/ [/ 3/ ]/ 提出/ 了/ 一种/ 基于/ A/ / 算法/ 的/ 扩展/ 算法/ ./ 该/ 算法/ 的/ 主要/ 思想/ 是/ 用/ 一个/ 优先/ 队列/ 维护/ 所有/ 待/ 扩展/ 的/ 路径/ ./ 对/ 任意/ 一点/ vi/ ,/ 起点/ vs/ 到/ vi/ 的/ 最早/ 到达/ 时间/ 函数/ 被/ 维护/ 在/ 优先/ 队列/ 中/ ,/ 该/ 算法/ 通过/ 顶点/ vi/ 到/ 终点/ ve/ 的/ 欧氏/ 距离/ 和/ 网络/ 中/ 的/ 最大/ 速度/ ,/ 预估/ 顶点/ vi/ 到/ 终点/ ve/ 的/ 时间/ ./ 算法/ 根据/ 预估/ 时间/ 弹/ 出/ 队列/ 元素/ ,/ 并/ 找到/ 起点/ 到/ 终点/ 的/ 最/ 短/ 旅行/ 时间/ 路径/ ./ 文献/ [/ 4/ ]/ 介绍/ 了/ 如何/ 应用/ 数据挖掘/ 的/ 方法/ 找到/ 各种/ 条件/ 下/ 描述/ 道路/ 通过/ 速度/ 的/ 模型/ ./ 文献/ [/ 5/ ]/ 是/ 目前/ 最/ 有效/ 的/ 解决/ TDSP/ 问题/ 的/ 方法/ ./ 该/ 方法/ 采用/ 两/ 阶段/ 搜索/ 策略/ ./ 第/ 1/ 阶段/ ,/ 用/ 优先/ 队列/ 更新/ 图中/ 所有/ 顶点/ 最早/ 到达/ 时间/ 的/ 函数/ ,/ 并/ 最终/ 计算/ 出/ 终点/ ve/ 的/ 最早/ 到达/ 时间/ 函数/ ./ 第/ 2/ 阶段/ ,/ 根据/ ve/ 的/ 最早/ 到达/ 时间/ 函数/ 找到/ 旅行/ 时间/ 最小/ 的/ 路径/ ./ 然而/ ,/ 这些/ 解决/ TDSP/ 问题/ 的/ 研究/ 工作/ 都/ 利用/ 了/ 以下/ 性质/ :/ 到达/ 顶点/ vi/ 的/ 最早/ 时刻/ 可以/ 根据/ 到达/ 其入/ 边/ 邻居/ 的/ 最早/ 时刻/ 计算/ 得出/ ./ 然而/ ,/ 在/ 计算/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 时/ ,/ 该/ 性质/ 并/ 不/ 成立/ ./ 因此/ ,/ 目前/ 解决/ TDSP/ 问题/ 的/ 方法/ 均/ 不能/ 解决/ 本文/ 面对/ 的/ 问题/ ./ 运筹学/ 领域/ 中/ 的/ 一些/ 工作/ 研究/ 了/ 时间/ 依赖图/ 上/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 的/ 查询/ 问题/ [/ 7/ -/ 11/ ]/ ./ 然而/ ,/ 这些/ 工作/ 假定/ 的/ 时间/ 模型/ 是/ 离散/ 的/ ./ 在/ 离散/ 时间/ 模型/ 中/ ,/ 时间/ 区间/ 被/ 离散/ 化为/ 时间/ 点/ 的/ 集合/ [/ t1/ ,/ t2/ ,/ …/ ,/ tT/ ]/ ./ 对图/ 上/ 任意/ 一条/ 边/ (/ vi/ ,/ vj/ )/ ,/ 用户/ 只能/ 选择/ 在/ 某个/ 给定/ 时刻/ ti/ 离开/ 顶点/ vi/ ./ 这些/ 工作/ 的/ 主要/ 问题/ 有/ :/ (/ 1/ )/ 离散/ 时间/ 模型/ 下/ 不能/ 找到/ 精确/ 的/ 最优/ 解/ ;/ (/ 2/ )/ 这些/ 方法/ 只是/ 从/ 理论/ 上/ 给出/ 计算/ 最优/ 路径/ 的/ 方法/ ,/ 并/ 没有/ 从/ 提高/ 算法/ 实际/ 运行/ 效率/ 的/ 角度/ 来/ 设计/ 算法/ 和/ 优化/ 算法/ ,/ 也/ 没有/ 应用/ 数据处理/ 中/ 的/ 优化/ 技术/ ./ 所以/ ,/ 这些/ 方法/ 需要/ 承受/ 较/ 高/ 的/ 时间/ 和/ 空间/ 开销/ ./ 因此/ ,/ 运筹学/ 领域/ 中/ 的/ 这些/ 工作/ 也/ 不能/ 很/ 好地解决/ 本文/ 所/ 要/ 面对/ 的/ 问题/ ./ 6/ 结论/ 本文/ 中/ ,/ 研究/ 了/ 时间/ 依赖图/ 上/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 的/ 查询/ 问题/ ./ 我们/ 首先/ 给出/ 了/ 时间/ 依赖图/ 模型/ 的/ 定义/ 以及/ 时间/ 依赖图/ 上/ 具有/ 时间/ 限制/ 的/ 费用/ 代价/ 最优/ 路径/ 查询/ 的/ 定义/ ./ 然后/ ,/ 给出/ 了/ 一个/ 有效/ 的/ 算法/ 计算/ 时间/ 限制/ 下/ 的/ 费用/ 代价/ 最优/ 路径/ ./ 同时/ ,/ 证明/ 算法/ 的/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ 分别/ 为/ O/ (/ knlogn/ +/ mk2logk/ )/ 和/ O/ (/ (/ n/ +/ m/ )/ k/ )/ ./ 最后/ ,/ 通过/ 真实/ 数据/ 集上/ 的/ 实验/ 验证/ 了/ 算法/ 的/ 有效性/ ./ 在/ 后续/ 的/ 工作/ 中/ ,/ 我们/ 将/ 考虑/ 时间/ 代价/ 函数/ 和/ 费用/ 代价/ 函数/ 共同/ 作用/ 下/ 的/ 最优/ 路径/ 查询/ 问题/ ,/ 以及/ 在/ 时间/ 依赖图/ 模型/ 上/ 多维/ 代价/ 的/ 最优/ 路径/ 查询/ 问题/ ./ 

