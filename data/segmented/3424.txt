Page1/ 因子/ 分解/ 假设/ 的/ 复合/ 模/ 广义/ 迪菲/ 赫尔曼/ 问题/ 的/ 伪/ 随机/ 提取/ 梅其祥/ 1/ )/ ,/ 2/ )/ 李宝/ 1/ )/ 路献辉/ 1/ )/ 1/ )/ (/ 中国科学院/ 研究生院/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100049/ )/ 2/ )/ (/ 广东/ 海洋大学/ 信息/ 学院/ 广东/ 湛江/ 524088/ )/ 摘要/ 研究/ 怎样/ 在/ 因子/ 分解/ 假设/ 下/ 有效/ 地/ 提取/ 复合/ 模数/ 上/ 的/ 广义/ 菲/ 赫尔曼/ 问题/ 的/ 伪/ 随机/ 比特/ 串/ ./ 证明/ 了/ Blum/ -/ Blum/ -/ Shub/ 生成器/ 是/ 一个/ 合适/ 的/ 广义/ 菲/ 赫尔曼/ 问题/ 提取/ 器/ ./ 利用/ Naor/ -/ Reingold/ -/ Rosen/ 伪/ 随机/ 函数/ 中/ 的/ 技巧/ 证明/ :/ 在/ 因子/ 分解/ 假设/ 下/ ,/ 对于/ 任意/ 的/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ 上/ 的/ 真/ 子集合/ A/ ,/ 即使/ 公开/ 了/ g/ ∏/ i/ ∈/ A/ (/ 其中/ ,/ g/ 是/ 平方/ 剩余/ 群/ QRN/ 上/ 的/ 生成元/ ,/ N/ 为/ Blum/ 整数/ )/ ./ 利用/ 该/ 结论/ ,/ 在/ 因子/ 分解/ 假设/ 下/ ,/ 可以/ 得到/ 不可/ 区分/ 意义/ 安全/ 的/ 公钥/ 加密/ 和/ 密钥/ 交换/ 协议/ ./ 关键词/ 随机/ 提取/ ;/ Blum/ -/ Blum/ -/ Shub/ 生成器/ ;/ 因子/ 分解/ 假设/ ;/ 广义/ 迪菲/ 赫尔曼/ 问题/ 1/ 引言/ 复合/ 模数/ 上/ 的/ 广义/ 迪菲/ 赫尔曼/ (/ GeneralizedDiffie/ -/ Hellman/ ,/ GDH/ )/ 问题/ 有/ 一个/ 很/ 好/ 的/ 性质/ :/ 其/ Page2/ 计算/ 的/ ;/ 当/ n/ =/ 3/ 时/ ,/ 给定/ ga1/ ,/ ga2/ ,/ ga3/ ,/ ga1a2/ ,/ ga2a3/ ,/ ga1a3/ 后/ ,/ ga1a2a3/ 是/ 难以/ 计算/ 的/ ./ 基于/ GDH/ 问题/ ,/ 可以/ 构造/ 密钥/ 交换/ 协议/ 和/ 公钥/ 加密/ [/ 3/ -/ 4/ ]/ ./ 当/ n/ =/ 2/ 时/ ,/ 可以/ 构造/ 复合/ 模数/ 上/ 的/ Dif/ -/ fie/ -/ Hellman/ 密钥/ 交换/ 协议/ 、/ 复合/ 模数/ 上/ 的/ ElGamal/ 加密/ ;/ n/ / 3/ 时/ ,/ 可以/ 构造/ 复合/ 模数/ 上/ 的/ 多方/ Diffie/ -/ Hellman/ 密钥/ 交换/ 协议/ ./ 但是/ ,/ 直接/ 应用/ GDH/ 问题/ ,/ 所得/ 方案/ 只是/ 在/ 单向性/ 的/ 意义/ 下/ 是/ 安全/ 的/ ,/ 原因/ 是/ 我们/ 只能/ 保证/ g/ ∏/ n/ 码/ 方案/ 中/ ,/ 我们/ 还/ 需要/ 由/ g/ ∏/ n/ 该会/ 话/ 密钥/ 是/ 在/ 不可/ 区分/ 意义/ 下/ 是/ 安全/ 的/ ./ 为此/ ,/ 我们/ 需要/ 一个/ GDH/ 问题/ 的/ 密钥/ 提取/ 器来/ 对/ g/ ∏/ n/ 行/ 随机/ 提取/ ./ 一种/ 方法/ 是/ 将/ 通用/ 散列/ 函数/ 作为/ 的/ GDH/ 问题/ 密钥/ 提取/ 器/ [/ 5/ ]/ ./ 但/ 这种/ 方法/ 需要/ 假设/ 判定/ 性迪菲/ 赫尔曼/ (/ DecisionalDiffie/ -/ Hellman/ ,/ DDH/ )/ 问题/ 是/ 难解/ 的/ ./ 还有/ 一种/ 方法/ 是/ 用/ 难核/ 预测器/ (/ hard/ -/ corepredi/ -/ cate/ )/ 来/ 作为/ 密钥/ 提取/ 器/ [/ 6/ ]/ ./ 这种/ 方法/ 的/ 好处/ 是/ 可以/ 基于/ 因子/ 分解/ 假设/ ,/ 缺点/ 是/ 一次/ 模/ 指数/ 运算/ 只能/ 一次/ 提取/ 一个/ 比特/ ,/ 因而/ 效率/ 太低/ ,/ 不/ 满足/ 实际/ 需要/ ./ 一个/ 自然/ 的/ 问题/ 是/ 如何/ 在/ 因子/ 分解/ 假设/ 下/ 构造/ 高效/ 的/ 复合/ 模数/ 上/ 的/ GDH/ 问题/ 的/ 密钥/ 提取/ 器/ ./ 本文/ 中/ 我们/ 证明/ 了/ Blum/ -/ Blum/ -/ Shub/ (/ BBS/ )/ 生成器/ [/ 7/ ]/ 是/ 复合/ 模数/ 上/ 的/ GDH/ 问题/ 的/ 满足/ 前面/ 要求/ 的/ 密钥/ 提取/ 器/ ./ 大致/ 地说/ ,/ 我们/ 证明/ 了/ ,/ 假设/ 分解/ 模数/ N/ 是/ 困难/ 的/ ,/ 对于/ 任意/ 的/ [/ n/ ]/ 上/ 的/ 真/ 子集/ A/ ,/ 即使/ 给定/ g/ ∏/ i/ ∈/ A/ 生成器/ BBSr/ (/ u/ )/ 提取/ 比特/ 串/ (/ Br/ (/ u/ )/ ,/ Br/ (/ u2/ )/ ,/ …/ ,/ Br/ (/ 2/ / K/ -/ 1/ )/ )/ ,/ 而/ Br/ (/ u/ )/ 表示/ r/ 与/ u/ 的/ 内积/ 比特/ ,/ 〈/ u/ ,/ r/ 〉/ mod2/ ./ 由于/ 提取/ 一个/ 比特/ 只/ 需要/ 一次/ 模/ 平方/ 运算/ ,/ 因此/ ,/ 该/ 提取/ 器/ 的/ 效率/ 很/ 高/ ./ 2/ 构造/ 和/ 安全性/ 定义/ 2.1/ 提取/ 器/ 的/ 构造/ 该/ 提取/ 器/ 由密钥/ 产生/ 算法/ KGEBBS/ 和/ 密钥/ 提取/ 算法/ KEXBBS/ 组成/ ./ KGEBBS/ :/ 根据/ 安全/ 参数/ λ/ ,/ KGEBBS/ 随机/ 地/ 选取/ 两个/ m/ (/ λ/ )/ 比特/ 的/ 素数/ P/ ,/ Q/ 且/ 满足/ P/ ≡/ Q/ ≡/ 3mod4/ ,/ 取/ N/ =/ PQ/ (/ 因此/ N/ 是/ Blum/ 整数/ )/ ;/ 接着/ ,/ KGEBBS/ 从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 随机/ 地/ 选取/ n/ (/ λ/ )/ 个/ 元素/ ,/ 用/ 向量/ 犪/ =/ i/ =/ 1/ (/ a1/ ,/ a2/ ,/ …/ ,/ an/ )/ 表示/ ;/ 从/ QRN/ 中/ 随机/ 地/ 选取/ 一个/ 元素/ g/ ,/ 并/ 随机/ 选取/ 一个/ 与/ N/ 等长/ 的/ 比特/ 串/ r/ ;/ 最后/ ,/ 输出/ (/ g/ ,/ 犪/ ,/ N/ ,/ r/ )/ ./ KEXBBS/ :/ 根据/ 输入/ (/ g/ ,/ 犪/ ,/ N/ ,/ r/ )/ ,/ KEXBBS/ 计算长度/ 为/ / K/ 的/ 比特/ 串/ K/ :/ K/ =/ BBSr/ (/ g/ ∏/ nBr/ (/ g/ ∏/ nBr/ (/ u/ )/ 表示/ 内积/ 〈/ u/ ,/ r/ 〉/ mod2/ ./ 2.2/ 安全性/ 对于/ 上面/ 的/ 提取/ 器/ ,/ 安全性/ 要求/ 对于/ 任意/ 的/ 多项式/ 时间/ 攻击者/ M/ 在/ 下面/ 的/ 与/ 挑战者/ C/ 的/ 游戏/ 中/ 获得/ 的/ 优势/ 可以/ 忽视/ :/ 首先/ ,/ M/ 激起/ KGE/ 询问/ ,/ 挑战者/ C/ 运行/ 接着/ ,/ M/ 激起/ 若干次/ Observe/ 询问/ ,/ 每次/ 使用/ KGEBBS/ ,/ 将/ (/ g/ ,/ N/ ,/ r/ )/ 给/ M/ ;/ 不同/ 的/ [/ n/ ]/ 真/ 子集/ ,/ 用/ A/ 表示/ ./ C/ 计算/ g/ ∏/ i/ ∈/ A/ 给/ M/ ;/ M/ 发起/ Challenge/ 询问/ ,/ C/ 随机/ 地/ 选取/ 比特/ b/ ,/ 计算/ K0/ =/ KEXBBS/ (/ g/ ,/ 犪/ ,/ N/ ,/ r/ )/ ,/ 并/ 选取/ 一个/ 随机/ 的/ 比特/ 串/ K1/ =/ (/ b0/ ,/ …/ ,/ b/ / K/ -/ 1/ )/ ,/ 将/ Kb/ 给/ M/ ;/ 最后/ ,/ M/ 输出/ 一个/ 比特/ b/ 作为/ 对/ 比特/ b/ 的/ 猜测/ ./ M/ 的/ 优势/ 定义/ 为/ AdvIND1/ ]/ -/ Pr/ [/ M/ (/ K1/ )/ =/ 1/ ]/ |/ ./ 另外/ ,/ 我们/ 用/ HJ/ 验/ :/ 该/ 试验/ 基本/ 与/ 上面/ 定义/ 的/ 游戏/ 相同/ ,/ 但/ 对/ Chal/ -/ lenge/ 询问/ 的/ 回答/ 改为/ (/ b0/ ,/ b1/ ,/ …/ ,/ bJ/ -/ 1/ ,/ Br/ (/ g2J/ ∏/ n/ 即前/ J/ 比特/ 与/ K1/ 中/ 相同/ ,/ 而后/ / K/ -/ J/ 比特/ 与/ K0/ 中/ 相同/ ./ 这样/ ,/ H0/ 与/ K0/ 的/ 分布/ 相同/ ,/ 在/ H/ / K/ 串/ 的/ 分布/ 与/ K1/ 的/ 分布/ 相同/ ./ 3/ 安全性/ 证明/ 本/ 节/ 证明/ 上/ 节/ 构造/ 的/ 提取/ 器/ 在/ 因子/ 分解/ 假设/ 下/ 是/ 安全/ 的/ ./ 证明/ 可/ 通过/ 下面/ 3/ 个/ 引理/ 完成/ ./ 引理/ 1/ ./ 如果/ 存在/ 一个/ 多项式/ 时间/ 攻击者/ M/ 在/ 上节/ 构造/ 的/ 提取/ 器中/ 可以/ 获得/ 的/ 优势/ AdvINDBBS/ ,/ M/ (/ λ/ )/ 为/ ε/ (/ λ/ )/ ,/ 则/ 存在/ 一个/ 多项式/ 时间/ 攻击者/ D/ (/ v2/ ,/ N/ ,/ r/ ,/ Page3/ α/ )/ 可以/ 区分/ α/ 是/ Br/ (/ uw/ )/ 或是/ 一个/ 随机/ 比特/ b/ 的/ 优势/ 为/ ε/ (/ λ/ )/ ./ 其中/ ,/ u/ 是/ 唯一/ 满足/ u2/ =/ v2/ 的/ 平方/ 剩余/ ,/ w/ 是/ 一个/ 由/ v2/ 和/ D/ 所用/ 的/ 内部/ 随机数/ 决定/ 的/ 平方/ 剩余/ ,/ ε/ (/ λ/ )/ 等于/ (/ ε/ (/ λ/ )/ -/ n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ )/ // / K/ ./ 证明/ ./ 给定/ 输入/ (/ v2/ ,/ N/ ,/ r/ ,/ α/ )/ ,/ D/ 按/ 如下/ 进行/ 定义/ :/ (/ 1/ )/ 当/ M/ 激起/ KGE/ 询问/ 时/ ,/ D/ 从/ {/ 0/ ,/ 1/ ,/ …/ ,/ / K/ -/ 1/ }/ 随机/ 选取/ J/ =/ k/ ;/ 随机/ 地/ 从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 选取/ n/ 个/ 元素/ ξ/ i/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ ,/ 并用/ ξ/ =/ (/ ξ/ 1/ ,/ ξ/ 2/ ,/ …/ ,/ ξ/ n/ )/ 表示/ ;/ 取/ s/ =/ / K/ ·/ n/ -/ k/ 和/ g/ =/ v2smodN/ ;/ 将/ (/ g/ ,/ N/ ,/ r/ )/ 给/ M/ ;/ (/ 2/ )/ 当/ M/ 用/ [/ n/ ]/ 的/ 真/ 子集/ A/ 发起/ Challenge/ 询问/ 时/ ,/ D/ 定义/ 每个/ ai/ =/ (/ ξ/ i/ +/ 2/ -/ / K/ )/ mod/ γ/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ ,/ 其中/ γ/ =/ ord/ (/ g/ )/ ;/ D/ 计算/ g/ ∏/ i/ ∈/ A/ 作为/ 回答/ ;/ (/ 3/ )/ M/ 发起/ Challenge/ 询问/ ,/ D/ 将/ 下列/ 比特/ 串/ 给/ M/ :/ b0/ ,/ b1/ ,/ …/ ,/ bk/ -/ 1/ ,/ α/ ,/ Br/ (/ g2k/ +/ 1/ ∏/ n2/ / K/ -/ 1/ ∏/ nBr/ (/ g/ (/ 4/ )/ 当/ M/ 输出/ 一个/ 猜测/ 比特/ 时/ ,/ D/ 输出/ 同样/ 的/ 比特/ ./ 我们/ 需要/ 证明/ D/ 可以/ 在/ 关于/ 参数/ λ/ 的/ 多项式/ 时间/ 内/ 进行/ 如/ 上/ 操作/ ./ 显然/ ,/ (/ 1/ )/ 和/ (/ 4/ )/ 可以/ 在/ 多项式/ 时间/ 内/ 进行/ ./ (/ 2/ )/ 和/ (/ 3/ )/ 可以/ 在/ 多项式/ 时间/ 内/ 进行/ 被/ 下面/ 描述/ 和/ 证明/ 的/ 声称/ 1/ 和/ 声称/ 2/ 、/ 3/ 所/ 隐含/ ./ 为此/ ,/ 我们/ 先/ 给出/ 一些/ 事实/ ./ 事实/ 1/ ./ 由/ 如/ 上/ 定义/ 的/ D/ 选择/ 的/ g/ 是/ QRN/ 上/ 一致/ 分布/ 的/ 平方/ 剩余/ ,/ 其阶/ γ/ 为/ 奇数/ ./ 事实/ 1/ 的/ 证明/ ./ 由于/ P/ =/ Q/ =/ 3mod4/ ,/ 所以/ P/ -/ 12/ 和/ Q/ -/ 11/ )/ (/ Q/ -/ 1/ )/ // 4/ ,/ 所以/ |/ QRN/ |/ 为/ 奇数/ ./ 而/ g/ 的/ 阶/ γ/ 整除/ |/ QRN/ |/ ,/ 所以/ γ/ 为/ 奇数/ ./ 由于/ (/ 2/ ,/ |/ QRN/ |/ )/ =/ 1/ ,/ 所以/ QRN/ 上/ 的/ 模/ 平方/ 是/ 置换/ ./ 由于/ v2/ 是/ QRN/ 上/ 一致/ 分布/ 的/ 平方/ 剩余/ ,/ 而且/ 一致/ 分布/ 元素/ 的/ 置换/ 也/ 是/ 一致/ 分布/ 的/ ,/ 所以/ g/ =/ v2s/ 是/ QRN/ 上/ 一致/ 分布/ 的/ 平方/ 剩余/ ./ 事实/ 2/ ./ 对于/ 每个/ 0/ </ i/ </ s/ ,/ g2/ -/ imod/ γ/ 等于/ 事实/ 2/ 的/ 证明/ ./ 因为/ g/ 的/ 阶/ γ/ 为/ 奇数/ ,/ 所以/ v2s/ -/ imodN/ ./ 2/ -/ 1mod/ γ/ 存在/ ./ 注意/ 到/ 2/ -/ 1mod/ γ/ 等于/ γ/ +/ 1v2s/ ,/ 所以/ g2/ -/ imod/ γ/ 等于/ v2s/ -/ imodN/ ./ 平方/ 剩余/ ./ 事实/ 3/ ./ u/ =/ g2/ -/ s/ 是/ 唯一/ 满足/ u2/ =/ v2modN/ 的/ 事实/ 3/ 的/ 证明/ ./ 由于/ g/ =/ v2s/ ,/ 所以/ u2/ =/ (/ g2/ -/ s/ )/ 2/ =/ v/ (/ 2s/ ·/ 2/ -/ s/ ·/ 2/ )/ =/ v2modN/ ./ 又/ 因为/ 2/ -/ 1mod/ γ/ 等于/ γ/ +/ 12/ ,/ 所以/ u/ =/ g2/ -/ s/ 是/ 平方/ 剩余/ ./ 但/ 因为/ N/ 是/ Blum/ 整数/ ,/ 所以/ v2modN/ 在/ QRN/ 上/ 的/ 平方/ 剩余/ 根是/ 唯一/ 的/ ,/ 则/ u/ =/ g2/ -/ s/ 是/ 唯一/ 满足/ u2/ =/ v2modN/ 的/ 平方/ 剩余/ ./ 声称/ 1/ ./ 对于/ 任意/ 的/ [/ n/ ]/ 的/ 真/ 子集/ A/ ,/ D/ 可以/ 在/ 多项式/ 时间/ 内/ 计算/ g/ ∏/ i/ ∈/ A/ 声称/ 1/ 的/ 证明/ ./ 设/ |/ A/ |/ =/ j/ ,/ 因为/ A/ 是/ [/ n/ ]/ 的/ 真/ 子集/ ,/ 所以/ j/ / n/ -/ 1/ ./ 设/ q/ (/ x/ )/ =/ ∏/ i/ ∈/ A/ 由于/ D/ 知道/ 每个/ ξ/ i/ ,/ 所以/ 他/ 可以/ 按整/ 系数/ 计算/ 出/ 多项式/ q/ (/ x/ )/ ,/ 从而/ 计算/ 出/ δ/ i/ ./ 因此/ ,/ g/ ∏/ i/ ∈/ A/ 因为/ s/ =/ / K/ ·/ n/ -/ k/ ,/ i/ / j/ / n/ -/ 1/ ,/ k/ / / K/ -/ 1/ ,/ 所以/ s/ -/ / K/ ·/ i/ =/ / K/ (/ n/ -/ i/ )/ -/ k/ / / K/ -/ k/ / 1/ ./ 又/ 因为/ D/ 知道/ v2/ ,/ 所以/ 他/ 可以/ 计算/ v2/ (/ s/ -/ / K/ ·/ i/ )/ ./ 另外/ ,/ 由于/ D/ 可以/ 计算/ σ/ i/ ,/ 所以/ ,/ D/ 可以/ 计算/ ∏/ j/ 此/ ,/ D/ 可以/ 计算/ g/ ∏/ i/ ∈/ A/ (/ v2/ (/ s/ -/ / K/ ·/ i/ )/ )/ δ/ i/ ./ 而/ g/ ∏/ i/ ∈/ Ai/ =/ 0/ 定义/ w/ :/ 我们/ 定义/ w/ =/ ∏/ n/ -/ 1/ 是/ 多项式/ P/ (/ x/ )/ =/ ∏/ n/ 数/ 范围/ 的/ 系数/ ./ 由于/ D/ 知道/ ξ/ =/ (/ ξ/ 1/ ,/ ξ/ 2/ ,/ …/ ,/ ξ/ n/ )/ ,/ 所以/ 他/ 可以/ 计算/ 出/ 每个/ β/ i/ ./ 另外/ ,/ D/ 还/ 被/ 给定/ v2/ ,/ 所以/ ,/ 他/ 可以/ 计算/ 如/ 上/ 定义/ 的/ w/ ./ 很/ 显然/ ,/ w/ 是/ 平方/ 剩余/ ,/ 而且/ w/ 由/ v2/ 和/ D/ 用来/ 产生/ ξ/ =/ (/ ξ/ 1/ ,/ ξ/ 2/ ,/ …/ ,/ ξ/ n/ )/ 内部/ 随机数/ 决定/ ./ 声称/ 2/ ./ 对于/ 如/ 前面/ 定义/ 的/ (/ 犪/ ,/ g/ ,/ u/ ,/ w/ )/ ,/ 有/ g2k/ ∏/ nai/ =/ uw/ ./ 声称/ 2/ 的/ 证明/ ./ g2k/ ∏/ ng2k/ -/ / K/ ·/ n/ +/ ∑/ n/ -/ 1uv/ ∑/ n/ -/ 1i/ =/ 1Page4/ 声称/ 3/ ./ 对于/ j/ =/ 1/ ,/ …/ ,/ / K/ -/ k/ -/ 1/ ,/ D/ 可以/ 计算/ Br/ (/ g2k/ +/ j/ ∏/ n/ 声称/ 3/ 的/ 证明/ ./ 由/ 声称/ 2/ 知/ ,/ g2k/ ∏/ n/ 于/ j/ =/ 1/ ,/ …/ ,/ / K/ -/ k/ -/ 1/ ,/ 每个/ Br/ (/ g2k/ +/ j/ ∏/ nBr/ (/ (/ uw/ )/ 2j/ )/ 由于/ D/ 知道/ v2/ 和/ w/ ,/ 从而/ 可以/ 计算/ (/ uw/ )/ 2j/ ,/ 进而/ 计算/ Br/ (/ (/ uw/ )/ 2j/ )/ ./ 为了/ 分析/ D/ 的/ 成功/ 概率/ ,/ 我们/ 下面/ 证明/ D/ 模仿/ 的/ ai/ 和/ g/ 与/ 实际/ 定义/ 的/ 游戏/ 中/ 的/ ai/ 和/ g/ 统计/ 不可/ 区分/ ./ 事实/ 4/ ./ 设/ ξ/ i/ 和/ ai/ 是从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 一致/ 随机/ 选取/ ,/ 令/ ai/ 等于/ (/ ξ/ i/ +/ 2/ -/ / K/ )/ mod/ γ/ ,/ 则/ ai/ 与/ aimod/ γ/ 的/ 统计/ 距离/ 为/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 事实/ 4/ 的/ 证明/ ./ 由于/ γ/ 整除/ Q/ -/ 1/ )/ (/ P/ -/ 1/ )/ // 4/ ,/ 所以/ ai/ 在/ 事件/ ξ/ i/ ∈/ [/ (/ Q/ -/ 1/ )/ (/ P/ -/ 1/ )/ // 4/ ]/ 的/ 条件/ 分布/ 与/ aimod/ γ/ 在/ 事件/ ai/ ∈/ [/ (/ Q/ -/ 1/ )/ (/ P/ -/ 1/ )/ // 4/ ]/ 的/ 条件/ 分布/ 是/ 相同/ 的/ ,/ 二者/ 都/ 是/ Z/ γ/ 上/ 的/ 一致/ 分布/ ./ 另外/ ,/ 我们/ 有/ Pr/ [/ ξ/ i/ ∈/ (/ Q/ -/ 1/ )/ (/ P/ -/ 1/ )/ // 4/ ]/ )/ =/ 所以/ ,/ ai/ 与/ aimod/ γ/ 的/ 统计/ 距离/ 为/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 声称/ 4/ ./ (/ 犪/ mod/ γ/ ,/ g/ ,/ N/ ,/ r/ )/ 与/ (/ 犪/ ,/ g/ ,/ N/ ,/ r/ )/ 之间/ 的/ 统计/ 距离/ 为/ n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 声称/ 4/ 的/ 证明/ ./ 犪/ =/ (/ a1/ ,/ a2/ ,/ …/ ,/ an/ )/ 中/ 每个/ 元素/ 都/ 是从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 中/ 一致/ 随机/ 选取/ ,/ 而/ 犪/ 中/ 的/ 每个/ ai/ 都/ 等于/ (/ ξ/ i/ +/ 2/ -/ / K/ )/ mod/ γ/ ./ 由/ 事实/ 4/ 知/ ,/ 对于/ 每个/ 1/ / i/ / n/ ,/ ai/ 与/ aimod/ γ/ 的/ 统计/ 距离/ 为/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 因此/ ,/ (/ 犪/ mod/ γ/ ,/ g/ ,/ N/ ,/ r/ )/ 与/ (/ 犪/ ,/ g/ ,/ N/ ,/ r/ )/ 之间/ 的/ 统计/ 距离/ 为/ n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 由/ 声称/ 2/ 我们/ 知道/ ,/ 如果/ α/ =/ Br/ (/ uw/ )/ ,/ 则/ M/ 观察/ 到/ 的/ 信息/ 的/ 分布/ 与/ HJ/ 机/ 比特/ b/ 时/ ,/ M/ 观察/ 到/ 的/ 信息/ 的/ 分布/ 与/ HJ/ +/ 1/ 一样/ ./ 由/ 事实/ 1/ 和/ D/ 的/ 描述/ ,/ 我们/ 知道/ (/ g/ ,/ N/ ,/ r/ )/ 被/ 完美/ 模仿/ ./ 另外/ ,/ 由于/ 犪/ =/ (/ a1/ ,/ a2/ ,/ …/ ,/ an/ )/ 中/ 每个/ 元素/ 都/ 从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 中/ 一致/ 随机/ 选取/ ,/ 所以/ ,/ 我们/ 有/ |/ Pr/ [/ M/ (/ H0/ 根据/ 声称/ 4/ ,/ 我们/ 有/ |/ Pr/ [/ M/ (/ H0/ |/ Pr/ [/ M/ (/ H0n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ ./ 因此/ ,/ D/ 的/ 优势/ 为/ Pr/ [/ D/ (/ Br/ (/ uw/ )/ )/ =/ 1/ ]/ -/ Pr/ [/ D/ (/ b/ )/ =/ 1/ ]/ =/ / K/ ∑/ / K/ -/ 11Pr/ [/ D/ (/ b/ )/ =/ 1J/ =/ j/ ]/ }/ =/ / K/ ∑/ / K/ -/ 11Pr/ [/ M/ (/ Hj/ +/ 11/ / KPr/ [/ M/ (/ H0Pr/ [/ M/ (/ H/ / K/ -/ 11/ {/ Pr/ [/ M/ (/ H0/ / KPr/ [/ M/ (/ H/ / K/ -/ 1/ ε/ (/ λ/ )/ -/ n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ 由于/ 引理/ 1/ 中/ 定义/ 的/ D/ 自己/ 选择/ ξ/ =/ (/ ξ/ 1/ ,/ ξ/ 2/ ,/ …/ ,/ ξ/ n/ )/ ,/ 而/ w/ 依赖于/ v2/ 和/ ξ/ ,/ 这样/ ,/ D/ 每次/ 被/ 调用/ 时/ ,/ w/ 的/ 值/ 有/ 变化/ 的/ 可能/ ./ 另外/ ,/ D/ 不是/ Br/ (/ uw/ )/ 的/ 预测器/ 而是/ 区分/ 器/ ./ 因此/ ,/ D/ 不/ 适合/ 直接/ 作为/ Goldreich/ -/ Levin/ 重构/ 算法/ 的/ 预言/ 机/ [/ 6/ ]/ ./ 为了/ 克服/ 第一个/ 问题/ ,/ 我们/ 将/ ξ/ =/ (/ ξ/ 1/ ,/ ξ/ 2/ ,/ …/ ,/ ξ/ n/ )/ 在/ 调用/ D/ 之前/ 就/ 固定/ 下来/ ./ 为了/ 克服/ 第/ 2/ 个/ 问题/ ,/ 我们/ 将/ 难核/ 区分/ 器/ 归结/ 为难/ 核/ 预测器/ ./ 具体/ 地/ ,/ 根据/ 输入/ r/ ,/ 我们/ 按/ 如下/ 定义/ 难核/ 预测器/ DN/ ,/ ξ/ ,/ v2/ :/ (/ 1/ )/ 一致/ 随机/ 选择/ 比特/ α/ 和/ β/ ;/ (/ 2/ )/ 以/ 〈/ v2/ ,/ N/ ,/ r/ ,/ α/ 〉/ 为/ 输入/ 激起/ D/ ,/ 并/ 将/ ξ/ 给/ D/ (/ 从而/ D/ 不再/ 自己/ 产生/ ξ/ )/ ;/ (/ 3/ )/ 如果/ D/ 输出/ 1/ 时/ ,/ 则/ DN/ ,/ ξ/ ,/ v2/ 输出/ α/ ,/ 如果/ D/ 输出/ 0/ ,/ 则/ DN/ ,/ ξ/ ,/ v2/ 输出/ β/ ./ 这样/ ,/ w/ 的/ 值/ 不会/ 随着/ DN/ ,/ ξ/ ,/ v2/ 的/ 调用/ 而/ 变化/ ,/ 因此/ ,/ 可以/ 作为/ Goldreich/ -/ Levin/ 重构/ 算法/ 的/ 预言/ 机来/ 恢复/ uw/ ./ 引理/ 2/ ./ 如果/ 存在/ 一个/ 多项式/ 时间/ 攻击者/ M/ 在/ 上节/ 构造/ 的/ 提取/ 器中/ 可以/ 获得/ 的/ 优势/ AdvIND/ 为/ ε/ (/ λ/ )/ ,/ 则/ 以/ 概率/ ε/ (/ λ/ )/ // 2/ (/ 概率/ 定义/ 在/ N/ ,/ v2/ ,/ ξ/ 的/ 选取/ 上/ )/ ,/ 上面/ 定义/ 的/ DN/ ,/ ξ/ ,/ v2/ 可以/ ε/ (/ λ/ )/ // 4/ 的/ 优势/ (/ 定义/ 在/ r/ 的/ 选取/ 上/ )/ 预测/ Br/ (/ uw/ )/ 的/ 值/ ,/ 其中/ ε/ (/ λ/ )/ 等于/ (/ ε/ (/ λ/ )/ -/ n/ (/ λ/ )/ O/ (/ 2/ -/ m/ (/ λ/ )/ )/ )/ // / K/ ./ 证明/ ./ 根据/ 引理/ 1/ ,/ D/ 有/ ε/ (/ λ/ )/ 的/ 优势/ 可以/ 区分/ Br/ (/ uw/ )/ 和/ 随机/ 比特/ b/ ./ 因此/ ,/ 对于/ 至少/ ε/ (/ λ/ )/ // 2/ 比例/ 的/ 随机/ 选择/ 中/ 的/ N/ 、/ v2/ 和/ ξ/ ,/ D/ 有/ ε/ (/ λ/ )/ // 2/ 的/ 优势/ 区分/ Br/ (/ uw/ )/ 和/ 随机/ 比特/ b/ ./ 很/ 显然/ ,/ DN/ ,/ ξ/ ,/ v2/ 可以/ 以/ Page5/ ε/ (/ λ/ )/ // 4/ 的/ 优势/ 预测/ Br/ (/ uw/ )/ ./ 引理/ 3/ ./ 如果/ 存在/ 一个/ 多项式/ 时间/ 攻击者/ M/ 在/ 上节/ 构造/ 的/ 提取/ 器中/ 可以/ 获得/ 的/ 优势/ AdvIND/ 为/ ε/ (/ λ/ )/ ,/ 则/ 存在/ 一个/ 多项式/ 时间/ 算法/ A/ 可以/ 以/ 概率/ Ω/ (/ ε/ (/ λ/ )/ 2/ )/ 分解/ N/ ./ 证明/ ./ 根据/ 输入/ N/ ,/ A/ 可以/ 按/ 如下/ 进行/ 定义/ :/ (/ 1/ )/ 从/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ 一致/ 随机/ 选择/ ξ/ i/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ ,/ 用/ 向量/ 表示/ 为/ ξ/ =/ (/ ξ/ 1/ ,/ …/ ,/ ξ/ n/ )/ ;/ 从/ Z/ / N/ 中/ 一致/ 随机/ 选择/ v/ ,/ 计算/ v2modN/ ;/ (/ 2/ )/ 计算/ w/ =/ v/ ∑/ i/ =/ n/ -/ 1/ 项式/ P/ (/ x/ )/ =/ ∏/ n/ 合/ Z/ 的/ )/ 系数/ ;/ (/ 3/ )/ 调用/ Goldreich/ -/ Levin/ 重构/ 算法/ R/ (/ 1/ λ/ )/ :/ 当/ 要求/ 回答/ Bri/ (/ z/ )/ 的/ 值时/ ,/ 以/ ri/ 为/ 输入/ 调用/ DN/ ,/ ξ/ ,/ v2/ ,/ 并/ 以/ DN/ ,/ ξ/ ,/ v2/ 的/ 输出/ 作为/ 回答/ ;/ 用/ z/ 表示/ R/ 的/ 输出/ ;/ (/ 4/ )/ 计算/ u/ =/ zw/ -/ 1modN/ ./ 若/ R/ 输出/ 的/ 值/ z/ 等于/ uw/ ,/ 则/ 一定/ 有/ u2/ =/ v2modN/ ,/ 当/ u/ ≠/ ±/ vmodN/ ,/ 计算/ 并/ 输出/ gcd/ (/ u/ -/ v/ ,/ N/ )/ ;/ 若/ R/ 输出/ 的/ 值/ z/ 不/ 等于/ uw/ ,/ 则/ 输出/ “/ 失败/ ”/ ./ 由/ 前面/ 引理/ 知/ ,/ 以/ 概率/ ε/ (/ λ/ )/ // 2/ ,/ DN/ ,/ ξ/ ,/ v2/ 能够/ 以/ 优势/ ε/ (/ λ/ )/ // 4/ 来/ 预测/ Br/ (/ uw/ )/ 的/ 值/ ./ 根据/ Goldreich/ -/ Levin/ 定理/ ,/ R/ 能够/ 以/ 概率/ Ω/ (/ ε/ (/ n/ )/ 2/ )/ 提取/ uw/ 的/ 值/ ./ 注意/ 到/ uw/ 和/ w/ 均/ 是/ 平方/ 剩余/ ,/ 所以/ u/ 也/ 是/ 平方/ 剩余/ ./ 因此/ ,/ 以/ 概率/ 1/ // 2/ ,/ u/ 不/ 等于/ ±/ v/ ./ 当/ u/ 不/ 等于/ ±/ v/ 时/ ,/ gcd/ (/ u/ -/ v/ ,/ N/ )/ 是/ N/ 的/ 一个/ 非/ 平凡/ 因子/ ./ 所以/ ,/ 以/ 概率/ Ω/ (/ ε/ (/ n/ )/ 2/ )/ ,/ A/ 能够/ 分解/ N/ ./ 应用/ 举例/ ./ 考虑/ 一个/ 二方/ 密钥/ 交换/ 协议/ :/ 甲方/ 随机/ 选取/ 私钥/ a1/ ,/ 将/ A1/ =/ ga1/ 发送给/ 乙方/ ;/ 乙方/ 随机/ 地/ 选取/ 私钥/ a2/ ,/ 将/ A2/ =/ ga2/ 发送给/ 甲方/ ;/ 甲/ 和/ 乙/ 的/ 共同/ 密钥/ 为/ BBSr/ (/ ga1a2/ )/ ./ 根据/ 我们/ 的/ 结论/ ,/ 即使/ 攻击者/ 看到/ 了/ ga1/ ,/ ga2/ 后/ ,/ 甲/ 和/ 乙/ 的/ 共同/ 密钥/ BBSr/ (/ ga1a2/ )/ 仍然/ 是/ 伪/ 随机/ 的/ ./ 从而/ 这个/ 密钥/ 交换/ 协议/ 是/ 被动/ 攻击/ 下/ 不可/ 区分/ 意义/ 安全/ 的/ ./ 我们/ 再/ 考虑/ 一个/ 三方/ 密钥/ 交换/ 协议/ :/ 甲方/ 随机/ 地/ 选取/ 私钥/ a1/ ,/ 将/ ga1/ 发送给/ 乙方/ ;/ 乙方/ 收到/ ga1/ 后/ ,/ 随机/ 地/ 选取/ 私钥/ a2/ ,/ 将/ (/ ga1/ ,/ ga2/ ,/ ga1a2/ )/ 发送给/ 丙方/ ;/ 丙方/ 收到/ 信息/ 后/ ,/ 随机/ 地/ 选取/ 私钥/ a3/ ,/ 将/ (/ ga3/ ,/ ga1a3/ ,/ ga2a3/ )/ 发送给/ 甲方/ 和/ 乙方/ ;/ 根据/ 各自/ 的/ 私钥/ ,/ 甲/ 、/ 乙/ 、/ 丙/ 三方/ 可以/ 计算/ 出/ 共同/ 密钥/ BBSr/ (/ ga1a2a3/ )/ ./ 根据/ 我们/ 的/ 结论/ ,/ 攻击者/ 即使/ 看到/ 了/ (/ ga1/ ,/ ga2/ ,/ ga3/ ,/ ga1a2/ ,/ ga1a3/ ,/ ga2a3/ )/ ,/ 甲/ 、/ 乙/ 、/ 丙/ 3/ 方/ 的/ 共同/ 密钥/ BBSr/ (/ ga1a2a3/ )/ 仍然/ 是/ 伪/ 随机/ 的/ ,/ 从而/ 该/ 密钥/ 交换/ 协议/ 是/ 被动/ 攻击/ 下/ 不可/ 区分/ 意义/ 安全/ 的/ ./ 4/ 相关/ 工作/ 比较/ 与/ 之/ 不同/ 的/ 是/ ,/ 在/ 我们/ 的/ 方案/ 中/ ,/ 安全性/ 要求/ 即/ 在/ 文献/ [/ 8/ ]/ 中/ ,/ BBS/ 生成器/ 被/ 用作/ 在/ 因子/ 分解/ 假设/ 下/ 具有/ 单向/ 安全性/ 的/ Rabin/ 公钥/ 加密/ 方案/ 的/ 密钥/ 提取/ 器/ ,/ 得到/ 了/ 具有/ 不可/ 区分/ 安全性/ 的/ Blum/ -/ Goldwasser/ 公钥/ 加密/ 方案/ ./ 具体地说/ ,/ 他们/ 证明/ 了/ 即使/ 给定/ 了/ u2/ / K/ ,/ BBSr/ (/ u/ )/ 仍然/ 是/ 伪/ 随机/ 的/ ./ Naor/ 、/ Reingold/ 与/ Rosen/ 基于/ BBS/ 生成器/ 提出/ 了/ 基于/ 因子/ 分解/ 假设/ 的/ 伪/ 随机/ 函数/ [/ 9/ ]/ ./ 具体地说/ ,/ 他们/ 提出/ 的/ 伪/ 随机/ 函数/ 是/ BBSr/ (/ g/ ∏/ nx2/ ,/ …/ ,/ xn/ )/ 是/ X/ 的/ 比特/ 表示/ ,/ 犪/ =/ (/ a1/ ,/ 0/ ,/ a1/ ,/ 1/ ,/ …/ ,/ an/ ,/ 0/ ,/ an/ ,/ 1/ )/ ,/ 每个/ ai/ ,/ j/ ∈/ [/ (/ N/ -/ 1/ )/ // 4/ ]/ ./ 其/ 安全性/ 要求/ 即使/ 攻击者/ 获得/ 了/ 对于/ 任意/ 的/ Y/ ≠/ X/ 的/ BBSr/ (/ g/ ∏/ nBBSr/ (/ g/ ∏/ n/ 使/ 攻击者/ 看到/ 了/ g/ ∏/ i/ ∈/ ABBSr/ (/ g/ ∏/ n/ 计算/ BBSr/ (/ g/ ∏/ i/ ∈/ A/ 计算/ g/ ∏/ i/ ∈/ A/ 更/ 多/ 的/ 信息/ ./ 这个/ 区别/ 在/ 公钥/ 加密/ 和/ 密钥/ 交换/ 的/ 应用/ 非常/ 重要/ :/ 在/ 公钥/ 加密/ 和/ 二方/ 密钥/ 交换/ 协议/ 中/ ,/ 攻击者/ 可以/ 看到/ ga1/ 和/ ga2/ ./ 在/ 多方/ 密钥/ 交换/ 协议/ 中/ ,/ 攻击者/ 可以/ 看到/ 相应/ 于/ [/ n/ ]/ 一些/ 子集/ A/ 的/ g/ ∏/ i/ ∈/ A/ 在/ 证明/ 方法/ 上/ ,/ 我们/ 借鉴/ 了/ NRR/ 中/ 的/ 证明/ 技巧/ ./ 我们/ 的/ 证明/ 与/ NRR/ 中/ 的/ 证明/ 都/ 是/ 分为/ 3/ 个/ 步骤/ :/ 第/ 1/ 步是/ 将/ 方案/ 的/ 安全性/ 归结/ 为难/ 核/ 区分/ 器/ (/ hardcoredistinguisher/ )/ ;/ 第/ 2/ 步/ 将/ 难核/ 区分/ 器/ 归结/ 为难/ 核/ 预测器/ ;/ 第/ 3/ 步/ 将/ 难核/ 预测器/ 归结为/ 因子/ 分解/ 算法/ ./ 在/ 后/ 两步/ 的/ 具体/ 证明/ 也/ 基本相同/ ./ 不同之处/ 在/ 第/ 1/ 步/ :/ 在/ 我们/ 的/ 证明/ 中/ ,/ 对于/ 攻击者/ 的/ 任意/ 询问/ A/ ,/ 我们/ 必须/ 模仿/ g/ ∏/ i/ ∈/ A/ 在/ 他们/ 的/ 证明/ 中/ ,/ 对于/ 攻击者/ 的/ 任意/ 询问/ Y/ ,/ 他们/ 必须/ 模仿/ BBSr/ (/ g/ ∏/ n/ 在/ 2010/ 年/ 国际/ 理论/ 密码学/ 年/ 会上/ ,/ Cramer/ 、/ Page6Hofheinz/ 和/ Kiltz/ 得到/ 了/ 一个/ 基于/ RSA/ 假设/ 的/ 选择/ 密文/ 安全/ 公钥/ 密码/ 方案/ [/ 10/ ]/ ./ 但/ 他们/ 需要/ 一个/ 在/ RSA/ 假设/ (/ 或/ 更弱/ 的/ 因子/ 分解/ 假设/ )/ 下/ 的/ 迪菲/ 赫尔曼/ 问题/ 的/ 提取/ 器/ ./ 即/ ,/ 他们/ 需要/ 一个/ 提取/ 器/ Ext/ 满足/ :/ 即使/ 给定/ (/ gx/ ,/ gy/ )/ ,/ Ext/ (/ gxy/ )/ 仍然/ 是/ 伪/ 随机/ 的/ ./ 而/ 我们/ 的/ 结论/ 说明/ 了/ BBS/ 生成器/ (/ 取/ n/ =/ 2/ 时/ )/ 正是/ 满足/ 这种/ 要求/ 的/ 提取/ 器/ ./ 

