Page1/ 无线/ 传感器/ 网络/ 中/ 隐私/ 保护/ 通用/ 近似/ 查询/ 协议/ 范永健/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 陈红/ 1/ )/ ,/ 2/ )/ 张晓莹/ 1/ )/ ,/ 2/ )/ 彭辉/ 1/ )/ ,/ 2/ )/ 李翠平/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 中国人民大学/ 数据/ 工程/ 与/ 知识/ 工程/ 教育部/ 重点/ 实验室/ 北京/ 100872/ )/ 2/ )/ (/ 中国人民大学/ 信息/ 学院/ 北京/ 100872/ )/ 3/ )/ (/ 河北/ 工程/ 大学/ 信息/ 与/ 电气/ 工程学院/ 河北/ 邯郸/ 056038/ )/ 摘要/ 无线/ 传感器/ 网络/ 中/ 实现/ 隐私/ 保护/ 通用/ 近似/ 查询/ 是/ 具有/ 挑战性/ 的/ 问题/ ./ 文中/ 提出/ 一种/ 无线/ 传感器/ 网络/ 中/ 隐私/ 保护/ 通用/ 近似/ 查询/ 协议/ PGAQ/ ./ PGAQ/ 将/ 传感器/ 节点/ 编号/ 和/ 其/ 采集/ 数据/ 隐藏/ 于/ 设计/ 的/ 数据结构/ 中/ ,/ 在/ 基站/ 构造/ 线性方程组/ 解/ 出/ 直方图/ ,/ 根据/ 直方图/ 具有/ 的/ 统计/ 信息/ ,/ 不/ 泄露/ 隐私/ 地/ 完成/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 、/ SUM/ 、/ MAX/ // MIN/ 、/ Median/ 、/ Histogram/ 等/ 近似/ 查询/ ./ PGAQ/ 使用/ 网/ 内/ 求和/ 聚集/ 以/ 减少/ 能量消耗/ ,/ 并且/ 能够/ 通过/ 调节/ 直方图/ 划分/ 粒度/ 来/ 平衡/ 查询/ 精度/ 与/ 能量消耗/ ./ PGAQ/ 协议/ 分为/ H/ -/ PGAQ/ 和/ F/ -/ PGAQ/ 两种/ 模式/ ./ H/ -/ PGAQ/ 模式/ 使用/ 数据/ 扰动/ 技术/ 加强/ 数据/ 安全性/ ,/ F/ -/ PGAQ/ 使用/ 过滤器/ 减少/ 连续/ 查询/ 通信量/ ./ 通过/ 理论/ 分析/ 和/ 使用/ 真实/ 数据/ 集/ 实验/ 验证/ 了/ PGAQ/ 的/ 安全性/ 和/ 有效性/ ./ 关键词/ 无线/ 传感器/ 网络/ ;/ 隐私/ 保护/ ;/ 近似/ 查询/ ;/ 数据/ 聚集/ ;/ 物/ 联网/ 1/ 引言/ 物/ 联网/ 隐私/ 保护/ 技术水平/ 直接/ 影响/ 物/ 联网/ 的/ 应用/ 发展/ ./ 无线/ 传感器/ 网络/ (/ 以下/ 简称/ 为/ 传感器/ 网络/ )/ 是/ 物/ 联网/ 的/ 重要/ 组成部分/ ,/ 在/ 环境监测/ 、/ 医疗卫生/ 、/ 智能/ 交通/ 、/ 国防/ 军事/ 等/ 领域/ 具有/ 广阔/ 的/ 应用/ 前景/ ./ 随着/ 传感器/ 网络/ 的/ 应用/ 发展/ ,/ 在/ 实际/ 应用/ 部署/ 过程/ 中/ 暴露出/ 严重/ 的/ 隐私/ 数据/ 泄漏/ 或/ 被/ 篡改/ 的/ 威胁/ ./ 传感器/ 网络/ 实际/ 部署/ 中暴/ 漏出/ 的/ 严重/ 隐私/ 泄露/ 问题/ ,/ 引起/ 了/ 研究/ 人员/ 的/ 高度重视/ ,/ 隐私/ 保护/ 技术/ 目前/ 已/ 成为/ 研究/ 热点/ ./ 目前/ ,/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 技术/ 主要/ 针对/ 数据/ 聚集/ 、/ 数据/ 查询/ 和/ 访问控制/ 中/ 数据/ 隐私/ 保护/ 问题/ 进行/ 研究/ [/ 1/ ]/ ./ 在/ 隐私/ 保护/ 数据/ 聚集/ 方面/ ,/ 文献/ [/ 2/ -/ 11/ ]/ 研究/ 了/ 在/ 不/ 泄露/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 完成/ SUM/ 、/ MIX/ 、/ MAX/ 或/ Median/ 等/ 数据/ 聚集/ 操作/ ,/ 但是/ 这些/ 成果/ 不/ 能够/ 通过/ 网/ 内/ 数据/ 聚集/ 完成/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 等/ 复杂/ 查询/ ./ 在/ 隐私/ 保护/ 数据/ 查询/ 方面/ ,/ 文献/ [/ 12/ -/ 15/ ]/ 分别/ 研究/ 了/ 范围/ 查询/ (/ rangequery/ )/ 、/ Top/ -/ k/ 查询/ 等/ 查询/ 中/ 隐私/ 保护/ 技术/ ,/ 但是/ 不/ 能够/ 在/ 不/ 泄露/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 同时/ 完成/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 等/ 查询/ 操作/ ./ 传感器/ 网络/ 中/ 能量消耗/ 往往/ 直接/ 影响/ 网络/ 寿命/ ,/ 网/ 内/ 数据/ 聚集/ 是/ 传感器/ 网络/ 常用/ 的/ 减少/ 能量消耗/ 技术/ ./ 在/ 实际/ 应用/ 中/ ,/ 常常/ 既/ 需要/ 查询/ 采集/ 数据/ 值/ 最高/ (/ 或/ 最低/ )/ 的/ 前/ k/ 个/ 传感器/ 节点/ ,/ 又/ 需要/ 查询/ 采集/ 数据/ 值/ 在/ 某个/ 范围/ 的/ 传感器/ 节点/ ,/ 仅能/ 实现/ 单一/ 查询/ 类型/ 的/ 隐私/ 保护/ 协议/ 在/ 实际/ 应用/ 中是/ 受限/ 的/ ./ 所以/ ,/ 研究/ 使用/ 网/ 内/ 数据/ 聚集/ 的/ 隐私/ 保护/ 通用/ 查询/ 协议/ 具有/ 积极意义/ ./ 因为/ 具有/ 诸多/ 挑战性/ ,/ 目前/ 这方面/ 研究成果/ 基本/ 还是/ 空白/ ./ 使用/ 网/ 内/ 聚集/ 的/ 隐私/ 保护/ 通用/ 查询/ 协议/ 具有/ 以下/ 挑战/ :/ (/ 1/ )/ 因为/ Top/ -/ k/ 等/ 查询/ 需要/ 全局/ 信息/ ,/ 这/ 就/ 要求/ 网/ 内/ 数据/ 聚集/ 既/ 要/ 完成/ 数据/ 融合/ 或/ 压缩/ 又/ 要/ 保留/ 全局/ 信息/ ;/ (/ 2/ )/ 聚集/ 节点/ 需要/ 在/ 不能/ 获得/ 数据/ 真实/ 值/ 的/ 情况/ 下/ ,/ 实现/ 数据/ 融合/ 或/ 压缩/ ;/ (/ 3/ )/ 常用/ 查询/ 往往/ 既/ 需要/ 符合/ 查询/ 条件/ 的/ 采集/ 数据/ 值/ ,/ 同时/ 还/ 需要/ 相应/ 的/ 传感器/ 节点/ 编号/ ,/ 以便/ 获取/ 需要/ 关注/ 的/ 区域/ 等/ 信息/ ./ 本文/ 提出/ 使用/ 网/ 内/ 数据/ 聚集/ 的/ 隐私/ 保护/ 通用/ 近似/ 查询/ 协议/ ,/ 将/ 传感器/ 节点/ 编号/ 和/ 其/ 采集/ 的/ 感知/ 数据/ 等/ 信息/ 隐藏/ 于/ 随机/ 向量/ 中/ ,/ 中间/ 聚集/ 节点/ 对/ 上传/ 向量/ 进行/ 求和/ 聚集/ ,/ 在/ 基站/ 构造/ 线性方程组/ ,/ 解出/ 带/ 全局/ 统计/ 信息/ 的/ 直方图/ 和/ 对应/ 的/ 传感器/ 节点/ 编号/ ,/ 使用/ 直方图/ 中/ 统计/ 信息/ 完成/ 隐私/ 保护/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 、/ SUM/ 、/ MAX/ // MIN/ 、/ Median/ 、/ Histogram/ 等/ 近似/ 查询/ ./ 本文/ 主要/ 贡献/ :/ (/ 1/ )/ 提出/ 一种/ 新颖/ 的/ 能够/ 完成/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 、/ SUM/ 、/ MAX/ // MIN/ 等/ 查询/ 的/ 隐私/ 保护/ 通用/ 近似/ 查询/ 协议/ ;/ (/ 2/ )/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ ,/ 使用/ 网/ 内/ 数据/ 聚集/ 和/ 过滤器/ 等/ 策略/ 减少/ 近似/ 查询/ 能量消耗/ ;/ (/ 3/ )/ 在/ 不/ 需要/ 修改/ 模型/ 的/ 情况/ 下/ ,/ 通过/ 参数/ 调节/ 能够/ 实现/ 对/ 隐私/ 保护/ 近似/ 查询/ 精度/ 控制/ ;/ (/ 4/ )/ 通过/ 理论/ 分析/ 和/ 使用/ 真实/ 数据/ 集/ 实验/ 验证/ 了/ PGAQ/ 协议/ 的/ 安全性/ 和/ 有效性/ ./ 本文/ 第/ 2/ 节/ 总结/ 相关/ 工作/ ;/ 第/ 3/ 节/ 介绍/ 研究/ 基于/ 的/ 模型/ 和/ 性能需求/ ;/ 第/ 4/ 节/ 描述/ 协议/ 的/ 两个/ 模式/ ;/ 第/ 5/ 节/ 进行/ 性能/ 分析/ ;/ 第/ 6/ 节/ 使用/ 真实/ 数据/ 进行/ 实验/ 并/ 分析/ ;/ 第/ 7/ 节/ 总结/ 本文/ ./ 2/ 相关/ 工作/ 目前/ ,/ 面向/ 数据/ 的/ 隐私/ 保护/ 技术/ 研究成果/ 主要/ 集中/ 在/ 数据挖掘/ 和/ 数据/ 发布/ 两个/ 领域/ [/ 16/ ]/ ,/ 综合/ 现有/ 的/ 研究成果/ ,/ 隐私/ 保护/ 技术/ 主要/ 可/ 分为/ 三类/ :/ 数据/ 扰乱/ 技术/ 、/ 数据/ 加密技术/ 和/ 数据/ 匿名/ 化/ 技术/ ./ 数据挖掘/ 和/ 数据/ 发布/ 领域/ 的/ 隐私/ 保护/ 技术/ 为/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 提供/ 技术/ 借鉴/ 和/ 支撑/ ,/ 但是/ 往往/ 由于/ 能量消耗/ 大/ 或/ 不/ 适合/ 分布式/ 环境/ 等/ 因素/ 不能/ 直接/ 应用/ 于/ 传感器/ 网络/ ./ 现有/ 的/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 技术/ 研究成果/ 主要/ 集中/ 在/ 隐私/ 保护/ 数据/ 聚集/ 和/ 隐私/ 保护/ 数据/ 查询/ 两/ 方面/ ./ 传感器/ 网络/ 中/ 隐私/ 保护/ 数据/ 聚集/ 协议/ 采用/ 不同/ 的/ 加密/ 方式/ 进行/ 隐私/ 保护/ ./ 文献/ [/ 2/ -/ 4/ ]/ 使用/ 逐跳/ 加密/ 方式/ (/ hopbyhop/ )/ 应对/ 通信/ 链路/ 窃听/ 攻击/ ./ 文献/ [/ 2/ -/ 3/ ]/ 使用/ 数据/ 扰动/ (/ perturbation/ )/ 技术/ 应对/ 俘获/ 节点/ 窃听/ 攻击/ ,/ 在/ 原始数据/ 中/ 添加/ 随机/ 种子/ 和/ 私有/ 随机数/ 进行/ 扰乱/ 来/ 隐藏/ 真实/ 数据/ 值/ ,/ 簇头/ 节点/ 利用/ 多项式/ 的/ 代数/ 性质/ 求解/ 出/ 精确/ 的/ 聚集/ 结果/ ./ 文献/ [/ 2/ ,/ 4/ ]/ 使用/ 切分/ 重组/ (/ shuffling/ )/ 技术/ 应对/ 俘获/ 节点/ 窃听/ 攻击/ ./ 文献/ [/ 5/ -/ 9/ ]/ 使用/ 端到/ 端/ 加密/ 机制/ ,/ 端到/ 端/ 加密/ 机制/ 可以/ 较/ 好/ 地/ 应对/ 内部/ 攻击/ 和/ 外部/ 攻击/ ,/ 但/ 需要/ 使用/ 同态/ 加密/ 模式/ 在/ 加密/ 数据/ 上/ 实现/ 数据/ 聚集/ ./ 文献/ [/ 5/ -/ 7/ ]/ 使用/ 求和/ 同态/ 加密/ 模式/ ,/ 文献/ [/ 8/ ]/ 使用/ Domingo/ -/ Ferrer/ 提出/ 的/ 同态/ 加密/ 模式/ (/ DFscheme/ )/ ,/ 文献/ [/ 9/ ]/ 使用/ 基于/ 椭圆/ 曲线/ 的/ 同态/ 加密/ 模式/ ./ 文献/ [/ 10/ ]/ 在/ 不/ 加密/ 的/ 情况/ 下/ 通过/ 添加/ 伪装/ 数据/ (/ camouflagedata/ )/ 主要/ 实现/ 隐私/ 保护/ MAX/ // MIN/ 非线性/ 聚集/ ./ 文献/ [/ 11/ ]/ 使用/ 扰乱/ 直方图/ 技术/ 实现/ 隐私/ 保护/ 近似/ MAX/ // MIN/ 、/ Page3SUM/ 、/ Median/ 等/ 聚集/ 操作/ ./ 上述/ 文献/ 在/ 聚集/ 节点/ 不能/ 获得/ 真实/ 数据/ 值/ 的/ 情况/ 下/ 实现/ 聚集/ 操作/ ,/ 但是/ 由于/ 聚集/ 信息/ 中/ 没有/ 携带/ 传感器/ 节点/ 编号/ 信息/ ,/ 所以/ 不能/ 实现/ 需要/ 传感器/ 节点/ ID/ 的/ 复杂/ 查询/ ,/ 如/ Top/ -/ k/ 查询/ 或/ 范围/ 查询/ 等/ ./ 文献/ [/ 12/ -/ 14/ ,/ 17/ ]/ 对/ 传感器/ 网络/ 中/ 隐私/ 保护/ 范围/ 查询/ 进行/ 研究/ ,/ 基于/ 的/ 网络/ 模型/ 为/ 高/ 资源/ 节点/ 为/ 存储/ 节点/ 的/ 两层/ 传感器/ 网络/ ./ 文献/ [/ 12/ ]/ 采用/ 桶/ 模式/ (/ bucketingscheme/ )/ 和/ 加密技术/ 完成/ 隐私/ 保护/ 范围/ 查询/ ,/ 文献/ [/ 14/ ]/ 使用/ 前缀/ 成员/ 验证/ 技术/ (/ prefixmembershipverificationtechnique/ )/ 在/ 编码数据/ 上/ 实现/ 范围/ 查询/ 而/ 不/ 泄漏/ 数据/ 值/ ./ 文献/ [/ 17/ ]/ 利用/ 多项式/ 技术/ 对/ 节点/ 采集/ 的/ 数据/ 范围/ 信息/ 和/ 查询/ 条件/ 进行/ 编码/ ,/ 保证/ 存储/ 节点/ 在/ 不/ 知道/ 数据/ 和/ 查询/ 条件/ 真实/ 内容/ 的/ 情况/ 下/ 正确/ 地/ 执行/ 范围/ 查询处理/ ./ 文献/ [/ 15/ ]/ 使用/ 数据/ 扰乱/ 和/ 安全/ 比较/ 技术/ ,/ 提出/ 一种/ 两层/ 传感器/ 网络/ 中/ 隐私/ 保护/ Top/ -/ k/ 查询/ 协议/ ./ 上述/ 文献/ 针对/ 两层/ 传感器/ 网络/ 中/ 单一/ 查询/ 类型/ 有效/ ,/ 不能/ 同时/ 完成/ Top/ -/ k/ 和/ 范围/ 等/ 查询/ ,/ 不/ 具有/ 通用性/ ,/ 并且/ 不能/ 在/ 节点/ 相似/ 网络/ 中/ 应用/ ./ 近似/ 查询/ 是/ 传感器/ 网络/ 中/ 重要/ 的/ 查询/ 方式/ ,/ 在/ 对/ 精度/ 要求/ 不高/ 的/ 情况/ 下/ ,/ 可以/ 在/ 精度/ 和/ 能量消耗/ 之间/ 进行/ 平衡/ ./ 文献/ [/ 18/ -/ 19/ ]/ 研究/ 了/ 传感器/ 网络/ 中/ 的/ 近似/ 查询/ ,/ 但是/ 没有/ 考虑/ 隐私/ 保护/ 问题/ ./ 3/ 研究/ 模型/ 和/ 背景/ 3.1/ 传感器/ 网络/ 和/ 数据/ 聚集/ 模型/ 现有/ 传感器/ 网络/ 数据/ 隐私/ 保护/ 研究/ 主要/ 基于/ 节点/ 相似/ 的/ 传感器/ 网络/ 和/ 两层/ 传感器/ 网络/ 两种/ 网络/ 模型/ [/ 1/ ]/ ./ 本文/ 研究/ 基于/ 节点/ 相似/ 的/ 传感器/ 网络/ 模型/ ,/ 网/ 内/ 传感器/ 节点/ 在/ 初始/ 能量/ 、/ 存储/ 能力/ 、/ 通信/ 能力/ 方面/ 都/ 是/ 相似/ 的/ ,/ 所有/ 网/ 内/ 节点/ 都/ 有/ 可能/ 成为/ 聚集/ 节点/ 等/ 承担/ 更/ 多任务/ 的/ 节点/ ./ 本文/ 考虑/ 的/ 传感器/ 网络/ 模型/ 由/ 基站/ 和/ n/ 个/ 传感器/ 节点/ 构成/ ,/ 每个/ 传感器/ 节点/ 编号/ 唯一/ ,/ 传感器/ 节点/ 编号/ 记/ 为/ {/ s1/ ,/ s2/ ,/ …/ ,/ sn/ }/ ./ 基站/ 具有/ 充足/ 的/ 存储/ 、/ 计算/ 和/ 通信/ 能力/ ,/ 并且/ 能够/ 获取/ 网络/ 全局/ 的/ 拓扑/ 结构/ 信息/ ./ 网络/ 能够/ 形成/ 树形/ 路由/ ,/ 基站/ 通过/ 树形/ 路由/ 下发/ 查询/ 需求/ ,/ 传感器/ 节点/ 通过/ 树形/ 路由/ 将/ 查询/ 响应/ 数据/ 上传/ 至/ 基站/ ./ 在/ 上传/ 查询/ 响应/ 过程/ 中/ ,/ 非/ 叶子/ 节点/ 对/ 其/ 孩子/ 节点/ 数据/ 和/ 本/ 节点/ 采集/ 数据/ 进行/ 聚集/ 融合/ ,/ 仅/ 上传/ 聚集/ 后/ 数据/ ./ 聚集/ 函数/ 可定义/ 为/ y/ (/ t/ )/ / f/ (/ Vs1/ (/ t/ )/ ,/ …/ ,/ Vsi/ (/ t/ )/ ,/ …/ ,/ Vsn/ (/ t/ )/ )/ ,/ 其中/ Vsi/ (/ t/ )/ 为/ 节点/ si/ 在/ t/ 时间段/ 采集/ 的/ 数据/ ./ 本文/ 使用/ 求和/ 聚集/ 函数/ 为/ f/ (/ t/ )/ =/ ∑/ n3/ ./ 2/ 查询/ 模型/ PGAQ/ 协议/ 中/ 查询/ 模型/ 分为/ 通用/ 近似/ 查询/ 模型/ 和/ 网内/ 查询/ 模型/ ./ 用户/ 使用/ 通用/ 近似/ 查询/ 模型/ 向/ 基站/ 发送/ 查询/ 命令/ ,/ 基站/ 使用/ 网/ 内/ 查询/ 模型/ 通过/ 路由/ 树/ 下/ 发给/ 传感器/ 节点/ ,/ 传感器/ 节点/ 将/ 感知/ 数据/ 通过/ 非/ 叶子/ 节点/ 聚集/ 并/ 上传/ ,/ 基站/ 根据/ 聚集/ 结果/ 推导/ 出/ 直方图/ ,/ 根据/ 直方图/ 计算/ 出/ 用户/ 需要/ 的/ 通用/ 近似/ 查询/ 结果/ ,/ 将/ 其/ 返回/ 给/ 用户/ ./ 通用/ 近似/ 查询/ 模型/ 描述/ 为/ / G/ =/ (/ queryregion/ =/ G/ )/ ∧/ (/ epoch/ =/ t/ )/ ∧/ (/ querytype/ =/ T/ )/ ∧/ (/ queryparameter/ =/ P/ )/ ∧/ (/ approximateparameter/ =/ ε/ )/ ,/ 其中/ ,/ G/ 为/ 查询/ 区域/ ,/ t/ 为/ 查询/ 周期/ ,/ T/ 为/ 用户/ 需要/ 返回/ 的/ 查询/ 类型/ 集合/ ,/ P/ 为/ T/ 中/ 查询/ 类型/ 所/ 需/ 的/ 参数/ 集合/ ,/ ε/ 为/ 近似/ 查询/ 精度/ 阈值/ 参数/ ./ PGAQ/ 协议/ 所/ 支持/ 的/ 查询/ 类型/ 有/ Top/ -/ k/ 查询/ ,/ 范围/ 查询/ 、/ MAX/ \/ MIN/ ,/ SUM/ 、/ Median/ 、/ Histogram/ 等/ ./ T/ 中/ 可以/ 是/ 单个/ 查询/ 类型/ ,/ 也/ 可以/ 是/ 多个/ PGAQ/ 协议/ 所/ 支持/ 的/ 查询/ 类型/ ./ P/ 中/ 参数/ 应/ 和/ T/ 中/ 查询/ 类型/ 相对/ 应/ ./ 查询/ 类型/ 为/ Top/ -/ k/ 查询/ 时/ ,/ P/ 中/ 参数/ 为/ k/ 值/ ;/ 查询/ 类型/ 为/ 范围/ 查询/ 时/ ,/ P/ 中/ 参数/ 为/ 查询/ 范围/ [/ a/ ,/ b/ ]/ ./ 基站/ 通过/ 树形/ 路由/ 向/ 查询/ 区域/ G/ 内/ 传感器/ 节点/ 下发/ 的/ 网内/ 查询/ 模型/ 为/ 其中/ ,/ t/ 为/ 查询/ 周期/ ,/ (/ H1/ ,/ …/ ,/ Hh/ )/ 为/ 由/ 近似/ 查询/ 精度/ 阈值/ 参数/ ε/ 计算出来/ 的/ 直方图/ 区间/ 划分/ ,/ 如/ ε/ 为/ 默认值/ ,/ 则/ 不/ 需要/ 传/ (/ H1/ ,/ …/ ,/ Hh/ )/ ./ 3.3/ 攻击/ 模型/ 与/ 安全/ 目标/ 传感器/ 网络/ 中/ 针对/ 隐私/ 数据/ 的/ 攻击/ 可/ 分为/ 外部/ 攻击/ 和/ 内部/ 攻击/ 两种/ 攻击/ 模型/ ./ 由于/ 传感器/ 网络/ 采用/ 无线通信/ ,/ 数据/ 在/ 节点/ 之间/ 传输/ 时/ 攻击者/ 可能/ 通过/ 链路层/ 窃听/ 获取/ 敏感数据/ ,/ 这种/ 攻击/ 模式/ 称为/ 外部/ 攻击/ ./ 进行/ 内部/ 攻击/ 时/ ,/ 攻击者/ 通过/ 俘获/ 或/ 复制/ 传感器/ 节点/ 等/ 手段/ 成为/ 网络/ 的/ 参与者/ ,/ 能够/ 获取/ 俘获/ 传感器/ 节点/ 的/ 所有/ 数据/ ./ 本文/ 研究/ 基于/ 诚信/ 但/ 好奇/ (/ honestbutcurious/ )/ 模型/ [/ 15/ ]/ ,/ 攻击者/ 通过/ 记录/ 或/ 推测/ 敏感数据/ 进行/ 窃取/ 信息/ ,/ 但/ 其/ 遵守/ 协议/ 且/ 不/ 篡改/ 数据/ ,/ 仅/ 破坏/ 数据/ 的/ 隐私/ 性/ 但/ 不/ 破坏/ 数据/ 的/ 完整性/ ./ 本文/ 假设/ 攻击者/ 采用/ 两种/ 攻击方式/ 窃取/ 敏感/ 信息/ :/ (/ 1/ )/ 使用/ 外部/ 攻击/ 模式/ ,/ 数据/ 在/ 节点/ 之间/ 传输/ 时/ 通过/ 链路层/ 窃听/ 获取/ 敏感数据/ ;/ (/ 2/ )/ 使用/ 内部/ 攻击/ 模/ Page4/ 式/ ,/ 俘获/ 传感器/ 节点/ 后/ 通过/ 记录/ 或/ 推测/ 敏感数据/ 进行/ 窃取/ 信息/ ./ 本文/ 安全/ 目标/ 为/ :/ 在/ 诚信/ 但/ 好奇/ 模型/ 下/ ,/ PGAQ/ 能够/ 应/ 对外部/ 攻击/ 和/ 内部/ 攻击/ 两种/ 模式/ 的/ 攻击/ ,/ 在/ 不/ 泄漏/ 隐私/ 信息/ 的/ 情况/ 下/ 使用/ 数据/ 聚集/ 完成/ 通用/ 近似/ 聚集/ 查询/ ./ 3.4/ 隐私/ 保护/ 近似/ 查询/ 需求/ 平衡/ :/ 隐私/ 保护/ 近似/ 查询/ 协议/ 需要/ 以下/ 性能需求/ 和/ (/ 1/ )/ 隐私/ 保护/ 需求/ ./ 由于/ 攻击者/ 能够/ 通过/ 无线/ 链路/ 窃听/ 和/ 俘获/ 传感器/ 节点/ 进行/ 攻击/ ,/ 隐私/ 保护/ 近似/ 查询/ 协议/ 应/ 满足/ 以下/ 要求/ :/ 为了/ 保护/ 隐私/ 信息/ ,/ 传感器/ 网络/ 中/ 任意/ 节点/ si/ (/ si/ ∈/ G/ )/ 采集/ 的/ 数据/ Vsi/ 不/ 能够/ 被/ 无线/ 链路/ 窃听/ 者/ 获知/ ,/ 同时/ 也/ 不能/ 被/ 网络/ 中/ 其他/ 任意/ 节点/ sj/ (/ sj/ ∈/ G/ 且/ i/ ≠/ j/ )/ 获知/ ;/ 传感器/ 网络/ 中/ 任意/ 节点/ 不能/ 获知/ 查询/ 结果/ 数据/ 集/ ;/ 传感器/ 网络/ 中/ 任意/ 节点/ 不能/ 获知/ 查询/ 结果/ 数据项/ 对应/ 的/ 传感器/ 节点/ ID/ ./ (/ 2/ )/ 能量/ 消耗量/ ./ 能量消耗/ 往往/ 直接/ 影响/ 传感器/ 网络/ 寿命/ ,/ 减少/ 能量消耗/ 是/ 传感器/ 网络协议/ 重要/ 的/ 性能需求/ ./ 隐私/ 保护/ 技术/ 往往/ 需要/ 增加/ 传感器/ 网络通信/ 量/ 和/ 能量消耗/ ,/ 隐私/ 保护/ 查询/ 协议/ 应/ 尽量减少/ 通信量/ 和/ 能量消耗/ ./ 网内/ 数据/ 聚集/ 和/ 融合/ 能够/ 有效/ 地/ 减少/ 数据传输/ 量/ ,/ 进而/ 减少/ 能量消耗/ ./ 将/ 网内/ 数据/ 聚集/ 和/ 融合/ 应用/ 于/ 隐私/ 保护/ 近似/ 查询/ 协议/ 具有/ 重要/ 意义/ ./ (/ 3/ )/ 查询/ 精度/ ./ 在/ 对/ 精度/ 要求/ 不高/ 的/ 情况/ 下/ ,/ 近似/ 查询/ 可以/ 在/ 精度/ 和/ 能量消耗/ 之间/ 进行/ 平衡/ ,/ 以/ 减少/ 能量消耗/ ./ 同时/ ,/ 近似/ 查询/ 的/ 精度/ 应/ 能够/ 满足/ 应用/ 的/ 需求/ ,/ 所以/ 近似/ 查询/ 精度/ 应/ 能够/ 通过/ 系统/ 参数/ 进行/ 控制/ ,/ 以/ 达到/ 满足/ 应用/ 需求/ 精度/ 和/ 能量消耗/ 之间/ 的/ 平衡/ ./ 4PGAQ/ 协议/ PGAQ/ 通过/ 设计/ 基站/ 与/ 传感器/ 节点/ 共享/ 的/ 数据结构/ ,/ 将/ 传感器/ 节点/ 编号/ 和/ 其/ 采集/ 的/ 感知/ 数据/ 等/ 信息/ 隐藏/ 于/ 构造/ 的/ 向量/ 中/ ,/ 通过/ 树状/ 路由/ 将/ 此/ 向量/ 向/ 基站/ 传送/ ,/ 上传/ 此/ 向量/ 过程/ 中/ 使用/ 网/ 内/ 求和/ 聚集/ 以/ 减少/ 能量消耗/ ,/ 在/ 基站/ 构造/ 线性方程组/ ,/ 解/ 出/ 直方图/ 和/ 对应/ 的/ 传感器/ 节点/ 编号/ ,/ 使用/ 直方图/ 中/ 的/ 统计/ 信息/ ,/ 不/ 泄露/ 隐私/ 地/ 完成/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 、/ SUM/ 、/ MAX/ // MIN/ 、/ Median/ 、/ Histogram/ 等/ 近似/ 查询/ ./ PGAQ/ 基本/ 步骤/ 如图/ 1/ 所示/ ./ 首先/ ,/ 基站/ 为/ 每个/ 传感器/ 节点/ si/ (/ si/ ∈/ G/ )/ 产生/ 唯一/ 的/ 随机/ 向量/ 作为/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ ,/ 加密/ 后/ 下发/ 至/ 对应/ 传感器/ 节点/ si/ ,/ 传感器/ 节点/ si/ 使用/ 其/ 采集/ 的/ 数据/ Vsi/ 和/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 计算/ 响应/ 向量/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ ,/ 根据/ 树状/ 路由/ 将/ 响应/ 向量/ 上传/ 至父/ 节点/ ,/ 父/ 节点/ 作为/ 聚集/ 节点/ ,/ 使用/ 求和/ 聚集/ 函数/ 对/ 所有/ 收到/ 的/ 数据/ 进行/ 聚集/ ,/ 生成/ 本/ 节点/ 的/ 响应/ 向量/ ,/ 然后/ 发送/ 聚集/ 结果/ 至/ 其父/ 节点/ ,/ 依次/ 传送/ 至/ 基站/ ./ 基站/ 使用/ 所有/ 收到/ 的/ 数据/ 计算/ 出/ 统计/ 直方图/ ,/ 根据/ 该/ 直方图/ 完成/ 隐私/ 保护/ 近似/ 查询/ ./ 调节/ 直方图/ 划分/ 粒度/ 来/ 平衡/ 查询/ 精度/ 与/ 能量消耗/ ./ PGAQ/ 协议/ 分为/ H/ -/ PGAQ/ 和/ F/ -/ PGAQ/ 两种/ 模式/ ./ H/ -/ PGAQ/ 模式/ 使用/ 数据/ 扰动/ 技术/ 和/ 单路/ Hash/ 函数/ ,/ 增强/ 了/ 数据/ 安全性/ ./ F/ -/ PGAQ/ 使用/ 过滤器/ 来/ 减少/ 连续/ 查询/ 通信量/ ./ 4.1/ H/ -/ PGAQ/ 模式/ H/ -/ PGAQ/ 协议/ 分为/ 系统/ 初始化/ 和/ 查询/ 两个/ 阶段/ ./ 用/ n/ 表示/ 传感器/ 网络/ 节点/ 的/ 个数/ ,/ 对/ 网内/ 传感器/ 节点/ 进行/ 统一/ 编号/ 分别/ 表示/ 为/ {/ s1/ ,/ s2/ ,/ …/ ,/ sn/ }/ ,/ 用/ [/ vmin/ ,/ vmax/ ]/ 表示/ 传感器/ 节点/ 采集/ 数据/ 的/ 值域/ ./ (/ 1/ )/ 系统/ 初始化/ 阶段/ ./ 基站/ 在/ {/ 1/ ,/ 2/ ,/ 3/ ,/ …/ ,/ 2/ γ/ }/ (/ 其中/ γ/ 为/ 系统/ 参数/ )/ 中/ 随机/ 选择/ m/ ×/ n/ 个/ 不同/ 的/ 正整数/ aij/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ;/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 构成/ m/ ×/ n/ 的/ 参照/ 矩阵/ 犌/ 为/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 与/ 参照/ 矩阵/ 犌/ 中/ 第/ i/ 列/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 对应/ ,/ 将/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 作为/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 的/ 参照/ 向量/ ./ 基站/ 为/ 每个/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 生成/ Page5/ 唯一/ 且/ 长度/ 为/ m/ 的/ 扰动/ 向量/ (/ sn1i/ ,/ sn2i/ ,/ …/ ,/ snmi/ )/ T/ 和/ 单路/ Hash/ 函数/ h/ (/ ·/ )/ ,/ 单路/ Hash/ 函数/ h/ (/ ·/ )/ 能够/ 将/ 数据/ 映射/ 至/ 集合/ {/ 1/ ,/ 2/ ,/ …/ ,/ M/ }/ ,/ 其中/ M/ =/ n/ ×/ vmax/ ×/ 2/ γ/ ,/ vmax/ 为/ 采集/ 数据/ 值域/ [/ vmin/ ,/ vmax/ ]/ 的/ 上界/ ./ 在/ 基站/ ,/ 采集/ 数据/ 值域/ [/ vmin/ ,/ vmax/ ]/ 被/ 连续/ 划分/ 为/ h/ 个/ 区间/ ,/ 表示/ 为/ (/ H1/ ,/ …/ ,/ Hh/ )/ ./ 基站/ 使用/ 与/ 每个/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 共享/ 密钥/ 进行/ 加密/ ,/ 为了/ 增加/ 安全性/ ,/ PGAQ/ 采用/ 文献/ [/ 12/ ]/ 中/ 周期/ 更换/ 密钥/ 方式/ ,/ 用/ ki/ ,/ t/ 表示/ 周期/ t/ 内/ 传感器/ 节点/ si/ 与/ Sink/ 共享/ 的/ 密钥/ ,/ 则/ 有/ ki/ ,/ t/ =/ hash/ (/ ki/ ,/ t/ -/ 1/ )/ ./ 用/ Eki/ ,/ t/ {/ }/ 表示/ 加密/ 过程/ ,/ 向/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 传送/ 如下/ 消息/ :/ Sink/ →/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ :/ i/ ,/ Eki/ ,/ t/ {/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ ,/ (/ sn1i/ ,/ sn2i/ ,/ …/ ,/ snmi/ )/ T/ ,/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 收到/ 消息/ 后/ ,/ 使用/ 与/ 基站/ 共享/ 密钥/ ki/ 进行/ 解密/ ,/ 得到/ 与/ 基站/ 排/ 他/ 共享/ 的/ 如下/ 信息/ :/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 、/ 扰动/ 向量/ (/ sn1i/ ,/ sn2i/ ,/ …/ ,/ snmi/ )/ T/ 、/ 单路/ Hash/ 函数/ h/ (/ ·/ )/ 和/ 采集/ 数据/ 值域/ 划分/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ ./ (/ 2/ )/ 查询/ 阶段/ ./ 传感器/ 节点/ 将/ 采集/ 数据/ 所在/ 划分/ 区间/ 信息/ 和/ 传感器/ 节点/ 编号/ 信息/ 隐藏/ 于/ 长度/ 为/ m/ 的/ 响应/ 向量/ 中/ ,/ 并/ 传送/ 给/ 聚集/ 节点/ ;/ 聚集/ 节点/ 对/ 收到/ 的/ 向量/ 执行/ 求和/ 操作/ ,/ 并/ 加上/ 本/ 节点/ 生成/ 的/ 向量/ ,/ 得到/ 本/ 节点/ 长度/ 为/ m/ 的/ 响应/ 向量/ ,/ 上传/ 并/ 参加/ 求和/ 聚集/ ;/ 基站/ 对/ 收到/ 的/ 所有/ 向量/ 求和/ 得到/ 聚集/ 结果/ 向量/ ,/ 聚集/ 结果/ 向量/ 减去/ 扰动/ 数据/ ,/ 得到/ 以/ 参照/ 矩阵/ 为/ 系数/ 矩阵/ 的/ 线性方程组/ ,/ 求解/ 线性方程组/ 得到/ 带/ 统计/ 信息/ 的/ 直方图/ 和/ 相应/ 传感器/ 节点/ 编号/ ,/ 使用/ 直方图/ 和/ 相应/ 传感器/ 节点/ 编号/ 计算/ 出/ 近似/ 查询/ 结果/ ./ 输入/ :/ 叶子/ 节点/ si/ 查询/ 周期/ t/ 内/ 采集/ 数据/ 值/ vi/ ,/ t/ ;/ 输出/ :/ 叶子/ 节点/ si/ 响应/ 向量/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ ;/ 1/ ./ IFvi/ ,/ t/ ≠/ null/ // // 查询/ 周期/ t/ 内有/ 采集/ 数据/ 2/ ./ FORk/ =/ 1/ ,/ 2/ ,/ …/ ,/ hdo3/ ./ IFvi/ ,/ t/ ∈/ HkTHEN/ // // 采集/ 数据/ vi/ ,/ t/ 落入/ Hk4/ ./ Ni/ =/ k/ ;/ (/ 1/ )/ 叶子/ 节点/ 处理过程/ 叶子/ 节点/ si/ 采用/ 算法/ 1/ 将/ 采集/ 数据/ vi/ ,/ t/ 所在/ 划分/ 区间/ 信息/ 和/ 传感器/ 节点/ 编号/ 信息/ 隐藏/ 于/ 长度/ 为/ m/ 的/ 响应/ 向量/ 中/ ./ 算法/ 1/ ./ 叶子/ 节点/ 计算/ 响应/ 向量/ 算法/ ./ 需求/ :/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 、/ 扰动/ 向量/ (/ sn1i/ ,/ sn2i/ ,/ …/ ,/ snmi/ )/ T/ 、/ 单路/ Hash/ 函数/ h/ (/ ·/ )/ 、/ 采集/ 数据/ 值域/ 划分/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ ;/ 5/ ./ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ =/ Ni/ ×/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ +/ 6/ ./ ENDIF7/ ./ ENDFOR8/ ./ ELSE/ // // 查询/ 周期/ t/ 内/ 没有/ 采集/ 数据/ 9/ ./ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ =/ (/ h/ (/ sn1i/ )/ ,/ h/ (/ sn2i/ )/ ,/ …/ ,/ h/ (/ snmi/ )/ )/ T/ ;/ 10/ ./ RETURN/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ 叶子/ 节点/ si/ 在/ 查询/ 周期/ t/ 内有/ 采集/ 数据/ 时/ ,/ 采用/ 算法/ 1/ 计算/ 响应/ 向量/ 为/ 其中/ ,/ Ni/ 为/ 传感器/ 节点/ si/ 查询/ 周期/ t/ 内所/ 采集/ 数据/ vi/ ,/ t/ 所在/ 划分/ 区间/ 的/ 编号/ ,/ 即/ vi/ ,/ t/ ∈/ HNi/ ./ 叶子/ 节点/ si/ 在/ 查询/ 周期/ t/ 内/ 没有/ 采集/ 数据/ 时/ ,/ 采用/ 算法/ 1/ 计算/ 响应/ 向量/ 为/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ =/ (/ h/ (/ sn1i/ )/ ,/ h/ (/ sn2i/ )/ ,/ …/ ,/ h/ (/ snmi/ )/ )/ T/ ./ 叶子/ 节点/ si/ 将/ 响应/ 向量/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ 上传/ (/ 2/ )/ 聚集/ 节点/ 聚集/ 过程/ 假设/ 聚集/ 节点/ sj/ 有/ cnj/ 个/ 孩子/ 节点/ ,/ 孩子/ 节点/ 编号/ 分别/ 为/ {/ j/ -/ cnj/ ,/ j/ -/ cnj/ +/ 1/ ,/ …/ ,/ j/ -/ 1/ }/ ,/ 聚集/ 节点/ sj/ 在/ 查询/ 周期/ t/ 内/ 采集/ 数据/ 为/ vj/ ,/ t/ ./ 聚集/ 节点/ sj/ 采用/ 算法/ 2/ 对/ 收到/ 的/ 孩子/ 节点/ 响应/ 向量/ 进行/ 求和/ 并/ 加本/ 节点/ 产生/ 的/ 向量/ ,/ 生成/ 聚集/ 节点/ 响应/ 向量/ 并/ 上传/ ./ 至父/ 节点/ 参加/ 聚集/ ./ 算法/ 2/ ./ 聚集/ 节点/ 计算/ 响应/ 向量/ 算法/ ./ 需求/ :/ 参照/ 向量/ (/ a1j/ ,/ a2j/ ,/ …/ ,/ amj/ )/ T/ 、/ 扰动/ 向量/ (/ sn1j/ ,/ sn2j/ ,/ …/ ,/ snmj/ )/ T/ 、/ 单路/ Hash/ 函数/ h/ (/ ·/ )/ 、/ 采集/ 数据/ 值域/ 划分/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ ;/ 输入/ :/ 聚集/ 节点/ sj/ 查询/ 周期/ t/ 内/ 采集/ 数据/ 值/ vj/ ,/ t/ ,/ 孩子/ 输出/ :/ 聚集/ 节点/ sj/ 响应/ 向量/ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ ;/ 1/ ./ 使用/ 算法/ 1/ ,/ 输入/ vj/ ,/ t/ ,/ 得到/ 向量/ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ ;/ 2/ ./ FORk/ =/ j/ -/ cnj/ ,/ j/ -/ cnj/ +/ 1/ ,/ …/ ,/ j/ -/ 1do3/ ./ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ =/ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ +/ 4/ ./ ENDFOR5/ ./ RETURN/ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ 聚集/ 节点/ sj/ 将/ 响应/ 向量/ (/ r1j/ ,/ r2j/ ,/ …/ ,/ rmj/ )/ T/ 上传/ 至父/ 节点/ 参加/ 聚集/ ,/ 如父/ 节点/ 不是/ 基站/ ,/ 使用/ 算法/ 2/ 生成/ 响应/ 向量/ 并/ 继续/ 上传/ ,/ 直到/ 上传/ 至/ 基站/ ./ (/ 3/ )/ 基站/ 处理过程/ 基站/ 收到/ 其/ 所有/ 孩子/ 节点/ 后/ ,/ 进行/ 以下/ 处理/ :/ 将/ 所有/ 孩子/ 节点/ 响应/ 向量/ 执行/ 求和/ 操作/ ,/ 得到/ 聚集/ 结果/ 向量/ :/ Page6/ 将/ 聚集/ 结果/ 向量/ 减去/ 所有/ 节点/ 经单/ 路/ Hash/ 函数/ h/ (/ ·/ )/ 处理/ 过/ 的/ 扰动/ 数据/ 之/ 和/ ,/ 得到/ 向量/ (/ b1/ ,/ b2/ ,/ …/ ,/ bn/ )/ T/ ./ ,/ b1/ 烄/ 烌/ b2/ =/ / b/ 烎/ m/ 烆/ b1/ 烄/ b2/ 即为/ / b/ 烆/ 即/ 为/ 如下/ 线性方程组/ :/ a11/ ×/ N1/ +/ a12/ ×/ N2/ +/ …/ +/ a1n/ ×/ Nn/ =/ b1/ 烄/ a21/ ×/ N1/ +/ a22/ ×/ N2/ +/ …/ +/ a2n/ ×/ Nn/ =/ b2/ 烅/ am1/ ×/ N1/ +/ am2/ ×/ N2/ +/ …/ +/ amn/ ×/ Nn/ =/ b/ 烆/ 方程组/ (/ 1/ )/ 的/ 系数/ 矩阵/ 为/ 参照/ 矩阵/ 犌/ ./ 当/ m/ 足够/ 大时/ ,/ 能够/ 求解/ 出/ 集合/ {/ N1/ ,/ N2/ ,/ …/ ,/ Nn/ }/ ./ 当/ m/ =/ n/ 时/ ,/ 参照/ 矩阵/ 犌/ 为/ n/ ×/ n/ 方阵/ ,/ 且/ 有/ 犌/ ≠/ 0/ ./ 根据/ 克莱姆/ 法则/ (/ Cramer/ ’/ sRule/ )/ ,/ 当/ m/ =/ n/ 时/ 方程组/ (/ 1/ )/ 能够/ 准确/ 求解/ ./ 传感器/ 节点/ s1/ ,/ s2/ ,/ …/ ,/ sn/ 在/ 查询/ 周期/ t/ 内/ 采集/ 数据/ 所在/ 的/ 区间/ 分别/ 为/ HN1/ ,/ HN2/ ,/ …/ ,/ HNn/ ./ 统计/ (/ H1/ ,/ …/ ,/ Hh/ )/ 中/ 各/ 区间/ 所/ 包含/ 的/ 传感器/ 节点/ 采集/ 数据/ 的/ 数目/ 和/ 相应/ 的/ 传感器/ 节点/ 编号/ ,/ 得到/ 以/ (/ H1/ ,/ …/ ,/ Hh/ )/ 为/ 划分/ 的/ 统计/ 直方图/ ./ 根据/ 直方图/ 求解/ 出/ 通用/ 近似/ 查询/ / G/ 中/ 用户/ 需要/ 的/ 查询/ 类型/ T/ 的/ 近似/ 查询/ 结果/ ./ 4.2/ F/ -/ PGAQ/ 模式/ H/ -/ PGAQ/ 模式/ 使用/ 数据/ 扰动/ 技术/ 和/ 单路/ Hash/ 函数/ ,/ 这样/ 即使/ 聚集/ 节点/ 能够/ 获得/ 传感器/ 节点/ 和/ 基站/ 共享/ 密钥/ ,/ 能够/ 解密/ 并/ 获得/ 基站/ 下发/ 的/ 参照/ 向量/ ,/ 聚集/ 节点/ 也/ 不能/ 计算/ 出/ 感知/ 数据/ ,/ 增强/ 了/ 数据/ 安全性/ ,/ 但是/ H/ -/ PGAQ/ 需要/ 所有/ 传感器/ 节点/ 上传/ 数据/ ,/ 连续/ 查询/ 时/ 通信/ 代价/ 较/ 高/ ./ F/ -/ PGAQ/ 假设/ 聚集/ 节点/ 不/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ ,/ 使用/ 参照/ 向量/ 代替/ 真实/ 采集/ 数据/ 进行/ 隐私/ 保护/ ./ F/ -/ PGAQ/ 使用/ 过滤器/ 减少/ 连续/ 查询/ 时/ 的/ 通信量/ ,/ 将/ 直方图/ 划分/ 作为/ 过滤器/ 窗口/ ,/ 如果/ 本轮/ 采集/ 数据/ 与/ 上/ 轮/ 采集/ 数据/ 落入/ 同一/ 直方图/ 划分/ ,/ 则/ 不/ 需要/ 上传/ 数据/ ./ F/ -/ PGAQ/ 模式/ 和/ H/ -/ PGAQ/ 模式/ 处理过程/ 基本/ 相似/ ,/ 主要/ 区别/ 在于/ :/ (/ 1/ )/ F/ -/ PGAQ/ 不/ 对/ 上传/ 向量/ 添加/ 扰动/ 数据/ ;/ (/ 2/ )/ F/ -/ PGAQ/ 使用/ 过滤器/ ,/ 在/ 连续/ 查询/ 中/ ,/ 如果/ 本轮/ 采集/ 数据/ 与/ 上/ 轮/ 采集/ 数据/ 落入/ 同一/ 直方图/ 划分/ ,/ 则/ 不/ 需要/ 上传/ 数据/ ./ F/ -/ PGAQ/ 模式/ 具体/ 过程/ 如下/ :/ (/ 1/ )/ 系统/ 初始化/ 阶段/ 基站/ 使用/ H/ -/ PGAQ/ 中/ 方法/ 划分/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ ,/ 并/ 为/ 每个/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 生成/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ ./ 使用/ 与/ 传感器/ 节点/ si/ 共享/ 密钥/ ki/ ,/ t/ 进行/ 加密/ ,/ 基站/ 向/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 传送/ 如下/ 消息/ :/ Sink/ →/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ :/ 传感器/ 节点/ si/ 解密/ 得到/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ 和/ (/ H1/ ,/ …/ ,/ Hh/ )/ ./ (/ 2/ )/ 查询/ 阶段/ ①/ 叶子/ 节点/ 处理过程/ 在/ 连续/ 查询/ 中/ ,/ 叶子/ 节点/ 首先/ 判断/ 本轮/ 采集/ 数据/ 与/ 上/ 轮/ 数据/ 是否/ 落入/ 同一/ 区间/ 划分/ (/ H1/ ,/ …/ ,/ Hh/ )/ ,/ 如果/ 落入/ 同一/ 划分/ 区间/ ,/ 则/ 不/ 需要/ 上传/ 数据/ ./ 如果/ 本轮/ 采集/ 数据/ 与/ 上/ 轮/ 数据/ 落/ 在/ 不同/ 的/ 区间/ ,/ 则/ 参照/ 算法/ 1/ (/ 不/ 添加/ 扰动/ 数据/ )/ 计算/ 响应/ 向量/ 为/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ =/ (/ a1i/ ×/ Ni/ ,/ a2i/ ×/ Ni/ ,/ …/ ami/ ×/ Ni/ )/ ./ 叶子/ 节点/ si/ 将/ 响应/ 向量/ (/ r1i/ ,/ r2i/ ,/ …/ ,/ rmi/ )/ T/ 上传/ ②/ 聚集/ 节点/ 聚集/ 过程/ 聚集/ 节点/ 使用/ 叶子/ 节点/ 处理过程/ 产生/ 本/ 节点/ 向量/ ./ 聚集/ 节点/ 对/ 收到/ 的/ 孩子/ 节点/ 响应/ 向量/ 进行/ 求和/ 并/ 加本/ 节点/ 产生/ 的/ 向量/ ,/ 生成/ 聚集/ 节点/ 的/ 响应/ 向量/ 并/ 上传/ ./ 没有/ 采集/ 数据/ ,/ 则/ 聚集/ 节点/ 不/ 需要/ 上传/ 数据/ ./ 如果/ 所有/ 孩子/ 节点/ 没有/ 上传/ 数据/ 并且/ 聚集/ 节点/ 至父/ 节点/ 参加/ 聚集/ ./ ③/ 基站/ 处理过程/ 假设/ 本轮/ 查询/ 中/ 查询/ 区域/ 内有/ nG/ (/ nG/ / n/ )/ 个/ 传感器/ 节点/ 上传/ 向量/ 参加/ 聚集/ ./ 为/ 表述/ 方便/ ,/ 假设/ 上传/ Page7/ 向量/ 的/ 传感器/ 节点/ 为/ {/ s1/ ,/ s2/ ,/ …/ ,/ snG/ }/ ./ 基站/ 将/ 收到/ 的/ 孩子/ 节点/ 响应/ 向量/ 执行/ 求和/ 操作/ ,/ 得到/ 聚集/ 结果/ 向量/ :/ 即/ 为/ 如下/ 线性方程组/ :/ a11/ ×/ N1/ +/ a12/ ×/ N2/ +/ …/ +/ a1nG/ ×/ NnG/ =/ b1/ 烄/ a21/ ×/ N1/ +/ a22/ ×/ N2/ +/ …/ +/ a2nG/ ×/ NnG/ =/ b2/ 烅/ am1/ ×/ N1/ +/ am2/ ×/ N2/ +/ …/ +/ amnG/ ×/ NnG/ =/ b/ 烆/ 当/ m/ 足够/ 大时/ ,/ 能够/ 求解/ 出/ 集合/ {/ N1/ ,/ N2/ ,/ …/ ,/ NnG/ }/ ./ 当/ m/ =/ nG/ 时/ 方程组/ (/ 2/ )/ 能够/ 准确/ 求解/ ./ 基站/ 对于/ 没有/ 上传/ 数据/ 的/ 节点/ si/ 使用/ 上/ 一轮/ si/ 对应/ 的/ Ni/ ,/ 得到/ 具有/ 查询/ 区域/ 全部/ 节点/ 采集/ 数据/ 信息/ 的/ 直方图/ 数据/ {/ N1/ ,/ N2/ ,/ …/ ,/ Nn/ }/ ./ 根据/ 直方图/ 求解/ 出/ 通用/ 近似/ 查询/ / G/ 中/ 用户/ 需要/ 的/ 查询/ 类型/ T/ 的/ 近似/ 查询/ 结果/ ./ 5/ 性能/ 分析/ 5.1/ 查询/ 精度/ 查询/ 精度/ 主要/ 受/ 系统/ 参数/ h/ 和/ 对/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ 划分/ 方式/ 的/ 影响/ ./ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ 划分/ 方式/ 决定/ 在/ 基站/ 计算/ 得到/ 的/ 直方图/ 的/ 类型/ ,/ 系统/ 参数/ h/ 决定/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ 的/ 划分/ 粒度/ ./ 为了/ 控制精度/ 的/ 需要/ ,/ 本文/ 采用/ 等/ 宽/ 直方图/ 和/ 等/ 高/ 直方图/ 两种/ 直方图/ 划分/ 方式/ ./ 直方图/ 划分/ 方式/ 可/ 由/ 传感器/ 网络系统/ 用户/ 选择/ ./ 近似/ 查询/ 误差/ 由/ 两个/ 参数/ 描述/ ,/ 分别/ 为/ 数据/ 值/ 误差值/ ε/ v/ 和/ 数据项/ 个数/ 误差值/ ε/ n/ ./ 定义/ 1/ ./ 数据/ 值/ 误差值/ ε/ v/ ./ ε/ v/ 为/ 查询/ 返回/ 结果/ 中/ 数据/ 值/ 范围/ 误差/ 上限/ ,/ 即/ max/ {/ |/ vpmax/ -/ vrmax/ |/ ,/ |/ vpmin/ -/ vrmin/ |/ }/ / ε/ v/ ,/ 其中/ ,/ vpmax/ 和/ vpmin/ 分别/ 为/ / p/ 中/ 的/ 最大值/ 和/ 最小值/ ,/ vrmax/ 和/ vrmin/ 分别/ 为/ / r/ 中/ 的/ 最大值/ 和/ 最小值/ ,/ / p/ 为/ 基站/ 返回/ 的/ 近似/ 查询/ 结果/ 数据项/ 集合/ ,/ / r/ 符合/ 查询/ 条件/ 的/ 精确/ 查询/ 数据项/ 集合/ ./ 定义/ 2/ ./ 数据项/ 个数/ 误差值/ ε/ n/ ./ ε/ n/ 为/ 查询/ 返回/ 结果/ 中/ 不/ 符合/ 查询/ 条件/ 的/ 数据项/ 数/ 上限/ ,/ 即/ 其中/ ,/ / p/ 为/ 基站/ 返回/ 的/ 近似/ 查询/ 结果/ 数据项/ 集合/ ,/ / r/ 为/ 符合/ 查询/ 条件/ 的/ 精确/ 查询/ 数据项/ 集合/ ./ 定理/ 1/ ./ 使用/ 等/ 宽/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据/ 值/ 误差值/ ε/ v/ ./ 证明/ ./ 等/ 宽/ 直方图/ 划分/ 方式/ 为/ :/ 将/ 采集/ 数据/ 值域/ [/ vmin/ ,/ vmax/ ]/ 均匀/ 划分/ 为/ h/ 个/ 区间/ (/ H1/ ,/ …/ ,/ Hh/ )/ ,/ 每个/ 区间/ 的/ 宽度/ σ/ =/ (/ vmax/ -/ vmin/ )/ // h/ ,/ 则/ Hi/ 为/ [/ (/ i/ -/ 1/ )/ ×/ σ/ ,/ i/ ×/ σ/ ]/ ./ 数据/ 值/ 误差值/ ε/ v/ 与/ 等/ 宽/ 直方图/ 划分/ 方式/ 时/ 总/ 划分/ 数/ h/ 的/ 关系/ 为/ 所以/ ,/ 使用/ 等/ 宽/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据/ 值/ 误差值/ ε/ v/ ./ 由于/ 等/ 宽/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据/ 值/ 误差值/ ε/ v/ ,/ 所以/ 等/ 宽/ 直方图/ 划分/ 方式/ 更加/ 适合/ 用于/ 范围/ 查询/ 类型/ ./ 当/ 查询/ 类型/ T/ 为/ 范围/ 查询/ 时/ ,/ 参数/ 集合/ P/ 为/ 范围/ 查询/ 参数/ [/ a/ ,/ b/ ]/ ./ PGAQ/ 协议/ 计算/ 覆盖/ [/ a/ ,/ b/ ]/ 的/ 最小/ 直方图/ 划分/ 集合/ ,/ 将/ 所有/ 落入/ 该/ 直方图/ 划分/ 集合/ 的/ 数据项/ 作为/ 近似/ 查询/ 的/ 结果/ 集/ ,/ 返回/ 给/ 用户/ ./ 定理/ 2/ ./ 使用/ 等/ 高/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据项/ 个数/ 误差值/ ε/ n/ ./ 证明/ ./ 等/ 宽/ 直方图/ 保证/ 落入/ 划分/ 区间/ 的/ 采集/ 数据项/ 基本/ 相等/ ./ 其/ 划分/ 思路/ 为/ :/ 根据/ 基站/ 对/ 整个/ 网络/ 历史/ 采集/ 数据项/ 的/ 统计/ 分布/ 函数/ f/ (/ x/ )/ ,/ 等/ 宽/ 直方图/ 划分/ 在/ 区间/ 划分/ (/ H1/ ,/ …/ ,/ Hh/ )/ 上/ ,/ 对于/ / i/ ,/ j/ (/ 1/ / i/ ,/ j/ / h/ )/ 有/ ∫/ x/ ∈/ Hi/ ε/ n/ 与/ 等/ 高/ 直方图/ 划分/ 方式/ 时/ 总/ 划分/ 数/ h/ 的/ 关系/ 为/ 其中/ ,/ Sn/ 为/ 查询/ 周期/ t/ 内/ 所有/ 传感器/ 节点/ 采集/ 的/ 数据/ 项目/ 总和/ ,/ Sn/ // h/ 为/ 落入/ 每个/ 区间/ 的/ 采集/ 数据项/ 数/ 的/ 平均数/ ./ 所以/ ,/ 使用/ 等/ 高/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据项/ 个数/ 误差值/ ε/ n/ ./ 假设/ 统计/ 分布/ 函数/ f/ (/ x/ )/ 为/ 正态分布/ f/ (/ x/ )/ ~/ N/ (/ μ/ ,/ σ/ )/ ,/ 划分/ 数/ h/ 为/ 7/ ,/ 等/ 高/ 直方图/ 划分/ 示意图/ 如图/ 2/ 所示/ ./ 由于/ 等/ 高/ 直方图/ 划分/ 方式/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据项/ 个数/ 误差值/ ε/ n/ ,/ 所以/ 等/ 直方图/ 划分/ 方式/ 更加/ 适合/ 用于/ Top/ -/ k/ 查询/ 类型/ ./ 当/ 查询/ 类型/ T/ 为/ Page8Top/ -/ k/ 查询/ 时/ ,/ 参数/ 集合/ P/ 为/ Top/ -/ k/ 查询/ 参数/ k/ ./ PGAQ/ 协议/ 计算/ 落入/ 最高/ (/ 低/ )/ 划分/ 区间/ 的/ 数据项/ 数/ 大于/ (/ 小于/ )/ 等于/ k/ 的/ 最小/ 划分/ 区间/ 集合/ ,/ 将/ 所有/ 落入/ 该/ 直方图/ 划分/ 集合/ 的/ 数据项/ 作为/ 近似/ 查询/ 的/ 结果/ 集/ ,/ 返回/ 给/ 用户/ ./ 为了/ 兼顾/ 查询/ 结果/ 数据/ 值/ 误差/ 和/ 数据项/ 个数/ 误差/ ,/ 直方图/ 可/ 采用/ 混合/ 划分/ 方式/ ./ 在/ 落入/ 数据项/ 密集/ 的/ 区域/ Hcon/ 采用/ 等/ 高/ 直方图/ 的/ 划分/ 方式/ ./ 在/ 区域/ Hcon/ 内有/ ∫/ x/ ∈/ Hi/ 定理/ 2/ ,/ 在/ 区域/ Hcon/ 内/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据项/ 个数/ 误差值/ ε/ n/ ,/ 同时/ ,/ 由于/ 区域/ Hcon/ 内/ 落入/ 数据项/ 较/ 密集/ ,/ 使用/ 等/ 高/ 直方图/ 的/ 划分/ 方式/ 得到/ 的/ 划分/ 区间/ 较窄/ ,/ 使得/ 数据/ 值/ 误差/ 较/ 小/ ,/ 兼顾/ 了/ 查询/ 结果/ 数据/ 值/ 误差/ ./ 在/ 落入/ 数据项/ 稀疏/ 的/ 区域/ Hspar/ 采用/ 等/ 宽/ 直方图/ 的/ 划分/ 方式/ ,/ 在/ 区域/ Hspar/ 内有/ Hm/ =/ Hn/ (/ Hm/ ,/ Hn/ / Hspar/ )/ ,/ 根据/ 定理/ 1/ ,/ 在/ 区域/ Hspar/ 内/ 能够/ 控制/ 近似/ 查询/ 结果/ 数据/ 值/ 误差值/ ε/ v/ ,/ 同时/ ,/ 由于/ 区域/ Hspar/ 内/ 落入/ 数据项/ 较/ 稀疏/ ,/ 使用/ 等/ 宽/ 直方图/ 划分/ 方式/ 将/ 使/ 落入/ 每个/ 划分/ 区间/ 的/ 数据项/ 个数/ 较/ 少/ ,/ 使得/ 数据项/ 个数/ 误差/ 较/ 小/ ,/ 兼顾/ 了/ 查询/ 结果/ 数据项/ 个数/ 误差/ ./ 假设/ 统计/ 分布/ 函数/ f/ (/ x/ )/ 为/ 正态分布/ f/ (/ x/ )/ ~/ N/ (/ μ/ ,/ σ/ )/ ,/ 划分/ 数/ h/ 为/ 9/ ,/ 直方图/ 混合/ 划分/ 示意图/ 如图/ 3/ 所示/ ./ 其中/ H1/ =/ H2/ =/ H8/ =/ H9/ ,/ ∫/ x/ ∈/ H3/ ∫/ x/ ∈/ H5f/ (/ x/ )/ =/ ∫/ x/ ∈/ H65/ ./ 2/ 隐私/ 性/ 定义/ 3/ ./ 传感器/ 网络/ 中/ 通用/ 近似/ 查询/ 隐私/ 性/ ./ 传感器/ 网络/ 中/ 通用/ 近似/ 查询/ / G/ =/ {/ G/ ,/ t/ ,/ T/ ,/ P/ ,/ ε/ }/ 正确/ 执行/ 时/ ,/ 如果/ 攻击者/ 不能/ 获得/ 以下/ 敏感/ 信息/ ,/ 则/ 查询/ / G/ 满足/ 隐私/ 性/ :/ (/ 1/ )/ 查询/ 区域/ G/ 内/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 采集/ 数据/ 值/ vi/ ,/ t/ ;/ (/ 2/ )/ 包含/ 采集/ 数据/ 统计/ 信息/ 的/ 直方图/ 信息/ ;/ (/ 3/ )/ 查询/ 结果/ 数据/ 对应/ 的/ 传感器/ 节点/ 编号/ ./ 本文/ 考虑/ 攻击者/ 能够/ 进行/ 通过/ 俘获/ 聚集/ 节点/ 的/ 内部/ 攻击/ 和/ 通过/ 窃听/ 链路层/ 的/ 外部/ 攻击/ 两种/ 攻击方式/ ./ 定理/ 3/ ./ 在/ 假设/ 聚集/ 节点/ 不/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ 的/ 情况/ 下/ ,/ F/ -/ PGAQ/ 满足/ 传感器/ 网络/ 中/ 通用/ 近似/ 查询/ 隐私/ 性/ (/ 定义/ 3/ )/ ./ 证明/ ./ 在/ F/ -/ PGAQ/ 的/ 系统/ 初始化/ 阶段/ ,/ 基站/ 对/ 每个/ 传感器/ 节点/ 对应/ 的/ 参照/ 向量/ ,/ 使用/ 其/ 与/ 传感器/ 节点/ 共享/ 的/ 密钥/ 加密/ ,/ 下发/ 至/ 传感器/ 节点/ ,/ 由于/ 假设/ 聚集/ 节点/ 不/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ ,/ 聚集/ 节点/ 不能/ 获得/ 参照/ 向量/ ./ 叶子/ 节点/ 将/ 采集/ 数据/ 信息/ 和/ 节点/ 编号/ 信息/ 隐藏/ 于/ 响应/ 向量/ 并/ 上传/ 至/ 聚集/ 节点/ ,/ 聚集/ 节点/ 不/ 知道/ 参照/ 向量/ ,/ 所以/ 不能/ 推导/ 出/ 采集/ 数据/ 信息/ 和/ 节点/ ID/ 信息/ ./ 同时/ ,/ 由于/ 无线/ 链路/ 中/ 传输/ 的/ 数据/ 为/ 响应/ 向量/ ,/ 所以/ 外部/ 攻击者/ 也/ 不能/ 获得/ 定义/ 3/ 中/ 定义/ 的/ 敏感/ 信息/ ./ 定理/ 4/ ./ 无论/ 聚集/ 节点/ 是否/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ ,/ H/ -/ PGAQ/ 都/ 满足/ 传感器/ 网络/ 中/ 通用/ 近似/ 查询/ 隐私/ 性/ (/ 定义/ 3/ )/ ./ 证明/ ./ 在/ F/ -/ PGAQ/ 隐私/ 保护/ 方法/ 的/ 基础/ 上/ ,/ H/ -/ PGAQ/ 模式/ 使用/ 数据/ 扰动/ 技术/ 和/ 单路/ Hash/ 函数/ ./ 由/ 定理/ 3/ 知/ :/ 在/ 聚集/ 节点/ 不/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ 的/ 情况/ 下/ ,/ F/ -/ PGAQ/ 满足/ 传感器/ 网络/ 中/ 通用/ 近似/ 查询/ 隐私/ 性/ ./ 当/ 聚集/ 节点/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ 时/ ,/ 聚集/ 节点/ 能够/ 获知/ 参照/ 向量/ ,/ 但是/ 由于/ H/ -/ PGAQ/ 中/ 响应/ 向量/ 中/ 包含/ 单路/ Hash/ 函数/ 处理/ 过/ 的/ 扰动/ 数据/ ,/ 聚集/ 节点/ 同样/ 不能/ 获得/ 定义/ 3/ 中/ 定义/ 的/ 敏感/ 信息/ ./ 证毕/ ./ 定理/ 5/ ./ PGAQ/ 能够/ 应对/ 共谋/ 攻击/ ./ 证明/ ./ 在/ 系统/ 初始/ 阶段/ ,/ 基站/ 使用/ 与/ 传感器/ 节点/ 共享/ 密钥/ 进行/ 下发/ 参照/ 向量/ ,/ 传感器/ 节点/ 不能/ 获得/ 其他/ 节点/ 的/ 参照/ 向量/ ,/ 因此/ 即使/ 获知/ 其他/ 节点/ 的/ 响应/ 向量/ 也/ 不能/ 通过/ 共谋/ (/ 串通/ )/ 来/ 获得/ 其他/ 节点/ 真实/ 数据/ ./ 5.3/ 能量消耗/ 传感器/ 网络/ 能量消耗/ 主要/ 受/ 系统/ 参数/ m/ 影响/ ./ Page9/ 在/ PGAQ/ 协议/ 中/ ,/ 叶子/ 节点/ 向/ 聚集/ 节点/ 传输/ 长度/ 为/ m/ 的/ 响应/ 向量/ ,/ 聚集/ 节点/ 将/ 收到/ 的/ 所有/ 孩子/ 节点/ 的/ 响应/ 向量/ 进行/ 求和/ 聚集/ ,/ 并/ 加入/ 本/ 节点/ 信息/ 生成/ 本/ 节点/ 长度/ 为/ m/ 的/ 响应/ 向量/ ,/ 上传/ 并/ 参加/ 父/ 节点/ 的/ 聚集/ ./ 所以/ ,/ 在/ PGAQ/ 协议/ 中/ ,/ 聚集/ 路由/ 树中/ 上传/ 的/ 均/ 为/ 长度/ 为/ m/ 的/ 向量/ ./ 第/ 6/ 节/ 使用/ 真实/ 数据/ 对系统/ 参数/ 与/ 传感器/ 网络/ 能量消耗/ 关系/ 进行/ 实验/ 和/ 分析/ ./ 5.4/ 系统/ 扩展性/ 在/ 网络/ 规模/ 方面/ ,/ PGAQ/ 协议/ 能够/ 较/ 方便/ 地/ 适应/ 网络/ 规模/ 的/ 扩展/ ./ 在/ PGAQ/ 协议/ 中/ 基站/ 为/ 网内/ 每个/ 传感器/ 节点/ si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 分配/ 不同/ 的/ 参照/ 向量/ (/ a1i/ ,/ a2i/ ,/ …/ ,/ ami/ )/ T/ ,/ 基站/ 需要/ 产生/ m/ ×/ n/ 参照/ 矩阵/ 犌/ ,/ n/ 需要/ 不/ 小于/ 网/ 内/ 传感器/ 节点/ 个数/ ./ 当/ 传感器/ 网络/ 规模/ 需要/ 扩展/ 时/ ,/ 基站/ 按/ 第/ 4/ 节/ 要求/ 为/ 新增/ 的/ 节点/ 生成/ 相应/ 的/ 参照/ 向量/ 和/ 扰动/ 向量/ ,/ 并/ 使用/ 基站/ 与/ 传感器/ 节点/ 共享/ 密钥/ 加密/ 后/ ,/ 下发/ 至/ 新增/ 传感器/ 节点/ ,/ 同时/ 将/ 新/ 产生/ 的/ 参照/ 向量/ 加入/ 参照/ 矩阵/ ,/ 其他/ 节点/ 的/ 参照/ 向量/ 和/ 扰动/ 向量/ 不/ 需要/ 变化/ ./ 在/ 生成/ 新/ 的/ 聚集/ 路由/ 后/ ,/ PGAQ/ 协议/ 可以/ 在/ 网络/ 规模/ 扩展/ 后/ 的/ 网络/ 上/ 执行/ ./ 6/ 实验/ 与/ 分析/ 本文/ 设计/ 的/ PGAQ/ 协议/ 代价/ 可/ 分/ 以下/ 两/ 部分/ :/ 在/ 系统/ 初始化/ 阶段/ ,/ 传输/ 加密/ 的/ 参照/ 向量/ 和/ 区间/ 划分/ 代价/ ;/ 在/ 查询/ 阶段/ 主要/ 为/ 传感器/ 节点/ 采集/ 数据/ 、/ 生成/ 聚集/ 响应/ 向量/ 和/ 传输/ 响应/ 向量/ 的/ 代价/ ./ 其中/ 网络系统/ 性能/ 主要/ 受/ 查询/ 阶段/ 代价/ 影响/ ./ 对于/ 传感器/ 节点/ ,/ 通信/ 能量消耗/ 远大于/ 计算/ 能量消耗/ ,/ 本文/ 参照/ 文献/ [/ 2/ ,/ 4/ ,/ 12/ -/ 13/ ]/ ,/ 使用/ 数据通信/ 量/ 对/ 算法/ 的/ 有效性/ 进行/ 评价/ ./ 本文/ 使用/ 公开/ 可/ 获得/ 的/ 真实/ 数据/ 集/ LUCEdataset/ ①/ ,/ 在/ OMNeT/ ++/ 平台/ 上/ 对/ PGAQ/ 进行/ 实验/ ./ LUCEdataset/ 数据/ 集为/ 2006/ 年/ 和/ 2007/ 年/ 采集/ 的/ 环境温度/ 、/ 土壤湿度/ 等/ 11/ 维/ 属性数据/ ,/ 本文/ 使用/ 环境温度/ 数据/ 进行/ 实验/ ,/ 使用/ 的/ 实验/ 数据/ 值域/ 为/ [/ -/ 20/ ,/ 30/ ]/ ./ 本文/ 使用/ LUCEdataset/ 中/ 节点/ 位置/ 数据/ ,/ 根据/ 规模/ 分为/ 3/ 组/ 实验/ ./ 假设/ 传感器/ 节点/ 有效/ 传输/ 距离/ 为/ 60m/ ,/ 使用/ TAG/ (/ tinyaggregationserviceforadhocsensornetworks/ )/ 算法/ 建立/ 路由/ ./ 第/ 1/ 组/ 实验/ ,/ 20/ 个/ 传感器/ 节点/ 分布/ 在/ 200m/ ×/ 200m/ 矩形/ 区域/ 内/ ,/ 传感器/ 节点/ 向/ 单元/ 头/ 节点/ 传输数据/ 平均/ 需要/ 2.5/ 跳/ ,/ 每个/ 传感器/ 节点/ 平均/ 有/ 4.5/ 个/ 邻居/ 节点/ ;/ 第/ 2/ 组/ 实验/ ,/ 50/ 个/ 传感器/ 节点/ 分布/ 在/ 350m/ ×/ 250m/ 矩形/ 区域/ 内/ ,/ 传感器/ 节点/ 向/ 单元/ 头/ 节点/ 传输数据/ 平均/ 需要/ 2.9/ 跳/ ,/ 每个/ 传感器/ 节点/ 平均/ 有/ 6.4/ 个/ 邻居/ 节点/ ;/ 第/ 3/ 组/ 实验/ ,/ 88/ 个/ 传感器/ 节点/ 分布/ 在/ 450m/ ×/ 300m/ 矩形/ 区域/ 内/ ,/ 传感器/ 节点/ 向/ 单元/ 头/ 节点/ 传输数据/ 平均/ 需要/ 3.1/ 跳/ ,/ 每个/ 传感器/ 节点/ 平均/ 有/ 11.1/ 个/ 邻居/ 节点/ ./ 图/ 4/ 显示/ 了/ PGAQ/ 在/ 系统/ 初始化/ 阶段/ ,/ 3/ 组/ 不同/ 网络/ 规模/ 的/ 实验/ 中/ ,/ 基站/ 向/ 传感器/ 节点/ 传输/ 加密/ 数据/ 需要/ 的/ 通信量/ ,/ 本文/ 采用/ 文献/ [/ 12/ ]/ 中/ 的/ 密钥/ 机制/ ,/ 使用/ 16/ 位/ 密钥/ 进行/ 加密/ ./ 为了/ 考察/ PGAQ/ 查询/ 时/ 的/ 通信量/ ,/ 本文/ 将/ H/ -/ PGAQ/ 、/ F/ -/ PGAQ/ 和/ KIPDA/ [/ 10/ ]/ 、/ 端到/ 端/ (/ endtoend/ )/ 加密/ 方案/ 进行/ 比较/ ./ KIPDA/ 和/ PGAQ/ 同样/ 使用/ 非/ 加密/ 策略/ (/ non/ -/ cryptographicmethod/ )/ 实现/ 隐私/ 保护/ 聚集/ 操作/ ./ KIPDA/ 仅能/ 较/ 好/ 地/ 实现/ 隐私/ 保护/ MAX/ // MIN/ 非线性/ 聚集/ ,/ PGAQ/ 实现/ 通用/ 隐私/ 保护/ 近似/ 查询/ ,/ 能/ 完成/ 的/ 查询/ 类型/ 为/ Top/ -/ k/ 查询/ 、/ 范围/ 查询/ 、/ SUM/ 、/ MAX/ // MIN/ 、/ Median/ 、/ Histogram/ 等/ 查询/ ./ 端到/ 端/ 加密/ 查询/ 方案/ 使用/ 基站/ 与/ 传感器/ 节点/ 共享/ 密钥/ 加密/ ,/ 将/ 传感器/ 节点/ 采集/ 的/ 所有/ 数据传输/ 到/ 基站/ ,/ 实现/ 隐私/ 保护/ 查询/ ,/ 但是/ 端到/ 端/ 加密/ 查询/ 方案/ 不/ 容易/ 实现/ 中间/ 节点/ 的/ 聚集/ 操作/ ,/ 而/ 传感器/ 网络/ 中/ 数据/ 聚集/ 融合/ 是/ 有效/ 减少/ 通信量/ 的/ 方法/ ./ PGAQ/ 能够/ 进行/ 网/ 内/ 数据/ 聚集/ ,/ 具有/ 较大/ 的/ 改进/ 和/ 优化/ 空间/ ./ 在/ 网络/ 规模/ 不同/ 的/ 3/ 组/ 实验/ 中/ ,/ 分别/ 考察/ 了/ 区间/ 划分/ 的/ 数目/ (/ numberofranges/ )/ 和/ 采集/ 数据/ 的/ 轮数/ (/ numberofrounds/ )/ 对/ 查询/ 通信量/ CQ/ 的/ 影响/ ./ 为/ 便于/ 描述/ ,/ 本/ 实验/ 假设/ 1/ 个/ 时间/ 单位/ 传感器/ 节点/ 采集/ 1/ 轮/ 数据/ ,/ 即/ 查询/ 周期/ t/ 内/ 采集/ t/ 轮/ 数据/ ./ 本/ 实验/ 采用/ 的/ 参照/ 向量/ 长度/ m/ 等于/ 网/ 内/ 节点/ 数/ n/ ,/ 以/ 保证/ 基站/ 能够/ 准确/ 解/ 出/ 线性方程组/ ,/ 得到/ 直方图/ 信息/ ./ 本/ 实验/ 中设/ KIPDA/ 中/ 参数/ k/ 为/ 5/ ./ 图/ 5/ ~/ 图/ 7/ 表述/ 了/ 在/ 查询/ 周期/ t/ 为/ 100/ 时/ (/ 即采/ ①/ http/ :/ // // sensorscope/ ./ epfl/ ./ ch/ // index/ ./ php/ // Environmental/ _/ DataPage10/ 集/ 数据/ 轮数/ 为/ 100/ 次时/ )/ ,/ 区间/ 划分/ 数/ h/ 对/ 传感器/ 节点/ 连续/ 传输数据/ 通信量/ 的/ 影响/ ./ 可以/ 看出/ :/ KIPDA/ 和/ H/ -/ PGAQ/ 通信量/ 高于/ F/ -/ PGAQ/ 通信量/ ,/ KIPDA/ 略高于/ H/ -/ PGAQ/ ,/ 这/ 是因为/ F/ -/ PGAQ/ 使用/ 了/ 过滤器/ 机制/ ,/ 减少/ 了/ 通信量/ ./ 在/ 第/ 1/ 组/ 实验/ 中端/ 到/ 端/ 方案/ 通信量/ 低于/ KIPDA/ 和/ H/ -/ PGAQ/ ,/ 高于/ F/ -/ PGAQ/ ./ 在/ 第/ 2/ 组和/ 第/ 3/ 组/ 实验/ 中/ ,/ 端到/ 端/ 方案/ 通信量/ 低于/ KIPDA/ 和/ H/ -/ PGAQ/ ,/ 和/ F/ -/ PGAQ/ 通信量/ 曲线/ 有/ 交叉/ ,/ 第/ 2/ 组/ 交叉点/ 在/ h/ =/ 175/ 附近/ ,/ 第/ 3/ 组/ 交叉点/ 在/ h/ =/ 100/ 附近/ ./ 区间/ 划分/ 数/ h/ 对/ KIPDA/ 和/ H/ -/ PGAQ/ 影响/ 很小/ ,/ 而/ F/ -/ PGAQ/ 通信量/ 随/ h/ 增长/ 而/ 增长/ ,/ 这/ 是因为/ 区间/ 划分/ 数/ h/ 决定/ 了/ F/ -/ PGAQ/ 中/ 过滤器/ 窗口/ 的/ 宽度/ ,/ 区间/ 划分/ 数/ h/ 越大/ ,/ F/ -/ PGAQ/ 中/ 过滤器/ 窗口/ 越窄/ ,/ 通信量/ 越大/ ,/ 同时/ 查询/ 精度/ 越高/ ./ 数据/ 值/ 误差值/ ε/ v/ 与/ 等/ 宽/ 直方图/ 划分/ 数/ h/ 的/ 关系/ 为/ ε/ v/ =/ (/ vmax/ -/ vmin/ )/ // h/ ./ 图/ 8/ 显示/ 了/ 在/ 采集/ 数据/ 值域/ 为/ [/ -/ 20/ ,/ 30/ ]/ 时/ ,/ 区间/ 划分/ 数/ h/ 和/ 数据/ 值/ 误差/ 阈值/ 的/ 关系/ ./ 图/ 5/ 区间/ 划分/ 数目/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 20/ ,/ t/ =/ 100/ )/ 图/ 6/ 区间/ 划分/ 数目/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 50/ ,/ t/ =/ 100/ )/ 图/ 7/ 区间/ 划分/ 数目/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 88/ ,/ t/ =/ 100/ )/ 图/ 9/ ~/ 图/ 11/ 为/ 在/ 区间/ 划分/ 数/ h/ 为/ 100/ 时/ ,/ 采集/ 数据/ 轮数/ t/ (/ 即/ 查询/ 周期/ t/ )/ 对/ 传感器/ 节点/ 连续/ 传输数据/ 通信量/ 的/ 影响/ ./ 可以/ 看出/ 通信量/ 从/ 高到/ 低/ 依次/ 为/ KIPDA/ 、/ H/ -/ PGAQ/ 、/ 端到/ 端/ 方案/ 和/ F/ -/ PGAQ/ ./ KIPDA/ 略高于/ H/ -/ PGAQ/ ./ KIPDA/ 、/ H/ -/ PGAQ/ 和/ 端/ 到/ 端/ 方案/ 通信量/ 高于/ F/ -/ PGAQ/ 通信量/ ,/ 同样/ 因为/ F/ -/ PGAQ/ 使用/ 了/ 过滤器/ 机制/ ,/ 减少/ 了/ 通信量/ ./ KIPDA/ 、/ H/ -/ PGAQ/ 、/ 端到/ 端/ 方案/ 和/ F/ -/ PGAQ/ 都/ 随/ 采集/ 数据/ 轮数/ 增长/ 而/ 增长/ ,/ 因为/ KIPDA/ 、/ H/ -/ PGAQ/ 和/ 端/ 到/ 端/ 方案/ 没有/ 使用/ 过滤/ 机制/ ,/ 所以/ 随/ 采集/ 数据/ 轮数/ 增长/ 基本/ 呈/ 线性/ 增长/ ./ 图/ 9/ 采集/ 数据/ 轮数/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 20/ ,/ h/ =/ 100/ )/ 图/ 10/ 采集/ 数据/ 轮数/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 50/ ,/ h/ =/ 100/ )/ 图/ 11/ 采集/ 数据/ 轮数/ 对/ 通信量/ 的/ 影响/ (/ n/ =/ 88/ ,/ h/ =/ 100/ )/ Page117/ 总结/ 本文/ 提出/ 一种/ 在/ 传感器/ 网络/ 中/ 基于/ 聚集/ 的/ 通用/ 隐私/ 保护/ 通用/ 查询/ 协议/ PGAQ/ ./ PGAQ/ 使用/ 网/ 内/ 求和/ 聚集/ 以/ 减少/ 能量消耗/ ,/ 并且/ 能够/ 通过/ 调节/ 直方图/ 划分/ 粒度/ 来/ 平衡/ 查询/ 精度/ 与/ 能量消耗/ ./ 通过/ 理论/ 分析/ 和/ 使用/ 真实/ 数据/ 集/ 实验/ 验证/ 了/ PGAQ/ 的/ 安全性/ 和/ 有效性/ ./ PGAQ/ 协议/ 分为/ H/ -/ PGAQ/ 和/ F/ -/ PGAQ/ 两种/ 模式/ ./ H/ -/ PGAQ/ 模式/ 使用/ 数据/ 扰动/ 技术/ 和/ 单路/ Hash/ 函数/ ,/ 这样/ 即使/ 聚集/ 节点/ 能够/ 获得/ 传感器/ 节点/ 和/ 基站/ 共享/ 密钥/ ,/ 能够/ 解密/ 并/ 获得/ 基站/ 下发/ 的/ 参照/ 向量/ ,/ 聚集/ 节点/ 也/ 不能/ 计算/ 出/ 感知/ 数据/ ,/ 增强/ 了/ 数据/ 安全性/ ,/ 但是/ H/ -/ PGAQ/ 需要/ 所有/ 传感器/ 节点/ 上传/ 数据/ ,/ 连续/ 查询/ 时/ 通信/ 代价/ 较/ 高/ ./ F/ -/ PGAQ/ 假设/ 聚集/ 节点/ 不/ 能够/ 获取/ 传感器/ 节点/ 和/ 基站/ 共享/ 的/ 密钥/ ,/ 使用/ 参照/ 向量/ 进行/ 隐私/ 保护/ ./ F/ -/ PGAQ/ 使用/ 过滤器/ 减少/ 连续/ 查询/ 通信量/ ,/ 将/ 直方图/ 划分/ 作为/ 过滤器/ 窗口/ ,/ 如果/ 本轮/ 采集/ 数据/ 与/ 上/ 轮/ 采集/ 数据/ 落入/ 同一/ 直方图/ 划分/ ,/ 则/ 不/ 需要/ 上传/ 数据/ ,/ 通过/ 理论/ 分析/ 和/ 实验/ 验证/ ,/ F/ -/ PGAQ/ 显著/ 减少/ 了/ 通信量/ 和/ 能量消耗/ ./ 我们/ 未来/ 将/ 进一步/ 研究/ PGAQ/ 参数/ 优化/ 问题/ ,/ 使得/ PGAQ/ 在/ 隐私/ 保护/ 能力/ 、/ 查询/ 精度/ 和/ 能量消耗/ 等/ 方面/ 更加/ 优化/ 和/ 平衡/ ./ 

