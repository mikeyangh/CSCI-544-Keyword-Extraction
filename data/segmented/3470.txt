Page1/ 基于/ Map/ -/ Reduce/ 的/ 海量/ 数据/ 高效/ Skyline/ 查询处理/ 丁琳琳/ 信俊昌/ 王国/ 仁/ 黄山/ (/ 医学影像/ 计算/ 教育部/ 重点/ 实验室/ (/ 东北大学/ )/ 沈阳/ 110819/ )/ (/ 东北大学/ 信息科学/ 与/ 工程学院/ 沈阳/ 110819/ )/ 摘要/ Skyline/ 查询/ 已/ 成为/ 现今/ 数据库/ 和/ 信息检索/ 领域/ 的/ 研究/ 热点/ 之一/ ,/ 伴随/ 着/ 人类/ 可以/ 采集/ 和/ 利用/ 的/ 数据/ 信息/ 的/ 急剧/ 增长/ ,/ 使得/ 如何/ 处理/ 海量/ 数据/ 的/ Skyline/ 查询/ 成为/ 急需解决/ 的/ 问题/ ./ 近年来/ 兴起/ 的/ Map/ -/ Reduce/ 编程/ 框架/ 能够/ 有效/ 地/ 处理/ 基于/ 海量/ 数据/ 的/ 应用/ ,/ 该文/ 既/ 是/ 研究/ 如何/ 运用/ Map/ -/ Reduce/ 编程/ 框架/ 解决/ 海量/ 数据/ 的/ Skyline/ 查询/ 问题/ ./ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ Skyline/ 查询/ 的/ 直接/ 方法/ 是/ 扫描/ 整个/ 数据/ 集/ 进而/ 得到/ 查询/ 结果/ ,/ 但是/ 在/ 海量/ 数据/ Skyline/ 查询/ 问题/ 中/ ,/ 查询/ 结果/ 的/ 数量/ 远/ 小于/ 原始数据/ 集/ 的/ 数据量/ ,/ 对此/ 该文/ 提出/ 了/ 一系列/ 的/ Skyline/ 查询/ 算法/ 及/ 优化/ ,/ 有效/ 地/ 过滤/ 掉/ 部分/ 不能/ 成为/ Skyline/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 大幅度提高/ 了/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ Skyline/ 查询/ 的/ 效率/ ./ 大量/ 运行/ 在/ Hadoop/ 平台/ 上/ 的/ 实验/ 验证/ 了/ 该文/ 所/ 提出/ 的/ Skyline/ 查询处理/ 算法/ 具有/ 良好/ 的/ 有效性/ 、/ 准确性/ 和/ 可用性/ ./ 关键词/ 云/ 计算/ ;/ Skyline/ 查询/ ;/ Map/ -/ Reduce/ ;/ 海量/ 数据/ ;/ Hadoop1/ 引言/ 随着/ 信息时代/ 的/ 到来/ ,/ Skyline/ 查询/ 已/ 成为/ 现今/ 数据库/ 和/ 信息检索/ 领域/ 的/ 研究/ 热点/ 之一/ ,/ 并/ 被/ 广泛/ 地/ 应用/ 于/ 多/ 目标/ 决策分析/ 和/ 数据/ 可视化/ 等/ 领域/ ./ Skyline/ 查询/ 的/ 主要/ 目标/ 是/ 在/ 给定/ 的/ 数据/ 集中/ 搜索/ 不/ 被/ 其它/ 数据/ 对象/ “/ 支配/ ”/ 的/ 数据/ 对象/ ./ 一个/ 数据/ 对象/ “/ 支配/ ”/ 另/ 一个/ 数据/ 对象/ 指/ 的/ 是/ 该/ 数据/ 对象/ 在/ 所有/ 维度/ 都/ 不/ 比/ 另/ 一个/ 数据/ 对象/ “/ 差/ ”/ ,/ 并且/ 至少/ 有/ 一个/ 维度/ 比/ 另/ 一个/ 数据/ 对象/ “/ 优/ ”/ ,/ 这里/ “/ 优/ ”/ 和/ “/ 差/ ”/ 的/ 定义/ 并/ 无/ 统一标准/ ,/ 而是/ 根据/ 不同/ 应用/ 的/ 特点/ 确定/ ./ 例如/ ,/ 图/ 1/ 所示/ 为/ 某/ 沿海/ 城市/ 酒店/ 的/ Skyline/ 查询/ 情况/ ./ 酒店/ 的/ 价格/ 和/ 到/ 海边/ 的/ 距离/ 是/ 衡量/ 某个/ 酒店/ “/ 优/ ”/ 或/ “/ 差/ ”/ 的/ 两个/ 标准/ ,/ 可以/ 看出/ 到/ 海边/ 距离/ 越近/ 的/ 酒店/ 其/ 价格/ 也/ 越贵/ ,/ 反之/ ,/ 酒店/ 价格/ 越/ 便宜/ ,/ 在/ 图/ 1/ 中/ 位于/ 虚线/ 上/ 的/ 点/ 既/ 是/ 该/ Skyline/ 查询/ 的/ 结果/ 集/ ,/ 在/ 结果/ 集中/ 的/ 点/ 即/ 为/ 不/ 被/ 其它/ 点/ 所/ “/ 支配/ ”/ 的/ 点/ ./ 当/ 游客/ 到/ 该/ 城市/ 旅行/ ,/ 希望/ 找到/ 既离/ 海边/ 近/ 并且/ 价格/ 又/ 便宜/ 的/ 酒店/ 时/ ,/ 只/ 需/ 在/ 该/ Skyline/ 查询/ 结果/ 集中/ 的/ 点/ 进行/ 选择/ ,/ 就/ 可以/ 找到/ 令/ 游客/ 满意/ 的/ 酒店/ ./ 除此之外/ ,/ Skyline/ 查询/ 还/ 可以/ 应用/ 到/ 如何/ 选择/ 工作/ 能力/ 强且/ 要求/ 薪水/ 低/ 的/ 员工/ 和/ 如何/ 买/ 到/ 质量/ 好/ 并且/ 价格低/ 的/ 商品/ 中/ ./ 然而/ ,/ 随着/ 网络/ 信息/ 和/ 通信/ 技术/ 的/ 迅猛发展/ ,/ 人类/ 可以/ 采集/ 并/ 利用/ 的/ 数据量/ 急剧/ 增长/ ,/ 使得/ 如何/ 在/ 海量/ 数据/ 集中/ 迅速/ 确定/ Skyline/ 查询/ 结果/ 成为/ 迫切需要/ 解决/ 的/ 问题/ ./ 自/ 2001/ 年/ ,/ Borzsonyi/ 等/ 人/ [/ 1/ ]/ 将/ Skyline/ 查询/ 引入/ 到/ 数据库/ 中/ 以来/ ,/ 其/ 得到/ 了/ 广泛/ 的/ 重视/ 并/ 取得/ 了/ 一系列/ 的/ 研究成果/ [/ 2/ ]/ ./ 尽管/ ,/ 现有/ 的/ Skyline/ 查询/ 能够/ 解决/ 很多/ 实际/ 问题/ ,/ 但/ 这些/ 算法/ 并/ 不适/ 用于/ 海量/ 数据/ 的/ 处理/ ./ 近年来/ 出现/ 的/ Map/ -/ Re/ -/ duce/ [/ 3/ ]/ 并行/ 编程/ 框架/ 定/ 位于/ 处理/ 海量/ 数据/ ,/ 具有/ 良好/ 的/ 可扩展性/ 和/ 容错性/ ,/ 能够/ 满足/ 数据量/ 迅速/ 增长/ 的/ 需要/ ,/ 因此/ 可以/ 运用/ Map/ -/ Reduce/ 框架/ 解决/ 海量/ 数据/ 的/ Skyline/ 查询处理/ 问题/ ./ 本文/ 主要/ 研究/ 如何/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ Skyline/ 查询/ ./ 在/ 分析/ 了/ 基于/ Map/ -/ Reduce/ 框架/ 处理/ Skyline/ 查询/ 的/ 基本/ 算法/ 后/ ,/ 针对/ Skyline/ 查询/ 结果/ 的/ 数量/ 远/ 小于/ 原始数据/ 集/ 的/ 数据量/ 的/ 问题/ ,/ 本文/ 又/ 提出/ 了/ 一系列/ 的/ Sky/ -/ line/ 查询/ 算法/ ,/ 能够/ 有效/ 地/ 过滤/ 部分/ 不能/ 成为/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 减少/ Map/ 任务/ 的/ 输出/ ,/ 同时/ 降低/ Reduce/ 任务/ 的/ 输入量/ ,/ 使得/ 在/ 有效/ 解决/ 海量/ 数据/ Skyline/ 查询/ 问题/ 的/ 同时/ 提高/ 了/ 算法/ 的/ 效率/ ,/ 降低/ 了/ 网络/ 开销/ ./ 算法/ 具有/ 高效/ 、/ 准确/ 和/ 可/ 扩展/ 等/ 特性/ ./ 本文/ 主要/ 贡献/ 点/ 如下/ :/ (/ 1/ )/ 提出/ 3/ 个/ 在/ Map/ -/ Reduce/ 框架/ 下/ 具有/ 过滤/ 性质/ 的/ 海量/ 数据/ 高效/ Skyline/ 查询处理/ 算法/ ,/ 分别/ 是/ 延迟/ Skyline/ 查询/ 算法/ 、/ 贪婪/ Skyline/ 查询/ 算法/ 和/ 混合/ Skyline/ 查询/ 算法/ ./ (/ 2/ )/ 提出/ 1/ 个/ Skyline/ 查询/ 优化/ 算法/ ,/ 前置/ Sky/ -/ line/ 查询/ 算法/ ./ (/ 3/ )/ 大量/ 实验/ 结果/ 验证/ 了/ 本文/ 提出/ 的/ Skyline/ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 提出/ Map/ -/ Reduce/ 框架/ 下/ 海量/ 数据/ Skyline/ 查询处理/ 算法/ ;/ 第/ 4/ 节/ 提出/ Skyline/ 查询处理/ 优化/ 算法/ ;/ 第/ 5/ 节/ 分析/ 实验/ 结果/ ;/ 第/ 6/ 节/ 进行/ 总结/ ./ 2/ 相关/ 工作/ 2.1/ Skyline/ 查询/ 目前/ ,/ Skyline/ 查询/ 的/ 相关/ 研究/ 主要/ 分为/ 集中式/ Skyline/ 查询/ 和/ 分布式/ Skyline/ 查询/ ./ 集中式/ Skyline/ 查询/ 主要/ 针对/ 数据量/ 大且/ 更新/ 不/ 频繁/ 的/ 情况/ ./ 集中式/ Skyline/ 查询/ 算法/ 中/ 的/ BNL/ 算法/ [/ 1/ ]/ 的/ 基本原理/ 是/ 通过/ 将/ 数据/ 集中/ 某个/ 数据/ 对象/ 与/ 数据/ 集中/ 其它/ 数据/ 对象/ 比较/ 用以/ 检索/ 数据/ 集中/ 不/ 被/ 其它/ 数据/ 对象/ 支配/ 的/ 数据/ 对象/ ./ Bitmap/ 算法/ [/ 4/ ]/ 是/ 一种/ 利用/ 比特/ 位/ 运算/ 的/ 高效/ 方法/ ,/ 利用/ 位/ 运算/ 快/ 的/ 特点/ 提高/ 算法/ 的/ 效率/ ./ NN/ 算法/ [/ 5/ ]/ 的/ 基本原理/ 是/ 先/ 对/ 数据/ 集中/ 的/ 数据/ 对象/ 构建/ R/ -/ tree/ 索引/ ,/ 并/ 利用/ 最近/ 邻/ 算法/ 求/ 出/ 距离/ 原点/ 最近/ 的/ 点/ ,/ 然后/ 利用/ 该点/ 的/ 信息/ 对/ 数据/ 空间/ 进行/ 划分/ ,/ 并/ 在/ 每个/ 划分/ 中/ 递归/ 此/ 过程/ ,/ 直到/ 分区/ 中/ 不/ 含有/ 任何/ Skyline/ 查询/ 结果/ 为止/ ./ 文献/ [/ 6/ ]/ 提出/ 了/ 一种/ 在线/ 高效/ 子/ 空间/ Skyline/ 算法/ CSky/ ,/ 利用/ 新/ 的/ 数/ Page3/ 据/ 结构/ InventS/ 将/ 可能/ 成为/ Skyline/ 结果/ 的/ 点/ 置于/ 优先/ 扫描/ 的/ 位置/ ,/ 保证/ 了/ 算法/ 的/ 渐进性/ ./ 分布式/ Skyline/ 查询/ 算法/ 的/ 研究/ 主要/ 集中/ 于/ 算法/ 的/ 渐进性/ ,/ 节点/ 之间/ 负载平衡/ 等/ ,/ 用于/ 万维网/ 、/ P2P/ 等/ 网络/ 中/ ./ BDS/ 算法/ [/ 7/ ]/ 的/ 基本原理/ 是/ 先/ 确定/ 数据/ 集中/ 一个/ 包含/ Skyline/ 查询/ 结果/ 和/ 非/ 查询/ 结果/ 的/ 数据/ 对象/ 的/ 子集/ ,/ 并/ 从中/ 删除/ 非/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 形成/ 最终/ Skyline/ 查询/ 结果/ ./ IDS/ 算法/ [/ 7/ ]/ 的/ 基本原理/ 是/ 利用/ 启发式/ 规则/ 减少/ 候选/ 集合/ 计算/ 中/ 的/ 访问/ 次数/ ,/ 从而/ 在/ 分布式/ 环境/ 中/ 提高/ 系统/ 的/ 效率/ ./ 文献/ [/ 8/ ]/ 提出/ 了/ 一种/ 基于/ P2P/ 网络/ 的/ CAN/ 结构/ 的/ 分布式/ Skyline/ 查询/ 算法/ DSL/ ,/ 主要/ 原理/ 是/ 采用/ 负载平衡/ 策略/ 在/ 节点/ 间/ 分割/ 数据/ 并/ 采用/ 动态/ 编码/ 策略/ 提高/ 了/ Skyline/ 查询/ 的/ 效率/ ./ 文献/ [/ 9/ ]/ 提出/ 一种/ 有效/ 的/ 滑动/ 窗口/ Skyline/ 监督/ 算法/ 及其/ 优化/ ,/ 通过/ 采用/ 不同/ 的/ 过滤/ 方法/ 减少/ 传输/ 的/ 数据量/ ,/ 降低/ 了/ 算法/ 的/ 代价/ ./ 不论是/ 集中式/ Skyline/ 查询/ 算法/ 还是/ 分布式/ Skyline/ 查询/ 算法/ ,/ 面对/ 日益增长/ 的/ 海量/ 数据/ ,/ 都/ 会/ 增加/ 处理/ Skyline/ 查询/ 的/ 计算/ 量/ 和/ 代价/ ,/ 降低/ 了/ Skyline/ 查询/ 算法/ 的/ 性能/ ./ 2.2/ Map/ -/ Reduce/ 框架/ Map/ -/ Reduce/ 是/ 现今/ 较为/ 流行/ 的/ 并行/ 编程/ 框架/ ,/ 用于/ 大规模/ 数据/ 集/ 的/ 并行计算/ ./ 最早/ 是/ 由/ Dean/ 等/ 人/ 在/ 2004/ 年/ 提出/ 的/ ,/ 其/ 开源/ 实现/ 是/ Hadoop/ 平台/ ①/ ./ 图/ 2/ 说明/ 了/ Map/ -/ Reduce/ 的/ 基本/ 框架/ ,/ 框架/ 中/ 包含/ 一个/ Master/ 节点/ 和/ 多个/ Slave/ 节点/ ,/ Master/ 节点/ 负责/ 整个/ 框架/ 的/ 任务调度/ 和/ 分配/ ,/ Slave/ 节点/ 负责/ 执行/ 分配/ 到/ 自身/ 的/ 任务/ ./ 在/ Map/ -/ Reduce/ 框架/ 中/ 一个/ 作业/ 的/ 处理过程/ 主要/ 包括/ 两个/ 阶段/ :/ 用于/ 划分/ 原始数据/ 和/ 产生/ 中间/ 结果/ 的/ Map/ 阶段/ 和/ 生成/ 最终/ 结果/ 的/ Reduce/ 阶段/ ./ 用户/ 可以/ 通过/ 简单/ 的/ 配置/ Map/ -/ per/ 函数/ 和/ Reducer/ 函数/ 来/ 实现/ 对/ 原有/ 任务/ 的/ 并行执行/ ./ 近年来/ ,/ 关于/ Map/ -/ Reduce/ 的/ 研究/ 也/ 不断深入/ ,/ 涌现出/ 一系列/ 的/ 研究成果/ ,/ 主要/ 围绕/ 在/ 改进/ Map/ -/ Reduce/ 架构/ 以/ 适应/ 处理/ 某些/ 特定/ 应用/ 和/ 将/ 某些/ 现有/ 问题/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ 两/ 方面/ ./ Hadoop/ ++/ [/ 10/ ]/ 通过/ 调用/ 用户/ 自定义/ 函数/ 提高/ Map/ -/ Reduce/ 的/ 性能/ ,/ 但/ 并未/ 改变/ Hadoop/ 原有/ 的/ 框架/ ./ HaLoop/ [/ 11/ ]/ 是/ Hadoop/ 的/ 改进/ 版本/ ,/ 通过/ 增加/ 和/ 修改/ 一些/ 功能模块/ 有效/ 地/ 处理/ 具有/ 迭代/ 特征/ 的/ 应用/ ./ Map/ -/ Reduce/ -/ Merge/ [/ 12/ ]/ 通过/ 给/ Map/ -/ Reduce/ 框架/ 增加/ 一个/ Merge/ 阶段/ 有效/ 地/ 合并/ 已经/ 被/ Map/ 和/ Reduce/ 阶段/ 划分/ 和/ 排序/ 的/ 数据/ ,/ 用来/ 处理/ 关系数据库/ 的/ 相关/ 应用/ ./ 尽管/ Map/ -/ Reduce/ 的/ 相关/ 研究/ 已/ 成为/ 当今/ 的/ 研究/ 热点/ ,/ 但是/ 对于/ Skyline/ 查询/ 来说/ ,/ 利用/ Map/ -/ Reduce/ 框架/ 处理/ Skyline/ 查询/ 的/ 相关/ 研究/ 还/ 相当/ 初步/ ./ 目前/ ,/ 文献/ [/ 13/ -/ 14/ ]/ 将/ Skyline/ 查询处理/ 问题/ 引入/ 到/ Map/ -/ Reduce/ 框架/ 中/ ,/ 根据/ 不同/ 的/ 数据/ 划分/ 策略/ ,/ 实现/ 了/ Skyline/ 查询/ 的/ 块/ 嵌套循环/ 算法/ (/ Map/ -/ ReducebasedBlock/ -/ Nested/ -/ Loops/ ,/ MR/ -/ BNL/ )/ 等/ 3/ 个/ Skyline/ 查询/ 算法/ ./ 文献/ [/ 13/ -/ 14/ ]/ 仅仅/ 是/ 在/ Map/ -/ Reduce/ 框架/ 下/ 实现/ 了/ Skyline/ 查询处理/ 算法/ ,/ 并未/ 对/ 算法/ 提出/ 优化/ ,/ 而/ 本文/ 针对/ 海量/ 数据/ 的/ Skyline/ 查询/ 中/ Skyline/ 查询/ 结果/ 的/ 数量/ 远/ 小于/ 原始数据/ 集/ 的/ 数据量/ 的/ 问题/ 提出/ 了/ 一系列/ 优化/ 算法/ ,/ 提高/ 了/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ Skyline/ 查询/ 问题/ 的/ 效率/ ./ 3/ 基于/ Map/ -/ Reduce/ 框架/ 的/ 高效/ Skyline/ 查询处理/ 算法/ 本/ 节/ 主要/ 说明/ Map/ -/ Reduce/ 框架/ 下/ Skyline/ 查询处理/ 算法/ ./ 首先/ ,/ 3.1/ 小节/ 介绍/ 了/ Map/ -/ Reduce/ 框架/ 下/ Skyline/ 查询/ 的/ 基本/ 算法/ ,/ 3.2/ ~/ 3.4/ 小节/ 分别/ 介绍/ 了/ 本文/ 所/ 提出/ 的/ 3/ 个/ Skyline/ 查询/ 算法/ ,/ 分别/ 是/ 延迟/ Skyline/ 查询/ 算法/ 、/ 贪婪/ Skyline/ 查询/ 算法/ 和/ 混合/ Skyline/ 查询/ 算法/ ./ 3.1/ 基本/ Skyline/ 查询/ 算法/ 文献/ [/ 13/ -/ 14/ ]/ 中/ 所/ 提出/ 的/ 基于/ Map/ -/ Reduce/ 的/ 块/ 嵌套循环/ 算法/ (/ Map/ -/ ReducebasedBlock/ -/ Nested/ -/ Loops/ ,/ MR/ -/ BNL/ )/ 、/ 基于/ Map/ -/ Reduce/ 的/ 排序/ 过滤/ 算法/ (/ Map/ -/ ReducebasedSort/ -/ Filter/ -/ Skyline/ ,/ MR/ -/ SFS/ )/ ,/ 其/ 执行/ 过程/ 及/ 原理/ 可以/ 归纳/ 为/ 在/ Map/ -/ Re/ -/ duce/ 框架/ 下/ 处理/ Skyline/ 查询/ 的/ 基本/ 算法/ ,/ 本文/ 选择/ 性能/ 略优/ 的/ MR/ -/ BNL/ 算法/ 为例/ 进行/ 分析/ 和/ 说明/ ./ 下面/ 以/ 一个二维/ 空间/ Skyline/ 查询/ 为例/ 说明/ 基本/ Skyline/ 查询/ 算法/ 的/ 原理/ ./ 如图/ 3/ 所示/ ,/ 在/ 二维/ 空间/ ①/ Hadoop/ ./ http/ :/ // // hadoop/ ./ apache/ ./ org/ // Page4/ 中有/ 50/ 个/ 数据/ 点/ ,/ 求/ 这/ 50/ 个点/ 的/ Skyline/ 查询/ 结果/ ,/ 由图/ 3/ 可知/ 实心/ 圆点/ 表示/ 该/ Skyline/ 查询/ 的/ 结果/ 即点/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ (/ 3/ ,/ 3/ )/ ,/ (/ 4/ ,/ 2/ )/ ,/ (/ 5/ ,/ 1/ )/ ./ 假设/ 整个/ Map/ -/ Reduce/ 框架/ 中/ 包含/ 5/ 个/ Map/ 任务/ 和/ 1/ 个/ Re/ -/ duce/ 任务/ ,/ 50/ 个/ 数据/ 点/ 被/ 随机/ 划分/ 成/ 5/ 个/ 分片/ ,/ 分别/ 由/ 5/ 个/ Map/ 任务/ 执行/ ,/ 得到/ 自身/ 的/ 中间/ Skyline/ 结果/ ,/ 进行/ 排序/ 和/ 分组/ 后/ 发送给/ Reduce/ 任务/ ./ Re/ -/ duce/ 任务/ 接收/ 到/ 所有/ Map/ 任务/ 的/ 中间/ 结果/ 后/ 产生/ 最终/ 的/ Skyline/ 查询/ 结果/ ,/ 具体/ 执行/ 过程/ 如图/ 4/ 所示/ ./ 例如/ ,/ 对于/ 第/ 1/ 个/ Map/ 任务/ 来说/ ,/ 原始数据/ 点为/ (/ 2/ ,/ 10/ )/ ,/ (/ 4/ ,/ 10/ )/ ,/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 9/ )/ ,/ (/ 4/ ,/ 9/ )/ ,/ (/ 3/ ,/ 8/ )/ ,/ (/ 5/ ,/ 8/ )/ ,/ (/ 2/ ,/ 7/ )/ ,/ (/ 4/ ,/ 7/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ 产生/ 的/ Skyline/ 查询/ 结果/ 为点/ (/ 1/ ,/ 9/ )/ 和/ (/ 2/ ,/ 5/ )/ ,/ 同理/ ,/ 第/ 2/ 个/ Map/ 任务/ 产生/ 的/ Sky/ -/ line/ 查询/ 结果/ 为点/ (/ 5/ ,/ 9/ )/ ,/ (/ 6/ ,/ 8/ )/ 和/ (/ 8/ ,/ 7/ )/ ,/ 第/ 3/ 、/ 4/ 、/ 5/ 个/ Map/ 任务/ 产生/ 的/ Skyline/ 查询/ 中间/ 结果/ 集为/ 图/ 4/ 基本/ Skyline/ 算法/ 以上/ 简要/ 介绍/ 了/ Map/ -/ Reduce/ 框架/ 下/ Skyline/ 查询处理/ 的/ 基本/ 算法/ ,/ 可以/ 看出/ 通常/ 情况/ 下/ Skyline/ 查询/ 最终/ 结果/ 的/ 数量/ 远/ 小于/ 原始数据/ 集/ 的/ 数据量/ ,/ 即使/ 采用/ Map/ -/ Reduce/ 框架/ 将/ 原有/ 数据/ 集/ 划分/ 成/ 多个/ 子/ 数据/ 集/ 进行/ 并行计算/ ,/ 其/ 代价/ 仍然/ 很大/ ,/ 在/ 数据量/ 成/ 指数/ 增长/ 的/ 情况/ 下/ 更会/ 使/ 效率/ 降低/ ./ 为了/ 进一步提高/ Skyline/ 查询/ 的/ 效率/ ,/ 本文/ 在/ 用/ Map/ -/ Reduce/ 框架/ 处理/ Skyline/ 查询/ 时/ ,/ 通过/ 采用/ 一系列/ 有效/ 的/ 方法/ 过滤/ 掉/ 一部分/ Map/ 任务/ 的/ 输出/ 结果/ ,/ 即/ 不是/ 最终/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 使得/ Reduce/ 任务/ 的/ 输入量/ 大幅度/ 减少/ ,/ 提高/ 了/ 运用/ Map/ -/ Reduce/ 框架/ 处理/ Skyline/ 查询/ 的/ 效率/ ./ 具体/ 过程/ 如下/ :/ 在/ 每个/ Map/ 任务/ 结束/ 后/ ,/ 通过/ 与/ Master/ 节点/ 建立/ 连接/ ,/ 每个/ Map/ 点/ (/ 3/ ,/ 3/ )/ ,/ (/ 4/ ,/ 2/ )/ ,/ (/ 5/ ,/ 5/ )/ ,/ (/ 7/ ,/ 2/ )/ ,/ (/ 5/ ,/ 1/ )/ ./ Reduce/ 任务/ 接收/ 到/ 5/ 个/ Map/ 任务/ 所/ 产生/ 的/ 中间/ 结果/ 之后/ ,/ 通过/ 调用/ 用户/ 定义/ 的/ Reducer/ 函数/ 求得/ 该/ Skyline/ 查询/ 的/ 最终/ 结果/ ,/ 即点/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ (/ 3/ ,/ 3/ )/ ,/ (/ 4/ ,/ 2/ )/ ,/ (/ 5/ ,/ 1/ )/ ./ 任务/ 选择/ 一个/ 自身/ 的/ Skyline/ 查询/ 结果/ 作为/ 其/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ ,/ Master/ 节点/ 根据/ 不同/ 的/ 策略/ 在/ 接收/ 到/ 的/ 局部/ 过滤/ 值中/ 选择/ 一个/ 作为/ 全局/ 过滤/ 值/ ,/ 然后/ Map/ 任务/ 根据/ 全局/ 过滤/ 值/ 对/ 自身/ Skyline/ 查询/ 结果/ 进行/ 过滤/ ,/ 过滤/ 一些/ 不能/ 成为/ Skyline/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 再/ 发送给/ Reduce/ 任务/ ,/ 使得/ 输入量/ 大大减少/ ./ Reduce/ 任务/ 接收/ 过滤/ 后/ 的/ 中间/ 结果/ ,/ 然后/ 调用/ 用户/ 定义/ 的/ Reducer/ 函数/ 产生/ 最终/ 的/ Skyline/ 查询/ 结果/ ./ 3.2/ 延迟/ Skyline/ 查询/ 算法/ 延迟/ Skyline/ 查询/ 算法/ 的/ 基本原理/ 是/ :/ 在/ 所有/ Map/ 任务/ 完成/ 后/ 将/ 自身/ 的/ 局部/ 过滤/ 值/ 发送给/ Mas/ -/ ter/ 节点/ ,/ Master/ 节点/ 在/ 接收/ 到/ 所有/ Map/ 任务/ 的/ 局/ Page5/ 部/ 过滤/ 值/ 之后/ 产生/ 全局/ 过滤/ 值/ 再/ 将/ 其/ 发送给/ 每个/ Map/ 任务/ ,/ 每个/ Map/ 任务/ 接收/ 到/ 全局/ 过滤/ 值/ 之后/ ,/ 运用/ 该/ 全局/ 过滤/ 值/ 对/ 自身/ 结果/ 进行/ 过滤/ 并/ 产生/ 各自/ Skyline/ 查询/ 结果/ ,/ Reduce/ 任务/ 以/ 过滤/ 后/ 的/ 中间/ 结果/ 为/ 输入/ 产生/ 最终/ 的/ Skyline/ 查询/ 结果/ ./ 图/ 5/ 表示/ 的/ 是/ 运用/ 延迟/ Skyline/ 查询/ 算法/ 处理/ 3.1/ 节中/ Skyline/ 查询/ 的/ 过程/ ./ 原有/ 数据/ 集/ 被/ 划分/ 成/ 5/ 个/ 分片/ ,/ 分别/ 由/ 5/ 个/ Map/ 任务/ 处理/ ,/ 每个/ Map/ 任务/ 处理/ 自身/ 的/ 数据/ 得到/ 局部/ Skyline/ 查询/ 结果/ ,/ 并/ 产生/ 局部/ 过滤/ 值/ ./ 本文/ 采用/ 文献/ [/ 9/ ]/ 中/ 的/ 滑动/ 窗口/ Skyline/ 监督/ 算法/ (/ SWSMA/ )/ 求得/ 局部/ 过滤/ 值/ 和/ 全局/ 过滤/ 值/ ,/ 基本原理/ 是/ :/ 假设/ 集合/ S/ 是/ D/ 维空间/ 中/ 的/ 一个/ 数据/ 集/ ,/ 其中/ 第/ i/ 维/ 的/ 范围/ 是/ [/ 0/ ,/ Di/ ]/ ,/ X/ 和/ Y/ 是/ 数据/ 集/ S/ 中/ 的/ 两个/ 数据/ 对象/ ,/ 分别/ 表示/ 成/ (/ x1/ ,/ x2/ ,/ …/ ,/ xD/ )/ 和/ (/ y1/ ,/ y2/ ,/ …/ ,/ yD/ )/ ,/ 数据/ 对象/ X/ 的/ 概率密度函数/ 为/ p/ (/ x/ )/ =/ p/ (/ x1/ ,/ x2/ ,/ …/ ,/ xD/ )/ ,/ 则/ 数据/ 对象/ Y/ 可以/ “/ 支配/ ”/ 的/ 数据/ 对象/ 数量/ 由/ 下面/ 的/ 式/ (/ 1/ )/ 确定/ :/ c/ (/ Y/ )/ =/ S/ ×/ ∫/ R/ 其中/ R/ =/ {/ X/ |/ x1/ / y1/ ,/ x2/ / y2/ ,/ …/ ,/ xD/ / yD/ }/ ./ 因此/ ,/ 对于/ 每个/ 数据/ 对象/ 来说/ ,/ 由式/ (/ 1/ )/ 求得/ 的/ 值/ 越/ 大/ ,/ 表明/ 其/ 过滤/ 能力/ 越强/ ,/ “/ 支配/ ”/ 能力/ 也/ 越强/ ./ 尽管/ 式/ (/ 1/ )/ 中/ 的/ p/ (/ x/ )/ 在/ 大多数/ 情况/ 下/ 并/ 不/ 已知/ ,/ 但/ 可以/ 运用/ 随机取样/ 或/ 直方图/ 的/ 方法/ 近似/ 求得/ ./ 另外/ ,/ 求得/ 局部/ 过滤/ 值/ 和/ 全局/ 过滤/ 值/ 的/ 方法/ 不仅/ 限于/ 本文/ 中/ 的/ 一种/ ,/ 任何/ 求/ Skyline/ 查询/ 点/ 的/ 方法/ 均/ 可以/ 用来/ 求/ 局部/ 过滤/ 值/ 和/ 全局/ 过滤/ 值/ ./ 以/ 二维/ 空间/ 为例/ ,/ 对于/ 每个/ 数据/ 点/ 来说/ ,/ 可以/ 运用/ 文献/ [/ 9/ ]/ 中/ 的/ 方法/ 确定/ 该点/ 的/ “/ 支配/ ”/ 图/ 5/ 延迟/ Skyline/ 算法/ 能力/ ,/ 凡是/ 位于/ 该点/ “/ 支配/ ”/ 范围/ 内/ 的/ 点/ ,/ 均/ 是/ 被/ 该点/ “/ 支配/ ”/ 的/ 点/ ,/ 即/ 一定/ 不是/ Skyline/ 查询/ 结果/ ./ 运用/ 这种/ 方法/ ,/ 每个/ Map/ 任务/ 对/ 自身/ 局部/ Skyline/ 查询/ 结果/ 比较/ 其/ “/ 支配/ ”/ 能力/ ,/ 并/ 将/ 具有/ 最大/ “/ 支配/ ”/ 能力/ 的/ 点/ 作为/ 其/ 局部/ 过滤/ 值/ ,/ 发送给/ Master/ 节点/ ./ 在/ 图/ 5/ 中/ ,/ 本文/ 仅以/ 3/ 个/ 步骤/ 进行/ 说明/ ./ 步/ 1/ ./ 每个/ Map/ 任务/ 在/ 产生/ 局部/ 过滤/ 值后/ 将/ 其/ 发送给/ Master/ 节点/ ./ 例如/ ,/ 第/ 1/ 个/ Map/ 任务/ 产生/ 的/ Skyline/ 查询/ 结果/ 为点/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ 而点/ (/ 2/ ,/ 5/ )/ 的/ “/ 支配/ ”/ 能力/ 大于/ 点/ (/ 1/ ,/ 9/ )/ ,/ 即点/ (/ 2/ ,/ 5/ )/ 可以/ “/ 支配/ ”/ 的/ 范围/ 大于/ 点/ (/ 1/ ,/ 9/ )/ ,/ 因此/ ,/ 第/ 1/ 个/ Map/ 任务/ 产生/ 的/ 局部/ 过滤/ 值为/ 点/ (/ 2/ ,/ 5/ )/ ./ 同理/ ,/ 第/ 2/ ~/ 5/ 个/ Map/ 任务/ 产生/ 的/ 局部/ 过滤/ 值/ 分别/ 为点/ (/ 6/ ,/ 8/ )/ ,/ (/ 3/ ,/ 3/ )/ ,/ (/ 5/ ,/ 5/ )/ ,/ (/ 5/ ,/ 1/ )/ ;/ 步/ 2/ ./ Master/ 节点/ 接收/ 到/ 所有/ Map/ 任务/ 传送/ 的/ 局部/ 过滤/ 值/ ,/ 在/ 这些/ 局部/ 过滤/ 值中/ 运用/ 同样/ 的/ 方法/ 确定/ “/ 支配/ ”/ 能力/ 最强/ 的/ 点/ ,/ 这里/ 为点/ (/ 3/ ,/ 3/ )/ ,/ 作为/ 全局/ 过滤/ 值/ ,/ 然后/ 将点/ (/ 3/ ,/ 3/ )/ 发送给/ 所有/ Map/ 任务/ ;/ 步/ 3/ ./ 在/ 每个/ Map/ 任务/ 接收/ 到/ 全局/ 过滤/ 值/ 即点/ (/ 3/ ,/ 3/ )/ 之后/ ,/ 用/ 其/ 对/ 自身/ 的/ Skyline/ 结果/ 进行/ 过滤/ ,/ 产生/ 最终/ 的/ Map/ 任务/ 输出/ ./ 例如/ 第/ 2/ 个/ Map/ 任务/ 在/ 接收/ 到/ 点/ (/ 3/ ,/ 3/ )/ 之后/ ,/ 用点/ (/ 3/ ,/ 3/ )/ 对/ 其/ Skyline/ 查询/ 结果/ 点/ (/ 5/ ,/ 9/ )/ ,/ (/ 8/ ,/ 7/ )/ ,/ (/ 6/ ,/ 8/ )/ 进行/ 过滤/ ,/ 点/ (/ 3/ ,/ 3/ )/ 可以/ “/ 支配/ ”/ 这/ 3/ 个点/ ,/ 故/ 这/ 3/ 个点/ 一定/ 不是/ 最终/ 的/ Skyline/ 查询/ 结果/ ,/ 即/ 第/ 2/ 个/ Map/ 任务/ 的/ 最终/ 输出/ 结果/ 为空/ ./ 同理/ ,/ 第/ 4/ 个/ Map/ 任务/ 也/ 用点/ (/ 3/ ,/ 3/ )/ 对/ 其/ 结果/ 点/ (/ 5/ ,/ 5/ )/ ,/ (/ 7/ ,/ 2/ )/ 进行/ 过滤/ ,/ 点/ (/ 3/ ,/ 3/ )/ 可以/ 支配/ 点/ (/ 5/ ,/ 5/ )/ ,/ 但/ 不能/ 支配/ 点/ (/ 7/ ,/ 2/ )/ ,/ 故/ 第/ 4/ 个/ Map/ 任务/ 最终/ 的/ 输出/ 结果/ 为点/ (/ 7/ ,/ 2/ )/ ./ 因此/ ,/ Reduce/ 任务/ 的/ 输入/ 为点/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ (/ 3/ ,/ 3/ )/ ,/ (/ 4/ ,/ 2/ )/ ,/ (/ 7/ ,/ 2/ )/ ,/ (/ 5/ ,/ 1/ )/ ,/ 与/ 基本/ Skyline/ 算法/ 相比/ 降低/ 了/ 40/ %/ ,/ 大幅度/ 减少/ 了/ Reduce/ 任务/ 的/ 输入/ ,/ 因此/ 能够/ 提高/ 整个/ Skyline/ 查询/ 算法/ 的/ 效率/ ./ Page6/ 然而/ ,/ 对于/ 延迟/ Skyline/ 查询/ 算法/ 来说/ ,/ 如果/ 系统/ 中/ 某些/ Map/ 任务/ 占据/ 的/ 时间/ 较长/ ,/ 那么/ Master/ 节点/ 必须/ 等待/ 这些/ Map/ 任务/ 结束/ 才能/ 产生/ 全局/ 过滤/ 值/ ./ 在/ 实际/ 应用/ 中/ ,/ 系统/ 中/ 运行/ 的/ Map/ 任务/ 数量/ 巨大/ ,/ 如果/ 某个/ Map/ 任务/ 失效/ 或/ 占据/ 时间/ 较长/ ,/ 会/ 导致/ 该/ Map/ 任务/ 不能/ 及时/ 将/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ 的/ 情况/ ,/ 使得/ Master/ 节点/ 由于/ 一直/ 等待/ 该/ Map/ 任务/ 发送/ 局部/ 过滤/ 值/ 而/ 无法/ 产生/ 全局/ 过滤/ 值/ ,/ 系统/ 会/ 进入/ “/ 死锁/ ”/ 状态/ ,/ 那么/ Master/ 节点/ 无法/ 等待/ 所有/ Map/ 任务/ 结束/ 后/ 再/ 产生/ 全局/ 过滤/ 值/ ./ 因此/ ,/ 尽管/ 延迟/ Skyline/ 算法/ 可以/ 降低/ Reduce/ 任务/ 的/ 输入量/ ,/ 但是/ 其/ 效率/ 并/ 不/ 高/ ,/ 并且/ 实际/ 应用/ 的/ 情况/ 很少/ ./ 3.3/ 贪婪/ Skyline/ 查询/ 算法/ 贪婪/ Skyline/ 查询/ 算法/ 的/ 基本原理/ 是/ :/ 当/ 一个/ Map/ 任务/ 结束/ 后/ 将/ 其/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ 并/ 获得/ 一个/ 全局/ 过滤/ 值/ ./ 如果/ 这个/ 全局/ 过滤/ 值为/ 空/ ,/ 那么/ 该/ Map/ 任务/ 将/ 其/ 所有/ Skyline/ 查询/ 结果/ 输出/ ,/ 否则/ ,/ 该/ Map/ 任务/ 用/ 这个/ 从/ Master/ 节点/ 获得/ 的/ 全局/ 过滤/ 值/ 对/ 自身/ Skyline/ 查询/ 结果/ 进行/ 过滤/ ./ Master/ 节点/ 在/ 接收/ 到/ 第一个/ Map/ 任务/ 的/ 局部/ 过滤/ 值后/ 将/ 其/ 设定/ 为/ 全局/ 过滤/ 值/ ./ 如果/ 系统/ 中/ 另外/ 一个/ Map/ 任务/ 结束/ ,/ 该/ Map/ 任务/ 也/ 将/ 其/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ ./ 当/ Master/ 节点/ 接收/ 到/ 该/ Map/ 任务/ 的/ 局部/ 过滤/ 值/ 之后/ ,/ 将/ 其/ 与/ 原有/ 全局/ 过滤/ 值/ 比较/ ,/ 根与/ 延迟/ Skyline/ 查询/ 算法/ 相比/ ,/ 贪婪/ Skyline/ 查询/ 算法/ 同样/ 能/ 将/ Reduce/ 任务/ 的/ 输入/ 降低/ 到/ 基本/ 图/ 6/ 贪婪/ Skyline/ 算法/ 据/ 不同/ 应用/ 的/ 需求/ 选择/ 最优/ 的/ 值/ 作为/ 新/ 的/ 全局/ 过滤/ 值/ ./ 这样/ 的/ 过程/ 一直/ 继续/ ,/ 直到/ 所有/ 的/ Map/ 任务/ 运行/ 结束/ 为止/ ./ 图/ 6/ 表示/ 贪婪/ Skyline/ 查询/ 算法/ 的/ 计算/ 过程/ ./ 与/ 前述/ Skyline/ 查询处理/ 算法/ 相同/ ,/ 原始数据/ 集/ 被/ 随机/ 划分/ 成/ 5/ 个/ 分片/ ,/ 分别/ 由/ 5/ 个/ Map/ 任务/ 执行/ ,/ 图/ 6/ 仅用/ 6/ 个/ 步骤/ 说明/ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ 的/ 执行/ 情况/ ,/ 其余/ Map/ 任务/ 的/ 执行/ 原理/ 与/ 前/ 2/ 个/ Map/ 任务/ 相同/ ,/ 故/ 不再/ 一一列举/ ./ 步/ 1/ ./ 当/ 系统/ 中/ 第/ 1/ 个/ Map/ 任务/ 结束/ 后/ ,/ 产生/ Skyline/ 查询/ 结果/ 为点/ (/ 1/ ,/ 9/ )/ 和/ (/ 2/ ,/ 5/ )/ ,/ 其中/ 点/ (/ 2/ ,/ 5/ )/ 作为/ 其/ 局部/ 过滤/ 值/ 被/ 发送给/ Master/ 节点/ ;/ 步/ 2/ ./ Master/ 节点/ 接收/ 到/ 点/ (/ 2/ ,/ 5/ )/ 后/ 即将/ 其/ 作为/ 当前/ 的/ 全局/ 过滤/ 值/ ,/ 发送给/ 第/ 1/ 个/ Map/ 任务/ ;/ 步/ 3/ ./ 第/ 1/ 个/ Map/ 任务/ 用点/ (/ 2/ ,/ 5/ )/ 过滤/ 其/ Skyline/ 查询/ 结果/ ,/ 过滤/ 后/ 结果/ 仍为/ 点/ (/ 1/ ,/ 9/ )/ 和/ (/ 2/ ,/ 5/ )/ ,/ 则/ 将/ 点/ (/ 1/ ,/ 9/ )/ 和/ (/ 2/ ,/ 5/ )/ 作为/ 其/ 最终/ 的/ Skyline/ 查询/ 结果/ 发送给/ Reduce/ 任务/ ;/ 步/ 4/ ./ 如果/ 第/ 2/ 个/ Map/ 任务/ 运行/ 结束/ ,/ 将/ 其/ 局部/ 过滤/ 值点/ (/ 6/ ,/ 8/ )/ 发送给/ Master/ 节点/ ;/ 步/ 5/ ./ Master/ 节点/ 在/ 接收/ 到/ 点/ (/ 6/ ,/ 8/ )/ 之后/ ,/ 将点/ (/ 6/ ,/ 8/ )/ 与/ 当前/ 全局/ 过滤/ 值点/ (/ 2/ ,/ 5/ )/ 做/ 比较/ ,/ 得到/ 最优/ 值点/ (/ 2/ ,/ 5/ )/ ,/ 将点/ (/ 2/ ,/ 5/ )/ 作为/ 当前/ 最新/ 的/ 全局/ 过滤/ 值/ ;/ 步/ 6/ ./ 第/ 2/ 个/ Map/ 任务/ 在/ 接收/ 到/ 全局/ 过滤/ 值点/ (/ 2/ ,/ 5/ )/ 之后/ ,/ 用/ 其/ 对/ 自身/ Skyline/ 查询/ 结果/ 进行/ 过滤/ ,/ 点/ (/ 2/ ,/ 5/ )/ 能/ “/ 支配/ ”/ 其/ 所有/ 结果/ 点/ ,/ 即/ 第/ 2/ 个/ Map/ 任务/ 最终/ 的/ 输出/ 结果/ 为空/ ,/ 故图/ 6/ 中/ 并未/ 画出/ ./ 这样/ 的/ 过程/ 一直/ 继续/ 直到/ 第/ 5/ 个/ Map/ 任务/ 结束/ ,/ 求得/ 最终/ Skyline/ 查询/ 结果/ ./ Skyline/ 算法/ 的/ 60/ %/ ,/ 并且/ 不/ 需要/ 等待/ 系统/ 中/ 所有/ Map/ 任务/ 都/ 结束/ 才能/ 产生/ 全局/ 过滤/ 值/ ,/ 但是/ 每当/ 有/ Page7/ 一个/ Map/ 任务/ 完成/ ,/ 就要/ 向/ Master/ 节点/ 发送/ 局部/ 过滤/ 值/ ,/ 导致/ 当前/ 全局/ 过滤/ 值/ 不/ 一定/ 是/ 最优/ 全局/ 过滤/ 值/ ,/ 所以/ 本文/ 又/ 提出/ 了/ 混合/ Skyline/ 查询/ 算法/ 来/ 优化/ 延迟/ Skyline/ 和/ 贪婪/ Skyline/ 查询/ 算法/ ./ 3.4/ 混合/ Skyline/ 查询/ 算法/ 混合/ Skyline/ 查询/ 算法/ 的/ 基本原理/ 是/ :/ 当/ 系统/ 中/ 的/ 一个/ Map/ 任务/ 运行/ 结束/ 后/ 立即/ 将/ 其/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ ,/ 然而/ ,/ Master/ 节点/ 并/ 不/ 立刻/ 产生/ 全局/ 过滤/ 值/ 发送给/ 该/ Map/ 任务/ ,/ 而是/ 在/ 一个/ 预先/ 定义/ 的/ 时间/ 间隔/ 内/ 等待/ 其它/ Map/ 任务/ 的/ 完成/ ,/ Master/ 节点/ 收集/ 到/ 这/ 段时间/ 间隔/ 内/ 所有/ 完成/ 的/ Map/ 任务/ 的/ 局部/ 过滤/ 值/ ,/ 从中/ 选择/ 最优/ 值/ 作为/ 全局/ 过滤/ 值/ ,/ 并/ 发送给/ 这些/ Map/ 任务/ ./ Map/ 任务/ 在/ 接收/ 到/ 全局/ 过滤/ 值/ 之后/ ,/ 用/ 其/ 过滤/ 自身/ 的/ Skyline/ 查询/ 结果/ ,/ 并/ 生成/ 最终/ 的/ 局部/ Skyline/ 查询/ 结果/ ./ 同样/ ,/ 在/ 下/ 一个/ 时间/ 间隔/ 内/ ,/ Master/ 节点/ 仍然/ 等待/ 在/ 这个/ 时间/ 间隔/ 内/ 完成/ 的/ 所有/ Map/ 任务/ 的/ 局部/ 过滤/ 值/ ,/ 从中/ 选择/ 最优/ 值/ 作为/ 全局/ 过滤/ 值/ ,/ 并/ 与/ 原有/ 的/ 全局/ 过滤/ 值/ 比较/ ,/ 再/ 从中/ 选择/ 最优/ 值/ 作为/ 新/ 的/ 全局/ 过滤/ 值/ ./ 这样/ 的/ 过程/ 一直/ 继续/ 直到/ 所有/ 的/ Map/ 任务/ 结束/ 为止/ ./ 当/ 系统/ 中/ 最后/ 一个/ Map/ 任务/ 结束/ 后/ ,/ 它/ 将/ 其/ 局部/ 过滤/ 值/ 发送给/ Master/ 节点/ ,/ 会/ 立即/ 获得/ 一个/ 全局/ 过滤/ 值/ ./ 图/ 7/ 仍然/ 以/ 相同/ 的/ Skyline/ 查询/ 为例/ ,/ 说明/ 混合/ Skyline/ 查询/ 算法/ 的/ 过程/ ./ 原有/ 数据/ 集/ 同样/ 被/ 划分/ 成/ 5/ 个/ 分片/ ,/ 分别/ 由/ 5/ 个/ Map/ 任务/ 执行/ ,/ 为了/ 描述/ 方便/ ,/ 在/ 混合/ Skyline/ 算法/ 中/ ,/ 本文/ 设定/ 每个/ 时间/ 图/ 7/ 混合/ Skyline/ 算法/ 间隔/ 内/ 共有/ 2/ 个/ Map/ 任务/ 完成/ ,/ 本文/ 用/ 6/ 个/ 步骤/ 说明/ 前/ 2/ 个/ 时间/ 间隔/ 内/ Map/ 任务/ 的/ 执行/ 情况/ ./ 步/ 1/ ./ 当/ 第/ 1/ 个/ Map/ 任务/ 完成/ 后/ ,/ 将/ 其/ 局部/ 过滤/ 值点/ (/ 2/ ,/ 5/ )/ 发送给/ Master/ 节点/ ,/ Master/ 节点/ 在/ 接收/ 到/ 点/ (/ 2/ ,/ 5/ )/ 后/ ,/ 并/ 不/ 立即/ 产生/ 全局/ 过滤/ 值/ ,/ 而是/ 等待/ 其它/ Map/ 任务/ 的/ 完成/ ./ 在/ 这个/ 时间/ 间隔/ 内/ ,/ 第/ 2/ 个/ Map/ 任务/ 完成/ 后/ 将/ 其/ 局部/ 过滤/ 值点/ (/ 6/ ,/ 8/ )/ 发送给/ Master/ 节点/ ;/ 步/ 2/ ./ Master/ 节点/ 比较/ 点/ (/ 2/ ,/ 5/ )/ 和/ 点/ (/ 6/ ,/ 8/ )/ ,/ 从中/ 选择/ 最优/ 值点/ (/ 2/ ,/ 5/ )/ 作为/ 当前/ 的/ 全局/ 过滤/ 值/ ,/ 并/ 发送给/ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ ;/ 步/ 3/ ./ 第/ 1/ 个/ Map/ 任务/ 的/ Skyline/ 查询/ 结果/ 不能/ 被点/ (/ 2/ ,/ 5/ )/ “/ 支配/ ”/ ,/ 故其/ 最终/ 的/ Skyline/ 查询/ 结果/ 为点/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 5/ )/ ./ 而/ 第/ 2/ 个/ Map/ 任务/ 的/ 3/ 个/ Skyline/ 查询/ 结果/ 都/ 能/ 被/ 点/ (/ 2/ ,/ 5/ )/ “/ 支配/ ”/ ,/ 所以/ 第/ 2/ 个/ Map/ 任务/ 的/ 输出/ 结果/ 为空/ ;/ 步/ 4/ ./ 在/ 下/ 一个/ 时间/ 间隔/ 内/ ,/ 第/ 3/ 个/ Map/ 任务/ 完成/ 后/ 将/ 其/ 局部/ 过滤/ 值点/ (/ 3/ ,/ 3/ )/ 发送给/ Master/ 节点/ ,/ 同样/ ,/ Master/ 节点/ 也/ 不/ 立即/ 产生/ 新/ 的/ 全局/ 过滤/ 值/ ,/ 而是/ 等待/ 其它/ Map/ 任务/ 的/ 完成/ ,/ 当/ 第/ 4/ 个/ Map/ 任务/ 完成/ 后/ ,/ 将/ 其/ 局部/ 过滤/ 值点/ (/ 5/ ,/ 5/ )/ 发送给/ Master/ 节点/ ;/ 步/ 5/ ./ Master/ 节点/ 从点/ (/ 3/ ,/ 3/ )/ 和/ 点/ (/ 5/ ,/ 5/ )/ 中/ 选择/ 点/ (/ 3/ ,/ 3/ )/ 作为/ 临时/ 全局/ 过滤/ 值/ ,/ 并/ 将/ 其/ 与/ 原有/ 的/ 全局/ 过滤/ 值点/ (/ 2/ ,/ 5/ )/ 比较/ ,/ 从中/ 选择/ 最优/ 值点/ (/ 3/ ,/ 3/ )/ 作为/ 新/ 的/ 全局/ 过滤/ 值/ ,/ 并/ 发送给/ 这些/ Map/ 任务/ ;/ 步/ 6/ ./ 在/ 接收/ 到/ 全局/ 过滤/ 值点/ (/ 3/ ,/ 3/ )/ 后/ ,/ 第/ 3/ 、/ 4/ 个/ Map/ 任务/ 用/ 其/ 对/ 自身/ 结果/ 进行/ 过滤/ ,/ 发现/ 点/ (/ 3/ ,/ 3/ )/ 可以/ “/ 支配/ ”/ 点/ (/ 5/ ,/ 5/ )/ ,/ 故/ 第/ 4/ 个/ Map/ 任务/ 最终/ 的/ Skyline/ 结果/ 为点/ (/ 7/ ,/ 2/ )/ ./ 整个/ 过程/ 一直/ 继续/ 直到/ 所有/ Map/ 任务/ 都/ 结束/ ./ Page8/ 混合/ Skyline/ 查询/ 算法/ 有效/ 地/ 继承/ 了/ 延迟/ Sky/ -/ line/ 查询/ 算法/ 和/ 贪婪/ Skyline/ 查询/ 算法/ 的/ 优点/ ,/ 与/ 基本/ Skyline/ 算法/ 相比/ ,/ Map/ 任务/ 的/ 输出/ 同样/ 能够/ 降低/ 40/ %/ ./ 混合/ Skyline/ 算法/ 既/ 不用/ 等待/ 系统/ 所有/ Map/ 任务/ 完成/ 才能/ 产生/ 全局/ 过滤/ 值/ ,/ 也/ 不用/ 每次/ 在/ Map/ 任务/ 完成/ 后/ 都/ 与/ Master/ 节点/ 进行/ 通信/ ,/ 在/ 减少/ Reduce/ 任务/ 输入/ 的/ 同时/ 提高/ 了/ 算法/ 的/ 效率/ ,/ 降低/ 了/ 算法/ 的/ 开销/ ./ 4Skyline/ 查询处理/ 优化/ 算法/ 在/ 实际/ 应用/ 中/ ,/ Map/ 任务/ 的/ 数量/ 远比/ 虚拟/ 节点/ 的/ 数量/ 多/ 很多/ ,/ 甚至/ 能/ 达到/ 几百倍/ ,/ 尽管/ 本文/ 提出/ 了/ 上述/ 3/ 个/ Skyline/ 查询/ 算法/ ,/ 但/ 对于/ 海量/ 数据/ 的/ Skyline/ 查询处理/ 的/ 性能/ 仍/ 需/ 进一步提高/ ./ 如果/ 能/ 让/ Map/ 任务/ 在/ 运行/ 之前/ 可以/ 预先/ 过滤/ 掉/ 一些/ 不是/ 最终/ 结果/ 的/ 数据/ ,/ 那么/ Map/ 任务/ 的/ 输入/ 数据量/ 也/ 会/ 大大减少/ ,/ 这样/ 会/ 进一步提高/ Skyline/ 查询/ 算法/ 的/ 效率/ ./ 因此/ ,/ 本文/ 提出/ 了/ 一个/ Skyline/ 查询/ 优化/ 算法/ ,/ 称为/ 前置/ Skyline/ 查询/ 算法/ ,/ 能够/ 更/ 有效/ 地/ 处理/ Map/ -/ Reduce/ 框架/ 下/ 的/ 海量/ 数据/ Skyline/ 查询/ ./ 前置/ Skyline/ 查询/ 算法/ 的/ 基本原理/ 是/ :/ 在/ 一部分/ Map/ 任务/ 完成/ 后/ ,/ Master/ 节点/ 可以/ 运用/ 上述/ 任何/ 一种/ Skyline/ 查询/ 算法/ 产生/ 一个/ 当前/ 的/ 全局/ 过滤/ 图/ 8/ 前置/ Skyline/ 算法/ 值/ ,/ 其余/ 没有/ 运行/ 的/ Map/ 任务/ 可以/ 在/ 其/ 初始化/ 阶段/ 从/ Master/ 节点/ 获取/ 一个/ 全局/ 过滤/ 值/ 对/ 自身/ 的/ 数据/ 进行/ 过滤/ ,/ 过滤/ 掉/ 一部分/ 不能/ 成为/ Skyline/ 查询/ 结果/ 的/ 数据/ ,/ 并/ 将/ 过滤/ 后/ 的/ 数据/ 作为/ 输入/ ,/ 这样/ 可以/ 大大减少/ Map/ 任务/ 的/ 输入量/ ./ 当/ 系统/ 中/ 的/ Map/ 任务/ 数量/ 很多/ 的/ 时候/ ,/ 前置/ Skyline/ 查询/ 算法/ 可以/ 看作/ 是/ 对/ 贪婪/ Skyline/ 查询/ 算法/ 和/ 混合/ Skyline/ 查询/ 算法/ 的/ 优化/ ,/ 能够/ 更/ 有效/ 地/ 提高/ Skyline/ 查询/ 的/ 效率/ ./ 图/ 8/ 仍以/ 前述/ 的/ Skyline/ 查询/ 为例/ ,/ 说明/ 前置/ Skyline/ 查询/ 算法/ 的/ 基本/ 过程/ ./ 原始数据/ 集/ 同样/ 被/ 分成/ 5/ 个/ 分片/ ,/ 由/ 5/ 个/ Map/ 任务/ 完成/ ,/ 本文/ 用/ 5/ 个/ 步骤/ 对/ 前置/ Skyline/ 算法/ 进行/ 简要/ 说明/ ./ 步/ 1/ ./ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ 完成/ 后/ ,/ 分别/ 得到/ 其/ 局部/ 过滤/ 值/ ,/ 其中/ 第/ 1/ 个/ Map/ 任务/ 的/ Skyline/ 结果/ 为点/ (/ 3/ ,/ 3/ )/ 和/ (/ 4/ ,/ 2/ )/ ,/ 局部/ 过滤/ 值为/ 点/ (/ 3/ ,/ 3/ )/ ,/ 第/ 2/ 个/ Map/ 任务/ 的/ Skyline/ 结果/ 为点/ (/ 5/ ,/ 5/ )/ 和/ (/ 7/ ,/ 2/ )/ ,/ 局部/ 过滤/ 值为/ 点/ (/ 5/ ,/ 5/ )/ ,/ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ 将点/ (/ 3/ ,/ 3/ )/ 和/ (/ 5/ ,/ 5/ )/ 发送给/ Master/ 节点/ ;/ 步/ 2/ ./ Master/ 节点/ 在/ 接收/ 到/ 点/ (/ 3/ ,/ 3/ )/ 和/ 点/ (/ 5/ ,/ 5/ )/ 后/ ,/ 选择/ 点/ (/ 3/ ,/ 3/ )/ 作为/ 全局/ 过滤/ 值/ 并/ 发送给/ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ ;/ 步/ 3/ ./ 第/ 1/ 和/ 第/ 2/ 个/ Map/ 任务/ 将/ 运用/ 全局/ 过滤/ 值点/ (/ 3/ ,/ 3/ )/ 过滤/ 后/ 的/ Skyline/ 查询/ 结果/ 发送给/ Reduce/ 任务/ ;/ 步/ 4/ ./ 第/ 3/ 到/ 5/ 个/ Map/ 任务/ 在/ 启动/ 之前/ ,/ 初始化/ 阶段/ 均/ 从/ Master/ 节点/ 获取/ 当前/ 全局/ 过滤/ 值/ 即点/ (/ 3/ ,/ 3/ )/ 来/ 过滤/ 自身/ 原始数据/ 集/ ,/ 其中/ 点/ (/ 3/ ,/ 3/ )/ 可以/ “/ 支配/ ”/ 第/ 3/ 个/ Map/ 任务/ 的/ 所有/ 原始数据/ ,/ 说明/ 这些/ 原始数据/ 一定/ 不是/ 最终/ Skyline/ 查询/ Page9/ 结果/ ,/ 第/ 3/ 个/ Map/ 任务/ 的/ 输入/ 数据/ 集/ 为/ 空集/ ,/ 即/ 不会/ 产生/ 任何/ 输出/ ./ 对于/ 第/ 4/ 个/ Map/ 任务/ ,/ 点/ (/ 3/ ,/ 3/ )/ 可以/ “/ 支配/ ”/ 其点/ (/ 4/ ,/ 10/ )/ ,/ (/ 4/ ,/ 9/ )/ ,/ (/ 3/ ,/ 8/ )/ ,/ (/ 5/ ,/ 8/ )/ ,/ (/ 4/ ,/ 7/ )/ ,/ 而/ 不能/ “/ 支配/ ”/ 其点/ (/ 2/ ,/ 10/ )/ ,/ (/ 1/ ,/ 9/ )/ ,/ (/ 2/ ,/ 9/ )/ ,/ (/ 2/ ,/ 7/ )/ 和/ (/ 2/ ,/ 5/ )/ ,/ 即用/ 下划线/ 表示/ 的/ 点/ ,/ 则/ 第/ 4/ 个/ Map/ 任务/ 的/ 输入/ 经过/ 过滤/ 后/ 由/ 10/ 个点/ 减少/ 到/ 5/ 个点/ ./ 同理/ ,/ 第/ 5/ 个/ Map/ 任务/ 的/ 输入/ 经过/ 过滤/ 后/ 降低/ 到/ 3/ 个点/ ,/ 点/ (/ 9/ ,/ 2/ )/ ,/ (/ 5/ ,/ 1/ )/ 和/ (/ 9/ ,/ 1/ )/ ;/ 步/ 5/ ./ 后续/ Map/ 任务/ 将/ 自身/ 的/ Skyline/ 查询/ 结果/ 发送给/ 由此可见/ ,/ 前置/ Skyline/ 算法/ 能够/ 降低/ Map/ 任/ Reduce/ 任务/ ,/ 得到/ 最终/ Skyline/ 查询/ 结果/ ./ 务/ 的/ 输入量/ ,/ 更/ 有效/ 地/ 提高/ 了/ 算法/ 的/ 效率/ ./ 5/ 实验/ 评估/ 5.1/ 实验/ 环境/ 本文/ 的/ 实验/ 环境/ 由/ 9/ 台用/ 高速/ 千兆/ 网络连接/ 的/ PC机/ 组成/ ,/ 每个/ PC机/ 的/ 配置/ 为/ QuadCore2/ ./ 66GHZCPU/ ,/ 4GB/ 内存/ ,/ 操作系统/ 为/ CentOSLinux5/ ./ 6/ ./ 其中/ 一台/ PC机/ 作为/ Master/ 节点/ ,/ 其它/ 8/ 台/ PC机/ 作为/ Slave/ 节点/ ./ 本文/ 采用/ 的/ Hadoop/ 平台/ 版本/ 为/ 0.20/ ./ 2/ ,/ 代码/ 编译/ 采用/ JDK1/ ./ 6/ ./ 实验/ 所用/ 数据/ 集/ 为/ 合成/ 数据/ 集/ ,/ 利用/ 文献/ [/ 1/ ]/ 中/ 标准/ 的/ 数据/ 生成/ 工具/ 生成/ ./ 实验/ 数据/ 集/ 的/ 记录/ 条数/ 为/ 2/ ×/ 105/ 条到/ 10/ ×/ 105/ 条/ ,/ 默认/ 维度/ 是/ 4/ ,/ 节点/ 数为/ 8/ ./ 通常/ 情况/ 下/ 测试/ Skyline/ 查询/ 性能/ 在/ 3/ 种/ 分布/ 下/ 测试/ ,/ 分别/ 是/ 独立/ 分布/ 、/ 相关/ 分布/ 和/ 反/ 相关/ 分布/ ./ 独立/ 分布/ 即/ 数据/ 的/ 各个/ 维度/ 之间/ 互相/ 独立/ 且/ 同/ 分布/ ,/ 相关/ 分布/ 是/ 指/ 数据/ 在/ 某/ 一维/ 的/ 数值/ 越大/ 在/ 其它/ 维度/ 上/ 数值/ 也/ 越/ 大/ ,/ 反/ 相关/ 分布/ 是/ 指/ 数据/ 在/ 某/ 一维/ 上/ 的/ 值/ 越/ 大/ 在/ 其它/ 维度/ 上/ 的/ 值/ 却/ 越/ 小/ ./ 由于/ 数据/ 在/ 独立/ 分布/ 和/ 相关/ 分布/ 下/ ,/ Skyline/ 查询/ 的/ 性能/ 相似/ ,/ 故/ 本文/ 并未/ 对/ 数据/ 在/ 相关/ 分布/ 下/ 的/ 性能/ 进行/ 测试/ ,/ 只/ 选择/ 了/ 独立/ 分布/ 和/ 反/ 相关/ 分布/ 条件/ 下/ 测试/ Skyline/ 查询/ 算法/ 的/ 性能/ ./ 本文/ 所/ 采用/ 的/ 性能/ 测试/ 指标/ 主要/ 有/ 两个/ :/ Sky/ -/ line/ 查询/ 算法/ 的/ 运行/ 时间/ 和/ 查询/ 记录/ 数/ ./ 实验/ 中/ ,/ 本文/ 将/ 所/ 提出/ 的/ Skyline/ 查询/ 算法/ ,/ 即/ 贪婪/ Skyline/ 查询/ 算法/ (/ EagerSkylineQueryAlgorithm/ ,/ ES/ )/ 、/ 混合/ Skyline/ 查询/ 算法/ (/ HybridSkylineQueryAlgo/ -/ rithm/ ,/ HS/ )/ 和/ 前置/ Skyline/ 查询/ 算法/ (/ PrepositiveSkylineQueryAlgorithm/ ,/ PS/ )/ ,/ 与/ 文献/ [/ 13/ -/ 14/ ]/ 的/ 基于/ Map/ -/ Reduce/ 框架/ 的/ 块/ 嵌套循环/ 算法/ (/ MR/ -/ BNL/ )/ 进行/ 比较/ ./ 由于/ 延迟/ Skyline/ 查询/ 算法/ 需要/ 等待/ 所有/ 的/ Map/ 任务/ 运行/ 结束/ 才能/ 产生/ 全局/ 过滤/ 值/ ,/ 这种/ 方法/ 在/ 实际/ 应用/ 中是/ 不/ 可行/ 的/ ,/ 故/ 本文/ 并未/ 对/ 延迟/ Skyline/ 查询/ 算法/ 进行/ 测试/ ./ 本文/ 将/ 在/ Map/ -/ Reduce/ 框架/ 下/ Reduce/ 任务/ 的/ 输入/ 记录/ 条数/ 简写/ 成/ (/ Re/ -/ duceInput/ ,/ RI/ )/ ,/ 则/ BNL/ 算法/ 的/ Reduce/ 任务/ 的/ 输入/ 记录/ 数/ 简写/ 成/ (/ RI/ -/ BNL/ )/ ,/ 贪婪/ Skyline/ 查询/ 算法/ 的/ Reduce/ 任务/ 输入/ 记录/ 数/ 简写/ 成/ (/ RI/ -/ ES/ )/ ,/ 混合/ Skyline/ 查询/ 算法/ 的/ Reduce/ 任务/ 输入/ 记录/ 数/ 简写/ 成/ (/ RI/ -/ HS/ )/ ,/ 前置/ Skyline/ 查询/ 算法/ 的/ Reduce/ 任务/ 输入/ 记录/ 数/ 简写/ 成/ (/ RI/ -/ PS/ )/ ./ 5.2/ 实验/ 结果/ 与/ 分析/ 5.2/ ./ 1Skyline/ 查询/ 性能/ 随/ 数据/ 维度/ 变化/ 情况/ 图/ 9/ 和/ 图/ 10/ 表示/ Skyline/ 查询/ 性能/ 随/ 数据/ 维度/ 变化/ 的/ 情况/ ./ 图/ 9/ 所示/ 为/ Skyline/ 查询/ 算法/ 运行/ 时间/ 的/ 测试/ 结果/ ,/ 图/ 10/ 所示/ 为/ Skyline/ 查询/ 算法/ Re/ -/ duce/ 任务/ 输入/ 记录/ 数/ 的/ 测试/ 结果/ ./ 其中/ 图/ 9/ (/ a/ )/ 和/ 10/ (/ a/ )/ 表示/ 数据/ 服从/ 独立/ 分布/ ,/ 图/ 9/ (/ b/ )/ 和/ 10/ (/ b/ )/ 表示/ 数据/ 服从/ 反/ 相关/ 分布/ ./ 从图/ 9/ 可以/ 看出/ ,/ 4/ 个/ Skyline/ 算法/ 的/ 时间/ 相差/ 不/ 大/ ,/ 但/ BNL/ 算法/ 的/ 时间/ 仍/ 高于/ 本文/ 的/ 3/ 个/ 算法/ ,/ 原因/ 是/ 本文/ 的/ 实验/ 环境/ 是/ 在/ 一个/ 千兆/ 网络/ 环境/ 下/ 进行/ 的/ 测试/ ,/ 网络/ 的/ 传输/ 时间/ 很小/ ,/ 故/ 时间/ 性能/ 的/ 效果/ 并/ 不/ 明显/ ./ 反/ 相关/ 分布/ 的/ Skyline/ 查询/ 算法/ 的/ 时间/ 在/ 数据/ 达到/ 5/ 维时/ 时间/ 明显增加/ ,/ 原因/ 是/ 反/ 相关/ 分布/ 的/ Skyline/ 查询/ 结果/ 比/ 独立/ 分布/ 多/ ,/ 计算/ 量/ 增大/ ,/ 导致/ 时间/ 增加/ ./ 在/ 图/ 10/ 中/ 两种/ 分布/ Page10/ 下/ BNL/ 算法/ 的/ Reduce/ 任务/ 输入/ 记录/ 数均/ 高于/ 本文/ 的/ ES/ 、/ HS/ 和/ PS/ 算法/ ,/ 表明/ 本文/ 所/ 提出/ 的/ Skyline/ 查询/ 算法/ 可以/ 减少/ Reduce/ 任务/ 输入/ 记录/ 数/ ,/ 即/ 算法/ 具有/ 高效/ 的/ 过滤/ 能力/ ,/ 可以/ 提高/ Skyline/ 算法/ 的/ 效率/ ./ 图/ 10Skyline/ 查询/ 算法/ Reduce/ 任务/ 输入/ 记录/ 数/ 5.2/ ./ 2Skyline/ 查询/ 性能/ 随/ 数据量/ 变化/ 情况/ 图/ 11/ 和/ 图/ 12/ 表示/ Skyline/ 算法/ 性能/ 随/ 数据量/ 变化/ 的/ 情况/ ,/ 可以/ 看出/ 随着/ 数据量/ 增大/ ,/ Skyline/ 查询/ 时间/ 增加/ ,/ 原因/ 是/ 随着/ 数据量/ 增大/ ,/ 每个/ Map/ 任务/ 所/ 处理/ 的/ 数据量/ 也/ 增大/ ,/ 使得/ 算法/ 的/ 开销/ 增大/ ,/ 本文/ 的/ 数据量/ 从/ 2/ ×/ 105/ 条到/ 10/ ×/ 105/ 条/ ,/ 能够/ 说明/ 算法/ 对于/ 海量/ 数据处理/ 的/ 性能/ ./ 从图/ 11/ 可以/ 得出/ ,/ 在/ 两种/ 分布/ 下/ ,/ BNL/ 算法/ 的/ 运行/ 时间/ 高于/ 本文/ 的/ 3/ 个/ Skyline/ 算法/ ,/ 而/ PS/ 算法/ 的/ 性能/ 最优/ ,/ 原因/ 是/ PS/ 算法/ 在/ Map/ 任务/ 运行/ 前/ 过滤/ 掉/ 部分/ 不能/ 成为/ Skyline/ 查询/ 结果/ 的/ 数据/ ,/ 使得/ Map/ 任务/ 的/ 输入量/ 减少/ ,/ 故/ 运行/ 时间/ 最短/ ,/ 同样/ 从图/ 12/ 所示/ 的/ Reduce/ 任务/ 输入/ 记录/ 数/ 也/ 能/ 得到/ 类似/ 的/ 结果/ ./ 5.2/ ./ 3Skyline/ 查询/ 性能/ 随/ 节点/ 数量/ 变化/ 情况/ 图/ 13/ 和/ 图/ 14/ 表示/ Skyline/ 查询/ 算法/ 性能/ 随/ 节点/ 数/ 变化/ 的/ 情况/ ./ 从图/ 13/ 中/ 可以/ 看出/ ,/ 随着/ 节点/ 数量/ 的/ 增加/ ,/ Skyline/ 查询/ 时间/ 呈/ 下降/ 趋势/ ,/ 原因/ 是/ 伴随/ 节点/ 数量/ 增加/ ,/ 系统/ 的/ 并行性/ 和/ 处理/ 能力/ 均/ 增强/ ,/ 图/ 12Skyline/ 查询/ 算法/ Reduce/ 任务/ 输入/ 记录/ 数故/ 其/ 时间/ 也/ 越来越/ 短/ ,/ 而/ 独立/ 分布/ 的/ 运行/ 时间/ 小于/ 反/ 相关/ 分布/ ./ 从图/ 14/ 中/ 可以/ 看出/ ,/ 在/ 数据量/ 一定/ 的/ 情况/ 下/ ,/ BNL/ 算法/ 的/ Reduce/ 任务/ 的/ 输入/ 记录/ 数/ 保持/ Page11/ 图/ 14Skyline/ 查询/ 算法/ Reduce/ 任务/ 输入/ 记录/ 数/ 不变/ ,/ 原因/ 是/ BNL/ 算法/ 并未/ 采用/ 过滤/ 机制/ ,/ 故其/ Reduce/ 任务/ 的/ 输入/ 记录/ 数/ 保持/ 不变/ ./ 而/ 本文/ 所/ 提出/ 的/ Skyline/ 查询/ 算法/ 无论是/ 在/ 独立/ 分布/ 还是/ 在/ 反/ 相关/ 分布/ 下/ Reduce/ 任务/ 输入/ 记录/ 数均/ 大幅度/ 少于/ BNL/ 算法/ ,/ 表明/ 本文/ 算法/ 具有/ 很/ 好/ 的/ 过滤/ 能力/ ,/ 有效/ 地/ 提高/ 了/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ Skyline/ 查询/ 的/ 性能/ ./ 6/ 结论/ 本文/ 针对/ 在/ 云/ 计算/ 的/ Map/ -/ Reduce/ 框架/ 下/ 如何/ 实现/ 海量/ 数据/ Skyline/ 查询/ 问题/ 进行/ 了/ 深入/ 的/ 研究/ ./ 首先/ ,/ 本文/ 分析/ 了/ 基本/ Skyline/ 查询/ 算法/ ,/ 即/ 在/ Map/ -/ Reduce/ 框架/ 下/ 实现/ Skyline/ 查询/ ,/ 其次/ ,/ 针对/ 海量/ 数据/ Skyline/ 查询/ 的/ 最终/ 结果/ 的/ 数量/ 远/ 小于/ 原始数据/ 集/ 的/ 数据量/ 的/ 问题/ ,/ 本文/ 提出/ 了/ 3/ 个/ Skyline/ 查询/ 算法/ ,/ 分别/ 是/ 延迟/ Skyline/ 查询/ 算法/ 、/ 贪婪/ Sky/ -/ line/ 查询/ 算法/ 和/ 混合/ Skyline/ 查询/ 算法/ ,/ 有效/ 地/ 过滤/ 部分/ 不能/ 成为/ 最终/ 查询/ 结果/ 的/ 数据/ 对象/ ,/ 并/ 详细/ 地/ 分析/ 每个/ 算法/ 的/ 原理/ 和/ 特点/ ./ 为了/ 进一步提高/ 在/ Map/ -/ Reduce/ 框架/ 下/ 处理/ 海量/ 数据/ Skyline/ 查询/ 的/ 性能/ ,/ 本文/ 针对/ 上述/ 算法/ 又/ 提出/ 了/ 一个/ 优化/ 算法/ ,/ 称为/ 前置/ Skyline/ 查询/ 算法/ ,/ 前置/ Skyline/ 查询/ 算法/ 更/ 适用/ 于/ 处理/ 海量/ 数据处理/ Skyline/ 查询/ ./ 最后/ ,/ 本文/ 通过/ 大量/ 合成/ 数据/ 对/ 所/ 提出/ 的/ Skyline/ 查询/ 算法/ 进行/ 了/ 测试/ 和/ 评估/ ./ 实验/ 结果表明/ ,/ 本文/ 所/ 提出/ 的/ 算法/ 有效/ 地/ 节约/ 了/ Skyline/ 查询/ 的/ 时间/ ,/ 提高/ 了/ Skyline/ 查询/ 的/ 效率/ ,/ 算法/ 具有/ 良好/ 的/ 可扩展性/ 、/ 准确性/ 和/ 可用性/ ./ 

