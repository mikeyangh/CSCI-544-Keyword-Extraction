Page1V/ -/ Mesh/ :/ 面向/ 三维/ 堆叠/ 芯片/ 的/ 低/ 时延/ 低功耗/ 片上/ 网络结构/ 谭海/ 1/ )/ ,/ 2/ )/ 何月/ 顺/ 2/ )/ 靳文兵/ 3/ )/ 苏岩/ 1/ )/ 1/ )/ (/ 北京理工大学/ 计算机/ 学院/ 北京/ 100081/ )/ 2/ )/ (/ 东华/ 理工大学/ 信息/ 工程学院/ 南昌/ 330013/ )/ 3/ )/ (/ 北方/ 自动/ 控制技术/ 研究所/ 太原/ 030006/ )/ 摘要/ 针对/ 片上/ 网络/ 直径/ 大/ 、/ 功耗/ 高/ 、/ 可扩展性/ 差/ 以及/ 物理/ 实现/ 复杂/ 的/ 问题/ ,/ 提出/ 了/ 一个/ 低/ 直径/ 、/ 且/ 直径/ 为/ 常数/ 的/ 三维/ 片上/ 网络/ V/ -/ Mesh/ ,/ 并/ 为/ 该/ 网络结构/ 提供/ 了/ VM/ 路由/ 算法/ ./ V/ -/ Mesh/ 结构/ 由/ 一层/ 2DMesh/ 子网/ 和/ 多层/ 行/ // 列/ 互连/ 子网/ 通过/ 三维/ 堆叠/ 技术/ 互连/ 而成/ ,/ 具有/ 功耗/ 低/ 的/ 特点/ ,/ 能/ 支持/ 任意/ 多/ 的/ 节点/ 数/ ,/ 可/ 用于/ 三维/ 堆叠/ 芯片/ 中/ 的/ 节点/ 间/ 互连/ ./ 相对/ 于/ 一种/ 全/ 互连/ 3D/ 片上/ 网络/ F/ -/ Mesh/ 来说/ ,/ V/ -/ Mesh/ 结构/ 采用/ 行/ // 列/ 互连/ 技术/ 大大减少/ 了/ 其长/ 互连/ 线条/ 数/ ,/ 从而/ 减少/ 了/ 功耗/ 和/ 布线/ 复杂度/ ,/ 可扩展性/ 强/ ./ 理论/ 分析/ 和/ 实验/ 结果表明/ ,/ 和/ F/ -/ Mesh/ 结构/ 相比/ ,/ V/ -/ Mesh/ 结构/ 的/ 时延/ 与其/ 相当/ ,/ 但/ 能够/ 减少/ 约/ 12.5/ %/ 的/ 功耗/ 开销/ ./ 和/ 3DMesh/ 相比/ ,/ 在/ 节点/ 数较/ 多/ 的/ 情况/ 下/ ,/ 其时/ 延能/ 降低/ 23/ %/ ,/ 吞吐量/ 能/ 提高/ 12/ %/ ,/ 功耗/ 能/ 降低/ 34/ %/ ./ 总的来说/ ,/ V/ -/ Mesh/ 和/ 3DMesh/ 相比/ 各/ 方面/ 具有/ 明显/ 优势/ ;/ 和/ F/ -/ Mesh/ 的/ 互连/ 性能/ 相当/ ,/ 但/ 其/ 物理/ 实现/ 更为/ 简单/ ,/ 布线/ 量/ 小/ ,/ 可扩展性/ 更好/ ./ 关键词/ 众核/ ;/ 三维/ 堆叠/ ;/ 低/ 时延/ ;/ 低功耗/ ;/ 片上/ 网络/ 1/ 引言/ 随着/ 摩尔定律/ 的/ 持续/ 发展/ ,/ 芯片/ 内/ 的/ 晶体管/ 数量/ 将/ 达到/ 海量/ ,/ 它们/ 按/ 一定/ 规模/ 分组/ 后/ 形成/ 并行计算/ 单元/ ./ 这些/ 并行计算/ 单元/ 之间/ 通过/ 片上/ 网络/ 高速/ 互连/ [/ 1/ -/ 2/ ]/ ,/ 以片/ 内/ 多/ 处理/ 核/ 的/ 形式/ 提供/ 高性能/ 计算/ ,/ 是/ 当前/ 处理器/ 体系结构/ 的/ 发展趋势/ [/ 2/ -/ 3/ ]/ ./ 计算机/ 已经/ 步入/ 了/ 多/ 核/ 时代/ ,/ 并且/ 将/ 马上/ 迎来/ 众核/ 时代/ ./ 在/ 众核/ 时代/ ,/ 片内/ 处理/ 核/ 数目/ 将/ 达/ 上千/ 、/ 甚至/ 更/ 多/ ./ 众多/ 的/ 节点/ 数对片/ 上/ 网络/ 的/ 高速/ 互连/ 提出/ 了/ 很/ 高/ 的/ 要求/ ./ 片上/ 网络/ 的/ 直径/ 和/ 功耗/ 对众/ 核/ 的/ 性能/ 有/ 很大/ 的/ 影响/ ,/ 低/ 直径/ 和/ 低功耗/ 的/ 片/ 上/ 网络/ 成为/ 了/ 当前/ 研究/ 的/ 热点/ [/ 3/ -/ 5/ ]/ ./ 诸如/ 2DMesh/ 、/ 3DMesh/ 、/ 3DTorus/ 的/ 经典/ 片上/ 网络/ 具有/ 扩展性/ 强/ 、/ 带宽/ 高及/ 容易/ 实现/ 等/ 优点/ ,/ 在/ 多/ 核/ 处理器/ 中/ 广泛/ 使用/ ./ 但是/ ,/ 2DMesh/ 、/ 3DMesh/ 、/ 3DTorus/ 等片/ 上/ 网络/ 存在/ 直径/ 大/ 的/ 问题/ [/ 5/ -/ 6/ ]/ ./ 当片/ 内/ 节点/ 数/ 达到/ 一定/ 规模/ 后/ ,/ 直径/ 大/ 的/ 片/ 上/ 网络/ 会/ 产生/ 较长/ 的/ 传输/ 时延/ ,/ 降低/ 处理器/ 的/ 性能/ ./ 为/ 提供/ 低/ 时延/ 的/ 片/ 内/ 通信/ ,/ 文献/ [/ 6/ -/ 9/ ]/ 应用/ Fat/ -/ tree/ 、/ 高维/ 拓扑/ 等/ 结构/ ,/ 在/ 此基础/ 上/ 形成/ 片上/ 网络/ 互连/ 众核/ 内/ 各/ 计算/ 节点/ ./ Fat/ -/ tree/ 、/ 高维/ 拓扑/ 等/ 结构/ 具有/ 等/ 分/ 带宽/ 和/ 低/ 网络/ 直径/ 的/ 优势/ ,/ 已经/ 被/ 广泛应用/ 于/ 超级计算机/ 和/ 数据中心/ 的/ 商用/ 网络/ 中/ [/ 7/ -/ 9/ ]/ ,/ 为/ 计算/ 节点/ 间/ 提供/ 了/ 高效/ 互连/ ,/ 使得/ 高性能/ 集群/ 系统/ 具有/ 良好/ 的/ 可扩展性/ ./ Fat/ -/ tree/ 拓扑/ 具有/ 多级/ 互连/ 的/ 结构/ 特点/ ,/ 高维/ 拓扑/ 的/ 节点/ 具有/ 高/ 基数/ 的/ 结构特征/ ./ 这/ 两类/ 拓扑/ 实现/ 的/ 物理/ 互连/ 线多/ ,/ 布线/ 复杂/ ,/ 功耗/ 开销/ 大/ ./ 在/ 高性能/ 计算/ 中/ ,/ 集群/ 系统/ 一般/ 占用/ 的/ 物理/ 空间/ 大/ ,/ 很/ 容易/ 实现/ Fat/ -/ tree/ 和/ 高维/ 结构/ 中/ 互连/ 线/ 的/ 布设/ ,/ 而且/ 不用/ 考虑/ 结构/ 的/ 功耗/ 开销/ 和/ 布线/ 的/ 复杂度/ ./ 与/ 之/ 不同/ 的/ 是/ ,/ 众核/ 设计/ 时/ 只能/ 在/ 有限/ 的/ 空间/ 部署/ 片上/ 网络/ ,/ 面积/ 和/ 功耗/ 是/ 处理器/ 中/ 极为重要/ 的/ 成本/ ./ 在/ 保证/ 良好/ 互通/ 性能/ 的/ 前提/ 下/ ,/ 众/ 核对/ 其片/ 上/ 网络/ 的/ 要求/ 是/ 布线/ 简单/ ,/ 互连/ 线少/ ,/ 功耗/ 低/ ./ 包括/ F/ -/ Mesh/ [/ 10/ ]/ 在内/ ,/ 现有/ 片上/ 网络/ 及其/ 互连/ 线/ 存在/ 功耗/ 大/ 和/ 布线/ 多/ 的/ 问题/ ./ 据统计/ ,/ 片上/ 网络/ 的/ 功耗/ 占/ 到/ 了/ 整个/ 芯片/ 功耗/ 的/ 15/ %/ ~/ 36/ %/ 左右/ ,/ 在/ 节点/ 较多时/ 甚至/ 达到/ 了/ 整个/ 芯片/ 功耗/ 的/ 50/ %/ 左右/ [/ 11/ ]/ ./ 在/ 这些/ 功耗/ 中/ ,/ 大部分/ 是/ 互连/ 线/ 消耗/ 的/ 功耗/ ,/ 其/ 占/ 到/ 了/ 片/ 上/ 网络/ 功耗/ 的/ 70/ %/ 左右/ [/ 11/ -/ 12/ ]/ ./ 在/ 高维/ 结构/ 时/ ,/ 由于/ 互连/ 线/ 较/ 多/ ,/ 其所/ 消耗/ 的/ 功耗/ 占/ 的/ 比重/ 将/ 更/ 大/ ./ 综上所述/ ,/ 众核/ 的/ 设计/ 受/ 布线/ 复杂度/ 、/ 互连/ 线条/ 数/ 和/ 功耗/ 的/ 严格/ 限制/ ,/ 这些/ 限制/ 对/ 其/ 可扩展性/ 有/ 重要/ 的/ 影响/ ./ 由于/ 众核/ 和/ 集群/ 环境/ 之间/ 存在/ 很大/ 的/ 不同/ ,/ 众核/ 的/ 可扩展性/ 无法/ 基于/ 高性能/ 集群/ 系统/ 中/ 的/ 现有/ 拓扑/ 结构/ 实现/ ./ 因此/ ,/ 在/ 现有/ 技术/ 背景/ 下/ ,/ 如何/ 根据/ 众核/ 设计/ 制约/ 条件/ ,/ 研究/ 扩展性/ 强/ 的/ 片/ 上/ 网络拓扑/ 是/ 很/ 有/ 意义/ 的/ ./ 本文/ 应用/ 三维/ 堆叠/ 技术/ 优势/ ,/ 提出/ 了/ 一种/ 低/ 直径/ 、/ 且/ 其/ 为/ 常数/ (/ 仅为/ 5/ “/ 跳/ ”/ )/ 的/ 三维/ 片上/ 网络/ ,/ 其所/ 需/ 互连/ 线少/ ,/ 功耗/ 低/ ,/ 布线/ 简单/ ,/ 具有/ 良好/ 的/ 可扩展性/ ./ 和/ F/ -/ Mesh/ 相比/ ,/ 本文/ 所/ 提出/ 的/ 三维/ 片上/ 网络/ 在/ 未/ 大幅/ 增加/ 网络/ 直径/ 的/ 同时/ ,/ 有效/ 降低/ 了/ 布线/ 规模/ 数/ 和/ 复杂度/ ,/ 所/ 需/ 的/ 路由/ 数量/ 减少/ ,/ 整体/ 结构/ 的/ 动态/ 开销/ 降低/ ./ 本文/ 把/ 所/ 提出/ 的/ 片/ 上/ 网络/ 简称/ 为/ V/ -/ Mesh/ ,/ 其中/ V/ 表示/ 网络/ 直径/ 为/ 5/ ./ 本文/ 的/ 主要/ 贡献/ 包括/ :/ (/ 1/ )/ 提出/ 了/ 面向/ 三维/ 堆叠/ 芯片/ 的/ 低/ 时延/ 和/ 低功耗/ 片上/ 网络/ V/ -/ Mesh/ ,/ 形式化/ 描述/ 了/ 该/ 拓扑/ 设计/ ,/ 同时/ 对/ 3DMesh/ 和/ F/ -/ Mesh/ 拓扑/ 做/ 了/ 形式化/ 描述/ ./ (/ 2/ )/ 通过/ 计算/ ,/ 得出/ 了/ V/ -/ Mesh/ 在/ 不同/ 节点/ 下/ 所/ 需要/ 的/ 层数/ L/ 、/ 节点/ 数/ N/ 及/ 节点/ 路由/ 基数/ R/ 之间/ 的/ 关系/ ,/ 并/ 给出/ 了/ 其/ 布线/ 策略/ 、/ 路由表/ 和/ 路由/ 算法/ 的/ 设计/ ,/ 以及/ 相关/ 的/ 三维/ 堆叠/ 路由器/ 实现/ ./ (/ 3/ )/ 通过/ 理论/ 分析/ ,/ 得出/ 了/ V/ -/ Mesh/ 、/ 3DMesh/ 和/ F/ -/ Mesh/ 的/ 网络/ 直径/ 、/ 理想/ 吞吐量/ 、/ (/ 长/ )/ 互连/ 线/ 规模/ 数/ 和/ 扩展性/ 等/ 参数/ ,/ 对/ 它们/ 进行/ 了/ 相应/ 的/ 比较/ ./ 结果表明/ V/ -/ Mesh/ 在/ 上述/ 参数/ 方面/ 均/ 具有/ 明显/ 优势/ ./ (/ 4/ )/ 参照/ F/ -/ Mesh/ ,/ 给出/ 了/ V/ -/ Mesh/ 中长/ 互连/ 线/ 的/ 功耗/ 和/ 时延/ 参数/ ./ 实验/ 比较/ 了/ V/ -/ Mesh/ 、/ 3DMesh/ 和/ F/ -/ Mesh/ ,/ 结果表明/ V/ -/ Mesh/ 在/ 时延/ 、/ 吞吐量/ 和/ 功耗/ 方面/ 具有/ 较/ 明显/ 的/ 优势/ ./ Page3/ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 描述/ V/ -/ Mesh/ 拓扑/ 结构/ ;/ 第/ 4/ 节给/ 出路/ 由/ 算法/ 及/ 相关/ 技术/ 实现/ 细节/ ;/ 第/ 5/ 节/ 从/ 各个方面/ 对/ V/ -/ Mesh/ 、/ 3DMesh/ 和/ F/ -/ Mesh/ 三种/ 结构/ 进行/ 理论/ 评估/ ;/ 第/ 6/ 节/ 通过/ 两组/ 实验/ ,/ 对/ 以上/ 结构/ 的/ 时延/ 、/ 吞吐量/ 和/ 功耗/ 进行/ 比较/ ;/ 最后/ 是/ 结束语/ ./ 2/ 相关/ 工作/ 与/ 本文/ 工作/ 相关性/ 较大/ 的/ 主要/ 是/ 文献/ [/ 10/ ]/ 提出/ 的/ 3D/ 全/ 互连/ 网络拓扑/ ,/ 该/ 网络拓扑/ 基于/ 三维/ 堆叠/ 技术/ [/ 13/ -/ 15/ ]/ 实现/ ,/ 具有/ 低/ 基数/ 低/ 直径/ 的/ 良好/ 特点/ ,/ 能/ 显著/ 减少/ 3DMesh/ 片上/ 网络/ 上/ 的/ 互连/ 线/ ,/ 具有/ 层间/ 互连/ 线/ 短/ 和/ 时延/ 低/ 的/ 特点/ ,/ 为/ 实现/ 新/ 的/ 片/ 上/ 互连/ 技术/ 提供/ 了/ 支持/ ./ 由于/ 3DMesh/ 是/ 基础/ 的/ 三维/ 片上/ 网络/ ,/ 为/ 不失/ 全面性/ ,/ 下面/ 对/ 3DMesh/ 和/ 3D/ 全/ 互连/ 网络拓扑/ 这/ 两种/ 结构/ 做/ 重点/ 介绍/ ./ 3DMesh/ 结构/ ./ 假定/ N/ ×/ N/ ×/ L/ 的/ 网络/ 中/ ,/ 某/ 节点/ X/ 的/ 坐标/ 是/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 0/ / i/ </ N/ ,/ 0/ / j/ </ N/ ,/ 0/ / l/ </ L/ ,/ 任何/ 节点/ Y/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 只要/ 满足/ |/ i/ -/ i/ |/ +/ |/ j/ -/ j/ |/ +/ |/ l/ -/ l/ |/ =/ 1/ ,/ 都/ 与/ 节点/ X/ 相连/ ./ 3DMesh/ 的/ 路由/ 算法/ 比较/ 多/ ,/ 在/ 确定性/ 算法/ 中/ ,/ 比较/ 常用/ 的/ 有/ XYZ/ 路由/ 算法/ ./ 3DMesh/ 具有/ 网络/ 直径/ 大/ 的/ 缺点/ ,/ 其/ 直径/ 随/ 节点/ 数/ 的/ 增大/ 而/ 线性/ 增大/ ./ 图/ 1/ 给出/ 了/ 3DMesh/ 的/ 拓扑/ 和/ 路由/ 示意图/ ./ 在/ 完整/ 的/ 3DMesh/ 拓扑/ 结构/ 中/ ,/ 不同/ 的/ 层间/ 还有/ 垂直/ 互连/ 线/ 连接/ 上下/ 两/ 相邻/ 节点/ ./ 特点/ :/ 3D/ 全/ 互连/ 结构/ ./ 3D/ 全/ 互连/ 结构/ 满足/ 以下/ 2/ 个/ (/ 1/ )/ 处于/ 3D/ 片上/ 网络/ 的/ 任何/ 两/ 节点/ X/ (/ i/ ,/ j/ ,/ k/ )/ ,/ Y/ (/ i/ ,/ j/ ,/ k/ )/ ,/ 有且/ 只/ 存在/ 某层/ l/ ,/ 在/ l/ 层/ 两/ 节点/ X/ (/ i/ ,/ j/ ,/ l/ )/ 和/ Y/ (/ i/ ,/ j/ ,/ l/ )/ 之间/ 存在/ 互连/ 线直/ 连/ ./ 形式化/ 描述/ 为/ (/ / l/ )/ P/ (/ X/ ,/ Y/ )/ ,/ 其中/ P/ (/ X/ ,/ Y/ )/ 表示/ (/ X/ ,/ Y/ )/ (/ 2/ )/ 假定/ N/ ×/ N/ ×/ L/ 的/ 网络/ 中/ ,/ 某/ 节点/ X/ 的/ 坐标/ 是/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 0/ / i/ </ N/ ,/ 0/ / j/ </ N/ ,/ 0/ / l/ </ L/ ,/ 与/ X/ 相邻/ 的/ 节点/ Y/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 只要/ 满足/ |/ l/ -/ l/ |/ =/ 1/ ,/ 则/ 与/ 节点/ X/ 垂直/ 相连/ ./ 3D/ 全/ 互连/ 结构/ 的/ 网络/ 直径/ 最长/ 为/ 3/ 跳/ ,/ 路由/ 算法/ 也/ 较为简单/ ,/ 可/ 通过/ 查找/ 节点/ 路由表/ 实现/ ./ 路径/ 为/ X/ (/ i/ ,/ j/ ,/ k/ )/ →/ X/ (/ i/ ,/ j/ ,/ l/ )/ →/ Y/ (/ i/ ,/ j/ ,/ l/ )/ →/ Y/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 即先/ 经过/ 1/ 次/ 垂直/ 通路/ ,/ 接着/ 经过/ 同层/ 的/ 水平/ 通路/ ,/ 最后/ 再/ 经过/ 1/ 次/ 垂直/ 通路/ 即可/ 到达/ 目的/ 节点/ ./ 该片/ 上/ 网络/ 具有/ 直径/ 低/ 的/ 优点/ ,/ 但/ 该/ 拓扑/ 直接/ 支持/ 的/ 节点/ 数/ 有限/ ./ 为/ 便于/ 描述/ ,/ 本文/ 把/ 3D/ 全/ 互连/ 结构/ 称为/ FullMesh/ ,/ 简称/ 为/ F/ -/ Mesh/ ./ 节点/ 对/ 之间/ 有/ 互连/ 线直/ 连/ ./ 图/ 2/ 给出/ 了/ F/ -/ Mesh/ 的/ 拓扑/ 和/ 路由/ 示意图/ ./ 在/ 完整/ 的/ F/ -/ Mesh/ 拓扑/ 结构/ 中/ ,/ 不同/ 的/ 层间/ 同样/ 有/ 垂直/ 互连/ 线/ 互连/ 两/ 上下/ 相邻/ 的/ 节点/ ./ 从图/ 中/ 可以/ 看出/ ,/ F/ -/ Mesh/ 结构/ 中/ 任何/ 两/ 节点/ 间/ 的/ 最/ 长距离/ 为/ 3/ 跳/ ,/ 其层/ 内/ 采用/ 长/ 弯折/ 互连/ 线/ 连接/ 不/ 处于/ 同行/ 或/ 同列/ 的/ 两/ 节点/ ./ 除了/ 验证/ 理论/ 上/ 的/ 可行性/ 之外/ ,/ 文献/ [/ 10/ ]/ 还/ 从技术上/ 论证/ 了/ 长/ 互连/ 线/ 的/ 面积/ 和/ 功耗/ 代价/ ,/ 证明/ 了/ Page4/ 其/ 在/ 布局/ 布线/ 上/ 的/ 可行性/ ,/ 并/ 通过/ 基准/ 测试程序/ 的/ trace/ 实验/ 进行/ 了/ 评估/ ,/ 表明/ 由/ 多层/ 、/ (/ 多/ )/ 长/ 互连/ 线/ 构成/ 的/ 拓扑/ 理论/ 设想/ 在技术上/ 也/ 是/ 可行/ 的/ ./ 比较/ ./ F/ -/ Mesh/ 与/ 3DMesh/ 相比/ ,/ 最/ 多/ 能够/ 减少/ 29/ %/ 的/ 时延/ 和/ 24/ %/ 的/ 功耗/ ,/ 以及/ 最大/ 能够/ 提升/ 10/ %/ 的/ 吞吐量/ [/ 10/ ]/ ./ 虽然/ F/ -/ Mesh/ 直径/ 为/ 3/ 跳/ ,/ 但/ 其/ 能够/ 支持/ 的/ 处理/ 核数/ 仅/ 为/ 36/ ,/ 而且/ 布线/ 复杂/ ;/ 当/ 节点/ 数/ 超过/ 36/ 个/ 节点/ 时/ ,/ 则/ 需要/ 采用/ 节点/ 分组/ 的/ 方法/ ,/ 即/ 多个/ 节点/ 构成/ 一组/ ,/ 采用/ 分级/ 的/ 方式/ 互连/ ,/ 这/ 破坏/ 了/ 拓扑/ 结构/ 的/ 完整性/ ./ 另外/ ,/ 文献/ [/ 8/ ,/ 16/ -/ 18/ ]/ 分别/ 从/ 加速/ 路由/ 速度/ 和/ 减少/ 网络/ 直径/ 的/ 角度/ 来/ 降低/ 网络/ 时延/ ./ 但是/ ,/ 文献/ [/ 8/ ,/ 17/ -/ 18/ ]/ 所提/ 方案/ 仍然/ 存在/ 网络/ 直径/ 大/ 、/ 布线/ 复杂/ 和/ 时/ 延长/ 的/ 问题/ ./ 3V/ -/ Mesh/ 拓扑/ 结构/ 本节/ 对/ V/ -/ Mesh/ 片上/ 网络拓扑/ 进行/ 了/ 描述/ ,/ 这里/ 提到/ 的/ “/ 跳/ ”/ 的/ 概念/ 和/ 文献/ [/ 10/ ]/ 给出/ 的/ 类似/ ./ 为/ 便于/ 描述/ ,/ 先/ 给出/ 如下/ 相关/ 定义/ ./ 定义/ 1/ ./ 长/ 互连/ 线/ ./ 片上/ 网络/ 中/ ,/ 连接/ 同一/ 行/ 或/ 同一/ 列上/ 的/ 非/ 相邻/ 两/ 节点/ 间/ 的/ 互连/ 线/ ./ 长/ 互连/ 线/ 有别于/ 互连/ 两/ 相邻/ 节点/ 的/ 短/ 互连/ 线/ ./ 为/ 保证/ 通信/ 性能/ ,/ 长/ 互连/ 线/ 的/ 直径/ 比短/ 互连/ 线/ 的/ 要/ 大/ ,/ 这时/ 能/ 达到/ 与/ 短/ 互连/ 线/ 同样/ 的/ 互连/ 特性/ ,/ 但/ 相应/ 的/ 功耗/ 也/ 会/ 增加/ ./ 文献/ [/ 10/ ]/ 提出/ 了/ 通过/ 泄漏/ 还原/ 技术/ (/ leakagereductiontechnique/ )/ 来/ 控制/ 长/ 互连/ 线/ 的/ 功耗/ ./ 定义/ 2/ ./ 行/ 互连/ ./ 3D/ 片上/ 网络/ r/ 行上/ 的/ 任何/ 两/ 不/ 相邻/ 节点/ X/ (/ i/ ,/ r/ ,/ k/ )/ ,/ Y/ (/ i/ ,/ r/ ,/ k/ )/ ,/ 有且/ 只/ 存在/ 某层/ l/ ,/ 在/ l/ 层/ 两/ 节点/ X/ (/ i/ ,/ r/ ,/ l/ )/ 和/ Y/ (/ i/ ,/ r/ ,/ l/ )/ 之间/ 存在/ 互连/ 线直/ 连/ ./ 行/ 互连/ 形式化/ 描述/ 为/ (/ / l/ )/ P/ (/ X/ ,/ Y/ )/ ,/ 其中/ P/ (/ X/ ,/ Y/ )/ 表示/ 节点/ 对/ (/ X/ ,/ Y/ )/ 有/ 互连/ 线直/ 连/ ./ l/ 和/ k/ 可以/ 一样/ ,/ 当/ l/ 和/ k/ 一样/ 时/ ,/ 表示/ 互连/ 该/ 两点/ 的/ 互连/ 线/ 刚好/ 布设/ 在/ k/ 层/ ./ 定义/ 3/ ./ 列/ 互连/ ./ 3D/ 片上/ 网络/ c/ 列上/ 的/ 任何/ 两/ 不/ 相邻/ 节点/ X/ (/ c/ ,/ j/ ,/ k/ )/ ,/ Y/ (/ c/ ,/ j/ ,/ k/ )/ ,/ 有且/ 只/ 存在/ 某层/ l/ ,/ 在/ l/ 层/ 两/ 节点/ X/ (/ c/ ,/ j/ ,/ l/ )/ 和/ Y/ (/ c/ ,/ j/ ,/ l/ )/ 之间/ 存在/ 长/ 互连/ 线直/ 连/ ./ 列/ 互连/ 形式化/ 描述/ 为/ (/ / l/ )/ P/ (/ X/ ,/ Y/ )/ ,/ 其中/ P/ (/ X/ ,/ Y/ )/ 表示/ 节点/ 对/ (/ X/ ,/ Y/ )/ 之间/ 有/ 互连/ 线直/ 连/ ./ 同样/ ,/ l/ 和/ k/ 可以/ 一样/ ,/ 当/ l/ 和/ k/ 一样/ 时/ ,/ 表示/ 互连/ 该/ 两点/ 的/ 互连/ 线/ 刚好/ 布设/ 在/ k/ 层/ ./ 定义/ 4/ ./ 行/ // 列/ 互连/ 结构/ ./ 满足/ 行/ 互连/ 和/ 列/ 互连/ 结构/ 的/ 三维/ 拓扑/ 结构/ ./ 定义/ 5/ ./ 垂直/ 互连/ ./ 假定/ N/ ×/ N/ ×/ L/ 的/ 网络/ 中/ ,/ 某/ 节点/ X/ 的/ 坐标/ 是/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 0/ / i/ </ N/ ,/ 0/ / j/ </ N/ ,/ 0/ / l/ </ L/ ,/ 与/ X/ 相邻/ 的/ 节点/ Y/ (/ i/ ,/ j/ ,/ l/ )/ ,/ 只要/ 满足/ |/ l/ -/ l/ |/ =/ 1/ ,/ 则/ 与/ 节点/ X/ 垂直/ 相连/ ./ 定义/ 6/ ./ V/ -/ Mesh/ ./ 在/ 3DMesh/ 结构/ 的/ 基础/ 上/ ,/ 保留/ 最上层/ 的/ 节点/ 网络/ (/ 即/ 2DMesh/ 层/ )/ ,/ 对/ 其余/ 层上/ 的/ 层/ 内/ 互连/ 线/ 重新/ 布线/ ,/ 布设/ 为行/ // 列/ 互连/ 子网/ ,/ 层间/ 采用/ 三维/ 堆叠/ 技术/ 垂直/ 互连/ ./ 如图/ 3/ 所示/ ,/ V/ -/ Mesh/ 可以/ 在/ 3DMesh/ 的/ 基础/ 上/ 变换/ 而来/ ./ 即/ 在/ 原来/ 3DMesh/ 的/ 基础/ 上/ ,/ 保留/ 最上层/ 的/ 节点/ 网络/ ,/ 其余/ 层/ 的/ 层/ 内/ 互连/ 线/ 进行/ 重新/ 布线/ 为/ :/ 第/ 2/ 层/ 每行/ 有/ 左/ 、/ 中/ 、/ 右/ 三点/ ,/ 重新/ 布设/ 长/ 互连/ 线/ 互连/ 左右两/ 节点/ ,/ 第/ 3/ 层/ 每列/ 有/ 前/ 、/ 中/ 、/ 后/ 三点/ ,/ 重新/ 布设/ 长/ 互连/ 线/ 互连/ 前后/ 两/ 节点/ ./ 中/ 数据传输/ 时/ ,/ 通过/ 的/ 互连/ 线/ 的/ 条数/ ./ 定义/ 7/ ./ V/ -/ Mesh/ 网络/ 中/ 的/ 跳/ ./ V/ -/ Mesh/ 网络/ 其中/ 经过/ 1/ 条长/ 互连/ 线/ 就算/ 1/ “/ 跳/ ”/ ,/ 经过/ 1/ 次/ 垂直/ 互连/ 也/ 算/ 1/ “/ 跳/ ”/ ./ “/ 跳/ ”/ 在/ 本文/ 中/ 也/ 作为/ V/ -/ Mesh/ 片上/ 网络/ 直径/ 的/ 单位/ ./ 定义/ 8/ ./ V/ -/ Mesh/ 节点/ 间/ 距离/ ./ V/ -/ Mesh/ 网络/ 中/ ,/ 根据/ 路由/ 算法/ ,/ 从/ 某/ 节点/ 到/ 另/ 一/ 节点/ 所/ 经过/ 的/ “/ 跳/ ”/ 数/ ./ 定义/ 9/ ./ V/ -/ Mesh/ 中/ 的/ 通信/ 链路/ ./ V/ -/ Mesh/ 网络/ 中/ ,/ 根据/ 路由/ 算法/ ,/ 从/ 某/ 节点/ 到/ 另/ 一/ 节点/ 依次/ 所/ 经过/ 的/ 互连/ 线/ ./ 如图/ 4/ 所示/ ,/ 垂直/ 互连/ 线/ FE/ 、/ 长/ 互连/ 线/ ED/ 、/ 垂直/ 互连/ 线/ DC/ 、/ 长/ 互连/ 线/ CB/ 和/ 垂直/ 互连/ 线/ BA/ 构成/ 了/ 从/ 节点/ F/ 到/ 节点/ A/ 的/ 通信/ 链路/ ./ 离/ 最长/ 为/ 5/ “/ 跳/ ”/ ./ 定理/ 1/ ./ V/ -/ Mesh/ 网络/ 中/ ,/ 任意/ 两/ 节点/ 间/ 的/ 距/ 证明/ ./ 令/ A/ (/ x/ ,/ y/ ,/ j/ )/ 表示/ 处于/ j/ 层/ 的/ 第/ x/ 行/ 、/ y/ 列/ 的/ 节点/ ,/ 设/ A/ 、/ B/ 、/ AB/ 、/ AB/ 分别/ 表示/ 和/ 节点/ A/ 、/ B/ 、/ AB/ 、/ AB/ 具有/ 相同/ 的/ x/ 、/ y/ 坐标/ ,/ 但/ 处于/ 不同/ 层/ 的/ 节点/ ,/ 它们/ 之间/ 的/ 通信/ 通过/ 层间/ 互连/ 线/ 进行/ ./ Page5/ 根据/ 定义/ 1/ 有/ (/ / l/ )/ P/ (/ A/ ,/ AB/ )/ =/ Line/ (/ A/ (/ x/ ,/ y/ ,/ l/ )/ ,/ AB/ (/ u/ ,/ y/ ,/ l/ )/ )/ 根据/ 定义/ 2/ 有/ (/ / l/ )/ P/ (/ AB/ ,/ B/ )/ =/ Line/ (/ AB/ (/ u/ ,/ y/ ,/ l/ )/ ,/ B/ (/ u/ ,/ v/ ,/ l/ )/ )/ 式/ (/ 1/ )/ 、/ 式/ (/ 2/ )/ 中/ 节点/ A/ 到/ A/ 、/ AB/ 到/ AB/ 、/ B/ 到/ B/ 的/ 通信/ 分别/ 通过/ 1/ “/ 跳/ ”/ 的/ 层间/ 垂直/ 互连/ 线/ 进行/ ,/ 即/ Line/ (/ A/ ,/ A/ )/ 、/ Line/ (/ AB/ ,/ AB/ )/ 和/ Line/ (/ B/ ,/ B/ )/ ./ 这里/ 的/ Line/ (/ A/ ,/ B/ )/ 表示/ 节点/ A/ 、/ B/ 之间/ 的/ 长/ 互连/ 线/ ./ 综上/ ,/ V/ -/ Mesh/ 网络拓扑/ 中/ ,/ 任何/ 两/ 节点/ 间/ 的/ 距离/ 最长/ 为/ 5/ “/ 跳/ ”/ ./ 定理/ 1/ 表明/ ,/ V/ -/ Mesh/ 的/ 网络/ 直径/ 为/ 5/ “/ 跳/ ”/ ./ 该/ 网络/ 直径/ 为/ 一/ 常数/ ,/ 和/ V/ -/ Mesh/ 中/ 的/ 节点/ 数/ 无关/ ,/ 故/ V/ -/ Mesh/ 具有/ 良好/ 的/ 可扩展性/ ./ 4V/ -/ Mesh/ 拓扑/ 实现/ 为/ 实现/ V/ -/ Mesh/ 拓扑/ 中/ 的/ 行/ // 列/ 互连/ 子网/ ,/ 需要/ 有/ 多个/ 网络层/ 的/ 支持/ ./ 另外/ ,/ 还/ 需要/ 合理/ 地/ 分配/ 算法/ ,/ 来/ 对行/ // 列/ 互连/ 子网/ 中/ 的/ 长/ 互连/ 线/ 进行/ 分配/ ./ 为此/ ,/ 本节/ 对/ 该/ 拓扑/ 的/ 网络层/ 数/ 、/ 长/ 互连/ 线/ 分配/ 算法/ 、/ 路由/ 节点/ 表/ 、/ 路由/ 算法/ 、/ 长/ 互连/ 线/ 的/ 功耗/ 、/ 时延/ 参数/ 等/ 技术/ 实现/ 细节/ 和/ 计算/ 依据/ 进行/ 了/ 描述/ ./ 4.1/ V/ -/ Mesh/ 网络层/ 数/ 计算/ 假定/ V/ -/ Mesh/ 拓扑/ 结构/ 中/ 参数/ 为/ :/ 层数/ 为/ L/ 层/ 、/ 每层/ 有/ N/ ×/ N/ 个/ 节点/ ,/ 底层/ 由/ 2DMesh/ 网络/ 互连/ 各/ 节点/ ,/ R/ 表示/ 路由/ 节点/ 中非/ 本地/ 数据/ 输入输出/ 端口数/ ./ 在/ 给定/ 节点/ 数/ 的/ 情况/ 下/ ,/ 通过/ 计算/ ,/ 得出/ 实现/ 行/ // 列/ 互连/ 所/ 需要/ 的/ 最少/ 层数/ ./ 表/ 1/ 给出/ 了/ L/ 、/ N/ 和/ R/ 三者/ 之间/ 的/ 关系/ ,/ 随后/ 给出/ 了/ 该/ 计算/ 依据/ 和/ 过程/ ./ NLR/ / RL/ / NLR/ / RL/ / 43.03/ ./ 021014.43/ ./ 6454.83/ ./ 221116.43/ ./ 7566.63/ ./ 321218.33/ ./ 7578.63/ ./ 431320.23/ ./ 76810.53/ ./ 53/ …/ …/ …/ …/ 912.43/ ./ 642238.183/ ./ 810/ 容易/ 得出/ ,/ 每层/ 最/ 多/ 可以/ 容纳/ RN2/ // 2/ 条/ 互连/ 线/ ,/ 故/ L/ 层/ 的/ 存储/ 层/ 最多能/ 容纳/ 的/ 互连/ 线条/ 数为/ LRN2/ // 2/ ./ 对/ 该片/ 上/ 网络/ 构建/ 行/ 互连/ 和/ 列/ 互连/ ,/ 共/ 需要/ N/ (/ N/ -/ 1/ )/ // 2/ ×/ 2N/ =/ N2/ (/ N/ -/ 1/ )/ 条/ 互连/ 线/ ./ 除去/ 2DMesh/ 层中/ 的/ 2/ (/ N2/ -/ N/ )/ 条/ 互连/ 线/ ,/ 该/ 网络/ 的/ 其余/ 层/ 总共/ 需要/ 容纳/ N2/ (/ N/ -/ 1/ )/ -/ 2/ (/ N2/ -/ N/ )/ 条/ 互连/ 线/ ./ 因此/ 有式/ (/ 3/ )/ 可/ 化简/ 为/ 由于/ V/ -/ Mesh/ 的/ 底层/ 已经/ 有/ 2/ (/ N2/ -/ N/ )/ 条/ 互连/ 线/ ,/ 每/ 一层/ 最/ 多/ 容纳/ 的/ 互连/ 线条/ 数为/ RN2/ // 2/ 条/ ,/ 为/ 确保/ 网络带宽/ 的/ 一致/ ,/ 2DMesh/ 子网/ 和行/ // 列/ 互连/ 子网/ 的/ 互连/ 线/ 应该/ 相同/ ,/ 有/ 如下/ 公式/ ./ 式/ (/ 5/ )/ 可/ 化简/ 为式/ (/ 6/ )/ 表明/ ,/ 当/ N/ >/ 4/ 时/ ,/ 节点/ 的/ 路由/ 基数/ 最大/ 不/ 超过/ 4/ ,/ 平均/ 节点/ 的/ 路由/ 基数/ 在/ 3/ 和/ 4/ 之间/ ./ 结合/ 式/ (/ 4/ )/ 、/ 式/ (/ 6/ )/ ,/ 在/ 给定/ 节点/ 数/ 的/ 情况/ 下/ ,/ 能够/ 确定/ V/ -/ Mesh/ 网络/ 的/ 层数/ ./ V/ -/ Mesh/ 中/ 节点/ 数/ 和/ 层数/ 的/ 对应/ 关系/ 如表/ 1/ 所示/ ,/ 即/ 在/ 给定/ 节点/ 数/ 的/ 情况/ 下/ ,/ 实现/ 行/ // 列/ 互连/ 所/ 需要/ 的/ 最少/ 层数/ ./ 4.2/ V/ -/ Mesh/ 长/ 互连/ 线/ 分配/ 算法/ V/ -/ Mesh/ 网络/ 中/ ,/ 由于/ 每层/ 的/ 互连/ 线/ 连接/ 情况/ 都/ 不/ 相同/ ,/ 在/ 具体/ 实现/ 时/ 需要/ 一定/ 的/ 算法/ ,/ 用于/ 指导/ 各/ 层层/ 内长/ 互连/ 线/ 的/ 互连/ ./ 长/ 互连/ 线/ 分配/ 的/ 工作/ 主要/ 是/ 确定/ 各路/ 由/ 节点/ 基数/ 和/ 该/ 节点/ 能够/ 互连/ 的/ 长/ 互连/ 线条/ 数/ ./ 换句话说/ ,/ 即/ 决定/ 节点/ X/ 和/ 节点/ Y/ 是否/ 在/ 层/ l/ 有长/ 互连/ 线直/ 连/ ./ 从式/ (/ 6/ )/ 和表/ 1/ 中/ 可以/ 看出/ ,/ 路由/ 基数/ R/ 在/ 3/ 和/ 4/ 之间/ ./ 故/ V/ -/ Mesh/ 中/ ,/ 有/ 的/ 路由/ 基数/ 是/ 3/ ,/ 有/ 的/ 路由/ 基数/ 是/ 4/ ./ 为此/ ,/ 给出/ 的/ 长/ 互连/ 线/ 分配/ 算法/ 如下/ :/ Page6/ (/ 1/ )/ 根据/ 表/ 1/ 中/ 给出/ 的/ 路由/ 基数/ ,/ 对/ 网络/ 中/ 的/ 节点/ 预/ 分配/ 长/ 互连/ 线/ :/ 对于/ 路由/ 基数/ 是/ 4/ 的/ 网络/ ,/ 先给/ 每个/ 节点/ 分配/ 3/ 条长/ 互连/ 线/ ;/ 对于/ 路由/ 基数/ 是/ 3/ 的/ 网络/ ,/ 则/ 给/ 每个/ 节点/ 先/ 分配/ 2/ 条/ 互连/ 线/ ./ (/ 2/ )/ 在/ 不/ 超出/ 节点/ 的/ 路由/ 基数/ R/ 的/ 情况/ 下/ ,/ 将/ 剩下/ 来/ 的/ 长/ 互连/ 线/ 平均分配/ 到/ 网络/ 中/ 各层/ ./ 该/ 互连/ 线/ 分配/ 算法/ 的/ 优点/ 是/ 能/ 快速/ 确定/ 网络/ 中/ 每个/ 路由/ 节点/ 的/ 基数/ 、/ 长/ 互连/ 线条/ 数及/ 布局/ ./ 图/ 5/ 中/ 给出/ 了/ 4/ ×/ 4/ 的/ 网络/ 中/ 某层/ 节点/ 间/ 互连/ 线/ 分配/ 示意图/ ./ 根据/ 表/ 2/ 得知/ ,/ 4/ ×/ 4/ 网络/ 的/ 路由/ 基数/ 为/ 3/ ,/ 故可为/ 每个/ 节点/ 分配/ 2/ 条/ 互连/ 线/ ./ 具体/ 的/ 分配/ 过程/ 标注/ 为/ 1/ 、/ 2/ 和/ 3/ ./ 其中/ 标注/ 为/ “/ 1/ ”/ 的/ 互连/ 线/ 表示/ 对/ 网络/ 中/ 每行/ 的/ 4/ 个/ 节点/ 设置/ 两/ 两/ 互连/ ,/ 标注/ 为/ “/ 2/ ”/ 的/ 互连/ 线/ 表示/ 网络/ 中/ 每列/ 的/ 4/ 个/ 节点/ 设置/ 两/ 两/ 互连/ ,/ 标注/ 为/ “/ 3/ ”/ 的/ 互连/ 线/ 表示/ 将/ 余下/ 的/ 互连/ 线/ 平均分配/ 下去/ 的/ 过程/ ./ 低频/ 网络/ (/ 1GHz/ )/ 高频/ 网络/ (/ 3GHz/ )/ 4.3/ 长/ 互连/ 线/ 功耗/ 时延/ 参数/ 与/ 短/ 互连/ 线/ 相比/ ,/ 长/ 互连/ 线/ 具有/ 不/ 一样/ 的/ 功耗/ 时延/ 特性/ ./ 文献/ [/ 10/ ]/ 中对长/ 互连/ 线/ 和/ TSV/ 进行/ 了/ 详细/ 建模/ ,/ 这里/ 采用/ 其/ 建模/ 结果/ ,/ 同样/ 也/ 采用/ 文献/ [/ 10/ ]/ 中/ 的/ 垂直/ 通路/ TSV/ 参数/ ./ 3D/ 路由器/ 中/ 的/ 垂直/ 通路/ TSV/ 参数/ 见表/ 3/ 所示/ ,/ 长/ 互连/ 线/ 的/ 功耗/ 和/ 时延/ 参数设置/ 见表/ 2/ 所示/ ./ Pillar/ 互通/ 层数/ 时延/ // cycles/ 能耗/ // fJ/ 表/ 3/ 表明/ ,/ 三维/ 堆叠/ 技术/ 的/ 导通/ 能力/ 很强/ ,/ 能/ 在/ 1/ 个/ 时钟/ 周期/ 内/ 互通/ 多层/ ./ 但/ 不同/ 层/ 的/ 能耗/ ,/ 随/ 层数/ 不同/ 而/ 略有不同/ ./ 表/ 2/ 采用/ hop/ 作为/ 互连/ 线/ 长度/ 的/ 单位/ ,/ 这里/ 1hop/ 的/ 长度/ 为/ 1.5/ mm/ ./ 从表/ 2/ 可以/ 看出/ ,/ 在/ 低频/ 网络/ 下/ ,/ 基本/ 能/ 在/ 1/ 个/ 周期/ 内/ 完成/ 数据/ 在/ 长/ 互连/ 线上/ 的/ 传输/ ./ 在/ 高频/ 网络/ 下/ ,/ 则/ 需要/ 2/ ~/ 3/ 个/ 周期/ 才能/ 完成/ 数据/ 在/ 长/ 互连/ 线上/ 的/ 传输/ ./ 能耗/ 随/ 互连/ 线/ 长度/ 的/ 不同/ 而/ 不同/ ./ 由于/ 长/ 互连/ 线/ 能够/ 显著/ 减少/ 数据传输/ 过程/ 中/ 的/ 路由/ 节点/ 数/ ,/ 且/ 其时/ 延/ 特性/ 在/ 低频/ 网络/ 下/ 具有/ 跟/ 短/ 互连/ 线/ 一致/ 的/ 性能/ ,/ 从而/ 长/ 互连/ 线/ 在/ 时延/ 上/ 具有/ 很大/ 的/ 优势/ ./ 4.4/ V/ -/ Mesh/ 节点/ 路由表/ 设计/ V/ -/ Mesh/ 中/ 的/ 路由/ 通过/ 查找/ 路由表/ 实现/ ./ 在/ V/ -/ Mesh/ 中/ ,/ 各/ 节点/ 中/ 设有/ 路由表/ ./ 该表/ 记录/ 了/ 处于/ 同列/ 的/ 所有/ 节点/ 的/ 互连/ 线/ 连接/ 情况/ ,/ 以/ 〈/ 行或列/ ,/ 层/ ,/ 端口号/ 〉/ 方式/ 来/ 表示/ ,/ 其中/ 第/ 3/ 位/ 表示/ 该/ 路由/ 节点/ 上/ 的/ 互连/ 线/ 编号/ ./ 如/ 〈/ x/ ,/ l/ ,/ 0/ 〉/ 表示/ 该/ 节点/ 和/ x/ 面/ 的/ 通信/ 通过/ l/ 层/ 的/ 0/ 号长/ 互连/ 线/ 进行/ ./ 4.5/ V/ -/ Mesh/ 路由/ 算法/ 设计/ V/ -/ Mesh/ 网络/ 中/ 数据传输/ 时/ ,/ 最长/ 路径/ 为/ 5/ “/ 跳/ ”/ ,/ 即/ 依次/ 经过/ 垂直/ 通信/ 、/ 水平/ 行/ 通信/ 、/ 垂直/ 通信/ 、/ 水平/ 列/ 通信/ ,/ 最后/ 经过/ 垂直/ 通信/ 到达/ ,/ 该/ 路由/ 算法/ 简称/ 为/ ZXZYZ/ 算法/ ,/ 又/ 称为/ VM/ 算法/ ,/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ ZXZYZ/ 路由/ 算法/ (/ ZXZYZRA/ )/ ./ 输入/ :/ 目的/ 节点/ 输出/ :/ 找出/ 数据/ 所在/ 节点/ 出口/ ,/ 并/ 将/ 数据/ 转发/ 到/ 该/ 出口/ 1/ ./ ZXZYZ/ _/ Routing/ _/ Algorithm/ (/ destination/ ./ node/ )/ {/ 2/ ./ IF/ (/ destination/ ./ node/ ./ x/ =/ =/ my/ ./ node/ ./ x3/ ./ transmit/ _/ data/ (/ my/ ./ direction/ ./ z/ ,/ z/ )/ ;/ }/ 4/ ./ ELSE/ {/ 5/ ./ IF/ (/ destination/ ./ node/ ./ y/ =/ =/ my/ ./ node/ ./ y/ )/ 6/ ./ IF/ (/ my/ ./ wire/ ./ l/ !/ =/ x/ )/ {/ Page77/ ./ 8/ ./ transmit/ _/ data/ (/ my/ ./ wire/ ,/ l/ )/ ;/ }/ 9/ ./ IF/ (/ destination/ ./ node/ ./ x/ =/ =/ my/ ./ node/ ./ x/ )/ {/ 10/ ./ IF/ (/ my/ ./ wire/ ./ l/ !/ =/ y/ )/ {/ 11/ ./ l/ =/ lookup/ (/ my/ ./ router/ _/ table/ ,/ y/ )/ ;/ 12/ ./ transmit/ _/ data/ (/ my/ ./ direction/ ./ z/ ,/ l/ )/ ;/ }/ 13/ ./ transmit/ _/ data/ (/ my/ ./ wire/ ,/ l/ )/ ;/ }/ 14/ ./ }/ 当/ 两/ 节点/ 不/ 处于/ 同行/ 或/ 同列/ 所在/ 的/ 面时/ ,/ 它们/ 之间/ 存在/ 两条/ 通路/ ,/ 采用/ ZXZYZ/ 路由/ 算法/ 确定/ 其中/ 一条/ ./ 结合/ 算法/ 1/ 对/ ZXZYZ/ 路由/ 算法/ 进行/ 描述/ :/ 当/ 数据/ 从/ 节点/ A/ (/ u/ ,/ v/ ,/ w/ )/ 传往/ 节点/ B/ (/ x/ ,/ y/ ,/ 0/ )/ 时/ ,/ A/ 所在/ 的/ 路由/ 节点/ 检查/ 其/ 是否/ 与/ 第/ x/ 列纵面/ 有/ 直连线/ 相连/ ,/ 若有/ ,/ 把/ 该/ 数据/ 往/ 相连/ 的/ 那个/ 长/ 互连/ 线/ 转发/ ,/ 若/ 没有/ ,/ 请求/ 数据包/ 通过/ 垂直/ 通道/ 传输/ ,/ 直到/ 到达/ 与/ 第/ x/ 列纵面/ 相连/ 的/ 那层/ ;/ 每个/ 路由/ 节点/ 收到/ 数据包/ 图/ 6/ 关键部件/ 构成/ 示意图/ 三维/ 堆叠/ 芯片/ 中层/ 间/ 距离/ 很小/ ,/ 1/ 个/ TSV/ 就/ 可以/ 连接/ 所有/ 芯片/ 层/ ./ 因此/ ,/ 本文/ 采用/ 高性能/ 的/ ConnectionBox/ (/ CB/ )/ 来/ 构造/ 高速/ 垂直/ 互连/ 线/ TSV/ ./ CB/ 内部结构/ 如图/ 6/ (/ b/ )/ 所示/ ,/ 每个/ CB/ 由/ 5/ 个/ 晶体管/ 组成/ ,/ CB/ 能够/ 同时/ 传递/ 水平/ 方向/ 和/ 垂直/ 方向/ 的/ 数据包/ ./ 后/ 检查/ 其/ 路由表/ 是否/ 存在/ 有/ 与/ y/ 列纵面/ 相连/ 的/ 互连/ 线/ ,/ 若有/ ,/ 就/ 把/ 数据/ 请求/ 转往/ 该/ 互连/ 线/ ,/ 没有/ 则/ 继续/ 往/ 垂直/ 通道/ 的/ 下/ 一个/ 路由/ 转发/ ,/ 直到/ 数据包/ 转往/ y/ 纵面/ ./ 该/ 算法/ 中/ ,/ 由于/ 数据包/ 的/ 每次/ 转发/ 均/ 朝/ 目标/ 推进/ ,/ 故能/ 有效/ 避免/ 死锁/ ./ 另外/ ,/ 可/ 在/ 算法/ 中/ 对/ 所/ 经过/ 的/ 节点/ 数/ 进行/ 计数/ ,/ 当/ 某个/ 数据包/ 的/ 传输/ 距离/ 超过/ 5/ “/ 跳/ ”/ 时/ ,/ 则/ 丢弃/ 该/ 数据包/ ./ V/ -/ Mesh/ 拓扑/ 中/ ,/ 行/ 互连/ 和/ 列/ 互连/ 技术/ 确保/ 了/ 节点/ 之间/ 的/ 互通性/ ,/ 每/ 一条/ 互连/ 线能/ 为/ 固定/ 的/ 某/ 一列/ 或/ 某/ 两列/ 上/ 的/ 所有/ 节点/ 提供/ 通信/ 通道/ ./ 若/ 节点/ 的/ 利用率/ 相同/ ,/ 则/ 互连/ 节点/ 的/ 长/ 互连/ 线/ 的/ 利用率/ 相当/ ./ 4.6/ V/ -/ Mesh/ 三维/ 路由器/ 设计/ V/ -/ Mesh/ 需要/ 3D/ 路由器/ 来/ 实现/ 节点/ 间/ 的/ 互通/ ./ 含有/ V/ -/ Mesh/ 片上/ 互连/ 的/ 芯片/ 构成/ 示意图/ 如图/ 6/ (/ a/ )/ 所示/ ,/ 其中/ 的/ 3D/ 路由器/ 如图/ 6/ (/ c/ )/ 所示/ ./ 53/ 种/ 拓扑/ 结构/ 的/ 理论/ 评估/ 3DMesh/ 结构/ 是/ 三维/ 片上/ 网络/ 中/ 的/ 经典/ 拓扑/ ,/ F/ -/ Mesh/ 结构/ 是/ 利用/ 了/ 三维/ 堆叠/ 技术/ 优势/ 的/ 代表/ 拓/ Page8/ 扑/ ./ 本节/ 从/ 网络/ 直径/ 、/ 理想/ 吞吐量/ 、/ 理想/ 平均/ 时延/ 、/ 物理/ 实现/ 难度/ 和/ 扩展性/ 等/ 方面/ 对/ V/ -/ Mesh/ 、/ 3DMesh/ 和/ F/ -/ Mesh/ 三种/ 拓扑/ 进行/ 评估/ ./ 从/ 结果/ 来看/ ,/ V/ -/ Mesh/ 在/ 扩展性/ 、/ 网络/ 直径/ 、/ 理想/ 时延/ 三/ 方面/ 都/ 比/ 3DMesh/ 要/ 好/ ;/ 另外/ ,/ V/ -/ Mesh/ 的/ 理想/ 平均/ 时延/ 与/ F/ -/ Mesh/ 相当/ ,/ 但/ 其/ 布线/ 规模/ 数要/ 远远/ 低于/ F/ -/ Mesh/ ./ 从/ 物理/ 实现/ 难度/ 来说/ ,/ V/ -/ Mesh/ 结构/ 的/ 实现/ 是/ 最/ 容易/ 的/ ,/ F/ -/ Mesh/ 结构/ 的/ 实现/ 是/ 最难/ 的/ ./ 总的来说/ ,/ V/ -/ Mesh/ 结构/ 在/ 这/ 3/ 种/ 结构/ 中是/ 最好/ 的/ ./ 表/ 4/ 对/ 上述/ 静态/ 特性/ 进行/ 了/ 总结/ ,/ 列出/ 了/ 3/ 种/ 拓扑/ 下/ 的/ 静态/ 特性/ 理论/ 评估/ 比较/ ./ 随后/ 给出/ 了/ 3/ 种/ 拓扑/ 的/ 理论/ 评估/ 细节/ ./ 网络/ 直径/ 大/ 互连/ 线/ 规模/ 小/ 理想/ 平均/ 时延/ 大/ 理想/ 吞吐量/ 低/ 物理/ 实现/ 难度/ 一般/ 高/ 可扩展性/ 较差/ 差/ 5.1/ 网络/ 直径/ 网络/ 直径/ 是/ 指/ 网络/ 中/ 任意/ 两/ 节点/ 间/ 距离/ 的/ 最大值/ [/ 3/ ]/ ./ 通常/ 情况/ 下/ ,/ 小/ 直径/ 片上/ 网络/ 数据传输/ 的/ 最大/ 时延/ 低/ ,/ 从而/ 具有/ 时延/ 优势/ ./ 本文/ 采用/ “/ 跳/ ”/ 作为/ 网络/ 直径/ 的/ 单位/ ./ 在/ n/ ×/ n/ ×/ l/ 的/ 网络/ 中/ ,/ 3DMesh/ 的/ 网络/ 直径/ 是/ (/ 2n/ +/ l/ -/ 3/ )/ ,/ V/ -/ Mesh/ 的/ 网络/ 直径/ 是/ 5/ ,/ F/ -/ Mesh/ 的/ 网络/ 直径/ 是/ 3/ ./ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 网络/ 直径/ 都/ 远远/ 小于/ 3DMesh/ ,/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 最大/ 时延/ 同样/ 要/ 小于/ 3DMesh/ 的/ 最大/ 时延/ ./ 虽然/ 单从/ 直径/ 上/ 看/ ,/ V/ -/ Mesh/ 的/ 网络/ 直径/ (/ 5/ “/ 跳/ ”/ )/ 比/ F/ -/ Mesh/ (/ 3/ “/ 跳/ ”/ )/ 的/ 要/ 大/ ,/ 但是/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 时延/ 几乎/ 相当/ ./ 主要/ 原因/ 是/ :/ 由于/ F/ -/ Mesh/ 采用/ 弯折/ 互连/ 线/ ,/ 和/ V/ -/ Mesh/ 结构/ 下/ 节点/ 间通信/ 时所/ 经过/ 的/ 长/ 互连/ 线/ 长度/ 基本一致/ ,/ 根据/ 表/ 2/ 数据/ ,/ 长/ 的/ 长/ 互连/ 线/ 的/ 时延/ 也/ 跟着/ 变/ 大/ ,/ 抵消/ 了/ 其/ 网络/ 直径/ 低/ 的/ 部分/ 优势/ ./ 这点/ 从/ 后面/ 的/ 实验/ 数据/ 中/ 也/ 可以/ 看出/ ./ 5.2/ (/ 长/ )/ 互连/ 线/ 规模/ 数片/ 上/ 网络拓扑/ 结构/ 中/ 的/ 互连/ 线条/ 数/ 的/ 多少/ 和/ 该片/ 上/ 网络/ 需要/ 的/ 功耗/ 有/ 很大/ 的/ 关系/ ./ 一般来说/ ,/ 在/ 保证/ 互通性/ 的/ 前提/ 下/ ,/ 片上/ 网络/ 应/ 布设/ 较少/ 的/ 互连/ 线/ 数目/ ./ 在/ N/ ×/ N/ ×/ L/ 的/ 网络/ 中/ ,/ V/ -/ Mesh/ 、/ F/ -/ Mesh/ 和/ 3DMesh/ 具有/ 同样/ 多/ 的/ 垂直/ 互连/ 线/ ,/ 但/ 其层/ 内/ 的/ 互连/ 线条/ 数/ 相差/ 较大/ ,/ 具体/ 为/ V/ -/ Mesh/ 需要/ 的/ 层/ 内长/ 互连/ 线条/ 数为/ C2/ 要/ 的/ 层/ 内长/ 互连/ 线条/ 数为/ C2Mesh/ 需要/ 的/ 层/ 内/ 互连/ 线条/ 数为/ 2/ (/ N/ -/ 1/ )/ ·/ N/ ·/ L/ ./ 从表/ 1/ 中/ 的/ 数据/ 可以/ 看出/ ,/ 2/ ·/ l/ 接近/ N/ ./ 故/ 3/ 种/ 结构/ 中/ ,/ 单从/ 互连/ 线/ 的/ 条数/ 来看/ ,/ 3DMesh/ 和/ V/ -/ Mesh/ 的/ 互连/ 线条/ 数/ 近似/ ,/ 均/ 远/ 少于/ F/ -/ Mesh/ 结构/ 的/ 互连/ 线条/ 数/ ./ 5.3/ 理想/ 吞吐量/ 对于/ 给定/ 的/ 拓扑/ 结构/ ,/ 其/ 理想/ 吞吐量/ [/ 19/ ]/ 是/ 指/ 在/ 完美/ 的/ 流控/ 和/ 路由/ 机制/ 下/ ,/ 网络/ 中/ 所/ 达到/ 的/ 最大/ 吞吐量/ ./ 文献/ [/ 19/ ]/ 给出/ 的/ 理想/ 吞吐量/ 公式/ 如下/ :/ 式/ (/ 7/ )/ 中/ ,/ BC/ 是/ 把/ 整个/ 网络/ 分成/ 均等/ 的/ 两半/ 所/ 需要/ 的/ 通道/ 个数/ ,/ b/ 是/ 每个/ 通道/ 的/ 数据/ 宽度/ ,/ N/ 是/ 总/ 节点/ 的/ 数目/ ./ 对于/ 4/ ×/ 4/ ×/ 2/ 的/ 3DMesh/ ,/ N/ =/ 32/ ,/ BC/ =/ 16/ ,/ 要/ 想/ 把/ 3DMesh/ 分成/ 两半/ ,/ 需要/ 切开/ 8/ 条边/ ,/ 每个/ 边/ 又/ 都/ 是/ 双向/ 的/ ,/ 所以/ BC/ =/ 16/ ;/ 对于/ 同样/ 规模/ 的/ V/ -/ Mesh/ ,/ N/ =/ 32/ ,/ BC/ =/ 24/ ,/ 要/ 想/ 把/ V/ -/ Mesh/ 分成/ 两半/ ,/ 需要/ 切开/ 12/ 条边/ ;/ 对于/ 同样/ 规模/ 的/ F/ -/ Mesh/ ,/ N/ =/ 32/ ,/ BC/ =/ 72/ ,/ 要/ 想/ 把/ F/ -/ Mesh/ 分成/ 两半/ ,/ 需要/ 切开/ 36/ 条边/ ./ 由此/ ,/ 得出/ 三者/ 的/ 吞吐量/ 大小/ 依次/ 为/ THideal/ ,/ 3DMesh/ / THideal/ ,/ V/ -/ Mesh/ / THideal/ ,/ F/ -/ Mesh/ ./ 总的说来/ ,/ V/ -/ Mesh/ 的/ 理想/ 吞吐量/ 比/ 3DMesh/ 的/ 大/ ,/ 比/ F/ -/ Mesh/ 的/ 小/ ./ 5.4/ 理想/ 平均/ 时延/ 理想/ 平均/ 时延/ [/ 19/ ]/ 是/ 指/ 假设/ 在/ 路由/ 过程/ 中/ 没有/ 拥塞/ 发生/ ,/ 对于/ 给定/ 的/ 拓扑/ 中/ 的/ 所有/ 节点/ 对/ 之间/ 的/ 平均/ 路由/ 时延/ ./ 文献/ [/ 19/ ]/ 给出/ 了/ 理想/ 平均/ 时延/ 的/ 公式/ :/ H/ 是/ 指/ 从源/ 节点/ 到/ 目标/ 节点/ 的/ 平均/ 跳数/ ,/ Tr/ 是/ 单个/ 路由器/ 上/ 的/ 延时/ ,/ D/ 是从/ 源/ 节点/ 到/ 目标/ 节点/ 的/ 平均/ 距离/ ./ 通常/ 情况/ 下/ ,/ H/ 等于/ D/ ./ v/ 是/ 线/ 上/ 的/ 传输速度/ ,/ L/ 是/ 数据包/ 的/ 长度/ ,/ b/ 是/ 带宽/ ./ 在/ 不同/ 的/ 拓扑/ 结构/ 中/ ,/ H/ 的/ 值/ 是/ 不/ 一样/ 的/ ,/ Tr/ 依赖于/ 路由器/ 的/ 物理/ 实现/ ./ 式/ (/ 8/ )/ 得知/ ,/ 计算/ 平均/ 时延/ 主要/ 是/ 计算/ H/ ./ 为了/ 与/ 3DMesh/ 、/ F/ -/ Mesh/ 比较/ 理想/ 平均/ 时延/ ,/ 需要/ 分别/ 计算/ 3/ 种/ 结构/ 的/ 平均/ 跳数/ ./ 根据/ 文献/ [/ 20/ ]/ Page9/ 可知/ ,/ 当/ 网络/ 规模/ 为/ n/ ×/ n/ ×/ l/ 时/ ,/ 3DMesh/ 结构/ 的/ 节点/ 间/ 平均/ 跳数/ 计算公式/ 如下/ :/ 给定/ 网络/ 规模/ 为/ n/ ×/ n/ ×/ l/ 的/ V/ -/ Mesh/ 结构/ ,/ 对于/ 指定/ 的/ 节点/ X/ 来说/ ,/ 拓扑/ 中/ 的/ 其它/ 节点/ 可以/ 按/ 与/ 该/ 节点/ 的/ 位置/ 关系/ ,/ 分为/ 和/ 该/ 节点/ 处于/ 同面/ 的/ 以及/ 和/ 该/ 节点/ 不/ 处于/ 同面/ 的/ 两类/ 节点/ ./ 分别/ 计算/ 这/ 两类/ 节点/ 到/ 节点/ X/ 的/ 距离/ :/ 和/ 该/ 节点/ 处于/ 同一/ 纵面/ 的/ 节点/ 到/ 该/ 节点/ 的/ 距离/ 为/ HV/ -/ Mesh/ (/ 同面/ )/ =/ 3/ ·/ (/ n/ ·/ l/ -/ 2/ ·/ l/ )/ +/ 2/ ·/ l/ +/ l/ (/ 10/ )/ 和/ 该/ 节点/ 处于/ 不同/ 面/ 的/ 节点/ 到/ 该/ 节点/ 的/ 距离/ :/ HV/ -/ Mesh/ (/ 异面/ )/ =/ 5/ ·/ (/ n/ ·/ l/ -/ 2/ ·/ l/ )/ +/ 4/ ·/ l/ +/ 3l/ (/ 11/ )/ 式/ (/ 10/ )/ 和/ 式/ (/ 11/ )/ 中/ ,/ 符号/ 前面/ 的/ 系数/ 表示/ 距离/ ,/ 即/ “/ 跳/ ”/ 数/ ,/ 与/ 之/ 相乘/ 的/ 是/ 节点/ 数/ ./ 综合/ 式/ (/ 10/ )/ 、/ 式/ (/ 11/ )/ ,/ 得出/ 节点/ 间/ 的/ 平均/ 跳数/ 为/ 代入/ 式/ (/ 10/ )/ 、/ 式/ (/ 11/ )/ ,/ 得出/ HV/ -/ Mesh/ =/ 8/ ·/ (/ n/ ·/ l/ -/ 2/ ·/ l/ )/ +/ 6/ ·/ l/ +/ 4/ ·/ l/ 给定/ 网络/ 规模/ 为/ n/ ×/ n/ ×/ l/ 的/ F/ -/ Mesh/ 结构/ ,/ 对于/ 指定/ 的/ 节点/ X/ 来说/ ,/ 拓扑/ 结构/ 中/ 的/ 其它/ 节点/ 可以/ 按/ 与/ 该/ 节点/ 的/ 位置/ 关系/ ,/ 分为/ 和/ 该/ 节点/ 处于/ 同层/ 的/ 、/ 同列/ 的/ 、/ 靠近/ 该/ 节点/ 所在/ 层/ 的/ 那层/ 节点/ ,/ 以及/ 其余/ 节点/ 4/ 大类/ ./ 分别/ 计算/ 这/ 4/ 大类/ 节点/ 到/ 节点/ X/ 的/ 距离/ :/ 和/ 该/ 节点/ 处于/ 同层/ 以及/ 和/ 该/ 节点/ 处于/ 同列/ 的/ 节点/ 数/ 总共/ 为/ (/ n/ ·/ n/ -/ 1/ )/ +/ (/ l/ -/ 1/ )/ =/ n/ ·/ n/ +/ l/ -/ 2/ ,/ 这些/ 节点/ 到/ X/ 的/ 跳/ 数为/ 1/ ;/ 靠近/ 该/ 节点/ 所在/ 层/ 的/ 那层/ 节点/ 数为/ n/ ·/ n/ -/ 1/ ,/ 其中/ 减/ 1/ 是/ 减去/ 和/ X/ 处于/ 同列/ 的/ 那个/ 节点/ ,/ 这些/ 节点/ 到/ X/ 的/ 跳/ 数为/ 2/ ;/ 其余/ 节点/ 到/ X/ 的/ 距离/ 为/ 3/ ,/ 这些/ 节点/ 的/ 节点/ 数为/ n/ ·/ n/ ·/ l/ -/ (/ n/ ·/ n/ +/ l/ -/ 2/ )/ -/ (/ n/ ·/ n/ -/ 1/ )/ =/ n/ ·/ n/ (/ l/ -/ 2/ )/ -/ l/ -/ 3/ ./ 依据/ 上面/ 数据/ ,/ 得出/ F/ -/ Mesh/ 结构/ 的/ 节点/ 间/ 的/ 平均/ 跳数/ 为/ HF/ -/ Mesh/ =/ 1/ ·/ (/ n/ ·/ n/ +/ l/ -/ 2/ )/ +/ 2/ ·/ (/ n/ ·/ n/ -/ 1/ )/ +/ 3/ ·/ (/ n/ ·/ n/ (/ l/ -/ 2/ )/ -/ l/ -/ 3/ )/ =/ 3/ -/ 3l/ -/ 2/ 为/ 简化/ 分析/ ,/ 这里/ 假定/ 3/ 种/ 网络/ 的/ 路由器/ 延时/ 相同/ ,/ 相邻/ 节点/ 间/ 的/ 距离/ 相等/ ,/ 线上/ 的/ 传输速度/ 和/ 带宽/ 相同/ ,/ 数据包/ 的/ 长度/ 相等/ ./ 由式/ (/ 8/ )/ 可知/ ,/ 理想/ 平均/ 时延/ 只/ 与/ H/ 有关/ ./ 综合/ 式/ (/ 9/ )/ 、/ 式/ (/ 11/ )/ 和/ 式/ (/ 14/ )/ ,/ 当/ 网络/ 规模/ 为/ 4/ ×/ 4/ ×/ 2/ 时/ ,/ 3/ 种/ 拓扑/ 的/ 平均/ 跳数/ 分别/ 为/ H3DMesh/ =/ 2.75/ ,/ HV/ -/ Mesh/ =/ 3.25/ ,/ HF/ -/ Mesh/ =/ 1.5/ ;/ 当/ 网络/ 规模/ 为/ 22/ ×/ 22/ ×/ 10/ 时/ ,/ 3/ 种/ 拓扑/ 的/ 平均/ 跳数/ 分别/ 为/ H3DMesh/ =/ 17.94/ ,/ HV/ -/ Mesh/ =/ 3.86/ ,/ HF/ -/ Mesh/ =/ 2.7/ ./ 这些/ 数据/ 表明/ ,/ 当/ 网络/ 中/ 节点/ 数较/ 多时/ ,/ 3DMesh/ 的/ 理想/ 平均/ 时延/ 远远/ 大于/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ ,/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 理想/ 平均/ 时延/ 相差/ 不大/ ./ 5.5/ 物理/ 实现/ 难度/ 物理/ 实现/ 难度/ 主要/ 取决于/ 结构/ 的/ 维数/ 、/ 路由/ switch/ 基数/ (/ 即/ 端口数/ )/ 以及/ 路由/ 算法/ 复杂度/ ./ 这/ 3/ 种/ 结构/ 都/ 是/ 三维/ 结构/ ,/ 三者/ 的/ 路由/ 算法/ 都/ 比较简单/ ./ 然而/ ,/ 也/ 存在/ 一些/ 不/ 一样/ 的/ 地方/ :/ 从/ 路由/ 基数/ 来看/ ,/ 3DMesh/ 结构/ 的/ 路由/ 基数/ 为/ 5/ ,/ F/ -/ Mesh/ 结构/ 和/ V/ -/ Mesh/ 结构/ 的/ 路由/ 基数/ 在/ 3/ ~/ 4/ 之间/ ./ 另外/ ,/ F/ -/ Mesh/ 中/ ,/ 通过/ 弯折/ 互连/ 线/ 连接/ 不/ 在/ 同一/ 行/ 和/ 同一/ 列/ 的/ 两个/ 节点/ ,/ 该种/ 布线/ 策略/ 无疑/ 也/ 加大/ 了/ 物理/ 实现/ 的/ 难度/ ./ 因此/ ,/ 全面/ 来看/ ,/ V/ -/ Mesh/ 的/ 物理/ 实现/ 难度/ 在/ 三者/ 中是/ 最低/ 的/ ./ 5.6/ 可扩展性/ 片上/ 网络拓扑/ 的/ 可扩展性/ 主要/ 是从/ 系统/ 易用/ 的/ 角度/ 来/ 考虑/ 的/ ./ 随着/ 工艺技术/ 的/ 持续/ 发展/ ,/ 片上/ 网络拓扑/ 需要/ 容纳/ 越来越/ 多/ 的/ 节点/ ,/ 并且/ 其/ 特性/ 不能/ 随着/ 节点/ 数/ 的/ 增多/ 而/ 减弱/ ./ F/ -/ Mesh/ 结构/ 最/ 多/ 只能/ 支持/ 36/ 个/ 节点/ ,/ 超出/ 后/ 需要/ 采用/ 分组/ 、/ 多级网络/ 互连/ ,/ 可扩展性/ 差/ ;/ 而/ 3DMesh/ 结构/ 虽然/ 能够/ 支持/ 很多/ 的/ 节点/ 数/ ,/ 但是/ ,/ 其/ 网络/ 直径/ 和/ 理想/ 平均/ 延时/ 随/ 节点/ 数/ 的/ 增加/ 而/ 线性/ 增长/ ,/ 可扩展性/ 较差/ ./ V/ -/ Mesh/ 具有/ 良好/ 的/ 可扩展性/ ,/ 该/ 结构/ 能/ 支持/ 任意/ 多/ 的/ 节点/ ,/ 而且/ 其/ 网络/ 直径/ 不随/ 节点/ 数/ 的/ 增加/ 而/ 变化/ ./ 由于/ 文献/ [/ 10/ ]/ 中对线/ 的/ 面积/ 对/ 布局/ 布线/ 的/ 影响/ 进行/ 了/ 专门/ 的/ 论证/ ,/ V/ -/ Mesh/ 采用/ 类似/ 文献/ [/ 10/ ]/ 的/ 技术/ ,/ 同样/ 在/ 布局/ 布线/ 方面/ 具有/ 可行性/ ./ 另外/ ,/ 注意/ 到/ N/ ×/ N/ ×/ N/ 规模/ 的/ V/ -/ Mesh/ 的/ 片/ 内长/ 连线/ 数量级/ 达到/ 了/ O/ (/ N3/ )/ ,/ 当/ 节点/ 规模/ 数/ 持续/ 增大/ 时/ ,/ 连线/ 数量/ 显著/ 增加/ ,/ 这/ 将/ 不可避免/ 的/ 加大/ Page10V/ -/ Mesh/ 的/ 物理/ 实现/ 难度/ ./ 在/ 综合/ 权衡/ 布局/ 布线/ 复杂度/ 和/ 时延/ 、/ 吞吐量/ 之间/ 折衷/ 情况/ 下/ ,/ 采用/ F/ -/ Mesh/ 中/ 类似/ 的/ 方法/ ,/ 通过/ 对/ 节点/ 进行/ 分组/ 和/ 多级网络/ 互连/ 的/ 实现/ 方式/ ,/ 组内/ 节点/ 可以/ 共用/ 一条/ 长/ 互连/ 线/ ,/ 这样/ 能够/ 大大降低/ 物理/ 布线/ 的/ 复杂度/ ./ 同样/ ,/ 通过/ 该种/ 方法/ ,/ 能够/ 在/ 物理/ 布线/ 同样/ 复杂/ 的/ 情况/ 下/ ,/ 支持/ 更/ 多/ 数量/ 的/ 节点/ 互连/ ./ 6/ 性能/ 分析/ 文献/ [/ 10/ ]/ 中/ 对/ F/ -/ Mesh/ 进行/ 了/ 完备/ 的/ trace/ 实验/ ,/ 通过/ 相关/ 实验/ 充分/ 论证/ 了/ 长/ 互连/ 线/ 、/ 多层/ 三维/ 堆叠/ 芯片/ 技术/ 的/ 可行性/ ./ 为/ 突出/ 优势/ ,/ 在/ 第/ 5/ 节对/ V/ -/ Mesh/ 、/ F/ -/ Mesh/ 和/ 3DMesh/ 拓扑/ 进行/ 了/ 充分/ 的/ 理论/ 评估/ ,/ 在/ 性能/ 分析/ 部分/ ,/ 本/ 节/ 主要/ 对/ 上述/ 3/ 种/ 拓扑/ 进行/ 实验/ 评测/ ./ 本节/ 主要/ 对/ 3DMesh/ 、/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 三种/ 结构/ 进行/ 吞吐量/ 、/ 时延/ 和/ 功耗/ 方面/ 的/ 对比/ ./ 考虑/ 到/ F/ -/ Mesh/ 拓扑/ 结构/ 在/ 不/ 分组/ 的/ 情况/ 下/ 最大/ 仅/ 支持/ 36/ 个/ 节点/ ,/ 性能/ 评估/ 实验/ 分/ 两组/ 进行/ :/ 一组/ 是/ 在/ 36/ 个/ 节点/ 的/ 情况/ 下/ 对/ 3/ 个/ 结构/ 进行/ 比较/ ;/ 另一组/ 是/ 在/ 361/ 个/ 节点/ (/ 19/ ×/ 19/ )/ 的/ 情况/ 下/ 对/ 3DMesh/ 和/ V/ -/ Mesh/ 两种/ 结构/ 进行/ 比较/ ,/ 模拟/ 众/ 核对/ 节点/ 数/ 要求/ 多/ 的/ 情况/ ./ 6.1/ 仿真/ 实验/ 平台/ 本文/ 采用/ Noxim/ 片上/ 网络/ 模拟器/ ①/ 搭建/ 仿真/ 实验/ 平台/ ./ 这是/ 一个/ 用/ System/ C语言/ 编写/ 的/ 周期/ 准确/ 的/ 片/ 上/ 网络/ 模拟器/ ,/ 能够/ 比较/ 详细/ 的/ 模拟/ 片上/ 网络/ 中/ 功能/ 部件/ 的/ 主要/ 行为/ ./ 为/ 能够/ 模拟/ 3DMesh/ 、/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 三种/ 结构/ ,/ 从/ 节点/ 度数/ 、/ 端口/ 连接/ 、/ 信号/ 使能/ 等/ 方面/ 对/ Noxim/ 进行/ 了/ 修改/ ,/ 设置/ 了/ 相应/ 的/ 路由/ 算法/ ./ 另外/ ,/ 通过/ 设置/ 两/ 节点/ 间/ 的/ 连接/ 路由表/ ,/ 以及/ 相应/ 的/ 时延/ 和/ 功耗/ 参数/ 来/ 对/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 中/ 的/ 长/ 互连/ 线/ 及其/ 通信/ 进行/ 模拟/ ./ 根据/ 表/ 2/ 、/ 表/ 3/ 对/ 互连/ 线/ 进行/ 参数设置/ ,/ 3DMesh/ 中/ 互连/ 线/ 功耗/ 和/ 时延/ 参照/ 表/ 2/ 中/ 1hop/ 的/ 互连/ 线/ 设置/ ,/ 路由器/ 的/ 其它/ 参数/ 参照/ Orion2/ ./ 0/ [/ 21/ ]/ 设置/ ./ 实验/ 平台/ 参数设置/ 为/ :/ warmup/ 为/ 5000cycles/ ,/ sim/ 总共/ 模拟/ 时间/ 25000cycles/ ,/ 数据包/ 大小/ 设置/ 为/ 4flits/ ,/ 数据/ 注入/ 速率/ 单位/ 为/ packets/ // (/ node/ ·/ cycle/ )/ ./ 6.2/ 小规模/ 节点/ 实验/ 本/ 小节/ 在/ 36/ 个/ 节点/ 的/ 小规模/ 数/ 情况/ 下/ ,/ 比较/ 3/ 个/ 结构/ 的/ 时延/ 、/ 功耗/ 和/ 吞吐量/ 情况/ ./ 图/ 7/ 给出/ 了/ 3DMesh/ 、/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 三种/ 结构/ 在/ 36/ 个/ 节点/ 时/ 的/ 时延/ 对比/ 情况/ ./ 从图/ 中/ 可以/ 看出/ ,/ F/ -/ Mesh/ 的/ 时延/ 最小/ ,/ 3DMesh/ 的/ 时延/ 最大/ ,/ V/ -/ Mesh/ 的/ 时延/ 介于/ F/ -/ Mesh/ 和/ 3DMesh/ 之间/ ./ V/ -/ Mesh/ 的/ 时延/ 大约/ 超出/ F/ -/ Mesh/ 时延/ 的/ 1/ %/ ~/ 10/ %/ ,/ 大概/ 是/ 3DMesh/ 时延/ 的/ 70/ %/ ~/ 80/ %/ ./ 主频/ 较/ 高时/ (/ 3GHz/ )/ ,/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 具有/ 几乎/ 相当/ 的/ 时延/ ./ 实验/ 结果/ 和/ 5.4/ 节中/ 的/ 理论/ 分析/ 结论/ 一致/ ./ 图/ 8/ 给出/ 了/ 3DMesh/ 、/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 三种/ 结构/ 在/ 36/ 个/ 节点/ 时/ 的/ 吞吐量/ 对比/ 情况/ ,/ 其中/ 3DMesh/ 的/ 吞吐量/ 规约/ 为/ 1/ (/ 为/ 不失/ 一般性/ ,/ 这里/ 以/ 随机/ 测试/ 来/ 进行/ 评估/ ,/ 下同/ )/ ./ 从图/ 中/ 可以/ 看出/ ,/ F/ -/ Mesh/ 的/ 吞吐量/ 最大/ ,/ 3DMesh/ 的/ 吞吐量/ 最小/ ./ V/ -/ Mesh/ 的/ 吞吐量/ 大约/ 是/ F/ -/ Mesh/ 的/ 90/ %/ ~/ 98/ %/ ,/ 大约/ 超出/ 3DMesh/ 的/ 5/ %/ ~/ 10/ %/ ,/ 实验/ 结果/ 和/ 5.3/ 节中/ 的/ 理论/ 分析/ 情况/ 一致/ ./ 图/ 9/ 给出/ 了/ 3DMesh/ 、/ F/ -/ Mesh/ 和/ V/ -/ Mesh/ 三种/ 结构/ 在/ 36/ 个/ 节点/ 、/ 网络/ 频率/ 为/ 高频/ 时/ 的/ 功耗/ 对比/ 情况/ ,/ 其中/ 3DMesh/ 结构/ 的/ 功耗/ 规约/ 为/ 1/ ./ 从图/ 中/ 可以/ 看出/ ,/ F/ -/ Mesh/ 的/ 功耗/ 大约/ 是/ 3DMesh/ 的/ 80/ %/ ~/ 93/ %/ ,/ V/ -/ Mesh/ 的/ 功耗/ 大约/ 是/ 3DMesh/ 的/ 70/ %/ ~/ 90/ %/ ,/ V/ -/ Mesh/ 能比/ F/ -/ Mesh/ 减少/ 3.2/ %/ ~/ 12.5/ %/ 的/ 功耗/ ./ 另外/ ,/ 3DMesh/ 中/ 互连/ 线/ 的/ 功耗/ 占/ 到/ 了/ 整个/ 功耗/ 的/ 70/ %/ 左右/ ,/ F/ -/ Mesh/ 中/ 互连/ 线/ 的/ 功耗/ 占/ 到/ 了/ 65/ %/ 左右/ ,/ 而/ V/ -/ Mesh/ 中/ 互连/ 线/ 的/ 功耗/ 占/ 到/ 了/ 55/ %/ 左右/ ./ 如/ 5.3/ 节中/ 的/ 理论/ 分析/ ,/ 虽然/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 长/ 互连/ 线/ 数目/ 比/ 3DMesh/ 的/ 要/ 多/ ,/ 但是/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 的/ 功耗/ 比/ 3DMesh/ 的/ 反而/ 要/ 更/ 低/ 一些/ ./ 主要/ 原因/ 是/ :/ (/ 1/ )/ 采用/ 了/ 泄漏/ 还原/ 技术/ (/ leakagereductiontechnique/ )/ ,/ 该/ 技术/ 能/ 有效/ 隔断/ 暂时/ 没有/ 数据传输/ 的/ 互连/ 线/ [/ 10/ ]/ ,/ 并/ 能/ 在/ 数据/ 到来/ 时/ 及时/ 接通/ 互连/ 线/ ,/ 从而/ 省下/ 空闲/ 状态/ 时/ 的/ 互连/ 线/ 功耗/ ;/ (/ 2/ )/ 由于/ 减少/ 了/ 路由/ 上/ 的/ 功耗/ ,/ n/ -/ hop/ 的/ 长/ 互连/ 线/ 方案/ 要/ 比/ n/ 个/ 1/ -/ hop/ 的/ 短/ 互连/ 线/ 方案/ 节省/ 功耗/ ;/ (/ 3/ )/ 在/ V/ -/ Mesh/ 和/ F/ -/ Mesh/ 结构/ 中/ ,/ 由于/ 经过/ 的/ “/ 跳/ ”/ 数少/ ,/ 数据传输/ 过程/ 中/ 能够/ 减少/ 对/ 链路/ 的/ 竞争/ ,/ 从而/ 减少/ 功耗/ ./ 而/ V/ -/ Mesh/ 比/ F/ -/ Mesh/ 功耗/ 低/ 的/ 主要/ 原因/ ,/ 是/ 在/ 网络/ 直径/ 仅/ 增加/ 2/ “/ 跳/ ”/ 的/ 情况/ 下/ ,/ V/ -/ Mesh/ 比/ F/ -/ Mesh/ 少/ 需要/ 很多/ 的/ 互连/ 线/ ,/ 减少/ 了/ 功耗/ ./ ①/ PalesiM/ ,/ PattiD/ ,/ FazzinoF/ ./ Noxim/ :/ AnOpenNetwork/ -/ Page11/ 图/ 73/ 种/ 结构/ 时延/ 比较/ (/ 36/ 节点/ 数/ )/ 图/ 83/ 种/ 结构/ 吞吐量/ 比较/ (/ 36/ 节点/ 数/ )/ 6.3/ 大规模/ 节点/ 实验/ 由于/ 众核/ 中/ 节点/ 数均/ 很多/ ,/ 故本/ 小节/ 在/ 361/ 个/ 节点/ (/ 19/ ×/ 19/ )/ 的/ 情况/ 下/ ,/ 对/ V/ -/ Mesh/ 和/ 3DMesh/ 两种/ 结构/ 的/ 时延/ 、/ 功耗/ 和/ 吞吐量/ 进行/ 比较/ ./ 图/ 10/ 给出/ 了/ 3DMesh/ 和/ V/ -/ Mesh/ 两种/ 结构/ 在/ 361/ 个/ 节点/ (/ 19/ ×/ 19/ )/ 时/ 的/ 时延/ 对比/ 情况/ (/ 同样/ ,/ 为/ 不失/ 一般性/ ,/ 这里/ 以/ 随机/ 测试/ 来/ 进行/ 评估/ ,/ 下同/ )/ ./ 从图/ 中/ 可以/ 看出/ ,/ 在/ 节点/ 数较/ 多/ 的/ 情况/ 下/ ,/ 相比/ 于/ 3DMesh/ ,/ V/ -/ Mesh/ 具有/ 较强/ 的/ 时延/ 优势/ ./ V/ -/ Mesh/ 的/ 时/ Page12/ 延/ 大约/ 是/ 3DMesh/ 的/ 72/ %/ ~/ 95/ %/ ./ 主要/ 的/ 原因/ 是/ ,/ V/ -/ Mesh/ 的/ 网络/ 直径/ 仅为/ 5/ “/ 跳/ ”/ ,/ 而/ 361/ 个/ 节点/ 下/ 3DMesh/ 结构/ 的/ 网络/ 直径/ 为/ 36/ “/ 跳/ ”/ ,/ 后者/ 的/ 网络/ 直径/ 远大于/ 前者/ 的/ 网络/ 直径/ ,/ 过多/ 的/ 网络/ 直径/ 导致/ 有/ 较/ 长/ 的/ 传输/ 时延/ ./ 实验/ 结果/ 同样/ 和/ 5.3/ 节中/ 的/ 理论/ 分析/ 结论/ 一致/ ./ 图/ 11/ 给出/ 了/ 3DMesh/ 和/ V/ -/ Mesh/ 两种/ 结构/ 在/ 361/ 个/ 节点/ 时/ 的/ 吞吐量/ 对比/ 情况/ ,/ 其中/ 3DMesh/ 结图/ 10/ 两种/ 结构/ 时延/ 比较/ (/ 361/ 节点/ 数/ )/ 图/ 11/ 两种/ 结构/ 吞吐量/ 比较/ (/ 361/ 节点/ 数/ )/ 构/ 的/ 吞吐量/ 规约/ 为/ 1/ ./ 从图/ 中/ 可以/ 看出/ ,/ V/ -/ Mesh/ 的/ 吞吐量/ 大约/ 超出/ 3DMesh/ 的/ 5/ %/ ~/ 12/ %/ ./ 主要/ 的/ 原因/ 是/ V/ -/ Mesh/ 比/ 3DMesh/ 的/ 互通/ 链路/ 略/ 多/ ,/ 而且/ V/ -/ Mesh/ 的/ 行/ // 列/ 互连/ 结构/ 更/ 有助于/ 提高/ 吞吐量/ ./ 同时/ ,/ V/ -/ Mesh/ 的/ 网络/ 直径/ 低/ ,/ 也/ 能/ 减少/ 数据传输/ 时/ 对/ 链路/ 的/ 竞争/ 冲突/ 次数/ ,/ 有助于/ 提高/ 其/ 吞吐量/ ./ 图/ 12/ 给出/ 了/ 3DMesh/ 和/ V/ -/ Mesh/ 两种/ 结构/ 在/ 361/ 个/ 节点/ 、/ 网络/ 高频率/ 时/ 的/ 功耗/ 对比/ 情况/ ,/ 其中/ 3DMesh/ 结构/ 的/ 功耗/ 规约/ 为/ 1/ ./ 从图/ 中/ 可以/ 看出/ ,/ V/ -/ Mesh/ 的/ 功耗/ 大约/ 是/ 3DMesh/ 的/ 66/ %/ ~/ 76/ %/ ./ 另外/ ,/ 互连/ 线/ 在/ 各个/ 拓扑/ 中所/ 占/ 的/ 功耗/ 比例/ 跟/ 前面/ 的/ 实验/ 类似/ ./ 7/ 结束语/ 3D/ 堆叠/ 封装/ 技术/ 具有/ 很强/ 的/ 优势/ ,/ 除了/ 小/ 尺寸/ 、/ 高/ 硅片/ 利用率/ 、/ 低/ 信号/ 传输/ 延迟/ 和/ 高/ 系统/ 性能/ 等/ 优点/ 外/ ,/ 3D/ 堆叠/ 方式/ 也/ 不会/ 增加/ 封装/ 方面/ 的/ 成本/ ./ 其/ 原因/ 在于/ ,/ 3D/ 堆叠/ 技术/ 对/ 功能/ 复杂/ 的/ 芯片/ 做/ 了/ 小/ Page13/ 型化/ 处理/ ,/ 小/ 的/ 芯片/ 能/ 在/ 生产/ 过程/ 中/ 带来/ 较/ 高/ 的/ 良率/ ,/ 有助于/ 降低/ 整个/ 芯片/ 的/ 生产成本/ ./ 基于/ 三维/ 堆叠/ 技术/ ,/ 本文/ 所/ 提出/ 的/ V/ -/ Mesh/ ,/ 是/ 一种/ 低/ 直径/ 和/ 低功耗/ 的/ 三维/ 片上/ 网络/ ,/ 支持/ 任何/ 节点/ 数/ ,/ 可扩展性/ 强/ ,/ 克服/ 了/ F/ -/ Mesh/ 结构/ 扩展性/ 差/ 的/ 缺点/ ,/ 具有/ 时延/ 低/ 、/ 吞吐量/ 大/ 、/ 便于/ 实现/ 和/ 功耗/ 适合/ 的/ 优点/ ./ 通过/ 理论/ 分析/ 和/ 实验/ 证明/ ,/ 与/ 3DMesh/ 、/ F/ -/ Mesh/ 结构/ 相比/ ,/ V/ -/ Mesh/ 的/ 时延/ 、/ 吞吐量/ 和/ 能耗/ 均/ 有/ 极佳/ 表现/ ./ 下/ 一步/ 的/ 工作/ 将/ 在/ 片/ 上/ 网络/ V/ -/ Mesh/ 的/ 基础/ 上/ ,/ 充分利用/ 其低/ 直径/ 、/ 低/ 时延/ 的/ 特点/ ,/ 构建/ 基于/ 行/ // 列/ 互连/ 的/ 片/ 上/ Cache/ (/ SRAM/ )/ 存储体系/ ,/ 拟/ 进行/ 符合/ 大/ 数据/ 计算/ 特点/ 的/ 3D/ 众核微/ 体系结构/ 设计/ ./ 致谢/ 薛立成/ 博士/ 和/ 国防科技大学/ 吴/ 俊杰/ 教授/ 给予/ 了/ 帮助/ ,/ 审稿/ 专家/ 对/ 本文/ 提出/ 了/ 宝贵意见/ ,/ 在/ 此/ 一并/ 表示感谢/ !/ 

