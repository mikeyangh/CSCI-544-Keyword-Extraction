Page1/ 一种/ 基于/ 文法/ 压缩/ 的/ 日志/ 异常/ 检测/ 算法/ 1/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息内容/ 安全/ 技术/ 国家/ 工程/ 实验室/ 北京/ 100093/ )/ 2/ )/ (/ 中国科学院/ 大学/ 计算机/ 与/ 控制/ 学院/ 北京/ 100049/ )/ 摘要/ 近年来/ 日志/ 挖掘/ 是/ 一种/ 广泛/ 使用/ 的/ 检测/ 应用/ 状态/ 异常/ 的/ 方法/ ./ 现有/ 的/ 异常/ 检测/ 算法/ 需要/ 大量/ 计算/ ,/ 或者/ 它们/ 的/ 有效性/ 依赖于/ 测试日志/ 满足/ 一些/ 预先/ 定义/ 的/ 日志/ 事件/ 概率分布/ ./ 因此/ ,/ 它们/ 无法/ 用于/ 在线/ 检测/ 并且/ 在/ 假设/ 不/ 成立/ 时会/ 失效/ ./ 为了/ 解决/ 这些/ 问题/ ,/ 该文/ 提出/ 了/ 一种/ 新/ 的/ 异常/ 检测/ 算法/ CADM/ ./ CADM/ 使用/ 正常/ 日志/ 和/ 待/ 检测/ 日志/ 之间/ 的/ 相对/ 熵/ 作为/ 异常/ 程度/ 的/ 标识/ ./ 为了/ 计算/ 相对/ 熵/ ,/ CADM/ 充分利用/ 了/ 相对/ 熵/ 和/ 文法/ 压缩/ 编码/ 大小/ 之间/ 的/ 关系/ 而/ 不是/ 预先/ 定义/ 日志/ 事件/ 概率分布/ 的/ 族/ ./ 通过/ 这种/ 方式/ ,/ CADM/ 避免/ 了/ 对/ 日志/ 分布/ 的/ 预先/ 假设/ ./ 除此之外/ ,/ CADM/ 的/ 计算/ 复杂度/ 为/ O/ (/ n/ )/ ,/ 因此/ 在/ 日志/ 较大/ 的/ 情况/ 下有/ 较/ 好/ 的/ 扩展性/ ./ 通过/ 在/ 仿真/ 的/ 日志/ 和/ 公开/ 日志/ 集上/ 的/ 评测/ 结果/ 可以/ 看出/ ,/ CADM/ 不仅/ 可以/ 应用/ 在/ 更/ 广泛/ 的/ 程序/ 日志/ 上/ ,/ 也/ 有/ 更/ 高/ 的/ 检测/ 精度/ ,/ 因此/ 更/ 适合/ 在线/ 日志/ 挖掘/ 异常/ 检测/ 的/ 工作/ ./ 关键词/ 异常/ 检测/ ;/ 文法/ 压缩/ ;/ 日志/ 挖掘/ ;/ 相对/ 熵/ 1/ 引言/ 随着/ 互联网/ 的/ 不断/ 发展/ ,/ 各类/ 网络应用/ 在/ 生产/ 生活/ 中/ 发挥/ 着/ 越来越/ 重要/ 的/ 作用/ ./ 但/ 与此同时/ ,/ 针对/ 网络应用/ 的/ 攻击/ 不断涌现/ ,/ 如/ 各类/ 病毒/ 、/ 蠕虫/ 等/ ①/ ./ 另一方面/ ,/ 随着/ 网络应用/ 规模/ 的/ 不断/ 增大/ 以及/ 为/ 节省成本/ 使用/ 廉价/ 机器/ 部署/ 服务/ 的/ 趋势/ 的/ 发展/ ,/ 程序/ 的/ 执行/ 路径/ 难以预测/ ,/ 并且/ 硬件/ 环境/ 不再/ 可靠/ ,/ 因此/ 难以/ 在/ 部署/ 前/ 发现/ 所有/ 可能/ 的/ 错误/ ./ 一旦/ 针对/ 网络应用/ 的/ 攻击/ 得手/ 或者/ 网络应用/ 自身/ 出现异常/ ,/ 将/ 给/ 应用/ 的/ 所有者/ 及/ 用户/ 带来/ 不可估量/ 的/ 损失/ ②/ ./ 攻击/ 和/ 错误/ 发现/ 得/ 越/ 早/ ,/ 所/ 能/ 采用/ 的/ 补救措施/ 就/ 越/ 多/ ,/ 造成/ 的/ 损失/ 就会/ 越少/ ./ 因此/ ,/ 在线/ 异常/ 检测/ 受到/ 了/ 学术界/ 和/ 工业界/ 的/ 广泛/ 重视/ ./ 常用/ 的/ 异常/ 检测/ 方法/ 是/ 分析/ 应用/ 的/ 日志/ ./ 在/ 应用/ 运行/ 的/ 过程/ 中/ ,/ 应用/ 本身/ 和/ 监控/ 程序/ 都/ 会/ 产生/ 各类/ 日志/ 来/ 记录/ 应用/ 的/ 状态/ 、/ 重要/ 的/ 运行/ 事件/ 和/ 网络流量/ ,/ 因此/ 日志/ 包含/ 应用/ 运行/ 的/ 动态/ 信息/ ,/ 适合/ 用于/ 异常/ 检测/ [/ 1/ ]/ ./ 传统/ 日志/ 分析/ 通过/ 人工/ 检验/ 或者/ 使用/ 事先/ 定义/ 好/ 的/ 异常/ 规则/ 来/ 实现/ ./ 当/ 日志/ 大小/ 有限/ 以及/ 异常/ 类型/ 可知/ 时/ ,/ 这些/ 方法/ 十分/ 有效/ 并且/ 也/ 比较/ 灵活/ ,/ 但是/ 对于/ 当前/ 程序/ 产生/ 的/ 百万/ 行/ 规模/ 的/ 日志/ ,/ 人工/ 检测/ 很难/ 实现/ [/ 2/ ]/ ,/ 提前/ 获取/ 所有/ 可能/ 的/ 异常/ 也/ 很/ 困难/ [/ 3/ ]/ ,/ 并且/ 难以/ 实时/ 在线/ 感知/ 异常/ 的/ 发生/ ./ 因此/ ,/ 业界/ 使用/ 异常/ 检测/ 来/ 实现/ 程序/ 的/ 自动化/ 分析/ ./ 通过/ 建模/ 正常/ 日志/ 并/ 对待/ 测试日志/ 与/ 正常/ 模式/ 的/ 偏离/ 进行/ 检查/ ,/ 异常/ 检测/ 算法/ 可以/ 自动/ 地/ 发现/ 可能/ 的/ 问题/ ,/ 包括/ 未知/ 的/ 异常/ ./ 异常/ 检测/ 算法/ 通常/ 使用/ 一类/ 针对/ 离散/ 序列/ 的/ 异常/ 检测/ 方法/ 来/ 分析/ 日志/ ./ 这类/ 算法/ 将/ 日志/ 所/ 蕴含/ 的/ 事件/ 序列/ 分为/ 段/ ,/ 并/ 赋予/ 每/ 一段/ 一个/ 异常/ 得分/ ./ 之前/ 的/ 序列/ 异常/ 检测/ 算法/ 大都/ 基于/ 统计/ 模型/ 或者/ 马尔可夫/ 模型/ [/ 4/ ]/ ./ 但是/ ,/ 它们/ 都/ 依赖于/ 特定/ 的/ 假设/ :/ (/ 1/ )/ 正常/ 的/ 日志/ 事件/ 满足/ 一个/ 特定/ 的/ 分布/ ./ (/ 2/ )/ 各个/ 日志/ 事件/ 的/ 出现/ 互相/ 独立/ ./ (/ 3/ )/ 日志/ 事件/ 的/ 出现/ 满足/ 马尔可夫/ 性质/ ,/ 即/ 一条/ 日志/ 事件/ 只/ 与/ 它/ 之前/ 有限/ 个/ 日志/ 事件/ 相关/ ./ 但是/ 这些/ 假设/ 并/ 不/ 总是/ 成立/ ./ 如果/ 日志/ 事件/ 之间/ 有/ 较/ 复杂/ 和/ 隐式/ 的/ 关系/ [/ 3/ ]/ ,/ 这些/ 方法/ 就/ 会/ 忽略/ 掉/ 这些/ 关联/ 或者/ 无法/ 正确/ 地/ 描述/ 这些/ 关联/ [/ 5/ ]/ ./ 因此/ ,/ 当/ 预先/ 的/ 假设/ 不/ 成立/ 时/ ,/ 基于/ 统计/ 模型/ 和/ 马尔可夫/ 模型/ 的/ 方法/ 就/ 会/ 有/ 较/ 高/ 的/ 误差/ ./ 为了/ 解决/ 上述/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 压缩/ 的/ 异常/ 检测/ 方法/ (/ Compression/ -/ basedAnomalyDetectionMethod/ ,/ CADM/ )/ ,/ 这种/ 方法/ 不/ 依赖于/ 日志/ 事件/ 分布/ 的/ 假设/ ./ CADM/ 选择/ 相对/ 熵/ 作为/ 评分标准/ 对/ 正常/ 日志/ 和/ 异常/ 日志/ 进行/ 区分/ [/ 6/ ]/ ./ 相对/ 熵/ 是/ 一种/ 对/ 概率分布/ 相似/ 程度/ 的/ 度量/ ./ 相对/ 熵/ 越/ 大/ ,/ 那么/ 测试日志/ 的/ 事件/ 分布/ 和/ 训练/ 日志/ 的/ 事件/ 分布/ 的/ 区别/ 也/ 就/ 越/ 大/ ,/ 测试日志/ 为/ 异常/ 日志/ 的/ 可能性/ 也/ 越/ 大/ ./ 但是/ ,/ 由于/ 正常/ 日志/ 和/ 异常/ 日志/ 的/ 事件/ 分布/ 都/ 是/ 未知/ 的/ ,/ 直接/ 计算/ 相对/ 熵/ 是/ 不/ 可行/ 的/ ./ 因此/ ,/ CADM/ 利用/ 相对/ 熵/ 与/ 压缩/ 的/ 关系/ 来/ 估计/ 相对/ 熵/ 的/ 大小/ ./ 由于/ CADM/ 中所/ 需/ 的/ 操作/ 仅/ 有/ 时间/ 复杂度/ 较/ 低/ 的/ 压缩/ ,/ 因此/ CADM/ 可以/ 实现/ 实时/ 异常/ 检测/ ./ 综上/ 所得/ ,/ 本文/ 的/ 贡献/ 包括/ :/ (/ 1/ )/ 提出/ 了/ 一种/ 基于/ 压缩/ 估计/ 相对/ 熵/ 的/ 在线/ 异常/ 检测/ 方法/ CADM/ ./ CADM/ 不/ 需要/ 提前/ 假设/ 日志/ 项/ 分布/ ,/ 因此/ ,/ 它/ 可以/ 应用/ 到/ 更/ 广泛/ 的/ 场景/ ./ (/ 2/ )/ 选择/ 并/ 改造/ 了/ 一种/ 通用/ 的/ 压缩/ 方法/ ,/ 即/ 文法/ 压缩/ 来/ 提供/ 更好/ 的/ 相对/ 熵/ 估计/ ./ 改造/ 后/ 的/ 算法/ 具有/ 更/ 低/ 的/ 计算/ 复杂度/ 并且/ 更/ 适合/ 用于/ 异常/ 检测/ ./ (/ 3/ )/ 提供/ 了/ CADM/ 的/ 理论/ 分析/ ,/ 证明/ 了/ 它/ 的/ 正确性/ 、/ 高效性/ 以及/ 可扩展性/ ./ (/ 4/ )/ 设计/ 和/ 实现/ 了/ 一个/ 原型/ 系统/ 并/ 对/ CADM/ 进行/ 评估/ ,/ 实验/ 结果表明/ CADM/ 具有/ 更/ 高/ 的/ 适用性/ 和/ 检测/ 正确率/ ,/ 因此/ 更/ 适合/ 用于/ 日志/ 异常/ 检测/ ./ 本文/ 第/ 2/ 节/ 讨论/ 离散/ 序列/ 异常/ 检测/ 问题/ 的/ 相关/ 研究/ ;/ 第/ 3/ 节/ 描述/ CADM/ 的/ 背景/ ;/ 第/ 4/ 节/ 详细描述/ CADM/ 的/ 设计/ 与/ 实现/ ;/ 第/ 5/ 节/ 通过/ 实验/ 评估/ CADM/ ;/ 第/ 6/ 节/ 总结/ 本文/ 且/ 提出/ 未来/ 的/ 研究/ 计划/ ./ 2/ 相关/ 工作/ 异常/ 检测/ 在/ 许多/ 领域/ 都/ 有/ 很/ 重要/ 的/ 应用/ [/ 7/ ]/ ./ 其中/ ,/ 用于/ 检测/ 异常/ 序列/ 的/ 方法/ 被/ 广泛/ 地/ 应用/ 在/ 日志/ 挖掘/ 中/ ./ 文献/ [/ 4/ ]/ 综述/ 了/ 现有/ 的/ 离散/ 序列/ 异常/ 检测/ 方法/ ./ 大部分/ 异常/ 检测/ 算法/ 基于/ 统计/ 模型/ 或/ 马尔可夫/ 模型/ 实现/ ./ 其中/ ,/ 基于/ 统计/ 模型/ 的/ 检测/ 方法/ 又/ 可/ 分为/ 两类/ :/ 第/ 1/ 类/ 方法/ 假设/ 正常/ 日志/ 满足/ 含参/ 分布/ P/ (/ x/ )/ 并/ 使用/ 参数估计/ 的/ 方法/ 根据/ 训练/ 日志/ 确定/ 参数值/ ,/ 然后/ 采用/ 假设检验/ 的/ 方法/ 去/ 评估/ 测试日志/ 是否/ 异常/ ./ 例如/ ,/ 文献/ [/ 8/ ]/ 提出/ 了/ 一种/ 基于/ χ/ 2/ 统计/ 量/ 的/ 异常/ ①/ ②/ Page3/ 检测/ 算法/ ./ 第/ 2/ 类/ 方法/ 假设/ 在/ 序列/ 中/ 出现/ 的/ 日志/ 事件/ 独立/ 同/ 分布/ ,/ 然后/ 通过/ 比较/ 待/ 测试/ 序列/ 和/ 正常/ 序列/ 中/ 各/ 事件/ 出现/ 的/ 频率/ 来/ 确定/ 测试/ 序列/ 是否/ 异常/ ./ 文献/ [/ 9/ ]/ 采用/ 前述/ 频率/ 来/ 近似/ 概率分布/ ,/ 然后/ 通过/ 比较/ 两个/ 分布/ 的/ 相对/ 熵/ 来/ 检测/ 测试/ 序列/ 是否/ 异常/ ./ 文献/ [/ 10/ ]/ 又/ 进一步/ 在/ 经验/ 相对/ 熵/ 上/ 使用/ χ/ 2/ 估计/ ./ 文献/ [/ 11/ ]/ 将/ PCA/ 方法/ 应用/ 到/ 频率/ 统计/ 向量/ 上/ ,/ 如果/ 残余/ 方差/ 较大/ ,/ 就/ 将/ 测试日志/ 标记/ 为/ 异常/ ./ 虽然/ 基于/ 统计/ 模型/ 的/ 方法/ 易于/ 实现/ ,/ 但是/ 如果/ 它们/ 的/ 预先/ 假设/ 不/ 成立/ ,/ 它们/ 的/ 准确性/ 会/ 比较/ 低/ ./ 在/ 基于/ 马尔可夫/ 模型/ 的/ 方法/ 中/ ,/ 最/ 基本/ 的/ 方法/ 是/ 采用/ 马尔可夫/ 链来/ 建模/ 日志/ 事件/ 序列/ ,/ 即/ 使用/ 事件/ 的/ 频率/ 和/ 转移/ 频率/ 来/ 估计/ 相应/ 的/ 概率/ ,/ 然后/ 通过/ 计算/ 测试日志/ 的/ 出现/ 概率/ 来/ 判断/ 其/ 是否/ 异常/ ./ 文献/ [/ 12/ ]/ 提出/ 了/ 一种/ 基于/ 一阶/ 马尔可夫/ 链/ 的/ 检测/ 方法/ ./ 虽然/ 使用/ 更/ 高阶/ 的/ 马尔可夫/ 链/ 可以/ 提高/ 模型/ 描述/ 能力/ ,/ 但是/ 模型/ 参数/ 个数/ 随着/ 阶/ 的/ 提升/ 指数/ 增长/ ,/ 因此/ 需要/ 更/ 多/ 的/ 训练/ 日志/ 以及/ 更大/ 的/ 内存/ ./ 为了/ 解决/ 这一/ 问题/ ,/ 学术界/ 提出/ 了/ 一些/ 马尔可夫/ 链/ 的/ 变种/ [/ 13/ -/ 14/ ]/ ,/ 如/ 可变/ 阶/ 马尔可夫/ 链/ 等/ ,/ 但是/ ,/ 此时/ 最高/ 的/ 阶/ 仍/ 是/ 固定/ 的/ ./ 另一类/ 基于/ 马尔可夫/ 模型/ 的/ 方法/ 使用/ 隐/ 马尔可夫/ 模型/ [/ 15/ -/ 17/ ]/ ./ 尽管/ 隐/ 马尔可夫/ 模型/ 比/ 马尔可夫/ 链/ 描述/ 能力/ 更强/ ,/ 但是/ 它/ 对/ 初始/ 参数/ 比较/ 敏感/ ,/ 并且/ 这些/ 参数/ 不易/ 设置/ [/ 4/ ]/ ./ 所有/ 基于/ 马尔可夫/ 模型/ 的/ 方法/ 的/ 最大/ 问题/ 是/ 如果/ 日志/ 不/ 满足/ 马尔可夫/ 性质/ ,/ 这些/ 方法/ 的/ 检测/ 精度/ 会/ 比较/ 低/ [/ 5/ ]/ ./ 除/ 以上/ 两类/ 方法/ 外/ ,/ 也/ 有/ 一些/ 方法/ 不/ 需要/ 对/ 日志/ 事件/ 的/ 分布/ 作/ 预先/ 假设/ ./ 其中/ 一类/ 方法/ 是/ 基于/ 核/ 的/ 方法/ ./ 离散/ 序列/ 最/ 常用/ 的/ 核/ 是/ nLCS/ [/ 18/ -/ 19/ ]/ ./ 但是/ ,/ 基于/ 核/ 的/ 方法/ 需要/ 计算/ 所有/ 训练/ 序列/ 和/ 测试/ 序列/ 的/ 编辑/ 距离/ ,/ 因此/ 会/ 有/ 较/ 高/ 的/ 计算/ 复杂度/ [/ 4/ ]/ ./ 另外/ 一种/ 基于/ 压缩/ 的/ 方法/ 是/ 文献/ [/ 20/ ]/ 中/ 提出/ 的/ 基于/ 压缩/ 的/ 相异/ 测度/ (/ CompressionbasedDissimilarMeasure/ ,/ CDM/ )/ ./ CDM/ 是/ 距离/ 的/ 一种/ ,/ 因此/ 可以/ 被/ 广泛/ 用于/ 分类/ 和/ 聚类/ ./ 但是/ ,/ 当/ CDM/ 用于/ 在线/ 异常/ 检测/ 时/ ,/ 它/ 对应/ 我们/ 方法/ 阈值/ 设为/ 0/ 的/ 一个/ 特例/ ,/ 因此/ 只/ 适用/ 于/ 有限/ 的/ 场景/ ./ 3/ 背景/ 3.1/ 日志/ 转换/ 在/ 日志/ 文件/ 上/ 应用/ 序列/ 异常/ 检测/ 方法/ 之前/ ,/ 首先/ 需要/ 从/ 日志/ 中/ 提取/ 出/ 各/ 记录/ 所/ 对应/ 的/ 事件/ ,/ 从而/ 将/ 整个/ 日志/ 转换/ 为/ 一个/ 事件/ 序列/ ./ 但是/ ,/ 从/ 文本/ 中/ 解析/ 出/ 相应/ 事件/ 类型/ 并/ 不/ 容易/ ./ 传统/ 上/ ,/ 有/ 4/ 种/ 可能/ 的/ 方法/ :/ (/ 1/ )/ 无/ 监督/ 聚类/ 方法/ ./ 通过/ 聚类/ 方式/ 将/ 日志/ 转化/ 为/ 事件/ 需要/ 大量/ 计算/ ,/ 而且/ 如果/ 距离/ 函数/ 选择/ 的/ 不/ 合适/ ,/ 聚类/ 的/ 效果/ 也/ 会/ 比较/ 差/ ./ (/ 2/ )/ 启发式/ 算法/ ./ 该/ 算法/ 将/ 日志/ 记录/ 中/ 的/ 数字/ 、/ 路径/ 或/ IP地址/ 视为/ 参数/ 并/ 将/ 去掉/ 参数/ 后/ 的/ 消息/ 模板/ 视为/ 事件/ ./ 该/ 方法/ 比较/ 简单易行/ ,/ 但是/ 无法/ 处理/ 格式/ 复杂/ 的/ 日志/ ./ (/ 3/ )/ 代码/ 分析/ ./ 通过/ 分析/ 二进制/ 代码/ 或者/ 源代码/ [/ 1/ ]/ ,/ 可以/ 获得/ 比/ 启发式/ 算法/ 更/ 精确/ 的/ 消息/ 模板/ ./ 比如/ ,/ 如果/ 日志/ 用/ C/ 风格/ 的/ 输出/ ,/ 那么/ 我们/ 可以/ 直接/ 从/ printf/ 的/ 调用/ 中/ 区分/ 出/ 消息/ 模板/ 和/ 参数/ ./ (/ 4/ )/ 使用/ 领域/ 特定/ 的/ 知识/ ./ 在/ 一些/ 日志/ 中/ ,/ 事件/ 可能/ 已经/ 明确/ 记录/ 在/ 日志/ 中/ ,/ 或/ 可以/ 通过/ 行号/ 等/ 信息/ 准确/ 推算出/ ./ 但是/ ,/ 这种/ 方式/ 需要/ 手工/ 分析/ 训练/ 日志/ ./ 3.2/ 文法/ 压缩/ 文法/ 压缩/ 由/ 文法/ 转换/ 和/ 文法/ 编码/ [/ 21/ ]/ 两步/ 组成/ ./ 在/ 文法/ 转换/ 中/ ,/ 序列/ 会/ 被/ 转换成/ 一种/ 足够/ 紧凑/ 以利于/ 压缩/ 的/ 上下文/ 无关/ 文法/ ,/ 即/ 容许/ 文法/ [/ 9/ ]/ ./ 文法/ 编码/ 使用/ 容许/ 文法/ 来/ 编码序列/ ./ 文献/ [/ 22/ ]/ 中/ 提出/ 的/ 顺序/ 压缩算法/ 是/ 文法/ 压缩/ 的/ 一种/ ./ 对于/ 文法/ 转换/ ,/ 顺序/ 压缩算法/ 采用/ 了/ 一种/ 有效/ 的/ 贪心/ 算法/ ,/ 该/ 算法/ 通过/ 在/ 转换/ 过程/ 中/ 保持/ 以下/ 断言/ 来/ 实现/ :/ (/ 1/ )/ 如果/ s/ →/ α/ β/ 是/ 一个/ 产生/ 式/ ,/ 那么/ s/ 在/ 所有/ 产/ (/ 2/ )/ 所有/ 子/ 序列/ α/ β/ 只能/ 在/ 所有/ 的/ 产生/ 式/ 右侧/ 出/ (/ 3/ )/ 所有/ 不同/ 的/ 变量/ s1/ 和/ s2/ 展开/ 的/ 字符串/ 均/ 不/ 生式/ 右侧/ 至少/ 出现/ 两次/ ./ 现/ 一次/ ,/ 除非/ α/ =/ β/ 且/ 有/ 一个/ 3/ 元组/ α/ α/ α/ ./ 相同/ ./ 在/ 每/ 一步/ 中/ ,/ 算法/ 首先/ 从/ 后续/ 序列/ 中/ 截取/ 当前/ 文法/ 可/ 表示/ 的/ 最/ 长子/ 序列/ ,/ 并/ 将/ 代表/ 该子/ 序列/ 的/ 终结符/ 或非/ 终结符/ 拼接/ 在/ 产生/ 式/ s0/ 的/ 尾端/ ./ 此时/ 有/ 3/ 种/ 情况/ 可能/ 会/ 出现/ :/ (/ a/ )/ 前述/ 3/ 个/ 断言/ 均/ 未/ 违反/ ;/ (/ b/ )/ 新/ 出现/ 的/ 模式/ α/ β/ 违反/ 断言/ (/ 2/ )/ ./ 算法/ 将/ 生成/ 一个/ 新/ 的/ 表达式/ s/ →/ α/ β/ 并用/ s/ 代替/ α/ β/ ./ (/ c/ )/ 同/ (/ b/ )/ 类似/ ,/ 但/ 新/ 添加/ 的/ 表达式/ 导致/ 断言/ (/ 1/ )/ 会/ 被/ 表达式/ s/ →/ α/ 破坏/ ./ 算法/ 将/ 使用/ α/ 替换/ s/ ,/ 但/ 最/ 多只/ 需要/ 替换/ 3/ 次/ ./ Page4/ 以上/ 3/ 种/ 情况/ 都/ 能够/ 在/ 常量/ 时间/ 内/ 处理/ ./ 上述/ 文法/ 转换/ 算法/ 的/ 结果/ 是/ 一种/ 容许/ 文法/ ./ 在/ 文法/ 编码/ 阶段/ ,/ 零阶自/ 适应/ 算术/ 编码/ 被/ 用来/ 对/ 文法/ 转换/ 中/ 每/ 一步/ 识别/ 出/ 的/ 最/ 长子/ 序列/ 对应/ 的/ 符号/ 进行/ 编码/ ./ 可以/ 证明/ ,/ 顺序/ 压缩算法/ 对/ 所有/ 稳定/ 遍历/ 的/ 信源/ 都/ 是/ 通用/ 的/ ,/ 即/ 可以/ 将/ 该/ 信源/ 产生/ 的/ 序列/ 压缩/ 至/ 熵/ 率/ ./ 4CADM/ 算法/ 的/ 设计/ 本节/ 将/ 详细/ 讨论/ CADM/ 算法/ 的/ 设计/ ./ 如图/ 1/ 所示/ ,/ CADM/ 算法/ 一共/ 包括/ 以下/ 3/ 步/ :/ (/ 1/ )/ 使用/ 背景/ 中/ 讨论/ 的/ 方式/ 将/ 整个/ 日志/ 转化/ 为/ 一个/ 离散/ 事件/ 序列/ ./ (/ 2/ )/ 使用/ 训练/ 日志/ 所/ 转化/ 的/ 序列/ 来/ 训练/ CADM/ 的/ 模型/ ./ CADM/ 所/ 需要/ 使用/ 的/ 训练/ 日志/ 为/ 正常/ 日志/ ./ (/ 3/ )/ 将/ 待/ 测试日志/ 分段/ ,/ 并/ 使用/ 异常/ 评分/ 公式/ 为/ 每/ 一段/ 的/ 异常/ 程度/ 进行/ 评分/ ./ 对于/ 第/ 1/ 步中/ 的/ 日志/ 转换/ ,/ CADM/ 结合/ 使用/ 方法/ 2/ ,/ 3/ 和/ 4/ ./ 大部分/ 场景/ 下/ 启发式/ 算法/ 对/ 异常/ 检测/ 任务/ 来说/ 已经/ 足够/ 精确/ ,/ 如果/ 有/ 需要/ ,/ 还/ 可以/ 通过/ 对/ 源码/ 或/ 二进制/ 分析/ 来/ 精确/ 找出/ 所有/ 的/ 事件/ 类型/ ./ 最后/ ,/ 如果/ 事件/ 类型/ 无法/ 从/ 消息/ 模板/ 中/ 推断/ ,/ 那么/ 还/ 需要/ 结合/ 领域/ 相关/ 的/ 知识/ 来/ 完成/ 日志/ 转换/ ./ 下文/ 将/ 详细/ 讨论/ 将/ 日志/ 转化/ 为/ 事件/ 序列/ 后/ 进行/ 检测/ 的/ 过程/ ,/ 其中/ 所用/ 到/ 的/ 主要/ 符号/ 如表/ 1/ 所示/ ./ D/ (/ Q/ ‖/ P/ )/ Pn/ 或/ Pn/ 在/ 分布/ P/ 与/ Q/ 下长/ 为/ n/ 的/ 事件/ 序列/ 的/ 概率分布/ En/ 所有/ 长为/ n/ 的/ 事件/ 序列/ ,/ 其中/ 的/ 事件/ 取自/ 事件/ uc/ (/ / )/ 将/ 事件/ 看作/ 字符/ 并/ 使用/ 某种/ 通用/ 压缩算法/ 压/ uc/ (/ m/ )/ 或/ uc/ (/ Mm/ )/ 单独/ 压缩/ 事件/ 序列/ m/ 或/ Mm/ 所/ 产生/ 的/ 编码/ 的/ uc/ (/ m/ |/ M/ )/ uc/ (/ Mm/ )/ -/ uc/ (/ m/ )/ 4.1/ 异常/ 评分/ 公式/ 本节/ 将/ 描述/ CADM/ 所/ 使用/ 的/ 异常/ 评分/ 公式/ ,/ 并/ 对/ 该/ 公式/ 给出/ 理论/ 分析/ ./ CADM/ 首先/ 将/ 从/ 日志/ 转换/ 中/ 获取/ 的/ 事件/ 序列/ 分段/ ./ 一个/ 日志/ 文件/ 所/ 对应/ 的/ 事件/ 序列/ 可以/ 被/ 分为/ 若干段/ ,/ 每/ 一段/ 包含/ 一定/ 数量/ 的/ 事件/ ./ 在/ CADM/ 中/ 可以/ 使用/ 任意/ 的/ 分段策略/ ,/ 一般/ 情况/ 下/ ,/ CADM/ 使用/ 等/ 事件/ 数目/ 的/ 方式/ 进行/ 段/ 的/ 划分/ ,/ 即/ 事件/ 缓冲区/ 中/ 的/ 事件/ 个数/ 到达/ 指定/ 段长/ 时/ ,/ 就/ 将/ 事件/ 缓冲区/ 中/ 的/ 所有/ 事件/ 作为/ 一段/ 并/ 使用/ 评分/ 公式/ 进行/ 评分/ ./ 如果/ 有/ 可以/ 直接/ 利用/ 的/ 段/ 的/ 语义/ ,/ 如/ 将/ 某个/ 用户/ 一次/ 会话/ 作为/ 一段/ ,/ CADM/ 也/ 可以/ 使用/ 这种/ 语义/ 进行/ 分段/ ./ 段/ 是/ 异常/ 检测/ 的/ 最小/ 单位/ ,/ 每/ 一段/ 都/ 会/ 根据/ 式/ (/ 1/ )/ 获得/ 一个/ 异常/ 程度/ 的/ 评分/ ./ 我们/ 假设/ 所有/ 可能/ 的/ 事件/ 来自/ 一个/ 有限/ 但/ 不能/ 预知/ 的/ 集合/ E/ ./ 同时/ ,/ 假设/ 在/ 当前/ 待/ 检测/ 段/ 之前/ ,/ 所有/ 正常/ 日志/ 对应/ 的/ 事件/ 序列/ 为/ M/ ,/ 而/ 当前/ 待/ 检测/ 段/ 的/ 事件/ 序列/ 为/ m/ ./ 那么/ ,/ CADM/ 对/ m/ 的/ 评分/ 公式/ 为/ Score/ (/ m/ )/ =/ 1/ 式/ (/ 1/ )/ 中/ Mm/ 代表/ 序列/ M/ 和/ m/ 按/ 字符串/ 拼接/ 方式/ 进行/ 的/ 连接/ ./ 如果/ Score/ (/ m/ )/ 是/ 正值/ ,/ 那么/ 当前/ 段/ m/ 就/ 会/ 被/ 识别/ 为/ 异常/ ./ Score/ (/ m/ )/ 的/ 值/ 越/ 大/ ,/ 就/ 说明/ 该段/ 异常/ 的/ 可能性/ 越高/ ./ 在/ 式/ (/ 1/ )/ 中/ ,/ λ/ 是/ 用来/ 控制/ 是否/ 异常/ 的/ 阈值/ ./ 整个/ 检测/ 过程/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 在线/ 异常/ 检测/ 算法/ ./ 输入/ :/ ctx/ :/ 压缩/ 过/ 之前/ 所有/ 正常/ 事件/ 序列/ 的/ 压缩器/ 输出/ :/ 当前/ 段/ 是否/ 异常/ 过程/ :/ PROCEDUREDETECT/ (/ ctx/ ,/ segment/ )/ Page5/ 下文/ 将/ 分析/ 式/ (/ 1/ )/ 的/ 有效性/ ./ 从/ 概率/ 的/ 角度看/ ,/ 如果/ 产生/ 某个/ 段/ 的/ 事件/ 概率分布/ 与/ 其它/ 正常/ 段/ 不/ 一致/ ,/ 那么/ 该段/ 应该/ 被/ 识别/ 为/ 异常/ ./ 为了/ 衡量/ 这种/ 不一致性/ ,/ 我们/ 采用/ 了/ 相对/ 熵/ 的/ 概念/ ./ 假设/ 正常/ 事件/ 序列/ 的/ 联合/ 概率分布/ 为/ P/ 而待/ 检测/ 段/ 的/ 联合/ 概率分布/ 为/ Q/ ,/ 那么/ Q/ 和/ P/ 之间/ 的/ 相对/ 熵/ 被/ 定义/ 为/ 相对/ 熵/ 是/ Q/ 和/ P/ 不一致性/ 的/ 一种/ 合理/ 度量/ ./ 首先/ ,/ 当且/ 仅/ 当/ Q/ ≡/ P/ 时/ ,/ D/ (/ Q/ ‖/ P/ )/ =/ 0/ ,/ 否则/ 将/ 有/ D/ (/ Q/ ‖/ P/ )/ >/ 0/ ./ 另外/ ,/ 根据/ Sanov/ 定理/ [/ 6/ ]/ ,/ 对于/ 一个/ 由/ 分布/ Q/ 产生/ 的/ 序列/ S/ ,/ 有/ 对/ 任意/ 高阶/ 的/ 马尔可夫/ 过程/ 均/ 成立/ ./ 因此/ ,/ D/ (/ Q/ ‖/ P/ )/ 的/ 值/ 越/ 大/ ,/ 当前/ 待/ 检测/ 段/ 是/ 由/ 正常/ 事件/ 序列/ 分布/ P/ 产生/ 的/ 概率/ 就/ 越/ 小/ ,/ 因此/ ,/ 如果/ D/ (/ Q/ ‖/ P/ )/ 超过/ 某一/ 特定/ 的/ 值/ λ/ ,/ 那么/ 待/ 检测/ 的/ 段/ 就/ 可以/ 被/ 认为/ 是/ 异常/ ./ 另外/ ,/ 在/ CADM/ 中/ ,/ D/ (/ Q/ ‖/ P/ )/ 并/ 不/ 要求/ 一定/ 收敛/ ./ 如果/ D/ (/ Q/ ‖/ P/ )/ 为/ 正/ 无穷大/ ,/ 那么/ 该段/ 也/ 将/ 被/ 认为/ 是/ 异常/ ./ 下文/ 首先/ 对式/ (/ 1/ )/ 分类/ 错误/ 的/ 概率/ 进行/ 分析/ ./ 使用/ 相对/ 熵/ ,/ 异常/ 检测/ 问题/ 可以/ 被/ 转化/ 为/ 使用/ 如下/ 假设/ 的/ 假设检验/ 问题/ :/ 假设/ 事件/ 序列/ M/ 和/ m/ 的/ 长度/ 分别/ 为/ N/ 和/ n/ ./ 首先/ 假设/ 分布/ P/ 满足/ 阶为/ k/ 或/ 更/ 低/ 的/ 马尔可夫/ 性质/ ,/ 最终/ 这一/ 假设/ 将/ 被/ 消除/ ./ 在/ P/ 和/ Q/ 未知/ 的/ 情况/ 下/ ,/ 文献/ [/ 23/ ]/ 中/ 给出/ 了/ 针对/ 该类/ 异常/ 检测/ 问题/ 的/ 一个/ 判别函数/ ,/ 它/ 的/ 主要/ 定理/ 如下/ ./ 定理/ 1/ ./ 假设/ s/ =/ E1E2/ …/ Ek/ 是/ 长度/ 为/ k/ 的/ 事件/ 序列/ ./ 定义/ qm/ (/ s/ )/ 为子/ 序列/ s/ 在/ 序列/ m/ 中/ 出现/ 的/ 频率/ ,/ qm/ (/ e/ |/ s/ )/ 为/ 事件/ e/ 在子/ 序列/ s/ 后/ 出现/ 的/ 频率/ ,/ 即/ 对于/ 任意/ 两个/ 序列/ x/ 和/ y/ 定义/ Hs/ (/ qx/ ,/ qy/ )/ =/ -/ ∑/ S/ 其中/ Hs/ (/ qx/ )/ 为/ 事件/ 集合/ E/ 相对/ 子/ 序列/ 集合/ S/ 的/ 条件/ 熵/ ,/ 则/ 使用/ 判别函数/ h/ (/ M/ ,/ m/ ,/ λ/ )/ =/ N/ +/ n/ 判别/ 假设检验/ 问题/ (/ 3/ )/ ,/ 在/ D/ (/ Q/ ‖/ P/ )/ / λ/ +/ ε/ 和/ N/ / Cn/ 的/ 情况/ 下/ ,/ 正常/ 日志/ 误判/ 为/ 异常/ 日志/ 和/ 异常/ 日志/ 误判/ 为/ 正常/ 日志/ 的/ 概率/ 分别/ 为/ limn/ →/ ∑/ EN/ 即/ 如果/ N/ 大于/ n/ 的/ 一个/ 常数/ 倍/ ,/ 判别函数/ (/ 4/ )/ 的/ 漏检/ 率和误/ 检率/ 都/ 很/ 低/ ./ 由于/ 一般/ 情况/ 下/ ,/ 待/ 检测/ 段/ 的/ 长度/ n/ 是/ 固定/ 的/ 而/ 当前/ 正常/ 事件/ 序列/ 的/ 长度/ N/ 是/ 不断/ 增长/ 的/ ,/ 因此/ N/ >/ Cn/ 是/ 成立/ 的/ ./ 可以/ 证明/ ,/ 判别函数/ (/ 4/ )/ 与/ P/ 和/ Q/ 已知/ 时/ 的/ 最优/ 判断/ 函数/ 的/ 效果/ 是/ 近似/ 的/ [/ 23/ ]/ ./ 但是/ ,/ 对于/ 日志/ 事件/ 序列/ 异常/ 检测/ 来说/ ,/ 马尔可夫/ 假设/ 不/ 一定/ 成立/ ./ 另一方面/ ,/ 计算/ Hs/ (/ qMm/ )/ 需要/ 穷尽/ 所有/ 长为/ k/ 的/ 子/ 序列/ ,/ 随着/ k/ 的/ 增长/ ,/ 将/ 面临/ 状态/ 爆炸/ 的/ 问题/ ./ 为了/ 解决/ 以上/ 问题/ ,/ 在/ 判别式/ (/ 1/ )/ 中/ Hs/ (/ qMm/ )/ 被/ 使用/ 如下/ 公式/ 近似/ :/ 下文/ 将/ 说明/ 近似/ 式/ (/ 5/ )/ 的/ 有效性/ ./ 由于/ CADM/ 采用/ 的/ 是/ 通用/ 压缩算法/ [/ 23/ ]/ ,/ 因此/ ,/ 对/ 任意/ 分布/ Plimn/ →/ Px1/ 而/ 根据/ Kraft/ 不等式/ ,/ 随着/ n/ 的/ 增大/ ,/ log/ (/ 1/ // P/ (/ x/ )/ )/ 同时/ 也/ 是/ uc/ (/ x/ )/ 的/ 下界/ ,/ 因此/ uc/ (/ Mm/ )/ ~/ -/ logP/ (/ Mm/ )/ =/ -/ ∑/ n/ 因此/ ,/ 随着/ n/ 的/ 增大/ ,/ 可得/ 1N/ +/ nuc/ (/ Mm/ )/ ~/ -/ limn/ →/ limn/ →/ 由/ 极限/ 的/ 唯一性/ ,/ 可以/ 得到/ 当/ n/ 增大/ 时/ ,/ 近似/ 式/ (/ 5/ )/ 成立/ ./ 另外/ ,/ 由于/ uc/ (/ Mm/ )/ >/ (/ N/ +/ n/ )/ Hs/ (/ qMm/ )/ ,/ 因此/ 使用/ 判断/ 函数/ (/ 1/ )/ 漏检/ 和/ 误检/ 的/ 概率/ 满足/ limn/ →/ P/ (/ M/ ,/ mScore/ (/ M/ ,/ m/ ,/ λ/ )/ >/ 0/ )/ Page6limn/ →/ ∑/ EN/ 因此/ ,/ 判断/ 函数/ (/ 1/ )/ 漏检/ 和/ 误检/ 的/ 概率/ 有限/ 并/ 接近/ 最优/ ./ 事实上/ ,/ 从/ 直观/ 上/ 看/ ,/ CADM/ 的/ 核心/ 是/ 使用/ 压缩/ 大小/ 来/ 估计/ 正常/ 序列/ 与/ 待/ 检测/ 序列/ 之间/ 的/ 相对/ 熵/ ./ 如果/ 在/ 错误/ 的/ 概率/ 估计/ 基础/ 上/ 对/ 一个/ 序列/ 进行/ 压缩/ ,/ 那么/ 每/ 一个/ 事件/ 压缩/ 后/ 相对/ 于/ 最优/ 压缩/ 的/ 冗余/ l/ =/ limn/ →/ 即/ 该值/ 等于/ 实际/ 概率分布/ 与/ 错误/ 概率分布/ 之间/ 的/ 相对/ 熵/ ./ 因此/ 可以/ 将/ CADM/ 评分/ 公式/ 中/ 的/ 下文/ 将/ 分析/ 这种/ 估计/ 的/ 误差/ ./ 首先/ ,/ 由/ log/ 函数/ 看作/ 是/ 对/ 相对/ 熵/ 的/ 估计/ 而/ λ/ 则/ 是/ 异常/ 的/ 阈值/ ./ 的/ 凹性/ 及/ Jensen/ 不等式/ ,/ 可知/ 由/ Mm/ 与/ M/ 及/ m/ 中/ 各/ 状态/ 频率/ 的/ 关系/ 可知/ (/ N/ +/ n/ )/ Hs/ (/ qMm/ )/ =/ NHs/ (/ qM/ ,/ qMm/ )/ +/ nH/ (/ qm/ ,/ qMm/ )/ ./ 由/ 文献/ [/ 24/ ]/ 及/ 遍历/ 定理/ ,/ 对/ k/ 阶马氏/ 过程/ 有/ Dn/ (/ Qn/ ‖/ Pn/ )/ =/ 1n/ ∑/ En/ =/ ∑/ sqm/ (/ s/ )/ ∑/ e/ =/ N/ +/ nnHs/ (/ qMm/ ,/ qM/ )/ -/ N/ 且/ 有/ Dn/ (/ Qn/ ‖/ Pn/ )/ >/ D/ (/ Q/ ‖/ P/ )/ +/ 1/ 另一方面/ ,/ 使用/ 压缩/ 编码/ 大小/ 来/ 估计/ Dn/ (/ Qn/ ‖/ Pn/ )/ 的/ 误差/ 为/ Dn/ (/ Qn/ ‖/ Pn/ )/ -/ λ/ ^/ =/ N/ (/ Hs/ (/ qm/ ,/ qM/ )/ -/ 1/ (/ nHs/ (/ qM/ )/ -/ 1N/ (/ =/ Hs/ (/ qm/ ,/ qM/ )/ -/ 1/ (/ Hs/ (/ qm/ )/ -/ 1/ (/ =/ Hs/ (/ qm/ ,/ qMm/ )/ -/ 1/ (/ Hs/ (/ qm/ ,/ qM/ )/ -/ Hs/ (/ qm/ ,/ qMm/ )/ )/ -/ (/ Hs/ (/ qm/ )/ -/ 1/ 对于/ 第/ 1/ 项/ ,/ 由于/ 顺序/ 压缩算法/ 具有/ 在/ 线性/ ,/ 它/ 编码/ Mm/ 前半部/ 分/ 和/ 编码/ M/ 的/ 过程/ 一致/ ,/ 因此/ 相对/ 于/ 经验/ 熵/ 产生/ 的/ 冗余/ 更高/ ./ 由此可知/ uc/ (/ Mm/ )/ -/ (/ N/ +/ n/ )/ Hs/ (/ qMm/ )/ >/ uc/ (/ M/ )/ -/ NHs/ (/ qM/ )/ ,/ 所以/ uc/ (/ mM/ )/ =/ uc/ (/ Mm/ )/ -/ uc/ (/ M/ )/ 对于/ 第/ 2/ 项/ ,/ 由于/ (/ N/ +/ n/ )/ Hs/ (/ qMm/ ,/ qM/ )/ / (/ N/ +/ n/ )/ Hs/ (/ qMm/ )/ ,/ 因此/ nHs/ (/ qm/ ,/ qM/ )/ =/ (/ N/ +/ n/ )/ Hs/ (/ qMm/ ,/ qM/ )/ -/ NHs/ (/ qM/ )/ 另一方面/ ,/ Hs/ (/ qm/ ,/ qM/ )/ -/ Hs/ (/ qm/ ,/ qMm/ )/ 对于/ 第/ 3/ 项/ ,/ 由/ 文献/ [/ 22/ ]/ 可知/ ,/ 对于/ 任意/ 序列/ s/ 使用/ 顺序/ 压缩算法/ 编码/ 满足/ Hs/ (/ qs/ )/ / 1/ 因此/ ,/ 用/ 压缩/ 编码/ 大小/ 来/ 估计/ Dn/ (/ Qn/ ‖/ Pn/ )/ 的/ 误差/ 中/ ,/ 第/ 1/ 项为/ 负/ ,/ 后/ 两项/ 为/ 正/ ./ 由于/ N/ / n/ ,/ 式/ (/ 7/ )/ 接近/ 0/ ,/ 并且/ 对/ Mm/ 进行/ 编码/ 时/ 式/ (/ 8/ )/ 收敛/ 的/ 程度/ 远比/ 对/ m/ 进行/ 编码/ 时高/ ./ 因此/ Dn/ (/ Qn/ ‖/ Pn/ )/ -/ λ/ ^/ 中/ 决定/ 结果/ 正负/ 并/ 占/ 主导/ 的/ 项为/ 综上/ ,/ h/ (/ M/ ,/ m/ ,/ λ/ )/ +/ λ/ / λ/ ^/ / Dn/ (/ Qn/ ‖/ Pn/ )/ / D/ (/ Q/ ‖/ P/ )/ ,/ D/ (/ Q/ ‖/ P/ )/ -/ λ/ ^/ =/ OloglognPage7/ 于式/ (/ 4/ )/ ,/ 式/ (/ 1/ )/ 的/ 误/ 分类/ 率/ 的/ 界略/ 差/ ,/ 但/ 实际上/ 其/ 对/ 相对/ 熵/ 的/ 估计/ 更/ 精确/ ./ 另外/ ,/ 估计/ 的/ 误差/ 主要/ 来自/ n/ 较/ 小时/ 对/ m/ 进行/ 压缩/ 式/ (/ 8/ )/ 未能/ 完全/ 收敛/ ,/ 这/ 与/ 本文/ 实验/ 2/ 的/ 结果/ 一致/ ./ 为了/ 解决/ 这一/ 问题/ ,/ 本文/ 采用/ 了/ 将/ m/ 进行/ 复制/ 压缩/ 的/ 策略/ ,/ 该/ 策略/ 将/ 在/ 实验/ 2/ 中/ 描述/ 和/ 验证/ ./ 最后/ ,/ 虽然/ 理论/ 上/ D/ (/ Q/ ‖/ P/ )/ 是非/ 负/ 的/ ,/ 但/ 实际/ 中/ 使用/ 一个/ 负数/ 作为/ λ/ 值/ 也/ 是/ 有/ 意义/ 的/ ./ 4.2/ 压缩算法/ 的/ 修改/ 本/ 节/ 讨论/ CADM/ 对/ 压缩算法/ 的/ 选择/ 和/ 改造/ ./ CADM/ 选择/ 了/ 一类/ 压缩算法/ —/ —/ —/ 文法/ 压缩/ 来/ 估计/ 相对/ 熵/ ./ 实际上/ ,/ 在/ 文法/ 压缩/ 之前/ ,/ 有/ 许多/ 满足/ 通用性/ 的/ 压缩算法/ ./ 传统/ 上/ 它们/ 可以/ 被/ 分为/ 两类/ :/ 基于/ 显式/ 概率/ 估计/ 的/ 自/ 适应/ 压缩算法/ 和/ 基于/ 字典/ 的/ 压缩算法/ ./ 但是/ ,/ 这些/ 算法/ 均/ 不/ 适合/ 直接/ 用于/ 异常/ 检测/ ./ 自/ 适应/ 压缩算法/ 如/ 算术/ 编码/ 一般/ 只/ 对/ 符合/ 有限/ 阶/ 马尔可夫/ 性质/ 的/ 事件/ 序列/ 是/ 通用/ 的/ ./ 在/ 基于/ 字典/ 的/ 算法/ 中/ ,/ LZ77/ 及其/ 变种/ 一般/ 使用/ 滑动/ 窗口/ 来/ 降低/ 空间/ 和/ 时间/ 开销/ ./ 但是/ ,/ 使用/ 滑动/ 窗口/ 会/ 导致/ 之前/ 学习/ 的/ 正常/ 模式/ 被/ 丢弃/ ,/ 从而/ 提高/ 了/ 假/ 警率/ ./ LZ78/ 算法/ 则/ 已/ 被/ 证明/ 是/ 文法/ 压缩算法/ 的/ 一种/ ./ CADM/ 选择/ 了/ 第/ 2/ 节中/ 描述/ 的/ 顺序/ 压缩算法/ ./ 这种/ 算法/ 被/ 证明/ 对/ 任意/ 平稳/ 遍历/ 分布/ 均/ 是/ 通用/ 的/ ,/ 而且/ 相对/ 于/ LZ78/ 有/ 更/ 高/ 的/ 压缩率/ [/ 22/ ]/ ,/ 因此/ 可以/ 提供/ 更/ 准确/ 的/ 相对/ 熵/ 估计/ ./ 虽然/ 顺序/ 压缩算法/ 为/ CADM/ 提供/ 了/ 通用/ 压缩算法/ 的/ 基本/ 框架/ ,/ 但是/ 由于/ 无损压缩/ 算法/ 通过/ 降低/ 压缩率/ 来/ 保证/ 唯一/ 可译/ ,/ 因此/ 需要/ 改造/ 以/ 提供/ 更好/ 的/ 相对/ 熵/ 估计/ ./ 另一方面/ ,/ 由于/ 异常/ 检测/ 不/ 需要/ 使用/ 最终/ 的/ 编码/ ,/ 因此/ 可以/ 通过/ 改造/ 来/ 降低/ 运行/ 时间/ ./ 包括/ 顺序/ 压缩算法/ 在内/ 的/ 所有/ 上述/ 压缩算法/ 都/ 假设/ 所有/ 事件/ 的/ 集合/ E/ 在/ 压缩/ 开始/ 前/ 是/ 已知/ 的/ ,/ 但/ 对于/ 异常/ 检测/ ,/ 在/ 检测/ 开始/ 前/ 获取/ 所有/ 可能/ 的/ 事件/ 类型/ 是/ 很/ 困难/ 的/ ,/ 除非/ 采用/ 分析/ 二进制/ 代码/ 或/ 源码/ 的/ 日志/ 转换方法/ ./ 尽管/ 存在/ 针对/ 未知事件/ 集合/ 的/ 文法/ 压缩算法/ [/ 25/ ]/ ,/ 但/ 它们/ 依赖于/ 关于/ 事件/ 分布/ 的/ 先验/ 知识/ ,/ 因此/ 很难/ 在/ 实际/ 中/ 实现/ 和/ 应用/ ./ 另一方面/ ,/ 顺序/ 压缩算法/ 假设/ 事件/ 集合/ 中/ 的/ 所有/ 事件/ 在/ 压缩/ 开始/ 前均/ 出现/ 过/ 一次/ 来/ 避免/ 分母/ 为/ 零/ 的/ 问题/ ,/ 而/ 事实上/ 它们/ 并/ 没有/ 出现/ ,/ 这种/ 措施/ 会/ 降低/ 相对/ 熵/ 估计/ 的/ 准确度/ ,/ 尤其/ 是/ 在/ 序列/ 较/ 短/ 的/ 情况/ 下/ ./ 为了/ 解决/ 以上/ 问题/ ,/ 在/ 顺序/ 压缩/ 每/ 一步/ 计算/ 频率/ 时/ ,/ CADM/ 忽略/ 未知事件/ 的/ 频率/ ,/ 并且/ 只当/ 一个/ 事件/ 第一次/ 出现/ 时才/ 假设/ 它们/ 之前/ 出现/ 过/ 一次/ 来/ 避免/ 分母/ 为/ 零/ 的/ 问题/ ./ 使用/ 这种/ 方式/ CADM/ 避免/ 了/ 预知/ 事件/ 集合/ E/ 的/ 要求/ ,/ 并且/ 提高/ 了/ 估计/ 准确度/ ./ 顺序/ 压缩/ 的/ 第/ 2/ 个/ 问题/ 是/ 计算/ 算术/ 编码/ 的/ 长度/ 涉及/ 到/ 精确/ 浮点数/ 运算/ ,/ 从而/ 造成/ 很大/ 的/ 时间/ 开销/ ,/ 尤其/ 是/ 当/ 正常/ 事件/ 序列/ 长度/ 比较/ 长时/ ./ 算术/ 编码/ 将/ 整个/ 事件/ 序列/ 表示/ 成/ [/ 0/ ,/ 1/ ]/ 的/ 子/ 区间/ ,/ 该/ 区间/ 随着/ 系统/ 的/ 增加/ 而/ 变小/ ./ 假设/ 当前/ 事件/ 序列/ 对应/ 的/ 子/ 区间/ 的/ 长度/ 为/ s/ ,/ 新/ 事件/ 出现/ 的/ 频率/ 为/ b/ (/ b/ ∈/ [/ 0/ ,/ 1/ ]/ )/ ,/ 那么/ 代表/ 整个/ 事件/ 序列/ 的/ 区间/ 长度/ 变为/ b/ ·/ s/ ./ 最终/ 编码/ 的/ 长度/ 与/ 区间/ 的/ 长度/ 有关/ ,/ 即/ 编码/ 一个/ 长为/ s/ 的/ 区间/ 需要/ -/ log2s/ +/ 1/ 位/ ,/ 因此/ 算法/ 需要/ 维护/ 区间/ 的/ 长度/ 信息/ ./ 由于/ 精确/ 浮点数/ 计算/ 使用/ 字符/ 数组/ 来/ 表示/ 浮点数/ ,/ 随着/ 事件/ 序列/ 的/ 不断/ 增长/ ,/ s/ 不断/ 变小/ ,/ 表示/ s/ 所/ 需/ 的/ 位数/ 也/ 不断/ 增加/ ,/ 计算/ b/ ·/ s/ 的/ 复杂度/ 也/ 不断/ 提高/ ./ 为了/ 解决/ 这个/ 问题/ ,/ CADM/ 在/ 处理/ 每/ 一段/ 时/ 将/ 代表/ 之前/ 正常/ 事件/ 序列/ 的/ 区间/ 被/ 重置/ 为/ [/ 0/ ,/ 1/ ]/ ./ 这样/ 虽然/ 会/ 丢失/ 整个/ 事件/ 序列/ 的/ 长度/ 信息/ ,/ 但/ 估计/ 相对/ 熵/ 仅/ 需要/ 使用/ 该段/ 序列/ 的/ 增量/ 长度/ ./ 这种/ 近似/ 对/ 区间/ 增量/ 长度/ 计算/ 的/ 影响/ 非常/ 小/ ./ 假设/ 当前/ 段/ 所有/ 事件/ 频率/ 的/ 乘积/ 是/ B/ ,/ 那么/ 采用/ 近似/ 方法/ 计算/ 区间/ 长度/ 导致/ 的/ 误差/ e/ ^/ 为/ e/ ^/ =/ -/ log2B/ +/ 1/ -/ 1/ -/ / -/ log2B/ -/ 1/ +/ log2s/ ·/ B/ +/ log2s/ =/ -/ 1/ ./ 使用/ 类似/ 的/ 方式/ ,/ 还/ 可以/ 证明/ e/ ^/ / 2/ ./ 因此/ 与/ 每/ 一段/ 的/ 长度/ 相比/ ,/ 在/ 估计/ 相对/ 熵/ 时/ e/ ^/ 是/ 可以/ 忽略不计/ 的/ ./ 但是/ ,/ 近似/ 方式/ 可以/ 大大/ 加快/ 算术/ 编码/ 部分/ 的/ 速度/ ./ 在/ 顺序/ 压缩/ [/ 22/ ]/ 的/ 基础/ 上/ 采用/ 如/ 上/ 改造/ ,/ 最终/ 得到/ 的/ 算法/ 如/ 算法/ 2/ 所示/ ./ 算法/ 2/ ./ 压缩算法/ ./ 输入/ :/ ctx/ :/ 压缩/ 过/ 之前/ 所有/ 正常/ 事件/ 序列/ 的/ 压缩器/ 输出/ :/ 使用/ ctx/ 压缩/ 当前/ 段/ 的/ 编码/ 大小/ 过程/ :/ PROCEDURECOMPRESS/ (/ ctx/ ,/ segment/ )/ 将/ 当前/ 段/ 的/ 大小/ 估计/ 重置/ 为/ 1WHILE/ 当前/ 段/ 中/ 还有/ 事件/ DOsymbol/ ←/ longest/ _/ match/ (/ ctx/ ,/ segment/ )/ grammar/ _/ transform/ (/ ctx/ ,/ symbole/ )/ arithmetic/ _/ coding/ (/ ctx/ ,/ symbol/ )/ 更新/ ctx/ 中/ symbol/ 的/ 频率/ ENDWHILERETURNlog2/ (/ ctx/ ./ number/ )/ +/ 1Page84/ ./ 3/ 计算/ 加速/ 与/ 复杂度/ 本节/ 将/ 描述/ CADM/ 检测/ 算法/ 实现/ 的/ 细节/ ,/ 并/ 分析/ 算法/ 的/ 计算/ 复杂度/ ./ 在/ 算法/ 2/ 中/ ,/ 一个/ 比较/ 耗时/ 的/ 步骤/ 是/ 寻找/ 与/ 当前/ 所有/ 表达式/ 匹配/ 的/ 最长/ 事件/ 序列/ ./ 如果/ 直接/ 采用/ 逐个/ 表达式/ 进行/ 比较/ 的/ 方式/ ,/ 该步/ 所/ 需/ 的/ 时间/ 将/ 随着/ 表达式/ 的/ 增多/ 而/ 增加/ ./ 为了/ 加速/ 这一/ 过程/ ,/ 我们/ 采用/ 了/ Tire/ 树为/ 所有/ 表达式/ 建立/ 索引/ ./ 由于/ 在/ 顺序/ 压缩算法/ 中/ 大多数/ 表达式/ 仅/ 包含/ 两个/ 符号/ ,/ 因此/ 一个/ 表达式/ 所/ 表示/ 的/ 序列/ 通常/ 是/ 另/ 一个/ 表达式/ 所/ 表示/ 序列/ 的/ 前缀/ ./ 使用/ Tire/ 树/ ,/ 我们/ 可以/ 合并/ 匹配/ 这些/ 表达式/ 所/ 需/ 的/ 计算/ ,/ 从而/ 充分利用/ 这种/ 前缀/ 特性/ ./ 可以/ 看出/ ,/ 使用/ Tire/ 树/ 索引/ 匹配/ 最长/ 序列/ 所/ 需/ 的/ 时间/ 随着/ 最终/ 匹配/ 的/ 序列/ 长度/ 线性/ 增长/ ./ 另/ 一个/ 比较/ 耗时/ 的/ 步骤/ 是/ 发现/ 当前/ 段/ 存在/ 异常/ 后/ 将/ 模型/ 恢复/ 到/ 检测/ 当前/ 段/ 之前/ 的/ 状态/ ./ 一个/ 简单/ 的/ 实现/ 是/ 在/ 每/ 检测/ 一段/ 之前/ 复制/ 模型/ ,/ 并/ 在/ 发现/ 当前/ 段/ 存在/ 异常/ 后/ 使用/ 复制/ 的/ 模型/ 代替/ 当前/ 模型/ ./ 这种/ 方法/ 所/ 需/ 的/ 时间/ 会/ 随着/ 文法/ 增多/ 而/ 变长/ ./ 实际上/ ,/ 检测/ 一段/ 事件/ 序列/ 仅/ 涉及/ 到/ 一小部分/ 文法/ 表达式/ ./ 因此/ ,/ 一种/ 更好/ 的/ 方法/ 是/ 记录/ 下/ 检测/ 过程/ 中/ 模型/ 发生/ 的/ 变化/ ,/ 并/ 在/ 检测/ 到/ 异常/ 时/ 采用/ 与/ 变化/ 相逆/ 的/ 过程/ 进行/ 恢复/ ./ 在/ 顺序/ 压缩算法/ 中/ ,/ 只有/ 当/ 进行/ 一次/ 最长/ 匹配/ 并且/ 代表/ 匹配/ 后/ 的/ 事件/ 序列/ 的/ 符号/ 被/ 拼接/ 到/ 文法/ 中/ 时/ ,/ 模型/ 才/ 会/ 发生变化/ ,/ 在下文/ 中/ 每/ 一次/ 这种/ 变化/ 被/ 称为/ 一/ 小步/ ./ 对于/ 文法/ 来说/ ,/ 只有/ 新/ 添加/ 的/ 表达式/ 、/ 在/ 被/ 延长/ 的/ 表达式/ 以及/ 使用/ 这些/ 表达式/ 对应/ 的/ 非/ 终结符/ 的/ 表达式/ 需要/ 被/ 记录/ ./ 如/ 第/ 2/ 节中/ 所述/ ,/ 每一/ 小步/ 中/ 这/ 3/ 类/ 表达式/ 的/ 数目/ 均/ 为/ 常数/ ./ 对于/ 算术/ 编码器/ ,/ 我们/ 使用/ 独立/ 的/ Hash/ 表来/ 记录/ 每/ 一个/ 符号/ 出现/ 频率/ 发生/ 的/ 变化/ ,/ 同样/ ,/ 每一/ 小步/ 中/ 这些/ 变化/ 的/ 数量/ 也/ 是/ 常量/ ./ 综上所述/ ,/ 在/ 每/ 一/ 小步/ 中/ ,/ 模型/ 发生/ 的/ 变化/ 以及/ 记录/ 这些/ 变化/ 所/ 需要/ 的/ 时间/ 随着/ 所/ 处理/ 的/ 事件/ 序列/ 的/ 长度/ 线性/ 增长/ ./ 由于/ 恢复/ 模型/ 仅仅/ 是/ 处理/ 本段/ 时/ 模型/ 变化/ 的/ 逆/ 过程/ ,/ 因此/ 恢复/ 模型/ 所/ 需/ 的/ 时间/ 也/ 正比/ 于/ 所/ 处理/ 的/ 事件/ 序列/ 长度/ ./ 在/ 模型/ 变化/ 和/ 恢复/ 的/ 过程/ 中/ ,/ 为/ 加快/ 匹配/ 速度/ 所/ 建立/ 的/ Tire/ 树/ 索引/ 也/ 需要/ 维护/ ./ 对于/ Tire/ 树/ 索引/ ,/ 存在/ 3/ 种/ 可能/ 的/ 操作/ ,/ 即/ 添加/ 一条/ 新/ 表达式/ 的/ 索引/ 、/ 扩展/ 一条/ 表达式/ 时/ 修改/ 索引/ 以及/ 模型/ 需要/ 恢复/ 时/ 将/ 索引/ 进行/ 恢复/ ./ 为了/ 快速/ 使用/ 以上/ 3/ 个/ 操作/ ,/ 并且/ 考虑/ 到/ 在/ Tire/ 树中/ 不/ 需要/ 删除/ 一个/ 中间/ 节点/ ,/ CADM/ 使用/ 动态/ 数组/ 来/ 存储/ 所有/ 的/ 节点/ ./ 从/ 顺序/ 压缩算法/ 的/ 第/ 2/ 种/ 和/ 第/ 3/ 种/ 情况/ 可以/ 看出/ ,/ 当/ 一条/ 新/ 表达式/ 被/ 添加/ 或/ 一条/ 原/ 表达式/ 被/ 延长/ 时/ ,/ 只有/ 新/ 拼接/ 的/ 事件/ 序列/ 所/ 对应/ 的/ 节点/ 需要/ 被/ 添加/ 到/ Tire/ 树中/ ,/ 而/ 该/ 事件/ 序列/ 恰好/ 是/ 最长/ 匹配/ 所/ 对应/ 的/ 序列/ ,/ 因此/ 前/ 两种/ 操作/ 的/ 时间/ 复杂度/ 正比/ 于/ 匹配/ 序列/ 的/ 长度/ ./ 对于/ Tire/ 树/ 索引/ 恢复/ 的/ 操作/ ,/ 由于/ 新/ 添加/ 的/ 节点/ 恰好/ 位于/ 存储/ Tire/ 树/ 节点/ 的/ 动态/ 数组/ 的/ 后部/ ,/ 因此/ 使用/ 单个/ 变量/ 来/ 记录/ 动态/ 数组/ 的/ 末尾/ ,/ 可以/ 在/ 常数/ 时间/ 内/ 完成/ 恢复/ ./ 恢复/ 时/ 的/ 另/ 一部分/ 工作/ 是/ 将/ 被/ 删除/ 节点/ 从/ 它们/ 父/ 节点/ 的/ 索引/ 中/ 删除/ ./ 由于/ 在/ 每/ 一/ 小步/ 中/ ,/ 只有/ 一个/ 节点/ 位于/ 新旧/ 节点/ 的/ 边界/ ,/ 因此/ 需要/ 删除/ 的/ 索引/ 数目/ 相对/ 于/ 所/ 处理/ 的/ 事件/ 序列/ 长度/ 至多是/ 线性/ 的/ ./ 从/ 上述/ 讨论/ 可以/ 看出/ ,/ 相对/ 于/ 事件/ 序列/ 的/ 长度/ ,/ 异常/ 检测/ 算法/ 中/ 每/ 一步/ 都/ 仅/ 需要/ 至多/ 线性/ 的/ 时间/ 复杂度/ ,/ 因此/ CADM/ 的/ 整体/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ ./ 这/ 说明/ CADM/ 具有/ 较/ 好/ 的/ 可扩展性/ ,/ 而且/ 异常/ 检测/ 延迟/ 不会/ 随着/ 事件/ 序列/ 的/ 增加/ 而/ 增长/ ./ 另一方面/ ,/ CADM/ 进行/ 异常/ 检测/ 所/ 需要/ 的/ 数据/ 仅为/ 已知/ 的/ 正常/ 日志/ 序列/ ,/ 因此/ CADM/ 是/ 一种/ 线性/ 时间/ 复杂度/ 的/ 在线/ 异常/ 检测/ 算法/ ./ 5/ 实验/ 与/ 分析/ 本节/ 将/ 描述/ 为/ 证明/ CADM/ 有效性/ 所作/ 的/ 实验/ ./ 我们/ 首先/ 在/ 人工/ 生成/ 的/ 日志/ 进行/ 实验/ 并/ 对/ CADM/ 进行/ 深入/ 的/ 分析/ ,/ 然后/ 在/ 公开/ 数据/ 集/ DARPA98BSM/ 审计/ 数据/ 上/ 对比/ CADM/ 和/ 其它/ 方法/ ./ 我们/ 的/ 原型/ 系统/ 使用/ Python2/ ./ 7/ 编写/ ,/ 约/ 有/ 3000/ 行/ 代码/ ./ 所有/ 实验/ 均/ 在/ 一台/ 3GB/ 内存/ 和/ 1.7/ GHz/ 双核/ 笔记本电脑/ 上/ 进行/ ./ 在/ 实验/ 中/ ,/ 我们/ 使用/ 公式/ 中/ 的/ 测度/ 来/ 衡量/ 检测/ 精度/ ./ 我们/ 使用/ 了/ ROC/ 曲线/ 来/ 比较/ 不同/ 的/ 方法/ ./ ROC/ 曲线/ 描绘/ 了/ 召回/ 率/ 与/ 假/ 阳性/ 比例/ 之间/ 的/ 关系/ ,/ 这种/ 关系/ 可以/ 通过/ 设置/ 不同/ 的/ 异常/ 阈值/ 来/ 获取/ ./ 另外/ ,/ CADM/ 在/ 应用/ 到/ 具体/ 的/ 场景/ 中/ 时/ ,/ 还/ 需要/ 首先/ 确定/ 所/ 使用/ 的/ 分段/ 方式/ ./ 5.1/ 马尔可夫/ 信源/ 在/ 本/ 实验/ 中/ ,/ 我们/ 在/ 随机/ 生成/ 的/ 事件/ 序列/ 上/ 对/ CADM/ 进行/ 验证/ ./ 本/ 实验/ 所用/ 到/ 的/ 事件/ 序列/ 是/ 由/ 一/ Page9/ 个/ 两/ 状态/ 的/ 一阶/ 马尔可夫/ 链/ 生成/ 的/ ,/ 该/ 马尔可夫/ 链/ 的/ 状态/ 转移/ 矩阵/ 为/ 其中/ p/ 是/ 一个/ 可/ 配置/ 的/ 参数/ ./ 对于/ 正常/ 事件/ 序列/ 和/ 异常/ 事件/ 序列/ ,/ 我们/ 使用/ 不同/ 的/ p/ ,/ 因此/ 它们/ 符合/ 不同/ 的/ 分布/ ./ 异常/ 检测/ 算法/ 负责/ 将/ 异常/ 序列/ 从/ 正常/ 序列/ 中/ 识别/ 出来/ ./ 我们/ 使用/ 两类/ 不同/ 的/ 序列/ 对/ CADM/ 算法/ 进行/ 评估/ ./ 对于/ 第/ 1/ 类/ 序列/ ,/ 如果/ 马尔可夫/ 链/ 在/ 两类/ 状态/ 下/ 分别/ 输出/ 字符/ “/ 0/ ”/ 和/ “/ 1/ ”/ ./ 而/ 对于/ 第/ 2/ 类/ 序列/ ,/ 两种/ 状态/ 下/ 的/ 输出/ 分别/ 变为/ “/ 30/ ”/ 和/ “/ 31/ ”/ ,/ 因此/ 马尔可夫/ 生成器/ 的/ 状态/ 轮换/ 无法/ 直接/ 从/ 最终/ 生成/ 的/ 事件/ 序列/ 中/ 获取/ ./ 对于/ 每/ 一类/ 序列/ ,/ 我们/ 设计/ 了/ 两个/ 测试用例/ ,/ 在/ 每个/ 测试用例/ 中/ ,/ 马尔可夫/ 生成器/ 选取/ 特定/ p/ 值/ 生成/ 10000/ 个/ 事件/ 作为/ 训练/ 序列/ ./ 待/ 测试/ 的/ 序列/ 包含/ 16000/ 个/ 事件/ ./ 在/ 待/ 测试/ 的/ 序列/ 中/ ,/ 前/ 8000/ 个/ 序列/ 为/ 生成器/ 使用/ 与/ 训练/ 序列/ 相同/ 的/ p/ 值/ ,/ 因此/ 前/ 8000/ 个/ 事件/ 应/ 被/ 识别/ 为/ 正常/ ;/ 后/ 8000/ 个/ 序列/ 则/ 使用/ 不同/ 的/ p/ 值/ 生成/ ,/ 因此/ 应/ 被/ 识别/ 为/ 异常/ ./ 我们/ 将/ 正常/ 序列/ 的/ p/ 值/ 记作/ pn/ ,/ 异常/ 序列/ 的/ p/ 值/ 记作/ pa/ ./ 另外/ ,/ 我们/ 采用/ 等/ 事件/ 数/ 分段/ 的/ 方式/ ,/ 每/ 一段/ 的/ 事件/ 数设/ 为/ 80/ ./ 在/ 每个/ 测试用例/ 中/ ,/ 针对/ 较易/ 检测/ 和/ 较/ 难/ 检测/ 两种/ 场景/ ,/ 我们/ 分别/ 选取/ pn/ =/ 0.2/ ,/ pa/ =/ 0.8/ 以及/ pn/ =/ 0.5/ ,/ pa/ =/ 0.8/ 两组/ 值/ 作为/ 代表/ ./ 作为/ 比较/ ,/ 我们/ 首先/ 将/ 文献/ [/ 12/ ]/ 中/ 提出/ 的/ 马尔可夫/ 模型/ 应用/ 到/ 这/ 两个/ 测试用例/ 上/ ./ 该/ 方法/ 首先/ 使用/ 训练/ 数据/ 来/ 训练/ 一个/ 一阶/ 马尔可夫/ 模型/ ,/ 并/ 使用/ 该/ 模型/ 来/ 判断/ 每/ 一段/ 出现/ 的/ 概率/ ,/ 如果/ 概率/ 较小则/ 视为/ 异常/ ./ 将/ 马尔可夫/ 模型/ 应用/ 到/ 两个/ 测试用例/ 上/ 的/ 结果/ 如图/ 2/ 所示/ ./ 对于/ 第/ 1/ 个/ 测试用例/ ,/ 当/ pn/ 和/ pa/ 差距/ 较大/ 时/ ,/ 马尔可夫/ 模型/ 对/ 正常/ 序列/ 和/ 异常/ 序图/ 2/ 马尔可夫/ 模型/ 对/ 人工/ 生成/ 数据/ 进行/ 异常/ 检测/ 的/ 结果/ 列/ 的/ 概率/ 估计/ 有/ 明显/ 的/ 差异/ ,/ 因此/ 可以/ 将/ 这/ 两类/ 序列/ 分辨/ 开/ ./ 但是/ ,/ 当/ pn/ =/ 0.5/ ,/ pa/ =/ 0.8/ 时/ ,/ 由于/ 差距/ 比较/ 小/ ,/ 马尔可夫/ 过程/ 没能/ 将/ 这/ 两类/ 序列/ 分辨/ 开/ ./ 对于/ 第/ 2/ 种/ 测试用例/ ,/ 无论/ pn/ 和/ pa/ 的/ 值/ 是/ 什么/ ,/ 马尔可夫/ 模型/ 均/ 无法/ 将/ 两类/ 序列/ 分辨/ 开来/ ./ 这/ 说明/ 马尔可夫/ 的/ 性质/ 不仅/ 与/ 测试/ 场景/ 的/ 难度/ 有关/ ,/ 当/ 序列/ 不/ 符合/ 马尔可夫/ 性质/ 时/ ,/ 即使/ 在/ 测试/ 场景/ 比较简单/ 的/ 情况/ 下/ ,/ 马尔可夫/ 过程/ 也/ 无法/ 将/ 序列/ 分辨/ 开/ ./ 然后/ ,/ 我们/ 将/ CADM/ 算法/ 应用/ 到/ 这/ 两个/ 测试用例/ 上/ ,/ 测试/ 结果/ 如图/ 3/ 所示/ ./ 对于/ 第/ 1/ 种/ 情形/ ,/ CADM/ 的/ 结果/ 不比/ 马尔可夫/ 模型/ 差/ ./ 但是/ ,/ 对于/ 第/ 2/ 个/ 测试用例/ ,/ 当/ 序列/ 上/ 的/ 马尔可夫/ 性质/ 不/ 成立/ 时/ ,/ 传统/ 的/ 马尔可夫/ 模型/ 无能为力/ ,/ CADM/ 仍然/ 有效/ ./ 这/ 是因为/ CADM/ 不/ 依赖于/ 序列/ 概率分布/ 上/ 的/ 假设/ ./ 因此/ ,/ CADM/ 可以/ 被/ 应用/ 到/ 更/ 广泛/ 的/ 场景/ 下/ ,/ 并且/ 在/ 没有/ 关于/ 序列/ 概率分布/ 的/ 先验/ 知识/ 时会/ 有/ 更优/ 的/ 检测/ 结果/ ./ 图/ 3CADM/ 对/ 人工/ 生成/ 数据/ 进行/ 异常/ 检测/ 的/ 结果/ 5.2/ 参数/ 调优/ 与/ 分析/ 在/ 本/ 实验/ 中/ ,/ 我们/ 将/ CADM/ 应用/ 到/ 上/ 一节/ 中/ 的/ 马尔可夫/ 生成器/ 生成/ 的/ 更/ 多/ 测试用例/ 上以/ 对/ CADM/ 进行/ 评估/ 和/ 分析/ ./ 我们/ 采用/ 等/ 事件/ 个数/ 的/ 分段/ 方式/ 并/ 首先/ 将/ 每/ 一段/ 大小/ 设为/ 80/ ,/ 并且/ 将/ 异常/ 检测/ 阈值/ 和/ 学习/ 阈值/ 均/ 设为/ 0/ ./ 由于/ 在/ 前/ 一/ 实验/ 中/ ,/ CADM/ 在/ pn/ =/ 0.5/ ,/ pa/ =/ 0.8/ 的/ 测试用例/ 中/ 表现/ 较差/ ,/ 本/ 实验/ 中/ 采用/ 相似/ 的/ 测试用例/ 进行/ 测试/ ,/ 并/ 使用/ 易/ 测试/ 的/ 用例/ pn/ =/ 0.2/ ,/ pa/ =/ 0.9/ 作为/ 对比/ ./ 上述/ 实验/ 的/ 结果/ 如表/ 2/ 所示/ ./ 在/ 这个/ 表格/ 中/ ,/ 还/ 列出/ 了/ 正常/ 序列/ 与/ 异常/ 序列/ 概率分布/ 的/ 真实/ 相对/ 熵/ 值/ ./ 从表/ 2/ 中/ ,/ 我们/ 发现/ 在/ 当前/ 参数/ 下/ ,/ CADM/ 在/ 一些/ 测试用例/ 中/ 召回/ 率/ 特别/ 低/ ./ 另外/ ,/ 召回/ 率/ 与/ 正常/ 事件/ 序列/ 及/ 异常/ 事件/ 序列/ 的/ 相对/ 熵/ 存在/ 联系/ ./ 当/ 正常/ 序列/ 与/ 异常/ 序列/ 的/ 相对/ 熵/ 差距/ 较/ 小时/ ,/ 算法/ 将/ 失效/ ./ 为了/ 找出/ 算法/ 失效/ 的/ 原因/ ,/ 我们/ 在/ 图/ 4/ 中/ 描绘/ 了/ Page10pn/ =/ 0.2/ pa/ =/ 0.40/ ./ 15180.8000/ ./ 0420.0500/ —/ 0pn/ =/ 0.2/ pa/ =/ 0.50/ ./ 321390.9750/ ./ 2040.1070/ —/ 0pn/ =/ 0.2/ pa/ =/ 0.60/ ./ 5511611.0000/ ./ 8390.1830/ —/ 0pn/ =/ 0.5/ pa/ =/ 0.70/ ./ 1190/ —/ 00.0390/ —/ 0pn/ =/ 0.5/ pa/ =/ 0.80/ ./ 27841.0000/ ./ 0210.092110/ ./ 003pn/ =/ 0.5/ pa/ =/ 0.90/ ./ 531351.0000/ ./ 1900.1770/ —/ 0pn/ =/ 0.2/ pa/ =/ 0.91/ ./ 6521921.0001/ ./ 0000.55037111/ 部分/ 测试用例/ 的/ 详细/ 结果/ ./ 由于/ CADM/ 算法/ 的/ 本质/ 是/ 使用/ 增量/ 压缩/ 的/ 大小/ uc/ (/ m/ |/ M/ )/ 和/ 单独/ 压缩/ 的/ 大小/ uc/ (/ m/ )/ 的/ 差来/ 估计/ 相对/ 熵/ ,/ 每/ 一段/ 的/ uc/ (/ m/ |/ M/ )/ 和/ uc/ (/ m/ )/ 的/ 大小/ 对/ 估计/ 和/ 检测/ 的/ 准确度/ 至关重要/ ./ 因此/ ,/ 对于/ 一些/ 测试用例/ ,/ 我们/ 在/ 图/ 4/ 中/ 描绘/ 了/ 每/ 一段/ 增量/ 压缩/ 大小/ 和/ 单独/ 压缩/ 大小/ ./ 在/ 图/ 4/ 中/ ,/ 左上角/ 的/ 图/ 描绘/ 了/ 最/ 理想/ 的/ 情况/ :/ 对于/ 正常/ 的/ 段/ ,/ uc/ (/ m/ |/ M/ )/ 和/ uc/ (/ m/ )/ 十分/ 接近/ ,/ 因为/ D/ (/ Q/ ‖/ P/ )/ 等于/ 0/ ;/ 对于/ 异常/ 的/ 段/ ,/ uc/ (/ m/ |/ M/ )/ 有/ 一个/ 明显/ 的/ 增量/ ,/ 因为/ 异常/ 的/ 段/ 是/ 在/ 错误/ 概率/ 估计/ 的/ 基础/ 上/ 进行/ 压缩/ ./ 利用/ 这个/ 差异/ ,/ 算法/ 可以/ 很/ 容易/ 地/ 将/ 正常/ 序列/ 和/ 异常/ 序列/ 区分/ 开来/ ./ 但是/ ,/ 从/ 其它/ 几幅/ 图/ 可以/ 看出/ ,/ 当/ 相对/ 熵/ 较/ 小时/ ,/ uc/ (/ m/ )/ 的/ 冗余/ 超过/ 了/ 使用/ 错误/ 概率/ 压缩/ 时/ uc/ (/ m/ |/ M/ )/ 的/ 增量/ ,/ 从而/ 导致/ 了/ 漏检/ ./ 因此/ ,/ 算法/ 失效/ 主要/ 是/ 由于/ 对/ m/ 进行/ 压缩/ 时/ 结果/ 编码/ 相对/ 于/ 信源/ 熵/ 率/ 冗余/ 过大/ ./ 另外/ ,/ 从/ 左下角/ 图片/ 还/ 可以/ 看出/ 错误/ 学习/ 假/ 阴性/ 的/ 序列/ 会/ 导致/ 对/ 正常/ 事件/ 序列/ 的/ 概率/ 估计/ 发生/ 偏移/ ,/ 从而/ 加重/ 漏检/ 的/ 情况/ ./ 图/ 4/ 对于/ 特定/ 测试/ 集/ 单独/ 压缩/ 和/ 增量/ 压缩/ 大小/ 的/ 关系/ 对于/ 错误/ 学习/ 的/ 问题/ ,/ 可以/ 通过/ 使用/ 较/ 高/ 的/ 学习/ 阈值/ 来/ 解决/ ./ 另一方面/ ,/ 可以/ 通过/ 增加/ 每/ 一段/ 的/ 事件/ 数/ W/ 来/ 增加/ 压缩率/ ./ 通过/ 使用/ 较长/ 的/ 段/ ,/ 测试/ 序列/ 中/ 的/ 重复/ 结构/ 可以/ 被/ 充分利用/ ,/ 其/ 单个/ 事件/ 压缩/ 后/ 的/ 大小/ 会/ 更加/ 接近/ 信源/ 的/ 熵/ 率/ ,/ 从而/ 提高/ 了/ 相对/ 熵/ 估计/ 的/ 精确度/ ./ 使用/ 不同/ 窗口/ 大小/ 的/ 效果/ 如表/ 3/ 左/ 半部/ 所示/ ./ 对于/ 每/ 一个/ 测试用例/ ,/ 我们/ 列出/ 了/ 不同/ 窗口/ 大小/ 下/ 所有/ 异常/ 序列/ 的/ 相对/ 熵/ 估计/ λ/ ^/ =/ 1/ // n/ [/ uc/ (/ m/ |/ M/ )/ -/ uc/ (/ m/ )/ ]/ 的/ 平均值/ ./ 另外/ 需要/ 指出/ 的/ 是/ ,/ 在/ 段/ 的/ 长度/ 不同/ 的/ 情况/ 下/ 进行/ 实验/ 时/ ,/ 训练/ 序列/ 的/ 长度/ 应该/ 随着/ 段/ 的/ 长度/ 线性/ 增长/ ,/ 因为/ 定理/ 1/ 中/ 要求/ 正常/ 序列/ 大小/ 和/ 段/ 的/ 大小/ 满足条件/ N/ / Cn/ ./ 从表中/ ,/ 我们/ 可以/ 看出/ 相对/ 熵/ 估计值/ 和/ 理论值/ 之间/ 的/ 差异/ 随着/ 段/ 的/ 长度/ 增大/ 而/ 减小/ ,/ 因此/ 使用/ 较长/ 的/ 段/ 有利于/ 提高/ 召回/ 率/ ./ 表/ 3/ 不同/ 窗口/ 大小/ 及/ 是否/ 采用/ 重复/ 对/ 估计/ 精度/ 的/ 影响/ 测试/ 段长度/ pn/ =/ 0.2/ ,/ pa/ =/ 0.4/ -/ 0.104/ -/ 0.069/ -/ 0.062/ -/ 0.0490/ ./ 01230.0230/ ./ 0320.056/ pn/ =/ 0.2/ ,/ pa/ =/ 0.50/ ./ 2160.0740/ ./ 0560.1350/ ./ 2230.2980/ ./ 2410.241/ pn/ =/ 0.2/ ,/ pa/ =/ 0.60/ ./ 2460.2480/ ./ 2710.3660/ ./ 4090.3900/ ./ 4190.477/ pn/ =/ 0.5/ ,/ pa/ =/ 0.7/ -/ 0.192/ -/ 0.174/ -/ 0.124/ -/ 0.139/ -/ 0.030/ -/ 0.027/ -/ 0.006/ -/ 0.031/ pn/ =/ 0.5/ ,/ pa/ =/ 0.8/ -/ 0.0630/ ./ 0220.0590/ ./ 0610.0820/ ./ 1300.1520/ ./ 162pn/ =/ 0.5/ ,/ pa/ =/ 0.90/ ./ 1330.1800/ ./ 2550.3320/ ./ 2940.3470/ ./ 4060.424/ 但是/ ,/ 实际/ 中段/ 的/ 长度/ 无法/ 设置/ 得/ 非常/ 大/ ./ 首先/ ,/ 段/ 越长/ ,/ 每/ 一个/ 警告/ 所/ 能/ 提供/ 的/ 信息/ 就/ 越/ 小/ ,/ 因为/ 管理人员/ 需要/ 通读/ 整个/ 段/ 的/ 日志/ 来/ 确定/ 异常/ 发生/ 的/ 原因/ ./ 其次/ ,/ 在/ 实际/ 日志/ 中/ ,/ 异常/ 相关/ 的/ 信息/ 在/ 日志/ 中/ 可能/ 不是/ 连续/ 的/ ,/ 如果/ 使用/ 较长/ 的/ 段/ 可能/ 导致/ 异常/ 信息/ 引起/ 的/ 相对/ 熵/ 的/ 差异/ 被/ 周围/ 正常/ 的/ 日志/ 所/ 湮没/ ./ 最后/ ,/ 如前所述/ ,/ 使用/ 较长/ 的/ 段/ 意味着/ 必须/ 使用/ 更长/ 的/ 训练/ 日志/ ./ Page11/ 为了/ 解决/ 段长度/ 的/ 矛盾/ ,/ CADM/ 使用/ 了/ 另外/ 一种/ 方法/ 来/ 加速/ 单独/ 压缩/ 时/ 的/ 压缩/ 大小/ 的/ 收敛/ 过程/ ,/ 即将/ 该段/ 的/ 日志/ 复制/ 一份/ 拼接/ 到/ 该段/ 之后/ ,/ 然后/ 使用/ 处理/ 后/ 的/ 段/ 的/ 压缩/ 大小/ 的/ 一半/ 作为/ 对/ 压缩/ 大小/ 的/ 估计/ ./ 对于/ 文法/ 压缩/ 来说/ ,/ 这种/ 方式/ 使/ 前半部/ 分/ 创建/ 的/ 表达式/ 规则/ 在/ 后/ 一段/ 中/ 充分/ 使用/ ,/ 因此/ 可以/ 提高/ 相对/ 熵/ 估计/ 的/ 精确度/ ./ 使用/ 这种/ 方法/ 后/ 对/ 不同/ 段/ 的/ 长度/ 的/ 估计值/ 如表/ 3/ 右半/ 部分/ 所示/ ./ 可以/ 看出/ ,/ 复制/ 的/ 方法/ 可以/ 使用/ 一个/ 较/ 小/ 的/ 段长度/ ,/ 从而/ 避免/ 段/ 过长/ 带来/ 的/ 问题/ ,/ 也/ 可以/ 减少/ 估计/ 误差/ ./ 即使/ 使用/ 复制/ 的/ 策略/ ,/ 当/ 正常/ 序列/ 与/ 异常/ 序列/ 的/ 实际/ 相对/ 熵/ 过/ 小时/ ,/ 仍然/ 会/ 发生/ 错误/ 分类/ 的/ 情况/ ./ 但是/ ,/ 实际/ 中/ 异常/ 对应/ 事件/ 序列/ 与/ 正常/ 序列/ 之间/ 的/ 相对/ 熵/ 一般/ 可以/ 满足/ 检测/ 的/ 要求/ ./ 如果/ 不能/ ,/ 就/ 需要/ 更换/ 日志/ 转换/ 的/ 策略/ ,/ 使用/ 更/ 多/ 的/ 信息/ 来/ 增大/ 异常/ 序列/ 与/ 正常/ 序列/ 的/ 实际/ 相对/ 熵/ ./ 5.3/ DARPA98/ 日志/ 检测/ 在/ 本节/ 中/ ,/ 我们/ 使用/ DARPA98BSM/ 测试/ 集/ ①/ 对/ CADM/ 进行/ 验证/ ./ DARPA98BSM/ 测试/ 集是/ 一个/ 开源/ 入侵/ 检测/ 测试/ 集/ ,/ 它/ 的/ 数据/ 来自/ 于/ 一个/ Solaris/ 集群/ 9/ 周内/ 的/ BSM/ 审计/ 日志/ ./ 在/ DARPA98/ 测试/ 集中/ ,/ 所有/ 的/ BSM/ 审计/ 日志/ 都/ 被/ 划分/ 为会话/ ,/ 每/ 一个/ 会话/ 对应/ 于/ 两台/ 服务器之间/ 的/ 一次/ TCP/ 连接/ ./ 不同/ 的/ 会/ 话/ 可能/ 属于/ 不同/ 的/ 服务/ ./ 每/ 一个/ 会话/ 的/ 系统/ 调用/ 序列/ 被/ 记录/ 在/ 了/ 审计/ 日志/ 中/ ./ 会话/ 是/ BSM/ 审计/ 日志/ 的/ 最小/ 单位/ 并且/ 标注/ 了/ 是否/ 异常/ ,/ 因此/ 我们/ 将/ 每个/ 会话/ 视为/ 测试日志/ 中/ 的/ 一段/ ,/ 对/ 每/ 一个/ 会话/ 的/ 异常/ 程度/ 进行/ 评估/ ./ 在/ 本/ 实验/ 中/ ,/ 我们/ 仅/ 使用/ 了/ 会/ 话/ 中/ 的/ 系统/ 调用/ 类型信息/ ./ 整个/ 测试/ 集中/ 一共/ 有/ 50/ 种/ 系统/ 调用/ ./ 在/ 原始数据/ 中/ ,/ 不同/ 服务/ 的/ 会/ 话/ 是/ 混合/ 在/ 一起/ 的/ ./ 我们/ 首先/ 根据/ 会话/ 所属/ 的/ 服务/ 对会话/ 进行/ 分类/ ./ 然后/ ,/ 我们/ 选择/ 那些/ 有/ 足够/ 数量/ 正常/ 会话/ 与/ 异常/ 会话/ 的/ 服务/ 作为/ 测试/ 集/ ./ 一共/ 有/ 4/ 种/ 服务/ 满足/ 我们/ 的/ 要求/ ,/ 即/ FTP/ 、/ SMTP/ 、/ Telnet/ 、/ Finger/ ,/ 因此/ 整个/ 测试/ 包括/ 4/ 个/ 测试用例/ ./ 在/ 某些/ 测试用例/ 中/ ,/ 我们/ 注意/ 到/ 一些/ 被/ 标记/ 为/ 攻击/ 的/ 会/ 话/ 与/ 某些/ 标记/ 为/ 正常/ 的/ 会/ 话/ 有/ 相同/ 的/ 系统/ 调用/ 序列/ ,/ 这/ 说明/ 这些/ 攻击/ 的/ 检测/ 无法/ 仅/ 通过/ 调用/ 类型信息/ 实现/ ./ 在/ 本/ 实验/ 中/ ,/ 我们/ 移除/ 这些/ 会话/ ./ 另一方面/ ,/ BSM/ 审计/ 日志/ 中/ 的/ 每/ 一个/ 会话/ 均/ 由/ 包括/ 多个/ 进程/ 的/ 调用/ 序列/ 组成/ ,/ 这些/ 序列/ 也/ 是/ 混合/ 在/ 一起/ 的/ ./ 我们/ 重排/ 了/ 每/ 一个/ 会话/ 中/ 调用/ 事件/ 的/ 顺序/ ,/ 使得/ 来自/ 同一个/ 进程/ 的/ 调用/ 事件/ 彼此/ 相邻/ ./ 之后/ ,/ 对于/ 移除/ 重复/ 会话/ 后/ 的/ 剩余/ 会话/ ,/ 我们/ 以天/ 为/ 单位/ 随机/ 地/ 将/ 所有/ 正常/ 会话/ 平分/ ,/ 分别/ 作为/ 训练/ 集和正/ 样本/ 集/ ./ 最终/ 形成/ 的/ 测试/ 集/ 的/ 信息/ 如表/ 4/ 所示/ ./ 测试/ 集/ 训练/ 日志/ Finger/ 第/ 1/ 周/ FTP/ 第/ 1/ ~/ 3/ 周/ ,/ T1/ ,/ T3/ 第/ 4/ ~/ 7/ 周/ 233Telnet/ 第一周/ 星期/ 1/ ,/ 3/ ,/ 5/ 第一周/ 星期/ 2/ ,/ 4113SMTP/ 第一周/ 星期/ 1/ ,/ 2/ 第一周/ 星期/ 3/ ,/ 4/ ,/ 5120/ 我们/ 选择/ 马尔可夫/ 模型/ [/ 12/ ]/ 和/ 统计/ 模型/ [/ 9/ ]/ 作为/ 对比/ ./ 3/ 种/ 方法/ 都/ 会/ 对/ 每/ 一段/ 的/ 异常/ 程度/ 进行/ 评分/ ./ 但是/ ,/ 原文中/ 马尔可夫/ 模型/ 假设/ 各个/ 段/ 的/ 长度/ 是/ 相同/ 的/ ,/ 这一/ 性质/ 在/ 本/ 实验/ 中/ 并/ 不/ 成立/ ./ 因此/ ,/ 原始/ 马尔可夫/ 模型/ 倾向/ 于/ 将/ 长/ 的/ 段/ 标记/ 为/ 异常/ ./ 为了/ 解决/ 这一/ 问题/ ,/ 我们/ 使用/ 如下/ 公式/ 对/ 马尔可夫/ 模型/ 的/ 评分/ 进行/ 正规化/ :/ 最终/ 的/ 测试/ 结果/ 如图/ 5/ 所示/ ./ 从图/ 5/ 中/ 可以/ 看出/ ,/ 虽然/ 4/ 个/ 测试/ 集/ 难度/ 不同/ ,/ 但/ 在/ 所有/ 测试/ 集中/ ,/ CADM/ 的/ 结果/ 都/ 优于/ 其它/ 两种/ 方法/ ./ 这/ 说明/ 独立性/ 假设/ 和/ 马尔可夫/ 假设/ 在/ 这些/ 测试/ 集上/ 都/ 不/ 成立/ ./ 为了/ 进一步/ 说明/ 统计/ 方法/ 和/ 马尔可夫/ 方法/ 失效/ 的/ 原因/ ,/ 我们/ 选择/ Telnet/ 测试用例/ 并/ 在/ 图/ 6/ 中画/ 出/ 了/ 每/ 一个/ 系统/ 调用/ 及/ 相邻/ 的/ 系统/ 调用/ 对/ 出现/ 的/ 频率/ ./ 根据/ 统计/ 方法/ 和/ 马尔可夫/ 方法/ 依赖/ 的/ 假设/ ,/ 上述/ 频率/ 是/ 这/ 两种/ 方法/ 进行/ 异常/ 检测/ 时所/ 依赖/ 的/ 所有/ 信息/ ./ 如果/ 正常/ 序列/ 和/ 异常/ 序列/ 从/ 这些/ 频率/ 信息/ 上/ 无/ ①/ Darpa89/ 测试/ 集/ http/ :/ // // www/ ./ ll/ ./ mit/ ./ edu/ // mission/ // commu/ -/ Page12/ 法/ 分辨/ ,/ 则/ 可以/ 预期/ 这/ 两种/ 方法/ 无法/ 有效/ 工作/ ./ 从图/ 6/ 中/ 可以/ 看出/ ,/ 正常/ 序列/ 和/ 异常/ 序列/ 的/ 这/ 两种/ 频率/ 分布/ 基本/ 相似/ ,/ 这/ 就/ 解释/ 了/ 马尔可夫/ 模型/ 和/ 统计/ 模型/ 失效/ 的/ 原因/ ./ 图/ 6/ 系统/ 调用/ 和/ 相邻/ 系统/ 调用/ 对/ 的/ 频率/ 的/ 统计/ 类似/ BSM/ 审计/ 日志/ ,/ 现实/ 日志/ 中/ 事件/ 的/ 概率分布/ 可能/ 比较复杂/ ,/ 使用/ 简单/ 直观/ 的/ 假设/ 将/ 无法/ 捕捉到/ 异常/ 日志/ 的/ 特征/ ./ 从/ 以上/ 实验/ 中/ ,/ 我们/ 可以/ 看出/ ,/ 通过/ 去/ 移除/ 对/ 这些/ 假设/ 的/ 依赖/ ,/ CADM/ 可以/ 在/ 更/ 大/ 范围/ 的/ 日志/ 上/ 有/ 更好/ 的/ 效果/ ./ 因此/ ,/ CADM/ 更/ 适合/ 用于/ 日志/ 的/ 在线/ 异常/ 检测/ ./ 5.4/ 可扩展性/ 在/ 本/ 实验/ 中/ ,/ 我们/ 对/ CADM/ 的/ 运行/ 效率/ 进行/ 评测/ ./ 我们/ 使用/ 5.1/ 节中/ 的/ 马尔可夫/ 生成器/ 生成/ 不同/ 长度/ 的/ 日志/ ,/ 然后/ 以/ 一种/ 离线/ 的/ 方式/ 测量/ CADM/ 在/ 这些/ 日志/ 上/ 的/ 运行/ 时间/ ./ 最终/ 测试/ 的/ 结果/ 如图/ 7/ 所示/ ./ 从/ 该/ 图/ 可以/ 看出/ CADM/ 是/ 一种/ 线性/ 时间/ 复杂度/ 的/ 算法/ ,/ 无论/ 已经/ 运行/ 多长时间/ ,/ CADM/ 检测/ 到/ 异常/ 的/ 时间延迟/ 都/ 不会/ 增长/ ./ 因此/ ,/ CADM/ 有/ 较/ 好/ 的/ 可扩展性/ ,/ 更/ 适合/ 于/ 在线/ 异常/ 检测/ ./ 图/ 7CADM/ 在/ 不同/ 大小/ 日志/ 上/ 的/ 运行/ 时间/ 6/ 结论/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 离散/ 序列/ 异常/ 检测/ 方法/ CADM/ ,/ 并且/ 给出/ 了/ 这种/ 方法/ 的/ 理论/ 分析/ 和/ 实验/ 评估/ ./ CADM/ 选择/ 相对/ 熵/ 作为/ 测试日志/ 与/ 异常/ 日志/ 的/ 度量/ 并且/ 使用/ 压缩/ 后/ 的/ 编码/ 大小/ 来/ 估计/ 相对/ 熵/ ./ 从/ 实验/ 中/ 可以/ 看出/ ,/ 与/ 其它/ 方法/ 相比/ ,/ CADM/ 不/ 依赖于/ 关于/ 概率分布/ 的/ 先验/ 知识/ 并且/ 具有/ 线性/ 时间/ 复杂度/ ,/ 因此/ 更/ 适合/ 于/ 在线/ 异常/ 检测/ ./ 本文/ 进行/ 日志/ 转换/ 时/ 使用/ 了/ 现有/ 的/ 方法/ ./ 由于/ 日志/ 转换/ 对/ 整个/ 异常/ 检测/ 过程/ 的/ 准确度/ 非常/ 重要/ ,/ 因此/ 在/ 未来/ 我们/ 将/ 研究/ 针对/ 专用/ 的/ 文本/ 和/ 高维/ 数据/ 的/ 序列/ 转换方法/ ./ 

