Page1/ 特征/ 模型/ 定制/ 的/ 一种/ 自动/ 传播/ 策略/ 与/ 选择性/ 回退/ 机制/ 李龙/ 赵/ 海燕/ 张伟/ (/ 高/ 可信/ 软件技术/ 教育部/ 重点/ 实验室/ 北京/ 100871/ )/ (/ 北京大学/ 信息/ 科学技术/ 学院/ 软件/ 研究所/ 北京/ 100871/ )/ 摘要/ 面向/ 特征/ 的/ 分析方法/ 已/ 被/ 主流/ 的/ 软件/ 复用/ 方法/ 接受/ ./ 其/ 基本/ 思想/ 是/ 将/ 软件/ 的/ 特征/ 作为/ 软件/ 解决/ 需求/ 问题/ 的/ 基本要素/ ,/ 使用/ 特征/ 以及/ 特征/ 之间/ 的/ 关系/ (/ 这/ 两者/ 的/ 组合/ 也/ 被/ 称为/ 特征/ 模型/ )/ 来/ 组织/ 软件/ 的/ 需求/ ./ 特征/ 模型/ 良好/ 的/ 可/ 剪裁/ 性/ 和/ 可扩展性/ ,/ 为/ 领域/ 需求/ 的/ 复用/ 提供/ 了/ 有力/ 的/ 支持/ ./ 在/ 当前/ 的/ 面向/ 特征/ 的/ 方法/ 中/ ,/ 特征/ 模型/ 上/ 的/ 一个/ 定制/ 决策/ 会/ 影响/ 其他/ 相关/ 特征/ 的/ 绑定/ 状态/ ./ 如何/ 使用/ 特征/ 模型/ 之间/ 内在/ 的/ 关联/ 关系/ 来/ 实现/ 特征/ 模型/ 的/ 定制/ 的/ 自动/ 传播/ 算法/ 与/ 选择性/ 回退/ 算法/ 是/ 一个/ 值得/ 进行/ 深入研究/ 的/ 课题/ ./ 作者/ 给出/ 了/ 特征/ 模型/ 定制/ 的/ 一种/ 自动/ 传播/ 策略/ 与/ 选择性/ 回退/ 机制/ ,/ 针对/ 特征/ 模型/ 中/ 存在/ 的/ 二元/ 约束/ 与/ 组合/ 约束/ 进行/ 分析/ ,/ 介绍/ 该/ 算法/ 的/ 实现/ 细节/ ./ 关键词/ 软件/ 复用/ ;/ 特征/ 模型/ ;/ 模型/ 定制/ ;/ 自动/ 传播/ ;/ 选择性/ 回退/ 1/ 引言/ 随着/ 用户/ 对/ 软件产品/ 的/ 质量/ 和/ 性能/ 的/ 要求/ 越来越/ 高/ ,/ 软件/ 自身/ 的/ 规模/ 和/ 复杂性/ 也/ 随之/ 迅速/ 增长/ ,/ 软件开发/ 面临/ 的/ 压力/ 也/ 日益加剧/ ./ 因此/ ,/ 人们/ 希望/ 借鉴/ 成熟/ 高效/ 的/ 工业/ 产品/ 生产方式/ 来/ 开发/ 软件产品/ ./ 从/ 20/ 世纪/ 90/ 年代/ 以来/ ,/ 软件/ 复用/ 研究/ 重新/ 成为/ 了/ 热/ Page2/ 点/ ,/ 软件/ 复用/ 被/ 认为/ 是/ 解决/ “/ 软件/ 危机/ ”/ ,/ 提高/ 软件开发/ 效率/ 和/ 质量/ ,/ 实现/ 软件产业/ 工业化/ 生产方式/ 的/ 有效途径/ [/ 1/ ]/ ./ 作为/ 软件/ 复用/ 的/ 一种/ 重要途径/ ,/ 特征/ 建模/ 技术/ 被/ 用来/ 捕获/ 和/ 组织/ 领域/ 需求/ ,/ 文献/ [/ 2/ ]/ 的/ 思想/ 是/ 将/ 软件/ 需求/ 组织/ 成为/ 客户/ // 用户/ 价值/ 的/ 一组/ 特征/ ,/ 通过/ 特征/ 间/ 的/ 的/ 精化/ 关系/ 与/ 约束/ 关系/ 来/ 表示/ 需求/ 间/ 的/ 依赖/ 关系/ ,/ 提高/ 软件/ 需求/ 的/ 易/ 定制/ 性/ ./ 其/ 目的/ 是/ 通过/ 定制/ 操作/ 提取/ 领域/ 内/ 的/ 需求/ 实现/ 软件/ 复用/ ,/ 将/ 领域/ 特征/ 模型/ 转化/ 为/ 应用/ 系统/ 特征/ 模型/ ,/ 实现/ 领域/ 工程/ 与/ 应用/ 工程/ 之间/ 的/ 联系/ ,/ 将/ 已有/ 的/ 应用/ 系统/ 转化/ 为/ 新/ 的/ 应用/ 系统/ ,/ 实现/ 大/ 粒度/ 的/ 软件/ 复用/ ./ 基于/ 特征/ 模型/ 的/ 复用/ 一般/ 通过/ 特征/ 模型/ 的/ 定制/ 来/ 实现/ ./ 特征/ 模型/ 的/ 定制/ 技术/ 是/ 指/ 在/ 领域/ 特征/ 模型/ 中/ 选择/ 特征/ 添加/ 到/ 应用/ 系统/ 特征/ 模型/ 中/ ,/ 并且/ 满足/ 领域/ 特征/ 模型/ 所/ 建立/ 的/ 特征/ 间/ 的/ 约束/ 关系/ ./ 由于/ 特征/ 模型/ 中/ 存在/ 着/ 大量/ 的/ 约束/ 关系/ 与/ 精化/ 关系/ ,/ 使得/ 特征/ 模型/ 中/ 的/ 特征/ 间/ 存在/ 着/ 一定/ 联系/ ,/ 因此/ 在/ 确定/ 特征/ 的/ 绑定/ 状态/ 时/ ,/ 就/ 必须/ 考虑/ 特征/ 的/ 绑定/ 状态/ 是否/ 能够/ 满足/ 特征/ 模型/ 中/ 内含/ 的/ 精化/ 关系/ 与/ 约束/ 关系/ ,/ 而/ 人工/ 检测/ 则/ 极为/ 繁重/ 和/ 耗时/ ./ 因此/ ,/ 需要/ 有/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ 来/ 辅助/ 定制/ 者/ 进行/ 定制/ 操作/ ,/ 以/ 确保/ 定制/ 操作/ 可以/ 满足/ 特征/ 模型/ 的/ 精化/ 关系/ 与/ 约束/ 关系/ ./ 目前/ 关于/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ 的/ 研究/ 主要/ 集中/ 在/ 关于/ 二元/ 约束/ 与/ 精化/ 关系/ 的/ 定制/ 的/ 自动/ 传播/ ,/ 对/ 相关/ 复杂/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 机制/ 研究/ 较少/ ./ 当/ 定制/ 的/ 自动/ 传播/ 不/ 完全/ 时/ ,/ 就/ 有/ 可能/ 会/ 导致/ 冲突/ 现象/ 的/ 发生/ ./ 此外/ ,/ 对于/ 定制/ 者/ 采用/ 的/ 一些/ 不当/ 定制/ 决策/ ,/ 应/ 提供/ 机制/ 予以/ 取消/ ./ 在/ 取消/ 定制/ 决策/ 时/ ,/ 特征/ 的/ 绑定/ 状态/ 仍应/ 满足/ 特征/ 模型/ 中/ 的/ 精化/ 关系/ 与/ 约束/ 关系/ ./ 定制/ 不是/ 一个/ 单向性/ 的/ 过程/ ,/ 更/ 不能/ 对/ 先前/ 的/ “/ 失误/ ”/ 操作/ 无法/ 处理/ ./ 因此/ ,/ 提供/ 回退/ 机制/ 是/ 必要/ 的/ ./ 特征/ 模型/ 的/ 概念/ 最早/ 是/ 由/ Kang/ 等/ 人/ [/ 2/ ]/ 在/ 领域/ 分析方法/ 中/ 提出/ ./ 从/ 20/ 世纪/ 90/ 年代/ 以来/ ,/ 软件/ 复用/ 研究/ 重新/ 成为/ 了/ 热点/ ,/ 软件/ 复用/ 被/ 认为/ 是/ 解决/ “/ 软件/ 危机/ ”/ ,/ 提高/ 软件开发/ 效率/ 和/ 质量/ ,/ 实现/ 软件产业/ 工业化/ 生产方式/ 的/ 有效途径/ ./ 其中/ ,/ 在/ 特征/ 模型/ 的/ 定制/ 问题/ 上/ ,/ Mannion/ 等/ 人/ 的/ 方法/ [/ 3/ ]/ 是/ 一种/ 基于/ 树状/ 结构/ 的/ 特征/ 模型/ 定制/ 方法/ ./ 它/ 考查/ 了/ 特征/ 模型/ 中/ 变化/ 性/ 的/ 三种/ 表示/ 方式/ (/ 可选性/ 特征/ 、/ 多选/ 一/ 变化/ 点/ 以及/ 多选多/ 变化/ 点/ )/ ,/ 并/ 提出/ 了/ 从/ 树状/ 结构/ 的/ 根/ 出发/ ,/ 逐步/ 向下/ 对/ 特征/ 模型/ 进行/ 定制/ 的/ 策略/ ./ 这种/ 定制/ 方法/ 可以/ 保证/ 满足/ 同一个/ 变化/ 点/ 的/ 子/ 特征/ 之间/ 的/ 约束/ ,/ 然而/ 未必/ 可以/ 保证/ 满足/ 全局/ 的/ 约束/ ./ Hotz/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ 一种/ 基于/ 知识/ 的/ 定制/ 方法/ ./ 该/ 方法/ 使用/ 专门/ 的/ 配置/ 语言/ 将/ 特征/ 、/ 用户/ 需求/ 和/ 其它/ 制品/ 在/ 一个/ 单独/ 的/ 配置/ 模型/ 中/ 进行/ 建模/ ,/ 并且/ 提供/ 工具/ 对/ 产品/ 的/ 定制/ 生成/ 实现/ 部分/ 自动化/ ./ 然而/ ,/ 该/ 方法/ 没有/ 说明/ 配置/ 模型/ 与/ 特征/ 模型/ 以及/ 其它/ 模型/ 之间/ 的/ 联系/ 以及/ 相互/ 的/ 影响/ ./ FORM/ 方法/ 的/ 提出/ 者/ [/ 5/ ]/ 就/ 意识/ 到/ 了/ 在/ 选择/ 特征/ 的/ 时候/ ,/ 需要/ 检查/ 特征/ 模型/ 的/ 完整性/ 和/ 一致性/ ,/ 并且/ 提议/ 采用/ 约束/ 检查/ 算法/ 来/ 辅助/ 验证/ ./ Mannion/ 等/ 人/ [/ 3/ ]/ 基于/ 文献/ [/ 6/ ]/ 中/ 的/ 思路/ 提出/ 使用/ 命题逻辑/ 对/ 特征/ 的/ 树状/ 结构/ 以及/ 特征/ 间/ 的/ 约束/ 关系/ 进行/ 形式化/ ./ 于是/ ,/ 就/ 将/ 特征/ 模型/ 的/ 验证/ 问题/ 转化/ 为/ 逻辑/ 表达式/ 的/ 可/ 满足/ 性/ 问题/ ./ Batory/ [/ 7/ ]/ 也/ 采用/ 了/ 基于/ 命题逻辑/ 的/ 约束/ 形式化/ 方法/ ,/ 提到/ 了/ 将/ 定制/ 决策/ 进行/ 传播/ 的/ 思想/ ./ 然而/ 上述/ 方法/ 都/ 没有/ 提出/ 特征/ 模型/ 定制/ 的/ 选择性/ 回退/ 机制/ ,/ 无法/ 对/ 特征/ 模型/ 的/ 绑定/ 状态/ 进行/ 自由/ 切换/ ./ 针对/ 上面/ 的/ 问题/ ,/ 本文/ 提出/ 了/ 特征/ 模型/ 定制/ 的/ 一种/ 自动/ 传播/ 策略/ ,/ 在/ 处理/ 精化/ 关系/ 与/ 二元/ 约束/ 的/ 自动/ 传播/ 算法/ 的/ 基础/ 上/ ,/ 增加/ 了/ 处理/ 关于/ 复杂/ 约束/ 的/ 自动/ 传播/ 的/ 过程/ ./ 在此之后/ ,/ 本文/ 提出/ 一种/ 特征/ 模型/ 定制/ 的/ 选择性/ 回退/ 机制/ ,/ 实现/ 特征/ 模型/ 中/ 特征/ 的/ 绑定/ 状态/ 的/ 自由/ 改变/ ./ 本文/ 第/ 2/ 节/ 主要/ 介绍/ 特征/ 模型/ 定制/ 问题/ 相关/ 的/ 背景/ 知识/ ;/ 第/ 3/ 节/ 详细/ 阐述/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ ;/ 第/ 4/ 节/ 给出/ 特征/ 模型/ 定制/ 的/ 选择性/ 回退/ 机制/ ;/ 第/ 5/ 节/ 介绍/ 实验室/ 针对/ 该/ 算法/ 开发/ 的/ 工具/ ;/ 第/ 6/ 节对/ 全文/ 进行/ 总结/ ./ 2/ 背景/ 知识/ 本/ 节/ 主要/ 介绍/ 与/ 特征/ 模型/ 定制/ 问题/ 相关/ 的/ 背景/ 知识/ ,/ 主要/ 包括/ 两个/ 方面/ :/ 特征/ 模型/ 的/ 基础知识/ 与/ 特征/ 模型/ 定制/ 的/ 相关/ 概念/ ./ 2.1/ 特征/ 模型/ 领域/ 特征/ 模型/ 是/ 对/ 一个/ 特定/ 领域/ 的/ 软件/ 需求/ 的/ 有/ 组织/ 的/ 描述/ ,/ 反映/ 了/ 该/ 领域/ 内/ 应用/ 系统/ 所/ 共有/ 的/ 属性/ 和/ 系统/ 间/ 可能/ 存在/ 的/ 差异性/ 、/ 系统/ 本身/ 所/ 具有/ 的/ 变化/ 性及/ 领域/ 外部环境/ 可能/ 具有/ 的/ 变化/ 性/ ./ 特征/ 模型/ 是/ 由/ 特征/ 及/ 特征/ 之间/ 的/ 关系/ 构成/ ./ 特征/ 是/ 一组/ 具有/ 紧密联系/ 的/ 需求/ ,/ 是/ 具有/ 客户/ // 用户/ 价值/ 的/ 软件/ 特点/ [/ 8/ ]/ ./ 特征/ 模型/ 可以/ 被/ 定义/ 为/ 一个/ 六元/ 组/ [/ 9/ ]/ :/ (/ F/ ,/ Root/ ,/ Page3Refine/ ,/ BS/ ,/ RDC/ ,/ EAC/ )/ ./ 其/ 各自/ 代表/ 的/ 含义/ 如下/ :/ F/ 是/ 一个/ 集合/ ,/ 其中/ 包括/ n/ 个/ 特征/ {/ f1/ ,/ f2/ ,/ …/ ,/ fn/ }/ ./ Root/ 是/ F/ 中/ 的/ 一个/ 特征/ ,/ Root/ ∈/ F/ ,/ 代表/ 特征/ 模型/ 的/ 根/ 特征/ ./ Refine/ 表示/ 特征/ 模型/ 中/ 的/ 精化/ 关系/ ,/ 形式化/ 地/ 表示/ 为/ F/ →/ F/ 的/ 映射/ ./ 精化/ 用来/ 表示/ 特征/ 模型/ 中/ 的/ 父子关系/ ,/ 在/ 特征/ 模型/ 中/ ,/ 精化/ 关系/ 把/ 不同/ 层次/ 和/ 粒度/ 的/ 特征/ 连接起来/ ,/ 从而/ 形成/ 一种/ 层级/ 结构/ [/ 9/ ]/ ./ 它/ 在/ 元/ 模型/ 中/ 还/ 具有/ 3/ 个子/ 类/ :/ 分解/ 关系/ (/ Decomposi/ -/ tion/ )/ 、/ 属性/ 化/ (/ Detailization/ )/ 和/ 特殊化/ 关系/ (/ Special/ -/ ization/ )/ ./ 一个/ 特征/ 要么/ 是/ 一棵/ 特征/ 树/ 的/ 根/ 结点/ ,/ 要么/ 由/ 唯一/ 的/ 一个/ 父/ 特征/ 精化/ 而来/ ./ BS/ 表示/ 一个/ 特征/ 的/ 绑定/ 状态/ ,/ 是/ F/ 中/ 的/ 任何/ 一个/ 特征/ 的/ 属性/ ./ 该/ 属性/ 的/ 值/ 只/ 可能/ 为/ 以下/ 3/ 个/ 之一/ :/ bound/ ,/ removed/ ,/ undecided/ ,/ 分别/ 表示/ 该/ 特征/ 处于/ 被/ 绑定/ 、/ 被/ 移除/ 与/ 未/ 决定/ 的/ 状态/ ./ RDC/ 表示/ 由/ 精化/ 关系/ 获得/ 的/ 约束/ 关系/ ./ 对于/ 一个/ 精化/ 关系/ ,/ 若/ f1/ 为/ f2/ 的/ 父/ 特征/ ,/ 由/ 其中/ 可/ 获得/ 约束/ 关系/ f2/ 依赖于/ f1/ ./ 如果/ f2/ 为/ 必选/ 特征/ ,/ 则/ 可/ 获得/ 约束/ 关系/ f2/ 相互依赖/ 于/ f1/ ./ EAC/ 是/ 一组/ 约束/ 关系/ 的/ 集合/ ,/ 表示/ 在/ 特征/ 模型/ 之中/ 的/ 显示/ 约束/ ./ 它/ 分为/ 二元/ 约束/ 与/ 组合/ 约束/ 这/ 两种/ 不同/ 的/ 形式/ ./ 特征/ 模型/ 中/ 包括/ 二元/ 约束/ 与/ 组合/ 约束/ 两种/ 约束/ 关系/ ./ 二元/ 约束/ 是/ 指/ 两个/ 特征/ 之间/ 的/ 相互/ 关系/ ,/ 包括/ 3/ 种/ 形式/ :/ f1requiresf2/ ,/ f1excludesf2/ ,/ f1mutual/ -/ requiresf2/ ,/ 分别/ 以/ f1/ →/ f2/ 、/ / f1/ ∨/ / f2/ 与/ f1/ / f2/ 表示/ ./ 其中/ 当/ 特征/ 的/ 绑定/ 状态/ 为/ bound/ 时其/ 取值/ 为/ 真/ ,/ 当其/ 绑定/ 状态/ 为/ removed/ 时/ 取值/ 为/ 假/ ./ 组合/ 约束/ 又名/ 复杂/ 约束/ ,/ 表示/ 两组/ 谓词/ 之间/ 的/ 相互/ 关系/ ,/ 包括/ 3/ 种/ 形式/ :/ P1requiresP2/ ,/ P1excludesP2/ ,/ P1mutual/ -/ requiresP2/ ,/ 其/ 真值/ 与/ 二元/ 约束/ 相同/ ./ 其中/ P1/ 与/ P2/ 有/ 3/ 种/ 形式/ ,/ 分别/ 为/ single/ -/ bound/ (/ f1/ ,/ f2/ ,/ …/ ,/ fn/ )/ ,/ all/ -/ bound/ (/ f1/ ,/ f2/ ,/ …/ ,/ fn/ )/ ,/ multi/ -/ bound/ (/ f1/ ,/ f2/ ,/ …/ ,/ fn/ )/ ,/ 分别/ 表示/ 在/ f1/ ,/ f2/ ,/ …/ ,/ fn/ 的/ 绑定/ 状态/ 中仅/ 有/ 一个/ 为/ 绑定/ 、/ 全部/ 为/ 绑定/ 、/ 至少/ 有/ 一个/ 为/ 绑定/ ./ 图/ 1/ 是/ 一个/ 特征/ 模型/ 的/ 例子/ ./ 在/ 该/ 例子/ 中/ ,/ 存在/ 一个二元/ 约束/ 关系/ :/ 视频/ 通信/ requires/ 语音/ 通信/ ./ 此外/ ,/ 该/ 例子/ 中/ 还有/ 一个/ 组合/ 约束/ 未/ 在/ 图上/ 标明/ ,/ 为/ 运行/ 平台/ requiressingle/ -/ bound/ (/ 桌面/ 平台/ 、/ 手机/ 平台/ )/ ./ 图中/ 所示/ 带/ 圆圈/ 标记/ 的/ 为/ 可选/ 特征/ ,/ 否则/ 为/ 必选/ 特征/ ./ {/ 2.2/ 特征/ 模型/ 的/ 定制/ 从/ 领域/ 特征/ 模型/ (/ DomainFeatureModel/ ,/ DFM/ )/ 到/ 应用/ 系统/ 特征/ 模型/ (/ ApplicationFeatureModel/ ,/ AFM/ )/ 是/ 一个/ 定制/ 的/ 过程/ ./ 通过/ 对/ 领域/ 特征/ 模型/ 的/ 定制/ ,/ 可/ 使/ 领域/ 分析/ 结果/ 得以/ 大/ 粒度/ 复用/ ./ 特征/ 模型/ 中/ 的/ 特征/ 可以/ 根据/ 其/ 绑定/ 状态/ 被/ 分为/ 3/ 个/ 集合/ :/ BoundSet/ 、/ RemovedSet/ 、/ UndecidedSet/ ./ 在/ 特征/ 模型/ 的/ 建模/ 过程/ 结束/ 后/ ,/ 所有/ 未/ 决定/ 绑定/ 状态/ 的/ 特征/ 都/ 位于/ 集合/ UndecidedSet/ ./ 定制/ 所要/ 做/ 的/ 事情/ 就是/ 将/ UndecidedSet/ 中/ 的/ 每/ 一个/ 特征/ 转移/ 到/ BoundSet/ 与/ RemovedSet/ 中/ ,/ 使得/ (/ 其中/ card/ 表示/ 集合/ 的/ 势/ )/ :/ card/ (/ UndecidedSet/ )/ =/ 0card/ (/ BoundSet/ )/ +/ card/ (/ RemovedSet/ )/ =/ card/ (/ F/ 其中/ ,/ 对于/ f/ ∈/ BoundSet/ 或者/ f/ ∈/ RemovedSet/ ,/ 不/ 能够/ 使/ RDC/ 与/ EAC/ 中/ 出现/ 假值/ ./ 即/ 对于/ 所有/ 的/ 定制/ 决策/ ,/ 必须/ 满足/ 特征/ 模型/ 的/ 约束/ 关系/ ./ 如果/ 一个/ 特征/ 从/ UndecidedSet/ 转移/ 至/ BoundSet/ ,/ 则/ 称/ 这个/ 特征/ 被/ 绑定/ ,/ 反之/ 若/ 一个/ 特征/ 从/ UndecidedSet/ 转移/ 至/ RemovedSet/ ,/ 则/ 这个/ 特征/ 称作/ 被/ 移除/ ./ 因此/ ,/ 对于/ 特征/ 模型/ 的/ 一个/ 定制/ 决策/ ,/ 需要/ 设计/ 定制/ 的/ 自动/ 传播/ 机制/ 以/ 保证/ 其/ 满足/ 约束/ 关系/ ./ 即当/ 定制/ 者/ 将/ 一个/ 特征/ f/ 从/ UndecidedSet/ 转移/ 至/ BoundSet/ 或/ RemovedSet/ 中时/ ,/ 需使/ 相关/ 的/ 特征/ f1/ ,/ f2/ ,/ …/ ,/ fn/ 自动/ 从/ UndecidedSet/ 转移/ 至/ BoundSet/ 或/ RemovedSet/ 中/ ./ 这个/ 过程/ 被/ 称之为/ 特征/ 模型/ 的/ 自动/ 传播/ ./ 同时/ ,/ 定制/ 并/ 不是/ 一个/ 单向/ 的/ 过程/ ./ 定制/ 工具/ 应该/ 提供/ 机制/ 使得/ 定制/ 者/ 可以/ 撤销/ 自己/ 的/ 定制/ 决策/ ./ 即/ ,/ 一个/ 特征/ f/ 除/ 可/ 从/ UndecidedSet/ 转移/ 到/ BoundSet/ 或者/ RemovedSet/ 外/ ,/ 也/ 应有/ 机制/ 使/ 它/ 可/ 从/ BoundSet/ 或/ RemovedSet/ 转移/ 至/ UndecidedSet/ ,/ 同时/ 满足/ 特征/ 模型/ 的/ 约束/ 关系/ ./ 这个/ 过程/ 称之为/ 选/ Page4/ 择性/ 回退/ ./ 例如/ ,/ 对于/ 图/ 1/ 中/ 的/ 特征/ 模型/ 而言/ ,/ 当/ 定制/ 者/ 绑定/ 特征/ 语音/ 邮件/ 时/ ,/ 其父/ 特征/ 语音/ 通信/ 则/ 必须/ 被/ 绑定/ ,/ 否则/ 就/ 会/ 使/ RDC/ 为/ 假/ ./ 类似/ 的/ ,/ 如果/ 定制/ 者/ 绑定/ 特征/ 视频/ 通信/ 时/ ,/ 特征/ 语音/ 通信/ 也/ 需要/ 被/ 绑定/ ,/ 否则/ 就/ 会/ 使得/ EAC/ 为/ 假/ ./ 若/ 定制/ 者/ 绑定/ 特征/ 运行/ 平台/ 与/ 桌面/ 系统/ ,/ 那么/ 特征/ 手机/ 系统/ 就/ 应当/ 被/ 移除/ ,/ 否则/ 就/ 会/ 使得/ EAC/ 中/ 的/ 组合/ 约束/ 值为/ 假/ ./ 这个/ 过程/ 就是/ 定制/ 的/ 自动/ 传播/ 过程/ ./ 再/ 如/ ,/ 对于/ 图/ 1/ 中/ 的/ 特征/ 模型/ 而言/ ,/ 当/ 定制/ 者/ 绑定/ 特征/ 语音/ 邮件/ 与/ 视频/ 通信/ 时/ ,/ 特征/ 语音/ 通信/ 会/ 被/ 绑定/ (/ 见/ 上面/ 的/ 分析/ )/ ./ 当/ 定制/ 者/ 选择性/ 回退/ 特征/ 语音/ 通信/ (/ 即/ 把/ 特征/ 语音/ 通信/ 从/ BoundSet/ 转移/ 到/ UndecidedSet/ )/ ,/ 特征/ 语音/ 邮件/ 与/ 视频/ 通信/ 都/ 应当/ 被/ 转移/ 至/ UndecidedSet/ ,/ 以/ 满足/ 特征/ 模型/ 的/ 约束/ 关系/ ./ 3/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 策略/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 其本质/ 就是/ 在/ 一个/ 特征/ 的/ 绑定/ 状态/ 被/ 修改/ 后/ ,/ 修改/ 其它/ 特征/ 的/ 绑定/ 状态/ 使/ 之/ 可以/ 满足/ 特征/ 模型/ 中/ 的/ 约束/ 关系/ 与/ 精化/ 关系/ ./ 因此/ ,/ 可以/ 将/ 这个/ 问题/ 分解/ 成为/ 两个/ 部分/ ,/ 即/ 首先/ 处理/ 与/ 某个/ 特征/ 相关/ 的/ 二元/ 约束/ 与/ 精化/ 关系/ ,/ 再/ 处理/ 与/ 之/ 相关/ 的/ 复杂/ 约束/ ./ 当然/ ,/ 二元/ 约束/ 可以/ 看作/ 一种/ 特殊/ 的/ 复杂/ 约束/ ,/ 自然/ 也/ 可以/ 利用/ 复杂/ 约束/ 的/ 自动/ 传播/ 算法/ 进行/ 传播/ ./ 然而/ ,/ 将/ 有关/ 二元/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 算法/ 独立/ 出来/ 有/ 其/ 必要/ ./ 因为/ 在/ 一个/ 特征/ 模型/ 中/ ,/ 往往/ 存在/ 着/ 大量/ 的/ 二元/ 约束/ ,/ 复杂/ 约束/ 的/ 数量/ 相对/ 较/ 少/ ,/ 因此/ ,/ 如果/ 可以/ 用/ 较/ 小/ 的/ 时间/ 开销/ 来/ 完成/ 关于/ 二元/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ ,/ 就/ 可以/ 降低/ 传播/ 的/ 时间/ 复杂度/ ./ 3.1/ 关于/ 二元/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 关于/ 二元/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 机制/ 可以/ 通过/ 原子/ 集/ 、/ 依赖/ 集/ 与/ 互斥/ 集/ [/ 10/ ]/ 的/ 手段/ 快速/ 进行/ 传播/ ./ 对于/ 一个/ 特征/ 及其/ 必选/ 的/ 子/ 特征/ ,/ 可以/ 将/ 其/ 合并/ 为/ 一个/ 集合/ ,/ 称之为/ 原子/ 集/ ./ 对于/ 原子/ 集中/ 的/ 所有/ 特征/ ,/ 其/ 绑定/ 状态/ 都/ 是/ 相同/ 的/ ./ 可以/ 用/ F/ ./ AS/ 来/ 表示/ F/ 所在/ 的/ 原子/ 集/ ./ 对于/ 一个/ 原子/ 集中/ 的/ 所有/ 特征/ ,/ 可以/ 在/ 定制/ 的/ 时候/ 将/ 其/ 当作/ 一个/ 整体/ 对/ 其/ 进行/ 统一/ 处理/ ./ 对于/ 一个/ 原子/ 集/ ,/ 可以/ 定义/ 其/ 依赖/ 集/ ./ 一个/ 原子/ 集/ AS/ 的/ 依赖/ 集/ 可以/ 被/ 表示/ 成/ AS/ ./ RS/ ./ 依赖/ 集/ 的/ 元素/ 都/ 是/ 原子/ 集/ ./ 如果/ AS1/ ∈/ AS/ ./ RS/ ,/ 表示/ 对于/ AS/ 中/ 的/ 任何/ 一个/ 特征/ F/ ,/ AS1/ 中/ 的/ 任何/ 一个/ 特征/ F1/ ,/ 都/ 存在/ 约束/ 关系/ FrequiresF1/ ./ 类似/ 地/ ,/ 可以/ 定义/ 一个/ 原子/ 集/ 的/ 互斥/ 集/ ./ 原子/ 集/ AS/ 的/ 互斥/ 集/ 可以/ 被/ 表示/ 成为/ AS/ ./ ES/ ,/ 互斥/ 集中/ 的/ 元素/ 都/ 是/ 原子/ 集/ ./ 如果/ AS1/ ∈/ AS/ ./ ES/ ,/ 表示/ 对于/ AS/ 中/ 的/ 任何/ 一个/ 特征/ F/ ,/ AS1/ 中/ 的/ 任何/ 一个/ 特征/ F1/ ,/ 都/ 存在/ 约束/ 关系/ FexcludesF1/ ./ 如果/ 定制/ 者/ 绑定/ 一个/ 特征/ F/ ,/ 则/ 需要/ 定制/ 工具/ 将/ F/ 的/ 依赖/ 集里/ 的/ 原子/ 集中/ 所有/ 特征/ 的/ 绑定/ 状态/ 设为/ bound/ ,/ 将/ F/ 的/ 互斥/ 集里/ 的/ 原子/ 集中/ 所有/ 特征/ 的/ 绑定/ 状态/ 设为/ removed/ ,/ 同时/ 将/ F/ 的/ 父/ 特征/ 绑定/ 状态/ 设为/ bound/ ./ 如果/ 定制/ 者/ 把/ 特征/ F/ 的/ 绑定/ 状态/ 设为/ removed/ ,/ 则/ 需要/ 定制/ 工具/ 将/ 依赖/ 集中/ 包含/ F/ 的/ 原子/ 集里/ 所有/ 的/ 特征/ 绑定/ 状态/ 设为/ removed/ ,/ 同时/ 将/ F/ 的/ 子/ 特征/ 的/ 绑定/ 状态/ 设为/ removed/ ./ 算法/ 1/ ./ 构造/ 原子/ 集/ 的/ 依赖/ 集/ 与/ 互斥/ 集/ 算法/ ./ 输入/ :/ 源/ 原子/ 集/ AS/ 输出/ :/ AS/ 的/ 依赖/ 集/ AS/ ./ RS/ 与/ 互斥/ 集/ AS/ ./ ES1/ ./ countrs/ (/ AtomSetAS/ )/ {/ // // 构造/ 依赖/ 集/ 2/ ./ AS/ ./ RS/ ./ add/ (/ AS/ )/ ;/ 3/ ./ intlength/ ;/ 4/ ./ do/ {/ 5/ ./ length/ =/ RS/ ./ size/ (/ )/ ;/ 6/ ./ for/ (/ FeatureFinAS/ )/ {/ 7/ ./ if/ (/ existFrequiresF1/ ‖/ Fmutual/ _/ requiresF18/ ./ AS/ ./ RS/ ./ add/ (/ F1/ ./ AS/ )/ ;/ 9/ ./ }/ 10/ ./ }/ 11/ ./ while/ (/ RS/ ./ size/ (/ )/ >/ length/ )/ ;/ 12/ ./ }/ 13/ ./ countes/ (/ AtomSetAS/ )/ {/ // // 构造/ 互斥/ 集/ 14/ ./ AS/ ./ ES/ ./ empty/ (/ )/ ;/ 15/ ./ intlength/ ;/ 16/ ./ do/ {/ 17/ ./ length/ =/ ES/ ./ size/ (/ )/ ;/ 18/ ./ for/ (/ FeatureFinAS/ )/ {/ 19/ ./ if/ (/ existFexcludedsF1/ ‖/ F1excludesF/ )/ 20/ ./ AS/ ./ ES/ ./ add/ (/ F1/ ./ AS/ )/ ;/ 21/ ./ }/ 22/ ./ }/ 23/ ./ while/ (/ ES/ ./ size/ (/ )/ >/ length/ )/ ;/ 24/ ./ }/ 算法/ 的/ 第/ 1/ ~/ 12/ 行/ 表示/ 构造/ 依赖/ 集/ 的/ 算法/ ,/ 第/ 13/ ~/ 24/ 行/ 表示/ 构造/ 互斥/ 集/ 的/ 算法/ ./ 依赖/ 集/ 的/ 构造/ 思路/ 是/ 寻找/ 对于/ 其中/ 元素/ F/ ,/ 是否/ 存在/ 特征/ F1/ 满足/ FrequiresF1/ ,/ 若/ 存在/ ,/ 则/ 将/ F1/ 的/ 原子/ 集/ 添加/ 到/ 该/ 依赖/ 集中/ ./ 反复/ 进行/ 如此/ 的/ 操作/ 直到/ 该/ 依赖/ 集/ 的/ 大/ Page5/ 小/ 不再/ 增长/ 为止/ ./ 对于/ 互斥/ 集/ ,/ 构造/ 算法/ 与/ 之/ 类似/ ./ 区别/ 在于/ 两点/ :/ (/ 1/ )/ 依赖/ 集在/ 构造/ 时/ 需要/ 将/ 该/ 原子/ 集/ 本身/ 加入/ 依赖/ 集中/ ,/ 而/ 互斥/ 集/ 不必/ ;/ (/ 2/ )/ 互斥/ 集/ 的/ 构造/ 过程/ 检查/ 是否/ 存在/ FexcludesF1/ 关系/ ,/ 而/ 非/ FrequiresF1/ ./ 基于/ 上述/ 二元/ 约束/ 定制/ 的/ 自动/ 传播/ 策略/ ,/ 一旦/ 定制/ 者/ 的/ 预处理/ 操作/ 结束/ 后/ ,/ 相关/ 特征/ 的/ 二元/ 约束/ 将/ 自动/ 传播/ ./ 由于/ 创建/ 原子/ 集/ 、/ 依赖/ 集/ 与/ 互斥/ 集/ 的/ 过程/ 是/ 一个/ 预处理/ 的/ 过程/ ,/ 在/ 实施/ 定制/ 操作/ 时/ ,/ 不必/ 检索/ 与/ 原/ 特征/ 相关/ 的/ 所有/ 二元/ 约束/ ,/ 只/ 需要/ 读取/ 该/ 特征/ 的/ 原子/ 集/ 、/ 该/ 特征/ 原子/ 集/ 的/ 依赖/ 集/ 与/ 互斥/ 集/ 即可/ ,/ 因此/ 可以/ 节约/ 大量/ 的/ 时间/ ./ 3.2/ 关于/ 组合/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 通过/ 原子/ 集/ 、/ 依赖/ 集/ 与/ 互斥/ 集/ 的/ 算法/ 可以/ 有效/ 地/ 解决/ 关于/ 二元/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 算法/ ./ 然而/ ,/ 在/ 特征/ 模型/ 中/ ,/ 组合/ 约束/ 也/ 可以/ 导致/ 特征/ 模型/ 的/ 自动/ 传播/ ./ 如图/ 2/ 所示/ 的/ 组合/ 约束/ 中/ ,/ 有/ f1/ 、/ f2/ 与/ f3/ 这/ 3/ 个/ 约束/ 绑定/ 数/ 待定/ 数表/ 1Multi/ -/ Bound/ 谓词/ 自动/ 传播/ 规则/ 01/ 只有/ 绑定/ 这/ 一个/ 待定/ 特征/ 才能/ 使/ 谓词/ 取值/ 为/ 真/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 唯一/ ./ 可以/ 自动/ 传播/ 0/ >/ 1/ 绑定/ 任意/ 一个/ 特征/ 都/ 可以/ 使/ 谓词/ 成/ 真/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 不/ 唯一/ ./ 不能/ 自动/ 传播/ 0/ 任意/ 只有/ 删除/ 所有/ 待定/ 特征/ 才能/ 使/ 谓词/ 取值/ 为/ 假/ ./ 所以/ 可能/ 的/ 定制/ 方式/ 唯一/ ./ 可以/ 自动/ 传播/ 约束/ 绑定/ 数/ 待定/ 数/ 0/ 任意/ 只有/ 绑定/ 所有/ 待定/ 特征/ 才能/ 使/ 谓词/ 取值/ 为/ 真/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 唯一/ ./ 可以/ 自动/ 传播/ 表/ 2All/ -/ Bound/ 谓词/ 自动/ 传播/ 规则/ 01/ 只有/ 删除/ 这一/ 待定/ 特征/ 才能/ 使/ 谓词/ 取值/ 为/ 假/ ./ 所以/ 可能/ 的/ 定制/ 方式/ 唯一/ ./ 可以/ 自动/ 传播/ 0/ >/ 1/ 任意/ 删除/ 一个/ 待定/ 特征/ 都/ 能/ 使/ 谓词/ 取值/ 为/ 假/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 不/ 唯一/ ./ 不能/ 自动/ 传播/ TRUEFALSETRUEFALSE/ 表/ 1/ 、/ 表/ 2/ 、/ 表/ 3/ 中/ 的/ 约束/ 表示/ 谓词/ 的/ 真假/ 状态/ ,/ 绑定/ 数/ 表示/ 谓词/ 中/ 的/ 特征/ 绑定/ 状态/ 为/ bound/ 的/ 数量/ ,/ 删除/ 数/ 表示/ 谓词/ 中/ 的/ 特征/ 绑定/ 状态/ 为/ removed/ 的/ 数量/ ,/ 待定/ 数/ 表示/ 谓词/ 中/ 的/ 特征/ 绑定/ 状态/ 为/ undecided/ 的/ 数量/ ,/ 三者/ 相加/ 即/ 为/ 谓词/ 中/ 所有/ 特征/ 的/ 总数/ ./ 通过/ 以上/ 规则/ ,/ 可以/ 提出/ 关于/ 组合/ 约束/ 的/ 自动/ 传播/ 算法/ ./ 通过/ 以上/ 的/ 关于/ 组合/ 约束/ 谓词/ 的/ 自动/ 传播/ 规则/ ,/ 可以/ 寻找/ 关于/ 组合/ 约束/ 自动/ 传播/ 的/ 算法/ ./ 事实上/ ,/ 只有/ 在/ 表/ 4/ 的/ 几种/ 情况/ 下/ ,/ 组合/ 约束/ 谓词/ 的/ 状/ 特征/ ,/ 并且/ 没有/ 任何/ 的/ 精化/ 关系/ 与/ 二元/ 约束/ 关系/ ./ 如果/ 此时/ 绑定/ 特征/ f1/ ,/ 同时/ 绑定/ 特征/ f2/ ./ 那么/ ,/ 只有/ 删除/ 特征/ f3/ ,/ 该/ 组合/ 约束/ 才能/ 被/ 满足/ ./ 如何/ 处理/ 涉及/ 组合/ 约束/ 的/ 定制/ 决策/ 传播/ 成为/ 定制/ 此类/ 特征/ 模型/ 时/ 所/ 需/ 解决/ 的/ 问题/ ,/ 为此/ ,/ 本文/ 提供/ 了/ 关于/ 组合/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ 机制/ ./ 关于/ 组合/ 约束/ 按照/ 谓词/ 的/ 不同/ 分别/ 有/ 如下/ 的/ 传播/ 规则/ ./ 对于/ Multi/ -/ Bound/ ,/ All/ -/ Bound/ ,/ Single/ -/ Bound/ 谓词/ 分别/ 予以/ 讨论/ ./ 对于/ 组合/ 约束/ 的/ 谓词/ Multi/ -/ Bound/ ,/ 传播/ 规则/ 如表/ 1/ 所示/ ./ 对于/ 谓词/ All/ -/ Bound/ ,/ 传播/ 规则/ 如表/ 2/ 所示/ ./ 对/ 谓词/ Single/ -/ Bound/ ,/ 传播/ 规则/ 如表/ 3/ 所示/ ./ 态才/ 会/ 自动/ 传播/ (/ 表/ 4/ 中/ 的/ P/ 与/ P1/ 皆/ 表示/ 谓词/ )/ ./ 因此/ ,/ 组合/ 约束/ 是否/ 可以/ 自动/ 传播/ ,/ 取决于/ 如下/ 的/ 两点/ :/ (/ 1/ )/ 谓词/ 的/ 状态/ 是否/ 改变/ ./ (/ 2/ )/ 谓词/ 状态/ 的/ 改变/ 是否/ 会/ 影响/ 到/ 谓词/ 中/ 的/ 特征/ 的/ 绑定/ 状态/ ./ 根据/ 上面/ 的/ 组合/ 约束/ 的/ 传播/ 规则/ ,/ 可以/ 给出/ 如下/ 的/ 算法/ 来/ 处理/ 关于/ 组合/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ ./ Page6/ 约束/ 绑定/ 数/ 待定/ 数表/ 3Single/ -/ Bound/ 谓词/ 自动/ 传播/ 规则/ TRUEFALSE11/ 只有/ 绑定/ 这/ 一个/ 待定/ 特征/ 才能/ 使/ 谓词/ 取值/ 为/ 假/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 唯一/ ./ 可以/ 自动/ 传播/ 1/ >/ 1/ 再/ 绑定/ 任意/ 一个/ 特征/ 都/ 可以/ 使/ 谓词/ 取假/ ,/ 所以/ 可能/ 的/ 定制/ 方式/ 不/ 唯一/ ./ 不能/ 自动/ 传播/ 组合/ 约束/ 关系/ P/ 的/ 状态/ P1/ 应/ 被/ 设为/ 的/ 状态/ PrequireP1PexcludeP1P1requirePFalseP1excludePTruePmutual/ -/ requiresP1TrueP1mutual/ -/ requiresPTruePmutual/ -/ requiresP1FalseP1mutual/ -/ requiresPFalse/ 算法/ 2/ ./ 关于/ 组合/ 约束/ 的/ 定制/ 自动/ 传播/ 算法/ ./ 输入/ :/ 需要/ 自动/ 传播/ 的/ 特征/ f/ 输出/ :/ 在/ 自动/ 传播/ 过程/ 结束/ 后/ 的/ 特征/ 绑定/ 状态/ (/ BS/ )/ 1/ ./ Propagation/ (/ Featuref/ )/ {/ 2/ ./ if/ (/ f/ ./ pro/ )/ return/ ;/ // // 特征/ 的/ pro/ 属性/ 被/ 初始化/ 为/ 假/ 3/ ./ set/ _/ binding/ _/ state/ (/ f/ )/ ;/ 4/ ./ f/ ./ pro/ =/ true/ ;/ 5/ ./ ProSet/ (/ f/ )/ ;/ // // 根据/ 原子/ 集/ 、/ 依赖/ 集/ 、/ 互斥/ 集/ 调用/ 二/ 6/ ./ ProCS/ (/ f/ )/ ;/ // // 调用/ 组合/ 约束/ 的/ 自动/ 传播/ 算法/ 7/ ./ }/ 8/ ./ ProCS/ (/ Featuref/ )/ {/ // // 组合/ 约束/ 传播/ 算法/ 9/ ./ for/ (/ declarevarpasPredicate/ ,/ eachpcontainsf/ )/ {/ 10/ ./ if/ (/ p/ ./ state/ =/ =/ unknown/ )/ {/ // // 若该/ 谓词/ 状态/ 不/ 确定/ 11/ ./ booleanb/ =/ proFintoP/ (/ p/ )/ ;/ 12/ ./ if/ (/ !/ b/ )/ continue/ ;/ 13/ ./ for/ (/ declarevarccasCompositeConstraint/ ,/ 14/ ./ if/ (/ thestateofpandccareinForm/ ./ 4/ )/ {/ 15/ ./ p1/ =/ cc/ ./ get/ _/ opposite/ _/ predicate/ (/ )/ ;/ 16/ ./ set/ _/ state/ (/ p1/ )/ ;/ // // 设置/ p1/ 的/ 绑定/ 状态/ 17/ ./ proPintoF/ (/ p1/ )/ ;/ 18/ ./ }/ 19/ ./ }/ 20/ ./ else/ {/ 21/ ./ proPintoF/ (/ p/ )/ ;/ 22/ ./ }/ 23/ ./ }/ 24/ ./ }/ 25/ ./ proPintoF/ (/ Predicatep/ )/ {/ 26/ ./ intnum/ _/ bound/ ,/ num/ _/ removed/ ,/ num/ _/ undecided/ ;/ 27/ ./ count/ (/ num/ _/ bound/ ,/ num/ _/ removed/ ,/ num/ _/ undecided/ )/ ;/ 28/ ./ switch/ (/ p/ ./ group/ )/ {/ 29/ ./ casesingle/ :/ 30/ ./ if/ (/ numsareinForm/ ./ 1/ )/ 31/ ./ propagation/ (/ finForm/ ./ 1/ )/ ;/ 32/ ./ break/ ;/ 33/ ./ casemulti/ :/ 34/ ./ if/ (/ numsareinForm/ ./ 2/ )/ 35/ ./ propagation/ (/ finForm/ ./ 2/ )/ ;/ 36/ ./ break/ ;/ 37/ ./ caseall/ :/ 38/ ./ if/ (/ numsareinForm/ ./ 3/ )/ 39/ ./ propagation/ (/ finForm/ ./ 3/ )/ ;/ 40/ ./ }/ 41/ ./ }/ 42/ ./ boolproFintoP/ (/ Predicatep/ )/ {/ // // 检查/ 特征/ 绑定/ 状态/ 的/ 变化/ 是否/ 会/ 引发/ 谓词/ 状态/ 的/ 变化/ 43/ ./ if/ (/ p/ ./ state/ !/ =/ unknown/ )/ 44/ ./ returnfalse/ ;/ 45/ ./ switch/ (/ p/ ./ group/ )/ {/ 46/ ./ casesingle/ :/ 47/ ./ boolchange/ =/ searchForm/ (/ Form1/ ,/ p/ )/ ;/ 48/ ./ set/ _/ state/ (/ p/ )/ ;/ 49/ ./ returnchange/ ;/ 50/ ./ casemulti/ :/ 51/ ./ boolchange/ =/ searchForm/ (/ Form2/ ,/ p/ )/ ;/ Page752/ ./ set/ _/ state/ (/ p/ )/ ;/ 53/ ./ returnchange/ ;/ 54/ ./ caseall/ :/ 55/ ./ boolchange/ =/ searchForm/ (/ Form2/ ,/ p/ )/ ;/ 56/ ./ set/ _/ state/ (/ p/ )/ ;/ 57/ ./ returnchange/ ;/ 58/ ./ }/ 59/ ./ }/ 上述/ 算法/ 中/ 第/ 1/ ~/ 7/ 行/ 表示/ 特征/ 模型/ 定制/ 操作/ 的/ 主/ 函数/ ,/ 通过/ 设立/ 一个/ pro/ 的/ 布尔/ 属性/ 表示/ 特征/ 是否/ 被/ 传播/ 过/ ./ 第/ 8/ ~/ 24/ 行/ 表示/ 关于/ 组合/ 约束/ 的/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 算法/ 过程/ ,/ 检查/ 谓词/ 的/ 状态/ 是否/ 不/ 确定/ ,/ 如果/ 确定/ ,/ 则/ 查表/ 1/ ~/ 表/ 3/ ,/ 检查/ 是否/ 可以/ 传播/ 到/ 谓词/ 内/ 的/ 特征/ ;/ 若/ 不/ 确定/ ,/ 则/ 检查/ 是否/ 会/ 改变/ 谓词/ 的/ 状态/ ,/ 如果/ 可以/ ,/ 则/ 查表/ 4/ ,/ 看/ 是否/ 可以/ 传播/ 到/ 另/ 一个/ 谓词/ ./ 第/ 25/ ~/ 41/ 行/ 表示/ 在/ 谓词/ 内部/ 进行/ 传播/ 的/ 算法/ ,/ 通过/ 查表/ 1/ ~/ 表/ 3/ ,/ 看/ 是否/ 可以/ 让/ 谓词/ 内部/ 的/ 特征/ 绑定/ 状态/ 发生/ 改变/ ./ 第/ 42/ ~/ 59/ 行/ 表示/ 特征/ 向/ 谓词/ 传播/ 的/ 算法/ ,/ 看/ 特征/ 的/ 绑定/ 状态/ 改变/ 是否/ 会/ 引发/ 谓词/ 的/ 绑定/ 状态/ 改变/ ./ 3.3/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 算法/ 时间/ 复杂度/ 与/ 正确性/ 分析/ 本节/ 将/ 就/ 实现/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ 的/ 算法/ 进行/ 分析/ ./ 在/ 定制/ 的/ 自动/ 传播/ 过程/ 中/ ,/ 该/ 算法/ 所用/ 的/ 时间/ 相当于/ 关于/ 二元/ 约束/ 与/ 组合/ 约束/ 传播/ 的/ 时间/ 进行/ 相加/ ./ 对于/ 二元/ 约束/ 而言/ ,/ 根据/ 上面/ 的/ 分析/ ,/ 传播/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ ,/ n/ 表示/ 应/ 改变/ 绑定/ 状态/ 特征/ 数目/ ./ 对于/ 关于/ 组合/ 约束/ 的/ 定制/ 的/ 自动/ 传播/ ,/ 可以/ 设/ 与/ 一个/ 特征/ 相关联/ 的/ 组合/ 约束/ 个数/ 为/ p/ ,/ 组合/ 约束/ 中/ 包含/ 的/ 特征/ 数目/ 为/ q/ ,/ 那么/ 一次/ proCS/ 操作/ 所用/ 到/ 的/ 时间/ 为/ O/ (/ pq/ )/ ,/ 在/ 一次/ propagation/ 算法/ 中/ ,/ 关于/ 组合/ 约束/ 的/ 定制/ 传播/ 所用/ 到/ 的/ 总/ 时间/ 不会/ 超过/ ∑/ pq/ ,/ 其中/ p/ 为/ 所有/ 应/ 改变/ 绑定/ 状态/ 的/ 特征/ 相关/ 的/ 所有/ 组合/ 约束/ ,/ q/ 为/ 与/ 之/ 对应/ 的/ 组合/ 约束/ 内/ 的/ 特征/ 数目/ ./ 同时/ ,/ 如果/ 在/ propagation/ 过程/ 中/ ,/ 绑定/ 或/ 删除/ 了/ 某/ 一个/ 特征/ ,/ 那么/ 该/ 特征/ 会/ 被/ 标记/ pro/ 属性/ 以/ 避免/ 其/ 被/ 第/ 2/ 次/ 递归/ 调用/ ./ 因此/ ,/ 设/ 一个/ 特征/ 模型/ 中/ 的/ 总/ 特征/ 数目/ 为/ m/ ,/ 那么/ propagation/ 算法/ 所用/ 的/ 时间/ 不会/ 超过/ O/ (/ m/ )/ ./ 因此/ ,/ 在/ 一次/ 特征/ 模型/ 的/ 定制/ 的/ 自动/ 传播/ 操作/ 中/ ,/ 所用/ 的/ 时间/ 不会/ 大于/ O/ (/ max/ {/ n/ +/ ∑/ pq/ ,/ m/ }/ )/ ./ 在/ 特征/ 模型/ 中/ ,/ m/ 的/ 规模/ 不会/ 特别/ 大/ (/ 目前/ 被/ 使用/ 的/ 最大/ 的/ 特征/ 模型/ 其/ 规模/ 为/ 103/ 级别/ )/ ,/ 所以/ 所用/ 时间/ 完全/ 在/ 可以/ 接受/ 的/ 范围/ 之内/ ./ 在/ 特征/ 模型/ 被/ 验证/ 一致/ 的/ 情况/ 下/ ,/ 该/ 算法/ 可以/ 在/ 不/ 违反/ 约束/ 关系/ 的/ 前提/ 下/ ,/ 对/ 特征/ 模型/ 的/ 绑定/ 状态/ 进行/ 正确/ 的/ 传播/ ./ 该/ 算法/ 的/ 正确性/ 基于/ 特征/ 模型/ 的/ 一致性/ ./ 如果/ 特征/ 模型/ 被/ 验证/ 不是/ 一致/ 的/ ,/ 那么/ 该/ 算法/ 就/ 无法/ 对/ 特征/ 模型/ 进行/ 正确/ 的/ 传播/ ./ 例如/ ,/ 对于/ 一个/ 特征/ 模型/ ArequiresB/ ,/ AexcludedB/ ,/ 那么/ ,/ 此时/ 特征/ A/ 的/ 绑定/ 状态/ 必然/ 是/ removed/ ./ 但/ 由于/ 该/ 特征/ 模型/ 不是/ 一致/ 的/ ,/ 特征/ 模型/ 的/ 定制/ 自动/ 传播/ 算法/ 无法/ 检查/ 到/ 特性/ A/ 是/ 一个/ 死/ 特征/ (/ deadfeature/ )/ ,/ 因而/ 在/ 绑定/ 特征/ A/ 时/ ,/ 会/ 导致/ 错误/ 的/ 结果/ ./ 解决/ 的/ 方法/ 是/ 在/ 特征/ 模型/ 的/ 定制/ 操作/ 之前/ ,/ 对/ 特征/ 模型/ 进行/ 一致性/ 验证/ ./ 对于/ 满足/ 一致性/ 的/ 特征/ 模型/ ,/ 可以/ 用/ 逻辑/ 验证/ 的/ 方法/ 证明/ ,/ 上述/ 算法/ 对/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 操作/ 不会/ 违反/ 特征/ 模型/ 的/ 约束/ 关系/ ./ 4/ 特征/ 模型/ 定制/ 的/ 选择性/ 回退/ 机制/ 对于/ 特征/ 模型/ 而言/ ,/ 如果/ 提供/ 了/ 定制/ 的/ 自动/ 传播/ 算法/ ,/ 就/ 需要/ 提供/ 定制/ 的/ 选择性/ 回退/ 算法/ ,/ 相当于/ 自动/ 传播/ 算法/ 的/ 逆/ 算法/ ./ 选择性/ 回退/ 算法/ 需要/ 满足/ 以下/ 的/ 条件/ :/ (/ 1/ )/ 在/ 对/ 特征/ f/ 执行/ 选择性/ 回退/ 算法/ 后/ ,/ f/ 的/ 绑/ (/ 2/ )/ 在/ 执行/ 定制/ 的/ 选择性/ 回/ 退后/ ,/ 不/ 允许/ 出现/ (/ 3/ )/ 定制/ 的/ 选择性/ 回退/ 算法/ 应该/ 尽可能/ 多地/ 保留/ 定制/ 者/ 的/ 定制/ 决策/ ./ 例如/ ,/ 对于/ 下面/ 的/ 例子/ :/ f1/ 表示/ 使用/ 平台/ ;/ f2/ 表示/ 桌面/ 平台/ ;/ f3/ 表示/ 平板/ 电脑/ 平台/ ;/ f4/ 表示/ 手机/ 平台/ ;/ f5/ 表示/ 呼叫/ 转接/ ./ 它们/ 之间/ 具有/ 如下/ 的/ 约束/ 关系/ :/ 这时/ ,/ 当/ 定制/ 者/ 进行/ 以下/ 4/ 步时/ ,/ f4/ 将/ 被/ 绑定/ :/ f1/ →/ single/ -/ boundf2/ ,/ f3/ ,/ f/ (/ )/ 4/ ,/ f5/ →/ f4/ ①/ 删除/ f3/ ./ ②/ 删除/ f2/ ./ ③/ 绑定/ f1/ ./ ④/ 绑定/ f5/ ./ 那么/ ,/ 此时/ 如果/ 定制/ 者/ 选择性/ 回退/ 特征/ f4/ ,/ 选择性/ 回退/ 算法/ 需要/ 做/ 的/ ,/ 就是/ 取消/ 其后/ 两步/ ,/ 将/ f1/ 与/ f5/ 的/ 绑定/ 状态/ 变回/ undecided/ ./ 这样/ f4/ 的/ 绑定/ 状态/ 就/ 会/ 变为/ undecided/ ./ 如果/ 仅仅/ 取消/ 第/ 3/ 步/ 或/ 第/ 4/ 步/ 其中/ 的/ 一步/ ,/ 那么/ 显而易见/ ,/ f4/ 的/ 绑定/ 状态/ 仍/ 应定/ 状态/ 需/ 变为/ undecided/ ./ 某些/ 特征/ 的/ 绑定/ 状态/ 与/ 约束/ 关系/ 相冲突/ ./ Page8/ 为/ bound/ 而/ 非/ undecided/ ./ 但/ 选择性/ 回退/ 算法/ 不/ 应当/ 再/ 取消/ 第/ 1/ 步/ 或/ 第/ 2/ 步/ ,/ 因为/ 取消/ 后/ 两步/ 已经/ 足以/ 让/ f4/ 回退/ 到/ undecided/ ,/ 本着/ 保留/ 尽可能/ 多/ 的/ 定制/ 决策/ 的/ 目的/ ,/ 不/ 应该/ 再/ 回退/ 更/ 多/ 的/ 定制/ 决策/ ./ 对于/ 上述/ 选择性/ 回退/ 算法/ ,/ 下面/ 分/ 两个/ 部分/ 来/ 讲述/ 选择性/ 回退/ 算法/ 的/ 实现/ 步聚/ ./ 4.1/ 单步/ 回退/ 算法/ 单步/ 回退/ 算法/ 是/ 指/ 回退/ 定制/ 者/ 定制/ 决策/ 的/ 最后/ 一步/ ,/ 即/ Undo/ 操作/ ./ 单步/ 回退/ 算法/ 可以/ 算/ 做/ 是/ 选择性/ 回退/ 算法/ 的/ 一部分/ ,/ 是/ 实现/ 选择性/ 回退/ 算法/ 的/ 基础/ ./ 为了/ 实现/ 单步/ 回退/ 算法/ ,/ 首先/ 需要/ 开辟/ 一个/ 栈/ 空间/ ActionStack/ ,/ 用来/ 存放/ 定制/ 者/ 已经/ 完成/ 的/ 定制/ 决策/ ./ ActionStack/ 栈/ 的/ 每一项/ 被/ 称为/ 一个/ Action/ -/ Item/ ,/ 包含/ 3/ 部分/ 内容/ :/ (/ 1/ )/ 定制/ 决策/ 的/ 定制/ 源/ (/ 即/ 用户/ 手动/ 修改/ 绑定/ 状态/ 的/ 特征/ )/ ,/ 设为/ Source/ ./ (/ 2/ )/ 本次/ 定制/ 决策/ 影响/ 到/ 的/ 一组/ 特征/ ,/ 这些/ 特征/ 被/ 修改/ 绑定/ 状态/ ,/ 设为/ Features/ ./ (/ 3/ )/ 本次/ 定制/ 决策/ 影响/ 到/ 的/ 一组/ 谓词/ ,/ 这些/ 谓词/ 被/ 修改/ 真值/ ,/ 设为/ Predicates/ ./ 其/ 结构/ 如图/ 3/ 所示/ ./ 为了/ 实现/ 单步/ 回退/ 算法/ ,/ 需要/ 对/ propagation/ 算法/ 加以/ 修改/ ./ 每/ 调用/ 一次/ propagation/ 算法/ 之后/ ,/ 都/ 需要/ 记录/ 在/ 其中/ 影响/ 到/ 的/ 特征/ 与/ 谓词/ ./ 当/ propagation/ 算法/ 被/ 调用/ 一次/ ,/ 就/ 需要/ 在/ ActionStack/ 栈中/ 追加/ 一项/ ActionItem/ 压入/ 栈/ 中/ ./ 其中/ 该/ ActionItem/ 的/ Source/ 属性/ 为/ propagation/ 算法/ 的/ 参数/ ,/ 其/ Features/ 与/ Predicates/ 属性/ 分别/ 为/ 这个/ propagation/ 算法/ 影响/ 到/ 的/ 特征/ 与/ 谓词/ ./ 在/ 执行/ 单步/ 回退/ 操作/ 时/ ,/ 算法/ 需要/ 将/ Action/ -/ Stack/ 栈/ 的/ 最后/ 一项/ 弹/ 出/ ,/ 取出/ 其/ 定制/ 源/ ,/ 将/ Source/ 与/ Features/ 的/ 特征/ 的/ 绑定/ 状态/ 还原/ 为/ undecided/ ,/ 并/ 将/ Predicates/ 的/ 真值/ 还原/ 为/ unknown/ ,/ 即可/ 实现/ 单步/ 回退/ 操作/ ./ 4.2/ 选择性/ 回退/ 算法/ 选择性/ 回退/ 算法/ 的/ 思路/ 是/ 依据/ 定制/ 决策/ 的/ 时序/ 性/ ,/ 利用/ ActionStack/ 与/ 单步/ 回退/ 算法/ 实现/ 定制/ 的/ 选择性/ 回退/ ./ ActionStack/ 是/ 一个/ 栈/ 的/ 结构/ ,/ 每次/ 的/ 存取/ 都/ 访问/ 顶端/ 的/ 元素/ ,/ 对于/ 选择性/ 回退/ 算法/ 而言/ ,/ 需要/ 取消/ ActionStack/ 中间/ 的/ 定制/ 决策/ ./ 当然/ ,/ 并/ 不能/ 简简单单/ 地/ 将/ 对应/ 项/ 的/ ActionItem/ 中/ 的/ 相关/ 特征/ 与/ 相关/ 谓词/ 回退/ ,/ 因为/ 这样/ 可能/ 会/ 对/ 之后/ 的/ 定制/ 的/ 自动/ 传播/ 产生/ 影响/ ./ 一个/ 很/ 容易/ 想到/ 的/ 思路/ 是/ 做/ 多次/ 的/ 弹栈/ 与/ 压栈/ 操作/ ./ 比如/ ,/ 当/ 现在/ 的/ ActionStack/ 一共/ 含有/ n/ 个/ ActionItem/ ,/ 如果/ 想要/ 取消/ 第/ m/ 项/ 的/ 定制/ 决策/ ,/ 则/ 先/ 执行/ Undo/ 操作/ m/ -/ n/ +/ 1/ 次/ ,/ 再/ 执行/ m/ -/ n/ 次/ propagation/ 算法/ 将/ 最后/ 的/ m/ -/ n/ 个/ 定制/ 决策/ 重新/ 执行/ ./ 但是/ ,/ 这样/ 就/ 会/ 造成/ 一些/ 问题/ ./ 例如/ 现在/ 需要/ 选择性/ 回退/ 一个/ 特征/ f/ ,/ 先/ 执行/ Undo/ 操作/ m/ -/ n/ +/ 1/ 次后/ ,/ 这时/ f/ 的/ 定制/ 状态/ 会/ 被/ 回复/ 到/ undecided/ ./ 如果/ 再/ 执行/ m/ -/ n/ 次/ 的/ propagation/ 操作/ ,/ 这/ m/ -/ n/ 次/ 的/ propagation/ 操作/ 可能/ 会/ 再次/ 修改/ f/ 的/ 绑定/ 状态/ ./ 一个/ 直观/ 的/ 例子/ 如图/ 4/ 所示/ ./ 当/ 定制/ 者/ 按/ 顺序/ 绑定/ 特征/ A/ 、/ B/ 、/ C/ 、/ D/ 时/ ,/ 特征/ E/ 这时/ 会/ 被/ 绑定/ 。/ 此时/ 的/ ActionStack/ 如图/ 5/ 所示/ (/ 由于/ 在/ 定制/ 的/ 自动/ 传播/ 算法/ 中/ ,/ 在/ A/ 被/ 绑定/ 之后/ ,/ E/ 的/ pro/ 属性/ 已经/ 被/ 修改/ ,/ 故而/ 绑定/ B/ 、/ C/ 、/ D/ 都/ 不会/ 影响/ 到/ E/ 的/ 绑定/ 状态/ )/ :/ 此时/ ,/ 可以/ 找到/ E/ 的/ 绑定/ 状态/ 发生变化/ 是/ 由/ 第一步/ 定制/ 决策/ 导致/ 的/ ,/ 但是/ 由于/ 绑定/ B/ 、/ C/ 、/ D/ 这/ 3/ 个/ 定制/ 决策/ ,/ 都/ 会/ 导致/ 特征/ E/ 被/ 绑定/ ,/ 所以/ 通过/ 先/ 进行/ 数次/ Undo/ 操作/ ,/ 再/ 重新/ propagation/ 的/ 做法/ 是/ 无法/ 实现/ 定制/ 的/ 选择性/ 回退/ 的/ ./ 一个/ 比较/ 好/ 的/ 解决/ 方法/ 是/ ,/ 如果/ 要/ 将/ 一个/ 特征/ f/ 选择性/ 回退/ ,/ 先/ 找出/ 是/ 哪/ 一步/ 定制/ 决策/ (/ 设为/ 第/ m/ 步/ )/ 影响/ 了/ f/ 的/ 绑定/ 状态/ ./ 根据/ 定制/ 的/ 自动/ 传播/ 的/ 机理/ ,/ 前/ m/ -/ 1/ 步/ 的/ 所有/ 定制/ 决策/ ,/ 都/ 是/ 可以/ 被/ 保留/ 的/ ./ 同时/ ,/ 第/ m/ 步/ 的/ 定制/ 决策/ ,/ 将/ 必然/ 不/ 可以/ 被/ 保留/ ./ 然后/ 再/ 对/ 第/ m/ 步/ 之后/ 的/ 定制/ 决策/ ,/ 进行/ 讨论/ ./ Page9/ 可以/ 通过/ 一个/ 试探性/ 的/ propagation/ 算法/ ,/ 决定/ 该/ 定制/ 决策/ 是否/ 被/ 保留/ ./ 比如/ ,/ 当/ 讨论/ 到/ 第/ p/ 个/ 定制/ 决策/ 时/ (/ p/ >/ m/ )/ ,/ 先对/ 其/ 进行/ 一次/ propagation/ ,/ 如果/ 发现/ 它/ 修改/ 了/ f/ 的/ 定制/ 状态/ ,/ 再/ 进行/ Undo/ 操作/ ,/ 证明/ 该/ 定制/ 决策/ 不可/ 用/ ,/ 然后/ 讨论/ 第/ p/ +/ 1/ 个/ 定制/ 决策/ ,/ 直到/ ActionStack/ 结束/ ./ 例如/ ,/ 对于/ 上面/ 的/ 例子/ 而言/ ,/ 它/ 的/ 执行/ 过程/ 如图/ 6/ 所示/ ,/ 叉号/ 表示/ 定制/ 决策/ 不可/ 用/ ,/ 未/ 被/ 选中/ ./ ActionStack/ )/ {/ 此/ 算法/ 实现/ 如/ 算法/ 3/ ./ 算法/ 3/ ./ 选择性/ 回退/ 算法/ ./ 输入/ :/ 需要/ 选择性/ 回退/ 的/ 特征/ f/ ./ 输出/ :/ 在/ 选择性/ 回退/ 过程/ 结束/ 后/ 的/ 特征/ 绑定/ 状态/ (/ BS/ )/ ./ 1/ ./ selective/ _/ undo/ (/ Featuref/ )/ {/ 2/ ./ if/ (/ f/ ./ binding/ _/ state/ =/ =/ undecided/ )/ 3/ ./ return/ ;/ 4/ ./ intm/ ;/ // // 记录/ 哪/ 一项/ 定制/ 决策/ 修改/ 了/ f/ 的/ 绑定/ 状态/ 5/ ./ for/ (/ declarevaraiasActionItem/ ,/ eachaiin6/ ./ if/ (/ ai/ ./ Source/ =/ =/ F/ ‖/ ai/ ./ Features/ ./ contains/ (/ F/ )/ )/ {/ 7/ ./ m/ =/ ai/ ./ index/ ;/ 8/ ./ break/ ;/ 9/ ./ }/ 10/ ./ }/ 11/ ./ Featureft/ [/ ]/ ;/ 12/ ./ binding/ _/ statebs/ [/ ]/ ;/ 13/ ./ for/ (/ intj/ =/ m/ +/ 1/ ;/ j/ </ ActionStack/ ./ size/ (/ )/ ;/ j/ ++/ )/ {/ 14/ ./ ActionItemai/ =/ ActionStack/ [/ j/ ]/ ;/ 15/ ./ ft/ ./ add/ (/ ai/ ./ Source/ )/ ;/ 16/ ./ bs/ ./ add/ (/ ai/ ./ Source/ ./ binding/ _/ state/ )/ ;/ 17/ ./ }/ 18/ ./ for/ (/ inti/ =/ 1/ ;/ i/ </ =/ ActionStack/ ./ size/ (/ )/ -/ m/ ;/ i/ ++/ )/ {/ 19/ ./ Undo/ (/ )/ ;/ 20/ ./ }/ 21/ ./ for/ (/ inti/ =/ 0/ ;/ i/ </ ft/ ./ size/ (/ )/ ;/ i/ ++/ )/ {/ 22/ ./ set/ (/ ft/ [/ i/ ]/ ,/ [/ bs/ [/ i/ ]/ ]/ ;/ 23/ ./ propagation/ (/ ft/ [/ i/ ]/ )/ ;/ 24/ ./ if/ (/ ft/ [/ i/ ]/ ./ binding/ _/ state/ =/ =/ undecided/ )/ continue/ ;/ 25/ ./ Undo/ (/ )/ ;/ 26/ ./ }/ 27/ ./ }/ 算法/ 的/ 第/ 4/ ~/ 10/ 行/ 的/ 作用/ 是/ 寻找/ 是/ 哪/ 一个/ 定制/ 决策/ 影响/ 了/ f/ 的/ 绑定/ 状态/ ,/ 设为/ m/ ./ 第/ 11/ ~/ 17/ 行是/ 临时/ 存储/ 第/ m/ 项/ 之后/ 的/ 定制/ 决策/ ./ 之后/ 连续/ 进行/ 多个/ Undo/ 操作/ ,/ 第/ 21/ ~/ 26/ 行/ 检查/ 第/ m/ 项/ 之后/ 的/ 定制/ 决策/ 是否/ 可以/ 使用/ ,/ 如果/ 可以/ ,/ 则/ 使用/ ;/ 否则/ ,/ 则/ 跳/ 过/ ./ 对于/ 特征/ 模型/ 的/ 定制/ ,/ 通过/ 定制/ 决策/ 的/ 自动/ 传播/ 算法/ 与/ 选择性/ 回退/ 算法/ 就/ 可以/ 实现/ 特征/ 模型/ 中/ 特征/ 绑定/ 状态/ 的/ 自由/ 切换/ ./ 如果/ 定制/ 者/ 将/ 一个/ 特征/ 从/ BoundSet/ 中/ 转移/ 到/ RemovedSet/ 中/ ,/ 或者/ 将/ 其/ 从/ RemovedSet/ 中/ 转移/ 到/ BoundSet/ 中/ ,/ 那么/ 就/ 可以/ 通过/ 先/ 调用/ selective/ -/ undo/ 算法/ 将/ 其/ 转移/ 到/ UndecidedSet/ 中/ ,/ 然后/ 再/ 将/ 之/ 转移/ 到/ BoundSet/ // RemovedSet/ 中/ ./ 特征/ 在/ 这/ 3/ 种/ 绑定/ 状态/ 之间/ 的/ 相互/ 转化/ 如图/ 7/ 所示/ ./ 上述/ 算法/ 可以/ 确保/ 在/ 选择性/ 回退/ 的/ 过程/ 之中/ ,/ 保留/ 了/ 尽可能/ 多/ 的/ 定制/ 决策/ ./ 假设/ 选择性/ 回退/ 特征/ f/ 的/ 过程/ 保留/ 的/ 定制/ 决策/ 集合/ 为/ S/ _/ Set/ ,/ 在/ 该/ 过程/ 中/ 去除/ 的/ 定制/ 决策/ 集合/ 为/ R/ _/ Set/ ,/ 假设/ 如果/ 有/ 另/ 一个/ 集合/ S/ _/ Set/ 满足/ 让/ f/ 的/ 绑定/ 状态/ 变为/ undecided/ ,/ 同时/ S/ _/ Set/ / S/ _/ Set/ ,/ 那么/ ,/ 必然/ 可以/ 寻找/ 到/ 一个/ 决策/ U/ ,/ 使得/ U/ ∈/ S/ _/ Set/ 同时/ U/ ∈/ R/ _/ Set/ ./ 然而/ ,/ 在/ 选择性/ 回退/ 的/ 过程/ 中/ ,/ 采用/ 决策/ U/ 会/ 导致/ f/ 的/ 绑定/ 状态/ 变为/ bound/ // removed/ (/ 由/ S/ _/ Set/ 与/ R/ _/ Set/ 的/ 计算/ 过程/ 可知/ )/ ,/ 这/ 与/ S/ _/ Set/ 满足/ 让/ f/ 的/ 绑定/ 状态/ 变为/ undecided/ 矛盾/ ./ 因而/ 上述/ 算法/ 确保/ 在/ 选择性/ 回退/ 过程/ 中/ 保留/ 尽可能/ 多/ 的/ 定制/ 决策/ ./ 4.3/ 关于/ 回退/ 方法/ 的/ 总结/ 回退/ 操作/ 是/ 许多/ 系统/ 中/ 都/ 会/ 遇到/ 和/ 解决/ 的/ 问题/ ./ 例如/ ,/ 在/ 文本编辑/ 操作/ 、/ 图形/ 编缉/ 、/ 面向对象/ 建模/ 等/ 过程/ 中/ ,/ 都/ 会/ 用到/ 回退/ 操作/ ./ 特征/ 模型/ 的/ 定制/ 过程/ 中/ 的/ 选择性/ 回退/ 操作/ 与/ 这些/ 回退/ 操作/ 既有/ 一定/ 的/ 共同点/ ,/ 也/ 有/ 其/ 不同之处/ ./ 回退/ 操作/ 机制/ 大致/ 上/ 可以/ 分为/ 3/ 种/ :/ 单次/ 回退/ 机制/ 、/ 多次/ 回退/ 机制/ 与/ 选择性/ 回退/ 机制/ ./ 单次/ 回退/ 机制/ 是/ 指/ 允许/ 使用者/ 回退/ 刚刚/ 进行/ 的/ 操作/ ,/ 但/ 无法/ 连续/ 回退/ 多步/ ./ 多次/ 回退/ 机制/ 则/ 是/ 将/ 使用者/ 的/ 操作/ 记录/ 于/ 一个/ 栈中/ (/ 类似/ 于/ 在/ 本/ 算法/ 中/ 使用/ 的/ Action/ -/ Stack/ 结构/ )/ ,/ 回退/ 的/ 过程/ 是/ 一个/ 弹栈/ 的/ 过程/ ,/ 其过/ Page10/ 程/ 类似/ 于/ 本文/ 中/ 之前/ 提到/ 的/ 特征/ 模型/ 定制/ 过程/ 中/ 的/ 单步/ 回退/ 操作/ ./ 特征/ 模型/ 定制/ 操作/ 的/ 回退/ 过程/ ,/ 与/ 其它/ 回退/ 过程/ 的/ 不同之处/ 在于/ 它/ 具有/ 选择性/ 回退/ 操作/ ./ 选择性/ 回退/ 的/ 机制/ 允许/ 取消/ 定制/ 者/ 做/ 过/ 的/ 错误/ 定制/ 决策/ ./ 由于/ 错误/ 的/ 定制/ 决策/ 很/ 有/ 可能/ 并非/ 是/ 最近/ 的/ 定制/ 决策/ ,/ 需要/ 考虑/ 该/ 定制/ 决策/ 与/ 最近/ 的/ 定制/ 决策/ 之间/ 的/ 操作/ 是否/ 会/ 对/ 结果/ 产生/ 影响/ ,/ 所以/ 需要/ 制定/ 相关/ 的/ 算法/ ,/ 以/ 确保/ 最终/ 得到/ 定制/ 者/ 希望/ 得到/ 的/ 结果/ ./ 本文/ 中/ 提到/ 的/ 定制/ 的/ 选择性/ 回退/ 算法/ 可以/ 得到/ 一条/ 可行/ 的/ 定制/ 回退/ 方案/ ./ 同时/ ,/ 在/ 这条/ 定制/ 方案/ 中/ ,/ 已经/ 不能/ 再/ 加入/ 任何/ 一条/ 先前/ 的/ 定制/ 决策/ 使得/ 目标/ 特征/ 的/ 绑定/ 状态/ 为/ undecided/ 同时/ 满足/ 特征/ 模型/ 的/ 约束/ 关系/ ./ 然而/ ,/ 本文/ 中/ 的/ 准则/ ,/ 即求/ 出/ 一条/ 最大/ 的/ 可行/ 定制/ 回退/ 方案/ ,/ 有/ 的/ 时候/ ,/ 并非/ 是/ 定制/ 者/ 想要/ 的/ 结果/ ./ 例如/ ,/ 对于/ 本/ 节/ 开始/ 的/ 例子/ ,/ 如果/ 取消/ 第/ 1/ 步/ 与/ 第/ 4/ 步/ ,/ 一样/ 可以/ 让/ 特征/ f4/ 的/ 绑定/ 状态/ 回退/ 为/ undecided/ ./ 如何/ 取得/ 特征/ 模型/ 定制/ 的/ 选择性/ 回退/ 的/ 多种/ 回退/ 方案/ ,/ 将/ 是/ 未来/ 的/ 工作/ 需要/ 实现/ 的/ 目标/ ./ 5/ 支持/ 工具/ 本文/ 所/ 提出/ 的/ 针对/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ 与/ 选择性/ 回退/ 机制/ ,/ 均/ 已/ 在/ 开发/ 的/ 基于/ 矩阵/ 的/ 特征/ 模型/ 建模/ 与/ 定制/ 工具/ 中/ 得以/ 实现/ ./ 图/ 8/ 是/ 该/ 工具/ 的/ 一张/ 截图/ ./ 该/ 工具/ 采用/ SWT/ // JFace/ 设计/ ,/ 作为/ 一个/ Eclipse/ 插件/ 使用/ ./ 界面/ 的/ 顶部/ 是/ 一个/ 工具栏/ ,/ 用来/ 管理/ I/ // O/ 与/ 特征/ 模型/ 的/ 建模/ 功能/ ,/ 同时/ 可以/ 切换/ 特征/ 模型/ 的/ 建模/ 状态/ 与/ 定制/ 状态/ ./ 界面/ 的/ 中部/ 是/ 采用/ 表格/ 的/ 形式/ 显示/ 整个/ 特征/ 模型/ ,/ 最/ 左/ 列为/ 特征/ 模型/ 的/ 特征/ 树/ ,/ 第/ 2/ 列为/ 特征/ 的/ 绑定/ 状态/ ,/ 之后/ 每/ 一列/ 都/ 表示/ 特征/ 模型/ 的/ 一个/ 约束/ 关系/ ./ 与/ 约束/ 关系/ 相关/ 的/ 特征/ 将/ 在/ 表格/ 内用/ 圆角/ 矩形/ 予以/ 表示/ ./ 特征/ 树中/ 的/ 特征/ 用/ 黑色/ 和/ 蓝色/ 区分/ 必选/ 特征/ 与/ 可选/ 特征/ ./ 界面/ 的/ 底部/ 是/ 一些/ 辅助/ 窗口/ ,/ 分别/ 表示/ 特征/ 模型/ 的/ 特征/ 属性/ 、/ 预/ 传播/ 、/ 定制/ 决策/ 列表/ 与/ 约束/ 列表/ ./ 在/ 建模/ 状态/ 下/ ,/ 该/ 工具/ 可以/ 修改/ 特征/ 的/ 属性/ ./ 在/ 定制/ 状态/ 下/ ,/ 可以/ 修改/ 特征/ 的/ 绑定/ 状态/ 以/ 进行/ 特征/ 模型/ 的/ 定制/ 操作/ ./ 6/ 总结/ 本文/ 提出/ 了/ 一种/ 特征/ 模型/ 定制/ 的/ 自动/ 传播/ 机制/ 与/ 选择性/ 回退/ 机制/ ,/ 并/ 给出/ 相应/ 的/ 实现/ 算法/ ./ 定制/ 的/ 自动/ 传播/ 算法/ 的/ 主要/ 特点/ 是/ 可以/ 处理/ 关于/ 二元/ 约束/ 与/ 组合/ 约束/ 的/ 自动/ 传播/ ,/ 而/ 选择性/ 回退/ 算法/ 则/ 可/ 对/ 先前/ 错误/ 的/ 定制/ 决策/ 予以/ 撤销/ ,/ 使得/ 定制/ 操作/ 可以/ 自由/ 地/ 改变/ 特征/ 模型/ 中/ 特征/ 的/ 绑定/ 状态/ ,/ 同时/ 满足/ 特征/ 模型/ 中/ 的/ 约束/ 关系/ ./ 通过/ 支持/ 工具/ 的/ 实验/ 验证/ ,/ 该/ 算法/ 对/ 特征/ 模型/ 的/ 定制/ 操作/ 可以/ 提供/ 很/ 好/ 的/ 支持/ ./ 本文/ 所提/ 的/ 特征/ 模型/ 定制/ 方法/ 仍然/ 具有/ 进一步/ 优化/ 的/ 可能/ ,/ 比如说/ 在/ 选择性/ 回退/ 时/ ,/ 可以/ 提供/ 更/ 多/ 的/ 回退/ 路线/ ./ 在/ 将来/ 的/ 工作/ 中/ ,/ 将/ 继续/ 深入研究/ 特征/ 模型/ 定制/ 问题/ 的/ 特点/ ,/ 并/ 希望/ 能够/ 利用/ 这些/ 特点/ 进一步/ 完善/ 特征/ 模型/ 定制/ 的/ 相关/ 算法/ ./ 

