Page1/ 面向/ 不/ 确定/ 图/ 的/ 概率/ 可/ 达/ 查询/ 袁野/ 1/ )/ ,/ 2/ )/ 王国/ 仁/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 医学影像/ 计算/ 教育部/ 重点/ 实验室/ (/ 东北大学/ )/ 沈阳/ 110004/ )/ 2/ )/ (/ 东北大学/ 信息科学/ 与/ 工程学院/ 沈阳/ 110004/ )/ 摘要/ 图/ 的/ 可达性/ 查询/ 被/ 广泛应用/ 于/ 生物/ 网络/ 、/ 社会/ 网络/ 、/ 本体/ 网络/ 、/ RDF/ 数据库/ 和/ XML/ 数据库/ 等/ ./ 由于/ 对/ 数据/ 操作/ 时/ 引入/ 的/ 噪声/ 和/ 错误/ 使/ 这些/ 图/ 数据/ 具有/ 不确定性/ ,/ 已经/ 有/ 大量/ 的/ 针对/ 不/ 确定/ RDF/ 和/ XML/ 数据库/ 的/ 研究/ ./ 文中/ 使用/ 可能/ 世界/ 语义/ 模型/ 构建/ 不/ 确定/ 图/ ,/ 基于/ 该/ 模型/ ,/ 研究/ 了/ 概率/ 可/ 达/ 查询/ (/ PR/ )/ ./ 处理/ PR/ 查询/ 是/ #/ P/ 完全/ 问题/ ,/ 对此/ 文中/ 首先/ 给出/ 一个/ 基本/ 随机/ 算法/ ,/ 可/ 快速/ 地/ 估算/ 出可达/ 概率/ ,/ 并且/ 该值/ 有/ 很/ 高/ 的/ 精确度/ ./ 进一步/ ,/ 文中/ 为/ 随机/ 算法/ 引入/ 条件/ 分布/ (/ 称为/ “/ 条件/ 随机/ 算法/ ”/ )/ ,/ 采用/ 图/ 的/ 不/ 相交/ 路径/ 集和割/ 集/ 作为/ 条件/ 概率分布/ ,/ 因此/ 改进/ 的/ 随机/ 算法/ 可/ 准确/ 地/ 并且/ 是/ 在/ 多项式/ 时间/ 内/ 处理/ 查询/ ./ 最后/ 基于/ 真实/ 不/ 确定/ 图/ 数据/ 的/ 大量/ 实验/ 结果/ 验证/ 了/ 文中/ 的/ 设计/ ./ 关键词/ 不/ 确定/ 图/ ;/ 可能/ 世界/ ;/ 条件/ 随机/ 算法/ ;/ 路径/ 集/ ;/ 割集/ 1/ 引言/ 本文/ 研究/ 一个/ 不/ 确定/ 图上/ 任意/ 两点/ 的/ 可达性/ 问题/ ./ 具体/ 地/ ,/ 给出/ 一/ 不/ 确定/ 图/ 和/ 其/ 任意/ 两点/ s/ 和/ d/ ,/ 欲/ 返回/ s/ 和/ d/ 的/ 连通/ 概率/ ./ 由于/ 不/ 确定/ 图/ 存在/ 于/ 许多/ 应用/ 中/ [/ 1/ -/ 5/ ]/ ,/ 研究/ 不/ 确定/ 图中/ 的/ 可达/ 查询/ 十分必要/ ,/ 下面/ 给出/ 两个/ 具体/ 应用/ 的/ 实例/ ./ 应用/ 实例/ 1/ ./ 文献/ [/ 3/ ]/ 给出/ 了/ 一个/ 音乐/ 推荐/ 社会/ 网络/ ./ 该/ 网络/ 的/ 每个/ 节点/ 代表/ 一个/ 音乐/ 用户/ ,/ 赋予/ 每条/ 边/ 一/ 概率/ 来/ 表示/ 一个/ 用户/ 的/ 音乐/ 建议/ 将/ 被/ 另/ 一个/ 用户/ 采纳/ 的/ 可能性/ ./ 图/ 1/ 给出/ 该/ 网络/ 的/ 一部分/ ,/ 在/ 图/ 中/ ,/ 边/ e3/ 上/ 的/ 概率/ 表示/ 用户/ B/ 的/ 建议/ 影响/ 用户/ A/ 的/ 概率/ 是/ 0.75/ ./ 对图/ 1/ ,/ 会/ 提出/ 查询/ “/ 用户/ s/ 的/ 建议/ 影响/ 用户/ d/ 的/ 概率/ 是/ 多少/ ?/ ”/ ./ 应用/ 实例/ 2/ ./ 在/ 生物/ 信息学/ 中/ ,/ 常用/ 蛋白质/ 作用/ (/ PPI/ )/ 网络分析/ 蛋白质/ 之间/ 的/ 关系/ ./ 在/ PPI/ 网络/ 中/ ,/ 节点/ 表示/ 蛋白质/ ,/ 边/ 表示/ 两种/ 蛋白质/ 之间/ 的/ 相互作用/ ,/ 其中/ 可/ 达/ 查询/ 是/ 一种/ 基本/ 分析方法/ ./ 例如/ ,/ 会/ 提出/ “/ 是否/ 一种/ 基因/ 会/ 间接/ 地受/ 另/ 一种/ 基因/ 控制/ ?/ 或/ 两种/ 蛋白质/ 之间/ 是否/ 存在/ 生物/ 路径/ ?/ ”/ 等/ 问题/ ./ 由表/ 1/ 图/ 1/ 中/ s/ 和/ d/ 可达/ 的/ 可能/ 世界/ e1e2e3e4e5/ (/ Pr/ =/ 0.3672/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0918/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.1224/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0408/ )/ e1e2e3e4e5/ (/ Pr/ =/ 0.0306/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0136/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0102/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0034/ )/ e1e2e3e4e5/ (/ Pr/ =/ 0.0648/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0072/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0918/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0162/ )/ e1e2e3e4e5/ (/ Pr/ =/ 0.0306/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0054/ )/ ,/ e1e2e3e4e5/ (/ Pr/ =/ 0.0216/ )/ 一种/ 直接/ 求解/ PR/ 查询/ 的/ 方法/ 是/ 枚举/ 不/ 确定/ 图/ 所有/ 的/ 可能/ 图/ ,/ 并且/ 对/ 每个/ 可能/ 图/ 做/ 传统/ 的/ 可达/ 查询处理/ ./ 找出/ 所有/ 给定/ 两点/ 连通/ 的/ 可能/ 图/ ,/ 对/ 其/ 概率/ 求和/ ,/ 所得/ 结果/ 即/ 是/ 可达/ 概率/ ./ 该/ 方法/ 被/ 称为/ Naive/ 算法/ ./ 但是/ ,/ 此/ 方法/ 的/ 效率/ 非常低/ ,/ 因为/ 需/ 枚举/ 指数/ 级/ 的/ 可能/ 图/ ./ 因此/ ,/ 欲/ 快速/ 求解/ 查询/ ,/ 本文/ 首先/ 给/ 出于/ 不/ 准确/ 的/ PPI/ 检测/ 方法/ ,/ 使用/ 不/ 确定/ 图/ 表示/ PPI/ 网络/ 是/ 合适/ 的/ ,/ 其中/ 不/ 确定/ 边/ 的/ 权值/ 表示/ 蛋白质/ 之间/ 存在/ 相互作用/ 的/ 可能性/ [/ 4/ ,/ 6/ ]/ ./ 文献/ [/ 7/ ]/ 给出/ 一个/ 真实/ PPI/ 网络/ ,/ 其中/ 每条/ 边/ 被/ 赋予/ 一个/ 概率/ ./ 此/ 概率/ 被/ 定义/ 为/ 两种/ 蛋白质/ 之间/ 的/ 可靠性/ ,/ 该值/ 越大/ ,/ 两种/ 蛋白质/ 之间/ 越/ 可靠/ ./ 对于/ 该/ 网络/ ,/ 可以/ 用/ 可达/ 查询/ 计算/ 一种/ 蛋白质/ 到/ 另/ 一种/ 蛋白质/ 的/ 可靠性/ ./ 从/ 以上/ 应用/ 实例/ 可/ 看出/ ,/ 基于/ 不/ 确定/ 有向图/ 的/ 可达性/ 查询/ 比/ 在/ 传统/ 确定/ 有向图/ 的/ 可达/ 查询/ 能/ 表达/ 出/ 更/ 丰富/ 的/ 语义/ ./ 例如/ 图/ 1/ 所示/ 的/ 音乐/ 建议/ 网络/ ,/ 边/ 的/ 方向/ 表示/ 建议/ 的/ 方向/ ./ 传统/ 的/ s/ 和/ d/ 之间/ 的/ 可达性/ 查询/ 仅/ 返回/ s/ 的/ 建议/ 可以/ 影响/ d/ ./ 但是/ ,/ 例/ 1/ 中/ 提出/ 查询/ 不仅/ 返回/ “/ 可以/ 影响/ ”/ ,/ 而且/ 还/ 返回/ 影响/ 的/ 程度/ ./ 为/ 解决/ 不/ 确定/ 有向图/ 的/ 概率/ 可/ 达/ 查询/ 问题/ ,/ 本文/ 采用/ 可能/ 世界/ 模型/ [/ 8/ -/ 9/ ]/ (/ 一种/ 被/ 用来/ 描述/ 概率/ 数据库/ 的/ 模型/ )/ 表达/ 不/ 确定/ 图/ ./ 具体/ 地/ ,/ 给出/ 一个/ 不/ 确定/ 有向图/ ,/ 赋予/ 每/ 边/ 一个/ 存在/ 概率/ ,/ 根据/ 文献/ [/ 1/ -/ 4/ ,/ 7/ ]/ 应用/ 的/ 规定/ ,/ 本文/ 假设/ 不同/ 边/ 的/ 分布/ 是/ 独立/ 的/ ./ 一个/ 不/ 确定/ 图/ 的/ 可能/ 世界/ 是/ 一个/ 确定/ 图/ ,/ 称为/ 可能/ 世界/ 图/ (/ 简称/ 可能/ 图/ )/ ,/ 它/ 是/ 不/ 确定/ 图中/ 所有/ 边/ (/ 取决于/ 它们/ 的/ 存在/ 性/ )/ 组合/ 的/ 一个/ 实例/ ./ 一个/ 可能/ 图/ 的/ 概率/ 是/ 其/ 所有/ 存在/ 边/ 概率/ 和/ 其/ 不/ 存在/ 边/ 的/ 不/ 存在/ 概率/ 的/ 乘积/ ./ 给定/ 不/ 确定/ 图/ 两/ 顶点/ s/ 和/ d/ ,/ 从/ s/ 到达/ d/ 的/ 可达/ 概率/ 是/ 部分/ 可能/ 图/ 概率/ 的/ 和/ ,/ 在/ 这些/ 可能/ 图中/ ,/ s/ 和/ d/ 必须/ 是/ 连通/ 的/ ./ 图/ 1/ 给出/ 一/ 不/ 确定/ 图/ ,/ 计算/ 从/ s/ 到/ d/ 的/ 可达/ 概率/ ./ 很/ 明显/ 该/ 不/ 确定/ 图可派/ 生出/ 25/ =/ 32/ 个/ 可能/ 图/ ./ 表/ 1/ 列出/ 了/ 所有/ s/ 到/ d/ 连通/ 的/ 可能/ 图/ 和/ 相应/ 的/ 概率/ ./ 那么/ s/ 到/ d/ 的/ 可达/ 概率/ 即/ 是/ 这些/ 可能/ 图/ 概率/ 的/ 和/ ,/ 其值/ 是/ 0.9176/ ./ 一/ 基本/ 随机/ 算法/ ,/ 该/ 算法/ 用于/ 模拟/ 产生/ 可能/ 图/ 的/ 过程/ ,/ 从而/ 可以/ 快速/ 在/ 此/ 过程/ 中/ 求解/ 查询/ ,/ 并用/ 相关/ 理论/ 保证/ 结果/ 的/ 准确性/ ./ 此/ 算法/ 的/ 缺点/ 是/ 对/ 较/ 小/ 的/ 可达/ 概率/ 收敛/ 速度慢/ ,/ 而/ 小可/ 达/ 概率/ 是/ 图/ 数据库/ 应用/ 的/ 主要/ 特点/ ,/ 比如/ PPI/ 网络/ 中/ ,/ 蛋白质/ 相互作用/ 及其/ 微弱/ ./ 为/ 弥补/ 基本/ 随机/ 算法/ 的/ 不足/ ,/ 本文/ 设计/ 了/ Page3/ “/ 条件/ 随机/ 算法/ ”/ ./ 改进/ 后/ 的/ 随机/ 算法/ 能/ 在/ 多项式/ 时间/ 内/ 高精度/ 地/ 求解/ 小/ 概率/ 可/ 达/ 查询/ ./ 2/ 问题/ 定义/ 定义/ 1/ ./ 一个/ 不/ 确定/ 图是/ 集合/ G/ =/ (/ (/ V/ ,/ E/ )/ ,/ Pr/ )/ )/ ,/ 其中/ (/ V/ ,/ E/ )/ 是/ 有/ 向/ 无/ 环图/ ,/ Pr/ :/ E/ →/ (/ 0/ ,/ 1/ ]/ 是/ 定义/ 边/ 集中/ 每条/ 边/ 存在/ 的/ 概率函数/ ./ 从/ 定义/ 1/ 易知/ 确定/ 图是/ 一个/ 特殊/ 的/ 边/ 概率/ 为/ 1/ 的/ 不/ 确定/ 图/ ./ 正如/ 第/ 1/ 节/ 提到/ 的/ ,/ 本文/ 使用/ 可能/ 世界/ 模型/ 来/ 定义/ 不/ 确定/ 图/ ./ 在/ 可能/ 世界/ 模型/ 下/ ,/ 一/ 不/ 确定/ 图可派/ 生出/ 一组/ 确定/ 图/ G/ =/ (/ V/ ,/ E/ )/ ,/ 此/ 确定/ 图/ 称为/ 可能/ 世界/ 图/ ,/ 简称/ 可能/ 图/ ,/ 它/ 满足/ V/ =/ V/ ,/ E/ / E/ ./ 根据/ 文献/ [/ 1/ -/ 4/ ,/ 7/ ]/ 中/ 的/ 规定/ ,/ 本文/ 假设/ 不/ 确定/ 图/ 不同/ 边/ 的/ 概率分布/ 是/ 相互/ 独立/ 的/ ,/ 因此/ 可能/ 图/ 的/ 概率/ 为/ Pr/ (/ G/ )/ =/ ∏/ e/ ∈/ E/ 设/ Imp/ (/ G/ )/ 为/ 不/ 确定/ 图/ G/ 的/ 所有/ 可能/ 图/ 的/ 集合/ ./ 显然/ Imp/ (/ G/ )/ 的/ 大小/ 是/ 2/ |/ E/ |/ ,/ 并且/ 对/ 任何/ 可能/ 图/ G/ 有/ Pr/ (/ G/ )/ >/ 0/ ,/ ∑/ Pr/ (/ G/ )/ =/ 1/ ./ d/ ,/ 概率/ 可/ 达/ 查询/ 返回/ s/ 到/ d/ 的/ 可达/ 概率/ :/ 定义/ 2/ ./ 给/ 一/ 不/ 确定/ 图/ G/ 和/ 其/ 两个/ 顶点/ s/ 和/ 其中/ RA/ (/ G/ ,/ s/ ,/ d/ )/ 是/ s/ 可达/ d/ 的/ 可能/ 图/ 的/ 集合/ ./ 注意/ 到/ s/ 和/ d/ 在/ G/ 中/ 可能/ 不/ 连通/ ,/ 本文/ 采用/ “/ Path/ -/ TreeCover/ ”/ [/ 10/ ]/ 方法/ 首先/ 测试/ s/ 是否/ 可/ 到达/ d/ ./ 如果/ 它们/ 连通/ ,/ 则/ 计算/ 可达性/ 概率/ qpr/ ./ 否则/ ,/ 直接/ 返回/ 不可/ 达/ 信息/ ./ 接下来/ ,/ 本文/ 都/ 假设/ 在/ G/ 中/ s/ 和/ d/ 是/ 连通/ 的/ ./ 在/ 给出/ 具体/ PR/ 查询/ 复杂度/ 前/ ,/ 先/ 给出/ 如下/ 概念/ ./ 定义/ 3/ ./ 给定/ 一个/ 不/ 确定/ 图/ G/ 和/ 其/ 两个/ 顶点/ s/ 和/ d/ ,/ 一个/ s/ -/ d/ 割/ 是/ 一组/ 边/ 的/ 集合/ ,/ 删除/ 该边/ 集/ ,/ s/ 和/ d/ 不再/ 连通/ ./ 如图/ 1/ 所示/ ,/ {/ e1/ ,/ e2/ }/ 是/ 一个/ s/ -/ d/ 割/ ./ 定理/ 1/ ./ 计算/ 不/ 确定/ 图中/ 的/ 可达/ 概率/ 是/ 一个/ 证明/ ./ 假设/ G/ 的/ m/ 条边/ 中/ ,/ 每条/ 边/ 的/ 不/ 存在/ #/ P/ 完全/ 问题/ ./ 概率/ 是/ 1/ -/ p/ 那么/ qpr/ =/ 1/ -/ ∑/ m/ λ/ i/ 是/ 一个/ s/ -/ d/ 割/ 的/ 大小/ ./ 变换/ 上式/ 得/ 下面/ 用/ 反证法/ 证明/ 定理/ ,/ 假设/ 可/ 在/ 多项式/ 时间/ 内/ 计算/ qpr/ ./ 将/ m/ +/ 1/ 个/ 不同/ p/ 值/ 代入/ 方程/ (/ 3/ )/ ,/ 得/ m/ +/ 1/ 个/ 线性方程/ ,/ 其中/ 有/ m/ +/ 1/ 个/ 未知数/ λ/ i/ 和/ m/ +/ 1/ 个/ 已知数/ p/ 和/ qpr/ ./ 该/ 线性方程组/ 的/ 系数/ 矩阵/ 是非/ 奇异/ 的/ ,/ 因此/ 可用/ 高斯消/ 元/ 迭代/ 算法/ 在/ 多项式/ 时间/ 内/ 求解/ 方程组/ ,/ 从而/ 可以/ 在/ 解/ 集中/ 快速/ 找到/ 最小/ s/ -/ d/ 割/ 的/ 基数/ ./ 因此/ ,/ 如果/ 可以/ 多项式/ 时间/ 计算/ qpr/ ,/ 那么/ 可/ 多项式/ 时间/ 得到/ 图/ G/ 最小/ s/ -/ d/ 割/ 的/ 基数/ ./ 但是/ 计算/ 一图/ s/ -/ d/ 最小/ 割/ 的/ 基数/ 是/ 一个/ #/ P/ 完成/ 问题/ [/ 12/ ]/ ,/ 从而/ 推出/ 矛盾/ ./ 3/ 基本/ 随机/ 算法/ 从/ 定理/ 1/ 知/ ,/ 处理/ PR/ 查询/ 是/ #/ P/ 完全/ 问题/ ,/ 这/ 也/ 意味着/ 不/ 存在/ 快速/ 算法/ 计算/ 精确/ 的/ qpr/ ./ 因此/ ,/ 本/ 节/ 给出/ 一/ 简单/ 而/ 有效/ 的/ 抽样/ 方法/ 近似计算/ qpr/ ./ 设/ Xe/ 是/ 一/ 随机变量/ ,/ 以/ 表示/ e/ 存在/ 于/ 不/ 确定/ 图/ G/ 派/ 生出/ 的/ 可能/ 图/ G/ 的/ 事件/ ,/ 如果/ e/ ∈/ G/ ,/ Xe/ =/ 1/ ,/ 否则/ ,/ Xe/ =/ 0/ ./ 令/ m/ =/ |/ E/ |/ ,/ 则/ 随机/ 向量/ 犡/ =/ (/ X1/ ,/ …/ ,/ Xm/ )/ 可/ 表示/ G/ 派/ 生出/ G/ 这一/ 事件/ ,/ 易/ 得出/ X/ 的/ 状态/ 个数/ 为/ 2m/ ./ 定义/ / (/ 犡/ )/ 为/ 根据/ 式/ (/ 2/ )/ ,/ 可得/ qpr/ 的/ 值/ 是/ E/ (/ / (/ 犡/ )/ )/ ,/ 算法/ 1/ 给出/ 近似/ 求解/ E/ (/ / (/ 犡/ )/ )/ 的/ 步骤/ ./ 算法/ 1/ ./ ApproxCompute/ (/ )/ ./ 1/ ./ V/ =/ 0/ ;/ 2/ ./ Repeat/ ;/ 3/ ./ 对/ 每边/ e/ ∈/ E/ ,/ 以/ 概率/ Pr/ (/ e/ )/ 选取/ “/ 1/ ”/ 作为/ Xe/ 的/ 值/ ,/ 或/ 以/ 概率/ 1/ -/ Pr/ (/ e/ )/ 选取/ “/ 0/ ”/ 作为/ Xe/ 的/ 值/ ,/ 这样/ 便/ 可/ 构成/ 向量/ 犡/ =/ (/ X1/ ,/ …/ ,/ Xm/ )/ ;/ 4/ ./ if/ (/ / (/ 犡/ )/ =/ =/ 1/ )/ 5/ ./ V/ =/ V/ +/ 1/ ;/ 6/ ./ UntilNtimes/ ;/ 7/ ./ ReturnV/ // N/ ./ 当/ N/ 的/ 值/ 足够/ 大/ ,/ Chernoff/ -/ Hoeffding/ 界/ 给出/ 引理/ 1/ ./ 对/ 任意/ 的/ δ/ (/ 0/ </ δ/ </ 1/ )/ 和/ τ/ (/ τ/ >/ 0/ )/ ,/ 如果/ N/ / 3ln2/ (/ )/ δ/ τ/ 2/ ,/ 则/ Pr/ |/ V/ // N/ -/ E/ (/ / (/ X/ )/ )/ >/ 近似/ 解/ 的/ 精确/ 保证/ [/ 11/ ]/ ./ τ/ E/ (/ / (/ X/ )/ )/ |/ / δ/ ./ 确度/ ./ 定理/ 2/ 保证/ 随机/ 算法/ 1/ 的/ 近似/ 解有/ 很/ 高/ 的/ 精/ Page44/ 改进/ 的/ 随机/ 算法/ 本节/ 为/ 随机/ 算法/ 引入/ 条件/ 分布/ (/ 称为/ “/ 条件/ 随机/ 算法/ ”/ (/ CRA/ )/ )/ 来/ 改进/ 基本/ 算法/ ./ 改进/ 的/ 随机/ 算法/ 能/ 在/ m/ (/ m/ =/ |/ E/ |/ )/ 多项式/ 时间/ 内/ 完成/ 查询/ ,/ 同时/ 得出/ 高精度/ 的/ 结果/ ./ 本质/ 上/ 说/ ,/ 算法/ 1/ 生成/ 犡/ 1/ ,/ …/ ,/ 犡/ N/ 与/ 犡/ 同/ 分布/ 的/ N/ 个/ 独立/ 随机/ 向量/ ,/ 得到/ 的/ 近似值/ q/ ^/ BC/ 可/ 表示/ 为/ 这/ 一/ 近似/ 结果/ 的/ 质量/ 由/ 100/ (/ 1/ -/ α/ )/ %/ 置信区间/ 所/ 给出/ ①/ :/ 其中/ σ/ ^/ N/ 是/ 基于/ 犡/ 1/ ,/ …/ ,/ 犡/ N/ 对/ Var/ (/ / (/ 犡/ )/ )/ 的/ 估计/ ./ 通常/ 用/ 置信区间/ 的/ 半/ 宽度/ (/ HW/ )/ 来/ 衡量/ 近似/ 结果/ 的/ 质量/ ./ 对于/ 固定/ 的/ α/ ,/ 有/ HW/ =/ z1/ -/ α/ // 2Var/ (/ / (/ 犡/ )/ )/ 如果/ HW/ 很小/ ,/ 则/ 说明/ 估计/ 的/ 质量/ 很/ 高/ ./ 此外/ ,/ 对/ 较/ 小/ 的/ qpr/ ,/ 采用/ 公式/ (/ 4/ )/ 估计/ 出/ 的/ q/ ^/ BC/ 方差/ 会/ 很/ 高/ ,/ 有/ 必要/ 增加/ N/ 来/ 改善/ 估计/ ,/ 会/ 导致/ N/ 的/ 值/ 非常/ 大/ ./ 相反/ 如果/ 控制/ N/ 较/ 小/ ,/ 估计/ 的/ q/ ^/ BC/ 误差/ 就/ 很大/ ./ 对于/ 不/ 确定/ 图/ ,/ 小/ 的/ qpr/ 值/ 可能/ 出现/ 在/ 图/ 中/ 两个/ 顶点/ 距离/ 非常/ 大/ ,/ 或者/ 每条/ 边/ 的/ 概率/ 值/ 非常/ 小/ 的/ 情况/ 下/ ./ 因此/ ,/ 需要/ 降低/ Var/ (/ q/ ^/ BC/ )/ 以/ 改善/ 算法/ 1/ ,/ 以/ 保证/ 对/ 较大/ 和/ 较/ 小/ 的/ qpr/ 都/ 能/ 快速/ 收敛/ ./ 一个/ 有效/ 降低/ Var/ (/ q/ ^/ BC/ )/ 的/ 方法/ 是/ 引入/ 条件/ 分布/ [/ 13/ ]/ ./ 4.1/ 条件/ 随机/ 算法/ 首先/ 介绍/ CRA/ 的/ 基本/ 方法/ [/ 13/ ]/ ./ 设/ C/ =/ C/ (/ 犡/ )/ 是/ 一/ 离散/ 随机/ 函数/ ,/ 取值/ {/ c1/ ,/ …/ ,/ ck/ }/ ./ 又/ 引入/ 因此/ 得/ 这里/ 把/ 集合/ C/ 划分/ 成/ k/ 组/ ,/ 每组/ 对应/ 一个/ θ/ i/ ,/ 其中/ 第/ i/ 组/ 的/ 大小/ 为/ Ni/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ,/ 并且/ N1/ +/ …/ +/ Nk/ =/ N/ ./ 第/ i/ 组中/ 的/ 取值/ 是/ 根据/ 犡/ 的/ C/ =/ ci/ 的/ 条件/ 分布/ 生成/ 的/ ,/ 用来/ 估计/ 条件期望/ θ/ i/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ ./ 设/ {/ 犡/ r/ ,/ i/ :/ r/ =/ 1/ ,/ 2/ ,/ …/ ,/ Ni/ }/ 表示/ 第/ i/ 组/ 的/ 取值/ ,/ 则/ θ/ i/ 被/ 估计/ 为/ 整合/ 此/ k/ 个/ 估计/ ,/ 可得/ qpr/ 的/ CRA/ 估计/ :/ 其中/ ,/ Var/ (/ q/ ^/ CRA/ )/ =/ ∑/ k/ 从式/ (/ 10/ )/ 可/ 看出/ ,/ 条件/ 估计/ 的/ 方差/ 依赖于/ Ni/ ./ 理想/ 情况/ 下/ ,/ 如果/ 条件/ 方差/ 较大/ ,/ 则/ 希望/ Ni/ 也/ 较大/ ,/ 反之亦然/ ./ 因此/ 最佳/ 的/ 分组/ 能/ 保证/ 最小/ 的/ 总/ 方差/ ./ 然而/ ,/ 实际/ 中/ 这/ 是/ 很/ 困难/ 的/ ,/ 因为/ 条件/ 方差/ 是/ 未知/ 的/ ./ 为/ 和/ Var/ (/ q/ ^/ BC/ )/ 进行/ 比较/ ,/ 这里/ 取/ Ni/ ≈/ N/ ·/ Pr/ (/ C/ =/ ci/ )/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ ,/ 那么/ ,/ Var/ (/ q/ ^/ CRA/ )/ ≈/ ∑/ k/ 从式/ (/ 11/ )/ 可/ 看出/ ,/ CRA/ 估计/ 比/ 算法/ 1/ 所得/ 估计/ 有/ 更/ 小/ 的/ 方差/ ./ 这个/ 数量/ 可以/ 解释/ 为/ :/ C/ 包含/ 多少/ 与/ / 相关/ 的/ 信息/ ./ 因此/ 欲/ 选择/ 较/ 好/ 的/ C/ ,/ 应该/ 选取/ 含有/ 尽可能/ 多/ 关于/ / 信息/ 的/ 离散/ 变量/ ./ 但是/ ,/ 在/ 应用/ CRA/ 时/ 还有/ 其它/ 一些/ 重要/ 的/ 方面/ 需要/ 考虑/ [/ 13/ ]/ ./ 首先/ ,/ C/ 必须/ 能/ 在/ 多项式/ 时间/ 内/ 计算/ 出其/ 分布/ ./ 其次/ ,/ C/ 可能/ 取值/ 个数/ (/ 这里/ 指/ k/ )/ 不能/ 超过/ m/ 的/ 多项式/ ./ 最后/ ,/ 需/ 可以/ 对/ X/ 关于/ C/ 的/ 条件/ 分布/ 进行/ 快速/ 抽样/ ./ 在/ 下/ 一/ 小节/ 中/ ,/ 将/ 给出/ 满足/ 上述/ 条件/ 的/ C/ ./ 4.2/ 条件/ 分布/ 的/ 上界/ 和/ 下界/ 基本/ 框架/ 如下/ :/ 本/ 节/ 给出/ 具体/ 应用/ CRA/ 估算/ qpr/ 的/ 算法/ ,/ 它/ 的/ 首先/ 选取/ 式/ (/ 7/ )/ 中/ ,/ C/ (/ 犡/ )/ ·/ ·/ =/ / L/ (/ 犡/ )/ / / (/ 犡/ )/ / / U/ (/ 犡/ )/ 作为/ CRA/ 中/ 的/ 条件/ ./ 使用/ 这些/ 界限/ ,/ 可得/ 由式/ (/ 12/ )/ 给出/ 的/ qpr/ 的/ 估计值/ ,/ 但/ 这里/ 需要/ 产生/ 独立/ 同/ 分布/ 于/ Pr/ (/ / (/ 犡/ )/ |/ C/ (/ 犡/ )/ )/ 的/ N/ 个/ 样本/ ./ 因此/ ,/ 最/ 重要/ 的/ 一步/ 是/ 如何/ 计算/ 条件/ 分布/ Pr/ (/ / (/ 犡/ )/ |/ C/ (/ 犡/ )/ )/ ,/ 设/ S/ 表示/ 该/ 条件/ 分布/ ,/ 式/ (/ 14/ )/ 给出/ S/ 的/ 计算公式/ ./ 本节/ 把/ S/ 的/ 计算/ 转换/ 为/ 计算/ 基于/ 每/ 边/ 随机变量/ Xi/ ,/ 1/ / i/ / |/ E/ |/ 的/ 条件/ 分布/ ,/ 其/ 结果/ 由式/ (/ 15/ )/ 给出/ ./ 选择/ 不/ 确定/ 图/ G/ 的/ 不/ 相交/ 的/ 路径/ 集和割/ 集/ 向量/ 作为/ / (/ 犡/ )/ 的/ 上/ 下界/ ./ 结合/ 这些/ 界/ 的/ 性质/ ,/ 给出/ 基于/ 迭代/ 计算/ 的/ ①/ MartinHaugh/ ./ http/ :/ // // www/ ./ columbia/ ./ edu/ // mh2078/ // Page5/ 策略/ 求解/ Xi/ 的/ 条件/ 分布/ ,/ 式/ (/ 32/ )/ 给出/ 此/ 结果/ ./ 利用/ 这些/ 结果/ ,/ 便/ 可/ 计算/ 条件/ 分布/ S/ ./ 最后/ ,/ 我们/ 可以/ 使用/ 式/ (/ 12/ )/ 来/ 估计/ qpr/ ./ 要/ 应用/ CRA/ ,/ 本文/ 定义/ C/ (/ 犡/ )/ ·/ ·/ =/ / L/ (/ 犡/ )/ / / (/ 犡/ )/ / / U/ (/ 犡/ )/ ,/ 其中/ / L/ 和/ / U/ 是/ 不/ 确定/ 图对/ 向量/ 犡/ 的/ 结构函数/ ./ 如果/ 这/ 两个/ 函数/ 非常/ 逼近/ 于/ / (/ 犡/ )/ ,/ 便/ 可/ 估算/ 一个/ 准确/ 的/ qpr/ ./ 根据/ C/ 的/ 定义/ ,/ C/ 的/ 可能/ 取值/ 是/ {/ (/ / L/ ,/ / U/ )/ }/ =/ {/ (/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ )/ }/ ,/ 又/ 有/ E/ [/ / |/ / L/ =/ / U/ =/ 0/ ]/ =/ 0/ 和/ E/ [/ / |/ / L/ =/ / U/ =/ 1/ ]/ =/ 1/ ./ 因此/ 只/ 需/ 估计/ E/ [/ / |/ / L/ =/ 0/ ,/ / U/ =/ 1/ ]/ ./ 观察/ 到/ ,/ Pr/ (/ C/ =/ (/ 0/ ,/ 1/ )/ )/ =/ Pr/ (/ / L/ =/ 0/ ∩/ / U/ =/ 1/ )/ 其中/ qU/ 和/ qL/ 分别/ 是/ qpr/ =/ E/ [/ / ]/ 的/ 上界/ 和/ 下界/ ./ 类似/ 地可得/ Pr/ (/ C/ =/ (/ 1/ ,/ 1/ )/ )/ =/ Pr/ (/ / L/ =/ 1/ ∩/ / U/ =/ 1/ )/ 将/ 这些/ 结果/ 代入/ 式/ (/ 9/ )/ ,/ 得/ qpr/ 的/ CRA/ 估计/ :/ 其中/ 犡/ 1/ ,/ …/ ,/ 犡/ N/ 是/ 犡/ 对/ (/ / L/ =/ 0/ ,/ / U/ =/ 1/ )/ 的/ 条件/ 分布/ 的/ 样本/ ./ 设/ S/ 表示/ 此/ 条件/ 分布/ ,/ 得/ 估计/ 的/ 方差/ :/ VarS/ (/ q/ ^/ CRA/ )/ =/ 1/ 其中/ ES/ 和/ VarS/ 是/ S/ 分布/ 的/ 期望/ 和/ 方差/ ./ 从/ 上式/ 可/ 看出/ ,/ 当/ qpr/ =/ (/ qU/ +/ qL/ )/ // 2/ 时/ ,/ VarS/ (/ q/ ^/ CRA/ )/ 取/ 最大值/ :/ 从式/ (/ 13/ )/ 易知/ ,/ 当/ qU/ 和/ qL/ 尽可能/ 接近/ 时/ ,/ 可/ 得/ 很小/ 的/ 方差/ ,/ 这/ 也/ 意味着/ 估计/ 的/ 收敛/ 速度/ 更快/ ./ 现在/ 我们/ 对/ 条件/ 分布/ 进行/ 采样/ ./ 首先/ 引进/ 了/ 边/ 状态/ 概率/ Pi/ =/ Pr/ (/ Xi/ =/ 1/ )/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ./ 此时/ 条件/ 分布/ S/ 记为/ Pr/ (/ X1/ =/ x1/ ,/ …/ ,/ Xm/ =/ xm/ |/ / U/ (/ 犡/ )/ -/ / L/ (/ 犡/ )/ =/ 1/ )/ =/ ∏/ mi/ =/ 1/ 这样/ 把/ 对/ S/ 的/ 采样/ 问题/ 转化/ 为/ 对/ 边/ 随机变量/ Xi/ 的/ 条件/ 分布/ 的/ 采样/ ./ 由于/ 边/ 的/ 概率/ 相互/ 独立/ ,/ 式/ (/ 14/ )/ 可/ 写成/ PrXi/ =/ xi/ |/ / U/ (/ 犡/ )/ -/ / L/ (/ 犡/ )/ =/ 1/ ,/ ∩/ i/ -/ 1/ (/ Pr/ / U/ (/ 犡/ )/ -/ / L/ (/ 犡/ )/ =/ 1/ |/ ∩/ i/ (/ =/ Pr/ / U/ (/ 犡/ )/ -/ / L/ (/ 犡/ )/ =/ 1/ |/ ∩/ i/ -/ 1/ (/ PrXi/ =/ xi/ |/ ∩/ i/ -/ 1/ (/ E/ / U/ |/ ∩/ ik/ =/ 1Xk/ =/ x/ (/ =/ E/ / U/ |/ ∩/ i/ -/ 1k/ =/ 1Xk/ =/ x/ (/ =/ qU/ (/ 犡/ i/ ,/ 犘/ )/ -/ qL/ (/ 犡/ i/ ,/ 犘/ )/ qU/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ -/ qL/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ pxii/ (/ 1/ -/ pi/ )/ 1/ -/ xi/ (/ 15/ )/ 其中/ qU/ (/ 犡/ i/ ,/ 犘/ )/ =/ E/ / U/ |/ ∩/ iE/ / L/ |/ ∩/ ik/ =/ 1Xk/ =/ x/ (/ 从式/ (/ 15/ )/ 可见/ ,/ 如果/ / L/ 和/ / U/ 可/ 在/ 多项式/ 时间/ 内/ 完成/ 计算/ ,/ 那么/ 可/ 在/ 多项式/ 时间/ 内/ 完成/ 对/ 条件/ 分布/ S/ 的/ 采样/ ./ 下面/ 提出/ 一种/ 获得/ 此上界/ 和/ 下界/ 函数/ 的/ 方法/ ./ 本文/ 使用/ 不/ 确定/ 图/ G/ 中/ 不/ 相交/ 路径/ 集和割/ 集/ 作为/ / (/ 犡/ )/ 的/ 界限/ ./ 定义/ 4/ ./ 给定/ 一个/ 不/ 确定/ 图/ G/ 和/ 其/ 两/ 顶点/ s/ 和/ d/ ,/ 一条/ s/ -/ d/ 路径/ 是/ 连通/ s/ 和/ d/ 的/ 边集/ ,/ 一个/ s/ -/ d/ 割/ 是/ 一边/ 集/ ,/ 删除/ 这/ 一边/ 集/ ,/ s/ 和/ d/ 不再/ 连通/ ./ 如图/ 1/ 所示/ ,/ {/ e1/ ,/ e4/ }/ 和/ {/ e2/ ,/ e5/ }/ 是/ 两条/ 路径/ ,/ {/ e1/ ,/ e2/ }/ 和/ {/ e4/ ,/ e5/ }/ 是/ 两个/ 割/ ./ 定义/ PS/ 和/ CS/ 分别/ 为/ G/ 的/ 所有/ s/ -/ d/ 路径/ 和/ 割/ 的/ 集合/ ./ 这/ 两个/ 集合/ 可/ 唯一/ 地/ 确定/ G/ ,/ 因此/ 可用/ 来/ 计算/ qpr/ ./ 从/ 概率/ 理论/ ,/ 易得/ 为/ 简化/ 表述/ ,/ 上述/ 公式/ 改写/ 为/ qpr/ =/ E/ ∏/ Path/ ∈/ PS/ ∏/ i/ ∈/ Path/ 其中/ ∏/ i/ 但/ 计算/ 式/ (/ 16/ )/ 是/ 困难/ 的/ ,/ 因为/ 路径/ 集/ 或/ 割/ 集里/ 的/ 元素/ 通常/ 不会/ 两/ 两/ 不/ 相交/ ,/ 并且/ PS/ 和/ CS/ 的/ 大小/ 在/ 最坏/ 的/ 情况/ 下会/ 以/ m/ 的/ 指数/ 级/ 增长/ ./ 设/ PS/ 和/ CS/ 分别/ 是/ PS/ 和/ CS/ 的/ 子集/ ,/ 只/ 由/ 不/ 相交/ 的/ 路径/ 和/ 割/ 组成/ ./ 已有/ 具体/ 算法/ 可以/ 直接/ 产生/ 它们/ ,/ 而/ 不/ 需要/ 产生/ 集合/ PS/ 和/ CS/ ./ 此外/ ,/ PS/ 和/ CS/ 的/ 大小/ 总是/ 小于/ m/ ./ Page6/ 定义/ / L/ (/ 犡/ )/ 和/ / U/ (/ 犡/ )/ 如下/ ,/ / L/ (/ 犡/ )/ =/ ∏/ Path/ ∈/ PS/ ∏/ i/ ∈/ Path/ 由于/ PS/ 和/ ES/ 中/ 的/ 元素/ 不/ 相交/ ,/ 因此/ 元素/ 对应/ 的/ 事件/ 是/ 独立/ 的/ ,/ 为此/ 有/ E/ [/ / L/ (/ 犡/ )/ ]/ / qpr/ =/ E/ [/ / (/ 犡/ )/ ]/ / E/ [/ / U/ (/ 犡/ )/ ]/ ./ 由于/ PS/ 和/ CS/ 分别/ 是/ PS/ 和/ CS/ 的/ 子集/ ,/ 由式/ (/ 16/ )/ 和/ (/ 17/ )/ 可得/ 从/ 上式/ 可见/ ,/ 如果/ PS/ 和/ CS/ 的/ 基数/ 尽可能/ 大/ ,/ 就/ 会/ 得到/ 更紧/ 的/ 界/ ./ 为此/ 本文/ 应用/ 网络/ 流/ 理论/ 中/ 的/ 两个/ 定理/ [/ 14/ ]/ ./ 引理/ 2/ ./ 最大/ 不/ 相交/ s/ -/ d/ 路径/ 数/ 等于/ 最小/ s/ -/ d/ 割/ 的/ 基数/ ./ 引理/ 3/ ./ 最大/ 不/ 相交/ s/ -/ d/ 割数/ 等于/ 最短/ s/ -/ d/ 路径/ 的/ 长度/ ./ 这里/ ,/ 我们/ 使用/ 文献/ [/ 14/ ]/ 中/ 的/ 算法/ 求解/ PS/ 和/ CS/ 基数/ 的/ 最大值/ ,/ 该/ 算法/ 可/ 在/ 多项式/ 时间/ 内/ 完成/ ./ 在/ 图/ 1/ 中/ ,/ PS/ 和/ CS/ 的/ 最大/ 集合/ 分别/ 为/ {/ {/ e1/ ,/ e4/ }/ ,/ {/ e2/ ,/ e5/ }/ }/ 和/ {/ {/ e1/ ,/ e2/ }/ ,/ {/ e4/ ,/ e5/ }/ }/ ./ 因此/ E/ [/ / L/ ]/ =/ 1/ -/ (/ 1/ -/ P1P4/ )/ (/ 1/ -/ P2P5/ )/ =/ 1/ -/ (/ 1/ -/ 0.85/ ×/ 0.8/ )/ (/ 1/ -/ 0.8/ ×/ 0.9/ )/ =/ 0.9104/ ,/ E/ [/ / U/ ]/ =/ 1/ -/ (/ 1/ -/ P1P4/ )/ (/ 1/ -/ P2P5/ )/ =/ 0.9506/ ./ 由于/ PS/ ∈/ PS/ ,/ CS/ ∈/ CS/ ,/ 因此/ 有/ / L/ / / / / U/ ./ 例如/ ,/ 在/ 图/ 1/ 中/ ,/ (/ / L/ =/ 0.9104/ )/ / (/ / =/ 0.9176/ )/ / (/ / U/ =/ 0.9506/ )/ ./ 因此/ ,/ 式/ (/ 15/ )/ 中/ 计算/ 分布/ S/ 所/ 需/ 的/ 条件期望/ 可/ 计算/ 如下/ :/ E/ (/ / L/ |/ ∩/ r/ =/ ∏/ Path/ ∈/ PS/ ∏/ k/ ∈/ Path/ \/ ErE/ (/ / U/ |/ ∩/ r/ =/ ∏/ Cut/ ∈/ [/ CS/ ∏/ k/ ∈/ Cut/ \/ Er/ 其中/ Er/ =/ {/ 1/ ,/ 2/ ,/ …/ ,/ r/ }/ ,/ r/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ./ 对式/ (/ 15/ )/ 所/ 需/ 剩余/ 的/ 计算/ 项/ ,/ 我们/ 构造/ 递推/ 式/ 来/ 计算/ ./ 为此/ 引入/ 如下/ 符号/ ,/ aPath/ (/ Xr/ ,/ P/ )/ =/ ∏/ k/ ∈/ Path/ \/ Er/ 烄/ 烅/ bCut/ (/ Xr/ ,/ P/ )/ =/ ∏/ k/ ∈/ Cut/ \/ Er/ 烆/ 使用/ 上述/ 符号/ ,/ 可/ 重写/ qL/ (/ 犡/ r/ ,/ 犘/ )/ 和/ qU/ (/ 犡/ r/ ,/ 犘/ )/ 为/ 之后/ ,/ 假设/ qL/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ 和/ qU/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ 已算/ 好/ ,/ 并且/ 要/ 计算/ qL/ (/ 犡/ i/ ,/ 犘/ )/ 和/ qU/ (/ 犡/ i/ ,/ 犘/ )/ ./ 由于/ PS/ 中/ 的/ 元素/ 不/ 相交/ ,/ 最/ 多/ 存在/ 一个/ 路径/ path/ / ∈/ PS/ ,/ 使得/ i/ ∈/ path/ / ./ 同样/ 最/ 多/ 存在/ 一个/ 割/ cut/ / ∈/ CS/ ,/ 使得/ i/ ∈/ cut/ / ./ 此时/ 由式/ (/ 14/ )/ 可得/ aPath/ / (/ 犡/ i/ ,/ 犘/ )/ =/ xi/ 烄/ 烅/ bCut/ / (/ 犡/ i/ ,/ 犘/ )/ =/ 1/ -/ 1/ -/ xi1/ -/ pi1/ -/ bCut/ / (/ 犡/ i/ -/ 1/ ,/ 犘/ 烆/ 对/ 从/ i/ -/ 1/ 到/ i/ 没起/ 作用/ 的/ 路径/ 和/ 割/ 有/ 将/ 式/ (/ 20/ )/ 和/ (/ 21/ )/ 代入/ 式/ (/ 19/ )/ ,/ 得/ 最终/ 结果/ :/ qL/ (/ 犡/ i/ ,/ 犘/ )/ =/ 1/ -/ 1/ -/ aPath/ ×/ (/ 犡/ i/ ,/ 犘/ )/ qU/ (/ 犡/ i/ ,/ 犘/ )/ =/ bCut/ ×/ (/ 犡/ i/ ,/ 犘/ )/ 当/ qU/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ 和/ qL/ (/ 犡/ i/ -/ 1/ ,/ 犘/ )/ 已知/ 时/ ,/ 用式/ (/ 22/ )/ 可以/ 在/ 常数/ 时间/ 内/ 计算/ qU/ (/ 犡/ i/ ,/ 犘/ )/ 和/ qL/ (/ 犡/ i/ ,/ 犘/ )/ ./ 然后/ 将/ qU/ (/ 犡/ i/ ,/ 犘/ )/ 和/ qL/ (/ 犡/ i/ ,/ 犘/ )/ 的/ 结果/ 代入/ 式/ (/ 15/ )/ ,/ 其/ 结果/ 再/ 输入/ 式/ (/ 14/ )/ ,/ 最后/ 可用/ 式/ (/ 14/ )/ 求解/ 条件/ 分布/ S/ ./ 这个/ 过程/ 可/ 在/ O/ (/ m/ )/ 时间/ 完成/ 计算/ ./ 因此/ ,/ 一个/ 采样/ 过程/ (/ 用式/ (/ 12/ )/ 产生/ 的/ 一个/ 犡/ i/ )/ 可/ 在/ O/ (/ m/ )/ 时间/ 内/ 完成/ ./ 有/ 了/ 这些/ 结果/ ,/ 便/ 可由式/ (/ 12/ )/ 来/ 估计/ qpr/ ./ 采样/ 的/ 次数/ N/ 仍/ 采用/ 定理/ 2/ 给出/ 的/ 值/ 以/ 保证/ 结果/ 的/ 准确性/ ./ 5/ 性能/ 分析/ 本节/ 用/ 真实/ 和/ 合成/ 的/ 不/ 确定/ 图/ 数据/ 验证/ 本文/ 的/ 算法/ ,/ 算法/ 代码/ 用/ Visual/ C++/ 6.0/ 编写/ ,/ 运行/ 环境/ 是/ 奔腾/ 43.0/ GHzCPU/ ,/ 2G/ 内存/ 和/ 160G/ 硬盘/ ./ 对/ 本文/ 给出/ 的/ 算法/ ,/ R/ -/ BC/ 表示/ 基本/ 随机/ 算法/ ,/ R/ -/ CRA/ 表示/ “/ 条件/ 随机/ 算法/ ”/ ./ 真实/ 不/ 确定/ 数据/ 采用/ Entrezgene6091/ -/ OMIM127700/ 数据库/ ①/ ./ 它/ 是/ 描述/ 人类基因/ 网络/ 的/ 数据库/ ,/ 其中/ 网络/ 节点/ 代表/ “/ 显性/ 基因/ ”/ ,/ 边/ 被/ 赋予/ 小数/ 权值/ 以/ 表示/ 基因/ 相互作用/ 的/ 大小/ ./ 使用/ 该/ 数据库/ 的/ 5/ 个/ 基因/ 网络/ 作为/ 不/ 确定/ 图/ 数据/ ,/ 表/ 2/ 给出/ 它们/ 的/ 参数/ ./ ①/ http/ :/ // // www/ ./ ncbi/ ./ nlm/ ./ nih/ ./ gov/ // omimPage7/ 图/ 数据/ 编号/ 节点/ 数量/ 边集/ 大小/ 边/ 的/ 平均/ 概率/ Dys145211130/ ./ 423Dys2177541630/ ./ 396Dys3325987900/ ./ 212Dys46786140560/ ./ 237Dys511368327540/ ./ 311/ 同时/ 从/ Citeseer/ ①/ 中/ 抽取/ 图/ 数据/ (/ |/ V/ |/ =/ 12140/ ,/ |/ E/ |/ =/ 36874/ )/ ,/ 并/ 按/ 正态分布/ N/ (/ 0.7/ ,/ 0.2/ )/ 为/ 每边/ 产生/ 概率/ ./ 每次/ 实验/ 时/ ,/ 随机/ 地/ 产生/ 100/ 个/ 查询/ ,/ 记录/ 下/ 查询/ 的/ 平均/ 代价/ ./ 作为/ 比较/ ,/ 本文/ 也/ 实现/ 了/ 第/ 1/ 节/ 给出/ 的/ Naive/ 算法/ ,/ 因为/ 目前/ 还/ 没有/ 对此/ 查询/ 的/ 工作/ ./ 正如/ 前/ 文/ 所述/ ,/ R/ -/ BC/ 和/ R/ -/ CRA/ 的/ 模拟/ 次数/ 都/ 采用/ 引理/ 1/ 给出/ 的/ 理论值/ ,/ 该/ 理论值/ 是/ 由/ τ/ 和/ δ/ 来/ 控制/ 的/ ./ 这/ 两个/ 参数/ 是/ 需要/ 输入/ 的/ ,/ 为/ 取得/ 对/ 实际/ 图/ 2/ 取/ 不同/ δ/ 时/ ,/ 采样/ 算法/ 的/ 查询/ 质量/ 其次/ 用/ 真实/ 数据测试/ 算法/ 的/ 运行/ 效率/ 和/ 可扩展性/ ./ 图/ 3/ 给出/ 测试/ 结果/ ,/ 其中/ 横坐标/ 是/ Dys1/ ~/ Dys5/ ,/ 纵坐标/ 是/ 运行/ 时间/ ./ 如图所示/ ,/ 所有/ 曲线/ 都/ 随图/ 规模/ 的/ 增加/ 而/ 增长/ ./ 其中/ Nave/ 增长/ 的/ 最快/ ,/ 到/ Dys2/ 时/ 就/ 已经/ 超过/ 100s/ ,/ Nave/ 要/ 枚举/ 所有/ 可能/ 图/ ,/ 从而/ 导致/ 其/ 时间/ 的/ 指数/ 级/ 增长/ ./ 而/ R/ -/ CRA/ 和/ R/ -/ BC/ 都/ 具有/ 较/ 好/ 的/ 可扩展性/ ,/ 即使/ 对边/ 数量/ 超过/ 3/ 万/ 的/ 图/ Dys5/ 求解/ NP/ 难/ 查询/ ,/ 它们/ 的/ 运行/ 效率/ 也/ 是/ 高效/ 的/ ,/ 可/ 在/ 1min/ 内/ 完成/ ./ 从/ 结果/ 中/ 也/ 可/ 发现/ ,/ 尽管/ 采用/ 相同/ 的/ 模拟/ 次数/ ,/ R/ -/ CRA/ 比/ R/ -/ BC/ 花费/ 略/ 多/ 的/ 时间/ ,/ 因为/ R/ -/ CRA/ 还/ 需要/ 计算/ 图/ 的/ 路径/ 集和割/ 集/ ./ 应用/ 的/ 最佳/ 参数值/ ,/ 首先/ 通过/ 实验/ 确定/ 它们/ 的/ 取值/ ./ 固定/ τ/ =/ 0.1/ ,/ 改变/ δ/ 的/ 取值/ ,/ 用/ 模拟/ 值/ 和/ 真实/ 值/ qpr/ 的/ 比来/ 衡量/ 不同/ δ/ 取值/ 下/ 的/ 查询/ 质量/ ./ 因为/ R/ -/ CRA/ 有/ 更好/ 的/ 查询/ 质量/ ,/ 这里/ 用/ R/ -/ CRA/ 来/ 测试/ ./ 这里/ 通过/ 测试/ 真实/ 数据/ 和/ 合成/ 数据/ 给出/ 结果/ ./ Dys2/ 是/ 小规模/ 真实/ 数据/ ,/ Citeseer/ 是/ 大规模/ 的/ 合成/ 数据/ ,/ 故/ 选取/ 它们/ 更/ 符合实际/ 的/ 应用/ ./ 图/ 2/ 给出/ 对/ 数据/ Dys2/ 和/ Citeseer/ 的/ 测试/ 结果/ ./ 从/ 结果/ 看出/ ,/ 查询/ 质量/ 随着/ δ/ 的/ 减小/ 而/ 增加/ ./ 当/ δ/ 减少/ 到/ 0.3/ 以后/ ,/ 曲线/ 的/ 增长/ 变得/ 非常/ 平缓/ ,/ 其中/ 两组/ 数据/ 的/ 查询/ 质量/ 都/ 超过/ 95/ %/ ./ 当/ δ/ =/ 0.3/ 时/ ,/ 由/ 定理/ 2/ 得/ N/ =/ 570/ ,/ 这是/ 一个/ 合理/ 的/ 模拟/ 次数/ ./ 而/ 对/ 更/ 小/ 的/ δ/ ,/ 例如/ δ/ =/ 0.05/ 时/ ,/ N/ =/ 1107/ ,/ 这/ 需要/ 相当/ 长/ 的/ 时间/ ,/ 而/ 查询/ 质量/ 只/ 比/ δ/ =/ 0.3/ 时略/ 高些/ ./ 因此/ 这里/ 取/ (/ τ/ ,/ δ/ )/ =/ (/ 0.1/ ,/ 0.3/ )/ ./ 最后/ 测试/ R/ -/ BC/ 和/ R/ -/ CRA/ 的/ 查询/ 质量/ ./ 正如/ 第/ 4/ 节/ 所述/ ,/ 在/ 运行/ 效率/ 相同/ 时/ ,/ R/ -/ CRA/ 有/ 更/ 高/ 的/ 查询/ 质量/ ,/ 尤其/ 对/ 较/ 小/ 的/ qpr/ ./ 因为/ 真实/ 数据/ 的/ 各/ 参数/ 已/ 固定/ ,/ 这里/ 用/ 合成/ 数据/ 来/ 检验/ ,/ 查询/ 质量/ 仍/ 被/ 定义/ 为/ 模拟/ 值/ 与/ 真实/ 值/ 之/ 比/ ./ 为/ 模拟/ 小/ qpr/ ,/ 改变/ 正态分布/ 的/ μ/ 从/ 0.8/ ~/ 0.05/ ,/ 例如/ 当/ μ/ 取/ 0.05/ 时/ ,/ qpr/ 的/ 数量级/ 是/ 10/ -/ 6/ ./ 图/ 4/ 给出/ 测试/ 结果/ ,/ 结果表明/ 即使/ qpr/ 小至/ 10/ -/ 6/ 时/ ,/ R/ -/ CRA/ 的/ 查询/ 质量/ 也/ 高于/ 90/ %/ ./ 而/ 在/ μ/ 取/ 0.4/ 和/ 0.8/ 时/ ,/ 质量/ 都/ 在/ 98/ %/ 以上/ ,/ 而/ 此种/ 情况/ 更/ 符合/ 真实/ 的/ 应用/ [/ 3/ -/ 5/ ]/ ./ 相反/ 随着/ μ/ 的/ 减少/ ,/ R/ -/ BC/ 的/ ①/ http/ :/ // // citeseer/ ./ ist/ ./ psu/ ./ edu/ // oai/ ./ htmlPage8/ 质量/ 急速/ 下滑/ ,/ 最/ 小时/ 已跌/ 至/ 50/ %/ ./ 但/ 在/ μ/ 大于/ 0.4/ 时/ ,/ R/ -/ BC/ 的/ 查询/ 质量/ 也/ 高于/ 90/ %/ ,/ 这/ 说明/ 在/ 实际/ 应用/ 中/ ,/ R/ -/ BC/ 也/ 有/ 较/ 可观/ 的/ 准确率/ ./ 图/ 5/ 给出/ 在/ 不同/ 方差/ σ/ 下/ 查询/ 的/ 质量/ ./ 从图/ 中/ 可见/ ,/ R/ -/ CRA/ 的/ 曲线/ 比/ R/ -/ BC/ 稳定/ 得/ 多/ ,/ 这/ 说明/ R/ -/ CRA/ 能/ 较/ 好/ 地/ 适应/ 数据/ 噪声/ 动态变化/ 的/ 环境/ ./ 6/ 相关/ 工作/ 已有/ 很多/ 面向/ 确定/ 图/ 的/ 可达/ 查询/ 工作/ ./ 文献/ [/ 15/ ]/ 用图/ 的/ 传递/ 闭包来/ 压缩/ 原始/ 图/ ,/ 并/ 在/ 求解/ 过程/ 中/ 把/ 问题/ 转化/ 为/ 网络/ 流/ 问题/ ./ 文献/ [/ 16/ ]/ 把/ 图/ 分成/ 若干/ 有/ 向/ 链/ ,/ 并/ 每个/ 顶点/ 都/ 记录/ 了/ 与其/ 相邻/ 的/ 链/ ,/ 从而/ 可/ 常数/ 时间/ 求解/ 查询/ ./ 文献/ [/ 17/ ]/ 首先/ 提出/ 树/ 覆盖/ 的/ 方法/ ,/ 并/ 以树为/ 单元/ 对图/ 进行/ 压缩/ ,/ 并/ 证明/ 此种/ 压缩/ 是/ 保证/ 可以/ 求解/ 查询/ 的/ 最优/ 压缩/ ./ 文献/ [/ 18/ ]/ 和/ 文献/ [/ 19/ ]/ 都/ 是/ 在/ 索引/ 构建/ 时间/ 上/ 改进/ 了/ 树/ 覆盖/ 方法/ ./ 文献/ [/ 10/ ]/ 拓展/ 了/ 有/ 向/ 链/ 的/ 方法/ ,/ 把/ 问题/ 转换成/ 平面图/ 的/ 问题/ ,/ 并/ 只/ 需/ 2/ 跳/ 即可/ 完成/ 查询/ ./ 面向/ 概率/ 数据库/ 的/ 研究/ 是/ 现在/ 的/ 热点/ ./ 早期/ 工作/ 的/ 重点/ 是/ 在/ 概率/ 关系数据库/ 上/ 如/ 文献/ [/ 8/ -/ 9/ ,/ 20/ ]/ ,/ 即/ 处理/ 概率/ SQL/ 查询/ ./ 之后/ 研究者/ 提出/ 了/ 一些/ 查询/ 类型/ 及其/ 处理/ 方法/ ,/ 主要/ 包括/ Top/ -/ k/ 查询/ [/ 21/ ]/ 和/ Skyline/ 查询/ 等/ [/ 22/ ]/ ./ 近年来/ 开始/ 关注/ 结构化/ 数据/ 如/ 概率/ XML/ 数据/ [/ 1/ ,/ 2/ ]/ ./ 就/ 图/ 数据库/ 而言/ ,/ 邹兆年/ 等/ 人/ [/ 23/ ]/ 研究/ 了/ 不/ 确定/ 图/ 的/ 频繁/ 子图/ 挖掘/ ,/ 而/ 张硕/ 等/ 人/ [/ 24/ ]/ 研究/ 了/ 带/ 索引/ 的/ 不/ 确定/ 图/ Top/ -/ k/ 查询/ ./ 7/ 结束语/ 本文/ 所述/ 是/ 第一个/ 面向/ 不/ 确定/ 图/ 研究/ 可/ 达/ 查询/ 的/ 工作/ ./ 采用/ 细粒度/ 的/ 可能/ 世界/ 模型/ 定义/ 不/ 确定/ 图/ ,/ 从而/ 使/ 可达/ 查询/ 具有/ 丰富/ 的/ 概率/ 语义/ ./ 在/ 给出/ 问题/ 是/ #/ P/ 难后/ ,/ 本文/ 首先/ 设计/ 了/ 一个/ 基本/ 随机/ 算法/ 求解/ 查询/ ./ 在/ 理论/ 分析/ 了/ 它/ 的/ 不足/ 后/ ,/ 采用/ “/ 条件/ 随机/ 算法/ ”/ 改进/ 基本/ 算法/ ./ 其中/ 选择/ 不/ 确定/ 图/ 的/ 不/ 相交/ 路径/ 集和割/ 集/ 作为/ 可/ 达/ 概率/ 的/ 下界/ 和/ 上界/ 去/ 逼近/ 真实/ 概率/ ,/ 计算/ 基于/ 该界/ 的/ 条件/ 分布/ 可/ 在/ 多项式/ 时间/ 内/ 完成/ ,/ 因此/ 可/ 多项式/ 时间/ 计算/ 真实/ 概率/ ./ 此外/ 基本/ 和/ 改进/ 的/ 随机/ 算法/ 都/ 保证/ 了/ 高质量/ 的/ 估计/ 结果/ ./ 实验/ 结果/ 验证/ 了/ 本文/ 的/ 设计/ ./ 今后/ 将/ 研究/ 基于/ 不/ 确定/ 图/ 的/ 多种/ 查询/ ./ 

