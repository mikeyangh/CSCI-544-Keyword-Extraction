Page1/ 色调/ 保持/ 的/ 自/ 适应/ 图像/ 视频/ 细节/ 增强/ 算法/ 凌云/ 1/ )/ 严彩萍/ 2/ )/ 刘春晓/ 1/ )/ 李红/ 2/ )/ 王勋/ 1/ )/ 1/ )/ (/ 浙江/ 工商大学/ 计算机/ 与/ 信息/ 工程学院/ 杭州/ 310018/ )/ 2/ )/ (/ 澳门大学/ 科技/ 学院/ 澳门/ )/ 摘要/ 针对/ 已有/ 方法/ 难以/ 保持/ 输入/ 图像/ 的/ 色调/ 分布/ 且/ 过于/ 经验/ 化/ 的/ 问题/ ,/ 文中/ 提出/ 了/ 一种/ 色调/ 保持/ 的/ 自/ 适应/ 图像/ 与/ 视频/ 细节/ 增强/ 方法/ ./ 首先/ ,/ 采用/ 保持/ 边缘/ 的/ 多/ 尺度/ 图像/ 分解/ 算法/ ,/ 快速/ 地/ 将/ 输入/ 帧/ 分解成/ 含有/ 大/ 尺度/ 边缘/ 信息/ 的/ 基/ 图像/ 和/ 含有/ 小/ 尺度/ 细节/ 信息/ 的/ 细节/ 层/ ./ 然后/ ,/ 在/ 细节/ 增强/ 与/ 合成/ 过程/ 中/ ,/ 根据/ 边缘/ 梯度/ 响应/ 构造/ 一个/ 自/ 适应/ 的/ 细节/ 增强/ 函数/ ,/ 减少/ 对强/ 边缘/ 的/ 放大/ 倍数/ ,/ 提升/ 对/ 小/ 细节/ 的/ 增强/ 幅度/ ./ 最后/ ,/ 在/ 保持/ 输入/ 帧/ 的/ 颜色/ 值/ 和/ 增强/ 图像/ 的/ 梯度/ 值/ 的/ 期望/ 下/ ,/ 基于/ 能量/ 优化/ 的/ 色调/ 校正/ 算法/ 避免/ 细节/ 增强/ 图像/ 与/ 输入/ 帧/ 之间/ 的/ 显著/ 色调/ 差异/ ./ 实验/ 结果表明/ :/ 对/ 任意/ 的/ 输入/ 图像/ 和/ 视频/ ,/ 通过/ 统一/ 的/ 参数设置/ ,/ 均/ 可/ 获得/ 色调/ 保持/ 的/ 良好/ 细节/ 增强/ 效果/ ./ 关键词/ 细节/ 增强/ ;/ 多/ 尺度/ 分解/ ;/ 自/ 适应/ 策略/ ;/ 色调/ 校正/ 1/ 引言/ 在/ 图像/ 与/ 视频/ 的/ 获取/ 过程/ 中/ ,/ 由于/ 照明/ 强度/ 、/ 采集/ 设备/ 、/ 噪声/ 干扰/ 等/ 因素/ 的/ 影响/ ,/ 导致/ 图像/ 与/ 视频/ 视觉效果/ 的/ 下降/ ./ 为了/ 突出/ 图像/ 与/ 视频/ 中/ 的/ 细节/ 信息/ 以便/ 于/ 用户/ 分辨/ 和/ 后续/ 处理/ ,/ 需要/ 采用/ 图像/ 细节/ 增强/ 算法/ ,/ 它/ 是/ 图像增强/ 领域/ 的/ 重要/ 研究/ 内容/ 之一/ ./ 图像/ 细节/ 增强/ 算法/ 的/ 一般/ 处理过程/ 是/ 首先/ 将/ 图像/ 分解成/ 一个/ 反映/ 低频/ 信息/ 的/ 基/ 图像/ 和/ 一个/ 或/ 多个/ 反映/ 多/ 尺度/ 高频/ 信息/ 的/ 细节/ 层/ ,/ 然后/ 对/ 每个/ 细节/ 层/ 进行/ 放大/ 操作/ 获得/ 增强/ 的/ 细节/ 层/ ,/ 最后/ 将基/ 图像/ 和/ 增强/ 的/ 细节/ 层/ 合成/ 起来/ ,/ 即/ 最后/ 的/ 图像/ 细节/ 增强/ 结果/ ./ 近年来/ ,/ 为数不多/ 的/ 人/ 提出/ 了/ 一些/ 关于/ 细节/ 增强/ 方面/ 的/ 算法/ ./ 对于/ 多幅/ 不同/ 光照/ 条件/ 下/ 的/ 输入/ 图像/ ,/ Fattal/ 等/ 人/ [/ 1/ ]/ 采用/ 快速/ 双边/ 滤波/ 进行/ 多/ 尺度/ 分解/ ,/ 并且/ 采用/ 多/ 尺度/ 重组/ 细节/ 构造/ 增强/ 图像/ ./ 但是/ ,/ 双边/ 滤波/ 本质/ 上/ 是/ 在/ 它/ 的/ 保留/ 边缘/ 程度/ 和/ 平滑/ 程度/ 上/ 做/ 一个/ 权衡/ ./ 如果/ 增强/ 提取/ 细节/ 的/ 程度/ ,/ 也/ 就/ 意味着/ 平滑/ 图像/ 中/ 更/ 多/ 的/ 边缘/ 被/ 滤掉/ ./ 那么/ 在/ 细节/ 增强/ 过程/ 中/ ,/ 残留/ 在/ 细节/ 层中/ 的/ 大/ 尺度/ 边缘/ 将会/ 导致/ 过于/ 增强/ ,/ 并/ 最终/ 引起/ 梯度/ 逆转/ 现象/ 和/ 光环/ 现象/ ./ Zheng/ 等/ 人/ [/ 2/ ]/ 则/ 通过/ 求解/ 一个/ 梯度/ 域/ 最优化/ 问题/ 来/ 得到/ 一张/ 细节/ 辅助/ 图/ ,/ 并/ 最终/ 通过/ 二次/ 滤波/ 得到/ 细节/ 层/ 和/ 基础/ 层/ ./ 但是/ ,/ 他们/ 的/ 方法/ 都/ 是/ 基于/ 多幅/ 输入/ 图像/ ,/ 无疑/ 限制/ 了/ 这些/ 方法/ 的/ 使用/ ./ 对于/ 单幅/ 输入/ 图像/ ,/ Farbman/ 等/ 人/ [/ 3/ ]/ 展示/ 了/ 基于/ 加权/ 最小/ 二乘/ ,/ 即/ 非线性/ 泊松/ 方程/ 进行/ 图像/ 细节/ 增强/ 的/ 效果/ ,/ 但是/ 该/ 方法/ 需要/ 求解/ 一个/ 大型/ 稀疏/ 线性系统/ ,/ 因此/ 削弱/ 了/ 它/ 的/ 使用/ 价值/ ./ Fattal/ [/ 4/ ]/ 提出/ 了/ 基于/ 避免/ 边缘/ 的/ 提升/ 小/ 波/ 分解/ 进行/ 图像/ 细节/ 增强/ 的/ 方法/ ./ 这种/ 多/ 尺度/ 分解/ 方法/ 虽然/ 速度/ 比较/ 快/ ,/ 但是/ 它/ 的/ 模糊/ 核/ 大小/ 只能/ 取/ 2/ 的/ 指数/ 级/ ,/ 从而/ 限制/ 了/ 滤波/ 尺度/ 的/ 选取/ ./ Subr/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 新/ 的/ 细节/ 定义/ ,/ 认为/ 图像/ 的/ 细节/ 是/ 局部/ 极小值/ 与/ 局部/ 极大值/ 之间/ 的/ 震动/ ,/ 并且/ 基于/ 这种/ 新/ 的/ 定义/ 方式/ ,/ 提出/ 了/ 新/ 的/ 图像/ 分解/ 技术/ ./ Xu/ 等/ 人/ [/ 6/ ]/ 提出/ 了/ 一种/ 基于/ L0/ 梯度/ 最小化/ 的/ 最优化/ 框架/ ,/ 来/ 控制/ 全局/ 非零/ 梯度/ 的/ 数量/ ,/ 从而/ 达到/ 平滑/ 图像/ 的/ 目的/ ./ Paris/ 等/ 人/ [/ 7/ ]/ 则/ 提出/ 了/ 利用/ 拉普拉斯/ 金字塔/ 进行/ 图像/ 的/ 多/ 尺度/ 分解/ ./ 而/ Gastal/ 等/ 人/ [/ 8/ ]/ 提出/ 了/ 一种/ 基于/ 域/ 变换/ 的/ 彩色图像/ 细节/ 增强/ 方法/ ,/ 期望/ 达到/ 快速/ 多/ 尺度/ 分解/ 的/ 目的/ ./ 但是/ ,/ 总的来说/ ,/ 这些/ 方法/ 对于/ 细节/ 增强/ 都/ 无法/ 做到/ 自/ 适应/ ./ 即/ 对于/ 不同/ 的/ 输入/ 图像/ ,/ 需要/ 设置/ 不同/ 的/ 参数/ 达到/ 好/ 的/ 细节/ 增强/ 的/ 效果/ ,/ 有/ 的/ 甚至/ 需要/ 采取/ 不同/ 的/ 细节/ 增强/ 方法/ ./ 而/ 对于/ 这些/ 参数/ 的/ 设置/ 或者/ 细节/ 层/ 的/ 增强/ 方法/ 都/ 没有/ 提出/ 依据/ ,/ 只能/ 采取/ 测试/ 的/ 方式/ 期望/ 达到/ 好/ 的/ 效果/ ./ 所以/ ,/ 这些/ 算法/ 都/ 过于/ 经验/ 化/ ,/ 对于/ 大部分/ 的/ 普通/ 人群/ 都/ 不/ 适用/ ./ 而且/ ,/ 目前/ 还/ 没有/ 人/ 提出/ 任何/ 适用/ 于/ 视频/ 的/ 细节/ 增强/ 算法/ ./ 对比/ 这些/ 技术/ ,/ 本文/ 同样/ 采用/ 保留/ 边缘/ 的/ 滤波/ 方法/ 进行/ 图像/ 与/ 视频/ 帧/ 的/ 多/ 尺度/ 分解/ ,/ 但是/ 本文/ 提出/ 了/ 色调/ 保持/ 的/ 、/ 自/ 适应/ 的/ 图像/ 与/ 视频/ 细节/ 增强/ 方法/ ./ 本文/ 根据/ 边缘/ 梯度/ 响应/ 构造/ 了/ 一个/ 自/ 适应/ 的/ 细节/ 增强/ 函数/ ,/ 该/ 函数/ 在/ 增强/ 细节/ 的/ 同时/ ,/ 抑制/ 细节/ 层中/ 残留/ 的/ 大/ 尺度/ 边缘/ ./ 同时/ ,/ 本文/ 提出/ 了/ 一个/ 基于/ 能量/ 优化/ 的/ 色调/ 校正/ 算法/ ,/ 从而/ 保证/ 我们/ 的/ 细节/ 增强/ 结果/ 既/ 能/ 保持/ 输入/ 帧/ 的/ 颜色/ 分布/ ,/ 又/ 能/ 保持/ 细节/ 增强/ 的/ 效果/ ./ 本文/ 的/ 主要/ 贡献/ 有/ 如下/ 几点/ :/ (/ 1/ )/ 本文/ 对于/ 采用/ 哪种/ 多/ 尺度/ 分解/ 技术/ 没有/ 严格/ 的/ 要求/ ,/ 即/ 任意/ 一种/ 保留/ 边缘/ 的/ 多/ 尺度/ 分解/ 技术/ 都/ 可以/ 得到/ 好/ 的/ 细节/ 增强/ 效果/ ;/ (/ 2/ )/ 我们/ 提出/ 了/ 一个/ 统一/ 的/ 细节/ 增强/ 函数/ ,/ 该/ 函数/ 对/ 所有/ 图像/ 与/ 视频/ 都/ 可以/ 达到/ 一个/ 很/ 好/ 的/ 放大/ 细节/ 的/ 效果/ ,/ 同时/ 还/ 有效/ 的/ 抑制/ 了/ 大/ 尺度/ 边缘/ 的/ 增强/ ;/ (/ 3/ )/ 通过/ 最小化/ 能量/ 函数/ 的/ 求解/ ,/ 使/ 我们/ 的/ 最终/ 结果/ 既/ 保持/ 了/ 输入/ 帧/ 的/ 色调/ 分布/ ,/ 又/ 拥有/ 了/ 很/ 好/ 的/ 细节/ 增强/ 效果/ ;/ (/ 4/ )/ 我们/ 的/ 细节/ 增强/ 系统/ 可/ 统一/ 处理/ 所有/ 的/ 图像/ 和/ 视频/ ,/ 无需/ 针对/ 每/ 一幅/ 图像/ 进行/ 单独/ 的/ 参数/ 调整/ ,/ 统一/ 的/ 参数/ 就/ 可以/ 得到/ 很/ 好/ 的/ 细节/ 增强/ 效果/ ./ 2/ 色调/ 保持/ 的/ 自/ 适应/ 细节/ 增强/ 算法/ 彩色图像/ 由/ RGB/ 三/ 基色/ 组成/ ,/ 这/ 3/ 种/ 基色/ 存在/ 很大/ 的/ 相关性/ ,/ 单独/ 对/ 其/ 进行/ 滤波/ 操作/ 一般/ 都/ 会/ 影响/ 彩色图像/ 的/ 色彩/ 相关性/ ,/ 所/ 导致/ 的/ 直接/ 后果/ 就是/ 出现/ 色彩/ 失真/ ,/ 图像/ 的/ 视觉效果/ 极/ 不/ 自然/ ./ 因此/ ,/ 一种/ 有效/ 的/ 彩色图像/ 细节/ 增强/ 算法/ 除了/ 增强/ 图像/ 细节/ 之外/ 还/ 必须/ 使得/ 处理/ 后/ 的/ 图像/ 更加/ 生动/ ,/ 色彩鲜艳/ 且/ 不会/ 带来/ 失真/ ./ 所以/ 处理/ 彩色图像/ 必须/ 选择/ 合适/ 的/ 颜色/ 空间/ ,/ 以及/ 谨慎/ 处理/ 颜色/ 分量/ 之间/ 的/ 关系/ ,/ 在/ 此基础/ 之上/ ,/ 再/ 考虑/ 细节/ 增强/ 的/ 特定/ 要求/ ./ 因此/ ,/ 本文/ 所有/ 的/ 操作/ 都/ 选择/ 在/ Lab/ 空间/ 的/ 亮度/ 通道/ 上/ 进行/ ./ 对于/ 任意/ 的/ 输入/ 图像/ 与/ 视频/ ,/ 本文/ 的/ 细节/ 增强/ 算法/ 主要/ 包括/ 以下/ 步骤/ :/ 首先/ ,/ 采用/ 基于/ 双边/ 滤波/ 的/ 多/ 尺度/ 分解/ 方法/ 将/ 图像/ 分解成/ 含有/ 大/ 尺度/ 边缘/ 信息/ 的/ 基/ 图像/ 和/ 多幅/ 含有/ 小/ 尺度/ 细节/ 信息/ 的/ 细节/ 层/ ./ 然后/ ,/ 根据/ 我们/ 构造/ 的/ 自/ 适应/ 细节/ 增强/ 函数/ 来/ 得到/ 细节/ 增强/ 后/ 的/ 图像/ ./ 最后/ ,/ 在/ 保持/ 输入/ 图像/ 的/ 颜色/ 值/ 和/ Page3/ 增强/ 图像/ 的/ 梯度/ 值/ 的/ 期望/ 下/ ,/ 我们/ 采用/ 基于/ 能量/ 优化/ 的/ 色调/ 校正/ 算法/ 得到/ 色调/ 保持/ 的/ 细节/ 增强/ 结果/ ./ 图/ 1/ 算法/ 流程图/ 2.1/ 基于/ 双边/ 滤波/ 的/ 多/ 尺度/ 图像/ 分解/ 所谓/ 多/ 尺度/ 分解/ 就是/ 将/ 图像/ 分解成/ 一个/ 基础/ 层/ 和/ 一个/ 或/ 多个/ 细节/ 层/ ,/ 其中/ 基础/ 层/ 的/ 计算/ 就是/ 一个/ 图像/ 渐进/ 平滑/ 的/ 过程/ ./ 而/ 在/ 这个/ 渐进/ 平滑/ 的/ 过程/ 中/ ,/ 必须/ 小心/ 操作/ 基础/ 层/ 与/ 细节/ 层/ 的/ 分解/ ,/ 以免/ 造成/ 图像/ 失真/ ./ 如/ 文献/ [/ 9/ -/ 10/ ]/ 指出/ ,/ 当/ 图像/ 被/ 分解成/ 基础/ 层/ 和/ 细节/ 层时/ 容易/ 引起/ 失真/ 现象/ ./ 因为/ 在/ 图像/ 平滑/ 过程/ 中/ ,/ 无论是/ 模糊/ 还是/ 锐化/ 边缘/ 都/ 会/ 在/ 细节/ 层中/ 产生/ 震荡/ ,/ 而/ 这种/ 震荡/ 将/ 是/ 导致/ 图像/ 重组/ 后/ 产生/ 光环/ 现象/ 和/ 梯度/ 逆转/ 现象/ 的/ 原因/ ./ 在/ 过去/ 的/ 几十年/ 里/ ,/ 多种/ 保留/ 边缘/ 的/ 多/ 尺度/ 图像/ 分解/ 技术/ 在/ 细节/ 增强/ 算法/ 中/ 得到/ 应用/ ./ 基于/ 双边/ 滤波/ [/ 11/ -/ 12/ ]/ 和/ 小波/ 分解/ [/ 4/ ,/ 13/ -/ 14/ ]/ 的/ 多/ 尺度/ 分解/ 技术/ 是/ 被/ 频繁/ 使用/ 的/ 图像/ 分解/ 方法/ ./ 最近/ ,/ 基于/ 加权/ 最小/ 二/ 乘法/ (/ WLS/ )/ [/ 3/ ]/ 、/ L0/ 梯度/ 平滑/ [/ 6/ ]/ 和域/ 变换/ [/ 8/ ]/ 的/ 图像/ 平滑/ 方法/ 也/ 纷纷/ 被/ 提出/ ./ 然而/ 在/ 我们/ 的/ 算法/ 中/ ,/ 无论/ 采用/ 哪种/ 多/ 尺度/ 分解/ 方法/ 都/ 没有/ 明显/ 的/ 区别/ ./ 即/ 我们/ 的/ 算法/ 对于/ 任/ 一种/ 保留/ 边缘/ 的/ 多/ 尺度/ 分解/ 方法/ 都/ 适用/ ./ 如图/ 2/ 所示/ ,/ 他们/ 的/ 结果/ 都/ 无法/ 保持/ 原/ 图像/ 的/ 色调/ 分布/ ,/ 而/ 同样/ 采用/ 这些/ 方法/ 中/ 所用/ 到/ 的/ 多/ 尺度/ 分解/ 方法/ ,/ 我们/ 的/ 算法/ 明显/ 抑制/ 了/ 这/ 一/ 缺点/ ./ 换句话说/ ,/ 应用/ 任/ 一种/ 图像/ 多/ 尺度/ 分解/ 方法/ 都/ 不会/ 影响/ 我们/ 的/ 最终/ 结果/ ,/ 唯一/ 的/ 区别/ 就是/ 它们/ 细节/ 增强/ 的/ 尺度/ 不同/ ./ 为了/ 证明/ 本文/ 所/ 提出/ 算法/ 的/ 适用性/ ,/ 在/ 后续/ 实验/ 中/ 我们/ 采用/ 基于/ 双边/ 滤波/ 的/ 图像/ 平滑/ 技术/ 来/ 提取/ 细节/ ./ 下面/ 简要/ 叙述/ 基于/ 双边/ 滤波/ 的/ 多/ 尺度/ 图像/ 分解/ 方法/ ./ 双边/ 滤波/ 是/ 在/ 高斯/ 滤波/ 的/ 基础/ 上/ 提出/ 的/ ,/ 其主/ 本文/ 算法/ 的/ 具体/ 实现/ 流程/ 于图/ 1/ 显示/ ./ 下面/ 的/ 章节/ 将/ 具体/ 介绍/ 每个/ 步骤/ 的/ 实现/ ./ 要/ 思想/ 是/ 将/ 滤波/ 权/ 系数/ 优化/ 成/ 高斯/ 函数/ 和/ 图像/ 亮度/ 信息/ 的/ 乘积/ ,/ 之后/ 将权/ 系数/ 再/ 与/ 图像/ 信息/ 作/ 卷积/ 运算/ ,/ 目的/ 是/ 在/ 滤波/ 的/ 同时/ 考虑/ 到/ 图像/ 的/ 边缘/ 信息/ ,/ 使/ 图像/ 在/ 正常/ 高斯/ 滤波/ 后/ 很/ 模糊/ 的/ 边缘/ 信息/ 可以/ 保持/ 清晰/ ./ 其/ 定义/ 如下/ :/ BF/ (/ I/ )/ p/ =/ 1/ 其中/ 的/ Ip/ ,/ Iq/ 分别/ 表示/ 图像/ I/ 中/ 像素点/ p/ 和/ q/ 处/ 的/ 颜色/ 值/ ;/ Wp/ =/ ∑/ q/ ∈/ S/ 器/ 归一化/ 系数/ ;/ G/ σ/ r/ ,/ G/ σ/ d/ 分别/ 是/ 图像/ I/ 的/ 颜色/ 值域/ R/ 和/ 空域/ 值/ S/ 上以/ σ/ r/ ,/ σ/ d/ 为/ 参数/ 的/ 高斯/ 核/ ;/ ·/ 代表/ 绝对值/ ,/ ·/ 代表/ 两/ 像素点/ 之间/ 的/ 欧式/ 距离/ ./ σ/ d/ 的/ 大小/ 决定/ 窗口/ 的/ 大小/ ,/ σ/ d/ 变大时/ ,/ 由于/ 像素点/ 变多/ ,/ 使得/ 图像/ 越来越/ 模糊/ ;/ 而/ σ/ r/ 可以/ 对/ σ/ d/ 的/ 变化/ 做出/ 一定/ 的/ 补偿/ ,/ 例如/ ,/ 当/ σ/ d/ 变大时/ ,/ 考虑/ 进来/ 的/ 像素/ 变多/ ,/ 图像/ 本/ 应变/ 模糊/ ,/ 但是/ 由于/ σ/ r/ 的/ 限制/ ,/ 那些/ 亮度/ 差值/ 大于/ σ/ r/ 的/ 像素/ 间/ 将/ 不/ 进行/ 结合/ 运算/ ,/ 所以/ 极大/ 程度/ 上/ 保证/ 了/ 图像/ 中/ 处于/ 高频/ 边缘/ 处/ 的/ 亮度/ 信息/ 得以/ 保留/ ,/ 而且/ 不会/ 和/ 其/ 相邻/ 的/ 非/ 边缘/ 亮度/ 信息/ 作/ 运算/ ./ 可见/ 双边/ 滤波/ 在/ 处理/ 相邻/ 像素/ 值/ 的/ 灰度/ 时/ ,/ 不仅/ 考虑/ 到/ 了/ 空间/ 的/ 邻近/ 关系/ ,/ 同时/ 也/ 考虑/ 到/ 了/ 灰度/ 的/ 相似/ 关系/ ,/ 可/ 在/ 平滑/ 图像/ 的/ 同时/ 较/ 好/ 地/ 保持/ 图像/ 边缘/ ./ 为了/ 得到/ 渐进/ 平滑/ 的/ 图像/ 和/ 多/ 尺度/ 细节/ 层/ ,/ 需要/ 对/ 图像/ 进行/ 迭代/ 滤波/ ./ 假设/ 想要/ 得到/ N/ 幅/ 渐进/ 平滑/ 的/ 图像/ ,/ 则/ 需要/ 迭代/ 滤波/ N/ 次/ ,/ 从而/ 得到/ 一个/ 保/ Page4/ 留/ 边缘/ 的/ 多/ 尺度/ 分解/ ./ 该/ 分解/ 由/ 一幅/ 粗糙/ 的/ 、/ 分段/ 光滑/ 的/ 图像/ ,/ 和/ 一系列/ 捕捉/ 细节/ 的/ 差/ 图像/ 组成/ ./ 更/ 具体地说/ ,/ 假如/ 要/ 构造/ 一个/ k/ +/ 1/ 级/ 的/ 多/ 尺度/ 分解/ ./ 我们/ 用/ I/ 代表/ 输入/ 图像/ ,/ 则/ 可以/ 通过/ 迭代/ 滤波/ 得到/ 一系列/ 原/ 图像/ I/ 的/ 渐进/ 平滑/ 的/ 版本/ J1/ ,/ …/ ,/ Jk/ (/ k/ / 1/ )/ ,/ 其中/ ,/ 最/ 平滑/ 的/ 版本/ Jk/ 叫做/ 基/ 图像/ ./ 同时/ 可以/ 得到/ 一图/ 2/ 对比/ 基于/ 不同/ 多/ 尺度/ 分解/ 方法/ 的/ 结果/ (/ 其中/ ,/ 图/ (/ b/ )/ ~/ (/ e/ )/ 为/ 已有/ 细节/ 增强/ 方法/ 所得/ 结果/ ;/ 图/ (/ f/ )/ ~/ (/ i/ )/ 为/ 本文/ 基于/ 不同/ 多/ 尺度/ 分解/ 方法/ 所得/ 细节/ 增强/ 结果/ )/ 2.2/ 自/ 适应/ 的/ 细节/ 增强/ 与/ 合成/ 策略/ 通过/ 比较/ 以往/ 的/ 细节/ 增强/ 算法/ ,/ 可以/ 发现/ 他们/ 的/ 细节/ 增强/ 函数/ 都/ 无法/ 做到/ 自/ 适应/ ./ 也就是说/ 对于/ 不同/ 的/ 输入/ 图像/ ,/ 需要/ 设置/ 不同/ 的/ 参数值/ ,/ 有/ 的/ 甚至/ 需要/ 选取/ 不同/ 的/ 细节/ 增强/ 函数/ 来/ 放大/ 细节/ ./ 并且/ 对于/ 参数/ 的/ 设置/ 和/ 细节/ 增强/ 函数/ 的/ 选取/ 都/ 没有/ 给出/ 具体/ 的/ 依据/ ,/ 只能/ 通过/ 测试/ 图片/ 的/ 方式/ 期望/ 达到/ 好/ 的/ 细节/ 增强/ 效果/ ./ 所以/ ,/ 为了/ 能够/ 使/ 图像/ 的/ 细节/ 增强/ 达到/ 自/ 适应/ ,/ 本文/ 设计/ 了/ 一个/ 新/ 的/ 多/ 尺度/ 细节/ 重组/ 函数/ ,/ 如下/ 所示/ :/ Iresult/ =/ α/ ·/ Jk/ +/ ∑/ k/ 其中/ ,/ Iresult/ 为/ 细节/ 重组/ 后/ 的/ 结果/ ,/ S/ (/ Di/ )/ 为/ 细节/ 增强/ 函数/ ,/ 对/ 每/ 一个/ 细节/ 层/ 进行/ 最大/ 尺度/ 的/ 细节/ 放大/ ./ 参数/ α/ 用来/ 权衡/ 基/ 图像/ 与/ 细节/ 层/ 的/ 权重/ ,/ 参数/ β/ i/ 用来/ 权衡/ 各个/ 细节/ 层/ 的/ 权重/ ,/ 并且/ 满足/ ∑/ k/ 的/ 后续/ 实验/ 中/ ,/ 统一/ 选取/ α/ =/ 0.8/ ,/ β/ 1/ =/ 0.5/ ,/ β/ 2/ =/ 0.3/ ,/ β/ 3/ =/ 0.2/ ./ 当然/ ,/ 通过/ 设置/ 不同/ 的/ 参数值/ 可以/ 得到/ 不同/ 的/ 细节/ 增强/ 效果/ ./ 接下来/ 我们/ 详细/ 阐述/ 细节/ 增强/ 函数/ S/ (/ Di/ )/ 的/ 构造/ ./ 我们/ 构造/ S/ (/ Di/ )/ 函数/ 的/ 目的/ 是/ 为了/ 在/ 细节/ 增强/ 系列/ 渐进/ 粗糙/ 的/ 细节/ 层/ :/ 当然/ ,/ 原/ 图像/ I/ 可以/ 很/ 容易/ 地被/ 重构/ 出来/ ,/ 只/ 需要/ 简单/ 地/ 将/ 基/ 图像/ 与/ 细节/ 层/ 相加/ ,/ 即/ 过程/ 中/ 最大化/ 原/ 图像/ 的/ 小/ 尺度/ 细节/ ,/ 同时/ 使强/ 边缘/ 的/ 变化/ 达到/ 最小/ ./ 虽然/ 我们/ 采用/ 保留/ 边缘/ 滤波/ 算法/ ,/ 但是/ 细节/ 层中/ 仍然/ 会/ 残留/ 很多/ 强/ 边缘/ 的/ 变化/ 以及/ 由强/ 边缘/ 引起/ 的/ 震荡/ 现象/ ./ 如果/ 在/ 细节/ 增强/ 过程/ 中/ ,/ 这些/ 强/ 边缘/ 也/ 被/ 放大/ 相同/ 的/ 尺度/ ,/ 那么/ 在/ 细节/ 重组/ 后/ ,/ 整个/ 亮度/ 通道/ 将会/ 发生/ 大幅度/ 的/ 越界/ ./ 如果/ 采取/ 截断/ 的/ 措施/ ,/ 那么/ 在/ 细节/ 重组/ 以后/ ,/ 图像/ 中将/ 会/ 存在/ 大量/ 的/ 黑洞/ 与/ 亮点/ ;/ 如果/ 采取/ 归一化/ ,/ 则/ 整个/ 图像/ 的/ 亮度/ 分布/ 将会/ 发生/ 偏移/ ./ 所以/ ,/ 无论/ 采取/ 哪/ 种/ 措施/ ,/ 都/ 会/ 改变/ 整个/ 图像/ 的/ 亮度/ 分布/ ,/ 甚至/ 引起/ 光环/ 现象/ 和/ 梯度/ 逆转/ 现象/ (/ 如图/ 3/ 左/ )/ ./ 因此/ ,/ 在/ 细节/ 增强/ 的/ 同时/ ,/ 必须/ 考虑/ 抑制/ 大/ 尺度/ 边缘/ 的/ 放大/ ./ 本文/ 构造/ 了/ 如下/ 细节/ 增强/ 函数/ :/ 总的来说/ ,/ 该/ 函数/ 的/ 作用/ 是/ 对/ 细节/ 层中/ 的/ 小/ 尺度/ 细节/ 应用/ S/ 函数/ 做/ 了/ 一个/ 拉伸/ ,/ 其中/ ratio/ 是/ 一个/ 常量/ ./ 但是/ ,/ 为了/ 有效/ 地/ 抑制/ 大/ 尺度/ 边缘/ 的/ 放大/ ,/ 我们/ 在/ S/ 函数/ 中加/ 了/ 一项/ 惩罚/ 项/ ,/ 即/ 使用/ 指数/ C/ 来/ 惩罚/ 拥有/ 大/ 尺度/ 边缘/ 的/ 像素/ ,/ 如下/ 所示/ :/ Page5/ 其中/ ,/ / IP/ 代表/ 输入/ 图像/ 在/ 像素点/ p/ 的/ 梯度/ 值/ ,/ q/ 代表/ 以/ p/ 为/ 中心/ 的/ 3/ ×/ 3/ 邻域/ ,/ ε/ 是/ 一个/ 极小值/ ,/ 用来/ 保证/ 分母/ 不为/ 零/ ./ 可以/ 看出/ ,/ 分子/ 中/ 的/ 梯度/ 项/ 用来/ 寻找/ 强/ 边缘/ ,/ 梯度/ 越大/ Cp/ 越大/ ,/ 且/ Cp/ ∈/ (/ 0/ ,/ +/ )/ ./ 即使/ 在/ 图像/ 较/ 黑/ 的/ 地方/ 也/ 可以/ 通过/ 分母/ 放大/ 指数/ C/ ./ 如图/ 3/ 所示/ ,/ 对比/ Gastal/ 与/ 我们/ 的/ 结果/ ./ Gastal/ 只图/ 3/ 对比/ 不同/ 细节/ 增强/ 函数/ 的/ 结果/ (/ 左图/ 为/ Gastal/ 的/ 结果/ [/ 8/ ]/ ,/ 右图/ 为/ 本文/ 的/ 结果/ )/ 为了/ 进一步/ 放大/ 细节/ 层/ ,/ 我们/ 可以/ 对式/ (/ 5/ )/ 中/ 的/ D/ 做/ 如下/ 替换/ :/ 其中/ ,/ λ/ 越小/ ,/ 细节/ 增强/ 的/ 幅度/ 越高/ ./ 在/ 具体/ 的/ 实现/ 中/ ,/ 我们/ 将/ 细节/ 层/ 分为/ 3/ 个/ 尺度/ ,/ 即/ k/ =/ 3/ (/ 式/ (/ 2/ )/ )/ ./ 对/ 不同/ 尺度/ 的/ 细节/ 层/ 可以/ 设置/ 不同/ 的/ λ/ ,/ 从而/ 得到/ 不同/ 尺度/ 的/ 细节/ 放大/ 效果/ ./ 如图/ 4/ 所示/ ,/ 细节/ 层/ D1/ 图/ 4/ 不同/ 尺度/ λ/ i/ 下/ 的/ 细节/ 放大/ 效果/ 2.3/ 基于/ 能量/ 优化/ 的/ 色调/ 校正/ 算法/ 一种/ 有效/ 的/ 彩色图像/ 细节/ 增强/ 算法/ 除了/ 放大/ 图像/ 细节/ 之外/ 还/ 必须/ 使得/ 处理/ 后/ 的/ 图像/ 色调/ 分布/ 不会/ 带来/ 失真/ ,/ 因此/ ,/ 在/ 增强/ 细节/ 的/ 同时/ ,/ 必须/ 寻找/ 一种/ 有效/ 的/ 方法/ 来/ 保持/ 图像/ 的/ 色调/ 分布/ ./ 细节/ 重组/ 过程/ 中/ ,/ 即使/ 采用/ 本文/ 构造/ 的/ 抑制/ 大/ 尺度/ 边缘/ 的/ 细节/ 增强/ 函数/ ,/ 整个/ 图像/ 的/ 亮度/ 通道/ 取值/ 仍然/ 会/ 发生/ 剧烈/ 是/ 简单/ 的/ 用/ S/ 函数/ 放大/ 细节/ ,/ 导致/ 结果/ 图像/ 中/ 存在/ 大量/ 的/ 光环/ 现象/ ./ 而/ 我们/ 对/ S/ 函数/ 做/ 了/ 进一步/ 的/ 改进/ 来/ 抑制/ 细节/ 层中大/ 尺度/ 边缘/ 的/ 增强/ ,/ 对比/ 图中/ 细节/ ,/ 可以/ 看出/ 我们/ 的/ 细节/ 增强/ 函数/ 明显/ 抑制/ 了/ 结果/ 图像/ 中/ 光环/ 现象/ 的/ 产生/ ./ 中/ 的/ 细节/ 最/ 丰富/ ,/ 当/ λ/ 1/ 取/ 0.7/ 时/ ,/ 图像/ (/ b/ )/ 的/ 细节/ 增强/ 程度/ 明显/ 高于/ 图像/ (/ c/ )/ 和/ 图像/ (/ d/ )/ ./ 可以/ 看出/ ,/ 我们/ 的/ 基于/ 梯度/ 响应/ 的/ 细节/ 增强/ 函数/ 可以/ 自/ 适应/ 地/ 得到/ 细节/ 层中/ 每/ 一个/ 像素点/ 的/ 增强/ 幅度/ ./ 即/ 一旦/ 参数/ (/ 如/ α/ ,/ β/ ,/ λ/ )/ 的/ 值/ 被/ 设定/ ,/ 对于/ 任意/ 输入/ 图像/ ,/ 都/ 可以/ 根据/ 每/ 一幅/ 图像/ 的/ 局部/ 信息/ 自/ 适应/ 地/ 计算/ 出/ 它们/ 的/ 增强/ 幅度/ ./ 的/ 变化/ ,/ 使得/ 细节/ 重组/ 后/ 的/ 结果/ 图像/ 色调/ 分布/ 大幅度/ 偏离/ 原/ 图像/ ./ 如图/ 5/ (/ b/ )/ 为/ 本文/ 细节/ 增强/ 后/ 的/ 结果/ 图像/ ,/ 图像/ 的/ 亮度/ 分布/ 还是/ 发生/ 了/ 明显/ 的/ 偏离/ ,/ 有/ 的/ 地方/ 呈现/ 过暗/ 的/ 效果/ ./ 即使/ 采用/ 对比度/ 拉伸/ 或/ 直方图/ 匹配/ 等/ 方法/ ,/ 也/ 无法/ 有效/ 地/ 纠正/ 细节/ 增强/ 图像/ 的/ 颜色/ 分布/ ./ 因此/ ,/ 基于/ 马尔可夫/ 随/ 机场/ 理论/ ,/ 本文/ 提出/ 了/ 一种/ 可以/ 有效/ 校正/ 图像/ 色调/ 分布/ 的/ 能量/ 优化/ 算法/ ./ Page6/ 图/ 5/ 细节/ 增强/ 图像/ 的/ 色调/ 校正/ (/ 其中/ ,/ 未经/ 色调/ 校正/ 的/ 细节/ 增强/ 图像/ (/ b/ )/ 和/ Gastal/ 的/ 结果/ (/ d/ )/ 都/ 明显/ 偏暗/ )/ 对于/ 输入/ 图像/ d/ 和/ 经过/ 上述/ 细节/ 增强/ 后/ 的/ 图像/ u/ ,/ 我们/ 通过/ 能量/ 优化/ 的/ 方法/ 寻找/ 一张/ 新/ 的/ 图像/ f/ ,/ 使得/ 该/ 图像/ f/ 一方面/ 拥有/ 输入/ 图像/ d/ 的/ 色调/ 分布/ ,/ 另一方面/ 尽量/ 逼近/ 细节/ 增强/ 图像/ u/ 的/ 梯度/ 分布/ (/ 如图/ 5/ (/ c/ )/ )/ ./ 形式/ 上/ ,/ 该/ 能量/ 优化/ 算法/ 可以/ 表示/ 为/ 如下/ 形式/ :/ 即/ 求解/ 该/ 能量/ 函数/ 的/ 最小化/ ./ 其中/ ,/ 能量/ 项/ Et/ 代表/ 输出/ 图像/ f/ 与/ 输入/ 图像/ d/ 的/ 色调/ 差异/ ,/ 形式/ 如下/ 所示/ :/ 其中/ ,/ p/ ,/ q/ 表示/ 一个/ 像素/ 的/ 空间/ 坐标/ ,/ N/ (/ p/ )/ 表示/ 像素/ p/ 的/ 邻域/ ./ 而式/ (/ 8/ )/ 中/ 的/ 能量/ 项/ Eg/ 是/ 为了/ 最小化/ 输出/ 图像/ f/ 与/ 细节/ 增强/ 图像/ u/ 的/ 梯度/ 差异/ ,/ 即/ Eg/ (/ p/ )/ =/ ∑/ q/ ∈/ N/ (/ p/ )/ 其中/ ,/ fx/ 和/ fy/ 分别/ 代表/ 输出/ 图像/ f/ 的/ x/ 方向/ 和/ y/ 方向/ 梯度/ ,/ ux/ 和/ uy/ 分别/ 代表/ 细节/ 增强/ 图像/ u/ 的/ x/ 方向/ 和/ y/ 方向/ 梯度/ ./ 最后/ ,/ 参数/ γ/ 负责/ 权衡/ 这/ 两个/ 能量/ 项/ ,/ γ/ 越大/ ,/ 所得/ 结果/ 图像/ 的/ 梯度/ 分布/ 越/ 接近/ 细节/ 增强/ 图像/ u/ 的/ 梯度/ 分布/ ./ 当/ γ/ 增大/ 到/ 一定/ 程度/ 时/ ,/ 输出/ 图像/ f/ 将/ 保持/ 不变/ ,/ 即/ 能量/ 函数/ 达到/ 最优化/ 状态/ ./ 如图/ 6/ 所示/ ,/ Page7/ 如果/ 对/ 细节/ 增强/ 图像/ 不/ 采用/ 我们/ 的/ 优化/ 方案/ ,/ 所得/ 细节/ 增强/ 图像/ (/ 图/ 6/ (/ b/ )/ )/ 的/ 颜色/ 分布/ 明显/ 偏离/ 了/ 原/ 图像/ 的/ ./ 而/ 经过/ 色调/ 优化/ 的/ 结果/ 图像/ (/ 图/ 6/ (/ c/ )/ 、/ (/ d/ )/ )/ ,/ 颜色/ 分布/ 都/ 得到/ 了/ 明显/ 的/ 改善/ ./ 当取/ γ/ =/ 1/ 时/ ,/ 所得/ 结果/ 图像/ 的/ 颜色/ 分布/ 最/ 接近/ 原/ 图像/ ,/ 而/ 细节/ 较图/ 6/ (/ b/ )/ 明显/ 减弱/ ,/ 随着/ γ/ 的/ 增大/ ,/ 细节/ 越来越/ 接近/ 图/ 6/ (/ b/ )/ ./ 当/ γ/ 增大/ 到/ 15/ 时/ ,/ 我们/ 的/ 肉眼/ 已/ 无法/ 辨别/ 细节/ 的/ 变化/ ,/ 因此/ ,/ 本文/ 后续/ 实验/ 都/ 取/ γ/ =/ 15.3/ 实验/ 结果/ 与/ 讨论/ 对于/ 任意/ 的/ 输入/ 图像/ 和/ 视频/ ,/ 通过/ 本文/ 的/ 自/ 适应/ 细节/ 增强/ 函数/ 和/ 基于/ 能量/ 优化/ 的/ 色调/ 校正/ 算法/ 处理/ 后/ ,/ 所得/ 的/ 结果/ 图像/ 与/ 视频/ 都/ 达到/ 了/ 很/ 好/ 的/ 细节/ 增强/ 效果/ ./ 为了/ 显示/ 本文/ 算法/ 的/ 自/ 适应/ ,/ 本文/ 所/ 显示/ 的/ 所有/ 结果/ 都/ 采用/ 了/ 统一/ 的/ 参数设置/ ./ 对于/ 每/ 一幅/ 输入/ 图像/ 或/ 视频/ ,/ 通过/ 本文/ 提出/ 的/ 统一/ 细节/ 增强/ 函数/ 都/ 可以/ 得到/ 一个/ 细节/ 增强/ 的/ 效果/ ;/ 并且/ 无论/ 发生/ 多大/ 的/ 色调/ 偏移/ ,/ 都/ 可以/ 通过/ 本文/ 的/ 能量/ 优化/ 算法/ 图/ 7/ 对比/ Gastal/ 与/ 本文/ 的/ 结果/ (/ 其中/ ,/ 左边/ 为/ 输入/ 图像/ ,/ 中间/ 为/ Gastal/ 的/ 结果/ [/ 8/ ]/ ,/ 右边/ 为/ 本文/ 的/ 结果/ )/ 得到/ 很/ 好/ 的/ 校正/ ./ 当然/ ,/ 可以/ 根据/ 个人/ 的/ 视觉/ 感官/ 调整/ 参数/ α/ ,/ β/ ,/ λ/ 的/ 值/ ,/ 从而/ 得到/ 不同/ 的/ 细节/ 增强/ 效果/ ./ 对比/ Fattal/ 、/ Farbman/ 、/ Xu/ 和/ Gastal/ 等/ 人/ 的/ 结果/ (/ 见图/ 2/ )/ ,/ 可以/ 清楚/ 地/ 看到/ 我们/ 的/ 色调/ 优化/ 算法/ 明显/ 校正/ 了/ 细节/ 增强/ 图像/ 的/ 色调/ 分布/ ,/ 使/ 所得/ 结果/ 图像/ 既/ 保持/ 了/ 原/ 图像/ 的/ 颜色/ 分布/ ,/ 又/ 保持/ 了/ 细节/ 增强/ 图像/ 的/ 梯度/ 分布/ ./ 图/ 7/ 、/ 图/ 8/ 展示/ 了/ 更/ 多/ 由/ 本文/ 算法/ 得到/ 的/ 图像/ 细节/ 增强/ 结果/ ./ 在/ 图/ 7/ ,/ 我们/ 对比/ 了/ Gastal/ 与/ 本文/ 的/ 结果/ ./ 可以/ 清楚/ 地/ 看到/ ,/ 我们/ 的/ 方法/ 对于/ 颜色/ 偏亮/ 的/ 图像/ 仍然/ 可以/ 得到/ 色调/ 保持/ 的/ 细节/ 增强/ 结果/ ./ 换句话说/ ,/ 我们/ 的/ 方法/ 很/ 好/ 的/ 控制/ 了/ 图像/ 的/ 亮度/ 分布/ ,/ 使/ 图像/ 的/ 整体/ 色调/ 不/ 发生/ 偏移/ ./ 采用/ 统一/ 参数设置/ 的/ Gastal/ 的/ 结果/ 不仅/ 整体/ 上/ 偏亮/ ,/ 而且/ 存在/ 很多/ 刺眼/ 的/ 亮点/ ,/ 而/ 这些/ 现象/ 在/ 我们/ 的/ 结果/ 中/ 完全/ 不/ 存在/ ./ 所以/ ,/ Gastal/ 的/ 算法/ 完全/ 无法/ 做到/ 自/ 适应/ ./ 由图/ 8/ 可以/ 看出/ ,/ 对于/ 任意/ 的/ 输入/ 图像/ ,/ 我们/ 的/ 细节/ 增强/ 结果/ 都/ 明显/ 抑制/ 了/ 光环/ 现象/ 的/ 产生/ ,/ 保持/ 了/ 原/ 图像/ 的/ 色调/ 分布/ ,/ 保证/ 了/ 图像/ 的/ 真实感/ ./ Page8/ 图/ 8/ 本文/ 的/ 细节/ 增强/ 结果/ (/ 其中/ ,/ 左图/ 为/ 输入/ 图像/ ,/ 右图/ 为/ 细节/ 增强/ 结果/ )/ 在/ 图/ 9/ 中/ ,/ 我们/ 展示/ 了/ 3/ 个/ 由/ 本文/ 算法/ 得到/ 的/ 细节/ 增强/ 视频/ 序列/ ./ 这些/ 结果表明/ 对于/ 没有/ 显著/ 场景/ 切换/ 的/ 任意/ 视频/ ,/ 我们/ 的/ 算法/ 都/ 可以/ 通过/ 统一/ 的/ 参数设置/ 来/ 得到/ 很/ 好/ 的/ 连续/ 的/ 视频/ 细节/ 增强/ 效果/ ./ 因此/ ,/ 我们/ 可以/ 得出结论/ ,/ 我们/ 的/ 算法/ 对/ 图像/ 和/ 视频/ 都/ 适用/ ./ 4/ 结论/ 本文/ 提出/ 了/ 一种/ 色调/ 保持/ 的/ 自/ 适应/ 图像/ 视频/ 细节/ 增强/ 算法/ ./ 对于/ 任意/ 的/ 输入/ 图像/ 和/ 视频/ ,/ 算法/ 首先/ 采用/ 基于/ 双边/ 滤波/ 的/ 多/ 尺度/ 图像/ 分解/ 技术/ 来/ 快速/ 获取/ 基/ 图像/ 和/ 多个/ 细节/ 层/ ./ 然后/ ,/ 通过/ 自/ 适应/ 的/ 多/ 尺度/ 细节/ 增强/ 与/ 合成/ ,/ 得到/ 一幅/ 细节/ 增强/ 后/ 的/ 图像/ ./ 最后/ ,/ 通过/ 能量/ 函数/ 的/ 最小化/ 来/ 优化/ 细节/ 增强/ 图像/ 的/ 色调/ 分布/ ,/ 使/ 结果/ 图像/ 既/ 保持/ 原/ 图像/ 的/ 颜色/ 分布/ 又/ 拥有/ 细节/ 增强/ 图像/ 的/ 梯度/ 分布/ ./ 实验/ 结果/ 证明/ :/ 我们/ 的/ 方法/ 能够/ 在/ 统一/ 的/ 参数/ 设定/ 情况/ 下/ ,/ 对/ 任意/ 的/ 输入/ 图像/ 或/ 视频/ 均/ 可/ 取得/ 色调/ 保持/ 的/ 显著/ 细节/ 增强/ 效果/ ./ 但是/ ,/ 由于/ 本文/ 算法/ 的/ 色调/ 校正/ 过程/ 需要/ 求解/ 大型/ 稀疏/ 线性系统/ ,/ 因此/ 我们/ 的/ 算法/ 实现/ 目前/ 还/ 无法/ 达到/ 实时/ 的/ 处理/ 性能/ ./ 我们/ 将/ 借助/ 通用/ 图形/ 处理器/ 的/ 通用/ 计算能力/ 来/ 提升/ 算法/ 的/ 执行/ 效率/ ./ Page9/ 图/ 9/ 视频/ 细节/ 增强/ 结果/ (/ 上/ 行为/ 输入/ 视频/ 帧/ ,/ 下/ 行为/ 对应/ 的/ 细节/ 增强/ 结果/ )/ 

