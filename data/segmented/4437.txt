Page1/ 互联网/ 域间/ 源地址/ 验证/ 的/ 可/ 部署/ 性/ 评价/ 模型/ 刘冰洋/ 1/ )/ ,/ 3/ )/ 毕军/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 清华大学/ 信息网络/ 科学/ 与/ 网络空间/ 研究院/ 北京/ 100084/ )/ 2/ )/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 3/ )/ (/ 清华/ 信息技术/ 国家/ 实验室/ 北京/ 100084/ )/ 摘要/ 近年来/ ,/ IP/ 源地址/ 伪造/ 被/ 频繁/ 应用/ 于/ 网络攻击/ 中/ ,/ 对/ 互联网安全/ 造成/ 极大/ 威胁/ ./ 域间/ 源地址/ 验证/ 方法/ 通过/ 对/ IP/ 报文/ 进行/ 自治/ 域/ 级别/ 的/ 验证/ 来/ 防御/ 这/ 类/ 网络攻击/ ./ 学术界/ 提出/ 了/ 这类/ 方法/ 的/ 评价/ 指标/ ,/ 并/ 依照/ 该/ 指标/ 设计/ 出/ 很多/ 新/ 的/ 方法/ ./ 然而/ ,/ 这些/ 方法/ 尽管/ 指标值/ 优秀/ ,/ 却/ 无/ 一能/ 在/ 实际/ 中/ 得到/ 互联网/ 服务提供商/ 的/ 广泛/ 部署/ ./ 究其原因/ ,/ 是/ 现有/ 评价/ 指标/ 主要/ 关注/ 互联网/ 整体/ 的/ 安全性/ ,/ 而/ 没有/ 考虑/ 到/ 互联网/ 服务提供商/ 的/ 个体/ 利益/ ./ 文中/ 首次/ 从/ 互联网/ 服务提供商/ 的/ 经济/ 诉求/ 出发/ ,/ 研究/ 域间/ 源地址/ 验证/ 方法/ 的/ 可/ 部署/ 性/ 评价/ 模型/ ./ 作者/ 提出/ 将/ 部署/ 收益/ 、/ 部署/ 开销/ 和/ 运维/ 风险/ 作为/ 可/ 部署/ 性/ 评价/ 的/ 3/ 项/ 基本/ 指标/ ,/ 并/ 给出/ 其/ 形式化/ 定义/ ;/ 从/ 理论/ 上/ 证明/ 了/ 该/ 指标体系/ 的/ 合理性/ ;/ 建立/ 了/ 评价/ 模型/ ,/ 为/ 每个/ 指标/ 设计/ 了/ 完善/ 的/ 量化/ 评价/ 方法/ ;/ 以/ 现有/ 著名/ 域间/ 源地址/ 方法/ 的/ 部署/ 收益/ 评价/ 为例/ ,/ 展示/ 了/ 将/ 理论/ 模型/ 应用/ 于/ 方法/ 评价/ 的/ 具体/ 流程/ ,/ 并/ 对/ 评价/ 结果/ 进行/ 深入分析/ ;/ 最后/ ,/ 作者/ 讨论/ 了/ 方法/ 可/ 部署/ 性/ 与/ 互联网/ 整体/ 安全性/ 的/ 关系/ 、/ 方法/ 设计/ 的/ 优化/ 目标/ 以及/ 如何/ 应用/ 模型/ 指导/ 方法/ 的/ 设计/ ./ 该/ 评价/ 模型/ 的/ 提出/ ,/ 对于/ 设计/ 更/ 易于/ 部署/ 的/ 方法/ 具有/ 指导意义/ ,/ 并/ 有利于/ 促进/ 域间/ 源地址/ 验证/ 方法/ 在/ 互联网/ 的/ 部署/ ./ 关键词/ 源地址/ 验证/ ;/ 评价/ 模型/ ;/ 可/ 部署/ 性/ ;/ 拒绝服务/ 攻击/ ;/ 网络安全/ ;/ 域间/ ;/ 互联网/ 1/ 引言/ 随着/ 多年/ 的/ 飞速发展/ ,/ 互联网/ 已经/ 深入/ 渗透到/ 社会/ 的/ 方方面面/ ,/ 成为/ 承载/ 人类/ 经济/ 和/ 文化/ 活动/ 的/ 不可或缺/ 的/ 信息/ 基础设施/ ./ 与此同时/ ,/ 互联网/ 的/ 安全/ 问题/ 也/ 因为/ 影响/ 到/ 人们/ 的/ 生产/ 生活/ 而/ 得到/ 了/ 社会各界/ 的/ 广泛/ 关注/ ./ 近些年来/ ,/ 基于/ 源地址/ 伪造/ 的/ 网络攻击/ 由于/ 流量/ 巨大/ 、/ 难以/ 追溯/ 和/ 难以/ 防御/ 等/ 特点/ ,/ 被/ 不法分子/ 频繁/ 利用/ ,/ 造成/ 了/ 重大/ 的/ 经济损失/ [/ 1/ -/ 4/ ]/ ./ 此外/ ,/ 源地址/ 伪造/ 行为/ 还/ 对/ 网络/ 的/ 可信/ 、/ 管理/ 、/ 计费/ 、/ 测量/ 等/ 造成危害/ ,/ 阻碍/ 了/ 网络/ 的/ 健康/ 发展/ ,/ 成为/ 当今/ 互联网/ 亟待解决/ 的/ 重要/ 安全/ 问题/ ①/ ②/ [/ 5/ -/ 6/ ]/ ./ 源地址/ 伪造/ 是/ 指/ 网络/ 主机/ 使用/ 未/ 被/ 合法/ 分配/ 的/ IP地址/ 作为/ 源地址/ 发送/ 报文/ 的/ 行为/ ./ 互联网/ 上/ 信息/ 的/ 传输/ 采用/ 分组/ 交换/ 的/ 方式/ ,/ 每个/ IP/ 分组/ (/ 即/ 报文/ )/ 都/ 携带/ 着/ 源地址/ 和/ 目的/ 地址/ ,/ 路由器/ 仅/ 根据/ 目的/ 地址/ 决定/ 报文/ 的/ 传输/ 方向/ ,/ 并/ 逐跳/ 地/ 转发/ 至/ 目的/ 主机/ ./ 在/ 这种/ 基于/ 目的/ 地址/ 的/ 转发/ 模式/ 中/ ,/ 路由器/ 无需/ 查看/ 报文/ 的/ 源地址/ ,/ 也/ 不/ 对/ 其/ 进行/ 检查/ ./ 这/ 就/ 使得/ 主机/ 可以/ 使用/ 假冒/ 的/ 源地址/ 发送/ 报文/ 而/ 不/ 影响/ 其/ 到达/ 目的/ 主机/ ./ 源地址/ 伪造/ 可以/ 应用/ 于/ 拒绝服务/ (/ DenialofService/ ,/ DoS/ )/ 攻击/ 中/ 达到/ 隐匿/ 攻击/ 源/ 、/ 放大/ 攻击/ 流量/ 的/ 目的/ ,/ 使得/ 这种/ 攻击/ 更难/ 发现/ 、/ 更难/ 防御/ 、/ 危害/ 更大/ [/ 5/ ]/ ./ 基于/ 源地址/ 验证/ 的/ DoS/ 攻击/ 分为/ 两类/ [/ 7/ ]/ ./ 第/ 1/ 类/ 是/ d/ -/ DoS/ ,/ 攻击者/ 直接/ 发送/ 大量/ 攻击/ 报文/ 至/ 受害者/ 来/ 淹没/ 其/ 网络带宽/ ,/ 这些/ 报文/ 携带/ 任意/ 的/ (/ 很多/ 时候/ 是/ 随机/ 的/ )/ 源地址/ ,/ 使得/ 受害者/ 难以/ 判断/ 攻击者/ 的/ 位置/ [/ 8/ ]/ ./ 第/ 2/ 类/ 是/ s/ -/ DoS/ ,/ 攻击者/ 向/ 一些/ 无关/ 的/ 服务器/ (/ 比如/ 域名/ 服务器/ )/ 请求/ 大量/ 的/ 数据/ ,/ 这些/ 请求/ 报文/ 的/ 源地址/ 被/ 设置/ 为/ 受害者/ 的/ IP地址/ ,/ 这样/ 从/ 服务器返回/ 的/ 大量/ 数据/ 就/ 会/ 淹没/ 受害者/ ./ 第/ 2/ 类/ 攻击/ 也/ 被称作/ 反射/ 攻击/ ,/ 由于/ 返回/ 的/ 数据/ 报文/ 的/ 尺寸/ 往往/ 远大于/ 请求/ 报文/ ,/ 就/ 使得/ s/ -/ DoS/ 产生/ 了/ 放大/ 攻击/ 流量/ 的/ 效果/ ,/ 因此/ 也/ 被称作/ 放大/ 攻击/ [/ 9/ ]/ ./ 源地址/ 验证/ 技术/ 通过/ 识别/ 和/ 过滤/ 伪造/ 报文/ 来/ 防御/ 基于/ 源地址/ 伪造/ 的/ 网络攻击/ ./ 根据/ RFC5210/ 的/ 描述/ ,/ 源地址/ 验证/ 体系结构/ 分为/ 3/ 个/ 层次/ ,/ 自/ 底向上/ 为/ 接入网/ 层/ 、/ 自治/ 域/ 内层/ 和/ 自治/ 域/ 间层/ ,/ 分别/ 执行/ IP地址/ 粒度/ 、/ IP地址/ 前缀/ 粒度/ 和/ 自治/ 域/ 粒度/ 的/ 源地址/ 验证/ [/ 10/ ]/ ,/ 如图/ 1/ 所示/ ./ 其中/ ,/ 接入网/ 和域/ 内/ 源地址/ 验证/ 都/ 是/ 部署/ 在/ 同一/ 自治/ 域/ 内/ 、/ 对本/ 自治/ 域/ 内/ 的/ 主机/ 和/ 子网/ 向外/ 发送/ 的/ 报文/ 进行/ 检查/ ,/ 而/ 几乎/ 无法/ (/ 或/ 极少/ 能够/ )/ 识别/ 出/ 从/ 自治/ 域/ 外部/ 发进来/ 的/ 伪造/ 报文/ [/ 11/ -/ 13/ ]/ ./ 因此/ ,/ 前/ 两个/ 层次/ 的/ 作用/ 主要/ 是/ 完成/ 本/ 自治/ 域/ 的/ 细粒度/ 网络管理/ ,/ 在/ 防御/ 外来/ 伪造/ 攻击/ 方面/ 的/ 作用/ 不大/ ./ 而域/ 间源/ ①/ ②/ internet2013/ ,/ 9/ ,/ 8Page3/ 地址/ 验证/ 的/ 主要/ 作用/ ,/ 就是/ 进行/ 自治/ 域/ 之间/ 伪造/ 流量/ 的/ 识别/ 和/ 过滤/ ,/ 实现/ 对/ 自治/ 域/ 的/ 保护/ ./ 域间/ 源地址/ 验证/ 方法/ 一般/ 部署/ 在/ 自治/ 域/ 的/ 边界/ 路由器/ 上/ ,/ 通过/ 人工/ 配置/ 、/ 自动/ 学习/ 或/ 服务器/ 部署/ 等/ 方式/ ,/ 将/ 源地址/ 绑定/ 到/ 路由器/ 的/ 入/ 向/ 端口/ 或者/ 密码学/ 标识/ 上/ ,/ 凡是/ 与/ 绑定/ 不/ 匹配/ 的/ 报文/ 都/ 会/ 被/ 识别/ 为/ 伪造/ 报文/ 而/ 被/ 丢弃/ 掉/ [/ 14/ -/ 19/ ]/ ./ 从/ 互联网/ 自治/ 域/ 级别/ 拓扑/ 的/ 粒度/ 来看/ ,/ 也/ 可以/ 视作/ 将源/ 地址映射/ 到/ 自治/ 域/ ,/ 并/ 将/ 自治/ 域/ 绑定/ 到/ 拓扑/ 的/ 有/ 向/ 边/ 或者/ 密码学/ 标识/ 上/ ./ 域间/ 源地址/ 验证/ 原则上/ 只/ 需/ 检查/ 一个/ 源地址/ 所属/ 的/ 自治/ 域/ 是否/ 真实/ ,/ 而/ 无需/ 识别/ 自治/ 域/ 内/ 主机/ 之间/ 的/ 相互/ 伪造/ ,/ 其/ 检查/ 粒度/ 比域/ 内/ 和/ 接入网/ 源地址/ 验证/ 要/ 粗/ ,/ 但/ 在/ 防御/ 基于/ 源地址/ 验证/ 的/ DoS/ 攻击/ 方面/ 十分/ 有效/ [/ 14/ ,/ 20/ ]/ ./ 十余年/ 来/ ,/ 工业界/ 和/ 学术界/ 为/ 防御/ 伪造/ 攻击/ 做出/ 了/ 大量/ 努力/ ./ 工业界/ 的/ Ingress/ // EgressFiltering/ (/ IEF/ )/ 和/ unicastReversePathForwarding/ (/ uRPF/ )/ 技术/ 已经/ 在/ 路由器/ 中/ 广泛/ 实现/ [/ 21/ -/ 22/ ]/ ,/ 但/ 很多/ 网络/ 运行/ 者/ 并/ 没有/ 启用/ 和/ 维护/ 这些/ 技术/ ./ 这/ 导致/ 互联网/ 上/ 仍/ 有/ 大量/ 自治/ 域/ 允许/ 源地址/ 伪造/ [/ 6/ ]/ ,/ 而且/ 这些/ 技术/ 的/ 启用/ 率/ 已经/ 多年/ 没有/ 提升/ [/ 5/ ]/ ./ 学术界/ 提出/ 了/ 许多/ 新/ 的/ 域间/ 源地址/ 验证/ 方法/ [/ 23/ -/ 24/ ]/ ,/ 但尚/ 没有/ 一种/ 方法/ 能够/ 在/ 实际/ 中/ 得到/ 广泛/ 部署/ ./ 这样/ 的/ 现状/ 说明/ 了/ 已有/ 的/ 域间/ 源地址/ 验证/ 方法/ 在/ 促进/ 部署/ 方面/ 都/ 存在/ 一定/ 的/ 缺陷/ ./ 更糟/ 的/ 是/ ,/ 在/ 本/ 领域/ 现有/ 的/ 评价/ 体系/ 下/ ,/ 这些/ 方法/ 看上去/ 都/ 很/ 优秀/ ;/ 而/ 新/ 提出/ 的/ 方法/ 往往/ 依照/ 该/ 评价/ 体系/ 进行/ 设计/ 优化/ ,/ 其/ 结果/ 依然/ 是/ 难以/ 得到/ 部署/ ./ 因此/ ,/ 我们/ 认为/ ,/ 在/ 现阶段/ ,/ 本/ 领域/ 研究/ 的/ 关键点/ 并/ 不是/ 新/ 方法/ 的/ 设计/ ,/ 而是/ 需要/ 回答/ 两个/ 更加/ 根本/ 的/ 问题/ :/ 什么样/ 的/ 方法/ 更/ 易于/ 部署/ ,/ 以及/ 如何/ 评价/ 方法/ 的/ 可/ 部署/ 性/ ./ 我们/ 知道/ ,/ 今天/ 的/ 互联网/ 是/ 由/ 数万/ 个/ 自治/ 的/ 网络/ 组成/ 的/ ,/ 而/ 这些/ 网络/ 由/ 不同/ 的/ 互联网/ 服务提供商/ (/ InternetServiceProvider/ ,/ ISP/ )/ 运营/ ./ 绝大多数/ 的/ ISP/ 都/ 以/ 营利/ 目的/ ,/ 他们/ 是否/ 部署/ 一项/ 新/ 的/ 网络/ 技术/ ,/ 取决于/ 该/ 技术/ 是否/ 能够/ 给/ 自己/ 带来/ 利润/ 的/ 增长/ ,/ 而/ 非/ 能否/ 为/ 整个/ 互联网/ 的/ 安全/ 做出/ 贡献/ ./ 而/ 现有/ 评价/ 体系/ 所/ 主要/ 关心/ 的/ 恰恰/ 就是/ 互联网/ 的/ 整体利益/ ./ 比如/ ,/ 在/ 衡量/ 方法/ 的/ 过滤/ 效果/ 时/ ,/ 该/ 评价/ 体系/ 主要/ 考虑/ 互联网/ 整体/ 的/ 伪造/ 流量/ 的/ 减少/ ,/ 而/ 不是/ 攻击/ 部署/ 者/ 的/ 流量/ 的/ 减少/ ;/ 再/ 如/ ,/ 该/ 评价/ 体系/ 关心/ 达到/ 某种/ 防御/ 效果/ 需要/ 多少/ 自治/ 域/ 的/ 部署/ (/ 越少/ 越/ 好/ )/ ,/ 却/ 不/ 关心/ 在/ 实际/ 中/ 如何/ 激励/ 这些/ 自治/ 域/ 去/ 部署/ ./ 在/ 这样/ 的/ 评价/ 体系/ 下/ ,/ 方法/ 的/ 设计/ 也/ 更/ 偏重/ 整体利益/ 而轻/ 部署/ 者/ 的/ 利益/ ,/ 因此/ 难以/ 得到/ ISP/ 的/ 认可/ ./ 本文/ 的/ 主要/ 动机/ 和/ 基本/ 目标/ 是/ ,/ 从/ 部署/ 者/ 的/ 利益/ 出发/ ,/ 通过/ 研究/ 方法/ 可/ 部署/ 性/ 的/ 基本/ 指标/ 并/ 建立/ 其/ 评价/ 模型/ ,/ 指引/ 方法/ 的/ 设计/ 更加/ 贴合/ 部署/ 者/ 的/ 利益/ 诉求/ ,/ 从而/ 促进/ 方法/ 的/ 广泛/ 部署/ ,/ 以/ 达到/ 互联网/ 整体/ 安全性/ 的/ 最终目标/ ./ 本文/ 的/ 特色/ 和/ 创新/ 之/ 处/ 在于/ :/ 通过/ 对/ ISP/ 的/ 调研/ ,/ 首次/ 提出/ 将/ 部署/ 收益/ 、/ 部署/ 开销/ 和/ 运维/ 风险/ 作为/ 评价/ 域间/ 源地址/ 验证/ 方法/ 可/ 部署/ 性/ 的/ 3/ 项/ 基本/ 指标/ ,/ 并/ 给出/ 形式化/ 定义/ ;/ 通过/ ISP/ 的/ 利润/ 公式/ 的/ 推导/ ,/ 从/ 理论/ 上/ 验证/ 了/ 该/ 评价/ 体系/ 的/ 合理性/ 和/ 完备/ 性/ ;/ 我们/ 为/ 每个/ 指标/ 建立/ 了/ 理论/ 评价/ 模型/ ,/ 将/ 方法/ 的/ 指标值/ 与/ 方法/ 的/ 工作/ 原理/ 、/ 互联网/ 的/ 结构/ 和/ 攻击/ 的/ 特征/ 联系/ 起来/ ,/ 从而/ 可以/ 利用/ 现实/ 数据/ 予以/ 定量/ 评价/ ;/ 通过/ 对/ 现有/ 方法/ 的/ 部署/ 收益/ 的/ 评价/ ,/ 介绍/ 了/ 模型/ 应用/ 的/ 具体/ 流程/ ,/ 并/ 通过/ 对/ 评价/ 结果/ 的/ 深入分析/ 提炼出/ 具有/ 高/ 部署/ 收益/ 的/ 方法/ 的/ 技术/ 特征/ ;/ 此外/ ,/ 我们/ 还/ 讨论/ 了/ 方法/ 可/ 部署/ 性/ 与/ 互联网/ 整体/ 安全性/ 的/ 关系/ 以及/ 方法/ 设计/ 的/ 优化/ 目标/ ./ 最后/ ,/ 我们/ 总结/ 了/ 本文/ 的/ 主要/ 贡献/ ,/ 并/ 对/ 未来/ 发展/ 方向/ 做出/ 展望/ ./ 本文/ 第/ 2/ 节/ 介绍/ 源地址/ 验证/ 评价/ 工作/ 的/ 发展/ 现状/ ;/ 第/ 3/ 节/ 介绍/ 本文/ 所/ 提出/ 的/ 评价/ 指标/ ,/ 并/ 证明/ 其/ 合理性/ 和/ 完备/ 性/ ;/ 第/ 4/ 节/ 介绍/ 理论/ 评价/ 模型/ ;/ 第/ 5/ 节/ 介绍/ 模型/ 应用/ 的/ 示例/ ;/ 第/ 6/ 节/ 讨论/ 可/ 部署/ 性/ 与/ 互联网/ 整体/ 安全性/ 的/ 关系/ 、/ 方法/ 设计/ 的/ 优化/ 目标/ 及/ 如何/ 应用/ 模型/ 指导/ 方法/ 设计/ ;/ 第/ 7/ 节/ 进行/ 总结/ 和/ 展望/ ./ 2/ 域间/ 源地址/ 验证/ 评价/ 工作/ 现状/ 文献/ [/ 23/ ]/ 总结/ 了/ 现有/ 域间/ 源地址/ 验证/ 方法/ 所/ 采取/ 的/ 评价/ 指标/ ./ 尽管/ 各个/ 方法/ 所/ 提及/ 的/ 概念/ 略有/ 差异/ ,/ 但/ 归纳起来/ ,/ 使用/ 较/ 多/ 的/ 评价/ 指标/ 主要/ 包括/ 有效性/ (/ 减少/ 的/ 伪造/ 流量/ 的/ 比例/ )/ 、/ 假/ 阳性率/ (/ 错误/ 地/ 丢弃/ 合法/ 报文/ 的/ 比例/ )/ 、/ 计算/ 开销/ 、/ 存储/ 开销/ 和/ 网络/ 开销/ 等/ ./ 但是/ ,/ 在/ 具体/ 应用/ 这些/ 指标/ 进行/ 评价/ 时/ ,/ 各个/ 方法/ 所/ 采取/ 的/ 参数/ 不尽相同/ ./ 比如/ ,/ 在/ 评价/ 有效性/ 时/ ,/ HopCountFiltering/ (/ HCF/ )/ 侧重于/ 评价/ 被/ 攻击/ 网络/ 独立/ 地/ 部署/ 方法/ 时/ (/ 既有/ 部署/ 率为/ 0/ %/ 时/ )/ 的/ 有效性/ ,/ 这/ 是因为/ HCF/ 的/ 优势/ 是/ 独立/ 部署/ 的/ 高效性/ [/ 25/ ]/ ;/ 而/ PathIdentifier/ (/ PiIP/ )/ 侧重于/ 评价/ 既有/ 部署/ 率/ 高于/ 50/ %/ 时/ 的/ 有效性/ ,/ 这/ 是因为/ PiIP/ 在/ 高/ 部署/ 率下/ 非常/ 有效/ 、/ 在/ 低/ 部署/ 率下/ 存在/ 较大/ 的/ 假/ 阳性/ [/ 26/ ]/ ./ 可见/ ,/ 尽管/ 本/ 领域/ 中/ 存在/ 较为/ 通用/ 的/ 评价/ 指标/ ,/ 但/ 如何/ 应用/ 这些/ 指标/ 仍然/ 较为/ 混乱/ ,/ 难以/ 进行/ 方法/ 间/ 的/ 横向/ 比较/ ./ 一些/ 综述/ 性/ 的/ 文章/ 也/ 提出/ 了/ 一些/ 指标/ 来/ 对/ 方法/ Page4/ 比较/ 评价/ ./ 比如/ ,/ 文献/ [/ 24/ ]/ 提出/ 的/ 6/ 项/ 指标/ 为/ 识别/ 能力/ 、/ 可/ 部署/ 性/ 、/ 本质特征/ 、/ 路由/ 协议/ 无关/ 性/ 、/ 攻击/ 缓解/ 能力/ 和/ 定位/ 能力/ ;/ 而/ 文献/ [/ 20/ ]/ 采取/ 了/ 有效性/ 、/ 开销/ 、/ 安全性/ 和/ 假/ 阳性率/ 这/ 4/ 项/ 指标/ ./ 这些/ 指标/ 当中/ ,/ 识别/ 能力/ 、/ 攻击/ 缓解/ 能力/ 、/ 定位/ 能力/ 、/ 有效性/ 等/ 主要/ 描述/ 的/ 是/ 方法/ 得到/ 部署/ 后/ 对/ 整个/ 互联网/ 的/ 伪造/ 行为/ 的/ 遏制/ ,/ 而/ 不是/ 体现/ 部署/ 者/ 个体/ 利益/ ./ 此外/ ,/ 方法/ 的/ 开销/ 尽管/ 描述/ 了/ 部署/ 者/ 所/ 关注/ 的/ 要点/ ,/ 但是/ 却/ 无法/ 直接/ 将/ 具体/ 的/ 计算/ 复杂度/ 、/ 存储/ 复杂度/ 等/ 参数/ 与/ 现实/ 中/ ISP/ 的/ 部署/ 支出/ 联系/ 起来/ ./ 总而言之/ ,/ 目前/ 域间/ 源地址/ 验证/ 的/ 评价/ 研究/ 主要/ 存在/ 两个/ 问题/ ./ 一是/ 指标体系/ 较为/ 混乱/ ,/ 不同/ 的/ 方法/ 采取/ 不同/ 的/ 指标/ 和/ 参数/ 完成/ 自身/ 的/ 评价/ ,/ 方法/ 之间/ 难以/ 横向/ 比较/ ./ 二是/ 现有/ 指标/ 无法/ 或者/ 难以描述/ 部署/ 实体/ (/ ISP/ )/ 的/ 个体/ 诉求/ ,/ 这/ 就/ 造成/ 了/ 即便/ 依照/ 这些/ 指标/ 进行/ 设计/ 、/ 并且/ 指标/ 十分/ 优秀/ 的/ 方法/ ,/ 也/ 可能/ 无法/ 得到/ ISP/ 的/ 认可/ 、/ 难以/ 在/ 实际/ 网络/ 中/ 得到/ 部署/ 应用/ ./ 因此/ ,/ 我们/ 需要/ 统一/ 的/ 、/ 能够/ 描述/ ISP/ 利益/ 诉求/ 的/ 可/ 部署/ 性/ 评价/ 指标/ ,/ 来/ 促进/ 方法/ 设计/ 的/ 研究/ 和/ 方法/ 在/ 实际/ 中/ 的/ 部署/ ./ 3/ 评价/ 指标/ 3.1/ 互联网/ 服务提供商/ 的/ 部署/ 诉求/ 为了/ 设计/ 切合实际/ 的/ 评价/ 指标/ ,/ 我们/ 在/ 北美/ 网络/ 运营/ 组/ ①/ 中/ 调研/ 了/ 实际/ 网络/ 的/ 运营/ 人员/ ,/ 考察/ 其/ 在/ 部署/ 和/ 运维/ 源地址/ 验证/ 方法/ 时/ 最/ 关心/ 的/ 指标/ ,/ 归纳起来/ 主要/ 包括/ 以下/ 3/ 点/ (/ 调研/ 全文/ 见/ ②/ ②/ )/ :/ (/ 1/ )/ 部署/ 收益/ ./ ISP/ 是/ 以/ 经济/ 利益/ 为/ 驱动/ 的/ 市场主体/ ,/ 其/ 部署/ 新/ 技术/ 的/ 动力/ 是/ 追求/ 潜在/ 的/ 经济/ 利益/ ,/ 而/ 非/ 单纯/ 地为/ 互联网/ 整体/ 做/ 贡献/ ./ 因此/ ,/ 部署/ 源地址/ 验证/ 技术/ 一定/ 要/ 给/ 该/ ISP/ 带来/ 额外/ 的/ 收益/ ./ (/ 2/ )/ 部署/ 开销/ ./ 新/ 技术/ 的/ 部署/ 和/ 应用/ 必然/ 带来/ 新/ 的/ 开销/ ./ 此/ 开销/ 包含/ 配置/ 维护/ 开销/ ;/ 如果/ 新/ 的/ 开销/ 无法/ 被/ 当前/ 设备/ 所/ 支持/ (/ 如/ 存储空间/ 不足/ 、/ 计算资源/ 不足/ 等/ )/ ,/ 还/ 需要/ 对/ 设备/ 的/ 软件/ 甚至/ 硬件/ 进行/ 升级/ ,/ 造成/ 额外/ 的/ 经济/ 支出/ ./ (/ 3/ )/ 运维/ 风险/ ./ 源地址/ 验证/ 方法/ 一般/ 会/ 将/ 所/ 识别/ 出/ 的/ 伪造/ 报文/ 丢弃/ 掉/ ./ 如果/ 源地址/ 验证/ 技术/ 存在/ 假/ 阳性/ ,/ 则/ 会/ 造成/ 部分/ 合法/ 的/ 报文/ 被/ 误判/ 为/ 伪造/ 报文/ 而/ 丢弃/ 掉/ ,/ 导致/ 合法/ 用户/ 的/ 数据传输/ 业务/ 被/ 破坏/ ./ 这样/ 的/ 运维/ 风险/ 可能/ 导致/ 直接/ 或/ 间接/ 的/ 经济损失/ ,/ 经济损失/ 往往/ 是/ ISP/ 无法忍受/ 的/ ./ 我们/ 将/ ISP/ 的/ 诉求/ 进行/ 抽象/ ,/ 给出/ 3/ 项/ 评价/ 指/ 3.2/ 评价/ 指标/ 的/ 定义/ 标/ ,/ 定义/ 如下/ ./ 3.2/ ./ 1/ 部署/ 收益/ 定义/ 1/ ./ 一个/ 方法/ 的/ 部署/ 收益/ 是/ 指当/ 一个/ 自治/ 域/ 部署/ 了/ 这个/ 方法/ 后/ ,/ 其/ 受到/ 的/ 伪造/ 攻击/ 中/ 伪造/ 报文/ 的/ 减少/ 比率/ 的/ 增量/ 的/ 期望/ ./ 为了/ 形式化/ 描述/ 该/ 定义/ ,/ 我们/ 定义/ 如下/ 符号/ (/ 表/ 1/ )/ ./ 符号/ V/ 互联网/ 节点/ (/ 自治/ 域/ )/ 的/ 集合/ E/ 互联网/ 边/ (/ 自治/ 域/ 邻接/ 关系/ )/ 的/ 集合/ G/ 互联网/ 的/ 域间/ 拓扑/ ,/ 又/ 作/ G/ (/ V/ ,/ E/ )/ G/ / f/ 所/ 考虑/ 的/ 域间/ 源地址/ 验证/ 方法/ D/ 已经/ 部署/ 了/ f/ 的/ 节点/ 的/ 集合/ N/ 尚未/ 部署/ f/ 的/ 节点/ 的/ 集合/ ,/ 显然/ N/ =/ V/ -/ Dn/ 一个/ 自治/ 域/ 节点/ ,/ n/ ∈/ V/ 基于/ 以上/ 符号/ ,/ 考虑/ 一个/ 尚未/ 部署/ 方法/ f/ 的/ 节点/ n/ ∈/ N/ ,/ 其/ 部署/ 收益/ 的/ 函数/ 形式/ 为/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ./ 假设/ 在/ 某次/ 伪造/ 攻击/ 中/ ,/ 全球/ 网络攻击/ n/ 的/ 伪造/ 报文/ 的/ 集合/ 为/ attn/ ./ 由于/ D/ 中/ 的/ 节点/ 部署/ 了/ f/ 而/ 过滤/ 掉/ 了/ 一些/ 伪造/ 报文/ ,/ 设/ 被/ D/ 过滤/ 掉/ 的/ 伪造/ 报文/ 的/ 集合/ 为/ attn/ ,/ D/ ;/ 而/ 当/ n/ 也/ 部署/ 了/ f/ 之后/ ,/ 部署/ 节点/ 集/ 变为/ D/ ∪/ {/ n/ }/ ,/ 其/ 过滤/ 掉/ 的/ 的/ 伪造/ 报文/ 的/ 集合/ 为/ attn/ ,/ D/ ∪/ {/ n/ }/ ./ 相应/ 地/ ,/ 被/ D/ 和/ D/ ∪/ {/ n/ }/ 过滤/ 掉/ 的/ 伪造/ 报文/ 的/ 比率/ 分别/ 为/ reducen/ ,/ D/ =/ attn/ ,/ D/ // attn/ 和/ reducen/ ,/ D/ ∪/ {/ n/ }/ =/ attn/ ,/ D/ ∪/ {/ n/ }/ // attn/ ./ 部署/ 收益/ 表达/ 的/ 是/ “/ 减少/ 比率/ 的/ 增量/ ”/ ,/ 即/ reducen/ ,/ D/ ∪/ {/ n/ }/ -/ reducen/ ,/ D/ ,/ 也/ 即/ “/ 比/ 之前/ 更好/ 了/ 多少/ ”/ ,/ 或者/ “/ 增加/ 的/ 收益/ 是/ 多少/ ”/ ,/ 而/ 这/ 也/ 恰恰/ 是/ ISP/ 所/ 关注/ 的/ ./ 进一步/ 地/ ,/ 我们/ 将/ 部署/ 收益/ 定义/ 为/ 减少/ 比率/ 的/ 增量/ 的/ 期望/ 来/ 消除/ 在/ 具体/ 的/ 网络攻击/ 个体/ 之间/ 的/ 差异/ ,/ 也/ 即/ 统计/ 意义/ 上/ 的/ 平均值/ ./ 根据/ 期望/ 的/ 线性/ 特性/ ,/ 部署/ 收益/ 的/ 表达式/ 如下/ (/ 其中/ E/ [/ x/ ]/ 表示/ 变量/ x/ 的/ 期望/ )/ :/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ E/ [/ reducen/ ,/ D/ ∪/ {/ n/ }/ ]/ -/ 3.2/ ./ 2/ 部署/ 开销/ 定义/ 2/ ./ 一个/ 方法/ 的/ 部署/ 开销/ 是/ 指/ ,/ 在/ 当前/ 网络设备/ 功能/ 和/ 资源/ 的/ 限制/ 下/ ,/ 部署/ 此/ 方法/ 给/ ISP/ 带来/ 的/ 额外/ 开销/ 的/ 离散/ 度量/ ./ ①/ ②/ Page5/ 具体地说/ ,/ 部署/ 开销/ 是/ 传统/ 开销/ (/ 计算/ 开销/ 、/ 存储/ 开销/ 、/ 网络/ 开销/ 等/ )/ 的/ 阶梯/ 函数/ ,/ 其/ 取值/ 分为/ 4/ 个/ 等级/ :/ (/ L0/ )/ 不/ 产生/ 任何/ 投资/ 或/ 运维/ 开销/ ,/ (/ L1/ )/ 只/ 产生/ 配置/ 维护/ 开销/ ,/ (/ L2/ )/ 只/ 产生/ 软件/ 或/ 固件/ 的/ 更新/ 开销/ 以及/ 可能/ 的/ 配置/ 维护/ 开销/ ,/ (/ L3/ )/ 产生/ 硬件/ 更新/ 开销/ 以及/ 可能/ 的/ 软/ 固件/ 开销/ 和/ 配置/ 维护/ 开销/ ./ 显然/ ,/ 对/ ISP/ 来说/ ,/ 4/ 个/ 等级/ 的/ 经济/ 支出/ 依次/ 递增/ ./ L0/ 是/ 基准线/ ,/ 实际上/ 不/ 存在/ “/ 不/ 做/ 任何/ 事情/ 就/ 可以/ 完成/ 源地址/ 验证/ ”/ 的/ 方法/ ./ 开销/ 为/ L1/ 的/ 方法/ 充分利用/ 了/ 现有/ 路由器/ 的/ 功能/ 和/ 资源/ ,/ 通过/ 配置/ 的/ 更新/ 和/ 维护/ 即可/ 实现/ ./ 开销/ 为/ L2/ 的/ 方法/ 的/ 计算/ 和/ 存储/ 等/ 需求/ 可以/ 利用/ 现有/ 路由器/ 的/ 硬件资源/ 来/ 实现/ ,/ 但/ 需要/ 更新/ 软件/ 或/ 固件/ 来/ 增加/ 或/ 优化/ 某些/ 功能/ ,/ 一般/ 需要/ 投入/ 开发/ 和/ 测试/ 新/ 的/ 软/ 固件/ 映像/ ./ 开销/ 为/ L3/ 的/ 方法/ 的/ 计算/ 和/ 存储/ 开销/ 无法/ 通过/ 当前/ 的/ 路由器/ 硬件资源/ 来/ 实现/ ,/ 需要/ 升级/ 硬件/ ,/ 从而/ 造成/ 购买/ 新/ 设备/ 以及/ 更换/ 或/ 添加/ 设备/ 的/ 投资/ 开销/ ./ 需要/ 说明/ 的/ 是/ ,/ 如果/ 升级/ 硬件/ 仍然/ 无法/ 满足/ 方法/ 的/ 需求/ ,/ 则/ 该/ 方法/ 是/ 无法/ 在/ 现实/ 中/ 得到/ 实现/ 的/ ,/ 因此/ 也/ 无法/ 给/ ISP/ 带来/ 部署/ 开销/ 的/ 问题/ ./ 本文/ 不/ 对/ 此类/ 方法/ 进行/ 评价/ ./ 下式/ 为/ 方法/ 的/ 部署/ 开销/ 函数/ 的/ 自然语言/ 描述/ ,/ 我们/ 将/ 在/ 模型/ 中对式/ 中/ 各项/ 条件/ 进行/ 完整/ 的/ 形式化/ 表达/ ./ cost/ (/ f/ )/ =/ L0/ ,/ 当/ 不/ 需要/ 做/ 任何/ 改变/ 烄/ L1/ ,/ 当/ 传统/ 开销/ 可/ 通过/ 更新/ 配置/ 实现/ 烅/ L2/ ,/ 当/ 传统/ 开销/ 可/ 通过/ 更新/ 软/ 固件/ 及/ 配置/ 实现/ L3/ ,/ 烆/ 当/ 传统/ 开销/ 只有/ 更新/ 硬件/ 才能/ 实现/ 3.2/ ./ 3/ 运维/ 风险/ 定义/ 3/ ./ 一个/ 方法/ 的/ 运维/ 风险/ 是/ 该/ 方法/ 的/ 时/ 均/ 假/ 阳性率/ ,/ 也/ 就是/ 在/ 长期/ 运行/ 过程/ 中/ 方法/ 错误/ 地/ 过滤/ 掉/ 合法/ 报文/ 的/ 平均/ 比率/ ./ 设在/ n/ 部署/ 了/ f/ 之后/ 的/ 相当/ 长/ 的/ 一段时间/ 内/ ,/ 经过/ n/ 的/ 合法/ 报文/ 的/ 集合/ 为/ legn/ ,/ 而/ 被/ n/ 判断/ 为/ 伪造/ 且/ 被/ 丢弃/ 掉/ 的/ 报文/ 的/ 集合/ 为/ disn/ ,/ 那么/ 产生/ 的/ 假/ 阳性率/ 即运维/ 风险/ 就是/ risk/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ legn/ ∩/ disn/ // legn/ ./ 运维/ 风险/ 沿用/ 了/ 传统/ 指标/ 中/ 的/ 假/ 阳性率/ 的/ 概念/ ,/ 但/ 却/ 与/ 传统/ 的/ 假/ 阳性率/ 有/ 两点/ 重要/ 的/ 不同/ :/ (/ 1/ )/ 时间/ 维度/ ./ 传统/ 的/ 假/ 阳性率/ 其实/ 描述/ 的/ 是/ 方法/ 的/ “/ 过滤/ 时假/ 阳性率/ ”/ ,/ 对于/ 如下/ 两类/ 方法/ 不/ 作/ 区分/ :/ 第/ 1/ 类/ 方法/ 是/ ,/ 不管/ 是否/ 正在/ 发生/ 攻击/ ,/ 过滤/ 机制/ 一直/ 开启/ ,/ 假/ 阳性/ 在/ 过滤/ 时/ 一直/ 存在/ ;/ 第/ 2/ 类/ 方法/ 是/ ,/ 配合/ 攻击/ 检测/ 机制/ ,/ 仅当/ 攻击/ 发生/ 时/ 开启/ 过滤/ ./ 而/ 本文/ 所/ 定义/ 的/ 运维/ 风险/ 从/ 长期/ 的/ 运维/ 时间/ 内来/ 观察/ 假/ 阳性率/ ,/ 显然/ 第/ 2/ 类/ 的/ 方法/ 要/ 具有/ 更/ 低/ 的/ 运维/ 风险/ ,/ 更/ 符合/ ISP/ 的/ 实际/ 诉求/ ./ (/ 2/ )/ 空间/ 维度/ ./ 一个/ ISP/ 可能/ 覆盖/ 很大/ 的/ 地理/ 范围/ 和/ 很多/ 的/ 子网/ ,/ 而/ 网络攻击/ 一般/ 只/ 针对/ 一个/ 或/ 几个/ 子网/ ./ 这样/ 看来/ ,/ 仅/ 对/ 遭受/ 攻击/ 的/ 子网/ 前缀/ 开启/ 过滤/ 、/ 而/ 对/ 其他/ 的/ 前缀/ 不/ 进行/ 过滤/ 可以/ 将/ 假/ 阳性率/ 控制/ 在/ 一个/ 较/ 小/ 的/ 范围/ ,/ 对/ ISP/ 来说/ 具有/ 更/ 低/ 的/ 风险/ ./ 传统/ 的/ 假/ 阳性率/ 只/ 描述/ “/ 过滤/ 处假/ 阳性率/ ”/ ,/ 对于/ 如下/ 两类/ 方法/ 不/ 作/ 区分/ :/ 第/ 1/ 类/ 方法/ 是/ ,/ 无论/ 遭受/ 攻击/ 的/ 是/ 哪些/ 子网/ ,/ 对/ 整个/ 域/ 的/ 流量/ 都/ 开启/ 过滤/ ;/ 第/ 2/ 类/ 方法/ 是/ ,/ 仅/ 对/ 遭受/ 攻击/ 的/ 子网/ 开启/ 过滤/ ,/ 对/ 其他/ 子网/ 不/ 过滤/ ./ 本文/ 所/ 定义/ 的/ 运维/ 风险/ 在/ 计算/ 中/ 考虑/ 到/ 了/ 第/ 2/ 类/ 方法/ ,/ 其运维/ 风险/ 低于/ 第/ 1/ 类/ 方法/ ,/ 体现/ 出/ 了/ ISP/ 的/ 实际/ 诉求/ ./ 3.3/ 评价/ 指标/ 的/ 合理性/ 验证/ 本文/ 通过/ 对/ ISP/ 的/ 调研/ 总结/ 提炼出/ 可/ 部署/ 性/ 的/ 3/ 项/ 评价/ 指标/ ,/ 这是/ 一个/ 逆向/ 推导/ 的/ 过程/ ./ 下面/ ,/ 我们/ 直接/ 从/ ISP/ 的/ 利润/ 公式/ 正向/ 推导/ 来/ 验证/ 所/ 提出/ 的/ 评价/ 指标/ 的/ 合理性/ ./ 在/ 经济学/ 中/ ,/ 一个/ 企业/ 的/ 利润/ 等于/ 其/ 总/ 的/ 收益/ 减去/ 总/ 的/ 成本/ [/ 27/ ]/ ,/ 即/ PROFIT/ =/ TotalREVENUE/ -/ TotalCOST/ ./ ISP/ 的/ 总体/ 收益/ 和/ 总体/ 成本/ 的/ 构成/ 可能/ 非常复杂/ ,/ 而/ 我们/ 只/ 关心/ “/ 部署/ 域间/ 源地址/ 验证/ 方法/ ”/ 这/ 一个/ 业务/ 带来/ 的/ 利润/ 的/ 增量/ ,/ 即/ 其中/ ,/ Δ/ PROFIT/ 是/ ISP/ 要/ 最大化/ 的/ 目标/ ,/ Δ/ REVENUE/ 为/ 部署/ 该/ 方法/ 为/ 该/ ISP/ 带来/ 的/ 收益/ 增量/ ,/ Δ/ COST/ 为/ 部署/ 开销/ 的/ 增量/ ./ 下面/ 我们/ 对/ Δ/ REVENUE/ 和/ Δ/ COST/ 进行/ 展开/ ./ Δ/ REVENUE/ 包含/ 两个/ 部分/ ,/ 一是/ 通过/ 为/ 客户/ 提供/ 更加/ 安全/ 的/ 数据传输/ 服务/ 而/ 带来/ 的/ 收入/ 增加/ ,/ 记/ 作/ Δ/ REVENUE/ +/ ;/ 另/ 一部分/ 是/ 方法/ 的/ 假/ 阳性/ 造成/ 的/ 对/ 客户/ 的/ 数据传输/ 的/ 服务质量/ 的/ 下降/ ,/ 从而/ 导致/ 的/ 客户/ 流失/ 和/ 收入/ 减少/ ,/ 记/ 作/ Δ/ REVENUE/ -/ ./ 那么/ ,/ Δ/ REVENUE/ =/ Δ/ REVENUE/ +/ -/ Δ/ REVENUE/ -/ ./ Δ/ REVENUE/ +/ 与/ 部署/ 所/ 带来/ 的/ 安全性/ 的/ 增量/ 有关/ ,/ 具体/ 的/ 说/ ,/ 就是/ 与/ 伪造/ 攻击/ 中/ 伪造/ 报文/ 减少/ 比率/ 的/ 增量/ (/ 也/ 就是/ 部署/ 收益/ benefit/ )/ 呈/ 正/ 相关/ ,/ 即弱/ 递增/ 函数/ ,/ 记/ 为/ Δ/ REVENUE/ +/ =/ Rev/ +/ (/ benefit/ )/ ./ 类似/ 地/ ,/ Δ/ REVENUE/ -/ 是/ 方法/ 长期/ 运维/ 风险/ (/ risk/ )/ 的/ 弱/ 递增/ 函数/ ,/ 记/ 为/ Δ/ REVENUE/ -/ =/ Rev/ -/ (/ risk/ )/ ./ 而/ 开销/ 的/ 增量/ Δ/ COST/ 就是/ 方法/ 总/ 的/ 部署/ 开/ Page6/ 销/ ./ 我们/ 所/ 定义/ 的/ 部署/ 开销/ cost/ 是/ 指/ 一台/ 边界/ 路由器/ 上/ 的/ 开销/ ,/ 并/ 没有/ 考虑/ 部署/ 自治/ 域/ 自身/ 的/ 属性/ (/ 如/ 自治/ 域/ 的/ 大小/ 、/ 所/ 需/ 部署/ 的/ 路由器/ 的/ 数量/ 等/ )/ ,/ 因此/ ,/ Δ/ COST/ 并/ 不是/ cost/ 本身/ ,/ 而是/ 其弱/ 递增/ 函数/ ,/ 记/ 作/ Δ/ COST/ =/ Cost/ (/ cost/ )/ ./ 因此/ ,/ 部署/ 源地址/ 验证/ 方法/ 给/ ISP/ 带来/ 的/ 利润/ 增量/ 为/ Δ/ PROFIT/ =/ Rev/ +/ (/ benefit/ )/ -/ Rev/ -/ (/ risk/ )/ -/ Cost/ (/ cost/ )/ ./ 从/ 上式/ 可以/ 看出/ ,/ ISP/ 的/ 利润/ 增量/ 是/ 我们/ 提出/ 的/ 3/ 项/ 评价/ 指标/ 的/ 函数/ ,/ 这/ 也/ 验证/ 了/ 所/ 提出/ 的/ 评价/ 指标/ 的/ 合理性/ ./ 但/ 值得注意/ 的/ 是/ ,/ 我们/ 这里/ 并/ 没有/ 给出/ 各个/ 函数/ 的/ 具体/ 形式/ —/ —/ —/ 实际上/ ,/ 对于/ 不同/ 的/ ISP/ ,/ 函数/ 的/ 形式/ 或/ 其中/ 的/ 参数/ 可能/ 是/ 不同/ 的/ ;/ 即使/ 对于/ 同一个/ ISP/ ,/ 随着/ 时间/ 的/ 变化/ 其/ 函数/ 也/ 可能/ 变化/ ./ 在/ 这里/ ,/ 我们/ 仅/ 说明/ Rev/ +/ 、/ Rev/ -/ 和/ Cost/ 分别/ 是/ benefit/ 、/ risk/ 和/ cost/ 的/ 弱/ 递增/ 函数/ ./ 4/ 评价/ 模型/ 下面/ 分别/ 介绍/ 3/ 项/ 评价/ 指标/ 的/ 评价/ 模型/ ./ 4.1/ 部署/ 收益/ 的/ 评价/ 模型/ 首先/ 形式化/ 定义/ IP/ 报文/ ./ 由于/ 本文/ 主要/ 研究/ 域间/ 场景/ ,/ 因此/ 定义/ 的/ 粒度/ 以/ 自治/ 域/ 为/ 基本/ 单位/ ./ 定义/ 4/ ./ 一个/ 报文/ 是/ 一个/ 三元组/ a/ :/ (/ s/ ,/ d/ )/ ,/ 其中/ a/ 为/ 报文/ 发送者/ 所在/ 的/ 自治/ 域/ ;/ s/ 为/ 报文/ 的/ 源地址/ 所属/ 的/ 自治/ 域/ ,/ 也/ 即/ 报文/ 的/ 源/ 自治/ 域/ ;/ d/ 为/ 报文/ 的/ 目的/ 地址/ 所属/ 的/ 自治/ 域/ ,/ 也/ 即/ 报文/ 的/ 目的/ 自治/ 域/ ./ 当/ 不/ 关心/ 报文/ 的/ 发送者/ 时/ ,/ 报文/ 可以/ 简记/ 作/ (/ s/ ,/ d/ )/ ./ 定理/ 1/ ./ 一个/ 伪造/ 报文/ a/ :/ (/ s/ ,/ d/ )/ 属于/ 域间/ 源地址/ 验证/ 范围/ 的/ 充要条件/ 是/ a/ ≠/ s/ 且/ a/ ≠/ d/ ./ 证明/ ./ 充分性/ ./ 由于/ a/ ≠/ d/ ,/ 报文/ a/ :/ (/ s/ ,/ d/ )/ 是/ 跨域/ 传输/ 的/ ,/ 可能/ 经过/ 自治/ 域/ 边界/ 路由器/ 对/ 出域/ 和/ 入域/ 流量/ 的/ 检查/ ;/ 其次/ ,/ 由于/ a/ ≠/ s/ ,/ 报文/ 所/ 携带/ 源地址/ 不/ 属于/ 其/ 发送者/ 所属/ 的/ 自治/ 域/ ,/ 因此/ ,/ 自治/ 域/ 粒度/ 的/ 源地址/ 检查/ 可能/ 识别/ 此/ 伪造/ ./ 因此/ ,/ 此/ 报文/ 属于/ 域间/ 源地址/ 验证/ 的/ 范围/ ./ 必要性/ ./ 由于/ 域间/ 源地址/ 验证/ 只/ 识别/ 自治/ 域/ 粒度/ 的/ 源地址/ 伪造/ ,/ 同一/ 自治/ 域/ 内/ 的/ 伪造/ 无法/ 识别/ ,/ 因此/ 要求/ a/ ≠/ s/ ;/ 其次/ ,/ 域间/ 源地址/ 验证/ 技术/ 部署/ 在/ 自治/ 域/ 的/ 边界/ 路由器/ 上/ ,/ 对/ 穿越/ 自治/ 域/ 边界/ 的/ 报文/ 进行/ 源地址/ 检查/ ,/ 因此/ 要求/ 此/ 报文/ 属于/ 跨域/ 通信/ ,/ 因此/ a/ ≠/ d/ ./ 下文/ 中/ ,/ 如/ 无/ 特殊/ 说明/ ,/ 当/ 我们/ 提到/ 伪造/ 报文/ a/ :/ (/ s/ ,/ d/ )/ 时/ ,/ 默认/ 其/ 满足/ a/ ≠/ s/ 且/ a/ ≠/ d/ ./ 在/ 之前/ 的/ 章节/ 中/ ,/ 我们/ 介绍/ 了/ 利用/ 伪造/ 源地址/ 发起/ 的/ 两种/ DoS/ 攻击/ ,/ 即/ 直接/ 的/ (/ 即/ 针对/ 目的/ 地址/ 的/ )/ 攻击/ d/ -/ DoS/ 以及/ 反射式/ 的/ (/ 即/ 针对/ 源地址/ 的/ )/ 攻击/ s/ -/ DoS/ ./ 尽管/ 两种/ 攻击/ 的/ 形式/ 有所不同/ ,/ 但/ 在/ 表示/ 方式/ 上/ 却/ 可以/ 做到/ 统一/ ./ 我们/ 用/ 如下/ 3/ 个/ 符号/ 代表/ 攻击/ 中/ 的/ 3/ 种/ 角色/ (/ 表/ 2/ )/ :/ 符号/ a/ 伪造/ 报文/ 的/ 发送者/ :/ 它/ 可能/ 是/ 攻击者/ 本身/ (/ attacker/ )/ ti/ 此处/ ,/ 我们/ 定义/ 报文/ 的/ 另/ 一种/ 表达形式/ :/ “/ 攻击/ 报文/ ”/ ./ 需要/ 说明/ 的/ 是/ ,/ 这里/ 定义/ 的/ 攻击/ 不/ 包括/ s/ -/ DoS/ 中/ 从/ 反射/ 点/ 反射/ 出/ 的/ 报文/ ,/ 而/ 只/ 包括/ 由/ 攻击者/ 或/ 攻击者/ 所/ 控制/ 的/ 主机/ 发出/ 的/ 报文/ ./ 定义/ 5/ ./ 一个/ 攻击/ 报文/ 被/ 定义/ 为/ 如下/ 形式/ :/ (/ a/ ,/ i/ ,/ t/ )/ ,/ 其中/ a/ 为/ 攻击者/ 即/ 报文/ 的/ 发送者/ ,/ i/ 为/ 无辜者/ ,/ t/ 为/ 攻击/ 目标/ ./ 根据/ d/ -/ DoS/ 和/ s/ -/ DoS/ 的/ 定义/ ,/ 显然/ ,/ 当/ 攻击/ 为/ d/ -/ DoS/ 时/ ,/ (/ a/ ,/ i/ ,/ t/ )/ =/ a/ :/ (/ i/ ,/ t/ )/ ;/ 当/ 攻击/ 为/ s/ -/ DoS/ 时/ ,/ (/ a/ ,/ i/ ,/ t/ )/ =/ a/ :/ (/ t/ ,/ i/ )/ ./ 下面/ 定义/ 报文/ 的/ 自治/ 域/ 粒度/ 的/ 转发/ 路径/ ,/ 在/ 本文/ 环境/ 下/ 简称/ 为/ 报文/ 的/ 转发/ 路径/ ./ 定义/ 6/ ./ 报文/ a/ :/ (/ s/ ,/ d/ )/ 的/ 转发/ 路径/ 是/ 指/ 报文/ 在/ 不/ 被/ 丢弃/ 的/ 情况/ 下/ ,/ 从/ 发送/ 端/ 自治/ 域/ 到/ 目的/ 自治/ 域/ 所/ 经过/ 的/ 自治/ 域/ 序列/ ,/ 记作/ Path/ [/ a/ :/ (/ s/ ,/ d/ )/ ,/ G/ / ]/ ,/ 简/ 写作/ Path/ [/ a/ :/ (/ s/ ,/ d/ )/ ]/ 或者/ Path/ [/ a/ →/ d/ ]/ ./ 定义/ 7/ ./ 我们/ 说/ 自治/ 域/ n/ 在/ a/ :/ (/ s/ ,/ d/ )/ 的/ 转发/ 路径/ 上当/ 且/ 仅/ 当/ n/ 是/ Path/ [/ a/ :/ (/ s/ ,/ d/ )/ ]/ 中/ 的/ 一个/ 节点/ ,/ 记作/ n/ ∈/ Path/ [/ a/ :/ (/ s/ ,/ d/ )/ ]/ ./ 定义/ 8/ ./ 方法/ f/ 的/ 过滤/ 函数/ 是/ 指/ ,/ 给定/ 一个/ 部署/ 节点/ n/ 并/ 假设/ n/ 已经/ 部署/ f/ ,/ 在/ 不/ 考虑/ 报文/ a/ :/ (/ s/ ,/ d/ )/ 在/ 转发/ 时/ 是否/ 经过/ n/ 的/ 情况/ 下/ ,/ n/ 对/ 该报/ 文/ 是否/ 为/ 伪造/ 报文/ 的/ 判断/ 函数/ ./ 其/ 形式/ 为/ filter/ (/ f/ ,/ G/ / ,/ n/ ,/ a/ :/ (/ s/ ,/ d/ )/ )/ ./ 当判/ 为/ 伪造/ ,/ 函数/ 返回/ 1/ ;/ 否则/ ,/ 返回/ 0/ ./ 上面/ 定义/ 的/ 过滤/ 函数/ 不/ 考虑/ 报文/ 转发/ 路径/ 、/ 部署/ 节点/ 集合/ 等/ 实际/ 情况/ ,/ 因此/ 无法/ 描述/ 在/ 给定/ 部署/ 节点/ 集/ 的/ 情况/ 下/ 该报/ 文/ 是否/ 真的/ 会/ 被/ 路径/ 上/ 的/ 部署/ 点/ 丢弃/ 掉/ ./ 为此/ ,/ 定义/ 丢弃/ 函数/ 如下/ ./ Page7/ 定义/ 9/ ./ 给定/ 方法/ f/ 、/ 带有/ 路由/ 信息/ 的/ 拓扑/ G/ / 、/ 部署/ 点/ 集合/ D/ 和/ 报文/ a/ :/ (/ s/ ,/ d/ )/ ,/ 判断/ 该报/ 文在/ 其/ 转发/ 路径/ 上/ 是否/ 会/ 被/ 部署/ 节点/ 识别/ 为/ 伪造/ 而/ 被/ 丢弃/ ./ 当/ 被/ 丢弃/ ,/ 函数/ 返回/ 1/ ;/ 否则/ ,/ 返回/ 0/ ./ 其/ 函数/ 形式/ 为/ discard/ (/ f/ ,/ G/ / ,/ D/ ,/ a/ :/ (/ s/ ,/ d/ )/ )/ ./ 给定/ 过滤/ 函数/ ,/ 丢弃/ 函数/ 的/ 计算方法/ 如下/ (/ 其中/ ,/ sgn/ (/ )/ 是/ 符号/ 函数/ [/ 28/ ]/ )/ :/ discard/ (/ f/ ,/ G/ / ,/ D/ ,/ a/ :/ (/ s/ ,/ d/ )/ )/ =/ sgn/ ∑/ n/ ∈/ (/ D/ ∩/ Path/ [/ a/ :/ (/ s/ ,/ d/ )/ ]/ )/ filter/ (/ f/ ,/ G/ / ,/ n/ ,/ a/ :/ (/ s/ ,/ d/ 为了/ 描述/ 部署/ 收益/ 的/ 期望值/ ,/ 我们/ 假设/ 互联网/ 伪造/ 攻击/ 服从/ 某种/ 概率分布/ (/ 但/ 并/ 不/ 对/ 具体/ 服从/ 何种/ 分布/ 做/ 假设/ )/ ,/ 在/ 该/ 分布/ 下/ ,/ 每个/ 自治/ 域/ 都/ 有/ 一定/ 的/ 成为/ 攻击者/ 、/ 无辜者/ 和/ 攻击/ 目标/ 的/ 概率/ ./ 对于/ 自治/ 域/ n/ ,/ 其/ 成为/ 攻击者/ 、/ 无辜者/ 和/ 攻击/ 目标/ 的/ 概率/ 分别/ 记作/ PAn/ 、/ PIn/ 和/ PTn/ ./ 本文/ 假设/ 这/ 3/ 个/ 概率/ 的/ 分布/ 是/ 相互/ 独立/ 的/ ,/ 此时/ ,/ E/ [/ reducen/ ,/ D/ ]/ =/ PT/ -/ 1n/ ·/ ∑/ a/ ≠/ n/ ∑/ i/ ≠/ a/ 即/ E/ [/ reducen/ ,/ D/ ]/ =/ 类似/ 地/ ,/ E/ [/ reducen/ ,/ D/ ∪/ {/ n/ }/ ]/ =/ ∑/ a/ ≠/ n/ ∑/ i/ ≠/ a/ 这样/ ,/ 部署/ 开销/ 就/ 可以/ 得到/ 完全/ 展开/ ,/ 如下/ 式/ :/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ ∑/ a/ ≠/ n/ ∑/ i/ ≠/ a/ 至此/ ,/ 我们/ 完成/ 了/ 在/ 部署/ 节点/ 集合/ 为/ D/ 时/ 、/ 非/ 部署/ 点/ n/ 的/ 部署/ 收益/ 的/ 表达/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ./ 然而/ ,/ 我们/ 还/ 需要/ 消除/ 因/ n/ 的/ 个体/ 选取/ 差异/ 造成/ 的/ 收益/ 评价/ 偏见/ ,/ 因此/ 要/ 对/ N/ 中/ 所有/ 节点/ 的/ 部署/ 收益/ 进行/ 平均/ ./ 我们/ 把/ 平均/ 收益/ 记作/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ N/ )/ ,/ 由于/ N/ 与/ D/ 互为/ 补集/ ,/ 因此/ 可以/ 简/ 写作/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ ./ 在/ 计算/ 平均/ 收益/ 时/ ,/ 由于/ 各个/ 自治/ 域/ 遭受/ 伪造/ 攻击/ 的/ 概率/ 不同/ ,/ 因此/ 我们/ 采用/ 加权/ 平均/ 来/ 体现/ 差别/ ,/ 那么/ 平均/ 部署/ 收益/ 的/ 表达式/ 如下/ :/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ =/ 值得/ 说明/ 的/ 是/ ,/ 我们/ 在/ 计算/ 部署/ 收益/ 时/ 涉及/ 到/ 了/ 3/ 个/ 参数/ PAn/ 、/ PIn/ 和/ PTn/ (/ 分别/ 表示/ n/ 成为/ 攻击者/ 、/ 无辜者/ 和/ 攻击/ 目标/ 的/ 概率/ )/ ./ 为了/ 保持/ 评价/ 模型/ 的/ 一般性/ ,/ 我们/ 并/ 不/ 为/ 这/ 3/ 个/ 参数/ 假设/ 任何/ 特定/ 的/ 概率分布/ ,/ 模型/ 的/ 应用/ 者/ 可以/ 根据/ 需要/ 及/ 所能/ 获得/ 的/ 数据/ 设定/ 合适/ 的/ 分布/ ./ 实际/ 的/ 概率分布/ 应当/ 结合/ 网络/ 测量/ 来/ 确定/ :/ 一般/ 情况/ 下/ ,/ 普通用户/ 的/ 计算机/ 比/ 内容/ 提供商/ 的/ 服务器/ 更/ 可能/ 被/ 攻击者/ 利用/ 来/ 发送/ 伪造/ 报文/ (/ 因此/ PAn/ 可能/ 更大/ )/ ,/ 高性能/ 、/ 开放式/ 的/ 服务器/ 比/ 普通用户/ 的/ 计算机/ 更/ 可能/ 被/ 利用/ 作为/ s/ -/ DoS/ 的/ 反射/ 点/ (/ 因此/ PIn/ 可能/ 更大/ )/ ,/ 而/ 承载/ 重要/ 服务/ 的/ 服务器/ 比/ 普通用户/ 的/ 计算机/ 更/ 可能/ 成为/ 攻击/ 的/ 目标/ (/ 因此/ PTn/ 可能/ 更大/ )/ ./ 然而/ ,/ 在/ 没有/ 足够/ 的/ 实际/ 数据/ 或者/ 只/ 需要/ 进行/ 粗略/ 的/ 评价/ 时/ ,/ 也/ 可以/ 采用/ 简单/ 的/ 概率分布/ ,/ 比如/ ,/ IP地址/ 意义/ 上/ 的/ 均/ 一/ 的/ 概率/ (/ 这/ 也/ 是/ 本/ 领域/ 最为/ 常用/ 的/ 假设/ 分布/ )/ ,/ 此时/ ,/ PAn/ =/ PIn/ =/ PTn/ =/ sizen/ ,/ 其中/ sizen/ 是/ n/ 的/ 地址/ 空间/ 大小/ 占/ 整个/ 可/ 路由/ 地址/ 空间/ 大小/ 的/ 比率/ ./ 平均/ 部署/ 收益/ 是/ 在/ 给定/ 部署/ 节点/ 集合/ D/ 的/ 前提/ 下/ 计算/ 出/ 的/ ,/ 为了/ 消除/ D/ 的/ 选取/ 所/ 带来/ 的/ 偏见/ ,/ 我们/ 需要/ 选取/ 不同/ 的/ D/ ./ 如果/ 要/ 选取/ 所有/ 的/ D/ ,/ 则/ 共有/ 2/ |/ V/ |/ 种/ 取法/ ./ 由于/ 在/ 当今/ 互联网/ 上/ ,/ |/ V/ |/ 的/ 大小/ 大约/ 为/ 4/ 万/ ,/ 选取/ 所有/ D/ 的/ 指数/ 级/ 计算/ 复杂度/ 是/ 无法/ 承受/ 的/ ./ 因此/ 我们/ 需要/ 采取/ 一些/ 近似/ 的/ 办法/ 去/ 评估/ 部署/ 收益/ ./ 基本/ 原则/ 是/ ,/ 选取/ 不同/ 正整数/ k/ (/ 0/ / k/ </ |/ V/ |/ )/ 作为/ D/ 的/ 大小/ ;/ 在/ 这个/ 大小/ 限制/ 下/ ,/ 随机/ 选取/ 节点/ 作为/ D/ 中/ 的/ 节点/ ,/ 算/ 出/ 平均/ 部署/ 收益/ ,/ 并/ 反复/ 多次/ ,/ 对/ 多次/ 的/ 评价/ 部署/ 收益/ 再/ 做/ 平均/ ,/ 作为/ 当前/ 大小/ k/ 下/ 的/ 部署/ 收益/ ;/ 最后/ ,/ 以/ k/ 为/ 横轴/ ,/ 画出/ 不同/ 部署/ 节点/ 集合/ 大小/ 下/ 的/ 部署/ 收益/ 变化/ 曲线/ ,/ 从而/ 完整/ 地/ 近似/ 方法/ f/ 的/ 部署/ 收益/ ,/ 记作/ benefit/ (/ f/ ,/ G/ / )/ ./ 再/ 对/ 不同/ 的/ 互联网/ 拓扑/ G/ / (/ 比如/ 不同/ 年份/ 的/ 拓扑/ )/ 分别/ 绘制/ 相应/ 曲线/ ,/ 比较/ 异同/ 和/ 发展趋势/ ,/ 得到/ benefit/ (/ f/ )/ ./ 4.2/ 部署/ 开销/ 的/ 评价/ 模型/ 首先/ 定义/ 传统/ 开销/ 向量/ ./ 定义/ 10/ ./ 方法/ f/ 的/ 传统/ 开销/ 向量/ 犮/ f/ 的/ 各个/ 分量/ 是/ 其/ 对/ 路由器/ 不同/ 资源/ 的/ 消耗量/ ./ 其/ 形式/ 为/ f/ ,/ cn/ (/ ccf/ ,/ cs/ (/ ccf/ )/ 、/ 存储/ 开销/ (/ cs/ 定义/ 11/ ./ 传统/ 开销/ 常/ 约束/ 向量/ 犆/ 犆/ l/ 是/ 指/ 在/ 当前/ 路由器/ 的/ 条件/ 下/ ,/ 在/ 开销/ 级别/ Ll/ 上/ 对/ 各个/ 传统/ 开销/ 分量/ 的/ 上限/ 限制/ ./ 比如/ ,/ 犆/ 犆/ 1/ 是/ 在/ L1/ 开销/ 级别/ 上/ 的/ 常/ 约束/ 向量/ ,/ 开销/ 为/ L1/ 的/ 方法/ 的/ 各项/ 传统/ 开销/ 分量/ 值/ 都/ 不能/ 超过/ 犆/ 犆/ 1/ 的/ 相应/ 分量/ 值/ ./ 定义/ 12/ ./ 传统/ 开销/ 向量/ 的/ 比较/ 符号/ “/ =/ ”/ 、/ “/ / ”/ 、/ Page8/ 于/ 犮/ 2/ 的/ 相应/ 分量/ 值/ ./ 我们/ 说/ 犮/ 1/ / 犮/ 2/ ,/ 当且/ 仅/ 当/ 犮/ 1/ 的/ 所有/ 分量/ 值/ 都/ 小于/ 或/ 等于/ 犮/ 2/ 的/ 相应/ 分量/ 值/ ;/ 否则/ ,/ 我们/ 说/ 犮/ 1/ / // 犮/ 2/ ./ 部署/ 开销/ 函数/ 的/ 形式化/ 表达/ 如下/ :/ cost/ (/ f/ )/ =/ 其中/ ,/ 0/ =/ 犆/ 犆/ 0/ / 犆/ 犆/ 1/ / 犆/ 犆/ 2/ ./ 下面/ 解释/ 各个/ 分式/ 的/ 具体/ 含义/ :/ L0/ :/ 犆/ 犆/ 0/ 的/ 各个/ 分量/ 均/ 为/ 0/ ,/ 要求/ f/ 的/ 各个/ 传统/ 开销/ 分量/ 都/ 为/ 0/ ,/ 即/ 什么/ 都/ 不/ 做/ ,/ 包括/ 不/ 做/ 配置/ 和/ 维护/ ./ 显然/ 这种/ 方法/ 是/ 不/ 存在/ 的/ ./ L1/ :/ 犆/ 犆/ 1/ 的/ 各个/ 分量/ 是/ 指/ 在/ 只/ 改变/ 现有/ 路由器/ 的/ 配置/ 的/ 前提/ 下/ 可以/ 支持/ 的/ 相应/ 传统/ 开销/ 分量/ 的/ 最大值/ ./ 以/ 过滤/ 规则/ 的/ 存储/ 开销/ 为例/ ,/ CCs/ 由器/ 的/ 功能/ 下/ ,/ 通过/ 配置/ 访问控制/ 列表/ (/ ACL/ )/ 能够/ 支持/ 的/ 用户/ 规则/ 数目/ 的/ 最大值/ ./ L2/ :/ 犆/ 犆/ 2/ 的/ 各个/ 分量/ 是/ 指/ 在/ 只/ 改变/ 现有/ 路由器/ 的/ 软件/ 和/ 固件/ (/ 以及/ 可能/ 的/ 配置/ 改变/ )/ 可以/ 支持/ 的/ 传统/ 开销/ 分量/ 的/ 最大值/ ./ 还/ 以/ 过滤/ 规则/ 的/ 存储/ 开销/ 为例/ ,/ CCs2/ 是/ 在/ 现有/ 路由器/ 的/ 硬件/ 条件/ 下/ ,/ 通过/ 对/ 软件/ 或/ 固件/ 的/ 更新/ 可/ 支持/ 的/ 过滤/ 规则/ 数目/ 的/ 上限/ ./ L3/ :/ 当/ 方法/ f/ 的/ 部署/ 开销/ 犮/ f/ 中/ 存在/ 一个/ 分量/ ,/ 使得/ 该/ 分量/ 大于/ 犆/ 犆/ 2/ 的/ 相应/ 分量/ 时/ ,/ 这个/ 分量/ 无法/ 通过/ 软件/ 、/ 固件/ 和/ 配置/ 来/ 实现/ ,/ 此时/ 需要/ 升级/ 硬件/ 来/ 满足/ 方法/ 在/ 该/ 分量/ 的/ 需要/ ./ 仍以/ 过滤/ 规则/ 的/ 存储/ 开销/ 为例/ ,/ 即使/ 升级/ 算法/ 、/ 软/ 固件/ ,/ 所/ 需/ 的/ 过滤/ 规则/ 数/ 仍/ 超过/ 路由器/ 硬件/ 能力/ ,/ 则/ 需/ 更新/ 硬件/ ./ 部署/ 开销/ 的/ 评价/ 模型/ 中/ 涉及/ 到/ 了/ 一些/ 参数/ ./ L0/ 、/ L1/ 、/ L2/ 和/ L3/ 表示/ 部署/ 开销/ 的/ 级别/ ,/ 由于/ 我们/ 只/ 关心/ 级别/ 的/ 相对/ 关系/ ,/ 其/ 具体/ 取值/ 并/ 不/ 重要/ ,/ 所以/ 我们/ 只/ 规定/ L0/ </ L1/ </ L2/ </ L3/ ./ 传统/ 开销/ 常/ 约束/ 向量/ 犆/ 犆/ l/ 是/ 指/ 在/ 当前/ 路由器/ 的/ 条件/ 下/ ,/ 开销/ 级别/ Ll/ 上/ 对/ 各个/ 传统/ 开销/ 分量/ 的/ 上限/ 限制/ ./ 犆/ 犆/ 0/ 的/ 各个/ 分量/ 均/ 为/ 0/ 是因为/ L0/ 要求/ 不/ 产生/ 任何/ 新/ 的/ 开销/ ./ 而/ 对于/ 犆/ 犆/ 1/ 和/ 犆/ 犆/ 2/ 的/ 各个/ 分量/ ,/ 我们/ 在/ 评价/ 模型/ 中/ 并/ 不/ 设定/ 特定/ 的/ 取值/ ./ 这/ 是因为/ ,/ 随着/ 技术/ 的/ 发展/ ,/ 路由器/ 的/ 软件/ 和/ 硬件/ 的/ 功能/ 和/ 性能/ 都/ 在/ 变化/ ,/ 因此/ L1/ 和/ L2/ 的/ 开销/ 上限/ 也/ 在/ 变化/ ./ 为/ 保持/ 评价/ 模型/ 的/ 一般性/ 意义/ ,/ 我们/ 不能/ 根据/ 今天/ 路由器/ 的/ 形态/ 为/ 犆/ 犆/ 1/ 和/ 犆/ 犆/ 2/ 的/ 各个/ 分量/ 赋值/ —/ —/ —/ 模型/ 的/ 使用者/ 应/ 根据/ 当时/ 的/ 环境/ 为/ 其/ 赋值/ ./ 方法/ 部署/ 开销/ 是/ 各个/ 传统/ 开销/ 分量/ 的/ 阶梯/ 函数/ ,/ 图/ 2/ 举例说明/ 了/ 开销/ 向量/ 包含/ 计算/ 开销/ 和/ 存储/ 开销/ 两个/ 维度/ 时/ 阶梯/ 函数/ 的/ 一个/ 特例/ (/ 高维/ 时/ ,/ 整体/ 空间/ 超过/ 三维/ ,/ 难以/ 画出/ ;/ 为/ 简单/ 示意/ ,/ 以/ 二维/ 向量/ 为例/ )/ ,/ 其中/ 纵轴/ 是/ 部署/ 开销/ 的/ 各个/ 阶梯/ 的/ 取值/ ./ 与/ 部署/ 收益/ 类似/ ,/ 部署/ 开销/ 也/ 应该/ 反映/ 各个/ 自治/ 域/ 部署/ 的/ 平均/ 开销/ ./ 上文/ 所/ 描述/ 的/ 开销/ 是/ 针对/ 每个/ 路由器/ 而言/ 的/ ./ 通常/ ,/ 一个/ ISP/ 的/ 规模/ 越大/ 、/ 边界/ 路由器/ 越/ 多/ 、/ 资本/ 越/ 雄厚/ ./ 我们/ 假设/ 自治/ 域/ 的/ 经济/ 规模/ 和/ 边界/ 路由器/ 的/ 个数/ 成正比/ ,/ 这样/ ,/ 一个/ 自治/ 域/ 的/ 所有/ 路由器/ 都/ 部署/ 的话/ ,/ 其/ 总开销/ 占该/ 自治/ 域/ 的/ 经济总量/ 的/ 比例/ 是/ 近似/ 的/ ./ 因此/ ,/ 方法/ 在/ 一台/ 路由器/ 上/ 的/ 开销/ 反映/ 了/ 在/ 各/ 自治/ 域/ 的/ 平均/ 开销/ ./ 本文/ 对/ 部署/ 开销/ 的/ 各个/ 级别/ 的/ 定义/ 描述/ 了/ ISP/ 对/ 技术/ 的/ 实际/ 开销/ 的/ 主要/ 诉求/ ./ 在/ 各个/ 级别/ 内部/ 还/ 可以/ 对/ 方法/ 的/ 开销/ 再度/ 进行/ 细分/ ./ 比如/ ,/ 同是/ 仅/ 需要/ 配置/ 更新/ 的/ 方法/ f1/ 和/ f2/ ,/ 如果/ f1/ 占用/ ACL/ 的/ 条目/ 数比/ f2/ 少/ ,/ 则/ 在/ 更/ 细/ 的/ 维度/ 上/ f1/ 优于/ f2/ ./ 为/ 保持/ 理论/ 的/ 简洁/ ,/ 除非/ 特别/ 指出/ ,/ 本文/ 主要/ 考虑/ 开销/ 的/ 4/ 个/ 级别/ 的/ 离散/ 取值/ ,/ 这/ 也/ 反映/ 了/ ISP/ 的/ 主要/ 诉求/ ./ 4.3/ 运维/ 风险/ 的/ 评价/ 模型/ 根据/ 前/ 文/ 对于/ 运维/ 风险/ 的/ 分析/ ,/ 传统/ 的/ 假/ 阳性率/ 描述/ 的/ 是/ “/ 过滤/ 时/ 、/ 过滤/ 处/ ”/ 的/ 假/ 阳性率/ ,/ 即/ 只/ 能够/ 描述/ “/ 不/ 分/ 时空/ ”/ (/ 即/ 一直/ 过滤/ 、/ 对/ 所有/ 流量/ 都/ 过滤/ )/ 的/ 一类/ 方法/ ./ 但/ 实际上/ ,/ 存在/ 一些/ 分时/ 或/ 分空/ 的/ 方法/ ,/ 下面/ 对/ 这/ 几类/ 方法/ 进行/ 定义/ ./ 定义/ 13/ ./ “/ 不/ 分/ 时空/ ”/ 的/ 方法/ 是/ 指/ ,/ 不管/ 是否/ 发生/ 攻击/ 而/ 一直/ 过滤/ ,/ 不管/ 谁/ 受/ 攻击/ 而/ 为/ 所有/ 地址/ 空间/ 过滤/ 的/ 域间/ 源地址/ 验证/ 方法/ ,/ 其/ 集合/ 记作/ FNN/ ./ 定义/ 14/ ./ “/ 分时/ 不/ 分空/ ”/ 的/ 方法/ 是/ 指/ ,/ 仅/ 在/ 攻击/ 发生/ 时/ 进行/ 过滤/ ,/ 不管/ 谁/ 受/ 攻击/ 而/ 为/ 所有/ 地址/ 空间/ 过滤/ 的/ 域间/ 源地址/ 验证/ 方法/ ,/ 其/ 集合/ 记作/ FTN/ ./ Page9/ 定义/ 15/ ./ “/ 分/ 时分/ 空/ ”/ 的/ 方法/ 是/ 指/ ,/ 仅/ 在/ 攻击/ 发生/ 时/ 进行/ 过滤/ ,/ 且/ 仅/ 为/ 遭受/ 攻击/ 的/ 地址/ 空间/ 过滤/ 的/ 域间/ 源地址/ 验证/ 方法/ ,/ 其/ 集合/ 记作/ FTS/ ./ 之所以/ 不/ 定义/ “/ 分空/ 不/ 分时/ ”/ 的/ 方法/ ,/ 是因为/ “/ 遭受/ 攻击/ 的/ 地址/ 空间/ ”/ 本身/ 就/ 具有/ 时间/ 概念/ ,/ 当/ 攻击/ 结束/ 后/ ,/ 它/ 就/ 不再/ 是/ 遭受/ 攻击/ 的/ 地址/ 空间/ ./ 4.3/ ./ 1/ 不分/ 时空/ 的/ 方法/ 的/ 运维/ 风险/ 由/ 上面/ 的/ 定义/ 可以/ 得出/ ,/ FNN/ 中/ 的/ 方法/ f/ 的/ 运维/ 风险/ 就是/ 该/ 方法/ 的/ 假/ 阳性率/ ,/ 记作/ FPf/ ./ FPf/ 由/ 两/ 部分/ 组成/ ,/ 一部分/ 是/ 方法/ 从/ 原理/ 上/ 的/ 固有/ 假/ 阳性率/ ,/ 记作/ FPTf/ ;/ 另/ 一部分/ 是/ 在/ 实现/ 中/ 算法/ 的/ 近似/ 、/ 资源/ 的/ 限制/ 等/ 产生/ 的/ 实践/ 假/ 阳性率/ ,/ 记作/ FPPf/ ./ 定理/ 2/ ./ 如果/ 方法/ f/ 的/ 固有/ 假/ 阳性/ 与/ 实践/ 假/ 阳性/ 相互/ 独立/ ,/ 则/ 其假/ 阳性率/ FPf/ =/ FPTf/ +/ FPPf/ -/ FPTf/ ·/ FPPf/ ./ 证明/ ./ 由于/ 理论/ 的/ 假/ 阳性率/ 为/ FPTf/ ,/ 则/ 理论/ 的/ 真/ 阳性率/ 为/ 1/ -/ FPTf/ ;/ 同理/ ,/ 实践/ 真/ 阳性率/ 为/ 1/ -/ FPPf/ ./ 由于/ 实践/ 假/ 阳性/ 与/ 固有/ 假/ 阳性/ 相互/ 独立/ ,/ 那么/ 最终/ 的/ 真/ 阳性率/ 为/ 理论/ 真/ 阳性率/ 与/ 实践/ 真/ 阳性率/ 的/ 乘积/ ,/ 即/ (/ 1/ -/ FPTf/ )/ (/ 1/ -/ FPPf/ )/ ./ 因此/ ,/ 最终/ 的/ 假/ 阳性率/ 为/ FPf/ =/ 1/ -/ (/ 1/ -/ FPTf/ )/ (/ 1/ -/ FPPf/ )/ ,/ 展开/ 得/ FPf/ =/ FPTf/ +/ FPPf/ -/ FPTf/ ·/ FPPf/ ./ 证毕/ ./ 由于/ 方法/ 的/ 假/ 阳性率/ 与/ 方法/ 所/ 部署/ 的/ 网络/ 状况/ 、/ 已/ 部署/ 的/ 节点/ 集和所/ 考虑/ 的/ 具体/ 节点/ 都/ 有关/ ,/ 因此/ 其/ 形式/ 应为/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ,/ 计算公式/ 为/ FPT/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ +/ FPP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ -/ FPT/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ·/ FPP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ./ 运维/ 风险/ 可以/ 直接/ 得出/ ,/ 如下/ 式/ :/ 在/ 给定/ 假/ 阳性率/ 的/ 情况/ 下/ ,/ 不/ 分/ 时空/ 的/ 方法/ 的/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ risk/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ,/ 其中/ ,/ f/ ∈/ FNN/ ./ 4.3/ ./ 2/ 分时/ 不/ 分空/ 的/ 方法/ 的/ 运维/ 风险/ 设在/ 相当/ 长/ 的/ 一段时间/ 里/ 共/ 发生/ 了/ 与/ n/ 相关/ 、/ 需要/ n/ 过滤/ 的/ NAn/ 次/ 攻击/ ,/ 设/ 这/ 段时间/ 的/ 总长度/ 为/ 1/ ,/ 第/ k/ 次/ 攻击/ 的/ 发生/ 的/ 时间/ 区间/ 为/ RIn/ ,/ k/ =/ [/ beginn/ ,/ k/ ,/ endn/ ,/ k/ ]/ ,/ 其中/ 0/ / k/ / NA/ 且/ 0/ / beginn/ ,/ k/ / endn/ ,/ k/ / 1/ ./ 那么/ ,/ 过滤/ 发生/ 的/ 时间/ 的/ 总长度/ 、/ 也/ 即/ 过滤/ 时间/ 占/ 总/ 时间/ 的/ 比率/ 为/ ∪/ kRIn/ ,/ k/ ,/ 其中/ ∪/ kRIn/ ,/ k/ 表示/ 将/ 所有/ 攻击/ 的/ 时间/ 区间/ 合并/ 为/ 一些/ 互不/ 相连/ 、/ 互不/ 重叠/ 的/ 区间/ 的/ 集合/ ,/ 而/ ∪/ kRIn/ ,/ k/ 表示/ ∪/ kRIn/ ,/ k/ 中/ 所有/ 区间/ 的/ 长度/ 的/ 和/ ./ 对于/ 分时/ 不/ 分空/ 的/ 方法/ f/ 来说/ ,/ 其运维/ 风险/ 等于/ 其假/ 阳性率/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ 乘以/ 其/ 进行/ 过滤/ 的/ 时间/ 比率/ ,/ 即/ risk/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ·/ ∪/ kRIn/ ,/ k/ ,/ 其中/ ,/ f/ ∈/ FTN/ ./ 4.3/ ./ 3/ 分/ 时分/ 空/ 的/ 方法/ 的/ 运维/ 风险/ 设/ 第/ k/ 次/ 攻击/ 影响/ 到/ 的/ 合法/ 流量/ 占/ 总/ 合法/ 流量/ 的/ 比率/ 为/ RVn/ ,/ k/ ./ 假设/ 如果/ 两个/ 攻击/ 由/ 攻击/ 的/ 时间/ 区间/ 的/ 重叠/ ,/ 其所/ 影响/ 的/ 合法/ 流量/ 不/ 重叠/ ,/ 即/ 攻击/ 事件/ 在/ 时空/ 双/ 维度/ 上/ 是/ 互斥/ 的/ ./ 在/ 互斥/ 的/ 前提/ 下/ ,/ 不同/ 攻击/ 所/ 带来/ 的/ 运维/ 风险/ 就/ 可以/ 直接/ 进行/ 加/ 运算/ 而/ 不/ 需/ 考虑/ 集合/ 重叠/ 带来/ 的/ 重复/ 计算/ ./ 此时/ ,/ 分/ 时分/ 空/ 的/ 方法/ f/ 的/ 运维/ 风险/ 可用/ 下/ 式/ 计算/ :/ risk/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ =/ FP/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ·/ ∑/ k/ 其中/ ,/ f/ ∈/ FTS/ ./ 4.3/ ./ 4/ 平均/ 运维/ 风险/ 前面/ 所/ 描述/ 的/ 运维/ 风险/ risk/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ 是/ 在/ 已/ 部署/ 节点/ 为/ D/ 的/ 情况/ 下非/ 部署/ 节点/ n/ 上/ 的/ 风险/ ./ 该/ 风险/ 是/ 有/ 意义/ 的/ ,/ 因为/ 它/ 正是/ 直接/ 描述/ 节点/ n/ 的/ 部署/ 风险/ 、/ 是/ n/ 最为/ 关心/ 的/ ./ 但/ 从/ 方法/ 评价/ 的/ 角度/ 来说/ ,/ 一个/ 节点/ 的/ 风险/ 可能/ 由于/ 该/ 节点/ 的/ 特殊性/ 具有/ 偏见/ ,/ 因此/ ,/ 我们/ 采用/ 部署/ 收益/ 评价/ 模型/ 中/ 的/ 手段/ ,/ 对/ N/ 中/ 所有/ 节点/ 的/ 运维/ 风险/ 进行/ 加权/ 平均/ ;/ 再/ 对/ 同样/ 大小/ 的/ 不同/ D/ 进行/ 平均/ ;/ 再/ 对/ 不同/ 大小/ 的/ D/ 的/ 平均值/ 画出/ 发展/ 曲线/ ,/ 作为/ 该/ 方法/ 的/ 运维/ 风险/ ./ 其中/ ,/ 对于/ 确定/ 的/ D/ ,/ 平均/ 运维/ 风险/ 表达式/ 如下/ :/ risk/ (/ f/ ,/ G/ / ,/ D/ )/ =/ ∑/ n/ ∈/ N/ 基于/ risk/ (/ f/ ,/ G/ / ,/ D/ )/ ,/ 方法/ f/ 最终/ 的/ 运维/ 风险/ 函数/ risk/ (/ f/ )/ 的/ 计算/ 方式/ 与/ 基于/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ 计算/ benefit/ (/ f/ )/ 的/ 方式/ 一致/ ,/ 前文有/ 详细/ 介绍/ ,/ 此处/ 不再/ 赘述/ ./ 5/ 评价/ 模型/ 的/ 应用/ 示例/ 前/ 一节/ 介绍/ 了/ 可/ 部署/ 性/ 指标/ 的/ 理论/ 评价/ 模型/ ./ 为了/ 展示/ 模型/ 的/ 实用性/ ,/ 我们/ 在/ 本节/ 以/ 部署/ 收益/ 为例/ 介绍/ 模型/ 的/ 具体/ 应用/ 方法/ ./ 我们/ 给出/ 了/ 部署/ 收益/ 评价/ 的/ 具体步骤/ 、/ 数据/ 的/ 采集/ 、/ 评价/ 结果/ 和/ 对/ 结果/ 的/ 分析/ 等/ ./ 值得/ 说明/ 的/ 是/ ,/ 本/ 示例/ 中/ 所/ 采用/ 的/ 数据/ 和/ 参数/ 并不一定/ 是/ 唯一/ 的/ 或/ 最优/ 的/ —/ —/ —/ 如果/ 有/ 更/ 精确/ 的/ 实际/ 数据/ 和/ 参数/ ,/ 评价/ 结果/ 也/ 会/ 更具/ 说服力/ ./ 5.1/ 评价/ 步骤/ 步骤/ 1/ ./ 输出/ :/ {/ benefit/ (/ f/ )/ }/ Page10/ 得到/ 所有/ 方法/ 的/ 部署/ 收益/ {/ benefit/ (/ f/ )/ }/ ./ 步骤/ 2/ ./ 输出/ :/ benefit/ (/ f/ )/ 输入/ :/ f/ ,/ {/ G/ / }/ 对于/ {/ G/ / }/ 中/ 的/ 每个/ 拓扑/ G/ / ,/ 由/ 步骤/ 3/ 求得/ benefit/ (/ f/ ,/ G/ / )/ ,/ 从而/ 得到/ {/ benefit/ (/ f/ ,/ G/ / )/ }/ ./ 分析/ {/ benefit/ (/ f/ ,/ G/ / )/ }/ 随/ 拓扑/ 的/ 变化趋势/ ,/ 得到/ benefit/ (/ f/ )/ ./ 步骤/ 3/ ./ 输出/ :/ benefit/ (/ f/ ,/ G/ / )/ 输入/ :/ f/ ,/ G/ / ,/ {/ PAn/ }/ ,/ {/ PIn/ }/ ,/ {/ PTn/ }/ 对/ 每个/ 正整数/ k/ ,/ 随机/ 生成/ Navg/ 个/ 大小/ 为/ k/ 的/ D/ ,/ 由/ 步骤/ 4/ 计算/ 出/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ ./ 对/ 同一/ 大小/ 的/ D/ 的/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ 进行/ 平均/ 获得/ 平均/ 部署/ 收益/ ,/ 并/ 以/ k/ 为/ 横轴/ ,/ 绘制/ 出/ 平均/ 部署/ 收益/ 随/ k/ 的/ 变化/ 曲线/ ,/ 获得/ benefit/ (/ f/ ,/ G/ / )/ ./ 输入/ :/ {/ f/ }/ 对于/ {/ f/ }/ 中/ 的/ 每个/ 方法/ f/ ,/ 由/ 步骤/ 2/ 计算/ 出/ benefit/ (/ f/ )/ ,/ 步骤/ 4/ ./ 输出/ :/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ 输入/ :/ f/ ,/ G/ / ,/ {/ PAn/ }/ ,/ {/ PIn/ }/ ,/ {/ PTn/ }/ ,/ D/ 对于/ 每个/ n/ ∈/ N/ ,/ 由/ 步骤/ 5/ 计算/ 出/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ,/ 并/ 对/ N/ 中/ 各个/ 节点/ 的/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ 以/ PTn/ 为/ 权重/ 进行/ 加权/ 平均/ ,/ 获得/ benefit/ (/ f/ ,/ G/ / ,/ D/ )/ ./ 步骤/ 5/ ./ 输出/ :/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ 输入/ :/ f/ ,/ G/ / ,/ {/ PAn/ }/ ,/ {/ PIn/ }/ ,/ {/ PTn/ }/ ,/ D/ ,/ n/ 对于/ 每个/ 伪造/ 报文/ (/ a/ ,/ i/ ,/ n/ )/ ,/ 根据/ 方法/ 的/ 过滤/ 函数/ 求出/ discard/ (/ f/ ,/ G/ / ,/ D/ ∪/ {/ n/ }/ ,/ (/ a/ ,/ i/ ,/ n/ )/ )/ -/ discard/ (/ f/ ,/ G/ / ,/ D/ ,/ (/ a/ ,/ i/ ,/ n/ )/ )/ ./ 再/ 乘以/ PAaPIi/ ,/ 求和/ 得到/ benefit/ (/ f/ ,/ G/ / ,/ D/ ,/ n/ )/ ./ 需要/ 说明/ 的/ 是/ ,/ 对于/ d/ -/ DoS/ 和/ s/ -/ DoS/ ,/ 方法/ 给出/ 的/ 部署/ 收益/ 是/ 不同/ 的/ ,/ 因此/ 需要/ 分别/ 评价/ ./ 5.2/ 数据/ 集/ 5.2/ ./ 1/ 自治/ 域级/ 的/ 互联网/ 拓扑/ 我们/ 从/ UCLA/ 的/ InternetTopologyCollection/ 项目/ 的/ 公开/ 数据/ 集中/ 获得/ 互联网/ 的/ 自治/ 域级/ 拓扑/ ①/ ./ 该/ 数据/ 集中/ 不仅/ 包括/ 各个/ 节点/ 、/ 节点/ 之间/ 连接/ 的/ 边/ ,/ 还/ 标注/ 了/ 各条/ 边/ 对应/ 的/ 自治/ 域/ 之间/ 的/ 经济/ 关系/ ,/ 包括/ 对等关系/ 、/ 客户/ 到/ 提供商/ 和/ 提供商/ 到/ 客户/ 3/ 种/ 关系/ ,/ 后面/ 我们/ 会/ 依据/ 这些/ 关系/ 推断/ 互联网/ 域间/ 路由/ ./ 该/ 数据/ 集/ 包括/ 2008/ 年/ 10/ 月/ 8/ 日/ 至今/ 每天/ 的/ 拓扑/ 数据/ ,/ 我们/ 采用/ 了/ 2008/ 年/ 至/ 2012/ 年/ 每年/ 10/ 月/ 11/ 日/ 的/ 拓扑/ ,/ 共有/ 5/ 个/ ,/ 代表/ 5/ 年来/ 互联网/ 的/ 成长/ 和/ 拓扑/ 的/ 变化/ ./ 5.2/ ./ 2/ 自治/ 域/ 的/ 地址/ 空间/ 大小/ 本文/ 所/ 采用/ 的/ 自治/ 域/ 的/ IP地址/ 空间/ 是从/ CAIDA/ ②/ 获得/ ./ 该/ 数据/ 集从/ RouteViews/ ③/ 采集/ BGP/ 更新/ 的/ 数据/ ,/ 产生/ IP地址/ 前缀/ 到/ 自治/ 域/ 号码/ 的/ 映射/ ./ 所/ 提供/ 的/ 数据/ 的/ 时间/ 范围/ 是从/ 2005/ 年/ 至今/ ./ 本文/ 采用/ 了/ 其中/ 2008/ 年/ 至/ 2012/ 年/ 每年/ 10/ 月/ 11/ 日/ 的/ 数据/ ,/ 以/ 与/ 拓扑/ 数据/ 相配合/ ./ 通过/ 最长/ 前缀/ 匹配/ 的/ 方式/ ,/ 我们/ 将/ 前缀/ 的/ 有效/ 地址/ 空间/ 映射/ 到/ 相应/ 的/ 自治/ 域/ ,/ 从而/ 得到/ 每个/ 自治/ 域/ 的/ 地址/ 空间/ 大小/ ./ 如果/ 有/ 自治/ 域/ 的/ 地址/ 空间/ 大小/ 为/ 0/ ,/ 将/ 其设/ 为/ 1/ ,/ 以/ 避免/ 后面/ 计算/ 部署/ 激励/ 时/ 除数/ 为/ 0/ 的/ 情况/ ./ 最后/ ,/ 计算/ 出/ 所有/ 自治/ 域/ 的/ 总/ 的/ 可/ 路由/ 地址/ 空间/ 大小/ ,/ 进而/ 计算/ 出/ 每个/ 自治/ 域/ 的/ 地址/ 空间/ 大小/ 占/ 总/ 空间/ 大小/ 的/ 比例/ ,/ 即/ {/ sizen/ }/ ./ 5.3/ 路由/ 的/ 生成/ 自治/ 域/ 级别/ 的/ 路由/ 在/ 评价/ 中有/ 两个/ 主要/ 的/ 用途/ ./ 一是/ 用于/ 确定/ 报文/ 的/ 转发/ 路径/ ,/ 已/ 确定/ 哪些/ 节点/ 在/ 路径/ 上/ 、/ 可以/ 参与/ 过滤/ ;/ 二是/ 用于/ 为/ 基于/ 路径/ 的/ 方法/ 提供/ 必要/ 的/ 信息/ ./ 本文/ 采用/ C/ -/ BGP/ ④/ 来/ 推测/ 路由/ 信息/ ./ C/ -/ BGP/ 是/ 一个/ BGP/ 路由/ 的/ 模拟器/ ,/ 它/ 以/ 带有/ 自治/ 域/ 关系/ 的/ 拓扑/ 为/ 输入/ ,/ 每个/ 自治/ 域/ 按照/ 自治/ 域/ 之间/ 的/ 关系/ 、/ 以/ Valley/ -/ Free/ [/ 29/ ]/ 为/ 原则/ 进行/ BGP/ 的/ 宣告/ 、/ 传播/ 和/ 路径/ 选择/ ,/ 当/ 传播/ 过程/ 收敛/ 以后/ ,/ 每个/ 节点/ 都/ 形成/ 一个/ 完整/ 路由表/ ./ 5.4/ 模拟/ 参数/ 模拟/ 参数/ 如表/ 3/ 所示/ ./ 参数/ {/ f/ }/ {/ BASE/ [/ 18/ ]/ ,/ DPF/ [/ 14/ ]/ ,/ HCF/ [/ 25/ ]/ ,/ IDPF/ [/ 15/ ]/ ,/ IEF/ [/ 21/ ]/ ,/ PiIP/ [/ 26/ ]/ ,/ {/ G/ / }/ {/ topo/ -/ 2008/ ,/ topo/ -/ 2009/ ,/ topo/ -/ 2010/ ,/ topo/ -/ 2011/ ,/ topo/ -/ 2012/ }/ Navg50/ {/ PAn/ }/ {/ sizen/ }/ {/ PIn/ }/ {/ sizen/ }/ {/ PTn/ }/ {/ sizen/ }/ 5.5/ 评价/ 结果/ 模拟/ 结果显示/ ,/ 不同/ 年份/ 、/ 不同/ 拓扑/ 下/ 各个/ 方法/ 的/ 部署/ 收益/ 曲线/ 及其/ 相互/ 关系/ 基本/ 不变/ ,/ 因此/ ,/ 为/ 节约/ 篇幅/ ,/ 我们/ 只/ 展示/ 2012/ 年/ 的/ 数据/ 得出/ 的/ 模拟/ 结果/ ./ 图/ 3/ 和/ 图/ 4/ 分别/ 展示/ 了/ {/ f/ }/ 中/ 的/ 方法/ 针对/ d/ -/ DoS/ 和/ s/ -/ DoS/ 两种/ 攻击/ 所/ 产生/ 的/ 部署/ 收益/ 曲线/ ./ 初始/ 收益/ 大/ 的/ 方法/ 有利于/ 吸引/ 早期/ 的/ 部署/ ,/ 而/ 后期/ 部署/ 收益/ 较/ 高/ 的/ 方法/ 则/ 有利于/ 长期/ 持续/ 部署/ ./ ①/ ②/ ③/ ④/ Page11/ 针对/ d/ -/ DoS/ ,/ DPF/ 、/ HCF/ 、/ IDPF/ 和/ uRPF/ 都/ 具有/ 较/ 好/ 的/ 初始/ 部署/ 收益/ ,/ 因为/ 其/ 过滤/ 表/ 的/ 建立/ 过程/ 不/ 依赖于/ 其他/ 自治/ 域/ ,/ 即/ 独立/ 部署/ 就/ 可以/ 获得/ 较/ 好/ 的/ 自我/ 保护/ ./ 但是/ 除了/ HCF/ 之外/ ,/ 其他/ 方法/ 的/ 收益/ 曲线/ 都/ 逐渐/ 降低/ ./ 其/ 原因/ 是/ ,/ 随着/ 部署/ 率/ 的/ 上升/ ,/ 被/ 已有/ 部署/ 者/ 过滤/ 掉/ 的/ 伪造/ 流量/ 越来越/ 多/ ,/ 而/ 非/ 部署/ 者/ 通过/ 自己/ 的/ 部署/ 能够/ 得到/ 的/ 额外/ 的/ 过滤/ 保护/ 就/ 越来越少/ ,/ 从而/ 造成/ 后期/ 部署/ 收益/ 不足/ ./ 而/ 采取/ 基于/ 目的/ 的/ 域间/ 协作/ 的/ 方法/ (/ SPM/ 和/ PiIP/ )/ 都/ 展示/ 出较/ 好/ 的/ 针对/ 于/ d/ -/ DoS/ 的/ 后期/ 收益/ ./ 随着/ 部署/ 率/ 上升/ ,/ 部署/ 者/ 之间/ 相互协作/ ,/ 通过/ 共享/ 信息/ 增强/ 彼此/ 的/ 过滤/ 能力/ 或/ 帮助/ 彼此/ 过滤/ 伪造/ 流量/ ,/ 使/ 部署/ 者/ 相比/ 非/ 部署/ 者/ 能/ 得到/ 更/ 多/ 的/ 保护/ ,/ 因此/ 具有/ 更/ 高/ 的/ 部署/ 收益/ ./ 针对/ s/ -/ DoS/ 的/ 部署/ 收益/ 与/ d/ -/ DoS/ 的/ 最大/ 不同/ 是/ ,/ 所有/ 方法/ 的/ 初始/ 部署/ 收益/ 都/ 几乎/ 为/ 0/ ./ 这/ 是因为/ s/ -/ DoS/ 中/ 的/ 伪造/ 发生/ 在/ 攻击者/ 和/ 反射/ 主机/ 之间/ ,/ 这些/ 报文/ 绝大多数/ 都/ 不/ 经过/ 受害者/ ,/ 使得/ 受害者/ 自治/ 域/ 即使/ 部署/ 了/ 某种/ 方法/ 也/ 没有/ 机会/ 去/ 过滤/ ,/ 因此/ 初始/ 部署/ 收益/ 很/ 低/ ./ 为了/ 实现/ 高/ 部署/ 收益/ ,/ 部署/ 者/ 之间/ 必须/ 采取/ 基于/ 源/ 的/ 域间/ 协作/ ,/ 帮助/ 彼此/ 过滤/ 伪造/ 报文/ ./ 我们/ 可以/ 看到/ ,/ 采取/ 基于/ 源/ 的/ 域间/ 协作/ 的/ 方法/ (/ SPM/ 、/ BASE/ 和/ SAVE/ )/ 相/ 较/ 其他/ 方法/ 具有/ 更/ 高/ 的/ 针对/ s/ -/ DoS/ 的/ 部署/ 收益/ ./ 5.6/ 评价/ 结果/ 的/ 进一步/ 分析/ 从/ 以上/ 的/ 评价/ 结果/ 可以/ 总结/ ,/ 技术/ 上/ 采取/ 了域/ 间/ 协作/ 的/ 方法/ 具有/ 较/ 高/ 的/ 部署/ 收益/ ./ 实际上/ ,/ 自治/ 域/ 之间/ 的/ 协作/ 主要/ 起到/ 两个/ 作用/ ./ 首先/ ,/ 域间/ 协作/ 可以/ 传递/ 和/ 共享/ 用于/ 源地址/ 验证/ 的/ 信息/ ,/ 增强/ 部署/ 者/ 的/ 过滤/ 能力/ ,/ 加强/ 对/ 部署/ 者/ 的/ 保护/ ;/ 其次/ ,/ 部署/ 者/ 还/ 可以/ 有/ 针对性/ 地/ 将/ 路由器/ 上/ 有限/ 的/ 资源/ 仅/ 用于/ 对/ 自己/ 和/ 其他/ 部署/ 者/ 的/ 保护/ ,/ 避免/ 将/ 资源/ 用于/ 为/ 非/ 部署/ 者/ 提供/ 免费/ 的/ 保护/ ./ 这样/ ,/ 一方面/ 部署/ 者/ 的/ 保护/ 得到/ 提升/ ,/ 另一方面/ 又/ 使得/ 非/ 部署/ 者/ 因/ 得不到/ 或仅/ 得到/ 很少/ 的/ 保护/ ,/ 从而/ 为/ 自治/ 域/ 提供/ 了/ 更/ 强/ 的/ 部署/ 动机/ ./ 当然/ ,/ 全面/ 的/ 方法/ 可/ 部署/ 性/ 分析/ 还/ 需要/ 考虑/ 部署/ 开销/ 和/ 运维/ 风险/ ,/ 但/ 由于/ 本文/ 的/ 重点/ 是/ 评价/ 模型/ ,/ 我们/ 就/ 不/ 在/ 此/ 介绍/ 这/ 两个/ 指标/ 的/ 评价/ 示例/ ,/ 感兴趣/ 的/ 读者/ 可以/ 参见/ 我们/ 的/ 在线/ 技术/ 报告/ ①/ ./ 6/ 讨论/ 6.1/ 可/ 部署/ 性/ 与/ 互联网/ 整体/ 安全性/ 的/ 关系/ 本文/ 提出/ 并/ 建立/ 了域/ 间/ 源地址/ 验证/ 方法/ 的/ 可/ 部署/ 性/ 评价/ 模型/ ,/ 意在/ 通过/ 引导/ 方法/ 从/ 设计/ 上/ 注重/ 对/ ISP/ 的/ 经济/ 激励/ 来/ 促进/ 方法/ 在/ 互联网/ 上/ 的/ 广泛/ 部署/ ./ 而/ 广泛/ 部署/ 则/ 是/ 彻底消除/ 互联网/ 域间/ 伪造/ 攻击/ 的/ 基础/ 和/ 必要条件/ ./ 定理/ 3/ ./ 假设/ / (/ a/ ,/ d/ )/ ∈/ E/ ,/ Path/ [/ a/ →/ d/ ]/ =/ {/ a/ ,/ d/ }/ ,/ 那么/ ,/ 能够/ 完全/ 过滤/ 互联网/ 域间/ 伪造/ 流量/ 的/ 部署/ 者/ 的/ 集合/ D/ 组成/ 了/ 拓扑/ 上/ 的/ 一个点/ 覆盖/ ./ 证明/ ./ 对于/ 任意/ 伪造/ 报文/ a/ :/ (/ s/ ,/ d/ )/ ,/ 它/ 能/ 被/ 过滤/ 掉/ 仅/ 当/ / n/ ∈/ Path/ [/ a/ →/ d/ ]/ ,/ n/ ∈/ D/ ,/ 即/ 伪造/ 报文/ 的/ 转发/ 路径/ 上/ 至少/ 需要/ 存在/ 一个/ 部署/ 者/ ./ 特别/ 地/ ,/ 当/ (/ a/ ,/ d/ )/ ∈/ E/ 时/ ,/ 根据/ 假设/ Path/ [/ a/ →/ d/ ]/ =/ {/ a/ ,/ d/ }/ ,/ 有/ a/ ∈/ D/ 或者/ d/ ∈/ D/ ./ 也就是说/ ,/ 拓扑/ 上/ 每/ 一条/ 边/ 都/ 至少/ 有/ 一个/ 端点/ 在/ D/ 中/ ,/ 所以/ D/ 组成/ 了/ 拓扑/ 上/ 的/ 一个点/ 覆盖/ ./ 本/ 定理/ 中/ 的/ 假设/ / (/ a/ ,/ d/ )/ ∈/ E/ ,/ Path/ [/ a/ →/ d/ ]/ =/ {/ a/ ,/ d/ }/ 是/ 指/ ,/ 如果/ 两个/ 自治/ 域/ 直接/ 相连/ ,/ 那么/ 他们/ 之间/ 的/ 流量/ 就/ 会/ 通过/ 直接/ 相连/ 的/ 链路/ 传输/ ,/ 而/ 不会/ 再/ 经/ 其他/ 自治/ 域/ 穿越/ 传输/ ./ 这个/ 假设/ 是/ 很/ 弱/ 的/ ,/ 在/ 当前/ 互联网/ 上/ 很/ 容易/ 被/ 满足/ (/ 根据/ Valley/ -/ Free/ 原则/ 及/ 最/ 短/ 路径/ 选择/ )/ ./ ①/ 互联网/ 域间/ 源地址/ 验证/ 方法/ 的/ 评价/ 模型/ 与/ 比较/ 评价/ Page12/ 由于/ 寻找/ 拓扑/ 中/ 的/ 最小/ 点/ 覆盖/ 是/ NP/ 难/ 问题/ ,/ 计算/ 最优/ 解/ 需要/ 消耗/ 大量/ 时间/ 和/ 计算资源/ ,/ 因此/ 我们/ 并/ 没有/ 计算/ 当前/ 互联网/ 域间/ 拓扑/ 的/ 最小/ 点/ 覆盖/ ./ 但/ 根据/ 文献/ [/ 14/ ]/ ,/ 1999/ 年/ 互联网/ 的/ 最小/ 点/ 覆盖/ 包含/ 大概/ 18.9/ %/ 的/ 自治/ 域/ ./ 而/ 随着/ 互联网/ 拓扑/ 结构/ 的/ 扁平化/ [/ 31/ ]/ ,/ 此/ 比例/ 可能/ 仍/ 在/ 增加/ ./ 即使/ 仍/ 以此/ 比例/ 计算/ ,/ 当前/ 互联网/ 上/ 共有/ 45977/ 个/ 自治/ 域/ ①/ ,/ 那么/ 最小/ 点/ 覆盖/ 也/ 包含/ 8690/ 个/ 自治/ 域/ ./ 显然/ ,/ 哪怕/ 假设/ 所有/ 自治/ 域/ 都/ 有/ 识别/ 任何/ 域间/ 伪造/ 报文/ 的/ 能力/ ,/ 完全/ 消除/ 域间/ 伪造/ 攻击/ 仍/ 需要/ 8690/ 个/ 自治/ 域/ 的/ 部署/ ./ 在/ 当前/ 去/ 中心化/ 的/ 互联网/ 上/ ,/ 只能/ 通过/ 各个/ 自治/ 域/ 内生/ 的/ 激励/ 去/ 部署/ ./ 因此/ ,/ 研究/ 方法/ 可/ 部署/ 性/ 的/ 问题/ 是/ 解决/ 互联网/ 整体/ 安全/ 问题/ 的/ 关键/ ;/ 而/ 方法/ 具备/ 高/ 部署/ 性则/ 是/ 其/ 得到/ 广泛/ 的/ 部署/ 并/ 最终/ 解决/ 互联网/ 域间/ 源地址/ 伪造/ 问题/ 的/ 必要条件/ ./ 6.2/ 方法/ 设计/ 的/ 优化/ 目标/ 第/ 3.3/ 节/ 给出/ 了/ 利润/ 增量/ 的/ 表达式/ Δ/ PROFIT/ =/ Rev/ +/ (/ benefit/ )/ -/ Rev/ -/ (/ risk/ )/ -/ Cost/ (/ cost/ )/ ,/ 其中/ ,/ Rev/ +/ 、/ Rev/ -/ 和/ Cost/ 分别/ 是/ benefit/ 、/ risk/ 和/ cost/ 的/ 弱/ 递增/ 函数/ ./ 显然/ ,/ 若/ 以/ Δ/ PROFIT/ 最大化/ 为/ 方法/ 的/ 优化/ 目标/ ,/ 我们/ 需要/ 分别/ 最大化/ benefit/ 、/ 最小化/ risk/ 和/ cost/ ./ 最/ 理想/ 的/ 情况/ 是/ ,/ benefit/ =/ 1/ 、/ risk/ =/ 0/ 且/ cost/ =/ L0/ ./ 但/ 实际上/ ,/ 不/ 产生/ 任何/ 开销/ 就/ 能/ 完全/ 过滤/ 伪造/ 报文/ 且/ 没有/ 任何/ 假/ 阳性/ 的/ 方法/ 是/ 不/ 存在/ ./ 也就是说/ ,/ benefit/ 、/ risk/ 和/ cost/ 可能/ 相互/ 约束/ ,/ 解/ 空间/ 中/ 的/ 一部分/ 是/ 不/ 可行/ 的/ ./ 我们/ 把/ 描述/ 这些/ 约束/ 、/ 寻找/ 可行/ 解/ 空间/ 作为/ 一项/ 未来/ 工作/ ./ 如果/ 我们/ 可以/ 给出/ Rev/ +/ 、/ Rev/ -/ 和/ Cost/ 的/ 具体/ 形式/ ,/ 即/ 最优化/ 的/ 目标/ 函数/ 表达式/ ,/ 那么/ 结合/ 约束条件/ ,/ 我们/ 就/ 可以/ 通过/ 解此/ 最优化/ 问题/ 找到/ 最优/ 方法/ ./ 然而/ ,/ 正如/ 我们/ 在/ 第/ 3.3/ 节所/ 提到/ 的/ ,/ 即使/ 目标/ 函数/ 的/ 形式/ 得以/ 确定/ ,/ 函数/ 的/ 形式/ 或/ 其中/ 的/ 参数/ 也/ 可能/ 因/ 不同/ ISP/ 而/ 不同/ 、/ 随/ 时间/ 而/ 变化/ ./ 因此/ ,/ 针对/ 某一/ 表达式/ 所求/ 出/ 的/ 最优/ 方法/ 未必/ 具有/ 长久/ 、/ 普遍/ 的/ 意义/ ./ 确定/ 方法/ 优化/ 目标/ 的/ 另/ 一个/ 思路/ 是/ ,/ 通过/ 增加/ 限制/ 条件/ 缩小/ 可行/ 解/ 的/ 空间/ ,/ 并/ 在/ 较/ 小/ 的/ 空间/ 内/ 寻找/ 针对/ 3/ 个/ 指标/ 的/ 多个/ 帕累托/ 最优/ 方法/ (/ 未必/ 是/ Δ/ PROFIT/ 最优/ 的/ 方法/ )/ ./ 比如/ ,/ 由于/ 数据传输/ 是/ ISP/ 的/ 主营业务/ ,/ 假/ 阳性/ 往往/ 是/ 无法忍受/ 的/ ./ 这样/ 我们/ 就/ 可以/ 增加/ 约束条件/ risk/ =/ 0/ ,/ 仅/ 对/ cost/ 和/ benefit/ 进行/ 优化/ ./ 由于/ cost/ 的/ 取值/ 是/ 有限/ 离散/ 的/ ,/ 我们/ 可以/ 限定/ 不同/ 的/ cost/ 的/ 取值/ 后/ 分别/ 最优化/ benefit/ ./ 对于/ 在/ 两个/ 不同/ 的/ cost/ 取值/ cost1/ 和/ cost2/ 下/ 求得/ 的/ 方法/ f1/ 和/ f2/ ,/ 设/ 它们/ 的/ 部署/ 收益/ 分别/ 为/ benefit1/ 和/ benefit2/ ,/ 一般来讲/ ,/ 如果/ cost1/ </ cost2/ ,/ 则/ 有/ benefit1/ </ benefit2/ ,/ 那么/ f1/ 和/ f2/ 都/ 是/ 约束条件/ risk/ =/ 0/ 下/ 的/ 帕累托/ 最优/ 方法/ ./ 这些/ 帕累托/ 最优/ 方法/ 尽管/ 未必/ 能够/ 最大化/ ISP/ 的/ 利润/ 增量/ ,/ 但是/ 可以/ 在/ 一些/ 限定/ 条件/ 下/ 给出/ 最/ 适合/ ISP/ 的/ 方法/ (/ 比如/ 在/ ISP/ 不能容忍/ 假/ 阳性/ 且/ 对/ 开销/ 非常/ 敏感/ 的/ 时候/ ,/ 可以/ 采用/ risk/ =/ 0/ 、/ cost/ =/ L1/ 时/ 的/ 帕累托/ 最优/ 方法/ )/ ,/ 因此/ 仍然/ 是/ 很/ 有/ 意义/ 的/ ./ 本文/ 所/ 提出/ 的/ 评价/ 指标/ 与/ 评价/ 模型/ ,/ 为/ 设计/ 不同/ 场景/ 下/ 的/ 最优/ 方法/ 提供/ 了/ 分析/ 框架/ 和/ 理论依据/ ./ 但/ 如何/ 求/ 出/ 最优/ 解/ 、/ 并/ 根据/ 理论/ 解/ 设计/ 出/ 实际/ 可行/ 的/ 方法/ ,/ 仍/ 需要/ 进一步/ 的/ 工作/ ./ 6.3/ 模型/ 指导/ 方法/ 设计/ 的/ 应用/ 实例/ 方法/ 设计/ 的/ 应用/ 实例/ ./ 本节/ 中/ ,/ 我们/ 介绍/ 利用/ 可/ 部署/ 性/ 评价/ 模型/ 指导/ 首先/ 要/ 确定/ 方法/ 的/ 优化/ 目标/ ./ 在/ 本/ 实例/ 中/ ,/ 我们/ 的/ 目标/ 是/ 约束条件/ risk/ =/ 0/ 下/ 的/ 帕累托/ 最优/ 方法/ ./ 根据/ 上/ 一节/ 的/ 分析/ ,/ 基于/ 评价/ 模型/ ,/ 我们/ 需要/ 在/ 保证/ 运维/ 风险/ 为/ 0/ 的/ 前提/ 下/ ,/ 针对/ 部署/ 开销/ 为/ L1/ 、/ L2/ 和/ L3/ ,/ 分别/ 以/ 最优化/ 部署/ 收益/ 为/ 目标/ 设计/ 3/ 个/ 方法/ ./ 在/ 确定/ 了/ 优化/ 目标/ 之后/ ,/ 下面/ 的/ 问题/ 是/ 如何/ 通过/ 方法/ 的/ 设计/ 来/ 实现/ 这些/ 目标/ ./ 我们/ 利用/ 评价/ 模型/ ,/ 对/ 现有/ 方法/ 的/ 3/ 项/ 指标/ 进行/ 定量/ 评价/ ,/ 并/ 对/ 评价/ 结果/ 进行/ 分析/ ,/ 总结/ 出/ 方法/ 设计/ 的/ 基本规律/ ./ 具体/ 包括/ :/ 基于/ 路径/ 的/ 方法/ 都/ 存在/ 或多或少/ 的/ 运维/ 风险/ ,/ 而/ 基于/ 端/ (/ 在域/ 间/ 场景/ 下/ ,/ “/ 端/ ”/ 指/ 自治/ 域/ )/ 和/ 端/ 到/ 端的/ 方法/ 则/ 可以/ 避免/ 运维/ 风险/ ;/ 独立/ 部署/ 的/ 方法/ 部署/ 收益/ 较/ 低/ ,/ 而/ 采取/ 域间/ 协作/ 则/ 可以/ 提升/ 甚至/ 最大化/ 部署/ 收益/ ;/ 通过/ 按/ 需/ 防御/ 则/ 可以/ 降低/ 部署/ 开销/ ./ 以此/ 为/ 指导/ ,/ 我们/ 分别/ 设计/ 了/ MutualEgressFiltering/ (/ MEF/ )/ [/ 32/ ]/ 和/ Inter/ -/ domainCollaborationSystem/ (/ ICS/ )/ 这/ 两个/ 域间/ 源地址/ 验证/ 方法/ ./ 其中/ ICS/ 包括/ 两个/ 模式/ —/ —/ —/ 标签/ 模式/ (/ ICS/ -/ tag/ )/ 和/ 消息/ 验证码/ 模式/ (/ ICS/ -/ mac/ )/ ./ MEF/ 、/ ICS/ -/ tag/ 和/ ICS/ -/ mac/ 都/ 采用/ 端/ 或/ 端/ 到/ 端的/ 验证/ 来/ 避免/ 运维/ 风险/ ,/ 其/ 部署/ 开销/ 等级/ 分别/ 为/ L1/ 、/ L2/ 和/ L3/ ,/ 评价/ 结果显示/ 它们/ 的/ 部署/ 收益/ 在/ 同等/ 开销/ 级别/ 的/ 方法/ 中/ 最高/ ./ 我们/ 依托/ 于/ 国家/ 项目/ 的/ 支持/ ,/ 实现/ 了/ ICS/ -/ tag/ ,/ 并/ 将/ 其/ 部署/ 在/ 中国/ 下一代/ 互联网/ 骨干网/ 上/ ,/ 至今/ 已/ 成功/ 运营/ 两年/ 多/ ./ 在/ ICS/ -/ tag/ 中/ ,/ 自治/ 域/ 两/ 两/ 之间/ 协商/ 用于/ 生成/ 确定性/ 标签/ 序列/ 的/ 状态机/ ,/ 两端/ 的/ 状态机/ 同步/ 变迁/ 来/ 生成/ 标签/ ,/ 将/ 其/ 插入/ 到/ 报文/ 头部/ ,/ 用于/ ①/ CIDRReport/ [/ EB/ // OL/ ]/ ./ http/ :/ // // cidr/ -/ report/ ./ org/ // 2013/ // 12/ // 29Page13/ 端到/ 端的/ 验证/ ./ 由于/ 状态机/ 的/ 逻辑/ 简单/ 、/ 标签/ 插入/ 和/ 验证/ 的/ 开销/ 较/ 低/ ,/ 现/ 网上/ 的/ 路由器/ 只/ 需要/ 更新/ 固件/ (/ 更新/ 报文/ 的/ 处理/ 流程/ )/ 就/ 可以/ 支持/ 相应/ 功能/ ,/ 而/ 无需/ 进行/ 硬件/ 升级/ ,/ 因此/ 部署/ 开销/ 为/ L2/ ./ 在/ 现网/ 运行/ 期间/ ,/ 尽管/ ICS/ -/ tag/ 并未/ 检测/ 到/ 大规模/ 的/ 伪造/ 攻击/ ,/ 但/ 却/ 帮/ 我们/ 发现/ 了/ 一些/ 软件缺陷/ 和/ 网管/ 漏洞/ ./ 比如/ ,/ 该/ 系统/ 曾/ 在/ 运行/ 中/ 报告/ 了/ 某/ 自治/ 域/ 的/ 部分/ 出口/ 报文/ 使用/ 了/ 其他/ 自治/ 域/ 的/ 源地址/ ./ 调查/ 发现/ ,/ 原因/ 是/ 该/ 自治/ 域/ 提供/ 了/ 一个/ 开放式/ IPv6/ 隧道/ 服务/ ,/ 但/ 却/ 没有/ 进行/ 完善/ 的/ 前缀/ 检查/ ,/ 而是/ 将/ 来自/ 其他/ 自治/ 域/ 的/ 报/ 文解/ 封装/ 后/ 直接/ 发送/ 出去/ ./ 这些/ 报/ 文本/ 应/ 使用/ 隧道/ 提供/ 的/ 源地址/ 前缀/ ,/ 但/ 由于/ 某/ 网络软件/ 的/ 缺陷/ ,/ 错误/ 地/ 使用/ 了/ 其他/ 自治/ 域/ 的/ 原生/ IPv6/ 地址/ ./ 软件缺陷/ 和/ 网管/ 漏洞/ 共同/ 导致/ 了/ 伪造/ 报文/ 的/ 出现/ ./ ICS/ -/ tag/ 系统/ 捕获/ 了/ 这些/ 报文/ ,/ 并/ 帮助/ 发现/ 和/ 修复/ 了/ 这些/ 漏洞/ ./ 篇幅/ 所/ 限/ ,/ 关于/ 方法/ 设计/ 、/ 分析/ 和/ 部署/ 的/ 详情请/ 参见/ 在线/ 技术/ 报告/ ①/ ./ 7/ 总结/ 与/ 展望/ 源地址/ 伪造/ 是/ 当前/ 互联网/ 的/ 重要/ 安全隐患/ 和/ 亟待解决/ 的/ 问题/ ,/ 而域/ 间/ 源地址/ 验证/ 可以/ 通过/ 较少/ 的/ 设备/ 部署/ 来/ 实现/ 有效/ 的/ 伪造/ 防御/ ./ 本文/ 的/ 特色/ 和/ 创新/ 之处/ 是/ 首次/ 从/ 部署/ 者/ 的/ 利益/ 角度/ 出发/ ,/ 提出/ 将/ 部署/ 收益/ 、/ 部署/ 开销/ 和/ 运维/ 风险/ 作为/ 域间/ 源地址/ 验证/ 方法/ 的/ 可/ 部署/ 性/ 评价/ 指标/ ;/ 从/ 理论/ 上/ 证明/ 了/ 指标/ 的/ 合理性/ ;/ 针对/ 这/ 3/ 项/ 指标/ ,/ 我们/ 分别/ 建立/ 了/ 完整/ 的/ 理论/ 评价/ 模型/ ;/ 通过/ 对/ 现有/ 方法/ 的/ 部署/ 收益/ 的/ 评价/ ,/ 介绍/ 了/ 模型/ 应用/ 的/ 具体/ 流程/ ,/ 并/ 通过/ 对/ 评价/ 结果/ 的/ 深入分析/ 提炼出/ 具有/ 高/ 部署/ 收益/ 的/ 方法/ 的/ 技术/ 特征/ ;/ 讨论/ 了/ 方法/ 可/ 部署/ 性/ 与/ 互联网/ 整体/ 安全性/ 的/ 关系/ 、/ 方法/ 设计/ 的/ 优化/ 目标/ 以及/ 模型/ 指导/ 方法/ 设计/ 的/ 应用/ 实例/ ./ 本文/ 所/ 提出/ 的/ 评价/ 指标/ 和/ 模型/ ,/ 为域/ 间/ 源地址/ 验证/ 方法/ 的/ 横向/ 比较/ 提供/ 了/ 准则/ 和/ 方法/ ,/ 为/ 方法/ 的/ 设计/ 指明/ 了/ 方向/ ./ 该/ 指标/ 和/ 模型/ 的/ 应用/ ,/ 将/ 有利于/ 设计/ 出/ 更加/ 易于/ 部署/ 的/ 域间/ 源地址/ 验证/ 方法/ ,/ 进而/ 推进/ 域间/ 源地址/ 验证/ 的/ 部署/ ,/ 最终/ 通过/ 改善/ 网络/ 的/ 安全/ 可信/ 环境/ 来/ 促进/ 互联网/ 的/ 创新/ 和/ 健康/ 发展/ ./ 

