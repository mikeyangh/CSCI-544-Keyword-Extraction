Page1/ 基于/ 中心/ 宏块/ 的/ 视频/ 目标/ 跟踪/ 算法/ 肖国强/ 康勤江/ 健民/ 张贝贝/ (/ 西南/ 大学/ 计算机/ 与/ 信息科学/ 学院/ 重庆/ 400715/ )/ 摘要/ 目前/ 的/ 视频/ 目标/ 跟踪/ 算法/ 对/ 目标/ 的/ 不/ 精确/ 分割/ 十分/ 敏感/ ,/ 从而/ 影响/ 目标/ 跟踪/ 的/ 性能/ ./ 文中/ 提出/ 一种/ 新/ 的/ 视频/ 目标/ 跟踪/ 算法/ ,/ 该/ 算法/ 对/ 目标/ 的/ 过/ 分割/ 或/ 欠/ 分割/ 有/ 较/ 强/ 的/ 鲁棒性/ ./ 文中/ 提出/ 的/ 跟踪/ 算法/ 中/ 引入/ 了/ 一个/ 中心/ 宏块/ 的/ 概念/ ,/ 通过/ 两个/ 层次/ 的/ 相似性/ 度量/ ,/ 以/ 建立/ 相邻/ 帧/ 之间/ 目标/ 的/ 对应/ 关系/ ./ 同时/ 利用/ MPEG/ 的/ 运动/ 估计/ 技术/ 和/ Kalman/ 滤波/ 技术/ 来/ 提高/ 目标/ 跟踪/ 的/ 性能/ ./ 第一个/ 层次/ 的/ 相似性/ 度量/ 是/ 通过/ SAD/ 值/ 在/ 中心/ 宏块/ 之间/ 进行/ 局部/ 纹理/ 匹配/ ;/ 第二个/ 层次/ 是/ 用/ 描述/ 目标/ 内部结构/ 的/ 方向/ 矢量/ 建立/ 目标/ 间/ 的/ 对应/ 关系/ ./ 实验/ 结果表明/ ,/ 文中/ 提出/ 的/ 算法/ 对于/ 不/ 精确/ 分割/ 的/ 目标/ 能够/ 成功/ 地/ 进行/ 跟踪/ ,/ 同时/ ,/ 对于/ 目标/ 的/ 遮挡/ 、/ 形变/ 、/ 出现/ 、/ 消失/ 以及/ 光线/ 的/ 影响/ 有/ 较/ 强/ 的/ 鲁棒性/ ./ 关键词/ 目标/ 跟踪/ ;/ 视频/ 处理/ ;/ 视频/ 分割/ ;/ Kalman/ 滤波/ ;/ 中心/ 宏块/ 1/ 引言/ 基于/ 内容/ 的/ 视频/ 处理/ 需要/ 提取/ 视频/ 运动/ 目标/ ,/ 它/ 对/ 视觉/ 内容/ 、/ 事件/ 和/ 相关/ 知识/ 的/ 说明/ 和/ 理解/ 起到/ 至关重要/ 的/ 作用/ ./ 视频/ 目标/ 提取/ 主要/ 通过/ 目标/ 的/ 分割/ 和/ 跟踪/ 来/ 完成/ ,/ 以/ 保证/ 运动/ 目标/ 在/ 相邻/ 的/ 帧/ 中/ 被/ 准确/ 地/ 提取/ 出来/ ./ 由于/ 目标/ 分割/ 存在/ 许多/ 尚未/ 解决/ 的/ 问题/ ,/ 目前/ 还/ 没有/ 可靠/ 的/ 方法/ 能够/ 实现/ 精确/ 的/ 视频/ 目标/ 分割/ ./ 因此/ ,/ 研究/ 非/ 精确/ 分割/ 的/ 视频/ 目标/ 跟踪/ 算法/ ,/ 并/ 提高/ 其/ 目标/ 跟踪/ 的/ 鲁棒性/ ,/ 这/ 对于/ 基于/ 内容/ 的/ 视频/ 处理/ 、/ 分析/ 、/ 诠释/ 和/ 应用/ 有/ 重要/ 的/ 意义/ ./ 2/ 相关/ 研究/ 视频/ 目标/ 跟踪/ 的/ 方法/ 可以/ 分为/ 4/ 类/ :/ 基于/ 模型/ [/ 1/ ]/ 、/ 基于/ 外观/ [/ 2/ ]/ 、/ 基于/ 轮廓/ [/ 3/ ]/ 和/ 基于/ 特征/ [/ 4/ -/ 6/ ]/ 的/ 目标/ 跟踪/ 方法/ ./ 基于/ 模型/ 的/ 跟踪/ 方法/ 是/ 利用/ 给定/ 场景/ 中/ 典型/ 物体/ 的/ 先验/ 知识/ [/ 1/ ,/ 5/ ]/ ,/ 这种/ 方法/ 计算/ 量/ 大/ ,/ 且/ 缺乏/ 泛化/ 性/ ./ 基于/ 外观/ 的/ 方法/ 依赖于/ 视频/ 目标/ 的/ 二维/ 形状/ 区域/ 提供/ 的/ 信息/ [/ 7/ -/ 9/ ]/ ,/ 如/ 运动/ 、/ 颜色/ 和/ 纹理/ 等/ 信息/ ,/ 来/ 实现目标/ 的/ 跟踪/ ./ 由于/ 这些/ 信息/ 都/ 是/ 低层次/ 的/ 特征/ 信息/ ,/ 因此/ ,/ 这些/ 方法/ 通常/ 不能/ 解决/ 运动/ 目标/ 复杂/ 的/ 形变/ 问题/ ./ 基于/ 轮廓/ 或/ 网格/ (/ meshes/ )/ 的/ 方法/ 依赖于/ 目标/ 的/ 轮廓/ 或/ 二维/ 网格/ ./ 这种/ 方法/ 利用/ 运动/ 信息/ 映射/ 出/ 轮廓/ ,/ 然后/ 将/ 其/ 应用/ 到/ 下/ 一帧/ 的/ 目标/ 分割/ 中/ ,/ 从而/ 完成/ 目标/ 的/ 检测/ [/ 10/ ]/ ./ 但/ 这种/ 方法/ 计算/ 复杂/ ,/ 运算量/ 大/ ,/ 不能/ 处理/ 非/ 刚性/ 物体/ 的/ 大/ 范围/ 运动/ ./ 对/ 基于/ 轮廓/ 方法/ 的/ 改进/ 是/ 采用/ 主动/ 轮廓/ 模型/ ,/ 如/ snakes/ [/ 11/ ]/ 和/ meshes/ [/ 3/ ,/ 12/ ]/ ./ 基于/ 特征/ 的/ 方法/ 也/ 有/ 一些/ 报道/ ,/ 但/ 它们/ 并非/ 针对/ 视频/ 目标/ 跟踪/ ,/ 如/ 文献/ [/ 13/ ]/ 提出/ 的/ 视频/ 对象/ 跟踪/ 算法/ ./ 这些/ 算法/ 的/ 主要/ 问题/ 是/ 如何/ 提取/ 特征/ 并/ 确定/ 特征/ 与/ 目标/ 之间/ 的/ 关系/ ./ 因此/ ,/ 这些/ 算法/ 可靠性/ 不高/ ,/ 容易/ 出现/ 跟踪/ 错误/ ./ 另一方面/ ,/ 国际/ 上/ 已/ 发布/ 了/ 一系列/ 的/ 视频/ 编码标准/ ,/ 如/ 从/ MPEG/ -/ 1/ 到/ MPEG/ -/ 4/ ,/ 从/ H/ ./ 261/ 到/ H/ ./ 264/ 等/ ,/ 来/ 应对/ 日益增长/ 的/ 视频/ 数据/ ./ 早期/ 的/ 视频/ 编码标准/ 缺乏/ 对/ 高层次/ 视频/ 内容/ 的/ 描述/ ,/ 因此/ ,/ 在/ 最近/ 发布/ 的/ 标准/ 中/ 引入/ 了/ 视频/ 对象/ 层/ (/ VOL/ )/ 的/ 概念/ 来/ 支持/ 基于/ 内容/ 的/ 视频/ 功能/ ./ 面向对象/ 的/ 多媒体/ 内容/ 的/ 表示/ 为/ 用户/ 提供/ 了/ 基于/ 内容/ 的/ 访问/ 和/ 管理/ 的/ 灵活性/ ,/ 从而/ 使/ 基于/ 运动/ 目标/ 的/ 视频/ 处理/ 引起/ 了/ 业界/ 的/ 广泛/ 关注/ ,/ 如/ 基于/ 对象/ 的/ 视频/ 编码/ ,/ 基于/ 对象/ 的/ 视频/ 内容分析/ 、/ 检索/ 和/ 视频/ 目标/ 跟踪/ [/ 1/ ,/ 2/ ,/ 4/ -/ 5/ ,/ 7/ -/ 11/ ]/ ./ 因此/ ,/ 视频/ 对象/ 分割/ 在/ 基于/ 内容/ 的/ 视频/ 应用/ 中/ ,/ 如/ 视频/ 对象/ 跟踪/ 、/ 基于/ 内容/ 的/ 视频/ 检索/ 、/ 视频/ 标注/ 等/ ,/ 起到/ 关键/ 的/ 作用/ ./ 然而/ ,/ 目标/ 分割/ 目前/ 仍/ 是/ 一个/ 尚未/ 解决/ 的/ 问题/ ,/ 文献/ 报道/ 的/ 目标/ 分割/ 算法/ 都/ 存在/ 过/ 分割/ 或/ 欠/ 分割/ 的/ 问题/ [/ 7/ -/ 10/ ,/ 14/ -/ 15/ ]/ ,/ 因此/ ,/ 不/ 能够/ 提供/ 可靠/ 的/ 视频/ 目标/ 分割/ ./ 本文/ 提出/ 一种/ 在/ 复杂/ 背景/ 下/ 自动/ 跟踪/ 视频/ 目标/ 的/ 算法/ ,/ 它/ 通过/ 目标/ 分割/ 、/ 区域/ 划分/ 、/ 中心点/ 提取/ 、/ 中心/ 宏块/ 构建/ 和/ 方向/ 矢量/ 确定/ 来/ 实现目标/ 跟踪/ ./ 该/ 算法/ 利用/ 区域/ 中心点/ 和/ 方向/ 矢量/ 来/ 解决/ 目标/ 之间/ 的/ 匹配/ 问题/ ,/ 从而/ 避免/ 了/ 由于/ 不/ 精确/ 的/ 目标/ 分割/ 所/ 带来/ 的/ 问题/ ./ 该/ 算法/ 的/ 优势/ 得益于/ 在/ 目标/ 跟踪/ 过程/ 中/ 不/ 需要/ 将/ 整个/ 目标/ 区域/ 投影/ 到/ 下/ 一帧/ ,/ 而仅/ 需/ 处理/ 一个/ 16/ ×/ 16/ 的/ 中心/ 宏块/ ,/ 因此/ ,/ 避免/ 了/ 运算/ 复杂/ 的/ 运动/ 模型/ ./ 3/ 算法/ 描述/ 给定/ 输入/ 视频/ 序列/ {/ I0/ ,/ I1/ ,/ …/ ,/ Ii/ -/ 1/ ,/ Ii/ ,/ …/ ,/ Im/ }/ ,/ 用/ 文献/ [/ 14/ ]/ 中/ 提出/ 的/ 通过/ 检测/ 相邻/ 两帧/ 像素/ 的/ 变化/ 和/ 利用/ 运动/ 信息/ 进行/ 视频/ 目标/ 分割/ ./ 目标/ 分割/ 过程/ 分为/ 3/ 步/ :/ 第/ 1/ 步是/ 利用/ Canny/ 算子/ 产生/ 3/ 个/ 边缘/ 图/ ,/ 包括/ 当前/ 帧/ 的/ 边缘/ 图/ En/ ,/ 差分/ 帧/ |/ In/ -/ 1/ -/ In/ |/ 的/ 边缘/ 图/ DEn/ 和/ 背景/ 帧/ 的/ 边缘/ 图/ Eb/ ;/ 第/ 2/ 步/ ,/ 通过/ 分别/ 比较/ En/ 和/ DEn/ 以及/ Eb/ 和/ DEn/ 之间/ 的/ 边缘/ 像素/ 产生/ 两个/ 运动/ 边缘/ 图/ MEchange/ 所有/ 的/ 当前/ 运动/ 边缘/ 像素/ ,/ MEstill/ 运动/ 边缘/ 像素/ 信息/ 中/ 得到/ 的/ 所有/ 静止/ 边缘/ 像素/ ;/ 第/ 3/ 步是/ 通过/ 选择/ MEchangen/ )/ 的/ 所有/ 边缘/ 像素/ 产生/ 分割/ 的/ 视频/ 对象/ MEstill/ (/ VO/ )/ ./ 文献/ [/ 15/ ]/ 对/ 文献/ [/ 14/ ]/ 的/ 算法/ 进行/ 了/ 改进/ ,/ 通过/ 区域/ 增长/ 使/ VO/ 的/ 分割/ 更加/ 精确/ ,/ 同时/ 也/ 提高/ 了/ 算法/ 的/ 鲁棒性/ ./ 给定/ 当前/ 帧/ Ii/ ,/ 其中/ 的/ 第/ j/ 个/ 目标/ 用/ Oi/ ,/ j/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ Ni/ 总数/ ./ 由于/ 目标/ 分割/ 不能/ 做到/ 百分之百/ 的/ 精确/ [/ 15/ ]/ ,/ 特别/ 是/ 一个/ 目标/ 消失/ ,/ 其它/ 的/ 目标/ 又/ 同时/ 进入/ 画面/ ,/ 这时/ 将/ 产生/ 不可避免/ 的/ 遮挡/ ,/ 出现/ 过/ 分割/ 或/ 欠/ 分割/ 的/ 问题/ ,/ 两个/ 重叠/ 的/ 目标/ 可能/ 被/ 分割/ 成/ 一个/ 目标/ 或/ 目标/ 的/ 某些/ 部分/ 被/ 丢失/ ./ 为了/ 克服/ 这些/ 因素/ 在/ 目标/ 跟踪/ 时/ 带来/ 的/ 负面影响/ ,/ 我们/ 进一步/ 把/ 一个/ 目标/ 分割/ 成/ 纹理/ 一致/ 的/ 不同/ 区域/ ,/ 这些/ 区域/ 之间/ 相互/ 独立/ ,/ 然后/ 分别/ 对/ 每个/ 区域/ 进行/ 跟踪/ ,/ 通过/ 综合利用/ 区域/ 的/ 跟踪/ 信息/ 来/ 实现目标/ 的/ 跟踪/ ,/ 以/ 弥补/ 由于/ 目标/ 分/ Page3/ 割/ 的/ 不/ 精确/ 所/ 带来/ 的/ 影响/ ./ 因此/ ,/ 给定/ 视频/ 帧/ 的/ 目标/ ,/ 对/ 第/ j/ 个/ 目标/ ,/ 利用/ 区域/ 增长/ 方法/ [/ 16/ ]/ 进一步/ 分割/ 成/ Nji/ 个/ 互不/ 重叠/ 的/ 区域/ ,/ 用/ Rk/ 个/ 目标/ 的/ 第/ k/ 个/ 区域/ ,/ k/ =/ 0/ ,/ 1/ ,/ 2/ ,/ …/ ,/ Nj/ 由于/ 部分/ 区域/ 可能/ 位于/ 被/ 分割/ 的/ 目标/ 之外/ ,/ 我们/ 仅/ 利用/ 一个/ 区域/ 的/ 代表/ 部分/ 进行/ 跟踪/ ,/ 这个/ 代表/ 部分/ 应/ 位于/ 区域/ 的/ 中心/ ./ 为此/ ,/ 需要/ 从/ 区域/ 中/ 提取/ 一个/ 中心点/ ./ 区域/ Rki/ ,/ j/ 的/ 中心点/ 犆/ ki/ ,/ j/ 按/ 如下/ 的/ 方法/ 提取/ [/ 17/ ]/ ./ 首先/ 计算/ 其中/ ,/ Pk/ 的/ 第/ l/ 个/ 区域/ 边界/ 像素/ 亮度/ 值/ ,/ μ/ ki/ ,/ j/ ,/ l/ 的/ 亮度/ 平均值/ ,/ M/ 表示/ 区域/ 的/ 边界/ 像素点/ 总/ Pk/ 数/ ./ 把/ μ/ k/ 图像/ gk/ (/ x/ ,/ y/ )/ :/ 其中/ ,/ P/ (/ x/ ,/ y/ )/ 表示/ 视频/ 帧/ I/ (/ x/ ,/ y/ )/ 中/ 的/ 像素/ 值/ ./ 最后/ ,/ 由/ 下列/ 两/ 式/ 得到/ 一个/ 区域/ 的/ 中心点/ 犆/ kmk/ 以/ 区域/ 中心点/ 为/ 中心/ ,/ 构建/ 一个/ 16/ ×/ 16/ 的/ 中心/ 宏块/ 来/ 代表/ 该/ 区域/ ./ 宏块/ 大小/ 的/ 选择/ 是/ 鉴于/ MPEG/ 中/ 运动/ 估计/ 和/ 补偿/ 技术/ [/ 18/ ]/ ,/ 同时/ 也/ 便于/ 利用/ 它/ 的/ 原则/ 来/ 计算/ SAD/ (/ SumofAbsoluteDifferences/ )/ 值/ ,/ 以/ 达到/ 对/ 中心/ 宏块/ 跟踪/ 的/ 目的/ ./ 因此/ ,/ 通过/ 中心/ 宏块/ 来/ 建立/ 相邻/ 帧/ 之间/ 区域/ 的/ 对应/ 关系/ ,/ 同时/ 利用/ Kalman/ 滤波/ 技术/ 和/ 从/ MPEG/ 中/ 获得/ 的/ 运动/ 矢量/ 来/ 提高/ 目标/ 的/ 跟踪/ 精度/ ,/ 这样/ ,/ 不仅/ 提高/ 了/ 处理速度/ ,/ 还/ 改善/ 了/ 跟踪/ 的/ 性能/ ./ 由于/ 目标/ 的/ 跟踪/ 是/ 建立/ 在/ 中心/ 宏块/ 之间/ 对应/ 关系/ 的/ 基础/ 上/ 的/ ,/ 为了/ 保证/ 视频/ 目标/ 的/ 正确/ 跟踪/ ,/ 我们/ 将/ 忽略/ 那些/ 不/ 能够/ 包含/ 一个/ 完整/ 宏块/ 的/ 区域/ ,/ 这些/ 区域/ 可/ 通过/ 下式/ 的/ 条件/ 进行/ 判决/ :/ 其中/ ,/ d/ (/ Pboundary/ ,/ 犆/ k/ 间/ 的/ Euclidean/ 距离/ ,/ η/ 为/ 参数/ ,/ 取值/ 范围/ 1/ / η/ / 2/ ./ 设置/ 该/ 条件/ 的/ 思想/ 是/ 使得/ 选定/ 区域/ 的/ 大小/ 应/ 大于/ 中心/ 宏块/ ,/ 中心/ 宏块/ 的/ 边界点/ 与/ 中心点/ 之间/ 最大/ 的/ Euclidean/ 距离/ 为/ 82/ +/ 8/ 槡/ 2/ 槡/ =/ 128/ ./ η/ 用来/ 控制/ 跟踪目标/ 的/ 最小/ 区域/ 面积/ ,/ η/ =/ 1/ 对应/ 中心/ 宏块/ 大小/ 的/ 区域/ ./ 为了/ 实现/ 从/ 第/ (/ i/ -/ 1/ )/ 帧/ 到/ 第/ i/ 帧/ 对/ 第/ k/ 个/ 目标/ 的/ 跟踪/ ,/ 我们/ 用/ 区域/ 的/ 对应/ 关系/ 来/ 建立/ 目标/ 之间/ 的/ 对应/ 关系/ ,/ 利用/ Kalman/ 滤波/ 来/ 实现/ 区域/ 的/ 跟踪/ [/ 19/ -/ 20/ ]/ ./ 众所周知/ ,/ Kalman/ 滤波/ 利用/ 状态方程/ 和/ 观测/ 方程/ 来/ 描述/ 动态/ 估计/ 和/ 预测/ 系统/ [/ 19/ ]/ ,/ 我们/ 定义/ 每个/ 中心/ 宏块/ 的/ 状态/ 为/ 其中/ ,/ (/ xt/ ,/ yt/ )/ 表示/ 在/ 时刻/ t/ 中心/ 宏块/ 的/ 位置/ ,/ (/ vtx/ ,/ vt/ 表示/ 在/ 时刻/ t/ 分别/ 沿/ x/ 和/ y/ 方向/ 的/ 运动/ 速度/ ./ 对于/ 相邻/ 帧/ 之间/ 的/ 状态/ 连续/ 估计/ ,/ 有/ vtx/ =/ xt/ -/ xt/ -/ 1/ =/ Δ/ xy/ =/ yt/ -/ yt/ -/ 1/ =/ Δ/ y/ ,/ (/ Δ/ x/ ,/ Δ/ y/ )/ 是/ 第/ t/ 帧/ 中心/ 宏块/ 的/ 和/ vt/ 运动/ 矢量/ ./ 由于/ MPEG/ 中/ 采用/ 从上到下/ ,/ 从左到右/ 的/ 方式/ 扫描/ 产生/ 宏块/ ,/ 因此/ ,/ 中心/ 宏块/ 可能/ 与/ MPEG/ 中/ 产生/ 的/ 宏块/ 不/ 重合/ ,/ 我们/ 采用/ 对/ 与/ 中心/ 宏块/ 所/ 重叠/ 的/ MPEG/ 宏块/ 的/ 运动/ 矢量/ 进行/ 加权/ 来/ 获得/ (/ Δ/ x/ ,/ Δ/ y/ )/ ./ 假定/ 中心/ 宏块/ 与/ NMPEG/ 个/ MPEG/ 宏块/ 重叠/ ,/ NMPEG/ 最大值/ 为/ 4/ ./ (/ Δ/ x/ ,/ Δ/ y/ )/ 由下式/ 确定/ :/ 其中/ ,/ wk/ =/ 1/ 中心/ 宏块/ 和/ MPEG/ 宏块/ ,/ (/ Δ/ xk/ ,/ Δ/ yk/ )/ 为/ 对应/ 的/ 第/ k/ 个/ MPEG/ 宏块/ 的/ 运动/ 矢量/ ./ 对于/ 只有/ 帧/ 内/ 编码/ 的/ 帧/ ,/ 其/ (/ Δ/ x/ ,/ Δ/ y/ )/ 设/ 为/ (/ 0/ ,/ 0/ )/ ./ Kalman/ 滤波/ 的/ 状态方程/ 定义/ 为/ 其中/ ,/ 犉/ 为/ 状态/ 转移/ 矩阵/ ,/ 表示/ 为/ η/ (/ t/ )/ =/ (/ η/ x/ (/ t/ )/ ,/ η/ y/ (/ t/ )/ ,/ η/ Δ/ x/ (/ t/ )/ ,/ η/ Δ/ y/ (/ t/ )/ )/ T/ 是/ 在/ 时刻/ t/ 的/ 随机噪声/ 矢量/ ,/ 包括/ 位置/ 噪声/ 和/ 运动/ 噪声/ ./ 随机噪声/ 通常/ 为/ 相互/ 独立/ 的/ 零/ 均值/ 高斯/ 白/ 噪声/ ,/ 因此/ ,/ 其/ 协方差/ 矩阵/ 为/ 一对/ 角/ 矩阵/ ,/ 即/ E/ [/ η/ (/ t/ )/ η/ (/ t/ )/ T/ ]/ =/ Qt/ ./ t/ 的/ 状态/ 预测/ 为/ 在/ 时刻/ t/ 的/ 状态/ 更新/ 用下式/ :/ 狊/ ^/ (/ t/ |/ t/ )/ =/ 狊/ ^/ (/ t/ |/ t/ -/ 1/ )/ +/ K/ (/ t/ )/ 犣/ (/ t/ )/ -/ 犎/ 狊/ ^/ (/ t/ |/ t/ -/ 1/ 根据/ 标准/ 的/ Kalman/ 滤波/ ,/ 在/ 时刻/ t/ -/ 1/ 对/ 时刻/ 这里/ ,/ 犎/ =/ 1000/ (/ Page4/ 犣/ (/ t/ )/ =/ 犎/ s/ (/ t/ )/ +/ 犠/ (/ t/ )/ 确定/ ,/ 其中/ ,/ 犣/ (/ t/ )/ 为/ 观测/ 量/ ,/ 犠/ (/ t/ )/ 为/ 观测/ 噪声/ ./ Kalman/ 增益/ 犓/ (/ t/ )/ =/ 犘/ (/ t/ |/ t/ -/ 1/ )/ ·/ 犎/ T/ [/ 犎/ 犘/ (/ t/ |/ t/ -/ 1/ )/ 犎/ T/ -/ R/ (/ t/ )/ ]/ -/ 1/ ,/ 其中/ 犘/ (/ t/ |/ t/ -/ 1/ )/ =/ 犉/ 犘/ (/ t/ -/ 1/ |/ t/ -/ 1/ )/ 犉/ T/ +/ 犙/ (/ t/ )/ 是/ t/ -/ 1/ 时刻/ 的/ 预测/ 协方差/ 矩阵/ ,/ 它/ 的/ 更新/ 方程/ 为/ 犘/ (/ t/ |/ t/ )/ =/ 犘/ (/ t/ |/ t/ -/ 1/ )/ -/ 犓/ (/ t/ )/ 犎/ 犘/ (/ t/ |/ t/ -/ 1/ )/ ./ 这是/ 一个/ 基于/ 帧/ 的/ 迭代/ 过程/ ,/ 当/ t/ =/ 0/ 时/ ,/ 犘/ (/ 0/ |/ 0/ )/ =/ E/ [/ 狊/ (/ 0/ )/ 狊/ (/ 0/ )/ T/ ]/ ./ 由/ 方程/ (/ 11/ )/ 可知/ ,/ 跟踪/ 的/ 状态/ 位置/ 由/ Kalman/ 预测/ 部分/ 和/ 校正/ 部分/ 确定/ ./ 状态/ 预测/ 利用/ MPEG/ 运动/ 估计/ 技术/ ,/ 中心/ 宏块/ 的/ 位置/ 观测/ 值/ 犣/ (/ t/ )/ 则/ 利用/ 下述/ 方法/ 得到/ ./ 给定/ 第/ i/ -/ 1/ 帧/ 的/ 第/ j/ 个/ 目标/ Oi/ -/ 1/ ,/ j/ ,/ 它/ 与/ 第/ i/ 帧/ 的/ 第/ j/ -/ 个/ 目标/ Oi/ ,/ j/ -/ 的/ 区域/ 差分/ 用/ 下述/ 矩阵/ 描述/ ,/ 其中/ 区域/ 差/ 分值/ 用/ SAD/ (/ SumofAbsoluteDiffer/ -/ ences/ )/ 表示/ / (/ j/ ,/ j/ -/ )/ =/ 烄/ SAD0/ ,/ 0SAD0/ ,/ 1/ …/ SAD0/ ,/ Nj/ -/ SAD1/ ,/ 0SAD1/ ,/ 1/ …/ SAD1/ ,/ Nj/ -/ / SADNj/ 烆/ 其中/ ,/ SAD/ =/ 1/ 为/ 两个/ 区域/ 的/ 中心/ 宏块/ 的/ 差/ 分值/ ,/ Pi/ (/ x/ ,/ y/ )/ 为/ 第/ i/ 帧/ 中/ 区域/ 的/ 中心/ 宏块/ 像素/ 值/ ./ 由式/ (/ 12/ )/ 可知/ ,/ / (/ j/ ,/ j/ -/ )/ 的/ 第一行/ 对应/ 目标/ Oi/ -/ 1/ ,/ j/ 的/ 第一个/ 区域/ 与/ 目标/ Oi/ ,/ j/ -/ 的/ 所有/ 区域/ 的/ 差/ 分值/ ,/ 即/ / (/ j/ ,/ j/ -/ )/ 的/ 每/ 一行/ 表示/ 目标/ Oi/ -/ 1/ ,/ j/ 的/ 一个/ 区域/ 与/ 目标/ Oi/ ,/ j/ -/ 的/ 所有/ 区域/ 的/ 差/ 分值/ ,/ 因此/ ,/ 其/ 每/ 一行/ 的/ 最/ 小S/ AD/ 值/ 代表/ 了/ 目标/ Oi/ -/ 1/ ,/ j/ 的/ 一个/ 区域/ 在/ 目标/ Oi/ ,/ j/ -/ 的/ 区域/ 中/ 的/ 最佳/ 匹配/ ./ 因此/ ,/ 矩阵/ / (/ j/ ,/ j/ -/ )/ 度量/ 了/ 第/ i/ -/ 1/ 帧/ 的/ 第/ j/ 个/ 目标/ Oi/ -/ 1/ ,/ j/ 的/ 所有/ 区域/ 到/ 第/ i/ 帧/ 的/ 第/ j/ -/ 个/ 目标/ Oi/ ,/ j/ -/ 的/ 区域/ 的/ 过度/ 过程/ ,/ 其/ 区域/ 的/ 对应/ 关系/ 可/ 表示/ 为/ / min/ (/ j/ ,/ j/ -/ )/ =/ (/ MAC0/ ,/ MAC1/ ,/ …/ ,/ MACNj/ 其中/ ,/ MACk/ =/ min/ {/ SADk/ ,/ 0/ ,/ SADk/ ,/ 1/ ,/ …/ ,/ SADk/ ,/ Nj/ -/ k/ ∈/ [/ 0/ ,/ Nj/ 中/ 的/ 最佳/ 匹配/ 宏块/ ,/ 对应/ 第/ i/ -/ 1/ 帧/ 的/ 第/ j/ 个/ 目标/ 的/ 第/ k/ 个/ 中心/ 宏块/ 与/ 第/ i/ 帧/ 的/ 第/ j/ -/ 个/ 目标/ 的/ 所有/ 中心/ 宏块/ 之间/ SAD/ 的/ 最小值/ ./ 因此/ ,/ 第/ k/ 个/ 中心/ 宏块/ 的/ 观测/ 值/ 犣/ (/ t/ )/ 由/ 对应/ MACk/ 宏块/ 的/ 位置/ 确定/ ./ 由于/ 第/ i/ 帧/ 中/ 有/ Ni/ 每个/ 目标/ 都/ 将/ 产生/ 这样/ 的/ 观测/ 量/ ,/ 因此/ ,/ 对于/ 第/ i/ 帧/ 将/ 有/ Ni/ 测量/ ./ 实际上/ ,/ 我们/ 的/ 策略/ 是/ 通过/ 中心/ 宏块/ 的/ 对应/ 关系/ 建立/ 相邻/ 两帧/ 区域/ 之间/ 的/ 对应/ 关系/ ,/ 从而/ 建立/ 相邻/ 两帧/ 目标/ 之间/ 的/ 对应/ 关系/ ./ 为了/ 综合/ 考虑/ 区域间/ 的/ 对应/ 关系/ ,/ 并/ 把/ 它们/ 进一步/ 转换/ 为/ 目标/ 间/ 的/ 对应/ 关系/ ,/ 把/ 式/ (/ 13/ )/ 中/ 对应/ 的/ 最/ 小S/ AD/ 值/ 全部/ 加/ 起来/ ,/ 构造/ 一个/ 目标/ 之间/ 建立/ 对应/ 关系/ 的/ 代价/ 测度/ ,/ 如下/ 式/ 所示/ :/ Costj/ ,/ j/ -/ 表示/ 了/ 第/ i/ -/ 1/ 帧/ 的/ 第/ j/ 个/ 目标/ 与/ 第/ i/ 帧/ 的/ 第/ j/ -/ 个/ 目标/ 建立/ 对应/ 关系/ 的/ 综合/ 代价/ ./ 由于/ 第/ i/ -/ 1/ 帧/ 中/ 有/ Ni/ -/ 1F/ 个/ 目标/ ,/ 因此/ ,/ 相邻/ 两帧/ 目标/ 之间/ 的/ 对应/ 关系/ 用/ Ni/ 下面/ 的/ 代价/ 矩阵/ 来/ 度量/ :/ Correspondencei/ -/ 1/ ,/ i/ =/ 烄/ Cost0/ ,/ 0Cost0/ ,/ 1/ …/ Cost0/ ,/ NiCost1/ ,/ 0Cost1/ ,/ 1/ …/ Cost1/ ,/ NiCostNi/ -/ 1/ 烆/ 其中/ ,/ 第/ 1/ 行/ 表示/ 第/ i/ -/ 1/ 帧/ 中/ 的/ 第/ 0/ 个/ 目标/ 跟踪/ 到/ 第/ i/ 帧/ 中/ 的/ 所有/ 目标/ 的/ 代价/ ./ 也/ 就是/ 每/ 一行/ 对应/ 第/ i/ -/ 1/ 帧/ 中/ 的/ 目标/ ,/ 而/ 每/ 一列/ 对应/ 第/ i/ 帧/ 中/ 的/ 目标/ ./ 式/ (/ 15/ )/ 说明/ ,/ 第/ k/ 行中/ 最小/ 的/ 代/ 价值/ MCostk/ ,/ l/ =/ min/ {/ Costk/ ,/ 0/ ,/ Costk/ ,/ 1/ ,/ …/ ,/ Costk/ ,/ Ni/ 中/ 的/ 第/ k/ 个/ 目标/ 最有/ 可能/ 跟踪/ 到/ 第/ i/ 帧/ 中/ 的/ 第/ l/ 个/ 目标/ ./ 然而/ ,/ 上述/ 的/ 目标/ 对应/ 关系/ 是/ 建立/ 在/ SAD/ 值/ 基础/ 上/ 的/ ,/ 它/ 仅仅/ 说明/ 了/ 两个/ 目标/ 之间/ 的/ 纹理/ 相似性/ ./ 为了/ 进一步/ 优化/ 每个/ 中心/ 宏块/ 跟踪/ 位置/ 的/ 观测/ 量/ ,/ 我们/ 提出/ 两个/ 目标/ 之间/ 的/ 结构/ 相似性/ 度量/ ,/ 具体方法/ 如下/ ./ 为了/ 表示/ 每个/ 目标/ 的/ 内部结构/ ,/ 首先/ 对/ 每个/ 目标/ 内/ 的/ 区域/ 中心点/ 按/ 从上到下/ ,/ 从左到右/ 的/ 顺序/ 进行/ 标记/ ,/ 然后/ 从/ 第一个/ 区域/ 中心点/ 开始/ 直到/ 最后/ 一个/ ,/ 把/ 区域/ 中心点/ 两/ 两/ 相连/ ,/ 从而/ 构造/ 一个/ 方向/ 矢量/ 的/ 序列/ ./ 对/ 第/ i/ -/ 1/ 帧/ 的/ 第/ j/ 个/ 目标/ ,/ 这个/ 序列/ 可用/ 下/ 式/ 表示/ :/ i/ -/ 1/ =/ 犇/ 0DVj/ =/ {/ (/ C0/ →/ C1/ )/ ,/ (/ C1/ →/ C2/ )/ ,/ …/ ,/ (/ CNjPage5/ 其中/ ,/ (/ Cm/ →/ Cn/ )/ 表示/ 目标/ 中/ 第/ m/ 个/ 区域/ 中心/ 宏块/ 到/ 第/ n/ 个/ 区域/ 中心/ 宏块/ 连线/ 的/ 方向/ ./ 这样/ ,/ 任意/ 两个/ 目标/ 的/ 结构/ 相似性/ 可用/ 每个/ 矢量/ 的/ 方向/ 来/ 度量/ ./ 考虑/ 到/ 目标/ 跟踪/ 过程/ 中/ 可能/ 产生/ 旋转/ ,/ 我们/ 把/ 矢量/ 方向/ 仅/ 量化/ 成/ 8/ 个/ 方向/ ,/ 即/ {/ [/ 0/ °/ -/ 45/ °/ )/ ,/ [/ 45/ °/ -/ 90/ °/ )/ ,/ …/ ,/ [/ 315/ °/ -/ 360/ °/ )/ }/ ./ 虽然/ ,/ 较少/ 的/ 量化/ 方向/ 可以/ 为/ 被/ 跟踪目标/ 的/ 结构/ 变化/ 提供/ 更大/ 的/ 宽容度/ ,/ 如/ 旋转/ 等/ ,/ 但/ 较/ 多/ 的/ 量化/ 方向/ 能够/ 提供/ 更/ 精确/ 的/ 结构/ 相似性/ 度量/ ./ 我们/ 通过/ 实验/ 确定/ 了/ 45/ °/ 的/ 旋转/ 容限/ ./ 给定/ 两个/ 目标/ 的/ 方向/ 矢量/ 序列/ ,/ 比较/ 相对/ 应/ 的/ 方向/ 矢量/ ,/ 看其/ 是否/ 属于/ 同一个/ 量化/ 的/ 方向/ ,/ 据此/ 来/ 调整/ 它们/ 对应/ 的/ 式/ (/ 15/ )/ 中/ 的/ 代/ 价值/ ./ 具体/ 的/ 调整/ 过程/ 如下/ :/ for/ (/ 珔/ k/ =/ 0/ ,/ 珔/ k/ </ Nki/ -/ 1/ ,/ 珔/ k/ ++/ 烅/ Costk/ ,/ l/ =/ Costk/ ,/ l/ -/ α/ ,/ ∠/ 犇/ 珔/ k/ 其中/ ,/ ∠/ 犇/ k/ -/ α/ 为/ 步长/ ,/ 用来/ 降低/ 代/ 价值/ ,/ 其/ 取值/ 范围/ 为/ 1/ ~/ 10/ ./ 如果/ 第/ i/ 帧/ 中/ 的/ 一个/ 目标/ 的/ 方向/ 矢量/ 数/ 少于/ 或/ 多于/ 第/ i/ -/ 1/ 帧/ 中/ 的/ 任一/ 目标/ 的/ 方向/ 矢量/ 数/ ,/ 则/ 相应/ 的/ 代/ 价值/ 增加/ α/ ./ 通过/ 式/ (/ 17/ )/ 的/ 结构/ 相似性/ 度量/ 对式/ (/ 15/ )/ 的/ 代价/ 调整/ 完后/ ,/ 找出/ 式/ (/ 15/ )/ 中/ 每/ 一行/ 的/ 最小值/ ,/ 即/ min/ 踪/ 的/ 目标/ ./ 也/ 就是/ 第/ i/ -/ 1/ 帧/ 中/ 的/ 第/ h/ 个/ 目标/ 跟踪/ 到/ 第/ i/ 帧/ 中/ 的/ 第/ g/ 个/ 目标/ ./ 因此/ ,/ 第/ k/ 个/ 中心/ 宏块/ 最后/ 的/ 观测/ 量/ 是/ 在/ 第/ i/ 帧/ 中/ 对应/ MACg/ 综上所述/ ,/ 本文/ 提出/ 的/ 视频/ 目标/ 跟踪/ 算法/ 通过/ 两个/ 层次/ 实现/ ./ 首先/ ,/ 我们/ 建立/ 中心/ 宏块/ 之间/ 的/ 对应/ 关系/ ,/ 以/ 度量/ 目标/ 内/ 区域/ 之间/ 的/ 局部/ 相似性/ ;/ 第二/ ,/ 利用/ Kalman/ 滤波/ 进行/ 基于/ 中心/ 宏块/ 的/ 目标/ 跟踪/ ,/ 同时/ ,/ 综合/ 纹理/ 和/ 结构/ 相似性/ 信息/ 以/ 保证/ 在/ 目标/ 之间/ 建立/ 正确/ 的/ 目标/ 对应/ 关系/ ,/ 从而/ 实现/ 对/ 视频/ 目标/ 的/ 跟踪/ ./ 4/ 实验/ 结果/ 与/ 分析/ 为了/ 对/ 本文/ 提出/ 的/ 算法/ 进行/ 评估/ ,/ 我们/ 在/ WindowsXP/ 环境/ 下/ ,/ 用/ V/ C++/ 编程/ 实现/ 了/ 本/ 算法/ ,/ 并/ 进行/ 了/ 大量/ 的/ 视频/ 目标/ 跟踪/ 实验/ ./ 图/ 1/ 为/ 对/ 视频/ 序列/ HallMonitor/ 进行/ 实验/ 的/ 结果/ ./ 该/ 序列/ 共/ 300/ 帧/ ,/ 每帧/ 大小/ 352/ ×/ 240/ ./ 图/ 1/ 中/ ,/ (/ a/ )/ 说明/ 目标/ A/ (/ 用/ 白色/ 方框/ 表示/ )/ 在/ 第/ 17/ 帧/ 开始/ 出现/ ,/ 并/ 被/ 跟踪/ 到/ ;/ (/ b/ )/ 显示/ 在/ 第/ 80/ 帧/ 中/ 出现/ 目标/ B/ (/ 用/ 黑色/ 方框/ 表示/ )/ ,/ 并/ 被/ 跟踪/ 到/ ;/ 从/ (/ c/ )/ 中/ 看出/ ,/ 在/ 第/ 111/ 帧/ 中/ ,/ 目标/ A/ 弯/ 下腰/ 拿/ 东西/ 时/ ,/ 形体/ 发生/ 了/ 变化/ ,/ 然而/ 算法/ 依然/ 能够/ 对/ 目标/ A/ 发生/ 形变/ 后/ 实现/ 正确/ 的/ 跟踪/ ;/ (/ d/ )/ 说明/ 在/ 第/ 249/ 帧/ ,/ 目标/ A/ 消失/ ,/ 只/ 剩下/ 目标/ B/ ,/ 而/ 此时/ 算法/ 能够/ 正确/ 地/ 跟踪目标/ B/ ./ 图/ 1/ 所示/ 的/ 实验/ 结果/ 说明/ 本文/ 提出/ 的/ 算法/ 在/ 以下/ 几种/ 情况/ 下/ 都/ 能够/ 正确/ 地/ 跟踪目标/ 的/ 运动/ :/ (/ 1/ )/ 从/ 第/ 17/ 帧/ 到/ 第/ 249/ 帧/ 目标/ A/ 的/ 形体/ 由小到大/ ,/ 再/ 由/ 大到/ 小/ ,/ 这/ 代表/ 了/ 视频/ 中/ 的/ 渐变/ 过程/ ;/ (/ 2/ )/ 一个/ 目标/ 消失/ 或/ 出现/ ,/ 同时/ 另/ 一个/ 目标/ 仍停留/ 在/ 画面/ 中/ ;/ (/ 3/ )/ 目标/ 发生/ 形变/ ./ 图/ 1HallMonitor/ 视频/ 序列/ 目标/ 跟踪/ 实验/ 结果/ 图/ 1/ 中/ 显示/ 的/ 视频/ 帧/ 的/ 目标/ 分割/ 结果/ 如图/ 2/ 所示/ ./ 从图/ 2/ 可以/ 看出/ ,/ 目标/ 的/ 分割/ 并/ 不/ 精确/ ,/ 同时/ 在/ 每/ 一帧/ 中/ 都/ 存在/ 过/ 分割/ 的/ 现象/ ./ 例如/ ,/ 第/ 17/ 帧/ 中/ ,/ 人物/ 目标/ A/ 仅仅/ 部分/ 地/ 出现/ 在/ 场景/ 中/ ,/ 在/ 目标/ 的/ 分割/ 过程/ 中/ 产生/ 了/ 一些/ 过/ 分割/ 的/ 区域/ ,/ 但/ 这些/ 过/ 分割/ 的/ 区域/ 在/ 目标/ 跟踪/ 的/ 过程/ 中/ 被/ 算法/ 所/ 抑制/ ./ 如前所述/ ,/ 这些/ 过/ 分割/ 的/ 区域/ 可/ 利用/ 式/ (/ 5/ )/ 的/ 条件/ 进行/ 剔出/ ./ 当/ Page6/ 一些/ 背景/ 区域/ 作为/ 被/ 分割/ 目标/ 区域/ 的/ 一部分/ 时/ ,/ 如图/ 2/ 中/ 的/ 第/ 80/ 帧/ 和/ 第/ 111/ 帧/ ,/ 中心/ 宏块/ 的/ 方案/ 将/ 把/ 这些/ 背景/ 区域/ 对/ 目标/ 跟踪/ 的/ 影响/ 降低/ 到/ 最小/ 的/ 程度/ ,/ 特别/ 是/ 人物/ 目标/ 与/ 背景/ 的/ 颜色/ 或/ 纹理/ 相似/ 的/ 情况/ 下/ ,/ 如/ 第/ 111/ 帧/ 中/ 人物/ 目标/ 的/ 腿部/ 与/ 背景/ 的/ 颜色/ 相似/ ./ 为了/ 进一步/ 说明/ 本文/ 提出/ 的/ 视频/ 目标/ 跟踪/ 算法/ 的/ 鲁棒性/ ,/ 我们/ 下载/ 了/ 大量/ 主要/ 用于/ 目标/ 跟踪/ 的/ 视频/ 序列/ 进行/ 实验/ ,/ 部分/ 实验/ 结果/ 如图/ 3/ 和/ 图/ 4/ 所示/ ./ 图/ 3/ 给出/ 了/ 对/ PETS2001/ 监控/ 视频/ 序列/ 的/ 实验/ 结果/ ,/ 在/ 第/ 1368/ 帧/ 出现/ 了/ 汽车/ 和/ 行人/ 两个/ 目标/ ,/ 行人/ 比/ 汽车/ 要/ 小得多/ ,/ 但/ 我们/ 的/ 算法/ 仍/ 能够/ 对/ 目标/ 进行/ 正确/ 的/ 跟踪/ ./ 图/ 3/ 的/ 结果显示/ ,/ 本文/ 算法/ 在/ 全景/ 视图/ 中/ 能够/ 正确/ 地/ 跟踪/ 较/ 小/ 的/ 多/ 视频/ 运动/ 目标/ ./ 图/ 4/ 给出/ 的/ 是/ 对/ PETS2006/ 视频/ 序列/ 的/ 实验/ 结果/ ,/ 该图/ 说明/ 本文/ 算法/ 在/ 夜晚/ 场景/ 并/ 有/ 强光/ 影响/ 的/ 条件/ 下/ ,/ 也/ 能够/ 正确/ 地/ 跟踪/ 视频/ 目标/ ./ 5/ 总结/ 本文/ 提出/ 一种/ 新/ 的/ 基于/ 中心/ 宏块/ 的/ 视频/ 目标/ 跟踪/ 算法/ ,/ 我们/ 的/ 研究/ 工作/ 的/ 新颖性/ 主要/ 体现/ 在/ 以下/ 3/ 方面/ :/ (/ 1/ )/ 在/ 区域/ 层次/ 上/ 引入/ 基于/ 中心点/ 的/ 宏块/ 来/ 进行/ 目标/ 跟踪/ ,/ 克服/ 了/ 由于/ 目标/ 分割/ 的/ 不/ 精确/ 所/ 带来/ 的/ 影响/ ;/ (/ 2/ )/ 通过/ 在/ 目标/ 中/ 引入/ 方向/ 矢量/ ,/ 在/ 目标/ 层次/ 上/ 度量/ 目标/ 之间/ 的/ 结构/ 相似性/ ;/ (/ 3/ )/ 利用/ MPEG/ 的/ 运动/ 估计/ 技术/ ,/ 用/ Kalman/ 滤波/ 综合/ 区域/ 和/ 目标/ 对应/ 关系/ ,/ 利用/ 代价/ 矩阵/ 在/ 相邻/ 两帧/ 的/ 目标/ 之间/ 建立/ 全局/ 相似性/ 度量/ ./ 大量/ 的/ 实验/ 证明/ ,/ 本文/ 提出/ 的/ 算法/ 在/ 各种/ 复杂/ 背景/ 的/ 情形/ 下/ ,/ 都/ 能够/ 正确/ 地/ 跟踪目标/ ,/ 并/ 对/ 目标/ 的/ 不/ 精确/ 分割/ 有/ 很/ 好/ 的/ 鲁棒性/ ./ 

