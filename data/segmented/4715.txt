Page1/ 基于/ AWGR/ 的/ OCS/ // EPS/ 数据中心/ 光电/ 混合/ 网络/ 1/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 2/ )/ (/ 中国科学院/ 大学/ 北京/ 100190/ )/ 摘要/ 随着/ 云/ 计算/ 和/ 大/ 数据/ 应用/ 技术/ 的/ 发展/ ,/ 数据中心/ 的/ 数量/ 和/ 规模/ 迅速/ 发展/ ,/ 为了/ 满足/ 服务器之间/ 大规模/ 数据/ 流动/ 的/ 需求/ ,/ 数据中心/ 网络/ 的/ 通信/ 能力/ 面临/ 巨大/ 的/ 挑战/ ./ 传统/ 数据中心/ 中/ ,/ 网络/ 的/ 路由/ 交换/ 设备/ 一般/ 仅/ 采用/ 电域/ 交换/ 技术/ ,/ 电域/ 交换/ 技术/ 虽然/ 可以/ 快速/ 地/ 、/ 灵活/ 地/ 切换/ 数据包/ 的/ 传输/ 路径/ ,/ 但/ 其/ 本身/ 存在/ 通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 、/ 高能耗/ 等/ 缺点/ ./ 为了/ 提高/ 数据中心/ 网络/ 的/ 性能/ 、/ 降低/ 网络/ 的/ 能耗/ ,/ 最近/ 的/ 研究/ 提出/ 了/ 若干/ 基于/ 慢速/ 路径/ 切换/ 光/ 器件/ 的/ 光电/ 混合/ 网络结构/ ./ 它们/ 通常/ 只能/ 将/ 小/ 部分/ 数据量/ 非常/ 大/ 的/ 网络/ 流放/ 在/ 高带宽/ 的/ 光/ 网络/ 上/ 传输/ ,/ 其他/ 的/ 网络/ 流/ 仍然/ 需要/ 电域/ 网络/ 传输/ ./ 随着/ 快速/ 可调/ 波长/ 激光器/ 以及/ 光波长/ 路由器/ 件/ 的/ 成熟/ ,/ 使/ 光电/ 混合/ 网络结构/ 灵活/ 应对/ 动态/ 、/ 多样/ 的/ 流量/ 模式/ 成为/ 可能/ ./ 该文/ 基于/ 快速/ 可调/ 波长/ 激光器/ TWC/ (/ TunableWavelengthConverters/ )/ 和/ 光波长/ 路由器/ AWGR/ (/ Arrayed/ -/ WaveguideGratingRouter/ )/ ,/ 首次/ 提出/ 了/ 一种/ OCS/ (/ OpticalCircuitSwitching/ )/ // EPS/ (/ ElectricalPacketSwitching/ )/ 光电/ 混合/ 网络结构/ Ace/ -/ net/ ./ 在/ 文中/ 详细描述/ 了/ 光电/ 混合/ 网络/ 的/ 结构/ 以及/ 带宽/ 测量/ 、/ 仲裁/ 控制/ 、/ 流量/ 分配/ 等/ 机制/ ,/ 这些/ 机制/ 利用/ TWC/ 器件/ 快速/ 波长/ 变换/ 的/ 特性/ ,/ 能/ 快速/ 地/ 应对/ 网络流量/ 的/ 变化/ ,/ 使/ 更/ 多/ 的/ 网络流量/ 在/ 光域/ 网络/ 上/ 传输/ ;/ 同时/ 使用/ 模拟器/ 对此/ 结构/ 进行/ 了/ 评测/ ,/ 模拟/ 结果表明/ 此/ 网络结构/ 具有/ 很/ 好/ 的/ 网络/ 性能/ ./ 关键词/ 数据中心/ 网络/ ;/ 光电/ 混合/ 网络/ ;/ 阵列/ 波导/ 光栅/ 路由器/ ;/ 光/ 线路/ 交换/ 1/ 引言/ 数据中心/ 作为/ 支撑/ 现代/ 社会/ 的/ 基础设施/ ,/ 对/ 人类/ 的/ 生活/ 产生/ 越来越/ 大/ 的/ 影响/ ./ 近年来/ ,/ 随着/ 新/ 的/ 服务/ 需求/ 不断涌现/ 、/ 服务质量/ 要求/ 的/ 提高/ 以及/ 云/ 计算/ 等/ 新兴/ 计算/ 模式/ 的/ 发展/ ,/ 数据中心/ 的/ 数量/ 和/ 规模/ 得到/ 了/ 迅速/ 的/ 发展/ ,/ 大型/ 数据中心/ 运行/ 着/ 数万/ 台/ 服务器/ [/ 1/ ]/ ./ 为了/ 满足/ 服务器之间/ 的/ 大规模/ 通信/ 需求/ ,/ 数据中心/ 网络/ 面临/ 成本/ 、/ 结构/ 和/ 性能/ 等/ 多个/ 方面/ 的/ 挑战/ ./ 首先/ ,/ 现在/ 数据中心/ 网络/ 的/ 交换/ 设备/ 一般/ 采用/ 电域/ 交换/ 技术/ ,/ 电域/ 交换/ 技术/ 虽然/ 可以/ 快速/ 、/ 灵活/ 的/ 切换/ 数据包/ 的/ 传输/ 路径/ ,/ 但/ 其/ 本身/ 存在/ 通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 等/ 缺点/ ./ 当前/ 数据中心/ 网络/ 一般/ 采用/ 两层/ 或者/ 3/ 层/ 的/ 树形/ 结构/ ,/ 为了/ 降低成本/ 以及/ 实际/ 部署/ 的/ 复杂性/ ,/ 导致/ 网络/ 的/ 各层/ 之间/ 存在/ 严重/ 的/ 网络带宽/ 缩减/ ①/ ./ 因此/ 汇聚/ 层/ 和/ 核心/ 层交换机/ 成为/ 网络通信/ 的/ 瓶颈/ ,/ 并/ 带来/ 了/ 网络/ 整体/ 利用率/ 低/ 以及/ 数据传输/ 时延/ 较长/ 等/ 问题/ [/ 2/ ]/ ./ 其次/ ,/ 现在/ 的/ 数据中心/ 网络系统/ 使用/ 大量/ 的/ 电域/ 交换机/ 来/ 搭建/ 拓扑/ 结构/ ,/ 交换机/ 之间/ 一般/ 使用/ 光纤/ 来/ 连接/ ,/ 数据包/ 每/ 通过/ 一级/ 交换机/ 都/ 要/ 经过/ 光/ -/ 电/ -/ 光/ 的/ 转换/ ,/ 存在/ 着/ 巨大/ 的/ 能量消耗/ ./ 在/ 2010/ 年/ ,/ 全球/ 的/ 数据中心/ 消耗/ 了/ 全球/ 用电量/ 的/ 1.1/ %/ ~/ 1.5/ %/ ,/ 并且/ 这个/ 比例/ 在/ 持续/ 增加/ [/ 3/ ]/ ./ 随着/ 服务器/ 节能/ 技术/ 的/ 发展/ ,/ 处理器/ 等/ 主要/ 部件/ 的/ 能耗/ 已/ 得到/ 有效/ 的/ 控制/ ,/ 而/ 网络设备/ 的/ 能耗/ 则/ 日益突出/ ./ 例如/ ,/ 在/ Google/ 的/ 数据中心/ 中/ ,/ 当/ 服务器/ 处理器/ 的/ 利用率/ 为/ 100/ %/ 时/ ,/ 网络系统/ 的/ 能耗/ 占/ 总/ 能耗/ 的/ 20/ %/ ;/ 而/ 当/ 处理器/ 的/ 利用率/ 为/ 15/ %/ 时/ ,/ 网络系统/ 的/ 能耗/ 达到/ 数据中心/ 总/ 能耗/ 的/ 50/ %/ ./ 在/ Google/ 数据中心/ 中/ ,/ 服务器/ 处理器/ 的/ 利用率/ 只有/ 10/ %/ ~/ 50/ %/ [/ 4/ -/ 5/ ]/ ,/ 网络/ 能耗/ 已经/ 成为/ 现在/ 数据中心/ 能耗/ 的/ 重要/ 组成部分/ ./ 随着/ 集成电路/ 工艺/ 和/ 硅光/ 技术/ 的/ 发展/ ,/ 光/ 交换/ 技术/ 逐渐/ 进入/ 实用阶段/ ,/ 像/ MEMS/ (/ Micro/ -/ Electro/ -/ MechanicalSystems/ )/ 光/ 交换机/ 和/ AWGR/ (/ Arrayed/ -/ WaveguideGratingRouter/ )/ 光/ 路由器/ 已/ 在/ 工业/ 环境/ 中/ 使用/ ./ 与/ 电域/ 交换/ 技术/ 相比/ ,/ 光/ 交换/ 技术/ 具有/ 极高/ 的/ 传输/ 带宽/ 以及/ 几乎/ 不/ 受限制/ 的/ 交换/ 能力/ ,/ 非常适合/ 于/ 缓解/ 当前/ 数据中心/ 网络通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 和/ 高能耗/ 的/ 问题/ [/ 6/ ]/ ./ 基于/ 以上/ 特征/ ,/ 最近/ 的/ 研究/ 提出/ 了/ 若干/ 面向/ 数据中心/ 的/ 光电/ 混合/ 网络结构/ ,/ 如/ c/ -/ Through/ [/ 7/ ]/ 、/ Helios/ [/ 8/ ]/ 、/ OSA/ [/ 9/ ]/ 等/ ;/ 它们/ 结合/ 高带宽/ 的/ 光域/ 网络/ 和/ 传统/ 的/ 电域/ 网络/ ,/ 并/ 构建/ 统一/ 的/ 逻辑/ 控制/ 平面/ ,/ 将/ 网络流量/ 按照/ 需求/ 分配/ 到/ 电域/ 网络/ 和/ 光域/ 网络/ 上/ 传输/ ./ 当前/ 光电/ 混合/ 网络结构/ 通常/ 基于/ 慢速/ 光/ 线路/ 切换/ 器件/ ,/ 在/ 机柜/ 之间/ 建立/ 一条/ 持续时间/ 很长/ 的/ 光/ 链路/ ,/ 直接/ 将/ 小/ 部分/ 数据量/ 非常/ 大/ 的/ 网络/ 流由/ 一个/ 机柜/ 传输/ 到/ 另/ 一个/ 机柜/ 中/ ,/ 有效/ 地/ 缓解/ 了/ 现在/ 数据中心/ 网络/ 的/ 问题/ ./ 然而/ 当前/ 光电/ 混合/ 网络/ 所/ 使用/ 的/ 慢速/ 路径/ 切换/ 光/ 交换机/ 的/ 重/ 配置/ 延迟/ 很/ 高/ ,/ 严重/ 限制/ 了/ 混合/ 网络/ 的/ 适用性/ ./ 在/ 光/ 线路/ 的/ 重新配置/ 过程/ 中/ ,/ 必须/ 缓存/ 分配/ 到/ 光域/ 网络/ 上/ 传输/ 的/ 网络/ 包/ ,/ 等待/ 光/ 线路/ 配置/ 的/ 完成/ ./ 因此/ 这些/ 结构/ 对/ 运行/ 的/ 应用程序/ 的/ 通信/ 模式/ 有/ 较大/ 的/ 限制/ ,/ 需要/ 稳定/ 、/ 持续/ 的/ 网络/ 流/ 来/ 分摊/ 线路/ 配置/ 所/ 引起/ 的/ 延迟/ ./ 如/ c/ -/ Through/ 使用/ 的/ MEMS/ 光/ 交换机/ 采用/ 机械/ 方式/ 控制/ 光/ 线路/ 的/ 建立/ ,/ 光/ 线路/ 的/ 配置/ 过程/ 需要/ 数十/ 毫秒/ 的/ 时间/ ,/ 主要/ 面向/ 于/ 虚拟机/ 迁移/ 等/ 持续时间/ 较长/ 的/ 网络/ 流/ ,/ 并/ 不能/ 适应/ 于/ 不同/ 大小/ 和/ 快速/ 变化/ 的/ 网络/ 流/ [/ 10/ -/ 11/ ]/ ./ 随着/ 快速/ 可调/ 波长/ 激光器/ TWC/ 技术/ [/ 12/ ]/ 以及/ ①/ CiscoDataCenterInfrastructure2/ ./ 5DesignGuide/ ./ http/ :/ // // Page3/ 光波长/ 路由器/ AWGR/ 技术/ [/ 13/ ]/ 逐渐/ 的/ 成熟/ ,/ 使/ 光电/ 混合/ 网络结构/ 应对/ 动态/ 、/ 多样/ 的/ 流量/ 模式/ 成为/ 可能/ ./ 快速/ 可调/ 波长/ 激光器/ 具有/ 纳秒/ 级/ 延迟/ 的/ 波长/ 变换/ 特性/ ,/ 而/ 光波长/ 路由器/ 是/ 能够/ 基于/ 波长/ 进行/ 路由/ 的/ 被动/ 光/ 器件/ ./ 使用/ 这/ 两种/ 器件/ 构建/ 的/ 光域/ 网络结构/ ,/ 配合/ 适当/ 的/ 控制/ 平面/ ,/ 可以/ 快速/ 、/ 低/ 延迟/ 地重/ 配置/ 光/ 线路/ ,/ 使/ 通信/ 模式/ 复杂/ 的/ 应用程序/ 也/ 可以/ 利用光/ 网络/ ,/ 提高/ 整个/ 数据中心/ 网络/ 的/ 普适性/ ./ 为了/ 提高/ 现在/ 数据中心/ 光电/ 混合/ 网络/ 应对/ 复杂/ 网络流量/ 模式/ 的/ 能力/ ,/ 使/ 更/ 多/ 的/ 网络/ 流能/ 在/ 光域/ 网络/ 上/ 传输/ ,/ 本文/ 首次/ 提出/ 了/ 一种/ 使用/ TWC/ 和/ AWGR/ 两种/ 光/ 器件/ 构建/ 的/ OCS/ // EPS/ 异构/ 光电/ 混合/ 网络结构/ Ace/ -/ net/ ;/ 为了/ 充分利用/ TWC/ 光/ 器件/ 纳秒/ 级/ 的/ 波长/ 变换/ 特性/ 和/ AWGR/ 基于/ 波长/ 路由/ 的/ 特性/ ,/ 设计/ 了/ 快速/ 的/ 控制/ 平面/ ,/ 降低/ 线路/ 重/ 配置/ 的/ 延迟/ ,/ 在/ 机柜/ 之间/ 快速/ 的/ 建立/ 起/ 一条/ 持续/ 的/ 光/ 链路/ ./ 相比/ 于/ 现有/ 的/ 光电/ 混合/ 网络结构/ ,/ Ace/ -/ net/ 使用/ 实时/ 的/ 流量/ 需求/ 测量/ 和/ 带宽/ 信息/ 收集/ 方法/ ,/ 并/ 使用/ 快速/ 的/ 算法/ 进行/ 线路/ 仲裁/ ./ 在/ Ace/ -/ net/ 中/ ,/ 电域/ 网络/ 和/ 光域/ 网络/ 并/ 没有/ 主次/ 之分/ ,/ 其中/ 光域/ 网络/ 主要/ 用于/ 传输数据/ 量/ 稍/ 大/ 的/ 网络/ 流/ ;/ 电域/ 网络/ 主要/ 用来/ 传输/ 未/ 建立/ 光/ 线路/ 的/ 机柜/ 之间/ 的/ 流量/ 和/ 光域/ 网络/ 重建/ 期间/ 的/ 网络流量/ ./ 与/ 现有/ 的/ 光电/ 混合/ 网络系统/ 相比/ ,/ Ace/ -/ net/ 的/ 设计/ 主要/ 有/ 3/ 个/ 创新/ 点/ ./ 首先/ ,/ 它/ 首次/ 使用/ 快速/ 可调/ 波长/ 激光器/ TWC/ 和/ 光波长/ 路由器/ AWGR/ 替代/ 慢速/ 路径/ 切换/ 光/ 交换机/ ,/ 构建/ OCS/ // EPS/ 光电/ 混合/ 网络结构/ ./ 其次/ ,/ 它/ 使用/ 实时/ 流量/ 需求/ 测量/ 、/ 收集/ 方法/ ,/ 能/ 灵活/ 应对/ 服务器/ 的/ 流量/ 变化/ ./ 第三/ ,/ 它/ 采用/ 以/ 目的/ 地址/ 为/ 索引/ 的/ 虚拟/ 队列/ 管理/ 方式/ ,/ 将/ 数据包/ 缓存/ 在/ 主机/ 内存/ 中/ ,/ 但/ 所/ 占用/ 的/ 内存/ 量/ 远远/ 小于/ 现有/ 的/ 光电/ 混合/ 网络结构/ ./ 本文/ 的/ 主要/ 贡献/ 有/ :/ (/ 1/ )/ 提出/ 了/ 一种/ 使用/ TWC/ 和/ AWGR/ 光/ 路由器/ 的/ OCS/ // EPS/ 异构/ 光电/ 混合/ 网络结构/ Ace/ -/ net/ ,/ 其/ 使用/ 可/ 快速/ 变换/ 波长/ 的/ TWC/ 光/ 器件/ 和/ 光波长/ 路由器/ AWGR/ 在/ 两个/ 机柜/ 间/ 建立/ 起/ 一条/ 持续/ 的/ 光/ 线路/ ,/ 使/ 更/ 多样/ 的/ 网络/ 流/ 可以/ 在/ 高带宽/ 的/ 光域/ 网络/ 中/ 传输/ ,/ 进一步/ 减轻/ 电域/ 网络/ 的/ 压力/ ;/ (/ 2/ )/ 设计/ 了/ 统一/ 控制/ 平面/ ,/ 并/ 使用/ 了/ 实时/ 的/ 流量/ 需求/ 测量/ 机制/ 和/ 快速/ 的/ 光/ 链路/ 调度/ 配置/ 算法/ ,/ 充分发挥/ TWC/ 可/ 快速/ 变换/ 波长/ 的/ 特性/ ;/ (/ 3/ )/ 采用/ 了/ 终端/ 缓存/ 的/ 方法/ ,/ 使用/ 较少/ 的/ 服务器/ 内存/ 缓存/ 待/ 发送/ 的/ 数据包/ ,/ 同时/ 使用/ 以/ 目的/ 地址/ 为/ 索引/ 的/ 虚拟/ 队列/ 管理/ 方式/ ,/ 对/ 每/ 一台/ 服务器/ 中/ 的/ 网络/ 流/ 进行/ 统一/ 的/ 管理/ ,/ 减少/ 服务器/ 内存/ 的/ 额外/ 消耗/ ;/ (/ 4/ )/ 对此/ 结构/ 进行/ 了/ 详细/ 的/ 论证/ 分析/ ,/ 并/ 使用/ 模拟器/ 进行/ 了/ 评测/ ,/ 结果表明/ 此/ 结构/ 可以/ 很/ 好/ 地/ 降低/ 网络/ 中端/ 到/ 端的/ 延迟/ ,/ 极大/ 地/ 增加/ 了/ 网络/ 的/ 吞吐/ 率/ ./ 本文/ 第/ 2/ 节/ 介绍/ 光/ 器件/ 的/ 相关/ 背景/ 知识/ ;/ 第/ 3/ 节/ 介绍/ 数据中心/ 混合/ 网络/ 的/ 研究/ 现状及/ 相关/ 工作/ ;/ 第/ 4/ 节/ 详细/ 阐述/ 光电/ 混合/ 网络/ 的/ 组成/ 和/ 结构/ ;/ 第/ 5/ 节对/ 光电/ 混合/ 网络/ 的/ 性能/ 进行/ 测评/ ;/ 第/ 6/ 节对/ 本文/ 进行/ 总结/ ./ 2/ 光/ 器件/ 简介/ 随着/ 集成电路/ 工艺/ 和/ 硅光/ 技术/ 的/ 发展/ ,/ 光/ 器件/ 的/ 设计/ 和/ 制造/ 技术/ 逐渐/ 的/ 成熟/ ,/ 许多/ 光/ 传输技术/ 和/ 光/ 交换/ 技术/ 已/ 在/ 通信/ 领域/ 广泛/ 使用/ ./ 本/ 部分/ 将/ 对/ 现在/ 光电/ 混合/ 网络结构/ 中/ 所/ 使用/ 的/ 光/ 器件/ 和/ 涉及/ 的/ 光通信/ 技术/ 进行/ 介绍/ ./ MEMS/ -/ switches/ (/ Micro/ -/ Electro/ -/ MechanicalSystemSwitches/ )/ ./ MEMS/ 光/ 交换机/ 是/ 一种/ 由/ 微型/ 机械/ 装置/ 控制/ 的/ 光/ 器件/ ;/ 在/ 光/ 交换机/ 内部/ 有/ 一个/ N/ ×/ N/ 的/ 反光镜/ 阵列/ ,/ 这些/ 反光镜/ 依附/ 在/ 一些/ 微小/ 的/ 电机/ 上/ ,/ 由/ 一个/ 嵌入式/ 处理器/ 来/ 控制/ ./ 根据/ 外部/ 的/ 控制/ 命令/ ,/ 嵌入式/ 处理器/ 通过/ 控制/ 反光镜/ 阵列/ 的/ 旋转/ 角度/ ,/ 将/ 一个/ 端口/ 输入/ 的/ 激光束/ 重定向/ 到/ 一个/ 输出/ 端口/ ,/ 在/ 两个/ 端口/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 链路/ ;/ 由于/ 它/ 使用/ 的/ 是/ 微型/ 的/ 机械/ 控制系统/ ,/ 配置/ 一次/ 需要/ 数/ 毫秒/ 至/ 数十/ 毫秒/ 的/ 时间/ ./ AWGR/ (/ Arrayed/ -/ WaveguideGratingRouter/ )/ ,/ 一种/ 根据/ 光/ 的/ 波长/ 信息/ 进行/ 路由/ 的/ 被动/ 光学/ 器件/ ,/ 其/ 循环/ 波长/ 路由/ 特性/ 允许/ 不同/ 输入/ 端口/ 的/ 光束/ 路由/ 至/ 同一/ 输出/ 端口/ ./ 一个/ N/ 端口/ 的/ AWGR/ ,/ 由/ 端口/ i/ 输入/ 的/ 波长/ 为/ w/ 的/ 光束/ 将/ 被/ 路由/ 至/ [/ (/ i/ +/ w/ -/ 2/ )/ modN/ ]/ +/ 1/ 端口/ ,/ 如图/ 1/ 所示/ 一个/ 8/ 端口/ 的/ AWGR/ 及其/ 波长/ 路由表/ [/ 14/ ]/ ./ 不同/ 波长/ 的/ 光线/ 通过/ 同一/ 输出/ 端口/ 时/ ,/ 这些/ 光线/ 将/ 被/ 复用/ 在/ 一条/ 光纤/ 上/ 传输/ ,/ 而/ 不/ 发生/ 网络/ 竞争/ ./ AWGR/ 是/ 被动/ 器件/ ,/ 具有/ 极低/ 的/ 功耗/ ,/ 延迟/ 仅/ 皮秒/ 至/ 纳秒/ 级/ ./ 更为/ 关键/ 的/ 是/ ,/ AWGR/ 可以/ 实现/ 较/ 高/ 的/ 维度/ ,/ 在/ 250nmSOI/ (/ Silicon/ -/ On/ -/ Insulator/ )/ 技术/ 下/ ,/ 加州大学/ 戴维斯/ 分校/ 的/ BenYoo/ 教授/ 团队/ 流片/ 成功/ 的/ AWGR/ 具有/ 512/ 端口/ ,/ 面积/ 仅/ 16mm/ ×/ 11mm/ [/ 13/ ]/ ./ OSM/ (/ OpticalSwitchingMatrix/ )/ ./ 一般/ 情况/ 下/ ,/ OSM/ 模块/ 采用/ 二分/ 矩阵/ 形式/ ,/ 有/ N/ 个/ 输入/ 端口/ 和/ N/ 个/ 输出/ 端口/ ,/ 通过/ 合适/ 的/ 配置/ 可以/ 将/ 任何/ 一个/ Page4/ 图/ 18/ 端口/ AWGR/ 及其/ 波长/ 路由表/ 输入/ 端口/ 的/ 光/ 线路/ 传输/ 到/ 任何/ 一个/ 输出/ 端口/ ./ 现在/ 常用/ 的/ OSM/ 器件/ 一般/ 采用/ MEMS/ 技术/ 来/ 实现/ ,/ 使用/ 机械/ 控制/ 来/ 重新配置/ 端口/ 的/ 连接/ 关系/ ,/ 光/ 线路/ 的/ 重/ 配置/ 时间/ 与/ MEMS/ 光/ 交换机/ 类似/ [/ 15/ ]/ ./ WSS/ (/ WavelengthSelectiveSwitch/ )/ ./ 通常/ 是/ 一个/ 1/ ×/ N/ 的/ 光/ 交换机/ ,/ 包含/ 一个/ 光/ 输入/ 端口/ 和/ N/ 个/ 输出/ 端口/ ,/ 配置/ 一次/ 的/ 时间/ 需要/ 数/ 毫秒/ ./ 它/ 可以/ 将/ 输入/ 的/ 一系列/ 波长/ 的/ 光束/ 划分/ 成/ 不同/ 的/ 组/ ,/ 通过/ 不同/ 的/ 输出/ 端口/ 输出/ ./ 例如/ ,/ 如果/ 输入/ 端口/ 输入/ 的/ 光线/ 中/ 包括/ 100/ 个/ 波长/ ,/ 那么/ 它/ 可以/ 将/ 波长/ 1/ ~/ 30/ 路由/ 到/ 1/ 号/ 输出/ 端口/ ,/ 50/ ~/ 80/ 路由/ 到/ 2/ 号/ 输出/ 端口/ ./ TWC/ (/ TunableWavelengthConverters/ )/ ./ 快速/ 可调/ 波长/ 激光器/ ,/ TWC/ 可以/ 将/ 一个/ 输入/ 的/ 光/ 信号/ 变换/ 成/ 给定/ 的/ 波长/ 输出/ ./ 每个/ TWC/ 包含/ 一个/ 可调/ 激光器/ 、/ 一个/ SOA/ (/ SemiconductorOpticalAmplifier/ )/ 和/ 一个/ MZI/ (/ Mach/ -/ ZehnderInterferometer/ )/ ./ 在/ 波长/ 调制/ 过程/ 中/ ,/ 首先/ 由/ MZI/ 生成/ 给定/ 波长/ 的/ 激光束/ ,/ 然后/ 由/ SOA/ 来/ 完成/ 激光/ 的/ 调制/ 工作/ ;/ 它/ 接受/ 某个/ 输入/ 波长/ 的/ 激光束/ ,/ 然后/ 按照/ 给定/ 的/ 控制/ ,/ 将/ 其/ 输出/ 为/ 给定/ 波长/ 的/ 激光束/ ./ 现在/ 的/ TWC/ 可以/ 实现/ 160Gbps/ 的/ 波长/ 转换/ 带宽/ [/ 12/ ]/ ,/ 其/ 重构/ 时间/ 与/ 输入输出/ 的/ 波长/ 相关/ ,/ 延迟/ 波动/ 范围/ 在/ 1ns/ 到/ 30ns/ 之间/ ./ OCA/ (/ OpticalChannelAdapter/ )/ ./ 光/ 发送/ 和/ 接收/ 器件/ ,/ 在/ 发送/ 端/ 它/ 会/ 将/ 电信号/ 转换成/ 光/ 信号/ ,/ 在/ 接收端/ 它会/ 将/ 光/ 信号/ 转换成/ 电信号/ ./ 每/ 一个/ OCA/ 器件/ 有/ 一个/ 1N/ 的/ 分光/ 器/ ,/ 可以/ 将/ 一束/ 混合/ 光/ 分离/ 成/ 多束/ 单/ 波长/ 的/ 光/ ,/ 同时/ 最/ 多/ 可以/ 处理/ N/ 种/ 波长/ ;/ 每/ 一个/ 器件/ 都/ 有/ 一个/ 接收器/ 阵列/ ,/ 可以/ 将光/ 信号/ 转换/ 为/ 电信号/ ./ 使用/ 该/ 器件/ 可以/ 将/ 一束/ 由/ 多种/ 波长/ 混合/ 而成/ 的/ 光/ 信号/ 转变/ 为/ 电信号/ ,/ 使/ 其/ 继续/ 在/ 电域/ 网络/ 中/ 传输/ ./ 3/ 相关/ 工作/ 为了/ 解决/ 网络通信/ 能力/ 不足/ 的/ 问题/ ,/ 最近/ 的/ 研究/ 提出/ 了/ 若干/ 新/ 的/ 数据中心/ 网络结构/ [/ 16/ -/ 19/ ]/ ,/ 从/ 不同/ 方面/ 弥补/ 了/ 传统/ 树形/ 网络结构/ 的/ 不足/ ./ 但是/ 这些/ 网络结构/ 仍然/ 使用/ 纯电域/ 交换/ 技术/ ,/ 无法/ 解决/ 现有/ 电域/ 网络通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 、/ 能耗/ 高等/ 缺点/ ./ 随着/ 集成电路/ 工艺/ 和/ 硅光/ 技术/ 的/ 发展/ ,/ 光/ 交换/ 技术/ 逐渐/ 进入/ 实用阶段/ ,/ 像/ MEMS/ (/ Micro/ -/ Electro/ -/ MechanicalSystems/ )/ 光/ 交换机/ 和/ AWGR/ (/ Arrayed/ -/ WaveguideGratingRouter/ )/ 光/ 路由器/ 已/ 在/ 工业/ 环境/ 中/ 使用/ ./ 与/ 电域/ 交换/ 技术/ 相比/ ,/ 光/ 交换/ 技术/ 具有/ 极高/ 的/ 传输/ 带宽/ 以及/ 几乎/ 不/ 受限制/ 的/ 交换/ 能力/ ,/ 非常适合/ 于/ 缓解/ 当前/ 数据中心/ 网络通信/ 带宽/ 低/ 、/ 交换/ 容量/ Page5/ 有限/ 和/ 高能耗/ 的/ 问题/ [/ 6/ ]/ ./ 基于/ 以上/ 特征/ ,/ 最近/ 的/ 研究/ 提出/ 了/ 若干/ 面向/ 数据中心/ 的/ 光电/ 混合/ 网络结构/ ,/ 如/ c/ -/ Through/ [/ 7/ ]/ 、/ Helios/ [/ 8/ ]/ 、/ OSA/ [/ 9/ ]/ 、/ REACToR/ [/ 20/ ]/ 等/ ;/ 它们/ 结合/ 高带宽/ 的/ 光域/ 网络/ 和/ 传统/ 的/ 电域/ 网络/ ,/ 并/ 构建/ 统一/ 的/ 逻辑/ 控制/ 平面/ ,/ 将/ 网络流量/ 按照/ 需求/ 分配/ 到/ 电域/ 网络/ 和/ 光域/ 网络/ 上/ 传输/ ,/ 以此/ 来/ 缓解/ 纯电域/ 网络/ 中/ 的/ 问题/ ./ c/ -/ Through/ 是/ 一种/ 基于/ MEMS/ 光/ 交换机/ 构造/ 的/ 光电/ 混合/ 网络结构/ ,/ 它/ 在/ 树形/ 电域/ 网络/ 的/ 基础/ 上/ 增加/ 一层/ 光域/ 网络/ ,/ 数据中心/ 中/ 的/ ToR/ (/ TopofRack/ )/ 交换机/ 同时/ 连接/ 到/ 电域/ 网络/ 和/ 光域/ 网络/ ;/ 通过/ 控制/ MEMS/ 光/ 交换机/ 在/ 两个/ 机柜/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 线路/ ,/ 使/ 数据量/ 很大/ 的/ 网络/ 流在/ 光域/ 网络/ 上/ 传输/ ,/ 其/ 网络拓扑/ 结构/ 如图/ 2/ 所示/ ./ 通过/ 流量/ 监控/ 系统/ 监测/ 任意/ 两个/ 机柜/ 之间/ 的/ 流量/ 需求/ ,/ 形成/ 一个/ 流量/ 需求/ 矩阵/ ;/ 为了/ 尽可能/ 地/ 利用/ 高带宽/ 的/ 光/ 链路/ ,/ 将/ 机柜/ 之间/ 光/ 线路/ 的/ 配置/ 关系/ 转变成/ 了/ 一个/ 最大/ 权值/ 的/ 完美/ 匹配/ 问题/ ,/ 使用/ Edmonds/ 算法/ 求/ 出/ 这个/ 问题/ 的/ 最优/ 解/ ;/ 根据/ 计算结果/ 配置/ MEMS/ 光/ 交换机/ ,/ 在/ 机柜/ 之间/ 建立/ 光/ 线路/ 连接/ ,/ 然后/ 使用/ 基于/ VLAN/ 的/ 路由/ 方法/ 将/ ToR/ 交换机/ 中/ 的/ 流量/ 分配/ 给/ 电域/ 网络/ 和/ 光域/ 网络/ ./ c/ -/ Through/ 使用/ 了/ 慢速/ 的/ MEMS/ 交换机/ ,/ 在/ 很长/ 的/ 间隔/ 后/ 进行/ 一次/ 新/ 的/ 配置/ ,/ 且/ 配置/ 一次/ 的/ 时间/ 需要/ 数百/ 毫秒/ 的/ 时间/ ,/ 系统/ 缺乏/ 灵活性/ 且/ 只/ 适合/ 于/ 处理/ 数据量/ 很大/ 的/ 网络/ 流/ ,/ 适应性/ 有限/ ./ Helios/ 是/ 为/ 模块化/ 的/ 数据中心/ 设计/ 的/ 一种/ 光电/ 混合/ 网络结构/ ,/ 采用/ 了/ 与/ c/ -/ Through/ 类似/ 的/ MEMS/ 光/ 交换机/ ,/ 在/ PoD/ 之间/ 动态/ 建立/ 光/ 线路/ ,/ 同时/ 它/ 使用/ 了/ WDM/ (/ WavelengthDivisionMultiplex/ )/ 技术/ 增加/ 光/ 线路/ 的/ 带宽/ ,/ 网络拓扑/ 结构/ 如图/ 3/ 所示/ ./ 其/ 网络/ 采用/ 两层/ 的/ 多根/ 树结构/ ,/ 核心层/ 同时/ 采用/ 电域/ 交换机/ 和/ 光域/ 交换机/ :/ 电域/ 交换机/ 用于/ 处理/ all/ -/ to/ -/ all/ 的/ 通信/ ,/ 而光域/ 交换机/ 用于/ 处理机/ 柜间/ 高/ 流量/ 需求/ 的/ 大/ 流量/ 通信/ ./ 在/ 交换机/ 中/ 使用/ TM/ (/ TopologyManager/ )/ 模块/ 统计/ 两个/ 业务/ 单元/ 之间/ 的/ 流量/ 需求/ 和/ 连接数/ ,/ 形成/ 一个/ 流量/ 需求/ 矩阵/ ;/ 使用/ Edmonds/ 算法/ 计算/ 出/ 最优/ 的/ 光/ 链路/ 连接/ 关系/ 后/ ,/ 光/ 交换机/ 管理/ 模块/ CSM/ (/ CircuitSwitchManager/ )/ 在/ PoD/ 之间/ 建立/ 光/ 链路/ ;/ 最后/ 通过/ 接入/ 层交换机/ 控制软件/ PSM/ (/ PoDSwitchManager/ )/ 在/ 交换机/ 中/ 修改/ 路由/ 关系/ ./ Helios/ 与/ c/ -/ Through/ 存在/ 相似/ 的/ 问题/ ,/ 整个/ 配置/ 流程/ 需要/ 数百/ 毫秒/ 的/ 时间/ ,/ 网络/ 缺乏/ 灵活性/ ./ OSA/ 是/ 一种/ 使用/ WSS/ 和/ OSM/ 光/ 交换机/ 在/ 一个/ PoD/ 内/ 的/ 机柜/ 之间/ 构建/ 的/ 多/ 跳光/ 网络结构/ ,/ 其/ 结构/ 如图/ 4/ 所示/ ./ 它/ 利用光/ 线路/ 交换/ 的/ 方式/ ,/ 将/ 网络/ 根据/ 流量/ 的/ 特征/ 重/ 构成/ 直连/ 网络拓扑/ 结构/ ,/ 数据包/ 从源/ 端点/ 到/ 目的/ 端点/ 需要/ 经过/ 多/ 跳步/ ./ 通过/ 使用/ WSS/ 来/ 配置/ 不同/ 波长/ 的/ 光线/ ,/ 其/ 连接/ 的/ 每条/ 链路/ 的/ 带宽/ 可以/ 动态/ 的/ 调节/ ./ 它/ 周期性地/ 收集/ 机柜/ 间/ 网络/ 的/ 需求/ 信息/ ,/ 并/ 根据/ 这些/ 信息/ 将/ 拓扑/ 的/ 计算/ 转换成/ 一个/ 求解/ 带权值/ 的/ b/ -/ matching/ 问题/ ,/ 然后/ 通过/ 控制/ OSM/ 光/ 交换机/ 和/ WSS/ 光/ 器件/ 重新配置/ 拓扑/ 并/ 为/ 链路/ 分配/ 带宽/ ./ OSA/ 结构/ 同样/ 缺乏/ 灵活性/ 和/ 普适性/ ,/ 配置/ 一次/ 的/ 时间/ 需要/ 数百/ 毫秒/ 的/ 时间/ ,/ 仍然/ 需要/ 稳定/ 、/ 持续/ 的/ 网络/ 流/ 的/ 支持/ ./ DOS/ [/ 21/ ]/ 是/ 一种/ 基于/ AWGR/ 光/ 路由器/ 件/ 的/ 全光域/ 包交换/ OPS/ (/ OpticalPacketSwitching/ )/ 网络结构/ ,/ 它/ 只/ 在/ ToR/ 交换机/ 中/ 采用/ 了/ 电域/ 交换/ ,/ 而/ 上层/ 网络/ 采用/ 全光域/ 互连/ ,/ 如图/ 5/ 所示/ ./ 每/ 一个/ ToR/ 交换机/ 通过/ TWC/ 连接/ 到/ AWGR/ 光/ 路由器/ 的/ 一个/ 端口/ ,/ 在/ 每/ 一个/ TWC/ 的/ 前端/ 有/ 一个/ 标签/ 提取/ 器/ LEPage6/ 图/ 4OSA/ 结构/ (/ LabelExtractor/ )/ ,/ 它/ 可以/ 提取/ 每/ 一个/ 数据包/ 的/ 目的/ 地址/ ./ 当/ 一个/ 数据包/ 要/ 传输/ 时/ ,/ LE/ 会/ 提取/ 其/ 目的/ 地址/ 信息/ ,/ 同时/ 将/ 信息/ 传给/ 中央/ 控制/ 平面/ ;/ 然后/ 由/ 中央/ 控制/ 平面/ 调整/ TWC/ 的/ 输出/ 波长/ ,/ 经由/ AWGR/ 光/ 路由器/ 将/ 数据包/ 传输/ 到/ 相应/ 的/ 端口/ ;/ 为了/ 防止/ 波长/ 竞争/ ,/ 在/ 系统/ 中/ 存在/ 一个/ 单独/ 的/ 电域/ 缓存/ ,/ 将/ 不能/ 发送/ 的/ 数据包/ 暂时/ 缓存/ ./ DOS/ 是/ 一种/ 基于/ 数据包/ 交换/ 的/ 光域/ 网络/ ,/ 它/ 所/ 转发/ 的/ 每个/ 数据包/ 都/ 要/ 经过/ LE/ 和/ 控制/ 平面/ 的/ 处理/ ,/ 增加/ 了/ 数据包/ 的/ 延迟/ ;/ 同时/ 它/ 所/ 采用/ 的/ 电域/ 缓存/ 需要/ 进行/ 光电/ 转换/ ,/ 增加/ 了/ 能耗/ ./ c/ -/ Through/ 、/ Helios/ 、/ OSA/ 等/ 网络系统/ 在/ 原有/ 电域/ 网络/ 的/ 基础/ 上/ 使用/ 了/ 高带宽/ 的/ 光/ 链路/ 来/ 缓解/ 当前/ 电域/ 网络通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 、/ 高能耗/ 的/ 问题/ ./ 他们/ 虽然/ 在结构上/ 各有/ 差异/ ,/ 但是/ 他们/ 都/ 是/ 依靠/ 慢速/ MEMS/ 光/ 交换机/ 来/ 重构/ 网络连接/ 关系/ ,/ 计算/ 连接/ 关系/ 、/ 拓扑/ 重/ 配置/ 需要/ 数百/ 毫秒/ 的/ 时间/ ./ 因此/ 这些/ 结构/ 对/ 运行/ 的/ 应用程序/ 的/ 通信/ 模式/ 有/ 较大/ 的/ 限制/ ,/ 需要/ 稳定/ 、/ 持续/ 的/ 网络/ 流/ 来/ 分摊/ 线路/ 配置/ 所/ 引起/ 的/ 延迟/ ./ Ace/ -/ net/ 虽然/ 也/ 是/ 基于/ 线路/ 交换/ 的/ 光电/ 混合/ 网络结构/ ,/ 但/ 其/ 使用/ 的/ 纳秒/ 级/ 波长/ 变换/ 器件/ TWC/ 和/ 基于/ 波长/ 路由/ 的/ 光/ 路由器/ AWGR/ ,/ 使用/ 快速/ 的/ 控制/ 平面/ 在/ 机柜/ 之间/ 快速/ 的/ 建立/ 起/ 一条/ 持续/ 的/ 光/ 链路/ ,/ 可以/ 灵活/ 的/ 应对/ 多样/ 、/ 复杂/ 的/ 网络流量/ 模式/ ./ DOS/ 虽然/ 也/ 是/ 使用/ 快速/ 波长/ 变换/ 器件/ TWC/ 和/ AWGR/ 光/ 路由器/ 构建/ 的/ 网络/ ,/ 但是/ 其实质/ 是/ 一种/ 纯光域/ 网络结构/ ;/ 而/ Ace/ -/ net/ 是/ 结合/ 电域/ 网络/ 灵活性/ 的/ 特点/ 和/ 光域/ 网络/ 高带宽/ 、/ 低能耗/ 的/ 特点/ 所/ 构建/ 的/ 光电/ 混合/ 网络结构/ ,/ 二者/ 具有/ 本质/ 的/ 区别/ ./ 同时/ ,/ DOS/ 网络系统/ 使用/ 单一/ 的/ 控制器/ 对/ 每个/ 数据包/ 进行/ 进行/ 地址/ 解析/ ,/ 系统/ 的/ 扩展性/ 有限/ ;/ Ace/ -/ net/ 是/ 以/ 一台/ 服务器/ 中/ 到达/ 同一/ 目的/ 地址/ 数据包/ 的/ 总和/ 作为/ 仲裁/ 对象/ ,/ 仲裁/ 复杂度/ 显著/ 降低/ ./ Ace/ -/ net/ 与/ c/ -/ Through/ 、/ DOS/ 有/ 相似之处/ ,/ 但是/ 有着/ 本质/ 的/ 区别/ ./ Ace/ -/ net/ 借鉴/ c/ -/ Through/ 的/ 光/ 线路/ 交换/ (/ OCS/ )/ ,/ 在/ 机柜/ 之间/ 建立/ 起/ 一条/ 较/ 持续/ 的/ 光/ 线路/ ;/ 但/ 其/ 借助/ TWC/ 纳秒/ 级/ 的/ 波长/ 变换/ 特性/ ,/ 可以/ 快速/ 的/ 切换/ 光/ 线路/ ,/ 适应/ 网络/ 流/ 的/ 动态变化/ ./ 同时/ ,/ Ace/ -/ net/ 借鉴/ 了/ DOS/ 所/ 使用/ 的/ 网络结构/ ,/ 但/ 不/ 采用/ 光/ 包交换/ (/ OPS/ )/ 的/ 策略/ ,/ 不/ 需要/ 对/ 每个/ 数据包/ 进行/ 解析/ ;/ 同时/ 在/ 处理/ 光波长/ 竞争/ 时/ ,/ Ace/ -/ net/ 消除/ 了/ DOS/ 中/ 的/ 光电/ 转换/ 、/ 电域/ 缓存/ 的/ 问题/ ./ 4/ 系统/ 设计/ Ace/ -/ net/ 是/ 一种/ 光电/ 混合/ 网络结构/ ,/ 它/ 在/ 现有/ 数据中心/ 电域/ 网络/ 的/ 基础/ 上/ 增加/ 光域/ 网络/ ,/ 有/ 区别/ 地/ 将/ 特征/ 不同/ 的/ 网络/ 流/ 分配/ 到/ 电域/ 网络/ 和/ 光域/ 网络/ Page7/ 上/ 传输/ ,/ 电域/ 网络/ 主要/ 用来/ 传输数据/ 量/ 非常/ 小/ 的/ 网络/ 流/ ,/ 而光域/ 网络/ 用来/ 传输数据/ 量/ 稍/ 大/ 的/ 网络/ 流/ ;/ 其/ 利用/ 快速/ 的/ 控制/ 平面/ 和/ TWC/ 快速/ 的/ 波长/ 变换/ 特性/ 将/ 更/ 多/ 的/ 网络流量/ 分配/ 到/ 光域/ 网络/ 上/ 传输/ ,/ 以/ 适应/ 更/ 复杂/ 的/ 流量/ 模式/ ,/ 进一步/ 缓解/ 现有/ 纯电域/ 网络带宽/ 低/ 、/ 交换/ 容量/ 有限/ 和/ 高耗能/ 的/ 问题/ ./ 本节/ 主要/ 介绍/ Ace/ -/ net/ 的/ 结构/ 以及/ 所/ 使用/ 的/ 主要/ 策略/ 和/ 机制/ ./ 4.1/ 系统结构/ 概览/ 在/ 使用/ Ace/ -/ net/ 混合/ 网络结构/ 的/ 数据中心/ 中/ ,/ N/ 台/ 服务器/ 都/ 被/ 放置/ 到/ R/ 个/ 机柜/ 中/ ,/ 每个/ 机柜/ 中/ 放置/ N/ // R/ 台/ 服务器/ ./ 在/ 机柜/ 内部/ 的/ 每台/ 服务器/ 使用/ 电域/ 链路/ 连接/ 到/ 本/ 机柜/ 内/ 的/ ToR/ 交换机/ 上/ ,/ 机柜/ 之间/ 分别/ 使用/ 电域/ 网络/ 和/ 光域/ 网络/ 互连/ ;/ 电域/ 网络/ 可以/ 使用/ 任意/ 的/ 拓扑/ 结构/ ,/ 而光域/ 网络/ 中/ 所有/ 的/ ToR/ 交换机/ 都/ 连接/ 到/ 同一个/ AWGR/ 光/ 路由器/ ./ 系统/ 的/ 可扩展性/ 依赖于/ AWGR/ 光/ 路由器/ 的/ 端口数/ ./ NTT/ 的/ 研究/ 人员/ 展示/ 了/ 使用/ 400/ 个/ 通道/ 400/ ×/ 400/ 的/ AWGR/ 路由器/ ,/ 覆盖/ 的/ 波长/ 范围/ 为/ 1530nm/ 至/ 1610nm/ [/ 22/ ]/ ,/ 而/ 512/ ×/ 512/ 端口/ 的/ AWGR/ 光/ 器件/ 已经/ 流片/ 成功/ [/ 13/ ]/ ;/ 如果/ 一个/ 机柜/ 内/ 放置/ 40/ ~/ 60/ 台/ 服务器/ ,/ 那么/ 使用/ 一个/ AWGR/ 光/ 路由器/ 的/ 混合/ 网络系统/ 最/ 多/ 可以/ 实现/ 3/ 万多台/ 服务器/ 的/ 互连/ ,/ 完全/ 满足/ 一个/ 超大规模/ 数据中心/ 的/ 需求/ ./ 因此/ 我们/ 假设/ 512/ ×/ 512/ 端口/ 的/ AWGR/ 已经/ 完全/ 满足/ 我们/ 的/ 扩展性/ 需求/ ./ 图/ 6/ 展示/ 了/ Ace/ -/ net/ 网络结构/ 的/ 一个/ 简单/ 例子/ ,/ 它/ 使用/ 传统/ 的/ 三层/ 树形/ 电域/ 网络/ 作为/ 基础/ 网络/ ,/ 使用/ 单层/ 的/ 光域/ 网络/ 作为/ 拓展/ 网络/ ./ 每/ 一个/ ToR/ 交换机/ 有/ 一个/ 连接/ 到/ 上层/ 电域/ 交换机/ 的/ 电域/ 端口/ ;/ 同时/ 它/ 有/ 一个/ 光域/ 端口/ ,/ 端口/ 的/ 发送/ 链路/ 通过/ TWC/ 光/ 器件/ 连接/ 到/ OCA/ 器件/ 的/ 发送/ 端/ (/ Tx/ )/ ,/ 端口/ 的/ 接收/ 链路/ 连接/ 到/ OCA/ 器件/ 的/ 接收端/ (/ Rx/ )/ ./ Ace/ -/ net/ 中/ 使用/ 一个/ 快速/ 仲裁/ 控制系统/ 对/ 混合/ 网络/ 进行/ 控制/ ,/ 它/ 主要/ 完成/ 如下/ 几个/ 工作/ :/ (/ 1/ )/ 收集/ 服务器/ 的/ 通信/ 需求/ 信息/ ,/ 用来/ 作为/ 光/ 线路/ 配置/ 的/ 依据/ ;/ (/ 2/ )/ 根据/ 收集/ 到/ 的/ 通信/ 需求/ 信息/ ,/ 决定/ 光/ 线路/ 的/ 调度/ 配置/ ;/ (/ 3/ )/ 控制/ TWC/ 光/ 器件/ 和/ ToR/ 交换机/ ,/ 在/ 机柜/ 之间/ 建立/ 光/ 线路/ ;/ (/ 4/ )/ 控制/ 每台/ 服务器/ 开始/ 或者/ 停止/ 网络/ 数据/ 的/ 发送/ ./ 仲裁/ 控制系统/ 在/ 逻辑/ 上/ 包含/ 3/ 个/ 部分/ :/ 网络流量/ 测量/ 模块/ 、/ 仲裁/ 控制/ 模块/ 和/ 流量/ 分配/ 控制/ 模块/ ./ 4.2/ 网络流量/ 测量/ Ace/ -/ net/ 根据/ 机柜/ 之间/ 对/ 网络资源/ 的/ 需求/ ,/ 在/ 两个/ 机柜/ 之间/ 建立/ 一条/ 光/ 链路/ 来/ 传输数据/ 量/ 较大/ 的/ 网络/ 流/ ,/ 需要/ 对/ 服务器/ 的/ 流量/ 进行/ 测量/ ,/ 并/ 控制/ 网络/ 包/ 的/ 传输/ 时机/ ,/ 以/ 等待/ 光/ 链路/ 的/ 建立/ ./ 一种/ 理想/ 的/ 网络流量/ 测量/ 机制/ 是/ 采用/ 应用程序/ 通知/ 的/ 方法/ :/ 一个/ 进程/ 在/ 进行/ 网络/ 操作/ 时/ ,/ 首先/ 要/ 将/ 其/ 发送/ 的/ 数据量/ 和/ 目的/ 地址/ 等/ 信息/ 通知/ 网络/ 控制系统/ ./ 这种/ 方法/ 可以/ 准确/ 和/ 及时/ 地/ 测量/ 出/ 应用程序/ 对/ 带宽/ 的/ 需求/ ,/ 但是/ 其/ 对/ 应用程序/ 不/ 透明/ ,/ 需要/ 重新/ 定义/ 编程/ 模型/ ,/ 不能/ 很/ 好/ 的/ 兼容/ 现有/ 的/ 各种/ 应用程序/ 和/ 适应/ 现在/ 数据中心/ 中/ 多样化/ 的/ 应用/ 程序运行/ 环境/ ./ 为了/ 适应/ 现在/ 数据中心/ 的/ 特点/ 和/ 确保/ 应用程序/ 的/ 兼容性/ ,/ Ace/ -/ net/ 采用/ 一种/ 对/ 上层/ 应用程序/ 透明/ 的/ 监测/ 方法/ :/ 通过/ 在/ 操作系统/ 内核/ 中/ 监控/ 每/ 一个/ socket/ 缓冲区/ 的/ 占用/ 情况/ ,/ 并/ 将/ 缓冲区/ 的/ 占用/ 值/ 按照/ 目的/ 地址/ 划分/ 、/ 聚合/ 到/ 虚拟/ 队列/ 中/ ,/ 通过/ 虚拟/ 队列/ 对/ 相同/ 目的/ 地址/ 的/ 流/ 集中管理/ ,/ 完成/ 网络流量/ 测量/ 和/ 网络/ 流传/ 送/ 时机/ 的/ 控制/ ./ 虚拟/ 队列/ 是/ 存在/ 于/ 每台/ 服务器/ 操作系统/ 中/ 的/ 一个/ 表/ 结构/ ,/ 它/ 包含/ 若干/ 的/ 项/ ,/ 其中/ 的/ 任意/ 一项/ Ei/ 对应/ 数据中心/ 中/ 编号/ 为/ i/ 的/ 机柜/ ./ 每一项/ 是/ 一个/ 三元组/ {/ subnetID/ ,/ socketList/ ,/ dataVolume/ }/ ,/ 记录/ 着/ 本机/ 与/ 对应/ 机柜/ 之间/ 的/ 网络/ 流/ 信息/ ;/ 其中/ subnetID/ 是/ 对应/ 机柜/ 的/ 子网/ 号/ ,/ socketList/ 是/ 所有/ 与/ 对应/ 机柜/ 建立/ 连接/ 的/ socket/ 列表/ ,/ dataVolume/ 表示/ socketList/ 在/ 此/ 段时间/ 内所/ 累积/ 的/ 网络/ 数据量/ ./ 流量/ 监测/ 模块/ 根据/ 虚拟/ 队列/ 中/ 的/ 信息/ ,/ 完成/ 对/ 网络/ 流/ 的/ 集中控制/ ./ 在/ 操作系统/ 中/ ,/ 每/ 一个/ TCP/ 连接/ 建立/ 时/ ,/ 都/ 会/ 有/ 一个/ 独占/ 的/ socket/ 缓冲区/ 来/ 缓存数据/ ,/ 从而/ 保证/ 几个/ 并发/ 的/ 连接/ 不会/ 因为/ 某个/ 阻塞/ 而/ 全部/ 无法/ 发送数据/ ./ 在/ Ace/ -/ net/ 中/ ,/ 建立/ 一个/ TCP/ 连接/ 的/ 同时/ 会/ 根据/ 目的/ IP地址/ 将/ 这个/ 连接/ 注册/ 到/ 相应/ 的/ 虚拟/ 队列/ 的/ 对应/ 项中/ ,/ 并/ 添加/ 到/ socketList/ 列表/ 当中/ ,/ 使虚/ Page8/ 拟/ 队列/ 可以/ 管理/ 和/ 控制/ 此/ 连接/ ./ 同时/ ,/ 为了/ 便于/ 对大流/ 的/ 检测/ ,/ Ace/ -/ net/ 将/ 服务器/ 操作系统/ 中/ 每/ 一个/ 连接/ 的/ socket/ 缓冲区/ 增大/ 至/ 10MB/ ,/ 通过/ 在/ 运行/ 时/ 监测/ 缓冲区/ 的/ 占用/ 情况/ ,/ 对/ 网络/ 流/ 的/ 流量/ 需求/ 进行/ 监测/ ./ 当/ 一个/ 进程/ 调用/ write/ 函数/ 将/ 数据/ 写入/ socket/ 缓冲区/ 时/ ,/ 流量/ 监测/ 模块/ 会/ 提取/ 写入/ 的/ 数据量/ (/ 即/ socket/ 缓冲区/ 的/ 占/ 用量/ )/ ,/ 如果/ 数据量/ 大于/ 64KB/ ,/ 则/ 认为/ 这是/ 一个/ 大/ 流/ ,/ 将/ 此/ 流量/ 值/ 与/ 对应/ 虚拟/ 队列/ 三元组/ 中/ 的/ dataVolume/ 相加/ ,/ 作为/ 流量/ 的/ 积累/ 值/ ;/ 如果/ 数据量/ 小于/ 64KB/ ,/ 则/ 认为/ 这个/ 流是/ 一个/ 实时性/ 较强/ 的/ 小流/ ,/ 虚拟/ 队列/ 不/ 对/ 其/ 进行/ 管理/ ,/ 由/ 操作系统/ 调度/ 发送/ ./ 流量/ 监测/ 模块/ 每隔/ 200/ μ/ s/ 会/ 对/ 虚拟/ 队列/ 中/ 的/ 项/ 进行/ 扫描/ ,/ 如果/ 数据量/ 的/ 累积/ 值/ 不/ 超过/ 2MB/ ,/ 则/ 控制/ 这些/ 网络/ 流/ 直接/ 发送/ ,/ 不/ 需要/ 光/ 链路/ 的/ 申请/ ;/ 如果/ 数据量/ 的/ 累计/ 值/ 大于/ 2MB/ ,/ 则/ 有/ 必要/ 将/ 数据/ 放在/ 光域/ 网络/ 上/ 传输/ ,/ 此时/ 需要/ 向/ 中央/ 控制器/ 申请/ 光/ 链路/ ./ 它会/ 将/ 本机/ 累积/ 的/ 数据量/ 、/ 目的/ 地址/ 等/ 信息/ 通知/ 中央/ 控制器/ ,/ 以便/ 根据/ 这些/ 信息/ 进行/ 光/ 线路/ 的/ 仲裁/ 和/ 分配/ ./ 在/ 将/ 这些/ 信息/ 通知/ 中央/ 控制器/ 时/ ,/ 如果/ 实时/ 的/ 建立/ TCP/ 连接/ ,/ 需要/ 数十/ 乃至/ 数百/ 微秒/ 的/ 时间/ 开销/ ,/ 增加/ 了/ 光/ 线路/ 建立/ 的/ 延迟/ ./ 为了/ 降低/ 通知/ 过程/ 的/ 延迟/ ,/ Ace/ -/ net/ 采用/ 了/ 两种/ 优化/ 方法/ :/ 第一/ ,/ 采用/ 重复/ UDP/ 数据包/ 来/ 传递信息/ ./ 由于/ 整个/ 控制系统/ 运行/ 在/ 一个/ 网络/ 条件/ 良好/ 的/ 专用/ 网络/ 环境/ 中/ ,/ 具有/ 较/ 低/ 的/ 丢/ 包率/ ,/ 同时/ 我们/ 选择/ 采用/ 重复/ UDP/ 数据包/ 来/ 传递信息/ ,/ 即/ 每个/ UDP/ 数据包/ 同时/ 发送/ 3/ 次/ ,/ 在/ 图/ 7/ 流量/ 需求/ 测量/ 原理图/ 一段时间/ 内/ 接收端/ 在/ 接收/ 到/ 任何/ 一个/ 数据包/ 后/ ,/ 会/ 将/ 后续/ 接收/ 到/ 的/ 相同/ 内容/ 的/ 数据包/ 丢弃/ ,/ 从而/ 降低/ 数据通信/ 的/ 不可靠性/ ;/ 由于/ 在/ 控制系统/ 中/ ,/ 在/ 短时间/ 内/ 不会/ 有/ 完全相同/ 的/ 控制/ 命令/ 发出/ ,/ 因此/ 这种/ 方法/ 不会/ 造成/ 混淆/ ./ 假如/ 网络/ 的/ 丢/ 包率/ 为/ 10/ -/ 2/ ,/ 则/ 采用/ 重复/ UDP/ 数据包/ 机制/ 的/ 失效率/ 将/ 降为/ 10/ -/ 6/ ./ 即使/ 偶尔/ 产生/ 丢包/ ,/ 只会/ 使/ 流量/ 统计/ 信息/ 产生/ 短时间/ 的/ 错误/ ,/ 使/ 本次/ 流量/ 的/ 报告/ 失败/ ,/ 可能/ 短暂/ 地/ 影响/ 系统/ 的/ 性能/ ,/ 而/ 不会/ 对系统/ 产生/ 致命/ 的/ 损害/ ./ 为了/ 防止/ 由于/ 控制/ 数据包/ 丢失/ 或者/ 中央/ 控制器/ 故障/ 等/ 原因/ 产生/ 的/ 中央/ 控制器/ 长时间/ 不/ 响应/ 虚拟/ 队列/ 的/ 链路/ 请求/ 的/ 情况/ ,/ 在/ 通知/ 中央/ 控制器/ 的/ 同时/ ,/ 虚拟/ 队列/ 会为/ 自身/ 中/ 的/ 这/ 一项/ 开启/ 定时器/ ,/ 当/ 300/ μ/ s/ 内/ 仍/ 未/ 得到/ 中央/ 控制器/ 的/ 响应/ ,/ 虚拟/ 队列/ 直接/ 将/ 这/ 一项/ 管理/ 的/ 网络/ 流/ 发送/ ./ 其次/ ,/ 为了/ 减少/ 把/ 通知/ 信息/ 封装/ 成/ 数据包/ 所/ 带来/ 的/ 延迟/ ,/ 采用/ 预/ 生成/ -/ 缓存/ -/ 发送/ 的/ 模式/ ,/ 即将/ 通知/ 信息/ 预先/ 封装/ 成/ 数据包/ ,/ 在/ 需要/ 的/ 时候/ 直接/ 发送/ ./ 系统/ 中/ 设置/ 15/ 个/ 数据量/ 门/ 限值/ ,/ 分别/ 为/ {/ 2/ ,/ 4/ ,/ 6/ ,/ 8/ ,/ 10/ ,/ 14/ ,/ 18/ ,/ 22/ ,/ 26/ ,/ 30/ ,/ 38/ ,/ 46/ ,/ 54/ ,/ 62/ ,/ 100/ }/ ;/ 如果/ 累积/ 数据量/ 在/ 2MB/ 与/ 4MB/ 之间/ ,/ 则/ 选择/ 数值/ 2/ 作为/ 通知/ 值/ ,/ 中央/ 控制器/ 解析/ 时会/ 使用/ 中值/ 3/ 作为/ 累积/ 值/ ./ 将/ 数据中心/ 每/ 一个/ 机柜/ 中/ 所/ 管理/ 主机/ 的/ 子网/ 地址/ 与/ 15/ 个门/ 限值/ 进行/ 组合/ ,/ 最/ 多/ 可以/ 形成/ 7500/ 个/ 组合/ 数据/ ,/ 然后/ 把/ 每/ 一个/ 组合/ 数据/ 封装/ 成/ 一个/ 网络/ 包/ ,/ 使用/ 子网/ 地址/ 和/ 门/ 限值/ 的/ 组合/ 作为/ hash/ 值/ 将/ 其/ 保存/ 在/ 操作系统/ 中/ ,/ 如图/ 7/ 所示/ ./ 当/ 检测/ 到/ 某/ 累积/ 数据量/ Page9/ 达到/ 门/ 限值/ 时/ ,/ 使用/ 此/ 虚拟/ 队列/ 对应/ 项/ 的/ 目的/ 机柜/ 号/ 和/ 数据量/ 的/ 门/ 限值/ 作为/ hash/ 值/ ,/ 使用/ hash/ 函数/ 查找/ 对应/ 的/ 网络/ 包/ ,/ 并/ 发送给/ 中央/ 控制器/ ./ 虽然/ c/ -/ Through/ 等/ 系统/ 也/ 将/ 网络/ 数据/ 暂时/ 缓存/ 在/ 主机/ 的/ 内存/ 中/ ,/ 但是/ 它/ 将/ 缓冲区/ 扩大/ 到/ 上/ 百兆/ 字节/ 来/ 监测/ 极大/ 的/ 网络/ 流/ [/ 7/ ]/ ,/ 以/ 应对/ MEMS/ 光/ 线路/ 建立/ 速度/ 较慢/ 的/ 问题/ ,/ 极大/ 地/ 增加/ 了/ 系统/ 内存/ 的/ 消耗/ ,/ 而/ Ace/ -/ net/ 的/ 光/ 线路/ 建立/ 速度/ 极快/ ,/ 具有/ 较强/ 的/ 实时性/ ,/ 从而/ 缓冲区/ 可以/ 大大/ 缩小/ ./ 同时/ ,/ c/ -/ Through/ 等/ 系统/ 以/ 服务器/ 中/ 的/ 流为/ 单位/ 进行/ 管理/ ,/ 而/ Ace/ -/ net/ 以/ 服务器/ 为/ 单位/ ,/ 采用/ 虚拟/ 队列/ 的/ 方式/ 进行/ 管理/ ,/ 从而/ 突出/ 流/ 的/ 聚合/ 效应/ ,/ 降低/ 中央/ 控制器/ 控制/ 的/ 复杂度/ ./ 4.3/ 仲裁/ 控制/ 在/ 中央/ 控制器/ 获得/ 每台/ 服务器/ 累积/ 数据量/ 的/ 信息/ 后/ ,/ 需要/ 对/ 这些/ 信息/ 进行/ 解析/ 处理/ ,/ 以便/ 根据/ 累积/ 值/ 在/ 机柜/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 链路/ ,/ 并/ 与/ 服务器/ 操作系统/ 中/ 的/ 虚拟/ 队列/ 管理/ 模块/ 相配合/ ,/ 使用/ 光域/ 网络/ 来/ 传输/ 大块/ 数据/ ./ 在/ 现有/ 的/ 光电/ 混合/ 网络系统/ 中/ ,/ 为了/ 适应/ MEMS/ 光/ 交换机/ 速度/ 较慢/ 的/ 特性/ ,/ 将/ 一段时间/ 收集/ 到/ 的/ 数据量/ 信息/ 形成/ 流量/ 需求/ 矩阵/ ,/ 然后/ 使用/ 图/ 的/ 完美/ 匹配/ 算法/ 计算/ 出/ 系统/ 中/ 应该/ 如何/ 建立/ 光/ 链路/ ,/ 在/ 计算/ 过程/ 中/ 流量/ 需求/ 矩阵/ 不会/ 变化/ ,/ 并且/ 计算/ 过程/ 需要/ 数百/ 毫秒/ 的/ 时间/ [/ 7/ -/ 8/ ]/ ./ Ace/ -/ net/ 所/ 使用/ 的/ 光/ 器件/ 与/ 图/ 8/ 流量/ 需求/ 测量/ 原理图/ 中央/ 控制器/ 中/ 的/ 仲裁/ 控制/ 模块/ 采用/ 非/ 阻塞/ 的/ 方式/ 扫描/ 一个/ 向量/ 中/ 的/ 每个/ 元素/ ,/ 一个/ 向量/ 扫描/ 完毕/ 后/ 将/ 其/ 清零/ ;/ 由于/ 向量/ 之间/ 的/ 无关/ 性/ ,/ 可以/ 并行/ 的/ 对/ N/ 个/ 向量/ 同时/ 进行/ 扫描/ ,/ 以/ 提高/ 扫描/ 的/ 速度/ ./ 仲裁/ 控制/ 模块/ 在/ 扫描/ 的/ 过程/ 中/ 仍然/ 会/ 有/ 新/ 的/ 流量/ 产生/ ,/ 因此/ 其会/ 接受/ 新/ 的/ 流量/ 通知/ 数据包/ ,/ 并/ 持续/ 更新/ 向量/ 中/ 的/ 元素/ 值/ ,/ 以/ 保证/ 灵活性/ 和/ 实时性/ ./ 在/ 对/ 每个/ 向量/ 扫描/ 时/ ,/ 会/ 挑选出/ 此/ 向量/ 中/ 数值/ 最大/ 的/ 元素/ ,/ 即/ 找到/ 与/ 本/ 机柜/ 累积/ 流量/ 最多/ 的/ 机柜/ ;/ MEMS/ 光/ 交换机/ 具有/ 本质/ 的/ 不同/ ,/ 为了/ 使光/ 网络/ 能/ 灵活/ 的/ 应对/ 持续时间/ 较/ 短/ 的/ 网络/ 流/ ,/ 采用/ “/ 光/ 链路/ 无/ 空闲/ ”/ 的/ 策略/ ,/ 即/ 所/ 做出/ 的/ 任何/ 光/ 线路/ 的/ 仲裁/ 和/ 调度/ 都/ 要/ 尽可能/ 地/ 使光/ 链路/ 有/ 足够/ 的/ 数据传输/ ,/ 使光/ 网络/ 有/ 较/ 高/ 的/ 利用率/ ./ 因此/ 中央/ 控制器/ 必须/ 向/ 光域/ 网络/ 提供/ 足够/ 多/ 的/ 数据/ 并/ 减少/ 光/ 网络/ 调度/ 之间/ 的/ 时间/ 间隙/ ./ Ace/ -/ net/ 采用/ 了/ 实时/ 的/ 流量/ 需求/ 解析/ 方法/ ,/ 如图/ 8/ 所示/ ./ 每台/ 服务器/ 中/ 的/ 流量/ 监测/ 模块/ 每隔/ 200/ μ/ s/ 会/ 对/ 虚拟/ 队列/ 中/ 的/ 项/ 进行/ 扫描/ ,/ 如果/ 数据量/ 的/ 累积/ 值/ 不/ 超过/ 2MB/ ,/ 则/ 控制/ 这些/ 网络/ 流/ 直接/ 发送/ ,/ 不/ 需要/ 光/ 链路/ 的/ 申请/ ;/ 如果/ 数据量/ 的/ 累计/ 值/ 大于/ 2MB/ ,/ 则/ 有/ 必要/ 将/ 数据/ 放在/ 光域/ 网络/ 上/ 传输/ ,/ 此时/ 需要/ 向/ 中央/ 控制器/ 申请/ 光/ 链路/ ./ 它会/ 将/ 本/ 机柜/ 累积/ 的/ 数据量/ 的/ 门/ 限值/ 、/ 目的/ 机/ 柜子/ 网/ 地址/ 等/ 信息/ 通知/ 中央/ 控制器/ ,/ 以便/ 根据/ 这些/ 信息/ 进行/ 光/ 线路/ 的/ 仲裁/ 和/ 分配/ ./ 在/ 中央/ 控制器/ 中为/ 每/ 一个/ 机柜/ 维护/ 了/ 一个/ 实时/ 的/ N/ 维/ 流量/ 累积/ 向量/ (/ 其中/ N/ 表示/ 系统/ 中有/ 多少/ 个/ 机柜/ )/ (/ 1/ ,/ 2/ ,/ …/ ,/ k/ ,/ …/ ,/ N/ )/ ,/ 其中/ 的/ 第/ k/ 个/ 元素/ 记录/ 了/ 本/ 机柜/ 与/ 第/ k/ 个/ 机柜/ 之间/ 的/ 累积/ 流量/ 需求/ ./ 当/ 中央/ 控制器接收/ 到/ 新/ 的/ 流量/ 通知/ 数据包/ 时/ ,/ 首先/ 会/ 提取/ 其/ 携带/ 的/ 门/ 限值/ ,/ 并/ 将/ 处理/ 过/ 的/ 门/ 限值/ 与/ 相应/ 流量/ 需求/ 向量/ 中/ 对应/ 的/ 元素/ 值/ 相加/ ,/ 作为/ 新/ 的/ 累积/ 流量/ 需求/ ./ 然后/ 控制/ 对应/ 的/ TWC/ 在/ 两个/ 机柜/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 线路/ ,/ 使/ 这些/ 流量/ 在/ 光域/ 网络/ 上/ 传输/ ,/ 仲裁/ 控制/ 模块/ 会/ 将/ 建立/ 光/ 线路/ 的/ 请求/ 发送给/ 执行/ 单元/ ,/ 由/ 执行/ 单元/ 控制/ TWC/ 进行/ 波长/ 变换/ ,/ 在/ 机柜/ 之间/ 建立/ 起/ 一条/ 持续/ 的/ 光/ 线路/ ./ 执行/ 单元/ 建立/ 链路/ 时/ ,/ 会/ 通知/ 对应/ 机柜/ 内/ 的/ 所有/ 服务器/ 的/ 虚拟/ 队列/ 管理/ 模块/ ,/ 让/ 其/ 开始/ 发送/ 分配/ 到/ 光域/ 网络/ 上/ 的/ 网络/ 流/ ./ 交换机/ 持续/ 监视/ 每条/ 光线/ 路上/ 传输/ 的/ 网络/ 数据量/ ,/ 如果/ 单位/ 时间/ 内/ 传输/ 的/ 数/ Page10/ 据量/ 持续/ 下降/ ,/ 使光/ 线路/ 的/ 利用率/ 低于/ 一个/ 阈值/ T/ 时/ ,/ 则/ 认为/ 本次/ 数据流/ 的/ 传输/ 已经/ 结束/ ,/ 需要/ 重新/ 的/ 计算/ 、/ 分配/ 光/ 线路/ ./ 在/ 扫描/ 一个/ 向量/ 的/ 过程/ 中/ ,/ 只/ 选取/ 最大/ 累积/ 值/ 对应/ 的/ 元素/ 作为/ 线路/ 建立/ 的/ 依据/ ,/ 而/ 对于/ 同一个/ 向量/ 中/ 的/ 其他/ 元素/ ,/ 其所/ 对应/ 的/ 服务器/ 中/ 的/ 流/ 需要/ 在/ 电域/ 网络/ 中/ 传输/ ,/ 而/ 不再/ 需要/ 中央/ 控制器/ 的/ 调度/ 和/ 控制/ ./ 仲裁/ 控制/ 模块/ 在/ 找到/ 最大/ 累积/ 值后/ ,/ 会/ 将/ 最大/ 累积/ 值/ 对应/ 的/ 元素/ 编号/ 发送到/ 本/ 向量/ 对应/ 的/ 机柜/ 中/ 的/ 所有/ 服务器/ ,/ 以此/ 告知/ 虚拟/ 队列/ 管理系统/ ,/ 会/ 在/ 这/ 两个/ 机柜/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 链路/ ./ 而/ 对于/ 目的/ 地址/ 是/ 其他/ 机柜/ 的/ 网络/ 流/ ,/ 虚拟/ 队列/ 管理系统/ 会/ 直接/ 让/ 操作系统/ 调度/ 发送/ ./ 由于/ 中央/ 控制器/ 控制/ 所有/ 大流/ 的/ 发送/ ,/ 仲裁/ 控制/ 模块/ 对/ 向量/ 的/ 扫描/ 间隔/ 直接/ 导致/ 网络/ 的/ 延迟/ ,/ 有/ 两种/ 事件/ 可以/ 触发/ 仲裁/ 控制/ 模块/ 的/ 扫描/ 操作/ ./ 第一种/ 是/ 定时器/ ,/ 仲裁/ 控制/ 模块/ 维护/ 了/ 一个/ 扫描/ 定时器/ ,/ 每隔/ 200/ μ/ s/ 会/ 触发/ 一次/ 扫描/ 操作/ ;/ 此时/ 的/ 光/ 线路/ 可能/ 正/ 处在/ 忙碌/ 状态/ ,/ 扫描/ 产生/ 的/ 结果/ 会/ 被/ 暂存/ ,/ 如果/ 到/ 下次/ 定时器/ 触发/ 时此/ 扫描/ 结果/ 仍/ 未/ 被/ 使用/ ,/ 则/ 会/ 被/ 新/ 的/ 扫描/ 结果/ 所/ 取代/ ./ 第二种/ 是/ 光/ 线路/ 的/ 利用率/ 接近/ 阈值/ T/ 且/ 现在/ 并/ 没有/ 可用/ 的/ 扫描/ 结果/ 时/ ,/ 会/ 触发/ 一次/ 新/ 的/ 扫描/ 过程/ 以/ 建立/ 新/ 的/ 光/ 链路/ ;/ 这种/ 情况/ 主要/ 发生/ 在/ 累计/ 数据量/ 较/ 少时/ ,/ 光/ 线路/ 在/ 200/ μ/ s/ 内/ 将/ 数据传输/ 完毕/ ,/ 其/ 线路/ 建立/ 周期/ 小于/ 向量/ 扫描/ 周期/ ./ 在/ 系统/ 中/ 可能/ 产生/ 仲裁/ 的/ “/ 轮空/ 现象/ ”/ ,/ 即本应/ 在/ 光域/ 网络/ 传输/ 的/ 数据/ 却/ 在/ 电域/ 网络/ 中/ 传输/ ,/ 产生/ 此/ 现象/ 主要/ 有/ 3/ 种/ 原因/ ./ 第一/ ,/ 执行/ 模块/ 在/ 通知/ 虚拟/ 队列/ 管理/ 模块/ 开始/ 发送数据/ 时/ ,/ 由于/ 系统/ 采用/ UDP/ 作为/ 通知/ 控制协议/ ,/ 虽然/ 采用/ 了/ 重复/ 数据包/ 的/ 方法/ ,/ 仍/ 可能/ 会/ 发生/ 控制/ 包/ 丢失/ 的/ 问题/ ./ 因此/ 虚拟/ 队列/ 中/ 的/ 定时器/ 超时/ 之后/ 才/ 会/ 发送/ 对应/ 的/ 网络/ 流/ ,/ 光/ 线路/ 在/ 规定/ 时间/ 内/ 的/ 利用率/ 并未/ 达到/ 阈值/ T/ ,/ 从而/ 重新/ 建立/ 光/ 链路/ ./ 第二/ ,/ 由于/ 控制/ 网络/ 可能/ 产生/ 拥塞/ ,/ 控制/ 数据包/ 到达/ 时间延迟/ 较/ 高/ ,/ 同样/ 也/ 会/ 引起/ 虚拟/ 队列/ 管理/ 模块/ 的/ 超时/ ;/ 第三/ ,/ 由于/ 交换机/ 持续/ 监视/ 每条/ 光线/ 路上/ 传输/ 的/ 网络/ 数据量/ ,/ 如果/ 光/ 线路/ 的/ 利用率/ 低于/ 一个/ 阈值/ T/ ,/ 则/ 会/ 重新/ 仲裁/ 建立/ 光/ 链路/ ,/ 本应/ 在/ 光域/ 网络/ 上/ 传输/ 的/ 网络/ 流/ 仍然/ 有/ 部分/ 数据/ 未/ 完成/ 传输/ ,/ 这些/ 数据/ 会/ 在/ 电域/ 网络/ 中/ 传输/ ./ 4.4/ 流量/ 分配/ 执行/ 单元/ 会/ 根据/ 仲裁/ 控制/ 单元/ 的/ 处理结果/ ,/ 为/ 两个/ 机柜/ 之间/ 建立/ 一条/ 持续/ 的/ 光/ 链路/ ,/ 并/ 通知/ 服务器端/ 开始/ 发送数据/ ./ 因此/ 在/ ToR/ 交换机/ 中/ 必须/ 采用/ 相应/ 的/ 方法/ 将/ 数据包/ 有/ 区别/ 的/ 分别/ 放到/ 电域/ 网络/ 和/ 光域/ 网络/ 上/ 传输/ ./ 在/ Ace/ -/ net/ 中/ ,/ 使用/ OpenFlow/ [/ 23/ ]/ 对/ ToR/ 交换机/ 的/ 数据/ 包转发/ 路径/ 进行/ 控制/ ./ 流量/ 分配/ 工作/ 由/ 运行/ 在/ 中央/ 控制器/ 中/ 的/ 执行/ 单元/ 和/ 支持/ OpenFlow/ 的/ ToR/ 交换机/ 共同完成/ ./ 执行/ 单元/ 为/ 两个/ 机柜/ 建立/ 光/ 链路/ 后/ ,/ 会/ 向/ 对应/ 的/ ToR/ 交换机/ 发出/ 数据流/ 表/ 更新/ 的/ 命令/ ,/ 将/ 添加/ 的/ 路由/ 规则/ 通知/ ToR/ 交换机/ ,/ 使/ 其/ 更新/ 数据流/ 表/ ;/ 如果/ 需要/ 切断/ 两个/ 机柜/ 之间/ 的/ 光/ 链路/ ,/ 同样/ 会/ 通过/ 执行/ 单元/ 向/ 对应/ 的/ ToR/ 交换机/ 发出/ 数据流/ 表/ 更新/ 的/ 命令/ ,/ 对/ 其中/ 的/ 数据流/ 表/ 进行/ 更新/ ./ 为了/ 避免/ 光/ 链路/ 建立/ 、/ 切断/ 过程/ 中/ 的/ 丢/ 包/ 问题/ ,/ 对/ 交换机/ 中/ 数据流/ 表/ 采用/ 保守/ 的/ 更新/ 操作/ :/ 光/ 链路/ 建立/ 时/ ,/ 待/ 建立/ 的/ 光/ 链路/ 稳定/ 后/ ,/ 再/ 更新/ 数据流/ 表/ ;/ 光/ 链路/ 切断/ 时/ ,/ 首先/ 要/ 更新/ 数据流/ 表/ ,/ 然后/ 才能/ 调整/ 光/ 链路/ ./ ToR/ 交换机/ 中/ 的/ 数据流/ 表/ 更新/ 完成/ 后/ ,/ 会/ 根据/ 流/ 表表/ 项/ 描述/ 的/ 转发/ 规则/ 将/ 经过/ 交换机/ 中/ 的/ 流量/ 分配/ 到/ 对应/ 的/ 光域/ 网络/ 和/ 电域/ 网络/ 上/ ,/ 完成/ 流量/ 分配/ 工作/ ./ 5/ 系统/ 评测/ 在/ Ace/ -/ net/ 的/ 性能/ 评测/ 中/ ,/ 采用/ 了/ 为/ 评测/ 混合/ 网络/ 性能/ 所/ 设计/ 的/ 离散/ 事件/ 网络/ 模拟器/ Ace/ -/ sim/ ./ 为了/ 模拟/ 一个/ 接近/ 于/ 真实/ 的/ 网络/ 环境/ ,/ 在/ 其中/ 构建/ 了/ 一个/ 网络/ 数据/ 生成/ 模块/ 来/ 近似/ 模拟/ 应用程序/ 和/ 操作系统/ 的/ 行为/ ./ 同时/ ,/ 在/ 模拟器/ 中/ 集成/ 了/ 网络协议/ 栈/ 和/ 支持/ OpenFlow/ 的/ 交换机/ ./ 模拟器/ 中/ 网络/ 的/ 拓扑/ 结构/ 、/ 延迟/ 、/ 带宽/ 等/ 参数/ 可以/ 动态/ 配置/ ./ 本文/ 着重于/ 对光/ 域/ 网络结构/ 和/ 工作/ 原理/ 的/ 评测/ ,/ 对于/ 电域/ 网络/ 的/ 结构/ 并/ 没有/ 限制/ ,/ 在/ 评测/ 中/ 搭建/ 了/ 一个/ 如图/ 6/ 所示/ 的/ 树形/ 三层/ 电域/ 网络/ 架构/ ,/ 具体/ 配置/ 参数/ 如表/ 1/ 所列/ ./ 在/ 模拟/ 网络/ 中共/ 有/ 了/ 512/ 个/ 机柜/ ,/ 其中/ 每/ 一个/ Page11/ 机柜/ 中/ 放置/ 40/ 台/ 服务器/ ,/ 系统/ 中/ 一共/ 有/ 20480/ 个/ 节点/ ./ 每/ 一台/ ToR/ 交换机/ 有/ 40/ 个/ 1Gbps/ 的/ 下行/ 端口/ 用于/ 与/ 服务器/ 相连/ ,/ 一个/ 10Gbps/ 的/ 上行/ 电域/ 端口/ 与/ 聚合/ 层交换机/ 相连/ ,/ 一个/ 20Gbps/ 的/ 上行/ 端口/ 用于/ 连接/ TWC/ 光/ 器件/ ,/ 假设/ 每/ 一个/ TWC/ 输出/ 的/ 单/ 波长/ 光束/ 的/ 带宽/ 为/ 20Gbps/ ./ 每/ 一台/ 聚合/ 层交换机/ 有/ 33/ 个/ 10Gbps/ 的/ 端口/ ,/ 其中/ 32/ 个/ 下行/ 端口/ 用于/ 与/ ToR/ 交换机/ 相连/ ,/ 一个/ 上行/ 端口/ 用于/ 与/ 核心/ 层交换机/ 相连/ ;/ 核心/ 层交换机/ 共有/ 16/ 个/ 10Gbps/ 的/ 端口/ ,/ 都/ 用于/ 与/ 聚合/ 层交换机/ 相连/ ./ 光电/ 混合系统/ 中/ 使用/ 512/ ×/ 512/ 端口/ 的/ AWGR/ 光/ 交换机/ ,/ 分别/ 与/ 512/ 个/ 机柜/ 中/ 的/ 光/ 器件/ 相连/ ./ 为了/ 与/ 纯电域/ 网络/ 的/ 性能/ 以及/ 基于/ MEMS/ 光/ 交换机/ 的/ 混合/ 网络/ 的/ 性能/ 作/ 比较/ ,/ 我们/ 参照/ c/ -/ Through/ 的/ 网络结构/ ,/ 在/ Ace/ -/ net/ 中/ 实现/ 了/ 基于/ MEMS/ 交换机/ 的/ 光电/ 混合/ 网络结构/ ./ 在/ 实验/ 中/ 使用/ 注入/ 率来/ 描述/ 服务器/ 节点/ 上/ 数据量/ 产生/ 的/ 强度/ ,/ 其/ 定义/ 为/ 每台/ 服务器/ 每秒钟/ 产生/ 的/ 平均/ 数据量/ ./ 5.1/ 平均/ 包/ 延迟/ 此/ 小节/ 对/ 网络系统/ 的/ 平均/ 包/ 延迟/ 进行/ 评估/ ,/ 数据包/ 的/ 平均/ 延迟/ 反映/ 了/ Ace/ -/ net/ 所/ 使用/ 的/ 策略/ 对/ 网络/ 性能/ 的/ 影响/ 程度/ ./ 根据/ 现在/ 数据中心/ 网络流量/ 的/ 特点/ ,/ 按照/ 一定/ 的/ 近似/ 比例/ 生成/ 网络/ 流/ ./ 其中/ 每/ 一台/ 服务器/ 以/ 2/ %/ 的/ 概率/ 随机/ 生成/ 数据量/ 达到/ 20MB/ 网络/ 流/ ,/ 以/ 5/ %/ 的/ 概率/ 生成/ 数据量/ 达到/ 10MB/ 的/ 网络/ 流/ ,/ 以/ 10/ %/ 的/ 概率/ 生成/ 数据量/ 1MB/ 至/ 10MB/ 的/ 网络/ 流/ ,/ 以/ 15/ %/ 的/ 概率/ 生成/ 64KB/ 到/ 1MB/ 的/ 网络/ 流/ ,/ 以/ 68/ %/ 的/ 概率/ 生成/ 小于/ 64KB/ 的/ 网络/ 流/ ./ 在/ 模拟/ 中/ ,/ 假设/ 每/ 一个/ 网络/ 流都/ 随机/ 地/ 发送到/ 系统/ 中/ 的/ 某/ 一台/ 服务器/ ./ 在/ 模拟/ 中/ ,/ 将/ 控制/ 延迟/ 定义/ 为/ :/ 从/ 服务器/ 向/ 中央/ 控制器/ 发出/ 链路/ 申请/ 到/ 获得/ 中央/ 控制器/ 反馈/ 这/ 段时间/ ;/ 将/ 光域/ 网络/ 的/ 控制系统/ 延迟/ 设置/ 为/ 30/ μ/ s/ ,/ 光/ 线路/ 的/ 利用率/ 接近/ 阈值/ T/ 设置/ 为/ 5/ %/ ./ 从图/ 9/ 平均/ 包/ 延迟/ 测试/ 结果/ 可以/ 看出/ ,/ 在/ 随机/ 注入/ 模式/ 下/ ,/ Ace/ -/ net/ 混合/ 网络/ 的/ 平均/ 包/ 延迟/ 要/ 明显/ 小于/ 纯电域/ 网络/ 和/ 基于/ MEMS/ 交换机/ 的/ 光电/ 混合/ 网络/ 的/ 平均/ 包/ 延迟/ ./ 在/ 注入/ 率/ 达到/ 0.2/ Gbps/ 时/ ,/ Ace/ -/ net/ 的/ 平均/ 包/ 延迟/ 只有/ 纯电域/ 网络/ 的/ 0.6/ 倍/ ;/ 而/ 随着/ 注入/ 率/ 的/ 增加/ ,/ 其/ 平均/ 的/ 包/ 延迟/ 缓慢/ 的/ 增长/ ,/ 不仅/ 远/ 低于/ 纯电域/ 网络结构/ ,/ 而且/ 低于/ 基于/ MEMS/ 交换机/ 的/ 光电/ 混合/ 网络/ ./ 这/ 主要/ 有/ 三/ 方面/ 的/ 原因/ :/ 首先/ ,/ Ace/ -/ net/ 利用/ 了/ 快速/ 波长/ 变换/ 器件/ 的/ 纳秒/ 级/ 波长/ 变换/ 特性/ ,/ 在/ 机柜/ 之间/ 迅速/ 地/ 建立/ 路径/ ,/ 路径/ 切换/ 速度/ 优于/ 基于/ MEMS/ 光/ 交换机/ 的/ 光电/ 混合/ 网络/ ./ 其次/ ,/ Ace/ -/ net/ 仍然/ 是/ 对/ 数据量/ 较大/ 的/ 网络/ 流/ 进行/ 加速/ ,/ 在/ 两/ 机柜/ 之间/ 建立/ 的/ 是/ 一条/ 持续时间/ 较长/ 的/ 光/ 线路/ ,/ 每/ 一次/ 链路/ 的/ 建立/ 都/ 会/ 传输/ 数十/ 兆/ 的/ 数据/ ;/ 虽然/ 有/ 控制/ 延时/ 的/ 存在/ ,/ 但/ 由于/ 传输/ 的/ 数据量/ 较大/ ,/ 平均/ 包/ 延迟/ 并/ 没有/ 显著/ 地/ 升高/ ;/ 最后/ ,/ Ace/ -/ net/ 在/ 两个/ 机柜/ 的/ ToR/ 交换机/ 之间/ 建立/ 桥接/ 的/ 光/ 线路/ ,/ 数据包/ 的/ 传输/ 不/ 需要/ 经过/ 聚合/ 层/ 和/ 核心层/ 的/ 电域/ 交换机/ ,/ 缩短/ 了/ 数据包/ 的/ 传输/ 路径/ ./ 5.2/ 吞吐量/ 在/ 吞吐量/ 测试/ 中/ ,/ 以/ 网络/ 流/ 的/ 大小/ 作为/ 变量/ ,/ 分别/ 测试/ 了/ 3/ 种/ 网络/ 的/ 吞吐量/ 指标/ ./ 在/ 测试/ 中/ 选择/ 两种/ 不同/ 数据量/ 的/ 网络/ 流/ 作为/ 对比/ ,/ 使用/ 数据量/ 分别/ 为/ 200KB/ 和/ 10MB/ 的/ 网络/ 流/ 作为/ 测试/ 集/ ,/ 其中/ 测试/ 中/ 随机/ 生成/ 网络/ 流/ 的/ 目的/ 地址/ ./ 图/ 10/ 所示/ 为/ 采用/ 不同/ 数据量/ 网络/ 流/ 的/ 吞吐量/ 的/ 测试/ 结果/ ,/ 从/ 两图/ 中/ 可以/ 看出/ 注入/ 不同/ 数据量/ 的/ 网络/ 流对/ 网络/ 的/ 吞吐量/ 有/ 非常/ 大/ 的/ 影响/ :/ 当/ 网络/ 流/ 的/ 大小/ 为/ 200KB/ 时/ ,/ 纯电域/ 网络/ 和/ 基于/ MEMS/ 光/ 交换机/ 的/ 混合/ 网络/ 的/ 性能/ 只有/ 18/ %/ 左右/ 的/ 差距/ ,/ 而/ Ace/ -/ net/ 的/ 性能/ 要/ 显著/ 高于/ 其他/ 两种/ 网络/ ,/ 甚至/ 可以/ 达到/ 纯光域/ 网络/ 性能/ 的/ 两倍/ ./ 当/ 注入/ 数据量/ 达到/ 10MB/ 的/ 网络/ 流/ 时/ ,/ Ace/ -/ net/ 的/ 吞吐/ 率/ 的/ 优势/ 更加/ 的/ 明显/ ./ 对比/ 图/ 10/ (/ a/ )/ 、/ (/ b/ )/ 两图/ 可以/ 发现/ ,/ 增大/ 网络/ 流/ 的/ 大小/ ,/ 混合/ 网络系统/ 的/ 性能/ 会/ 显著/ 增加/ ,/ 网络/ 流/ 的/ 大小/ 与/ 网络/ 的/ 性能/ 在/ 一定/ 范围/ 内/ 呈/ 正/ 相关/ ./ 大/ 的/ 网络/ 流使/ 光/ 网络/ 中有/ 更/ 持续/ 的/ 网络/ 包/ 传输/ ,/ 使/ 建立/ 的/ 线路/ 更加/ 稳定/ 持续/ ,/ 缩短/ 了/ 由于/ 仲裁/ 、/ 控制/ 延迟/ 引起/ 的/ 光/ 线路/ 空闲/ 的/ 时间/ ./ Page12/ 图/ 10/ 采用/ 不同/ 数据量/ 网络/ 流/ 的/ 吞吐量/ 结果/ 5.3/ 控制/ 延迟/ 影响/ 在/ Ace/ -/ net/ 系统/ 中/ ,/ 控制/ 延迟/ 对/ 混合/ 网络系统/ 的/ 性能/ 有/ 较大/ 的/ 影响/ ./ 为了/ 防止出现/ 由于/ 控制/ 数据包/ 丢失/ 或者/ 中央/ 控制器/ 故障/ 等/ 原因/ 引起/ 的/ 中央/ 控制器/ 长时间/ 不/ 响应/ 虚拟/ 队列/ 的/ 链路/ 请求/ 的/ 情况/ ,/ 在/ 通知/ 中央/ 控制器/ 的/ 同时/ ,/ 虚拟/ 队列/ 会为/ 虚拟/ 队列/ 中/ 的/ 这/ 一项/ 开启/ 定时器/ ,/ 当/ 300/ μ/ s/ 内/ 仍/ 未/ 得到/ 中央/ 控制器/ 的/ 响应/ ,/ 虚拟/ 队列/ 会/ 将/ 这/ 一项/ 管理/ 的/ 到/ 对应/ 机柜/ 的/ 网络/ 流/ 直接/ 发送/ ./ 在/ 执行/ 模块/ 通知/ 虚拟/ 队列/ 管理/ 模块/ 开始/ 发送数据/ 时/ ,/ 由于/ 数据包/ 丢失/ 或者/ 控制/ 延迟/ 较/ 高/ ,/ 虚拟/ 队列/ 中/ 的/ 定时器/ 已经/ 超时/ ,/ 而/ 数据流/ 已经/ 开始/ 发送/ ./ 因此/ 这些/ 数据/ 流量/ 可能/ 会/ 在/ 电域/ 网络/ 上/ 传输/ 而/ 未/ 在/ 光域/ 网络/ 中/ 传输/ ,/ 使/ 本次/ 建立/ 的/ 光/ 链路/ 并未/ 完整/ 加速/ 网络/ 数据/ 的/ 传输/ ,/ 从而/ 降低/ 光域/ 网络/ 的/ 利用率/ ./ 由于/ 系统/ 采用/ UDP/ 作为/ 通知/ 控制协议/ ,/ 虽然/ 采用/ 了/ 重复/ 数据包/ 的/ 方法/ ,/ 仍/ 可能/ 会/ 发生/ 控制/ 包/ 丢失/ 或者/ 延迟/ 过/ 高等/ 问题/ ,/ 由此/ 可能/ 会/ 发生/ “/ 轮空/ 现象/ ”/ ./ 在/ 评估/ 中/ ,/ 定义/ “/ 轮空/ 比率/ ”/ 为/ :/ 在/ 仲裁/ 模块/ 为/ 两/ 机柜/ 分配/ 光/ 线路/ 后/ ,/ 两/ 机柜/ 之间/ 本应/ 在/ 光线/ 路上/ 传输/ 的/ 网络流量/ 而/ 实际/ 未/ 在/ 光线/ 路上/ 传输/ 的/ 网络流量/ 占/ 这/ 段时间/ 内/ 两/ 机柜/ 之间/ 所有/ 流量/ 的/ 百分比/ ./ 即/ 由于/ 控制/ 延迟/ 和/ 控制/ 机制/ 的/ 问题/ ,/ 有/ 部分/ 分配/ 到/ 光域/ 网络/ 流会/ 在/ 电域/ 网络/ 上/ 传输/ ./ 设定/ 每台/ 服务器/ 的/ 注入/ 率为/ 0.2/ Gbps/ ,/ 控制/ 延迟/ 变化/ 区间/ 为/ 10/ μ/ s/ 至/ 320/ μ/ s/ ,/ 定时器/ 的/ 值/ 设置/ 为/ 300/ μ/ s/ ,/ UDP/ 数据包/ 的/ 丢/ 包率/ 设置/ 为/ 1/ %/ ./ 根据/ 现在/ 数据中心/ 网络流量/ 的/ 特点/ ,/ 按照/ 一定/ 的/ 近似/ 比例/ 生成/ 网络/ 流/ ./ 其中/ 每/ 一台/ 服务器/ 以/ 2/ %/ 的/ 概率/ 随机/ 生成/ 数据量/ 达到/ 20MB/ 网络/ 流/ ,/ 以/ 5/ %/ 的/ 概率/ 生成/ 数据量/ 达到/ 10MB/ 的/ 网络/ 流/ ,/ 以/ 10/ %/ 的/ 概率/ 生成/ 数据量/ 1MB/ 至/ 10MB/ 的/ 网络/ 流/ ,/ 以/ 15/ %/ 的/ 概率/ 生成/ 64KB/ 到/ 1MB/ 的/ 网络/ 流/ ,/ 以/ 68/ %/ 的/ 概率/ 生成/ 小于/ 64KB/ 的/ 网络/ 流/ ;/ 在/ 模拟/ 中/ 假设/ 每/ 一个/ 网络/ 流都/ 随机/ 地/ 发送到/ 系统/ 中/ 的/ 某/ 一台/ 服务器/ ./ 首先/ 需要/ 评估/ 在/ 给定/ 注入/ 率时/ ,/ 控制/ 延迟/ 对/ 轮空/ 比率/ 的/ 影响/ ,/ 在/ 模拟/ 中/ 不断/ 的/ 增加/ 混合/ 网络/ 的/ 控制/ 延迟/ ,/ 绘制/ 的/ 轮空/ 比率/ 曲线/ 如图/ 11/ 所示/ ./ 从图/ 11/ 不同/ 控制/ 延迟/ 的/ 轮空/ 比率/ 结果/ 中/ 可以/ 看出/ ,/ 当/ 控制/ 延迟/ 大于/ 60/ μ/ s/ 时/ ,/ 轮空/ 比率/ 开始/ 大幅/ 上升/ ;/ 在/ 230/ μ/ s/ 时/ 轮空/ 比率/ 达到/ 98/ %/ ,/ 光/ 网络/ 上/ 只有/ 极少/ 的/ 数据传输/ ,/ 控制系统/ 基本/ 失效/ ./ 因此/ 在/ 实际/ 系统/ 中/ ,/ 必须/ 要/ 降低/ 控制/ 延迟/ 的/ 开销/ ,/ 以/ 提高/ 系统/ 的/ 性能/ ./ 微秒/ 级/ 延迟/ 的/ 点对点/ 通信/ 系统/ 已经/ 商用/ ,/ 如/ Infiniband/ 网络/ 可以/ 实现/ 低于/ 1/ μ/ s/ 的/ 点对点/ 通信/ 延迟/ ①/ ;/ 同时/ ,/ 由于/ 控制系统/ 的/ 算法/ 简单/ ,/ 可以/ 使用/ 全/ 硬件/ 的/ 中央/ 控制系统/ ,/ 从而/ 将/ 系统/ 的/ 控制/ 延迟/ 控制/ 在/ 20/ μ/ s/ 以下/ ./ ①/ MellanoxIB/ ./ http/ :/ // // www/ ./ mellanox/ ./ com/ // page/ // infiniband/ _/ Page13/ 其次/ 需要/ 评估/ 在/ 不同/ 的/ 丢/ 包率/ 的/ 情况/ 下/ ,/ 对/ 轮空/ 比率/ 的/ 影响/ ./ 在/ 控制系统/ 中/ 为了/ 降低/ 延迟/ ,/ 通知/ 机制/ 使用/ UDP/ 协议/ 来/ 实现/ ,/ 虽然/ 采用/ 了/ 重复/ 数据包/ 的/ 技术/ ,/ 但是/ 在/ 丢/ 包率/ 较/ 高/ 的/ 情况/ 下/ 仍然/ 会/ 对/ 混合/ 网络/ 的/ 性能/ 产生/ 影响/ ./ 在/ 测试/ 中/ 设置/ 控制/ 延迟/ 为/ 30/ μ/ s/ ,/ 定时器/ 的/ 设置/ 值为/ 300/ μ/ s/ ,/ 轮空/ 比率/ 与/ 丢/ 包率/ 的/ 关系/ 如图/ 12/ 所示/ ./ 从图/ 12/ 所示/ 的/ UDP/ 丢/ 包率/ 与/ 轮空/ 比率/ 的/ 关系/ 中/ 可以/ 发现/ ,/ 只有/ 当/ 丢/ 包率/ 非常/ 高/ 的/ 情况/ 下/ 才/ 会/ 引发/ 较/ 高/ 的/ 轮空/ 比率/ ;/ 只要/ 将/ UDP/ 数据包/ 的/ 丢/ 包/ 率控制/ 在/ 30/ %/ 以下/ ,/ 对系统/ 的/ 性能/ 影响/ 有限/ ./ 而/ 在/ 实际/ 的/ 网络系统/ 中/ 比较/ 容易/ 实现/ 将/ 丢/ 包/ 率控制/ 在/ 30/ %/ 以下/ ,/ 因而/ 采用/ UDP/ 协议/ 设计/ 的/ 通知/ 机制/ 是/ 可行/ 和/ 高效/ 的/ ./ 6/ 结束语/ 本文/ 提出/ 了/ 一种/ 使用/ TWC/ 光/ 器件/ 和/ AWGR/ 光/ 路由器/ 的/ OCS/ // EPS/ 光电/ 混合/ 网络结构/ Ace/ -/ net/ ./ 相比/ 于/ 现有/ 的/ 混合/ 网络结构/ ,/ 此/ 结构/ 使用/ 可/ 快速/ 变换/ 波长/ 的/ TWC/ 光/ 器件/ 和/ 光波长/ 路由/ 芯片/ AWGR/ 在/ 两个/ 机柜/ 间/ 建立/ 起/ 一条/ 光/ 链路/ ,/ 实现/ 纳秒/ 级/ 的/ 链路/ 切换/ ,/ 使/ 更/ 多/ 的/ 网络/ 流/ 可以/ 在/ 高带宽/ 的/ 光域/ 网络/ 中/ 传输/ ,/ 进一步/ 缓解/ 了/ 现在/ 数据中心/ 网络系统/ 通信/ 带宽/ 低/ 、/ 交换/ 容量/ 有限/ 、/ 高能耗/ 等/ 缺点/ ./ 在/ 文中/ 详细描述/ 了/ Ace/ -/ net/ 的/ 整体/ 设计/ 以及/ 流量/ 需求/ 测量/ 、/ 仲裁/ 控制/ 、/ 流量/ 分配/ 等/ 各个/ 子系统/ 的/ 运作/ 方式/ ;/ 同时/ 使用/ 模拟器/ 对此/ 结构/ 进行/ 了/ 评测/ ./ 实验/ 结果表明/ ,/ 相对/ 于/ 传统/ 的/ 电域/ 网络结构/ ,/ 此/ 结构/ 能够/ 很/ 好/ 地/ 降低/ 网络/ 中/ 平均/ 包/ 延迟/ ,/ 提高/ 网络/ 的/ 吞吐/ 率/ ./ 但/ 由于/ 光/ 信号/ 直接/ 存储/ 、/ 灵活/ 控制/ 的/ 问题/ 在/ 物理/ 上/ 仍然/ 没有/ 解决/ ,/ 光域/ 网络/ 对/ 数据量/ 较/ 小/ 的/ 网络/ 流/ (/ 如/ 小于/ 64KB/ )/ 的/ 应对/ 能力/ 较差/ ,/ 如何/ 构建/ 更/ 高效/ 的/ 光电/ 混合/ 网络系统/ 仍然/ 是/ 一个/ 需要/ 进一步/ 探索/ 的/ 问题/ ./ Ace/ -/ net/ 中所/ 使用/ 的/ 光/ 器件/ 在/ 现阶段/ 都/ 是/ 成熟/ 可用/ 的/ ,/ 在/ 本文/ 中/ 我们/ 主要/ 探索/ 混合/ 网络结构/ 和/ 控制/ 机制/ ,/ 因此/ 只/ 使用/ 模拟器/ 来/ 评估/ Ace/ -/ net/ 的/ 性能/ 特征/ ./ 在/ 未来/ 我们/ 将/ 采用/ FPAG/ 以及/ 真实/ 的/ AWGR/ 光/ 路由器/ 构建/ 原型/ 系统/ ,/ 进一步/ 验证/ 系统/ 的/ 工作/ 机制/ 和/ 实际/ 性能/ ./ 一方面/ ,/ 现在/ 大型/ 数据中心/ 内部/ ,/ 10GigE/ 已经/ 基本/ 普及/ ,/ 并且/ 正在/ 向/ 40GigE/ 和/ 100GigE/ 的/ 方向/ 迈进/ ./ 另一方面/ ,/ 随着/ 大/ 数据/ 等/ 新型/ 应用/ 的/ 发展/ ,/ 数据中心/ 的/ 规模/ 不断扩大/ ./ 上述/ 两/ 方面/ 的/ 因素/ 正在/ 加速/ 推进/ 数据中心/ 网络/ 的/ 变革/ ./ 高带宽/ 的/ 光域/ 网络/ 成为/ 现在/ 数据中心/ 网络/ 的/ 一个/ 重要/ 选择/ ,/ 混合/ 网络结构/ 也/ 将/ 是/ 数据中心/ 网络/ 发展/ 的/ 一个/ 重要/ 方向/ ./ 致谢/ 感谢/ 各位/ 审稿人/ 为/ 本文/ 的/ 完善/ 所/ 提出/ 的/ 有益/ 建议/ !/ 

