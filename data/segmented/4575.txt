Page1/ 基于/ 粒子/ 滤波/ 的/ 驾驶员/ 视线/ 自动/ 校准/ 算法/ 1/ )/ (/ 大连海事大学/ 信息/ 科学技术/ 学院/ 辽宁大连/ 116026/ )/ 2/ )/ (/ 大连理工大学/ 物理/ 与/ 光电/ 工程学院/ 辽宁大连/ 116024/ )/ 3/ )/ (/ 杜兰/ 大学/ 数学系/ 新奥尔良/ 美国/ 70118/ )/ 4/ )/ (/ 哈佛大学医学院/ 波士顿/ 美国/ 02114/ )/ 摘要/ 虽然/ 驾驶员/ 的/ 注视点/ 定位/ 对/ 研究/ 驾驶/ 行为/ 和/ 提高/ 驾驶/ 安全/ 有/ 重要/ 作用/ ,/ 但是/ 光线/ 不/ 均匀/ 和/ 驾驶员/ 头部/ 的/ 大/ 角度/ 转动/ 造成/ 了/ 传统/ 视线/ 跟踪/ 算法/ 必需/ 进行/ 的/ 校准/ 过程/ 在/ 真实/ 驾驶/ 环境/ 下/ 无法/ 实现/ ./ 文中/ 根据/ 车辆/ 环境/ 和/ 驾驶员/ 注视/ 行为/ 特点/ ,/ 构建/ 驾驶员/ 注视/ 视线/ 区域/ 和/ 头部/ 姿态/ 的/ 映射/ 关系/ ,/ 以/ 实现/ 视线/ 自动/ 校准/ ./ 文中/ 利用/ 稳健/ 的/ 面部/ 特征/ 定位/ 及/ 三维/ 几何/ 结构/ 估计/ 头部/ 姿态/ ,/ 利用/ 粒子/ 滤波/ 对/ 头部/ 姿态/ 进行/ 学习/ 和/ 跟踪/ ./ 文中/ 使用/ 辅助/ 采样/ 的/ 方法/ 解决/ 粒子/ 滤波/ 在/ 给定/ 的/ 状态/ 空间/ 上/ 的/ 粒子/ 贫化/ 和/ 权值/ 分配/ 问题/ ./ 文中/ 的/ 自动/ 校准/ 算法/ 误差/ 较/ 小/ ,/ 可以/ 满足/ 驾驶/ 安全/ 和/ 驾驶/ 行为/ 研究/ 的/ 需要/ ./ 关键词/ 视线/ 跟踪/ ;/ 头部/ 姿态/ ;/ 校准/ ;/ 粒子/ 滤波/ ;/ 驾驶/ 行为/ 1/ 引言/ 视线/ 跟踪/ 技术/ 在/ 人机交互/ 、/ 医疗/ 和/ 驾驶/ 行为/ 研究/ 方面/ 有/ 重要/ 的/ 作用/ ./ 目前/ 成熟/ 的/ 精度/ 较/ 高/ 的/ 商业/ 视线/ 跟踪/ 仪/ 一般/ 会/ 利用/ 腮托/ 或/ 头戴/ 等/ 方法/ 限制/ 头部/ 运动/ ,/ 通过/ 基于/ 红外光/ 线/ 的/ 瞳孔/ -/ 角膜/ 反射/ 视线/ 跟踪/ 方法/ 获取/ 视线/ 参数/ ./ 在/ 头部/ 运动/ 受限制/ 的/ 情况/ 下/ ,/ 头部/ 和/ 眼睛/ 位置/ 估计/ 可以/ 得到/ 较/ 好/ 的/ 准确度/ [/ 1/ -/ 2/ ]/ ./ 如果/ 不/ 固定/ 头部/ 运动/ ,/ 就/ 需要/ 采用/ 运动/ 传感器/ 或/ 多/ 相机/ 对/ 头部/ 运动/ 进行/ 补偿/ ,/ 但/ 这种/ 视线/ 追踪/ 系统/ 精度/ 不高/ ./ 真实/ 驾驶/ 环境/ 下/ 的/ 基于/ 视频/ 的/ 视线/ 追踪/ 方法/ 是/ 智能/ 交通/ 领域/ 的/ 研究/ 热点/ [/ 3/ -/ 4/ ]/ ./ 但/ 受/ 驾驶/ 环境/ 和/ 自然环境/ 因素/ 影响/ ,/ 传统/ 视线/ 追踪/ 方法/ 几乎/ 不可/ 用/ ./ 首先/ ,/ 在/ 自然环境/ 下/ ,/ 光线/ 比较复杂/ ,/ 红外光/ 源/ 在/ 户外/ 受/ 阳光/ 影响/ 后/ 不/ 稳定/ ,/ 传统/ 的/ 瞳孔/ -/ 角膜/ 反射/ 方法/ 可用性/ 差/ ./ 再次/ ,/ 驾驶员/ 的/ 头部/ 转动/ 幅度/ 很大/ ,/ 转动/ 角度/ 有时/ 大于/ 180/ °/ ,/ 并且/ 在/ 自然环境/ 下/ 也/ 不利于/ 采用/ 固定/ 或/ 限制/ 头部/ 运动/ 的/ 方法/ ,/ 因此/ 自然/ 场景/ 下/ 的/ 注视点/ 定位问题/ 一直/ 难以实现/ ./ 其中/ ,/ 视线/ 校准/ 是/ 视线/ 追踪/ 或/ 注视点/ 估计/ 的/ 必要/ 环节/ ,/ 虽然/ 在/ 简单/ 环境/ 下/ 有/ 专门/ 的/ 校准/ 过程/ ,/ 校准/ 的/ 算法/ 也/ 比较/ 多/ [/ 5/ ]/ ,/ 但/ 在/ 复杂/ 场景/ 下/ 由于/ 条件/ 限制/ ,/ 一般/ 很难/ 进行/ 校准/ ./ 而/ 传统/ 视线/ 跟踪/ 方法/ 必须/ 进行/ 校准/ ,/ 这/ 也/ 说明/ 了/ 如果/ 要/ 实现/ 注视点/ 定位/ 的/ 自动/ 校准/ 就/ 必须/ 采用/ 新/ 的/ 注视点/ 定位/ 方法/ ./ 对于/ 较大/ 的/ 头部/ 旋转/ 角度/ ,/ 许多/ 研究者/ 通过/ 头部/ 朝向/ 来/ 估计/ 视线/ 方向/ [/ 6/ ]/ ,/ 将/ 视线/ 估计/ 问题/ 转换/ 为/ 头部/ 姿态/ 估计/ 问题/ ./ 因为/ 人眼/ 的/ 有效/ 视场/ 是/ 有限/ 的/ ,/ 所以/ 正常/ 情况/ 下/ 头部/ 朝向/ 可以/ 代表/ 70/ %/ 的/ 视线/ 方向/ ,/ 而/ 驾驶员/ 在/ 注视/ 某个/ 对象/ 时/ 总是/ 转动/ 头部/ 面向/ 该/ 对象/ ./ 本文/ 中/ 也/ 将/ 驾驶员/ 的/ 视线/ 方向/ 用/ 头部/ 的/ 朝向/ 来/ 表示/ ./ 驾驶员/ 的/ 头部/ 姿态/ 估计/ 方法/ 利用/ 脸部/ 特征/ 点/ 的/ 位置/ 、/ 形状/ 、/ 外观/ 或/ 左右/ 瞳孔/ 的/ 距离/ 等/ 参数估计/ 头部/ 的/ 朝向/ ,/ 头部/ 位置/ 估计/ 通常/ 需要/ 多/ 摄像机/ 和/ 复杂/ 的/ 脸部/ 模型/ 来/ 进行/ 初始化/ ./ 如/ Murphy/ -/ Chutorian/ 等/ 人/ [/ 7/ ]/ 提取/ 驾驶员/ 脸部/ 的/ 外观/ 特征/ ,/ 构建/ 梯度方向/ 直方图/ ,/ 通过/ 支持/ 向量/ 回归估计/ 视线/ 方向/ 和/ 头部/ 朝向/ ./ Tawari/ 等/ 人/ [/ 8/ ]/ 则/ 在/ 驾驶/ 视频/ 图像/ 中/ 定位/ 驾驶员/ 的/ 眼角/ 、/ 鼻角/ 等/ 多个/ 特征/ 点/ 位置/ ,/ 使用/ 三维/ 模型/ 分析/ 其/ 几何/ 结构/ 来/ 估计/ 头部/ 姿态/ ./ 头部/ 姿态/ 的/ 3/ 个/ 自由度/ 如图/ 1/ 所示/ ./ 同时/ ,/ 交通/ 领域/ 的/ 研究/ 人员/ 利用/ 眼动仪/ 研究/ 汽车/ 驾驶员/ 注视点/ 分布/ 规律/ 等/ 问题/ ,/ 得到/ 了/ 部分/ 驾驶员/ 视觉/ 搜索/ 行为/ 的/ 统计/ 特性/ ./ 如/ 袁伟/ 等/ 人/ [/ 9/ ]/ 基于/ 此/ 提出/ 基于/ 马尔可夫/ 链/ 的/ 驾驶员/ 视觉/ 转移/ 特征/ ,/ 运用/ 动态/ 聚类/ 方法/ ,/ 对/ 驾驶员/ 注视点/ 的/ 视野/ 平面/ 解析/ 坐标/ 进行/ 聚类/ ,/ 通过/ 对/ 注视/ 行为/ 平稳/ 分布/ 特征分析/ 得出/ :/ 长时间/ 驾驶/ 后/ 各/ 区域/ 的/ 注视点/ 分布/ 的/ 概率/ 会/ 趋于稳定/ ,/ 并/ 主要/ 集中/ 在/ 若干个/ 区域/ ./ 因此/ 可以/ 在/ 驾驶/ 环境/ 中/ 利用/ 头部/ 方向/ 估计/ 代替/ 视线/ 方向/ 估计/ ./ 根据/ 驾驶/ 习惯/ 和/ 驾驶员/ 头部/ 方向/ 统计/ 结果/ [/ 10/ ]/ ,/ 驾驶员/ 大多数/ 时间/ 都/ 是/ 朝前/ 看/ ,/ 并且/ 以/ 相对/ 固定/ 的/ 头部/ 转动/ 角度观察/ 左右/ 后视镜/ 、/ 车/ 内/ 后视镜/ 和/ 风挡/ 玻璃/ 的/ 不同/ 区域/ ,/ 因此/ 头部/ 方向/ 可以/ 采用/ 追踪/ 和/ 学习/ 的/ 方法/ 被/ 实时/ 估计/ 出来/ ,/ 以/ 实现/ 自动/ 的/ 校准/ [/ 11/ ]/ ./ 本文/ 算法/ 基于/ 以下/ 两个/ 条件/ ,/ 一是/ 当/ 驾驶员/ 调整/ 好/ 座椅/ 时/ ,/ 驾驶员/ 的/ 头部/ 朝向/ 和/ 后视镜/ 等/ 驾驶/ 环境/ 部件/ 的/ 相对/ 位置/ 是/ 固定/ 的/ ,/ 车内/ 的/ 这些/ 部件/ 可以/ 用来/ 进行/ 视线/ 的/ 校准/ ;/ 二是/ 驾驶员/ 通常/ 具有/ 一定/ 的/ 驾驶/ 习惯/ ,/ 例如/ 如何/ 观看/ 后视镜/ ,/ 打开/ 转向灯/ 前后/ 如何/ 观察/ 后视镜/ 等/ ./ 本文/ 算法/ 是/ 在/ 文献/ [/ 11/ ]/ 的/ 方法/ 上/ 进行/ 了/ 改进/ ,/ 文献/ [/ 11/ ]/ 的/ 主要/ 贡献/ :/ 一是/ 针对/ 不同/ 的/ 头部/ 姿势/ 和/ 视线/ 方向/ 的/ 自动/ 分类/ 方法/ 提出/ 了/ 一种/ 新/ 的/ 算法/ ;/ 二是/ 将/ 自动/ 人脸/ 检测/ 、/ 样本/ 集/ 学习/ 算法/ 和/ 粒子/ 滤波/ 追踪/ 估计/ 合并/ 为/ 一个/ 循环/ 结构/ ,/ 从而/ 使/ 跟踪/ 系统/ 能够/ 自动/ 进行/ ./ 本文/ 的/ 改进/ 之/ 处/ 在于/ :/ 利用/ 较/ 少/ 形变/ 的/ 几何/ 特征/ 定位/ 方法/ 提高/ 头部/ 姿态/ 的/ 精确度/ ,/ 同时/ 使用/ 稳健/ 的/ 稀疏/ 人脸/ 追踪/ 方法/ 加快/ 特征/ 点/ 搜索/ 速度/ ;/ 在/ 状态/ 空间/ 模型/ 中/ ,/ 对/ 头部/ 姿态/ 进行/ 粒子/ 滤波/ 追踪/ 和/ 学习/ ,/ 使用/ 辅助/ 采样/ 的/ 方法/ 解决/ 粒子/ 贫化/ 和/ 权值/ 分配/ 问题/ ./ 本文/ 不仅/ 侧重于/ 头部/ 姿态/ 的/ 粒子/ 滤波/ 学习/ ,/ 包括/ 了/ 水平/ 偏移/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ (/ 即/ Yaw/ 、/ Pitch/ 和/ Roll/ )/ 共/ 3/ 个/ 自由度/ ;/ 还/ 基于/ 注视/ 区域/ 的/ 聚类分析/ 优化/ 了/ 注视/ 区域/ 的/ 划分/ ,/ 使/ 其/ 更/ 符合/ 自然/ 驾驶/ 状态/ 的/ 注视/ 特性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 驾驶员/ 视线/ 自动/ 校准/ 算法/ ;/ 第/ 3/ 节/ 主要/ 介绍/ 驾驶员/ 状态/ 模型/ 及/ 粒子/ 滤波/ 算法/ 在/ 头部/ 姿态/ 的/ 学习/ 和/ 估计/ 方法/ 中/ 的/ 应用/ ;/ 第/ 4/ 节/ 给出/ 本/ Page3/ 文/ 算法/ 的/ 实验/ 结果/ ,/ 并/ 将/ 本文/ 算法/ 与/ 真实/ 数据/ 进行/ 了/ 多组/ 对比/ ;/ 第/ 5/ 节对/ 本文/ 工作/ 进行/ 总结/ ,/ 并/ 指出/ 进一步/ 的/ 工作/ ./ 2/ 驾驶员/ 视线/ 自动/ 校准/ 算法/ 我们/ 提出/ 的/ 驾驶员/ 视线/ 自动/ 校准/ 算法/ 由/ 3/ 部分/ 构成/ ,/ 包括/ 头部/ 区域/ 确定/ 、/ 基本/ 帧/ 的/ 学习/ 和/ 视线/ 区域/ 的/ 估计/ ,/ 如图/ 2/ 所示/ ./ 确定/ 头部/ 区域/ 简化/ 了/ 人脸/ 特征提取/ ,/ 再/ 使用/ 基于/ 粒子/ 滤波/ 框架/ 的/ 驾驶员/ 状态/ 模型/ 进行/ 基本/ 帧/ 学习/ ,/ 通过/ 度量/ 不同/ 区域/ 的/ 图像/ 距离/ ,/ 确定/ 头部/ 姿态/ 与/ 视线/ 区域/ 的/ 映射/ 关系/ ,/ 从而/ 实现/ 驾驶员/ 视线/ 的/ 自动/ 校准/ ./ 其中/ ,/ 视线/ 区域/ 是/ 根据/ 驾驶员/ 注视/ 特性/ 和/ 视觉/ 搜索/ 行为/ 特征/ 预先/ 划定/ 的/ ./ 首先/ ,/ 在/ 头部/ 区域/ 确定/ 阶段/ ,/ 脸部/ 区域/ 在/ 我们/ 接收/ 的/ 整幅/ 图像/ 中/ 被/ 确定/ ,/ 其他/ 区域/ 即/ 被/ 抑制/ ./ 受/ 光照/ 及/ 驾驶/ 环境影响/ ,/ 人脸/ 检测/ 效率/ 不高/ ,/ 必要/ 的/ 人脸/ 追踪/ 算法/ 被/ 采用/ 以/ 提高/ 人脸/ 区域/ 确定/ 的/ 速度/ 和/ 准确度/ ./ 本文/ 采用/ 文献/ [/ 12/ ]/ 的/ 人脸/ 稀疏/ 追踪/ 结合/ 改进/ 的/ Viola/ 方法/ [/ 13/ ]/ 检测/ 驾驶员/ 的/ 脸部/ ,/ 增加/ 了/ 对/ 侧/ 脸/ 等/ 不同/ 姿态/ 人脸/ 的/ 检测/ ,/ 使用/ 追踪/ 结合/ 检测/ 的/ 方法/ 主要/ 是/ 为/ 提高/ 特征/ 点/ 选取/ 的/ 速度/ 和/ 准确度/ ./ 当/ 系统/ 识别/ 脸部/ 失败/ ,/ 基本/ 帧/ 的/ 学习/ 可能/ 导致/ 最后/ 的/ 相应/ 视线/ 区域/ 的/ 样本/ 集/ 有误/ ,/ 因此/ 在/ 初始化/ 时/ 在/ 固定/ 的/ 时间/ 内/ 接收/ 的/ 图像/ 均/ 进行/ 脸部/ 检测/ ./ 脸部/ 检测/ 算法/ 在/ 一定/ 时间/ 周期/ 内会/ 自动/ 重复/ ./ 同时/ ,/ 我们/ 增加/ 遮挡/ 因子/ 及/ 面积/ 因子/ 以/ 降低/ 人脸/ 追踪/ 误差/ 和/ 人脸/ 深度/ 信息/ 缺失/ 带来/ 的/ 影响/ ,/ 两/ 因子/ 均/ 根据/ 统计/ 特性/ 学习/ 得到/ ./ 对于/ 遮挡/ 因子/ 较大/ 的/ 人脸/ ,/ 即/ 人脸/ 区域/ 被/ 遮挡/ 较/ 多/ 的/ 人脸/ 在/ 基本/ 帧/ 学习/ 时/ 降低/ 其/ 置信水平/ ./ 对于/ 面积/ 因子/ 较大/ 的/ 人脸/ ,/ 即/ 尺度/ 发生变化/ 的/ 人脸/ 在/ 基本/ 帧/ 学习/ 时/ 暂时/ 不/ 接受/ ./ 在/ 图像/ 序列/ 中/ 利用/ 改进/ 的/ 文献/ [/ 14/ ]/ 中/ 的/ 方法/ 提取/ 人脸/ 特征/ ,/ 并/ 自动/ 对/ 感兴趣/ 的/ 特征/ 进行/ 特殊/ 标注/ ./ 通常/ 情况/ 下/ ,/ 遮挡/ 、/ 光线/ 条件/ 、/ 头部/ 大幅度/ 转动/ 和/ 其他/ 影响/ 因素/ 限制/ 了/ 许多/ 已有/ 算法/ 的/ 应用/ ./ 混合/ 树/ 模型/ 把/ 人脸/ 每个/ 特征/ 点/ 作为/ 一部分/ ,/ 通过/ 全局/ 的/ 混合/ 捕捉/ 人脸/ 不同/ 姿态/ 下/ 的/ 特征/ 点/ 变化/ ./ 而/ AAM/ (/ ActiveAppearanceModel/ )/ 模型/ 易错/ 估/ 人脸/ 整体/ 轮廓/ ,/ CLM/ (/ ConstrainedLocalModel/ )/ 模型/ 则/ 会/ 牺牲/ 鼻子/ 特征/ 点/ 的/ 精确度/ ./ 由于/ 本/ 系统/ 可以/ 自动/ 进行/ 鼻子/ 中心点/ 的/ 标注/ ,/ 因此/ 系统/ 不/ 需要/ 对/ 一个/ 指定/ 的/ 人/ 进行/ 特别/ 的/ 训练/ 以/ 获得/ 相应/ 的/ 参数/ ,/ 因此/ 不/ 需要/ 驾驶者/ 的/ 特别/ 合作/ ;/ 另外/ ,/ 算法/ 对于/ 驾驶者/ 戴眼镜/ 和/ 大幅度/ 的/ 移动/ 头部/ 具有/ 很/ 好/ 的/ 鲁棒性/ ./ 不同/ 驾驶员/ 头部/ 大幅度/ 转动/ 条件/ 下/ 的/ 特征提取/ 过程/ 如图/ 3/ 所示/ ./ 其中/ “/ ×/ ”/ 为/ 自动/ 标注/ 的/ 鼻子/ 顶点/ 位置/ ./ 其次/ ,/ 在/ 基本/ 帧/ 学习/ 阶段/ ,/ 关键帧/ 表示/ 为/ 与/ 我们/ 划分/ 的/ 区域/ 相对/ 应/ 的/ 头部/ 水平/ 偏离/ 度/ (/ Yaw/ )/ 、/ 垂直/ 倾斜度/ (/ Pitch/ )/ 和/ 左右/ 旋转/ 度/ (/ Roll/ )/ ./ 我们/ 通过/ 对/ 驾驶员/ 状态/ 模型/ 进行/ 粒子/ 滤波/ 学习/ ,/ 基于/ 图像/ 上/ 定义/ 的/ 距离/ 把/ 所有/ 的/ 样本/ 分为/ 与/ 事先/ 划定/ 的/ 视线/ 区域/ 相同/ 的/ 集合/ 类/ ,/ 并/ 最终/ 用/ 每个/ 集合/ 的/ 中心/ 来/ 代表/ 相对/ 应/ 的/ 视线/ 区域/ ./ 驾驶员/ 状态/ 模型/ 及/ 粒子/ 滤波/ 学习/ 算法/ 会/ 在/ 本文/ 第/ 3/ 节/ 详细/ 阐述/ ./ 学习/ 算法/ 需要/ 在/ 每/ 一/ 时间段/ 结束/ 后/ 进行/ 重复/ ,/ 使得/ 样本/ 集中/ 的/ 元素/ 能够/ 以/ 更/ 高/ 的/ 置信/ 概率/ 定位/ 视线/ 区域/ ./ 本文/ 采用/ 与/ 文献/ [/ 15/ ]/ 相似/ 的/ 学习/ 算法/ 的/ 框架/ ./ 基于/ 对/ 驾驶者/ 大部分/ 时间/ 会/ 正视/ 前方/ 这个/ 假设/ ,/ 我们/ 选取/ 定位/ 鼻子/ 顶点/ 作为/ 兴趣/ 点/ 并/ 进行/ 加权/ 平均/ ,/ 最后/ 得到/ 的/ 值/ 被/ 认为/ 驾驶者/ 直视/ 前方/ 的/ 中心/ 坐标/ ,/ 取为/ 原点/ ,/ 同时/ 设定/ 相应/ 的/ Page4/ 视线/ 区域/ 编号/ ./ 中心/ 的/ 选取/ 需要/ 在/ 特定/ 的/ 时间/ 周期/ 内/ 进行/ 重复/ 使得/ 其/ 可信度/ 增高/ ./ 视线/ 区域/ 的/ 头部/ 姿态/ 角度/ 关系/ 在/ 系统/ 初始化/ 之前/ 需/ 根据/ 头部/ 传感器/ 给出/ 的/ 数据/ 进行/ 校准/ 对应/ ./ 最后/ ,/ 在/ 视线/ 区域估计/ 阶段/ ,/ 驾驶员/ 头部/ 的/ 中心/ 由/ 事先/ 确定/ 的/ 校准/ 点/ 进行/ 加权/ 平均/ 算/ 出/ ,/ 转化/ 为/ 相对/ 应/ 的/ 头部/ 姿态/ ,/ 最后/ 在/ 集合/ 类中/ 选取/ 距离/ 最近/ 的/ 集合/ 指标/ 作为/ 其/ 估计/ 的/ 视线/ 区域/ ./ 头部/ 姿态/ 由/ 兴趣/ 点/ 在/ 三维空间/ 中/ 根据/ 几何/ 关系/ 计算/ 角度/ 得到/ ./ 并用/ 此/ 基于/ 粒子/ 滤波/ 算法/ 的/ 估计/ 结果/ 在/ 图像/ 的/ 估计/ 状态/ 和/ 样本/ 学习/ 结果/ 的/ 距离/ 空间/ 度量/ 视线/ 区域/ 结果/ ./ 其中/ ,/ 我们/ 加入/ 了/ 估计/ 的/ 置信/ 映射/ 来/ 帮助/ 我们/ 了解/ 估计/ 的/ 准确性/ ./ 关键帧/ 的/ 集合/ 为/ 犕/ =/ {/ 犕/ j/ |/ 1/ / j/ / k/ }/ ,/ 其中/ k/ 是/ 关键帧/ 的/ 数量/ ,/ 这一/ 数量/ 由/ 事先/ 确定/ 的/ 视线/ 区域/ 决定/ ./ 为了/ 建立/ 最优/ 的/ 基本/ 帧/ 的/ 集合/ ,/ 在/ 每/ 一帧/ 中/ 的/ 图像/ 元素/ 都/ 会/ 被/ 分析/ ,/ 进而/ 找到/ 其/ 相对/ 应/ 的/ 置信/ 概率/ 最高/ 的/ 视线/ 区域/ ./ 当/ 我们/ 确定/ 样本/ 集后/ ,/ 新/ 的/ 图像/ 帧/ 就/ 可以/ 与/ 样本/ 集/ 的/ 中心/ 进行/ 比较/ ,/ 这里/ 我们/ 用/ 条件/ 分布/ p/ (/ 犕/ |/ 犕/ j/ )/ 来/ 表示/ 在/ 新/ 的/ 图像/ 帧/ 的/ 状态/ 已知/ 的/ 情况/ 下/ 推测/ 其/ 属于/ 样本/ j/ 的/ 概率/ ,/ 在/ 求出/ 相应/ 的/ 离散/ 分布/ 后/ 我们/ 选择/ 概率/ 最大/ 的/ 样本/ 的/ 指数/ 作为/ 当下/ 驾驶者/ 的/ 视线/ 区域/ 号/ ./ 为了/ 计算/ 简便/ ,/ 样本/ 集/ 的/ 基数/ 会/ 尽可能/ 地小/ ./ 此外/ ,/ 头部/ 姿态/ 的/ 估计/ 模型/ 还/ 保留/ 了/ 随机变量/ 的/ 相关矩阵/ Λ/ x/ =/ E/ (/ 犕/ -/ μ/ )/ (/ 犕/ -/ μ/ )/ ,/ 此/ 为/ 头部/ 姿态/ 的/ 协方差/ 矩阵/ ,/ 并/ 以此/ 为/ 依据/ 估计/ 残差/ ./ 3/ 粒子/ 滤波/ 学习/ 过程/ 粒子/ 滤波/ 方法/ 或序贯/ 蒙特卡罗/ 方法/ 是/ 一组/ 通过/ 直接/ 实现/ 贝叶斯/ 递归/ 方程/ 来/ 估计/ 状态/ 空间/ 后验/ 密度/ 的/ 在线/ 后验/ 密度估计/ 算法/ ./ 它/ 提供/ 了/ 一种/ 产生/ 样本/ 的/ 行之有效/ 的/ 方法/ ,/ 且/ 无需/ 假设/ 状态/ 空间/ 模型/ 或/ 状态/ 分布/ ./ 状态/ 空间/ 模型/ 可以/ 是/ 非线性/ 的/ ,/ 初始状态/ 和/ 噪声/ 分布/ 可以/ 采取任何/ 形式/ 要求/ ./ 概率分布/ 用/ 一组/ 粒子/ 的/ 集合/ 来/ 表示/ ,/ 通过/ 寻找/ 一组/ 在/ 状态/ 空间/ 中/ 传播/ 的/ 随机样本/ 来/ 近似/ 地/ 表示/ 概率密度函数/ ,/ 获得/ 系统/ 状态/ 的/ 最小/ 方差/ 估计/ ./ 我们/ 假定/ 驾驶员/ 头部/ 为/ 刚性/ 物体/ ,/ 可以/ 通过/ 帧/ 与/ 帧/ 之前/ 的/ 特征/ 点/ 跟踪/ 计算/ 运动/ 参数/ ,/ 即/ 头部/ 姿态/ 参数/ ./ 将/ 人脸/ 单一/ 特征/ 点/ 映射/ 至/ 三维/ 图像/ 空间/ ,/ 利用/ 粒子/ 滤波/ 的/ 追踪/ 方法/ 估计/ 和/ 学习/ 驾驶员/ 头部/ 姿态/ ,/ 头部/ 姿态/ 角度/ 由/ 三维空间/ 几何/ 关系/ 计算/ 得到/ ./ 与/ 通常/ 在/ 三维空间/ 内/ 进行/ 所有/ 可能/ 的/ 全局/ 校准/ 不同/ ,/ 我们/ 在/ 目标/ 平面/ 自动/ 锁定/ 事先/ 选择/ 的/ 已知/ 点/ ,/ 然后/ 对/ 驾驶员/ 移动/ 头部/ 位置/ 的/ 情况/ 进行/ 已知/ 点/ 的/ 匹配/ 和/ 插值/ ./ 目标/ 的/ 识别/ 通过/ 基于/ 动态/ 的/ 重要性/ 采样/ 和/ 重/ 采样/ 过程/ 的/ 算法/ 来/ 实现/ ./ 在/ 最初/ 校准/ 的/ 过程/ 中/ ,/ 我们/ 可以/ 通过/ 标准化/ 的/ 模式/ 平移/ 向量/ 来/ 帮助/ 在/ 新/ 的/ 图像/ 中/ 定位/ 已知/ 的/ 校准/ 点/ ./ 因此/ ,/ 当前/ 帧/ 的/ 头部/ 姿态/ 可以/ 基于/ 这些/ 校准/ 点/ 集合/ 加上/ 系统/ 刚/ 开始/ 进行/ 时所/ 施加/ 的/ 学习/ 算法/ -/ 粒子/ 滤波/ 算法/ 更加/ 准确/ 的/ 估算/ 出来/ ./ 3.1/ 状态/ 空间/ 模型/ 在/ 状态/ 空间/ 模型/ 中/ 考虑/ 非线性/ 非/ 高斯/ 的/ 动力学/ 模型/ ,/ 其中/ 犡/ 1/ :/ t/ =/ {/ 犡/ 1/ ,/ 犡/ 2/ ,/ …/ ,/ 犡/ t/ }/ 作为/ 感兴趣/ 的/ 不可/ 观测/ 状态/ 随/ 时间/ 演变/ ,/ 而/ 在/ 连续/ 的/ 时间/ 点上/ 也/ 有/ 部分/ 可/ 观测/ 状态/ 犢/ 1/ :/ t/ =/ {/ 犢/ 1/ ,/ 犢/ 2/ ,/ …/ ,/ 犢/ t/ }/ ./ 同时/ ,/ 假定/ 状态/ 序列/ 为/ 马尔科夫/ 链/ ./ 在/ 此/ 情况/ 下/ ,/ 与/ 文献/ [/ 16/ ]/ 类似/ ,/ 状态/ 空间/ 模型/ 可以/ 表示/ 时间/ 序列/ 的/ 过程/ ,/ 其/ 主要/ 构成/ 为/ :/ 状态/ 转换/ 模型/ :/ 犡/ t/ =/ Ft/ (/ 犡/ t/ -/ 1/ ,/ 犝/ t/ )/ / ft/ (/ 犡/ t/ |/ 犡/ t/ -/ 1/ 观测/ 模型/ :/ 犢/ t/ =/ Gt/ (/ 犡/ t/ ,/ 犞/ t/ )/ / gt/ (/ 犢/ t/ |/ 犡/ t/ 我们/ 定义/ 驾驶员/ 头部/ 姿态/ 状态/ 犡/ t/ =/ [/ 犃/ t/ 狏/ t/ ]/ T/ ,/ 其中/ 犃/ t/ =/ (/ Tx/ ,/ Ty/ ,/ Tz/ ,/ α/ t/ ,/ β/ t/ ,/ γ/ t/ )/ 是/ 一个/ 六维/ 向量/ ,/ 由/ 平面坐标/ 的/ x/ ,/ y/ ,/ z/ 轴/ 的/ 位移/ 和/ 头部/ 的/ 水平/ 偏离/ 度/ α/ t/ 、/ 垂直/ 倾斜度/ β/ t/ 、/ 左右/ 旋转/ 度/ γ/ t/ 组成/ ./ 这里/ 狏/ t/ 为/ 线速度/ 和/ 角速度/ 组成/ 的/ 向量/ ./ 在/ 对/ 头部/ 运动/ 进行/ 追踪/ 时/ ,/ 我们/ 假定/ 驾驶者/ 的/ 视线/ 在/ 大多数/ 时间/ 专注/ 于/ 一个/ 方向/ ,/ 这/ 与/ 真实/ 驾驶/ 行为/ 一致/ ,/ 故/ 我们/ 在/ 初始化/ 时/ 锁定/ 这一/ 视线/ 区域/ 的/ 参数/ ./ 当/ 驾驶者/ 的/ 头部/ 有/ 很大/ 偏移/ 时/ ,/ 我们/ 的/ 模型/ 能/ 计算/ 驾驶者/ 当前/ 的/ 头部/ 中心/ 位置/ 和/ 实现/ 锁定/ 的/ 视线/ 区域/ ,/ 进而/ 基于/ 事先/ 设定/ 的/ 视线/ 区域/ 标号/ 对/ 当前/ 的/ 视线/ 区域/ 进行/ 最近/ 距离/ 的/ 估计/ ./ 我们/ 用/ 文献/ [/ 7/ ]/ 中/ 提到/ 的/ 混合/ 状态/ 犡/ / (/ 1/ -/ τ/ t/ )/ 犡/ 其中/ τ/ t/ 为二值/ 随机变量/ ,/ 取值/ 范围/ 0/ 和/ 1/ ,/ 且/ 犡/ 10/ (/ )/ 00/ 犡/ 态/ ,/ 犡/ (/ 2/ )/ t/ =/ 里/ 我们/ 忽略/ 了/ 对/ 加速度/ 的/ 考虑/ ,/ 这/ 是因为/ 头部/ 在/ 转动/ 的/ 时候/ 更/ 趋向于/ 常/ 速度/ 连续/ 的/ 转动/ ./ 其中/ ,/ 狌/ t/ 是/ 微小/ 的/ 头部/ 瞬间/ 转动/ ./ 因此/ 其/ 实现/ 为/ 犢/ t/ =/ 犜/ ∈/ 犡/ t/ +/ 犞/ t/ ,/ 犜/ ∈/ 是/ 两个/ 空间/ 的/ 转换/ ,/ 犞/ t/ 是/ t/ 时刻/ 的/ 噪声/ ./ τ/ t/ 的/ 分布/ 基于/ 物体/ 的/ 转动/ 速度/ ,/ 当/ τ/ t/ =/ 1/ 时/ 满足/ d/ (/ 犢/ t/ ,/ 犢/ t/ -/ 1/ )/ >/ ε/ 1/ ,/ d/ (/ 犃/ t/ ,/ 犃/ t/ -/ 1/ )/ >/ ε/ 2/ ./ 其中/ ε/ 1/ ,/ ε/ 2/ 为/ 转动/ 速度/ 阈值/ ,/ 即/ 两个/ Page5/ 时间/ 点/ 脸部/ 特征/ 的/ 移动/ 超过/ 这个/ 值/ 我们/ 认为/ 头部/ 在/ 转动/ ,/ 否则/ τ/ t/ =/ 0.3/ ./ 2/ 粒子/ 滤波/ 算法/ 接下来/ 我们/ 介绍/ 适用/ 于/ 时间/ 序列/ 模型/ 即/ 状态/ 空间/ 模型/ 的/ 粒子/ 滤波/ 算法/ ./ 在/ 贝叶斯/ 框架/ 中/ ,/ 依赖/ 后验/ 概率密度/ 进行/ 推理/ ,/ 状态/ 犡/ t/ 和/ 观测/ 犢/ t/ 的/ 联合/ 概率密度/ 为/ p0/ :/ T/ ,/ 0/ :/ T/ (/ 犡/ 0/ :/ T/ ,/ 犢/ 0/ :/ T/ )/ =/ p0/ (/ 犡/ 0/ )/ g/ (/ 犢/ 0/ |/ 犡/ 0/ )/ ×/ ∏/ 其中/ p0/ 是/ 犡/ 0/ 的/ 初始/ 概率密度/ ./ 因此/ ,/ 依据/ 状态/ 转换/ 模型/ 和/ 观测/ 模型/ ,/ 状态/ 和/ 数据/ 从/ 状态/ 空间/ 模型/ 中/ 随机/ 采样/ 的/ 过程/ 中/ ,/ 样本/ 路径/ (/ 狓/ ~/ 0/ ~/ p0/ (/ 犡/ 0/ )/ ,/ 其余/ 狓/ ~/ 狓/ ~/ (/ 狔/ ~/ 0/ ,/ …/ ,/ 狔/ ~/ gt/ (/ 狔/ t/ |/ 犡/ t/ =/ 狓/ ~/ 在/ 粒子/ 滤波/ 算法/ 中/ ,/ 对/ 转换/ 密度/ 和/ 观测/ 密度/ 函数/ 的/ 分布/ 估计/ 是/ 至关重要/ 的/ ./ 事实上/ 对于/ 当前/ 状态/ 分布/ p/ (/ 犡/ )/ 我们/ 不/ 知道/ 其/ 准确/ 的/ 趋势/ ,/ 故用/ 任/ 一经/ 标准化/ 的/ 重要性/ 分布/ q/ (/ 犡/ )/ 替代/ ,/ 然后/ 根据/ 前/ 一/ 时刻/ 的/ 状态/ 和/ 观测/ 值/ 对/ 当前/ 的/ 样本/ 数据/ 赋予/ 权重/ ./ 对/ 第/ i/ 个/ 样本/ 权重/ wp/ (/ 犡/ t/ =/ 狓/ t/ |/ 犢/ 1/ :/ t/ =/ 狔/ 1/ :/ t/ )/ =/ σ/ t/ |/ 0/ :/ t/ -/ 1/ =/ ∫/ / 则/ 有/ 由于/ 我们/ 基本/ 不/ 可能/ 依据/ 密度/ 函数/ p0/ :/ t/ |/ 0/ :/ t/ (/ 犡/ 0/ :/ t/ │/ 犢/ 0/ :/ t/ )/ 进行/ 取样/ ,/ 故/ 我们/ 根据/ 概率密度/ q/ (/ 0/ :/ t/ )/ (/ 犡/ 0/ :/ t/ │/ 犢/ 0/ :/ t/ )/ 选取/ N/ 个/ 样本/ 狓/ ~/ (/ i/ )/ 这些/ 权重/ 经过/ 标准化/ 被/ 映射/ 到/ [/ 0/ ,/ 1/ ]/ 区间/ ,/ 其中/ (/ i/ )/ t/ =/ wj/ =/ 1/ ∑/ q0/ :/ t/ (/ 犡/ 0/ :/ t/ =/ 狓/ 0/ :/ t/ |/ 犢/ 0/ :/ t/ =/ 狔/ 0/ :/ t/ )/ =/ q0/ :/ t/ -/ 1/ (/ 狓/ 0/ :/ t/ -/ 1/ |/ 狔/ 0/ :/ t/ -/ 1/ 我们/ 找到/ 了/ ww/ ~/ (/ i/ )/ t/ =/ =/ w/ ~/ (/ i/ )/ =/ cw/ 其中/ c/ 为/ 常数/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ ./ 值/ σ/ t/ |/ 0/ :/ t/ -/ 1/ (/ 狔/ t/ |/ 狔/ 0/ :/ t/ -/ 1/ )/ 由于/ 会/ 最终/ 进行/ 标准化/ 所以/ 在/ 计算/ 中/ 不起作用/ ./ 由于/ 时间/ 过长/ 后/ 权重/ 的/ 作用/ 会/ 渐渐/ 失效/ ,/ 故/ 我们/ 要/ 在/ 每/ 一步/ 计算/ 完/ 权重/ 后/ 进行/ 重/ 采样/ ./ 粒子/ 滤波/ 方法/ 用于/ 原则上/ 提升/ 时间/ 点/ t/ 的/ 新/ 状态/ 的/ 概率分布/ ,/ 我们/ 在/ 标准/ 重/ 采样/ 过程/ 上/ 进行/ 了/ 改进/ ,/ 使用/ 辅助/ 采样/ 的/ 方法/ 使得/ 在/ 下/ 一/ 时刻/ 有利于/ 粒子/ 的/ 存活/ ./ 首先/ ,/ 假设/ 在/ 时间/ 点/ t/ -/ 1/ 联合/ 后验/ 概率函数/ 可以/ 很/ 好/ 的/ 被/ ^/ p0/ :/ t/ -/ 1/ |/ 0/ :/ t/ -/ 1/ (/ d/ 狓/ 0/ :/ t/ )/ =/ ∑/ 致/ 的/ 近似/ ,/ 其中/ δ/ 狓/ 间/ 点/ t/ 的/ 联合/ 后验/ 概率/ 可以/ 近似/ 为/ p0/ :/ t/ |/ 0/ :/ t/ (/ d/ 狓/ 0/ :/ t/ |/ 狔/ 0/ :/ t/ )/ ≈/ Nw1Z/ ∑/ 其中/ 归一化/ 因子/ Z/ 定义/ 为/ i/ =/ 1/ 因此/ 新/ 粒子/ 狓/ qt/ (/ d/ 狓/ 0/ :/ t/ )/ =/ q0/ :/ t/ -/ 1/ (/ d/ 狓/ 0/ :/ t/ -/ 1/ |/ 狔/ 0/ :/ t/ )/ qt/ (/ d/ 狓/ t/ |/ 狓/ t/ -/ 1/ ,/ 狔/ t/ )/ (/ =/ ∑/ Ni/ =/ 1Ni/ =/ 1/ 其中/ ∑/ 过程/ 狓/ 0/ :/ t/ -/ 1/ 过去/ 路径/ 的/ 边缘/ 分布/ q0/ :/ t/ -/ 1/ 和/ 新/ 状态/ 狓/ t/ 的/ 条件/ 分布/ qt/ ./ 第一/ 部分/ 在/ 老/ 粒子/ 路径/ {/ 狓/ 散/ 分布/ ./ 权重/ 函数/ v/ 可以/ 预先选择/ 适应性/ 好/ 的/ 粒子/ ./ 取/ 状态/ 某/ 一点/ 的/ 值/ μ/ 均/ ,/ 计算/ 权值/ 函数/ 作为/ 该点/ 的/ 似然/ 函数/ ,/ vg/ (/ 狔/ t/ |/ μ/ (/ i/ )/ vt/ -/ 1/ =/ w/ 点/ t/ 的/ 滤波/ ,/ 从/ 边缘/ 条件/ 分布/ p0/ :/ t/ -/ 1/ |/ 0/ :/ t/ 可以/ 得到/ 过去/ 的/ 路径/ 狓/ 0/ :/ t/ -/ 1/ ,/ 使用/ 时间/ 点/ t/ -/ 1/ 的/ 粒子/ 近似/ 可以/ 得到/ p0/ :/ t/ -/ 1/ |/ 0/ :/ t/ (/ d/ 狓/ 0/ :/ t/ -/ 1/ |/ 狔/ 0/ :/ t/ )/ ∝/ ∫/ p0/ :/ t/ -/ 1/ |/ 0/ :/ t/ -/ 1/ (/ d/ 狓/ 0/ :/ t/ -/ 1/ |/ 狔/ 0/ :/ t/ -/ 1/ )/ f/ (/ 狓/ t/ |/ 狓/ t/ -/ 1/ )/ g/ (/ 狔/ t/ |/ 狓/ t/ )/ d/ 狓/ tNw/ ≈/ ∑/ i/ =/ 1Page6/ 在/ 蒙特卡罗/ 方法/ 中/ ,/ 使用/ 粗略/ 的/ 近似/ 函数/ 来/ 处理/ ,/ 令/ f/ (/ d/ 狓/ t/ |/ 狓/ p0/ :/ t/ -/ 1/ |/ 0/ :/ t/ (/ d/ 狓/ 0/ :/ t/ -/ 1/ |/ 狔/ 0/ :/ t/ )/ ≈/ ∑/ 我们/ 使用/ 上述/ 机制/ 定义/ 粒子/ 的/ 广义/ 重要性/ 比率/ ,/ 即/ 与/ 标准/ 的/ 序贯/ 重要性/ 采样/ 相比/ ,/ 我们/ 的/ 采样/ 方法/ 在/ 计算/ 偏置/ 时/ 修正/ 重要/ 权值/ 等于/ 1/ // v/ 一层/ 权值/ 为/ 比率/ w/ 采样/ 过程/ 中/ ,/ 可以/ 利用/ 原来/ 时刻/ 预测/ 的/ 似然度/ 大/ 的/ 粒子/ 扩展/ 到/ 该/ 时刻/ ,/ 增加/ 了/ 粒子/ 的/ 多样性/ 的/ 同时/ 减少/ 了/ 重要性/ 权值/ 的/ 方差/ ,/ 可以/ 产生/ 更/ 精确/ 的/ 估计/ ./ 我们/ 能够/ 基于/ 这个/ 状态/ 模型/ 和/ 观测/ 密度/ 函数/ gt/ (/ 犢/ t/ |/ 犡/ t/ )/ ∝/ (/ 1/ // B/ )/ exp/ (/ -/ λ/ d/ (/ 犢/ t/ ,/ 犜/ ∈/ 犡/ t/ +/ 犞/ t/ )/ )/ 来/ 估计/ 转移/ 密度/ 函数/ ft/ (/ 犡/ t/ |/ 犡/ t/ -/ 1/ )/ ,/ 其中/ B/ 为/ 标准化/ 常数/ ./ 利用/ 粒子/ 滤波/ 方法/ 估计/ 当前/ 的/ 状态/ 犡/ t/ ,/ 其/ 由/ 样本/ 点/ 的/ 加权/ 平均值/ 犡/ ^/ 粒子/ 滤波/ 方法/ 作为/ 一种/ 基于/ 贝叶斯/ 估计/ 的/ 非线性/ 滤波/ 算法/ ,/ 在/ 处理/ 非/ 高斯/ 非线性/ 时变/ 系统/ 的/ 参数估计/ 和/ 状态/ 滤波/ 问题/ 方面/ 有/ 独到/ 的/ 优势/ ./ 由/ 上述/ 方法/ 可知/ ,/ 在/ 系统/ 运行/ 之前/ ,/ 设定/ 所有/ 要求/ 的/ 参数/ ,/ 则/ 系统/ 可以/ 通过/ 粒子/ 滤波/ 对/ 头部/ 姿态/ 的/ 追踪/ 和/ 估计/ ,/ 实现/ 视线/ 区域/ 的/ 自动/ 校准/ ,/ 完全/ 不/ 需要/ 驾驶/ 人/ 特殊/ 的/ 合作/ ./ 4/ 实验/ 结果/ 4.1/ 实验/ 环境/ 及/ 数据/ 来源/ 在/ 系统/ 初始化/ 前/ ,/ 我们/ 用/ 驾驶员/ 头部/ 运动/ 传感器/ 实时/ 记录/ 头部/ 姿态/ 的/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ ,/ 并/ 与/ 设定/ 好/ 的/ 视线/ 区域/ 编号/ 进行/ 对应/ ,/ 确定/ 相应/ 的/ 头部/ 姿态/ 角度/ 和/ 区域/ 编号/ 的/ 映射/ ./ 具体/ 的/ 注视/ 区域/ 划分/ 详见/ 4.2/ 节/ ./ 然后/ 使用/ 摄像头/ 实时/ 记录/ 驾驶员/ 的/ 图像/ ,/ 对/ 每/ 帧/ 图像/ 进行/ 人脸/ 检测/ 和/ 追踪/ ,/ 提取/ 感兴趣/ 的/ 特征/ 点/ ,/ 并/ 估计/ 驾驶员/ 的/ 头部/ 姿态/ 角度/ ./ 为/ 保证/ 头部/ 姿态/ 角度/ 的/ 正确性/ ,/ 会/ 使用/ 部分/ 数据/ 初始化/ 头部/ 姿态/ 零点/ ./ 最后/ ,/ 施加/ 样本/ 集/ 学习/ 和/ 粒子/ 滤波/ 算法/ 对/ 头部/ 姿态/ 更新/ ,/ 根据/ 置信/ 概率/ 确定/ 状态/ 可信性/ ,/ 并/ 输出/ 当前/ 的/ 注视/ 视线/ 区域/ ,/ 完成/ 对/ 注视/ 视线/ 的/ 校准/ ./ 为了/ 验证/ 本文/ 的/ 自动/ 校准/ 算法/ 效果/ ,/ 我们/ 采集/ 了/ 真实/ 环境/ 的/ 图像/ 数据/ 进行/ 测试/ 实验/ ./ 其中/ ,/ 实验/ 环境/ 为/ IntelCorei52/ ./ 67GHzCPU/ 和/ 4GBRAM/ 的/ 电脑/ ./ 图像/ 数据/ 来源于/ 同一个/ USB/ 摄像头/ ,/ 图像/ 分辨率/ 为/ 640/ ×/ 480/ 像素/ ./ 摄像头/ 固定/ 在/ 靠近/ 方向盘/ 的/ 仪表盘/ 中心/ ,/ 距/ 驾驶员/ 有/ 一定/ 角度/ ./ 我们/ 在/ 捕捉/ 驾驶者/ 脸部/ 特征/ 的/ 摄像头/ 里/ 加装/ 了/ 能够/ 同时/ 适应/ 白天/ 和/ 黑夜/ 的/ 红外光/ 源及/ 光照/ 转换/ 装置/ ,/ 增强/ 实验/ 装置/ 抗弱/ 光线/ 条件/ 的/ 鲁棒性/ ./ 驾驶者/ 测试/ 时/ 头戴/ TrivisioColibri/ 惯性/ 位置/ 追踪/ 器/ ,/ 以/ 接收/ 头部/ 姿态/ 的/ 实际/ 数据/ ./ 我们/ 随机/ 选取/ 8/ 个/ 个体/ ,/ 共/ 收集/ 16/ 万帧/ 的/ 连续/ 图像/ 数据/ ,/ 来/ 测试/ 我们/ 提出/ 的/ 算法/ 适应/ 不同/ 个体/ 的/ 驾驶/ 习惯/ 的/ 能力/ ./ 其中/ ,/ 部分/ 被试/ 驾驶员/ 情况/ 信息/ 如表/ 1/ 所示/ ./ 由于/ 不同/ 的/ 驾驶员/ 的/ 视觉/ 搜索/ 模式/ (/ 注视/ 持续时间/ 、/ 注视点/ 分布/ 、/ 注视/ 视角/ 等/ )/ 具有/ 差异性/ ,/ 因此/ 表中/ 列出/ 驾驶员/ 的/ 性别/ 、/ 年龄/ 、/ 身高/ 、/ 驾龄/ 等/ 情况/ ,/ 并/ 在/ 之后/ 的/ 部分/ 对/ 驾驶员/ 的/ 误差/ 进行/ 了/ 对比/ ./ 我们/ 将/ 驾驶员/ 划分/ 为/ 熟练/ 驾驶员/ 和/ 非/ 熟练/ 驾驶员/ :/ 其中/ 熟练/ 驾驶员/ 为/ 驾龄/ 5/ 年/ 及/ 以上/ 的/ 驾驶员/ ,/ 即表/ 1/ 中前/ 4/ 位/ 驾驶员/ ;/ 而/ 非/ 熟练/ 驾驶员/ 则/ 为/ 驾龄/ 5/ 年/ 以下/ 的/ 驾驶员/ ,/ 即表/ 1/ 中后/ 4/ 位/ 驾驶员/ ./ 编号/ 0010020030040050060070084.2/ 视线/ 区域/ 的/ 表示/ 在/ 一般/ 情况/ 下/ ,/ 驾驶员/ 以/ 头部/ 中心/ 为/ 轴/ ,/ 转向/ 其/ 注视/ 的/ 物体/ ./ 因此/ ,/ 驾驶者/ 头部/ 姿态/ 决定/ 了/ 视线/ 区域/ ./ 我们/ 根据/ 驾驶/ 环境/ 及/ 注视/ 习惯/ 划分/ 了/ 不同/ 的/ 视线/ 区域/ ./ 本文/ 所/ 划分/ 的/ 9/ 个/ 视线/ 区域/ 参照/ 了/ 文献/ [/ 11/ ]/ 中/ 所/ 描述/ 的/ 方法/ ./ 文献/ [/ 11/ ]/ 中/ 的/ 部分/ 视线/ 区域/ 在/ 正常/ 行驶/ 过程/ 中/ 注视/ 概率/ 几乎/ 为/ 零/ ,/ 并且/ 不同/ 驾驶员/ 朝向/ 后视镜/ 的/ 注视/ 概率/ 并/ 不/ 稳定/ ,/ 因此/ 我们/ 使用/ K/ -/ mean/ 聚类/ 的/ 方法/ 将/ 原有/ 12/ 个/ 视线/ 区域/ 优化/ 为/ 9/ 个/ 视线/ 区域/ ./ 如图/ 4/ 所示/ ,/ 视线/ 区域/ 的/ 划分/ 是/ 基于/ 真实/ 的/ 驾驶/ 环境/ ./ 由于/ 朝向/ 后/ 视窗/ 头部/ 特征/ 几乎/ 无法/ 提取/ ,/ 我们/ 采用/ 带有/ 倒车/ 影像/ 的/ 车辆/ 规避/ 倒车/ 时/ 头部/ 转向/ ./ 因此/ 中央/ 控制台/ 区域/ 的/ 注视/ 频率/ 实际/ 也/ 包含/ 了/ 朝向/ 后/ 视窗/ 的/ 注视/ ./ 在/ 朝向/ 风挡/ 玻璃/ 即/ 区域/ 3/ 、/ 区域/ 5/ 及/ Page7/ 区域/ 6/ 时/ ,/ 驾驶员/ 通常/ 会/ 结合/ 头部/ 转动/ 和/ 眼球/ 运动/ ,/ 但/ 只/ 对/ 同一/ 视野/ 的/ 近距离/ 、/ 中距离/ 和/ 远距离/ 的/ 车前/ 状况/ ,/ 有/ 较/ 多/ 的/ 眼球/ 运动/ 观察/ ./ 4.3/ 视线/ 区域/ 的/ 估计/ 视线/ 区域/ 的/ 估计/ 步骤/ 需在/ 平面/ 上/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ 零点/ 位置/ 已知/ 的/ 情况/ 下/ 进行/ 初始化/ ./ 通常/ 我们/ 认为/ 直视/ 视线/ 区域/ 6/ 的/ 中心/ 位置/ 为/ 零点/ ./ 在/ 此/ 实验/ 中/ ,/ 我们/ 用/ 500/ 帧/ 的/ 图像/ 初始化/ 零点/ ,/ 进而/ 认为/ 其/ 欧拉角/ 为/ 零/ (/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度均/ 为/ 零/ )/ ./ 犚/ (/ θ/ )/ =/ (/ α/ ,/ β/ ,/ γ/ )/ 表示/ 在/ XYZ/ 坐标系/ 下/ 的/ 欧拉角/ ,/ 其中/ α/ 为/ 水平/ 偏离/ 度/ 、/ β/ 为/ 垂直/ 倾斜度/ ,/ γ/ 为/ 左右/ 旋转/ 度/ ,/ 如图/ 5/ 所示/ ./ 这里/ 使用/ 单目/ 摄像头/ 的/ 深度/ 估计/ 建立/ 鼻子/ 顶点/ P/ 到/ 坐标轴/ 中心点/ O/ 的/ 位移/ 和/ 偏移/ 欧拉角/ ./ 其中/ 坐标轴/ 中心点/ 即/ 头部/ 中心点/ ./ 之后/ ,/ 我们/ 对/ 图像/ 序列/ 进行/ 训练/ 以/ 寻找/ 基本/ 帧/ ,/ 进而/ 在/ 形成/ 样本/ 集/ 之后/ 我们/ 能/ 用/ 样本/ 集/ 的/ 元素/ 来/ 估计/ 当前/ 驾驶者/ 所处/ 的/ 状态/ ,/ 进而/ 求出/ 其/ 视线/ 区域/ ./ 当/ 学习/ 算法/ 对/ 50000/ 帧/ 的/ 图像/ 经过/ 两轮/ 学习/ 过后/ ,/ 我们/ 得到/ 表/ 2/ ,/ 即/ 每个/ 视线/ 区域/ 中心/ 的/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 与/ 左右/ 旋转/ 度/ ./ 当/ 追踪/ 器/ 得到/ 每/ 一帧/ 图像/ 后/ ,/ 算法/ 会/ 针对/ 当前/ 状态/ 在/ 样本空间/ 生成/ 概率分布/ ,/ 最后/ 概率/ 值/ 最大/ 的/ 样本/ 集/ 指标/ 为/ 驾驶者/ 当前/ 视线/ 区域/ 的/ 标号/ ./ 对于/ 同一个/ 图像/ 提取/ 装置/ 和/ 同/ 一段/ 图像/ 序列/ ,/ 由于/ 我们/ 采取/ 了/ 随机/ 结构/ 用于/ 驾驶者/ 脸部/ 的/ 识别/ ,/ 视线/ 区域/ 123456789/ 故/ 我们/ 重复/ 实验所/ 得到/ 的/ 数据/ 会/ 有/ 区别/ 于表/ 2/ ,/ 但/ 不/ 影响/ 对/ 视线/ 区域/ 的/ 估计/ 结果/ ./ 我们/ 对/ 全部/ 图像/ 帧/ 进行/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ 的/ 计算/ 后/ 发现/ ,/ 其/ 平均值/ 最后/ 稳定/ 到/ 0.024/ 、/ -/ 0.005/ 和/ 0.013/ ./ 这/ 表示/ 驾驶者/ 大部分/ 时间/ 都/ 注视/ 前方/ ,/ 若/ 与/ 此/ 结果/ 相悖/ ,/ 则/ 很/ 有/ 可能/ 在/ 这/ 段时间/ 驾驶者/ 处于/ 比较/ 疲劳/ 的/ 阶段/ ,/ 则/ 能够/ 通过/ 此/ 结果/ 对/ 驾驶员/ 进行/ 警示/ 或者/ 采取/ 刹车/ 处理/ ./ 在/ 真实/ 驾驶/ 环境/ 中/ ,/ 部分/ 驾驶员/ 的/ 置信/ 概率/ 平均值/ 曲线/ 如图/ 6/ 所示/ ./ 基于/ 当前/ 状态/ 的/ 置信/ 评估/ 来/ 判断/ 头部/ 姿态/ 估计/ 的/ 准确性/ ,/ 初期/ 置信/ 概率/ 较/ 不/ 稳定/ ,/ 随着/ 帧/ 数/ 的/ 增加/ ,/ 置信/ 概率/ 的/ 平均值/ 逐步/ 上升/ ,/ 这/ 说明/ 对/ 头部/ 姿态/ 的/ 估计/ 数值/ 逐渐/ 更为/ 准确/ ./ 以/ 001/ 驾驶员/ 为例/ ,/ 在/ 真实/ 驾驶/ 环境/ 中/ ,/ 我们/ 得到/ 至/ 9000/ 帧/ 时/ ,/ 置信/ 概率/ 的/ 平均值/ 为/ 0.6743/ ,/ 标准差/ 为/ 0.0963/ ,/ 基本/ 趋于稳定/ ./ 而/ 其他/ 驾驶员/ 的/ 置信/ 概率/ 也/ 分别/ 稳定/ 至/ 0.6682/ 和/ 0.7052/ 之前/ ./ 除此之外/ ,/ 式/ (/ 1/ )/ 中/ 的/ τ/ t/ 需/ 进行/ 准确/ 取值/ ,/ 在/ 我们/ 的/ 实验/ 中其/ 当前/ 值/ 的/ 确定/ 依赖于/ 之前/ 一个/ 时刻/ 头部/ 摆动/ 速度/ 的/ 值/ ,/ τ/ t/ =/ 1/ 必有/ vt/ 超出/ 了/ 我们/ 事先/ 设定/ Page8/ 的/ 阈值/ ./ 经过/ 对/ 初始化/ 前/ 传感器/ 的/ 样本/ 进行/ 统计/ 我们/ 得到/ 平均/ 角速度/ 大约/ 为/ 1.5/ °/ ,/ 故/ 我们/ 取/ 1.4/ °/ 为/ 阈值/ ,/ 这/ 是因为/ 在/ 统计/ 过程/ 中/ 计算/ 的/ 方差/ 较大/ ,/ 取/ 这个/ 值/ 可以/ 大致/ 符合实际/ 情况/ ./ 此/ 阈值/ 会/ 在/ 对/ 头部/ 姿态/ 判断/ 的/ 过程/ 中/ 进行/ 不断/ 修改/ 使得/ 其/ 相对/ 准确/ ./ 4.4/ 视线/ 区域/ 注视/ 的/ 频率/ 统计/ 我们/ 对/ 所有/ 数据/ 帧/ 进行/ 视线/ 区域/ 注视/ 概率/ 的/ 统计/ 得到/ 了/ 表/ 3/ ,/ 其中/ 对于/ 熟练/ 驾驶员/ 和/ 非/ 熟练/ 驾驶员/ 分别/ 进行/ 了/ 统计/ ./ 视线/ 区域/ 由表/ 3/ 可知/ ,/ 区域/ 6/ 即/ 正前方/ 区域/ 最/ 频繁/ 被/ 使用/ ./ 除了/ 区域/ 6/ 以外/ ,/ 区域/ 1/ 、/ 区域/ 2/ 及/ 区域/ 4/ 也/ 经常/ 是/ 驾驶员/ 注视/ 的/ 目标/ ,/ 即/ 左视镜/ ,/ 右视镜/ 和/ 后视镜/ ,/ 这/ 符合/ 大多数/ 人/ 的/ 开车/ 习惯/ ./ 非/ 熟练/ 驾驶员/ 比/ 熟练/ 驾驶员/ 更/ 注意/ 区域/ 1/ 、/ 区域/ 2/ 及/ 区域/ 4/ ,/ 即/ 左视镜/ ,/ 右视镜/ 和/ 后视镜/ ./ 而/ 熟练/ 驾驶员/ 对/ 前方/ 的/ 区域/ 注视/ 频率/ 比非/ 熟练/ 驾驶员/ 更为/ 平均/ 一些/ ./ 4.5/ 与/ 标准/ 数据/ 进行/ 对比/ 我们/ 对/ 每个/ 被试/ 驾驶员/ 所/ 收集/ 的/ 数据/ 帧/ 中/ 选取/ 帧/ 500/ 到/ 帧/ 7500/ 进行/ 测试/ ,/ 并/ 对比/ 我们/ 的/ 方法/ 估计/ 的/ 头部/ 姿态/ 和/ 头部/ 运动/ 传感器/ 的/ 真实/ 头部/ 姿态/ ,/ 这时/ 估计值/ 是/ 乘以/ 扩张/ 系数/ 的/ 最终/ 值/ ./ 我们/ 最终/ 得到/ 的/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ 的/ 误差/ 曲线/ 如图/ 7/ 和/ 图/ 8/ 所示/ ./ 由于/ 有/ 预先/ 的/ 视线/ 区域/ 的/ 划分/ ,/ 在/ 本文/ 中/ 我们/ 设定/ 水平/ 偏移/ 角/ 和/ 垂直/ 倾斜角/ 的/ 容忍/ 误差/ 可/ 接收/ 率/ 由/ 划分/ 的/ 视线/ 区域/ 块/ 的/ 最小/ 块/ 决定/ ,/ 其中/ 水平/ 偏离/ 度/ 2/ °/ ,/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度表/ 4/ 绝对误差/ 的/ 统计/ 特性/ 编号/ 001002003004005006007008/ 均/ 为/ 1.5/ °/ ./ 由图/ 7/ 和/ 图/ 8/ 所示/ ,/ 水平/ 偏移/ 角/ 和/ 垂直/ 倾斜角/ 的/ 平均/ 绝对误差/ 曲线/ 是/ 收敛/ 的/ ,/ 并且/ 极限值/ 均/ 在/ 1.5/ °/ 左右/ ,/ 数值/ 能够/ 保证/ 大部分/ 时间/ 内/ 视线/ 区域/ 的/ 准确性/ ./ 当然/ 对于/ 倾斜度/ 而言/ ,/ 估计/ 误差/ 稍大/ ./ 这些/ 数据/ 保证/ 了/ 在/ 长时间/ 驾驶/ 中此/ 自动/ 校准/ 算法/ 能够/ 对/ 驾驶/ 人/ 的/ 视线/ 区域/ 有/ 相当/ 准确/ 的/ 判断/ ./ 综合/ 图/ 7/ 、/ 图/ 8/ 和表/ 4/ 结果/ 可知/ ,/ 熟练/ 驾驶员/ 的/ 绝对/ 平均误差/ 曲线/ 收敛/ 速度/ 略/ 快/ 于/ 非/ 熟练/ 驾驶员/ ./ 绝对误差/ 方差/ 1.2621/ ./ 1341.2121/ ./ 2361.3981/ ./ 3231.4011/ ./ 365Page9/ 而/ 非/ 熟练/ 驾驶员/ 的/ 视线/ 区域/ 的/ 可/ 接收/ 率略/ 小于/ 熟练/ 驾驶员/ ./ 但/ 总体而言/ ,/ 所有/ 被试/ 驾驶员/ 的/ 平均/ 绝对误差/ 相差/ 并不大/ ,/ 并且/ 误差/ 曲线/ 均/ 收敛/ ,/ 同时/ 绝对误差/ 方差/ 较/ 小/ ,/ 而且/ 具有/ 较/ 高/ 的/ 可/ 接收/ 率/ ./ 因此/ ,/ 该/ 结果表明/ ,/ 本文/ 算法/ 受/ 不同/ 个体/ 驾驶/ 习惯/ 影响/ 较/ 小/ ./ 4.6/ 自动/ 校准/ 算法/ 的/ 应用/ 我们/ 的/ 方法/ 无需/ 驾驶员/ 主动/ 配合/ ,/ 便/ 可/ 自动/ 校准/ 驾驶员/ 的/ 注视/ 视线/ 区域/ ,/ 并/ 稳定/ 的/ 输出/ 驾驶员/ 的/ 头部/ 姿态/ 角度/ 和/ 当前/ 注视/ ./ 由/ 结果/ 可知/ ,/ 基于/ 头部/ 姿态/ 的/ 注视/ 视线/ 估计/ 的/ 误差/ 低/ ,/ 可用性/ 高/ ./ 同时/ ,/ 关联/ 头部/ 姿态/ 和/ 注视/ 视线/ 区域/ 的/ 自动/ 校准/ 方法/ 受/ 不同/ 驾驶员/ 及/ 驾驶/ 习惯/ 的/ 影响/ 小/ ./ 通过/ 追踪/ 和/ 估计/ 驾驶员/ 的/ 注视/ 视线/ 及/ 视线/ 区域/ ,/ 可以/ 分析/ 驾驶员/ 的/ 注视/ 持续时间/ 、/ 注视点/ 分布/ 、/ 注视/ 视角/ 等/ 特性/ ,/ 实时/ 掌握/ 驾驶员/ 的/ 状况/ ,/ 感知/ 驾驶员/ 对/ 路况/ 及/ 交通/ 信息/ 的/ 注意/ 程度/ ,/ 以便/ 搭建/ 新型/ 的/ 车/ 联网/ 智能/ 交通安全/ 驾驶/ 系统/ ./ 5/ 结论/ 本文/ 提出/ 了/ 一个/ 在/ 真实/ 驾驶/ 环境/ 中/ 对/ 驾驶员/ 视线/ 方向/ 进行/ 自动/ 校准/ 和/ 估计/ 的/ 算法/ ./ 系统/ 的/ 运行/ 基于/ 嵌入/ 的/ 样本/ 集/ 学习/ 算法/ 和/ 粒子/ 滤波/ 算法/ ./ 两个/ 算法/ 融合/ 在/ 一起/ 可以/ 估计/ 驾驶员/ 头部/ 运动/ ,/ 也/ 可以/ 在/ 其他/ 方面/ 有/ 广泛应用/ ./ 这种/ 算法/ 的/ 优势/ 在于/ 其/ 能够/ 使/ 系统/ 进行/ 自动/ 估计/ 而/ 不/ 需要/ 驾驶员/ 的/ 合作/ ,/ 系统/ 运行/ 之前/ 会/ 有/ 初始化/ 的/ 过程/ ,/ 进行/ 标准/ 数据/ 预设/ 参数/ 和/ 视线/ 区域/ 的/ 划分/ ./ 在/ 算法/ 执行/ 之前/ 我们/ 加入/ 脸部/ 识别/ 算法/ 以/ 确定/ 头部/ 姿态/ 零点/ ,/ 利用/ 稳定/ 的/ 人脸/ 特征提取/ 方法/ 提取/ 特征/ ./ 之后/ ,/ 学习/ 算法/ 在/ 图像/ 中/ 对/ 不同/ 的/ 视线/ 区域/ 选取/ 基本/ 帧/ 构成/ 不同/ 的/ 集合/ 类/ ,/ 即/ 视线/ 区域/ 的/ 商集/ ./ 进而/ 对/ 粒子/ 滤波/ 算法/ 提供/ 基本/ 的/ 样本/ 集/ ,/ 经过/ 粒子/ 滤波/ 算法/ 对/ 当前/ 驾驶员/ 的/ 状态/ 进行/ 取样/ ,/ 计算/ 加权/ 平均值/ ,/ 我们/ 得到/ 估计/ 的/ 水平/ 偏离/ 度/ 、/ 垂直/ 倾斜度/ 和/ 左右/ 旋转/ 度/ ,/ 进而/ 构造/ 其/ 在/ 样本/ 集/ 空间/ 的/ 条件/ 概率分布/ ,/ 选取/ 概率/ 最大/ 的/ 样本/ 指标/ 作为/ 视线/ 区域/ 的/ 编号/ ./ 本文/ 算法/ 能够/ 在/ 连续/ 时间/ 内/ 自动/ 地/ 对/ 驾驶员/ 的/ 视线/ 区域/ 进行/ 估计/ ,/ 因此/ ,/ 此/ 算法/ 具有/ 自适应性/ ,/ 可以/ 嵌入/ 到/ 硬件/ 设备/ 中/ ,/ 自动/ 对/ 驾驶员/ 视线/ 校准/ 并/ 对/ 注视/ 区域/ 进行/ 准确/ 估计/ ./ 

