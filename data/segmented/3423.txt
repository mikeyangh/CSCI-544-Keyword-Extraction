Page17/ 轮/ AES/ -/ 128/ 的/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 董晓丽/ 1/ )/ 胡予/ 濮/ 1/ )/ 陈杰/ 1/ )/ ,/ 3/ )/ 韦永壮/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 西安电子科技大学/ 计算机网络/ 与/ 信息安全/ 教育部/ 重点/ 实验室/ 西安/ 710071/ )/ 2/ )/ (/ 桂林/ 电子科技/ 大学/ 信息/ 与/ 通信/ 学院/ 广西/ 桂林/ 541004/ )/ 3/ )/ (/ 中国科学院/ 软件/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100049/ )/ 摘要/ 分组/ 密码/ 是/ 信息安全/ 中/ 实现/ 数据/ 加密/ 、/ 认证/ 和/ 密钥/ 管理/ 的/ 核心/ 密码/ 算法/ ,/ 其/ 安全性/ 分析/ 是/ 密码学/ 的/ 重要/ 课题/ 之一/ ./ 基于/ 差分/ 分析/ 原理/ ,/ 文中/ 提出/ 了/ 分组/ 密码/ 新/ 的/ 分析方法/ :/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ./ 该/ 方法/ 是/ 通过/ 构造/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 排除/ 满足/ 这种/ 关系/ 的/ 密钥/ ,/ 并/ 最终/ 恢复/ 出/ 秘密/ 密钥/ 的/ 一种/ 攻击/ 方法/ ./ 利用/ 密钥/ 编排/ 方案/ ,/ 基于/ 差分表/ 查询/ 技术/ 和/ 数据/ 多次/ 利用/ 技术/ ,/ 把/ 新/ 方法/ 应用/ 于/ AES/ -/ 128/ ./ 研究/ 结果表明/ :/ 攻击/ 7/ 轮/ AES/ -/ 128/ 所/ 需/ 的/ 数据/ 复杂度/ 为/ 2105.18/ 个/ 选择/ 明文/ ,/ 时间/ 复杂度/ 为/ 2115.2/ 次/ 加密/ ,/ 存储/ 复杂度/ 为/ 2106.78/ 个/ AES/ 分组/ ./ 就/ 攻击/ 轮数/ 、/ 数据/ 复杂度/ 和/ 时间/ 复杂度/ 而言/ ,/ 新/ 分析/ 优于/ 已有/ 针对/ AES/ -/ 128/ 的/ 攻击/ ./ 关键词/ 密码/ 分析/ ;/ 分组/ 密码/ ;/ AES/ ;/ 飞来/ 器/ ;/ 时间/ 复杂度/ 1/ 引言/ 现代/ 密码学/ 是/ 解决/ 信息安全/ 问题/ 的/ 有效/ 手段/ ./ 分组/ 密码/ 是/ 现代/ 密码学/ 的/ 一个/ 重要/ 研究/ 方向/ ,/ 属于/ 对称/ 密码/ 体制/ ./ 它/ 可以/ 直接/ 用来/ 加密/ 消息/ ,/ 对/ 消息/ 提供/ 保密性/ ;/ 可以/ 用来/ 构造/ 消息/ 认证码/ (/ MAC/ )/ 和/ Hash/ 函数/ 来/ 保障/ 数据/ 的/ 真实性/ 和/ 完整性/ ./ 分组/ 密码/ 还/ 具有/ 简洁/ 、/ 快速/ 、/ 易于/ 标准化/ 等/ 特点/ ,/ 因此/ 在/ 信息安全/ 领域/ 有着/ 最/ 广泛/ 的/ 应用/ ./ 自/ 2000/ 年/ ,/ NIST/ 宣布/ Rijndael/ [/ 1/ ]/ 是/ 高级/ 加密/ 标准/ (/ AES/ )/ 征集/ 比赛/ 中/ 的/ 获胜者/ ,/ 它/ 已经/ 成为/ 全球/ 最受/ 关注/ 和/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 之一/ ./ 同时/ ,/ 涌现出/ 了/ 一些/ 新/ 的/ 针对/ AES/ 的/ 攻击/ ,/ 包括/ 平方/ 攻击/ [/ 2/ -/ 3/ ]/ 、/ 碰撞/ 攻击/ [/ 4/ ]/ 、/ 不/ 可能/ 差分/ 攻击/ [/ 5/ -/ 9/ ]/ 、/ 飞来/ 器/ 攻击/ [/ 10/ ]/ 、/ 中间/ 相遇/ 攻击/ [/ 11/ ]/ 、/ 相关/ 密钥/ 攻击/ [/ 12/ -/ 13/ ]/ 等/ ./ 单/ 密钥/ 模型/ 下/ ,/ AES/ -/ 128/ 的/ 攻击/ 结果/ 如下/ :/ 1997/ 年/ ,/ AES/ 的/ 设计者/ Daemen/ 等/ 人/ [/ 2/ ]/ 首次/ 提出/ 了/ 6/ 轮/ AES/ -/ 128/ 的/ 平方/ 攻击/ ,/ 需要/ 232/ 个/ 选择/ 明文/ 和/ 272/ 次/ 加密/ ./ 2000/ 年/ ,/ Ferguson/ 等/ 人/ [/ 3/ ]/ 把/ 攻击/ 6/ 轮/ AES/ -/ 128/ 的/ 时间/ 复杂度/ 降为/ 244/ ./ 同时/ ,/ 7/ 轮/ AES/ -/ 128/ 的/ 平方/ 攻击/ 需要/ 2127.977/ 个/ 选择/ 明文/ 和/ 2120/ 次/ 加密/ ./ 同年/ ,/ Gilbert/ 等/ 人/ [/ 4/ ]/ 提出/ 7/ 轮/ AES/ -/ 128/ 的/ 碰撞/ 攻击/ ,/ 需要/ 232/ 个/ 选择/ 明文/ 和/ 2128/ 次/ 加密/ ./ 2000/ 年/ ,/ Biham/ 等/ 人/ [/ 5/ ]/ 首次/ 将/ 不/ 可能/ 差分/ 攻击/ 应用/ 于/ AES/ ,/ 攻击/ 5/ 轮/ AES/ -/ 128/ 需要/ 229.5/ 个/ 选择/ 明文/ 和/ 231/ 次/ 加密/ ./ 2002/ 年/ ,/ Cheon/ 等/ 人/ [/ 6/ ]/ 提出/ 6/ 轮/ AES/ -/ 128/ 的/ 不/ 可能/ 差分/ 攻击/ ,/ 需要/ 291.5/ 个/ 选择/ 明文/ 和/ 2122/ 次/ 加密/ ./ 2004/ 年/ ,/ Biryukov/ 等/ 人/ [/ 10/ ]/ 提出/ 5/ 轮/ AES/ -/ 128/ 和/ 6/ 轮/ AES/ -/ 128/ 的/ 飞来/ 器/ 攻击/ ./ 5/ 轮/ AES/ -/ 128/ 攻击/ 中/ 需要/ 239/ 个/ 选择/ 明文/ 和/ 239/ 次/ 加密/ ,/ 6/ 轮/ AES/ -/ 128/ 攻击/ 中/ 需要/ 271/ 个/ 选择/ 明文/ 和/ 271/ 次/ 加密/ ./ 2007/ 年/ ,/ Zhang/ 等/ 人/ [/ 7/ ]/ 和/ Lu/ [/ 8/ ]/ 分别/ 提出/ 改进/ 的/ 7/ 轮/ AES/ -/ 128/ 的/ 不/ 可能/ 差分/ 攻击/ ,/ 其中/ 文献/ [/ 8/ ]/ 中/ 复杂度/ 较/ 低/ ,/ 需要/ 2112.2/ 个/ 选择/ 明文/ 和/ 2115.6/ 次/ 加密/ ./ 文献/ [/ 9/ ]/ 中/ ,/ Lu/ 同时/ 提出/ 6/ 轮/ AES/ -/ 128/ 的/ 不/ 可能/ 飞来/ 器/ 攻击/ ,/ 需要/ 2112.2/ 个/ 选择/ 明文/ 和/ 2112.3/ 次/ 加密/ ./ 2008/ 年/ ,/ Lu/ 等/ 人/ [/ 9/ ]/ 提出/ 7/ 轮/ AES/ -/ 128/ 的/ 不/ 可能/ 差分/ 攻击/ ,/ 需要/ 2112.2/ 个/ 选择/ 明文/ 和/ 2117.2/ 次/ 存储/ 访问/ ./ 2010/ 年/ ,/ Dunkel/ -/ man/ 等/ 人/ [/ 11/ ]/ 提出/ 7/ 轮/ AES/ -/ 128/ 的/ 中间/ 相遇/ 攻击/ ,/ 依据/ 时空/ 折中/ 需要/ 约/ 2116/ 个/ 选择/ 明文/ 和约/ 2116/ 次/ 加密/ ./ 本文/ 的/ 主要/ 贡献/ :/ 基于/ 差分/ 分析/ 原理/ ,/ 提出/ 了/ 分组/ 密码/ 新/ 的/ 分析方法/ —/ —/ —/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ./ 首先/ 描述/ 了/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ,/ 并/ 给出/ 了/ 详细/ 的/ 理论/ 支持/ ./ 该/ 攻击/ 是/ 通过/ 构造/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 排除/ 满足/ 这种/ 关系/ 的/ 密钥/ ,/ 并/ 最终/ 恢复/ 出/ 秘密/ 密钥/ 的/ 一种/ 攻击/ 方法/ ./ 然后/ ,/ 构造/ 了/ 4/ 轮/ AES/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 利用/ 密钥/ 编排/ 方案/ ,/ 差分表/ 查询/ 技术/ 和/ 数据/ 多次/ 利用/ 技术/ ,/ 针对/ 7/ 轮/ AES/ -/ 128/ 进行/ 新/ 分析/ ./ 所/ 需/ 的/ 数据/ 复杂度/ 为/ 2105.18/ 个/ 选择/ 明文/ ,/ 时间/ 复杂度/ 为/ 2115.2/ 次/ 加密/ ,/ 存储/ 复杂度/ 为/ 2106.78/ 个/ AES/ 分组/ ./ 就/ 攻击/ 轮数/ 、/ 数据/ 复杂度/ 和/ 时间/ 复杂度/ 而言/ ,/ 新/ 分析/ 优于/ 已有/ 针对/ AES/ -/ 128/ 的/ 攻击/ ./ 本文/ 第/ 2/ 节为/ 基础知识/ ,/ 介绍/ AES/ 算法/ 和/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ;/ 第/ 3/ 节/ 详细描述/ 新/ 的/ 密码/ 分析方法/ :/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ;/ 第/ 4/ 节/ 把/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 应用/ 于/ 7/ 轮/ AES/ -/ 128/ ;/ 第/ 5/ 节/ 给出/ 本文/ 的/ 分析/ 结果/ 及/ 与/ 已有/ 结果/ 的/ 比较/ ,/ 并/ 提出/ 下/ 一步/ 工作/ 的/ 方向/ ./ 2/ 基础知识/ 2.1/ AES/ 介绍/ AES/ [/ 1/ ]/ 分组/ 长度/ 是/ 128bit/ ,/ 密钥/ 长度/ 有/ 128bit/ 、/ 192bit/ 和/ 256bit3/ 种/ ,/ 分别/ 用/ AES/ -/ 128/ 、/ AES/ -/ 192/ 和/ AES/ -/ 256/ 表示/ ,/ 且/ 分别/ 迭代/ 10/ 轮/ 、/ 12/ 轮/ 和/ 14/ 轮/ ./ AES/ -/ 128/ 分组/ 表示/ 为/ 字节/ Ai/ 为/ 元素/ 的/ 4/ ×/ 4/ 矩阵/ (/ (/ A0/ ,/ A1/ ,/ A2/ ,/ A3/ )/ T/ ,/ (/ A4/ ,/ A5/ ,/ A6/ ,/ A7/ )/ T/ ,/ (/ A8/ ,/ A9/ ,/ A10/ ,/ A11/ )/ T/ ,/ (/ A12/ ,/ A13/ ,/ A14/ ,/ A15/ )/ T/ )/ ./ AES/ 的/ 每/ 一轮/ 由/ 以下/ 4/ 种/ 变换/ 组成/ :/ 字节/ 代替/ (/ SB/ )/ :/ 每个/ 字节/ 进行/ S/ 盒/ 变换/ ;/ 行/ 移位/ (/ SR/ )/ :/ 每行/ 循环/ 左/ 移位/ (/ 第/ i/ 行/ 循环/ 左移/ i/ 个/ 字节/ ,/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ ;/ 列/ 混淆/ (/ MC/ )/ :/ 在/ GF/ (/ 28/ )/ 上/ 每列/ 左/ 乘/ 矩阵/ ;/ 密钥/ 加/ (/ ARK/ )/ :/ 中间状态/ 异或/ 128bit/ 子/ 密钥/ ./ AES/ 第/ 0/ 轮/ 之前/ 有/ 密钥/ 加法/ 运算/ (/ 这个/ 密钥/ 又/ 称为/ 白化/ 密钥/ )/ ;/ 最后/ 一轮/ 没有/ 列/ 混淆/ 变换/ ./ AES/ 密钥/ 编排/ 算法/ 把/ 秘密/ 密钥/ 扩充/ 成/ 128/ (/ R/ +/ 1/ )/ bit/ 子/ 密钥/ ,/ 其中/ R/ 表示/ 轮数/ ./ AES/ -/ 128/ 密钥/ 方案/ 由/ 128bit/ 密钥/ K/ =/ (/ W0/ ,/ W1/ ,/ W2/ ,/ W3/ )/ 生成/ W4/ ,/ W5/ ,/ …/ ,/ W43/ ,/ 其中/ Wi/ 为/ 32bit/ 字/ ./ 密钥/ 生成/ 如下/ :/ 1/ ./ 用户/ 密钥/ K/ =/ (/ W0/ ,/ W1/ ,/ W2/ ,/ W3/ )/ ./ 2/ ./ Fori/ =/ 4toi/ =/ 433/ ./ K/ -/ 1/ =/ (/ W0/ ,/ W1/ ,/ W2/ ,/ W3/ )/ ,/ Kr/ =/ (/ W4/ (/ r/ +/ 1/ )/ ,/ W4/ (/ r/ +/ 1/ )/ +/ 1/ ,/ W4/ (/ r/ +/ 1/ )/ +/ 2/ ,/ W4/ (/ r/ +/ 1/ )/ +/ 3/ )/ ,/ 0/ / r/ / 9/ ./ 其中/ Kr/ 表示/ r/ 轮子/ 密钥/ ,/ K/ -/ 1/ 表示/ 白化/ 密钥/ ./ Page3RotByte/ (/ ·/ )/ 表示/ 一/ 字节/ 的/ 循环/ ;/ Rcon/ (/ ·/ )/ 表示/ 轮/ 常量/ ./ 本文/ 使用/ 的/ 记号/ :/ P/ 表示/ 明文/ ,/ C/ 表示/ 密文/ ./ XIr/ 表示/ 第/ r/ 轮/ 的/ 输入/ ,/ XSBr/ 、/ XSRr/ 、/ XMCr/ 、/ XOr/ 分别/ 表示/ 第/ r/ 轮/ SB/ 、/ SR/ 、/ MC/ 、/ ARK/ 的/ 中间/ 值/ ,/ 显然/ XOr/ -/ 1/ =/ XIr/ ./ 同/ 一轮/ MC/ 和/ ARK/ 交换/ ,/ 子/ 密钥/ 要/ 用/ 等价/ 子/ 密钥/ 珦/ Ki/ ,/ 且/ 满足/ 珦/ Ki/ =/ MC/ -/ 1/ (/ Ki/ )/ ./ Xr/ ,/ i/ 表示/ Xr/ 的/ 第/ i/ 字节/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ …/ ,/ 15/ )/ ./ Xr/ ,/ Col/ (/ l/ )/ (/ l/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 表示/ Xr/ 的/ 第/ l/ 列/ ./ Xr/ ,/ SR/ (/ Col/ (/ l/ )/ )/ (/ l/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 表示/ Xr/ 中/ 相应/ 于/ 第/ l/ 列/ SR/ 变换/ 后/ 位置/ 的/ 4/ 个/ 字节/ ;/ 同理/ Xr/ ,/ SR/ -/ 1/ (/ Col/ (/ l/ )/ )/ (/ l/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ 表示/ Xr/ 中/ 相应/ 于/ 第/ l/ 列/ SR/ -/ 1/ 变换/ 后/ 位置/ 的/ 4/ 个/ 字节/ ./ Pr/ (/ ·/ )/ 表示/ 相应/ 事件/ 的/ 概率/ ./ Y/ ~/ Poi/ (/ λ/ )/ 表示/ 随机变量/ Y/ 服从/ 参数/ 为/ λ/ 的/ 泊松/ 分布/ ./ 2.2/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 分组/ 密码/ E/ :/ {/ 0/ ,/ 1/ }/ k/ ×/ {/ 0/ ,/ 1/ }/ n/ →/ {/ 0/ ,/ 1/ }/ n/ 表示/ 为/ 两个/ 算法/ 级联/ 的/ 形式/ E1/ / E0/ ,/ 即/ 算法/ E/ 在/ 密钥/ K/ 下/ 加密/ 明文/ P/ 也/ 可以/ 表示/ 为/ EK/ (/ P/ )/ =/ E1K/ / E0K/ (/ P/ )/ ./ 选择/ N/ 元组/ (/ X0/ ,/ X1/ ,/ …/ ,/ XN/ -/ 1/ )/ ,/ 其中/ X2i/ +/ 1/ =/ X2i/ / α/ i/ (/ 0/ / i/ / N/ // 2/ -/ 1/ )/ ,/ E/ (/ X/ (/ 2j/ +/ 2/ )/ modN/ )/ =/ E/ (/ X2j/ +/ 1/ )/ / γ/ j/ (/ 0/ / j/ / N/ // 2/ -/ 1/ )/ ./ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 包括/ :/ (/ 1/ )/ 算法/ E0/ 中/ Pr/ (/ α/ i/ →/ β/ i/ )/ =/ 1/ (/ 0/ / i/ / N/ // 2/ -/ 1/ )/ ;/ (/ 2/ )/ 算法/ (/ E1/ )/ -/ 1/ 中/ Pr/ (/ δ/ j/ →/ γ/ j/ )/ =/ 1/ (/ 0/ / j/ / N/ // 2/ -/ 1/ )/ ;/ (/ 3/ )/ (/ / N/ // 2/ -/ 1/ (/ 0/ / i/ / N/ // 2/ -/ 1/ ,/ 0/ / j/ / N/ // 2/ -/ 1/ )/ 是/ n/ -/ bit/ 块/ ./ 由于/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 的/ 结构/ 对称/ ,/ 且/ N/ 为/ 偶数/ (/ N/ / 2/ )/ ./ 因此/ 本文/ 称之为/ 对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 相应/ 的/ 攻击/ 为/ 对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ./ N/ =/ 4/ 情况/ 如图/ 1/ 所示/ ./ 3/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 基于/ 差分/ 分析/ 技术/ 和/ 不/ 可能/ 飞来/ 器/ 攻击/ ,/ 本/ 节/ 提出/ 新/ 的/ 密码/ 分析方法/ —/ —/ —/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ./ 3.1/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 定义/ 1/ (/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ )/ ./ 分组/ 密码/ 算法/ E/ =/ E1/ / E0/ ,/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 包括/ :/ (/ 1/ )/ 算法/ E0/ 中/ ,/ Pr/ (/ α/ i/ →/ β/ i/ )/ =/ 1/ (/ 0/ / i/ / N/ -/ 2/ )/ ;/ (/ 2/ )/ 算法/ (/ E1/ )/ -/ 1/ 中/ ,/ Pr/ (/ δ/ →/ γ/ )/ =/ 1/ ;/ (/ 3/ )/ β/ 0/ / β/ 1/ / …/ / β/ N/ -/ 2/ / γ/ ≠/ 0/ ,/ 其中/ α/ 0/ ,/ β/ 0/ ,/ α/ 1/ ,/ β/ 1/ ,/ …/ ,/ α/ N/ -/ 2/ ,/ β/ N/ -/ 2/ ,/ δ/ ,/ γ/ 是/ n/ -/ bit/ 块/ ./ 可以/ 看出/ ,/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 结构/ 非对称/ ,/ 且/ 满足/ N/ / 2/ ./ N/ =/ 4/ 情况/ 如图/ 2/ 所示/ ./ 下面/ 的/ 定理/ 对/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 提供/ 了/ 理论/ 基础/ ./ 定理/ 1/ ./ 分组/ 密码/ 算法/ E/ =/ E1/ / E0/ ,/ 密钥/ 为/ K/ ,/ Xi/ (/ 0/ / i/ / N/ -/ 2/ )/ 是/ n/ -/ bit/ 块/ ,/ Xi/ / Xi/ +/ 1/ =/ α/ i/ (/ 0/ / i/ / N/ -/ 2/ )/ ,/ E0K/ (/ X0/ )/ / E0K/ (/ XN/ -/ 1/ )/ =/ γ/ ./ 假定/ 算法/ E0/ 满足/ P/ (/ α/ i/ →/ β/ i/ )/ =/ 1/ (/ 0/ / i/ / N/ -/ 2/ )/ ,/ 算法/ (/ E1/ )/ -/ 1/ 满足/ Pr/ (/ δ/ →/ γ/ )/ =/ 1/ ,/ 且/ β/ 0/ / β/ 1/ / …/ / β/ N/ -/ 2/ / γ/ ≠/ 0/ ./ 下列/ 等式/ 不能/ 成立/ :/ 证明/ ./ 假定/ / X1/ ,/ Xn/ ,/ K/ 使/ 等式/ (/ 1/ )/ 成立/ ./ 算法/ E0/ 满足/ Pr/ (/ α/ i/ →/ β/ i/ )/ =/ 1/ (/ 0/ / i/ / N/ -/ 2/ )/ ,/ 其中/ Xi/ / Xi/ +/ 1/ =/ α/ i/ ,/ E0K/ (/ Xi/ )/ / E0K/ (/ Xi/ +/ 1/ )/ =/ β/ i/ (/ 0/ / i/ / N/ -/ 2/ )/ ,/ 下列/ 等式/ 成立/ 的/ 概率/ 为/ 1/ :/ E0K/ (/ X0/ )/ / E0K/ (/ XN/ -/ 1/ )/ =/ (/ E0K/ (/ X0/ )/ / E0K/ (/ X1/ )/ )/ / …/ / (/ E0K/ (/ Xi/ )/ / E0K/ (/ Xi/ +/ 1/ )/ )/ / …/ / (/ E0K/ (/ XN/ -/ 2/ )/ / E0K/ (/ XN/ -/ 1/ )/ )/ =/ (/ (/ E1K/ )/ -/ 1/ (/ EK/ (/ X0/ )/ )/ / (/ E1K/ )/ -/ 1/ (/ EK/ (/ X1/ )/ )/ )/ / …/ / (/ (/ E1K/ )/ -/ 1/ (/ EK/ (/ Xi/ )/ )/ / (/ E1K/ )/ -/ 1/ (/ EK/ (/ Xi/ +/ 1/ )/ )/ )/ / …/ / (/ (/ E1K/ )/ -/ 1/ (/ EK/ (/ XN/ -/ 2/ )/ )/ / (/ E1K/ )/ -/ 1/ (/ EK/ (/ XN/ -/ 1/ )/ )/ )/ =/ β/ 0/ / β/ 1/ / …/ / β/ i/ / …/ / β/ N/ -/ 2/ ./ 由于/ 算法/ (/ E1K/ )/ -/ 1/ 满足/ Pr/ (/ δ/ →/ γ/ )/ =/ 1/ ,/ 即当/ Page4EK/ (/ X0/ )/ / EK/ (/ XN/ -/ 1/ )/ =/ δ/ ,/ 下列/ 等式/ 成立/ 的/ 概率/ 为/ 1/ :/ E0K/ (/ X0/ )/ / E0K/ (/ XN/ -/ 1/ )/ =/ (/ E1K/ )/ -/ 1/ (/ EK/ (/ X0/ )/ )/ / (/ E1K/ )/ -/ 1/ (/ EK/ (/ XN/ -/ 1/ )/ )/ =/ γ/ ./ 因此/ ,/ 与/ 条件/ β/ 0/ / β/ 1/ / …/ / β/ N/ -/ 2/ / γ/ ≠/ 0/ 相/ 矛盾/ ,/ 定理/ 成立/ ./ 3.2/ 密钥/ 恢复/ 分组/ 密码/ 算法/ E/ 表示/ 为/ 4/ 个/ 算法/ 级联/ 形式/ E/ =/ Eaft/ / E1/ / E0/ / Ebef/ ,/ 其中/ E1/ / E0/ 表示/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ β/ 0/ / β/ 1/ / …/ / β/ N/ -/ 2/ / γ/ ≠/ 0/ ,/ Ebef/ 表示/ E0/ 之前/ 加密/ 轮/ ,/ Eaft/ 表示/ E1/ 之后/ 加密/ 轮/ ./ 假定/ Kbef/ 、/ Kaft/ 分别/ 是/ 算法/ Ebef/ 、/ Eaft/ 的/ 子/ 密钥/ 猜测/ ,/ 则/ 攻击者/ 检验/ N/ 元明/ // 密文/ 组/ (/ (/ P0/ ,/ C0/ )/ ,/ (/ P1/ ,/ C1/ )/ ,/ …/ ,/ (/ PN/ -/ 1/ ,/ CN/ -/ 1/ )/ )/ 是否/ 满足/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 的/ N/ 个/ 条件/ :/ Ebef/ α/ i/ ,/ (/ EaftKbef/ (/ Pi/ )/ / EbefRound0/ :/ →/ / / / ARK4/ ./ 24/ 轮/ AES/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器来器/ 区分/ 器/ ./ 图/ 3/ 形象/ 描述/ 了/ 此/ 区分/ 器/ 的/ 差分/ ./ 烌/ bi0000000/ →/ / / MC0000/ 烎/ 0000Round1/ :/ →/ / / SBai/ ,/ bi/ ,/ ci/ ,/ di/ ,/ ei/ ,/ fi/ (/ 0/ / i/ / N/ -/ 2/ )/ 表示/ 任意/ 非/ 0/ 字节/ ./ (/ a/ )/ 算法/ E0/ 中/ α/ i/ →/ β/ i/ (/ 0/ / i/ / N/ -/ 2/ )/ 烌/ 烄/ MC/ ←/ / / / -/ 1/ 烆/ 烎/ ?/ ?/ ?/ 0/ ?/ ?/ ?/ 烌/ 烄/ ←/ / / / ARK/ 烆/ 烎/ ?/ ?/ (/ b/ )/ 算法/ E1/ 中/ δ/ →/ γ/ 图/ 34/ 轮/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ 的/ 差分/ 定理/ 2.4/ 轮/ AES/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ E1/ / E0/ 如下/ :/ (/ (/ a0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ;/ …/ (/ ai/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ;/ …/ …/ ;/ (/ aN/ -/ 2/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ )/ →/ |/ (/ XO3/ ,/ SR/ (/ Col/ (/ l/ )/ )/ )/ 0/ / (/ XO3/ ,/ SR/ (/ Col/ (/ l/ )/ )/ )/ N/ -/ 2/ =/ 0/ ,/ l/ ∈/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ }/ ,/ 其中/ ai/ (/ 0/ / i/ / N/ -/ 2/ )/ 表示/ 任意/ 非/ 0/ 字节/ ,/ ?/ 表示/ 任意/ 值/ ./ 证明/ ./ E0/ 中/ α/ i/ →/ β/ i/ (/ 0/ / i/ / N/ -/ 2/ )/ 为/ (/ (/ ai/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ )/ →/ (/ (/ 02/ ·/ ci/ ,/ 01/ ·/ ci/ ,/ 01/ ·/ ci/ ,/ 03/ ·/ ci/ )/ T/ ,/ (/ 01/ ·/ fi/ ,/ 01/ ·/ fi/ ,/ 03/ ·/ fi/ ,/ 02/ ·/ fi/ )/ T/ ,/ (/ 01/ ·/ ei/ ,/ 03/ ·/ ei/ ,/ 02/ ·/ ei/ ,/ 02/ ·/ ei/ )/ T/ ,/ (/ 03/ ·/ di/ ,/ 假如/ 存在/ N/ 元明/ // 密文/ 组/ 满足/ 上面/ 的/ 等式/ ,/ 则/ 子/ 密钥/ 猜测/ (/ Kbef/ ,/ Kaft/ )/ 是/ 不/ 正确/ 的/ ./ 因此/ 有/ 足够/ 多/ 的/ 明/ // 密文/ 组/ ,/ 通过/ 丢弃/ 所有/ 错误/ 的/ 子/ 密钥/ 猜测/ ,/ 攻击者/ 能够/ 寻找/ 到/ 算法/ Ebef/ ,/ Eaft/ 中/ 正确/ 的/ 子/ 密钥/ ./ 47/ 轮/ AES/ -/ 128/ 的/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 4.1/ AES/ -/ 128/ 部分/ 密钥/ 编排/ 结果/ 下面/ 定理/ 构造/ 了/ 4/ 轮/ AES/ 的/ 非对称/ 不/ 可能/ 飞/ 02/ ·/ bi000/ 烄/ 01/ ·/ bi00001/ ·/ bi000/ 烆/ 03/ ·/ bi02/ ·/ di/ ,/ 01/ ·/ di/ ,/ 01/ ·/ di/ )/ T/ )/ ,/ 如图/ 3/ (/ a/ )/ 所示/ ./ 则/ / N/ -/ 2/ / N/ -/ 2i/ =/ 0/ (/ β/ i/ )/ 为/ (/ (/ / N/ -/ 2i/ =/ 1ai/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ )/ →/ (/ (/ 02/ ·/ / N/ -/ 2/ (/ 01/ ·/ / N/ -/ 2/ (/ 01/ ·/ / N/ -/ 2/ (/ 03/ ·/ / N/ -/ 2/ 可以/ 看出/ ,/ / N/ -/ 2i/ =/ 1fi/ ,/ 01/ ·/ / N/ -/ 2i/ =/ 1ei/ ,/ 03/ ·/ / N/ -/ 2i/ =/ 1di/ ,/ 02/ ·/ / N/ -/ 2Page5/ 均/ 不/ 为/ 0/ ./ 所以/ / n/ -/ 1/ 不为/ 0/ ;/ (/ 2/ )/ 其中/ 1/ 列为/ 0/ ,/ 其余/ 字节/ 全不为/ 0/ ;/ (/ 3/ )/ 其中/ 2/ 列为/ 0/ ,/ 其余/ 字节/ 不为/ 0/ ;/ (/ 4/ )/ 其中/ 3/ 列为/ 0/ ,/ 其余/ 字节/ 不为/ 0/ ;/ (/ 5/ )/ 16/ 个/ 字节/ 都/ 为/ 0/ ./ E1/ 中/ δ/ →/ γ/ 为/ (/ (/ XO3/ )/ 0/ / (/ XO3/ )/ N/ -/ 2/ )/ →/ (/ (/ XSB2/ )/ 0/ / (/ XSB2/ )/ N/ -/ 2/ )/ ,/ 满足/ (/ (/ XO3/ ,/ SR/ (/ Col/ (/ l/ )/ )/ )/ 0/ / (/ XO3/ ,/ SR/ (/ Col/ (/ l/ )/ )/ )/ N/ -/ 2/ =/ 0/ )/ →/ (/ (/ XSB2/ ,/ SR/ -/ 1/ (/ Col/ (/ l/ )/ )/ )/ 0/ / (/ XSB2/ ,/ SR/ -/ 1/ (/ Col/ (/ l/ )/ )/ )/ N/ -/ 2/ =/ 0/ )/ ,/ l/ ∈/ 4.37/ 轮/ AES/ -/ 128/ 的/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 对称/ 不/ 可能/ 飞来/ 器/ 攻击/ ./ 烄/ qi000ui000vi000/ 烆/ 烎/ 000wi/ (/ a/ )/ 算法/ Ebef/ →/ / / SRRound4/ :/ 烌/ z000000z/ ←/ / / / ARK0000/ 烎/ 0000/ 烌/ z00z00zz/ ←/ / / / ARK0zz0/ 烎/ 00/ (/ b/ )/ 算法/ Eaft/ 图/ 47/ 轮/ AES/ -/ 128/ 的/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 4.3/ ./ 1/ 攻击/ 过程/ 交换/ ./ 由于/ 攻击/ 需要/ ,/ 第/ 4/ 轮/ 和/ 第/ 5/ 轮/ 的/ MC/ 和/ ARK/ 预计/ 算/ 阶段/ ./ 1/ ./ XMC0/ ,/ Col/ (/ 0/ )/ 的/ 差/ 分为/ 下列/ 4/ 种/ 情形/ 之一/ :/ (/ a/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ a/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ a/ ,/ 0/ )/ 或/ (/ 0/ ,/ 0/ ,/ 0/ ,/ a/ )/ ,/ 其中/ a/ 表示/ 任意/ 非/ 0/ 字节/ (/ 下同/ )/ ./ 共有/ 232/ ×/ 4/ ×/ (/ 28/ -/ 1/ )/ ≈/ 242/ 数据/ 对/ ./ 对/ 每/ 一个/ 数据/ 对/ 计算/ XI0/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ ,/ 将/ 这些/ 4/ 字节/ 的/ 数据/ 对以/ 它们/ 在/ 这/ 4/ 个/ 字节/ 的/ 差/ 分为/ 索引/ ,/ 存储/ 于/ 一张/ Hash/ 表/ Hash/ -/ 1/ ,/ 一个/ 索引/ 值/ 平均/ 对应/ 210/ 数据/ 对/ ./ 2/ ./ XO5/ ,/ Col/ (/ 0/ )/ 的/ 差分/ 如为/ (/ a/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ 有/ 232/ ×/ (/ 28/ -/ 1/ )/ ≈/ 240/ 数据/ 对/ ./ 对/ 每/ 一个/ 数据/ 对/ 计算/ XSR6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ,/ 将/ 这些/ 4/ 字节/ 的/ 数据/ 对以/ 它们/ 在/ 这/ 4/ 个/ 字节/ 差/ 分为/ 索引/ ,/ 存储/ 于/ 一张/ Hash/ 表/ Hash0/ ,/ 一个/ 索引/ 值/ 平均/ 对应/ 28/ 数据/ 对/ ./ 下面/ 计算/ 存储/ 按照/ 同样/ 的/ 方法/ ./ XO5/ ,/ Col/ (/ 0/ )/ 的/ 差分/ 如为/ (/ 0/ ,/ a/ ,/ 0/ ,/ 0/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSR6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ./ Hash/ 表/ Hash1/ 存储/ 数据/ 对/ ./ XO5/ ,/ Col/ (/ 0/ )/ 的/ 差分/ 如为/ (/ 0/ ,/ 0/ ,/ a/ ,/ 0/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSR6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ./ Hash/ 表/ Hash2/ 存储/ 数据/ 对/ ./ XO5/ ,/ Col/ (/ 0/ )/ 的/ 差分/ 如为/ (/ 0/ ,/ 0/ ,/ 0/ ,/ a/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSR3/ ./ XO5/ ,/ Col/ (/ 3/ )/ 的/ 差分/ 如为/ (/ a/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSR6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ ./ Hash/ 表/ Hash12/ 存储/ 数据/ 对/ ./ XO5/ ,/ Col/ (/ 3/ )/ 的/ 差分/ 如为/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ }/ ,/ 如图/ 3/ (/ b/ )/ 所示/ ./ γ/ 中/ 每/ 一列/ 至少/ 有/ 一个/ 字节/ 为/ 0/ ./ 又/ 因为/ 选择/ 明文/ 攻击/ 中/ 选择/ 的/ N/ 元组/ 中/ 不会/ 有/ 相同/ 的/ 明文/ ,/ 所以/ γ/ ≠/ 0/ ./ 因此/ / N/ -/ 2/ 取/ N/ =/ 3/ ,/ 图/ 4/ 形象/ 给出/ 了/ 7/ 轮/ AES/ -/ 128/ 的/ 非/ 烄/ 烆/ 烄/ 烆/ 烄/ 烆/ (/ 0/ ,/ a/ ,/ 0/ ,/ 0/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSRHash13/ 存储/ 数据/ 对/ ./ XO5/ ,/ Col/ (/ 3/ )/ 的/ 差分/ 如为/ (/ 0/ ,/ 0/ ,/ a/ ,/ 0/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSRXO5/ ,/ Col/ (/ 3/ )/ 的/ 差分/ 如为/ (/ 0/ ,/ 0/ ,/ 0/ ,/ a/ )/ ,/ 有/ 约/ 240/ 数据/ 对/ ,/ 计算/ XSR6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ ./ Hash/ 表/ Hash15/ 存储/ 数据/ 对/ ./ 在线/ 阶段/ ./ 1/ ./ 定义/ 一种/ 结构/ Struci/ ./ 232/ 个/ 明文/ Pi/ ,/ j/ 在/ 字节/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ 取/ 所有/ 可能/ 的/ 值/ ,/ 其余/ 字节/ 固定/ ./ Struci/ 产生/ C2232/ ≈/ 263/ 个/ 明文/ 对/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ ,/ 每个/ 明文/ 对/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 形成/ P1232/ -/ 2/ ≈/ 232/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ,/ 满足/ 任意/ 两/ 两/ 三元组/ 的/ 无序/ 差/ 分组/ (/ Pi/ ,/ j0/ / Pi/ ,/ j1/ ,/ Pi/ ,/ j1/ / Pi/ ,/ j2/ )/ 均/ 不/ 重复/ ./ 选择/ 273.18/ 个/ 结构/ Struci/ (/ i/ =/ 0/ ,/ 1/ ,/ …/ ,/ 273.18/ -/ 1/ )/ ,/ 生成/ 273.18/ ×/ 263/ ×/ 232/ =/ 2168.18/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ./ 在/ 选择/ 明文/ 攻击/ 中/ ,/ 对于/ 273.18/ ×/ 232/ =/ 2105.18/ 个/ 明文/ ,/ 获得/ 相应/ 密文/ Ci/ ,/ j/ ./ 选择/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 满足/ (/ XO6/ ,/ SR/ (/ Col/ (/ 1/ ,/ 2/ )/ )/ )/ i/ ,/ j0/ / (/ XO6/ ,/ SR/ (/ Col/ (/ 1/ ,/ 2/ )/ )/ )/ i/ ,/ j2/ =/ 0/ ,/ 其中/ 0/ / j0/ ≠/ j2/ / 232/ -/ 1/ ./ 剩余/ 2168.18/ ×/ 2/ -/ 64/ =/ 2104.18/ 个/ 三元组/ ./ 2/ ./ 初始化/ 232/ 个空/ 列表/ ,/ 每个/ 对应/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ 的/ 猜测/ 值/ ./ 考虑/ 剩余/ 明文/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ,/ 计算/ Pi/ ,/ j0/ / Pi/ ,/ j1/ 和/ Pi/ ,/ j1/ / Pi/ ,/ j2/ 在/ 字节/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ 值/ ,/ 用/ Δ/ P0/ 、/ Δ/ P1/ 表示/ ./ 分别/ 访问/ Hash/ -/ 1/ 中/ 分别/ 以/ Δ/ P0/ 、/ Δ/ P1/ 索引/ 的/ 库/ ./ 对于/ Page6/ Δ/ P0/ 索引/ 库中/ 的/ 每/ 一个/ 数据/ 对/ (/ x0/ ,/ y0/ )/ ,/ Δ/ P1/ 索引/ 库中/ 的/ 每/ 一个/ 数据/ 对/ (/ x1/ ,/ y1/ )/ ,/ 如果/ 存在/ Pi/ ,/ j0/ / x0/ =/ Pi/ ,/ j1/ / x1/ ,/ 则/ 把/ 明文/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 添加/ 到/ 相应/ 密钥/ 列表/ Pi/ ,/ j0/ / x0/ 值中/ ./ Pr/ (/ Pi/ ,/ j0/ / x0/ =/ Pi/ ,/ j1/ / x1/ )/ =/ 210/ ×/ 2/ -/ 32/ =/ 2/ -/ 22/ ,/ 因此/ 2104.18/ ×/ 210/ ×/ 2/ -/ 22/ =/ 292.18/ 值/ 分布/ 在/ 232/ 个/ 密钥/ 上/ ,/ 即/ 每个/ 子/ 密钥/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ 剩余/ 260.18/ 个/ 三元组/ ./ 3/ ./ 对/ 每个/ 猜测/ 值/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ ,/ 剩余/ 的/ 260.18/ 个/ 三元组/ 中/ 选取/ 257.18/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ,/ 满足/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 不/ 重复/ ./ 由于/ 对于/ 每个/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ ,/ 步/ 2/ 中/ 任意/ 一个/ 对/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 相应/ 的/ 232/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 中/ ,/ 剩余/ 概率/ 为/ 232/ ×/ (/ 210/ ×/ 2/ -/ 32/ )/ 2/ =/ 2/ -/ 12/ ./ 由泊松/ 分布/ Y/ ~/ Poi/ (/ λ/ =/ 2/ -/ 12/ )/ ,/ Pr/ (/ Y/ / 9/ )/ ≈/ 2/ -/ 126.5/ ,/ 剩余/ 9/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 对应/ 相同/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 的/ 概率/ 为/ 2/ -/ 126.5/ ./ 因为/ 共有/ 2105/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ,/ 所以/ 剩余/ 三元组/ 中/ 存在/ 一个/ 对/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 对应/ 9/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 的/ 概率/ 非常低/ ./ 因此/ 假定/ 剩余/ 三元组/ 中/ 每个/ 对/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 对应/ 8/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ ,/ 则/ 剩余/ 260.18/ 个/ 三元组/ 中/ 至少/ 有/ 260.18/ ×/ 2/ -/ 3/ =/ 257.18/ 个/ 三元组/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j1/ ,/ Pi/ ,/ j2/ )/ 满足/ (/ Pi/ ,/ j0/ ,/ Pi/ ,/ j2/ )/ 不/ 重复/ ./ 步/ 4/ ~/ 6/ 为/ m/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ 的/ 循环/ 执行/ ./ 4/ ./ 初始化/ 232/ 空/ 列表/ ,/ 每/ 一个/ 相应/ 于/ K6/ ,/ SR/ (/ Col/ (/ 0/ )/ 的/ 猜测/ 值/ ./ 考虑/ 剩余/ 三元组/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j1/ ,/ Ci/ ,/ j2/ )/ ,/ 且/ 计算/ (/ Ci/ ,/ j0/ / Ci/ ,/ j2/ )/ 在/ 字节/ SR/ (/ Col/ (/ 0/ )/ )/ 值/ ,/ 用/ Δ/ P2/ 表示/ ./ 访问/ Hashm/ 中/ Δ/ P2/ 为/ 索引/ 的/ 库/ ,/ 对于/ 该库/ 中/ 的/ 每/ 一个/ 数据/ 对/ (/ x2/ ,/ y2/ )/ ,/ 计算/ Ci/ ,/ j0/ / x2/ ,/ 则/ 把/ 三元组/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j1/ ,/ Ci/ ,/ j2/ )/ 添加/ 到/ 相应/ 密钥/ 列表/ Ci/ ,/ j0/ / x/ 值中/ ./ 257.18/ ×/ 28/ 值/ 分布/ 在/ 232/ 个/ 密钥/ 上/ ,/ 因此/ 每个/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ 子/ 密钥/ ,/ 剩余/ 257.18/ ×/ 28/ ×/ 2/ -/ 32/ =/ 233.18/ 个/ 三元组/ ./ 5/ ./ 初始化/ 232/ 空/ 列表/ ,/ 每/ 一个/ 相应/ 于/ K6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ 的/ 猜测/ 值/ ./ 考虑/ 剩余/ 明文/ 三元组/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j1/ ,/ Ci/ ,/ j2/ )/ ,/ 且/ 计算/ (/ Ci/ ,/ j0/ / Ci/ ,/ j2/ )/ 在/ 字节/ SR/ (/ Col/ (/ 3/ )/ )/ 值/ ,/ 用/ Δ/ P3/ 表示/ ./ 访问/ Hash12/ +/ (/ m/ +/ 1/ )/ mod4/ 中/ Δ/ P3/ 为/ 索引/ 的/ 库/ ,/ 对于/ 该库/ 中/ 的/ 每/ 一个/ 数据/ 对/ (/ x3/ ,/ y3/ )/ ,/ 计算/ Ci/ ,/ j0/ / x3/ ,/ 则/ 把/ 三元组/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j1/ ,/ Ci/ ,/ j2/ )/ 添加/ 到/ 相应/ 密钥/ 列表/ Ci/ ,/ j0/ / x3/ 值中/ ./ 233.18/ ×/ 28/ 值/ 分布/ 在/ 232/ 个/ 密钥/ 上/ ,/ 因此/ 每个/ K6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ 子/ 密钥/ ,/ 剩余/ 233.18/ ×/ 28/ ×/ 2/ -/ 32/ =/ 29.18/ 个/ 三元组/ ./ 6/ ./ 猜/ 2/ 个/ 字节/ 的/ 子/ 密钥/ (/ 珦/ K5/ ,/ m/ ,/ 珦/ K5/ ,/ 12/ +/ (/ m/ +/ 1/ )/ mod4/ )/ ./ 部分/ 解密/ 剩余/ 三元组/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j1/ ,/ Ci/ ,/ j2/ )/ 中/ 的/ (/ Ci/ ,/ j0/ ,/ Ci/ ,/ j2/ )/ ,/ 检验/ 是否/ (/ XO4/ ,/ Col/ (/ m/ )/ )/ i/ ,/ j0/ / (/ XO4/ ,/ Col/ (/ m/ )/ )/ i/ ,/ j2/ 只有/ 1/ 个/ 字节/ 为/ 0/ ./ 假如/ 存在/ 三元组/ 满足/ 这个/ 条件/ ,/ 则/ 丢弃/ 密钥/ 值/ (/ K6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ,/ K6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ ,/ 珦/ K5/ ,/ m/ ,/ 珦/ K5/ ,/ 12/ +/ (/ m/ +/ 1/ )/ mod4/ ,/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ )/ ./ 7/ ./ 对/ 每个/ 可能/ 的/ 子/ 密钥/ 值/ (/ K6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ,/ K6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ ,/ 珦/ K5/ ,/ Col/ (/ 0/ )/ ,/ 珦/ K5/ ,/ Col/ (/ 3/ )/ ,/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ )/ ,/ 结合/ AES/ -/ 128/ 密钥/ 方案/ ,/ 穷举/ 确定/ 剩余/ 24bit/ 密钥/ ./ 4.3/ ./ 2/ 复杂度/ 分析/ 预计/ 算/ 阶段/ ./ 时间/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 242/ ×/ 1/ // 7/ ×/ 1/ // 4/ ≈/ 239.2/ 次/ 7/ 轮/ AES/ -/ 128/ 加密/ ,/ 存储/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 242/ ×/ 1/ // 4/ ≈/ 242.6/ 个/ AES/ 在线/ 阶段/ ./ 需要/ 2105.18/ 个/ 选择/ 明文/ ./ 1/ ./ 存储/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 2104.18/ =/ 2106.78/ 个/ AES/ 分组/ ./ 2/ ./ 时间/ 复杂度/ 为/ 2/ ×/ 2104.18/ ×/ 210/ =/ 2115.18/ 次/ 存储/ 访问/ ,/ 约/ 相当于/ [/ 12/ ]/ 2108.18/ 次/ 7/ 轮/ AES/ -/ 128/ 加密/ ./ 3/ ./ 存储/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 260.18/ ×/ 232/ =/ 294.78/ 个/ AES/ 分组/ ./ 分组/ ./ 4/ ./ 时间/ 复杂度/ 为/ 4/ ×/ 232/ ×/ 257.18/ ×/ 28/ =/ 299.18/ 次/ 存储/ 访问/ ./ 存储/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 257.18/ ×/ 28/ =/ 267.78/ 个/ AES/ 分组/ ./ 5/ ./ 时间/ 复杂度/ 为/ 4/ ×/ 264/ ×/ 233.18/ ×/ 28/ =/ 2107.18/ 次/ 存储/ 访问/ ./ 存储/ 复杂度/ 为/ 3/ ×/ 2/ ×/ 233.18/ ×/ 28/ =/ 243.78/ 个/ AES/ 分组/ ./ 6/ ./ 时间/ 复杂度/ 为/ 4/ ×/ {/ 2/ ×/ 2112/ ×/ [/ 1/ +/ (/ 1/ -/ 2/ -/ 6/ )/ +/ …/ +/ (/ 1/ -/ 2/ -/ 6/ )/ 29.18/ ]/ ×/ 2/ // 16/ ×/ 1/ // 7/ }/ ≈/ 2115.2/ 次/ 7/ 轮/ AES/ -/ 128/ 加密/ ./ 对于/ 每个/ m/ ,/ 满足条件/ 的/ 三元组/ 概率/ 为/ 4/ ×/ 2/ -/ 8/ =/ 2/ -/ 6/ ./ 对于/ 每个/ 猜测/ 的/ 96bit/ 密钥/ 值/ (/ K6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ,/ K6/ ,/ SR/ (/ Col/ (/ 3/ )/ )/ ,/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ )/ ,/ 预计/ 剩余/ 约/ 216/ ×/ (/ 1/ -/ 2/ -/ 6/ )/ 29.18/ ≈/ 22.82/ 个子/ 密钥/ (/ 珦/ K5/ ,/ m/ 、/ 珦/ K5/ ,/ 12/ +/ (/ m/ +/ 1/ )/ mod4/ )/ ./ 考虑/ 4/ 个/ 迭代/ m/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ ,/ 对于/ 每个/ 猜测/ 的/ (/ K6/ ,/ SR/ (/ Col/ (/ 0/ )/ )/ ,/ K6/ 、/ SR/ (/ Col/ (/ 3/ )/ )/ 、/ K/ -/ 1/ ,/ SR/ -/ 1/ (/ Col/ (/ 0/ )/ )/ )/ ,/ 剩余/ 约/ 22.82/ ×/ 4/ =/ 211.28/ 个子/ 密钥/ (/ 珦/ K5/ ,/ Col/ (/ 0/ )/ 、/ 珦/ K5/ ,/ Col/ (/ 3/ )/ )/ ./ 由/ AES/ -/ 128/ 密钥/ 方案/ ,/ 得到/ 296/ ×/ 211.28/ ×/ 2/ -/ 24/ =/ 283.28/ 个/ 可能/ 的/ 子/ 密钥/ ./ 7/ ./ 时间/ 复杂度/ 为/ 283.28/ ×/ 224/ =/ 2107.28/ 次/ 7/ 轮/ AES/ -/ 128/ 因此/ ,/ 攻击/ 所/ 需要/ 的/ 数据/ 复杂度/ 为/ 2105.18/ 个/ 选择/ 明文/ ,/ 时间/ 复杂度/ 为/ 2115.2/ 次/ 7/ 轮/ AES/ -/ 128/ 加密/ ,/ 由步/ 6/ 决定/ ;/ 存储/ 复杂度/ 为/ 2106.78/ 个/ AES/ 分组/ ,/ 由步/ 1/ 决定/ ./ 5/ 结论/ 加密/ ./ 分组/ 密码/ 是/ 信息安全/ 的/ 核心/ 密码/ 算法/ ./ 基于/ 差分/ 分析/ 原理/ ,/ 本文/ 提出/ 了/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 这/ 一新/ 的/ 分组/ 密码/ 分析方法/ ./ 该/ 方法/ 是/ 通过/ 构造/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 排除/ 满足/ 这种/ 关系/ 的/ 密钥/ ,/ 并/ 最终/ 恢复/ 出/ 秘密/ 密钥/ 的/ 一种/ 攻击/ 方法/ ./ 然后/ ,/ 构造/ 了/ 4/ 轮/ AES/ 非对称/ 不/ 可能/ 飞来/ 器/ 区分/ 器/ ,/ 利用/ 密钥/ 编排/ 方案/ 、/ 差分表/ 查询/ 技术/ 和/ 数据/ 多次/ 利用/ 技术/ ,/ 针对/ AES/ -/ 128/ 进行/ 了/ 新/ 分析/ ./ 攻击/ 7/ 轮/ AES/ -/ 128/ 所/ 需/ 的/ 数据/ 复杂度/ 为/ 2105.18/ 个/ 选择/ 明文/ ,/ 时间/ 复杂度/ 为/ 2115.2/ 次/ 加密/ ,/ 存储/ 复杂度/ 为/ 2106.78/ 个/ AES/ 分组/ ./ 与/ 已有/ 的/ 结果/ 比较/ 见表/ 1/ ,/ 可以/ 看出/ :/ 新/ 分析/ 的/ 攻击/ 轮数/ 达到/ 7/ 轮/ ./ 在/ 7/ 轮/ 攻击/ 中/ ,/ 时间/ 复杂度/ 低于/ 已有/ 攻击/ ;/ 数据/ 复杂度/ 也/ 低于/ 除/ 文献/ [/ 4/ ]/ 以外/ 的/ 攻击/ ,/ 而/ 文献/ [/ 4/ ]/ 为/ 巨型/ 攻击/ ,/ 因为/ 它/ 需要/ 的/ 时间/ 复杂度/ 为/ 2128/ 次/ 加密/ ,/ 等于/ 密钥/ 穷举/ 搜索/ ./ 因此/ 针对/ AES/ -/ 128/ 的/ 攻击/ ,/ 本文/ 提出/ 的/ 密码/ 分析方法/ 更为/ 新型/ 有效/ ./ Page7/ 攻击/ 类型/ 轮数/ 数据/ 平方/ 攻击/ 平方/ 攻击/ 平方/ 攻击/ 碰撞/ 攻击/ 不/ 可能/ 差分/ 攻击/ 6291.52122/ —/ [/ 6/ ]/ 不/ 可能/ 差分/ 攻击/ 72115.521192105/ [/ 7/ ]/ 不/ 可能/ 差分/ 攻击/ 72112.22115/ ./ 62105/ [/ 8/ ]/ 不/ 可能/ 差分/ 攻击/ 72112.22117/ ./ 2MA289/ ./ 2/ [/ 9/ ]/ 中间/ 相遇/ 攻击/ 7211621162116/ [/ 11/ ]/ 飞来/ 器/ 攻击/ 6271271233/ [/ 10/ ]/ 不/ 可能/ 飞来/ 器/ 攻击/ 62112.22112/ ./ 3249/ [/ 8/ ]/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 注/ :/ CP/ 为/ 选择/ 明文/ ;/ MA/ 为/ 存储/ 访问/ ./ 时间/ 复杂度/ 单位/ :/ 加密/ 次数/ ;/ 存储/ 复杂度/ 单位/ :/ AES/ 分组/ ./ 本文/ 提出/ 的/ 非对称/ 不/ 可能/ 飞来/ 器/ 攻击/ 可以/ 应用/ 于/ 其它/ 分组/ 密码/ 算法/ 分析/ 中/ ,/ 研究/ 中/ 可以/ 进一步/ 关注/ ./ 

