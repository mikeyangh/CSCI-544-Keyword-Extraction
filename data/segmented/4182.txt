Page1/ 基于/ 兴趣/ 点/ 分布/ 的/ 外包/ 空间数据/ 隐私/ 保护/ 方法/ 田丰桂/ 小林/ 张学军/ 杨建伟/ 杨攀余思/ (/ 西安交通大学/ 电子/ 与/ 信息/ 工程学院/ 西安/ 710049/ )/ (/ 西安交通大学/ 陕西省/ 计算机网络/ 重点/ 实验室/ 西安/ 710049/ )/ 摘要/ 随着/ 云/ 服务/ 与/ 位置/ 感知/ 设备/ 的/ 普及/ ,/ 大量/ 与/ 位置/ 相关/ 的/ 信息/ 需要/ 外包/ 给/ 服务提供商/ ,/ 由此/ 引发/ 的/ 空间数据/ 隐私/ 问题/ 得到/ 了/ 学术界/ 的/ 广泛/ 关注/ ./ Hilbert/ 曲线/ 作为/ 一种/ 空间/ 转换/ 的/ 方法/ ,/ 被/ 广泛应用/ 于/ 空间数据/ 的/ 隐私/ 保护/ 中/ ,/ 但/ 标准/ Hilbert/ 曲线/ 未/ 考虑/ 兴趣/ 点/ 的/ 分布/ 特征/ ,/ 可能/ 需要/ 多次/ 调整/ 曲线/ 参数/ ,/ 且/ 无法/ 支持/ 数据/ 拥有者/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ./ 针对/ 上述/ 问题/ ,/ 提出/ 一种/ 可以/ 根据/ 兴趣/ 点/ 分布/ 而/ 自/ 适应/ 变化/ 的/ Hilbert/ 曲线/ (/ AHC/ )/ ,/ 该/ 曲线/ 根据/ 设定/ 的/ 存储容量/ 将/ 空间/ 划分/ 为/ 原子/ 区域/ ,/ 使用/ Hilbert/ 曲线/ 的/ 分形/ 规则/ 确定/ 各/ 原子/ 区域/ 的/ 顺序/ ,/ 并/ 由此/ 生成/ 密钥/ 树/ ,/ 数据/ 拥有者/ 可以/ 将/ 密钥/ 树/ 的/ 一部分/ 共享/ 给/ 授权/ 使用者/ ,/ 从而/ 实现/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ;/ 设计/ 了/ 基于/ AHC/ 的/ 空间/ 查询处理/ 方案/ ,/ 支持/ 兴趣/ 点/ 的/ 索引/ 值/ 计算/ 、/ 范围/ 查询/ 与/ KNN/ 查询处理/ ;/ 定义/ 了/ 空洞/ 指数/ 以/ 量化/ 外/ 包/ 数据/ 的/ 隐私/ 信息/ 泄露/ 风险/ ./ 在/ 真实/ 数据/ 集/ 与/ 模拟/ 数据/ 集上/ 的/ 实验/ 表明/ ,/ 与/ 标准/ Hilbert/ 曲线/ 相比/ ,/ 该文/ 提出/ 的/ AHC/ 在/ 进行/ 空间/ 转换/ 方面/ 具有/ 更/ 高/ 的/ 安全性/ 与/ 更优/ 的/ 查询/ 效率/ ./ 关键词/ 数据/ 外/ 包/ ;/ 空间/ 查询处理/ ;/ 位置/ 隐私/ ;/ 空间/ 转换/ ;/ 隐私/ 保护/ 1/ 引言/ 随着/ 基于/ 位置/ 的/ 服务/ [/ 1/ ]/ 与/ 位置/ 感知/ 设备/ 日益/ 普及/ [/ 2/ ]/ ,/ 与/ 位置/ 相关/ 的/ 信息/ 爆炸式/ 增长/ ,/ 由此/ 产生/ 的/ 大量/ 空间数据/ 超出/ 了/ 小型企业/ 和/ 个人/ 的/ 处理/ 能力/ ./ 云/ 服务/ 提供/ 弹性/ 的/ 资源分配/ ,/ 有效/ 降低/ 了/ 数据/ 拥有者/ (/ DO/ )/ 维护/ 数据/ 的/ 开销/ ,/ 因此/ 数据/ 外/ 包/ 成为/ 一种/ 流行/ 的/ 服务/ 模式/ 并/ 获得/ 了/ 学术界/ 的/ 广泛/ 关注/ [/ 3/ ]/ ./ 然而/ ,/ 数据/ 外包/ 给/ 云/ 存储/ 服务提供商/ (/ SP/ )/ ,/ 用户/ 无法/ 确切/ 知道/ 数据/ 被/ 存储/ 在/ 什么/ 地方/ ,/ 自己/ 失去/ 了/ 对/ 数据/ 存储/ 与/ 访问/ 的/ 直接/ 控制权/ ./ 因此/ ,/ 保证/ 空间数据/ 隐私/ 是/ 空间数据/ 外包/ 与/ 基于/ 位置/ 的/ 服务/ 进一步/ 发展/ 面临/ 的/ 一大/ 挑战/ [/ 4/ ]/ ./ 在/ 空间数据/ 外包/ 的/ 处理过程/ 中/ ,/ 涉及/ 大量/ 的/ 与/ 位置/ 相关/ 的/ 操作/ ,/ 例如/ 对/ 指定/ 范围/ 的/ 查询/ 、/ 对/ 指定/ 位置/ 的/ KNN/ 查询/ 等/ [/ 5/ ]/ ./ 由于/ 位置/ 信息/ 是/ 用户/ 的/ 私密/ 信息/ ,/ 将/ 其/ 暴露/ 给/ SP/ 会/ 带来/ 隐私/ 泄露/ 的/ 威胁/ [/ 6/ ]/ ,/ 例如/ 恶意/ SP/ 可能/ 会/ 将/ 具有/ 商业价值/ 的/ 信息/ 出售/ 给/ DO/ 的/ 竞争对手/ [/ 5/ ]/ ,/ 可以/ 根据/ 用户/ 的/ 检索/ 位置/ 分析/ 推测/ 用户/ 的/ 健康状况/ 信息/ [/ 7/ ]/ ./ 为/ 保护/ 用户/ 空间数据/ 外包/ 的/ 安全/ ,/ 一种/ 简单/ 的/ 解决方案/ 是/ 用户/ 先/ 将/ 数据/ 在/ 本地/ 加密/ ,/ 然后/ 再/ 将/ 密文/ 数据/ 外包/ 给/ SP/ ./ 然而/ 数据/ 在/ 加密/ 后/ ,/ 传统/ 的/ 明文/ 检索/ 技术/ 就/ 失效/ 了/ ./ 而/ 使用/ 密文/ 计算技术/ [/ 8/ -/ 9/ ]/ 则/ 在/ 处理/ 此类/ 检索/ 时/ 存在/ 限制/ ,/ 以/ KNN/ 检索/ 为例/ ,/ 为了/ 获得/ 正确/ 的/ 检索/ 结果/ ,/ 需要/ SP/ 计算/ 并/ 发送/ 所有/ 兴趣/ 点/ 与/ 检索/ 点/ 的/ 密文/ 距离/ ,/ 在/ 目前/ 数据量/ 爆炸/ 的/ 情况/ 下/ ,/ 该/ 方案/ 并/ 不适/ 用于/ 此类/ 应用/ 场景/ ./ 基于/ 隐私/ 信息检索/ (/ PIR/ )/ [/ 10/ ]/ 的/ 解决方案/ 通过/ 确保/ 用户/ 的/ 检索/ 信息/ 不/ 暴露/ 给/ 非/ 可信/ SP/ ,/ 从而/ 达到/ 很强/ 的/ 隐私/ 保护/ 级别/ ,/ 但/ 该/ 方案/ 与/ 密文/ 计算技术/ 一样/ ,/ 需要/ 很/ 高/ 的/ 计算/ 与/ 通信/ 开销/ ,/ 因此/ 也/ 不/ 适于/ 此类/ 应用/ ./ 在/ 空间数据/ 外包/ 的/ 服务/ 模式/ 中/ ,/ 需要/ 在/ 保证/ 外/ 包/ 空间数据/ 隐私/ 的/ 前提/ 下/ ,/ 使得/ 数据/ 拥有者/ 和/ 授权/ 用户/ 可以/ 对/ 空间/ 密文/ 数据/ 进行/ 高效/ 检索/ ,/ 为/ 达到/ 此/ 目的/ ,/ 有/ 研究者/ 将/ Hilbert/ 曲线/ 应用/ 于/ 空间数据/ 的/ 转换/ 中/ [/ 11/ -/ 15/ ]/ ,/ 保护/ 用户/ 外/ 包/ 空间数据/ 的/ 隐私/ ,/ 使得/ 密文/ 数据/ 的/ 高效/ 检索/ 成为/ 可能/ ./ 但/ 采用/ 标准/ Hilbert/ 曲线/ 对/ 兴趣/ 点/ 进行/ 转换/ ,/ 没有/ 考虑/ 到/ 兴趣/ 点/ 的/ 分布/ 特征/ ,/ 为了/ 获得/ 需要/ 的/ 转换/ 效果/ ,/ 需要/ 多次/ 调整/ 曲线/ 参数/ ,/ 且/ Hilbert/ 曲线/ 对/ 空间/ 区域/ 采用/ 相同/ 的/ 划分/ 粒度/ ,/ DO/ 在/ 将/ 曲线/ 参数/ 即/ 转换/ 密钥/ 共享/ 给/ 授权/ 用户/ 时/ ,/ 就/ 给予/ 了/ 该/ 用户/ 全部/ 区域/ 的/ 访问/ 权限/ ,/ 无法/ 实现/ 对/ 空间/ 区域/ 的/ 分/ 级别/ 访问控制/ ./ 本文/ 借鉴/ 标准/ Hilbert/ 曲线/ 对/ 空间/ 划分/ 并/ 进行/ 转换/ 的/ 思想/ ,/ 提出/ 了/ 一种/ 新/ 的/ 空间数据/ 转换方法/ ,/ 并/ 对/ 该/ 方法/ 的/ 安全性/ 与/ 效率/ 进行/ 了/ 定量分析/ ./ 本文/ 的/ 主要/ 工作/ 与/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 了/ 一种/ 根据/ 空间/ 区域/ 内/ 兴趣/ 点/ 分布/ 特征/ 而/ 变化/ 的/ 自/ 适应/ Hilbert/ 曲线/ (/ AdaptiveHilbertCurve/ ,/ AHC/ )/ ,/ 支持/ 数据/ 拥有者/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ./ (/ 2/ )/ 设计/ 了/ 基于/ AHC/ 的/ 空间/ 查询处理/ 方案/ ,/ 支持/ 兴趣/ 点/ 的/ 索引/ 值/ 计算/ 、/ 范围/ 查询/ 与/ KNN/ 查询处理/ ./ (/ 3/ )/ 定义/ 了/ 空洞/ 指数/ β/ ,/ 用于/ 量化/ 空间/ 填充/ 曲线/ 构建/ 兴趣/ 点/ 索引/ 所/ 引发/ 的/ 隐私/ 信息/ 泄露/ 风险/ ./ (/ 4/ )/ 在/ 真实/ 数据/ 集/ 与/ 模拟/ 数据/ 集上/ 验证/ 了/ 本文/ 所提/ 方法/ 的/ 安全性/ 与/ 效率/ ./ 本文/ 第/ 2/ 节/ 介绍/ 国内外/ 相关/ 工作/ 的/ 研究进展/ ;/ 第/ 3/ 节对/ 空间/ 隐私/ 数据/ 外/ 包/ 以及/ 检索/ 进行/ 形式化/ 定义/ ;/ 第/ 4/ 节/ 论述/ AHC/ 的/ 生成/ 过程/ 与/ 密钥/ 树/ 生成/ 方法/ ;/ 第/ 5/ 节/ 给出/ 基于/ AHC/ 的/ 空间/ 查询处理/ 方法/ ;/ 第/ 6/ 节/ 通过/ 实验/ 对/ AHC/ 的/ 安全性/ 与/ 效率/ 进行/ 验证/ ;/ 第/ 7/ 节对/ 全文/ 进行/ 总结/ ,/ 并/ 对/ 下/ 一步/ 工作/ 进行/ 展望/ ./ 2/ 相关/ 工作/ Hacig/ ü/ m/ ü/ s/ 等/ 人/ [/ 16/ ]/ 于/ 2002/ 年/ 提出/ 了/ 将/ 数据/ 外/ Page3/ 包给/ 服务提供商/ 的/ 应用/ 模型/ ,/ 并/ 指出/ 数据/ 隐私/ 是/ 一个/ 至关重要/ 的/ 问题/ ./ 接下来/ ,/ Hacig/ ü/ m/ ü/ s/ 等/ 人/ [/ 17/ ]/ 又/ 提出/ 了/ 保护/ 外/ 包/ 数据/ 隐私/ 的/ 解决方案/ ,/ 使用/ 加密/ 后/ 的/ 数据/ 与/ 附加/ 的/ 分组/ 信息/ 来/ 构建/ 索引/ ,/ 从而/ 支持/ 密文/ 数据/ 的/ 检索/ ./ 之后/ ,/ Agrawal/ 等/ 人/ [/ 18/ ]/ 针对/ 一维/ 数值数据/ ,/ 提出/ 了/ 一种/ 保序/ 加密/ 方案/ ,/ 提高/ 了/ 服务端/ 执行/ 查询/ 的/ 效率/ ./ Huang/ 等/ 人/ [/ 19/ ]/ 提出/ 了/ 一种/ 支持/ 密文/ 字符串/ 模糊/ 检索/ 的/ 外包/ 数据/ 隐私/ 保护/ 方法/ ./ 以上/ 这些/ 方案/ 均/ 是/ 针对/ 字符串/ 或/ 一维/ 数值/ 型/ 数据/ ,/ 不能/ 直接/ 应用/ 于/ 空间数据/ 的/ 隐私/ 保护/ ./ Wong/ 等/ 人/ [/ 20/ ]/ 研究/ 了/ 在/ 服务提供者/ 不可/ 信/ 情况/ 下/ ,/ 对/ 密文/ 元组/ 进行/ K/ 近邻/ 计算/ 的/ 问题/ ,/ 提出/ 了/ 一种/ 支持/ 服务提供者/ 计算/ 两个/ 加密/ 数据/ 点/ 相对/ 距离/ 的/ 方法/ ,/ 由于/ 引入/ 了/ 虚拟/ 维度/ ,/ 无法/ 高效/ 的/ 对/ 加密/ 数据/ 点/ 建立/ 索引/ ,/ 因此/ ,/ 在/ 处理/ 查询/ 请求/ 时/ ,/ 服务提供者/ 需要/ 遍历/ 所有/ 密文/ 数据/ 点/ ,/ 导致/ 查询/ 效率/ 较/ 低/ ./ 针对/ 空间/ 隐私/ 数据/ 外/ 包后/ 可/ 检索/ 的/ 问题/ ,/ 有/ 研究者/ 提出/ 使用/ 空间/ 填充/ 曲线/ 来/ 对/ 兴趣/ 点/ 进行/ 转换/ ,/ 以/ 支持/ 在/ 转换/ 空间/ 中/ 进行/ 范围/ 与/ KNN/ 检索/ ,/ 在/ 实际/ 应用/ 中/ ,/ 多/ 采用/ 标准/ Hilbert/ 曲线/ ./ Ni/ 等/ 人/ [/ 11/ ]/ 通过/ Hilbert/ 曲线/ 转换方法/ ,/ 减少/ 了/ 由/ 用户/ 参数设置/ 所/ 引入/ 的/ 额外/ 工作量/ ./ 同时/ ,/ 由于/ Hilbert/ 曲线/ 的/ 聚类/ 特性/ ,/ 降低/ 了/ 区域/ 检索/ 的/ 时间/ 与/ 通信/ 开销/ ./ Khoshgozaran/ 等/ 人/ [/ 12/ ]/ 利用/ Hilbert/ 曲线/ 将/ 数据/ 点/ 与/ 查询/ 请求/ 映射/ 到/ Hilbert/ 转换/ 空间/ ,/ 解决/ 了/ 空间数据/ 密文/ 可/ 检索/ 的/ 问题/ ,/ 并/ 提出/ 了/ 双/ Hilbert/ 曲线/ 技术/ ,/ 提高/ 了/ 检索/ 的/ 准确率/ 与/ 效率/ ./ Ku/ 等/ 人/ [/ 13/ ]/ 为/ 对/ 检索/ 结果/ 进行/ 完整性/ 验证/ ,/ 基于/ Hilbert/ 曲线/ 对/ 原始/ 空间/ 进行/ 转换/ ,/ 对/ 数据/ 点/ 进行/ 对称/ 加密/ ,/ 并用/ Hilbert/ 值/ 构建/ 索引/ ,/ 通过/ 使用/ 不同/ 的/ 空间/ 转换/ 密钥/ ,/ 分别/ 对/ 原始/ 空间/ 数据库/ 和/ 其中/ 抽取/ 的/ 一个/ 副本/ 进行/ 加密/ ,/ 得到/ 的/ 结果/ 合并/ 后/ 存储/ 在/ 服务提供商/ 处/ ,/ 由此/ 构成/ 进行/ 查询/ 完整性/ 验证/ 的/ 依据/ ./ 对/ 现有/ 研究/ 分析/ 可知/ ,/ 标准/ Hilbert/ 曲线/ 对/ 空间/ 区域/ 进行/ 转换/ 时/ ,/ 并/ 不/ 考虑/ 兴趣/ 点/ 的/ 分布/ 特点/ ,/ 而是/ 根据/ 指定/ 的/ 转换/ 密钥/ 对/ 空间/ 进行/ 划分/ ,/ 并/ 计算/ 各/ 原子/ 区域/ 的/ Hilbert/ 值/ ,/ 由此/ 对/ 分布/ 于/ 各/ 原子/ 区域/ 的/ 兴趣/ 点/ 构建/ 索引/ ,/ 为/ 保证/ 转换/ 的/ 安全性/ 与/ 检索/ 的/ 效率/ ,/ 需要/ 选择/ 足够/ 大/ 的/ 曲线/ 阶数/ ,/ 使得/ 基本/ 不/ 存在/ Hilbert/ 值/ 相同/ 的/ 兴趣/ 点/ ./ 文献/ [/ 12/ ]/ 指出/ 恶意/ SP/ 可以/ 在/ 不/ 知道/ Hilbert/ 曲线/ 参数/ 的/ 情况/ 下/ ,/ 通过/ 对/ 具有/ 相同/ 或/ 相近/ Hilbert/ 值/ 的/ 兴趣/ 点/ 数量/ 进行/ 分析/ ,/ 从而/ 发现/ 在/ 转换/ 空间/ 中/ 的/ 兴趣/ 点/ 密集/ 区域/ ,/ 由此/ 增大/ 了/ 用户/ 隐私/ 数据/ 泄露/ 的/ 风险/ ./ 3/ 问题/ 描述/ 定义/ ./ 3.1/ 定义/ 本节/ 对/ 空间/ 隐私/ 数据/ 外/ 包/ 以及/ 查询/ 进行/ 形式化/ 为/ 便于/ 描述/ ,/ 对/ 相关/ 术语/ 与/ 符号/ 进行/ 形式化/ 定义/ ./ 定义/ 1/ ./ 兴趣/ 点/ ./ 外包/ 的/ 隐私/ 数据项/ ,/ 记/ 作/ φ/ (/ x/ ,/ y/ ,/ ξ/ )/ ,/ 其中/ x/ ,/ y/ 表示/ 数据项/ 的/ 位置/ 坐标/ ,/ ξ/ 表示/ 附属/ 的/ 其它/ 属性/ 信息/ ./ 定义/ 2/ ./ 区域/ ./ 平面/ 中/ 的/ 一个/ 矩形/ 范围/ ,/ 记作/ R/ =/ [/ xl/ ,/ xh/ ]/ ×/ [/ yl/ ,/ yh/ ]/ ,/ 其中/ xl/ ,/ xh/ 分别/ 表示/ R/ 在/ x/ 方向/ 的/ 上/ 、/ 下限/ ,/ yl/ ,/ yh/ 则/ 表示/ R/ 在/ y/ 方向/ 的/ 上/ 、/ 下限/ ./ 定义/ 3/ ./ 定义/ 空间/ ./ 兴趣/ 点/ φ/ 所属/ 的/ 空间/ 区域/ ,/ 记/ 作/ Ω/ ,/ 为/ 便于/ 讨论/ ,/ 本文/ 设定/ Ω/ 为/ 区域/ [/ 0/ ,/ 1/ ]/ 2/ ./ 定义/ 4/ ./ 原子/ 区域/ ./ 不可/ 被/ 继续/ 划分/ 的/ 区域/ ./ 定义/ 5/ ./ 存储容量/ ./ 对/ 空间/ 进行/ 划分/ 时/ ,/ 原子/ 区域/ 所/ 能/ 容纳/ 的/ 兴趣/ 点/ 数量/ ,/ 记作/ C/ ./ 定义/ 6/ ./ Hilbert/ 值/ ./ 为/ 每个/ 原子/ 区域/ 所/ 分配/ 的/ 一个/ 唯一/ 的/ 整数/ 编号/ ,/ 记作/ VH/ ./ 定义/ 7/ ./ 转换/ 密钥/ ./ AHC/ 在/ 区域/ R/ 中/ 的/ 曲线/ 参数/ ,/ 记作/ STK/ (/ R/ ,/ S0/ ,/ N/ ,/ θ/ ,/ Γ/ )/ ,/ 其中/ ,/ S0/ 为/ 起始/ 点/ 、/ N/ 为/ 曲线/ 阶数/ 、/ θ/ 为/ 曲线/ 方向/ 、/ Γ/ 为/ 缩放/ 因子/ ./ 定义/ 8/ ./ 密钥/ 树/ ./ 由/ Ω/ 中/ 各/ 区域/ Ri/ 的/ 转换/ 密钥/ 组织/ 成/ 的/ 四分/ 树结构/ ,/ 记/ 作/ Ψ/ ,/ 其中/ ∪/ Ri/ =/ Ω/ ,/ 且/ ∩/ Ri/ =/ / ./ 定义/ 9/ ./ 整数/ 编码/ ./ 对于/ 任意/ 的/ 位置/ 坐标/ (/ x/ ,/ y/ )/ ,/ 其/ 对应/ 的/ x/ ,/ y/ 方向/ 的/ 序号/ ,/ 记/ 作/ (/ xc/ ,/ yc/ )/ ./ 定义/ 10/ ./ 查询/ 段/ ./ 若/ 授权/ 用户/ 提交/ 给/ SP/ 的/ 查询/ 兴趣/ 点/ 或/ 区域/ 的/ Hilbert/ 值/ 是/ 连续/ 的/ ,/ 则/ 将/ 其/ 定义/ 为/ 一个/ 查询/ 段/ ,/ 记作/ QR/ (/ hb/ ,/ he/ )/ ,/ 其中/ hb/ ,/ he/ 分别/ 表示/ 开始/ 、/ 结束/ VH/ ./ 3.2/ 面向/ 空间数据/ 外包/ 的/ 隐私/ 保护/ 框架图/ 1/ 描述/ 了/ 面向/ 空间数据/ 外包/ 的/ 隐私/ 保护/ 框架/ ,/ 包含/ 数据/ 拥有者/ (/ DO/ )/ 、/ 授权/ 数据/ 使用者/ (/ ADU/ )/ 以及/ 云/ 存储/ 服务提供者/ (/ SP/ )/ 3/ 个/ 角色/ ./ 在/ 数据/ 预处理/ 阶段/ ,/ DO/ 选定/ 转换/ 参数/ ,/ 根据/ 原始/ 兴趣/ 点/ 集合/ Φ/ 中/ 各/ 兴趣/ 点/ 的/ 位置/ 构建/ 索引/ 项/ / (/ 步/ 1.1/ )/ ,/ 并/ 生成/ 密钥/ 树/ Ψ/ ./ 与此同时/ ,/ 使用/ 传统/ 加密/ 方案/ 对/ 原始/ 兴趣/ 点/ 集合/ 中/ 的/ 元素/ 进行/ 加密/ ,/ 获得/ 密文/ 兴趣/ 点/ 集合/ Φ/ (/ 步/ 1.2/ )/ ./ 与/ 文献/ [/ 13/ ]/ 存储/ 密文/ 空间/ 对象/ 的/ 结构/ 相似/ ,/ 本文/ 使用/ 键/ -/ 值/ 对/ 的/ 形式/ 将/ 索引/ 项/ / 与/ 密文/ 兴趣/ 点/ 集合/ Φ/ 联系/ 起来/ ,/ 生成/ 外/ 包/ 数据/ / (/ Φ/ )/ ,/ 然后/ 发送给/ SP/ (/ 步/ 1.3/ )/ ./ DO/ 将/ 授权/ 区域/ 的/ 转换/ 密钥/ {/ STKi/ }/ / Ψ/ 与/ 解密/ 密钥/ KEYD/ 通过/ 安全/ 信道/ 发送给/ ADU/ (/ 步/ 1.4/ )/ ./ Page4/ 图/ 1/ 面向/ 空间数据/ 外包/ 的/ 隐私/ 保护/ 框架/ 在/ 查询/ 阶段/ ,/ ADU/ 首先/ 使用/ 获得/ 的/ 转换/ 密钥/ {/ STKi/ }/ 对/ 原始/ 查询/ 请求/ Q/ 进行/ 转换/ ,/ 获得/ 一系列/ 查询/ 段/ {/ QRi/ }/ (/ 步/ 2.1/ )/ ,/ 然后/ 将/ 查询/ 段/ 提交/ 给/ SP/ (/ 步/ 2.2/ )/ ./ SP/ 根据/ 接收/ 到/ 的/ 查询/ 段/ 在外/ 包/ 数据/ / (/ Φ/ )/ 中/ 检索/ ,/ 将/ 索引/ 值/ 包含/ 于/ {/ QRi/ }/ 的/ 密文/ 兴趣/ 点/ 集合/ {/ φ/ }/ 返回/ 给/ ADU/ (/ 步/ 2.3/ )/ ./ ADU/ 使用/ 获得/ 的/ 解密/ 密钥/ KEYD/ 对/ {/ φ/ }/ 进行/ 解密/ ,/ 获得/ 明文/ 查询/ 结果/ (/ 步/ 2.4/ )/ ./ 本文/ 主要/ 关注/ 于/ 保护/ 兴趣/ 点/ 的/ 位置/ 隐私/ ,/ 对于/ 兴趣/ 点/ 包含/ 信息/ 的/ 隐私/ 保护/ 可以/ 采用/ 传统/ 加密/ 方案/ ,/ 本文/ 不/ 做/ 讨论/ ./ 3.3/ 空间/ 转换/ 技术/ 为了/ 保证/ 空间数据/ 的/ 隐私/ ,/ 需要/ 对/ 兴趣/ 点/ 的/ 原始/ 位置/ 进行/ 转换/ ,/ 理想/ 的/ 空间数据/ 转换方法/ 应该/ 具备/ 单向/ 函数/ 的/ 特性/ ,/ 同时/ ,/ 为了/ 保证/ 对/ 密文/ 空间数据/ 查询/ 的/ 有效性/ ,/ 兴趣/ 点/ 在/ 转换/ 后/ 还/ 应/ 保持/ 其/ 在/ 原始/ 空间/ 中/ 的/ 邻近/ 性/ ./ 空间/ 填充/ 曲线/ [/ 21/ ]/ 具备/ 上述/ 特性/ ,/ 可以/ 将/ 其/ 应用/ 于/ 空间数据/ 的/ 转换/ 中/ ./ Z/ 曲线/ [/ 22/ ]/ 、/ Gray/ 码/ 曲线/ [/ 23/ ]/ 以及/ Hilbert/ 曲线/ [/ 14/ ]/ 是/ 典型/ 的/ 空间/ 填充/ 曲线/ ,/ 可以/ 作为/ 对/ 区域/ 编码/ 的/ 依据/ ./ 其中/ ,/ Hilbert/ 曲线/ 由于/ 在/ 聚类/ 和/ 距离/ 保持/ 方面/ 的/ 特性/ [/ 14/ ,/ 22/ -/ 25/ ]/ 被/ 广泛应用/ ./ 本文/ 借鉴/ Hilbert/ 曲线/ 对/ 空间/ 划分/ 并/ 进行/ 转换/ 的/ 思想/ ,/ 提出/ 了/ 一种/ 根据/ 兴趣/ 点/ 分布/ 特征/ 而/ 变化/ 的/ 自/ 适应/ Hilbert/ 曲线/ (/ AdaptiveHilbertCurve/ ,/ AHC/ )/ ./ AHC/ 根据/ 数据/ 拥有者/ 设定/ 的/ 存储容量/ 对/ 空间/ 进行/ 划分/ ,/ 使得/ 生成/ 的/ 空间/ 填充/ 曲线/ 可以/ 根据/ 兴趣/ 点/ 的/ 分布/ 密度/ 来/ 自动/ 调整/ 曲线/ 的/ 转换/ 密钥/ 中/ 各/ 参数/ 的/ 取值/ ,/ 可以/ 有效/ 避免/ 索引/ 的/ 空值/ 段/ 问题/ ,/ 并/ 支持/ 数据/ 拥有者/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ,/ 而/ 这/ 是/ 标准/ Hilbert/ 曲线/ 所/ 无法/ 完成/ 的/ ./ 4/ 自/ 适应/ Hilbert/ 曲线/ 使用/ AHC/ 对/ 数据/ 拥有者/ 的/ 兴趣/ 点/ 集合/ 进行/ 处理/ 包括/ 3/ 个/ 过程/ :/ (/ 1/ )/ 根据/ 指定/ 的/ 存储容量/ 对/ 定义/ 空间/ 进行/ 四分/ 树/ [/ 26/ ]/ 划分/ ,/ 生成/ 原子/ 区域/ 的/ 四分/ 树/ 表示/ ;/ (/ 2/ )/ 根据/ 指定/ 的/ 曲线/ 方向/ 、/ 起始/ 点/ 与/ 缩放/ 因子/ ,/ 按照/ Hilbert/ 曲线/ 的/ 分形/ 规则/ 对/ 四分/ 树中/ 各/ 原子/ 区域/ 依次/ 访问/ ,/ 计算/ 各/ 原子/ 区域/ 的/ Hilbert/ 值/ ,/ 并/ 构建/ 兴趣/ 点/ 索引/ ;/ (/ 3/ )/ 对/ 已/ 编码/ 的/ 四分/ 树/ 进行/ 处理/ ,/ 生成/ 密钥/ 树/ ./ 4.1/ 定义/ 空间/ 的/ 四分/ 树/ 划分/ 在/ AHC/ 中/ ,/ 对/ 定义/ 空间/ 进行/ 四分/ 树/ 划分/ ,/ 划分/ 的/ 粒度/ 则/ 由/ 设定/ 的/ 存储容量/ C/ 来/ 决定/ ,/ 即/ 在/ 当前/ 的/ 划分/ 下/ ,/ 若/ 区域/ R/ 中/ 兴趣/ 点/ 数量/ 超过/ C/ ,/ 则/ 需要/ 对/ R/ 进一步/ 划分/ ,/ 直至/ 所有/ 原子/ 区域/ 中/ 兴趣/ 点/ 数量/ 均/ 不/ 超过/ C/ ./ AHC/ 根据/ 兴趣/ 点/ 集合/ 与/ 指定/ 的/ 存储容量/ 生成/ 对/ 定义/ 空间/ 的/ 四分/ 树/ 划分/ ,/ 其/ 生成/ 方法/ 如/ 算法/ 1/ 所示/ ./ 为/ 便于/ 描述/ ,/ 对/ 算法/ 中/ 涉及/ 的/ 符号/ 定义/ 如表/ 1/ ./ 算法/ 1/ ./ 空间/ 四分/ 树/ 生成/ 算法/ ./ QuadTreeGenerate/ (/ Φ/ ,/ C/ )/ 输入/ :/ 兴趣/ 点/ 集合/ Φ/ ,/ 存储容量/ C/ 输出/ :/ 四分/ 树根/ 节点/ Q1/ ./ createarootnodeQ/ ;/ 2/ ./ FOReach/ φ/ ∈/ Φ/ 3/ ./ QuadTreeInsert/ (/ φ/ ,/ Q/ ,/ C/ )/ ;/ Page54/ ./ ENDFOR5/ ./ RETURNQ/ ;/ FunctionQuadTreeInsert/ (/ φ/ ,/ Z/ ,/ C/ )/ 输入/ :/ 兴趣/ 点/ φ/ ,/ 四分/ 树/ 节点/ Z/ ,/ 存储容量/ C1/ ./ IFZC/ =/ / 2/ ./ IF/ |/ ZP/ |/ </ C3/ ./ ZP/ ←/ ZP/ ∪/ φ/ ;/ 4/ ./ ELSE5/ ./ ZC/ ←/ {/ Z/ (/ 0/ )/ ,/ Z/ (/ 1/ )/ ,/ Z/ (/ 2/ )/ ,/ Z/ (/ 3/ )/ }/ ;/ 6/ ./ FOReachE/ ∈/ ZP7/ ./ IFEL/ ∈/ Z/ (/ i/ )/ R8/ ./ Z/ (/ i/ )/ P/ ←/ Z/ (/ i/ )/ P/ ∪/ E/ ;/ 9/ ./ ENDIF10/ ./ ENDFOR11/ ./ getD/ ∈/ ZCwhichmeets/ φ/ L/ ∈/ DR/ ;/ 12/ ./ QuadTreeInsert/ (/ φ/ ,/ D/ ,/ C/ )/ ;/ 13/ ./ ENDIF14/ ./ ELSE15/ ./ getD/ ∈/ ZCwhichmeets/ φ/ L/ ∈/ DR/ ;/ 16/ ./ QuadTreeInsert/ (/ φ/ ,/ D/ ,/ C/ )/ ;/ 17/ ./ ENDIF/ 符号/ ZR/ 四分/ 树/ 节点/ Z/ 对应/ 的/ 区域/ ZP/ 四分/ 树/ 节点/ Z/ 存储/ 的/ 兴趣/ 点/ 集合/ ZO/ 四分/ 树/ 节点/ Z/ 对应/ 区域/ 的/ 曲线/ 方向/ ZN/ 四分/ 树/ 节点/ Z/ 对应/ 区域/ 的/ 曲线/ 阶数/ ZS/ 四分/ 树/ 节点/ Z/ 对应/ 区域/ 的/ 起始/ 点/ ZF/ 四分/ 树/ 节点/ Z/ 的/ 父/ 节点/ ZC/ 四分/ 树/ 节点/ Z/ 的/ 子/ 节点/ 集合/ ZH/ 四分/ 树/ 节点/ Z/ 的/ Hilbert/ 值/ ZV/ 四分/ 树/ 节点/ Z/ 的/ 访问/ 标记/ Z/ (/ i/ )/ 四分/ 树/ 节点/ Z/ 的/ 第/ i/ 个子/ 节点/ S/ 存储/ 树/ 节点/ 的/ 栈/ φ/ L/ 兴趣/ 点/ φ/ 的/ 位置/ 坐标/ THilbert/ 曲线/ 的/ 分形/ 规则/ 表/ (/ 状态/ 转换/ 表/ )/ 算法/ 1/ 描述/ 了/ 根据/ 兴趣/ 点/ 集合/ Φ/ 与/ 用户/ 自定义/ 存储容量/ C/ 对/ 原始/ 空间/ 进行/ 四分/ 树/ 划分/ 的/ 过程/ ,/ 该/ 算法/ 由/ 两个/ 方法/ 构成/ ,/ 其中/ QuadTreeInsert/ 方法/ 使用/ 递归/ 的/ 方式/ 完成/ 对/ 数据/ 点/ 的/ 插入/ ./ 若/ Z/ 为/ 叶子/ 节点/ ,/ 且/ 未/ 达到/ 其/ 存储容量/ C/ ,/ 则/ 直接/ 将/ φ/ 添加/ 到/ 节点/ Z/ ,/ 否则/ 需要/ 为/ Z/ 新建/ 4/ 个子/ 节点/ ,/ 并/ 将/ 其/ 原有/ 兴趣/ 点/ 移动/ 到/ 各自/ 所属/ 的/ 子/ 节点/ ,/ 然后/ 确认/ φ/ 属于/ 哪个/ 子/ 节点/ 包含/ 的/ 区域/ ,/ 该子/ 节点/ 记作/ D/ ,/ 接下来/ 递归/ 调用/ QuadTreeInsert/ ,/ 将/ φ/ 插入/ 节点/ D/ ;/ 若/ Z/ 为/ 中间/ 节点/ ,/ 则/ 需要/ 先/ 确认/ 兴趣/ 点/ φ/ 属于/ Z/ 的/ 哪个/ 子/ 节点/ 对应/ 的/ 区域/ ,/ 该子/ 节点/ 记作/ D/ ,/ 然后/ 递归/ 调用/ QuadTreeInsert/ ,/ 将/ φ/ 插入/ 节点/ D/ ./ 在/ QuadTree/ -/ Generate/ 方法/ 中/ ,/ 通过/ 对/ 每个/ 兴趣/ 点/ 依次/ 执行/ 节点/ 插入/ 过程/ ,/ 即可/ 生成/ 对/ 定义/ 空间/ 的/ 四分/ 树/ 划分/ ,/ 并/ 为/ 自/ 适应/ Hilbert/ 曲线/ 中/ 各/ 原子/ 区域/ Hilbert/ 值/ 的/ 生成/ 提供/ 基础/ ./ 假定/ 输入/ 规模/ 为/ n/ ,/ 则/ 生成/ 的/ 叶子/ 节点/ 个数/ 为/ n/ // C/ ,/ 在/ 平均/ 情况/ 下/ ,/ 树/ 的/ 深度/ 为/ log4/ (/ n/ // C/ )/ +/ 1/ ,/ QuadTreeInsert/ 方法/ 插入/ 一个/ 兴趣/ 点/ 平均/ 需要/ 进行/ log4/ (/ n/ // C/ )/ +/ 1/ 次/ 比较/ 、/ C/ 次/ 兴趣/ 点/ 重构/ 与/ 1/ 次/ 插入/ ,/ 因此/ ,/ QuadTreeGenerate/ 方法/ 需要/ 进行/ n/ (/ log4/ (/ n/ // C/ )/ +/ 1/ +/ C/ +/ 1/ )/ 次/ 操作/ ,/ 即/ 算法/ 1/ 的/ 时间/ 复杂度/ 为/ O/ (/ nlog4n/ )/ ./ 4.2/ 原子/ 区域/ 的/ Hilbert/ 值/ 生成/ 在/ 对/ 定义/ 空间/ 进行/ 四分/ 树/ 划分/ ,/ 获得/ 各/ 原子/ 区域/ 的/ 四分/ 树/ 表示/ 后/ ,/ 需要/ 根据/ 指定/ 的/ 曲线/ 方向/ 与/ 起始/ 点/ ,/ 对/ 四分/ 树/ 的/ 叶子/ 节点/ 即/ 原子/ 区域/ 进行/ 更新/ ,/ 设置/ 各/ 叶子/ 节点/ 的/ Hilbert/ 值及/ 中间/ 节点/ 的/ 曲线/ 方向/ 与/ 起始/ 点/ 信息/ ,/ 如/ 算法/ 2/ 所示/ ./ Hilbert/ 曲线/ 方向/ 分为/ 向下/ (/ D1/ )/ 、/ 向/ 右/ (/ R1/ )/ 、/ 向上/ (/ U1/ )/ 、/ 向/ 左/ (/ L1/ )/ 4/ 种/ ,/ 子/ 区域/ 的/ 序号/ 由/ 区域/ 中/ 的/ 数字/ 指定/ ./ 如果/ 改变/ 曲线/ 起始/ 点/ 的/ 位置/ ,/ 则/ 可以/ 再/ 生成/ 4/ 种/ 分形/ 规则/ ,/ 如/ D2/ 、/ R2/ 、/ U2/ 、/ L2/ 所示/ ./ 算法/ 2/ ./ 原子/ 区域/ Hilbert/ 值/ 生成/ 算法/ THVG/ ./ TreeNodeHilbertValueGenarate/ (/ Q/ ,/ S0/ ,/ θ/ )/ 输入/ :/ 四分/ 树根/ 节点/ Q/ ,/ 起始/ 点/ S0/ ,/ 曲线/ 方向/ θ/ 输出/ :/ 更新/ 后/ 四分/ 树/ 的/ 根/ 节点/ Q1/ ./ QO/ ←/ θ/ ;/ QS/ ←/ S0/ ;/ 2/ ./ PUSH/ (/ Q/ ,/ S/ )/ ;/ c/ ←/ 0/ ;/ 3/ ./ WHILES/ ≠/ / 4/ ./ Z/ ←/ POP/ (/ S/ )/ ;/ 5/ ./ IFZC/ ≠/ / 6/ ./ FORi/ ←/ 3to07/ ./ Z/ (/ i/ )/ O/ ←/ TO/ (/ ZO/ ,/ ZS/ ,/ i/ )/ ;/ Z/ (/ i/ )/ S/ ←/ TS/ (/ ZO/ ,/ ZS/ ,/ i/ )/ ;/ 8/ ./ PUSH/ (/ Z/ (/ i/ )/ ,/ S/ )/ ;/ 9/ ./ ENDFOR10/ ./ ELSE11/ ./ ZH/ ←/ c/ ;/ c/ ←/ c/ +/ 1/ ;/ 12/ ./ ENDIF13/ ./ ENDWHILE/ 算法/ 2/ 根据/ 定义/ 空间/ 的/ 四分/ 树/ 划分/ Q/ 以及/ 指/ Page6/ 定/ 的/ 曲线/ 方向/ θ/ 与/ 起始/ 点/ S0/ ,/ 对/ 四分/ 树/ 进行/ 深度/ 优先/ 遍历/ ,/ 以/ 各/ 叶子/ 节点/ 的/ 访问/ 先后/ 次序/ 确定/ 其/ 对应/ 原子/ 区域/ 的/ Hilbert/ 值/ ./ 在/ 遍历/ 的/ 过程/ 中/ ,/ 依据/ 图/ 2/ 的/ Hilbert/ 曲线/ 分形/ 规则/ ,/ 从根/ 节点/ 开始/ ,/ 逐层/ 确定/ 各/ 中间/ 节点/ 的/ 曲线/ 方向/ 与/ 起始/ 点/ ,/ 如/ 算法/ 第/ 7/ 行/ 所示/ ,/ 其中/ TO/ (/ ZO/ ,/ ZS/ ,/ i/ )/ 与/ TS/ (/ ZO/ ,/ ZS/ ,/ i/ )/ 分别/ 表示/ 节点/ Z/ 第/ i/ 个子/ 节点/ 对应/ 区域/ 的/ 曲线/ 方向/ 与/ 起始/ 点/ ./ 假定/ 兴趣/ 点/ 集合/ 规模/ 为/ n/ ,/ 在/ 平均/ 情况/ 下/ ,/ 算法/ 2/ 需要/ 访问/ ∑/ log4/ (/ n/ // C/ )/ 需/ 访问/ 一次/ ,/ 即/ 算法/ 2/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ ./ 4.3/ 密钥/ 树/ 的/ 生成/ 根据/ 算法/ 2/ 确定/ 了/ 各/ 原子/ 区域/ 的/ Hilbert/ 值/ ,/ 可以/ 用/ 该值/ 对/ 原子/ 区域/ 中/ 的/ 兴趣/ 点/ 建立/ 索引/ ,/ 但/ 对于/ ADU/ 给定/ 的/ 检索/ 兴趣/ 点/ 或者/ 区域/ ,/ 如果/ 直接/ 使用/ 算法/ 2/ 处理/ 后/ 的/ 四分/ 树/ 进行/ 搜索/ ,/ 则/ 会/ 产生/ 检索/ 效率/ 较/ 低/ 的/ 问题/ ,/ 且/ 不适/ 用于/ 数据/ 拥有者/ 对/ 空间/ 区图/ 3AHC/ 与/ 密钥/ 树/ 算法/ 3/ ./ AHC/ 密钥/ 树/ 生成/ 算法/ ./ AHCKeyTreeGenerate/ (/ Q/ )/ 输入/ :/ 四分/ 树根/ 节点/ Q/ 输出/ :/ 更新/ 后/ 四分/ 树/ 的/ 根/ 节点/ Q1/ ./ PUSH/ (/ Q/ ,/ S/ )/ ;/ 2/ ./ WHILES/ ≠/ / 3/ ./ Z/ ←/ POP/ (/ S/ )/ ;/ 4/ ./ IFZC/ ≠/ / 5/ ./ IF/ {/ ZC/ }/ V/ =/ TRUE6/ ./ IF/ {/ ZC/ }/ C/ =/ / &/ {/ ZC/ }/ N/ =/ constant7/ ./ ZN/ ←/ {/ ZC/ }/ N/ +/ 1/ ;/ ZC/ ←/ / ;/ ZV/ ←/ TRUE/ ;/ 8/ ./ ELSE9/ ./ ZV/ ←/ TRUE/ ;/ 10/ ./ ENDIF11/ ./ ELSE12/ ./ PUSH/ (/ Z/ ,/ S/ )/ ;/ 13/ ./ FORi/ ←/ 3to014/ ./ PUSH/ (/ Z/ (/ i/ )/ ,/ S/ )/ ;/ 域/ 的/ 自定义/ 授权/ ./ 为/ 满足/ 数据/ 拥有者/ 与/ 授权/ 用户/ 的/ 需求/ ,/ 算法/ 3/ 给出/ 了/ 自/ 适应/ Hilbert/ 曲线/ 的/ 密钥/ 树/ 生成/ 方法/ ./ 算法/ 3/ 在/ 算法/ 2/ 处理/ 后/ 的/ 四分/ 树/ 基础/ 上/ ,/ 自/ 底向上/ 进行/ 剪枝/ 操作/ 并/ 更新/ 各/ 节点/ 的/ 密钥/ 参数/ ,/ 生成/ 一颗/ 新/ 的/ 四分/ 树/ ,/ 即/ 密钥/ 树/ ,/ 如图/ 3/ (/ b/ )/ 所示/ ./ 在/ 该/ 四分/ 树中/ ,/ 叶子/ 节点/ 表示/ 其/ 对应/ 区域/ 的/ Hilbert/ 曲线/ 分布/ 均匀/ ,/ 节点/ 中/ 存储/ 该/ 区域/ 的/ 转换/ 密钥/ STK/ (/ R/ ,/ S0/ ,/ N/ ,/ θ/ ,/ Γ/ )/ ,/ 例如/ STK3/ ;/ 中间/ 节点/ 则/ 表示/ 该/ 区域/ 的/ Hilbert/ 曲线/ 分布/ 不/ 均匀/ ,/ 中间/ 节点/ 包含/ 4/ 个子/ 节点/ ,/ 分别/ 用/ NW/ 、/ NE/ 、/ SW/ 、/ SE/ 表示/ ,/ 为/ 便于/ 后续/ 处理/ ,/ 中间/ 节点/ 存储/ 的/ 转换/ 密钥/ 为/ STK/ (/ R/ ,/ S0/ ,/ NM/ ,/ θ/ ,/ Γ/ )/ ,/ 其中/ NM/ 表示/ 其子/ 节点/ 中/ 最高/ 的/ 曲线/ 阶数/ ,/ 例如/ STK4/ ;/ 对于/ 曲线/ 阶数/ 为/ 0/ 的/ 节点/ ,/ 其/ 曲线/ 方向/ 字段/ 则/ 为/ 空/ ,/ 例如/ STK6/ ./ 经过/ 算法/ 1/ 和/ 算法/ 2/ 的/ 处理/ ,/ 四分/ 树/ 节点/ 中/ 已/ 生成/ R/ ,/ S0/ ,/ θ/ ,/ 算法/ 3/ 进行/ 剪枝/ 操作/ ,/ 生成/ 密钥/ 参数/ N/ ./ 15/ ./ ENDFOR16/ ./ ENDIF17/ ./ ELSE18/ ./ IFZN/ >/ (/ ZF/ )/ N19/ ./ (/ ZF/ )/ N/ ←/ ZN/ ;/ 20/ ./ ENDIF21/ ./ ZV/ ←/ TRUE/ ;/ 22/ ./ ENDIF23/ ./ ENDWHILE/ 以图/ 3/ (/ a/ )/ 所示/ 的/ 自/ 适应/ Hilbert/ 曲线/ 为例/ ,/ 经过/ 算法/ 1/ 和/ 算法/ 2/ 处理/ 后/ ,/ 即可/ 获得/ 如图/ 4/ (/ a/ )/ 所示/ 的/ 四分/ 树/ ,/ 叶子/ 节点/ 对应/ 原子/ 区域/ ,/ 算法/ 3/ 获得/ 该/ 四分/ 树后/ ,/ 从根/ 节点/ 开始/ ,/ 根据/ 节点/ 存储/ 的/ 曲线/ 方向/ 与/ 起始/ 点/ 信息/ ,/ 依次/ 对/ 各子/ 节点/ 进行/ 访问/ ,/ 根据/ 算法/ 3/ 中/ 5/ 、/ 6/ 行/ 的/ 判断/ 条件/ ,/ 将/ 可以/ 合并/ 的/ 叶子/ 节点/ 从/ 四分/ 树中/ 删除/ ,/ 并/ 据此/ 设定/ 其父/ 节点/ 的/ 密钥/ 参数/ ;/ 对/ 不/ 满足/ 合并/ 条件/ 的/ 叶子/ 节点/ ,/ 则/ 根据/ 其/ 节点/ 信息/ 设置/ Page7/ 其/ 密钥/ 参数/ ,/ 并/ 更新/ 其父/ 节点/ 的/ 密钥/ 参数/ ./ 最终/ 获得/ 如图/ 4/ (/ f/ )/ (/ 即图/ 3/ (/ b/ )/ )/ 所示/ 的/ 密钥/ 树/ ./ 假定/ 兴趣/ 点/ 集合/ 规模/ 为/ n/ ,/ 在/ 平均/ 情况/ 下/ ,/ 算法/ 3/ 对/ 每个/ 节点均/ 需要/ 访问/ 两次/ ,/ 即/ 2/ ∑/ log4/ (/ n/ // C/ )/ 8n/ -/ 2C3C/ 次访问/ ,/ 故/ 算法/ 3/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ ./ 5/ 空间/ 查询处理/ 第/ 4/ 节/ 介绍/ 了/ 使用/ AHC/ 对/ 兴趣/ 点/ 构建/ 索引/ 并/ 生成/ 密钥/ 树/ 的/ 方法/ ./ 本节/ 则/ 对/ 基于/ AHC/ 的/ 空间/ 查询处理/ 方法/ 进行/ 说明/ ./ 5.1/ 基于/ AHC/ 的/ Hilbert/ 值/ 计算方法/ 为/ 使/ ADU/ 与/ DO/ 可以/ 根据/ 索引/ 值/ 对/ 密文/ 空间/ 进行/ 检索/ ,/ 首先/ 需要/ 解决/ 基于/ AHC/ 的/ Hilbert/ 值/ 计算/ 问题/ ./ 由于/ DO/ 可能/ 仅/ 将/ 密钥/ 树/ Ψ/ 部分/ 共享/ 给/ ADU/ ,/ 即/ ADU/ 获得/ 的/ 转换/ 密钥/ {/ STKi/ }/ / Ψ/ ,/ 因此/ ADU/ 仅能/ 对/ 授权/ 范围/ 内/ 的/ 兴趣/ 点/ 进行/ 查询/ ./ ADU/ 获得/ 转换/ 密钥/ {/ STKi/ }/ 后/ ,/ 若待/ 查询/ 兴趣/ 点/ φ/ 属于/ {/ STKi/ }/ 的/ 某/ 区域/ ,/ 则/ 可/ 根据/ 4.2/ 节/ 的/ Hil/ -/ bert/ 曲线/ 分形/ 规则/ ,/ 采用/ 逐层/ 深入/ 的/ 方法/ 计算/ 出/ φ/ 在/ AHC/ 中/ 的/ Hilbert/ 值/ ,/ 其/ 计算方法/ 如/ 算法/ 4/ 所示/ ./ 算法/ 4/ ./ 基于/ AHC/ 的/ Hilbert/ 值/ 计算方法/ ./ PositionToHilbert/ (/ φ/ ,/ {/ STKi/ }/ )/ 输入/ :/ 兴趣/ 点/ φ/ ,/ AHC/ 转换/ 密钥/ {/ STKi/ }/ 输出/ :/ 兴趣/ 点/ φ/ 的/ Hilbert/ 值/ 1/ ./ getZ/ ∈/ {/ STKi/ }/ whichmeets/ φ/ L/ ∈/ ZR/ ;/ 2/ ./ IFZ/ =/ / 3/ ./ RETURNNULL/ ;/ 4/ ./ ELSE5/ ./ compute/ (/ xc/ ,/ yc/ )/ of/ φ/ usingformula1/ ;/ 6/ ./ T0/ ←/ T/ (/ ZO/ ,/ ZS/ )/ ;/ M/ ←/ 0/ ;/ 7/ ./ FORi/ ←/ ZN/ -/ 1to08/ ./ M/ ←/ M/ / 2/ ;/ 9/ ./ xq/ ←/ xc/ &/ (/ 1/ / i/ )/ ;/ yq/ ←/ yc/ &/ (/ 1/ / i/ )/ ;/ 10/ ./ Sn/ // Tn/ ←/ T0/ (/ xq/ ,/ yq/ )/ ;/ T0/ ←/ Tn/ ;/ M/ ←/ M/ |/ Sn/ ;/ 11/ ./ ENDFOR12/ ./ ENDIF13/ ./ H/ ←/ H0/ +/ M/ ;/ 14/ ./ RETURNH/ ;/ 在/ 算法/ 4/ 中/ ,/ 首先/ 需要/ 根据/ 兴趣/ 点/ φ/ (/ x/ ,/ y/ ,/ ξ/ )/ 和/ 转换/ 密钥/ {/ STKi/ }/ ,/ 定位/ 到/ φ/ 的/ 所属/ 区域/ 中/ ,/ 若/ 不/ 存在/ 该/ 区域/ ,/ 说明/ 用户/ 不/ 具备/ 访问/ 权限/ ,/ 返回/ 空值/ ;/ 否则/ 即可/ 获得/ STK/ (/ R/ ,/ S0/ ,/ N/ ,/ θ/ ,/ Γ/ )/ ∈/ {/ STKi/ }/ ,/ 且/ φ/ L/ ∈/ R/ ./ 使用/ (/ x0/ ,/ y0/ )/ 表示/ 区域/ R/ 左下角/ 端点/ ,/ r/ 表示/ R/ 的/ 边长/ ,/ H0/ 表示/ 区域/ 起始/ 点/ ZS/ 的/ Hilbert/ 值/ ,/ 则/ 该/ 兴趣/ 点/ 所属/ 区域/ 的/ 整数/ 编码/ (/ xc/ ,/ yc/ )/ 需/ 满足/ 如下/ 条件/ ./ 条件/ 1/ :/ r/ 条件/ 2/ :/ r/ 即/ 获得/ 兴趣/ 点/ 所属/ 区域/ 的/ 整数/ 编码/ 之后/ ,/ 即可/ 根据/ 转换/ 密钥/ STK/ 来/ 计算/ 兴趣/ 点/ 在/ 该/ 区域/ 中/ 的/ 相对/ Hilbert/ 值/ ,/ 记作/ M/ ,/ 如/ 算法/ 4/ 第/ 6/ ~/ 11/ 行/ 所示/ ,/ 最后/ 使用/ 区域/ 起始/ 点/ 的/ Hilbert/ 值/ H0/ 加上/ M/ 即可/ 获得/ 兴趣/ 点/ 在/ 定义/ 空间/ 中/ 的/ Hilbert/ 值/ ./ 在/ 算法/ 4/ 的/ 计算/ 过程/ 中/ ,/ 需要/ 根据/ 当前/ 层次/ 的/ (/ xq/ ,/ yq/ )/ 坐标/ 、/ 曲线/ 方向/ ZO/ 以及/ 起始/ 点/ ZS/ 信息/ ,/ 获取/ 当前/ 层次/ 的/ 序号/ Sn/ 、/ 下/ 一/ 层次/ 的/ 曲线/ 方向/ 及/ 起始/ 点/ 信息/ ./ 本文/ 使用/ 曲线/ 状态/ 转换/ 表对/ 图/ 2/ 的/ 分形/ 规则/ 进行/ 表示/ ,/ 表/ 2/ 即为/ 规则/ D1/ 的/ 状态/ 转换/ 表/ ,/ 其他/ 规则/ 的/ 状态/ 转换/ 表与此/ 类似/ ,/ 通过/ 查询/ 该表/ 即可/ 获得/ 兴趣/ 点/ 在/ 当前/ 层次/ 的/ 序号/ 以及/ 下/ 一/ 层次/ 的/ 曲线/ 状态/ 转换/ 表/ ./ 假定/ ADU/ 获得/ 整个/ 密钥/ 树/ ,/ 则/ 在/ 平均/ 情况/ 下/ ,/ 算法/ 4/ 在/ 定位/ 时/ 需要/ 进行/ log4/ (/ n/ // C/ )/ +/ 1/ 次/ 比较/ ,/ 在/ 计算/ Hilbert/ 值时/ 需要/ ZN/ 次/ 循环/ ,/ 即/ 共/ 需要/ log4/ (/ n/ // C/ )/ +/ 1/ +/ ZN/ 次/ 操作/ ,/ 故/ 算法/ 4/ 的/ 时间/ 复杂度/ 为/ O/ (/ log4n/ )/ ./ Page85/ ./ 2/ 基于/ AHC/ 的/ 查询处理/ 方法/ 在/ 对/ 空间/ 的/ 各种/ 查询/ 需求/ 中/ ,/ 范围/ 查询/ 是/ 一个/ 基本/ 类型/ ,/ ADU/ 对/ 空间/ 的/ 二维/ 查询/ 请求/ Qw/ =/ [/ xql/ ,/ xqh/ ]/ ×/ [/ yql/ ,/ yqh/ ]/ 必须/ 转换/ 为/ 一维/ 查询/ 段/ QR/ (/ hb/ ,/ he/ )/ 才/ 可以/ 被/ SP/ 识别/ 并/ 处理/ ./ 对于/ 标准/ Hilbert/ 曲线/ 中/ 的/ 范围/ 查询处理/ ,/ 需要/ 经过/ 最大/ 块/ 分解/ [/ 27/ ]/ 与/ 查询/ 段/ 的/ 生成/ 与/ 合并/ [/ 28/ ]/ 两个/ 步骤/ ./ 本文/ 对于/ AHC/ 建立/ 的/ 兴趣/ 点/ 索引/ ,/ 并/ 不能/ 直接/ 使用/ Hilbert/ 曲线/ 的/ 处理/ 方法/ ,/ 而/ 需要/ 将/ 查询/ 范围/ 分解/ 到/ 转换/ 密钥/ {/ STKi/ }/ 所/ 对应/ 的/ 区域/ 中/ ,/ 然后/ 对/ 各个/ 分解/ 区域/ 应用/ Hilbert/ 曲线/ 的/ 范围/ 查询处理/ 方法/ ,/ 具体步骤/ 如下/ ./ 1/ ./ 从/ {/ STKi/ }/ 根/ 节点/ 开始/ ,/ 判断/ 范围/ 查询/ Qw/ 的/ 所属/ 区域/ ,/ 若/ Qw/ 与/ 根/ 节点/ 不/ 存在/ 相交/ 区域/ ,/ 则/ 退出/ ,/ 否则/ 继续/ ;/ 2/ ./ 判断/ Qw/ 与/ 当前/ 节点/ 各子/ 节点/ 的/ 相交/ 区域/ ,/ 使用/ Qw1/ ,/ Qw2/ ,/ Qw3/ ,/ Qw4/ 分别/ 表示/ Qw/ 与/ 各子/ 节点/ 的/ 区域/ 交集/ ,/ 其中/ ,/ 交集/ 可能/ 为空/ ;/ 3/ ./ 依次/ 对/ 各子/ 节点/ 执行/ 步/ 2/ ,/ 直至/ 到达/ {/ STKi/ }/ 的/ 叶子/ 节点/ ;/ 4/ ./ 对/ 分解/ 至/ 叶子/ 节点/ 的/ 所有/ 子/ 区域/ 使用/ Hilbert/ 曲线/ 的/ 范围/ 查询处理/ 方法/ ,/ 获得/ 查询/ 段/ ;/ {/ QRi/ }/ ./ 5/ ./ 将/ 所有/ 查询/ 段/ 进行/ 排序/ 与/ 合并/ ,/ 获得/ 查询/ 段/ 集合/ 借鉴/ 文献/ [/ 12/ ]/ 在/ 标准/ Hilbert/ 曲线/ 上/ 进行/ KNN/ 查询/ 的/ 思路/ ,/ 本文/ 也/ 将/ KNN/ 查询/ 分为/ 近似/ KNN/ 查询/ 与/ 精确/ KNN/ 查询/ 两类/ ./ 对于/ 近似/ KNN/ 查询/ ,/ 授权/ 用户/ 根据/ 查询/ 点/ q/ ,/ 计算/ 其/ Hilbert/ 值/ VH/ ,/ 然后/ 将/ VH/ 与/ K/ 提交/ 给/ SP/ ,/ SP/ 在/ 密文/ 数据/ 集中/ 从/ 递增/ 、/ 递减/ 两个/ 方向/ 检索/ 数据/ ,/ 直至/ 获得/ K/ 个/ 结果/ ,/ 记作/ RS/ ,/ 即/ 完成/ 近似/ KNN/ 查询/ ./ 精确/ KNN/ 查询/ 在/ RS/ 的/ 基础/ 上/ ,/ 由/ 授权/ 用户/ 对/ RS/ 解密/ 后/ ,/ 计算/ 各/ 兴趣/ 点/ 与/ q/ 的/ 距离/ ,/ 获得/ 距/ q/ 最远/ 的/ 兴趣/ 点/ d/ ,/ 其/ 距离/ 记/ 作/ ‖/ d/ -/ q/ ‖/ ,/ 然后/ 生成/ 以/ q/ 为/ 中心/ ,/ 2/ ‖/ d/ -/ q/ ‖/ 为/ 边长/ 的/ 正方形/ 查询/ 区域/ ,/ 利用/ 上述/ 的/ AHC/ 上/ 的/ 范围/ 查询处理/ 方法/ ,/ 获得/ 查询/ 结果/ RS/ ,/ 授权/ 用户/ 获得/ RS/ 并/ 解密/ 后/ ,/ 取/ 距离/ q/ 最近/ 的/ 前/ K/ 个/ 兴趣/ 点/ 即可/ 获得/ 精确/ KNN/ 查询/ 结果/ ./ 6/ 实验/ 结果/ 与/ 分析/ 为/ 比较/ 本文/ 提出/ 的/ 自/ 适应/ Hilbert/ 曲线/ 与/ 标准/ Hilbert/ 曲线/ 在/ 安全性/ 与/ 性能/ 方面/ 的/ 表现/ ,/ 我们/ 在/ 5/ 个/ 真实/ 数据/ 集/ 与/ 2/ 个/ 模拟/ 数据/ 集上/ 进行/ 了/ 实验/ ./ 真实/ 数据/ 集/ 包括/ Oldenburg/ (/ OL/ :/ 6105/ 个/ 兴趣/ 点/ )/ 、/ SanJoaquinCounty/ (/ TG/ :/ 18263/ 个/ 兴趣/ 点/ )/ 、/ SanFran/ -/ cisco/ (/ SF/ :/ 174956/ 个/ 兴趣/ 点/ )/ 、/ NorthAmerica/ (/ NA/ :/ 175813/ 个/ 兴趣/ 点/ )/ 以及/ NorthEastUSA/ (/ NE/ :/ 123593/ 个/ 兴趣/ 点/ )/ ./ 其中/ ,/ 数据/ 集/ OL/ ,/ TG/ ,/ SF/ ,/ NA/ 从/ 犹他/ 大学/ 的/ 官方网站/ 获取/ ①/ ,/ NE/ 则/ 来自/ 于/ R/ -/ treepor/ -/ tal/ ②/ ./ OL/ ,/ TG/ ,/ SF/ ,/ NA/ 均/ 为/ 对/ 应城市/ 或/ 区域/ 的/ 路网/ 兴趣/ 点/ 数据/ 集/ ,/ NE/ 则/ 是/ 纽约/ 、/ 费城/ 、/ 波士顿/ 3/ 个/ 城市/ 的/ 真实/ 邮政/ 地址/ 信息/ ,/ 这些/ 数据/ 集/ 很/ 好/ 地/ 对应/ 了/ 空间数据/ 外包/ 的/ 应用/ 场景/ ./ 模拟/ 数据/ 集/ 为/ 随机/ 生成/ 数据/ 集/ ,/ 包括/ 均匀分布/ 数据/ 集/ (/ UN/ ,/ 100000/ 个/ 兴趣/ 点/ )/ ,/ 采用/ 随机数/ 发生器/ 自动/ 生成/ ;/ 偏斜/ 分布/ 数据/ 集/ (/ SK/ ,/ 100000/ 个/ 兴趣/ 点/ )/ ,/ 该/ 数据/ 集/ 包含/ 4/ 个/ 高斯/ 聚簇/ (/ 4/ 个/ 分布/ 中心点/ 随机/ 选择/ ,/ 标准差/ σ/ =/ 0.05/ )/ ,/ 其中/ 99/ %/ 的/ 兴趣/ 点均/ 包含/ 在/ 这/ 4/ 个/ 聚/ 簇/ 中/ ./ 实验/ 在/ Inteli5/ -/ 24003.1/ GHz/ 处理器/ ,/ 8GB/ 内存/ 计算机/ 上/ 完成/ ,/ 实验/ 通用/ 参数设置/ 如表/ 3/ 所示/ ./ 我们/ 从/ 曲线/ 参数/ 选择/ 、/ 兴趣/ 点/ 集合/ 索引/ 生成/ 时间/ 、/ 安全性/ 、/ 范围/ 查询/ 效率/ 和/ KNN/ 查询/ 效率/ 几个/ 方面/ 进行/ 了/ 全面/ 的/ 实验/ 比较/ 与/ 分析/ ,/ 充分证明/ 了/ AHC/ 的/ 安全性/ 与/ 效率/ ./ 6.1/ 曲线/ 参数/ 选择/ 使用/ 标准/ Hilbert/ 曲线/ 或/ AHC/ 对/ 定义/ 空间/ 进行/ 填充/ 后/ ,/ 每个/ 原子/ 区域/ 都/ 会/ 被/ 赋予/ 一个/ Hilbert/ 值/ ,/ 兴趣/ 点则/ 与其/ 所属/ 的/ 原子/ 区域/ 具有/ 相同/ 的/ Hil/ -/ bert/ 值/ ,/ 由此/ 构建/ 兴趣/ 点/ 集合/ 的/ 索引/ ./ 当/ 两个/ 兴趣/ 点/ 处于/ 同一/ 原子/ 区域/ 时/ ,/ 就/ 会/ 出现/ Hilbert/ 值/ 重叠/ 的/ 情况/ ,/ 定义/ 重叠/ 指数/ λ/ 如下/ :/ 其中/ ,/ M/ 为/ 含有/ 兴趣/ 点/ 的/ 原子/ 区域/ 个数/ ,/ H/ 为/ 曲线/ 上/ Hilbert/ 值/ 的/ 上界/ ,/ ni/ 为/ Hilbert/ 值为/ i/ 的/ 兴趣/ 点/ 个数/ ./ 为/ 保证/ 检索/ 效率/ ,/ 需要/ 避免出现/ Hilbert/ 值/ 重叠/ 的/ 情况/ ./ 对于/ 标准/ Hilbert/ 曲线/ ,/ 可以/ 通过/ 增大/ 阶数/ N/ ,/ 对/ 定义/ 空间/ 进行/ 更/ 细粒度/ 的/ 划分/ ;/ 对于/ AHC/ ,/ 可以/ 设定/ 较/ 小/ 的/ 存储容量/ C/ ,/ 使/ 任意/ 原子/ 区/ ①/ ②/ Page9/ 域/ 的/ 兴趣/ 点/ 个数/ 均/ 不/ 超过/ C/ ./ 理想/ 状况/ 下/ ,/ 我们/ 希望/ 重叠/ 指数/ 尽可能/ 接近/ 1/ ,/ 即/ 不/ 存在/ Hilbert/ 值/ 重叠/ 的/ 情况/ ./ 由于/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 在/ 进行/ 区域/ 划分/ 时/ 采用/ 的/ 参数/ 不同/ ,/ 为/ 使/ 后续/ 实验/ 在/ 相同/ 的/ 标准/ 下/ 比较/ ,/ 本节/ 对/ 两种/ 曲线/ 的/ 参数/ 选择/ 进行/ 研究/ ./ 图/ 5/ 标准/ Hilbert/ 曲线/ 阶数/ 与/ 重叠/ 指数/ 的/ 关系/ 由图/ 5/ 可见/ ,/ 对于/ 标准/ Hilbert/ 曲线/ ,/ 其/ 重叠/ 指数/ 随/ 曲线/ 阶数/ N/ 迅速/ 下降/ ,/ 当/ N/ =/ 12/ 时/ ,/ 7/ 个/ 数据/ 集上/ 的/ 重叠/ 指数/ 基本/ 趋近/ 于/ 1/ ;/ 当/ 8/ / N/ / 10/ 时/ ,/ 7/ 个/ 数据/ 集上/ 的/ 重叠/ 指数/ 呈现出/ 较大/ 的/ 差异/ ,/ 其中/ ,/ OL/ 与/ UN/ 的/ λ/ 值较/ 低/ ,/ NA/ 、/ SF/ 与/ SK/ 的/ λ/ 值较/ 高/ ,/ NE/ 与/ TG/ 的/ λ/ 值则/ 介于/ 中间/ ,/ 这是/ 由于/ 标准/ Hil/ -/ bert/ 曲线/ 对/ 定义/ 空间/ 的/ 划分/ 采用/ 统一/ 尺度/ ,/ 因此/ 对于/ 兴趣/ 点/ 数量/ 多/ 、/ 分布/ 密/ 的/ 数据/ 集/ ,/ 会/ 出现/ 较/ 多/ 的/ Hilbert/ 值/ 重叠/ 兴趣/ 点/ ,/ 从而/ 提高/ 了/ λ/ 值/ ./ 从图/ 6/ 可以/ 看出/ ,/ 在/ AHC/ 上/ ,/ 重叠/ 指数/ 随/ 存储容量/ 的/ 增加/ 而/ 缓慢/ 增长/ ,/ 由/ 存储容量/ 及/ 重叠/ 指数/ 的/ 定义/ 可知/ ,/ 当/ 存储容量/ 设置/ 为/ 1/ 时/ ,/ 重叠/ 指数/ 也/ 就/ 为/ 1/ ,/ 通过/ 设置/ 存储容量/ 即可/ 大致/ 了解/ 重叠/ 指数/ 的/ 大小/ ,/ 且/ 7/ 个/ 数据/ 集在/ 设定/ 相同/ 的/ 存储容量/ 条件/ 下/ ,/ 各自/ 的/ 重叠/ 指数/ 也/ 比较/ 接近/ ./ 由图/ 5/ 、/ 图/ 6/ 可得/ 如表/ 4/ 所示/ 的/ 不同/ 数据/ 集上/ 重叠/ 指数/ 与/ 曲线/ 参数/ 的/ 对应/ 关系/ ,/ 在/ 后续/ 的/ 实验/ 中/ ,/ 对/ 标准/ Hilbert/ 曲线/ 与/ AHC/ ,/ 分别/ 选择/ 对应/ 的/ 曲线/ 阶数/ N/ 与/ 存储容量/ C/ ,/ 从而/ 进行/ 比较/ ./ 数据/ 集/ NA131NE121OL111SF121TG121SK121UN111/ 需要/ 说明/ 的/ 是/ ,/ 尽管/ AHC/ 可以/ 根据/ C/ 值/ 对/ 空间/ 进行/ 自/ 适应/ 划分/ ,/ 但是/ 当/ λ/ >/ 1/ 时/ ,/ 其/ C/ 值/ 需要/ 根据/ 数据/ 集/ 的/ 不同/ 而/ 进行/ 调整/ ./ 然而/ 由表/ 4/ 可见/ ,/ 当/ λ/ =/ 1/ 时/ ,/ AHC/ 对/ 所有/ 数据/ 集/ 的/ C/ 值均/ 为/ 1/ ,/ 这/ 是/ 由/ 重叠/ 指数/ 的/ 定义/ 决定/ 的/ ,/ 而/ 标准/ Hilbert/ 曲线/ 的/ 阶/ 数则/ 随/ 数据/ 集/ 的/ 不同/ 出现/ 较大/ 的/ 差异/ ,/ 即/ 在/ 曲线/ 参数/ 选择/ 方面/ ,/ AHC/ 比/ 标准/ Hilbert/ 曲线/ 更为/ 容易/ ./ 在/ 理想/ 状况/ 下/ ,/ 重叠/ 指数/ 取值/ 为/ 1/ ,/ 因此/ 可以/ 直接/ 将/ AHC/ 的/ C/ 值/ 确定/ 为/ 1/ ,/ 从而/ 不/ 需要/ 人工/ 调整/ ./ 6.2/ 索引/ 生成/ 时间/ 对比/ 采用/ 空间/ 填充/ 曲线/ 对/ 定义/ 空间/ 进行/ 转换/ 的/ 一个/ 重要/ 衡量/ 指标/ 就是/ 生成/ 兴趣/ 点/ 集合/ 的/ 索引/ 所/ 需/ 的/ 时间/ ./ 本节/ 对比/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 的/ 索引/ 生成/ 时间/ ,/ 其中/ EDHO/ [/ 29/ ]/ 与/ BIA/ [/ 24/ ]/ 为/ 标准/ Hilbert/ 曲线/ 的/ 索引/ 生成/ 算法/ ;/ 对于/ AHC/ ,/ 由于/ 其/ 对/ 空间/ 的/ 划分/ 随/ 兴趣/ 点/ 分布/ 的/ 不同/ 而/ 变化/ ,/ 并非/ 标准/ Hilbert/ 曲线/ 的/ 均匀/ 划分/ 方式/ ,/ 因此/ 无法/ 将/ EDHO/ 或/ BIA/ 应用/ 在/ 基于/ AHC/ 的/ 索引/ 生成/ 中/ ,/ 故/ 采用/ 4.2/ 节/ 提出/ 的/ THVG/ 算法/ 生成/ 基于/ AHC/ 的/ 兴趣/ 点/ 索引/ ./ 本节/ 设定/ 重叠/ 指数/ 为/ 1/ 、/ 1.4/ ,/ 依据/ 6.1/ 节/ 的/ 曲线/ 参数设置/ 表/ 确定/ 对应/ 的/ 曲线/ 参数/ ,/ 比较/ 这/ 3/ 种/ 算法/ 在/ 不同/ 数据/ 集上/ 生成/ 索引/ 的/ 效率/ ./ 对/ 各/ 数据/ 集/ ,/ 重复/ 100/ 次/ 索引/ 生成/ 算法/ ,/ 取/ 平均值/ 作为/ 索引/ 生成/ 时间/ ./ 由表/ 5/ 可见/ ,/ 与/ EDHO/ 相比/ ,/ BIA/ 算法/ 生成/ 索引/ 的/ 速度/ 更/ 快/ ,/ 这/ 两种/ 算法/ 的/ 索引/ 生成/ 时间/ 均/ 随/ 重叠/ 指数/ 的/ 增加/ 而/ 下降/ ,/ 且/ 处理/ SK/ 数据/ 集/ 与/ 规模/ 相似/ 的/ 真实/ 数据/ 集/ (/ NA/ 、/ NE/ 、/ SF/ )/ 所/ 需/ 时间/ 均/ 长于/ 处理/ UN/ 数据/ 集所/ 需/ 时间/ ,/ 如/ 6.1/ 节/ 所述/ ,/ 由于/ SK/ 数据/ 集/ 与/ 真实/ 数据/ 集/ 的/ 兴趣/ 点/ 分布/ 较为/ 集中/ ,/ 为/ 获得/ 相同/ 的/ 重叠/ 指数/ ,/ 需要/ 在/ 这些/ 数据/ 集上/ 使用/ 更/ 高/ 的/ 曲线/ 阶数/ ,/ 因此/ 增加/ 了/ 索引/ 生成/ 的/ 计算/ 量/ ./ THVG/ 算法/ 生成/ 兴趣/ 点/ 索引/ 的/ 效率/ 大幅度/ 超过/ 了/ EDHO/ 与/ BIA/ 算法/ ./ 其中/ ,/ 当/ 重叠/ 指数/ 分别/ 取/ 1/ 、/ 1.4/ 时/ ,/ THVG/ 在/ 所有/ 数据/ 集上/ 的/ 索引/ 生成/ 时间/ 平均/ 仅为/ BIA/ 的/ 59/ %/ 、/ 43/ %/ ./ 这是/ 由于/ AHC/ 在构/ Page10/ 建/ 索引/ 时/ ,/ 对/ 不同/ 密度/ 的/ 区域/ 采用/ 了/ 不同/ 的/ 曲线/ 阶数/ ,/ 使得/ 对/ 密度/ 较/ 低/ 的/ 区域/ 不必/ 使用/ 过高/ 的/ 曲线/ 阶数/ ,/ 从而/ 提高/ 了/ 索引/ 的/ 计算/ 效率/ ./ 数据/ 集/ λ/ =/ 1NA16621331100415131136585NE1095865505978730306OL48361236258SF1538120670714921118445TG147113641208634SK922706489860639317UN8796684067515632686/ ./ 3AHC/ 的/ 安全性/ 分析/ 文献/ [/ 15/ ]/ 证明/ 了/ 标准/ Hilbert/ 曲线/ 可以/ 作为/ 进行/ 空间/ 转换/ 的/ 单向/ 函数/ ,/ 其/ 转换/ 密钥/ 即/ 为/ 曲线/ 参数/ ./ 当/ AHC/ 对/ 定义/ 空间/ 均匀/ 划分/ 时/ ,/ 即/ 转化/ 为/ 标准/ Hilbert/ 曲线/ ,/ 同样/ 具备/ 抗/ 穷举/ 攻击/ 的/ 能力/ ;/ 当/ 兴趣/ 点非/ 均匀分布/ 时/ ,/ AHC/ 即/ 转化/ 为/ 随/ 兴趣/ 点/ 分布/ 密度/ 而/ 变化/ 的/ 多个/ 标准/ Hilbert/ 曲线/ 的/ 组合/ ,/ 由于/ 恶意/ 攻击者/ 采用/ 蛮力/ 攻击/ 的/ 方法/ ,/ 从/ 理论/ 上/ 其/ 无法/ 穷举/ 所有/ 的/ 兴趣/ 点/ 分布/ 情况/ ,/ 且/ 各/ 区域/ 的/ 标准/ Hilbert/ 图/ 7/ 索引/ 分布图/ (/ A/ ./ / )/ Hilbert/ (/ B/ ./ / )/ AHC/ 为/ 进一步/ 分析/ 两种/ 曲线/ 的/ 索引/ 分布/ 特点/ ,/ 我们/ 从/ 连续/ 段/ 数量/ 、/ 连续/ 段/ 平均/ 长度/ 、/ 空值/ 段/ 数量/ 和/ 空值/ 段/ 平均/ 长度/ 4/ 个/ 方面/ 进行/ 比较/ ,/ 各/ 数据/ 集/ 的/ 索引/ 分布/ 情况/ 如表/ 6/ 所示/ ./ 其中/ ,/ 标准/ Hilbert/ 曲线/ 生成/ 索表/ 6/ 索引/ 分布/ 数据/ 集/ NA1490921147491/ ./ 101.53149093114750449/ ./ 013.18/ NE110131705761/ ./ 051.7011013270577151/ ./ 292.29/ OL604535811/ ./ 011.70/ SF146657976921/ ./ 131.7914665897693113/ ./ 272.10/ TG17557100411/ ./ 021.821755810042954/ ./ 512.49/ SK70447515451/ ./ 161.757044851544236/ ./ 992.04/ UN96533569211/ ./ 021.76965345692242/ ./ 422.04/ 曲线/ 参数/ 也/ 无法/ 在/ 多项式/ 时间/ 内/ 破解/ ,/ 因此/ AHC/ 具备/ 抗/ 穷举/ 攻击/ 的/ 能力/ ./ 文献/ [/ 12/ ]/ 对/ 使用/ 标准/ Hilbert/ 曲线/ 构建/ 兴趣/ 点/ 索引/ 进行/ 了/ 分析/ ,/ 指出/ 恶意/ SP/ 可以/ 通过/ 对/ 具有/ 相同/ 或/ 相近/ Hilbert/ 值/ 的/ 兴趣/ 点/ 数量/ 进行/ 分析/ ,/ 从而/ 发现/ 在/ 转换/ 空间/ 中/ 的/ 兴趣/ 点/ 密集/ 区域/ ,/ 因此/ 增大/ 了/ 用户/ 隐私/ 数据/ 泄露/ 的/ 风险/ ./ 为了/ 直观/ 地/ 分析/ 这/ 类/ 攻击/ 方法/ ,/ 我们/ 设定/ 重叠/ 指数/ 为/ 1/ ,/ 依据/ 6.1/ 节/ 的/ 曲线/ 参数设置/ 表/ 确定/ 对应/ 的/ 曲线/ 参数/ ,/ 对/ 各/ 数据/ 集/ 的/ 索引/ 进行/ 了/ 可视化/ 处理/ ,/ 如图/ 7/ 所示/ ,/ 其中/ ,/ 左侧/ 方块/ 表示/ 兴趣/ 点/ 的/ 空间/ 分布/ ,/ A/ 、/ B/ 则/ 分别/ 表示/ 对应/ 数据/ 集/ 的/ Hilbert/ 、/ AHC/ 索引/ 分布图/ ./ 当/ 兴趣/ 点/ 均匀分布/ 时/ (/ UN/ )/ ,/ 两种/ 曲线/ 的/ 索引/ 分布/ 较为/ 接近/ ./ 而/ 当/ 兴趣/ 点/ 分布/ 密集/ 时/ ,/ 标准/ Hil/ -/ bert/ 曲线/ 生成/ 的/ 兴趣/ 点/ 索引/ 则/ 出现/ 了/ 很多/ 空值/ 段/ ,/ 即/ A/ ./ / 中/ 的/ 长段/ 灰色/ 部分/ ./ 这样/ 恶意/ SP/ 便/ 可以/ 对/ 索引/ 的/ 断裂/ 状况/ 进行/ 分析/ ,/ 进而/ 发现/ 转换/ 空间/ 中/ 的/ 兴趣/ 点/ 密集/ 区域/ ./ 而/ AHC/ 生成/ 的/ 索引/ 则/ 基本/ 没有/ 长段/ 空值/ 区域/ ,/ 且/ 连续/ 段/ 与/ 空值/ 段/ 的/ 分布/ 较为/ 均衡/ ,/ 这样/ 恶意/ SP/ 就/ 很/ 难/ 从/ 索引/ 分布/ 中/ 挖掘出/ 有/ 价值/ 的/ 信息/ ./ 引/ 的/ 连续/ 段/ 与/ 空值/ 段/ 数量/ 均/ 远大于/ AHC/ ,/ 且/ 其/ 连续/ 段/ 与/ 空值/ 段/ 的/ 平均/ 长度/ 也/ 表现/ 出/ 了/ 巨大/ 的/ 差异/ ,/ 而/ AHC/ 生成/ 索引/ 的/ 连续/ 段/ 与/ 空值/ 段/ 平均/ 长度/ 则/ 非常/ 接近/ ,/ 这/ 充分说明/ 了/ AHC/ 索引/ 分布/ 的/ 均衡性/ ./ HilbertAHCPage11/ 使用/ 哑元/ 对/ 空值/ 段/ 进行/ 填充/ [/ 12/ ]/ 可以/ 显式/ 去除/ 空值/ 段/ ,/ 但/ 恶意/ SP/ 可以/ 通过/ 对/ 查询/ 历史/ 进行/ 分析/ ,/ 发现/ 查询/ 频次/ 过低/ 的/ 索引/ 项/ ,/ 进而/ 确认/ 哑元/ 的/ 存在/ 范围/ ,/ 即可/ 发现/ 空值/ 段/ ./ 本文/ 为/ 量化/ 隐私/ 信息/ 泄露/ 的/ 风险/ ,/ 使用/ 信息熵/ 的/ 思想/ ,/ 定义/ 空洞/ 指数/ β/ 如下/ :/ 其中/ :/ ω/ i/ 表示/ 索引/ 中/ 的/ 一个/ 空值/ 段长度/ ,/ G/ 表示/ 空值/ 段/ 的/ 个数/ ,/ / j/ 表示/ 索引/ 中/ 一个/ 连续/ 段/ 的/ 长度/ ,/ F/ 表示/ 连续/ 段/ 的/ 个数/ ,/ L/ 则/ 表示/ 索引/ 的/ 总长度/ ./ 实验/ 在/ 重叠/ 指数/ λ/ =/ 1/ 的/ 条件/ 下/ ,/ 分别/ 计算/ 了/ 使用/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 对/ 兴趣/ 点/ 集合/ 构建/ 索引/ 的/ 空洞/ 指数/ ,/ 结果/ 如表/ 7/ 所示/ ./ 数据/ 集/ NANEOLSFTGSKUN/ 空洞/ 指数/ 衡量/ 了/ 索引/ 中/ 包含/ 的/ 空值/ 段/ 与/ 连续/ 段/ 对/ 隐私/ 信息/ 泄露/ 风险/ 的/ 影响/ ,/ 空值/ 段/ 与/ 连续/ 段/ 的/ 分布/ 越/ 均衡/ ,/ 则/ 越/ 不利于/ 恶意/ SP/ 分析/ ./ 由/ 信息熵/ 的/ 性质/ 可知/ ,/ 空值/ 段/ 与/ 连续/ 段/ 的/ 分布/ 越/ 失衡/ ,/ 空洞/ 指数/ 越低/ ,/ 则/ 表示/ 泄露/ 给/ 恶意/ SP/ 的/ 信息/ 就/ 越/ 多/ ,/ 隐私/ 信息/ 泄露/ 的/ 风险/ 也/ 越/ 大/ ./ 由表/ 7/ 可见/ ,/ 在/ 非/ 均匀分布/ 数据/ 集上/ ,/ AHC/ 的/ β/ 值均/ 大幅度/ 高于/ 标准/ Hilbert/ 曲线/ ,/ 平均/ 高出/ 了/ 57/ %/ ,/ 这/ 表明/ AHC/ 在/ 非/ 均匀分布/ 数据/ 集上/ 泄露/ 隐私/ 信息/ 的/ 风险/ 要远/ 小于/ 标准/ Hilbert/ 曲线/ ./ 通过/ 对/ 两种/ 曲线/ 的/ 特性/ 分析/ 可知/ ,/ AHC/ 在/ 均匀/ 数据/ 集上/ 对/ 空间/ 的/ 填充/ 效果/ 与/ 标准/ Hilbert/ 曲线/ 趋于/ 一致/ ,/ 因此/ 在/ UN/ 上/ 的/ 空洞/ 指数/ 非常/ 接近/ ;/ 由/ 索引/ 分布/ 的/ 数图/ 8/ 范围/ 查询/ 准确率/ 据/ 可知/ ,/ 标准/ Hilbert/ 曲线/ 在/ 非/ 均匀分布/ 数据/ 集上/ 构建/ 索引/ 时/ ,/ 产生/ 的/ 空值/ 段/ 数量/ 巨大/ ,/ 且/ 其/ 连续/ 段/ 与/ 空值/ 段/ 的/ 平均/ 长度/ 也/ 相差/ 甚远/ ,/ 而/ AHC/ 由于/ 对/ 空间/ 进行/ 了/ 自/ 适应/ 划分/ ,/ 因此/ 空值/ 段/ 的/ 长度/ 与/ 数量/ 均/ 远/ 小于/ 标准/ Hilbert/ 曲线/ ,/ 且/ 其/ 连续/ 段/ 与/ 空值/ 段/ 的/ 分布/ 均衡/ ,/ 使得/ AHC/ 的/ 空洞/ 指数/ 以较/ 大幅度/ 高于/ 标准/ Hilbert/ 曲线/ ./ 6.4/ 范围/ 查询/ 效率/ 比较/ 在/ 范围/ 查询/ 与/ 近似/ KNN/ 查询/ 中/ ,/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 均会/ 引入/ 多余/ 兴趣/ 点/ ,/ 使用/ 文献/ [/ 15/ ]/ 定义/ 的/ 评价/ 指标/ 对/ 检索/ 结果/ 的/ 质量/ 进行/ 度量/ ,/ 假定/ 一次/ 检索/ 的/ 真实/ 结果/ 为/ S/ (/ d1/ ,/ d2/ ,/ …/ ,/ dK/ )/ ,/ 而/ 实际/ 检索/ 结果/ 为/ S/ (/ d1/ ,/ d2/ ,/ …/ ,/ dK/ )/ ,/ 则/ 定义/ 准确率/ ρ/ 如下/ :/ 其中/ :/ |/ S/ |/ 表示/ 结果/ 集/ S/ 中/ 的/ 元素/ 个数/ ,/ |/ S/ ∩/ S/ |/ 表示/ 在/ 实际/ 的/ 结果/ 集/ S/ 中/ 有效/ 兴趣/ 点/ 的/ 个数/ ./ 实验/ 从/ 如下/ 3/ 个/ 方面/ 比较/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 的/ 范围/ 查询/ 效率/ :/ (/ 1/ )/ 范围/ 查询/ 准确率/ ;/ (/ 2/ )/ 范围/ 查询/ 转换/ 时间/ ;/ (/ 3/ )/ 范围/ 检索/ 查询/ 段/ 个数/ ./ 选择/ NA/ 、/ SK/ 、/ UN/ 作为/ 对比/ 数据/ 集/ ,/ 设定/ 重叠/ 指数/ 分别/ 为/ 1/ 、/ 1.4/ ,/ 依据/ 6.1/ 节/ 的/ 曲线/ 参数设置/ 表/ 确定/ 对应/ 的/ 曲线/ 参数/ ,/ 随机/ 生成/ 100/ 次/ 范围/ 检索/ ,/ 取/ 平均值/ 作为/ 实验/ 结果/ ,/ 如图/ 8/ 、/ 图/ 9/ 、/ 图/ 10/ 所示/ ./ 由图/ 8/ 可见/ ,/ 随着/ 查询/ 窗口/ 边长/ 的/ 增大/ ,/ 两种/ 曲线/ 的/ 查询/ 准确率/ 也/ 持续上升/ ,/ 当/ 窗口/ 边长/ 小于/ 0.03/ 时/ 查询/ 准确率/ 上升/ 较/ 快/ ,/ 大于/ 0.03/ 后/ 逐渐/ 趋于/ 平缓/ ./ 这是/ 由于/ 在/ 范围/ 查询/ 中/ ,/ 查询/ 窗口/ 边界/ 区域/ 会/ 出现/ 查询/ 窗口/ 与/ 原子/ 区域/ 部分/ 重合/ 的/ 情况/ ,/ 使得/ 查询/ 结果/ 中/ 包含/ 该/ 原子/ 区域/ 非/ 重合/ 部分/ 的/ 兴趣/ 点/ ,/ 即/ 多余/ 兴趣/ 点/ ,/ 随着/ 查询/ 窗口/ 边长/ 的/ 增大/ ,/ 边界/ 区域/ 的/ 非/ 重合/ 部分/ 面积/ 之/ 和/ 与/ 查询/ 窗口/ 的/ 面积/ 之比会/ 逐渐/ 减小/ ,/ 范围/ 查询/ 的/ 准确率/ 也/ 随之/ 提高/ ./ 在/ 相同/ 的/ 查询/ 窗口/ 条件/ 下/ ,/ 重叠/ 指数/ 越/ 小/ 的/ 曲/ Page12/ 图/ 9/ 范围/ 查询/ 转换/ 时间/ 图/ 10/ 范围/ 检索/ 查询/ 段/ 个数/ 线/ ,/ 其/ 准确率/ 越高/ ./ 对比/ 相同/ 设置/ 条件/ 的/ 标准/ Hil/ -/ bert/ 曲线/ 与/ AHC/ 可以/ 发现/ ,/ 在/ NA/ 与/ SK/ 上/ ,/ AHC/ 的/ 查询/ 准确率/ 均/ 优于/ 标准/ Hilbert/ 曲线/ ,/ 在/ UN/ 上/ ,/ 两种/ 曲线/ 的/ 查询/ 准确率/ 则/ 非常/ 接近/ ,/ 这是/ 由于/ 在/ UN/ 上/ ,/ AHC/ 对/ 空间/ 的/ 划分/ 粒度/ 与/ 标准/ Hilbert/ 曲线/ 趋于/ 一致/ ,/ 因此/ 获得/ 了/ 相似/ 的/ 实验/ 结果/ ./ 为了/ 比较/ 两种/ 曲线/ 在/ 进行/ 范围/ 查询/ 转换/ 时/ 的/ 效率/ ,/ 实验/ 对/ 每/ 100/ 次/ 范围/ 查询/ 所/ 需/ 的/ 转换/ 时间/ 进行/ 了/ 对比/ ,/ 如图/ 9/ 所示/ ./ 可以/ 发现/ ,/ 在/ 相同/ 的/ 查询/ 窗口/ 边长/ 与/ 重叠/ 指数/ 设定/ 条件/ 下/ ,/ AHC/ 所/ 需/ 的/ 查询/ 转换/ 时间/ 均/ 短于/ 标准/ Hilbert/ 曲线/ ,/ 这是/ 由于/ 标准/ Hil/ -/ bert/ 曲线/ 为了/ 达到/ 与/ AHC/ 相同/ 的/ 重叠/ 指数/ ,/ 必须/ 选择/ 更/ 高/ 的/ 曲线/ 阶数/ ,/ 而/ AHC/ 所/ 需/ 的/ 查询/ 窗口/ 分解/ 与/ 查询/ 段/ 合并/ 的/ 开销/ 与/ 之/ 相比/ 则/ 很/ 低/ ,/ 因此/ 标准/ Hilbert/ 曲线/ 需要/ 更/ 多/ 的/ 处理/ 时间/ ./ 在/ UN/ 上且/ λ/ =/ 1.4/ 时/ ,/ 两种/ 曲线/ 的/ 范围/ 查询/ 转换/ 开销/ 则/ 非常/ 接近/ ,/ 这/ 与/ 两种/ 曲线/ 在/ UN/ 上/ 的/ 划分/ 粒度/ 特性/ 相符/ ./ 授权/ 用户/ 在/ 进行/ 范围/ 检索/ 时/ ,/ 需要/ 将/ 待/ 查询/ 窗口/ 进行/ 转换/ ,/ 将/ 获得/ 的/ 查询/ 段/ 集合/ 发送给/ SP/ ,/ 因此/ 该/ 集合/ 的/ 大小/ ,/ 即/ 查询/ 段/ 数量/ ,/ 与/ 通信/ 负载/ 成正比/ ./ 图/ 10/ 展示/ 了/ 窗口/ 边长/ 与/ 重叠/ 指数/ 对/ 查询/ 段/ 数量/ 的/ 影响/ ,/ 当/ λ/ =/ 1/ 时/ ,/ 标准/ Hilbert/ 曲线/ 生成/ 的/ 查询/ 段/ 数量/ 均/ 大于/ AHC/ ,/ 而/ 当/ λ/ =/ 1.4/ 时/ ,/ 两种/ 曲线/ 生成/ 的/ 查询/ 段/ 数量/ 则/ 较为/ 接近/ ,/ 特别/ 地/ ,/ 在/ UN/ 上/ ,/ 查询/ 段/ 数量/ 基本相同/ ./ 与/ 图/ 9/ 对比/ 可以/ 发现/ ,/ 查询/ 段/ 数量/ 与/ 查询/ 转换/ 时间/ 表现/ 出/ 了/ 相似/ 的/ 分布/ 规律/ ,/ 即越/ 多/ 的/ 查询/ 段/ 对应/ 着/ 越长/ 的/ 处理/ 时间/ ./ 6.5/ 犓/ 犖/ 犖/ 查询/ 效率/ 比较/ 在/ 近似/ KNN/ 查询/ 中/ ,/ 为了/ 衡量/ 实际/ 查询/ 结果/ 与/ 真实/ 查询/ 结果/ 在/ 距离/ 方面/ 的/ 偏差/ ,/ 定义/ 偏差/ 因子/ [/ 15/ ]/ μ/ 如下/ :/ 其中/ ,/ q/ 表示/ 查询/ 点/ ,/ ‖/ di/ -/ q/ ‖/ 表示/ 兴趣/ 点/ di/ 与/ 查询/ 点/ q/ 之间/ 的/ 欧式/ 距离/ ./ 由于/ S/ 为/ 真实/ 结果/ ,/ 因此/ ,/ μ/ / 0/ ,/ 当且/ 仅/ 当/ S/ =/ S/ 时/ ,/ μ/ =/ 0/ ,/ 此时/ ρ/ =/ 1/ ./ 实验/ 从/ 如下/ 3/ 个/ 方面/ 比较/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 的/ KNN/ 查询/ 效率/ :/ (/ 1/ )/ 近似/ KNN/ 查询/ 准确率/ ;/ (/ 2/ )/ 近似/ KNN/ 查询/ 偏差/ 因子/ ;/ (/ 3/ )/ 精确/ KNN/ 查询处理/ 时间/ ./ 实验/ 数据/ 集/ 选择/ 与/ 参数设置/ 与/ 6.4/ 节/ 相同/ ,/ 随机/ 生成/ 100/ 次/ 近似/ KNN/ 查询/ ,/ 取/ 平均值/ 作为/ 实验/ 结果/ ,/ 如图/ 11/ 、/ 图/ 12/ 、/ 图/ 13/ 所示/ ./ 由图/ 11/ 可见/ ,/ 当/ K/ / 10/ 时/ ,/ 两种/ 曲线/ 在/ 各/ 数据/ 集上/ 的/ 近似/ KNN/ 查询/ 准确率/ 保持稳定/ ,/ 且/ λ/ 取值/ 越小/ ,/ 查询/ 准确率/ 越高/ ,/ 这/ 与/ 区域/ 划分/ 的/ 粒度/ 特性/ 相符/ ./ 当/ λ/ =/ 1/ 时/ ,/ 两种/ 曲线/ 的/ 查询/ 准确率/ 基本相同/ ,/ 当/ Page13/ λ/ =/ 1.4/ 时/ ,/ AHC/ 的/ 准确率/ 要/ 优于/ 标准/ Hilbert/ 曲线/ ,/ 在/ NA/ 、/ SK/ 、/ UN/ 上/ 分别/ 提高/ 了/ 77/ %/ 、/ 4/ %/ 、/ 19/ %/ ./ 分析/ 数据/ 集/ 的/ 分布/ 特点/ 可知/ ,/ 由于/ NA/ 的/ 聚簇/ 中心/ 图/ 11/ 近似/ KNN/ 查询/ 准确率/ 图/ 12/ 近似/ KNN/ 查询/ 偏差/ 因子/ 图/ 13/ 精确/ KNN/ 查询处理/ 时间/ 偏差/ 因子/ 反映/ 了/ 实际/ 查询/ 结果/ 与/ 真实/ 查询/ 结果/ 之间/ 的/ 距离/ 差距/ ,/ 比/ 准确率/ 更能/ 体现/ 查询/ 结果/ 的/ 质量/ ./ 根据/ 图/ 12/ 的/ 实验/ 结果/ ,/ 当/ λ/ =/ 1/ 时/ ,/ AHC/ 的/ 偏差/ 因子/ 在/ 各/ 数据/ 集上/ 略/ 优于/ 标准/ Hilbert/ 曲线/ ./ 当/ λ/ =/ 1.4/ 时/ ,/ AHC/ 检索/ 结果/ 的/ 偏差/ 因子/ 则/ 远/ 小于/ 标准/ Hilbert/ 曲线/ ,/ 这/ 符合/ AHC/ 对/ 定义/ 空间/ 进行/ 自/ 适应/ 划分/ 的/ 特性/ ./ 由于/ 近似/ KNN/ 查询/ 所/ 需/ 的/ 计算资源/ 很少/ ,/ 将/ 标准/ Hilbert/ 曲线/ 与/ AHC/ 在/ 查询处理/ 时间/ 上/ 进行/ 远/ 多于/ SK/ 与/ UN/ ,/ 因此/ ,/ 当/ 重叠/ 指数/ 增高/ 时/ ,/ 在/ NA/ 上/ 进行/ 近似/ KNN/ 查询/ ,/ 标准/ Hilbert/ 曲线/ 引入/ 无效/ 兴趣/ 点/ 的/ 概率/ 会/ 大大/ 高于/ AHC/ ./ 对比/ 意义/ 不/ 大/ ,/ 因此/ 本文/ 对比/ 了/ 两种/ 曲线/ 在/ 进行/ 精确/ KNN/ 查询/ 时/ 的/ 处理/ 时间/ ,/ 其中/ 不/ 包含/ 对/ 兴趣/ 点/ 解密/ 所/ 需/ 的/ 时间/ ,/ 实验/ 对/ 每/ 100/ 次/ 精确/ KNN/ 查询/ 所/ 需/ 的/ 处理/ 时间/ 进行/ 了/ 对比/ ,/ 如图/ 13/ 所示/ ./ 由图/ 13/ 可见/ ,/ 对于/ 精确/ KNN/ 查询/ ,/ 两种/ 曲线/ 的/ 查询处理/ 时间/ 均/ 随着/ K/ 值/ 的/ 增加/ 而/ 上升/ ,/ 且/ 在/ NA/ 、/ SK/ 、/ UN/ 上/ 的/ 实验/ 结果表明/ ,/ 标准/ Hilbert/ 曲线/ 的/ 查询处理/ 时间/ 均/ 以/ 较/ 高/ 的/ 幅度/ 超过/ AHC/ ./ 由/ 标准/ Hilbert/ 曲线/ 的/ 特性/ 可知/ ,/ 当/ 兴趣/ 点/ 数量/ 多/ 、/ 分布/ 密/ Page14/ 时/ ,/ 其/ 对/ 空间/ 的/ 分割/ 粒度/ 成/ 指数/ 增长/ ,/ 因此/ 当/ 查询/ 点/ 出现/ 在/ 兴趣/ 点/ 分布/ 稀疏/ 的/ 区域/ 时/ ,/ 仍/ 需要/ 处理/ 曲线/ 阶数/ 很/ 高/ 的/ 查询/ 窗口/ ,/ 而/ AHC/ 由于/ 对/ 空间/ 进行/ 了/ 自/ 适应/ 分割/ ,/ 其/ 在/ 兴趣/ 点/ 稀疏/ 区域/ 仅/ 需要/ 处理/ 较/ 低阶/ 数/ 的/ 查询/ 窗口/ ,/ 因此/ AHC/ 的/ 精确/ KNN/ 查询处理/ 时间/ 要远/ 小于/ 标准/ Hilbert/ 曲线/ ./ 7/ 总结/ 标准/ Hilbert/ 曲线/ 对/ 空间/ 兴趣/ 点/ 进行/ 转换/ 时/ ,/ 没有/ 考虑/ 到/ 兴趣/ 点/ 的/ 分布/ 特性/ ,/ 且/ 为了/ 获得/ 需要/ 的/ 转换/ 效果/ ,/ 可能/ 需要/ 对/ 曲线/ 参数/ 进行/ 多次/ 调整/ ,/ 同时/ ,/ 数据/ 拥有者/ 在/ 将/ 转换/ 密钥/ 共享/ 给/ 授权/ 用户/ 时/ ,/ 就/ 给予/ 了/ 该/ 用户/ 全部/ 区域/ 的/ 访问/ 权限/ ,/ 无法/ 支持/ 数据/ 拥有者/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ./ 本文/ 针对/ 上述/ 问题/ ,/ 提出/ 了/ 一种/ 可以/ 根据/ 兴趣/ 点/ 分布/ 特征/ 而/ 变化/ 的/ 自/ 适应/ Hilbert/ 曲线/ ,/ 该/ 曲线/ 根据/ 原子/ 区域/ 的/ 兴趣/ 点/ 存储容量/ 对/ 空间/ 进行/ 划分/ ,/ 使用/ Hilbert/ 曲线/ 的/ 分形/ 规则/ 来/ 确定/ 各/ 原子/ 区域/ 的/ 访问/ 顺序/ ,/ 并/ 由此/ 构造/ 密钥/ 树/ ,/ 数据/ 拥有者/ 可以/ 将/ 密钥/ 树/ 的/ 一部分/ 共享/ 给/ 授权/ 使用者/ ,/ 从而/ 实现/ 了/ 对/ 空间/ 区域/ 的/ 自定义/ 授权/ ./ 本文/ 分析/ 了/ 使用/ 空间/ 填充/ 曲线/ 构建/ 兴趣/ 点/ 索引/ 的/ 隐私/ 信息/ 泄露/ 风险/ ,/ 定义/ 了/ 空洞/ 指数/ 作为/ 衡量/ 指标/ ./ 在/ 真实/ 数据/ 集/ 与/ 模拟/ 数据/ 集上/ 的/ 实验/ 表明/ ,/ 与/ 标准/ Hilbert/ 曲线/ 相比/ ,/ 本文/ 提出/ 的/ AHC/ 在/ 进行/ 空间/ 转换/ 方面/ 具有/ 更/ 高/ 的/ 安全性/ 与/ 更优/ 的/ 查询/ 效率/ ./ 在/ 以后/ 的/ 工作/ 中/ ,/ 我们/ 将/ 从/ 以下/ 两/ 方面/ 进行/ 深入研究/ :/ (/ 1/ )/ 进一步/ 分析/ 使用/ 空间/ 填充/ 曲线/ 构建/ 兴趣/ 点/ 索引/ 的/ 隐私/ 信息/ 泄露/ 风险/ ,/ 提出/ 更加/ 直观/ 、/ 准确/ 的/ 评价/ 指标/ ;/ (/ 2/ )/ 考虑/ 用户/ 进行/ 查询/ 完整性/ 验证/ 的/ 需求/ ,/ 提出/ 适用/ 于/ 本文/ 方法/ 的/ 查询/ 完整性/ 验证/ 方案/ ./ 

