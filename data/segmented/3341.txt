Page1/ 基于/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ 的/ 泛洪/ 型/ DDoS/ 攻击/ 检测/ 算法/ 杨新宇/ 杨树/ 森李娟/ (/ 西安交通大学/ 计算机科学/ 与/ 技术/ 系/ 西安/ 710049/ )/ 摘要/ 该文/ 提出/ 了/ 一种/ 基于/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ (/ Non/ -/ LinearPreprocessingNetworkTrafficPrediction/ )/ 的/ 分布式/ 拒绝服务/ DDoS/ 攻击/ 检测/ 算法/ ,/ 该/ 算法/ 是/ 在/ 分析/ DDoS/ 攻击/ 的/ 网络流量/ 特性/ 基础/ 上/ 提出/ 的/ ,/ 由/ 一个/ 基本/ 检测/ 算法/ 和/ 一个/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ 组成/ ./ 通过/ 与/ 两种/ 经典/ 算法/ —/ —/ —/ 基于/ VTP/ 的/ 检测/ 算法/ 和/ 基/ 于小波/ 分析/ 的/ 检测/ 算法/ 对比/ 分析/ ,/ 证明/ 文中/ 提出/ 的/ 算法/ 有/ 比/ 这/ 两种/ 经典/ 算法/ 更/ 高效/ 的/ 检测/ 结果/ ./ 只要/ 参数/ 选取/ 合适/ ,/ 该/ 算法/ 可以/ 达到/ 100/ %/ 的/ 检到/ 率/ 和/ 100/ %/ 的/ 正确率/ ./ 该/ 算法/ 在/ 引入/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ 后/ ,/ 大大缩短/ 了/ 检测/ 延迟/ ,/ 可以/ 很/ 好/ 地/ 实时/ 检测/ DDoS/ 攻击/ ./ 关键词/ 分布式/ 拒绝服务/ ;/ 非线性/ 预处理/ ;/ 网络流量/ 预测/ ;/ 实时/ 检测/ 1/ 引言/ SYN/ -/ flooding/ 、/ ICMP/ -/ flooding/ 、/ UDPflooding/ 以及/ DNSflooding/ 等/ 泛洪/ 型/ 分布式/ 拒绝服务/ 攻击/ Page2/ 要/ 及时/ 采取有效/ 的/ 措施/ 阻止/ DDoS/ 攻击/ ,/ 就/ 必须/ 在/ DDoS/ 攻击/ 发生/ 的/ 初期/ 对/ 其/ 进行/ 检测/ ./ 传统/ 的/ 检测/ 方法/ 需要/ 一定/ 的/ 先验/ 知识/ ,/ 难以/ 区分/ 突发/ 正常/ 流量/ 与/ DDoS/ 攻击/ ,/ 并且/ 这些/ 方法/ 都/ 是/ 基于/ 一定/ 假设/ ,/ 并/ 不/ 可靠/ [/ 2/ ]/ ./ 基于/ 流量/ 的/ 方法/ 是/ DDoS/ 攻击/ 检测/ 方法/ 的/ 一个/ 新/ 的/ 发展/ 方向/ [/ 3/ -/ 6/ ]/ ./ DDoS/ 攻击/ 发生/ 时/ ,/ 其/ 流量/ 将/ 呈现出/ 与/ 正常/ 情况/ 不同/ 的/ 特征/ ./ 目前/ 基于/ 流量/ 的/ DDoS/ 攻击/ 检测/ 方法/ 的/ 研究/ 已经/ 取得/ 一些/ 进展/ ./ Wang/ 等/ 利用/ SYN/ -/ FIN/ 包/ 配对/ 的/ 思想/ ,/ 提出/ 针对/ SYN/ -/ Flood/ 攻击/ 的/ 检测/ 方法/ ,/ 对/ 进入/ 主机/ 的/ SYN/ 包/ 和/ 流出/ 主机/ 的/ FIN/ 包/ 进行/ 计数/ ,/ 以/ 它们/ 的/ 差值/ 的/ 绝对值/ 是否/ 明显/ 大于/ 0/ 为/ 判断/ 依据/ [/ 7/ ]/ ./ 统计/ 模型/ 是/ 比较/ 常见/ 的/ 模型/ ,/ 利用/ 流量/ 的/ 期望值/ 、/ 方差/ 等/ 统计/ 值/ 的/ 分布/ 配合/ 假设检验/ 来/ 发现/ 攻击/ [/ 8/ ]/ ./ 基于/ VTP/ (/ 方差/ -/ 时间/ 图/ )/ 的/ 方法/ 是/ 统计/ 模型/ 中/ 的/ 一种/ 经典/ 模型/ ./ VTP/ 方法/ 实时/ 计算/ Hurst/ 参数/ ,/ 然后/ 由/ Hurst/ 参数/ 的/ 变化/ 来/ 判断/ DDoS/ 攻击/ [/ 9/ ]/ ./ 小波/ 分析/ 的/ 方法/ 引入/ DDoS/ 攻击/ 检测/ 是/ 基于/ 流量/ 检测/ 方向/ 的/ 一个/ 突破/ ,/ 能/ 实时/ 有效/ 地/ 检测/ DDoS/ 攻击/ ,/ 其中/ 比较/ 经典/ 的/ 小波/ 分析方法/ 见/ 文献/ [/ 10/ -/ 13/ ]/ ./ 文献/ [/ 10/ -/ 11/ ]/ 都/ 是/ 用/ 小波/ 分析法/ 求解/ Hurst/ 参数/ ,/ 然后/ 根据/ Hurst/ 参数/ 的/ 变化/ 来/ 判断/ DDoS/ 攻击/ ./ 文献/ [/ 12/ ]/ 提出/ 使用/ 离散/ 小/ 波/ 变换/ 后/ ,/ 根据/ Hurst/ 参数/ 的/ 变化/ 来/ 检测/ 攻击/ ./ 文献/ [/ 13/ ]/ 提出/ 了/ 一种/ 基于/ 连续/ 小/ 波/ 变换/ 的/ DDoS/ 攻击/ 检测/ 技术/ ./ 本文/ 通过/ 研究/ DDoS/ 攻击/ 发生/ 的/ 网络流量/ 特点/ ,/ 发现/ DDoS/ 攻击/ 时/ 的/ 网络流量/ 呈/ 增大/ 和/ 趋于平稳/ 的/ 趋势/ ,/ 即/ 呈现/ 高/ 平台/ 性/ ./ 根据上述/ 流量/ 特点/ ,/ 我们/ 提出/ 了/ 一种/ 基于/ 网络流量/ 突发/ 的/ DDoS/ 攻击/ 检测/ 算法/ ,/ 并且/ 引入/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ (/ Non/ -/ linearPreprocessingNetworkTrafficPrediction/ )/ ,/ 加快/ 了/ 检测/ 到/ DDoS/ 攻击/ 的/ 时间/ ./ 另外/ ,/ 通过/ 实验/ 对比/ 分析/ 了/ 基于/ NLPP/ 的/ 方法/ 与/ 经典/ 检测/ 算法/ —/ —/ —/ 基于/ VTP/ 方法/ [/ 9/ ]/ 和/ 基/ 于小波/ 分析方法/ [/ 10/ ]/ 的/ 检测/ 效果/ ,/ 证明/ 了/ 基于/ NLPP/ 的/ 方法/ 有/ 更好/ 的/ 检测/ 效果/ ./ 本文/ 第/ 2/ 节/ 研究/ DDoS/ 攻击/ 发生/ 时/ 网络流量/ 的/ 特点/ ;/ 第/ 3/ 节/ 首先/ 提出/ 基本/ 的/ 基于/ 网络流量/ 突发/ 的/ DDoS/ 攻击/ 检测/ 算法/ ;/ 其次/ ,/ 将/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ 引入/ 到/ 检测/ 算法/ 当中/ ,/ 并/ 对/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ 进行/ 详细/ 介绍/ ;/ 最后/ ,/ 给出/ 检测/ 算法/ 中/ 关键/ 参数/ 的/ 选取/ 方法/ ;/ 第/ 4/ 节/ 给出/ 基本/ 检测/ 算法/ 与/ 引入/ 非线性/ 预处理/ 网络流量/ 预测/ 算法/ 的/ 检测/ 结果/ ,/ 并且/ 与/ 经典/ 算法/ 的/ 检测/ 结果/ 作/ 对比/ 分析/ ;/ 第/ 5/ 节是/ 对/ 全文/ 的/ 总结/ 以及/ 下/ 一步/ 的/ 工作/ ./ 2DDoS/ 攻击/ 发生/ 时/ 网络流量/ 特点/ 2.1/ 模拟/ 生成/ DDoS/ 攻击/ 流量/ DDoS/ 攻击/ 发生/ 不易/ 被/ 察觉/ ,/ 而且/ 一旦/ 大规模/ 攻击/ 发生/ ,/ 往往/ 会/ 造成/ 严重/ 的/ 网络资源/ 消耗/ ./ 为了/ 研究/ DDoS/ 攻击/ 发生/ 时/ 网络流量/ 的/ 特点/ ,/ 我们/ 采用/ NS/ -/ 2/ 模拟/ 仿真/ 软件/ 模拟/ 生成/ SYN/ -/ floodDDoS/ 攻击/ 发生/ 时/ 的/ 网络流量/ ./ 在/ 模拟/ 网络/ 中/ 一共/ 有/ 20/ 个/ 攻击/ 节点/ 、/ 两个/ 正常/ 节点/ 和/ 一个/ 被/ 攻击/ 节点/ ./ 在/ 3500s/ 的/ 模拟/ 过程/ 中/ 一共/ 发生/ 了/ 5/ 次/ DDoS/ 攻击/ ,/ 攻击/ 起始/ 时间/ 、/ 持续时间/ 和/ 攻击/ 节点/ 个数/ 如表/ 1/ 所示/ ,/ NS/ -/ 2/ 生成/ 的/ 流量/ 如图/ 1/ 所示/ ,/ 该/ 流量/ 我们/ 命名/ 为/ DDoS/ -/ Attack/ -/ Traffic/ ./ 表/ 1/ 攻击/ 的/ 起始/ 时间/ 、/ 持续时间/ 和/ 攻击/ 节点/ 个数/ 攻击/ 发起/ 时间/ // s/ 持续时间/ // s/ 攻击/ 节点/ 个数/ ABCDE2/ ./ 2DDoS/ 攻击/ 发生/ 时/ 网络流量/ 特点/ DDoS/ 攻击/ 发生/ 时/ 网络流量/ 呈/ 增大/ 和/ 趋于平稳/ 的/ 趋势/ ,/ 即/ 呈现/ 高/ 平台/ 性/ ./ 结合/ 统计/ 量/ 描述/ 就是/ 流量/ 测量/ 值/ 远大于/ 流量/ 的/ 整体/ 平均值/ (/ 如图/ 2/ 所示/ )/ ,/ 并且/ 网络流量/ 的/ 差分/ 方差/ 在/ 突发/ 后/ 的/ 局部/ 范围/ 内/ 呈现/ 衰减/ 的/ 趋势/ (/ 如图/ 3/ 所示/ )/ ./ 在/ 图/ 2/ 中/ ,/ 实线/ 和/ 虚线/ 分别/ 表示/ 流量/ 和/ 流量/ 平均值/ ./ 可以/ 看出/ 在/ 攻击/ 过程/ 中/ 原始/ 流量/ 远高于/ 平均/ Page3/ 流量/ ,/ 而/ 正常/ 情况/ 下/ 原始/ 流量/ 在/ 平均/ 流量/ 值/ 附近/ 波动/ ./ 图/ 3/ 中/ 的/ 实线/ 代表/ 网络流量/ 的/ 差分/ 方差/ (/ 定义/ 见式/ (/ 5/ )/ )/ ,/ 差分/ 方差/ 在/ 攻击/ 过程/ 中/ 增大/ ./ 需要/ 指出/ 的/ 是/ ,/ 概率/ 学中/ 的/ 方差/ 计算公式/ 是/ 其中/ ,/ X/ (/ i/ )/ 为/ i/ 时刻/ 观测/ 值/ ,/ 珡/ X/ 是/ 序列/ X/ (/ i/ )/ 的/ 期望值/ ./ 在/ 实际/ 计算/ 时/ ,/ 流量/ 的/ 期望值/ 由/ 流量/ 的/ 均值/ 代替/ ,/ 均值/ 由/ 每次/ 得到/ 的/ 流量/ 数据/ 推算/ 一次/ 得到/ ./ 使用/ 原始数据/ 的/ 差分/ 序列/ 的/ 方差/ 能够/ 更好/ 地/ 反应/ 数据/ 波动/ 的/ 情况/ ,/ 定义/ 原始/ 序列/ 的/ 差分/ 序列/ 为/ W/ (/ i/ )/ ./ t/ -/ 1/ ∑/ t/ 珨/ W/ =/ 1t/ -/ 1/ ∑/ t/ =/ 1/ =/ 1t/ -/ 1/ (/ X/ (/ 2/ )/ -/ X/ (/ 1/ )/ +/ X/ (/ 3/ )/ -/ X/ (/ 2/ )/ +/ …/ +/ =/ 1t/ -/ 1/ (/ X/ (/ t/ )/ -/ X/ (/ 1/ )/ )/ limt/ →/ 当/ t/ →/ 时/ ,/ 珨/ W/ →/ 0/ ,/ 因此/ 在/ 计算/ 时/ 认为/ 珨/ W/ 为/ 0/ 以/ 简化/ 计算/ ./ var/ _/ W/ 表示/ 的/ 就是/ 原始/ 序列/ 的/ 差分/ 方差/ ,/ 定义/ 如下/ :/ var/ _/ W/ (/ i/ )/ =/ 1/ 由/ 差分/ 方差/ 的/ 表达式/ (/ 5/ )/ 和/ 方差/ 的/ 表达式/ (/ 1/ )/ 可以/ 看出/ ,/ 差分/ 方差/ 比/ 方差/ 更/ 容易/ 计算/ 得到/ ,/ 因此/ 在/ 判定/ DDoS/ 攻击/ 是否/ 发生/ 时/ 采用/ 计算/ 网络流量/ 的/ 差分/ 方差/ 来/ 代替/ 方差/ ./ 3DDoS/ 攻击/ 检测/ 算法/ 3.1/ 基本/ 检测/ 算法/ 点/ ,/ 我们/ 提出/ 了/ 一种/ 递推/ 的/ 攻击/ 检测/ 算法/ :/ 根据/ 主机/ 受到/ DDoS/ 攻击/ 时/ 接收/ 到/ 的/ 流量/ 的/ 特/ (/ 1/ )/ 统计/ 量/ 的/ 计算/ 由于/ 算法/ 实时性/ 的/ 要求/ ,/ 各/ 统计/ 量/ 均/ 采用/ 递推/ 方式/ 完成/ ./ 假设/ 在/ t/ 时刻/ ,/ 原始/ 流量/ 为/ S/ (/ t/ )/ ,/ 整体/ 均值/ 为/ s/ _/ u/ (/ t/ )/ ,/ 流量/ 的/ 差/ 分值/ 为/ w/ (/ t/ )/ ,/ 差分/ 方差/ 为/ var/ _/ w/ (/ t/ )/ ,/ 根据/ 式/ (/ 4/ )/ 可知/ ,/ w/ (/ t/ )/ 的/ 均值/ 可以/ 认为/ 是/ 0/ ./ 对/ 统计/ 量/ 的/ 计算/ 如下/ :/ s/ _/ u/ (/ t/ )/ =/ 1var/ _/ w/ (/ t/ )/ =/ 1/ 为了/ 衡量/ t/ 时刻/ 流量/ 的/ 大小/ ,/ 定义/ 函数/ c/ (/ t/ )/ :/ 烄/ c/ (/ t/ )/ =/ 烅/ 烆/ 式/ (/ 9/ )/ 定义/ 了/ 一个/ 隶属/ 函数/ ./ 其中/ low/ ×/ s/ _/ u/ (/ t/ )/ 表示/ 认为/ 流量/ “/ 大/ ”/ 的/ 下限/ ,/ 即当/ 流量/ 小于/ 平均/ 流量/ 的/ low/ 倍/ 时/ ,/ 流量/ 不/ 大/ ,/ 也/ 即/ 流量/ 隶属于/ “/ 大/ ”/ 的/ 程度/ 为/ 0/ ;/ 区间/ [/ low/ ×/ s/ _/ u/ (/ t/ )/ ,/ high/ ×/ s/ _/ u/ (/ t/ )/ ]/ 的/ 意义/ 是/ 当/ 流量/ S/ (/ t/ )/ 属于/ 这个/ 区间/ 时/ 认为/ 流量/ 大/ ,/ “/ 大/ ”/ 的/ 程度/ 由/ 函数/ S/ (/ t/ )/ 义/ ;/ high/ ×/ s/ _/ u/ (/ t/ )/ 表示/ 能够/ 忍受/ 的/ 流量/ 的/ 上限/ ,/ 当/ 流量/ 超过/ 平均/ 流量/ 的/ high/ 倍/ 时/ ,/ 流量/ 很大/ ,/ 即/ 流量/ 隶属于/ “/ 大/ ”/ 的/ 程度/ 为/ 1/ ./ (/ 2/ )/ 攻击/ 的/ 判定/ 根据/ 式/ (/ 9/ )/ 对/ c/ (/ t/ )/ 的/ 定义/ ,/ 当/ c/ (/ t/ )/ =/ 0/ 时/ 流量/ 隶属于/ “/ 大/ ”/ 的/ 程度/ 为/ 0/ ,/ 所以/ 没有/ 攻击/ 发生/ ./ 如果/ t/ 时刻/ c/ (/ t/ )/ >/ 0/ ,/ 则/ 认为/ 该/ 时刻/ 为/ 攻击/ 疑似/ 点/ ,/ 此时/ 启动/ 攻击/ 判定/ 过程/ 以/ 确定/ 是否/ 有/ 攻击/ 发生/ ./ Page4/ 在/ 算法/ 描述/ 中/ ,/ 定义/ 一个/ 变量/ :/ expected/ _/ step/ ./ 当/ 连续/ 出现/ 攻击/ 疑似/ 点/ 的/ 个数/ 与/ expected/ _/ step/ 相等/ 时/ 就/ 认为/ 发生/ 了/ 攻击/ ./ expected/ _/ step/ 参数/ 过小会/ 造成/ 检测/ 算法/ 误报/ 的/ 情况/ ,/ 但是/ expected/ _/ step/ 参数/ 过/ 大会/ 造成/ 检测/ 算法/ 灵敏度/ 降低/ ,/ 出现/ 漏报/ 的/ 情况/ ,/ 这/ 在/ 检测/ 攻击/ 的/ 过程/ 中是/ 一对/ 矛盾/ ./ 如果/ 要求/ 检测/ 灵敏度/ 高/ ,/ 则/ 容易/ 出现/ 误报/ 的/ 情况/ ./ 而/ 如果/ 要求/ 检测/ 准确/ ,/ 则/ 相应/ 的/ 检测/ 灵敏度/ 会/ 降低/ ./ 另/ 一个/ 参数/ accumulate/ 表示/ 的/ 是/ 攻击/ 检测/ 过程/ 中/ 连续/ 的/ 攻击/ 疑似/ 点/ 出现/ 的/ 个数/ ,/ 当/ accumulate/ / expected/ _/ step/ 时/ 就/ 认为/ 有/ 攻击/ 发生/ ./ accumulate/ 参数/ 按照/ 如下/ 规则/ 计算/ :/ 如果/ 攻击/ 强度/ 增加/ ,/ accumulate/ 自增/ 1/ ,/ 否则/ 自减/ ./ 对/ t/ 时刻/ 攻击/ 强度/ 的/ 判断/ 用/ 下面/ 的/ 伪/ 代码/ 表示/ :/ foreacht/ -/ thtimeslotofdetectiondoexpected/ _/ step/ =/ 3/ ;/ if/ (/ c/ (/ t/ )/ >/ 0/ )/ {/ else/ {/ }/ 对/ 上面/ 伪/ 代码/ 的/ 解释/ :/ (/ 1/ )/ 如果/ 流量/ 隶属于/ “/ 大/ ”/ ,/ 且/ 差分/ 方差/ 增大/ ,/ 说明/ 发生/ 了/ 流量/ 突增/ ,/ 可能/ 是/ 攻击/ 的/ 开始/ ,/ accumulate/ 增加/ 1/ ;/ (/ 2/ )/ 如果/ t/ 时刻/ 差分/ 方差/ 相对/ 于/ t/ -/ 1/ 时刻/ 变/ 大/ 或者/ 不变/ ,/ 说明/ 流量/ 波动/ 程度/ 没有/ 降低/ ,/ 可能/ 有/ 两种/ 流量/ 波动/ 情况/ :/ ①/ 流量/ 增大/ ,/ 此时/ c/ (/ t/ )/ / c/ (/ t/ -/ 1/ )/ ,/ 攻击/ 可能性/ 增加/ ,/ Attack/ (/ t/ )/ 取/ c/ 值/ 较大/ 者/ 即/ c/ (/ t/ )/ ;/ ②/ 流量/ 减小/ ,/ 此时/ c/ (/ t/ )/ </ c/ (/ t/ -/ 1/ )/ ,/ 攻击/ 可能性/ 减小/ ,/ Attack/ (/ t/ )/ 取/ c/ 值较/ 小者/ ,/ 为/ c/ (/ t/ )/ ;/ (/ 3/ )/ 如果/ 差分/ 方差/ 变小/ ,/ 说明/ 流量/ 趋于平稳/ ,/ 攻击/ 可能性/ 增大/ ,/ 因此/ Attack/ (/ t/ )/ 取/ c/ 值/ 较大/ 者/ ;/ (/ 4/ )/ 如果/ 流量/ 不/ 隶属于/ “/ 大/ ”/ ,/ 将/ accumulate/ 赋值/ 为/ 0/ ,/ 程序/ 进入/ 下/ 一个/ 检测/ 周期/ ;/ (/ 5/ )/ accumulate/ =/ expected/ _/ step/ 和/ Attack/ (/ t/ )/ =/ Attack/ (/ t/ -/ 1/ )/ 同时/ 发生/ ,/ 说明/ 攻击/ 可能性/ 在/ expected/ _/ step/ 个/ 周期/ 内/ 持续/ 增加/ 或者/ 至少/ 保持/ 不变/ ,/ 而且/ 这种/ 可能性/ 仍然/ 有/ 增加/ 趋势/ ,/ 所以/ 发出报警/ ;/ (/ 6/ )/ 如果/ accumulate/ =/ expected/ _/ step/ ,/ 但是/ Attack/ (/ t/ )/ </ Attack/ (/ t/ -/ 1/ )/ 说明/ 尽管/ 攻击/ 可能性/ 已经/ 增加/ 或/ 已经/ 维持/ 了/ 一段时间/ ,/ 他/ 在/ t/ 时刻/ 有所/ 下降/ ,/ 因此/ 程序/ 继续/ 观察/ ,/ 等待/ 进一步/ 确认/ ./ 根据/ 以上/ 对/ 统计/ 量/ 的/ 递推/ 和/ 推断/ 过程/ ,/ t/ 时刻/ 需要/ 的/ 数据/ 只有/ S/ (/ t/ -/ 1/ )/ 、/ s/ _/ u/ (/ t/ -/ 1/ )/ 、/ var/ _/ w/ (/ t/ -/ 1/ )/ 、/ c/ (/ t/ -/ 1/ )/ 和/ Attack/ (/ t/ -/ 1/ )/ ,/ 而/ S/ (/ t/ )/ 、/ s/ _/ u/ (/ t/ )/ 、/ var/ _/ w/ (/ t/ )/ 、/ c/ (/ t/ )/ 和/ Attack/ (/ t/ )/ 将/ 被/ 存储/ ,/ 供下/ 一个/ 检测/ 周期/ 使用/ ./ 3.2/ 引入/ 非线性/ 预处理/ 网络流量/ 预测/ NLPP/ 的/ 检测/ 方法/ 将/ 网络流量/ 预测/ 方法/ NLPP/ 引入/ 到/ DDoS/ 攻击/ 检测/ 的/ 主要/ 思想/ 是/ 利用/ 预测值/ 得到/ 比/ 当前/ 观测/ 流量/ 更长/ 的/ 序列/ ,/ 从而/ 缩短/ 发现/ 攻击/ 的/ 时间/ ./ NLPP/ (/ 1/ )/ 基于/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ —/ —/ —/ 一直/ 以来/ ,/ 时间/ 序列/ 模型/ 因/ 其/ 理论/ 发展/ 成熟/ 及/ 易于/ 建立/ 的/ 特点/ 而/ 成为/ 分析/ 和/ 预测/ 网络流量/ 的/ 重要/ 工具/ ./ 从/ 短/ 相关/ 时间/ 序列/ 模型/ AR/ 、/ ARMA/ 、/ ARIMA/ 到长/ 相关/ 时间/ 序列/ 模型/ FARIMA/ [/ 14/ ]/ 、/ k/ -/ factorGARMA/ [/ 15/ ]/ ,/ 研究者/ 对/ 时间/ 序列/ 模型/ 预测/ 网络流量/ 进行/ 了/ 深入/ 的/ 研究/ ./ 但是/ 随着/ 对/ 网络流量/ 特性/ 研究/ 的/ 深入/ ,/ 采用/ 时间/ 序列/ 模型/ 分析/ 和/ 预测/ 暴露出/ 一些/ 缺点/ 和/ 不足/ ./ 首先/ ,/ 建立/ 时间/ 序列/ 模型/ 所/ 广泛/ 采用/ 的/ 基于/ 二阶/ 统计/ 量/ 的/ 处理/ 方法/ ,/ 用于/ 对/ 网络流量/ 进行/ 建模/ 时/ 存在/ 一定/ 的/ 局限性/ ./ 近年来/ 在/ 对/ 网络流量/ 特性/ 研究/ 时/ 发现/ ,/ 网络流量/ 与/ α/ -/ stable/ 分布/ 相一致/ [/ 16/ ]/ ./ α/ -/ stable/ 分布/ 是/ 唯一/ 一类/ 构成/ 独立/ 同/ 分布/ 随机变量/ 之/ 和/ 的/ 极限/ 分布/ ./ 高斯分布/ 是/ α/ -/ stable/ 分布/ 的/ 一种/ 特殊/ 情况/ ,/ 即/ 特征/ 指数/ α/ =/ 2/ ./ 而/ 当/ 特征/ 指数/ 不断/ 减小/ ,/ 对应/ 的/ α/ -/ stable/ 分布/ 数据/ 集中/ 存在/ 越来越/ 多/ 突发/ 点/ ./ 从/ 采集/ 到/ 的/ 网络流量/ 数据/ 集/ 时间/ 序列/ 图形/ 上/ 可以/ 看到/ 明显/ 的/ 突发/ 情况/ ./ 正是/ 这些/ 突发/ 点/ 的/ 存在/ ,/ 使/ 网络流量/ 偏离/ 高斯分布/ ,/ 二阶/ 统计/ 量/ 不再/ 是/ 有限/ 值/ ,/ 造成/ 了/ 采用/ 时间/ 序列/ 模型/ 预测/ 网络流量/ 失效/ ./ 通过/ 已知/ 数据/ 估计/ 模型/ 参数/ 来/ 建立/ 时间/ 序列/ 模型/ ,/ 使用/ 基于/ 二阶/ 统计/ 量/ 方法/ 使/ 估计/ 误差/ 最小化/ ,/ 往往/ 采用/ 的/ 是/ 最小/ 二乘/ 准则/ ./ 在/ 高斯分布/ 假设/ 下/ ,/ 最小/ 二乘/ 准则/ 是/ 适当/ 的/ ,/ 但/ 对于/ 非/ 高斯分布/ 的/ α/ -/ stable/ 分布/ 时间/ 序列/ ,/ 最小/ 二乘/ 准则/ 往往/ 不再/ 适用/ ./ 最/ 主要/ 的/ 原因/ 是/ 由于/ 最/ Page5/ 小二乘/ 准则/ 对于/ 数据/ 中/ 为数不多/ 的/ 较大/ 误差/ 缺乏/ 韧性/ ./ 最小/ 二乘/ 准则/ 被/ 使用/ 时/ ,/ 它/ 往往/ 忽略/ 相对/ 较/ 小/ 的/ 误差/ ,/ 而/ 尽量/ 使/ 较大/ 的/ 误差/ 最小化/ ./ 网络流量/ 中/ 存在/ 一部分/ 极端/ 观测/ 值/ ,/ 在/ 采用/ 最小/ 二乘/ 准则/ 对/ 网络流量/ 建立/ 模型/ 时/ ,/ 往往/ 由于/ 最小/ 二乘/ 准则/ 对/ 这些/ 极端/ 观测/ 值/ 缺乏/ 韧性/ 而/ 导致/ 无法/ 准确/ 地/ 建立/ 网络流量/ 数学模型/ ./ 其次/ ,/ 网络流量/ 存在/ 长/ 相关/ 特性/ [/ 17/ ]/ ,/ 许多/ 研究者/ 采用/ FARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 对/ 网络流量/ 进行/ 分析/ 和/ 预测/ ./ FARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 是/ ARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 的/ 一种/ 自然/ 延伸/ ,/ 它/ 能够/ 同时/ 刻画出/ 数据/ 集/ 的/ 长/ 相关/ 特性/ 与/ 短/ 相关/ 特性/ ./ 但是/ 它/ 的/ 建立/ 过程/ 十分复杂/ ,/ 因此/ 在/ 建立/ FARIMA/ 模型/ 时/ ,/ 研究/ 人员/ 利用/ 在/ 高斯/ 假设/ 下/ 得出/ 的/ 相关性/ 结论/ 对/ 其/ 建立/ 过程/ 进行/ 了/ 简化/ ./ 该/ 结论/ 表示/ 为/ :/ hurst/ =/ 0.5/ 表示/ 短/ 相关/ 而/ 0.5/ </ hurst/ </ 1/ 表示/ 长/ 相关/ ./ 利用/ 该/ 结论/ 首先/ 估计/ hurst/ 参数/ ,/ 通过/ d/ =/ hurst/ -/ 0.5/ 估计/ FARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 的/ d/ 参数/ ./ 有/ 了/ d/ 参数/ 后/ 去除/ 数据/ 集中/ 的/ 长/ 相关性/ ,/ 使/ 数据/ 集只/ 具有/ 短/ 相关/ 特性/ ,/ 进而/ 以/ 估计/ ARMA/ (/ p/ ,/ q/ )/ 参数/ 的/ 方法/ 估计/ 模型/ 剩余/ 的/ 参数/ ./ 但是/ 存在/ 明显/ 突发/ 的/ 网络流量/ 偏离/ 了/ 高斯分布/ 而/ 符合/ α/ -/ stable/ 分布/ ,/ 上述/ 关于/ 相关性/ 的/ 结论/ 是/ 在/ 高斯分布/ 假设/ 下/ 得出/ 的/ ,/ 在/ 非/ 高斯分布/ 假设/ 下/ ,/ 还/ 没有/ 统一/ 的/ 关于/ 相关性/ 的/ 类似/ 结论/ [/ 18/ ]/ ./ 例如/ 当/ 数据/ 集是/ LFSN/ 时/ ,/ hurst/ =/ 1/ 相关/ ./ 因此/ ,/ 采用/ 基于/ 高斯分布/ 假设/ 得出/ 的/ 相关性/ 结论/ 建立/ FARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 并/ 不能/ 刻画/ 网络流量/ 的/ 长/ 相关/ 特性/ ./ 图/ 4/ 非线性/ 预处理/ 前后/ 网络流量/ 特性/ 分析/ 图/ 4/ 中/ (/ a/ )/ 图/ 和/ (/ b/ )/ 图/ 显示/ 的/ 是/ 预处理/ 前后/ 时间/ 序列图/ ,/ (/ a/ )/ 图/ 突发/ 明显/ 而/ (/ b/ )/ 图/ 突发/ 程度/ 明显降低/ ./ 鉴于/ 上述/ 局限性/ ,/ 我们/ 提出/ 了/ 基于/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ ./ 非线性/ 预处理/ 就是/ 通过/ 非线性/ 变换/ 预处理/ 网络流量/ ,/ 使/ 预处理/ 后/ 的/ 时间/ 序列/ 具有/ 有限/ 的/ 二阶/ 统计/ 量/ ,/ 然后/ 利用/ 通常/ 的/ 最小/ 均方/ (/ LMS/ )/ 等/ 方法/ 进行/ 建模/ 和/ 预测/ ./ 该/ 方法/ 具体/ 描述/ 如下/ :/ 首先/ ,/ 通过/ 非线性/ 预处理/ 手段/ 抑制/ 网络流量/ 中/ 显著/ 的/ 突发/ 现象/ ;/ 其次/ ,/ 对/ 非线性/ 预处理/ 后/ 的/ 数据/ 建立/ LMS/ 自/ 适应/ ARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 进行/ 预测/ ;/ 最后/ ,/ 将/ LMS/ 自/ 适应/ ARIMA/ (/ p/ ,/ d/ ,/ q/ )/ 模型/ 的/ 预测值/ 通过/ 恢复/ 函数/ 得到/ 网络流量/ 预测值/ ./ 非线性/ 变换/ 函数/ 选取/ 必须/ 遵循/ 以下/ 两点/ :/ (/ 1/ )/ 在/ 待/ 变换/ 数据/ 所/ 处/ 区间/ 内/ 是/ 单调/ 函数/ ./ 这样/ 才/ 能够/ 保证/ 待/ 变换/ 数据/ 集中/ 所有/ 点/ 与/ 变换/ 后/ 数据/ 是/ 一一对应/ 的/ 关系/ ,/ 保证/ 非线性/ 预处理/ 过程/ 与/ 恢复/ 过程/ 的/ 正确性/ ./ (/ 2/ )/ 非线性/ 变换/ 函数/ 与/ 恢复/ 函数/ 易于/ 实现/ ./ 由于/ 网络流量/ 预测/ 大多/ 是/ 在/ 实时/ 的/ 情况/ 下/ 进行/ 的/ ,/ 因此/ 复杂/ 的/ 非线性/ 变换/ 函数/ 和/ 恢复/ 函数/ 会/ 带来/ 过多/ 的/ 时间/ 耗费/ ./ 函数/ ,/ 指数函数/ 为/ 恢复/ 函数/ ./ 为了/ 证明/ 通过/ 非线性/ 预处理/ 后/ 的/ 数据/ 集/ 已经/ 消除/ 了/ 明显/ 的/ 突发/ 现象/ ,/ 我们/ 选取/ http/ :/ // // ita/ ./ ee/ ./ lbl/ ./ gov/ // 网站/ 上/ 提供/ 的/ 网络流量/ lbl/ -/ tcp/ -/ 3/ (/ 时间/ 粒度/ 为/ 1s/ )/ 进行/ 非线性/ 预处理/ 前后/ 数据/ 特性/ 对比/ 分析/ ./ 对/ 该/ 网络流量/ 进行/ 非线性/ 预处理/ ,/ 预处理/ 前后/ 数据/ 特性/ 对/ 比如/ 图/ 4/ 所示/ ./ 综合/ 上述/ 要求/ ,/ 选择/ 对数函数/ 为/ 非线性/ 预处理/ (/ c/ )/ 图/ 和/ (/ d/ )/ 图是/ 预处理/ 前后/ 无限/ 方差/ 检验图/ ,/ (/ d/ )/ 图/ 显示/ 随着/ 样本数/ 的/ 增加/ 估计/ 的/ 方差/ 收敛/ ,/ 证明/ 预处/ Page6/ 理后/ 数据/ 二阶/ 统计/ 量/ 存在/ ./ (/ e/ )/ 图/ 和/ (/ f/ )/ 图/ 给出/ 了/ 数据/ 统计/ 柱状图/ ,/ (/ g/ )/ 图/ 和/ (/ h/ )/ 图/ 显示/ 的/ 是/ 预处理/ 前后/ 高斯分布/ 检验图/ ./ 从/ (/ f/ )/ 图/ 和/ (/ h/ )/ 图/ 可以/ 明显/ 地/ 看出/ ,/ 预处理/ 后/ 的/ 数据/ 已/ 基本/ 符合/ 高斯分布/ ./ 将/ LBL/ -/ TCP/ -/ 3/ 流量/ 划分/ 为/ 建立/ 模型/ 所/ 需/ 的/ 学习/ 数据/ 集/ 和/ 预测/ 数据/ 集/ ./ 学习/ 数据/ 集为/ 500/ 个/ 数据/ 点/ ,/ 预测/ 数据/ 集/ 选取/ 为/ 501/ ~/ 7100/ ,/ 预测/ 区间/ 长度/ 为/ 200/ ,/ 一共/ 进行/ 33/ 组/ 实验/ ./ 采用/ NLPP/ 预测/ 方法/ 和表/ 2LBL/ -/ TCP/ -/ 3/ 流量/ 预测/ 误差/ MAPE/ 比较/ NLPP53/ ./ 05753.84345/ ./ 16268.07190/ ./ 60848.39474/ ./ 49666.57276/ ./ 85865.56878/ ./ 891AR/ (/ 3/ )/ 73.55759/ ./ 02453.54995/ ./ 659126.1870/ ./ 467133.15107/ ./ 45100.38102/ ./ 18103.5/ NLPP59/ ./ 47943.3854/ ./ 28156.79360/ ./ 99640.37837/ ./ 5133.97357/ ./ 9452.62647/ ./ 138AR/ (/ 3/ )/ 69.6914974/ ./ 4980.09969/ ./ 36838.19435/ ./ 7335.31458/ ./ 71469.08947/ ./ 694NLPP57/ ./ 86649.82761/ ./ 79960.66160/ ./ 57542.30152/ ./ 44145.08355/ ./ 30847.85653/ ./ 821AR/ (/ 3/ )/ 67.52861/ ./ 95390.69667/ ./ 29568.74344/ ./ 79156.79953/ ./ 12965.73350/ ./ 46971.169/ (/ 2/ )/ 引入/ NLPP/ 的/ 攻击/ 检测/ 算法/ 添加/ 网络流量/ 预测/ 后/ ,/ 要/ 对/ 前面/ 提出/ 的/ 算法/ 进行/ 一定/ 的/ 调整/ ./ 得到/ 当前/ 流量/ 的/ 预测值/ p/ _/ S/ (/ t/ +/ 1/ )/ 后/ 计算/ 其/ 差分/ 方差/ 的/ 预测值/ pvar/ _/ w/ (/ t/ +/ 1/ )/ ,/ 把/ pvar/ _/ w/ (/ t/ +/ 1/ )/ 看作/ var/ _/ w/ (/ t/ +/ 1/ )/ ./ 递推/ 公式/ 改为/ pvar/ _/ w/ (/ t/ +/ 1/ )/ =/ 1p/ _/ S/ (/ t/ +/ 1/ )/ c/ (/ t/ +/ 1/ )/ =/ 0/ ,/ p/ _/ S/ (/ t/ +/ 1/ )/ </ low/ ×/ s/ _/ u/ (/ t/ )/ 烄/ (/ high/ -/ low/ )/ ×/ s/ _/ u/ (/ t/ )/ -/ low/ 烅/ p/ _/ S/ (/ t/ +/ 1/ )/ ∈/ [/ low/ ×/ s/ _/ u/ (/ t/ )/ ,/ high/ ×/ s/ _/ u/ (/ t/ )/ ]/ 1/ ,/ p/ _/ S/ (/ t/ +/ 1/ )/ >/ high/ ×/ s/ _/ u/ (/ t/ 烆/ 用/ pvar/ _/ w/ (/ t/ +/ 1/ )/ 和/ c/ (/ t/ +/ 1/ )/ 代替/ 3.1/ 节/ 检测/ 流程/ 中/ 的/ var/ _/ w/ (/ t/ )/ 和/ c/ (/ t/ )/ ./ 经此/ 修改/ ,/ 在/ 未/ 包含/ 流量/ 短期/ 预测/ 时/ ,/ 如果/ 在/ t/ +/ 1/ 时刻/ 检测/ 到/ 攻击/ ,/ t/ 时刻/ 就/ 可以/ 得到/ t/ +/ 1/ 时刻/ 的/ 相关/ 数据/ ,/ 检测/ 到/ 攻击/ ,/ 从而/ 提前/ 了/ 发现/ 攻击/ 的/ 时间/ ./ 如果/ 采用/ 多/ 步/ 预测/ ,/ 就/ 可以/ 提前/ 更长/ 发现/ 攻击/ 的/ 时间/ ./ 然而/ ,/ 这种/ 发现/ 攻击/ 时刻/ 上/ 的/ 提前/ 不是/ 无/ 限制/ 的/ ./ 一方面/ ,/ 预测/ 步数/ 越/ 多/ ,/ 误差/ 也/ 就/ 越/ 大/ ;/ 另一方面/ ,/ 只有/ 当/ 攻击/ 真正/ 发生/ 时/ ,/ LMS/ 自/ 适应/ AR/ (/ 3/ )/ 模型/ 方法/ 进行/ 预测/ ./ 对比/ 两种/ 预测/ 方法/ 的/ 平均/ 百分比/ 误差/ (/ MeanAbsolutePer/ -/ centageError/ ,/ MAPE/ )/ (/ 如式/ (/ 10/ )/ 所示/ )/ ,/ 结果/ 如表/ 2/ 所示/ ./ NLPP/ 方法/ 取得/ 了/ 明显/ 优于/ LMS/ 自/ 适应/ AR/ (/ p/ )/ 模型/ 的/ 预测/ 结果/ ,/ MAPE/ 误差/ 平均/ 降低/ 了/ 17.6/ %/ ./ 预测/ 结果/ 才/ 对/ 检测/ 是/ 有/ 价值/ 的/ ./ 3.3/ 关键/ 参数/ 的/ 选取/ (/ 1/ )/ low/ 参数/ 从/ 算法/ 的/ 定义/ 可以/ 看出/ low/ 参数/ 直接/ 影响/ 到/ 检测/ 算法/ 中/ 检测/ 的/ 点/ 是不是/ 攻击/ 疑似/ 点/ ./ 因此/ 它/ 的/ 选取/ 是/ 检测/ 算法/ 成功/ 与否/ 的/ 至关重要/ 的/ 一点/ ./ 接下来/ 将/ 根据/ 正常/ 流量/ 分析/ 出/ 网络流量/ 的/ 正常/ 模式/ 帮助/ 确定/ 关键/ 参数/ low/ ./ low/ 参数/ 的/ 大小/ 决定/ 了/ 一个/ 检验/ 点/ 是不是/ 疑似/ 的/ 攻击点/ ,/ low/ 参数/ 选择/ 过/ 小/ 容易/ 产生/ 误报/ 的/ 情况/ ,/ 也/ 就是/ 疑似/ 点/ 增多/ 导致/ 的/ ;/ low/ 参数/ 选择/ 过大则/ 容易/ 产生/ 漏报/ 的/ 情况/ ,/ 因为/ 一些/ 攻击点/ 被/ 认为/ 是/ 正常/ 流量/ 而/ 忽略/ ./ 该/ 检测/ 算法/ 检测/ 的/ 是/ 流量/ 突然/ 增大/ 的/ 情况/ ,/ 因此/ 通过/ 估计/ 正常/ 流量/ 的/ 均值/ ,/ 以及/ 分析/ 正常/ 流量/ 每一/ 时刻/ 和/ 均值/ 之间/ 的/ 关系/ ,/ 就/ 可以/ 发现/ 正常/ 流量/ 的/ 行为/ 模式/ ./ 下面/ 对/ DDoS/ -/ Attack/ -/ Traffic/ 流量/ 进行/ 分析/ ,/ 选取/ 关键/ 参数/ low/ ./ 在/ DDoS/ -/ Attack/ -/ Traffic/ 流量/ 中/ 从/ 1s/ ~/ 549s/ 都/ 是/ 正常/ 通信/ 下/ 产生/ 的/ 网络流量/ ./ 将/ DDoS/ -/ Attack/ -/ Traffic/ 流量/ 1s/ ~/ 549s/ 那段/ 流量/ 进行/ 排序/ ,/ 估计/ 该段/ 流量/ 的/ 均值/ 且/ 计算/ 每一/ 时刻/ 的/ 流量/ 是/ 均值/ 的/ 多少倍/ ,/ 用/ Multy/ (/ t/ )/ (/ 如式/ (/ 13/ )/ 所示/ )/ 表示/ ./ 画出/ Multy/ (/ t/ )/ 的/ 分布图/ ,/ 如图/ 5/ 所示/ ./ 图/ 5/ 中/ 标出/ 的/ 点/ 表示/ 正常/ 流量/ 中/ 的/ 98/ %/ 的/ 单位/ 时间/ 流量/ 值/ 都/ 小于/ 均值/ 的/ 1.1/ 倍/ ,/ 因此/ 如果/ 将/ Page7low/ 参数/ 定为/ 1.1/ ,/ 意味着/ 在/ 检验/ 过程/ 中/ 认为/ 单位/ 时间/ 内/ 超过/ 平均/ 流量/ 1.1/ 倍/ 的/ 流量/ 值/ 是/ 疑似/ 攻击点/ ,/ 同时/ 这些/ 疑似/ 点中/ 包含/ 正常/ 流量/ 的/ 可能性/ 很/ 低/ ,/ 这样/ 可以/ 降低/ 误报率/ ./ 另一方面/ low/ 参数/ 过/ 大会/ 产生/ 漏报/ 的/ 现象/ ,/ 因此/ 在/ 确定/ 了/ low/ 参数/ 的/ 下限/ 之后/ 一般/ 就/ 采用/ 该下/ 限值/ 作为/ low/ 的/ 值/ ,/ 或者/ 略微/ 上调/ low/ 的/ 下/ 限值/ 就/ 作为/ low/ 的/ 参数值/ ,/ 根据/ 经验/ 调整/ 的/ 范围/ 一般/ 在/ 0.05/ ~/ 0.15/ 之间/ ./ (/ 2/ )/ expected/ _/ step/ 参数/ expected/ _/ step/ 参数/ 决定/ 了/ 检测/ 到/ 攻击/ 的/ 时间/ ,/ 当/ 疑似/ 攻击点/ 的/ 个数/ 等于/ expected/ _/ step/ 参数/ 时/ 发出/ 攻击/ 报警/ ./ 因此/ ,/ 当/ expected/ _/ step/ 参数/ 越小/ 检测/ 到/ 攻击/ 的/ 时间/ 越短/ ,/ 但是/ 同时/ 误报/ 的/ 可能性/ 也/ 在/ 增加/ ;/ 另一方面/ ,/ expected/ _/ step/ 参数/ 越大/ 检测/ 到/ 攻击/ 的/ 时间/ 越长/ ,/ 降低/ 误报率/ ./ 但是/ 当/ expected/ _/ step/ 参数值/ 过大/ 的/ 时候/ ,/ 短时间/ 的/ 攻击/ 不会/ 被/ 检测/ 出来/ ,/ 因为/ 检测/ 到/ 的/ 攻击/ 疑似/ 点/ 的/ 个数/ 可能/ 比/ expected/ _/ step/ 参数/ 要/ 小/ ,/ 因此/ 不会/ 报警/ ,/ 发生/ 漏报/ ./ 另外/ ,/ expected/ _/ step/ 参数/ 变化/ 也/ 需要/ 对应/ 改变/ low/ 参数/ ./ 因为/ expected/ _/ step/ 参数/ 变小/ ,/ 意味着/ 更少/ 的/ 攻击/ 疑似/ 点/ 就/ 可以/ 判定/ 有/ 攻击/ 发生/ ,/ 因此/ 制约/ 着/ 攻击/ 疑似/ 点/ 的/ low/ 参数/ 要/ 适当/ 地/ 上调/ ,/ 将/ 判定/ 为/ 攻击/ 疑似/ 点/ 的/ 条件/ 变得/ 更加/ 严格/ 一些/ ,/ 以/ 降低/ 误报率/ ./ 在/ 采用/ 了/ 短期/ 预测/ 算法/ 的/ 检测/ 算法/ 中/ ,/ 虽然/ expected/ _/ step/ 参数/ 与/ 不/ 采用/ 短期/ 预测/ 算法/ 时/ 取值/ 一样/ ,/ 但是/ 由于/ 加入/ 了/ 预测/ 算法/ ,/ 提前/ 计算/ 了/ 一步/ 攻击/ 疑似/ 点/ ,/ 在/ 判断/ 是不是/ 攻击/ 的/ 时候/ 就/ 相当于/ 多/ 提供/ 了/ 一个/ 攻击/ 疑似/ 点/ ,/ 因此/ 加入/ 一步/ 预测值/ 攻击/ 检测/ 算法/ 的/ expected/ _/ step/ 值/ 相当于/ 相同/ 条件/ 下未/ 加入/ 预测/ 方法/ 攻击/ 检测/ 算法/ 的/ expected/ _/ step/ -/ 1/ ./ 在/ 加入/ 预测/ 算法/ 攻击/ 检测/ 算法/ 中/ 的/ low/ 参数值/ 应比/ 未/ 加入/ 预测/ 算法/ 攻击/ 检测/ 算法/ 的/ low/ 参数值/ 略微/ 上调/ ./ 在/ 本文/ 的/ 实验/ 中/ 选取/ expected/ _/ step/ 参数/ 为/ 3.3/ ./ 4/ 复杂性/ 分析/ 本文/ 提出/ 的/ DDoS/ 攻击/ 检测/ 算法/ 是/ 以/ 单位/ 时间/ 为/ 周期/ 来/ 运行/ 检测/ 算法/ ./ 因为/ 检测/ 算法/ 是/ 一个/ 顺序/ 过程/ ,/ 不/ 包含/ 任何/ 循环/ ,/ 所以/ 整个/ 检测/ 算法/ 的/ 时间/ 复杂度/ 是/ T/ (/ n/ )/ =/ O/ (/ n/ )/ ,/ n/ =/ t/ ./ 如果/ 将/ 流量/ 短期/ 预测/ 算法/ NLPP/ 加入/ 到/ 检测/ 算法/ 中/ ,/ 在/ t/ 时刻/ 进行/ 检测/ 之前/ 首先/ 要/ 进行/ 流量/ 预测/ ./ 因为/ 预测/ 过程/ 本身/ 也/ 是/ 顺序/ 的/ ,/ 所以/ 检测/ 算法/ 的/ 时间/ 复杂度/ 仍然/ 是/ T/ (/ n/ )/ =/ O/ (/ n/ )/ ./ 检测/ 算法/ 每/ 一次/ 运行/ 都/ 需要/ 保存/ 一些/ 值以/ 供下/ 一个/ 检测/ 周期/ 使用/ ,/ 例如/ S/ (/ t/ )/ 、/ s/ _/ u/ (/ t/ )/ 、/ var/ _/ w/ (/ t/ )/ 、/ c/ (/ t/ )/ 、/ Attack/ (/ t/ )/ 、/ p/ _/ S/ (/ t/ )/ ,/ 如果/ 将/ 这些/ 值/ 都/ 保存/ 下来/ ,/ 需要/ 的/ 存储空间/ 会/ 线性/ 增加/ ,/ 空间/ 复杂度/ 为/ S/ (/ n/ )/ =/ O/ (/ n/ )/ ./ 然而/ 这些/ 量/ 在/ 以后/ 的/ 计算/ 中/ 并/ 不会/ 用到/ ,/ 这样/ 新/ 的/ 值/ 可以/ 覆盖/ 过期/ 值/ ,/ 空间/ 复杂度/ 降为/ S/ (/ n/ )/ =/ O/ (/ 1/ )/ ./ 4/ 实验/ 结果/ 和/ 讨论/ 4.1/ 基本/ 的/ 检测/ 算法/ (/ 即/ 未/ 引入/ NLPP/ 的/ 检测/ 算法/ )/ 我们/ 选择/ DDoS/ -/ Attack/ -/ Traffic/ 作为/ 实验/ 流量/ ./ 由/ 上面/ 的/ 分析/ 可知/ low/ 参数/ 的/ 下限/ 为/ 1.1/ ,/ 为了/ 验证/ 该/ 下限/ 的/ 正确性/ ,/ 分别/ 选取/ low/ =/ 1.05/ 和/ low/ =/ 1.1/ ,/ 其它/ 参数/ 相同/ ,/ 应用/ 不/ 采用/ 短期/ 预测/ 的/ 检测/ 算法/ 进行/ 实验/ ./ (/ 1/ )/ 选择/ low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ ,/ 得出/ 攻击/ 检测/ 结果/ 如图/ 6/ 和表/ 3/ 所示/ ./ 图/ 6low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ 时/ 的/ 表/ 3/ 犾/ 狅/ 狑/ =/ 1.1/ 、/ 犲/ 狓/ 狆/ 犲/ 犮/ 狋/ 犲/ 犱/ _/ 狊/ 狋/ 犲/ 狆/ =/ 3/ 、/ 犺/ 犻/ 犵/ 犺/ =/ 3.5/ 时/ 的/ 攻击/ 编号/ 起始/ 时刻/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sABCDE/ 根据/ 前面/ 介绍/ 的/ 关键/ 参数/ 选择/ 办法/ 确定/ 的/ low/ 参数/ 和/ expected/ _/ step/ 参数/ 判断/ 出/ 的/ 攻击/ 正确率/ 为/ 100/ %/ ,/ 没有/ 发生/ 漏报/ 和/ 误报/ 的/ 情况/ ./ Page8/ (/ 2/ )/ 选择/ low/ =/ 1.05/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ ,/ 得出/ 攻击/ 检测/ 结果/ 如图/ 7/ 和表/ 4/ 所示/ ./ 图/ 7low/ =/ 1.05/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ 时/ 的/ 表/ 4/ 犾/ 狅/ 狑/ =/ 1.05/ 、/ 犲/ 狓/ 狆/ 犲/ 犮/ 狋/ 犲/ 犱/ _/ 狊/ 狋/ 犲/ 狆/ =/ 3/ 、/ 犺/ 犻/ 犵/ 犺/ =/ 3.5/ 时/ 的/ 攻击/ 编号/ 起始/ 时刻/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // s/ -/ AB/ -/ -/ CDE/ 将/ low/ 参数值/ 改为/ 略/ 小于/ low/ 下/ 限值/ 后/ ,/ 出现/ 了/ 3/ 次/ 误报/ ,/ 证明/ 了/ 3.3/ 节中/ 提出/ 的/ low/ 参数/ 选择/ 办法/ 是/ 有效/ 的/ ./ 4.2/ 引入/ NLPP/ 的/ 检测/ 算法/ 为了/ 与/ 未/ 采用/ 流量/ 预测/ 的/ 基本/ 攻击/ 检测/ 方法/ 进行/ 比较/ ,/ 在/ 相同/ 参数/ 的/ 情况/ 下/ 进行/ 了/ 实验/ ./ 另外/ ,/ 由于/ 加入/ 了/ 1/ 步/ 预测/ 算法/ ,/ 因此/ 适当/ 的/ 增加/ low/ 的/ 值/ ,/ 取/ low/ =/ 1.2/ 再/ 进行/ 了/ 一次/ 实验/ ./ (/ 1/ )/ NLPP/ 流量/ 预测/ 方法/ ①/ 选择/ low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ ,/ 得出/ 的/ 攻击/ 检测/ 结果/ 如图/ 8/ 和表/ 5/ 所示/ ./ 图/ 8low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ 时/ 的/ 表/ 5/ 犾/ 狅/ 狑/ =/ 1.1/ 、/ 犲/ 狓/ 狆/ 犲/ 犮/ 狋/ 犲/ 犱/ _/ 狊/ 狋/ 犲/ 狆/ =/ 3/ 、/ 犺/ 犻/ 犵/ 犺/ =/ 3.5/ 时/ 的/ 攻击/ 编号/ 起始/ 时刻/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sABCDE/ 检测/ 攻击/ 的/ 正确率/ 为/ 100/ %/ ,/ 没有/ 发生/ 漏报/ 和/ 误报/ 的/ 情况/ ,/ 同时/ 检测/ 到/ 攻击/ 的/ 时间/ 也/ 有所/ 提前/ ./ ②/ 选择/ low/ =/ 1.2/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ ,/ 实验/ 结果/ 同参数/ low/ =/ 1.1/ 的/ 情况/ ,/ 见图/ 8/ 和表/ 5/ ./ 对比/ 未/ 加入/ 预测/ 的/ 攻击/ 检测/ 算法/ ,/ 加入/ 预测/ 过程/ 后/ ,/ 正确/ 检测/ 到/ 攻击/ 的/ 时间/ 提前/ ,/ 即/ 延迟/ 缩短/ ./ (/ 2/ )/ LMS/ 自/ 适应/ AR/ 模型/ ①/ 选择/ low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ ,/ 得出/ 的/ 攻击/ 检测/ 结果/ 如图/ 9/ 和表/ 6/ 所示/ ./ 图/ 9low/ =/ 1.1/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ 时/ 的/ 表/ 6/ 犾/ 狅/ 狑/ =/ 1.1/ 、/ 犲/ 狓/ 狆/ 犲/ 犮/ 狋/ 犲/ 犱/ _/ 狊/ 狋/ 犲/ 狆/ =/ 3/ 、/ 犺/ 犻/ 犵/ 犺/ =/ 3.5/ 时/ 的/ 攻击/ 编号/ 起始/ 时刻/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sA/ -/ BCD/ -/ E/ 对比/ 未/ 加入/ 预测/ 的/ 检测/ 算法/ ,/ 检测/ 延迟/ 有所/ 缩短/ ,/ 但是/ 出现/ 了/ 两次/ 误报/ 的/ 情况/ ./ 3.5/ ,/ 得出/ 的/ 攻击/ 检测/ 结果/ 如图/ 10/ 和表/ 7/ 所示/ ./ ②/ 选择/ low/ =/ 1.2/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 图/ 10low/ =/ 1.2/ 、/ expected/ _/ step/ =/ 3/ 、/ high/ =/ 3.5/ 时/ 的/ 表/ 7/ 犾/ 狅/ 狑/ =/ 1.2/ 、/ 犲/ 狓/ 狆/ 犲/ 犮/ 狋/ 犲/ 犱/ _/ 狊/ 狋/ 犲/ 狆/ =/ 3/ 、/ 犺/ 犻/ 犵/ 犺/ =/ 3.5/ 时/ 的/ 攻击/ 编号/ 起始/ 时刻/ // s/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sABCDE/ 在/ 相同/ 参数/ 的/ 条件/ 下/ ,/ 采用/ 两种/ 网络流量/ 预测/ 方法/ 的/ 攻击/ 检测/ 算法/ 实验/ 有着/ 不同/ 的/ 检测/ 精度/ ./ 采用/ AR/ 模型/ 的/ 检测/ 方法/ 由于/ 预测/ 方法/ 精度/ 不高/ ,/ 无/ Page9/ 法为/ 检测/ 过程/ 提供/ 准确/ 网络流量/ 未来/ 信息/ ,/ 因此/ 没有/ 检测/ 出/ 攻击/ C/ ,/ 出现/ 了/ 一次/ 漏报/ ./ 而/ 采用/ NLPP/ 预测/ 方法/ 的/ 检测/ 算法/ 由于/ NLPP/ 预测/ 方法/ 可以/ 提供/ 更加/ 准确/ 的/ 网络流量/ 未来/ 信息/ ,/ 因此/ 有/ 更/ 准确/ 的/ 检测/ 精度/ ./ 4.3/ 与/ 经典/ 检测/ 算法/ 的/ 对比/ 为了/ 对比/ 效果/ 准确/ ,/ 下面/ 实验/ 中/ 的/ 检测/ 数据/ 都/ 使用/ DDoS/ -/ Attack/ -/ Traffic/ ,/ 与/ 前面/ 的/ 实验/ 保持一致/ ./ (/ 1/ )/ 基于/ VTP/ (/ 方差/ -/ 时间/ 图/ )/ 方法/ 的/ DDoS/ 实用/ 基于/ VTP/ 的/ 方法/ [/ 9/ ]/ 来/ 检测/ DDoS/ 攻击/ ,/ 具体/ 检测/ 参数/ 选取/ 为/ :/ 检测/ 窗口/ W/ =/ 400/ ,/ 步长/ step/ =/ 2/ ,/ 聚合度/ m/ =/ 15/ ,/ 检测/ 结果/ 如图/ 11/ 和表/ 8/ 所示/ ./ 时/ 攻击/ 检测/ 图/ 11/ 基于/ VTP/ (/ 方差/ -/ 时间/ 图/ )/ 方法/ 的/ DDoS/ 攻击/ 检测/ 效果/ 图表/ 8/ 基于/ VTP/ (/ 方差/ -/ 时间/ 图/ )/ 方法/ 的/ DDoS/ 攻击/ 检测/ 效果/ 表/ 攻击/ 编号/ 起始/ 时刻/ // s/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sABCDE/ 表/ 104/ 种/ 方法/ 检测/ 效果/ 对比/ 未/ 引入/ 短期/ 预测/ 方法/ 5/ 引入/ 短期/ 预测/ 方法/ 小/ 波/ 分析方法/ 基于/ VTP/ 方法/ 注/ :/ 检到/ 率/ =/ 检测/ 到/ 正确/ 的/ 攻击/ 个数/ // 待/ 检测/ 攻击/ 总数/ ,/ 漏检/ 率/ =/ 1/ -/ 检到/ 率/ ,/ 正确率/ =/ 检测/ 到/ 正确/ 的/ 攻击/ 个数/ // 检测/ 到/ 的/ 攻击/ 总数/ ./ 4.4/ 实验/ 结果/ 小结/ (/ 1/ )/ 参数/ 选择/ 总结/ 通过/ 分析/ 正常/ 流量/ 模式/ ,/ 为/ 检测/ 算法/ 应用/ 于/ 不同/ 网络流量/ 攻击/ 检测/ 提供/ 了/ 选择/ 参数/ 的/ 下限/ ,/ 从而/ 减少/ 了/ 检测/ 算法/ 在/ 使用/ 时/ 的/ 盲目性/ ./ 经过/ 实验/ 证明/ ,/ 该/ 方法/ 是/ 有效/ 的/ ,/ 提供/ 的/ 参数/ 下限/ 降低/ 了/ 检测/ 算法/ 中/ 出现/ 误报/ 的/ 可能性/ ./ 攻击/ 检测/ 算法/ 之间/ 的/ 比较/ (/ 2/ )/ 不/ 采用/ 预测/ 的/ 攻击/ 检测/ 算法/ 与/ 采用/ 预测/ 的/ 采用/ 网络流量/ 预测/ 的/ 攻击/ 检测/ 算法/ 明显/ 地比/ 不/ (/ 2/ )/ 基/ 于小波/ 分析方法/ 的/ DDoS/ 实时/ 攻击/ 检测/ 用基/ 于小波/ 分析/ 的/ 方法/ [/ 10/ ]/ 来/ 检测/ DDoS/ 攻击/ ,/ 具体/ 检测/ 参数/ 选取/ 为/ 检测/ 函数/ 为/ Db3/ ,/ 变换/ 尺度/ scale/ =/ 10/ ,/ 检测/ 窗口/ W/ =/ 400/ ,/ 步长/ step/ =/ 2/ ,/ 检测/ 结果/ 如图/ 12/ 和表/ 9/ 所示/ ./ 图/ 12/ 基/ 于小波/ 分析方法/ 的/ DDoS/ 攻击/ 检测/ 结果/ 图表/ 9/ 基/ 于小波/ 分析方法/ 的/ DDoS/ 攻击/ 检测/ 结果/ 表/ 攻击/ 编号/ 起始/ 时刻/ // s/ 检测/ 到/ 攻击/ 的/ 时刻/ // s/ 延迟/ // sA/ -/ B/ -/ CD/ -/ -/ E/ (/ 3/ )/ 4/ 种/ 方法/ 的/ 检测/ 效果/ 对比/ 4/ 种/ 方法/ 的/ 检测/ 效果/ 对/ 比如/ 表/ 10/ 所示/ ./ 由表/ 10/ 可以/ 看出/ ,/ 小/ 波/ 分析方法/ 具有/ 最小/ 的/ 平均/ 延迟/ ,/ 但是/ 正确率/ 太低/ ,/ 即/ 误报/ 太多/ ./ 而/ 引入/ 短期/ 预测/ 的/ 方法/ ,/ 在/ 较/ 小/ 的/ 延迟/ 下/ ,/ 可以/ 有/ 100/ %/ 的/ 检到/ 率/ 和/ 正确率/ ,/ 其/ 高效/ 的/ 检测/ 效率/ 是/ 很/ 明显/ 的/ ./ 5554/ 采用/ 网络流量/ 预测/ 的/ 攻击/ 检测/ 算法/ 检测/ 到/ 攻击/ 的/ 延迟/ 要/ 短/ ,/ 提高/ 了/ 攻击/ 检测/ 的/ 灵敏度/ ./ 但是/ ,/ 由于/ 预测/ 毕竟/ 会/ 引入/ 误差/ ,/ 如果/ 不/ 适当/ 调整/ low/ 参数/ ,/ 将/ 判定/ 为/ 攻击/ 疑似/ 点/ 的/ 条件/ 变得/ 严格/ 一些/ 的话/ 就/ 会/ 增加/ 误报/ 的/ 次数/ ./ 因此/ 在/ 使用/ 采用/ 网络流量/ 预测/ 的/ 攻击/ 检测/ 算法/ 时/ 通过/ 分析/ 正常/ 流量/ 模式/ 得到/ 的/ low/ 参数/ 的/ 下/ 限值/ 要/ 适当/ 的/ 调整/ 才能/ 在/ 采用/ 流量/ 预测/ 的/ 攻击/ 检测/ 算法/ 中/ 使用/ ./ 间/ 的/ 比较/ (/ 3/ )/ 包含/ 两种/ 流量/ 预测/ 方法/ 的/ 攻击/ 检测/ 算法/ 之/ Page10/ 在/ 相同/ 参数/ 条件/ 下/ ,/ 采用/ NLPP/ 网络流量/ 预测/ 方法/ 比/ 采用/ AR/ 模型/ 预测/ 网络流量/ 时/ 取得/ 的/ 检测/ 效果/ 要/ 好/ ,/ 而且/ 稳定性/ 要/ 高/ 一些/ ./ 主要/ 表现/ 在/ ,/ 采用/ AR/ 模型/ 预测/ 网络流量/ 的/ 检测/ 算法/ 对/ low/ 参数/ 更加/ 敏感/ ,/ 略微/ 改动/ low/ 参数/ 就/ 造成/ 了/ 漏报/ 或者/ 误报/ ./ 而/ 采用/ NLPP/ 预测/ 网络流量/ 的/ 检测/ 算法/ 则/ 没有/ 出现/ 这样/ 的/ 情况/ ./ 究其原因/ ,/ 在/ 基于/ 网络流量/ 的/ 攻击/ 检测/ 算法/ 中/ 引入/ 预测/ 的/ 网络流量/ 意味着/ 为/ 检测/ 算法/ 提供/ 了/ 未来/ 的/ 流量/ 信息/ ,/ 而/ 通过/ 第/ 4/ 节/ 的/ 实验/ 证明/ ,/ NLPP/ 网络流量/ 预测/ 方法/ 比/ 使用/ 时间/ 序列/ 模型/ 方法/ 更加/ 准确/ 地/ 预测/ 了/ 网络流量/ ,/ 因此/ NLPP/ 网络流量/ 预测/ 方法/ 为/ 检测/ 算法/ 提供/ 了/ 更加/ 准确/ 的/ 网络流量/ 未来/ 信息/ ,/ 从而/ 取得/ 了/ 更好/ 的/ 检测/ 效果/ ./ 5/ 结论/ 本文/ 首先/ 分析/ 了/ DDoS/ 攻击/ 发生/ 时/ 网络流量/ 的/ 特点/ ,/ 根据/ 该/ 特点/ 设计/ 了/ 一种/ 基于/ 网络流量/ 突发/ 的/ DDoS/ 攻击/ 检测/ 算法/ ./ 经过/ 实验/ 证明/ 该/ 检测/ 方法/ 可以/ 成功/ 地/ 检测/ 到/ 泛洪/ 型/ DDoS/ 攻击/ ,/ 并且/ 比/ 经典/ 检测/ 算法/ (/ 基于/ VTP/ 的/ 方法/ 和/ 基/ 于小波/ 分析/ 的/ 方法/ )/ 有/ 更好/ 的/ 检测/ 结果/ ./ 为了/ 缩短/ 发现/ 攻击/ 的/ 时间/ ,/ 采取/ 将/ 网络流量/ 短期/ 预测/ 方法/ 与/ 该/ 检测/ 算法/ 相结合/ 的/ 办法/ ,/ 取得/ 了/ 预期/ 的/ 实验/ 结果/ ./ 值得/ 指出/ 的/ 是/ ,/ 为了/ 给/ 检测/ 算法/ 提供/ 更/ 准确/ 的/ 网络流量/ 未来/ 信息/ ,/ 我们/ 在/ 分析/ 时间/ 序列/ 模型/ 预测/ 网络流量/ 局限性/ 的/ 基础/ 上/ 提出/ 了/ 基于/ 非线性/ 预处理/ 网络流量/ 预测/ 方法/ NLPP/ ./ 在/ 文中/ 通过/ 实验/ 证明/ 了/ NLPP/ 预测/ 方法/ 确实/ 能够/ 提供/ 比/ AR/ 模型/ 方法/ 更/ 准确/ 的/ 网络流量/ 未来/ 信息/ ./ 在/ 后续/ 的/ 工作/ 中/ 我们/ 将会/ 在/ 以下/ 两个/ 方面/ 做/ 进一步/ 研究/ :/ 攻击/ 检测/ 算法/ 中/ 的/ 关键/ 参数/ 选取/ 方法/ 仅仅/ 给出/ 了/ 参数/ 的/ 下/ 限值/ ,/ 下/ 限值/ 可以/ 降低/ 检测/ 算法/ 的/ 误报率/ ,/ 但是/ 对于/ 如何/ 选取/ 参数/ 的/ 上/ 限值/ ,/ 减少/ 漏报/ 情况/ 还/ 有待于/ 进一步/ 的/ 研究/ ;/ NLPP/ 网络流量/ 预测/ 方法/ 中/ ,/ 采用/ 的/ 仍旧/ 是/ 短/ 相关/ 模型/ 对/ 网络流量/ 进行/ 预测/ ,/ 可以/ 进一步/ 研究/ 非线性/ 预处理/ 长/ 相关/ 模型/ ./ 

