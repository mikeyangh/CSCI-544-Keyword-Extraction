Page1/ 标准/ 模型/ 下/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 的/ 通用/ 框架/ 魏/ 福山/ 1/ )/ 张振峰/ 2/ )/ 马传贵/ 1/ )/ 1/ )/ (/ 信息工程/ 大学/ 信息/ 工程学院/ 信息/ 研究/ 系/ 郑州/ 450002/ )/ 2/ )/ (/ 中国科学院/ 软件/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 允许/ 用户/ 和/ 网关/ 在/ 服务器/ 的/ 协助/ 下/ 建立/ 起/ 一个/ 共享/ 的/ 会/ 话/ 密钥/ ./ 网关/ 口令/ 协议/ 适用/ 于/ 无线通信/ 环境/ ,/ 如/ GSM/ 和/ 3GPP/ 等/ ./ 已有/ 的/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 大多/ 缺乏/ 严格/ 的/ 安全/ 证明/ ,/ 或者/ 是/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 安全/ 的/ ./ 该文/ 采用/ 模块化/ 的/ 设计/ 方法/ 提出/ 了/ 在/ 标准/ 模型/ 下/ 构造/ 网关/ 口令/ 协议/ 的/ 通用/ 框架/ ./ 通用/ 框架/ 可以/ 实现/ 双向/ 认证/ 并且/ 能够/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 因此/ 具有/ 更强/ 的/ 安全性/ ./ 利用/ DDH/ 假设/ 、/ 二次/ 剩余/ 假设/ 和/ N/ 次/ 剩余/ 假设/ 对/ 通用/ 框架/ 进行/ 实例/ 化/ 可以/ 得到/ 不同/ 的/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 网关/ 口令/ 协议/ ./ 关键词/ 口令/ 认证/ ;/ 网关/ ;/ 平滑/ 投射/ Hash/ 函数/ ;/ 标准/ 模型/ 1/ 引言/ 1.1/ 口令/ 认证/ 密钥/ 交换/ 协议/ 使用/ 一个/ 低/ 熵/ 、/ 人脑/ 可/ 记忆/ 的/ 口令/ 来/ 建立/ 一个/ 安全/ 的/ 会/ 话/ 密钥/ ./ PAKE/ 协议/ 广泛/ 地/ 应用/ 于/ 用户/ 认证/ 和/ 安全/ 通信/ 等/ 实际/ 应用/ 场合/ ,/ 如/ 网上银行/ 和/ 远程/ 用户/ 登录/ ./ 最早/ 的/ PAKE/ 协议/ 是/ 由/ Bellovin/ 和/ Merritt/ [/ 1/ ]/ 口令/ 认证/ 密钥/ 交换/ (/ PAKE/ )/ 协议/ 允许/ 通信/ 方仅/ 提出/ 的/ EKE/ 协议/ ./ EKE/ 协议/ 具有/ 广泛/ 的/ 影响力/ ,/ 是/ Page2/ 后续/ 很多/ 口令/ 协议/ 研究/ 的/ 基础/ [/ 2/ -/ 5/ ]/ ./ 但是/ 上述/ 口令/ 协议/ 只有/ 启发式/ 的/ 安全/ 讨论/ ,/ 缺乏/ 严格/ 的/ 证明/ ./ PAKE/ 协议/ 的/ 安全/ 模型/ 是/ 近期/ 才/ 提出/ 的/ ,/ 之后/ 研究者/ 设计/ 了/ 在/ 随机/ 预言/ 模型/ 或者/ 理想/ 加密/ 模型/ 下/ 可/ 证明/ 安全/ 的/ PAKE/ 协议/ [/ 6/ -/ 7/ ]/ ./ 到/ 目前为止/ ,/ 在/ 标准/ 模型/ 下/ 设计/ PAKE/ 协议/ 的/ 方法/ 还/ 不/ 多/ ./ Katz/ 等/ 人/ [/ 8/ ]/ 提出/ 了/ 第一个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ PAKE/ 协议/ ,/ 即/ 著名/ 的/ KOY/ 协议/ ./ KOY/ 协议/ 是/ 在/ 共同/ 参考/ 串/ (/ CommonReferenceString/ )/ 模型/ 下/ 设计/ 的/ ,/ 需要/ 假设/ 所有/ 的/ 参与者/ 可以/ 访问/ 由/ 一个/ 可信/ 第三方/ 选择/ 的/ 公开/ 参数/ ./ 尽管/ 共同/ 参考/ 串/ 模型/ 比仅用/ 口令/ 来/ 设计协议/ 的/ 假设/ 要强/ ,/ 但是/ 对于/ 实际/ 应用/ 中/ 的/ PAKE/ 协议/ 来说/ 不算/ 一个/ 缺陷/ ,/ 因为/ 在/ 具体/ 应用/ 中/ 可以/ 将/ 公共/ 参数/ 嵌入/ 到/ 用户/ 芯片/ 中/ ./ KOY/ 协议/ 后来/ 被/ Gennaro/ 和/ Lindell/ 进行/ 了/ 概括/ ,/ 他们/ 给出/ 了/ 标准/ 模型/ 下/ PAKE/ 协议/ 的/ 一个/ GL/ 通用/ 框架/ [/ 9/ ]/ ,/ KOY/ 协议/ 可以/ 看作/ GL/ 通用/ 框架/ 的/ 一个/ 特例/ ./ 几乎/ 所有/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ PAKE/ 协议/ 都/ 可以/ 看作/ 是/ 对/ KOY/ // GL/ 框架/ 的/ 扩展/ [/ 10/ -/ 12/ ]/ ./ 唯一/ 的/ 例外/ 是/ 由/ Jiang/ 等/ 人/ [/ 13/ ]/ 利用/ DDH/ 假设/ 设计/ 的/ 标准/ 模型/ 下/ 安全/ 的/ PAKE/ 协议/ ./ 最近/ ,/ Groce/ 等/ 人/ 对/ Jiang/ 等/ 人/ 的/ 协议/ 进行/ 了/ 概括/ 和/ 提升/ ,/ 设计/ 了/ 一个/ 效率/ 很/ 高/ 的/ 标准/ 模型/ 下/ PAKE/ 协议/ 的/ 通用/ 框架/ [/ 14/ ]/ ./ 1.2/ 相关/ 工作/ 在/ 很多/ 实际/ 应用/ 中/ ,/ 服务提供商/ 是/ 由/ 两个/ 实体/ 组成/ 的/ ./ 一个/ 是/ 与/ 用户/ 直接/ 进行/ 会话/ 的/ 网关/ ,/ 另外/ 一个/ 是/ 用于/ 验证/ 用户/ 身份/ 的/ 后/ 端/ 服务器/ ./ 为了/ 刻画/ 这种/ 实际/ 的/ 应用/ 场景/ ,/ Abdalla/ 等/ 人/ [/ 15/ ]/ 提出/ 了/ 网关/ 口令/ 认证/ 密钥/ 交换/ (/ GPAKE/ )/ 协议/ 的/ 概念/ ./ GPAKE/ 协议/ 使得/ 用户/ 和/ 网关/ 在/ 服务器/ 的/ 协助/ 下/ 建立/ 起/ 一个/ 安全/ 的/ 会/ 话/ 密钥/ ./ 用户/ 和/ 服务器/ 共享/ 一个/ 口令/ 用于/ 认证/ ,/ 但是/ 会话/ 密钥/ 是/ 在/ 用户/ 和/ 网关/ 之间/ 建立/ 的/ ./ 除了/ 会话/ 密钥/ 的/ 语义/ 安全性/ 之外/ ,/ GPAKE/ 协议/ 的/ 安全/ 需求/ 还/ 包括/ 针对/ 服务器/ 的/ 密钥/ 私密性/ 和/ 针对/ 恶意/ 网关/ 的/ 口令/ 保护/ ./ 密钥/ 私密性/ 是/ 指会话/ 密钥/ 对于/ 一个/ 知道/ 所有/ 用户/ 口令/ 的/ 、/ 诚实/ 而/ 好奇/ 的/ 服务器/ 来说/ 是/ 不可/ 区分/ 的/ ;/ 口令/ 保护/ 是/ 指/ 恶意/ 网关/ 通过/ 执行/ 协议/ 不能/ 从/ 服务器端/ 得到/ 用户/ 口令/ 的/ 任何/ 信息/ ./ Byun/ 等/ 人/ [/ 16/ ]/ 后来/ 发现/ Abdalla/ 等/ 人/ 的/ GPAKE/ 协议/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ./ 一个/ 恶意/ 的/ 网关/ 可以/ 反复/ 对/ 用户/ 的/ 口令/ 进行/ 猜测/ 并且/ 在/ 服务器端/ 得到/ 验证/ ,/ 直到/ 猜测出/ 正确/ 的/ 口令/ 为止/ ./ 他们/ 还/ 通过/ 对/ 用户/ 发送/ 的/ 密钥/ 材料/ 进行/ MAC/ 认证/ 的/ 方法/ 提出/ 了/ 一个/ 改进/ 的/ 协议/ ./ 但是/ 在/ 2008/ 年/ ,/ Shim/ [/ 17/ ]/ 指出/ Byun/ 等/ 人/ 的/ 改进/ 协议/ 实际上/ 依然/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ Shim/ 通过/ 采用/ 对称/ 加密算法/ 来/ 掩盖/ 口令/ 信息/ 的/ 方法/ 给出/ 了/ 一个/ 改进/ 的/ S/ -/ GPAKE/ 协议/ ./ 在/ 2010/ 年/ ,/ Yoon/ 等/ 人/ [/ 18/ ]/ 指出/ S/ -/ GPAKE/ 协议/ 效率/ 较/ 低/ 并/ 存在/ 设计/ 中/ 的/ 错误/ ./ 他们/ 提出/ 了/ 一个/ 被/ 称为/ 最优/ 的/ O/ -/ GPAKE/ 协议/ ,/ 但/ 该/ 协议/ 缺乏/ 严格/ 的/ 安全/ 证明/ ./ 最近/ ,/ Abdalla/ 等/ 人/ [/ 19/ ]/ 在/ 最早/ 的/ GPAKE/ 协议/ 的/ 基础/ 上/ 设计/ 了/ 一个/ 匿名/ 的/ GPAKE/ 协议/ ,/ 他们/ 提出/ 了/ 一个/ 允许/ 对/ 用户/ 进行/ 腐化/ 的/ 更/ 强/ 的/ 安全/ 模型/ ./ 但是/ 由于/ 匿名性/ 的/ 原因/ ,/ 该/ 协议/ 依然/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ./ 1.3/ 我们/ 的/ 工作/ 本文/ 提出/ 了/ 第一个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ GPAKE/ 协议/ 的/ 通用/ 框架/ ./ 我们/ 采用/ 了/ 可以/ 实现/ 平滑/ 投射/ Hash/ 函数/ 的/ CPA/ 安全/ 的/ 公钥/ 加密算法/ 以及/ CCA/ 安全/ 的/ 带/ 标签/ (/ Labeled/ )/ 的/ 公钥/ 加密算法/ ./ 我们/ 的/ 通用/ 框架/ 具有/ 以下/ 三个/ 方面/ 的/ 优势/ :/ 首先/ ,/ 通用/ 框架/ 是/ 在/ 标准/ 模型/ 下/ 证明/ 安全/ 的/ ,/ 即/ 不/ 需要/ 随机/ 预言/ 或者/ 理想/ 加密/ 的/ 假设/ ;/ 其次/ ,/ 通用/ 框架/ 可以/ 实现/ 双向/ 认证/ 并且/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ./ Abdalla/ 等/ 人/ [/ 15/ ,/ 19/ ]/ 认为/ 他们/ 的/ 协议/ 可以/ 通过/ 用户/ 向/ 服务器/ 增加/ 认证/ 消息/ 的/ 方法/ 来/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ./ 但是/ ,/ 用户/ 发送给/ 服务器/ 的/ 认证/ 消息/ 应该/ 包含/ 一个/ 仅/ 由/ 用户/ 和/ 服务器/ 知道/ 的/ 秘密/ 值/ ,/ 并且/ 不能/ 泄露/ 用户/ 口令/ 的/ 任何/ 信息/ 给/ 网关/ ./ 在/ Abdalla/ 等/ 人/ [/ 15/ ,/ 19/ ]/ 的/ 协议/ 中/ 很/ 难/ 找到/ 满足/ 上述/ 需求/ 的/ 秘密/ 值/ ./ 尽管/ 文献/ [/ 17/ -/ 18/ ]/ 中/ 的/ 协议/ 被/ 声称/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 但是/ 这些/ 协议/ 缺乏/ 严格/ 的/ 安全/ 证明/ 并且/ 效率/ 较/ 低/ ;/ 最后/ ,/ 我们/ 的/ 通用/ 框架/ 采用/ 了/ 一般/ 的/ 密码学/ 组件/ ,/ 如公钥/ 加密/ 体制/ 和/ 平滑/ 投射/ Hash/ 函数/ 簇/ 等/ ./ 我们/ 可以/ 采用/ DDH/ 假设/ 、/ 二次/ 剩余/ 假设/ 和/ N/ 次/ 剩余/ 假设/ 对/ 通用/ 框架/ 进行/ 有效/ 的/ 实例/ 化/ 从而/ 得到/ 不同/ 的/ GPAKE/ 协议/ ./ 特别/ 的/ ,/ 如果/ 我们/ 采用/ CPA/ 安全/ 的/ ElGamal/ 加密算法/ 和/ CCA/ 安全/ 的/ Cramer/ -/ Shoup/ 加密算法/ 对/ 通用/ 框架/ 进行/ 实例/ 化/ ,/ 将/ 得到/ 一个/ 标准/ 模型/ 下/ 高效/ 的/ GPAKE/ 协议/ ./ 与/ 同类/ 的/ 协议/ 相比/ ,/ 我们/ 的/ 协议/ 在/ 相同/ 的/ 效率/ 下/ 具有/ 更/ 高/ 的/ 安全性/ ./ 第/ 2/ 节/ 回顾/ GPAKE/ 协议/ 的/ 安全/ 模型/ ;/ 第/ 3/ 节/ 介绍/ 通用/ 框架/ 用到/ 的/ 一些/ 基础/ 构件/ ;/ 第/ 4/ 节/ 介绍/ GPAKE/ 协议/ 的/ 通用/ 框架/ 并且/ 给出/ 框架/ 的/ 安全性/ 证明/ ;/ 第/ 5/ 节/ 采用/ CPA/ 安全/ 的/ ElGamal/ 加密算法/ 和/ CCA/ 安全/ 的/ Cramer/ -/ Shoup/ 加密算法/ 对/ 通用/ 框架/ 进/ Page3/ 行/ 实例/ 化/ ,/ 并/ 进一步/ 进行/ 效率/ 比较/ ;/ 第/ 6/ 节对/ 全文/ 进行/ 总结/ ./ 2/ 安全/ 模型/ 本/ 节/ 简单/ 介绍/ 由/ Abdalla/ 等/ 人/ 在/ 2005/ 年/ 提出/ 的/ GPAKE/ 协议/ 的/ 安全/ 模型/ ,/ 对于/ 安全/ 模型/ 的/ 详细/ 介绍/ 参见/ 文献/ [/ 15/ ]/ ./ 2.1/ 安全/ 模型/ 协议/ 参与方/ ./ GPAKE/ 协议/ 的/ 参与者/ 由/ 用户/ C/ ∈/ / 、/ 网关/ G/ ∈/ / 以及/ 服务器/ S/ ∈/ / 组成/ ./ 用/ / 表示/ 所有/ 参与者/ 组成/ 的/ 集合/ ,/ 即/ 集合/ / =/ / ∪/ / ∪/ / ./ 用/ U/ ∈/ / 表示/ GPAKE/ 协议/ 中/ 的/ 任意/ 一个/ 参与者/ ./ 通信模型/ ./ 在/ GPAKE/ 协议/ 中/ ,/ 通常/ 假设/ 用户/ 和/ 网关/ 之间/ 的/ 通信/ 是/ 不/ 安全/ 的/ ,/ 通信/ 被/ 敌手/ 完全/ 控制/ ,/ 敌手/ 可以/ 对/ 用户/ 和/ 网关/ 之间/ 传递/ 的/ 消息/ 进行/ 窃听/ 、/ 删除/ 、/ 修改/ 和/ 延迟/ 发送/ 等/ 操作/ ./ 但是/ 网关/ 和/ 服务器之间/ 的/ 信道/ 是/ 认证/ 的/ 私人/ 信道/ ,/ 即/ 敌手/ 无法/ 窃听/ 网关/ 和/ 服务器之间/ 发送/ 的/ 消息/ ,/ 也/ 不能/ 对/ 网关/ 和/ 服务器之间/ 发送/ 的/ 消息/ 进行/ 修改/ ./ 另外/ ,/ 用户/ 无法/ 和/ 服务器/ 直接/ 进行/ 通信/ ,/ 用户/ 和/ 服务器之间/ 的/ 消息/ 必须/ 经过/ 网关/ 进行/ 传递/ ./ 长期/ 密钥/ ./ 每个/ 用户/ C/ ∈/ / 都/ 拥有/ 一个/ 与/ 服务器/ 共享/ 的/ 用于/ 认证/ 的/ 口令/ pwC/ ./ 每个/ 服务器/ S/ ∈/ / 都/ 持有/ 一个/ 口令/ 列表/ pwS/ =/ 〈/ pwC/ 〉/ C/ ∈/ S/ ,/ 其中/ 每条/ 记录/ 对应/ 一个/ 在/ 服务器/ S/ 处/ 进行/ 注册/ 的/ 用户/ C/ 的/ 口令/ pwC/ ./ pwC/ 和/ pwS/ 分别/ 称为/ 用户/ C/ 和/ 服务器/ S/ 的/ 长期/ 密钥/ ./ 敌手/ 能力/ ./ 敌手/ 的/ 攻击能力/ 通过/ 预言/ 询问/ 来/ 刻画/ ./ 在/ 协议/ 执行/ 的/ 过程/ 中/ ,/ 敌手/ 可以/ 针对/ 某个/ 参与者/ 产生/ 多个/ 并行/ 的/ 会/ 话/ 实例/ ./ 用/ Ui/ 来/ 表示/ 用户/ U/ 的/ 第/ i/ 次会话/ 实例/ ./ 敌手/ 可以/ 进行/ 的/ 预言/ 询问/ 有/ 以下/ 几种/ :/ (/ 1/ )/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ./ 此/ 询问/ 模拟/ 敌手/ 进行/ 的/ 被动/ 攻击/ ./ 其中/ 敌手/ 对/ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 之间/ 进行/ 的/ 一次/ 协议/ 执行/ 过程/ 进行/ 窃听/ ./ 对此/ 询问/ 的/ 回答/ 是/ 将/ 本次/ 协议/ 执行/ 过程/ 中/ 用户/ 和/ 网关/ 之间/ 传输/ 的/ 所有/ 消息/ 返回/ 给/ 敌手/ ;/ (/ 2/ )/ Send/ (/ Ui/ ,/ m/ )/ 询问/ ./ 此/ 询问/ 模拟/ 敌手/ 进行/ 的/ 主动攻击/ ./ 其中/ 敌手/ 伪造/ 一个/ 消息/ m/ 并且/ 将/ 消息/ m/ 发送给/ 用户/ 实例/ 或者/ 网关/ 实例/ Ui/ ./ 敌手/ 将/ 得到/ 实例/ Ui/ 在/ 接收/ 到/ 消息/ m/ 后/ 根据/ 协议/ 描述/ 返回/ 的/ 消息/ ;/ (/ 3/ )/ Test/ (/ Ui/ )/ 询问/ ./ 此/ 询问/ 不/ 刻画/ 敌手/ 的/ 攻击能力/ ,/ 只是/ 用来/ 衡量/ 参与者/ 实例/ Ui/ 的/ 会/ 话/ 密钥/ 的/ 语义/ 安全性/ ./ 如果/ 实例/ Ui/ 的/ 会/ 话/ 密钥/ 没有/ 定义/ ,/ 那么/ 返回/ 一个/ 未定义/ 的/ 符号/ ⊥/ ./ 否则/ ,/ 如果/ b/ =/ 1/ 就/ 将/ 真实/ 的/ 会/ 话/ 密钥/ 返回/ 给/ 敌手/ ,/ 如果/ b/ =/ 0/ 则/ 返回/ 一个/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ,/ 其中/ b/ 是/ 在/ 攻击/ 游戏/ 开始运行/ 之前/ 选择/ 的/ 随机/ 比特/ ;/ (/ 4/ )/ TestPair/ (/ Ci/ ,/ Gj/ )/ 询问/ ./ 此/ 询问/ 不/ 刻画/ 敌手/ 的/ 攻击能力/ ,/ 而是/ 用来/ 定义/ 会话/ 密钥/ 对于/ 服务器/ 的/ 密钥/ 私密性/ ./ 如果/ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 之间/ 没有/ 建立/ 共享/ 的/ 会/ 话/ 密钥/ ,/ 那么/ 返回/ 一个/ 未定义/ 的/ 符号/ ⊥/ ./ 否则/ ,/ 如果/ b/ =/ 1/ 就/ 将/ 真实/ 的/ 会/ 话/ 密钥/ 返回/ 给/ 敌手/ ,/ 如果/ b/ =/ 0/ ,/ 则/ 返回/ 一个/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ,/ 其中/ b/ 是/ 在/ 攻击/ 游戏/ 开始运行/ 之前/ 选择/ 的/ 随机/ 比特/ ./ 2.2/ 安全/ 定义/ 本/ 小节/ 给出/ 安全/ 模型/ 中/ 的/ 安全性/ 定义/ ./ 如果/ 一个/ 实例/ 生成/ 会话/ 密钥/ 并且/ 完成/ 协议/ 运行/ ,/ 则/ 称/ 该/ 实例/ 接受/ ./ 我们/ 通过/ 会话/ 标识/ 和/ 伙伴/ 标识/ 来/ 定义/ 伙伴/ ./ 一般/ 定义/ 会话/ 标识/ 为/ 协议/ 执行/ 结束/ 后/ 所有/ 消息/ 的/ 级联/ ./ 一个/ 实例/ Ui/ 实例/ Uj/ 定义/ 1/ (/ 伙伴/ )/ ./ 用户/ 实例/ Ci/ 和/ 网关/ 实例/ Gj/ 被/ 称为/ 伙伴/ ,/ 如果/ :/ (/ 1/ )/ Ci/ 和/ Gj/ 都/ 接受/ ;/ (/ 2/ )/ Ci/ 和/ Gj/ 有/ 相同/ 的/ 会/ 话/ 标识/ ;/ (/ 3/ )/ Ci/ 的/ 伙伴/ 标识/ 为/ Gj/ ,/ 反之亦然/ ;/ (/ 4/ )/ 除了/ Ci/ 和/ Gj/ 外/ ,/ 不/ 存在/ 其它/ 接受/ 实例/ 的/ 伙伴/ 标识/ 为/ Ci/ 或/ Gj/ ./ 敌手/ 只能/ 对/ 新鲜/ 的/ 实例/ 进行/ Test/ 询问/ ,/ 否则/ 敌手/ 可以/ 轻易/ 赢得/ 攻击/ 游戏/ ./ 新鲜/ 性/ 定义/ 就是/ 为了/ 防止/ 敌手/ 可以/ 通过/ 平凡/ 的/ 方式/ 赢得/ 攻击/ 游戏/ ./ 定义/ 2/ (/ 新鲜/ 性/ )/ ./ 一个/ 用户/ 实例/ Ci/ 或者/ 网关/ 实例/ Gj/ 是/ 新鲜/ 的/ ,/ 如果/ 该/ 实例/ 接受/ 协议/ 运行/ 并且/ 生成/ 了/ 会/ 话/ 密钥/ ./ 在/ Abdalla/ 等/ 人/ 的/ 安全/ 模型/ 中有/ 3/ 个/ 安全/ 目标/ ,/ 包括/ 语义/ 安全性/ 、/ 密钥/ 私密性/ 和/ 口令/ 保护/ ./ 其中/ 会话/ 密钥/ 的/ 语义/ 安全性/ 保证/ 了/ 一个/ 外部/ 敌手/ 不/ 能够/ 区分/ 真实/ 的/ 会/ 话/ 密钥/ 和/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ;/ 针对/ 服务器/ 的/ 密钥/ 私密性/ 要求/ 用户/ 和/ 网关/ 之间/ 建立/ 的/ 会/ 话/ 密钥/ 对于/ 诚实/ 而/ 好奇/ 的/ 服务器/ 是/ 不可/ 区分/ 的/ ;/ 针对/ 网关/ 的/ 口令/ 保护/ 是/ 指/ 恶意/ 网关/ 通过/ 协议/ 运行/ 不能/ 得到/ 用户/ 口令/ 的/ 任何/ 信息/ ./ 下面/ 我们/ 分别/ 给出/ 这/ 三个/ 安全/ 目标/ 的/ 严格/ 定义/ ./ 考虑/ 一个/ 对/ GPAKE/ 协议/ / 进行/ 攻击/ 的/ 敌手/ / ,/ 给/ 敌手/ 提供/ Execute/ ,/ Send/ 询问/ 以及/ 对/ 新鲜/ 会话/ 进行/ 多次/ Test/ 询问/ 的/ 能力/ ./ 敌手/ 的/ 目标/ 是/ 猜测/ Test/ 询问/ 中/ 所/ 使用/ 的/ 随机/ 比特/ b/ ./ 我们/ 用/ Succ/ 来/ 表示/ 敌/ Page4/ 手/ 成功/ 猜测到/ b/ 这一/ 事件/ ./ 定义/ 3/ (/ 语义/ 安全/ )/ ./ 当/ 口令/ 是从/ 字典/ 空间/ / 中/ 随机/ 选择/ 的/ 时候/ ,/ 定义/ 敌手/ / 攻破/ GPAKE/ 协议/ / 的/ 语义/ 安全/ 的/ 优势/ 为/ Advake/ -/ ror/ 定义/ GPAKE/ 协议/ / 的/ 语义/ 安全/ 的/ 优势/ 函数/ 为/ 上式/ 中/ 的/ 最大值/ 遍历/ 所有/ 计算/ 时间/ 至多/ 为/ t/ ,/ 消耗/ 的/ 资源/ (/ 询问/ 不同/ 预言/ 的/ 次数/ )/ 至多/ 为/ R/ 的/ 敌手/ ./ 如果/ 一个/ GPAKE/ 协议/ / 语义/ 安全/ 的/ 优势/ 函数/ / ,/ / (/ t/ ,/ R/ )/ 至多/ 比/ kn/ // / 大/ 一个/ 可/ 忽略/ 的/ 量/ ,/ Advake/ -/ ror/ 那么/ 称/ GPAKE/ 协议/ / 是/ 语义/ 安全/ 的/ ,/ 其中/ n/ 是/ 敌手/ 进行/ 主动攻击/ 的/ 次数/ ,/ / 表示/ 字典/ 空间/ 的/ 规模/ ,/ k/ 是/ 一个/ 常数/ ./ 一般/ k/ =/ 1/ 是/ 最优/ 的/ 结果/ ,/ 因为/ 每次/ 敌手/ 进行/ 主动攻击/ 至少/ 可以/ 排除/ 一个/ 错误/ 的/ 口令/ ./ 考虑/ 一个/ 对/ GPAKE/ 协议/ / 进行/ 攻击/ 的/ 敌手/ / ,/ 给/ 敌手/ 提供/ 所有/ 用户/ 的/ 口令/ ,/ Execute/ 询问/ 以及/ 对/ 伙伴/ 会话/ 进行/ TestPair/ 询问/ 的/ 能力/ ./ 敌手/ 的/ 目标/ 是/ 猜测/ TestPair/ 询问/ 中/ 所/ 使用/ 的/ 随机/ 比特/ b/ ./ 我们/ 用/ Succ/ 来/ 表示/ 敌手/ 成功/ 猜测到/ b/ 这一/ 事件/ ./ 定义/ 4/ (/ 密钥/ 私密性/ )/ ./ 当/ 口令/ 是从/ 字典/ 空间/ / 中/ 随机/ 选择/ 的/ 时候/ ,/ 定义/ 敌手/ / 攻破/ GPAKE/ 协议/ / 的/ 密钥/ 私密性/ 的/ 优势/ 为/ Advake/ -/ kp/ 定义/ GPAKE/ 协议/ / 的/ 密钥/ 私密性/ 的/ 优势/ 函数/ 为/ 上式/ 中/ 的/ 最大值/ 遍历/ 所有/ 计算/ 时间/ 至多/ 为/ t/ ,/ 消耗/ 的/ 资源/ (/ 询问/ 不同/ 预言/ 的/ 次数/ )/ 至多/ 为/ R/ 的/ 敌手/ ./ 称/ 一个/ GPAKE/ 协议/ / 实现/ 了/ 密钥/ 私密性/ ,/ 如果/ 其/ 密钥/ 私密性/ 安全/ 的/ 优势/ 函数/ Advake/ -/ kp/ 相对/ 于/ 安全/ 参数/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 考虑/ 一个/ 恶意/ 的/ 网关/ / 猜测/ 用户/ 的/ 口令/ ,/ 然后/ 通过/ 与/ 服务器/ 执行/ 协议/ 来/ 验证/ 口令/ 是否/ 正确/ ./ 如果/ 一个/ 错误/ 的/ 猜测/ 没有/ 被/ 服务器/ 检测/ 到/ ,/ 则/ 认为/ 恶意/ 的/ 网关/ / 成功/ ./ 我们/ 用/ Advake/ -/ uoda/ 网关/ / 成功/ 的/ 优势/ ./ 定义/ 5/ (/ 口令/ 保护/ )/ ./ 称/ 一个/ GPAKE/ 协议/ / 实现/ 了/ 对/ 恶意/ 网关/ 的/ 口令/ 保护/ ,/ 如果/ 恶意/ 的/ 网关/ / 成功/ 的/ 优势/ Advake/ -/ uoda/ 略/ 的/ 量/ ,/ 其中/ n/ 是/ 敌手/ 进行/ 主动攻击/ 的/ 次数/ ,/ / 表示/ 字典/ 空间/ 的/ 规模/ ,/ k/ 是/ 一个/ 常数/ ./ 3/ 密码学/ 组件/ 本/ 节/ 介绍/ 在/ 通用/ 框架/ 设计/ 和/ 证明/ 中/ 需要/ 用到/ 的/ 密码学/ 组件/ ./ 首先/ 给出/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 的/ 定义/ ,/ 然后/ 介绍/ 平滑/ 投射/ Hash/ 函数/ 的/ 概念/ ./ 3.1/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 带/ 标签/ 的/ 加密/ 体制/ (/ LabeledEncryption/ )/ 最初/ 是/ 由/ ISO18033/ -/ 2/ 标准/ 正式/ 提出/ 的/ [/ 20/ ]/ ,/ 与/ 通常/ 的/ 加密/ 体制/ 的/ 定义/ 不同/ 的/ 地方/ 在于/ ,/ 在/ 带/ 标签/ 的/ 加密/ 体制/ 中/ ,/ 加密算法/ 和/ 解密/ 算法/ 都/ 有/ 一个/ 额外/ 的/ 被/ 称为/ 标签/ 的/ 参数/ ,/ 并且/ 解密/ 算法/ 只有/ 在/ 输入/ 的/ 标签/ 跟/ 加密/ 时/ 的/ 标签/ 相同/ 时/ 才能/ 正确/ 解密/ ./ 一个/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ LPKE/ =/ (/ LKG/ ,/ Enc/ ,/ Dec/ )/ 一般/ 由/ 以下/ 3/ 个/ 算法/ 组成/ :/ 参数/ 生成/ 算法/ LKG/ :/ 输入/ 安全/ 参数/ n/ ,/ 通过/ 参数/ 生成/ 算法/ LKG/ (/ 1n/ )/ 产生/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 的/ 公私/ 钥对/ (/ pk/ ,/ sk/ )/ ;/ 加密算法/ Enc/ :/ 输入/ 为/ 消息/ m/ ,/ 标签/ l/ ,/ 加密/ 时/ 的/ 公钥/ pk/ 以及/ 随机/ 输入/ r/ ,/ 通过/ 加密算法/ c/ =/ Encl/ 产生/ 对应/ 的/ 密文/ c/ ;/ 解密/ 算法/ Dec/ :/ 输入/ 为/ 密文/ c/ ,/ 标签/ l/ 以及/ 解密/ 的/ 私钥/ sk/ ,/ 通过/ 解密/ 算法/ m/ =/ Declsk/ (/ c/ )/ 恢复/ 出/ 明文/ m/ ./ 下面/ 给出/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 的/ 不可/ 区分/ CCA/ 安全性/ 的/ 定义/ ./ 定义/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 不可/ 区分/ CCA/ 安全/ 的/ 攻击/ 游戏/ 与/ 定义/ 一般/ 公钥/ 加密/ 体制/ 不可/ 区分/ CCA/ 安全/ 的/ 攻击/ 游戏/ 类似/ ./ 攻击/ 游戏/ 开始/ ,/ 首先/ 对/ 敌手/ 进行/ 第/ 1/ 阶段/ 的/ 解密/ 培训/ ,/ 此时/ 敌手/ 可以/ 选择/ 密文/ // 标签/ 对/ (/ c/ ,/ l/ )/ 要求/ 解密/ 预言/ 机/ 进行/ 解密/ 服务/ ./ 在/ 挑战/ 密文/ 生成/ 阶段/ ,/ 当/ 敌手/ 进行/ 挑战/ 密文/ 询问/ 的/ 时候/ ,/ 除了/ 要/ 输入/ 两个/ 等长/ 的/ 消息/ (/ m0/ ,/ m1/ )/ 外/ ,/ 还/ 需要/ 提供/ 一个/ 标签/ l/ 作为/ 额外/ 的/ 输入/ ./ 当/ 敌手/ 接收/ 到/ 挑战/ 密文/ C/ / 的/ 时候/ ,/ 需要/ 判断/ 挑战/ 密文/ C/ / 是/ 由/ 消息/ m0/ 和/ 标签/ l/ 加密/ 产生/ ,/ 还是/ 由/ 消息/ m1/ 和/ 标签/ l/ 加密/ 产生/ 的/ ./ 此时/ 敌手/ 可以/ 继续/ 进行/ 第/ 2/ 阶段/ 的/ 解密/ 培训/ ,/ 敌手/ 除了/ 密文/ // 标签/ 对/ (/ c/ / ,/ l/ )/ 外/ ,/ 可以/ 对/ 任意/ 的/ 密文/ // 标签/ 对/ 进行/ 解密/ 询问/ ./ 最终/ ,/ 敌手/ 输出/ 其/ 对/ 挑战/ 密文/ 的/ 猜测/ ./ 敌手/ 的/ 优势/ 函数/ 的/ 定义/ 与/ 普通/ 的/ 公钥/ 加密/ 体制/ 中/ 敌手/ 的/ 优势/ 定义/ 相同/ ./ 如果/ 敌手/ 的/ 优势/ 是/ 关于/ 安全/ 参数/ 的/ 可/ 忽略/ 的/ 函数/ ,/ 那么/ 我们/ 说/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 是/ 不可/ 区分/ CCA/ 安全/ 的/ ,/ 简称/ 为/ CCA/ 安全/ ./ 对于/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ 的/ 详细/ 定义/ 可/ 参见/ 文献/ [/ 20/ -/ 21/ ]/ ./ 3.2/ 平滑/ 投射/ Hash/ 函数/ 簇/ 平滑/ 投射/ Hash/ 函数/ 簇/ 可以/ 看作/ 是/ 有/ 两类/ 密钥/ 的/ Hash/ 函数/ ,/ 其中/ 一类/ 密钥/ 称为/ 全局/ 密钥/ ,/ 可以/ 用来/ 计算/ 平滑/ 投射/ 函数/ 整个/ 定义域/ 上/ 所有/ 输入/ 的/ 对应/ 输出/ ,/ 还有/ 一类/ 密钥/ 称为/ 投射/ 密钥/ ,/ 由/ 全局/ 密钥/ 通过/ 投射/ 函数/ 计算/ 得到/ ,/ 投射/ 密钥/ 只能/ 计算/ 平滑/ 投射/ 函/ Page5/ 数/ 定义域/ 的/ 一个/ 子集/ 对应/ 的/ 函数/ 值/ ./ 平滑/ 投射/ Hash/ 函数/ 之所以/ 被/ 广泛应用/ 于/ 口令/ 协议/ 的/ 设计/ 当中/ ,/ 主要/ 原因/ 是/ 对于/ 投射/ 密钥/ 能够/ 计算/ 的/ 那个/ 特定/ 子集/ 上面/ 的/ 输出/ ,/ 可以/ 通过/ 全局/ 密钥/ 和/ 投射/ 密钥/ 两种/ 不同/ 的/ 方式/ 来/ 计算/ 出/ 相同/ 的/ 函数/ 值/ ,/ 这样/ 使得/ 协议/ 执行/ 的/ 双方/ 在/ 实现/ 认证/ 的/ 同时/ 还/ 能/ 产生/ 共同/ 的/ 秘密/ 值/ 作为/ 会话/ 密钥/ ./ 而/ 对于/ 特定/ 子集/ 之外/ 的/ 函数/ 值/ ,/ 仅仅/ 知道/ 投射/ 密钥/ 不会/ 泄露/ 该/ 函数/ 值/ 的/ 任何/ 信息/ ./ 实际上/ ,/ 投射/ 密钥/ 和/ 特定/ 子集/ 之外/ 的/ 函数/ 值/ 是/ 统计/ 独立/ 的/ ./ 现在/ 给出/ 基于/ CPA/ 安全/ 的/ 公钥/ 加密/ 体制/ 构造/ 的/ 平滑/ 投射/ Hash/ 函数/ 簇/ 的/ 严格/ 定义/ 以及/ 相应/ 的/ 性质/ ./ 给定/ 一个/ CPA/ 安全/ 的/ 公钥/ 加密/ 体制/ (/ Gen/ ,/ Enc/ ,/ Dec/ )/ 和/ 一个/ 消息/ 空间/ / (/ 对应/ 于/ 通用/ 框架/ 中/ 的/ 口令/ 空间/ )/ ./ 设/ (/ pk/ ,/ sk/ )/ 是/ 由密钥/ 生成/ 函数/ Gen/ (/ 1n/ )/ 在/ 输入/ 安全/ 参数/ n/ 时/ 产生/ 的/ ,/ 我们/ 用/ Ω/ 表示/ 对于/ 公钥/ pk/ 的/ 有效/ 的/ 密文/ 集合/ ./ 定义/ 集合/ X/ =/ {/ (/ ω/ ,/ m/ )/ |/ ω/ ∈/ Ω/ ;/ m/ ∈/ / }/ ,/ 集合/ Lm/ =/ {/ (/ ω/ ,/ m/ )/ |/ Decsk/ (/ ω/ )/ =/ m/ }/ / X/ 以及/ 集合/ L/ =/ ∪/ m/ ∈/ / 个/ 消息/ m/ ∈/ / 使得/ (/ ω/ ,/ m/ )/ ∈/ L/ ./ 一个/ 平滑/ 投射/ Hash/ 函数/ 是/ 由/ 一个/ 有效/ 的/ 采样/ 算法/ 来/ 定义/ 的/ ./ 在/ 给定/ 公钥/ pk/ 的/ 情况/ 下/ ,/ 输出/ 以下/ 的/ 函数/ 组/ (/ K/ ,/ / =/ {/ Hk/ :/ X/ →/ (/ 0/ ,/ 1/ )/ n/ }/ k/ ∈/ K/ ,/ S/ ,/ α/ :/ K/ ×/ Ω/ →/ S/ )/ 满足/ :/ (/ 1/ )/ 存在/ 有效/ 的/ 算法/ 可以/ 对/ 密钥/ 空间/ K/ 进行/ 均匀/ 采样/ k/ ∈/ K/ ;/ 对于/ 给定/ 的/ 全局/ 密钥/ k/ ∈/ K/ 和/ 定义域/ 中/ 的/ 元素/ x/ ∈/ X/ ,/ 存在/ 有效/ 的/ 算法/ 计算/ 平滑/ 投射/ 函数/ 的/ 输出/ Hk/ (/ x/ )/ ;/ 给定/ 任意/ 的/ 全局/ 密钥/ k/ ∈/ K/ 和/ 密文/ 空间/ 中/ 的/ 任意/ 元素/ ω/ ∈/ Ω/ ,/ 存在/ 有效/ 的/ 算法/ 计算/ 投射/ 密钥/ α/ (/ k/ ,/ ω/ )/ ./ (/ 2/ )/ 对于/ x/ =/ (/ ω/ ,/ m/ )/ ∈/ L/ ,/ 函数/ 值/ Hk/ (/ x/ )/ 完全/ 由/ α/ (/ k/ ,/ ω/ )/ 确定/ ./ 即/ 存在/ 一个/ 有效/ 的/ 算法/ H/ 在/ 输入/ s/ =/ α/ (/ k/ ,/ ω/ )/ 和/ x/ -/ =/ (/ ω/ ,/ m/ ,/ r/ )/ 满足/ H/ (/ s/ ,/ x/ -/ )/ =/ Hk/ (/ x/ )/ ,/ 其中/ r/ 是/ 对/ 消息/ m/ 进行/ 加密/ 时/ 的/ 随机/ 输入/ ,/ 即/ ω/ =/ Encpk/ (/ m/ ;/ r/ )/ ./ (/ 3/ )/ 对于/ 任意/ 的/ x/ =/ (/ ω/ ,/ m/ )/ ∈/ X/ \/ L/ ,/ 下面/ 的/ 两个/ 分布/ {/ k/ ←/ K/ ;/ s/ =/ α/ (/ k/ ,/ ω/ )/ ,/ v/ ←/ {/ 0/ ,/ 1/ }/ n/ :/ (/ s/ ,/ v/ )/ }/ 以及/ {/ k/ ←/ K/ ;/ s/ =/ α/ (/ k/ ,/ ω/ )/ :/ (/ s/ ,/ Hk/ (/ x/ )/ )/ }/ 是/ 统计/ 不可/ 区分/ 的/ ./ 上面/ 定义/ 中/ 的/ 第/ 2/ 条/ 性质/ 被/ 称为/ 平滑/ 投射/ Hash/ 函数/ 的/ 正确性/ ,/ 第/ 3/ 条/ 性质/ 一般/ 被/ 称为/ 平滑/ 性/ ./ 对于/ 平滑/ 投射/ Hash/ 函数/ 的/ 详细/ 定义/ 可/ 参见/ 文献/ [/ 14/ ]/ ./ 4/ 网关/ 口令/ 协议/ 的/ 通用/ 框架/ 本/ 节/ 给出/ 网关/ 口令/ 协议/ 的/ 通用/ 框架/ ,/ 并/ 对/ 其/ 安全性/ 进行/ 证明/ ./ 4.1/ 通用/ 框架/ 描述/ GPAKE/ 协议/ 的/ 通用/ 框架/ 是/ 在/ 共同/ 参考/ 串/ 模型/ 下/ 设计/ 的/ ./ 在/ 共同/ 参考/ 串/ 模型/ 中/ ,/ 假设/ 所有/ 的/ 用户/ 都/ 可以/ 获取/ 从/ 一个/ 预先/ 给定/ 的/ 分布/ 中/ 选择/ 的/ 公共/ 参数/ ./ 在/ 我们/ 的/ 构造/ 中/ 用到/ 了/ 一个/ CPA/ 安全/ 的/ 公钥/ 加密/ 体制/ Σ/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ )/ 和/ 一个/ CCA/ 安全/ 的/ 带/ 标签/ 的/ 公钥/ 加密/ 体制/ Σ/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ )/ ,/ 并且/ 要求/ 可以/ 通过/ CPA/ 安全/ 的/ 加密/ 体制/ Σ/ 定义/ 平滑/ 投射/ Hash/ 函数/ 簇/ (/ K/ ,/ / =/ {/ Hk/ :/ X/ →/ (/ 0/ ,/ 1/ )/ n/ }/ k/ ∈/ K/ ,/ S/ ,/ α/ :/ K/ ×/ Ω/ →/ S/ )/ ./ 设/ 安全/ 参数/ 为/ n/ ,/ 设/ Gq/ 是/ 一个/ 阶为/ 大/ 素数/ q/ 的/ 循环群/ ,/ g/ 为/ Gq/ 的/ 一个/ 生成元/ ./ 我们/ 设计/ 的/ GPAKE/ 协议/ 的/ 通用/ 框架/ 中/ 所/ 使用/ 的/ 共同/ 参考/ 串/ 的/ 公共/ 参数/ 包括/ 两个/ 加密/ 体制/ 对应/ 的/ 公钥/ pk/ ,/ pk/ 以及/ 对群/ Gq/ 的/ 描述/ (/ Gq/ ,/ g/ ,/ q/ )/ ./ 需要/ 说明/ 的/ 是/ ,/ 在/ 共同/ 参考/ 串/ 模型/ 中/ ,/ 任何人/ 都/ 不/ 知道/ 加密/ 体制/ 的/ 公钥/ pk/ ,/ pk/ 对应/ 的/ 私钥/ sk/ ,/ sk/ ./ GPAKE/ 协议/ 的/ 通用/ 框架/ 的/ 参与者/ 由/ 用户/ 、/ 网关/ 和/ 服务器/ 组成/ ./ 假设/ 用户/ 和/ 服务器之间/ 共享/ 一个/ 从/ 口令/ 字典/ 空间/ / 中/ 选择/ 的/ 口令/ pw/ ,/ 并且/ 网关/ 和/ 服务器之间/ 存在/ 认证/ 通道/ ./ GPAKE/ 协议/ 的/ 通用/ 框架/ 的/ 描述/ 在/ 图/ 1/ 中/ 给出/ ,/ 具体/ 的/ 执行/ 步骤/ 如下/ :/ 1/ ./ 用户/ C/ 选择/ 一个/ 随机数/ x/ ∈/ Z/ / q/ 并/ 计算/ X/ =/ gx/ ./ 然后/ 用户/ 从/ {/ 0/ ,/ 1/ }/ n/ 中/ 选择/ 一个/ 随机数/ r/ ,/ 计算/ 利用/ CPA/ 安全/ 的/ 加密/ 体制/ Σ/ 对/ 口令/ pw/ 进行/ 加密/ 的/ 密文/ ω/ =/ Encpk/ (/ pw/ ;/ r/ )/ ,/ 最后/ 发送/ 消息/ (/ C/ ,/ X/ ,/ ω/ )/ 给/ 网关/ G/ ./ 的/ 合法性/ ,/ 然后/ 将/ 消息/ (/ G/ ,/ s/ ,/ ω/ ,/ Y/ )/ 发送给/ 用户/ ./ 5/ ./ 用户/ C/ 接收/ 到/ 消息/ (/ G/ ,/ s/ ,/ ω/ ,/ Y/ )/ 后/ ,/ 首先/ 通过/ 投射/ 密钥/ s/ ,/ 口令/ pw/ 以及/ 在/ 第一轮/ 生成/ 密文/ ω/ 时/ 的/ 随机/ 输入/ r/ 来/ 计算/ 平滑/ 投射/ Hash/ 函数/ 的/ 值/ ,/ 即/ 用户/ 计算/ r/ / τ/ / 1/ τ/ / 2/ =/ H/ (/ s/ ,/ ω/ ,/ pw/ ,/ r/ )/ ,/ 然后/ 验证/ ω/ 是否/ 等于/ Enclabel/ 如果/ 验证/ 通过/ ,/ 那么/ 用户/ 接受/ 协议/ 并且/ 计算/ 会话/ 密钥/ K/ =/ Yx/ =/ gxy/ ;/ 否则/ ,/ 用户/ 终止/ 协议/ 运行/ ./ 最后/ ,/ 用户/ 发送/ 2/ ./ 网关/ G/ 接收/ 到/ 消息/ (/ C/ ,/ X/ ,/ ω/ )/ 后/ ,/ 随机/ 选择/ y/ ∈/ Z/ / q/ 并且/ 计算/ Y/ =/ gy/ ,/ 然后/ 将/ Y/ 连同/ 接收/ 到/ 的/ 消息/ 一起/ 发送给/ 服务器/ S/ ./ 3/ ./ 服务器/ S/ 接收/ 到/ 网关/ 发送/ 的/ 消息/ (/ C/ ,/ X/ ,/ Y/ ,/ ω/ )/ 后/ ,/ 首先/ 随机/ 选择/ 全局/ 密钥/ k/ ∈/ K/ ,/ 并/ 计算/ 投射/ 密钥/ s/ =/ α/ (/ k/ ,/ ω/ )/ ./ 然后/ 服务器/ 利用/ 口令/ pw/ 和/ 全局/ 密钥/ k/ 计算/ 平滑/ 投射/ Hash/ 函数/ 的/ 值/ Hk/ (/ ω/ ,/ pw/ )/ ,/ 并且/ 将/ 结果/ 分为/ 三个/ 随机/ 比特/ 串/ r/ τ/ 1/ τ/ 2/ ,/ 其中/ τ/ 1/ 和/ τ/ 2/ 的/ 长度/ 至少/ 为/ n/ ,/ 并且/ r/ 有/ 足够/ 的/ 长度/ 作为/ CCA/ 加密/ 体制/ Σ/ 的/ 随机/ 输入/ ./ 服务器/ 定义/ 标签/ label/ =/ CGS/ ω/ sXY/ 并且/ 用带/ 标签/ 的/ 加密/ 体制/ 计算/ 对/ 口令/ pw/ 加密/ 的/ 密文/ ω/ =/ Enclabel/ 后/ ,/ 服务器发送/ 消息/ (/ s/ ,/ ω/ ,/ τ/ 1/ )/ 给/ 网关/ ./ 4/ ./ 网关/ 接收/ 到/ 消息/ (/ s/ ,/ ω/ ,/ τ/ 1/ )/ 后/ ,/ 储存/ τ/ 1/ 用来/ 验证/ 用户/ Page6/ (/ C/ ,/ τ/ / 1/ ,/ τ/ / 2/ )/ 给/ 网关/ ./ 6/ ./ 网关/ 接收/ 到/ 消息/ (/ C/ ,/ τ/ / 1/ ,/ τ/ / 2/ )/ 后/ ,/ 首先/ 验证/ τ/ 1/ 是否/ 等于/ τ/ / 1/ ./ 如果/ 验证/ 通过/ ,/ 则/ 说明/ 用户/ 是/ 合法/ 的/ ,/ 那么/ 网关/ 接受/ 协议/ 运行/ 并/ 生成/ 会话/ 密钥/ K/ =/ Xy/ =/ gxy/ ;/ 否则/ ,/ 网关/ 拒绝/ 协议/ 运行/ 并/ 终止/ ./ 最后/ ,/ 网关/ 发送/ 消息/ (/ C/ ,/ τ/ / 2/ )/ 给/ 服务器/ ./ 服务器/ 通过/ 图/ 1GPAKE/ 协议/ 的/ 通用/ 框架/ 4.2/ 安全性/ 证明/ 本/ 小节/ 给出/ 对/ GPAKE/ 协议/ 的/ 通用/ 框架/ 的/ 安全性/ 证明/ ,/ 证明/ 主要/ 基于/ DDH/ 假设/ 、/ 框架/ 中/ 所/ 使用/ 的/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ 以及/ 公钥/ 加密/ 体制/ Σ/ 的/ CCA/ 安全性/ ./ 下面/ 给出/ DDH/ 假设/ 的/ 定义/ ./ DDH/ 假设/ ./ 假设/ Gq/ 为阶为/ 素数/ q/ 的/ 循环群/ ,/ g/ 为/ Gq/ 的/ 一个/ 生成元/ ./ 假设/ / ddh/ 是/ 一个/ 概率/ 多项式/ 时间/ 的/ 敌手/ ,/ 模拟/ 者/ 首先/ 随机/ 选择/ u/ ,/ v/ ,/ w/ ∈/ Zq/ ,/ 并且/ 计算/ U/ =/ gu/ ,/ V/ =/ gv/ 和/ W/ =/ gw/ ,/ 然后/ 随机/ 选择/ 一个/ 比特/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 如果/ b/ =/ 1/ ,/ 那么/ 将/ (/ gu/ ,/ gv/ ,/ guv/ )/ 给/ 敌手/ ,/ 否则/ 将/ (/ gu/ ,/ gv/ ,/ gw/ )/ 给/ 敌手/ ./ 敌手/ 需要/ 猜测/ 随机/ 比特/ b/ 的/ 值/ ,/ 如果/ 敌手/ 猜测/ 正确/ 就/ 认为/ 敌手/ 成功/ ,/ 记此/ 事件/ 为/ Succ/ ./ 定义/ 敌手/ 的/ 优势/ 为/ Adv/ (/ / ddh/ )/ =/ 2/ ·/ Pr/ [/ Succ/ ]/ -/ 1/ ./ 如果/ 对于/ 任意/ 的/ 概率/ 多项式/ 敌手/ ,/ 上述/ 优势/ 都/ 是/ 可/ 忽略/ 的/ ,/ 那么/ 称/ 循环群/ Gq/ 中/ DDH/ 假设/ 成立/ ./ 定理/ 1/ (/ 语义/ 安全/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qsend/ 次/ Send/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 如果/ DDH/ 假设/ 在/ 群/ Gq/ 中/ 成立/ 、/ 公钥/ 加密/ 体制/ Σ/ 是/ CPA/ 安全/ 的/ 并且/ 公钥/ 加密/ 体制/ Σ/ 是/ CCA/ 安全/ 的/ ,/ 那么/ 敌手/ / 破坏/ GPAKE/ 协议/ 通用/ 框架/ 语义/ 安全/ 的/ 优势/ 至多/ 为/ 消息/ (/ C/ ,/ τ/ / 2/ )/ 来/ 检测/ 恶意/ 网关/ 进行/ 的/ 在线/ 字典/ 攻击/ ./ 具体/ 地/ ,/ 服务器/ 验证/ τ/ 2/ 是否/ 等于/ τ/ / 2/ ./ 如果/ 验证/ 通过/ ,/ 说明/ 接入/ 认证/ 请求/ 确实/ 是/ 一个/ 诚实/ 的/ 用户/ 发送/ 的/ ;/ 否则/ ,/ 接入/ 请求/ 很/ 可能/ 来自/ 一个/ 恶意/ 网关/ 对/ 用户/ 的/ 在线/ 仿冒/ 攻击/ ,/ 服务器/ 将/ 采取/ 进一步/ 的/ 措施/ 以/ 保护/ 用户/ 口令/ ./ 其中/ neg/ (/ n/ )/ 表示/ 关于/ 安全/ 参数/ n/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 证明/ ./ 我们/ 定义/ 一系列/ 混合/ 实验/ ./ 从/ 每/ 一个/ 实验/ 开始/ ,/ 我们/ 首先/ 用/ 随机数/ 替代/ 被动/ 攻击/ 中/ 的/ 会/ 话/ 密钥/ ,/ 然后/ 修改/ 主动攻击/ 中/ 的/ 会/ 话/ ,/ 使得/ 敌手/ 猜测/ 口令/ 错误/ 的/ 主动/ 会话/ 都/ 会/ 被/ 拒绝接受/ ./ 到/ 最后/ 一个/ 实验/ ,/ 所有/ 的/ 会/ 话/ 密钥/ 完全/ 随机/ 并且/ 与/ 用户/ 的/ 口令/ 完全/ 独立/ ,/ 因此/ 敌手/ 无法/ 区分/ 真实/ 的/ 会/ 话/ 密钥/ 和/ 与会/ 话/ 密钥/ 等长/ 的/ 随机数/ ,/ 也/ 无法/ 获得/ 任何/ 关于/ 用户/ 口令/ 的/ 任何/ 信息/ ./ 我们/ 总共/ 定义/ 了/ 11/ 个/ 混合/ 实验/ ,/ 我们/ 用/ P0/ ,/ P1/ ,/ …/ ,/ P10/ 来/ 表示/ 这些/ 混合/ 实验/ ,/ 用/ 事件/ Success/ 表示/ 敌手/ 正确/ 猜测出/ 了/ 在/ Test/ 询问/ 中/ 所/ 使用/ 的/ 随机数/ b/ ,/ 并且/ 用/ Adv/ (/ / ,/ Pi/ )/ 表示/ 敌手/ / 在/ 第/ i/ 个/ 混合/ 实验/ 中/ 的/ 优势/ ./ 实验/ P0/ ./ 此/ 实验/ 模拟/ 在/ 标准/ 模型/ 下/ 的/ 真实/ 协议/ 运行/ ./ 在/ 实验/ 中/ 敌手/ / 可以/ 多次/ 访问/ Execute/ 、/ Send/ 和/ Test/ 询问/ ./ 根据/ 定义/ 有/ 实验/ P1/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 对于/ 敌手/ 进行/ 的/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ 我们/ 计算/ ω/ =/ Encpk/ (/ pw0/ ;/ r/ )/ ,/ 其中/ pw0/ 是/ 不/ 在/ 口/ Page7/ 令/ 空间/ 中/ 的/ 虚假/ 口令/ ./ 相应/ 的/ ,/ 在/ 用户端/ 计算/ r/ / ,/ τ/ / 1/ 和/ τ/ / 2/ 的/ 时候/ ,/ 直接/ 将/ 这/ 几个/ 值取/ 为/ 由/ 服务器/ 计算/ 的/ r/ ,/ τ/ 1/ 和/ τ/ 2/ 的/ 值/ ./ 其余/ 的/ 模拟/ 与/ 上/ 一个/ 实验/ 完全相同/ ./ 显然/ ,/ 这个/ 实验/ 将/ 被动/ 会话/ 中/ 用户端/ 对/ 口令/ 加密/ 的/ 密文/ 替换/ 为/ 对/ 一个/ 虚假/ 口令/ 加密/ 的/ 密文/ ./ 实验/ P1/ 和/ 实验/ P0/ 的/ 差别/ 至多是/ 敌手/ 攻破/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ 的/ 优势/ ./ 给定/ 一个/ 可以/ 区分/ 实验/ P1/ 和/ 实验/ P0/ 的/ 敌手/ / ,/ 我们/ 现在/ 来/ 构造/ 一个/ 可以/ 攻击/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ 的/ 概率/ 多项式/ 敌手/ / ./ 给定/ 公钥/ pk/ ,/ 敌手/ / 选择/ 其余/ 的/ 公开/ 参数/ 并/ 为/ 所有/ 的/ 用户/ 选择/ 口令/ ,/ 然后/ 为/ 敌手/ / 模拟/ 整个/ 实验/ ./ 对于/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ 敌手/ / 用/ 口令/ pw/ 和/ 虚假/ 口令/ pw0/ 作为/ 两条/ 消息/ 进行/ 挑战/ 密文/ 的/ 询问/ ./ 当/ 敌手/ / 接收/ 到/ 挑战/ 密文/ ω/ ,/ 就/ 将/ 挑战/ 密文/ 添加/ 到/ 用户/ 发送给/ 网关/ 的/ 第一条/ 消息/ 中/ ,/ 其余/ 的/ 模拟/ 跟/ 实验/ P1/ 中/ 完全相同/ ./ 在/ 实验/ 结束/ 时/ ,/ 如果/ 敌手/ / 认为/ 他/ 在/ 实验/ P0/ 中/ ,/ 那么/ 敌手/ / 就/ 判定/ 挑战/ 密文/ ω/ 是/ 对/ 口令/ pw/ 的/ 加密/ ;/ 反之/ 挑战/ 密文/ 则/ 是/ 对/ 虚假/ 口令/ pw0/ 的/ 加密/ ./ 敌手/ / 攻击/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ 的/ 优势/ 与/ 敌手/ / 区分/ 实验/ P1/ 和/ 实验/ P0/ 的/ 概率/ 完全相同/ ,/ 由公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ ,/ 我们/ 有/ Adv/ (/ / ,/ P1/ )/ -/ Adv/ (/ / ,/ P0/ )/ / neg/ (/ n/ )/ ./ 实验/ P2/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 继续/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 服务器/ 在/ 接收/ 到/ 用户/ C/ 发送/ 的/ 消息/ (/ C/ ,/ X/ ,/ Y/ ,/ ω/ )/ 后/ ,/ 随机/ 选择/ k/ ∈/ K/ 并/ 计算/ s/ =/ α/ (/ k/ ,/ ω/ )/ ,/ 但是/ 服务器/ 随机/ 选择/ 适当/ 长度/ 的/ 比特/ 串/ 作为/ r/ 、/ τ/ 1/ 和/ τ/ 2/ 的/ 值/ ./ 相应/ 地/ ,/ 根据/ 模拟/ 规则/ 将/ 用户/ 端的/ r/ / 、/ τ/ / 1/ 和/ τ/ / 2/ 的/ 值/ 直接/ 取为/ 由/ 服务器/ 选择/ 的/ r/ 、/ τ/ 1/ 和/ τ/ 2/ 的/ 值/ ./ 其余/ 的/ 模拟/ 和/ 上/ 一个/ 实验/ 相同/ ./ 由/ 平滑/ 投射/ Hash/ 函数/ 的/ 平滑/ 性易知/ 实验/ P2/ 和/ 实验/ P1/ 的/ 差别/ 至多是/ 关于/ 安全/ 参数/ n/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 注意/ 到/ 我们/ 在/ 计算/ ω/ 的/ 时候/ 用/ 的/ 是/ 虚假/ 口令/ pw0/ ,/ 因此/ (/ ω/ ,/ pw0/ )/ / L/ ,/ 根据/ 平滑/ 性/ 可知/ ,/ 即使/ 敌手/ 知道/ 投射/ 密钥/ s/ ,/ 平滑/ 投射/ Hash/ 函数/ 的/ 输出/ Hk/ (/ ω/ ,/ pw0/ )/ 与其/ 值域/ 中/ 的/ 均匀分布/ 仍然/ 是/ 统计/ 不可/ 区分/ 的/ ./ 因此/ ,/ 我们/ 有/ Adv/ (/ / ,/ P2/ )/ -/ Adv/ (/ / ,/ P1/ )/ / neg/ (/ n/ )/ ./ 实验/ P3/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 继续/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 当/ 服务器/ 计算/ 密文/ ω/ 的/ 时候/ ,/ 我们/ 令/ ω/ =/ Enclabel/ 入/ r/ 是/ 根据/ 实验/ P2/ 的/ 模拟/ 规则/ 随机/ 选择/ 的/ ./ 同时/ ,/ 我们/ 取消/ 用户端/ 对/ ω/ 的/ 验证/ ,/ 要求/ 用户/ 直接/ 接受/ 协议/ 运行/ 并/ 产生/ 会话/ 密钥/ ./ 实验/ P3/ 和/ 实验/ P2/ 的/ 差别/ 至多是/ 敌手/ 攻破/ 公钥/ 加密/ 体制/ Σ/ 的/ CCA/ 安全性/ 的/ 优势/ ./ 实际上/ ,/ 我们/ 这里/ 用到/ 的/ 只是/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ ./ 通过/ 跟/ 实验/ P1/ 类似/ 的/ 分析/ 可以/ 知道/ :/ 实验/ P4/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 最后/ 一次/ 修改/ 对/ Execute/ 询问/ 的/ 模拟/ ./ 当/ 我们/ 计算/ Execute/ 询问/ 的/ 会/ 话/ 密钥/ 的/ 时候/ ,/ 直接/ 从/ Gq/ 中/ 随机/ 选择/ 一个/ 元素/ K/ ,/ 而/ 不是/ 通过/ K/ =/ Xy/ 或者/ K/ =/ Yx/ 的/ 方式/ 计算/ ./ 实验/ P5/ 和/ 实验/ P4/ 中/ 敌手/ 优势/ 的/ 差距/ 跟/ 攻破/ DDH/ 假设/ 的/ 优势/ 相同/ ./ 现在/ 我们/ 给出/ 上面/ 结论/ 的/ 证明/ ./ 给定/ 一个/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ ,/ 我们/ 为了/ 模拟/ 对/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ 的/ 回答/ ,/ 首先/ 随机/ 选择/ a1/ ,/ a2/ ,/ b1/ ,/ b2/ ∈/ Z/ / 在/ 模拟/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ 的/ 时候/ 我们/ 令/ X/ =/ Ua1ga2/ 以及/ Y/ =/ Vb1gb2/ ,/ 其余/ 的/ 模拟/ 都/ 跟/ 实验/ P3/ 完全相同/ ./ 最后/ ,/ 我们/ 定义/ 会话/ 密钥/ 为/ K/ =/ Wa1b1/ ·/ Ua1b2/ ·/ Va2b1/ ·/ ga2b2/ ./ 显然/ ,/ 如果/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ Diffie/ -/ Hellman/ 三元组/ ,/ 那么/ 模拟/ 的/ 规则/ 与/ 实验/ P3/ 完全相同/ ;/ 如果/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ 随机/ 的/ 三元组/ ,/ 那么/ 模拟/ 的/ 规则/ 与/ 实验/ P4/ 一致/ ./ 如果/ 存在/ 敌手/ 可以/ 区分/ 实验/ P4/ 和/ 实验/ P3/ ,/ 那么/ 我们/ 可以/ 以/ 相同/ 的/ 优势/ 攻破/ DDH/ 假设/ ,/ 因此/ 我们/ 有/ 注意/ 在/ 实验/ P4/ 中/ ,/ 对于/ Execute/ 询问/ 产生/ 的/ 会/ 话/ 密钥/ 以及/ 协议/ 的/ 消息/ 跟/ 口令/ 完全/ 无关/ ,/ 因此/ 敌手/ 不/ 可能/ 通过/ Execute/ 询问/ 得到/ 口令/ 的/ 任何/ 信息/ ,/ 同时/ 由于/ 会话/ 密钥/ 是/ 随机/ 选择/ 的/ ,/ 敌手/ 在/ 猜测/ 由/ Execute/ 询问/ 产生/ 的/ 会/ 话/ 密钥/ 的/ 时候/ 也/ 不会/ 有/ 任何/ 优势/ ./ 实验/ P5/ ./ 从/ 这个/ 实验/ 开始/ ,/ 我们/ 修改/ 对/ Send/ 询问/ 的/ 模拟/ ./ 为了/ 符号/ 上/ 的/ 方便/ ,/ 我们/ 令/ Send0/ (/ Ci/ ,/ Gj/ )/ 表示/ 要求/ 用户/ 实例/ Ci/ 开始/ 执行/ 协议/ 的/ 初始/ 激活/ 消息/ ;/ 令/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 表示/ 用户/ 发送给/ 网关/ 实例/ Gj/ 的/ 第一条/ 消息/ ;/ 令/ Send2/ (/ Ci/ ,/ Gs/ ω/ Y/ )/ 表示/ 协议/ 中/ 网关/ 接收/ 到/ 消息/ CX/ ω/ 后/ 发送给/ 用户/ 实例/ Ci/ 的/ 消息/ ;/ 令/ Send3/ (/ Gj/ ,/ C/ τ/ / 1/ τ/ / 2/ )/ 表示/ 用户/ 发给/ 网关/ 实例/ Gj/ 的/ 最后/ 一条/ 消息/ ./ 另外/ 如果/ 一条/ 消息/ 是/ 由/ 诚实/ 的/ 参与者/ 生成/ 的/ ,/ 那么/ 我们/ 说/ 该/ 消息/ 是/ 由/ 实例/ 生成/ 的/ ;/ 否则/ ,/ 我们/ 称/ 消息/ 是/ 由/ 敌手/ 产生/ 的/ ./ 在/ 实验/ P5/ 开始/ ,/ 当/ 我们/ 在/ 产生/ CRS/ 参数/ 中公钥/ 加密/ 体制/ Σ/ 和/ Σ/ 的/ 公钥/ pk/ ,/ pk/ 的/ 时候/ ,/ 我们/ 记录/ 其/ 对应/ 的/ 私钥/ sk/ ,/ sk/ ./ Page8/ 当/ 敌手/ 产生/ 的/ 消息/ Gs/ ω/ Y/ 并/ 进行/ Send2/ (/ Ci/ ,/ Gs/ ω/ Y/ )/ 询问/ 时/ ,/ 假设/ CX/ ω/ 是/ 对于/ Send0/ (/ Ci/ ,/ Gj/ )/ 询问/ 的/ 回答/ ,/ 我们/ 首先/ 检查/ s/ ω/ 是否是/ 由/ 某/ 一个/ 实例/ 产生/ 的/ ,/ 如果/ 不是/ 则/ 利用/ 私钥/ sk/ 和/ 标签/ label/ =/ CGS/ ω/ sXY/ 对/ 敌手/ 发送/ 的/ 密文/ ω/ 进行/ 解密/ ,/ 看/ 解密/ 得到/ 的/ 消息/ 是否/ 等于/ pw/ ./ 如果/ 不/ 相等/ ,/ 那么/ 拒绝/ 协议/ ,/ 并且/ 停止/ 用户/ 实例/ Ci/ 的/ 运行/ ;/ 如果/ 相等/ ,/ 那么/ 我们/ 停止/ 协议/ 运行/ 并且/ 宣布/ 敌手/ 成功/ ./ 实验/ P5/ 和/ 实验/ P4/ 唯一/ 的/ 区别/ 在于/ 当/ 敌手/ 伪造/ 的/ 消息/ Gs/ ω/ Y/ 中/ 的/ 密文/ ω/ 可以/ 被/ 解密/ 为/ pw/ 的/ 情况/ ,/ 在/ 这种/ 情况/ 下/ 我们/ 认为/ 敌手/ 攻破/ 了/ 协议/ 的/ 语义/ 安全性/ ,/ 所以/ 敌手/ 的/ 攻击/ 优势/ 增大/ ./ 因此/ ,/ 我们/ 有/ 实验/ P6/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 修改/ 对/ Send0/ 和/ Send2/ 询问/ 的/ 模拟/ ./ 对于/ 敌手/ 发送/ 的/ Send0/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ 我们/ 现在/ 计算/ ω/ =/ Encpk/ (/ pw0/ ;/ r/ )/ ,/ 其中/ pw0/ 是/ 不/ 在/ 口令/ 空间/ 中/ 的/ 虚假/ 口令/ ./ 为了/ 保证/ 敌手/ 视图/ 的/ 一致性/ ,/ 对于/ 一个/ Send2/ (/ Ci/ ,/ Gs/ ω/ Y/ )/ 询问/ ,/ 如果/ 确实/ 存在/ 一个/ 网关/ 实例/ Gj/ 跟/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 询问/ 匹配/ ,/ 也就是说/ Gs/ ω/ Y/ 是/ 由/ 网关/ 实例/ Gj/ 在/ 接收/ 到/ 消息/ CX/ ω/ 后/ 产生/ 的/ ,/ 那么/ 我们/ 要求/ 用户/ 实例/ Ci/ 在/ 不/ 对/ 消息/ Gs/ ω/ Y/ 进行/ 验证/ 的/ 情况/ 下/ 就/ 接受/ ,/ 并且/ 将/ r/ / τ/ / 1/ τ/ / 2/ 定义/ 为/ 网关/ 实例/ Gj/ 在/ 接收/ 到/ CX/ ω/ 后/ 计算/ 出/ 的/ r/ τ/ 1/ τ/ 2/ ./ 敌手/ 区分/ 实验/ P6/ 和/ 实验/ P5/ 的/ 优势/ 和/ 攻破/ 公钥/ 加密/ 体制/ Σ/ 的/ CPA/ 安全性/ 的/ 优势/ 相同/ ./ 从/ 实验/ P1/ 进行/ 的/ 类似/ 分析/ 可知/ :/ Adv/ (/ / ,/ P6/ )/ -/ Adv/ (/ / ,/ P5/ )/ / neg/ (/ n/ )/ ./ 实验/ P7/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 修改/ 对/ Send1/ 询问/ 的/ 模拟/ 进行/ 一个/ 简单/ 的/ 改动/ ./ 对于/ 敌手/ 产生/ 的/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 询问/ ,/ 注意/ 到/ 从/ 实验/ P5/ 开始/ 我们/ 就/ 记录/ 了/ 私钥/ sk/ ,/ sk/ ,/ 因此/ 可以/ 用公钥/ 加密/ 体制/ Σ/ 对应/ 于/ 公钥/ pk/ 的/ 私钥/ sk/ 对/ ω/ 进行/ 解密/ ,/ 如果/ 解密/ 的/ 明文/ 是/ pw/ ,/ 那么/ 我们/ 停止/ 模拟/ 并且/ 宣布/ 敌手/ 成功/ ;/ 如果/ 不是/ ,/ 那么/ 按照/ 上/ 一个/ 实验/ 的/ 模拟/ 规则/ 进行/ ./ 除此之外/ ,/ 所有/ 的/ 模拟/ 和/ 实验/ P6/ 完全一致/ ./ 显然/ ,/ 在/ 这个/ 实验/ 里面/ ,/ 我们/ 只是/ 增加/ 敌手/ 成功/ 的/ 方式/ ,/ 因此/ 有/ 实验/ P8/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 继续/ 修改/ 对/ Send1/ 询问/ 的/ 模拟/ ./ 对于/ 敌手/ 产生/ 的/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 询问/ ,/ 我们/ 用公钥/ 加密/ 体制/ Σ/ 对应/ 于/ 公钥/ pk/ 的/ 私钥/ sk/ 对/ ω/ 进行/ 解密/ ,/ 如果/ 解密/ 的/ 明文/ 是/ pw/ ,/ 那么/ 我们/ 停止/ 模拟/ 并且/ 宣布/ 敌手/ 成功/ ;/ 如果/ 解密/ 后/ 的/ 明文/ 不是/ pw/ ,/ 那么/ 我们/ 随机/ 选择/ 适当/ 长度/ 的/ 比特/ 串/ 作为/ r/ 、/ τ/ 1/ 和/ τ/ 2/ 的/ 值/ ./ 特别/ 的/ ,/ 如果/ 敌手/ 继续/ 发送/ 了/ Send3/ (/ Gj/ ,/ C/ τ/ / 1/ τ/ / 2/ )/ 询问/ ,/ 有/ τ/ / 1/ =/ τ/ 1/ 并且/ τ/ / 2/ =/ τ/ 2/ ,/ 那么/ 网关/ 实例/ Gj/ 接受/ 协议/ 运行/ 并且/ 生成/ 会话/ 密钥/ K/ ./ 实验/ P8/ 和/ 实验/ P7/ 的/ 差别/ 至多是/ 关于/ 安全/ 参数/ n/ 的/ 一个/ 可/ 忽略/ 函数/ ./ 注意/ 到/ 敌手/ 计算/ ω/ 的/ 时候/ 对/ 口令/ 猜测/ 错误/ ,/ 根据/ 平滑/ 性/ 可知/ ,/ 即使/ 敌手/ 知道/ 投射/ 密钥/ s/ ,/ 平滑/ 投射/ Hash/ 函数/ 的/ 输出/ 与其/ 值域/ 中/ 的/ 均匀分布/ 仍然/ 是/ 统计/ 不可/ 区分/ 的/ ./ 因此/ ,/ 我们/ 有/ 实验/ P9/ ./ 在/ 这个/ 实验/ 中/ ,/ 我们/ 最后/ 一次/ 修改/ 对/ Send1/ 询问/ 的/ 模拟/ ./ 对于/ 敌手/ 发送/ 的/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 询问/ ,/ 当/ 计算/ 密文/ ω/ 的/ 时候/ ,/ 我们/ 令/ ω/ =/ pk/ (/ pw0/ ;/ r/ )/ ,/ 其中/ 所/ 使用/ 的/ 随机/ 输入/ r/ 是/ 根据/ Enclabel/ 实验/ P8/ 的/ 模拟/ 规则/ 随机/ 选择/ 的/ ./ 敌手/ 在/ 实验/ P9/ 和/ 实验/ P8/ 中/ 的/ 优势/ 之差/ 至多/ 为/ 敌手/ 攻破/ 公钥/ 加密/ 体制/ Π/ 的/ CCA/ 安全性/ 的/ 优势/ ./ 如果/ 存在/ 敌手/ / 可以/ 区分/ 实验/ P9/ 和/ 实验/ P8/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ 概率/ 多项式/ 敌手/ / 攻击/ 公钥/ 加密/ 体制/ Π/ 的/ CCA/ 安全性/ ./ 给定/ 公钥/ pk/ ,/ 敌手/ / 按照/ 实验/ P8/ 中/ 的/ 模拟/ 规则/ 选择/ 所有/ 的/ 口令/ 和/ 安全/ 参数/ ,/ 并/ 为/ 敌手/ / 模拟/ 整个/ 实验/ 运行/ ./ 注意/ ,/ 这里/ 敌手/ 不/ 知道/ 公钥/ 加密/ 体制/ Π/ 的/ 公钥/ pk/ 对应/ 的/ 私钥/ sk/ ,/ 但是/ 知道/ 公钥/ 加密/ 体制/ Π/ 的/ 公钥/ pk/ 对应/ 的/ 私钥/ sk/ ./ 与/ 实验/ P8/ 中/ 的/ 模拟/ 规则/ 不同/ 的/ 地方/ 在于/ ,/ 当/ 接收/ 到/ 敌手/ 发送/ 的/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ 询问/ ,/ 当/ 计算/ 密文/ ω/ 的/ 时候/ ,/ 敌手/ / 令/ label/ =/ CGS/ ω/ sXY/ ,/ 并/ 产生/ 一个/ 虚假/ 的/ 口令/ pw0/ ,/ 然后/ 将/ 口令/ pw/ 和/ 虚假/ 的/ 口令/ pw0/ 作为/ 挑战/ 的/ 消息/ 连同/ label/ 一起/ 发送给/ 加密/ 体制/ 的/ 预言/ 机/ ./ 当/ 敌手/ / 收到/ 加密/ 预言/ 机/ 返回/ 的/ 挑战/ 密文/ ω/ 后/ ,/ 就/ 把/ ω/ 加入/ 到/ 返回/ 给/ 敌手/ / 的/ 消息/ 中/ ./ 为了/ 使/ 模拟/ 完美/ ,/ 敌手/ / 需要/ 判断/ 敌手/ / 是否/ 通过/ 询问/ Send1/ 或者/ Send2/ 已经/ 成功/ ./ 敌手/ / 对于/ Send1/ 询问/ 的/ 判断/ 很/ 容易/ ,/ 因为/ 敌手/ / 知道/ 私钥/ sk/ ./ 但是/ 对于/ Send2/ 询问/ 需要/ 借助于/ 公钥/ 加密/ 体制/ Σ/ 中/ 的/ 解密/ 预言/ 机来/ 判断/ 敌手/ / 是否/ 成功/ ./ 容易/ 验证/ 敌手/ / 不/ 需要/ 向/ 解密/ 预言/ 机/ 询问/ 标签/ // 密文/ 对/ (/ label/ ,/ ω/ )/ 的/ 解密/ 服务/ ,/ 因此/ 敌手/ / 可以/ 完美/ 模拟/ 整个/ 实验/ ./ 在/ 实验/ 的/ 最后/ ,/ 如果/ 敌手/ / 认为/ 其/ 处在/ 实验/ P8/ 中/ ,/ 那么/ 敌手/ / 就/ 判定/ 挑战/ 密文/ ω/ 是/ 对/ 口令/ pw/ 的/ 加密/ ;/ 反之/ ,/ 如果/ 敌手/ / 认为/ 其/ 处在/ 实验/ P9/ 中/ ,/ 那么/ 敌手/ / 就/ 判定/ 挑战/ 密文/ ω/ 是/ 对/ 虚假/ 口令/ pw0/ 的/ 加密/ ./ 这样/ 敌手/ / 可以/ 攻破/ 公钥/ 加密/ 体制/ Σ/ 的/ CCA/ 安全性/ ,/ 因此/ 我们/ 有/ Page9/ 实验/ P10/ ./ 在/ 最后/ 的/ 实验/ 中/ ,/ 我们/ 考虑/ 敌手/ 通过/ Send/ 询问/ 进行/ 的/ 被动/ 攻击/ ,/ 也就是说/ 敌手/ 虽然/ 进行/ 了/ Send/ 询问/ ,/ 但是/ 只是/ 诚实/ 传递/ 消息/ ,/ 没有/ 对/ 消息/ 进行/ 任何/ 改动/ ./ 对于/ 这样/ 的/ 会/ 话/ ,/ 模拟/ 的/ 规则/ 和/ 实验/ P5/ 中/ 模拟/ Execute/ 询问/ 产生/ 的/ 被动/ 会话/ 相同/ ./ 跟/ 实验/ P4/ 中/ 的/ 分析/ 类似/ ,/ 我们/ 有/ Adv/ (/ / ,/ P10/ )/ -/ Adv/ (/ / ,/ P9/ )/ / neg/ (/ n/ )/ ./ 现在/ 我们/ 考虑/ 敌手/ 在/ 实验/ P10/ 中/ 成功/ 的/ 几种/ 可能/ 的/ 方式/ :/ 情况/ 1/ ./ 对于/ 敌手/ 产生/ 的/ 消息/ 进行/ 的/ 询问/ Send1/ (/ Gj/ ,/ CX/ ω/ )/ ,/ 敌手/ 伪造/ 的/ 密文/ ω/ 可以/ 解密/ 得到/ 正确/ 的/ 口令/ pw/ ./ 情况/ 2/ ./ 对于/ 敌手/ 产生/ 的/ 消息/ 进行/ 的/ 询问/ Send2/ (/ Ci/ ,/ Gs/ ω/ Y/ )/ ,/ 敌手/ 伪造/ 的/ 密文/ ω/ 可以/ 解密/ 得到/ 正确/ 的/ 口令/ pw/ ./ 情况/ 3/ ./ 对于/ 敌手/ 进行/ 的/ 询问/ Send3/ (/ Gj/ ,/ C/ τ/ / 1/ τ/ / 2/ )/ ,/ 有/ τ/ 1/ =/ τ/ / 1/ 以及/ τ/ 2/ =/ τ/ / 2/ ,/ 但是/ τ/ / 1/ 和/ τ/ / 2/ 不是/ 由/ 与/ 网关/ 实例/ Gj/ 匹配/ 的/ 用户/ 实例/ 产生/ 的/ ./ 机/ 比特/ b/ ./ 情况/ 4/ ./ 敌手/ 成功/ 猜测到/ Test/ 询问/ 中/ 使用/ 的/ 随/ 情况/ 3/ 发生/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ,/ 因为/ τ/ 1/ 和/ τ/ 2/ 是/ 随机/ 选择/ 的/ 并且/ 与/ 敌手/ 的/ 视图/ 完全/ 独立/ ./ 我们/ 用/ 事件/ PwdGuess/ 表示/ 情况/ 1/ 或者/ 情况/ 2/ 发生/ ./ 由于/ 敌手/ 的/ 视图/ 与/ 所有/ 的/ 口令/ 都/ 是/ 独立/ 的/ ,/ 直到/ 情况/ 1/ 或者/ 情况/ 2/ 发生/ ,/ 因此/ 我们/ 有/ 如果/ 事件/ PwdGuess/ 不/ 发生/ ,/ 那么/ 敌手/ / 只能/ 通过/ 情况/ 4/ 成功/ ./ 但是/ 所有/ 的/ 会/ 话/ 密钥/ 都/ 是/ 随机/ 选择/ 的/ ,/ 并且/ 与/ 敌手/ 的/ 视图/ 完全/ 独立/ ,/ 因此/ 敌手/ 通过/ 情况/ 4/ 成功/ 的/ 概率/ 是/ 1Pr/ [/ Success/ ]/ / Pr/ [/ Success/ ∧/ PwdGuess/ ]/ +/ / Pr/ [/ PwdGuess/ ]/ +/ Pr/ [/ SuccessPwdGuess/ ]/ ·/ (/ 1/ -/ Pr/ [/ PwdGuess/ ]/ )/ =/ 12/ +/ 1/ / 12/ +/ 1/ 综上/ ,/ 定理/ 1/ 得证/ ./ 定理/ 2/ (/ 密钥/ 私密性/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qExecute/ 次/ Execute/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 如果/ DDH/ 假设/ 在/ 群/ Gq/ 中/ 成立/ ,/ 那么/ 敌手/ / 破坏/ GPAKE/ 协议/ 通用/ 框架/ 的/ 密钥/ 私密性/ 的/ 优势/ 至多/ 为/ 证明/ ./ 假设/ / kp/ 是/ 运行/ 时间/ 至多/ 为/ t/ ,/ 进行/ 了/ qExecute/ 次/ Execute/ 询问/ 和/ qTest/ 次/ TestPair/ 询问/ 的/ 概率/ 多项式/ 敌手/ ./ 下面/ 我们/ 通过/ 调用/ / kp/ 来/ 构造/ 一个/ 可以/ 解决/ DDH/ 问题/ 的/ 敌手/ / DDH/ ./ 设/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 给/ / DDH/ 的/ 输入/ ./ / DDH/ 首先/ 根据/ 协议/ 中/ 口令/ 空间/ / 的/ 分布/ 为/ 所有/ 的/ 用户/ 选择/ 口令/ ,/ 另外/ 选择/ 框架/ 中/ 所有/ 的/ CRS/ 公共/ 参数/ ./ / DDH/ 随机/ 选择/ 一个/ 随机/ 比特/ b/ 用于/ 模拟/ TestPair/ 询问/ ./ 然后/ / DDH/ 将/ 所有/ 的/ 口令/ 告诉/ 敌手/ / kp/ 并且/ 开始/ 模拟/ 协议/ 的/ 运行/ ./ 为了/ 模拟/ Execute/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ / DDH/ 首先/ 随机/ 选择/ a1/ ,/ a2/ ,/ b1/ ,/ b2/ ∈/ Z/ / X/ =/ Ua1ga2/ ,/ 然后/ 在/ 模拟/ 网关/ 的/ 时候/ 令/ Y/ =/ Vb1gb2/ ./ / DDH/ 根据/ 协议/ 的/ 描述/ 正常/ 模拟/ 协议/ 剩余/ 的/ 步骤/ 直到/ 计算/ Diffie/ -/ Hellman/ 密钥/ K/ 为止/ ,/ / DDH/ 设置/ Diffie/ -/ Hellman/ 密钥/ K/ =/ Wa1b1/ ·/ Ua1b2/ ·/ Wa2b1/ ·/ ga2b2/ ./ 为了/ 模拟/ TestPair/ (/ Ci/ ,/ Gj/ )/ 询问/ ,/ / DDH/ 首先/ 检查/ 敌手/ / kp/ 是否/ 进行/ 过/ 相同/ 的/ 询问/ ./ 如果/ 是/ ,/ 则/ 返回/ 与/ 上次/ 相同/ 的/ 回答/ ;/ 否则/ ,/ / DDH/ 检查/ Ci/ 和/ Gj/ 是否是/ 伙伴/ ,/ 如果/ 不是/ ,/ 则/ 返回/ 错误/ 的/ 符号/ ⊥/ ./ 在/ Ci/ 和/ Gj/ 是/ 伙伴/ 的/ 情况/ 下/ ,/ 如果/ 随机/ 比特/ b/ =/ 0/ ,/ 那么/ / DDH/ 返回/ 真实/ 的/ 会/ 话/ 密钥/ K/ 给/ 敌手/ / kp/ ,/ 如果/ 随机/ 比特/ b/ =/ 1/ ,/ 那么/ / DDH/ 返回/ 一个/ Gq/ 中/ 的/ 随机/ 元素/ 给/ 敌手/ / kp/ ./ 下面/ 我们/ 分析/ / DDH/ 攻破/ DDH/ 假设/ 的/ 成功/ 概率/ ,/ 首先/ 如果/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ Diffie/ -/ Hellman/ 三元组/ ,/ 那么/ 上/ 面对/ 协议/ 的/ 模拟/ 是/ 完美/ 的/ ,/ 因此/ / DDH/ 输出/ 1/ 的/ 概率/ 为/ 1/ 果/ DDH/ 实例/ (/ U/ ,/ V/ ,/ W/ )/ 是/ 一个/ 随机/ 的/ 三元组/ ,/ 那么/ 无论/ b/ 为/ 0/ 或者/ 1/ ,/ 返回/ 给/ 敌手/ / kp/ 的/ 都/ 是/ 与其/ 视图/ 独立/ 的/ 随机数/ ,/ 因此/ 不会/ 泄露/ 关于/ b/ 的/ 任何/ 信息/ ,/ 此时/ / DDH/ 输出/ 1/ 的/ 概率/ 为/ 1/ 综上/ ,/ 定理/ 2/ 得证/ ./ 定理/ 3/ (/ 口令/ 保护/ )/ ./ 假设/ / 是/ 一个/ 运行/ 时间/ 为/ t/ ,/ 并且/ 进行/ 了/ qSend/ 次/ Send/ 询问/ 的/ 概率/ 多项式/ 敌手/ ,/ 那么/ 敌手/ / 对/ GPAKE/ 协议/ 通用/ 框架/ 进行/ 不可/ 检测/ 在线/ 字典/ 攻击/ 成功/ 的/ 优势/ 至多/ 为/ 证明/ ./ 考虑/ 一个/ 恶意/ 网关/ / 冒充/ 诚实/ 用户/ 并/ Page10/ 且/ 发送/ 消息/ (/ C/ ,/ X/ ,/ ω/ ,/ Y/ )/ 给/ 服务器/ ./ 根据/ 协议/ 描述/ ,/ 此时/ 服务器/ 应该/ 随机/ 选择/ k/ ∈/ K/ 并/ 计算/ 投射/ 密钥/ s/ =/ α/ (/ k/ ,/ ω/ )/ ,/ 然后/ 计算/ 平滑/ 投射/ Hash/ 函数/ 的/ 值/ Hk/ (/ ω/ ,/ pw/ )/ ,/ 并且/ 将/ 结果/ 分为/ 三个/ 随机/ 比特/ 串/ r/ τ/ 1/ τ/ 2/ ./ 服务器/ 定义/ 标签/ label/ =/ CGS/ ω/ sXY/ 并且/ 用带/ 标签/ 的/ 加密/ 体制/ Σ/ 计算/ 对/ 口令/ pw/ 加密/ 的/ 密文/ ω/ =/ pk/ (/ pw/ ;/ r/ )/ ,/ 最后/ 服务器发送/ 消息/ (/ s/ ,/ ω/ ,/ τ/ 1/ )/ 给/ Enclabel/ 恶意/ 网关/ ./ 恶意/ 网关/ 需要/ 返回/ 消息/ τ/ / 2/ 满足/ τ/ 2/ =/ τ/ / 2/ ,/ 否则/ 服务器/ 将会/ 检测/ 到/ 恶意/ 网关/ 的/ 在线/ 口令/ 猜测/ 攻击/ ./ 如果/ 恶意/ 网关/ 在/ 产生/ 密文/ ω/ 的/ 时候/ 正确/ 猜测到/ 了/ 口令/ ,/ 那么/ 可以/ 正确/ 计算/ 出/ τ/ / 2/ 的/ 值/ ./ 反之/ ,/ 如果/ 口令/ 猜测/ 错误/ ,/ 根据/ 平滑/ 投射/ 函数/ 的/ 平滑/ 性/ 可知/ ,/ 即使/ 敌手/ 知道/ 投射/ 密钥/ s/ ,/ 平滑/ 投射/ Hash/ 函数/ 的/ 输出/ 与其/ 值域/ 中/ 的/ 均匀分布/ 仍然/ 是/ 统计/ 不可/ 区分/ 的/ ./ 因此/ 恶意/ 网关/ 能够/ 正确/ 返回/ τ/ / 2/ 的/ 概率/ 是/ 2/ -/ n/ ./ 因此/ ,/ 恶意/ 网关/ / 对/ H/ -/ GPAKE/ 协议/ 进行/ 不可/ 检测/ 在线/ 字典/ 攻击/ 成功/ 的/ 概率/ 至多/ 为/ 5/ 性能/ 分析/ 在/ 本节/ ,/ 我们/ 首先/ 用/ 具体/ 的/ 公钥/ 加密/ 体制/ 对/ 通用/ 框架/ 进行/ 实例/ 化/ ,/ 然后/ 与/ 其它/ 的/ 网关/ 口令/ 协议/ 进行/ 效率/ 与/ 安全性/ 方面/ 的/ 比较/ ./ 如果/ 令/ ElGamal/ 加密算法/ 为/ 框架/ 中/ 的/ CPA/ 安全/ 的/ 加密/ 体制/ ,/ Cramer/ -/ Shoup/ 加密算法/ 为/ 框架/ 中/ 的/ CCA/ 安全/ 的/ 加密/ 体制/ ,/ 那么/ 我们/ 得到/ 标准/ 模型/ 下/ 安全/ 高效/ 的/ 网关/ 口令/ 协议/ [/ 22/ ]/ ./ 在/ 计算/ 代价/ 方面/ ,/ 由于/ 模/ 指数/ 运算/ 和/ 公钥/ 加密/ 是/ 计算/ 代价/ 最高/ 的/ 运算/ ,/ 因此/ 我们/ 只/ 考虑/ 模/ 指数/ 运算/ (/ 用/ e/ 表示/ )/ 和/ CCA/ 公钥/ 加密/ 运算/ (/ 用/ E/ 表示/ )/ ,/ 而/ 忽略/ 其余/ 的/ 运算/ (/ 如/ Hash/ 函数/ 运算/ 、/ 模乘/ 、/ 对称/ 加密/ 和/ MAC/ 等/ )/ ./ 在/ 通信/ 代价/ 方面/ ,/ 我们/ 从/ 传输/ 的/ 消息/ 所/ 占用/ 的/ 通信/ 带宽/ 和/ 通信/ 轮数/ 两个/ 方面/ 来/ 比较/ ./ 为了/ 比较/ 通信/ 带宽/ ,/ 我们/ 假设/ 参与者/ 的/ 身份/ 可以/ 用/ 32/ 比特/ 的/ 字符串/ 表示/ ,/ 循环群/ Gq/ 中/ 的/ 点/ 可以/ 由/ 160/ 比特/ 的/ 字符串/ 表示/ ,/ 假设/ 对称/ 加密算法/ 、/ Hash/ 函数/ 和/ MAC/ 的/ 输出/ 都/ 是/ 160/ 比特/ ./ 由于/ 文献/ [/ 16/ -/ 18/ ]/ 中/ 的/ 协议/ 假设/ 用户/ 和/ 服务器之间/ 需要/ 执行/ 安全/ 的/ 两方/ PAKE/ 协议/ ,/ 因此/ 我们/ 用/ 文献/ [/ 6/ ]/ 中/ 安全/ 高效/ 的/ 两方/ PAKE/ 协议/ 对/ 这些/ 协议/ 进行/ 实例/ 化/ ./ 计算/ 效率/ 和/ 通信/ 效率/ 的/ 比较/ 结果/ 见表/ 1/ ./ 在/ 安全性/ 方面/ ,/ 我们/ 主要/ 从/ 是否/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 、/ 是否/ 实现/ 双向/ 认证/ 、/ 安全性/ 证明/ 的/ 模型/ 以及/ 安全性/ 证明/ 所/ 基于/ 的/ 困难性/ 假设/ 四个/ 方面/ 进行/ 衡量/ ./ 我们/ 用/ UODA/ 表示/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 用/ MA/ 表示/ 双向/ 认证/ ,/ 用/ PCDDH/ 表示/ 基于/ 口令/ 的/ 选择/ 基/ 判定/ 性/ DDH/ 假设/ [/ 19/ ]/ ,/ 用/ ROM/ 表示/ 随机/ 预言/ 模型/ ,/ Standard/ 表示/ 标准/ 模型/ ./ 安全性/ 比较/ 的/ 结果/ 见表/ 2/ ./ 比较/ 的/ 协议/ 计算/ 复杂度/ ACFP/ 协议/ [/ 15/ ]/ 2e2e2e12164AIP/ 协议/ [/ 19/ ]/ 4e3e3e22084BLL/ 协议/ [/ 16/ ]/ 4e2e4e22408Shim/ 协议/ [/ 17/ ]/ 4e2e4e19208YY/ 协议/ [/ 18/ ]/ 4e2e4e27529/ 我们/ 的/ 协议/ 4e/ +/ 1E2e2e/ +/ 1E33606/ 表/ 2/ 标准/ 模型/ 下/ 的/ 网关/ 口令/ 协议/ 的/ 安全性/ 比较/ 比较/ 的/ 协议/ UODAMA/ 安全性/ 证明/ 困难性/ 假设/ ACFP/ 协议/ [/ 15/ ]/ NNROMDDH/ ,/ PCDDHAIP/ 协议/ [/ 19/ ]/ NNROMDDH/ ,/ PCDDHBLL/ 协议/ [/ 16/ ]/ NNUnprovenShim/ 协议/ [/ 17/ ]/ YNUnprovenYY/ 协议/ [/ 18/ ]/ YYUnproven/ 我们/ 的/ 协议/ YYStandardDDH/ 在/ 计算/ 代价/ 方面/ ,/ 注意/ 形如/ gxhy/ 这样/ 的/ 运算/ 可以/ 通过/ 一个/ 模/ 指数/ 的/ 运算/ 代价/ 求得/ ./ 从表/ 1/ 可见/ ,/ 对于/ 网关/ 的/ 计算/ 量/ ,/ 我们/ 的/ 协议/ 和/ 其余/ 的/ GPAKE/ 协议/ 相同/ ./ 但是/ 在/ 我们/ 的/ 协议/ 中/ ,/ 用户/ 需要/ 8/ 个模/ 指数/ 运算/ (/ 其中/ 4/ 个/ 是/ Cramer/ -/ Shoup/ 加密算法/ 的/ 代价/ )/ ,/ 服务器/ 需要/ 计算/ 6/ 个模/ 指数/ 运算/ (/ 其中/ 4/ 个/ 是/ Cramer/ -/ Shoup/ 加密算法/ 的/ 代价/ )/ ,/ 因此/ 我们/ 的/ 协议/ 计算/ 复杂度/ 高于/ 其它/ 的/ 协议/ ./ 在/ 通信/ 带宽/ 方面/ ,/ 我们/ 的/ 协议/ 仍然/ 是/ 效率/ 最低/ 的/ ./ 但是/ 注意/ 到/ ,/ 大部分/ 的/ 计算/ 代价/ 和/ 通信/ 带宽/ 都/ 来自/ 协议/ 中/ 用到/ 的/ CCA/ 安全/ 的/ 公钥/ 加密/ 体制/ ,/ 仅/ CCA/ 加密/ 体制/ 就/ 占/ 到/ 了/ 8/ 个/ 指数/ 运算/ 和/ 1280/ 比特/ 的/ 传输/ 带宽/ ./ 然而/ 目前/ 在/ 设计标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ PAKE/ 协议/ 时/ ,/ CCA/ 安全/ 的/ 公钥/ 加密/ 体制/ 几乎/ 是/ 必不可少/ 的/ ./ 事实上/ ,/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 协议/ 计算/ 复杂度/ 和/ 通信/ 复杂度/ 一般/ 是/ 随机/ 预言/ 模型/ 下/ 的/ 同类/ 协议/ 的/ 3/ 倍/ 左右/ ./ 考虑/ 到/ 我们/ 的/ 协议/ 是/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ ,/ 因此/ 这样/ 的/ 计算/ 代价/ 和/ 通信/ 代价/ 是/ 可以/ 接受/ 的/ ,/ 并且/ 具有/ 相当/ 的/ 优势/ ./ 在/ 协议/ 的/ 通信/ 轮数/ 方面/ ,/ 我们/ 的/ 协议/ 需要/ 6/ 轮/ 交互/ ,/ 效率/ 只/ 比/ ACFP/ 协议/ 和/ AIP/ 协议/ 低/ ./ 注意/ 到/ ACFP/ 协议/ 和/ AIP/ 协议/ 都/ 不能/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 为了/ 使/ 其/ 能够/ 抵抗/ 该/ 攻击/ ,/ 至少/ 需/ Page11/ 要/ 增加/ 两轮/ 通信/ (/ 用户/ 给/ 网关/ 发送/ 对/ 服务器/ 的/ 验证/ 信息/ ,/ 再/ 由/ 网关/ 转发给/ 服务器/ )/ ./ 在/ 安全性/ 方面/ ,/ 我们/ 的/ 协议/ 可以/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ 并且/ 实现/ 了/ 双向/ 认证/ ,/ 其余/ 的/ 协议/ 都/ 没有/ 能够/ 达到/ 相同/ 的/ 安全/ 强度/ ./ 虽然/ 文献/ [/ 18/ ]/ 中/ 的/ 协议/ 也/ 声称/ 具有/ 同样/ 的/ 安全性/ ,/ 但是/ 缺乏/ 严格/ 的/ 证明/ ,/ 其/ 安全性/ 无法/ 令人信服/ ./ 我们/ 的/ 协议/ 是/ 唯一/ 的/ 一个/ 在/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ GPAKE/ 协议/ ,/ 并且/ 安全性/ 证明/ 基于/ 标准/ 的/ DDH/ 假设/ ./ 6/ 总结/ 本文/ 在/ 共同/ 参考/ 串/ 模型/ 下/ 基于/ 平滑/ 投射/ Hash/ 函数/ 簇/ 设计/ 了/ 网关/ 口令/ 认证/ 密钥/ 交换/ 协议/ 一个/ 高效/ 的/ 通用/ 框架/ ,/ 并且/ 在/ 标准/ 模型/ 中/ 证明/ 了/ 其/ 安全性/ ./ 通用/ 框架/ 采用/ 了/ 模块化/ 的/ 设计/ 思路/ ,/ 可以/ 利用/ 不同/ 的/ 密码学/ 组件/ 进行/ 具体/ 的/ 实例/ 化/ ;/ 在/ 安全性/ 方面/ ,/ 通用/ 框架/ 可以/ 实现/ 双向/ 认证/ 并且/ 能够/ 抵抗/ 不可/ 检测/ 在线/ 字典/ 攻击/ ,/ 还/ 采用/ 了/ 模块化/ 的/ 安全/ 证明/ 思路/ ;/ 利用/ DDH/ 假设/ 、/ 二次/ 剩余/ 假设/ 和/ N/ 次/ 剩余/ 假设/ 对/ 通用/ 框架/ 进行/ 实例/ 化/ 可以/ 得到/ 不同/ 的/ 标准/ 模型/ 下/ 高效/ 的/ 网关/ 口令/ 协议/ ./ 

