Page1/ 异构/ 集群/ 系统/ 中/ 安全/ 关键/ 实时/ 应用/ 调度/ 研究/ 朱晓敏/ 1/ )/ 陆佩忠/ 2/ )/ 1/ )/ (/ 国防科学技术大学/ 信息系统/ 工程/ 重点/ 实验室/ 长沙/ 410073/ )/ 2/ )/ (/ 复旦大学/ 计算机/ 科学技术/ 学院/ 上海/ 200433/ )/ 摘要/ 在/ 集群/ 系统/ 中/ ,/ 为/ 有/ 安全/ 需求/ 的/ 实时/ 应用/ 提供/ 安全/ 保障/ 得到/ 了/ 广泛/ 关注/ ,/ 但/ 将/ 实时/ 应用/ 的/ 安全/ 需求/ 与/ 调度/ 算法/ 相结合/ 的/ 研究/ 并不多/ ./ 文中/ 提出/ 了/ 一种/ 异构/ 集群/ 系统/ 中/ 安全/ 关键/ 实时/ 应用/ 的/ 2/ 阶段/ 调度/ 策略/ —/ —/ —/ TPSS/ ./ 该/ 策略/ 综合/ 考虑/ 了/ 任务/ 的/ 安全/ 需求/ 与/ 时间/ 限制/ ./ 在/ TPSS/ 的/ 第/ 1/ 阶段/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 调度/ 算法/ DSRF/ ,/ 当/ 系统/ 负载/ 较/ 重时/ ,/ DSRF/ 算法/ 能/ 在/ 保证/ 任务/ 安全/ 需求/ 的/ 基础/ 上/ ,/ 通过/ 降低/ 新到/ 任务/ 和/ 等待/ 队列/ 中/ 任务/ 的/ 安全级别/ 来/ 提高/ 任务/ 的/ 调度/ 成功率/ ./ 相反/ ,/ 当/ 系统/ 负载/ 较轻时/ ,/ DSRF/ 算法/ 能/ 在/ 保证系统/ 具有/ 较/ 高/ 调度/ 成功率/ 的/ 基础/ 上/ 充分利用/ 任务/ 在/ 截止期/ 前/ 的/ 空闲/ 时间/ 提高/ 新/ 任务/ 的/ 安全级别/ ./ 在/ TPSS/ 的/ 第/ 2/ 阶段/ ,/ 提出/ 了/ 一种/ 新/ 的/ 算法/ FMSL/ ,/ 用来/ 为/ 所/ 接收/ 任务/ 提供/ 较为/ 公平/ 的/ 安全/ 服务/ ,/ 同时/ 进一步提高/ 了/ 任务/ 的/ 整体/ 安全级别/ ./ 文中/ 通过/ 大量/ 的/ 模拟实验/ 对/ TPSS/ 策略/ 与/ DSRF/ 算法/ 、/ SAEDF/ 算法/ 和/ RF/ 算法/ 进行/ 了/ 比较/ ./ 实验/ 结果表明/ ,/ TPSS/ 策略/ 优于/ 其它/ 方法/ ,/ 使/ 系统/ 具有/ 较强/ 的/ 安全性/ 与/ 灵活性/ ./ 关键词/ 调度/ ;/ 异构/ 集群/ ;/ 实时/ ;/ 安全/ 关键/ ;/ 截止期/ 1/ 引言/ 近年来/ ,/ 集群/ 技术/ 发展/ 飞快/ ,/ 在/ 成本/ 和/ 体积/ 迅速/ 下降/ 的/ 同时/ ,/ 计算能力/ 大幅度/ 提升/ ./ 对于/ 计算/ 密集型/ 和/ 数据/ 密集型/ 应用/ ,/ 采用/ 集群/ 技术/ 是/ 较为/ 经济/ 和/ 可靠/ 的/ 手段/ [/ 1/ ]/ ./ 尤其/ 是/ 由/ 不同/ 计算能力/ 的/ 节点/ 组成/ 的/ 异构/ 集群/ 在/ 实际/ 应用/ 中/ 得到/ 了/ 广泛应用/ ./ 这/ 是因为/ 同一/ 集群/ 中/ 的/ 节点/ 可能/ 在/ 不同/ 时期/ 购买/ ,/ 在/ 计算能力/ 上/ 会/ 有所/ 差异/ ,/ 同时/ 出于/ 经济/ 目的/ 考虑/ ,/ 那些/ 仍然/ 具有/ 一定/ 计算能力/ 的/ 节点/ 会/ 和/ 新/ 购买/ 的/ 节点/ 放在/ 一起/ ,/ 从而/ 构成/ 了/ 一个/ 异构/ 集群/ [/ 2/ ]/ ./ 目前/ ,/ 很多/ 实时/ 应用/ 采用/ 集群/ 方式/ 进行/ 处理/ ,/ 例如/ ,/ 信号处理/ [/ 3/ -/ 4/ ]/ 、/ 图像处理/ [/ 5/ ]/ 、/ 天气预报/ [/ 6/ ]/ 等等/ ./ 这些/ 实时/ 应用/ 不仅/ 要求/ 运行/ 结果/ 正确/ ,/ 而且/ 实时/ 应用/ 中/ 的/ 任务/ 要/ 在/ 一定/ 时间/ 内/ 完成/ [/ 7/ ]/ ./ 通常/ ,/ 实时/ 系统/ 分为/ 硬/ 实时/ 系统/ [/ 8/ ]/ 和/ 软/ 实时/ 系统/ [/ 9/ ]/ 两类/ ./ 在/ 硬/ 实时/ 系统/ (/ 如/ 病人/ 监控/ 系统/ 、/ 飞机/ 控制系统/ )/ 中/ ,/ 任何/ 一个/ 任务/ 不能/ 在/ 截止/ 期内/ 完成/ 都/ 可能/ 产生/ 灾难性/ 的/ 后果/ ;/ 而/ 在/ 软/ 实时/ 系统/ (/ 如/ 视频/ 传输/ 系统/ 、/ 电话/ 交换/ 系统/ )/ 中/ ,/ 一些/ 任务/ 不能/ 在/ 截止/ 期内/ 完成/ 不会/ 对系统/ 产生/ 太大/ 的/ 影响/ ,/ 但/ 要/ 尽量/ 提高/ 任务/ 的/ 调度/ 成功率/ [/ 7/ ]/ ./ 本文/ 所/ 研究/ 的/ 安全/ 关键/ 实时/ 应用/ 运行/ 在/ 软/ 实时/ 系统/ 上/ ./ 随着/ 实时/ 应用/ 的/ 不断/ 发展/ ,/ 运行/ 在/ 集群/ 上/ 的/ 许多/ 实时/ 应用/ 不仅/ 具有/ 时限/ 要求/ ,/ 而且/ 还有/ 安全/ 保障/ 要求/ [/ 9/ ]/ ./ 例如/ ,/ 在/ 实时/ 股票/ 报价/ 更新/ 和/ 交易系统/ 中/ ,/ 每个/ 用户/ 的/ 请求/ 和/ 企业/ 后台/ 应用程序/ 的/ 响应/ 都/ 有/ 时间/ 限制/ 和/ 安全/ 需求/ ,/ 因此/ 需要/ 在/ 用户/ 与/ 企业/ 后台/ 应用程序/ 之间/ 搭建/ 集群/ 来/ 进行/ 处理/ ./ 但是/ 由于/ 集群/ 执行/ 的/ 用户/ 应用程序/ 可以/ 被/ 大批/ 用户/ 访问/ ,/ 同时/ 这些/ 应用程序/ 大多/ 未经/ 验证/ ,/ 因此/ ,/ 应用程序/ 和/ 用户/ 都/ 可能/ 对/ 集群/ 构成威胁/ [/ 10/ ]/ ./ 例如/ ,/ 黑客/ 可能/ 利用/ 应用程序/ 漏洞/ 控制/ 集群/ ,/ 恶意/ 用户/ 也/ 可能/ 通过/ 占用/ 集群/ 资源/ 进行/ 拒绝服务/ (/ DOS/ )/ 攻击/ ,/ 甚至/ 合法/ 用户/ 也/ 可能/ 通过/ 篡改/ 共享/ 数据/ 或/ 执行/ 大量/ 循环/ 操作/ 以/ 中断/ 其它/ 用户/ 接受/ 服务/ ./ 然而/ ,/ 许多/ 现存/ 的/ 集群/ 计算环境/ 还/ 没有/ 采用/ 任何/ 机制/ 以/ 应对/ 安全/ 威胁/ ./ 因此/ ,/ 必须/ 提供/ 安全/ 服务/ 以/ 保护/ 运行/ 于/ 集群/ 系统/ 之上/ 的/ 安全/ 性能/ 要求/ 较/ 高/ 的/ 实时/ 应用/ ./ 在/ 集群/ 计算环境/ 中/ ,/ 调度/ 算法/ 对于/ 提高/ 实时/ 应用/ 的/ 性能/ 起着/ 至关重要/ 的/ 作用/ [/ 11/ ]/ ./ 但是/ 目前/ 大多数/ 调度/ 算法/ 仅仅/ 考虑/ 如何/ 提高/ 实时/ 应用/ 中/ 任务/ 的/ 调度/ 成功率/ ,/ 而/ 未/ 考虑/ 应用/ 的/ 安全/ 问题/ ./ 本文/ 提出/ 一种/ 2/ 阶段/ 调度/ 策略/ TPSS/ (/ Two/ -/ PhaseSchedulingStrategy/ )/ ./ 该/ 策略/ 综合/ 考虑/ 了/ 运行/ 在/ 异构/ 集群/ 上/ 实时/ 应用/ 的/ 安全/ 需求/ 与/ 时间/ 限制/ ,/ 能够/ 根据/ 系统/ 状态/ 动态/ 调整/ 调度/ 目标/ ./ 当/ 任务/ 到达/ 速度/ 较/ 快/ 、/ 任务/ 截止期/ 较/ 短/ 或/ 节点/ 数较/ 少/ 等/ 情况/ ,/ 使得/ 系统/ 负载/ 较/ 重时/ ,/ 任务/ 的/ 调度/ 成功率/ 作为/ 调度/ 的/ 主要/ 目标/ ./ 相反/ ,/ 当/ 系统/ 负载/ 较轻时/ ,/ TPSS/ 能够/ 在/ 保证/ 任务/ 具有/ 较/ 高/ 调度/ 成功率/ 的/ 基础/ 上/ 利用/ 任务/ 截止期/ 前/ 的/ 空闲/ 时间/ 提高/ 任务/ 的/ 安全级别/ ./ 需要/ 注意/ 的/ 是/ ,/ 最小/ 的/ 安全级别/ 能够/ 满足用户/ 的/ 基本/ 需求/ ,/ 高/ 安全级别/ 可以/ 充分利用/ 系统资源/ ,/ 使得/ 系统/ 的/ 安全性/ 更强/ ./ 与此同时/ ,/ TPSS/ 使得/ 所/ 接收/ 任务/ 具有/ 较/ 公平/ 的/ 安全/ 服务/ ,/ 即/ 在/ 满足/ 调度/ 成功率/ 不/ 降低/ 的/ 前提/ 下/ ,/ 任务/ 之间/ 的/ 安全级别/ 相差/ 较/ 小/ ,/ 从而/ 降低/ 了/ 实时/ 应用/ 被/ 攻击/ 的/ 概率/ ./ 本文/ 第/ 2/ 节/ 回顾/ 相关/ 的/ 研究/ 工作/ ;/ 第/ 3/ 节/ 提出/ 一种/ 新/ 的/ 调度/ 器/ 模型/ 和/ 具有/ 安全/ 需求/ 的/ 任务模型/ ;/ 第/ 4/ 节/ 介绍/ 本文/ 提出/ 的/ TPSS/ 策略/ 和/ 其中/ 的/ DSRF/ 算法/ 与/ FMSL/ 算法/ ,/ 并/ 对/ 这/ 两种/ 算法/ 进行/ 分析/ ;/ 第/ 5/ 节/ 通过/ 大量/ 的/ 模拟实验/ 测试/ TPSS/ 策略/ 的/ 性能/ ;/ 第/ 6/ 节/ 总结/ 全文/ ./ 2/ 相关/ 工作/ 目前/ 已有/ 许多/ 应用/ 于/ 集群/ 系统/ 的/ 调度/ 算法/ ./ 但是/ 多处理器/ 系统/ 中/ 的/ 多任务/ 最优/ 分配/ 问题/ 仍/ 是/ 个/ NP/ 难题/ [/ 12/ ]/ ./ 因此/ ,/ 在/ 实际/ 应用/ 中/ ,/ 通常/ 采用/ 尽可能/ 接近/ 最优/ 的/ 启发式/ (/ Heuristic/ )/ 算法/ 来/ 解决/ 这/ 类/ 调度/ 问题/ [/ 13/ -/ 14/ ]/ ./ 很多/ 学者/ 在/ 这方面/ 做/ 了/ 大量/ 的/ 工作/ ./ Branu/ 等/ 人/ 对/ 11/ 种/ 常用/ 的/ 启发式/ 调度/ 算法/ 进行/ 了/ 评估/ [/ 15/ ]/ ./ 这些/ 调度/ 算法/ 包括/ OLB/ 、/ UDA/ 、/ FastGreedy/ 、/ Min/ -/ min/ 、/ Max/ -/ min/ 、/ Greedy/ 、/ GeneticAlgo/ -/ rithm/ (/ GA/ )/ 、/ SimulatedAnnealing/ (/ SA/ )/ 、/ GSA/ 、/ Tabu/ 和/ A/ / ./ 文献/ [/ 15/ ]/ 的/ 实验/ 结果表明/ ,/ Min/ -/ min/ 、/ GA/ 和/ A/ / 具有/ 较/ 好/ 的/ 性能/ ,/ 但/ Min/ -/ min/ 算法/ 的/ 负载/ 均衡性/ 相对/ 较差/ ./ 之后/ Maheswaran/ 等/ 人/ 提出/ 的/ Sufferage/ 算法/ 具有/ 比/ Min/ -/ min/ 算法/ 较/ 好/ 的/ 综合性/ 能/ [/ 16/ ]/ ./ Subramani/ 等/ 人/ 提出/ 了/ 一种/ 相邻/ 伙伴/ 模式/ 的/ 启发式/ 调度/ 算法/ 也/ 具有/ 较/ 好/ 性能/ [/ 13/ ]/ ./ 尽管/ 以上/ 这些/ 算法/ 具有/ 较/ 高/ 的/ 吞吐/ 率/ 和/ 较/ 好/ 的/ 负载/ 均衡/ ,/ 但/ 这些/ 算法/ 没有/ 考虑/ 任务/ 的/ 时间/ 限制/ ,/ 不/ 适合/ 实时/ 应用/ ./ 尤其/ 是/ GA/ 和/ SA/ 等/ 采用/ 人工智能/ 的/ 方法/ ,/ 由于/ 这些/ 方法/ 的/ 计算/ 时间/ 具有/ 非常/ 高/ 的/ 可变性/ ,/ 因此/ 采用/ 最长/ 调度/ 时间/ 将/ 极大/ 增加/ 系统/ 延迟/ ,/ 甚至/ 使/ 系统/ 变得/ 不可/ 调度/ [/ 17/ ]/ ./ 实时/ 任务调度/ 算法/ 一直/ 是/ 实时/ 系统/ 中/ 的/ 一个/ 热/ Page3/ 点/ 研究/ 问题/ ./ 实时/ 调度/ 算法/ 可以/ 分为/ 静态/ 调度/ 算法/ (/ static/ // offline/ )/ [/ 18/ ]/ 和/ 动态/ 调度/ 算法/ (/ dynamic/ // online/ )/ [/ 2/ ,/ 19/ ]/ 两类/ ./ 通常/ 静态/ 调度/ 算法/ 用于/ 调度/ 周期性/ (/ periodic/ )/ 任务/ ,/ 而/ 动态/ 调度/ 算法/ 用于/ 非/ 周期/ (/ aperiodic/ )/ 任务调度/ ./ 本文/ 考虑/ 任务/ 动态/ 到达/ ,/ 因此/ 采用/ 的/ 调度/ 算法/ 属于/ 动态/ 调度/ 算法/ ./ 同时/ ,/ 一些/ 调度/ 算法/ 采用/ 抢占/ 式/ (/ preemptive/ )/ 的/ 调度/ 方式/ [/ 20/ -/ 21/ ]/ ,/ 即/ 任务/ 在/ 执行/ 过程/ 中/ 可以/ 被/ 其它/ 高/ 优先级/ 任务/ 中断/ ,/ 而/ 另/ 一些/ 调度/ 算法/ 采用/ 非/ 抢占/ 式/ (/ Non/ -/ Preemptive/ )/ 的/ 调度/ 方式/ [/ 22/ -/ 23/ ]/ ./ 文献/ [/ 22/ ]/ 指出/ ,/ 非/ 抢占/ 式/ 的/ 调度/ 方式/ 由于/ 减少/ 了/ 任务/ 之间/ 的/ 切换/ 开销/ 从而/ 比/ 抢占/ 式/ 的/ 调度/ 方式/ 更为/ 有效/ ,/ 尤其/ 适合/ 于/ 软/ 实时/ 系统/ ./ 由于/ 本文/ 考虑/ 的/ 安全/ 关键/ 实时/ 应用/ 运行/ 在/ 软/ 实时/ 系统/ 上/ ,/ 因此/ 本文/ 提出/ 的/ 调度/ 算法/ 采用/ 非/ 抢占/ 式/ 的/ 调度/ 方式/ ./ 此外/ ,/ 一些/ 调度/ 算法/ 用于/ 调度/ 彼此/ 存在/ 依赖/ 关系/ (/ dependent/ )/ 的/ 任务/ ,/ 这些/ 任务/ 之间/ 的/ 关系/ 通常/ 用/ 由/ 向/ 无/ 环图/ (/ DAG/ )/ 来/ 描述/ [/ 2/ ,/ 19/ ,/ 24/ ]/ ;/ 而/ 另/ 一些/ 调度/ 算法/ 用于/ 调度/ 不/ 存在/ 依赖/ 关系/ 的/ 任务/ ,/ 即/ 独立/ (/ inde/ -/ pendent/ )/ 任务/ [/ 3/ -/ 4/ ,/ 23/ ,/ 25/ ]/ ./ 本文/ 采用/ 的/ 调度/ 算法/ 用于/ 调度/ 独立/ 任务/ ,/ 因为/ 有/ 依赖/ 关系/ 的/ 任务调度/ 可以/ 转换/ 为/ 独立/ 任务调度/ [/ 26/ ]/ ./ 独立/ 任务/ 的/ 调度/ 算法/ 可以/ 采用/ 两种/ 模式/ :/ 立即/ 模式/ 和/ 批/ 模式/ [/ 16/ ]/ ./ 所谓/ 立即/ 模式/ 即/ 任务/ 到达/ 后/ 立即/ 调度/ ,/ 而批/ 模式/ 采用/ 当/ 任务/ 数量/ 积累/ 到/ 一定/ 数量/ 时/ 再/ 进行/ 调度/ ./ 虽然/ 采用/ 批/ 模式/ 的/ 调度/ 方法/ 可以/ 积累/ 较/ 多/ 的/ 任务/ 信息/ ,/ 使得/ 某些/ 调度/ 较为/ 有效/ ,/ 但是/ 在/ 实时/ 系统/ 中/ ,/ 尤其/ 是/ 任务/ 截止期/ 很/ 短/ 的/ 情况/ 下/ ,/ 采用/ 批/ 模式/ 调度/ 时/ ,/ 先到/ 任务/ 必须/ 等待/ 任务/ 数/ 达到/ 一定量/ 时才/ 可/ 被/ 调度/ ,/ 这样/ 就/ 造成/ 一些/ 先到/ 任务/ 由于/ 等待/ 延迟/ 而/ 错失/ 其/ 截止期/ ,/ 降低/ 了/ 任务/ 的/ 调度/ 成功率/ ,/ 因此/ 本文/ 的/ 调度/ 算法/ 采用/ 立即/ 模式/ ./ 近年来/ ,/ 人们/ 越来越/ 关注/ 于/ 解决/ 集群/ 系统/ 中/ 的/ 安全/ 问题/ ,/ 为/ 集群/ 系统/ 提供/ 灵活/ 有效/ 的/ 安全/ 保障/ 已经/ 成为/ 一个/ 基本/ 需求/ ./ 例如/ ,/ Son/ 等/ 人/ 提出/ 了/ 一种/ 方法/ 来/ 折中/ 安全/ 质量/ 以/ 达到/ 所/ 需/ 的/ 实时/ 要求/ [/ 27/ ]/ ;/ Yurcik/ 等/ 人/ 开发/ 了/ 一种/ 通过/ 监控/ 方式/ 管理/ 集群/ 系统安全/ 的/ 工具/ [/ 28/ ]/ ;/ Koenig/ 等/ 人/ 描述/ 了/ 一种/ 集群/ 安全/ 工具/ NVisionCC/ ,/ 用来/ 监视/ 集群/ 中/ 节点/ 的/ 处理过程/ 并/ 在/ 异常情况/ 下/ 进行/ 报警/ [/ 29/ ]/ ,/ 等等/ ./ 但是/ 由于/ 这些/ 安全/ 技术/ 或/ 策略/ 没有/ 考虑/ 到/ 应用/ 的/ 时间/ 限制/ ,/ 因此/ 不/ 适合/ 实时/ 应用/ ./ 也/ 有/ 一些/ 研究/ 涉及/ 到/ 集群/ 系统/ 中/ 实时/ 应用/ 的/ 安全/ 问题/ ./ 例如/ ,/ George/ 等/ 人/ 提出/ 了/ 一种/ 并行/ 控制协议/ 以/ 满足/ 实时/ 应用/ 的/ 安全/ 需求/ [/ 30/ ]/ ./ Ahmed/ 等/ 人/ 提出/ 了/ 一种/ 安全/ 最优/ 并行/ 控制协议/ 来/ 折中/ 实时/ 应用/ 的/ 安全/ 需求/ 和/ 时间/ 要求/ [/ 31/ ]/ ./ 一些/ 学者/ 研究/ 如何/ 将/ 集群/ 中/ 的/ 安全/ 问题/ 与/ 调度/ 算法/ 结合/ 在/ 一起/ ,/ 从而/ 提高/ 运行/ 在/ 集群/ 上/ 的/ 安全/ 关键/ 实时/ 应用/ 的/ 安全性/ ./ Xie/ 等/ 人/ 提出/ 了/ 一种/ 具有/ 安全/ 需求/ 的/ 调度/ 策略/ SAREC/ 和/ 其/ 相应/ 的/ 调度/ 算法/ SAEDF/ ,/ 用于/ 提高/ 集群/ 系统/ 中/ 实时/ 应用/ 的/ 安全性/ [/ 32/ ]/ ./ 但是/ ,/ SAEDF/ 算法/ 是/ 一种/ 贪婪/ 算法/ ,/ 由于/ 过于/ 追求/ 任务/ 的/ 高/ 安全级别/ 从而/ 降低/ 了/ 任务/ 的/ 调度/ 成功率/ ,/ 尤其/ 是/ 在/ 系统/ 负载/ 较/ 重时/ 更为/ 突出/ ./ 同时/ ,/ 任务/ 之间/ 安全级别/ 差异/ 较大/ ./ 之后/ Xiong/ 等/ 人/ 在/ 遗传算法/ 的/ 基础/ 上/ 提出/ 了/ 一种/ 安全/ 关键/ 实时/ 应用/ 的/ 调度/ 算法/ ,/ 进一步提高/ 了/ 任务/ 的/ 整体/ 安全级别/ [/ 33/ ]/ ./ 但是/ 如前所述/ ,/ 这种/ 人工智能/ 的/ 方法/ 容易/ 使/ 系统/ 变得/ 不可/ 调度/ ,/ 同时/ 又/ 采用/ 了/ 批/ 模式/ 的/ 调度/ 方式/ ,/ 使得/ 对于/ 实时性/ 要求/ 较/ 高/ 的/ 应用/ 不/ 适用/ ./ 此外/ ,/ 上面/ 的/ 调度/ 算法/ 都/ 假设/ 集群/ 是/ 同构/ 的/ ,/ 即/ 集群/ 中/ 所有/ 节点/ 具有/ 相同/ 的/ 处理/ 能力/ ,/ 限制/ 了/ 算法/ 在/ 异构/ 集群/ 中/ 的/ 扩展性/ ./ 为此/ ,/ 本文/ 提出/ 一种/ 用于/ 异构/ 集群/ 系统/ 中/ 安全/ 关键/ 实时/ 应用/ 的/ 调度/ 策略/ ,/ 该/ 策略/ 能够/ 根据/ 系统/ 运行/ 状态/ 动态/ 调整/ 调度/ 目标/ ,/ 使得/ 算法/ 具有/ 很强/ 的/ 自适应性/ ,/ 同时/ 尽力/ 为/ 所/ 接收/ 的/ 任务/ 提供/ 较为/ 公平/ 的/ 服务/ ./ 3/ 系统调度/ 模型/ 3.1/ 调度/ 器/ 模型/ 调度/ 器/ 模型/ 可以/ 分为/ 两类/ :/ 集中式/ (/ centralized/ )/ 调度/ 器/ 模型/ 和/ 分布式/ (/ distributed/ )/ 调度/ 器/ 模型/ [/ 2/ ]/ ./ 在/ 集中/ 式调度/ 器/ 模型/ 中/ ,/ 由/ 一个/ 称之为/ 中心/ 调度/ 器/ 的/ 处理器/ 来/ 收集/ 全局/ 调度/ 信息/ ,/ 并/ 做出/ 调度/ 决定/ ./ 而/ 在/ 分布/ 式调度/ 器/ 模型/ 中/ ,/ 各自/ 处理单元/ 的/ 调度/ 程序/ 根据/ 局部/ 范围/ 的/ 调度/ 信息/ 进行/ 任务调度/ ./ 与/ 分布/ 式调度/ 器/ 模型/ 相比/ ,/ 集中/ 式调度/ 器/ 模型/ 具有/ 两个/ 显著/ 优点/ :/ (/ 1/ )/ 通过/ 对/ 中心/ 调度/ 器/ 的/ 备份/ ,/ 便于/ 实现/ 容错/ 处理/ ;/ (/ 2/ )/ 实现/ 比较/ 容易/ ./ 为/ 实现/ TPSS/ 的/ 调度/ 目标/ ,/ 本文/ 在/ 集中/ 式调度/ 器/ 模型/ 的/ 基础/ 上/ 进行/ 了/ 改进/ ,/ 给出/ 了/ 一种/ 新/ 的/ 调度/ 器/ 模型/ ,/ 如图/ 1/ 所示/ ./ 该/ 模型/ 适合/ 于/ 具有/ 安全/ 需求/ 且/ 运行/ 在/ 异构/ 集群/ 系统/ 上/ 的/ 实时/ 应用/ ./ 在/ 该/ 调度/ 器/ 模型/ 中/ ,/ 实时/ 调度/ 器为/ 一/ 全局/ 调度/ 器/ ./ 当有/ 一新/ 任务/ 到达/ 时/ ,/ 实时/ 调度/ 器/ 首先/ 收集/ 各/ 节点/ 上/ 正在/ 运行/ 任务/ 和/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 反馈/ 信息/ (/ feedbackinformation/ )/ ,/ 这些/ 反馈/ 信息/ 包括/ 正在/ 运行/ 任务/ 的/ 剩余/ 执行/ 时间/ 、/ 排队/ 等待/ 任务/ 的/ 等待时间/ 等/ ./ 然后/ 根据/ 实时/ 调度/ 器中/ 的/ DSRF/ 算法/ 来/ 决定/ Page4/ 新/ 任务/ 是否/ 可以/ 被/ 接收/ ./ 如果/ 新/ 任务/ 可以/ 被/ 接收/ ,/ 则/ 将/ 该/ 任务/ 发送到/ 目的/ 节点/ 的/ 等待/ 队列/ 中/ ,/ 否则/ 发送到/ 拒绝/ 队列/ 中/ ./ 如果/ 新/ 任务/ 被/ 发送到/ 目的/ 节点/ 后/ ,/ 实时/ 调度/ 器/ 将/ 任务调度/ 信息/ (/ schedulinginformation/ )/ 发送到/ 该/ 目的/ 节点/ ./ 这些/ 任务调度/ 信息/ 包括/ 所有/ 等待/ 队列/ 中/ 任务/ 的/ 执行/ 顺序/ 、/ 为/ 任务/ 所/ 提供/ 的/ 安全/ 服务/ ./ 需要/ 注意/ 的/ 是/ ,/ 当/ 一个/ 新/ 任务/ 被/ 发送到/ 某一/ 目的/ 节点/ 后/ ,/ 在/ 同一/ 节点/ 的/ 等待/ 队列/ 中/ ,/ 先于/ 新/ 任务/ 到达/ 的/ 那些/ 任务/ 的/ 执行/ 顺序/ 和/ 为/ 其/ 提供/ 的/ 安全/ 服务/ 可能/ 发生/ 改变/ ./ 之后/ ,/ 安全级别/ 控制器/ —/ —/ —/ 局部/ 控制器/ 根据/ FMSL/ 算法/ 对/ 目的/ 节点/ 局部/ 队列/ 中/ 任务/ 的/ 安全级别/ 进行/ 调整/ ,/ 使得/ 任务/ 具有/ 较为/ 公平/ 的/ 安全/ 服务/ ,/ 同时/ 进一步提高/ 任务/ 的/ 整体/ 安全级别/ ./ 在/ 调整/ 过程/ 中/ ,/ 等待/ 队列/ 中/ 的/ 所有/ 任务/ 满足/ 其/ 截止期/ 且/ 总体/ 完成/ 时间/ 不/ 延迟/ ,/ 因此/ 保证/ 了/ 任务/ 的/ 调度/ 成功率/ ./ 3.2/ 任务模型/ 令/ 某/ 一/ 实时/ 应用/ 为/ 一组/ 实时/ 独立/ 任务/ 的/ 集合/ T/ =/ {/ t1/ ,/ t2/ ,/ …/ ,/ tn/ }/ ./ N/ =/ {/ n1/ ,/ n2/ ,/ …/ ,/ nm/ }/ 为/ 节点/ 集合/ ,/ 其中/ 每个/ 节点/ 具有/ 不同/ 的/ 处理/ 能力/ ./ 执行/ 时间/ 用/ 矩阵/ 犈/ =/ (/ eij/ )/ n/ ×/ m/ 表示/ ,/ 其中/ 元素/ eij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 执行/ 时间/ ./ ai/ 和/ di/ 分别/ 表示/ 任务/ ti/ 的/ 到达/ 时间/ 和/ 截止期/ ./ 令/ 犈/ 犛/ 犜/ =/ (/ estij/ )/ n/ ×/ m/ 为/ 任务/ 最早/ 开始/ 时间/ 矩阵/ ,/ 其中/ 元素/ estij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 最早/ 开始/ 时间/ ./ 犣/ =/ (/ zij/ )/ n/ ×/ m/ 为/ 一/ 二元/ 矩阵/ ,/ zij/ =/ 1/ 当且/ 仅/ 当/ 任务/ ti/ 被/ 分配/ 到/ 节点/ nj/ 上/ ,/ 否则/ zij/ =/ 0/ ./ 犗/ =/ (/ oij/ )/ n/ ×/ m/ 为/ 任务/ 执行/ 顺序/ 矩阵/ ,/ 在/ zij/ =/ 1/ 时/ ,/ 元素/ oij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 执行/ 顺序/ ./ 一个/ 系统/ 可以/ 采用/ 多种不同/ 类型/ 的/ 安全/ 服务/ ./ 这些/ 服务类型/ 包括/ 保密/ 服务/ 、/ 完整性/ 服务/ 、/ 认证/ 服务/ 等等/ ./ 我们/ 将/ 同/ 一种/ 类型/ 的/ 安全/ 服务/ 分/ 在/ 一组/ ,/ 在/ 同/ 一组/ 内/ ,/ 多种/ 安全/ 服务/ 可以/ 提供/ 同一/ 类型/ 的/ 安全/ 保证/ ,/ 但是/ 由于/ 采用/ 的/ 机制/ 有所不同/ ,/ 所以/ 安全/ 质量/ 有所不同/ ./ 例如/ ,/ SEAL/ 、/ RC4/ 和/ DES/ 都/ 是/ 加密算法/ ,/ 但是/ 它们/ 所/ 提供/ 的/ 安全/ 质量/ 却/ 不同/ ./ 假设/ 有/ q/ 组/ 安全/ 服务/ G/ =/ {/ g1/ ,/ g2/ ,/ …/ ,/ gq/ }/ ./ 犛/ =/ (/ sij/ )/ |/ si/ |/ ×/ q/ 为/ 安全级别/ 矩阵/ ,/ 其中/ 元素/ sij/ 表示/ gj/ 组中/ 安全/ 服务/ si/ 的/ 安全级别/ ,/ 0/ </ sij/ / 1/ ,/ |/ sij/ |/ 表示/ gj/ 组中/ 安全/ 服务/ 的/ 个数/ ./ 每个/ 任务/ 可以/ 选择/ 不同/ 组中/ 的/ 不同/ 服务/ 从而/ 形成/ 一个/ 整体/ 安全级别/ ./ 假设/ Xij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 所有/ 可能/ 的/ 安全/ 服务/ 组合/ ,/ xij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 选择/ 安全/ 服务/ 的/ 一种/ 组合/ ,/ 则/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 安全级别/ 可以/ 表示/ 为/ sl/ (/ xij/ )/ =/ zij/ ∑/ q/ 其中/ wl/ 表示/ gl/ 组/ 的/ 权重/ ,/ skl/ 表示/ gl/ 组中/ 安全/ 服务/ sk/ 的/ 安全级别/ ./ 在/ 实际/ 应用/ 中/ ,/ 安全/ 开销/ 必须/ 被/ 定量/ 地/ 计算/ 以/ 使得/ 调度/ 更为/ 有效/ ./ 本文/ 采用/ 的/ 安全/ 开销/ 模型/ 类似/ 于/ 文献/ [/ 32/ ]/ ./ 由于/ 侦听/ (/ snooping/ )/ 、/ 篡改/ (/ alteration/ )/ 和/ 哄骗/ (/ spoofing/ )/ 是/ 集群/ 环境/ 中/ 最/ 常见/ 的/ 3/ 种/ 攻击/ ,/ 而/ 防范/ 这/ 3/ 种/ 攻击/ 的/ 有效/ 方法/ 就是/ 提供/ 保密/ 服务/ (/ confidentialityservice/ )/ 、/ 完整性/ 服务/ (/ integrityservice/ )/ 和/ 认证/ 服务/ (/ authenticationservice/ )/ ./ 为/ 不失/ 一般性/ 和/ 便于/ 分析/ 比较/ ,/ 我们/ 也/ 考虑/ 这/ 3/ 种/ 类型/ 的/ 安全/ 服务/ ./ 与/ 文献/ [/ 32/ ]/ 不同/ 的/ 是/ ,/ 本文/ 考虑/ 了/ 安全/ 开销/ 在/ 异构/ 环境/ 中/ 的/ 差异/ ./ 假设/ 任务/ ti/ 需要/ 组/ gl/ 中/ 的/ 第/ k/ 个/ 安全/ 服务/ ,/ 如果/ ti/ 被/ 分配/ 到/ 节点/ nj/ 上/ ,/ 则/ 其/ 安全/ 开销/ 可以/ 表示/ 为/ 其中/ g1/ 、/ g2/ 和/ g3/ 分别/ 提供/ 保密/ 服务/ 、/ 完整性/ 服务/ 和/ 认证/ 服务/ ,/ pj/ 表示/ 节点/ nj/ 的/ 处理/ 能力/ ./ 表/ 1/ ~/ 3/ 给出/ 了/ 每种/ 安全/ 服务/ 所/ 对应/ 的/ 安全级别/ 和/ 它们/ 相应/ 的/ 性能/ (/ 在/ 90MHz/ 奔腾/ 处理器/ 上/ 测定/ )/ [/ 32/ ]/ ,/ 其中/ μ/ k1/ 、/ μ/ k2/ 和/ μ/ k3/ 分别/ 代表/ 在/ 组/ g1/ 、/ g2/ 和/ g3/ 中/ 第/ k/ 个/ 安全/ 服务/ 的/ 性能/ ./ 对于/ 保密/ 服务/ 和/ 完整性/ 服务/ ,/ 安全/ 计算/ 开销/ 取决于/ 使用/ 的/ 加密算法/ (/ 对于/ 保密/ 服务/ )/ 、/ Hash/ 函数/ (/ 对于/ 完整性/ 服务/ )/ 、/ 被/ 保护/ 的/ 数据/ 大小/ 和/ 节点/ 的/ 处理/ 能力/ ;/ 而/ 对于/ 认证/ 服务/ ,/ 安全/ 计算/ 开销/ 则/ 只/ 依赖于/ 所/ 采用/ 的/ 认证/ 技术/ 和/ 节点/ 的/ 处理/ 能力/ ./ 设/ si/ 为/ 任务/ ti/ 的/ 数据/ 大小/ ,/ pj/ 表示/ 节点/ nj/ 的/ 处理/ 能力/ ,/ pb/ 表示/ 基准/ 节点/ 的/ 处理/ 能力/ ,/ 则/ 任务/ ti/ 在/ 节点/ nj/ 的/ 安全/ 开销/ c/ (/ xij/ )/ 可/ 进一步/ 表示/ 为/ c/ (/ xij/ )/ =/ zij/ ∑/ 2Page5/ 加密算法/ skl/ (/ 安全级别/ )/ uk1/ // (/ KB/ ·/ ms/ -/ 1/ )/ SEALRC4BlowfishKnufu/ // KhafreRC5RijndaelDESIDEAHash/ 函数/ skl/ (/ 安全级别/ )/ uk1/ // (/ KB/ ·/ ms/ -/ 1/ )/ MD4MD5RIPEMDRIPEMD/ -/ 128SHA/ -/ 1RIPEMD/ -/ 160Tiger4TPSS/ 策略/ TPSS/ 策略/ 包含/ 两个/ 算法/ :/ DSRF/ 算法/ 和/ FMSL/ 算法/ ./ DSRF/ 算法/ 用于/ 根据/ 系统/ 负载/ 情况/ ,/ 自/ 适应/ 地/ 调整/ 调度/ 目标/ ,/ 使得/ 在/ 系统/ 负载/ 较/ 重时/ ,/ 任务/ 具有/ 较/ 高/ 的/ 调度/ 成功率/ ;/ 而/ 在/ 系统/ 负载/ 较轻时/ ,/ 能/ 在/ 保证/ 任务/ 具有/ 较/ 高/ 调度/ 成功率/ 的/ 基础/ 上/ 最大化/ 任务/ 的/ 安全级别/ ./ FMSL/ 算法/ 用于/ 为/ 所/ 接收/ 任务/ 提供/ 较为/ 公平/ 的/ 服务/ ,/ 并且/ 能够/ 进一步提高/ 任务/ 的/ 整体/ 安全级别/ ./ 4.1/ DSRF/ 算法/ DSRF/ 算法/ 源于/ RF/ (/ ResponseFirst/ )/ 算法/ [/ 19/ ]/ ./ RF/ 算法/ 的/ 核心思想/ 是/ 把/ 任务分配/ 到/ 具有/ 最早/ 完成/ 时间/ 的/ 节点/ 上/ ./ 这种/ 算法/ 采用/ 立即/ 模式/ ,/ 是/ 在/ 异构/ 集群/ 系统/ 中/ 实时/ 任务调度/ 普遍/ 采用/ 的/ 一种/ 算法/ ./ 但是/ RF/ 算法/ 没有/ 考虑/ 应用/ 的/ 安全/ 需求/ ,/ 同时/ 不/ 具备/ 自适应性/ ./ 本文/ 提出/ 的/ DSRF/ 算法/ 包括/ 3/ 个/ 步骤/ ./ 在/ 步骤/ 1/ 中/ ,/ 新到/ 任务/ 被/ 分配/ 最高/ 的/ 安全级别/ ,/ 然后/ 按照/ 截止期/ 最早/ 最/ 优先/ 的/ 策略/ 插入/ 到/ 节点/ 的/ 局部/ 队列/ 中/ ,/ 选择/ 具有/ 最早/ 完成/ 时间/ 的/ 节点/ 作为/ 目的/ 节点/ ./ 需要/ 注意/ 的/ 是/ ,/ 这里/ 的/ 截止期/ 最早/ 最/ 优先/ 策略/ 不是/ 传统/ 的/ EDF/ 方法/ ,/ 因为/ EDF/ 算法/ 是/ 抢占/ 式/ 的/ ,/ 而/ 我们/ 采用/ 的/ 这种/ 策略/ 只是/ 对/ 局部/ 队列/ 中/ 的/ 任务/ 进行/ 执行/ 顺序/ 的/ 排队/ ./ 步骤/ 1/ 用来/ 最大化/ 任务/ 的/ 安全级别/ ./ 如果/ 采用/ 最高/ 安全级别/ 能够/ 保证/ 新/ 任务/ 的/ 时限/ 要求/ ,/ 同时/ 执行/ 顺序/ 大于/ 新/ 任务/ 的/ 那些/ 任务/ 也/ 满足/ 其/ 截止期/ ,/ 那么/ 分配/ 该/ 任务/ ;/ 如果/ 在/ 任何/ 节点/ 上/ 都/ 不能/ 满足/ 上面/ 的/ 限制/ ,/ 那么/ 转而/ 执行/ 步骤/ 2/ ./ 在/ 步骤/ 2/ 中/ ,/ 降低/ 新/ 任务/ 的/ 安全级别/ ,/ 直到/ 满足/ 步骤/ 1/ 中/ 所述/ 的/ 限制/ 条件/ ./ 步骤/ 2/ 同样/ 用来/ 尽力/ 提高/ 新/ 任务/ 的/ 安全级别/ ./ 当/ 步骤/ 2/ 也/ 不能/ 将/ 任务分配/ 时/ ,/ 步骤/ 3/ 开始/ 工作/ ./ 步骤/ 3/ 首先/ 选择/ 局部/ 队列/ 中/ 任务/ 安全级别/ 之/ 和/ 最大/ 的/ 节点/ ,/ 然后/ 采用/ 轮询/ (/ round/ -/ robin/ )/ 的/ 方法/ 降低/ 局部/ 队列/ 中/ 这些/ 等待/ 任务/ 的/ 安全级别/ ,/ 直到/ 新/ 任务/ 能/ 被/ 分配/ ,/ 如果/ 所有/ 等待/ 任务/ 的/ 安全级别/ 都/ 降到/ 最低/ 仍/ 不能/ 满足/ 新/ 任务/ 或/ 执行/ 顺序/ 晚于/ 新/ 任务/ 的/ 那些/ 任务/ 的/ 时间/ 限制/ ,/ 则/ 放弃/ 该/ 任务/ ,/ 否则/ 将/ 新/ 任务分配/ 到/ 该/ 节点/ ./ 步骤/ 3/ 用来/ 提高/ 任务/ 的/ 调度/ 成功率/ ./ 下面/ 介绍/ DSRF/ 算法/ 的/ 一些/ 性质/ ./ 性质/ 1/ ./ 如果/ 任务/ ti/ 被/ 分配/ 到/ 节点/ nj/ 上/ ,/ 则/ ti/ 和/ nj/ 局部/ 队列/ 中/ 执行/ 顺序/ 大于/ ti/ 的/ 那些/ 任务/ 必须/ 满足/ 下面/ 2/ 个/ 不等式/ :/ 其中/ ,/ estkj/ =/ estkj/ +/ eij/ +/ c/ (/ xij/ )/ ,/ 任务/ ti/ 在/ 节点/ nj/ 的/ 最早/ 开始/ 时间/ estij/ 可/ 被/ 计算/ 为/ estij/ =/ ai/ +/ ∑/ okj/ </ oij/ ,/ wk/ =/ 1/ 其中/ ,/ ai/ 为/ 任务/ ti/ 的/ 到达/ 时间/ ,/ rj/ 为/ 节点/ nj/ 上/ 正在/ 运行/ 任务/ 的/ 剩余/ 执行/ 时间/ ,/ ∑/ okj/ </ oij/ ,/ wk/ =/ 1/ 节点/ nj/ 等待/ 队列/ 中/ 执行/ 顺序/ 小于/ ti/ 的/ 任务/ 的/ 执行/ 时间/ (/ 包括/ 安全/ 开销/ )/ ./ 如果/ 任务/ tk/ 在/ 等待/ 队列/ 中/ ,/ 则/ wk/ =/ 1/ ,/ 否则/ wk/ =/ 0/ ./ 性质/ 2/ ./ 如果/ 步骤/ 3/ 开始/ 执行/ ,/ 那么/ 步骤/ 3/ 所/ 选择/ 的/ 节点/ nj/ 其/ 局部/ 队列/ 中/ 等待/ 任务/ tl/ 的/ 最早/ 开始/ 时间/ 需/ 重新/ 计算/ ./ (/ 1/ )/ 如果/ 任务/ tl/ 的/ 执行/ 顺序/ 小于/ 新/ 任务/ ti/ 的/ 执行/ 顺序/ ,/ 即/ olj/ </ oij/ ,/ 则/ 任务/ tl/ 的/ 最早/ 开始/ 时间/ 可/ 被/ 计算/ 为/ (/ 2/ )/ 如果/ 任务/ tl/ 的/ 执行/ 顺序/ 大于/ 新/ 任务/ ti/ 的/ 执行/ 顺序/ ,/ 即/ olj/ >/ oij/ ,/ 则/ 任务/ tl/ 的/ 最早/ 开始/ 时间/ 可/ 被/ 计算/ 为/ estlj/ =/ estlj/ -/ ∑/ okj/ </ oljPage6/ 其中/ c/ (/ xkj/ )/ 表示/ 当/ 任务/ tk/ 的/ 安全级别/ 降低/ 后/ 新/ 的/ 安全/ 开销/ ./ 注意/ ,/ 当/ 等待/ 任务/ 的/ 安全级别/ 降低/ 后/ ,/ 必须/ 满足/ 性质/ 1/ ./ DSRF/ 算法/ 的/ 伪/ 代码/ 如/ 算法/ 1/ 所示/ ./ DSRF/ 算法/ 是/ 一种/ 自/ 适应/ 调度/ 算法/ ,/ 在/ 保证/ 任务调度/ 成功率/ 的/ 基础/ 上/ 尽力/ 提高/ 任务/ 的/ 安全级别/ ./ 首先/ ,/ 新到/ 任务/ 被/ 指定/ 最高/ 的/ 安全级别/ (/ 见/ 第/ 2/ 行/ )/ ./ 如果/ 采用/ 最高/ 的/ 安全级别/ 不能/ 满足/ 性质/ 1/ ,/ 降低/ 新/ 任务/ 的/ 安全级别/ 直到/ 满足/ 性质/ 1/ (/ 见/ 第/ 3/ ~/ 17/ 行/ )/ ./ 如果/ 新/ 任务/ 采用/ 最小/ 的/ 安全级别/ 仍然/ 不能/ 满足/ 性质/ 1/ ,/ 选择/ 局部/ 队列/ 中/ 等待/ 任务/ 安全级别/ 之/ 和/ 最大/ 的/ 节点/ (/ 见/ 第/ 23/ 行/ )/ ,/ 采用/ 轮询/ 的/ 方式/ 降低/ 这些/ 等待/ 任务/ 的/ 安全级别/ 直到/ 满足/ 性质/ 1/ (/ 见/ 第/ 25/ ~/ 29/ 行/ )/ ./ 如果/ 这些/ 任务/ 的/ 安全级别/ 都/ 被/ 降到/ 最低/ 仍/ 不能/ 满足/ 性质/ 1/ ,/ 那么/ 拒绝/ 新/ 任务/ ,/ 否则/ 接收/ 这个/ 任务/ (/ 见/ 40/ ~/ 45/ 行/ )/ ./ 算法/ 1/ ./ DSRF/ 算法/ ./ 1/ ./ foreachnewtasktido2/ ./ find/ ←/ false/ ;/ sl/ (/ xij/ )/ ←/ max/ {/ sl/ }/ ;/ // / 初始化/ / // 3/ ./ whilesl/ (/ xij/ )/ !/ =/ min/ {/ sl/ }/ do4/ ./ earliestFinishTime/ ←/ ;/ // / 初始化/ / // 5/ ./ foreachnodenjintheclusterdo6/ ./ Calculaterjand/ ∑/ okj/ </ oij/ ,/ wk/ =/ 17/ ./ Calculatethefinishtimefij/ :/ 8/ ./ iffij/ </ earliestFinishTimethen9/ ./ earliestFinishTime/ ←/ fij/ ;/ findNode/ ←/ j/ ;/ 10/ ./ endif11/ ./ endfor12/ ./ ifestim/ +/ eim/ +/ c/ (/ xim/ )/ / diand/ / tk/ ,/ okm/ >/ oim/ :/ 13/ ./ find/ ←/ true/ ;/ break/ ;/ 14/ ./ else15/ ./ Degradeonesecurityleveling1/ ,/ g2org3by16/ ./ endif17/ ./ endwhile18/ ./ iffind/ =/ =/ truethen19/ ./ AllocatetitonodefindNode/ ;/ 20/ ./ Updateearlieststarttime/ (/ EST/ )/ oftasksin21/ ./ else22/ ./ degradeSum/ ←/ 0/ ;/ S/ ←/ / ;/ // / 初始化/ / // 23/ ./ Selectnodenlonwhichthesumofsecurity24/ ./ PutthesetasksintosetS/ ;/ 25/ ./ whileS/ !/ =/ / do26/ ./ degradeSum/ ++/ ;/ 27/ ./ foreachtasktkonnodenldo28/ ./ ifsl/ (/ xkl/ )/ !/ =/ min/ {/ sl/ }/ then29/ ./ sl/ (/ xkl/ )/ -/ =/ degradeSum/ ;/ 30/ ./ CalculatenewESTaccordingtoProperty2/ ;/ 31/ ./ ifestim/ +/ eim/ +/ c/ (/ xim/ )/ / diand/ / tk/ ,/ okm/ >/ 32/ ./ find/ ←/ true/ ;/ break/ ;/ 33/ ./ endif34/ ./ else35/ ./ RemovetkfromS/ ;/ 36/ ./ endif37/ ./ endfor38/ ./ iffind/ =/ =/ truethenbreak/ ;/ endif39/ ./ endwhile40/ ./ iffind/ =/ =/ truethen41/ ./ Allocatetitonodenl/ ;/ 42/ ./ UpdateESToftasksinthelocalqueueofnl/ ;/ 43/ ./ else44/ ./ Rejecttaskti/ ;/ 45/ ./ endif46/ ./ endif47/ ./ endfor/ 定理/ 1/ ./ DSRF/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ 3k/ (/ mn/ +/ n2/ )/ )/ ,/ 其中/ m/ 为/ 集群/ 中/ 的/ 节点/ 数/ ,/ n/ 为/ 一个/ 节点/ 局部/ 队列/ 中/ 等待/ 任务/ 数/ ,/ k/ 为/ 安全级别/ 个数/ ./ 证明/ ./ 计算/ 新/ 任务/ ti/ 在/ 一个/ 节点/ 上/ 的/ 完成/ 时间/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 6/ ~/ 7/ 行/ )/ ./ 验证/ ti/ 是否/ 能/ 满足/ 自身/ 和/ 在/ 同一/ 节点/ 的/ 局部/ 队列/ 中/ 执行/ 顺序/ 大于/ ti/ 的/ 那些/ 任务/ 的/ 时间/ 限制/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 12/ 行/ )/ ./ 更新/ 目标/ 节点/ 局部/ 队列/ 中/ 任务/ 的/ 最早/ 开始/ 时间/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 20/ 行/ )/ ./ 找到/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 安全级别/ 之/ 和/ 最大/ 的/ 节点/ (/ 选中/ 节点/ )/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ m/ )/ (/ 见/ 第/ 23/ 行/ )/ ./ 将/ 选中/ 节点/ 等待/ 队列/ 中/ 的/ 任务/ 复制到/ 集合/ S/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 24/ 行/ )/ ./ 降低/ 选中/ 节点/ 局部/ 队列/ 中/ 任务/ 的/ 安全级别/ ,/ 其/ 最坏/ 时间/ 复杂度/ 为/ O/ (/ 3kn2/ )/ (/ 见/ 第/ 25/ ~/ 39/ 行/ )/ ./ 如果/ 任务/ ti/ 能/ 被/ 分配/ ,/ 则/ 分配/ 该/ 任务/ 并/ 更新/ 所/ 分配/ 节点/ 局部/ 队列/ 中/ 任务/ 的/ 最早/ 开始/ 时间/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 41/ ~/ 42/ 行/ )/ ./ 其它/ 行/ 的/ 时间/ 复杂度/ 均/ 为/ O/ (/ 1/ )/ ./ 因此/ DSRF/ 算法/ 的/ 时间/ 复杂度/ 可/ 被/ 计算/ 为/ O/ (/ 3k/ )/ (/ O/ (/ m/ )/ (/ O/ (/ n/ )/ )/ )/ +/ 3O/ (/ n/ )/ +/ O/ (/ m/ )/ +/ O/ (/ 3nk2/ )/ =/ O/ (/ 3k/ (/ mn/ +/ n2/ )/ )/ ./ 证毕/ ./ 由于/ n/ 为/ 一个/ 节点/ 等待/ 队列/ 中/ 的/ 等待/ 任务/ 个数/ ,/ 所以/ n/ 的/ 值/ 较/ 小/ ./ 同时/ ,/ 在/ 实际/ 应用/ 中/ ,/ k/ 和/ m/ 也/ 不是/ 非常/ 大/ 的/ 数/ ,/ 因此/ DSRF/ 算法/ 的/ 时间/ 复杂度/ Page7/ 不高/ ./ 4.2/ FMSL/ 算法/ 为/ 使得/ 所/ 接收/ 任务/ 具有/ 较/ 公平/ 的/ 安全/ 服务/ ,/ 同时/ 进一步提高/ 任务/ 的/ 整体/ 安全级别/ ,/ 当/ 一新/ 任务/ 被/ 分配/ 到/ 某/ 一/ 节点/ 后/ ,/ FMSL/ 算法/ 将/ 对/ 该/ 节点/ 上/ 局部/ 队列/ 中/ 的/ 任务/ 做/ 进一步/ 处理/ ./ 节点/ nj/ 上/ 任务/ 安全级别/ 的/ 公平性/ 可用/ 任务/ 安全级别/ 的/ 标准差/ FLj/ 表示/ ,/ FMSL/ 算法/ 的/ 目标/ 即/ 在/ 不/ 影响/ 任务调度/ 成功率/ 的/ 基础/ 上/ 最小化/ FLj/ ./ FMSL/ 算法/ 的/ 核心思想/ 是/ 通过/ 降低/ 高级别/ 任务/ 的/ 安全级别/ 以/ 提高/ 低/ 级别/ 任务/ 的/ 安全级别/ ./ 当/ 一新/ 任务/ 被/ 分配/ 到/ 目标/ 节点/ 后/ ,/ 将/ 安全级别/ 相对/ 最高/ 和/ 相对/ 最低/ 的/ 任务/ 分别/ 拷贝到/ 集合/ maxSet/ 和/ minSet/ 中/ ./ 降低/ maxSet/ 集合/ 中/ 任务/ 的/ 安全级别/ 以/ 提高/ minSet/ 集合/ 中/ 任务/ 的/ 安全级别/ ,/ 在/ 这/ 一/ 过程/ 中/ 必须/ 保证/ 这些/ 任务/ 满足/ 时间/ 限制/ ,/ 且/ 局部/ 队列/ 中/ 这些/ 任务/ 的/ 整体/ 完成/ 时间/ 不/ 被/ 延迟/ ./ 下面/ 介绍/ FMSL/ 算法/ 的/ 一些/ 性质/ ./ 性质/ 3/ ./ 如果/ tp/ ∈/ maxSet/ ,/ tq/ ∈/ minSet/ ,/ 当/ opj/ </ oqj/ 时/ ,/ 则/ 必须/ 满足/ 下面/ 的/ 不等式/ :/ 其中/ estqj/ 和/ c/ (/ xqj/ )/ 分别/ 为/ 任务/ tq/ 的/ 安全级别/ 提高/ 后/ 新/ 的/ 最早/ 开始/ 时间/ 和/ 新/ 安全/ 开销/ ./ 其中/ c/ (/ xpj/ )/ 为/ tp/ 的/ 安全级别/ 降低/ 后/ 新/ 的/ 安全/ 开销/ ./ 执行/ 顺序/ 在/ 任务/ tp/ 和/ tq/ 执行/ 顺序/ 之间/ 的/ 任务/ tb/ ,/ 其/ 最早/ 开始/ 时间/ 可/ 被/ 重新/ 计算/ 为/ 早/ 开始/ 时间/ 可/ 被/ 重新/ 计算/ 为/ 执行/ 顺序/ 大于/ 任务/ tq/ 执行/ 顺序/ 的/ 任务/ ta/ ,/ 其/ 最/ estaj/ =/ estaj/ -/ (/ estqj/ +/ c/ (/ xqj/ )/ -/ estqj/ -/ c/ (/ xqj/ )/ )/ 图/ 2/ 给出/ 了/ 性质/ 3/ 的/ 一个/ 实例/ ,/ 其中/ fij/ 表示/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 完成/ 时间/ ./ 性质/ 4/ ./ 如果/ tp/ ∈/ maxSet/ ,/ tq/ ∈/ minSet/ ,/ 当/ opj/ >/ oqj/ 时/ ,/ 则/ 必须/ 满足/ 下面/ 的/ 不等式/ :/ 其中/ c/ (/ xqj/ )/ 为/ 任务/ tq/ 的/ 安全级别/ 提高/ 后/ 新/ 的/ 安全/ 开销/ ./ 执行/ 顺序/ 在/ 任务/ tp/ 和/ tq/ 执行/ 顺序/ 之间/ 的/ 任务/ tb/ ,/ 当/ tq/ 的/ 安全级别/ 提高/ 后/ ,/ 必须/ 满足/ 其/ 截止期/ :/ 其中/ estbj/ 为/ 新/ 最早/ 开始/ 时间/ ,/ 可/ 被/ 计算/ 为/ 任务/ tp/ 的/ 最早/ 开始/ 时间/ 计算方法/ 与/ tb/ 一致/ ,/ 同时/ 要/ 满足/ tp/ 的/ 新/ 完成/ 时间/ 要/ 小于/ 等于/ 原/ 完成/ 时间/ ,/ 以/ 保证/ 任务/ 的/ 调度/ 成功率/ ./ 早/ 开始/ 时间/ 可/ 被/ 重新/ 计算/ 为/ 执行/ 顺序/ 大于/ 任务/ tp/ 执行/ 顺序/ 的/ 任务/ ta/ ,/ 其/ 最/ estaj/ =/ estaj/ -/ (/ estpj/ +/ c/ (/ xpj/ )/ -/ estpj/ -/ c/ (/ xpj/ )/ )/ 图/ 3/ 给出/ 了/ 性质/ 4/ 的/ 一个/ 实例/ ./ FMSL/ 算法/ 的/ 伪/ 代码/ 如/ 算法/ 2/ 所示/ ./ 算法/ 2/ ./ FMSL/ 算法/ ./ 1/ ./ whiletruedo2/ ./ canAdjust/ ←/ false/ ;/ // / 初始化/ / // 3/ ./ Puttaskswithmaximalsecuritylevelandmini/ -/ 4/ ./ whilemaxSet/ !/ =/ / do5/ ./ GetatasktpfrommaxSet/ ;/ 6/ ./ whileminSet/ !/ =/ / do7/ ./ addLevel/ ←/ -/ 1/ ;/ // / 初始化/ / // 8/ ./ GetatasktqfromminSet/ ;/ 9/ ./ Degradesecurityleveloftponelevel/ ;/ 10/ ./ CalculateaddLeveloftq/ ;/ 11/ ./ ifaddLevel/ =/ =/ 0thencontinue/ ;/ endif12/ ./ ifopj/ >/ oqjthen13/ ./ whileaddLevel/ >/ 0do14/ ./ ifestqj/ +/ eqj/ +/ c/ (/ xqj/ )/ / dqandestbj/ +/ ebj/ +/ Page815/ ./ break/ ;/ 16/ ./ else17/ ./ addLevel/ -/ -/ ;/ 18/ ./ endif19/ ./ endwhile20/ ./ ifaddLevel/ !/ =/ 0then21/ ./ UpdateESToftasksinthelocalqueueby22/ ./ RemovetpfrommaxSet/ ;/ removetqfrom23/ ./ canAdjust/ ←/ true/ ;/ break/ ;/ 24/ ./ endif25/ ./ endif26/ ./ ifopj/ </ oqjthen27/ ./ UpdateESToftasksinthelocalqueueby28/ ./ RemovetpfrommaxSet/ ;/ removetqfrom29/ ./ endif30/ ./ GetnexttaskfromminSet/ ;/ 31/ ./ endwhile32/ ./ ifcanAdjust/ =/ =/ truethenbreak/ ;/ endif33/ ./ GetnexttaskfrommaxSet/ ;/ 34/ ./ endwhile35/ ./ ifcanAdjust/ =/ =/ falsethenbreak/ ;/ endif36/ ./ endwhileFMSL/ 算法/ 首先/ 将/ 节点/ 局部/ 队列/ 中/ 安全级别/ 相对/ 最高/ 和/ 安全级别/ 相对/ 最低/ 的/ 任务/ 分别/ 拷贝到/ 集合/ maxSet/ 和/ minSet/ 中/ (/ 见/ 第/ 3/ 行/ )/ ./ 从/ 集合/ maxSet/ 中/ 任选/ 一/ 任务/ tp/ ,/ 并/ 从/ 集合/ minSet/ 中/ 任选/ 一/ 任务/ tq/ ,/ 如果/ tp/ 降低/ 一个/ 安全级别/ 不能/ 使得/ tq/ 提高/ 一个/ 级别/ ,/ 那么/ 从/ minSet/ 选择/ 另外/ 一个/ 任务/ (/ 见/ 第/ 4/ ~/ 11/ 行/ )/ ./ 如果/ tp/ 的/ 执行/ 顺序/ 大于/ tq/ 的/ 执行/ 顺序/ ,/ 当/ tq/ 的/ 安全级别/ 被/ 提高/ 后/ ,/ 那么/ tq/ 和/ 执行/ 顺序/ 在/ tp/ 和/ tq/ 之间/ 的/ 那些/ 任务/ 不能/ 错失/ 其/ 截止期/ (/ 性质/ 4/ )/ ./ 如果/ 性质/ 4/ 不能/ 满足/ ,/ 降低/ 增加/ 的/ 安全级别/ 直到/ 满足/ 性质/ 4/ (/ 见/ 第/ 12/ ~/ 17/ 行/ )/ ./ 当/ tp/ 和/ tq/ 的/ 安全级别/ 调整/ 后/ ,/ 将/ tp/ 和/ tq/ 分别/ 从/ 集合/ maxSet/ 和/ minSet/ 中/ 移除/ ,/ 因为/ 它们/ 此时/ 已经/ 不/ 具有/ 相对/ 最高/ 和/ 最低/ 的/ 安全级别/ (/ 见/ 第/ 22/ 行/ )/ ./ 如果/ tp/ 的/ 执行/ 顺序/ 小于/ tq/ 的/ 执行/ 顺序/ ,/ 根据/ 性质/ 3/ 更新/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 最早/ 开始/ 时间/ 并/ 将/ tp/ 和/ tq/ 分别/ 从/ 集合/ maxSet/ 和/ minSet/ 中/ 移除/ (/ 见/ 第/ 26/ ~/ 29/ 行/ )/ ./ 如果/ 没有/ 任何/ 任务/ 的/ 安全级别/ 可以/ 调整/ ,/ 那么/ 结束/ 该/ 算法/ (/ 见/ 第/ 35/ 行/ )/ ./ 定理/ 2/ ./ FMSL/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ n2/ (/ k/ +/ n/ )/ )/ ,/ n/ 为/ 一个/ 节点/ nj/ 局部/ 队列/ 中/ 的/ 等待/ 任务/ 数/ ,/ k/ 为/ 安全级别/ 个数/ ./ 证明/ ./ 找到/ 节点/ nj/ 局部/ 队列/ 中/ 安全级别/ 相对/ 最高/ 和/ 相对/ 最低/ 的/ 任务/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 3/ 行/ )/ ./ 当/ tp/ 的/ 执行/ 顺序/ 大于/ tq/ 的/ 执行/ 顺序/ 时/ ,/ 降低/ 任务/ tq/ 提高/ 的/ 安全级别/ ,/ 以/ 满足/ tq/ 和/ 执行/ 顺序/ 在/ tp/ 和/ tq/ 之间/ 那些/ 任务/ 的/ 时间/ 要求/ ,/ 其/ 最坏/ 时间/ 复杂度/ 为/ O/ (/ k/ )/ (/ 见/ 第/ 13/ ~/ 19/ 行/ )/ ./ 根据/ 性质/ 4/ ,/ 更新/ nj/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 最早/ 开始/ 时间/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 21/ 行/ )/ ./ 当/ tp/ 的/ 执行/ 顺序/ 小于/ tq/ 的/ 执行/ 顺序/ 时/ ,/ 根据/ 性质/ 3/ ,/ 更新/ nj/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 最早/ 开始/ 时间/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n/ )/ (/ 见/ 第/ 27/ 行/ )/ ,/ 因此/ FMSL/ 算法/ 的/ 时间/ 复杂度/ 可/ 被/ 计算/ 为/ O/ (/ n/ )/ +/ O/ (/ n/ )/ (/ O/ (/ n/ )/ (/ (/ O/ (/ k/ )/ +/ O/ (/ n/ )/ )/ +/ O/ (/ n/ )/ )/ )/ =/ O/ (/ n2/ (/ k/ +/ n/ )/ )/ ./ 由于/ 局部/ 队列/ 中/ 的/ 等待/ 任务/ 数/ n/ 较/ 小/ ,/ 同时/ 在/ maxSet/ 和/ minSet/ 中/ 的/ 任务/ 数/ 还要/ 远/ 小于/ n/ ,/ 因此/ FMSL/ 算法/ 的/ 时间/ 复杂度/ 不高/ ./ 5/ 实验/ 测试/ 本文/ 通过/ 大量/ 的/ 模拟实验/ 结果/ 来/ 说明/ TPSS/ 策略/ 的/ 性能/ ./ 将/ 其/ 与/ RF/ [/ 19/ ]/ 、/ DSRF/ 和/ SAEDF/ [/ 32/ ]/ 的/ 结果/ 进行/ 比较/ ./ 为/ 公平/ 起/ 见/ ,/ 将/ RF/ 算法/ 进行/ 了/ 略微/ 修改/ ,/ 即/ 它/ 随机/ 选择/ 任务/ 的/ 安全级别/ ./ 本文/ 主要/ 从/ 以下/ 几个/ 方面/ 比较/ 了/ TPSS/ 、/ RF/ 、/ DSRF/ 和/ SAEDF/ 的/ 性能/ :/ (/ 1/ )/ 调度/ 成功率/ (/ GuaranteeRatio/ ,/ GR/ )/ ;/ (/ 2/ )/ 安全级别/ 均值/ (/ SecurityLevelAverage/ ,/ (/ 3/ )/ 安全级别/ 标准误差/ (/ SecurityLevelStand/ -/ (/ 4/ )/ 整体/ 系统/ 性能/ (/ OverallSystemPerform/ -/ SLA/ )/ ;/ ardDeviation/ ,/ SLSD/ )/ ;/ ance/ ,/ OSP/ ,/ OSP/ =/ GR/ / SLA/ // SLSD/ )/ ./ 5.1/ 模拟/ 方法/ 与/ 参数/ 异构/ 性/ 可以/ 分为/ 节点/ 异构/ 性/ 和/ 任务/ 异构/ 性/ [/ 16/ ]/ ./ 本文/ 在/ 实验/ 中/ 充分考虑/ 了/ 节点/ 和/ 任务/ 的/ 异构/ 性/ ./ 下面/ 给出/ 实验/ 的/ 模拟/ 方法/ :/ (/ 1/ )/ 为了/ 体现/ 节点/ 的/ 异构/ 性/ ,/ 用/ pj/ 表示/ 节点/ nj/ 的/ 处理/ 能力/ ./ pj/ 为/ 一正/ 实数/ ,/ pj/ 越大/ 节点/ 的/ 处理/ 能力/ 越强/ ./ 参数/ powerAverage/ 和/ powerSpan/ 分别/ 表示/ 节点/ 的/ 平均/ 处理/ 能力/ 和/ 处理/ 能力/ 的/ 浮动/ 范围/ ./ pj/ 均匀分布/ 在/ powerAverage/ -/ powerSpan/ 和/ power/ -/ Average/ +/ powerSpan/ 之间/ ./ (/ 2/ )/ hi/ 表示/ 任务/ ti/ 的/ 处理/ 难度/ ./ hi/ 为/ 一正/ 实数/ ,/ hi/ 越大/ 任务/ ti/ 在/ 同一/ 节点/ 上/ 的/ 执行/ 时间/ 越长/ ./ 参数/ hardnessAverage/ 和/ hardnessSpan/ 分别/ 表示/ 所有/ 任务/ 的/ 平均/ 处理/ 难度/ 和/ 处理/ 难度/ 的/ 浮动/ 范围/ ./ hiPage9/ 均匀分布/ 在/ hardnessAverage/ -/ hardnessSpan/ 和/ hardnessAverage/ +/ hardnessSpan/ 之间/ ,/ 用以/ 体现/ 任务/ 的/ 异构/ 性/ ./ (/ 3/ )/ 文献/ [/ 16/ ]/ 将/ 任务/ 执行/ 时间/ 矩阵/ 分为/ 一致/ (/ Consistent/ )/ 矩阵/ 和/ 不/ 一致/ (/ Inconsistent/ )/ 矩阵/ ./ 本文/ 中/ 的/ 任务/ 执行/ 矩阵/ 采用/ 一致/ 矩阵/ ,/ 即/ 任务/ 的/ 执行/ 时间/ 与/ 任务/ 的/ 处理/ 难度/ 成反比/ ,/ 与/ 节点/ 的/ 处理/ 能力/ 成正比/ ./ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 执行/ 时间/ eij/ 可以/ 表示/ 为/ eij/ =/ baseTime/ ×/ (/ hi/ // pj/ )/ ./ 参数/ baseTime/ 为/ 一正/ 实数/ ./ (/ 4/ )/ 任务/ ti/ 在/ 节点/ nj/ 上/ 的/ 安全/ 开销/ c/ (/ xij/ )/ 充分考虑/ 了/ 任务/ 异构/ 性/ 和/ 节点/ 异构/ 性/ ./ c/ (/ xij/ )/ 的/ 计算/ 如/ 公式/ (/ 3/ )/ 所示/ ./ (/ 5/ )/ 任务/ ti/ 的/ 截止期/ 可/ 被/ 计算/ 为/ di/ =/ ai/ +/ max/ {/ eij/ }/ +/ max/ {/ c/ (/ xij/ )/ }/ +/ baseDeadline/ ./ 其中/ ai/ 表示/ 任务/ ti/ 的/ 到达/ 时间/ ,/ max/ {/ eij/ }/ 表示/ ti/ 在/ 所有/ 节点/ 上/ 的/ 最长/ 执行/ 时间/ ,/ max/ {/ c/ (/ xij/ )/ }/ 表示/ ti/ 在/ 所有/ 节点/ 上/ 的/ 最大/ 安全/ 开销/ ,/ baseDeadline/ 为/ 一/ 随机/ 正/ 实数/ ,/ baseDeadline/ 越大/ ,/ 任务/ 截止期/ 越/ 宽松/ ./ (/ 6/ )/ 任务/ ti/ 的/ 到达/ 时间/ ai/ =/ ai/ -/ 1/ +/ intervalTime/ ,/ 图/ 4/ 节点/ 对/ 性能/ 的/ 影响/ 图/ 4/ (/ a/ )/ 显示/ 了/ DSRF/ 的/ 调度/ 成功率/ 一直/ 高于/ SAEDF/ 的/ 调度/ 成功率/ ,/ 这/ 是因为/ SAEDF/ 在/ 满足/ 新/ 任务/ 和/ 同一/ 节点/ 局部/ 队列/ 中/ 任务/ 截止期/ 的/ 前提/ 下/ ,/ 始终/ 为/ 新/ 任务/ 选择/ 尽可能/ 最高/ 的/ 安全级别/ ,/ 这/ 将/ 导致/ 新/ 任务/ 具有/ 较长/ 的/ 执行/ 时间/ ,/ 因此/ 在/ 系统/ 负载/ 较/ 重时/ ,/ 晚/ 到达/ 的/ 任务/ 具有/ 较晚/ 的/ 开始/ 时间/ ./ 如果/ 任务/ 其中/ ai/ -/ 1/ 表示/ ti/ 的/ 前/ 一个/ 任务/ ti/ -/ 1/ 的/ 到达/ 时间/ ,/ a0/ =/ 0/ ./ 参数/ intervalTime/ 为/ 一正/ 实数/ ,/ 决定/ 任务/ 的/ 到达/ 速度/ ./ (/ 7/ )/ 任务/ ti/ 的/ 数据/ 大小/ si/ 正比/ 于/ ti/ 的/ 处理/ 难度/ ./ 表/ 4/ 给出/ 了/ 实验/ 中/ 的/ 参数值/ ./ si/ =/ baseSize/ ×/ hi/ ./ 参数/ baseSize/ 为/ 一正/ 实数/ ./ powerAveragehardnessAveragehardnessSpanbaseDeadlineintervalTime/ 安全/ 服务/ 权值/ w1/ =/ 0.2/ ,/ w2/ =/ 0.5/ ,/ w3/ =/ 0.35/ ./ 2/ 节点/ 对/ 性能/ 的/ 影响/ DSRF/ 和/ SAEDF/ 的/ 影响/ ./ 实验/ 结果/ 如图/ 4/ 所示/ ./ 本节/ 通过/ 一组/ 实验/ 来/ 观察/ 节点/ 数对/ TPSS/ 、/ RF/ 、/ 的/ 开始/ 时间延迟/ ,/ 那么/ 任务/ 错失/ 其/ 截止期/ 的/ 概率/ 增大/ ./ 与/ SAEDF/ 不同/ 的/ 是/ ,/ 当/ 系统/ 负载/ 较/ 重时/ ,/ DSRF/ 将/ 任务/ 的/ 调度/ 成功率/ 作为/ 系统/ 的/ 主要/ 目标/ ./ DSRF/ 通过/ 降低/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 安全级别/ ,/ 提高/ 了/ 系统/ 的/ 调度/ 成功率/ ./ 需要/ 注意/ 的/ 是/ ,/ 任务/ 的/ 安全级别/ 降到/ 最低/ 仍/ 在/ 系统/ 可/ 接受/ 的/ 安全级别/ 范围/ 内/ ./ 从/ Page10/ 图/ 4/ (/ a/ )/ 中/ 可以/ 看出/ ,/ TPSS/ 的/ 调度/ 成功率/ 有时/ 略高于/ DSRF/ 的/ 调度/ 成功率/ ,/ 这/ 是因为/ TPSS/ 中/ 的/ FMSL/ 算法/ 在/ 调整/ 局部/ 队列/ 中/ 任务/ 的/ 安全级别/ 时/ ,/ 有时/ 会/ 使得/ 所有/ 任务/ 的/ 新/ 总体/ 完成/ 时间/ 略/ 早于/ 原/ 完成/ 时间/ ,/ 因此/ 后/ 到/ 任务/ 的/ 最早/ 开始/ 时间/ 提前/ ,/ 使得/ 任务/ 的/ 调度/ 成功率/ 略有/ 增加/ (/ 图/ 2/ 、/ 图/ 3/ 的/ 例子/ 也/ 表明/ 这/ 一点/ )/ ./ 图/ 4/ (/ a/ )/ 还/ 显示/ 了/ 当/ 节点/ 数/ 小于/ 24/ 时/ ,/ RF/ 具有/ 最低/ 的/ 调度/ 成功率/ ,/ 但是/ 当/ 节点/ 数/ 大于/ 40/ 时/ ,/ RF/ 具有/ 最高/ 的/ 调度/ 成功率/ ,/ 这/ 是因为/ RF/ 随机/ 选取/ 任务/ 的/ 安全级别/ ,/ 因此/ 调度/ 成功率/ 不/ 确定/ ./ 图/ 4/ (/ b/ )/ 显示/ 了/ 当/ 节点/ 数/ 小于/ 24/ 时/ ,/ SAEDF/ 的/ 安全级别/ 均值/ 高于/ DSRF/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ SAEDF/ 尽力/ 提高/ 接收/ 任务/ 的/ 安全级别/ 而/ 未/ 考虑/ 系统/ 的/ 负载/ 情况/ ./ 相反/ ,/ 尽管/ DSRF/ 的/ 安全级别/ 均值/ 略低于/ SAEDF/ 的/ 安全级别/ 均值/ ,/ 但是/ DSRF/ 具有/ 较/ 高/ 的/ 调度/ 成功率/ ./ 从图/ 4/ (/ b/ )/ 可/ 看出/ ,/ TPSS/ 的/ 安全级别/ 均值/ 一直/ 高于/ SAEDF/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ TPSS/ 算法/ 在/ 调整/ 任务/ 安全级别/ 时/ ,/ 一个/ 高/ 安全级别/ 任务/ 被/ 降低/ 一个/ 安全级别/ 后/ ,/ 可以/ 使得/ 一个/ 低/ 安全级别/ 任务/ 提高/ 一到/ 多个/ 安全级别/ ,/ 因此/ 任务/ 的/ 整体/ 安全级别/ 提高/ 了/ ./ 当/ 节点/ 数/ 大于/ 24/ 时/ ,/ DSRF/ 具有/ 和/ SAEDF/ 基本相同/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ 当/ 系统/ 负载/ 较轻时/ ,/ DSRF/ 能够/ 充分利用/ 任务/ 截止期/ 前/ 的/ 空闲/ 时间/ ,/ 提高/ 任务/ 的/ 安全级别/ ./ 因图/ 5/ (/ a/ )/ 表明/ ,/ 当/ 到达/ 时间/ 较/ 小时/ ,/ 任务/ 的/ 到达/ 速度/ 较/ 快/ ,/ 使得/ 在/ 节点/ 局部/ 队列/ 中/ 的/ 等待/ 任务/ 较/ 多/ ,/ 图/ 5/ 任务/ 达到/ 速度/ 对/ 性能/ 的/ 影响/ 此/ TPSS/ 具有/ 很强/ 的/ 自适应性/ ./ 图/ 4/ (/ c/ )/ 显示/ 了/ TPSS/ 的/ 安全级别/ 标准误差/ 一直/ 小于/ DSRF/ 和/ SAEDF/ 的/ 安全级别/ 标准误差/ ./ 这/ 可/ 解释/ 为/ TPSS/ 中/ 的/ FMSL/ 算法/ 在/ 保证/ 局部/ 队列/ 中/ 任务/ 时间/ 限制/ 的/ 前提/ 下/ ,/ 均衡/ 任务/ 的/ 安全级别/ ,/ 使得/ 任务/ 具有/ 较/ 公平/ 的/ 安全/ 服务/ ./ 相反/ ,/ DSRF/ 和/ SAEDF/ 没有/ 考虑/ 这/ 一点/ ./ 当/ 节点/ 数较/ 少时/ ,/ 系统/ 负载/ 较/ 重/ ,/ 先到/ 任务/ 具有/ 较/ 高/ 的/ 安全级别/ ,/ 而/ 晚到/ 任务/ 则/ 需要/ 通过/ 降低/ 其/ 安全级别/ 才/ 可能/ 保证/ 被/ 调度/ ,/ 因此/ 任务/ 的/ 安全级别/ 差异/ 较大/ ./ 随着/ 节点/ 数/ 的/ 增加/ ,/ 系统/ 负载/ 减轻/ ,/ 能够/ 保证/ 任务/ 在/ 接收/ 的/ 同时/ 具有/ 较/ 高/ 的/ 安全级别/ ,/ 因此/ 安全级别/ 标准误差/ 降低/ ./ 由于/ RF/ 随机/ 选取/ 安全级别/ ,/ 因此/ RF/ 的/ 安全级别/ 标准误差/ 与/ 节点/ 数/ 不/ 具有/ 线性关系/ ./ 图/ 4/ (/ d/ )/ 显示/ 了/ TPSS/ 的/ 总体/ 系统/ 性能/ 明显/ 好于/ 其它/ 算法/ ,/ 平均/ 高于/ RF/ 、/ SAEDF/ 和/ DSRF45/ ./ 2/ %/ 、/ 53.9/ %/ 和/ 67.7/ %/ ./ 图/ 4/ (/ d/ )/ 表明/ ,/ 当/ 节点/ 数较/ 多时/ ,/ TPSS/ 的/ 整体/ 性能/ 增加/ 显著/ ,/ 这/ 意味着/ 在/ 系统/ 负载/ 较轻时/ ,/ 系统/ 性能/ 收益/ 较大/ ./ 5.3/ 任务/ 到达/ 速度/ 对/ 性能/ 的/ 影响/ 本/ 节/ 我们/ 通过/ 一组/ 实验/ 来/ 观察/ 任务/ 到达/ 速度/ 对/ 对/ TPSS/ 、/ RF/ 、/ DSRF/ 和/ SAEDF/ 的/ 影响/ ./ 在/ 本组/ 实验/ 中/ 调整/ 参数/ intervalTime/ 从/ 0.5/ ~/ 1.5/ ,/ 步长/ 为/ 0.1/ ./ 实验/ 结果/ 如图/ 5/ 所示/ ./ 所以/ 一些/ 晚/ 到达/ 任务/ 由于/ 具有/ 较晚/ 的/ 开始/ 时间/ 而/ 错失/ 其/ 截止期/ ./ 随着/ 到达/ 时间/ 值/ 的/ 增大/ ,/ 任务/ 的/ 到达/ 速/ Page11/ 度/ 变慢/ ,/ 使得/ 在/ 节点/ 局部/ 队列/ 中/ 的/ 任务/ 较/ 少/ ,/ 任务/ 具有/ 较/ 早/ 的/ 开始/ 时间/ ,/ 因此/ 任务/ 的/ 调度/ 成功率/ 增加/ ./ 从图/ 5/ (/ a/ )/ 可以/ 看出/ ,/ TPSS/ 和/ DSRF/ 相比/ 于/ SAEDF/ 具有/ 较/ 高/ 的/ 调度/ 成功率/ ,/ 这/ 是因为/ DSRF/ 通过/ 降低/ 等待/ 队列/ 中/ 任务/ 的/ 安全级别/ ,/ 减小/ 了/ 这些/ 任务/ 的/ 运行/ 时间/ ,/ 因此/ 更/ 多/ 的/ 任务/ 因为/ 具有/ 较/ 早/ 的/ 开始/ 时间/ 而/ 被/ 接收/ ./ 相反/ ,/ SAEDF/ 始终保持/ 所/ 接收/ 任务/ 的/ 安全级别/ 保持/ 不变/ ,/ 因此/ 一些/ 任务/ 由于/ 具有/ 较晚/ 开始/ 时间/ 而/ 错失/ 截止期/ ,/ 不能/ 被/ 接收/ ./ 尤其/ 是/ 当/ 任务/ 达到/ 速度/ 很快/ 时/ ,/ DSRF/ 具有/ 更/ 高/ 的/ 调度/ 成功率/ ,/ 这/ 是因为/ DSRF/ 是/ 一种/ 自/ 适应/ 调度/ 算法/ ,/ 当/ 任务/ 到达/ 速度/ 较/ 快/ 使得/ 系统/ 负载/ 较/ 重时/ ,/ 调度/ 成功率/ 是/ DSRF/ 算法/ 的/ 主要/ 目标/ ./ 图/ 5/ (/ a/ )/ 还/ 显示/ ,/ 当/ 到达/ 时间/ 值/ 大于/ 0.7/ 时/ ,/ RF/ 的/ 调度/ 成功率/ 高于/ 其它/ 方法/ ,/ 这/ 是因为/ RF/ 随机/ 选取/ 任务/ 的/ 安全级别/ ,/ 从图/ 5/ (/ b/ )/ 可以/ 看出/ 此时/ RF/ 选择/ 的/ 安全级别/ 均值/ 最低/ ,/ 因此/ 具有/ 较/ 高/ 的/ 调度/ 成功率/ ./ 图/ 5/ (/ b/ )/ 显示/ ,/ 当/ 到达/ 时间/ 值/ 小于/ 1.3/ 时/ ,/ SAEDF/ 的/ 安全级别/ 均值/ 略高于/ DSRF/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ SAEDF/ 过于/ 追求/ 当前/ 新到/ 任务/ 的/ 高/ 安全级别/ ,/ 而/ 没有/ 考虑/ 后/ 到/ 任务/ 的/ 调度/ 成功率/ ./ 相反/ ,/ DSRF/ 图/ 6/ 节点/ 异构/ 性对/ 性能/ 的/ 影响/ 图/ 6/ (/ a/ )/ 显示/ ,/ 随着/ 节点/ 异构/ 性/ 的/ 增大/ ,/ 调度/ 成功率/ 有所增加/ ,/ 这是/ 由于/ 节点/ 性能/ 降低/ 导致/ 所/ 接收/ 任务/ 的/ 减少/ 数目/ 要/ 小于/ 节点/ 性能/ 提高/ 导致/ 所/ 接收/ 任务/ 的/ 增加/ 数目/ ./ 从图/ 6/ (/ a/ )/ 中/ 可以/ 看出/ 尽管/ 节点/ 的/ 异构/ 性/ 变化/ 较大/ ,/ 但/ TPSS/ 的/ 调度/ 成功率/ 一直/ 高于/ 算法/ 采用/ 自/ 适应/ 的/ 调度/ 策略/ ,/ 在/ 系统/ 负载/ 较/ 重时/ ,/ 通过/ 降低/ 节点/ 局部/ 队列/ 中/ 等待/ 任务/ 的/ 安全级别/ 提高/ 了/ 任务/ 的/ 调度/ 成功率/ ./ 当/ 到达/ 时间/ 值/ 大于/ 1.3/ 时/ ,/ DSRF/ 和/ SAEDF/ 具有/ 相似/ 的/ 安全级别/ 均值/ ,/ 这种/ 情况/ 是因为/ 当/ 任务/ 到达/ 速度/ 较慢/ 时/ ,/ DSRF/ 算法/ 不必/ 通过/ 降低/ 任务/ 的/ 安全级别/ 来/ 接收/ 新/ 任务/ ,/ 此时/ 提高/ 任务/ 的/ 安全级别/ 变成/ 了/ DSRF/ 的/ 主要/ 目标/ ./ 从图/ 5/ (/ c/ )/ 可以/ 看出/ ,/ TPSS/ 相比/ SAEDF/ 具有/ 较/ 小/ 的/ 安全级别/ 标准误差/ ,/ 尤其/ 是/ 当/ 任务/ 到达/ 速度/ 较/ 快/ 时/ ,/ 这/ 是因为/ FMSL/ 算法/ 起到/ 的/ 作用/ 使得/ 所/ 接收/ 任务/ 间/ 的/ 安全级别/ 差异/ 较/ 小/ ./ 图/ 5/ (/ d/ )/ 给出/ 了/ 整体/ 的/ 系统/ 性能/ ,/ TPSS/ 的/ 整体/ 系统/ 性能/ 明显/ 好于/ 其它/ 算法/ ,/ 这/ 说明/ 对于/ 非/ 周期/ 任务/ ,/ TPSS/ 具有/ 更强/ 的/ 灵活性/ 和/ 可靠性/ ./ 5.4/ 节点/ 异构/ 性对/ 性能/ 的/ 影响/ 本/ 节/ 我们/ 通过/ 一组/ 实验/ 来/ 观察/ 节点/ 异构/ 性对/ TPSS/ 、/ RF/ 、/ DSRF/ 和/ SAEDF/ 的/ 影响/ ./ 实验/ 中/ 用/ 参数/ powerSpan/ 代表/ 节点/ 的/ 异构/ 性/ 变化/ ,/ powerSpan/ 增大/ ,/ 则/ 节点/ 的/ 异构/ 性/ 增大/ ,/ 反之/ 减小/ ./ 实验/ 结果/ 如图/ 6/ 所示/ ./ DSRF/ 和/ SAEDF/ 的/ 调度/ 成功率/ ./ 同时/ ,/ 在/ 参数/ powerSpan/ 的/ 值/ 为/ 50/ 时/ ,/ RF/ 的/ 调度/ 成功率/ 高于/ TPSS/ 的/ 调度/ 成功率/ ,/ 但是/ 此时/ ,/ RF/ 随机/ 选择/ 的/ 安全级别/ 最低/ ,/ 因此/ 具有/ 较/ 高/ 的/ 调度/ 成功率/ ./ 图/ 6/ (/ b/ )/ 显示/ 了/ TPSS/ 、/ DSRF/ 和/ SAEDF/ 的/ 安全/ Page12/ 级别/ 均值/ 明显/ 高于/ RF/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ TPSS/ 、/ DSRF/ 和/ SAEDF/ 在/ 调度/ 过程/ 中/ 会/ 优化/ 任务/ 的/ 安全级别/ ,/ 而/ RF/ 没有/ 考虑/ 到/ 这/ 一点/ ./ 从图/ 6/ (/ b/ )/ 中/ 可以/ 看出/ ,/ 当/ powerSpan/ 小于/ 400/ 时/ ,/ SAEDF/ 的/ 安全级别/ 均值/ 高于/ DSRF/ 的/ 安全级别/ 均值/ ,/ 但是/ TPSS/ 相对/ 于/ SAEDF/ 却/ 具有/ 较/ 高/ 的/ 安全级别/ 均值/ ,/ 这/ 是因为/ TPSS/ 中/ 的/ FMSL/ 算法/ 可/ 使得/ 任务/ 的/ 整体/ 安全级别/ 进一步提高/ ./ 从图/ 6/ (/ c/ )/ 可是/ 看出/ ,/ TPSS/ 的/ 安全级别/ 标准误差/ 小于/ DSRF/ 和/ SAEDF/ 的/ 安全级别/ 标准误差/ ,/ 因为/ FMSL/ 算法/ 通过/ 调整/ 任务/ 的/ 安全级别/ ,/ 减小/ 了/ 任务/ 安全级别/ 之间/ 的/ 差异/ ./ 此外/ ,/ 图/ 6/ (/ c/ )/ 显示/ 了/ 有时/ RF/ 相对/ TPSS/ 具有/ 更/ 低/ 的/ 安全级别/ 标准误差/ ,/ 这/ 是因为/ RF/ 随机/ 选取/ 的/ 安全级别/ 均/ 较/ 低/ ,/ 因此/ 安全级别/ 的/ 差异/ 较/ 低/ ./ 图/ 6/ (/ d/ )/ 显示/ 了/ 整体/ 系统/ 性能/ ,/ TPSS/ 的/ 整体/ 系统/ 性能/ 平均/ 高于/ RF/ 、/ SAEDF/ 和/ DSRF/ 的/ OPS48/ ./ 3/ %/ 、/ 56.7/ %/ 和/ 88.7/ %/ ./ 因此/ TPSS/ 适合/ 于/ 异构/ 集群/ 系统/ 环境/ ./ 6/ 结论/ 本文/ 提出/ 了/ 一种/ 异构/ 集群/ 系统/ 中/ 处理/ 安全/ 关键/ 实时/ 应用/ 的/ 调度/ 器/ 模型/ ./ 在/ 该/ 调度/ 器/ 模型/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一种/ 2/ 阶段/ 的/ 调度/ 策略/ —/ —/ —/ TPSS/ ./ 在/ 第/ 1/ 阶段/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 调度/ 算法/ DSRF/ ,/ 用于/ 任务/ 的/ 实时/ 调度/ ./ DSRF/ 能够/ 根据/ 系统/ 的/ 负载/ 情况/ ,/ 自/ 适应/ 地/ 调整/ 调度/ 目标/ ./ 当/ 系统/ 负载/ 较/ 重时/ ,/ DSRF/ 算法/ 在/ 满足/ 系统/ 基本/ 安全/ 保障/ 的/ 同时/ ,/ 将/ 调度/ 成功率/ 作为/ 调度/ 的/ 主要/ 目标/ ;/ 当/ 系统/ 负载/ 较轻时/ ,/ DSRF/ 算法/ 能够/ 在/ 保证系统/ 具有/ 较/ 高/ 调度/ 成功率/ 的/ 基础/ 上/ ,/ 充分利用/ 任务/ 截止期/ 前/ 的/ 空闲/ 时间/ 提高/ 任务/ 的/ 安全级别/ ./ 在/ 第/ 2/ 阶段/ ,/ 提出/ 了/ 一种/ 用来/ 为/ 所/ 接收/ 任务/ 提供/ 公平/ 安全/ 服务/ 的/ 算法/ FMSL/ ./ FMSL/ 算法/ 在/ 不/ 降低/ 任务调度/ 成功率/ 的/ 基础/ 上/ ,/ 通过/ 减小/ 节点/ 局部/ 队列/ 中/ 任务/ 之间/ 的/ 安全级别/ 差异/ 来/ 为/ 任务/ 提供/ 较为/ 公平/ 的/ 服务/ ,/ 从而/ 降低/ 了/ 任务/ 被/ 攻击/ 的/ 概率/ ./ 另外/ ,/ FMSL/ 算法/ 在/ 调整/ 任务/ 安全级别/ 的/ 过程/ 中/ 能够/ 进一步提高/ 任务/ 的/ 整体/ 安全级别/ ./ 最后/ ,/ 通过/ 大量/ 的/ 模拟实验/ 对/ TPSS/ 、/ RF/ 、/ SAEDF/ 和/ DSRF/ 进行/ 了/ 比较/ ,/ 实验/ 结果表明/ ,/ TPSS/ 的/ 性能/ 优于/ 其它/ 算法/ ,/ 适合/ 于/ 异构/ 集群/ 系统/ 环境/ ,/ 尤其/ 是/ 任务/ 达到/ 速度/ 变化/ 较大/ 、/ 节点/ 动态/ 加入/ 或/ 退出/ 集群/ 等/ 情况/ ,/ 使得/ 系统/ 具有/ 较强/ 的/ 安全性/ 和/ 灵活性/ ./ 

