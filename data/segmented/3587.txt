Page1/ 计算/ 可靠/ 且/ 高效/ 的/ 群组/ 密钥/ 协商/ 协议/ 符号化/ 分析方法/ 张子/ 剑/ 1/ )/ 祝烈/ 煌/ 1/ )/ 王峰/ 2/ )/ 廖乐健/ 1/ )/ 1/ )/ (/ 北京理工大学/ 计算机/ 学院/ 北京/ 100081/ )/ 2/ )/ (/ 海军/ 装备/ 研究院/ 北京/ 100161/ )/ 摘要/ 符号化/ 分析方法/ 将/ 密码/ 原语/ 视为/ 黑盒/ ,/ 且/ 未/ 研究/ 其/ 需要/ 满足/ 的/ 具体/ 安全/ 属性/ ,/ 因而/ 计算/ 可靠性/ 一直/ 备受/ 质疑/ ./ 而且/ ,/ 这/ 类/ 方法/ 在/ 分析/ 参与者/ 数目/ 较/ 多/ 的/ 群组/ 密钥/ 协商/ 协议/ 时/ 不/ 具有/ 高效性/ ./ 针对/ 上述/ 两个/ 问题/ ,/ 文中/ 提出/ 了/ 一种/ 计算/ 可靠/ 且/ 高效/ 的/ 群组/ 密钥/ 协商/ 协议/ 符号化/ 分析方法/ ./ 该/ 方法/ 通过/ 为/ 符号化/ 表达式/ 设计/ 一个/ Pattern/ 函数/ ,/ 定义/ 了/ 模幂/ 运算/ 需要/ 满足/ 的/ 具体/ 安全/ 属性/ ,/ 并/ 基于/ 此/ 证明/ 了/ 符号化/ 分析/ Burmester/ -/ Desmedt/ 协议/ 在/ 通用/ 可/ 组合/ 安全/ 框架/ 下/ 是/ 计算/ 可靠/ 的/ ./ 进而/ 通过/ 数学/ 归纳法/ ,/ 证明/ 了/ Burmester/ -/ Desmedt/ 协议/ 的/ 安全性/ 与/ 参与者/ 数目/ 无关/ ,/ 避免/ 了/ 参与者/ 数目/ 对/ 符号化/ 分析/ 造成/ 的/ 影响/ ,/ 提高/ 了/ 符号化/ 分析方法/ 的/ 效率/ ./ 关键词/ 计算/ 可靠/ ;/ 高效/ ;/ 符号化/ 分析/ ;/ 通用/ 可/ 组合/ ;/ 群组/ 密钥/ 协商/ 1/ 引言/ 随着/ 群组/ 通信/ 应用/ 的/ 发展/ 以及/ 用户数/ 目的/ 增长/ ,/ 针对/ 群组/ 通信/ 的/ 攻击/ 层出不穷/ ,/ 群组/ 密钥/ 协商/ 协议/ 作为/ 群组/ 通信/ 的/ 基础/ 首当其冲/ ./ 为此/ ,/ 严格/ 分析/ 群组/ 密钥/ 协商/ 协议/ 的/ 安全性/ 变得/ 十分必要/ ./ 传统/ 的/ 密码/ 协议/ 分析方法/ 主要/ 包括/ 可证/ 安全/ [/ 1/ -/ 3/ ]/ 与/ 符号化/ 分析/ [/ 4/ -/ 6/ ]/ 两类/ ./ 前者/ 由于/ 将/ 协议/ 的/ 安全性/ 归约/ 到/ 数学/ 困难/ 假设/ 的/ 难解/ 性/ ,/ 所以/ 分析/ 结果/ 是/ 计算/ 可靠/ 的/ ./ 但/ 该/ 方法/ 的/ 证明/ 过程/ 冗长/ 且/ 繁琐/ ,/ 难以实现/ 自动化/ [/ 7/ ]/ ./ 相反/ 地/ ,/ 后者/ 假定/ 密码/ 原语/ 均/ 具有/ 理想/ 的/ 安全/ 属性/ ,/ 并/ 将/ 密码/ 原语/ 、/ 敌手/ 能力/ 等/ 抽象/ 为/ 一个/ 符号化/ 代数/ 系统/ [/ 8/ ]/ ,/ 因而/ 容易/ 实现/ 自动化/ 分析/ ./ 但是/ ,/ 由于/ 该/ 方法/ 没有/ 考虑/ 实现/ 密码/ 原语/ 的/ 实际/ 算法/ 应有/ 的/ 具体/ 安全/ 属性/ ,/ 因而/ 与/ 可证/ 安全/ 相比/ ,/ 分析/ 结果/ 的/ 可靠性/ 一直/ 备受/ 质疑/ [/ 9/ -/ 11/ ]/ ./ 例如/ ,/ 针对/ 对称/ 加密/ 方案/ ,/ 我们/ 通常/ 定义/ 术语/ Enc/ (/ k/ ,/ m/ )/ 来/ 表示/ 用/ 密钥/ k/ 加密/ 明文/ m/ ,/ 并/ 通过/ 建立/ 规则/ Dec/ (/ k/ ,/ Enc/ (/ k/ ,/ m/ )/ )/ =/ m/ 表示/ 只有/ 具有/ 密钥/ k/ ,/ 密文/ 才能/ 被/ 解密/ 还原/ 出/ 明文/ m/ ./ 这/ 两个/ 抽象/ 虽然/ 简化/ 了/ 符号化/ 分析/ 的/ 过程/ ,/ 但/ 却/ 没有/ 清晰/ 地/ 阐明/ 实际/ 加密/ 方案/ 应/ 满足/ 的/ 安全/ 属性/ ,/ 比如/ 是否/ 限制/ 所有/ 密文/ 的/ 长度/ 必须/ 相同/ ,/ 是否/ 需要/ 加密算法/ 具有/ 不确定性/ 等/ [/ 12/ ]/ ./ 而且/ ,/ 符号化/ 方法/ 分析/ 协议/ 安全性/ 所/ 需/ 的/ 时间/ 随着/ 协议/ 参与者/ 数目/ 的/ 增长/ 而/ 急剧/ 增加/ [/ 13/ ]/ ,/ 因而/ 在/ 分析/ 参与者/ 数目/ 较/ 多/ 的/ 群组/ 密钥/ 协商/ 协议/ 时/ 效率/ 较/ 低/ ./ 为此/ ,/ 我们/ 考虑/ 通过/ 结合/ 符号化/ 分析方法/ 与/ 可证/ 安全/ ,/ 实现/ 一种/ 计算/ 可靠/ 且/ 高效/ 的/ 群组/ 密钥/ 协商/ 协议/ 分析方法/ ./ 目前/ ,/ 国内外/ 学者/ 针对/ 计算/ 可靠/ 的/ 符号化/ 分析方法/ 已经/ 进行/ 了/ 广泛/ 的/ 研究/ ./ 针对/ 被动/ 敌手/ ,/ Abadi/ 和/ Rogaway/ [/ 12/ ]/ 率先/ 提出/ 了/ 一种/ 计算/ 可靠/ 的/ 符号化/ 对称/ 加密算法/ ./ Micciancio/ 和/ Warinschi/ [/ 14/ ]/ 指出/ Abadi/ 和/ Rogaway/ 的/ 工作/ 不是/ 完备/ 的/ ,/ 提出/ 了/ 一种/ 无/ 歧义/ (/ confusionfree/ )/ 的/ 加密算法/ ,/ 并/ 证明/ 了/ 其/ 完备/ 性/ ./ Laud/ 和/ Corin/ [/ 10/ ]/ 针对/ 可/ 组合/ 的/ 密钥/ 提出/ 了/ 一种/ 可靠/ 的/ 对称/ 加密算法/ ./ Herzog/ [/ 11/ ]/ 提出/ 了/ 一种/ 可靠/ 的/ 公钥/ 加密算法/ ./ Gracia/ 和/ vanRossum/ [/ 15/ ]/ 提出/ 了/ 一种/ 可靠/ 的/ Hash/ 函数/ ./ Kremer/ 和/ Mazar/ é/ [/ 16/ ]/ 提出/ 了/ 一种/ 可靠/ 的/ 双线性/ 映射/ ,/ 并/ 分析/ 了/ Joux/ 等/ 基于/ 双线性/ 映射/ 的/ 密码/ 协议/ ./ Bresson/ 等/ 人/ [/ 17/ ]/ 基于/ (/ P/ ,/ Q/ )/ -/ DDH/ 问题/ ,/ 分析/ 了/ Burmester/ -/ Desmedt/ 协议/ (/ 简写/ 为/ BD/ 协议/ )/ 的/ 安全性/ [/ 18/ ]/ ./ 但是/ ,/ 该/ 方法/ 既/ 未/ 给出/ 模/ 幂指数/ 间/ 的/ 模/ 加减/ 运算/ 以及/ 对应/ 简化/ 规则/ 的/ 符号化/ 定义/ ,/ 也/ 没有/ 实现/ 自动化/ 分析/ ./ 而且/ ,/ 由于/ 没有/ 结合/ 通用/ 可/ 组合/ (/ universallycomposable/ )/ 安全/ 框架/ (/ 简写/ 为/ UC/ 安全/ 框架/ )/ ,/ 因而/ 其/ 结果/ 不/ 具有/ 可/ 组合/ 安全性/ ./ 针对/ 主动/ 敌手/ ,/ Micciancio/ 和/ Warinschi/ [/ 19/ ]/ 通过/ 将/ 可证/ 安全/ 下/ 协议/ 的/ 执行/ 过程/ 映射/ 到/ 符号化/ 分析/ 下/ 协议/ 的/ 执行/ 过程/ ,/ 提出/ 了/ 一个/ 可靠/ 的/ 加密算法/ ./ Galindo/ 等/ 人/ [/ 20/ ]/ 利用/ 上述/ 映射/ 分析/ 了/ 非/ 延展/ 的/ 承诺/ 算法/ ./ Backes/ 和/ Unruh/ [/ 21/ ]/ 提出/ 了/ 一个/ 符号化/ 可靠/ 的/ 零/ 知识/ 证明/ 系统/ ./ Backes/ 等/ 人/ [/ 22/ ]/ 提出/ 了/ 一个/ 用于/ 自动/ 证明/ 密码/ 协议/ 的/ 理想/ 密码学/ 库/ Libideal/ ,/ 协议/ 如果/ 可以/ 模拟/ Libideal/ 即/ 是/ 安全/ 的/ ./ Canetti/ 等/ 人/ [/ 23/ -/ 25/ ]/ 最近/ 通过/ 结合/ UC/ 安全/ 框架/ 与/ spi/ 演算/ ,/ 提出/ 了/ 通用/ 可/ 组合/ 符号化/ 分析/ (/ UniversallyComposableSymbolicAnlaysis/ ,/ UCSA/ )/ 方法/ ,/ 虽然/ 该/ 方法/ 实现/ 了/ 计算/ 可靠/ 且/ 高效/ 的/ 分析/ 密码/ 协议/ 安全性/ ,/ 但/ 他们/ 只/ 证明/ 了/ 基于/ 加密/ 、/ 签名/ 以及/ Diffie/ -/ Hellman/ 的/ 双方/ 身份/ 认证/ 和/ 密钥/ 协商/ 协议/ ./ Zhang/ 和/ Zhu/ 等/ 人/ [/ 13/ ,/ 26/ ]/ 通过/ 扩展/ UCSA/ 方法/ ,/ 分析/ 了/ 基于/ 双线性/ 对/ 的/ 群组/ 密钥/ 协商/ 协议/ 以及/ 具有/ 3/ 个/ 参与者/ 的/ BD/ 协议/ ./ 但是/ 他们/ 没有/ 考虑/ 具有/ 任意/ 数目/ 参与方/ 的/ BD/ 协议/ ./ 本文/ 为模/ 幂/ 运算/ 设计/ 了/ 一个/ 符号化/ 模型/ ,/ 并/ 证明/ 该/ 模型/ 是/ 计算/ 可靠/ 的/ ./ 在/ 此基础/ 上/ ,/ 通过/ 扩展/ Canetti/ 的/ 方案/ [/ 24/ ]/ ,/ 以/ Burmester/ -/ Desmedt/ 协议/ 为例/ ,/ 证明/ 符号化/ 分析/ 结果/ 在/ UC/ 安全/ 框架/ 下/ 是/ 计算/ 可靠/ 的/ ./ 进而/ 利用/ 数学/ 归纳法/ ,/ 证明/ 符号化/ 分析/ BD/ 协议/ 时/ 参与者/ 数目/ 与/ 协议/ 的/ 安全性/ 无关/ ./ 因此/ ,/ 面对/ 参与者/ 数目/ 较/ 多/ 的/ BD/ 协议/ 时/ ,/ 我们/ 只/ 需/ 符号化/ 分析/ 具有/ 三个/ 参与者/ 的/ BD/ 协议/ 即可/ ,/ 而且/ 分析/ 结果/ 具有/ 计算/ 可靠性/ ./ Katz/ 和/ Yung/ [/ 27/ ]/ 设计/ 了/ 一个/ 编译器/ ,/ 将/ 在/ 被动/ 环境/ (/ passivesetting/ )/ 下/ 安全/ 的/ 协议/ 编译/ 为/ 在/ 主动/ 环境/ 下/ (/ activesetting/ )/ 外部/ 攻击/ (/ outsiderattack/ )/ 安全/ 的/ 协议/ ./ Katz/ 和/ Shin/ [/ 28/ ]/ 也/ 设计/ 了/ 一个/ 编译器/ ,/ 将/ 在/ 主动/ 环境/ 下/ 外部/ 攻击/ 安全/ 的/ 协议/ 编译/ 为/ 在/ 主动/ 环境/ 下/ 内部/ 攻击/ (/ insiderattack/ )/ 安全/ 的/ 协议/ ./ 另外/ ,/ UCSA/ 方法/ 保证/ 了/ 单会话/ 安全/ 的/ 协议/ 在/ 多会/ 话/ 下/ 也/ 同样/ 安全/ [/ 24/ ]/ ./ 因此/ ,/ 只/ 需/ 在/ 被动/ 环境/ 下/ 分析/ 单会话/ BD/ 协议/ 的/ 安全性/ ,/ 即可/ 通过/ 顺序调用/ 上述/ 两个/ 编译器/ ,/ 构造/ 出/ 一个/ 在/ 内部/ 攻击/ 下多会/ 话/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ./ 本文/ 第/ 2/ 节/ 提出/ 模幂/ 运算/ 的/ 符号化/ 模型/ ;/ 第/ 3/ 节/ 定义/ 符号化/ 不可/ 区分/ 性/ 与/ 计算/ 不可/ 区分/ 性/ ,/ 并/ 证明/ 该/ 模型/ 的/ 计算/ 可靠性/ ;/ 第/ 4/ 节/ 证明/ 符号化/ 分析/ 的/ Page3/ 计算/ 可靠性/ ;/ 第/ 5/ 节/ 简化/ 符号化/ 分析/ BD/ 协议/ 时/ 所/ 需/ 的/ 参与者/ 数目/ ;/ 第/ 6/ 节/ 总结/ 全文/ ./ 2/ 模幂/ 运算/ 的/ 符号化/ 模型/ 本/ 节/ 设计/ 模幂/ 运算/ 的/ 符号化/ 模型/ ./ 具体/ 包括/ :/ 定义/ 模幂/ 运算/ 的/ 符号化/ 表达式/ 以及/ 根据/ 模幂/ 运算/ 满足/ 的/ 运算/ 定律/ 和/ 具有/ 的/ 属性/ ,/ 定义/ 表达式/ 间/ 的/ 等价关系/ 和/ 派生/ 规则/ ./ 定义/ 1/ ./ 模幂/ 运算/ 的/ 符号化/ 表达式/ ./ 设/ G/ / Zp/ 为/ 一个/ 循环群/ ,/ p/ 为/ 素数/ ,/ q/ 为阶/ ,/ 则/ 模幂/ 符号化/ 表达式/ 语法/ 递归/ 定义/ 如下/ :/ Y/ 表示/ 模幂/ 的/ 指数/ ./ 其中/ ,/ 0/ ,/ 1/ 分别/ 表示/ 二进制/ 的/ 0/ 与/ 1/ ,/ x/ 表示/ 由/ 若干/ 二进制/ 的/ 0/ 与/ 1/ 组成/ 且/ 模为/ q/ 的/ 二进制位/ 串/ ,/ Y/ -/ 1/ 表示/ Y/ 的/ 逆/ ,/ Y/ ·/ Y/ 表示/ 两个/ 指数/ 相乘/ ./ M/ 表示/ 模幂/ 运算/ 值/ ./ 其中/ ,/ g/ 表示/ 循环群/ 的/ 生成元/ ,/ MY/ 表示/ M/ 的/ Y/ 次/ 幂模/ p/ ,/ M/ -/ 1/ 表示/ M/ 的/ 逆/ ,/ M/ ·/ M/ 表示/ 两个/ 模幂/ 值/ 的/ 乘积/ 模/ p/ ./ N/ 表示/ 由/ 若干/ 模/ 幂指数/ 与/ 模幂/ 运算/ 值/ 组成/ 的/ 元组/ ./ 其中/ ,/ Y/ 表示/ 模幂/ 的/ 指数/ ,/ M/ 表示/ 模幂/ 运算/ 值/ ,/ N/ ,/ N/ 表示/ 由模/ 幂指数/ 或模/ 幂/ 运算/ 值/ 组成/ 的/ 一个二元/ 组/ ./ 中/ 的/ 语法/ ./ 例如/ ,/ N/ :/ x1/ ,/ x/ -/ 12/ ,/ gx3/ ,/ gx1/ ·/ x2/ ,/ gx2/ ·/ x/ -/ 1gx2/ ·/ x/ -/ 1x/ ,/ x/ -/ 12/ 属于/ 类型/ Y/ -/ 1/ ,/ gx3/ ,/ gx1/ ·/ x2/ ,/ gx2/ ·/ x/ -/ 1/ 型/ MY/ ,/ gx2/ ·/ x/ -/ 1/ 环/ 运算/ 问题/ ,/ 即模/ 幂/ 运算/ 值/ 不会/ 作为/ 指数/ 出现/ ./ 4/ ·/ gx3/ 是/ 一个/ 有效/ 的/ 表达式/ ,/ 因为/ x1/ 属于/ 类型/ 一个/ 有效/ 的/ 符号化/ 表达式/ 指该/ 表达式/ 符合/ 定义/ 1/ 另外/ ,/ 通过/ 该/ 语法/ ,/ 本文/ 限定/ 了/ 不/ 考虑/ 模幂/ 的/ 循/ 定义/ 如下/ :/ 定义/ 2/ ./ 等价关系/ ./ 针对/ 一个/ 有效/ 的/ 符号化/ 表达式/ N/ ,/ 等价关系/ 被/ 若/ N/ =/ Y1/ ·/ Y2/ ,/ 则/ N/ =/ Y2/ ·/ Y1/ ;/ 若/ N/ =/ (/ Y1/ ·/ Y2/ )/ ·/ Y3/ ,/ 则/ N/ =/ Y1/ ·/ (/ Y2/ ·/ Y3/ )/ ;/ 若/ N/ =/ (/ Y1/ ·/ Y2/ )/ -/ 1/ ,/ 则/ N/ =/ Y/ -/ 11/ ·/ Y/ -/ 12/ ;/ 若/ N/ =/ (/ Y/ -/ 1/ )/ -/ 1/ ,/ 则/ N/ =/ Y/ ;/ 若/ N/ =/ Y/ ·/ Y/ -/ 1/ ,/ 则/ N/ =/ 1/ ;/ 若/ N/ =/ 0/ ·/ Y/ ,/ 则/ N/ =/ 0/ ;/ 若/ N/ =/ 1/ ·/ Y/ ,/ 则/ N/ =/ Y/ ;/ 若/ N/ =/ (/ MY1/ )/ Y2/ ,/ 则/ N/ =/ MY1/ ·/ Y2/ ;/ 若/ N/ =/ M1/ ·/ M2/ ,/ 则/ N/ =/ M2/ ·/ M1/ ;/ 若/ N/ =/ (/ M1/ ·/ M2/ )/ ·/ M3/ ,/ 则/ N/ =/ M1/ ·/ (/ M2/ ·/ M3/ )/ ;/ 若/ N/ =/ (/ M1/ ·/ M2/ )/ -/ 1/ ,/ 则/ N/ =/ M/ -/ 11/ ·/ M/ -/ 12/ ;/ 若/ N/ =/ (/ M/ -/ 1/ )/ -/ 1/ ,/ 则/ N/ =/ M/ ;/ 若/ N/ =/ M/ ·/ M/ -/ 1/ ,/ 则/ N/ =/ 1/ ;/ 若/ N/ =/ 0/ ·/ M/ ,/ 则/ N/ =/ 0/ ;/ 若/ N/ =/ 1/ ·/ M/ ,/ 则/ N/ =/ M/ ./ 定义/ 3/ ./ 派生/ 规则/ ./ 针对/ 两个/ 有效/ 的/ 符号化/ 表达式/ M/ 与/ N/ ,/ 如果/ M/ 中/ 所有/ 的/ 子/ 表达式/ 均/ 可/ 由/ N/ 中/ 的/ 子/ 表达式/ 通过/ 等价关系/ 以及/ 如下/ 公式/ 递归计算/ 得到/ ,/ 则/ 称/ N/ 可派/ 生出/ M/ ./ 简记/ 为/ N/ / M/ ./ 具体/ 公式/ 如下/ :/ N/ / N/ ;/ N/ / 0/ ;/ N/ / 1/ ;/ 若/ N/ / y/ ,/ 则/ N/ / y/ -/ 1/ ;/ 若/ N/ / y1/ 且/ N/ / y2/ ,/ 则/ N/ / y1/ ·/ y2/ ;/ 若/ N/ / m/ 且/ N/ / y/ ,/ 则/ N/ / my/ ;/ 若/ N/ / m/ ,/ 则/ N/ / m/ -/ 1/ ;/ 若/ N/ / m1/ 且/ N/ / m2/ ,/ 则/ N/ / m1/ ·/ m2/ ;/ 若/ N/ / n1/ 且/ N/ / n2/ ,/ 则/ N/ / n1/ ,/ n2/ ;/ 若/ N/ / n1/ ,/ n2/ ,/ 则/ N/ / n1/ 且/ N/ / n2/ ,/ 其中/ ,/ y/ ,/ y1/ ,/ y2/ 的/ 类型/ 是/ Y/ ,/ m/ ,/ m1/ ,/ m2/ 的/ 类型/ 是/ M/ ,/ n1/ ,/ n2/ 的/ 类型/ 是/ N/ ./ 如果/ M/ 无法/ 通过/ 上述/ 规则/ 被/ 派/ 生出/ ,/ 那么/ 我们/ 称/ N/ / M/ ./ 例如/ ,/ N/ :/ x1/ ,/ gx2/ 可以/ 派/ 生出/ M1/ :/ gx1/ ·/ x2/ ,/ 但/ 无法/ 派/ 生出/ M2/ :/ gx1/ ·/ x3/ ./ 虽然/ 判断/ 两个/ 有效/ 的/ 模幂/ 符号化/ 表达式/ 是否/ 具有/ 派生/ 关系/ 本质/ 上/ 是/ 一个/ NP/ 问题/ ,/ 但/ 由于/ 本文/ 仅/ 需/ 符号化/ 分析/ 具有/ 3/ 个/ 参与者/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 所以/ 协议/ 运行/ 时/ 产生/ 的/ 表达式/ 数目/ 较/ 少/ ,/ 且/ 指数/ 组成/ 较/ 简单/ ,/ 因而/ 时间/ 复杂度/ 可/ 接受/ ./ 3/ 模幂/ 符号化/ 模型/ 的/ 计算/ 可靠性/ 本/ 节/ 通过/ 设计/ 一个/ Pattern/ 算法/ ,/ 定义/ 敌手/ 可以/ 派/ 生出/ 的/ 符号化/ 表达式/ ,/ 并/ 通过/ 设计/ 一个/ 映射/ 算法/ ,/ 定义/ 了/ 如何/ 将/ 派/ 生出/ 的/ 符号化/ 表达式/ 转换/ 为/ 二进制位/ 串/ (/ bit/ -/ strings/ )/ ./ 基于/ 上述/ 两个/ 算法/ ,/ 通过/ 定义/ 模幂/ 运算/ 的/ 符号化/ 不可/ 区分/ 性/ 和/ 计算/ 不可/ 区分/ 性/ ,/ 本/ 节/ 最后/ 证明/ 了/ 符号化/ 不可/ 区分/ 性/ 蕴含/ 计算/ 不可/ 区分/ 性/ ./ 表达式/ ./ 已知/ N/ 时/ ,/ Pattern/ (/ N/ )/ 算法/ 如下/ :/ 算法/ 1/ ./ 令/ N/ 与/ N/ 是/ 两个/ 有效/ 的/ 模幂/ 符号化/ 1/ ./ 遍历/ N/ ,/ 并/ 按照/ 如下/ 公式/ 递归/ 替换/ 其中/ 的/ 子/ 表达式/ :/ Page4Pattern/ (/ N/ )/ =/ 0/ ,/ 烄/ 1/ ,/ x/ ,/ (/ Pattern/ (/ y/ )/ )/ -/ 1/ ,/ 若/ N/ =/ y/ -/ 1Pattern/ (/ y1/ )/ ·/ Pattern/ (/ y2/ )/ ,/ 若/ N/ =/ y1/ ·/ y2g/ ,/ 烅/ (/ Pattern/ (/ m/ )/ )/ y/ ,/ □/ ,/ (/ Pattern/ (/ m/ )/ )/ -/ 1/ ,/ 若/ N/ =/ m/ -/ 1Pattern/ (/ m1/ )/ ·/ Pattern/ (/ m2/ )/ ,/ 若/ N/ =/ m1/ ·/ m2/ 烆/ Pattern/ (/ n1/ )/ ,/ Pattern/ (/ n2/ )/ ,/ 若/ N/ =/ n1/ ,/ n2/ ./ 遍历/ Pattern/ (/ N/ )/ ,/ 对于/ 每个/ 子/ 表达式/ ,/ 如果/ 存在/ 符号/ □/ ,/ 则/ 将/ 整个/ 子/ 表达式/ 替换/ 为/ □/ ./ 3/ ./ 返回/ Pattern/ (/ N/ )/ ./ 如果/ my/ 无法/ 从/ N/ 中/ 被/ 派生/ 出来/ ,/ 根据/ 离散/ 对数/ (/ DiscreteLogarithm/ ,/ DL/ )/ 问题/ 以及/ 确定性/ Diffie/ -/ Hellman/ (/ DecisionDiffie/ -/ Hellman/ ,/ DDH/ )/ 问题/ 可知/ ,/ 敌手/ 无法/ 获取/ y/ ./ 我们/ 用/ 符号/ □/ 表示/ 敌手/ 得到/ 的/ 表达式/ 与/ y/ 无关/ ./ 例如/ ,/ 给定/ 两个/ 有效/ 的/ 表达式/ N1/ ,/ N2/ :/ 已知/ N1/ ,/ 敌手/ 可以/ 从/ N2/ 获取/ 到/ 的/ 表达式/ 为此/ 算法/ 隐含/ 限定/ 了/ 模幂/ 运算/ 需要/ 满足/ 的/ 具体/ 安全/ 属性/ ,/ 即/ 根据/ 模幂/ 运算/ 的/ 结果/ ,/ 解决/ DL/ 问题/ 和/ DDH/ 问题/ 是/ 困难/ 的/ ./ 算法/ 2/ ./ 令/ τ/ 表示/ 将/ 符号化/ 表达式/ 映射/ 为/ 对应/ 的/ 二进制位/ 串/ ,/ η/ 是/ 安全/ 参数/ ,/ r/ 表示/ 由伪/ 随机/ 产生器/ G/ (/ η/ )/ 随机/ 生成/ 的/ 一个/ 伪/ 随机数/ ,/ 映射/ 算法/ 被/ 递归/ 定义/ 如下/ :/ Mapping/ (/ N/ )/ =/ 0/ ,/ 烄/ 1/ ,/ τ/ (/ x/ )/ ,/ (/ Mapping/ (/ y/ )/ )/ -/ 1/ ,/ Mapping/ (/ y1/ )/ ·/ Mapping/ (/ y2/ )/ ,/ 若/ N/ =/ y1/ ·/ y2/ τ/ (/ g/ )/ ,/ 烅/ (/ Mapping/ (/ m/ )/ )/ Mapping/ (/ y/ )/ ,/ 若/ N/ =/ my/ (/ Mapping/ (/ m/ )/ )/ -/ 1/ ,/ Mapping/ (/ m1/ )/ ·/ Mapping/ (/ m2/ )/ ,/ 若/ N/ =/ m1/ ·/ m2Mapping/ (/ n1/ )/ ,/ Mapping/ (/ n2/ )/ ,/ 若/ N/ =/ n1/ ,/ n2/ τ/ (/ g/ )/ τ/ (/ r/ )/ ,/ 烆/ 定义/ 4/ ./ 符号化/ 不可/ 区分/ 性/ ./ 令/ N/ ,/ N1/ 与/ N2/ 为/ 有效/ 的/ 符号化/ 表达式/ ./ 已知/ N/ ,/ 若/ Pattern/ (/ N1/ )/ =/ Pattern/ (/ N2/ )/ ,/ 则/ 称/ 已知/ N/ 时/ ,/ N1/ 与/ N2/ 符号化/ 不可/ 区分/ ./ 定义/ 5/ ./ 计算/ 不可/ 区分/ 性/ ./ 令/ B1/ ,/ B2/ 为/ 两个/ 二进制位/ 串/ ,/ 且/ 随机/ 选择/ 其中/ 一个/ 作为/ 敌手/ 的/ 输入/ 时/ ,/ 如果/ 敌手/ / 认为/ 输入/ 的/ 是/ B1/ ,/ 它/ 输出/ 0/ ./ 反之/ ,/ / 输出/ 1/ ./ 那么/ ,/ B1/ 与/ B2/ 计算/ 不可/ 区分/ (/ 简写/ 为/ B1/ / B2/ )/ ,/ 当且/ 仅/ 当/ 在/ 安全/ 参数/ η/ 的/ 多项式/ 时间/ 内/ ,/ 任意/ 敌手/ / 无法/ 区分/ 输入/ 的/ 是/ B1/ 还是/ B2/ ,/ 令/ negl/ (/ η/ )/ 表示/ 安全/ 参数/ η/ 的/ 可/ 忽略/ 函数/ [/ 12/ ]/ ,/ 我们/ 有/ |/ Pr/ [/ / (/ B1/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ B2/ )/ =/ 1/ ]/ |/ </ negl/ (/ η/ )/ ./ 基于/ 上述/ 算法/ 与/ 定义/ ,/ 下面/ 证明/ 符号化/ 不可/ 区分/ 性/ 蕴含/ 计算/ 不可/ 区分/ 性/ ./ 定理/ 1/ ./ 给定/ 一/ 有效/ 表达式/ N/ ,/ 若/ Pattern/ (/ N1/ )/ =/ Pattern/ (/ N2/ )/ ,/ 则/ Mapping/ (/ N1/ )/ / Mapping/ (/ N2/ )/ ./ 证明/ ./ 我们/ 利用/ 混合/ 模型/ 予以/ 证明/ ./ 构造/ 混合/ 模型/ 的/ 步骤/ 如下/ :/ (/ 1/ )/ 遍历/ N1/ ,/ 并/ 将/ 集合/ {/ y/ |/ y/ 的/ 类型/ 是/ x/ ,/ 作为/ 模幂/ 的/ 指数/ 在/ N1/ 中/ 出现/ ,/ N/ / y/ }/ 中/ 的/ 每个/ 元素/ 依次/ 加入/ N/ 中/ ./ 分别/ 计算/ 每次/ 加入/ 前后/ 表达式/ N1/ 的/ Pattern/ 值/ ,/ 并设/ 集合/ 中/ 所有/ 元素/ 都/ 加入/ 到/ N/ 后/ 形成/ 的/ 表达式/ 为/ N/ / 1/ ./ (/ 2/ )/ 遍历/ N2/ ,/ 并/ 将/ 集合/ {/ y/ |/ y/ 的/ 类型/ 是/ x/ ,/ 作为/ 模幂/ 的/ 指数/ 在/ N2/ 中/ 出现/ ,/ N/ / y/ }/ 中/ 的/ 每个/ 元素/ 依次/ 加入/ N/ 中/ ./ 分别/ 计算/ 每次/ 加入/ 前后/ 表达式/ N2/ 的/ Pattern/ 值/ ,/ 并设/ 集合/ 中/ 所有/ 元素/ 都/ 加入/ 到/ N/ 后/ 形成/ 的/ 表达式/ 为/ N/ / 2/ ./ 若/ 基于/ 算法/ 2/ 将/ 这/ 两步/ 产生/ 的/ Pattern/ 值/ 映射/ 为/ 二进制位/ 串/ ,/ 由于/ Pattern/ (/ N1/ )/ =/ Pattern/ (/ N2/ )/ ,/ 根据/ 算法/ 2/ 和/ 定义/ 5/ ,/ 我们/ 有/ Mapping/ (/ Pattern/ (/ N1/ )/ )/ 与/ Mapping/ (/ Pattern/ (/ N2/ )/ )/ 计算/ 不可/ 区分/ ./ 另外/ ,/ 根据/ 算法/ 2/ 和/ 定义/ 5/ 可知/ ,/ 每/ 相邻/ 两行/ 符号化/ 表达式/ 的/ Pattern/ 值/ 在/ 通过/ 算法/ 2/ 映射/ 为/ 二进制位/ 串后/ ,/ 也/ 是/ 计算/ 不可/ 区分/ 的/ ./ 例如/ ,/ 若/ 3/ 个/ 表达式/ 为/ N/ :/ x1/ ,/ x/ -/ 12/ ,/ gx/ -/ 1N1/ :/ gx3/ ,/ gx1x2/ ,/ gx2x/ -/ 1N2/ :/ gx3/ ,/ gx1x2/ ,/ gx/ -/ 1/ 则/ 有/ Pattern/ (/ N1/ )/ =/ Pattern/ (/ N2/ )/ =/ (/ □/ ,/ gx1x2/ ,/ □/ ,/ □/ ,/ □/ )/ ./ 我们/ 遍历/ N1/ ,/ N2/ 得到/ 集合/ {/ x/ |/ x3/ ,/ x4/ }/ ,/ 将/ 该/ 集合/ 中/ 的/ 元素/ 逐步/ 加入/ N/ 中/ ,/ 并/ 分别/ 计算/ 每次/ 加入/ 前/ Page5/ 后/ N1/ ,/ N2/ 的/ Pattern/ 值/ 如下/ :/ N/ / 1/ :/ gx3gx1x2gx2x/ -/ 11/ :/ gx3gx1x2gx2x/ -/ 1N11/ :/ □/ gx1x2/ □/ □/ □/ N02/ :/ □/ gx1x2/ □/ □/ □/ N02/ :/ gx3gx1x2/ □/ gx2x/ -/ 1N1N/ / 2/ :/ gx3gx1x2gx/ -/ 1/ 其中/ ,/ N0N11/ ,/ N12/ 表示/ 加入/ x3/ 时/ 的/ Pattern/ 值/ ,/ 且/ N/ / 1/ =/ N1/ ,/ N/ / 2/ =/ N2/ ./ 由于/ Pattern/ (/ N1/ )/ =/ Pattern/ (/ N2/ )/ ,/ 所以/ N02/ ./ 又/ 根据/ 算法/ 2/ 和/ 定义/ 5/ 知/ ,/ 由于/ □/ 被/ 替换/ 为/ N0/ τ/ (/ g/ )/ τ/ (/ r/ )/ ,/ 因而/ Mapping/ (/ N0/ 任意/ 相邻/ 两行/ 符号化/ 表达式/ 的/ 区别/ 只是/ 集合/ {/ y/ |/ y/ 的/ 类型/ 是/ x/ ,/ 作为/ 模幂/ 的/ 指数/ 在/ N1/ // N2/ 中/ 出现/ ,/ N/ / y/ }/ 中/ 的/ 一个/ 元素/ 被/ 加入/ 到/ N/ 中/ ./ 因此/ 根据/ 算法/ 2/ 和/ 定义/ 5/ 可知/ ,/ 每/ 两个/ 相邻/ 行/ 表达式/ 通过/ 映射/ 算法/ 得到/ 的/ 位串/ ,/ 在/ 不/ 知道/ 集合/ {/ x/ |/ x3/ ,/ x4/ }/ 时均/ 计算/ 不可/ 区分/ ./ 否则/ 将/ 与/ DL/ 问题/ 或/ DDH/ 问题/ 矛盾/ ./ 因此/ ,/ Mapping/ (/ N1/ )/ / Mapping/ (/ N2/ )/ ./ 4/ 符号化/ 分析/ 的/ 计算/ 可靠性/ 本/ 节/ 回顾/ 了/ BD/ 协议/ 的/ 执行/ 过程/ ,/ 并/ 通过/ 定义/ 具有/ n/ 个/ 参与者/ 的/ 群组/ 密钥/ 协商/ 符号化/ 安全/ 标准/ 以及/ 理想/ 函数/ ,/ 证明/ 了/ 符号化/ 分析/ 的/ 计算/ 可靠性/ ./ 定义/ 6/ ./ BD/ 协议/ [/ 18/ ]/ 执行/ 过程/ ./ 令/ 所有/ 参与者/ pi/ (/ i/ ∈/ Zn/ )/ 逻辑/ 上/ 排列成/ 一个/ 模/ n/ 的/ 环/ ,/ 并/ 在/ 循环群/ G/ / Zp/ 中/ 进行/ 运算/ ./ 其中/ ,/ p/ 为/ 素数/ ,/ 群/ 的/ 生成元/ 为/ g/ ∈/ Zp/ ,/ q/ 为阶/ ./ 设/ 每个/ 参与者/ 在/ 协议/ 执行/ 前/ 已经/ 知道/ 其他/ 所有/ 参与者/ 的/ ID/ ./ 协议/ 的/ 执行/ 过程/ 被/ 定义/ 为/ 如下/ 3/ 轮/ :/ 第/ 1/ 轮/ ./ 每个/ 参与者/ pi/ 产生/ 一个/ 随机数/ xi/ (/ xi/ ←/ / / RZq/ )/ ,/ 并/ 广播/ :/ gxi/ (/ modp/ )/ ;/ 第/ 2/ 轮/ ./ 每个/ 参与者/ pi/ 广播/ :/ 第/ 3/ 轮/ ./ 每个/ 参与者/ pi/ 计算/ :/ ski/ =/ (/ gxi/ -/ 1/ )/ nxi/ (/ Xi/ )/ n/ -/ 1/ (/ Xi/ +/ 1/ )/ n/ -/ 2/ …/ Xi/ +/ n/ -/ 2/ (/ modp/ )/ ./ 我们/ 将/ 在/ 被动/ 环境/ 下/ 具有/ n/ 个/ 参与者/ 的/ BD/ 协议/ 简写/ 为/ n/ -/ BD/ -/ Passive/ ./ 而且/ ,/ 令/ i/ ,/ j/ ∈/ Zn/ ,/ 每个/ 参与者/ pi/ 被/ 初始化/ 后/ 会/ 输出/ (/ Establish/ -/ Key/ ,/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ ,/ 在/ 产生/ 会话/ 密钥/ 后/ 会/ 输出/ (/ Key/ ,/ sid/ ,/ {/ pj/ }/ ,/ k/ )/ ./ 这里/ ,/ Establish/ -/ Key/ 与/ Key/ 分别/ 表示/ 协议/ 的/ 开始/ 与/ 成功/ 结束/ ,/ sid/ 表示/ 会话/ ID/ ,/ {/ pj/ }/ 表示/ 协议/ 所有/ 参与者/ ID/ 的/ 集合/ ,/ k/ 表示/ 产生/ 的/ 会/ 话/ 密钥/ ./ 定义/ 7/ ./ 符号化/ 安全/ 标准/ (/ SymbolicSecurityCriterion/ )/ ./ 令/ i/ ,/ j/ ∈/ Zn/ ,/ 具有/ n/ 个/ 参与者/ 的/ 群组/ 密钥/ 协商/ 协议/ 是/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 如果/ 满足/ (/ 1/ )/ 一致性/ :/ 每个/ 参与者/ 在/ 生成/ 会话/ 密钥/ 后/ ,/ 所/ (/ 2/ )/ 私密性/ :/ 若/ skprotocol/ 有/ 的/ 会/ 话/ 密钥/ 都/ 相同/ ;/ 密钥/ ,/ skprotocol/ 则/ 有/ 定义/ 8/ ./ 群组/ 密钥/ 协商/ 的/ 理想/ 函数/ (/ IdealFunctionalityofGroupKeyExchange/ )/ ./ 令/ i/ ,/ j/ ∈/ Zn/ ,/ 安全/ 参数/ 为/ k/ ,/ 理想/ 敌手/ 为/ S/ ,/ 群组/ 参与者/ 的/ 数目/ 为/ n/ ,/ 则/ 群组/ 密钥/ 协商/ 的/ 理想/ 函数/ / n/ -/ GKE/ 定义/ 如图/ 1/ 所示/ ./ 理想/ 函数/ / n/ -/ GKE1/ ./ 初始化/ 当/ 收到/ 参与者/ pi/ 的/ 消息/ (/ Establish/ -/ Key/ ,/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ 后/ ,/ / n/ -/ GKE/ 如果/ 之前/ 没有/ 记录/ 过/ 元组/ (/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ ,/ 记录/ (/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ ,/ 并/ 将/ 该/ 消息/ 发送给/ 理想/ 敌手/ / ./ 2/ ./ 密钥/ 传输/ 当/ 收到/ 理想/ 敌手/ / 的/ 消息/ (/ deliver/ ,/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ ,/ / n/ -/ GKE/ 检查/ 具有/ 相同/ sid/ 和/ {/ pj/ }/ 的/ 元组/ (/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ 个数/ 是否/ 达到/ n/ :/ 如果/ 达到/ ,/ 进一步/ 检查/ 是否/ 记录/ 过/ (/ Key/ ,/ sid/ ,/ {/ pj/ }/ ,/ k/ )/ :/ 如果/ 没有/ ,/ / n/ -/ GKE/ 选择/ r/ ←/ Zq/ ,/ 计算/ k/ =/ gr/ (/ modp/ )/ ,/ 记录/ [/ Key/ ,/ sid/ ,/ {/ pj/ }/ ,/ k/ ]/ ,/ 并/ 将/ 其/ 输出/ 给/ pi/ ./ 如果/ 存在/ ,/ 输出/ (/ Key/ ,/ sid/ ,/ {/ pj/ }/ ,/ k/ )/ 给/ pi/ ./ 定理/ 2/ ./ 如果/ n/ -/ BD/ -/ Passive/ 是/ 一个/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 那么/ 它/ 一定/ 安全/ 地/ 实现/ / n/ -/ GKE/ ./ 证明/ ./ 我们/ 通过/ 反证法/ 予以/ 证明/ ./ 即/ 如果/ 存在/ 一个/ 环境/ / ,/ 可以/ 区分/ 它/ 是/ 在/ 与/ n/ -/ BD/ -/ Passive/ 和/ 实际/ 敌手/ / 交互/ ,/ 还是/ 在/ 与/ 理想/ 函数/ / n/ -/ GKE/ 和/ 理想/ 敌手/ / 交互/ ,/ 那么/ n/ -/ BD/ -/ Passive/ 不是/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ./ 令/ i/ ,/ j/ ∈/ Zn/ ,/ 我们/ 首先/ 构造/ 一个/ 模拟器/ / 如下/ :/ (/ 1/ )/ / 模拟出/ n/ 个/ 未激活/ 的/ 参与者/ pi/ ./ (/ 2/ )/ 当/ / 从/ / n/ -/ GKE/ 处/ 收到/ 消息/ (/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ 时/ ,/ 说明/ 环境/ / 已/ 通过/ / n/ -/ GKE/ ,/ 激活/ 了/ 某个/ 虚拟/ (/ dummy/ )/ 参与者/ pi/ ,/ 因此/ / 激活/ 对应/ 的/ 模拟/ 参与者/ pi/ ./ (/ 3/ )/ 当/ / 收到/ 环境/ / 发送给/ pi/ 的/ 消息/ 时/ ,/ 将/ 它/ 传到/ 对应/ 的/ pi/ 的/ 接收/ 通信/ 带/ (/ incomingcommunica/ -/ tiontape/ )/ 上/ ./ Page6/ (/ 4/ )/ 当/ / 收到/ pi/ 发送给/ 环境/ / 的/ 消息/ 时/ ,/ 将/ 它/ 发送给/ / ./ (/ 5/ )/ 当/ pi/ 产生/ 一条/ 输出/ [/ Key/ ,/ sid/ ,/ {/ pj/ }/ ,/ k/ ]/ 时/ ,/ 发送/ (/ deliver/ ,/ pi/ ,/ {/ pj/ }/ )/ 给/ 理想/ 函数/ / n/ -/ GKE/ ./ 这里/ ,/ 我们/ 证明/ 所有/ 概率/ 多项式/ 时间/ 的/ 环境/ / 可以/ 区分/ 出是/ 在/ 与/ 上述/ 模拟/ 进行/ 交互/ 还是/ 在/ 进行/ 实际/ 交互/ 的/ 概率/ 可以/ 忽略不计/ ./ 由于/ 在/ 被动/ 环境/ 下/ ,/ 协议/ n/ -/ BD/ -/ Passive/ 执行/ 时/ 参与方/ 发出/ 的/ 每条/ 消息/ 均/ 是/ 模幂/ 运算/ 的/ 结果/ ./ 因此/ ,/ 若/ 环境/ 能以/ 不可/ 忽略/ 的/ 概率/ 区分/ 上述/ 模拟/ 与/ 实际/ 交互/ ,/ 则/ 在/ 进行/ 实际/ 交互/ 时/ :/ (/ a/ )/ 环境/ / 可以/ 使/ 至少/ 一个/ 参与者/ 不/ 被/ 初始化/ ./ 这/ 使得/ / 与/ 实际/ 交互/ 时/ 得到/ 的/ 消息/ (/ Establish/ -/ Key/ ,/ sid/ ,/ pi/ ,/ {/ pj/ }/ )/ 的/ 个数/ 少于/ 从/ 上述/ 模拟/ 中/ 得到/ 的/ ,/ 从而/ 根据上述/ 模拟/ 的/ 第/ (/ 2/ )/ 种/ 情况/ 进行/ 区分/ ./ (/ b/ )/ 环境/ / 可以/ 判定/ 会话/ 密钥/ 与/ 收到/ 的/ 消息/ 是否/ 具有/ 相关性/ ./ 由于/ / 在/ 与/ 上述/ 模拟/ 交互/ 时/ ,/ 会话/ 密钥/ 与/ 收到/ 的/ 消息/ 是/ 相互/ 独立/ 的/ ,/ 因此/ 可以/ 根据上述/ 模拟/ 的/ 第/ (/ 3/ )/ (/ 4/ )/ 种/ 情况/ 进行/ 区分/ ./ (/ c/ )/ 环境/ / 使得/ 至少/ 一个/ 参与者/ 协商/ 出/ 的/ 会/ 话/ 密钥/ 与/ 其他/ 参与者/ 的/ 不/ 一致/ ./ 这/ 使得/ / 在/ 进行/ 实际/ 交互/ 时/ 得到/ 的/ 会/ 话/ 密钥/ 不/ 完全相同/ ./ 从而/ 可以/ 根据上述/ 模拟/ 的/ 第/ (/ 5/ )/ 种/ 情况/ 进行/ 区分/ ./ (/ d/ )/ 敌手/ 猜/ 对/ 会/ 话/ 密钥/ 的/ 概率/ 不可/ 忽略/ ./ 由于/ 在/ 执行/ 上述/ 模拟/ 时/ 敌手/ 猜/ 对/ 会/ 话/ 密钥/ 的/ 概率/ 可以/ 忽略不计/ ,/ 从而/ 可以/ 根据上述/ 模拟/ 的/ 第/ (/ 5/ )/ 种/ 情况/ 进行/ 区分/ ./ 针对/ (/ a/ )/ ,/ 由于/ n/ -/ BD/ -/ Passive/ 协议/ 第/ 1/ 轮/ 用到/ 的/ xi/ 是从/ Zq/ 中/ 通过/ 随机/ 选择/ 得到/ 的/ ,/ 所以/ 敌手/ 直接/ 猜/ 对/ 它们/ 的/ 概率/ 可以/ 忽略不计/ ./ 这/ 使得/ 敌手/ 模拟/ 某个/ 参与者/ 的/ 概率/ 可/ 忽略不计/ ,/ 即/ 第/ 1/ 种/ 情况/ 发生/ 的/ 概率/ 可/ 忽略不计/ ./ 针对/ (/ b/ )/ ,/ 如果/ 敌手/ 可以/ 判断/ 收到/ 的/ 消息/ 与/ 最终/ 的/ 会/ 话/ 密钥/ 是否/ 相互/ 独立/ ,/ 那么/ 敌手/ 要么/ 可以/ 计算/ 出/ 第/ 1/ 轮中/ 某些/ 消息/ 的/ 指数/ ,/ 要么/ 可以/ 区分/ 出会话/ 密钥/ 与/ 群中/ 随机/ 产生/ 的/ 一个/ 元素/ ./ 因此/ ,/ 可/ 通过/ 该/ 敌手/ 解决/ DL/ 问题/ 或/ DDH/ 问题/ ./ 所以/ 第/ 2/ 种/ 情况/ 发生/ 的/ 概率/ 可以/ 忽略不计/ ./ 针对/ (/ c/ )/ 和/ (/ d/ )/ ,/ 根据/ 定义/ 1/ ,/ 我们/ 可以/ 为/ 环境/ / 得到/ 的/ 所有/ 消息/ (/ 简写/ 为/ mb/ )/ ,/ 建立/ 一个/ 对应/ 的/ 模幂/ 符号化/ 表达式/ (/ 简写/ 为/ ms/ )/ ./ 如果/ 环境/ / 根据/ mb/ ,/ 可以/ 使得/ 某个/ 参与者/ 协商/ 出/ 的/ 密钥/ 与/ 其他/ 参与者/ 的/ 不/ 一致/ ,/ 或者/ 猜/ 对/ 会/ 话/ 密钥/ 的/ 概率/ 不可/ 忽略/ ,/ 那么/ 根据/ ms/ ,/ 符号化/ 敌手/ 要么/ 找到/ 一个/ 有效/ 的/ 执行/ ,/ 使得/ 定义/ 7/ 不/ 被/ 满足/ ,/ 要么/ 计算/ 可/ 区分/ 不/ 蕴含/ 符号化/ 可/ 区分/ ./ 前者/ 说明/ n/ -/ BD/ -/ Passive/ 不是/ 一个/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 与/ 前提/ 矛盾/ ./ 后者/ 与/ 定理/ 1/ 的/ 逆否命题/ 矛盾/ ./ 5/ 符号化/ 分析/ 协议/ 的/ 安全性/ 本/ 节/ 符号化/ 分析/ n/ -/ BD/ -/ Passive/ 的/ 安全性/ ./ 定理/ 3/ ./ 若/ 3/ -/ BD/ -/ Passive/ 是/ 一个/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 则/ n/ -/ BD/ -/ Passive/ 是/ 一个/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ./ 说/ ,/ 我们/ 需要/ 证明/ 如下/ 两点/ :/ 证明/ ./ 我们/ 通过/ 数学/ 归纳法/ 进行/ 证明/ ./ 具体/ 地/ (/ 1/ )/ 3/ -/ BD/ -/ Passive/ 协议/ 是/ 一个/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ./ (/ 2/ )/ 若/ k/ -/ BD/ -/ Passive/ 协议/ 是/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ,/ 那么/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 协议/ 也/ 是/ 符号化/ 安全/ 的/ 群组/ 密钥/ 协商/ 协议/ ./ 由于/ (/ 1/ )/ 是/ 前提/ ,/ 所以/ 本文/ 只/ 需/ 证明/ (/ 2/ )/ ./ 又/ 因为/ 协议/ 是/ 在/ 被动/ 环境/ 下/ 执行/ 的/ ,/ 所以/ 定义/ 7/ 中/ 的/ 一致性/ 可以/ 根据/ 数论/ 知识/ 得到/ 保证/ ./ 下面/ 证明/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 协议/ 满足/ 定义/ 7/ 中/ 的/ 私密性/ ./ 即/ 证明/ 若/ 符号化/ 敌手/ / ,/ 根据/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 协议/ 的/ 执行/ 可以/ 区分/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 一个/ 符号化/ 敌手/ / 根据/ k/ -/ BD/ -/ Passive/ 协议/ 的/ 执行/ ,/ 可以/ 区分/ skk/ -/ BD/ -/ Passive/ 我们/ 令/ / 调用/ / ./ 由于/ 敌手/ / 可以/ 获取/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 协议/ 执行/ 时/ 所有/ 参与者/ 发出/ 的/ 消息/ ,/ 所以/ / 需要/ 模拟/ 这些/ 消息/ 给/ / ./ 具体/ 的/ 模拟/ 过程/ 如下/ :/ (/ 1/ )/ / 令/ k/ 个/ 参与者/ {/ pi/ |/ i/ ∈/ Zk/ }/ 一起/ 执行/ k/ -/ (/ a/ )/ 第/ 1/ 轮/ 的/ 消息/ :/ {/ gxi/ |/ i/ ∈/ Zk/ }/ ;/ (/ b/ )/ 第/ 2/ 轮/ 的/ 消息/ :/ BD/ -/ Passive/ 协议/ ,/ 并/ 获取/ :/ (/ c/ )/ 一个/ 符号化/ 输入/ skk/ ,/ 该/ 输入/ 可能/ 是/ skk/ -/ BD/ -/ Passiverandom/ 也/ 可能/ 是/ skk/ -/ BD/ -/ Passive/ (/ 2/ )/ / 选择/ 一个/ 随机数/ xk/ (/ xk/ ∈/ Zq/ )/ ,/ 并/ 计算/ gkxk/ ,/ 用以/ 模拟/ 第/ k/ +/ 1/ 个/ 参与者/ pk/ ./ 如下/ :/ (/ 3/ )/ / 调用/ / ,/ 并/ 模拟/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 执行/ (/ a/ )/ 在/ 第/ 1/ 轮/ ,/ 当/ / 激活/ pi/ (/ i/ ∈/ Zk/ +/ 1/ )/ 时/ ,/ / 计算/ 并/ 返回/ gkxi/ (/ i/ ∈/ Zk/ +/ 1/ )/ ;/ (/ b/ )/ 在/ 第/ 2/ 轮/ ,/ 当/ / 激活/ p0/ 时/ ,/ / 计算/ 并/ 返回/ X0/ :/ Page7t/ =/ ∑/ k/ -/ 1X0/ =/ (/ skk/ ·/ gt/ )/ k/ ·/ (/ gkx0/ )/ -/ kxk/ ;/ i/ =/ 1/ (/ c/ )/ 在/ 第/ 2/ 轮/ ,/ 当/ / 激活/ pi/ (/ i/ ∈/ [/ 1/ ,/ k/ -/ 2/ ]/ )/ 时/ ,/ / 计算/ 并/ 返回/ Xi/ =/ (/ gxixi/ +/ 1/ -/ xixi/ -/ 1/ )/ k2/ ;/ Xk/ -/ 1/ :/ (/ d/ )/ 在/ 第/ 2/ 轮/ ,/ 当/ / 激活/ pk/ -/ 1/ 时/ ,/ / 计算/ 并/ 返回/ t/ =/ ∑/ 2/ (/ k/ -/ 1/ )/ -/ 1Xk/ -/ 1/ =/ (/ gkxk/ -/ 1/ )/ kxk/ ·/ (/ skk/ ·/ gt/ )/ -/ k/ ;/ (/ e/ )/ 在/ 第/ 2/ 轮/ ,/ 当/ / 激活/ pk/ 时/ ,/ / 计算/ 并/ 返回/ Xk/ :/ (/ 4/ )/ 当/ / 请求/ skk/ +/ 1/ 时/ ,/ / 计算/ skk/ +/ 1/ :/ i/ =/ 1s/ =/ ximodkxi/ +/ 1/ (/ modk/ )/ -/ ximodkxi/ -/ 1/ (/ modk/ )/ ,/ t/ =/ ∑/ k/ -/ 1skk/ +/ 1/ =/ (/ skk/ )/ k2/ ·/ ∏/ k/ -/ 1/ (/ 5/ )/ / 返回/ / 的/ 输出/ 值/ ./ 从/ / 的/ 角度看/ ,/ 每/ 一个/ xi/ (/ i/ ∈/ Zk/ +/ 1/ )/ 都/ 是/ 随机数/ ./ 并且/ 如果/ skk/ 是/ skk/ -/ BD/ -/ Passive/ 反之/ ,/ 如果/ skk/ 是/ 独立/ 于/ 实际/ 会话/ 密钥/ 的/ skk/ -/ BD/ -/ Passive/ / 的/ 模拟/ 除了/ 消息/ X0/ ,/ Xk/ -/ 1/ 以及/ skk/ +/ 1/ 外/ ,/ 其它/ 与/ 执行/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 协议/ 得到/ 的/ 消息/ 都/ 相同/ ./ 这/ 是因为/ gkxi/ (/ i/ ∈/ Zk/ +/ 1/ )/ 可以/ 由/ gxi/ (/ i/ ∈/ Zk/ )/ 与/ xk/ 计算/ 出/ ,/ Xi/ (/ i/ ∈/ [/ 1/ ,/ n/ -/ 2/ ]/ )/ 可以/ 由/ gxixi/ +/ 1/ -/ xixi/ -/ 1/ 计算/ 得到/ ,/ 而/ Xk/ =/ (/ gxkx0/ -/ xkxk/ -/ 1/ )/ k2/ 可以/ 由/ gx0/ ,/ gxk/ ,/ xk/ 计算/ 得到/ ./ 此时/ 虽然/ X0/ 和/ Xk/ -/ 1/ 与/ 实际/ 值/ 是/ 相互/ 独立/ 的/ ,/ 但/ 可以/ 看到/ ,/ skk/ +/ 1/ 仍然/ 是/ 独立/ 于/ 实际/ 会话/ 密钥/ 的/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passiverandom/ ./ 反之/ ,/ / 输出/ 1/ ./ / 成功/ 的/ 概率/ / (/ k/ )/ 为令/ 敌手/ / 认为/ skk/ +/ 1/ 是/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ / (/ k/ )/ =/ Pr/ [/ / (/ skk/ +/ 1/ =/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ 设/ α/ 为/ / 可以/ 区分/ 出/ X0/ 与/ Xk/ -/ 1/ 是/ 真实/ 值/ 还是/ 随机/ 值/ 的/ 概率/ ./ 则/ / 成功/ 的/ 概率/ / (/ k/ )/ 为/ / (/ k/ )/ =/ Pr/ [/ / (/ skk/ =/ skk/ -/ BD/ -/ Passive/ =/ Pr/ [/ skk/ +/ 1/ =/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ PassivePr/ [/ skk/ +/ 1/ =/ sk/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ (/ Pr/ [/ / outputs1/ ]/ / (/ 1/ -/ α/ )/ +/ 1/ / α/ )/ =/ / (/ k/ )/ +/ α/ (/ 1/ -/ Pr/ [/ / outputs1/ ]/ )/ // 2/ / / (/ k/ )/ ./ 因此/ ,/ 若/ / 成功/ 攻陷/ (/ k/ +/ 1/ )/ -/ BD/ -/ Passive/ ,/ 则/ / 也/ 可以/ 成功/ 攻陷/ k/ -/ BD/ -/ Passive/ ./ 6/ 结束语/ 本文/ 通过/ 设计/ 一个/ Pattern/ 算法/ ,/ 定义/ 了/ 模幂/ 运算/ 需要/ 满足/ 的/ 具体/ 安全/ 属性/ ./ 进而/ 证明/ 了/ 满足/ 上述/ 安全/ 属性/ 的/ 模幂/ 运算/ 符号化/ 模型/ 满足/ 符号化/ 不可/ 区分/ 性/ 蕴含/ 计算/ 不可/ 区分/ 性/ ./ 基于/ 该/ 性质/ ,/ 证明/ 了/ BD/ 协议/ 的/ 符号化/ 分析/ 具有/ 计算/ 可靠性/ ./ 最后/ 通过/ 数学/ 归纳法/ ,/ 将/ 符号化/ 分析/ 参与者/ 数目/ 较/ 多/ 的/ BD/ 协议/ 简化/ 为/ 分析/ 具有/ 3/ 个/ 参与者/ 的/ BD/ 协议/ ,/ 提高/ 了/ 符号化/ 分析/ 的/ 效率/ ./ 本文/ 提出/ 的/ 方法/ 具有/ 一定/ 的/ 通用性/ ./ 即/ 针对/ 其他/ 密码/ 原语/ ,/ 根据/ 其/ 计算/ 可靠/ 的/ 符号化/ 模型/ ,/ 通过/ 简化/ 协议/ 参与者/ 的/ 数目/ ,/ 该/ 方法/ 亦可/ 被/ 用于/ 分析/ 其他/ 群组/ 密钥/ 协商/ 协议/ ,/ 如/ GDH/ 协议/ 等/ ./ 

