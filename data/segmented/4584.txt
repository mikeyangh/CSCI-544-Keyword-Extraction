Page1/ 绿色/ 数据中心/ 不/ 完备/ 能耗/ 大/ 数据/ 填补/ 及/ 分类/ 算法/ 研究/ 1/ )/ (/ 武汉理工大学/ 计算机科学/ 与/ 技术/ 学院/ 武汉/ 430070/ )/ 2/ )/ (/ 佛罗里达/ 大学/ 电气/ 与/ 计算机/ 工程系/ 佛罗里达州/ 美国/ 32611/ )/ 摘要/ 随着/ 云/ 计算/ 和/ 大/ 数据/ 时代/ 的/ 到来/ ,/ 大规模/ 数据中心/ 在/ 全球/ 范围/ 内/ 得到/ 了/ 广泛/ 的/ 部署/ ./ 但/ 大规模/ 数据中心/ 的/ 高能耗/ 仍然/ 是/ 当今/ 亟待解决/ 的/ 问题/ ./ 为/ 解决/ 这一/ 问题/ ,/ 通常/ 采用/ 太阳能/ 等/ 可再生/ 绿色/ 新能源/ 为/ 数据中心/ 供电/ ./ 绿色/ 数据中心/ 能够/ 根据/ 新能源/ 的/ 变化/ 配合/ 市电为/ 数据中心/ 提供/ 高效/ 、/ 低能耗/ 且/ 稳定/ 的/ 电能/ 供给/ ,/ 这是/ 数据中心/ 发展/ 的/ 趋势/ ./ 文中/ 针对/ 数据/ 收集/ 不/ 完善/ 和/ 断电/ 等/ 因素/ 会/ 造成/ 一定/ 程度/ 的/ 数据/ 缺失/ 情况/ ,/ 提出/ 了/ 一种/ 基于/ 完备/ 相容/ 类/ 的/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ ,/ 来/ 填补/ 数据中心/ 的/ 缺失/ 数据/ ;/ 针对/ 绿色/ 数据中心/ 能耗/ 大/ 数据/ 的/ 不/ 稳定/ 、/ 间歇性/ 和/ 随时/ 变化/ 等/ 特点/ ,/ 提出/ 了/ 一种/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 并行/ 分类/ 算法/ ,/ 通过/ 对/ 数据中心/ 能耗/ 大/ 数据/ 并行/ 分类/ ,/ 来/ 指导/ 供电/ 方式/ ,/ 以利于/ 高效/ 节能/ 和/ 延长/ 电池/ 寿命/ ;/ 此外/ 进一步/ 提出/ 了/ 一种/ 增量/ 更新/ 决策/ 森林/ 的/ 算法/ ,/ 来/ 增量/ 更新/ 分类/ 模型/ ,/ 该/ 算法/ 能够/ 保障/ 分类/ 模型/ 不断/ 适应/ 数据/ 变化/ ,/ 防止/ 分类/ 准确率/ 随/ 时间/ 而/ 下降/ ,/ 从而/ 避免/ 电池/ 频繁/ 充放电/ ,/ 以/ 保证/ 稳定/ 供电/ ./ 整体/ 来说/ ,/ 文中/ 提出/ 了/ 一种/ 数据中心/ 能耗/ 大/ 数据管理/ 模型/ ,/ 该/ 模型/ 针对/ 大规模/ 绿色/ 数据中心/ 的/ 能源/ 供给/ 相关/ 问题/ ,/ 运用/ 不/ 完备/ 能耗/ 大/ 数据/ 的/ 填补/ 、/ 能耗/ 大/ 数据/ 的/ 并行/ 分类/ 、/ 分类/ 模型/ 更新/ 这三/ 方面/ 的/ 技术/ 方法/ ,/ 动态/ 调控/ 太阳能/ 和/ 市电/ 供电/ 端口/ ,/ 为/ 数据中心/ 提供/ 高效/ 、/ 低能耗/ 且/ 稳定/ 的/ 电能/ 供给/ ./ 最后/ ,/ 采用/ 绿色/ 数据中心/ 真实/ 的/ 能耗/ 相关/ 大/ 数据/ 集/ 进行/ 实验/ ,/ 实验/ 结果/ 说明文/ 中/ 提出/ 的/ 能耗/ 大/ 数据管理/ 模型/ ,/ 能够/ 帮助/ 绿色/ 数据中心/ 有效/ 管理/ 太阳能/ 和/ 其他/ 资源/ 来/ 配合/ 市/ 电/ 提供/ 稳定/ 且/ 充足/ 的/ 电能/ 供应/ ,/ 从而/ 为/ 整个/ 数据中心/ 服务体系/ 提供/ 高效/ 的/ 能源/ 服务/ ./ 关键词/ 绿色/ 数据中心/ ;/ 能耗/ 大/ 数据/ ;/ 不/ 完备/ 大/ 数据/ 填补/ ;/ 并行/ 分类/ ;/ 增量/ 更新/ ;/ 大/ 数据/ 1/ 引言/ 随着/ 云/ 计算/ 和/ 大/ 数据/ 时代/ 的/ 到来/ ,/ 大规模/ 数据中心/ 在/ 全球/ 范围/ 内/ 得到/ 了/ 广泛/ 的/ 部署/ ./ 但/ 其/ 高能耗/ 问题/ 却/ 越来越/ 突出/ ./ 据/ 不/ 完全/ 统计/ ,/ 2013/ 年/ 各类/ 数据中心/ 电能/ 消耗量/ 占/ 全球/ 年均/ 总/ 电能/ 消耗量/ 的/ 0.5/ %/ ./ 按/ 当前/ 的/ 发展趋势/ ,/ 预计/ 到/ 2020/ 年/ ,/ 数据中心/ 年均/ 电能/ 消耗量/ 将/ 占/ 全球/ 年均/ 总/ 电能/ 消耗量/ 的/ 1/ %/ [/ 1/ ]/ ./ 数据中心/ 的/ 高能耗/ 造成/ 了/ 电能/ 的/ 浪费/ 和/ 系统/ 的/ 不/ 稳定/ ,/ 同时/ 也/ 给/ 环境/ 带来/ 了/ 不利/ 影响/ ./ 降低/ 数据中心/ 耗电量/ 最/ 直接/ 的/ 方法/ 是/ 提高/ 数据中心/ 效率/ ,/ 而/ 合理/ 使用/ 新能源/ 是/ 数据中心/ 提高效率/ 、/ 降低/ 运维/ 成本/ 的/ 主要/ 途径/ ./ IBM/ 曾/ 提出/ “/ 绿色/ 数据中心/ 的/ 含义/ 是/ 提高/ 数据中心/ 的/ 能源/ 效率/ ”/ ./ 因此/ ,/ 建立/ 绿色/ 数据中心/ 是/ 数据中心/ 发展/ 的/ 趋势/ ./ 绿色/ 数据中心/ 通常/ 采用/ 太阳能/ 等/ 绿色/ 新能源/ 为/ 绿色/ 数据中心/ 供电/ ./ 虽然/ 利用/ 新能源/ 能/ 缓解/ 数据中心/ 对/ 资源/ 环境/ 的/ 压力/ ,/ 但/ 目前/ 数据中心/ 依然/ 不/ 适合/ 完全/ 脱离/ 传统/ 电网/ ./ 如何/ 协同/ 配合/ 传统/ 电网/ 和/ 新能源/ 的/ 各自/ 特点/ ,/ 并/ 根据/ 新能源/ 的/ 实时/ 变化/ ,/ 控制/ 市电供/ 能/ 端口/ 和/ 新能源/ 供能/ 端口/ 以/ 提供/ 高效/ 、/ 低能耗/ 的/ 电能/ 供给/ 是/ 如今/ 所/ 要/ 面对/ 的/ 一个/ 重要/ 问题/ [/ 2/ ]/ ./ 针对/ 这个/ 问题/ ,/ 我们/ 需要/ 高效/ 处理/ 绿色/ 数据中心/ 产生/ 的/ 能耗/ 相关/ 大/ 数据/ (/ 文中/ 简称/ 能耗/ 大/ 数据/ )/ ./ 能耗/ 大/ 数据/ 规模/ 庞大/ (/ Volume/ )/ ,/ 且/ 由于/ 新能源/ 不/ 稳定/ ,/ 能耗/ 大/ 数据/ 会/ 随时/ 变化/ (/ Velocity/ )/ ./ 尽管/ 能耗/ 大/ 数据/ 很少/ 涉及/ 非/ 结构化/ 数据/ ,/ 但/ 其/ 需要/ 考虑/ 电流/ 电压/ 等/ 信号/ 、/ 系统日志/ 和/ 新能源/ 监控/ 数据/ 等/ 诸/ 多半/ 结构化/ 数据/ ,/ 以及/ 断电/ 等/ 因素/ 造成/ 的/ 数据/ 不/ 完备/ ,/ 使得/ 数据/ 形式/ 更为/ 复杂/ (/ Variety/ )/ ./ 有效/ 分析/ 和/ 处理/ 能耗/ 大/ 数据/ 可/ 减少/ 电能/ 消耗/ ,/ 这/ 在/ 当今/ 计算/ 规模/ 庞大/ 的/ 云/ 计算/ 时代/ ,/ 具有/ 极大/ 的/ 数据/ 价值/ (/ Value/ )/ ./ 处理/ 能耗/ 大/ 数据/ 和/ 控制/ 数据中心/ 电能/ 供/ 需要/ 消耗/ 电能/ 并/ 带来/ 很/ 高/ 的/ 操作/ 开销/ ,/ 而且/ 其/ 伴随/ 的/ 电池/ 的/ 频繁/ 充放电/ 会/ 给/ 基础设施/ 和/ 环境/ 造成/ 负面影响/ ./ 如何/ 运用/ 数据挖掘/ 相关/ 算法/ ,/ 对/ 数据中心/ 的/ 能耗/ 大/ 数据/ 用途/ 进行/ 分类/ ,/ 从而/ 指导/ 供电/ 方式/ 是/ 绿色/ 数据中心/ 需要/ 重点/ 考虑/ 的/ 问题/ ./ 然而/ ,/ 绿色/ 数据中心/ 因/ 断电/ 、/ 设备/ 故障/ 、/ 信息/ 采集/ 等/ 因素/ 造成/ 的/ 数据/ 不/ 完备/ 问题/ ,/ 会/ 严重/ 降低/ 分类/ 效果/ ,/ 在/ 数据/ 属性/ 密度/ 低/ 的/ 情况/ 下/ 甚至/ 影响/ 分类/ 模型/ 的/ 训练/ ./ 此外/ ,/ 随着/ 数据中心/ 中/ 数据/ 不断/ 变化/ ,/ 根据/ 历史数据/ 建立/ 的/ 数据模型/ 的/ 适应性/ 会/ 不断/ 下降/ ./ 因此/ ,/ 对/ 不/ 完备/ 能耗/ 大/ 数据/ 的/ 处理/ 以及/ 建立/ 更/ 合理/ 的/ 能耗/ 管理/ 模型/ ,/ 逐渐/ 成为/ 绿色/ 数据中心/ 所/ 面临/ 的/ 新/ 的/ 挑战/ ./ 本文/ 主要/ 工作/ 如下/ :/ (/ 1/ )/ 针对/ 太阳能/ 等/ 新能源/ 供电/ 不/ 稳定/ 、/ 间歇性/ 、/ 设备/ 故障/ 、/ 信息/ 采集/ 等/ 因素/ 造成/ 的/ 能耗/ 数据/ 缺失/ 问题/ ,/ 提出/ 了/ 一种/ 基于/ 完备/ 相容/ 类/ 的/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ ./ 该/ 算法/ 扩展/ 了/ 粗糙/ 集中/ 的/ 相容/ 关系/ ,/ 保证数据/ 的/ 完备/ 性/ ,/ 从而/ 提高/ 了/ 分类/ 的/ 精度/ ,/ 并且/ 并行/ 实现/ 了/ 该/ 算法/ 以便/ 高效/ 处理/ 大/ 数据/ ./ (/ 2/ )/ 设计/ 绿色/ 数据中心/ 的/ 能耗/ 管理/ 架构/ ,/ 提出/ 了/ 一种/ 适用/ 能耗/ 大/ 数据/ 的/ 并行/ 分类/ 方法/ ./ 本文/ 改进/ 了/ 传统/ 的/ 随机/ 森林/ 算法/ ,/ 提出/ 一种/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 分类/ 算法/ 对/ 能耗/ 大/ 数据/ 并行/ 分类/ ;/ 并且/ 进一步/ 提出/ 增量/ 更新/ 分类/ 模型/ 的/ 算法/ ,/ 使得/ 分类/ 模/ Page3/ 型/ 能够/ 适应/ 系统/ 新/ 产生/ 的/ 数据/ ,/ 防止/ 分类/ 准确率/ 随/ 时间推移/ 而/ 下降/ ./ 2/ 相关/ 工作/ 2.1/ 数据中心/ 能耗/ 模型/ 为了/ 分析/ 和/ 处理/ 数据中心/ 的/ 能耗/ 大/ 数据/ ,/ 首先/ 需要/ 构建/ 能耗/ 模型/ ./ 目前/ ,/ 关于/ 数据中心/ 能耗/ 模型/ 的/ 构建/ ,/ 已有/ 广泛/ 的/ 研究/ ./ 林闯/ 等/ 人/ [/ 3/ ]/ 将/ 能量/ 看作/ 一种/ 系统资源/ ,/ 从/ 资源分配/ 与/ 任务/ 管理/ 角度/ 分析/ 了/ 绿色/ 网络/ 的/ 机制/ 与/ 策略/ ,/ 提出/ 了/ 基于/ 随机/ 模型/ 的/ 绿色/ 评价/ 框架/ ,/ 并/ 对/ 数据中心/ 的/ 能耗/ 管理/ 进行/ 了/ 理论/ 建模/ 和/ 分析/ ,/ 提出/ 了/ 开销/ 感知/ 的/ 作业/ 调度/ 算法/ [/ 4/ ]/ ./ Fan/ 等/ 人/ [/ 5/ ]/ 改进/ 了/ 一元/ 回归/ 能耗/ 模型/ ,/ 提出/ 了/ 不同/ 的/ 能耗/ 管理/ 框架/ ./ Lee/ 等/ 人/ [/ 6/ ]/ 则/ 利用/ 服务器/ 的/ 最小/ 功率/ 、/ 最大/ 功率/ 及/ CPU/ 的/ 当前/ 使用率/ 来/ 建立/ 能耗/ 模型/ ./ Bohra/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 新/ 的/ 能耗/ 分析/ 工具/ Vmeter/ ,/ 对/ CPU/ 、/ catche/ 、/ 内存/ 与/ 磁盘/ 等/ 系统/ 组件/ 分别/ 进行/ 监控/ ,/ 建立/ 分解/ 的/ 四元/ 线性/ 模型/ ./ Dhiman/ 等/ 人/ [/ 8/ ]/ 根据/ CPU/ 利用率/ 、/ IPC/ 、/ MPC/ 建立/ 高斯/ 混合/ 模型/ ,/ 并/ 采用/ 概率/ 建立/ 了/ 能耗/ 与/ 性能指标/ 的/ 关系/ ./ Choi/ 等/ 人/ [/ 9/ ]/ 通过/ 分析/ 服务器/ 整合/ 、/ 虚拟机/ 迁移/ 场景/ 下/ 的/ 能源消耗/ ,/ 提出/ 了/ 一种/ 动态/ 环境/ 下/ 的/ 能耗/ 预测/ 模型/ ./ 罗亮/ 等/ 人/ [/ 10/ ]/ 结合/ 多元/ 线性/ 回归/ 和/ 非线性/ 回归/ 的/ 数学方法/ ,/ 提出/ 了/ 一种/ 适合/ 云/ 计算/ 数据中心/ 基础架构/ 的/ 服务器/ 能耗/ 模型/ ./ 王巍/ 等/ 人/ [/ 11/ ]/ 采用/ 基于/ 重载/ 近似/ 的/ 大规模/ 排队/ 系统/ 来/ 对/ 数据中心/ 建模/ ,/ 设计/ 了/ 多/ 数据中心/ 间/ 的/ 负载/ 路由/ 机制/ ,/ 从而/ 使/ 数据中心/ 能耗/ 成本/ 得到/ 进一步/ 优化/ ./ 孙/ 大为/ 等/ 人/ [/ 1/ ]/ 系统地/ 分析/ 了/ 实现/ 绿色/ 服务/ 级/ 目标/ 的/ 原理/ ,/ 提出/ 了/ 一种/ 多维/ 能耗/ 模型/ M2EC/ ,/ 实现/ 了/ 云/ 计算环境/ 中/ 能耗/ 与/ 服务/ 级/ 目标/ 之间/ 的/ 均衡/ ./ 叶可江/ 等/ 人/ [/ 12/ ]/ 提出/ 了/ 一种/ 针对/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 建模/ 方法/ ./ 李翔/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 面向/ 多/ 节点/ 的/ 热量/ 管理机制/ 的/ 理论/ 框架/ ./ 此外/ ,/ 由于/ 数据中心/ 的/ 运营/ 离不开/ 与/ 电网/ 之间/ 的/ 交互/ ,/ 具有/ 新能源/ 发电站/ 的/ 数据中心/ 通常/ 与/ 智能/ 电网/ 合作/ ,/ 利用/ 需求/ 响应/ 机制/ 保障/ 智能/ 电网/ 的/ 稳定性/ [/ 14/ ]/ ./ 我们/ 合作/ 的/ 佛罗里达/ 大学/ IDEAL/ 实验室/ 设计/ 了/ 一种/ 太阳能/ 驱动/ 的/ 多/ 核/ 体系/ 架构/ 下/ 的/ 能耗/ 管理/ 方案/ SolarCore/ ,/ 该/ 方案/ 能/ 凭据/ 吞吐/ 率/ 和/ 能耗/ 的/ 比值/ ,/ 利用/ DVFS/ 技术/ 动态/ 调节/ 每个/ 核/ 的/ 负载/ ,/ 从而/ 充分利用/ 太阳能/ 实现/ 最优性/ 能/ [/ 15/ ]/ ./ IDEAL/ 实验室/ 的/ 另/ 一个/ 研究成果/ iSwitch/ 能/ 在/ 两组/ 服务器之间/ 动态/ 调节/ 负载/ ,/ 使/ 其/ 能够/ 最大化/ 利用/ 间歇/ 、/ 不/ 稳定/ 的/ 新能源/ ,/ 并/ 根据/ 能源/ 波动/ 合理/ 的/ 迁移/ 虚拟机/ [/ 16/ ]/ ./ 在/ 此基础/ 上/ ,/ Li/ 等/ 人/ 提出/ 了/ InSURE/ [/ 17/ ]/ 、/ PDS/ [/ 18/ ]/ 、/ Oasis/ [/ 19/ ]/ 等/ 多个/ 能耗/ 管理/ 模型/ ,/ 为/ 绿色/ 数据中心/ 运用/ 能耗/ 大/ 数据/ 提供/ 高效/ 稳定/ 的/ 能源供应/ 服务/ 提供/ 了/ 全新/ 的/ 思路/ ./ 2.2/ 不/ 完备/ 数据/ 填补/ 受/ 新能源/ 不/ 稳定/ 、/ 间歇性/ 、/ 设备/ 故障/ 、/ 信息/ 采集/ 误差/ 等/ 因素/ 的/ 影响/ ,/ 数据中心/ 的/ 能耗/ 数据/ 常常/ 会/ 出现/ 不/ 精确/ 、/ 不/ 一致/ 、/ 不/ 完整/ 等/ 问题/ ./ 对于/ 上述/ 问题/ ,/ 不/ 完备/ 数据/ 的/ 处理/ 方法/ 显得/ 尤为重要/ ,/ 其/ 一般/ 分为/ 直接/ 处理/ 方法/ 和/ 间接/ 处理/ 方法/ ./ 直接/ 处理/ 方法/ 既/ 不/ 删除/ 含有/ 缺失/ 数据/ 的/ 记录/ ,/ 也/ 不/ 填补/ 缺失/ 数据/ ,/ 一般/ 通过/ 直接/ 扩充/ 粗糙集/ 模型/ 进行/ 处理/ ./ 钱进/ 和/ 苗夺谦/ 等/ 人/ [/ 20/ ]/ 为/ 适应/ 不断扩大/ 的/ 数据/ 规模/ ,/ 提出/ 了/ 基于/ 粗糙集/ 理论/ 的/ 面向/ 大规模/ 数据/ 的/ 并行/ 知识/ 约简/ 算法/ ,/ 并/ 通过/ 实验/ 证明/ 其/ 具有/ 良好/ 的/ 可行性/ 和/ 较/ 好/ 的/ 扩展性/ ./ Yang/ 等/ 人/ [/ 21/ ]/ 在/ 基于/ 优势/ 关系/ 的/ 粗糙集/ 模型/ 的/ 基础/ 上/ ,/ 提出/ 了/ 基于/ 相似/ 优势/ 关系/ 的/ 粗糙集/ 决策/ 方法/ ,/ 并/ 将/ 其/ 应用/ 于/ 处理/ 不/ 完备/ 信息系统/ ./ Yang/ 等/ 人/ [/ 22/ ]/ 实现/ 了/ 粗糙集/ 理论/ 基于/ MapReduce/ 的/ 并行/ 化/ ./ Zhang/ 等/ 人/ [/ 23/ -/ 24/ ]/ 比较/ 了/ 在/ 处理/ 大/ 数据/ 的/ 不同/ 系统/ 中/ ,/ 使用/ MapReduce/ 实现/ 的/ 多种/ 基于/ 粗糙集/ 的/ 处理/ 方法/ 的/ 优劣/ ./ 间接/ 处理/ 方法/ 一般/ 指/ 数据/ 填补/ ,/ 其/ 特点/ 是/ 采用/ 某种/ 方法/ (/ 如/ 基于/ 概率/ 统计/ )/ 将/ 不/ 完备/ 信息系统/ 转化成/ 完备/ 信息系统/ ./ 武森/ [/ 25/ ]/ 通过/ 分析/ 不/ 完备/ 约束/ 容差/ 集合/ ,/ 提出/ 了/ 一种/ 基于/ 不/ 完备/ 数据/ 聚类/ 的/ 缺失/ 数据/ 填补/ 方法/ ./ Gebregziabher/ 等/ 人/ [/ 26/ ]/ 提出/ 了/ 一种/ 用/ 一系列/ 可能/ 值来/ 填补/ 缺失/ 值/ ,/ 并/ 进行/ 综合/ 分析/ 得到/ 总体/ 参数/ 的/ 估计值/ 的/ 多重/ 填补/ 方法/ ./ Daniel/ 等/ 人/ [/ 27/ ]/ 提出/ 了/ 一种/ 通过/ 估计值/ ,/ 结合/ 不同/ 的/ 噪声/ ,/ 形成/ 多组/ 可选/ 插/ 补值/ 的/ 多重/ 填补/ 方法/ ./ Hong/ 等/ 人/ [/ 28/ ]/ 利用/ 上下/ 近似/ 提出/ 了/ 一种/ 填补/ 缺失/ 值/ 并/ 同时/ 提取/ 规则/ 的/ 方法/ ./ ZhangkNN/ 缺失/ 数据/ 填补/ 算法/ ./ 我们/ 也/ 曾/ 提出/ 了/ 一种/ 针对/ 不/ 完备/ 数据/ 的/ 自动/ 阈值/ 调节/ 的/ 动态/ 量化/ 非对称/ 相似/ 关系/ 模型/ [/ 30/ ]/ ./ 2.3/ 大/ 数据/ 分类/ 对/ 能耗/ 大/ 数据/ 进行/ 分类/ 和/ 分析/ ,/ 能够/ 指导/ 数据中心/ 的/ 供电/ 方式/ ,/ 提高/ 能源/ 利用效率/ ./ 决策树/ 是/ 分类/ 应用/ 中/ 采用/ 最为/ 广泛/ 的/ 模型/ 之一/ ./ 相比/ 神经网络/ 及/ 贝叶斯/ 方法/ ,/ 决策树/ 避免/ 了/ 消耗/ 大量/ 的/ 时间/ 和/ 上/ 千次/ Page4/ 的/ 迭代/ 来/ 训练/ 模型/ ,/ 且/ 表现/ 出/ 了/ 良好/ 的/ 分类/ 效果/ ,/ 适用/ 于/ 不/ 完备/ 大/ 数据/ 集/ ./ 因此/ ,/ 众多/ 学者/ 将/ 决策树/ 改进/ ,/ 应用/ 于/ 不/ 完备/ 大/ 数据/ 的/ 分类/ 问题/ ./ Franco/ -/ Arcega/ 等/ 人/ [/ 31/ ]/ 提出/ 了/ 一种/ 能够/ 有效/ 解决/ 内存/ 限制/ 问题/ 的/ 决策树/ 构建/ 方法/ ,/ 提高/ 了/ 决策树/ 构建/ 算法/ 的/ 计算速度/ ./ 王涛/ 等/ 人/ [/ 32/ ]/ 设计/ 并/ 实现/ 了/ 一种/ 基于/ 线索/ 化/ 排序/ 二叉树/ 的/ 增量/ 模糊/ 决策树/ 分类/ 算法/ fVFDT/ ,/ 该/ 算法/ 有效/ 地/ 降低/ 了/ 新/ 样本/ 插入/ 及/ 最佳/ 划分/ 节点/ 选取/ 的/ 时间/ 复杂度/ ./ Yang/ 等/ 人/ [/ 33/ ]/ 提出/ 了/ 一种/ 用于/ 处理/ 带有/ 噪音/ 的/ 大/ 数据/ 的/ 增量/ 优化/ 的/ 快速/ 决策树/ 算法/ iOVFDT/ ,/ 很/ 好/ 地/ 处理/ 了/ 不/ 完备/ 大/ 数据/ 分类/ 的/ 问题/ ./ 而/ 由/ 多棵/ 决策树/ 组成/ 的/ 随机/ 森林/ 模型/ 有着/ 更为/ 广泛/ 的/ 应用/ ./ 王爱/ 平等/ 人/ [/ 34/ ]/ 提出/ 了/ 一种/ 增量/ 式/ 极端/ 随机/ 森林/ 分类器/ ,/ 并/ 将/ 其/ 应用/ 于/ 解决/ 视频/ 在线/ 跟踪/ 问题/ ./ Han/ 等/ 人/ [/ 35/ ]/ 实现/ 了/ 基于/ MapReduce/ 模型/ 的/ 可/ 扩展/ 随机/ 森林/ 算法/ SMRF/ ,/ 该/ 算法/ 更/ 适用/ 于/ 大规模/ 数据/ 集在/ 云/ 计算/ 平台/ 上/ 的/ 分类/ ./ Wang/ 等/ 人/ [/ 36/ ]/ 将/ 基于/ Hadoop/ 的/ 随机/ 森林/ 分类/ 算法/ 应用/ 于/ 多元/ 神经/ 影像/ 表型/ 的/ 全/ 基因组/ 关联/ 分析/ ./ 国内外/ 研究/ 机构/ 已经/ 对/ 绿色/ 数据中心/ 的/ 能耗/ 模型/ 进行/ 了/ 广泛/ 的/ 研究/ ,/ 也/ 有/ 较为/ 成熟/ 的/ 数据处理/ 方法/ ./ 但/ 针对/ 具体/ 绿色/ 数据中心/ 的/ 实际/ 能耗/ 大/ 数据处理/ 所/ 面临/ 的/ 数据/ 缺失/ 和/ 模型/ 更新/ 等/ 问题/ 还有/ 待/ 进一步/ 研究/ ./ 因此/ ,/ 本文/ 从/ 数据中心/ 能耗/ 不/ 完备/ 大/ 数据/ 的/ 填补/ 、/ 能耗/ 大/ 数据/ 分类/ 、/ 分类/ 模型/ 增量/ 更新/ 3/ 个/ 方面/ 分析/ 和/ 处理/ 能耗/ 大/ 数据/ ,/ 构建/ 更/ 适合/ 数据中心/ 的/ 能耗/ 大/ 数据管理/ 模型/ ./ 3/ 能耗/ 大/ 数据管理/ 模型/ 3.1/ 能耗/ 大/ 数据/ 的/ 定义/ 能耗/ 大/ 数据/ 主要/ 由/ 两个/ 方面/ 组成/ ,/ 首先/ 是/ 环境/ 监控/ 数据/ ,/ 即/ 监控/ 数据中心/ 的/ 内部/ 环境/ 与/ 辅助/ 设备/ 所得/ ,/ 包括/ 对/ 内部/ 气流/ 的/ 温度/ 、/ 湿度/ 等/ 数据/ 的/ 测量/ 和/ 收集/ ;/ 其次/ 是/ 资源/ 监控/ 数据/ ,/ 即/ 监控/ 服务器/ 集群/ 、/ 网络设施/ 等/ 云/ 计算资源/ 的/ 物理/ 参数/ 与/ 运行状况/ 所得/ [/ 13/ ]/ ./ 我们/ 根据/ 其/ 获取/ 方法/ 将/ 资源/ 监控/ 数据/ 分成/ 3/ 种/ 不同/ 的/ 类型/ ./ 第/ 1/ 种/ 类型/ :/ 直接/ 从/ 计算机/ 或/ 操作系统/ 的/ 接口/ 获取/ ,/ 例如/ CPU/ 使用率/ 、/ 内存/ 或/ 网络带宽/ 的/ 使用/ 状况/ 等/ ;/ 第/ 2/ 种/ 类型/ :/ 对于/ 部分/ 数据/ ,/ 计算机/ 与/ 操作系统/ 均/ 未/ 提供/ 相应/ 的/ 接口/ 进行/ 测量/ ,/ 则/ 需/ 利用/ 软硬件/ 结合/ 的/ 方式/ 或/ 间接/ 计算/ 获得/ [/ 37/ ]/ ;/ 第/ 3/ 种/ 类型/ :/ 通过/ 集成/ 在/ 计算机/ 主板/ 、/ 芯片/ 上/ 的/ 传感器/ 监控/ 所得/ ./ 为了/ 准确/ 地/ 获取数据/ 中心/ 的/ 运行状况/ ,/ 采集/ 点/ 越来越/ 多/ ,/ 采样/ 频率/ 越来越/ 高/ ,/ 普通/ 的/ 数据中心/ 就/ 达到/ 百万/ 甚至/ 千万级/ ./ 且/ 数据中心/ 广域/ 分布/ 、/ 数据类型/ 繁多/ ,/ 包括/ 实时/ 数据/ 、/ 历史数据/ 、/ 文本/ 数据/ 、/ 时间/ 序列/ 数据/ 等/ 各类/ 结构化/ 、/ 半/ 结构化/ 数据/ ./ 海量/ 的/ 过程/ 数据/ 被/ 保存/ 下来/ ,/ 形成/ 能耗/ 大/ 数据/ ./ 这些/ 数据/ 中/ 蕴藏/ 着/ 丰富/ 的/ 信息/ ,/ 对/ 绿色/ 数据中心/ 分析/ 运行/ 状态/ 、/ 提供/ 控制/ 和/ 优化/ 策略/ 、/ 故障诊断/ 以及/ 知识/ 发现/ 和/ 数据挖掘/ 具有/ 重要/ 意义/ ./ 3.2/ 能耗/ 大/ 数据/ 的/ 特点/ 能耗/ 大/ 数据/ 不仅/ 具备/ “/ 4V/ ”/ 特征/ ,/ 即/ 规模/ 大/ (/ volume/ )/ 、/ 类型/ 多/ (/ variety/ )/ 、/ 价值/ 密度/ 低/ (/ value/ )/ 和/ 变化/ 快/ (/ velocity/ )/ ,/ 而且/ 这些/ 特征/ 又/ 和/ 其他/ 大/ 数据/ 有所区别/ ./ 能耗/ 大/ 数据/ 规模/ 大且/ 阶段性/ 变化/ :/ 这些/ 数据/ 是/ 由/ 不同/ 检测点/ 按/ 一定/ 间隔/ 阶段性/ 收集/ 的/ ,/ 常规/ SCADA/ 系统/ 包含/ 上万个/ 检测点/ ,/ 按/ 采样/ 间隔/ 3s/ 到/ 4s/ 计算/ ,/ 每年/ 约/ 产生/ 1TB/ 数据/ ./ 能耗/ 大/ 数据/ 范畴/ 大且/ 类型/ 繁多/ :/ 数据中心/ 中/ 与/ 能源/ 有关/ 的/ 数据/ 都/ 属于/ 能耗/ 大/ 数据/ ,/ 它/ 的/ 数据/ 种类/ 众多/ ,/ 各类/ 数据/ 的/ 处理/ 频度/ 及/ 性能/ 要求/ 也/ 不尽相同/ ./ 能耗/ 大/ 数据/ 价值/ 密度/ 低且/ 变化/ 快/ :/ 在/ 几十/ 毫秒/ 内会/ 更新/ 大量/ 数据/ ,/ 历史数据/ 会/ 不断/ 积累/ ,/ 单一/ 数据中心/ 的/ 某一时间/ 点/ 的/ 数据/ 对于/ 数据分析/ 没有/ 任何/ 意义/ ,/ 数据/ 价值/ 密度/ 低/ ,/ 因此/ ,/ 需要/ 同时/ 综合/ 考虑/ 历史数据/ 以及/ 更新/ 数据/ ./ 另外/ ,/ 软硬件/ 、/ 断电/ 和/ 能源/ 不/ 稳定/ 等/ 因素/ 可能/ 引起/ 服务器/ 、/ 交换机/ 、/ 机架/ 等/ 故障/ ,/ 从而/ 会/ 导致/ 能耗/ 大/ 数据/ 出现/ 一定/ 程度/ 的/ 不/ 完备/ [/ 38/ ]/ ./ 同时/ ,/ RTU/ 采集/ 、/ 电能表/ 采集/ 、/ 通道/ 状况/ 、/ 参数设置/ 等/ 多种/ 因素/ 也/ 会/ 影响/ 数据中心/ 能耗/ 大/ 数据/ 的/ 质量/ ./ 这些/ 缺失/ 数据/ 不仅/ 会/ 对/ 数据中心/ 的/ 能耗/ 有/ 影响/ ,/ 还/ 可能/ 危及/ 到/ 整个/ 数据中心/ 的/ 正常/ 运转/ ./ 所以/ ,/ 及时/ 地/ 处理/ 能耗/ 大/ 数据/ ,/ 对/ 数据中心/ 的/ 安全/ 问题/ 和/ 数据中心/ 减少/ 能耗/ 均/ 有/ 很大/ 的/ 益处/ [/ 39/ ]/ ./ 3.3/ 能耗/ 大/ 数据管理/ 模型/ 针对/ 绿色/ 数据中心/ 规模/ 大/ 、/ 数据处理/ 时效性/ 强/ 、/ 数据/ 监控/ 来自/ 多个/ 不同/ 渠道/ 等/ 特征/ ,/ 本文/ 抽象/ 出/ 了/ 如图/ 1/ 所示/ 的/ 绿色/ 数据中心/ 的/ 能耗/ 大/ 数据管理/ 架构/ ,/ 一般/ 通过/ 特定/ 的/ 监控/ 设备/ 完成/ 对/ 环境/ 的/ 监控/ ,/ 并/ 在/ 每个/ 服务器/ 上/ 运行/ 监控/ 程序/ (/ 例如/ 可以/ 是/ 一个/ 守护/ 进程/ )/ 进行/ 资源/ 监控/ ./ 这些/ 设备/ 和/ 进程/ 通过/ 一定/ 的/ Page5/ 标准规范/ 与/ 主/ 节点/ 进行/ 通信/ ,/ 传输/ 收集/ 的/ 数据/ ./ 整个/ 能耗/ 大/ 数据管理/ 模型/ 首先/ 由主/ 节点/ 对/ 原始数据/ 加上/ 时间/ 戳/ ,/ 并/ 对/ 其/ 进行/ 预处理/ ,/ 然后/ 对/ 能耗/ 不/ 完备/ 大/ 数据/ 进行/ 填补/ 处理/ ,/ 随后/ 根据/ 处理/ 后/ 的/ 数据/ 建立/ 决策/ 森林/ ,/ 并/ 按/ 时间/ 戳/ 不断/ 使用/ 新增/ 数据/ 集/ 增量/ 更新/ 之图/ 1/ 绿色/ 数据中心/ 的/ 能耗/ 大/ 数据管理/ 架构/ 4/ 不/ 完备/ 大/ 数据/ 填补/ 方法/ 数据中心/ 的/ 能耗/ 大/ 数据/ 不仅/ 规模/ 大/ ,/ 而且/ 往往/ 要/ 面临/ 数据/ 采集/ 不/ 完善/ 、/ 断电/ 、/ 故障/ 等/ 因素/ 造成/ 信息/ 大量/ 缺失/ 的/ 难题/ ./ 传统/ 粗糙集/ 理论/ 一般/ 只能/ 处理/ 完备/ 的/ 信息系统/ ,/ 为了/ 使/ 粗糙集/ 理论/ 能/ 适应/ 于/ 能耗/ 大/ 数据/ 的/ 处理/ ,/ 通常/ 采用/ 模型/ 扩充/ 或/ 数据/ 填补/ 方法/ ./ 但/ 模型/ 扩展/ 方法/ 不能/ 在/ 保持数据/ 标签/ 唯一/ 的/ 情形/ 下/ 处理/ 不/ 完备/ 数据/ ,/ 且/ 空值/ 过多/ 时会/ 失效/ ./ 基于/ 粗糙集/ 的/ 填补/ 方法/ 可以/ 处理/ 数据/ 属性/ 缺失/ 量/ 大/ 的/ 情况/ ,/ 但是/ 该/ 方法/ 中/ 求解/ 相容/ 关系/ 以及/ 相容/ 类/ 十分复杂/ ,/ 不/ 适合/ 数据/ 规模/ 大且/ 阶段性/ 变化/ 的/ 能耗/ 大/ 数据/ ./ 因此/ ,/ 本文/ 将/ 相容/ 关系/ 扩展/ 为/ 完备/ 相容/ 关系/ ,/ 用于/ 划分/ 完备/ 相容/ 类/ ,/ 并/ 在/ 此基础/ 上/ 提出/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ 来/ 填补/ 数据中心/ 能耗/ 大/ 数据/ 中/ 的/ 缺失/ 属性/ 值/ ./ 4.1/ 不/ 完备/ 信息系统/ 相关/ 概念/ (/ 1/ )/ 限制/ 相容/ 关系/ 及其/ 划分/ 在/ 不/ 完备/ 信息系统/ I/ =/ (/ U/ ,/ A/ ,/ V/ ,/ f/ )/ [/ 40/ ]/ 中/ ,/ 属性/ 集合/ R/ / A/ ,/ 在/ U/ 上/ 定义/ 一个/ 限制/ 相容/ 关系/ LCS/ (/ R/ )/ =/ {/ (/ x/ ,/ y/ )/ ∈/ U/ ×/ U/ |/ / a/ ∈/ R/ ,/ (/ fR/ (/ x/ )/ =/ fR/ (/ y/ )/ =/ / )/ ∨/ (/ (/ QR/ (/ x/ )/ ∩/ QR/ (/ y/ )/ ≠/ / )/ ∧/ (/ fR/ (/ x/ )/ ≠/ / ∧/ fR/ (/ y/ )/ ≠/ / →/ fa/ (/ x/ )/ =/ fa/ (/ y/ )/ )/ )/ }/ ./ 其中/ QR/ (/ x/ )/ =/ {/ a/ ∈/ 前/ 的/ 决策/ 森林/ 模型/ ,/ 最后/ 根据/ 决策/ 森林/ 分类/ 的/ 结果/ (/ 太阳能/ 和/ 市电/ 端口/ 开关/ 数/ )/ 制定/ 电能/ 供应/ 策略/ ,/ 有效/ 管理/ 太阳能/ 和/ 其他/ 资源/ 配合/ 市/ 电/ 提供/ 电能/ 供应/ ,/ 从而/ 为/ 整个/ 数据中心/ 服务体系/ 提供/ 高效/ 的/ 能源/ 服务/ ./ R/ |/ fa/ (/ x/ )/ ≠/ / }/ ,/ 显然/ ,/ 限制/ 相容/ 关系/ 是/ 自反/ 和/ 对称/ 的/ ,/ 但/ 不/ 一定/ 是/ 传递/ 的/ ,/ 属于/ 广义/ 的/ 不可/ 区分/ 关系/ ./ 限制/ 相容/ 关系/ 克服/ 了/ 容差/ 关系/ 会/ 误判/ 相同/ 己知/ 属性/ 值/ 对象/ 的/ 缺陷/ ,/ 也/ 克服/ 了/ 非对称/ 相似/ 关系/ 无法/ 划分/ 一些/ 具有/ 大量/ 相同/ 己知/ 属性/ 值且/ 直观/ 上/ 就/ 可以/ 判定/ 为/ 相似/ 的/ 对象/ 的/ 缺陷/ [/ 40/ ]/ ./ (/ 2/ )/ 完备/ 相容/ 关系/ 及其/ 划分/ 在/ 一个/ 不/ 完备/ 信息系统/ 中/ ,/ 定义/ 对象/ 集/ X/ 为/ 不/ 完备/ 对象/ 集/ ,/ 即/ / x/ ∈/ X/ ,/ / a/ ∈/ A/ ,/ fa/ (/ x/ )/ =/ / ;/ 对象/ 集/ Y/ 为/ 完备/ 对象/ 集/ ,/ 即/ / y/ ∈/ Y/ ,/ / a/ ∈/ A/ ,/ fa/ (/ y/ )/ =/ / ,/ 则/ U/ =/ X/ ∪/ Y/ ./ 定义/ 属性/ 集/ C/ 为/ 条件/ 属性/ 集/ ,/ D/ 为/ 决策/ 属性/ 集/ ./ 对/ 任一/ 属性/ 集合/ R/ / C/ ,/ 在/ U/ 上/ 定义/ COM/ (/ R/ )/ =/ {/ (/ x/ ,/ y/ )/ ∈/ X/ ×/ Y/ |/ / a/ ∈/ R/ ,/ fa/ (/ x/ )/ =/ fa/ (/ y/ )/ }/ 的/ 一个/ 完备/ 相容/ 关系/ ./ 用/ 对象/ 集/ CA/ (/ x/ )/ 表示/ x/ 的/ 完备/ 相容/ 集合/ ,/ 其/ 定义/ 为/ CA/ (/ x/ )/ =/ {/ y/ ∈/ Y/ |/ (/ x/ ,/ y/ )/ ∈/ COM/ (/ A/ )/ }/ ./ U/ // COM/ (/ A/ )/ 中/ 的/ 任意/ 元素/ CA/ (/ x/ )/ 为/ 一个/ 完备/ 相容/ 类/ ,/ 其/ 定义/ 为/ U/ // COM/ (/ A/ )/ =/ {/ (/ IA/ (/ x/ )/ ,/ CA/ (/ x/ )/ )/ |/ x/ ∈/ X/ }/ ./ 其中/ IA/ (/ x/ )/ 叫做/ 完备/ 相容/ 类/ 的/ 不/ 完备/ 部分/ ,/ CA/ (/ x/ )/ 叫做/ 完备/ 相容/ 类/ 的/ 完备/ 部分/ ./ 由于/ 具有/ 完备/ 相容/ 关系/ 的/ 两/ 对象/ 来自/ 不同/ 数据/ 集/ ,/ 可见/ 完备/ 相容/ 关系/ 是/ 非对称/ 的/ ./ 满足/ 完备/ 相容/ 关/ Page6/ 系/ 的/ 对象/ 必/ 满足/ 限制/ 相容/ 关系/ ,/ 以/ 克服/ 容差/ 关系/ 条件/ 宽松/ 的/ 缺陷/ ,/ 从而/ 避免/ 完备/ 相容/ 集合/ 的/ 多次/ 求解/ ./ 4.2/ 不/ 完备/ 能耗/ 大/ 数据/ 填补/ 算法/ 本文/ 提出/ 基于/ 完备/ 相容/ 类/ 的/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ (/ CompletingIncompleteBigData/ ,/ 简称/ CIBD/ 算法/ )/ 来/ 填补/ 数据中心/ 的/ 缺失/ 数据/ ./ (/ 1/ )/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ 流程/ 首先/ ,/ 需要/ 将/ 数据/ 集中/ 的/ 连续/ 属性/ 离散/ 化/ ./ 然后/ ,/ 将/ 属性/ 值/ 缺失/ 的/ 不/ 完备/ 数据/ 与/ 完备/ 数据/ 区分/ 开来/ (/ 为/ 保证/ 分类/ 准确性/ ,/ 去除/ 决策/ 属性/ 缺失/ 的/ 记录/ )/ ,/ 并/ 分别/ 生成/ 属性/ 值/ 序列/ 和/ 倒排/ 索引/ ./ 接着/ ,/ 检测/ 不/ 完备/ 数据/ 是否/ 存在/ 完备/ 相容/ 类/ ./ 若有/ 完备/ 相容/ 类/ ,/ 根据/ 最小/ 描述/ 长度/ 原则/ (/ MDL/ )/ ,/ 选择/ 条件/ 属性/ 对/ 决策/ 属性/ 预测/ 的/ 不确定性/ 最小/ 的/ 属性/ 值来/ 填补/ 缺失/ 属性/ 值/ ./ 反之/ ,/ 选择/ 缺失/ 属性/ 中/ 频率/ 最大/ 的/ 属性/ 值来/ 填补/ 该/ 缺失/ 属性/ 值/ ./ 不/ 完备/ 大/ 数据/ 填补/ 算法/ 流程/ 如图/ 2/ 所示/ ./ (/ 2/ )/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ 描述/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ 主要/ 由/ 提取/ 不/ 完备/ 数据/ 和/ 填补/ 缺失/ 属性/ 两个/ 步骤/ 组成/ ./ 提取/ 不/ 完备/ 数据/ 算法/ 描述/ 如/ 算法/ 1/ ./ 算法/ 1/ ./ 提取/ 不/ 完备/ 数据/ ./ 输入/ :/ 原始数据/ 集/ DS/ ,/ 连续/ 属性/ 区间/ 数/ t/ 输出/ :/ 不/ 完备/ 数据/ 集/ IDS/ ,/ 部分/ 完备/ 数据/ 集/ CDS/ ,/ 属性/ DS/ ←/ Dispersion/ (/ DS/ ,/ t/ )/ ;/ FOREACHdatarecorddINDSDOattr/ _/ flag/ =/ TRUE/ ;/ IFattr/ _/ flag/ =/ TRUETHENENDRETURNIDS/ ,/ CDS/ ,/ List/ ,/ Index/ ;/ 首先/ ,/ 该/ 算法/ 通过/ Dispersion/ (/ DS/ ,/ t/ )/ 离散/ 化/ DS/ 中/ 的/ 连续/ 属性/ 为/ t/ 个/ 区间/ ./ 然后/ ,/ creat/ _/ List/ (/ d/ )/ 负责/ 将/ 数据/ 记录/ d/ 划分/ 到/ 完备/ 数据/ 集/ ,/ 并/ 生成/ 相应/ 的/ 属性/ 值/ 序列/ ./ delete/ (/ DS/ ,/ d/ )/ 负责/ 从/ 数据/ 集/ DS/ 中/ 删除/ 决策/ 属性/ 缺失/ 的/ 数据/ 记录/ ./ 而/ inverted/ (/ d/ )/ 负责/ 将/ 条件/ 属性/ 缺失/ 的/ 数据/ 记录/ d/ 划分/ 到/ 不/ 完备/ 数据/ 集/ IDS/ ,/ 并/ 为/ 它/ 建立/ 倒排/ 索引/ ,/ 索引/ 的/ key/ 为/ 缺失/ 属性/ 及/ 记录/ id/ 组成/ 的/ 元组/ ./ 该/ 算法/ 对/ 每个/ 记录/ 的/ 全部/ 属性/ 进行/ 缺失/ 检测/ ,/ 并/ 建立/ 倒排/ 索引/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ h/ ×/ n/ )/ ,/ 其中/ h/ 为/ 记录/ 的/ 属性/ 个数/ (/ 维度/ )/ ,/ n/ 为/ 读取/ 的/ 记录/ 数/ ./ 算法/ 1/ 作为/ 不/ 完备/ 数据/ 填补/ 的/ 预处理/ 过程/ ,/ 能够/ 有效/ 的/ 进行/ 数据/ 清洗/ ,/ 有助于/ 针对性/ 分析/ 条件/ 属性/ 缺失/ 的/ 填补/ 方法/ ./ 该/ 算法/ 生成/ 的/ 倒排/ 索引/ 结构/ ,/ 可以/ 用于/ 记录/ 缺失/ 值/ 所在/ 属性/ 列/ ,/ 以便/ 并行/ 填补/ ,/ 并且/ 利于/ 发现/ 相容/ 关系/ 和/ 完备/ 相容/ 关系/ ./ 填补/ 缺失/ 属性/ 值/ 算法/ 描述/ 如/ 算法/ 2/ ./ 算法/ 2/ ./ 填补/ 缺失/ 属性/ 值/ ./ 输入/ :/ 不/ 完备/ 数据/ 集/ IDS/ ,/ 部分/ 完备/ 数据/ 集/ CDS/ ,/ 属性/ 输出/ :/ 完备/ 数据/ 集/ CDSFOREACHdatarecorddINCDSDOcount/ _/ file/ ←/ count/ (/ d/ ,/ List/ )/ ;/ ENDFOREACHdatarecordxINIDSDOIA/ (/ x/ )/ ←/ getInd/ (/ x/ ,/ IDS/ ,/ index/ )/ ;/ IDS/ // IND/ (/ A/ )/ ←/ divide/ (/ IDS/ ,/ IA/ (/ x/ )/ )/ ;/ Page7ENDFOREACHdatasetsXINIDS/ // IND/ (/ A/ )/ DOx/ ←/ getData/ (/ X/ )/ ;/ FOREACHdatarecorddINCDSDOIF/ (/ x/ ,/ d/ )/ ∈/ Com/ (/ A/ )/ THENENDIFCA/ (/ X/ )/ =/ / THENELSEENDENDCDS/ ←/ DS/ ;/ RETURNCDS/ ;/ 首先/ ,/ 该/ 算法/ 通过/ count/ (/ d/ ,/ List/ )/ 统计/ 各/ 属性/ 值/ 出现/ 的/ 频数/ ,/ 然后/ ,/ getInd/ (/ x/ ,/ IDS/ ,/ index/ )/ 负责/ 找到/ 数据/ 记录/ x/ 的/ 等价/ 数据/ 集/ IA/ (/ x/ )/ ./ divide/ (/ IDS/ ,/ IA/ (/ x/ )/ )/ 负责/ 将/ 不/ 完备/ 数据/ 集/ IDS/ 划分/ 为/ 等价/ 类/ ./ 图/ 3/ 不/ 完备/ 大/ 数据/ 填补/ 任务/ 流程/ 其中/ ,/ 系统/ 从云/ 平台/ 的/ HDFS/ 中/ 读取数据/ ,/ 数据/ 输出/ 到/ HDFS/ 都/ 是/ 并行执行/ 的/ 过程/ ,/ 避免/ 因/ 读写/ 数据/ 造成/ 的/ 任务/ 等待/ ,/ 充分发挥/ 数据/ 并行/ 优势/ ./ Job1/ 的/ 任务/ 是/ 分离/ 不/ 完备/ 数据/ ./ 对于/ 执行/ Job1/ 的/ 节点/ ,/ 多个/ MapReduce/ 任务/ 分别/ 检测/ 数据/ 集/ 分片/ 中/ 属性/ 缺失/ 的/ 情况/ ./ 经/ Job1/ 分离/ 出/ 的/ 决策/ 属性/ 缺失/ 的/ 不/ 完备/ 数据/ ,/ 条件/ 缺失/ 的/ 不/ 完备/ 数据/ 以及/ 完备/ 数据/ 分别/ 提交/ 给/ Job2/ 、/ Job3/ 和/ Job4/ 处理/ ./ Job2/ 负责/ 统计/ 决策/ 属性/ 缺失/ 数据/ 的/ 记录/ ID/ ,/ Job3/ 为/ 条件/ 属性/ 缺失/ 数据/ 建立/ 倒排/ 索引/ ,/ Job4/ 负责/ 生成/ 完备/ 数据/ 的/ 属性/ 值/ 序列/ ,/ 3/ 个/ 任务/ 在/ 不同/ 节点/ 上/ 并行执行/ ./ Job3/ 和/ Job4getCom/ (/ d/ ,/ List/ )/ 负责/ 找到/ d/ 的/ 完备/ 相容/ 集合/ ./ fill/ (/ X/ ,/ Count/ _/ file/ )/ 是/ 一种/ 填充/ 缺失/ 属性/ 值/ 的/ 方法/ ,/ 负责/ 使用/ 频数/ 最大/ 的/ 值/ ,/ 填充/ 不/ 具有/ 完备/ 相容/ 类/ 的/ 记录/ 的/ 缺失/ 属性/ 值/ ;/ fill/ (/ X/ ,/ L/ )/ 负责/ 根据/ 完备/ 相容/ 类/ 填充/ 缺失/ 属性/ 值/ ./ 其中/ ,/ 填充/ 序列/ L/ 是/ 通过/ getMinMDL/ (/ MDLA/ (/ X/ )/ )/ 获得/ 的/ MDL/ 值/ 最小/ 的/ 序列/ ./ 根据/ 倒排/ 索引/ ,/ 该/ 算法/ 并行/ 地/ 将/ 数据/ 记录/ 划分/ 为/ 完备/ 相容/ 类/ ,/ 并/ 分别/ 在/ 各/ 完备/ 相容/ 类中/ 并行计算/ 填补/ 的/ 候选/ 值/ ,/ 充分发挥/ 了/ 云/ 平台/ 的/ 数据/ 并行/ 化/ 优势/ ./ 算法/ 2/ 是/ 一个/ 先/ 划分/ 完备/ 相容/ 类/ ,/ 然后/ 在/ 各/ 完备/ 相容/ 类中/ 分别/ 填补/ 缺失/ 值/ 的/ 过程/ ./ 缺失/ 值/ 计算/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ k/ ×/ r/ )/ ,/ 整个/ 填补/ 算法/ 的/ 并行/ 化/ 执行/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ k/ ×/ r/ ×/ c/ // j/ )/ ./ 其中/ ,/ k/ 为/ 存在/ 缺失/ 值/ 的/ 条件/ 属性/ 的/ 组合/ 数/ k/ =/ 2m/ -/ 1/ ,/ m/ 为/ 存在/ 缺失/ 值/ 的/ 条件/ 个数/ ,/ r/ 为/ 各/ 完备/ 相容/ 类中/ 的/ 数据/ 个数/ 的/ 最大值/ ,/ c/ 为/ 产生/ 的/ 完备/ 相容/ 类/ 的/ 个数/ ,/ j/ 为/ 分布式/ 平台/ 并行执行/ 的/ 任务/ 数/ ./ 4.3/ CIBD/ 算法/ 的/ 并行/ 优化/ CIBD/ 算法/ 架构/ 在/ 其云/ 平台/ 上/ ,/ 能够/ 发挥/ 数据/ 并行/ 、/ 节点/ 内/ Map/ 和/ Reduce/ 任务/ 的/ 并行/ 以及/ 节点/ 间/ Job/ 任务/ 并行/ 3/ 方面/ 优势/ ,/ 从而/ 提高/ 算法/ 的/ 时间/ 和/ 空间/ 效率/ ./ 具体任务/ 流程/ 如图/ 3/ 所示/ ./ 将/ 执行/ 结果/ 提交/ 给/ Job5/ ./ Job5/ 负责/ 并行/ 求解/ 完备/ 相容/ 类/ ,/ 将/ 存在/ 完备/ 相容/ 类/ 的/ 部分/ 提交/ 给/ Job7/ ,/ 将/ 不/ 存在/ 完备/ 相容/ 类/ 的/ 部分/ 提交/ 给/ Job8/ ./ Job7/ 负责/ 根据/ 完备/ 相容/ 类/ 填补/ 缺失/ 属性/ 值/ ,/ Job8/ 负责/ 根据/ 属性/ 值/ 的/ 频率/ 填补/ 缺失/ 属性/ 值/ ,/ 而/ Job6/ 负责/ 去除/ 决策/ 属性/ 缺失/ 的/ 数据/ ,/ Job6/ 、/ Job7/ 和/ Job8/ 这/ 3/ 个/ 任务/ 可以/ 并行执行/ ./ 5/ 能耗/ 大/ 数据/ 并行/ 分类/ 数据中心/ 主要/ 通过/ 控制/ 太阳能/ 供电/ 端口/ 和/ 市电/ Page8/ 供电/ 端口/ ,/ 调整/ 供电/ 方式/ 和/ 能源/ 使用/ 方式/ ./ 对/ 能耗/ 大/ 数据/ 的/ 合理/ 分类/ ,/ 可以/ 根据/ 分类/ 结果/ 指导/ 供电/ 方式/ ,/ 更为/ 高效/ 的/ 使用/ 太阳能/ 等/ 新能源/ ,/ 配置/ 市/ 电/ 电能/ 供给/ ,/ 从而/ 避免/ 数据中心/ 中/ 电能/ 存储设备/ 的/ 频繁/ 充放电/ ,/ 在/ 延长/ 设备/ 寿命/ 的/ 同时/ 保护环境/ ./ 因此/ ,/ 本文/ 设计/ 了/ 数据中心/ 能耗/ 大/ 数据/ 并行/ 分类/ 方法/ ./ 5.1/ 能耗/ 大/ 数据/ 的/ 分类/ 算法/ 改进/ 策略/ 能耗/ 大/ 数据/ 信息量/ 大/ 、/ 数据/ 的/ 维度/ 高/ 、/ 数据/ 的/ 结构复杂/ ,/ 传统/ 的/ 分类/ 算法/ 在/ 对/ 其/ 进行/ 处理/ 时会/ 显得/ 力不从心/ ./ 随机/ 森林/ 分类/ 算法/ 训练/ 过程/ 复杂度/ 低/ ,/ 预测/ 算法/ 的/ 速度/ 很快/ ,/ 对/ 噪音/ 有/ 较/ 好/ 的/ 耐受/ 能力/ ,/ 且/ 对/ 高维/ 数据/ 分类/ 问题/ 具有/ 良好/ 的/ 可扩展性/ 和/ 并行性/ ./ 因此/ 随机/ 森林/ 分类/ 算法/ 十分/ 适用/ 于/ 处理/ 能耗/ 大/ 数据/ ./ (/ 1/ )/ 随机/ 森林/ 分类/ ./ 建立/ 随机/ 森林/ 的/ 过程/ 实质/ 是/ 构建/ 多棵/ 决策树/ 的/ 过程/ ./ 在/ 建立/ 决策树/ 时/ ,/ 建树/ 过程/ 中/ 会/ 随机/ 抽取/ 若干个/ 属性/ ,/ 计算/ 最大/ 增益/ 属性/ 作为/ 结点/ ./ 当/ 使用/ 随机/ 森林/ 分类/ 时/ ,/ 每棵/ 决策树/ 都/ 参与/ 分类/ ,/ 并/ 通过/ 投票/ 机制/ 决定/ 输入/ 数据/ 的/ 分类/ 类别/ [/ 41/ ]/ ./ (/ 2/ )/ 改进/ 策略/ 1/ :/ 选择/ 合适/ 的/ 决策树/ 及/ 属性/ 个数/ ./ 使用/ 随机/ 森林/ 对大/ 数据/ 进行/ 分类/ 时/ ,/ 决策树/ 的/ 个数/ 会/ 在/ 一定/ 程度/ 上/ 影响/ 建立/ 模型/ 的/ 时间/ 效率/ (/ 建模/ 时间/ )/ 、/ 空间/ 效率/ (/ 结点/ 数/ )/ 和/ 分类/ 效果/ (/ 准确率/ )/ ./ 因此/ ,/ 在/ 对/ 数据中心/ 的/ 能耗/ 大/ 数据/ 分类/ 之前/ ,/ 应该/ 综合/ 考虑/ 属性/ 个数/ ,/ 平台/ 节点/ 数/ 以及/ 数据/ 规模/ ,/ 计算/ 出/ 较为/ 合适/ 的/ 输入/ 参数/ ./ (/ 3/ )/ 改进/ 策略/ 2/ :/ 离散/ 化/ 连续/ 属性/ ./ 数据中心/ 的/ 能耗/ 大/ 数据/ 往往/ 具有/ 多维/ 连续/ 属性/ ,/ 对/ 连续/ 属性/ 进行/ 离散/ 化/ 能够/ 在/ 一定/ 程度/ 上/ 提高/ 分类/ 的/ 准确率/ 和/ 可靠性/ ./ (/ 4/ )/ 改进/ 策略/ 3/ :/ 弱/ 相关/ 化/ 随机抽样/ 属性/ 组/ ./ 在/ 能耗/ 大/ 数据/ 的/ 分类/ 过程/ 中/ ,/ 由于/ 太阳能/ 的/ 不稳定性/ ,/ 会/ 导致/ 属性/ 值/ 的/ 关联/ 具有/ 一定/ 的/ 随机性/ ./ 合适/ 的/ 属性/ 选择/ 方法/ ,/ 能/ 提高/ 能耗/ 大/ 数据/ 的/ 分类/ 准确率/ 和/ 可靠性/ ./ 因此/ ,/ 本文/ 采用/ 了/ 相关性/ 检测/ 的/ 方法/ ./ 在/ 保证/ 随机抽样/ 的/ 前提/ 下/ ,/ 选择/ 与/ 已/ 抽样/ 属性/ 组/ 相关性/ 最小/ 的/ 属性/ 元组/ ,/ 作为/ 参与/ 建树/ 属性/ ,/ 从而/ 降低/ 决策树/ 之间/ 的/ 相关性/ ,/ 提高/ 决策树/ 对/ 领域/ 的/ 覆盖/ 精度/ ,/ 保证/ 随机/ 森林/ 模型/ 更加/ 合理/ ./ 5.2/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 算法/ 流程/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 分类/ 算法/ (/ Discreti/ -/ zationandWeak/ -/ correlationbasedDecisionForestalgorithm/ ,/ 简称/ DWDF/ 算法/ )/ 是/ 一种/ 由/ 随机/ 森林/ 改进/ 得到/ 的/ ,/ 面向/ 能耗/ 大/ 数据/ 的/ 分类/ 算法/ ./ 该/ 算法/ 从/ 参数/ 选择/ 、/ 离散/ 化/ 连续/ 属性/ 和/ 弱/ 相关/ 化/ 随机抽样/ 这/ 3/ 个/ 方面/ 改进/ 随机/ 森林/ 算法/ ,/ 其/ 算法/ 流程图/ 如图/ 4/ 所示/ ./ (/ 1/ )/ 计算/ 决策树/ 及/ 属性/ 个数/ ./ 选择/ 合适/ 的/ 决策树/ 数目/ 及/ 属性/ 个数/ 是/ DWDF/ 算法/ 的/ 预处理/ 环节/ ./ 首先/ ,/ 对/ 属性/ 个数/ m/ 和/ 决策/ 森林/ 个数/ T/ 的/ 计算/ ./ 随机/ 森林/ 对/ 输入/ 属性/ 十分/ 敏感/ ,/ 我们/ 通常/ 将/ 决策树/ 选取/ 属性/ 的/ 个数/ 设定/ 为/ 其中/ [/ log2d/ ]/ 为/ 不/ 超过/ log2d/ 的/ 最大/ 整数/ [/ 36/ ]/ ./ 决策树/ 数目/ 过少/ ,/ 会/ 导致/ 分类/ 模型/ 不/ 准确/ ,/ 分类/ 时间/ 效率/ 低/ ;/ 在/ 决策树/ 数目/ 过多时/ ,/ 会/ 出现/ 一定/ 程度/ 的/ 过/ 拟合/ ,/ 不仅/ 空间/ 效率/ 低/ 而且/ 分类/ 准确率/ 降低/ ./ 综合/ 考虑/ 这些/ 因素/ ,/ 需要/ 尽量/ 让/ 各个/ Reduce/ 任务/ 经/ 归约/ 后/ ,/ 能够/ 单独/ 计算/ 一个/ 属性/ 的/ 熵/ ./ 因此/ ,/ 这里/ 将/ 决策树/ 数目/ 设定/ 为/ 其中/ ,/ node/ _/ num/ 和/ re/ _/ num/ 分别/ 为云/ 平台/ 的/ Data/ _/ Page9Node/ 节点/ 个数/ 和/ 各/ 节点/ 统一/ 设定/ 的/ reduce/ 任务/ 数/ ;/ m/ 为/ 决策树/ 分类/ 选取/ 属性/ 的/ 个数/ ./ T/ 的/ 整数/ 部分/ 即/ 为/ 决策树/ 数目/ ,/ 参数/ λ/ 根据/ 实际/ 数据/ 集/ 进行/ 设置/ ./ (/ 2/ )/ 离散/ 化/ 连续/ 属性/ ./ 离线/ 化/ 连续/ 属性/ 也/ 属于/ DWDF/ 算法/ 中/ 的/ 预处理/ 环节/ ,/ 该/ 步骤/ 需要/ 根据/ 输入/ 的/ 属性/ 描述/ ,/ 找到/ 连续/ 属性/ (/ 属性/ 描述/ 为/ N/ )/ ./ 然后/ ,/ 在/ 生成/ 描述性/ 信息/ 过程/ 中/ ,/ 记录/ 所有/ 记录/ 中/ 连续/ 属性/ 的/ 属性/ 值/ ,/ 计算/ 最值/ ./ 选择/ 其中/ 分布/ 较/ 均匀/ 的/ 属性/ i/ ,/ 属性/ i/ 的/ 离散/ 区间/ 长度/ 为/ 其中/ ,/ max/ _/ i/ 和/ min/ _/ i/ 分别/ 为/ 该/ 连续/ 属性/ 的/ 最大值/ 和/ 最小值/ ,/ t/ 为/ 设定/ 的/ 离散/ 区间/ 个数/ (/ t/ 的/ 值/ 依据/ 数据/ 集中/ 离散/ 属性/ 的/ 取值/ 数/ 确定/ )/ ./ 然后/ ,/ 根据/ 离散/ 区间/ 长度/ 计算/ 连续/ 属性/ 的/ 分裂/ 点/ ./ 属性/ i/ 的/ 第/ j/ 个/ 分裂/ 点/ split/ _/ i/ _/ j/ =/ min/ _/ i/ +/ j/ ×/ split/ _/ i/ _/ len/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ -/ 1/ ./ 属性/ 分裂/ 点/ 信息/ 和/ 其他/ 描述/ 信息/ 一起/ 存放/ 在/ 描述性/ 文件/ 中/ ./ 在/ 用于/ 分类/ 能耗/ 大/ 数据/ 的/ 决策树/ 中/ ,/ 决策/ 属性/ 和/ 太阳能/ 的/ 端口数/ 相关/ ./ 因此/ ,/ 初始/ 的/ 离散/ 区间/ 个数/ t0/ =/ λ/ ×/ s/ ./ 这里/ λ/ 取/ 1/ ,/ s/ 为/ 太阳能/ 端口数/ ./ 为了/ 减少/ 数据/ 节点/ 的/ 分裂/ 次数/ ,/ 需要/ 满足条件/ (/ 1/ )/ :/ 离散/ 后/ 每个/ 数据/ 区间/ 的/ 属性/ 值/ 数目/ 小于/ 阈值/ threshold/ _/ 1/ (/ threshold/ _/ 1/ 为/ Δ/ t/ 内/ 数据/ 记录/ 总数/ 的/ 5/ %/ )/ ;/ 为了/ 防止/ 区间/ 值域/ 过于/ 分散/ ,/ t/ 需要/ 满足条件/ (/ 2/ )/ :/ 离散/ 个数/ t/ 小于/ 阈值/ threshold/ _/ 2/ (/ threshold/ _/ 2/ 为/ 2s/ ,/ s/ 为/ 太阳能/ 端口数/ )/ ./ 考虑/ 到/ 数据中心/ 的/ 实时性/ ,/ 设置/ 时间/ 戳/ Δ/ t/ 为/ 半小时/ ./ 每隔/ Δ/ t/ 系统/ 自动检测/ 一次/ ,/ 若/ 不/ 满足条件/ (/ 1/ )/ ,/ 则/ t/ 的/ 个数/ 增加/ 1/ ;/ 若/ 不/ 满足条件/ (/ 2/ )/ ,/ 则/ t/ 的/ 个数/ 减少/ 1/ ./ (/ 3/ )/ 弱/ 相关/ 化/ 随机抽样/ 属性/ 组/ ./ 在/ 完成/ 前面/ 的/ 预处理/ 后/ ,/ DWDF/ 算法/ 会/ 检测/ 数据/ 集/ 容量/ 是否/ 小于/ 阈值/ N/ ,/ 若/ 小于/ 则/ 直接/ 生成/ 决策树/ ;/ 反之/ ,/ 计算/ 最大/ 增益/ 属性/ A/ ,/ 然后/ 将/ A/ 分为/ 连续/ 属性/ 和/ 离散/ 属性/ 两个/ 部分/ ./ 在/ 生成/ 描述/ 信息/ 的/ 过程/ 中/ ,/ 计算/ 数据/ 集中/ 各/ 连续/ 属性/ 值/ 的/ 平均值/ ,/ 以及/ 离散/ 属性/ 各/ 离散/ 值/ 出现/ 的/ 次数/ ./ 对于/ 离散/ 属性/ ,/ 采用/ TF/ -/ IDF/ (/ TermFrequency/ -/ InverseDocumentFrequency/ )/ 思想/ 来/ 计算/ 离散/ 属性/ 的/ 相关/ 程度/ ,/ 两组/ 属性/ 中/ 离散/ 属性/ 相似/ 程度/ 计算公式/ 为/ 其中/ i/ 为/ 离散/ 属性/ ,/ C/ 为/ 所有/ 离散/ 属性/ 的/ 集合/ ,/ i/ _/ tag/ 为/ 两组/ 属性/ 是否/ 都/ 包含/ 离散/ 属性/ i/ 的/ 判断/ 值/ ./ 若/ 都/ 包含/ i/ _/ tag/ 取/ 1/ ,/ 否则/ 取/ 0/ ./ num/ 为/ 属性/ 的/ 总/ 个数/ ,/ num/ _/ c/ 为/ 离散/ 属性/ 个数/ ./ 对于/ 连续/ 属性/ ,/ 将/ 其/ 所有/ 记录/ 的/ 属性/ 均值/ ,/ 作为/ 描述/ 属性/ 输入/ ./ 这样/ 可以/ 使/ 相关性/ 检验/ 和/ 离散/ 化/ 成为/ 两个/ 独立/ 的/ 过程/ ./ 连续/ 属性/ 间/ 的/ 相关性/ 计算公式/ 为/ 其中/ ,/ i/ 为/ 连续/ 属性/ ,/ N/ 为/ 所有/ 连续/ 属性/ 的/ 集合/ ,/ i/ _/ tag/ 为/ 两组/ 属性/ 是否/ 都/ 包含/ 连续/ 属性/ i/ 的/ 判断/ 值/ ,/ 若/ 都/ 包含/ i/ _/ tag/ 取/ 1/ ,/ 否则/ 取/ 0/ ./ v/ _/ i/ 为/ 连续/ 属性/ i/ 的/ 均值/ ./ 两组/ 属性/ 的/ 相关性/ 为/ W/ =/ WC/ +/ WN/ ./ 计算/ 抽样/ 属性/ 与/ 各/ 已/ 建树/ 属性/ 的/ 相关/ 项/ 的/ 均值/ W/ ./ W/ 越/ 接近/ 0/ ,/ 表示/ 相关性/ 越小/ ,/ 找到/ 2m/ 个/ 随机抽样/ 属性/ 中/ 与/ 已/ 抽样/ 属性/ 相关性/ 最小/ 的/ m/ 个/ 属性/ ,/ 作为/ 随机抽样/ 的/ 属性/ 元组/ ,/ 从而/ 达到/ 弱/ 相关/ 化/ 随机抽样/ 属性/ 组/ 的/ 目的/ ./ 5.3/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 算法/ 描述/ 本文/ 提出/ 的/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 算法/ 主要/ 包括/ 生成/ 决策/ 森林/ 和/ 建立/ 决策树/ 两个/ 部分/ ./ 整体/ 生成/ 决策/ 森林/ 算法/ 描述/ 如/ 算法/ 3/ ./ 算法/ 3/ ./ 生成/ 决策/ 森林/ 算法/ ./ 输入/ :/ 原始数据/ 集/ DS/ ,/ 连续/ 区间/ 数/ t/ ,/ 阈值/ N/ ,/ 属性/ 数/ 输出/ :/ 决策/ 森林/ DFde/ _/ file/ ←/ describe/ (/ DS/ ,/ t/ )/ ;/ FORi/ =/ 1TOTDOdataset/ ←/ bootstrap/ (/ DS/ )/ ;/ DF/ ←/ Build/ _/ DecisionTree/ (/ dataset/ ,/ de/ _/ file/ ,/ m/ ,/ N/ )/ ;/ ENDRETURNDF/ ;/ 其中/ ,/ describe/ (/ DS/ ,/ t/ )/ 能够/ 根据/ 数据/ 集/ 及其/ 属性/ 描述/ 创建/ 描述性/ 文件/ de/ _/ file/ ,/ 此外/ 均值/ 信息/ 和/ 连续/ 属性/ 的/ 分裂/ 点/ 等/ 额外/ 信息/ 也/ 存入/ 到/ de/ _/ file/ 中/ ./ 而/ bootstrap/ (/ DS/ )/ 用于/ 对/ 原始数据/ 集/ bootstrap/ 抽样/ ./ 核心/ 函数/ Build/ _/ DecisionTree/ (/ dataset/ ,/ de/ _/ file/ ,/ m/ ,/ N/ )/ 会/ 调用/ 决策树/ 算法/ 建立/ 一棵/ 决策树/ ./ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 算法/ 的/ 核心/ 部分/ 是/ 建立/ 决策树/ ,/ 见/ 算法/ 4/ ./ 算法/ 4/ ./ 建立/ 决策树/ 算法/ ./ 输入/ :/ 原始数据/ 集/ DS/ ,/ 描述/ 文件/ de/ _/ file/ ,/ 属性/ 数/ m/ ,/ 阈/ 输出/ :/ 决策树/ D/ _/ TreeIFthesizeofdatasetc/ _/ num/ </ NDOR/ _/ attributes/ ←/ getRandomAttr/ (/ DS/ ,/ 2m/ )/ ;/ Page10W/ _/ attributes/ ←/ getWeakCorrelation/ (/ R/ _/ attributes/ ,/ A/ =/ getMaxGain/ (/ DS/ ,/ W/ _/ attributes/ )/ ;/ de/ _/ file/ ←/ update/ (/ de/ _/ file/ ,/ A/ )/ ;/ IFA/ / CTHENELSEENDELSED/ _/ Tree/ ←/ returnCategory/ (/ Tree/ )/ ;/ ENDRETURND/ _/ Tree/ ;/ 其中/ ,/ getRandomAttr/ (/ DS/ ,/ 2m/ )/ 负责/ 从/ 数据/ 属性/ 集中/ ,/ 随机/ 抽取/ 2m/ 个/ 属性/ ,/ 而/ getWeakCorrelation/ (/ R/ _/ attributes/ ,/ file/ ,/ m/ )/ 负责/ 选择/ 其中/ 的/ m/ 个/ 相关性/ 最小/ 的/ 属性/ 元组/ ./ 然后/ getMaxGain/ (/ DS/ ,/ W/ _/ attributes/ )/ 会/ 计算/ 其中/ 的/ 最大/ 增益/ 属性/ ./ 计算/ 完成/ 后/ ,/ 通过/ update/ (/ de/ _/ file/ ,/ A/ )/ 将/ 已/ 分裂/ 属性/ 名/ 放入/ 描述性/ 文件/ ./ divide/ (/ DS/ ,/ A/ ,/ k/ )/ 将/ 数据/ 集/ 划分/ 为/ k/ 个/ 部分/ ,/ 分别/ 建立/ k/ 棵子/ 树/ ./ divide/ (/ DS/ ,/ A/ ,/ t/ )/ 有/ 同样/ 的/ 作用/ ,/ 只是/ 这里/ 的/ t/ 为/ 连续/ 属性/ 的/ 离散/ 区间/ 个数/ ./ returnCategory/ (/ Tree/ )/ 负责/ 返回/ 决策树/ ,/ 其中/ 返回/ 叶子/ 节点/ 类别/ 是/ DS/ 中/ 类别/ 最多/ 的/ 一个/ ./ Build/ _/ DecisionTree/ (/ DS/ ,/ de/ _/ file/ ,/ m/ ,/ N/ )/ 的/ 时间/ 复杂度/ 为/ O/ (/ h/ ×/ n/ )/ ,/ 其中/ h/ 为/ 记录/ 的/ 属性/ 数/ ./ Build/ _/ DecisionTree/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ 2m/ ×/ log/ (/ 2m/ )/ )/ ./ Build/ _/ Forest/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ 2m/ ×/ log/ (/ 2m/ )/ ×/ T/ // j/ )/ ./ 其中/ ,/ T/ 为/ 分类/ 模型/ 中/ 的/ 决策树/ 个数/ ,/ n/ 为/ 数据/ 集/ dataset/ 中/ 的/ 记录/ 数/ ,/ m/ 为/ n/ 的/ 数据/ 元组/ 选择/ 的/ 属性/ 个数/ ,/ j/ 为/ 分布式/ 平台/ 并行执行/ 的/ 任务/ 数/ ./ 6/ 增量/ 更新/ 决策/ 森林/ 算法/ 增量/ 更新/ 分类/ 模型/ 是/ 能耗/ 大/ 数据管理/ 模型/ 的/ 一个/ 重要/ 步骤/ ./ 数据中心/ 中/ 用于/ 处理/ 能耗/ 大/ 数据/ 的/ 虚拟/ 机会/ 动态/ 迁移/ ,/ 以/ 保证/ 各/ 数据中心/ 充分利用/ 资源/ ./ 随着/ 时间/ 的/ 推移/ ,/ 虚拟机/ 的/ 迁移/ 以及/ 环境因素/ 的/ 变化/ 会/ 导致/ 分类/ 模型/ 的/ 分类/ 效果/ 越来越/ 差/ ;/ 且/ 能耗/ 大/ 数据/ 的/ 规模/ 庞大/ ,/ 读取/ 全部/ 数据/ ,/ 重建/ 分类/ 模型/ 会/ 造成/ 大量/ 的/ 时间/ 和/ 空间/ 的/ 开销/ ;/ 而且/ 数据中心/ 更新/ 速度/ 快/ ,/ 能耗/ 大/ 数据/ 变化/ 大/ ,/ 历史数据/ 不断/ 积累/ ./ 数据/ 的/ 价值/ 会/ 随着/ 时间/ 的/ 流逝/ 而/ 不断/ 下降/ ,/ 因此/ 需要/ 尽快/ 地/ 对/ 最新/ 的/ 数据/ 做出/ 分析/ 并/ 对模型/ 做出/ 调整/ ./ 6.1/ 增量/ 更新/ 能耗/ 大/ 数据/ 分类/ 模型/ 本文/ 提出/ 增量/ 更新/ 决策/ 森林/ 算法/ (/ IncrementalUpdatingDecisionForest/ 算法/ ,/ 简称/ IUDF/ 算法/ )/ ,/ 来/ 解决/ 分类/ 模型/ 无法/ 处理/ 数据/ 规模/ 大/ ,/ 并/ 不断更新/ 的/ 问题/ ./ 该/ 算法/ 能/ 利用/ 新增/ 数据/ ,/ 检验/ 已经/ 建立/ 的/ 决策/ 森林/ 模型/ 中/ 各个/ 决策树/ 的/ 分类/ 准确率/ ,/ 将/ 分类/ 准确率/ 过低/ 的/ 决策树/ 标记/ ;/ 然后/ 将/ 新/ 增加/ 的/ 数据/ 集/ 作为/ 训练/ 数据/ 集/ ,/ 重建/ 相同/ 数目/ 的/ 决策树/ 来/ 替代/ 那些/ 标记/ 了/ 的/ 决策树/ ./ 这样/ 获得/ 的/ 决策/ 森林/ 分类/ 模型/ 能够/ 不断更新/ 以/ 适应/ 变化/ 的/ 能耗/ 大/ 数据/ ./ 增量/ 更新/ 决策/ 森林/ 算法/ 描述/ 如/ 算法/ 5/ ./ 算法/ 5/ ./ 增量/ 更新/ 分类/ 模型/ ./ 输入/ :/ 决策/ 森林/ DF/ ,/ 更新/ 数据/ 集/ UDS/ ,/ 准确率/ 阈值/ N/ 输出/ :/ 新/ 决策/ 森林/ DFcount/ =/ 0/ ;/ FOREACHdecisiontreeTINDFDOaccuracy/ ←/ classify/ (/ T/ ,/ UDS/ )/ ;/ IFaccuracy/ </ NTHENcount/ ++/ ;/ DF/ ←/ deleteTree/ (/ DF/ ,/ T/ )/ ;/ ENDENDIFcount/ ≠/ 0THENDF/ ←/ Build/ _/ Forest/ (/ UDS/ ,/ t/ ,/ N/ ,/ m/ ,/ count/ )/ ;/ ENDRETURNDF/ ;/ 其中/ ,/ classify/ (/ T/ ,/ UDS/ )/ 的/ 作用/ 是/ 决策树/ T/ 对/ 更新/ 数据/ 集/ UDS/ 进行/ 分类/ ;/ 分类/ 后/ 得到/ 的/ 分类/ 准确率/ 与/ 阈值/ N/ 比较/ ,/ 如果/ 它/ 小于/ 阈值/ ,/ 则/ 通过/ deleteTree/ (/ DF/ ,/ T/ )/ 将/ 对应/ 决策树/ 从/ 决策/ 森林/ 中/ 剔除/ ./ 在/ 检验/ 完/ 所有/ 决策树/ 后/ ,/ 如果/ 有/ 决策树/ 被/ 剔除/ 了/ ,/ 则/ 通过/ Build/ _/ Forest/ (/ UDS/ ,/ t/ ,/ N/ ,/ m/ ,/ count/ )/ 重新/ 建立/ 相同/ 数目/ 的/ 决策树/ ./ Update/ _/ Forest/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ T/ ×/ n/ +/ n/ ×/ 2m/ ×/ log/ (/ 2m/ )/ )/ ,/ 其中/ T/ 为/ 分类/ 模型/ 中/ 的/ 决策树/ 个数/ ,/ n/ 为/ UDS/ 中/ 的/ 记录/ 数/ ,/ m/ 为/ n/ 的/ 数据/ 元组/ 选择/ 的/ 属性/ 个数/ ./ 该/ 算法/ 通过/ 检测/ 新增/ 数据/ 集/ 的/ Page11/ 分类/ 效果/ ,/ 检验/ 已/ 构建/ 的/ 分类/ 模型/ 是否/ 适应/ 系统/ 环境/ 的/ 变化/ ./ 6.2/ 增量/ 更新/ 决策/ 森林/ 算法/ 的/ 并行/ 化/ 数据中心/ 通常/ 采用/ 太阳能/ 等/ 不/ 稳定/ 的/ 新能源/ 辅助/ 供电/ ,/ 因此/ 对/ 能耗/ 大/ 数据/ 的/ 分析/ 和/ 处理/ 策略/ 需要/ 不断/ 调整/ ./ 由于/ 决策/ 森林/ 模型/ 由/ 多棵/ 决策树/ 组成/ ,/ 不同/ 决策树/ 的/ 使用/ 互不/ 影响/ ,/ 因此/ 增量/ 更新/ 模型/ 和/ 决策/ 森林/ 分类/ 都/ 可以/ 并行处理/ 多棵/ 决策树/ ,/ 其/ 任务/ 流程/ 如图/ 5/ 所示/ ./ 名称/ 高性能/ PC/ 普通/ PCcompute1/ _/ power/ _/ expected/ (/ ×/ 4/ )/ compute1/ _/ power/ _/ var/ (/ ×/ 4/ )/ 表/ 1Hadoop/ 平台/ 环境/ 配置/ 表/ 硬盘/ 750GB500GB/ 表/ 2/ 真实/ 数据/ 集/ 相关/ 描述/ 52535527155030/ 表/ 3FX/ 属性/ 描述性/ 信息/ 表/ 属性/ 说明/ 产生/ 数据/ 的/ 时间/ 点/ 计算/ 节点/ 1/ 的/ 功耗/ ,/ 一共/ 有/ 4/ 个/ 计算/ 节点/ 太阳能/ 发电/ 功率/ 计算/ 节点/ 1/ 的/ 功耗/ 均值/ (/ 最近/ 半小时/ )/ ,/ 共/ 4/ 个/ 太阳能/ 发电/ 功率/ 的/ 均值/ (/ 最近/ 半小时/ )/ 电池/ 电压/ 均值/ (/ 最近/ 半小时/ )/ 计算/ 节点/ 1/ 在/ 最近/ 半小时/ 的/ 功耗/ 标准差/ 太阳能/ 发电/ 功能/ 标准差/ ,/ 波动/ 阈值/ 100/ 电池/ 电压/ 电池/ 电流/ 方向/ 电池/ 那里/ 温度传感器/ 状态值/ 实际/ 太阳能/ 口/ 的/ 中/ 输出功率/ 实际/ 太阳能/ 所用/ 端口/ 数目/ 7.2/ 实验/ 指标/ (/ 1/ )/ 填补/ 准确率/ ./ 考虑/ 到/ 待处理/ 的/ 不/ 完备/ 数据/ 集/ 存在/ 离散/ 属性/ 和/ 7/ 实验/ 分析/ 7.1/ 实验/ 环境/ (/ 1/ )/ 实验/ 平台/ ./ 本文/ 实验/ 采用/ Hadoop/ 分布式/ 云/ 计算/ 平台/ ./ 整个/ 体系/ 由/ 一个/ JobTracker/ 和/ 若干个/ TaskTracker/ 组成/ 的/ ,/ 其中/ JobTracker/ 负责/ 分割/ 任务/ 并/ 调度/ TaskTracker/ 去/ 执行/ ./ 实验/ 采用/ 一台/ 高性能/ PC/ 作为/ 运行/ NameNode/ 和/ JobTracker/ 进程/ 的/ 主/ 节点/ Master/ ,/ 19/ 台/ 普通/ PC/ 作为/ 运行/ DataNode/ 和/ Task/ -/ Tracker/ 进程/ 的/ 从/ 节点/ slaver/ ,/ 从而/ 搭建/ 20/ 个/ 结点/ 的/ 集群/ ./ 实验/ 平台/ 配置/ 如表/ 1/ 所示/ ,/ 每个/ 普通/ PC/ 上/ 创建/ 1/ 台/ 虚拟机/ 每台/ 虚拟机/ 分配内存/ 为/ 2GB/ ,/ 硬盘/ 200GB/ ./ Hadoop/ 平台/ 环境/ 配置/ 详见/ 表/ 1/ ./ (/ 2/ )/ 实验/ 数据/ ./ 本/ 实验/ 选取/ 某/ 绿色/ 数据中心/ 的/ 日志/ 数据/ 作为/ 真实/ 的/ 数据/ 集/ ./ 真实/ 数据/ 的/ 取样/ 数据表/ 描述/ 详见/ 表/ 2/ ./ FX/ 数据/ 集/ (/ 某/ 绿色/ 数据中心/ 系统/ 能耗/ 数据/ 集/ )/ 用于/ 分类/ 的/ 属性/ 描述性/ 的/ 信息/ 如表/ 3/ 所示/ (/ 其中/ 属性/ 描述/ 栏中/ C/ 为/ 离散/ 属性/ ,/ N/ 为/ 连续/ 属性/ ,/ L/ 为类/ 标签/ )/ ./ 总/ 功率/ 连续/ 属性/ ,/ 填补/ 准确率/ 应/ 综合/ 考虑/ 两种/ 情况/ ./ 对于/ 离散/ 属性/ ,/ 若/ 填补/ 值/ 和/ 替换/ 前/ 的/ 真实/ 值/ 相同/ ,/ 则/ 填补/ 准确/ ;/ 对于/ 连续/ 属性/ ,/ 由于/ 计算/ 的/ 填补/ 值/ 和/ 真实/ 值/ 必定/ Page12/ 会/ 存在/ 一定/ 的/ 差异/ ,/ 因此/ 填补/ 值/ 和/ 替换/ 前/ 的/ 真实/ 值/ 误差/ 在/ 一定/ 范围/ 内/ ,/ 则/ 填补/ 准确/ ./ 因此/ 填补/ 准确率/ 的/ 计算公式/ 如下/ :/ P0/ =/ ∑/ i/ ∈/ C/ 其中/ C/ 表示/ 离散/ 属性/ 集/ ,/ N/ 表示/ 连续/ 属性/ 集/ ,/ nl/ 表示/ 缺失/ 的/ 属性/ 个数/ ./ 若/ 离散/ 属性/ i/ 填补/ 准确/ ,/ 则/ ti/ =/ 1/ ;/ 否则/ ti/ =/ 0/ ./ tag/ (/ x/ )/ 为/ 判断/ 函数/ ,/ 若/ x/ >/ 0/ 或/ x/ =/ 0/ ,/ 则/ tag/ (/ x/ )/ =/ 1/ ,/ 否则/ tag/ (/ x/ )/ =/ 0/ ./ vr/ 表示/ 真实/ 值/ ,/ v/ 表示/ 填补/ 值/ ,/ λ/ 表示/ 系数/ (/ 本/ 实验/ 取/ 1/ )/ ,/ Sj/ 表示/ 数据/ j/ 的/ 方/ 差值/ (/ 真实/ 的/ 大/ 数据/ 集中/ 表示/ 半小时/ 内/ 的/ 方/ 差值/ )/ ./ (/ 2/ )/ 分类/ 准确率/ ./ 分类/ 准确率/ 通常/ 作为/ 分类/ 效果/ 评价/ 的/ 一个/ 重要/ 指标/ ,/ 本/ 实验/ 采用/ 的/ 分类/ 准确率/ 计算公式/ 为/ 其中/ N/ 表示/ 对象/ 的/ 总/ 个数/ ,/ bi/ 表示/ 正确/ 分类/ 到/ 第/ i/ 类/ 的/ 对象/ 个数/ ,/ k/ 表示/ 分类/ 的/ 个数/ ./ (/ 3/ )/ 生成/ 结点/ 数/ ./ 由于/ 云/ 平台/ 各/ 节点/ 共享资源/ 池/ ,/ 生成/ 较/ 多/ 的/ 节点/ ,/ 不仅/ 影响/ 空间/ 效率/ ,/ 而且/ 过多/ 节点/ 的/ 存入/ 与/ 访问/ 图/ 6/ 不/ 完备/ 大/ 数据/ 填补/ 准确率/ 对比/ 都/ 会/ 对/ 整个/ 集群/ 的/ 任务调度/ 速度/ 造成/ 影响/ ./ 本/ 实验/ 通过/ 生成/ 节点/ 数目/ 来/ 间接/ 衡量/ 生成/ 的/ 分类/ 模型/ 的/ 优劣/ ./ 算法/ 产生/ 的/ 节点/ 数越/ 少/ ,/ 所/ 生成/ 森林/ 的/ 规模/ 就/ 越/ 小/ ,/ 分类/ 模型/ 就/ 越/ 好/ ./ (/ 4/ )/ 决策/ 森林/ 模型/ 生成/ 时间/ ./ 决策/ 森林/ 模型/ 生成/ 时间/ 是/ 衡量/ 决策/ 森林/ 的/ 时间/ 效率/ 的/ 重要/ 指标/ 之一/ ,/ 生成/ 时间/ 越/ 少/ ,/ 则/ 决策/ 森林/ 算法/ 的/ 时间/ 效率/ 越高/ ./ 7.3/ 实验/ 分析/ 实验/ 1/ ./ 填补/ 缺失/ 值/ ./ 为了/ 使得/ 填补/ 的/ 准确率/ 评价/ 更为/ 客观/ 合理/ ,/ 首先/ 使用/ 随机/ 函数/ ,/ 数据/ 集/ FX/ 中/ 选择/ 部分/ 属性/ 值/ ,/ 用/ “/ / ”/ 去/ 替代/ 这些/ 属性/ 值/ ,/ 从而/ 得到/ 不同/ 缺失/ 率/ 的/ 不/ 完备/ 数据/ 集/ (/ 缺失/ 率/ 10/ %/ 至/ 70/ %/ )/ ./ 目前/ 常用/ 的/ 填补/ 缺失/ 值/ 的/ 方法/ 包括/ Meanbasedfillingmethod/ (/ MEAN/ )/ [/ 42/ ]/ ,/ FrequencyEstimatorbasedfillingmethod/ (/ FE/ )/ [/ 43/ ]/ ,/ ExistedRoughSetbasedfillingmethod/ (/ ERS/ )/ [/ 44/ ]/ ./ 因此/ 本文/ 分别/ 采用/ MEAN/ 、/ FE/ 、/ ERS/ 和/ 本文/ 提出/ 的/ 不/ 完备/ 大/ 数据/ 填补/ 方法/ CIBD/ 分别/ 填补/ 之前/ 得到/ 的/ 不/ 完备/ 数据/ 集/ ,/ 按照/ 式/ (/ 6/ )/ 计算/ 填补/ 准确率/ ,/ 所得/ 填补/ 准确率/ 结果/ 如图/ 6/ 所示/ ./ Page13/ 实验/ 结果表明/ 对于/ 大/ 数据/ 中/ 缺失/ 属性/ 值/ 填补/ ,/ 填补/ 准确率/ 会/ 随着/ 缺失/ 率/ 的/ 上升/ 呈/ 下降/ 趋势/ ./ 对比/ 基于/ 粗糙集/ 的/ ERS/ 填补/ 方法/ 和/ 本文/ 提出/ 的/ CIBD/ 算法/ ,/ CIBD/ 算法/ 充分利用/ 了/ 数据/ 集中/ 的/ 数据/ 信息/ ,/ 能够/ 明显提高/ 填补/ 的/ 准确率/ ./ 且/ 随着/ 数据/ 集/ 规模/ 的/ 扩大/ (/ 从/ FX1/ 到/ FX4/ )/ 优势/ 越来越/ 明显/ ./ 特别/ 是/ 对/ 数据/ 属性/ 低/ (/ 缺失/ 率/ 70/ %/ )/ 的/ 数据/ 进行/ 数据/ 密/ 补时/ ,/ 本文/ 的/ 填补/ 准确率/ 也/ 能/ 达到/ 50/ %/ 以上/ ,/ 比/ 其他/ 方法/ 具有/ 一定/ 的/ 优势/ ./ 实验/ 2/ ./ 能耗/ 大/ 数据/ 分类/ ./ 本/ 实验/ 分为/ 两个/ 部分/ ,/ 第一/ 部分/ 针对/ 不同/ 数据/ 集/ ,/ 记录/ 决策/ 森林/ 中/ 随着/ 决策树/ 个数/ t/ 的/ 变化/ ,/ 建立/ 分类/ 模型/ 时间/ 的/ 变化/ ,/ 分类/ 模型/ 中/ 结点/ 个数/ 的/ 变化/ 以及/ 分类/ 准确率/ 的/ 变化/ ;/ 通过/ 上述/ 变化/ 分析/ t/ 对/ 时间/ 效率/ (/ 主要/ 是/ 建立/ 模型/ 的/ 时间/ )/ 、/ 空间/ 效率/ 以及/ 分类/ 效果/ 的/ 影响/ ./ 第二/ 部分/ ,/ 选择/ 第一/ 部分/ 得到/ 的/ 最优/ t/ ,/ 通过/ 分类/ 不同/ 数据/ 集/ ,/ 对比/ 分析/ 传统/ 的/ 随机/ 森林/ 算法/ RF/ ,/ 采用/ 改进/ 策略/ 2/ 的/ 离散/ 化/ 随机/ 森林/ DRF/ 算法/ ,/ 采用/ 改进/ 策略/ 3/ 的/ 弱/ 相关/ 化/ 随机/ 森林/ WRF/ 算法/ 以及/ 结合/ 两者/ 的/ 离散/ 弱/ 相关/ 决策/ 森林/ DWDF/ 算法/ 的/ 分类/ 效果/ ./ 本/ 实验/ 首先/ 分别/ 从/ 填补/ 后/ 的/ FX1/ ~/ FX4/ 数据/ 集/ 抽取/ 70/ %/ 做/ 为/ 训练/ 集/ ,/ 余下/ 的/ 30/ %/ 作为/ 测试/ 集/ ./ 然后/ 分别/ 随机/ 建立/ 分类/ 模型/ ./ 根据/ 决策/ 森林/ 的/ 改进/ 策略/ 1/ ,/ 决策树/ 最优/ 个数/ 为/ 24/ (/ 本/ 实验/ 中/ node/ _/ num/ =/ 19/ ,/ re/ _/ num/ =/ 3/ ,/ attribute/ _/ num/ =/ 5/ ,/ λ/ =/ 16/ )/ ./ 建立/ 的/ 分类/ 中/ 决策树/ 个数/ 分别/ 取/ 6/ ,/ 12/ ,/ 18/ ,/ 24/ ,/ 30/ ,/ 36/ ./ 上述/ 每组/ 实验/ 均/ 测试/ 10/ 次/ ,/ 取/ 结果/ 的/ 平均值/ 作为/ 最终/ 实验/ 结果/ ./ 第一/ 部分/ 实验/ 结果/ 如图/ 7/ ~/ 图/ 9/ 所示/ ./ 通过/ 分析/ 图/ 7/ 中/ 的/ 实验/ 结果/ ,/ 可/ 看出/ 决策/ 森林/ 构建/ 时间/ 在/ 决策树/ 个数/ 小于/ 某一值/ (/ 在/ 上述/ 实验/ 中/ 某/ 一值/ 为/ 24/ )/ ./ 随/ 决策树/ 个数/ 的/ 增加/ ,/ 构建/ 决策/ 森林/ 的/ 时间/ 趋于稳定/ ,/ 但/ 当/ 决策树/ 个数/ 大于/ 某一值/ 时/ ,/ 随/ 决策树/ 个数/ 的/ 增加/ ,/ 构建/ 决策/ 森林/ 的/ 时间/ 直线/ 上升/ ./ 如/ 实验/ 结果/ 图/ 8/ 所示/ ,/ 决策/ 森林/ 结点/ 总/ 个数/ 随/ 决策树/ 个数/ 的/ 增加/ 而/ 增多/ ./ 如/ 实验/ 结果/ 图/ 9/ 所示/ ,/ 当/ 决策树/ 个数/ 小于/ 某一值/ (/ 在/ 上述/ 实验/ 中为/ 24/ )/ 时/ ,/ 分类/ 准确率/ 随其/ 个数/ 的/ 增加/ 而/ 上升/ ,/ 一旦/ 超过/ 了/ 该值/ ,/ 分类/ 准确率/ 下降/ ,/ 这是/ 由于/ 决策树/ 个数/ 过多/ ,/ 导致/ 决策/ 森林/ 的/ 过/ 拟合/ 所/ 造成/ 的/ ./ 因此/ 决策树/ 个数/ 取某/ 一值/ 时应/ 正/ 处于/ 分类/ 效率/ 、/ 时间/ 效率/ 和/ 空间/ 效率/ 的/ 平衡点/ ./ 第二/ 部分/ 实验/ 结果/ 如图/ 10/ 、/ 图/ 11/ 所示/ ./ Page14/ 图/ 10/ 和/ 图/ 11/ 中/ 的/ 实验/ 结果显示/ ,/ 对于/ 不同/ 规模/ 的/ 大/ 数据/ 集/ (/ 0.8/ GB/ ,/ 1.2/ GB/ ,/ 1.6/ GB/ ,/ 2GB/ )/ ,/ 本文/ 提出/ 的/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 算法/ DWDF/ 建立/ 的/ 分类/ 模型/ ,/ 比/ 随机/ 森林/ 算法/ RF/ ,/ 离散/ 化/ 随机/ 森林/ DRF/ 算法/ 和/ 弱/ 相关/ 化/ 随机/ 森林/ WRF/ 算法/ 生成/ 的/ 分类/ 模型/ ,/ 分类/ 准确率/ 和/ 可靠性/ 指数/ 都/ 要/ 高/ ./ 实验/ 3/ ./ 增量/ 更新/ 决策/ 森林/ 分类/ 模型/ ./ 图/ 12/ 不同/ 更新/ 模型/ 方法/ 分类/ 准确率/ 对比/ 本/ 实验/ 首先/ 分别/ 从/ 填补/ 后/ 的/ FX1/ ~/ FX4/ 数据/ 集/ 抽取/ 70/ %/ 作为/ 训练/ 集/ ,/ 余下/ 的/ 30/ %/ 作为/ 测试/ 集/ ./ 对/ FX1/ ~/ FX4/ 数据/ 集/ 分别/ 进行/ 分析/ ./ 以/ FX1/ 为例/ ,/ 每次/ 时间/ 戳/ 间隔/ 为/ 1h/ ,/ 从/ 该/ 时间段/ 内/ FX1/ 所在/ 数据中心/ 新/ 增加/ 的/ 数据/ 集/ DS/ _/ new/ 中/ 抽取/ 70/ %/ 数据/ 加入/ 训练/ 集/ ,/ 剩余/ 30/ %/ 加入/ 测试/ 集/ ,/ 分别/ 采用/ 不/ 更新/ NotUpdate/ (/ NU/ )/ ,/ 根据/ DS/ _/ new/ 数据/ 新建/ 决策/ 森林/ NewForest/ (/ NeF/ )/ ,/ 根据/ DS/ _/ new/ 数据/ 重建/ 决策/ 森林/ RebuildForest/ (/ ReF/ )/ ,/ 采用/ 增量/ 更新/ 算法/ (/ IUDF/ )/ 更新/ 模型/ 4/ 种/ 方式/ 处理/ ./ 按/ 相同/ 方法/ 分别/ 处理/ 填补/ 后/ 的/ FX1/ ~/ FX4/ ,/ 测试/ 3/ 种/ 不同/ 方式/ 的/ 分类/ 准确率/ 随/ 时间/ 的/ 变化/ ./ 上述/ 过程/ 中/ 每个/ 数据/ 集都/ 进行/ 10/ 次/ 分类/ 模型/ 的/ 建立/ ,/ 取其/ 分类/ 准确率/ 平均值/ 作为/ 最终/ 实验/ 结果/ ./ 由于/ 数据中心/ 处理/ 能耗/ 大/ 数据/ 的/ 虚拟/ 机会/ 随着/ 时间/ 的/ 推移/ 发生/ 迁移/ ,/ 因此/ 分类/ 模型/ 的/ 分类/ 准确性/ 会/ 随着/ 时间/ 的/ 推移/ 发生变化/ ./ 图/ 12/ (/ a/ )/ ~/ (/ d/ )/ 中/ 的/ NU/ 曲线/ 表明/ ,/ 根据/ 历史数据/ 建立/ 的/ 分类/ 模型/ 准确/ Page15/ 率会/ 不断/ 下降/ ./ NeF/ 曲线/ 表明/ ,/ 根据/ 新增/ 数据/ 集/ 建立/ 的/ 决策/ 森林/ 由于/ 未/ 考虑/ 历史数据/ 集/ FX/ ,/ 随着/ 时间/ 的/ 推移/ ,/ 分类/ 准确率/ 波动/ 很大/ ./ ReF/ 和/ IUDF/ 曲线/ 表明/ 重建/ 决策/ 森林/ 模型/ 和/ IUDF/ 算法/ 都/ 能/ 保证/ 决策/ 森林/ 具有/ 较/ 高/ 的/ 且/ 稳定/ 的/ 分类/ 准确率/ ,/ 而且/ 二者/ 差别/ 不大/ ./ 因此/ 对/ ReF/ 和/ IUDF/ 做/ 进一步/ 实验/ ,/ 比较/ 两者/ 的/ 决策/ 森林/ 结点/ 总/ 个数/ 和/ 其/ 平均/ 建模/ 时间/ ,/ 实验/ 结果/ 如图/ 13/ 和/ 图/ 14/ ,/ 表明/ ReF/ 需要/ 创建/ 的/ 结点/ 总/ 个数/ 和/ 更新/ 时间/ 明显/ 多于/ IUDF/ ./ 此外/ ,/ ReF/ 需要/ 持续保持/ 和/ 读入/ 全部/ 历史数据/ 不/ 适合/ 能耗/ 大/ 数据/ ,/ 而/ IUDF/ 只/ 需要/ 调整/ 根据/ 历史数据/ 建立/ 的/ 模型/ ,/ 其/ 具有/ 更好/ 的/ 扩展性/ ./ 图/ 13/ 不同/ 算法/ 对/ 决策/ 森林/ 结点/ 总/ 个数/ 的/ 影响/ 图/ 14/ 不同/ 算法/ 对/ 决策/ 森林/ 平均/ 构建/ 时间/ 的/ 影响/ 8/ 结论/ 语/ 绿色/ 数据中心/ ,/ 在/ 提供/ 高效/ 、/ 稳定/ 的/ 电能/ 供给/ 的/ 同时/ ,/ 也/ 能够/ 降低/ 能耗/ 、/ 保护环境/ 和/ 节省成本/ ,/ 这是/ 未来/ 数据中心/ 发展/ 的/ 必然趋势/ ./ 本文/ 根据/ 绿色/ 数据中心/ 能耗/ 大/ 数据/ 的/ 特点/ ,/ 针对/ 大规模/ 绿色/ 数据中心/ 的/ 能源/ 供给/ 相关/ 问题/ ,/ 提出/ 了/ 一种/ 数据中心/ 能耗/ 大/ 数据管理/ 模型/ :/ 提出/ 基于/ 完备/ 相容/ 类/ 的/ 不/ 完备/ 大/ 数据/ 填补/ 算法/ ,/ 保证/ 了/ 数据/ 的/ 完备/ 性/ ,/ 降低/ 了/ 数据/ 缺失/ 对/ 分类/ 的/ 影响/ ;/ 提出/ 了/ 基于/ 离散/ 弱/ 相关/ 的/ 决策/ 森林/ 分类/ 算法/ ,/ 对/ 数据中心/ 能耗/ 大/ 数据/ 并行/ 分类/ ,/ 用于/ 动态/ 调控/ 太阳能/ 和/ 市电/ 供电/ 端口/ ;/ 进一步/ 提出/ 了/ 增量/ 更新/ 决策/ 森林/ 模型/ 算法/ ,/ 使得/ 分类/ 模型/ 能/ 根据/ 实际/ 数据/ 的/ 变化/ 不断更新/ 模型/ ./ 本文/ 研究/ 通过/ 分析/ 和/ 处理/ 能耗/ 大/ 数据/ ,/ 有效/ 管理/ 太阳能/ 和/ 其他/ 资源/ 来/ 配合/ 市/ 电/ 提供/ 稳定/ 且/ 充足/ 的/ 电能/ 供应/ ,/ 为/ 数据中心/ 服务体系/ 提供/ 了/ 高效/ 的/ 能源/ 服务/ ./ 今后/ ,/ 将/ 进一步/ 全面/ 研究/ 绿色/ 数据中心/ 的/ 能耗/ 评估/ 体系/ 和/ 能源/ 服务/ 策略/ ./ 

