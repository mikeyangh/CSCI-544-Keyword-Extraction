Page1/ 三维/ 面心/ 立方/ 网格/ 下/ 的/ 直线/ 生成/ 算法/ 何丽君/ 1/ )/ ,/ 2/ )/ 刘勇奎/ 2/ )/ 孙世昶/ 2/ )/ 1/ )/ (/ 大连理工大学/ 数学/ 科学/ 学院/ 大连/ 116024/ )/ 2/ )/ (/ 大连/ 民族/ 学院/ 计算机科学/ 与/ 工程学院/ 大连/ 116600/ )/ 摘要/ 以/ 菱形/ 十二面/ 体为/ 体素/ 构成/ 的/ 三维/ 面心/ 立方/ (/ Face/ -/ CenteredCubic/ ,/ FCC/ )/ 网格/ 是/ 六角/ 网格/ 在/ 三维/ 的/ 一种/ 推广/ ,/ 直线/ 生成/ 算法/ 在/ 三维/ 图形/ 和/ 图像/ 应用/ 中是/ 一个/ 非常/ 重要/ 和/ 基础/ 的/ 算法/ ./ 文中/ 首先/ 研究/ 了/ 二维/ 六角/ 网格/ 下/ 基于/ 附属/ 菱形/ 空间/ 的/ 直线/ 生成/ 算法/ ,/ 然后/ 将/ 其/ 推广/ 至/ 三维/ FCC/ 网格/ ,/ 得到/ 了/ 一种/ FCC/ 网格/ 下/ 的/ 直线/ 生成/ 算法/ ,/ 该/ 算法/ 在/ 三维/ 方形/ 网格/ 下/ 的/ Bresenham/ 算法/ 的/ 基础/ 上/ ,/ 利用/ 附属/ 平行六面/ 体/ 空间/ 的/ 平行六面/ 体/ 与/ FCC/ 网格/ 空间/ 的/ 体素/ 之间/ 的/ 一一对应/ 关系/ 生成/ 直线/ ./ 该/ 算法/ 应用/ 简单/ 的/ 判断/ 公式/ ,/ 一步/ 最多/ 可/ 生成/ 3/ 个体/ 素/ ,/ 且/ 只/ 涉及/ 到/ 整数/ 运算/ ,/ 因而/ 没有/ 累计/ 误差/ ./ 关键词/ 菱形/ 十二面/ 体/ ;/ 面心/ 立方/ 网格/ ;/ 算法/ ;/ 体素/ ;/ 直线/ 生成/ 1/ 引言/ 三维/ 直线/ 作为/ 计算机/ 图形学/ 中/ 基本/ 的/ 几何/ 元素/ ,/ 其/ 生成/ 算法/ 是/ 计算机/ 图形学/ 的/ 重要/ 基础/ ,/ 是/ 计算机/ 图形学/ 及/ CAD/ 最/ 基本/ 的/ 算法/ 之一/ ,/ 是/ 数控机床/ 和/ 快速/ 成型机/ 控制系统/ 中/ 直线/ 插补/ 算法/ 的/ 数学/ 基础/ ./ 三维/ 直线/ 生成/ 算法/ 的/ 应用领域/ 包括/ 物体/ 的/ 真实感/ 显示/ 、/ 光线/ 追踪/ 、/ 医学/ 图像/ 的/ 三维重建/ 、/ 体/ 元素/ 绘制/ 、/ 计算机/ 视觉/ 以及/ 立体几何/ 造型/ ./ 直线/ 生成/ 算法/ 的/ 好坏/ 不仅/ 直接/ 影响/ 图形/ 生成/ 与/ 显示/ 的/ 效率/ ,/ 而且/ 与/ 数控/ 加工/ 和/ 快速/ 原型/ 制造/ 的/ 速度/ 和/ 精度/ 有/ 直接/ 的/ 关系/ ,/ 因此/ ,/ 研究/ 高效/ 、/ 高精度/ 的/ 直线/ 生成/ 算法/ ,/ 对于/ 开发/ 高性能/ 的/ 计算机/ 数控系统/ 具有/ 十分/ 重要/ 的/ 意义/ ./ 目前/ ,/ 已有/ 较/ 多/ 文献/ 讨论/ 了/ 三维/ 方形/ 网格/ 下/ 的/ 直线/ 生成/ 算法/ ,/ 分别/ 将/ 二维/ 直线/ 生成/ 中有/ 代表性/ 的/ 算法/ 等/ 推广/ 到/ 三维/ ./ 文献/ [/ 1/ -/ 2/ ]/ 在/ 二维/ 直线/ Bresenham/ 生成/ 算法/ 的/ 基础/ 上/ ,/ 利用/ 三维/ 直线/ 在/ 坐标/ 平面/ 内/ 的/ 投影/ ,/ 将/ 二维/ 直线/ Bresenham/ 算法/ 推广/ 到/ 三维/ ./ 文献/ [/ 3/ ]/ 通过/ 对/ 三维/ 直线/ 特性/ 的/ 分析/ ,/ 充分利用/ 直线/ 的/ 方向性/ 和/ 对称性/ ,/ 结合/ 投影/ 原理/ ,/ 提出/ 了/ 一种/ 基于/ 直线/ 特性/ 和/ 投影/ 原理/ 的/ 三维/ 直线/ 生成/ 算法/ ./ 文献/ [/ 4/ ]/ 利用/ 直线/ 在/ 两个/ 坐标/ 平面/ 内/ 的/ 投影/ ,/ 将/ 二维/ 中/ 点画/ 线/ 算法/ 推广/ 到/ 三维/ ,/ 用于/ 三维空间/ 直线/ 的/ 生成/ ./ 文献/ [/ 5/ ]/ 利用/ 整数/ 运算/ 来/ 生成/ 面/ 连接体/ 素/ 序列/ ,/ 实现/ 了/ 顶点/ 连接/ 到面/ 连接/ 之间/ 的/ 转换/ ./ 除了/ 常见/ 的/ 方形/ 网/ 格外/ ,/ 其它/ 的/ 网格/ 也/ 受到/ 人们/ 的/ 关注/ ./ 体素/ 为/ 六/ 棱柱/ 构成/ 的/ 无/ 通道/ (/ tunnel/ -/ free/ )/ 三维/ 网格/ 有/ 两种/ [/ 6/ ]/ ,/ 体素/ 为/ 菱形/ 十二面/ 体和截/ 八面体/ 构成/ 的/ 三维/ 网格/ 分别/ 称为/ 面心/ 立方/ (/ Face/ -/ CenteredCubic/ ,/ FCC/ )/ 网格/ 和/ 体心/ 立方/ (/ Body/ -/ CenteredCubic/ ,/ BCC/ )/ 网格/ ,/ FCC/ 网格/ 和/ BCC/ 网格/ 是/ 二维/ 六角/ 网格/ 在/ 三维/ 的/ 推广/ ./ 与/ 六角/ 网格/ 类似/ ,/ FCC/ 网格/ 和/ BCC/ 网格/ 上/ 的/ 体素/ 分布/ 比/ 立方/ 网格/ 更加/ 紧凑/ 和/ 合理/ ,/ 在/ 三维空间/ 具有/ 更好/ 的/ 采样/ 性质/ ./ 在/ 不/ 影响/ 体/ 数据/ 质量/ 的/ 前提/ 下/ ,/ FCC/ 网格/ 将/ 采样/ 数据/ 密度/ 变为/ 立方/ 网格/ 的/ 76.98/ %/ ,/ 即/ FCC/ 网格/ 能比/ 立方/ 网格/ 减少/ 23.02/ %/ 的/ 体/ 数据量/ [/ 7/ ]/ ./ 因此/ ,/ 最近/ 很多/ 研究/ 人员/ 关注/ FCC/ 网格/ [/ 8/ -/ 11/ ]/ ,/ 总结/ 了/ FCC/ 网格/ 的/ 性质/ 和/ 优点/ [/ 12/ ]/ ;/ 提出/ 了/ 类似/ 于/ 步进/ 立方体/ (/ MarchingCubes/ )/ 算法/ 的/ FCC/ 网格/ 表面/ 绘制/ 重建/ 算法/ [/ 13/ ]/ ,/ 来/ 进行/ FCC/ 网格/ 体/ 数据/ 场/ 等值/ 面/ 生成/ 和/ 绘制/ ;/ 研究/ 了/ FCC/ 网格/ 的/ 一般/ 情形/ (/ 平行/ 十二面/ 体/ 网格/ )/ 的/ 快速/ 离散/ 傅立叶/ 变换/ 及其/ 并行算法/ [/ 14/ ]/ ;/ 构造/ 了/ FCC/ 网格/ 的/ 箱/ 样条/ [/ 15/ ]/ ./ 这些/ 研究/ 说明/ FCC/ 网格/ 因/ 其/ 良好/ 的/ 采样/ 性质/ 将/ 在/ 三维/ 计算机/ 图形学/ 及/ CAD/ 中/ 具有/ 较/ 好/ 的/ 应用/ 前景/ ./ 然而/ ,/ 很少/ 有人/ 研究/ 作为/ FCC/ 网格/ 的/ 基础/ 算法/ 之一/ 的/ 直线/ 生成/ 算法/ ./ 本文/ 则/ 提出/ 了/ FCC/ 网格/ 下/ 的/ 直线/ 生成/ 算法/ ./ 该/ 算法/ 建立/ 在/ 三维/ Bresenham/ 算法/ 和/ 附属/ 平行六面/ 体/ 的/ 基础/ 之上/ ,/ 只用/ 整数/ 运算/ ,/ 从而/ 消除/ 累积/ 误差/ 并/ 提高/ 算法/ 速度/ ./ 该/ 算法/ 为/ 基于/ FCC/ 网格/ 的/ 真实感/ 显示/ 、/ 体/ 绘制/ 、/ 光线/ 追踪/ 、/ 消除/ 隐藏/ 线面/ 及/ 三维重建/ 等/ 技术/ 提供/ 了/ 基础/ ./ 2/ 二维/ 六角/ 网格/ 六角/ 网格/ 理论/ 上/ 优于/ 方形/ 网格/ ,/ 主要/ 原因/ 在于/ 方形/ 网格/ 上/ 除了/ 4/ 个边/ 相邻/ 像素/ 外/ ,/ 还有/ 4/ 个点/ 相邻/ 像素/ ,/ 而/ 在/ 六角/ 网格/ 上/ ,/ 每个/ 像素/ 的/ 6/ 个/ 相邻/ 像素/ 都/ 是/ 边/ 相邻/ 的/ ,/ 因而/ 六角/ 网格/ 直线/ 或/ 曲线/ 更/ 平滑/ ;/ 同时/ ,/ 六角/ 网格/ 上/ 的/ 像素/ 分布/ 更加/ 紧凑/ 和/ 合理/ ,/ 因而/ 可以/ 更好/ 地/ 表示/ 图形/ 与/ 图像/ 的/ 细节/ ./ 文献/ [/ 16/ ]/ 证明/ 了/ 方形/ 网格/ 和/ 六角/ 网格/ 在/ 几何/ 意义/ 上/ 是/ 相似/ 的/ ,/ 并且/ 比较/ 了/ 两种/ 网格/ 上/ 的/ 绘制/ 直线/ 和/ 圆/ 的/ 算法/ ./ 文献/ [/ 17/ ]/ 提出/ 了/ 一种/ 在/ 六角/ 网格/ 上/ 的/ 直线/ 生成/ 算法/ ./ 本节/ 提出/ 了/ 一种/ 六角/ 网格/ 上/ 的/ 直线/ 生成/ 算法/ ./ 首先/ ,/ 介绍/ 了/ 六角/ 网格/ 坐标/ 系统/ 附属/ 的/ 菱形/ 空间/ 并/ 分析/ 了/ 它们/ 之间/ 的/ 邻接/ 关系/ ,/ 利用/ 它们/ 之间/ 的/ 一一对应/ 关系/ 和/ Bresenham/ 算法/ ,/ 建立/ 了/ 一个/ 有效/ 的/ 六角/ 网格/ 直线/ 生成/ 算法/ ./ 2.1/ 六角/ 网格/ 空间/ 及其/ 附属/ 菱形/ 空间/ 正/ 六边形/ 可以/ 覆盖/ 整个/ 二维/ 空间/ (/ 即/ 平面/ )/ ,/ 在/ 六角/ 网格/ 上/ 每个/ 像素/ 对应/ 于/ 一个/ 正/ 六边形/ ,/ 而/ 将/ 正/ 六边形/ 的/ 中心/ 称为/ 网格/ 点/ ./ 所有/ 像素/ 构成/ 了/ 一个/ 数字/ 六角/ 网格/ 空间/ ./ 记/ h/ (/ x/ ,/ y/ )/ 为/ 中心/ 在/ 点/ (/ x/ ,/ y/ )/ 的/ 像素/ ./ Brimkov/ 和/ Barneva/ [/ 6/ ]/ 创建/ 了/ 六角/ 网格/ 空间/ 的/ 附属/ 菱形/ 空间/ ./ 对/ 每个/ 六角/ 网格/ 像素/ h/ (/ x/ ,/ y/ )/ ,/ 其/ 相应/ 的/ 附属/ 菱形/ r/ (/ x/ ,/ y/ )/ 按/ 如下/ 方法/ 生成/ :/ 菱形/ 的/ 中心/ 和/ 像素/ h/ (/ x/ ,/ y/ )/ 的/ 中心/ 相同/ ,/ 菱形/ 边/ 与/ 六角/ 网格/ 空间/ 的/ 单位/ 基/ 向量/ 相等/ (/ 图/ 1/ )/ ./ 这样一来/ ,/ 附属/ 菱形/ 空间/ 和/ 六角/ 网格/ 空间/ 具有/ 相同/ 的/ 中心/ 和/ 基/ 向量/ ./ 图/ 1/ 六角/ 网格/ 像素/ h/ (/ x/ ,/ y/ )/ 及其/ 相应/ 的/ 菱形/ r/ (/ x/ ,/ y/ )/ Page3/ 按/ 上述/ 方法/ 建立/ 的/ 菱形/ 空间/ 中/ ,/ 每个/ 菱形/ r/ (/ i/ ,/ j/ )/ 有/ 8/ 个/ 相邻/ 菱形/ ,/ 其中/ 4/ 个/ 菱形/ (/ r/ (/ i/ +/ 1/ ,/ j/ )/ ,/ r/ (/ i/ ,/ j/ +/ 1/ )/ ,/ r/ (/ i/ -/ 1/ ,/ j/ )/ 和/ r/ (/ i/ ,/ j/ -/ 1/ )/ )/ 与/ r/ (/ i/ ,/ j/ )/ 边/ 相邻/ ,/ 相应/ 的/ 六角/ 网格/ 像素/ (/ h/ (/ i/ +/ 1/ ,/ j/ )/ ,/ h/ (/ i/ ,/ j/ +/ 1/ )/ ,/ h/ (/ i/ -/ 1/ ,/ j/ )/ 和/ h/ (/ i/ ,/ j/ -/ 1/ )/ )/ 也/ 与/ h/ (/ i/ ,/ j/ )/ 边/ 相邻/ ./ 另外/ 4/ 个/ 菱形/ (/ r/ (/ i/ +/ 1/ ,/ j/ +/ 1/ )/ ,/ r/ (/ i/ -/ 1/ ,/ j/ +/ 1/ )/ ,/ r/ (/ i/ -/ 1/ ,/ j/ -/ 1/ )/ 和/ r/ (/ i/ +/ 1/ ,/ j/ -/ 1/ )/ )/ 与/ r/ (/ i/ ,/ j/ )/ 点/ 相邻/ ,/ 此时/ 相应/ 的/ 六角/ 网格/ 像素/ 有/ 两种/ 情形/ :/ h/ (/ i/ +/ 1/ ,/ j/ +/ 1/ )/ ,/ h/ (/ i/ -/ 1/ ,/ j/ -/ 1/ )/ 与/ h/ (/ i/ ,/ j/ )/ 边/ 相邻/ ;/ h/ (/ i/ +/ 1/ ,/ j/ -/ 1/ )/ ,/ h/ (/ i/ -/ 1/ ,/ j/ +/ 1/ )/ 与/ h/ (/ i/ ,/ j/ )/ 不/ 相邻/ ./ 表/ 1/ 中/ 列出/ 了/ 它们/ 的/ 相邻/ 关系/ ./ 相邻/ 的/ 坐标/ 对/ (/ i/ ,/ j/ )/ 和/ (/ i/ +/ 1/ ,/ j/ )/ 边/ 相邻/ 边/ 相邻/ (/ i/ ,/ j/ )/ 和/ (/ i/ ,/ j/ +/ 1/ )/ 边/ 相邻/ 边/ 相邻/ (/ i/ ,/ j/ )/ 和/ (/ i/ +/ 1/ ,/ j/ -/ 1/ )/ 点/ 相邻/ 边/ 相邻/ (/ i/ ,/ j/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ )/ 点/ 相邻/ 不/ 相邻/ 2.2/ 六角/ 网格/ 上/ 的/ 直线/ 生成/ 算法/ 假设/ 直线/ 起点/ 和/ 终点/ 的/ 六角/ 网格/ 坐标/ 分别/ 为/ (/ x1/ ,/ y1/ )/ 和/ (/ x2/ ,/ y2/ )/ ,/ 则/ (/ x1/ ,/ y1/ )/ 和/ (/ x2/ ,/ y2/ )/ 同时/ 也/ 是/ 两点/ 的/ 相应/ 菱形/ 坐标/ ./ 记/ Δ/ x/ =/ |/ x2/ -/ x1/ |/ ,/ Δ/ y/ =/ |/ y2/ -/ y1/ |/ ,/ xsign/ =/ SIGN/ (/ x2/ -/ x1/ )/ ,/ ysign/ =/ SIGN/ (/ y2/ -/ y1/ )/ ./ 为/ 简便/ 起/ 见/ ,/ 我们/ 这里/ 假设/ Δ/ x/ >/ Δ/ y/ ,/ 即/ 直线/ 的/ 斜率/ 的/ 绝对值/ 在/ 0/ 与/ 1/ 之间/ ,/ 此时/ x/ 为主/ 坐标轴/ ,/ x/ 值/ 每/ 一步/ 都/ 递增/ (/ 或/ 递减/ )/ ,/ y/ 值/ 是否/ 递增/ (/ 或/ 递减/ )/ 由/ Bresenham/ 误差/ 变量/ eyx/ =/ 2/ Δ/ x/ (/ dxy/ -/ 0.5/ )/ 决定/ (/ 图/ 2/ )/ ,/ 变量/ eyx/ 的/ 初始化/ 公式/ 为/ eyx/ =/ 2/ Δ/ y/ -/ Δ/ x/ ./ 假设/ 当前/ 已/ 选择/ 的/ 离/ 直线/ 最近/ 的/ 菱形/ 记为/ r/ (/ x/ ,/ y/ )/ ,/ 则/ 下/ 一步/ 可选/ 的/ 菱形/ 有/ 两种/ 选择/ :/ r/ (/ x/ +/ xsign/ ,/ y/ )/ 或/ r/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ (/ 图/ 2/ 中为/ xsign/ =/ ysign/ =/ 1/ )/ ,/ 由/ eyx/ 的/ 符号/ 决定/ 究竟/ 选择/ 上述/ 两个/ 菱形/ 中/ 的/ 哪/ 一个/ ./ 图/ 2/ 平行四边形/ 网格/ 下/ 的/ Bresenham/ 算法/ 示意图/ 若/ eyx/ </ 0/ ,/ 则/ 右方/ 菱形/ r/ (/ x/ +/ xsign/ ,/ y/ )/ 与/ 直线/ 上/ 理想/ 位置/ 更/ 接近/ ,/ 应/ 取/ 右方/ 菱形/ ,/ 同时/ 变量/ eyx/ 递增/ 为/ eyx/ =/ eyx/ +/ 2/ Δ/ y/ ./ 由于/ 相应/ 的/ 六角/ 网格/ 像素/ h/ (/ x/ +/ xsign/ ,/ y/ )/ 与/ h/ (/ x/ ,/ y/ )/ 为边/ 相邻/ ,/ 故/ 六角/ 网格/ 上/ 的/ 下/ 一/ 像素/ 即为/ h/ (/ x/ +/ xsign/ ,/ y/ )/ ./ 若/ eyx/ / 0/ ,/ 则/ 右上方/ 菱形/ r/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ 与/ 直线/ 上/ 理想/ 位置/ 更/ 接近/ ,/ 应/ 取/ 右上方/ 菱形/ ,/ 同时/ 变量/ eyx/ 递增/ 为/ eyx/ =/ eyx/ +/ 2/ (/ Δ/ y/ -/ Δ/ x/ )/ ./ 此时/ 需要/ 分/ 情况/ 处理/ :/ (/ 1/ )/ 若/ 相邻/ 的/ 坐标/ 对/ 形如/ (/ i/ ,/ j/ )/ 和/ (/ i/ +/ 1/ ,/ j/ -/ 1/ )/ ,/ 相应/ 的/ 六角/ 网格/ 像素/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ 与/ h/ (/ x/ ,/ y/ )/ 边/ 相邻/ ,/ 故/ 六角/ 网格/ 上/ 的/ 下/ 一/ 像素/ 即为/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ ./ (/ 2/ )/ 若/ 相邻/ 的/ 坐标/ 对/ 形如/ (/ i/ ,/ j/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ )/ ,/ 相应/ 的/ 六角/ 网格/ 像素/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ 与/ h/ (/ x/ ,/ y/ )/ 不/ 相邻/ ,/ 需要/ 增加/ 一个/ 像素/ 来/ 连接/ 这/ 两个/ 断开/ 的/ 像素/ ./ 从/ h/ (/ x/ ,/ y/ )/ 到/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ 有/ 2/ 条/ 可能/ 路径/ :/ h/ (/ x/ ,/ y/ )/ ,/ h/ (/ x/ ,/ y/ +/ ysign/ )/ 到/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ 或/ h/ (/ x/ ,/ y/ )/ ,/ h/ (/ x/ +/ xsign/ ,/ y/ )/ 到/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ ./ 究竟/ 如何/ 选择/ 呢/ ?/ 从图/ 2/ 中/ 可以/ 看出/ ,/ 只要/ 判断/ 直线/ 在/ 点/ B/ 上方/ 或/ 下方/ 即可/ ./ 也/ 就是/ 判断/ tyx/ 是否/ 大于/ 1/ // 2/ ./ 注意/ 到/ tyx/ -/ 1dyx/ -/ h/ -/ 1/ 且/ Δ/ x/ 大于/ 0/ ,/ 则/ 问题/ 归结为/ 比较/ eyx/ 和/ Δ/ y/ 的/ 大小/ ,/ 若/ eyx/ </ Δ/ y/ ,/ 则/ 接下来/ 的/ 两个/ 像素/ 分别/ 为/ h/ (/ x/ +/ xsign/ ,/ y/ )/ 和/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ ,/ 见图/ 3/ (/ a/ )/ ;/ 否则/ eyx/ / Δ/ y/ ,/ 接下来/ 的/ 两个/ 像素/ 分别/ 为/ h/ (/ x/ ,/ y/ +/ ysign/ )/ 和/ h/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ )/ ,/ 见图/ 3/ (/ b/ )/ ./ 图/ 3/ 连接/ 两个/ 不/ 相邻/ 像素/ h/ (/ x/ ,/ y/ )/ 和/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ )/ 的/ 像素/ 若/ 直线/ 斜率/ 绝对值/ 大于/ 1/ (/ 即/ Δ/ y/ >/ Δ/ x/ )/ ,/ 则/ y/ 值/ Page4/ 每/ 一步/ 总是/ 递增/ (/ 或/ 递减/ )/ ,/ x/ 值/ 是否/ 递增/ (/ 或/ 递减/ )/ 由/ Bresenham/ 误差/ 变量/ eyx/ 决定/ ./ 2.3/ 算法/ 分析/ 与/ Bresenham/ 算法/ 一样/ ,/ 本/ 算法/ 只/ 涉及/ 到/ 整数/ 运算/ ,/ 只用/ 到/ 整数/ 的/ 加法/ 、/ 减法/ 、/ 移位/ (/ 所有/ 乘/ 2/ 用/ 左移/ 运算/ 完成/ )/ 和/ 比较/ 运算/ ./ 本/ 算法/ 在/ 一步/ 循环/ 中/ 可能/ 生成/ 1/ 或/ 2/ 个/ 像素/ ,/ 具体/ 的/ 操作/ 次数/ 见表/ 2/ ./ 该表中/ 的/ 计算/ 量/ 不/ 包括/ x/ 和/ y/ 坐标值/ 的/ 操作/ ,/ 因为/ 这些/ 操作/ 在/ 任何/ 直线/ 生成/ 算法/ 中/ 都/ 是/ 一样/ 的/ ,/ 但/ 其中/ 的/ 计算/ 量/ 包括/ 循环/ 语句/ 本身/ 的/ 一次/ 比较/ 和/ 一次/ 加减法/ 操作/ ./ 同时/ ,/ 我们/ 只/ 考虑/ 了/ 算法/ 循环/ 体内/ 的/ 操作/ ,/ 因为/ 循环/ 体外/ 的/ 操作/ 只/ 执行/ 一次/ ,/ 对/ 算法/ 速度/ 影响/ 不大/ ./ 操作/ 类型/ 一步/ 形成/ 1/ 个/ 像素/ 一步/ 形成/ 2/ 个/ 像素/ 加法/ 比较/ 3FCC/ (/ Face/ -/ CenteredCubic/ )/ 网格/ 及其/ 坐标/ 系统/ 由/ 菱形/ 十二面/ 体为/ 体素/ 构成/ 的/ 三维/ 网格/ 称为/ 面心/ 立方/ (/ Face/ -/ CenteredCubic/ ,/ FCC/ )/ 网格/ ./ 菱形/ 十二面/ 体由/ 12/ 个/ 全/ 等/ 的/ 菱形/ 构成/ ,/ 共有/ 14/ 个/ 顶点/ ,/ 其中/ 8/ 个/ 顶点/ 的/ 度/ 为/ 3/ ,/ 6/ 个/ 顶点/ 的/ 度/ 为/ 4/ ./ 菱形/ 十二面/ 体可/ 由/ 下述/ 方法/ 构造/ :/ 取/ 两个/ 相同/ 的/ 立方体/ ,/ 立方体/ 表面/ 为/ 深灰色/ ,/ 内部/ 为/ 浅/ 灰色/ ,/ 将/ 其中/ 一个/ 立方体/ 分割/ 成/ 6/ 个/ 如图/ 4/ (/ a/ )/ 所示/ 相同/ 的/ 四/ 棱锥/ ,/ 然后/ 将/ 这/ 6/ 个/ 四/ 棱锥/ 的/ 四边形/ 粘帖/ 到/ 另/ 一个/ 立方体/ 的/ 6/ 个/ 面上/ ,/ 见图/ 4/ (/ b/ )/ ,/ 即/ 形成/ 如图/ 4/ (/ c/ )/ 所示/ 的/ 菱形/ 十二面/ 体/ ,/ 此/ 菱形/ 十二面/ 体/ 的/ 6/ 个度/ 为/ 4/ 的/ 顶点/ 恰好/ 是/ 四/ 棱锥/ 的/ 顶点/ ,/ 度为/ 3/ 的/ 8/ 个/ 顶点/ 则/ 是/ 原/ 立方体/ 的/ 8/ 个/ 顶点/ ./ 对于/ 6/ 个/ 相同/ 的/ 菱形/ 十二面/ 体/ ,/ 各取/ 其/ 1/ 个度/ 为/ 4/ 的/ 顶点/ 如/ 切割/ 时/ 相对/ ,/ 则/ 正好/ 可以/ 无缝/ 连接/ ,/ 于是/ 可以/ 铺满/ 整个/ 三维空间/ ./ FCC/ 网格/ 是/ 二维/ 六角/ 网格/ 在/ 三维/ 的/ 一种/ 推广/ ,/ 它/ 与/ 方形/ 网格/ 相比/ 具有/ 如下/ 优点/ :/ (/ 1/ )/ 在/ FCC/ 网格/ 上/ ,/ 每个/ 体素/ 只/ 有点/ 相邻/ 和面/ 相邻/ 两种/ 相邻/ 关系/ ,/ 而/ 方形/ 网格/ 除了/ 点/ 相邻/ 和面/ 相邻/ 外/ ,/ 还有/ 边/ 相邻/ ,/ 因此/ ,/ 在/ FCC/ 网格/ 上/ ,/ 为/ 许多/ 图像处理/ 算法/ 提供/ 了/ 更加/ 简便/ 的/ 实现/ 途径/ ,/ 并/ 提高/ 了/ 算法/ 的/ 效率/ ./ 有/ 更好/ 的/ 近似/ 效果/ ./ 格上/ 曲线/ 或/ 曲面/ 更/ 平滑/ [/ 9/ ]/ ./ (/ 2/ )/ FCC/ 网格/ 的/ 误差/ 小于/ 方形/ 网格/ [/ 12/ ]/ ./ 从而/ 具/ (/ 3/ )/ FCC/ 网格/ 的/ 体素点/ 分布/ 更加/ 合理/ 和/ 紧凑/ [/ 18/ ]/ ./ FCC/ 网格/ 在/ 3D/ 空间/ 比/ 方形/ 网格/ 具有/ 更好/ 的/ 采样/ 性质/ ./ 也就是说/ ,/ 对于/ 三维/ 信号/ ,/ 需要/ 较少/ 的/ 采样/ 点/ 就/ 可以/ 完全/ 重构/ 信号/ ./ 从而/ 可以/ 节约/ 内存空间/ ,/ 提高/ 体/ 绘制/ 速度/ ./ (/ 4/ )/ FCC/ 网格/ 的/ 体素/ 更/ 接近/ 球面/ ,/ 从而/ FCC/ 网/ (/ 5/ )/ FCC/ 网格/ 更/ 经济/ ./ 即/ 在/ 体积/ 相同/ 的/ 条件/ 下/ ,/ FCC/ 网格/ 的/ 表面积/ 要/ 小于/ 方形/ 网格/ ./ 与/ 传统/ 的/ 方形/ 网格/ 不同/ ,/ 菱形/ 十二面/ 体/ 构成/ 的/ 离散/ 空间/ 中/ 只/ 存在/ 点/ 相邻/ 和面/ 相邻/ ,/ 不/ 存在/ 边/ 相邻/ 的/ 情形/ ./ 我们/ 按/ 如下/ 方法/ 构造/ FCC/ 坐标/ 系统/ :/ 选取/ 一个/ 体素/ 中心/ 定义/ 为/ 坐标/ 原点/ O/ ,/ 坐标/ 原点/ O/ 的/ 所有/ 坐标值/ 为/ 0/ ,/ 即/ O/ =/ (/ 0/ ,/ 0/ ,/ 0/ )/ ./ 然后/ 确定/ 3/ 个/ 坐标轴/ ,/ 考虑/ 坐标/ 原点/ 体素/ (/ 菱形/ 十二面/ 体/ )/ 的/ 一个/ 有/ 3/ 个/ 相邻/ 面/ 的/ 顶点/ (/ 即度/ 为/ 3/ 的/ 顶点/ )/ ,/ 过/ 原点/ 且/ 分别/ 垂直于/ 这/ 3/ 个/ 相邻/ 面/ 的/ 直线/ 为/ 坐标轴/ Ox/ ,/ Oy/ 和/ Oz/ ./ 基/ 向量/ 狌/ ,/ 狏/ 和/ 狑/ 方向/ 分别/ 与/ 坐标轴/ Ox/ ,/ Oy/ 和/ Oz/ 相同/ ,/ 长度/ 为/ 从/ 坐标/ 原点/ 到/ 相邻/ 体素/ 中心/ ./ 4/ 附属/ 平行六面/ 体/ 空间/ 我们/ 可以/ 为/ 上/ 一节/ 的/ 离散/ FCC/ 空间/ 定义/ 相应/ 的/ 附属/ 平行六面/ 体/ 空间/ ./ FCC/ 空间/ 中/ 的/ 每个/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 都/ 对应/ 一个/ 平行六面/ 体/ p/ (/ x/ ,/ y/ ,/ z/ )/ ./ p/ (/ x/ ,/ y/ ,/ z/ )/ 称为/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 附属/ 平行六面/ 体/ ,/ 它们/ 具有/ 相同/ 的/ 中心/ ,/ 并且/ 平行六面/ 体/ p/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 边/ 为/ FCC/ 空间/ 的/ 基/ 向量/ 狌/ ,/ 狏/ 和/ 狑/ (/ 见图/ 5/ )/ ./ 按/ 这种/ 方法/ Page5/ 定义/ 的/ 附属/ 平行六面/ 体/ 空间/ 和/ FCC/ 空间/ 具有/ 相同/ 的/ 中心/ 和/ 基/ 向量/ ./ 下面/ 分析/ 构成/ FCC/ 空间/ 和/ 其/ 附属/ 平行六面/ 体/ 空间/ 的/ 体素/ 之间/ 的/ 关系/ ./ 记/ h/ (/ x/ ,/ y/ ,/ z/ )/ 为/ FCC/ 空间/ 的/ 体素且/ p/ (/ x/ ,/ y/ ,/ z/ )/ 为/ 与/ 之/ 对应/ 的/ 平行六面/ 体/ 空间/ 图/ 6/ 面/ 相邻/ 平行六面/ 体和面/ 相邻/ 体素/ 图/ 7/ 边/ 相邻/ 平行六面/ 体和面/ 相邻/ 体素/ 图/ 8/ 点/ 相邻/ 平行六面/ 体和点/ 相邻/ 体素/ 中/ 的/ 平行六面/ 体/ ./ 由图/ 6/ ~/ 10/ 我们/ 可以/ 得出/ 如下/ 结论/ :/ 平行六面/ 体/ p/ (/ i/ ,/ j/ ,/ k/ )/ 有/ 26/ 个/ 相邻/ 平行六面/ 体/ ,/ 其中/ 6/ 个/ 与/ p/ (/ i/ ,/ j/ ,/ k/ )/ 面/ 相邻/ ,/ 12/ 个/ 与/ p/ (/ i/ ,/ j/ ,/ k/ )/ 边/ 相邻/ ,/ 其余/ 8/ 个/ 与/ p/ (/ i/ ,/ j/ ,/ k/ )/ 点/ 相邻/ ./ 根据/ 对称性/ ,/ 相邻/ 的/ 两个/ 平行六面/ 体有/ 13/ 种/ 不同/ 的/ 坐标/ 对/ ,/ 分别/ 对应/ 于表/ 3/ 的/ 13/ 行/ ,/ 由表中/ 可以/ 看出/ ,/ 面/ 相邻/ 的/ 体素/ 坐标/ 对/ 有/ 6/ 种/ (/ 由于/ 对称性/ ,/ 对应/ 于/ 12/ 个面/ 相邻/ 体素/ )/ ,/ 点/ 相邻/ 体素/ 坐标/ 对/ 有/ 3/ 中/ (/ 由于/ 对称性/ ,/ 对应/ 于/ 6/ 个点/ 相邻/ 体素/ )/ ,/ 不/ 相邻/ 的/ 体素/ 坐标/ 对/ 有/ 4/ 种/ ,/ 其中/ 对应/ 于边/ 相邻/ 的/ 平行六面/ 体/ 3/ 种/ (/ 由于/ 对称性/ ,/ 对应/ 于/ 6/ 个边/ 相邻/ 平行六面/ 体/ )/ ,/ 点/ 相邻/ 的/ 平行六面/ 体/ 1/ 种/ (/ 由于/ 对称性/ ,/ 对应/ 于/ 2/ 个点/ 相邻/ 平行六面/ 体/ )/ ./ Page6/ 图/ 9/ 边/ 相邻/ 平行六面/ 体/ 和/ 不/ 相邻/ 体素/ 图/ 10/ 点/ 相邻/ 平行六面/ 体/ 和/ 不/ 相邻/ 体素/ ,/ 形/ 如/ (/ i/ ,/ j/ ,/ k/ )/ 表/ 3FCC/ 网格/ 体素/ 及其/ 对应/ 的/ 平行六面/ 体/ 空间/ 相邻/ 的/ 坐标/ 对/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ ,/ k/ )/ 面/ 相邻/ 面/ 相邻/ 图/ 6/ (/ a/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ ,/ j/ +/ 1/ ,/ k/ )/ 面/ 相邻/ 面/ 相邻/ 图/ 6/ (/ b/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ ,/ j/ ,/ k/ +/ 1/ )/ 面/ 相邻/ 面/ 相邻/ 图/ 6/ (/ c/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ ,/ k/ -/ 1/ )/ 边/ 相邻/ 面/ 相邻/ 图/ 7/ (/ a/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ -/ 1/ ,/ k/ )/ 边/ 相邻/ 面/ 相邻/ 图/ 7/ (/ b/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ ,/ j/ +/ 1/ ,/ k/ -/ 1/ )/ 边/ 相邻/ 面/ 相邻/ 图/ 7/ (/ c/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ -/ 1/ ,/ k/ -/ 1/ )/ 点/ 相邻/ 点/ 相邻/ 图/ 8/ (/ a/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ ,/ k/ -/ 1/ )/ 点/ 相邻/ 点/ 相邻/ 图/ 8/ (/ b/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ -/ 1/ ,/ k/ +/ 1/ )/ 点/ 相邻/ 点/ 相邻/ 图/ 8/ (/ c/ )/ 0/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ ,/ k/ +/ 1/ )/ 边/ 相邻/ 不/ 相邻/ 图/ 9/ (/ a/ )/ 1/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ ,/ j/ +/ 1/ ,/ k/ +/ 1/ )/ 边/ 相邻/ 不/ 相邻/ 图/ 9/ (/ b/ )/ 1/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ ,/ k/ )/ 边/ 相邻/ 不/ 相邻/ 图/ 9/ (/ c/ )/ 1/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ ,/ k/ +/ 1/ )/ 点/ 相邻/ 不/ 相邻/ 图/ 102/ 对于/ 体素/ 不/ 相邻/ 的/ 情形/ ,/ 需要/ 增加/ 体/ 素来/ 连接/ 这/ 两个/ 不/ 相邻/ 的/ 体素/ ./ 若/ 相应/ 的/ 两个/ 平行六面/ 体为/ 边/ 相邻/ 的/ 情形/ ,/ 需要/ 增加/ 1/ 个体/ 素来/ 连接体/ 素/ ,/ 则/ 由/ 2.2/ 节/ 的/ 二维/ 算法/ 的/ 简单/ 三维/ 扩展/ 就/ 可/ 解决/ FCC/ 网格/ 下体/ 素/ 的/ 选择/ 问题/ ,/ 即/ 由/ xy/ 平面/ 、/ xz/ 平面/ 或/ yz/ 平面/ 的/ 二维/ 算法/ 扩展/ 成/ 三维/ 算法/ ./ 若/ 相应/ 的/ 两个/ 平行六面/ 体为/ 点/ 相邻/ 的/ 情形/ ,/ 需要/ 增加/ 2/ 个体/ 素来/ 连接体/ 素/ ,/ 此时/ 坐标/ 对/ 为/ (/ i/ ,/ j/ ,/ k/ )/ 和/ (/ i/ +/ 1/ ,/ j/ +/ 1/ ,/ k/ +/ 1/ )/ ./ 注意/ 到/ 有/ 3/ 种/ 选择/ :/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ ,/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 和/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ 分别/ 对应/ 3/ 个/ 平行六面/ 体/ :/ p/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ ,/ p/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 和/ p/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ ./ 要/ 在/ 这/ 3/ 个/ 平行六面/ 体中/ 选取/ 一个/ 使/ 其/ 与/ 直线/ 的/ 距离/ 最小/ ,/ 我们/ 根据/ 判断/ 变量/ eyx/ 和/ ezx/ 的/ 大小/ 来/ 选择/ (/ eyx/ 和/ ezx/ 的/ 定义/ 和/ 递增/ 与/ 2.2/ 节/ 的/ 二维/ 算法/ 类似/ )/ ,/ 首先/ 在/ xy/ 平面/ 由/ eyx/ </ Δ/ y/ 是否/ 成立/ 决定/ y/ 是否/ 先/ 变化/ ,/ 然后/ 在/ xz/ 平面/ 由/ ezx/ </ Δ/ z/ 是否/ 成立/ 决定/ z/ 是否/ 先/ 变化/ ./ 根据/ eyx/ 和/ ezx/ 的/ 大小/ 有/ 以下/ 4/ 种/ 情形/ :/ (/ 1/ )/ 若/ eyx/ </ Δ/ y/ 且/ ezx/ </ Δ/ z/ ,/ 则/ 选取/ 平行六面/ 体/ p/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ (/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ )/ ./ (/ 2/ )/ 若/ eyx/ </ Δ/ y/ 且/ ezx/ / Δ/ z/ ,/ 则/ 选取/ 平行六面/ 体/ p/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ (/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ )/ ./ (/ 3/ )/ 若/ eyx/ / Δ/ y/ 且/ ezx/ </ Δ/ z/ ,/ 则/ 选取/ 平行六面/ 体/ p/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ (/ 体素/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ )/ ./ (/ 4/ )/ 若/ eyx/ / Δ/ y/ 且/ ezx/ / Δ/ z/ ,/ 则/ 选取/ 平行六面/ 体/ p/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 或/ p/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ (/ 体素/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 或/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ )/ ./ 首先/ 考虑/ 情形/ (/ 1/ )/ ,/ eyx/ </ Δ/ y/ 且/ ezx/ </ Δ/ z/ ,/ 则/ 选取/ 的/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ 与/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ 还/ 不/ 相邻/ ,/ 连接/ 它们/ 的/ 体素/ 可能/ 为/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ 或/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ ./ 通过/ 分析/ ,/ 我们/ 发现/ 变量/ ezy/ =/ ezx/ Δ/ y/ -/ eyx/ Δ/ z/ 的/ 符号/ 决定/ 了/ 该/ 选取/ 哪个/ 连接体/ 素/ :/ 若/ ezy/ 为/ 正/ ,/ 则/ 应/ 选取/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ 即体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ;/ 否则/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ./ 下面/ 说明/ 为什么/ 变量/ ezy/ 能/ 决定/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ 或/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ 的/ 选取/ ./ 图/ 11/ 画出/ 了/ yz/ 平面/ 在/ x/ =/ x/ +/ 1/ 处/ 的/ 情况/ ,/ 可以/ 看出/ ,/ 若/ 直线/ 在/ 点/ E/ 上方/ ,/ 即/ dzx/ +/ d/ >/ 1/ // 2/ ,/ 则/ 应/ 选取/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ 否则/ 应/ 选取/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ ./ 由图/ 11/ 看出/ ,/ d/ 可由/ 下式/ 计算/ :/ 这样/ 公式/ dzx/ +/ d/ >/ 1/ // 2/ 可写/ 为/ Page7/ 为/ 消除/ 浮点数/ 运算/ ,/ 下式/ 将/ dyx/ (/ 或/ dzx/ )/ 为/ 转换/ 为/ Bresenham/ 误差/ 变量/ eyx/ (/ 或/ ezx/ )/ :/ 将式/ (/ 2/ )/ 中/ 的/ dyx/ 和/ dzx/ 代入/ 式/ (/ 1/ )/ 得/ 2/ +/ ezx2/ Δ/ x/ +/ 11/ 即/ 由于/ Δ/ x/ 和/ Δ/ y/ 为/ 正数/ (/ 绝对值/ )/ ,/ 则/ 式/ (/ 3/ )/ 等价/ 于/ 于是/ 变量/ ezy/ 能/ 决定/ 体素/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ 或/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ 的/ 选取/ ./ 现在/ 考虑/ 情形/ (/ 2/ )/ ,/ eyx/ </ Δ/ y/ 且/ ezx/ / Δ/ z/ ,/ 则/ 选取/ 的/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ 与/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ 还/ 不/ 相邻/ ,/ 连接/ 它们/ 的/ 体素/ 可能/ 为/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ 或/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ,/ 但/ 由于/ eyx/ </ Δ/ y/ ,/ 只能/ 选取/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ ./ 于是/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ./ 现在/ 考虑/ 情形/ (/ 3/ )/ ,/ eyx/ / Δ/ y/ 且/ ezx/ </ Δ/ z/ ,/ 则/ 选取/ 的/ 体素/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 与/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ 还/ 不/ 相邻/ ,/ 连接/ 它们/ 的/ 体素/ 可能/ 为/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ 或/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ,/ 但/ 由于/ ezx/ </ Δ/ z/ ,/ 只能/ 选取/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ ./ 于是/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ./ 最后/ 考虑/ 情形/ (/ 4/ )/ ,/ eyx/ / Δ/ y/ 且/ ezx/ / Δ/ z/ ,/ 则/ 可能/ 选取/ 的/ 体素/ 为/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 或/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ 与/ 情形/ (/ 1/ )/ 的/ 分析/ 类似/ ,/ 我们/ 可以/ 在/ yz/ 平面/ 由/ ezy/ =/ ezx/ Δ/ y/ -/ eyx/ Δ/ z/ 的/ 符号/ 决定/ 应该/ 选取/ 哪/ 个体/ 素/ ./ 若/ ezy/ </ 0/ ,/ 则/ 应该/ 选取/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ 和/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ,/ 于是/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ )/ ,/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ./ 否则/ 若/ eyx/ / 0/ ,/ 体素/ h/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 紧接着/ 的/ 3/ 个体/ 素为/ h/ (/ x/ ,/ y/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ,/ h/ (/ x/ +/ 1/ ,/ y/ +/ 1/ ,/ z/ +/ 1/ )/ ./ 5FCC/ 网格/ 上/ 的/ 直线/ 生成/ 算法/ 假设/ 直线/ 的/ 起点/ 和/ 终点/ 的/ FCC/ 坐标/ 分别/ 为/ (/ x1/ ,/ y1/ ,/ z1/ )/ 和/ (/ x2/ ,/ y2/ ,/ z2/ )/ ,/ 则/ (/ x1/ ,/ y1/ ,/ z1/ )/ 和/ (/ x2/ ,/ y2/ ,/ z2/ )/ 同时/ 也/ 是/ 相应/ 点/ 的/ 平行六面/ 体/ 坐标/ ./ 令/ Δ/ x/ =/ |/ x2/ -/ x1/ |/ ,/ Δ/ y/ =/ |/ y2/ -/ y1/ |/ 和/ Δ/ z/ =/ |/ z2/ -/ z1/ |/ ,/ xsign/ =/ SIGN/ (/ x2/ -/ x1/ )/ ,/ ysign/ =/ SIGN/ (/ y2/ -/ y1/ )/ 和/ ysign/ =/ SIGN/ (/ z2/ -/ z1/ )/ ./ 为/ 简便/ 起/ 见/ ,/ 我们/ 这里/ 假设/ Δ/ x/ >/ Δ/ y/ 且/ Δ/ x/ >/ Δ/ z/ (/ 即/ x/ 轴/ 为主/ 坐标轴/ )/ ,/ 则/ x/ 值/ 每/ 一步/ 都/ 递增/ (/ 或/ 递减/ )/ ./ FCC/ 网格/ 上/ ,/ 两点/ (/ x1/ ,/ y1/ ,/ z1/ )/ 和/ (/ x2/ ,/ y2/ ,/ z2/ )/ 之间/ 的/ 直线/ 生成/ 算法/ 包括/ 如下/ 步骤/ :/ 1/ ./ 选取/ 起点/ (/ x1/ ,/ y1/ ,/ z1/ )/ 为/ 当前/ 体素/ (/ 也/ 是/ 当前/ 平行六面/ 体/ )/ ./ 2/ ./ 与/ 三维/ 方形/ 网格/ 直线/ 生成/ 算法/ Bresenham/ 算法/ 类似/ ,/ 在/ 平行六面/ 体/ 空间/ 决定/ 下/ 一步/ 所/ 选取/ 的/ 平行六面/ 体/ (/ 我们/ 将/ 在/ 下/ 一节/ 详细/ 说明/ 其/ 选取/ 方法/ )/ ./ 3/ ./ 根据/ 当前/ 平行六面/ 体/ 和/ 选取/ 的/ 下/ 一个/ 平行六面/ 体/ 的/ 相邻/ 关系/ 和/ 对应/ 体素/ 的/ 相邻/ 关系/ ,/ 采用/ 上/ 一节/ 的/ 方法/ 决定/ 是否/ 需要/ 增加/ 体素/ ./ 4/ ./ 若/ 还/ 没/ 到达/ 终点/ (/ x2/ ,/ y2/ ,/ z2/ )/ ,/ 则/ 转向/ 步/ 2/ ,/ 否则/ 算法/ 结束/ ./ 6/ 在/ 平行六面/ 体/ 空间/ 选择/ 下/ 一个/ 平行六面/ 体/ 为了/ 选择/ 下/ 一个/ 平行六面/ 体/ ,/ 我们/ 采用/ 与/ 三维/ 方形/ 网格/ 下/ Bresenham/ 算法/ 类似/ 的/ 方法/ ,/ 下面/ 将/ 说明/ 其/ 详细/ 过程/ ./ 由于/ 算法/ 在/ 平行六面/ 体/ 空间/ x/ 值/ 每/ 一步/ 都/ 递增/ (/ 或/ 递减/ )/ ,/ 因此/ 只要/ 决定/ 下/ 一/ 平行六面/ 体/ 的/ y/ 和/ z/ 坐标/ 是否/ 变化/ 即可/ ./ 假设/ 当前/ 平行六面/ 体为/ E/ =/ p/ (/ x/ ,/ y/ ,/ z/ )/ ,/ 则/ 下/ 一/ 平行六面/ 体/ 的/ 取法/ 只有/ 四种/ 可能/ 的/ 选择/ ,/ 即/ A/ =/ p/ (/ x/ +/ xsign/ ,/ y/ ,/ z/ )/ ,/ B/ =/ p/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ ,/ z/ )/ ,/ C/ =/ p/ (/ x/ +/ xsign/ ,/ y/ ,/ z/ +/ zsign/ )/ 和/ D/ =/ p/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ ,/ z/ +/ zsign/ )/ (/ 图/ 12/ )/ ./ 要/ 在/ 这/ 4/ 个/ 平行六面/ 体中/ 选取/ 一个/ 使/ 其/ 与/ 直线/ 的/ 距离/ 最小/ ,/ 我们/ 根据/ 判断/ 变量/ eyx/ 和/ ezx/ 的/ 符号/ 来/ 选择/ ./ 我们/ 分/ 两步/ 进行/ ,/ 首先/ 在/ xy/ 平面/ 由/ eyx/ 的/ 符号/ 决定/ y/ 是否/ 变化/ ,/ 然后/ 在/ xz/ 平面/ 由/ ezx/ 的/ 符号/ 决定/ z/ 是否/ 变化/ ./ 根据/ eyx/ 和/ ezx/ 的/ 符号/ 有/ 以下/ 4/ 种/ 情形/ :/ Page8/ (/ 1/ )/ 若/ eyx/ </ 0/ 且/ ezx/ </ 0/ ,/ 则/ 下/ 一/ 平行六面/ 体为/ (/ 2/ )/ 若/ eyx/ </ 0/ 且/ ezx/ / 0/ ,/ 则/ 下/ 一/ 平行六面/ 体为/ (/ 3/ )/ 若/ eyx/ / 0/ 且/ ezx/ </ 0/ ,/ 则/ 下/ 一/ 平行六面/ 体为/ (/ 4/ )/ 若/ eyx/ / 0/ 且/ ezx/ / 0/ ,/ 则/ 下/ 一/ 平行六面/ 体为/ p/ (/ x/ +/ xsign/ ,/ y/ ,/ z/ )/ ./ p/ (/ x/ +/ xsign/ ,/ y/ ,/ z/ +/ zsign/ )/ ./ p/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ ,/ z/ )/ ./ p/ (/ x/ +/ xsign/ ,/ y/ +/ ysign/ ,/ z/ +/ zsign/ )/ ./ 图/ 12/ 三维/ 平行六面/ 体/ 空间/ 的/ Bresenham/ 算法/ 示意图/ 7/ 算法/ 分析/ 与/ 实验/ 本/ 算法/ 只用/ 到/ 整数/ 运算/ ,/ 而且/ 除了/ 在/ 一步/ 生成/ 3/ 个体/ 素/ 的/ 时候/ 需要/ 2/ 次/ 整数/ 乘法/ 运算/ 外/ ,/ 其余/ 的/ 只用/ 到/ 整数/ 加法/ 、/ 减法/ 、/ 移位/ 、/ 比较/ 运算/ ./ 算法/ 主要/ 集中/ 在/ 第/ 2/ 步/ 和/ 第/ 3/ 步/ ,/ 这/ 两步/ 需要/ 重复/ N/ =/ Max/ (/ Δ/ x/ ,/ Δ/ y/ ,/ Δ/ z/ )/ 次/ ,/ 在/ 算法/ 第/ 2/ 步/ ,/ 需要/ 2/ 次/ 比较/ 和/ 2/ 次/ 加法/ 操作/ ,/ 在/ 算法/ 第/ 3/ 步/ ,/ 若/ 不/ 需要/ 增加/ 体素/ ,/ 即/ 一次/ 仅/ 生成/ 一个/ 体素/ 则/ 没有/ 任何/ 操作/ ;/ 若/ 需要/ 增加/ 1/ 个体/ 素/ ,/ 即/ 一步/ 生成/ 2/ 个体/ 素/ ,/ 则/ 第/ 3/ 步/ 需要/ 1/ 次/ 比较/ 操作/ ;/ 若/ 需要/ 增加/ 2/ 个体/ 素/ ,/ 即/ 一步/ 生成/ 3/ 个体/ 素/ ,/ 则/ 第/ 3/ 步/ 最/ 多/ 需要/ 2/ 次/ 比较/ 、/ 2/ 次/ 乘法/ 和/ 1/ 次/ 加法/ 运算/ 共/ 5/ 次/ 操作/ ./ 因此/ ,/ 本/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ N/ )/ ./ 我们/ 用/ VC6/ ./ 0/ 在/ Intel2/ ./ 53GHz/ 微机/ 上/ 编程/ 实现/ 了/ 本文/ 算法/ ./ 为了/ 测试/ 算法/ 的/ 速度/ ,/ 我们/ 在/ 面心/ 立方/ 网格/ 中/ 嵌入/ 一个/ 球面/ ,/ 随机/ 取/ 球面/ 上/ 的/ 点/ ,/ 连接/ 其/ 和/ 球心/ 得到/ 一条/ 直线/ ,/ 则/ 该/ 直线/ 即/ 为/ 球面/ 的/ 半径/ ,/ 通过/ 生成/ 这些/ 直线/ 得到/ 算法/ 的/ 执行/ 时间/ ./ 我们/ 通过/ 改变/ 球面/ 半径大小/ (/ 直线/ 长度/ )/ 和/ 直线/ 数目/ 得到/ 不同/ 组/ 数据/ ./ 表/ 4/ 列出/ 了/ 对于/ 不同/ 长度/ 和/ 数目/ 的/ 直线/ ,/ 本文/ 算法/ 的/ 执行/ 时间/ 比较/ ,/ 表中/ 所列/ 的/ 时间/ 是/ 执行/ 完整/ 的/ 算法/ 所/ 需/ 的/ 时间/ ,/ 即/ 包括/ 主/ 循环/ 体外/ 对/ 判断/ 变量/ 等/ 的/ 初值/ 和/ 增量/ 的/ 计算/ ./ 从表/ 4/ 可以/ 看出/ ,/ 随着/ 直线/ 长度/ 的/ 加大/ 和/ 直线/ 数目/ 的/ 增加/ ,/ 算法/ 执行/ 时间/ 逐步/ 增加/ ./ 表/ 4/ 本文/ 算法/ 生成/ 不同/ 长度/ 直线/ 所/ 需要/ 的/ 时间/ 长度/ 2000.3233/ ./ 26532.7884000/ ./ 4224.58043/ ./ 2856000.5425/ ./ 39753.2198000/ ./ 6566.38263/ ./ 45510000.7657/ ./ 42975.72612000/ ./ 8598.51385/ ./ 8888/ 结论/ 本文/ 提出/ 了/ 一个/ FCC/ 网格/ 下/ 的/ 三维/ 直线/ 生成/ 算法/ ,/ 该/ 算法/ 基于/ 三维/ Bresenham/ 算法/ 和/ 附属/ 平行六面/ 体/ 空间/ ,/ 在/ 每/ 一步/ 利用/ 判断/ 变量/ 找出/ 离/ 直线/ 最近/ 的/ 体素/ (/ 菱形/ 十二面/ 体/ )/ ./ 算法/ 的/ 每/ 一步/ 最多/ 可/ 生成/ 3/ 个体/ 素/ ./ 本文/ 算法/ 和/ 已有/ 的/ 三维/ 直线/ 生成/ 算法/ 相比/ ,/ 优点/ 在于/ 生成/ 的/ 直线/ 是/ 基于/ FCC/ 网格/ 的/ ,/ 由于/ FCC/ 网格/ 比/ 方形/ 网格/ 具有/ 更好/ 的/ 采样/ 性质/ ,/ 并且/ 具有/ 较/ 小/ 的/ 误差/ ,/ 因此/ ,/ 本文/ 算法/ 生/ 成为/ FCC/ 网格/ 直线/ ,/ 在/ 相同/ 质量/ 的/ 条件/ 下/ ,/ 体素/ 数量/ 更/ 少/ ,/ 生成/ 的/ 直线/ 更/ 平滑/ ./ 但/ 本文/ 算法/ 要/ 较/ 方形/ 网格/ 直线/ 生成/ 算法/ 稍为/ 复杂/ ./ 

