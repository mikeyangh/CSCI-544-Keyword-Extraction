Page1/ 基于/ 方向/ 梯度/ 的/ H/ ./ 264/ 帧/ 内/ 预测/ 模式/ 选择/ 算法/ 宋云/ 1/ )/ ,/ 2/ )/ 沈燕飞/ 2/ )/ 龙际珍/ 1/ )/ 朱珍民/ 2/ )/ 1/ )/ (/ 长沙/ 理工大学/ 计算机/ 与/ 通信/ 工程学院/ 长沙/ 410014/ )/ 2/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 摘要/ 率/ 失真/ 优化/ (/ RDO/ )/ 技术/ 的/ 应用/ 大幅提高/ 了/ H/ ./ 264/ 的/ 编码/ 性能/ ,/ 但全/ 搜索/ 方式/ 下/ ,/ 每一宏块/ 所有/ 模式/ 都/ 要/ 进行/ R/ -/ D/ 代价/ 计算/ ,/ 复杂度/ 非常/ 大/ ./ 文中/ 利用/ 参考/ 像素/ 与/ 当前/ 块/ 之间/ 的/ 方向/ 梯度/ 检测/ 预测/ 方向/ 上/ 的/ 纹理/ 方向/ 与/ 边缘/ 强度/ ,/ 预先/ 筛除/ 部分/ 方向/ 梯度/ 较大/ 的/ 预测/ 模式/ ,/ 形成/ 一种/ 基于/ 方向/ 梯度/ 的/ 快速/ 帧/ 内/ 预测/ 模式/ 选择/ 算法/ ,/ 并/ 利用/ 预测/ 模式/ 的/ 空间/ 相关性/ 采用/ 最有/ 可能/ 模式/ 替换/ 直流/ 模式/ 作为/ 缺省/ 候选/ 模式/ ,/ 改进/ 了/ 基本/ 算法/ ./ 对/ 10/ 个/ 标准/ 序列/ 进行/ 测试/ ,/ 两个/ 算法/ 应用/ 在/ 亮度/ 分量/ 帧/ 内/ 预测/ 模式/ 选择/ 中均/ 比/ JM18/ ./ 0/ 全/ 搜索/ 方式/ 减少/ 了/ 50/ %/ 以上/ 的/ 编码/ 时间/ ,/ 且/ 编码/ 性能/ 损失/ 很小/ ,/ 保持/ 峰值/ 信噪比/ 与/ JM/ 全/ 搜索/ 方式/ 相同/ 时/ ,/ 基本/ 算法/ 码率/ 平均/ 上升/ 2.361/ %/ ,/ 改进/ 算法/ 码率/ 平均/ 上升/ 1.477/ %/ ./ 关键词/ 视频/ 编码/ ;/ H/ ./ 264/ ;/ 率/ 失真/ 优化/ ;/ 模式/ 选择/ 1/ 引言/ H/ ./ 264/ 标准/ [/ 1/ ]/ 中/ 提供/ 了/ 多种/ 编码/ 工具/ ,/ 使得/ 其/ 编码/ 性能/ 较/ 大幅度/ 优于/ 其它/ 视频/ 编码标准/ [/ 2/ ]/ ,/ 率/ 失真/ 优化/ (/ RateDistortionOptimization/ ,/ RDO/ )/ [/ 3/ ]/ 是/ 其中/ 的/ 核心技术/ 之一/ ./ H/ ./ 264/ 率/ 失真/ 优化/ 技术/ 以全/ 搜索/ 的/ 方式/ 选择/ R/ -/ D/ (/ Rate/ -/ Distortion/ )/ 代价/ 最小/ 的/ 模式/ 进行/ 帧/ 内/ 预测/ 和/ 帧/ 间/ 运动/ 估计/ ,/ 虽然/ 较/ 大幅度/ 地/ 提高/ 了/ 编码/ 性能/ ,/ 但/ 计算/ 量/ 非常/ 大/ ,/ RDO/ 计算/ 甚至/ 达到/ 了/ 整个/ 编码/ 计算/ 的/ 90/ %/ [/ 4/ ]/ ./ 为了/ 减小/ RDO/ 的/ 计算/ 量/ ,/ 研究者/ 们/ 提出/ 了/ 很多/ 帧/ 内/ 与/ 帧/ 间/ 快速/ 模式/ 选择/ 算法/ ,/ 本文/ 侧重/ 帧/ 内/ 模式/ 选择/ 算法/ ./ Pan/ 等/ 人/ 最早/ 在/ 2003/ 年/ 提出/ 两个/ 快速/ 模式/ 选择/ 算法/ ,/ 比全/ 搜索/ 模式/ 减少/ 约/ 10/ %/ 的/ 编码/ 时间/ ,/ PSNR/ (/ PeakSignalNoiseRatio/ ,/ 峰值/ 信噪比/ )/ 损失/ 0.1/ dB/ 左右/ ,/ 被/ H/ ./ 264/ 标准/ 采纳/ [/ 5/ -/ 6/ ]/ ./ 其后/ ,/ Pan/ 等/ 人/ 又/ 应用/ Sobel/ 算子/ 计算/ 块/ 内/ 局部/ 边缘/ 信息/ ,/ 提出/ 了/ 一个/ 模式/ 过滤/ 算法/ [/ 7/ ]/ ,/ 进一步/ 降低/ 了/ 模式/ 选择/ 的/ 复杂度/ ./ 与此同时/ ,/ Huang/ 等/ 人/ [/ 8/ ]/ 结合/ 块/ 内/ 采样/ 提出/ 了/ 一个/ 基于/ 上下文/ 的/ 自/ 适应/ 快速/ 模式/ 选择/ 算法/ ,/ 相比/ 全/ 搜索/ 模式/ 可/ 节省/ 一半/ 以上/ 的/ 编码/ 时间/ ,/ 但/ PSNR/ 损失/ 接近/ 0.3/ dB/ ./ Wang/ 等/ 人/ 结合/ MPEG/ -/ 7/ [/ 9/ ]/ 边缘/ 描述符/ 提出/ 一个/ 基于/ 主/ 边缘/ 强度/ 检测/ 的/ 快速/ 算法/ DES/ [/ 10/ ]/ ,/ 纹理/ 检测/ 比/ 文献/ [/ 8/ ]/ 更为/ 准确/ ,/ 编码/ 性能/ 也/ 有/ 较大/ 提高/ ,/ 但/ 检测/ 到/ 无/ 方向/ 纹理/ 时/ 执行/ 全/ 搜索/ ,/ 计算/ 复杂度/ 仍然/ 较/ 高/ ./ 其后/ ,/ Tsai/ 等/ 人/ 观察/ 到/ MPEG/ -/ 7/ 边缘/ 描述符/ 在/ 某些/ 情况/ 下会/ 出现/ 错误/ 并且/ 计算/ 中/ 存在/ 指数/ 运算/ 不利于/ 硬件/ 实现/ ,/ 改进/ 了/ 边缘/ 描述符/ ,/ 提出/ 了/ 基于/ 子块/ 和/ 像素/ 的/ 边缘/ 方向/ 检测/ 的/ SDD/ 和/ PDD/ [/ 11/ ]/ ./ 其后/ ,/ Wang/ 等/ 人/ 也/ 基于/ 文献/ [/ 10/ ]/ 提出/ 了/ 一个/ 层次/ 模式/ 过滤/ 算法/ [/ 12/ ]/ ,/ 在/ 文献/ [/ 10/ ]/ 的/ 基础/ 上/ 较/ 大幅度/ 地/ 提高/ 了/ 编码/ 性能/ ,/ 并/ 降低/ 了/ 模式/ 选择/ 的/ 复杂度/ ./ Tsai/ 等/ 人/ [/ 13/ ]/ 利用/ 块/ 内像素/ 梯度/ 检测/ 预测/ 方向/ 的/ 边缘/ 强度/ 提出/ 了/ 一个/ 高效/ 的/ 模式/ 过滤/ 算法/ ,/ 较/ 好/ 地/ 平衡/ 了/ 编码/ 性能/ 和/ 计算/ 复杂度/ ./ 最新/ 的/ 研究/ 中/ ,/ 毛峡/ 等/ 人/ [/ 14/ ]/ 应用/ 梯度方向/ 算子/ 通过/ 检测/ 4/ ×/ 4/ 块/ 的/ 纹理/ 特征/ 和/ 灰度/ 起伏/ 特征/ 进行/ 模式/ 选择/ ,/ Wang/ 等/ 人/ [/ 15/ -/ 16/ ]/ 则/ 基于/ 预测/ 残差/ 的/ SATD/ (/ SumofAbsoluteTransformDifferences/ )/ 和/ SADM/ (/ SumofAbsoluteDifferencesMean/ )/ 提出/ 一个/ 针对/ I4MB/ 的/ 模式/ 筛选/ 和/ 一个/ 基于/ 边缘/ 特征/ 的/ 两/ 阶段/ 模式/ 选择/ 算法/ ,/ 都/ 取得/ 了/ 很/ 好/ 的/ 效果/ ./ 此外/ ,/ Sung/ 等/ 人/ 采用/ 统计/ 方法/ 和/ 聚类/ 方法/ [/ 17/ ]/ 进行/ 模式/ 选择/ ,/ 把/ 机器/ 学习/ 的/ 方法/ 引入/ 到/ 快速/ 模式/ 选择/ 算法/ 中/ ,/ 取得/ 了/ 很/ 好/ 的/ 效果/ ./ 基于/ 机器/ 学习/ 的/ 方法/ [/ 17/ ]/ ,/ 需要/ 脱机/ 学习/ ,/ 算法/ 实现/ 较为/ 复杂/ ,/ 硬件/ 实现/ 难度/ 较大/ ,/ 而且/ 容易/ 出现/ 训练/ 集过/ 适/ ,/ 难以/ 应用/ 在/ 实时/ 系统/ 中/ ./ 传统/ 基于/ 纹理/ 检测/ 的/ 快速/ 算法/ ,/ 简单/ 实用/ ,/ 但/ 现有/ 算法/ 大都/ 只/ 在/ 当前/ 预测/ 块/ 内/ 进行/ 纹理/ 方向/ 与/ 强度/ 检测/ 进行/ 预测/ 模式/ 筛选/ [/ 5/ -/ 16/ ]/ ,/ 没有/ 充分利用/ H/ ./ 264/ 帧/ 内/ 预测/ 机制/ 特性/ ,/ 编码/ 性能/ 受到限制/ ./ 事实上/ ,/ 虽然/ 块/ 内/ 纹理/ 方向/ 强度/ 能/ 一定/ 程度/ 地/ 估计/ 相应/ 预测/ 模式/ 的/ 编码/ 性能/ ,/ 但/ 它/ 不能/ 反映/ 预测/ 方向/ 上/ 邻域/ 参考/ 像素/ 与/ 当前/ 块/ 预测/ 像素/ 之间/ 的/ 相似/ 程度/ ,/ 不能/ 估计/ 模式/ 的/ 预测/ 残差/ 能量/ ,/ 模式/ 筛选/ 的/ 准确/ 程度/ 受到/ 一定/ 影响/ ./ 本文/ 提出/ 一种/ 快速/ 帧/ 内/ 预测/ 模式/ 选择/ 算法/ ,/ 采用/ 预测/ 模式/ 参考/ 像素/ 与/ 当前/ 块/ 像素/ 的/ 方向/ 梯度/ 作为/ 简化/ 的/ 帧/ 内/ 预测/ 模式/ 编码/ 性能/ 估计/ 模型/ ,/ 在/ RDO/ 之前/ 进行/ 候选/ 模式/ 筛除/ ./ 由于/ 预测/ 模式/ 的/ 方向/ 梯度/ 同时/ 包含/ 当前/ 块/ 与/ 邻域/ 之间/ 的/ 纹理/ 方向/ 和/ 边缘/ 强度/ 和/ 模式/ 的/ 预测/ 残差/ 能量/ 信息/ ,/ 模式/ 筛选/ 的/ 准确性/ 得到/ 提高/ ./ 同时/ ,/ 为了/ 进一步提高/ 算法/ 的/ 编码/ 性能/ ,/ 本文/ 利用/ 相邻/ 块间/ 预测/ 模式/ 的/ 空间/ 相关性/ ,/ 采用/ 最有/ 可能/ 模式/ MPM/ (/ MostProbableMode/ )/ 替换/ 直流/ DC/ (/ DirectCurrent/ )/ 模式/ 作为/ 缺省/ 候选/ 模式/ ,/ 改进/ 了/ 基本/ 算法/ ./ 实验/ 结果表明/ 本文/ 基本/ 算法/ 和/ 改进/ 算法/ 编码/ 复杂度/ 基本相同/ ,/ 相比/ 全/ 搜索/ 方式/ 有/ 较/ 大幅度/ 的/ 降低/ ,/ 同时/ 都/ 较/ 好/ 地/ 保持/ 了/ 编码/ 性能/ ,/ 特别/ 是/ 改进/ 算法/ 的/ 编码/ 性能/ 较/ 明显/ 地/ 优于/ 比较/ 的/ 经典/ 算法/ ./ 2H/ ./ 264/ 帧/ 内/ 预测/ H/ ./ 264/ 以宏块/ 为/ 单位/ 在/ YUV/ 色彩/ 空间/ 进行/ 编码/ ,/ 亮度/ 信号/ Y/ 和/ 色度/ 信号/ U/ 、/ V/ 分离/ ,/ 宏块/ 又/ 可/ 按/ 多种/ 分块/ 方式/ 划分/ 为/ 不同/ 大小/ 的/ 子块/ ./ H/ ./ 264/ 以子/ 块/ 为/ 单位/ 在/ 空域/ 进行/ 帧/ 内/ 预测/ ,/ 采用/ 从左到右/ 、/ 从上到下/ 的/ 预测/ 顺序/ ,/ 边界/ 块/ 采用/ DC/ 模式/ 进行/ 预测/ ,/ 其它/ 块/ 由/ 其/ 左/ 、/ 上/ 邻域/ 已/ 编码/ 块/ 的/ 重建/ 值/ 预测/ ./ 编码器/ 对/ 预测/ 残差/ 进行/ DCT/ 变换/ 、/ 量化/ 、/ 熵/ 编码/ 的/ 同时/ 模拟/ 解码/ 过程/ ,/ 计算/ 并/ 保存/ 当前/ 块/ 的/ 重建/ 值/ ,/ 为/ 后续/ 块/ 预测/ 提供/ 参考/ ./ 为/ 适应/ 不同/ 的/ 应用/ 需求/ ,/ H/ ./ 264/ 定义/ 了/ 多个/ 编码/ 档次/ ,/ 基本/ 档次/ 的/ 亮度/ 分量/ 帧/ 内/ 预测/ 定义/ 了/ I4MB/ 和/ I16MB/ 两种/ 分块/ 方式/ ,/ 高级/ 档次/ 的/ 还/ 包括/ I8MB/ ./ I4MB/ 和/ I8MB/ 方式/ 下/ ,/ 宏块/ 分别/ 划分/ 为/ 16/ 个/ 4/ ×/ 4/ 子块/ 和/ 4/ 个/ 8/ ×/ 8/ 子块/ ,/ 每个/ 子块/ 可/ Page3/ 以/ 采用/ 不同/ 的/ 模式/ 进行/ 预测/ ,/ I16MB/ 方式/ 下/ 整个/ 16/ ×/ 16/ 宏块/ 采用/ 同/ 一种/ 模式/ 进行/ 预测/ ./ 图/ 1/ 示例/ 了/ I4MB/ 的/ 预测/ 参考/ 像素/ 和/ 预测/ 模式/ ,/ 当前/ 块/ 像素/ a/ ~/ p/ 由/ 邻域/ A/ ~/ M13/ 个/ 参考/ 像素/ 重建/ 值/ 预测/ ,/ 共有/ 9/ 种/ 预测/ 模式/ ,/ 包括/ DC/ 模式/ 和/ 8/ 种/ 方向/ 预测/ 模式/ ./ I8MB/ 方式/ 参考/ 当前/ 块/ 上/ 、/ 左/ 邻域/ 的/ 25/ 个/ 像素/ ,/ 9/ 种/ 预测/ 模式/ 与/ I4MB/ 相同/ ./ I16MB/ 参考/ 像素/ 包括/ 当前/ 块/ 邻域/ 已/ 编码/ 宏块/ 的/ 33/ 个/ 像素/ ,/ 只有/ DC/ 模式/ 和/ 3/ 种/ 方向/ 模式/ 共/ 4/ 种/ 预测/ 模式/ ./ 色度/ 分量/ 预测/ 相对/ 简单/ ,/ 只/ 采用/ 8/ ×/ 8/ 分块/ 方式/ ,/ 预测/ 模式/ 与/ I16MB/ 相同/ ,/ UV/ 色度/ 分量/ 采用/ 相同/ 的/ 预测/ 模式/ ./ H/ ./ 264/ 率/ 失真/ 优化/ 策略/ 穷举/ 宏块/ 各种/ 分块/ 策略/ 下/ 所有/ 预测/ 模式/ 的/ R/ -/ D/ 代价/ ,/ 选择/ 宏块/ 代价/ 最小/ 的/ 分块/ 方式/ 和/ 模式/ 进行/ 预测/ ./ R/ -/ D/ 代价/ 函数/ 定义/ 为/ 其中/ ,/ D/ 表示/ 重建/ 失真/ ,/ H/ ./ 264/ 参考/ 软件/ JM/ ①/ 采用/ 当前/ 块/ 的/ 原始/ 值/ 与/ 重建/ 值/ 的/ 差值/ 平方和/ SSD/ (/ SumofSquaredDifferences/ )/ 度量/ ;/ 码率/ Rate/ 为/ 各种/ 预测/ 模式/ 和/ 量化/ 参数/ 下/ 编码/ 所/ 需/ 比特/ 数/ ;/ λ/ 为/ 拉格朗/ 日/ 算子/ ./ 得到/ 失真度/ 量/ SSD/ 需要/ 进行/ 整数/ 变换/ 、/ 量化/ 、/ 熵/ 编码/ 、/ 反/ 整数/ 变换/ 、/ 反/ 量化/ ,/ 码率/ Rate/ 也/ 只有/ 熵/ 编码/ 后/ 才能/ 得到/ ,/ 计算/ 一次/ R/ -/ D/ 代价/ ,/ 几乎/ 要/ 进行/ 一次/ 完整/ 编码/ ./ 预测/ 过程/ 中/ 亮度/ 分量/ 与/ 色度/ 分量/ 组合/ 进行/ ,/ 高级/ 档次/ 下/ 每/ 一宏块/ 需要/ 计算/ R/ -/ D/ 代价/ 4/ ×/ (/ 4/ ×/ 4/ ×/ 9/ +/ 2/ ×/ 2/ ×/ 9/ +/ 4/ )/ =/ 736/ 次/ ,/ 其它/ 不/ 包括/ I8MB/ 方式/ 的/ 档次/ 也/ 需要/ 计算/ 592/ 次/ ,/ 计算/ 量/ 非常/ 大/ ./ 3/ 基于/ 方向/ 梯度/ 的/ 模式/ 选择/ 算法/ 3.1/ 模式/ 筛选/ 模型/ 为了/ 降低/ 编码/ 复杂度/ ,/ 基于/ 过滤/ 的/ 帧/ 内/ 模式/ 选择/ 算法/ 构建/ 低/ 复杂度/ 的/ 编码/ 性能/ 估计/ 模型/ ,/ 在/ RDO/ 之前/ 筛除/ 部分/ 编码/ 性能/ 可能/ 不佳/ 的/ 模式/ ,/ 减少/ R/ -/ D/ 代价/ 计算/ ,/ 降低/ 编码/ 复杂度/ ./ 本文/ 采用/ 方向/ 梯度/ 作为/ 方向/ 预测/ 模式/ 编码/ 性能/ 估计/ 模型/ 进行/ 模式/ 筛选/ ./ 方向/ 预测/ 模式/ 的/ 方向/ 梯度/ 定义/ 为/ 预测/ 方向/ 上/ 当前/ 块/ 像素/ 与其/ 最大/ 权重/ 参考/ 像素/ 之间/ 的/ 平均/ 绝对/ 差/ [/ 18/ ]/ :/ 上式/ 中/ ,/ dir/ 表示/ 预测/ 方向/ ;/ R/ 和/ C/ 分别/ 为/ 参考/ 像素/ 和/ 当前/ 块/ 像素/ 的/ 抽样/ 子集/ ;/ Xx/ // // dir/ 表示/ 抽样/ 参考/ 像素/ X/ 与/ 当前/ 块/ 像素/ x/ 的/ 连线/ 与/ 预测/ 方向/ 一致/ ;/ n/ 为/ 抽样/ 像素/ 的/ 数量/ ;/ PX/ 、/ Ix/ 分别/ 为/ 参考/ 像素/ X/ 的/ 重建/ 值/ 和/ 当前/ 块/ 像素/ x/ 的/ 原始/ 值/ ./ 考察/ 式/ (/ 2/ )/ ,/ G/ (/ dir/ )/ 表征/ 预测/ 方向/ 上/ 参考/ 像素/ 与/ 当前/ 块/ 的/ 梯度/ ,/ 其值/ 大小/ 对应/ 预测/ 方向/ 正交/ 方向/ 上/ 的/ 边缘/ 强度/ ./ 同时/ ,/ G/ (/ dir/ )/ 也/ 是/ 预测/ 方向/ 上/ 当前/ 块/ 预测/ 残差/ 平均/ 绝对值/ 的/ 近似/ ,/ 包含/ 预测/ 残差/ 能量/ 信息/ ,/ 因此/ ,/ 式/ (/ 2/ )/ 定义/ 的/ 方向/ 梯度/ 构成/ 图像/ 局部/ 上下文/ 纹理/ 方向/ 和/ 当前/ 块/ 预测/ 残差/ 的/ 一个/ 重要/ 特征/ 表示/ ,/ 能/ 较/ 好/ 地/ 估计/ 预测/ 模式/ 的/ 编码/ 性能/ ./ 3.2/ 方向/ 梯度/ 计算/ 为了/ 减少/ 计算/ ,/ 只/ 抽样/ 少数/ 有/ 代表性/ 的/ 预测/ 像素/ 与/ 参考/ 像素/ 对/ 计算/ 预测/ 模式/ 的/ 方向/ 梯度/ ,/ 本文/ 抽样/ 2/ 的/ 幂/ 数个/ 像素/ 对作/ 方向/ 梯度/ ,/ 把/ 除法/ 运算/ 转化/ 为/ 移位/ 操作/ 加速/ 运算/ ,/ I4MB/ 抽样/ 4/ 个/ 像素/ 对/ ,/ I8MB/ 抽样/ 8/ 个/ 像素/ 对/ ,/ I16MB/ 抽样/ 16/ 个/ ./ 图/ 2/ (/ a/ )/ ~/ (/ h/ )/ 示例/ 了/ I4MB8/ 个/ 方向/ 预测/ 模式/ 的/ 方向/ 梯度/ 计算方法/ ,/ 深色/ 像素/ 表示/ 参与/ 计算/ 的/ 考考/ 像素/ 与/ 当前/ 块/ 像素/ ./ 如图/ 2/ (/ a/ )/ 所示/ ,/ I4MB/ 垂直/ 预测/ 模式/ 中/ ,/ 当前/ 块/ 像素/ 由/ 参考/ 像素/ A/ ~/ D/ 预测/ ,/ 用式/ (/ 3/ )/ 计算/ 方向/ 梯度/ :/ 其中/ ,/ PA/ 、/ PC/ 分别/ 代表/ 参考/ 像素/ A/ 、/ C/ 的/ 重建/ 值/ ;/ Ie/ 、/ Im/ 、/ Ig/ 、/ Io/ 则/ 为/ 当前/ 块/ 像素/ e/ 、/ m/ 、/ g/ 、/ o/ 的/ 原始/ 值/ ;/ G/ (/ A/ )/ 、/ G/ (/ C/ )/ 表示/ 参考/ 像素/ A/ 、/ C/ 与/ 当前/ 块/ 的/ 梯度/ ;/ G/ (/ ver/ )/ 即/ 为/ 垂直/ 预测/ 模式/ (/ mode0/ )/ 的/ 方向/ 梯度/ ./ I4MB/ 水平/ 预测/ 模式/ 中/ ,/ 当前/ 块/ 每/ 一行/ 的/ 像素/ 预测值/ 等于/ 其/ 左侧/ 的/ 参考/ 像素/ I/ ~/ L/ 的/ 重建/ 值/ ,/ 如图/ 2/ (/ b/ )/ 所示/ ,/ 其/ 方向/ 梯度/ 由式/ (/ 4/ )/ 计算/ :/ ①/ JointVideoTeamReferenceSoftwareJM18/ ./ 0/ [/ CP/ // OL/ ]/ ./ Page4/ 图/ 2I4MB/ 预测/ 模式/ 方向/ 梯度/ 计算/ 其中/ ,/ PI/ 、/ PK/ 为/ 参考/ 像素/ I/ 、/ K/ 的/ 重建/ 值/ ;/ Ib/ 、/ Id/ 、/ Ii/ 、/ Il/ 为/ 当前/ 块/ 像素/ h/ 、/ d/ 、/ i/ 、/ l/ 的/ 原始/ 值/ ;/ G/ (/ I/ )/ 、/ G/ (/ K/ )/ 表示/ 参考/ 像素/ I/ 、/ K/ 与/ 当前/ 块/ 的/ 梯度/ ;/ G/ (/ hor/ )/ 为/ 水平/ 预测/ 模式/ (/ mode1/ )/ 的/ 方向/ 梯度/ ./ I4MB/ 左下/ 对角线/ 预测/ 模式/ 中/ 当前/ 块/ 像素/ 由/ B/ ~/ H/ 预测/ ,/ 参考/ 像素/ E/ 、/ D/ 、/ F/ 参与/ 预测/ 的/ 像素/ 较多且/ 权重/ 较大/ ,/ 预测/ 像素/ g/ 、/ m/ 、/ f/ 、/ k/ 与/ 它们/ 不/ 紧邻/ ,/ 一定/ 程度/ 地/ 反应/ 了/ 这个/ 方向/ 上/ 亮度/ 值/ 的/ 变化/ 趋向/ ,/ 选择/ 它们/ 计算/ 方向/ 梯度/ ,/ 如图/ 2/ (/ c/ )/ 和/ 式/ (/ 5/ )/ 所示/ :/ G/ (/ E/ )/ =/ PE/ -/ Ig/ +/ PE/ -/ Im/ 烄/ G/ (/ D/ )/ =/ PD/ -/ If/ 烅/ G/ (/ F/ )/ =/ PF/ -/ IkG/ (/ diag/ _/ left/ )/ =/ (/ G/ (/ E/ )/ +/ G/ (/ D/ )/ +/ G/ (/ F/ )/ )/ / 烆/ 其中/ ,/ PE/ 、/ PD/ 、/ PF/ 为/ 参考/ 像素/ E/ 、/ D/ 、/ F/ 的/ 重建/ 值/ ;/ Ig/ 、/ Im/ 、/ If/ 、/ Ik/ 为/ 像素/ g/ 、/ m/ 、/ f/ 、/ k/ 的/ 原始/ 值/ ,/ G/ (/ E/ )/ 、/ G/ (/ D/ )/ 、/ G/ (/ F/ )/ 为/ E/ 、/ D/ 、/ F/ 与/ 当前/ 块/ 的/ 梯度/ ,/ G/ (/ diag/ _/ left/ )/ 为/ 左下/ 对角线/ 预测/ 模式/ (/ mode3/ )/ 的/ 方向/ 梯度/ ./ I4MB/ 右下/ 对角线/ 模式/ 则/ 选择/ 参与/ 预测/ 的/ 像素/ 较多且/ 权重/ 较大/ M/ 、/ I/ 、/ A/ 以及/ 当/ 相应/ 的/ 预测/ 像素/ f/ 、/ g/ 、/ j/ 、/ p/ 计算/ 方向/ 梯度/ ,/ 如图/ 2/ (/ d/ )/ 和/ 式/ (/ 6/ )/ 所示/ :/ G/ (/ M/ )/ =/ PM/ -/ If/ +/ PM/ -/ Ip/ 烄/ G/ (/ I/ )/ =/ PI/ -/ Ij/ 烅/ G/ (/ A/ )/ =/ PA/ -/ IgG/ (/ diag/ _/ right/ )/ =/ (/ G/ (/ M/ )/ +/ G/ (/ I/ )/ +/ G/ (/ A/ )/ )/ / 烆/ 其中/ PM/ 、/ PI/ 、/ PA/ 和/ If/ 、/ Ig/ 、/ Ij/ 、/ Ip/ 分别/ 为/ 参考/ 像素/ M/ 、/ I/ 、/ A/ 的/ 重建/ 值/ 和/ 预测/ 像素/ f/ 、/ g/ 、/ j/ 、/ p/ 的/ 原始/ 值/ ,/ G/ (/ M/ )/ 、/ G/ (/ I/ )/ 、/ G/ (/ A/ )/ 表征/ 对应/ 参考/ 像素/ 与/ 当前/ 块/ 的/ 梯度/ ,/ G/ (/ diag/ _/ rightt/ )/ 为/ 右/ 下/ 对角线/ 预测/ 模式/ (/ mode4/ )/ 的/ 方向/ 梯度/ ./ 类似/ 地/ ,/ 依图/ 2/ (/ e/ )/ ~/ (/ h/ )/ 可以/ 得到/ I4MB/ 另外/ 4/ 个/ 预测/ 方向/ 的/ 方向/ 梯度/ ./ I8MB/ 方式/ 与/ I4MB/ 一样/ 包括/ DC/ 模式/ 和/ 8/ 个/ 方向/ 模式/ ,/ 其/ 方向/ 梯度/ 计算方法/ 与/ I4MB/ 类似/ ,/ 在/ 每个/ 预测/ 方向/ 上/ 抽选/ 当前/ 块/ 内/ 的/ 8/ 个/ 像素/ 和/ 与其/ 对应/ 的/ 权重/ 最大/ 的/ 参考/ 像素/ 进行/ 方向/ 梯度/ 计算/ ./ I16MB/ 方式/ 中/ 只有/ 0/ 、/ 1/ 、/ 3/ 这/ 3/ 种/ 方向/ 预测/ 模式/ ,/ 每个/ 预测/ 方向/ 上/ ,/ 在/ 当前/ 块/ 内/ 抽选/ 16/ 个/ 有/ 代表性/ 的/ 像素/ 计算/ 它们/ 与/ 对应/ 参考/ 像素/ 的/ 绝对/ 差/ 和/ 得到/ 模式/ 的/ 方向/ 梯度/ ./ 3.3/ 基本模式/ 选择/ 算法/ 预测/ 模式/ 的/ 方向/ 梯度/ 包含/ 参考/ 像素/ 与/ 当前/ 块/ 之间/ 的/ 局部/ 纹理/ 方向/ 、/ 边缘/ 强度/ 和/ 残差/ 能量/ 信息/ ,/ 可以/ 作为/ 简化/ 模型/ 在/ 编码/ 前/ 估计/ 模式/ 的/ 编码/ 性能/ ./ 但/ 方向/ 梯度/ 并/ 不能/ 完全/ 准确/ 地/ 表征/ 模式/ 的/ 编码/ 性能/ ,/ 方向/ 梯度/ 最小/ 的/ 模式/ 为块/ 最佳/ 预测/ 模式/ 的/ 可能性/ 较大/ ,/ 但/ 并不一定/ 是/ 实际/ 编码/ 过程/ 中/ 的/ 最佳/ 模式/ ./ 同时/ ,/ H/ ./ 264/ 中/ 边界/ 预测/ 采用/ DC/ 模式/ ,/ 而且/ 这种/ 模式/ 在/ 平坦/ 区域/ 性能优越/ ./ 因此/ ,/ 不能/ 直接/ 采用/ 方向/ 梯度/ 最小/ 的/ 模式/ 作为/ 预测/ 模式/ ,/ 而应/ 选择/ DC/ 模式/ 和/ 方向/ 梯度/ 较/ 小/ 的/ 几种/ 模式/ 作为/ 候选/ 模式/ 进行/ 率/ 失真/ 优化/ ./ 表/ 1/ 列出/ 了/ Foreman/ ./ qcif/ 和/ Tempete/ ./ cif/ 两个/ 序列/ 100/ 帧/ 全部/ 使用/ I4MB/ 方式/ ,/ 选择/ DC/ 模式/ 加/ 方向/ 梯度/ 最小/ 的/ 1/ ~/ 7/ 种/ 方向/ 预测/ 模式/ 进行/ 亮度/ 分量/ 预测/ RDO/ 的/ 性能/ 测试/ 结果/ ./ 结果显示/ 采用/ 的/ 模式/ 数量/ 越/ 多/ 编码/ 性能/ 越/ 好/ ,/ 编码/ 复杂度/ 越大/ ,/ 选择/ DC/ 模式/ 加/ 3/ 种/ 方向/ 梯度/ 最小/ 的/ 方向/ 模式/ 能/ 较/ 好/ 地/ 达到/ 编码/ 时间/ 与/ 编码/ 性能/ 的/ 平衡/ ./ 其它/ 序列/ 和/ 全部/ Page5/ 使用/ I8MB/ 方式/ 的/ 实验/ 也/ 得到/ 了/ 类似/ 的/ 结果/ ./ 基于/ 此/ 观察/ ,/ 对于/ I4MB/ 和/ I8MB/ 方式/ 我们/ 都/ 选择/ 3/ 种/ 方向/ 梯度/ 最小/ 的/ 方向/ 模式/ 和/ DC/ 模式/ 作为/ 候选/ 模式/ 进行/ RDO/ ,/ 以/ R/ -/ D/ 代价/ 最小/ 的/ 模式/ 作为/ 各/ 4/ ×/ 4/ 子块/ 和/ 8/ ×/ 8/ 子块/ 最佳/ 预测/ 模式/ ./ I16MB/ 方式/ 只有/ 3/ 种/ 方向/ 模式/ ,/ 以/ 方向/ 梯度/ 最小/ 的/ 1/ 种/ 方向/ 模式/ 和/ DC/ 模式/ 作为/ 候选/ 模式/ 进行/ RDO/ ,/ 选择/ R/ -/ D/ 代价/ 较/ 小/ 的/ 作为/ 它/ 的/ 最佳/ 预测/ 模式/ ./ 然后/ ,/ 累加/ I4MB/ 所有/ 4/ ×/ 4/ 子块/ 、/ I8MB/ 所有/ 8/ ×/ 8/ 子块/ 的/ 最佳/ 预测/ 模式/ 的/ 方向/ 模式/ 数量/ 1234567/ 表/ 1I4MB/ 采用/ 不同/ 数量/ 模式/ 进行/ 编码/ 的/ 性能/ 比较/ (/ 全部/ I/ 帧/ 编码/ )/ -/ 6.963/ ./ 4/ 改进/ 算法/ 图像/ 的/ 空间/ 相关性/ 不仅/ 存在/ 于/ 相邻/ 像素/ 间/ 的/ 亮度/ 和/ 色度/ 值上/ ,/ 还/ 表现/ 在/ 相邻/ 块间/ 的/ 纹理/ 结构/ 上/ ./ 自然/ 图像/ 中/ 存在/ 很多/ 区域/ 相邻/ 块间/ 的/ 局部/ 边缘/ 特征/ 、/ 纹理/ 方向/ 相同/ 或/ 相近/ ,/ 这些/ 相邻/ 块/ 的/ 最佳/ 预测/ 模式/ 往往/ 会/ 相同/ ,/ 这/ 意味着/ 相邻/ 块间/ 的/ 预测/ 模式/ 也/ 存在/ 一定/ 的/ 空间/ 相关性/ ./ 利用/ 这一/ 特性/ ,/ 把/ 最/ 有/ 可能/ 模式/ MPM/ 作为/ RDO/ 的/ 一个/ 候选/ 模式/ ,/ 可以/ 提高/ 模式/ 选择/ 算法/ 的/ 编码/ 性能/ ./ H/ ./ 264/ 中/ I4MB/ 和/ I8MB/ 最有/ 可能/ 模式/ MPM/ 定义/ 为/ 当前/ 块/ 的/ 左/ 、/ 上/ 相邻/ 块/ 采用/ 的/ 最小/ 编号/ 的/ 预测/ 模式/ ,/ 不/ 存在/ 左/ 或/ 上/ 相邻/ 块/ 的/ 边界/ 块/ 则/ 以/ DC/ 模式/ 作为/ 其/ MPM/ ,/ I16MB/ 没有/ 定义/ MPM/ ./ 图/ 3/ 比较/ 了/ 多个/ 序列/ 全/ 搜索/ 方式/ 下/ MPM/ 和/ DC/ 模式/ 为/ 最佳/ 预测/ 模式/ 的/ 块/ 占/ 所有/ 块/ 的/ 百分比/ ,/ 图/ 3/ (/ a/ )/ 和/ (/ b/ )/ 分别/ 为/ I4MB/ 和/ I8MB/ 方式/ 下/ 的/ 占/ 比/ ./ 很/ 明显/ ,/ 无论是/ I4MB/ 还是/ I8MB/ 方式/ MPM/ 为/ 最佳/ 模式/ 的/ 频率/ 都/ 远高于/ DC/ 模式/ ,/ 因此/ ,/ 我们/ 改进/ 基本/ 算法/ ,/ I4MB/ 和/ I8MB/ 方式/ 中/ 采用/ MPM/ 模式/ 取代/ DC/ 模式/ 作为/ 缺省/ 候选/ 模式/ ./ 算法/ 在/ I4MB/ 和/ I8MB/ 方式/ 候选/ 模式/ 的/ 选择/ 中/ 计算/ 各/ 分块/ 方式/ 下/ 的/ 方向/ 模式/ 的/ 方向/ 梯度/ 后/ ,/ 选择/ I4MB/ 和/ I8MB/ 方式/ 方向/ 梯度/ 最小/ 的/ 3/ 种/ 模式/ 作为/ 候选/ 模式/ ,/ 如果/ MPM/ 在/ 候选/ 模式/ 集中/ ,/ 则/ 加入/ DC/ 模式/ 到/ 候选/ 模式/ 集中/ ,/ 否则/ 加入/ MPM/ 到/ 候选/ 模式/ 集中/ ,/ I16MB/ 候选/ 模式/ 的/ 选择/ 与/ 基本/ 算法/ 相同/ ./ 由于/ 选择/ 参与/ RDO/ 的/ 模式/ 数量/ 相同/ ,/ 所以/ 改进/ 算法/ 的/ 复杂度/ 与/ 基本/ 算法/ 基本相同/ ./ R/ -/ D/ 代价/ 得到/ I4MB/ 和/ I8MB/ 的/ 宏块/ R/ -/ D/ 代价/ ,/ I16MB/ 的/ 宏块/ R/ -/ D/ 代价/ 即/ 为/ 其/ 最佳/ 预测/ 模式/ 的/ R/ -/ D/ 代价/ ./ 最后/ ,/ 在/ 3/ 种/ 方式/ 中/ 选择/ 宏块/ R/ -/ D/ 代价/ 最小/ 的/ 作为/ 最佳/ 预测/ 方式/ ,/ 采用/ 最佳/ 方式/ 中/ 各子/ 块/ 的/ 最佳/ 预测/ 模式/ 进行/ 帧/ 内/ 预测/ ./ 因此/ ,/ 算法/ 在/ 高级/ 档次/ 下/ 每/ 一宏块/ 亮度/ 分量/ 只/ 需/ 进行/ 4/ ×/ 4/ ×/ 4/ +/ 4/ ×/ 2/ ×/ 2/ +/ 2/ =/ 82/ 次/ R/ -/ D/ 代价/ 计算/ ,/ 在/ 不/ 进行/ 色度/ 分量/ 模式/ 选择/ 时/ ,/ 宏块/ R/ -/ D/ 代价/ 计算/ 次数/ 也/ 减少/ 到/ 4/ ×/ 82/ =/ 328/ ./ 图/ 3/ 最佳/ 预测/ 模式/ 为/ MPM/ 与/ DC/ 模式/ 占/ 比/ 比较/ 4/ 实验/ 与/ 分析/ 4.1/ 实验/ 比较/ 算法/ 我们/ 在/ JVT/ 参考/ 软件/ JM18/ ./ 0/ [/ 18/ ]/ 上/ 实现/ 了/ 文献/ [/ 10/ ]/ 中/ 的/ DES/ 、/ 文献/ [/ 11/ ]/ 中/ 的/ SDD/ 和/ 文献/ [/ 12/ -/ 13/ ]/ 算法/ 等/ 几个/ 优秀/ 算法/ 和/ 本文/ 算法/ 的/ 性能/ 比较/ ./ DES/ 和/ SDD/ 都/ 采用/ 分块/ 的/ 方式/ 检测/ 纹理/ 强度/ ,/ 均/ 没有/ 提供/ 亮度/ 分量/ I8MB/ 模式/ 筛选/ 方法/ ,/ 我们/ 把/ 2/ ×/ 2/ 子块/ 的/ 大小/ 设为/ 4/ ×/ 4/ ,/ 然后/ 参照/ I4MB/ 方式/ 对/ 两个/ 算法/ 进行/ 扩展/ ./ 此外/ ,/ 文献/ [/ 13/ ]/ 算法/ 提供/ 了/ 退出/ 方法/ 的/ 一/ Page6/ 个/ 逃逸/ 选项/ ,/ 当/ 各/ 方向/ 的/ 梯度/ 值/ 都/ 大于/ 一个/ 经验/ 阈值/ 时/ 执行/ 全/ 搜索/ ,/ 实验/ 中/ 为了/ 比较/ 方法/ 的/ 有效性/ ,/ 取消/ 了/ 这个/ 选项/ ./ 文献/ [/ 10/ ,/ 12/ ]/ 算法/ 在/ 检测/ 到/ 无/ 方向/ 边缘/ 信息/ 时/ 也/ 执行/ 全/ 搜索/ ,/ 这是/ 算法/ 的/ 一个/ 选择/ 分支/ ,/ 为了/ 保持/ 算法/ 的/ 完整性/ ,/ 实现/ 中/ 予以/ 保留/ ./ 本文/ 算法/ 在/ 所有/ 条件/ 下/ 都/ 不/ 执行/ 全/ 搜索/ ./ 同时/ ,/ 考虑/ 到/ 色度/ 分量/ 的/ 预测/ 相对/ 简单/ ,/ 实验/ 中/ 所有/ 比较/ 算法/ 都/ 不/ 进行/ UV/ 分量/ 预测/ 模式/ 筛选/ ./ 4.2/ 编码/ 参数/ 与/ 评价/ 指标/ 实验/ 以/ JM18/ ./ 0/ 全/ 搜索/ 策略/ 为/ 基准/ 评价/ 方法/ 性能/ ,/ 评价/ 指标/ 包括/ 编码/ 性能指标/ 亮度/ 分量/ PSNR/ 和/ 码率/ (/ BR/ )/ 损益/ Δ/ PSNR/ (/ dB/ )/ 和/ Δ/ BR/ (/ %/ )/ 以及/ 算法/ 相对/ JM18/ ./ 0/ 编码/ 时间/ 降低/ 百分比/ Δ/ Time/ ./ Δ/ PSNR/ (/ dB/ )/ 和/ Δ/ BR/ (/ %/ )/ 分别/ 表示/ 快速/ 算法/ 相对/ JM18/ ./ 0/ 在/ PSNR/ 模式/ (/ 不/ 损失/ 码率/ )/ 和/ 码率/ 模式/ (/ 不/ 损失/ PSNR/ )/ 下/ 的/ 编码/ 性能/ 损失/ ,/ 采用/ Bjontegaard/ 方法/ ①/ 在/ 4/ 个/ 量化/ 参数/ 下/ 进行/ PSNR/ // 码率/ 转换/ 和/ 平均/ 拟合/ ./ 测试/ 序列/ 包括/ qcif/ 、/ cif/ 各/ 5/ 个/ 标准/ 420/ 序列/ ,/ 每个/ 序列/ 编码/ 100/ 帧/ ,/ 其它/ 关键/ 参数设置/ 如下/ :/ (/ 1/ )/ 量化/ 参数/ (/ QP/ )/ 为/ 28/ 、/ 32/ 、/ 36/ 和/ 40/ ;/ (/ 2/ )/ 帧频/ 为/ 30.0/ ;/ (/ 3/ )/ 所有/ 帧/ 均/ 采用/ 帧/ 内/ 预测/ ;/ (/ 4/ )/ 使用率/ 失真/ 优化/ (/ RDO/ )/ ;/ (/ 5/ )/ 采用/ CABAC/ 进行/ 熵/ 编码/ ;/ (/ 6/ )/ 采用/ 高级/ 档次/ (/ highprofile/ )/ 编码/ ./ 4.3/ 性能/ 比较/ 图/ 3/ 、/ 图/ 4/ 比较/ 了/ Paris/ ./ cif/ 序列/ JM18/ ./ 0/ 和/ 各/ 快速/ 模式/ 选择/ 算法/ 的/ R/ -/ D/ 曲线/ 和/ 编码/ 时间/ ./ 图/ 3/ 显示/ 本文/ 改进/ 算法/ R/ -/ D/ 曲线/ 比/ 其它/ 算法/ 更为/ 接近/ JM18/ ./ 0/ 全/ 搜索/ 曲线/ ,/ 各/ 量化/ 参数/ 下/ 的/ 性能/ 点均/ 在/ 比较/ 算法/ 的/ 左上方/ ,/ 算法/ 的/ 重建/ 视频/ 质量/ 和/ 压缩/ 性能/ 均/ 优于/ 比较/ 算法/ ./ 文献/ [/ 12/ ]/ 算法/ 虽然/ 编码/ 性能/ 与/ 本文/ 基本/ 算法/ 相近/ ,/ 但/ 如图/ 5/ 所示/ 其/ 编码/ 时间/ 明显/ 高于/ 本文/ 基本/ 算法/ 和/ 改进/ 算法/ ./ 图/ 5/ 显示/ ,/ 文献/ [/ 11/ ,/ 13/ ]/ 算法/ 每帧/ 编码/ 时间/ 与/ 本文/ 算法/ 接近/ ,/ 但/ 从/ 图/ 4/ 可以/ 看出/ 它们/ 的/ 编码/ 性能/ 与/ 本文/ 两个/ 算法/ 都/ 有/ 较/ 明显/ 差距/ ./ 表/ 2/ 详细/ 比较/ 了/ 各个/ 算法/ 在/ 10/ 个/ 测试/ 序列/ 中/ 4/ 个/ 量化/ 参数/ 下/ 的/ 平均/ 编码/ 性能/ 损益/ ./ 本文/ 基本/ 算法/ 相比/ JM18/ ./ 0/ 平均/ 损失/ 0.163/ dB/ 的/ PSNR/ 或/ 增加/ 2.361/ %/ 的/ 码率/ 的/ 情况/ 下能/ 减少/ 了/ 约/ 52/ %/ 的/ 编码/ 时间/ ,/ 改进/ 的/ 算法/ 进一步/ 降低/ 了/ 编码/ 性能/ 损失/ ,/ 比/ JM18/ ./ 0/ 平均/ 损失/ 0.101/ dB/ 的/ PSNR/ ,/ 增加/ 1.477/ %/ 的/ 码率/ ,/ 编码/ 时间/ 与/ 基本/ 算法/ 基本相同/ (/ Silent/ ./ qcif/ 等/ 少数/ 包含/ 大量/ 无规则/ 纹理/ 背景/ 的/ 序列/ ,/ 当前/ 块/ 像素/ 与/ 邻域/ 像素/ 相关度/ 较/ 低/ ,/ 文献/ [/ 10/ ]/ 算法/ 检测/ 到/ 无/ 方向/ 边缘/ 信息/ 时/ 退化/ 为/ 全/ 搜索/ 方式/ ,/ 所以/ 其/ 编码/ 性能/ 接近/ 或略超/ 本文/ 基本/ 算法/ ./ 而/ 对于/ 大部分/ 序列/ 而言/ ,/ 像素/ 值/ 空间/ 相关性/ 较大/ ,/ 当前/ 块/ 像素/ 与/ 邻域/ 像素/ 相关度/ 较/ 高/ ,/ 本文/ 基本/ 算法/ 编码/ 性能/ 损失/ 也/ 更/ 小/ )/ ./ 文献/ [/ 11/ ,/ 13/ ]/ 算法/ 与/ 本文/ 同样/ 采用/ 固定/ 数量/ 的/ 候选/ 模式/ 参与/ RDO/ ,/ 所以/ 它们/ 的/ 编码/ 复杂度/ 也/ 是/ 稳定/ 的/ ,/ 各/ 序列/ 编码/ 时间/ 与/ 本文/ 方法/ 接近/ ,/ 但/ 由于/ 它们/ 都/ 只/ 利用/ 块/ 内/ 纹理/ 特征/ 筛选/ 模式/ ,/ 限制/ 了/ 模式/ 选择/ 的/ 准确性/ ,/ 编码/ 性能/ 与/ 本文/ 方法/ 有/ 一定/ 差距/ ./ 文献/ [/ 12/ ]/ 算法/ 从/ 两个/ 方面/ 改进/ 了/ 文献/ [/ 10/ ]/ 算法/ ,/ 一方面/ 基于/ 宏块/ 方差/ 预先/ 筛除/ 一种/ 编码方式/ 降低/ 编码/ 复杂度/ ,/ 另一方面/ 采用/ MPM/ 代替/ DC/ 模式/ 提高/ 编码/ 性能/ ,/ 取得/ 了/ 很/ 好/ 的/ 效果/ ,/ 编码/ 性能/ 优于/ 本文/ 基本/ 算法/ ,/ 但/ 仍/ 低于/ 本文/ 改进/ 算法/ ./ 而且/ 与/ 文献/ [/ 10/ ]/ 算法/ 相同/ ,/ 文献/ [/ 12/ ]/ 算法/ 在/ 检测/ 到/ 无/ 方向/ 边缘/ 信息/ 时/ 退化/ 为/ 全/ 搜索/ 方式/ ,/ 其/ 编码/ 复杂度/ 是/ 不/ 稳定/ 的/ ,/ 平均/ 编码/ 时间/ 比/ 文献/ [/ 10/ ]/ 算法/ 有/ 较大/ 提高/ ,/ 但/ 比/ 本文/ 提出/ 的/ 两个/ 算法/ 仍然/ 高/ 15/ %/ 左右/ ./ ①/ BjontegaardG/ ./ CalculationofaveragePSNRdifferencesPage7/ 表/ 2/ 帧/ 内/ 模式/ 选择/ 算法/ 综合性/ 能/ 比较/ (/ 全/ I/ 帧/ 编码/ )/ 序列/ 文献/ [/ 10/ ]/ Forman/ ./ qcif/ -/ 0.159/ -/ 0.194/ -/ 0.121/ -/ 0.232/ -/ 0.123/ -/ 0.0812/ ./ 6773.2682/ ./ 0363.8872/ ./ 0621.35731/ ./ 7450.1342/ ./ 8650.8250/ ./ 2651.11/ News/ ./ qcif/ -/ 0.291/ -/ 0.384/ -/ 0.189/ -/ 0.316/ -/ 0.229/ -/ 0.1323/ ./ 6724.8862/ ./ 3624.0082/ ./ 8531.62735/ ./ 0650.4245/ ./ 1751.2951/ ./ 6651.49/ Coastguard/ ./ qcif/ -/ 0.189/ -/ 0.312/ -/ 0.134/ -/ 0.197/ -/ 0.163/ -/ 0.0643/ ./ 6634.5501/ ./ 9583.8573/ ./ 1570.93333/ ./ 1949.2847/ ./ 1450.2050/ ./ 5350.60/ Container/ ./ qcif/ -/ 0.268/ -/ 0.226/ -/ 0.046/ -/ 0.328/ -/ 0.199/ -/ 0.1163/ ./ 8924.4120/ ./ 8804.7832/ ./ 8872.22335/ ./ 1750.3851/ ./ 4951.3451/ ./ 2151.06/ Silent/ ./ qcif/ -/ 0.130/ -/ 0.184/ -/ 0.097/ -/ 0.175/ -/ 0.147/ -/ 0.1182/ ./ 3723.3321/ ./ 7933.1512/ ./ 6452.14033/ ./ 7050.6846/ ./ 9851.5151/ ./ 6951.44/ Tempete/ ./ cif/ -/ 0.161/ -/ 0.210/ -/ 0.107/ -/ 0.210/ -/ 0.128/ -/ 0.0952/ ./ 3253.0471/ ./ 5463.0471/ ./ 8451.36933/ ./ 8651.8542/ ./ 3952.6552/ ./ 8052.62/ Bus/ ./ cif/ -/ 0.238/ -/ 0.235/ -/ 0.109/ -/ 0.193/ -/ 0.119/ -/ 0.0803/ ./ 6723.6241/ ./ 6742.9831/ ./ 8371.22935/ ./ 8951.6448/ ./ 5252.5052/ ./ 6452.62/ Paris/ ./ cif/ -/ 0.251/ -/ 0.314/ -/ 0.136/ -/ 0.288/ -/ 0.203/ -/ 0.1123/ ./ 2484.0921/ ./ 7663.7452/ ./ 6211.45235/ ./ 4551.4644/ ./ 6052.3252/ ./ 4552.32/ Mobile/ ./ cif/ -/ 0.184/ -/ 0.258/ -/ 0.127/ -/ 0.267/ -/ 0.153/ -/ 0.1022/ ./ 0302.8531/ ./ 4082.9551/ ./ 6941.12428/ ./ 9552.1533/ ./ 6052.7753/ ./ 0752.83/ Stefan/ ./ cif/ -/ 0.186/ -/ 0.266/ -/ 0.133/ -/ 0.241/ -/ 0.169/ -/ 0.1112/ ./ 2093.1801/ ./ 5752.8772/ ./ 0111.31333/ ./ 0151.1941/ ./ 0352.1051/ ./ 9951.79/ 平均/ -/ 0.206/ -/ 0.258/ -/ 0.120/ -/ 0.245/ -/ 0.163/ -/ 0.1012/ ./ 9763.7241/ ./ 7003.5292/ ./ 3611.47733/ ./ 6050.9244/ ./ 3851.7551/ ./ 8351.79/ I4MB/ 预测/ 宏块数/ 分别/ 为/ 1063/ 、/ 2246/ 、/ 6591/ 和/ 1001/ 、/ 表/ 3/ 是/ 各/ 算法/ News/ ./ qcif/ 在/ 量化/ 参数/ 为/ 28/ 和/ 2139/ 、/ 6760/ ,/ 分块/ 方案/ 都/ 比/ 包括/ 文献/ [/ 12/ ]/ 算法/ 在内/ 的/ 32/ 下/ 详细/ 性能/ 比较/ (/ 对应/ 表/ 2/ 的/ 第/ 2/ 行/ )/ ,/ I16MB/ 、/ I8MB/ 、/ I4MB/ 列/ 分别/ 表示/ 采用/ I16MB/ 、/ I8MB/ 、/ I4MB/ 其它/ 算法/ 更/ 接近/ JM/ 全/ 搜索/ 方法/ ./ 其它/ 量化/ 参数/ 下/ 方式/ 进行/ 编码/ 的/ 宏块/ 数量/ ./ 以/ QP/ =/ 28/ 为例/ ,/ 和/ 其它/ 序列/ 下/ 也/ 存在/ 同样/ 的/ 现象/ ,/ 所有/ 算法/ 都/ 由/ RDO/ 选择/ 最优/ 分块/ 策略/ ,/ 这/ 就/ 说明/ 本文/ 采用/ 方向/ 梯/ JM18/ ./ 0/ 分别/ 有/ 990/ 个宏块/ 采用/ I16MB/ 、/ 2326/ 个宏块/ 采用/ I8MB/ 、/ 6584/ 个宏块/ 采用/ I4MB/ 方式/ 进行/ 预度/ 对/ R/ -/ D/ 代价/ 的/ 估计/ 比/ 采用/ 块/ 内/ 纹理/ 检测/ 的/ 方法/ 测/ ,/ 本文/ 基本/ 算法/ 和/ 改进/ 算法/ 采用/ I16MB/ 、/ I8MB/ 、/ 更为/ 准确/ ./ 量化/ 参数/ 方法/ BR/ // (/ KB/ ·/ s/ -/ 1/ )/ PSNR/ // dB/ 平均/ 编码/ 时间/ // (/ ms/ ·/ frame/ -/ 1/ )/ I16MBI8MBI4MB/ 表/ 3News/ ./ qcif/ 编码/ 性能/ 与/ 分块/ 方式/ 比较/ QP/ =/ 28QP/ =/ 325/ 结论/ H/ ./ 264RDO/ 过程/ 计算/ 复杂度/ 很/ 高/ ,/ 本文/ 提出/ 一个/ 基于/ 方向/ 梯度/ 的/ 帧/ 内/ 预测/ 模式/ 选择/ 算法/ ,/ 利用/ 方向/ 梯度/ 检测/ 当前/ 块/ 与/ 邻域/ 之间/ 的/ 纹理/ 方向/ 与/ 边缘/ 强度/ ,/ 在/ R/ -/ D/ 代价/ 计算/ 前/ 筛除/ 方向/ 梯度/ 较大/ 的/ 预测/ 模式/ ,/ 降低/ 了/ RDO/ 的/ 复杂度/ ./ 同时/ ,/ 本文/ 利用/ 预测/ 模式/ 的/ 邻域/ 空间/ 相关性/ ,/ 用/ MPM/ 取代/ DC/ 模式/ 作为/ 缺省/ 候选/ 模式/ 对/ 基本/ 算法/ 进行/ 了/ 改进/ ,/ 提高/ 了/ 算法/ 的/ 编码/ 性能/ ./ 实验/ 结果表明/ ,/ 提出/ 的/ 基本/ 算法/ 和/ 改进/ 算法/ 应用/ 在/ 亮度/ 分量/ 帧/ 内/ 预测/ 模式/ 选择/ 中/ ,/ 与/ JM18/ ./ 0/ 全/ 搜索/ 方式/ 相比/ 都/ 减少/ 了/ 超过/ 50/ %/ 的/ 编码/ Δ/ BR/ // %/ 文献/ [/ 12/ ]/ 文献/ [/ 11/ ]/ 时间/ ,/ 同时/ 较/ 好/ 地/ 保持/ 了/ 编码/ 性能/ ./ 对/ 10/ 个/ 标准/ 序列/ 进行/ 测试/ ,/ 保持/ 与/ JM18/ ./ 0/ 全/ 搜索/ 方式/ 相同/ 的/ 亮度/ 分量/ PSNR/ ,/ 基本/ 算法/ 码率/ 平均/ 上升/ 2.361/ %/ ,/ 改进/ 算法/ 码率/ 平均/ 上升/ 1.477/ %/ ,/ 较为/ 明显/ 地/ 优于/ 其它/ 采用/ 块/ 内/ 纹理/ 检测/ 的/ 方法/ ./ 

