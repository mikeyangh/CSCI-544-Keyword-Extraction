Page1/ 一种/ 基于/ 随机/ Petri/ 网/ 的/ Web/ 服务/ 组合/ 性能/ 瓶颈/ 定位/ 策略/ 何炎祥/ 1/ )/ ,/ 2/ )/ 沈华/ 1/ )/ ,/ 3/ )/ 1/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430079/ )/ 2/ )/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430072/ )/ 3/ )/ (/ 湖北/ 工业/ 大学/ 计算机/ 学院/ 武汉/ 430068/ )/ 摘要/ Web/ 服务/ 组合/ 的/ 性能/ 对/ 推动/ 以/ 服务/ 为/ 核心/ 的/ 价值链/ 的/ 良性/ 融合/ 起着/ 重要/ 作用/ ./ 针对/ 如何/ 有效/ 发现/ Web/ 服务/ 组合/ 中/ 性能/ 瓶颈/ 的/ 问题/ ,/ 提出/ 一种/ 基于/ 随机/ Petri/ 网/ 的/ Web/ 服务/ 组合/ 性能/ 分析模型/ ,/ 根据/ 库所/ 和/ 变迁/ 之间/ 的/ 直接/ 关系/ 总结/ 出/ 模型/ 的/ 4/ 种/ 基本/ 结构/ ,/ 通过/ 结构/ 转换/ 得到/ 性能/ 瓶颈/ 定位/ 分析/ 结构/ 集/ {/ 顺序/ 结构/ ,/ 分支/ 结构/ ,/ 汇聚/ 结构/ }/ ,/ 在/ 此基础/ 上/ 提出/ 一种/ Web/ 服务/ 组合/ 性能/ 瓶颈/ 定位/ 策略/ ./ 该/ 策略/ 首先/ 根据/ 库所中/ token/ 消耗/ 的/ 速度/ 将库/ 所/ 分成/ 主动/ 受阻/ 库所/ 、/ 被动/ 受阻/ 库所/ 和/ 流通/ 库所/ 3/ 类/ ,/ 然后/ 分别/ 基于/ 3/ 类库/ 所在/ 3/ 种/ 分析/ 结构/ 中/ 的/ 不同/ 分布/ 情况/ ,/ 通过/ 顺向/ 结构/ 分析/ 和/ 逆向/ 结构/ 分析/ 相结合/ 的/ 方法/ ,/ 讨论/ 瓶颈/ 可能/ 存在/ 的/ 位置/ ,/ 并/ 给出/ 如何/ 确定/ 3/ 种/ 分析/ 结构/ 的/ 结构/ 发现/ 定理/ ./ 实验/ 证明/ 策略/ 的/ 预测/ 结果/ 是/ 有效/ 的/ ./ 关键词/ 随机/ Petri/ 网/ ;/ Web/ 服务/ ;/ Web/ 服务/ 组合/ ;/ 性能/ 瓶颈/ ;/ 瓶颈/ 定位/ 1/ 引言/ 通过/ 协调/ 组织/ 多个/ Web/ 服务/ 之间/ 的/ 交互/ ,/ 服务/ 组合/ 提供/ 了/ 更为/ 强大/ 的/ 服务/ 功能/ ,/ 并且/ 有效/ 加快/ 系统/ 开发/ 的/ 速度/ ,/ 快速/ 满足用户/ 需求/ [/ 1/ ]/ ./ Web/ 服务/ 组合/ 的/ 本质/ 是/ 通过/ 若干/ Web/ 服务/ 间/ 的/ 相互/ 通信/ 和/ 协作/ 灵活/ 实现/ 上层/ 业务/ 需求/ ,/ 并/ 能够/ 屏蔽/ 底层/ 实现/ 技术/ 的/ 变迁/ 对/ 上层/ 产生/ 的/ 影响/ ./ Web/ 服务/ 组合/ 是/ 面向/ 服务/ 架构/ (/ Service/ -/ OrientedArchitecture/ ,/ SOA/ )/ 中/ 构建/ 新/ 服务/ 和/ 满足/ 业务/ 需求/ 的/ 主要/ 手段/ ,/ 在/ 业务流程/ 的/ 构造/ 和/ 重组/ 中/ 处于/ 核心/ 地位/ ,/ 因此/ Web/ 服务/ 组合/ 的/ 性能/ 及其/ 评价/ 方法/ 对/ SOA/ 的/ 发展/ 至关重要/ ./ 目前/ 一些/ 关于/ Web/ 服务/ 组合/ 性能/ 评价/ 的/ 研究/ 采用/ 的/ 是/ 基于/ 模型/ 的/ 方法/ ,/ 首先/ 为/ Web/ 服务/ 组合/ 系统/ 建立/ 一个/ 合适/ 的/ 模型/ ,/ 然后/ 求/ 出/ 模型/ 的/ 各项/ 性能指标/ ,/ 最后/ 根据/ 得到/ 的/ 性能指标/ 对模型/ 进行/ 性能/ 评估/ ./ 目前/ 广泛/ 采用/ 的/ 建模/ 工具/ 有/ 进程/ 代数/ [/ 2/ -/ 7/ ]/ 、/ Pi/ 演算/ [/ 8/ -/ 9/ ]/ 、/ 自动机/ 理论/ [/ 10/ -/ 11/ ]/ 、/ 排队/ 论/ [/ 12/ -/ 13/ ]/ 、/ Petri/ 网/ [/ 14/ -/ 18/ ]/ 等/ ./ 文献/ [/ 19/ ]/ 提出/ 一种/ 代价/ 概率/ 进程/ 代数/ PPPA/ 并/ 用于/ Web/ 服务/ 组合/ 建模/ ,/ 以/ 支持/ Web/ 服务/ 组合/ 的/ 功能/ 、/ 可靠性/ 、/ 性能/ 和/ 代价/ 的/ 建模/ 和/ 分析/ ./ 文献/ [/ 20/ ]/ 针对/ 工作/ 流网/ 提出/ 了/ 一种/ 性能/ 建模/ 和/ 分析/ 的/ 方法/ ./ 该/ 文献/ 提出/ 了/ 包含/ 时间/ 、/ 结构/ 和/ 资源/ 等/ 多维度/ 信息/ 的/ 工作/ 流/ 网络/ 概念/ ,/ 将/ 无环/ 自由选择/ 工作/ 流/ 网络/ 分解/ 为/ 一组/ 变迁/ 组件/ 集/ 的/ 算法/ 进行/ 扩展/ ,/ 使得/ 该/ 算法/ 能够/ 处理/ 包含/ 循环/ 结构/ 的/ 时间/ 工作/ 流网/ ./ 利用/ 连续/ 时间/ 马尔可夫/ 链/ 对/ 资源/ 的/ 可用性/ 进行/ 分析/ ,/ 并且/ 通过/ 服务/ 到达/ 的/ 平均/ 速率/ 和/ 服务/ 速率/ 分析/ 出/ 工作/ 流中/ 可能/ 存在/ 的/ 瓶颈/ ./ 文献/ [/ 21/ ]/ 提出/ 了/ 一个/ e/ -/ business/ 系统/ 的/ 通用/ 队列/ 模型/ ,/ 该/ 模型/ 可以/ 捕捉到/ 大多数/ e/ -/ business/ 系统/ 的/ 行为/ 特征/ ./ 文献/ 在/ 该/ 模型/ 的/ 基础/ 上/ 提出/ 了/ 一种/ 近似/ 分析/ 算法/ ,/ 该/ 算法/ 的/ 近似/ 解/ 可以/ 用来/ 在/ 给定/ 或/ 假设/ 的/ 负载/ 条件/ 下/ 预测/ 系统/ 的/ 性能/ ,/ 同时/ 能够/ 为/ 特定/ 性能指标/ 选择/ 最优/ 的/ 控制参数/ 配置/ ./ 文献/ [/ 22/ ]/ 利用网络/ 演算/ 的/ 概念/ 提出/ 了/ 一种/ 形式化/ 最坏/ 情况/ 下/ 的/ 演算/ 模型/ ./ 网络/ 演算/ 是/ 为了/ 研究/ 确定性/ 排队/ 系统/ 所/ 提出/ 的/ 一种/ 系统/ 理论/ ,/ 文献/ [/ 22/ ]/ 利用/ 该/ 理论/ 来/ 描述/ 在/ 最坏/ 情况/ 下/ 工作/ 流/ 的/ 行为/ 特征/ ,/ 根据/ 对/ 行为/ 特征/ 的/ 分析/ 来/ 预先/ 规划/ 工作/ 流/ 的/ 控制流/ ./ 文献/ [/ 23/ ]/ 利用/ 高级/ 面向对象/ Petri/ 网/ (/ AdvancedObject/ -/ OrientedPetriNet/ ,/ AOOPN/ )/ 对/ Web/ 服务/ 组合/ 进行/ 建模/ ,/ 并/ 对/ 其/ 进行/ 安全性/ 、/ 活性/ 、/ 可达性/ 、/ 有界性/ 等/ 方面/ 的/ 评估/ ./ 文献/ [/ 24/ ]/ 为了/ 分析/ 多层次/ 互联网/ 应用/ 的/ 行为/ 特征/ ,/ 提出/ 了/ 一种/ 基于/ 闭合/ 队列/ 网络/ 的/ 分析模型/ ,/ 模型/ 中/ 的/ 每个/ 队列/ 分别/ 对应/ 于/ 应用/ 的/ 不同/ 层次/ ,/ 根据/ 模型/ 捕捉到/ 的/ 各层次/ 的/ 行为/ 特征/ ,/ 可以/ 对/ 该/ 互联网/ 应用/ 进行/ 性能/ 预测/ 、/ 应用程序/ 配置/ 以及/ 瓶颈/ 定位/ ./ 文献/ [/ 25/ ]/ 利用/ 统计/ 技术/ 和/ Petri/ 网为/ 服务/ 组合/ 的/ 可信性/ 提出/ 了/ 一种/ 评估/ 方法/ ./ 每个/ Web/ 服务/ 的/ 可信性/ 可以/ 通过/ 分析/ 它们/ 以往/ 的/ 执行/ 情况/ 进行/ 评估/ ,/ 组合/ 服务/ 的/ 可信性/ 评估/ 则/ 通过/ 分析/ 每个/ Web/ 服务/ 的/ 评价/ 结果/ 和/ 组合/ 服务/ 的/ 组合/ 拓扑/ 来/ 得到/ ./ 文献/ [/ 26/ ]/ 在/ 排队/ Petri/ 网/ 的/ 系统/ 模型/ 框架/ 上/ 采用/ 图形化/ 的/ 方式/ 完成/ 服务/ 系统/ 的/ 性能/ 建模/ 和/ 分析/ ./ 文献/ [/ 27/ ]/ 首先/ 用/ 随机/ Petri/ 网/ (/ StochasticPetriNet/ ,/ SPN/ )/ 对/ Web/ 服务/ 流/ 进行/ 建模/ ,/ 然后/ 对/ Web/ 服务/ 流/ 的/ 5/ 种/ 基本/ 结构/ (/ 顺序/ sequential/ 、/ 并行/ parallel/ 、/ 条件/ conditional/ 、/ 循环/ loop/ 和/ 互斥/ mutex/ )/ 提出/ 了/ 一组/ 化简/ 规则/ ,/ 并/ 在/ 5/ 种/ 结构/ 简化/ 的/ 过程/ 中/ 讨论/ 了/ 它们/ 的/ 性能/ 分析/ ./ 文献/ [/ 28/ ]/ 为/ 基于/ SPN/ 的/ 工作/ 流/ 系统/ 的/ 顺序/ 、/ 并行/ 、/ 选择/ 和/ 循环/ 4/ 种/ 基本/ 结构/ 提出/ 了/ 一组/ 性能/ 等价/ 公式/ ,/ 通过/ 这些/ 等价/ 公式/ 可以/ 对/ 复杂/ 工作/ 流/ 系统/ 进行/ 性能/ 的/ 定量分析/ ./ 本文/ 首先/ 提出/ 一种/ 基于/ SPN/ 的/ Web/ 服务/ 组合/ Page3/ 性能/ 分析模型/ WSCPAM/ (/ WebServicesCompositionPerformanceAnalysisModel/ )/ ./ WSCPAM/ 实质/ 上/ 是/ 满足/ 某些/ 约束条件/ 的/ SPN/ ,/ 这些/ 约束条件/ 来自/ 于/ Web/ 服务/ 与/ 服务/ 请求/ 之间/ 固有/ 的/ 特征/ ./ 从/ 图论/ 的/ 角度/ 重新认识/ WSCPAM/ ,/ 会/ 发现/ 模型/ 中/ 两类/ 顶点/ (/ 库所/ 和/ 变迁/ )/ 之间/ 存在/ 4/ 种/ 直接/ 关系/ ,/ 4/ 种/ 直接/ 关系/ 之间/ 的/ 不同/ 复合/ 可以/ 表示/ 出/ Web/ 服务/ 的/ 各种/ 组合/ 方式/ ./ 结构/ 即/ 关系/ ,/ 将/ 两类/ 顶点/ 间/ 的/ 4/ 种/ 直接/ 关系/ 称为/ WSCPAM/ 的/ 4/ 种/ 基本/ 结构/ ./ 对/ 4/ 种/ 基本/ 结构/ 进行/ 结构/ 转换/ 生成/ 瓶颈/ 定位/ 分析/ 结构/ 集/ {/ 顺序/ 结构/ ,/ 分支/ 结构/ ,/ 汇聚/ 结构/ }/ ./ 在/ 分析/ 结构/ 集/ 的/ 基础/ 上/ 提出/ 一种/ Web/ 服务/ 组合/ 性能/ 瓶颈/ 定位/ 策略/ BNL/ -/ WSCPAM/ (/ BottleNeckLocationinWSCPAM/ )/ ./ BNL/ -/ WSCPAM/ 的/ 主要/ 思想/ 是/ ,/ 根据/ 库所中/ token/ 消耗/ 的/ 速度/ 将库/ 所/ 分成/ 主动/ 受阻/ 库所/ 、/ 被动/ 受阻/ 库所/ 和/ 流通/ 库所/ 3/ 类/ ,/ 然后/ 分别/ 对/ 分析/ 结构/ 集中/ 的/ 结构/ 进行/ 性能/ 瓶颈/ 预测/ 分析/ ,/ 并/ 针对/ 3/ 类库/ 所在/ 结构/ 中/ 的/ 所有/ 可能/ 分布/ ,/ 通过/ 顺向/ 结构/ 分析/ 和/ 逆向/ 结构/ 分析/ 相结合/ 的/ 方法/ 对/ 结构/ 中/ 所有/ 可能/ 存在/ 的/ 性能/ 瓶颈/ 进行/ 讨论/ ./ 最后/ 根据/ 讨论/ 得到/ 的/ 抽象/ 算法/ 生成/ 实现/ 算法/ ,/ 开发/ 相应/ 的/ 软件工具/ ,/ 并/ 给出/ 测试用例/ 说明/ BNL/ -/ WSC/ -/ PAM/ 预测/ 结果/ 的/ 有效性/ ./ 本文/ 第/ 2/ 节/ 给出/ 基于/ SPN/ 的/ 性能/ 分析模型/ WSCPAM/ 的/ 定义/ 以及/ 对/ WSCPAM/ 的/ 结构/ 分析/ ,/ 得到/ 用于/ 瓶颈/ 定位/ 的/ 结构/ 分析/ 集/ ;/ 第/ 3/ 节是/ 对/ BNL/ -/ WSCPAM/ 策略/ 的/ 详细描述/ ,/ 给出/ 性能/ 瓶颈/ 定位/ 预测/ 的/ 抽象/ 算法/ ;/ 第/ 4/ 节/ 讨论/ 抽象/ 算法/ 中/ 用到/ 的/ 顺向/ 结构/ 分析/ 和/ 逆向/ 结构/ 分析方法/ ,/ 并/ 给出/ 结构/ 发现/ 定理/ ./ 结构/ 发现/ 定理/ 解决/ 了/ 如何/ 确定/ 输入/ 算法/ 的/ 结构/ 是/ 结构/ 分析/ 集中/ 的/ 哪种/ 结构/ 的/ 问题/ ;/ 第/ 5/ 节/ 给出/ 一个/ 实例/ 说明/ BNL/ -/ WSCPAM/ 策略/ 预测/ 结果/ 的/ 有效性/ ;/ 第/ 6/ 节/ 总结/ 本文/ 的/ 工作/ ./ 2WSCPAM/ 模型/ 及/ 结构/ 分析/ 2.1/ WSCPAM/ 模型/ 2.1/ ./ 1/ 建模/ 工具/ SPN/ 有/ 两种/ 形式/ [/ 28/ ]/ :/ Molloy/ 形式/ 和/ Florin/ -/ Natkin/ 形式/ ,/ 本文/ 采用/ 的/ 是/ Molloy/ 连续/ 时间/ SPN/ ./ 其/ 定义/ 如下/ ./ 定义/ 1/ ./ 连续/ 时间/ SPN/ [/ 28/ ]/ ./ 一个/ 四元组/ N/ =/ (/ S/ ,/ T/ ;/ F/ ;/ M0/ )/ ,/ 其中/ S/ 为库/ 所集/ ,/ T/ 为/ 变迁/ 集/ ,/ N/ 是/ 一个/ 连续/ 时间/ SPN/ 当且/ 仅/ 当/ 满足/ :/ (/ 1/ )/ S/ ∪/ T/ ≠/ / ;/ (/ 2/ )/ S/ ∩/ T/ =/ / ;/ (/ 3/ )/ F/ / (/ S/ ×/ T/ )/ ∪/ (/ T/ ×/ S/ )/ ;/ (/ 4/ )/ M0/ 为/ 初始/ 标识/ ;/ (/ 5/ )/ dom/ (/ F/ )/ ∪/ cod/ (/ F/ )/ =/ S/ ∪/ T/ ;/ (/ 6/ )/ / t/ ∈/ T/ 的/ 可/ 实施/ 时刻/ 到/ 实施/ 时刻/ 之间/ 的/ 时间/ 间隔/ 被/ 看成/ 是/ 一个/ 连续/ 随机变量/ xt/ (/ 取正实/ 数值/ )/ ,/ 且/ 服从/ 分布/ 函数/ Ft/ (/ x/ )/ =/ P/ (/ xt/ / x/ )/ =/ 1/ -/ e/ -/ λ/ tx/ ,/ 其中/ 实/ 参数/ λ/ t/ >/ 0/ 是/ 变迁/ t/ 的/ 平均/ 实施/ 速率/ ,/ 变量/ x/ / 0/ ./ 定义/ 2/ ./ 变迁/ 的/ 前置/ 集/ 和/ 后置/ 集/ [/ 28/ ]/ ./ 对于/ / t/ ∈/ T/ ,/ t/ 的/ 前置/ 集记/ 为/ ·/ t/ ,/ 其/ 定义/ 为/ ·/ t/ =/ {/ s/ |/ (/ s/ ,/ t/ )/ ∈/ F/ }/ ;/ t/ 的/ 后置/ 集记/ 为/ t/ ·/ ,/ 其/ 定义/ 为/ t/ ·/ =/ {/ s/ |/ (/ t/ ,/ s/ )/ ∈/ F/ }/ ./ 定义/ 3/ ./ 库所/ 的/ 前置/ 集/ 和/ 后置/ 集/ [/ 28/ ]/ ./ 对于/ / s/ ∈/ S/ ,/ s/ 的/ 前置/ 集记/ 为/ ·/ s/ ,/ 其/ 定义/ 为/ ·/ s/ =/ {/ t/ |/ (/ t/ ,/ s/ )/ ∈/ F/ }/ ;/ s/ 的/ 后置/ 集记/ 为/ s/ ·/ ,/ 其/ 定义/ 为/ s/ ·/ =/ {/ t/ |/ (/ s/ ,/ t/ )/ ∈/ F/ }/ ./ 定义/ 4/ ./ 起始/ 库所/ 和/ 终止/ 库所/ ./ 如果/ / s/ ∈/ S/ (/ |/ ·/ s/ |/ =/ 0/ )/ ,/ 则/ 库/ 所/ s/ 是/ 一个/ 起始/ 库所/ ;/ 如果/ / s/ ∈/ S/ (/ |/ s/ ·/ |/ =/ 0/ )/ ,/ 则/ 库/ 所/ s/ 是/ 一个/ 终止/ 库所/ ./ 2.1/ ./ 2/ 模型/ 描述/ 在/ 本文/ 提出/ 的/ Web/ 服务/ 组合/ 性能/ 分析模型/ WSCPAM/ (/ WebServicesCompositionPerformanceAnalysisModel/ )/ 中/ ,/ Web/ 服务/ 或子/ Web/ 服务/ 组合/ 用/ 变迁/ 表示/ ,/ 变迁/ 的/ 前置/ 库所/ (/ 也/ 称为/ 输入/ 库所/ )/ 存放/ 对/ 该/ 变迁/ 的/ 请求/ 队列/ ,/ 变迁/ 的/ 后置/ 库所/ (/ 也/ 称为/ 输出/ 库所/ )/ 存放/ 的/ 是/ 该/ 变迁/ 对/ 某个/ 后置/ 变迁/ 的/ 服务/ 请求/ ,/ 且/ 请求/ 队列/ 的/ 长度/ 不限/ ./ 换句话说/ ,/ 两个/ 变迁/ 之间/ 的/ 库/ 所/ 相当于/ 一个/ 生产者/ 一个/ 消费者/ 问题/ 中/ 容量/ 不限/ 的/ 缓冲/ 池/ ,/ 两个/ 变迁/ 则/ 分别/ 作为/ 生产者/ 和/ 消费者/ ,/ 如图/ 1/ 所示/ ./ 从图/ 1/ 可以/ 看出/ ,/ 变迁/ ti/ 执行/ 完成/ 后/ 将/ 对/ tj/ 的/ 服务/ 请求/ 发送到/ 库所/ sij/ 的/ 过程/ 相当于/ 生产者/ 将/ 产品/ 放入/ 缓冲/ 池/ ;/ 如果/ sij/ 有/ token/ ,/ 则/ 变迁/ tj/ 可以/ 开始/ 执行/ 并/ 消耗/ sij/ 中/ 的/ 一个/ token/ ,/ 这/ 相当于/ 消费者/ 从/ 非空/ 缓冲/ 池中/ 取出/ 一个/ 产品/ 进行/ 消费/ ./ 显然/ 一个/ 缓冲/ 池/ 对应/ 一对/ 生产者/ -/ 消费者/ ,/ 因此/ 一个/ 库所/ 对应/ 一个/ 变迁/ 序偶/ 对/ ;/ 又/ 由于/ 起始/ 库所/ 和/ 终止/ 库所/ 的/ 存在/ ,/ 故对/ 每个/ 库所/ 而言/ ,/ 它/ 需要/ 满足/ 如下/ 约束条件/ :/ 此外/ ,/ 在/ Web/ 服务/ 组合/ 逻辑/ 中/ 不/ 存在/ 服务/ 的/ 自/ Page4/ 我/ 请求/ ,/ 即/ 在/ WSCPAM/ 中/ 不/ 存在/ 图/ 2/ 所示/ 的/ 循环/ 结构/ ./ 如果/ 存在/ 图/ 2/ 所示/ 循环/ 结构/ ,/ 则/ 意味着/ 一个/ 服务/ 的/ 开始/ 执行/ 依赖于/ 它/ 自身/ 的/ 执行/ 结束/ ,/ 这/ 有悖于/ 常理/ ,/ 因此/ 在/ WSCPAM/ 中/ 不/ 可能/ 存在/ “/ one/ 变迁/ one/ 库所/ 循环/ 结构/ ”/ ./ 换句话说/ ,/ 在/ WSCPAM/ 中/ 任一/ 库所/ 和/ 任一/ 变迁/ 之间/ 最/ 多只/ 存在/ 一条/ 弧/ ./ 图/ 2/ 所示/ 的/ 循环/ 结构/ 可以/ 形式化/ 描述/ 为/ / s/ ∈/ S/ ,/ / t/ ∈/ T/ (/ (/ s/ ,/ t/ )/ ∈/ F/ ∧/ (/ t/ ,/ s/ )/ ∈/ F/ )/ ,/ 因此/ 要/ 使得/ 模型/ 中/ 不/ 存在/ 上述/ 循环/ 结构/ ,/ WSCPAM/ 必须/ 满足/ 下述/ 条件/ :/ / s/ ∈/ S/ ,/ / t/ ∈/ T/ (/ (/ (/ s/ ,/ t/ )/ ∈/ F/ ∧/ (/ t/ ,/ s/ )/ / F/ )/ ∨/ (/ (/ s/ ,/ t/ )/ / F/ ∧/ (/ t/ ,/ s/ )/ ∈/ F/ )/ )/ 因为/ 且/ 由式/ (/ 1/ )/ 可知/ :/ 假设/ |/ t/ ·/ |/ ∩/ |/ ·/ t/ |/ ≠/ / ,/ 则/ 有/ / s/ ∈/ S/ (/ s/ ∈/ |/ ·/ t/ |/ ∩/ |/ t/ ·/ |/ )/ / (/ s/ ,/ t/ )/ ∈/ F/ ∧/ (/ t/ ,/ s/ )/ ∈/ F/ ,/ 与/ 式/ (/ 2/ )/ 矛盾/ ,/ 所以/ 假设/ 不/ 成立/ ,/ 即/ 故式/ (/ 2/ )/ 与/ 下述/ 条件/ 等价/ :/ 综上所述/ ,/ WSCPAM/ 就是/ 满足/ 约束条件/ 式/ (/ 1/ )/ 和/ 式/ (/ 3/ )/ 的/ SPN/ ./ 定义/ 5/ ./ WSCPAM/ 模型/ ./ WSCPAM/ 是/ 一个/ 同时/ 满足/ 以下/ 两个/ 约束条件/ 的/ SPN/ ./ 约束条件/ 1/ ./ 约束条件/ 2/ ./ (/ / s/ ∈/ S/ (/ ·/ s/ ∩/ s/ ·/ =/ / )/ )/ ∧/ (/ / t/ ∈/ T/ (/ ·/ t/ ∩/ t/ ·/ =/ / )/ )/ ./ 2.24/ 种/ 基本/ 结构/ 根据/ 2.1/ 节中/ 的/ 定义/ 1/ 和/ 定义/ 5/ 可知/ :/ 在/ WSCPAM/ 中/ 存在/ 两类/ 顶点/ (/ 库所/ ,/ 变迁/ )/ 、/ 两类/ 弧/ (/ 库所/ →/ 变迁/ ,/ 变迁/ →/ 库所/ )/ ./ 定义/ 6/ ./ 基本/ 结构/ ./ 基本/ 结构/ 是/ 指库/ 所/ 与/ 变迁/ 之间/ 的/ 直接/ 关系/ ,/ 即库/ 所/ 与/ 变迁/ 之间/ 的/ 一步/ 关系/ ./ 换句话说/ ,/ 基本/ 结构/ 描述/ 了/ 库/ 所/ 和/ 变迁/ 之间/ 的/ 一种/ 原子/ 关系/ ./ WSCPAM/ 中/ 有如/ 图/ 3/ 所示/ 的/ 4/ 种/ 基本/ 结构/ ./ 4/ 种/ 基本/ 结构/ 是/ 模型/ 中/ 粒度/ 最小/ 的/ 结构/ ,/ 模型/ 中/ 的/ 任何/ 一个/ 结构/ 均/ 可/ 由/ 这/ 4/ 种/ 基本/ 结构/ 构造/ 得到/ ./ 因此/ 可以/ 从/ 有限/ 基本/ 结构/ 开始/ 对模型/ 的/ 结构/ 进行/ 归纳/ 分析/ ,/ 预测出/ 瓶颈/ 可能/ 存在/ 的/ 位置/ ./ 2.3/ 结构/ 分析/ 集由/ 4/ 种/ 基本/ 结构/ 经过/ 两/ 两/ 复合/ ,/ 可以/ 得到/ 如图/ 4/ 所示/ 的/ 复合/ 结构/ ./ 对图/ 4/ 所示/ 的/ 8/ 种/ 简单/ 复合/ 结构/ 做/ 如图/ 5/ 所示/ 的/ 5/ 种/ 结构/ 转换/ ./ 通过观察/ 图/ 5/ 所示/ 的/ 转换/ 结果/ ,/ 可以/ 发现/ ,/ WSCPAM/ 的/ 复合/ 结构/ 一定/ 包含/ 图/ 4/ (/ a/ )/ 和/ 图/ 4/ (/ b/ )/ 所示/ 的/ 顺序/ 结构/ (/ SequenceStructure/ )/ ,/ 图/ 4/ (/ c/ )/ 所示/ 的/ 分支/ 结构/ (/ SplitStructure/ )/ 和/ 图/ 4/ (/ e/ )/ 所示/ 的/ 汇聚/ 结构/ (/ JoinStructure/ )/ ./ 因此/ ,/ {/ 顺序/ 结构/ ,/ 分支/ 结构/ ,/ 汇聚/ 结构/ }/ 构成/ 了/ WSCPAM/ 的/ 结构/ 分析/ 集/ ./ 本文/ 对/ WSCPAM/ 基于/ 结构/ 的/ 瓶颈/ 定位/ 分析/ 策略/ BNL/ -/ WSCPAM/ 就是/ 建立/ 在/ 此/ 结构/ 分析/ 集/ 之上/ 的/ ./ Page5/ 图/ 5WSCPAM/ 的/ 简单/ 复合/ 结构/ 的/ 结构/ 转换/ 3BNL/ -/ WSCPAM/ 策略/ 描述/ 3.1/ 相关/ 概念/ 定义/ 7/ ./ token/ 概率密度函数/ [/ 28/ ]/ ./ 在/ 稳定/ 状态/ 下/ ,/ 每个/ 库所中/ 所/ 包含/ 的/ token/ 数量/ 的/ 概率/ ./ 对/ / s/ ∈/ S/ ,/ / i/ ∈/ N/ ,/ 令/ P/ [/ M/ (/ s/ )/ =/ i/ ]/ 表示/ 位置/ s/ 中/ 包含/ i/ 个/ token/ 的/ 概率/ ,/ 则/ 可/ 从/ 标识/ 的/ 稳定/ 概率/ 求得/ 库所/ s/ 的/ token/ 概率函数/ 为/ 其中/ Mj/ ∈/ [/ M0/ 〉/ ,/ 且/ Mj/ (/ s/ )/ =/ i/ ./ 定义/ 8/ ./ 库所中/ 的/ 平均/ token/ 数/ [/ 28/ ]/ ./ 对于/ / si/ ∈/ i/ 表示/ 在/ 稳定/ 状态/ 下库/ 所/ si/ 在/ 任一/ 可/ 达/ 标识/ 中平/ S/ ,/ u/ -/ 均/ 所/ 含/ token/ 数/ ,/ 则/ 有/ u/ -/ 定义/ 9/ ./ 平均/ 消耗/ 时延/ ./ 对应/ 每个/ 库所/ 设置/ 一个/ 参数/ τ/ i/ ,/ 称为/ “/ 平均/ 消耗/ 时延/ ”/ ,/ 其/ 定义/ 如下/ :/ i/ 是/ 库/ 所/ si/ 所含/ 的/ 平均/ token/ 数/ ,/ λ/ i/ 是/ 库/ 所/ si/ 后/ 其中/ u/ -/ 继/ 变迁/ ti/ 的/ 平均/ 实施/ 速率/ ,/ Δ/ 是/ 影响/ 因子/ ./ 显然/ ,/ 在/ 变迁/ 始终/ 处于/ 可/ 实施/ 的/ 假设/ 条件/ 下/ ,/ τ/ ii/ 与/ λ/ i/ 的/ 比值/ ;/ 但/ 在/ 实际/ 情况/ 中/ 变迁/ ti/ 并/ 不/ 总/ 等于/ u/ -/ 是/ 处于/ 可/ 实施/ 状态/ ,/ 因此/ τ/ i/ 还/ 受到/ 变迁/ 可/ 实施/ 度/ 的/ 影响/ ,/ 我们/ 把/ 可/ 实施/ 度/ 对/ τ/ i/ 的/ 影响/ 用/ “/ 影响/ 因子/ ”/ 来/ 表示/ ./ 定义/ 10/ ./ 变迁/ 的/ 可/ 实施/ 度/ ./ 变迁/ ti/ 可/ 实施/ 度/ fi/ 的/ 定义/ 如下/ :/ 容易/ 发现/ ,/ 可/ 实施/ 度为/ 0/ 对/ τ/ i/ 的/ 影响/ 最大/ ,/ 可能/ 导致/ τ/ i/ 趋于/ 无穷大/ ;/ 可/ 实施/ 度不为/ 0/ ,/ 其值/ 越大/ 意味着/ 待/ 变迁/ ti/ 消耗/ 的/ token/ 越多/ ,/ 则/ 对/ τ/ i/ 的/ 影响/ 也/ 越/ 大/ ./ 定义/ 11/ ./ 影响/ 因子/ ./ 基于/ 上述/ 特点/ ,/ 影响/ 因子/ Δ/ 定义/ 如下/ :/ 其中/ ω/ 表示/ 一个/ 足够/ 大/ 的/ 数/ ,/ 显然/ 有/ limn/ →/ 又/ 有/ n2n/ =/ 0/ ,/ limn/ →/ 易知/ ,/ 故将式/ (/ 7/ )/ 代入/ 式/ (/ 8/ )/ :/ Page6/ 定义/ 12/ ./ 非/ 终止/ 库所集/ 和/ 终止/ 库所集/ ./ 根据/ 库所/ 的/ 后置/ 变迁/ 集/ 是否/ 为空/ ,/ 将库/ 所集/ S/ 分为/ 两类/ :/ 非/ 终止/ 库所集/ S/ ·/ 和/ 终止/ 库所集/ S/ =/ ./ 其/ 定义/ 为/ 定义/ 13/ ./ 主动/ 受阻/ 库所集/ ,/ 被动/ 受阻/ 集/ 和/ 流通/ 库所集/ ./ 为了/ 便于/ 分析/ ,/ 根据/ τ/ i/ 的/ 值/ 将/ 非/ 终止/ 库所集/ S/ ·/ 分为/ 3/ 个/ 互补/ 相交/ 的/ 子集/ :/ 主动/ 受阻/ 库所集/ S/ ^/ 、/ 被动/ 受阻/ 集/ S/ ⌒/ 和/ 流通/ 库所集/ S/ ·/ ·/ ./ 其/ 定义/ 如下/ :/ S/ ^/ =/ si/ |/ si/ ∈/ S/ ·/ &&/ τ/ i/ →/ ω/ &&/ u/ -/ S/ ⌒/ =/ si/ |/ si/ ∈/ S/ ·/ &&/ τ/ i/ →/ ω/ &&/ u/ -/ S/ ·/ ·/ =/ si/ |/ si/ ∈/ S/ ·/ &&/ / (/ τ/ i/ →/ ω/ 显然/ 有/ 定义/ 14/ ./ 库所/ 流集/ 和/ 变迁/ 流集/ ./ 用/ 符号/ ES/ 表示/ 库所/ 流集/ ,/ 用/ 符号/ ET/ 表示/ 变迁/ 流集/ ,/ 它们/ 的/ 定义/ 分别/ 为/ 定义/ 15/ ./ 库所/ 的/ 直接/ 后继/ // 前驱/ 库所/ ./ 库所/ si/ 的/ 直接/ 后继/ 库所/ si/ / 定义/ 为库/ 所/ si/ 的/ 直接/ 前驱/ 库所/ / si/ 定义/ 为/ 定义/ 16/ ./ 顺向/ 结构/ 分析/ ,/ 逆向/ 结构/ 分析/ ./ 顺向/ 结构/ 分析/ (/ DownArcAnalysis/ )/ ,/ 也/ 称为/ 前向/ 结构/ 分析/ ,/ 是/ 指/ 沿着/ 弧/ (/ 或流/ )/ 的/ 方向/ 进行/ 分析/ ;/ 逆向/ 结构/ 分析/ (/ ReverseArcAnalysis/ )/ 是/ 指逆着/ 弧/ (/ 或流/ )/ 的/ 方向/ 进行/ 分析/ ./ 3.2/ 主要/ 算法/ 描述/ 算法/ 1/ ./ 瓶颈/ 定位/ 策略/ BNL/ -/ WSCPAM/ ./ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 求非/ 终止/ 库所集/ S/ ·/ 和/ 终止/ 库所集/ S/ =/ ;/ 2/ ./ 求出/ 非/ 终止/ 库所集/ S/ ·/ 中/ 所有/ 库所/ 的/ 平均/ 消耗/ 时延/ τ/ i/ ;/ 3/ ./ 根据/ τ/ i/ 的/ 大小/ 和/ 定义/ 13/ 将/ 非/ 终止/ 库所集/ S/ ·/ 分成/ 3/ 个/ 不/ 相交/ 集/ S/ ^/ 、/ S4/ ./ 如果/ S/ ⌒/ 非空/ ,/ 则/ 执行/ 步/ 5/ ;/ 否则/ 执行/ 步/ 6/ ;/ 5/ ./ 依次/ 以/ S/ ⌒/ 的/ 库/ 所/ 作为/ 始点/ 进行/ 结构/ 分析/ ,/ 得出/ 预估/ 瓶颈/ 的/ 位置/ ;/ 6/ ./ 如果/ S/ ·/ ·/ 非空/ ,/ 则/ 按照/ τ/ i/ 的/ 大小/ 对/ S/ ·/ ·/ 中/ 的/ 库/ 所/ 进行/ 降序/ 排序/ ,/ 以/ S/ ·/ ·/ 的/ 库/ 所/ 为/ 始点/ 进行/ 结构/ 分析/ ,/ 得出/ 预估/ 瓶颈/ 的/ 位置/ ./ 4/ 性能/ 瓶颈/ 定位/ 的/ 结构/ 分析/ 根据/ 定义/ 13/ 可知/ ,/ 非/ 终止/ 库所/ 共有/ 3/ 种/ 状态/ :/ 主动/ 受阻/ 状态/ 、/ 被动/ 受阻/ 状态/ 和/ 流通/ 状态/ ./ 定义/ 了/ 如图/ 6/ 所示/ 的/ 图形符号/ 来/ 表示/ 库所/ 的/ 3/ 种/ 不同/ 状态/ 和/ 变迁/ 成为/ 瓶颈/ 的/ 可能性/ 大小/ ./ 4.1/ 顺向/ 结构/ 分析/ 4.1/ ./ 1/ 顺序/ 结构/ 分析/ 图/ 7/ 是/ 顺序/ 结构/ 示意图/ ./ 因为/ 在/ 顺序/ 结构/ 不/ 存在/ 被动/ 受阻/ 库所/ ,/ 所以/ 另外/ 两种/ 库所/ 可能/ 的/ 几种/ 分布/ 如图/ 8/ 所示/ ./ 首先/ 对图/ 8/ (/ a/ )/ 进行/ 分析/ ,/ 根据/ 前面/ 的/ 算法/ 1/ ,/ 我们/ 知道/ 此时/ 只有/ 库所/ s0/ 可以/ 作为/ 当前/ 库所/ 进行/ 瓶颈/ Page7/ 定位/ 分析/ ./ 因为/ 当前/ 库所/ s0/ 为/ 流通/ 库所/ ,/ 因此/ 变迁/ t0/ 是/ 可/ 实施/ 的/ ,/ 存在/ 从/ s0/ 途经/ 变迁/ t0/ 流向/ s1/ 的/ token/ 流/ ,/ 如果/ :/ (/ 1/ )/ λ/ 0/ >/ λ/ 1/ ,/ 则/ 说明/ 正常/ 情况/ 下/ 对/ s1/ 而言/ token/ 流入/ 速度/ 大于/ 流出/ 速度/ ,/ 从而/ s1/ 应该/ 成为/ 流通/ 库所/ ,/ 但/ s1/ 却/ 为/ 主动/ 受阻/ 库所/ ,/ 从而/ 说明/ 变迁/ t0/ 发生/ 了/ 阻塞/ ,/ 它/ 成为/ 瓶颈/ 的/ 可能性/ 高/ ,/ 即/ 如图/ 9/ 所示/ ./ (/ 2/ )/ λ/ 0/ / λ/ 1/ ,/ λ/ 1/ >/ λ/ 2/ ,/ 说明/ 正常/ 情况/ 下/ ,/ s2/ 应该/ 成为/ 流通/ 库所/ ,/ 但/ 在/ 图/ 8/ (/ a/ )/ 中/ s2/ 并/ 不是/ 流通/ 库所/ ,/ 从而/ 说明/ t1/ 发生/ 了/ 阻塞/ ,/ t1/ 成为/ 瓶颈/ 的/ 可能性/ 高/ ,/ 即/ 如图/ 10/ 所示/ ./ 继续/ 分析/ 如下/ :/ r/ -/ 1/ )/ ,/ 则/ 说明/ tj/ -/ 1/ 成为/ 瓶颈/ 的/ 可能性/ 高/ ;/ 构中/ 不/ 存在/ 成为/ 瓶颈/ 可能性/ 高/ 的/ 变迁/ ./ 依次/ 类推/ ,/ 假设/ tr/ 为/ 顺序/ 结构/ 的/ 最后/ 一个/ 变迁/ ,/ (/ 3/ )/ λ/ 0/ / λ/ 1/ ,/ λ/ 1/ / λ/ 2/ ,/ …/ ,/ λ/ j/ -/ 2/ / λ/ j/ -/ 1/ ,/ λ/ j/ -/ 1/ >/ λ/ j/ (/ j/ / (/ 4/ )/ λ/ 0/ / λ/ 1/ ,/ λ/ 1/ / λ/ 2/ ,/ …/ ,/ λ/ r/ -/ 2/ / λ/ r/ -/ 1/ ,/ 则/ 说明/ 该/ 结下/ 面对/ 图/ 8/ (/ b/ )/ 进行/ 分析/ ,/ 在/ 图/ 8/ (/ b/ )/ 中库/ 所/ s0/ 和/ s1/ 均/ 可/ 作为/ 当前/ 库所/ ./ 当/ s0/ 作为/ 当前/ 库所/ 进行/ 分析/ 时/ ,/ (/ 1/ )/ λ/ 0/ >/ λ/ 1/ ,/ 根据/ 图/ 8/ (/ a/ )/ 的/ 分析/ 可知/ 在/ 这种/ 情况/ 下/ t1/ 成为/ 瓶颈/ 的/ 可能性/ 小/ ;/ (/ 2/ )/ λ/ 0/ / λ/ 1/ ,/ 说明/ 正常/ 情况/ 下/ s1/ 的/ 队列/ 长度/ 应/ 小于/ 等于/ s0/ 的/ 队列/ 长度/ ,/ 如果/ 这个/ 条件/ 不/ 满足/ ,/ 则/ 说明/ t0/ 成为/ 瓶颈/ 的/ 可能性/ 高/ ,/ 即/ 如图/ 11/ 所示/ ./ 无论是/ 哪/ 种/ 情况/ ,/ 都/ 将/ 当前/ 库所/ 修改/ 为/ s1/ ,/ 然后/ 继续/ 进行/ 分析/ ./ 当/ s1/ 作为/ 当前/ 库所/ 进行/ 分析/ 时/ ,/ 情况/ 同图/ 8/ (/ a/ )/ 的/ 分析/ ./ 下面/ 考虑/ 一般/ 的/ 情况/ ,/ 假设/ sf/ 是/ 顺序/ 结构/ 的/ 首库/ 所/ ,/ sr/ 是/ 顺序/ 结构/ 的/ 尾库/ 所/ (/ r/ >/ f/ )/ ,/ sf/ 到/ si/ 连续/ i/ -/ f/ +/ 1/ 个库/ 所/ 均/ 为/ 流通/ 库所/ (/ f/ / i/ / r/ )/ ,/ si/ +/ 1/ 到/ sr/ 均/ 为/ 主动/ 受阻/ 库所/ ./ 根据/ 前面/ 的/ 算法/ 1/ 可知/ sf/ 到/ si/ 之间/ 的/ 任何/ 一个/ 库所/ 都/ 有/ 可能/ 被选为/ 当前/ 库所/ ,/ 不失/ 一般性/ ,/ 可以/ 假设/ 首先/ 选择/ sj/ (/ f/ / j/ / i/ )/ 为/ 当前/ 库所/ ,/ 为了/ 能够/ 嵌套/ 调用/ 前面/ 的/ 分析方法/ ,/ 做/ 如下/ 处理/ ./ 算法/ 2/ ./ 顺序/ 结构/ 的/ 瓶颈/ 预测/ 算法/ ./ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 从/ sj/ 开始/ 逆向/ 搜索/ 找到/ sf/ ;/ 2/ ./ 如果/ sf/ 状态/ 为/ “/ 尚未/ 分析/ ”/ ,/ 则/ 将/ sf/ 作为/ 当前/ 库所/ 进行/ 分析/ ,/ 其/ 分析/ 过程/ 即/ 为/ 图/ 8/ (/ b/ )/ 的/ 分析/ 过程/ ,/ 并/ 将/ sf/ 的/ 状态/ 修改/ 为/ “/ 已/ 分析/ 过/ ”/ ;/ 否则/ 继续/ 判断/ sf/ 直接/ 后继/ 库所/ 是否是/ “/ 尚未/ 分析/ ”/ 库所/ ,/ 如果/ 是/ ,/ 则/ 令/ 它/ 为/ 当前/ 库所/ ,/ 执行/ 图/ 8/ (/ b/ )/ 的/ 分析/ 过程/ ,/ 将/ 该库/ 所/ 的/ 状态/ 修改/ 为/ “/ 已/ 分析/ 过/ ”/ ;/ 3/ ./ 重复/ 上述/ 过程/ ,/ 直到/ 当前/ 库所为/ si/ ,/ 如果/ si/ 的/ 状态/ 为/ “/ 尚未/ 分析/ ”/ ,/ 则/ 执行/ 图/ 8/ (/ a/ )/ 的/ 分析/ 过程/ ,/ 并/ 将/ si/ 的/ 状态/ 修改/ 为/ “/ 已/ 分析/ 过/ ”/ ;/ 否则/ 算法/ 结束/ ./ 4.1/ ./ 2/ 分支/ 结构/ 分析/ 图/ 12/ 是/ 分支/ 结构/ 示意图/ ./ 主动/ 受阻/ 库所/ 或/ 流通/ 库所/ ./ 显然/ ,/ 可以/ 得到/ 以下几点/ 认识/ :/ (/ 1/ )/ 根据/ 被动/ 受阻/ 库所/ 的/ 定义/ 易知/ ,/ si/ 只/ 可能/ 是/ (/ 2/ )/ 由于/ 我们/ 进行/ 的/ 是/ 前/ 向/ 结构/ 分析/ ,/ 故/ 在/ 此/ 结构/ 中/ 只有/ si/ 可能/ 被选为/ 当前/ 库所/ ./ (/ 3/ )/ 根据/ 前面/ 的/ 算法/ 1/ 可知/ 当前/ 库所/ 只能/ 是/ 被动/ 受阻/ 库所/ 或/ 流通/ 库所/ ./ 基于/ 以上/ 3/ 点/ 我们/ 可以/ 得出结论/ :/ 在/ 分析/ 分支/ 结构/ 时/ ,/ 只有/ 当/ si/ 为/ 流通/ 库所时/ 才/ 有/ 意义/ ./ 因此/ 在/ 结构/ 分析/ 有/ 意义/ 的/ 情况/ 下/ ,/ 3/ 种库/ 所在/ 分支/ 结构/ 的/ 分布/ 有如/ 图/ 13/ 所示/ 的/ 几种/ :/ 根据/ 3/ 种/ 类型/ 库所/ 的/ 定义/ 进行/ 简单/ 分析/ 可知/ :/ 如果/ ti/ 的/ 后置/ 库所/ 是/ 流通/ 库所/ ,/ 那么/ 该库/ 所/ 所属/ 的/ 后继/ 结构/ 可能/ 是/ 顺序/ 结构/ 或/ 分支/ 结构/ ;/ 如果/ ti/ 的/ 后置/ 库所/ 是/ 被动/ 受阻/ 库所/ ,/ 那么/ 该库/ 所/ 所属/ 的/ 后继/ 结构/ 为/ 汇聚/ 结构/ (/ 如图/ 14/ 所示/ )/ ./ 也就是说/ ,/ 图/ 13/ (/ b/ )/ 中/ 的/ sj/ 所属/ 的/ 后继/ 结构/ 可能/ 是/ 顺序/ 结构/ 或/ 分支/ 结构/ ;/ 图/ 13/ (/ c/ )/ 中/ 的/ sj/ ,/ sk/ 所属/ 的/ 后继/ 结构/ 可能/ 分别/ 是/ 顺序/ 结构/ 或/ 分支/ 结构/ ;/ 图/ 13/ (/ d/ )/ 中/ 的/ sj/ 所属/ 的/ 后继/ 结构/ 是/ 汇聚/ 结构/ ;/ 在/ 图/ 13/ (/ e/ )/ 中/ sj/ ,/ sk/ 均/ 是/ 汇聚/ 结构/ ,/ Page8/ 需要/ 注意/ 的/ 是/ si/ 和/ sj/ 不/ 可能/ 同时/ 属于/ 同一个/ 汇聚/ 结构/ ,/ 否则/ 它们/ 可以/ 合并/ 成/ 一个/ 库所/ ;/ 图/ 13/ (/ f/ )/ 中/ sj/ 的/ 后继/ 结构/ 为/ 顺序/ 结构/ 或/ 分支/ 结构/ ,/ sk/ 的/ 后继/ 结构/ 为/ 汇聚/ 结构/ ./ 算法/ 3/ ./ 分支/ 结构/ 瓶颈/ 预测/ 算法/ ./ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 如果/ sj/ ,/ sk/ 同为/ 主动/ 受阻/ 库所/ ,/ 则/ 说明/ 变迁/ ti/ 成为/ 瓶颈/ 的/ 可能性/ 高/ ;/ 否则/ 执行/ 步/ 2/ ;/ 2/ ./ 如果/ sj/ 为/ 被动/ 受阻/ 库所/ ,/ 则/ 执行/ 步/ 5/ ;/ 3/ ./ 如果/ sj/ 为/ 流通/ 库/ ,/ 则/ 执行/ 步/ 4/ ;/ 否则/ 执行/ 步/ 5/ ;/ 4/ ./ 如果/ sj/ 的/ 后继/ 结构/ 为/ 顺序/ 结构/ ,/ 则/ 对/ sj/ 执行/ 图/ 8/ (/ b/ )/ 的/ 分析/ 过程/ ;/ 如果/ 为/ 分支/ 结构/ ,/ 则/ 对/ sj/ 调用/ 算法/ 3/ ,/ 然后/ 执行/ 步/ 6/ ;/ 5/ ./ 对/ sj/ 调用/ 算法/ 6/ ;/ 6/ ./ 对/ sk/ 重复/ 步/ 2/ ~/ 5/ ./ 下面/ 考虑/ 更/ 一般/ 的/ 情况/ ,/ 如图/ 15/ 所示/ 的/ 分支/ 结构/ :/ 假设/ 用/ St0/ 表示/ t0/ 的/ 后置/ 集/ ,/ S/ ^/ t0/ 表示/ t0/ 后置/ 主动/ 受阻/ 库所集/ ,/ S/ ⌒/ 表示/ t0/ 后置/ 流通/ 库所集/ ,/ S/ =/ 集/ ,/ 显然/ 有/ St0/ =/ S/ ^/ t0/ ∪/ S/ ⌒/ 可知/ ,/ 此时/ s0/ 是/ 流通/ 库所/ ,/ 是/ 当前/ 库所/ ./ 算法/ ./ 算法/ 4/ ./ 更/ 一般/ 情况/ 下/ 的/ 分支/ 结构/ 瓶颈/ 预测/ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 如果/ S/ ⌒/ 法/ 6/ ,/ 并/ 把/ si/ 标记/ 为/ 已/ 访问/ 过/ ;/ 执行/ 步/ 2/ ;/ 2/ ./ 如果/ S/ ⌒/ 3/ ./ 选择/ S/ ⌒/ 4/ ./ 如果/ S/ ⌒/ 则/ 执行/ 步/ 5/ ;/ 5/ ./ 如果/ S/ ·/ ·/ 6/ ./ 选择/ S/ ·/ ·/ 继/ 结构/ 为/ 顺序/ 结构/ ,/ 则/ 对/ sj/ 执行/ 图/ 8/ (/ b/ )/ 的/ 分析/ 过程/ ;/ 如果/ 为/ 分支/ 结构/ ,/ 则/ 对/ sj/ 调用/ 算法/ 3/ ;/ 并/ 把/ sj/ 标记/ 为/ 已/ 访问/ 过/ ;/ 7/ ./ 如果/ S/ ·/ ·/ 否则/ 执行/ 步/ 8/ ;/ 8/ ./ 整个/ 算法/ 结束/ ./ 4.1/ ./ 3/ 汇聚/ 结构/ 分析/ 图/ 16/ 是/ 汇聚/ 结构/ 示意图/ ./ 在/ 计算/ 库所/ si/ 和/ sj/ 的/ 平均/ 消耗/ 时/ 延时/ ,/ 因为/ 它们/ 的/ fk/ 相同/ ,/ 由式/ (/ 9/ )/ 可知/ ,/ 它们/ 的/ 平均/ 消耗/ 时延/ 要么/ 同/ 为/ 大数/ ,/ 要么/ 同/ 为/ 小数/ ./ 也就是说/ ,/ 变迁/ tk/ 的/ 前置/ 集/ 要么/ 是/ (/ 主动/ 或/ 被动/ )/ 受阻/ 库所集/ ,/ 要么/ 是/ 流通/ 库所集/ ./ 根据/ 被动/ 受阻/ 库所/ 的/ 定义/ 可知/ ,/ tk/ 的/ 前置/ 集/ 不/ 可能/ 只/ 包含/ 被动/ 受阻/ 库所/ (/ 被动/ 受阻/ 库所/ 的/ 存在/ 依赖于/ 主动/ 受阻/ 库所/ 的/ 存在/ )/ ,/ 所以/ 对于/ 前置/ 集/ 大小/ 为/ 2/ 的/ 变迁/ tk/ 而言/ ,/ 各种/ 库/ 所在/ 其/ 前置/ 集中/ 分布/ 共有/ (/ 1/ +/ (/ 2/ -/ 1/ )/ )/ +/ 1/ =/ 3/ 种/ ,/ 如图/ 17/ 所示/ ./ Page9/ 对于/ 一般/ 情况/ ,/ 即/ tk/ 的/ 前置/ 集/ 大小/ 为/ n/ 的/ 情况/ ,/ 根据/ 上面/ 的/ 分析/ ,/ 可知/ 共有/ (/ 1/ +/ (/ n/ -/ 1/ )/ )/ +/ 1/ =/ n/ +/ 1/ 种库/ 所/ 的/ 分布/ ./ 根据/ 定义/ ,/ 当前/ 库所/ 只能/ 是/ 被动/ 受阻/ 库所/ 或/ 流通/ 库所/ ,/ 所以/ 不/ 对/ 图/ 17/ (/ a/ )/ 所示/ 情况/ 进行/ 结构/ 分析/ ./ 算法/ 5/ ./ 汇聚/ 结构/ 瓶颈/ 预测/ 算法/ ./ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 如果/ tk/ 前置/ 集均/ 为/ 流通/ 库所/ (/ 图/ 17/ (/ b/ )/ 所示/ )/ ,/ 则/ 说明/ tk/ 成为/ 瓶颈/ 的/ 可能性/ 大/ ;/ 否则/ 执行/ 步/ 2/ (/ 图/ 17/ (/ c/ )/ 所示/ 情况/ )/ ;/ 2/ ./ 此时/ 说明/ 瓶颈/ 可能/ 发生/ 在/ si/ 的/ 前置/ 区域/ ,/ 对/ si/ 进行/ 下面/ 考虑/ 更/ 一般/ 的/ 情况/ ,/ 如图/ 18/ 所示/ ./ 逆向/ 结构/ 分析/ ,/ 即/ 调用/ 算法/ 7/ ./ 用/ Sk/ 表示/ tk/ 的/ 前置/ 集/ ,/ S/ ^/ k/ 表示/ Sk/ 中/ 主动/ 受阻/ 库/ k/ 表示/ Sk/ 中/ 流通/ 库所/ 构成/ 的/ 集合/ ,/ 显然/ 有/ Sk/ =/ k/ ∪/ S/ ·/ ·/ 所/ 构成/ 的/ 集合/ ,/ S/ ⌒/ 合/ ,/ S/ ·/ ·/ S/ ^/ k/ ∪/ S/ ⌒/ / &&/ S/ ·/ ·/ 改为/ 算法/ 6/ ./ 算法/ ./ 算法/ 6/ ./ 更/ 一般/ 情况/ 下/ 的/ 汇聚/ 结构/ 瓶颈/ 预测/ 输入/ :/ WSCPAM/ 输出/ :/ 瓶颈/ 预测/ 结果/ 1/ ./ 如果/ S/ ·/ ·/ 2/ ./ 如果/ S/ ^/ k/ ≠/ / &&/ S/ ⌒/ 执行/ 步/ 2/ ;/ 的/ 库/ 所/ si/ 的/ 前置/ 区域/ 进行/ 结构/ 分析/ ,/ 即/ 调用/ 算法/ 7/ 对/ si/ 进行/ 逆向/ 结构/ 分析/ ,/ 并/ 将/ si/ 打上/ 已/ 访问/ 过/ 的/ 标志/ ;/ 3/ ./ 重复/ 步/ 2/ 直到/ S/ ^/ k/ 中/ 再也/ 找/ 不到/ 尚未/ 被/ 访问/ 过/ 的/ 库/ 所/ 为止/ ./ 说明/ :/ (/ 1/ )/ “/ 如果/ S/ ·/ ·/ 可能性/ 大/ ”/ ,/ 这/ 是因为/ 如果/ tk/ 的/ 前置/ 集中/ 存在/ 流通/ 库所/ ,/ 那么/ 就/ 不/ 可能/ 存在/ 主动/ 受阻/ 库所/ 和/ 被动/ 受阻/ 库所/ ./ 如果/ 存在/ 被动/ 受阻/ 库所/ ,/ 则/ 一定/ 存在/ 主动/ 受阻/ 库所/ ,/ 这时/ 流通/ 库所/ 也/ 只能/ 变换/ 成/ 被动/ 受阻/ 库所/ ./ 所以/ 说/ S/ ·/ ·/ k/ ≠/ / 就/ 意味着/ 变迁/ tk/ 的/ 前置/ 集所/ 包含/ 的/ 库/ 所/ 都/ 是/ 流通/ 库所/ ./ (/ 2/ )/ 在/ 具体/ 实现/ 时/ ,/ 做/ 了/ 简化/ 处理/ ./ 对于/ 算法/ 6/ 中/ 的/ 循环/ 〈/ 步/ 2/ ,/ 步/ 3/ 〉/ ,/ 只/ 对/ 集合/ S/ ^/ k/ 中/ 的/ 一个/ 库所/ 通过/ 逆向/ 结构/ 分析/ 定位/ 出/ 了/ 一个/ 可能/ 的/ 瓶颈/ ,/ 那么/ 循环/ 就/ 结束/ ./ 4.2/ 逆向/ 结构/ 分析/ 通过/ 前面/ 的/ 分析/ 可知/ ,/ 只有/ 在/ 对/ 汇聚/ 结构/ 进行/ 顺向/ 结构/ 分析/ 时才/ 需要/ 对/ 某个/ 主动/ 受阻/ 库所/ 进行/ 逆向/ 结构/ 分析/ ,/ 如图/ 17/ (/ c/ )/ 所示/ ./ 逆向/ 结构/ 分析/ 共有/ 图/ 19/ 所示/ 的/ 几种/ 情况/ ./ 假设/ 逆向/ 分析/ 的/ 起始/ 库所为/ si/ ,/ 现/ 分析/ 如下/ :/ (/ 1/ )/ 显然/ 图/ 19/ (/ a/ )/ 和/ 图/ 19/ (/ b/ )/ 是/ 逆向/ 结构/ 分析/ 的/ 递归/ Page10/ 结束/ 条件/ ;/ (/ 2/ )/ 在/ 图/ 19/ (/ d/ )/ 中/ si/ 的/ 前置/ 结构/ 是/ 分支/ 结构/ ,/ si/ 的/ 前置/ 变迁/ tk/ 的/ 其它/ 分支/ 不/ 对/ si/ 分支/ 的/ 性能/ 构成/ 影响/ ,/ 因此/ 图/ 19/ (/ d/ )/ 与/ 图/ 19/ (/ c/ )/ 等价/ ;/ (/ 3/ )/ 图/ 19/ (/ c/ )/ 、/ 图/ 19/ (/ e/ )/ 和/ 图/ 19/ (/ f/ )/ 的/ 处理/ 类似/ ,/ 无论/ si/ 的/ 前置/ 结构/ 块/ 是/ 什么/ 结构/ (/ 顺序/ 结构/ 或者/ 分支/ 结构/ 或者/ 汇聚/ 结构/ )/ ,/ 匀/ 是/ 对/ si/ 前置/ 结构/ 中/ 的/ 主动/ 受阻/ 库所/ 进行/ 递归/ 逆向/ 结构/ 分析/ (/ 如图/ 19/ (/ c/ )/ 的/ sk/ 、/ 图/ 19/ (/ e/ )/ 中/ 的/ si/ 、/ 图/ 19/ (/ f/ )/ 中/ 的/ si/ 、/ sj/ )/ ./ 算法/ 7/ ./ 逆向/ 结构/ 分析/ 算法/ ./ 输入/ :/ WSCPAM/ 输出/ :/ 分析/ 结果/ 1/ ./ 假设/ si/ 的/ 前置/ 变迁/ 为/ ti/ / ,/ 如果/ |/ ·/ ti/ / |/ =/ 1/ ,/ 则/ 执行/ 步/ 2/ ;/ 否则/ (/ 即/ |/ ·/ ti/ / |/ >/ 1/ )/ 执行/ 步/ 3/ ;/ 2/ ./ 假设/ si/ / ∈/ ·/ ti/ / ,/ 如果/ si/ / 为/ 流通/ 库所/ ,/ 则/ 变迁/ ti/ / 成为/ 瓶颈/ 的/ 可能性/ 大/ ,/ 执行/ 步/ 6/ ;/ 否则/ (/ 即/ si/ / 为/ 主动/ 受阻/ 库所/ )/ 执行/ 步/ 5/ ;/ 3/ ./ 如果/ / s/ ∈/ ·/ ti/ / ,/ s/ 均/ 为/ 流通/ 库所/ ,/ 则/ 变迁/ ti/ / 成为/ 瓶颈/ 的/ 可能性/ 大/ ,/ 执行/ 步/ 6/ ;/ 否则/ 执行/ 步/ 4/ ;/ 4/ ./ 如果/ / s/ ∈/ ·/ ti/ / 且/ s/ 为/ 尚未/ 被/ 访问/ 过/ 的/ 主动/ 受阻/ 库所/ (/ 因为/ ·/ ti/ / 可能/ 包括/ 多个/ 主动/ 受阻/ 库所/ ,/ 需要/ 对/ 它们/ 依次/ 进行/ 逆向/ 结构/ 分析/ )/ ,/ 则/ 执行/ 步/ 5/ ;/ 否则/ 执行/ 步/ 6/ ;/ 5/ ./ 用/ si/ / 替换/ si/ 执行/ 步/ 1/ ,/ 即/ 递归/ 调用/ 算法/ 7/ ;/ 6/ ./ 算法/ 结束/ ./ 说明/ :/ 假设/ si/ 的/ 前置/ 变迁/ 为/ ti/ / ,/ 如果/ |/ ·/ ti/ / |/ =/ 1/ ,/ 则/ 说明/ si/ 的/ 前置/ 结构/ 为/ 顺序/ ;/ 如果/ |/ ·/ ti/ / |/ >/ 1/ ,/ 则/ 说明/ si/ 的/ 前置/ 结构/ 为/ 汇聚/ ,/ 这个/ 判断/ 结果/ 可以/ 通过/ “/ 结构/ 发现/ ”/ 得到/ ./ 4.3/ 结构/ 发现/ 定理/ 1/ ./ 结构/ 发现/ 定理/ ./ 假设/ 库所/ si/ 的/ 后置/ 变迁/ (/ 或/ 前置/ 变迁/ )/ 为/ ti/ ,/ 则/ 有/ (/ 1/ )/ 如果/ |/ ·/ ti/ |/ =/ 1/ &&/ |/ ti/ 顺序/ 结构/ ;/ (/ 2/ )/ 如果/ |/ ·/ ti/ |/ =/ 1/ &&/ |/ ti/ (/ 3/ )/ 如果/ |/ ·/ ti/ |/ >/ 1/ &&/ |/ ti/ 证明/ ./ (/ 1/ )/ 由/ |/ ·/ ti/ |/ =/ 1/ &&/ |/ ti/ 汇聚/ 结构/ ./ 一个/ 前置/ 库所/ 和/ 一个/ 后置/ 库所/ ,/ 且/ si/ ∈/ |/ ·/ ti/ |/ 或者/ si/ ∈/ ·/ |/ ,/ 因此/ si/ 所属/ 的/ 结构/ 是/ 顺序/ 结构/ ;/ (/ 2/ )/ |/ ·/ ti/ |/ =/ |/ ti1/ &&/ |/ ti/ 显然/ 是/ 一个/ 分支/ 结构/ ,/ 且/ si/ ∈/ |/ ·/ ti/ |/ 或者/ si/ ∈/ |/ tisi/ 所属/ 的/ 结构/ 是/ 分支/ 结构/ ;/ (/ 3/ )/ |/ ·/ ti/ |/ >/ 1/ &&/ |/ ti1/ / ti/ 具有/ 多个/ 前置/ 库所/ 和/ 一个/ 后置/ 库所/ ,/ 显然/ 是/ 一个/ 汇聚/ 结构/ ,/ 且/ si/ ∈/ |/ ·/ ti/ |/ 或者/ si/ ∈/ |/ ti/ 结构/ 是/ 汇聚/ 结构/ ./ 分支/ 结构/ ;/ 5/ 实验/ 分析/ 为了/ 测试/ 策略/ BNL/ -/ WSCPAM/ 的/ 有效性/ ,/ 开发/ 了/ 一个/ 界面/ 友好/ 的/ 跨平台/ 软件/ 集成/ 平台/ ./ 该/ 平台/ 包括/ 基于/ 本体/ 的/ Web/ 服务/ 组合/ 需求/ 获取/ 子系统/ 、/ 按照/ 需求/ 规划/ 组合/ 服务/ 子系统/ 、/ 消息/ 服务器/ 及/ Web/ 服务/ 组合/ 流程/ 控制/ 子系统/ 、/ Web/ 服务/ 组合/ 性能/ 分析/ 仿真/ 子系统/ 和/ Web/ 服务/ 组合/ 性能/ 分析/ 数学分析/ 子系统/ ./ 本文/ 的/ 工作/ 属于/ 平台/ Web/ 服务/ 组合/ 性能/ 分析/ 数学分析/ 子系统/ ,/ 该/ 子系统/ 以/ BPEL/ 文件/ 和/ WSDL/ 文件/ 作为/ 输入/ ,/ 通过/ 对/ 二者/ 的/ 解析/ 生成/ 对应/ 的/ 基于/ SPN/ 的/ Web/ 服务/ 组合/ 性能/ 分析模型/ WSCPAM/ ,/ 并/ 在/ 得到/ 的/ WSCPAM/ 上/ 实现/ 策略/ BNL/ -/ WSCPAM/ 对/ Web/ 服务/ 组合/ 进行/ 性能/ 评价/ 和/ 性能/ 瓶颈/ 预测/ ./ 该/ 子系统/ 采用/ 图形化/ 的/ 展示/ 方式/ ,/ 图形化/ 显示/ WSC/ -/ PAM/ 模型/ 以及/ 性能/ 瓶颈/ 的/ 预测/ 结果/ ,/ 以便/ 用户/ 进行/ 查看/ 和/ 分析/ ./ 本/ 系统/ 采用/ 的/ 开发/ 平台/ 为/ eclipse/ ,/ 主要/ 使用/ 的/ 开发/ 语言/ 为/ Java/ 和/ SQL/ ,/ 开发/ 过程/ 中/ 使用/ 了/ Javaswing/ 和/ 多线程/ 技术/ ,/ 采用/ 的/ 操作系统/ 为/ Windows2003/ ./ Web/ 服务/ 组合/ 中/ 各子/ 服务/ 的/ 服务/ 速度/ 一般/ 呈现/ 两种/ 情况/ :/ 服务/ 速度/ 差异/ 不/ 大/ ,/ 服务/ 速度/ 差异/ 较大/ ./ 第/ 1/ 种/ 情况/ 又/ 有/ 两种/ 具体表现/ :/ 大部分/ 的/ 子/ 服务/ 都/ 是/ 以/ 较/ 低/ 的/ 速度/ 提供/ 服务/ ;/ 或者/ 都/ 以/ 较/ 高/ 的/ 速度/ 为/ 用户/ 提供/ 服务/ ./ 为了/ 验证/ BNL/ -/ WSCPAM/ 策略/ 在/ 上述情况/ 下/ 对/ Web/ 服务/ 组合/ 瓶颈/ 定位/ 的/ 有效性/ ,/ 设计/ 了/ 如表/ 1/ 所示/ 的/ 3/ 种/ 实验/ 参数/ 配置/ 方案/ ./ 表/ 1/ 中前/ 两行/ 所示/ 的/ 实验/ 配置/ 参数/ 表示/ WSCPAM/ 模型/ 中/ 各/ 变迁/ 的/ 实施/ 速率/ 差异/ 不大/ 的/ 情况/ ,/ 其中/ 第/ 1/ 行/ 表示/ 变迁/ 实施/ 速率/ 均/ 处于/ 较/ 低水平/ ;/ 第/ 2/ 行/ 表示/ 变迁/ 实施/ 速率/ 均/ 处于/ 较/ 高水平/ ;/ 最后/ 1/ 行/ 所示/ 的/ 实验/ 配置/ 参数/ 表示/ 实施/ 速率/ 差异/ 较大/ 的/ 情况/ ./ 在/ 每种/ 方案/ 的/ 速率/ 范围/ 内/ 给/ 每个/ 变迁/ 随机/ 分配/ 实施/ 速率/ ,/ 在/ 每种/ 配置/ 方案/ 下/ 运行/ BNL/ -/ WSCPAM/ 策略/ 100/ 次/ ./ 对/ 得到/ 的/ 实验/ 数据/ 进行/ 分析/ ,/ 考察/ BNL/ -/ WSCPAM/ 策略/ 在/ 变迁/ 实施/ 速率/ 普通/ 较/ 低/ 或/ 普遍/ 较/ 高/ 或/ 实施/ 速率/ 差异/ 大时/ 对/ 性能/ 模型/ WSCPAM/ 的/ 瓶颈/ 预测/ 情况/ ,/ 以此/ 衡量/ 预测/ 结果/ 的/ 有效性/ ./ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ 100/ (/ 1/ ,/ 10/ )/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ 100/ (/ 90/ ,/ 100/ )/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ 100/ (/ 1/ ,/ 100/ )/ Page11/ 某/ 计算机/ 公司/ 计算机/ 销售/ 过程/ 的/ 工作/ 流如图/ 20/ 所示/ [/ 28/ ]/ ./ 用户/ 通过/ Internet/ 或/ 其它/ 方式/ 向/ 公司/ 发出/ 订单/ ,/ 给出/ 所/ 需要/ 的/ 计算机/ 基本/ 配置/ 和/ 数量/ ./ 公司/ 接收/ 用户/ 订单/ ,/ 对/ 订单/ 进行/ 检查/ ,/ 计算/ 价格/ ,/ 检查/ 零部件/ 的/ 库存/ 情况/ ,/ 进行/ 配置/ 检查/ ,/ 确认/ 用户/ 的/ 订单/ 技术/ 上/ 是否/ 可行/ ./ 根据/ 检查/ 结果/ 做出/ 决策/ ,/ 如果/ 检查/ 通过/ ,/ 则/ 通知/ 用户/ 付款/ 和/ 发出/ 生产/ 通知/ ,/ 在/ 用户/ 付款/ 成功/ 和/ 装配/ 完成/ 后/ 进行/ 发货/ ;/ 如果/ 检查/ 不/ 通过/ ,/ 则/ 提出/ 订单/ 修改意见/ ,/ 并/ 向/ 用户/ 反馈/ 意见/ ./ 图/ 21/ 测试/ 用/ 的/ WSCPAM/ 模型/ 表/ 2/ ~/ 表/ 4/ 分别/ 是/ 在/ 表/ 1/ 所示/ 的/ 3/ 种/ 实验/ 参数/ 配置/ 方案/ 下/ 得到/ 的/ 瓶颈/ 预测/ 结果/ ./ 从表/ 2/ 可以/ 看出/ 在/ 变迁/ 实施/ 速率/ 普遍/ 较/ 低时/ ,/ 预测/ 的/ 瓶颈/ 主要/ 集中/ 在/ 变迁/ 6/ 、/ 变迁/ 11/ 和/ 变迁/ 14/ ,/ 其中/ 变迁/ 6/ 在/ 100/ 次/ 运行/ 中均/ 被/ 定位/ 为/ 潜在/ 的/ 瓶颈/ ,/ 变迁/ 11/ 的/ 预测/ 命中率/ 也/ 高达/ 98/ %/ ,/ 变迁/ 14/ 的/ 预测/ 命中率/ 为/ 90/ %/ ./ 观察/ 图/ 21/ 可以/ 发现/ ,/ 这/ 3/ 个/ 变迁/ 均/ 为/ 汇聚/ 变迁/ ./ 由于/ 变迁/ 的/ 实施/ 速率/ 差异性/ 不/ 大/ ,/ 故/ 各库/ 所/ 中/ 的/ token/ 队列/ 长度/ 相差/ 不/ 大/ ,/ 又/ 由于/ 变迁/ 的/ 实施/ 速率/ 普遍/ 较/ 低/ ,/ 故/ 各库/ 所/ 中/ 的/ token/ 队列/ 长度/ 变化/ 比较/ 平缓/ ./ 在/ 此/ 情况/ 下/ ,/ 受/ 约束条件/ 越多/ 的/ 变迁/ 成为/ 瓶颈/ 的/ 可能性/ 越大/ ./ 汇聚/ 变迁/ 所/ 受/ 约束条件/ 比非/ 汇聚/ 变迁/ 要/ 多/ ,/ 图/ 21/ 中/ 汇聚/ 变迁/ 6/ 的/ 汇聚/ 率要/ 高于/ 同/ 为/ 汇聚/ 变迁/ 的/ 变迁/ 11/ 和/ 变迁/ 14/ ,/ 同时/ 变迁/ 11/ 是/ 变迁/ 14/ 的/ 直接/ 前驱/ 变迁/ ,/ 它们/ 具有/ 相同/ 的/ 前驱/ 变迁/ 7/ ,/ 且/ 变迁/ 7/ 到达/ 变迁/ 14/ 的/ 路径/ 长度/ 要/ 小于/ 到/ 变迁/ 11/ 的/ 路径/ 长度/ ,/ 这/ 说明/ 变迁/ 11/ 的/ 处理/ 压力/ 要/ 大于/ 变迁/ 14/ ,/ 因此/ 算法/ 给出/ 预测/ 结果/ 是/ 有效/ 的/ ./ 初始/ 标识/ 变迁/ 实施/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ (/ 1/ ,/ 10/ )/ 从表/ 3/ 可以/ 看出/ 在/ 变迁/ 实施/ 速率/ 普遍/ 较/ 高时/ ,/ 上述/ 工作/ 流/ 对应/ 的/ WSCPAM/ 模型/ 作为/ 测试/ 模型/ ,/ 如图/ 21/ 所示/ ./ 图/ 21/ 中库/ 所/ 结点/ 和/ 变迁/ 结点/ 中/ 的/ 数字/ 是/ 它们/ 的/ 编号/ ./ 预测/ 的/ 瓶颈/ 主要/ 集中/ 在/ 变迁/ 2/ 、/ 变迁/ 7/ 和/ 变迁/ 8/ ,/ 其中/ 变迁/ 2/ 和/ 变迁/ 8/ 在/ 100/ 次/ 运行/ 中均/ 被/ 定位/ 为/ 潜在/ 的/ 瓶颈/ ,/ 变迁/ 7/ 的/ 预测/ 命中率/ 也/ 高达/ 99/ %/ ./ 观察/ 图/ 21/ 可以/ 发现/ ,/ 这/ 3/ 个/ 变迁/ 均/ 为/ 分支/ 变迁/ ./ 由于/ 各/ 变迁/ 的/ 实施/ 速率/ 相差/ 不大且/ 实施/ 速率/ 普遍/ 较/ 高/ ,/ 故/ 各库/ 所/ 中/ 的/ token/ 队列/ 长度/ 变化/ 幅度/ 不大/ 但/ 频率/ 较/ 高/ ./ 在/ 此/ 情况/ 下/ ,/ 库所中/ 的/ token/ 队列/ 长度/ 为/ 0/ 的/ 次数/ 增多/ ,/ 从而/ 分支/ 变迁/ 和/ 顺序/ 变迁/ 相对/ 于/ 汇聚/ 变迁/ 而言/ 成为/ 瓶颈/ 的/ 可能性/ 大/ ./ 又/ 由于/ 顺序/ 变迁/ 的/ 后置/ 库所数/ 少于/ 分支/ 变迁/ 的/ 后置/ 库所数/ ,/ 故/ 顺序/ 变迁/ 受/ 后置/ 库所中/ token/ 队列/ 长度/ 变为/ 0/ 的/ 影响/ 要/ 小于/ 分支/ 变迁/ ,/ 因此/ 分支/ 变迁/ 成为/ 潜在/ 瓶颈/ 的/ 可能性/ 最大/ ,/ 因此/ 算法/ 给出/ 预测/ 结果/ 是/ 有效/ 的/ ./ 初始/ 标识/ 变迁/ 实施/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ (/ 90/ ,/ 100/ )/ 28121/ 从表/ 4/ 可以/ 看出/ 在/ 变迁/ 实施/ 速率/ 差异/ 大时/ ,/ 预测/ 结果/ 与/ 变迁/ 实施/ 速率/ 普遍/ 较/ 高时/ 的/ 预测/ 结果/ 相同/ ,/ 主要/ 集中/ 在/ 变迁/ 2/ 、/ 变迁/ 7/ 和/ 变迁/ 8/ ./ 在/ 第/ 3/ 种/ 实验/ 参数/ 配置/ 环境/ 下/ 变迁/ 2/ 的/ 预测/ 命中率/ 为/ 100/ %/ ,/ 变迁/ 7/ 的/ 预测/ 命中率/ 为/ 82/ %/ ,/ 变迁/ 8/ 的/ 预测/ 命中率/ 为/ 77/ %/ ,/ 变迁/ 7/ 和/ 变迁/ 8/ 的/ 预测/ 命中率/ 较/ 变迁/ 实施/ 速率/ 普遍/ 较/ 高时/ 要/ 低/ 一些/ ./ 由于/ 变迁/ 的/ 实施/ 速率/ 相/ Page12/ 差/ 较大/ 即/ 变迁/ 实施/ 速率/ 不/ 匹配/ 的/ 情况/ 比较突出/ ,/ 从而/ 使得/ 各库/ 所/ 中/ 的/ token/ 队列/ 长度/ 相差/ 较大/ ,/ 且/ 有些/ 库所中/ 的/ token/ 队列/ 长度/ 变化/ 平缓/ 而/ 另/ 一些/ 库所中/ 的/ token/ 队列/ 长度/ 变化/ 比较/ 频繁/ ,/ 因此/ 图/ 13/ (/ c/ )/ 所示/ 分布/ 和/ 图/ 17/ (/ b/ )/ 所示/ 分布/ 的/ 出现/ 概率/ 减少/ ,/ 而图/ 13/ 所示/ 的/ 其它/ 分布/ 和/ 图/ 17/ (/ c/ )/ 所示/ 分布/ 的/ 出现/ 概率/ 增大/ ./ 故/ 在/ 此/ 情况/ 下/ ,/ 分支/ 变迁/ 成为/ 瓶颈/ 的/ 可能性/ 要/ 高于/ 汇聚/ 变迁/ ./ 因为/ 顺序/ 变迁/ 的/ 后置/ 库所数/ 少于/ 分支/ 变迁/ 的/ 后置/ 库所数/ ,/ 故/ 顺序/ 变迁/ 受/ 后置/ 库所中/ token/ 队列/ 长度/ 变化/ 的/ 影响/ 要/ 小于/ 分支/ 变迁/ ,/ 分支/ 变迁/ 成为/ 瓶颈/ 的/ 可能性/ 要/ 高于/ 顺序/ 变迁/ ./ 综上所述/ ,/ 预测/ 结果/ 为/ 变迁/ 2/ 、/ 变迁/ 7/ 和/ 变迁/ 8/ 是/ 有效/ 的/ ./ 变迁/ 7/ 和/ 变迁/ 8/ 的/ 命中率/ 比上/ 一组/ 实验/ 要/ 略低/ ,/ 主要/ 是因为/ 在/ 本组/ 实验/ 中库/ 所/ token/ 队列/ 的/ 长度/ 相差/ 较大/ ,/ 有些/ token/ 队列/ 的/ 长度/ 可能/ 达到/ 一个/ 比较/ 大/ 的/ 值/ ,/ 从而/ 使得/ 分支/ 变迁/ 所有/ 后置/ 库所中/ 的/ token/ 队列/ 长度/ 均/ 为/ 0/ 的/ 可能性/ 减少/ ./ 初始/ 标识/ 变迁/ 实施/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ (/ 1/ ,/ 100/ )/ 6/ 结论/ 本文/ 首先/ 给出/ 了/ 一种/ 基于/ SPN/ 的/ Web/ 服务/ 组合/ 性能/ 分析模型/ WSCPAM/ ,/ 然后/ 通过/ 对/ WSCPAM/ 的/ 4/ 种/ 基本/ 结构/ 进行/ 结构/ 转换/ 得到/ 性能/ 瓶颈/ 定位/ 分析/ 结构/ 集/ ,/ 在/ 此基础/ 上/ 提出/ 了/ 一种/ Web/ 服务/ 组合/ 性能/ 瓶颈/ 定位/ 策略/ BNL/ -/ WSCPAM/ ./ 该/ 策略/ 根据/ 库所中/ token/ 消耗/ 的/ 速度/ 将库/ 所/ 分成/ 主动/ 受阻/ 库所/ 、/ 被动/ 受阻/ 库所/ 和/ 流通/ 库所/ 3/ 类/ ,/ 并/ 通过/ 对/ 分析/ 结构/ 集中/ 的/ 结构/ 进行/ 顺向/ 结构/ 分析/ 和/ 逆向/ 结构/ 分析/ 得到/ 在/ 3/ 类库/ 所/ 所有/ 可能/ 分布/ 下/ 的/ 性能/ 瓶颈/ 位置/ 的/ 预测/ 结果/ ,/ 最后/ 用/ 测试用例/ 说明/ 了/ BNL/ -/ WSCPAM/ 预测/ 结果/ 的/ 有效性/ ./ 通过/ WSCPAM/ 的/ 定义/ 可知/ ,/ WSC/ -/ PAM/ 实质/ 上/ 是/ 结构/ 部分/ 受限/ 的/ SPN/ ,/ 因此/ 如何/ 将/ BNL/ -/ WSCPAM/ 策略/ 扩展/ 到/ 一般/ 的/ Petri/ 网将/ 是/ 我们/ 今后/ 的/ 努力/ 方向/ ./ 

