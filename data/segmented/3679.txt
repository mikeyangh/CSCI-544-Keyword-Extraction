Page1/ 数据/ 时效性/ 判定/ 问题/ 的/ 求解/ 算法/ 李默涵/ 李建中/ 高宏/ (/ 哈尔滨工业大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 摘要/ 数据/ 的/ 时效性/ 问题/ 是/ 影响/ 数据/ 质量/ 的/ 重要/ 因素/ 之一/ ./ 时效性/ 差/ 的/ 数据/ 会/ 对/ 企业/ 决策/ 和/ 人们/ 的/ 日常生活/ 带来/ 许多/ 不利/ 影响/ ,/ 这/ 使得/ 判定/ 数据/ 的/ 时效性/ 成为/ 必要/ ./ 许多/ 应用/ 数据库/ 中/ 都/ 没有/ 完整/ 、/ 清洁/ 、/ 可用/ 的/ 时间/ 戳/ ,/ 从而/ 导致/ 数据/ 时效性/ 的/ 判定/ 非常/ 困难/ ./ 冗余/ 记录/ 和/ 时效/ 约束/ 能够/ 在/ 时间/ 戳/ 缺失/ 的/ 情况/ 下/ 有效/ 地/ 辅助/ 恢复/ 数据/ 的/ 时序/ 关系/ ,/ 因而/ 能够/ 帮助/ 数据/ 时效性/ 的/ 判定/ ./ 文中/ 研究/ 包含/ 冗余/ 记录/ 的/ 集合/ 在/ 给定/ 时效/ 约束/ 下/ 的/ 时效性/ 判定/ 问题/ ,/ 并/ 首次/ 提出/ 了/ 时效性/ 判定/ 问题/ 的/ 求解/ 算法/ ./ 首先/ ,/ 文中/ 定义/ 了/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ ./ 在/ 判定/ 查询/ 相关/ 时效性/ 时/ ,/ 文中/ 将/ 查询/ 归结为/ 最新/ 值/ 查询/ 和/ 时效/ 序列/ 查询/ 两类/ ,/ 并/ 分别/ 根据/ 两类/ 查询/ 的/ 特点/ ,/ 对/ 每类/ 查询/ 定义/ 了/ 查询/ 结果/ 时效性/ 和/ 平均/ 时效性/ ./ 然后/ ,/ 文中/ 提出/ 了/ 时效/ 图/ 的/ 概念/ ./ 利用/ 时效/ 图/ ,/ 文中/ 给出/ 了/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 判定/ 问题/ 的/ 求解/ 算法/ ./ 最后/ 给出/ 了/ 真实/ 数据/ 和/ 虚拟/ 数据/ 上/ 的/ 实验/ 结果/ ,/ 验证/ 了/ 文中/ 算法/ 较/ 高/ 的/ 执行/ 效率/ ,/ 并/ 分析/ 了/ 各个/ 参数/ 对/ 算法/ 的/ 影响/ ./ 关键词/ 数据/ 质量/ ;/ 数据/ 时效性/ ;/ 相关/ 时效性/ 1/ 引言/ 数据/ 的/ 时效性/ 问题/ 普遍存在/ 于/ 各类/ 实际/ 应用/ 中/ ,/ 是/ 影响/ 数据/ 质量/ 的/ 重要/ 因素/ 之一/ ./ 随着/ 时间/ 的/ 推移/ ,/ 数据/ 质量/ 会/ 快速/ 的/ 下降/ ,/ 有/ 统计/ 称/ ,/ 在/ 商业/ 数据库/ 中/ ,/ 约/ 有/ 2/ %/ 的/ 客户/ 信息/ 会/ 在/ 一个月/ 内变/ 的/ 陈旧/ [/ 1/ ]/ ,/ 即/ 是/ 说/ ,/ 在/ 2/ 年内/ ,/ 会/ 有/ 近/ 50/ %/ 的/ 记录/ 因为/ 过/ 时而/ 使/ 其/ 可用性/ 受到/ 影响/ ./ 在/ 企业/ 决策/ 时/ ,/ 企业/ 往往/ 会/ 因为/ 使用/ 了/ 陈旧/ 的/ 数据/ 而/ 做出/ 错误/ 的/ 决策/ ,/ 而/ 在/ 日常生活/ 中/ ,/ 银行/ 可能/ 会/ 将/ 信用卡/ 账单/ 寄/ 送到/ 持有人/ 搬家/ 前/ 的/ 旧/ 地址/ ./ 劣质/ 数据/ 每年/ 给/ 美国/ 造成/ 的/ 经济损失/ 高达/ 6000/ 亿美元/ [/ 1/ ]/ ,/ 而/ 时效性/ 差/ 正是/ 造成/ 数据/ 劣质/ 的/ 罪魁祸首/ 之一/ ./ 为此/ ,/ 确保/ 数据/ 时效性/ 是/ 一个/ 十分/ 重要/ 的/ 问题/ ./ 数据/ 时效性/ 判定/ 问题/ 是/ 确保/ 数据/ 时效性/ 的/ 一个/ 关键问题/ ./ 无论是/ 数据/ 时效性/ 问题/ 的/ 发现/ 还是/ 数据/ 时效性/ 问题/ 的/ 修复/ ,/ 都/ 首先/ 需要/ 对/ 数据/ 时效性/ 加以/ 判定/ ./ 在/ 用户/ 使用/ 数据/ 时/ ,/ 往往/ 也/ 首先/ 要求/ 判定/ 数据/ 的/ 时效性/ ./ 本文/ 集中/ 研究/ 数据/ 时效性/ 判定/ 问题/ ./ 通常/ ,/ 很多/ 应用/ 数据库/ 中/ 都/ 没有/ 时间/ 戳/ ./ 即使/ 存在/ 时间/ 戳/ ,/ 由于/ 数据/ 缺乏/ 及时/ 有效/ 的/ 维护/ 或/ 数据/ 集成/ 等/ 原因/ ,/ 这些/ 时间/ 戳/ 经常/ 不可/ 用/ 或/ 不/ 精确/ [/ 2/ ]/ ./ 而且/ ,/ 同一/ 记录/ 的/ 不同/ 属性/ 随/ 时间/ 变化/ 的/ 频率/ 不同/ ,/ 使得/ 同一/ 记录/ 的/ 不同/ 属性/ 的/ 新旧/ 程度/ 也/ 会/ 不同/ ,/ 为/ 每条/ 记录/ 的/ 每个/ 属性/ 都/ 保存/ 相应/ 的/ 时间/ 戳/ 并非易事/ ./ 所以/ ,/ 数据/ 时效性/ 判定/ 问题/ 面临/ 的/ 主要/ 挑战/ 是/ 数据/ 集合/ 中/ 没有/ 完整/ 、/ 精确/ 、/ 可用/ 的/ 时间/ 戳/ ./ 虽然/ 在/ 时间/ 戳/ 缺失/ 或/ 不/ 精确/ 的/ 情况/ 下/ ,/ 数据/ 时效性/ 的/ 判定/ 问题/ 变得/ 困难/ ,/ 但是/ 我们/ 仍/ 能够/ 利用/ 一些/ 冗余/ 记录/ 和/ 时效/ 约束/ (/ currencyconstraint/ )/ 来/ 实现/ 数据/ 时效性/ 的/ 判定/ ./ 冗余/ 记录/ 是/ 指/ 数据/ 集合/ 中/ 存在/ 着/ 多条/ 记录/ 描述/ 同一/ 实体/ 的/ 情况/ ./ 例如/ ,/ 在/ 网络/ 环境/ 下/ ,/ 用户/ 搜索/ 某人/ 的/ 信息/ ,/ 往往/ 得到/ 多条/ 不同/ 的/ 结果/ ;/ 数据/ 集成/ 环境/ 下/ ,/ 会/ 有/ 多条/ 来自/ 不同/ 数据源/ 的/ 记录/ 描述/ 同一/ 实体/ ;/ 企业/ 周期性地/ 备份/ 数据库/ ,/ 在/ 被/ 备份/ 的/ 历史数据/ 中/ ,/ 同一/ 实体/ 也/ 可能/ 存在/ 多条/ 历史记录/ ./ 时效/ 约束/ 是/ 数据/ 的/ 语义/ 信息/ ,/ 可以/ 辅助/ 恢复/ 同一/ 实体/ 不同/ 属性/ 值/ 的/ 部分/ 时序/ 关系/ [/ 3/ ]/ ,/ 进而/ 判定/ 数据/ 集合/ 的/ 时效性/ ./ 我们/ 用例/ 1/ 来/ 说明/ 如何/ 结合/ 冗余/ 记录/ 和/ 时效/ 约束/ 来/ 恢复/ 时序/ 关系/ ./ 例/ 1/ ./ 考虑/ 图/ 1/ 所示/ 的/ 数据/ 集合/ D/ ./ D/ 中有/ 4/ 条/ 记录/ 描述/ 实体/ Alice/ 在/ 过去/ 某/ 段时间/ 的/ 工作/ 情况/ ,/ 其中/ ,/ tID/ 、/ EID/ 、/ FN/ 、/ LN/ 、/ City/ 、/ Salary/ 和/ Status/ 分别/ 表示/ 记录/ ID/ 、/ 实体/ ID/ 、/ 姓/ 、/ 名/ 、/ 工作/ 城市/ 、/ 工资/ 和/ 婚姻状况/ ./ tIDEIDFNLNCitySalaryStatust11AliceSmithBeijing50kSinglet21AliceSmithShanghai70kSinglet31AliceGreenGuangzhou80kMarriedt41AliceGreenHarbin80kMarried/ 时间/ 及/ 插入/ 时间/ ,/ 但/ 有/ 时效/ 约束/ 如下/ :/ 最新/ 值/ ./ Married/ ,/ 再/ 变成/ Divorced/ ./ 假设/ D/ 中/ 无/ 可用/ 时间/ 戳/ 可以/ 表示/ 数据/ 的/ 生成/ cc1/ :/ 同一个/ 人/ 的/ 工资/ 不会/ 随/ 时间/ 下降/ ./ cc2/ :/ 存有/ 工资/ 最新/ 值/ 的/ 记录/ 也/ 存有/ 工作/ 城市/ 的/ cc3/ :/ 同一个/ 人/ 的/ 婚姻状况/ 只能/ 由/ Single/ 变成/ 我们/ 用/ ti/ / Atj/ 表示/ 属性/ 值/ ti/ [/ A/ ]/ 比/ tj/ [/ A/ ]/ 旧/ ,/ 将/ ti/ 和/ tj/ 的/ A/ 属性/ 值/ 新旧/ 程度/ 相同/ 记为/ ti/ =/ Atj/ 由/ 约束/ cc1/ 可知/ ,/ 因为/ Alice/ 的/ Salary/ 取值/ 从小到大/ 为/ 50k/ </ 70k/ </ 80k/ =/ 80k/ ,/ 所以/ t1/ / Salaryt2/ / Salaryt3/ =/ Salaryt4/ ./ 同理/ ,/ 由/ cc3/ 可得/ t1/ =/ Statust2/ / Statust3/ =/ Statust4/ ./ 结合/ cc1/ 和/ cc2/ ,/ 在/ City/ 属性/ 上/ 有/ t1/ / Cityt2/ / Cityt3/ 和/ t1/ / Cityt2/ / Cityt4/ ./ 注意/ ,/ 在/ Salary/ 属性/ 上/ ,/ 由/ t3/ [/ Salary/ ]/ =/ t4/ [/ Salary/ ]/ 可得/ t3/ =/ Salaryt4/ ,/ 但/ 同样/ 的/ 判断/ 在/ City/ 属性/ 上/ 并/ 不/ 成立/ ,/ 因为/ t3/ [/ City/ ]/ ≠/ t4/ [/ City/ ]/ ./ 在/ 这种/ 情况/ 下/ ,/ 我们/ 只能/ 恢复/ 出/ City/ 属性/ 上/ 的/ 部分/ 时序/ 关系/ ./ 如例/ 1/ 所示/ ,/ 当/ 数据/ 集合/ 中/ 不/ 存在/ 可用/ 时间/ 戳/ ,/ 但/ 存在/ 冗余/ 记录/ 和/ 时效/ 约束/ 时/ ,/ 我们/ 能够/ 有效/ 地/ 恢复/ 该/ 数据/ 集合/ 上/ 的/ 部分/ 时序/ 关系/ ,/ 并/ 判定/ 数据/ 集合/ 在/ 给定/ 的/ 时效/ 约束/ 下/ 的/ 时效性/ ./ 文献/ [/ 3/ ]/ 是/ 当前/ 数据/ 质量/ 领域/ 中/ 唯一/ 一篇/ 研究/ 数据/ 时效性/ 的/ 工作/ ,/ 该/ 文献/ 利用/ 由/ 冗余/ 记录/ 和/ 时效/ 约束/ 恢复/ 得到/ 的/ 时序/ 关系/ 对/ 数据/ 的/ 时效性/ 进行/ 了/ 建模/ ,/ 但/ 遗憾/ 的/ 是/ ,/ 文献/ [/ 3/ ]/ 并/ 没有/ 给出/ 任何/ 能/ 判定/ 数据/ 时效性/ 的/ 算法/ ./ 本文/ 在/ 文献/ [/ 3/ ]/ 的/ 基础/ 上/ ,/ 研究/ 包含/ 冗余/ 记录/ 的/ 数据/ 集合/ 在/ 给定/ 的/ 时效/ 约束/ 下/ 的/ 时效性/ 判定/ 问题/ ,/ 主要/ 解决/ 了/ 数据/ 相对/ 于/ 查询/ 的/ 时效性/ 判定/ 问题/ 、/ 数据/ 相对/ 于/ 用户/ 的/ 时效性/ 判定/ 问题/ ./ 我们/ 把/ 数据/ 相对/ 于/ 查询/ 的/ 时效性/ 称为/ 查询/ 相关/ 时效性/ ./ 当/ 用户/ 向/ 时效性/ 不佳/ 的/ 数据/ 发出/ 查询/ 时/ ,/ 查询/ 结果/ 的/ 时效性/ 也/ 不能/ 保证/ ,/ 所以/ 需要/ 将/ 查询/ 结果/ 及其/ 时效性/ 判定/ 结果/ 一同/ 返回/ 给/ 用户/ ./ 为了/ 求解/ 此/ 问题/ ,/ 我们/ 将/ 查询/ 归结为/ 2/ 类/ :/ 最新/ 值/ 查询/ 和/ 时效/ 序/ Page3/ 列/ 查询/ ./ 对/ 每类/ 查询/ ,/ 分/ 两步/ 求解/ 数据/ 相对/ 于/ 该类/ 查询/ 的/ 时效性/ 判定/ 问题/ :/ 第/ 1/ 步/ ,/ 对于/ 给定/ 的/ 数据/ 集合/ D/ 和/ 查询/ Q/ ,/ 判定/ Q/ 在/ D/ 上/ 的/ 查询/ 结果/ 的/ 时效性/ ;/ 第/ 2/ 步/ ,/ 基于/ 第/ 1/ 步/ 的/ 判定/ 方法/ ,/ 将/ 每类/ 查询/ 作为/ 一个/ 整体/ ,/ 判定/ 数据/ 集合/ D/ 相对/ 于/ 该类/ 所有/ 查询/ 的/ 平均/ 时效性/ ./ 我们/ 将/ 数据/ 相对/ 于/ 用户/ 的/ 时效性/ 称为/ 用户/ 相关/ 时效性/ ./ 面对/ 同一个/ 数据/ 集合/ ,/ 不同/ 的/ 用户/ 会/ 有/ 不同/ 的/ 需求/ ,/ 这些/ 需求/ 可以/ 通过/ 查询/ 来/ 体现/ ./ 例如/ ,/ 企业/ 中/ 薪酬/ 分析/ 人员/ 的/ 查询/ 集中/ 于/ “/ 职位/ ”/ 和/ “/ 工资/ ”/ 属性/ ,/ 而/ 销售/ 经理/ 则/ 更/ 倾向/ 于/ 查询/ 员工/ 在/ 不同/ 城市/ 的/ 销售/ 业绩/ ./ 对于/ 特定/ 用户/ ,/ 其/ 查询/ 往往/ 集中/ 于/ 某/ 一类/ ,/ 甚至/ 某/ 几个/ 查询/ ,/ 那么/ 只要/ 保证数据/ 相对/ 于/ 这些/ 常用/ 查询/ 的/ 时效性/ 良好/ ,/ 数据/ 对于/ 用户/ 来说/ ,/ 时效性/ 就/ 高/ ./ 因此/ ,/ 数据/ 相对/ 于/ 用户/ 的/ 时效性/ 判定/ 问题/ 可以/ 归结为/ 常用/ 查询/ 的/ 查询/ 结果/ 的/ 时效性/ 判定/ 问题/ ./ 我们/ 给出/ 了/ 此类/ 判定/ 问题/ 的/ 求解/ 方法/ ./ 本文/ 贡献/ 如下/ :/ (/ 1/ )/ 研究/ 了/ 包含/ 冗余/ 记录/ 的/ 数据/ 集合/ 在/ 给定/ 时效/ 约束/ 下/ 的/ 时效性/ 判定/ 问题/ ,/ 并/ 给出/ 了/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 的/ 定义/ ./ (/ 2/ )/ 将/ 查询/ 归结为/ 2/ 类/ ,/ 提出/ 了/ 时效/ 图/ 的/ 概念/ ,/ 给出/ 了/ 数据/ 相对/ 于/ 查询/ 的/ 时效性/ 判定/ 问题/ 的/ 求解/ 算法/ ./ 方法/ ./ (/ 3/ )/ 给出/ 了/ 数据/ 相对/ 于/ 用户/ 时效性/ 的/ 判定/ (/ 4/ )/ 通过/ 大量/ 实验/ ,/ 研究/ 了/ 各个/ 参数/ 对/ 时效性/ 判定/ 结果/ 及/ 算法/ 效率/ 的/ 影响/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 给出/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 的/ 定义/ ;/ 第/ 4/ 节/ 提出/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 的/ 判定/ 方法/ ;/ 第/ 5/ 节/ 讨论/ 实验/ 结果/ ;/ 第/ 6/ 节/ 给出/ 本文/ 结论/ 及/ 未来/ 研究/ 方向/ ./ 2/ 相关/ 工作/ 文献/ [/ 3/ ]/ 首次/ 研究/ 了/ 数据库/ 的/ 时效性/ 建模/ 问题/ ,/ 该/ 文献/ 分/ 3/ 部分/ 对/ 数据/ 的/ 时效性/ 建模/ :/ 时序/ 关系/ 、/ 时效/ 约束/ 、/ 不同/ 数据源/ 间/ 的/ 拷贝/ 函数/ ./ 时序/ 关系/ ti/ / Atj/ 的/ 定义/ 与/ 例/ 1/ 中/ 相同/ ./ 时效/ 约束/ 定义/ 为/ 一阶/ 逻辑/ 语句/ ,/ 能够/ 描述/ 数据/ 的/ 语义/ 信息/ ./ 当/ 数据/ 来自/ 于/ 多个/ 数据源/ 时/ ,/ 拷贝/ 函数/ 可以/ 描述/ 不同/ 数据源/ 间/ 的/ 依赖/ 关系/ (/ 如/ 数据源/ D1/ 的/ 某些/ 数据/ 可能/ 拷贝/ 自/ 数据源/ D2/ )/ ./ 本文/ 继承/ 了/ 文献/ [/ 3/ ]/ 中/ 时序/ 关系/ 和/ 时效/ 约束/ 的/ 定义/ ,/ 但/ 研究/ 的/ 内容/ 有所不同/ ./ 首先/ ,/ 本文/ 研究/ 数据/ 的/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 判定/ 问题/ ,/ 文献/ [/ 3/ ]/ 没有/ 研究/ 这/ 两个/ 问题/ ./ 其次/ ,/ 本文/ 给出/ 了/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 的/ 判定/ 算法/ ,/ 而/ 文献/ [/ 3/ ]/ 没有/ 给出/ 任何/ 数据/ 时效性/ 判定/ 的/ 算法/ ./ 第三/ ,/ 文献/ [/ 3/ ]/ 研究/ 的/ 判定/ 问题/ 多为/ NP/ 完全/ 或/ 更/ 难/ ,/ 这/ 给/ 该/ 模型/ 应用/ 于/ 实际/ 带来/ 了/ 不小/ 的/ 困难/ ,/ 而/ 本文/ 对/ 时效/ 约束/ 进行/ 了/ 更/ 具体/ 的/ 分析/ ,/ 使得/ 在/ 本文/ 定义/ 的/ 场景/ 下/ ,/ 能够/ 在/ 多项式/ 时间/ 内/ 判定/ 数据/ 的/ 时效性/ ./ 真值/ 发现/ [/ 4/ -/ 6/ ]/ 研究/ 如何/ 发现/ 多个/ 数据源/ 之间/ 的/ 依赖/ ,/ 即/ 前文/ 所述/ 的/ 拷贝/ 函数/ ./ 这些/ 工作/ 能够/ 在/ 多/ 数据源/ 环境/ 下/ ,/ 根据/ 数据源/ 的/ 依赖/ 关系/ 发现/ 过时/ 数据/ ,/ 但/ 因为/ 其/ 目标/ 在于/ 对/ 不/ 一致/ 数据/ 发现/ 真值/ ,/ 并/ 不/ 研究/ 数据/ 时效性/ ,/ 所以/ 与/ 本文/ 工作/ 不同/ ./ 时间/ 数据库/ [/ 7/ -/ 8/ ]/ 研究/ 数据库/ 对/ 时间/ 维度/ 的/ 支持/ ./ 这些/ 工作/ 与/ 本文/ 工作/ 有/ 三点/ 不同/ :/ (/ 1/ )/ 时间/ 数据库/ 假设/ 数据/ 有/ 完整/ 、/ 清洁/ 、/ 可用/ 的/ 时间/ 戳/ ,/ 而/ 本文/ 不/ 假设/ 数据/ 有/ 时间/ 戳/ ;/ (/ 2/ )/ 时间/ 数据库/ 侧重于/ 研究/ 如何/ 让/ 数据库/ 对/ 时间/ 有/ 更好/ 的/ 支持/ ,/ 并/ 不/ 考虑/ 数据/ 时效性/ 能否/ 满足用户/ 需求/ ;/ (/ 3/ )/ 时间/ 数据库/ 假定/ 同一/ 记录/ 的/ 所有/ 属性/ 时效性/ 相同/ ,/ 而/ 本文/ 没有/ 这一/ 假定/ ./ 时间/ 约束/ (/ temporalconstraints/ )/ 研究/ [/ 9/ ]/ 看似/ 与/ 时效性/ 研究/ 相关/ ,/ 实际/ 不同/ ./ 时间/ 约束/ 研究/ 主要/ 集中/ 在/ 约束/ 与/ 满足/ 约束/ 的/ 变量/ 之间/ 的/ 关系/ ,/ 与/ 本文/ 研究/ 的/ 时效性/ 判定/ 问题/ 不同/ ./ 时间/ 约束/ 的/ 定义/ 也/ 与/ 本文/ 研究/ 的/ 时效/ 约束/ 不同/ ./ 3/ 数据/ 时效性/ 定义/ 3.1/ 预备/ 知识/ 本文/ 假设/ 数据/ 集合/ 中/ 可以/ 有/ 多条/ 记录/ 描述/ 同一/ 实体/ ,/ 且/ 实体/ 识别/ 工作/ [/ 10/ ]/ 已经/ 完成/ ./ 令/ 数据/ 模式/ R/ =/ (/ tID/ ,/ EID/ ,/ A1/ ,/ …/ ,/ An/ )/ ,/ 其中/ ,/ tID/ 表示/ 记录/ ID/ ;/ EID/ 表示/ 实体/ ID/ ,/ 如果/ ti/ [/ EID/ ]/ =/ tj/ [/ EID/ ]/ ,/ 则/ ti/ 和/ tj/ 描述/ 同一/ 实体/ ;/ A1/ ,/ …/ ,/ An/ 是/ n/ 个/ 属性/ ,/ ti/ [/ A/ ]/ 表示/ 记录/ ti/ 的/ A/ 属性/ 值/ ./ 当/ 描述/ 同一/ 实体/ 的/ 记录/ 在/ 同一/ 属性/ 上/ 有/ 多种/ 取值/ 时/ ,/ 时序/ 关系/ 可以/ 描述/ 各值/ 的/ 新旧/ 情况/ ,/ 形式化/ 定义/ 如下/ ./ 定义/ 1/ ./ 时序/ 关系/ (/ CurrencyOrder/ )/ ./ 设/ D/ 是/ 数据/ 模式/ R/ 的/ 数据/ 集合/ 实例/ ./ D/ 中/ 记录/ ti/ 和/ tj/ 满足/ 属性/ A/ 上/ 时序/ 关系/ ti/ / Atj/ 当且/ 仅/ 当/ 下述/ 条件/ 同时/ 成立/ :/ ①/ ti/ [/ EID/ ]/ =/ tj/ [/ EID/ ]/ ;/ Page4/ ②/ ti/ [/ A/ ]/ 先于/ tj/ [/ A/ ]/ 出现/ 在/ D/ 中/ ./ 例如/ ,/ 在/ 图/ 1/ 所示/ 的/ 数据/ 集合/ 中/ ,/ 如果/ Alice2009/ 年/ 的/ City/ 值为/ Beijing/ ,/ 2010/ 年/ 的/ City/ 值为/ Shanghai/ ,/ 则/ t1/ / Cityt2/ ./ 时序/ 关系/ 是/ 一个/ 传递/ 关系/ ./ 记录/ 间/ 的/ 时序/ 关系/ 需要/ 通过/ 时效/ 约束/ 来/ 判定/ ./ 时效/ 约束/ 的/ 形式化/ 定义/ 如下/ ./ 定义/ 2/ ./ 时效/ 约束/ (/ CurrencyConstraints/ )/ ./ 设/ Ai/ 是/ 模式/ R/ 的/ 属性/ ./ R/ 在/ Ai/ 上/ 的/ 时效/ 约束/ 定义/ 为/ 如下/ 一阶/ 逻辑/ 语句/ :/ / t1/ ,/ …/ ,/ tk/ :/ R/ (/ ∧/ j/ ∈/ [/ 1/ ,/ k/ ]/ (/ t1/ [/ EID/ ]/ =/ tj/ [/ EID/ ]/ )/ ∧/ ψ/ →/ tu/ / Aitv/ )/ ,/ 其中/ ,/ R/ 是/ 数据/ 模式/ ;/ t1/ ,/ …/ ,/ tk/ 是/ 模式/ R/ 的/ 任意/ 实例/ 的/ k/ 条/ 记录/ ;/ ψ/ 是/ 谓词/ ;/ ∧/ j/ ∈/ [/ 1/ ,/ k/ ]/ (/ t1/ [/ EID/ ]/ =/ tj/ [/ EID/ ]/ )/ ∧/ ψ/ 称为/ 时效/ 约束/ 前/ 件/ ;/ tu/ / Aitv/ 称为/ 时效/ 约束/ 后件/ ./ 例/ 1/ 中/ 的/ cc1/ 、/ cc2/ 可以/ 表示/ 为式/ (/ 1/ )/ 、/ (/ 2/ )/ 所示/ 的/ 约束/ ,/ cc3/ 可/ 写成/ (/ 3/ )/ 、/ (/ 4/ )/ 两条/ 约束/ ./ / s/ ,/ t/ :/ Emp/ (/ t/ [/ EID/ ]/ =/ s/ [/ EID/ ]/ ∧/ t/ [/ Salary/ ]/ </ / s/ ,/ t/ :/ Emp/ (/ t/ [/ EID/ ]/ =/ s/ [/ EID/ ]/ ∧/ t/ / Salarys/ →/ t/ / Citys/ )/ / s/ ,/ t/ :/ Emp/ (/ t/ [/ EID/ ]/ =/ s/ [/ EID/ ]/ ∧/ (/ t/ [/ Status/ ]/ =/ s/ [/ Salary/ ]/ →/ t/ / Salarys/ )/ Single/ ∧/ s/ [/ Status/ ]/ =/ Married/ )/ →/ t/ / Statuss/ )/ / s/ ,/ t/ :/ Emp/ (/ t/ [/ EID/ ]/ =/ s/ [/ EID/ ]/ ∧/ (/ t/ [/ Status/ ]/ =/ Married/ ∧/ s/ [/ Status/ ]/ =/ Divorced/ )/ →/ t/ / Statuss/ )/ 3.2/ 查询/ 相关/ 时效性/ 根据/ R/ 在/ Ai/ 上/ 的/ 时效/ 约束/ 能够/ 得到/ 描述/ 某/ 实体/ 的/ 记录/ 在/ Ai/ 上/ 的/ 时序/ 关系/ ,/ 因此/ 使用/ 时效/ 约束/ 时/ 只/ 需/ 知道/ 待/ 判断/ 的/ 实体/ 和/ 属性/ 分别/ 是/ 什么/ 即可/ ./ 设/ 查询/ 为/ Q/ ,/ 那么/ 基于/ 时效/ 约束/ 判定/ 查询/ 相关/ 时效性/ 时/ 就/ 需要/ 把/ Q/ 抽象/ 成/ 三元组/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ QType/ )/ ,/ 其中/ ,/ eQ/ 表示/ 被/ 查询/ 的/ 实体/ ;/ Attr/ (/ Q/ )/ 表示/ 被/ 查询/ 的/ 属性/ 集合/ ;/ QType/ 表示/ Q/ 所属/ 的/ 查询/ 类别/ ./ 查询/ 类别/ 有/ 最新/ 值/ 查询/ 和/ 时效/ 序列/ 查询/ 2/ 种/ ,/ 用/ curQ/ 表示/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ ,/ curQ/ 的/ 值域/ 为/ [/ 0/ ,/ 1/ ]/ ,/ 其值/ 越/ 接近/ 1/ 则/ 查询/ 结果/ 的/ 时效性/ 越/ 好/ ,/ 越/ 接近/ 0/ 则/ 查询/ 结果/ 的/ 时效性/ 越差/ ,/ 两种/ 查询/ 相对/ 应/ 的/ 查询/ 相关/ 时效性/ 分别/ 定义/ 如下/ ./ 3.2/ ./ 1/ 最新/ 值/ 查询/ 最新/ 值/ 查询/ (/ CurrentValueQuery/ ,/ CVQ/ )/ 只/ 关心/ 某/ 实体/ 的/ 最新/ 状态/ ,/ 即/ eQ/ 的/ Attr/ (/ Q/ )/ 中/ 属性/ 的/ “/ 最新/ 值/ ”/ ./ 典型/ 的/ CVQ/ 形如/ 查询/ Q1/ :/ “/ Alice/ 当前/ 的/ 工作/ 城市/ 和/ 工资/ ”/ ,/ 即/ Q1/ =/ (/ Alice/ ,/ {/ City/ ,/ Salary/ }/ ,/ CVQ/ )/ ./ 为了/ 判定/ CVQ/ 查询/ 相关/ 时效性/ ,/ 首先/ 要/ 对/ 给定/ 的/ 数据/ 集合/ D/ 和/ 查询/ Q/ ,/ 判定/ Q/ 在/ D/ 上/ 的/ 查询/ 结果/ 的/ 时效性/ ./ 设/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ ,/ 则/ 为了/ 回答/ Q/ ,/ 需要/ 给/ eQ/ 的/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 找到/ 其/ 唯一/ 确定/ 的/ 最新/ 值/ ./ 如果/ 这样/ 的/ 最新/ 值/ 不能/ 被/ 找到/ ,/ 那么/ Q/ 就/ 无法/ 被/ 准确/ 地/ 回答/ ,/ 其/ 查询/ 结果/ 的/ 时效性/ 自然/ 也/ 受到/ 影响/ ./ 因此/ 在/ 判定/ CVQ/ 查询/ 结果/ 的/ 时效性/ 时/ ,/ 首先/ 需要/ 为/ Attr/ (/ Q/ )/ 的/ 属性/ Ai/ 找到/ 一个/ 记录/ 集合/ TAi/ ,/ 使得/ 对/ 任意/ 记录/ t/ ∈/ TAi/ ,/ t/ [/ Ai/ ]/ 是/ eQ/ 的/ 一个/ 可能/ 的/ Ai/ 最新/ 值/ ./ TAi/ 称为/ Ai/ 相对/ 于/ Q/ 的/ 最新/ 记录/ 集合/ ,/ 形式化/ 定义/ 如下/ ./ 定义/ 3/ ./ Ai/ 相对/ 于/ Q/ 的/ 最新/ 记录/ 集合/ ./ 设/ D/ 是/ 数据/ 模式/ R/ 的/ 数据/ 集合/ 实例/ ,/ eQ/ 是/ D/ 中/ 某个/ 实体/ ,/ 查询/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ ,/ 记录/ 集合/ TAi/ 称为/ Ai/ 相对/ 于/ Q/ 的/ 最新/ 记录/ 集合/ ,/ 当且/ 仅/ 当/ 对/ / t/ ∈/ TAi/ ,/ t/ 满足/ 下述/ 两个/ 条件/ :/ ①/ t/ [/ EID/ ]/ 等于/ eQ/ 的/ ID/ ;/ ②/ 不/ 存在/ 记录/ s/ ,/ 使得/ 根据/ R/ 在/ Ai/ 上/ 的/ 时效/ 约束/ 能够/ 推出/ t/ / Ais/ ./ 理想/ 情况/ 下/ ,/ eQ/ 的/ Ai/ 最新/ 值/ 唯一/ 确定/ ,/ 即/ 下述/ 两种/ 情况/ 其中/ 之一/ 成立/ :/ TAi/ 只/ 包含/ 一条/ 记录/ ;/ 或/ TAi/ 包含/ 多条/ 记录/ ,/ 但/ 对/ / s/ ,/ t/ ∈/ TAi/ 有/ s/ [/ Ai/ ]/ =/ t/ [/ Ai/ ]/ ./ 这时/ 可/ 认为/ eQ/ 的/ Ai/ 最新/ 值/ 的/ 确定/ 度为/ 1/ ./ 但/ 因/ 时效/ 约束/ 作用/ 有限/ ,/ 所以/ 可能/ 存在/ s/ ,/ t/ ∈/ TAi/ ,/ 有/ s/ [/ Ai/ ]/ ≠/ t/ [/ Ai/ ]/ ,/ 这时/ Ai/ 有/ 多个/ 可能/ 的/ 最新/ 值/ ./ 设/ TAi/ 中/ 的/ 记录/ 共有/ cnt/ (/ TAi/ )/ 种/ 不同/ 的/ Ai/ 值/ ,/ 那么/ eQ/ 的/ Ai/ 最新/ 值/ 的/ 确定/ 度/ 就是/ 1/ // cnt/ (/ TAi/ )/ ./ 1/ // cnt/ (/ TAi/ )/ 称为/ Ai/ 对/ Q/ 的/ 时效性/ 贡献/ ,/ 对/ Attr/ (/ Q/ )/ 中/ 所有/ 属性/ 的/ 时效性/ 贡献/ 求/ 平均/ ,/ 就/ 得到/ Q/ 查询/ 结果/ 的/ 时效性/ ./ 下面/ 给出/ CVQ/ 查询/ 结果/ 时效性/ 的/ 形式化/ 定义/ ./ 定义/ 4/ ./ CVQ/ 查询/ 结果/ 的/ 时效性/ ./ 设/ D/ 是/ 模式/ R/ 的/ 数据/ 集合/ 实例/ ,/ 查询/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ ,/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ curQ/ 定义/ 如下/ :/ 其中/ ,/ |/ Attr/ (/ Q/ )/ |/ 是/ Attr/ (/ Q/ )/ 中/ 属性/ 的/ 数目/ ;/ TAi/ 是/ Ai/ 相对/ 于/ Q/ 的/ 最新/ 记录/ 集合/ ./ 当/ Attr/ (/ Q/ )/ 中/ 各/ 属性/ 重要性/ 不/ 同时/ ,/ 在/ 判定/ 时效性/ 时/ ,/ 可/ 对/ 属性/ 按/ 重要性/ 加权/ ./ 设/ 属性/ Ai/ 权值/ 为/ wAi/ ,/ 则/ ∑/ Ai/ ∈/ Attr/ (/ Q/ )/ wAi/ =/ 1/ ./ 式/ (/ 5/ )/ 等价/ 于/ 各/ 属性/ 权值/ 均/ Page5/ 为/ 1/ // |/ Attr/ (/ Q/ )/ |/ 的/ 情况/ ,/ 当/ Attr/ (/ Q/ )/ 中/ 各/ 属性/ 权值/ 不/ 相等/ 时/ ,/ 可以/ 将式/ (/ 5/ )/ 修改/ 为式/ (/ 6/ )/ ,/ 用式/ (/ 6/ )/ 来/ 计算/ 查询/ 结果/ 的/ 时效性/ ./ 解决/ CVQ/ 的/ 查询/ 相关/ 时效性/ 判定/ 问题/ 的/ 第/ 2/ 步是/ 将/ 所有/ 的/ CVQ/ 查询/ 作为/ 一个/ 整体/ ,/ 判定/ 数据/ 相对/ 于/ 所有/ CVQ/ 查询/ 的/ 平均/ 时效性/ (/ 称为/ CVQ/ 平均/ 时效性/ )/ ./ CVQ/ 平均/ 时效性/ 与/ CVQ/ 查询/ 结果/ 的/ 时效性/ 的/ 定义/ 非常/ 相似/ ,/ 区别/ 仅/ 在于/ CVQ/ 平均/ 时效性/ 需要/ 对/ 数据/ 集合/ D/ 中/ 的/ 每个/ 实体/ 的/ 每个/ 属性/ 计算/ 时效性/ 贡献/ ,/ 对/ 所有/ 的/ 时效性/ 贡献/ 求/ 加权/ 和/ ,/ 以/ 之/ 作为/ D/ 的/ CVQ/ 平均/ 时效性/ ./ 3.2/ ./ 2/ 时效/ 序列/ 查询/ 时效/ 序列/ 查询/ (/ CurrencySequenceQuery/ ,/ CSQ/ )/ 关心/ 实体/ 的/ 历史/ 信息/ ,/ 即/ 描述/ eQ/ 的/ 记录/ 在/ Attr/ (/ Q/ )/ 中/ 的/ 属性/ 上/ 的/ 时序/ 关系/ ./ 典型/ 的/ CSQ/ 形如/ 查询/ Q2/ :/ “/ Alice/ 先后/ 在/ 哪些/ 城市/ 工作/ 过/ ”/ ./ 即/ Q2/ =/ (/ Alice/ ,/ {/ City/ }/ ,/ CSQ/ )/ ./ 在/ 图/ 1/ 所示/ 的/ 数据/ 集合/ 实例/ 中/ ,/ Alice/ 的/ City/ 属性/ 有/ 4/ 个/ 不同/ 值/ :/ “/ Beijing/ ”/ 、/ “/ Shanghai/ ”/ 、/ “/ Guangzhou/ ”/ 、/ “/ Harbin/ ”/ ./ 回答/ Q2/ 时/ ,/ 需要/ 找到/ 相应/ 的/ 4/ 条/ 记录/ 在/ City/ 属性/ 上/ ,/ 根据/ 时序/ 关系/ “/ / City/ ”/ 排成/ 的/ 序列/ ,/ 如/ t1/ / Cityt2/ / Cityt3/ / Cityt4/ ,/ 我们/ 将/ 这样/ 的/ 序列/ 称为/ 时效/ 序列/ ./ 为了/ 判定/ CSQ/ 查询/ 相关/ 时效性/ ,/ 首先/ 要/ 对/ 给定/ 的/ 数据/ 集合/ D/ 和/ 查询/ Q/ ,/ 判定/ Q/ 在/ D/ 上/ 的/ 查询/ 结果/ 的/ 时效性/ ./ CSQ/ 不/ 关心/ 最新/ 值/ ,/ 而/ 关心/ 记录/ 的/ 时序/ 关系/ ,/ 如果/ 所/ 需/ 的/ 时序/ 关系/ 不能/ 被/ 唯一/ 确定/ ,/ 那么/ CSQ/ 就/ 无法/ 被/ 准确/ 回答/ ,/ 其/ 查询/ 结果/ 的/ 时效性/ 也/ 受到/ 影响/ ./ 设/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CSQ/ )/ ,/ 为了/ 回答/ Q/ ,/ 需要/ 为/ eQ/ 在/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 上/ 找到/ 最长/ 的/ 时效/ 序列/ ./ 设/ eQ/ 在/ Ai/ 上/ 的/ 最长/ 时效/ 序列/ 为/ SqAi/ ,/ 当前/ 数据/ 集合/ 实例/ 中共/ 有/ l/ 条/ 不同/ 的/ 记录/ 描述/ 实体/ eQ/ ,/ 则/ 理想/ 情况/ 下/ SqAi/ 的/ 长度/ (/ 记/ 为/ |/ SqAi/ |/ )/ 应当/ 为/ l/ ./ 这时/ eQ/ 在/ 属性/ Ai/ 上/ 的/ 时效/ 序列/ 的/ 确定/ 度为/ 1/ ./ 但/ 因为/ 时效/ 约束/ 作用/ 有限/ ,/ 所以/ 通常/ 情况/ 下/ |/ SqAi/ |/ </ l/ ,/ 此时/ eQ/ 在/ Ai/ 上/ 的/ 时效/ 序列/ 的/ 确定/ 度为/ SqAi/ // l/ ./ SqAi/ // l/ 称为/ Ai/ 对/ Q/ 的/ 时效性/ 贡献/ ,/ 对/ Attr/ (/ Q/ )/ 中/ 所有/ 属性/ 的/ 时效性/ 贡献/ 求/ 平均/ ,/ 就/ 得到/ Q/ 查询/ 结果/ 的/ 时效性/ ./ CSQ/ 查询/ 结果/ 时效性/ 的/ 形式化/ 定义/ 如下/ ./ 定义/ 5/ ./ CSQ/ 查询/ 结果/ 的/ 时效性/ ./ 设/ D/ 是/ 模式/ R/ 的/ 数据/ 集合/ 实例/ ,/ 查询/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CSQ/ )/ ,/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ curQ/ 定义/ 如下/ :/ 其中/ ,/ |/ Attr/ (/ Q/ )/ |/ 、/ SqAi/ 和/ l/ 的/ 定义/ 与/ 前文/ 相同/ ./ 与/ CVQ/ 类似/ ,/ 当/ 属性/ 重要性/ 不/ 同时/ 可以/ 对/ Attr/ (/ Q/ )/ 中/ 属性/ 按/ 重要性/ 加权/ ,/ 并/ 以/ Attr/ (/ Q/ )/ 中/ 属性/ 时效性/ 贡献/ 的/ 加权/ 和/ 作为/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ ./ 判定/ CSQ/ 查询/ 相关/ 时效性/ 的/ 第二步/ 是/ 将/ 所有/ 的/ CSQ/ 查询/ 作为/ 一个/ 整体/ ,/ 判定/ 其/ 查询/ 结果/ 的/ 平均/ 时效性/ (/ 称为/ CSQ/ 平均/ 时效性/ )/ ./ 与/ CVQ/ 类似/ ,/ 可/ 对/ 数据/ 集合/ D/ 中/ 的/ 每个/ 实体/ 的/ 每个/ 属性/ 计算/ 时效性/ 贡献/ ,/ 对/ 所有/ 的/ 时效性/ 贡献/ 求/ 加权/ 和/ ,/ 以/ 之/ 作为/ 数据/ 集合/ D/ 的/ CSQ/ 平均/ 时效性/ ./ 3.3/ 用户/ 相关/ 时效性/ 如/ 引言/ 中/ 所述/ ,/ 用户/ 需求/ 往往/ 通过/ 查询/ 来/ 体现/ ,/ 具体表现/ 在/ 用户/ 使用/ 数据/ 时/ 往往/ 偏好/ 某/ 一类/ 、/ 甚至/ 某/ 几个/ 查询/ ./ 可以/ 按照/ 对/ 查询/ 的/ 偏好/ 将/ 用户/ 分为/ 3/ 类/ :/ 第/ 1/ 类/ 用户/ 对/ 查询/ 没有/ 偏好/ ;/ 第/ 2/ 类/ 用户/ 对/ CVQ/ 和/ CSQ/ 的/ 平均/ 时效性/ 要求/ 不同/ ,/ 若/ 用户/ 更/ 关心/ 实体/ 当前/ 的/ 状态/ ,/ 则/ 对/ CVQ/ 平均/ 时效性/ 要求/ 更高/ ,/ 若/ 用户/ 更/ 关心/ 记录/ 的/ 时序/ 关系/ ,/ 则/ 对/ CSQ/ 平均/ 时效性/ 要求/ 更高/ ;/ 第/ 3/ 类/ 用户/ 对/ 某些/ 常用/ 查询/ 的/ 结果/ 时效性/ 要求/ 较/ 高/ ,/ 例如/ ,/ 薪酬/ 分析/ 人员/ 经常/ 查询/ 员工/ 的/ 工资/ 信息/ ,/ 其/ 常用/ 查询/ 集合/ 里/ 就/ 包含/ 那些/ 和/ “/ Salary/ ”/ 属性/ 相关/ 的/ CVQ/ 或/ CSQ/ 查询/ ./ 第/ 1/ 类/ 用户/ 对/ 查询/ 没有/ 偏好/ ,/ 故/ 在/ 判定/ 该类/ 用户/ 相关/ 时效性/ 时/ ,/ 所有/ 查询/ 的/ 重要性/ 权值/ 相等/ ./ 所以/ ,/ 第/ 1/ 类/ 用户/ 相关/ 时效性/ 定义/ 为/ CVQ/ 和/ CSQ/ 的/ 平均/ 时效性/ 的/ 平均数/ ./ 对于/ 第/ 2/ 类/ 用户/ 来说/ ,/ CVQ/ 和/ CSQ/ 的/ 重要/ 程度/ 不同/ ,/ 因此/ ,/ 第/ 2/ 类/ 用户/ 相关/ 时效性/ 定义/ 为/ CVQ/ 和/ CSQ/ 平均/ 时效性/ 的/ 加权/ 和/ ,/ 权值/ 取决于/ 该类/ 查询/ 对/ 用户/ 的/ 重要/ 程度/ ,/ CVQ/ 和/ CSQ/ 的/ 权值/ 之/ 和/ 等于/ 1/ ./ 第/ 1/ 类/ 和/ 第/ 2/ 类/ 用户/ 相关/ 时效性/ (/ 记为/ curuser/ )/ 可/ 统一/ 表示/ 为式/ (/ 8/ )/ ./ 在/ 判定/ 对/ 第/ 1/ 类/ 用户/ 相关/ 时效性/ 时/ 只/ 需令式/ (/ 8/ )/ 中/ 的/ wCVQ/ =/ wCSQ/ =/ 0.5/ 即可/ ./ 第/ 3/ 类/ 用户/ 对/ 某些/ 常用/ 查询/ 的/ 结果/ 时效性/ 要求/ 较/ 高/ ,/ 设/ 这些/ 查询/ 组成/ 的/ 集合/ 为/ / ,/ 则/ 需要/ 为/ / 中/ 的/ 查询/ 一一/ 判定/ 其/ 结果/ 的/ 时效性/ ./ 再/ 根据/ 查询/ 的/ 重要/ 程度/ 给/ / 中/ 的/ 查询/ 赋予/ 相应/ 的/ 权值/ ,/ 并/ 计算/ 其/ 查询/ 结果/ 时效性/ 的/ 加权/ 和/ ,/ 就/ 得到/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ ./ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 定义/ 如式/ (/ 9/ )/ 所示/ :/ Page6/ 其中/ ,/ curuser/ 表示/ 用户/ 相关/ 时效性/ ,/ Qi/ 是/ / 中/ 的/ 查询/ ,/ wQi/ 是/ Qi/ 的/ 权值/ 且/ ∑/ Qi/ ∈/ / 时效性/ ./ 3.4/ 讨论/ 对于/ 同一个/ 数据/ 集合/ ,/ 用/ 不同/ 的/ 时效性/ 判定/ 方法/ 得到/ 的/ 结果/ 可能/ 完全/ 不同/ ./ 查询/ 结果/ 时效性/ 描述/ 的/ 是/ 数据/ 相对/ 于/ 查询/ 的/ 时效性/ ,/ 其仅/ 能/ 反映/ 查询/ 涉及/ 到/ 的/ 那/ 一小部分/ 数据/ 的/ 时效性/ 如何/ ,/ 如果/ 该/ 部分/ 数据/ 时效性/ 好/ ,/ 则/ 相应/ 的/ 查询/ 结果/ 时效性/ 就/ 高/ ./ 而/ 查询/ 平均/ 时效性/ 和/ 用户/ 相关/ 时效性/ 侧重于/ 描述/ 数据/ 整体/ 的/ 时效性/ ,/ 其中/ 两类/ 查询/ 平均/ 时效性/ 分别/ 从/ 最新/ 值/ 和/ 时序/ 关系/ 两个/ 角度/ 描述/ 了/ 数据/ 整体/ 的/ 时效性/ 状况/ ,/ 而/ 用户/ 相关/ 时效性/ 则/ 是/ 针对/ 不同/ 用户/ 需求/ ,/ 描述/ 当前/ 数据/ 集合/ 的/ 时效性/ 状况/ ./ 在/ 得到/ 查询/ 相关/ 时效性/ 和/ 用户/ 相关/ 时效性/ 后/ ,/ 可以/ 进一步/ 给出/ 能够/ 提高/ 时效性/ 的/ 数据/ 修复/ 建议/ ./ 对于/ 某些/ 结果/ 时效性/ 较差/ 的/ 查询/ ,/ 可以/ 按照/ 查询/ 所属/ 类别/ ,/ 着重/ 修复/ 查询/ 涉及/ 到/ 的/ 记录/ 和/ 属性/ ,/ 即/ 确定/ 其/ 最新/ 值/ ,/ 或/ 恢复/ 时序/ 关系/ ./ 对于/ 第/ 1/ 类/ 和/ 第/ 2/ 类/ 用户/ ,/ 如果/ 用户/ 关心/ 的/ 某/ 一类/ 查询/ 的/ 平均/ 时效性/ 特别/ 差/ ,/ 则/ 可以/ 着重/ 针对/ 这/ 类/ 查询/ 来/ 修复/ 数据/ ./ 例如/ ,/ 在/ 判定/ 第/ 1/ 类/ 用户/ 相关/ 时效性/ 时/ ,/ 当前/ 数据/ 集合/ 实例/ 的/ CVQ/ 平均/ 时效性/ 为/ 0.9/ ,/ 而/ CSQ/ 的/ 平均/ 时效性/ 仅/ 0.5/ ,/ 则/ 应当/ 着重/ 恢复/ 数据/ 的/ 时序/ 关系/ ./ 对于/ 第/ 3/ 类/ 用户/ ,/ 可以/ 根据/ / 中/ 查询/ 的/ 查询/ 相关/ 时效性/ 来/ 修复/ 结果/ 时效性/ 较差/ 的/ 查询/ 涉及/ 到/ 的/ 那/ 部分/ 数据/ ,/ 从而/ 提高/ 用户/ 相关/ 时效性/ ./ 4/ 数据/ 时效性/ 判定/ 问题/ 求解/ 4.1/ 时效/ 图/ 不失/ 一般性/ 地/ ,/ 可/ 设/ 数据/ 集合/ 实例/ D/ 中/ 描述/ 实体/ e/ 的/ 记录/ 构成/ 的/ 集合/ 为/ Se/ =/ {/ t1/ ,/ …/ ,/ tk/ }/ ,/ 对/ Se/ 中/ 记录/ ti/ 和/ tj/ ,/ 可能/ 存在/ ti/ [/ A/ ]/ ≠/ tj/ [/ A/ ]/ 的/ 情况/ ,/ 假设/ 数据/ 中/ 没有/ 错误/ ,/ 则/ 时序/ 关系/ ti/ / Atj/ 和/ tj/ / Ati/ 必有/ 一个/ 成立/ ./ 时效/ 图/ Ge/ ,/ A/ 用于/ 描述/ Se/ 中/ 记录/ 在/ A/ 上/ 的/ 时序/ 关系/ ,/ 形式化/ 定义/ 如下/ ./ 定义/ 6/ ./ 时效/ 图/ (/ currencygraph/ )/ ./ 设/ e/ 为/ 数据/ 模式/ R/ 的/ 数据/ 集合/ 实例/ D/ 中/ 的/ 实体/ ,/ A/ 是/ R/ 中/ 属性/ ,/ Se/ =/ {/ t1/ ,/ …/ ,/ tk/ }/ 是/ D/ 中/ 描述/ e/ 的/ 记录/ 构成/ 的/ 集合/ ,/ 有向图/ Ge/ ,/ A/ =/ (/ V/ ,/ E/ )/ 称为/ e/ 在/ A/ 上/ 的/ 时效/ 图/ ,/ 当且/ 仅/ 当/ 下述/ 条件/ 同时/ 满足/ :/ ①/ |/ V/ |/ =/ |/ Se/ |/ ,/ 且/ V/ 中/ 的/ 任意/ 结点/ vi/ 对应/ Se/ 中/ 的/ 记录/ ti/ ;/ ②/ ti/ / Atj/ 当且/ 仅/ 当/ E/ 中/ 存在/ 有/ 向/ 边/ (/ vi/ ,/ vj/ )/ ./ 时效/ 图/ Ge/ ,/ A/ 的/ 构造/ 算法/ 如/ 算法/ 1/ 所示/ ./ 算法/ 的/ 输入/ 为/ 实体/ e/ ,/ 属性/ A/ ,/ 描述/ e/ 的/ 记录/ 构成/ 的/ 集合/ 为/ Se/ 及/ 数据/ 模式/ R/ 上/ 的/ 时效/ 约束/ 的/ 全体/ 构成/ 的/ 集合/ CCR/ ,/ 输出/ 为/ e/ 在/ A/ 上/ 的/ 时效/ 图/ Ge/ ,/ A/ ./ 算法/ 第/ 1/ 行/ 初始化/ 图/ G/ ,/ 令其/ 结点/ 和/ 边集/ 和/ 均/ 为/ 空/ ;/ 第/ 2/ 到/ 5/ 行向/ 结点/ 集合/ V/ 中/ 添加/ 结点/ ,/ 使得/ V/ 中/ 结点/ 和/ Se/ 中/ 记录/ 一一对应/ ;/ 第/ 6/ 到/ 12/ 行/ 检查/ CCR/ 中/ 每/ 一条/ 约束/ ,/ 如果/ 当前/ 约束/ cc/ 是/ A/ 上/ 的/ 时效/ 约束/ (/ A/ 上/ 的/ 时效/ 约束/ 可能/ 不止/ 一条/ )/ ,/ 且/ 存在/ ti/ ,/ tj/ ∈/ Se/ ,/ 使得/ 根据/ cc/ 能/ 判定/ ti/ / Atj/ 成立/ ,/ 则/ 向/ 边/ 集合/ E/ 中/ 添加/ 有/ 向/ 边/ (/ vi/ ,/ vj/ )/ ;/ 循环/ 结束/ 后/ ,/ 图/ G/ 即为/ 时效/ 图/ Ge/ ,/ A/ ./ 算法/ 1/ ./ 时效/ 图/ Ge/ ,/ A/ 的/ 构造/ 算法/ ./ 输入/ :/ e/ ,/ A/ ,/ Se/ ,/ CCR/ 输出/ :/ Ge/ ,/ A1/ ./ G/ ←/ (/ V/ ,/ E/ )/ ;/ V/ ←/ / ;/ E/ ←/ / ;/ 2/ ./ foreachti/ ∈/ Sedo3/ ./ addviintoV/ ;/ 4/ ./ tag/ (/ vi/ )/ ←/ ti/ ;/ 5/ ./ endfor6/ ./ foreachcc/ ∈/ CCRdo7/ ./ ifccisacurrencyconstraintofAthen8/ ./ foreachti/ / tjthatcanbeinferredfromccdo9/ ./ add/ (/ vi/ ,/ vj/ )/ intoE/ ;/ 10/ ./ endfor11/ ./ endif12/ ./ endfor13/ ./ Ge/ ,/ A/ ←/ G/ ;/ 14/ ./ returnGe/ ,/ A/ ./ 下面/ 我们/ 用/ 一个/ 例子/ 来/ 说明/ 算法/ 1/ 的/ 执行/ 过程/ ,/ 并/ 在/ 4.3/ 节/ 讨论/ 算法/ 1/ 的/ 时间/ 复杂度/ ./ 例/ 2/ ./ 考虑/ 图/ 1/ 所示/ 数据/ 及式/ (/ 1/ )/ 和/ 式/ (/ 2/ )/ 所示/ 的/ 时效/ 约束/ ./ 式/ (/ 1/ )/ 和/ 式/ (/ 2/ )/ 分别/ 是/ 属性/ Salary/ 和/ City/ 上/ 的/ 时效/ 约束/ ,/ 则/ 可以/ 对/ 实体/ Alice/ 的/ 属性/ Salary/ 和/ 属性/ City/ 构造/ 时效/ 图/ ,/ 如图/ 2/ (/ a/ )/ 和/ (/ b/ )/ 所示/ ./ 当/ 数据/ 集合/ 中/ 不/ 存在/ 可以/ 表示/ 属性/ 各个/ 取值/ 的/ 插入/ 和/ 生成/ 时间/ 的/ 时间/ 戳/ 时/ ,/ 时效/ 图/ 可以/ 用来/ 判断/ 哪些/ 值/ 是/ (/ 或/ 更/ 有/ 可能/ 是/ )/ 最新/ 的/ ./ 在/ 图/ 2/ (/ a/ )/ 中/ ,/ 我们/ 将/ 代表/ t3/ 和/ t4/ 的/ 结点/ 合并/ 成为/ 一个/ 结点/ ,/ 这/ 是因为/ t3/ 和/ t4/ 的/ Salary/ 属性/ 值/ 相同/ ,/ 则/ 根据/ 式/ (/ 1/ )/ ,/ t3/ 和/ t4/ 的/ 时效性/ 应当/ 相同/ (/ 它们/ 都/ 具有/ 最新/ 的/ Salary/ 值/ )/ ,/ 在下文/ 的/ 算法/ 中/ ,/ 我们/ 会/ 在/ 需要/ 时/ 将/ 这样/ 的/ 结点/ 合并/ ./ 对于/ 任意/ 实体/ e/ 及其/ 属性/ A/ ,/ 其/ 时效/ 图/ 在/ 时效/ Page7/ 图/ 2/ 实体/ Alice/ 的/ Salary/ 属性/ 和/ City/ 属性/ 对应/ 的/ 时效/ 图/ 约束/ 给定/ 后/ 就/ 确定/ 了/ ,/ 因此/ 可以/ 将/ 计算/ 时效/ 图/ 的/ 工作/ 作为/ 数据/ 预处理/ ,/ 对/ 每个/ 实体/ 的/ 每个/ 属性/ 预先/ 生成/ 时效/ 图/ 并/ 存储/ ,/ 从而/ 在/ 判定/ 时效性/ 时/ 减少/ 因/ 反复/ 生成/ 时效/ 图而/ 产生/ 的/ 时间/ 开销/ ./ 4.2/ 查询/ 相关/ 时效性/ 判定/ 问题/ 求解/ 4.2/ ./ 1CVQ/ 查询/ 结果/ 时效性/ 及/ 平均/ 时效性/ 判定/ 算法/ ./ 我们/ 首先/ 给出/ CVQ/ 查询/ 结果/ 的/ 时效性/ 判定/ 设/ 查询/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ ,/ 如/ 3.2/ ./ 1/ 节/ 所述/ ,/ Q/ 要求/ eQ/ 的/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 有/ 唯一/ 确定/ 的/ 最新/ 值/ ./ 而/ 在/ 时效/ 图中/ ,/ 某/ 结点/ 出度/ 为/ 0/ 表示/ 该点/ 不/ 比图/ 中/ 任何/ 其它/ 结点/ 旧/ ./ 所以/ 在/ 判定/ 查询/ 结果/ 的/ 时效性/ 时/ ,/ 首先/ 应当/ 找到/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ Ai/ 的/ 时效/ 图/ GeQ/ ,/ Ai/ 中/ 所有/ 出度/ 为/ 0/ 的/ 点/ ,/ 这些/ 点/ 对应/ 的/ 记录/ 构成/ 定义/ 4/ 中/ 的/ TAi/ 集合/ ./ 当时/ 效/ 约束/ 相互间/ 没有/ 冲突/ 时/ ,/ 时效/ 图是/ 有/ 向/ 无/ 环图/ (/ 因为/ 时序/ 关系/ 是/ 传递/ 关系/ ,/ 所以/ 如果/ 时效/ 图中/ 有/ 环/ ,/ 则/ 说明/ 存在/ ti/ / Atj/ 且/ tj/ / Ati/ 的/ 情况/ ,/ 即/ 约束/ 出现/ 了/ 冲突/ )/ ,/ 此时/ 时效/ 图中/ 至少/ 有/ 1/ 个点/ 出度/ 为/ 0/ ./ 在/ 找到/ 所有/ 出度/ 为/ 0/ 的/ 点/ 后/ ,/ 利用/ 式/ (/ 6/ )/ 就/ 可/ 判定/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ ./ CVQ/ 查询/ 结果/ 的/ 时效性/ 判定/ 算法/ 如/ 算法/ 2/ 所示/ ./ 算法/ 输入/ 为/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ 和/ 权值/ 向量/ 犠/ ,/ 其中/ 犠/ 用于/ 设定/ Attr/ (/ Q/ )/ 中/ 属性/ 的/ 权值/ ,/ 输出/ 为/ 二元/ 组/ (/ ansQ/ ,/ curQ/ )/ ,/ ansQ/ 用于/ 记录/ Attr/ (/ Q/ )/ 中/ 各个/ 属性/ 的/ 最新/ 值/ ,/ curQ/ 为/ Q/ 查询/ 结果/ 的/ 时效性/ ./ 算法/ 首先/ 用/ FindCurrentValue/ (/ GeQ/ ,/ Ai/ )/ 为/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ Ai/ 找到/ 所有/ 可能/ 的/ 最新/ 值/ ,/ 并/ 计算/ Ai/ 对/ Q/ 的/ 时效性/ 贡献/ ,/ 分别/ 记录/ 于/ (/ ansAi/ ,/ curAi/ )/ ,/ 然后/ 对/ 所有/ 的/ curAi/ 求/ 加权/ 和/ ,/ 得到/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ curQ/ ./ 算法/ 2/ ./ CVQ/ 查询/ 结果/ 的/ 时效性/ 判定/ ./ 输入/ :/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CVQ/ )/ ,/ 犠/ 输出/ :/ (/ ansQ/ ,/ curQ/ )/ 1/ ./ curQ/ ←/ 0/ ;/ 2/ ./ foreachAi/ ∈/ Attr/ (/ Q/ )/ do3/ ./ loadGeQ/ ,/ Ai/ ;/ 4/ ./ (/ ansAi/ ,/ curAi/ )/ ←/ FindCurrentValue/ (/ GeQ/ ,/ Ai/ )/ ;/ 5/ ./ curQ/ ←/ curQ/ +/ wAi/ ×/ curAi/ ;/ 6/ ./ endfor7/ ./ ansQ/ ←/ (/ ans1/ ,/ …/ ,/ ans/ |/ Attr/ (/ Q/ )/ |/ )/ ;/ 8/ ./ return/ (/ ansQ/ ,/ curQ/ )/ ./ FindCurrentValue/ (/ GeQ/ ,/ Ai/ )/ 如/ 算法/ 3/ 所示/ ./ 算法/ 3/ 将/ 时效/ 图/ GeQ/ ,/ Ai/ 中/ 的/ 每个/ 出度/ 为/ 0/ 的/ 点/ vi/ 对应/ 的/ 记录/ ti/ 加入/ 集合/ TAi/ ,/ 并/ 将/ ti/ [/ A/ ]/ 加入/ 集合/ ansAi/ ./ 在/ 检查/ 完/ 所有/ 出度/ 为/ 0/ 的/ 点/ 之后/ ,/ 令/ cnt/ (/ TAi/ )/ 等于/ ansAi/ 中/ 不同/ 的/ Ai/ 值/ 的/ 个数/ ,/ 并/ 以/ 1/ // cnt/ (/ TAi/ )/ 作为/ 属性/ Ai/ 的/ 时效性/ 贡献/ ,/ 即/ curAi/ ./ 算法/ 3/ ./ FindCurrentValue/ (/ GeQ/ ,/ Ai/ )/ ./ 输入/ :/ GeQ/ ,/ Ai/ =/ (/ V/ ,/ E/ )/ 输出/ :/ (/ ansAi/ ,/ curAi/ )/ 1/ ./ ansAi/ ←/ / ,/ TAi/ ←/ / ;/ 2/ ./ foreachvi/ ∈/ Vdo3/ ./ ifoutdegree/ (/ vi/ )/ =/ =/ 0then4/ ./ addtiintoTAi5/ ./ addti/ [/ A/ ]/ intoansAi6/ ./ endif7/ ./ endfor8/ ./ cnt/ (/ TAi/ )/ ←/ thenumberofuniquevaluesinansAi9/ ./ curAi/ ←/ 1/ // cnt/ (/ TAi/ )/ ;/ 10/ ./ return/ (/ ansAi/ ,/ curAi/ )/ ./ 下面/ 用/ 一个/ 例子/ 来/ 给出/ 算法/ 2/ 的/ 直观/ 解释/ ./ 例/ 3/ ./ 考虑/ 图/ 2/ 中/ 的/ 两个/ 时效/ 图/ ,/ 设/ 查询/ 为/ “/ Alice/ 当前/ 的/ 工作/ 城市/ 和/ 工资/ ”/ ,/ 即/ Q/ =/ (/ Alice/ ,/ {/ City/ ,/ Salary/ }/ ,/ CVQ/ )/ ,/ 权值/ 向量/ 犠/ =/ (/ 0.5/ ,/ 0.5/ )/ ./ 根据/ 图/ 2/ ,/ TCity/ =/ {/ t3/ ,/ t4/ }/ ,/ ansCity/ =/ {/ Guangzhou/ ,/ Harbin/ }/ ,/ TSalary/ =/ {/ t3/ ,/ t4/ }/ ,/ ansSalary/ =/ {/ 80k/ }/ ./ 进而/ 可/ 计算/ 得到/ curCity/ =/ 0.5/ ,/ curSalary/ =/ 1/ ,/ curQ/ =/ 0.5/ ×/ 0.5/ +/ 0.5/ ×/ 1/ =/ 0.75/ ,/ ansQ/ =/ {/ {/ Guangzhou/ ,/ Harbin/ }/ ,/ {/ 80k/ }/ }/ ./ 接下来/ 我们/ 讨论/ CVQ/ 平均/ 时效性/ 的/ 判定/ 方法/ ./ 如/ 3.2/ ./ 1/ 节/ 所述/ ,/ 判定/ CVQ/ 平均/ 时效性/ 需要/ 对/ 数据/ 集合/ D/ 中/ 的/ 每个/ 实体/ 的/ 每个/ 属性/ 计算/ 时效性/ 贡献/ ,/ 并/ 对/ 所有/ 的/ 时效性/ 贡献/ 求/ 加权/ 和/ ./ 上述/ 工作/ 可/ Page8/ (/ 1/ )/ 构造/ 一个/ 特殊/ 的/ 查询/ Q/ ,/ 令/ Attr/ (/ Q/ )/ 等于/ (/ 2/ )/ 对于/ 数据/ 集合/ D/ 的/ 每个/ 实体/ e/ ,/ 令/ eQ/ =/ e/ ,/ (/ 3/ )/ 将/ 所有/ 的/ 第/ 2/ 步中/ 得到/ 的/ 结果/ 根据/ 实体/ 的/ 以分/ 3/ 步/ 完成/ :/ 模式/ R/ 的/ 所有/ 属性/ ,/ 并/ 为/ 每个/ 属性/ 赋予/ 权值/ ./ 并/ 执行/ 一遍/ 算法/ 2/ ./ 重要性/ 做/ 加权/ 和/ ,/ 作为/ CVQ/ 平均/ 时效性/ ./ 4.2/ ./ 2CSQ/ 查询/ 结果/ 时效性/ 及/ 平均/ 时效性/ 判定/ 我们/ 首先/ 讨论/ CSQ/ 查询/ 结果/ 的/ 时效性/ 判定/ 方法/ ./ 设/ 查询/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CSQ/ )/ ,/ 如/ 3.2/ ./ 2/ 节/ 所述/ ,/ 为了/ 判定/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ ,/ 需要/ 对/ eQ/ 的/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 求/ 最长/ 时效/ 序列/ ./ 因为/ 时效/ 图中/ 的/ 边/ 表示/ 时序/ 关系/ “/ / A/ ”/ ,/ 所以/ 求/ 最长/ 时效/ 序列/ 等价/ 于/ 在/ 时效/ 图中/ 寻找/ 最长/ 路径/ ./ 如果/ 能够/ 完美/ 地/ 回答/ Q/ ,/ 则/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 的/ 时效/ 图/ 的/ 最长/ 路径/ 都/ 是/ 哈密顿/ 路/ ./ 那么/ ,/ 最长/ 路径/ 长度/ 与/ 哈密顿/ 路/ 长度/ 之/ 比/ 就/ 等于/ 定义/ 5/ 中/ 的/ SqAi/ // l/ ,/ 对/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ 计算/ SqAi/ // l/ ,/ 再/ 使用/ 式/ (/ 7/ )/ 即可/ 判定/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ ./ 最长/ 路径/ 问题/ 是/ 一个/ NP/ 难/ 问题/ ,/ 但是/ 由于/ 时效/ 图均/ 为/ 有/ 向/ 无/ 环图/ ,/ 所以/ 可以/ 利用/ 拓扑/ 排序/ 在/ 多项式/ 时间/ 内/ 解决/ 该/ 问题/ ./ CSQ/ 查询/ 结果/ 的/ 时效性/ 判定/ 问题/ 的/ 求解/ 算法/ 如/ 算法/ 4/ 所示/ ./ 算法/ 输入/ 为/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CSQ/ )/ 和/ 权值/ 向量/ 犠/ ,/ 其中/ 犠/ 用于/ Attr/ (/ Q/ )/ 中/ 属性/ 权值/ 的/ 设定/ ./ 输出/ 为/ 二元/ 组/ (/ ansQ/ ,/ curQ/ )/ ,/ ansQ/ 记录/ Attr/ (/ Q/ )/ 中/ 各个/ 属性/ 的/ 对应/ 的/ 最长/ 时效/ 序列/ ,/ curQ/ 为/ Q/ 查询/ 结果/ 的/ 时效性/ ./ 算法/ 先用/ FindLongestSequence/ (/ GeQ/ ,/ Ai/ )/ 对/ Attr/ (/ Q/ )/ 中/ 每个/ 属性/ Ai/ ,/ 求/ 时效/ 图/ GeQ/ ,/ Ai/ 中/ 的/ 最长/ 路径/ 并/ 计算/ Ai/ 的/ 时效性/ 贡献/ ,/ 记录/ 于/ (/ ansAi/ ,/ curAi/ )/ ,/ 然后/ 对/ 所有/ 的/ curAi/ 求/ 加权/ 和/ ,/ 得到/ Q/ 查询/ 结果/ 的/ 时效性/ curQ/ ./ 算法/ 4/ ./ CSQ/ 查询/ 结果/ 的/ 时效性/ 判定/ ./ 输入/ :/ Q/ =/ (/ eQ/ ,/ Attr/ (/ Q/ )/ ,/ CSQ/ )/ ,/ 犠/ 输出/ :/ (/ ansQ/ ,/ curQ/ )/ 1/ ./ curQ/ ←/ 0/ ;/ 2/ ./ foreachAi/ ∈/ Attr/ (/ Q/ )/ do3/ ./ loadGeQ/ (/ Ai/ )/ ;/ 4/ ./ (/ ansAi/ ,/ curAi/ )/ ←/ FindLongestSequence/ (/ GeQ/ ,/ Ai/ )/ ;/ 5/ ./ curQ/ ←/ curQ/ +/ wAi/ ×/ curAi/ ;/ 6/ ./ endfor7/ ./ ansQ/ ←/ (/ ans1/ ,/ …/ ,/ ans/ |/ Attr/ (/ Q/ )/ |/ )/ ;/ 8/ ./ return/ (/ ansQ/ ,/ curQ/ )/ ./ FindLongestSequence/ (/ GeQ/ ,/ Ai/ )/ 如/ 算法/ 5/ 所示/ ,/ 其/ 基本/ 思想/ 是/ 按照/ 拓扑/ 排序/ 给/ 图/ 中/ 的/ 结点/ 赋予/ 相应/ 的/ 层次/ 编号/ ,/ 在/ 对/ 所有/ 的/ 结点/ 都/ 赋予/ 层次/ 编号/ 之后/ ,/ 最大/ 层次/ 编号/ 就是/ 最长/ 路径/ 的/ 长度/ ./ 注意/ ,/ 同/ 一层/ 的/ 结点/ 对应/ 的/ 属性/ 值/ 可能/ 相同/ (/ 如图/ 2/ (/ a/ )/ 中/ t3/ 和/ t4/ 对应/ 的/ Salary/ 属性/ 值均/ 为/ 80k/ )/ ,/ 从而/ 其/ 新旧/ 程度/ 相同/ ,/ 需要/ 将/ 这样/ 的/ 结点/ 合并/ ./ 算法/ 5/ ./ FindLongestSequence/ (/ GeQ/ ,/ Ai/ )/ ./ 输入/ :/ GeQ/ ,/ Ai/ =/ (/ V/ ,/ E/ )/ 输出/ :/ (/ ansAi/ ,/ curAi/ )/ 1/ ./ ansAi/ ←/ / ,/ level/ ←/ 0/ ,/ cnt/ ←/ 0/ ;/ 2/ ./ whileV/ ≠/ / do3/ ./ vset/ ←/ Find0IndegreeNodes/ (/ GeQ/ ,/ Ai/ )/ ;/ 4/ ./ mergethenodeswithsameAivalueinvset5/ ./ cnt/ ←/ cnt/ +/ |/ vset/ |/ 6/ ./ foreachvi/ ∈/ vsetdo7/ ./ vi/ ./ lv/ =/ level/ ;/ 8/ ./ endfor9/ ./ level/ ←/ level/ +/ 1/ ;/ 10/ ./ addvistintoansAi/ ;/ 11/ ./ removethenodesinvset/ ;/ 12/ ./ endwhile13/ ./ curAi/ =/ level/ // cnt14/ ./ return/ (/ ansAi/ ,/ curAi/ )/ ./ 下面/ 用例/ 4/ 来/ 直观/ 地/ 说明/ 算法/ 4/ ./ 例/ 4/ ./ 考虑/ 查询/ “/ Alice/ 先后/ 在/ 哪些/ 城市/ 工作/ 过/ ”/ ,/ 则/ 查询/ Q/ =/ (/ Alice/ ,/ {/ City/ }/ ,/ CSQ/ )/ ./ 图/ 2/ (/ b/ )/ 所示/ 为/ Alice/ 的/ 属性/ City/ 的/ 时效/ 图/ ,/ 可/ 将/ 其/ 等价/ 的/ 转化/ 为/ 图/ 3/ (/ b/ )/ 所示/ 的/ 时效/ 序列/ 的/ 形式/ ,/ 其中/ 横轴/ 上/ 的/ 点/ 表示/ 层次/ 编号/ (/ 如/ t1/ 属于/ 层次/ 1/ )/ ,/ 层次/ 编号/ 越大/ ,/ 属性/ 值越/ 新/ ,/ 如果/ 两条/ 存有/ 不同/ 值/ 的/ 记录/ 属于/ 同/ 一层/ ,/ 则/ 说明/ 在/ 当前/ 约束/ 下/ 二者/ 的/ 时序/ 关系/ 无法/ 判定/ ./ 理想/ 的/ 时效/ 序列/ 长度/ 为/ 4/ ,/ 如图/ 3/ (/ a/ )/ 所示/ ,/ 为/ t1/ / Cityt2/ / Cityt3/ / Cityt4/ ,/ 但/ 实际/ 情况/ 如图/ 3/ (/ b/ )/ 所示/ ,/ 最长/ 时效/ 序列/ 长度/ 为/ 3/ ./ 因此/ 属性/ City/ 对于/ Q/ 的/ 时效性/ 贡献/ 为/ 3/ // 4/ =/ 0.75/ ./ 又/ 因为/ Attr/ (/ Q/ )/ 中仅/ 包/ Page9/ 含/ 一个/ 属性/ ,/ 所以/ Q/ 的/ 查询/ 结果/ 的/ 时效性/ 为/ 0.75/ ./ CSQ/ 平均/ 时效性/ 的/ 判定/ 方法/ 与/ CVQ/ 平均/ 时效性/ 的/ 判定/ 方法/ 基本相同/ ,/ 即/ 可以/ 类似/ 地/ 定义/ 查询/ Q/ ,/ 并/ 在/ 数据/ 集合/ 的/ 所有/ 实体/ 上/ 反复/ 执行/ 算法/ 4/ ,/ 最后/ 对/ 所有/ 得到/ 的/ 时效性/ 贡献/ 求/ 加权/ 和/ 得到/ CSQ/ 平均/ 时效性/ ./ 在/ 此/ 我们/ 不再/ 赘述/ 方法/ 细节/ ./ 4.2/ ./ 3/ 时间/ 复杂度/ 分析/ 设/ 数据库/ 模式/ R/ 有/ n/ 个/ 属性/ ,/ 数据/ 集合/ D/ 中共/ 有/ m/ 条/ 记录/ ,/ 共有/ c/ 条/ 时效/ 约束/ ./ 对于/ 算法/ 1/ ,/ 设/ 检查/ 一条/ 时效/ 约束/ 的/ 可/ 满足/ 性所/ 需/ 的/ 最长/ 时间/ 为/ r/ ,/ 则/ 最坏/ 情况/ 下/ 算法/ 1/ 需要/ 对/ 每/ 对/ 记录/ 检查/ 所有/ 的/ 时效/ 约束/ 是否/ 满足/ ,/ 时间/ 复杂度/ 为/ O/ (/ m2/ ×/ c/ ×/ r/ )/ ./ r/ 取决于/ 时效/ 约束/ 的/ 具体/ 形式/ ,/ 复杂/ 的/ 规则/ 虽然/ 有/ 较/ 强/ 的/ 表达能力/ ,/ 但/ 往往/ 需要/ 很/ 长时间/ 来/ 检查/ 其/ 前件/ 是否/ 成立/ ,/ 反而/ 会/ 给/ 时效性/ 判定/ 带来/ 负面影响/ ./ 因此/ ,/ 本文/ 要求/ 时效/ 约束/ 定义/ (/ 定义/ 2/ )/ 中/ 的/ 条件/ ψ/ 的/ 形如/ 规则/ 1/ ,/ 当/ 约束/ 均/ 满足/ 规则/ 1/ 时/ ,/ 可以/ 在/ 多项式/ 时间/ 内/ 完成/ 时效/ 图/ 的/ 构建/ ./ 规则/ 1/ ./ 时效/ 约束/ 定义/ 中/ 的/ 条件/ ψ/ 必须/ 满足/ 下述/ 条件/ :/ ①/ ψ/ 是/ 若干/ 谓词/ 的/ 合取/ ,/ 即形/ 如/ p1/ ∧/ …/ ∧/ ph/ (/ 可/ 将/ (/ pi/ ∨/ pj/ )/ ∧/ pk/ 改写/ 为/ (/ pi/ ∧/ pk/ )/ ∨/ (/ pj/ ∧/ pk/ )/ 并/ 进一步/ 拆为/ 两条/ 规则/ )/ ,/ 其中/ ,/ h/ 非常/ 小/ ,/ 可以/ 认为/ 是/ 常数/ ;/ pi/ 表示/ 第/ i/ 个/ 条件/ ,/ 如/ t/ [/ Salary/ ]/ </ s/ [/ Salary/ ]/ ;/ ②/ 对于/ ψ/ 中/ 的/ 任意/ pi/ ,/ 可以/ 在/ 常数/ 时间/ 或/ 多项式/ 时间/ 内/ 判定/ 其/ 是否/ 为/ 真/ ./ 规则/ 1/ 有/ 两个/ 作用/ ./ 首先/ ,/ 规则/ 1/ 能/ 帮助/ 用户/ 或/ 领域专家/ 写出/ 更/ 规范/ 的/ 约束/ ,/ 从而/ 更/ 方便/ 计算机/ 判定/ 约束/ 的/ 可/ 满足/ 性/ ./ 其次/ ,/ 规则/ 1/ 虽然/ 使得/ 时效/ 约束/ 的/ 表达能力/ 受到/ 了/ 一定/ 限制/ ,/ 但是/ 该/ 规则/ 能够/ 保证/ 约束/ 的/ 可/ 满足/ 性/ 可以/ 在/ 多项式/ 时间/ 内/ 被/ 判定/ (/ 至多/ 只/ 需/ 检查/ h/ 个/ 谓词/ ,/ 每个/ 谓词/ 至多/ 需/ 多项式/ 时间/ 的/ )/ ./ 算法/ 2/ 调用/ 了/ 算法/ 3/ ,/ 因此/ 首先/ 分析/ 算法/ 3/ 的/ 时间/ 复杂度/ ./ 算法/ 3/ 中/ 2/ 至/ 7/ 行/ 的/ 循环/ 至多/ 进行/ |/ V/ |/ 次/ ,/ 第/ 8/ 行在/ 计算/ ansAi/ 中/ 不同/ 的/ Ai/ 值/ 的/ 个数/ 时/ ,/ 朴素/ 的/ 两/ 两/ 对比/ 的/ 方法/ 至多/ 比较/ |/ V/ |/ 2/ 次/ ,/ 而/ |/ V/ |/ 在/ 最坏/ 情况/ 下/ 等于/ m/ ,/ 因此/ 算法/ 3/ 的/ 时间/ 复杂度/ 为/ O/ (/ m2/ )/ ./ 算法/ 2/ 中/ 2/ 至/ 6/ 行/ 的/ 循环/ 共/ 执行/ |/ Attr/ (/ Q/ )/ |/ 次/ ,/ 每次/ 循环/ 调用/ 一遍/ 算法/ 3/ ,/ 在/ 最坏/ 情况/ 下/ ,/ |/ Attr/ (/ Q/ )/ |/ =/ n/ ,/ 故/ 算法/ 2/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ m2/ )/ ./ 注意/ ,/ 我们/ 将/ 生成/ 时效/ 图/ 作为/ 数据/ 预处理/ ,/ 因此/ 在/ 算法/ 2/ 的/ 第/ 3/ 行只/ 读取/ 时效/ 图/ ,/ 而/ 没有/ 考虑/ 时效/ 图/ 生成/ 的/ 时间/ ./ 除此之外/ ,/ 算法/ 3/ 中/ ,/ 可以/ 利用/ Hash/ 函数/ 将/ 不同/ 的/ 属性/ 值/ 映射/ 到/ 不同/ 的/ 桶/ ,/ 则/ 第/ 8/ 行/ 的/ 时间/ 开销/ 可以/ 降到/ O/ (/ 1/ )/ ,/ 从而/ 将/ 算法/ 3/ 和/ 算法/ 2/ 的/ 时间/ 复杂度/ 分别/ 降至/ O/ (/ m/ )/ 和/ O/ (/ n/ ×/ m/ )/ ./ 算法/ 4/ 调用/ 了/ 算法/ 5/ ,/ 因此/ 首先/ 分析/ 算法/ 5/ 的/ 时间/ 复杂度/ ./ 算法/ 5/ 的/ 第/ 4/ 行至/ 多/ 需/ 执行/ |/ V/ |/ 2/ 次/ 结点/ 的/ 两/ 两/ 比/ 对/ ,/ 故/ 2/ ~/ 12/ 行/ 的/ 循环/ 最坏/ 情况/ 需/ 执行/ |/ V/ |/ 3/ 次/ ./ |/ V/ |/ 在/ 最坏/ 情况/ 下/ 等于/ m/ ,/ 因此/ 算法/ 5/ 的/ 时间/ 复杂度/ 为/ O/ (/ m3/ )/ ./ 算法/ 4/ 中/ 2/ ~/ 6/ 行/ 的/ 循环/ 共/ 执行/ |/ Attr/ (/ Q/ )/ |/ 次/ ,/ 在/ 最坏/ 情况/ 下/ |/ Attr/ (/ Q/ )/ |/ =/ n/ ,/ 故/ 算法/ 4/ 的/ 时间/ 复杂度/ 为/ O/ (/ n/ ×/ m3/ )/ ./ 与/ 算法/ 2/ 和/ 算法/ 3/ 同理/ ,/ 可以/ 使用/ Hash/ 函数/ 将/ 算法/ 5/ 的/ 第/ 4/ 行/ 开销/ 降至/ O/ (/ 1/ )/ ,/ 从而/ 将/ 算法/ 4/ 和/ 算法/ 5/ 的/ 时间/ 复杂度/ 降至/ O/ (/ n/ ×/ m2/ )/ 和/ O/ (/ m2/ )/ ./ 4.3/ 用户/ 相关/ 时效性/ 判定/ 问题/ 求解/ 用户/ 相关/ 时效性/ 定义/ 如/ 3.3/ 节/ 所述/ ./ 对于/ 3.3/ 节/ 所述/ 的/ 第/ 1/ 类/ 和/ 第/ 2/ 类/ 用户/ ,/ 可以/ 利用/ 4.2/ 节/ 的/ 方法/ 求得/ CVQ/ 平均/ 时效性/ 和/ CSQ/ 平均/ 时效性/ ,/ 再/ 利用/ 式/ (/ 8/ )/ 就/ 可/ 求得/ 相应/ 的/ 用户/ 相关/ 时效性/ ./ 对于/ 3.3/ 节/ 所述/ 的/ 第/ 3/ 类/ 用户/ ,/ 需要/ 对/ / 中/ 每个/ 查询/ ,/ 根据/ 其/ 所属/ 的/ 查询/ 类别/ 使用/ 算法/ 2/ 或/ 算法/ 4/ 求得/ 查询/ 结果/ 时效性/ ,/ 再/ 使用/ 式/ (/ 9/ )/ 求得/ 相应/ 的/ 用户/ 相关/ 时效性/ ./ 5/ 实验/ 结果/ 及/ 分析/ 5.1/ 实验/ 配置/ 实验/ 采用/ 的/ 硬件/ 为/ IntelCorei5CPU/ ,/ 4GB/ 内存/ ,/ 操作系统/ 为/ Windows7/ ,/ 代码/ 使用/ C++/ 编写/ ,/ 软件开发/ 环境/ 为/ MicrosoftVisualStudio2010/ ./ 因为/ 之前/ 没有/ 其它/ 工作/ 能够/ 给出/ 数据/ 时效性/ 的/ 判定/ 算法/ ,/ 所以/ 本/ 节/ 实验/ 主要/ 研究/ 本文/ 的/ 时效性/ 判定/ 方法/ 中/ 各个/ 参数/ 对/ 算法/ 的/ 影响/ ./ 我们/ 在/ 真实/ 数据/ 集合/ 和/ 虚拟/ 数据/ 集合/ 上/ 分别/ 对/ 算法/ 1/ 、/ 算法/ 2/ 、/ 算法/ 4/ 及/ 4.3/ 节/ 的/ 用户/ 相关/ 时效性/ 判定/ 方法/ 进行/ 了/ 实验/ ./ 其中/ 真实/ 数据/ 用于/ 研究/ 数据/ 时效性/ 判定/ 结果/ 对/ 规则/ 数目/ 的/ 敏感/ 程度/ ,/ 虚拟/ 数据/ 用于/ 验证/ 本文/ 算法/ 的/ 执行/ 效率/ ./ 真实/ 数据/ 集由/ 100/ 条/ 个人信息/ 组成/ ,/ 数据/ 模式/ Stu/ =/ (/ tID/ ,/ EID/ ,/ Name/ ,/ Gender/ ,/ Edu/ ,/ Occu/ ,/ Ent/ // Sch/ ,/ Addr/ ,/ Salary/ ,/ Age/ )/ ,/ 各/ 属性/ 分别/ 表示/ 记录/ ID/ 、/ 实体/ ID/ 、/ 姓名/ 、/ 性别/ 、/ 学历/ 、/ 职业/ 、/ 工作/ 单位/ // 学校地址/ 、/ 住址/ 、/ 工资/ 和/ 年龄/ ./ 真实/ 数据/ 集合/ 中/ 包含/ 10/ 个实/ Page10/ 体/ ,/ 每个/ 实体/ 有/ 10/ 条/ 不同/ 的/ 记录/ 描述/ 其/ 信息/ ./ 数据/ 模式/ Stu/ 上/ 共/ 定义/ 了/ 15/ 条/ 时效/ 约束/ ,/ 例如/ / s/ ,/ t/ :/ Stu/ (/ s/ [/ EID/ ]/ =/ t/ [/ EID/ ]/ ∧/ t/ [/ Age/ ]/ </ s/ [/ Age/ ]/ →/ t/ / Ages/ )/ 和/ / s/ ,/ t/ :/ Stu/ (/ s/ [/ EID/ ]/ =/ t/ [/ EID/ ]/ ∧/ t/ [/ Edu/ ]/ =/ Bachelor/ ∧/ s/ [/ Edu/ ]/ =/ Master/ →/ t/ / Edus/ )/ ./ 我们/ 通过/ 改变/ 约束/ 的/ 数目/ 来/ 研究/ 其/ 对/ 数据库/ 时效性/ 判定/ 结果/ 的/ 影响/ ./ 虚拟/ 数据/ 集合/ 采用/ 自己/ 编写/ 的/ 数据/ 生成/ 工具/ 生成/ ,/ 其/ 5/ 个/ 主要参数/ 如下/ :/ entityNum/ 用于/ 控制/ 实体/ 的/ 个数/ ;/ 为了/ 方便/ 衡量/ 记录/ 数对/ 实验/ 效率/ ,/ 我们/ 将/ 所有/ 实体/ 对应/ 的/ 记录/ 数设/ 为/ 相等/ ,/ 用/ 参数/ tupleNum/ 控制/ ;/ attrNum/ 用于/ 控制/ 数据库/ 的/ 模式/ 的/ 属性/ 数目/ ;/ constraintNum/ 用于/ 控制/ 约束/ 的/ 数目/ ,/ 生成/ 工具/ 生成/ 的/ 约束/ 仅/ 对/ 一对/ 记录/ 生效/ ,/ 且/ 均/ 可以/ 在/ 常数/ 时间/ 内/ 被/ 判定/ 可/ 满足/ 性/ ;/ queryNum/ 用于/ 控制/ 查询/ 的/ 数目/ ./ 我们/ 每次/ 变动/ 一个/ 参数/ ,/ 固定/ 其余/ 4/ 个/ 参数/ ,/ 并/ 研究/ 该/ 参数/ 的/ 变化/ 对于/ 算法/ 效率/ 的/ 影响/ ./ 5.2/ 规则/ 数目/ 对/ 时效性/ 判定/ 结果/ 的/ 影响/ 在/ 真实/ 数据/ 集上/ 有/ 15/ 条/ 时效/ 约束/ ,/ 根据/ 被/ 这/ 15/ 条/ 时效/ 约束/ 的/ 覆盖/ 的/ 程度/ (/ 覆盖/ 程度/ 越高/ ,/ 则/ 时效/ 约束/ 影响/ 的/ 记录/ 越/ 多/ ,/ 因而/ 越/ 有助于/ 恢复/ 数据/ 的/ 时序/ 关系/ )/ ,/ 可以/ 将/ 真实/ 数据/ 集合/ D/ 划分/ 成/ 两个/ 子集合/ D1/ 和/ D2/ ,/ D1/ 和/ D2/ 各/ 包含/ 50/ 条/ 记录/ ,/ D1/ 被/ 时效/ 约束/ 覆盖/ 得/ 较/ 好/ ,/ D2/ 被/ 时效/ 约束/ 覆盖/ 得/ 较差/ ./ 查询/ 集合/ / 被/ 用来/ 判定/ D/ 的/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ ./ / 可/ 被/ 划分/ 为/ 子集合/ / 1/ 和/ / 2/ ,/ 其中/ / 1/ 中/ 的/ 查询/ 仅/ 针对/ D1/ 中/ 的/ 实体/ ,/ 而/ / 2/ 中/ 的/ 查询/ 仅/ 针对/ D2/ 中/ 的/ 实体/ ./ 我们/ 在/ D1/ 、/ D2/ 和/ D/ 上/ 分别/ 进行/ 实验/ ,/ 并/ 比较/ 这/ 3/ 种/ 情况/ 下/ 查询/ 相关/ 时效性/ 以及/ 用户/ 相关/ 时效性/ 判定/ 结果/ 的/ 变化/ ./ 图/ 4/ 中/ (/ a/ )/ ~/ (/ c/ )/ 3/ 幅图/ 分别/ 为/ 时效/ 约束/ 增加/ 时/ ,/ D1/ 、/ D2/ 和/ D/ 的/ 时效性/ 判定/ 结果/ 变化/ 情况/ ./ CVQ/ 和/ CSQ/ 两条/ 折线/ 表示/ 当/ 约束/ 增加/ 时/ ,/ 数据/ 集合/ 的/ CVQ/ 和/ CSQ/ 平均/ 时效性/ 上升/ 情况/ ./ 图/ 4/ (/ a/ )/ 中/ 折线/ curD1/ (/ usingmethod1/ )/ 表示/ D1/ 的/ 第/ 1/ 类/ 用户/ 相关/ 时效性/ 判定/ 结果/ ,/ 折线/ curD1/ (/ usingmethod3/ )/ 表示/ D1/ 的/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 判定/ 结果/ ,/ 图/ 4/ (/ b/ )/ 同理/ ./ 图/ 4/ (/ c/ )/ 中/ 的/ curD/ (/ usingmethod3and/ / 1/ )/ 和/ curD/ (/ usingmethod3and/ / 2/ )/ 两条/ 折线/ 分别/ 是/ 使用/ / 1/ 和/ / 2/ 对/ D/ 做/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 判定/ 的/ 结果/ ./ 因/ 第/ 1/ 类/ 用户/ 相关/ 时效性/ 相当于/ 第/ 2/ 类/ 用户/ 相关/ 时效性/ 权值/ 相等/ 的/ 情况/ ,/ 所以/ 不必/ 专门/ 对/ 第/ 2/ 类/ 用户/ 相关/ 时效性/ 进行/ 实验/ ./ 由/ 本组/ 实验/ 可以/ 得到/ 3/ 个/ 结论/ ./ (/ 1/ )/ 当/ 时效性/ 约束/ 增多/ 时/ ,/ 各类/ 时效性/ 判定/ 结果/ 在/ 数值/ 上均/ 呈上升/ 的/ 趋势/ ,/ 但/ 约束/ 的/ 效力/ 各不相同/ ./ 从图/ 4/ 中/ 可以/ 看出/ ,/ 第/ 6/ 和/ 第/ 10/ 条/ 时效/ 约束/ 加入/ 时/ ,/ D1/ 、/ D2/ 和/ D/ 的/ 各类/ 时效性/ 上升/ 最快/ ,/ 这/ 是因为/ 这/ 两条/ 时效性/ 约束/ 能够/ 影响/ 的/ 记录/ 最/ 多/ ;/ 而/ 第/ 7/ 和/ 第/ 11/ 条/ 约束/ 加入/ 时/ ,/ 数据/ 时效性/ 并/ 没有/ 明显/ 的/ 上升/ ,/ 这/ 是因为/ 这/ 两条/ 约束/ 只/ 影响/ 了/ 非常/ 少量/ 的/ 记录/ ,/ 因此/ 对/ 数据/ 时效性/ 几乎/ 无/ 影响/ ./ 图/ 4/ 时效/ 约束/ 数对/ D1/ 、/ D2/ 和/ D/ 的/ 时效性/ 判定/ 结果/ 的/ 影响/ Page11/ (/ 2/ )/ 随着/ 时效/ 约束/ 的/ 增多/ ,/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 提升/ 最快/ ./ 这种/ 现象/ 的/ 出现/ 是因为/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 仅/ 关心/ 查询/ 涉及/ 到/ 的/ 实体/ 和/ 属性/ ,/ 因此/ 受/ 时效/ 约束/ 影响/ 最大/ ./ (/ 3/ )/ 被/ 时效/ 约束/ 覆盖/ 越好/ 的/ 数据/ 集合/ 的/ 时效性/ 越高/ ./ D1/ 被/ 时效/ 约束/ 覆盖/ 的/ 最好/ ,/ 当时/ 效/ 约束/ 数目/ 增加/ 时/ ,/ 其/ 各类/ 时效性/ 判定/ 结果/ 始终/ 最高/ ,/ 约束/ 数目/ 等于/ 15/ 时/ ,/ 各类/ 时效性/ 均/ 能/ 达到/ 0.8/ 以上/ ,/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 更是/ 达到/ 了/ 0.92/ ./ 与/ 之/ 相比/ ,/ D2/ 被/ 约束/ 覆盖/ 的/ 较差/ ,/ 则/ 各类/ 时效性/ 均/ 较/ 低/ ,/ 约束/ 数目/ 等于/ 15/ 时/ ,/ 各类/ 时效性/ 都/ 只有/ 0.75/ 左右/ ./ D/ =/ D1/ ∪/ D2/ ,/ 其/ 被/ 约束/ 覆盖/ 的/ 程度/ 介于/ D1/ 和/ D2/ 之间/ ,/ 因此/ 各类/ 时效性/ 判定/ 结果/ 也/ 介于/ 二者之间/ ./ 图/ 5/ 所示/ 为/ 使用/ / 1/ 、/ / 2/ 、/ / 分别/ 对/ D/ 判定/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 得到/ 的/ 结果/ ./ 可以/ 观察/ 到/ ,/ 使用/ 不同/ 的/ 查询/ 集合/ 判定/ 得到/ 的/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 差异/ 很大/ ./ 如前/ 文/ 所述/ ,/ 查询/ 集合/ 反映/ 用户/ 需求/ ,/ 该/ 结果/ 说明/ 需求/ 不/ 同时/ ,/ 数据/ 相对/ 于/ 用户/ 来说/ ,/ 时效性/ 也/ 不同/ ./ 除此之外/ 还/ 可以/ 观察/ 到/ ,/ 当/ 使用/ / 1/ 来/ 判定/ D/ 的/ 用户/ 相关/ 时效性/ 时/ ,/ 某些/ 时效/ 约束/ (/ 如/ 约束/ 9/ )/ 能/ 较/ 大幅度/ 地/ 提升/ 时效性/ ,/ 但/ 使用/ / 2/ 时该/ 约束/ 不起/ 任何/ 作用/ ./ 这/ 说明/ 需求/ 不/ 同时/ 约束/ 的/ 作用/ 也/ 不同/ ,/ 并非/ 所有/ 约束/ 都/ 能/ 真正/ 提升/ 数据/ 时效性/ ./ 图/ 5/ 使用/ 不同/ 的/ 查询/ 集合/ 判定/ D/ 的/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 5.3/ 各/ 参数/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ 本/ 小节/ 用/ 虚拟/ 数据/ 集合/ 分析/ 不同/ 参数/ 的/ 改变/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ ,/ 各/ 参数/ 意义/ 如/ 5.1/ 节/ 所述/ ./ 在/ 每组/ 实验/ 中/ ,/ 我们/ 让/ 被/ 研究/ 的/ 参数/ 从/ 1k/ 变到/ 10k/ ,/ 并/ 将/ 实验/ 分为/ 两步/ ./ 第/ 1/ 步/ ,/ 研究/ entityNum/ 、/ tupleNum/ 、/ attrNum/ 、/ constraintNum/ 对/ 算法/ 执行/ 时间/ 的/ 影响/ ,/ 每次/ 改变/ 1/ 个/ 参数/ 取值/ ,/ 并/ 固定/ 其余/ 4/ 个/ 参数/ ,/ 按照/ 当前/ 参数/ 取值/ ,/ 用/ 数据/ 生成/ 工具/ 随机/ 生成/ 数据/ 集合/ 和/ 约束/ ,/ 并/ 做/ 如下/ 3/ 步/ 工作/ :/ (/ 1/ )/ 为/ 数据/ 集合/ 中/ 所有/ 实体/ 在/ 所有/ 属性/ 上/ 构造/ 时效/ 图/ (/ buildcurrencygraph/ )/ ;/ (/ 2/ )/ 判定/ 数据/ 集合/ 的/ CVQ/ 平均/ 时效性/ (/ evaluateCVQs/ )/ ;/ (/ 3/ )/ 判定/ 数据/ 集合/ 的/ CSQ/ 平均/ 时效性/ (/ evaluateCSQs/ )/ ./ 第/ 1/ 和/ 第/ 2/ 类/ 用户/ 相关/ 时效性/ 判定/ 正好/ 由/ 上述/ 3/ 个/ 过程/ 构成/ ./ 3/ 个/ 过程/ 的/ 执行/ 时间/ 如图/ 6/ ~/ 图/ 9/ 所示/ ,/ 其中/ 各图/ 的/ 横轴/ 表示/ 参数/ 取值/ 的/ 变化/ ,/ 纵轴/ 表示/ 算法/ 执行/ 时间/ ,/ 图/ 6/ 、/ 图/ 8/ 、/ 图/ 9/ 的/ 纵轴/ 单位/ 为/ ms/ ,/ 图/ 7/ 的/ 纵轴/ 单位/ 为/ 104ms/ ./ 第/ 2/ 步/ ,/ 利用/ 随机/ 生成/ 的/ 包含/ queryNum/ 个/ 查询/ 的/ 集合/ 判定/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ ,/ 并/ 研究/ queryNum/ 的/ 变化/ 对/ 其/ 执行/ 时间/ 的/ 影响/ ,/ 结果/ 如图/ 10/ 所示/ ,/ 其中/ 各图/ 的/ 横轴/ 表示/ queryNum/ 的/ 取值/ ,/ 纵轴/ 表示/ 执行/ 时间/ ,/ 单位/ 为/ ms/ ./ 图/ 6/ 所示/ 为/ entityNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ ./ 本组/ 实验/ 中/ ,/ 为了/ 把/ 其它/ 参数/ 的/ 影响/ 尽量/ 降到/ 最低/ ,/ 我们/ 令/ tupleNum/ 、/ attrNum/ 和/ constraintNum/ 都/ 等于/ 10/ ,/ 则/ 可/ 认为/ 算法/ 1/ 、/ 2/ 、/ 4/ 对于/ 单个/ 实体/ 执行/ 都/ 只/ 需/ 常数/ 时间/ ./ 从图/ 6/ 可以/ 看出/ ,/ 3/ 种/ 工作/ 的/ 执行/ 时间/ 随/ entityNum/ 的/ 变化/ 基本/ 呈/ 线性/ 增长/ ,/ 并且/ 均/ 能/ 在/ 0.12/ s/ 内/ 完成/ ./ 图/ 6/ 参数/ entityNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ 图/ 7/ 所示/ 为/ tupleNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ ./ 本组/ 实验/ 中/ entityNum/ 、/ attrNum/ 和/ constraintNum/ 都/ 等于/ 10.4/ ./ 2.3/ 节中/ 的/ 理论/ 分析表明/ ,/ CVQ/ 和/ CSQ/ 相关/ 时效性/ 判定/ 算法/ (/ 不/ 使用/ Hash/ 函数/ 优化/ )/ 的/ 时间/ 复杂度/ 是/ 记录/ 数目/ 的/ 平方/ 或/ 三次方/ 量级/ ,/ 这/ 与/ 图/ 6/ 所示/ 的/ 实验/ 结果/ 相符/ ./ 在/ tupleNum/ =/ 10k/ 时/ ,/ 判定/ CVQ/ 平均/ 时效性/ 大约/ 需/ 29s/ ./ 本图/ 没有/ 给出/ buildcurrencygraphs/ 的/ 执行/ 时间/ ,/ 这/ 是因为/ 本/ 实验/ 中/ 随机/ 生成/ 的/ 约束/ 仅/ 对/ 一对/ 记录/ 生效/ ,/ 且/ 可/ 满足/ 性/ 判定/ 只/ 需/ 常数/ 时间/ ,/ 故/ tupleNum/ 不/ 影响/ buildcurrencygraphs/ 的/ 执行/ 时间/ ./ 事实上/ ,/ tupleNum/ =/ Page1210k/ 时/ buildcurrencygraphs/ 也/ 只/ 需约/ 10ms/ ,/ 和/ 其它/ 两个/ 过程/ 相比/ 几乎/ 可以/ 忽略不计/ ./ 图/ 7/ 参数/ tupleNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ (/ attrNum/ =/ entityNum/ =/ constraintNum/ =/ 10/ )/ 图/ 8/ 所示/ 为/ attrNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ ./ 本组/ 实验/ 中/ entityNum/ 、/ tupleNum/ 和/ constraintNum/ 都/ 等于/ 10/ ./ 算法/ 2/ 和/ 算法/ 3/ 的/ 执行/ 时间/ 随/ attrNum/ 增长/ 基本/ 呈/ 线性/ 增长/ ,/ 而/ buildcurrencygraphs/ 因为/ 要/ 对/ 每个/ 实体/ 在/ 每个/ 属性/ 上/ 构建/ 时效/ 图/ ,/ 故其/ 运行/ 时间/ 也/ 随/ attrNum/ 的/ 增长/ 呈/ 线性/ 增长/ ./ 在/ 图/ 中/ 可以/ 看出/ ,/ attrNum/ =/ 10k/ 时/ ,/ 最/ 多只/ 需/ 0.12/ s/ 就/ 可以/ 完成/ 3/ 个/ 过程/ 中/ 的/ 任何/ 一个/ ,/ 算法/ 执行/ 效率/ 较/ 高/ ./ 图/ 8/ 参数/ attrNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ (/ tupleNum/ =/ tupleNum/ =/ constraintNum/ =/ 10/ )/ 图/ 9/ 所示/ 为/ constraintNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ ./ 本组/ 实验/ 中/ entityNum/ 、/ tupleNum/ 和/ attrNum/ 都/ 等于/ 10/ ./ 约束/ 数目/ 影响/ 时效/ 图/ 的/ 构建/ ,/ 而/ buildcurrencygraphs/ 是/ 数据/ 预处理/ 过程/ ,/ 如图/ 9/ 所示/ ,/ 其/ 执行/ 时间/ 随/ constraintNum/ 的/ 增长/ 呈/ 线性/ 增长/ ./ 算法/ 2/ 和/ 算法/ 4/ 中/ 不/ 构建/ 时效/ 图/ ,/ 所以/ evaluateCVQs/ 和/ evaluateCSQs/ 的/ 执行/ 时间/ 只/ 随/ 随机/ 生成/ 的/ 数据/ 集合/ 不同/ 而/ 略有/ 波动/ ,/ 与/ constraintNum/ 无关/ ./ 图/ 9/ 参数/ constraintNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ 图/ 10/ 所示/ 为/ queryNum/ 对/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 判定/ 的/ 执行/ 时间/ 的/ 影响/ ./ 该组/ 实验/ 中/ entityNum/ 、/ tupleNum/ 和/ constraintNum/ 都/ 等于/ 10/ ,/ attrNum/ 等于/ 1000/ (/ 查询/ 较多时/ ,/ 涉及/ 到/ 的/ 属性/ 也/ 相应/ 的/ 会/ 变多/ ,/ 因而/ attrNum/ 设置/ 的/ 较大/ )/ ./ 由于/ 除/ queryNum/ 外/ 其它/ 参数/ 都/ 是/ 常数/ ,/ 所以/ 算法/ 执行/ 时间/ 随/ queryNum/ 的/ 增长/ 呈/ 线性/ 增长/ ./ queryNum/ =/ 10k/ 时/ 判定/ 第/ 3/ 类/ 用户/ 相关/ 时效性/ 只/ 需约/ 0.46/ s/ ,/ 算法/ 执行/ 效率/ 较/ 高/ ./ 图/ 10/ 参数/ queryNum/ 对/ 算法/ 执行/ 效率/ 的/ 影响/ (/ attrNum/ =/ 1000/ ,/ tupleNum/ =/ entityNum/ =/ rNum/ =/ 10/ )/ 6/ 结论/ 及/ 未来/ 研究/ 方向/ 本文/ 研究/ 包含/ 冗余/ 记录/ 的/ 集合/ 在/ 给定/ 时效/ 约束/ 下/ 的/ 时效性/ 判定/ 问题/ ,/ 并/ 给出/ 了/ 查询/ 相关/ 时效性/ 判定/ 问题/ 和/ 用户/ 相关/ 时效性/ 判定/ 问题/ 的/ 定义/ 及/ 算法/ ./ 在/ 判定/ 查询/ 相关/ 时效性/ 时/ ,/ 将/ 查询/ 分为/ CVQ/ 和/ CSQ/ 两类/ ,/ 分别/ 给出/ 了/ 这/ 两类/ 查询/ 的/ 结果/ 时效性/ 和/ 平均/ 时效性/ 判定/ 问题/ 的/ 算法/ ./ 在/ 判定/ 用户/ 相关/ 时效性/ 时/ ,/ 将/ 用户/ 分为/ 3/ 类/ ,/ 针对/ 每/ 类/ 用户/ 的/ 需求/ ,/ 提出/ 了/ 不同/ 的/ 用户/ 相关/ 时效性/ 判定/ 方法/ ,/ 并/ 进一步/ 讨论/ 了/ 如何/ 根据/ 用户/ 相关/ 时效性/ 判定/ 结果/ 来/ 指明/ 数据/ 修复/ 的/ 方向/ ./ 在/ 研究/ 上述/ 时效性/ 判定/ 问题/ 的/ 过程/ 中/ ,/ 本文/ 提出/ Page13/ 了/ 时效/ 图/ 的/ 概念/ ,/ 将/ 时序/ 关系/ 以图/ 的/ 形式/ 建模/ ,/ 使/ 之/ 能够/ 帮助/ 时效性/ 的/ 判定/ ./ 最后/ 用/ 实验/ 分析/ 了/ 各个/ 参数/ 对/ 算法/ 的/ 影响/ ,/ 并/ 验证/ 了/ 本文/ 算法/ 的/ 高效性/ ./ 在/ 本文/ 工作/ 的/ 基础/ 之上/ ,/ 未来/ 我们/ 将/ 着力/ 于/ 研究/ 下述/ 问题/ :/ (/ 1/ )/ 如何/ 在/ 数据/ 集合/ 动态变化/ 时/ 准确/ 地/ 判定/ 数据/ 时效性/ ;/ (/ 2/ )/ 如何/ 在/ 数据/ 不/ 完整/ 或/ 有/ 错误/ 时/ 判定/ 数据/ 时效性/ ;/ (/ 3/ )/ 在/ 数据/ 时效性/ 不佳时/ ,/ 如何/ 自动/ 修复/ 数据/ ./ 

