Page1/ 一种/ 基于/ 主动/ 轮廓/ 模型/ 的/ 心脏/ 核磁共振/ 图像/ 分割/ 方法/ 刘利雄/ 马忠梅/ 赵恒博姚/ 宇华/ 张麒/ (/ 北京理工大学/ 计算机/ 学院/ 智能/ 信息技术/ 北京市/ 重点/ 实验室/ 北京/ 100081/ )/ 摘要/ 提出/ 一种/ 基于/ 主动/ 轮廓/ 模型/ 的/ 左室/ 壁内/ 、/ 外膜/ 分割/ 方法/ ./ 首先/ 构造/ 了/ 主动/ 轮廓/ 模型/ 的/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ 外力/ 模型/ GNBGVF/ ,/ 作为/ 对/ 梯度/ 矢量/ 流/ (/ GVF/ )/ 的/ 改进/ ,/ 该/ 外力/ 场/ 同时/ 保持/ 了/ 切线/ 方向/ 和/ 法线/ 方向/ 有/ 偏/ 的/ 扩散/ ,/ 具有/ 捕捉/ 范围/ 大/ 、/ 抗噪/ 能力/ 强/ ,/ 且/ 在/ 弱/ 边界/ 泄漏/ 等/ 问题/ 上/ 性能/ 突出/ ./ 就/ 左室/ 壁/ 内膜/ 的/ 分割/ 而言/ ,/ 考虑/ 到/ 左室/ 壁/ 的/ 近似/ 为/ 圆形/ 的/ 特点/ ,/ 引入/ 了/ 圆形/ 约束/ 的/ 能量/ 项/ ,/ 有利于/ 克服/ 由于/ 图像/ 灰度/ 不均/ 、/ 乳突/ 肌/ 等/ 而/ 导致/ 的/ 局部/ 极小/ ./ 对于/ 左室/ 壁/ 外膜/ 的/ 分割/ ,/ 采用/ 内膜/ 的/ 分割/ 结果/ 初始化/ ,/ 即/ 通过/ 重新组合/ 梯度/ 分量/ 来/ 构造/ 外力/ 场/ ./ 该/ 外力/ 场/ 能够/ 克服/ 原始/ 梯度/ 矢量/ 流/ 的/ 不足/ ,/ 使得/ 左室/ 壁/ 外膜/ 边缘/ 很弱/ 时/ 也/ 能/ 得到/ 保持/ ,/ 可以/ 自动/ 、/ 准确/ 地/ 分割/ 外膜/ ./ 实验/ 结果表明/ ,/ 该/ 方法/ 能/ 高效/ 准确/ 地/ 分割/ 左室/ 壁内/ 、/ 外膜/ ./ 关键词/ 心脏/ 核磁共振/ 图像/ ;/ 图像/ 分割/ ;/ 主动/ 轮廓/ 模型/ ;/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ ;/ 形状/ 约束/ 1/ 引言/ 心脏/ 核磁共振/ 成像/ MRI/ (/ MagneticResonanceImaging/ )/ 能够/ 提供/ 高分辨率/ 、/ 高品质/ 的/ 图像/ ,/ 对/ 心脏/ 的/ 解剖/ 结构/ 和/ 功能/ 进行/ 准确/ 的/ 描述/ ,/ 是/ 当前/ 医学/ 图像/ 分析/ 领域/ 的/ 研究/ 热点/ 之一/ ,/ 也/ 是/ 心脏/ 疾病诊断/ 的/ 重要/ 辅助/ 手段/ ,/ 对/ 心血管/ 疾病/ 的/ 早期/ 无创/ 诊断/ 和/ 准确/ 预后/ 评估/ 具有/ 重要/ 意义/ ./ 为了/ 充分利用/ 图像/ 中/ 的/ 解剖/ 信息/ ,/ 为/ 临床/ 诊断/ 提供/ 量化/ 、/ 直观/ 的/ 参考/ ,/ 首先/ 必须/ 分割/ 出/ 左室/ 壁/ 的/ 内/ 、/ 外膜/ [/ 1/ -/ 2/ ]/ ./ 然而/ ,/ 由于/ 心脏/ 的/ 运动/ 和/ 血液/ 的/ 高速/ 流动/ ,/ 图像/ 受/ 噪声/ 干扰/ ,/ 使得/ 心脏/ MR/ 图像/ 的/ 分割/ 仍/ 是/ 一个/ 值得/ 深入研究/ 的/ 问题/ ./ 近年来/ ,/ 对/ 心脏/ MR/ 图像/ 的/ 分割/ 国内外/ 都/ 有/ 广泛/ 研究/ ,/ 这些/ 方法/ 大致/ 可以/ 分为/ 基于/ 形态学/ 的/ 方法/ [/ 3/ ]/ 、/ 基于/ 模糊/ 聚类/ 的/ 方法/ [/ 4/ ]/ 、/ 基于/ 模板/ 的/ 方法/ [/ 5/ ]/ 以及/ 基于/ 主动/ 轮廓/ 模型/ 的/ 方法/ [/ 6/ -/ 8/ ]/ 等/ ./ 主动/ 轮廓/ 模型/ 能够/ 将/ 有关/ 目标/ 形状/ 的/ 先验/ 知识/ 和/ 来自/ 图像/ 的/ 知识/ 融入/ 一个/ 统一/ 的/ 过程/ 中/ ,/ 是/ 当前/ 图像/ 分割/ 领域/ 的/ 热点/ 方法/ ,/ 也/ 是/ 心脏/ MR/ 图像/ 分割/ 中/ 的/ 主流/ 方法/ ,/ 如/ Sid/ -/ diqui/ 等/ 人/ [/ 9/ ]/ 基于/ 几何/ 主动/ 轮廓/ 模型/ 采用/ 一条/ 初始/ 轮廓线/ 同时/ 分割/ 出/ 了/ 左/ 、/ 右心室/ 的/ 内膜/ ./ Hong/ 等/ 人/ [/ 10/ ]/ 采用/ 基于/ Lagrange/ 动力学/ 的/ B/ 样条/ Snake/ 模型/ 来/ 提取/ 左室/ 壁/ 内膜/ ./ Makowski/ 等/ 人/ [/ 11/ ]/ 采用/ 气球/ Snake/ 模型/ 来/ 分割/ 左室/ 壁/ 内膜/ ,/ 设计/ 了/ 专门/ 的/ 方法/ 来/ 解决/ 轮廓/ 缠绕/ 问题/ ./ Jolly/ [/ 12/ ]/ 首先/ 采用/ 极大/ 鉴别/ 分析方法/ 来/ 找到/ 左室/ 壁/ 内膜/ 的/ 大致/ 轮廓/ ,/ 并用/ Snake/ 模型/ 提取/ 左室/ 壁/ 内膜/ ./ Nguyen/ 等/ 人/ [/ 13/ ]/ 对/ 传统/ Snake/ 、/ 梯度/ 矢量/ 流/ GVF/ (/ GradientVectorFlow/ )/ Snake/ 和/ 气球/ Snake/ 模型/ 分割/ 左室/ 壁/ 内膜/ 的/ 结果/ 作/ 了/ 比较/ ,/ 并/ 与/ 手工/ 勾勒/ 的/ 轮廓/ 进行/ 对比/ 验证/ ,/ 其中/ ,/ GVFSnake/ 模型/ 性能/ 最好/ ./ Nachtomy/ 等/ 人/ [/ 14/ ]/ 提出/ 了/ 一种/ 基于/ 阈值/ 的/ 方法/ 提取/ 左心室/ 内/ 、/ 外膜/ ,/ 但/ 由于/ 阈值/ 的/ 局限性/ 结果/ 并/ 不/ 令人满意/ ./ Pednekar/ 等/ 人/ [/ 15/ ]/ 针对/ 图像/ 的/ 模糊/ 特点/ ,/ 提出/ 了/ 一种/ 基于/ 模糊/ 分析/ 的/ 左室/ 壁内/ 、/ 外膜/ 分割/ 方法/ ./ 国内/ 对/ 心脏/ 图像/ 的/ 分割/ 也/ 有/ 相关/ 研究/ ,/ 如/ 周寿军/ 等/ 人/ [/ 16/ ]/ 用/ 梯度/ 矢量/ 流/ Snake/ 模型/ 分割/ 左心室/ 时/ ,/ 引入/ 广义/ 模糊/ 集合/ 理论/ ,/ 提出/ 了/ 广义/ 模糊/ 梯度/ 矢量/ 流/ ./ 秦安/ 等/ 人/ [/ 17/ ]/ 将/ 广义/ 模糊/ 梯度/ 矢量/ 流/ 与/ 几何/ 主动/ 轮廓/ 相结合/ 来/ 分割/ 左心室/ 内膜/ ,/ 然后/ 采用/ 一种/ 区域/ 灰度/ 均值/ 和/ 距离/ 约束/ 的/ 外力/ 来/ 分割/ 左心室/ 外膜/ ./ 周则明/ 等/ 人/ [/ 18/ ]/ 将/ 简化/ Snake/ 模型/ 用于/ 心脏/ 图像/ 分割/ ,/ 并用/ 贪婪/ 算法/ 求解/ 能量/ 泛函/ 的/ 局部/ 极小/ 点/ ./ 王元全/ 等/ 人/ [/ 19/ ]/ 提出/ 了/ 一种/ 基于/ GVFSnake/ 模型/ 的/ 分割/ 策略/ ,/ 引入/ 了/ 形状/ 约束/ ,/ 提出/ 了/ 一种/ 基于/ 退化/ 最小/ 曲面/ 梯度/ 矢量/ 流/ (/ dms/ -/ GVF/ )/ ./ 目前/ ,/ 心脏/ 左心室/ 内/ 、/ 外膜/ 分割/ 存在/ 以下/ 难点/ :/ 首先/ ,/ 心脏/ MR/ 图像/ 在/ 成像/ 过程/ 中/ 由于/ 受/ 血液/ 流动/ 的/ 影响/ ,/ 会/ 在/ 血池/ 中/ 产生/ 伪影/ ,/ 使得/ 图像/ 灰度/ 不均/ ;/ 其次/ ,/ 目标/ 边界/ 往往/ 受到/ 乳突/ 肌/ ,/ 肺部/ 呼吸/ 等/ 因素/ 的/ 影响/ 而/ 变得/ 模糊不清/ 甚至/ 边界/ 断裂/ ;/ 另外/ ,/ 由于/ 左心室/ 与/ 右心室/ 及/ 周围/ 其它/ 组织/ 如/ 肝脏/ 等/ 灰度/ 非常/ 接近/ ,/ 形成/ 弱/ 边界/ ,/ 这时/ 基于/ 主动/ 轮廓/ 模型/ 的/ 方法/ 分割/ 左心室/ 外膜/ 时/ 往往/ 发生/ 泄露/ ./ 针对/ 这些/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ GVF/ 的/ 各向异性/ 扩散/ 和/ 形状/ 约束/ Snake/ 模型/ 的/ 分割/ 方法/ ./ 首先/ 构造/ 了/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ 外力/ 模型/ GNBGVF/ (/ GeneralizedNormallyBiasedGradientVectorFlow/ )/ ,/ 作为/ 对/ 梯度/ 矢量/ 流/ (/ GVF/ )/ 的/ 改进/ ,/ 该/ 外力/ 场/ 捕捉/ 范围/ 大/ 、/ 抗噪/ 能力/ 强/ 、/ 且/ 对/ 弱/ 边界/ 泄漏/ 有/ 更好/ 的/ 鲁棒性/ ./ 分割/ 左室/ 壁/ 内膜/ 时/ 仍然/ 采用/ 圆形/ 形状/ 约束/ [/ 19/ ]/ ,/ 圆/ 没有/ 方向性/ ,/ 相应/ 的/ 约束/ 可以/ 耦合/ 在/ 主动/ 轮廓/ 的/ 能量/ 泛函中/ ./ 分割/ 外膜/ 时/ 挖掘/ 了/ 左室/ 壁内/ 、/ 外膜/ 形状/ 上/ 的/ 相似性/ ,/ 构造/ 了/ 一种/ 新/ 的/ 形状/ 能量/ ;/ 根据/ 左室/ 壁内/ 、/ 外膜/ 位置/ 上/ 的/ 相关/ 关系/ ,/ 构造/ 新/ 的/ 边缘/ 图来/ 计算/ 新/ 的/ 外力/ 场/ ,/ 并/ 采用/ 内膜/ 分割/ 结果/ 来/ 初始化/ ,/ 实现/ 外膜/ 的/ 自动/ 分割/ ./ 采用/ 这一/ 策略/ 可以/ 高效/ 、/ 鲁棒/ 、/ 准确/ 地/ 同时/ 分割/ 左室/ 壁内/ 、/ 外膜/ ./ 2/ 基于/ 各向异性/ 扩散/ 的/ Snake/ 模型/ 外力/ 场/ 2.1/ Snake/ 模型/ 的/ 基本原理/ Snake/ 模型/ 是/ 一种/ 自顶向下/ 的/ 图像/ 分析方法/ ,/ 具有/ 传统/ 方法/ 无法比拟/ 的/ 优点/ ./ Snake/ 模型/ 可以/ 用/ 曲线/ c/ (/ s/ )/ =/ (/ x/ (/ s/ )/ ,/ y/ (/ s/ )/ )/ (/ s/ ∈/ [/ 0/ ,/ 1/ ]/ )/ 来/ 定义/ ,/ 这/ 是/ 以/ 归一化/ 弧长/ s/ 作为/ 参数/ 的/ 曲线/ 表达形式/ ./ 它/ 通过/ 极小/ 化/ 如下/ 的/ 能量/ 泛函来/ 确定/ 目标/ 轮廓/ :/ Esnake/ =/ ∫/ 1/ 其中/ ,/ α/ 和/ β/ 为/ 弹性/ 和/ 刚性/ 系数/ ,/ 控制/ 着/ 弹性/ 和/ 刚性/ 能量/ 的/ 大小/ ;/ 一阶/ 导数/ 项/ cs/ 刻画/ 了/ 曲线/ 的/ 连续性/ ,/ 是/ 曲线/ 的/ 弹性/ 能量/ ;/ 二阶/ 导数/ 项/ css/ 刻画/ 了/ 曲线/ 的/ 光滑性/ ,/ 是/ 曲线/ 的/ 刚性/ 能量/ ./ 这/ 两/ 导数/ 项/ 构成/ Snake/ 模型/ 的/ 内部/ 能量/ ./ Eext/ (/ c/ )/ 是/ Snake/ 模型/ 的/ 外部/ 能量/ ,/ 它/ 吸引/ Snake/ 轮廓/ 朝/ 目标/ 运动/ ./ 根据/ 变分法/ 原理/ ,/ 能量/ 泛函式/ (/ 1/ )/ 的/ 最小化/ 可以/ 通过/ 求解/ 如下/ Euler/ 方程/ Page3/ 得到/ 当式/ (/ 2/ )/ 的/ 解/ 收敛/ 时/ ,/ 就/ 得到/ 了/ 待/ 分割/ 目标/ 的/ 轮廓/ ./ 这时/ ,/ 可以/ 将/ Snake/ 轮廓/ 的/ 运动/ 过程/ 看成/ 其内/ 、/ 外力/ 的/ 平衡/ 过程/ 其中/ ,/ Fint/ =/ α/ css/ (/ s/ )/ -/ β/ cssss/ (/ s/ )/ 称为/ Snake/ 模型/ 的/ 内力/ ,/ Fint/ =/ -/ / Eext/ 称为/ 其/ 外力/ ./ Snake/ 模型/ 已经/ 提出/ 了/ 20/ 年/ ,/ 其/ 理论/ 发展/ 相对/ 成熟/ ,/ 但/ 在/ 特定/ 问题/ 的/ 应用/ 上/ ,/ 其/ 效率/ 和/ 性能/ 并/ 不/ 总是/ 令人满意/ ./ 2.2/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 场/ 模型/ 外力/ 在/ Snake/ 模型/ 的/ 演化/ 中起/ 决定性/ 作用/ ,/ 对/ 外力/ 的/ 研究/ 是/ Snake/ 模型/ 研究/ 的/ 一个/ 重要/ 方面/ ./ 由于/ 式/ (/ 2/ )/ 定义/ 的/ Snake/ 模型/ 外力/ 场/ 是/ 基于/ 图像/ 梯度/ 的/ ,/ 因此/ 其/ 捕捉/ 范围/ 小/ ,/ 不能/ 进入/ 深度/ 凹陷/ 区域/ ,/ 初始化/ 敏感/ ./ 针对/ 这些/ 问题/ ,/ Xu/ 和/ Prince/ 提出/ 了/ 用/ 梯度/ 矢量/ 流/ (/ GVF/ )/ 场/ 作为/ 新/ 的/ 外力/ 条件/ 代替/ 式/ (/ 2/ )/ 中/ 的/ / Eext/ 来/ 约束/ 动态/ 轮廓线/ [/ 7/ ]/ ,/ 并/ 将/ 其/ 定义/ 为/ V/ (/ x/ ,/ y/ )/ =/ [/ u/ (/ x/ ,/ y/ )/ ,/ v/ (/ x/ ,/ y/ )/ ]/ ,/ 满足/ 下列/ 能量/ 泛函/ 的/ 最小值/ :/ ε/ =/ ∫/ ∫/ μ/ |/ / V/ |/ 2/ +/ |/ / f/ |/ 2/ |/ V/ -/ / f/ |/ 2dxdy/ (/ 4/ )/ μ/ 为/ 权重/ 系数/ ,/ f/ 是/ 边缘/ 图/ ,/ 可以/ 由/ 其它/ 边缘/ 检测/ 算子/ 得到/ 或者/ 用/ 图像/ 梯度/ 来/ 近似/ ./ 使用/ 变分/ 原理/ ,/ GVF/ 场/ 可以/ 通过/ 解/ 下列/ 欧拉/ 方程/ 获得/ 其中/ Δ/ 为/ 拉普拉斯/ 算子/ ./ 作为/ 主动/ 轮廓/ 模型/ 中/ 最/ 成功/ 的/ 外部/ 力场/ 之一/ ,/ GVF/ 模型/ 扩展/ 了/ 边缘/ 映射/ 的/ 梯度/ 向量/ ,/ 同时/ 通过/ 一个/ 各向同性/ 的/ 扩散/ 过程/ 来/ 抑制/ 噪声/ ./ GVF/ 的/ 扩散/ 过程/ 依赖于/ 拉普拉斯/ 算子/ ,/ 对/ 图像/ f/ (/ x/ ,/ y/ )/ 而言/ ,/ 其/ 拉普拉斯/ 算子/ 为/ 这/ 是/ 在/ 迪/ 卡尔/ 坐标系/ 下/ 的/ 表达方式/ ,/ 那么/ 在/ Gauge/ 坐标系/ 下则/ 可/ 写/ 为/ 其中/ ,/ fTT/ 为/ 沿/ 切线/ 方向/ 的/ 二阶/ 导数/ ,/ fNN/ 为/ 沿/ 法线/ 方向/ 的/ 二阶/ 导数/ ./ 尽管/ GVF/ 已经/ 取得/ 了/ 巨大成功/ ,/ 但/ 仍/ 有/ 改进/ 的/ 余地/ [/ 20/ -/ 25/ ]/ ./ 文献/ [/ 24/ ]/ 提出/ 的/ NGVF/ 模型/ 是/ 对/ GVF/ 的/ 一种/ 改进/ ,/ 它/ 从/ 插值/ 的/ 角度/ 出发/ ,/ 把/ GVF/ 看成/ 一个/ 插值/ 的/ 过程/ ,/ 认为/ 从/ 插值/ 的/ 角度/ 来说/ [/ 26/ ]/ ,/ fNN/ 是/ 最好/ 的/ 插值/ 算子/ ,/ Δ/ f/ 其次/ ,/ fTT/ 是/ 最差/ 的/ ./ 其/ 模型/ 如下/ :/ 然而/ ,/ 从/ GVF/ 的/ 扩散/ 过程/ 来/ 分析/ ,/ GVF/ 并/ 不是/ 一个/ 插值/ 的/ 过程/ ,/ 而是/ 一个/ 逼近/ 的/ 过程/ [/ 27/ ]/ ./ 同时/ 扩散/ 分解/ 的/ 理论/ 告诉/ 我们/ ,/ 沿/ 切线/ 方向/ 的/ 扩散/ 有助于/ 去除/ 噪声/ 并/ 保持/ 边缘/ [/ 28/ ]/ ./ 基于/ 这样/ 的/ 考虑/ ,/ 我们/ 曾/ 提出/ 了/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ (/ GNBGVF/ )/ 模型/ [/ 25/ ]/ ,/ 该/ 模型/ 保留/ 了/ 切线/ 方向/ 的/ 扩散/ ,/ 但是/ 对/ 法线/ 方向/ 的/ 扩散/ 进行/ 加权/ ,/ 使得/ 在/ 边缘/ 附近/ 法线/ 方向/ 的/ 扩散/ 减弱/ ,/ 平坦/ 区域/ 的/ 扩散/ 增强/ ,/ 这样/ 有利于/ 保持/ 边缘/ ,/ 去除/ 噪声/ 并/ 扩大/ 捕捉/ 范围/ ./ NBGVF/ 通过/ 如下/ 的/ 方程/ 得到/ ut/ =/ μ/ (/ uTT/ +/ g/ (/ |/ / f/ |/ )/ uNN/ )/ -/ (/ u/ -/ fx/ )/ |/ / f/ |/ 2/ =/ 0/ 烅/ 烄/ vt/ =/ μ/ (/ vTT/ +/ g/ (/ |/ / f/ |/ )/ vNN/ )/ -/ (/ v/ -/ fy/ )/ |/ / f/ |/ 2/ 烆/ 在/ 此基础/ 上/ ,/ 通过/ 对/ 拉普拉斯/ 算子/ 的/ 扩散/ 过程/ 的/ 进一步/ 分析/ ,/ 我们/ 提出/ 了/ 一种/ 新/ 的/ 外力/ 场/ :/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ GNBGVF/ (/ GeneralizedNormal/ -/ lyBiasedGradientVectorFlow/ )/ 模型/ ,/ 该/ 模型/ 除了/ 保持/ NBGVF/ 的/ 优点/ 外/ ,/ 还/ 能/ 根据/ 图像/ 结构/ 信息/ 调整/ 切线/ 和/ 法线/ 方向/ 的/ 扩散/ 过程/ ,/ 具有/ 更大/ 的/ 灵活性/ ./ GNBGVF/ 模型/ 如下/ :/ ut/ =/ μ/ (/ h/ (/ |/ / f/ |/ )/ uTT/ +/ g/ (/ |/ / f/ |/ )/ uNN/ )/ -/ 烄/ 烅/ vt/ =/ μ/ (/ h/ (/ |/ / f/ |/ )/ vTT/ +/ g/ (/ |/ / f/ |/ )/ vNN/ )/ -/ 烆/ 其中/ ,/ g/ (/ ·/ )/ 仍为/ 偏差/ 因子/ ,/ 它/ 是/ 关于/ |/ / f/ |/ 的/ 单调/ 递减/ 函数/ ,/ 相应/ 地/ ,/ h/ (/ ·/ )/ 是/ 关于/ |/ / f/ |/ 的/ 单调/ 递增/ 函数/ ./ 当/ |/ / f/ |/ 很大/ 时/ ,/ 即/ 在/ 边界/ 处/ ,/ g/ (/ ·/ )/ →/ 0/ ,/ h/ (/ ·/ )/ →/ 1/ ,/ 则/ 沿/ 法线/ 方向/ 的/ 扩散/ 消失/ 了/ 而/ 沿/ 切线/ 方向/ 的/ 扩散/ 被/ 保持/ ,/ 有助于/ 保持/ 弱/ 边缘/ ,/ 同时/ 消除/ 噪声/ ,/ GNBGVF/ 就/ 被/ 简化/ 为/ NBGVF/ ./ 当/ |/ / f/ |/ =/ 0/ 时/ ,/ 即/ 在/ 平坦/ 区域/ ,/ g/ (/ ·/ )/ →/ 1/ ,/ h/ (/ ·/ )/ →/ 0/ ,/ GNBGVF/ 就/ 被/ 简化/ 为/ NGVF/ ./ 此外/ ,/ 当/ g/ (/ ·/ )/ →/ 1/ // 2/ ,/ h/ (/ ·/ )/ →/ 1/ // 2/ 时/ ,/ 这时/ 的/ 外力/ 模型/ 就/ 简化/ 为/ GVF/ ./ 这里/ k/ 是/ 一个/ 可/ 为/ 特定/ 应用/ 而/ 调整/ 的/ 常量/ ,/ 它/ 决定/ 着/ 要/ 保持/ 的/ 边缘/ 对比度/ ./ 当/ 需要/ 保持/ 的/ 边界/ 是/ 弱/ 边缘/ ,/ 这个/ 值/ 很小/ ,/ 反之亦然/ ./ 3/ 左室/ 壁内/ 、/ 外膜/ 的/ 分割/ 为了/ 克服/ 血液/ 的/ 高速/ 运动/ 冲撞/ 心肌/ 壁/ 造成/ 的/ 伪影/ (/ artifact/ )/ 等/ 引起/ 的/ 图像/ 灰度/ 不均/ 以及/ 乳突/ 肌干/ Page4/ 扰/ 等/ 对/ 心脏/ MRI/ 的/ 影响/ ,/ 我们/ 既/ 需要/ 考虑/ 曲线/ 的/ 光滑性/ ,/ 也/ 需要/ 考虑/ 目标/ 的/ 整体/ 形状/ ./ 整体/ 形状/ 是/ 一种/ 全局性/ 的/ 约束/ ,/ 有利于/ 克服/ 图像/ 中/ 的/ 噪声/ ./ 但/ Snake/ 模型/ 内能/ 只能/ 约束/ 曲线/ 的/ 连续性/ 和/ 光滑性/ 等/ 局部/ 性质/ ,/ 且/ 由于/ 缺乏/ 关于/ 目标/ 形状/ 的/ 全局/ 信息/ 而/ 不能/ 有效/ 地/ 刻画/ 目标/ 的/ 形状/ ./ 考虑/ 到/ 左室/ 壁内/ 、/ 外膜/ 的/ 形状/ 特点/ ,/ 我们/ 引入/ 圆形/ 能量/ 约束/ 项/ [/ 19/ ]/ ,/ 使得/ Snake/ 轮廓/ 在/ 演化过程/ 中其/ 全局/ 形状/ 得到/ 保持/ ./ 该/ 能量/ 项/ 如下/ :/ Ecircle/ =/ λ/ 烅/ 其中/ ,/ λ/ 为/ 权重/ 因子/ ,/ Rx/ (/ s/ ,/ x/ (/ s/ )/ )/ =/ x/ (/ s/ )/ -/ ∫/ 1/ 烄/ Ry/ (/ s/ ,/ y/ (/ s/ )/ )/ =/ y/ (/ s/ )/ -/ ∫/ 1R/ -/ (/ X/ ,/ Y/ )/ =/ ∫/ 1/ 若/ xc/ =/ ∫/ 1/ 烆/ 以/ 认为/ 是/ Snake/ 轮廓线/ 的/ 质心/ ,/ (/ xc/ ,/ yc/ )/ 和/ R/ -/ 是/ 随着/ Snake/ 曲线/ 演化/ 而/ 动态变化/ 的/ ./ Ecircle/ 这一/ 能量/ 就/ 度量/ 了/ Snake/ 轮廓/ 上/ 的/ 点/ 与/ 圆心/ 为/ (/ xc/ ,/ yc/ )/ ,/ 半径/ 为/ R/ -/ 的/ 圆/ 之间/ 的/ 差异/ ./ 当/ Snake/ 轮廓/ 不/ 受/ 外力作用/ 时/ ,/ 该/ 能量/ 项/ 将/ 使/ Snake/ 轮廓/ 保持/ 为/ 圆形/ ./ 在/ 分割/ 左心室/ 内膜/ 过程/ 中当/ Snake/ 曲线/ 演化/ 到/ 伪影/ 和/ 乳突/ 肌时/ ,/ 由于/ 受到/ 圆形/ 约束/ 的/ 限制/ ,/ 曲线/ 能/ 绕过/ 伪影/ 和/ 乳突/ 肌/ 向着/ 我们/ 需要/ 的/ 目标/ 特征/ 继续/ 演化/ ./ 根据/ 变分法/ 原理/ ,/ 式/ (/ 12/ )/ 对应/ 的/ 欧拉/ 方程/ 为/ 写成/ 离散/ 形式/ 为/ 烅/ 烄/ 烆/ 烅/ 烄/ 烆/ i/ =/ 0/ 其中/ ,/ R/ -/ =/ 1n/ ∑/ n/ -/ 1xc/ =/ 1/ 放在/ 时间/ 演化/ 框架/ 下/ 求解/ 并/ 采用/ 半隐式/ 格式/ ,/ 得到/ xt/ +/ 1i/ -/ xti/ Δ/ t/ +/ λ/ xt/ +/ 1i/ -/ λ/ (/ xtc/ +/ R/ -/ tcos/ (/ 2/ π/ i/ // n/ )/ )/ =/ 0/ 烄/ 烅/ yt/ +/ 1i/ -/ yti/ Δ/ t/ +/ λ/ yt/ +/ 1i/ -/ λ/ (/ ytc/ +/ R/ -/ tsin/ (/ 2/ π/ i/ // n/ )/ )/ 烆/ 图/ 1/ 显示/ 了/ 圆形/ 约束/ 项/ 的/ 作用/ ./ 在/ 这些/ 结果/ 中/ ,/ 左边/ 图像/ 是/ 没有/ 采用/ 圆形/ 约束/ 的/ 结果/ ,/ 右边/ 图像/ 则/ 是/ 采用/ 圆形/ 约束/ 的/ 结果/ ./ 图/ 1/ (/ a/ )/ 在/ 分割/ 内膜/ 时/ ,/ 初始/ 轮廓/ 选取/ 位于/ 内膜/ 范围/ 内/ 的/ 圆/ ,/ 可以/ 看到/ 左图/ 由于/ 没有/ 采用/ 圆形/ 约束/ ,/ Snake/ 轮廓/ 易/ 受到/ 乳突/ 肌/ 和/ 伪影/ 的/ 干扰/ 而/ 陷入/ 局部/ 极小/ ./ 采用/ 形状/ 约束/ 后/ Snake/ 轮廓/ 能/ 绕过/ 伪影/ 和/ 乳突/ 肌/ 收敛/ 到/ 我们/ 需要/ 的/ 目标/ 边界/ ,/ 得到/ 较/ 好/ 的/ 分割/ 结果/ ./ 图/ 1/ (/ b/ )/ 在/ 分割/ 外膜/ 时/ 由于/ 左心室/ 与/ 右心室/ 及/ 周围/ 其它/ 组织/ 如/ 肝脏/ 等/ 灰度/ 非常/ 接近/ 易/ 形成/ 弱/ 边界/ ,/ 并且/ 外力/ 场/ 不够/ 完美/ ,/ 若/ 不/ 采用/ 圆形/ 约束/ ,/ 由于/ 图像/ 的/ 梯度/ 力/ 在/ 低/ 对比度/ 区域/ 和/ 弱/ 边界/ 处/ 太小/ ,/ 出现/ 了/ 变形/ 曲线/ 泄露/ 的/ 现象/ (/ 左图/ )/ ./ 在/ 采用/ 全局/ 形状/ 约束/ 后/ ,/ 阻止/ 了/ Snake/ 轮廓/ 从/ 低/ 对比度/ 区域/ 或弱/ 边界/ 区域/ 泄露/ (/ 右图/ )/ ./ 这样/ ,/ 在/ 分割/ 左室/ 壁/ 内膜/ 时/ ,/ Snake/ 模型/ 的/ 外力/ 由式/ (/ 10/ )/ 决定/ ,/ 而/ 内力/ 则/ 由式/ (/ 2/ )/ 中/ 的/ 导数/ 项和式/ (/ 12/ )/ 共同/ 决定/ ./ 对于/ 左室/ 壁/ 外膜/ 的/ 分割/ ,/ 考虑/ 到/ 在/ 基于/ 图像/ 梯度/ 的/ 外力/ 场中/ ,/ 左室/ 壁/ 内膜/ 是/ 一个/ 局部/ 极小/ 点/ ,/ 几乎/ 所有/ 基于/ Snake/ 模型/ 的/ 方法/ 在/ 分割/ 出/ 左室/ 壁/ 内膜/ 后/ ,/ 轮廓/ 都/ 不会/ 再/ 运动/ ,/ 无法/ 继续/ 分割/ 其/ 外膜/ ,/ 为此/ ,/ 必须/ 除去/ 这一/ 局部/ 极小/ 点/ ./ 事实上/ ,/ 左室/ 壁/ 外膜/ 完全/ 包围/ 了/ 其/ 内膜/ ,/ 在/ 分割/ 出/ 左室/ 壁/ 内膜/ 以后/ ,/ Snake/ 轮廓/ 也/ 完全/ 刻画/ 了/ 外力/ 的/ 局部/ 极小/ 点/ ./ 基于/ 上述/ 分析/ ,/ 我们/ 在/ 分割/ 策略/ 中/ 直接/ 将/ 原始/ 边缘/ 图中/ Snake/ 轮廓/ 所/ 包围/ 区域/ 的/ 边缘/ 强度/ 置/ 为/ 0/ ,/ 这/ 就/ 抹/ 平/ 了/ 左室/ 壁/ 内膜/ 边缘/ (/ 及/ 部分/ 噪声/ )/ ,/ 再/ 采用/ 这一/ 改动/ 的/ 边缘/ 图来/ 重新/ 计算/ 外力/ 场/ ,/ 从而/ 实现/ 了/ 左室/ 壁/ 外膜/ 的/ 自动/ 分割/ ./ Page54/ 实验/ 结果/ 及/ 分析/ 在/ 本节/ 实验/ 中/ ,/ 我们/ 首先/ 对/ GNBGVFSnake/ 模型/ 进行/ 实验/ 并/ 和/ NGVF/ 、/ NBGVFSnake/ 模型/ 进行/ 了/ 比较/ ;/ 然后/ 展示/ GNBGVFSnake/ 在/ 保持/ 目标/ 弱/ 边界/ 上/ 具有/ 更好/ 地/ 鲁棒性/ ;/ 最后/ ,/ 在/ 一套/ 心脏/ MR/ 图像/ 上/ 验证/ 上述/ 分割/ 策略/ ,/ 并/ 与/ 手工/ 分割/ 的/ 结果/ 进行/ 定量/ 比较/ ./ 这里/ 所用/ 的/ MR/ 图像/ 由/ SIEMENS1/ ./ 5T/ 临床/ 系统/ 产生/ ,/ 成像/ 参数/ 如下/ :/ 原始/ 图像/ 尺寸/ 192/ ×/ 156/ ,/ 切片/ 厚度/ 8mm/ ,/ 重复/ 时间/ (/ TR/ )/ =/ 29.16/ ,/ 回波/ 时间/ (/ TE/ )/ =/ 1.08/ ,/ 分辨率/ 1.82/ ×/ 1.82/ ,/ 回/ 转角/ (/ flipangle/ )/ =/ 50/ ,/ 视野/ (/ FOV/ )/ =/ 81.25/ ./ 实验/ 中/ 使用/ 的/ 参数/ 为/ α/ =/ 0.1/ ,/ β/ =/ 0/ ,/ λ/ =/ 0.3/ ,/ μ/ =/ 0.15/ ,/ k/ =/ 0.1/ ./ 计算/ 图/ 2NGVF/ 、/ NBGVF/ 和/ GNBGVFSnake/ 的/ 性能/ 比较/ 环境/ 为/ Matlab7/ ./ 1/ ,/ CPU3/ ./ 39GHz/ ,/ RAM1/ ./ 0GB/ ,/ WindowsXPProfessional/ ./ 图/ 2/ 给出/ 了/ 在/ 合成/ 图像/ 上/ GNBGVF/ 、/ NBGVF/ 和/ NGVF/ 的/ 性能/ 比较/ ./ 图/ 2/ (/ a/ )/ 和/ (/ b/ )/ 是/ 在/ 长/ 40/ 像素/ 、/ 宽/ 5/ 个/ 像素/ 的/ 深度/ 凹陷/ 区域/ 上/ 的/ 收敛/ 过程/ ./ 图/ 2/ (/ a/ )/ 是/ GNBGVF/ 力场/ 迭代/ 200/ 次/ 的/ 结果/ ,/ 显然/ ,/ GNBGVF/ 模型/ 能够/ 成功/ 地/ 收敛/ 到/ 这个/ 细长/ 的/ 凹陷/ 区域/ ./ 图/ 2/ (/ b/ )/ 显示/ NGVF/ 模型/ 在/ NGVF/ 力场/ 的/ 捕捉/ 范围/ 足够/ 大/ 的/ 时候/ ,/ 即/ 迭代/ 次数/ 大于/ 1000/ 次/ 才能/ 收敛/ 到/ 这个/ 凹陷/ 区域/ ./ 图/ 2/ (/ c/ )/ 、/ (/ d/ )/ 和/ (/ e/ )/ 给出/ 了/ 在/ 边界/ 缺口处/ 的/ 性能/ ./ 图/ 2/ (/ c/ )/ 为/ NGVFSnake/ 的/ 演化过程/ 和/ 它/ 的/ 力场/ ./ 图/ 2/ (/ d/ )/ 从左到右/ 分别/ 是/ NGVF/ 和/ GNBGVF/ 的/ 演化过程/ ,/ 从中/ 可/ 看出/ 部分/ NGVF/ 模型/ 也/ 能够/ 收敛/ 到/ 右边/ 的/ 凸起/ ,/ 相信/ 也/ 能/ 收敛/ 到/ 左/ Page6/ 边/ 凸起/ ./ 这/ 也/ 从/ 另/ 一/ 方向/ 反映/ 了/ NGVF/ 模型/ 对/ 边界/ 缺口/ 比较/ 敏感/ ./ 图/ 2/ (/ e/ )/ 从左到右/ 分别/ 是/ NBGVF/ 和/ GNBGVF/ 的/ 演化过程/ ,/ 从中/ 可以/ 看出/ GNBGVF/ 在/ 边界/ 缺口处/ 有/ 更好/ 的/ 性能/ ./ 图/ 2/ (/ f/ )/ 、/ (/ g/ )/ 和/ (/ h/ )/ 给出/ 了/ 3/ 种/ 外力/ 模型/ 的/ 噪声/ 鲁棒性/ ./ 由于/ NGVF/ 舍弃/ 了/ 沿着/ 切线/ 方向/ 的/ 扩散/ ,/ NBGVF/ 沿/ 切线/ 方向/ 的/ 扩散/ 不随/ 图像/ 信息/ 变化/ ,/ 所以/ 它们/ 与/ GNBGVF/ 相比/ 对/ 噪声/ 更为/ 敏感/ ./ 在/ 结果/ 中/ ,/ 从左到右/ 分别/ 是/ 受/ 椒盐/ 噪声/ 、/ 斑马/ 噪声/ 、/ 瑞利/ 噪声/ 和/ 高斯/ 噪声污染/ 的/ U/ 型/ 图像/ 及其/ 收敛/ 过程/ ,/ 不难看出/ ,/ GNBGVFSnake/ 具有/ 更好/ 的/ 抗噪性/ ./ 在/ 第/ 2/ 节中/ ,/ 我们/ 从/ 理论/ 上/ 分析法/ 向/ 有/ 偏/ 梯度/ 矢量/ 流/ 外力/ 模型/ 在/ 保持/ 目标/ 弱/ 边界/ 上/ 具有/ 更好/ 的/ 鲁棒性/ ,/ 这里/ 从/ 实验/ 上/ 说明/ 这/ 一点/ ./ 如图/ 3/ 所示/ ,/ 图/ 3/ 图/ 3GNBGVFSnake/ 在/ 弱/ 边界/ 方面/ 的/ 性能/ 图/ 4/ 使用/ 本文/ 方法/ 的/ 左室/ 壁/ 分割/ 结果/ 我们/ 对/ 分割/ 结果/ 与/ 手工/ 分割/ 结果/ 进行/ 比较/ ,/ 采用/ 平均/ 绝对/ 距离/ MAD/ (/ MeanAbsoluteDistance/ )/ 度量/ 二者之间/ 的/ 差异/ [/ 19/ ]/ ,/ 平均/ 绝对/ 距离/ 的/ 方差/ 度量/ 二者之间/ 差异/ 的/ 波动/ ./ 设/ Snake/ 轮廓/ 为/ S/ ,/ 手工/ 分割/ 结果/ 为/ M/ ,/ 则/ MAD/ (/ S/ ,/ M/ )/ =/ 0.51/ (/ a/ )/ 、/ (/ b/ )/ 、/ (/ c/ )/ 和/ (/ d/ )/ 显示/ 了/ GVF/ 、/ NGVF/ 、/ NBGVF/ 和/ GNBGVF/ 在/ 一幅/ 合成/ 图像/ 上/ 的/ 表现/ ,/ 该/ 合成/ 图像/ 有/ 一个/ 具有/ 弱/ 边界/ 的/ 矩形/ ,/ 且/ 在/ 矩形/ 附近/ 有/ 一强/ 边界/ ,/ 两者/ 的/ 间距/ 只有/ 3/ 个/ 像素/ ./ 很/ 明显/ ,/ GNBGVFSnake/ 在/ 四者/ 中/ 具有/ 最佳/ 的/ 性能/ ./ 图/ 3/ (/ f/ )/ 、/ (/ g/ )/ 和/ (/ h/ )/ 显示/ 了/ NGVF/ 、/ NBGVF/ 和/ GNBGVF/ 在/ 一幅/ 心脏/ MR/ 图像/ 上/ 的/ 表现/ ,/ NGVF/ 在/ 目标/ 的/ 右上角/ 泄漏/ ,/ 而/ NBGVF/ 和/ GNBGVF/ 则/ 能/ 很/ 好/ 的/ 封闭/ ,/ 如/ 黑色/ 箭头/ 所指/ ,/ 这/ 就/ 说明/ 了/ GNBGVF/ 具有/ 较/ 好/ 的/ 保持/ 目标/ 弱/ 边界/ 的/ 性能/ ./ 采用/ 这里/ 介绍/ 的/ 方法/ ,/ 我们/ 对/ 一套/ 心脏/ MR/ 图像/ 的/ 一个/ 图层/ 进行/ 分割/ ,/ 在/ 一个/ 心动/ 周期/ 内/ 每个/ 图像/ 层/ 包含/ 21/ 幅/ 图像/ ,/ 图/ 4/ 中/ 给出/ 了/ 21/ 幅/ 图像/ 的/ 分割/ 结果/ ./ VAR/ (/ MAD/ )/ =/ 1/ 其中/ ,/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sn/ }/ ,/ M/ =/ {/ m1/ ,/ m2/ ,/ …/ ,/ mk/ }/ 分别/ 表示/ Snake/ 轮廓/ 和/ 手工/ 轮廓/ 上/ 的/ 点/ ,/ d/ (/ s/ ,/ M/ )/ =/ mins/ -/ m/ ,/ MAD/ (/ S/ ,/ M/ )/ 为/ MAD/ 的/ 均值/ ./ 对于/ 整套/ 图像/ 而言/ ,/ 左室/ 壁/ 内膜/ 的/ 平均/ MAD/ 值为/ 0.67/ 像素/ ,/ 基本上/ 与/ 手工/ 分割/ 结果/ 相同/ ;/ 外膜/ 的/ 平均/ MADPage7/ 值为/ 1.35/ 像素/ ,/ 与/ 手工/ 分割/ 结果/ 非常/ 接近/ 的/ ./ 而/ 内膜/ 与/ 外膜/ 的/ 平均/ 绝对/ 距离/ 的/ 方差/ 分别/ 为/ 0.024/ 和/ 0.08/ ,/ 表明/ 实验/ 分割/ 结果/ 与/ 手工/ 分割/ 结果/ 的/ 差异/ 的/ 波动/ 不大/ ./ 5/ 结论/ 本文/ 提出/ 了/ 一种/ 基于/ 主动/ 轮廓/ 模型/ 的/ 心脏/ 核磁共振/ 图像/ 左室/ 壁内/ 、/ 外膜/ 的/ 分割/ 方法/ ./ 主动/ 轮廓/ 模型/ 尽管/ 是/ 一种/ 比较/ 成熟/ 的/ 方法/ ,/ 但/ 并/ 不能/ 很/ 好地解决/ 左室/ 壁/ 的/ 分割/ 问题/ ./ 首先/ 提出/ 了/ 主动/ 轮廓/ 模型/ 的/ 广义/ 法向/ 有/ 偏/ 梯度/ 矢量/ 流/ 外力/ 模型/ GNBGVF/ ,/ 该/ 外力/ 场/ 除了/ 保持/ 切线/ 方向/ 的/ 扩散/ 外/ ,/ 还/ 保留/ 了/ 法线/ 方向/ 有/ 偏/ 的/ 扩散/ ,/ 具有/ 捕捉/ 范围/ 大/ 、/ 抗噪/ 能力/ 强/ 、/ 且/ 对/ 弱/ 边界/ 泄漏/ 有/ 更好/ 的/ 鲁棒性/ ./ 在/ 左室/ 壁/ 内膜/ 的/ 分割/ 而言/ ,/ 考虑/ 到/ 左室/ 壁/ 的/ 近似/ 为/ 圆形/ 的/ 特点/ ,/ 采用/ 了/ 圆形/ 约束/ 的/ 能量/ 项/ ,/ 这种/ 形状/ 约束/ 有利于/ 克服/ 由于/ 图像/ 灰度/ 不均/ 、/ 乳突/ 肌/ 等/ 而/ 导致/ 的/ 局部/ 极小/ ./ 对于/ 左室/ 壁/ 外膜/ 的/ 分割/ ,/ 利用/ 内膜/ 的/ 分割/ 结果/ 初始化/ ,/ 即/ 通过/ 重新组合/ 梯度/ 分量/ 来/ 构造/ 的/ 外力/ 场/ ./ 这种/ 外力/ 场能/ 有效/ 克服/ 原始/ 梯度/ 矢量/ 流/ 的/ 不足/ ,/ 使得/ 室壁/ 外膜/ 边缘/ 很弱/ 时/ 也/ 能/ 得到/ 保持/ ./ 实验/ 结果表明/ ,/ 该/ 方法/ 能/ 准确/ 地/ 分割/ 左室/ 壁内/ 、/ 外膜/ ./ 在/ 接下来/ 的/ 研究/ 中/ ,/ 我们/ 将/ 进一步/ 分析/ GVF/ 中/ 拉普拉斯/ 算子/ 切线/ 方向/ 和/ 法线/ 方向/ 扩散/ 项/ 的/ 作用/ ,/ 并/ 针对/ 法线/ 方向/ 扩散/ 具有/ 去除/ 噪声/ 和/ 扩散/ 力场/ 的/ 作用/ 拟/ 提出/ 一种/ 基于/ 偏/ 微分方程/ 的/ 图像去噪/ 方法/ ,/ 以期/ 进一步/ 完善/ 本文/ 所/ 提出/ 的/ 分割/ 策略/ ./ 致谢/ 香港中文大学/ 计算机科学/ 工程系/ 王平安/ 教授/ 为/ 我们/ 提供/ 了/ 多套/ 心脏/ MR/ 图像/ ,/ 在/ 此/ 我们/ 表示/ 衷心/ 的/ 感谢/ !/ 

