Page1/ 多/ 变量/ 公钥/ 密码/ 扩展/ 方案/ 的/ 安全性/ 分析/ 聂旭云/ 1/ )/ ,/ 2/ )/ ,/ 4/ )/ 徐赵虎/ 1/ )/ ,/ 2/ )/ 廖/ 永建/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 钟婷/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 电子科技/ 大学/ 计算机科学/ 与/ 工程学院/ 成都/ 611731/ )/ 2/ )/ (/ 网络/ 与/ 数据安全/ 四川省/ 重点/ 实验室/ 成都/ 611731/ )/ 3/ )/ (/ 上海市/ 信息安全/ 综合/ 管理/ 技术/ 研究/ 重点/ 实验室/ 上海/ 200240/ )/ 4/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100093/ )/ 摘要/ 扩展/ 的/ 多/ 变量/ 公钥/ 密码/ 方案/ (/ ExtendedMultivariatePublicKeyCryptosystem/ ,/ EMC/ )/ 是/ Wang/ 等/ 人/ 在/ 2011/ 年/ 提出/ 的/ 一种/ 新/ 的/ 增强/ 多/ 变量/ 公钥/ 加密/ 体制/ 安全性/ 的/ 方法/ ,/ 其/ 核心/ 是/ 在/ 加密/ 之前/ 先对/ 明文/ 变量/ 进行/ 一次/ 基于/ 杂凑/ 函数/ 的/ 驯顺/ 变换/ (/ Hash/ -/ basedTameTransformation/ ,/ 简称/ HT/ 变换/ )/ 处理/ ./ Wang/ 等/ 人/ 将/ EMC/ 方法/ 和/ 加/ 方法/ 相结合/ 构造/ 出/ 了/ 多/ 变量/ 加密/ 方案/ HTTP/ (/ Hash/ -/ basedtameandplus/ )/ ./ 作者/ 声称/ HTTP/ 方案/ 可以/ 抵挡/ 现有/ 的/ 对/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 攻击/ ./ 文中/ 对/ EMC/ 方案/ 和/ HTTP/ 加密/ 方案/ 进行/ 了/ 安全性/ 分析/ ,/ 分析/ 结果表明/ EMC/ 方案/ 并/ 没有/ 真正/ 增强/ 原始/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 安全性/ ./ 如果/ 存在/ 一种/ 攻击/ 方法/ 可/ 恢复/ 原始/ 的/ 多/ 变量/ 公钥/ 加密/ 体制/ 的/ 合法/ 密文/ 对应/ 的/ 明文/ ,/ 那么/ 同样/ 可以/ 恢复/ 增强/ 后/ 的/ 加密/ 方案/ 的/ 合法/ 密文/ 对应/ 的/ 明文/ ./ 计算机/ 实验/ 表明/ ,/ 我们/ 的/ 攻击/ 是/ 有效/ 的/ ./ 关键词/ 多/ 变量/ 公钥/ 密码/ ;/ 扩展/ 方案/ ;/ 线性化/ 方程/ ;/ HT/ 变换/ 1/ 引言/ 多/ 变量/ 公钥/ 密码/ (/ MPKC/ )/ 是/ 利用/ 有限/ 域/ 上/ 多/ 变量/ 多项式/ 构造/ 出/ 的/ 公钥/ 密码/ 方案/ ./ MPKC/ 的/ 安全性/ 基于/ 求解/ 有限/ 域/ 上/ 随机/ 生成/ 的/ 多/ 变量/ 多项式/ 方程组/ 问题/ 的/ 困难性/ ,/ 这是/ 一个/ NP/ -/ 困难/ 问题/ ./ 目前/ 还/ 没有/ 发现/ 在/ 量子/ 计算机/ 上/ 多项式/ 时间/ 内/ 求解/ 该/ 困难/ 问题/ 的/ 算法/ ./ 另外/ ,/ 由于/ MPKC/ 的/ 运算/ 都/ 是/ 在/ 较/ 小/ 的/ 有限/ 域/ 上/ 进行/ ,/ 故/ 运算/ 效率/ 非常/ 高/ ,/ 因而/ 多/ 变量/ 公钥/ 密码/ 方案/ 被/ 认为/ 是/ 一种/ 传统/ 公钥/ 密码/ 的/ 替代/ 方案/ ./ 目前/ 已经/ 构造/ 出/ 了/ 很/ 多种/ 多/ 变量/ 公钥/ 密码/ 方案/ ,/ 但/ 大部分/ 的/ MPKC/ 方案/ 都/ 存在/ 着/ 安全性/ 漏洞/ ./ 因此/ 人们/ 提出/ 了/ 多种/ 安全性/ 增强/ 的/ 方法/ ,/ 来/ 改进/ 现有/ 体制/ 的/ 安全性/ ./ 目前/ 主要/ 的/ 安全性/ 增强/ 方法/ 有减/ 方法/ [/ 1/ ]/ 、/ 醋/ 变量/ 方法/ [/ 2/ ]/ 、/ 内部/ 扰动/ 方法/ [/ 3/ ]/ 以及/ 噪声/ 扰动/ [/ 4/ ]/ 方法/ 等/ ./ SFLASH/ [/ 5/ ]/ 是/ 减/ 方法/ 的/ 代表/ 方案/ 之一/ ,/ 在/ 2003/ 年/ 被/ 欧洲/ NESSIE/ 密码/ 计划/ 接受/ 用于/ 低耗/ 智能卡/ 的/ 推荐/ 算法/ ①/ ./ 在/ 2007/ 年/ ,/ Dubois/ 等/ 人/ [/ 6/ ]/ 利用/ 差分/ 攻击/ 成功/ 地/ 伪造/ 了/ SFLASH/ 签名/ 体制/ 的/ 合法/ 签名/ ./ 醋/ 变量/ 方法/ 是/ Patarin/ 等/ 人/ 根据/ 油醋/ 签名/ 体制/ 的/ 思想/ 提出/ 来/ 的/ 一种/ 扰动/ 方案/ ./ 这种/ 方法/ 增强/ 了/ 原/ 体制/ 的/ 安全性/ ./ Ding/ 等/ 人/ [/ 7/ ]/ 分析/ 了/ HFEv/ (/ HiddenFieldEquation/ -/ vinegar/ )/ 体制/ ,/ 可/ 将/ 醋/ 变量/ 的/ 扰动/ 效果/ 消除/ ,/ 使/ 其/ 与/ 扰动/ 前/ 的/ HFE/ 体制/ [/ 8/ ]/ 的/ 安全性/ 相同/ ./ 内部/ 扰动/ 是/ Ding/ 在/ 2004/ 年/ 提出/ 来/ 的/ 一种/ 扰动/ 方法/ ,/ 并/ 将/ 其/ 应用/ 于/ 对/ MI/ [/ 9/ ]/ (/ Matsumoto/ -/ Imai/ )/ 和/ HFE/ 两种/ 加密/ 体制/ 的/ 扰动/ ,/ 用于/ 增强/ 这/ 两种/ 体制/ 的/ 安全性/ ./ 这种/ 扰动/ 可以/ 避免/ 原/ 体制/ 的/ 一些/ 弱点/ ,/ 比如/ 将/ 其/ 应用/ 于/ MI/ 体制/ 后/ ,/ 消除/ 了/ MI/ 体制/ 中/ 存在/ 的/ 线性化/ 方程/ ./ 但/ MI/ 体制/ 和/ HFE/ 体制/ 的/ 内部/ 扰动/ 在/ 提出/ 后/ 不久/ 被/ Fouque/ 和/ Dubois/ 等/ 人/ [/ 10/ -/ 11/ ]/ 利用/ 差分/ 攻击/ 给/ 破解/ 了/ ./ Wang/ 等/ 人/ [/ 4/ ]/ 在/ 2010/ 年/ 给出/ 了/ 一种/ 噪声/ 扰动/ 方案/ ./ 他们/ 引入/ 了/ 一种/ 噪声/ 运算/ 对/ 多/ 变量/ 公钥/ 密码/ 体制/ 进行/ 扰动/ ,/ 并/ 声称/ 扰动/ 后/ 的/ 体制/ 能/ 增强/ 体制/ 的/ 安全/ ,/ 可/ 抵挡/ 差分/ 攻击/ ./ 孙/ 思维/ 等/ 人/ 对/ 该/ 方案/ 进行/ 了/ 分析/ ,/ 针对/ 文献/ 中/ 提出/ 的/ 实例/ pSFLASH/ ,/ 在/ 几秒钟/ 的/ 时间/ 内/ 可以/ 实际/ 地/ 伪造/ 出/ 任意/ 消息/ 的/ 合法/ 的/ pSFLASH/ 签名/ [/ 12/ ]/ ./ 扩展/ 的/ 多/ 变量/ 公钥/ 密码/ 方案/ (/ ExtendedMultivariatepublickeyCryptosystems/ ,/ EMC/ )/ [/ 13/ ]/ 是/ Wang/ 等/ 人/ 2011/ 年/ 提出/ 的/ 一种/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 安全性/ 增强/ 方案/ ,/ 其/ 核心/ 是/ 在/ 加密/ 之前/ 先对/ 明文/ 分量/ 进行/ 一次/ HT/ 变换处理/ ,/ 然后/ 再用/ 原始/ 的/ 多/ 变量/ 密码/ 方案/ 进行/ 加密/ ,/ 其/ 目的/ 是/ 消除/ 原有/ 体制/ 的/ 安全性/ 弱点/ ,/ 如/ 线性化/ 方程/ 等/ ./ EMC/ 的/ 提出/ 者/ 根据/ 这种/ 方法/ ,/ 构造/ 出/ 了/ HTTP/ 加密/ 方案/ ,/ 并/ 声称/ 可以/ 抵抗/ 现有/ 的/ 攻击/ ,/ 但是/ 通过/ 分析/ 可知/ ,/ EMC/ 方法/ 并/ 没有/ 真正/ 增强/ 原始/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 安全性/ ./ 本文/ 对/ EMC/ 加密/ 方案/ 进行/ 了/ 分析/ ,/ 分析/ 发现/ 如果/ 存在/ 一个/ 算法/ 能/ 找到/ 原始/ 体制/ 的/ 合法/ 密文/ 相应/ 的/ 明文/ ,/ 那么/ 对于/ EMC/ 方案/ ,/ 同样/ 可以/ 找到/ 合法/ 密文/ 相应/ 的/ 明文/ ./ 随后/ ,/ 本文/ 对以/ MI/ 体制/ 作为/ 原始/ 体制/ 的/ HTTP/ 方案/ 进行/ 了/ 分析/ ./ 分析/ 结果表明/ ,/ HTTP/ 体制/ 并/ 没有/ 消除/ 原/ MI/ 体制/ 中/ 存在/ 的/ 线性化/ 方程/ ,/ 因此/ ,/ 可/ 结合/ 线性化/ 方程/ 攻击/ ,/ 成功/ 地/ 恢复/ 合法/ 密文/ 相应/ 的/ 明文/ ./ 本文/ 第/ 2/ 节/ 简单/ 介绍/ EMC/ 方案/ 以及/ HTTP/ 体制/ 构造/ 的/ 思想/ ;/ 第/ 3/ 节/ 给出/ EMC/ 加密/ 方案/ 的/ 安全性/ 分析/ ;/ 在/ 第/ 4/ 节/ 给出/ HTTP/ 体制/ 的/ 分析/ ;/ 最后/ 给出/ 本文/ 的/ 结论/ ./ 2/ 扩展/ 的/ 多/ 变量/ 公钥/ 密码/ 方案/ (/ EMC/ )/ 多/ 变量/ 公钥/ 密码/ (/ MultivariatePublicKey/ 令/ Fq/ 是/ 一个/ q/ 元/ 有限/ 域/ ,/ n/ 和/ m/ 是/ 正整数/ ,/ TCryptosystem/ ,/ MPKC/ )/ 的/ 一般/ 形式/ 如下/ :/ 和/ U/ 分别/ 是/ Fn/ 换/ ./ 取/ 映射/ F/ 为/ 一个/ 从/ Fn/ 性/ 映射/ ./ 令/ Y/ =/ (/ y1/ ,/ …/ ,/ ym/ )/ =/ P/ (/ x1/ ,/ …/ ,/ xn/ )/ =/ T/ / F/ / U/ (/ x1/ ,/ …/ ,/ xn/ )/ ,/ 其中/ P/ 是/ 一个/ 从/ Fn/ 成/ 有限/ 域/ Fq/ 上/ m/ 个/ n/ 元/ 多项式/ ,/ 其/ 最高/ 次数/ 等于/ F/ 的/ 次数/ ./ 在/ 多/ 变量/ 公钥/ 密码/ 系统/ 中/ ,/ P/ 的/ 表达式/ 为/ 公钥/ ,/ 它/ 是/ 一组/ 多/ 变量/ 多项式/ ,/ 而/ 私钥/ 为/ T/ 和/ U/ ./ 多/ 变量/ 公钥/ 密码/ 设计/ 的/ 关键在于/ 构造/ 中心/ 映射/ F/ ./ F/ 的/ 表达式/ 可以/ 公开/ ,/ 也/ 可以/ 保密/ ./ 为了/ 节省/ 公钥/ 多项式/ 的/ 存储/ ,/ 中心/ 映射/ 和/ 公钥/ 多项式/ 通常/ 选取/ 为/ 最/ 简单/ 的/ 非线性/ 函数/ 即/ 二次/ 函数/ ./ 2.1/ EMC/ 的/ 主要/ 思想/ 在/ EMC/ 方案/ ,/ m/ =/ n/ ./ EMC/ 方案/ 的/ 核心思想/ 是/ 引入/ 了/ 一个/ 基于/ Hash/ 函数/ 的/ 变换/ ,/ 称作/ HT/ 变换/ ./ 该/ 变换/ 将/ n/ 个/ 明文/ 变量/ 扩充/ 为/ n/ +/ δ/ 个/ 变量/ ,/ 以/ 期望/ 能/ 消除/ 原/ 体制/ 的/ 弱点/ ,/ 增加/ 原/ 体制/ 的/ 安全性/ ./ Fq/ 上/ 的/ n/ +/ δ/ 维和/ n/ 维/ 向量/ 空间/ ./ HT/ 变换/ 描述/ 如下/ :/ 设/ Fn/ +/ δ/ ①/ NESSIE/ ./ EuropeanprojectIST/ -/ 1999/ -/ 12324onNewEuro/ -/ Page3/ 定义/ L/ :/ Fn/ +/ δ/ h1/ 烄/ 烌/ 烄/ / hn/ -/ 烆/ 烎/ δ/ 烅/ hn/ -/ δ/ +/ 1/ 烄/ / h/ 烎/ n/ 烆/ 烆/ 其中/ ,/ δ/ 表示/ 扩展/ 变量/ 的/ 个数/ ,/ α/ 1/ 是/ n/ -/ δ/ 维/ 的/ 向量/ ,/ α/ 2/ 是/ δ/ 维/ 的/ 向量/ ,/ 犃/ 是/ (/ n/ -/ δ/ )/ ×/ (/ n/ -/ δ/ )/ 的/ 可逆/ 矩阵/ ,/ 犇/ 是/ δ/ ×/ δ/ 的/ 对角/ 可逆/ 矩阵/ ,/ 犅/ 是/ 任意/ 的/ δ/ ×/ (/ n/ -/ δ/ )/ 的/ 矩阵/ ,/ xn/ +/ i/ (/ 1/ / i/ / δ/ )/ 为/ 扩展/ 变量/ ,/ 其/ 定义/ 为/ 其中/ H/ 为/ 安全/ Hash/ 函数/ ,/ Hk/ 表示/ 提取/ 函数/ 值中/ 的/ 前/ k/ 个/ 位值/ ./ 容易/ 看出/ ,/ 这里/ L/ 是/ 容易/ 求逆/ 的/ ./ 利用/ 上面/ 的/ HT/ 变换/ ,/ 就/ 可以/ 构造/ 出/ EMC/ 方案/ ,/ 其公钥/ 表示/ 为/ 珚/ P/ =/ (/ p/ -/ EMC/ 方案/ 的/ 公钥/ 为/ 珚/ P/ 中/ 包含/ 的/ n/ 个/ 二次方程/ p/ -/ i/ =/ 1/ ,/ …/ ,/ n/ ,/ 私钥/ 为/ L/ -/ 1/ ,/ U/ -/ 1/ ,/ T/ -/ 1/ ,/ F/ -/ 1.2/ ./ 2HTTP/ 多/ 变量/ 加密/ 方案/ HTTP/ 加密/ 方案/ 就是/ 把/ 上述/ 的/ EMC/ 方案/ 和/ “/ +/ ”/ 方法/ 结合/ 产生/ 的/ 新/ 的/ 加密/ 方案/ ./ 将/ “/ +/ ”/ 方法/ 用到/ EMC/ 方案/ 中/ ,/ 就是/ 随机/ 地/ 确定/ μ/ (/ 0/ / μ/ </ n/ )/ 个/ 二次/ 多项式/ 加入/ 到/ EMC/ 的/ 中心/ 映射/ 之中/ ./ 记/ 添加/ μ/ 个/ 二次/ 多项式/ 之后/ 得到/ 这样/ ,/ 就/ 得到/ 了/ HTTP/ 多/ 变量/ 加密/ 方案/ 珚/ P/ +/ (/ x1/ ,/ …/ ,/ xn/ +/ δ/ )/ =/ T/ +/ / 珚/ F/ +/ =/ (/ p/ -/ +/ 此时/ ,/ 该/ 方案/ 中/ T/ +/ 为/ (/ n/ +/ μ/ )/ ×/ (/ n/ +/ μ/ )/ 的/ 可逆/ 仿射变换/ ./ 公钥/ :/ 珚/ P/ +/ 对应/ 的/ n/ +/ μ/ 个/ 二次/ 多项式/ ;/ 私钥/ :/ L/ -/ 1/ ,/ U/ -/ 1/ ,/ T/ -/ 1/ +/ 和/ F/ -/ 1/ ./ (/ 1/ )/ 加密/ 给定/ 任一/ 明文/ 狓/ =/ (/ x1/ ,/ …/ ,/ xn/ )/ ∈/ Fnxn/ +/ i/ =/ Hk/ (/ x1/ ‖/ x2/ ‖/ …/ ‖/ xn/ -/ δ/ +/ i/ -/ 1/ )/ ,/ 1/ / i/ / δ/ ./ 然后/ 计算/ 这样/ 就/ 得到/ 了/ 一个/ 合法/ 密文/ ./ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ +/ μ/ )/ =/ 珚/ P/ +/ (/ x1/ ,/ …/ ,/ xn/ +/ δ/ )/ ./ (/ 2/ )/ 解密/ 给定/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ +/ μ/ )/ ,/ 需要/ 依照/ 下面/ 步骤/ 进行/ 解密/ :/ 删掉/ 最后/ μ/ 个/ 变量/ ,/ 得到/ (/ t1/ ,/ …/ ,/ tn/ )/ ;/ ①/ 计算/ (/ v1/ ,/ …/ ,/ vn/ +/ μ/ )/ =/ T/ -/ 1/ ②/ 计算/ (/ z1/ ,/ …/ ,/ zn/ )/ =/ 珚/ F/ -/ 1/ (/ v1/ ,/ …/ ,/ vn/ )/ ;/ ③/ 计算/ (/ h1/ ,/ …/ ,/ hn/ )/ =/ U/ -/ 1/ (/ z1/ ,/ …/ ,/ zn/ )/ ;/ ④/ 计算/ (/ x1/ ,/ …/ ,/ xn/ )/ =/ L/ -/ 1/ (/ h1/ ,/ …/ ,/ hn/ )/ ./ 这样/ 就/ 得到/ 了/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ +/ μ/ )/ 相应/ 的/ 明文/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 3EMC/ 密码/ 体制/ 的/ 安全性/ 分析/ 本节/ 以/ EMC/ 加密/ 体制/ 为例/ 进行/ 分析/ ./ 如果/ 对于/ 原始/ 的/ 加密/ 体制/ 来说/ ,/ 存在/ 某个/ 算法/ A/ ,/ 使得/ 对于/ 给定/ 的/ 公钥/ ,/ 在/ 不/ 知道/ 私钥/ 的/ 情形/ 下/ 可以/ 求得/ 合法/ 密文/ 相应/ 的/ 明文/ ,/ 那么/ 对/ 原始/ 方案/ 采用/ EMC/ 的/ 方法/ 进行/ 改进/ 后/ 的/ 体制/ ,/ 同样/ 可以/ 在/ 不/ 知道/ 私钥/ 的/ 情形/ 下/ 求得/ 合法/ 密文/ 相应/ 的/ 明文/ ./ EMC/ 多/ 变量/ 方案/ 中/ 的/ HT/ 变换/ L/ 实际上/ 是/ 一个/ 仿射变换/ ,/ 用/ 矩阵/ 表示/ 之后/ 其/ 形式/ 如下/ :/ 这里/ ,/ 犐/ 为/ δ/ ×/ δ/ 单位矩阵/ ,/ 犗/ 为/ 零/ 矩阵/ ./ 虽然/ L/ 中/ 的/ 犃/ 犗/ 犗/ (/ )/ 犅犐犇/ 不是/ 方阵/ ,/ 但是/ 由于/ 其/ 特殊/ 设计/ 以及/ 扩展/ 变量/ xn/ +/ 1/ ,/ …/ ,/ xn/ +/ δ/ 与/ 明文/ 变量/ x1/ ,/ …/ ,/ xn/ 之间/ 的/ Hash/ 关系/ ,/ 使得/ L/ 容易/ 求逆/ ,/ 只不过/ L/ 的/ 逆映射/ 并/ 不是/ 仿射变换/ ,/ 需要/ 通过/ 迭代/ 来/ 实现/ ./ 在/ EMC/ 方案/ 中公钥/ 为/ 虽然/ 珚/ P/ 的/ 输入/ 为/ (/ x1/ ,/ …/ ,/ xn/ +/ δ/ )/ ,/ 但是/ EMC/ 方案/ 中/ 加密/ 之后/ 得到/ 的/ 密文/ 是/ 由/ x1/ ,/ …/ ,/ xn/ 唯一/ 确定/ 的/ ./ 命题/ 1/ ./ 在/ EMC/ 的/ 公钥/ 表达式/ 中/ ,/ 令/ 所有/ 的/ 包含/ xn/ +/ 1/ ,/ …/ ,/ xn/ +/ δ/ 的/ 项为/ 0/ ,/ 那么/ 所/ 得到/ 的/ 多项式/ 组/ 恰好/ 是/ 在/ 公钥/ 生成/ 过程/ 中令/ 矩阵/ 犇/ 为/ 零/ 矩阵/ 所/ 生成/ 的/ 多项式/ 组/ ./ 这一/ 命题/ 我们/ 通过/ 计算机/ 实验/ 得到/ 了/ 验证/ ./ 设/ L/ 为/ 当/ L/ 中/ 的/ 矩阵/ 犇/ 为/ 零/ 矩阵/ 时/ 的/ 映射/ ,/ 即/ L/ =/ Page4L/ 对应/ 的/ 矩阵/ 变换/ 为/ 由于/ 犃/ 为/ 可逆/ 矩阵/ ,/ 所以/ L/ 为/ 可逆/ 仿射变换/ ./ 用/ L/ 代替/ EMC/ 中/ 的/ L/ ,/ 可/ 得到/ 另外/ 一个/ 加密/ 方案/ ,/ 其公钥/ 为/ 与/ 珚/ P/ 不同/ 的/ 是/ ,/ 珚/ PL/ 的/ 表达式/ 中/ 没有/ 包含/ xn/ +/ 1/ ,/ …/ ,/ xn/ +/ δ/ 的/ 项/ ,/ 并且/ 在/ 取/ 相同/ 参数/ 的/ 情况/ 下/ ,/ 把/ 珚/ P/ 公钥/ 表达式/ 中/ 的/ 包含/ xn/ +/ 1/ ,/ …/ ,/ xn/ +/ δ/ 的/ 项/ 都/ 设为/ 0/ ,/ 就/ 可/ 得到/ 珚/ PL/ 的/ 公钥/ 表达式/ ./ 由于/ U/ 、/ L/ 都/ 是/ 可逆/ 的/ 仿射变换/ ,/ 故/ U/ / L/ 也/ 是/ 可逆/ 仿射变换/ ,/ 所以/ 珚/ PL/ 等价/ 于用/ U/ / L/ 替换/ 原始/ 的/ 公钥/ 密码/ 体制/ 中/ 的/ U/ ./ 因此/ ,/ 利用/ 算法/ A/ ,/ 同样/ 可/ 在/ 不/ 知道/ 私钥/ 的/ 情况/ 下/ 对/ 珚/ PL/ 求逆/ ./ 给定/ 合法/ 密文/ ,/ 考虑/ 这个/ 密文/ 分别/ 在/ 两个/ 映射/ 珚/ P/ 和/ 珚/ PL/ 下/ 相应/ 的/ 明文/ 之间/ 的/ 关系/ ./ 给定/ 密文/ (/ y1/ ,/ …/ ,/ yn/ )/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ ,/ 分别/ 用/ 珚/ P/ 和/ 珚/ PL/ 相对/ 应/ 的/ 私钥/ 来/ 进行/ 解密/ ,/ 其/ 惟一/ 的/ 区别/ 在于/ L/ 和/ L/ 不同/ ,/ 因此/ 需要/ 分析/ 对于/ 相同/ 的/ 向量/ ,/ 分别/ 利用/ L/ 和/ L/ 对/ 其求/ 出/ 的/ 逆元/ 之间/ 的/ 关系/ ./ 命题/ 2/ ./ L/ 和/ L/ 的/ 如/ 前述/ 所示/ ,/ 设/ 给定/ (/ h1/ ,/ …/ ,/ hn/ )/ =/ (/ h1/ ,/ …/ ,/ hn/ )/ ,/ 分别/ 利用/ L/ 和/ L/ 求逆/ 得到/ 的/ 原像/ 为/ (/ x1/ ,/ …/ ,/ xn/ +/ δ/ )/ 和/ (/ x1/ ,/ …/ ,/ xn/ )/ ,/ 则/ 这/ 两组/ 原像/ 存在/ 以下/ 关系/ :/ (/ 1/ )/ xi/ =/ xi/ ,/ i/ =/ 1/ ,/ …/ ,/ n/ -/ δ/ ;/ (/ 2/ )/ xn/ -/ δ/ +/ i/ =/ xn/ -/ δ/ +/ i/ -/ D/ [/ i/ ]/ [/ i/ ]/ xn/ +/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ δ/ ,/ 其中/ D/ [/ i/ ]/ [/ i/ ]/ 表示/ 对角/ 矩阵/ 犇/ 的/ 对角线/ 上/ 第/ i/ 个/ 元素/ ./ 证明/ ./ 通过/ L/ 和/ L/ 的/ 表达式/ 很/ 容易/ 得到/ 命题/ 中/ 的/ 结论/ ./ 结合/ 珚/ P/ 和/ 珚/ PL/ 表达式/ ,/ 根据/ 命题/ 2/ 的/ 结论/ ,/ 可以/ 得出/ 珚/ P/ 生成/ 过程/ 中/ 所/ 使用/ 的/ 矩阵/ 犇/ ./ 任意/ 选择/ 一个/ 明文/ 狓/ =/ (/ 珟/ x1/ ,/ …/ ,/ 珟/ xn/ )/ ,/ 计算/ 其/ 在/ 映射/ 珚/ P/ 下/ 对应/ 的/ 密文/ 狔/ =/ (/ 珘/ y1/ ,/ …/ ,/ 珘/ yn/ )/ ./ 然后/ 利用/ 算法/ A/ 求出/ 狔/ =/ (/ 珘/ y1/ ,/ …/ ,/ 珘/ yn/ )/ 在/ 珚/ PL/ 映射/ 下/ 对应/ 的/ 明文/ (/ x/ ≈/ 1/ ,/ …/ ,/ x/ ≈/ D/ [/ i/ ]/ [/ i/ ]/ =/ (/ 珟/ xn/ -/ δ/ +/ i/ -/ x/ ≈/ n/ -/ δ/ +/ i/ )/ 珟/ x/ -/ 1n/ +/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ δ/ ./ 这样/ 就/ 恢复/ 了/ 对角/ 矩阵/ 犇/ ./ 在/ 得到/ 珚/ PL/ 的/ 表达式/ 和/ 对角/ 矩阵/ 犇/ 后/ ,/ 可/ 通过/ 以下/ 步骤/ 恢复/ 合法/ 密文/ 相应/ 的/ 明文/ ,/ 具体/ 如下/ 所示/ :/ 给定/ EMC/ 的/ 一个/ 合法/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ ,/ 求其/ 相应/ 的/ 明文/ 狓/ =/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 映射/ 下/ 对应/ 的/ 明文/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 根据/ 命题/ 2/ 有/ 其次/ ,/ 计算/ xn/ +/ i/ =/ Hk/ (/ x1/ ‖/ x2/ ‖/ …/ ‖/ xn/ -/ δ/ +/ i/ -/ 1/ )/ ,/ 1/ / i/ / δ/ ./ 最后/ ,/ 计算/ xn/ -/ δ/ +/ i/ =/ xn/ -/ δ/ +/ i/ -/ D/ [/ i/ ]/ [/ i/ ]/ xn/ +/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ δ/ ./ 这样/ ,/ 就/ 恢复/ 了/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ 对应/ 的/ 明文/ 狓/ =/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 4HTTP/ 加密/ 方案/ 的/ 分析/ HTTP/ 加密/ 方案/ 是/ 对/ EMC/ 方案/ 进行/ 了/ “/ 加/ ”/ 方法/ 的/ 处理/ ,/ 但是/ 如果/ 原/ 体制/ 存在/ 线性化/ 方程/ ,/ “/ 加/ ”/ 方法/ 并/ 不能/ 消除/ 这些/ 线性化/ 方程/ ,/ 也就是说/ 如果/ EMC/ 中/ 存在/ 线性化/ 方程/ ,/ 那么/ 应用/ “/ 加/ ”/ 方法/ 处理/ 之后/ ,/ HTTP/ 中/ 的/ 线性化/ 方程/ 依然/ 存在/ ,/ 并且/ 线性化/ 方程/ 的/ 个数/ 保持/ 不变/ [/ 14/ ]/ ./ 本节/ 以/ 文献/ [/ 13/ ]/ 给出/ 的/ HTTPv1/ 为例/ ,/ 进行/ 相应/ 的/ 破解/ 和/ 计算机/ 实验/ 验证/ ./ HTTPv1/ 的/ 参数/ 如下/ ,/ 设/ K/ =/ Fq/ 是/ 一个/ q/ 元/ 有限/ 域/ ,/ q/ 是/ 某个/ 素数/ 的/ 方幂/ ,/ E/ 为/ K/ 的/ n/ 次/ 扩域/ ,/ 取/ n/ =/ 20/ ,/ q/ =/ 28/ ,/ θ/ =/ 4/ ,/ δ/ =/ 17/ ,/ μ/ =/ 6/ ,/ 其/ 原始/ 中心/ 映射/ 为/ MI/ 体制/ 的/ 中心/ 映射/ ,/ 即/ 其中/ V/ ,/ Z/ 为/ E/ 中/ 的/ 元素/ ./ 定义/ π/ :/ E/ →/ Kn/ 为/ K/ -/ 线性/ 同构/ ,/ 即取/ E/ 在/ K/ 的/ 上/ 的/ 一组/ 基/ {/ γ/ 1/ ,/ …/ ,/ γ/ n/ }/ ,/ 定义/ :/ π/ (/ a1/ γ/ 1/ +/ …/ +/ an/ γ/ n/ )/ =/ (/ a1/ ,/ …/ ,/ an/ )/ ,/ a1/ ,/ …/ ,/ an/ ∈/ K/ ./ 因此/ ,/ HTTPv1/ 的/ 加密/ 函数/ 定义/ 为/ 珚/ P/ +/ (/ x1/ ,/ …/ ,/ xn/ +/ δ/ )/ =/ T/ +/ / 珚/ F/ +/ (/ x1/ ,/ …/ ,/ xn/ )/ ,/ 其中/ 珚/ F/ =/ π/ / F/ / π/ -/ 1/ / U/ / L/ =/ (/ 珚/ f1/ ,/ …/ ,/ 珚/ fn/ )/ ,/ 珚/ F/ +/ =/ (/ 珚/ f1/ ,/ …/ ,/ 珚/ fn/ ,/ 珚/ fn/ +/ 1/ ,/ …/ ,/ 珚/ fn/ +/ μ/ )/ 为/ 珚/ F/ 添加/ μ/ 个/ 二次/ 多项式/ 之后/ 所得/ ./ MI/ 体制/ 在/ 1995/ 年/ 被/ Patarin/ 用/ 线性化/ 方程/ 破解/ [/ 15/ ]/ ,/ 给定/ 合法/ 密文/ 可/ 找到/ 其/ 相应/ 的/ 明文/ ./ MI/ +/ 体制/ 仍然/ 满足/ 线性化/ 方程/ ,/ 其/ 破解/ 复杂度/ 比/ 破解/ 原始/ 的/ MI/ 体制/ 稍/ 高/ 一些/ ./ 利用/ 线性化/ 方程/ 攻击/ 方法/ 破解/ MI/ 体制/ 的/ 复杂度/ 是/ (/ n/ +/ 1/ )/ 6/ ,/ 破解/ MI/ +/ 体制/ 的/ 复杂度/ 是/ (/ n/ +/ 1/ )/ 3/ (/ n/ +/ 1/ +/ μ/ )/ 3/ ,/ 其中/ n/ 是/ 明文/ 变量/ 个数/ ,/ μ/ 是/ 加/ 方法/ 中/ 随机/ 添加/ 的/ 多项式/ 的/ 个数/ ./ 当/ n/ =/ 20/ ,/ μ/ =/ 6/ 时/ ,/ 两者/ 的/ 破解/ 复杂度/ 分别/ 约等于/ 227/ 和/ 228/ ./ HTTPv1/ 体制/ 实际上/ 是/ 对/ MI/ +/ 体制/ 应用/ EMC/ 方法/ 得到/ 的/ ./ 它/ 同样/ 满足/ 第/ 3/ 节中/ 的/ 命题/ 1/ ./ 因此/ 可用/ 第/ 3/ 节/ 的/ 方法/ 来/ 进行/ 破解/ ./ 我们/ 采用/ 计算机/ 实验/ 来/ 进行/ 实际/ 的/ 破解/ 工作/ ./ Page5/ 可以/ 恢复/ 其/ 对应/ 的/ 明文/ ./ 实验/ 中/ 使用/ 的/ 是/ 普通/ PC机/ ,/ 工具/ 为/ Magma/ ./ 具体步骤/ 和/ 实验/ 结果/ 如下/ ./ 给定/ 合法/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ ,/ 按照/ 如下/ 步骤/ (/ 1/ )/ 获得/ 珚/ PL/ ./ 将/ HTTPv1/ 的/ 公/ 钥/ 珚/ P/ +/ 中/ 的/ 包含/ xn/ +/ 1/ ,/ …/ ,/ xn/ +/ δ/ (/ 2/ )/ 获取/ 珚/ PL/ 满足/ 的/ 线性化/ 方程/ ./ 珚/ PL/ 实际上/ 等价/ 于/ 一个/ MI/ +/ 体制/ ,/ 它/ 满足/ 下列/ 线性化/ 方程/ :/ ∑/ 20i/ =/ 1/ ∑/ 26/ 的/ 项/ 设置/ 为/ 0/ ,/ 得到/ 了/ 珚/ PL/ ./ 要/ 找到/ 所有/ 的/ 一阶/ 线性化/ 方程/ 等价/ 于/ 找到/ 所有/ 的/ 未知/ 向量/ (/ a1/ ,/ 1/ ,/ …/ ,/ a20/ ,/ 26/ ,/ b1/ ,/ …/ ,/ b20/ ,/ c1/ ,/ …/ ,/ c26/ ,/ d/ )/ 张成/ 的/ K/ -/ 线性/ 空间/ 的/ 一组/ 基/ ./ 令/ W/ 为/ 该/ 线性/ 空间/ 的/ 维数/ ./ 方程/ (/ 3/ )/ 中/ 的/ 未知/ 系数/ 的/ 个数/ 为/ 20/ ×/ 26/ +/ 20/ +/ 26/ +/ 1/ =/ 567/ ./ 因此/ 我们/ 选取/ 600/ 个/ 明文/ (/ x1/ ,/ …/ ,/ x20/ )/ ,/ 将/ 它们/ 代入/ 珚/ PL/ 中/ 获得/ 以/ 珚/ PL/ 为/ 加密/ 函数/ 的/ 密文/ ,/ 将/ 600/ 个/ 明文/ -/ 密文/ 对/ 代入/ 方程/ (/ 3/ )/ 可/ 得到/ 以/ 未知/ 系数/ 为/ 未知数/ 的/ 线性方程组/ ./ 解/ 这个/ 方程组/ ,/ 我们/ 就/ 可/ 得到/ W/ 个/ 线性/ 无关/ 的/ 向量/ ,/ 记/ 为/ {/ (/ a/ (/ k/ )/ j/ ,/ d/ (/ k/ )/ )/ ,/ 1/ / k/ / W/ }/ ,/ 也/ 就是/ 得到/ 了/ W/ 个/ 线性/ 无关/ c/ (/ k/ )/ 的/ 一阶/ 线性化/ 方程/ ./ 对于/ HTTPv1/ 体制/ ,/ 实验/ 结果表明/ W/ =/ 20/ ./ (/ 3/ )/ 恢复/ 对角/ 矩阵/ 犇/ ./ 任意/ 选择/ 一个/ 明文/ 狓/ =/ (/ 珟/ x1/ ,/ …/ ,/ 珟/ xn/ )/ ,/ 计算/ 其/ 在/ 映射/ 珚/ P/ 下/ 对应/ 的/ 密文/ 狔/ =/ (/ 珘/ y1/ ,/ …/ ,/ 珘/ yn/ )/ ./ 然后/ 结合/ 步/ (/ 2/ )/ 中/ 得到/ 的/ 线性化/ 方程/ ,/ 利用/ 线性化/ 方程/ 攻击/ 方法/ (/ 具体/ 攻击/ 方法/ 可/ 参见/ 文献/ [/ 16/ ]/ )/ 求出/ 狔/ =/ (/ 珘/ y1/ ,/ …/ ,/ 珘/ yn/ )/ 在/ 珚/ PL/ 映射/ 下/ 对应/ 的/ 明文/ (/ x/ ≈/ 最后/ ,/ 依次/ 计算/ D/ [/ i/ ]/ [/ i/ ]/ =/ (/ 珟/ xn/ -/ δ/ +/ i/ -/ x/ ≈/ n/ -/ δ/ +/ i/ )/ 珟/ x/ -/ 1n/ +/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ δ/ ./ (/ 4/ )/ 恢复/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ 的/ 明文/ 信息/ ./ 利用/ 线性化/ 方程/ 攻击/ 方法/ 求出/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ 在/ 珚/ PL/ 映射/ 下/ 对应/ 的/ 明文/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 根据/ 命题/ 2/ 有/ 其次/ ,/ 计算/ xn/ +/ i/ =/ Hk/ (/ x1/ ‖/ x2/ ‖/ …/ ‖/ xn/ -/ δ/ +/ i/ -/ 1/ )/ ,/ 1/ / i/ / δ/ ./ 最后/ ,/ 计算/ xn/ -/ δ/ +/ i/ =/ xn/ -/ δ/ +/ i/ -/ D/ [/ i/ ]/ [/ i/ ]/ xn/ +/ i/ ,/ i/ =/ 1/ ,/ …/ ,/ δ/ ./ 这样/ ,/ 就/ 恢复/ 了/ 密文/ 狔/ =/ (/ y1/ ,/ …/ ,/ yn/ )/ 对应/ 的/ 明文/ 狓/ =/ (/ x1/ ,/ …/ ,/ xn/ )/ ./ 实验/ 结果表明/ ,/ 上述/ 方法/ 成功/ 地/ 找到/ 了/ 合法/ 密文/ 相应/ 的/ 明文/ ./ 以上/ 计算机/ 实验/ 均/ 在/ 普通/ PC机/ 上/ 利用/ Magma/ 软件/ 进行/ 实现/ ,/ PC机/ 配置/ 为/ GenuineIntel/ (/ R/ )/ CPUT2300/ @/ 1.66/ GHz/ ,/ 504MBRAM/ ./ 5/ 结语/ EMC/ 方案/ 尝试/ 利用/ 现有/ 变量/ 引入/ 新/ 的/ 变量/ 来/ 增强/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 安全性/ ./ 通过/ 本文/ 的/ 分析/ ,/ 可/ 发现/ 该/ 改进/ 方案/ 并/ 没有/ 实际/ 增强/ 原有/ 多/ 变量/ 公钥/ 密码/ 体制/ 的/ 安全性/ ./ 本文/ 给出/ 了/ EMC/ 加密/ 方案/ 的/ 安全性/ 分析/ ,/ 并/ 利用计算机/ 实验/ 进行/ 了/ 验证/ ,/ 但是/ 未/ 对/ 这种/ 扩展/ 方案/ 进行/ 改进/ ,/ 同时/ 也/ 未/ 对/ 文献/ [/ 13/ ]/ 中/ 提出/ 的/ HTTM/ 数字签名/ 体制/ 进行/ 分析/ ,/ 这是/ 我们/ 未来/ 需要/ 做/ 的/ 工作/ ./ 

