Page1RM/ 树/ :/ 一种/ 支持/ 字符串/ 相似性/ 操作/ 的/ 索引/ 王金宝/ 1/ )/ 高宏/ 1/ )/ 李建中/ 1/ )/ 杨/ 东华/ 2/ )/ 1/ )/ (/ 哈尔滨工业大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 2/ )/ (/ 哈尔滨工业大学/ 基础/ 与/ 交叉科学/ 研究院/ 高性能/ 计算中心/ 哈尔滨/ 150001/ )/ 摘要/ 字符串/ 相似性/ 操作/ 在/ 很多/ 领域/ 中/ 被/ 广泛应用/ ,/ 如/ 数据/ 清洁/ 、/ 信息/ 集成/ 等/ ./ 现有/ 研究/ 工作/ 主要/ 为/ 基于/ q/ -/ Gram/ 和/ 倒排/ 索引/ 的/ 内存/ 方法/ ,/ 在/ 处理/ 大量/ 数据/ 时/ 具有/ 以下/ 缺点/ :/ 内存/ 消耗/ 大/ 、/ 更新/ 效率/ 低/ 、/ 支持/ 操作/ 类型/ 有限/ ./ 现有/ 的/ 外存/ 索引/ Bed/ 树/ 无法/ 将/ 相似/ 的/ 字符串/ 聚类/ ,/ 在/ 查询处理/ 过程/ 中/ 导致/ 了/ 较大/ 的/ I/ // O/ 代价/ ./ 该文/ 设计/ 了/ 支持/ 多种/ 字符串/ 相似性/ 操作/ 的/ RM/ 树/ 索引/ ,/ 消除/ 了/ 现有/ 内存/ 方法/ 的/ 缺点/ ,/ 并/ 通过/ 字符串/ 聚类/ 的/ 方法/ 提高/ 了/ 相似性/ 操作/ 的/ 效率/ ./ 该文/ 通过/ 大量/ 实验/ 结果/ 证明/ 了/ RM/ 树/ 的/ 有效性/ ./ 关键词/ 字符串/ ;/ 相似性/ ;/ 索引/ ;/ 查询处理/ ;/ 连接/ 处理/ 1/ 引言/ 字符串/ 相似性/ 操作/ 包括/ 相似性/ 查询/ 操作/ 和/ 相似性/ 连接/ 操作/ ./ 这些/ 操作/ 被/ 广泛应用/ 于/ 众多/ 领域/ ,/ 如/ 数据/ 清洁/ 、/ 信息/ 集成/ 、/ 拼写/ 校验/ 以及/ 生物/ 信息处理/ 等/ ./ 当前/ ,/ 随着/ 信息/ 生成/ 速度/ 的/ 增加/ 和/ 信息/ 存储/ 能力/ 的/ 增长/ ,/ 大规模/ 数据/ 集合/ 日益/ 普遍/ ./ 字符串/ 数据/ 是/ 其中/ 的/ 重要/ 组成/ 元素/ ./ Google/ 拥有/ 的/ N/ -/ Gram/ 数据/ 集合/ 包含/ 1T/ 条/ 元组/ ;/ 在/ 生物/ 信息/ 方面/ ,/ GeneBank/ 数据/ 集合/ 大小/ 达到/ 416GB/ ,/ 包含/ 超过/ 100/ 万条/ 记录/ ./ 在/ 如此/ 庞大/ 的/ 字符串/ 数据/ 集合/ 中/ ,/ 定位/ 相似性/ 操作/ 涉及/ 的/ 数据/ 是/ 一项/ 具有/ 挑战性/ 的/ 任务/ ./ 当前/ ,/ 针对/ 字符串/ 相似性/ 操作/ 的/ 研究/ 工作/ 主要/ 集中/ 在/ 两个/ 方面/ :/ 字符串/ 相似性/ 查询/ 和/ 字符串/ 相似性/ 连接/ ./ 大部分/ 研究/ 工作/ 基于/ q/ -/ Gram/ 以及/ 倒排/ 索引/ ./ 这些/ 方法/ 在/ 处理/ 大规模/ 字符串/ 数据/ 集合/ 时有/ 以下/ 劣势/ :/ (/ 1/ )/ 内存/ 消耗/ 过大/ ./ 现有/ 的/ 基于/ q/ -/ Gram/ 和/ 倒排/ 索引/ 的/ 方法/ 都/ 针对/ 内存/ 设计/ ,/ 没有/ 给出/ 有效/ 的/ 外存/ 算法/ ./ (/ 2/ )/ 存储/ 代价/ 过大/ ./ 即使/ 将/ q/ -/ Gram/ 以及/ 倒排/ 索引/ 存储/ 在/ 磁盘/ 上/ ,/ 其/ 存储/ 代价/ 将/ 与/ 原有/ 数据/ 大小/ 不相上下/ ,/ 甚至/ 超过/ 原始数据/ ./ (/ 3/ )/ 更新/ 代价/ 大/ ./ 对/ 原始数据/ 的/ 每/ 一次/ 更新/ ,/ 都/ 需要/ 修改/ 若干/ Gram/ 对应/ 的/ 倒排/ 链表/ ./ 在/ 实际/ 应用/ 中/ ,/ 倒排/ 链表/ 的/ 长度/ 与/ 数据/ 集合/ 的/ 大小/ 成正比/ ,/ 因此/ 更新/ 若干/ 倒排/ 链表/ 的/ 代价/ 不容忽视/ ./ (/ 4/ )/ 支持/ 查询/ 的/ 类型/ 有限/ ./ 只能/ 支持/ 范围/ 查询/ 以及/ 连接/ 操作/ ,/ 其它/ 复杂/ 查询/ 如/ top/ -/ k/ 查询/ 等/ 则/ 无法/ 直接/ 支持/ ./ Bed/ 树是/ 一种/ 树形/ 索引/ 结构/ ,/ 用于/ 支持/ 字符串/ 相似性/ 操作/ ,/ 这/ 也/ 是/ 与/ 本文/ 工作/ 最为/ 相关/ 的/ 工作/ ./ Bed/ 树为/ 字符串/ 数据/ 设定/ 一维/ 的/ 顺序/ ,/ 将/ 数据/ 排序/ 并/ 按照/ 该/ 顺序/ 建立/ B/ +/ 树/ 索引/ 存储/ 数据/ ./ Bed/ 树中/ 使用/ 3/ 种/ 字符串/ 排序/ ,/ 分别/ 为/ Dic/ -/ tionaryOrder/ 、/ GramCountingOrder/ 和/ GramLo/ -/ cationOrder/ ./ 在/ 查询/ 过程/ 中/ ,/ 不同/ 的/ 字符串/ 排序/ 方法/ 分别/ 结合/ 了/ 不同/ 的/ 过滤器/ 用以/ 选择/ 包含/ 查询/ 结果/ 的/ 子树/ ./ 然而/ ,/ 使用/ 一维/ 顺序排列/ 字符串/ 无法/ 有效/ 地/ 将/ 相似/ 的/ 字符串/ 聚类/ ,/ 降低/ 了/ 过滤器/ 的/ 效果/ ./ 因此/ ,/ Bed/ 树/ 在/ 处理/ 查询/ 时/ ,/ 即使/ 查询/ 结果/ 很少/ ,/ 查询处理/ 也/ 会/ 引起/ 很多/ I/ // O/ 操作/ ./ 本文/ 设计/ 了/ 一种/ 支持/ 字符串/ 相似性/ 操作/ 的/ 索引/ 结构/ RM/ 树/ ./ RM/ 树/ 将/ 相似/ 的/ 字符串/ 聚类/ 在/ 一起/ ,/ 减少/ 了/ Bed/ 树中/ 使用/ 一维/ 排序/ 方法/ 引起/ 的/ 昂贵/ 的/ 查询处理/ I/ // O/ 开销/ ./ RM/ 树/ 通过/ 字符串/ 的/ Gram/ 集合/ ,/ 将/ 相似/ 的/ 字符串/ 组织/ 到/ 相近/ 的/ 叶/ 节点/ 中/ ./ 字符串/ 首先/ 被/ 转换成/ 固定/ 维度/ 的/ Gram/ 向量/ ,/ 并/ 使用/ 与/ R/ 树/ 类似/ 的/ 方法/ 管理/ 和/ 操作/ 这些/ Gram/ 向量/ ./ 不同于/ R/ 树/ ,/ RM/ 树/ 在/ 每个/ 节点/ 中/ 加入/ 该子/ 树中/ Gram/ 集合/ 的/ signature/ ,/ 进一步/ 刻画/ 该子/ 树中/ 字符串/ 的/ 内容/ ,/ 增加/ 查询处理/ 过程/ 中/ ,/ 子树/ 之间/ 的/ 过滤/ 能力/ ./ 由于/ 在/ R/ 树中/ 加入/ 位图/ Bitmap/ 作为/ signature/ ,/ 本文/ 设计/ 的/ 索引/ 命名/ 为/ RM/ 树/ ./ RM/ 树/ 支持/ 多种/ 字符串/ 相似性/ 操作/ 包括/ 范围/ 查询/ 、/ top/ -/ k/ 查询/ 、/ 连接/ 操作/ ./ 实验/ 结果表明/ ,/ RM/ 树/ 有效/ 地/ 降低/ 了/ 字符串/ 相似性/ 操作过程/ 中/ 的/ I/ // O/ 代价/ ,/ 减少/ 了/ 时间/ 开销/ ./ 本文/ 的/ 主要/ 贡献/ 在于/ :/ (/ 1/ )/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 索引/ 结构/ RM/ 树/ ,/ 用于/ 支持/ 多种/ 字符串/ 相似性/ 操作/ ./ RM/ 树/ 节点/ 中/ 保存/ Gram/ 向量/ 和/ 位图/ 信息/ 用于/ 削减/ 搜索/ 空间/ ./ (/ 2/ )/ 本文/ 给出/ 了/ RM/ 树/ 的/ 构建/ 方法/ ,/ 即/ 适用/ 于/ 字符串/ 数据/ 的/ 插入/ 目标/ 选择/ 方法/ ,/ 节点/ 分裂/ 方法/ ./ (/ 3/ )/ 本文/ 设计/ 了/ RM/ 树中/ 处理/ 多种/ 字符串/ 相似性/ 操作/ 的/ 方法/ ,/ 包括/ 范围/ 查询/ 、/ top/ -/ k/ 查询/ 以及/ 连接/ 操作/ ./ RM/ 树/ 在/ 查询处理/ 过程/ 中/ 利用/ 节点/ 中/ 存储/ 的/ Gram/ 向量/ 和/ 位图/ 信息/ 有效/ 地/ 削减/ 了/ 搜索/ 空间/ ./ (/ 4/ )/ 本文/ 通过/ 大量/ 实验/ 测试/ 了/ RM/ 树/ 处理/ 各种/ 字符串/ 相似性/ 操作/ 的/ 代价/ ,/ 包括/ I/ // O/ 代价/ 和/ 时间/ 开销/ ./ 实验/ 部分/ 还/ 测试/ 了/ 建立/ RM/ 树/ 的/ 时间/ 开销/ ./ 本文/ 第/ 2/ 节/ 介绍/ 各种/ 字符串/ 相似性/ 操作/ 的/ 定义/ ./ 第/ 3/ 节/ 给出/ RM/ 树/ 的/ 结构/ 以及/ RM/ 树/ 的/ 插入/ 算法/ ./ RM/ 树/ 处理/ 各种/ 字符串/ 相似性/ 查询/ 的/ 方法/ 在/ 第/ 4/ 节中/ 给出/ ,/ 包括/ 范围/ 查询处理/ 、/ top/ -/ k/ 查询处理/ 以及/ 连接/ 操作/ 的/ 处理/ 方法/ ./ 第/ 5/ 节/ 简介/ RM/ 树/ 基于/ 其它/ 字符串/ 相似性/ 度量/ 的/ 应用/ ./ 第/ 6/ 节/ 通过/ 真实/ 数据/ 和/ 人工合成/ 数据/ 上/ 的/ 实验/ 验证/ 了/ RM/ 树/ 索引/ 结构/ 的/ 有效性/ ./ 第/ 7/ 节/ 介绍/ RM/ 树/ 的/ 相关/ 工作/ ./ 最后/ ,/ 第/ 8/ 节/ 给出/ 本文/ 结论/ ./ 2/ 背景/ 知识/ 本/ 节/ 介绍/ 编辑/ 距离/ 、/ q/ -/ Gram/ 、/ 字符串/ 相似性/ 操作/ 的/ 定义/ ,/ 包括/ 字符串/ 相似性/ 查询/ 和/ 连接/ 操作/ ./ 2.1/ 编辑/ 距离/ 和/ 狇/ -/ Gram/ 给定/ 字母表/ Σ/ ,/ 字符/ 序列/ s/ ∈/ (/ Σ/ )/ / 定义/ 为/ Σ/ 中/ 字符串/ ,/ 记/ s/ [/ i/ ]/ 为/ 字符串/ s/ 的/ 第/ i/ 个字符/ ,/ |/ s/ |/ 为/ s/ 的/ 长度/ ./ 编辑/ 距离/ (/ 也/ 叫做/ EditDistance/ )/ ,/ 是/ 指/ 两个/ 字符串/ 之间/ ,/ 由/ 一个/ 转成/ 另/ 一个/ 所/ 需/ 的/ 最少/ 编辑/ 操作/ 次数/ ./ 其中/ ,/ 编辑/ 操作/ 包括/ 将/ 一个/ 字符/ 替换成/ 另/ 一个/ 字符/ ,/ 插入/ 一个/ 字符/ ,/ 删除/ 一个/ 字符/ ./ 字符串/ s/ 和/ 字符串/ t/ 的/ 编辑/ 距离/ 记为/ ED/ (/ s/ ,/ t/ )/ ./ 设/ 字符/ α/ ,/ β/ / Σ/ ,/ 在/ s/ 的/ 开头/ 加上/ q/ -/ 1/ 个/ α/ ,/ 在/ s/ 的/ 末尾/ 加上/ q/ -/ 1/ 个/ β/ ,/ Page3/ 得到/ 字符串/ s/ ./ 字符串/ s/ 中/ 所有/ 长度/ 为/ q/ 的/ 子串/ 组成/ s/ 的/ q/ -/ Gram/ 集合/ ,/ 简称/ Gram/ 集合/ ,/ 记为/ GS/ (/ s/ )/ ./ 字符串/ s/ 拥有/ |/ s/ |/ +/ q/ -/ 1/ 个/ q/ -/ Gram/ ,/ 如果/ 两个/ 字符串/ s/ 和/ t/ 的/ 编辑/ 距离/ 不/ 大于/ k/ ,/ 则/ 它们/ 至少/ 拥有/ max/ {/ |/ s/ |/ ,/ |/ t/ |/ }/ -/ 1/ -/ (/ k/ -/ 1/ )/ ×/ q/ 个/ 相同/ 的/ Gram/ ,/ 这是/ 现有/ 工作/ 中/ 广泛/ 使用/ 的/ 过滤/ 条件/ 之一/ ./ 例/ 1/ ./ 表/ 1/ 给出/ 了/ 包含/ 3/ 个/ 字符串/ 的/ 集合/ S/ ./ 其中/ ,/ 字符串/ s1/ =/ “/ JimGrey/ ”/ 和/ s2/ =/ “/ JimGray/ ”/ 的/ 编辑/ 距离/ ED/ (/ s1/ ,/ s2/ )/ =/ 1/ ,/ 字符串/ s1/ 中/ 的/ 第/ 7/ 个字符/ e/ 替换成/ 字符/ a/ 就/ 可以/ 得到/ 字符串/ s2/ ./ IdContentIdContent1JimGray3StoneBreaker2JimGrey2/ ./ 2/ 字符串/ 相似性/ 操作/ 给定/ 字符串/ 数据/ 集合/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sN/ }/ ,/ 范围/ 查询/ Q/ (/ s/ ,/ θ/ )/ 返回/ 结果/ 为/ S/ =/ {/ s/ |/ s/ ∈/ S/ ,/ ED/ (/ s/ ,/ s/ )/ / θ/ }/ ,/ 即/ 数据/ 集合/ 中/ 与/ 给定/ 字符串/ s/ 的/ 编辑/ 距离/ 不/ 大于/ 阈值/ θ/ 的/ 所有/ 字符串/ ./ 在/ S/ 中/ 执行/ 范围/ 查询/ Q/ (/ s1/ ,/ 1/ )/ 将/ 得到/ 结果/ {/ s1/ ,/ s2/ }/ ./ Top/ -/ k/ 查询/ Q/ (/ s/ ,/ k/ )/ 返回/ S/ 中/ 与/ 给定/ 字符串/ s/ 编辑/ 距离/ 最小/ 的/ k/ 个/ 字符串/ 组成/ 的/ 集合/ ./ 在/ 集合/ S/ 中/ 执行/ top/ -/ 2/ 查询/ Q/ (/ s2/ ,/ 2/ )/ 的/ 结果/ 为/ {/ s1/ ,/ s2/ }/ ./ 2.3/ 字符串/ 相似性/ 连接/ 给定/ 字符串/ 集合/ S/ =/ {/ s1/ ,/ …/ ,/ sN/ }/ 和/ R/ =/ {/ r1/ ,/ …/ ,/ rM/ }/ ,/ 字符串/ 相似/ 连接/ 操作/ Join/ (/ R/ ,/ S/ ,/ θ/ )/ 返回/ J/ =/ {/ (/ s/ ,/ r/ )/ |/ s/ ∈/ S/ ,/ r/ ∈/ R/ ,/ ED/ (/ s/ ,/ r/ )/ / θ/ }/ ./ 即/ 所有/ 满足/ 以下/ 条件/ 的/ 字符串/ 对/ :/ (/ 1/ )/ 字符串/ 对/ 中/ 一个/ 来自/ S/ ,/ 另/ 一个/ 来自/ R/ ;/ (/ 2/ )/ 二者/ 的/ 编辑/ 距离/ 不/ 大于/ 给定/ 的/ 阈值/ θ/ ./ 执行/ 表/ 1/ 中/ 集合/ S/ 与表/ 2/ 中/ 集合/ R/ 的/ 连接/ 操作/ Join/ (/ R/ ,/ S/ ,/ 1/ )/ 的/ 结果/ 为/ 空集/ ,/ 执行/ 连接/ 操作/ Join/ (/ R/ ,/ S/ ,/ 3/ )/ 的/ 结果/ 为/ {/ (/ J/ ./ Gray/ ,/ JimGray/ )/ }/ ./ 3RM/ 树/ 索引/ 本/ 节/ 介绍/ RM/ 树/ 索引/ 结构/ 及其/ 构建/ 方法/ ./ 3.1/ 节/ 介绍/ RM/ 树/ 的/ 索引/ 结构/ ,/ 3.2/ 节/ 给出/ RM/ 树/ 的/ 构建/ 方法/ ./ 将/ 字符串/ s/ 插入/ RM/ 树前/ ,/ 需要/ 计算/ Gram/ 向量/ 、/ MBR/ 及/ Bitmap/ ,/ 它们/ 的/ 定义/ 如下/ ./ 定义/ 1/ (/ 字符串/ s/ 的/ d/ 维/ Gram/ 向量/ )/ ./ 给定/ 正整数/ q/ 和/ 从/ 字符串/ 集合/ 到/ 正整数/ 集合/ [/ 1/ ,/ d/ ]/ 的/ Hash/ 函数/ hV/ ,/ 字符串/ s/ 的/ q/ -/ Gram/ 集合/ 记为/ GS/ (/ s/ )/ ./ 字符串/ s/ 的/ Gram/ 向量/ 犵/ 狏/ (/ s/ )/ 是/ 一个/ d/ 维/ 向量/ ,/ 该/ 向量/ 的/ 第/ i/ 个/ 分量/ 犵/ 狏/ (/ s/ )/ [/ i/ ]/ 的/ 值/ 为/ |/ {/ g/ ∈/ GS/ (/ s/ )/ ,/ hV/ (/ g/ )/ =/ i/ }/ |/ ./ 定义/ 2/ (/ 字符串/ 集合/ S/ 的/ MBR/ )/ ./ 字符串/ 集合/ S/ 中/ 所有/ 字符串/ 的/ d/ 维/ Gram/ 向量/ 组成/ 的/ d/ 维/ 区间/ 称为/ S/ 的/ MBR/ (/ MinimalBoundingRegion/ )/ ./ 定义/ 3/ (/ 字符串/ s/ 的/ Bitmap/ )/ ./ 给定/ 从/ 字符串/ 集合/ 到/ 整数/ 集合/ [/ 1/ ,/ L/ ]/ 的/ Hash/ 函数/ hB/ 、/ 字符集/ Σ/ / Σ/ 和/ 字符/ c/ ,/ 字符串/ s/ 的/ Bitmap/ 为/ 一串/ 0/ -/ 1/ 序列/ ,/ 记为/ B/ (/ s/ )/ ,/ 其中/ 第/ i/ 位为/ 1/ 当且/ 仅/ 当/ 以下/ 两个/ 条件/ 中/ 至少/ 有/ 一个/ 成立/ ,/ (/ 1/ )/ / g/ ∈/ GS/ (/ s/ )/ ∩/ (/ Σ/ )/ / 而且/ hB/ (/ g/ )/ =/ i/ ;/ (/ 2/ )/ / g/ ∈/ GS/ (/ s/ )/ ,/ g/ / (/ Σ/ )/ / ,/ 将/ g/ 中/ 不/ 属于/ Σ/ 的/ 字符/ 替换成/ c/ 得到/ g/ ,/ hB/ (/ g/ )/ =/ i/ ./ 将/ g/ 中/ 不/ 属于/ Σ/ 的/ 字符/ 替换成/ c/ 的/ 转换/ 记为/ T/ (/ g/ )/ =/ g/ ./ RM/ 树中/ ,/ Σ/ 为/ 字母/ 集合/ ,/ 不/ 包含/ 标点/ 和/ 特殊符号/ ,/ 这样/ 可以/ 大幅/ 降低/ Bitmap/ 中/ 1/ 的/ 个数/ ,/ 增加/ Bitmap/ 过滤/ 的/ 作用/ ./ L/ 为/ Bitmap/ 的/ 长度/ ./ 定义/ 4/ (/ 字符串/ 集合/ S/ 的/ Bitmap/ )/ ./ 字符串/ 集合/ S/ 的/ Bitmap/ 记为/ B/ (/ S/ )/ ,/ 定义/ 为/ 其中/ 所有/ 字符串/ 的/ Bitmap/ 的/ 或/ (/ “/ |/ ”/ )/ 操作/ 结果/ ./ 即/ B/ (/ S/ )/ 的/ 第/ i/ 位为/ 1/ 当且/ 仅/ 当/ S/ 中/ 存在/ s/ ,/ 满足/ B/ (/ s/ )/ 的/ 第/ i/ 位为/ 1.3/ ./ 1RM/ 树/ 索引/ 结构/ RM/ 树/ 具备/ 高度/ 平衡/ 性质/ ,/ 即/ 所有/ 叶子/ 节点/ 都/ 在/ 同/ 一层/ 上/ ./ RM/ 树/ 节点/ 与/ 磁盘/ 页/ 一一对应/ ,/ 并/ 被/ 存储/ 在/ 磁盘/ 上/ ./ RM/ 树/ 节点/ 分为/ 内/ 节点/ 和/ 叶/ 节点/ 两类/ ./ RM/ 树/ 通过/ 字符串/ 的/ Gram/ 向量/ 来/ 组织/ 数据/ 存储/ ,/ 将/ 相似/ 的/ 字符串/ 存储/ 在/ 相同/ 或/ 相近/ 的/ 叶/ 节点/ 中/ ./ 在/ 查询处理/ 过程/ 中/ ,/ RM/ 树/ 使用/ Gram/ 向量/ 、/ MBR/ 和/ Bitmap/ 作为/ 过滤/ 信息/ ,/ 削减/ 搜索/ 空间/ ,/ 提高/ 查询处理/ 效率/ ./ RM/ 树内/ 节点/ 的/ 存储/ 格式/ 为/ (/ PageId/ ,/ MBR/ ,/ Bitmap/ ,/ LengthRange/ ,/ ChildrenSet/ )/ ,/ 其中/ PageId/ 是/ 内/ 节点/ 对应/ 磁盘/ 页/ 的/ 编号/ ,/ MBR/ 是/ 以/ 该/ 节点/ 为根/ 的/ 子树中/ 存储/ 的/ 字符串/ 集合/ 的/ MBR/ ./ Length/ -/ Range/ 为/ 该子/ 树中/ 字符串/ 长度/ 的/ 范围/ ./ Bitmap/ 为/ 该子/ 树中/ 存储/ 的/ 字符串/ 集合/ 的/ Bitmap/ ./ 内/ 节点/ 的/ ChildrenSet/ 包括/ 若干/ 儿子/ 记录/ ,/ 儿子/ 记录/ 格式/ 为/ (/ PageId/ ,/ MBR/ ,/ Bitmap/ ,/ LengthRange/ )/ ./ 其中/ ,/ PageId/ 为/ 儿子/ 节点/ 对应/ 的/ 磁盘/ 页/ 编号/ ,/ MBR/ ,/ Bitmap/ ,/ LengthRange/ 分别/ 为/ 以/ 该/ 儿子/ 为根/ 的/ 子树中/ 包含/ 的/ 字符串/ 集合/ 的/ MBR/ 、/ 字符串/ 所有/ Bitmap/ 以及/ 长度/ 范围/ ./ 图/ 1/ 所示/ 为/ RM/ 树内/ 节点/ 的/ 结构/ ./ RM/ 树叶子/ 节点/ 的/ 存储/ 格式/ 为/ (/ PageId/ ,/ MBR/ ,/ Bitmap/ ,/ LengthRange/ ,/ DataSet/ )/ ./ 其中/ ,/ PageId/ 是/ Page4/ 叶子/ 节点/ 对应/ 的/ 磁盘/ 页/ 的/ 编号/ ,/ MBR/ 是/ 该/ 节点/ 包含/ 的/ 字符串/ 集合/ 的/ MBR/ ,/ LengthRange/ 为/ 该/ 节点/ 内/ 字符串/ 的/ 长度/ 范围/ ,/ Bitmap/ 为/ 该/ 叶子/ 节点/ 中/ 包含/ 的/ 字符串/ 集合/ 的/ Bitmap/ ,/ DataSet/ 是/ 该/ 叶子/ 节点/ 包含/ 的/ 字符串/ 数据/ 集合/ ./ 在/ RM/ 树中内/ 节点/ NI/ 的/ MBR/ 、/ Bitmap/ 、/ LengthRange/ 通过/ 该/ 节点/ 的/ 所有/ 儿子/ 的/ MBR/ 、/ Bitmap/ 、/ LengthRange/ 计算/ 得到/ ./ 其中/ ,/ NI/ / LengthRange/ 的/ 下界/ 为/ NI/ 所有/ 儿子/ 的/ LengthRange/ 的/ 下界/ 的/ 最小值/ ,/ 其上界/ 为/ NI/ 所有/ 儿子/ 上界/ 的/ 最大值/ ./ NI/ / Bitmap/ [/ i/ ]/ =/ 1/ 当且/ 仅/ 当/ 存在/ NI/ 的/ 儿子/ N/ ,/ 使得/ N/ / Bitmap/ [/ i/ ]/ =/ 1/ ./ 在/ RM/ 树中/ 叶子/ 节点/ NL/ 的/ MBR/ 、/ Length/ -/ Range/ 和/ Bitmap/ 通过/ NL/ 中/ 包含/ 的/ 字符串/ 计算/ 获得/ ./ 其中/ ,/ NLLengthRange/ =/ [/ mins/ ∈/ NL/ ./ DataSet/ {/ s/ }/ ,/ maxs/ ∈/ NL/ ./ DataSet/ {/ s/ }/ ]/ ./ NI/ ./ Bitmap/ [/ i/ ]/ =/ 1/ 当且/ 仅/ 当/ 存在/ s/ ∈/ NL/ ./ DataSet/ 使得/ B/ (/ s/ )/ [/ i/ ]/ =/ 1/ ./ 在/ RM/ 树/ 节点/ 中/ 存储/ 字符串/ 集合/ 的/ MBR/ 和/ Bitmap/ 信息/ ,/ 有助于/ 查询处理/ 过程/ 中/ 的/ 搜索/ 空间/ 削减/ ./ 增加/ MBR/ 的/ 维度/ 和/ Bitmap/ 的/ 长度/ 可以/ 提高/ 其/ 过滤/ 能力/ ,/ 但是/ 也/ 降低/ 了/ RM/ 树/ 节点/ 的/ 度/ ,/ 增加/ 查询处理/ 的/ I/ // O/ 代价/ ,/ 因此/ 取值/ 需要/ 折中/ 选取/ ,/ 本文/ 实验/ 部分/ 测试/ 了/ MBR/ 维度/ 和/ Bitmap/ 长度/ 对/ RM/ 树/ 性能/ 的/ 影响/ ./ 定理/ 1/ 和/ 定理/ 2/ 描述/ 了/ MBR/ 和/ Bitmap/ 削减/ 搜索/ 空间/ 的/ 作用/ ./ 在/ 介绍/ 定理/ 1/ 和/ 定理/ 2/ 之前/ ,/ 首先/ 介绍/ 以下/ 定义/ ./ 定义/ 5/ (/ 字符串/ s/ 与/ 字符串/ t/ 的/ Gram/ 向量/ 距离/ )/ ./ 字符串/ s/ 和/ 字符串/ t/ 的/ d/ 维/ Gram/ 向量/ 距离/ 定义/ 为/ DG/ (/ s/ ,/ t/ )/ =/ ∑/ d/ 和/ t/ 的/ d/ 维/ Gram/ 向量/ 各个/ 位之差/ 的/ 和/ ./ 定义/ 6/ (/ 字符串/ s/ 与/ 字符串/ 集合/ S/ 的/ Gram/ 向量/ 距离/ )/ ./ 字符串/ s/ 的/ Gram/ 向量/ 记为/ 犵/ 狏/ (/ s/ )/ ,/ 字符串/ 集合/ S/ 中/ 的/ 所有/ 字符串/ 的/ Gram/ 向量/ 确定/ 了/ S/ 的/ MBR/ ./ 字符串/ s/ 与/ 字符串/ 集合/ S/ 的/ Gram/ 向量/ 距离/ 定义/ 为/ ,/ DG/ (/ s/ ,/ S/ )/ =/ ∑/ 犵/ 狏/ (/ s/ )/ [/ i/ ]/ >/ S/ ./ MBRUP/ [/ i/ ]/ S/ ./ MBRUP/ [/ i/ ]/ )/ ./ 即/ 通过/ MBR/ 可以/ 判断/ 不/ 属于/ GS/ (/ S/ )/ ,/ 但/ 属于/ GS/ (/ s/ )/ 的/ Gram/ 个数/ ./ 定义/ 7/ (/ 字符串/ s/ 与/ 字符串/ 集合/ S/ 的/ Bitmap/ 距离/ )/ ./ 字符串/ s/ 的/ Gram/ 集合/ 记为/ GS/ (/ s/ )/ ,/ 字符串/ 集合/ S/ 的/ Bitmap/ 记为/ B/ (/ S/ )/ ,/ s/ 与/ S/ 的/ Bitmap/ 距离/ DB/ (/ s/ ,/ S/ )/ =/ |/ {/ g/ |/ g/ ∈/ GS/ (/ s/ )/ ,/ g/ =/ T/ (/ g/ )/ ,/ B/ (/ S/ )/ [/ hB/ (/ g/ )/ ]/ =/ 0/ }/ |/ ,/ 即/ 通过/ Bitmap/ 可以/ 确定/ s/ 中/ 不/ 存在/ 的/ GS/ (/ S/ )/ 中/ 的/ Gram/ 的/ 个数/ ./ 下面/ 介绍/ 定理/ 1/ 和/ 定理/ 2/ ,/ 其中/ 定理/ 1/ 说明/ 了/ 若/ 两个/ 字符串/ 的/ 编辑/ 距离/ 小于/ 给定/ 的/ 阈值/ ,/ 则/ 它们/ 的/ Gram/ 向量/ 距离/ 也/ 小于/ 某一/ 阈值/ ./ 由此/ ,/ Gram/ 向量/ 距离/ 可以/ 用来/ 在/ RM/ 树中/ ,/ 判断/ 某一子/ 树中/ 是否/ 包含/ 与/ 目标/ 字符串/ 编辑/ 距离/ 小于/ 某/ 阈值/ 的/ 字符串/ ./ 定理/ 2/ 说明/ 了/ 如果/ 一个/ 字符串/ s/ 和/ 一个/ 字符串/ 集合/ S/ 的/ Bitmap/ 距离/ 大于/ 给定/ 阈值/ ,/ 则/ S/ 中/ 的/ 所有/ 字符串/ 与/ s/ 的/ 编辑/ 距离/ 不/ 小于/ 某一/ 阈值/ ./ 由此/ ,/ Bitmap/ 距离/ 也/ 可以/ 用来/ 判断/ 子树中/ 是否/ 包含/ 与/ s/ 编辑/ 距离/ 不/ 超过/ 给定/ 阈值/ 的/ 字符串/ ./ 定理/ 1/ ./ 如果/ 字符串/ s1/ 和/ 字符串/ s2/ 的/ 编辑/ 距离/ 不/ 大于/ θ/ ,/ 则/ s1/ 和/ s2/ 的/ Gram/ 向量/ 距离/ 不/ 大于/ 2/ θ/ ×/ q/ ,/ 其中/ q/ 为/ Gram/ 长度/ ./ 证明/ ./ 由于/ 字符串/ s1/ 和/ 字符串/ s2/ 的/ 编辑/ 距离/ 不/ 大于/ θ/ ,/ 可知/ s1/ 的/ q/ -/ Gram/ 集合/ 与/ s2/ 的/ q/ -/ Gram/ 集合/ 的/ 差/ 中/ 至多/ 有/ θ/ ×/ q/ 个/ 元素/ ,/ 即/ |/ GS/ (/ s1/ )/ // GS/ (/ s2/ )/ |/ / θ/ ×/ q/ ./ 对称/ 地/ ,/ 不等式/ |/ GS/ (/ s2/ )/ // GS/ (/ s1/ )/ |/ / θ/ ×/ q/ 也/ 成立/ ./ 由/ Gram/ 向量/ 距离/ 的/ 定义/ 可知/ ,/ 在/ 计算/ 字符串/ s/ 的/ d/ 维/ Gram/ 向量/ 时/ ,/ 不同/ 的/ Gram/ 可能/ 被/ 散列/ 到/ 同一个/ 维度/ 进行/ 计数/ ./ 记/ GSi/ (/ s/ )/ 为/ 字符串/ s/ 的/ 被/ 映射/ 到/ 第/ i/ 个/ 维度/ 的/ Gram/ 组成/ 的/ 集合/ ./ 字符串/ s1/ 和/ 字符串/ s2/ 的/ Gram/ 向量/ 在/ 第/ i/ 个/ 维度/ 上/ 的/ 差为/ |/ 犵/ 狏/ (/ s1/ )/ [/ i/ ]/ -/ 犵/ 狏/ (/ s2/ )/ [/ i/ ]/ |/ ,/ 它/ 的/ 数值/ 不/ 大于/ |/ GSi/ (/ s1/ )/ // GSi/ (/ s2/ )/ |/ +/ |/ GSi/ (/ s2/ )/ // GSi/ (/ s1/ )/ |/ ./ 对/ 这/ 两个/ 数值/ 在/ 维度/ 从/ 1/ 到/ d/ 上取/ 和/ ,/ 可以/ 得出/ 两个/ 字符串/ 的/ Gram/ 距离/ 向量/ 满足/ 如下/ 不等式/ :/ DG/ (/ s1/ ,/ s2/ )/ / |/ GS/ (/ s1/ )/ // GS/ (/ s2/ )/ |/ +/ |/ GS/ (/ s2/ )/ // GS/ (/ s1/ )/ |/ ./ 由此/ 得证/ DG/ (/ s1/ ,/ s2/ )/ / 2/ θ/ ×/ q/ ./ 证毕/ ./ 定理/ 2/ ./ 如果/ 字符串/ s/ 和/ 字符串/ 集合/ S/ 的/ Bit/ -/ map/ 距离/ 大于/ θ/ ×/ q/ ,/ 则/ 不/ 存在/ t/ ∈/ S/ 使得/ 字符串/ s/ 和/ t/ 的/ 编辑/ 距离/ 不/ 大于/ θ/ ./ Page5/ 证明/ ./ 由/ 字符串/ s/ 和/ 字符串/ 集合/ S/ 的/ Bitmap/ 距离/ 大于/ θ/ ×/ q/ ,/ 可知/ 字符串/ s/ 的/ Gram/ 集合/ GS/ (/ s/ )/ 中/ 至少/ 有/ θ/ ×/ q/ 个/ Gram/ 组成/ 集合/ G/ ,/ 满足/ / g/ ∈/ G/ ,/ 必/ 不/ 存在/ t/ ∈/ S/ 使得/ g/ ∈/ GS/ (/ t/ )/ ./ 因此/ ,/ 对于/ / t/ ∈/ S/ ,/ 字符串/ s/ 中/ 包含/ 多于/ θ/ ×/ q/ 个/ 字符串/ t/ 中/ 不/ 存在/ 的/ Gram/ ,/ 因此/ s/ 与/ t/ 的/ 编辑/ 距离/ 不/ 小于/ θ/ ./ 即/ S/ 中/ 不/ 存在/ 与/ s/ 编辑/ 距离/ 不/ 大于/ θ/ 的/ 字符串/ ./ 证毕/ ./ 算法/ 1/ ./ ChooseChild/ ./ 输入/ :/ 字符串/ s/ ,/ RM/ 树内/ 节点/ N/ 输出/ :/ 作为/ 插入/ 目标/ 的/ 儿子/ 编号/ j1/ ./ fori/ =/ 1to/ |/ N/ / ChildrenSet/ |/ 2/ ./ i/ ’/ sENLARGE/ (/ i/ )/ =/ (/ MOEnlarge/ (/ s/ )/ ,/ BEnlarge/ (/ s/ )/ )/ 3/ ./ jisthechildwithleastenlargevalue4/ ./ returnj3/ ./ 2RM/ 树/ 插入方法/ RM/ 树/ 的/ 插入/ 过程/ 从根/ 节点/ 开始/ ,/ 从/ 上/ 而/ 下/ 选择/ 子树/ 插入/ ,/ 直到/ 最终/ 选择/ 一个/ 叶子/ 节点/ 作为/ 插入/ 目标/ ./ 随后/ ,/ 字符串/ s/ 被/ 插入/ 到/ 叶子/ 节点/ 中/ ,/ 叶子/ 节点/ 判断/ 是否/ 需要/ 处理/ 溢出/ ,/ 并/ 更新/ 叶子/ 节点/ 的/ MBR/ ,/ Bitmap/ 等/ 信息/ ./ 如果/ 作为/ 插入/ 目标/ 的/ 节点/ 产生/ 分裂/ 或者/ 形状/ 变化/ ,/ 则/ 分裂/ 和/ 形状/ 变化/ 作为/ 插入/ 结果/ ,/ 返回/ 给/ 父亲/ 节点/ ,/ 并/ 在/ 父亲/ 节点/ 中/ 进一步/ 处理/ ,/ 如果/ 父亲/ 节点/ 也/ 由此/ 产生/ 分裂/ ,/ 则/ 该/ 父亲/ 节点/ 也/ 向/ 它/ 的/ 父亲/ 节点/ 返回/ 插入/ 结果/ ./ 根/ 节点/ 的/ 分裂/ 将/ 产生/ 新/ 的/ 根/ 节点/ ,/ 并/ 增加/ 树/ 的/ 高度/ ,/ 这/ 与/ B/ 树/ 等/ 的/ 插入/ 过程/ 相似/ ./ RM/ 树/ 的/ 插入/ 过程/ 与/ 其它/ 索引/ 树/ 的/ 不同/ 在于/ 插入/ 目标/ 的/ 选择/ 和/ 节点/ 分裂/ 的/ 过程/ ./ 算法/ 1/ 的/ ChooseChild/ 和/ 算法/ 2/ 的/ SplitIndex/ 分别/ 描述/ 了/ 插入/ 目标/ 选择/ 和/ 内/ 节点/ 的/ 分裂/ 过程/ ,/ 算法/ 4/ 的/ SplitLeaf/ 描述/ 了/ RM/ 树叶子/ 节点/ 的/ 分裂/ 过程/ ./ 算法/ 1/ 用于/ 在/ 节点/ N/ 中/ 选择/ 字符串/ s/ 插入/ 的/ 子树/ ./ 对于/ N/ 的/ 每个/ 儿子/ 节点/ i/ ,/ ChooseChild/ 计算/ 在/ i/ 中/ 插入/ 字符串/ s/ 产生/ 的/ ENLARGE/ 数值/ (/ 第/ 1/ ~/ 2/ 行/ )/ ,/ 并/ 选择/ 该/ 数值/ 最小/ 的/ 节点/ 来/ 完成/ s/ 的/ 插入/ (/ 第/ 3/ ~/ 4/ 行/ )/ ./ 儿子/ 节点/ i/ 的/ ENLARGE/ 数值/ 由/ 两/ 部分/ 组成/ ,/ 分别/ 为/ MOEnlarge/ 和/ BEnlarge/ ./ 其中/ ,/ MOEnlarge/ 描述/ 在/ i/ 中/ 插入/ s/ 后/ MBR/ 与/ 其它/ 儿子/ 节点/ 的/ MBR/ 相交/ 部分/ 的/ 增量/ ,/ 而/ BEnlarge/ 描述/ 了/ 在/ i/ 中/ 插入/ s/ 后/ ,/ 节点/ i/ 的/ Bitmap/ 中/ 从/ 0/ 变成/ 1/ 的/ 位/ 的/ 数量/ ./ 使用/ MBR/ 的/ 相交/ 增量/ 作为/ 首要/ 排序/ 元素/ ,/ 减小/ 了/ 插入/ 目标/ 节点/ 的/ MBR/ 与/ 其它/ 儿子/ 节点/ 的/ MBR/ 的/ 相交/ 之/ 和/ ,/ 以此/ 减少/ 查询/ 过程/ 中/ 多个/ 儿子/ 被/ 访问/ 的/ 可能性/ ,/ 从而/ 达到/ 减低/ I/ // O/ 操作/ 的/ 目的/ ./ 由于/ Bitmap/ 在/ RM/ 树中/ 用作/ MBR/ 之后/ 的/ 过滤/ 条件/ ,/ 因此/ 次要/ 排序/ 元素/ 使用/ Bitmap/ ,/ 其中/ Bitmap/ 从/ 0/ ~/ 1/ 的/ 位/ 的/ 数量/ 描述/ 了/ Bitmap/ 过滤/ 能力/ 的/ 损失/ 大小/ ./ 为了/ 提高/ 查询处理/ 的/ 效率/ ,/ ENLARGE/ 二元/ 组/ 越小越/ 好/ ./ 算法/ 2/ ./ SplitIndex/ ./ 输入/ :/ RM/ 树内/ 节点/ N/ 输出/ :/ 索引/ 项/ 集合/ p1/ ,/ p21/ ./ dim/ =/ chooseSplitDimension/ (/ N/ )/ 2/ ./ sortN/ / ChildrenSeton/ 〈/ MBR/ [/ dim/ ]/ / low/ ,/ 3/ ./ fori/ =/ mtoM/ -/ m4/ ./ partitionN/ ./ entryListintop1andp25/ ./ cost/ [/ i/ ]/ =/ 〈/ MbrOverlap/ (/ p1/ ,/ p2/ )/ ,/ BSum/ (/ p1/ )/ +/ 6/ ./ choosepartitionstrategyjwithminimalcost7/ ./ partitionN/ ./ entryListintop1andp28/ ./ return/ (/ p1/ ,/ p2/ )/ RM/ 树/ 节点/ 的/ MBR/ 为/ 多维/ 区域/ ,/ 在/ 节点/ 分裂/ 过程/ 中/ ,/ 将/ 多维/ 区域/ 划分/ 到/ 两个/ 集合/ 的/ 方法/ ,/ 在/ R/ 树/ 及其/ 诸多/ 改进/ 工作/ 中/ 被/ 广泛/ 研究/ ./ 与/ R/ 树/ 不同/ ,/ RM/ 树/ 节点/ 中/ 包含/ 字符串/ 集合/ 的/ MBR/ 和/ Bitmap/ 两类/ 信息/ ,/ 而且/ 这/ 两类/ 信息/ 不能/ 组成/ 一个/ 多维/ 区域/ ./ 算法/ 2/ 描述/ 了/ RM/ 树内/ 节点/ 分裂/ 的/ 过程/ ./ 与/ R/ / 树/ 节点/ 分裂/ 的/ 过程/ 类似/ ,/ 算法/ SplitIndex/ 首先/ 调用/ chooseSplitDimension/ 方法/ (/ 第/ 1/ 行/ )/ 确定/ 划分/ 维度/ ,/ 该/ 算法/ 与/ R/ / 树中/ 选择/ 划分/ 维度/ 的/ 算法/ 相似/ (/ 算法/ 3/ 描述/ 了/ 选择/ 划分/ 维度/ 的/ 过程/ ,/ 与/ R/ / 树/ 的/ 不同/ ,/ 每种/ 划分/ 的/ 代价/ 的/ 值/ 为/ 一个二元/ 组/ ,/ 两个/ 维度/ 分别/ 为/ 分裂/ 后/ 产生/ 的/ 两个/ MBR/ 的/ 相交/ 体积/ 和/ 两个/ Bitmap/ 中/ 1/ 的/ 个数/ 之/ 和/ (/ 第/ 5/ 行/ )/ )/ ./ 随后/ ,/ 算法/ 2/ 在/ 选中/ 的/ 维度/ 上/ 把/ 所有/ 索引/ 项/ 排序/ (/ 第/ 2/ 行/ )/ ,/ 并/ 计算/ 所有/ 可行/ 划分/ 的/ 代价/ ,/ 从中/ 选择/ 代价/ 最小/ 的/ 划分/ (/ 第/ 3/ ~/ 6/ 行/ )/ ,/ 其中/ m/ 和/ M/ 为/ 节点/ 中/ 索引/ 项/ 的/ 最小/ 、/ 最大/ 数目/ ./ 最终/ ,/ 算法/ 2/ 按照/ 代价/ 最小/ 的/ 划分/ 策略/ 将/ 所有/ 索引/ 项/ 划分/ 成/ 两组/ (/ 第/ 7/ 行/ )/ ./ 在/ 节点/ 分裂/ 算法/ 中/ ,/ RM/ 树/ 在/ 选择/ 划分/ 维度/ ,/ 以及/ 生成/ 可行/ 划分/ 策略/ 时/ 使用/ 的/ 排序/ 使用/ MBR/ ,/ 由于/ 相似/ 的/ 字符串/ 集合/ 的/ MBR/ 也/ 会/ 相似/ ,/ 通过/ MBR/ 划分/ 节点/ 中/ 的/ 索引/ 项/ 可以/ 将/ 相似/ 的/ 字符串/ 组织/ 到/ 相近/ 的/ 子树中/ ./ 不同/ 的/ Gram/ 可能/ 被/ 哈希/ 到/ 同一个/ Gram/ 向量/ 的/ 维度/ ,/ 而/ 被/ 视作/ 相同/ 的/ Gram/ ./ 在/ 查询处理/ 过程/ 中/ ,/ Bitmap/ 中/ 包含/ 的/ 更/ 精确/ 的/ Gram/ 信息/ 可以/ 用作/ 进一步/ 过滤/ 来/ 排除/ 不相干/ 的/ Gram/ ./ 算法/ 3/ ./ chooseSplitDimension/ ./ 输入/ :/ RM/ 树内/ 节点/ N/ 输出/ :/ 划分/ 维度/ dim1/ ./ fori/ =/ 1tod2/ ./ sortN/ / entryListon/ 〈/ MBR/ [/ d/ ]/ / low/ ,/ MBR/ [/ d/ ]/ / up/ 〉/ 3/ ./ forj/ =/ mtoM/ -/ m4/ ./ partitionN/ / entryListintop1/ ,/ p2Page65/ ./ cost/ =/ (/ MOverlap/ (/ p1/ ,/ p2/ )/ ,/ BSum/ (/ p1/ )/ +/ 6/ ./ choosejwithminimalcost7/ ./ cost/ [/ i/ ]/ =/ subcost/ [/ j/ ]/ 8/ ./ choosedimwithminimalcost9/ ./ returndim/ 算法/ 4/ 描述/ 了/ 叶子/ 节点/ 的/ 分裂/ 过程/ ,/ 与/ 内/ 节点/ 分裂/ 方法/ 类似/ ,/ RM/ 树/ 的/ 叶子/ 节点/ 分裂/ 时/ 同样/ 将/ 字符串/ 排序/ ,/ 然后/ 计算/ 可能/ 的/ 划分/ 策略/ 的/ 代价/ ,/ 最后/ 选择/ 代价/ 最小/ 的/ 划分/ 策略/ 进行/ 分裂/ 操作/ ./ 算法/ 4/ ./ splitLeaf/ ./ 输入/ :/ RM/ 树内/ 节点/ N/ 输出/ :/ 字符串/ 集合/ p1/ 和/ p21/ ./ dim/ =/ dimensionwithlargestlength2/ ./ sortstringsonthedim/ -/ thvalueofGramvector3/ ./ fori/ =/ mtoM/ -/ m4/ ./ partitionstringsintop1andp25/ ./ cost/ [/ i/ ]/ =/ 〈/ Area/ (/ p1/ )/ +/ Area/ (/ p2/ )/ ,/ BSum/ (/ p1/ )/ +/ 6/ ./ choosepartitionstrategyjwithminimalcost7/ ./ partitionstringsintop1andp2RM/ 树叶子/ 节点/ 的/ 分裂/ 过程/ 与/ 内/ 节点/ 分裂/ 过程/ 的/ 不同之处/ 在于/ :/ (/ 1/ )/ 在/ 选择/ 划分/ 维度/ 的/ 时候/ ,/ 叶子/ 节点/ 使用/ 长度/ 最长/ 的/ 维度/ 进行/ 划分/ ,/ 这/ 是因为/ 每个/ 字符串/ 都/ 是/ Gram/ 向量/ 空间/ 中/ 的/ 点/ ,/ 任何/ 维度/ 上/ 的/ 划分/ 都/ 能/ 将/ 叶子/ 节点/ 的/ MBR/ 分裂/ 成/ 两个/ 不/ 相交/ 的/ 划分/ ./ 选择/ 长度/ 最长/ 的/ 维度/ 划分/ ,/ 可以/ 得到/ 各个/ 维度/ 长度/ 更为/ 平衡/ 的/ 叶子/ 节点/ ./ (/ 2/ )/ 每种/ 划分/ 方法/ 的/ 代价/ 是/ 一个二元/ 组/ ,/ 由/ 新/ 生成/ 的/ 两个/ 叶子/ 的/ MBR/ 体积/ 之/ 和/ 以及/ Bitmap/ 中/ 1/ 的/ 数量/ 之/ 和/ 组成/ ./ 在/ 划分/ 过程/ 中/ 选择/ 产生/ 体积小/ 、/ Bitmap/ 中/ 1/ 的/ 数量/ 小/ 的/ 策略/ ,/ 有助于/ 提高/ 查询处理/ 过程/ 中/ 的/ 剪枝/ 能力/ ,/ 减少/ 查询处理/ 的/ I/ // O/ 代价/ ./ 4RM/ 树中/ 的/ 查询处理/ 算法/ 本/ 节/ 介绍/ RM/ 树中/ 的/ 查询处理/ 算法/ ./ 4.1/ 节/ 给出/ 字符串/ 相似性/ 查询/ 的/ 处理/ 算法/ ,/ 4.2/ 节/ 介绍/ 字符串/ 相似性/ 连接/ 的/ 处理/ 算法/ ./ 在/ 介绍/ 具体/ 查询处理/ 算法/ 前/ ,/ 本/ 节/ 首先/ 给出/ RM/ 树/ 使用/ 的/ 节点/ 过滤/ 方法/ ./ 图/ 2/ 描述/ 了/ RM/ 树/ 在/ 处理/ 字符串/ 相似性/ 操作/ 时/ ,/ 节点/ 过滤/ 的/ 功能/ 框架/ ./ 目标/ 字符串/ s/ 首先/ 被/ 转换成/ Gram/ 集合/ GS/ (/ s/ )/ ,/ 随后/ 生成/ s/ 的/ Gram/ 向量/ 犵/ 狏/ (/ s/ )/ 和/ BitmapB/ (/ s/ )/ ./ 对于/ 给定/ 的/ 编辑/ 距离/ 阈值/ θ/ ,/ RM/ 树/ 通过/ 3/ 个/ 过滤器/ 来/ 判断/ 以/ 给定/ 节点/ N/ 为根/ 的/ 子树/ TN/ 中/ 是否/ 可能/ 包含/ 字符串/ t/ ,/ 使得/ ED/ (/ s/ ,/ t/ )/ / θ/ ./ 3/ 种/ 过滤器/ 及其/ 使用/ 方法/ 如下/ :/ (/ 1/ )/ 长度/ 过滤器/ (/ LengthFilter/ )/ ,/ 记/ s/ 的/ 长度/ 为/ Ls/ ,/ TN/ 中/ 最/ 短/ 的/ 字符串/ 长度/ 为/ LLOWTN/ ,/ TN/ 中/ 最长/ 的/ 字符串/ 的/ 长度/ 为/ LUPTN/ ,/ 如果/ Ls/ </ LLOWTN/ -/ θ/ 或者/ Ls/ >/ LLOWTN/ +/ θ/ ,/ 则/ TN/ 中/ 所有/ 字符串/ 与/ s/ 的/ 编辑/ 距离/ 都/ 大于/ θ/ ./ (/ 2/ )/ Gram/ 向量/ 过滤器/ (/ GramVectorFilter/ )/ ,/ 由/ 定理/ 1/ 可知/ ,/ 如果/ 字符串/ s/ 与/ N/ 的/ Gram/ 距离/ 大于/ q/ ×/ θ/ ,/ 则/ TN/ 中/ 所有/ 字符串/ 与/ s/ 的/ 编辑/ 距离/ 都/ 大于/ θ/ ./ (/ 3/ )/ Bitmap/ 过滤器/ (/ BitmapFilter/ )/ ,/ 由/ 定理/ 2/ ,/ 如果/ 字符串/ s/ 与/ N/ 的/ Bitmap/ 距离/ 大于/ q/ ×/ θ/ ,/ 则/ TN/ 中/ 所有/ 字符串/ 与/ s/ 的/ 编辑/ 距离/ 都/ 大于/ θ/ ./ 通过/ 上述/ 3/ 种/ 过滤器/ ,/ RM/ 树/ 可以/ 判断/ 给/ 定子/ 树中/ 是否/ 可能/ 存在/ 与/ 目标/ 字符串/ 的/ 编辑/ 距离/ 不/ 大于/ θ/ 的/ 字符串/ ./ 算法/ 5/ ./ filter/ ./ 输入/ :/ 字符串/ s/ ,/ RM/ 树/ 节点/ N/ ,/ 编辑/ 距离/ 阈值/ θ/ 输出/ :/ 是否/ 通过/ 过滤器/ 1/ ./ if/ (/ Ls/ </ LLOW2/ ./ returnfalse3/ ./ if/ (/ DG/ (/ s/ ,/ N/ )/ >/ θ/ ×/ q/ )/ 4/ ./ returnfalse5/ ./ if/ (/ DB/ (/ s/ ,/ N/ )/ >/ θ/ ×/ q/ )/ 6/ ./ returnfalse7/ ./ returntrue/ 将/ Gram/ 向量/ 过滤器/ 与/ 节点/ N/ 的/ Bitmap/ 结合/ 使用/ ,/ 取得/ 优于/ 单独/ 使用/ Gram/ 向量/ 过滤器/ 时/ 的/ 过滤/ 效果/ ./ 首先/ 计算/ s/ 与/ 节点/ N/ 的/ Gram/ 向量/ 距离/ ,/ 记为/ Dist1/ ./ 随后/ ,/ 对于/ 目标/ 字符串/ s/ 的/ Gram/ 集合/ GS/ (/ s/ )/ 中/ 的/ 每个/ 元素/ g/ ,/ 如果/ Bitmap/ 中/ 对应/ 的/ 数值/ 为/ 0/ ,/ 而且/ s/ 的/ Gram/ 向量/ 犵/ 狏/ (/ s/ )/ 对应/ 的/ 位/ 的/ 数值/ 不/ 大于/ N/ 的/ MBR/ 中/ 对应/ 维度/ 的/ 上界/ ,/ 则/ Dist1/ 的/ 数值/ 加/ 1/ ./ 最后/ ,/ 如果/ Dist1/ 的/ 数值/ 大于/ q/ ×/ θ/ ,/ 则/ TN/ 中/ 不/ 包含/ 与/ s/ 的/ 编辑/ 距离/ 不/ 大于/ θ/ 的/ 字符串/ ./ 算法/ 5/ 用于/ 判断/ TN/ 中/ 是否/ 可能/ 存在/ 字符串/ t/ ,/ 使得/ ED/ (/ s/ ,/ t/ )/ / θ/ ,/ 不/ 可能/ 存在/ 时/ 返回/ false/ ./ 其中/ DG/ (/ s/ ,/ N/ )/ 为/ 使用/ 结合/ N/ 的/ Bitmap/ 的/ Gram/ 向量/ 过滤器/ 计算/ 而/ 得/ 的/ 数值/ ./ RM/ 树/ 的/ 过滤/ 功能/ 不会/ 随/ 字符串/ 长度/ 的/ 增加/ 而/ 减弱/ ./ 首先/ ,/ RM/ 树/ 使用/ 长度/ 过滤器/ ,/ 在/ 长/ 字符串/ 集合/ 中/ ,/ 字符串/ 长度/ 差异/ 较大/ ,/ 因此/ 长度/ 过滤器/ 效果/ 会/ Page7/ 更好/ ./ 其次/ ,/ RM/ 树/ 使用/ 的/ Gram/ 过滤器/ 在/ 长/ 字符串/ 组成/ 的/ 数据/ 集合/ 中/ 也/ 会/ 取得/ 更好/ 的/ 效果/ ,/ 这/ 是因为/ 不同/ 的/ Gram/ 向量/ 个数/ 增加/ 了/ ./ 4.1/ 字符串/ 相似性/ 查询处理/ 算法/ RM/ 树/ 支持/ 字符串/ 相似性/ 范围/ 查询/ 和/ top/ -/ k/ 查询/ ,/ 本/ 小节/ 首先/ 介绍/ RM/ 树/ 处理/ 字符串/ 相似性/ 范围/ 查询/ Q/ (/ s/ ,/ θ/ )/ 的/ 算法/ ,/ 然后/ 介绍/ 处理/ top/ -/ k/ 查询/ Q/ (/ s/ ,/ k/ )/ 的/ 算法/ ./ RM/ 树中/ 的/ 查询处理/ 算法/ 使用/ 先/ 过滤/ 后/ 验证/ 模式/ ,/ 算法/ 首先/ 找到/ 查询/ 结果/ 的/ 候选/ 字符串/ ,/ 然后/ 通过/ 计算/ 编辑/ 距离/ 来/ 验证/ 该/ 候选/ 字符串/ 是否/ 属于/ 查询/ 结果/ 集合/ ./ 算法/ 6/ ./ RangeQueryProcessing/ ./ 输入/ :/ RM/ 树内/ 节点/ N/ ,/ 字符串/ s/ ,/ 阈值/ θ/ 输出/ :/ 字符串/ 集合/ Result1/ ./ Result/ =/ / 2/ ./ if/ (/ Nisaninternalnode/ )/ 3/ ./ foriinN/ ./ childrenSet4/ ./ if/ (/ filter/ (/ s/ ,/ i/ ,/ θ/ )/ )/ 5/ ./ Result/ =/ Result/ ∪/ RangeQueryProcessing/ (/ i/ ,/ s/ ,/ θ/ )/ 6/ ./ else7/ ./ foriinN/ ./ dataSet8/ ./ if/ (/ ipassesfilter/ )/ 9/ ./ if/ (/ ED/ (/ i/ ,/ s/ )/ / θ/ )/ 10/ ./ Result/ =/ Result/ ∪/ {/ i/ }/ 11/ ./ returnResult4/ ./ 1.1/ 范围/ 查询处理/ 算法/ RM/ 树/ 的/ 范围/ 查询处理/ 从根/ 节点/ 开始/ ,/ 逐层/ 向下/ 选择/ 可能/ 包含/ 查询/ 结果/ 的/ 子树/ ,/ 最终/ 查找/ 到/ 包含/ 查询/ 结果/ 的/ 叶子/ 节点/ ,/ 并/ 验证/ 这些/ 叶子/ 节点/ 中/ 的/ 字符串/ 是否/ 属于/ 查询/ 结果/ 集合/ ./ 算法/ 6/ 描述/ 了/ RM/ 树/ 节点/ N/ 处理/ 范围/ 查询/ 的/ 过程/ ,/ 算法/ 6/ 调用/ 算法/ 5filter/ 来/ 排除/ 不/ 可能/ 包含/ 查询/ 结果/ 的/ 子树/ ./ 如果/ 节点/ N/ 是/ 一个/ 内/ 节点/ (/ 第/ 2/ 行/ )/ ,/ 算法/ 6/ 调用/ filter/ 方法/ 考察/ N/ 的/ 每个/ 儿子/ (/ 第/ 4/ 行/ )/ ,/ 排除/ 不/ 可能/ 含有/ 查询/ 结果/ 的/ 儿子/ 节点/ ./ 对于/ 可能/ 含有/ 查询/ 结果/ 的/ 儿子/ 节点/ ,/ 算法/ 6/ 递归/ 调用/ 自身/ ,/ 并/ 合并/ 结果/ (/ 第/ 4/ ~/ 5/ 行/ )/ ./ 如果/ N/ 是/ 一个/ 叶子/ 节点/ ,/ 则/ 算法/ 6/ 逐个/ 检查/ N/ 中/ 包含/ 的/ 字符串/ 是否/ 与/ 目标/ 字符串/ 拥有/ 足够/ 多/ 的/ 公共/ Gram/ (/ 第/ 8/ 行/ )/ ,/ 如果/ 是/ 则/ 计算/ 它们/ 之间/ 的/ 编辑/ 距离/ ,/ 并/ 返回/ 编辑/ 距离/ 不/ 大于/ 阈值/ θ/ 的/ 字符串/ (/ 第/ 9/ ~/ 10/ 行/ )/ ./ 根据/ 之前/ 介绍/ 的/ RM/ 树/ 使用/ 的/ 过滤器/ 的/ 功能/ 可知/ ,/ 在/ 根/ 节点/ 调用/ 算法/ 6/ 能/ 找到/ RM/ 树中/ 与/ 目标/ 字符串/ s/ 的/ 编辑/ 距离/ 不/ 大于/ 阈值/ θ/ 的/ 所有/ 字符串/ ./ 4.1/ ./ 2Top/ -/ k/ 查询处理/ 算法/ RM/ 树/ 处理/ 字符串/ top/ -/ k/ 查询/ 时/ 采用/ 分支/ 界限/ 策略/ ,/ 并/ 维护/ 长度/ 为/ k/ 的/ 结果/ 缓存/ ./ 假设/ 当前/ 结果/ 缓存/ ResultBuffer/ 中/ 保存/ 了/ 当前/ 搜索/ 到/ 的/ 与/ 字符串/ s/ 的/ 编辑/ 距离/ 最小/ 的/ k/ 个/ 结果/ ,/ top/ -/ k/ 查询处理/ 算法/ 确定/ 下/ 一步/ 需要/ 搜索/ 的/ 子树/ ,/ 并/ 在/ 其中/ 搜索/ 与/ s/ 的/ 编辑/ 距离/ 小于/ ED/ (/ s/ ,/ ResultBuffer/ [/ k/ ]/ )/ 的/ 字符串/ ,/ 若/ 找到/ 若干/ 满足条件/ 的/ 结果/ ,/ 查询处理/ 算法/ 更新/ ResultBuffer/ ,/ 并/ 开始/ 下/ 一轮/ 确定/ 子树及/ 搜索/ 过程/ ,/ 直到/ 未/ 被/ 搜索/ 过/ 的/ 子树/ 中/ 都/ 不/ 可能/ 包含/ 与/ s/ 的/ 编辑/ 距离/ 小于/ ED/ (/ s/ ,/ ResultBuffer/ [/ k/ ]/ )/ 为止/ ./ 算法/ 7/ 的/ Top/ -/ KQueryProcessing/ 描述/ 了/ RM/ 树/ 处理/ top/ -/ k/ 查询/ Q/ (/ s/ ,/ k/ )/ 的/ 过程/ ,/ RM/ 树/ 调用/ 在/ 根/ 节点/ 调用/ 算法/ 7/ 来/ 处理/ top/ -/ k/ 查询/ Q/ (/ s/ ,/ k/ )/ ,/ 其中/ root/ 是/ RM/ 树/ 的/ 根/ 节点/ ./ 算法/ 7/ ./ Top/ -/ KQueryProcessing/ ./ 输入/ :/ RM/ 树内/ 节点/ N/ ,/ 字符串/ s/ ,/ 整数/ k/ 输出/ :/ 字符串/ 集合/ R1/ ./ R/ =/ / 2/ ./ insertn/ ’/ childrenintomin/ -/ heapH3/ ./ while/ (/ H/ ≠/ / )/ 4/ ./ popminimalnfromH5/ ./ if/ (/ nisaninternalnode/ )/ 6/ ./ fori/ =/ 1tonumberofN/ ’/ schildren7/ ./ i/ ’/ skey/ =/ max/ {/ DG/ (/ s/ ,/ n/ )/ // θ/ ,/ DB/ (/ s/ ,/ n/ )/ // θ/ }/ 8/ ./ if/ (/ |/ R/ |/ </ korkey/ </ ED/ (/ s/ ,/ R/ [/ k/ ]/ )/ )/ 9/ ./ insertiintoHaccordingtokey10/ ./ else11/ ./ refineR/ ,/ Hwithstringsinn12/ ./ returnR/ 算法/ 7/ 中/ ,/ 1/ ~/ 2/ 行/ 初始化/ 结果/ 缓存/ R/ 和/ 最小/ 堆/ H/ ./ 其中/ R/ 用于/ 保存/ 当前/ 与/ 查询/ 目标/ 字符串/ s/ 编辑/ 距离/ 最小/ 的/ k/ 个/ 结果/ ;/ H/ 用于/ 保存/ 处理/ 查询/ 时/ 需要/ 访问/ 的/ RM/ 树/ 节点/ ./ H/ 不为/ 空时/ 算法/ 逐轮/ 运行/ (/ 3/ ~/ 4/ 行/ )/ ,/ 返回/ 结果/ ./ 如果/ 当前/ 处理/ 节点/ 为/ 内/ 节点/ ,/ 5/ ~/ 9/ 行/ 计算/ 每个/ 儿子/ 包含/ 的/ 字符串/ 与/ s/ 的/ 最小/ 编辑/ 距离/ ,/ 并/ 以此/ 为/ key/ ,/ 将/ 需要/ 访问/ 的/ 儿子/ 节点/ 插入/ 最小/ 堆/ H/ 中/ ./ 如果/ 当前/ 处理/ 节点/ 是/ 叶子/ 节点/ ,/ 算法/ (/ 10/ ~/ 11/ 行/ )/ 通过/ 叶子/ 节点/ 中/ 的/ 字符串/ 完善/ 当前/ top/ -/ k/ 结果/ ,/ 并/ 去除/ H/ 中/ 无需/ 访问/ 的/ 节点/ ./ 最后/ ,/ 在/ H/ 中/ 没有/ 节点/ 的/ 情况/ 下/ ,/ 算法/ 返回/ R/ ,/ 此时/ ,/ R/ 包含/ 了/ 以/ N/ 为根/ 的/ 子树/ 中/ 的/ top/ -/ k/ 查询处理/ 结果/ ./ 4.2/ 字符串/ 相似性/ 连接/ 算法/ 假设/ 两个/ 字符串/ 集合/ R/ ,/ S/ 被/ 存储/ 在/ 两个/ RM/ 树中/ ,/ 记为/ TR/ 和/ TS/ ./ RM/ 树/ 字符串/ 相似/ 连接/ 操作/ 从/ TR/ 和/ TS/ 的/ 根/ 节点/ 开始/ ,/ 递归/ 地/ 在/ 可能/ 产生/ 连接/ 结果/ 的/ 子树/ 之间/ 进行/ 连接/ 操作/ ./ 具体/ 执行/ 过程/ 由/ 算法/ 8/ 的/ Join/ 所/ 描述/ ,/ R/ 和/ S/ 之间/ 的/ 字符串/ 相似/ 连接/ 需要/ Page8/ 调用/ Join/ (/ TR/ ./ root/ ,/ TS/ ./ root/ ,/ θ/ )/ ./ 算法/ 8/ ./ Join/ ./ 输入/ :/ RM/ 树内/ 节点/ R/ 、/ S/ ,/ 编辑/ 距离/ 阈值/ θ/ 输出/ :/ 字符串/ 对/ 集合/ Result1/ ./ Result/ =/ / 2/ ./ if/ (/ R/ ,/ Sarebothinternalnodes/ )/ 3/ ./ foriinR/ ./ childrenSet/ ,/ jinS/ ./ childrenSet4/ ./ if/ (/ DG/ (/ i/ ,/ j/ )/ / θ/ ×/ qandDB/ / θ/ ×/ q/ )/ 5/ ./ Result/ =/ Result/ ∪/ Join/ (/ i/ ,/ j/ ,/ θ/ )/ 6/ ./ elseif/ (/ Risinternalnode/ )/ 7/ ./ foriinR/ ./ childrenSet8/ ./ if/ (/ DG/ (/ i/ ,/ S/ )/ / θ/ ×/ qandDB/ (/ i/ ,/ S/ )/ / θ/ ×/ q/ )/ 9/ ./ Result/ =/ Result/ ∪/ Join/ (/ i/ ,/ S/ ,/ θ/ )/ 10/ ./ elseif/ (/ Sisinternalnode/ )/ 11/ ./ forjinS/ ./ childrenSet12/ ./ if/ (/ DG/ (/ R/ ,/ j/ )/ / θ/ ×/ qandDB/ (/ R/ ,/ j/ )/ / θ/ ×/ q/ )/ 13/ ./ Result/ =/ Result/ ∪/ Join/ (/ i/ ,/ S/ ,/ θ/ )/ 14/ ./ else15/ ./ foriinR/ ./ dataSet/ ,/ jinS/ ./ dataSet16/ ./ if/ (/ (/ i/ ,/ j/ )/ passesfilter/ )/ 17/ ./ if/ (/ ED/ (/ i/ ,/ j/ )/ / θ/ )/ 18/ ./ Result/ =/ Result/ ∪/ {/ (/ i/ ,/ j/ )/ }/ 19/ ./ returnResult/ 算法/ 8/ 描述/ 了/ 以/ 节点/ R/ 和/ S/ 为根/ 的/ 子树/ 之间/ 进行/ 字符串/ 相似/ 连接/ 的/ 过程/ ,/ 针对/ R/ 和/ S/ 的/ 不同/ 节点/ 类型/ 进行/ 处理/ ./ 第/ 1/ 行/ 初始化/ 结果/ 集合/ Result/ 为/ 空集/ ./ 当/ R/ 和/ S/ 都/ 是/ 内/ 节点/ 的/ 时候/ (/ 2/ ~/ 5/ 行/ )/ ,/ 所有/ R/ 的/ 儿子/ 和/ S/ 的/ 儿子/ 组成/ 的/ 子树/ 对/ (/ i/ ,/ j/ )/ 都/ 被/ 检查/ ,/ 如果/ 可能/ 产生/ 连接/ 结果/ ,/ 即子/ 树/ i/ 和子/ 树/ j/ 中/ 存在/ 字符串/ 对/ (/ s/ ,/ r/ )/ ,/ 满足/ r/ ∈/ R/ ,/ s/ ∈/ S/ 且/ ED/ (/ s/ ,/ r/ )/ / θ/ ,/ 则/ 算法/ 递归/ 调用/ Join/ (/ i/ ,/ j/ ,/ θ/ )/ ,/ 并/ 将/ 递归/ 调用/ 的/ 结果/ 加入/ Result/ ./ 如果/ R/ 和/ S/ 中有/ 一个/ 为/ 内/ 节点/ ,/ 另/ 一个/ 为/ 叶子/ 节点/ (/ 6/ ~/ 13/ 行/ )/ ,/ 则/ 检查/ 内/ 节点/ 的/ 每个/ 儿子/ 和/ 叶/ 节点/ 组成/ 的/ 子树/ 对/ ,/ 如果/ 可能/ 产生/ 连接/ 结果/ ,/ 则/ 在/ 该子/ 树/ 对/ 中/ 递归/ 调用/ Join/ 算法/ 并/ 将/ 结果/ 加入/ 连接/ 结果/ 集合/ ./ 如果/ R/ 和/ S/ 都/ 是/ 叶子/ 节点/ (/ 14/ ~/ 18/ 行/ )/ ,/ 则/ 检查/ R/ 中/ 的/ 字符串/ 和/ S/ 中/ 的/ 字符串/ 组成/ 的/ 每/ 一个/ 字符串/ 对/ (/ r/ ,/ s/ )/ ,/ 如果/ r/ 和/ s/ 的/ 编辑/ 距离/ 可能/ 小于/ θ/ ,/ 则/ 计算/ r/ 和/ s/ 的/ 编辑/ 距离/ ,/ 如果/ ED/ (/ s/ ,/ r/ )/ / θ/ ,/ 字符串/ 对/ (/ r/ ,/ s/ )/ 被/ 加入/ 结果/ 集合/ Result/ ./ 算法/ 8/ 在/ 检查/ 两个/ 子树/ R/ 和/ S/ 是否/ 能/ 产生/ 连接/ 结果/ 时/ ,/ 计算/ R/ 和/ S/ 的/ Gram/ 向量/ 距离/ 和/ Bitmap/ 距离/ (/ 第/ 4/ 行/ ,/ 第/ 8/ 行/ ,/ 第/ 12/ 行/ )/ ,/ 并/ 根据/ 定理/ 1/ 和/ 定理/ 2/ 中/ 编辑/ 距离/ 和/ Gram/ 向量/ 距离/ 、/ Bitmap/ 距离/ 的/ 关系/ 进行/ 剪枝/ ,/ 排除/ 不/ 可能/ 生成/ 连接/ 结果/ 的/ 子树/ 对/ ./ 5RM/ 树/ 应用/ 扩展/ 本/ 节/ 介绍/ 使用/ 其它/ 字符串/ 相似性/ 度量/ 时/ ,/ RM/ 树/ 支持/ 各种/ 相似性/ 操作/ 的/ 方法/ ,/ 包括/ DiceSimilari/ -/ ty/ ,/ CosineSimilarity/ ,/ JarccardSimilarity/ 和/ Nor/ -/ malizedEditDistance/ ./ 给定/ 字符串/ s1/ 和/ s2/ 这些/ 字符串/ 相似性/ 度量/ 如下/ 所述/ :/ DICE/ (/ s1/ ,/ s2/ )/ =/ 2/ ×/ GS/ (/ s1/ )/ ∩/ GS/ (/ s2/ )/ COSINE/ (/ s1/ ,/ s2/ )/ =/ GS/ (/ s1/ )/ ∩/ GS/ (/ s2/ )/ JAD/ (/ s1/ ,/ s2/ )/ =/ GS/ (/ s1/ )/ ∩/ GS/ (/ s2/ )/ NED/ (/ s1/ ,/ s2/ )/ =/ ED/ (/ s1/ ,/ s2/ )/ 对于/ 上述/ 相似性/ 度量/ ,/ RM/ 树/ 的/ 使用/ 在/ 查询处理/ 过程/ 中/ 存在/ 区别/ ,/ 而/ 插入/ 过程/ 没有/ 区别/ ,/ 只/ 需/ 修改/ RM/ 树中/ 字符串/ 和/ 索引/ 节点/ 的/ 相似性/ 界限/ 估计/ 方法/ 即可/ ./ 对于/ DiceSimilarity/ ,/ 使用/ 目标/ 字符串/ 与/ 索引/ 节点/ MBR/ 和/ Bitmap/ 估计/ 分子/ 的/ 上界/ ,/ 而后/ 用/ s1/ 和/ s2/ 的/ 长度/ 估计/ 分母/ 的/ 下界/ ,/ 最终/ 计算/ 得到/ DiceSimilarity/ 的/ 上界/ ,/ 以此/ 作为/ 剪枝/ 的/ 依据/ ./ 其它/ 相似性/ 度量/ 的/ 估计/ 方法/ DiceSimilarity/ 类似/ ,/ RM/ 树中/ 节点/ 的/ MBR/ 、/ Bitmap/ 和/ 字符串/ 集合/ 长度/ 范围/ 使得/ RM/ 树/ 能够/ 支持/ 上述/ 相似性/ 度量/ ./ 6/ 性能/ 评价/ 和/ 分析/ 6.1/ 实验/ 设置/ 本/ 节/ 通过/ 实验/ 测试/ RM/ 树/ 的/ 性能/ ,/ 我们/ 用/ Java/ 语言/ 实现/ 了/ RM/ 树/ 索引/ 结构/ 以及/ 查询处理/ 算法/ ,/ JDK/ 版本/ 为/ Java/ (/ TM/ )/ SERuntimeEnvironment/ (/ build1/ ./ 6.0/ _/ 22/ -/ b04/ )/ ./ 实验/ 平台/ 为/ 一台/ PC机/ ,/ 配置/ 为/ 双核/ CPU/ ,/ 主频/ 2.93/ GHz/ ,/ 2GB/ 内存/ ,/ 320GB/ 硬盘/ ./ 实验/ 使用/ 的/ 真实/ 数据/ 从/ DBLP/ 数据/ 集合/ 中/ 提取/ ,/ 分别/ 为/ Title/ 数据/ 集/ 和/ Author/ 数据/ 集/ ./ 其中/ ,/ Title/ 数据/ 集中/ 包含/ 1644932/ 条/ 字符串/ 记录/ ,/ Author/ 数据/ 集/ 包含/ 967810/ 条/ 字符串/ ./ 对/ RM/ 树/ 的/ 性能/ 测试/ 内容/ 包括/ 查询处理/ 性能/ 和/ RM/ 树/ 维度/ 、/ Bitmap/ 长度/ 的/ 关系/ ,/ RM/ 树/ 处理/ 范围/ 查询/ 、/ top/ -/ k/ 查询/ 和/ 连接/ 操作/ 的/ 性能/ 以及/ 建立/ RM/ 树/ 的/ 时间/ 开销/ ./ 实验/ 部分/ 比较/ 了/ RM/ 树/ 和/ Bed/ 树/ 的/ 性能/ ,/ 其中/ Bed/ 树/ 使用/ GramCountingOrder/ ,/ 这是/ 由于/ GramCountingOrder/ 在/ 文献/ [/ 13/ ]/ 的/ 众多/ 测试/ 中/ 都/ 能/ 获得/ 较/ 好/ 的/ 性能/ ,/ 因此/ 本文/ 将/ 其/ 作为/ 比较/ 对/ Page9/ 象/ ./ 测试/ 过程/ 中/ 使用/ 的/ 参数/ 如表/ 3/ 所示/ ,/ 其中/ 粗体/ 的/ 数值/ 为/ 参数/ 默认值/ ,/ 测试/ 中/ Gram/ 的/ 长度/ 为/ 2/ ./ DistanceThreshold/ θ/ Top/ -/ kParameterkDimensionofMBR6/ ./ 2/ 维度/ 和/ Bitmap/ 长度/ 对/ 剪枝/ 能力/ 的/ 影响/ 本/ 部分/ 测试/ RM/ 树/ 的/ 性能/ 与/ RM/ 树/ 的/ MBR/ 维度/ 以及/ Bitmap/ 的/ 长度/ 之间/ 的/ 关系/ ,/ 通过/ 范围/ 查询/ 的/ 性能/ 评价/ 不同/ MBR/ 维度/ 和/ Bitmap/ 长度/ 组合/ ./ 实验/ 在/ Title/ 和/ Author/ 数据/ 集合/ 中/ 测试/ 了/ 维度/ 为/ 3/ 、/ 4/ 、/ 5/ ,/ Bitmap/ 长度/ 为/ 0/ 、/ 128/ 、/ 192/ 、/ 256/ 和/ 320/ 时/ ,/ 测试/ 了/ RM/ 树/ 处理/ 范围/ 查询/ 的/ I/ // O/ 代价/ ,/ 本/ 部分/ 实验/ 缓存/ 大小/ 设置/ 为/ 0/ ./ 图/ 3/ (/ a/ )/ ,/ (/ b/ )/ 和/ (/ c/ )/ 为/ Title/ 数据/ 集合/ 中/ ,/ RM/ 树/ 的/ 维度/ 分别/ 为/ 3/ ,/ 4/ 和/ 5/ 时/ ,/ 范围/ 查询处理/ 的/ I/ // O/ 代价/ ./ I/ // O/ 代价/ 的/ 大小/ 反映/ 了/ RM/ 树/ 在/ 处理/ 范围/ 查询/ 图/ 3/ 位图/ 长度/ 的/ 影响/ 图/ 3/ (/ d/ )/ ~/ (/ f/ )/ 给出/ 了/ Author/ 数据/ 集合/ 中/ ,/ 不同/ 维度/ 的/ RM/ 树/ ,/ 使用/ 不同/ 长度/ 的/ Bitmap/ 时/ 的/ 剪枝/ 能力/ ./ 从图/ 3/ (/ d/ )/ ~/ (/ f/ )/ 中/ 可见/ ,/ 在/ 各个/ 维度/ 的/ RM/ 树中/ 加入/ Bitmap/ 都/ 增加/ 了/ RM/ 树/ 的/ 剪枝/ 能力/ ,/ 这是/ 由于/ Author/ 数据/ 集合/ 中/ 的/ 字符串/ 由/ 名字/ 组成/ ,/ RM/ 树/ 的/ 叶子/ 中/ 含有/ 不同/ 的/ Gram/ 数量/ 较/ 少/ ,/ 故较/ 短/ 的/ Bitmap/ 也/ 可以/ 增加/ RM/ 树/ 的/ 剪枝/ 能力/ ./ 对于/ Title/ 和/ Author/ 两个/ 数据/ 集合/ ,/ 我们/ 选出/ 3/ 维/ 、/ 4/ 维和/ 5/ 维/ 性能/ 最好/ 的/ RM/ 树/ 进行/ 比较/ ,/ 以/ 此时/ 的/ 剪枝/ 能力/ ,/ I/ // O/ 代价/ 越小/ ,/ 剪枝/ 能力/ 越强/ ./ 如图/ 3/ (/ a/ )/ 所示/ ,/ 3/ 维/ 的/ RM/ 树/ 在/ Bitmap/ 长度/ 增加/ 时/ ,/ 剪枝/ 能力/ 没有/ 提高/ ,/ 反而/ 略有/ 下降/ ./ 这/ 是因为/ RM/ 树/ 的/ 维度/ 过低/ ,/ 导致/ 过多/ 的/ 字符串/ 具有/ 相同/ 的/ Gram/ 向量/ ,/ 因此/ 在/ 同一个/ 叶子/ 节点/ 中/ ,/ 存在/ 不同/ Gram/ 的/ 个数/ 较大/ ,/ 这/ 使得/ Bitmap/ 的/ 过滤/ 能力/ 大幅/ 下降/ 甚至/ 失效/ ./ 因此/ ,/ 3/ 维/ 的/ RM/ 树中/ ,/ 加入/ Bitmap/ 导致/ 节点/ 中/ 包含/ 条目/ 数量/ 的/ 降低/ ,/ 从而/ 降低/ 了/ 索引/ 的/ 效率/ ./ 从图/ 3/ (/ b/ )/ 中/ 可见/ ,/ 在/ 4/ 维/ 的/ RM/ 树中/ 增加/ Bitmap/ 的/ 长度/ ,/ 剪枝/ 能力/ 先/ 降低/ 后/ 增长/ ,/ 并/ 在/ Bitmap/ 长度/ 为/ 256/ 时/ 取得/ 最优/ 的/ 剪枝/ 能力/ ./ 这是/ 由于/ 4/ 维/ 的/ RM/ 树中/ ,/ 叶子/ 节点/ 包含/ 的/ 不同/ Gram/ 数量/ 大/ 多少/ 于/ 200/ 个/ ,/ 因此/ 长度/ 256/ 的/ Bitmap/ 可以/ 提供/ 较/ 好/ 的/ 剪枝/ 能力/ ./ 长度/ 为/ 128/ 、/ 192/ 的/ Bitmap/ 由于/ 剪枝/ 能力/ 不足/ ,/ 又/ 降低/ 了/ 内/ 节点/ 中/ 索引/ 条/ 目的/ 个数/ ,/ 导致/ 了/ 索引/ 效率/ 的/ 降低/ ./ 长度/ 320/ 的/ Bitmap/ 具有/ 更/ 高/ 的/ 剪枝/ 能力/ ,/ 但是/ 过多地/ 降低/ 了/ 内/ 节点/ 的/ 度/ ,/ 因此/ 效率/ 低于/ 长度/ 256/ 的/ Bitmap/ ,/ 但是/ 由于/ 其它/ 长度/ 的/ Bitmap/ ./ 图/ 3/ (/ c/ )/ 中/ 所示/ 内容/ 与/ (/ b/ )/ 相似/ ./ 确定/ 后续/ 实验/ 使用/ 的/ RM/ 树/ 维度/ 和/ Bitmap/ 长度/ ./ 如图/ 4/ (/ a/ )/ 所示/ ,/ 在/ Title/ 数据/ 集合/ 中/ 构建/ 的/ 3/ 维/ 、/ 4/ 维和/ 5/ 维/ 的/ RM/ 树/ ,/ 取得/ 最好/ 性能/ 的/ Bitmap/ 长度/ 分别/ 为/ 320/ 、/ 256/ 和/ 256/ ./ 通过/ 比较/ 3/ 种/ 组合/ 可见/ ,/ 4/ 维/ 的/ RM/ 树/ 使用/ 长度/ 为/ 256/ 的/ Bitmap/ 可以/ 获得/ 最好/ 的/ 剪枝/ 效果/ ./ 类似/ 的/ ,/ 图/ 4/ (/ b/ )/ 中/ 列出/ 了/ Author/ 中/ 3/ 维/ 、/ 4/ 维和/ 5/ 维/ 的/ 性能/ 最好/ 的/ RM/ 树/ ,/ 其中/ 4/ 维/ RM/ 树/ 使用/ 长度/ 为/ 256/ 的/ Bitmap/ 可以/ 取得/ 最好/ 的/ 剪枝/ 效果/ ./ 在/ 后续/ 实验/ 中/ ,/ RM/ 树/ 的/ 维度/ 和/ BitmapPage10/ 长度/ 分别/ 确定/ 为/ 4/ 和/ 256.6/ ./ 3/ 范围/ 查询/ 性能/ 分析/ 本/ 部分/ 测试/ RM/ 树/ 处理/ 范围/ 查询/ 的/ I/ // O/ 代价/ 和/ 时间/ 代价/ ,/ 从/ Title/ 和/ Author/ 中/ 随机/ 抽取/ 100/ 个/ 字符串/ 作为/ 查询/ 目标/ ,/ 并/ 计算/ 查询处理/ 的/ 平均/ I/ // O/ 代价/ 和/ 时间/ 开销/ ./ 如图/ 5/ 所示/ ,/ RM/ 树/ 处理/ 范围/ 查询/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ 随/ 编辑/ 距离/ 阈值/ 的/ 增加/ 而/ 增加/ ./ 在/ Title/ 和/ Author/ 中/ 的/ 实验/ 表明/ ,/ 与/ Bed/ 树/ 相比/ ,/ RM/ 树/ 具有/ 更好/ 的/ 剪枝/ 能力/ ,/ 减少/ 了/ 索引/ 节点/ 访问/ 次数/ ,/ 有效/ 地/ 降低/ 了/ I/ // O/ 代价/ 并/ 减少/ 了/ 查询处理/ 时间/ 开销/ ,/ 查询处理/ 延时/ 降低/ 了/ 25/ %/ ~/ 59/ %/ ./ 图/ 5/ 范围/ 查询/ 性能/ 与/ 编辑/ 距离/ 的/ 关系/ (/ 16MBbuffer/ )/ 图/ 6/ 中/ 列出/ 了/ RM/ 树/ 处理/ 范围/ 查询/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ 与/ 缓存/ 大小/ 的/ 关系/ ,/ 其中/ 编辑/ 距离/ 阈值/ 为/ 2/ ./ I/ // O/ 代价/ 和/ 时间/ 开销/ 随/ 缓存/ 的/ 增加/ 而/ 减少/ ,/ 并/ 在/ 缓存/ 大小/ 达到/ 256MB/ 时/ 显著/ 减小/ ./ 这是/ 由于/ 缓存/ 页面/ 减少/ 了/ 磁盘/ 读取/ 次数/ ,/ 因此/ 也/ 降低/ 了/ 时间/ 开销/ ./ 从图/ 6/ (/ a/ )/ ~/ (/ d/ )/ 可见/ ,/ RM/ 树/ 在/ 不同/ 缓存/ 大小/ 情况/ 下/ ,/ 性能/ 都/ 优于/ Bed/ 树/ ./ 对比/ Title/ 和/ Author/ 对应/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ 可见/ ,/ 时间/ 开销/ 降低/ 幅度/ 小于/ I/ // O/ 代价/ ./ 原因/ 为/ 加大/ 缓存/ 可以/ 降低/ 磁盘/ 读取/ 次数/ ,/ 但是/ 不能/ 减少/ 编辑/ 距离/ 的/ 计算/ 次数/ ,/ 因此/ 时间/ 开销/ 不能/ 获得/ 与/ I/ // O/ 代价/ 同/ 幅度/ 的/ 降低/ ./ 6.4/ Top/ -/ 犽/ 查询/ 性能/ 分析/ 本/ 部分/ 测试/ RM/ 树/ 处理/ top/ -/ k/ 查询/ 的/ 效率/ ,/ 实验/ 从/ Title/ 和/ Author/ 中/ 随机/ 抽取/ 100/ 个/ 字符串/ 作为/ 查询/ 目标/ ,/ 并/ 测试/ 参数/ k/ 的/ 值/ 为/ 1/ 、/ 2/ 、/ 4/ 、/ 8/ ,/ 缓存/ 大小/ 为/ 16MB/ 时/ ,/ 查询处理/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ ./ 如图/ 7/ 所示/ ,/ 在/ Title/ 中/ 建立/ 的/ RM/ 树/ 在/ 回答/ top/ -/ k/ 查询/ 时/ ,/ k/ =/ 1/ 的/ 查询处理/ 代价/ 小于/ 其它/ 情况/ ,/ 而/ k/ 的/ 取值/ 为/ 2/ 、/ 4/ 、/ 8/ 时/ ,/ 处理/ 代价/ 基本/ 不变/ ./ 这是/ 由于/ Title/ 数据/ 集合/ 中/ ,/ 字符串/ 之间/ 相差/ 较大/ ,/ 选取/ top/ -/ 2/ 、/ top/ -/ 4/ 和/ top/ -/ 8/ 的/ 字符串/ 集合/ 也/ 会/ 访问/ 很多/ 索引/ 节点/ ./ 在/ Author/ 数据/ 集合/ 上/ 的/ 测试/ 结果/ 与/ Title/ 数据/ 集合/ 中/ 的/ 测试/ 结果/ 相似/ ,/ k/ 取值/ 从/ 2/ ~/ 8/ 时/ ,/ 查询处理/ 代价/ 都/ 保持稳定/ ./ 这/ 是因为/ Author/ 数据/ 集合/ 中/ ,/ 字符串/ 长度/ 差距/ 较/ 小/ ,/ 导致/ 与/ 目标/ 字符串/ 具有/ 相似/ Gram/ 向量/ 的/ 字符串/ 大量/ 存在/ ,/ 因此/ top/ -/ k/ 查询/ 在/ k/ 较/ 小/ 的/ 时候/ 也/ 会/ 访问/ 大量/ 索引/ 节点/ 以/ 获取/ 足够/ 的/ 字符串/ 进行/ 剪枝/ ./ 由于/ 树/ 剪枝/ 能力/ 不及/ RM/ 树/ ,/ 在/ k/ 的/ 取值/ 变化/ 时/ ,/ Bed/ 树/ 处理/ top/ -/ k/ 查询/ 的/ 效率/ 在/ Title/ 和/ Author/ 两个/ 数据/ 集合/ 上/ 都/ 不及/ RM/ 树/ ./ 在/ 真实/ 的/ 数据/ 集合/ 中/ ,/ 与/ Bed/ 树/ 相比/ ,/ RM/ 树/ 降低/ 了/ 21/ %/ ~/ 39/ %/ 的/ 查询处理/ 延时/ ./ 图/ 8/ 给出/ 了/ RM/ 树/ 处理/ top/ -/ k/ 查询/ 的/ 代价/ 与/ 缓存/ 大小/ 的/ 关系/ ,/ 其中/ 参数/ k/ 的/ 值/ 为/ 4/ ./ RM/ 树/ 和/ Bed/ 树/ 处理/ top/ -/ k/ 查询/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ 都/ 随/ 缓存/ 的/ 增加/ 而/ 减少/ ./ Title/ 数据/ 集合/ 中/ 的/ top/ -/ k/ 处理/ I/ // O/ 代价/ 大于/ Author/ 数据/ 集合/ 中/ 的/ I/ // O/ 代价/ ,/ 这是/ 由于/ Title/ 中/ 不同/ 字符串/ 相差/ 更大/ ,/ 获取/ k/ 个/ 最/ 相似/ 的/ 字符串/ 需要/ 访问/ 更/ 多/ 的/ 索引/ 节点/ ,/ 造成/ 更大/ 的/ I/ // O/ 代价/ ./ 时间/ 开销/ 的/ 降低/ 幅度/ 不及/ I/ // O/ 代价/ 的/ 降低/ 幅度/ ,/ 这/ 也/ 是因为/ 增加/ 缓存/ 只能/ 降低/ I/ // O/ 代价/ ,/ 而/ 无法/ 降低/ 字符串/ 之间/ 编辑/ 距离/ 的/ 计算/ 次数/ ./ Page11/ 图/ 7Top/ -/ k/ 查询处理/ 性能/ 与/ k/ 值/ 大小/ 的/ 关系/ (/ 16MBbuffer/ )/ 图/ 8Top/ -/ k/ 查询处理/ 性能/ 与/ 缓存/ 大小/ 的/ 关系/ 6.5/ 连接/ 操作/ 性能/ 分析/ 本/ 部分/ 测试/ RM/ 树/ 处理/ 字符串/ 相似性/ 连接/ 的/ 效率/ ,/ 缓存/ 大小/ 设为/ 16MB/ ./ 直接/ 使用/ Title/ 和/ Author/ 进行/ 相似性/ 连接/ 会/ 产生/ 过多/ 的/ 连接/ 结果/ (/ 与/ 原始数据/ 同/ 量级/ )/ ,/ 为了/ 控制/ 生成/ 结果/ 的/ 大小/ ,/ 本/ 部分/ 实验/ 使用/ 的/ 数据/ 集合/ 为/ Title/ 和/ Author/ 的/ 子集/ ./ 实验/ 分别/ 从/ Title/ 和/ Author/ 中/ 抽取/ 的/ 105/ 条/ 字符串/ 与/ 5/ ×/ 105/ 条/ 字符串/ ,/ 作为/ 测试数据/ ./ 如图/ 9/ 所示/ ,/ 在/ Title/ 和/ Author/ 中/ ,/ 随着/ 编辑/ 距离/ 阈值/ 的/ 增加/ ,/ RM/ 图/ 9/ 连接/ 操作/ 性能/ 与/ 编辑/ 距离/ 的/ 关系/ (/ 16MBbuffer/ )/ 树/ 和/ Bed/ 树/ 处理/ 字符串/ 相似性/ 连接/ 操作/ 的/ 时间/ 开销/ 也/ 增加/ ./ 在/ Title/ 和/ Author/ 中/ 的/ 测试/ 结果显示/ ,/ RM/ 树/ 在/ 处理/ 连接/ 操作/ 时/ ,/ 性能/ 优于/ Bed/ 树/ ,/ RM/ 树/ 降低/ 了/ 29/ %/ ~/ 41/ %/ 的/ 查询处理/ 延时/ ./ 6.6/ 索引/ 构件/ 时间/ 本/ 部分/ 测试/ 了/ RM/ 树/ 索引/ 构建/ 时间/ ,/ 分别/ 测试/ 了/ 不同/ 缓存/ 大小/ 情况/ 下/ ,/ 使用/ Title/ 和/ Author/ 两个/ 数据/ 集合/ 构建/ RM/ 树/ 的/ 时间/ 开销/ ./ 其中/ ,/ Title/ 数据/ 集中/ 包含/ 1644932/ 条/ 字符串/ 记录/ ,/ Author/ 数据/ 集/ 包含/ 967810/ 条/ 字符串/ ./ 如图/ 10/ 所示/ ,/ RM/ 树/ 在/ Title/ 和/ Author/ 中/ 的/ 构建/ 时间/ 都/ 长于/ Bed/ 树/ 的/ 构建/ 时间/ ./ 通过/ 加大/ 缓存/ ,/ 可以/ 减少/ RM/ 树/ 的/ 构建/ 时间/ ,/ 但是/ 减小/ 的/ 幅度/ 小于/ Bed/ 树/ 的/ 减小/ 幅度/ ,/ 这/ 是因为/ RM/ 树/ 在/ 插入/ 节点/ 选择/ 、/ 节点/ 划分/ 过程/ 中/ 需要/ 大量/ 计算/ ,/ 加大/ 缓存/ 只能/ 减少/ 磁盘/ 读取/ 时间/ ,/ 无法/ 减少/ 计算/ 时间/ ./ Bed/ 树/ 构建/ 过程/ 中/ 计算/ 次数/ 远/ 小于/ RM/ 树/ ,/ 因此/ 可以/ 通过/ 加大/ 缓存/ 的/ 方法/ 有效/ 地/ 减少/ 构建/ 时间/ 开销/ ./ 虽然/ RM/ 树/ 的/ 构建/ 时间/ 长于/ Bed/ 树/ ,/ 但是/ RM/ 树/ 在/ 处理/ 查询/ 和/ 连接/ 操作/ 时/ ,/ 效率/ 均/ 优于/ Bed/ 树/ ,/ 因此/ 一次性/ 的/ 构建/ 过程/ 不/ 影响/ RM/ 树/ 的/ 有效性/ ./ 图/ 10/ 索引/ 构建/ 性能/ 与/ 缓存/ 大小/ 的/ 关系/ (/ 16MBbuffer/ )/ 6.7/ 合成/ 数据/ 上/ 的/ 测试/ 结果/ 本文/ 在/ 人工合成/ 的/ 数据/ 集合/ 中/ 测试/ 了/ RM/ 树/ 的/ 性能/ ./ 人工合成/ 数据/ 集合/ 包括/ Author/ 和/ Title/ 中/ 的/ 字符串/ ,/ 以及/ 随机/ 修改/ 其中/ 字符串/ 内容/ 所得/ 的/ 合成/ 数据/ ./ 对/ Author/ 和/ Title/ 中/ 的/ 每个/ 字符串/ ,/ 我们/ 随机/ 修改/ 若干/ 字符/ ,/ 生成/ 与/ 原有/ 字符串/ 的/ 编辑/ 距离/ 为/ 1/ ~/ 5/ 的/ 合成/ 数据/ ./ 合成/ 数据/ 的/ 大小/ 是/ 原有/ 数据/ 大小/ 的/ 6/ 倍/ ,/ 在/ 合成/ 数据/ 上/ 建立/ 的/ 索引/ 大小/ 为/ 3.1/ GB/ ,/ 超过/ 了/ 内存/ 的/ 大小/ ./ 本/ 部分/ 实验/ 使用/ 的/ 缓存/ 大小/ 为/ 16MB/ ./ 由图/ 11/ 可见/ ,/ RM/ 树/ 在/ 合成/ 数据/ 集合/ 中/ 处理/ 范围/ 查询/ 的/ I/ // O/ 开销/ 和/ 时间/ 代价/ 随/ 编辑/ 距离/ 增加/ 而/ 变大/ ./ 增加/ 编辑/ 距离/ 阈值/ 导致/ 更/ 多/ 的/ 索引/ 节点/ 被/ 访问/ ,/ 这/ 与/ 真实/ 数据/ 集合/ 上/ 的/ 实验/ 结果/ 一致/ ./ 图/ 12/ 描述/ 了/ RM/ 树/ 在/ 合成/ 数据/ 集合/ 中/ 处理/ top/ -/ k/ 查询/ 的/ 性能/ ./ RM/ 树/ 处理/ top/ -/ k/ 查询/ 的/ I/ // O/ 代价/ 和/ 时间/ 开销/ 随/ 查询/ 参数/ k/ 增长/ ./ 当/ k/ 的/ 取值/ 在/ 1/ ~/ 4/ 时/ ,/ 查询/ 代/ Page12/ 价/ 增长/ 非常/ 缓慢/ ./ 当/ k/ 的/ 取值/ 为/ 8/ 时/ ,/ 查询/ 代价/ 显著/ 大于/ k/ 值为/ 1/ ,/ 2/ 和/ 4/ 时/ 的/ 查询/ 代价/ ./ 这是/ 由于/ 合成/ 数据/ 集合/ 中/ ,/ 对于/ 每个/ 字符串/ s/ ,/ 都/ 存在/ 与/ 之/ 编辑/ 距离/ 为/ 0/ ~/ 5/ 的/ 字符串/ 数据/ ./ 因此/ ,/ 获取/ 与/ 之/ 最近/ 的/ 1/ 个/ ,/ 2/ 个/ 和/ 4/ 个/ 字符串/ 不/ 需要/ 访问/ 大量/ 节点/ ,/ 而/ 只/ 需/ 访问/ 与/ s/ 存储/ 位置/ 相近/ 的/ 叶子/ 节点/ 即可/ ./ 当/ k/ =/ 8/ 时/ ,/ 查询/ 结果/ 中/ 包含/ 与/ s/ 的/ 编辑/ 距离/ 较大/ 的/ 字符串/ ,/ 因此/ 查询处理/ 将/ 访问/ 大量/ 的/ 索引/ 节点/ ,/ 造成/ 较大/ 的/ 查询/ 代价/ ./ 如图/ 11/ 和/ 图/ 12/ 所示/ ,/ 在/ 人工合成/ 数据/ 集合/ 中/ ,/ RM/ 树/ 的/ 性能/ 也/ 优于/ Bed/ 树/ ,/ 降低/ 了/ 查询/ 的/ I/ // O/ 代价/ ,/ 并/ 减少/ 了/ 35/ %/ ~/ 50/ %/ 的/ 时间/ 开销/ ./ 图/ 12Top/ -/ k/ 查询处理/ 性能/ 与/ k/ 值/ 大小/ 的/ 关系/ 7/ 相关/ 工作/ 现有/ 研究/ 工作/ 设计/ 了/ 多种/ 字符串/ 相似性/ 度量/ 指标/ ,/ 并/ 基于/ 这些/ 度量/ 指标/ 进行/ 字符串/ 相似性/ 操作/ ./ 本文/ 主要/ 使用/ 编辑/ 距离/ 度量/ 字符串/ 的/ 相似性/ ,/ 因为/ 它/ 不/ 需要/ 对/ 语言/ 理解/ 的/ 直观/ 度量/ ./ 文献/ [/ 1/ ]/ 设计/ 了/ 计算/ 两个/ 字符串/ s1/ 和/ s2/ 之间/ 编辑/ 距离/ 的/ 算法/ ,/ 其/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ 都/ 是/ O/ (/ |/ s1/ |/ |/ s2/ |/ )/ ,/ |/ s1/ |/ 和/ |/ s2/ |/ 分别/ 为/ 字符串/ s1/ 和/ s2/ 的/ 长度/ ./ 其/ 后续/ 研究/ 工作/ 将/ 提高/ 计算/ 编辑/ 距离/ 的/ 效率/ 或者/ 通过/ 近似计算/ 降低/ 时间/ 代价/ [/ 2/ -/ 4/ ]/ ./ 现有/ 基于/ 编辑/ 距离/ 的/ 字符串/ 相似性/ 操作/ 的/ 工作/ 主要/ 使用/ q/ -/ Gram/ 和/ 倒排/ 索引/ 结构/ ,/ 将/ 字符串/ 相似性/ 转换/ 为/ 两个/ Gram/ 集合/ 的/ 相似性/ ./ 这些/ 工作/ 针对/ 相似性/ 查询/ 和/ 相似性/ 连接/ 操作/ ,/ 使用/ filter/ -/ verify/ 框架/ ./ 它们/ 首先/ 通过/ 过滤/ 技术/ 构建/ 结果/ 候选/ 集合/ ,/ 然后/ 计算/ 相应/ 的/ 编辑/ 距离/ ,/ 得到/ 最后/ 的/ 结果/ ./ 文献/ [/ 5/ ]/ 针对/ 字符串/ 相似性/ 连接/ 操作/ ,/ 提出/ 了/ counting/ -/ filter/ 、/ positional/ -/ filter/ 和/ length/ -/ filter/ 技术/ ,/ 用于/ 识别/ 连接/ 操作/ 的/ 候选/ 集/ ./ 其它/ 过滤/ 技术/ 包括/ prefix/ -/ filter/ [/ 8/ ]/ ,/ mismatch/ -/ filter/ [/ 9/ ]/ 等/ ./ 文献/ [/ 6/ -/ 7/ ]/ 使用/ 堆来/ 合并/ 多个/ Gram/ 对应/ 的/ 倒排/ 链表/ ,/ 从中/ 选取/ 相似性/ 操作/ 结果/ 的/ 候选/ 集合/ ./ 文献/ [/ 10/ ]/ 通过/ 去除/ 部分/ Gram/ 的/ 倒排/ 链表/ 并/ 改变/ 过滤/ 条件/ 来/ 减少/ 空间/ 代价/ ./ 文献/ [/ 11/ ]/ 研究/ 字符串/ 索引/ 的/ 增量/ 式/ 更新/ 方法/ ./ 以上/ 方法/ 在/ 处理/ 大量/ 字符串/ 数据/ 时/ ,/ 有/ 以下/ 劣势/ :/ (/ 1/ )/ 空间/ 代价/ 巨大/ ,/ Gram/ 对应/ 的/ 倒/ 排表/ 大小/ 与/ 原始数据/ 大小/ 相当/ ;/ (/ 2/ )/ 更新/ 代价/ 大/ ,/ 对/ 一个/ 字符串/ 的/ 更新/ 引起/ 多个/ Gram/ 链表/ 的/ 更新/ ./ (/ 3/ )/ 支持/ 查询/ 类型/ 有限/ ,/ 无法/ 直接/ 支持/ top/ -/ k/ 等/ 复杂/ 查询/ ./ 与/ 上述/ 工作/ 不同/ ,/ 本文/ 设计/ 的/ RM/ 树/ 在/ 磁盘/ 上/ 索引/ 字符串/ 数据/ ,/ 支持/ 多种/ 字符串/ 相似性/ 操作/ ,/ 减少/ 了/ 数据/ 更新/ 代价/ ,/ 并/ 避免/ 了/ 存储/ Gram/ 对应/ 的/ 倒/ 排表/ 所/ 需/ 昂贵/ 的/ 存储/ 代价/ ./ 现有/ 处理/ 字符串/ 相似性/ 操作/ 的/ 树形/ 索引/ 包括/ MHR/ 树/ [/ 12/ ]/ 和/ Bed/ 树/ [/ 13/ ]/ ./ 其中/ ,/ MHR/ 树/ 用于/ 处理/ 谓词/ 中/ 包括/ 空间/ 条件/ 和/ 字符串/ 相似性/ 条件/ 的/ 搜索/ ./ MHR/ 树/ 在/ R/ 树/ 节点/ 中/ 加入/ 字符串/ 集合/ 的/ Min/ -/ Hash/ 签名/ ,/ 支持/ 近似/ 地/ 空间/ 字符串/ 相似性/ 搜索/ ,/ 并/ 可以/ 估计/ 查询/ 的/ 选择/ 度/ 大小/ ./ 文献/ [/ 13/ ]/ 提出/ 了/ Bed/ 树/ ,/ Bed/ 树/ 将/ 字符串/ 排序/ 后/ 存储/ 在/ B/ +/ 树中/ ,/ 减少/ 了/ q/ -/ Gram/ 结合/ 倒排/ 索引/ 引起/ 的/ 空间/ 代价/ 和/ 更新/ 代价/ ,/ 并/ 能/ 支持/ 多种/ 相似性/ 操作/ ./ 然而/ ,/ 一维/ 的/ 排序/ 无法/ 有效/ 的/ 将/ 字符串/ 按照/ 相似性/ 聚类/ ,/ 不能/ 有效/ 减少/ 查询处理/ 的/ I/ // O/ 代价/ ./ 本文/ 设计/ RM/ 树/ ,/ 通过/ 字符串/ 的/ Gram/ 向量/ 进行/ 聚类/ ,/ 并/ 使用/ 节点/ 中/ 存储/ 的/ Bitmap/ 进一步/ 过滤/ ,/ 以此/ 减少/ 字符串/ 相似性/ 操作/ 的/ I/ // O/ 代价/ ./ 8/ 结论/ 本文/ 提出/ 了/ 一种/ 支持/ 字符串/ 相似性/ 处理/ 的/ 树形/ 索引/ RM/ 树/ ,/ RM/ 树/ 通过/ 字符串/ 的/ Gram/ 向量/ 将/ 相似/ 的/ 字符串/ 组织/ 到/ 相近/ 的/ 叶子/ 节点/ 中/ ,/ 并/ 使用/ 位/ 图/ 作为/ 过滤/ 工具/ ,/ 能够/ 有效/ 地/ 支持/ 字符串/ 相似性/ 范围/ 查询/ 、/ top/ -/ k/ 查询/ 和/ 相似性/ 连接/ 操作/ ./ 本文/ 给出/ 了/ RM/ 树/ 的/ 构建/ 方法/ 、/ 范围/ 查询处理/ 、/ top/ -/ k/ 查询处理/ 和/ 连接/ 处理/ 算法/ ./ 在/ 真实/ 数据/ 上/ 的/ 实验/ 结果表明/ ,/ 与/ Bed/ 树/ 相比/ ,/ RM/ 树/ 在/ 处理/ 各种/ 字符串/ 范围/ 查询/ 、/ top/ -/ k/ 查询/ 和/ 连接/ 操作/ 时/ 有效/ 地/ 降低/ 了/ 磁盘/ I/ // O/ 操作/ 次数/ ,/ 并/ 分别/ 将/ 时间/ 开销/ 降低/ 了/ 25/ %/ ~/ 59/ %/ 、/ 21/ %/ ~/ 39/ %/ 和/ 29/ %/ ~/ 41/ %/ ./ 在/ 人工合成/ 的/ 数据/ 集合/ 上/ ,/ 与/ Bed/ 树/ 相比/ ,/ RM/ 树/ 减少/ 了/ 35/ %/ ~/ 50/ %/ 的/ 查询处理/ 时间/ 开销/ ./ 真实/ 数据/ 集合/ 和/ 人工合成/ 数据/ 集合/ 中/ 的/ 实验/ 结果/ 验证/ 了/ RM/ 树/ 的/ 有效性/ ./ Page13/ 

