Page1/ 洋葱/ 路由/ 追踪/ 技术/ 中/ 时间/ 特征/ 的/ 建模/ 与/ 分析/ 何/ 高峰/ 1/ )/ 杨明/ 1/ )/ 罗军舟/ 1/ )/ 张璐/ 1/ )/ 马媛媛/ 2/ )/ 1/ )/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 211189/ )/ 2/ )/ (/ 中国/ 电力/ 科学/ 研究院/ 南京/ 211106/ )/ 摘要/ 针对/ 洋葱/ 路由/ 匿名/ 通信/ 机制/ ,/ 现有/ 研究/ 工作/ 提出/ 了/ 多种/ 基于/ 时间/ 特征/ 的/ 追踪/ 技术/ 方案/ ,/ 但/ 对/ 如何/ 从/ 理论/ 上/ 解释/ 时间/ 特征/ 可/ 用于/ 追踪/ 的/ 原因/ ,/ 以及/ 如何/ 确定/ 为/ 形成/ 特定/ 时间/ 特征/ 所/ 需/ 调制/ 的/ 报文/ 延时/ 幅度/ 等/ 问题/ 缺乏/ 相应/ 研究/ ./ 以/ 目前/ 广泛/ 使用/ 的/ 第二代/ 洋葱/ 路由/ Tor/ 匿名/ 通信/ 系统/ 为/ 研究/ 对象/ ,/ 深入分析/ 其/ 数据包/ 调度/ 策略/ ,/ 建立/ 相应/ 数学模型/ ,/ 并/ 提出/ 数据包/ 输入/ 和/ 输出/ 缓冲区/ 的/ 平均/ 队列/ 长度/ 和/ 网络层/ 报文/ 数量/ 估算/ 方法/ ./ 在/ 此基础/ 上/ ,/ 结合/ 提出/ 的/ 时间/ 特征/ 差异/ 度/ 度量/ 方法/ ,/ 解释/ 说明/ 能够/ 借助/ 时间/ 特征/ 来/ 进行/ 匿名/ 通信/ 追踪/ 的/ 原因/ ,/ 同时/ 得出/ 影响/ 追踪/ 效果/ 的/ 3/ 个/ 具体/ 因素/ ./ 进一步/ ,/ 针对/ ON/ // OFF/ 流水/ 印/ 模型/ ,/ 推导/ 出/ 在/ 满足/ 一定/ 水印/ 检测/ 率/ 前提/ 下应/ 调制/ 的/ 报文/ 延时/ 幅度/ ./ 通过/ Tor/ 实验/ 环境/ 验证/ 了/ 理论/ 分析/ 的/ 正确性/ ./ 研究成果/ 为/ 后续/ 匿名/ 通信/ 相关/ 研究/ 提供/ 理论/ 和/ 实践/ 指导/ ./ 关键词/ 洋葱/ 路由/ ;/ 匿名/ 通信/ 追踪/ ;/ 时间/ 特征/ 差异/ 度/ ;/ ON/ // OFF/ 流水/ 印/ 模型/ ;/ 报文/ 延时/ 调制/ 1/ 引言/ 随着/ 移动/ 互联网/ 的/ 出现/ 和/ 发展/ ,/ 用户/ 隐私/ 信息/ 的/ 保护/ 逐渐/ 成为/ 关注/ 的/ 焦点/ ./ 洋葱/ 路由/ [/ 1/ ]/ 匿名/ 通信/ 机制/ 是/ 确保/ 网络/ 用户/ 隐私/ 信息安全/ 的/ 一种/ 重要/ 手段/ ./ 第一代/ 洋葱/ 路由/ 匿名/ 通信/ 系统/ 是/ 由/ 美国/ 海军/ 研究室/ 设计/ 并/ 开发/ ,/ 提供/ 实时/ 、/ 双向/ 的/ 匿名/ 通信/ 连接/ ./ 该/ 系统/ 采用/ 确定/ 路由/ 地址/ 的/ 源/ 路由/ 协议/ ,/ 传输数据/ 前/ 首先/ 建立/ 一条/ 由/ 发送/ 方到/ 接收/ 方/ 的/ OR/ (/ OnionRouter/ )/ 序列/ ,/ 数据包/ 和/ 地址/ 从后/ 向前/ 逐层/ 采用/ 每个/ OR/ 节点/ 的/ RSA/ 公钥/ 进行/ 加密/ ,/ 整个/ 数据包/ 的/ 格式/ 就/ 如同/ 多层/ 的/ 洋葱/ ./ 收到/ 这个/ 数据包/ 的/ 节点/ 只能/ 解密/ 最/ 外层/ ,/ 根据/ 获得/ 的/ 下/ 一/ 跳/ 地址/ 将/ 加密/ 数据/ 发送/ 出去/ ,/ 每个/ 节点/ 依次/ 操作/ ,/ 直到/ 最后/ 将/ 原始数据/ 发送到/ 接收者/ ;/ 返回/ 数据/ 时则/ 按/ 对应/ 的/ 相反/ 顺序/ 发送/ ./ 由于/ 采用/ 多/ 跳重/ 路由/ 和/ 层层/ 加密/ 设计/ ,/ 每个/ OR/ 节点/ 只/ 知道/ 其前/ 一/ 跳/ 和/ 后/ 一/ 跳/ 节点/ ,/ 恶意/ OR/ 节点/ 和/ 外部/ 观察者/ 难以确定/ 消息/ 发送者/ 、/ 真正/ 接收者/ 以及/ 他们/ 之间/ 的/ 通信/ 关系/ ,/ 从而/ 保护/ 了/ 用户/ 的/ 通信/ 关系/ 隐私/ 和/ 身份/ 信息/ 隐私/ ./ Tor/ [/ 2/ ]/ 作为/ 第二代/ 洋葱/ 路由/ 匿名/ 通信/ 系统/ ,/ 与/ 图/ 1/ 匿名/ 通信/ 追踪/ 示意图/ 在/ 图/ 1/ 中/ ,/ Alice/ 通过/ 匿名/ 通信/ 系统/ 访问/ 网络资源/ ./ 在/ 怀疑/ 的/ 通信/ 双方/ Alice/ 与/ Server/ 处/ ,/ 追踪者/ 可/ 首先/ 在/ Server/ 端/ 返回/ 的/ 网络/ 流中/ 提取/ 一定/ 时隙/ 内/ 的/ 报文/ 数量/ (/ 被动/ 追踪/ )/ 或者/ 对/ 报文/ 进行/ 延迟/ 处理/ 从而/ 形成/ 一些/ 不/ 含/ 报文/ 的/ 空/ 时隙/ (/ 主动/ 追踪/ )/ ./ 然后/ 对/ Alice/ 处/ 的/ 匿名/ 通信/ 流/ 进行/ 统计/ 处理/ ,/ 提取/ 一定/ 时隙/ 内/ 的/ 报文/ 数量/ 或/ 试图/ 发现/ 嵌入/ 的/ 空/ 时隙/ ,/ 恢复/ 出/ 时间/ 特征/ ./ 若/ 两处/ 的/ 时间/ 特征/ 相似/ 度/ 超过/ 设定/ 的/ 阀值/ ,/ 则/ 判断/ 出/ Alice/ 正/ 通过/ 匿名/ 通信/ 系统/ 与/ Server/ 进行/ 第一代/ 洋葱/ 路由/ 系统/ 相比/ ,/ 增加/ 了/ 安全/ 的/ 秘密/ 转发/ 、/ 拥塞/ 控制/ 、/ 目录/ 服务器/ 、/ 完整性/ 校验/ 以及/ 可变/ 的/ 边缘/ 策略/ 等/ ,/ 提升/ 了/ 系统/ 的/ 安全性/ 和/ 可用性/ ./ 它/ 采用/ 目录/ 服务器/ 分发/ OR/ 节点/ ,/ 在/ 用户/ 机器/ 上/ 运行/ 的/ OP/ (/ OnionProxy/ )/ 程序/ 按/ 一定/ 策略/ 挑选/ 3/ 个/ OR/ 节点/ 建立/ 匿名/ 路径/ ,/ 路径/ 上/ 的/ OR/ 节点/ 间/ 采用/ TLS/ 加密/ 数据/ ,/ 客户端/ 与/ OR/ 节点/ 间/ 使用/ DH/ (/ Diffie/ -/ Hellman/ )/ 握手/ 协议/ ,/ 协商/ AES/ 对称/ 会话/ 密钥/ ./ 一旦/ 匿名/ 连接/ 建立/ 完成/ ,/ 将/ 不再/ 使用/ 公钥/ 算法/ 构建/ 洋葱/ 包/ ,/ 而是/ 采用/ 对称/ 密钥/ 对/ 数据/ 进行/ 层层/ 加密/ ,/ 有效/ 减少/ 了/ 加解密/ 带来/ 的/ 系统/ 开销/ ./ 目前/ ,/ Tor/ 客户端/ 可/ 运行/ 于/ AppleiOS/ 、/ Android/ 以及/ NokiaMaemo/ 等/ 智能/ 终端/ 操作/ 平台/ 上/ ,/ 为/ 移动/ 互联网/ 用户/ 提供/ 了/ 便捷/ 、/ 有效/ 的/ 隐私/ 保护/ ./ 然而/ ,/ 匿名/ 通信/ 系统/ 在/ 保护/ 移动/ 互联网/ 用户/ 隐私/ 信息/ 的/ 同时/ ,/ 也/ 可为/ 不法分子/ 所/ 利用/ ,/ 为/ 其/ 实施/ 网络/ 犯罪/ 增加/ 掩护/ ,/ 阻碍/ 审查/ 机构/ 对/ 其/ 的/ 监控/ 与/ 追踪/ ./ 因此/ 目前/ 网络安全/ 领域/ 的/ 一个/ 新/ 的/ 研究/ 热点/ 便是/ 匿名/ 通信/ 追踪/ 技术/ ,/ 通过/ 还原/ 匿名/ 用户/ 间/ 的/ 通信/ 关系/ 为/ 匿名/ 网络/ 犯罪/ 的/ 追踪/ 提供/ 相应/ 的/ 技术手段/ ./ 典型/ 的/ 匿名/ 通信/ 追踪/ 框架/ [/ 3/ ]/ 可如图/ 1/ 所示/ ./ 交互/ ,/ 从而/ 完成/ 匿名/ 通信/ 追踪/ 过程/ ./ 此/ 方法/ 将/ 匿名/ 通信/ 系统/ 作为/ “/ 黑盒/ ”/ 处理/ ,/ 具有/ 较强/ 适用性/ ./ 需要/ 注意/ 的/ 是/ Alice/ 接收/ 到/ 的/ 报文/ 是/ 经过/ 匿名/ 节点/ 多/ 跳/ 转发/ 和/ 多次/ 加密/ 的/ ,/ 因而/ 并/ 不/ 能够/ 直接/ 借助/ 报文/ 头部/ 和/ 内容/ 信息/ 来/ 判断/ Alice/ 与/ Server/ 间/ 的/ 通信/ 关系/ ./ 针对/ 匿名/ 网络/ 犯罪/ 的/ 监控/ 与/ 追踪/ 问题/ ,/ 现有/ 研究/ 工作/ 主要/ 侧重/ 基于/ 时间/ 特征/ 提出/ 不同/ 的/ 追踪/ 技术/ 方案/ ,/ 如/ 被动/ 数包/ [/ 4/ -/ 5/ ]/ 和/ 主动/ 流水/ 印/ [/ 6/ -/ 7/ ]/ 等/ ,/ 但/ 对/ 其中/ 存在/ 的/ 两个/ 重要/ 问题/ 缺乏/ 相应/ 研究/ :/ 如何/ 从/ 理论/ 上/ Page3/ 分析/ 时间/ 特征/ 可/ 用于/ 追踪/ 的/ 原因/ ,/ 以及/ 进一步/ ,/ 如何/ 确定/ 为/ 形成/ 特定/ 时间/ 特征/ 所/ 需/ 调制/ 的/ 报文/ 延迟/ 幅度/ ./ 解决/ 这些/ 问题/ 具有/ 重要/ 实际意义/ :/ 一方面/ 可/ 指导/ 设计/ 更加/ 有效/ 的/ 匿名/ 通信/ 追踪/ 技术/ 方案/ ;/ 另一方面/ 可以/ 揭示/ 现有/ 匿名/ 通信协议/ 和/ 匿名/ 通信/ 系统/ 在/ 实现/ 上/ 存在/ 的/ 漏洞/ ,/ 从而/ 能够/ 设计/ 更/ 完善/ 的/ 匿名/ 通信协议/ 以及/ 其/ 系统/ 实现/ ,/ 为/ 用户/ 提供/ 更好/ 的/ 隐私/ 保护/ ./ 为此/ ,/ 本文/ 以/ 洋葱/ 路由/ 匿名/ 通信/ 系统/ 设计/ 为/ 切入点/ ,/ 根据/ 其/ 对/ 时间/ 特征/ 的/ 改变方式/ ,/ 分析/ 出/ 追踪/ 可行性/ 的/ 理论依据/ 、/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ 和/ 为/ 嵌入/ 水印/ 信号/ 所/ 需/ 调制/ 的/ 报文/ 延时/ 幅度/ 等/ ,/ 为/ 后续/ 相关/ 研究/ 提供/ 理论/ 和/ 实践/ 指导/ ./ 具体/ 的/ ,/ 本文/ 以/ 目前/ 使用/ 最为/ 广泛/ 的/ Tor/ 匿名/ 通信/ 系统/ 为/ 研究/ 对象/ ,/ 对/ 其/ 运行机制/ 进行/ 深入分析/ ,/ 建立/ 数据包/ 调度/ 算法/ 模型/ ,/ 提出/ 数据包/ 输入/ 和/ 输出/ 队列/ 的/ 平均/ 长度/ 和/ 对应/ 的/ 网络层/ 报文/ 数量/ 估算/ 方法/ ./ 在/ 此基础/ 上/ ,/ 结合/ 提出/ 的/ 时间/ 特征/ 差异/ 度/ 度量/ 方法/ ,/ 对/ 基于/ 时间/ 特征/ 匿名/ 通信/ 追踪/ 技术/ 的/ 可行性/ 展开/ 理论/ 分析/ ,/ 得出/ 影响/ 追踪/ 效果/ 的/ 3/ 个/ 因素/ ,/ 即/ 报文/ 长度/ 、/ 干扰/ 流/ 和/ 转发/ 节点/ 自身/ 的/ 处理/ 能力/ 等/ ,/ 并/ 给出/ 追踪/ 时/ 的/ 具体/ 实践/ 指导/ ./ 进一步/ ,/ 为/ 分析/ 在/ 网络/ 流中/ 形成/ 特定/ 时间/ 长度/ 的/ 空隙/ 以/ 嵌入/ 水印/ 信号/ 所/ 需要/ 施加/ 的/ 报文/ 延时/ 范围/ ,/ 本文/ 针对/ ON/ // OFF/ 流水/ 印/ 追踪/ 模型/ [/ 8/ -/ 9/ ]/ ,/ 推导/ 出/ 在/ 满足/ 一定/ 检测/ 率/ 的/ 前提/ 下应/ 调制/ 的/ 报文/ 延时/ 幅度/ ,/ 并/ 给出/ 实际/ 应用/ 时/ 有关/ 参数/ 的/ 获取/ 方法/ ./ 本文/ 通过/ Tor/ 实验/ 环境/ 对/ 相关/ 结论/ 进行/ 了/ 验证/ ./ 本文/ 第/ 2/ 节/ 简要/ 介绍/ 匿名/ 通信/ 及其/ 追踪/ 方面/ 的/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节对/ Tor/ 匿名/ 通信/ 系统/ 进行/ 深入分析/ ,/ 建立/ 其/ 数据包/ 调度/ 模型/ ,/ 提出/ 数据包/ 输入/ 和/ 输出/ 缓冲区/ 的/ 平均/ 队列/ 长度/ 和/ 对应/ 的/ 网络层/ 报文/ 数量/ 估算/ 方法/ ,/ 为/ 后续/ 的/ 时间/ 特征/ 度量/ 与/ 分析/ 奠定/ 基础/ ;/ 在/ 第/ 4/ 节中/ 提出/ 时间/ 特征/ 差异/ 度/ 度量/ 方法/ ,/ 结合/ 推导/ 出/ 的/ 网络层/ 报文/ 数量/ 计算公式/ ,/ 对/ 基于/ 时间/ 特征/ 的/ 匿名/ 通信/ 追踪/ 技术/ 展开/ 理论/ 分析/ ,/ 解释/ 说明/ 能够/ 借助/ 时间/ 特征/ 来/ 进行/ 匿名/ 通信/ 追踪/ 的/ 原因/ 和/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ ,/ 并/ 在/ 此基础/ 上/ 针对/ ON/ // OFF/ 流水/ 印/ 追踪/ 模型/ ,/ 进一步/ 推导/ 出为/ 嵌入/ 水印/ 信号/ 所/ 需/ 调制/ 的/ 报文/ 延时/ 幅度/ ;/ 第/ 5/ 节为/ 实验/ 部分/ ,/ 通过/ Tor/ 实验/ 环境/ 对/ 相关/ 结论/ 进行/ 验证/ ;/ 最后/ 一节/ 总结/ 全文/ ./ 2/ 相关/ 工作/ Chaum/ [/ 10/ ]/ 于/ 1981/ 年/ 首先/ 提出/ 匿名/ 通信/ 和/ Mix/ 技术/ 概念/ ,/ 通过/ 一系列/ Mix/ 节点/ 对/ 数据包/ 进行/ 重/ 路由/ 以/ 掩盖/ 用户/ 的/ 真实/ IP地址/ ,/ 并/ 以包/ 填充/ 、/ 包/ 延迟/ 和/ 多重/ 加密/ 等/ 混淆/ 手段/ 将/ 通信/ 流中/ 的/ 通信/ 关系/ 加以/ 隐藏/ ./ 但/ Mix/ 技术/ 所/ 采取/ 的/ 包/ 延迟/ 等/ 技术/ 给/ 报文/ 传输/ 带来/ 显著/ 延迟/ ,/ 因而/ 其仅/ 适用/ 于/ 对/ 实时性/ 要求/ 较/ 低/ 的/ 网络应用/ ,/ 如/ 电子邮件/ 等/ ./ 为/ 支持/ 交互式/ 网络应用/ ,/ 研究/ 人员/ 设计/ 并/ 开发/ 了/ 多种/ 低/ 延时/ 匿名/ 通信/ 系统/ ,/ 如/ Tor/ [/ 3/ ]/ 、/ I2P/ [/ 11/ ]/ 、/ Anonymizer/ [/ 12/ ]/ 等/ ./ 这些/ 系统/ 并未/ 使用/ 包/ 延迟/ 等/ 机制/ ,/ 从而/ 能够/ 支持/ 诸如/ 网页/ 浏览/ 、/ 文件/ 下载/ 、/ 即时/ 通信/ (/ 如/ MSN/ 、/ ICQ/ )/ 等/ 延时/ 敏感/ 类/ 网络应用/ ,/ 其中/ Tor/ 系统/ 中约/ 有/ 2600/ 个/ OR/ 节点/ ①/ 和/ 600000/ 在线/ 用户/ ②/ ,/ 是/ 当前/ 使用/ 最为/ 广泛/ 的/ 匿名/ 通信/ 系统/ ./ 与/ Tor/ 相比/ ,/ I2P/ 采用/ 大蒜/ 路由/ (/ GarlicRouting/ )/ 机制/ ,/ 即会/ 将/ 多个/ 消息/ 组合/ 在/ 一起/ 加以/ 传输/ ,/ 并且/ I2P/ 在/ 设计/ 上/ 是/ 专门/ 针对/ 隐藏/ 服务/ ,/ 而/ 并非/ 用于/ 一般/ 网络/ 用户/ 的/ 匿名/ 通信/ ./ Anonymizer/ 为/ 商用/ 的/ 单/ 跳/ 代理/ 转发/ 系统/ ,/ 与/ 典型/ 的/ 多/ 跳重/ 路由/ 模式/ 差别/ 较大/ ,/ 实现/ 机制/ 也/ 较/ 简单/ ./ 同时/ ,/ I2P/ 和/ Anony/ -/ mizer/ 在/ 当前/ 并/ 不能/ 直接/ 用于/ AppleiOS/ 、/ Android/ 等/ 智能/ 终端/ 操作/ 平台/ 上/ ,/ 使用/ 范围/ 有限/ ./ 鉴于/ 上述/ 分析/ 比较/ ,/ 本文/ 首先/ 选择/ Tor/ 为/ 研究/ 对象/ ,/ 而/ 将/ I2P/ 、/ Anonymizer/ 等/ 匿名/ 通信/ 系统/ 留于/ 后续/ 工作/ 中/ 加以分析/ 研究/ ./ 针对/ 匿名/ 滥用/ 的/ 追踪/ 技术/ 本质/ 上/ 是/ 对/ 匿名/ 通信/ 系统/ 的/ 攻击/ ,/ 其/ 目的/ 是/ 还原/ 出/ 用户/ 之间/ 的/ 通信/ 关系/ ,/ 解除/ 其/ 匿名性/ ./ 根据/ 对/ 追踪者/ 能力/ 范围/ 限制/ 的/ 不同/ ,/ 匿名/ 通信/ 追踪/ 可/ 分为/ 被动/ 追踪/ 和/ 主动/ 追踪/ [/ 13/ ]/ ./ 被动/ 追踪/ 是/ 指/ 追踪者/ 仅/ 被动/ 监听/ 怀疑/ 的/ 通信/ 双方/ 处/ 的/ 网络流量/ ,/ 提取/ 特定/ 时隙/ 内/ 报文/ 数量/ 或/ 报文/ 时间/ 间隔/ 等/ 网络/ 流/ 特征/ 以/ 作为/ 追踪/ 依据/ ./ 而/ 在/ 主动/ 追踪/ 模型/ 中/ ,/ 追踪者/ 不仅/ 可以/ 监听/ 怀疑/ 的/ 通信/ 双方/ 的/ 网络流量/ ,/ 还/ 能够/ 对/ 报文/ 进行/ 延迟/ 、/ 修改/ 、/ 丢弃/ 等/ 处理/ ,/ 以/ 达到/ 准确/ 、/ 高效/ 追踪/ 目的/ ,/ 其中/ 基于/ 时间/ 特征/ 的/ 流水/ 印/ 技术/ 被/ 广泛/ 使用/ ./ 被动/ 匿名/ 通信/ 追踪/ 的/ 主要/ 研究/ 工作/ 有/ Zhang/ 等/ 人/ [/ 8/ ]/ 利用/ 交互式/ 流量/ 的/ ON/ // OFF/ 特性/ 计算/ 流/ 之间/ 的/ 相似性/ ;/ Levine/ 等/ 人/ [/ 14/ ]/ 首次/ 提出/ 以/ 特定/ 时隙/ 内/ 报文/ 数量/ 为/ 时间/ 特征/ ,/ 对/ Mix/ 节点/ 的/ 被动/ 流/ 关联/ 技术/ 展开/ 研究/ ;/ Zhu/ 等/ 人/ [/ 3/ ]/ 以/ 互信息/ 的/ 方法/ 对/ 进出/ 匿/ ①/ ②/ Page4/ 名/ 通信/ 系统/ 的/ 流/ 进行/ 关联/ 以/ 确定/ 匿名/ 用户/ 间/ 的/ 通信/ 关系/ ;/ Fusenig/ 等/ 人/ [/ 5/ ]/ 提出/ 改进/ 的/ 时隙/ 数包/ 追踪/ 方案/ ;/ Craven/ 等/ 人/ [/ 15/ ]/ 针对/ Tor/ 匿名/ 通信/ 系统/ ,/ 以/ 报文/ 时间/ 间隔/ 为/ 特征/ ,/ 建立/ 其隐/ 马尔科夫/ 模型/ ,/ 从而/ 实施/ 匿名/ 通信/ 追踪/ ./ 由于/ 被动/ 匿名/ 通信/ 追踪/ 需要/ 对流/ 进行/ 长时间/ 的/ 观察/ ,/ 并/ 记录/ 大量/ 特征/ 数据/ ,/ 总体/ 来说/ 效率/ 不高/ ,/ 因而/ 快速/ 准确/ 的/ 主动/ 匿名/ 通信/ 追踪/ 技术/ 得到/ 了/ 越来越/ 多/ 的/ 关注/ ./ 主动/ 匿名/ 通信/ 追踪/ 技术/ 在/ 原始/ 网络/ 流中/ 加入/ 特定/ 的/ 标识/ (/ 水印/ )/ ,/ 如果/ 在/ 匿名/ 通信/ 流中/ 提取/ 出/ 相同/ 的/ 标识/ ,/ 则/ 认为/ 这/ 两条/ 流是/ 相关联/ 的/ ,/ 这方面/ 的/ 典型/ 工作/ 包括/ :/ Wang/ 等/ 人/ [/ 16/ -/ 17/ ]/ 以/ 报文/ 时间/ 间隔/ 为/ 载体/ 提出/ 了/ 一系列/ 基于/ 流水/ 印/ 的/ 主动/ 流/ 关联/ 技术/ ;/ Wang/ 等/ 人/ [/ 18/ ]/ 针对/ 低/ 延时/ 匿名/ 系统/ 在/ 转发/ 数据/ 时/ 无法/ 完全/ 消除/ 流中/ 报文/ 时间/ 特征/ 的/ 缺陷/ ,/ 提出/ 了/ 基于/ 报文/ 抵达/ 时间/ 的/ 主动/ 流/ 关联/ 技术/ ;/ Yu/ 等/ 人/ [/ 19/ ]/ 使用/ 直序/ 扩频/ 技术/ ,/ 以流/ 速率/ 为/ 载体/ ,/ 将/ 水印/ 信号/ 扩频/ 后/ 嵌入/ 通信/ 流中/ ,/ 有效/ 地/ 提高/ 了/ 主动/ 流/ 关联/ 技术/ 的/ 检测/ 率/ 和/ 抗干扰能力/ ;/ Pyun/ 等/ 人/ [/ 20/ ]/ 以/ 一定/ 时隙/ 内/ 报文/ 个数/ 为/ 载体/ 提出/ 了/ 一种/ 流水/ 印/ 技术/ 以/ 应对/ 传输/ 过程/ 中/ 的/ 包/ 重组/ 问题/ ;/ Houmansadr/ 等/ 人/ [/ 21/ ]/ 提出/ 了/ 一种/ 非盲/ 检测/ 流水/ 印/ ,/ 减小/ 了/ 对流/ 的/ 调制/ 幅度/ ,/ 大大提高/ 了/ 主动/ 流/ 关联/ 技术/ 的/ 隐秘性/ ;/ Huang/ 等/ 人/ [/ 22/ ]/ 针对/ 文献/ [/ 19/ ]/ 提出/ 改进/ 的/ 直序/ 扩频/ 水印/ 技术/ ;/ Zhang/ 等/ 人/ [/ 6/ ]/ 针对/ Web/ 浏览/ 、/ 即时消息/ 等/ 交互式/ 应用/ ,/ 在/ 扩频/ 流水/ 印/ 模型/ 的/ 基础/ 上/ ,/ 引入/ 与/ 特定/ 流/ 无关/ 的/ 基于/ 时隙/ 质心/ 的/ 水印/ 载体/ ,/ 提出/ 一种/ 新型/ 流水/ 印/ 技术/ ;/ Houmansadr/ 等/ 人/ [/ 7/ ]/ 以/ 报文/ 时隙/ 质心/ 为/ 载体/ ,/ 首次/ 提出/ 流/ 相关/ 的/ 水印/ 追踪/ 技术/ ./ 在/ 目前/ 匿名/ 通信/ 追踪/ 研究/ 工作/ 中/ ,/ 有/ 许多/ 是/ 围绕/ 时间/ 特征/ 展开/ 的/ [/ 4/ -/ 7/ ,/ 13/ -/ 22/ ]/ ./ 然而/ 现有/ 研究/ 工作/ 所/ 关注/ 的/ 重点/ 是/ 选择/ 不同/ 的/ 时间/ 特征/ 相似/ 度/ 计算方法/ 和/ 设计/ 更为/ 隐蔽/ 、/ 高效/ 的/ 追踪/ 技术/ ,/ 对/ 借助/ 时间/ 特征/ 来/ 进行/ 匿名/ 通信/ 追踪/ 的/ 合理性/ 缺乏/ 理论/ 解释/ ,/ 并/ 对/ 可能/ 造成/ 原始/ 网络/ 流/ 与/ 对应/ 的/ 匿名/ 通信/ 流/ 时间/ 特征/ 产生/ 较大/ 差异/ 的/ 干扰/ 因素/ 和/ 嵌入/ 水印/ 所/ 需/ 调制/ 的/ 时间/ 幅度/ 缺少/ 相应/ 分析/ ./ 论文/ 着重/ 解决/ 以上/ 问题/ ,/ 为/ 后续/ 匿名/ 通信/ 相关/ 研究/ 工作/ 提供/ 理论/ 和/ 实践/ 指导/ ./ 3Tor/ 运行机制/ 描述/ 与/ 数据包/ 调度/ 策略/ 建模/ 本节/ 对/ 目前/ 使用/ 最为/ 广泛/ 的/ 第二代/ 洋葱/ 路由/ Tor/ 匿名/ 通信/ 系统/ 运行机制/ 进行/ 详细描述/ ,/ 并/ 对/ 其/ 数据包/ 调度/ 策略/ 进行/ 建模/ ,/ 提出/ 数据包/ 输入/ 和/ 输出/ 缓冲区/ 的/ 平均/ 队列/ 长度/ 和/ 对应/ 的/ 网络层/ 报文/ 数量/ 估算/ 方法/ ,/ 为/ 第/ 4/ 节中/ 的/ 时间/ 特征分析/ 奠定/ 基础/ ./ 3.1/ Tor/ 运行机制/ 描述/ Tor/ 作为/ 第二代/ 洋葱/ 路由/ 匿名/ 通信/ 系统/ ,/ 是/ 目前/ 最为/ 流行/ 、/ 应用/ 最为/ 广泛/ 的/ 匿名/ 通信/ 系统/ ./ 当前/ Tor/ 系统/ 中约/ 有/ 2600/ 个/ OR/ 节点/ ,/ 估计/ 同时在线/ 用户数/ 为/ 600000/ ./ Tor/ 适用/ 于/ 所有/ 基于/ TCP/ 协议/ 的/ 应用/ ,/ 其/ 整体/ 系统/ 架构/ 如图/ 2/ 所示/ ./ 当/ Alice/ 通过/ Tor/ 访问/ 网络资源/ ,/ 如/ Web/ 服务器时/ ,/ 首先/ 从/ 目录/ 服务器/ 或/ Bridge/ 节点/ 处/ 下载/ 所有/ 的/ OR/ 节点/ 信息/ ,/ 然后/ 根据/ 各/ 节点/ 所/ 公告/ 的/ 带宽/ 、/ 在线/ 时间/ 长短/ 和/ 设定/ 的/ 出口/ 访问/ 策略/ 等/ 因素/ ,/ 使用/ 带宽/ 加权/ 算法/ 选择/ 3/ 个/ 节点/ 分别/ 作为/ 入口/ 节点/ (/ EntryNode/ )/ 、/ 中间/ 节点/ (/ MiddleNode/ )/ 和/ 出口/ 节点/ (/ ExitNode/ )/ ./ 这里/ 的/ 带宽/ 为/ 节点/ 可用/ 的/ 网络带宽/ ,/ 由/ 各/ 节点/ 自行/ 配置/ 并/ 将/ 该/ 参数/ 上传/ 至/ 目录/ 服务器/ ./ 为/ 防止/ 连接/ 被/ 阻断/ ,/ Tor/ 提供/ 非/ 公开/ 的/ Bridge/ 节点/ 以/ 接入/ 网络/ ./ 若/ OP/ 配置/ 使用/ Bridge/ 节点/ ,/ 则/ 转发/ 路径/ 的/ 入口/ 节点/ 即/ 为/ 该/ Bridge/ 节点/ ,/ 如图/ 2/ 中/ 虚线/ 所示/ ./ 随后/ ,/ Alice/ 与/ Web/ 服务器/ 间通信/ 的/ 所有/ 报文/ 都/ 将/ 通过/ 该/ 3/ 跳/ 路径/ 转发/ ,/ 其中/ Tor/ 匿名/ 转发/ 链路/ 的/ 建立/ 如图/ 3/ 所示/ ./ 首先/ ,/ Alice/ 处/ 的/ OP/ 程序/ 与/ 入口/ 节点/ 建立/ TLS/ 连接/ ,/ 然后/ 发送/ “/ Create/ ”/ 请求/ ,/ 与/ 入口/ 节点/ 协商会/ 话/ 对称/ 密钥/ ,/ 该/ 对称/ 密钥/ 由/ DH/ 密钥/ 交换/ 协议/ 生成/ ,/ 并/ 使用/ RSA/ 加密算法/ 对/ DH/ 交换/ 参数/ 进行/ 加密/ 处理/ ./ 协商/ 成功/ 后/ ,/ OP/ 通过/ 入口/ 节点/ ,/ 继续/ 与/ 中间/ 节点/ 和/ 出口/ 节点/ 间/ 进行/ 类似/ 交互/ ,/ 从而/ 建立/ 3/ 跳/ 的/ 匿名/ 转发/ 链路/ ./ 当/ OP/ 传输数据/ 时/ ,/ 数据/ 经/ 入口/ 节点/ 、/ 中间/ 节点/ 和/ 出口/ 节点/ 层层/ 加/ // 解密/ 和/ 转发/ 操作/ ,/ 最终/ 到达/ 目的/ 端/ ./ Page5/ 图/ 3Tor/ 匿名/ 转发/ 链路/ 建立/ 流程/ 如上所述/ ,/ Tor/ 使用/ 带宽/ 加权/ 算法/ 分别/ 从/ 入口/ 节点/ 集合/ 、/ 出口/ 节点/ 集合/ 和/ 中间/ 节点/ 集合/ 中/ 选择/ 3/ 个/ 不同/ 节点/ 构建/ 匿名/ 转发/ 路径/ ./ 记/ 入口/ 节点/ 的/ 集合/ 为/ En/ ,/ 出口/ 节点/ 集合/ 为/ Ex/ ,/ 中间/ 节点/ 集合/ 为/ Em/ ,/ 而/ 同时/ 属于/ 入口/ 和/ 出口/ 节点/ 的/ 节点/ 集合/ 为/ En/ ∩/ x/ ,/ 即/ En/ ∩/ x/ =/ En/ ∩/ Ex/ ./ 令/ 各/ 集合/ 中/ 所有/ 节点/ 的/ 网络带宽/ 之/ 和/ 分别/ 为/ Bn/ 、/ Bx/ 、/ Bm/ 和/ Bn/ ∩/ x/ ,/ 所有/ Tor/ 节点/ 的/ 总/ 带宽/ 为/ B/ =/ Bn/ +/ Bx/ +/ Bm/ -/ Bn/ ∩/ x/ ./ 以/ 选择/ 出口/ 节点/ 为例/ ,/ 从/ 出口/ 节点/ 集合/ 中/ 选择/ 第/ i/ 个/ 节点/ 作为/ 匿名/ 转发/ 链路/ 出口/ 节点/ 的/ 概率/ 为/ Bx/ (/ i/ )/ // [/ Bx/ +/ Bn/ ∩/ xWx/ ]/ ,/ 其中/ Bx/ (/ i/ )/ 为/ 出口/ 节点/ 集合/ 中/ 第/ i/ 个/ 节点/ 的/ 网络带宽/ ,/ 而/ Wx/ 为/ En/ ∩/ x/ 集合/ 中/ 节点/ 被选为/ 出口/ 节点/ 的/ 权重/ ,/ 计算/ 为/ Wx/ =/ 1/ -/ B/ // 3Bn/ ./ 选择/ 其它/ 节点/ 的/ 方法/ 类似/ ,/ 更/ 详尽/ 的/ 分析/ 参见/ 文献/ [/ 23/ ]/ ./ 转发/ 链路/ 建立/ 成功/ 后/ OP/ 程序/ 监听/ 本地/ 端口/ (/ 默认/ 为/ 9050/ )/ ,/ 其它/ 应用程序/ 通过/ 配置/ Socks/ 代理/ (/ 127.0/ ./ 0.1/ :/ 9050/ )/ 连接/ 至/ OP/ ./ 针对/ 每一/ Socks/ 连接/ ,/ OP/ 程序/ 有/ 一个/ 数据包/ 输入/ 缓冲区/ 和/ 对应/ 的/ 输出/ 图/ 4Tor/ 信元/ 结构/ 缓冲区/ ,/ 输出/ 缓冲区/ 与/ 下/ 一/ 跳/ 节点/ 相关/ ,/ 因而/ 可以/ 有/ 多个/ 输入/ 缓冲区/ 对应/ 同一个/ 输出/ 缓冲区/ ./ Tor/ 的/ 数据处理/ 和/ 转发/ 功能/ 均/ 由/ libevent/ 的/ 读/ 事件/ 和/ 写/ 事件/ 控制/ 完成/ ./ 当读/ 事件/ 被/ 调度/ 时/ ,/ OP/ 从/ 输入/ 缓冲区/ 中/ 读取数据/ ,/ 一次/ 最/ 多/ 读取/ 498/ 字节/ ,/ 然后/ 利用/ 出口/ 节点/ 、/ 中间/ 节点/ 和/ 入口/ 节点/ 的/ 会/ 话/ 密钥/ 对/ 读取/ 的/ 数据/ 层层/ 加密/ ,/ 再/ 增加/ 信元/ (/ Cell/ )/ 头部/ 字/ 段/ ,/ 并/ 将/ 一个/ 长度/ 为/ 512/ 字节/ 的/ 完整/ 的/ 信元/ 写入/ 信元/ 队列/ 中/ ./ 若/ 输入/ 缓冲区/ 中/ 还有/ 数据/ ,/ 则/ 继续/ 上述/ 操作/ ,/ 直至/ 读取/ 完/ 所有/ 数据/ ,/ 并/ 注册/ 写/ 事件/ ./ 当写/ 事件/ 被/ 调度/ 时/ ,/ 首先/ 将/ 输出/ 缓冲区/ 中/ 的/ 数据/ 尽可能/ 多/ 的/ 写入/ TLS/ 写/ 缓冲区/ 中/ ,/ 然后/ 将/ 信元/ 队列/ 中/ 的/ 信元/ 尽可能/ 多/ 的/ 写入/ 输出/ 缓冲区/ 中/ ./ 即/ 一个/ 信元/ 发送至/ 网络/ 需要/ 两次/ 写/ 事件/ ,/ 一次/ 写/ 事件/ 将/ 信元/ 写入/ 输出/ 缓冲区/ 中/ ,/ 另/ 一次/ 写/ 事件/ 将/ 信元/ 从/ 输出/ 缓冲区/ 中/ 写入/ TLS/ 层/ 加密/ 并/ 发送/ ./ Tor/ 信元/ 结构/ 如图/ 4/ 所示/ ,/ 图/ 4/ (/ a/ )/ 为/ Tor/ 命令/ 控制/ 信元/ 结构/ ,/ 图/ 4/ (/ b/ )/ 为/ 数据/ 转/ 发信/ 元/ 结构/ ./ OP/ 的/ 报文/ 处理/ 流程/ 如图/ 5/ 所示/ ./ Page6/ 转发/ 链路/ 上/ 的/ OR/ 节点/ 对/ 数据/ 的/ 处理/ 流程/ 与/ OP/ 略有不同/ ,/ OR/ 节点/ 从/ TLS/ 读/ 缓冲区/ 中/ 读取数据/ 至/ 输入/ 缓冲区/ 中/ ,/ 并且/ 每次/ 从/ 输入/ 缓冲区/ 中/ 读取/ 一个/ 信元/ 长度/ 的/ 数据/ ,/ 即/ 每次/ 读取/ 512/ 字节/ ./ 根据/ 路径/ 方向/ 执行/ 完/ 加密/ 或/ 解密/ 操作/ 后/ 根据/ 信元/ 的/ Circ/ _/ ID/ 字段/ 将/ 该/ 信元/ 放入/ 相应/ 队列/ 中/ ,/ OR/ 节点/ 有/ 多个/ 信元/ 队列/ ./ 具体/ 流程/ 如图/ 6/ 所示/ ./ 需要/ 注意/ 的/ 是/ 出口/ 节点/ 处理/ 目的/ 端/ (/ 如图/ 2/ 中/ 的/ Web/ 服务器/ )/ 返回/ 的/ 数图/ 7TorTLS/ 报文/ 结构/ 为/ 保证/ 传输/ 性能/ ,/ Tor/ 匿名/ 通信/ 系统/ 采取/ 了/ 多种不同/ 级别/ 的/ 流量/ 控制/ 机制/ [/ 2/ ]/ ,/ 如/ 匿名/ 链路/ 级/ 、/ 通信/ 流级/ 和/ TCP/ 连接/ 级/ 等/ ./ 对于/ 匿名/ 链路/ 和/ 通信/ 流级/ 的/ 流量/ 控制/ ,/ 采用/ 窗口/ 机制/ ,/ 每/ 接收/ 到/ 一个/ 信元后/ 窗口/ 数量/ 减/ 1/ ./ 当/ 接收/ 到/ 一定/ 数量/ (/ 50/ 或/ 100/ 个/ )/ 信元后/ ,/ 则/ 向/ 对方/ 发送/ RELAY/ _/ SENDME/ 命令/ ,/ 增加/ 对应/ 窗表/ 1/ 主要/ 符号/ 定义/ 符号/ ExEn/ ∩/ xNinTm/ τ/ 据时/ 其/ 流程/ 与/ OP/ 相同/ ./ 输出/ 缓冲区/ 中/ 的/ 信元/ 写入/ TLS/ 写/ 缓冲区/ 中/ ,/ 加密/ 后经/ TCP/ 协议/ 传输/ ./ Tor/ 借由/ OpenSSL/ 实现/ TLS/ 层/ 加密/ ./ TLS/ 报文/ 由/ TLS/ 头部/ 、/ 加密/ 后/ 的/ 数据/ 和/ 消息/ 验证码/ MAC/ 以及/ 填充/ 字/ 段/ 组成/ ,/ 具体/ 格式/ 如图/ 7/ (/ a/ )/ 所示/ ./ 但/ Tor/ 会/ 对/ 每个/ TLS/ 报文/ 增加/ 一个/ 空/ 的/ TLS/ 记录/ ,/ 因而/ 最终/ 的/ TLS/ 报文/ 结构/ 如图/ 7/ (/ b/ )/ 所示/ ./ 口/ 长度/ ./ 而/ 对于/ 不同/ 的/ TCP/ 连接/ ,/ 采用/ 均分/ 总/ 带宽/ 策略/ ,/ 即/ 每/ 一条/ TCP/ 连接/ 所/ 占用/ 的/ 带宽/ 相同/ ./ 鉴于/ 篇幅/ 所/ 限/ ,/ Tor/ 流量/ 控制/ 机制/ 的/ 详细描述/ 参见/ 文献/ [/ 2/ ]/ ./ 3.2/ 数据包/ 调度/ 策略/ 建模/ 首先/ 对/ 论文/ 中/ 出现/ 的/ 主要/ 符号/ 定义/ 进行/ 说明/ ,/ 如表/ 1/ 所示/ ./ Page7C/ 一次/ 调度/ 时间/ 内/ 原始/ 网络/ 流中/ 包含/ 的/ 报文/ 数量/ Tmin/ 匿名/ 转发/ 路径/ 上/ 节点/ 调度/ 时间/ 的/ 最小值/ CI/ (/ i/ )/ 一次/ 调度/ 时间/ 内/ 第/ i/ 个/ 干扰/ 流/ 包含/ 的/ 报文/ 数量/ Tk/ 匿名/ 转发/ 路径/ 上/ 第/ k/ 个/ 节点/ 的/ 调度/ 时间/ Bn/ ,/ BxBm/ ,/ Bn/ ∩/ xtS1/ ,/ tS2X/ ,/ …/ ,/ cTf/ // T/ 犞/ X/ =/ {/ c1/ 如/ 3.1/ 节中/ 所/ 描述/ ,/ Tor/ 采用/ libevent/ 事件/ 机制/ 实现/ 输入/ 缓冲区/ 和/ 输出/ 缓冲区/ 中/ 数据/ 的/ 处理/ 调度/ ,/ 其/ 可/ 表示/ 为/ 隐式/ 的/ 轮询/ (/ roundrobin/ )/ 调度/ [/ 24/ ]/ ,/ 因而/ Tor/ 节点/ 对/ 数据包/ 的/ 处理/ 流程/ 可/ 抽象/ 为/ 以下/ 算法/ 模型/ ./ 算法/ 1/ ./ TorSchedulingAlgorithm/ ./ 1/ ./ WHILE/ (/ TURE/ )/ 2/ ./ FOReachinputbuffer3/ ./ IFtheinputbufferisnotempty4/ ./ getatmostNpktpacketsandencapsulate5/ ./ putthecellsintothecorrespondingoutput6/ ./ ENDIF7/ ./ ENDFOR8/ ./ FOReachoutputbuffer9/ ./ IFtheoutputbufferisnotempty10/ ./ flushalldata11/ ./ ENDIF12/ ./ ENDFOR13/ ./ ENDWHILE/ 由于/ Tor/ 本身/ 的/ 流量/ 控制/ 机制/ [/ 2/ ]/ ,/ 算法/ 1/ 中/ 规定/ 从/ 输入/ 缓冲区/ 中/ 一次/ 最多/ 可/ 读取/ Npkt/ 个/ 数据包/ ./ 设/ Tor/ 节点/ 设置/ 的/ 最大/ 流/ 速率/ 为/ Q/ ,/ 同时/ 有/ Nout/ 个/ 输出/ 缓冲区/ ,/ 则/ Npkt/ ≈/ min/ (/ 100/ ,/ Q/ // (/ 586/ ×/ Nout/ )/ )/ ./ 基于/ Tor/ 流量/ 控制/ 机制/ ,/ 假定/ 信元/ 队列/ 中/ 的/ 信元/ 可/ 一次性/ 写入/ 输出/ 缓冲区/ 中/ 并/ 发送/ ./ 算法/ 1/ 的/ 图形/ 解释/ 如图/ 8/ 所示/ ./ 由/ 算法/ 1/ 可求/ 出/ 数据包/ 输入/ 缓冲区/ 和/ 输出/ 缓冲区/ 的/ 平均/ 队列/ 长度/ ,/ 从而/ 求/ 出/ 对应/ 的/ 网络层/ 报文/ 数量/ ./ 如图/ 2/ 所示/ ,/ 考察/ Web/ 服务器返回/ 数据/ 至/ Alice/ 的/ 情形/ ./ 设/ 每个/ OR/ 节点/ 共有/ Nin/ 个/ 输入/ 缓冲区/ ,/ tANout/ 个/ 输出/ 缓冲区/ ,/ Nout/ / Nin/ ./ 每个/ 输出/ 缓冲区/ 有/ g/ 个/ 输入/ 缓冲区/ 与/ 之/ 对应/ ,/ 1/ / g/ / Nin/ -/ Nout/ +/ 1/ ./ 记/ OR/ 节点/ 对/ 输入/ 缓冲区/ 和/ 输出/ 缓冲区/ 中/ 数据包/ 的/ 处理/ 速率/ 为/ μ/ ./ 对于/ 任一/ 输入/ 缓冲区/ ,/ 依据/ 轮询/ 调度/ 策略/ ,/ 在/ 处理/ 完/ 其它/ Nin/ -/ 1/ 个/ 输入/ 缓冲区/ 和/ Nout/ 个/ 输出/ 缓冲区/ 后/ 才/ 能够/ 再次/ 处理/ 该/ 队列/ 中/ 的/ 数据包/ ./ 设/ 一次/ 处理/ 的/ 单个/ 输入/ 缓冲区/ 数据包/ 数量/ 等于/ e/ 的/ 概率/ 为/ Pre/ ,/ 处理/ 第/ i/ 个/ 输入/ 缓冲区/ 一次/ 需要/ 时间/ 为/ 则/ 处理/ Nin/ 个/ 输入/ 缓冲区/ 所/ 需/ 的/ 时间/ 为/ Tsum/ (/ I/ )/ ≈/ Nin/ ∑/ Npkt/ -/ 1/ 由于/ 输出/ 缓冲区/ 中/ 数据包/ 来源于/ 输入/ 缓冲区/ 中/ ,/ 因而/ 处理/ Nout/ 个/ 输出/ 缓冲区/ 所/ 需/ 时间/ 可/ 近似/ 相等于/ 处理/ Nin/ 个/ 输入/ 缓冲区/ 所/ 需/ 时间/ :/ 则/ 轮询/ 调度/ 一次/ 所/ 需/ 总/ 时间/ 为/ T/ =/ Tsum/ (/ Nout/ )/ +/ Tsum/ (/ Nin/ )/ Page8/ 因而/ 在/ T/ 时间/ 内/ ,/ 第/ i/ 个/ 输入/ 缓冲区/ 到达/ 的/ 数据包/ 数量/ Ψ/ i/ 为/ 由于/ 时隙/ T/ 值/ 一般/ 较/ 小/ ,/ 因而/ 可/ 认为/ 在/ T/ 时隙/ 内/ 报文/ 到达/ 速率/ 为定值/ ,/ 记/ 为/ λ/ i/ (/ t/ )/ ./ 设/ 第/ i/ 个/ 输入/ 缓冲区/ 的/ 数据包/ 平均/ 长度/ 为/ pi/ ,/ 则/ 输入/ 缓冲区/ 队列/ 长度/ (/ 字节数/ )/ 为/ 对于/ 中间/ 节点/ 和/ 入口/ 节点/ ,/ pi/ 值/ 等于/ 512/ ,/ 而/ 对于/ 出口/ 节点/ 有/ pi/ </ M/ ,/ 其中/ M/ 为/ 网络层/ 最大/ 报文/ 段/ (/ MaximumSegmentSize/ )/ 大小/ ./ 每个/ 输出/ 缓冲区/ 平均/ 有/ g/ -/ 个/ 输入/ 缓冲区/ 与/ 之/ 对应/ ,/ g/ -/ =/ Nin/ // Nout/ ./ 如/ 3.1/ 节中/ 所/ 描述/ ,/ OP/ 程序/ 在/ 构建/ 匿名/ 转发/ 路径/ 时/ 按/ 在线/ 节点/ 的/ 网络带宽/ 进行/ 加权/ 来/ 选择/ 转发/ 节点/ ./ 设/ Tor/ 网络/ 并发/ 用户数/ 为/ U/ ,/ 用户/ u/ 构建/ 的/ 匿名/ 转发/ 路径/ 上/ 出口/ 节点/ 的/ 网络带宽/ 为/ Bx/ (/ u/ )/ ,/ 中间/ 节点/ 的/ 网络带宽/ 为/ Bm/ (/ u/ )/ ./ 根据/ 文献/ [/ 23/ ]/ ,/ 有/ Nout/ =/ U/ ×/ 其中/ ,/ Wx/ =/ 1/ -/ B/ // (/ 3Bn/ )/ ,/ 若/ Bn/ </ B/ // 3/ ,/ 则/ Wx/ =/ 0/ ./ Wn/ =/ 1/ -/ B/ // (/ 3Bx/ )/ ,/ 若/ Bx/ </ B/ // 3/ ,/ 则/ Wn/ =/ 0/ ./ Wn/ 和/ Wx/ 分别/ 表示/ En/ ∩/ x/ 集合/ 中/ 节点/ 被/ 选择/ 入口/ 和/ 出口/ 节点/ 的/ 权重/ ,/ Bn/ 、/ Bx/ 以及/ B/ 等/ 变量/ 符号/ 含义/ 见表/ 1/ ./ 结合/ 式/ (/ 7/ )/ 和/ 式/ (/ 8/ )/ ,/ 从而/ 有/ g/ -/ =/ Bx/ (/ u/ )/ ×/ (/ BxWn/ +/ BnWx/ +/ Bn/ ∩/ x/ ×/ Wx/ ×/ Wn/ +/ Bm/ )/ 对于/ 出口/ 节点/ ,/ 从/ 输入/ 缓冲区/ 连续/ 取出/ 498/ 字节/ 的/ 数据/ ,/ 封装/ 成/ 512/ 字节/ 的/ 信元/ (/ 图/ 4/ )/ 后/ 写入/ 输出/ 缓冲区/ 中/ ,/ 因而/ 输出/ 缓冲区/ 队列/ 长度/ (/ 字节数/ )/ L1/ 计算/ 为/ 而/ 对于/ 中间/ 节点/ 和/ 入口/ 节点/ ,/ 从/ 输入/ 缓冲区/ 取出/ 的/ 是/ 512/ 字节/ 的/ 信元/ ,/ 其/ 输出/ 缓冲区/ 队列/ 长度/ L2/ 计算/ 为/ 信元经/ TLS/ 层/ 加密/ 封装/ 成/ 长度/ 为/ 586/ 字节/ 的/ TLS/ 报文/ (/ 图/ 7/ )/ ,/ 则/ 输出/ 缓冲区/ 对应/ 的/ 网络层/ 报文/ 数量/ O/ 计算/ 为/ O/ =/ 烄/ 烅/ 烆/ L1512/ (/ )/ ×/ 586M/ ,/ forExitNodesL2512/ (/ )/ ×/ 586M/ ,/ forEntry/ 由式/ (/ 12/ )/ 可求/ 出/ 匿名/ 转发/ 节点/ 在/ T/ 时间/ 内/ 产生/ 的/ 网络层/ 报文/ 数量/ ./ 基于/ 此/ ,/ 可以/ 度量/ 相应/ 的/ 时间/ 特征/ 差异/ 度/ ,/ 为/ 后续/ 时间/ 特征/ 的/ 相关/ 分析/ 奠定/ 基础/ ./ 4/ 时间/ 特征/ 的/ 度量/ 与/ 分析/ 本/ 节/ 首先/ 提出/ 一种/ 时间/ 特征/ 差异/ 度/ 度量/ 方法/ ./ 然后/ 结合/ 式/ (/ 12/ )/ ,/ 考虑/ 多/ 转发/ 节点/ 串联/ 情形/ ,/ 对/ 时间/ 特征/ 的/ 差异/ 度/ 进行/ 理论/ 推导/ ,/ 解释/ 说明/ 能够/ 借助/ 其来/ 进行/ 匿名/ 通信/ 追踪/ 的/ 原因/ 和/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ ./ 在/ 此基础/ 上/ ,/ 针对/ ON/ // OFF/ 流水/ 印/ 模型/ ,/ 推导/ 出/ 在/ 满足/ 一定/ 水印/ 检测/ 率/ 的/ 前提/ 下应/ 调制/ 的/ 报文/ 延时/ 幅度/ ,/ 为/ 后续/ 匿名/ 通信/ 相关/ 研究/ 提供/ 理论/ 和/ 实践/ 指导/ ./ 4.1/ 时间/ 特征/ 差异/ 度/ 度量/ 网络/ 流/ 时间/ 特征/ 的/ 表示/ 可/ 有/ 以下/ 两种/ 基本/ 方式/ [/ 14/ ]/ :/ 报文/ 时间/ 间隔/ (/ Inter/ -/ PacketDelay/ )/ 或/ 特定/ 时隙/ 内/ 报文/ 数量/ (/ IntervalPacketCount/ )/ ,/ 现有/ 研究/ 工作/ 均/ 基于/ 这/ 两种/ 表示/ 方式/ 提出/ 不同/ 的/ 时间/ 特征/ 计算方法/ ,/ 如流/ 时隙/ 质心/ 等/ [/ 16/ ]/ ./ 而/ 文献/ [/ 14/ ]/ 进一步/ 指出/ ,/ 利用/ 报文/ 时间/ 间隔/ 来/ 表示/ 时间/ 特征/ 易受/ 丢/ 包/ 等/ 网络/ 因素/ 的/ 影响/ ,/ 同时/ 可/ 由/ 特定/ 时隙/ 内/ 报文/ 数量/ 推导/ 出/ 近似/ 的/ 报文/ 时间/ 间隔/ 分布/ ,/ 因而/ 论文/ 采用/ 特定/ 时隙/ 内/ 报文/ 数量/ 作为/ 抽取/ 时间/ 特征/ 的/ 依据/ ./ 记/ 进入/ 匿名/ 通信/ 系统/ 的/ 原始/ 网络/ 流为/ X/ ,/ 对应/ 离开/ 的/ 匿名/ 通信/ 流为/ Y/ ,/ 对流/ X/ 和/ Y/ 的/ 统计/ 持续时间/ 长度/ 为/ Tf/ ./ 时隙/ 长度/ 为/ T/ ,/ 则/ 将/ 流/ X/ 和/ Y/ 分割/ 成/ Tf/ // T/ 个/ 互不/ 重叠/ 的/ 时间段/ ./ 记/ 时间段/ i/ 内/ 的/ 报文/ 数量/ 为/ ci/ 将/ 向量/ 犞/ X/ 和/ 犞/ Y/ 之间/ 的/ 距离/ 定义/ 为/ 时间/ 特征/ 差异/ 度/ ./ 本文/ 采用/ 傅立叶/ 变换/ 和/ 欧式/ 距离/ 来/ 度量/ 时间/ 特征/ 差异/ 度/ ./ 傅立叶/ 变换/ 将/ 时域/ 向量/ 犞/ X/ 和/ 犞/ Y/ 转换/ 为/ 对应/ 的/ 频域/ 分布/ ,/ 而/ 频域/ 分布/ 的/ 高频/ 部分/ 可/ 认为/ Page9/ 是/ 噪声/ ,/ 因而/ 在/ 计算/ 欧式/ 距离/ 时/ 可先去/ 除/ 噪声/ 部分/ ,/ 减少/ 计算/ 量/ ./ 对/ 向量/ 犞/ X/ 和/ 犞/ Y/ 进行/ 离散/ 傅立叶/ 变换/ :/ 犉/ 犞/ X/ (/ k/ )/ =/ ∑/ Γ/ -/ 1/ 犉/ 犞/ Y/ (/ k/ )/ =/ ∑/ Γ/ -/ 1/ 其中/ ,/ Γ/ =/ Tf/ // T/ 表示/ 分割/ 的/ 时隙/ 数量/ ./ VX/ (/ n/ )/ 和/ VY/ (/ n/ )/ 分别/ 表示/ 向量/ 犞/ X/ 和/ 犞/ Y/ 的/ 第/ n/ 个/ 元素/ ,/ 0/ / n/ / Γ/ -/ 1/ ./ 取向/ 量/ 犉/ 犞/ X/ 和/ 犉/ 犞/ Y/ 前/ H/ 位/ 进行/ 欧式/ 距离/ 计算/ ,/ 则/ 时间/ 特征/ 差异/ 度/ d/ 计算/ 为式/ 中/ d/ 值越/ 大/ ,/ 表明/ 向量/ 间/ 距离/ 越/ 远/ ,/ 因而/ 差异/ 度越/ 大/ ./ 当/ d/ =/ 0/ 时/ ,/ 表示/ 时间/ 特征/ 完全/ 匹配/ ./ 图/ 9/ 考虑/ 干扰/ 流/ 的/ 追踪/ 示意图/ 如图/ 9/ 所示/ ,/ 设/ 匿名/ 转发/ 链路/ 上/ 共有/ l/ 个/ 转发/ 节点/ ,/ l/ / 1/ ,/ 且/ 将/ 从/ 出口/ 节点/ 到/ 入口/ 节点/ 依次/ 编号/ 为/ 1/ 至/ l/ ./ 设在/ T/ 时间/ 内/ 原始/ 网络/ 流/ 含有/ C/ 个/ 数据包/ ,/ 报文/ 长度/ 为/ p/ ,/ C/ / Npkt/ (/ C/ >/ Npkt/ 等价/ 于/ C/ =/ Npkt/ )/ ,/ p/ </ M/ ./ 其中/ ,/ Npkt/ 表示/ 节点/ 一次/ 最多/ 可/ 读取/ 的/ 数据包/ 数量/ ,/ M/ 为/ 网络层/ 最大/ 报文/ 段/ 大小/ ./ 设有/ m/ 个/ 其它/ 服务器/ 与/ 出口/ 节点/ 进行/ 交互/ 且/ 对应/ 同一个/ 输出/ 缓冲区/ ,/ 且/ 在/ T/ 时间/ 内/ 各自/ 包含/ 的/ 数据包/ 为/ CI/ (/ i/ )/ ,/ 报文/ 长度/ 为/ pI/ (/ i/ )/ ,/ CI/ (/ i/ )/ / Npkt/ ,/ pI/ (/ i/ )/ </ M/ ,/ 0/ / i/ / m/ ,/ m/ / 0/ ,/ 且/ 规定/ CI/ (/ 0/ )/ =/ 0/ ,/ pI/ (/ 0/ )/ =/ 0/ ,/ 并称/ 此类/ 数据包/ 为/ 干扰/ 数据包/ ./ 对于/ 该/ 链路/ 出口/ 节点/ 的/ 输入/ 缓冲区/ ,/ 有/ Ψ/ =/ C/ +/ ∑/ m/ 报文/ 数量/ O1/ 计算/ 为/ O1/ =/ L1512/ (/ 4.2/ 基于/ 时间/ 特征/ 的/ 追踪/ 可行性/ 与/ 影响/ 因素/ 分析/ 本/ 节/ 考虑/ 匿名/ 通信/ 系统/ 数据包/ 调度/ 策略/ 和/ 多/ 跳/ 转发/ 机制/ ,/ 结合/ 4.1/ 节中/ 时间/ 特征/ 差异/ 度/ 计算/ 式/ (/ 17/ )/ ,/ 推导/ 出/ 时间/ 特征/ 差异/ 度/ 的/ 具体/ 计算公式/ ,/ 从而/ 说明/ 能够/ 借助/ 时间/ 特征/ 来/ 进行/ 匿名/ 通信/ 追踪/ 的/ 原因/ 和/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ ./ 对图/ 1/ 中/ 的/ 追踪/ 框架/ 进行/ 扩充/ ,/ 考虑/ 干扰/ 流对/ 追踪/ 的/ 影响/ ,/ 其/ 示意图/ 见图/ 9/ ./ 在/ 进行/ 如/ Web/ 访问/ 等/ 网络/ 活动/ 时/ ,/ 用户/ 可能/ 同时/ 访问/ 多个/ Web/ 页面/ ,/ 这些/ Web/ 页面/ 产生/ 的/ 流量/ 则/ 是/ 通过/ 同一个/ 匿名/ 转发/ 链路/ 到达/ 客户端/ ./ 追踪者/ 一次/ 只能/ 在/ 一个/ 返回/ 的/ Web/ 流量/ 中/ 抽取/ 报文/ 数量/ 特征/ 或/ 嵌入/ 水印/ 信息/ (/ 本文/ 称该/ 流为/ 原始/ 网络/ 流/ )/ ,/ 因此/ 其它/ 的/ Web/ 流量/ 对/ 追踪者/ 而言/ ,/ 则/ 为/ 干扰/ 流/ ./ 这些/ 干扰/ 流量/ 可能/ 会/ 消除/ 追踪者/ 所/ 关注/ 的/ 时间/ 特征/ ./ 为/ 便于/ 分析/ ,/ 首先/ 假设/ O1/ / Npkt/ ,/ 本/ 节/ 最后/ 讨论/ O1/ >/ Npkt/ 此/ 情形/ ./ 继续/ 考虑/ 匿名/ 转发/ 路径/ 上/ 其它/ 节点/ ./ 如图/ 9/ 所示/ ,/ 上/ 一/ 跳/ 节点/ 的/ 输出/ 为/ 下/ 一/ 跳/ 节点/ 的/ 输入/ ,/ 设/ 网络/ 传输/ 链路/ 对/ 时间/ 特征/ 的/ 干扰/ 为/ δ/ ,/ 即/ 在/ T/ 时间/ 内有/ O/ -/ δ/ 个/ 数据包/ 发送至/ 下/ 一/ 跳/ 节点/ ./ 传输/ 链路/ 对/ 时间/ 特征/ 的/ 干扰/ 可/ 分为/ 报文/ 丢弃/ 或/ 重传/ 这/ 两类/ [/ 25/ ]/ ,/ 因而/ δ/ 的/ 取值/ 为/ 整数/ ./ Ri/ +/ 1/ 为/ 在/ 第/ i/ +/ 1/ 个/ 转发/ 节点/ 处/ ,/ 其/ 接收/ 到/ 的/ 报文/ 数量/ 由于/ 出口/ 节点/ 数量/ 远/ 小于/ 中间/ 节点/ ,/ 因而/ 可/ 认为/ 出口/ 节点/ 的/ 负载/ 要/ 大于/ 中间/ 节点/ ,/ 即/ 中间/ 节点/ 执行/ 算法/ 1/ 所/ 需/ 的/ 时间/ T/ </ T/ ./ 根据/ 式/ (/ 11/ )/ 和/ (/ 12/ )/ ,/ 中间/ 转发/ 节点/ 对应/ 的/ 发送/ 报文/ 数量/ 为/ (/ 此时/ g/ =/ 1/ )/ :/ 因而/ 在/ 入口/ 节点/ 处/ 对应/ T/ 时间/ 内/ 观察/ 到/ 的/ 报文/ 数量/ OA/ 计算/ :/ Page10/ 由式/ (/ 20/ )/ 递推/ 得/ OA/ =/ Ol/ =/ Ol/ -/ 1/ -/ δ/ l/ -/ 1/ =/ …/ =/ O1/ -/ ∑/ l/ -/ 1/ 将式/ (/ 22/ )/ 代入/ 式/ (/ 17/ )/ 计算/ 时间/ 特征/ 差异/ 度/ :/ (/ FTX/ (/ k/ )/ -/ FTY/ (/ k/ )/ )/ 槡/ d/ =/ ∑/ H/ 槡/ =/ ∑/ H/ 槡/ =/ ∑/ H/ Γ/ nk/ 槡/ 2/ =/ ∑/ H/ 槡/ =/ ∑/ H/ =/ C/ -/ O1/ +/ ∑/ l/ -/ 1/ 其中/ η/ 在/ H/ 与/ Γ/ (/ 4.1/ 节/ )/ 确定/ 时为/ 常量/ ,/ 计算/ 为/ 槡/ k/ =/ 1/ ∑/ Γ/ -/ 1/ η/ =/ ∑/ H/ 因而/ d/ 值仅/ 与/ C/ -/ O1/ +/ ∑/ l/ -/ 1/ 将式/ (/ 18/ )/ 代入/ 式/ (/ 25/ )/ 并/ 消除/ 常数/ ,/ 得/ d/ ∝/ C/ -/ 式/ (/ 26/ )/ 中/ δ/ l/ -/ i/ 为/ 第/ (/ l/ -/ i/ )/ 至/ (/ l/ -/ i/ +/ 1/ )/ 个/ 转发/ 节点/ 间/ 对/ 网络/ 传输/ 链路/ 对/ 时间/ 特征/ 的/ 干扰/ ,/ 具体表现/ 为/ 报文/ 丢失/ 和/ 重传/ ./ 而/ 报文/ 丢失/ 引发/ 相应/ 的/ 重传/ ,/ 因而/ 可/ 认为/ 在/ 时隙/ T/ 内/ 丢弃/ 的/ 报文/ 数量/ |/ q/ |/ 和/ 重传/ 的/ 报文/ 数量/ |/ r/ |/ 服从/ 同一/ 概率分布/ [/ 26/ ]/ ,/ 即/ r/ =/ -/ q/ ,/ 因此/ E/ (/ δ/ )/ =/ E/ (/ q/ +/ r/ )/ =/ 0/ ,/ 从而/ 有/ 据此/ ,/ 将式/ (/ 26/ )/ 化简/ 为/ 在/ 解释/ 基于/ 时间/ 特征/ 匿名/ 通信/ 追踪/ 的/ 合理性/ 时/ ,/ 首先/ 假设/ 不/ 存在/ 干扰/ 流/ ,/ 这些/ 干扰/ 可/ 作为/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ 进一步/ 加以/ 考虑/ ,/ 进而/ 化简/ 式/ (/ 29/ )/ 为/ 由式/ (/ 29/ )/ 知/ ,/ 差异/ 度/ d/ 值仅/ 与/ 流/ 本身/ 的/ 特征/ 相关/ ,/ 如/ 报文/ 数量/ 和/ 报文/ 长度/ 等/ ./ 论文/ 重点/ 关注/ 时间/ 特征/ (/ 在/ 分析/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ 时/ 再/ 考虑/ 报文/ 长度/ )/ ,/ 合理/ 设定/ p/ 为定值/ ,/ 因此/ 影响/ d/ 值/ 的/ 因素/ 仅/ 有/ 特定/ 时隙/ T/ 内/ 的/ 报文/ 数量/ C/ ./ 易知/ ,/ d/ 值/ 与/ C/ 成正/ 相关性/ ,/ 即/ 随着/ C/ 值/ 的/ 增大/ 而/ 增大/ ,/ C/ 值/ 的/ 减小/ 而/ 减小/ ./ 因而/ 可/ 推出/ Tor/ 匿名/ 通信/ 系统对/ 时间/ 特征/ 有着/ 两种/ 不同/ 的/ 改变/ 效果/ ./ 当/ 原始/ 网络/ 流中/ T/ 时隙/ 内/ 报文/ 数量/ 越/ 多/ ,/ 经/ Tor/ 传输/ 后/ 其/ 匿名/ 通信/ 流/ 对应/ 的/ 时隙/ 内/ 报文/ 数量/ 也/ 就/ 改变/ 越大/ ,/ 因此/ 产生/ “/ 平滑/ ”/ 效果/ ,/ 对/ 此类/ 时间/ 特征/ 的/ 改变/ 程度/ 较大/ ./ 但/ 当/ 原始/ 网络/ 流中/ T/ 时隙/ 内/ 报文/ 数量/ 越/ 少/ ,/ Tor/ 对/ 其/ 改变/ 的/ 程度/ 也/ 就/ 越/ 小/ ,/ 从而/ 又/ 维持/ 了/ 此类/ 时间/ 特征/ 的/ 延续性/ ,/ 这/ 便/ 为/ 基于/ 时间/ 特征/ 的/ 追踪/ 技术/ 提供/ 了/ 可行性/ 基础/ ./ 通过/ 延迟/ 报文/ 调整/ 单位/ 时间/ 内/ 的/ 报文/ 数量/ 已/ 成为/ 基于/ 时间/ 特征/ 的/ 主动/ 匿名/ 通信/ 追踪/ 常用/ 方法/ [/ 13/ ,/ 17/ ]/ ,/ 而/ 被动/ 匿名/ 通信/ 追踪/ 也/ 借助/ 原始/ 网络/ 流/ 本身/ 的/ 此类/ 特征/ (/ 如/ 特定/ 时隙/ 内/ 无/ 报文/ )/ 来/ 增加/ 追踪/ 效果/ [/ 3/ ,/ 8/ ]/ ,/ 现有/ 追踪/ 技术/ 的/ 具体实施/ 也/ 体现/ 了/ 上述/ 理论/ 分析/ 的/ 正确性/ ./ 下面/ 分析/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ ./ 记/ 表示/ 干扰/ 强度/ ,/ 即/ 表示/ 在/ 封装/ 成/ Tor/ 信元时/ 缓冲区/ 中/ 干扰/ 数据包/ 对/ 原始/ 网络/ 流中/ 数据包/ 长度/ 的/ 改变/ 程度/ ./ 为/ 表述/ 简洁/ ,/ 令/ y/ =/ C/ -/ 即式/ (/ 28/ )/ 可/ 表示/ 为/ 由式/ (/ 30/ )/ ~/ (/ 32/ )/ 可/ 进一步/ 推导/ 出/ 影响/ 匿名/ 通信/ 追踪/ 效果/ 的/ 因素/ ,/ 具体/ 表述/ 为/ 以下/ 3/ 个/ 命题/ ./ 命题/ 1/ ./ 在/ 无/ 干扰/ 网络/ 流/ 和/ 原始/ 网络/ 流流/ 速率/ 一定/ 时/ ,/ 时间/ 特征/ 差异/ 度/ 随/ 报文/ 长度/ 增大/ 而/ 递减/ ./ 证明/ ./ 无/ 干扰/ 网络/ 流/ ,/ 即/ m/ 值为/ 0/ ./ 此时/ 无/ 干扰/ 数据包/ ,/ 由式/ (/ 30/ )/ 得/ z/ =/ 0/ ,/ 从而/ 化简/ 式/ (/ 31/ )/ 为/ 因为/ 原始/ 网络/ 流流/ 速率/ 一定/ ,/ 即/ C/ ×/ p/ 为定值/ ,/ 因而/ 当/ 报文/ 长度/ 增大/ 即/ p/ 值/ 增大/ 时/ ,/ C/ 值/ 便/ 减小/ ./ 而/ M/ 为/ 网络/ 最大/ 报文/ 段/ 大小/ ,/ 取值/ 固定/ ,/ 因此/ 由式/ (/ 33/ )/ 得/ Page11C/ 值/ 减小/ 使得/ y/ 值/ 减小/ (/ C/ ×/ p/ // M/ 为定值/ )/ ./ 由式/ (/ 32/ )/ 知/ ,/ d/ 正比/ 于/ y/ ,/ 因而/ y/ 值/ 减小/ 即/ d/ 值/ 减小/ ,/ 即/ 时间/ 特征/ 差异/ 度/ 随/ 报文/ 长度/ 增大/ 而/ 递减/ ./ 证毕/ ./ 命题/ 1/ 的/ 本质/ 仍然/ 是/ C/ 值/ 减小/ 从而/ d/ 值/ 减小/ ,/ 但/ 表明/ 除/ 延时/ 报文/ 外/ ,/ 可/ 通过/ 增大/ 报文/ 长度/ 方式/ 来/ 实现/ 减小/ C/ 值/ ./ 可/ 将/ 原始/ 网络/ 流中/ 多个/ 数据包/ 合并/ 为/ 一个/ 数据包/ ,/ 增大/ 报文/ 平均/ 长度/ ,/ 从而/ 减少/ 时间/ 特征/ 差异/ 度/ ./ 命题/ 2/ ./ 在/ 原始/ 网络/ 流中/ 数据包/ 数量/ 和/ 长度/ 一定/ 时/ ,/ 随着/ 干扰/ 强度/ z/ 值/ 的/ 增大/ ,/ 时间/ 特征/ 差异/ 度/ 呈现/ 先/ 减小/ 后/ 增加/ 的/ 趋势/ ./ 证明/ ./ 原始/ 网络/ 流中/ 数据包/ 数量/ 和/ 长度/ 一定/ ,/ 即/ C/ 和/ p/ 值/ (/ p/ </ M/ )/ 一定/ ,/ 由式/ (/ 30/ )/ 知/ 影响/ 干扰/ 强度/ z/ 值/ 的/ 因素/ 有/ 干扰/ 流/ 数量/ m/ 、/ 干扰/ 数据包/ 数量/ CI/ (/ i/ )/ 和/ 其/ 长度/ pI/ (/ i/ )/ ./ 首先/ 分析/ 干扰/ 流中/ 数据包/ 数量/ 和/ 长度/ 一定/ 时/ ,/ 即/ CI/ (/ i/ )/ 和/ pI/ (/ i/ )/ 值/ 一定/ 时/ ,/ 由式/ (/ 30/ )/ 可/ 得/ 干扰/ 流/ 数量/ 增多/ ,/ 干扰/ 强度/ 增大/ ./ 即/ m/ 值/ 增大/ ,/ z/ 值/ 增大/ ./ 在/ 式/ (/ 31/ )/ 中/ ,/ 若/ p/ +/ z/ / M/ ,/ 即/ 输入/ 缓冲区/ 中/ 报文/ 长度/ 小于/ 网络/ 最大/ 报文/ 段/ 的/ 值/ ,/ 则/ 随着/ z/ 值/ 的/ 增大/ ,/ 1/ -/ (/ p/ +/ z/ )/ // M/ 值/ 减小/ ,/ 从而/ y/ 值/ 减小/ ./ 由式/ (/ 32/ )/ 知/ ,/ d/ 值/ 减小/ ,/ 即/ 时间/ 特征/ 差异/ 度/ 减小/ ./ 而/ 当/ p/ +/ z/ >/ M/ 时/ ,/ 式/ (/ 31/ )/ 中/ 1/ -/ (/ p/ +/ z/ )/ // M/ 值为/ 负数/ ,/ 随着/ z/ 值/ 的/ 增大/ ,/ 其/ 绝对值/ |/ 1/ -/ (/ p/ +/ z/ )/ // M/ |/ 增大/ ,/ 从而/ y/ 值/ 增加/ ./ 由式/ (/ 32/ )/ 知/ ,/ d/ 值/ 增大/ ,/ 即/ 时间/ 特征/ 差异/ 度/ 增加/ ./ 同理/ ,/ 当/ m/ 值/ 一定/ 时/ ,/ 随着/ CI/ (/ i/ )/ 或/ pI/ (/ i/ )/ 值/ 增大/ ,/ d/ 值/ 变化趋势/ 相同/ ./ 命题/ 2/ 表明/ 在/ 一定/ 范围/ 内/ (/ p/ +/ z/ / M/ )/ ,/ 干扰/ 数据包/ 有助于/ 减少/ 时间/ 特征/ 差异/ 度/ ./ 追踪者/ 可以/ 预先/ 对/ 目标/ 网络/ 流/ 的/ 报文/ 长度/ 特征/ 进行/ 判断/ ,/ 若/ 报文/ 长度/ 较/ 小/ ,/ 追踪者/ 可以/ 使用/ 相同/ Tor/ 链路/ 进行/ 匿名/ 访问/ ,/ 从而/ 增强/ 追踪/ 效果/ ./ 命题/ 3/ ./ Tor/ 转发/ 节点/ 的/ 数据包/ 处理/ 速率/ 越慢/ ,/ 时间/ 特征/ 差异/ 度越/ 大/ ./ 证明/ ./ 为/ 分析/ 不同/ 的/ 转发/ 节点/ 处理/ 速率/ 对/ 时间/ 特征/ 差异/ 度/ 的/ 影响/ ,/ 规定/ 网络/ 流/ 的/ 流/ 速率/ 一定/ ,/ 且/ 干扰/ 流/ 的/ 数量/ 和/ 报文/ 长度/ 等/ 参数/ 为定值/ ./ 转发/ 节点/ 的/ 处理/ 速率/ 变小/ ,/ 即/ μ/ 值/ 减小/ ,/ 由式/ (/ 4/ )/ 知/ ,/ T/ 值/ 增大/ ,/ 即/ 调度/ 一次/ 所/ 需/ 时间/ 增加/ ./ 不失/ 一般性/ ,/ 令/ 调度/ 时间/ 增加/ k/ 倍/ ,/ 从而/ 增大/ 后/ 的/ 调度/ 时间/ 为/ k/ ×/ T/ ./ 由于/ 原始/ 网络/ 流流/ 速率/ 一定/ ,/ 调度/ 时间/ 增大/ ,/ 则/ 由式/ (/ 5/ )/ 可/ 得出/ 该/ 时间/ 内/ 到达/ 缓冲区/ 的/ 数据包/ 数量/ 增加/ ,/ 即/ C/ 和/ CI/ (/ i/ )/ 值/ 增大/ ,/ 且/ 同/ 增加/ k/ 倍/ ./ 报文/ 长度/ pI/ (/ i/ )/ 、/ 干扰/ 流/ 数量/ m/ 值/ 一定/ ,/ 而/ C/ 和/ CI/ (/ i/ )/ 值同/ 增加/ k/ 倍/ ,/ 从而/ 式/ (/ 30/ )/ 中/ z/ 值/ 不变/ ./ M/ 为/ 网络/ 最大/ 报文/ 段/ 大小/ ,/ 取值/ 固定/ ./ 考察/ 式/ (/ 31/ )/ ,/ p/ 、/ z/ 和/ M/ 值/ 一定/ ,/ C/ 值/ 增大/ 使得/ y/ 值/ 增大/ ./ 由式/ (/ 32/ )/ 得/ ,/ d/ 正比/ 于/ y/ ,/ 从而/ 推出/ μ/ 值/ 减小/ 使得/ d/ 值/ 增大/ ,/ 即/ Tor/ 转发/ 节点/ 的/ 数据包/ 处理/ 速率/ 越慢/ ,/ 时间/ 特征/ 差异/ 度/ 增大/ ./ 命题/ 3/ 表明/ 若/ Tor/ 程序/ 构建/ 的/ 匿名/ 转发/ 路径/ 上/ 有/ 负载/ 重/ 、/ 数据包/ 处理/ 速率/ 慢/ 的/ 节点/ 或/ 有/ 较/ 多/ 突发/ 流量/ 产生/ (/ 突发/ 流量/ 可以/ 增加/ 缓冲区/ 队列/ 数量/ ,/ 从而/ 加重/ 节点/ 负载/ )/ 则/ 会/ 降低/ 匿名/ 通信/ 追踪/ 效果/ ./ 因而/ 在/ 执行/ 追踪/ 前/ 可/ 首先/ 观察/ 监控/ 目标/ 处/ Tor/ 程序/ 构建/ 匿名/ 转发/ 路径/ 时/ 各/ 协商/ 交互/ (/ 见图/ 3/ )/ 所/ 需/ 的/ 时间/ ,/ 若/ 其中/ 有/ 时间/ 间隔/ 较大/ 者/ 则/ 认为/ 该/ 路径/ 上/ 存在/ 数据包/ 处理/ 速率/ 较慢/ 节点/ ,/ 然后/ 通过/ 伪造/ 网络连接/ 断开/ (/ 如/ 发送/ RST/ 报文/ )/ 等/ 隐蔽/ 方式/ 使得/ 该/ 路径/ 失效/ ./ 而/ 监控/ 目标/ 处/ Tor/ 程序/ 会/ 重新/ 选择/ 其它/ 转发/ 路径/ 继续/ 进行/ 数据传输/ ./ 追踪者/ 重复/ 进行/ 上述/ 操作/ 直至/ 新/ 的/ 路径/ 适合/ 开展/ 匿名/ 通信/ 追踪/ ,/ 从而/ 提高/ 追踪/ 准确性/ ./ 以上/ 分析/ 均/ 在/ O1/ / Npkt/ 该/ 条件/ 下/ ,/ 现/ 考虑/ O1/ >/ 当/ O1/ >/ Npkt/ 时/ ,/ 出口/ 节点/ 处/ 的/ 匿名/ 通信/ 流中/ TNpkt/ 此/ 情形/ ./ 时间/ 内/ 包含/ Npkt/ -/ ∑/ l/ -/ 1/ 征/ 差异/ 度/ 计算/ 为/ 槡/ d/ =/ ∑/ H/ =/ C/ -/ Npkt/ +/ ∑/ l/ -/ 1/ 式/ 中/ η/ 如式/ (/ 24/ )/ 所示/ ./ 与/ 式/ (/ 31/ )/ 类似/ ,/ 令/ 显然/ ,/ 上述/ 命题/ 1/ 和/ 3/ 同样/ 成立/ ./ 但/ 因/ Npkt/ 为定值/ ,/ 命题/ 2/ 不再/ 成立/ ./ 式/ (/ 35/ )/ 表明/ 干扰/ 数据包/ 超过/ 一定/ 数量/ 后/ ,/ 对/ 时间/ 特征/ 便/ 无/ 影响/ ./ 这/ 也/ 解释/ 了/ 文献/ [/ 3/ ,/ 25/ ]/ 中/ 所/ 观察/ 到/ 的/ 增加/ 干扰/ 流/ 并/ 不能/ 完全/ 消除/ 时间/ 特征/ 的/ 关联性/ ./ 4.3/ ON/ // OFF/ 流水/ 印/ 模型/ 调制/ 时间/ 分析/ 上/ 一节/ 中/ 分析/ 指出/ ,/ 若/ 原始/ 网络/ 流/ T/ 时隙/ 内/ (/ 即/ Tor/ 节点/ 轮询/ 调度/ 一次/ 所/ 需/ 的/ 时间/ )/ 报文/ 数量/ 越/ 少/ ,/ 则/ Tor/ 对/ 其/ 改变/ 的/ 程度/ 也/ 就/ 越/ 小/ ./ 特别/ 的/ ,/ 当/ T/ 时隙/ 内/ 无/ 任何/ 报文/ 且/ 不/ 存在/ 其它/ 干扰/ 流/ 时/ ,/ 匿名/ 通信/ 流/ 对应/ 时隙/ 内/ 也/ 将/ 无/ 报文/ 出现/ ,/ 这为/ 流水/ 印/ 信号/ 的/ 嵌入/ 提供/ 了/ 有利条件/ ./ 如/ 追踪者/ 可以/ 对/ 原始/ 网络/ 流/ 进行/ 调制/ 以/ 形成/ 一些/ 无/ 报文/ 出现/ 的/ 空/ 时隙/ ,/ 然/ Page12/ 后/ 在/ 目的/ 端/ 检测/ 出/ 这些/ 空隙/ 从而/ 完成/ 匿名/ 通信/ 关系/ 的/ 确认/ ./ 但/ 为/ 在/ 网络/ 流中/ 形成/ 特定/ 时/ 长/ (/ 不仅仅/ 是/ T/ )/ 的/ 空隙/ ,/ 需要/ 对/ 原始/ 网络/ 流/ 报文/ 时间/ 进行/ 调制/ 的/ 具体/ 幅度/ 仍/ 无/ 相关/ 研究/ ./ 为此/ ,/ 本节/ 在/ 4.2/ 节/ 基础/ 上/ ,/ 假设/ 网络延时/ 抖动/ 服从/ 拉普拉斯/ 分布/ [/ 27/ -/ 28/ ]/ ,/ 进一步/ 分析/ 对/ 原始/ 网络/ 流中/ 报文/ 时间/ 进行/ 调制/ 的/ 幅度/ ,/ 使得/ 追踪者/ 能够/ 在/ 匿名/ 通信/ 流中/ 形成/ 与/ 调制/ 幅度/ 相同/ 的/ 空隙/ ,/ 从而/ 嵌入/ 一定/ 水印/ 信号/ 并/ 进行/ 匿名/ 通信/ 追踪/ ./ 论文/ 选择/ 的/ 研究/ 对象/ 为/ ON/ // OFF/ 流水/ 印/ 模型/ ./ ON/ // OFF/ 流水/ 印/ 模型/ [/ 8/ -/ 9/ ]/ 的/ 基本原理/ 可/ 表述/ 如下/ :/ 追踪者/ 以/ 时间/ 长度/ 为/ τ/ 的/ 时隙/ 片段/ 作为/ 水印/ 信号/ 的/ 嵌入/ 对象/ ./ 为/ 嵌入/ 水印/ 信号/ ‘/ 1/ ’/ ,/ 追踪者/ 在/ 时隙/ 开始/ 处/ 发送/ 一个/ 或/ 多个/ 报文/ ;/ 为/ 嵌入/ 水印/ 信号/ ‘/ 0/ ’/ ,/ 追踪者/ 则/ 在/ 该/ 时隙/ 内/ 不/ 发送/ 任何/ 报文/ ./ 在/ 恢复/ 水印/ 信号/ 时/ ,/ 将/ 接收/ 到/ 的/ 网络/ 流/ 划分/ 为/ 多个/ 时间/ 长度/ 同样/ 为/ τ/ 的/ 时隙/ 片段/ ./ 若/ 当前/ 时隙/ 片段/ 内有/ 报文/ 出现/ 时/ ,/ 便/ 为/ ON/ 模式/ ,/ 此/ 阶段/ 可/ 编码/ 为/ 信号/ ‘/ 1/ ’/ ./ 若/ 时隙/ 片段/ 内/ 无/ 报文/ 出现/ ,/ 便/ 进入/ OFF/ 阶段/ ,/ 编码/ 为/ 信号/ ‘/ 0/ ’/ ./ 如能/ 全部/ 恢复/ 出/ 嵌入/ 的/ 水印/ 信号/ ,/ 则/ 追踪/ 成功/ ./ 图形/ 示意/ 见图/ 10/ ./ 图中/ τ/ 表示/ 时隙/ 长度/ ,/ tS/ 报文/ 的/ 发送/ 时刻/ ,/ tA/ 表示/ 水印/ 检测/ 的/ 起始/ 时间/ ./ 在/ 基于/ 时间/ 特征/ 的/ 主动/ 流水/ 印/ 追踪/ 技术/ 中/ ,/ ON/ // OFF/ 模型/ 是/ 基本/ 的/ 追踪/ 方法/ ,/ 而/ 其它/ 追踪/ 技术/ 可/ 认为/ 是/ 对/ 该/ 模型/ 的/ 改进/ [/ 18/ ,/ 20/ -/ 22/ ]/ ./ 如/ 将/ OFF/ 阶段/ 的/ 条件/ 放宽/ ,/ 当/ 报文/ 数量/ 较/ 少时/ 便/ 可/ 编码/ 为/ 信号/ ‘/ 0/ ’/ (/ 流/ 速率/ 模型/ [/ 19/ ,/ 22/ ]/ )/ ,/ 或者/ 以/ 报文/ 集中/ 位于/ 时隙/ 后半段/ 为/ OFF/ 阶段/ ,/ 并/ 将/ ON/ 与/ OFF/ 阶段/ 的/ 报文/ 相对/ 时间差/ 作为/ 水印/ 载体/ (/ 时隙/ 质心/ 模型/ [/ 6/ -/ 7/ ,/ 18/ ,/ 21/ ]/ )/ ,/ 从而/ 提高/ 检测/ 率/ ./ 因此/ ON/ // OFF/ 模型/ 具有/ 代表性/ ,/ 对/ 其/ 展开/ 深入研究/ 具有/ 重要/ 意义/ ./ 如图/ 10/ 所示/ ,/ 成功/ 嵌入/ ON/ // OFF/ 流水/ 印/ 信号/ 的/ 关键步骤/ 是/ 时隙/ τ/ 的/ 选择/ ./ 若/ τ/ 值过/ 小/ ,/ 则/ 时间/ 点/ 2/ 可能/ 会/ 落入/ 其前/ 一个/ 时隙/ ,/ 从而/ 恢复/ 水印/ 失败/ ./ 若/ tA/ τ/ 过大/ ,/ 虽能/ 有效/ 嵌入/ 和/ 提取/ 水印/ 信号/ ,/ 但/ 同时/ 使得/ 水印/ 信号/ 的/ 隐蔽性/ 变差/ ./ 为此/ ,/ 论文/ 给出/ 在/ 需/ 满足/ 一定/ 水印/ 信号/ 检测/ 率/ Pr/ τ/ 的/ 前提/ 下/ 所/ 需/ 调制/ 的/ τ/ 的/ 最小值/ ./ 为/ 便于/ 分析/ ,/ 本文/ 采用/ 与/ 文献/ [/ 9/ ]/ 相同/ 的/ 水印/ 嵌入/ 方法/ ,/ 即/ 针对/ 原始/ 网络/ 流/ ,/ 在/ ON/ 阶段/ 的/ 起始/ 时刻/ 发送/ 一个/ 报文/ ,/ 即/ 在/ 图/ 10/ 中有/ tS/ 段/ 不/ 发送/ 报文/ ,/ ON/ 和/ OFF/ 阶段/ 的/ 持续时间/ 为/ τ/ ./ 在/ 相应/ 匿名/ 通信/ 流中/ ,/ 首先/ 确定/ 信号/ 检测/ 的/ 起始/ 时刻/ ts/ ,/ 然后/ 以/ τ/ 为/ 时间/ 间隔/ ,/ 将/ 统计/ 时隙/ 内/ 是否/ 有/ 报文/ 出现/ ./ 若有/ ,/ 则/ 提取/ 信号/ ‘/ 1/ ’/ ,/ 否则/ ,/ 提取/ 信号/ ‘/ 0/ ’/ ,/ 直至/ 恢复/ 出/ 所有/ 水印/ 信号/ ./ 与/ 4.2/ 节/ 相同/ ,/ 规定/ 匿名/ 转发/ 链路/ 上/ 共有/ l/ 个/ 转发/ 节点/ ,/ l/ / 1/ ,/ 且/ 将/ 出口/ 节点/ 到/ 入口/ 节点/ 依次/ 编号/ 为/ 1/ 至/ l/ ./ 各/ 节点/ 的/ 数据包/ 调度/ 时间/ 为/ Tk/ (/ 0/ / k/ / l/ -/ 1/ )/ ,/ Tk/ 的/ 估算/ 公式/ 为式/ (/ 4/ )/ ./ 服务器/ 与/ 出口/ 节点/ 、/ 转发/ 节点/ 之间/ 的/ 单程/ 传输/ 时延/ 为/ hk/ ./ 定义/ 表示/ 匿名/ 转发/ 路径/ 上/ 各/ 节点/ 调度/ 时间/ 的/ 最大/ 与/ 最小值/ ./ 考虑/ 水印/ 信号/ ‘/ 101/ ’/ ,/ 即/ 两个/ ON/ 阶段/ 间/ 含有/ 1/ 个/ OFF/ 阶段/ ./ 规定/ 水印/ 信号/ 的/ 检测/ 率/ 至少/ 为/ Pr/ τ/ (/ Pr/ τ/ >/ 0.5/ ,/ 否则/ 没有/ 实际意义/ )/ ./ 需要/ 注意/ 的/ 是/ 由于/ τ/ 值/ 与/ 具体/ 水印/ 信号/ 无关/ ,/ 因而/ 针对/ 水印/ 信号/ ‘/ 101/ ’/ 得出/ 的/ 结论/ 同样/ 适用/ 于/ 其它/ 不同/ 的/ 水印/ 信号/ ./ 具体/ 的/ ,/ 在/ 满足/ 检测/ 率/ 至少/ 为/ Pr/ τ/ 的/ 前提/ 下/ ,/ 所/ 需/ 调制/ 的/ τ/ 的/ 最小值/ 如/ 命题/ 4/ 所示/ ./ 命题/ 4/ ./ 在/ 满足/ 检测/ 率/ 大于/ 等于/ Pr/ τ/ 的/ 前提/ 下/ ,/ 所/ 需/ 调制/ 的/ τ/ 的/ 最小/ 取值/ 为/ τ/ min/ =/ l/ β/ ×/ 2/ (/ 1/ -/ Pr/ τ/ )/ (/ lnA2/ +/ 1/ 示/ Tor/ 匿名/ 转发/ 路径/ 长度/ ,/ A/ 计算/ 为/ A/ =/ expTmax/ -/ Tmin/ +/ α/ (/ 抖动/ 分布/ 的/ 位置/ 参数/ 和/ 尺度/ 参数/ ./ 证明/ ./ 由/ 3.2/ 节/ 分析/ 易知/ :/ 否则/ 前后/ 两个/ 报文/ 将/ 在/ Tor/ 输入/ 队列/ 中/ 重叠/ ,/ 不/ 可能/ 形成/ OFF/ 阶段/ ,/ 从而/ 嵌入/ 水印/ 信号/ ‘/ 0/ ’/ 失败/ ./ 如图/ 10/ 所示/ ,/ 为/ 在/ 匿名/ 通信/ 流中/ 成功/ 恢复/ 出/ 水印/ 信号/ ‘/ 101/ ’/ ,/ 需/ 满足/ 以下/ 两个/ 条件/ :/ 由式/ (/ 39/ )/ 、/ (/ 40/ )/ 可得/ Page13/ 即/ 而/ tS/ 其中/ ,/ r1/ 和/ r2/ 分别/ 表示/ 第/ 1/ 个/ 和/ 第/ 2/ 个/ 报文/ 从源/ 端经/ Tor/ 传输/ 至/ 目的/ 端/ 所/ 需要/ 的/ 时间/ ./ 由于/ Tor/ 调度/ 和/ 网络/ 传输/ 抖动/ 的/ 影响/ ,/ r1/ 和/ r2/ 的/ 值/ 可能/ 并/ 不/ 相等/ ./ 由式/ (/ 43/ )/ 知/ ,/ τ/ 值越/ 大/ ,/ r2/ -/ r1/ 的/ 值/ 包括/ 在/ [/ -/ τ/ ,/ τ/ ]/ 中/ 的/ 可能性/ 就/ 越/ 大/ ,/ 从而/ 成功/ 恢复/ 出/ 水印/ 信号/ 的/ 几率/ 也/ 就/ 越/ 大/ ,/ 符合/ 直观/ 判断/ ./ ri/ (/ i/ =/ 1/ ,/ 2/ )/ 计算/ 为/ k/ 表示/ 第/ k/ 个/ 节点/ 处理/ 第/ i/ (/ i/ =/ 1/ ,/ 2/ )/ 个/ 报文/ 所/ 其中/ ,/ ε/ i/ 需/ 的/ 时间/ ,/ hi/ 至/ 第/ k/ +/ 1/ 个/ 节点/ 所/ 需/ 的/ 网络/ 传输/ 时间/ ,/ 从而/ 式/ (/ 43/ )/ 计算/ 为令/ j/ =/ h2/ 献/ [/ 27/ -/ 28/ ]/ 知/ ,/ j/ 服从/ 位置/ 参数/ 为/ α/ ,/ 尺度/ 参数/ 为/ β/ 的/ 拉普拉斯/ 分布/ f/ (/ x/ |/ α/ ,/ β/ )/ =/ 1/ ∑/ l/ (/ ε/ 2k/ -/ ε/ 1k/ =/ 1/ 延时/ 幅度/ 的/ 下限/ ,/ 因而/ 令/ x/ =/ l/ ×/ (/ Tmax/ -/ Tmin/ +/ j/ )/ 表示/ 最大/ 抖动/ 情形/ 的/ 变量/ ,/ 则/ x/ 的/ 概率密度函数/ 为/ f/ (/ x/ )/ =/ 1/ 若/ 满足/ 水印/ 检测/ 率/ 至少/ 为/ Pr/ τ/ ,/ 即式/ (/ 43/ )/ 成立/ 的/ 概率/ 大于/ 等于/ Pr/ τ/ ,/ 应有/ 因为/ Pr/ τ/ >/ 0.5/ ,/ 从而/ 有/ τ/ >/ l/ ×/ (/ Tmax/ -/ Tmin/ +/ α/ )/ ,/ 进而/ 式/ (/ 47/ )/ 计算/ 为/ ∫/ τ/ -/ τ/ f/ (/ x/ )/ dx/ =/ ∫/ l/ (/ Tmax/ -/ Tmin/ +/ α/ )/ ∫/ τ/ l/ (/ Tmax/ -/ Tmin/ +/ α/ )/ -/ τ/ 对式/ (/ 48/ )/ 进行/ 积分/ 运算/ 得/ 1/ -/ 1expl/ (/ Tmax/ -/ Tmin/ +/ α/ )/ -/ τ/ 令/ A/ =/ expTmax/ -/ Tmin/ +/ α/ (/ 同时/ ,/ 结合/ 式/ (/ 38/ )/ 知/ ,/ 在/ τ/ min/ / Tmax/ // 4/ 时/ ,/ 可/ 得出/ 为/ 满足/ 检测/ 率/ 大于/ 等于/ Pr/ τ/ 所/ 需/ 调制/ 的/ τ/ 的/ 最小/ 取值/ 为式/ (/ 51/ )/ 中/ Pr/ τ/ 为/ 追踪者/ 所/ 自行/ 设定/ 的/ 参数/ ,/ l/ 表示/ Tor/ 匿名/ 转发/ 路径/ 长度/ ,/ 其/ 默认值/ 是/ 3/ ,/ 因而/ 可/ 认为/ 是/ 定值/ ./ 为/ 得出/ τ/ min/ 值/ ,/ 追踪者/ 需要/ 知道/ Tmax/ ,/ Tmin/ ,/ α/ ,/ β/ 等/ 参数/ 的/ 值/ ./ 针对/ Tmax/ ,/ Tmin/ 值/ ,/ 可/ 利用/ Tor/ 本身/ 的/ 调度/ 策略/ 来/ 获取/ ./ 如/ 3.1/ 节中图/ 8/ 所示/ ,/ 针对/ 每一/ 链接/ ,/ Tor/ 轮询/ 调度/ 完成/ 后/ 才/ 进行/ 该/ 链接/ 的/ 下/ 一次/ 数据包/ 处理/ ./ 因此/ 可/ 统计/ 与/ 追踪/ 目的/ 端/ 交互/ 的/ Tor/ 节点/ 的/ 报文/ 调度/ 时间/ 间隔/ ,/ 然后/ 取/ 最大/ 时间/ 间隔/ 为/ Tmax/ 值/ ,/ 最小/ 时间/ 间隔/ 为/ Tmin/ 值/ ,/ 从而/ 确定/ 这/ 两个/ 参数/ 的/ 具体/ 数值/ ./ 针对/ α/ ,/ β/ 的/ 取值/ ,/ 追踪者/ 可/ 通过观察/ 追踪/ 目的/ 端/ 与/ Tor/ 节点/ 的/ 网络连接/ ,/ 统计/ 报文/ 的/ 单程/ 传输/ 时间/ ,/ 计算/ 出/ 延时/ 抖动/ 的/ 值/ ,/ 然后/ 采用/ 最大/ 似然/ 估计/ 法/ 计算/ 出/ α/ ,/ β/ 值/ ./ 具体/ 的/ ,/ α/ 取为/ 样本/ 中间/ 值/ ,/ β/ 计算/ 为/ β/ =/ 1/ 样本/ 数量/ ./ 根据/ 文献/ [/ 28/ ]/ ,/ 在/ 大多数/ 网络/ 情形/ 下/ ,/ 网络/ 传输/ 延时/ 抖动/ 分布/ 的/ α/ 值/ 等于/ 0/ ,/ 可/ 进一步/ 简化/ 计算/ ./ 5/ 实验/ 实验/ 的/ 网络/ 环境/ 设置/ 如图/ 11/ 所示/ ,/ 在/ 客户端/ 和/ 服务器/ 处/ 分别/ 运行/ Socket/ 程序/ ./ 客户端/ 通过/ Tor/ 匿名/ 通信/ 系统/ 与/ 服务器端/ 相连接/ ,/ 发出/ 下载/ 数据/ 请求/ 和/ 报文/ 时间/ 间隔/ 参数/ ,/ 而/ 服务器端/ 则/ 根据/ 接收/ 到/ 的/ 参数/ 生成/ 具有/ 不同/ 时间/ 特征/ 的/ 返回/ 数据/ ./ 客户端/ 根据/ 配置/ 参数/ 可/ 运行/ 多个/ 下载/ 数据/ 进程/ 以/ 模拟/ 干扰/ 数据包/ ./ 同时/ ,/ 在/ 客户端/ 和/ 服务器/ 处/ 运行/ Tcpdump/ 程序/ 记录/ 网络层/ 报文/ ,/ 统计/ 特定/ 时隙/ 内/ 报文/ 数量/ ,/ 并/ 借助/ Matlab/ 程序/ 计算/ 快速/ 傅立叶/ 变换/ 和/ 时间/ 特征/ 的/ 差异/ 度/ ./ 根据/ 文献/ [/ 29/ ]/ ,/ 61/ %/ Tor/ 节点/ 调度/ 一次/ 所/ 需/ 时间/ 小于/ 100ms/ ,/ 7.5/ %/ 的/ 节点/ 所/ 需/ 时间/ 大于/ Page14450ms/ ;/ 而/ 对于/ Tor/ 出口/ 节点/ ,/ 40/ %/ 的/ 节点/ 所/ 需/ 时间/ 大于/ 1000ms/ ./ 因而/ 在/ 实验/ 中/ 首先/ 通过/ 统计/ Tor/ 流量/ 的/ 报文/ 调度/ 时间/ 间隔/ ,/ 选择/ 间隔/ 平均值/ 接近/ 0.1/ s/ 、/ 0.5/ s/ 和/ 1s/ 的/ Tor/ 链路/ 进行/ 测试/ 以/ 反映/ 不同/ 的/ 实验/ 环境/ ./ 在/ 计算/ 式/ (/ 17/ )/ 时/ H/ 取值/ 为/ 8/ ,/ 并且/ 进行/ 傅立叶/ 变换/ 时/ 除去/ 了/ 信号/ 直流/ 分量/ ./ 实验/ 中/ Tor/ 匿名/ 转发/ 路径/ 的/ 长度/ 为/ 默认值/ ,/ 即为/ 3/ ./ 首先/ 对式/ (/ 29/ )/ 进行/ 验证/ ./ 由式/ (/ 29/ )/ 知/ ,/ 在/ 无/ 干扰/ 数据包/ 时/ ,/ 可/ 通过/ 调整/ 报文/ 时间/ 间隔/ 来/ 减小/ C/ 值/ ,/ 降低/ 时间/ 特征/ 的/ 差异/ 度/ ,/ 从而/ 达到/ 匿名/ 通信/ 追踪/ 目的/ ./ 实验/ 中/ 通过/ 设置/ 不同/ 报文/ 时间/ 间隔/ 来/ 体现/ 特定/ 时隙/ 内/ 报文/ 数量/ 的/ 减少/ ./ 报文/ 时间/ 间隔/ 设置/ 为/ 10/ ~/ 70ms/ ,/ 报文/ 长度/ 固定/ 为/ 498/ 字节/ ./ 由式/ (/ 17/ )/ 计算/ 时间/ 特征/ 差异/ 度/ ,/ 式/ 中/ H/ 取值/ 为/ 8/ ,/ 并且/ 计算/ 时/ 除去/ 直流/ 分量/ ./ 实验/ 结果/ 如图/ 12/ 所示/ ./ 实验/ 结果表明/ 随着/ 报文/ 时间/ 间隔/ 的/ 增大/ ,/ 时间/ 特征/ 的/ 差异/ 度/ 减小/ ,/ 与/ 4.2/ 节中/ 的/ 理论/ 分析/ 相一致/ ./ 当/ 报文/ 时间/ 间隔/ 大于/ 60ms/ 时/ ,/ 差异/ 度值/ 约等于/ 6/ ,/ 其/ 物理/ 含义/ 可/ 解释/ 为/ 对于/ 提取/ 的/ 原始/ 网络/ 流/ 时间/ 特征/ ,/ 匿名/ 通信/ 系统/ 有/ 1/ // 3/ 的/ 概率/ 对/ 每/ 一/ T/ 时隙/ 内/ 增加/ 、/ 减少/ 一个/ 报文/ 或/ 不/ 改变/ 报文/ 数量/ (/ 此时/ 计算/ 出/ 的/ 差异/ 度值/ 为/ 7/ )/ ,/ 即/ 匿名/ 通信/ 系统/ 维持/ 流/ 原始/ 时间/ 特征/ 基本/ 不变/ ,/ 因而/ 可以/ 借助/ 时间/ 特征/ 来/ 进行/ 匿名/ 通信/ 追踪/ ./ 此外/ ,/ 从图/ 12/ 也/ 可/ 看出/ 轻/ 负载/ 的/ Tor/ 链路/ 的/ 时间/ 特征/ 差异/ 度/ 较/ 小/ ,/ 适合/ 用于/ 匿名/ 通信/ 追踪/ ./ 图/ 12/ 差异/ 度/ 随/ 报文/ 时间/ 间隔/ 的/ 增加/ 而/ 递减/ 命题/ 1/ 表明/ 在/ 网络/ 流/ 速率/ 一定/ 情形/ 下/ ,/ 可/ 通过/ 合并/ 原始/ 网络/ 流中/ 数据包/ 方式/ 来/ 减少/ 时间/ 特征/ 的/ 差异/ 度/ ./ 实验/ 中流/ 速率/ 固定/ 为/ 100Kbit/ // s/ ,/ 报文/ 长度/ 设置/ 为/ 100/ ~/ 600/ 字节/ ,/ 实验/ 结果/ 如图/ 13/ 所示/ ./ 实验/ 结果表明/ 随着/ 报文/ 长度/ 的/ 增加/ ,/ 时间/ 特征/ 的/ 差异/ 度值/ 亦/ 同步/ 递减/ ,/ 与/ 命题/ 1/ 的/ 结论/ 相一致/ ./ 结合/ 式/ (/ 35/ )/ ,/ 命题/ 2/ 表明/ 随着/ 干扰/ 数据包/ 的/ 增多/ ,/ 时间/ 特征/ 的/ 差异/ 度/ 呈现/ 先/ 减小/ 后/ 增加/ ,/ 最后/ 趋于平稳/ 状态/ ./ 实验/ 中/ 通过/ 在/ 客户端/ 发起/ 多个/ 下载/ 数据/ 连接/ 以/ 反映/ 出/ 干扰/ 数据包/ 对/ 差异/ 度/ 的/ 影响/ ./ 正常/ 数据流/ 的/ 参数设置/ 为/ 报文/ 时间/ 间隔/ 为/ 30ms/ ,/ 报文/ 长度/ 为/ 1/ ~/ 1360/ 字节/ 间/ 的/ 随机/ 分布/ ;/ 干扰/ 数据流/ 的/ 参数设置/ 为/ 报文/ 时间/ 间隔/ 为/ 100ms/ ,/ 报文/ 长度/ 同样/ 为/ 1/ ~/ 1360/ 字节/ 间/ 的/ 随机/ 分布/ ./ 实验/ 结果/ 如图/ 14/ 所示/ ,/ 横坐标/ 为/ 干扰/ 数据流/ 的/ 数量/ ,/ 纵坐标/ 为/ 对应/ 计算/ 出/ 的/ 差异/ 度/ ./ 实验/ 结果表明/ 随着/ 干扰/ 数据流/ 数/ 的/ 增加/ ,/ 即/ 干扰/ 数据包/ 的/ 增多/ ,/ 差异/ 度/ 呈现/ 先/ 减小/ 后/ 增加/ ,/ 最后/ 趋于平稳/ 状态/ ,/ 与/ 命题/ 2/ 的/ 结论/ 相一致/ ./ 在/ 干扰/ 数据流/ 数量/ 固定/ 时/ ,/ 增加/ 干扰/ 数据包/ 的/ 数量/ 或/ 数据包/ 长度/ 与/ 图/ 14/ 有/ 类似/ 结果/ ,/ 由于/ 篇幅/ 限制/ ,/ 省去/ 相应/ 的/ 实验/ 结果/ 图/ ./ Page15/ 命题/ 3/ 指出/ 匿名/ 通信/ 链路/ 上/ 若/ 有/ 重/ 负载/ 的/ 转发/ 节点/ 会/ 增加/ 时间/ 特征/ 的/ 差异/ 度/ ./ 实验/ 在/ 配置/ 的/ 内网/ Tor/ 环境/ 中/ 完成/ ./ 固定/ Tor/ 匿名/ 通信/ 链路/ 的/ 出口/ 节点/ ,/ 借鉴/ 文献/ [/ 30/ ]/ 中/ 提出/ 的/ 阻塞/ 攻击/ 思路/ ,/ 在/ 出口/ 节点/ 上/ 部署/ 一/ Socket/ 服务器端/ 程序/ ,/ 该/ 程序/ 接收/ 客户端/ 发送/ 的/ 多组/ 数据/ ,/ 并/ 对/ 接收/ 到/ 的/ 数据/ 执行/ RSA/ 非对称/ 密钥/ 加密/ 操作/ ,/ 最后/ 将/ 加密/ 后/ 的/ 数据/ 返回/ 至/ 客户端/ ./ 通过/ 加密/ 和/ 接收/ // 发送/ 报文/ 操作/ 增加/ 转发/ 节点/ 的/ 系统/ 负载/ ,/ 从而/ 降低/ Tor/ 程序/ 数据包/ 处理/ 速率/ ./ 返回/ 数据流/ 的/ 参数设置/ 为/ 报文/ 时间/ 间隔/ 为/ 30ms/ ,/ 报文/ 长度/ 为/ 1/ ~/ 1360/ 字节/ 间/ 的/ 随机/ 分布/ ./ 实验/ 结果/ 如图/ 15/ 所示/ ,/ 横坐标/ 为/ 客户端/ 数量/ ,/ 纵坐标/ 为/ 对应/ 计算/ 出/ 的/ 差异/ 度/ ./ 实验/ 结果表明/ 随着/ 转发/ 节点/ 系统/ 负载/ 的/ 加重/ ,/ 差异/ 度/ 增加/ ,/ 与/ 命题/ 3/ 相一致/ ./ 图/ 15/ 差异/ 度/ 随/ 转发/ 节点/ 负载/ 的/ 增加/ 而/ 递增/ 对/ 命题/ 4/ 进行/ 实验/ 验证/ ./ 通过/ Tor/ 下载/ FTP/ 数据/ ,/ 在/ FTP/ 服务器端/ 对/ 报文/ 的/ 发送/ 进行/ 调制/ ,/ 从而/ 实现/ ON/ // OFF/ 水印/ 嵌入/ ./ 首先/ 按照/ 4.3/ 节中/ 提出/ 的/ 参数估计/ 方法/ ,/ 对/ Tmax/ ,/ Tmin/ 等值/ 进行/ 估计/ ,/ 估计/ 结果/ 值为/ Tmax/ =/ 115ms/ ,/ Tmin/ =/ 96ms/ ./ 同时/ ,/ 根据/ 文献/ [/ 28/ ]/ 取/ α/ =/ 0/ ,/ β/ =/ 4/ ./ 实验/ 中/ 设定/ 需/ 满足/ 的/ 水印/ 检测/ 率/ Pr/ τ/ 为/ 0.8/ ./ 此时/ ,/ 按式/ (/ 51/ )/ 计算/ 出/ 的/ τ/ min/ 理论值/ 为/ 68ms/ (/ 图/ 16/ 中星/ 点/ 所示/ )/ ./ 由式/ (/ 38/ )/ 知/ ,/ τ/ 的/ 最小值/ 为/ 29ms/ ./ 因此/ 实验/ 中/ τ/ 值/ 从/ 29ms/ ,/ 每隔/ 10ms/ 递增/ 至/ 99ms/ ./ 嵌入/ 的/ 水印/ 信号/ 为/ ‘/ (/ 101/ )/ 50/ ’/ ,/ 即/ 重复/ ‘/ 101/ ’/ 信号/ 50/ 次/ ./ 统计/ 成功/ 检测/ 出/ ‘/ 101/ ’/ 信号/ 的/ 次数/ ,/ 并/ 除以/ 50/ 以/ 作为/ 检测/ 率/ Prd/ ./ 实验/ 结果/ 如图/ 16/ 所示/ ./ 实验/ 结果表明/ 当/ τ/ 值/ 大于/ 等于/ 69ms/ 时/ ,/ 总能/ 满足/ 检测/ 率/ 大于/ 等于/ 0.8/ ,/ 验证/ 了/ 式/ (/ 51/ )/ 的/ 正确性/ ./ 同时/ ,/ 图/ 16/ 也/ 表明/ 了/ 随着/ τ/ 值/ 的/ 增大/ ,/ 成功/ 恢复/ 水印/ 信号/ 的/ 次数/ 增多/ ,/ 与/ 式/ (/ 43/ )/ 的/ 含义/ 相一致/ ./ 6/ 结束语/ 论文/ 以/ Tor/ 匿名/ 通信/ 系统/ 为/ 研究/ 对象/ ,/ 对/ 洋葱/ 路由/ 追踪/ 技术/ 中/ 时间/ 特征/ 展开/ 理论/ 分析/ ./ 深入分析/ Tor/ 数据包/ 调度/ 策略/ ,/ 建立/ 其/ 算法/ 模型/ ,/ 提出/ 数据包/ 输入/ 和/ 输出/ 缓冲区/ 的/ 平均/ 队列/ 长度/ 和/ 对应/ 的/ 网络层/ 报文/ 数量/ 估算/ 方法/ ./ 在/ 此基础/ 上/ ,/ 结合/ 提出/ 的/ 时间/ 特征/ 差异/ 度/ 度量/ 方法/ ,/ 得出/ 可/ 借助/ 时间/ 特征/ 来/ 进行/ 洋葱/ 路由/ 追踪/ 的/ 原因/ 、/ 影响/ 追踪/ 效果/ 的/ 具体/ 因素/ 和/ 为/ 嵌入/ 水印/ 信号/ 所/ 需/ 的/ 报文/ 延时/ 调制/ 幅度/ ./ 主要/ 结论/ 有/ :/ (/ 1/ )/ 时间/ 特征/ 差异/ 度/ 与/ 调度/ 时间/ T/ 内/ 的/ 报文/ 数量/ 成正/ 相关/ ,/ 因而/ 可/ 推出/ Tor/ 匿名/ 通信/ 系统对/ 时间/ 特征/ 有着/ 两种/ 不同/ 的/ 改变/ 效果/ ./ 当/ 原始/ 网络/ 流中/ T/ 时隙/ 内/ 报文/ 数量/ 越/ 多/ ,/ 经/ Tor/ 传输/ 后/ 其/ 匿名/ 通信/ 流/ 对应/ 的/ 时隙/ 内/ 报文/ 数量/ 减少/ 越/ 多/ ,/ 对/ 此类/ 时间/ 特征/ 改变/ 程度/ 较大/ ;/ 但/ 当/ 原始/ 网络/ 流中/ T/ 时隙/ 内/ 报文/ 数量/ 越/ 少/ ,/ Tor/ 对/ 其/ 改变/ 的/ 程度/ 也/ 就/ 越/ 小/ ,/ 从而/ 又/ 维持/ 了/ 此类/ 时间/ 特征/ 的/ 延续性/ ,/ 为/ 基于/ 时间/ 特征/ 的/ 追踪/ 技术/ 提供/ 了/ 可行性/ 基础/ ./ (/ 2/ )/ 在/ 无/ 干扰/ 网络/ 流/ 和/ 原始/ 网络/ 流流/ 速率/ 一定/ 时/ ,/ 时间/ 特征/ 差异/ 度/ 随/ 报文/ 长度/ 增大/ 而/ 递减/ ./ 因而/ 可/ 通过/ 合并/ 报文/ 以/ 增大/ 报文/ 长度/ 等/ 方式/ 来/ 增强/ 匿名/ 通信/ 追踪/ 效果/ ./ (/ 3/ )/ 随着/ 干扰/ 强度/ 的/ 增大/ ,/ 时间/ 特征/ 差异/ 度/ 呈现/ 先/ 减小/ 后/ 增加/ 趋势/ ,/ 并/ 最终/ 趋于稳定/ 状态/ ./ 追踪者/ 可以/ 预先/ 对/ 目标/ 网络/ 流/ 的/ 报文/ 长度/ 特征/ 进行/ 判断/ ,/ 若/ 报文/ 长度/ 较/ 小/ ,/ 追踪者/ 可以/ 使用/ 相同/ Tor/ 链路/ 进行/ 匿名/ 访问/ ,/ 从而/ 增强/ 追踪/ 效果/ ./ (/ 4/ )/ 在/ 数据包/ 速率/ 和/ 平均/ 长度/ 一定/ 的/ 条件/ 下/ ,/ 转发/ 节点/ 的/ 数据包/ 处理/ 速率/ 越慢/ ,/ 时间/ 特征/ 差异/ 度越/ 大/ ./ 可/ 首先/ 观察/ 监控/ 目标/ 出/ 匿名/ 转发/ 路径/ 建立/ 时/ 的/ 时间/ 特征/ 来/ 判断/ 该/ 转发/ 路径/ 上/ 是否/ 存在/ 数据包/ 处/ Page16/ 理/ 速率/ 越慢/ 节点/ ,/ 然后/ 通过/ 使/ 转发/ 路径/ 失效/ 等/ 方式/ 选择/ 新/ 的/ 、/ 适合/ 的/ 路径/ 进行/ 匿名/ 通信/ 追踪/ ,/ 提高/ 追踪/ 准确性/ ./ (/ 5/ )/ 在/ 满足/ ON/ // OFF/ 流水/ 印/ 的/ 检测/ 率/ 大于/ 等于/ Pr/ τ/ 的/ 前提/ 下/ ,/ 报文/ 调制/ 时间/ τ/ 的/ 最小/ 取值/ 为/ τ/ min/ =/ l/ β/ ×/ lnA2/ +/ 1/ 论文/ 通过/ Tor/ 实验/ 环境/ 验证/ 了/ 上述/ 结论/ 的/ 正确性/ ./ 下/ 一步/ 研究/ 工作/ 包括/ :/ 在/ 理论/ 研究成果/ 基础/ 上/ ,/ 进一步/ 设计/ 新/ 的/ 流水/ 印/ 追踪/ 技术/ ,/ 并/ 通过/ 在/ 实际/ 网络/ 中/ 的/ 部署/ 对/ 本文/ 工作/ 进行/ 更/ 全面/ 的/ 验证/ ;/ 研究/ 新/ 的/ 匿名/ 通信/ 数据包/ 调度/ 策略/ (/ 如/ 在/ 无/ 报文/ 的/ 时隙/ 内/ 增加/ 适量/ 填充/ 报文/ 等/ )/ ,/ 在/ 保证/ 性能/ 的/ 同时/ ,/ 能/ 最大/ 程度/ 改变/ 时间/ 特征/ ,/ 从而/ 更好/ 保护/ 互联网/ 用户/ 的/ 隐私/ 信息/ ./ 

