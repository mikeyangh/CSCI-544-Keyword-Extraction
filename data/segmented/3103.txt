Page1/ 高效/ 的/ 随机/ 访问/ 分块/ 倒排/ 文件/ 自/ 索引/ 技术/ 刘/ 小珠/ 1/ )/ ,/ 2/ )/ 彭智勇/ 3/ )/ 陈旭/ 3/ )/ 1/ )/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430072/ )/ 2/ )/ (/ 武汉理工大学/ 自动化/ 学院/ 武汉/ 430070/ )/ 3/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 摘要/ 针对/ 倒排/ 索引/ 空间/ 开销/ 大/ 、/ 查询/ 时间/ 效率/ 低/ 以及/ 难以/ 同时/ 支持/ 连接/ 布尔/ 查询/ 和/ 排序/ 查询/ 的/ 问题/ ,/ 提出/ 了/ 一种/ 同时/ 提高/ 空间/ 效率/ 与/ 查询/ 时间/ 效率/ 的/ 高效/ 随机/ 访问/ 分块/ 倒排/ 文件/ 自/ 索引/ RABIF/ ./ 为了/ 在/ 降低/ 空间/ 消耗/ 的/ 同时/ 支持/ 连接/ 布尔/ 查询/ 与/ 排序/ 查询/ ,/ RABIF/ 将/ 倒/ 排列/ 表/ 进行/ 合理/ 地/ 分块/ ,/ 然后/ 对/ 每个/ 子块/ 的/ 不同/ 部分/ 采用/ 相应/ 的/ 压缩/ 方式/ ,/ 在/ 不/ 需要/ 插入/ 任何/ 附加/ 辅助/ 信息/ 的/ 前提/ 下/ 实现/ 压缩/ 索引/ 的/ 快速/ 定位/ 与/ 随机/ 访问/ ./ 理论/ 分析/ 及/ 实验/ 结果表明/ ,/ 与/ 忽略/ 倒排/ 文件/ 自/ 索引/ SIF/ 相比/ ,/ 提出/ 的/ RABIF/ 空间/ 开销/ 平均/ 减少/ 5.3/ %/ ,/ 布尔/ 查询/ 时间/ 平均/ 减少/ 17.8/ %/ ;/ 对于/ 0.2/ %/ 与/ 1/ %/ 排序/ 查询/ ,/ 查询/ 时间/ 分别/ 平均/ 减少/ 34.4/ %/ 与/ 27.5/ %/ ./ 关键词/ 倒排/ 文件/ ;/ 自/ 索引/ ;/ 时间/ 效率/ ;/ 空间/ 效率/ ;/ 随机/ 访问/ 1/ 引言/ 随着/ 文本/ 信息量/ 的/ 迅速/ 增长/ ,/ 对/ 高性能/ 全文检索/ 系统/ 的/ 需求/ 越来越/ 迫切/ ./ 如何/ 快捷/ 有效/ 地/ 管理/ 和/ 检索/ 文本/ 这种/ 非/ 结构化/ 的/ 数据/ 成为/ 一项/ 紧迫/ 的/ 研究/ 任务/ [/ 1/ -/ 2/ ]/ ./ 由于/ 倒排/ 索引/ 技术/ 具有/ 实现/ 相对/ 简单/ 、/ 查询/ 速度/ 快/ 以及/ 易于/ 支持/ 同义词/ 查询/ 等/ 扩展/ 功能/ 的/ 优点/ ,/ 被/ 广泛应用/ 于/ 大规模/ 文本/ 集/ [/ 3/ ]/ 与/ 其它/ 各种/ 信息/ 的/ 检索/ [/ 4/ -/ 5/ ]/ ./ 但/ 面对/ 与日俱增/ 的/ 海量/ 文本/ 信息/ ,/ 倒排/ 索引/ 空间/ 开销/ 大/ 、/ 查询/ 效率/ 低/ 的/ 弊端/ 日益/ 凸现/ [/ 6/ ]/ ,/ 如何/ 在/ 降低/ 倒排/ 索引/ 存储空间/ 的/ 同时/ 提高/ 查询/ 效率/ 成为/ 全文检索/ 的/ 突出/ 问题/ ./ 采用/ 适当/ 的/ 编码/ 策略/ 对/ 倒排/ 索引/ 进行/ 压缩/ ,/ 不仅/ 可以/ 节省/ 存储空间/ ,/ 而且/ 可以/ 减少/ 查询/ 时/ 读取/ 索引/ 数据/ 所/ 需/ 的/ 磁盘/ I/ // O/ 次数/ 与/ 时间/ ,/ 从而/ 提高/ 检索/ 速度/ [/ 1/ ,/ 7/ -/ 8/ ]/ ./ 因此/ ,/ 当前/ 大多数/ 研究/ 都/ 集中/ 在/ 如何/ 对/ 倒排/ 索引/ 进行/ 有效/ 的/ 压缩/ 方面/ [/ 1/ -/ 3/ ]/ ./ 为了/ 降低/ 倒排/ 索引/ 的/ 存储空间/ ,/ Moffat/ 等/ [/ 9/ ]/ 提出/ 了/ 一种/ 递归/ 的/ 二进制/ 内/ 插/ 编码/ (/ BinaryInterpolativeCoding/ ,/ BIC/ )/ 算法/ 对/ 倒排/ 索引/ 进行/ 压缩/ ;/ BIC/ 利用/ 相邻/ 两个/ 数/ 的/ 信息/ ,/ 对/ 单调/ 递增/ 的/ 倒/ 排列/ 表/ 进行/ 紧凑/ 的/ 递归/ 编码/ ,/ 不仅/ 压缩率/ 高/ ,/ 而且/ 解码/ 速度/ 快/ ;/ 该/ 算法/ 还/ 考虑/ 了/ 文档/ 中/ 词/ 出现/ 的/ 频率/ 分布/ ,/ 以聚类/ (/ clustering/ )/ 的/ 方式/ 对/ 倒/ 排列/ 表/ 的/ 压缩/ 性能/ 进行/ 优化/ ,/ 有效/ 地/ 提高/ 了/ 索引/ 的/ 空间/ 效率/ ./ 文献/ [/ 10/ ]/ 采用/ 基于/ 字行/ 的/ 二进制/ 编码方式/ (/ Word/ -/ AlignedBinaryCode/ ,/ WABC/ )/ 对/ 索引/ 进行/ 压缩/ ;/ 该/ 编码/ 具有/ 字节/ 操作/ 的/ 优点/ ,/ 其/ 紧凑/ 的/ 二进制/ 特性/ 不仅/ 保证/ 了/ 索引/ 的/ 压缩/ 性能/ ,/ 而且/ 提高/ 了/ 查询/ 时倒/ 排列/ 表/ 的/ 解码/ 速度/ ./ 针对/ WABC/ 中/ 每个/ 字/ (/ 32/ 比特/ )/ 存在/ 部分/ 比特/ 浪费/ 的/ 缺点/ ,/ Anh/ 等/ [/ 11/ ]/ 提出/ 了/ 一种/ 压缩/ 性能/ 更/ 高/ 的/ 滑动/ (/ sliding/ )/ 压缩算法/ ;/ 其/ 思想/ 是/ 充分利用/ 每个/ 字/ 中/ 的/ 剩余/ 比特/ 存储/ 索引/ 信息/ ,/ 提高/ 空间/ 利用率/ ;/ 但/ 其/ 解压/ 复杂性/ 更高/ ,/ 在/ 一定/ 程度/ 上/ 降低/ 了/ 查询/ 性能/ ./ 考虑/ 到/ 倒/ 排列/ 表中/ 数据分布/ 的/ 特性/ ,/ 文献/ [/ 12/ ]/ 提出/ 了/ 一种/ 基于/ 聚类/ 的/ 混合/ 编码/ 压缩算法/ ;/ 该/ 算法/ 根据/ 设定/ 的/ 阈值/ ,/ 将/ 倒/ 排列/ 表中/ 的/ 整数/ 按/ 其/ 差值/ 与/ 阈值/ 之间/ 的/ 大小/ 关系/ 分成/ 不同/ 的/ 簇/ ,/ 然后/ 对/ 小于/ 阈值/ 的/ 簇/ 与/ 大于/ 阈值/ 的/ 簇/ 分别/ 采用/ 不同/ 的/ 压缩/ 编码/ 算法/ ,/ 以/ 提高/ 索引/ 的/ 空间/ 性能/ ;/ 但/ 如何/ 确定/ 合适/ 的/ 阈值/ 以及/ 这种/ 混合/ 编码方式/ 在/ 查询/ 时/ 的/ 解码/ 性能/ 如何/ ,/ 该文/ 并/ 没有/ 阐述/ ./ 文献/ [/ 13/ ]/ 中/ 同时/ 考虑/ 了/ 搜索引擎/ 中/ 的/ 索引/ 压缩/ 与/ 索引/ 缓存/ 机制/ ,/ 并/ 对/ 变/ 比特/ 编码/ 等/ 几种/ 压缩算法/ 的/ 性能/ 进行/ 了/ 比较/ 分析/ ./ 为了/ 进一步提高/ 检索/ 性能/ ,/ 文献/ [/ 14/ -/ 17/ ]/ 对/ 倒/ 排列/ 表/ 文档/ 标识/ (/ Identity/ ,/ ID/ )/ 整数/ 集/ 的/ 升序/ 特征/ 进行/ 了/ 研究/ ,/ 通过/ 更加/ 紧凑/ 的/ 表示/ 方法/ 、/ 快速/ 求/ 交集/ 算法/ 以及/ 对/ 文档/ ID/ 顺序/ 进行/ 优化/ ,/ 提高/ 查询/ 效率/ ./ 文献/ [/ 7/ -/ 8/ ,/ 18/ ]/ 通过/ 实验/ 研究/ 进一步/ 表明/ 了/ 对/ 索引/ 进行/ 压缩/ 不仅/ 可以/ 提高/ 空间/ 效率/ ,/ 而且/ 有助于/ 提高/ 访问速度/ ./ 为了/ 在/ 降低/ 倒排/ 索引/ 存储空间/ 的/ 同时/ 提高/ 查询/ 效率/ ,/ Moffat/ 等/ [/ 3/ ,/ 19/ ]/ 提出/ 了/ 一种/ 有效/ 的/ 忽略/ 倒排/ 文件/ (/ SkippedInvertedFile/ ,/ SIF/ )/ 自/ 索引/ (/ Self/ -/ index/ )/ ;/ SIF/ 将/ 倒/ 排列/ 表/ 分成/ 多个/ 子块/ ,/ 通过/ 在/ 相邻/ 子块间/ 插入/ 少量/ 的/ 忽略/ 信息/ (/ Skippinginformation/ )/ ,/ 使得/ 查询/ 时/ 只/ 需/ 对/ 压缩/ 索引/ 进行/ 部分/ 解码/ ,/ 从而/ 提高/ 检索/ 的/ 时间/ 效率/ ;/ 当/ 选择/ 合适/ 的/ 子块/ 大小/ 并/ 以/ 递归/ 方式/ 对/ 倒/ 排列/ 表/ 进行/ 压缩/ 时/ ,/ 可以/ 提高/ 存储空间/ 与/ 查询/ 时间/ 效率/ ;/ 但/ 该/ 方法/ 存在/ 以下/ 问题/ :/ (/ 1/ )/ 加入/ 的/ 辅助/ 信息/ 增加/ 了/ 索引/ 的/ 空间/ 消耗/ ,/ 尤其/ 是/ 当子/ 块/ 较/ 小时/ ,/ 辅助/ 信息/ 所/ 造成/ 的/ 额外/ 空间/ 开销/ 将/ 不可/ 忽略/ ,/ 空间/ 效率/ 将/ 大大/ 下降/ ;/ (/ 2/ )/ 无法/ 找到/ 合适/ 的/ 子块/ 大小/ 使得/ 空间/ 效率/ 与/ 连接/ 布尔/ 查询/ 、/ 排序/ 查询/ 等/ 性能/ 同时/ 提高/ ./ 尽管/ 上述/ 研究/ 工作/ 对/ 倒排/ 索引/ 的/ 时间/ 和/ 空间/ 性能/ 进行/ 了/ 改进/ ,/ 但/ 仍然/ 存在/ 以下/ 问题/ [/ 20/ ]/ :/ (/ 1/ )/ 倒排/ 文件/ 存储空间/ 与/ 查询/ 时间/ 效率/ 还有/ 待/ 进一步提高/ ./ 上述/ 方法/ 大多/ 只/ 针对/ 其中/ 的/ 一个/ 性能/ 进行/ 研究/ ,/ 或/ 提高/ 了/ 一个/ 性能/ 却/ 导致/ 另/ 一个/ 性能/ 恶化/ ./ 如何/ 实现/ 空间/ 效率/ 与/ 时间/ 效率/ 的/ 性能/ 折衷/ 具有/ 相当/ 的/ 挑战性/ ./ (/ 2/ )/ 上述/ 研究/ 方法/ 并/ 没有/ 充分考虑/ 索引/ 查询/ 的/ 可扩展性/ ,/ 无法/ 同时/ 适应/ 不同/ 查询/ 方式/ 快速/ 定位/ 与/ 解码/ 的/ 要求/ ,/ 导致/ 查询/ 性能/ 相差/ 较大/ ./ 如/ 排序/ 查询/ 需要/ 访问/ 倒/ 排列/ 表中/ 的/ 词频/ 信息/ ,/ 现有/ 方法/ 必须/ 完全/ 解码/ 索引/ 才能/ 实现/ 词频/ 信息/ 的/ 访问/ ,/ 导致/ 时间/ 消耗/ 较大/ ./ (/ 3/ )/ 当倒/ 排列/ 表/ 被/ 分成/ 大量/ 的/ 小块/ 时/ ,/ 现有/ 方法/ 不仅/ 会/ 导致/ 大量/ 的/ 额外/ 空间/ 开销/ ,/ 而且/ 由此/ 产生/ 的/ 磁盘/ I/ // O/ 时间/ 将/ 超过/ 压缩/ 所/ 带来/ 的/ 性能/ ./ 本文/ 针对/ 倒排/ 文件/ 空间/ 开销/ 大/ 、/ 查询/ 效率/ 低/ 以及/ 难以/ 同时/ 支持/ 连接/ 布尔/ 查询/ 和/ 排序/ 查询/ 的/ 问题/ ,/ 提出/ 一种/ 同时/ 提高/ 存储空间/ 与/ 查询/ 效率/ 的/ 高效/ 随机/ 访问/ 分块/ 倒排/ 文件/ 自/ 索引/ RABIF/ ./ RABIF/ 将/ 倒/ 排列/ 表/ 进行/ 合理/ 地/ 分块/ ,/ 然后/ 对/ 每个/ 子块/ 的/ 不同/ 部分/ 采用/ 相应/ 的/ 压缩/ 方式/ ,/ 以/ 提高/ 索引/ 的/ 压缩率/ ;/ 同时/ 采用/ 高效/ 的/ 二进制/ 内/ 插/ 编码方式/ ,/ 在/ 不/ 需要/ 插入/ 任何/ 附加/ 辅助/ 信息/ 的/ 前提/ 下/ 实现/ 压缩/ 索引/ 查询/ 的/ 快速/ 定位/ ,/ 使得/ 压缩/ 索引/ 具有/ 随机/ 访问/ 能力/ ,/ 在/ 查询/ 时/ 只/ 对/ 索引/ 中/ 需要/ 的/ 部分/ 进行/ 解码/ ,/ 以/ 提高/ 检索/ 的/ 时间/ 效率/ ./ 与/ 现有/ 的/ 工作/ 相比/ ,/ 提出/ 的/ RABIF/ 自/ 索引/ 具有/ Page3/ 以下/ 特点/ :/ (/ 1/ )/ 在/ 不/ 插入/ 任何/ 附加/ 辅助/ 信息/ 的/ 前提/ 下/ ,/ 压缩/ 的/ RABIF/ 索引/ 具有/ 快速/ 定位/ 与/ 随机/ 访问/ 能力/ ;/ (/ 2/ )/ 具有/ 快速/ 的/ 连接/ 布尔/ 查询/ 与/ 排序/ 查询/ 性能/ ;/ (/ 3/ )/ 同时/ 提高/ 了/ 存储空间/ 效率/ 与/ 查询/ 时间/ 效率/ ./ 2/ 随机/ 访问/ 分块/ 倒排/ 文件/ 自/ 索引/ 为了/ 在/ 提高/ 索引/ 空间/ 效率/ 的/ 同时/ ,/ 支持/ 高效/ 的/ 连接/ 布尔/ 查询/ 和/ 排序/ 查询/ ,/ 提出/ 的/ 倒排/ 文件/ 自/ 索引/ RABIF/ 的/ 思想/ 是/ :/ 将/ 倒/ 排列/ 表/ 进行/ 分块/ ,/ 构造/ 一种/ 具有/ 随机/ 访问/ 功能/ 的/ 分块/ 倒/ 排列/ 表/ ./ 每个/ 子块/ 由/ 两/ 部分/ 组成/ :/ 第一部/ 分为/ 定位/ 部分/ ./ 采用/ d/ -/ gap/ 压缩/ 方式/ ,/ 实现/ 压缩/ 索引/ 查询/ 的/ 快速/ 定位/ ,/ 使得/ 压缩/ 索引/ 在/ 不/ 解压/ 的/ 情况/ 下/ 具有/ 子块级/ 的/ 随机/ 访问/ 能力/ ,/ 以/ 提高/ 查询/ 时间/ 效率/ ;/ 第二/ 部分/ 为/ 信息/ 部分/ ./ 以/ 部分/ 解码/ 的/ 方式/ 支持/ 连接/ 布尔/ 查询/ 与/ 排序/ 查询/ ,/ 并/ 以/ 高效/ 的/ 二进制/ 内/ 插/ 编码方式/ 进行/ 压缩/ ,/ 在/ 不/ 需要/ 插入/ 任何/ 辅助/ 信息/ 的/ 前提/ 下/ ,/ 实现/ 查询/ 时子/ 块/ 内/ 信息/ 的/ 随机/ 访问/ 与/ 快速/ 定位/ 功能/ ,/ 在/ 减少/ 空间/ 消耗/ 的/ 同时/ 提高/ 查询/ 效率/ ./ 2.1/ 索引/ 结构/ 与/ 创建/ 提出/ 的/ 倒排/ 文件/ 自/ 索引/ RABIF/ 的/ 结构/ 如图/ 1/ 所示/ ./ 索引/ 由/ 词典/ (/ Dictionary/ )/ 和/ 分块/ 倒/ 排列/ 表/ (/ Postinglists/ )/ 组成/ ./ 词典/ 包含/ 两/ 部分/ 信息/ :/ (/ 1/ )/ 词/ wi/ 以及/ 包含/ 该词/ 的/ 文档/ 数量/ si/ ;/ (/ 2/ )/ 指向/ 包含/ wi/ 具体位置/ 信息/ 的/ 分块/ 倒/ 排列/ 表/ Lblocki/ 由/ m/ 个子/ 块/ SBr/ (/ r/ ∈/ [/ 1/ ,/ m/ ]/ )/ 组成/ ,/ 每个/ 子块表/ LblockSBr/ 包括/ 定位/ 部分/ Locr/ 与/ 信息/ 部分/ Ir/ ./ 定位/ 部分/ Locr/ 为子/ 块/ SBr/ 的/ 第一个/ 文档/ 标识/ (/ Identity/ ,/ ID/ )/ 与/ 累计/ 词频/ 信息/ 序列/ 对/ ;/ 除了/ 第/ m/ 个子/ 块/ SBm/ 的/ 信息/ 部分/ Im/ 保持/ 原倒/ 排列/ 表/ Li/ 中/ 文档/ ID/ 与/ 累计/ 词频/ 信息/ 序列/ 对/ 的/ 格式/ 外/ ,/ 其它/ 子块/ 的/ 信息/ 部分/ Ir/ 由/ 其它/ k/ -/ 1/ 个/ 信息/ 对/ 分别/ 按/ 文档/ ID/ 与/ 累计/ 词频/ 的/ 升序/ 排列/ 而成/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 组成/ ./ 对于/ 包含/ n/ 个/ 信息/ 序列/ 对/ (/ dj/ ,/ fqj/ )/ 的/ 倒/ 排列/ 表/ Li/ :/ Li/ =/ (/ d1/ ,/ fq1/ )/ ,/ (/ d2/ ,/ fq2/ )/ ,/ …/ ,/ (/ dn/ ,/ fqn/ )/ (/ 1/ )/ 其中/ dj/ 表示/ 文档/ 的/ ID/ ,/ 且/ 有/ dj/ </ dj/ +/ 1/ ,/ j/ ∈/ [/ 1/ ,/ n/ -/ 1/ ]/ ,/ fqj/ 表示/ 该词/ 在/ 文档/ dj/ 中/ 出现/ 的/ 次数/ ./ 分块/ 倒/ 排列/ 表/ Lblocki/ 的/ 构建/ 算法/ BIL/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 分块/ 倒/ 排列/ 表/ 构建/ 算法/ BIL/ ./ 输入/ :/ 倒/ 排列/ 表/ Li/ ,/ 每个/ 子块/ 包含/ 的/ 信息/ 序列/ 对数/ k/ 输出/ :/ 分块/ 倒/ 排列/ 表/ Lblock1/ ./ 对/ Li/ 中/ 的/ 词频/ fqj/ 以/ 累加/ 方式/ 得到/ 累计/ 词频/ fj/ ,/ 并用/ fj/ 替换/ fqj/ ,/ 实现/ fj/ 的/ 升序/ 排列/ ./ 2/ ./ 以/ k/ 个/ 信息/ 序列/ 对/ 为/ 单位/ 将/ Li/ 分成/ m/ 个子/ 块/ SBr/ ./ 3/ ./ 对前/ m/ -/ 1/ 个子/ 块/ SBr/ 的/ 信息/ 部分/ Ir/ ,/ 分别/ 将/ 文档/ ID/ 与/ 累计/ 词频/ 按照/ 其/ 原来/ 的/ 先后顺序/ 排成/ 文档/ ID/ 和/ 累计/ 词频/ 两个/ 列表/ LDr/ 与/ LFr/ ./ 对/ LDr/ 与/ LFr/ 采用/ C2/ 编码方式/ 进行/ 压缩/ ./ 4/ ./ 对/ 所有/ 子块/ SBr/ 的/ 定位/ 部分/ Locr/ 以及/ 第/ m/ 个子/ 块/ SBm/ 的/ 信息/ 部分/ 进行/ d/ -/ gap/ 压缩/ ,/ 并/ 采用/ 编码方式/ C1/ 进行/ 压缩/ ./ 5/ ./ 返回/ 分块/ 倒/ 排列/ 表/ Lblock/ 根据/ BIL/ 算法/ ,/ 首先/ 用/ fj/ 替换/ 词频/ fqj/ :/ 然后/ 将/ 倒/ 排列/ 表/ Li/ 分成/ m/ 个子/ 块/ SBr/ (/ r/ ∈/ [/ 1/ ,/ m/ ]/ )/ ,/ 且/ 每个/ 子块/ 包含/ 定位/ 部分/ Locr/ 与/ 信息/ 部分/ Ir/ ./ 则/ 有/ 其中/ k/ 为/ 每个/ 子块/ 中/ 包含/ 的/ 信息/ 序列/ 对/ 的/ 数量/ ./ 对于/ 第/ m/ 个子/ 块/ ,/ 其/ 信息/ 序列/ 对/ 的/ 数量/ 可能/ 小于/ k/ ./ 根据/ BIL/ 算法/ 的/ 第/ 3/ 步/ ,/ 对于/ 定位/ 部分/ Locr/ 有/ 其中/ dr/ 和/ fr/ 分别/ 表示/ 第/ r/ 个子/ 块/ 的/ 第/ 1/ 个/ 信息/ 序列/ 对/ 的/ 文档/ ID/ 与/ 累计/ 词频/ ,/ 且/ 有/ 对于/ 信息/ 部分/ Ir/ 有/ Ir/ =/ (/ LDr/ ,/ LFr/ )/ ,/ 烅/ 烄/ (/ dk/ (/ m/ -/ 1/ )/ +/ 2/ ,/ fk/ (/ m/ -/ 1/ )/ +/ 2/ )/ ,/ …/ ,/ (/ dn/ ,/ fn/ )/ ,/ r/ =/ 烆/ LDr/ =/ (/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 2/ ,/ …/ ,/ dk/ ·/ r/ )/ ,/ r/ ∈/ [/ 1/ ,/ m/ -/ 1/ ]/ (/ 9/ )/ LFr/ =/ (/ fk/ ·/ (/ r/ -/ 1/ )/ +/ 2/ ,/ …/ ,/ fk/ ·/ r/ )/ ,/ r/ ∈/ [/ 1/ ,/ m/ -/ 1/ ]/ (/ 10/ )/ 然后/ 对/ LDr/ 与/ LFr/ 采用/ C2/ 编码方式/ 进行/ 压缩/ ./ 根据/ BIL/ 算法/ 的/ 第/ 4/ 步/ ,/ 对/ 所有/ 子块/ 的/ 定位/ 部/ Page4/ 分/ 进行/ d/ -/ gap/ 压缩/ 后/ 有/ dr/ =/ d1/ ,/ fr/ =/ f1/ ,/ 从/ 表达式/ (/ 8/ )/ 中/ 可以/ 看出/ ,/ 由于/ 第/ m/ 个子/ 块/ SBm/ 的/ 信息/ 部分/ Im/ 维持/ 原倒/ 排列/ 表/ Li/ 中/ 信息/ 序列/ 对/ 格式/ ,/ 即当/ j/ ∈/ [/ (/ m/ -/ 1/ )/ k/ +/ 1/ ,/ n/ ]/ 时/ ,/ 信息/ 部分/ 格式/ 为/ (/ dj/ ,/ fj/ )/ ,/ 因此/ 采用/ d/ -/ gap/ 压缩/ 后/ 有/ dj/ =/ dj/ -/ dj/ -/ 1/ ,/ j/ ∈/ [/ (/ m/ -/ 1/ )/ k/ +/ 2/ ,/ n/ ]/ (/ 13/ )/ fj/ =/ fj/ -/ fj/ -/ 1/ ,/ j/ ∈/ [/ (/ m/ -/ 1/ )/ k/ +/ 2/ ,/ n/ ]/ (/ 14/ )/ 然后/ 采用/ 编码方式/ C1/ 进行/ 压缩/ ./ 经过/ BIL/ 算法/ 后/ 有/ i/ =/ BIL/ (/ Li/ )/ =/ (/ Loc1/ ,/ I1/ )/ ,/ …/ ,/ (/ Locj/ ,/ Ij/ )/ ,/ …/ ,/ Lblock2/ ./ 2/ 分块/ 倒/ 排列/ 表/ 的/ 编码/ 为了/ 尽可能/ 降低/ 分块/ 倒/ 排列/ 表/ Lblocki/ 的/ 每个/ 子块/ SBr/ 的/ 定位/ 部分/ Locr/ 、/ 信息/ 部分/ 耗/ ,/ LblockIr/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 分别/ 采用/ 不同/ 的/ 编码方式/ C1/ 和/ C2/ 进行/ 压缩/ ./ 当子/ 块/ SBr/ 的/ 定位/ 部分/ Locr/ 采用/ 编码方式/ C1/ 进行/ 压缩/ 时/ ,/ 所/ 需/ 比特/ 数用/ BC1/ ,/ k/ (/ Locr/ )/ 表示/ ;/ 当子/ 块/ SBr/ 信息/ 部分/ Ir/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 采用/ 编码方式/ C2/ 进行/ 压缩/ 时/ ,/ 存储/ 这/ 两种/ 信息/ 所/ 需要/ 的/ 比特/ 数/ 分别/ 用/ BC2/ ,/ k/ (/ LDr/ )/ 和/ BC2/ ,/ k/ (/ LFr/ )/ 表示/ ./ 由于/ 每个/ 子块/ SBr/ 的/ 定位/ 部分/ Locr/ 只/ 包含/ 一个/ 信息/ 序列/ 对/ ,/ 因此/ 可以/ 采用/ 压缩/ 性能/ 好/ 的/ Golomb/ 编码/ 进行/ 压缩/ (/ 当然/ 也/ 可以/ 采用/ 其它/ 性能/ 更好/ 的/ 编码/ 算法/ )/ ./ 为了/ 在/ 不/ 加入/ 任何/ 辅助/ 信息/ 的/ 前提/ 下/ ,/ 支持/ 倒/ 排列/ 表/ 的/ 随机/ 访问/ 与/ 快速/ 定位/ 以/ 提高/ 查询/ 的/ 时间/ 效率/ ,/ 关键/ 的/ 问题/ 是/ 寻找/ 一种/ 有效/ 的/ 编码方式/ ,/ 这种/ 编码方式/ 在/ 对/ 每个/ 块/ 中/ 信息/ 部分/ 的/ 文档/ ID/ 和/ 累计/ 词频/ 进行/ 压缩/ 后/ 具有/ 精确/ 的/ 寻址/ 和/ 随机/ 访问/ 能力/ ./ 这/ 意味着/ 子块/ SBr/ 的/ 信息/ 部分/ Ir/ 的/ 编码方式/ 必须/ 满足/ 以下/ 条件/ :/ (/ 1/ )/ 在/ 不/ 附加/ 任何/ 辅助/ 信息/ 的/ 前提/ 下/ ,/ 具有/ 块间/ 忽略/ 功能/ ,/ 这/ 要求/ 在/ 当前/ 已知/ 定位/ 部分/ Locr/ 与/ Locr/ +/ 1/ 的/ 信息/ 时/ ,/ 能/ 计算/ 出/ 下/ 一个/ 子块/ Ir/ +/ 1/ 的/ 地址/ ;/ (/ 2/ )/ 支持/ 块/ 内/ 定位/ 功能/ ,/ 即/ 在/ 实现/ 子块/ 定位/ 后/ ,/ 能/ 在/ 压缩/ 的/ 子块/ 上/ ,/ 实现/ 块/ 内/ 任意/ 元素/ 的/ 随机/ 访问/ 、/ 定位/ 与/ 解码/ 功能/ ./ 二进制/ 内/ 插/ 编码/ BIC/ [/ 9/ ]/ 不仅/ 可以/ 对/ 升序/ 的/ 整数/ 集/ 进行/ 有效/ 压缩/ ,/ 而且/ 在/ 已知/ 升序/ 的/ 整数/ 集/ 的/ 最小/ 整数/ 与/ 最大/ 整数/ 时/ ,/ 能/ 有效/ 地/ 计算/ 出/ 压缩/ 该/ 整数/ 集所/ 需/ 的/ 空间/ 消耗/ ./ BIC/ 编码/ 的/ 这些/ 特点/ 与/ 倒/ 排列/ 表中/ 文档/ ID/ 本身/ 就是/ 升序/ 排列/ 、/ 所/ 要/ 实现/ 的/ 精确/ 寻址/ 和/ 随机/ 访问/ 能力/ 相吻合/ ./ 因此/ ,/ 如果/ 通过/ 块间/ 忽略/ 功能/ ,/ 得到/ 当前/ 已知/ 定位/ 部分/ Locr/ 与/ Locr/ +/ 1/ 的/ 信息/ 时/ ,/ 就/ 可以/ 在/ 满足/ 上述/ 条件/ 的/ 同时/ 准确/ 地/ 计算/ 其/ 压缩/ 后/ 所/ 需要/ 的/ 比特/ 数/ ,/ 进而/ 实现/ 上述/ 两个/ 条件/ 所/ 需/ 满足/ 的/ 功能/ ./ 因此/ 本文/ 采用/ 高效/ 的/ 二进制/ 内/ 插/ 编码/ BIC/ 对/ 信息/ 部分/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 进行/ 压缩/ ./ 根据/ 二进制/ 内/ 插/ 编码/ BIC/ 的/ 原理/ ,/ 对于/ 子块/ SBr/ 信息/ 部分/ Ir/ 的/ 升/ 序列表/ LDr/ ,/ 其/ k/ -/ 1/ 个/ 整数/ 经过/ 编码/ 后/ 所/ 占用/ 比特/ 数/ 取决于/ 列表/ 中/ 整数/ 的/ 取值/ 范围/ D/ ./ 为了/ 在/ 无需/ 对/ LDr/ 解码/ 的/ 前提/ 下/ 计算/ 出/ LDr/ 所/ 占/ 的/ 空间/ ,/ 可/ 由/ 已知/ 的/ SBr/ 定位/ 部分/ Locr/ 的/ 文档/ 号/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ 与/ 下/ 一个/ 子块/ SBr/ +/ 1/ 定位/ 部分/ Locr/ +/ 1/ 的/ 文档/ 号/ dk/ ·/ r/ +/ 1/ 来/ 计算/ D/ ./ 因此/ ,/ 对于/ 子块/ SBr/ 的/ 信息/ 部分/ 列表/ LDr/ 有/ BC2/ ,/ k/ (/ LDr/ )/ =/ BBIC/ ,/ k/ (/ D/ )/ 同理/ ,/ 对于/ 子块/ SBr/ 的/ 信息/ 部分/ 列表/ LFr/ 有/ BC2/ ,/ k/ (/ LFr/ )/ =/ BBIC/ ,/ k/ (/ fk/ ·/ r/ +/ 1/ -/ fk/ (/ r/ -/ 1/ )/ +/ 1/ -/ 1/ )/ (/ 17/ )/ BBIC/ ,/ k/ (/ D/ )/ =/ 0/ ,/ 对于/ 二进制/ 内/ 插/ 编码/ BIC/ 有/ 对于/ 子块/ SBr/ 的/ 信息/ 部分/ Ir/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ ,/ 其/ 文档/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ 与/ 对应/ 词频/ fk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ 之间/ 的/ 物理/ 位置/ 满足/ 以下/ 关系/ :/ BBIC/ ,/ k/ ,/ r/ (/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ ,/ fk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ )/ =/ (/ k/ -/ j/ )/ k/ -/ 1/ ·/ BBIC/ ,/ k/ (/ dk/ ·/ r/ +/ 1/ -/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ -/ 1/ )/ +/ (/ j/ -/ 1/ )/ k/ -/ 1/ ·/ BBIC/ ,/ k/ (/ fk/ ·/ r/ +/ 1/ -/ fk/ (/ r/ -/ 1/ )/ +/ 1/ -/ 1/ )/ ,/ j/ ∈/ [/ 1/ ,/ k/ -/ 1/ ]/ 例/ 1/ ./ 某词/ wi/ 的/ 倒/ 排列/ 表/ Li/ 包含/ n/ =/ 10/ 个/ 信息/ 序列/ 对/ Li/ =/ (/ 1/ ,/ 2/ )/ ,/ (/ 2/ ,/ 3/ )/ ,/ (/ 4/ ,/ 1/ )/ ,/ (/ 5/ ,/ 2/ )/ ,/ (/ 6/ ,/ 4/ )/ ,/ (/ 8/ ,/ 2/ )/ ,/ (/ 10/ ,/ 3/ )/ ,/ (/ 12/ ,/ 1/ )/ ,/ (/ 15/ ,/ 3/ )/ ,/ (/ 17/ ,/ 2/ )/ ,/ 当/ k/ =/ 4/ 时/ ,/ 对/ Li/ 进行/ BIL/ 编码/ ./ 根据/ 算法/ 1/ ,/ 首先/ 用/ 表达式/ (/ 2/ )/ 求/ 累计/ 词频/ 并/ 进行/ 替换/ 有/ L1i/ =/ (/ 1/ ,/ 2/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ (/ 4/ ,/ 6/ )/ ,/ (/ 5/ ,/ 8/ )/ ,/ (/ 6/ ,/ 12/ )/ ,/ (/ 8/ ,/ 14/ )/ ,/ (/ 10/ ,/ 17/ )/ ,/ (/ 12/ ,/ 18/ )/ ,/ (/ 15/ ,/ 21/ )/ ,/ (/ 17/ ,/ 23/ )/ ./ 然后/ 以/ k/ =/ 4/ 个/ 序列/ 对/ 为/ 单位/ 对/ Li/ 进行/ 分块/ :/ L2i/ =/ [/ (/ 1/ ,/ 2/ )/ ,/ (/ 2/ ,/ 5/ )/ ,/ (/ 4/ ,/ 6/ )/ ,/ (/ 5/ ,/ 8/ )/ ]/ ,/ Page5/ 接着/ 对前/ m/ -/ 1/ (/ 10/ // 4/ -/ 1/ =/ 2/ )/ 个子/ 块/ 的/ 信息/ 部分/ 分别/ 按/ 文档/ ID/ 与/ 累计/ 词频/ 进行/ 升序/ 排序/ 有/ L3i/ =/ [/ (/ 1/ ,/ 2/ )/ ,/ (/ 2/ ,/ 4/ ,/ 5/ )/ ,/ (/ 5/ ,/ 6/ ,/ 8/ )/ ]/ ,/ 然后/ 对前/ m/ -/ 1/ 个子/ 块/ 的/ 信息/ 部分/ 进行/ BIC/ 编码/ ,/ 由/ Loc1/ =/ (/ 1/ ,/ 2/ )/ 与/ Loc2/ =/ (/ 6/ ,/ 12/ )/ ,/ 此时/ LD1/ 的/ 3/ 个/ 整数/ 的/ 取值/ 范围/ 一定/ 在/ [/ 2/ ,/ 5/ ]/ 之间/ ,/ 即/ 最/ 多/ 有/ 4/ 个/ 取值/ ,/ 只/ 需要/ 2/ 比特/ 对/ 每个/ 整数/ 进行/ 编码/ ./ 同理/ ,/ 对于/ LF1/ 的/ 3/ 个/ 整数/ 的/ 取值/ 范围/ 一定/ 在/ [/ 3/ ,/ 11/ ]/ 之间/ ,/ 最多/ 有/ 9/ 个/ 取值/ ,/ 只/ 需要/ 4/ 比特/ ./ 依此类推/ ,/ BIC/ 编码/ 后/ 可得/ L4i/ =/ [/ (/ 1/ ,/ 2/ )/ ,/ (/ 00/ ,/ 10/ ,/ 11/ )/ ,/ (/ 0010/ ,/ 0100/ ,/ 0110/ )/ ]/ ,/ [/ (/ 6/ ,/ 12/ )/ ,/ (/ 001/ ,/ 011/ ,/ 101/ )/ ,/ (/ 001/ ,/ 100/ ,/ 101/ )/ ]/ ,/ [/ (/ 15/ ,/ 21/ )/ ,/ (/ 17/ ,/ 23/ )/ ]/ ./ 接着/ 对/ 每个/ 子块/ 的/ 定位/ 部分/ 及/ 最后/ 一个/ 子块/ 的/ 信息/ 部分/ 进行/ d/ -/ gap/ 压缩/ 有/ L5i/ =/ [/ (/ 1/ ,/ 2/ )/ ,/ (/ 00/ ,/ 10/ ,/ 11/ )/ ,/ (/ 0010/ ,/ 0100/ ,/ 0110/ )/ ]/ ,/ [/ (/ 5/ ,/ 10/ )/ ,/ (/ 001/ ,/ 011/ ,/ 101/ )/ ,/ (/ 001/ ,/ 100/ ,/ 101/ )/ ]/ ,/ [/ (/ 9/ ,/ 9/ )/ ,/ (/ 2/ ,/ 2/ )/ ]/ ./ 最后/ 对/ 该/ 部分/ 进行/ 参数/ 为/ 3/ 的/ Golomb/ 编码/ 有/ L6i/ =/ [/ (/ 00/ ,/ 001/ )/ ,/ (/ 00/ ,/ 10/ ,/ 11/ )/ ,/ (/ 0010/ ,/ 0100/ ,/ 0110/ )/ ]/ ,/ [/ (/ 101/ ,/ 11100/ )/ ,/ (/ 001/ ,/ 011/ ,/ 101/ )/ ,/ (/ 001/ ,/ 100/ ,/ 101/ )/ ]/ ,/ [/ (/ 11011/ ,/ 11011/ )/ ,/ (/ 001/ ,/ 001/ )/ ]/ ./ 2.3/ 分块/ 倒/ 排列/ 表/ 的/ 解码/ 与/ 随机/ 访问/ 为了/ 便于/ 解码/ ,/ 需要/ 已知/ 当前/ 子块/ SBr/ 定位/ 部分/ Locr/ 与/ 下/ 一个/ 子块/ SBr/ +/ 1/ 的/ 信息/ 来/ 计算/ 编码/ 所/ 需/ 的/ 比特/ 数/ ./ 因此/ ,/ 其/ 存储/ 顺序/ 作/ 如下/ 调整/ :/ i/ =/ Loc1/ ,/ Loc2/ ,/ I1/ ,/ Loc3/ ,/ I2/ ,/ …/ ,/ Locm/ ,/ Im/ -/ 1/ ,/ ImLblock/ 用/ P/ (/ Loc1/ )/ 表示/ 分块/ 倒/ 排列/ 表/ Lblock/ 子块/ SB1/ 的/ 定位/ 部分/ Loc1/ 的/ 物理地址/ ,/ 则/ 可/ 计算/ 出/ i/ 中/ 任意子/ 块/ SBr/ 的/ 定位/ 部分/ Locr/ 与/ 信息/ 部分/ IrLblock/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 的/ 所有/ 地址/ :/ P/ (/ Locr/ )/ =/ pi/ ,/ r/ =/ 1/ ,/ 烄/ P/ (/ Loc1/ )/ +/ BC1/ ,/ k/ (/ Loc1/ )/ ,/ r/ =/ 2/ ,/ P/ (/ Loc1/ )/ +/ ∑/ r/ -/ 1/ 烅/ ∑/ r/ -/ 2/ 烆/ P/ (/ Ir/ )/ =/ P/ (/ LDr/ )/ =/ P/ (/ Loc1/ )/ +/ ∑/ 2/ 烄/ P/ (/ Loc1/ )/ +/ ∑/ r/ +/ 1/ 烅/ ∑/ r/ -/ 1/ 烆/ P/ (/ LFr/ )/ =/ P/ (/ Ir/ )/ +/ BC2/ ,/ k/ (/ LDr/ )/ ,/ r/ ∈/ [/ 1/ ,/ m/ ]/ (/ 23/ )/ 对于/ 子块/ SBr/ 的/ 列表/ LDr/ 的/ 第/ j/ 个/ 文档/ ID/ 的/ 物理地址/ Pd/ (/ LDr/ ,/ j/ )/ 有/ Pd/ (/ LDr/ ,/ j/ )/ =/ P/ (/ LDr/ )/ +/ (/ j/ -/ 1/ )/ 其中/ P/ (/ LDr/ )/ 与/ BC2/ ,/ k/ (/ LDr/ )/ 分别/ 由/ 表达式/ (/ 22/ )/ 与/ (/ 16/ )/ 计算/ ./ 同理/ ,/ 对于/ 子块/ SBr/ 的/ 列表/ LFr/ 的/ 第/ j/ 个/ 文档/ 累计/ 词频/ 的/ 物理地址/ Pf/ (/ LFr/ ,/ j/ )/ 有/ Pf/ (/ LFr/ ,/ j/ )/ =/ P/ (/ LFr/ )/ +/ (/ j/ -/ 1/ )/ 其中/ P/ (/ LFr/ )/ 与/ BC2/ ,/ k/ (/ LFr/ )/ 分别/ 由/ 表达式/ (/ 23/ )/ 与/ (/ 17/ )/ 计算/ ./ 子块/ SBr/ 信息/ 部分/ Ir/ 的/ 两个/ 列表/ LDr/ 与/ LFr/ 中/ 任意/ 的/ 文档/ dk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ 与/ 对应/ 词频/ fk/ ·/ (/ r/ -/ 1/ )/ +/ 1/ +/ j/ 的/ 地址/ ,/ 在/ 已知/ P/ (/ Ir/ )/ 与/ P/ (/ LFr/ )/ 的/ 前提/ 下/ ,/ 通过/ 表达式/ (/ 24/ )/ 与/ (/ 25/ )/ 得出/ ./ 如/ 算法/ 2/ 所示/ ./ 分块/ 倒/ 排列/ 表/ 的/ 解码/ 与/ 随机/ 访问/ 算法/ BILDRA/ 算法/ 2/ ./ 分块/ 倒/ 排列/ 表/ 解码/ 与/ 随机/ 访问/ 算法/ BILDRA/ ./ 输入/ :/ pi/ ,/ Lblock/ 输出/ :/ d/ 对应/ 的/ 词频/ fq1/ ./ 根据/ pi/ 利用/ 式/ (/ 21/ )/ 计算/ P/ (/ Loc1/ )/ ,/ 根据/ C1/ 解码/ 得/ 2/ ./ for/ (/ i/ =/ 2/ ;/ i/ / n/ // k/ ;/ i/ ++/ )/ {/ 3/ ./ if/ (/ d/ =/ =/ dk/ ·/ (/ i/ -/ 2/ )/ +/ 1/ )/ 4/ ./ returnfqk/ ·/ (/ i/ -/ 2/ )/ +/ 1.5/ ./ else6/ ./ 由式/ (/ 21/ )/ 计算/ P/ (/ Loci/ )/ 并/ 解码/ 得/ (/ di/ ,/ fi/ )/ ,/ 根/ 7/ ./ if/ (/ d/ ∈/ (/ dk/ ·/ (/ i/ -/ 1/ )/ +/ 1/ ,/ dk/ ·/ i/ +/ 1/ )/ )/ 8/ ./ returnBRA/ (/ P/ (/ Loci/ -/ 1/ )/ ,/ Ii/ -/ 1/ ,/ Loci/ -/ 1/ ,/ Loci/ ,/ d/ )/ ./ 9/ ./ elsePage610/ ./ continue11/ ./ }/ 12/ ./ return0/ ./ BILDRA/ 算法/ 首先/ 通过/ 对子/ 块/ 的/ 定位/ 部分/ 解码/ ,/ 确定/ 查询/ 文档/ d/ 所在/ 子块/ ./ 然后/ 调用/ 块/ 内/ 随机/ 访问/ 算法/ BRA/ ,/ 实现/ 子块/ 内/ 的/ 快速/ 定位/ 与/ 随机/ 访问/ ./ 块/ 内/ 随机/ 访问/ 算法/ BRA/ 如/ 算法/ 3/ 所示/ ./ 算法/ 3/ ./ 块/ 内/ 随机/ 访问/ 算法/ BRA/ ./ 输入/ :/ P/ (/ Locr/ )/ ,/ Ir/ ,/ Locr/ ,/ Locr/ +/ 1/ 文档/ 号/ d/ 输出/ :/ d/ 对应/ 的/ 词频/ fq1/ ./ 根据/ 式/ (/ 22/ )/ 计算/ P/ (/ LDr/ )/ ./ 2/ ./ if/ (/ d/ =/ =/ dk/ ·/ r/ +/ 1/ +/ 1/ )/ 3/ ./ 根据/ 式/ (/ 24/ )/ 求/ Pd/ (/ LDr/ ,/ 1/ )/ ,/ 并/ 对/ LDr/ 的/ 第一个/ 文/ 4/ ./ if/ (/ d/ =/ =/ dtemp/ )/ 5/ ./ 根据/ 式/ (/ 25/ )/ 和/ 式/ (/ 2/ )/ 求/ Pf/ (/ LDr/ ,/ 1/ )/ 解码/ 计算/ fq6/ ./ returnfq/ ./ 7/ ./ elseif/ (/ d/ =/ =/ dk/ ·/ (/ r/ +/ 1/ )/ +/ 1/ -/ 1/ )/ 8/ ./ 根据/ 式/ (/ 24/ )/ 求/ Pd/ (/ LDr/ ,/ k/ -/ 1/ )/ ,/ 并/ 对/ LDr/ 的/ 第/ k/ -/ 19/ ./ if/ (/ d/ =/ =/ dtemp/ )/ 10/ ./ 根据/ 式/ (/ 25/ )/ 和/ (/ 2/ )/ 求/ Pf/ (/ LDr/ ,/ k/ -/ 1/ )/ 解码/ 计算/ fq/ ./ 11/ ./ returnfq/ ./ 12/ ./ else13/ ./ 采用/ 折半/ 查找/ 算法/ 14/ ./ if/ (/ / dj/ =/ =/ d/ )/ 15/ ./ 根据/ 式/ (/ 25/ )/ 计算/ Pf/ (/ LFi/ -/ 1/ ,/ j/ )/ 与/ Pf/ (/ LFi/ -/ 1/ ,/ 16/ ./ returnfq/ ./ 17/ ./ else18/ ./ return0/ ./ 19/ ./ return0/ ./ 块/ 内/ 随机/ 访问/ 算法/ BRA/ ,/ 首先/ 判断/ 查询/ 文档/ d/ 与/ 当前/ 子块/ 定位/ 部分/ 文档/ ID/ 号/ dk/ ·/ r/ +/ 1/ 及下/ 一个/ 子块/ 定位/ 部分/ 文档/ ID/ 号/ dk/ ·/ (/ r/ +/ 1/ )/ +/ 1/ 之间/ 的/ 关系/ ,/ 对于/ d/ =/ =/ dk/ ·/ r/ +/ 1/ +/ 1/ 与/ d/ =/ =/ dk/ ·/ (/ r/ +/ 1/ )/ +/ 1/ -/ 1/ 两种/ 特殊/ 的/ 情况/ ,/ 可以/ 直接/ 解码/ 得到/ 词频/ ,/ 其它/ 情况/ 采用/ 折半/ 查找/ 算法/ 进行/ 定位/ ,/ 提高/ 解码/ 与/ 查询/ 效率/ ./ 包含/ 词/ wi/ ,/ 并/ 返回/ 词频/ ./ 例/ 2/ ./ 对例/ 1/ 中/ 的/ 数据/ 实现/ 查询/ :/ 文档/ 8/ 是否/ 由/ 表达式/ (/ 20/ )/ 可知/ Li/ 经过/ 编码/ 后/ 的/ 实际/ 存储/ 结构/ L7i/ 为/ L7i/ =/ (/ 00/ ,/ 001/ )/ ,/ (/ 101/ ,/ 11100/ )/ ,/ 根据/ 词表/ 指向/ 倒/ 排列/ 表/ 的/ 指针/ pi/ ,/ 得/ P/ (/ Loc1/ )/ =/ pi/ ./ 根据/ 编码方式/ 可得/ BC1/ ,/ 4/ (/ Loc1/ )/ ./ 由/ BILDRA/ 算法/ 的/ 步/ 1/ 与步/ 6/ 可得/ (/ d1/ ,/ f1/ )/ =/ (/ 1/ ,/ 2/ )/ 与/ (/ d2/ ,/ f2/ )/ =/ (/ 5/ ,/ 10/ )/ 以及/ (/ d1/ ,/ f1/ )/ =/ (/ 1/ ,/ 2/ )/ 与/ (/ d4/ +/ 1/ ,/ f4/ +/ 1/ )/ =/ (/ d1/ +/ d2/ ,/ f1/ +/ f2/ )/ =/ (/ 6/ ,/ 12/ )/ ./ 由于/ 8/ >/ d4/ +/ 1/ ,/ 因此/ 必须/ 找到/ 下/ 一个/ 子块/ 的/ 定位/ 部分/ Loc3/ ./ 根据/ BILDRA/ 算法/ ,/ 计算/ 出/ :/ P/ (/ Loc3/ )/ =/ P/ (/ Loc1/ )/ +/ BC1/ ,/ 4/ (/ Loc1/ )/ +/ BC1/ ,/ 4/ (/ Loc2/ )/ +/ 对/ Loc3/ 进行/ 解码/ 得/ (/ d3/ ,/ f3/ )/ =/ (/ 9/ ,/ 9/ )/ 以及/ (/ d8/ +/ 1/ ,/ f8/ +/ 1/ )/ =/ (/ d3/ +/ d4/ +/ 1/ ,/ f3/ +/ f4/ +/ 1/ )/ =/ (/ 15/ ,/ 21/ )/ ./ 此时/ 有/ 8/ ∈/ (/ d4/ +/ 1/ ,/ d8/ +/ 1/ )/ ,/ 因此/ 对/ 第/ 2/ 个子/ 块/ 的/ 信息/ 部分/ 进行/ 块/ 内/ 随机/ 访问/ 算法/ BRA/ ./ 根据/ BRA/ ,/ 采用/ 折半/ 查找/ 算法/ ,/ 此时/ 对/ LD2/ 的/ 第/ i/ (/ i/ =/ (/ k/ -/ 1/ )/ // 2/ =/ 1/ )/ 个/ 文档/ ID/ 进行/ 解码/ ./ 可知/ LD2/ 的/ 第/ 1/ 个/ 文档/ ID/ 与/ 8/ 相同/ ./ 因此/ 根据/ 式/ (/ 25/ )/ 计算/ 词频/ 的/ 地址/ ,/ 并/ 得/ 累加/ 词频/ 值/ 14/ ,/ 该值/ 减去/ f4/ +/ 1/ ,/ 即得/ 频率/ 为/ 2.3/ 性能/ 分析/ 3.1/ 空间/ 性能/ 分析/ 表/ Lblock/ 间/ BLblock/ 中/ N/ 为/ Lblock/ 证明/ ./ 包含/ n/ 个/ 信息/ 序列/ 对/ 的/ 分块/ 倒/ 排列/ 表/ i/ ,/ 有/ 2n/ 个/ 整数/ ,/ 其/ 取值/ 范围/ 为/ [/ 1/ ,/ N/ ]/ ./ 用/ LblockB/ [/ N/ ,/ 2n/ ]/ 表示/ 压缩/ 2n/ 个/ 文档/ ID/ 与/ 词频/ 所/ 需要/ 的/ 比特/ 数/ ,/ 对于/ Golomb/ 编码/ 有/ [/ 9/ ]/ B/ [/ N/ ,/ 2n/ ]/ / 2n/ ·/ (/ 2/ +/ log2N/ // (/ 2n/ (/ )/ )/ )/ (/ 26/ )/ 当用/ Golomb/ 编码/ 对/ Lblock/ 位/ 部分/ Locr/ 以及/ 最后/ 一个/ 子块/ 的/ 信息/ 部分/ 进行/ 编码/ 时/ ,/ 所/ 需要/ 的/ 空间/ 为/ 定理/ 1/ ./ 包含/ n/ 个/ 信息/ 序列/ 对/ 的/ 分块/ 倒/ 排列/ i/ ,/ 在/ 最坏/ 情况/ 下/ ,/ 采用/ BIL/ 进行/ 编码/ 所占空/ i/ 为/ 2n2/ +/ log2kLoc/ =/ [/ 2n/ -/ 2/ (/ m/ -/ 1/ )/ (/ k/ -/ 1/ )/ ]/ ·/ BGolomb/ 其中/ m/ 为子/ 块/ 数量/ ,/ 由/ 表达式/ (/ 4/ )/ 计算/ ./ 码/ ,/ 其所/ 需/ 空间/ 为/ 对于/ 前/ m/ -/ 1/ 个子/ 块/ 的/ 信息/ 部分/ ,/ 采用/ BIC/ 编/ Page7I/ =/ ∑/ m/ -/ 1BBIC/ / (/ k/ -/ 1/ )/ ∑/ m/ -/ 1/ / 2/ (/ k/ -/ 1/ )/ (/ m/ -/ 1/ )/ 1/ +/ log2N/ 分块/ 倒/ 排列/ 表/ Lblock/ 考虑/ 最坏/ 情况/ 下/ ,/ 即取/ m/ =/ n/ // k/ =/ n/ 对式/ (/ 29/ )/ 进行/ 简化/ 有/ i/ =/ 2n2/ +/ log2kBLblock/ 定理/ 1/ 得证/ ./ 从/ 表达式/ (/ 30/ )/ 可以/ 看出/ ,/ BLblock/ 随着/ k/ 的/ 增加/ 而/ 减小/ ,/ 但/ k/ 的/ 取值/ 必须/ 满足/ 范围/ 约束条件/ k/ ∈/ [/ 2/ ,/ n/ -/ 1/ ]/ ./ 推论/ 1/ ./ 在/ 最坏/ 情况/ 下/ ,/ 提出/ 的/ RABIF/ 自/ 索引/ 比/ SIF/ 自/ 索引/ [/ 3/ ,/ 19/ ]/ 的/ 空间/ 消耗/ 小/ BGolombskipping/ _/ information/ 表示/ SIF/ 自/ 索引/ 中/ 插入/ 的/ m/ 个/ 其中/ BGolomb/ 忽略/ 信息/ 采用/ Golomb/ 编码/ 所/ 需/ 的/ 空间/ ./ 证明/ ./ 对于/ SIF/ 自/ 索引/ ,/ 根据/ 其/ 结构/ 所/ 需/ 存储空间/ BGolombSIF/ 为/ BGolomb/ 其中/ BGolombpointerdr/ +/ 1/ )/ 采用/ Golomb/ 编码/ 所/ 需/ 的/ 空间/ ,/ pointerdr/ +/ 1/ 为/ 指向/ 下/ 一个/ 子块/ 忽略/ 信息/ 对/ 的/ 地址/ 指针/ ;/ BGolombI/ 表示/ 前/ m/ -/ 1/ 个子/ 块/ 的/ 信息/ 部分/ ,/ 采用/ Golomb/ 编码/ 所/ 需/ 的/ 空间/ :/ BGolombI/ / 2/ (/ m/ -/ 1/ )/ (/ k/ -/ 1/ )/ 2/ +/ logNBGolomb/ =/ 2/ (/ m/ -/ 1/ )/ (/ k/ -/ 1/ )/ 1/ +/ logN/ 由/ 表达式/ (/ 28/ )/ 与/ 式/ (/ 33/ )/ 有/ BGolomb/ 因此/ 在/ 最坏/ 情况/ 下/ ,/ 提出/ 的/ RABIF/ 自/ 索引/ 比/ SIF/ 自/ 索引/ 的/ 空间/ 消耗/ 小/ :/ 推论/ 1/ 得证/ ./ 3.2/ 时间/ 性能/ 分析/ 根据/ 文献/ [/ 3/ ,/ 9/ ]/ 的/ 研究/ 表明/ ,/ BIC/ 的/ 解码/ 时间/ 性能/ 与/ Golomb/ 相当/ ,/ 而且/ 在/ 某些/ 情况/ 下/ 略/ 优于/ Golomb/ ./ 以下/ 分析/ 中/ 假设/ BIC/ 与/ Golomb/ 的/ 解码/ 时间/ 性能/ 相同/ ,/ 即/ 两种/ 方法/ 解码/ 一个/ (/ dj/ ,/ fj/ )/ 所/ 需/ 的/ 时间/ 均/ 为/ td/ ./ 定理/ 2/ ./ 对/ 包含/ n/ 个/ 信息/ 序列/ 对/ 的/ 分块/ 倒/ 排列/ i/ ,/ 查找/ 项为/ q/ 个/ 时/ ,/ 其/ 最小/ 查询/ 时间/ Tmin/ 为表/ Lblock4/ +/ n/ 槡/ (/ td1/ +/ q/ 所/ 需/ 的/ 时间/ ,/ tr/ 为/ 读取/ 一个/ (/ dj/ ,/ fj/ )/ 所/ 需/ 的/ 时间/ ./ 证明/ ./ 考虑/ 最坏/ 情况/ 下/ ,/ 需要/ 将/ 整个/ 倒/ 排列/ 表/ i/ 读入/ ,/ 即/ 需要/ 将/ n/ 个/ 信息/ 序列/ 对/ 都/ 读入/ 内存/ ,/ 则/ Lblock/ 时间/ 为/ trn/ ./ 在/ 最坏/ 情况/ 下/ ,/ Lblock/ 定位/ 部分/ Locr/ (/ r/ ∈/ [/ 1/ ,/ m/ ]/ )/ 都/ 需要/ 解码/ ,/ 则/ 所/ 需/ 时间/ 为/ tdm/ ;/ 每个/ 子块/ 的/ 列表/ LDr/ 最坏/ 情况/ 下/ 折半/ 查询/ 需要/ 解码/ 一半/ ,/ 而/ LDr/ 中/ 的/ 每/ 一个/ 文档/ ID/ 解码/ 时间/ 为/ td/ // 2/ ,/ 则/ 所/ 需/ 时间/ 为/ q/ ·/ k/ -/ 1/ 的/ 文档/ ID/ 地址/ 后/ ,/ LFr/ 部分/ 可/ 直接/ 解码/ 得到/ 词频/ ,/ 则/ 所/ 需/ 时间/ 为/ q/ ·/ td2/ ./ 因此/ 有/ 解码/ 时间/ Td/ 为/ Td/ =/ tdm/ +/ q/ ·/ k/ -/ 1/ 而/ 总/ 时间/ T/ 是/ 读取/ 时间/ 与/ 解码/ 时间/ Td/ 之/ 和/ ,/ 因此/ 有/ 由于/ m/ 满足/ 表达式/ (/ 4/ )/ ,/ 代入/ 有/ 对于/ 提出/ 的/ RABIF/ 自/ 索引/ ,/ 显然/ 当/ k/ 为/ 具有/ 最小/ 的/ 解码/ 时间/ Td/ ,/ min/ 与/ 总/ 时间/ Tmin/ 值/ :/ 定理/ 2/ 得证/ ./ 推论/ 2/ ./ 在/ 最坏/ 情况/ 下/ ,/ 提出/ 的/ RABIF/ 自/ 索引/ 比/ SIF/ 自/ 索引/ 的/ 查询/ 时间/ 消耗/ 小/ k/ -/ 1/ 证明/ ./ 对于/ SIF/ 自/ 索引/ ,/ 在/ 最坏/ 情况/ 下/ ,/ 倒/ 排列/ 表中/ 所有/ m/ 个子/ 块/ 的/ 辅助/ 信息/ (/ 该/ 信息/ 是/ 一个/ 信息/ 序列/ 对/ )/ 都/ 需要/ 解码/ ,/ 则/ 所/ 需/ 时间/ 为/ tdm/ ;/ 另外/ ,/ Page8SIF/ 中/ 并/ 不/ 具备/ 块/ 内/ 的/ 随机/ 访问/ 能力/ ,/ 因此/ 最坏/ 情况/ 下/ ,/ SIF/ 需要/ 将/ 块/ 内/ 的/ 所有/ k/ 个/ 信息/ 序列/ 对/ 进行/ 解码/ ,/ 这里/ 我们/ 取其/ 平均/ 解码/ 时间/ ,/ 也/ 就是/ 只/ 需要/ 对/ k/ // 2/ 个/ 信息/ 序列/ 对/ 进行/ 解码/ 所/ 需/ 的/ 时间/ td/ ·/ k/ // 2/ ,/ 因此/ 查询/ 项为/ q/ 个/ 时/ ,/ 可/ 得/ 解码/ 时间/ Td/ ,/ SIF/ 的/ 表达式/ 为/ 由于/ SIF/ 自/ 索引/ 中/ 插入/ 了/ m/ 个子/ 块/ 的/ 辅助/ 信息/ ,/ 因此/ 在/ 最坏/ 情况/ 下/ ,/ 需要/ 将/ 整个/ 倒/ 排列/ 表/ 读入/ ,/ 因此/ 其/ 读取/ 时间/ 为/ tr/ (/ n/ +/ m/ )/ ./ 则/ 总/ 时间/ TSIF/ 为/ 从/ 编码方式/ 的/ 角度/ 而言/ ,/ RABIF/ 定位/ 部分/ 以及/ 最后/ 一个/ 子块/ 的/ 编码方式/ 与/ SIF/ 相同/ ;/ 而/ 不同之处/ 在于/ RABIF/ 中/ 没有/ 插入/ 辅助/ 信息/ ,/ RABIF/ 中前/ m/ -/ 1/ 个子/ 块/ 的/ 信息/ 部分/ 的/ 编码方式/ 采用/ 的/ 是/ BIC/ 编码/ ./ 当/ 假设/ BIC/ 与/ Golomb/ 的/ 解码/ 时间/ 性能/ 相同/ ,/ 即/ 两种/ 方法/ 解码/ 一个/ (/ dj/ ,/ fj/ )/ 所/ 需/ 的/ 时间/ 均/ 为/ td/ 时/ ,/ 可/ 得/ 提出/ 的/ RABIF/ 自/ 索引/ ,/ 在/ 最差/ 情况/ 下比/ SIF/ 自/ 索引/ 的/ 查询/ 时间/ 消耗/ 小/ :/ 推论/ 2/ 得证/ ./ 定理/ 3/ ./ 在/ 最坏/ 情况/ 下/ ,/ 对/ 包含/ n/ 个/ 信息/ 序列/ 对/ 的/ 分块/ 倒/ 排列/ 表/ Lblock/ 使/ 空间/ 与/ 查询/ 时间/ 性能/ 最优/ 的/ k/ 的/ 取值/ 范围/ 为/ [/ min/ (/ 2n/ // 槡/ q/ ,/ n/ -/ 1/ )/ ,/ max/ (/ 2n/ // 槡/ q/ ,/ n/ -/ 1/ )/ ]/ ./ 证明/ ./ 根据/ 定理/ 1/ 可知/ ,/ 在/ 最坏/ 情况/ 下/ ,/ 采用/ BIL/ 进行/ 编码/ 所/ 占/ 空间/ BLblock/ 的/ 增加/ 而/ 减小/ ,/ 但/ k/ 的/ 取值/ 必须/ 满足/ 范围/ 约束条件/ k/ ∈/ [/ 2/ ,/ n/ -/ 1/ ]/ ./ 因此/ k/ 为/ n/ -/ 1/ 时/ ,/ 空间/ 性能/ 最优/ ./ 根据/ 定理/ 2/ ,/ 对于/ 提出/ 的/ RABIF/ 自/ 索引/ ,/ 显然/ 当/ k/ 为/ 2n/ // 槡/ q/ 时/ 具有/ 最小/ 的/ 解码/ 时间/ 与/ 查询/ 时间/ 值/ ./ 因此/ 有/ 同时/ 优化/ 空间/ 与/ 查询/ 时间/ 性能/ 的/ k/ 取值/ 范围/ 为/ k/ ∈/ [/ min/ (/ 2n/ // 槡/ q/ ,/ n/ -/ 1/ )/ ,/ max/ (/ 2n/ // 槡/ q/ ,/ n/ -/ 1/ )/ ]/ (/ 44/ )/ 4/ 实验/ 结果/ 为了/ 验证/ 提出/ 的/ RABIF/ 自/ 索引/ 的/ 性能/ ,/ 对/ 其/ 所/ 占/ 空间/ 大小/ 与/ 查询/ 时间/ 效率/ 进行/ 测试/ ,/ 并/ 与/ SIF/ 自/ 索引/ 进行/ 了/ 对比/ ./ 实验/ 数据/ 均/ 在/ 以下/ 硬件/ 实验/ 平台/ 下/ 测试/ 获得/ :/ CPU3/ ./ 0GHz/ 、/ 硬盘/ 240GB/ 、/ 内存/ 1GB/ 、/ 操作系统/ WindowsXP/ ./ 实验/ 数据/ 来自/ 武汉市/ 专利局/ ,/ 数据/ 大小/ 为/ 193.2/ GB/ ,/ 该表中/ 含有/ 42/ 个/ 属性/ ,/ 其中/ 40/ 个/ 属性/ 是/ 文本/ 类型/ ,/ 对/ 这/ 40/ 个/ 文本属性/ 均/ 建立/ 了/ 全文索引/ ./ 提出/ 的/ RABIF/ 自/ 索引/ 与/ SIF/ 自/ 索引/ 均/ 在/ 开源/ Clucene/ ①/ 搜索引擎/ 上/ 实现/ ,/ 系统/ 实现/ 中将/ Clucene/ 搜索引擎/ 的/ 索引/ 结构/ 以及/ 编解码/ 方法/ 分别/ 替换/ 为/ RABIF/ 与/ SIF/ ,/ 其它/ 部分/ 功能/ (/ 如/ 分词/ 、/ 建/ 词表/ 等/ )/ ,/ 直接/ 采用/ 了/ Clucene/ 系统/ 中/ 的/ 方法/ ./ 对于/ Clucene/ 搜索引擎/ ,/ 其/ 压缩/ 后/ 的/ 倒/ 排列/ 表/ 文件/ 所/ 占/ 空间/ 大小/ 为/ 22.5/ GB/ ./ 4.1/ 空间/ 性能/ 图/ 2/ 所示/ 为/ Clucene/ 系统/ 不/ 考虑/ 分块/ 机制/ 时/ 索引/ 大小/ 以及/ 经过/ 两种/ 自/ 索引/ 压缩/ 后/ 索引/ 大小/ 的/ 实验/ 结果/ ./ 如图/ 2/ 所示/ ,/ 由于/ 没有/ 考虑/ 分块/ 机制/ ,/ Clucene/ 系统/ 所/ 产生/ 的/ 索引/ 大小/ 为/ 22.5/ GB/ ,/ 与/ k/ 值/ 无关/ ./ 提出/ 的/ RABIF/ 自/ 索引/ 所/ 占/ 的/ 空间/ 比例/ 明显/ 小于/ SIF/ ,/ 两种/ 自/ 索引/ 所/ 占/ 空间/ 比例/ 平均/ 相差/ 1.16/ GB/ ./ 随着/ 子块/ 中/ 信息/ 序列/ 对/ 数量/ k/ 的/ 增加/ ,/ 两种/ 索引/ 所/ 占/ 的/ 空间/ 都/ 将/ 逐渐/ 减小/ ./ RABIF/ 索引/ 所/ 占/ 空间/ 从/ 25.7/ GB/ 降低/ 到/ 21.71/ GB/ ,/ 原因/ 是/ 当/ k/ 增加/ 时/ ,/ 每个/ 子块/ 内/ 相邻/ 两个/ 数/ 的/ 平均/ 间隔/ 将/ 越来越/ 小/ ,/ 采用/ BIC/ 编码/ 时/ 所/ 需/ 的/ 比特/ 数/ 也/ 越少/ ,/ 因此/ 存储空间/ 消耗/ 逐渐/ 降低/ ./ 对/ SIF/ 其值/ 从/ 28.035/ GB/ 降低/ 为/ 22.52/ GB/ ,/ 原因/ 在于/ 当/ k/ 增加/ 时/ SIF/ 索引/ 需要/ 插入/ 的/ 冗余/ 信息/ 比例/ 将/ 减少/ ,/ 因此/ 所/ 占/ 空间/ 比例/ 逐渐/ 降低/ ./ 随着/ k/ 值/ 的/ 增加/ ,/ 两种/ 索引/ 的/ 空间/ 比例/ 差/ 越来越/ 小/ ./ 上述/ 实验/ 结果/ 与/ 表达式/ (/ 30/ )/ 与/ (/ 34/ )/ 的/ 理论/ 分析/ 基本一致/ ,/ 即/ RABIF/ 索引/ 所/ 占/ 空间/ 与/ k/ 成反比/ ;/ 随/ k/ 值/ 的/ 增加/ SIF/ 索引/ 插入/ 的/ 冗余/ 信息/ 比例/ 将/ 减少/ ,/ 两种/ 索引/ 空间/ 大小/ 的/ 差值/ 减小/ ./ 另外/ ,/ SIF/ 索引/ 所/ 占/ 空间/ 大小/ 始终/ 大于/ Clucene/ 压缩/ 后/ 倒/ 排列/ 表/ 文件大小/ ,/ 当/ k/ 为/ 257/ 时/ ,/ 此时/ SIF/ 的/ 索引/ 大小/ 与/ Clucene/ ①/ CLuceneSearchEngineWiki/ ./ RetrievedOctober21/ ,/ 2007/ ,/ Page9/ 系统/ 相当/ ./ 而/ 当/ k/ 为/ 33/ 与/ 65/ 时/ ,/ RABIF/ 索引/ 所/ 占/ 空间/ 分别/ 为/ 22.79/ GB/ 与/ 22.25/ GB/ ,/ 其/ 大小/ 为/ Clu/ -/ cene/ 系统/ 所/ 形成/ 索引/ 大小/ 的/ 101.3/ %/ 与/ 98.9/ %/ ./ 这/ 表明/ ,/ 当/ k/ 达到/ 65/ 时/ ,/ 索引/ 所/ 占/ 空间/ 将/ 小于/ Clucene/ 压缩/ 后/ 倒/ 排列/ 表/ 文件大小/ ,/ 而且/ 随着/ k/ 的/ 增加/ 进一步/ 降低/ ,/ 当/ k/ 增加/ 到/ 1025/ 时候/ ,/ RABIF/ 索引/ 所/ 占/ 空间/ 为/ 21.71/ GB/ ./ 这/ 也/ 表明/ RABIF/ 具有/ 降低/ 索引/ 空间/ 消耗/ 的/ 优势/ ./ 4.2/ 查询/ 时间/ 性能/ 图/ 3/ 所示/ 为子/ 块/ 中/ 信息/ 序列/ 对/ 数量/ k/ 分别/ 取/ 5/ 、/ 129/ 与/ 1025/ 时/ ,/ RABIF/ 与/ SIF/ 两种/ 自/ 索引/ 以及/ Clucene/ 系统/ 随/ 连接/ 布尔/ 查询/ 词/ 增加/ 时/ 的/ 性能/ ./ 从图/ 3/ 可以/ 看出/ ,/ RABIF/ 与/ SIF/ 两种/ 索引/ 的/ 布尔/ 查询/ 性能/ 明显/ 优于/ Clucene/ 系统/ 的/ 性能/ ./ 其/ 主要/ 原因/ 在于/ RABIF/ 与/ SIF/ 两种/ 索引/ 采用/ 了/ 快速/ 的/ 定位/ 功能/ ,/ 能/ 明显/ 地/ 提高/ 查询/ 的/ 性能/ ./ 同时/ ,/ 对于/ RABIF/ 与/ SIF/ ,/ k/ 值越/ 小/ ,/ RABIF/ 与/ SIF/ 两种/ 索引/ 的/ 布尔/ 查询/ 性能/ 越好/ ./ 对于/ 相同/ 的/ k/ 值/ ,/ RABIF/ 索引/ 时间/ 性能/ 明显/ 优于/ SIF/ ,/ 布尔/ 查询/ 时间/ 平均/ 减少/ 了/ 17.8/ %/ ./ 当/ k/ 分别/ 取/ 5/ 、/ 129/ 与/ 1025/ ,/ 与/ SIF/ 相比/ ,/ RABIF/ 的/ 查询/ 时间/ 平均/ 小/ 0.152/ s/ 、/ 0.164/ s/ 与/ 0.168/ s/ ,/ 时间/ 差值/ 基本/ 保持/ 在/ 0.16/ s/ ./ 这/ 与/ 表达式/ (/ 43/ )/ 的/ 理论/ 分析/ 结果/ 基本一致/ ,/ 即/ 两种/ 索引/ 查询/ 时间/ 的/ 差值/ 与/ 查询/ 项/ q/ 及子/ 块/ 数量/ m/ 有关/ ,/ 而/ td/ 的/ 取值/ 一般/ 为/ 毫秒/ 级/ ,/ 因此/ ,/ 两种/ 索引/ 查询/ 时间/ 的/ 差值/ 约等于/ mtr/ ./ 另外/ 当/ k/ 分别/ 取/ 5/ 、/ 129/ 与/ 1025/ 时/ ,/ 根据/ 定理/ 3/ 的/ 理论/ 分析/ ,/ 此时/ 由于/ n/ 为/ 48671/ ,/ 通过/ 分析/ 计算/ 此时/ 可得/ q/ 分别/ 为/ 3893.7/ 、/ 5.9/ 与/ 0.1/ ./ 图/ 3/ 中/ 所示/ ,/ 由于/ 图中/ q/ 的/ 取值/ 范围/ 为/ [/ 2/ ,/ 18/ ]/ ,/ 因此/ RABIF/ 查询/ 性能/ 的/ 最小值/ 分别/ 出现/ 在/ q/ 为/ 18/ 、/ 6/ 与/ 2/ 时/ ,/ 这/ 与/ 理论/ 分析/ 一致/ ./ 当/ k/ 为/ 5/ 时/ ,/ 查询/ 词/ 的/ 数量/ 对/ SIF/ 索引/ 性能/ 影响/ 并/ 不/ 明显/ ./ 而/ 当/ k/ 值为/ 129/ 与/ 1025/ 时/ ,/ 多词/ 查询/ 时间/ 将/ 随/ 查询/ 词/ 数量/ 的/ 增加/ 而/ 呈/ 线性/ 增长/ ./ 因此/ ,/ 对于/ 布尔/ 查询/ ,/ SIF/ 索引/ 中/ k/ 的/ 取值/ 应/ 小于/ 129/ ./ 对于/ RABIF/ 索引/ ,/ 从图/ 3/ 中/ 可以/ 看出/ ,/ 只有/ 当/ k/ 取/ 1025/ 时/ ,/ 查询/ 时间/ 的/ 大小/ 才/ 随/ 查询/ 词/ 数量/ 的/ 增加/ 而/ 增长/ 明显/ ./ 因此/ k/ 的/ 取值/ 范围/ 更广/ ,/ 其值/ 在/ 5/ ~/ 1025/ 之间/ 时/ 都/ 具有/ 良好/ 的/ 布尔/ 查询/ 性能/ ./ 图/ 4/ 所示/ 为子/ 块/ 中/ 信息/ 序列/ 对/ 数量/ k/ 增加/ 时/ ,/ 两种/ 自/ 索引/ 0.2/ %/ 排序/ 查询/ 的/ 性能/ ./ 由于/ Clucene/ 系统/ 中/ 并/ 没有/ 采用/ 分块/ 的/ 方法/ ,/ 其/ 0.2/ %/ 排序/ 查询/ 时间/ 性能/ 与/ k/ 无关/ ,/ 时间/ 大小/ 为/ 1.73/ s/ ./ 如图/ 4/ 所示/ ,/ RABIF/ 的/ 时间/ 性能/ 优于/ SIF/ ,/ 尤其/ 是/ 当/ k/ >/ 33/ 时/ ,/ 性能/ 差/ 更/ 明显/ ,/ 两者/ 时间差/ 从/ 0.28/ s/ 增加/ 到/ 1.32/ s/ ;/ 与/ SIF/ 相比/ ,/ 查询/ 时间/ 平均/ 减少/ 了/ 34.4/ %/ ./ 对于/ SIF/ 索引/ ,/ 当/ k/ 的/ 取值/ 为/ 5/ ~/ 17/ 时/ ,/ 查询/ 时间/ 并/ 没有/ 明显/ 的/ 变化/ ,/ 均/ 小于/ 1.3/ s/ ./ 但/ 随着/ k/ 值/ 的/ 增加/ ,/ 查询/ 时间/ 从/ 1.5/ s/ 迅速/ 增加/ 到/ 2.8/ s/ ./ 因此/ ,/ 对于/ 排序/ 查询/ ,/ SIF/ 的/ 性能/ 受/ k/ 值/ 的/ 影响/ 显著/ ,/ 且/ k/ </ 33/ 时/ 性能/ 较/ 好/ ,/ 此时/ 其/ 时间/ 性能/ 为/ 1.5/ s/ ,/ 而/ 当/ k/ 值/ 增加/ 到/ 65/ 时/ ,/ 查询/ 时间/ 将/ 增加/ 到/ 1.81/ s/ ,/ 比/ Clucene/ 系统/ 的/ 性能/ 更差/ ./ 其/ 原因/ 在于/ k/ 值越/ 大/ ,/ 每个/ 子块/ 的/ 信息/ 对/ 越/ 多/ ,/ 在/ 排序/ 查询/ 时/ 解码/ 所/ 需/ 的/ 时间/ 越长/ ./ 而/ RABIF/ 的/ 时间/ 性能/ 基本/ 在/ 1.4/ s/ 以下/ ,/ 原因/ 是/ RABIF/ 索引/ 中/ 每个/ 子块/ 的/ 解码/ 与/ k/ 的/ 取值/ 相关性/ 不/ 大/ ,/ 只要/ 已知/ 该词/ 的/ 分块/ 倒/ 排列/ 表/ 的/ 指针/ pi/ ,/ 就/ 可以/ 实现/ 随机/ 访问/ 与/ 解码/ 等/ 功能/ ./ 这/ 也/ 表明/ RABIF/ 排序/ 查询/ 时/ ,/ k/ 取值/ 范围/ 更大/ ./ k51733651292575131025Page10/ 表/ 1/ 所示/ 为/ 1/ %/ 排序/ 查询/ 时/ ,/ 两种/ 索引/ 在/ k/ 取/ 不同/ 值时/ 的/ 查询/ 性能/ ./ 对于/ 1/ %/ 排序/ 查询/ ,/ 此时/ Clucene/ 系统/ 查询/ 时间/ 大小/ 为/ 3.91/ s/ ,/ 与/ k/ 值/ 无关/ ./ 从表/ 1/ 中/ 的/ 实验/ 数据/ 可以/ 得出/ 与/ 图/ 4/ 基本一致/ 的/ 结论/ :/ 提出/ 的/ RABIF/ 索引/ 具有/ 明显/ 的/ 时间/ 性能/ 优势/ ,/ 与/ SIF/ 相比/ ,/ 查询/ 时间/ 平均/ 减少/ 了/ 27.5/ %/ ,/ 与/ Clucene/ 系统/ 相比/ 总是/ 低于/ 其/ 查询/ 时间/ ;/ RABIF/ 索引/ 排序/ 查询/ 时/ k/ 取值/ 范围/ 为/ [/ 5/ ,/ 1025/ ]/ ,/ 而/ 对于/ SIF/ ,/ 当/ k/ >/ 65/ 时/ ,/ 其/ 性能/ 将/ 比/ Clucene/ 系统/ 差/ ./ 4.3/ 讨论/ 通过/ 上述/ 实验/ ,/ 可以/ 得到/ 如表/ 2/ 所示/ 优化/ 性能/ 的/ k/ 值/ 范围/ ./ 对于/ 空间/ 性能/ ,/ k/ 值越/ 大/ 两种/ 索引/ 所/ 占/ 的/ 空间/ 越小/ ./ 当/ k/ >/ 33/ 时/ ,/ 提出/ 的/ RABIF/ 索引/ 所/ 占/ 空间/ 小于/ Clucene/ 压缩/ 后/ 倒/ 排列/ 表/ 文件大小/ ;/ 对于/ SIF/ ,/ 当/ k/ >/ 129/ 其/ 空间/ 大小/ 为/ 101.7/ %/ 与/ Clucene/ 压缩/ 后/ 倒/ 排列/ 表/ 文件大小/ 相当/ ./ 对于/ 连接/ 布尔/ 查询/ ,/ SIF/ 索引/ 中/ k/ 的/ 取值/ 小于/ 129/ 时/ ,/ 多词/ 连接/ 布尔/ 查询/ 性能/ 较/ 好/ ;/ 而/ k/ 值/ 在/ 5/ ~/ 1025/ 之间/ 时/ RABIF/ 都/ 具有/ 良好/ 的/ 布尔/ 查询/ 性能/ ./ 对于/ 排序/ 查询/ ,/ SIF/ 索引/ k/ 的/ 取值/ 应/ 小于/ 33/ ,/ 而/ k/ 值/ 对/ RABIF/ 的/ 排序/ 查询/ 时间/ 性能/ 并/ 不/ 明显/ ./ 因此/ ,/ SIF/ 算法/ 难以/ 同时/ 实现/ 空间/ 与/ 时间/ 性能/ 的/ 优化/ ,/ 而/ 当/ k/ ∈/ (/ 33/ ,/ 1025/ )/ 时/ 提出/ 的/ RABIF/ 算法/ 性能/ 得以/ 优化/ ./ 空间/ 性能/ 布尔/ 查询/ 时间/ 性能/ 排序/ 查询/ 时间/ 性能/ k/ 取值/ 范围/ 5/ 结束语/ 针对/ 倒排/ 文件/ 空间/ 开销/ 大/ 、/ 查询/ 效率/ 低/ 以及/ 难以/ 同时/ 支持/ 连接/ 布尔/ 查询/ 和/ 排序/ 查询/ 的/ 问题/ ,/ 提出/ 了/ 一种/ 同时/ 提高/ 存储空间/ 与/ 查询/ 时间/ 效率/ 的/ 高效/ 随机/ 访问/ 分块/ 倒排/ 文件/ 自/ 索引/ RABIF/ ./ 为了/ 支持/ 连接/ 布尔/ 查询/ 与/ 排序/ 查询/ ,/ RABIF/ 将/ 倒/ 排列/ 表/ 进行/ 合理/ 地/ 分块/ ,/ 然后/ 对/ 每个/ 子块/ 的/ 定位/ 部分/ 与/ 信息/ 部分/ 分别/ 采用/ Golomb/ 与/ BIC/ 编码/ 进行/ 压缩/ ,/ 降低/ 倒/ 排列/ 表/ 的/ 空间/ 消耗/ ;/ 在/ 不/ 需要/ 插入/ 任何/ 附加/ 辅助/ 信息/ 的/ 前提/ 下/ ,/ RABIF/ 具有/ 快速/ 定位/ 功能/ ,/ 使得/ 压缩/ 后/ 的/ 索引/ 具有/ 子块级/ 与/ 子块/ 内/ 信息/ 的/ 随机/ 访问/ 能力/ ,/ 显著/ 地/ 提高/ 了/ 查询/ 时间/ 效率/ ./ 理论/ 分析/ 与/ 实验/ 结果表明/ ,/ 当/ k/ 为/ 65/ 时/ ,/ RABIF/ 索引/ 所/ 占/ 空间/ 将/ 低于/ Clucene/ 压缩/ 后/ 的/ 倒/ 排列/ 表/ 文件大小/ ;/ 与/ SIF/ 相比/ ,/ 布尔/ 查询/ 时/ RABIF/ 索引/ 的/ k/ 值/ 范围/ 更大/ ,/ 查询/ 时间/ 平均/ 减少/ 了/ 17.8/ %/ ;/ 对于/ 0.2/ %/ 与/ 1/ %/ 排序/ 查询/ ,/ RABIF/ 查询/ 时间/ 比/ SIF/ 平均/ 减少/ 了/ 34.4/ %/ 与/ 27.5/ %/ ./ 当/ k/ ∈/ (/ 33/ ,/ 1025/ )/ 时/ 提出/ 的/ RABIF/ 算法/ 能/ 同时/ 提高/ 存储空间/ 与/ 查询/ 时间/ 效率/ ./ 考虑/ 到/ 压缩算法/ 性能/ 对系统/ 性能/ 的/ 影响/ ,/ 下/ 一步/ 的/ 工作/ 将/ 在/ 此基础/ 上/ ,/ 考虑/ 采用/ 性能/ 更优/ 的/ 压缩算法/ 对/ 倒/ 排列/ 表/ 进行/ 编码/ ,/ 进而/ 提高/ 系统/ 的/ 时空/ 性能/ ;/ 并/ 研究/ 高效/ 的/ 索引/ 动态/ 更新/ 机制/ ./ 致谢/ 衷心/ 地/ 感谢/ 审稿/ 专家/ 与/ 同行/ 富有/ 建设性/ 的/ 意见/ 和/ 建议/ ,/ 感谢/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 数据库/ 新/ 技术/ 研究/ 小组/ 老师/ 和/ 同学/ 们/ 的/ 大力支持/ 和/ 帮助/ !/ 

