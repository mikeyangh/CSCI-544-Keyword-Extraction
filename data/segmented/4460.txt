Page1/ 可证/ 安全/ 的/ 无/ 证书/ 混合/ 签密/ 俞惠芳/ 1/ )/ ,/ 2/ )/ 杨波/ 1/ )/ 1/ )/ (/ 陕西/ 师范大学/ 计算机科学/ 学院/ 西安/ 710062/ )/ 2/ )/ (/ 青海/ 师范大学/ 计算机/ 学院/ 西宁/ 810008/ )/ 摘要/ 混合/ 签密/ 能够/ 处理/ 任意/ 长度/ 的/ 消息/ ,/ 而公钥/ 签密/ 则/ 不能/ ./ 文中/ 将/ 混合/ 签密/ 技术/ 扩展/ 到/ 无/ 证书/ 环境/ ,/ 构建/ 了/ 一个/ 可/ 证明/ 安全/ 的/ 无/ 证书/ 混合/ 签密/ 方案/ ./ 随机/ 预言/ 模型/ 下/ ,/ 作者/ 证明/ ,/ 所提/ 方案/ 在/ 双线性/ Diffie/ -/ Hellman/ 问题/ 和/ 计算/ 性/ Diffie/ -/ Hellman/ 问题/ 的/ 难解/ 性下/ ,/ 满足/ 自/ 适应/ 选择/ 密文/ 攻击/ 下/ 的/ 不可/ 区分/ 性/ 和/ 自/ 适应/ 选择/ 消息/ 攻击/ 下/ 的/ 不可/ 伪造/ 性/ ./ 文中/ 方案/ 计算/ 复杂度/ 低/ ,/ 适合/ 于/ 实际/ 应用/ ./ 关键词/ 无/ 证书/ 密码学/ ;/ 混合/ 签密/ ;/ 可证/ 安全性/ ;/ 双线性/ 对/ ;/ 密码学/ 1/ 引言/ 公钥/ 密码/ 是/ 一种/ 实现/ 网络/ 和/ 信息安全/ 的/ 重要/ 技术/ ./ 传统/ 公钥/ 密码/ 要求/ 认证/ 机构/ 颁发/ 证书/ 来/ 绑定/ 用户/ 的/ 身份/ 和/ 公钥/ ,/ 这样/ 就/ 带来/ 了/ 证书/ 管理/ 问题/ ./ 一旦/ 用户量/ 剧增/ ,/ 证书/ 管理/ 问题/ 就/ 会/ 极大/ 地/ 影响/ 系统/ 性能/ ./ 为了/ 简化/ 证书/ 的/ 管理/ ,/ 降低/ 额外/ 的/ 计算/ 开销/ ,/ Shamir/ [/ 1/ ]/ 提出/ 了/ 基于/ 身份/ 的/ 公钥/ 密码学/ 概念/ ./ 按照/ Shamir/ 思想/ ,/ 用户/ 不是/ 自己/ 生成/ 公钥/ 和/ 私钥/ ,/ 而是/ 选择/ 其/ 公开/ 身份/ 信息/ 作为/ 公钥/ ,/ 私钥/ 生成/ 中心/ 用/ 这些/ 公开/ 身份/ 信息/ 为/ 用户/ 计算/ 出/ 相应/ 私钥/ ./ 为了/ 解决/ 身份/ 密码学/ 中/ 的/ 密钥/ 托管/ 问题/ 和/ 传统/ 公钥/ 基础设施/ 中/ 的/ 证书/ 管理/ 问题/ ,/ 2003/ 年/ 的/ 亚密/ 会上/ Al/ -/ RiyamiPage2/ 和/ Paterson/ [/ 2/ ]/ 提出/ 无/ 证书/ 密码学/ ,/ 减少/ 了/ 对/ 密钥/ 生成/ 中心/ (/ KeyGenerationCenter/ ,/ KGC/ )/ 的/ 信任/ ,/ KGC/ 生成/ 用户/ 的/ 部分/ 私钥/ ,/ 用户/ 的/ 完整/ 私钥/ 由/ 这个/ 部分/ 私钥/ 和/ 用户/ 自己/ 随机/ 选取/ 的/ 秘密/ 值/ 构成/ ,/ 而/ 用户/ 公钥/ 由/ 用户/ 自己/ 计算/ 得出/ ./ 构造/ 无/ 证书/ 的/ 密码/ 方案/ [/ 3/ -/ 5/ ]/ 一直/ 是/ 密码/ 学界/ 感兴趣/ 的/ 研究/ 方向/ ./ 加密/ 任意/ 长度/ 的/ 消息/ 时/ ,/ 通常/ 的/ 公钥/ 加密/ 限制/ 了/ 其/ 消息/ 空间/ ./ Cramer/ 等/ 人/ [/ 6/ ]/ 构造/ 的/ 混合/ 加密/ 能够/ 实现/ 大/ 消息/ 的/ 保密/ 通信/ ./ 一个/ 混合/ 加密/ 方案/ 包含/ 两/ 部分/ :/ 密钥/ 封装/ 机制/ (/ KeyEncapsulationMechanism/ ,/ KEM/ )/ 和/ 数据/ 封装/ 机制/ (/ DataEncapsulationMech/ -/ anism/ ,/ DEM/ )/ ,/ KEM/ 运用/ 非对称/ 技术/ 加密/ 一个/ 对称/ 密钥/ ,/ 而/ DEM/ 利用/ 对称/ 技术/ 和/ 这个/ 对称/ 密钥/ 加密/ 任意/ 长度/ 的/ 消息/ ./ KEM/ 和/ DEM/ 是/ 完全/ 独立/ 的/ 两个/ 模块/ ,/ 因而/ 可以/ 被/ 分别/ 研究/ ./ 混合/ 密码学/ [/ 7/ -/ 10/ ]/ 能够/ 顾及/ 到/ 密码学/ 应用/ 中/ 的/ 安全性/ 和/ 高效性/ ,/ 是/ IND/ -/ CCA2/ 安全/ 的/ 公钥/ 密码/ 机制/ 的/ 通用/ 解决/ 方法/ ./ 2005/ 年/ ,/ Dent/ [/ 11/ -/ 12/ ]/ 将/ KEM/ -/ DEM/ 混合结构/ 扩展/ 到/ 签密/ 环境/ ,/ 提出/ 混合/ 签密/ 的/ 概念/ ./ 后来/ ,/ Tan/ [/ 13/ ]/ 构造/ 了/ 标准/ 模型/ 下/ 的/ 签密/ KEM/ 和/ 签密/ tag/ -/ KEM/ ./ 2011/ 年/ ,/ Sun/ 等/ 人/ [/ 14/ ]/ 提出/ 了/ 基于/ 身份/ 的/ 多/ 接收者/ 签密/ KEM/ ./ 2013/ 年/ ,/ Li/ 等/ 人/ [/ 15/ ]/ 给出/ 了/ 一个/ 内部/ 安全/ 的/ 无/ 证书/ 混合/ 签密/ 方案/ ./ 可以/ 说/ ,/ 设计/ 安全/ 高效/ 的/ 无/ 证书/ 混合/ 签密/ 方案/ 是/ 值得/ 研究/ 的/ 重要/ 问题/ ./ 本文/ 构造/ 出/ 随机/ 预言/ 模型/ 下可证/ 安全/ 的/ 无/ 证书/ 混合/ 签密/ (/ PS/ -/ CLHS/ )/ ,/ PS/ -/ CLHS/ 包含/ 一个/ 无/ 证书/ 签密/ KEM/ (/ CertificatelessSigncryptionKEM/ ,/ CLS/ -/ KEM/ )/ 和/ 一个/ DEM/ ./ PS/ -/ CLHS/ 的/ IND/ -/ CCA2/ 安全性/ 和/ sUF/ -/ CMA/ 安全性/ 可/ 规约/ 为/ 双线性/ Diffie/ -/ Hellman/ 问题/ 和/ 计算/ 性/ Diffie/ -/ Hellman/ 问题/ 的/ 难解/ 性/ ./ PS/ -/ CLHS/ 方案/ 不仅/ 计算/ 复杂度/ 低/ ,/ 而且/ 安全/ 实用/ ./ 本文/ 第/ 2/ 节/ 介绍/ 双线性/ 映射/ 和/ 一些/ 密码学/ 假设/ ,/ 描述/ CLS/ -/ KEM/ 、/ DEM/ 和/ PS/ -/ CLHS/ 的/ 定义/ 以及/ PS/ -/ CLHS/ 的/ 安全/ 模型/ ;/ 第/ 3/ 节/ 具体/ 描述/ 本文/ 方案/ ;/ 第/ 4/ 节/ 分析/ 本文/ 方案/ 的/ 安全/ 结果/ ;/ 第/ 5/ 节对/ 本文/ 方案/ 与/ 同类/ 方案/ 进行/ 性能/ 比较/ ;/ 最后/ 一节/ 总结/ 全文/ ./ 2/ 预备/ 知识/ 2.1/ 双线性/ 映射/ G1/ 是/ 一个/ 阶为/ 素数/ q/ 的/ 加法/ 群/ ,/ G2/ 为/ 相同/ 阶/ 的/ 乘法/ 群/ ./ P/ 是/ G1/ 的/ 本原/ 根/ ./ e/ :/ G1/ ×/ G1/ →/ G2/ 是/ 具有/ 以下/ 性质/ 的/ 双线性/ 映射/ ./ (/ 1/ )/ 双线性/ ./ / a/ ,/ b/ ∈/ Z/ / (/ 2/ )/ 非/ 退化/ 性/ ./ e/ (/ P/ ,/ P/ )/ ≠/ 1G2/ ./ (/ 3/ )/ 可计算性/ ./ / P/ ,/ Q/ ∈/ G1/ ,/ 存在/ 一个/ 有效/ 算法/ ComputationalDiffie/ -/ Hellman/ (/ CDH/ )/ 问题/ ./ BilinearDiffie/ -/ Hellman/ (/ BDH/ )/ 问题/ ./ 已知/ (/ P/ ,/ 计算/ e/ (/ P/ ,/ Q/ )/ ./ 2.2/ 复杂性/ 假设/ aP/ ,/ bP/ ,/ cP/ )/ ∈/ G1/ ,/ 对于/ 任意/ 未知/ 的/ a/ ,/ b/ ,/ c/ ∈/ Z/ / e/ (/ P/ ,/ P/ )/ abc/ ∈/ G2/ ./ DecisionalBilinearDiffie/ -/ Hellman/ (/ DBDH/ )/ 问题/ ./ 已知/ (/ P/ ,/ aP/ ,/ bP/ ,/ cP/ )/ ∈/ G1/ 和/ z/ ∈/ G2/ ,/ 对于/ 任意/ 未知/ 的/ a/ ,/ b/ ,/ c/ ∈/ Z/ / 成立/ ,/ ODBDH/ 返回/ 1/ ;/ 否则/ ,/ ODBDH/ 返回/ 0/ ./ 已知/ (/ P/ ,/ aP/ ,/ bP/ )/ ∈/ G1/ ,/ 对于/ 任意/ 未知/ 的/ a/ ,/ b/ ∈/ Z/ / 算/ abP/ ∈/ G1/ ./ 2.3/ CLS/ -/ KEM/ [/ 14/ ]/ 一个/ CLS/ -/ KEM/ 方案/ 可以/ 通过/ 下面/ 6/ 个/ 概率/ 多项式/ 时间/ 算法/ 来/ 定义/ ./ Setup/ :/ 这个/ 算法/ 输入/ 安全/ 参数/ k/ ,/ 输出/ 系统/ 参数/ params/ 以及/ 主/ 密钥/ x/ ./ Extract/ -/ Partial/ -/ Private/ -/ Key/ :/ 这个/ 算法/ 输入/ 系统/ 参数/ params/ 、/ 主控/ 钥/ x/ 和/ 用户/ 身份/ ui/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ 输出/ 该/ 用户/ 部分/ 私钥/ di/ ./ Generate/ -/ User/ -/ Key/ :/ 这个/ 算法/ 输入/ 用户/ 身份/ ui/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ 输出/ 秘密/ 值/ xi/ 和/ 用户/ 公钥/ Pi/ ./ Extract/ -/ Private/ -/ Key/ :/ 这个/ 算法/ 输入/ 部分/ 私钥/ di/ 和/ 秘密/ 值/ xi/ ,/ 输出/ 完整/ 私钥/ si/ =/ (/ xi/ ,/ di/ )/ ./ Encap/ :/ 这个/ 算法/ 输入/ 系统/ 参数/ params/ 、/ 发送者/ 的/ 身份/ uA/ 和/ 公私/ 钥对/ (/ PA/ ,/ sA/ )/ 、/ 接收者/ 的/ 身份/ uB/ 和/ 公钥/ PB/ ,/ 输出/ 对称/ 密钥/ κ/ 和/ 密钥/ 封装/ / ./ Decap/ :/ 这个/ 算法/ 输入/ 系统/ 参数/ params/ 、/ 密钥/ 封装/ / 、/ 发送者/ 的/ 身份/ uA/ 和/ 公钥/ PA/ 、/ 接收者/ 的/ 身份/ uB/ 和/ 公私/ 钥对/ (/ PB/ ,/ sB/ )/ ,/ 输出/ 对称/ 密钥/ κ/ 或/ 表示/ 解/ 封装/ 失败/ 的/ 标志/ ⊥/ ./ 2.4/ DEM/ [/ 15/ ]/ DEM/ 包含/ 下面/ 两个/ 概率/ 多项式/ 时间/ 算法/ ./ Enc/ :/ 这个/ 算法/ 输入/ 安全/ 参数/ k/ 、/ 消息/ m/ 和/ 对称/ Dec/ :/ 这个/ 算法/ 输入/ 对称/ 密钥/ κ/ 和/ 密文/ c/ ,/ 输出/ 密钥/ κ/ ,/ 输出/ 密文/ c/ ./ 明文/ m/ 或/ 符号/ ⊥/ ./ 2.5/ PS/ -/ CLHS/ 成/ ,/ 算法/ 细节/ 如下/ 所述/ ./ PS/ -/ CLHS/ 由/ CLS/ -/ KEM/ 和/ DEM/ 两个/ 方案/ 组/ Setup/ :/ 与/ CLS/ -/ KEM/ 方案/ 相同/ ./ Page3/ 案/ 相同/ ./ PB/ )/ ,/ 发送者/ 通过/ 以下/ 步骤/ 生成/ 密文/ σ/ ./ Extract/ -/ Partial/ -/ Private/ -/ Key/ :/ 与/ CLS/ -/ KEM/ 方/ Generate/ -/ User/ -/ Key/ :/ 与/ CLS/ -/ KEM/ 方案/ 相同/ ./ Extract/ -/ Private/ -/ Key/ :/ 与/ CLS/ -/ KEM/ 方案/ 相同/ ./ Signcrypt/ :/ 已知/ (/ params/ ,/ uA/ ,/ uB/ ,/ m/ ,/ sA/ ,/ PA/ ,/ (/ 1/ )/ 利用/ 2.3/ 节/ Encap/ 算法/ 计算/ (/ κ/ ,/ / )/ ./ (/ 2/ )/ 利用/ 2.4/ 节/ Enc/ 算法/ 计算/ 密文/ c/ ./ (/ 3/ )/ 输出/ σ/ ←/ (/ c/ ,/ / )/ ./ Unsigncrypt/ :/ 已知/ (/ params/ ,/ uA/ ,/ uB/ ,/ σ/ ,/ sB/ ,/ PA/ ,/ (/ 1/ )/ 利用/ 2.3/ 节/ Decap/ 算法/ 计算/ κ/ ./ (/ 2/ )/ 利用/ 2.4/ 节/ Dec/ 算法/ 恢复/ 消息/ m/ ./ (/ 3/ )/ 检查/ 验证/ 等式/ 是否/ 成立/ ?/ 若/ 成立/ ,/ 接受/ 明文/ PB/ )/ ,/ 接收者/ 执行/ 如下/ 步骤/ ./ m/ ;/ 否则/ ,/ 输出/ 符号/ ⊥/ ./ 2.6/ PS/ -/ CLHS/ 的/ 安全/ 模型/ PS/ -/ CLHS/ 方案/ 应该/ 满足/ IND/ -/ CCA2/ 安全性/ 和/ sUF/ -/ CMA/ 安全性/ ./ PS/ -/ CLHS/ 的/ 安全/ 模型/ 中/ ,/ 我们/ 考虑/ 两类/ 攻击者/ ./ 第/ 1/ 类/ 攻击者/ / I/ 或/ / I/ 不/ 知道/ KGC/ 的/ 主控/ 钥/ ,/ 但/ 能够/ 自/ 适应/ 地/ 替换/ 任意/ 用户/ 的/ 公钥/ ./ 第/ 2/ 类/ 攻击者/ / II/ 或/ / II/ 知道/ KGC/ 的/ 主控/ 钥/ ,/ 但/ 不/ 具备/ 替换/ 任意/ 用户/ 公钥/ 的/ 能力/ ./ 定义/ 1/ ./ 如果/ 任何/ 多项式/ 有界/ 的/ 敌手/ / I/ 和/ / II/ 赢得/ IND/ -/ CCA2/ -/ I/ 和/ IND/ -/ CCA2/ -/ II/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ,/ 则/ 称/ 一个/ PS/ -/ CLHS/ 方案/ 具有/ 自/ 适应/ 选择/ 密文/ 攻击/ 下/ 的/ 不可/ 区分/ 性/ ./ IND/ -/ CCA2/ -/ I/ :/ 这是/ 一个/ 挑战者/ Γ/ 和/ 敌手/ / I/ 之间/ 进行/ 的/ 交互/ 游戏/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ 产生/ 系统/ 参数/ params/ 和/ 主控/ 钥/ x/ ,/ 返回/ params/ 给/ / I/ ,/ 保留/ x/ ./ 阶段/ 1/ ./ / I/ 在/ 这个/ 阶段/ 进行/ 如下/ 多项式/ 有界次/ 适应性/ 询问/ ./ 公钥/ 询问/ :/ 收到/ 任意/ 身份/ 的/ 公钥/ 询问/ 时/ ,/ Γ/ 运行/ 用户/ 钥/ 生成/ 算法/ ,/ 返回/ 公钥/ Pi/ ./ 部分/ 私钥/ 询问/ :/ 收到/ 任意/ 身份/ 的/ 部分/ 私钥/ 询问/ 时/ ,/ Γ/ 运行/ 部分/ 私钥/ 提取/ 算法/ ,/ 返回/ 部分/ 私钥/ di/ ./ 私钥/ 询问/ :/ 收到/ 任意/ 身份/ 的/ 私钥/ 询问/ 时/ ,/ Γ/ 从/ 相关/ “/ 询问/ 与/ 应答/ ”/ 表中/ 找到/ 含有/ 完整/ 私钥/ 的/ 条目/ ,/ 返回/ 完整/ 私钥/ si/ ←/ (/ xi/ ,/ di/ )/ ./ 如果/ 公钥/ 已/ 被/ 替换/ ,/ 不/ 允许/ / I/ 询问/ 秘密/ 值/ ./ 公钥/ 替换/ :/ / I/ 可以/ 在/ 指定/ 范围/ 内/ 选择/ 任意/ 值/ ,/ 替换/ 任何/ 用户/ 的/ 公钥/ ./ 签密/ 询问/ :/ 收到/ 消息/ m/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ 身份/ uB/ 下/ 的/ 签密/ 询问/ 时/ ,/ Γ/ 从/ 相关/ “/ 询问/ 与/ 应答/ ”/ 表中/ 检索/ 到/ (/ sA/ ,/ PA/ ,/ PB/ )/ ,/ 并/ 返回/ σ/ ←/ Signcrypt/ (/ params/ ,/ uA/ ,/ uB/ ,/ m/ ,/ sA/ ,/ PA/ ,/ PB/ )/ ./ 解/ 签密/ 询问/ :/ 收到/ 密文/ σ/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ 身份/ uB/ 下/ 的/ 解/ 签密/ 询问/ 时/ ,/ Γ/ 从/ 相关/ “/ 询问/ 与/ 应答/ ”/ 表中/ 检索/ 到/ (/ sB/ ,/ PA/ ,/ PB/ )/ ,/ 并/ 返回/ m/ // ⊥/ ←/ Unsigncrypt/ (/ params/ ,/ uA/ ,/ uB/ ,/ σ/ ,/ sB/ ,/ PA/ ,/ PB/ )/ ./ 挑战/ ./ 阶段/ 1/ 结束/ 后/ ,/ / I/ 生成/ 两个/ 相同/ 长度/ 的/ 明文/ m0/ ,/ m1/ 以及/ 希望/ 挑战/ 的/ 两个/ 身份/ (/ u/ / A/ ,/ u/ / B/ )/ ,/ 这里/ u/ / A/ 和/ u/ / B/ 分别/ 是/ 发送者/ 和/ 接收者/ 的/ 身份/ ./ 阶段/ 1/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 和/ 部分/ 私钥/ 不能/ 被/ 询问/ ,/ 并且/ u/ / B/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ./ Γ/ 从/ 相关/ “/ 询问/ 与/ 应答/ ”/ 表中/ 找到/ (/ s/ / A/ ,/ P/ / A/ ,/ P/ / B/ )/ ,/ 选择/ γ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ 计算/ σ/ / ←/ Signcrypt/ (/ params/ ,/ u/ / A/ ,/ u/ / B/ ,/ m/ γ/ ,/ s/ / A/ ,/ P/ / A/ ,/ P/ / B/ )/ ,/ 返回/ 挑战/ 密文/ σ/ / ./ 阶段/ 2/ ./ / I/ 像/ 阶段/ 1/ 那样/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ 约束条件/ 是/ :/ (/ 1/ )/ u/ / B/ 的/ 完整/ 私钥/ 不能/ 被/ 询问/ ;/ (/ 2/ )/ u/ / B/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ;/ (/ 3/ )/ 不能/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ σ/ / 进行/ 解/ 签密/ 询问/ ./ 猜测/ ./ / I/ 输出/ 一个/ 猜测/ γ/ / ./ 若/ γ/ / =/ γ/ ,/ / I/ 赢得/ IND/ -/ CCA2/ -/ I/ ./ 我们/ 定义/ / I/ 的/ 获胜/ 优势/ 为/ IND/ -/ CCA2/ -/ II/ :/ 这是/ 一个/ 挑战者/ Γ/ 和/ 敌手/ / II/ 之间/ 进行/ 的/ 交互/ 游戏/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ 产生/ 系统/ 参数/ params/ 以及/ 主控/ 钥/ x/ ,/ 返回/ (/ params/ ,/ x/ )/ 给/ / II/ ./ 阶段/ 1/ ./ / II/ 在/ 这个/ 阶段/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ 除了/ 不/ 需要/ 进行/ 部分/ 私钥/ 询问/ 和/ 公钥/ 替换/ 询问/ 之外/ ,/ 公钥/ 询问/ 、/ 私钥/ 询问/ 、/ 签密/ 询问/ 和解/ 签密/ 询问/ 类似/ 于/ IND/ -/ CCA2/ -/ I/ 的/ 阶段/ 1/ ./ 需要/ 注意/ 的/ 是/ ,/ 由于/ / II/ 知道/ 主控/ 钥/ x/ ,/ 自己/ 能够/ 计算/ 出/ 用户/ 的/ 部分/ 私钥/ ./ 挑战/ ./ 阶段/ 1/ 结束/ 以后/ ,/ / II/ 生成/ 两个/ 相同/ 长度/ 的/ 明文/ m0/ ,/ m1/ 以及/ 希望/ 挑战/ 的/ 两个/ 身份/ (/ u/ / A/ ,/ u/ / B/ )/ ,/ 这里/ u/ / A/ 和/ u/ / B/ 分别/ 是/ 发送者/ 和/ 接收者/ 的/ 身份/ ./ 阶段/ 1/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 不能/ 被/ 询问/ ./ Γ/ 从/ 相关/ “/ 询问/ 与/ 应答/ ”/ 表中/ 找到/ (/ s/ / A/ ,/ P/ / A/ ,/ P/ / B/ )/ ,/ 选择/ γ/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ 计算/ σ/ / ←/ Signcrypt/ (/ params/ ,/ u/ / A/ ,/ u/ / B/ ,/ m/ γ/ ,/ s/ / A/ ,/ P/ / A/ ,/ P/ / B/ )/ ,/ 返回/ 挑战/ 密文/ σ/ / ./ 阶段/ 2/ ./ / II/ 像/ 阶段/ 1/ 那样/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ 约束条件/ 是/ :/ (/ 1/ )/ u/ / B/ 的/ 秘密/ 值/ 不能/ 被/ 询问/ ;/ (/ 2/ )/ 不能/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ σ/ / 进行/ 解/ 签密/ 询问/ ./ 猜测/ ./ / II/ 输出/ 一个/ 猜测/ γ/ / ./ 若/ γ/ / =/ γ/ ,/ / II/ 赢得/ IND/ -/ CCA2/ -/ II/ ./ 我们/ 定义/ / II/ 的/ 获胜/ 优势/ 为/ Page4/ 间/ 进行/ 的/ 交互/ 游戏/ ./ params/ 和/ 主控/ 钥/ x/ ,/ 返回/ params/ 给/ / I/ ,/ 保留/ x/ ./ 的/ 询问/ 与/ IND/ -/ CCA2/ -/ I/ 的/ 阶段/ 1/ 相同/ ./ 定义/ 2/ ./ 如果/ 任何/ 多项式/ 有界/ 的/ 伪造者/ / I/ 和/ / II/ 赢得/ sUF/ -/ CMA/ -/ I/ 和/ sUF/ -/ CMA/ -/ II/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ,/ 则/ 称/ 一个/ PS/ -/ CLHS/ 方案/ 在/ 自/ 适应/ 选择/ 明文/ 攻击/ 下/ 是/ 不可/ 伪造/ 的/ ./ sUF/ -/ CMA/ -/ I/ :/ 这是/ 一个/ 挑战者/ Γ/ 和/ 伪造者/ / I/ 之/ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ 产生/ 系统/ 参数/ 训练/ ./ / I/ 进行/ 适应性/ 多项式/ 有界次/ 询问/ ./ 进行/ 伪造/ ./ 训练/ 阶段/ 结束/ 的/ 时候/ ,/ / I/ 输出/ 一个/ 伪造/ (/ σ/ / ,/ u/ / A/ ,/ u/ / B/ )/ ./ 训练/ 期间/ ,/ / I/ 不能/ 询问/ u/ / A/ 的/ 部分/ 私钥/ 和/ 秘密/ 值/ ,/ u/ / A/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ./ 此外/ ,/ σ/ / 不能/ 是/ 来自/ 伪造者/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ 某个/ 消息/ m/ / 的/ 签密/ 询问/ 的/ 应答/ ./ 如果/ 不是/ 符号/ ⊥/ ,/ / I/ 赢得/ sUF/ -/ CMA/ -/ I/ ./ Unsigncrypt/ (/ params/ ,/ u/ / A/ ,/ u/ / B/ ,/ σ/ / ,/ s/ / B/ ,/ P/ / A/ ,/ P/ / B/ )/ / I/ 获胜/ 的/ 优势/ 定义/ 为/ 之间/ 进行/ 的/ 交互/ 游戏/ ./ params/ 以及/ 主控/ 钥/ x/ ,/ 返回/ (/ params/ ,/ x/ )/ 给/ / II/ ./ 行/ 的/ 询问/ 类似/ 于/ IND/ -/ CCA2/ -/ II/ 的/ 阶段/ 1/ ./ sUF/ -/ CMA/ -/ II/ :/ 这是/ 一个/ 挑战者/ Γ/ 和/ 伪造者/ / II/ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ 产生/ 系统/ 参数/ 训练/ ./ / II/ 自/ 适应/ 地/ 进行/ 多项式/ 有界次/ 询问/ ./ 进/ 伪造/ ./ 训练/ 阶段/ 结束/ 的/ 时候/ ,/ / II/ 输出/ 一个/ 伪造/ (/ σ/ / ,/ u/ / A/ ,/ u/ / B/ )/ ./ 训练/ 期间/ ,/ / II/ 不能/ 询问/ u/ / A/ 的/ 秘密/ 值/ ,/ 并且/ σ/ / 不能/ 是/ 来自/ 伪造者/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ 某个/ 消息/ m/ / 的/ 签密/ 询问/ 的/ 应答/ ./ 如果/ 不是/ 符号/ ⊥/ ,/ / II/ 赢得/ sUF/ -/ CMA/ -/ II/ ./ Unsigncrypt/ (/ params/ ,/ u/ / A/ ,/ u/ / B/ ,/ σ/ / ,/ s/ / B/ ,/ P/ / A/ ,/ P/ / B/ )/ / II/ 获胜/ 的/ 优势/ 定义/ 为/ 3/ 具体/ 方案/ 3.1/ Setup/ 令/ G1/ 和/ G2/ 分别/ 是/ 素数/ 阶/ q/ / 2k/ (/ k/ 是/ 安全/ 参数/ )/ 的/ 加法/ 群/ 和/ 乘法/ 群/ ,/ P/ 是/ G1/ 的/ 一个/ 生成元/ ,/ e/ :/ G1/ ×/ G1/ →/ G2/ 是/ 个/ 双线性/ 映射/ ./ KGC/ 定义/ 3/ 个/ 密码学/ Hash/ 函数/ :/ h1/ :/ {/ 0/ ,/ 1/ }/ / →/ G1/ ,/ h2/ :/ G2h3/ :/ {/ 0/ ,/ 1/ }/ / 2/ ×/ {/ 0/ ,/ 1/ }/ n/ ×/ G3/ 密钥/ 长度/ ./ 然后/ ,/ KGC/ 选择/ x/ ∈/ RZ/ / 算/ 系统/ 公钥/ Ppub/ =/ xP/ ./ 最后/ ,/ KGC/ 保密/ 主控/ 钥/ x/ ,/ 公布/ 系统/ 参数/ params/ =/ (/ G1/ ,/ G2/ ,/ e/ ,/ P/ ,/ Ppub/ ,/ n/ ,/ h1/ ,/ h2/ ,/ h3/ )/ ./ 3.2/ Extract/ -/ Partial/ -/ Private/ -/ Key/ 给定/ params/ 、/ 系统/ 主控/ 钥/ x/ 和/ 用户/ 身份/ ui/ ,/ KGC/ 计算/ Hi/ =/ h1/ (/ ui/ )/ ,/ 设置/ 用户/ 的/ 部分/ 私钥/ di/ =/ xHi/ ,/ 并/ 发送/ (/ ui/ ,/ di/ )/ 给/ 用户/ ./ 3.3/ Generate/ -/ User/ -/ Key/ 给定/ 用户/ 身份/ ui/ ,/ 该/ 用户/ 随机/ 选择/ 一个/ 秘密/ 值/ q/ ,/ 计算/ 公钥/ Pi/ =/ xiP/ ./ 给定/ 部分/ 私钥/ di/ 和/ 秘密/ 值/ xi/ ,/ 这个/ 算法/ 设置/ 完/ xi/ ∈/ Z/ / 3.4/ Generate/ -/ User/ -/ Key/ 整/ 私钥/ si/ ←/ (/ xi/ ,/ di/ )/ ./ 3.5/ Signcrypt/ 过/ 以下/ 步骤/ 生成/ 密文/ ./ 给定/ (/ params/ ,/ uA/ ,/ uB/ ,/ m/ ,/ sA/ ,/ PA/ ,/ PB/ )/ ,/ 发送者/ 通/ (/ 1/ )/ 选择/ r/ ∈/ RZ/ / (/ 2/ )/ 计算/ y/ =/ e/ (/ Ppub/ ,/ HB/ )/ r/ ./ (/ 3/ )/ 计算/ z/ =/ e/ (/ PB/ ,/ HB/ )/ r/ ./ (/ 4/ )/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ./ (/ 5/ )/ 计算/ c/ =/ DEM/ ./ Enc/ (/ κ/ ,/ m/ )/ ./ (/ 6/ )/ 计算/ f/ =/ h3/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ )/ ./ (/ 7/ )/ 计算/ S/ =/ rHA/ +/ xAf/ +/ dA/ ./ (/ 8/ )/ 输出/ σ/ =/ (/ c/ ,/ / ←/ (/ R/ ,/ S/ )/ )/ ./ 给定/ (/ params/ ,/ uA/ ,/ uB/ ,/ σ/ ,/ sB/ ,/ PA/ ,/ PB/ )/ ,/ 接收者/ 执/ (/ 1/ )/ 计算/ y/ =/ e/ (/ R/ ,/ dB/ )/ ./ (/ 2/ )/ 计算/ z/ =/ e/ (/ R/ ,/ HB/ )/ xB/ ./ (/ 3/ )/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ./ (/ 4/ )/ 计算/ m/ =/ DEM/ ./ Dec/ (/ κ/ ,/ c/ )/ ./ (/ 5/ )/ 计算/ f/ =/ h3/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ )/ ./ (/ 6/ )/ 验证/ e/ (/ P/ ,/ S/ )/ =/ e/ (/ R/ ,/ HA/ )/ e/ (/ PA/ ,/ f/ )/ e/ (/ Ppub/ ,/ 3.6/ Unsigncrypt/ 行/ 以下/ 步骤/ ./ HA/ )/ 是否/ 成立/ ?/ 若/ 成立/ ,/ 接受/ m/ ;/ 否则/ ,/ 输出/ ⊥/ ./ 4/ 安全性/ 分析/ 定理/ 1/ ./ 假如/ 存在/ 一个/ IND/ -/ CCA2/ -/ I/ 敌手/ / I/ 经过/ qi/ 次/ hi/ 询问/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 、/ qe1/ 次/ 部分/ 私钥/ 询问/ 、/ qe2/ 次/ 私钥/ 询问/ 和/ qr/ 次公钥/ 替换/ 询问/ 后/ ,/ 能以/ 一个/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ PS/ -/ CLHS/ 方案/ 的/ IND/ -/ CCA2/ -/ I/ 安全性/ ,/ 则/ 存在/ 一个/ 算法/ Γ/ 能以/ 优势/ ε/ 解决/ BDH/ 问题/ ,/ 这里/ ε/ 为/ Page5/ 证明/ ./ 假设/ Γ/ 收到/ 一个/ BDH/ 问题/ 的/ 随机/ 实例/ (/ P/ ,/ aP/ ,/ bP/ ,/ cP/ )/ ∈/ G1/ ,/ 目标/ 是/ 计算/ 出/ e/ (/ P/ ,/ P/ )/ abc/ ∈/ G2/ ./ 为了/ 达到/ 这个/ 目标/ ,/ Γ/ 将/ / I/ 作为/ 子程序/ 并/ 扮演/ 其/ 挑战者/ 在/ IND/ -/ CCA2/ -/ I/ 中/ 与/ 之/ 交互/ ./ 假设/ 游戏/ 中/ / I/ 询问/ 以/ 身份/ ui/ 作为/ 输入/ 的/ 其它/ 预言/ 机/ 之前/ 都/ 先用/ 身份/ ui/ 询问/ h1/ 预言/ 机/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ ,/ 返回/ 系统/ 参数/ (/ G1/ ,/ G2/ ,/ e/ ,/ P/ ,/ Ppub/ =/ aP/ ,/ n/ ,/ h1/ ,/ h2/ ,/ h3/ )/ 给/ / I/ ./ 为了/ 避免/ 对/ / I/ 的/ 询问/ 的/ 非/ 连续/ 应答/ ,/ Γ/ 维护/ 起初/ 为空/ 的/ 4/ 张/ 列表/ L1/ ~/ L3/ 与/ Lk/ ./ 阶段/ 1/ ./ / I/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ h1/ 询问/ :/ / I/ 选择/ 一系列/ 身份/ 询问/ 相应/ Hash/ 值/ ./ 接收/ 到/ 身份/ ui/ 的/ h1/ 询问/ 时/ ,/ 若/ L1/ 中/ 含有/ (/ ui/ ,/ Hi/ ,/ li/ )/ ,/ Γ/ 返回/ Hi/ 作为/ 应答/ ;/ 否则/ ,/ Γ/ 随机/ 选择/ 一个/ 整数/ α/ ∈/ [/ 1/ ../ q1/ ]/ ,/ 将/ u/ α/ 作为/ 挑战/ 身份/ 但/ 不会/ 泄露/ α/ 的/ 值/ 给/ / I/ ./ 如果/ 接收/ 到/ 的/ 是/ 第/ α/ 次/ 询问/ ,/ Γ/ 设置/ Hi/ =/ bP/ ,/ 返回/ Hi/ ,/ 添加/ (/ ui/ ,/ Hi/ ,/ -/ )/ 到/ L1/ ./ 如果/ 接收/ 到/ 的/ 不是/ 第/ α/ 次/ 询问/ ,/ 选择/ 一个/ 随机数/ li/ ∈/ Z/ / 加/ (/ ui/ ,/ Hi/ ,/ li/ )/ 到/ L1/ ./ h2/ 询问/ :/ 接收/ 到/ h2/ 询问/ 时/ ,/ Γ/ 检查/ L2/ 中/ 是否/ 含有/ 元组/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ ./ 若有/ ,/ 返回/ 对称/ 密钥/ κ/ ;/ 否则/ ,/ 返回/ 任意/ 的/ κ/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 添加/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ 到/ L2/ ./ h3/ 询问/ :/ 接收/ 到/ h3/ 询问/ 时/ ,/ Γ/ 检查/ L3/ 中/ 是否/ 含有/ 元组/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ ./ 若有/ ,/ 返回/ f/ ;/ 否则/ ,/ Γ/ 选择/ 一个/ 随机数/ υ/ ∈/ Z/ / (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ 到/ L3/ ./ 公钥/ 询问/ :/ 收到/ 身份/ ui/ 的/ 公钥/ 询问/ 时/ ,/ Γ/ 检查/ Lk/ 中/ 是否/ 含有/ 条目/ (/ ui/ ,/ di/ ,/ xi/ ,/ Pi/ )/ ./ 若有/ ,/ Γ/ 返回/ 公钥/ Pi/ ;/ 否则/ ,/ 选择/ 一个/ 随机数/ xi/ ∈/ Z/ / 返回/ 公钥/ Pi/ ,/ 添加/ (/ ui/ ,/ -/ ,/ xi/ ,/ Pi/ )/ 到/ Lk/ ./ 部分/ 私钥/ 询问/ :/ 收到/ 身份/ ui/ 的/ 部分/ 私钥/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ ui/ =/ u/ α/ ./ 若/ 相等/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 调用/ h1/ 预言/ 机/ 得到/ li/ ,/ 设置/ di/ =/ liaP/ ,/ 返回/ 部分/ 私钥/ di/ ,/ 以/ (/ ui/ ,/ di/ ,/ xi/ ,/ Pi/ )/ 更新/ Lk/ ./ 私钥/ 询问/ :/ 收到/ 身份/ ui/ 的/ 私钥/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ ui/ =/ u/ α/ ./ 若/ 相等/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 中/ 获得/ (/ ui/ ,/ di/ ,/ xi/ ,/ Pi/ )/ ,/ 返回/ 完整/ 私钥/ si/ ←/ (/ di/ ,/ xi/ )/ ./ 公钥/ 替换/ :/ / I/ 在/ 指定/ 范围/ 内/ 选择/ 一个/ 随机数/ Pi/ 替换/ 身份/ ui/ 的/ 公钥/ Pi/ ./ 若/ ui/ =/ u/ α/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 以/ (/ ui/ ,/ di/ ,/ -/ ,/ Pi/ )/ 更新/ Lk/ ./ 签密/ :/ 收到/ 消息/ m/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ 身份/ uB/ 下/ 的/ 签密/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ uA/ ≠/ u/ α/ ./ 若/ 是/ ,/ Γ/ 正常/ 执行/ 签密/ 算法/ ,/ 返回/ 运行/ 结果/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 检索/ 到/ (/ xB/ ,/ dB/ ,/ PA/ )/ ,/ 并/ 按/ 下面/ 方式/ 生成/ 密文/ ./ 到/ L3/ ./ (/ 1/ )/ 选择/ r/ ,/ υ/ ∈/ RZ/ / (/ 2/ )/ 计算/ y/ =/ e/ (/ R/ ,/ dB/ )/ ./ (/ 3/ )/ 通过/ L1/ 得到/ lB/ ,/ 计算/ z/ =/ e/ (/ R/ ,/ lBP/ )/ xB/ ./ (/ 4/ )/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ,/ 添加/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ 到/ L2/ ./ (/ 5/ )/ 计算/ c/ =/ DEM/ ./ Enc/ (/ κ/ ,/ m/ )/ ./ (/ 6/ )/ 计算/ f/ =/ υ/ P/ ,/ 添加/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ (/ 7/ )/ 通过/ L1/ 得到/ HA/ =/ bP/ ,/ 计算/ S/ =/ rHA/ +/ υ/ PA/ ./ (/ 8/ )/ 返回/ σ/ =/ (/ c/ ,/ / ←/ (/ R/ ,/ S/ )/ )/ ./ 正确性/ :/ e/ (/ R/ ,/ HA/ )/ e/ (/ PA/ ,/ f/ )/ e/ (/ Ppub/ ,/ HA/ )/ =/ e/ (/ rP/ -/ aP/ ,/ bP/ )/ e/ (/ xAPA/ ,/ υ/ P/ )/ e/ (/ aP/ ,/ bP/ )/ =/ e/ (/ P/ ,/ rbP/ -/ abP/ )/ e/ (/ P/ ,/ υ/ PA/ )/ e/ (/ P/ ,/ abP/ )/ =/ e/ (/ P/ ,/ rHA/ +/ υ/ PA/ )/ =/ e/ (/ P/ ,/ S/ )/ ./ 解/ 签密/ :/ 收到/ 密文/ σ/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ 身份/ uB/ 下/ 的/ 解/ 签密/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ uB/ ≠/ u/ α/ ./ 若/ 是/ ,/ Γ/ 正常/ 运行/ 解/ 签密/ 算法/ ,/ 返回/ 运行/ 结果/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 检索/ 到/ (/ xB/ ,/ PA/ )/ ,/ 并/ 做出/ 如下/ 应答/ ./ (/ 1/ )/ 通过/ L1/ 得到/ HB/ =/ bP/ ,/ 计算/ z/ =/ e/ (/ R/ ,/ HB/ )/ xB/ ./ (/ 2/ )/ 寻找/ 不同/ y/ 值/ 的/ 元组/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ ,/ 使得/ 询问/ (/ Ppub/ ,/ HB/ ,/ R/ ,/ y/ )/ 时/ ODBDH/ 返回/ 1/ ./ 如果/ 这种/ 情况/ 发生/ ,/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ./ (/ 3/ )/ 计算/ m/ =/ DEM/ ./ Dec/ (/ κ/ ,/ c/ )/ ./ (/ 4/ )/ 通过/ 调用/ h3/ 预言/ 机/ 获得/ f/ ,/ 然后/ 检查/ 等式/ e/ (/ P/ ,/ S/ )/ =/ e/ (/ R/ ,/ HA/ )/ e/ (/ PA/ ,/ f/ )/ e/ (/ Ppub/ ,/ HA/ )/ 是否/ 成立/ ?/ 若/ 成立/ ,/ 接受/ m/ ;/ 否则/ ,/ 输出/ ⊥/ ./ 挑战/ ./ 阶段/ 1/ 结束/ 后/ ,/ / I/ 生成/ 两个/ 相同/ 长度/ 的/ 明文/ m0/ ,/ m1/ 以及/ 希望/ 挑战/ 的/ 两个/ 身份/ (/ u/ / A/ ,/ u/ / B/ )/ ,/ 这里/ u/ / A/ 和/ u/ / B/ 分别/ 是/ 发送者/ 和/ 接收者/ 的/ 身份/ ./ 阶段/ 1/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 和/ 部分/ 私钥/ 不能/ 被/ 询问/ ,/ 并且/ u/ / B/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ./ 若/ u/ / B/ ≠/ u/ α/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 找到/ (/ P/ / A/ ,/ x/ / A/ ,/ d/ / A/ ,/ x/ / B/ )/ ,/ 并/ 按/ 下面/ 方式/ 计算/ 挑战/ 密文/ ./ 到/ L2/ ./ (/ 1/ )/ 设置/ R/ / =/ cP/ ,/ 选择/ υ/ / ∈/ RZ/ / (/ 2/ )/ 通过/ L1/ 得到/ H/ / B/ =/ bP/ ,/ 计算/ z/ =/ e/ (/ R/ / ,/ H/ / B/ )/ x/ / (/ 3/ )/ 计算/ κ/ 1/ =/ h2/ (/ y/ / ,/ z/ / ,/ R/ / )/ ,/ 添加/ (/ y/ / ,/ z/ / ,/ R/ / ,/ κ/ 1/ )/ (/ 4/ )/ 选择/ 任意/ 的/ κ/ 0/ ∈/ κ/ PS/ -/ CLHS/ 与/ γ/ ∈/ {/ 0/ ,/ 1/ }/ ./ (/ 5/ )/ 计算/ c/ / =/ DEM/ ./ Dec/ (/ κ/ γ/ ,/ m/ γ/ )/ ./ (/ 6/ )/ 计算/ f/ / =/ υ/ / P/ ,/ 添加/ (/ u/ / A/ ,/ u/ / B/ ,/ m/ γ/ ,/ R/ / ,/ P/ / A/ ,/ Page6P/ / B/ ,/ υ/ / ,/ f/ / )/ 到/ L3/ ./ (/ 7/ )/ 通过/ L1/ 得到/ l/ / A/ ,/ 计算/ S/ / =/ l/ / AcP/ +/ x/ / Af/ / +/ d/ / A/ ./ (/ 8/ )/ 返回/ σ/ / =/ (/ c/ / ,/ / / ←/ (/ R/ / ,/ S/ / )/ )/ ./ 阶段/ 2/ ./ / I/ 像/ 阶段/ 1/ 那样/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ 询问/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 和/ 部分/ 私钥/ 不能/ 被/ 询问/ ,/ u/ / B/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ,/ 并且/ 不能/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ σ/ / 进行/ 解/ 签密/ 询问/ ./ 猜测/ ./ L2/ 中/ 储存/ 了/ q2/ 个/ Hash/ 值/ ,/ Γ/ 从/ L2/ 中/ 随机/ 均匀/ 地/ 选择/ y/ / ,/ 输出/ 作为/ BDH/ 问题/ 实例/ 的/ 解答/ ./ y/ / =/ e/ (/ Ppub/ ,/ H/ / B/ )/ r/ =/ e/ (/ aP/ ,/ bP/ )/ c/ =/ e/ (/ P/ ,/ P/ )/ abc/ 概率分析/ ./ 现在/ 来/ 分析/ Γ/ 得到/ BDH/ 问题/ 实例/ 解答/ e/ (/ P/ ,/ P/ )/ abc/ 的/ 成功/ 概率/ ./ Γ/ 在/ 不/ 放弃/ 游戏/ 的/ 情况/ 下/ 才能/ 解决/ BDH/ 问题/ ,/ 而/ 它/ 放弃/ 游戏/ 是/ 由于/ 下面/ 4/ 个/ 事件/ ./ 事件/ 1/ ./ / I/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 部分/ 私钥/ ,/ 这/ 事件/ 2/ ./ / I/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 秘密/ 值/ ,/ 这个/ 个/ 事件/ 发生/ 的/ 概率/ 为/ qe1/ // q1/ ./ 事件/ 发生/ 的/ 概率/ 为/ qe2/ // q1/ ./ 件/ 发生/ 的/ 概率/ 为/ qr/ // q1/ ./ 是/ 挑战/ 身份/ u/ α/ ,/ 这个/ 事件/ 发生/ 的/ 概率/ 为/ 事件/ 3/ ./ / I/ 替换/ 了/ 挑战/ 身份/ u/ α/ 的/ 公钥/ ,/ 这个/ 事/ 事件/ 4/ ./ / I/ 在/ 挑战/ 阶段/ 所/ 选择/ 的/ 接收者/ 身份/ 不/ 于是/ ,/ Γ/ 不/ 放弃/ 游戏/ 的/ 概率/ 为/ 1/ -/ qe1q/ (/ )/ 11/ -/ qe2q/ (/ )/ 1/ ε/ 1/ -/ qe1q/ (/ )/ 11/ -/ qe2q/ (/ )/ 1/ Γ/ 均匀/ 随机/ 地/ 从/ L2/ 中/ 选择/ y/ / 的/ 概率/ 是/ 1/ // q2/ ./ 因此/ ,/ Γ/ 解决/ BDH/ 问题/ 的/ 优势/ ε/ 为/ 定理/ 2/ ./ 假如/ 存在/ 一个/ IND/ -/ CCA2/ -/ II/ 敌手/ / II/ 经过/ qi/ 次/ hi/ 询问/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 和/ qe2/ 次/ 私钥/ 询问/ 后/ ,/ 能以/ 一个/ 不可/ 忽略/ 的/ 优势/ ε/ 攻破/ PS/ -/ CLHS/ 方案/ 的/ IND/ -/ CCA2/ -/ II/ 安全性/ ,/ 则/ 存在/ 一个/ 算法/ Γ/ 能以/ 优势/ ε/ 解决/ BDH/ 问题/ ,/ 这里/ ε/ 为/ 证明/ ./ 假设/ Γ/ 收到/ 一个/ BDH/ 问题/ 的/ 随机/ 实例/ (/ P/ ,/ aP/ ,/ bP/ ,/ cP/ )/ ∈/ G1/ ,/ 目标/ 是/ 计算/ 出/ e/ (/ P/ ,/ P/ )/ abc/ ∈/ G2/ ./ 为了/ 能够/ 得到/ BDH/ 问题/ 实例/ 的/ 解答/ ,/ Γ/ 扮演/ / II/ 的/ 挑战者/ 并/ 把/ / II/ 作为/ 子程序/ 与/ 之/ 在/ IND/ -/ CCA2/ -/ II/ 中/ 进行/ 交互/ ./ 假设/ 游戏/ 中/ / II/ 询问/ 以/ 身份/ ui/ 作为/ 输入/ 的/ 其它/ 预言/ 机/ 之前/ 都/ 先用/ 身份/ ui/ 询问/ h1/ 预言/ 机/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ ,/ 发送/ 主控/ 密钥/ x/ 和/ 系统/ 参数/ (/ G1/ ,/ G2/ ,/ e/ ,/ P/ ,/ Ppub/ ,/ n/ ,/ h1/ ,/ h2/ ,/ h3/ )/ 给/ / II/ ./ 为了/ 记录/ 相关/ 预言/ 机/ 的/ 询问/ 与/ 应答/ ,/ Γ/ 维护/ 起初/ 为空/ 的/ 4/ 张/ 列表/ L1/ ~/ L3/ 与/ Lk/ ./ 阶段/ 1/ ./ / II/ 自/ 适应/ 地/ 进行/ 多项式/ 有界次/ 询问/ ./ h1/ 询问/ :/ / II/ 选择/ 一系列/ 身份/ 询问/ 相应/ Hash/ 值/ ./ 接收/ 到/ 身份/ ui/ 的/ h1/ 询问/ 时/ ,/ 若/ L1/ 中/ 含有/ (/ ui/ ,/ Hi/ ,/ li/ )/ ,/ Γ/ 返回/ Hi/ ;/ 否则/ ,/ Γ/ 随机/ 选择/ 整数/ α/ ∈/ [/ 1/ ../ q1/ ]/ ,/ 将/ u/ α/ 作为/ 挑战/ 身份/ 但/ 不会/ 泄露/ α/ 的/ 值/ 给/ / II/ ./ 若/ 接收/ 到/ 的/ 是/ 第/ α/ 次/ 询问/ ,/ Γ/ 设置/ Hi/ =/ bP/ ,/ 返回/ Hi/ ,/ 添加/ (/ ui/ ,/ Hi/ ,/ -/ )/ 到/ L1/ ./ 若/ 接收/ 到/ 的/ 不是/ 第/ α/ 次/ 询问/ ,/ 选择/ li/ ∈/ RZ/ / h2/ 询问/ :/ 接收/ 到/ h2/ 询问/ 时/ ,/ Γ/ 检查/ L2/ 中/ 是否/ 含有/ 元组/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ ./ 若有/ ,/ 返回/ 对称/ 密钥/ κ/ ;/ 否则/ ,/ 返回/ 任意/ 的/ κ/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 添加/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ 到/ L2/ ./ h3/ 询问/ :/ 接收/ 到/ h3/ 询问/ 时/ ,/ Γ/ 检查/ L3/ 中/ 是否/ 含有/ 元组/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ f/ )/ ./ 若有/ ,/ 返回/ f/ ;/ 否则/ ,/ Γ/ 选择/ 一个/ 随机数/ υ/ ∈/ Z/ / (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ f/ )/ 到/ L3/ ./ 公钥/ 询问/ :/ / II/ 选择/ 一个/ 身份/ ui/ 并/ 询问/ 这个/ 身份/ 的/ 公钥/ ./ 若/ ui/ =/ u/ α/ ,/ Γ/ 设置/ Pi/ =/ aP/ ,/ 返回/ 公钥/ Pi/ ,/ 添加/ (/ ui/ ,/ -/ ,/ -/ ,/ Pi/ )/ 到/ Lk/ ;/ 否则/ ,/ Γ/ 选择/ xi/ ∈/ RZ/ / Pi/ =/ xiP/ ,/ 添加/ (/ ui/ ,/ -/ ,/ xi/ ,/ Pi/ )/ 到/ Lk/ ,/ 返回/ 公钥/ Pi/ ./ 私钥/ 询问/ :/ 接收/ 到/ 身份/ ui/ 的/ 私钥/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ ui/ =/ u/ α/ ./ 若/ 相等/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 从/ L1/ // Lk/ 找到/ li/ // (/ ui/ ,/ -/ ,/ xi/ ,/ Pi/ )/ ,/ 返回/ 秘密/ 值/ xi/ ,/ 以/ (/ ui/ ,/ xliP/ ,/ xi/ ,/ Pi/ )/ 更新/ Lk/ ./ / II/ 知道/ 主/ 密钥/ x/ ,/ 自己/ 能/ 计算/ 出/ 用户/ 的/ 部分/ 私钥/ ./ 签密/ :/ 收到/ 消息/ m/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ 身份/ uB/ 下/ 的/ 签密/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ uA/ ≠/ u/ α/ ./ 若/ 是/ ,/ Γ/ 正常/ 执行/ 签密/ 算法/ ,/ 返回/ 运行/ 结果/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 检索/ 到/ (/ xB/ ,/ dB/ ,/ PA/ )/ ,/ 接着/ 按/ 下面/ 方式/ 生成/ 密文/ ./ (/ 1/ )/ 选择/ r/ ,/ υ/ ∈/ RZ/ / (/ 2/ )/ 计算/ y/ =/ e/ (/ R/ ,/ dB/ )/ ./ (/ 3/ )/ 通过/ L1/ 检索/ 到/ lB/ ,/ 计算/ z/ =/ e/ (/ R/ ,/ lBP/ )/ xB/ ./ (/ 4/ )/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ,/ 添加/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ 到/ L2/ ./ (/ 5/ )/ 计算/ c/ =/ DEM/ ./ Enc/ (/ κ/ ,/ m/ )/ ./ (/ 6/ )/ 计算/ f/ =/ υ/ P/ ,/ 添加/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ (/ 7/ )/ 通过/ 调用/ h1/ 预言/ 机/ 得到/ HA/ =/ bP/ ,/ 计算/ S/ =/ 到/ L3/ ./ Page7rHA/ +/ υ/ PA/ +/ xHA/ ./ (/ 8/ )/ 返回/ σ/ =/ (/ c/ ,/ / ←/ (/ R/ ,/ S/ )/ )/ ./ 正确性/ :/ 解/ 签密/ :/ 收到/ 密文/ σ/ 在/ 发送者/ 身份/ uA/ 和/ 接收者/ uB/ 下/ 的/ 解/ 签密/ 询问/ 时/ ,/ Γ/ 检查/ 是否/ uB/ ≠/ u/ α/ ./ 如果/ 是/ ,/ Γ/ 正常/ 运行/ 解/ 签密/ 算法/ ,/ 返回/ 运行/ 结果/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 检索/ 到/ (/ PB/ ,/ PA/ )/ ,/ 按/ 下面/ 方式/ 做出/ 响应/ ./ (/ 1/ )/ 通过/ Lk/ 调用/ h1/ 预言/ 机/ 得到/ HB/ =/ bP/ ,/ 计算/ y/ =/ e/ (/ R/ ,/ bP/ )/ x/ ./ (/ 2/ )/ 寻找/ 不同/ z/ 值/ 的/ 元组/ (/ y/ ,/ z/ ,/ R/ ,/ κ/ )/ ,/ 使得/ 询问/ (/ PB/ ,/ HB/ ,/ R/ ,/ z/ )/ 时/ ODBDH/ 返回/ 1/ ./ 如果/ 存在/ 这样/ 一个/ 元组/ ,/ 计算/ κ/ =/ h2/ (/ y/ ,/ z/ ,/ R/ )/ ./ (/ 3/ )/ 计算/ m/ =/ DEM/ ./ Dec/ (/ κ/ ,/ c/ )/ ./ (/ 4/ )/ 通过/ h3/ 预言/ 机/ 得到/ f/ ,/ 然后/ 检查/ 等式/ e/ (/ P/ ,/ S/ )/ =/ e/ (/ R/ ,/ HA/ )/ e/ (/ PA/ ,/ f/ )/ e/ (/ Ppub/ ,/ HA/ )/ 是否/ 成立/ ?/ 若/ 成立/ ,/ 接受/ m/ ;/ 否则/ ,/ 输出/ ⊥/ ./ 挑战/ ./ 阶段/ 1/ 结束/ 后/ ,/ / II/ 生成/ 两个/ 相同/ 长度/ 的/ 明文/ m0/ ,/ m1/ 以及/ 希望/ 挑战/ 的/ 两个/ 身份/ (/ u/ / A/ ,/ u/ / B/ )/ ,/ 这里/ u/ / A/ 和/ u/ / B/ 分别/ 是/ 发送者/ 和/ 接收者/ 的/ 身份/ ./ 阶段/ 1/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 不能/ 被/ 询问/ ./ 如果/ u/ / B/ ≠/ u/ α/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 从/ Lk/ 检索/ 到/ (/ x/ / A/ ,/ d/ / A/ )/ ,/ 并/ 按/ 下面/ 方式/ 计算/ 挑战/ 密文/ ./ κ/ 1/ )/ 到/ L2/ ./ υ/ / ,/ f/ / )/ 到/ L3/ ./ (/ 1/ )/ 设置/ R/ / =/ cP/ ,/ 随机/ 选择/ υ/ / ∈/ Z/ / (/ 2/ )/ 通过/ L1/ 得到/ H/ / B/ =/ bP/ ,/ 计算/ y/ / =/ e/ (/ R/ / ,/ H/ / B/ )/ x/ ./ (/ 3/ )/ 计算/ κ/ 1/ =/ h2/ (/ y/ / ,/ z/ / ,/ R/ / )/ ,/ 添加/ (/ y/ / ,/ z/ / ,/ R/ / ,/ (/ 4/ )/ 选择/ 任意/ 的/ κ/ 0/ ∈/ κ/ PS/ -/ CLHS/ 与/ γ/ ∈/ {/ 0/ ,/ 1/ }/ ./ (/ 5/ )/ 计算/ c/ / =/ DEM/ ./ Enc/ (/ κ/ γ/ ,/ m/ γ/ )/ ./ (/ 6/ )/ 计算/ f/ / =/ υ/ / P/ ,/ 添加/ (/ u/ / A/ ,/ u/ / B/ ,/ m/ γ/ ,/ R/ / ,/ P/ / A/ ,/ P/ / B/ ,/ (/ 7/ )/ 通过/ L1/ 得到/ l/ / A/ ,/ 计算/ S/ / =/ l/ / AcP/ +/ x/ / Af/ / +/ d/ / A/ ./ (/ 8/ )/ 计算/ S/ / =/ l/ / AcP/ +/ υ/ x/ / AP/ +/ d/ / A/ ./ (/ 9/ )/ 返回/ σ/ / =/ (/ c/ / ,/ / / ←/ (/ R/ / ,/ S/ / )/ )/ ./ 阶段/ 2/ ./ / II/ 像/ 阶段/ 1/ 那样/ 进行/ 多项式/ 有界次/ 适应性/ 询问/ ./ 询问/ 期间/ ,/ u/ / B/ 的/ 秘密/ 值/ 不能/ 被/ 询问/ ,/ 并且/ 不能/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ σ/ / 进行/ 解/ 签密/ 询问/ ./ 机/ 均匀/ 地/ 选择/ z/ / ,/ 输出/ 猜测/ ./ L2/ 中/ 储存/ 了/ q2/ 个/ Hash/ 值/ ,/ Γ/ 从/ L2/ 中随/ z/ / =/ e/ (/ P/ / B/ ,/ H/ / B/ )/ r/ =/ e/ (/ aP/ ,/ bP/ )/ c/ =/ e/ (/ P/ ,/ P/ )/ abc/ 作为/ BDH/ 问题/ 实例/ 的/ 解答/ ./ 概率分析/ ./ 现在/ 来/ 分析/ Γ/ 得到/ BDH/ 问题/ 实例/ 解答/ e/ (/ P/ ,/ P/ )/ abc/ 的/ 成功/ 概率/ ./ Γ/ 在/ 不/ 放弃/ 游戏/ 的/ 情况/ 下/ 才能/ 得到/ DBH/ 问题/ 实例/ 的/ 解答/ ,/ 而/ 放弃/ 游戏/ 是/ 由于/ 下面/ 两个/ 事件/ ./ 事件/ 1/ ./ / II/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 秘密/ 值/ ,/ 这个/ 事件/ 发生/ 的/ 概率/ 为/ qe2/ // q1/ ./ 是/ 挑战/ 身份/ u/ α/ ,/ 这个/ 事件/ 发生/ 的/ 概率/ 为/ 事件/ 2/ ./ 挑战/ 阶段/ ,/ / II/ 所/ 选择/ 的/ 接收者/ 身份/ 不/ 于是/ ,/ Γ/ 不/ 放弃/ 游戏/ 的/ 概率/ 为/ 1/ -/ qe2q/ (/ )/ 1/ Γ/ 随机/ 均匀/ 地/ 从/ 列表/ L2/ 中/ 选择/ z/ / 的/ 概率/ 是/ 1/ // q2/ ./ 因此/ ,/ Γ/ 解决/ BDH/ 问题/ 的/ 概率/ 为/ 定理/ 3/ ./ 假如/ 存在/ 一个/ sUF/ -/ CMA/ -/ I/ 伪造者/ / I/ 经过/ qi/ 次/ hi/ 询问/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 、/ qe1/ 次/ 部分/ 私钥/ 询问/ 、/ qe2/ 次/ 私钥/ 询问/ 和/ qr/ 次公钥/ 替换/ 询问/ 后/ ,/ 能以/ 不可/ 忽略/ 的/ 优势/ ε/ 伪造/ PS/ -/ CLHS/ 方案/ 的/ 一个/ 密文/ ,/ 则/ 存在/ 一个/ 算法/ Γ/ 能以/ 优势/ ε/ 解决/ CDH/ 问题/ ,/ 这里/ ε/ 为/ 2/ (/ )/ k1/ -/ qe1q/ (/ )/ 11/ -/ qe2q/ (/ )/ 1/ ε/ -/ 1/ 证明/ ./ 假设/ Γ/ 收到/ 一个/ CDH/ 问题/ 的/ 随机/ 实例/ (/ P/ ,/ aP/ ,/ bP/ )/ ∈/ G1/ ,/ 目的/ 是/ 计算/ abP/ ∈/ G1/ ./ 为了/ 得到/ CDH/ 问题/ 实例/ 的/ 解答/ ,/ Γ/ 扮演/ / I/ 的/ 挑战者/ 并/ 将/ 它/ 作为/ 子程序/ 与/ 之/ 在/ sUF/ -/ CMA/ -/ I/ 中/ 进行/ 交互/ ./ 假设/ 游戏/ 中/ / I/ 询问/ 以/ 身份/ ui/ 作为/ 输入/ 的/ 其它/ 预言/ 机/ 之前/ 都/ 先用/ 身份/ ui/ 询问/ h1/ 预言/ 机/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ ,/ 将/ 系统/ 参数/ (/ G1/ ,/ G2/ ,/ e/ ,/ P/ ,/ Ppub/ =/ aP/ ,/ n/ ,/ h1/ ,/ h2/ ,/ h3/ )/ 发送给/ / I/ ./ 为了/ 保证/ 对/ 各个/ 预言/ 机/ 询问/ 的/ 连续/ 应答/ ,/ Γ/ 维护/ 起初/ 为空/ 的/ 4/ 张/ 列表/ L1/ ~/ L3/ 与/ Lk/ ./ 训练/ ./ / I/ 进行/ 适应性/ 多项式/ 有界次/ 询问/ ./ 进行/ 的/ 询问/ 与/ IND/ -/ CCA2/ -/ I/ 中/ 的/ 阶段/ 1/ 相同/ ./ 伪造/ ./ 训练/ 结束/ 的/ 时候/ ,/ / I/ 输出/ 一个/ 伪造/ (/ σ/ / ,/ u/ / A/ ,/ u/ / B/ )/ ,/ 这里/ R/ / =/ Ppub/ ./ 训练/ 期间/ ,/ u/ / A/ 的/ 完整/ 私钥/ 不能/ 被/ 询问/ ,/ u/ / A/ 不能/ 是/ 公钥/ 已/ 被/ 替换/ 的/ 那个/ 身份/ ,/ 并且/ σ/ / 不能/ 是/ 来自/ 伪造者/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ 某个/ 消息/ m/ / 的/ 签密/ 询问/ 的/ 应答/ ./ 若/ u/ / A/ ≠/ u/ α/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 通过/ Lk/ 得到/ P/ / A/ ,/ 调用/ h1/ 预言/ 机和/ h3/ 预言/ 机得/ Page8/ 到/ H/ / A/ =/ bP/ 和/ υ/ / ,/ 输出/ abP/ =/ (/ S/ / -/ υ/ / P/ / A/ )/ // 2/ 作为/ CDH/ 问题/ 实例/ 的/ 解答/ ./ 原因/ 如下/ :/ e/ (/ P/ ,/ S/ / )/ =/ e/ (/ R/ / ,/ H/ / A/ )/ e/ (/ P/ / A/ ,/ f/ / )/ e/ (/ Ppub/ ,/ H/ / A/ )/ 概率分析/ ./ 现在/ 我们/ 来/ 评估/ Γ/ 解决/ CDH/ 问题/ 的/ 成功/ 概率/ ./ 参考/ 定理/ 1/ ,/ 可/ 得/ :/ (/ 1/ )/ / I/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 部分/ 私钥/ 的/ 概率/ 为/ qe1/ // q1/ ;/ (/ 2/ )/ / I/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 秘密/ 值/ 的/ 概率/ 为/ qe2/ // q1/ ;/ (/ 3/ )/ / I/ 替换/ 了/ 挑战/ 身份/ u/ α/ 的/ 公钥/ ,/ 这个/ 事件/ 发生/ 的/ 概率/ 为/ qr/ // q1/ ;/ (/ 4/ )/ / I/ 在/ 训练/ 阶段/ 所/ 选择/ 的/ 接收者/ 身份/ 不是/ 挑战/ 身份/ u/ α/ 的/ 概率/ 为/ 于是/ ,/ Γ/ 不/ 放弃/ 游戏/ 的/ 概率/ 为/ 1/ -/ qe1q/ (/ )/ 11/ -/ qe2q/ (/ )/ 11/ // 2k/ ./ 因此/ ,/ Γ/ 解决/ CDH/ 问题/ 的/ 概率/ 是/ 2/ (/ )/ k1/ -/ qe1q/ (/ )/ 11/ -/ qe2q/ (/ )/ 1/ ε/ -/ 1/ / I/ 猜测/ 相关/ h3/ 预言/ 机/ 的/ 相应/ Hash/ 值/ 的/ 概率/ 是/ 定理/ 4/ ./ 如果/ 存在/ 一个/ sUF/ -/ CMA/ -/ II/ 伪造者/ / II/ 经过/ qi/ 次/ hi/ 询问/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 以及/ qe2/ 次/ 私钥/ 提取/ 询问/ 后/ ,/ 能以/ 一个/ 不可/ 忽略/ 的/ 优势/ ε/ 伪造/ PS/ -/ CLHS/ 方案/ 的/ 一个/ 密文/ ,/ 则/ 存在/ 一个/ 算法/ Γ/ 能以/ 概率/ ε/ 解决/ CDH/ 问题/ ,/ 这里/ ε/ 为/ 证明/ ./ 假设/ Γ/ 收到/ 一个/ CDH/ 问题/ 的/ 随机/ 实例/ (/ P/ ,/ aP/ ,/ bP/ )/ ∈/ G1/ ,/ 其/ 目标/ 是/ 得到/ CDH/ 问题/ 实例/ 的/ 解答/ abP/ ∈/ G1/ ./ 为此/ ,/ Γ/ 将/ / II/ 作为/ 子程序/ 并/ 扮演/ 其/ 挑战者/ 在/ sUF/ -/ CMA/ -/ II/ 中/ 与/ 之/ 进行/ 交互/ ./ 假设/ 在/ 游戏/ 中/ / II/ 询问/ 以/ 身份/ ui/ 作为/ 输入/ 的/ 其它/ 预言/ 机/ 之前/ 都/ 先用/ 身份/ ui/ 询问/ h1/ 预言/ 机/ ./ 初始化/ ./ Γ/ 运行/ 系统/ 初始化/ 算法/ ,/ 将/ 系统/ 参数/ (/ G1/ ,/ G2/ ,/ e/ ,/ P/ ,/ Ppub/ ,/ n/ ,/ h1/ ,/ h2/ ,/ h3/ )/ 和/ 主控/ 钥/ x/ 发送给/ / II/ ./ 为了/ 避免/ 对/ 各个/ 预言/ 机/ 询问/ 的/ 非/ 连续/ 应答/ ,/ Γ/ 维护/ 起初/ 为空/ 的/ 4/ 张/ 列表/ L1/ ~/ L3/ 与/ Lk/ ./ 训练/ ./ / II/ 在/ 这个/ 阶段/ 进行/ 适应性/ 多项式/ 有界次/ 询问/ ./ 除了/ h1/ 询问/ 和/ h3/ 询问/ 之外/ ,/ 其余/ 询问/ 与/ IND/ -/ CCA2/ -/ II/ 的/ 阶段/ 1/ 相同/ ./ h1/ 询问/ :/ 收到/ 身份/ ui/ 的/ h1/ 询问/ 时/ ,/ Γ/ 检查/ L1/ 中/ 是否/ 存有/ (/ ui/ ,/ Hi/ ,/ li/ )/ ./ 若有/ ,/ Γ/ 返回/ Hi/ ;/ 否则/ ,/ Γ/ 选择/ q/ ,/ 返回/ Hi/ ←/ liP/ ,/ 以/ (/ ui/ ,/ Hi/ ,/ li/ )/ 更新/ L1/ ./ li/ ∈/ RZ/ / h3/ 询问/ :/ 接收/ 到/ h3/ 询问/ 时/ ,/ Γ/ 检查/ L3/ 中/ 是否/ 含有/ 元组/ (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ ./ 若有/ ,/ 返回/ f/ ;/ 否则/ ,/ Γ/ 选择/ 一个/ 随机数/ υ/ ∈/ Z/ / (/ uA/ ,/ uB/ ,/ m/ ,/ R/ ,/ PA/ ,/ PB/ ,/ υ/ ,/ f/ )/ 到/ L3/ ./ 伪造/ ./ 训练/ 结束/ 的/ 时候/ ,/ / II/ 输出/ 一个/ 伪造/ (/ σ/ / ,/ u/ / A/ ,/ u/ / B/ )/ ./ 训练/ 期间/ ,/ u/ / A/ 的/ 秘密/ 值/ 不能/ 被/ 询问/ ,/ 并且/ σ/ / 不能/ 是/ 来自/ 伪造者/ 对/ u/ / A/ 和/ u/ / B/ 下/ 的/ 某个/ 消息/ m/ / 的/ 签密/ 询问/ 的/ 应答/ ./ 若/ u/ / A/ ≠/ u/ α/ ,/ Γ/ 放弃/ 游戏/ ;/ 否则/ ,/ Γ/ 调用/ h1/ 预言/ 机和/ h3/ 预言/ 机/ 得到/ l/ / A/ 和/ υ/ / ,/ 通过/ Lk/ 获得/ d/ / A/ ,/ 输出/ abP/ =/ (/ S/ / -/ l/ / AR/ / -/ d/ / A/ )/ // υ/ / 作为/ CDH/ 问题/ 实例/ 的/ 解答/ ./ 原因/ 如下/ :/ e/ (/ P/ ,/ S/ / )/ =/ e/ (/ R/ / ,/ H/ / A/ )/ e/ (/ P/ / A/ ,/ f/ / )/ e/ (/ Ppub/ ,/ H/ / A/ )/ 概率分析/ ./ 现在/ 我们/ 来/ 评估/ Γ/ 得到/ CDH/ 问题/ 实例/ 解答/ 的/ 成功/ 概率/ ./ 参考/ 定理/ 2/ ,/ 可/ 得/ :/ (/ 1/ )/ / II/ 询问/ 了/ 挑战/ 身份/ u/ α/ 的/ 秘密/ 值/ 的/ 概率/ 是/ qe2/ // q1/ ;/ (/ 2/ )/ / II/ 在/ 训练/ 阶段/ 所/ 选择/ 的/ 接收者/ 身份/ 不是/ 挑战/ 身份/ u/ α/ 的/ 概率/ 是/ 于是/ ,/ Γ/ 不/ 放弃/ 游戏/ 的/ 概率/ 为/ / II/ 猜测/ 相关/ h3/ 预言/ 机/ 的/ 相应/ Hash/ 值/ 的/ 概率/ 是/ 1/ // 2k/ ./ 因此/ ,/ Γ/ 解决/ CDH/ 问题/ 的/ 概率/ 是/ 5/ 效率/ 分析/ 本/ 节/ 通过/ 计算/ 开销/ 和/ 通信/ 开销/ 对/ PS/ -/ CLHS/ 方案/ 和/ 同类/ 方案/ [/ 15/ -/ 16/ ]/ 的/ 计算/ 复杂性/ 进行/ 比较/ ./ 比较/ 中/ 主要/ 考虑/ 3/ 种/ 运算/ :/ G2/ 上/ 的/ 双线性/ 对/ 运算/ x1/ 、/ G1/ 上/ 的/ 点/ 乘/ 运算/ x2/ 以及/ G1/ 上/ 的/ 指数/ 运算/ x3/ ./ |/ r/ |/ 表示/ 有/ q/ 中/ 一个/ 元素/ 的/ 长度/ ,/ |/ G1/ |/ 表示/ G1/ 上/ 一个/ 元限域/ z/ / 素/ 的/ 长度/ ,/ 密文/ 长度/ 表示/ 通信/ 开销/ ./ 表/ 1/ 中/ 没有/ 考虑/ 双线性/ 对预/ 运算/ ./ 方案/ 文献/ [/ 15/ ]/ 方案/ 040110n/ +/ 2/ |/ G1/ |/ 文献/ [/ 16/ ]/ 方案/ 110110n/ +/ |/ r/ |/ +/ |/ G1/ |/ PS/ -/ CLHS030100n/ +/ 2/ |/ G1/ |/ Page9/ 相对/ 于点/ 乘/ 运算/ 来说/ ,/ 对/ 运算/ 和/ 指数/ 运算/ 比较/ 耗时/ [/ 17/ ]/ ./ 从表/ 1/ 可以/ 看出/ ,/ 除了/ 密文/ 长度/ 与/ 同类/ 方案/ 大致/ 得当/ 外/ ,/ PS/ -/ CLHS/ 方案/ 在/ 签密/ 阶段/ 执行/ 了/ 3/ 次/ G1/ 上/ 的/ 标量/ 乘/ 操作/ ,/ 在/ 解/ 签密/ 阶段/ 执行/ 了/ 1/ 次/ G2/ 上/ 的/ 对/ 操作/ ./ 总体/ 来说/ ,/ PS/ -/ CLHS/ 方案/ 具有/ 较/ 低/ 的/ 计算/ 复杂性/ ./ 6/ 结语/ 本文/ 给出/ 了/ 一个/ 可/ 证明/ 安全/ 的/ 无/ 证书/ 混合/ 签密/ 方案/ ./ 在/ 随机/ 预言/ 模型/ 下/ 以及/ BDH/ 问题/ 和/ CDH/ 问题/ 的/ 困难性/ 假设/ 下/ ,/ 我们/ 证明/ 该/ 方案/ 是/ IND/ -/ CCA2/ 安全/ 的/ 和/ sUF/ -/ CMA/ 安全/ 的/ ./ 所提/ 方案/ 计算/ 效率高/ 、/ 通信/ 成本低/ ,/ 适合/ 应用/ 于/ 电子/ 支付/ 、/ 移动/ 通信/ 、/ 密钥/ 管理/ 、/ EDI/ 、/ 防火墙/ 、/ 电子商务/ 等/ 领域/ ./ 

