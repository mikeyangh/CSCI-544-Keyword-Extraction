Page1/ 带/ 认证/ 邮局/ 协议/ 的/ 密钥/ 恢复/ 攻击/ 刘凡保/ 1/ )/ 谢涛/ 1/ )/ 冯登国/ 2/ )/ 1/ )/ (/ 国防科学技术大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 2/ )/ (/ 中国科学院/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 作者/ 提出/ 了/ 一种/ 新/ 的/ 针对/ 带/ 认证/ 邮局/ 协议/ 的/ 密钥/ 恢复/ 攻击/ ,/ 能够/ 更快/ 地/ 恢复/ 出/ 密钥/ 并/ 能够/ 恢复/ 更/ 多/ 的/ 密钥/ 字符/ ./ 基于/ 通道/ 技术/ 和/ 高级/ 消息/ 修改/ 技术/ ,/ 提出/ 了/ 一种/ “/ 群/ 满足/ 方案/ ”/ 来/ 确定性/ 地/ 满足/ 分而治之/ 策略/ 下/ 最后/ 一个/ 通道/ 首/ 三步/ 的/ 所有/ 充分条件/ ,/ 籍/ 此/ 提高/ MD5/ (/ MessageDigestAlgorithm5/ )/ 碰撞/ 对/ 搜索/ 的/ 效率/ ./ 并/ 提出/ 了/ 一些/ 新/ 的/ 通道/ 来/ 控制/ MD5/ 碰撞/ 对/ 消息/ 的/ 更/ 多/ 比特/ 的/ 取值/ ,/ 比如/ 可以/ 构造/ 出/ 352/ 比特/ 值/ 确定/ 的/ MD5/ 碰撞/ 对/ ./ 通过/ 这些/ 技术/ 改进/ 了/ 多位/ 信息/ 确定/ 的/ MD5/ 碰撞/ 对/ 搜索/ 效率/ ,/ 应用/ 到/ APOP/ 的/ 密钥/ 恢复/ 攻击/ 中/ 不仅/ 能够/ 快速/ 恢复/ 长达/ 31/ 个字符/ 的/ 密钥/ ,/ 而且/ 能够/ 在/ 实际/ 时间/ 内/ 恢复/ 长达/ 43/ 个字符/ 的/ 密钥/ ./ 关键词/ 带/ 认证/ 邮局/ 协议/ ;/ 挑战/ 和/ 响应/ ;/ 密钥/ 恢复/ ;/ 通道/ ;/ 群/ 满足/ 方案/ 1/ 引言/ 带/ 认证/ 邮局/ 协议/ (/ AuthenticationPostOfficePage2/ 括/ 两方/ 参与者/ ,/ 即/ 认证/ 服务器/ (/ 认证/ 者/ )/ 和/ 用户/ (/ 被/ 认证/ 者/ )/ ./ 持有/ 和/ 存储/ 电子邮件/ 的/ 认证/ 服务器/ 向/ 要/ 访问/ 其/ 邮件/ 的/ 用户/ 发送/ 一个/ 满足/ 一定/ 限制/ 且/ 随机/ 和/ 唯一/ 的/ 挑战/ 数据/ C/ ./ 之后/ ,/ 用户/ 使用/ 散列/ 函数/ MD5/ 对/ 收到/ 的/ 挑战/ C/ 和/ 持有/ 的/ 共享/ 密钥/ P/ 进行/ 散列/ 计算/ ,/ 并/ 将/ 计算/ 的/ 散列值/ R/ 发送至/ 认证/ 服务器/ ./ 最后/ ,/ 基于/ 共享/ 密钥/ P/ ,/ 认证/ 服务器/ 重做/ 与/ 用户/ 一致/ 的/ 散列/ 计算/ 并/ 将/ 结果/ R/ 与/ 接收/ 到/ 的/ 散列值/ R/ 比较/ ,/ 若二值/ 相同/ ,/ 则/ 认证/ 成功/ ./ 否则/ ,/ 认证/ 失败/ ,/ 中止/ 连接/ ./ 1.1/ 以往/ 的/ 工作/ 1996/ 年/ ,/ 基于/ 散列/ 碰撞/ 的/ 分而治之/ 策略/ ,/ Preneel/ 和/ vanOorschot/ [/ 2/ ]/ 描述/ 了/ 如何/ 恢复/ 基于/ 秘密/ 信封/ 方案/ MAC/ 的/ 密钥/ ./ 他们/ 使用/ 生日/ 攻击/ 方法/ 获得/ 碰撞/ 对/ ,/ 对于/ 广泛/ 使用/ 的/ 散列/ 函数/ 如/ MD5/ [/ 3/ ]/ 和/ SHA/ -/ 1/ [/ 4/ ]/ 等/ ,/ 该/ 方法/ 在/ 现有/ 条件/ 下/ 是/ 计算/ 不/ 可行/ 的/ ./ 然而/ ,/ 当/ 一些/ 流行/ 散列/ 函数/ 的/ 弱/ 碰撞/ 安全/ 被/ 攻击/ 和/ 破坏/ [/ 5/ -/ 8/ ]/ 且/ 相应/ 碰撞/ 对/ 搜索/ 的/ 效率/ 也/ 极大/ 提高/ 后/ [/ 9/ ]/ ,/ 一系列/ 针对/ APOP/ 协议/ 的/ 密钥/ 恢复/ 攻击/ 被/ 陆续/ 提出/ [/ 10/ -/ 13/ ]/ ,/ 且/ 所有/ 的/ 攻击/ 都/ 是/ 基于/ 选择/ 挑战/ 的/ ./ 在/ 我们/ 的/ 工作/ 之前/ ,/ 已知/ APOP/ 攻击/ 的/ 最好/ 结果/ [/ 12/ ]/ 是/ 利用/ denBoer/ 和/ Bosselaers/ [/ 14/ ]/ 提出/ 的/ 一种/ 伪/ 碰撞/ —/ —/ —/ dBB/ 碰撞/ ,/ 利用/ 该/ 碰撞/ 可以/ 得到/ 更/ 多/ 的/ 自由/ 消息/ 位/ 和/ 恢复/ 出/ 更/ 多/ 的/ 密钥/ 字/ ./ 例如/ ,/ 用来/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 前/ 11/ 个字符/ 的/ MD5/ 碰撞/ 对/ 可以/ 在/ 不到/ 1s/ 的/ 时间/ 内/ 生成/ ,/ 用来/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 前/ 31/ 个字符/ 的/ MD5/ 碰撞/ 对/ 也/ 可以/ 在/ 实际/ 时间/ 内/ 生成/ [/ 12/ ]/ ./ 然而/ ,/ 这种/ 方法/ 的/ 缺陷/ 在于/ :/ 为了/ 利用/ dBB/ 碰撞/ 必须/ 以/ 242/ 次/ MD5/ 散列/ 计算/ 的/ 复杂度/ 首先/ 生成/ 一个/ 额外/ 的/ “/ IV/ 桥/ ”/ ./ 在/ 文献/ [/ 13/ ]/ 中/ ,/ 提出/ 了/ “/ 比特/ 自由/ 碰撞/ 对/ ”/ 的/ 概念/ ,/ 即/ 一对/ 部分/ 比特/ 值/ 固定/ 的/ 消息/ 总会/ 碰撞/ 而/ 无论/ 其未/ 固定/ 比特/ 如何/ 取值/ ,/ 利用/ “/ 比特/ 自由/ 碰撞/ 对/ ”/ 可以/ 降低/ APOP/ 攻击/ 所/ 需/ 的/ 挑战/ 数目/ ./ 用来/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 前/ 11/ 个字符/ 的/ 1/ 比特/ 自由/ 碰撞/ 对/ 可以/ 经/ 246/ 次/ MD5/ 散列/ 后/ 生成/ ,/ 可以/ 减少/ 所/ 需/ 发送/ 挑战/ 数/ 的/ 一半/ ./ 1.2/ 我们/ 的/ 工作/ 我们/ 提出/ 两个/ 新/ 的/ 通道/ q1/ 和/ q1/ 分别/ 生成/ 具有/ 320/ 位/ 和/ 352/ 位/ 信息/ 确定/ 的/ MD5/ 碰撞/ 对/ ./ 基于/ 通道/ 技术/ (/ tunnel/ )/ 和/ 高级/ 消息/ 修改/ 技术/ ,/ 我们/ 提出/ 一种/ 群/ 满足/ 方案/ —/ —/ —/ 同时/ 确定性/ 地/ 满足/ 最后/ 一个/ 通道/ 首/ 三步/ 的/ 所有/ 充分条件/ ,/ 进一步/ 改进/ 了/ MD5/ 碰撞/ 对/ 搜索/ 的/ 效率/ ./ 结合/ 分而治之/ 和/ 群/ 满足/ 方案/ 降低/ 具有/ 多位/ 信息/ 确定/ 的/ MD5/ 碰撞/ 对/ 搜索/ 的/ 复杂度/ ./ 在/ 普通/ 的/ 个人/ PC机/ 上/ ,/ 生成/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 前/ 11/ 个字符/ 的/ MD5/ 碰撞/ 对/ 的/ 平均/ 时间/ 为/ 0.08/ s/ ,/ 生成/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 前/ 31/ 个字符/ 的/ MD5/ 碰撞/ 对/ 的/ 平均/ 时间/ 为/ 0.15/ s/ ,/ 前/ 39/ 个字符/ 的/ 碰撞/ 对/ 的/ 所/ 需/ 平均/ 时间/ 为/ 4.13/ s/ ./ 此外/ ,/ 应用/ 这些/ 技术/ 还/ 可以/ 降低/ 搜索/ 1/ 比特/ 自由/ 碰撞/ 对/ 的/ 复杂度/ ./ 另外/ 我们/ 提出/ 一种/ 在/ 本地/ PC/ 上/ 恢复/ APOP/ 所/ 使用/ 密钥/ 的/ 快速/ 密钥/ 恢复/ 攻击/ ./ 我们/ 能够/ 在/ 不到/ 1min/ 的/ 时间/ 内/ 恢复/ 出长/ 达/ 11/ 个字符/ 的/ 密钥/ 内容/ ,/ 在/ 4min/ 左右/ 能够/ 恢复/ 出长/ 达/ 31/ 个字符/ 的/ 密钥/ 内容/ ,/ 而长/ 达/ 43/ 个字符/ 的/ 密钥/ 也/ 能够/ 在/ 实际/ 可/ 达/ 时间/ 内/ 破解/ ./ 该/ 攻击/ 模拟/ 了/ 一种/ 可能/ 由/ 恶意软件/ 发起/ 的/ 攻击/ ,/ 进一步/ 论证/ 了/ APOP/ 的/ 安全性/ 已经/ 完全/ 破坏/ ,/ 因而/ 基于/ MD5/ 的/ 网络应用/ 程序/ 的/ 安全性/ 需要/ 进一步/ 地/ 评估/ [/ 15/ -/ 16/ ]/ ./ 本文/ 第/ 2/ 节/ 简要/ 介绍/ APOP/ 协议/ 及/ 相关/ 概念/ ;/ 第/ 3/ 节对/ 一些/ 相关/ 工作/ 进行/ 比较/ ;/ 第/ 4/ 节/ 详细/ 介绍/ 具有/ 多位/ 信息/ 确定/ 的/ MD5/ 碰撞/ 对/ 搜索/ ;/ 第/ 5/ 节/ 模拟/ 一个/ APOP/ 密钥/ 恢复/ 攻击/ ;/ 在/ 第/ 6/ 节对/ 本文/ 进行/ 总结/ ./ 2/ 基础知识/ 2.1/ MD5/ 算法/ 描述/ MD5/ [/ 3/ ]/ 是/ 一种/ 典型/ 的/ 基于/ MD/ 结构/ (/ Merkle/ -/ DamgrdStructure/ )/ 的/ 迭代/ 散列/ 函数/ ./ 其/ 接收/ 可变/ 长度/ 的/ 消息/ M/ (/ 输入/ 消息/ M/ 的/ 长度/ 一般/ 为/ 1/ / |/ M/ |/ / 264/ -/ 1bit/ )/ 作为/ 输入/ 且/ 输出/ 固定/ 长度/ 为/ 128bit/ 的/ 散列值/ MD5/ (/ M/ )/ ./ 2.1/ ./ 1/ 预处理/ 在/ 对/ 输入/ 消息/ M/ 进行/ 散列前/ 需要/ 对/ 其/ 进行/ 预处理/ ,/ 分为/ 如下/ 3/ 个/ 阶段/ :/ (/ 1/ )/ 消息/ M/ 首先/ 被/ 填充/ 至/ 分组/ 块/ 512bit/ 的/ 倍数/ ,/ 其中/ M/ 附加/ 一个/ 1/ 和/ 若干个/ 0/ 至/ 448mod512/ ,/ 最后/ 附加/ 64bit/ 的/ M/ 的/ 长度/ 信息/ ./ (/ 2/ )/ 填充/ 后/ 的/ 消息/ M/ 被/ 分成/ 若干个/ 512bit/ 的/ 分组/ 块/ (/ M0/ ,/ M1/ ,/ …/ ,/ M/ (/ |/ M/ |/ // 512/ -/ 1/ )/ )/ ./ (/ 3/ )/ 每个/ 512/ 位/ 的/ 分组/ 块/ Mi/ 被/ 分割/ 为/ 16/ 个/ 32/ 比特/ 字/ (/ m0/ ,/ m1/ ,/ …/ ,/ m15/ )/ ./ 2.1/ ./ 2MD5/ 压缩/ 函数/ 每个/ 分组/ 块/ 依次/ 被/ MD5/ 的/ 压缩/ 函数/ CF/ 处理/ ,/ 压缩/ 函数/ CF/ 接收/ 512bit/ 的/ Mi/ 和/ 128bit/ 的/ 链接/ 变量/ Hi/ 作为/ 其/ 输入/ 并/ 输出/ 128bit/ 的/ Hi/ +/ 1/ ./ 初始/ 链接/ 变量/ H0/ 设置/ 为/ 固定/ 常数/ a0/ =/ 0x67452301/ ,/ b0/ =/ Page30xefcdab89/ ,/ c0/ =/ 0x98badcfe/ ,/ d0/ =/ 0x10325476/ ./ MD5/ 算法/ 的/ 迭代/ 过程/ 如下/ 所示/ ,/ 其中/ Hn/ 为/ 散列值/ MD5/ (/ M/ )/ ./ H1/ =/ CF/ (/ M0/ ,/ H0/ )/ ,/ …/ ,/ Hn/ =/ CF/ (/ Mn/ -/ 1/ ,/ Hn/ -/ 1/ )/ ./ 压缩/ 函数/ CF/ 由/ 64/ 步/ 构成/ ,/ 其中/ 1/ ~/ 16/ 步/ 、/ 17/ ~/ 32/ 步/ 、/ 33/ ~/ 48/ 步/ 以及/ 49/ ~/ 64/ 步/ 分别/ 称为/ 第/ 1/ 轮/ r1/ 、/ 第/ 2/ 轮/ r2/ 、/ 第/ 3/ 轮/ r3/ 和/ 第/ 4/ 轮/ r4/ ./ 设/ qi/ (/ 1/ / i/ / 64/ )/ 表示/ 压缩/ 函数/ 第/ i/ 步/ 的/ 32bit/ 状态字/ ,/ 而/ qi/ ,/ j/ 表示/ 状态字/ qi/ 的/ 第/ j/ 比特/ 值/ (/ 0/ / j/ / 31/ )/ ,/ 并/ 将/ 链接/ 变量/ 初始化/ 为/ q/ -/ 3/ =/ a0/ ,/ q0/ =/ b0/ ,/ q/ -/ 1/ =/ c0/ ,/ q/ -/ 2/ =/ d0/ ,/ 则/ 状态字/ qi/ (/ 1/ / i/ / 64/ )/ 的/ 更新/ 如式/ (/ 1/ )/ 所示/ :/ qi/ =/ qi/ -/ 1/ +/ (/ qi/ -/ 4/ +/ fi/ (/ qi/ -/ 1/ ,/ qi/ -/ 2/ ,/ qi/ -/ 3/ )/ +/ wi/ +/ ti/ )/ </ </ </ si/ 状态字/ qi/ 的/ 更新/ 使用/ 模/ 232/ 加法/ +/ 、/ 循环/ 左移/ 操作/ </ </ </ 、/ 轮/ 函数/ fi/ 、/ 消息/ 字/ wi/ 和/ 常数/ ti/ 进行/ ./ 轮/ 函数/ fi/ 的/ 具体/ 信息/ 如式/ (/ 2/ )/ 所示/ :/ 烄/ fi/ =/ 烅/ I/ (/ B/ ,/ C/ ,/ D/ )/ =/ C/ / (/ B/ ∨/ / D/ )/ ,/ i/ ∈/ r/ 烆/ 其中/ ,/ / 、/ ∧/ 、/ ∨/ 与/ / 分别/ 表示/ 逐位/ “/ 异或/ ”/ 操作/ 、/ “/ 与/ ”/ 操作/ 、/ “/ 或/ ”/ 操作/ 和/ “/ 非/ ”/ 操作/ ,/ 且/ B/ ,/ C/ ,/ D/ 分别/ 表示/ 32/ 比特/ 字/ ./ 本文/ 中若/ 未作/ 特别/ 说明/ ,/ 则/ fi/ 表示/ fi/ =/ (/ qi/ -/ 1/ ,/ qi/ -/ 2/ ,/ qi/ -/ 3/ )/ ./ 而/ 消息/ 字/ wi/ 为/ 消息/ 字/ (/ m0/ ,/ m1/ ,/ …/ ,/ m15/ )/ 之一/ ,/ 其/ 取值/ 称为/ MD5/ 的/ 消息/ 字/ 扩展/ ,/ 细节/ 如式/ (/ 3/ )/ 所示/ :/ 常数/ ti/ 的/ 取值/ 定义/ 为/ 如式/ (/ 4/ )/ 所示/ :/ </ </ </ si/ 表示/ 循环/ 左移/ si/ 比特/ ,/ 相应/ 的/ >/ >/ >/ 表示/ 循环/ 右移/ ./ 状态字/ 更新/ 的/ 每步/ 循环/ 移位/ 操作/ 细节/ 如式/ (/ 5/ )/ 所示/ :/ (/ si/ ,/ si/ +/ 1/ ,/ si/ +/ 2/ ,/ si/ +/ 3/ )/ =/ 若/ 64/ 步/ 状态/ 更新/ 完成/ 则/ 完成/ 了/ MD5/ 压缩/ 函数/ 的/ 一次/ 调用/ ,/ 需要/ 利用/ 最后/ 4/ 个/ 状态字/ 对/ 链接/ 变量/ Hi/ 进行/ 更新/ ./ 2.2/ MD5/ 碰撞/ 对/ 性质/ 若/ 存在/ 两个/ 任意/ 不同/ 的/ 消息/ m/ 和/ m/ (/ m/ ,/ m/ ∈/ {/ 0/ ,/ 1/ }/ / )/ 满足/ MD5/ (/ m/ )/ =/ MD5/ (/ m/ )/ ,/ 则/ m/ 和/ m/ 称作/ 一/ 碰撞/ 对/ ./ 设/ |/ M/ |/ 为/ 消息/ m/ 的/ 长度/ 并/ 为/ 分组/ 块/ 512bit/ 的/ 倍数/ ,/ 若/ 进一步/ 满足/ |/ m/ |/ =/ |/ m/ |/ ,/ 则/ 对/ 任意/ 消息/ x/ ,/ 满足/ 式/ (/ 6/ )/ 为/ APOP/ 密钥/ 恢复/ 攻击/ 的/ 基础/ ./ 2.3/ 消息/ 修改/ 技术/ 为了/ 有效/ 地/ 搜索/ 碰撞/ 对/ ,/ 需要/ 利用/ 一些/ 消息/ 修改/ 技术/ 满足/ 维持/ MD5/ 差分/ 路径/ 的/ 大量/ 充分条件/ ./ 比如/ 在/ 王小云/ 等/ 人/ [/ 5/ ]/ 提出/ 的/ 碰撞/ 攻击/ 中/ ,/ 第/ 1/ 个/ 分组/ 块/ 的/ 差分/ 路径/ 有/ 超过/ 200/ 个/ 条件/ ,/ 但是/ 优化/ 后/ 的/ 计算/ 复杂度/ 只/ 需/ 224.8/ 次/ MD5/ 散列/ 计算/ [/ 17/ ]/ ./ 文献/ [/ 5/ ]/ 中/ 提出/ 了/ 基本/ 消息/ 修改/ 和/ 高级/ 消息/ 修改/ 技术/ 满足/ 维持/ 差分/ 路径/ 所/ 需/ 的/ 充分条件/ ./ 根据/ 碰撞/ 攻击/ 的/ 属性/ ,/ 攻击者/ 可以/ 完全/ 控制/ 消息/ 字/ (/ m0/ ,/ m1/ ,/ …/ ,/ m15/ )/ 的/ 取值/ ,/ 因此/ ,/ 基本/ 消息/ 修改/ 技术/ 可以/ 很/ 容易/ 在/ 第一轮/ r1/ 实现/ ./ 若/ 第/ 1/ 轮/ 状态字/ qi/ 的/ 某/ 比特/ 值/ 不/ 满足条件/ ,/ 则/ 攻击者/ 只/ 需/ 修改/ 相应/ 的/ mi/ -/ 1/ 的/ 值/ 即可/ ./ 事实上/ ,/ 完全/ 可以/ 直接/ 设置/ qi/ (/ 1/ / i/ / 16/ )/ 的/ 充分条件/ 为/ 真/ ,/ 然后/ 再/ 计算/ 对应/ wi/ =/ mi/ -/ 1/ 的/ 值/ ,/ 如式/ (/ 7/ )/ 所示/ :/ mi/ -/ 1/ =/ wi/ =/ (/ qi/ -/ qi/ -/ 1/ )/ >/ >/ >/ si/ -/ qi/ -/ 4/ -/ fi/ -/ ti/ ,/ i/ ∈/ r1/ 为了/ 满足/ 第/ 2/ 轮/ r2/ 的/ 一些/ 充分条件/ ,/ 可以/ 通过/ 修改/ 第/ 1/ 轮/ r1/ 的/ 对应/ 消息/ 字/ mi/ ,/ 并/ 维持/ 因/ 消息/ 字/ 修改/ 所/ 导致/ 的/ 第/ 1/ 轮/ 差分/ 路径/ 的/ 变化/ 不/ 传入/ 第/ 2/ 轮/ (/ 差分/ 路径/ 不变/ )/ ,/ 即/ 为/ 高级/ 消息/ 修改/ 技术/ ./ 举例/ 说/ ,/ 如果/ 充分条件/ q25/ ,/ 31/ =/ q0/ ,/ 31/ 不/ 满足/ ,/ 则/ 我们/ 可以/ 通过/ 修改/ w25/ ,/ 26/ =/ m9/ ,/ 26/ 的/ 值/ 或者说/ 在/ 未/ 进行/ 循环/ 左移/ 前/ 引进/ 一个/ 226/ 的/ 差分/ ,/ 状态字/ q25/ 的/ 更新/ 如式/ (/ 8/ )/ 所示/ :/ q25/ =/ q24/ +/ (/ q21/ +/ f25/ +/ (/ w25/ =/ m9/ )/ +/ t25/ )/ </ </ </ 5/ 由于/ 第/ 1/ 轮/ r1/ 中/ 状态字/ q10/ ~/ q14/ 的/ 值/ 直接/ 受到/ m9/ 的/ 影响/ ,/ 若/ 我们/ 直接/ 修改/ m9/ 的/ 相关/ 值/ ,/ 则/ 它们/ 的/ 对应/ 取值/ 都/ 将/ 改变/ ,/ 从而/ 引起/ 状态字/ q10/ ~/ q14/ 的/ 改变/ (/ 如式/ (/ 10/ )/ ~/ 式/ (/ 14/ )/ 所示/ )/ ,/ 即/ 状态字/ q25/ 之前/ 的/ 差分/ 路径/ 已经/ 破坏/ ./ 因此/ 直接/ 的/ 消息/ 修改/ 毫无意义/ ,/ 即/ 在/ 此/ 情形/ 下/ 基本/ 消息/ 修改/ 技术/ 不能/ 使用/ ./ q9/ =/ q8/ +/ (/ q5/ +/ f9/ +/ (/ w9/ =/ m8/ )/ +/ t9/ )/ </ </ </ 7/ (/ 9/ )/ q10/ =/ q9/ +/ (/ q6/ +/ f10/ +/ (/ w10/ =/ m9/ )/ +/ t10/ )/ </ </ </ 12/ (/ 10/ )/ Page4q11/ =/ q10/ +/ (/ q7/ +/ f11/ +/ (/ w11/ =/ m10/ )/ +/ t11/ )/ </ </ </ 17q12/ =/ q11/ +/ (/ q8/ +/ f12/ +/ (/ w12/ =/ m11/ )/ +/ t12/ )/ </ </ </ 22q13/ =/ q12/ +/ (/ q9/ +/ f13/ +/ (/ w13/ =/ m12/ )/ +/ t13/ )/ </ </ </ 7/ (/ 13/ )/ q14/ =/ q13/ +/ (/ q10/ +/ f14/ +/ (/ w14/ =/ m13/ )/ +/ t14/ )/ </ </ </ 12/ 为了/ 克服/ 这个/ 缺点/ ,/ 可选项/ 之一/ 是/ 保持/ 状态字/ q11/ ~/ q14/ 的/ 值/ 不变/ ,/ 而/ 修改/ 相应/ 的/ 消息/ 字/ m10/ ~/ m13/ 的/ 值/ ,/ 如式/ (/ 10/ )/ ~/ 式/ (/ 14/ )/ 所示/ ./ 然而/ ,/ 问题/ 并未/ 能/ 真正/ 解决/ ./ 我们/ 注意/ 到/ m10/ 和/ m11/ 的/ 值/ 已经/ 分别/ 在/ 第/ 2/ 轮/ r2/ 更新/ 状态字/ q22/ 和/ q19/ 时/ 使用/ ,/ 也/ 即/ 之前/ 所/ 作/ 修改/ 消息/ 字/ m10/ 或者/ m11/ 的/ 值/ 以/ 维持/ r1/ 的/ 差分/ 路径/ 将/ 导致/ 第/ 2/ 轮/ q25/ 之前/ 的/ 差分/ 路径/ 改变/ ,/ 因此/ 该/ 方法/ 不/ 可行/ ./ 为了/ 另寻/ 出路/ ,/ 我们/ 注意/ 到/ 消息/ 字/ m8/ 将/ 在/ 第/ 2/ 轮/ q25/ 之后/ 的/ q28/ 中/ 使用/ (/ w28/ =/ m8/ )/ ,/ 即/ 可以/ 通过/ 修改/ 状态字/ q9/ 的/ 值/ 但/ 同时/ 保持/ 状态字/ q10/ 的/ 值/ 不变/ 以/ 达到/ 间接/ 修改/ m9/ 的/ 目的/ ./ 在/ 状态字/ 更新/ 式/ q10/ 中/ 翻转/ m9/ ,/ 26/ 的/ 值/ ,/ 则/ 循环/ 左移/ 后/ 将/ 在/ q10/ 引入/ 一个/ 差分/ 26/ ./ 所以/ 在/ 式/ (/ 10/ )/ 中/ 翻转/ q9/ ,/ 6/ 的/ 值/ ,/ 并/ 设置/ 一个/ 额外/ 的/ 充分条件/ q8/ ,/ 6/ =/ q7/ ,/ 6/ 以/ 保证/ f10/ =/ f10/ (/ q9/ ,/ 6/ ,/ q8/ ,/ 6/ ,/ q7/ ,/ 6/ )/ 的/ 值/ 不变/ ./ 然后/ 从值/ 不变/ 的/ q10/ 中/ 重新/ 计算/ m9/ ,/ 如式/ (/ 15/ )/ 所示/ ,/ 则/ 获得/ 了/ 期望/ 的/ 差分/ 226/ ./ m9/ =/ (/ q10/ -/ q9/ )/ >/ >/ >/ 12/ -/ q6/ -/ f10/ -/ t10/ (/ 15/ )/ 进一步/ ,/ 需要/ 设置/ 额外/ 的/ 充分条件/ q10/ ,/ 6/ =/ 0/ 来/ 保证/ 在/ 更新/ 状态字/ q11/ 时/ m10/ 和/ q11/ 的/ 值/ 不变/ ./ 类似/ 设置/ 条件/ q11/ ,/ 6/ =/ 1/ 以/ 保证/ 在/ 更新/ 状态字/ q12/ 时/ m11/ 和/ q12/ 的/ 值/ 不变/ ./ 最后/ ,/ 重新/ 计算/ m12/ 的/ 值/ 以/ 保证/ q13/ 的/ 值/ 也/ 不变/ ,/ 保证/ 了/ 修改/ m8/ 的/ 值/ 对/ 第/ 1/ 轮/ q10/ 之后/ 的/ 差分/ 路径/ 没有/ 影响/ ./ 如是/ ,/ 通过/ 高级/ 消息/ 修改/ 技术/ 以/ 概率/ 1/ 满足/ 了/ 充分条件/ q25/ ,/ 31/ =/ q0/ ,/ 31/ ,/ 并且/ 维持/ 了/ q25/ 之前/ 的/ 差分/ 路径/ 不变/ ./ 2.4/ 通道/ 通道/ 的/ 概念/ 由/ Klima/ [/ 9/ ]/ 提出/ ,/ 其本质/ 优势/ 就是/ 基于/ 自由/ 消息/ 位/ 不仅/ 实现/ 了/ 穷举/ 搜索/ ,/ 而且/ 最/ 重要/ 的/ 是/ 将/ 搜索/ 的/ 起始/ 点/ 后移/ ,/ 从而/ 极大/ 降低/ 了/ 碰撞/ 搜索/ 的/ 复杂度/ ./ dBB/ 碰撞/ 有/ 47/ 个/ 充分条件/ 需要/ 满足/ (/ qi/ ,/ 31/ =/ q0/ ,/ 31/ {/ i/ ≠/ 64/ ,/ i/ ∈/ (/ r1/ ,/ r2/ ,/ r4/ )/ }/ )/ ./ 在/ dBB/ 碰撞/ 搜索/ 中/ ,/ 状态字/ q10/ 有/ 充分条件/ q10/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 在/ 状态字/ q9/ 中有/ 充分条件/ q9/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 因此/ ,/ q9/ ,/ 31/ 的/ 值/ 一旦/ 确定/ 满足/ 则/ 不能/ 再/ 更改/ ,/ 否则/ 将会/ 破坏/ 之前/ 的/ 差分/ 路径/ ./ 除了/ 保留/ q9/ ,/ 6/ 做/ 高级/ 消息/ 修改/ 以/ 满足条件/ q25/ ,/ 31/ =/ q0/ ,/ 31/ ,/ 状态字/ q9/ 仍/ 有/ 30bit/ 的/ 信息/ 无需/ 特别/ 设定/ ,/ 即/ 为/ 自由/ 位/ ./ 在/ 状态字/ q10/ 设置/ 额外/ 条件/ q10/ =/ 231/ ×/ (/ 1/ ∧/ q0/ ,/ 31/ )/ +/ 0x00000000/ ;/ 在/ q11/ 中/ 设置/ 条件/ q11/ =/ 231/ ×/ (/ 1/ ∧/ q0/ ,/ 31/ )/ +/ 0x7fffffff/ ,/ 则/ 在/ 第/ 25/ 步/ (/ q25/ )/ 中/ ,/ 可以/ 通过/ 翻转/ q9/ 的/ 任意/ 自由/ 位来/ 启动/ 一个/ 新/ 的/ 碰撞/ 对/ 搜索/ 而/ 无需/ 担心/ 影响/ q25/ 之前/ 的/ 差分/ 路径/ ./ 在/ 状态字/ q25/ 之后/ ,/ dBB/ 的/ 差分/ 路径/ 有/ 22/ 个/ 充分条件/ 需要/ 随机/ 满足/ ,/ 而/ q9/ 通道/ 有/ 多达/ 30/ 个/ 自由/ 位/ ,/ 也/ 即/ 在/ q9/ 通道/ 之内/ 确定/ 能够/ 找到/ 多个/ dBB/ 碰撞/ 对/ ./ 因此/ ,/ 一旦/ 到达/ q9/ 通道/ ,/ dBB/ 碰撞/ 对/ 搜索/ 的/ 起始/ 点/ 就是/ q25/ ,/ 而/ 不是/ 未/ 应用/ 通道/ 技术/ 前/ 的/ q1/ ,/ 从而/ 极大/ 提高/ 了/ 碰撞/ 对/ 搜索/ 效率/ ./ 应用/ q9/ 通道/ 之后/ ,/ 根据/ 消息/ 修改/ 技术/ 的/ 原理/ ,/ 变化/ 的/ q9/ 对/ MD5/ 第一轮/ 差分/ 路径/ 所/ 产生/ 的/ 影响/ 在/ q13/ 之后/ 完全/ 消除/ ./ 即/ q9/ 通道/ 的/ 应用/ 不会/ 影响/ 到/ m13/ 、/ m14/ 和/ m15/ 的/ 取值/ ./ 因此/ ,/ 可以/ 固定/ m13/ 、/ m14/ 和/ m15/ 的/ 值/ (/ 96/ 位/ 信息/ 确定/ )/ 来/ 产生/ MD5/ 碰撞/ ,/ 即/ 对/ APOP/ 密钥/ 的/ 可能/ 字/ 进行/ 猜测/ (/ 前/ 11/ 个字符/ )/ ./ 2.5/ APOP/ 协议/ 带/ 认证/ 邮局/ 协议/ (/ APOP/ )/ 是/ 一种/ 流行/ 的/ 基于/ 散列/ 函数/ 的/ 挑战/ 和/ 响应/ 认证/ 协议/ ,/ 一般/ 被/ 邮件/ 服务器/ 用来/ 认证/ 将要/ 访问/ 存储/ 在/ 服务器端/ 邮件/ 的/ 用户/ 身份/ ./ APOP/ 是/ 邮局/ 协议/ —/ —/ —/ 版本/ 3/ (/ POP3/ )/ [/ 1/ ]/ 的/ 可选/ 安全/ 命令/ ,/ 用以/ 提供/ 额外/ 的/ 安全性/ ,/ 以/ 避免/ 在/ 不/ 安全/ 的/ 网络/ 上/ 传输/ 明文/ 密钥/ ./ 设/ 用户/ 和/ 服务器之间/ 预先/ 共享/ 的/ 密钥/ 为/ passwd/ ,/ 由于/ 邮件/ 访问/ 总是/ 由/ 用户/ 发起/ ,/ APOP/ 的/ 认证/ 过程/ 如下/ :/ (/ 1/ )/ 用户/ 向/ 认证/ 服务器发送/ 一个/ 连接/ 请求/ ./ (/ 2/ )/ 认证/ 服务器/ 随机/ 产生/ 一个/ 满足/ 一定/ 限制/ 条件/ 的/ 挑战/ 数据/ C/ (/ 格式化/ 为/ 一个/ 消息/ 标识符/ )/ ,/ 将/ C/ 发送至/ 用户/ ./ (/ 3/ )/ 用户/ 将/ 其/ 共享/ 密钥/ passwd/ 附加/ 于/ 接收/ 到/ 的/ 挑战/ 数据/ C/ 之后/ ,/ 如式/ (/ 16/ )/ 计算/ 其/ 响应值/ R/ ,/ 然后/ 将/ R/ 发送至/ 认证/ 服务器/ ./ (/ 4/ )/ 一旦/ 接收/ 到/ 响应/ R/ ,/ 认证/ 服务器/ 使用/ 共享/ 密钥/ 如式/ (/ 16/ )/ 计算/ RS/ ./ 服务器/ 校验/ RS/ =/ R/ 是否/ 成立/ ,/ 若/ 是/ ,/ 则/ 用户/ 通过/ 验证/ ./ 否则/ ,/ 验证/ 失败/ ./ APOP/ 协议/ 的/ 优势/ 在于/ :/ 若/ 散列/ 函数/ MD5/ 为/ 单向/ 散列/ 函数/ ,/ 应用/ 挑战/ 和/ 响应/ 的/ 认证/ 协议/ APOP/ 后/ ,/ 网络/ 监听/ 者/ 在/ 一个/ POP3/ 会话/ 中将/ 不会/ 得到/ 任何/ 有关/ 明文/ 密钥/ 的/ 信息/ ./ APOP/ 中/ 挑战/ 数据/ C/ 为/ 随机/ 产生/ ,/ 该/ 策略/ 可以/ 有效/ 防止/ 针对/ POP3/ 会话/ 的/ 重/ Page50x3c/ )/ 开头/ ,/ 且/ 包含/ 字符/ ‘/ @/ ’/ (/ 0x40/ )/ ./ APOP/ 挑战/ 数据/ 的/ 限制/ 条件/ 为/ (/ 1/ )/ 挑战/ 数据/ 必须/ 以/ 字符/ ‘/ </ ’/ (/ 十六进制/ 数/ (/ 2/ )/ 挑战/ 数据/ 必须/ 以/ 字符/ ‘/ >/ ’/ (/ 0x3e/ )/ 结尾/ ./ (/ 3/ )/ 挑战/ 数据/ 中间/ 不/ 能够/ 包含/ 任何/ ‘/ NULL/ ’/ 放/ 攻击/ ./ (/ 0x0/ )/ 、/ ‘/ </ ’/ 、/ ‘/ >/ ’/ 和/ ‘/ \/ n/ ’/ (/ 0x0a/ )/ 字符/ ./ 3/ 相关/ 工作/ 3.1/ 密钥/ 恢复/ 攻击/ 用户/ 首先/ 使用/ 其/ 邮箱/ 帐号/ 和/ 密钥/ 登录/ 邮件/ 服务器/ ,/ 然后/ 才能/ 访问/ 其/ 邮件/ ./ 由于/ 帐号/ 一般/ 都/ 是/ 以/ 明文/ 传送/ ,/ 为了/ 保证/ 其/ 邮箱/ 帐号/ 的/ 安全性/ ,/ 密钥/ 的/ 保密性/ 成/ 了/ 唯一/ 的/ 选择/ ,/ APOP/ 的/ 设计/ 正是/ 为了/ 不/ 在/ 非/ 信任/ 的/ 网络/ 中/ 传输/ 明文/ 密钥/ ./ 然而/ ,/ 仍然/ 有/ 其他/ 的/ 方法/ 来/ 攻击/ 用户/ 的/ 密钥/ ,/ 比如/ 社会/ 工程/ 、/ 特洛伊木马/ 、/ 穷举/ 密钥/ 搜索/ 攻击/ 和/ 字典/ 攻击/ 等/ ./ 3.1/ ./ 1/ 穷举/ 密钥/ 攻击/ 穷举/ 密钥/ 攻击/ 不仅/ 直接/ 而且/ 简单/ ,/ 但是/ 不太/ 容易/ 完成/ ./ 比如/ 一个/ 极端/ 的/ 例子/ ,/ 若/ 一个/ 密钥/ 仅/ 包含/ 一个/ 二进制位/ ,/ 则/ 其/ 要么/ 为/ ‘/ 0/ ’/ 要么/ 为/ ‘/ 1/ ’/ ./ 我们/ 仅/ 需要/ 一次/ 试探/ ,/ 而/ 不管/ 该/ 试探/ 是否/ 正确/ 我们/ 都/ 能/ 立刻/ 知图/ 1APOP/ “/ 切片/ ”/ 密钥/ 恢复/ 攻击/ 在/ APOP/ “/ 切片/ ”/ 密钥/ 恢复/ 攻击/ 的/ 情形/ 中/ ,/ 由于/ 挑战/ 数据/ 必须/ 为/ 字节/ 的/ 倍数/ ,/ 因此/ ,/ 攻击者/ 应用/ 分而治之/ 策略/ 来/ 进行/ APOP/ 攻击/ 时/ ,/ 密钥/ 恢复/ 的/ 基本/ 单位/ 是/ 一个/ 字节/ 而/ 不是/ 一个/ 比特/ ./ APOP/ 逐字/ 节/ 密钥/ 恢复/ 攻击/ 的/ 总体/ 步骤/ 如下/ (/ 攻击者/ 伪装成/ 认证/ 服务器/ )/ :/ (/ 1/ )/ 生成/ 一个/ 末尾/ 包含/ 有/ 可能/ 密钥/ 字/ cand/ 的/ 碰撞/ 对/ (/ m/ ,/ m/ )/ ,/ 其中/ cand/ 包含/ 已经/ 恢复/ 的/ 初始化/ 为/ ‘/ NULL/ ’/ 的/ 若干/ 密钥/ 字/ known/ 部分/ 和/ 正在/ 猜测/ 的/ 字符/ l/ ./ 从/ 碰撞/ 对/ 消息/ 中/ 分离/ 出/ 挑战/ 数据/ C/ =/ m/ -/ cand/ 和/ C/ =/ m/ -/ cand/ ,/ 先/ 将/ 挑战/ C/ 发送至/ 用户/ ./ (/ 2/ )/ 从/ 用户/ 处/ 接收/ 响应/ R/ ,/ 然后/ 将/ 另/ 一/ 挑战/ C/ 发送至/ 用户/ ./ (/ 3/ )/ 从/ 用户/ 处/ 接收/ 另/ 一/ 响应/ R/ ,/ 并/ 比较/ R/ =/ R/ 道/ 有关/ 密钥/ 的/ 正确/ 答案/ ./ 事实上/ ,/ 一般/ 的/ 密钥/ 由/ 52/ 个/ 字母/ 和/ 10/ 个/ 数字/ 构成/ (/ 简单/ 起/ 见/ ,/ 我们/ 忽略/ 了/ 特殊字符/ )/ ,/ 如果/ 该/ 密钥/ 仅/ 有/ 一个/ 字符/ ,/ 应用/ 穷举/ 密钥/ 攻击/ 在/ 最坏/ 的/ 情况/ 下/ 需要/ 61/ 次/ 试探/ 就/ 能/ 得到/ 正确/ 的/ 密钥/ ./ 但是/ ,/ 当/ 密钥/ 长度/ 为/ 8/ 个字符/ 时/ ,/ 应用/ 穷举/ 攻击/ 则/ 需要/ 大概/ 628/ -/ 1/ ≈/ 247/ 次/ 试探/ 才能/ 获得/ 答案/ ,/ 该/ 计算/ 量/ 对于/ 一般/ 的/ 计算机/ 来说/ 不太/ 可行/ ./ 因此/ ,/ 一般/ 认为/ 8/ 位/ 以上/ 密钥/ 的/ 安全性/ 较/ 高/ ./ 3.1/ ./ 2/ “/ 切片/ ”/ 密钥/ 恢复/ 攻击/ 若/ MD5/ 碰撞/ 对/ (/ m/ ,/ m/ )/ 中/ 的/ 两个/ 消息/ 长度/ 相等/ 且/ 为/ 分组/ 块/ 512bit/ 的/ 倍数/ ,/ 则/ 对/ 任意/ 消息/ x/ ,/ 总是/ 满足/ MD5/ (/ m/ ‖/ x/ )/ =/ MD5/ (/ m/ ‖/ x/ )/ ./ Preneel/ 和/ vanOorschot/ [/ 2/ ]/ 应用/ 该/ 属性/ 实现/ 分而治之/ 策略/ “/ 切片/ ”/ 攻击/ 秘密/ 信封/ 方案/ MAC/ 中/ 使用/ 的/ 密钥/ ./ 其/ 攻击/ 原理/ 为/ :/ 首先/ 攻击者/ 猜测/ 首个/ 未知/ 的/ 密钥/ 比特/ 的/ 内容/ 为/ b/ ,/ 然后/ 攻击者/ 据此/ 生成/ 一个/ 最后/ 一/ 比特/ 值为/ b/ 的/ 碰撞/ 对/ (/ m/ ,/ m/ )/ ;/ 其次/ ,/ 攻击者/ 从/ 消息/ m/ 和/ m/ 中/ 移除/ 猜测/ 值/ b/ ,/ 并/ 将/ 不/ 含/ 猜测/ 值/ 的/ 两个/ 消息/ 进行/ 在线/ MAC/ 查询/ ;/ 最后/ ,/ 比较/ 收到/ 的/ 两个/ 响应值/ ,/ 若/ 两值/ 相等/ ,/ 则/ 猜测/ 比特/ 值/ b/ 正确/ ./ 否则/ ,/ 猜测/ 错误/ ./ 如果/ 能够/ 对/ 长度/ 为/ 64bit/ 的/ 密钥/ 进行/ 分而治之/ 的/ 密钥/ 恢复/ 攻击/ ,/ 则/ 只/ 需要/ 64/ 次/ 查询/ (/ 每次/ 查询/ 都/ 必须/ 首先/ 生成/ 一个/ 碰撞/ 对/ 消息/ )/ ,/ 而/ 不是/ 穷举/ 搜索/ 所/ 需/ 的/ 264/ -/ 1/ “/ 次/ ”/ 查询/ ./ 是否/ 成立/ ./ 若/ 成立/ ,/ 则/ 表明/ 此次/ 猜测/ 的/ 字符/ l/ 是/ 正确/ 的/ ,/ 将/ l/ 添加/ 至/ 已/ 恢复/ 密钥/ 字/ known/ 的/ 尾部/ ,/ 继续/ 下/ 一个/ 字符/ l/ 的/ 猜测/ ;/ 否则/ ,/ 猜测/ 错误/ ,/ 转至步/ 1/ 以/ 进行/ 字符/ l/ 的/ 下/ 一个/ 猜测/ ./ 3.2/ 已有/ 的/ APOP/ “/ 切片/ ”/ 密钥/ 恢复/ 攻击/ 2007/ 年/ ,/ Leurent/ [/ 10/ ]/ 和/ Sasaki/ 等/ 人/ [/ 11/ ]/ 分别独立/ 提出/ 了/ 针对/ APOP/ 的/ 密钥/ 恢复/ 攻击/ ,/ 该/ 攻击/ 只/ 能够/ 恢复/ 出/ APOP/ 密钥/ 中/ 的/ 前/ 3/ 个字符/ ./ 该/ 攻击/ 的/ 局限性/ 在于/ 其/ 使用/ 王小云/ 等/ 人/ [/ 5/ ]/ 提出/ 的/ MD5/ 差分/ 路径/ ,/ 由于/ 该/ 差分/ 攻击/ 的/ 输入/ 差分/ m14/ 的/ 最高/ 位/ (/ MSB/ )/ 存在/ 差分/ ,/ 而/ MD5/ 使用/ 小/ 头/ (/ little/ -/ endian/ )/ 的/ 数据/ 存储/ 方式/ ,/ 导致/ 在/ APOP/ 密钥/ 恢复/ 攻击/ 中仅/ 有/ m15/ 可/ 用作/ 密钥/ 字符/ 的/ 猜测/ (/ 挑战/ 数据/ C/ 必须/ 以/ 字符/ ‘/ >/ ’/ 结尾/ ,/ 因此/ ,/ 仅/ 有/ 3/ 个字符/ 可以/ 被/ 使用/ )/ ./ Page62008/ 年/ ,/ Sasaki/ 等/ 人/ [/ 12/ ]/ 对/ APOP/ 的/ 密钥/ 恢复/ 攻击/ 进行/ 了/ 改进/ ,/ 通过/ 生成/ 一个/ “/ IV/ 桥/ ”/ 来/ 使用/ dBB/ 碰撞/ ,/ 利用/ dBB/ 碰撞/ 的/ 具有/ 更/ 多/ 自由/ 消息/ 位来/ 恢复/ 更/ 多/ 的/ 密钥/ 字/ ./ 改进/ 后/ ,/ 用来/ 恢复/ APOP/ 密钥/ 前/ 11/ 个字符/ 的/ MD5/ 碰撞/ 对/ 能够/ 在/ 约/ 1s/ 的/ 时间/ 内/ 找到/ ./ 该/ 攻击/ 方法/ 的/ 局限性/ 在于/ :/ 使用/ dBB/ 碰撞/ 进行/ 密钥/ 恢复/ 攻击/ 前/ ,/ 必须/ 以/ 大约/ 242/ 次/ MD5/ 散列/ 计算/ 构造/ 一个/ 额外/ 的/ “/ IV/ 桥/ ”/ ./ 2009/ 年/ ,/ 通过/ 提出/ “/ 比特/ 自由/ 碰撞/ ”/ 的/ 概念/ ,/ Wang/ 等/ 人/ [/ 13/ ]/ 进一步/ 对/ APOP/ 的/ 密钥/ 恢复/ 攻击/ 进行/ 了/ 改进/ ,/ 主要/ 在于/ 能够/ 有效/ 减少/ 需/ 发送/ 挑战/ 的/ 数目/ ./ “/ 1/ 比特/ 自由/ 碰撞/ ”/ 意味着/ 若/ 产生/ 原始/ MD5/ 碰撞/ 对/ 所/ 需/ 的/ 复杂度/ 为/ 2t/ 次/ MD5/ 散列/ 计算/ ,/ 则/ 1/ 比特/ 自由/ 碰撞/ 的/ 计算/ 复杂度/ 为/ 22t/ 次/ MD5/ 散列/ 计算/ ./ 他们/ 通过/ 产生/ “/ 1/ 比特/ 自由/ 碰撞/ ”/ 将/ 恢复/ APOP/ 密钥/ 前/ 11/ 个字符/ 所/ 需/ 挑战/ 数目/ 减少/ 了/ 一半/ ./ 4/ 多位/ 信息/ 确定/ 的/ 碰撞/ 对/ 搜索/ 为了/ 在/ APOP/ 密钥/ 恢复/ 攻击/ 中/ 应用/ 分而治之/ 策略/ ,/ 首要/ 的/ 问题/ 是/ 有效/ 解决/ 多位/ 信息/ 确定/ 的/ 碰撞/ 对/ 搜索/ ./ 本节/ 中/ ,/ 我们/ 提出/ 两个/ 新/ 的/ 通道/ 来/ 控制/ 碰撞/ 对/ 的/ 更/ 多/ 比特/ 值/ 从而/ 恢复/ 更/ 多/ 的/ 密钥/ 字/ ,/ 而且/ 提出/ 一个/ 群/ 满足/ 方案/ 来/ 改进/ 碰撞/ 搜索/ 的/ 效率/ ;/ 结合/ 群/ 满足/ 方案/ 和/ 分而治之/ 策略/ ,/ 实现/ 高效/ 的/ 基于/ 两个/ 分组/ 块/ 且/ 具有/ 多位/ 信息/ 确定/ 的/ 碰撞/ 对/ 搜索/ ,/ 总体/ 策略/ 如下/ :/ (/ 1/ )/ 将/ 第一个/ 输入/ 分组/ 块/ 的/ 消息/ 差分/ 设置/ 为/ Δ/ M0/ =/ (/ Δ/ m8/ =/ 231/ )/ ,/ 该/ 差分/ 在/ 文献/ [/ 18/ ]/ 中/ 提出/ ,/ 并/ 将/ 该/ 分组/ 块/ 当作/ “/ IV/ 桥/ ”/ ./ 具有/ 该/ 消息/ 差分/ 的/ 两/ 分组/ 块/ 被/ MD5/ 散列/ 函数/ 处理/ 后/ ,/ 输入/ 的/ 初始/ 链接/ 变量/ 差分/ Δ/ H0/ =/ 0/ 转变成/ 输出/ 链接/ 变量/ 差分/ Δ/ H1/ =/ ±/ (/ 231/ ,/ 231/ ,/ 231/ ,/ 231/ )/ ,/ 而/ Δ/ H1/ 正是/ dBB/ 碰撞/ 所/ 需要/ 的/ 输入/ 链接/ 变量/ 差分/ (/ dBB/ 条件/ 差分/ )/ ./ (/ 2/ )/ 将/ 第/ 2/ 个/ 分组/ 块/ 的/ 输入/ 差分/ 设置/ 为/ Δ/ M1/ =/ 0/ 以/ 使用/ dBB/ 碰撞/ ,/ 在/ 该/ 阶段/ 运用/ 新/ 的/ 通道/ 、/ 群/ 满足/ 方案/ 和/ 分而治之/ 策略/ 以/ 控制/ 更/ 多/ 消息/ 位/ 的/ 取值/ ./ 4.1/ 新/ 的/ 通道/ 为了/ 能够/ 恢复/ 出/ APOP/ 密钥/ 的/ 更/ 多/ 字符/ ,/ 我们/ 在/ q20/ 步/ 和/ q17/ 步/ 分别/ 提出/ 了/ 新/ 的/ q1/ 和/ q1/ 通道/ ./ 4.1/ ./ 1q20/ 的/ q1/ 通道/ q20/ 应用/ 消息/ 字/ m0/ 进行/ 状态字/ 更新/ ,/ 注意/ 到/ 状态字/ q2/ 有/ 充分条件/ q2/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 状态字/ q1/ 有/ 充分条件/ q1/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 因此/ ,/ q1/ ,/ 31/ 的/ 值/ 一旦/ 确定/ 满足/ 则/ 不能/ 再/ 更改/ ,/ 否则/ 将会/ 破坏/ 之前/ 的/ 差分/ 路径/ ./ 除了/ 保留/ q1/ ,/ 18/ 做/ 高级/ 消息/ 修改/ 以/ 满足条件/ q20/ ,/ 31/ =/ q0/ ,/ 31/ ,/ 状态字/ q1/ 仍/ 有/ 30bit/ 的/ 信息/ 无需/ 特别/ 设定/ ,/ 也/ 即/ 为/ 自由/ 位/ ./ 由于/ 消息/ 字/ m1/ 已经/ 在/ 第/ 2/ 轮/ q20/ 之前/ 的/ q17/ 使用/ ,/ 所以/ 不能/ 再/ 对/ 其/ 进行/ 任何/ 修改/ ,/ 否则/ 将/ 破坏/ q20/ 之前/ 的/ 差分/ 路径/ ./ 但是/ 注意/ 到/ m2/ ~/ m5/ 都/ 未/ 在/ MD5/ 的/ 第/ 2/ 轮/ 的/ q20/ 之前/ 出现/ ,/ 因此/ ,/ 翻转/ q1/ 后/ ,/ 根据/ m1/ 重新/ 计算/ q2/ ,/ 再/ 直接/ 修改/ 相应/ 的/ m2/ ~/ m5/ 来/ 保持/ 第/ 1/ 轮/ 的/ q3/ ~/ q6/ 差分/ 路径/ ./ 通过/ 以上/ 方式/ 可以/ 成功/ 构造/ q20/ 的/ q1/ 通道/ ./ 在/ 第/ 20/ 步/ (/ q20/ )/ 中/ ,/ 我们/ 可以/ 通过/ 翻转/ q1/ 的/ 任意/ 自由/ 位来/ 启动/ 一个/ 新/ 的/ 碰撞/ 对/ 搜索/ 而/ 无需/ 担心/ 影响/ q20/ 之前/ 的/ 差分/ 路径/ ./ 而/ 在/ 状态字/ q20/ 之后/ ,/ dBB/ 的/ 差分/ 路径/ 有/ 27/ 个/ 充分条件/ 需要/ 随机/ 满足/ ,/ 而/ q1/ 通道/ 有/ 多达/ 30/ 个/ 自由/ 位/ ,/ 也就是说/ ,/ 在/ q1/ 通道/ 之内/ 确定/ 能够/ 找到/ 多个/ dBB/ 碰撞/ 对/ ,/ 因此/ ,/ dBB/ 碰撞/ 对/ 搜索/ 的/ 起始/ 点/ 就是/ q20/ ./ 应用/ q1/ 通道/ 之后/ ,/ 根据/ 消息/ 修改/ 技术/ 的/ 原理/ ,/ q2/ 对/ MD5/ 第一轮/ 差分/ 路径/ 所/ 产生/ 的/ 影响/ 在/ q6/ 之后/ 完全/ 消除/ ,/ 即/ q1/ 通道/ 的/ 应用/ ,/ 不会/ 影响/ 到/ m6/ ~/ m15/ 的/ 取值/ ./ 因此/ ,/ 可以/ 固定/ m6/ ~/ m15/ 的/ 值/ (/ 320bit/ ,/ 40/ 个字符/ )/ 来/ 对/ APOP/ 的/ 可能/ 密钥/ 字/ 进行/ 猜测/ ./ 4.1/ ./ 2q17/ 的/ q1/ 通道/ q17/ 应用/ 消息/ 字/ m1/ 来/ 进行/ 状态字/ 更新/ ,/ 注意/ 到/ 状态字/ q2/ 有/ 充分条件/ q2/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 状态字/ q1/ 有/ 充分条件/ q1/ ,/ 31/ =/ q0/ ,/ 31/ 需要/ 满足/ ,/ 因此/ ,/ q1/ ,/ 31/ 的/ 值/ 一旦/ 确定/ 满足/ 则/ 不能/ 再/ 更改/ ,/ 否则/ 将会/ 破坏/ 之前/ 的/ 差分/ 路径/ ./ 除了/ 保留/ q1/ ,/ 6/ 做/ 高级/ 消息/ 修改/ 以/ 满足条件/ q17/ ,/ 31/ =/ q0/ ,/ 31/ ,/ 状态字/ q1/ 仍/ 有/ 30bit/ 的/ 信息/ 无需/ 特别/ 设定/ ,/ 也/ 即/ 为/ 自由/ 位/ ./ 由于/ 消息/ 字/ m0/ 、/ m2/ 至/ m4/ 都/ 未/ 在/ MD5/ 的/ 第/ 2/ 轮/ 的/ q17/ 之前/ 出现/ ,/ 因此/ ,/ 翻转/ q1/ 后/ ,/ 我们/ 可以/ 直接/ 修改/ 相应/ 的/ m1/ ~/ m4/ 来/ 保持/ 第/ 1/ 轮/ 的/ q2/ ~/ q5/ 差分/ 路径/ ./ 在/ 第/ 17/ 步/ (/ q17/ )/ 中/ ,/ 我们/ 可以/ 通过/ 翻转/ q1/ 的/ 任意/ 自由/ 位来/ 启动/ 一个/ 新/ 的/ 碰撞/ 对/ 搜索/ 而/ 无需/ 担心/ 影响/ q17/ 之前/ 的/ 差分/ 路径/ ./ 而/ 在/ 状态字/ q17/ 之后/ ,/ dBB/ 的/ 差分/ 路径/ 有/ 30/ 个/ 充分条件/ 需要/ 随机/ 满足/ ,/ 而/ q1/ 通道/ 也/ 有/ 30/ 个/ 自由/ 位/ ,/ 即/ 在/ q1/ 通道/ 之内/ 能以/ 极大/ 概率/ 找到/ 1/ 个/ dBB/ 碰撞/ 对/ ,/ 因此/ ,/ dBB/ 碰撞/ 对/ 搜索/ 的/ 起始/ 点/ 就是/ q17/ ./ 应用/ q1/ 通道/ 之后/ ,/ 根据/ 消息/ 修改/ 技术/ 的/ 原理/ ,/ q1/ 对/ MD5/ 第/ 1/ 轮/ 差分/ 路径/ 所/ 产生/ 的/ 影响/ 在/ q5/ 之后/ 完全/ 消除/ ./ 即/ q1/ 通道/ 的/ 应用/ ,/ 不会/ 影响/ 到/ m5/ ~/ m15/ 的/ 取/ Page7/ 值/ ./ 因此/ ,/ 可以/ 固定/ m5/ ~/ m15/ 的/ 值/ (/ 352bit/ ,/ 44/ 个字符/ )/ 来/ 对/ APOP/ 的/ 可能/ 密钥/ 字/ 进行/ 猜测/ ./ 4.2/ 群/ 满足/ 方案/ 基于/ 通道/ 技术/ 和/ 高级/ 消息/ 修改/ 技术/ ,/ 确定性/ 地/ 满足/ 在/ MD5/ 碰撞/ 搜索/ 中/ 最后/ 一个/ 通道/ 的/ 首/ 三步/ 的/ 所有/ 充分条件/ ,/ 以/ 达到/ 加速/ 碰撞/ 搜索/ 的/ 目的/ ./ 大部分/ 之前/ 的/ 碰撞/ 搜索算法/ [/ 9/ ,/ 17/ ]/ 都/ 是/ 使用/ 随机/ 满足/ 最后/ 一个/ 通道/ 中/ 的/ 充分条件/ ,/ 但是/ 我们/ 使用/ 群/ 满足/ 方案/ 确定性/ 地/ 满足/ 了/ 首/ 三步/ 的/ 充分条件/ ,/ 因而/ 不仅/ 可以/ 极大地提高/ 碰撞/ 概率/ 而且/ 可以/ 极大/ 提高/ 碰撞/ 对/ 搜索/ 的/ 效率/ ./ 4.3/ 应用/ 狇/ 9/ 通道/ 猜测/ 密钥/ 的/ 前/ 11/ 个字符/ 我们/ 在/ dBB/ 碰撞/ 搜索/ 中/ 应用/ 分而治之/ 策略/ 和/ 群/ 满足/ 方案/ ,/ 达到/ 控制/ 输入/ 消息/ 最后/ 96bit/ (/ 预先/ 设定/ 的/ m13/ 、/ m14/ 和/ m15/ )/ 的/ 目的/ ./ 相关/ 描述/ 如下/ ./ 算法/ 1/ ./ q9/ 通道/ 的/ 群/ 满足/ 方案/ ./ 输入/ :/ dBB/ 条件/ 差分/ ,/ 消息/ 差分/ Δ/ M1/ =/ 0/ ,/ q1/ ~/ q24/ 的/ 充分/ 输出/ :/ q27/ ,/ 31/ =/ q26/ ,/ 31/ =/ q25/ ,/ 31/ =/ q0/ ,/ 311/ ./ 随机/ 设置/ q9/ 自由/ 位/ 的/ 值/ ,/ 根据/ q10/ 重新/ 计算/ m9/ 的/ 值/ ./ 2/ ./ 计算/ q25/ 的/ 值/ ./ 3/ ./ ifq25/ ,/ 31/ ≠/ q0/ ,/ 31thenendif4/ ./ 计算/ q26/ 的/ 值/ ./ 5/ ./ ifq26/ ,/ 31/ ≠/ q0/ ,/ 31then/ 条件/ ,/ 随机/ 设置/ 非/ 条件/ 位/ 的/ 值/ ./ 值/ ,/ 若/ 其中/ 任意/ 条件/ 不/ 满足/ ,/ 转至步/ 1.1/ ./ 基本/ 框架/ ./ 1/ ./ 此处/ 的/ dBB/ 碰撞/ 共有/ 48/ 个/ 充分条件/ 需要/ 满足/ (/ 一个/ 额外/ 的/ 条件/ q23/ ,/ 22/ =/ 1/ 用来/ 支持/ 群/ 满足/ 方案/ )/ ,/ 但/ 我们/ 能够/ 在/ q25/ 步/ 使用/ 完全/ 的/ q9/ 通道/ ./ 应用/ 分而治之/ 策略/ 将/ dBB/ 碰撞/ 搜索/ 分成/ 两个/ 阶段/ :/ 第/ 1/ 个/ 阶段/ 从/ q1/ ~/ q24/ (/ 有/ 25/ 个/ 充分条件/ )/ ;/ 第/ 2/ 个/ 阶段/ 从/ R25/ (/ q9/ 通道/ 可/ 被/ 应用/ )/ 至/ 最后/ 的/ q64/ (/ 有/ 23/ 个/ 充分条件/ )/ ./ 1.1/ ./ 从/ q1/ 到/ q13/ ,/ 应用/ 简单/ 消息/ 修改/ 技术/ 直接/ 满足/ 充分/ 1.2/ ./ 利用/ 预设/ 的/ m13/ ~/ m15/ 的/ 值/ ,/ 依次/ 计算/ q14/ ~/ q16/ 的/ 1.3/ ./ 计算/ 剩余/ mi/ 值/ ,/ 计算/ 并/ 校验/ q17/ ~/ q24/ ,/ 若/ 任意/ 条件/ 2/ ./ 应用/ q9/ 通道/ 群/ 满足/ 方案/ 满足/ 首/ 三步/ q25/ ~/ q27/ 的/ 所有/ 条件/ (/ 共有/ 3/ 个/ 条件/ )/ ,/ 因此/ 第/ 2/ 阶段/ 共有/ 20/ 个/ 充分条件/ 需要/ 随机/ 满足/ ,/ q9/ 通道/ 有/ 28/ 个/ 自由/ 位/ ./ 3/ ./ 计算/ 并/ 校验/ q28/ ~/ q64/ ,/ 若/ 任意/ 条件/ 不/ 满足/ 则/ 转至步/ 2/ ./ 在/ 上述/ 框架/ 中/ 的/ 步/ 2/ 直接/ 调用/ 了/ q9/ 通道/ 的/ 群/ 满足/ 方案/ ,/ 接下来/ 在/ 算法/ 1/ 中/ 对/ q9/ 通道/ 的/ 群/ 满足/ 方案/ 进行/ 描述/ ./ 不/ 满足/ ,/ 转至步/ 1.1/ ./ 6/ ./ 计算/ q27/ 的/ 值/ ./ ifq27/ ,/ 31/ ≠/ q0/ ,/ 31then/ 计算/ q9/ ,/ 24/ =/ q9/ ,/ 24/ / 1/ ./ 根据/ q10/ 重新/ 计算/ m9/ 的/ 值/ ./ 计算/ q25/ 、/ q26/ 和/ q27/ 的/ 值/ ./ endif7/ ./ ifq27/ ,/ 31/ ≠/ q0/ ,/ 31/ 或者/ q26/ ,/ 31/ ≠/ q0/ ,/ 31/ 或者/ q25/ ,/ 31/ ≠/ q0/ ,/ 31then/ 转至步/ 1/ ./ endif/ 我们/ 在/ 算法/ 2/ 中/ 对/ 应用/ q9/ 通道/ 生成/ 猜测/ 密钥/ 算法/ 2/ ./ 应用/ q9/ 通道/ 生成/ 猜测/ APOP/ 密钥/ 前/ 输入/ :/ dBB/ 条件/ 差分/ ,/ 消息/ 差分/ Δ/ M1/ =/ 0/ 以及/ 预先/ 设定/ 输出/ :/ m0/ ,/ …/ ,/ m12/ 和/ 已知/ 的/ m13/ ~/ m15/ 构成/ dBB/ 碰撞/ 1/ ./ fori/ =/ 1to13do/ 前/ 11/ 位/ 字符/ 的/ 碰撞/ 对/ 进行/ 描述/ ./ 11/ 位/ 字符/ 的/ 碰撞/ 对/ ./ 2/ ./ fori/ =/ 14/ ,/ 16do3/ ./ 计算/ m1/ 、/ m6/ 、/ m11/ 、/ m0/ 、/ m5/ 、/ m10/ 和/ m4/ 的/ 值/ ./ 4/ ./ fori/ =/ 17to24do5/ ./ 计算/ m2/ 、/ m3/ 、/ m7/ 和/ m9/ 的/ 值/ ./ 6/ ./ 调用/ 群/ 满足/ 方案/ 的/ 算法/ 1.7/ ./ 根据/ q9/ 计算/ m8/ 的/ 值/ ./ 8/ ./ 根据/ q13/ 计算/ m12/ 的/ 值/ ./ 9/ ./ fori/ =/ 28to64do10/ ./ 输出/ m0/ ,/ …/ ,/ m12/ ./ 复杂度/ 分析/ ./ 应用/ 分而治之/ 策略/ 后/ ,/ 算法/ 2/ 第/ 1/ 阶段/ 和/ 第/ 2/ 阶段/ 分别/ 有/ 12/ 和/ 20/ 个/ 充分条件/ 需要/ 随机/ 满足/ ./ 由于/ 应用/ 了/ q9/ 通道/ ,/ 碰撞/ 搜索/ 的/ 起点/ 从/ q1Page8/ 移至/ q25/ (/ 在/ 该/ 情形/ 下/ ,/ 一旦/ 算法/ 进入/ 了/ 第/ 2/ 阶段/ ,/ 我们/ 只/ 需/ 在/ q25/ 开始/ 碰撞/ 搜索/ ,/ 而/ 无需/ 再/ 从/ 第/ 1/ 阶段/ 重新/ 开始/ )/ ./ 根据/ 分而治之/ 策略/ ,/ 两个/ 阶段/ 的/ 复杂度/ 可以/ 独立/ 计算/ ./ 第/ 1/ 阶段/ 的/ 复杂度/ 大约/ 为/ 29/ 次/ MD5/ 散列/ 计算/ ,/ 第/ 2/ 阶段/ 的/ 复杂度/ 为/ 218/ 次/ MD5/ 散列/ 计算/ ./ 因此/ ,/ 该/ 算法/ 的/ 总体/ 复杂度/ 为/ 29/ +/ 218/ ≈/ 218/ 次/ MD5/ 计算/ ./ 应用/ 普通/ 的/ PC机/ (/ Intel2GHzCPU/ )/ ,/ 具有/ 96/ 位/ 信息/ 确定/ 的/ 碰撞/ 对以/ 平均/ 时间/ 0.08/ s/ 产生/ ,/ 这比/ Sasaki/ 等/ 人/ [/ 12/ ]/ 的/ 工作/ 要/ 快/ 24/ 倍/ ./ 应用/ 分而治之/ 策略/ 和/ 群/ 满足/ 方案/ ,/ 生成/ “/ IV/ 桥/ ”/ 的/ 复杂度/ 降至/ 219/ 次/ MD5/ 散列/ 计算/ ,/ 平均/ 计算/ 时间/ 约/ 为/ 0.17/ s/ ./ 由于/ 生成/ 用来/ 恢复/ 密钥/ 前/ 11/ 个字符/ 的/ 碰撞/ 对/ 需要/ 218/ 次/ MD5/ 散列/ 计算/ ,/ 因此/ 生成/ 对应/ 1/ 比特/ 自由/ 碰撞/ 对/ 所/ 需/ 的/ 计算/ 量/ 为/ 236/ 次/ MD5/ 散列/ 计算/ ./ 我们/ 在/ 表/ 1/ 中/ 与/ 前人/ 的/ 工作/ 进行/ 了/ 比较/ ./ 工作/ IV/ 桥/ (/ 分组/ 块/ 1/ )/ 分组/ 块/ 21/ 比特/ 自由/ 碰撞/ 文献/ [/ 10/ ]/ 230/ 文献/ [/ 11/ ]/ 230/ 文献/ [/ 12/ ]/ 242/ 文献/ [/ 13/ ]/ 242/ 本文/ 4.4/ 应用/ 狇/ 1/ 通道/ 猜测/ 密钥/ 的/ 前/ 43/ 个字符/ 我们/ 在/ dBB/ 碰撞/ 搜索/ 中/ 应用/ 分而治之/ 策略/ 和/ 群/ 满足/ 方案/ ,/ 在/ q17/ 应用/ q1/ 通道/ 达到/ 控制/ 输入/ 消息/ 最后/ 352bit/ (/ 预先/ 设定/ 的/ m5/ ~/ m15/ )/ 的/ 目的/ ./ 我们/ 在/ 算法/ 3/ 中/ 对/ q1/ 通道/ 的/ 群/ 满足/ 方案/ 进行/ 详细描述/ ./ 算法/ 3/ ./ q1/ 通道/ 的/ 群/ 满足/ 方案/ ./ 输入/ :/ dBB/ 条件/ 差分/ ,/ 消息/ 差分/ Δ/ M1/ =/ 0/ ,/ q1/ ~/ q16/ 的/ 充分/ 输出/ :/ q19/ ,/ 31/ =/ q18/ ,/ 31/ =/ q17/ ,/ 31/ =/ q0/ ,/ 311/ ./ 随机/ 设置/ q1/ 自由/ 位/ 的/ 值/ ,/ 根据/ q2/ 重新/ 计算/ m1/ 的/ 值/ ./ 2/ ./ 计算/ q17/ 的/ 值/ ./ 3/ ./ ifq17/ ,/ 31/ ≠/ q0/ ,/ 31thenendif4/ ./ 计算/ q18/ 的/ 值/ ./ 5/ ./ ifq18/ ,/ 31/ ≠/ q0/ ,/ 31thenendif6/ ./ 计算/ q19/ 的/ 值/ ./ 7/ ./ ifq19/ ,/ 31/ ≠/ q0/ ,/ 31then/ 个字符/ 的/ 碰撞/ 对/ 进行/ 描述/ ./ 43/ 个字符/ 的/ 碰撞/ 对/ ./ 8/ ./ ifq17/ ,/ 31/ ≠/ q0/ ,/ 31/ 或者/ q18/ ,/ 31/ ≠/ q0/ ,/ 31/ 或者/ q19/ ,/ 31/ ≠/ q0/ ,/ 31then/ 转至步/ 1/ ./ endif/ 我们/ 在/ 算法/ 4/ 中/ 对/ 应用/ q1/ 通道/ 产生/ 恢复/ 前/ 43/ 算法/ 4/ ./ 应用/ q1/ 通道/ 产生/ 恢复/ APOP/ 密钥/ 前/ 输入/ :/ dBB/ 条件/ 差分/ ,/ 消息/ 差分/ Δ/ M1/ =/ 0/ 以及/ 预先/ 设定/ 输出/ :/ m0/ ,/ …/ ,/ m4/ 和/ 已知/ 的/ m5/ ~/ m15/ 构成/ dBB/ 碰撞/ 1/ ./ fori/ =/ 1to5doqi/ ,/ 31/ ←/ q0/ ,/ 31/ ,/ qi/ ,/ j/ ≠/ 31/ ←/ 随机/ 值/ ./ endfor2/ ./ fori/ =/ 6to16do3/ ./ 根据/ q2/ 计算/ m1/ 的/ 值/ ./ 4/ ./ 调用/ 群/ 满足/ 方案/ 算法/ 3.5/ ./ 根据/ q1/ 计算/ m0/ 的/ 值/ ./ 6/ ./ 根据/ q3/ 计算/ m2/ 的/ 值/ ./ 7/ ./ 根据/ q4/ 计算/ m3/ 的/ 值/ ./ 8/ ./ 根据/ q5/ 计算/ m4/ 的/ 值/ ./ 9/ ./ fori/ =/ 18to64do10/ ./ 返回/ m0/ ,/ …/ ,/ m4/ ./ 复杂度/ 分析/ ./ 应用/ 分而治之/ 策略/ 后/ ,/ 算法/ 4/ 的/ 第/ 1/ 阶段/ 和/ 第/ 2/ 阶段/ 分别/ 有/ 11/ 和/ 30/ 个/ 充分条件/ 需要/ 随机/ 满足/ ./ 由于/ 应用/ 了/ q1/ 通道/ ,/ 碰撞/ 搜索/ 的/ 起点/ 从/ q1/ 移至/ q17/ ./ 根据/ 分而治之/ 策略/ ,/ 两个/ 阶段/ 的/ 复杂度/ 可以/ 独立/ 计算/ ./ 第/ 1/ 阶段/ 的/ 复杂度/ 大约/ 为/ 29/ 次/ MD5/ 散列/ 计算/ ,/ 第/ 2/ 阶段/ 的/ 复杂度/ 约/ 为/ 226/ 次/ MD5/ 散列/ 计算/ ./ 因此/ ,/ 该/ 算法/ 的/ 总体/ 复杂度/ 为/ 29/ +/ 226/ ≈/ 226/ 次/ MD5/ 计算/ ./ 应用/ 普通/ 的/ PC机/ (/ Intel2GHzCPU/ )/ ,/ 具有/ 352/ 位/ 信息/ 确定/ 的/ 碰撞/ 对以/ 平均/ 时间/ 20s/ 产生/ ,/ 这比/ Sasaki/ 等/ 人/ [/ 12/ ]/ 的/ 工作/ 要/ 快/ 215/ 倍/ ./ 我们/ 也/ 极大/ 改进/ 了/ 用来/ 恢复/ APOP/ 密钥/ 不同/ 长度/ 字符/ 碰撞/ 对/ 的/ 搜索/ 效率/ ./ 在/ q24/ 中/ 应用/ q4/ 通道/ ,/ Page9/ 能够/ 以/ 219/ 次/ MD5/ 散列/ 计算/ 产生/ 具有/ 256bit/ 确定/ 值/ 的/ 碰撞/ 对/ (/ 恢复/ 密钥/ 前/ 31/ 个字符/ )/ ,/ 其/ 平均/ 时间/ 约/ 为/ 0.15/ s/ ./ 在/ q20/ 中/ 应用/ 我们/ 提出/ 的/ q1/ 通道/ ,/ 能够/ 以/ 224/ 次/ MD5/ 散列/ 计算/ 产生/ 具有/ 320/ 位/ 信息/ 确定/ 的/ 碰撞/ 对/ (/ 恢复/ 密钥/ 前/ 39/ 字符/ )/ ,/ 其/ 平均/ 时间/ 约/ 为/ 4.13/ s/ ./ 在/ q17/ 中/ 应用/ 我们/ 提出/ 的/ q1/ 通道/ ,/ 能够/ 以/ 226/ 次/ MD5/ 散列/ 计算/ 产生/ 具有/ 352/ 位/ 信息/ 确定/ 的/ 碰撞/ 对/ (/ 恢复/ 密钥/ 前/ 43/ 个字符/ )/ ,/ 其/ 平均/ 时间/ 约/ 为/ 20s/ ./ 若/ 在/ 第一个/ 分组/ 块/ 中/ (/ “/ IV/ 桥/ ”/ )/ 的/ 最后/ 4/ 个字符/ 应用/ 消息/ 位/ 控制技术/ (/ 针对/ m15/ 的/ 消息/ 控制/ 不会/ 影响/ 通道/ 和/ 分而治之/ 的/ 使用/ ,/ 所以/ 复杂度/ 并未/ 增加/ )/ ,/ 我们/ 能够/ 在/ 理论/ 上/ 恢复/ 密钥/ 的/ 前/ 67/ 个字符/ ./ 针对/ 具有/ 多位/ 信息/ 确定/ 的/ 碰撞/ 对/ 搜索/ ,/ 我们/ 在/ 表/ 2/ 中/ 与/ 之前/ 工作/ 进行/ 了/ 比较/ ./ 表/ 2/ 具有/ 多位/ 信息/ 确定/ 的/ 碰撞/ 对/ 搜索/ 比较/ 方案/ 文献/ [/ 12/ ]/ 约/ 1s5/ ./ 86s238/ 本文/ 0.08/ s0/ ./ 15s2245APOP/ 的/ 快速/ 密钥/ 恢复/ 攻击/ 239224/ 字符/ ‘/ @/ ’/ ./ (/ 1/ )/ 分组/ 块/ pre/ 以/ 字符/ ‘/ </ ’/ 开始/ 并/ 只/ 包含/ 一个/ (/ 2/ )/ 分组/ 块/ mid/ 充当/ “/ IV/ 桥/ ”/ 的/ 角色/ ./ (/ 3/ )/ 分组/ 块/ end/ 包含/ 此次/ 猜测/ 密钥/ 字/ 的/ 相关/ 信/ 为了/ 实现/ APOP/ 的/ 快速/ 密钥/ 恢复/ 攻击/ ,/ 我们/ 首先/ 伪装成/ 邮件/ 服务器/ ,/ 一旦/ 用户/ 发起/ 连接/ 请求/ ,/ 则/ 从/ 已/ 产生/ 的/ MD5/ 碰撞/ 对/ 中/ 提取/ 挑战/ 数据/ 并/ 将/ 其/ 发送至/ 用户/ ./ 为了/ 避开/ 挑战/ 数据/ 的/ 限制/ 条件/ ,/ 我们/ 将/ 挑战/ 数据/ 分为/ 3/ 个/ 部分/ ,/ 每/ 部分/ 为/ 512bit/ 的/ 分组/ 块/ ,/ 如下/ 所示/ ./ 息/ cand/ ,/ 且/ cand/ 附加/ 于/ ‘/ >/ ’/ 之后/ ./ 我们/ 从/ 碰撞/ 对/ 中/ 导出/ 一个/ 挑战/ 数据/ 对/ (/ C/ ,/ C/ )/ ,/ 其/ 挑战/ 数据/ 中/ C/ =/ pre/ ‖/ mid/ ‖/ (/ end/ -/ cand/ )/ 而/ C/ =/ pre/ ‖/ mid/ ‖/ (/ end/ -/ cand/ )/ ./ 在/ mid/ 和/ mid/ 之间/ 仅/ 有/ 比特/ m8/ ,/ 31/ 的/ 值/ 不同/ ,/ 满足/ m8/ ,/ 31/ =/ / m8/ ,/ 31/ 的/ 关系/ ./ 如果/ 邮件/ 用户/ 接收/ 到/ C/ 和/ C/ ,/ 将/ 当成/ 两个/ 完全/ 不同/ 的/ 挑战/ ./ 因此/ ,/ 我们/ 可以/ 使用/ C/ 和/ C/ 来/ 进行/ APOP/ 密钥/ 恢复/ 攻击/ 的/ 密钥/ 字/ 猜测/ ./ 在/ 表/ 3/ 中/ ,/ 给出/ 了/ 一个/ 由/ 3/ 个/ 分组/ 块/ 组成/ 用来/ 恢复/ APOP/ 密钥/ 前/ 43/ 个字符/ 的/ 碰撞/ 对/ 实例/ ./ 可能/ 密钥/ 字/ cand/ 位于/ 第/ 3/ 个/ 分组/ 块/ end/ 的/ 尾部/ ,/ 其/ 内容/ 为/ 选自/ “/ Bible/ ”/ 开头/ 的/ “/ InthebeginningGodcreatedtheheavenand/ ”/ 的/ 43/ 个字符/ ./ 第/ 1/ 个/ 分组/ 块/ pre/ 的/ 64/ 个字符/ 内容/ 为/ “/ </ TheHolyBible/ ./ KingJamesVersion/ ./ TheOldTestamentGennesis/ @/ ”/ ./ 第/ 2/ 个/ 分组/ 块/ mid/ 是/ 一个/ 精确/ 的/ “/ IV/ 桥/ ”/ ,/ 其为/ dBB/ 提供/ 链接/ 变量/ 差分/ Δ/ H2/ =/ -/ (/ 231/ ,/ 231/ ,/ 231/ ,/ 231/ )/ ./ 需要/ 指出/ 的/ 是/ ,/ 构造/ 该/ 碰撞/ 对/ 所/ 需/ 的/ 时间/ 约/ 为/ 20s/ ./ 复杂度/ 表/ 3/ 用来/ 恢复/ APOP/ 密钥/ 前/ 43/ 个字符/ 的/ 碰撞/ 对/ 实例/ H0/ / / / / / / / / / preH1/ =/ H1/ / / / / / / / / / midmidH2/ / / / / / / / / / / H2/ / / / / / / / / / / endH3/ =/ H3/ / / / / / / / / / 5.1/ APOP/ 本地/ 快速/ 密钥/ 恢复/ 攻击/ 我们/ 在/ 本地/ 发起/ 一个/ APOP/ 快速/ 密钥/ 恢复/ 攻击/ ,/ 该/ 实验/ 基于/ 一个/ 支持/ APOP/ 认证/ 协议/ 的/ 开源/ 软件/ “/ Evolution/ ”/ 的/ 较/ 老/ 版本/ ,/ 我们/ 在/ 软件/ 代码/ 级/ 修改/ 了/ 自动/ 邮件/ 访问/ 的/ 条件/ ,/ 将/ 一般/ 由/ 用户/ 或者/ 计时器/ 发起/ 的/ 访问/ 改为/ 从/ 特定/ 端口/ 收到/ 一个/ 信号/ 发起/ ./ 我们/ 在/ 本地/ PC/ (/ Intel2GHzCPU/ )/ 伪装成/ 邮件/ 服务器/ (/ S/ )/ ,/ U/ 代表/ 邮件/ 用户/ ./ 针对/ APOP/ 的/ 逐字/ 节/ 密钥/ 恢复/ 攻击/ 步骤/ 描述/ 如下/ ./ 战/ 数据/ 对/ C/ 和/ C/ ,/ 发送/ 一个/ 邮件/ 访问/ 信号/ 至/ 用户/ U/ ./ 1/ ./ S/ 从/ 包含/ 可能/ 密钥/ 字/ cand/ 的/ 碰撞/ 对/ 数据/ 中/ 抽取/ 挑/ 2/ ./ 一旦/ 收到/ 信号/ ,/ U/ 尝试/ 连接/ S/ ./ 3/ ./ S/ 发送/ 挑战/ 数据/ C/ 至/ U/ ./ 4/ ./ U/ 计算/ R/ =/ MD5/ (/ C/ ‖/ passwd/ )/ ,/ 并/ 将/ 其/ 发送至/ S/ ./ 5/ ./ 一旦/ 接收/ 到/ R/ ,/ S/ 发送/ 另/ 一/ 邮件/ 访问/ 信号/ 至/ U/ ./ Page106/ ./ 基于/ 收到/ 的/ 信号/ ,/ U/ 尝试/ 连接/ S/ ./ 7/ ./ S/ 发送/ 另/ 一个/ 挑战/ 数据/ C/ 至/ U/ ./ 8/ ./ U/ 计算/ R/ =/ MD5/ (/ C/ ‖/ passwd/ )/ 并/ 将/ 其/ 返回/ 至/ S/ ./ 9/ ./ S/ 校验/ R/ 是否/ 和/ R/ 相等/ ,/ 若/ 是/ ,/ 则/ 此次/ 猜测/ 的/ 可能/ 密钥/ 字/ cand/ 正确/ ,/ 若/ 密钥/ 已经/ 完全恢复/ ,/ 则/ 停止/ ./ 否则/ ,/ 对/ 密钥/ 可能/ 字/ cand/ 进行/ 下/ 一轮/ 的/ 猜测/ ./ 怎样/ 判断/ 密钥/ 已经/ 完全恢复/ ./ 在/ 如/ 上/ APOP/ 密钥/ 恢复/ 攻击/ 的/ 步/ 9/ ,/ 需要/ 判断/ 密钥/ 是否/ 已经/ 完全恢复/ ./ 我们/ 将/ 这个/ 问题/ 解决/ 如下/ :/ (/ 1/ )/ 总是/ 先/ 假定/ 密钥/ passwd/ 已经/ 完全恢复/ ,/ 则/ 输入/ 消息/ C/ 和/ passwd/ 之后/ 的/ 信息/ 就是/ 填充/ 数据/ padding/ ./ (/ 2/ )/ 计算/ MD5/ (/ C/ ‖/ cand/ )/ 并/ 比较/ 其/ 是否/ 与/ R/ 相等/ ,/ 若/ 是/ ,/ 则/ 确认/ 密钥/ 已经/ 完全恢复/ ,/ 攻击/ 停止/ ./ 否则/ ,/ 密钥/ 仍/ 有/ 未知/ 的/ 密钥/ 字/ 有待/ 进一步/ 地/ 恢复/ ./ 实际性/ 分析/ ./ 在/ 实验/ 中/ ,/ 假定/ 本地/ 恶意软件/ 能够/ 修改/ 邮件/ 客户端/ 的/ 行为/ ,/ 这/ 在/ 实际/ 生活/ 中是/ 普遍存在/ 的/ ./ 此外/ ,/ 绝大部分/ 的/ 用户/ 习惯/ 勾选/ 记住/ 密钥/ 的/ 选项/ ,/ 省却/ 每次/ 输入/ 密钥/ 的/ 麻烦/ ./ 所以/ 该/ 实验/ 一定/ 程度/ 上/ 模拟/ 了/ 由/ 恶意软件/ 发起/ 的/ 攻击/ ,/ 并/ 将/ 该/ 攻击/ “/ 放大/ 化/ ”/ 处理/ ./ 我们/ 还/ 假定/ 密钥/ 仅/ 由/ 52/ 个/ 字母/ 和/ 10/ 个/ 数字/ 组成/ ,/ 该/ 假设能/ 反映/ 真实/ 生活/ 中/ 一般/ 密钥/ 的/ 取值/ 范围/ ./ 一般来说/ ,/ 7/ 位/ 以上/ 的/ 密钥/ 被/ 认为/ 是/ 安全/ 的/ ./ 在/ 攻击/ 中/ ,/ 我们/ 可以/ 快速/ 地/ 恢复/ 出/ 具有/ 6/ ~/ 31/ 个字符/ 的/ 密钥/ ,/ 而且/ 能够/ 在/ 实际/ 时间/ 内/ 恢复/ 长达/ 43/ 位/ 的/ 密钥/ ./ 比如/ 我们/ 能够/ 在/ 大约/ 1min/ 的/ 时间/ 内/ 恢复/ 长达/ 11/ 个字符/ 的/ 密钥/ ,/ 不同/ 长度/ 字符/ 密钥/ 恢复/ 攻击/ 所/ 需/ 的/ 平均/ 时间/ 如表/ 4/ 中/ 所示/ ./ 表/ 4/ 恢复/ 具有/ 不同/ 长度/ 字符/ 的/ 密钥/ 所/ 需/ 平均/ 时间/ APOP/ 的/ 本地/ 快速/ 密钥/ 恢复/ 攻击/ 表明/ APOP/ 的/ 安全性/ 极低/ ,/ 且/ 其它/ 基于/ MD5/ 的/ 应用/ 需要/ 严谨/ 的/ 安全/ 评估/ ./ 6/ 总结/ 我们/ 提出/ 两个/ 新/ 的/ 通道/ 以/ 恢复/ APOP/ 密钥/ 的/ 更/ 多/ 字符/ ,/ 并/ 提出/ 一种/ “/ 群/ 满足/ 方案/ ”/ 极大/ 降低/ 了/ 具有/ 多位/ 信息/ 确定/ 的/ MD5/ 碰撞/ 对/ 搜索/ 的/ 复杂度/ ;/ 产生/ 一个/ 用来/ 恢复/ APOP/ 密钥/ 前/ 31/ 个字符/ 的/ 碰撞/ 对/ 的/ 平均/ 时间/ 比/ 文献/ [/ 12/ ]/ 中/ 的/ 工作/ 要/ 快/ 25/ 倍/ ;/ 产生/ 一个/ 用来/ 恢复/ APOP/ 中/ 密钥/ 的/ 前/ 39/ 个字符/ 和/ 43/ 个字符/ 碰撞/ 对/ 的/ 平均/ 时间/ 比/ 文献/ [/ 12/ ]/ 中/ 的/ 工作/ 要/ 快/ 215/ 倍/ ./ 这些/ 技术/ 还/ 可以/ 用来/ 降低/ 搜索/ 包含/ APOP/ 密钥/ 的/ 前/ 11/ 个字符/ 的/ 1/ 比特/ 自由/ 的/ 碰撞/ 对/ 的/ 复杂度/ ./ 

