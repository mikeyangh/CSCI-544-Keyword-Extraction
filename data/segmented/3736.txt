Page1/ 概率/ 积分/ 密码/ 分析/ 李晓千/ 1/ )/ 吴文玲/ 1/ )/ 李宝/ 1/ )/ 于晓丽/ 2/ )/ 1/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 2/ )/ (/ 中国科学院/ 软件/ 研究所/ 北京/ 100190/ )/ 摘要/ 在/ 传统/ 的/ 积分/ 密码/ 分析/ 中/ ,/ 积分/ 区分/ 器/ 都/ 是/ 以/ 概率/ 1/ 成立/ 的/ ./ 虽然/ Knudsen/ 等/ 学者/ 提到/ 过/ :/ “/ 就/ 像/ 差分/ 一样/ ,/ 积分/ 也/ 可以/ 是/ 概率/ 的/ ”/ ,/ 但是/ ,/ 没有/ 文献/ 报道/ 过/ 进一步/ 的/ 研究/ ./ 文中/ 对此/ 问题/ 进行/ 了/ 探讨/ ,/ 提出/ 了/ 概率/ 积分/ 密码/ 分析方法/ ,/ 并/ 从/ 理论/ 和/ 实验/ 两/ 方面/ 验证/ 了/ 概率/ 积分/ 分析方法/ 的/ 有效性/ ./ 对于/ 采用/ S/ 盒/ 设计/ 的/ 分组/ 密码/ ,/ 文中/ 证明/ 了/ 如果/ S/ 盒/ 的/ 差分/ 均匀/ 性越/ 接近/ 随机/ 概率/ ,/ 则/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 能力/ 就/ 越强/ ./ 同时/ ,/ 文中/ 指出/ 高阶/ 积分/ 分析/ 的/ 某些/ 技巧/ 对于/ 概率/ 积分/ 分析/ 是/ 行不通/ 的/ ,/ 主要/ 原因/ 是/ 随着/ 求和/ 变量/ 个数/ 的/ 增加/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ./ 最后/ ,/ 文中/ 通过/ 对/ AES/ 和/ LBlock/ 这/ 两个/ 算法/ 的/ 概率/ 积分/ 分析/ 实例/ ,/ 说明/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 都/ 是/ 免疫/ 的/ ./ 关键词/ 积分/ 密码/ 分析/ ;/ 差分/ 密码/ 分析/ ;/ 概率/ 积分/ 密码/ 分析/ ;/ 轻量级/ 密码/ ;/ AES/ ;/ LBlock1/ 引言/ 在/ 过去/ 的/ 几十年/ 里/ ,/ 对/ 分组/ 密码/ 分析方法/ 的/ 研究/ 有/ 了/ 很大/ 的/ 进展/ ,/ 其中/ 应用/ 最/ 广泛/ 的/ 分析方法/ 有/ 差分/ 密码/ 分析/ [/ 1/ ]/ 、/ 线性/ 密码/ 分析/ [/ 2/ ]/ 和/ 积分/ 密码/ 分析/ [/ 3/ ]/ 等/ ./ 1990/ 年/ ,/ Biham/ 等/ 密码/ 学家/ 提出/ 了/ 差分/ 密码/ 分析/ ./ 差分/ 分析/ 的/ 基本/ 思想/ 是/ :/ 通过/ 分析/ 两个/ 中间状态/ 的/ “/ 差/ ”/ 经过/ 几轮/ 密码/ 变换/ 后/ 的/ 变化/ 情况/ 来/ 恢复/ 某些/ 密钥/ 比特/ ./ 与/ 差分/ 分析/ 类似/ ,/ 积分/ 分析/ 的/ 基本/ 思想/ 是/ :/ 通过/ 分析/ 多个/ 中间状态/ 的/ “/ 和/ ”/ 经过/ 几轮/ 密码/ 变换/ 后/ 的/ 变化/ 情况/ 来/ 恢复/ 某些/ 密钥/ 比特/ ./ 这/ 两种/ 分析方法/ 的/ 不同之处/ 在于/ ,/ 差分/ 分析/ 关注/ 的/ 是/ 两个/ 中间状态/ 的/ 异或/ 值/ ,/ 而/ 积分/ 分析/ 关注/ 的/ 是/ 多个/ 中间状态/ 的/ 异或/ 值/ 以及/ 这些/ 状态/ 之间/ 的/ 关系/ ./ 差分/ 分析/ 经/ 扩展/ 得到/ 不/ 可能/ 差分/ 分析/ [/ 4/ ]/ ,/ 进一步/ 地/ ,/ 不/ 可能/ 差分/ 分析/ 经/ 扩展/ 得到/ 不太可能/ 差分/ 分析/ [/ 5/ ]/ ./ 差分/ 分析/ 利用/ 概率/ 高于/ 随机/ 概率/ 的/ 差分/ 特征/ 筛选/ 正确/ 密钥/ ,/ 即/ p/ >/ pr/ ;/ 不/ 可能/ 差分/ 分析/ 利用/ 概率/ 为/ 0/ 的/ 差分/ 特征/ 排除/ 错误/ 密钥/ ,/ 即/ p/ =/ 0/ ;/ 而/ 不太可能/ 差分/ 利用/ 概率/ 低于/ 随机/ 概率/ 的/ 差分/ 特征/ 排除/ 错误/ 密钥/ ,/ 即/ 0/ </ p/ </ pr/ ./ 类似/ 地/ ,/ 在/ 传统/ 的/ 积分/ 分析/ 中/ ,/ 我们/ 利用/ 的/ 积分/ 特征/ 都/ 必须/ 满足/ 概率/ 为/ 1/ ,/ 即/ p/ =/ 1/ ./ 比如/ 对/ Square/ [/ 3/ ]/ 、/ AES/ [/ 6/ ]/ 、/ Crypton/ [/ 7/ ]/ 、/ Hierocrypt/ [/ 8/ ]/ 、/ IDEA/ [/ 9/ ]/ 、/ Skipjack/ [/ 10/ ]/ 、/ Camellia/ [/ 11/ ]/ 、/ MISTY1/ [/ 6/ ]/ 、/ FOX/ [/ 12/ ]/ 、/ SAFER/ +/ [/ 13/ ]/ 、/ Twofish/ [/ 14/ ]/ 等/ 算法/ 的/ 积分/ 攻击/ ./ 那么/ ,/ 能否/ 构造/ 概率/ 不为/ 1/ 的/ 有效/ 概率/ 积分/ 特征/ ,/ 即/ pr/ </ p/ </ 1/ 或/ 0/ / p/ </ pr/ ?/ 在/ 文献/ [/ 6/ ]/ 中/ ,/ Knudsen/ 等/ 学者/ 提到/ 过/ :/ “/ 就/ 像/ 差分/ 一样/ ,/ 积分/ 也/ 可以/ 是/ 概率/ 的/ ”/ ,/ 这/ 点明/ 了/ 概率/ 积分/ 特征/ 的/ 存在/ 性/ ,/ 但是/ 没有/ 任何/ 文献/ 做/ 进一步/ 的/ 研究/ ./ 本文/ 对此/ 问题/ 进行/ 了/ 探讨/ ,/ 提出/ 了/ 概率/ 积分/ 密码/ 分析方法/ ,/ 并/ 从/ 理论/ 和/ 实验/ 两/ 方面/ 验证/ 了/ 概率/ 积分/ 分析方法/ 的/ 有效性/ ./ 本文/ 的/ 主要/ 结论/ 有/ :/ 对于/ 采用/ S/ 盒/ 设计/ 的/ 分组/ 密码/ ,/ 如果/ S/ 盒/ 的/ 差分/ 均匀/ 性越/ 接近/ 随机/ 概率/ ,/ 则/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 能力/ 就/ 越强/ ;/ 并且/ ,/ 随着/ 求和/ 变量/ 个数/ 的/ 增加/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ,/ 因此/ 高阶/ 积分/ 分析/ 的/ 某些/ 技巧/ 对于/ 概率/ 积分/ 分析/ 是/ 行不通/ 的/ ./ 最后/ ,/ 通过/ 对/ AES/ 和/ LBlock/ 这/ 两个/ 算法/ 的/ 概率/ 积分/ 分析/ 实例/ ,/ 说明/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 是/ 免疫/ 的/ ./ 本文/ 第/ 2/ 节/ 简要/ 介绍/ 积分/ 密码/ 分析/ 中/ 的/ 符号/ 定义/ ;/ 第/ 3/ 节/ 提出/ 采用/ S/ 盒/ 的/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 分析/ 的/ 充分条件/ ,/ 并用/ 实验/ 证明/ ,/ 随着/ 求和/ 变量/ 个数/ 的/ 增加/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ pr/ ;/ 第/ 4/ 节/ 通过/ 对/ AES/ 、/ LBlock/ 的/ 概率/ 积分/ 密码/ 分析/ 实例/ ,/ 验证/ 第/ 3/ 节/ 的/ 结论/ ,/ 说明/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 是/ 免疫/ 的/ ./ 2/ 基本/ 记号/ 和/ 定义/ 本文/ 沿用/ 文献/ [/ 6/ ]/ 中/ 的/ 记号/ ./ 如非/ 特别/ 说明/ ,/ 下文/ 的/ “/ 集合/ ”/ 均/ 指/ 多重集/ ,/ 即/ 集合/ 中/ 的/ 元素/ 可以/ 重复/ ,/ 例如/ S/ =/ {/ 1/ }/ 与/ T/ =/ {/ 1/ ,/ 1/ }/ 表示/ 两个/ 不同/ 的/ 集合/ ./ 定义/ 1/ [/ 10/ ]/ ./ 在/ 积分/ 分析/ 中/ ,/ 定义/ 活跃/ 集/ A/ =/ {/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / 稳定/ 集/ C/ =/ {/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / 平衡/ 集/ B/ =/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / 在/ 本文/ 中/ ,/ 定义/ Vx/ =/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / 特别/ 的/ ,/ V0/ =/ B/ ./ 其中/ m/ 称作/ 求和/ 变量/ 个数/ ./ 作/ A/ / C/ =/ A/ ;/ 性质/ 1/ [/ 6/ ]/ ./ (/ 1/ )/ A/ // C/ 经过/ 一个双/ 射后/ ,/ 仍然/ 是/ A/ // C/ ;/ (/ 2/ )/ A/ 的/ 线性组合/ 为/ B/ ;/ (/ 3/ )/ A/ 与/ C/ 的/ 对应/ 元素/ 异或/ 求和/ 仍然/ 为/ A/ ,/ 记/ (/ 4/ )/ Vx/ / Vy/ =/ Vx/ / y/ ./ 由/ 性质/ 1/ (/ 1/ )/ 得/ ,/ A/ // C/ 经过/ S/ 盒/ 仍然/ 是/ A/ // C/ ,/ 但是/ B/ 经过/ S/ 盒后/ 性质/ 无法/ 确定/ ,/ 如何/ 确定/ B/ 经过/ S/ 盒后/ 的/ 性质/ 便/ 成为/ 积分/ 分析/ 的/ 瓶颈/ ,/ 概率/ 积分/ 分析/ 便是/ 针对/ 这一/ 问题/ 引入/ 的/ ./ 定义/ 2/ [/ 6/ ]/ ./ 几个/ 集合/ 的/ 直积/ 称作/ 一个/ 结构/ ,/ 例如/ CCCCABBB/ =/ C/ ×/ C/ ×/ C/ ×/ C/ ×/ A/ ×/ B/ ×/ B/ ×/ B/ 就是/ 一个/ 结构/ ./ 与/ 差分/ 特征/ 的/ 定义/ 类似/ ,/ 下面/ 给出/ 积分/ 特征/ 的/ 定义/ ./ 定义/ 3/ ./ r/ -/ 轮/ 积分/ 特征/ Ω/ 是/ 一个/ 结构/ 序列/ :/ α/ 0/ ,/ α/ 1/ ,/ …/ ,/ α/ r/ ,/ 其中/ α/ 0/ 是/ 明文/ 满足/ 的/ 结构/ ,/ α/ i/ (/ 1/ / i/ / r/ )/ 是/ 第/ i/ 轮/ 输出/ 满足/ 的/ 结构/ ./ 定义/ 4/ ./ r/ -/ 轮/ 积分/ 特征/ Ω/ =/ α/ 0/ ,/ α/ 1/ ,/ …/ ,/ α/ r/ 的/ 概率/ 是/ 指/ ,/ 在/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ 独立/ 、/ 均匀/ 随机/ 选取/ 时/ ,/ 该/ 结构/ 经过/ i/ 轮/ 加密/ ,/ 满足/ 第/ i/ 轮/ (/ 1/ / i/ / r/ )/ 输出/ 积分/ 特征/ α/ i/ 的/ 概率/ ,/ 记作/ p/ Ω/ ./ Page3/ 定义/ 5/ [/ 15/ ]/ ./ 对于/ 一个/ n/ ×/ n/ 的/ S/ 盒/ ,/ 令/ δ/ S/ =/ 2/ -/ nmax/ α/ ∈/ / 2n/ \/ {/ 0/ }/ max/ β/ ∈/ / 2n/ #/ {/ (/ a0/ ,/ a1/ )/ ∈/ / 称/ δ/ S/ 为/ S/ 盒/ 的/ 差分/ 均匀/ 性/ ./ Probm/ [/ α/ →/ / / S/ β/ ]/ 定义/ 6/ ./ 对于/ 一个/ n/ ×/ n/ 的/ S/ 盒/ ,/ 记/ {/ #/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / =/ i/ =/ 0/ =/ 2/ -/ n/ (/ m/ -/ 1/ )/ {/ #/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / S/ (/ ai/ )/ =/ }/ β/ ∑/ m/ -/ 1/ 为/ S/ 盒/ 的/ m/ 次/ 积分/ 特征/ 概率/ ,/ 其中/ α/ ,/ β/ ∈/ / 2n/ ./ 如果/ 积分/ 特征/ (/ α/ ,/ β/ )/ 满足/ / (/ α/ ,/ β/ )/ ≠/ (/ α/ ,/ β/ )/ ,/ |/ Probm/ [/ α/ →/ / / S/ β/ ]/ -/ 2/ -/ n/ |/ / |/ Probm/ [/ α/ →/ / / S/ β/ ]/ -/ 2/ -/ n/ |/ ,/ S/ =/ Probm/ [/ α/ →/ / / S/ β/ ]/ ,/ 称/ δ/ m/ 令/ δ/ m/ 匀性/ ,/ 即/ 与/ 随机/ 概率/ 差距/ 最大/ 的/ m/ 次/ 积分/ 特征/ ./ 定义/ 7/ ./ 如果/ 一个/ 差分/ 特征/ 概率/ // 积分/ 特征/ 概率/ 为/ p/ ,/ 并且/ 一个/ 满足/ 该/ 输入/ 差分/ 特征/ // 输入/ 积分/ 特征/ 的/ 明文/ 对/ // 结构/ ,/ 经过/ 一个/ 随机/ 置换/ 后/ ,/ 仍然/ 满足/ 该/ 特征/ 概率/ p/ ,/ 则/ 称此/ 概率/ 为/ 随机/ 概率/ ,/ 记作/ pr/ ./ 3/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 3.1/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 充分条件/ 这/ 一节/ 我们/ 给出/ 采用/ S/ 盒/ 的/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 充分条件/ :/ S/ 盒/ 的/ 差分/ 均匀/ 性越/ 接近/ 随机/ 概率/ pr/ ,/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 能力/ 就/ 越强/ ./ 定理/ 1/ ./ 如果/ 一个/ n/ ×/ nS/ 盒/ 的/ 任意/ 非零/ 差分/ 特征/ 概率/ 均/ 不/ 大于/ p/ ,/ 那么/ 任意/ 积分/ 特征/ 概率/ 也/ 不/ 大于/ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ 证明/ ./ 记/ Probm/ [/ α/ →/ / / S/ β/ ]/ 为/ 一个/ S/ 盒/ 的/ 积分/ 特征/ (/ α/ ,/ β/ )/ 的/ 概率/ ,/ 其中/ m/ 是/ 指/ 求和/ 变量/ 个数/ ./ 由/ 已知/ 得/ :/ m/ =/ 2/ 时/ ,/ / α/ ,/ β/ ∈/ / 2n/ \/ {/ 0/ }/ ,/ Prob2/ [/ α/ →/ / / S/ β/ ]/ / p/ ,/ 其中/ Prob2/ [/ α/ →/ / / S/ β/ ]/ 指/ 的/ 是/ S/ 盒/ 的/ 差分/ 特征/ 概率/ ./ 下面/ 证明/ 求和/ 变量/ 个数/ m/ >/ 2/ 时/ ,/ / α/ ,/ β/ ∈/ / 2n/ ,/ Probm/ [/ α/ →/ / / S/ β/ ]/ / p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ (/ 1/ )/ m/ =/ 2/ 时/ ,/ 由/ 已知/ 得/ (/ 2/ )/ m/ =/ 3/ 时/ ,/ / α/ ,/ β/ ∈/ / 2n/ \/ {/ 0/ }/ ,/ α/ ,/ β/ ≠/ 0/ [/ α/ →/ / / S/ β/ ]/ Prob2/ =/ #/ {/ (/ a0/ ,/ a1/ )/ ∈/ / =/ 2/ -/ n/ ·/ #/ {/ (/ a0/ ,/ a1/ )/ ∈/ / S/ (/ a0/ )/ / S/ (/ a1/ )/ =/ β/ }/ / p/ ./ / (/ α/ ,/ β/ )/ ∈/ / β/ ≠/ S/ (/ α/ )/ [/ α/ →/ / / S/ β/ ]/ Prob3/ =/ #/ {/ (/ a0/ ,/ a1/ ,/ a2/ )/ |/ a0/ / a1/ / a2/ =/ α/ ,/ S/ (/ a0/ )/ / S/ (/ a1/ )/ / S/ (/ a2/ )/ =/ β/ }/ =/ 2/ -/ 2n/ ·/ ∑/ 2n/ -/ 1S/ (/ a0/ )/ / S/ (/ a1/ )/ =/ β/ / S/ (/ a2/ )/ }/ =/ 2/ -/ 2n/ ·/ ∑/ 2n/ -/ 1/ / 2/ -/ 2n/ ·/ 2n/ ·/ 2n/ ·/ p/ =/ p/ </ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ / (/ α/ ,/ β/ )/ ∈/ {/ (/ α/ ,/ β/ )/ ∈/ / β/ =/ S/ (/ α/ )/ [/ α/ →/ / / S/ β/ ]/ Prob3/ =/ 2/ -/ 2n/ ·/ ∑/ 2n/ -/ 1S/ (/ a0/ )/ / S/ (/ a1/ )/ =/ β/ / S/ (/ a2/ )/ }/ =/ 2/ -/ 2n/ (/ ·/ ∑/ a2/ ≠/ α/ S/ (/ a0/ )/ / S/ (/ a1/ )/ =/ β/ / S/ (/ a2/ )/ }/ +#/ {/ (/ a0/ ,/ a1/ )/ ∈/ / / 2/ -/ 2n/ ·/ (/ (/ 2n/ -/ 1/ )/ ·/ 2n/ ·/ p/ +/ 2n/ )/ =/ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ 因此/ ,/ m/ =/ 3/ 时/ ,/ / α/ ,/ β/ ∈/ / 2n/ ,/ Prob3/ [/ α/ →/ / / S/ β/ ]/ / p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ 成立/ ./ / α/ ,/ β/ ∈/ / 2n/ ,/ Probm/ -/ 1/ [/ α/ →/ / / S/ β/ ]/ / p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ,/ 那么/ 求和/ 变量/ 个数/ 为/ m/ 时/ ,/ 有/ / α/ ,/ β/ ∈/ / 2n/ ,/ Probm/ [/ α/ →/ / / S/ β/ ]/ {/ #/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ ∈/ / =/ (/ 3/ )/ 假设/ m/ -/ 1/ 时/ 定理/ 成立/ ,/ 即/ =/ 2/ -/ n/ (/ m/ -/ 1/ )/ ·/ ∑/ 2n/ -/ 1/ ∑/ m/ -/ 1i/ =/ 0Page4/ =/ 2/ -/ n/ (/ m/ -/ 1/ )/ ∑/ 2n/ -/ 1Probm/ -/ 1/ [/ α/ / am/ -/ 1/ →/ / / S/ β/ / S/ (/ am/ -/ 1/ )/ ]/ / 2/ -/ n/ (/ m/ -/ 1/ )/ ·/ 2n/ ·/ 2n/ (/ m/ -/ 2/ )/ ·/ (/ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ )/ =/ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ 综上所述/ ,/ 如果/ 一个/ n/ ×/ nS/ 盒/ 的/ 任意/ 非零/ 差分/ 特征/ 概率/ 均/ 不/ 大于/ p/ ,/ 那么/ 任意/ 积分/ 特征/ 概率/ 也/ 不/ 大于/ p/ +/ 2/ -/ n/ (/ 1/ -/ p/ )/ ./ 由/ 定理/ 1/ 我们/ 得到/ :/ 如果/ 一个/ S/ 盒/ 的/ 差分/ 均匀/ 性/ δ/ 与/ 随机/ 概率/ pr/ =/ 2/ -/ n/ 很/ 接近/ ,/ 那么/ S/ 盒/ 的/ 任意/ 积分/ 均匀/ 性/ 也/ 与/ 随机/ 概率/ 很/ 接近/ ,/ 该/ 算法/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 能力/ 也/ 就/ 越强/ ./ 这个/ 证明/ 也/ 从/ 一个/ 侧面/ 反应/ 了/ 概率/ 积分/ 分析/ 和/ 差分/ 分析/ 的/ 联系/ ./ 差分/ 分析/ 关注/ 的/ 是/ 两个/ 中间状态/ 的/ 异或/ 值/ ,/ 而/ 概率/ 积分/ 分析/ 关注/ 的/ 是/ 多个/ 中间状态/ 的/ 异或/ 值/ ./ 因为/ S/ 盒/ 的/ m/ 次/ 积分/ 特征/ 概率/ 是/ 多个/ m/ -/ 1/ 次/ 积分/ 特征/ 概率/ 的/ 均值/ ,/ 因此/ 当/ 求和/ 变量/ 个数/ 增大/ 时/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ./ 下面/ 我们/ 用/ 实验/ 验证/ 这一/ 观察/ ./ 3.2/ S/ 盒/ 积分/ 特征/ 概率/ 随/ 求和/ 变量/ 个数/ 的/ 变化/ 从/ 3.1/ 节/ 的/ 证明/ 过程/ 我们/ 可以/ 看出/ :/ 当/ 求和/ 变量/ 个数/ 增大/ 时/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ./ 这/ 一节/ 分别/ 以/ AES/ 的/ 8/ ×/ 8S/ 盒/ 、/ LBlock/ 的/ 4/ ×/ 4S/ 盒为例/ 验证/ 这一/ 观察/ ./ 图/ 1/ 表示/ AES/ 中/ S/ 盒/ 积分/ 均匀/ 性随/ 求和/ 变量/ 个数/ 的/ 变化规律/ ./ 横坐标/ 表示/ 求和/ 变量/ 个数/ m/ ,/ 纵坐标/ 表示/ m/ 次/ 积分/ 均匀/ 性/ ./ 从图/ 1/ 可以/ 看出/ :/ 对于/ AES/ 的/ S/ 盒/ ,/ 当/ 求和/ 变量/ 个数/ 增大/ 时/ ,/ 积分/ 均匀/ 性/ 趋近/ 于/ 随机/ 概率/ pr/ ,/ 在/ 这里/ pr/ =/ 2/ -/ 8/ ./ 实验/ 数据/ 显示/ ,/ 当/ m/ / 11/ 时/ ,/ m/ 次/ 积分/ 均匀/ 性/ 与/ 2/ -/ 8/ 的/ 差距/ 小于/ 10/ -/ 24/ ./ 图/ 1AES/ 中/ S/ 盒/ 的/ 积分/ 均匀/ 性随/ 求和/ 变量/ 个数/ 的/ 变化/ 图/ 2/ 表示/ LBlock/ 中/ S/ 盒/ 积分/ 均匀/ 性随/ 求和/ 变量/ 个数/ 增长/ 的/ 变化规律/ ./ 图/ 2/ 只/ 显示/ 了/ LBlock/ 加密算法/ 中/ 一个/ S/ 盒/ S5/ 的/ 积分/ 均匀/ 性随/ 求和/ 变量/ 个数/ 增长/ 的/ 变化/ 情况/ ,/ 其余/ 7/ 个/ S/ 盒/ 积分/ 均匀/ 性/ 的/ 变化/ 情况/ 类似/ ./ 从图/ 2/ 可以/ 看出/ :/ 对于/ LBlock/ 的/ S/ 盒/ S5/ ,/ 当/ 求和/ 变量/ 个数/ 增大/ 时/ ,/ 积分/ 均匀/ 性/ 趋近/ 于/ 随机/ 概率/ pr/ ,/ 在/ 这里/ pr/ =/ 2/ -/ 4/ ./ 实验/ 数据/ 显示/ ,/ 当/ m/ / 29/ 时/ ,/ 对于/ 任意/ 加密算法/ 中/ 的/ S/ 盒/ Si/ (/ 0/ / i/ / 7/ )/ ,/ m/ 次/ 积分/ 均匀/ 性/ 与/ 2/ -/ 4/ 的/ 差距/ 小于/ 10/ -/ 24/ ./ 图/ 2LBlock/ 中/ S/ 盒/ 的/ 积分/ 均匀/ 性随/ 求和/ 变量/ 个数/ 的/ 变化/ 由/ 实验/ 我们/ 可以/ 得到/ :/ 对于/ AES/ 和/ LBlock/ 的/ S/ 盒/ ,/ 当/ 求和/ 变量/ 个数/ 增大/ 时/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ./ 实际上/ ,/ 现在/ 绝大多数/ 采用/ S/ 盒/ 的/ 分组/ 密码/ 算法/ ,/ 抵抗/ 概率/ 积分/ 分析/ 的/ 能力/ 都/ 很/ 强/ ,/ 因为/ :/ (/ 1/ )/ 现代/ 分组/ 密码/ 算法/ 设计/ 时/ ,/ 要求/ S/ 盒/ 必须/ 具有/ 良好/ 的/ 差分/ 均匀/ 性/ ;/ (/ 2/ )/ S/ 盒/ 的/ m/ 次/ 积分/ 特征/ 概率/ 是/ 多个/ m/ -/ 1/ 次/ 积分/ 特征/ 概率/ 的/ 均值/ ./ 所以/ ,/ 如果/ S/ 盒/ 的/ 均匀/ 性越/ 好/ ,/ 求和/ 变量/ 个数/ m/ 越大/ ,/ 那么/ S/ 盒/ 的/ m/ 次/ 积分/ 特征/ 概率/ 就/ 越/ 接近/ 随机/ 概率/ pr/ ,/ 利用/ 此/ 概率/ 积分/ 特征/ 构造/ 的/ 区分/ 器/ 就/ 越/ 难/ 把/ 密码/ 算法/ 和/ 随机/ 置换/ 区分/ 开/ ./ 由于/ 同样/ 的/ 原因/ ,/ 高阶/ 积分/ 分析/ 的/ 某些/ 技巧/ 对于/ 概率/ 积分/ 分析/ 是/ 行不通/ 的/ ,/ 这/ 一点/ 将/ 在/ 下/ 一节/ 的/ 实例/ 中/ 详细/ 阐述/ ./ 4AES/ 、/ LBlock/ 的/ 概率/ 积分/ 密码/ 分析/ 这/ 一节/ 通过/ 对/ AES/ 、/ LBlock/ 进行/ 概率/ 积分/ 密码/ 分析/ ,/ 说明/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 是/ 免疫/ 的/ ./ 4.1/ 计算/ 积分/ 特征/ 概率/ 在/ 差分/ 密码/ 分析/ 中/ ,/ 我们/ 假设/ 每一/ 轮子/ 密钥/ 统计/ 独立/ 且/ 均匀分布/ ;/ 在/ 概率/ 积分/ 密码/ 分析/ 中/ ,/ 对于/ 积/ Page5/ 分/ 特征/ Ω/ =/ α/ 0/ ,/ α/ 1/ ,/ …/ ,/ α/ r/ ,/ 我们/ 给出/ 以下/ 假设/ ./ 假设/ 1/ ./ 对于/ 任意/ 一个/ 满足/ 输入/ 积分/ 特征/ α/ 0/ 的/ 结构/ T0/ ,/ 经过/ i/ (/ i/ / 1/ )/ 轮/ 加密/ 得到/ 第/ i/ +/ 1/ 轮/ 的/ 输入/ 结构/ Ti/ ,/ 我们/ 把/ 这个/ 积分/ 特征/ 中/ 满足/ α/ i/ 的/ Ti/ 组成/ 的/ 空间/ 记作/ Space/ Ω/ i/ (/ α/ i/ )/ ;/ 另外/ ,/ 把/ 任意/ 满足/ α/ i/ 的/ 结构/ 组成/ 的/ 空间/ 记作/ Space/ (/ α/ i/ )/ ./ 假设/ 条件/ 概率/ ProbTi/ ,/ ki/ +/ 1ProbTi/ ,/ ki/ +/ 1/ 其中/ ki/ +/ 1/ 表示/ 第/ i/ +/ 1/ 轮/ 的/ 子/ 密钥/ ,/ Fki/ +/ 1/ 表示/ 第/ i/ +/ 1/ 轮/ 的/ 轮/ 函数/ ./ 这个/ 假设/ 比子/ 密钥/ 独立/ 均匀/ 的/ 假设/ 强/ ./ 在/ 对/ 任何/ 一个/ 算法/ 进行/ 概率/ 积分/ 密码/ 分析/ 时/ ,/ 都/ 有/ 必要/ 验证/ 假设/ 1/ 的/ 正确性/ ./ 在/ 假设/ 1/ 下/ ,/ 计算/ 积分/ 特征/ 概率/ 的/ 问题/ 可以/ 归约/ 到/ 计算/ S/ 盒/ 的/ 积分/ 特征/ 概率/ ./ 因为/ 对于/ 任意/ 一个/ 线性变换/ P/ :/ x/ →/ P/ ·/ x/ ,/ 给定/ 输入/ 积分/ 特征/ α/ ,/ 易得/ 输出/ 积分/ 特征/ β/ =/ P/ ·/ α/ 以/ 概率/ 1/ 成立/ ./ 所以/ 计算/ 积分/ 特征/ 概率/ 的/ 问题/ 可以/ 归约/ 到/ 计算/ S/ 盒/ 的/ m/ 次/ 积分/ 特征/ 概率/ Probm/ [/ Vx/ →/ SVy/ ]/ ,/ x/ ,/ y/ ∈/ / 2n/ ./ 下面/ 我们/ 用/ 归纳/ 的/ 方法/ 给出/ 一个/ 计算/ Probm/ [/ Vx/ →/ SVy/ ]/ 的/ 一般/ 方法/ :/ 构造/ 表/ {/ Tmx/ ,/ y/ }/ ,/ 0/ / x/ ,/ y/ / 2n/ -/ 1/ ,/ 其中/ m/ 指/ 求和/ 的/ 变量/ 个数/ ./ (/ 1/ )/ 令/ m/ =/ 2/ ,/ 计算/ 表/ {/ T2x/ ,/ y/ }/ (/ 0/ / x/ ,/ y/ / 2n/ -/ 1/ )/ :/ T2x/ ,/ y/ =/ 2/ -/ n/ ·/ #/ {/ (/ a0/ ,/ a1/ )/ |/ a0/ / a1/ =/ x/ ,/ S/ (/ a0/ )/ / (/ a1/ )/ =/ y/ ,/ ai/ ∈/ / 2n/ ,/ 0/ / i/ / 1/ }/ ,/ 实际上/ 这/ 就是/ S/ 盒/ 的/ 差分/ 分布/ 表/ ./ (/ 2/ )/ 假设/ 已经/ 计算/ 得到/ 求和/ 变量/ 个数/ 为/ m/ -/ 1/ 的/ 表/ {/ Tm/ -/ 1x/ ,/ y/ }/ (/ 0/ / x/ ,/ y/ / 2n/ -/ 1/ )/ :/ Tm/ -/ 1x/ ,/ y/ =/ 2/ -/ n/ (/ m/ -/ 1/ )/ ·/ {/ #/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 2/ )/ 那么/ 由/ {/ Tm/ -/ 1x/ ,/ y/ }/ 可以/ 得到/ {/ Tmx/ ,/ y/ }/ :/ Tmx/ ,/ y/ =/ 2/ -/ nm/ ·/ {/ #/ (/ a0/ ,/ a1/ ,/ …/ ,/ am/ -/ 1/ )/ i/ =/ 0/ ∑/ m/ -/ 1/ =/ 2/ -/ nm/ ∑/ 2n/ -/ 1/ ∑/ m/ -/ 2/ =/ 2/ -/ nm/ ·/ 2n/ (/ m/ -/ 1/ )/ ∑/ 2n/ -/ 1/ =/ 2/ -/ n/ ∑/ 2n/ -/ 1i/ =/ 04.2/ 对/ AES/ 的/ 概率/ 积分/ 密码/ 分析/ 在/ 这/ 一节/ 里/ ,/ 我们/ 先/ 在/ 假设/ 1/ 的/ 条件/ 下/ 对/ AES/ 进行/ 概率/ 积分/ 密码/ 分析/ ,/ 然后/ 通过/ 实验/ 验证/ 假设/ 1/ 的/ 正确性/ ./ AES/ 是/ SP/ 结构/ 的/ 分组/ 密码/ ,/ 明文/ 分块/ 为/ 128bit/ 、/ 192bit/ 和/ 256bit/ ./ 本文/ 只/ 考虑/ 对/ AES/ -/ 128/ 的/ 概率/ 积分/ 分析/ ./ 我们/ 将/ 利用/ 文献/ [/ 6/ ]/ 中/ 概率/ 为/ 1/ 的/ 积分/ 特征/ ./ 在/ 这个/ 概率/ 为/ 1/ 的/ 积分/ 特征/ 中/ ,/ 输入/ 积分/ 特征/ 由/ 1/ 个/ 活跃/ 字节/ A/ 和/ 15/ 个/ 稳定/ 字节/ C/ 组成/ ;/ 经过/ 第/ 1/ 轮轮/ 函数/ 的/ 作用/ ,/ 变为/ 1/ 列/ 4/ 个/ 活跃/ 字节/ A/ 和/ 3/ 列/ 12/ 个/ 稳定/ 字节/ C/ ;/ 经过/ 第/ 2/ 轮轮/ 函数/ 的/ 作用/ ,/ 全部/ 变成/ 16/ 个/ 活跃/ 字节/ A/ ;/ 经过/ 第/ 3/ 轮轮/ 函数/ 的/ 作用/ ,/ 全部/ 变成/ 16/ 个/ 稳定/ 字节/ B/ ;/ 经过/ 第/ 4/ 轮子/ 密钥/ 异或/ ,/ 得到/ 16/ 个/ 稳定/ 字节/ B/ ./ 接下来/ 我们/ 考虑/ 在/ 概率/ 为/ 1/ 积分/ 特征/ 的/ 基础/ 上/ ,/ 向/ 后加/ 一轮/ ,/ 再/ 利用/ 高阶/ 积分/ 分析/ 的/ 技巧/ 向前/ 加/ 几轮/ ,/ 构成/ 概率/ p/ </ 1/ 的/ 积分/ 特征/ ./ 先/ 考虑/ 向/ 后加/ 一轮/ ./ 经过/ 第/ 4/ 轮/ S/ 盒/ 的/ 变换/ ,/ 设/ 其中/ 一个/ 字节/ 的/ 积分/ 特征/ 为/ Vx/ ,/ 令/ px/ =/ Prob/ [/ B/ →/ / / SVx/ ]/ ,/ 易知/ p/ Ω/ =/ p/ ./ 在/ 假设/ 1/ 的/ 条件/ 下/ ,/ 由/ 3.1/ 节/ 的/ 实验/ 数据/ 得/ :/ 当/ m/ / 11/ 时/ ,/ AES/ 的/ S/ 盒/ m/ 次/ 积分/ 均匀/ 性/ 与/ 2/ -/ 8/ 的/ 差距/ 小于/ 10/ -/ 24/ ./ 因为/ 在/ 假设/ 1/ 的/ 条件/ 下/ ,/ px/ =/ Prob/ [/ B/ →/ / / SVx/ ]/ 又/ 由/ 积分/ 均匀/ 性/ 的/ 定义/ 得/ |/ px/ -/ 2/ -/ 8/ |/ / |/ δ/ 28/ 这里/ 求和/ 变量/ 个数/ m/ =/ 28/ >/ 11/ ,/ 所以/ 我们/ 有/ |/ px/ -/ 2/ -/ 8/ |/ / |/ δ/ 28/ 这样/ 的/ 概率/ 积分/ 特征/ 构成/ 的/ 区分/ 器/ 无效/ ./ 再/ 考虑/ 使用/ 文献/ [/ 6/ ]/ 中/ 的/ 方法/ ,/ 利用/ 高阶/ 积分/ 分析/ 的/ 技巧/ 向前/ 加/ 轮数/ —/ —/ —/ 通过/ 增加/ 输入/ 积分/ 特征/ 中/ 活跃/ 字节/ 的/ 个数/ ,/ 增加/ 积分/ 特征/ 的/ 轮数/ ./ 但是/ 这个/ 方法/ 在/ 概率/ 积分/ 分析/ 中/ 行不通/ ,/ 因为/ 增加/ 输入/ 积分/ 特征/ 中/ 活跃/ 字节/ 的/ 个数/ k/ ,/ 必然/ 导致/ 求和/ 变量/ 个数/ m/ =/ 28/ ·/ k/ 增加/ ./ 在/ 假设/ 1/ 的/ 条件/ 下/ ,/ 随着/ m/ 的/ 增大/ ,/ 积分/ 特征/ 概率/ p/ 趋近/ 于/ 随机/ 概率/ pr/ =/ 2/ -/ 8/ ./ 实验/ 数据/ 显示/ ,/ 对/ AES/ 的/ S/ 盒/ ,/ 当/ m/ / 11/ 时/ ,/ m/ 次/ 积分/ 均匀/ 性/ 与/ 2/ -/ 8/ 的/ 差距/ 小于/ 10/ -/ 24/ ./ 当/ 输入/ 积分/ 特征/ 中/ 活跃/ 字节/ 个数/ k/ / 1/ 时/ ,/ 求和/ 变量/ 个数/ m/ / 28/ ,/ m/ 次/ 积分/ 均匀/ 性/ 几乎/ 与/ 2/ -/ 4/ 相等/ ,/ 利用/ 这样/ 的/ 概率/ 积分/ 特征/ 构造/ 的/ 区分/ 器/ 无效/ ./ Page6/ 我们/ 通过/ 实验/ 验证/ 了/ 假设/ 1/ 在/ AES/ 中/ 的/ 正确性/ ./ 随机/ 选取/ 1000/ 个/ 密钥/ 、/ 1000/ 个/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ ,/ 用/ AES/ 加密/ ./ 对于/ 每/ 一个/ 结构/ ,/ 在/ 经过/ 第/ 4/ 轮/ 第一个/ S/ 盒后/ ,/ 对/ 这个/ 结构/ 中/ 所有/ 中间/ 状态值/ 求和/ 得到/ x/ ./ 我们/ 对/ 所有/ 的/ x/ 做/ 统计/ ,/ 得到/ 的/ 实验/ 结果/ 与/ 我们/ 在/ 假设/ 1/ 的/ 条件/ 下/ 得到/ 的/ 理论/ 结果/ 吻合/ ,/ 证明/ 了/ 假设/ 1/ 对/ AES/ 算法/ 的/ 正确性/ ./ 综上所述/ ,/ AES/ 对/ 概率/ 积分/ 密码/ 分析/ 是/ 免疫/ 的/ ./ 4.3/ 对/ LBlock/ 的/ 概率/ 积分/ 密码/ 分析/ 在/ 这/ 一节/ 里/ ,/ 我们/ 对/ LBlock/ 进行/ 概率/ 积分/ 密码/ 分析/ ,/ 在/ 这/ 之前/ ,/ 我们/ 先/ 验证/ 假设/ 1/ 的/ 正确性/ ./ LBlock/ 是/ Feistel/ 结构/ 的/ 轻量级/ 分组/ 密码/ ,/ 由/ 32/ 轮/ 迭代/ 算法/ 组成/ ,/ 明文/ 分块/ 为/ 64bit/ ,/ 密钥/ 为/ 80bit/ ./ 本文/ 沿用/ LBlock/ 设计/ 文档/ [/ 16/ ]/ 中/ 的/ 记号/ ./ 4.3/ ./ 1/ 验证/ 假设/ 1/ 对于/ 任意/ 一个/ 给定/ 的/ LBlock/ 的/ 积分/ 特征/ ,/ 我们/ 先/ 在/ 假设/ 1/ 的/ 条件/ 下/ 给出/ 相应/ 的/ 概率分布/ ,/ 再/ 在/ 实际/ 情况/ 下/ 给出/ 相应/ 的/ 概率分布/ ,/ 然后/ 用/ 统计/ 方法/ 检验/ 这/ 两个/ 分布/ 的/ 拟合/ 程度/ ./ 这里/ 只/ 详细/ 阐述/ 对/ 一个/ 积分/ 特征/ 验证/ 假设/ 1/ 的/ 过程/ ,/ 其余/ 积分/ 特征/ 的/ 验证/ 过程/ 类似/ ./ 在/ 概率/ 为/ 1/ 的/ 9/ 轮/ 积分/ 特征/ 后加/ 1/ 轮/ ,/ 构成/ 一个/ 10/ 轮/ LBlock/ 概率/ 积分/ 特征/ ./ 图/ 3/ (/ a/ )/ 与/ LBlock/ 设计/ 文档/ 中/ 给出/ 的/ 9/ 轮/ 积分/ 特征/ 稍/ 有/ 不同/ ./ 图/ 3/ (/ b/ )/ 是/ 本文/ 给出/ 的/ 10/ 轮/ 积分/ 特征/ 中/ 的/ 9/ ~/ 10/ 轮/ ,/ 1/ ~/ 8/ 轮/ 与/ 图/ 3/ (/ a/ )/ 的/ 1/ ~/ 8/ 轮/ 积分/ 特征/ 一样/ ./ 在/ 这个/ 10/ 轮/ LBlock/ 积分/ 特征/ 中/ ,/ 1/ ~/ 8/ 轮/ 的/ 概率/ 为/ 1/ ./ 在/ 第/ 9/ 轮中/ ,/ S5/ 的/ 输入/ 积分/ 特征/ 为/ B/ ,/ 令/ S5/ 的/ 输出/ 积分/ 特征/ 为/ Vx/ ,/ 则/ 第/ 10/ 轮/ 的/ 输出/ 积分/ 特征/ 中有/ 一个半/ 字节/ 为/ Vx/ ,/ 这/ 就/ 构成/ 了/ 一个/ 10/ 轮/ 概率/ 积分/ 特征/ ./ 我们/ 记/ px/ =/ Prob/ [/ BS/ →/ / / 5Vx/ ]/ ,/ 易知/ 这个/ 10/ 轮/ 积分/ 特征/ 的/ 概率/ 为/ px/ ./ 下面/ 考虑/ 在/ 没有/ 假设/ 的/ 条件/ 下/ 积分/ 特征/ 概率/ p/ / x/ 的/ 分布/ ./ 第/ i/ 轮/ 的/ 输出/ 为/ (/ Xi/ +/ 1/ ,/ Xi/ )/ ,/ 其中/ Xi/ =/ Xi/ ,/ 7/ ‖/ Xi/ ,/ 6/ ‖/ …/ ‖/ Xi/ ,/ 1/ ‖/ Xi/ ,/ 0/ ./ 第/ i/ 轮轮/ 函数/ F/ 的/ 输出/ 为/ Ui/ ,/ Ui/ =/ Ui/ ,/ 7/ ‖/ Ui/ ,/ 6/ ‖/ …/ ‖/ Ui/ ,/ 1/ ‖/ Ui/ ,/ 0/ ./ 由/ 加密算法/ 得/ U9/ ,/ 4/ =/ S5/ (/ X9/ ,/ 5/ / K9/ ,/ 5/ )/ ,/ X9/ ,/ 5/ =/ U8/ ,/ 5/ / X7/ ,/ 3/ ,/ U8/ ,/ 5/ =/ S7/ (/ X8/ ,/ 7/ / K8/ ,/ 7/ )/ X7/ ,/ 3/ =/ S2/ (/ S0/ (/ S1/ (/ X0/ ,/ 5/ / W3/ )/ / W4/ )/ / W5/ )/ / W6/ ,/ 其中/ ,/ 当/ 密钥/ 固定/ 时/ ,/ Wi/ (/ 0/ / i/ / 6/ )/ 是/ 明文/ Xi/ 的/ 函数/ :/ =/ S7/ (/ S7/ (/ S7/ (/ X0/ ,/ 5/ / W0/ )/ / W1/ )/ / W2/ )/ ,/ Page7W0/ =/ W0/ (/ X1/ ,/ 6/ )/ ,/ W1/ =/ W1/ (/ X0/ ,/ 2/ ,/ X0/ ,/ 3/ ,/ X1/ ,/ 2/ ,/ X1/ ,/ 3/ ,/ X1/ ,/ 5/ ,/ X1/ ,/ 7/ )/ ,/ W2/ =/ W2/ (/ X0/ ,/ 0/ ,/ X0/ ,/ 1/ ,/ X0/ ,/ 2/ ,/ X0/ ,/ 3/ ,/ X0/ ,/ 4/ ,/ X0/ ,/ 6/ ,/ X0/ ,/ 7/ ,/ X1/ ,/ 0/ ,/ X1/ ,/ 1/ ,/ X1/ ,/ 2/ ,/ X1/ ,/ 3/ ,/ X1/ ,/ 4/ ,/ X1/ ,/ 5/ ,/ X1/ ,/ 6/ ,/ X1/ ,/ 7/ )/ ,/ W3/ =/ W3/ (/ X0/ ,/ 0/ ,/ X1/ ,/ 0/ ,/ X1/ ,/ 1/ ,/ X1/ ,/ 6/ )/ ,/ W4/ =/ W4/ (/ X0/ ,/ 2/ ,/ X1/ ,/ 4/ ,/ X1/ ,/ 5/ )/ ,/ W5/ =/ W5/ (/ X0/ ,/ 1/ ,/ X0/ ,/ 4/ ,/ X1/ ,/ 2/ ,/ X1/ ,/ 4/ ,/ X1/ ,/ 7/ )/ ,/ W6/ =/ W6/ (/ X0/ ,/ 4/ ,/ X0/ ,/ 6/ ,/ X0/ ,/ 7/ ,/ X1/ ,/ 0/ ,/ X1/ ,/ 1/ ,/ X1/ ,/ 3/ ,/ 容易/ 证明/ ,/ 当/ 明文/ 独立/ 、/ 均匀/ 随机/ 选取/ 时/ ,/ 对/ 任意/ 固定/ 密钥/ ,/ Wi/ (/ 0/ / i/ / 6/ )/ 都/ 是/ 均匀/ 随机/ 独立/ 的/ 变量/ ,/ 因此/ 有/ X1/ ,/ 4/ ,/ X1/ ,/ 5/ )/ ./ 根据/ 积分/ 特征/ 概率/ 的/ 定义/ ,/ p/ / x/ =/ Prob/ [/ BS/ →/ / / 5Vx/ ]/ 把/ px/ 的/ 分布/ 与/ p/ / x/ 的/ 分布/ 做/ 比较/ ,/ 得到/ 图/ 4/ ./ 为了/ 检测/ p/ 和/ p/ / 的/ 拟合/ 程度/ ,/ 我们/ 用/ 拟合/ 优度/ 测试/ 得/ χ/ 2/ (/ p/ ;/ p/ / )/ =/ 24/ ∑/ x/ ∈/ / 24/ 从/ 测试/ 结果/ 我们/ 可以/ 看出/ ,/ 在/ 假设/ 1/ 的/ 条件/ 下/ 积分/ 特征/ 概率/ 的/ 分布/ p/ 和/ 没有/ 任何/ 假设/ 条件/ 下/ 的/ 分布/ p/ / 十分/ 接近/ ./ 我们/ 对/ LBlock/ 的/ 其它/ 积分/ 特征/ 也/ 做/ 了/ 检验/ ,/ 结果/ 都/ 验证/ 了/ 假设/ 1/ 的/ 正确性/ ./ 因此/ 假设/ 1/ 对/ LBlock/ 算法/ 是/ 合理/ 的/ ./ 4.3/ ./ 2/ 对/ 16/ 轮/ LBlock/ 的/ 概率/ 积分/ 密码/ 分析/ 在/ 这/ 一节/ 里/ ,/ 我们/ 在/ 概率/ 为/ 1/ 的/ 积分/ 特征/ 的/ 基础/ 上/ ,/ 向/ 后加/ 两轮/ ,/ 再/ 利用/ 高阶/ 积分/ 分析/ 的/ 技巧/ 向前/ 加/ 几轮/ ,/ 构成/ 概率/ p/ </ 1/ 的/ 积分/ 特征/ ;/ 然后/ 利用/ 这个/ 积分/ 特征/ 构造/ 区分/ 器/ ,/ 对/ 16/ 轮/ LBlock/ 做/ 恢复/ 密钥/ 攻击/ ;/ 最后/ 把/ 概率/ 积分/ 密码/ 分析/ 的/ 复杂度/ 与/ 传统/ 积分/ 分析/ 作/ 比较/ ,/ 证明/ LBlock/ 对/ 概率/ 积分/ 密码/ 分析/ 是/ 免疫/ 的/ ./ 先向/ 后加/ 两轮/ ,/ 见图/ 5/ ./ 图/ 5/ 是/ 本文/ 给出/ 的/ 11/ 轮/ 积分/ 特征/ 中/ 的/ 8/ ~/ 11/ 轮/ ,/ 1/ ~/ 7/ 轮/ 与/ 图/ 3/ (/ a/ )/ 的/ 1/ ~/ 7/ 轮/ 积分/ 特征/ 一样/ ./ 这个/ 积分/ 特征/ 是/ 我们/ 能/ 找到/ 的/ 概率/ 最大/ 的/ 积分/ 特征/ ,/ 其/ 概率/ p/ Ω/ =/ p3/ +/ (/ 1/ -/ p3/ )/ pr/ ≈/ 2/ -/ 3.9992/ ×/ 3/ +/ 2/ -/ 4/ ,/ 其中/ p3/ 表示/ 一个/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ 加密/ 时/ ,/ 满足/ 每/ 一轮/ 输出/ 积分/ 特征/ 的/ 概率/ ;/ (/ 1/ -/ p3/ )/ pr/ 表示/ 一个/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ 加密/ 时/ ,/ 不/ 满足/ 所有/ 中间/ 轮/ 输出/ 积分/ 特征/ 的/ 概率/ 、/ 满足/ 最后/ 一轮/ 输出/ 积分/ 特征/ 的/ 概率/ ./ 利用/ 图/ 5/ 的/ 11/ 轮/ 积分/ 特征/ ,/ 我们/ 构造/ 11/ 轮/ 概率/ 积分/ 区分/ 器/ ,/ 对/ 16/ 轮/ LBlock/ 进行/ 恢复/ 密钥/ 攻击/ ./ 与/ 文献/ [/ 16/ ]/ 中/ 的/ 方法/ 完全/ 一样/ ,/ 我们/ 猜测/ 12/ ~/ 16/ 轮中/ 的/ 12/ 个/ 半/ 字节/ 密钥/ ,/ 对/ 每/ 一个/ 猜测/ 密钥/ 值/ 建立/ 一个/ 计数器/ ./ 随机/ 选择/ 24/ 个/ 明文/ 构成/ 一个/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ ,/ 经过/ 16/ 轮/ 加密/ ,/ 得到/ 相应/ 的/ 24/ 个/ 密文/ ./ 用/ 每/ 一个/ 猜测/ 密钥/ 值/ 对/ 24/ 个/ 密文/ 进行/ 部分/ 解密/ ,/ 得到/ 第/ 11/ 轮/ 的/ 输出/ 值/ X11/ ,/ 5/ ,/ 检验/ 24/ 个/ X11/ ,/ 5/ 的/ 异或/ 之/ 和/ 是否/ 为/ 0/ ,/ 如果/ 为/ 0/ ,/ 则/ 相应/ 密钥/ 的/ 计数器/ 加/ 1/ ./ 再/ 随机/ 选/ 一个/ 满足/ 输入/ 积分/ 特征/ 的/ 结构/ ,/ 重复/ 以上/ 步骤/ ,/ 直到/ 某个/ 密钥/ 的/ 计数/ 远远/ 大于/ 其余/ 密钥/ 为止/ ,/ 这个/ 密钥/ 就是/ 我们/ 要/ 找/ 的/ 正确/ 密钥/ ./ 这样/ 就/ 恢复/ 了/ 48bit/ 密钥/ 值/ ,/ 剩下/ 的/ 比特/ 可以/ 通过/ 穷/ 搜/ 的/ 方法/ 得到/ ./ 对于/ 概率/ 为/ 2/ -/ 3.9992/ ×/ 3/ +/ 2/ -/ 4/ 的/ 积分/ 特征/ ,/ 用文/ Page8/ 献/ [/ 17/ ]/ 计算/ 复杂度/ 的/ 方法/ ,/ 攻击/ 成功/ 至少/ 需要/ 226.3/ 个/ 结构/ ,/ 成功/ 概率/ 是/ 0.99/ ./ 因此/ 对/ 16/ 轮/ LBlock/ 的/ 概率/ 积分/ 密码/ 分析/ 的/ 时间/ 复杂度/ 是/ 230.3/ ,/ 需要/ 存储/ 248/ 个/ 密钥/ 对应/ 的/ 计数器/ ,/ 其中/ 1/ 个/ 单位/ 时间/ 复杂度/ 是/ 指/ 运行/ 16/ 轮/ LBlock/ 加密算法/ 一次/ 需要/ 的/ 时间/ ./ 再/ 考虑/ 利用/ 高阶/ 积分/ 分析/ 的/ 技巧/ 向前/ 加/ 轮数/ ,/ 和/ 在/ AES/ 中/ 一样/ ,/ 这个/ 方法/ 在/ 概率/ 积分/ 分析/ 中/ 行不通/ ,/ 因为/ 向前/ 加/ 轮数/ 必然/ 会/ 使得/ 输入/ 积分/ 特征/ 中/ 活跃/ 字节/ 的/ 个数/ k/ 增加/ ,/ 进而/ 导致/ 求和/ 变量/ 个数/ m/ =/ 24/ ·/ k/ 增加/ ./ 在/ 假设/ 1/ 的/ 条件/ 下/ ,/ 随着/ m/ 的/ 增大/ ,/ 积分/ 特征/ 概率/ p/ 趋近/ 于/ 随机/ 概率/ pr/ =/ 2/ -/ 4/ ./ 实验/ 数据/ 显示/ ,/ 对/ LBlock/ 的/ S/ 盒/ Si/ (/ 0/ / i/ / 7/ )/ ,/ 当/ m/ / 29/ 时/ ,/ m/ 次/ 积分/ 均匀/ 性/ 与/ 2/ -/ 4/ 的/ 差距/ 小于/ 10/ -/ 24/ ./ 当/ 输入/ 积分/ 特征/ 中/ 活跃/ 字节/ 个数/ k/ / 2/ 时/ ,/ 求和/ 变量/ 个数/ m/ / 28/ ,/ m/ 次/ 积分/ 均匀/ 性/ 几乎/ 与/ 2/ -/ 4/ 相等/ ,/ 利用/ 这样/ 的/ 概率/ 积分/ 特征/ 构成/ 的/ 区分/ 器/ 无效/ ./ 因此/ 概率/ 积分/ 密码/ 分析/ 对/ LBlock/ 能/ 攻击/ 的/ 最大/ 轮数/ 是/ 16/ ,/ 时间/ 复杂度/ 为/ 230.3/ ;/ 而/ 传统/ 积分/ 密码/ 分析/ 对/ LBlock/ 能/ 攻击/ 的/ 最大/ 轮数/ 是/ 22/ ./ 由此看来/ ,/ 概率/ 积分/ 密码/ 分析/ 和/ 传统/ 积分/ 密码/ 分析/ 相比/ ,/ 攻击能力/ 较弱/ ./ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ ,/ 在/ 设计/ S/ 盒时/ ,/ 都/ 要求/ S/ 盒/ 必须/ 具有/ 良好/ 的/ 差分/ 均匀/ 性/ ,/ 并且/ 在/ 算法/ 的/ 安全性/ 评估/ 中/ ,/ 都/ 考虑/ 了/ 算法/ 抵抗/ 传统/ 积分/ 密码/ 分析/ 的/ 强度/ ./ 因此/ 我们/ 在/ 概率/ 为/ 1/ 积分/ 特征/ 的/ 基础/ 上/ ,/ 构造/ 的/ 积分/ 特征/ 的/ 概率/ 和/ 随机/ 概率/ 很/ 接近/ ./ 利用/ 这样/ 的/ 概率/ 积分/ 特征/ 构造/ 的/ 区分/ 器/ ,/ 能够/ 攻击/ 的/ 轮数/ 也/ 小于/ 传统/ 积分/ 特征/ ./ 总的来说/ ,/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 是/ 免疫/ 的/ ./ 5/ 结论/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 分组/ 密码/ 攻击/ 方法/ —/ —/ —/ 概率/ 积分/ 密码/ 分析/ ./ 通过/ 理论/ 和/ 实验/ 两/ 方面/ 的/ 研究/ ,/ 验证/ 了/ 概率/ 积分/ 分析方法/ 的/ 有效性/ ./ 对于/ 采用/ S/ 盒/ 设计/ 的/ 分组/ 密码/ ,/ 本文/ 的/ 研究/ 从/ 一个/ 侧面/ 反映/ 了/ 概率/ 积分/ 密码/ 分析/ 与/ 差分/ 密码/ 分析/ 的/ 关系/ :/ 如果/ S/ 盒/ 的/ 差分/ 均匀/ 性越/ 接近/ 随机/ 概率/ ,/ 则/ 分组/ 密码/ 抵抗/ 概率/ 积分/ 密码/ 分析/ 的/ 能力/ 就/ 越强/ ./ 并且/ ,/ 本文/ 指出/ :/ 高阶/ 积分/ 分析/ 的/ 某些/ 技巧/ 对于/ 概率/ 积分/ 分析/ 是/ 行不通/ 的/ ,/ 主要/ 原因/ 是/ 随着/ 求和/ 变量/ 个数/ 的/ 增加/ ,/ 积分/ 特征/ 概率/ 趋近/ 于/ 随机/ 概率/ ./ 通过/ 对/ AES/ 、/ LBlock/ 的/ 概率/ 积分/ 分析/ ,/ 说明/ 目前/ 广泛/ 使用/ 的/ 分组/ 密码/ 算法/ 对于/ 概率/ 积分/ 密码/ 分析方法/ 是/ 免疫/ 的/ ./ 

