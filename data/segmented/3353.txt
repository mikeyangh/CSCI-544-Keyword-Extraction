Page1CFD/ 非/ 结构化/ 网/ 格格/ 心/ 格式/ 数据/ 高质量/ 体/ 绘制/ 方法/ 马/ 千里/ 1/ )/ 李思昆/ 1/ )/ 白晓征/ 2/ )/ 程志/ 全/ 1/ )/ 徐华勋/ 1/ )/ 1/ )/ (/ 国防科学技术大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 2/ )/ (/ 国防科学技术大学/ 航天/ 与/ 材料/ 工程学院/ 长沙/ 410073/ )/ 摘要/ 3D/ 非/ 结构化/ 网/ 格格/ 心/ 格式/ 数据/ 是/ 近年/ 流场/ 数值/ 模拟/ 结果/ 的/ 常见/ 形式/ ,/ 目前/ 的/ 可视化/ 方法/ 无法/ 直接/ 绘制/ 此类/ 数据/ ,/ 通常/ 采用/ 外/ 推/ 技术/ 将/ 其/ 转换/ 为格点/ 格式/ 数据/ 后/ 再/ 进行/ 绘制/ ,/ 导致/ 数据/ 精度/ 损失/ ,/ 严重/ 影响/ 绘制/ 质量/ ./ 在/ 多遍/ 光线/ 投射/ 算法/ 框架/ 下/ ,/ 设计/ 一种/ 非/ 结构化/ 网/ 格格/ 心/ 格式/ 数据/ 直接/ 采样/ 计算方法/ (/ 避免/ 外/ 推/ )/ ,/ 使/ 采样/ 过程/ 中/ 的/ 所有/ 计算/ 任务/ 基于/ 原始数据/ 完成/ ,/ 以/ 提高/ 采样/ 计算精度/ ./ 具体/ 为/ :/ 设计/ 了/ 基于/ 胞/ 心值/ 和/ 单元/ 梯度/ 的/ 采样/ 点/ 流场/ 数据/ 重构/ 方法/ ;/ 采用/ 基于/ 面/ 通量/ 的/ 格林/ 公式/ 计算/ 单元/ 梯度/ ;/ 考虑/ 流场/ 中/ 物理量/ 的/ 相互/ 关联/ ,/ 首次/ 在/ 流场/ 可视化/ 中/ 引入/ Roe/ 平均/ 方法/ ,/ 用/ 相邻/ 单元/ 胞/ 心值/ 构造/ 面/ 通量/ ./ 分析/ 和/ 实验/ 表明/ ,/ 该/ 方法/ 能/ 明显提高/ 采样/ 计算精度/ ,/ 产生/ 高质量/ 的/ 体/ 绘制/ 图像/ ,/ 使/ 用户/ 更/ 准确/ 地/ 洞察/ 和/ 分析/ 流场/ 特性/ ./ 关键词/ 计算/ 流体力学/ ;/ 非/ 结构化/ 网格/ ;/ 格心/ 格式/ 数据/ ;/ 流场/ 可视化/ ;/ 体/ 绘制/ 1/ 引言/ 随着/ 数值/ 模拟/ 精度/ 的/ 日益/ 攀升/ ,/ CFD/ 领域/ 常用/ 非/ 结构化/ 网格/ (/ 尤其/ 是/ 四面体/ 网格/ )/ 划分/ 空间/ ,/ 并/ 以此/ 为/ 基础/ 完成/ 数值/ 计算/ ./ 形式/ 上/ 相同/ 的/ 网格/ 布局/ ,/ 当/ 采用/ 不同/ 的/ 数值/ 计算方法/ 时/ ,/ 网格/ 和/ 节点/ 具有/ 不同/ 的/ 含义/ 和/ 作用/ [/ 1/ ]/ ./ 有限元法/ (/ FEM/ )/ 常将/ 物理量/ (/ 流场/ 数据/ )/ 存储/ 在/ 真实/ 的/ 网格/ 顶点/ 上/ ,/ 将/ 单元/ 看作/ 由/ 周边/ 节点/ 及形/ 函数/ 构成/ 的/ 统一体/ ,/ 计算/ 产生/ 格点/ 格式/ 数据/ (/ 后/ 称格点/ 数据/ ,/ 如图/ 1/ (/ a/ )/ )/ ;/ 有限/ 体积/ 法/ (/ FVM/ )/ 往往/ 将/ 物理量/ 存储/ 在/ 网格/ 单元/ 中心/ ,/ 将/ 单元/ 看作/ 是/ 围绕/ 中心/ 的/ 控制/ 体/ ,/ 计算/ 产生/ 格心/ 格式/ 数据/ (/ 后/ 称格心/ 数据/ ,/ 如图/ 1/ (/ b/ )/ )/ ./ FVM/ 具有/ 明确/ 的/ 物理/ 含义/ [/ 1/ -/ 3/ ]/ ,/ 它/ 保证/ 了/ 物理量/ 在/ 任意/ 控制/ 体内/ 都/ 满足/ 积分/ 守恒/ ,/ 且/ 计算/ 效率高/ ,/ 近年来/ 发展/ 十分迅速/ ,/ 在/ CFD/ 中/ 广泛应用/ ./ 然而/ ,/ 目前/ 的/ 可视化/ 方法/ (/ 包括/ 体/ 绘制/ 、/ 等值/ 面/ 提取/ 和/ 流线/ 跟踪/ 等/ )/ 均/ 以/ 插值/ 为/ 基础/ 获得/ 绘制/ 数据/ ,/ 而格点/ 数据/ 是/ 实现/ 插值/ 计算/ 的/ 前提条件/ [/ 4/ -/ 11/ ]/ ./ 以体/ 绘制/ 为例/ ,/ 在/ 采样/ 过程/ 中/ ,/ 目前/ 方法/ 或是/ 由/ 单元/ 各/ 顶点/ 数据/ ,/ 经/ “/ 全/ 线性插值/ ”/ 重构/ 该/ 单元/ 采样/ 点处/ 的/ 流场/ 值/ [/ 12/ -/ 13/ ]/ ;/ 或是/ 先/ 基于/ 单元/ 各/ 顶点/ 数据/ 估计/ 单元/ 梯度/ (/ 流场/ 在/ 单元/ 内/ 的/ 变化趋势/ )/ ,/ 再/ 经该/ 单元/ 任意/ 顶点/ 数据/ 和/ 单元/ 梯度/ 重构/ 采样/ 点处/ 流场/ 值/ [/ 4/ -/ 5/ ]/ ./ 因此/ 只能/ 直接/ 绘制/ 格点/ 数据/ ./ 而/ 对于/ 格心/ 数据/ ,/ 目前/ 的/ 做法/ 是/ :/ 采用/ 外/ 推/ 技术/ 将格心/ 数据/ 转换/ 为格点/ 数据/ 后/ 再/ 进行/ 绘制/ [/ 8/ -/ 9/ ,/ 14/ ]/ ./ 但/ 就/ 格心/ 数据/ 而言/ ,/ 绘制/ 过程/ 中/ 的/ 所有/ 计算/ 任务/ 均/ 建立/ 在外/ 推后/ 的/ 格点/ 数据/ 基础/ 上/ ,/ 这种/ “/ 间接/ ”/ 绘制/ 不可避免/ 地/ 造成/ 数据/ 精度/ 损失/ ,/ 导致/ 计算误差/ ./ 此外/ ,/ 外/ 推/ 技术/ 本质/ 上/ 是/ 某种/ 平均/ 计算/ (/ 如/ 算术平均/ 、/ 距离/ 加权/ 平均/ )/ ,/ 而格点/ 数据/ 是/ 共用/ 该点/ 的/ 点/ 相邻/ 单元格/ 心/ 数据/ 的/ 平均值/ ./ 因此/ ,/ 外/ 推后/ 的/ 格点/ 数据/ 值域/ 是/ 原始/ 格心/ 数据/ 的/ 真/ 子集/ ,/ 这/ 导致/ 部分/ 数据/ 信息/ 丢失/ ,/ 并/ 引发/ 流场/ 中/ 某些/ 特征/ 区域/ 范围/ 的/ 变化/ ./ 同时/ ,/ 这种/ “/ 平均/ ”/ 计算/ 抹平/ 了/ 数值/ 解中/ 的/ 间断/ 和/ 尖峰/ ,/ 使外/ 推后/ 的/ 数值/ 耗散/ 增大/ (/ 如图/ 2/ )/ ,/ 偏离/ 真实/ 流场/ 值/ [/ 1/ -/ 2/ ,/ 15/ -/ 16/ ]/ ./ 上述/ 问题/ 迫使/ 可视化/ 结果/ 不能/ 如实/ 反映/ 真实/ 数值/ 计算结果/ ,/ 严重/ 影响/ 了/ 绘制/ 精度/ ./ 由此可见/ ,/ 对于/ CFD/ 非/ 结构化/ 网/ 格格/ 心/ 数据/ ,/ 目前/ 的/ 可视化/ 方法/ 尚未/ 满足/ 绘制/ 需求/ ./ 本文/ 以/ 光线/ 投射/ 算法/ 为/ 框架/ ,/ 设计/ 一种/ 非/ 结构化/ 网/ 格格/ 心/ 数据/ 高质量/ 体/ 绘制/ 方法/ ,/ 直接/ 基于/ 原始/ 格心/ 数据/ 完成/ 采样/ 过程/ 中/ 的/ 所有/ 计算/ 任务/ (/ 避免/ 外/ 推/ 计算/ )/ ,/ 使/ 可视化/ 结果/ 能/ 如实/ 反映/ 数值/ 计算结果/ ./ 主要/ 贡献/ 有/ :/ (/ 1/ )/ 设计/ 了/ 直接/ 基于/ 格心/ 数据/ 和/ 单元/ 梯度/ 完成/ 采样/ 点/ 数据/ 重构/ 的/ 计算方法/ ,/ 这种/ 直接/ 重构/ 思想/ 不/ 局限于/ 体/ 绘制/ ,/ 对于/ 等值/ 面/ 提取/ 和/ 流线/ 跟踪/ 等/ 其它/ 可视化/ 方法/ 也/ 同样/ 适用/ ,/ 有效/ 提高/ 绘制/ 精度/ ;/ (/ 2/ )/ 采用/ 基于/ 面/ 通量/ 的/ 格林/ 公式/ ,/ 由格心/ 数据/ 直接/ 计算/ 单元/ 梯度/ ,/ 该/ 方法/ 不仅/ 与/ FVM/ 守恒性/ 思想/ 相一致/ ,/ 而且/ 计算精度/ 高/ ,/ 灵活性/ 和/ 适应性/ 好/ ;/ (/ 3/ )/ 为/ 精确/ 构造/ 面/ 通量/ ,/ 考虑/ 流场/ 中/ 各/ 物理量/ 间/ 的/ 关联/ 关系/ ,/ 首次/ 在/ 流场/ 可视化/ 中/ 引入/ Roe/ 平均/ 方法/ ,/ 由面/ 相邻/ 单元格/ 心/ 数据/ 的/ Roe/ 均值/ 构造/ 面/ 通量/ ./ 误差/ 分析/ 和/ 实验/ 结果表明/ ,/ 与/ 目前/ 的/ 间接/ 绘制/ 方法/ 相比/ ,/ 本文/ 方法/ 明显提高/ 了/ 重构/ 精度/ ,/ 绘制/ 结果/ 与/ 原始/ 数值/ 计算结果/ 更为/ 一致/ ,/ 使/ 科学计算/ 人员/ 更/ 准确/ 地/ 洞察/ 和/ 分析/ 流场/ 特性/ ./ 2/ 算法/ 设计/ 光线/ 投射/ 算法/ 是/ 目前/ 绘制/ 精度/ 最高/ 的/ 体/ 绘制/ 方法/ ,/ 在/ 流场/ 可视化/ 中/ 广泛应用/ [/ 6/ -/ 7/ ,/ 9/ -/ 11/ ]/ ./ 3D/ 非/ 结构化/ 网格/ 数据/ 拓扑/ 结构复杂/ ,/ 需要/ 使用/ 多遍/ (/ multi/ -/ pass/ )/ 光线/ 投射/ 算法/ 完成/ 绘制/ [/ 4/ -/ 5/ ,/ 11/ -/ 13/ ]/ ./ 本文/ 以此/ 为/ 框架/ ,/ 设计/ 基于/ 格心/ 数据/ (/ 简称/ 胞/ 心值/ )/ 的/ 直接/ 采样/ 点/ 数据/ 重构/ 方法/ ,/ 实现/ 高质量/ 体/ 绘制/ ./ 对/ 视点/ 方向/ 上/ 的/ 每条/ 光线/ ,/ 算法/ 每次/ 循环/ 对/ 一个/ 单元/ 进行/ 采样/ (/ 光线/ 与/ 出口/ 面/ 交点/ 为/ 采样/ 点/ )/ ,/ 将/ 数据/ 重构/ 结果/ (/ 采样/ 点处/ 流场/ 值/ )/ 转换成/ 颜色/ 和/ 不/ 透明度/ ,/ 合成/ 到/ 相应/ 像素/ ./ 为/ 加速/ 合成/ ,/ 采用/ 预/ 积分/ (/ pre/ -/ integral/ )/ 技术/ [/ 4/ ,/ 17/ ]/ ,/ 预先/ 建立/ 3D/ 预/ 积分/ 颜色/ 查找/ 表/ (/ 一种/ 3D/ 传递函数/ )/ ,/ 绘/ Page3/ 制/ 阶段/ 通过/ 查表/ 完成/ 颜色/ 转换/ 与/ 合成/ ./ 图/ 3/ 显示/ 了/ 算法/ 流程/ ,/ 在/ 预处理/ 和/ 绘制/ 阶段/ 分别/ 完成/ 如下/ 任务/ :/ 1/ )/ 预处理/ 阶段/ (/ 1/ )/ 构造/ 面/ 通量/ ./ 根据/ 物理量/ 类型/ ,/ 采用/ Roe/ 平均/ 方法/ ,/ 由面/ 相邻/ 单元/ 胞/ 心值/ 构造/ 面/ 通量/ (/ 第/ 3.3/ 节/ )/ ./ (/ 2/ )/ 计算/ 单元/ 梯度/ ./ 基于/ 面/ 通量/ ,/ 采用/ 格林/ 公式/ 计算/ 单元/ 梯度/ (/ 第/ 3.2/ 节/ )/ ./ 2/ )/ 绘制/ 阶段/ (/ 一次/ 采样/ 循环/ )/ (/ 1/ )/ 基于/ 胞/ 心值/ 进行/ 直接/ 流场/ 数据/ 重构/ (/ 第/ 3/ 节/ )/ ./ ①/ 计算/ 采样/ 点/ 位置/ ./ 判断/ 单元/ 出口/ 面/ ;/ 计算/ 单元/ 出口/ 位置/ ;/ 确定/ 出口/ 单元/ (/ 第/ 3.1/ 节/ )/ ./ 图/ 3/ 算法/ 流程/ 3/ 基于/ 格心/ 数据/ 的/ 直接/ 流场/ 数据/ 重构/ 原理/ 为/ 实现/ 基于/ 格心/ 数据/ 的/ 直接/ 流场/ 数据/ 重构/ ,/ 关键/ 是/ 设计/ 由胞/ 心值/ 获得/ 采样/ 点处/ 流场/ 值/ 的/ 计算方法/ ./ 本文/ 用/ 基于/ 胞/ 心值/ 的/ 线性/ 梯度/ 重构/ 方法/ 计算/ 单元/ 面上/ 采样/ 点处/ 的/ 流场/ 值/ ,/ 该/ 方法/ 源自/ FVM/ 求解/ 思想/ [/ 1/ -/ 3/ ]/ ./ 如图/ 4/ ,/ 光线/ 在/ 投射/ 过程/ 中/ 相继/ 与/ 两面/ 相邻/ 单元/ (/ 记作/ Cc/ 和/ Cn/ )/ 相交/ ,/ 获得/ 采样/ 点/ Sc/ 和/ Sn/ ,/ 分别/ 位于/ 单元/ Cc/ 和/ Cn/ 的/ 出口/ 面上/ ./ 若用/ Qi/ 表示/ 物理量/ ,/ 点/ Sc/ (/ Sn/ )/ 处/ 的/ 流场/ 值/ 可/ 由/ 单元/ Cc/ (/ Cn/ )/ 的/ 胞/ 心值/ 及/ 单元/ 梯度/ 来/ 重构/ ./ 以/ 单元/ Cc/ 为例/ ,/ 若/ 分别/ 用/ 狉/ Cc/ 和/ / Qi/ 表示/ 其格心/ 位置/ 和/ 单元/ 梯度/ ,/ 则/ 采样/ 点/ Sc/ 处/ 的/ 流场/ 值/ (/ 记作/ Qi/ 梯度/ 重构/ 采样/ 点处/ 流场/ 值/ ./ ②/ 采样/ 点/ 流场/ 数据/ 重构/ ./ 用/ 当前/ 单元/ 胞/ 心值/ 和/ (/ 2/ )/ 基于/ 预/ 积分/ 进行/ 颜色/ 转换/ 与/ 合成/ (/ 第/ 4/ 节/ )/ ./ ①/ 计算/ 相交/ 线段/ 长度/ ./ 恢复/ 算法/ 前次/ 循环/ 中/ 单元/ 出口/ (/ 即/ 当前/ 单元/ 入口/ )/ 位置/ ;/ 由/ 当前/ 单元/ 入口/ 和/ 出口/ 位置/ 计算/ 相交/ 线段/ 长度/ ./ ②/ 颜色/ 转换/ 与/ 合成/ ./ 恢复/ 前次/ 循环/ 中/ 单元/ 出口/ (/ 前次/ 采样/ 点/ )/ 处/ 流场/ 值/ ;/ 以/ 当前/ 单元/ 入口/ 和/ 出口处/ 流场/ 值及/ 相交/ 线段/ 长度/ 为/ 索引/ ,/ 查询/ 3D/ 预/ 积分/ 颜色/ 查找/ 表/ ,/ 获得/ 当前/ 单元/ 对/ 屏幕/ 像素/ 的/ 颜色/ 贡献/ 并/ 累加/ ./ 其中/ ,/ 狉/ Sc/ 为点/ Sc/ 位置/ ,/ Qi/ 值/ ./ 假设/ 单元/ 内/ 流场/ 呈/ 线性/ 变化/ ,/ 则/ Qi/ 性/ 梯度/ 重构/ 方法/ 计算/ :/ 3.1/ 采样/ 点/ 位置/ 计算/ 采样/ 点/ 位置/ 经/ 光线/ 与/ 网格/ 单元/ 的/ 相交/ 计算/ 获得/ ./ 如图/ 5/ ,/ 若用/ 狀/ i/ 表示/ 单元/ 的/ 第/ i/ 个/ 面法/ 向/ ,/ 狏/ i/ 表示/ 与/ 第/ i/ 个面/ 相对/ 的/ 顶点/ 位置/ ,/ 犲/ 和/ 狉/ 分别/ 为/ 视点/ 位置/ 和/ 光线方向/ ,/ 通过/ 计算/ 并/ 比较/ 光线/ 与/ 单元/ 各/ 表面/ (/ 或/ 表面/ 的/ 支撑/ 面/ )/ 的/ 相交/ 参数/ λ/ i/ (/ i/ ∈/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ }/ )/ 来/ 确定/ 交点/ 位置/ [/ 18/ ]/ :/ 上式/ 中/ ,/ 当/ 分母/ (/ 狉/ ·/ 狀/ i/ )/ 为/ 正时/ ,/ 单元/ 出口/ 面对/ 应/ 最小/ 的/ λ/ i/ 值/ (/ 记/ 作/ λ/ min/ )/ ,/ 进而/ 获得/ 采样/ 点/ (/ 出口/ )/ 位置/ 犲/ +/ λ/ min/ ·/ 狉/ ,/ 并/ 根据/ 单元/ 间/ 的/ 面/ 相邻/ 关系/ 确定/ 出口/ 单/ Page4/ 本文/ 直接/ 基于/ 原始/ 格心/ 数据/ 完成/ 采样/ 过程/ 中/ 的/ 元/ ,/ 而/ 当前/ 单元/ 的/ 出口/ 即/ 为/ 出口/ 单元/ 的/ 入口/ ./ 采样/ 过程/ 循环/ 推进/ ,/ 每次/ 对/ 光线方向/ 上/ 的/ 一个/ 新/ 单元/ 进行/ 采样/ ,/ 判断/ 并/ 计算/ 其/ 出口/ 位置/ ,/ 直到/ 网格/ 边界/ ./ 3.2/ 基于/ 格林/ 公式/ 的/ 单元/ 梯度/ 计算/ 所有/ 计算/ 任务/ ,/ 对于/ 式/ (/ 2/ )/ 中/ 的/ 单元/ 梯度/ / Qi/ 基于/ 胞/ 心值/ 的/ 格林/ 公式/ 计算/ ./ 格林/ 公式/ 的/ 计算/ 原理/ 与/ FVM/ 的/ “/ 守恒性/ ”/ 思想/ 相一致/ ,/ 且/ 对于/ 网格/ 中/ 质量/ 较差/ 的/ 扁平/ 单元/ ,/ 也/ 能/ 很/ 好/ 地/ 反映/ 出/ 单元/ 内/ 流场/ 变化趋势/ [/ 3/ ,/ 15/ ,/ 19/ ]/ ,/ 产生/ 高精度/ 的/ 梯度/ 计算结果/ ./ 如图/ 6/ ,/ 假设/ 单元/ Ck/ (/ k/ ∈/ {/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ }/ )/ 是/ 单元/ C0/ 的/ 面/ 相邻/ 单元/ ,/ 邻接面/ 为/ k/ ./ 若用/ Qk/ 和/ 狀/ k/ 表示/ 邻接面/ k/ 的/ 通量/ (/ 面心处/ 流场/ 值/ )/ 和/ 面法/ 向/ ./ 根据/ 格林/ 公式/ ,/ 单元/ C0/ 内/ 的/ 流场/ 梯度/ / Qi/ 其中/ V/ 和/ S/ 是/ 单元/ C0/ 的/ 体积/ 和/ 表面积/ ./ 若用/ Sk/ 表示/ 邻接面/ k/ 的/ 面积/ ,/ 则/ 上式/ 可/ 变换/ 为/ 如下/ 线性方程/ :/ 对于/ 面/ 通量/ Qi/ 联/ ,/ 采用/ CFD/ 中/ 广泛应用/ 的/ Roe/ 平均/ 方法/ ,/ 根据/ 物理量/ 类型/ ,/ 经面/ k/ 处/ 的/ 相邻/ 单元/ C0/ 和/ Ck/ 的/ 胞/ 心值/ (/ 用/ QiC0/ 和/ Qi3/ ./ 3/ 基于/ Roe/ 均值/ 的/ 面/ 通量/ 构造/ CFD/ 中/ 提供/ 了/ 多种/ 计算/ 格式/ ,/ 通过/ 相邻/ 单元/ 胞/ 心值/ ,/ 近似/ 构造/ 面/ 通量/ ,/ 其中/ ,/ Roe/ 格式/ 具有/ 很/ 高/ 的/ 分辨率/ 和/ 计算精度/ ,/ 是/ 目前/ 应用/ 广泛/ 、/ 评价/ 极高/ 的/ 计算/ 格式/ [/ 2/ -/ 3/ ,/ 15/ ,/ 19/ ]/ ,/ 而/ Roe/ 平均/ 是/ 用/ Roe/ 格式/ 求解/ 流场/ 的/ 重要环节/ [/ 20/ ]/ ./ CFD/ 数值/ 计算结果/ 包含/ 的/ 基本/ 物理量/ 有/ 密度/ ρ/ 、/ 速度/ 狏/ 和/ 压强/ p/ ,/ 本文/ 考虑/ 流场/ 中/ 各/ 物理量/ 间/ 的/ 相互/ 关联/ ,/ 根据/ 物理量/ 类型/ ,/ 选用/ 不同/ 的/ Roe/ 平均/ 公式/ 来/ 构造/ 面/ 通量/ ./ 对于/ 不同/ 物理量/ ,/ 式/ (/ 6/ )/ 可/ 具体/ 展开/ 如下/ :/ (/ 1/ )/ 密度/ ρ/ 的/ Roe/ 平均/ (/ 2/ )/ 速度/ 狏/ 的/ Roe/ 平均/ 狏/ k/ =/ (/ ρ/ C/ 槡/ 0/ ·/ 狏/ C0/ +/ ρ/ C/ 槡/ k/ ·/ 狏/ Ck/ )/ // (/ ρ/ C/ 槡/ 0/ +/ ρ/ C/ 槡/ k/ )/ (/ 8/ )/ (/ 3/ )/ 压强/ p/ 的/ Roe/ 平均/ 欲/ 获得/ 压强/ p/ 的/ Roe/ 均值/ ,/ 先经/ 下式/ 求得/ 单元/ C0/ 和/ Ck/ 的/ 焓/ 值/ (/ 记作/ hC0/ 和/ hCk/ )/ :/ 其中/ r/ 为/ 比热/ 比/ ,/ 相对/ 于/ 空气/ ,/ r/ =/ 1.4/ ./ 再用/ 焓/ 的/ Roe/ 平均/ 公式/ 计算/ 关于/ 焓/ 的/ 面/ 通量/ (/ 记作/ hk/ )/ :/ hk/ =/ (/ ρ/ C/ 槡/ 0/ ·/ hC0/ +/ ρ/ C/ 槡/ k/ ·/ hCk/ )/ // (/ ρ/ C/ 槡/ 0/ +/ ρ/ C/ 槡/ k/ )/ 流场/ 中/ 任意/ 点处/ 的/ 压强/ p/ 和/ 焓/ h/ 具有/ 下述/ 关联/ :/ 因此/ ,/ 压强/ p/ 的/ Roe/ 均值/ 为/ 4/ 颜色/ 转换/ 与/ 合成/ 采用/ 上述/ 方法/ 完成/ 采样/ 点/ 流场/ 数据/ 重构/ 以后/ ,/ 需要/ 设计/ 相应/ 的/ 颜色/ 转换/ 与/ 合成/ 方案/ ,/ 将/ 重构/ 结果/ (/ 采样/ 数据/ )/ 映射/ 成/ 光学/ 属性/ (/ 颜色/ 和/ 不/ 透明度/ )/ 并/ 累加/ 到/ 相应/ 像素/ ,/ 合成/ 最终/ 的/ 体/ 绘制/ 图像/ ./ 本文/ 采用/ “/ 预/ 积分/ ”/ 技术/ [/ 4/ ,/ 16/ ]/ ,/ 基于/ 预先/ 建立/ 的/ 3D/ 预/ 积分/ 颜色/ 查找/ 表/ (/ 3DLUT/ )/ ,/ 同时/ 完成/ 颜色/ 转换/ 与/ 合成/ ,/ 以/ 加速/ 绘制/ ./ 本质/ 上/ ,/ 3DLUT/ 是/ 以/ 单元/ 入口/ 点/ 和/ 出口/ 点处/ 流场/ 值/ 以及/ 光线/ 在/ 单元/ 内/ 的/ 相交/ 线段/ 长度/ 为/ 自变量/ 的/ 3D/ 传递函数/ ./ 对于/ 物理量/ Qi/ ,/ 算法/ 在/ 采样/ 循环/ 的/ 重构/ 阶段/ ,/ 计算/ 当前/ 单元/ Cc/ 出口/ 点/ (/ Sc/ )/ 处/ 的/ 流场/ 值/ Qi/ 成/ 阶段/ ,/ 需要/ 恢复/ 入口/ 单元/ 出口/ 点/ (/ 即/ 当前/ 单元/ 入口/ 点/ )/ 处/ 的/ 流场/ 值/ ./ 如图/ 7/ ,/ 光线/ 相继/ 与面/ 相邻/ 单元/ Cl/ 、/ Cc/ 和/ Cn/ 相交/ ./ 假设/ 当前/ 采样/ 单元/ 为/ Cc/ ,/ 则/ Cc/ 的/ 入口/ 点/ (/ Sl/ )/ 处/ 流场/ 值/ 是/ 算法/ 前次/ 循环/ 中/ 计算/ 的/ 单元/ Cl/ 的/ 出口/ 点/ (/ Sl/ )/ 处/ 流场/ 值/ (/ 记作/ Qi/ 复/ 前次/ 采样/ 点/ Sl/ 的/ 空间/ 位置/ ,/ 以便/ 计算/ 光线/ 在/ 当前/ 单元/ 内/ 的/ 相交/ 线段/ 长度/ ./ 最后/ ,/ 将/ 当前/ 单元/ 入口/ 点/ 流场/ 值/ Qi/ 索引/ ,/ 查询/ 3DLUT/ ,/ 得到/ 当前/ 单元/ 对/ 屏幕/ 像素/ 的/ 颜色/ 贡献/ 并/ 累加/ 到/ 相应/ 帧/ 缓存/ ,/ 合成/ 最终/ 的/ 体/ 绘制/ 图像/ ./ Page55/ 数据/ 重构/ 精度/ 分析/ 与/ 比较/ 5.1/ 间接/ 绘制/ 方法/ 的/ 精度/ 分析/ 为/ 分析/ 基于/ 外/ 推/ 的/ 间接/ 绘制/ 方法/ 的/ 流场/ 数据/ 重构/ 精度/ ,/ 先/ 简单/ 介绍/ 目前/ 基于/ 格点/ 数据/ 完成/ 重构/ 的/ 基本原理/ ./ 经外/ 推/ 计算/ 将格心/ 数据/ 转换/ 为格点/ 数据/ 后/ ,/ 为/ 重构/ 单元/ 面上/ 采样/ 点处/ 的/ 流场/ 值/ ,/ 目前/ 有/ 两种/ 方法/ :/ 基于/ 面/ 顶点/ 的/ 全/ 线性插值/ [/ 12/ -/ 13/ ]/ 和/ 基于/ 单元/ 顶点/ 数据/ 的/ 线性/ 梯度/ 重构/ [/ 4/ -/ 5/ ]/ ./ 后者/ 的/ 提出/ 是/ 为/ 降低/ 前者/ 的/ 插值/ 计算/ 量/ ,/ 两者/ 在/ 本质/ 上/ 完全相同/ ,/ 具有/ 相同/ 的/ 重构/ 结果/ 和/ 精度/ ./ 如图/ 8/ ,/ V0/ 、/ V1/ 、/ V2/ 、/ V3/ 是/ 单元/ Cc/ 的/ 顶点/ ,/ 采样/ 点/ Sc/ 位于/ 顶点/ V1/ 、/ V2/ 和/ V3/ 围成/ 的/ 单元/ 面上/ ./ 假设/ 外/ 推/ 计算/ 后/ 顶点/ Vk/ (/ k/ ∈/ {/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ }/ )/ 处/ 的/ 流场/ 值为/ Qi/ 基于/ 面/ 顶点/ 的/ 全/ 线性插值/ 方法/ 根据/ 采样/ 点/ 位置/ (/ 狉/ Sc/ )/ ,/ 用/ 顶点/ V1/ 、/ V2/ 和/ V3/ 的/ 位置/ 及其/ 流场/ 值/ (/ QiV2/ 和/ QiQiSc/ )/ ./ 为/ 降低/ 全/ 线性插值/ 的/ 计算/ 量/ ,/ 基于/ 单元/ 顶点/ (/ Qi/ 数据/ 的/ 线性/ 梯度/ 重构/ 方法/ 先/ 基于/ 各/ 顶点/ 数据/ 计算/ 单元/ 梯度/ (/ 记/ 作/ / Qi/ )/ ,/ 再/ 任选/ 一/ 顶点/ 为/ 参考点/ ,/ 用该/ 顶点/ 数据/ 和/ 单元/ 梯度/ 重构/ 采样/ 点处/ 流场/ 值/ ./ 其中/ ,/ 梯度/ 计算/ 采用/ 距离/ 加权/ 法/ ,/ 建立/ 如下/ 线性方程组/ :/ 图/ 8/ 基于/ 格点/ 数据/ 的/ 采样/ 点/ 流场/ 重构/ 原理图/ 其中/ 狉/ Vk/ 是/ 顶点/ Vk/ 的/ 空间/ 位置/ ./ 此后/ ,/ 任选/ 单元/ 一/ 顶点/ 为/ 参考点/ (/ 假设/ V0/ )/ ,/ 重构/ 采样/ 点处/ 流场/ 值/ :/ 综上所述/ ,/ 间接/ 绘制/ 方法/ 的/ 采样/ 点/ 数据/ 重构/ 过程/ 主要/ 包括/ 3/ 个/ 计算/ 步骤/ :/ (/ 1/ )/ 外/ 推/ 计算/ (/ 误差/ 记作/ in/ ;/ (/ 2/ )/ 梯度/ 估计/ (/ 误差/ 记作/ O2O1/ 构/ (/ 误差/ 记作/ O3/ 制格心/ 数据/ ,/ 通常/ 采用/ 的/ 外/ 推/ 方法/ 是/ 简单/ 平均/ 外/ 推/ 和/ 反转/ 距离/ 外/ 推/ ./ 如图/ 9/ ,/ 假设/ 单元/ C0/ ,/ C1/ ,/ …/ ,/ Cn/ -/ 1/ 是/ 共用/ 顶点/ V0/ 的/ 点/ 相邻/ 单元/ ,/ 若用/ QCi/ 表示/ 单元/ Ci/ (/ i/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ n/ -/ 1/ }/ )/ 的/ 胞/ 心值/ ,/ 则/ 简单/ 平均/ 外/ 推/ 计算/ 这组点/ 相邻/ 单元/ 胞/ 心值/ 的/ 算术平均/ (/ 如图/ 9/ (/ a/ )/ )/ ,/ 以此/ 近似/ 顶点/ V0/ 处/ 的/ 流场/ 值/ ,/ 即/ QV0/ =/ ∑/ i/ 该/ 方法/ 计算/ 简单/ ,/ 是/ 目前/ 可视化/ 中/ 最/ 常用/ 的/ 外/ 推/ 方法/ ,/ 但/ 精度/ 较差/ [/ 14/ -/ 15/ ]/ ./ 反转/ 距离/ 外/ 推/ 将/ 各/ 单元/ 中心/ 到/ 其/ 公共/ 顶点/ V0/ 距离/ (/ 记作/ di/ )/ 的/ 倒数/ 作为/ 权重/ (/ 如图/ 9/ (/ b/ )/ )/ ,/ 用/ 加权/ 平均/ 计算/ V0/ 处/ 的/ 流场/ 值/ ,/ 即/ QV0/ =/ QCi/ // d/ (/ )/ i/ ∑/ i/ ∑/ i/ 具有/ 1.85/ 阶/ 精度/ ,/ 优于/ 简单/ 平均/ 外/ 推/ [/ 16/ ]/ ./ 不妨/ 假设/ 间接/ 绘制/ 方法/ 采用/ 反转/ 距离/ 外/ 推/ ,/ 则/ O1O/ (/ Δ/ x1/ ./ 85/ ,/ Δ/ y1/ ./ 85/ )/ ./ 假设/ 用/ 距离/ 加权/ 法/ 计算/ 单元/ 梯度/ 的/ 误差/ 为/ Ov/ ,/ 则/ O2/ 采样/ 点处/ 流场/ 值/ 具有/ 二阶/ 精度/ ,/ 即/ O3/ Δ/ y2/ ,/ Δ/ x/ Δ/ y/ )/ ./ 根据/ 式/ (/ 14/ )/ ,/ 间接/ 绘制/ 方法/ 在/ 采样/ 点/ 流场/ 数据/ 重构/ 过程/ 中/ 产生/ 的/ 累积/ 误差/ (/ 记作/ Oin/ )/ 为/ Oin/ =/ O/ (/ Δ/ x1/ ./ 85/ ,/ Δ/ y1/ ./ 85/ )/ +/ Ov/ ·/ (/ 狉/ S/ -/ 狉/ V0/ )/ +/ 5.2/ 直接/ 绘制/ 方法/ 的/ 精度/ 分析/ 如前所述/ ,/ 本文/ 直接/ 绘制/ 方法/ 基于/ 原始/ 格心/ 数据/ 重构/ 采样/ 点处/ 流场/ 值/ ,/ 与/ 间接/ 绘制/ 方法/ 相比/ ,/ 避免/ 了/ 外/ 推/ 计算误差/ (/ O1/ (/ 1/ )/ 梯度/ 估计/ (/ 误差/ 记作/ O2/ 差记作/ O3Oc/ ,/ 则/ O2Page6/ 值/ 具有/ 二阶/ 精度/ ,/ 即/ O3/ 式/ (/ 2/ )/ ,/ 直接/ 绘制/ 方法/ 在/ 采样/ 点/ 流场/ 数据/ 重构/ 过程/ 中/ 产生/ 的/ 累积/ 误差/ (/ 记作/ Od/ )/ 为/ Od/ =/ Oc/ ·/ (/ 狉/ Sc/ -/ 狉/ Cc/ )/ +/ O/ (/ Δ/ x2/ ,/ Δ/ y2/ ,/ Δ/ x/ Δ/ y/ )/ (/ 16/ )/ 对比/ 式/ (/ 15/ )/ 和/ (/ 16/ )/ 中/ 的/ 误差/ 项/ ,/ 直接/ 绘制/ 方法/ 避免/ 了/ 外/ 推/ 计算误差/ 项/ O/ (/ Δ/ x1/ ./ 85/ ,/ Δ/ y1/ ./ 85/ )/ ./ 为/ 计算/ 单元/ 梯度/ ,/ 间接/ 绘制/ 方法/ 采用/ 距离/ 加权/ 法/ ,/ 误差/ 较大/ (/ 尤其/ 当/ 网格/ 中/ 包含/ 扁平/ 单元/ 时/ )/ [/ 2/ ,/ 15/ ,/ 19/ ]/ ;/ 而/ 直接/ 绘制/ 方法/ 采用/ 基于/ 面/ 通量/ 的/ 格林/ 公式/ ,/ 计算精度/ 高/ ,/ 且/ 灵活性/ 和/ 适应性/ 好/ [/ 1/ ,/ 3/ ,/ 15/ ,/ 19/ ]/ ./ 同时/ ,/ 本文/ 用/ Roe/ 平均/ 方法/ 构造/ 面/ 通量/ ,/ 进一步提高/ 了/ 计算精度/ [/ 1/ -/ 3/ ]/ ,/ 因此/ Ov/ >/ Oc/ ,/ 而/ 在/ 平均/ 状况/ 下/ ,/ 狉/ Sc/ -/ 狉/ V0/ ≈/ 狉/ Sc/ -/ 狉/ Cc/ ,/ 故/ 明显/ 有/ Od/ </ Oin/ ./ 上述/ 分析表明/ ,/ 本文/ 的/ 直接/ 绘制/ 方法/ 具有/ 更/ 高/ 的/ 采样/ 点/ 流场/ 数据/ 重构/ 精度/ ./ 此外/ ,/ 外/ 推/ 计算/ 是/ 基于/ 平均/ 方法/ 的/ ,/ 这/ 不仅/ 抹平/ 了/ 数值/ 计算结果/ 中/ 的/ 间断/ 和/ 尖峰/ ,/ 使外/ 推后/ 的/ 数值/ 耗散/ 增大/ ,/ 远离/ 真实/ 流场/ 值/ ;/ 而且/ 导致/ 外/ 推后/ 的/ 格点/ 数据/ 范围/ 小于/ 原始/ 格心/ 数据/ ,/ 造成/ 部分/ 数据/ 信息/ 丢失/ ./ 间接/ 绘制/ 方法/ 以此/ 为/ 数据/ 基础/ 重构/ 采样/ 点处/ 的/ 流场/ 值/ ,/ 不仅/ 无法/ 完整/ 显示/ 流场/ 的/ 全局/ 特征/ ,/ 而且/ 局部/ 特征/ 区域/ 范围/ 也/ 随之/ 改变/ ,/ 进一步/ 影响/ 了/ 绘制/ 精度/ ./ 6/ 算法/ 实现/ 与/ 实验/ 结果/ 6.1/ 算法/ 的/ GPU/ 实现/ 本文/ 采用/ GPU/ 加速/ 技术/ ,/ 在/ 配置/ 为/ IntelPentiumDual1/ ./ 60GHz/ 处理器/ (/ 2048MB/ )/ 和/ NVIDIAGeForce9800GTX/ 显卡/ (/ 512MB/ )/ 的/ PC机/ 上/ ,/ 基于/ Visual/ C++/ ./ net2005/ 开发/ 环境/ ,/ 实现/ 了/ 上述/ 算法/ ./ 对于/ 较/ 大规模/ CFD/ 非/ 结构化/ 网/ 格格/ 心/ 格式/ 数据/ ,/ 绘制/ 性能/ 可/ 满足/ 实时/ 交互/ ./ GPU/ 与/ CPU/ 之间/ 的/ 数据传输/ 瓶颈/ 是/ 算法/ 设计/ 时需/ 考虑/ 的/ 重要/ 问题/ ./ 解决方案/ 之一/ 是/ 将/ 光线/ 投射/ 过程/ 中/ 的/ 所有/ 计算/ 任务/ 交由/ GPU/ 完成/ ,/ 避免/ 执行/ 阶段/ GPU/ 和/ CPU/ 间/ 的/ 数据/ 等待/ 与/ 交换/ ./ 为此/ ,/ 文献/ [/ 5/ ]/ 设计/ 了/ 两个/ 2DGPU/ 纹理/ 数据结构/ :/ 格点/ 数据/ 纹理/ 和/ 采样/ 数据/ 纹理/ ./ 前者/ 以/ 单元/ 为/ 单位/ 存储/ 网格/ 数据/ ,/ 为/ 每个/ 单元/ 存储/ 其/ 顶点/ 的/ 空间/ 位置/ 和/ 流场/ 数据/ ,/ 以及/ 单元/ 面法/ 向/ 和/ 面/ 相邻/ 单元/ 纹理/ 坐标/ ;/ 后者/ 存放/ 实时/ 采样/ 结果/ ./ 本文/ 在/ 此基础/ 上/ 修改/ 网格/ 数据/ 纹理/ ,/ 用格心/ 数据/ 取代/ 格点/ 数据/ ,/ 以/ 实现/ 对格心/ 数据/ 的/ 直接/ 绘制/ ./ 为/ 实现/ 基于/ 预/ 积分/ 的/ 颜色/ 转换/ 与/ 合成/ ,/ 采样/ 数据/ 纹理/ 中需/ 存放/ 每次/ 循环/ 结束/ 后/ 的/ 采样/ 点/ 位置/ 和/ 流场/ 重构/ 结果/ ,/ 以及/ 累加/ 后/ 的/ 像素/ 颜色/ 值/ ./ 6.2/ 测试数据/ 与/ 实验/ 结果/ 前述/ 分析/ 可知/ ,/ 直接/ 绘制/ 方法/ 能/ 明显提高/ 重构/ 精度/ ,/ 为/ 用户/ 提供/ 高质量/ 的/ 体/ 绘制/ 图像/ ./ 为/ 进一步/ 验证/ 其/ 正确性/ ,/ 本文/ 分别/ 用/ 间接/ 和/ 直接/ 绘制/ 方法/ ,/ 对/ 实际/ CFD/ 工程/ 中/ 三组/ 格心/ 格式/ 数据/ 进行/ 测试/ 并/ 比较/ 其/ 绘制/ 结果/ ./ 6.2/ ./ 1StaticMixer/ 数据/ 集该/ 数据/ 集/ 网格/ 模型/ 包含/ 60796/ 个/ 顶点/ 和/ 103762/ 个/ 单元/ (/ 如图/ 10/ )/ ./ 对/ 压力/ 场/ 进行/ 绘制/ ,/ 在/ 相同/ 的/ 3D/ 传递函数/ 下/ ,/ 图/ 11/ 是/ 采用/ 反转/ 距离/ 外/ 推/ ,/ 基于/ 格点/ 数据/ 的/ 间接/ 绘制/ 效果/ ;/ 图/ 12/ 是/ 本文/ 基于/ 原始/ 格心/ 数据/ 的/ 直接/ 绘制/ 效果/ ,/ 并/ 注明/ 了/ 各自/ 压力/ 场/ 数值/ 范围/ ./ 可见/ ,/ 格点/ 数据/ 值域/ 是/ 原始/ 格心/ 数据/ 的/ 真/ 子集/ ,/ 即外/ 推/ 过程/ 损失/ 了/ 部分/ 数值/ 计算结果/ ./ 对/ 比如/ 图/ 11/ 和/ 图/ 12/ 中/ 的/ 白色/ 标注/ 区域/ ,/ 容易/ 发现/ ,/ 间接/ 绘制/ 方法/ 无法/ 显示/ 流场/ 全貌/ ,/ 造成/ 局部/ 重要/ 特征/ 丢失/ ./ 此外/ ,/ 外/ 推/ 计算/ 的/ “/ 平均/ ”/ 思想/ 抹平/ 了/ 数值/ 解中/ 的/ 间断/ 和/ 尖峰/ ,/ 导致/ 数值/ 耗散/ 增大/ ,/ 远离/ 真实/ 流场/ 值/ ,/ 以此/ 为/ 数据/ 基础/ 重构/ 采样/ 点处/ 的/ 流场/ 值/ 将/ 引起/ 误差/ 传播/ ,/ 使/ 可视化/ 结果/ 不能/ 准确/ 反映/ 数值/ 计算结果/ 和/ 实际/ 流场/ 状态/ ,/ 严重/ 影响/ 了/ 分析/ 的/ 有效性/ ./ 6.2/ ./ 2/ 接触/ 间断/ 数值/ 模拟/ 图/ 13/ 显示/ 了/ 某/ 接触/ 间断/ 流场/ 数值/ 模拟/ 使用/ 的/ 网格/ 模型/ ,/ 包含/ 68032/ 个/ 顶点/ 和/ 131836/ 个/ 单元/ ./ 分别/ 用/ 两种/ 方法/ 对/ 密度/ 场/ 进行/ 绘制/ ,/ 在/ 相同/ 3D/ 的/ 传递函数/ 下/ ,/ 图/ 14/ 是/ 采用/ 反转/ 距离/ 外/ 推/ ,/ 基于/ 格点/ 数据/ 的/ 间接/ 绘制/ 效果/ ;/ 图/ 15/ 是/ 基于/ 原始/ 格心/ 数据/ 的/ 直接/ 绘制/ 效果/ ,/ 并/ 注明/ 了/ 各自/ 密度/ 场/ 数值/ 范围/ ./ 图中/ 红色/ 拱形/ 标注/ 出/ 流场/ 中/ 的/ 接触/ 间断/ 特征/ ,/ 理论/ 上/ ,/ 其/ 跨度/ 大约/ 为/ 2/ ~/ 3/ 个/ 网格/ 单元/ 且/ 显示/ 为/ 纯色/ [/ 21/ ]/ ./ 对比/ 两者/ ,/ 容易/ 发现/ ,/ 图/ 15/ 显示/ 的/ 流动/ 间断/ 特征/ 更为/ 合理/ 、/ 逼真/ ,/ 准确/ 地/ 反映/ 了/ 数值/ 计算结果/ 和/ 实际/ 流场/ 状态/ ./ Page7/ 图/ 11/ 间接/ 绘制/ 效果图/ (/ 反转/ 距离/ 外/ 推/ ,/ 压力/ 场/ [/ 25149.236/ ,/ 112826.745/ ]/ Pa/ )/ 图/ 12/ 直接/ 绘制/ 效果图/ (/ 压力/ 场/ [/ 23042.768/ ,/ 137402.683/ ]/ Pa/ )/ 图/ 14/ 间接/ 绘制/ 效果图/ (/ 密度/ 场/ [/ 0.8475/ ,/ 2.2476/ ]/ kg/ // m3/ )/ 图/ 15/ 直接/ 绘制/ 效果图/ (/ 密度/ 场/ [/ 0.7614/ ,/ 2.4984/ ]/ kg/ // m3/ )/ 6.2/ ./ 3/ 单/ 机翼/ 流场/ 数值/ 模拟/ 图/ 16/ 显示/ 的/ 网格/ 模型/ 用于/ 模拟/ 某单/ 机翼/ 周围/ 流场/ ,/ 包含/ 7342/ 个/ 顶点/ 和/ 35812/ 个/ 单元/ ./ 分别/ 用/ 两种/ 方法/ 对/ 密度/ 场/ 进行/ 绘制/ ,/ 在/ 相同/ 的/ 3D/ 传递函数/ 下/ ,/ 效果/ 如图/ 17/ 和/ 图/ 18/ 所示/ ./ 对比/ 两者/ ,/ 不难/ 发现/ ,/ 图/ 17/ 间接/ 绘制/ 方法/ 效果/ (/ 密度/ 场/ [/ 0.553662/ ,/ 1.46706/ ]/ kg/ // m3/ )/ Page8/ 直接/ 绘制/ 方法/ 能/ 更加/ 清晰/ 而/ 准确/ 地/ 显示/ 机翼/ 周围/ 流场/ 特征/ ,/ 帮助/ 用户/ 更加/ 有效/ 地/ 洞察/ 和/ 分析/ 数值/ 计算结果/ ./ 图/ 18/ 直接/ 绘制/ 方法/ 效果图/ (/ 密度/ 场/ [/ 0.532351/ ,/ 1.59506/ ]/ kg/ // m3/ )/ 7/ 结论/ 高精度/ 的/ 流场/ 数值/ 模拟/ 需要/ 高精度/ 的/ 可视化/ 算法/ 与/ 之/ 匹配/ ./ 对于/ FVM/ 产生/ 的/ CFD/ 非/ 结构化/ 网/ 格格/ 心/ 格式/ 数据/ ,/ 区别/ 于/ 目前/ 基于/ 外/ 推/ 的/ 间接/ 可视化/ 方法/ ,/ 本文/ 结合/ FVM/ 求解/ 思想/ 并/ 考虑/ 流场/ 中/ 物理量/ 间/ 的/ 相互/ 关联/ ,/ 设计/ 实现/ 了/ 一种/ 避免/ 外/ 推/ 的/ 直接/ 可视化/ 方法/ (/ 该/ 思想/ 并/ 不/ 局限于/ 体/ 绘制/ ,/ 对/ 等值/ 面/ 提取/ 和/ 流线/ 跟踪/ 也/ 同样/ 适用/ )/ ,/ 并/ 以/ 光线/ 投射/ 体/ 绘制/ 算法/ 为例/ 验证/ 了/ 直接/ 可视化/ 方法/ 的/ 绘制/ 精度/ 和/ 效果/ ./ 从/ 理论/ 上/ 证明/ 了/ 直接/ 绘制/ 方法/ 的/ 采样/ 点/ 数据/ 重构/ 精度/ 明显/ 优于/ 间接/ 绘制/ 方法/ ./ 通过/ 实验/ 证实/ 了/ 本文/ 方法/ 能/ 有效/ 保护/ 原始/ 数值/ 计算结果/ ,/ 为/ 科学计算/ 人员/ 提供/ 高质量/ 的/ 体/ 绘制/ 图像/ ./ 

