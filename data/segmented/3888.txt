Page1/ 一种/ 面向/ 移动/ 计算/ 的/ 机密性/ 与/ 完整性/ 模型/ 郭云川/ 1/ )/ ,/ 3/ )/ 方滨兴/ 1/ )/ 殷丽华/ 1/ )/ 周渊/ 2/ )/ 1/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 2/ )/ (/ 国家/ 计算机网络/ 应急/ 技术/ 处理/ 协调/ 中心/ 北京/ 100029/ )/ 3/ )/ (/ 广西/ 可信/ 软件/ 重点/ 实验室/ (/ 桂林/ 电子科技/ 大学/ )/ 广西/ 桂林/ 541004/ )/ 摘要/ 机密性/ 和/ 完整性/ 是/ 移动/ 计算/ 的/ 两个/ 重要/ 特性/ ,/ 如何/ 保障/ 机密性/ 和/ 完整性/ 是/ 移动/ 计算/ 的/ 重大/ 挑战/ ./ 利用/ π/ 演算/ 能/ 有效/ 建模/ 移动/ 并发/ 系统/ 的/ 特征/ ,/ 借鉴/ 程序语言/ 中/ 不同/ 类型/ 变量/ 之间/ 的/ 赋值/ 方式/ ,/ 提出/ 基于/ 混杂/ 类型/ 检测/ 的/ 安全/ π/ 演算/ (/ HybridTypedSecurity/ π/ ,/ π/ HTS/ )/ ./ 根据/ π/ HTS/ 利用/ 静态/ 类型/ 检测/ 保障/ 低机/ 密级信息/ 只能/ 向/ 同等/ 或/ 更/ 高/ 机密/ 级/ 流动/ ,/ 高/ 完整/ 级/ 信息/ 只能/ 向/ 同等/ 或/ 更/ 低/ 完整/ 级/ 流动/ ,/ 针对/ 机密性/ 和/ 完整性/ 在/ 信息流/ 向上/ 的/ 相反/ 性/ ,/ 提出/ 了/ 基于/ 强制/ 类型/ 转化/ 的/ 有效/ 动态/ 转换/ 框架/ ./ π/ HTS/ 将/ 静态/ 检测/ 和/ 动态/ 检测/ 有机/ 地/ 整合/ 在/ 一起/ ,/ 形成/ 了/ 一种/ 统一/ 的/ 安全/ 形式/ 模型/ ./ 它/ 能/ 同时/ 保障/ 移动/ 计算/ 中/ 的/ 机密性/ 和/ 完整性/ ,/ 具有/ 较/ 好/ 的/ 可用性/ ./ 关键词/ 机密性/ ;/ 完整性/ ;/ 混杂/ 类型/ 检测/ ;/ 移动/ 计算/ ;/ 移动/ 互联网/ 1/ 引言/ 移动/ 互联网/ 在/ 世界/ 范围/ 内/ 广泛应用/ ,/ 仅/ 在/ 中国/ 2010/ 年底/ 手机/ 上网/ 用户/ 就/ 达/ 3.03/ 亿/ [/ 1/ ]/ ,/ 据/ 中国/ 互联网/ 数据中心/ DCCI/ (/ DataCenteroftheChinaInternet/ )/ 预测/ ,/ 2015/ 年底/ 中国/ 手机/ 上网/ 用户/ 将/ 达/ 9.19/ 亿/ ①/ ,/ 移动/ 互联网/ 正在/ 深刻/ 地/ 影响/ 着/ 人们/ 的/ 生活/ 及/ 工作/ 方式/ ./ 安全/ 问题/ 作为/ 移动/ 互联网/ 的/ 挑战/ 之一/ 正/ 影响/ 其/ 发展/ ,/ 国家/ 计算机病毒/ 中心/ 统计/ 表明/ ,/ 2010/ 年/ 39.85/ %/ 的/ 移动/ 终端/ 曾/ 感染/ 病毒/ ,/ 54.09/ %/ 曾/ 被/ 病毒感染/ 的/ 用户/ 手机/ 无法/ 正常/ 使用/ ,/ 50.32/ %/ 的/ 用户/ 信息/ 曾/ 被/ 泄露/ ,/ 46.55/ %/ 的/ 用户/ 曾/ 被/ 恶意/ 扣费/ ②/ ./ 即使/ 针对/ 非/ 恶意/ 入侵/ ,/ 移动/ 互联网/ 中/ 安全/ 隐私/ 也/ 是/ 一个/ 重大/ 问题/ ,/ 如/ 位置/ 匿名/ ./ 移动/ 互联网安全/ 研究/ 包括/ 两类/ :/ (/ 1/ )/ 针对/ 移动/ 终端/ 、/ 接入/ 网络/ 和/ 应用服务/ 的/ 应用/ 及/ 应用/ 基础/ 研究/ ,/ 具体/ 地/ 包括/ 移动/ 终端/ 安全/ 、/ 无线/ 网络安全/ 、/ 应用/ 安全/ 、/ 内容/ 安全/ 及/ 位置/ 隐私/ 保护/ 等/ ;/ (/ 2/ )/ 基于/ 移动/ 计算/ 的/ 移动/ 互联网/ 的/ 机理/ 研究/ ,/ 包括/ 移动/ 计算/ 安全/ 模型/ 、/ 移动/ 安全/ 评估/ 等/ ./ 针对/ 第/ 1/ 类/ ,/ 最新/ 的/ 工作/ 包括/ 文献/ [/ 1/ -/ 4/ ]/ 等/ ,/ 其中/ ,/ 文献/ [/ 2/ ]/ 在/ 消息/ 中/ 附加/ 安全策略/ 来/ 保障/ 移动/ Adhoc/ 网络/ 的/ 机密性/ ,/ 文献/ [/ 3/ ]/ 给出/ 了/ 一种/ 移动/ 环境/ 下/ 的/ 紧急/ 医疗/ 救助/ 方案/ ,/ 文献/ [/ 4/ ]/ 提出/ 了/ 一种/ 面向/ 移动/ 社交/ 网络/ 的/ 协作/ 式/ 内容/ 分发/ 机制/ ,/ 文献/ [/ 1/ ]/ 综述/ 了/ 面向/ 移动/ 互联网/ 的/ 终端/ 、/ 网络/ 与/ 服务/ 的/ 研究/ 现状/ ./ 在/ 移动/ 计算/ 的/ 机理/ 建模/ 方面/ ,/ π/ 演算/ 由于/ 能/ 有效/ 建模/ 信道/ 名/ 创建/ 及/ 交换/ 而/ 在/ 移动/ 计算/ 中/ 得到/ 广泛/ 使用/ ./ 如/ 文献/ [/ 5/ ]/ 利用/ π/ 演算/ 建模/ 移动主体/ 是否/ 具有/ 访问/ 某种/ 资源/ 的/ 能力/ ,/ 文献/ [/ 6/ ]/ 进一步/ 扩展/ 了/ π/ 演算/ ,/ 区分/ 两种/ 不同/ 的/ 能力/ 类型/ (/ CapabilityTypes/ )/ :/ 读/ 信道/ 类型/ 和/ 写信/ 道/ 类型/ ,/ 建立/ 子/ 类型/ 关系/ ,/ 进而/ 给出/ 了/ 类型化/ 移动/ 进程/ 的/ 代数/ 理论/ ;/ 文献/ [/ 7/ ]/ 基于/ π/ 演算/ 设计/ ω/ 算子/ 来/ 刻画/ MANETs/ 网络/ 的/ 广播/ 、/ 节点/ 移动/ 等/ 特性/ ,/ 区分/ 了/ 两类/ 不同/ 的/ 动作/ :/ τ/ 动作/ 和/ μ/ 动作/ ,/ 并/ 分隔/ MANETs/ 节点/ 的/ 通信/ 和/ 计算/ 行为/ ,/ 该/ 工作/ 能/ 有效/ 地/ 建模/ 和/ 推理/ MANETs/ 网络/ 的/ 行为/ ./ 文献/ [/ 8/ ]/ 利用/ 局部/ 位置/ 和/ 在/ 不同/ 位置/ 的/ 计算能力/ 来/ 刻画/ 移动/ 系统/ ,/ 而后/ 采用/ 标签/ Kripke/ 结构/ 以/ 位置/ 网/ 的/ 形式/ 建立/ 其/ 形式/ 语义/ ,/ 并/ 使用/ SATABS/ 模型/ 检验/ 器/ 进行/ 验证/ ./ 然而/ ,/ 文献/ [/ 5/ -/ 8/ ]/ 不/ 涉及/ 安全/ ./ 为了/ 分析/ 移动/ 计算/ 中/ 的/ 安全性/ ,/ 文献/ [/ 9/ ]/ 进行/ 安全/ 级/ 划分/ ,/ 采用/ π/ 演算/ 建模/ 移动/ 资源/ 访问/ ,/ 保障/ 低/ 安全/ 级/ 的/ 主体/ 不能/ 访问/ 高/ 安全/ 级/ 的/ 信息/ ./ 但/ 低/ 安全/ 级/ 的/ 主体/ 不能/ 访问/ 高/ 安全/ 级/ 信息/ ,/ 这/ 不能/ 同时/ 保障/ 机密性/ 和/ 完整性/ :/ 机密性/ 模型/ (/ 如/ BLP/ 模型/ )/ 中/ 低/ 安全/ 级/ 主体/ 能以/ “/ 写/ ”/ 的/ 方式/ 访问/ 高/ 安全/ 级/ 信息/ ,/ 完整性/ 模型/ (/ 如/ Biba/ 模型/ )/ 中/ 低/ 安全/ 级/ 主体/ 能以/ “/ 读/ ”/ 的/ 方式/ 访问/ 高/ 安全/ 级/ 的/ 信息/ ./ 文献/ [/ 10/ ]/ 基于/ 控制流/ 图/ 扩展/ 了/ Java/ 安全/ 体系结构/ ,/ 定义/ 了/ 交互式/ 移动/ 设备/ 中/ 资源/ 访问控制/ 的/ 程序验证/ 模型/ ,/ 但/ 并未/ 定义/ 安全策略/ ,/ 因此/ ,/ 难以/ 同时/ 处理/ 机密性/ 和/ 完整性/ ./ 由/ 上面/ 的/ 分析/ 可/ 看出/ ,/ 虽然/ 研究者/ 对/ 移动/ 计算/ 分析/ 、/ 建模/ 及/ 验证/ 进行/ 了/ 深入研究/ ,/ 但/ 鲜有/ 同时/ 保障/ 机密性/ 和/ 完整性/ 的/ 形式/ 模型/ ./ 特别/ 地/ ,/ 虽然/ 有/ 很多/ 工作/ 利用/ 加密/ 及/ 哈希/ 等/ 方式/ 提供/ 机密性/ 和/ 完整性/ ,/ 但/ 我们/ 认为/ 这/ 是从/ 语法/ 层面/ 保障/ 的/ ./ 从/ 信息流/ 语义/ 层面/ 看/ ,/ 目前/ 少有/ 工作/ 同时/ 提供/ 机密性/ 和/ 完整性/ ,/ 其/ 部分/ 原因/ 为/ :/ 以/ BLP/ 模型/ 为/ 代表/ 的/ 机密性/ 模型/ 保障/ 信息/ 只能/ 从/ 低/ 安全/ 级/ 流向/ 同等/ 安全/ 级/ 或/ 高/ 安全/ 级/ 信息/ 或/ 主体/ ,/ 以/ Biba/ 模型/ 为/ 代表/ 的/ 完整性/ 模型/ 保障/ 信息/ 只能/ 从/ 高/ 安全/ 级/ 流向/ 同等/ 安全/ 级/ 或/ 低/ 安全/ 级/ 信息/ 或/ 主体/ ./ 这/ 意味着/ 语义/ 层面/ 机密性/ 模型/ 和/ 完整性/ 模型/ 在/ 信息流/ 上/ 是/ 相反/ 的/ ./ 如果/ 直接/ 采用/ 两种/ 模型/ 来/ 保障/ 移动/ 系统/ 的/ 机密性/ 和/ 完整性/ 会/ 降低/ 可用性/ [/ 11/ ]/ ./ 这种/ 情况/ 下/ 何如/ 采用/ BLP/ 和/ Biba/ 模型/ 来/ 同时/ 保障/ 移动/ 系统/ 的/ 机密性/ 与/ 完整性/ 且/ 不/ 降低/ 可用性/ 成/ 了/ 一个/ 问题/ ./ 针对/ 该/ 问题/ ,/ 本文/ 利用/ π/ 演算/ 能够/ 有效/ 建模/ 移动/ 并发/ 系统/ 的/ 特征/ ,/ 借鉴/ 程序语言/ 中/ 不同/ 类型/ 变量/ 之间/ 的/ 赋值/ 方式/ ,/ 提出/ 混杂/ 类型/ 检测/ 安全/ π/ 演算/ (/ HybridTypedSecurity/ π/ ,/ π/ HTS/ )/ ./ 根据/ π/ HTS/ 利用/ 静态/ 类型/ 检测/ 保障/ 低机/ 密级信息/ 只能/ 向/ 同等/ 或/ 更/ 高机/ 密级信息/ 流动/ ,/ 及/ 高/ 完整/ 级/ 信息/ 只能/ 向/ 同等/ 或/ 更/ 低/ 完整/ 级/ 信息/ 流动/ ./ 针对/ BLP/ 模型/ 和/ Biba/ 模型/ 在/ 信息流/ 向上/ 的/ 相反/ 性/ ,/ 提出/ 了/ 动态/ 检测/ 框架/ ./ π/ HTS/ 将/ 静态/ 检测/ 和/ 动态/ 检测/ 有机/ 地/ 整合/ 在/ 一起/ ,/ 形成/ 了/ 一种/ 统一/ 的/ 安全/ 形式/ 模型/ ./ 它/ 能/ 同时/ 保障/ 移动/ 计算/ 中/ 的/ 机密性/ 和/ 完整性/ ,/ 且/ 不/ 降低/ 可用性/ ./ 2/ π/ HTS/ 中/ 的/ 类型/ 及/ 前序/ 关系/ 为了/ 给出/ 保障/ 机密性/ 和/ 完整性/ 的/ 类型化/ 安全/ π/ 演算/ ,/ 需要/ 给出/ 进程/ 或项/ 的/ 类型/ ,/ 为此/ ,/ 首先/ 讨论/ 与/ 类型/ 相关/ 的/ 预/ 类型/ ./ ①/ ②/ Page32/ ./ 1/ 预/ 类型/ 首先/ 定义/ π/ HTS/ 的/ 预/ 类型/ ,/ 如下/ :/ preT/ ·/ ·/ ·/ ·/ =/ base/ |/ {/ L1/ ,/ L2/ ,/ …/ ,/ Ln/ }/ ;/ base/ ·/ ·/ ·/ ·/ =/ (/ SC/ ,/ SL/ )/ |/ (/ IC/ ,/ IL/ )/ |/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL/ )/ ;/ L/ ·/ ·/ ·/ ·/ =/ ch/ +/ 〈/ preT/ 〉/ |/ ch/ -/ 〈/ preT/ 〉/ ./ 预/ 类型/ (/ preT/ )/ 包含/ 了/ 两类/ :/ 基值/ 预/ 类型/ base/ (/ 用来/ 描述/ 算子/ 中/ 变量/ 或名/ 的/ 预/ 类型/ )/ 和/ 信道/ 预/ 类型/ {/ L1/ ,/ L2/ ,/ …/ ,/ Ln/ }/ ./ 基值/ 预/ 类型/ 包含/ 了/ 机密/ 基值/ 类型/ (/ SC/ ,/ SL/ )/ 、/ 完整/ 基值/ 类型/ (/ IC/ ,/ IL/ )/ 及/ 混杂/ 基值/ 类型/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL/ )/ ./ 机密/ 基值/ 类型/ (/ SC/ ,/ SL/ )/ 是/ 一个二元/ 组/ ,/ 其中/ ,/ 第/ 1/ 维为/ 信息/ 的/ 机密性/ 范畴/ (/ Category/ )/ ,/ 如/ 文献/ [/ 12/ ]/ 中/ 的/ US/ 和/ EUR/ 等/ ,/ 第/ 2/ 维/ 表示/ 该/ 信息/ 运行/ 的/ 机密/ 级/ 标签/ ,/ 如/ 机密/ 、/ 绝密/ 等/ ./ 由于/ 实际/ 应用/ 中/ SC/ 和/ SL/ 依据/ 不同/ 的/ 应用/ 而/ 可能/ 不同/ ,/ 所以/ 对/ SC/ 和/ SL/ 没有/ 做/ 明确/ 限制/ (/ 后面/ 的/ IC/ 和/ IL/ 类似/ )/ ./ 同样/ ,/ 完整/ 基值/ 类型/ (/ IC/ ,/ IL/ )/ 也/ 是/ 一个二元/ 组/ ,/ 其中/ ,/ 第/ 1/ 维/ 表示/ 完整性/ 范畴/ ,/ 如/ 文献/ [/ 12/ ]/ 中/ 的/ “/ 生产/ (/ SP/ )/ ”/ 、/ “/ 开发/ (/ SD/ )/ ”/ 和/ “/ 系统/ 开发/ (/ SSD/ )/ ”/ 等/ ,/ 第/ 2/ 维/ 表示/ 完整/ 级/ 标签/ ,/ 如高/ 完整/ 级/ 、/ 低/ 完整/ 级/ 等/ ./ 混杂/ 基值/ 类型/ 是/ 机密/ 基值/ 类型/ 和/ 完整/ 基值/ 类型/ 的/ 合成/ ./ 信道/ 预/ 类型/ 用/ 集合/ 表示/ ,/ 集合/ 中/ 的/ 每个/ 元素/ 要么/ 为/ 写信/ 道/ 预/ 类型/ ch/ +/ 〈/ A/ 〉/ ①/ ,/ 要么/ 为读/ 信道/ 预/ 类型/ ch/ -/ 〈/ A/ 〉/ ./ 若/ 某/ 变量/ x/ 的/ 类型/ 为/ ch/ +/ 〈/ A/ 〉/ ,/ 这/ 意味着/ x/ 是/ 信道/ ,/ 且/ 可/ 向/ x/ 中/ 写入/ 类型/ 为/ A/ 的/ 值/ ./ 同样/ 若/ 某/ 变量/ x/ 的/ 类型/ 为/ ch/ -/ 〈/ A/ 〉/ ,/ 这/ 意味着/ x/ 是/ 信道/ ,/ 且/ 可/ 从/ x/ 中/ 读出/ 类型/ 为/ A/ 的/ 值/ ./ 若/ 将/ 信道/ 预/ 类型/ 集合/ 直接/ 作为/ 相应/ 的/ 值/ 类型/ ,/ 而/ 不/ 对/ 读写/ 信道/ 的/ 能力/ 做/ 限制/ ,/ 这/ 可能/ 会/ 导致/ 信息/ 流动/ 违反/ BLP/ 模型/ 或/ Biba/ 模型/ ./ 如若/ 将/ {/ ch/ +/ 〈/ A/ 〉/ ,/ ch/ -/ 〈/ B/ 〉/ }/ 直接/ 作为/ 信道/ 的/ 类型/ (/ 即/ 可以/ 向/ 该/ 信道/ 写入/ 类型/ 为/ A/ 的/ 值/ ,/ 也/ 可以/ 从/ 该/ 信道/ 读取/ 类型/ 为/ B/ 的/ 值/ )/ ./ 此时/ ,/ 若/ A/ 的/ SL/ 为/ 高/ 机密/ 级/ ,/ B/ 的/ SL/ 为/ 低/ 机密/ 级/ ,/ 则/ 会/ 导致/ 违背/ BLP/ 模型/ (/ 因此/ 不能/ 将/ 这些/ 集合/ 直接/ 作为/ 类型/ ,/ 故而/ 称之为/ 预/ 类型/ )/ ,/ 为了/ 避免/ 这种/ 情况/ ,/ 需要/ 先/ 定义/ 子/ 类型/ 关系/ ./ 2.2/ 子/ 类型/ 由于/ 机密性/ 基值/ 类型/ 和/ 完整性/ 基值/ 类型/ 均/ 为/ 二元/ 组/ ,/ 为了/ 定义/ 预/ 类型/ 上/ 的/ 子/ 类型/ 关系/ ,/ 我们/ 先/ 讨论/ 维上/ 的/ 关系/ ./ 对于/ 第/ 1/ 维/ ,/ 用/ / 表示/ 机密性/ 范畴/ (/ SC/ )/ 或/ 完整性/ 范畴/ (/ IC/ )/ 上/ 的/ 子/ 类型/ 关系/ ②/ ./ 该/ 关系/ 的/ 定义/ 依据/ 不同/ 的/ 应用/ 而/ 不同/ ,/ 本文/ 定义/ 基值/ 机密性/ 范畴/ 或/ 基值/ 完整性/ 范畴/ 上/ 的/ 子/ 类型/ 关系/ / 为/ 集合/ 上/ 的/ 包含/ 于/ 关系/ / ,/ 如/ 对于/ 上/ 一/ 小节/ 的/ 基值/ 机密性/ 类型/ US/ 和/ EUR/ ,/ 有/ {/ US/ }/ / {/ US/ ,/ EUR/ }/ ./ 对于/ 第/ 2A/ / B/ 维/ ,/ 机密性/ 信息流/ 和/ 完整性/ 信息流/ 均/ 可/ 看成/ 完全/ 格/ ,/ 因此/ ,/ 在/ 机密/ 级/ 上/ 和/ 完整/ 级/ 上/ 分别/ 构成/ 偏序/ 关系/ (/ 分别/ 用/ / S/ 和/ / I/ 表示/ )/ ./ 其/ 含义/ 如下/ :/ 若/ sl1/ 和/ sl2/ 为/ 机密/ 级/ 标签/ 集合/ 上/ 的/ 两个/ 元素/ ,/ il1/ 和/ il2/ 为/ 完整/ 级/ 标签/ 集合/ 上/ 的/ 两个/ 元素/ ,/ 则/ sl1/ / Ssl2/ 表示/ 标签/ 为/ sl2/ 的/ 机密性/ 高于/ 标签/ 为/ sl1/ 的/ 机密性/ ,/ il1/ / Iil2/ 表示/ 标签/ 为/ il2/ 的/ 完整性/ 高于/ 标签/ 为/ il1/ 的/ 完整性/ ./ 由此/ ,/ 类似/ 于/ 文献/ [/ 9/ ]/ ,/ 预/ 类型/ 上/ 的/ 子/ 类型/ 关系/ 可定义/ 如下/ :/ Sub/ -/ secr/ -/ baseSC1/ / SC2SL1/ / SSL2/ (/ SC1/ ,/ SL1/ )/ / (/ SC2/ ,/ SL2/ )/ Sub/ -/ hybrid/ -/ baseSC1/ / SC2SL1/ / SSL2IC2/ / IC1IL2/ / IIL1/ (/ SC1/ ,/ SL1/ ,/ IC1/ ,/ IL1/ )/ / (/ SC2/ ,/ SL2/ ,/ IC2/ ,/ IL2/ )/ ;/ Sub/ -/ wrch/ +/ 〈/ B/ 〉/ / ch/ +/ 〈/ A/ 〉/ Sub/ -/ link/ (/ / j/ )/ (/ / i/ )/ Li/ / Lj/ {/ Li/ }/ i/ ∈/ I/ / {/ Lj/ }/ j/ ∈/ J/ 上面/ 定义/ 中/ 最/ 上面/ 一/ 行为/ 相应/ 子/ 类型/ 规则/ 的/ 名称/ ,/ 如/ Sub/ -/ secr/ -/ base/ 为/ SC1/ / SC2SL1/ / SSL2/ 名称/ ./ Sub/ -/ secr/ -/ base/ 表明/ ,/ 若/ SC1/ 是/ SC2/ 的/ 子/ 类型/ ,/ 且/ 机密/ 级别/ SL1/ 小于/ SL2/ ,/ 则/ (/ SC1/ ,/ SL1/ )/ 为/ (/ SC2/ ,/ SL2/ )/ 的/ 子/ 类型/ ./ Sub/ -/ inte/ -/ base/ 与/ Sub/ -/ secr/ -/ base/ 相反/ ,/ 若/ IC1/ 是/ IC2/ 的/ 子/ 类型/ ,/ 且/ 完整性/ 级别/ IL1/ 小于/ IL2/ ,/ 则/ (/ IC2/ ,/ IL2/ )/ 为/ (/ IC1/ ,/ IL1/ )/ 的/ 子/ 类型/ ./ Sub/ -/ hybrid/ -/ base/ 是/ Sub/ -/ secr/ -/ base/ 和/ Sub/ -/ inte/ -/ base/ 的/ 合成/ ./ 对于/ 写信/ 道/ 类型/ ,/ 规则/ Sub/ -/ wr/ 表明/ ,/ 对于/ 值预/ 类型/ A/ 和/ B/ ,/ 若/ A/ 为/ B/ 的/ 子/ 类型/ ,/ 则/ ch/ +/ 〈/ B/ 〉/ 是/ ch/ +/ 〈/ A/ 〉/ 的/ 子/ 类型/ ./ 而/ 对于/ 读/ 信道/ 类型/ ,/ 规则/ Sub/ -/ rd/ 表明/ ,/ 对于/ 值预/ 类型/ A/ 和/ B/ ,/ 若/ A/ 为/ B/ 的/ 子/ 类型/ ,/ 则/ ch/ -/ 〈/ A/ 〉/ 是/ ch/ -/ 〈/ B/ 〉/ 的/ 子/ 类型/ ./ 规则/ Sub/ -/ link/ 表明/ ,/ 若/ 信道/ 预/ 类型/ {/ Li/ }/ i/ ∈/ I/ 为/ {/ Lj/ }/ j/ ∈/ J/ 的/ 子/ 类型/ ,/ 则/ 要求/ 对/ 任意/ 的/ Lj/ 均/ 存在/ Li/ 使得/ Li/ 为/ Lj/ 的/ 子/ 类型/ ./ 规则/ Sub/ -/ pwt/ 显示/ ,/ 对于/ 进程/ 类型/ pwt/ ,/ 自身/ 互为/ 子/ 类型/ ./ 下面/ 以/ BLP/ 模型/ 中/ 的/ 策略/ 为例/ ,/ 进一步/ 阐释/ 子/ 类型/ 关系/ 的/ 含义/ (/ Biba/ 模型/ 与/ 此/ 类似/ )/ ./ ①/ ②/ Page4/ (/ 1/ )/ 若/ 变量/ x/ 和/ y/ 的/ 类型/ 分别/ 为/ (/ {/ US/ }/ ,/ public/ )/ 和/ (/ {/ US/ ,/ EUR/ }/ ,/ secrecy/ )/ ,/ 即/ x/ 的/ 范畴/ 为/ US/ ,/ y/ 的/ 范畴/ 为/ US/ 和/ EUR/ ,/ 且/ x/ 和/ y/ 的/ 机密/ 级别/ 分别/ 为/ public/ 和/ secrecy/ ,/ 则/ 有/ (/ {/ US/ }/ ,/ public/ )/ / (/ {/ US/ ,/ EUR/ }/ ,/ secrecy/ )/ ,/ 即/ 机密/ 级别/ 为/ public/ 的/ 数据/ 可/ 看着/ 机密/ 级别/ 为/ secrecy/ 的/ 数据/ ①/ ,/ 这/ 符合/ BLP/ 模型/ ,/ 并/ 不/ 违背/ 数据/ 机密性/ ./ (/ 2/ )/ 若/ x/ :/ ch/ +/ 〈/ (/ {/ US/ ,/ EUR/ }/ ,/ secrecy/ )/ 〉/ 和/ y/ :/ ch/ +/ 〈/ (/ {/ US/ }/ ,/ public/ )/ 〉/ ,/ 即为/ x/ 和/ y/ 均/ 为/ 写信/ 道/ 类型/ ,/ 且/ 能够/ 向/ 信道/ x/ 中/ 写入/ 机密/ 级别/ 为/ secrecy/ 的/ 数据/ ,/ 向/ 信道/ y/ 中/ 写入/ 机密/ 级别/ 为/ public/ 的/ 数据/ ./ 采用/ Sub/ -/ wr/ 规则/ 有/ x/ :/ ch/ +/ 〈/ (/ {/ US/ ,/ EUR/ }/ ,/ secrecy/ )/ 〉/ / ch/ +/ 〈/ (/ {/ US/ }/ ,/ public/ )/ 〉/ ,/ 即/ 在/ 机密/ 级别/ 为/ secrecy/ 的/ 信道/ x/ 中/ 可/ 写入/ 机密/ 级别/ 为/ public/ 的/ 数据/ ,/ 这/ 并/ 没/ 违反/ 机密性/ 模型/ (/ 因为/ 在/ 写入/ 机密/ 级别/ 为/ public/ 的/ 数据/ 之后/ ,/ 会/ 将/ 其/ 机密/ 级别/ 提升/ 为/ secrecy/ )/ ./ 文献/ [/ 9/ ]/ 采用/ 某个/ 安全级别/ 所/ 能/ 访问/ 的/ 信息/ 作为/ 基值/ 类型/ ,/ 这隐式/ 地/ 表明/ 了/ 该/ 安全级别/ 能/ 访问/ 所有/ 处于/ 该/ 级别/ 范畴/ 的/ 信息/ ,/ 并/ 暗含/ 了/ 高/ 安全/ 级/ 能/ 访问/ 所有/ 低/ 安全/ 级/ 能/ 访问/ 的/ 信息/ (/ 低/ 安全/ 级/ 能/ 访问/ 的/ 作为/ 高/ 安全/ 级/ 能/ 访问/ 的/ 子/ 类型/ )/ ,/ 然而/ 这/ 对于/ Biba/ 模型/ 来说/ 并/ 不/ 成立/ ./ 因此/ ,/ 我们/ 在/ 基值/ 类型定义/ 中/ 区分/ 机密性/ 和/ 完整性/ ,/ 并/ 将/ 范畴/ 和/ 级别/ 所/ 形成/ 的/ 元组/ 作为/ 基值/ 类型/ ./ 从子/ 类型/ 规则/ 可以/ 看出/ ,/ 对于/ 机密性/ 基值/ 类型/ ,/ 其/ 合成/ 是/ 协变/ 的/ (/ Covariant/ )/ ,/ 而/ 对于/ 完整性/ 基值/ 类型/ ,/ 其/ 合成/ 是/ 逆变/ 的/ (/ Contra/ -/ variant/ )/ ./ 这/ 是因为/ BLP/ 模型/ 需要/ 保障/ 数据/ 只能/ 从/ 低/ 机密/ 级/ 流向/ 同等/ 或/ 高/ 机密/ 级/ ,/ 而/ Biba/ 模型/ 需要/ 保障/ 信息/ 只能/ 从/ 高/ 完整/ 级/ 流向/ 同等/ 或/ 低/ 完整/ 级/ ./ 另外/ ,/ 写信/ 道/ 预/ 类型/ 的/ 子/ 类型/ 是/ 逆变/ 的/ ,/ 而读/ 信道/ 预/ 类型/ 的/ 子/ 类型/ 是/ 协变/ 的/ ./ 这/ 是因为/ 若/ 某个/ 变量/ 为/ 写信/ 道/ 预/ 类型/ ,/ 则/ 其/ 信息/ 是/ 流入/ 该/ 信道/ ;/ 而/ 若/ 某个/ 变量/ 为读/ 信道/ 预/ 类型/ ,/ 则/ 其/ 信息/ 是从/ 该/ 信道/ 流出/ ./ 相对/ 于/ 信道/ 来说/ ,/ 这/ 两种/ 流向/ 是/ 相反/ 的/ ./ 2.3/ 类型/ 如/ 第/ 2.1/ 节/ 所述/ ,/ 预/ 类型/ 不能/ 直接/ 作为/ 类型/ ./ 为了/ 将/ 之/ 作为/ 类型/ ,/ 必须/ 依据/ BLP/ 和/ Biba/ 模型/ 对/ 其/ 进行/ 限制/ ,/ 下面/ 给出/ 类型/ 的/ 定义/ :/ TBASES/ {/ (/ SC/ ,/ SL/ )/ }/ ∈/ TYPE/ ;/ TBASEH/ {/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL/ )/ }/ ∈/ TYPE/ ;/ TRD/ {/ ch/ -/ 〈/ A/ 〉/ }/ ∈/ TYPE/ ;/ A/ ∈/ TYPE/ 在/ 上面/ 的/ 类型定义/ 中/ ,/ 最/ 上面/ 一/ 行为/ 类型/ 的/ 名称/ ,/ 如/ {/ (/ SC/ ,/ SL/ )/ }/ ∈/ TYPE/ 的/ 名称/ 为/ TBASES/ ./ TBASES/ 的/ 含义/ 是/ (/ SC/ ,/ SL/ )/ 为/ 类型/ ./ TWR/ 和/ TRD/ 表明/ 单个/ 写/ 或/ 读/ 信道/ 预/ 类型/ 可/ 作为/ 类型/ ./ 这些/ 规则/ 中/ 值得注意/ 的/ 是/ TWRRD/ ,/ TWRRD/ 表明/ 若/ A/ 为/ B/ 的/ 子/ 类型/ ,/ 则/ {/ ch/ +/ 〈/ A/ 〉/ ,/ ch/ -/ 〈/ B/ 〉/ }/ 为/ 类型/ ./ 若/ 某个/ 变量/ 的/ 类型/ 为/ {/ ch/ +/ 〈/ A/ 〉/ ,/ ch/ -/ 〈/ B/ 〉/ }/ ,/ 则/ :/ (/ 1/ )/ 该/ 变量/ 的/ 类型/ 是/ 信道/ 类型/ ,/ (/ 2/ )/ A/ 是/ B/ 的/ 子/ 类型/ ,/ (/ 3/ )/ 可/ 向/ 变量/ 中/ 写入/ 类型/ 为/ A/ 的/ 值/ ,/ (/ 4/ )/ 可/ 从/ 该/ 变量/ 中/ 读出/ 类型/ 为/ B/ 的/ 值/ ./ 这/ 意味着/ 信道/ 中子/ 类型/ 的/ 信息/ 能够/ 流向/ 其父/ 类型/ ,/ 但父/ 类型/ 的/ 信息/ 不能/ 流向/ 子/ 类型/ ./ 同/ 文献/ [/ 9/ ]/ 相比/ ,/ 在/ 类型定义/ 中/ 我们/ 区分/ 了/ 机密性/ 类型/ 和/ 完整性/ 类型/ ./ TBASES/ ,/ 对于/ 其它/ 规则/ 的/ 考察/ 是/ 类似/ 的/ ./ 命题/ 1/ ./ 类型/ 上/ 的/ 子/ 关系/ / 为/ 前序/ 关系/ ./ 证明/ ./ 对/ TYPE/ 的/ 定义/ 作/ 归纳/ ,/ 这里/ 只/ 考察/ 对于/ TBASES/ :/ (/ 1/ )/ 首先/ 证明/ 由/ TBASES/ 而/ 得到/ 的/ 类型/ 关于/ / 是/ 自反/ 的/ ./ 由于/ / 为/ 基值/ 机密性/ 范畴/ 上/ 的/ 包含/ 关系/ ,/ 故/ SC/ / SC/ ;/ 因为/ / S/ 为/ 机密性/ 级/ 上/ 的/ 偏序/ 关系/ ,/ 故/ SL/ / SSL/ ./ 由/ Sub/ -/ secr/ -/ base/ 规则/ 有/ (/ SC/ ,/ SL/ )/ / (/ SC/ ,/ SL/ )/ ,/ 因此/ 依据/ TBASES/ 而/ 得到/ 的/ 类型/ 关于/ / 是/ 自反/ 的/ ./ (/ 2/ )/ 其次/ 证明/ 由/ TBASES/ 而/ 得到/ 的/ 类型/ 关于/ / 是/ 传递/ 的/ ./ 假设/ (/ SC1/ ,/ SL1/ )/ / (/ SC2/ ,/ SL2/ )/ ,/ (/ SC2/ ,/ SL2/ )/ / (/ SC3/ ,/ SL3/ )/ ,/ 由于/ 这些/ 关系/ 只能/ 采用/ Sub/ -/ secr/ -/ base/ 规则/ 而/ 得到/ ,/ 因此/ 有/ SC1/ / SC2/ ,/ SC2/ / SC3/ ,/ SL1/ / SSL2/ ,/ SL2/ / SSL3/ ./ 基值/ 机密性/ 范畴/ 上/ 的/ / 为/ 包含/ 关系/ ,/ 故有/ SC1/ / SC3/ ;/ 而/ / S/ 为/ 机密/ 级别/ 上/ 的/ 偏序/ 关系/ ,/ 所以/ / S/ 为/ 传递/ 的/ ,/ 即/ SL1/ / SSL3/ ./ 由/ Sub/ -/ secr/ -/ base/ 有/ (/ SC1/ ,/ SL1/ )/ / (/ SC3/ ,/ SL3/ )/ ,/ 即/ 由/ 规则/ TBASES/ 而/ 得到/ 的/ 类型/ 关于/ / 是/ 传递/ 的/ ./ 故由/ TBASES/ 而/ 得到/ 的/ 类型/ 关于/ / 是/ 前序/ 的/ ./ 后文/ 我们/ 用/ 变量/ R/ ,/ S/ ,/ T/ 表示/ 类型/ ./ 定义/ 1/ (/ 类型/ 环境/ )/ ./ 若/ 将/ 给定/ 变量/ x/ 赋予/ 一个/ 类型/ T/ (/ 简称/ 为/ 赋型/ )/ ,/ 其/ 形式/ 记为/ x/ :/ T/ ,/ 则/ 类型/ 环境/ 为/ 赋型/ 的/ 有限/ 集合/ ./ 用/ Γ/ 或/ Δ/ 表示/ 类型/ 环境/ ,/ 类型/ 环境/ 的/ 语法/ 为/ 在/ 类型/ 环境/ 中/ ,/ 所有/ 变量名/ 均/ 应/ 不同/ ./ 给定/ 一个/ ①/ 此处/ 解释/ 未/ 涉及/ 类别/ ,/ 下面/ 的/ 解释/ 类似/ ./ Page5/ 类型/ 环境/ ,/ 用/ 函数/ 方式/ 表示/ 变量/ 的/ 类型/ ,/ 如/ ,/ 若/ Γ/ =/ {/ x/ :/ T1/ ,/ y/ :/ T2/ }/ ,/ 则/ Γ/ (/ x/ )/ =/ T1/ ,/ Γ/ (/ y/ )/ =/ T2/ ,/ 即/ 环境/ Γ/ 中/ ,/ x/ 的/ 类型/ 为/ T1/ ,/ y/ 的/ 类型/ 为/ T2/ ./ 3/ π/ HTS/ 演算/ 上/ 节/ 定义/ 了/ 移动/ 系统/ 所/ 需/ 的/ 类型/ ,/ 为了/ 有效/ 地/ 利用/ π/ 演算/ 来/ 建模/ 移动/ 计算/ 中/ 的/ 机密性/ 和/ 完整性/ ,/ 需要/ 将/ 其/ 类型化/ ,/ 我们/ 称/ 类型化/ 之后/ 的/ 安全/ π/ 演算/ 为/ π/ HTS/ ./ 下面/ 给出/ π/ HTS/ 的/ 语法/ 和/ 形式/ 语义/ 及其/ 简单/ 解释/ ./ 除了/ 类型化/ 及/ 类型/ 转化/ 算子/ 之外/ ,/ 其/ 语法/ 和/ 语义/ 类似/ 于/ 标准/ π/ 演算/ [/ 9/ ,/ 13/ ]/ ./ 3.1/ π/ HTS/ 语法/ π/ HTS/ 的/ 语法/ 定义/ 如下/ :/ P/ ,/ Q/ ·/ ·/ ·/ ·/ =/ u/ ,/ v/ ·/ ·/ ·/ ·/ =/ bv/ |/ x/ ,/ y/ ,/ z/ |/ a/ ,/ b/ ,/ c/ 其中/ ,/ π/ / P/ 为/ 前缀/ 操作/ ,/ 其/ 含义/ 为先/ 执行/ 前缀/ π/ ,/ 而后/ 执行/ P/ ./ 前缀/ π/ 有/ 两类/ :/ 输入/ u/ ?/ (/ x/ :/ T/ )/ 和/ 输出/ u/ !/ v/ ,/ 其中/ ,/ u/ ?/ (/ x/ :/ T/ )/ 表示/ 接收/ 源自/ 于/ 信道/ u/ 上/ 的/ 值/ ,/ 并/ 将/ 其/ 植入/ 类型/ 为/ T/ (/ 其/ 接收/ 值/ 的/ 类型/ 必须/ 为/ T/ )/ 的/ 变量/ x/ 中/ ;/ u/ !/ v/ 表示/ 将值/ v/ 发布/ 到/ 信道/ u/ 上/ ./ (/ ν/ a/ :/ T/ )/ P/ 为/ 限制/ 操作/ ,/ 表示/ a/ 的/ 类型/ 为/ T/ ,/ 其/ 作用/ 范围/ 为/ P/ ./ P/ |/ Q/ 表示/ P/ 和/ Q/ 并发/ 运行/ ./ !/ P/ 为/ 复制/ 操作/ ,/ 表示/ 重复/ 执行/ P/ ./ 值/ 包括/ 三/ 部分/ :/ 名/ (/ a/ )/ 、/ 变量/ (/ x/ )/ 和/ 基值/ (/ bv/ )/ ,/ 其中/ ,/ 名/ 代表/ 信道/ ,/ 变量/ 表示/ 可/ 被/ 任何/ 项/ 替换/ 的/ 形式参数/ ./ 虽然/ 标准/ π/ 演算/ 并未/ 区分/ 名/ 和/ 变量/ ,/ 但是/ 区分/ 名/ 和/ 变量/ 可简化/ 关系/ 的/ 处理/ [/ 14/ ]/ ./ ifu/ =/ vthenPelseQ/ 为/ 匹配/ 操作/ ./ 下面/ 详细/ 讨论/ let/ 算子/ ,/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQ/ 的/ 含义/ 为/ :/ 若/ u/ 的/ 类型/ 为/ S/ ,/ 且/ 能够/ 转化/ 类型/ 为/ T/ 的/ 值/ ,/ 转化/ 之后/ 的/ 值用/ u/ 表示/ ,/ x/ 的/ 类型/ 为/ T/ ,/ 则/ 该/ 算子/ 将/ P/ 中/ 的/ x/ 替换/ 为/ u/ ,/ 否则/ 保持/ Q/ 不变/ ./ / 包含/ 了/ 两个/ 算子/ :/ 公开/ 算子/ / public/ 和/ 净化/ 算子/ / sanitized/ ./ 公开/ 用来/ 建模/ 对/ 高机/ 密级信息/ 进程/ 处理/ ,/ 使之能/ 向/ 低机/ 密级信息/ 流动/ ./ 如/ 移动/ 支付/ 系统/ 中/ 用户/ 的/ 密码/ 属于/ 高/ 机密/ 级/ ,/ 移动/ 信道/ 属于/ 低/ 机密/ 级/ ,/ 依照/ BLP/ 模型/ ,/ 密码/ 不能/ 在/ 移动/ 信道/ 中/ 传输/ ./ 这种/ 情况/ 下/ 可/ 采用/ 加密算法/ 将/ 密码/ 进行/ 加密/ ,/ 以此/ 将/ 高/ 安全级别/ 的/ 密码/ 转化/ 为/ 低/ 安全级别/ 的/ 密文/ ,/ 进而/ 可/ 在/ 移动/ 信道/ 上/ 传输/ ./ 这个/ 例子/ 中/ 加密/ 过程/ 属于/ 公开/ 算子/ ,/ 可/ 粗略地/ 描述/ 为/ (/ S/ / publicT/ )/ (/ u/ →/ u/ )/ ,/ 其中/ ,/ 信息/ u/ 的/ 初始/ 类型/ 为/ S/ =/ (/ -/ ,/ secrecy/ ,/ -/ ,/ -/ )/ ,/ 经过/ 加密/ 之后/ 转化/ 为/ u/ ,/ u/ 的/ 类型/ T/ =/ (/ -/ ,/ public/ ,/ -/ ,/ -/ )/ ,/ 即将/ 秘密/ 级/ 类型/ 转化/ 为/ 公开/ 级/ 类型/ ./ 净化/ 算子/ 建模/ 对/ 低/ 完整/ 级/ 信息/ 进行/ 处理/ ,/ 使之能/ 向/ 高/ 完整/ 级/ 信息/ 流动/ ./ 如/ 传感器/ 网络/ 中/ 传感/ 节点/ 收集/ 的/ 信息/ 为/ 低/ 完整/ 级/ ,/ 中央/ 决策/ 器所/ 接收/ 的/ 信息/ 为/ 高/ 完整/ 级/ ,/ 这样/ 低/ 完整/ 级/ 的/ 信息/ 传给/ 中央/ 决策/ 器/ 之前/ 会/ 经过/ 准确性/ 判定/ 模块/ ,/ 这里/ 准确性/ 判定/ 模块/ 属于/ 净化/ 算子/ ,/ 整个/ 过程/ 可/ 表示/ 为/ (/ S/ / sanitizedT/ )/ (/ u/ →/ u/ )/ ,/ 其中/ ,/ u/ 的/ 初始/ 类型/ 为/ S/ =/ (/ -/ ,/ -/ ,/ -/ ,/ tainted/ )/ (/ 即/ 为/ 低/ 完整/ 级/ )/ ,/ 经过/ 准确性/ 判定/ 模块/ 处理/ 之后/ 转化/ 为/ u/ ,/ u/ 的/ 类型/ 为/ T/ =/ (/ -/ ,/ -/ ,/ -/ ,/ untainted/ )/ (/ 即/ 为/ 高/ 完整/ 级/ )/ ./ 公开/ 算子/ 的/ 操作/ 规则/ 为/ (/ (/ SC1/ ,/ SL/ ,/ IC/ ,/ IL/ )/ / public/ (/ SC2/ ,/ SL/ ,/ IC/ ,/ IL/ )/ )/ (/ u/ →/ u/ )/ (/ (/ SC/ ,/ SL1/ ,/ IC/ ,/ IL/ )/ / public/ (/ SC/ ,/ SL2/ ,/ IC/ ,/ IL/ )/ )/ (/ u/ →/ u/ )/ ./ 该/ 规则/ 表明/ 公开/ 算子/ 针对/ 的/ 是/ 机密/ 标签/ 或/ 机密性/ 范畴/ ,/ 并/ 不/ 涉及/ 完整性/ ./ 对于/ 机密性/ 标签/ 来说/ ,/ 若基/ 类型/ 的/ 公开/ 操作/ 能够/ 成功/ ,/ 则/ 转化/ 前/ 的/ 机密/ 级别/ 不/ 低于/ 转化/ 后/ 的/ 机密/ 级别/ ./ 类似/ 地/ ,/ 净化/ 算子/ 的/ 规则/ 为/ (/ (/ SC/ ,/ SL/ ,/ IC1/ ,/ IL/ )/ / sanitized/ (/ SC/ ,/ SL/ ,/ IC2/ ,/ IL/ )/ )/ (/ u/ →/ u/ )/ (/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL1/ )/ / sanitized/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL2/ )/ )/ (/ u/ →/ u/ )/ ./ 3.2/ π/ HTS/ 语义/ π/ HTS/ 的/ 操作/ 语义/ 如下/ :/ P/ ≡/ PP/ |/ 0/ ≡/ P/ !/ P/ ≡/ P/ |/ !/ PP/ |/ Q/ ≡/ Q/ |/ P/ (/ P/ |/ Q/ )/ |/ R/ ≡/ P/ |/ (/ Q/ |/ R/ )/ (/ ν/ a1/ :/ T/ )/ (/ ν/ a2/ :/ S/ )/ P/ ≡/ (/ ν/ a2/ :/ S/ )/ (/ ν/ a1/ :/ T/ )/ PP/ ≡/ QQ/ ≡/ PP/ ≡/ Q/ (/ ν/ a/ :/ T/ )/ P/ ≡/ (/ ν/ a/ :/ T/ )/ Qa/ / fn/ (/ P/ )/ MATEifu/ =/ uthenPelseQ/ →/ PPage6MATNu/ ≠/ vI/ // O/ (/ a/ !/ v/ )/ / P/ |/ a/ (/ x/ :/ T/ )/ / Q/ →/ P/ |/ Q/ {/ v/ // x/ }/ REPP/ →/ PRESP/ →/ P/ (/ ν/ a/ :/ T/ )/ P/ →/ (/ ν/ a/ :/ T/ )/ P/ ≡/ P/ ≡/ PP/ →/ QQ/ ≡/ QLET1/ Γ/ / u/ :/ Tlet/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQ/ →/ P/ {/ u/ // x/ }/ LET2let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQ/ →/ Q/ π/ HTS/ 操作/ 语义/ 类似/ 于/ 标准/ π/ 演算/ 的/ 操作/ 语义/ ,/ 不同之处/ 在于/ 类型化/ 及/ 类型/ 转化/ 算子/ (/ 包括/ 公开/ 算子/ 和/ 净化/ 算子/ )/ ,/ 下面/ 详细/ 解释/ 类型/ 转化/ 算子/ ./ Γ/ / u/ :/ T/ 表示/ 类型/ 环境/ 中项/ u/ 的/ 类型/ 被/ 动态/ 地/ 判定/ 为/ T/ ,/ Γ/ |/ ≠/ u/ :/ T/ 表示/ 类型/ 环境/ 中项/ u/ 的/ 类型/ 被/ 判定/ 为/ 非/ T/ ./ 这种/ 判定/ 结果/ 是/ 通过/ 动态/ 检测/ 而/ 得/ 出来/ 的/ (/ 如/ 类型化/ 的/ 代码/ 分析/ [/ 15/ ]/ 等/ )/ ,/ 并/ 不是/ 通过/ 类型/ 的/ 静态/ 推理/ 而/ 得到/ ./ 判定/ 的/ 正确性/ 依赖于/ 各种/ 动态/ 类型/ 检测/ 模块/ 的/ 可靠性/ ./ 虽然/ 相对来说/ 设计/ 动态/ 类型/ 检测/ 模块/ 比较/ 难/ ,/ 但/ 通过/ 细致/ 的/ 设计/ 是/ 可以/ 实现/ 的/ ,/ 如/ 加密算法/ 提供/ 了/ 一个/ 从/ 高/ 安全/ 级/ 向/ 低/ 安全/ 级/ 转化/ 的/ 手段/ ./ 若/ 动态/ 类型/ 检测/ 模块/ 是/ 可靠/ 的/ ,/ 则/ 认为/ Γ/ / u/ :/ T/ 蕴含/ 了/ Γ/ |/ -/ u/ :/ T/ ./ 后文/ 假设/ 动态/ 类型/ 检测/ 模块/ 是/ 可靠/ 的/ ./ LET1/ 和/ LET2/ 意味着/ :/ 若/ 动态/ 地/ 判定/ u/ 的/ 类型/ 与/ 变量/ x/ 的/ 类型/ 一致/ ,/ 则/ 用/ u/ 替换/ P/ 中/ 的/ x/ ;/ 否则/ ,/ 则/ 执行/ 另外/ 的/ 分支/ Q/ ./ 4/ π/ HTS/ 的/ 类型化/ 规则/ 及其/ 性质/ Γ/ |/ -/ x/ :/ TT/ -/ name/ Γ/ (/ a/ )/ / T/ 类型化/ 规则/ 分析/ 类型/ 环境/ 下值/ 的/ 类型/ 以及/ 在/ 什么/ 情况/ 下/ 进程/ 是良/ 类型/ 的/ ./ 用/ Γ/ |/ -/ / :/ T/ 来/ 表示/ 类型化/ 规则/ ,/ 其中/ ,/ Γ/ 为/ 类型/ 环境/ ,/ / 为/ 基值/ 、/ 变量/ 或名/ ,/ T/ 为/ 类型/ ,/ Γ/ |/ -/ / :/ T/ 的/ 含义/ 是/ 在/ Γ/ 环境/ 下/ ,/ / 的/ 类型/ 为/ T/ ./ 类型化/ 规则/ 如下/ 所示/ :/ T/ -/ var/ Γ/ (/ x/ )/ / TT/ -/ inte/ -/ basebv/ ∈/ (/ IC/ ,/ IL/ )/ T/ -/ secr/ -/ basebv/ ∈/ (/ SC/ ,/ SL/ )/ T/ -/ basebv/ ∈/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL/ )/ Γ/ |/ -/ bv/ :/ (/ SC/ ,/ SL/ ,/ IC/ ,/ IL/ )/ T/ -/ par/ Γ/ |/ -/ P/ Γ/ |/ -/ QT/ -/ res/ Γ/ ,/ a/ :/ T/ |/ -/ P/ Γ/ |/ -/ (/ ν/ a/ :/ T/ )/ PT/ -/ eq/ Γ/ |/ -/ u/ :/ T/ ,/ v/ :/ T/ ,/ P/ ,/ Q/ Γ/ |/ -/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQT/ -/ rd/ Γ/ ,/ x/ :/ T/ |/ -/ P/ Γ/ |/ -/ u/ :/ ch/ -/ 〈/ T/ 〉/ T/ -/ wr/ Γ/ |/ -/ v/ :/ T/ Γ/ |/ -/ u/ :/ ch/ +/ 〈/ T/ 〉/ Γ/ |/ -/ PT/ -/ Let/ Γ/ ,/ x/ :/ T/ |/ -/ P/ Γ/ |/ -/ u/ :/ S/ Γ/ |/ -/ QT/ -/ stop/ Γ/ |/ -/ 0T/ -/ inte/ -/ base/ 、/ T/ -/ secr/ -/ base/ 和/ T/ -/ base/ 中/ ,/ x/ ∈/ T/ 表示/ x/ 是/ 类型/ 为/ T/ 的/ 变量/ ./ TLet/ 意味着/ :/ 若/ 需要/ 保障/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQ/ 在/ Γ/ 中是/ 良/ 类型/ 的/ ,/ 则/ 必须/ 满足/ 如下/ 条件/ :/ (/ 1/ )/ 变量/ x/ 的/ 类型/ 为/ T/ ,/ 且/ 将/ 其/ 加入/ 到/ 环境/ Γ/ 中/ 使得/ P/ 是良/ 类型/ 的/ ;/ (/ 2/ )/ 在/ Γ/ 下/ Q/ 是良/ 类型/ 的/ ,/ 且/ u/ 具有/ 类型/ S/ ./ 注意/ ,/ 这里/ 要求/ 在/ Γ/ 下/ u/ 具有/ 类型/ S/ ,/ 而/ 不/ 要求/ u/ 具有/ 类型/ T/ ./ 其它/ 类型化/ 规则/ 的/ 解释/ 是/ 直接/ 的/ ./ 类型/ 系统/ 中/ 规则/ (/ 特别/ 是/ 与/ 子/ 类型/ 相关/ 的/ 规则/ )/ 的/ 细微/ 变化/ 都/ 可能/ 会/ 对/ 整个/ 系统/ 的/ 性质/ 产生/ 重大/ 影响/ [/ 16/ ]/ ,/ 因此/ ,/ 需要/ 证明/ 相关/ 性质/ ./ 类型/ 检测/ 中/ 一个/ 重要/ 的/ 性质/ 是/ 主题/ 规约/ (/ SubjectReduction/ )/ 和/ 主题/ 全等/ (/ SubjectCongruence/ )/ ./ 主题/ 规约/ 的/ 含义/ 是/ :/ 如果/ 类型/ 系统/ 满足/ 主题/ 规约/ ,/ 则/ 良/ 类型/ 进程/ 每步/ 演绎/ 的/ 结果/ 仍/ 是/ 良/ 类型/ 的/ ./ 体现/ 在/ 机密性/ 和/ 完整性/ 问题/ 上/ 表现/ 为/ :/ 如果/ 一个/ 进程/ 在/ 初始状态/ 既/ 能/ 保持/ 机密性/ 又/ 能/ 保持/ 完整性/ ,/ 则/ 经过/ 每次/ 操作/ 之后/ 仍然/ 既/ 能/ 保持/ 机密性/ 又/ 能/ 保持/ 完整性/ ./ 主题/ 全等/ 的/ 含义/ 是/ :/ 若/ 类型/ 系统/ 满足/ 主题/ 全等/ ,/ 则/ 与/ 良/ 类型/ 进程/ 全等/ 的/ 进程/ 仍然/ 是良/ 类型/ 的/ ./ 体现/ 在/ 机密性/ 和/ 完整性/ 问题/ 上/ 表现/ 为/ :/ 若/ 一个/ 进程/ 既/ 能/ 保持/ 机密性/ 又/ 能/ 保持/ 完整性/ ,/ 则/ 与/ 之/ 全/ 等/ 的/ 进程/ 仍/ 既/ 能/ 保持/ 机密性/ 又/ 能/ 保持/ 完整性/ ./ 在/ 初始状态/ ,/ 机密性/ 及/ 完整性/ 是/ 由/ 类型定义/ 提供/ ./ 这样/ ,/ 如果/ 良/ 类型/ 进程/ 满足/ 主题/ 规约/ 和/ 主题/ 全等/ ,/ 则/ 既/ 能/ 保持/ 机密性/ 又/ 能/ 保持/ 完整性/ ./ 一般来说/ 类型/ 系统/ 中/ 证明/ 主题/ 规约/ 定理/ 的/ 过程/ 是/ 类似/ 的/ [/ 9/ ,/ 13/ ,/ 17/ ]/ ./ 由于/ 篇幅/ 的/ 限制/ ,/ 下面/ 的/ 归纳/ 证明/ 过程/ 中/ 只/ 考察/ 最/ 复杂/ 的/ 部分/ ,/ 其它/ 部分/ 类似/ ./ 命题/ 2/ ./ 若/ Γ/ |/ -/ v/ :/ T/ 且/ T/ / S/ ,/ 则/ Γ/ |/ -/ v/ :/ S/ ./ 证明/ ./ 对/ v/ 的/ 结构/ 作/ 归纳/ (/ 只/ 考察/ v/ 为/ 基值/ 的/ 情况/ )/ ./ 若/ v/ 为/ 基值/ ,/ 即为/ bv/ ./ 由于/ v/ 为/ 基值/ ,/ 所以/ 能/ 采用/ 的/ 规则/ 只有/ T/ -/ inte/ -/ base/ 、/ T/ -/ secr/ -/ base/ 和/ T/ -/ base/ ./ 这/ 3/ 种/ 情况/ 下均/ 有/ :/ 若/ Γ/ |/ -/ bv/ :/ T/ (/ T/ 为/ 基型/ )/ ,/ 则/ bv/ ∈/ T/ ./ 由于/ bv/ 属于/ T/ 类型/ ,/ 而/ T/ 为/ S/ 的/ 子/ 类型/ ,/ 由于/ 子/ 类型/ 的/ 传递性/ ,/ 故/ bv/ 也/ 属于/ S/ 类型/ ,/ 即/ bv/ ∈/ S/ ./ 故/ Γ/ |/ -/ bv/ :/ S/ ./ Page7/ 命题/ 3/ ./ 若/ Γ/ |/ -/ v/ :/ T/ 且/ Δ/ / Γ/ ,/ 则/ Δ/ |/ -/ v/ :/ T/ ./ 证明/ ./ 对/ v/ 的/ 结构/ 作/ 归纳/ (/ 只/ 考察/ v/ 为/ 变量/ 的/ 情况/ )/ ./ 若/ v/ 为/ 变量/ ,/ 因为/ Γ/ |/ -/ x/ :/ T/ ,/ 由于/ v/ 为/ 变量/ ,/ 故其/ 只能/ 由/ T/ -/ var/ 规则/ 派生/ ,/ 因此/ Γ/ (/ x/ )/ / T/ ./ 因/ Δ/ / Γ/ ,/ 故/ Δ/ (/ x/ )/ / Γ/ (/ x/ )/ ./ 由/ 命题/ 1/ 知/ ,/ / 是/ 传递/ 的/ ,/ 故/ Δ/ (/ x/ )/ / T/ ,/ 由/ T/ -/ var/ 有/ Δ/ |/ -/ x/ :/ T/ ./ 命题/ 4/ ./ 若/ Γ/ |/ -/ P/ 且/ Δ/ / Γ/ ,/ 则/ Δ/ |/ -/ P/ ./ 证明/ ./ 对/ P/ 的/ 结构/ 作/ 归纳/ (/ 只/ 考察/ P/ 为/ let/ 的/ 情况/ )/ ./ 令/ P/ 为/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inP1elseQ1/ ,/ 且/ Γ/ |/ -/ P/ ,/ 由于/ 这/ 只能/ 采用/ T/ -/ Let/ 规则/ 而/ 得到/ ,/ 故有/ Γ/ |/ -/ u/ :/ S/ ,/ Γ/ |/ -/ Q1/ 和/ Γ/ ,/ x/ :/ T/ |/ -/ P1/ ./ 因为/ Δ/ / Γ/ ,/ 由/ 命题/ 3/ 有/ Δ/ |/ -/ u/ :/ S/ ./ 由/ 归纳/ 有/ Δ/ |/ -/ Q1/ ./ 另外/ ,/ 利用/ alpha/ 等价/ 总/ 可能/ 对/ Δ/ 中/ 的/ x/ 进行/ 替换/ ,/ 使/ 之/ 不/ 在/ Δ/ 中/ 出现/ ,/ 这样/ Δ/ ,/ x/ :/ T/ 总是/ 有/ 定义/ ./ 由于/ Δ/ / Γ/ ,/ 故/ Δ/ ,/ x/ :/ T/ / Γ/ ,/ x/ :/ T/ ,/ 由/ 归纳/ 有/ Δ/ ,/ x/ :/ T/ |/ -/ P1/ ;/ 由/ T/ -/ Let/ 规则/ 有/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inP1elseQ1/ ,/ 即/ Δ/ |/ -/ P/ ./ 命题/ 5/ ./ 若/ Γ/ ,/ u/ :/ T/ |/ -/ v/ :/ S/ ,/ 且/ u/ ≠/ v/ ,/ 则/ Γ/ |/ -/ v/ :/ S/ ./ 证明/ ./ 因为/ u/ ≠/ v/ ,/ 而/ Γ/ ,/ u/ :/ T/ |/ -/ v/ :/ S/ ,/ 因此/ 必有/ Γ/ (/ v/ )/ / S/ 或/ v/ ∈/ S/ (/ S/ 为/ 基型/ )/ ,/ 这/ 两种/ 情况/ 下均/ 有/ Γ/ |/ -/ v/ :/ S/ ./ 命题/ 6/ ./ 若/ Γ/ ,/ u/ :/ T/ |/ -/ P/ ,/ 且/ u/ 在/ P/ 中/ 不是/ 自由/ 的/ ,/ 则/ Γ/ |/ -/ P/ ./ 对/ 类型/ 推理/ 的/ 长度/ 作/ 归纳/ ,/ 其/ 证明/ 过程/ 类似/ 于/ 命题/ 4/ ./ 命题/ 7/ ./ 若/ Γ/ |/ -/ v/ :/ T/ 且/ Γ/ ,/ x/ :/ T/ |/ -/ u/ :/ S/ ,/ 则/ Γ/ |/ -/ u/ {/ v/ // x/ }/ :/ S/ ./ 证明/ ./ 对项/ u/ 的/ 结构/ 作/ 归纳/ (/ 只/ 考察/ u/ 为/ 变量/ 的/ 情况/ )/ ./ 若/ u/ 为/ 变量/ ,/ 此时/ 有/ 两种/ 情况/ :/ (/ 1/ )/ 当/ u/ =/ x/ 时/ ,/ 有/ T/ / S/ ,/ 因此/ ,/ Γ/ |/ -/ v/ :/ S/ ,/ 由/ u/ (/ v/ // x/ )/ =/ v/ ,/ 得/ Γ/ |/ -/ u/ {/ v/ // x/ }/ :/ S/ ;/ (/ 2/ )/ 当/ u/ ≠/ x/ ,/ 此时/ ,/ u/ {/ v/ // x/ }/ =/ u/ ./ 因为/ Γ/ ,/ x/ :/ T/ |/ -/ u/ :/ S/ ,/ 而/ u/ ≠/ x/ ,/ 根据/ 命题/ 5/ 有/ u/ ≠/ x/ ,/ 即/ Γ/ |/ -/ u/ {/ v/ // x/ }/ :/ S/ ./ 命题/ 8/ ./ 若/ Γ/ |/ -/ v/ :/ T/ 且/ Γ/ ,/ x/ :/ T/ |/ -/ P/ ,/ 则/ Γ/ |/ -/ P/ {/ v/ // x/ }/ ./ 证明/ ./ 对/ P/ 的/ 结构/ 作/ 归纳/ (/ 只/ 考察/ P/ 为/ let/ 的/ 情况/ )/ ./ 令/ P/ 为/ let/ (/ y/ :/ R/ )/ =/ (/ S/ / R/ )/ (/ u/ →/ u/ )/ inP1elseQ1/ ,/ 且/ Γ/ ,/ x/ :/ T/ |/ -/ P/ ,/ 由于/ 这/ 只能/ 采用/ T/ -/ Let/ 规则/ 而/ 得到/ ,/ 故有/ Γ/ ,/ x/ :/ T/ |/ -/ u/ :/ S/ ,/ 且/ Γ/ ,/ x/ :/ T/ |/ -/ Q1/ 和/ Γ/ ,/ y/ :/ R/ ,/ x/ :/ T/ |/ -/ P1/ ./ 因为/ Γ/ |/ -/ v/ :/ T/ ,/ 由/ 命题/ 7/ 有/ Γ/ |/ -/ u/ {/ v/ // x/ }/ :/ S/ ./ 由/ 归纳/ 有/ Γ/ |/ -/ Q/ {/ v/ // x/ }/ 和/ Γ/ ,/ y/ :/ R/ |/ -/ P1/ {/ v/ // x/ }/ ./ 由/ T/ -/ Let/ 得/ Γ/ |/ -/ (/ let/ (/ y/ :/ R/ )/ =/ (/ S/ / R/ )/ (/ u/ →/ u/ )/ inP1elseQ1/ )/ {/ v/ // x/ }/ ,/ 即/ Γ/ |/ -/ P/ {/ v/ // x/ }/ ./ 定理/ 1/ (/ SubjectCongruence/ )/ ./ 若/ Γ/ |/ -/ P/ ,/ 且/ P/ ≡/ Q/ ,/ 则/ Γ/ |/ -/ Q/ ./ 证明/ ./ 对/ P/ ≡/ Q/ 的/ 派生/ 形式/ 作/ 归纳/ ./ 这里/ 只/ 考察/ 最/ 复杂/ 的/ a/ / fn/ (/ P/ )/ 类似/ ./ 若/ Γ/ |/ -/ (/ ν/ a/ :/ T/ )/ (/ P/ |/ Q/ )/ ,/ 此时/ 只能/ 由/ T/ -/ res/ 派生/ 而/ 得到/ ,/ 故有/ Γ/ ,/ a/ :/ T/ |/ -/ P/ |/ Q/ ./ 对于/ Γ/ ,/ a/ :/ T/ |/ -/ P/ |/ Q/ 只能/ 由/ T/ -/ par/ 派生/ 而/ 得到/ ,/ 故/ Γ/ ,/ a/ :/ T/ |/ -/ P/ 和/ Γ/ ,/ a/ :/ T/ |/ -/ Q/ ./ 由于/ a/ / fn/ (/ P/ )/ ,/ 由/ 命题/ 6/ 可得/ Γ/ |/ -/ P/ ./ 因为/ Γ/ ,/ a/ :/ T/ |/ -/ Q/ ,/ 由/ T/ -/ res/ 可得/ Γ/ |/ -/ (/ ν/ a/ :/ T/ )/ Q/ ./ 由/ T/ -/ par/ 得/ Γ/ |/ -/ P/ |/ (/ ν/ a/ :/ T/ )/ Q/ ./ 定理/ 2/ (/ SubjectReduction/ )/ ./ 若/ Γ/ |/ -/ P/ 且/ P/ →/ Q/ ,/ 则/ Γ/ |/ -/ Q/ ./ 证明/ ./ 对/ 进程/ 规约/ 过程/ 作/ 归纳/ (/ 只/ 考察/ I/ // O/ 和/ LET/ )/ ./ 首先/ 分析/ I/ // O/ ,/ 若/ Γ/ |/ -/ (/ a/ !/ v/ )/ / P/ |/ a/ ?/ (/ x/ :/ T/ )/ / Q/ ,/ 此时/ 只能/ 采用/ 规则/ T/ -/ par/ 做/ 派生/ 而/ 得到/ ,/ 故/ Γ/ |/ -/ a/ ?/ (/ x/ :/ T/ )/ / Q/ 和/ Γ/ |/ -/ (/ a/ !/ v/ )/ / P/ ./ 这/ 只能/ 分别/ 由/ T/ -/ wr/ 和/ T/ -/ rd/ 派生/ 而/ 得到/ ,/ 故有/ Γ/ |/ -/ a/ :/ ch/ -/ 〈/ T/ 〉/ ,/ Γ/ ,/ x/ :/ T/ |/ -/ Q/ 和/ Γ/ |/ -/ a/ :/ ch/ +/ 〈/ S/ 〉/ ,/ Γ/ |/ -/ v/ :/ S/ ,/ 且/ Γ/ |/ -/ P/ ./ 由于/ a/ 具有/ 类型/ ch/ -/ 〈/ T/ 〉/ 和/ ch/ +/ 〈/ S/ 〉/ ,/ 由/ 类型/ 的/ 定义/ 有/ S/ / T/ ,/ 因此/ Γ/ |/ -/ v/ :/ T/ ,/ 由/ 命题/ 8/ 得/ Γ/ |/ -/ Q/ {/ v/ // x/ }/ ./ 由/ T/ -/ par/ 得/ Γ/ |/ -/ P/ |/ Q/ {/ v/ // x/ }/ ./ 下面/ 分析/ LET1/ ,/ 假设/ Γ/ |/ -/ let/ (/ x/ :/ T/ )/ =/ (/ S/ / T/ )/ (/ u/ →/ u/ )/ inPelseQ/ ,/ 由/ 归纳/ 有/ Γ/ ,/ x/ :/ T/ |/ -/ P/ ./ 由/ 前提条件/ 是/ Γ/ / u/ :/ T/ ,/ 故/ Γ/ |/ -/ u/ :/ T/ ./ 由/ 命题/ 8/ 有/ Γ/ |/ -/ P/ {/ u/ // x/ }/ ./ 对于/ LET2/ ,/ 由/ TLet/ 可以/ 直接/ 得到/ Γ/ |/ -/ Q/ ./ 5/ 应用/ 举例/ 为了/ 清晰/ 地/ 分析/ 如何/ 用/ π/ HTS/ 来/ 保障/ 移动/ 计算/ 中/ 的/ 机密性/ 和/ 完整性/ ,/ 且/ 不/ 降低/ 可用性/ ,/ 但/ 也/ 由于/ 篇幅/ 的/ 限制/ ,/ 我们/ 给出/ 一个/ 简洁/ 的/ 例子/ :/ 以/ 第/ 3/ 节中/ 的/ 移动/ 支付/ 为例/ ./ 依据/ BLP/ 模型/ ,/ 移动/ 支付/ 中未/ 加密/ 的/ 密码/ 不能/ 在/ 移动/ 信道/ 上/ 传输/ ./ 用/ Owner/ 表示/ 移动/ 支付/ 终端/ 拥有者/ ,/ Bank/ 表示/ 银行/ 服务器/ ,/ pwd/ 为/ 密码/ ./ 首先/ 分析/ Owner/ 通过/ 移动/ 信道/ 使用/ 明文/ 进行/ 支付/ ,/ 这个/ 过程/ 可用/ π/ HTS/ 演算/ 描述/ 为/ Page8Owner/ / pCh/ !/ pwd/ / 0/ ;/ Bank/ / (/ ν/ sCh/ :/ TsCh/ )/ pCh/ ?/ (/ x/ :/ Tx/ )/ / sCh/ (/ x/ )/ / 0/ ;/ P/ / Owner/ |/ Bank/ ./ 其中/ ,/ pCh/ 为/ 移动/ 信道/ ,/ sCh/ 为/ 银行/ 内部/ 私有/ 信道/ ./ 进程/ Owner/ 定义/ 为/ 在/ pCh/ 信道/ 上/ 发布/ pwd/ 之后/ 终止/ ;/ Bank/ 定义/ 为用/ 类型/ 为/ Tx/ 的/ 变量/ 来/ 接收/ 信道/ pCh/ 上/ 的/ 输入/ ,/ 并/ 在/ sCh/ 上/ 输出/ (/ 之后/ 由/ 银行/ 内部/ 对/ 接收/ 的/ 信息/ 进行/ 处理/ ,/ 这里/ 不/ 讨论/ )/ ,/ 而后/ 终止/ ./ 整个/ 通信/ 进程/ P/ 为/ Owner/ 与/ Bank/ 的/ 组合/ ./ 下面/ 讨论/ pwd/ 和/ pCh/ 的/ 类型/ ,/ 由于/ 卡/ 持有者/ 和/ 银行/ 需要/ 知道/ 密码/ ,/ 并且/ 密码/ 需要/ 在/ 网络/ 上/ 传输/ ,/ 因此/ ,/ 依据/ BLP/ 模型/ 的/ “/ 需要/ 知道/ ”/ 原则/ ,/ pwd/ 的/ 机密性/ 范畴/ 应/ 设置/ 为/ Φ/ ./ 同时/ ,/ pwd/ 应/ 具有/ 较/ 高/ 的/ 安全级别/ (/ 设其为/ secrecy/ )/ 和/ 完整/ 级别/ (/ 设其为/ untainted/ )/ ./ 这样/ ,/ pwd/ 的/ 类型/ 为/ (/ Φ/ ,/ secrecy/ ,/ {/ owner/ }/ ,/ untainted/ )/ ./ 一般来说/ ,/ Owner/ 向/ Bank/ 传输/ 信息/ 的/ 移动/ 信道/ pCh/ 具有/ 如下/ 特征/ :/ (/ 1/ )/ 能够/ 传输/ 任何/ 信息/ ,/ (/ 2/ )/ 是/ 一个/ 公开/ 的/ 信道/ ,/ (/ 3/ )/ 网络/ 上/ 的/ 数据/ 容易/ 被/ 篡改/ ,/ (/ 4/ )/ 能够/ 接收/ 和/ 输出/ 信息/ ./ 因此/ 该/ 信道/ 是/ 低/ 机密/ 级/ 、/ 低/ 完整/ 级/ 的/ 信道/ ,/ 这样/ ,/ pCh/ 的/ 类型/ 为/ {/ ch/ +/ 〈/ (/ {/ network/ }/ ,/ public/ ,/ Φ/ ,/ tainted/ )/ 〉/ ,/ ch/ -/ 〈/ (/ {/ net/ -/ work/ }/ ,/ public/ ,/ Φ/ ,/ tainted/ )/ 〉/ }/ ./ Bank/ 进程/ 中/ 变量/ x/ 用来/ 接收/ 从/ 信道/ 中/ 传输/ 的/ 信息/ ,/ 由于/ 其/ 目标/ 是/ 接收/ pwd/ ,/ 因此/ ,/ 类型/ Tx/ / (/ {/ network/ }/ ,/ secrecy/ ,/ Φ/ ,/ tainted/ )/ ./ 类似/ 地/ ,/ sCh/ 的/ 类型/ TsCh/ / ch/ +/ 〈/ (/ {/ bank/ ,/ network/ }/ ,/ secrecy/ ,/ {/ bank/ }/ ,/ untainted/ )/ 〉/ ./ 基于/ 上述/ 阐释/ ,/ 定义/ 类型/ 环境/ Γ/ / {/ pwd/ :/ Tpwd/ ,/ pCh/ :/ {/ ch/ +/ 〈/ Tpub/ 〉/ ,/ ch/ -/ 〈/ Tpub/ 〉/ }/ }/ ,/ 其中/ Tpwd/ / (/ Φ/ ,/ secrecy/ ,/ {/ owner/ }/ ,/ untainted/ )/ ,/ Tpub/ / (/ {/ network/ }/ ,/ public/ ,/ Φ/ ,/ tainted/ )/ ./ 命题/ 9/ ./ Γ/ 中/ P/ 不是/ 良/ 类型/ 的/ ./ 下面/ 给出/ 证明/ 思路/ ./ 用/ 反证法/ 进行/ 证明/ ,/ 假设/ P/ 是良/ 类型/ 的/ ,/ 则/ 其/ 前提条件/ 是/ 进程/ Owner/ 和/ Bank/ 在/ Γ/ 中均/ 是/ 良/ 类型/ 的/ ./ 实际上/ ,/ 进程/ Owner/ 在/ Γ/ 中/ 不是/ 良/ 类型/ 的/ ./ 这/ 是因为/ 若/ Owner/ 在/ Γ/ 中是/ 良/ 类型/ 的/ ,/ 这/ 要求/ 存在/ 类型/ T/ 使得/ Γ/ |/ -/ pwd/ :/ T/ 和/ Γ/ |/ -/ pCh/ :/ Ch/ +/ 〈/ T/ 〉/ 均/ 成立/ ,/ 但/ 由/ Γ/ 及子/ 类型/ 关系/ 的/ 定义/ 可知/ ,/ 不/ 存在/ 这样/ 的/ 类型/ T/ ./ 因此/ Owner/ 在/ Γ/ 中/ 不是/ 良/ 类型/ 的/ ,/ 故/ 在/ Γ/ 中/ P/ 不是/ 良/ 类型/ 的/ ./ 证毕/ ./ 命题/ 9/ 表明/ ,/ P/ 中/ 类型/ 系统/ 会/ 阻止/ Owner/ 直接/ 向/ Bank/ 传输/ 明文/ pwd/ ,/ 这正/ 符合/ 安全/ 要求/ :/ 明文/ pwd/ 不能/ 直接/ 移动/ 信道/ 上/ 传输/ ;/ 也/ 符合/ BLP/ 模型/ 的/ 规则/ :/ 高/ 安全/ 级/ 信息/ 不能/ 向/ 低/ 安全/ 级/ 流动/ ./ 为了/ 保障/ 安全/ 移动/ 支付/ ,/ 我们/ 需要/ 对/ 高/ 安全/ 级/ 明文/ pwd/ 进行/ 公开化/ 处理/ ,/ 这个/ 过程/ 可用/ π/ HTS/ 演算/ 描述/ 如下/ ./ Owner/ / let/ (/ x/ :/ Tpub/ )/ Bank/ / pCh/ ?/ (/ x/ :/ Tx/ )/ / let/ (/ y/ :/ Tbank/ )/ P/ / Owner/ |/ Bank/ ./ 其中/ ,/ Tbank/ / (/ {/ network/ ,/ bank/ }/ ,/ secrecy/ ,/ {/ bank/ }/ ,/ untainted/ )/ ./ 命题/ 10/ ./ P/ 在/ Γ/ 中是/ 良/ 类型/ 的/ ./ 下面/ 给出/ 证明/ 思路/ ,/ 因为/ P/ 为/ 进程/ Owner/ 和/ Bank/ 的/ 组合/ ,/ 因此/ ,/ 为了/ 证明/ P/ 是良/ 类型/ 的/ ,/ 需要/ 证明/ Owner/ 和/ Bank/ 是良/ 类型/ 的/ ./ 下面/ 以/ Owner/ 为例/ ,/ 为了/ 证明/ Γ/ |/ -/ Owner/ ,/ 需要/ 证明/ :/ (/ 1/ )/ Γ/ ,/ x/ :/ Tpub/ |/ -/ pCh/ !/ x/ / 0/ ,/ (/ 2/ )/ Γ/ |/ -/ pwd/ :/ Tpwd/ ,/ (/ 3/ )/ Γ/ |/ -/ 0/ ./ 其中/ ,/ (/ 2/ )/ 和/ (/ 3/ )/ 分别/ 由/ Γ/ 及/ 类型化/ 规则/ 中/ 的/ 终止/ 规则/ 可得/ ./ 为了/ 证明/ (/ 1/ )/ ,/ 需要/ 证明/ Γ/ ,/ x/ :/ Tpub/ |/ -/ pCh/ !/ x/ ,/ 这/ 可/ 由/ Γ/ ,/ x/ :/ Tpub/ |/ -/ x/ :/ Tpub/ 及/ Γ/ ,/ x/ :/ Tpub/ |/ -/ pCh/ :/ ch/ +/ 〈/ Tpub/ 〉/ 得到/ (/ 因为/ pCh/ :/ {/ ch/ +/ 〈/ Tpub/ 〉/ ,/ ch/ -/ 〈/ Tpub/ 〉/ }/ ,/ 而/ {/ ch/ +/ 〈/ Tpub/ 〉/ ,/ ch/ -/ 〈/ Tpub/ 〉/ }/ / ch/ +/ 〈/ Tpub/ 〉/ ,/ 故有/ Γ/ ,/ x/ :/ Tpub/ |/ -/ pCh/ :/ ch/ +/ 〈/ Tpub/ 〉/ )/ ./ 因此/ ,/ Γ/ |/ -/ Owner/ :/ pwt/ ,/ 类似/ 地有/ ,/ Γ/ |/ -/ Bank/ ./ 因此/ ,/ Γ/ |/ -/ P/ ,/ 即/ P/ 在/ 类型/ 环境/ Γ/ 中是/ 良/ 类型/ 的/ ./ 命题/ 10/ 表明/ ,/ P/ 中/ 类型/ 系统/ 不会/ 阻止/ Owner/ 在/ 移动/ 信道/ 上/ 传输/ 公开化/ 后/ 的/ pwd/ ./ 同/ 进程/ Owner/ 相比/ ,/ 进程/ Owner/ 对/ pwd/ 进行/ 了/ 类型/ 转化/ :/ 将/ pwd/ 的/ 机密/ 类型/ 转化/ 为/ 公开/ 类型/ ./ 实际/ 应用/ 中其/ 安全性/ 依赖于/ Γ/ / pwd/ :/ Tpub/ 的/ 正确性/ ./ 若以/ 加密算法/ 来/ 实施/ 类型转换/ ,/ 则/ Owner/ 的/ 安全性/ 依赖于/ 加密算法/ 的/ 安全性/ ./ 若/ 加密算法/ 是/ 安全/ 的/ ,/ 则/ Owner/ 是/ 安全/ 的/ ①/ ./ 这正/ 符合/ 我们/ 的/ 需求/ :/ 加密/ 后/ 的/ 密码/ 可/ 在/ 移动/ 信道/ 传输/ ./ 6/ 结论/ 作为/ 轻量级/ 的/ 形式化/ 方法/ ,/ 类型/ 检测/ 具有/ 清晰/ 的/ 模块接口/ ,/ 能够/ 规范/ 地/ 设计/ 一个/ 大型/ 系统/ ,/ 并/ 可/ 高效/ 静态/ 地/ 推理/ 程序/ 的/ 行为/ ,/ 在/ 程序语言/ 中/ 得到/ 了/ 广泛/ 的/ 应用/ ./ 本文/ 利用/ π/ 演算/ 能够/ 有效/ 建模/ 移动/ 并发/ 系统/ 的/ 特征/ ,/ 借鉴/ 程序语言/ 中/ 不同/ 类型/ 变量/ 之间/ 的/ ①/ 这里/ 的/ 安全/ 是/ 指/ 在/ 网络/ 上/ 传输/ 的/ 密码/ 不能/ 被/ 攻击者/ 获得/ ,/ Page9/ 赋值/ 方式/ ,/ 提出/ 混杂/ 类型/ 检测/ 安全/ π/ 演算/ ./ π/ HTS/ 利用/ 静态/ 类型/ 检测/ 保障/ 低机/ 密级信息/ 只能/ 向/ 同等/ 或/ 更/ 高机/ 密级信息/ 流动/ ,/ 及/ 高/ 完整/ 级/ 信息/ 只能/ 向/ 同等/ 或/ 更/ 低/ 完整/ 级/ 信息/ 流动/ ./ 针对/ BLP/ 模型/ 和/ Biba/ 模型/ 在/ 信息流/ 向上/ 的/ 相反/ 性/ ,/ 提出/ 了/ 动态/ 检测/ 框架/ ./ π/ HTS/ 将/ 静态/ 检测/ 和/ 动态/ 检测/ 有机/ 地/ 整合/ 在/ 一起/ ,/ 弥补/ 了/ 独自/ 采用/ BLP/ 模型/ 或/ Biba/ 模型/ 的/ 不足/ ,/ 形成/ 了/ 一种/ 统一/ 的/ 安全/ 形式/ 模型/ ./ 它/ 能/ 同时/ 保障/ 移动/ 计算/ 中/ 的/ 机密性/ 和/ 完整性/ ,/ 且/ 不/ 降低/ 可用性/ ./ 虽然/ 本文/ 提出/ 了/ 机密性/ 和/ 完整性/ 的/ 安全/ 模型/ ,/ 但/ 安全/ 并不一定/ “/ 是/ ”/ 与/ “/ 非/ ”/ 的/ 问题/ ,/ 更/ 重要/ 的/ 是/ 评估/ 安全/ 的/ 保障/ 度/ ,/ 未来/ 我们/ 将/ 在/ 评估/ 机密性/ 和/ 完整性/ 的/ 保障/ 度/ 方面/ 展开/ 工作/ ./ 

