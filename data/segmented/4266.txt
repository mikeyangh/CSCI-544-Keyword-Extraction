Page1/ 面向/ 邮件/ 网络/ 事件/ 检测/ 的/ 用户/ 行为/ 模式/ 挖掘/ 李全刚/ 1/ )/ 时金桥/ 2/ )/ ,/ 3/ )/ 秦志光/ 1/ )/ 柳厅/ 文/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 电子科技/ 大学/ 计算机科学/ 与/ 工程学院/ 成都/ 610054/ )/ 2/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 3/ )/ (/ 信息内容/ 安全/ 技术/ 国家/ 工程/ 实验室/ 北京/ 100093/ )/ 摘要/ 挖掘/ 邮件/ 网络通信/ 中/ 的/ 用户/ 行为/ 模式/ 并/ 分析/ 其/ 演变/ 过程/ 对于/ 检测/ 数据/ 泄漏/ 、/ 内部/ 威胁/ 等/ 工作/ 都/ 有着/ 重要/ 指导意义/ ./ 已有/ 的/ 邮件/ 网络/ 用户/ 行为/ 模式/ 挖掘/ 方法/ 可/ 大致/ 分为/ 两大类/ :/ 基于/ 邮件/ 内容/ 和/ 基于/ 网络结构/ ./ 基于/ 邮件/ 内容/ 的/ 挖掘/ 方法/ 存在/ 侵犯/ 用户/ 隐私/ 或者/ 因/ 加密/ 导致/ 无法/ 获得/ 邮件/ 内容/ 等/ 诸多/ 局限性/ ;/ 基于/ 网络结构/ 的/ 挖掘/ 方法/ 常/ 把/ 邮件/ 网络/ 视为/ 是/ 一个/ 完整/ 的/ 网络/ ,/ 而/ 忽略/ 了/ 组织/ 外部/ 邮箱/ 间通信/ 信息/ 存在/ 的/ 缺失/ ,/ 使得/ 提取/ 某些/ 特征/ 时/ 出现/ 偏差/ ,/ 从而/ 会/ 影响/ 到/ 结论/ 的/ 准确性/ ./ 文中/ 将/ 邮件/ 网络/ 分为/ 两/ 部分/ :/ 域/ 内/ 通信/ 网络/ 和/ 有/ 连接/ 缺失/ 的/ 域外/ 通信/ 网络/ ,/ 分析/ 了域/ 内/ 通信/ 和/ 域外/ 通信/ 信息/ 完整性/ 的/ 差异/ ,/ 分别/ 提取/ 了/ 其/ 各自/ 的/ 结构特征/ 和/ 职能/ 特征/ ./ 通过/ 引入/ 模元/ 的/ 概念/ ,/ 将/ 常见/ 的/ 二元/ 对应/ 关系/ (/ 特征/ -/ 模式/ )/ 转化/ 为/ 三元/ 对应/ 关系/ (/ 特征/ -/ 模元/ -/ 模式/ )/ ,/ 并/ 从/ 模元/ 的/ 角度/ 来/ 对/ 用户/ 模式/ 进行/ 统一/ 描述/ ./ 文中/ 的/ 工作/ 有助于/ 对/ 用户/ 行为/ 模式/ 的/ 理解/ 与/ 对比/ ,/ 同时/ 又/ 具有/ 降维/ 的/ 作用/ ./ 在/ Enron/ 邮件/ 数据/ 集上/ 的/ 实验/ 结果表明/ 文中/ 方法/ 将/ 用户/ 行为/ 模式/ 更加/ 简洁/ 地/ 表示/ 出来/ ,/ 并且/ 能够/ 通过/ 分析/ 用户/ 行为/ 模式/ 的/ 变化/ 来/ 直观/ 地/ 定位/ 事件/ 的/ 发生/ ./ 关键词/ 行为/ 模式/ 挖掘/ ;/ 事件/ 检测/ ;/ 非负/ 矩阵/ 分解/ ;/ 邮件/ 网络/ ;/ 日志/ 分析/ ;/ 数据挖掘/ ;/ 信息安全/ ;/ 网络安全/ 1/ 引言/ 电子邮件/ 是/ 互联网/ 上/ 的/ 流行/ 应用/ ,/ 是/ 信息/ 社会/ 最/ 重要/ 的/ 通讯/ 手段/ 之一/ ./ 电子邮件/ 通讯/ 具有/ 方便/ 、/ 快捷/ 、/ 廉价/ 的/ 特点/ ,/ 成为/ 人们/ 不可或缺/ 的/ 沟通/ 工具/ ,/ 已经/ 深深地/ 融入/ 人们/ 的/ 日常/ 工作/ 、/ 生活/ 和/ 学习/ 当中/ ./ 邮件/ 通信/ 日志/ 记录/ 了/ 人们/ 的/ 通信/ 关系/ 、/ 通信/ 频率/ 、/ 通信/ 时间/ 等/ 许多/ 有/ 价值/ 的/ 信息/ ./ 基于/ 邮件/ 日志/ 可以/ 学习/ 用户/ 在/ 邮件/ 通信/ 中/ 的/ 行为/ 模式/ ,/ 继而/ 挖掘出/ 用户/ 的/ 社交/ 关系网/ 、/ 生活习惯/ 、/ 工作/ 性质/ 等/ 社会/ 属性/ ./ 获取/ 用户/ 社会/ 属性/ 可以/ 帮助/ 服务提供商/ 对/ 用户/ 进行/ 个性化/ 资源/ 推送/ ,/ 也/ 可为/ 组织/ 机构/ 的/ 信息安全/ 防护/ 工作/ 提供/ 重要依据/ ./ 例如/ ,/ 通过/ 对/ 不同/ 个体/ 的/ 通信/ 行为/ 模式/ 进行/ 横向/ 对比/ 可以/ 发现/ 那些/ “/ 特立独行/ ”/ 的/ 人/ ;/ 对/ 个体/ 行为/ 模式/ 的/ 纵向/ 分析/ 可以/ 发现/ 个体/ 行为/ 的/ 异常/ 变动/ ./ 基于/ 这些/ 异常/ 可以/ 帮助/ 相关/ 人员/ 缩小/ 排查/ 范围/ ,/ 快速/ 发现/ 并/ 定位/ 内部人员/ 的/ 不轨/ 行为/ ,/ 这/ 对于/ 检测/ 组织/ 内部/ 威胁/ 和/ 计算机/ 取证/ 等/ 工作/ 都/ 有/ 重要/ 的/ 指导意义/ ./ 邮件/ 通信/ 网络/ 属于/ 复杂/ 网络/ 范畴/ ,/ 它/ 与/ 朋友/ 关系网/ 、/ 网页/ 链接/ 关系网/ 一样/ 都/ 属于/ 动态/ 网络/ ./ 但/ 朋友/ 关系网/ 、/ 网页/ 连接/ 网/ 的/ 变化/ 是/ 渐进/ 的/ ,/ 即/ 网络/ 在/ 衍化/ 的/ 同时/ 始终/ 有/ 一个/ 相对/ 稳定/ 的/ 主体/ ,/ 随着/ 时间/ 发展/ 只有/ 部分/ 的/ 节点/ 和/ 边/ 发生变化/ ,/ 改变/ 仅/ 是/ 局部/ 的/ 更新/ ;/ 而/ 邮件/ 通信/ 网络/ 是/ 一个/ 典型/ 的/ 流式/ 网络/ :/ 没有/ 一个/ 相对/ 固定/ 的/ 主体/ 结构/ ,/ 一切/ 都/ 随/ 时间/ 的/ 变化/ 在/ 不断/ 发展/ ,/ 变化/ 不是/ 局部/ 更新/ 而是/ 重构/ ./ 渐变/ 式/ 网络/ 可以/ 通过/ 记录/ 某/ 时刻/ 的/ 瞬时/ 影像/ —/ —/ —/ 快照/ (/ Snapshot/ )/ 来/ 刻画/ ,/ 而/ 流式/ 网络/ 则/ 需要/ 通过/ 叠加/ 某/ 段时间/ 内/ 的/ 记录/ 来/ 生成/ 一个/ 累积/ 影像/ ,/ 最终/ 结果/ 依赖于/ 切分/ 时间段/ 的/ 跨度/ ./ 邮件/ 通信/ 网络/ 的/ 流式/ 特性/ 给/ 用户/ 行为/ 模式/ 挖掘/ 带来/ 了/ 极大/ 挑战/ ,/ 主要/ 体现/ 在/ :/ (/ 1/ )/ 网络/ 采样/ 时间/ 间隔/ 对/ 挖掘/ 结果/ 影响/ 极大/ ;/ (/ 2/ )/ 网络/ 的/ 频繁/ 重构/ 导致/ 行为/ 模式/ 复杂多变/ ,/ 没有/ 较/ 稳定/ 的/ 主体/ 行为/ 模式/ ,/ 致使/ 模式/ 描述/ 困难/ ./ 已有/ 的/ 邮件/ 网络/ 用户/ 行为/ 模式/ 挖掘/ 方法/ 可/ 大致/ 分为/ 两大类/ :/ 基于/ 邮件/ 内容/ 的/ 文本/ 主题/ 挖掘/ 方法/ 和/ 基于/ 网络结构/ 的/ 社交/ 网络分析/ 方法/ ./ 前者/ 存在/ 侵犯/ 用户/ 隐私/ 的/ 问题/ ,/ 并且/ 无法/ 应用/ 在/ 邮件/ 内容/ 被/ 加密/ 的/ 情况/ ;/ 后者/ 往往/ 忽略/ 邮件/ 网络/ 的/ 域/ 内/ 通信/ 和/ 域外/ 通信/ 在/ 信息/ 完整性/ 上/ 的/ 差异/ ,/ 常/ 把/ 邮件/ 网络/ 视为/ 一个/ 完整/ 的/ 社交/ 网络/ ,/ 这/ 导致/ 最终/ 结果/ 不/ 准确/ ./ 此外/ ,/ 已有/ 工作/ 大多/ 将/ 用户/ 的/ 行为/ 模式/ 直接/ 用/ 特征/ 表示/ ,/ 当/ 特征/ 较多时/ 这种/ 简单/ 的/ 二元/ 对应/ 关系/ (/ 特征/ -/ 行为/ 模式/ )/ 往往/ 导致/ 模式/ 描述/ 不够/ 统一/ ,/ 不利于/ 用户/ 间/ 的/ 模式/ 对比/ ./ 本文/ 以/ Enron/ 公司/ 内部人员/ 的/ 邮件/ 通信/ 网络日志/ 为/ 研究/ 对象/ ,/ 结合/ 邮件/ 网络/ 域外/ 通信/ 的/ 信息/ 缺失/ 特点/ ,/ 提出/ 了/ 一种/ 用户/ 行为/ 模式/ 挖掘/ 方法/ ,/ 分别/ 对域/ 内/ 网络/ 和/ 域外/ 网络/ 有/ 区别/ 地/ 提取/ 相关/ 特征/ ,/ 充分/ 挖掘/ 邮件/ 网络/ 的/ 结构特征/ 与/ 职能/ 特征/ (/ 如/ 转发/ 量/ 、/ 附件/ 量/ 等/ )/ ./ 邮件/ 网络/ 中/ 用户/ 的/ 通信/ 行为/ 模式/ 是/ 用户/ 在/ 长期/ 的/ 工作/ 生活/ 中/ 通信/ 行为/ 特征/ 的/ 累积/ 体现/ ,/ 用户/ 的/ 通信/ 行为/ 模式/ 由/ 其/ 日常/ 工作/ 性质/ 决定/ ,/ 同时/ 也/ 受到/ 个体/ 的/ 性格/ 、/ 习惯/ 等/ 因素/ 的/ 影响/ ./ 为了/ 简便/ 统一/ 地/ 描述/ 用户/ 行为/ 模式/ 及其/ 变化/ 情况/ ,/ 提出/ 了/ 基本/ 行为/ 模式/ 单元/ (/ 简称/ 模元/ )/ 的/ 概念/ ./ 模元/ 是/ 描述/ 用户/ 行为/ 模式/ 的/ 一组/ “/ 基/ ”/ ,/ 它/ 是/ 全网/ 用户/ 某一/ 研究/ 尺度/ 上/ 通信/ 行为/ 模式/ 的/ 基本/ 组成/ 单元/ ,/ 是/ 工作/ 中/ 某类/ 职能/ 属性/ 的/ 特征/ 表现/ ./ 模元/ 的/ 个数/ 决定/ 了/ 行为/ 模式分析/ 的/ 研究/ 尺度/ ./ 在/ 某/ 组织/ 机构/ 中/ 员工/ 总是/ 可以/ 按照/ 职能/ 的/ 不同/ 来/ 分类/ ,/ 具有/ 不同/ 工作/ 职能/ 的/ 用户/ 其/ 通信/ 行为/ 模式/ 会/ 表现/ 为/ 不同/ 的/ 模元/ 线性组合/ ,/ 通过/ 对/ 模元/ 权重/ 的/ 变化/ 分析/ 可以/ 了解/ 用户/ 行为/ 模式/ 演变/ ,/ 继而/ 可以/ 结合/ 模元/ 的/ 含义/ 推断出/ 现实/ 中/ 事件/ 的/ 发生/ ./ 本文/ 的/ 贡献/ 主要/ 体现/ 在/ :/ Page3/ (/ 1/ )/ 面向/ 邮件/ 通信/ 网络/ 行为/ 模式/ 复杂多变/ 、/ 难以描述/ 的/ 挑战/ ,/ 本文/ 提出/ 基本/ 行为/ 模式/ 单元/ 的/ 概念/ ./ 模元/ 体现/ 为/ 一些/ 邮件/ 通信/ 特征/ 的/ 组合/ ,/ 代表/ 了/ 从/ 整个/ 邮件/ 通信/ 网络/ 中/ 抽象/ 出/ 的/ 基本/ 通信/ 行为/ 模式/ ./ 用户/ 的/ 行为/ 模式/ 是/ 由/ 模元/ 构成/ 的/ ,/ 基于/ 模元/ 可以/ 对/ 用户/ 行为/ 模式/ 进行/ 建模/ 分析/ ./ 首先/ ,/ 利用网络/ 中/ 全体/ 用户/ 的/ 通信/ 特征/ 抽象/ 出/ 若干/ (/ 通常/ 远/ 小于/ 特征/ 个数/ )/ 模元/ ,/ 然后/ 将/ 用户/ 行为/ 特征/ 映射/ 到/ 模元/ 空间/ ,/ 这样/ 用户/ 在/ 某个/ 快照/ 内/ 的/ 行为/ 模式/ 就/ 可以/ 表示/ 为/ 一个/ 模元/ 空间/ 中/ 的/ 向量/ ,/ 为/ 用户/ 的/ 行为/ 模式/ 提供/ 了/ 统一/ 的/ 描述/ 准则/ ,/ 降低/ 了/ 模式/ 表述/ 的/ 复杂性/ ./ 集合/ 多个/ 连续/ 快照/ 的/ 用户/ 行为/ 模式/ 向量/ 则/ 可/ 构成/ 一个/ 以模/ 元/ 为/ “/ 基/ ”/ 的/ 多元/ 时间/ 序列/ ./ (/ 2/ )/ 针对/ 组织/ 机构/ 邮件/ 网络/ 的/ 域外/ 通信/ 呈现/ 的/ 不/ 完整性/ 特点/ ,/ 提出/ 对/ 入选/ 特征/ 进行/ 区别对待/ ,/ 经过/ 初步/ 筛选/ ,/ 增强/ 结果/ 的/ 可靠性/ ./ 在/ 关注/ 网络结构/ 特征/ 的/ 同时/ ,/ 也/ 关注/ 用户/ 在/ 通信/ 过程/ 中/ 与/ 工作/ 性质/ 有关/ 的/ 职能/ 特征/ ,/ 如/ 转发/ 量/ 、/ 附件/ 量/ 等/ ./ (/ 3/ )/ 在/ 真实/ 邮件/ 数据/ 集上/ 进行/ 了/ 实验/ 验证/ ,/ 实验/ 结果表明/ 该/ 模型/ 能够/ 真实/ 地/ 获取/ 用户/ 的/ 行为/ 模式/ ,/ 从/ 模式/ 的/ 变化/ 中/ 能够/ 反映/ 出/ 用户/ 真实/ 的/ 状态/ 改变/ ,/ 并/ 具有/ 良好/ 的/ 可/ 解释性/ 和/ 多/ 尺度/ 的/ 特点/ ./ 2/ 相关/ 工作/ 邮件/ 通信/ 行为/ 模式/ 是/ 指/ 人们/ 在/ 邮件/ 通信/ 过程/ 中/ 所/ 体现/ 出/ 的/ 个体/ 或/ 群体/ 间/ 重复/ 出现/ 的/ 通信/ 特征/ 集合/ ./ 组织/ 机构/ 的/ 邮件/ 日志/ 中/ 隐含/ 了/ 许多/ 与/ 内部/ 员工/ 的/ 工作/ 性质/ 、/ 日常/ 行为习惯/ 、/ 生活/ 作息时间/ 等/ 有关/ 的/ 信息/ ./ 如何/ 挖掘/ 这/ 类/ 信息/ 并/ 有效/ 地/ 利用/ 这些/ 信息/ 是/ 人们/ 十分/ 关注/ 的/ 问题/ ./ 2.1/ 基于/ 邮件/ 内容/ 的/ 挖掘/ 方法/ 邮件/ 通信/ 作为/ 信息/ 交流/ 的/ 一种/ 工具/ ,/ 其/ 邮件/ 的/ 文本/ 内容/ 是/ 最/ 重要/ 的/ 信息/ 载体/ ,/ 于是/ 发展/ 出/ 许多/ 基于/ 邮件/ 内容/ 的/ 邮件/ 网络/ 挖掘/ 方法/ ./ 如/ Berry/ 与/ Browne/ 在/ 文献/ [/ 1/ ]/ 中/ 基于/ 邮件/ 内容/ 利用/ 非负/ 矩阵/ 分解/ 的/ 方法/ 来/ 提取/ 邮件/ 的/ 主题/ 信息/ 并/ 通过/ 分析/ 主题/ 的/ 变化/ 来/ 对/ 邮件/ 通信/ 进行/ 监控/ ./ McCallum/ 等/ 人/ 在/ 文献/ [/ 2/ ]/ 中/ 结合/ 邮件/ 收发/ 关系/ 及/ 文本/ 挖掘/ 中/ 的/ 主题/ 概率模型/ 提出/ 了/ Author/ -/ Recipient/ -/ Topic/ 模型/ ,/ 可以/ 基于/ 信息/ 的/ 传递/ 关系/ 提取/ 用户/ 的/ 多重/ 角色/ 信息/ ./ Carvalho/ 与/ Cohen/ 在/ 文献/ [/ 3/ ]/ 中/ 通过/ 计算/ 之前/ 邮件/ 文本/ 与/ 当前/ 邮件/ 文本/ 的/ TF/ -/ IDF/ 向量/ 的/ 相似/ 度来/ 衡量/ 当前/ 邮件/ 的/ 可信度/ ,/ 利用/ 预设/ 的/ 可信度/ 阈值/ 来/ 预测/ 可疑/ 的/ 邮件/ ,/ 从而/ 防止/ 信息/ 泄漏/ 的/ 发生/ ./ 但/ 在/ 真实情况/ 中/ ,/ 通常/ 由于/ 邮件/ 加密/ 或者/ 隐私/ 问题/ 而/ 无法/ 获得/ 全部/ 的/ 邮件/ 内容/ ,/ 基于/ 邮件/ 内容/ 的/ 挖掘/ 方法/ 在/ 该/ 情形/ 下/ 无法/ 使用/ ./ 本文/ 仅/ 从/ 邮件/ 网络/ 的/ 日志/ 信息/ 来/ 考虑/ 如何/ 挖掘/ 用户/ 的/ 通信/ 行为/ 模式/ ,/ 可/ 作为/ 基于/ 内容/ 的/ 挖掘/ 方法/ 的/ 补充/ ./ 2.2/ 基于/ 网络结构/ 的/ 挖掘/ 方法/ 一些/ 学者/ 从/ 社交/ 网络/ 角度/ 对/ 邮件/ 网络/ 开展/ 了/ 广泛/ 的/ 研究/ ,/ 如/ 社团/ 划分/ [/ 4/ ]/ 、/ 重要/ 节点/ 的/ 发现/ [/ 5/ ]/ 、/ 社会关系/ 与/ 地位/ 的/ 推断/ [/ 6/ -/ 8/ ]/ 等/ ./ 但是/ 大部分/ 社交/ 网络/ 层面/ 的/ 研究/ 工作/ 重点/ 在于/ 构建/ 社交/ 网络/ 层面/ 的/ 普适性/ 算法/ ,/ 考虑/ 的/ 因素/ 较/ 少/ ,/ 挖掘/ 的/ 结果/ 比较/ 宏观/ ./ Sun/ 等/ 人/ 在/ 文献/ [/ 9/ ]/ 中/ 提出/ GraphScope/ 模型/ ,/ 利用/ 最小/ 描述/ 长度/ 准则/ 来/ 处理/ 动态/ 网络/ 中/ 的/ 事件/ 检测/ 以及/ 节点/ 的/ 社团/ 划分/ 问题/ ./ 该/ 方法/ 以/ 网络/ 快照/ 作为/ 研究/ 对象/ ,/ 可以/ 检测/ 出/ 快照/ 间/ 的/ 变化/ 时刻/ ,/ 但是/ 不能/ 提取/ 用户/ 个体/ 的/ 通信/ 行为/ 变化/ ,/ 同时/ GraphScope/ 只用/ 到/ 了/ 网络/ 中/ 出度/ 入度/ 等/ 基本/ 链接/ 特征/ ,/ 忽略/ 了/ 邮件/ 网络/ 中/ 其他/ 大量/ 有/ 价值/ 的/ 信息/ ./ Akoglu/ 等/ 人/ 在/ 文献/ [/ 10/ ]/ 中/ 提出/ OddBall/ 模型/ ,/ 基于/ 网络/ 的/ 幂率/ 性质/ 来/ 定位/ 网络/ 中/ 的/ 异常/ 节点/ ./ 该/ 模型/ 只/ 能够/ 发现/ 那些/ 结构/ 偏离/ 明显/ 的/ 节点/ ,/ 同时/ 该/ 模型/ 只/ 考虑/ 单个/ 网络/ 快照/ ,/ 而/ 邮件/ 网络/ 是/ 动态网/ ,/ 故/ OddBall/ 方法/ 不能/ 发现/ 节点/ 自身/ 的/ 异常/ 变化/ 行为/ ./ Henderson/ 等/ 人/ 在/ 文献/ [/ 11/ ]/ 中/ 提出/ 了/ 结构/ 角色/ (/ StructuralRole/ )/ 的/ 概念/ ,/ 用于/ 对/ 复杂/ 网络/ 的/ 节点/ 进行/ 划分/ 及/ 节点/ 行为/ 的/ 分析/ 预测/ ./ 结构/ 角色/ 是/ 指/ 某类/ 结构特征/ 的/ 组合/ ,/ 如/ 星形/ 结构/ 的/ 中心/ 、/ 完全/ 图/ 的/ 成员/ 等/ 就是/ 两种/ 不同/ 的/ 角色/ ,/ 它们/ 有着/ 各自/ 独特/ 的/ 节点/ 度/ 分布/ 、/ 聚集/ 系数/ 等/ 特征/ 表现/ ./ 随后/ ,/ Rossi/ 等/ 人/ [/ 12/ ]/ 通过考察/ 节点/ 结构/ 角色/ 的/ 变化/ 构建/ 了/ 一种/ 分析/ 网络/ 及/ 节点/ 结构/ 变化/ 模式/ 的/ 方法/ ./ 文献/ [/ 11/ -/ 12/ ]/ 共同/ 组建/ 了/ 一种/ 特征/ -/ 结构/ 角色/ -/ 结构/ 变化/ 的/ 三层/ 模型/ 框架/ ,/ 可以/ 有效/ 地/ 分析/ 动态/ 网络/ 的/ 结构/ 变化/ ./ 但是/ 该/ 模型/ 仅/ 考察/ 了/ 网络/ 的/ 拓扑/ 结构/ 层面/ 的/ 特征/ ,/ 对于/ 邮件/ 通信/ 行为/ 模式分析/ 而言/ ,/ 需要/ 更深/ 一步/ 的/ 探索/ ./ 另外/ ,/ 我们/ 注意/ 到/ 邮件/ 网络/ 除去/ 社交/ 网络/ 中共/ 有/ 的/ 结构特征/ 之外/ ,/ 还有/ 许多/ 特有/ 的/ 属性/ ,/ 如/ 时间/ 、/ 抄送/ 关系/ 、/ 附件/ 大小/ 等/ ,/ 这些/ 特征/ 在/ 邮件/ 通信/ 模式/ 的/ 分析/ 中/ 同样/ 具有/ 重要/ 的/ 价值/ ./ 例如/ Kalyan/ 与/ Chandrasekaran/ 在/ 文献/ [/ 13/ ]/ 中/ 就/ 利用/ 这些/ 特有/ 属性/ 来/ 检测/ 信息/ 泄漏/ 问题/ ,/ 并/ 达到/ 92/ %/ 的/ 准确性/ ./ 由此可见/ ,/ 邮件/ 通信/ 中/ 的/ 特有/ 属性/ 是/ 不可/ 忽略/ 的/ 重要/ 特征/ ./ Page4/ 本文/ 综合/ 以上/ 分析/ ,/ 考虑/ 仅/ 利用/ 组织/ 机构/ 邮件/ 网络/ 的/ 日志/ 信息/ ,/ 避免/ 了/ 因/ 分析/ 邮件/ 内容/ 而/ 导致/ 的/ 隐私/ 问题/ ,/ 细致/ 分析/ 了/ 邮件/ 网络/ 外部/ 通信/ 信息/ 缺失/ 的/ 拓扑/ 特征/ ,/ 通过/ 引入/ 邮件/ 网络/ 的/ 转发/ 、/ 附件/ 信息/ 等/ 特有/ 属性/ ,/ 将/ 结构/ 角色/ [/ 11/ -/ 12/ ]/ 的/ 思想/ 延伸/ 为/ 基本/ 行为/ 模式/ 单元/ ,/ 引入/ 了/ 特征/ -/ 模元/ -/ 模式/ 的/ 行为/ 模式/ 学习/ 模型/ ,/ 该/ 模型/ 既/ 能/ 方便/ 地/ 表示/ 某/ 时刻/ 用户/ 的/ 通信/ 行为/ 模式/ 又/ 能/ 有效/ 地/ 分析/ 用户/ 通信/ 模式/ 的/ 时序/ 变化/ ./ 3/ 邮件/ 通信/ 行为/ 模式/ 挖掘/ 在/ 工作/ 中/ ,/ 人们/ 使用/ 邮件/ 来/ 进行/ 通知/ 的/ 传达/ 、/ 文件/ 的/ 传送/ 、/ 工作/ 的/ 安排/ 与/ 交流/ 等/ 活动/ ./ 我们/ 认为/ 用户/ 的/ 邮件/ 通信/ 行为/ 模式/ 是/ 与其/ 工作/ 性质/ 紧密/ 相关/ 的/ ,/ 用户/ 在/ 不同/ 的/ 生活/ 环境/ 中/ 所/ 养成/ 的/ 性格/ 、/ 生活习惯/ 等/ 也/ 会/ 对/ 其/ 通信/ 行为/ 模式/ 产生/ 影响/ ./ 例如/ ,/ 行政/ 人员/ 的/ 通信/ 模式/ 会/ 表现/ 为/ 邮箱/ 活跃/ ,/ 经常性/ 地/ 群发/ 通知/ 及/ 文件/ 附件/ ;/ 职务/ 相同/ 的/ 人员/ ,/ 热情/ 随和/ 的/ 会/ 对/ 大多/ 来信/ 都/ 给予/ 回复/ ,/ 稳重/ 干练/ 的/ 可能/ 只/ 回复/ 一些/ 要紧/ 的/ 邮件/ ./ 在/ 介绍/ 行为/ 模式/ 的/ 挖掘/ 方法/ 以前/ ,/ 我们/ 首先/ 详细/ 介绍/ 邮件/ 网络/ 的/ 结构/ 特点/ ,/ 以及/ 用户/ 行为/ 模式/ 挖掘/ 的/ 有关/ 概念/ ./ 3.1/ 邮件/ 网络拓扑/ 与/ 特征选择/ 原则/ 某/ 组织/ 机构/ 的/ 邮件/ 网络/ 通常/ 可/ 分为/ 两/ 部分/ :/ 组织/ 内部/ 间/ 的/ 通信/ —/ —/ —/ 域/ 内/ 通信/ 网络/ ;/ 组织/ 内部/ 与/ 外部/ 间/ 的/ 通信/ —/ —/ —/ 域外/ 通信/ 网络/ ,/ 如图/ 1/ 所示/ ./ 域/ 内/ 通信/ 网络/ 可以/ 通过/ 邮件/ 服务器/ 的/ 日志/ 信息/ 完整/ 获取/ ,/ 但/ 对于/ 域外/ 通信/ 来说/ ,/ 其/ 外部/ 邮箱/ 之间/ 的/ 联系/ 是/ 不/ 可知/ 的/ (/ 图/ 1/ 中/ 虚线/ 所示/ )/ ./ 因此/ 一个/ 组织/ 机构/ 的/ 邮件/ 网络/ 可/ 视为/ 由/ 一个/ 完整/ 的/ 域/ 内/ 通信/ 网络/ 和/ 一个/ 有/ 信息/ 缺失/ 的/ 域外/ 通信/ 网络/ 组成/ ./ 本文/ 目的/ 是/ 针对/ 组织/ 机构/ 的/ 内部/ 员工/ 进行/ 通信/ 行为/ 模式/ 的/ 挖掘/ ,/ 检测/ 其/ 异常/ 通信/ 行为/ 的/ 发生/ ,/ 故仅/ 以域/ 内/ 通信/ 网络/ 的/ 节点/ 作为/ 行为/ 模式/ 挖掘/ 的/ 对象/ (/ 图/ 1/ 中/ 圈内/ 节点/ )/ ,/ 并/ 假设/ 邮件/ 网络/ 中/ 每个/ 用户/ 只/ 对应/ 一个/ 邮箱/ ,/ 忽略/ 一个/ 用户/ 拥有/ 多个/ 邮箱/ 的/ 情形/ ./ 挖掘/ 用户/ 的/ 通信/ 行为/ 模式/ ,/ 既/ 要/ 考虑/ 用户/ 通信/ 数据/ 的/ 完整性/ ,/ 也/ 应该/ 意识/ 到/ 域外/ 通信/ 网络/ 存在/ 着/ 信息/ 的/ 缺失/ ./ 用户/ 的/ 域外/ 通信量/ 在/ 其/ 总/ 通信量/ 中/ 占有/ 可观/ 的/ 比例/ ,/ 不能/ 轻易/ 忽略/ ./ 例如/ 某/ 公司/ 负责人/ 才/ 招聘/ 的/ 职员/ ,/ 他/ 的/ 通信/ 可能/ 更/ 多/ 的/ 是/ 面向/ 公司/ 外部/ 的/ ,/ 如果/ 忽略/ 外部/ 通信/ 就/ 会/ 丢失/ 该/ 用户/ 的/ 主要/ 通信/ 行为/ ;/ 然而/ 由于/ 域外/ 通信/ 网络/ 的/ 信息/ 缺失/ 性/ ,/ 一些/ 复杂/ 网络/ 研究/ 中/ 常用/ 的/ 特征/ 就会/ 失准/ ,/ 例如/ 节点/ 的/ 聚集/ 系数/ [/ 14/ ]/ ,/ 因为/ 外部/ 节点/ 间/ 链接/ 的/ 缺失/ ,/ 所以/ 内部/ 节点/ 的/ 聚集/ 系数/ 会/ 趋于/ 变小/ ./ 因此/ 对于/ 像/ 聚集/ 系数/ 这/ 类/ 特征/ 在/ 计算/ 的/ 时候/ 就/ 应当/ 只/ 考虑/ 域/ 内/ 通信/ 网络/ 部分/ ./ 如果/ 把/ 邮箱/ 视作/ 节点/ ,/ 把/ 邮箱/ 间/ 的/ 通信/ 视作/ 边/ ,/ 通过/ 整合/ 一段时间/ 内/ 的/ 通信/ 记录/ ,/ 可以/ 把/ 该/ 时间段/ 的/ 邮件/ 网络/ 抽象地/ 表示/ 为/ 一个/ 有权/ 有向图/ ,/ 其中/ 边/ 的/ 权重/ 代表/ 通信/ 的/ 次数/ ,/ 边/ 的/ 方向/ 代表/ 邮件/ 的/ 发送/ 方向/ ./ 如果/ 不/ 考虑/ 边/ 的/ 权重/ ,/ 则/ 是/ 一个/ 无权/ 有向图/ ,/ 可/ 代表/ 联系人/ 关系网/ ./ 邮件/ 网络/ 抽象/ 成图/ 的/ 结构/ 后/ 就/ 可以/ 采用/ 复杂/ 网络/ 研究/ 中/ 的/ 各种/ 特征/ ,/ 如/ 出度/ 、/ 入度/ 、/ 局部/ 聚集/ 系数/ 等/ 与/ 拓扑/ 结构/ 有关/ 的/ 特征/ ./ 由于/ 本文/ 要/ 研究/ 的/ 是/ 用户/ 个体/ 的/ 通信/ 模式/ ,/ 因此/ 主要/ 以/ 用户/ 的/ egonet/ (/ 即/ 节点/ 和/ 该/ 点/ 的/ 一/ 跳/ 邻居/ 点/ 以及/ 这些/ 邻居/ 点/ 彼此间/ 的/ 连边/ )/ 为/ 基础/ 进行/ 特征/ 采集/ ./ 除去/ 以上/ 跟/ 网络拓扑/ 结构/ 有关/ 的/ 特征/ 之外/ ,/ 邮件/ 网络/ 还有/ 可以/ 体现/ 用户/ 工作/ 性质/ 的/ 特征/ ,/ 我们/ 称之为/ 职能/ 特征/ ,/ 如/ 邮件/ 的/ 转发/ 、/ 抄送/ ,/ 附件/ 的/ 数量/ 、/ 大小/ 、/ 格式/ ,/ 邮箱/ 使用/ 频率/ 等/ ./ 初期/ 特征选择/ 可以/ 从/ 拓扑/ 和/ 逻辑/ 两个/ 层面/ 来/ 对/ 邮件/ 网络/ 的/ 特征/ 进行/ 划分/ ,/ 分别/ 是/ 拓扑/ 层面/ 的/ 域/ 内/ 通信网/ 和/ 域外/ 通信网/ ,/ 逻辑/ 层面/ 的/ 结构特征/ 和/ 职能/ 特征/ ./ 两者/ 的/ 层次/ 关系/ 是/ 可以/ 嵌套/ 的/ ,/ 见表/ 1/ ./ 结构特征/ 职能/ 特征/ 3.2/ 问题/ 描述/ 与/ 求解/ 我们/ 认为/ 用户/ 的/ 行为/ 模式/ 是/ 由/ 他们/ 日常/ 工作/ 职能/ 所/ 决定/ 的/ ,/ 同时/ 受到/ 人/ 的/ 性格/ 、/ 习惯/ 等/ 个体/ 因素/ 的/ 影响/ ./ 例如/ ,/ 工作/ 职能/ 决定/ 了/ 其/ 联系人/ 的/ 数量/ 、/ 邮件/ 使用/ 频率/ 、/ 抄送/ 、/ 转发/ 等/ 特征/ ,/ 而/ 个体/ 因素/ 会/ 影响/ 到/ 使用/ 时间/ 、/ 回复/ 概率/ 等/ ./ 在/ 组织/ 机构/ 中/ 员工/ 是/ 可以/ 按照/ 职能/ 的/ 不同/ 来/ 分类/ 的/ ,/ 于是/ 我们/ 假设/ 在/ 整个/ 网络/ 中/ 内部人员/ 的/ 邮件/ 通信/ 行为/ 模式/ 也/ 会/ 有/ 一些/ 基本/ 的/ Page5/ 分类/ ,/ 而/ 个体/ 的/ 行为/ 模式/ 又/ 会/ 因/ 个体/ 的/ 差异/ 而/ 有所/ 分化/ ./ 因此/ 我们/ 借鉴/ 文献/ [/ 11/ -/ 12/ ]/ 中/ 的/ 结构/ 角色/ 的/ 概念/ 并/ 将/ 其/ 含义/ 做/ 延伸/ ,/ 即/ 不仅/ 考察/ 网络/ 的/ 拓扑/ 结构特征/ ,/ 还/ 加入/ 了/ 邮件/ 网络/ 的/ 职能/ 特征/ 信息/ ,/ 然后/ 在/ 邮件/ 网络/ 特征/ 和/ 用户/ 行为/ 模式/ 之间/ 引入/ 一个/ 抽象/ 的/ 概念/ —/ —/ —/ 基本/ 行为/ 模式/ 单元/ (/ 简称/ 模元/ )/ ./ 3.2/ ./ 1/ 基本/ 行为/ 模式/ 单元/ 的/ 定义/ 定义/ 1/ ./ 基本/ 行为/ 模式/ 单元/ 是/ 指/ 网络/ 中/ 全体/ 用户/ 在/ 某/ 尺度/ 上/ 所/ 体现/ 出/ 的/ 通信/ 行为/ 模式/ 的/ 基本/ 组成/ 单元/ ./ 模元/ 是/ 特征/ 之上/ 的/ 一层/ 抽象概念/ ,/ 代表/ 了/ 工作/ 中/ 某类/ 职能/ 属性/ 的/ 特征/ 表现/ ,/ 是/ 网络/ 中/ 用户/ 行为/ 模式/ 的/ 最小/ 体现/ ./ 模元/ 表现/ 为/ 一些/ 特征/ 的/ 组合/ ,/ 其/ 具体/ 的/ 含义/ 需要/ 依据/ 特征/ 在/ 现实/ 中/ 的/ 语义/ 并/ 结合/ 在/ 模元/ 中/ 的/ 权重/ 来/ 进行/ 判定/ ./ 模元/ 的/ 个数/ 决定/ 了/ 模式分析/ 的/ 研究/ 尺度/ ./ 将/ 模元/ 作为/ 描述/ 用户/ 行为/ 模式/ 的/ “/ 基/ ”/ ,/ 最终用户/ 某/ 时刻/ 的/ 通信/ 行为/ 模式/ 可/ 理解/ 为/ 模元/ 空间/ 中/ 的/ 向量/ ./ 它/ 是/ 结构/ 角色/ 的/ 延伸/ ,/ 即/ 同时/ 包含/ 了/ 结构特征/ 和/ 职能/ 特征/ ,/ 能/ 更/ 全面/ 地/ 代表/ 用户/ 行为/ 模式/ ./ 引入/ 抽象/ 的/ 模元/ 之后/ ,/ 之前/ 的/ 二元/ 对应/ 关系/ :/ 就/ 变成/ 三元/ 对应/ 关系/ :/ 二元关系/ 下/ ,/ 每个/ 用户/ 都/ 会/ 有/ 自己/ 的/ 行为/ 模式/ —/ 特征/ 的/ 对应/ 表示/ ,/ 不同/ 用户/ 行为/ 模式/ 之间/ 不易/ 对比/ ,/ 而且/ 每个/ 模式/ 都/ 要/ 对应/ 到/ m/ 维/ 向量/ 空间/ (/ m/ 为/ 特征/ 的/ 个数/ )/ ;/ 而/ 在/ 三元/ 关系/ 下/ m/ 个/ 特征/ 会/ 预先/ 对应/ 到/ r/ 个/ 模元/ (/ 通常/ r/ / m/ )/ ,/ 然后/ 将/ 用户/ 行为/ 特征/ 映射/ 到/ r/ 维/ 向量/ 空间/ ,/ 这样/ 一方面/ 降低/ 了/ 行为/ 模式/ 表示/ 向量/ 维数/ ,/ 另一方面/ 每个/ 模元/ 代表/ 一个/ 基本/ 行为/ 模式/ ,/ 因此/ 不同/ 用户/ 间/ 的/ 行为/ 模式/ 作/ 比较/ 就/ 变得/ 相对/ 容易/ 些/ ./ 本文/ 采用/ 非负/ 矩阵/ 分解/ (/ NMF/ )/ 来/ 计算/ 模元/ ,/ 它/ 一方面/ 有/ 便于/ 操作/ 、/ 过程/ 及/ 结果/ 的/ 可/ 解释性/ 等/ 优点/ ;/ 另一方面/ ,/ 文献/ [/ 15/ ]/ 的/ 研究/ 表明/ 列/ 正规化/ 后/ 的/ NMF/ 在/ I/ -/ 散度/ 下/ 与/ pLSA/ 所/ 优化/ 的/ 目标/ 函数/ 是/ 一致/ 的/ ,/ 因此/ 矩阵/ 分解/ 对于/ 模元/ 计算/ 来说/ 同样/ 具有/ 统计/ 模型/ 的/ 基础/ ,/ 只是/ 求解/ 的/ 方法/ 不同/ ./ 3.2/ ./ 2/ 行为/ 模式/ 的/ 计算/ 本文/ 的/ 目的/ 是/ 挖掘/ 邮件/ 网络/ 中/ 用户/ 的/ 行为/ 模式/ ,/ 而/ 行为/ 模式/ 是/ 用户/ 在/ 长期/ 的/ 工作/ 生活/ 中/ 使用/ 邮件/ 通信/ 时/ 逐步/ 积累/ 并/ 体现/ 出来/ 的/ ,/ 因此/ 本文/ 主要/ 是/ 以/ 组织/ 内部人员/ 中/ 使用/ 邮件/ 通信/ 的/ 频率/ 较/ 高/ 的/ 那些/ 用户/ 作为/ 研究/ 对象/ ,/ 通过/ 分析/ 其/ 通信/ 行为/ 模式/ 的/ 变化/ 情况/ ,/ 发现/ 并/ 定位/ 异常/ 的/ 事件/ ./ 给定/ t/ 时间/ 内/ 连续/ 的/ T/ 个/ 邮件/ 网络/ 快照/ / =/ {/ G1/ ,/ G2/ ,/ …/ ,/ GT/ }/ ./ 首先/ 借助/ 用户/ 在/ 各/ 快照/ 中/ 出现/ 的/ 次数/ 来/ 标志/ 用户/ 的/ 活跃度/ ,/ 然后/ 取/ 最/ 活跃/ 的/ Top/ θ/ %/ 的/ 用户/ 作为/ 行为/ 模式/ 挖掘/ 的/ 研究/ 对象/ ./ 在/ 实际/ 中/ 可以/ 依据/ 问题/ 的/ 背景/ 来/ 决定/ θ/ 取值/ ./ 假设/ 共/ 选取/ 了/ n/ 个/ 不同/ 的/ 用户/ ,/ 然后/ 分别/ 对/ 各/ 快照/ 计算/ 这些/ 用户/ 相关/ 特征/ 的/ 取值/ ,/ 设/ m/ 为/ 特征/ 个数/ ,/ 则/ 可/ 得到/ T/ 个/ m/ ×/ n/ 的/ 特征/ 矩阵/ / / =/ {/ 犃/ 1/ ,/ 犃/ 2/ ,/ …/ ,/ 犃/ T/ }/ ./ 计算/ 用户/ 行为/ 模式/ 的/ 主要/ 过程/ 如下/ :/ 过程/ 1/ ./ 用户/ 行为/ 模式/ 的/ 计算/ ./ 1/ ./ 利用/ / / 计算/ 基准/ 特征/ 矩阵/ 犃/ ./ 2/ ./ 对/ 特征/ 矩阵/ 犃/ 与/ / / 进行/ 标准化/ 处理/ ./ 3/ ./ 对/ 基准/ 特征/ 矩阵/ 犃/ 进行/ 非负/ 矩阵/ 分解/ ,/ 获得/ 模元/ 矩阵/ 犠/ ./ 4/ ./ 对/ 每个/ 特征/ 矩阵/ :/ 已知/ 犃/ i/ ,/ 犠/ ,/ 求解/ 犃/ i/ =/ 犠/ ×/ 犎/ i/ ,/ 得到/ 模式/ 系数/ 矩阵/ 犎/ i/ ;/ 分别/ 提取/ {/ H1/ ,/ H2/ ,/ …/ ,/ HT/ }/ 中/ 的/ 第/ j/ 列/ 组成/ 用户/ j/ 在/ t/ 时间/ 内/ 基于/ 模元/ 矩阵/ 犠/ 的/ 行为/ 模式/ 演变/ 序列/ ./ 下面/ 分别/ 给出/ 每步/ 的/ 详细/ 说明/ ./ (/ 1/ )/ 计算/ 基准/ 特征/ 矩阵/ 基准/ 特征/ 矩阵/ 犃/ 为/ 所有/ 的/ 用户/ 提供/ 一个/ 统一/ 的/ 参考/ 标准/ ,/ 它/ 反映/ 了/ 用户/ 在/ 邮件/ 网络/ 中/ 整体/ 的/ 行为/ 特征/ 表现/ ./ 对于/ 用户/ j/ 的/ 特征/ i/ 而言/ ,/ 本文/ 简单/ 采用/ 特征/ i/ 在/ 各个/ 快照/ 中非/ 零值/ 的/ 均值/ 来/ 作为/ 基准/ 特征/ 矩阵/ 中/ 用户/ j/ 的/ 特征/ i/ 取值/ ,/ 即/ (/ 2/ )/ 特征/ 矩阵/ 标准化/ 由于/ 各个/ 特征/ 之间/ 的/ 尺度/ 差异/ 较大/ ,/ 例如/ 聚集/ 系数/ 取值/ 在/ [/ 0/ ,/ 1/ ]/ 之间/ ,/ 而/ 节点/ 的/ 度/ 可达/ 上千/ ,/ 两者之间/ 最大/ 相差/ 4/ 个/ 数量级/ ,/ 因此/ 数据/ 预处理/ 显得/ 十分/ 有/ 必要/ ./ 常用/ 的/ 标准差/ 标准化/ 会/ 产生/ 负值/ ,/ 无法/ 进行/ 后续/ 的/ 非负/ 矩阵/ 分解/ 的/ 工作/ ,/ 而/ 离差/ 标准化/ 对/ 数据/ 的/ 极值/ 过于/ 依赖/ ./ 在/ 此/ 我们/ 提出/ 一种/ 基于/ 分/ 位数/ 的/ 数据/ 标准化/ 方法/ ,/ 该/ 方法/ 简单/ 有效/ ,/ 并/ 能/ 很/ 好/ 保留/ 原/ 特征/ 的/ 分布/ 信息/ ./ 对于/ 基准/ 特征/ 矩阵/ 犃/ 的/ 每行/ 数据/ {/ x/ }/ (/ 它们/ 代表/ 了/ 不同/ 用户/ 同一/ 特征/ 的/ 取值/ )/ ,/ 首先/ 计算/ 其下侧/ p/ ①/ ①/ 为了/ 方便/ 期见/ ,/ 我们/ 将/ p/ 的/ 取值/ 范围/ 从/ (/ 0/ ,/ 1/ )/ 的/ 连续/ 区间/ x100/ =/ xmax/ ./ Page6/ 分/ 位数/ xp/ ,/ 然后/ 按照/ xp/ -/ 1/ </ xp/ 的/ 原则/ 构造/ 区间/ (/ xp/ -/ 1/ ,/ xp/ ]/ ,/ p/ ∈/ [/ 1/ ,/ 100/ ]/ ,/ 如果/ {/ x/ }/ 的/ 数据/ 落入/ 该/ 区间/ 内/ ,/ 则/ 把/ 它/ 的/ 值/ 改写/ 为/ p/ ,/ 最终/ 数据/ 取值/ 均/ 在/ [/ 0/ ,/ 100/ ]/ ./ 如此/ 对/ 基准网络/ 特征/ 矩阵/ 犃/ 做/ 标准化/ 处理/ 后/ ,/ 保存/ 其分/ 位数/ 矩阵/ 犘/ m/ ×/ 101/ ,/ 再/ 用/ 犘/ m/ ×/ 101/ 对/ 其他/ 的/ 特征/ 矩阵/ 犃/ k/ ∈/ / ,/ k/ =/ 1/ ,/ …/ ,/ T/ 做/ 如下/ 标准化/ 处理/ 犃/ kij/ =/ (/ 3/ )/ 模元/ 矩阵/ 求解/ 非负/ 矩阵/ 分解/ (/ NMF/ )/ 是/ Lee/ 与/ Seung/ [/ 16/ ]/ 在/ 1999/ 年/ 提出/ 的/ ,/ 并/ 迅速/ 引起/ 研究/ 人员/ 的/ 广泛/ 关注/ ,/ 已/ 成功/ 地被/ 运用/ 到/ 人脸识别/ 、/ 文本/ 分析/ 、/ 推荐/ 系统/ 、/ 数字水印/ 等/ 领域/ ./ 它/ 要求/ 分解/ 后/ 的/ 矩阵/ 所有/ 元素/ 均/ 为/ 非/ 负数/ ,/ 而/ 非/ 负数/ 的/ 限制/ 恰恰/ 是/ 许多/ 现实/ 应用/ 中/ 的/ 基本/ 约束/ ,/ 因此/ NMF/ 的/ 分解/ 结果/ 能够/ 很/ 方便/ 地/ 与/ 实际/ 问题/ 相结合/ ,/ 给出/ 合理/ 的/ 解释/ ./ 给定/ 一个/ 非负/ 矩阵/ 犃/ m/ ×/ n/ ,/ 非负/ 矩阵/ 分解/ 的/ 目的/ 是/ 将/ 犃/ m/ ×/ n/ 分解成/ 两个/ 非负/ 矩阵/ 犠/ m/ ×/ r/ 和/ 犎/ r/ ×/ n/ 的/ 乘积/ ,/ 即/ 犃/ ≈/ 犠/ ×/ 犎/ ,/ 并/ 使得/ 误差/ 犃/ -/ 犠/ ×/ 犎/ 2/ 代表/ Frobenius/ 范数/ )/ 最小/ ,/ 其中/ r/ 是/ 预先确定/ 的/ 参数/ ,/ 通常/ 满足/ r/ </ mn/ // (/ m/ +/ n/ )/ ,/ 犠/ 称为/ 基/ 矩阵/ ,/ 犎/ 称为/ 系数/ 矩阵/ ,/ 如图/ 2/ 所示/ (/ 更/ 多/ 内容/ 请参阅/ 文献/ [/ 17/ ]/ )/ ./ 本文/ 实验/ 中/ 选用/ Kim/ 与/ Park/ [/ 18/ ]/ 提出/ 的/ NMF/ // ANSL/ 算法/ 来/ 计算/ 非负/ 矩阵/ 分解/ ./ 如果/ 把/ 矩阵/ 都/ 表示/ 为列/ 向量/ 集/ :/ 犃/ =/ [/ 犃/ ·/ 1/ ,/ 犃/ ·/ 2/ ,/ …/ ,/ 犃/ ·/ n/ ]/ ,/ 犠/ =/ [/ 犠/ ·/ 1/ ,/ 犠/ ·/ 2/ ,/ …/ ,/ 犠/ ·/ r/ ]/ ,/ 犎/ =/ [/ 犎/ ·/ 1/ ,/ 犎/ ·/ 2/ ,/ …/ ,/ 犎/ ·/ n/ ]/ ,/ 则/ 某/ 用户/ 特征向量/ 、/ 模元/ 矩阵/ 、/ 系数/ 矩阵/ 间/ 的/ 关系/ 为/ 犃/ ·/ j/ =/ ∑/ r/ 给出/ 基准/ 特征/ 矩阵/ 犃/ ,/ 给定/ 模元/ 个数/ r/ (/ 模元/ 个数/ r/ 决定/ 了/ 问题/ 的/ 分析/ 粒度/ ,/ 较大/ 的/ r/ 会/ 提高/ 描述/ 精度/ ,/ 但/ 也/ 增加/ 了/ 模型/ 的/ 复杂度/ ,/ 关于/ 模元/ 个数/ 的/ 确定/ 在/ 第/ 5/ 节会/ 给予/ 讨论/ )/ ,/ 通过/ NMF/ 分解/ 特征/ 矩阵/ 犃/ m/ ×/ n/ 得到/ 基/ 矩阵/ 犠/ m/ ×/ r/ ./ 其中/ 基/ 矩阵/ 犠/ 的/ r/ 个列/ 向量/ 就是/ 所/ 要求/ 的/ r/ 个/ 模元/ ./ 由于/ 基准/ 特征/ 矩阵/ 犃/ 是/ 基于/ 全体/ 特征/ 矩阵/ / / 构建/ 的/ ,/ 因此/ 犠/ 就/ 代表/ 整个/ 网络/ 中/ n/ 个/ 用户/ 的/ 基本/ 行为/ 模式/ 单元/ 集/ ./ (/ 4/ )/ 用户/ 行为/ 模式/ 计算/ 已知/ 特征/ 矩阵/ 犃/ i/ ,/ i/ ∈/ [/ 1/ ,/ T/ ]/ 和/ 模元/ 矩阵/ 犠/ ,/ 求其/ 系数/ 矩阵/ 犎/ i/ ,/ 使得/ 犃/ i/ -/ 犠/ ×/ 犎/ i2/ 这是/ 一个/ 非负/ 最小/ 二乘/ 问题/ ,/ 可用/ 文献/ [/ 19/ ]/ 中/ 的/ 方法/ 求解/ ./ 对于/ 用户/ j/ 而言/ 系数/ 向量/ 集/ {/ 犎/ 1/ ·/ j/ ,/ 犎/ 2/ ·/ j/ ,/ …/ ,/ 犎/ T/ ·/ j/ }/ 就/ 作为/ 其/ 在/ t/ 时间/ 内/ 基于/ 模元/ 矩阵/ 犠/ 的/ 行为/ 模式/ 演变/ 序列/ ./ 通过/ 对/ 该/ 序列/ 的/ 分析/ 可以/ 很/ 方便/ 地/ 检测/ 该/ 用户/ 行为/ 模式/ 的/ 变化/ ,/ 检测/ 异常/ 事件/ ./ 4/ 实验/ 分析/ 4.1/ 实验/ 数据/ 本文/ 实验/ 选用/ Enron/ 公司/ 内部人员/ 的/ 邮件/ 网络日志/ ①/ ./ Enron/ 公司/ 是/ 全美/ 最大/ 的/ 电力/ 和/ 天然气/ 销售/ 及/ 交易商/ ,/ 也/ 提供/ 各种/ 能源/ 产品/ 、/ 宽频/ 服务/ 以及/ 金融/ 和/ 风险管理/ 服务/ ./ 在/ 2001/ 年/ 10/ 月/ 至/ 11/ 月/ 短短/ 二十几天/ 时间/ 内/ ,/ Enron/ 股价/ 下跌/ 近/ 80/ %/ ,/ 近/ 200/ 亿美元/ 的/ 市值/ 蒸发/ ,/ 最后/ 退市/ 以/ 破产/ 告终/ ./ 该/ 邮件/ 数据/ 集是/ 美国联邦/ 能源/ 管制/ 委员会/ (/ FERC/ )/ 在/ 调查/ Enron/ 破产/ 事件/ 时/ 公开/ 的/ ./ 我们/ 选用/ 2001/ 年/ 1/ 月/ 1/ 日至/ 2001/ 年/ 12/ 月/ 30/ 日共/ 52/ 周/ 的/ 数据/ ,/ 把/ 后缀/ 为/ “/ @/ enron/ ./ com/ ”/ 的/ 邮箱/ 视作/ 内部/ 员工/ 的/ 邮箱/ ,/ 只/ 分析/ 发信/ 方/ 和/ 收信/ 方/ 至少/ 一方/ 邮箱/ 后缀/ 为/ “/ @/ enron/ ./ com/ ”/ 的/ 记录/ ,/ 然后/ 清除/ 无效/ 节点/ (/ 如/ no/ ./ address/ @/ enron/ ./ com/ ,/ @/ enron/ ./ com/ )/ 以及/ 节点/ 到/ 自身/ 的/ 边/ ,/ 我们/ 注意/ 到/ 数据/ 集中/ 的/ “/ CC/ ”/ (/ 抄送/ )/ 与/ “/ BCC/ ”/ (/ 密送/ )/ ①/ http/ :/ // // www/ ./ isi/ ./ edu/ // ~/ adibi/ // Enron/ // Enron/ ./ htmPage7/ 字段/ 的/ 记录/ 具有/ 高度/ 的/ 重合/ 性/ ,/ 就是说/ 一封/ 邮件/ 同时/ 抄送/ 、/ 密送/ 了/ 同一个/ 人/ ,/ 因此/ 仅/ 保留/ 抄送/ 记录/ ,/ 实验/ 数据/ 的/ 基本/ 信息/ 如表/ 2/ 所示/ ./ 全部/ 通信/ 106265734726/ 内部/ 通信/ 97172423661/ 外部/ 通信/ 9093311065/ 邮件/ 网络/ 的/ 切分/ 间隔/ 会/ 影响/ 模元/ 代表/ 的/ 含义/ ,/ 切分/ 间隔/ 的/ 大小/ 完全/ 取决于/ 研究者/ 对/ 问题/ 的/ 关注/ 角度/ ./ 本文/ 实验/ 中/ 选用/ “/ 周/ ”/ 这一/ 基本/ 的/ 工作/ 周期/ 来/ 作为/ 网络/ 的/ 切分/ 间隔/ ,/ 将/ Enron/ 数据/ 集/ 按照/ 周为/ 单位/ 分割/ 成/ 52/ 份/ ,/ 基本/ 数据/ 统计/ 如图/ 5/ 所示/ ./ 每个/ 内部/ 员工/ 邮箱/ 在/ 各/ 快照/ 中/ 出现/ 次数/ 统计/ 如图/ 6/ 所示/ ./ 由于/ 本文/ 关注/ 的/ 是/ 用户/ 行为/ 模式/ ,/ 而/ 模式/ 是/ 基于/ 长时间/ 的/ 记录/ 来/ 学习/ 的/ ,/ 因此/ 我们/ 只/ 选择/ 那些/ 长期/ 活跃/ 的/ 用户/ 作为/ 模式/ 挖掘/ 的/ 对象/ ./ 本/ 实验/ 中/ 选取/ 前/ 5/ %/ 的/ 活跃/ 用户/ 作为/ 模式/ 挖掘/ 的/ 对象/ ,/ 即/ 在/ 52/ 个/ 快照/ 中/ 出现/ 次数/ 在/ 32/ 次/ 以上/ 的/ 用户/ ,/ 共有/ 1191/ 个/ 用户/ ./ 4.2/ 特征/ 筛选/ 收集/ 到/ 的/ 多个/ 特征/ 之间/ 可能/ 会/ 有/ 相互/ 依赖性/ ,/ 为了/ 降低/ 数据/ 维数/ 并/ 提高/ 计算/ 的/ 精确性/ ,/ 可以/ 利用/ Pearson/ 相关系数/ 来/ 计算/ 特征/ 之间/ 的/ 相关性/ ,/ 依此/ 来/ 做/ 特征/ 筛选/ ./ 例如/ 相关系数/ 的/ 绝对值/ 大于/ 给定/ 阈值/ ,/ 就/ 说明/ 两个/ 特征/ 的/ 相关性/ 大于/ 预设/ ,/ 应该/ 删掉/ 其中/ 一个/ ./ 结合/ 前面/ 的/ 描述/ 我们/ 按照/ 内部/ 通信/ 网络/ 、/ 外部/ 通信/ 网络/ 、/ 结构特征/ 、/ 职能/ 特征/ 的/ 层次/ 可/ 选取/ 内部/ 聚集/ 系数/ 、/ 出/ 度/ 、/ 入度/ 、/ 邮件/ 抄送/ 数量/ 、/ 外部/ 联系/ 人数/ 、/ 内部联系/ 人数/ 等/ 众多/ 特征/ ./ 但是/ 由于/ Enron/ 数据/ 集/ 本身/ 所/ 包含/ 的/ 信息/ 较少且/ 不够/ 完整/ ,/ 本文/ 实验/ 中仅/ 提取/ 到/ 了/ 46/ 个/ 特征/ ./ 如图/ 7/ 所示/ 特征/ 之间/ 的/ 相关性/ 集中/ 分布/ 在/ [/ 0.2/ ,/ 0.6/ ]/ 区间/ ,/ 实验/ 中设/ 特征/ 间/ Pearson/ 相关系数/ 阈值/ 为/ 0.7/ (/ 由于/ 特征/ 个数/ 较少且/ 彼此/ 相关性/ 较大/ ,/ 因此/ 选取/ 了/ 较大/ 的/ 阈值/ ./ 此处/ 的/ 阈值/ 仅作/ 示范/ 用/ ,/ 在/ 真实情况/ 下/ 应该/ 根据/ 特征/ 之间/ 相关性/ 的/ 分布/ 情况/ 选取/ 较/ 合适/ 的/ 阈值/ ,/ 以求/ 在/ 保证/ 特征/ 间/ 低/ 相关性/ 的/ 同时/ 保留/ 较/ 多/ 的/ 特征/ )/ ,/ 共/ 删除/ 31/ 个/ 特征/ ,/ 剩下/ 15/ 个/ 特征/ ,/ 各/ 特征/ 的/ 含义/ 详见/ 表/ 3/ ./ ID/ 含义/ ID/ 含义/ ID/ 含义/ 1/ #/ r6/ #/ (/ s/ ,/ u/ )/ [/ i/ ]/ 11ID9/ // ID7/ [/ i/ ]/ 2/ #/ s7/ #/ / (/ u/ ,/ r/ )/ [/ i/ ]/ 12/ #/ r/ [/ o/ ]/ 3LCC/ [/ i/ ]/ 8/ #/ / (/ s/ ,/ u/ )/ [/ i/ ]/ 13/ #/ s/ [/ o/ ]/ 4/ #/ r/ [/ i/ ]/ 9/ #/ (/ u/ ,/ r/ )/ {/ CC/ }/ [/ i/ ]/ 14/ #/ (/ u/ ,/ r/ )/ {/ CC/ }/ [/ o/ ]/ 5/ #/ s/ [/ i/ ]/ 10/ #/ (/ s/ ,/ u/ )/ {/ CC/ }/ [/ i/ ]/ 15/ #/ (/ s/ ,/ u/ )/ {/ CC/ }/ [/ o/ ]/ 注/ :/ #/ 代表/ 数量/ ,/ / 代表/ 不/ 重复/ ,/ u/ 代表/ 该/ 用户/ ,/ r/ 代表/ u/ 主动/ 通信/ 的/ 联系人/ ,/ s/ 代表/ 主动/ 与/ u/ 通信/ 的/ 联系人/ ;/ (/ u/ ,/ r/ )/ 代表/ 用户/ u/ 发送/ 的/ 邮件/ ,/ (/ s/ ,/ u/ )/ 代表/ 用户/ u/ 接收/ 到/ 的/ 邮件/ ;/ {/ TO/ ,/ CC/ }/ 代表/ 传送/ 方式/ ;/ LCC/ 指/ 局部/ 聚集/ 系数/ ;/ [/ i/ ]/ 指域/ 内/ 网络/ ,/ [/ o/ ]/ 指/ 域外/ 网络/ ./ 4.3/ 模式/ 计算/ 与/ 分析/ 对于/ NMF/ 的/ 实现/ 我们/ 采用/ Li/ 等/ 人/ [/ 20/ ]/ 的/ Matlab/ 工具包/ ./ 该/ 工具包/ 中/ 使用/ 迭代/ 的/ 方式/ 来/ 计算/ 非负/ 矩阵/ 分解/ ,/ 我们/ 设定/ 判断/ 迭代/ 收敛/ 的/ 误差/ 阈值/ 为/ 10/ -/ 6.4/ ./ 3.1/ 模元/ 含义/ 及/ 个数/ 的/ 确定/ 模元/ 本质/ 上/ 是/ 特征/ 的/ 组合/ ,/ 其/ 具体/ 含义/ 需要/ 借助/ 该/ 模元/ 中/ 占/ 主导地位/ 的/ 特征/ 的/ 含义/ 并/ 结合/ 邮件/ 用户/ 的/ 背景/ 知识/ 来/ 进行/ 归纳/ 抽象/ ./ 模元/ 的/ 个数/ 决定/ 了/ 行为/ 模式分析/ 的/ 研究/ 尺度/ ./ 图/ 8/ 展示/ 了/ 不同/ 模元/ 个数/ 与/ 特征/ 的/ 对应/ 关系/ ./ 由表/ 3/ 可知/ 特征/ 3/ ~/ 11/ 是/ 邮件/ 网络/ 域/ 内/ 特征/ ,/ 而/ 特征/ 12/ ~/ 15/ 是/ 邮件/ 网络/ 域外/ 特征/ ./ 当/ r/ =/ 2/ 时/ ,/ 模元/ 1/ 中域/ 内/ 特征/ 与/ 域外/ 特征/ 均/ 有/ 体现/ ,/ 并且/ 表示/ 接收/ 邮件/ 行为/ 的/ 这类/ 特征/ 权重/ 较/ 高/ ,/ 因此/ 可以/ 推断/ 模元/ 1/ 代表/ 了/ 常/ 对外/ 联络/ 并/ 接收/ 邮件/ 比较/ 多/ 的/ 这类/ 用户/ 行为/ ;/ 而/ 模元/ 2/ 中/ 特征/ 12/ ~/ 15/ 的/ Page8/ 权重/ 为/ 0/ ,/ 说明/ 该/ 模元/ 反映/ 的/ 主要/ 是/ 仅/ 存在/ 域/ 内/ 通信/ 的/ 这类/ 用户/ 行为/ ,/ 同时/ 注意/ 到/ 其/ 特征/ 1/ 、/ 3/ 、/ 4/ 、/ 9/ 、/ 11/ 的/ 权重/ 较/ 高/ ,/ 结合/ 这些/ 特征/ 在/ 表/ 3/ 中/ 的/ 含义/ 可以/ 推断/ 模式/ 2/ 主要/ 代表/ 了/ 跟/ 内部人员/ 具有/ 较/ 频繁/ 通信/ 的/ 用户/ 行为/ ./ 随着/ 模元/ 个数/ 的/ 增加/ ,/ 模元/ 所/ 代表/ 的/ 含义/ 也/ 越来越/ 精细/ ,/ 从而/ 可以/ 反映/ 出/ 更加/ 细致/ 的/ 信息/ ,/ 体现/ 了/ 模型/ 的/ 多/ 尺度/ 特点/ ./ 图/ 8/ 中当/ r/ =/ 3/ 时/ ,/ 可以/ 分析/ 出模/ 元/ 1/ 重点/ 体现/ 了/ 对外/ 通信/ 的/ 行为/ 模式/ ;/ 模元/ 2/ 中/ 特征/ 3/ 、/ 6/ 、/ 8/ 、/ 10/ 的/ 权重/ 较/ 高/ ,/ 而/ 已知/ 特征/ 3/ 局部/ 聚集/ 系数/ 代表/ 其/ 联系人/ 之间/ 通信联系/ 的/ 强弱/ ,/ 特征/ 6/ 、/ 8/ 、/ 10/ 主要/ 是/ 跟/ 收信/ 有关/ 的/ 特征/ ,/ 可/ 推测/ 该/ 模元/ 代表/ 了/ 那些/ 社团/ 领袖/ 的/ 行为/ 模式/ ;/ 模元/ 3/ 侧重/ 在/ 对域/ 内/ 发送/ 邮件/ 的/ 特征/ 但是/ 局部/ 聚集/ 系数/ 很/ 低/ ,/ 代表/ 了/ 那些/ 具有/ 发布/ 消息/ 通告/ 等/ 广播/ 行为/ 的/ 用户/ 基本/ 行为/ 模式/ ./ 为了/ 展示/ 不同/ 的/ 模元/ 个数/ 对/ 用户/ 行为/ 模式/ 挖掘/ 的/ 影响/ ,/ 我们/ 分别/ 以图/ 8/ 中/ 两类/ 模元/ 为/ 基础/ 对/ 各个/ 快照/ 的/ 特征/ 矩阵/ 做/ 分解/ ,/ 并/ 提取/ 所有/ 系数/ 矩阵/ 中/ 有关/ JeffreySkilling/ 的/ 列/ 组成/ 多元/ 序列/ ,/ 该/ 序列/ 即/ 体现/ 其/ 通信/ 行为/ 模式/ 的/ 演变/ 情况/ ,/ 见图/ 9/ ./ JeffreySkilling/ 在/ 2001/ 年/ 2/ 月/ 12/ 日/ 当选/ 首席/ 执行官/ (/ CEO/ )/ ,/ 到/ 8/ 月/ 14/ 日/ 突然/ 辞职/ ,/ 共/ 6/ 个/ 月/ 的/ 时间/ ./ 上文/ 已/ 分析/ 过图/ 9/ 中/ A/ 与/ B/ 的/ 模式/ 1/ 均/ 体现/ 了/ 有/ 较/ 频繁/ 的/ 对外/ 联络/ 特征/ ,/ 而/ 从/ 模式/ 演变/ 图中/ 可以/ 很/ 明显/ 地/ 看出/ 从/ 第/ 16/ 周/ 开始/ 模式/ 1/ 表现/ 的/ 十分/ 明显/ ,/ 这/ 与其/ 职位/ 的/ 变动/ 以及/ 作为/ CEO/ 对外/ 商业/ 洽谈/ 、/ 外事/ 处理/ 等/ 工作/ 特点/ 相符/ ./ 他/ 辞职/ 时间/ 大约/ 对应/ 33/ 周/ (/ 图中/ 黑色/ 虚线/ 中间/ 部分/ )/ ,/ 从/ 其前/ 两周/ 的/ 行为/ 变化/ 来看/ A/ 中模/ 元/ 2/ 突然/ 增多/ 即/ 对内/ 的/ 通信/ 多/ 了/ 起来/ ,/ 而/ 从/ B/ 中/ 看出/ 主要/ 是/ 模元/ 3/ 的/ 增加/ ,/ 更进一步/ 可知/ 其/ 对内/ 通信/ 主要/ 体现/ 在/ 广发/ 消息/ 这/ 类/ 行为/ ./ 可见/ 模元/ 个数/ 的/ 增加/ 可以/ 对/ 用户/ 的/ 行为/ 有/ 更为/ 细致/ 的/ 分析/ ./ 模元/ 个数/ 影响/ 了/ 对/ 用户/ 行为/ 模式/ 挖掘/ 分析/ 的/ 粒度/ ,/ 模元/ 个数/ 的/ 作用/ 类似/ 于/ 空间/ 的/ 维度/ ,/ 小/ 的/ 可以/ 降低/ 计算/ 的/ 复杂度/ ,/ 但/ 对/ 模式/ 的/ 描述/ 过于/ 宏观/ ,/ 不利于/ 对/ 用户/ 自身/ 的/ 模式/ 演变/ 的/ 分析/ ;/ 大/ 的/ 可以/ 对/ 行为/ 模式/ 进行/ 更/ 细致/ 的/ 描述/ ,/ 但会/ 增加/ 计算/ 的/ 复杂度/ ,/ 不利于/ 对/ 用户/ 行为/ 模式/ 的/ 对比/ 分析/ ./ 如何/ 选择/ 合适/ 的/ 模元/ 个数/ 以/ 准确/ 有效/ 地/ 挖掘/ 用户/ 行为/ 模式/ 是/ 一个/ 值得/ 深入探讨/ 的/ 问题/ ./ 为了/ 更好/ 地/ 描述/ 众多/ 不同/ 用户/ 的/ 行为/ 模式/ ,/ 我们/ 期望/ 得到/ 更/ 多/ 的/ 相关性/ 低/ 的/ 模元/ ./ 本文/ 中/ 借助/ 模元间/ Pearson/ 相关系数/ 采用/ 迭代/ 筛减/ 的/ 方式/ 来/ 确定/ 模元/ 个数/ ./ 给定/ 一个/ 模元/ 的/ 相关性/ 阈值/ α/ ,/ 要求/ 最终/ 所有/ 模元/ 之间/ 的/ 相关系数/ 均/ 小于/ 该/ 阈值/ ./ 首先/ 给出/ 一个/ 较大/ 的/ 模元/ 个数/ 初值/ r/ ,/ 通过/ 对/ 基准/ 特征/ 矩阵/ 犃/ 进行/ 模元/ 个数/ 为/ r/ 的/ 非负/ 矩阵/ 分解/ 计算/ 出模/ 元/ 矩阵/ 犠/ ;/ 然后/ 计算/ 各模/ 元/ 之间/ 的/ Pearson/ 相关系数/ ,/ 如果/ 存在/ 模元间/ 的/ 相关系数/ 大于/ 阈值/ α/ ,/ 则/ 把/ 模元/ 个数/ 定为/ r/ -/ 1/ ;/ 重复/ 以上/ 步骤/ ,/ 直到/ 所有/ 模元/ 的/ 相关系数/ 均/ 小于/ α/ 为止/ ./ 实验/ 中/ 设置/ 模元间/ 相关系数/ 的/ 阈值/ 为/ 0.2/ ,/ 初始/ 模元/ 个数/ 为/ 12/ ,/ 经过/ 6/ 轮/ 运算/ 最终/ 确定/ 模元/ 个数/ 为/ 7/ ,/ 即/ 可以/ 从/ 15/ 个/ 特征/ 中/ ,/ 提取/ 出/ 7/ 个/ 基本/ 行为/ 模式/ 单元/ 来/ 描述/ 活跃度/ 为/ Top5/ %/ 的/ 1191/ 个/ 用户/ 的/ 通信/ 行为/ 模式/ ,/ 同时/ 保证/ 了/ 模元/ 之间/ 的/ 相关系数/ 小于/ 0.2/ ,/ 彼此间/ 具有/ 较/ 好/ 的/ 区分/ 性/ ./ 为了/ 说明/ 模元/ 的/ 客观性/ ,/ 我们/ 另/ 选取/ Top3/ %/ (/ 至少/ 出现/ 39/ 次/ ,/ 共/ 741/ 个/ 用户/ )/ 和/ Top10/ %/ (/ 至少/ 出现/ 20/ 次/ ,/ 共/ 2479/ 个/ 用户/ )/ 的/ 活跃/ 用户/ 作为/ 对象/ ,/ 然后/ 与/ Top5/ %/ 的/ 用户/ 的/ 模元/ 做/ 对照/ ./ 模元/ 个数/ 定为/ 7/ 时其/ 各自/ 模元/ 与/ 特征/ 的/ 对应/ 关系/ 见图/ 10/ ./ 可见/ Page9/ 虽然/ 选取/ 的/ 用户量/ 不同/ ,/ 但是/ 最终/ 的/ 模元/ 与/ 特征/ 的/ 对应/ 关系/ 是/ 基本一致/ 的/ ,/ 只是/ 在/ 权重/ 上面/ 有所/ 差异/ ,/ 说明/ 模元/ 在/ 用户/ 行为/ 模式/ 挖掘/ 的/ 过程/ 中是/ 相对/ 稳定/ 的/ ./ 4.3/ ./ 2/ 工作/ 性质/ 与/ 模式/ 的/ 关系/ 我们/ 认为/ 工作/ 性质/ 决定/ 了/ 用户/ 的/ 基本/ 行为/ 模式/ ,/ 不同/ 的/ 职务/ 所/ 体现/ 出/ 的/ 行为/ 模式/ 会/ 不同/ ,/ 但/ 具有/ 相同/ 工作/ 性质/ 的/ 个体/ 之间/ 会因/ 受到/ 个体/ 性格/ 、/ 生活习惯/ 等/ 个性/ 的/ 影响/ 表现/ 出/ 差异性/ ./ 图/ 11/ 给出/ 了/ 两种/ 不同/ 职务/ 的/ 员工/ 在/ 图/ 8/ 中/ 所示/ 模元/ 个数/ 为/ 2/ 的/ 情况/ 下/ 通信/ 行为/ 模式/ 对比/ ,/ 左侧/ 一列/ 是/ 5/ 位/ 职员/ (/ Employee/ )/ ,/ 右侧/ 一列/ 是/ 5/ 位/ 交易员/ (/ Trader/ )/ ./ 由上/ 文知/ ,/ 模元/ 1/ 代表/ 较/ 频繁/ 的/ 域外/ 通信/ 模式/ ,/ 模元/ 2/ 主要/ 代表/ 域/ 内/ 通信/ 模式/ ./ 图中/ 可以/ 明显/ 地/ 看出/ 交易员/ 的/ 通信/ 行为/ 模式/ 以模/ 元/ 2/ 为主/ ,/ 而/ 职员/ 的/ 通信/ 行为/ 模式/ 中模/ 元/ 1/ 的/ 比重/ 相对/ 交易员/ 而言/ 更/ 多一些/ ,/ 可以/ 解释/ 为/ 交易员/ 的/ 工作/ 更/ 多/ 的/ 需要/ 跟/ 客户/ 频繁/ 地/ 沟通/ ,/ 所以/ 域外/ 通信/ 较/ 多/ ,/ 而/ 职员/ 的/ 工作/ 交流/ 主要/ 在/ 公司/ 内部/ ,/ 个体/ 间/ 的/ 差异/ 导致/ 其/ 模式/ 演变/ 的/ 不同/ ./ 这/ 一方面/ 验证/ 了/ 工作/ 性质/ 决定/ 通信/ 模式/ 的/ 假设/ ,/ 另一方面/ 也/ 图/ 12JeffreyMcMahon/ 通信/ 行为/ 模式/ 演变/ 图/ 说明/ 保留/ 不够/ 完整/ 的/ 对外/ 邮件/ 网络/ 的/ 信息/ 是/ 有/ 必要/ 的/ ,/ 如若不然/ 就/ 无法/ 挖掘出/ 交易员/ 这/ 类/ 职务/ 重在/ 对外/ 通信/ 的/ 这/ 一/ 行为/ 模式/ ./ 同时/ 相同/ 职务/ 的/ 个体/ 之间/ 也/ 有着/ 不同/ 的/ 模式/ 演化/ 轨迹/ ,/ 表明/ 个体/ 的/ 通信/ 行为/ 模式/ 会/ 受到/ 个体化/ 差异/ 的/ 影响/ ./ 另外/ ,/ 可以/ 明显/ 地/ 看出/ 职员/ A/ 在/ 18/ 周时/ 通信/ 模式/ 发生/ 了/ 重大/ 的/ 改变/ ,/ 可/ 推测/ 其/ 工作岗位/ 发生/ 了/ 变化/ ./ 4.3/ ./ 3/ 用户/ 个体/ 行为/ 模式/ 的/ 分析/ 通过/ 对/ 用户/ 各模/ 元/ 的/ 表现/ 强度/ 的/ 变化/ 分析/ 可以/ 发现/ 用户/ 在/ 使用/ 邮件/ 过程/ 中/ 发生/ 的/ 事件/ ,/ 例如/ 工作/ 职能/ 的/ 转变/ 等/ ./ 图/ 12/ 给出/ 了/ Enron/ 的/ 首席/ 财务/ 官/ (/ CFO/ )/ JeffreyMcMahon/ 依据/ 图/ 10/ 中/ Top5/ %/ 的/ 模元为/ 基时/ 通信/ 行为/ 模式/ 演变/ 图/ ,/ 左上/ 是/ 模元/ 与/ 特征/ 的/ 对应/ 关系/ ,/ 右上/ 是/ 通信/ 行为/ 模式/ 演变/ 序列/ 的/ 立体/ 展示/ ./ 从图/ 中/ 可以/ 看出/ 在/ 44/ 周后/ McMahon/ 所/ 展现出/ 的/ 行为/ 模式/ 有/ 较/ 明显/ 的/ 变化/ ,/ 主要/ 是/ 模元/ 2/ 、/ 3/ 、/ 4/ 所/ 占/ 比重/ 开始/ 增加/ 并/ 维持/ 下来/ ./ 结合/ 左上/ 侧/ 模元/ 与/ 特征/ 的/ 对应/ 图/ 以及/ 表/ 3/ 中/ 各/ 特征/ 的/ 含义/ 分析/ 得知/ 模元/ 2/ 主要/ 代表/ 接受/ 来自/ 企业/ 内部/ 的/ 抄送/ 邮件/ 模式/ ,/ 模元/ 3/ 主要/ 代表/ 其/ 联系人/ 之间/ 存在/ 紧密联系/ 的/ 模式/ ,/ 模元/ 4/ 代表/ 接受/ 来自/ 企业/ 内部/ 邮件/ 的/ 模式/ ./ 2001/ 年/ 10/ 月/ 24/ 日/ (/ 约/ 第/ 44/ 周/ ,/ 下图/ 中/ 黑色/ 虚线/ 所示/ )/ 原/ 工业/ 市场部/ 主管/ JeffreyMcMahon/ 接替/ AndrewFastow/ 担任/ Enron/ 的/ CFO/ ./ 基于/ 这一/ 背景/ 我们/ 可以/ 把/ 上述/ 行为/ 模式/ 的/ 改变/ 理解/ 为/ McMahon/ 从/ 中级/ 领导/ 升级/ 为/ 整个/ 企业/ 的/ 高管/ ,/ CFO/ 要/ 负责/ 财务/ 、/ 会计/ 、/ 投资/ 、/ 融资/ 、/ 投资/ 关系/ 和/ 法律/ 等/ 事务/ ,/ 其所/ 管辖/ 的/ 人员/ 跟/ 事务/ 开始/ 增多/ ,/ 于是/ 收到/ 抄送/ 邮件/ 的/ 次数/ 会/ 增加/ (/ 模式/ 2/ )/ ,/ 负责/ 的/ 事务/ 多/ 了/ 接受/ 邮件/ 的/ 总量/ 也/ 会/ 增加/ (/ 模式/ 4/ )/ ,/ 并且/ 会/ 直接/ 跟/ 公司/ 各/ 领导阶层/ 进行/ 通信/ ,/ 而/ 这些/ 领导/ 之间/ 也/ 必然/ 会/ 有/ 广泛/ 的/ 联络/ ,/ 所以/ 模元/ 3/ 代表/ 的/ 模式/ 也/ 开始/ 展现/ 出来/ ./ Page104/ ./ 4/ 与/ 相关/ 工作/ 的/ 对比/ GraphScope/ 所/ 关注/ 的/ 是/ 连续/ 快照/ 间/ 的/ 异常/ ,/ 可以/ 检测/ 快照/ 变化/ 的/ 时刻/ ,/ 从而/ 发现/ 整个/ 网络/ 层面/ 的/ 事件/ ,/ 但是/ 不能/ 发现/ 个体/ 的/ 异常/ 行为/ ./ OddBall/ 是/ 通过/ 个体/ 之间/ 的/ 对比/ 来/ 发现/ 那些/ 异/ 于/ 群体/ 的/ 节点/ ,/ 但/ 这/ 只能/ 说明/ 该/ 节点/ 与/ 其他/ 节点/ 的/ 行为/ 模式/ 有着/ 很大/ 的/ 不同/ ,/ 并/ 不/ 意味着/ 该点/ 的/ 行为/ 模式/ 是/ 异常/ 的/ ./ 正如/ 第/ 3/ 节中/ 所/ 描述/ 的/ 那样/ ,/ 不同/ 职位/ 的/ 人/ 其/ 邮件/ 通信/ 行为/ 模式/ 是/ 不同/ 的/ ,/ 可以/ 直观/ 地/ 认为/ 普通/ 职员/ 的/ 通信/ 模式/ 与/ 高层/ 管理者/ 的/ 通信/ 模式/ 是/ 有/ 差异/ 的/ ,/ 但是/ 普通/ 职员/ 的/ 数量/ 要/ 远远/ 多于/ 高层/ 管理者/ 的/ 数量/ ,/ 这/ 就/ 使得/ 管理者/ 在/ 行为/ 模式/ 上/ 异于/ 员工/ 群体/ ,/ 但/ 据此/ 就/ 可/ 说明/ 管理者/ 的/ 行为/ 模式/ 是/ 不/ 正常/ 的/ 吗/ ?/ 真实情况/ 未必/ 如此/ ./ 本文/ 的/ 工作/ 弥补/ 上述/ 两种/ 方法/ 的/ 不足/ ,/ 通过/ 对/ 用户/ 自身/ 不同/ 时间段/ 的/ 通信/ 行为/ 模式/ 进行/ 对比/ 可以/ 检测/ 出/ 用户/ 个体/ 行为/ 模式/ 发生/ 的/ 异常/ 变化/ ,/ 从而/ 为/ 事件/ 的/ 时间/ 定位/ 及/ 排查/ 提供/ 帮助/ ./ 5/ 问题/ 讨论/ 与/ 模型/ 应用/ 5.1/ 问题/ 讨论/ 模元/ 个数/ 决定/ 了/ 对/ 用户/ 行为/ 模式/ 挖掘/ 的/ 尺度/ ,/ 它/ 的/ 取值/ 大小/ 既/ 决定/ 了/ 对/ 用户/ 行为/ 模式分析/ 的/ 细腻/ 程度/ 又/ 影响/ 了/ 模式/ 表示/ 的/ 复杂度/ ./ 关于/ 模元/ 个数/ 的/ 选择/ 目前/ 缺少/ 统一/ 的/ 衡量标准/ ,/ 它/ 依赖于/ 具体/ 的/ 问题/ 背景/ 、/ 研究/ 目的/ 及/ 特征/ 之间/ 的/ 联系/ 等/ 因素/ ./ 文献/ [/ 11/ ]/ 利用/ 最小/ 描述/ 长度/ 准则/ 基于/ 最佳/ 压缩率/ 的/ 思考/ 给出/ 了/ 一个/ 可以/ 自动/ 确定/ 结构/ 角色/ 个数/ 的/ 模型/ ./ 它/ 研究/ 的/ 仅/ 是/ 节点/ 的/ 结构/ 属性/ ,/ 最佳/ 压缩率/ 也/ 意味/ 节点/ 集/ 的/ 共性/ 最大化/ ,/ 然而/ 本文/ 中/ 的/ 模元/ 概念/ 与其/ 相比/ 有/ 了/ 更/ 丰富/ 的/ 内涵/ ,/ 我们/ 的/ 目的/ 是/ 通过/ 学习/ 用户/ 的/ 通信/ 模式/ ,/ 希望/ 能/ 从中/ 挖掘/ 到/ 隐含/ 的/ 信息/ ,/ 因此/ 有时/ 较/ 多/ 的/ 基本模式/ 单元/ 会/ 有利于/ 发现/ 那些/ 更加/ 隐蔽/ 的/ 行为/ 模式/ ./ 模元/ 个数/ 也/ 可以/ 归结为/ 一个/ 研究/ 模型/ 的/ 尺度/ 问题/ ,/ 类似/ 于/ 聚类分析/ 中/ 类别/ 个数/ 、/ 主题/ 模型/ 中/ 主题/ 个数/ 、/ 社团/ 划分/ 中/ 社团/ 个数/ 等/ ,/ 自然/ 也/ 可以/ 借鉴/ 这/ 类/ 问题/ 的/ 解决方案/ ,/ 但/ 在/ 实际/ 中/ 还是/ 要/ 根据/ 具体/ 问题/ 来/ 区别对待/ ./ 此外/ ,/ 本文/ 需要/ 从/ T/ 个/ 邮件/ 网络/ 快照/ 的/ 特征/ 矩阵/ / / 中/ 构建/ 一个/ 基准/ 特征/ 矩阵/ 犃/ ./ 基准/ 特征/ 矩阵/ 通常/ 代表/ 用户/ 截至/ 某一/ 时刻/ 的/ 全局/ 情形/ 下/ 行为/ 特征/ 的/ 平均/ 体现/ ./ 整个/ 网络/ 中/ 基本模式/ 单元/ 的/ 挖掘/ 效果/ 依赖于/ 构建/ 的/ 基准/ 特征/ 矩阵/ 能/ 反映/ 出/ 用户/ 整体/ 行为/ 的/ 准确性/ 如何/ ./ 本文/ 简单/ 地/ 采取/ 了/ 取/ 平均值/ 的/ 方法/ 构建/ 基准/ 特征/ 矩阵/ ,/ 如何/ 合理/ 准确/ 地/ 描述/ 整个/ 邮件/ 网络/ 中/ 用户/ 的/ 主导/ 行为/ 模式/ 是/ 个/ 有待/ 解决/ 的/ 问题/ ./ 5.2/ 模型/ 应用/ 通过/ 引入/ 模元/ 的/ 概念/ 将/ 用户/ 某/ 快照/ 内/ 的/ 行为/ 模式/ 最终/ 表现/ 为/ 模元/ 空间/ 中/ 的/ 一个/ 向量/ ,/ 而/ 多个/ 连续/ 的/ 快照/ 就/ 可以/ 组成/ 一个/ 反映/ 用户/ 行为/ 模式/ 演变/ 的/ 多元/ 时间/ 序列/ ./ 基于/ 统一/ 的/ 模元来/ 表示/ 用户/ 的/ 行为/ 模式/ 大大/ 方便/ 了/ 对/ 用户/ 行为/ 模式/ 的/ 进一步/ 分析/ 和/ 比较/ ./ 例如/ 不仅/ 可以/ 通过/ 对/ 用户/ 行为/ 模式/ 的/ 变化/ 来/ 推测/ 事件/ 的/ 发生/ 时间/ 及其/ 基本/ 行为/ ,/ 还/ 可/ 通过/ 对/ 用户/ 模式/ 序列/ 进行/ 分析/ 学习/ ,/ 构建/ 用户/ 行为/ 模式/ 的/ 预测/ 模型/ ,/ 对/ 用户/ 以后/ 行为/ 模式/ 的/ 发展/ 做出/ 预测/ ./ 6/ 结束语/ 组织/ 机构/ 内/ 的/ 邮件/ 通信/ 主要/ 用于/ 业务/ 交流/ 、/ 消息传递/ 、/ 文件/ 发放/ 等/ 与/ 工作/ 紧密/ 相关/ 的/ 内容/ ./ 用户/ 行为/ 模式/ 是/ 用户/ 邮件/ 通信/ 行为/ 的/ 综合/ 体现/ ,/ 挖掘/ 用户/ 行为/ 模式/ 对/ 检测/ 数据/ 泄漏/ 、/ 内部/ 威胁/ 等/ 工作/ 有着/ 重要/ 的/ 实用价值/ ./ 本文/ 以/ Enron/ 公司/ 的/ 邮件/ 通信/ 日志/ 为/ 研究/ 对象/ ,/ 引入/ 基本/ 行为/ 模式/ 单元/ 挖掘/ 用户/ 的/ 通信/ 行为/ 模式/ ./ 首先/ ,/ 把/ 邮件/ 通信/ 网络/ 从/ 结构/ 上/ 分为/ 域/ 内/ 和/ 域外/ 两/ 部分/ ,/ 提取/ 其/ 结构特征/ 和/ 职能/ 特征/ ./ 然后/ ,/ 通过/ 构建/ 邮件/ 通信/ 的/ 基准网络/ ,/ 利用/ 非负/ 矩阵/ 分解/ 来/ 计算/ 整个/ 网络/ 的/ 基本/ 行为/ 模式/ 单元/ ./ 最后/ 转化成/ 求解/ 非负/ 最小/ 二乘/ 问题/ ,/ 利用系数/ 序列/ 来/ 表示/ 用户/ 的/ 通信/ 行为/ 模式/ ./ 在/ Enron/ 邮件/ 数据/ 集/ 的/ 实验/ 结果表明/ 了/ 我们/ 的/ 方法/ 能够/ 有效/ 地/ 获取/ 用户/ 的/ 通信/ 行为/ 模式/ ,/ 并/ 能/ 通过/ 分析/ 用户/ 行为/ 模式/ 的/ 变化/ 来/ 定位/ 事件/ 的/ 发生/ ./ 

