Page1eCK/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ 赵建杰/ 1/ )/ 谷/ 大武/ 2/ )/ 1/ )/ (/ 上海交通大学/ 信息安全/ 工程学院/ 上海/ 200240/ )/ 2/ )/ (/ 上海交通大学/ 计算机科学/ 与/ 工程系/ 上海/ 200240/ )/ 摘要/ 如何/ 构造/ 安全/ 的/ 密钥/ 协商/ 协议/ 是/ 信息安全/ 领域/ 富有/ 挑战性/ 的/ 问题/ 之一/ ./ 然而/ 目前/ 多数/ 安全/ 协议/ 只能/ 达到/ “/ 启发式/ ”/ 安全/ ,/ 协议/ 的/ 安全性/ 假设/ 和/ 效率/ 也/ 不够/ 理想/ ./ 针对/ 这些/ 问题/ ,/ 文中/ 提出/ 了/ 一种/ 新/ 的/ 两轮/ 双方/ 认证/ 密钥/ 协商/ 协议/ ,/ 通过/ 分析/ 新/ 协议/ 的/ 安全/ 属性/ 指出/ 了/ 构造/ 双方/ 认证/ 密钥/ 协商/ 的/ 一些/ 原则/ ./ 随后/ ,/ 在/ eCK/ 模型/ 下/ 对/ 新/ 协议/ 进行/ 了/ 严格/ 的/ 形式化/ 证明/ ,/ 根据/ 相关/ 文献/ ,/ eCK/ 模型/ 是/ 目前/ 关于/ 双方/ 密钥/ 协商/ 协议/ 的/ 安全/ 程度/ 最高/ 的/ 形式化/ 模型/ ./ 性能/ 分析表明/ ,/ 新/ 协议/ 较/ 好/ 地/ 平衡/ 了/ 计算/ 量/ 和/ 安全性/ 假设/ 这/ 两个/ 协议/ 评价/ 指标/ ./ 另外/ ,/ 为了/ 实现/ 新/ 协议/ 的/ 密钥/ 确认/ 属性/ ,/ 文中/ 提出/ 了/ 一种/ 三轮/ 变体/ 协议/ ./ 关键词/ 密码学/ ;/ 认证/ 密钥/ 协商/ ;/ 可/ 证明/ 安全/ ;/ eCK/ 模型/ ;/ 密钥/ 确认/ 1/ 引言/ 在/ 开放/ 的/ 网络/ 环境/ 下/ ,/ 如何/ 确保/ 会话/ 双方/ 安全/ Page2/ 性/ 等/ 安全/ 服务/ ./ 近年来/ ,/ 学者/ 们/ 提出/ 了/ 大量/ 的/ 可/ 满足/ 不同/ 安全/ 需求/ 的/ 密钥/ 协商/ 协议/ ./ 然而/ ,/ 由于/ 没有/ 一种/ 有效/ 的/ 机制/ 确保/ 这/ 类/ 协议/ 不会/ 在/ 未来/ 被/ 新/ 的/ 攻击/ 方法/ 攻破/ ,/ 早期/ 的/ 密钥/ 协商/ 协议/ 只能/ 达到/ “/ 启发式/ ”/ 安全/ :/ 一旦/ 某/ 协议/ 被/ 新/ 的/ 攻击/ 方法/ 攻击/ 成功/ ,/ 该/ 协议/ 或者/ 需要/ 修改/ ,/ 或者/ 被/ 彻底/ 摒弃/ ./ 经过/ 一系列/ 的/ 攻击/ 与/ 修改/ 后/ ,/ 那些/ 被/ 认为/ 可以/ 抵抗/ 某些/ 应用环境/ 下/ 所有/ 已知/ 攻击/ 的/ 方案/ 才/ 可能/ 用于/ 实践/ ./ 这种/ 方法/ 的/ 弊端/ 是/ 显而易见/ 的/ :/ 协议/ 使用者/ 很难/ 确信/ 协议/ 的/ 安全性/ ,/ 反反复复/ 的/ 修补/ 更/ 增加/ 了/ 人们/ 对/ 安全性/ 的/ 担心/ ,/ 也/ 增加/ 了/ 实现/ 代价/ 或/ 成本/ ./ 因此/ ,/ 设计/ 可以/ 准确/ 刻画/ 参与者/ 和/ 敌手/ 特征/ 的/ 形式化/ 安全/ 模型/ ,/ 并/ 在/ 该/ 模型/ 下/ 讨论/ 协议/ 的/ 安全性/ 有着/ 重要/ 的/ 意义/ ./ 1993/ 年/ ,/ Bellare/ 和/ Rogaway/ [/ 1/ ]/ 开创性/ 地/ 提出/ 了/ 第一个/ 密钥建立/ 协议/ 的/ 形式化/ 安全/ 模型/ (/ BR/ 模型/ )/ ;/ 之后/ ,/ Shoup/ 和/ Rubin/ [/ 2/ ]/ 将/ BR/ 模型/ 推广/ 到/ 了/ 智能卡/ 领域/ ;/ BlakeWilson/ 和/ Menezes/ [/ 3/ ]/ 以及/ BlakeWilson/ 、/ Johnson/ 和/ Menezes/ [/ 4/ ]/ 又/ 将/ 安全/ 模型/ 推广/ 到/ 了/ 非对称/ 的/ 应用环境/ ./ 2001/ 年/ ,/ Canetti/ 和/ Krawc/ -/ zyk/ [/ 5/ ]/ 基于/ 前人/ 工作/ 提出/ 了/ 著名/ 的/ CK/ 模型/ ./ CK/ 模型/ 大大简化/ 了/ 形式化/ 证明/ 的/ 过程/ ,/ 但/ 该/ 模型/ 不能/ 保证/ 协议/ 抵抗/ 密钥/ 泄露/ 伪装/ (/ KeyCompromiseImper/ -/ sonation/ ,/ KCI/ )/ 攻击/ 和/ 双方/ 临时/ 私钥/ 泄露/ (/ LeakageofEphemeralPrivatekey/ ,/ LEP/ )/ 攻击/ ,/ 也/ 无法/ 确保/ 协议/ 的/ 弱/ 的/ 完美/ 前向/ 安全性/ (/ weakPerfectForwardSecrecy/ ,/ wPFS/ )/ ./ 为了/ 弥补/ 这些/ 缺陷/ ,/ 最近/ ,/ 微软/ 的/ 三位/ 学者/ LaMacchia/ 、/ Lauter/ 和/ Mityagin/ [/ 6/ ]/ 将/ 上述/ 安全/ 属性/ 整合/ 为/ 单一/ 定义/ ,/ 从而/ 形成/ 了/ 扩展/ 的/ CK/ 模型/ (/ extendedCK/ ,/ eCK/ )/ ./ 根据/ 文献/ [/ 7/ ]/ 的/ 研究/ ,/ 如果/ eCK/ 模型/ 中/ 使用/ 匹配/ 会话/ (/ matchingsession/ )/ 定义/ 伙伴关系/ (/ partnership/ )/ ,/ 则/ 该/ 模型/ 可/ 提供/ 目前/ 最强/ 的/ 关于/ 密钥/ 协商/ 协议/ 的/ 安全/ 定义/ ./ 本文/ 提出/ 了/ 一种/ 新/ 的/ 两轮/ 双方/ 认证/ 密钥/ 协商/ 协议/ (/ 命名/ 为/ SAKA/ ,/ 安全/ 认证/ 密钥/ 协商/ 协议/ )/ ,/ 并/ 在/ eCK/ 模型/ 下/ 进行/ 了/ 严格/ 的/ 形式化/ 证明/ ./ 我们/ 还/ 提出/ 了/ 一个/ 可/ 提供/ 密钥/ 确认/ (/ keyconfirmation/ )/ 的/ 三轮/ 双方/ 认证/ 密钥/ 协商/ 协议/ (/ 命名/ 为/ SAKA/ -/ C/ )/ ./ 本文/ 第/ 2/ 节/ 给出/ 一些/ 相关/ 的/ 背景/ 知识/ ;/ 第/ 3/ 节/ 提出/ 上述/ 两个/ 新/ 协议/ ,/ 并/ 通过/ 分析/ 新/ 协议/ 的/ 安全/ 属性/ 指出/ 构造/ 双方/ 认证/ 密钥/ 协商/ 的/ 一些/ 原则/ ;/ 第/ 4/ 节/ 首先/ 在/ eCK/ 模型/ 下/ 证明/ 新/ 协议/ 的/ 安全性/ ,/ 之后/ 选取/ 近年来/ 一些/ 类似/ 协议/ 进行/ 性能/ 比较/ ;/ 最后/ 一节/ 总结/ 全文/ ./ 2/ 背景/ 知识/ 本节/ 中/ ,/ 我们/ 首先/ 介绍/ 双方/ 认证/ 密钥/ 协商/ 协议/ 所/ 要/ 达到/ 的/ 安全/ 目标/ ,/ 之后/ 描述/ 本文/ 用于/ 安全/ 证明/ 的/ eCK/ 模型/ ,/ 2.3/ 节/ 定义/ 一些/ 安全/ 属性/ ./ 2.1/ 安全/ 目标/ 对/ 双方/ 认证/ 密钥/ 协商/ 协议/ 而言/ ,/ 由于/ 存在/ 着/ 大量/ 的/ 攻击/ 场景/ ,/ 很/ 难用/ 一个/ 简单/ 的/ 定义/ 描述/ 此类/ 方案/ 的/ 安全性/ ./ 文献/ [/ 8/ ]/ 指出/ ,/ 以下/ 3/ 个/ 安全/ 属性/ 可/ 极大/ 程度/ 地/ 包含/ 潜在/ 的/ 攻击/ :/ (/ 1/ )/ AKA/ 安全/ ./ 本文/ 引言/ 中/ 提到/ 的/ 安全/ 模型/ 中/ ,/ 都/ 假设/ 了/ 这样/ 的/ 实验/ :/ 在/ 一个/ 利用/ 不/ 安全/ 信道/ 通信/ 的/ 多方/ 通信/ 环境/ 下/ ,/ 敌手/ 可以/ 控制/ 所有/ 的/ 通信/ 过程/ (/ 可以/ 监听/ 、/ 延迟/ 、/ 重放/ 和/ 修改/ 消息/ 等/ )/ ,/ 并且/ 可/ 得到/ 某些/ 参与者/ 的/ 长期/ 私钥/ ./ 另外/ ,/ 敌手/ 有权/ 选择/ 某些/ 合法/ 的/ 参与者/ 进行/ 密钥/ 协商/ ./ 如果/ 敌手/ 不能/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 一次/ 新鲜/ 的/ (/ fresh/ ,/ 见/ 定义/ 2/ )/ 会话/ 过程/ 中/ 的/ 会/ 话/ 密钥/ 与/ 随机/ 值/ (/ 由/ 协议/ 的/ 模拟器/ 选取/ )/ ,/ 则/ 称/ 该/ 协议/ 是/ AKA/ 安全/ 的/ ./ (/ 2/ )/ 弱/ 的/ 完美/ 前向/ 安全性/ ./ AKA/ 安全/ 中/ 并未/ 包含/ 完美/ 前向/ 安全性/ (/ ForwardSecrecy/ ,/ FS/ )/ ./ 粗略地/ 讲/ ,/ 如果/ 协议/ 参与者/ 的/ 长期/ 私钥/ 被/ 敌手/ 获得/ ,/ 而/ 敌手/ 不能/ 由此/ 求/ 出/ 参与者/ 在/ 私钥/ 泄露/ 前/ 协商/ 获得/ 的/ 会/ 话/ 密钥/ 的话/ ,/ 则/ 称/ 该/ 协议/ 具有/ 前向/ 安全性/ ./ 根据/ 会话/ 性质/ 的/ 不同/ ,/ 前向/ 安全性/ 可/ 分为/ 完美/ 前向/ 安全性/ (/ Per/ -/ fectForwardSecrecy/ ,/ PFS/ )/ 和/ 弱/ 的/ 完美/ 前向/ 安全性/ (/ weakPerfectForwardSecrecy/ ,/ wPFS/ )/ ./ 具体来说/ ,/ 如果/ 长期/ 私钥/ 泄露/ 前/ 的/ 会/ 话/ 受到/ 了/ 敌手/ 的/ 破坏/ (/ 该/ 攻击者/ 控制/ 了/ 其中/ 一个/ 参与者/ ,/ 为/ 其/ 选择/ 了/ 这次/ 会话/ 的/ 临时/ 私钥/ )/ ,/ 而/ 敌手/ 仍/ 无法/ 获得/ 这次/ 会话/ 的/ 会/ 话/ 密钥/ ,/ 则/ 称/ 该/ 协议/ 具有/ 完美/ 前向/ 安全性/ ;/ 若/ 协议/ 只能/ 保证/ 敌手/ 在/ 获得/ 参与者/ 的/ 长期/ 私钥/ 后/ ,/ 之前/ 的/ 那些/ 未/ 被/ 敌手/ 破坏/ 的/ 会/ 话/ 的/ 会/ 话/ 密钥/ 不能/ 被/ 敌手/ 获得/ ,/ 则/ 称/ 该/ 协议/ 具有/ 弱/ 的/ 完美/ 前向/ 安全性/ ./ Krawczyk/ [/ 9/ ]/ 对/ 协议/ 的/ 前/ 向/ 安全性/ 进行/ 了/ 详细/ 研究/ ,/ 指出/ 基于/ 公钥/ 的/ 两轮/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ 都/ 无法/ 实现/ 完美/ 前向/ 安全性/ ,/ 而/ 只能/ 实现/ 弱/ 的/ 完美/ 前向/ 安全性/ ./ (/ 3/ )/ 抗/ 密钥/ 泄露/ 伪装/ 攻击/ ./ 假设/ 实体/ A/ 和/ B/ 是/ 协议/ 的/ 两个/ 参与者/ ,/ 则/ 当/ A/ 的/ 长期/ 私钥/ 被/ 敌手/ 获得/ 后/ ,/ 该/ 敌手/ 显然/ 能够/ 冒充/ A/ 与/ 其他/ 协议/ 的/ 参与者/ (/ 例如/ B/ )/ 进行/ 通信/ ./ 然而/ ,/ 如果/ 该/ 协议/ 抗/ 密钥/ 泄露/ 伪装/ (/ KCI/ )/ 攻击/ ,/ 则/ 这/ 一/ 密钥/ 泄露/ 不能/ 使得/ 敌手/ 反过来/ 向/ 实体/ A/ 冒充/ 为/ 其他/ 参与者/ (/ 例如/ B/ )/ ./ Page32/ ./ 2eCK/ 安全/ 模型/ 本/ 小节/ 我们/ 简要/ 回顾/ 由/ LaMacchia/ 、/ Lauter/ 和/ Mityagin/ 提出/ 的/ eCK/ 模型/ [/ 6/ ]/ ./ 参与者/ ./ 这一/ 模型/ 包括/ 一个/ 参与者/ 集合/ U/ ,/ 每个/ 参与者/ 被/ 模拟/ 成/ 概率/ 多项式/ 时间/ 图灵机/ ,/ 可以/ 同时/ 执行/ 多项式/ 次数/ 的/ 协议/ ./ 假设/ 协议/ 中/ 的/ 两个/ 参与者/ 为/ A/ 和/ B/ ,/ 则/ 记/ 双方/ 运行/ 的/ 第/ s/ 次会/ 话/ 为/ ∏/ s/ 证书/ 管理中心/ (/ certificationauthority/ )/ ./ eCK/ 模型/ 需要/ 一个/ 可信/ 第三方/ CA/ 验证/ 每个/ 参与者/ 的/ 长期/ 公钥/ 与其/ 身份/ 的/ 绑定/ (/ binding/ )/ 情况/ ,/ 所有/ 通过/ 该/ 验证/ 的/ 参与者/ (/ 包括/ 敌手/ )/ 均/ 可/ 参与/ 协议/ ./ 值得注意/ 的/ 是/ ,/ CA/ 并/ 不/ 验证/ 参与者/ 长期/ 私钥/ 与/ 长期/ 公钥/ 的/ 绑定/ 情况/ ./ 也就是说/ ,/ 协议/ 的/ 参与者/ 可能/ 拥有/ 相同/ 的/ 长期/ 公钥/ ./ 敌手/ ./ 敌手/ M/ 为/ 一个/ 主动攻击/ 者/ ,/ 它/ 被/ 模拟/ 为/ 一个/ 概率/ 多项式/ 时间/ 图灵机/ ./ eCK/ 模型/ 允许/ 敌手/ 任意/ 监听/ 、/ 延迟/ 、/ 重放/ 和/ 修改/ 消息/ 等/ ./ 也就是说/ ,/ M/ 可以/ 完全/ 控制/ 通信/ 网络/ ./ 我们/ 通过/ 一个/ 挑战者/ (/ challenger/ )/ 和/ 敌手/ M/ 之间/ 的/ 游戏/ (/ game/ )/ 定义/ 双方/ 认证/ 密钥/ 协商/ 协议/ 的/ 安全性/ ./ 在/ 该游戏/ 中/ ,/ M/ 被/ 允许/ 进行/ 下面/ 的/ 预言/ 机/ 查询/ (/ oraclequery/ )/ ,/ 并且/ ,/ 这些/ 查询/ 是/ 无序/ 和/ 自/ 适应/ 的/ :/ (/ 1/ )/ Send/ ∏/ s/ 照/ 协议/ 规范/ 应答/ 消息/ m/ ./ 另外/ ,/ 通过/ 该/ 查询/ ,/ 敌手/ 可/ 要求/ 参与者/ 一方/ (/ 如/ A/ )/ 发起/ 与/ 另一方/ (/ 如/ B/ )/ 的/ 会/ 话/ ;/ (/ 2/ )/ Long/ -/ term/ _/ Key/ _/ Reveal/ (/ A/ )/ ./ 敌手/ M/ 通过/ 此/ 查询/ 获得/ 参与者/ A/ 的/ 长期/ 私钥/ ;/ (/ 3/ )/ Ephemeral/ _/ Key/ _/ Reveal/ ∏/ s/ 通过/ 此/ 查询/ 获得/ 会话/ ∏/ s/ (/ 4/ )/ Session/ _/ Key/ _/ Reveal/ ∏/ s/ 查询/ 获得/ 会话/ ∏/ s/ (/ 5/ )/ Establish/ _/ Party/ (/ A/ )/ ./ 敌手/ M/ 通过/ 此/ 查询/ 可以/ 在/ CA/ 上/ 注册/ 参与者/ A/ 的/ 公钥/ ./ 此时/ ,/ M/ 可以/ 发起/ 未知/ 密钥/ 共享/ 攻击/ ;/ (/ 6/ )/ Test/ ∏/ s/ 一个/ 新鲜/ 的/ (/ Fresh/ ,/ 见/ 定义/ 2/ )/ 会话/ ∏/ s/ 询/ ./ 这时/ ,/ ∏/ s/ 此/ 查询/ :/ 若/ 投币/ 结果/ 为/ 0/ ,/ 那么/ 它/ 返回/ 协商/ 得到/ 的/ 会/ 话/ 密钥/ ;/ 否则/ 返回/ 会话/ 密钥/ 空间/ {/ 0/ ,/ 1/ }/ k/ 上/ 的/ 一个/ 随机/ 值/ ./ 这里/ ,/ k/ 表示/ 会话/ 密钥/ 的/ 比特/ 长度/ ./ 在/ 游戏/ 的/ 最后/ ,/ M/ 输出/ 一个/ 值/ b/ 作为/ 对/ b/ 的/ 判断/ ,/ 若/ b/ =/ b/ ,/ 则/ 称/ 敌手/ M/ 赢得/ 了/ 此/ 游戏/ ./ 在/ eCK/ 模型/ 中/ ,/ 并不需要/ 其它/ 模型/ 中/ (/ 如/ BR/ 模型/ 、/ CK/ 模型/ 等/ )/ 的/ Corrupt/ 查询/ ./ 这/ 是因为/ 在/ eCK/ 模型/ 中/ ,/ 敌手/ M/ 完全/ 可以/ 通过/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 、/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ 以及/ Session/ _/ Key/ _/ Reveal/ 查询/ 达到/ 与/ Corrupt/ 查询/ 相同/ 的/ 效果/ ./ 基于/ 以上/ 描述/ ,/ 我们/ 定义/ 会话/ 的/ 新鲜/ 性/ (/ Fresh/ -/ ness/ )/ 和/ 协议/ 的/ 安全性/ ./ 在此之前/ ,/ 先/ 定义/ 匹配/ 会话/ ./ 定义/ 1/ ./ 匹配/ 会话/ (/ matchingsession/ )/ ./ 如果/ 某次/ 会话/ ∏/ s/ 一个/ 会话/ ∏/ s/ 为/ ∏/ s/ 相应/ 的/ 下/ 一条/ 消息/ ,/ 那么/ 我们/ 说/ 这/ 两个/ 会话/ 是/ A/ ,/ B/ 匹配/ 的/ ./ 自然/ 的/ ,/ 拥有/ 匹配/ 会话/ 的/ 两个/ 会话/ 互/ 称为/ 匹配/ 会话/ ./ 定义/ 2/ ./ 新鲜/ 性/ (/ freshness/ )/ ./ 如果/ 参与者/ A/ 和/ B/ 通过/ 会话/ ∏/ s/ 话/ 满足/ :/ (/ 1/ )/ 敌手/ 没有/ 对/ 参与者/ A/ 和/ B/ 进行/ 过/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ ;/ 查询/ ./ (/ 2/ )/ 敌手/ 没有/ 对/ ∏/ s/ 那么/ ,/ 我们/ 称该/ 协议/ 是/ 新鲜/ 的/ ./ 定义/ 3/ ./ 协议/ 的/ 安全性/ ./ 在/ eCK/ 模型/ 下/ ,/ 敌手/ M/ 攻击/ 协议/ ∏/ 的/ 优势/ AdvAKAPr/ [/ b/ =/ b/ ]/ -/ 1/ // 2/ ./ 对于/ 任意/ 的/ 概率/ 多项式/ 时间/ 敌手/ M/ ,/ 如果/ 其/ 赢得/ 上述/ 游戏/ 的/ 优势/ AdvAKA/ 忽略/ 的/ ,/ 则/ 称/ 该/ 双方/ 认证/ 密钥/ 协商/ 协议/ 是/ 安全/ 的/ ./ 与/ CK/ 模型/ 相比/ ,/ eCK/ 模型/ 捕获/ 了/ 抗/ 密钥/ 伪装/ (/ KCI/ )/ 攻击/ 以及/ 抗/ 临时/ 私钥/ 泄露/ 等/ ./ 更/ 重要/ 的/ 是/ ,/ eCK/ 模型/ 允许/ 敌手/ M/ 同时/ 进行/ 参与者/ 双方/ 的/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Page4Reveal/ 查询/ (/ 但/ 不/ 允许/ 同时/ 对/ 同一个/ 参与者/ 进行/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ )/ ./ 尽管/ Boyd/ 等/ 人/ [/ 10/ ]/ 指出/ eCK/ 模型/ 并不比/ CK/ 模型/ 强/ ,/ 但/ 根据/ 文献/ [/ 7/ ]/ 的/ 研究/ ,/ 如果/ eCK/ 模型/ 中/ 使用/ 匹配/ 会话/ 定义/ 伙伴关系/ ,/ 则/ 该/ 模型/ 可/ 提供/ 目前/ 最强/ 的/ 关于/ 双方/ 密钥/ 协商/ 协议/ 的/ 安全/ 定义/ ./ 另外/ ,/ Huang/ 等/ 人/ [/ 11/ ]/ 也/ 发现/ 一些/ 在/ CK/ 模型/ 下/ 得到/ 证明/ 的/ 协议/ 并/ 不/ 允许/ 敌手/ 获得/ 充分/ 的/ 会/ 话/ 信息/ ./ 2.3/ 补充/ 安全/ 属性/ 为了/ 便于/ 读者/ 理解/ 稍后/ 的/ 内容/ ,/ 本/ 小节/ 补充/ 以下/ 4/ 个/ 安全/ 属性/ ./ (/ 1/ )/ 已知/ 密钥/ 安全/ (/ knownkeysecrecy/ )/ ./ 当/ 协议/ 的/ 两个/ 参与者/ 协商/ 得到/ 的/ 会/ 话/ 密钥/ 泄露/ 后/ ,/ 该会/ 话/ 密钥/ 的/ 泄露/ 不会/ 影响/ 其它/ 会话/ 密钥/ 的/ 安全/ ./ 已知/ 密钥/ 安全/ 可/ 分为/ 前向/ 已知/ 密钥/ 安全/ (/ forwardknownkeysecrecy/ )/ 和/ 后/ 向/ 已知/ 密钥/ 安全/ (/ back/ -/ wardknownkeysecrecy/ )/ ./ (/ 2/ )/ 抗/ 未知/ 密钥/ 共享/ 攻击/ (/ unknownkeyshareattack/ )/ ./ 协议/ 抗/ 未知/ 密钥/ 共享/ 攻击/ ,/ 是/ 指/ 协议/ 参与者/ A/ 不会/ 在/ 不/ 知道/ 对方/ 身份/ 的/ 情况/ 下/ ,/ 与/ 某个/ 参与者/ B/ 协商/ 获得/ 一个/ 共享/ 的/ 会/ 话/ 密钥/ ./ 也就是说/ ,/ 当/ A/ 和/ B/ 之间/ 协商/ 获得/ 一个/ 会话/ 密钥/ 后/ ,/ 双方/ 都/ 不会/ 错误/ 地/ 认为/ 该/ 密钥/ 是/ 和/ 另外/ 某个/ 参与者/ 共享/ 的/ ./ 成功/ 的/ 未知/ 密钥/ 共享/ 攻击/ 的/ 后果/ 是/ 严重/ 的/ :/ 攻击/ 成功/ 后/ ,/ 敌手/ 可以/ 让/ B/ 相信/ A/ 发给/ B/ 的/ 用会话/ 密钥/ 加密/ 的/ 消息/ 是/ 由/ 敌手/ 自己/ 发给/ B/ 的/ ./ 若/ 在/ 安全/ 模型/ 中/ ,/ 攻击者/ 还/ 可以/ 由此/ 得到/ B/ 生成/ 的/ 会/ 话/ 密钥/ ,/ 冒充/ B/ 与/ A/ 通信/ ./ 该/ 攻击/ 曾/ 导致/ 美国国家安全局/ (/ NationalSe/ -/ curityAgency/ ,/ NSA/ )/ 设计/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ KEA/ [/ 12/ ]/ 在/ 8/ 年/ 后/ 被/ 攻破/ [/ 8/ ]/ ./ (/ 3/ )/ 密钥/ 确认/ (/ keyconfirmation/ )/ ./ 若/ 一个/ 协议/ 的/ 参与者/ 可以/ 确认/ 它/ 的/ 伙伴/ 已经/ 与其/ 建立/ 了/ 相同/ 的/ 会/ 话/ 密钥/ ,/ 则/ 称/ 该/ 协议/ 具有/ 密钥/ 确认/ 属性/ ./ (/ 4/ )/ 抗/ 密钥/ 复制/ 攻击/ (/ keyreplicationattack/ )/ ./ 如果/ 敌手/ M/ 可以/ 使得/ 两个/ 非/ 匹配/ 的/ 会/ 话/ 计算/ 出/ 相同/ 的/ 会/ 话/ 密钥/ ,/ 然后/ 通过/ 另/ 一会/ 话/ 密钥/ 查询/ 得到/ 此次/ 会话/ 密钥/ 的/ 值/ ,/ 则/ 称/ 协议/ 不/ 具有/ 抗/ 密钥/ 复制/ 攻击/ 的/ 属性/ ./ 3/ 双方/ 认证/ 密钥/ 协商/ 协议/ 本/ 节/ 我们/ 提出/ 新/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ 的/ 两个/ 版本/ ,/ 分别/ 命名/ 为/ SAKA/ 和/ SAKA/ -/ C/ ,/ 其中/ SA/ -/ KA/ -/ C/ 除了/ 具备/ SAKA/ 的/ 属性/ 外/ ,/ 还/ 具备/ 密钥/ 确认/ 的/ 特点/ ./ 3.1/ 符号/ 说明/ q/ (/ p/ -/ 1/ )/ ;/ 以下/ 的/ 符号/ 适用/ 于/ 全文/ ./ IDA/ ,/ IDB/ :/ 参与者/ A/ 和/ B/ 的/ 身份/ 标识/ ;/ p/ ,/ q/ :/ 满足/ RSA/ 安全/ 要求/ 的/ 两个/ 大/ 素数/ ,/ 其中/ g/ :/ 以/ q/ 为/ 阶/ 的/ 群/ G/ 的/ 生成元/ ;/ H1/ :/ {/ 0/ ,/ 1/ }/ / →/ Z/ / 藏/ 参与者/ 的/ 长期/ 私钥/ 和/ 临时/ 私钥/ ;/ H/ :/ {/ 0/ ,/ 1/ }/ / →/ {/ 0/ ,/ 1/ }/ λ/ :/ 理想/ 的/ Hash/ 函数/ ,/ 其中/ ,/ λ/ 为/ 安全/ 参数/ ;/ SK/ :/ A/ 和/ B/ 协商/ 获得/ 的/ 会/ 话/ 密钥/ ./ 3.2/ 不带/ 密钥/ 确认/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ (/ SAKA/ )/ 如图/ 1/ 所示/ ,/ 新/ 协议/ SAKA/ 中/ 的/ 两个/ 参与者/ A/ 和/ B/ 将/ 依次/ 执行/ ./ AaA/ -/ =/ gamodpBbB/ -/ =/ gbmodpK/ =/ RKBAmodp/ (/ RB/ ,/ sB/ )/ SK/ =/ H/ (/ K/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ SK/ =/ H/ (/ K/ ,/ sB/ ,/ sA/ ,/ IDB/ ,/ IDA/ )/ 1/ ./ A/ 随机/ 选取/ a/ ∈/ Z/ / q/ 作为/ 自己/ 的/ 长期/ 私钥/ ,/ 计算/ 珡/ A/ =/ gamodp/ 作为/ 其/ 长期/ 公钥/ ,/ 并/ 公布/ (/ 珡/ A/ ,/ IDA/ )/ ;/ 同理/ ,/ B/ 随机/ 选取/ b/ ∈/ Z/ / q/ 作为/ 自己/ 的/ 长期/ 私钥/ ,/ 计算/ 珚/ B/ =/ gbmodp/ 作为/ 其/ 长期/ 公钥/ ,/ 并/ 公布/ (/ 珚/ B/ ,/ IDB/ )/ ;/ 2/ ./ A/ 随机/ 选取/ x/ ~/ ∈/ Z/ / q/ 作为/ 自己/ 的/ 临时/ 私钥/ ,/ 并/ 计算/ x/ =/ H1/ (/ a/ ,/ x/ ~/ )/ ,/ KA/ =/ (/ 珚/ B/ )/ xmodp/ ,/ sA/ =/ x/ // (/ KA/ +/ a/ )/ modq/ ,/ RA/ =/ gKAmodp/ ,/ 将/ (/ RA/ ,/ sA/ )/ 发送给/ B/ ;/ 3/ ./ 收到/ (/ RA/ ,/ sA/ )/ 后/ ,/ B/ 计算/ KA/ =/ (/ RA/ 珡/ A/ )/ bsAmodp/ 并/ 验证/ 等式/ RA/ =/ gKAmodp/ 是否/ 成立/ ./ 若/ 成立/ ,/ 则/ B/ 随机/ 选取/ 珘/ y/ ∈/ Z/ / q/ 作为/ 自己/ 的/ 临时/ 私钥/ ,/ 并/ 计算/ y/ =/ H1/ (/ b/ ,/ 珘/ y/ )/ ,/ KB/ =/ (/ 珡/ A/ )/ ymodp/ ,/ sB/ =/ y/ // (/ KB/ +/ b/ )/ modq/ ,/ RB/ =/ gKBmodp/ ./ 计算/ K/ =/ RKABmodp/ 及/ SK/ =/ H/ (/ K/ ,/ sB/ ,/ sA/ ,/ IDB/ ,/ IDA/ )/ ,/ 将/ (/ RB/ ,/ sB/ )/ 发送给/ A/ ;/ 4/ ./ 收到/ (/ RB/ ,/ sB/ )/ 后/ ,/ A/ 计算/ KB/ =/ (/ RB/ 珚/ B/ )/ asBmodp/ 并/ 验证/ 等式/ RB/ =/ gKBmodp/ 是否/ 成立/ ./ 若/ 成立/ ,/ 计算/ K/ =/ RKB/ 以及/ SK/ =/ H/ (/ K/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ ./ 至此/ ,/ A/ 和/ B/ 建立/ 了/ 会/ 话/ 密钥/ SK/ ./ 3.3/ 协议/ 的/ 安全/ 属性/ 新/ 协议/ 可以/ 抵抗/ 未知/ 密钥/ 共享/ 攻击/ 、/ 重/ 放/ 攻击/ 和/ 冒充/ 攻击/ ,/ 还/ 具有/ 弱/ 的/ 完全/ 前向/ 安全性/ ,/ 本/ 小节/ 将/ 详细分析/ SAKA/ 协议/ 的/ 这些/ 安全/ 属性/ ./ 3.3/ ./ 1/ 抵抗/ 未知/ 密钥/ 共享/ 攻击/ 如果/ SAKA/ 协议/ 的/ 会/ 话/ 密钥/ 没有/ 包含/ A/ ,/ B/ 双方/ 的/ 身份/ 信息/ (/ IDA/ 和/ IDB/ )/ ,/ 将会/ 导致/ 如下/ 的/ 未知/ Page5/ 密钥/ 共享/ (/ UKS/ )/ 攻击/ ./ 假设/ 敌手/ M/ 将/ A/ 的/ 长期/ 公钥/ 注册/ 为/ 自己/ 的/ 公钥/ (/ 这种/ 情况/ 是/ 完全/ 可能/ 的/ ,/ 因为/ CA/ 并/ 不/ 验证/ 公钥图/ 2/ 对/ 不/ 含/ 身份/ 信息/ 的/ SAKA/ 协议/ 的/ 未知/ 密钥/ 共享/ 攻击/ 3.3/ ./ 3/ 抵抗/ 冒充/ 攻击/ 1/ ./ 当/ A/ 发起/ 与/ B/ 的/ 会/ 话/ Session1/ 时/ ,/ M/ 同时/ 发起/ 与/ B/ 的/ 会/ 话/ Session2/ ,/ 并/ 将/ 在/ Session1/ 中/ 截获/ 的/ (/ RA/ ,/ sA/ )/ 发送给/ B/ ;/ 2/ ./ 这时/ B/ 同时/ 参与/ 两个/ 会话/ :/ B/ 选取/ 珘/ y/ ∈/ Z/ / q/ 作为/ Session2/ 的/ 临时/ 私钥/ ,/ 并/ 将/ 计算/ 得到/ 的/ (/ RB/ ,/ sB/ )/ 发给/ M/ ;/ 同时/ ,/ 选取/ 珘/ y/ ∈/ Z/ / q/ 作为/ Session1/ 的/ 临时/ 私钥/ ,/ 并/ 将/ 计算/ 得到/ 的/ (/ RB/ ,/ sB/ )/ 发给/ A/ (/ 计算/ 过程/ 同/ SAKA/ 协议/ ,/ 不再/ 赘述/ )/ ;/ 3/ ./ M/ 截获/ (/ RB/ ,/ sB/ )/ ,/ 并/ 将/ (/ RB/ ,/ sB/ )/ 发送给/ A/ ./ 这时/ ,/ Session1/ 中/ 的/ A/ 与/ Session2/ 中/ 的/ B/ 计算/ 得到/ 相同/ 的/ 会/ 话/ 密钥/ SK/ ./ 显然/ 的/ ,/ Session1/ 中/ 的/ A/ 认为/ 其/ 与/ B/ 建立/ 了/ 相同/ 的/ 会/ 话/ 密钥/ ;/ 而/ Session2/ 中/ 的/ B/ 认为/ 与/ M/ 建立/ 了/ 相同/ 的/ 会/ 话/ 密钥/ ./ 在/ 后续/ 的/ 通信/ 中/ ,/ M/ 可以/ 截获/ Session1/ 中/ A/ 利用/ SK/ 加密/ 的/ 消息/ ,/ 在/ Session2/ 中/ 发给/ B/ ,/ 由于/ B/ 拥有/ 相同/ 的/ SK/ ,/ 可/ 顺利/ 解密/ 该/ 消息/ 并/ 认为/ 该/ 消息/ 是/ M/ 发出/ 的/ ./ 另外/ ,/ 在/ eCK/ 模型/ 中/ ,/ M/ 可/ 对/ Session2/ 进行/ Session/ _/ Key/ _/ Reveal/ 查询/ 获得/ SK/ ,/ 并/ 宣布/ Session1/ 为/ Test/ 会话/ ,/ 从而/ 轻松/ 赢得/ 安全/ 模型/ 中/ 的/ 游戏/ ./ 一个/ 可能/ 的/ 补救/ 方法/ 是/ CA/ 验证/ 参与者/ 公钥/ 与/ 身份/ 的/ 绑定/ 情况/ ,/ 禁止/ 两个/ 参与者/ 拥有/ 相同/ 的/ 公钥/ ./ 但/ 有/ 学者/ 已经/ 指出/ 这样/ 的/ 方法/ 是/ 行不通/ 的/ ,/ 读者/ 可/ 参见/ 文献/ [/ 8/ ]/ ./ 话/ 密钥/ 中/ ,/ 从而/ 避免/ 了/ 未知/ 密钥/ 共享/ 攻击/ ./ 3.3/ ./ 2/ 抵抗/ 重/ 放/ 攻击/ 所谓/ 重/ 放/ 攻击/ ,/ 是/ 指/ 攻击者/ 利用/ 已经/ 截获/ 的/ 公开/ 会话/ 信息/ 来/ 获取/ 新/ 的/ 会/ 话/ 的/ 秘密/ 信息/ 的/ 行为/ ./ 在/ SAKA/ 协议/ 中/ ,/ 参与者/ A/ 和/ B/ 在/ 每次/ 会话/ 中/ 需要/ 选择/ 新/ 的/ x/ ~/ ∈/ Z/ / 并/ 利用/ x/ ~/ 和/ 珘/ y/ 计算/ 新鲜/ 的/ (/ RA/ ,/ sA/ )/ 和/ (/ RB/ ,/ sB/ )/ ./ 由于/ 每次/ 会话/ 生成/ 会话/ 密钥/ 的/ 信息/ 都/ 是/ 不同/ 的/ ,/ 因此/ 有效/ 地/ 避免/ 了/ 重放/ 攻击/ ./ SAKA/ 协议/ 将/ 身份/ 信息/ (/ IDA/ 和/ IDB/ )/ 添加/ 到会示/ 的/ 步骤/ ,/ M/ 可/ 成功/ 地使/ B/ 相信/ A/ 通过/ 会话/ 密钥/ SK/ 加密/ 的/ 消息/ 是/ M/ 发给/ B/ 的/ ./ / / / / / / / / / / / / / / / / / / / / / / MA/ -/ BB/ -/ / ③/ (/ RA/ ,/ sA/ )/ / / ④/ (/ RB/ ,/ sB/ )/ / / / / / / / / / / / / / / / / / 由于/ K/ =/ RKBBmodp/ (/ RKB/ 过/ RKA/ 节/ ./ 这时/ 攻击者/ 可/ 冒充/ 一方/ (/ 如/ B/ )/ 身份/ 发送/ 不/ 合法/ 的/ s/ 值/ (/ 如/ sB/ )/ 给/ 对方/ ,/ 从而/ 导致/ 协商/ 成功/ ./ 在/ SAKA/ 协议/ 中/ ,/ 会话/ 密钥/ 中/ 添加/ 了/ 当前/ 会话/ 的/ 随机/ 值/ sA/ 和/ sB/ ,/ 保证/ 了/ 敌手/ 不/ 可能/ 冒充/ 参与者/ 随意/ 发送/ 非法/ 的/ s/ 值/ ./ 3.3/ ./ 4/ 弱/ 的/ 完美/ 前向/ 安全性/ 在/ SAKA/ 协议/ 中/ ,/ 会话/ 密钥/ 并/ 不/ 完全/ 由/ 参与者/ 双方/ 的/ 长期/ 公私/ 钥/ 协商/ 得到/ ,/ 而是/ 包含/ 了/ 当前/ 会话/ 的/ 临时/ 私钥/ ,/ 因此/ 新/ 协议/ 具有/ 弱/ 的/ 完美/ 前向/ 安全性/ :/ 如果/ 长期/ 私钥/ 泄露/ 前/ 的/ 会/ 话/ 没有/ 被/ 敌手/ 破坏/ ,/ 即使/ 参与者/ 的/ 长期/ 私钥/ 被/ 敌手/ 获得/ ,/ 敌手/ 也/ 无法/ 获得/ 这类/ 会/ 话/ 的/ 会/ 话/ 密钥/ ./ Krawczyk/ [/ 9/ ]/ 指出/ ,/ 所有/ 两轮/ 的/ 基于/ 公钥/ 密码/ 体制/ 的/ 密钥/ 协商/ 协议/ 都/ 无法/ 实现/ 完美/ 前向/ 安全性/ (/ PFS/ )/ ,/ 也/ 无法/ 实现/ 密钥/ 确认/ ./ 为了/ 弥补/ 两轮/ 协议/ 的/ 先天不足/ ,/ 本文/ 在/ 下节/ 提出/ 带有/ 密钥/ 确认/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ ./ 3.4/ 带/ 密钥/ 确认/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ (/ SAKA/ -/ C/ )/ 在/ 很多/ 应用/ 中/ ,/ 缺少/ 密钥/ 确认/ 将/ 可能/ 导致/ 某种/ 形式/ 的/ DoS/ 攻击/ (/ DenialofService/ ,/ 拒绝服务/ )/ ./ 假如/ 在/ 密钥/ 协商/ 过程/ 中/ ,/ A/ 得到/ 了/ 正确/ 的/ 会/ 话/ 密钥/ SK/ ,/ 而/ B/ 由于/ 敌手/ 攻击/ 得到/ 了/ 错误/ 的/ 值/ SK/ ./ 当/ A/ 用/ SK/ 加密/ 后续/ 消息/ 时/ ,/ B/ 无法/ 解密/ ,/ 这/ 可能/ 导致/ A/ 重复/ 发送/ 加密/ 消息/ 以便/ 得到/ 正确/ 反馈/ ,/ 从而/ 消耗/ 了/ 网络资源/ ,/ 严重/ 时/ 可能/ 造成/ 网络/ 堵塞/ ./ SAKA/ -/ C/ 协议/ 用/ 添加/ 消息/ 认证码/ (/ MessageAuthenticationCode/ ,/ MAC/ )/ 的/ 方式/ 来/ 实现/ 密钥/ 确认/ ,/ 而/ 这/ 一/ 性质/ 也/ 确保/ 了/ 协议/ 的/ 完美/ 前向/ 安全性/ ,/ 协议/ 的/ 细节/ 如图/ 3/ 所示/ ./ 其中/ ,/ e/ =/ (/ 1/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ ,/ e/ =/ (/ 0/ ,/ sB/ ,/ sA/ ,/ IDB/ ,/ IDA/ )/ ./ Page6/ 图/ 3SAKA/ -/ C/ 协议/ 4/ 讨论/ 4.1/ 节中/ ,/ 我们/ 在/ eCK/ 模型/ 下/ 证明/ SAKA/ 协议/ 的/ 安全性/ ./ SAKA/ -/ C/ 协议/ 的/ 基本/ 安全/ 属性/ 可以/ 用/ 相同/ 的/ 方法/ 得到/ 证明/ ./ 不同之处/ 在于/ 它/ 的/ 安全性/ 还要/ 基于/ MAC/ 的/ 安全性/ 假设/ ./ 限于/ 篇幅/ ,/ 我们/ 这里/ 只/ 给出/ SAKA/ 协议/ 的/ 详细/ 证明/ 过程/ ./ 4.2/ 节中/ ,/ 给出/ 几个/ 基于/ 公钥/ 基础设施/ (/ PKI/ -/ based/ )/ 的/ 协议/ 在/ 计算/ 量/ 、/ 安全/ 模型/ 和/ 困难性/ 假设/ 等/ 方面/ 的/ 比较/ ./ 4.1/ SAKA/ 的/ 安全性/ 分析/ 定理/ 1/ ./ 如果/ H/ :/ {/ 0/ ,/ 1/ }/ / →/ {/ 0/ ,/ 1/ }/ λ/ 为/ 随机/ 预言/ 机/ ,/ CDH/ 假设/ 对于/ 群/ G/ 成立/ ,/ 则/ SAKA/ 在/ eCK/ 模型/ 下/ 是/ 安全/ 的/ ./ 进一步/ 说/ ,/ 如果/ 敌手/ M/ 在/ 多项式/ 时间/ 内/ ,/ 通过/ 查询/ 至多/ n/ 个/ 参与者/ 和/ 至多/ k/ 次会/ 话/ 以/ 优势/ AdvAKAS/ ,/ 可以/ 在/ 多项式/ 时间/ 内以/ 优势/ AdvAKACDH/ 问题/ ,/ 且/ / (/ S/ )/ / 1AdvAKA/ 证明/ ./ 注意/ 到/ H/ 为/ 随机/ 预言/ 机/ ,/ SK/ =/ H/ (/ K/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ ./ 如果/ 敌手/ M/ 在/ 多项式/ 时间/ 内以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 游戏/ ,/ 那么/ M/ 只/ 可能/ 利用/ 以下/ 两种/ 可能/ 的/ 攻击/ 区分/ 真实/ 的/ 会/ 话/ 密钥/ 和/ 随机/ 值/ :/ 情形/ 1/ ./ 密钥/ 复制/ 攻击/ (/ keyreplicationat/ -/ tack/ )/ ./ M/ 迫使/ 参与者/ 成功/ 发起/ 另外/ 一次/ 会话/ t/ ,/ 并/ 建立/ 了/ 与/ Test/ 会话/ 相同/ 的/ 会/ 话/ 密钥/ SK/ ./ 这时/ ,/ M/ 通过/ Session/ _/ Key/ _/ Reveal/ 查询/ 得到/ 会话/ t/ 的/ 会/ 话/ 密钥/ ,/ 从而/ 获得/ Test/ 会话/ 的/ 会/ 话/ 密钥/ ;/ 情形/ 2/ ./ 伪造/ 攻击/ (/ forgingattack/ )/ ./ M/ 在/ 某/ 时刻/ 成功/ 计算/ 出/ K/ ,/ 从而/ 通过/ H/ 查询/ 得到/ 了/ SK/ ./ 关于/ 情形/ 1/ ./ 根据/ 假设/ ,/ H/ 为/ 随机/ 预言/ 机/ ,/ 而且/ 每次/ 会话/ 参与者/ 选取/ 的/ 临时/ 私钥/ 是/ 不同/ 的/ ,/ 由于/ eCK/ 模型/ 不/ 允许/ 对/ 一个/ 参与者/ 同时/ 进行/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ ,/ 因此/ 两个/ 会/ →/ K/ =/ RKBSK/ =/ H/ (/ K/ ,/ sB/ ,/ sA/ ,/ IDB/ ,/ IDA/ )/ →/ 话/ 拥有/ 相同/ 的/ 参与者/ 并且/ 有/ 相同/ 的/ 临时/ 私钥/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ,/ 即/ 情形/ 1/ 提到/ 的/ 密钥/ 复制/ 攻击/ 是/ 不/ 可能/ 的/ ./ 关于/ 情形/ 2/ ./ 下面/ 重点/ 分析/ 伪造/ 攻击/ ./ 我们/ 将会/ 证明/ ,/ 如果/ 敌手/ M/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 游戏/ ,/ 则/ 可/ 构造/ 一个/ 模拟器/ S/ (/ Solver/ )/ ,/ 它/ 可/ 利用/ M/ 以/ 不可/ 忽略/ 的/ 概率/ 解决/ CDH/ 问题/ ./ 给定/ S/ 的/ 挑战/ (/ U/ ,/ V/ )/ ,/ S/ 将/ 与/ M/ 按照/ SAKA/ 协议/ 流程/ 执行/ 查询/ ,/ 并/ 适当/ 修改/ 诚实/ 的/ 参与者/ 返回/ 的/ 数据/ ,/ 以期/ 在/ M/ 赢得/ 游戏/ 后/ S/ 可以/ 解决/ CDH/ 问题/ ./ 为了/ 便于/ 讨论/ ,/ 情形/ 2/ 可/ 分为/ 以下/ 两种/ 情况/ :/ 情形/ 2.1/ ./ Test/ 会话/ 存在/ 匹配/ 会话/ ,/ 由/ 某个/ 诚/ 情形/ 2.2/ ./ 所有/ 的/ 诚实/ 参与者/ 都/ 不/ 拥有/ Test/ 会/ 请/ 注意/ ,/ 这/ 两种/ 情况/ 中/ 至少/ 有/ 一种/ 发生/ 的/ 概率/ 实/ 的/ 参与者/ 拥有/ ;/ 话/ 的/ 匹配/ 会话/ ./ / 1/ // 2/ ./ 关于/ 情形/ 2.1/ ./ 首先/ ,/ S/ 随机/ 选取/ 由/ 某/ 两个/ 参与者/ A/ 和/ B/ 参与/ 的/ 匹配/ 会话/ (/ 选择/ 过程/ 为/ :/ 随机/ 选择/ 两个/ 会话/ ,/ 然后/ 验证/ 它们/ 是否/ 互为/ 匹配/ 会话/ ./ 由于/ S/ 最多/ 可/ 选取/ k/ 次会话/ ,/ 故/ 本次/ 选择/ 的/ 概率/ 为/ 2/ // k2/ )/ ,/ S/ 将/ 这/ 两个/ 会话/ 中/ 的/ RA/ 用/ U/ 代替/ ,/ RB/ 用/ V/ 代替/ ./ 攻击/ 开始/ 后/ ,/ M/ 以/ 1/ // k2/ 的/ 概率/ 选中/ 上述/ 会话/ 中/ 的/ 某个/ 作为/ Test/ 会话/ ./ 显然/ ,/ 此时/ 剩余/ 的/ 那个/ 会话/ 成为/ Test/ 会话/ 的/ 匹配/ 会话/ ./ 在/ 此/ 情况/ 下/ ,/ 若/ M/ 成功/ 地/ 进行/ 了/ 伪造/ 攻击/ ,/ S/ 一定/ 能/ 解决/ CDH/ 问题/ ./ 事实上/ ,/ SK/ =/ H/ (/ K/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ ,/ 若/ M/ 获得/ 了/ SK/ ,/ 它/ 一定/ 可以/ 计算/ 出/ K/ 并/ 通过/ 进行/ H/ 查询/ 得到/ SK/ ./ 根据/ 之前/ 的/ 假设/ ,/ K/ =/ CDH/ (/ U/ ,/ V/ )/ ./ 因此/ ,/ 若/ M/ 成功/ 地/ 进行/ 了/ 伪造/ 攻击/ ,/ S/ 一定/ 能/ 解决/ CDH/ 问题/ ./ 由于/ eCK/ 模型/ 不/ 允许/ 敌手/ 在/ Test/ 会话/ 中/ 的/ 某个/ 参与者/ 同时/ 进行/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Page7Ephemeral/ _/ Key/ _/ Reveal/ 查询/ ,/ 因而/ 敌手/ 查询/ (/ a/ ,/ x/ ~/ )/ 或/ (/ b/ ,/ 珘/ y/ )/ 的/ 概率/ 可以/ 忽略不计/ ./ H/ 发生/ 碰撞/ 的/ 概率/ O/ (/ k2/ // 2/ λ/ )/ 由于/ 对/ H/ 的/ 假设/ 也/ 可/ 忽略/ ./ 因此/ ,/ S/ 与/ M/ 的/ 优势/ 有/ 如下/ 关系/ :/ 关于/ 情形/ 2.2/ ./ S/ 随机/ 选择/ 一个/ 参与者/ B/ ./ 在/ 情形/ 2.2/ 中/ ,/ 我们/ 假设/ S/ 不/ 知道/ B/ 的/ 长期/ 私钥/ b/ ,/ 从而/ 无法/ 获得/ B/ 的/ 长期/ 公钥/ ./ 为了/ 在/ 多项式/ 时间/ 内/ 解决/ CDH/ 问题/ ,/ S/ 将/ 对/ B/ 发起/ 的/ 与/ 参与者/ C/ (/ C/ 已经/ 完全/ 被/ 敌手/ M/ 控制/ )/ 的/ 会/ 话/ 进行/ 如下/ 处理/ ./ 首先/ ,/ S/ 随机/ 选取/ 珘/ y/ ∈/ Zq/ 作为/ B/ 的/ 临时/ 私钥/ ,/ 并/ 计算/ KB/ =/ 珚/ Cymodp/ ,/ 随机/ 选取/ h/ ,/ 令/ sB/ =/ h/ ,/ 计算/ U/ =/ RB/ =/ gKBmodp/ ,/ 并/ 将/ SK/ 置/ 为/ 随机/ 值/ ./ 值得注意/ 的/ 是/ ,/ 这种/ 情况/ 下/ ,/ 模型/ 允许/ S/ 获得/ 或者/ 计算/ 参与者/ B/ 的/ 会/ 话/ 密钥/ 和/ 临时/ 密钥/ ./ 由于/ 参与者/ C/ 被/ 敌手/ 控制/ ,/ M/ 可以/ 进行/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ 获得/ C/ 的/ 长期/ 密钥/ 和/ 临时/ 密钥/ ,/ 因而/ M/ 可以/ 计算/ KB/ =/ (/ U/ 珚/ B/ )/ chmodp/ ,/ 通过/ 验证/ ,/ M/ 会/ 发现/ 此值/ 不真/ ./ 但/ M/ 仍然/ 可以/ 通过/ 计算/ KC/ =/ 珚/ Bzmodp/ ,/ sC/ =/ z/ // (/ KC/ +/ c/ )/ modq/ 和/ RC/ =/ gKCmodp/ 获得/ K/ =/ Cmodp/ ./ 这时/ ,/ S/ 检查/ M/ 是否/ 进行/ 了/ H/ 查询/ ,/ 若/ RKBM/ 进行/ 了/ H/ 查询/ ,/ 且/ DDH/ (/ U/ ,/ RC/ ,/ RKB/ 向/ M/ 返回/ SK/ =/ H/ (/ K/ ,/ sB/ ,/ sC/ ,/ B/ ,/ C/ )/ ./ 然后/ ,/ S/ 随机/ 选取/ 一个/ 会话/ s/ ,/ 该会/ 话/ 中/ B/ 为/ 应答/ 者/ ./ 设此会/ 话/ 的/ 发起者/ 为/ A/ ,/ 当/ A/ 发起/ 与/ B/ 的/ 会/ 话/ 后/ ,/ S/ 按照/ 协议/ 流程/ 处理/ 此会话/ ,/ 同时/ 令/ V/ =/ RA/ ./ 这时/ ,/ M/ 会以/ 1/ // nk/ 的/ 概率/ 选中/ s/ 作为/ Test/ 会话/ (/ 以/ 1/ // n/ 的/ 概率/ 选中/ B/ ,/ 以/ 1/ // k/ 的/ 概率/ 选中/ 会话/ s/ )/ ./ 如果/ M/ 赢得/ 了/ 游戏/ ,/ 则/ M/ 一定/ 对/ 五元/ 组/ (/ CDH/ (/ U/ ,/ V/ )/ ,/ sA/ ,/ sB/ ,/ IDA/ ,/ IDB/ )/ 进行/ 了/ H/ 查询/ ,/ 从而/ S/ 查阅/ 该/ 五元/ 组/ ,/ 即可/ 解决/ CDH/ 问题/ ./ 需要/ 说明/ 的/ 是/ ,/ eCK/ 模型/ 只是/ 不/ 允许/ 对/ Test/ 会话/ 中/ 的/ 某/ 一个/ 参与者/ 同时/ 进行/ Long/ -/ term/ _/ Key/ _/ Reveal/ 查询/ 和/ Ephemeral/ _/ Key/ _/ Reveal/ 查询/ ,/ 而/ 对/ 其它/ 实验/ 会话/ 没有/ 这个/ 限制/ ./ 在/ 情形/ 2.2/ 中/ ,/ S/ 与/ M/ 的/ 优势/ 有/ 如下/ 关系/ :/ 综合/ 式/ (/ 1/ )/ 、/ (/ 2/ )/ ,/ 对于/ 情形/ 2/ ,/ 有/ 如下/ 公式/ 成立/ :/ / (/ S/ )/ / 1AdvAKA4/ ./ 2/ 性能/ 分析/ 据/ 我们/ 所知/ ,/ 目前/ 基于/ eCK/ 模型/ 的/ 两轮/ 双方/ 认证/ 密钥/ 协商/ 协议/ 并不多/ ./ 本节/ 我们/ 挑选/ 几个/ 相似/ 方案/ 在/ 计算/ 量/ 和/ 安全性/ 假设/ 方面/ 进行/ 比较/ ./ 为了/ 简便/ ,/ 在/ 计算/ 量/ 方面/ 仅/ 比较/ 这/ 几个/ 方案/ 中/ 最/ 耗时/ 的/ 模/ 指数/ 运算/ 的/ 次数/ ./ 表/ 1/ 中/ TEXP/ 表示/ 一次/ 模/ 指数/ 运算/ 的/ 时间/ ./ Okamato/ 协议/ [/ 13/ ]/ 从表/ 1/ 可以/ 看出/ ,/ 与/ Okamato/ 协议/ [/ 13/ ]/ 相比/ ,/ SAKA/ 有/ 明显/ 的/ 计算/ 量/ 优势/ ;/ 与/ NAXOS/ [/ 6/ ]/ 和/ CMQV/ [/ 14/ ]/ 相比/ ,/ SAKA/ 需要/ 较/ 多/ 的/ 模/ 指数/ 运算/ ,/ 但/ NAXOS/ 和/ CMQV/ 均/ 基于/ GDH/ 问题/ ,/ 而/ 我们/ 的/ 协议/ 基于/ CDH/ 问题/ ./ 众所周知/ ,/ CDH/ 假设/ 比/ GDH/ 假设/ 更加/ 标准/ ,/ 因此/ ,/ SAKA/ 在/ 安全性/ 假设/ 方面/ 占有优势/ ./ 另外/ ,/ CMQV/ 在/ 证明/ 中/ 需要/ 使用/ 分叉/ 引理/ (/ forkinglemma/ )/ ,/ 这/ 可能/ 导致/ 协议/ 证明/ 的/ 不/ 严谨/ ./ 总之/ ,/ 新/ 协议/ 较/ 好/ 地/ 平衡/ 了/ 计算/ 量/ 和/ 安全性/ 假设/ 两个/ 评价/ 标准/ ./ 5/ 结论/ 与/ 下/ 一步/ 工作/ 本文/ 首先/ 提出/ 了/ 一种/ 新/ 的/ 两轮/ 双方/ 认证/ 密钥/ 协商/ 协议/ ,/ 通过/ 分析/ 新/ 协议/ 的/ 安全/ 属性/ 指出/ 了/ 构造/ 双方/ 认证/ 密钥/ 协商/ 的/ 注意事项/ ;/ 新/ 协议/ 较/ 好/ 地/ 平衡/ 了/ 计算/ 量/ 和/ 安全性/ 假设/ 两个/ 协议/ 评价/ 标准/ ;/ 随后/ 我们/ 在/ eCK/ 模型/ 下/ 证明/ 了/ 协议/ 的/ 安全性/ 基于/ CDH/ 假设/ ./ 根据/ 相关/ 文献/ ,/ eCK/ 模型/ 可/ 提供/ 目前/ 最强/ 的/ 关于/ 双方/ 密钥/ 协商/ 协议/ 的/ 安全/ 定义/ ./ 最后/ ,/ 本文/ 还/ 提出/ 了/ 一种/ 带/ 密钥/ 确认/ 属性/ 的/ 协议/ ,/ 以/ 弥补/ 两轮/ 认证/ 协议/ 无法/ 实现/ 密钥/ 确认/ 的/ 不足/ ./ 我们/ 注意/ 到/ ,/ 新/ 协议/ 在/ 计算/ 量/ 方面/ 的/ 优势/ 并/ 不/ 明显/ ,/ 如何/ 在/ 安全/ 假设/ 和/ 安全/ 目标/ 不变/ 的/ 情况/ 下/ 提出/ 计算/ 量/ 更/ 小/ 的/ 双方/ 认证/ 密钥/ 协商/ 协议/ 是/ 下/ 一步/ 值得/ 研究/ 的/ 问题/ ./ 

