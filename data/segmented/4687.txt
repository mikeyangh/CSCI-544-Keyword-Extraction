Page1/ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ CT/ 序列/ 图像/ 肝脏/ 分割/ 1/ )/ (/ 山东师范大学/ 物理/ 与/ 电子/ 科学/ 学院/ 生命/ 与/ 健康/ 研究院/ 山东省/ 医学/ 物理/ 图像处理/ 技术/ 省级重点/ 实验室/ 济南/ 250014/ )/ 2/ )/ (/ 济南/ 大学/ 信息科学/ 与/ 工程学院/ 济南/ 250022/ )/ 3/ )/ (/ 山东省/ 肿瘤医院/ 放疗/ 科/ 济南/ 250117/ )/ 摘要/ 显式/ 模型/ 下/ 建立/ 的/ 肝脏/ 分割/ 算法/ 受/ 适用/ 条件/ 的/ 限制/ ,/ 不能/ 有效/ 地/ 控制/ 分割/ 进程/ ,/ 制约/ 了/ 算法/ 鲁棒性/ 和/ 泛化/ 能力/ 的/ 提高/ ./ 针对/ 这一/ 问题/ ,/ 该文/ 提出/ 了/ 一个/ 新/ 的/ 方法/ ,/ 将/ 肝脏/ 分割/ 问题/ 转化/ 为/ 隐式/ 函数/ 最优/ 值/ 搜索/ ,/ 依据/ 图像/ 实际/ 数据/ 和/ 先验/ 形状/ 信息/ 有效/ 地/ 控制/ 分割/ 进程/ ,/ 以/ 迭代/ 搜索/ 策略/ 得到/ 肝脏/ 的/ 最优/ 分割/ 结果/ ./ 每/ 一个/ 迭代/ 步骤/ 由/ 两/ 部分/ 组成/ :/ 首先/ ,/ 利用/ MRF/ (/ MarkovRandomField/ )/ 实现/ 已有/ 肝脏/ 轮廓/ 邻域/ 的/ 局部/ 再/ 分割/ ,/ 重新/ 调整/ 肝脏/ 轮廓/ ;/ 然后/ ,/ 利用/ 先验/ 形状/ 稀疏/ 表示/ 调整/ 后/ 的/ 形状/ ,/ 有效/ 地/ 修正/ 噪声/ 、/ 边界/ 模糊/ 等/ 因素/ 引起/ 的/ 错误/ 分割/ ,/ 并/ 将/ 修正/ 后/ 的/ 肝脏/ 轮廓/ 用于/ 下/ 一轮/ 局部/ 再/ 分割/ ./ 肝脏/ 分割/ 结果/ 在/ 迭代/ 过程/ 中/ 不断/ 逼近/ 真实/ 值/ ./ 为了/ 提高/ 形状/ 稀疏/ 表示/ 的/ 计算精度/ 和/ 速度/ ,/ 该文/ 改进/ 了/ 相关/ 技术细节/ ,/ 提出/ 了/ 动态/ 字典/ 生成/ 策略/ ,/ 并/ 利用/ 混合/ 粒子/ 群/ 算法/ 求解/ 稀疏/ 表示/ 方程/ ./ 与/ 金/ 标准/ 相比/ ,/ 该文/ 所提/ 算法/ 在/ 边界/ 模糊/ 、/ 对比度/ 低/ 、/ 存在/ 大量/ 其他/ 干扰/ 组织/ 区域/ 等/ 不利因素/ 的/ 情景/ 中/ ,/ 其/ 分割/ 精度/ (/ VolumeOverlapPercentage/ ,/ VOE/ )/ 可/ 达到/ 90/ %/ 以上/ ./ 关键词/ 肝脏/ 分割/ ;/ 最优/ 值/ 搜索/ ;/ 稀疏/ 表示/ ;/ 马尔可夫/ 随/ 机场/ ;/ 混合/ 粒子/ 群/ 1/ 引言/ 医学/ 图像处理/ 是/ 实现/ 计算机辅助/ 诊疗/ 的/ 基础/ 研究/ 工作/ 之一/ ,/ 肝脏/ 分割/ 是/ 医学/ 图像处理/ 领域/ 的/ 一个/ 重要/ 研究课题/ ./ 例如/ ,/ 在/ 当前/ 临床/ 实施/ 图像/ 引导/ 肿瘤/ 精确/ 放射治疗/ 时/ ,/ 放射线/ 在/ 有效/ “/ 打击/ ”/ 恶性肿瘤/ 靶区/ 的/ 同时/ ,/ 会/ 杀伤/ 肿瘤/ 周围/ 的/ 危及/ 器官/ ,/ 进而/ 可能/ 引发/ 放疗/ 并发症/ ./ 当/ 涉及/ 肺癌/ 、/ 肝癌/ 等/ 胸部/ 、/ 腹部/ 肿瘤/ 的/ 治疗/ 时/ ,/ 肝脏/ 作为/ 人体/ 的/ 一种/ 重要/ 器官/ ,/ 需要/ 被/ 精确/ 识别/ 并/ 统计/ 肝脏/ 的/ 辐射/ 累计/ 量/ ,/ 从而/ 控制/ 人体/ 肝脏/ 的/ 受量/ 在/ 合理/ 范围/ 内/ ,/ 避免/ 损伤/ 正常/ 肝脏/ 组织/ ./ 因此/ ,/ 在/ 临床/ 放疗/ 计划/ 制定/ 时/ ,/ 肝脏/ 组织/ 的/ 精确/ 分割/ 是/ 一个/ 非常/ 重要/ 的/ 工作/ ./ 目前/ ,/ 临床/ 多/ 采用/ 人工/ 手动/ 分割/ 的/ 方式/ 在/ 放疗/ 计划/ CT/ 序列/ 图像/ 中/ 获取/ 肝脏/ 区域/ ,/ 其/ 缺点/ 是/ 耗时/ ,/ 并/ 对/ 相关/ 人员/ 的/ 经验/ 有/ 一定/ 要求/ ./ 因此/ ,/ 研究/ 在/ CT/ 序列/ 图像/ 中/ 的/ 肝脏/ 自动/ 分割/ 技术/ 有利于/ 降低/ 临床/ 医生/ 或/ 放疗/ 物理/ 师/ 的/ 劳动强度/ ,/ 降低/ 因/ 个人/ 主观因素/ 引起/ 的/ 分割/ 误差/ ,/ 从而/ 提高/ 诊断/ 的/ 准确率/ ./ 根据/ 分割/ 模型/ 的/ 建模/ 角度/ 将/ 相关/ 图像/ 分割/ 研究/ 工作/ 分为/ 3/ 类/ 模式/ :/ 全局/ 模式/ 、/ 局部/ 模式/ 和/ 混合/ 模式/ ./ 全局/ 模式/ 是/ 指/ 在/ 全局/ 角度/ 调整/ 分割/ 规则/ 或/ 参数/ 以/ 达到/ 准确/ 分割/ 目标/ 的/ 目的/ ,/ 例如/ 基于/ 阈值/ [/ 1/ ]/ 、/ 边缘/ 检测/ [/ 2/ ]/ 、/ 区域/ 生长/ [/ 3/ ]/ 、/ 高斯/ 混合/ 模型/ [/ 4/ ]/ 等/ 方法/ ./ 全局/ 模式/ 在/ 全局/ 角度/ 制定/ 分割/ 策略/ ,/ 忽略/ 了/ 对/ 局部/ 细节/ 部分/ 的/ 精细/ 处理/ ./ 局部/ 模式/ 是/ 建立/ 图像/ 的/ 局部/ 数据处理/ 模型/ ,/ 实现目标/ 细节/ 的/ 精确/ 分割/ ./ 例如/ Snake/ [/ 5/ ]/ 、/ ASM/ (/ ActiveShapeModel/ )/ [/ 6/ ]/ 、/ AAM/ (/ ActiveAppearanceModel/ )/ [/ 7/ ]/ 等/ 算法/ ./ 局部/ 模式/ 实现/ 了/ 对/ 图像/ 数据/ 的/ 精细/ 处理/ ,/ 也/ 忽略/ 了/ 重要/ 的/ 宏观/ 信息/ ,/ 分割/ 结果/ 易/ 受到/ 干扰/ 因素/ 的/ 影响/ ./ 混合/ 模式/ 融合/ 了/ 全局/ 模式/ 与/ 局部/ 模式/ 的/ 优点/ ,/ 在/ 实现/ 细节/ 精细/ 处理/ 的/ 基础/ 之上/ 结合/ 全局/ 约束/ 信息/ 分割/ 感兴趣/ 的/ 目标/ ./ 例如/ 结合/ 图谱/ 与/ 局部/ 相似性/ 的/ 脑/ MR/ 图像/ 的/ 特定/ 组织/ 分割/ [/ 8/ ]/ 、/ H/ -/ MRF/ (/ HierarchialMarkovRandomField/ )/ 模型/ 实现/ 由/ 局部/ 到/ 全局/ 的/ 分割/ [/ 9/ ]/ 、/ 融合/ 边缘/ 和/ 区域/ 信息/ 的/ 水平/ 集/ 分割/ 方法/ [/ 10/ ]/ 、/ 结合/ 改进/ 水平/ 集/ 和/ 区域/ 生长/ 的/ 分割/ 方法/ [/ 11/ ]/ 等/ ./ 全局/ 模式/ 一般/ 反应/ 了/ 问题/ 的/ 全局/ 特征/ ,/ 对/ 特殊/ 情况/ 不/ 具有/ 针对性/ ;/ 局部/ 模式/ 建立/ 的/ 局部/ 精细/ 处理/ 的/ 模型/ ,/ 未/ 有效/ 利用/ 全局/ 信息/ 的/ 约束/ 作用/ ;/ 混合/ 模式/ 融合/ 了/ 全局/ 模式/ 与/ 局部/ 模式/ 的/ 优点/ ,/ 有助于/ 提高/ 模型/ 泛化/ 能力/ 和/ 特殊/ 区域/ 的/ 分割/ 精度/ ./ 有效/ 的/ 融合/ 方式/ 是/ 实现/ 混合/ 模式/ 的/ 关键/ ./ 肝脏/ 分割/ 是/ 目标/ 分割/ 领域/ 的/ 一个/ 具体/ 研究/ 内容/ ,/ 同时/ 又/ 具有/ 其/ 自身/ 的/ 特殊性/ ./ 目前/ ,/ 针对/ 半自动/ 和/ 全自动/ 的/ 肝脏/ 分割/ 算法/ 已/ 取得/ 了/ 一定/ 的/ 研究成果/ [/ 12/ ]/ ,/ 但/ 肝脏/ 分割/ 研究/ 仍/ 面临/ 一些/ 亟待解决/ 的/ 难题/ ,/ 例如/ :/ (/ 1/ )/ 与/ 肝脏/ 毗邻/ 的/ 组织/ 、/ 器官/ 具有/ 相近/ 的/ 组织/ 密度/ ,/ 使得/ 肝脏/ 边界/ 模糊/ ,/ 如图/ 1/ 所示/ ;/ (/ 2/ )/ 同一个/ 体/ 的/ 肝脏/ 在/ 不同/ 断层/ 图像/ 中/ 的/ 尺寸/ 和/ 形状/ 会/ 发生/ 改变/ ;/ (/ 3/ )/ 不同/ 个体/ 之间/ ,/ 肝脏/ 的/ 形态/ 存在/ 差异/ ;/ (/ 4/ )/ 因/ 成像/ 设备/ 及/ 条件/ 的/ 变化/ 、/ 噪声/ 干扰/ 等/ 因素/ 的/ 影响/ ,/ CT/ 序列/ 图像/ 中/ 肝脏/ 的/ 灰度/ 值会/ 出现/ 波动/ ;/ (/ 5/ )/ 在/ CT/ 序列/ 图像/ 中/ ,/ 肝脏/ 会因/ 呼吸/ 运动/ 而/ 发生/ 位移/ 或/ 变形/ ./ 因此/ ,/ CT/ 序列/ 图像/ 中/ 的/ 肝脏/ 分割/ 是/ 一项/ 重要/ 而/ 复杂/ 的/ 工作/ ./ 图/ 1/ 模糊/ 肝脏/ 边界/ 示例/ (/ 第/ 1/ 幅/ 分别/ 为/ 肝脏/ 与/ 胃/ 之间/ 的/ 模糊/ 边界/ ,/ 第/ 2/ 幅为/ 肝脏/ 与/ 肋间肌/ 、/ 胃/ 之间/ 的/ 模糊/ 边界/ )/ CT/ 序列/ 图像/ 的/ 肝脏/ 分割/ 可以/ 被/ 认为/ 是/ 一种/ 最优/ 值/ 搜索/ 问题/ ,/ 即/ 根据/ 先验/ 信息/ 和/ 图像/ 的/ 真实/ 数据/ 确定/ 肝脏/ 区域/ ./ 但/ 由于/ 实际/ 应用/ 中/ 难以确定/ 绝对/ 精确/ 的/ 分割/ 边界/ (/ GroundTruth/ )/ ,/ 所以/ 肝脏/ 区域/ 的/ 最优/ 值/ 搜索/ 是/ 一个/ NP/ -/ hard/ 问题/ ,/ 我们/ 得到/ 的/ 分割/ 结果/ 是/ 在/ 某种/ 评价/ 准确/ 控制/ 下/ 的/ 相对/ 最优/ 分割/ 结果/ ./ 先验/ 信息/ 具有/ 重要/ 的/ 参考价值/ ,/ 可/ 有效/ 地/ 抑制/ 因/ 肝脏/ 边界/ 模糊/ 、/ 形变/ 、/ 噪声/ 等/ 不利因素/ 引起/ 的/ 分割/ 难度/ 的/ 提高/ ./ 图像/ 的/ 真实/ 数据/ 又/ 体现/ 当前/ 分割/ 目标/ 的/ 自/ Page3/ 身/ 特点/ ./ 正常/ 肝脏/ 在/ 人体/ 中/ 的/ 形态/ 和/ 位置/ 是/ 相对/ 稳定/ 的/ ,/ 肝脏/ 先验/ 形状/ 是/ 宏观/ 修正/ 分割/ 结果/ 的/ 重要依据/ ./ 稀疏/ 表示/ 是/ 目前/ 常用/ 的/ 一种/ 利用/ 先验/ 信息/ 拟合/ 新/ 信息/ 的/ 工具/ ,/ 在/ 移动/ 目标/ 跟踪/ [/ 13/ -/ 14/ ]/ 、/ 人脸识别/ [/ 15/ ]/ 等/ 领域/ 中/ 成功/ 运用/ ./ 肝脏/ 与/ 移动/ 目标/ 、/ 人脸/ 的/ 一个/ 共同/ 特点/ 就是/ 宏观/ 特性/ 保持/ 相对/ 稳定/ ,/ 局部/ 特征/ 会/ 发生/ 改变/ ./ 稀疏/ 表示/ 在/ 肝脏/ 形状/ 修正/ 的/ 任务/ 中/ 表现/ 出/ 良好/ 的/ 性能/ ,/ 例如/ SSC/ (/ SparseShapeComposition/ )/ 模型/ [/ 16/ ]/ ./ 然而/ ,/ 利用/ 稀疏/ 表示/ 在/ 宏观/ 角度/ 修正/ 肝脏/ 形状/ 后/ ,/ 丢弃/ 了/ 统计/ 不/ 明显/ 的/ 局部/ 特征/ ,/ 我们/ 有/ 必要/ 根据/ 图像/ 真实/ 数据/ 进行/ 调整/ 以/ 更新/ 局部/ 分割/ 结果/ ./ MRF/ 是/ 建立/ 图像/ 上下文/ 关联性/ 的/ 一种/ 常用工具/ ,/ 可/ 实现/ 图像/ 的/ 局部/ 精细/ 分割/ ,/ 在/ 医学/ 图像/ 分割/ 中/ 表现/ 出/ 了/ 良好/ 的/ 分割/ 性能/ [/ 17/ -/ 18/ ]/ ./ 基于/ MRF/ 的/ 分割/ 算法/ 的/ 缺点/ 在于/ 忽略/ 了/ 对/ 分割/ 结果/ 的/ 宏观/ 评价/ ./ 因此/ ,/ 有效/ 地/ 结合/ 形状/ 稀疏/ 表示/ 与/ MRF/ 可/ 实现/ 兼顾/ 宏观/ 形状/ 和/ 局部/ 细节/ 的/ 肝脏/ 精确/ 分割/ ./ 本文/ 提出/ 了/ 一种/ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ CT/ 序列/ 图像/ 的/ 肝脏/ 分割/ 方法/ ./ 其/ 核心思想/ 是/ 将/ 肝脏/ 的/ 分割/ 进程/ 等价/ 为/ 隐式/ 函数/ 的/ 最优/ 值/ 搜索/ ,/ 融合/ 不同/ 算法/ 的/ 优势/ ,/ 在/ 迭代/ 步骤/ 中/ 逐步完善/ 肝脏/ 的/ 宏观/ 形状/ 和/ 局部/ 细节/ ./ 肝脏/ 分割/ 结果/ 是/ 框架/ 的/ 优化/ 目标/ ,/ 图像/ 的/ 实际/ 数据/ 是/ 驱动/ 目标/ 改变/ 细节/ 的/ 内力/ ,/ 先验/ 形状/ 信息/ 是/ 约束/ 目标/ 改变/ 的/ 外力/ ./ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ 肝脏/ 分割/ 算法/ 综合/ 考虑/ 了/ 宏观/ 形状/ 特征/ 与/ 实际/ 细节/ 信息/ ,/ 在/ 内力/ 和/ 外力/ 的/ 共同/ 作用/ 下/ ,/ 利用/ 迭代/ 的/ 手段/ 逐步完善/ 分割/ 结果/ ,/ 提高/ 算法/ 的/ 分割/ 精度/ 和/ 泛化/ 能力/ ./ 2/ 最优/ 值/ 搜索/ 框架/ 的/ 建立/ 肝脏/ 分割/ 是/ 在/ 一幅/ 图像/ 中/ 搜索/ 肝脏/ 最优/ 解/ 的/ 过程/ ,/ 类似/ 于/ 求解/ 等式/ ,/ 如/ 公式/ 其中/ ,/ x/ 表示/ 输入/ 图像/ ,/ y/ 表示/ 先验/ 信息/ ,/ f/ 表示/ 映射/ 模型/ ,/ Z/ 表示/ 肝脏/ 分割/ 结果/ ./ 肝脏/ 分割/ 的/ 难点/ 在于/ 很难/ 找到/ 一个/ 合理/ 的/ 映射/ 模型/ ./ 显式/ 映射/ 模型/ 具有/ 局限性/ ,/ 往往/ 针对/ 某种/ 特定/ 情况/ 建立/ ,/ 很难/ 表征/ 出/ 肝脏/ 分割/ 过程/ 中/ 遇到/ 的/ 各种/ 难以预测/ 的/ 情况/ ./ 把/ f/ 定义/ 为/ 隐式/ 模型/ 有利于/ 涵盖/ 多种/ 情况/ ,/ 利用/ 智能/ 计算技术/ ,/ 通过/ 迭代/ 运算/ ,/ 逐步/ 搜索/ 隐式/ 模型/ 的/ 最优/ 值/ ,/ 例如/ 遗传算法/ 、/ 模拟退火/ 算法/ 、/ EM/ 算法/ 等/ ./ 肝脏/ 分割/ 结果/ 是/ 优化/ 目标/ ,/ 把/ 所有/ 形状/ 的/ 集合/ 定义/ 为/ 一个/ 形状/ 空间/ ,/ 迭代/ 步骤/ 中/ 得到/ 的/ 每/ 一种/ 肝脏/ 分割/ 结果/ 的/ 形状/ 是/ 目标/ 在/ 形状/ 空间/ 中/ 停留/ 的/ 一个/ 位置/ ,/ 肝脏/ 形状/ 的/ 改变/ 描述/ 为/ 目标/ 的/ 运动/ ./ 在/ 肝脏/ 分割/ 最优/ 值/ 搜索/ 任务/ 过程/ 中/ ,/ 图像/ 实际/ 数据/ 产生/ 的/ 内力/ 驱动/ 目标/ 在/ 形状/ 空间/ 中/ 不停/ 运动/ ,/ 同时/ 又/ 结合/ 先验/ 信息/ 产生/ 的/ 外力/ 对/ 目标/ 的/ 运动/ 进行/ 有效/ 约束/ ./ 最优/ 值/ 搜索/ 框架/ 由/ 3/ 个/ 部分/ 组成/ :/ (/ 1/ )/ 肝脏/ 区域/ 初始化/ ,/ 为/ 目标/ 的/ 运动/ 设定/ 起始/ 点/ ;/ (/ 2/ )/ 内力/ 驱动/ 目标/ 运动/ ,/ 根据/ 图像/ 真实/ 数据/ 改变/ 当前/ 肝脏/ 分割/ 结果/ ;/ (/ 3/ )/ 外力/ 约束/ 目标/ 运动/ ,/ 利用/ 先验/ 形状/ 信息/ 修正/ 肝脏/ 分割/ 结果/ ./ 肝脏/ 分割/ 的/ 最优/ 值/ 搜索/ 框架/ 设计/ 如下/ :/ (/ 1/ )/ 肝脏/ 区域/ 初始化/ ./ 初始化/ 肝脏/ 区域/ 是/ 为/ 肝脏/ 搜索/ 提供/ 起始/ 出发点/ ,/ 利用/ 了/ 人体/ 骨骼/ 的/ 固定/ 结构特征/ ,/ 以/ 简单/ 、/ 高效/ 的/ 方法/ 得到/ 肝脏/ 的/ 初始化/ 区域/ ,/ 在/ 本文/ 第/ 3/ 节/ 做/ 了/ 详细/ 论述/ ./ (/ 2/ )/ 目标/ 运动/ ./ 在/ 原有/ 的/ 肝脏/ 分割/ 结果/ (/ LO/ )/ 的/ 基础/ 之上/ ,/ 依据/ 图像/ 的/ 真实/ 数据/ ,/ 在/ LO/ 边缘/ 的/ 邻域/ 内/ 重新/ 分割/ 肝脏/ ,/ 在/ 调整/ LO/ 的/ 边缘/ 后/ 得到/ 一个/ 新/ 的/ 肝脏/ 分割/ 结果/ (/ LN/ )/ ./ 与/ LO/ 相比/ ,/ LN/ 的/ 局部/ 边缘/ 会/ 向/ 内/ 或/ 向/ 外/ 运动/ ,/ 目标/ 的/ 位置/ 会/ 发生/ 改变/ ./ 本/ 部分/ 选择/ 了/ MRF/ 随/ 机场/ 作为/ 分割/ 工具/ ,/ 驱动/ 目标/ 运动/ ./ (/ 3/ )/ 目标/ 运动/ 约束/ ./ 依据/ 图像/ 真实/ 数据/ 引导/ 的/ 目标/ 运动/ 易/ 受到/ 噪声/ 区域/ 的/ 干扰/ ,/ 并且/ 不/ 易于/ 处理/ 模糊/ 的/ 边界/ 区域/ ,/ 目标/ 的/ 盲目/ 运动/ 可能/ 会/ 引起/ 肝脏/ 的/ 分割/ 错误/ ,/ 所以/ 利用/ 先验/ 信息/ 对/ 目标/ 的/ 运动/ 进行/ 约束/ ./ 肝脏/ 形状/ 稀疏/ 是/ 目标/ 运动/ 约束/ 的/ 实现/ 工具/ ,/ 将/ 肝脏/ 的/ 分割/ 结果/ 约束/ 在/ 先验/ 形状/ 信息/ 控制/ 范围/ 内/ ./ (/ 4/ )/ 最优/ 值/ 判定/ ./ 最优/ 值/ 判定/ 有/ 两个/ 参考/ 标准/ ,/ 分别/ 比较/ 第/ t/ 次/ 和/ 第/ t/ +/ 1/ 次/ 迭代/ 步骤/ 的/ LN/ 、/ LC/ ./ 若/ Lt/ 的/ 真实/ 数据/ 已/ 不能/ 驱动/ 目标/ 运动/ ,/ 内力/ 驱动/ 与/ 外力/ N/ 与/ Lt/ +/ 1/ 约束/ 达到/ 了/ 平衡/ 状态/ ,/ 肝脏/ 分割/ 结果/ 的/ 搜索/ 已/ 进入/ 稳定/ 状态/ ,/ 肝脏/ 分割/ 结果/ 已/ 逼近/ 最优/ 值/ ./ 利用/ 重合/ 率/ 定量/ 地/ 衡量/ 前后/ 肝脏/ 分割/ 结果/ 的/ 变化率/ ,/ 如/ 公式/ 其中/ ,/ L1/ 、/ L2/ 分别/ 表示/ 两种/ 肝脏/ 分割/ 结果/ ,/ |/ L1/ ∩/ L2/ |/ 表示/ L1/ 与/ L2/ 的/ 交集/ 区域/ 面积/ ,/ L1/ ∪/ L2/ 表示/ L1/ 与/ L2/ 并集/ 区域/ 面积/ ./ 当/ L1/ 与/ L2/ 完全相同/ 时/ ,/ S/ =/ 100/ %/ ;/ 当/ L1/ 与/ L2/ 完全/ 不/ 相同/ 时/ ,/ S/ =/ 0/ ./ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ 肝脏/ 分割/ 方法/ 的/ 实现/ 流程/ 如图/ 2/ 所示/ ./ Page4/ 图/ 2/ 系统/ 实现/ 流程图/ 3/ 肝脏/ 区域/ 初始化/ 受/ 成像/ 条件/ 、/ 设备/ 、/ 噪声/ 等/ 干扰/ 因素/ 的/ 影响/ ,/ 不同/ 患者/ CT/ 图像/ 序列/ 中/ 的/ 肝脏/ 区域/ 的/ 灰度/ 值会/ 发生/ 波动/ ./ 由于/ 肝脏/ 与/ 其他/ 器官/ 之间/ 的/ 相对/ 密度/ 保持稳定/ ,/ 因此/ 不同/ 器官/ 之间/ 成像/ 的/ 灰度/ 值/ 差分/ 也/ 保持/ 相对/ 稳定/ ./ 对/ 图像/ 以/ 相同/ 的/ 参考/ 基准/ 进行/ 归一化/ 预处理/ ,/ 有利于/ 降低/ 噪声/ 对/ 肝脏/ 分割/ 的/ 影响/ ./ 存在/ 肝脏/ 的/ CT/ 序列/ 图像/ 中必会/ 存在/ 脊椎/ ,/ 并且/ 脊椎/ 区域/ 总是/ 呈现出/ 高亮/ 区域/ 包围/ 低暗/ 区域/ ,/ 其/ 特征/ 明显/ ,/ 很/ 容易/ 在/ 图像/ 中/ 提取/ ,/ 如图/ 3/ 所示/ ./ 以/ CT/ 序列/ 图像/ 中/ 各自/ 脊髓/ 区域/ 的/ 灰度/ 值为/ 参考/ ,/ 实现/ CT/ 序列/ 图像/ 的/ 预处理/ ,/ 如/ 公式/ 其中/ ,/ G/ (/ i/ ,/ j/ )/ 表示/ (/ i/ ,/ j/ )/ 位置/ 的/ 灰度/ 值/ ,/ T/ 表示/ 当前/ 图像/ 的/ 参考/ 基准/ (/ 脊髓/ 区域/ 的/ 灰度/ 平均值/ )/ ,/ C/ 是/ 一个/ 常数/ ./ C/ 的/ 作用/ 是/ 整体/ 提高/ 图像/ 的/ 差/ 分值/ ,/ 所有/ 图像/ 取/ 相同/ 值/ ./ 人体/ 骨骼/ 的/ 密度/ 高且/ 结构/ 稳定/ ,/ 在/ CT/ 序列/ 图像/ 中/ 呈现/ 为/ 高亮/ 区域/ ./ 提取/ 图像/ 中/ 的/ 肋骨/ 区域/ ,/ 并/ 依次/ 连接/ ,/ 粗略/ 定位/ 出/ 腹腔/ 区域/ 后/ ,/ 以/ 脊髓/ 为/ 中心点/ 将/ 腹腔/ 分为/ 将/ 腹腔/ 分割/ 为/ A/ 、/ B/ 两/ 部分/ ,/ 如图/ 4/ 所示/ ,/ 人体/ 肝脏/ 大多/ 存在/ 于/ A/ 区/ ./ 用/ 先验/ 样本/ 数据/ 建立/ 肝脏/ 区域/ 灰度/ 分布/ 的/ 高斯/ 混合/ 模型/ (/ GaussianMixtureModel/ ,/ GMM/ )/ ,/ 如/ 公式/ 根据/ 建立/ 的/ 肝脏/ 区域/ 的/ GMM/ 分割/ A/ 区/ 肝脏/ ,/ 实现/ 肝脏/ 区域/ 初始化/ ./ 当/ 肝脏/ 与/ 人体/ 腹腔/ 臂/ 连接/ 紧密/ 且/ 边缘/ 模糊/ 时/ ,/ 利用/ 骨骼/ 结构/ 生成/ 的/ 腹腔/ 结构/ 有利于/ 在/ 初始化/ 肝脏/ 区域/ 时/ 确定/ 肝脏/ 区域/ ./ 4/ 基于/ MRF/ 的/ 目标/ 运动/ 将/ 一个二维/ 图像/ 中/ 所有/ 可能/ 的/ 闭合/ 曲线/ 的/ 集合/ Page5/ 定义/ 为/ 形状/ 空间/ Ψ/ ,/ 每/ 一种/ 形状/ 就是/ 形状/ 空间/ 中/ 的/ 一个点/ p/ ./ CT/ 序列/ 图像/ 中/ 肝脏/ 分割/ 的/ 任务/ 就是/ 在/ 空间/ 中/ 定义/ 一个/ 搜索/ 目标/ O/ ,/ 控制目标/ O/ 在/ 形状/ 空间/ 中/ 移动/ ,/ 得到/ 最优/ 值/ ./ 目标/ O/ 的/ 移动/ 表现/ 在/ 分割/ 工作/ 的/ 具体操作/ 上/ 就是/ 根据/ 图像/ 真实/ 数据/ ,/ 在/ 已有/ 的/ 肝脏/ 轮廓/ 边缘/ 点/ 的/ 邻域/ 范围/ 内以/ 局部/ 数据/ 特征/ 为/ 主要/ 依据/ ,/ 调整/ 肝脏/ 轮廓/ 边缘/ ,/ 从而/ 驱动/ 分割/ 目标/ 向/ 最优/ 值/ 靠近/ ./ 本/ 部分/ 选择/ 了/ 可/ 建立/ 像素/ 之间/ 关联性/ ,/ 具有/ 较/ 好/ 的/ 局部/ 数据处理/ 能力/ 的/ MRF/ 作为/ 实现/ 工具/ ./ 图像/ 是/ 一个/ 规则/ 的/ 方格/ 网/ ,/ 定义/ 为/ S/ =/ {/ (/ i/ ,/ j/ )/ |/ 1/ / i/ / W/ ,/ 1/ / j/ / H/ }/ ,/ W/ 、/ H/ 为/ 图像/ 的/ 宽/ 、/ 高/ ./ 图像/ 每/ 一个/ 像素点/ 的/ 灰度/ 取值/ 及其/ 属性/ 是/ 一个/ 随机变量/ ,/ 扩展/ 到/ 整幅/ 图像/ ,/ 形成/ 观测/ 场/ 和/ 标记/ 场/ ./ 观测/ 场/ 的/ 取值/ 由/ 图像/ 各/ 像素点/ 可/ 观察/ 到/ 的/ 灰度/ 值/ 组成/ ,/ 标记/ 场/ 的/ 取值/ 由/ 各/ 像素点/ 的/ 属性/ 取值/ 组成/ ,/ 属性/ 即/ 是/ 各/ 像素点/ 所属/ 的/ 分割/ 类别/ ./ 在/ 肝脏/ 分割/ 工作/ 中/ ,/ 各/ 像素点/ 可取/ 的/ 属性/ 值有/ 两个/ ,/ 即非/ 肝脏/ 区域/ 和/ 肝脏/ 区域/ ,/ 记为/ L/ =/ {/ 0/ ,/ 1/ }/ ,/ 0/ 表示/ 非/ 肝脏/ 区域/ ,/ 1/ 表示/ 肝脏/ 区域/ ./ 肝脏/ 分割/ 的/ 过程/ 就是/ 在/ 一幅/ 未知/ 结果/ 的/ 图像/ 中/ 对/ 各/ 像素点/ 添加/ 标记/ 属性/ 的/ 过程/ ./ MRF/ 构建/ 的/ 基团/ 系统/ 建立/ 了/ 图像/ 的/ 空间/ 关联性/ ,/ 空间/ 像素点/ 之间/ 的/ 关联性/ 被/ 表征/ 为/ 单点/ 基团/ 、/ 两点/ 基团/ 、/ 三点/ 基团/ 等/ ./ 所有/ 的/ 基团/ 单元/ 组成/ 了/ 图像/ 的/ 基团/ 集合/ ,/ 从而/ 建立/ 起/ 了/ 图像/ 的/ 空间/ 关联性/ ./ 著名/ 的/ HC/ (/ Hammersley/ -/ Clifford/ )/ 定理/ 证明/ 了/ MRF/ 与/ Gibbs/ 分布/ 之间/ 的/ 等价/ 性/ ,/ 推动/ 了/ MRF/ 从/ 理论/ 走向/ 实际/ 应用/ ./ 一幅/ 图像/ 的/ MRF/ 随/ 机场/ 利用/ Gibbs/ 分布/ 可/ 表示/ 为/ 其中/ ,/ l/ 表示/ 标记/ 场/ 的/ 取值/ 变量/ ,/ Z/ 是/ 一个/ 能量/ 归一化/ 量/ ,/ T/ 是/ 一个/ 常量/ (/ 常取/ 1/ )/ ,/ U/ (/ l/ )/ 是/ 基团/ 集合/ 的/ 能量/ ,/ Vc/ (/ l/ )/ 是/ 各/ 基团/ 的/ 势能/ ./ 本文/ 选择/ 了/ MLL/ (/ Multi/ -/ LevelLogistic/ )/ 模型/ 定义/ 各/ 集团/ 的/ 势能/ [/ 19/ ]/ ,/ 如/ 公式/ Vc/ (/ l/ )/ =/ 其中/ ,/ Qc/ 、/ Ql/ 是/ 未知数/ ,/ 一般/ 是/ 赋为/ 定值/ ,/ 或/ 利用/ 先验/ 样本/ 信息/ 学习/ 获得/ ./ 本文/ 根据/ 先验/ 样本/ 数据/ ,/ 利用/ 最大/ 似然/ 估计/ 确定/ MLL/ 模型/ 的/ 参数/ ,/ 如/ 公式/ 其中/ θ/ =/ (/ Qc/ ,/ Ql/ )/ ./ MAP/ -/ MRF/ 是/ 一种/ 常用/ 的/ 分割/ 模型/ ,/ 就是/ 通过/ 找/ 一种/ 最佳/ 的/ 分割/ 方式/ ,/ 使/ 分割/ 标签/ 相对/ 于/ 观测/ 值/ 的/ 后验/ 概率/ p/ (/ l/ |/ g/ )/ 最大/ ,/ 其中/ l/ 表示/ 分割/ 标签/ ,/ g/ 表示/ 观测/ 场/ 的/ 灰度/ 值/ ./ 根据/ 贝叶斯/ 公式/ ,/ 分割/ 标签/ 的/ 最大/ 后验/ 概率/ 可分解/ 为/ 基于/ 先验/ 样本/ 数据/ 及/ MRF/ 的/ 表达形式/ ,/ 如/ 公式/ p/ (/ g/ |/ l/ )/ 表示/ 具有/ 同一/ 标记/ 属性/ 的/ 像素/ 的/ 灰度/ 值/ 先验概率/ 分布/ ./ 其中/ ,/ 当/ l/ =/ 1/ 时/ ,/ p/ (/ g/ |/ l/ )/ 与/ 式/ (/ 4/ )/ 相同/ ./ p/ (/ l/ )/ 可由式/ (/ 5/ )/ 求得/ ,/ p/ (/ g/ )/ 是/ 不分/ 属性/ 的/ 灰度/ 值/ 概率分布/ ./ 最终/ ,/ 根据/ 图像/ 实际/ 灰度/ 值/ ,/ 找到/ 一种/ 最优/ 的/ 标记/ 场/ 取值/ ,/ 使/ 其后/ 验/ 概率/ 最大/ ,/ 如/ 公式/ 其中/ ,/ Ω/ 表示/ 一幅/ 图像/ 中/ 所有/ 可能/ 的/ 标签/ 组合/ 形式/ 的/ 集合/ ./ 基于/ MRF/ 的/ 图像/ 分割/ 是/ 一个/ 最优/ 值/ 优化/ 问题/ ,/ 很难/ 找到/ 准确/ 的/ 显式/ 模型/ 描述/ 分割/ 进程/ ,/ 得到/ 精确/ 的/ 分割/ 结果/ ./ 目前/ 常用/ 的/ 一种/ 策略/ 是/ 采用/ 迭代/ 优化/ 的/ 方式/ 获取/ 某一/ 准则/ 衡量/ 下/ 的/ 最优/ 分割/ 结果/ ,/ 优化/ 过程/ 一般/ 采用/ 智能/ 计算技术/ ,/ 如/ EM/ 算法/ ,/ 迭代/ 条件/ 模式/ (/ IterativeConditionModel/ ,/ ICM/ )/ ,/ 模拟退火/ 算法/ 等/ ./ 本文/ 选择/ ICM/ 完成/ 基于/ MRF/ 的/ 肝脏/ 轮廓/ 边缘/ 再/ 分割/ 任务/ ./ 5/ 基于/ 形状/ 稀疏/ 表示/ 的/ 目标/ 运动/ 约束/ MRF/ 依据/ 图像/ 实际/ 数据/ 驱动/ 目标/ 运动/ ,/ 但/ 受/ 噪声/ 、/ 边界/ 模糊/ 等/ 因素/ 的/ 影响/ ,/ 可能/ 会/ 造成/ 局部/ 分割/ 错误/ ,/ 因此/ 有/ 必要/ 对/ 目标/ 的/ 运动/ 进行/ 约束/ ./ 形状/ 的/ 稀疏/ 表示/ 是/ 利用/ 先验/ 形状/ 信息/ 拟合/ 一个/ 新/ 的/ 形状/ ,/ 保留/ 新/ 形状/ 符合/ 先验/ 信息/ 的/ 成分/ ,/ 舍弃/ 新/ 形状/ 不/ 符合/ 先验/ 信息/ 的/ 成分/ ,/ 有效/ 地/ 约束/ 了/ 肝脏/ 的/ 形状/ 变化/ ,/ 并/ 将/ 其/ 控制/ 在/ 先验/ 信息/ 的/ 约束/ 下/ ,/ 防止/ 肝脏/ 分割/ 过程/ 中/ 出现/ 严重/ 的/ 分割/ 错误/ ,/ 提高/ 了/ 肝脏/ 分割/ 的/ 精度/ ./ 5.1/ 形状/ 坐标/ 序列/ 的/ 逻辑/ 转换/ 在/ 数字图像/ 中/ ,/ 肝脏/ 的/ 轮廓/ 通常/ 以/ 目标/ 边缘/ 点/ 的/ 图像/ 坐标/ 序列/ 表示/ ./ 然而/ ,/ 应用/ 中/ 更加/ 关心/ 的/ 是/ 肝脏/ 的/ 形状/ ,/ 而/ 不是/ 轮廓/ 点/ 坐标/ 是/ 如何/ 分布/ 的/ ./ 轮廓/ 点/ Page6/ 之间/ 特定/ 的/ 约束/ 关系/ 形成/ 了/ 其/ 表现/ 出/ 的/ 形状/ ./ 原始/ 的/ 坐标/ 点/ 不能/ 体现/ 轮廓/ 点/ 之间/ 的/ 约束/ 关系/ ,/ 因此/ 将/ 肝脏/ 轮廓/ 的/ 原始/ 坐标/ 转换成/ 轮廓/ 的/ 逻辑/ 坐标/ ,/ 凸显/ 了/ 轮廓/ 的/ 形状/ 信息/ ./ 假设/ 一个/ 肝脏/ 的/ 轮廓/ 坐标/ 点/ 序列/ 为/ d/ =/ {/ (/ x1/ ,/ y1/ )/ ,/ (/ x2/ ,/ y2/ )/ ,/ (/ x3/ ,/ y3/ )/ ,/ …/ ,/ (/ xM/ ,/ yM/ )/ }/ ,/ 各/ 坐标/ 点/ 之间/ 蕴含/ 了/ 各点/ 之间/ 的/ 约束/ 关系/ ,/ 这种/ 约束/ 关系/ 形成/ 了/ 轮廓/ 所/ 表现/ 出/ 的/ 形状/ ./ 用/ 偏移/ 向量/ ν/ 表示/ 轮廓/ 点/ 之间/ 的/ 位置/ 关系/ ,/ 并/ 采用/ 后/ 项/ 循环/ 差分/ 的/ 形式/ 计算/ 相邻/ 轮廓/ 点/ 之间/ 的/ 偏移/ 向量/ ,/ 实现/ 了/ 肝脏/ 轮廓/ 坐标/ 的/ 逻辑/ 转换/ ,/ 如/ 公式/ 其中/ ,/ 2/ / r/ / M/ ./ 令/ 犛/ =/ (/ x1/ ,/ y1/ )/ ,/ / =/ {/ ν/ 1/ ,/ ν/ 2/ ,/ ν/ 3/ ,/ …/ ,/ ν/ n/ }/ ,/ 向量/ 集/ / 及/ 犛/ 完整/ 地/ 表达/ 出/ 肝脏/ 的/ 形状/ 及/ 位置/ ,/ 得到/ 一种/ 新/ 的/ 轮廓/ 表达形式/ d/ =/ {/ / ,/ 犛/ }/ ./ 这种/ 表达方式/ 描述/ 了/ 相邻/ 轮廓/ 点/ 之间/ 的/ 约束/ 关系/ ,/ / 决定/ 了/ 轮廓/ 的/ 形状/ ,/ 犛/ 确定/ 了/ 轮廓/ 所在/ 的/ 位置/ ./ 任意/ 两点/ 之间/ 的/ 约束/ 关系/ 可/ 利用/ 约束/ 集/ / 求得/ ,/ 循环/ 移位/ 约束/ 集/ / 可/ 实现/ 两个/ 轮廓/ 的/ 对齐/ ,/ 并且/ / 表征/ 出/ 的/ 形状/ 是/ 具有/ 移动/ 不变性/ ./ 例如/ ,/ 轮廓/ 点/ (/ xr/ ,/ yr/ )/ 与/ (/ xr/ +/ k/ ,/ yr/ +/ k/ )/ 之间/ 的/ 约束/ 关系/ 狏/ r/ →/ k/ =/ 狏/ r/ +/ 1/ +/ 狏/ r/ +/ 2/ +/ …/ +/ 狏/ r/ +/ k/ ,/ 如图/ 5/ 所示/ ./ 图/ 6/ 动态/ 字典/ 生成/ 策略/ 示例/ 5.2/ 肝脏/ 形状/ 字典/ 的/ 生成/ 字典/ 是/ 稀疏/ 表示/ 的/ 一个/ 重要/ 部分/ ,/ 由/ 大量/ 的/ 先验/ 形状/ 信息/ 组成/ ./ 肝脏/ 在/ 不同/ 断层/ 图像/ 中/ 的/ 形状/ 会/ 发生变化/ ,/ 若/ 将/ 肝脏/ 在/ 每个/ 断层/ 图像/ 中/ 的/ 形状/ 信息/ 都/ 引入/ 形状/ 字典/ ,/ 必会/ 成倍/ 地/ 增加/ 字典/ 的/ 容量/ ,/ 并/ 造成/ 计算/ 量/ 的/ 成倍增加/ ./ 为了/ 提高/ 计算/ 效率/ ,/ 减小/ 字典/ 的/ 冗余/ 性/ ,/ 我们/ 设计/ 了/ 一种/ 动态/ 字典/ 生成/ 策略/ ./ 肝脏/ 的/ 动态/ 字典/ 建立/ 在/ 字典/ 库/ 基础/ 之上/ ,/ 字典/ 库由/ 不同/ 患者/ 的/ CT/ 序列/ 图像/ 中/ 的/ 肝脏/ 形状/ 组成/ ,/ 每/ 一位/ 患者/ 的/ 肝脏/ 断层/ 形状/ 序列/ 成为/ 一个/ 样本/ 单元/ ./ 根据/ 输入/ 形状/ 的/ 特征/ 在/ 字典/ 库中/ 挑选/ 形状/ 实例/ 组成/ 形状/ 字典/ ,/ 每/ 一个/ 样本/ 单元/ 中/ 只/ 挑选/ 一个/ 最/ 相近/ 的/ 形状/ 实例/ ./ 为了/ 保证/ 字典/ 库/ 的/ 可靠性/ 与/ 多样性/ ,/ 每/ 一个/ 样本/ 单元/ 的/ 肝脏/ 形状/ 都/ 是/ 由/ 临床/ 医生/ 和/ 放射科/ 物理/ 师/ 通过/ 手工/ 勾画/ 所得/ ,/ 进入/ 字典/ 库/ 的/ 样本/ 单元/ 也/ 是/ 由/ 临床/ 医生/ 和/ 放射科/ 物理/ 师/ 根据/ 经验/ 选择/ 各种/ 形状/ 的/ 肝脏/ ./ 动态/ 字典/ 生成/ 策略/ 通过/ 以下/ 步骤/ 实现/ :/ (/ 1/ )/ 计算/ 新/ 目标/ 形状/ 的/ 周长/ J/ ./ (/ 2/ )/ 在/ 每/ 一个/ 样本/ 单元/ 中/ 搜索/ 周长/ 最/ 接近/ J/ 的/ 形状/ 实例/ Er/ 示/ 样本/ 单元/ 中/ 形状/ 实例/ 的/ 序号/ ./ (/ 3/ )/ 将/ (/ 2/ )/ 抽取/ 的/ 形状/ 实例/ 组成/ 形状/ 字典/ ./ 动态/ 字典/ 生成/ 策略/ 如图/ 6/ 所示/ ./ 字典/ 库是/ 在/ 使用/ 过程/ 中/ 不断完善/ 的/ ,/ 当/ 字典/ 库中/ 的/ 形状/ 实例/ 与/ 待/ 分割/ 的/ 肝脏/ 形状/ 具有/ 明显/ 差别/ 时/ ,/ 抽取/ 的/ 字典/ 可能/ 不够/ 准确/ ,/ 稀疏/ 表示/ 将/ 不能/ 准确/ 地/ 修正/ 肝脏/ 形状/ ,/ 甚至/ 会/ 导致/ 分割/ 错误/ ./ 此时/ ,/ 仍/ 需要/ 依靠/ 临床/ 医生/ 和/ 放射科/ 物理/ 师/ 手动/ 勾画/ 肝脏/ 的/ 形/ Page7/ 状/ ,/ 并/ 将/ 其/ 加入/ 到/ 字典/ 库中/ ./ 在/ 下次/ 分割/ 遇到/ 类似/ 情况/ 时/ 可/ 得到/ 适用/ 的/ 字典/ ./ 选择/ 形状/ 的/ 周长/ 作为/ 在/ 样本/ 单元/ 中/ 抽取/ 形状/ 实例/ 组成/ 形状/ 字典/ 的/ 衡量标准/ ,/ 虽然/ 这种/ 选择/ 标准/ 可能/ 会/ 选择/ 出/ 与/ 输入/ 形状/ 完全/ 不/ 相同/ 的/ 形状/ 实例/ ,/ 但/ 正是/ 靠/ 这种/ 衡量标准/ 的/ 不/ 完全/ 准确性/ 可/ 抽取/ 出/ 多种/ 形状/ 实例/ ,/ 保证/ 了/ 字典/ 的/ 多样性/ ./ 同时/ ,/ 在/ 根据/ 形状/ 周长/ 建立/ 字典/ 时/ ,/ 与/ 输入/ 形状/ 最/ 接近/ 的/ 肝脏/ 实例/ 必然/ 会/ 被/ 选中/ ,/ 由此/ 保证/ 了/ 字典/ 的/ 准确性/ ./ 动态/ 字典/ 中/ 各/ 形状/ 实例/ 的/ 轮廓/ 点数/ 及/ 轮廓/ 的/ 起始/ 记录/ 点/ 各不相同/ ,/ 因此/ 在/ 利用/ 稀疏/ 表示/ 约束/ 肝脏/ 形状/ 之前/ 应对/ 字典/ 中/ 的/ 各/ 形状/ 实例/ 对齐/ ./ 传统/ 抽样/ 或/ 插值/ 算法/ 即可/ 实现/ 轮廓/ 点/ 序列/ 的/ 长度/ 归一化/ ./ 起始/ 记录/ 点/ 影响/ 着/ 整个/ 轮廓/ 的/ 数据/ 表现形式/ ,/ 不同/ 的/ 起始/ 记录/ 点会/ 使/ 相同/ 的/ 轮廓/ 在/ 数值/ 上/ 存在/ 较大/ 的/ 差别/ ,/ 所以/ 对齐/ 各/ 形状/ 实例/ 的/ 起始/ 记录/ 点/ 也/ 是/ 必须/ 要/ 完成/ 的/ 准备/ 工作/ ./ 选择/ 字典/ 中/ 的/ 第一个/ 轮廓/ d1/ 作为/ 对齐/ 基准/ ,/ 对/ 第/ i/ 个/ 待/ 对齐/ 的/ 轮廓/ di/ 进行/ 循环/ 移位/ ,/ 并/ 结合/ 文献/ [/ 16/ ]/ 使用/ 的/ PA/ (/ ProcrustesAnalysis/ )/ 算法/ 中将/ di/ 向/ d1/ 对齐/ 的/ 方法/ ,/ 选择/ 各/ 对齐/ 点/ 之间/ 平方/ 误差/ 最小/ 的/ 轮廓/ 点/ 记录/ 顺序/ 作为/ 对齐/ 起始/ 记录/ 点/ 的/ 轮廓/ ./ 算法/ 实现/ 如/ 算法/ 1/ 所述/ ./ 算法/ 1/ ./ 肝脏/ 轮廓/ 起始/ 记录/ 点/ 对齐/ 算法/ 实现/ ./ 输入/ :/ 对齐/ 标准/ ,/ 未/ 对齐/ 形状/ 输出/ :/ 已/ 向/ 标准/ 对齐/ 的/ 形状/ 实现/ :/ 1/ ./ di/ 向/ 左/ 循环/ 移/ 1/ 位/ ,/ 得到/ 一个/ 新/ 的/ 轮廓/ 记录/ 形似/ dt2/ ./ 利用/ PA/ 算法/ ,/ 将/ dt/ 序列/ dNi/ ,/ N/ ++/ ,/ 其中/ N/ 代表/ 循环/ 移位/ 的/ 次数/ ./ 3/ ./ 计算/ 对齐/ 后/ 新/ 的/ 轮廓/ 点/ 序列/ dN/ 的/ 均/ 方差/ ,/ σ/ =/ ∑/ 轮廓/ 点/ 的/ 个数/ ./ 4/ ./ 更新/ di/ =/ dtdti/ ,/ 完成/ 轮廓/ 起始/ 记录/ 点/ 的/ 对齐/ 功能/ ./ 对齐/ 字典/ 中/ 示例/ 轮廓/ 点/ 个数/ 、/ 起始/ 记录/ 点后/ ,/ 利用/ 式/ (/ 10/ )/ ,/ 对/ 轮廓/ 的/ 原始/ 坐标/ 进行/ 逻辑/ 转换/ ,/ 得到/ 肝脏/ 实例/ 的/ 形状/ 信息/ / ,/ 并/ 组成/ 肝脏/ 形状/ 字典/ D/ =/ {/ / 1/ ,/ / 2/ ,/ …/ ,/ / N/ }/ ∈/ 犚/ M/ ×/ N/ ./ 5.3/ 基于/ 形状/ 稀疏/ 表示/ 和/ 混合/ 粒子/ 群/ 算法/ 的/ 目标/ 运动/ 约束/ 目标/ 运动/ 约束/ 表现/ 在/ 肝脏/ 分割/ 的/ 具体操作/ 是/ 利用/ 先验/ 形状/ 信息/ 拟合/ 分割/ 结果/ ,/ 对/ 肝脏/ 的/ 形状/ 改变/ 进行/ 有效/ 的/ 约束/ ,/ 抑制/ 因/ 干扰/ 引起/ 的/ 错误/ 分割/ ./ 将/ 一个/ 待处理/ 的/ 输入/ 形状/ 狔/ 向/ 形状/ 字典/ 中/ 的/ d1/ 实例/ 对齐/ ,/ 并/ 计算/ 得到/ 其/ 形状/ 逻辑/ 信息/ / y/ ./ 利用/ 字典/ 中/ 的/ 形状/ 信息/ 拟合/ 输入/ 的/ 形状/ 信息/ ,/ 得到/ 一个/ 误差/ 最小/ 的/ 拟合/ 方式/ ,/ 如/ 其中/ ,/ 狓/ 表示/ 形状/ 的/ 稀疏/ 表示/ 系数/ 矩阵/ ,/ 狔/ 表示/ 轮廓/ 局部/ 错误/ 的/ 稀疏/ 矩阵/ ,/ e/ 用于/ 矫正/ 局部/ 形状/ 分割/ 错误/ ,/ k1/ 、/ k2/ 限定/ 了/ 矩阵/ 的/ 稀疏/ 度/ ./ 将/ 输入/ 形状/ 更新/ 为/ 拟合/ 后/ 的/ 形状/ ,/ 如/ 公式/ 式/ (/ 16/ )/ 的/ 变形/ 来源于/ SSC/ 模型/ [/ 16/ ]/ ,/ 经过/ 肝脏/ 形状/ 的/ 对齐/ 及/ 逻辑/ 转换/ ,/ 优化/ 了/ 形状/ 的/ 全局/ 变化/ 操作/ ,/ 使/ 模型/ 得以/ 简化/ ./ 文献/ [/ 16/ ]/ 利用/ EM/ 算法/ 搜索/ 稀疏/ 表示/ 方程/ 的/ 最优/ 解/ ./ 与/ 遗传算法/ 、/ 粒子/ 群/ 算法/ 等/ 智能/ 计算方法/ 相比/ ,/ EM/ 算法/ 更/ 易/ 陷入/ 局部/ 最优/ 解/ ./ 为了/ 提高/ 计算精度/ 及/ 效率/ ,/ 利用/ 混合/ 粒子/ 群/ 算法/ 搜索/ 式/ (/ 16/ )/ 的/ 最优/ 解/ ./ 式/ (/ 17/ )/ 的/ 求解/ 是/ 一个/ 具有/ 两个/ 优化/ 参数/ (/ 狓/ ,/ e/ )/ 的/ 高维/ 复杂/ 函数/ 求解/ 的/ 过程/ ./ 研究/ 人员/ 对/ 高维/ 复杂/ 函数/ 的/ 求解/ 进行/ 了/ 相关/ 研究/ ,/ 如/ 利用/ 混合/ 优化/ 策略/ [/ 20/ ]/ 、/ 混合/ 粒子/ 群/ 算法/ [/ 21/ -/ 23/ ]/ 等/ 方法/ ./ 在/ 粒子/ 群/ 算法/ 的/ 更新/ 部分/ 中/ 引入/ 遗传算法/ 的/ 交叉/ 、/ 变异/ 操作/ [/ 24/ ]/ ,/ 使/ 稀疏/ 表示/ 方程/ 的/ 最优/ 解/ 搜索/ 进程/ 不易/ 陷入/ 局部/ 最优/ ./ 字典/ 中/ 的/ 肝脏/ 实例/ 个数/ 为/ N/ ,/ 故/ 狓/ 、/ e/ 的/ 维数/ 均/ 为/ N/ ./ 本文/ 所/ 使用/ 的/ 混合/ 粒子/ 群/ 算法/ 做/ 如下/ 设计/ :/ (/ 1/ )/ 粒子/ 编码/ ./ 将/ 狓/ 、/ e/ 编码/ 成/ 1/ 个/ 粒子/ ,/ 并/ 生成/ 由/ R/ 个/ 粒子/ 组成/ 的/ 种群/ T/ =/ {/ T1/ ,/ T2/ ,/ …/ ,/ TR/ }/ ,/ 粒子/ 的/ 维数/ 为/ 2N/ ,/ 第/ i/ 个/ 粒子/ 表示/ 为/ Ti/ =/ {/ x1/ ,/ x2/ ,/ …/ ,/ xN/ ,/ e1/ ,/ e2/ ,/ …/ ,/ eN/ }/ ./ (/ 2/ )/ 个体/ 最优/ 粒子/ ,/ 全局/ 最优/ 粒子/ ./ 个体/ 最优/ 是/ 指/ 个体/ 粒子/ 搜索/ 过/ 的/ 最优/ 的/ 值/ ,/ 每/ 一个/ 粒子/ 都/ 有/ 一/ B/ 个/ 最优/ 值/ ,/ 第/ i/ 个/ 粒子/ 遍历/ 位置/ 的/ 个体/ 最优/ 粒子/ 记/ i/ ;/ 全局/ 最优/ 是/ 指/ 所有/ 粒子/ 搜索/ 过/ 的/ 位置/ 中/ 最优/ 为/ T/ 的/ 值/ ,/ 只有/ 一个/ 全局/ 最优/ 值/ TG/ ./ i/ ,/ v2i/ ,/ …/ ,/ v2N/ (/ 3/ )/ 粒子/ 运动/ 速度/ 及/ 粒子/ 更新/ ./ 每/ 一个/ 粒子/ 都/ 对应/ 一个/ 速度/ 矢量/ ,/ 第/ i/ 个/ 粒子/ 的/ 运动/ 矢量/ 记/ 为/ 狏/ =/ {/ v1/ 次/ 迭代/ 的/ 速度/ vi/ 、/ 当前/ 粒子/ 位置/ Ti/ 、/ 个体/ 最优/ 位置/ i/ 、/ 全局/ 最优/ 位置/ TG/ 共同/ 决定/ ,/ 如式/ (/ 18/ )/ 、/ (/ 19/ )/ TB/ 所示/ ./ (/ 4/ )/ 适应度/ 函数/ ./ 选择/ 拟合/ 的/ 轮廓/ 与/ 实际/ 轮廓/ 的/ 均/ 方差/ 的/ 倒数/ 为/ 粒子/ 群/ 算法/ 的/ 适应度/ 函数/ ,/ 如/ Page8/ 式/ (/ 20/ )/ ./ 误差/ 越大/ ,/ 适应度/ 之约/ 小/ ,/ 反之/ 越大/ ./ (/ 5/ )/ 粒子/ 交叉/ 与/ 变异/ ./ 在/ 个体/ 、/ 全局/ 最优/ 粒子/ 中/ 随机/ 选择/ 交叉/ 位置/ 和/ 长度/ ,/ 与/ 随机/ 选取/ 的/ 普通/ 粒子/ 进行/ 交叉/ 操作/ ;/ 在/ 随机/ 选择/ 的/ 粒子/ 中/ 选择/ 一定/ 数量/ 的/ 非/ 零数/ ,/ 并/ 在/ 再次/ 随机/ 抽取/ 的/ 粒子/ 中/ 随机/ 替换/ 某一/ 位置/ 的/ 参数/ ./ 同样/ 需要/ 注意/ 的/ 是/ ,/ 只/ 允许/ 相同/ 含义/ 的/ 变量/ 之间/ 进行/ 交叉/ 、/ 变异/ 替换/ ,/ 不/ 允许/ 不同/ 含义/ 的/ 变量/ 之间/ 进行/ 变异/ 操作/ ./ 其中/ ,/ s/ 表示/ 迭代/ 步骤/ ,/ ξ/ 表示/ 惯性/ 系数/ ,/ a/ 、/ b/ 表示/ 加速度/ 系数/ ,/ r1/ 、/ r2/ 为/ [/ 0/ ,/ 1/ ]/ 之间/ 的/ 随机数/ ,/ j/ 表示/ 粒子/ 图/ 7/ 基于/ 混合/ 粒子/ 群/ 算法/ 的/ 稀疏/ 方程/ 最优/ 解/ 搜索/ 6/ 实验/ 测试/ 与/ 结果/ 分析/ 6.1/ 样本/ 数据库/ 与/ 实验/ 测试/ 数据库/ 的/ 组成/ 样本/ 数据/ 由/ 不同/ 患者/ 的/ 临床/ CT/ 序列/ 图像/ 组成/ ,/ 每/ 一个/ 患者/ 的/ CT/ 图像/ 序列/ 是/ 一个/ 样本/ 单元/ ,/ 共/ 选取/ 了/ 100/ 个/ 包含/ 各种/ 肝脏/ 形态/ 的/ 样本/ 单元/ ./ 样本/ 数据库/ 需要/ 尽可能/ 包含/ 肝脏/ 在/ CT/ 图像/ 中/ 可能/ 呈现/ 的/ 形态/ 和/ 灰度/ 值/ ,/ 保证/ 样本/ 的/ 多样性/ ./ 实验/ 测试/ 数据库/ 由/ 随机/ 选择/ 的/ 100/ 位/ 患者/ 的/ CT/ 序列/ 图像/ 组成/ ./ 每/ 一个/ 样本/ 单元/ 包含/ 20/ ~/ 30/ 幅/ CT/ 图像/ ,/ 样本/ 数据/ 与/ 测试/ 数据库/ 中/ 各自/ 至少/ 包含/ 2000/ 幅/ CT/ 图像/ ./ 样本/ 数据库/ 中/ 的/ 肝脏/ 区域/ 及/ 形状/ 由/ 临床/ 医生/ 和/ 放射科/ 物理/ 师/ 手动/ 勾画/ ,/ 作为/ 先验/ 信息/ ./ 由/ 临床/ 医生/ 和/ 放射科/ 物理/ 师/ 在/ 实验/ 数据库/ 中/ 手动/ 勾画/ 的/ 肝脏/ 区/ 的/ 第/ j/ 个/ 参数/ ./ 在/ 稀疏/ 方程/ 最优/ 解/ 搜索/ 过程/ 中/ ,/ 将/ 两个/ 变量/ 合并/ 成/ 一个/ 粒子/ ,/ 并/ 在/ 交叉/ 、/ 变异/ 操作/ 中/ 加以/ 区分/ ,/ 防止/ 因/ 粒子/ 种群/ 中/ 不同/ 属性/ 解/ 的/ 相互/ 混杂/ 而/ 导致/ 求解/ 失败/ ./ 另外/ ,/ 在/ 求解/ 稀疏/ 方程解/ 的/ 过程/ 中/ ,/ 应/ 限制/ 狓/ 、/ e/ 解/ 的/ 稀疏/ 性/ ./ 当/ 狓/ 、/ e/ 解/ 的/ 稀疏/ 性/ 不/ 满足/ 稀疏/ 性/ 要求/ 时/ ,/ 依次/ 删除/ 狓/ 、/ e/ 中/ 的/ 最小值/ 元素/ ,/ 直至/ 满足/ 稀疏/ 性/ 约束条件/ ./ 在/ 迭代/ 的/ 最后/ ,/ 可能/ 会/ 生成/ 多个/ 满足/ 稀疏/ 性/ 约束条件/ 且/ 拟合/ 误差/ 满足要求/ 的/ 解/ ,/ 这时/ 我们/ 需要/ 在/ 稀疏/ 性/ 要求/ 和/ 误差/ 大小/ 这/ 两个/ 指标/ 上/ 进行/ 筛选/ ,/ 根据/ 实际/ 需要/ 选出/ 最优/ 解/ ./ 利用/ 混合/ 粒子/ 群/ 算法/ 搜索/ 稀疏/ 表示/ 方程/ 的/ 最优/ 解/ 不易/ 陷入/ 局部/ 最优/ ,/ 其/ 拟合/ 出/ 的/ 输入/ 形状/ 将/ 更加/ 逼近/ 真实/ 形态/ ./ 基于/ 混合/ 粒子/ 群/ 算法/ 的/ 稀疏/ 方程/ 最优/ 解/ 搜索算法/ 流程/ 如图/ 7/ 所示/ ./ 域/ 是/ 实验/ 对比/ 的/ 金/ 标准/ (/ GroundTruth/ )/ ./ 样本/ 数据库/ 用来/ 获取/ 肝脏/ 的/ 先验/ 形状/ 信息/ 和/ 灰度/ 信息/ ,/ 实验/ 数据库/ 用来/ 验证/ 算法/ 的/ 有效性/ ./ 6.2/ 对比/ 实验/ 及/ 结果/ 分析/ 为了/ 在/ 对比/ 中/ 体现/ 本文/ 所提/ 算法/ 的/ 优势/ ,/ 我们/ 选择/ 以下/ 四种/ 经典/ 分割/ 算法/ 进行/ 比较/ 实验/ ,/ 分别/ 是/ 区域/ 生长/ 、/ GVF/ -/ snake/ [/ 25/ ]/ 、/ 水平/ 集/ [/ 26/ ]/ 和/ 马尔可夫/ 随/ 机场/ [/ 18/ ]/ ./ 其中/ ,/ 区域/ 生长/ 算法/ 是/ 由/ 本文/ 作者/ 实现/ ,/ 人工/ 在/ 肝脏/ 区域/ 选择/ 种子/ 生长点/ ,/ 沿/ 8/ 邻域/ 向外/ 生长/ ,/ 得到/ 肝脏/ 分割/ 结果/ ./ 另外/ 3/ 种/ 方法/ 均/ 是/ 利用/ 他人/ 已有/ 的/ 研究成果/ 进行/ 比较/ ./ 对比/ 实验/ 结果/ 如图/ 8/ 所示/ ,/ 与/ 其他/ 算法/ 相比/ ,/ 利用/ 本文/ 所提/ 算法/ 得到/ 的/ 分割/ 结果/ 与/ “/ 金/ 标准/ ”/ 非常/ 接近/ ./ 尤其/ 是/ 在/ 模糊/ 边界/ 、/ 图像/ 质量/ 低/ 的/ 图像/ 中/ ,/ 本文/ 所提/ 算法/ 明显/ 优于/ 其他/ 对比/ 方法/ ./ 由图/ 8/ 可以/ 看出/ ,/ Page9/ 区域/ 生长/ 算法/ 不能/ 有效/ 地/ 处理/ 模糊/ 边界/ ,/ 将/ 灰度/ 值/ 与/ 肝脏/ 相近/ 的/ 临近/ 器官/ 误/ 分割/ 为/ 肝脏/ 区域/ ,/ 当/ 图像/ 质量/ 较差/ ,/ 灰度/ 分布/ 不/ 均匀/ 时/ 也/ 不能/ 有效/ 地/ 分割/ 肝脏/ 区域/ ;/ GVF/ -/ Snake/ 算法/ 主要/ 依据/ 图像/ 的/ 梯度/ 信息/ 调整/ 肝脏/ 轮廓/ ,/ 在/ 边界/ 模糊/ 区域/ 的/ 梯度/ 值较/ 小/ ,/ 很难/ 准确/ 处理/ 模糊/ 边界/ ,/ 并且/ 任意/ 位置/ 的/ 梯度/ 变化/ 都/ 可能/ 造成/ 分割/ 错误/ ;/ 水平/ 集/ 与/ MRF/ 都/ 是/ 图像/ 分割/ 方法/ ,/ 然图/ 8/ 对比/ 实验/ 结果/ 基于/ 最优/ 值/ 搜索/ 策略/ 的/ 肝脏/ 分割/ 模型/ 是/ 一种/ 依赖于/ 迭代/ 步骤/ ,/ 逐步完善/ 分割/ 结果/ 的/ 进程/ ./ 肝脏/ 区域/ 初始化/ 和/ 基于/ MRF/ 得到/ 肝脏/ 分割/ 结果/ 是/ 依据/ 图像/ 真实/ 数据/ 得到/ 的/ ,/ 受/ 各种/ 干扰/ 因素/ 的/ 影响/ ,/ 分割/ 错误/ 可能/ 存在/ ./ 利用/ 先验/ 形状/ 信息/ 在/ 全局/ 角度/ 调整/ 肝脏/ 形状/ ,/ 修正/ 了/ 因/ 过度/ 依赖/ 图像/ 数据/ 而/ 产生/ 的/ 分割/ 错误/ ./ 然而/ ,/ 先验/ 信息/ 修正/ 后/ 的/ 分割/ 结果/ 可能/ 导致/ 某些/ 局部/ 位置/ 的/ 分割/ 错误/ ,/ 此时/ 需要/ 依据/ 图像/ 的/ 实际/ 数据/ 修正/ 局部/ 形状/ ./ 如此/ 不断/ 迭代/ ,/ 相图/ 9/ 肝脏/ 分割/ 最优/ 值/ 搜索/ 进程/ (/ (/ a/ )/ 组从/ 左至/ 右/ 依次/ 为金/ 标准/ 、/ 肝脏/ 初始化/ 区域/ 、/ 初始化/ 区域/ 与/ 金/ 标准/ 对比/ ,/ (/ b/ )/ 至/ (/ d/ )/ 组从/ 左至/ 右/ 依次/ 为/ MRF/ 分割/ 结果/ 、/ 形状/ 稀疏/ 表示/ 修正/ 结果/ 、/ 本/ 步骤/ 分割/ 结果/ 与/ 金/ 标准/ 对比/ )/ 6.3/ 评价/ 分析/ 本文/ 研究/ 的/ 分割/ 工作/ 主要/ 针对/ 二维/ CT/ 图像/ ,/ 利用/ 本文/ 所提/ 方法/ 与/ “/ 金/ 标准/ ”/ 对比/ ./ 实验/ 如图/ 10/ 所示/ ./ 实验/ 结果表明/ ,/ 本文/ 所提/ 算法/ 能/ 准确/ 分割/ 肝脏/ 区/ 而/ 它们/ 过度/ 依赖/ 图像/ 数据/ ,/ 当/ 图像/ 质量/ 较/ 好/ ,/ 肝脏/ 与/ 周边/ 区域/ 有着/ 明显/ 的/ 界线/ 时/ ,/ 可/ 达到/ 很/ 好/ 的/ 分割/ 结果/ ,/ 但是/ 当/ 肝脏/ 边界/ 模糊/ ,/ 肝脏/ 区域/ 成像/ 质量/ 较差/ 时/ ,/ 仍然/ 不能/ 有效/ 地/ 分割/ 肝脏/ ./ 本文/ 算法/ 的/ 优势/ 在于/ 同时/ 兼顾/ 了/ 图像/ 实际/ 数据/ 与/ 先验/ 形状/ 信息/ ,/ 在/ 处理/ 模糊/ 边界/ 和/ 低质量/ 图像/ 时/ ,/ 先验/ 信息/ 具有/ 一定/ 的/ 导向/ 作用/ ,/ 再/ 结合/ 图像/ 实际/ 数据/ ,/ 从而/ 实现/ 肝脏/ 的/ 精确/ 分割/ ./ 互/ 修复/ 分割/ 错误/ ,/ 最终/ 使/ 分割/ 结果/ 逼近/ 最优/ 值/ ./ 肝脏/ 分割/ 的/ 最优/ 值/ 搜索/ 进程/ 如图/ 9/ 所示/ ,/ 分别/ 展示/ 了/ 肝脏/ 分割/ 的/ “/ 金/ 标准/ ”/ ,/ 初始化/ 区域/ ,/ 第/ 1/ 次/ 、/ 50/ 次/ 、/ 最后/ 一次/ 的/ MRF/ 分割/ 结果/ 和/ 形状/ 稀疏/ 表示/ 修正/ 结果/ ./ 为了/ 便于/ 观察/ 迭代/ 过程/ 中/ 分割/ 结果/ 的/ 变化/ ,/ 将/ 分割/ 的/ 中间/ 结果/ 与/ 金/ 标准/ 绘/ 在/ 一个/ 空白/ 图中/ ,/ 黑色/ 区域/ 为/ “/ 金/ 标准/ ”/ ,/ 灰色/ 区域/ 为/ 当前/ 分割/ 结果/ ./ 由图/ 9/ 可/ 看出/ ,/ 随着/ 搜索/ 进程/ 的/ 进行/ ,/ 肝脏/ 分割/ 结果/ 逐渐/ 逼近/ “/ 金/ 标准/ ”/ ./ 域/ ./ 在/ 人工/ 分割/ 肝脏/ 得到/ “/ 金/ 标准/ ”/ 时/ ,/ 受/ 主观因素/ 和/ 其他/ 因素/ 干扰/ ,/ “/ 金/ 标准/ ”/ 未必/ 是/ 100/ %/ 准确/ 的/ ,/ 本文/ 所提/ 算法/ 的/ 分割/ 精度/ 在/ 某些/ 局部/ 位置/ 甚至/ 优于/ 手动/ 分割/ 结果/ ./ Page10/ 图/ 10/ 本文/ 算法/ 实验/ 结果/ (/ 第/ 1/ 列为/ “/ 金/ 标准/ ”/ ,/ 第/ 2/ 列为/ 本文/ 所提/ 算法/ 分割/ 结果/ ,/ 第/ 3/ 列为/ 分割/ 结果/ 与/ “/ 金/ 标准/ ”/ 重合/ 区域/ )/ 稀疏/ 表示/ 的/ 修正/ 精度/ 受/ 字典/ 影响/ ,/ 当/ 字典/ 中/ 不/ 包含/ 输入/ 形状/ 时/ ,/ 将/ 可能/ 产生/ 修正/ 错误/ ,/ 如图/ 12/ 所示/ ./ 因/ 某种原因/ ,/ 病人/ 的/ 肝脏/ 有/ 部分/ 切除/ ,/ 当/ 字典/ 中/ 不/ 包含/ 此/ 类型/ 的/ 肝脏/ 时/ ,/ 稀疏/ 表示/ 将/ 不能/ 准确/ 修正/ 肝脏/ ./ 手动/ 分割/ 此类/ 非常规/ 的/ 肝脏/ 形状/ ,/ 将/ 其/ 添加/ 到/ 字典/ 库中/ ,/ 再次/ 利用/ 稀疏/ 表示/ 修正图/ 11/ (/ a/ )/ 的/ 肝脏/ 形状/ ,/ 得到/ 如图/ 12/ (/ b/ )/ 的/ 修正/ 结果/ ,/ 与/ 图/ 12/ (/ a/ )/ 的/ “/ 金/ 标准/ ”/ 比较/ 可/ 已/ 看出/ ,/ 添加/ 形状/ 实例/ 后/ ,/ 形状/ 稀疏/ 表示/ 可/ 有效/ 修正/ 此类/ 非常规/ 肝脏/ 形状/ ./ 利用/ 肝脏/ 分割/ 结果/ 与/ “/ 金/ 标准/ ”/ 的/ 重合/ 率/ 作为/ 算法/ 分割/ 精度/ 的/ 衡量标准/ ,/ 如式/ (/ 2/ )/ 所示/ ./ 取/ 测试/ 库中/ 所有/ 样本/ 的/ 分割/ 结果/ 与/ “/ 金/ 标准/ ”/ 重合/ 率/ 的/ 均值/ ,/ 如表/ 1/ 所示/ ,/ 本文/ 所提/ 算法/ 的/ 分割/ 精度/ 明显/ 高于/ 对比/ 算法/ ./ 在/ 本文/ 实验/ 中/ ,/ 对比/ 算法/ 分割/ 精度/ 较/ 低/ ,/ 是因为/ 本文/ 所/ 选择/ 的/ 数据库/ 中/ 包含/ 较/ 多/ 边界/ 模糊/ 、/ 图像/ 质量/ 差/ 的/ CT/ 图像/ ,/ 以/ 验证/ 本文/ 算法/ 的/ 鲁棒性/ ./ 将/ 测试数据/ 集中/ 每/ 一个/ 患者/ 的/ CT/ 序列/ 图像/ 定义/ 为/ 一个/ 样本/ 单元/ ,/ 取样/ 本/ 单元/ 中/ 所有/ 图像/ 的/ 平均/ 分割/ 重合/ 作为/ 测试/ 样本/ 单元/ 的/ 评价/ 准则/ ,/ 本文/ 所提/ 算法/ 在/ 每/ 一个/ 样本/ 单元/ 中/ 的/ 平均/ 分割/ 精度/ 如图/ 13/ 所示/ ./ 基于/ 最优/ 值/ 搜索/ 框/ 的/ 肝脏/ 分割/ 算法/ ,/ 将/ 肝脏/ 分割/ 问题/ 转化成/ 搜索/ 方程/ 的/ 最优/ 值/ 问题/ ,/ 肝脏/ 的/ 分割/ 结果/ 在/ 搜索/ 步骤/ 中/ 逐渐/ 逼近/ 最优/ 值/ ,/ 如图/ 14/ 所示/ ./ 图/ 14/ 肝脏/ 平均/ 分割/ 精度/ 随/ 搜索/ 进行/ 的/ 变化/ Page11/ 在/ 提高/ 肝脏/ 分割/ 精度/ 的/ 同时/ 应该/ 兼顾/ 算法/ 的/ 时间/ 复杂度/ ,/ 分割/ 精度/ 与/ 时间/ 复杂度/ 同等/ 重要/ ./ 本文/ 所提/ 算法/ 的/ 先验/ 信息提取/ 部分/ 在/ 分割/ 任务/ 运行/ 前/ 已/ 做好/ 准备/ 工作/ ,/ 在/ 分割/ 时/ 不/ 占用/ CPU/ 时间/ ./ 正式/ 分割/ 前/ 的/ 图像/ 归一化/ 与/ 肝脏/ 区域/ 初始化/ 的/ 计算/ 量/ 也/ 极小/ ./ 虽然/ 基于/ MRF/ 的/ 图像/ 分割/ 算法/ 运算/ 复杂/ ,/ 但/ 利用/ MRF/ 在/ 修改/ 局部/ 分割/ 结果/ 时/ ,/ 只/ 在/ 轮廓/ 边缘/ 的/ 邻域/ 内/ 进行/ 调整/ ,/ 处理/ 的/ 数据量/ 小/ ./ 形状/ 稀疏/ 表示/ 方程/ 是/ 一个/ NP/ -/ Hard/ 问题/ ,/ 并且/ 维数/ 较/ 高/ ,/ 因此/ 本文/ 所提/ 算法/ 的/ 时间/ 复杂度/ 主要/ 受/ 形状/ 稀疏/ 部分/ 的/ 影响/ ./ 迭代/ 优化/ 模型/ 的/ 一个/ 重要/ 分析/ 要素/ 就是/ 收敛性/ ./ 本文/ 建立/ 的/ 迭代/ 优化/ 模型/ 以/ MAP/ -/ MRF/ 和/ 形状/ 稀疏/ 表示/ 为/ 实现/ 工具/ ,/ 利用/ ICM/ 实现/ 基于/ MRF/ 的/ 图像/ 分割/ 算法/ 是/ 收敛/ 的/ ,/ 基于/ 混合/ 粒子/ 群/ 算法/ 的/ 稀疏/ 表示/ 方程/ 求解/ 也/ 是/ 收敛/ 的/ ./ 所以/ 两种/ 收敛/ 的/ 模型/ 以/ 线性组合/ 的/ 形式/ 建立/ 起/ 的/ 新/ 模型/ 也/ 是/ 收敛/ 的/ ./ 为/ 迭代/ 步骤/ 102030405060708090100/ 表/ 2/ 迭代/ 进程/ 变化率/ 样本/ 517.7214/ ./ 0511.027/ ./ 823.411/ ./ 271.030/ ./ 810.890/ ./ 94/ 肝脏/ 分割/ 的/ 变化率/ 变小/ 主要/ 由/ 以下/ 两/ 方面/ 因素/ 引起/ :/ (/ 1/ )/ 肝脏/ 区域/ 面积/ 逐渐/ 变/ 大/ ,/ 改变/ 部分/ 所/ 引起/ 的/ 数据/ 变化/ 越来越/ 小/ ./ (/ 2/ )/ 当/ 分割/ 进程/ 达到/ 一定/ 程度/ ,/ 肝脏/ 分割/ 的/ 改变/ 越来越/ 小/ ,/ 最终/ 肝脏/ 的/ 改变/ 和/ 形状/ 约束/ 达到/ 平衡/ 状态/ ,/ 从而/ 使/ 肝脏/ 分割/ 的/ 改变/ 率/ 稳定/ 在/ 一个/ 很小/ 的/ 值/ ./ 为了/ 提高/ 计算/ 效率/ ,/ 我们/ 采用/ 多核/ 编程技术/ 实现/ 本文/ 所提/ 算法/ 的/ 并行/ 运行/ ./ 将/ 肝脏/ 轮廓/ 的/ 邻域/ 等/ 面积/ 划分/ ,/ 采用/ 4/ 个/ 线程/ 实现/ MRF/ 驱动/ 形状/ 改变/ 的/ 功能/ ./ 形状/ 稀疏/ 表示/ 的/ 求解/ 部分/ 将/ 粒子/ 划分/ ,/ 同样/ 使用/ 4/ 个/ 线程/ 遍历/ 最优/ 值/ ./ 如此一来/ ,/ 在/ 提高/ 分割/ 精度/ 的/ 同时/ ,/ 不/ 影响/ 肝脏/ 分割/ 的/ 工作效率/ ./ 实验/ 测试/ 所/ 使用/ 的/ 计算机硬件/ 配置/ 为/ :/ Corei7/ -/ 47703.40/ GHz/ ,/ 8GB/ 内存/ ,/ 100/ 个/ 测试/ 样本/ 单元/ 的/ 各个/ 模块/ 的/ 平均/ 运行/ 时间/ 如表/ 3/ 所示/ ,/ 算法/ 运算/ 的/ 时间/ 可/ 控制/ 在/ 35s/ 左右/ ./ 了/ 验证/ 本文/ 所提/ 算法/ 的/ 收敛性/ ,/ 我们/ 又/ 跟踪/ 计算/ 了/ 迭代/ 修正/ 后/ 肝脏/ 分割/ 结果/ 的/ 变化率/ ./ 变化率/ 计算/ 如/ 公式/ 其中/ ,/ t/ 表示/ 迭代/ 步骤/ ,/ p/ 表示/ 计算/ 步长/ ,/ St/ 、/ St/ +/ p/ 分别/ 表示/ 迭代/ 前后/ 的/ 两种/ 肝脏/ 分割/ 结果/ ,/ St/ / St/ +/ p/ 表示/ St/ 与/ St/ +/ p/ 的/ 未/ 重叠/ 区域/ 面积/ ,/ St/ ∪/ St/ +/ p/ 表示/ St/ 与/ St/ +/ p/ 并集/ 区域/ 面积/ ./ 当/ St/ 与/ St/ +/ p/ 完全相同/ 时/ ,/ C/ =/ 0/ ;/ 当/ St/ 与/ St/ +/ p/ 完全/ 不/ 相同/ 时/ ,/ C/ =/ 100/ %/ ./ 利用/ 10/ 组/ 数据测试/ 本文/ 所提/ 算法/ 的/ 收敛性/ ,/ 每组/ 数据/ 由/ 100/ 幅/ 包含/ 肝脏/ 的/ CT/ 图像/ 组成/ ,/ 以/ 每/ 10/ 个/ 迭代/ 步骤/ 为/ 一个/ 统计/ 步长/ ,/ 计算/ 样本/ 中/ 所有/ 个体/ 变化率/ 的/ 均值/ ,/ 测试/ 结果/ 如表/ 2/ 所示/ ./ 结合/ 图/ 14/ ,/ 实验/ 结果表明/ ,/ 在/ 随着/ 分割/ 进程/ 的/ 进行/ ,/ 肝脏/ 分割/ 的/ 变化率/ 逐渐/ 变小/ ,/ 并且/ 趋于稳定/ ./ 样本/ 614.1512/ ./ 349.366/ ./ 813.071/ ./ 250.890/ ./ 920.911/ ./ 05/ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ 肝脏/ 分割/ 算法/ ,/ 利用/ 迭代/ 步骤/ 使/ 分割/ 结果/ 逐步/ 逼近/ 最优/ 值/ ,/ 其/ 带来/ 的/ 问题/ 是/ 计算/ 量/ 较大/ ,/ 以/ 增大/ 运算量/ 为/ 代价/ ,/ 提高/ 了/ 肝脏/ 分割/ 的/ 精度/ ,/ 并/ 利用/ 多线程/ 编程技术/ 克服/ 了/ 运算量/ 大/ 的/ 缺陷/ ./ 7/ 结论/ 和/ 讨论/ 文中/ 介绍/ 了/ 一种/ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ 肝脏/ 分割/ 算法/ ,/ 输入/ CT/ 图像/ 中/ 的/ 肝脏/ 分割/ 结果/ 是/ 优化/ 的/ 目标/ ./ 利用/ 图像/ 是/ 数据/ 的/ 内部/ 能量/ 驱动/ 目标/ 移动/ ,/ 并/ 依据/ 外力/ 对/ 目标/ 的/ 运动/ 进行/ 约束/ ,/ 最终/ 使/ 目标/ 逼近/ 肝脏/ 分割/ 的/ 最优/ 值/ ./ 利用/ MRF/ 作为/ 描述/ 驱动/ 目标/ Page12/ 运动/ 内力/ 的/ 工具/ ,/ 选取/ 先验/ 形状/ 信息/ 作为/ 目标/ 运动/ 的/ 外部/ 约束力/ ,/ 并/ 以/ 形状/ 稀疏/ 表示/ 约束/ 目标/ 的/ 运动/ ./ 然而/ ,/ 这/ 并/ 不是/ 实现/ 利用/ 最优/ 值/ 搜索/ 框架/ 分割/ 肝脏/ 的/ 唯一/ 实现/ 方式/ ./ 图像/ 的/ 内力/ 是/ 图像/ 真实/ 数据/ 所/ 蕴含/ 的/ 能/ 驱动/ 搜索/ 位置/ 不断/ 改变/ 的/ 能量/ ,/ 任何/ 一种/ 有效/ 描述/ 图像/ 数据/ 的/ 方式/ 均/ 有/ 可能/ 成为/ 驱动/ 目标/ 运动/ 的/ 实现/ 工具/ ,/ 如/ GMM/ 等/ ./ 图像/ 的/ 外力/ 也/ 不仅仅/ 只有/ 先验/ 形状/ 信息/ ,/ 任何/ 一种/ 可用/ 来/ 约束/ 肝脏/ 分割/ 进程/ ,/ 防止出现/ 各种/ 错误/ 的/ 准则/ 均/ 可/ 作为/ 外部/ 约束力/ ./ 实验/ 和/ 分析表明/ ,/ 本文/ 所提/ 算法/ 具有/ 较/ 高/ 的/ 分割/ 精度/ ,/ 尤其/ 是/ 能/ 准确/ 处理/ 肝脏/ 的/ 模糊/ 边缘/ 和/ 肝脏/ 临近/ 干扰/ 区域/ 的/ 影响/ ./ 本文/ 所提/ 的/ 算法/ 以/ 最优/ 值/ 搜索/ 框架/ 为/ 基础/ ,/ 多次/ 的/ 迭代/ 搜索/ 会/ 增大/ 算法/ 的/ 时间/ 复杂度/ ./ 医学/ 图像处理/ 一般/ 对/ 时间/ 具有/ 一定/ 的/ 容忍度/ ,/ 而/ 对/ 处理/ 精度/ 敏感/ ./ 因此/ ,/ 我们/ 提出/ 的/ 基于/ 最优/ 值/ 搜索/ 框架/ 的/ 肝脏/ 分割/ 算法/ 以/ 牺牲/ 运算/ 的/ 时间/ 复杂度/ 为/ 代价/ ,/ 换取/ 肝脏/ 分割/ 精度/ 的/ 提高/ ./ 我们/ 期待/ 能/ 有/ 研究/ 人员/ 在/ 此/ 框架/ 的/ 基础/ 上/ ,/ 提出/ 更好/ 更/ 高效/ 的/ 实现/ 方法/ ,/ 进一步提高/ 肝脏/ 分割/ 算法/ 的/ 分割/ 精度/ 、/ 泛化/ 能力/ 和/ 运算/ 效率/ ./ 致谢/ 特别感谢/ 山东/ 肿瘤医院/ 放射治疗/ 科对/ 本文/ 研究/ 工作/ 提供/ 的/ 宝贵意见/ !/ 

