Page1/ 一种/ 构造/ 并发/ 不可/ 延展/ 零/ 知识/ 的/ 新/ 方法/ 李睿/ 徐秋亮/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 摘要/ 构造/ 了/ 一个/ 新/ 的/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 论证/ 系统/ ,/ 具有/ 更好/ 的/ 鲁棒性/ ./ 新/ 方案/ 基于/ Feige/ -/ Shamir/ 结构/ 而/ 设计/ ,/ 以/ 具有/ 鲁棒性/ 的/ 不可/ 延展/ 承诺/ 方案/ 以及/ 巧妙/ 设计/ 的/ 证据/ 不可/ 区分/ 性/ 证明/ 为/ 基本/ 组件/ ,/ 来/ 实现/ 并发/ 不可/ 延展性/ 和/ 鲁棒性/ ./ 此外/ ,/ 对/ 敌手/ 视图/ 的/ 模拟/ 借助/ 了/ “/ 茫然/ 模拟/ ”/ 的/ 策略/ ./ 当/ 与/ 其它/ 协议/ 并发/ 组合/ 时/ ,/ 该/ 方案/ 更/ 易于/ 分析/ 和/ 应用/ ./ 基于/ 单向/ 函数/ 假设/ ,/ 该/ 方案/ 的/ 轮/ 复杂性/ 为/ 超/ 对数/ ./ 关键词/ 零/ 知识/ ;/ 并发/ 不可/ 延展性/ ;/ 鲁棒性/ ;/ 单向/ 函数/ 假设/ ;/ 茫然/ 模拟/ 1/ 引言/ 交互/ 证明/ 系统/ [/ 1/ ]/ 是/ 现代/ 密码学/ 的/ 一个/ 基本/ 组件/ ,/ 自其/ 提出/ 以来/ 一直/ 受到/ 广泛/ 的/ 关注/ ./ 零/ 知识/ 证明/ 系统/ 最具/ 吸引力/ 的/ 性质/ 在于/ 它/ 能够/ 使/ 一个/ 参与方/ P/ (/ 称/ Goldwasser/ 、/ Micali/ 和/ Rackoff/ 提出/ 的/ 零/ 知识/ 为/ 证明/ 者/ )/ 向/ 另/ 一个/ 参与方/ V/ (/ 称为/ 验证/ 者/ )/ 证明/ 一/ Page2/ 并发/ 零/ 知识/ [/ 2/ -/ 7/ ]/ 在/ 一个/ 更/ 现实/ 的/ 环境/ (/ 并发/ 、/ 异步/ 的/ 网络/ 环境/ )/ 中/ 讨论/ 零/ 知识/ 证明/ 系统/ 的/ 安全性/ ,/ 它/ 允许/ 敌手/ 作为/ 验证/ 者/ 与/ 多个/ 证明/ 者/ 并发/ 地/ 执行/ 协议/ ,/ 并/ 在/ 多个/ 进程/ 之间/ 协调/ 自己/ 的/ 攻击行为/ ./ Dolev/ 、/ Dwork/ 和/ Naor/ 等/ 人/ 在/ 文献/ [/ 8/ ]/ 中/ 提出/ 了/ 零/ 知识/ 证明/ 的/ 另外/ 一种/ 并发/ 安全性/ ,/ 称为/ 不可/ 延展性/ (/ non/ -/ malleability/ )/ ,/ 描述/ 零/ 知识/ 证明/ 系统/ 抵抗/ 中间人/ 攻击/ 的/ 能力/ ./ 即/ 在/ 协议/ 的/ 两次/ 并发/ 执行/ 中/ ,/ 敌手/ 一方面/ 作为/ 验证/ 者/ 与/ 一个/ 诚实/ 的/ 证明/ 者/ 交互/ ,/ 验证/ 其/ 对/ 某个/ 声明/ 的/ 证明/ 过程/ (/ 称为/ 左侧/ 会话/ )/ ;/ 另一方面/ 作为/ 证明/ 者/ 与/ 一个/ 诚实/ 的/ 验证/ 者/ 交互/ ,/ 试图/ 证明/ 一个/ 相关/ 的/ 声明/ (/ 称为/ 右侧/ 会话/ )/ ./ 此后/ ,/ Pass/ 等/ 人/ [/ 9/ ]/ 提出/ 了/ 一个/ 类似/ 的/ 性质/ 称为/ 模拟/ 可/ 抽取/ (/ simulation/ -/ extractability/ )/ ,/ 其/ 安全性/ 定义/ 强于/ 不可/ 延展性/ 但/ 便于/ 应用/ ./ 简言之/ ,/ 一个/ 交互/ 证明/ 系统/ 称为/ 模拟/ 可/ 抽取/ 的/ ,/ 如果/ 存在/ 一个/ 模拟/ 抽取/ 器/ S/ 能够/ 模拟/ 中间人/ 敌手/ A/ 在/ 左右/ 两侧/ 执行/ 过程/ 中/ 的/ 视图/ ,/ 同时/ 抽取/ 出/ A/ 在/ 右侧/ 证明/ 中/ 所/ 使用/ 的/ 证据/ ./ 本文/ 主要/ 关注/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ (/ Concur/ -/ rentNon/ -/ MalleableZero/ -/ Knowledge/ ,/ CNMZK/ )/ 论证/ 协议/ ,/ 即/ 考虑/ 一个/ 概率/ 多项式/ 时间/ (/ 以下/ 简称/ PPT/ )/ 的/ 敌手/ 同时/ 参与/ m/ 个/ 左侧/ 会话/ 以及/ m/ 个/ 右侧/ 会话/ (/ m/ 为/ 安全/ 参数/ 的/ 多项式/ )/ ./ 普遍认为/ ,/ 在/ 此/ 背景/ 下/ 协议/ 的/ 安全性/ 最/ 能够/ 反映/ 其/ 在/ 开放/ 网络/ 中/ 的/ 执行/ 情况/ ./ 项/ 声明/ (/ statement/ )/ 的/ 正确性/ (/ 例如/ ,/ x/ ∈/ L/ ,/ 其中/ L/ 是/ 一个/ NP/ 语言/ )/ ,/ 而/ 不/ 泄露/ 任何/ 额外/ 的/ 信息/ ./ 这种/ 性质/ 通常/ 形式化/ 地/ 描述/ 为/ :/ 存在/ 一个/ 高效/ 的/ 模拟器/ S/ 使得/ 对/ 任意/ 的/ 恶意/ 验证/ 者/ V/ / ,/ 模拟器/ S/ (/ 内部/ 调用/ V/ / )/ 能够/ 模拟/ 协议/ 执行/ 的/ 过程/ ,/ 并且/ S/ 的/ 输出/ 与/ 协议/ 真实/ 执行/ 时/ 的/ 输出/ 计算/ 不可/ 区分/ ./ 文献/ [/ 10/ ]/ 中/ ,/ Barak/ 等/ 人/ 以/ 模拟/ 可/ 抽取/ 的/ 定义/ 方式/ 重新/ 给出/ 了/ CNMZK/ 的/ 明确/ 定义/ ,/ 并/ 首次/ 提出/ 了/ 平凡/ 模型/ 下/ CNMZK/ 论证/ 系统/ 的/ 构造方法/ ./ 基于/ 单向/ 函数/ 假设/ ,/ 该/ 协议/ 的/ 轮/ 复杂性/ 为/ 多项式/ ,/ 若/ 基于/ 抗/ 碰撞/ Hash/ 函数/ 假设/ ,/ 其轮/ 复杂性/ 可降/ 为/ 珟/ O/ (/ logn/ )/ ./ 此后/ ,/ Ostrovsky/ 等/ 人/ [/ 11/ ]/ 在/ DDH/ 假设/ 下/ 给出/ 了/ 上述/ 协议/ 的/ 高效/ 实现/ 方法/ ./ 然而/ 以上/ 两个/ 协议/ 仅/ 具有/ 计算/ 可靠性/ ./ 近期/ ,/ Lin/ 等/ 人/ [/ 12/ ]/ 提出/ 了/ 一种/ 实现/ CNMZK/ 的/ 新/ 方法/ ,/ 并且/ 构造/ 了/ 第一个/ CNMZK/ 证明/ 系统/ ./ 基于/ 单向/ 函数/ 假设/ 或者/ 抗/ 碰撞/ Hash/ 函数/ 假设/ ,/ 其轮/ 复杂性/ 分别/ 为/ 多项式/ 和/ 珟/ O/ (/ logn/ )/ ./ 若仅/ 考虑/ 计算/ 可靠性/ ,/ 该/ 证明/ 系统/ 还/ 可/ 转化/ 为/ 基于/ 单向/ 函/ 值得一提的是/ ,/ 该/ 协议/ 的/ 设计/ 方式/ 源于/ 著名/ 的/ Goldreich/ -/ Kahan/ 零/ 知识/ 证明/ 系统/ [/ 13/ ]/ ./ 此外/ ,/ 其它/ 一些/ 文献/ 在/ 相对/ (/ 平凡/ 模型/ )/ 较弱/ 的/ 模型/ 下/ 讨论/ 了/ 抵抗/ 并发/ 中间人/ 攻击/ 的/ 零/ 知识/ 证明/ 系统/ ./ 例如/ ,/ 借助于/ 可信/ 的/ 系统/ 建立/ 假设/ (/ 如/ 公共/ 引用/ 串/ [/ 14/ ]/ )/ ,/ 或者/ 全局/ 可/ 访问/ 的/ “/ 公告牌/ ”/ (/ 如裸公钥/ 模型/ [/ 15/ -/ 16/ ]/ )/ ,/ 或者/ 引入/ 其它/ 的/ 安全性/ 框架/ (/ 如超/ 多项式/ 时间/ 模拟/ [/ 17/ ]/ )/ ./ 然而/ ,/ 本文/ 仅/ 关注/ 平凡/ 模型/ 下/ 的/ 并发/ 不可/ 延展性/ ./ (/ 1/ )/ 研究/ 动机/ 零/ 知识/ 证明/ 和/ 承诺/ 协议/ 的/ 研究/ 是/ 紧密联系/ 、/ 相互促进/ 的/ ./ 并发/ 不可/ 延展/ 零/ 知识/ 的/ 一个/ 潜在/ 应用/ 在于/ 构造/ 打开/ 阶段/ 并发/ 不可/ 延展/ (/ concurrentnon/ -/ mallealew/ ./ r/ ./ tdecommitment/ )/ 的/ 承诺/ 协议/ ./ 近期/ ,/ Ostrovsky/ 等/ 人/ [/ 18/ ]/ 以及/ Cao/ 等/ 人/ [/ 19/ ]/ 在/ 对/ 承诺/ 方案/ 的/ 并发/ 不可/ 延展性/ 研究/ 中/ 指出/ ,/ 已有/ 的/ 方案/ 存在/ 一个/ 共同/ 的/ 限制/ ,/ 即/ 其/ 承诺/ 阶段/ 和/ 打开/ 阶段/ 在/ 时间/ 上/ 不可/ 重叠/ ./ 其中/ 一个/ 主要/ 的/ 问题/ 在于/ ,/ 当/ 承诺/ 阶段/ 与/ 打开/ 阶段/ 作为/ 一个/ 整体/ 执行/ 时/ ,/ 两/ 阶段/ 需要/ 各自/ 保证/ 自己/ 的/ 安全性/ 需求/ ,/ 即/ 对/ 其中/ 一个/ 阶段/ 的/ 模拟/ 不能/ 影响/ 另/ 一/ 阶段/ 的/ 安全性/ ./ 该/ 性质/ 通常/ 称为/ 鲁棒性/ (/ 或/ 可/ 组合/ 性/ )/ ./ 在/ 已有/ 的/ 不可/ 延展/ 零/ 知识/ 协议/ 中/ ,/ 一部分/ 使用/ 了/ 非/ 黑盒/ 模拟/ 技术/ [/ 20/ ]/ ,/ 而/ 缺乏/ 鲁棒性/ 是非/ 黑盒/ 模拟/ 技术/ 内在/ 的/ 限制/ [/ 21/ ]/ ,/ 尤其/ 在/ 并发/ 环境/ 下/ ./ 此外/ ,/ 在/ 其它/ 黑盒/ CNMZK/ 证明/ (/ 论证/ )/ 系统/ 中/ ,/ 都/ 存在/ 一个零/ 知识/ 证明/ 子/ 协议/ ,/ 令其/ 鲁棒性/ 难于/ 讨论/ ./ 因此/ ,/ 构造/ 一个/ 在/ 并发/ 环境/ 下/ 具有/ 较/ 好/ 的/ 鲁棒性/ 的/ CNMZK/ 证明/ 系统对/ 解决/ 上述/ 问题/ 以及/ 其它/ 类似/ 的/ 应用/ ,/ 具有/ 重要/ 意义/ ./ (/ 2/ )/ 本文/ 的/ 贡献/ 本文/ 基于/ 著名/ 的/ Feige/ -/ Shamir/ 结构/ [/ 22/ ]/ 提出/ 了/ 一种/ 设计/ 并发/ 不可/ 延展/ 零/ 知识/ 论证/ 系统/ 的/ 新/ 方法/ ,/ 以/ 巧妙/ 设计/ 的/ 证据/ 不可/ 区分/ 证明/ 来/ 代替/ 零/ 知识/ 证明/ 子/ 协议/ ,/ 以及/ 文献/ [/ 23/ ]/ 提出/ 的/ 鲁棒/ 的/ 不可/ 延展/ 承诺/ 方案/ 来/ 实现/ 整个/ 协议/ 的/ 不可/ 延展性/ ./ 另一方面/ ,/ 本文/ 对/ 敌手/ 视图/ 的/ 模拟/ 采用/ 了/ “/ 茫然/ 模拟/ ”/ 的/ 策略/ [/ 3/ -/ 5/ ]/ ,/ 并/ 借助/ 文献/ [/ 12/ ]/ 的/ 证明/ 方法/ 来/ 分析/ 模拟/ 的/ 不可/ 区分/ 性/ ./ 由于/ 证据/ 不可/ 区分/ 性/ 在/ 并发/ 组合/ 下/ 封闭/ ,/ 承诺/ 子/ 协议/ 是/ 鲁棒/ 的/ ,/ 并且/ 模拟/ 策略/ 是/ 茫然/ 的/ ,/ 因此/ 当/ 与/ 其它/ 协议/ 并发/ 组合/ 时/ ,/ 本文/ 的/ 方案/ 更/ 易于/ 分析/ 和/ 应用/ ./ 与/ 文献/ [/ 12/ ]/ 相同/ ,/ 本文/ 的/ 方案/ 在/ 单向/ 函数/ 假设/ 下/ 的/ 轮/ 复杂性/ 为/ 珟/ O/ (/ logn/ )/ ./ Page32/ 预备/ 知识/ 令/ N/ 表示/ 正整数/ 的/ 集合/ ,/ 对于/ 任意/ n/ ∈/ N/ ,/ 令/ [/ n/ ]/ 表示/ 集合/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ./ 令/ {/ 0/ ,/ 1/ }/ n/ 表示/ 所有/ 长度/ 为/ n/ 比特/ 的/ 字符串/ 集合/ ,/ {/ 0/ ,/ 1/ }/ / 表示/ 所有/ 字符串/ 的/ 集合/ ./ 对于/ 任意/ NP/ 语言/ L/ ,/ 令/ RL/ 表示/ L/ 对应/ 的/ 证据/ 关系/ ./ 函数/ μ/ :/ N/ →/ {/ 0/ ,/ 1/ }/ 称为/ 可/ 忽略/ 的/ ,/ 如果/ 对/ 任意/ 正/ 多项式/ p/ 以及/ 足够/ 大/ 的/ n/ ∈/ N/ ,/ μ/ (/ n/ )/ </ 1/ // p/ (/ n/ )/ ./ 两个/ 概率/ 总体/ 称为/ 计算/ 不可/ 区分/ 的/ (/ 记/ 为/ ≈/ c/ )/ ,/ 如果/ 不/ 存在/ 概率/ 多项式/ 时间/ ,/ 图灵机/ 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 它们/ ./ 详细/ 的/ 定义/ 请参阅/ 文献/ [/ 24/ ]/ ./ 2.1/ 证据/ 不可/ 区分/ 性及/ 特殊/ 可靠性/ 不/ 严格/ 地/ 讲/ ,/ 一个/ 交互/ 证明/ 系统/ 称为/ 证据/ 不可/ 区分/ 的/ (/ WitnessIndistinguishable/ ,/ WI/ )/ [/ 25/ ]/ ,/ 如果/ 证明/ 者/ 使用/ 不同/ 的/ 证据/ 执行/ 两次/ 协议/ ,/ 而/ 验证/ 者/ 无法/ 区分/ 这/ 两次/ 执行/ ./ 值得一提的是/ ,/ 证据/ 不可/ 区分/ 性/ 在/ 并发/ 组合/ 下/ 是/ 封闭/ 的/ ./ 对/ 某项/ 声明/ x/ ∈/ L/ ,/ 称/ 一个/ k/ 轮/ 公开/ 投币/ 的/ 交互/ 证明/ 系统/ 具有/ 特殊/ 可靠性/ (/ SpecialSoundness/ ,/ SS/ )/ [/ 26/ ]/ ,/ 如果/ 给定/ 一个/ 随机/ 生成/ 的/ 长度/ 为/ (/ k/ -/ 2/ )/ 的/ 消息/ 前缀/ (/ 记/ 为/ α/ )/ ,/ 以及/ 在/ 该/ 前缀/ 下/ 两个/ 接受/ 的/ 证明/ 副本/ ,/ 存在/ 概率/ 多项式/ 时间/ 的/ 知识/ 抽取/ 器/ 能够/ 抽取/ x/ ∈/ L/ 对应/ 的/ 证据/ ./ WISS/ 证明/ 系统/ 一个/ 常见/ 的/ 例子/ 是/ Blum/ 提出/ 的/ 对/ 哈密顿/ 回路/ 问题/ 的/ 证明/ 系统/ [/ 27/ ]/ ./ 若/ 将/ Blum/ 协议/ 中/ 的/ 承诺/ 方案/ 初始化/ 为/ 基于/ 单向/ 置换/ 的/ 统计/ 绑定/ 承诺/ ,/ 那么/ 该/ 协议/ 仅/ 需/ 3/ 轮/ ./ 或者/ 将/ 上述/ 承诺/ 方案/ 替换/ 为/ Naor/ 提出/ 的/ 两轮/ 统计/ 绑定/ 承诺/ 方案/ [/ 28/ ]/ ,/ 可/ 得到/ 4/ 轮/ 的/ 基于/ 单向/ 函数/ 假设/ 的/ WISS/ 证明/ 系统/ ./ 2.2/ 不可/ 延展/ 的/ 承诺/ 方案/ 承诺/ 方案/ 是/ 在/ 两个/ 参与者/ 之间/ 进行/ 的/ 两/ 阶段/ 交互/ 协议/ ,/ 其中/ 两名/ 参与者/ 分别/ 称为/ 承诺/ 者/ (/ 或/ 发送者/ )/ 和/ 接收者/ ./ 在/ 承诺/ 阶段/ ,/ 承诺/ 者/ 对/ 一个/ 值/ v/ 承诺/ ,/ 并/ 确保/ v/ 在/ 整个/ 承诺/ 阶段/ 的/ 保密性/ ./ 随后/ 在/ 打开/ 阶段/ ,/ 承诺/ 者/ 公开/ v/ ,/ 并/ 证明/ 其/ 与/ 承诺/ 阶段/ 的/ 一致性/ ./ 承诺/ 方案/ 的/ 两个/ 基本/ 性质/ 称为/ 隐藏/ 性/ 和/ 绑定/ 性/ ./ 简言之/ ,/ 隐藏/ 性是/ 指/ 在/ 承诺/ 阶段/ 任何/ 恶意/ 的/ 接收者/ 都/ 不能/ 获取/ 关于/ v/ 的/ 信息/ ,/ 而/ 绑定/ 性是/ 指/ 在/ 打开/ 阶段/ 任何/ 恶意/ 的/ 承诺/ 者/ 都/ 不能/ 将/ v/ 成功/ 地/ 打开/ 为/ 另外/ 一个/ 值/ ./ 本文/ 中/ 涉及/ 的/ 承诺/ 方案/ 均/ 为/ 统计/ 绑定/ (/ 计算/ 隐藏/ )/ 的/ 承诺/ 方案/ ./ 对/ 不可/ 延展/ 承诺/ 的/ 定义/ 通常/ 通过/ 比较/ 该/ 承诺/ 方案/ 在/ 中间人/ 攻击/ 下/ 的/ 执行/ 过程/ 和/ 模拟/ 的/ 执行/ 过程/ 来/ 形式化/ 地/ 描述/ ./ 本文/ 引用/ 文献/ [/ 9/ ]/ 给出/ 的/ 基于/ 模拟/ 的/ 不可/ 延展性/ 定义/ ,/ 但/ 采用/ 一种/ 不同/ 的/ 形式/ [/ 29/ ,/ 23/ ]/ (/ 与/ 原/ 定义/ 等价/ )/ ./ 对于/ 承诺/ 方案/ 〈/ C/ ,/ R/ 〉/ 和/ 中间人/ 敌手/ A/ (/ 辅助输入/ 为/ z/ )/ ,/ 考虑/ 以下/ 执行/ 过程/ :/ 敌手/ A/ 作为/ 接收者/ 与/ 诚实/ 承诺/ 者/ C/ 交互/ ,/ 接收/ 承诺/ 者/ 对/ 一个/ 值/ v/ 的/ 承诺/ (/ 左侧/ 会话/ )/ ;/ 同时/ 作为/ 承诺/ 者/ 与/ 诚实/ 接收者/ R/ 交互/ ,/ 试图/ 对/ 一个/ 相关/ 的/ 值/ v/ ~/ 承诺/ (/ 右侧/ 会话/ )/ ./ 两次/ 执行/ 分别/ 关联/ 于/ 不同/ 的/ 会/ 话/ 标识/ ,/ 记为/ id/ 和/ id/ ~/ ,/ 均/ 由/ A/ 选定/ ./ 若/ 在/ 右侧/ 协议/ 中/ ,/ A/ 未能/ 构造/ 出/ 合法/ 的/ 承诺/ ,/ 或者/ id/ ~/ =/ id/ (/ A/ 直接/ 复制/ 了/ 左侧/ 的/ 会/ 话/ )/ ,/ v/ ~/ 的/ 值/ 默认/ 为/ ⊥/ ./ 令/ 随机变量/ mimA/ 述/ 执行/ 过程/ 中/ 的/ 视图/ 以及/ A/ 在/ 右侧/ 协议/ 中/ 承诺/ 的/ 值/ v/ ~/ ./ 定义/ 1/ ./ 称/ 一个/ 承诺/ 方案/ 〈/ C/ ,/ R/ 〉/ 为/ 不可/ 延展/ 的/ ,/ 如果/ 对/ 任意/ PPT/ 中间人/ 敌手/ A/ ,/ 以下/ 两个/ 概率/ 总体/ 计算/ 不可/ 区分/ {/ mimA/ ≈/ c/ {/ mimA/ 此外/ ,/ 称/ 一个/ 承诺/ 方案/ 为/ 初始/ 绑定/ 的/ ,/ 如果/ 承诺/ 者/ 的/ 第/ 1/ 条/ 消息/ 能够/ 唯一/ 确定/ 其/ 承诺/ 的/ 值/ v/ ./ 已有/ 的/ 承诺/ 方案/ (/ 以及/ 不可/ 延展/ 的/ 承诺/ 方案/ )/ 几乎/ 都/ 满足/ 该/ 性质/ ./ 2.3/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 本文/ 中/ ,/ 我们/ 引用/ 文献/ [/ 10/ ,/ 12/ ]/ 中/ 对/ 并发/ 不可/ 延展/ 零/ 知识/ 的/ 定义/ ./ 令/ 〈/ P/ ,/ V/ 〉/ 表示/ NP/ 语言/ L/ 的/ 交互/ 证明/ 系统/ ./ 对于/ PPT/ 中间人/ 敌手/ A/ (/ 辅助输入/ 为/ z/ ∈/ {/ 0/ ,/ 1/ }/ / )/ ,/ 考虑/ 以下/ 过程/ :/ A/ 作为/ 验证/ 者/ 与/ m/ (/ n/ )/ 个/ 诚实/ 证明/ 者/ {/ P1/ ,/ …/ ,/ Pm/ }/ 交互/ ,/ 验证/ 每个/ 证明/ 者/ Pi/ 对/ 声明/ xi/ ∈/ L/ 的/ 证明/ ;/ 同时/ 作为/ 证明/ 者/ 分别/ 与/ m/ (/ n/ )/ 个/ 诚实/ 验证/ 者/ {/ V1/ ,/ …/ ,/ Vm/ }/ 交互/ ,/ 试图/ 向/ 验证/ 者/ Vj/ 证明/ 一个/ 相关/ 的/ 声明/ x/ ~/ 会话/ 标识/ {/ id1/ ,/ …/ ,/ idm/ }/ ,/ 每个/ 右侧/ 会话/ 分别/ 关联/ 标识/ {/ id/ ~/ 侧待/ 证明/ 的/ 声明/ 均/ 由/ A/ 自/ 适应/ 地/ 选定/ ./ 令/ 随机变量/ viewA/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ 表示/ A/ 在/ 上述/ 执行/ 过程/ 中/ 的/ 视图/ ./ 定义/ 2/ ./ 对于/ 语言/ L/ ,/ RL/ 表示/ 其/ 证据/ 关系/ ,/ 一个/ 交互/ 证明/ 系统/ 〈/ P/ ,/ V/ 〉/ 称为/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 证明/ 系统/ ,/ 如果/ 对/ 任意/ 多项式/ m/ ,/ 任意/ PPT/ 中间人/ 敌手/ A/ ,/ 并发/ 地/ 参与/ m/ 个/ 左侧/ 会话/ 和/ m/ 个/ 右侧/ 会话/ ,/ 都/ 存在/ 一个/ PPT/ 的/ 机器/ S/ (/ 称为/ 模拟/ 抽取/ 器/ )/ ,/ 满足/ 1/ ,/ …/ ,/ id/ ~/ Page4/ (/ 2/ )/ 令/ x1/ ,/ …/ ,/ xm/ ∈/ L/ ∩/ {/ 0/ ,/ 1/ }/ n/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ (/ view/ ,/ ω/ )/ 表示/ S/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ 的/ 输出/ ,/ 以及/ 1/ ,/ …/ ,/ x/ ~/ x/ ~/ 明/ ./ 令/ id1/ ,/ …/ ,/ idm/ 以及/ id/ ~/ 话/ 和/ 右侧/ 会话/ 的/ 标识/ ./ 那么/ ,/ 对/ 任意/ 1/ / i/ / m/ ,/ 若/ 第/ i/ 个/ 右侧/ 证明/ 是/ 接受/ 的/ ,/ 并且/ id/ ~/ 左侧/ 标识/ idj/ (/ 1/ / j/ / m/ )/ ,/ 那么/ ω/ 包含/ 了/ 满足/ RL/ (/ x/ ~/ 3/ 新/ 的/ 并发/ 不可/ 延展/ 的/ i/ ,/ ω/ i/ )/ =/ 1/ 的/ 证据/ ω/ i/ ./ (/ 1/ )/ 对于/ 足够/ 大/ 的/ n/ ∈/ N/ ,/ 以下/ 两个/ 概率/ 总体/ 计算/ 不可/ 区分/ :/ {/ viewA/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ }/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ L/ ∩/ {/ 0/ ,/ 1/ }/ n/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ≈/ c/ {/ S1/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ }/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ L/ ∩/ {/ 0/ ,/ 1/ }/ n/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ./ 其中/ {/ S1/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ }/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ L/ ∩/ {/ 0/ ,/ 1/ }/ n/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / 表示/ S/ (/ n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ 的/ 第/ 1/ 个/ 输出/ ./ 零/ 知识/ 论证/ 协议/ 在/ 本节/ 中/ ,/ 我们/ 将/ 基于/ 单向/ 函数/ 假设/ 构造/ 一个/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 论证/ 协议/ ./ 首先/ 介绍/ 该/ 协议/ 的/ 基本/ 组件/ (/ 子/ 协议/ )/ ./ 3.1/ 并发/ 可/ 抽取/ 的/ 承诺/ 方案/ 并发/ 可/ 抽取/ 承诺/ (/ ConcurrentlyExtractableCommitment/ ,/ CECom/ )/ 的/ 概念/ 是/ 由/ Micciancio/ 等/ 人/ [/ 30/ ]/ 从/ 著名/ 的/ PRS/ 并发/ 零/ 知识/ 协议/ [/ 4/ ]/ 中/ 抽象/ 出来/ 的/ ./ 简言之/ ,/ 利用/ 此类/ 承诺/ 协议/ 承诺/ 的/ 字符串/ ,/ 可/ 由/ 模拟器/ 以重/ 绕/ 的/ 方式/ 、/ 黑盒/ 调用/ 承诺/ 者/ 来/ 并发/ 地/ 、/ 实时/ 地/ 抽取/ ./ 文献/ [/ 4/ ]/ 分析/ 指出/ ,/ CECom/ 的/ 交互/ 轮/ 复杂性/ 为/ 超/ 对数/ (/ super/ -/ logarithmic/ )/ ./ 令/ k/ (/ n/ )/ 为/ 一个/ 超/ 对数函数/ ./ 若/ 对/ 一个/ n/ 比特/ 字符串/ δ/ 承诺/ ,/ 在/ 承诺/ 阶段/ ,/ 承诺/ 者/ C/ 首先/ 选择/ 一个/ 初始/ 承诺/ 方案/ 记为/ Com/ ,/ 以及/ nk/ (/ n/ )/ 对/ n/ 比特/ 随机/ 串/ (/ α/ 0i/ ,/ j/ ,/ α/ 1i/ ,/ j/ )/ ,/ 其中/ i/ ∈/ [/ n/ ]/ ,/ j/ ∈/ [/ k/ (/ n/ )/ ]/ ,/ 满足/ 对/ 任意/ 的/ i/ 和/ j/ ,/ α/ 0i/ ,/ j/ / α/ 1i/ ,/ j/ =/ δ/ ./ 然后/ 承诺/ 者/ 利用/ Com/ 对/ δ/ 以及/ 所有/ 2nk/ (/ n/ )/ 个/ 字符串/ 承诺/ ./ 承诺/ 阶段/ 的/ 第/ 2/ 步/ 包含/ k/ (/ n/ )/ 个/ “/ 挑战/ -/ 应答/ ”/ 回合/ ./ 在/ 第/ j/ 个/ 回合/ 中/ ,/ 接收者/ 发送/ 一个/ 随机/ 的/ n/ 比特/ 挑战/ 串/ bj/ ,/ 而/ 承诺/ 者/ 则/ 依据/ bj/ 相应/ 地/ 打开/ 对/ α/ b1/ ,/ j1/ ,/ j/ ,/ …/ ,/ α/ bn/ ,/ jn/ ,/ j/ 的/ 承诺/ ./ 在/ 打开/ 阶段/ ,/ 承诺/ 者/ 打开/ 其它/ nk/ (/ n/ )/ +/ 1/ 个/ 承诺/ ./ 当且/ 仅/ 当/ 以上/ 所有/ 利用/ Com/ 所/ 做/ 的/ 承诺/ 都/ 能够/ 被/ 正确/ 地/ 打开/ ,/ 并且/ 对/ 任意/ 的/ i/ 和/ j/ 满足/ α/ 0i/ ,/ j/ / α/ 1i/ ,/ j/ =/ δ/ 时/ ,/ CECom/ 的/ 打开/ 才/ 是/ 合法/ 的/ ./ 正如/ 文献/ [/ 30/ ]/ 中/ 所述/ ,/ 一个/ CECom/ 方案/ 的/ 隐藏/ 性/ 和/ 绑定/ 性/ 与其/ 初始/ 承诺/ 方案/ 相同/ ./ 本文/ 方案/ 中/ 调用/ 了/ 一个/ 统计/ 绑定/ 的/ 并发/ 可/ 抽取/ 承诺/ ./ 将/ 上述/ 子/ 协议/ Com/ 初始化/ 为/ Naor/ 的/ 统计/ 绑定/ 承诺/ Comsb/ ,/ 即可/ 得到/ 基于/ 单项/ 函数/ 假设/ 的/ 统计/ 绑定/ 的/ 并发/ 可/ 抽取/ 承诺/ CEComsb/ (/ 如图/ 1/ 所示/ )/ ./ 协议/ CEComsb/ ./ 公共/ 输入/ :/ 安全/ 参数/ 1n/ 被/ 承诺/ 的/ 字符串/ :/ δ/ ∈/ {/ 0/ ,/ 1/ }/ n/ 承诺/ 阶段/ :/ 第/ 1/ 步/ :/ C/ →/ R/ :/ 选择/ nk/ (/ n/ )/ 对/ n/ 比特/ 随机/ 串/ (/ α/ 0i/ ,/ j/ ,/ α/ 1i/ ,/ j/ )/ ,/ 其中/ i/ ∈/ [/ n/ ]/ ,/ 第/ 2/ 步/ :/ 对/ j/ =/ 1/ →/ k/ (/ n/ )/ 执行/ 以下/ 步骤/ :/ R/ →/ C/ :/ 发送/ 一个/ n/ 比特/ 字符串/ bj/ =/ b1/ ,/ j/ ,/ …/ ,/ bn/ ,/ j/ ./ C/ →/ R/ :/ 打开/ 承诺/ α/ b1/ ,/ j1/ ,/ j/ ,/ …/ ,/ α/ bn/ ,/ jn/ ,/ j/ ./ 打开/ 阶段/ :/ C/ →/ R/ :/ 打开/ 其它/ nk/ (/ n/ )/ +/ 1/ 个/ 承诺/ ./ 3.2/ 并发/ 可/ 抽取/ 的/ 子/ 协议/ 本文/ 方案/ 的/ 另/ 一个/ 组成部分/ 是/ 满足/ 并发/ 可/ 抽取/ 性质/ 的/ 子/ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ ,/ 用来/ 设定/ (/ 模拟器/ 使用/ 的/ )/ “/ 伪证/ 据/ ”/ ./ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ 是/ 对/ 文献/ [/ 5/ ]/ 中/ 并发/ 零/ 知识/ 协议/ 的/ 前序/ 部分/ 的/ 抽象/ ./ 首先/ 在/ 第/ 1/ 阶段/ ,/ 发送者/ S/ ^/ 均匀/ 选取/ 两个/ 随机/ 字符串/ s0/ 和/ s1/ ,/ 并/ 将/ 其/ 关于/ 单向/ 函数/ f/ 的/ 像/ c0/ =/ f/ (/ s0/ )/ 以及/ c1/ =/ f/ (/ s1/ )/ 发送给/ 接收者/ R/ ^/ ./ 然后/ S/ ^/ 与/ R/ ^/ 并行执行/ 一个/ WISS/ 证明/ 系统/ 的/ k/ (/ n/ )/ 个/ 副本/ 至/ 倒数第/ 2/ 轮/ (/ 最后/ 两轮/ 暂/ 不/ 执行/ )/ 证明/ c0/ 或者/ c1/ 属于/ f/ 的/ 值域/ ./ 在/ 第/ 2/ 阶段/ 中/ ,/ S/ ^/ 与/ R/ ^/ 顺序/ 执行/ 上述/ k/ (/ n/ )/ 个/ 证明/ 的/ 后/ 两轮/ ./ 若/ 在/ 上述/ 任何/ 一个/ 证明/ 中/ R/ ^/ 未能/ 接受/ ,/ 则/ 终止/ 协议/ ./ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ 的/ 完整/ 描述/ 见图/ 2/ ./ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ ./ 公共/ 输入/ :/ 安全/ 参数/ 1n/ ,/ 单向/ 函数/ f/ 第/ 1/ 阶段/ :/ S/ ^/ →/ R/ ^/ :/ 均匀/ 选择/ s0/ ,/ s1/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 发送/ c0/ =/ f/ (/ s0/ )/ 以及/ c1/ =/ f/ (/ s1/ )/ ./ S/ ^/ →/ R/ ^/ :/ 随机/ 选择/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 以/ sb/ 为/ 证据/ 执行/ 一个/ WISS/ 证明/ 系/ 第/ 2/ 阶段/ :/ 对/ j/ =/ 1/ →/ k/ (/ n/ )/ 执行/ 以下/ 步骤/ :/ R/ ^/ →/ S/ ^/ :/ 对/ 第/ j/ 个/ 证明/ 副本/ ,/ 发送/ 其/ 倒数第/ 2/ 轮/ 消息/ β/ j/ ∈/ {/ 0/ ,/ 1/ }/ n2/ ./ S/ ^/ →/ R/ ^/ :/ 对/ 第/ j/ 个/ 证明/ 副本/ ,/ 发送/ 其/ 最后/ 一轮/ 消息/ γ/ j/ ./ R/ ^/ :/ 若/ 以上/ 证明/ 验证/ 失败/ 则/ 终止/ 协议/ ./ Page53/ ./ 3/ 关于/ 任意/ 犽/ 轮/ 协议/ 不可/ 延展/ 的/ 承诺/ 方案/ 一般而言/ ,/ 不可/ 延展性/ 的/ 研究/ 背景/ 是/ 中间人/ 敌手/ 并发/ 执行/ 多个/ 相同/ 的/ 协议/ ./ 近期/ ,/ Lin/ 等/ 人/ [/ 23/ ]/ 将/ 承诺/ 方案/ 的/ 不可/ 延展性/ 扩展/ 到/ 一般化/ 的/ 情况/ ,/ 即/ 对/ 任意/ k/ 轮/ 协议/ 的/ 不可/ 延展性/ (/ 以下/ 简称/ 为/ k/ -/ 不可/ 延展/ )/ ./ 考虑/ 以下/ 情形/ :/ 中间人/ 敌手/ A/ 在/ 左侧/ 与/ 参与方/ B/ 交互/ ,/ 执行/ 任意/ 一个/ k/ 轮/ 协议/ ,/ 同时/ 在/ 右侧/ 作为/ 承诺/ 者/ 与/ m/ 个/ 诚实/ 接收者/ 交互/ ,/ 执行/ 承诺/ 协议/ 〈/ C/ ,/ R/ 〉/ ./ 每个/ 右侧/ 协议/ 的/ 会/ 话/ 标识/ 应/ 与/ 左侧/ 协议/ 不同/ ,/ 且/ 均/ 由/ A/ 自/ 适应/ 地/ 选定/ ./ 令/ 随机变量/ 〈/ C/ ,/ R/ 〉/ (/ y/ ,/ z/ )/ (/ 其中/ y/ 表示/ B/ 的/ 本地/ 输入/ ,/ z/ 表示/ AmimB/ ,/ A/ 的/ 辅助输入/ )/ 表示/ A/ 的/ 视图/ 以及/ A/ 在/ 右侧/ 执行/ 中/ 利用/ 〈/ C/ ,/ R/ 〉/ 承诺/ 的/ 值/ ./ 此外/ ,/ 令/ viewA/ [/ B/ (/ y/ )/ ,/ A/ (/ z/ )/ ]/ 表示/ A/ 与/ B/ 交互/ 的/ 视图/ ./ 定义/ 3/ ./ 称/ 一个/ 承诺/ 方案/ 〈/ C/ ,/ R/ 〉/ 是/ 关于/ 任意/ k/ 轮/ 协议/ 一对/ 多/ 不可/ 延展/ 的/ (/ k/ -/ 不可/ 延展/ )/ ,/ 如果/ 对/ 任意/ PPT/ 中间人/ 敌手/ A/ 并发/ 地/ 参与/ 一个/ k/ 轮/ 的/ 左侧/ 协议/ (/ 与/ 机器/ B/ 交互/ )/ 和/ m/ 个/ 右侧/ 承诺/ 协议/ 〈/ C/ ,/ R/ 〉/ (/ 与/ m/ 个/ 诚实/ 接收者/ 交互/ )/ ,/ 以及/ 机器/ B/ 的/ 任意/ 的/ 输入/ 序列/ {/ y1n/ }/ n/ ∈/ N/ 和/ {/ y2n/ }/ n/ ∈/ N/ ,/ y1n/ ,/ y2n/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 当成/ 立时/ ,/ 以下/ 两个/ 概率/ 总体/ 计算/ 不可/ 区分/ :/ 本文/ 的/ 方案/ 中/ 调用/ 了/ 一个/ 关于/ 任意/ 超对/ 数轮/ 协议/ 不可/ 延展/ 的/ 承诺/ 协议/ NMCom/ ./ 如/ 文献/ [/ 12/ ,/ 23/ ]/ 中/ 所述/ ,/ 以/ 适当/ 的/ 参数/ 实例/ 化/ 文献/ [/ 29/ ]/ 的/ 不可/ 延展/ 承诺/ 方案/ ,/ 即可/ 满足/ ./ 引理/ 1/ ./ 令/ k/ (/ n/ )/ 为/ 一个/ 超/ 对数函数/ ,/ 那么/ 基于/ 单向/ 函数/ 假设/ ,/ 存在/ 一个/ O/ (/ k/ (/ n/ )/ )/ 轮/ (/ 初始/ )/ 统计/ 绑定/ 的/ k/ (/ n/ )/ -/ 不可/ 延展/ 承诺/ 方案/ NMCom/ ./ 此外/ ,/ NMCom/ 满足/ 另外/ 一个/ 性质/ ,/ 称为/ (/ 一对/ 多/ )/ 弱/ 不可/ 延展性/ (/ one/ -/ manyweaknon/ -/ malleability/ )/ [/ 23/ ]/ ,/ 是/ 对/ 传统/ 并发/ 不可/ 延展性/ 的/ 放宽/ ./ 弱/ 不可/ 延展性/ 针对/ 一类/ 受限/ 的/ 性质/ 集合/ / (/ 定义/ 于/ 敌手/ 的/ 视图/ 及其/ 在/ 右侧/ 承诺/ 的/ 值/ 之上/ )/ ,/ 强调/ 当/ 左侧/ 协议/ 的/ 执行/ 过程/ 发生变化/ 时/ ,/ / 成立/ 的/ 概率/ 不会/ 从/ 一个/ 可/ 忽略/ 的/ 值/ 跳跃/ 至/ 不可/ 忽略/ ./ 关于/ 弱/ 不可/ 延展性/ 的/ 严格/ 定义/ 请参阅/ 文献/ [/ 23/ ]/ ./ 3.4/ 本文/ 的/ 方案/ 不失/ 一般性/ ,/ 我们/ 假设/ 待/ 证明/ 的/ 声明/ x/ ∈/ L/ 以及/ 证据/ w/ 均/ 为/ n/ 比特/ 字符串/ ./ 令/ k/ (/ n/ )/ 为/ 一个/ 超/ 对数函数/ ,/ 表示/ 上述/ 并发/ 可/ 抽取/ 承诺/ CEComsb/ 以及/ 并发/ 可/ 抽取/ 子/ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ 的/ 轮/ 复杂性/ ./ 令/ l/ (/ n/ )/ =/ O/ (/ k/ (/ n/ )/ )/ 表示/ k/ (/ n/ )/ -/ 不可/ 延展/ 的/ 承诺/ 协议/ NMCom/ 的/ 轮/ 复杂性/ (/ 显然/ ,/ l/ (/ n/ )/ >/ k/ (/ n/ )/ )/ ./ 令/ t/ (/ n/ )/ 表示/ 标识/ 字符串/ 的/ 长度/ ./ 令/ 〈/ wiP/ ,/ wiV/ 〉/ 表示/ 一个/ 挑战/ 串/ 长度/ 为/ 2n/ 的/ WISS/ 证明/ 系统/ ./ 第/ 1/ 阶段/ ,/ 验证/ 者/ 首先/ 和/ 证明/ 者/ 执行/ 并发/ 可/ 抽取/ 的/ 子/ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ ,/ 其中/ 验证/ 者/ 作为/ 发送/ 方/ S/ ^/ 参与/ 协议/ ,/ 而/ 证明/ 者/ 作为/ 接收/ 方/ 执行/ R/ ^/ 对应/ 的/ 代码/ ./ 此后/ ,/ 证明/ 者/ 在/ 第/ 2/ 步/ 和/ 第/ 3/ 步/ 分别/ 利用/ CEComsb/ 和/ NMCom/ 对/ 其/ 掌握/ 的/ 证据/ w/ 承诺/ ./ 第/ 4/ 阶段/ ,/ 证明/ 者/ 对/ 字符串/ 0n/ 承诺/ ,/ 并/ 在/ 第/ 5/ 步/ 利用/ WISS/ 证明/ 系统/ 〈/ wiP/ ,/ wiV/ 〉/ 证明/ 该/ 承诺/ 确实/ 是/ 对/ 0n/ 的/ 承诺/ ,/ 或者/ 他/ 掌握/ 第/ 1/ 阶段/ 收到/ 的/ 其中/ 某个/ 值/ 的/ 原像/ (/ 即/ “/ 伪证/ 据/ ”/ )/ ./ 协议/ 最后/ 一步/ 包含/ l/ +/ 1/ 个/ WISS/ 交互/ 证明/ ,/ 证明/ 者/ P/ 证明/ 如下/ 声明/ :/ 协议/ 的/ 第/ 2/ 步/ 和/ 第/ 3/ 步/ 的确/ 是/ 对/ 证据/ w/ 的/ 承诺/ ,/ 或者/ 第/ 4/ 步是/ 对/ 一个/ 伪证/ 据/ 的/ 承诺/ (/ 见图/ 3/ )/ ./ 协议/ 〈/ P/ ,/ V/ 〉/ ./ 标识/ 字符串/ :/ id/ ∈/ {/ 0/ ,/ 1/ }/ t/ 公共/ 输入/ :/ 安全/ 参数/ 1n/ ,/ 字符串/ x/ ∈/ {/ 0/ ,/ 1/ }/ nP/ 的/ 秘密/ 输入/ :/ 证据/ 字符串/ w/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 满足/ (/ x/ ,/ w/ )/ ∈/ RL/ 第/ 1/ 阶段/ :/ V/ / P/ :/ 执行/ 并发/ 可/ 抽取/ 的/ 子/ 协议/ 〈/ S/ ^/ ,/ R/ ^/ 〉/ ,/ 其中/ V/ 作为/ 发送/ 方/ S/ ^/ P/ :/ 若/ 上述/ 过程/ 失败/ 则/ 终止/ 协议/ ./ 第/ 2/ 阶段/ :/ P/ →/ V/ :/ 利用/ CEComsb/ 对/ 证据/ w/ 承诺/ ./ 令/ T1/ 表示/ 该/ 承诺/ 的/ 交互/ 第/ 3/ 阶段/ :/ P/ →/ V/ :/ 利用/ NMCom/ 对/ 证据/ w/ 承诺/ ./ 记该/ 承诺/ 的/ 交互/ 副本/ 为/ T2/ ./ 第/ 4/ 阶段/ :/ P/ →/ V/ :/ 利用/ NMCom/ 对/ 字符串/ 0n/ 承诺/ ./ 令/ T3/ 表示/ 该/ 承诺/ 的/ 交/ 第/ 5/ 阶段/ :/ P/ / V/ :/ 执行/ WISS/ 证明/ 系统/ 〈/ wiP/ ,/ wiV/ 〉/ ,/ 证明/ 者/ P/ 证明/ 如下/ 第/ 6/ 阶段/ :/ P/ / V/ :/ 顺序/ 执行/ WISS/ 证明/ 系统/ 〈/ wiP/ ,/ wiV/ 〉/ l/ +/ 1/ 次/ ,/ 证明/ 者/ P/ 图/ 3/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 论证/ 协议/ 〈/ P/ ,/ V/ 〉/ 4/ 安全性/ 证明/ 零/ 知识/ 论证/ 系统/ ./ 定理/ 1/ ./ 协议/ 〈/ P/ ,/ V/ 〉/ 是/ 一个/ 并发/ 不可/ 延展/ 的/ 下面/ 我们/ 分别/ 论证/ 〈/ P/ ,/ V/ 〉/ 满足/ 完备/ 性/ 、/ 可靠性/ 完备/ 性/ ./ 易于/ 验证/ ./ 〈/ P/ ,/ V/ 〉/ 的/ 完备/ 性是/ 平凡/ 的/ ./ 以及/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ ./ Page6/ 可靠性/ ./ 直观/ 地/ 讲/ ./ 〈/ P/ ,/ V/ 〉/ 的/ 可靠性/ 依赖于/ 〈/ wiP/ ,/ wiV/ 〉/ 证明/ 系统/ 的/ 特殊/ 可靠性/ 和/ 证据/ 不可/ 区分/ 性/ ,/ 以及/ 函数/ f/ 的/ 单向性/ ./ 假设/ 存在/ 一个/ 多项式/ p/ 和/ 一个/ 敌手/ A/ ,/ 使得/ A/ 能够/ 以/ 1/ // p/ (/ n/ )/ 的/ 概率/ 攻破/ 〈/ P/ ,/ V/ 〉/ 的/ 可靠性/ ./ 那么/ ,/ 由/ 〈/ wiP/ ,/ wiV/ 〉/ 的/ 特殊/ 可靠性/ 可知/ ,/ 存在/ 一个/ 知识/ 抽取/ 器/ 能够/ 通过/ 重绕/ 第/ 6/ 步中/ 的/ 证明/ ,/ 抽取/ P/ 在/ 协议/ 第/ 6/ 步中/ 所/ 使用/ 的/ 证据/ w/ ./ 此外/ ,/ 由/ CEComsb/ 以及/ NMCom/ 的/ 绑定/ 性/ 可知/ ,/ w/ 是/ c0/ 或/ c1/ 原像/ 的/ 概率/ 为/ 1/ // p/ (/ n/ )/ -/ μ/ (/ n/ )/ (/ 其中/ μ/ (/ n/ )/ 是/ 一个/ 可/ 忽略/ 函数/ )/ ./ 令/ sb/ (/ b/ ∈/ {/ 0/ ,/ 1/ }/ )/ 表示/ 协议/ 第/ 1/ 阶段/ 中/ 包含/ 的/ 伪证/ 据/ ./ 依据/ “/ 双/ 证据/ ”/ 论证/ 方法/ ,/ 若/ w/ =/ sb/ 那么/ 可/ 构造/ 一个/ 算法/ B/ 攻破/ 第/ 1/ 阶段/ 中/ WISS/ 证明/ 系统/ 的/ 证据/ 不可/ 区分/ 性/ ;/ 若/ w/ =/ s1/ -/ b/ ,/ 那么/ 可/ 构造/ 另/ 一个/ 算法/ B/ 攻破/ 函数/ f/ 的/ 单向性/ ./ 详细/ 的/ 论述/ 请参阅/ 下文/ 中/ 定理/ 8/ 的/ 证明/ ./ 并发/ 不可/ 延展/ 的/ 零/ 知识/ ./ 证明/ 〈/ P/ ,/ V/ 〉/ 满足/ 并发/ 不可/ 延展/ 的/ 零/ 知识/ 需要/ 构造/ 一个/ 模拟/ 抽取/ 器/ S/ ,/ 能够/ 模拟/ 中间人/ 敌手/ A/ 在/ 左右/ 两侧/ 会话/ 中/ 的/ 视图/ ,/ 并且/ 抽取/ A/ 在/ 右侧/ 证明/ 中/ 所/ 使用/ 的/ 证据/ ./ 下面/ 分别/ 讨论/ 模拟/ 的/ 不可/ 区分/ 性/ 以及/ 证据/ 抽取/ 的/ 正确性/ ./ (/ 1/ )/ 模拟/ 抽取/ 器/ 本文/ 中/ 模拟/ 抽取/ 器/ S/ 的/ 构造/ (/ 见图/ 4/ )/ 类似/ 于/ 文献/ [/ 12/ ]/ ,/ 对/ 每个/ 左侧/ 会话/ ,/ S/ 首先/ 尝试/ 重绕/ 第/ 1/ 阶段/ 的/ 某个/ WISS/ 证明/ ,/ 找到/ 两个/ 接受/ 的/ 证明/ 副本/ ,/ 并/ 抽取/ 得到/ 一个/ 伪证/ 据/ (/ 该/ 过程/ 由/ 特殊/ 可靠性/ 保证/ )/ ./ 然后/ S/ 利用/ 伪证/ 据/ 进行/ 后续/ 的/ 模拟/ 过程/ ./ 对/ 每个/ 右侧/ 的/ 会/ 话/ ,/ S/ 按照/ 诚实/ 验证/ 者/ 的/ 步骤/ 进行/ ./ 模拟/ 右侧/ 证明/ 的/ 视图/ :/ S/ 按照/ 诚实/ 验证/ 者/ 的/ 步骤/ 执行/ ./ 模拟/ 左侧/ 证明/ 的/ 视图/ :/ 对于/ 每个/ 左侧/ 会话/ ,/ S/ 抽取/ 第/ 1/ 阶段/ 消息/ 中/ 所/ 包含/ 的/ 伪证/ 据/ ,/ 并/ 在/ 第/ 2/ 和/ 第/ 3/ 阶段/ 对/ 0n/ 承诺/ ,/ 在/ 第/ 4/ 阶对/ 伪证/ 据/ 承诺/ ,/ 最后/ 利用/ 伪证/ 据来/ 完成/ 第/ 5/ 和/ 第/ 6/ 阶段/ ./ 抽取/ 右侧/ 证明/ 的/ 证据/ :/ 对/ 每个/ 成功/ 的/ 右侧/ 证明/ ,/ S/ 抽取/ 出/ A/ 在/ 第/ 2/ 阶段/ 承诺/ 的/ 值/ w/ ./ 总体/ 上/ 讲/ ,/ S/ 采取/ 了/ 文献/ [/ 3/ -/ 5/ ]/ 中/ 所/ 使用/ 的/ “/ 茫然/ 模拟/ (/ oblivioussimulation/ )/ ”/ 策略/ ./ S/ 尝试/ 以/ 直线/ 的/ 方式/ 模拟/ A/ 的/ 视图/ ,/ 这是/ 通过/ 多次/ 的/ 重绕/ 收集/ 信息/ (/ 即/ 匹配/ 的/ 证明/ 副本/ )/ 来/ 实现/ 的/ ./ S/ 对/ A/ 的/ 每次/ 重绕/ 会/ 产生/ 一个/ 新/ 的/ 模拟/ 分支/ ,/ 它/ 与/ S/ 最终/ 在/ 主线/ 程/ (/ 即/ 输出/ 线程/ )/ 中/ 输出/ 的/ A/ 的/ 视图/ 相互/ 独立/ ,/ 但/ 有助于/ S/ 对/ 伪证/ 据/ 的/ 抽取/ ./ 模拟/ 过程/ 结束/ 后/ ,/ S/ 从/ 每个/ 成功/ 的/ 右侧/ 协议/ 中/ 抽取/ 出/ A/ 在/ 第/ 2/ 阶段/ 承诺/ 的/ 值/ (/ 即/ 右侧/ 声明/ 对应/ 的/ 证据/ )/ ./ 此外/ ,/ S/ 在/ 上述/ 模拟/ 过程/ 中/ 可能/ 面临/ 两种/ 失败/ 的/ 情况/ ./ 首先/ ,/ 在/ 某个/ 并发/ 可/ 抽取/ 承诺/ 或者/ 并发/ 可/ 抽取/ 的/ 子/ 协议/ 完成/ 之后/ ,/ S/ 未能/ 找到/ 两个/ 匹配/ 的/ 挑战/ -/ 应答/ 回合/ ,/ 即/ 对/ A/ 的/ 重绕/ 并/ 没有/ 起到/ 应有/ 的/ 作用/ ./ 这种/ 形式/ 的/ 失败/ 称为/ 重绕/ 失败/ ./ 第二/ ,/ 对于/ 左侧/ 协议/ 的/ 第/ 1/ 步/ ,/ S/ 尽管/ 找到/ 了/ 两个/ 匹配/ 的/ 证明/ 脚本/ ,/ 但/ 未能/ 提取/ 出/ 伪证/ 据/ ,/ 即/ 违反/ 了/ WISS/ 证明/ 的/ 特殊/ 可靠性/ ./ 这种/ 形式/ 的/ 失败/ ,/ 称为/ 特殊/ 可靠性/ 失败/ ./ 定理/ 2/ ./ 模拟/ 抽取/ 器/ S/ 出现/ 重绕/ 失败/ 和/ 特殊/ 可靠性/ 失败/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 定理/ 2/ 的/ 正确性/ 可/ 由/ 文献/ [/ 5/ ,/ 12/ ]/ 中/ 的/ 相关/ 结论/ 得出/ ./ 详细/ 的/ 论证/ 请参阅/ 文献/ [/ 5/ ,/ 12/ ]/ ./ (/ 2/ )/ 模拟/ 的/ 不可/ 区分/ 性本节/ 中/ 我们/ 将/ 证明/ 由/ 模拟器/ S/ 输出/ 的/ A/ 的/ 视/ 定理/ 3/ ./ 中间人/ 敌手/ A/ 在/ 真实/ 协议/ 中/ 的/ 视图/ 图/ 与/ A/ 在/ 真实/ 协议/ 中/ 的/ 视图/ 不可/ 区分/ ./ 与/ S/ 模拟输出/ 的/ A/ 的/ 视图/ 计算/ 不可/ 区分/ ,/ 即/ {/ S/ (/ 1n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ }/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ {/ 0/ ,/ 1/ }/ n/ ∩/ L/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ≈/ c/ {/ mim/ (/ 1n/ ,/ x1/ ,/ …/ ,/ xm/ ,/ z/ )/ }/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ {/ 0/ ,/ 1/ }/ n/ ∩/ L/ ,/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ./ 证明/ ./ 定理/ 3/ 的/ 证明/ 与/ 文献/ [/ 12/ ]/ 中/ 类似/ ./ 在/ 以下/ 证明/ 中/ ,/ 我们/ 将/ 左侧/ 协议/ 按照/ 其/ 第/ 1/ 步/ 结束/ 的/ 时间/ 顺序/ 来/ 排序/ ./ 首先/ ,/ 按/ 如下/ 方式/ 定义/ 一系列/ 混合/ 模拟器/ hybi/ (/ 1/ / i/ / m/ +/ 1/ )/ ,/ 每个/ 混合/ 模拟器/ 的/ 辅助输入/ (/ 记为/ z/ )/ 包括/ 左侧/ 所有/ 声明/ 对应/ 的/ 证据/ ./ 主/ 模拟/ 阶段/ :/ 运行/ 模拟器/ S/ 以/ 得到/ A/ 的/ 视图/ view/ ./ 若/ 模拟/ 成功/ ,/ 记录/ S/ 在/ 每个/ 左侧/ 会话/ 中/ 抽取/ 的/ 伪证/ 据/ (/ 记第/ j/ 个/ 左侧/ 证明/ 对应/ 的/ 伪证/ 据/ 为/ rj/ )/ ./ 否则/ 终止/ (/ 即/ S/ 遇到/ 了/ 重绕/ 失败/ 或者/ 特殊/ 可靠性/ 失败/ )/ ./ 重绕/ 阶段/ :/ 在/ view/ 中/ ,/ 以/ 第/ i/ 个/ 左侧/ 会话/ 的/ 第/ 1/ 阶段/ 恰好/ 完成/ 为/ 分割/ 点/ ,/ 记/ viewi/ 为/ 分割/ 点/ 之前/ 的/ 部分/ ./ 然后/ 从/ 分割/ 点/ 开始/ ,/ 以/ 如下/ 策略/ 继续/ 进行/ 模拟/ :/ ①/ 对/ 每个/ 右侧/ 会话/ ,/ 作为/ 诚实/ 验证/ 者/ 参与/ 协议/ (/ 如同/ S/ )/ ./ ②/ 对/ 左侧/ 前/ i/ 个会话/ ,/ 利用/ 第/ 1/ 步中/ 记录/ 的/ 伪证/ 据/ rj/ 进行/ 后续/ 步骤/ (/ 如同/ S/ )/ ./ 由/ 定理/ 2/ 可知/ ,/ 在/ 分割/ 点/ 之前/ ,/ 左侧/ 前/ i/ 个会话/ 对应/ 的/ 伪证/ 据/ 已/ 固定/ ./ 因此/ ,/ 此/ 步骤/ 能够/ 以/ 直线/ 方式/ 进行/ ./ ③/ 对/ 左侧/ 第/ i/ +/ 1/ 个/ 以及/ 后续/ 会话/ ,/ 利用/ 真实/ 证据/ 完成/ 模拟/ (/ 如同/ 诚实/ 证明/ 者/ )/ ./ 输出/ 阶段/ :/ 输出/ 在/ 以上/ 策略/ 下/ 生成/ 的/ A/ 的/ 视图/ ./ 此外/ ,/ 定义/ 另外/ 一组/ 混合/ 模拟器/ hybi/ ,/ 其/ 模拟/ 策略/ 类似/ 于/ hybi/ ,/ 但/ 在/ 重绕/ 阶段/ hybi/ 使用/ 真实/ 证据/ 完成/ 第/ i/ 个/ 左侧/ 会话/ 的/ 模拟/ (/ 如同/ 诚实/ 证明/ 者/ )/ ,/ 其/ Page7/ 它会话/ 保持/ 不变/ ./ 需要/ 注意/ 的/ 是/ ,/ hybi/ 以及/ hybi/ 仅/ 关注/ 对/ 敌手/ A/ 视图/ 的/ 模拟/ ,/ 而/ 不/ 关注/ 对/ 右侧/ 证据/ 的/ 抽取/ ./ 定理/ 4/ ./ 对/ 任意/ i/ ∈/ {/ 1/ ,/ …/ ,/ m/ +/ 1/ }/ ,/ hybi/ 以及/ hybi/ 终止/ 的/ 概率/ 可/ 忽略/ ./ 证明/ ./ hybi/ 以及/ hybi/ 仅/ 在/ 模拟器/ S/ 出现/ 重绕/ 失败/ 或者/ 特殊/ 可靠性/ 失败/ 时才/ 会/ 终止/ ,/ 因而/ 由/ 定理/ 2/ 可知/ 其/ 发生/ 概率/ 可/ 忽略/ ./ 定理/ 5/ ./ hybi/ 与/ hybi/ 的/ 输出/ 计算/ 不可/ 区分/ ./ 证明/ ./ hybi/ 与/ hybi/ 唯一/ 的/ 区别/ 在于/ 其/ 模拟/ 第/ i/ 个/ 左侧/ 会话/ 的/ 方式/ 不同/ ./ hybi/ 以/ 直线/ 的/ 方式/ 进行/ ,/ 在/ 第/ 2/ 及第/ 3/ 阶段/ 对/ 字符串/ 0n/ 承诺/ ,/ 并/ 利用/ 伪证/ 据/ 完成/ 后续/ 模拟/ 过程/ ./ 而/ hybi/ 利用/ 真实/ 证据/ ,/ 以/ 诚实/ 证明/ 者/ 的/ 方式/ 进行/ ./ 因此/ ,/ 由/ CEComsb/ 、/ NMCom/ 的/ 隐藏/ 性/ ,/ 以及/ 〈/ wiP/ ,/ wiV/ 〉/ 证明/ 系统/ 的/ 证据/ 不可/ 区分/ 性/ 可知/ ,/ 两者/ 输出/ 的/ A/ 的/ 视图/ 计算/ 不可/ 区分/ ./ 定理/ 6/ ./ hybi/ -/ 1/ 以及/ hybi/ 的/ 输出/ 统计/ 不可/ 区分/ ./ 证明/ ./ hybi/ -/ 1/ 以及/ hybi/ 的/ 唯一/ 区别/ 在于/ :/ 从/ 第/ i/ -/ 1/ 个/ 左侧/ 会话/ 的/ 第/ 1/ 阶段/ 结束/ 之后/ 到/ 第/ i/ 个/ 左侧/ 会话/ 的/ 第/ 1/ 阶段/ 结束/ 为止/ ,/ hybi/ 以重/ 绕/ 的/ 方式/ 生成/ A/ 的/ 视图/ ./ 由于/ 模拟器/ S/ 利用/ 了/ “/ 茫然/ 模拟/ ”/ 的/ 策略/ ,/ 由/ 重绕/ 产生/ 的/ 模拟/ 分支/ 与/ 输出/ 相互/ 独立/ ,/ 因此/ 在/ hybi/ -/ 1/ 以及/ hybi/ 成功/ 完成/ 的/ 情况/ 下/ ,/ 两者/ 的/ 输出/ 同/ 分布/ ./ 此外/ ,/ 由/ 定理/ 2/ 可知/ ,/ hybi/ -/ 1/ 和/ hybi/ 终止/ 的/ 概率/ 可/ 忽略/ ,/ 定理/ 6/ 得证/ ./ 易知/ hybm/ +/ 1/ 的/ 输出/ 与/ 模拟器/ S/ 的/ 输出/ 同/ 分布/ ,/ 而/ hyb0/ 的/ 输出/ 与/ 协议/ 真实/ 执行/ 时/ A/ 的/ 视图/ 统计/ 不可/ 区分/ ,/ 因此/ 定理/ 3/ 的/ 正确性/ 可/ 由/ 定理/ 5/ 及/ 定理/ 6/ 保证/ ./ (/ 3/ )/ 证据/ 抽取/ 的/ 正确性/ 本节/ 中/ 我们/ 将/ 完成/ 定理/ 3/ 证明/ 的/ 最后/ 一部分/ ,/ 即/ S/ 在/ 右侧/ 协议/ 的/ 第/ 2/ 步中/ 抽取/ 的/ 证据/ 是/ 正确/ 的/ ./ 为/ 便于/ 表述/ ,/ 在/ 以下/ 证明/ 中如/ 无/ 特殊/ 说明/ ,/ 右侧/ 证明/ 即/ 是/ 指/ 验证/ 者/ 接受/ 的/ 右侧/ 证明/ 并且/ 其/ 标识/ 不同于/ 任何/ 一个/ 左侧/ 证明/ ./ 此外/ ,/ 若/ 敌手/ A/ 在/ 某个/ 右侧/ 证明/ 的/ 第/ 2/ 阶段/ 承诺/ 的/ 值/ 并非/ 合法/ 的/ 证据/ ,/ 则/ 称/ 敌手/ A/ 欺骗/ 成功/ ./ 因此/ ,/ 只/ 需/ 证明/ 在/ 模拟器/ 输出/ 的/ 视图/ 中/ ,/ A/ 欺骗/ 成功/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ,/ 即可/ 推断出/ S/ 抽取/ 的/ 正确性/ ./ 由/ WISS/ 证明/ 系统/ 的/ 可靠性/ 、/ 证据/ 不可/ 区分/ 性/ 以及/ 函数/ f/ 的/ 单向性/ 可知/ ,/ 在/ 协议/ 的/ 真实/ 执行/ 过程/ 中/ ,/ A/ 欺骗/ 成功/ 的/ 概率/ 可/ 忽略/ ./ 因此/ ,/ 我们/ 需要/ 证明/ 模拟/ 的/ 过程/ 不会/ 使/ A/ 欺骗/ 成功/ 的/ 概率/ 从/ 可/ 忽略/ 的/ 值/ 跳跃/ 至/ 不可/ 忽略/ ./ 事实上/ ,/ 这/ 是/ 由/ NMCom/ 的/ 不可/ 延展性/ 以及/ 协议/ 第/ 6/ 阶段/ 证明/ 的/ 鲁棒性/ 保证/ 的/ ./ 定理/ 7/ ./ 对/ 任意/ PPT/ 中间人/ 敌手/ A/ 同时/ 参与/ m/ 个/ 左侧/ 证明/ 和/ m/ 个/ 右侧/ 证明/ ,/ 任意/ n/ ∈/ N/ ,/ x1/ ,/ …/ ,/ xm/ ∈/ {/ 0/ ,/ 1/ }/ n/ ∩/ L/ 以及/ z/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ 都/ 存在/ 一个/ 可/ 忽略/ 函数/ μ/ ,/ 使得/ A/ 在/ 某个/ 右侧/ 证明/ 中/ 欺骗/ 成功/ 的/ 概率/ 小于/ μ/ (/ n/ )/ ./ 证明/ ./ 回顾/ 第/ 4.2/ 节中/ 定义/ 的/ 混合/ 模拟器/ ./ 定理/ 7/ 可/ 由/ 以下/ 定理/ 8/ 、/ 定理/ 9/ 以及/ 定理/ 10/ 得出/ ./ 定理/ 8/ ./ 对/ 任意/ PPT/ 敌手/ A/ ,/ A/ 在/ hyb0/ 的/ 输出/ 视图/ 中/ 欺骗/ 成功/ 的/ 概率/ 可/ 忽略/ ./ 证明/ ./ 由/ hyb0/ 的/ 定义/ 可知/ ,/ 其/ 输出/ 产生/ 于/ 第/ 2/ 阶段/ ,/ 并且/ 该/ 过程/ 与/ 协议/ 的/ 真实/ 执行/ 过程/ 等价/ ./ 由于/ 其/ 第/ 1/ 阶段/ 与/ 第/ 2/ 阶段/ 以及/ 最终/ 的/ 输出/ 相对/ 独立/ ,/ 因此/ 不失/ 一般性/ 我们/ 仅/ 考虑/ hyb0/ 的/ 第/ 2/ 阶段/ ./ 假设/ 存在/ 一个/ PPT/ 敌手/ A/ 以及/ 一个/ 多项式/ p/ ,/ 使得/ 对/ 无穷/ 多/ 的/ n/ ∈/ N/ 满足/ A/ 在/ hyb0/ 中/ 欺骗/ 成功/ 的/ 概率/ 为/ 1/ // p/ (/ n/ )/ ./ 因此/ ,/ 对/ 随机/ 选取/ 的/ 第/ j/ 个/ 右侧/ 证明/ ,/ A/ 在/ 该/ 证明/ 副本/ 中/ 欺骗/ 的/ 概率/ 为/ 1/ // mp/ (/ n/ )/ ./ 固定/ 一个/ 证明/ 副本/ j/ ,/ 那么/ 由/ 第/ 6/ 步/ 证明/ 的/ 可靠性/ 可知/ ,/ 在/ 该/ 证明/ 中/ A/ 在/ 第/ 4/ 阶段/ 对/ 一个/ 伪证/ 据/ (/ c0/ 或/ c1/ 的/ 原像/ )/ 承诺/ 的/ 概率/ 也/ 为/ 1/ // mp/ (/ n/ )/ (/ 减去/ 一个/ 可/ 忽略/ 的/ 值/ )/ ./ 再/ 由/ 第/ 5/ 阶段/ 证明/ 的/ 特殊/ 可靠性/ 可知/ ,/ 存在/ 一个/ 有效/ 的/ 知识/ 抽取/ 器/ 能够/ 抽取/ A/ 在/ 第/ 5/ 阶段/ 证明/ 中/ 所/ 使用/ 的/ 证据/ ,/ 即/ 某个/ 值/ s/ 满足/ cb/ =/ f/ (/ s/ )/ (/ 其中/ b/ ∈/ {/ 0/ ,/ 1/ }/ )/ ./ ①/ 若/ b/ =/ 1/ -/ b/ ,/ 那么/ 可以/ 构造/ 一个/ 算法/ B/ 来/ 攻破/ f/ 的/ 单向性/ ./ 设/ B/ 的/ 挑战/ 字符串/ 为/ y/ =/ f/ (/ x/ )/ ./ B/ 按照/ hyb0/ 的/ 步骤/ 执行/ ,/ 但/ 在/ 随机/ 选取/ 的/ 第/ j/ 个/ 右侧/ 证明/ 中/ ,/ B/ 将/ 第/ 1/ 步中/ 函数/ f/ 的/ 两个/ 像/ 之一/ 替换/ 为/ y/ ./ 此后/ ,/ B/ 利用/ 其/ 掌握/ 的/ 唯一/ 证据/ (/ 另/ 一个/ 值/ 的/ 原像/ )/ 完成/ 第/ 1/ 步/ 的/ 证明/ ./ 由/ 假设/ 可知/ ,/ B/ 能够/ 以/ 近似/ 1/ // mp/ (/ n/ )/ 的/ 概率/ 找到/ y/ 对应/ 的/ 原像/ x/ ,/ 从而/ 攻破/ f/ 的/ 单向性/ ./ ②/ 若/ b/ =/ b/ ,/ 那么/ 可以/ 构造/ 另/ 一个/ 算法/ B/ 攻破/ WISS/ 证明/ 系统/ 的/ 证据/ 不可/ 区分/ 性/ ./ 首先/ 考虑/ 以下/ 混合/ 实验/ Bi/ (/ 0/ / i/ / k/ )/ ./ 对/ 一个/ 随机/ 选择/ 的/ 右侧/ 会话/ j/ ,/ Bi/ 在/ 第/ 1/ 阶段/ 的/ 前/ i/ 个/ WISS/ 证明/ 中/ 使用/ sj/ 为/ 证据/ ,/ 而/ 在/ 后/ k/ -/ i/ 个/ 证明/ 中/ 使用/ sj/ 然在/ B0/ 中/ ,/ 会话/ j/ 的/ 第/ 5/ 阶段/ 中/ 抽取/ 的/ 证据/ 为/ sj/ 而/ 在/ Bk/ 中/ 相应/ 的/ 值/ 为/ sj/ 可知/ ,/ 存在/ 一个/ 索引/ 值/ i/ 满足/ 在/ Bi/ 和/ Bi/ +/ 1/ 中/ ,/ 会话/ j/ 的/ 第/ 5/ 阶段/ 中/ 抽取/ 的/ 证据/ 是/ 不同/ 的/ 值/ ./ 由/ Bi/ 和/ Bi/ +/ 1/ 的/ 定义/ 可知/ ,/ 二者/ 唯一/ 的/ 区别/ 在于/ 第/ 1/ 阶段/ 的/ 第/ i/ +/ 1/ 个/ WISS/ 证明/ 所/ 使用/ 的/ 证据/ 不同/ ./ 因此/ ,/ 基于/ 上/ Page8/ 述/ 事实/ 可以/ 构造/ 算法/ B/ 攻破/ WISS/ 证明/ 系统/ 的/ 证据/ 不可/ 区分/ 性/ ./ B/ 按照/ hyb0/ 的/ 步骤/ 执行/ ,/ 但/ 对于/ 随机/ 选取/ 的/ 第/ j/ 个/ 右侧/ 会话/ 以及/ 该会/ 话/ 第/ 1/ 阶段/ 中/ 随机/ 选取/ 的/ 第/ i/ 个/ WISS/ 证明/ ,/ B/ 执行/ 以下/ 步骤/ :/ 利用/ 0/ 作为/ 证据/ 生成/ 前/ i/ -/ 1/ 个/ WISS/ 证明/ ,/ 利用/ sjsj/ 证据/ 生成/ 后/ k/ -/ i/ 个/ WISS/ 证明/ ,/ 而/ 对于/ 第/ i/ 个/ WISS/ 证明/ ,/ B/ 在/ A/ 以及/ WI/ -/ 挑战者/ 之间/ 传递/ 消息/ ./ 因此/ ,/ 通过/ 上述/ 分析/ 可知/ ,/ B/ 以/ 近似/ 1/ // kmp/ (/ n/ )/ 的/ 概率/ 可以/ 攻破/ 协议/ 第/ 1/ 阶段/ 中/ WISS/ 证明/ 的/ 证据/ 不可/ 区分/ 性/ ./ 综上所述/ ,/ 基于/ 单向/ 函数/ 假设/ ,/ 任意/ PPT/ 敌手/ A/ 在/ hyb0/ 中/ 欺骗/ 成功/ 的/ 概率/ 可/ 忽略/ ./ 定理/ 9/ ./ 对/ 任意/ PPT/ 敌手/ A/ 以及/ 任意/ i/ ∈/ {/ 0/ ,/ …/ ,/ m/ +/ 1/ }/ ,/ A/ 在/ hybi/ +/ 1/ 以及/ hybi/ 的/ 输出/ 视图/ 中/ 欺骗/ 成功/ 的/ 概率/ 仅/ 相差/ 一个/ 可/ 忽略/ 的/ 值/ ./ 证明/ (/ 概要/ )/ ./ 回顾/ 定理/ 6/ ,/ 在/ hybi/ 以及/ hybi/ +/ 1/ 成功/ 完成/ 的/ 条件/ 下/ ,/ 其/ 输出/ 同/ 分布/ ,/ 因此/ A/ 在/ 二者/ 的/ 输出/ 视图/ 中/ 欺骗/ 成功/ 的/ 概率/ 相同/ ./ 而/ hybi/ 以及/ hybi/ +/ 1/ 终止/ 的/ 概率/ 均/ 为/ 可/ 忽略/ 的/ 值/ ,/ 因而/ A/ 在/ 二者/ 的/ 输出/ 视图/ 中/ 欺骗/ 成功/ 的/ 概率/ 仅/ 相差/ 一个/ 可/ 忽略/ 的/ 值/ ./ 定理/ 10/ ./ 对/ 任意/ PPT/ 敌手/ A/ 以及/ 任意/ i/ ∈/ {/ 0/ ,/ …/ ,/ m/ +/ 1/ }/ ,/ A/ 在/ hybi/ 以及/ hybi/ 的/ 输出/ 视图/ 中/ 欺骗/ 成功/ 的/ 概率/ 仅/ 相差/ 一个/ 可/ 忽略/ 的/ 值/ ./ 证明/ ./ 本段/ 中/ 我们/ 将/ 证明/ 在/ 每/ 一对/ hybi/ 和/ hybi/ 中/ ,/ 敌手/ A/ 的/ 视图/ 以及/ A/ 在/ 右侧/ 会话/ 的/ 第/ 2/ 阶段/ 中/ 承诺/ 的/ 值/ 计算/ 不可/ 区分/ ,/ 并且/ A/ 在/ 第/ 4/ 阶段/ 对/ 一个/ 伪证/ 据/ 承诺/ 的/ 概率/ 可/ 忽略/ ./ 由此/ 即可/ 推断出/ A/ 在/ 两者/ 中/ 的/ 欺骗/ 概率/ 仅/ 相差/ 一个/ 可/ 忽略/ 的/ 值/ ./ 下面/ 通过/ 归纳法/ 来/ 证明/ 上述/ 命题/ ./ 当/ i/ =/ 0/ 时/ ,/ 该/ 命题/ 是/ 平凡/ 的/ ,/ 因此/ 我们/ 从/ i/ =/ 1/ 的/ 情况/ 开始/ ./ 基础/ 步骤/ (/ i/ =/ 1/ )/ :/ 由/ 上述/ 定理/ 8/ 和/ 定理/ 9/ 可知/ ,/ A/ 在/ hyb1/ 中/ 欺骗/ 的/ 概率/ 可/ 忽略/ (/ 该/ 结论/ 将/ 在/ 以下/ 对/ 1/ 和/ H1H0/ 另外/ 一组/ 混合/ 实验/ H0/ 的/ 重绕/ 阶段/ 中/ ,/ 左侧/ 第/ 1/ 个会/ 话/ 的/ 改变/ 及其/ 对/ 右侧/ 会话/ 的/ 影响/ ./ 1/ :/ H0H0/ 个/ 右侧/ 会话/ 的/ 第/ 3/ 阶段/ 承诺/ 的/ 值/ ./ 显然/ ,/ 由/ CEComsb/ 以及/ NMCom/ 的/ 绑定/ 性/ 可知/ ,/ 在/ H0/ 视图/ 以及/ A/ 在/ 每个/ 右侧/ 会话/ 的/ 第/ 3/ 阶段/ 承诺/ 的/ 值/ 不可/ 区分/ ./ 1/ :/ H1H1/ 步中/ ,/ H1NMCom/ 的/ 4/ -/ 不可/ 延展性/ (/ 或者/ 3/ -/ 不可/ 延展性/ ,/ 若该/ WISS/ 证明/ 系统/ 是/ 基于/ 单向/ 置换/ 假设/ 构造/ 的/ 3/ 轮/ 证明/ 系统/ )/ 可知/ ,/ 在/ 每个/ 右侧/ 会话/ 中/ ,/ A/ 在/ 第/ 4/ 阶段/ 承诺/ 的/ 值/ 与/ H0A/ 在/ 第/ 4/ 阶段/ 对/ 伪证/ 据/ 承诺/ 的/ 概率/ 可/ 忽略/ ,/ 因此/ 该/ 结论/ 在/ H1/ 可/ 延展性/ 以及/ WISS/ 证明/ 系统/ 的/ 证据/ 不可/ 区分/ 性/ 可知/ ,/ 在/ H0/ 话/ 的/ 第/ 3/ 阶段/ 中/ 承诺/ 的/ 值/ 计算/ 不可/ 区分/ ./ 定理/ 12/ ./ 对/ 任意/ PPT/ 敌手/ A/ ,/ A/ 在/ H2/ 视图/ 以及/ A/ 在/ 右侧/ 会话/ 的/ 第/ 3/ 阶段/ 承诺/ 的/ 值/ 与/ H1/ 中/ 计算/ 不可/ 区分/ ./ 证明/ (/ 概要/ )/ ./ 该/ 证明/ 依赖于/ 协议/ 第/ 6/ 阶段/ 的/ 鲁棒性/ ./ 首先/ ,/ 协议/ 第/ 4/ 阶段/ 的/ NMCom/ 轮/ 复杂度/ 为/ l/ ,/ 而/ 第/ 6/ 阶段/ 中有/ l/ +/ 1/ 个/ WISS/ 证明/ ./ 那么/ ,/ 对/ 每个/ 右侧/ 会话/ ,/ 其/ 第/ 6/ 阶段/ 必然/ 存在/ 一个/ WISS/ 证明/ 不/ 包含/ 左侧/ 会话/ 第/ 4/ 阶段/ 的/ 任何/ 消息/ (/ 即/ 不/ 相交/ )/ ./ 因此/ ,/ 通过/ 重绕/ 该/ 证明/ 可/ 抽取/ 一个/ 证据/ 而/ 不影/ H2/ 阶段/ ,/ H2/ 定理/ 11/ ./ 对/ 任意/ PPT/ 敌手/ A/ ,/ A/ 在/ 某个/ 右侧/ 会话/ 的/ 第/ 4/ 阶段/ 中/ 对/ 一个/ 伪证/ 据/ 承诺/ 的/ 概率/ 可/ 忽略/ ./ 证明/ (/ 概要/ )/ ./ 考虑/ 以下/ 关于/ 右侧/ 会话/ 的/ 情况/ :/ 首先/ H2/ 是/ 相同/ 的/ ./ 因此/ ,/ 由/ 初始/ 绑定/ 性/ 可知/ ,/ 若/ 任何/ 一个/ 右侧/ 会话/ 的/ 第/ 4/ 阶段/ 在/ 第/ 1/ 个/ 左侧/ 协议/ 的/ 第/ 4/ 阶段/ 之前/ 出现/ ,/ 那么/ A/ 在/ 该/ 阶段/ 承诺/ 的/ 值/ 已经/ 确定/ ,/ 并且/ 它/ 是/ 一个/ 伪证/ 据/ 的/ 概率/ 可/ 忽略/ ./ 其次/ ,/ 若/ A/ 在/ 其它/ 右侧/ 会话/ 的/ 第/ 4/ 阶段/ 中/ 对/ 伪证/ 据/ 承诺/ 的/ 概率/ 不可/ 忽略/ ,/ 那么/ 可以/ 构造/ 算法/ B/ 攻破/ NMCom/ 的/ 弱/ 不可/ 延展性/ ./ 简言之/ ,/ 算法/ B/ 执行/ H2/ 个会/ 话/ 的/ 第/ 4/ 阶段/ 中/ ,/ B/ 在/ A/ 与/ 一个/ 外部/ 的/ 诚实/ 承诺/ 者/ 之间/ 传递/ 消息/ ,/ 并且/ 对于/ (/ 出现/ 在/ 左侧/ 第/ 1/ 个会/ 话/ 第/ 4/ 阶段/ 之后/ 的/ )/ 右侧/ 会话/ 的/ 第/ 4/ 阶段/ ,/ B/ 在/ A/ 与/ 外部/ 的/ 诚实/ 接收者/ 之间/ 传递/ 消息/ ./ 显然/ ,/ 当/ 左侧/ 收到/ 一个/ 对/ 0n/ 的/ 承诺/ 时/ ,/ B/ 完美/ 地/ 模拟/ A/ 在/ H1/ 视图/ ./ 另一方面/ ,/ 当/ 左侧/ 收到/ 对/ 一个/ 伪证/ 据/ 的/ 承诺/ 时/ ,/ B/ 完美/ 地/ 模拟/ A/ 在/ H2/ 的/ 值/ 由/ 0n/ 变为/ 一个/ 伪证/ 据时/ ,/ A/ 在/ 右侧/ 欺骗/ 的/ 概率/ 由/ 可/ 忽略/ (/ 在/ H1/ 而/ 违背/ 了/ NMCom/ 的/ 弱/ 不可/ 延展性/ ./ Page9/ 响/ 对/ 左侧/ 会话/ 的/ 模拟/ ,/ 即/ 对/ 第/ 1/ 个/ 左侧/ 会话/ 第/ 4/ 阶段/ 的/ 模拟/ 不/ 影响/ 右侧/ 会话/ 第/ 6/ 阶段/ 的/ 可靠性/ ./ 此外/ ,/ 由/ 定理/ 11/ 可知/ ,/ A/ 在/ 右侧/ 第/ 4/ 阶段/ 对/ 伪证/ 据/ 承诺/ 的/ 概率/ 可/ 忽略/ ./ 因而/ ,/ 在/ 右侧/ 第/ 6/ 阶段/ 抽取/ 的/ 证据/ 必为/ A/ 在/ 第/ 2/ 、/ 3/ 阶段/ 承诺/ 的/ 值/ (/ 及/ 相应/ 的/ 承诺/ 密钥/ )/ ./ 综上/ 可知/ ,/ 在/ H1/ 不可/ 区分/ ./ 此外/ ,/ 由/ NMCom/ 的/ 隐藏/ 性可得/ ,/ A/ 在/ H1/ 及/ H21/ 中/ 的/ 视图/ 同样/ 计算/ 不可/ 区分/ ./ 关于/ 定理/ 12/ 详细/ 的/ 证明/ 类似/ 于/ 文献/ [/ 23/ ]/ 中/ 对/ Subclaim4/ 的/ 证明/ ./ 1/ (/ 1/ / i/ / l/ +/ 1/ )/ :/ H3/ ,/ iH3/ ,/ i1/ 个会/ 话/ 的/ 第/ 6/ 阶段/ ,/ 前/ i/ 个/ WISS/ 证明/ 以/ “/ 第/ 4/ 阶段/ 是/ 对/ 一个/ 伪证/ 据/ 的/ 承诺/ ”/ 作为/ 证据/ ./ 通过/ 混合/ 论证/ 的/ 方法/ ,/ 以及/ 类似/ 于/ 上述/ H1/ 论/ :/ 在/ H3/ ,/ l/ +/ 1/ 承诺/ 的/ 值/ 与/ H3/ ,/ 1/ 可/ 区分/ ./ 1/ :/ H4H4/ 第/ 3/ 阶段/ ,/ H41/ :/ H5H5/ 阶段/ 中/ ,/ H5/ 可/ 延展性/ ,/ 以及/ CEComsb/ 的/ 隐藏/ 性可得/ ,/ 在/ H5/ 的/ 视图/ 以及/ A/ 在/ 右侧/ 第/ 3/ 阶段/ 承诺/ 的/ 值/ 与/ H4/ 可/ 区分/ ,/ 并且/ A/ 在/ 右侧/ 第/ 4/ 阶段/ 对/ 伪证/ 据/ 承诺/ 的/ 概率/ 可/ 忽略/ ./ 此外/ ,/ 由/ 第/ 6/ 阶段/ 证明/ 的/ 可靠性/ 可知/ ,/ 对/ 任意/ 一个/ 接受/ 的/ 右侧/ 会话/ ,/ A/ 在/ 第/ 2/ 阶段/ 和/ 第/ 3/ 阶段/ 承诺/ 的/ 值/ 相同/ ./ 因此/ ,/ 在/ H52/ 阶段/ 承诺/ 的/ 值/ 与/ hyb1/ 中/ 计算/ 不可/ 区分/ ./ 基础/ 步骤/ 证明/ 完毕/ ./ 归纳/ 步骤/ :/ 假设/ 定理/ 10/ 对/ 任意/ 1/ / i/ / m/ -/ 1/ 成立/ ./ 对于/ i/ =/ m/ ,/ 考虑/ 如图/ 5/ 所示/ 的/ 不可/ 区分/ 链/ ,/ 其中/ 实/ 箭头/ 表示/ (/ 在/ 定理/ 9/ 中/ )/ 已经/ 证明/ 的/ 不可/ 区分/ 性/ ,/ 而/ 虚/ 箭头/ 表示/ 待/ 证明/ 的/ 部分/ ./ 在/ 定理/ 8/ 中/ 我们/ 已经/ 证明/ 了/ A/ 在/ hyb0/ 中/ 欺骗/ 成功/ 的/ 概率/ 可/ 忽略/ ,/ 那么/ 由/ 归纳/ 假设/ 可知/ A/ 在/ hybm/ 中/ 欺骗/ 成功/ 的/ 概率/ 也/ 为/ 可/ 忽略/ 的/ 值/ ./ 通过/ 与/ 基础/ 步骤/ 相同/ 的/ 论证/ ,/ 易知/ 定理/ 10/ 对/ i/ =/ m/ 同样/ 成立/ ./ 定理/ 10/ 证明/ 完毕/ ./ 5/ 结论/ 本文/ 提出/ 了/ 一种/ 在/ 平凡/ 模型/ 下/ 构造/ 并发/ 不可/ 延展/ 零/ 知识/ 论证/ 系统/ 的/ 新/ 方法/ ./ 与/ 已有/ (/ 平凡/ 模型/ 下/ 的/ )/ 方案/ [/ 10/ -/ 12/ ]/ 相比/ ,/ 本文/ 的/ 方案/ 在/ 最/ 基本/ 的/ 密码学/ 假设/ (/ 即/ 单向/ 函数/ 假设/ )/ 下/ 达到/ 了/ 最优/ 的/ 轮/ 复杂性/ (/ 与/ 文献/ [/ 18/ ]/ 相同/ )/ ./ 更/ 重要/ 的/ 是/ ,/ 本文/ 方案/ 以/ 具有/ 鲁棒/ 的/ 不可/ 延展/ 承诺/ 协议/ 以及/ 巧妙/ 设计/ 的/ 证据/ 不可/ 区分/ 的/ 证明/ 系统/ 为/ 基本/ 组件/ ,/ 通过/ 适当/ 地/ 调整/ 协议/ 轮数/ ,/ 即可/ 达到/ 更好/ 的/ 鲁棒性/ ./ 因此/ ,/ 当/ 与/ 其它/ 协议/ 并发/ 组合/ 时/ ,/ 本文/ 的/ 协议/ 更/ 易于/ 分析/ ,/ 因而/ 有/ 更/ 广泛/ 的/ 应用/ ./ 

