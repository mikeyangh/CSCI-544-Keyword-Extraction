Page1/ 一个/ 新/ 的/ 基于/ 秘密/ 共享/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ 蓝才会/ 王彩芬/ (/ 西北师范大学/ 数学/ 与/ 信息科学/ 学院/ 兰州/ 730070/ )/ 摘要/ 研究/ 的/ 动机/ 来源于/ Weng/ 等/ 人/ 的/ 工作/ ,/ 他们/ 的/ 方案/ 允许/ 代理人/ 把/ 满足条件/ 的/ 授权人/ 密文/ 转换成/ 受理/ 人/ 的/ 密文/ ,/ 可/ 应用/ 于/ 需要/ 灵活/ 代理/ 的/ 环境/ 中/ ./ 例如/ ,/ 授权人/ 希望/ 同事/ (/ 受理/ 人/ )/ 在/ 她/ 休假/ 期间/ 帮忙/ 处理/ 紧急/ 邮件/ ./ 然而/ ,/ 他们/ 的/ 方案/ 不能/ 很/ 好/ 支持/ 多个/ 条件/ 的/ “/ 与/ ”/ 和/ “/ 或/ ”/ ./ 文中/ ,/ 为了/ 让/ 代理人/ 不能/ 产生/ 其它/ 关键字/ 的/ 重加/ 密钥/ ,/ 利用/ 秘密/ 共享/ 机制/ ,/ 并/ 根据/ 集合/ (/ 由/ 关键字/ 和/ 随机数/ 构成/ )/ 产生/ 两/ 部分/ 代理/ 重加/ 密钥/ ./ 在/ 重/ 加密/ 时/ ,/ 密文/ 中/ 与/ 关键字/ 有关/ 的/ 模块/ 和/ 一部分/ 称为/ 关键字/ 的/ 代理/ 重加/ 密钥/ 作为/ 一个/ 子/ 算法/ 的/ 输入/ ;/ 另/ 一部分/ 称为/ 随机数/ 代理/ 重加/ 密钥/ 作为/ 另/ 一个/ 子/ 算法/ 的/ 输入/ ./ 在/ 此基础/ 上/ ,/ 作者/ 利用/ 双线性/ 对/ 构造/ 了/ 一个/ 新/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 方案/ 能/ 很/ 好/ 支持/ 多个/ 条件/ 的/ 情况/ ,/ 并/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 了/ 它/ 的/ 安全性/ 是/ 基于/ 变性/ 的/ 判断/ 双线性/ Diffie/ -/ Hellman/ 问题/ ./ 关键词/ 条件/ 代理/ 重/ 加密/ ;/ 秘密/ 共享/ ;/ 双线性/ 对/ ;/ 随机/ 预言/ 模型/ ;/ 选择/ 密文/ 安全/ 1/ 引言/ 随着/ 计算机/ 网络带宽/ 技术/ 和/ 计算机/ 多媒体/ 编码/ 技术/ 的/ 进步/ ,/ 在/ 因特网/ 上/ 进行/ 数字/ 内容/ 交易/ 变得/ 十分/ 便捷/ ,/ 并/ 以/ 惊人/ 的/ 速度/ 发展/ ./ 其中/ 出现/ 一些/ 急待/ 解决/ 的/ 问题/ ,/ 如/ 加密/ 电子邮件/ 转发/ 、/ 分布式文件系统/ 等/ 应用/ 需要/ 把/ 一个/ 公钥/ 下/ 的/ 密文/ 转换成/ 另/ 一个/ 公钥/ 下/ 的/ 密文/ ./ 代理/ 重/ 加密/ [/ 1/ ]/ 是/ 一个/ 很/ 好/ 的/ 解决办法/ ./ 在/ 代理/ 重/ 加密/ 系统/ 中/ ,/ 允许/ 一个/ 拥有/ 一些/ 额外/ 信息/ 的/ 半/ 可信/ 代理/ 者/ 把/ 授权/ 者/ 公钥/ 下/ 的/ 密文/ 变换/ 成/ 受理/ 人公钥/ 下/ 的/ 密文/ ,/ 但是/ 代理/ 者/ 以及/ 没有/ 代理人/ 合作/ 的/ 受理/ 人/ 都/ 得不到/ 任何/ 明文/ 信息/ ./ 2009/ 年/ Weng/ 等/ 人/ [/ 2/ -/ 3/ ]/ 提出/ 了/ 条件/ 代理/ 重/ 加密/ 方案/ ./ 在/ 他们/ 的/ 方案/ 中/ ,/ 只有/ 密文/ 满足/ 授权人/ 设定/ 的/ 条件/ (/ 关键字/ )/ ,/ 代理人/ 才能/ 将/ 授权人/ 的/ 密文/ 转换成/ 受理/ 人/ 可/ 解密/ 的/ 密文/ ,/ 即/ 授权人/ 可以/ 通过/ 关键字/ 限制/ 受理/ 人/ 的/ 权限/ ./ 他们/ 的/ 方案/ 可以/ 应用/ 于/ 需要/ 灵活/ 代理/ 的/ 环境/ 中/ ,/ 如/ 两个/ 云/ 用户/ 交换/ 某一/ 类型/ (/ 用/ 关键字/ 标示/ )/ 私有/ (/ 加密/ )/ 数据/ ./ 云/ 计算/ ①/ 中/ ,/ 程序/ 和/ 数据/ 不再/ 运行/ 和/ 存放/ 在/ 本地/ ,/ 而是/ 托管/ 到/ 一个/ 可/ 通过/ Internet/ 访问/ 的/ 、/ 由/ 个人/ 计算机/ 和/ 服务器/ 构成/ 的/ 集合/ ./ 用/ 传统/ 的/ 公平/ 交换/ 协议/ [/ 4/ ]/ 来/ 交易/ ,/ 需要/ 把/ 相关/ 数据/ 下载/ 到/ 本地/ 解密/ 后/ 再/ 交易/ ,/ 过程/ 包括/ 一次/ 加密/ 、/ 两次/ 解密/ 以及/ 两次/ 数据/ 传递/ ./ 而用/ 条件/ 代理/ 重/ 加密/ 只/ 需要/ 一次/ 重/ 加密/ 和/ 一次/ 数据/ 传递/ ,/ 具体/ 如下/ :/ (/ 1/ )/ 交易/ 双方/ (/ Alice/ ,/ Bob/ )/ 根据/ 关键字/ 产生/ 各自/ 的/ 条件/ 代理/ 重加/ 密钥/ ,/ 并/ 把/ 重加/ 密钥/ 发送给/ 半/ 可信/ 云/ 服务商/ ./ (/ 2/ )/ 云/ 服务商/ 随机/ 选择/ 消息/ ,/ 在/ Alice/ 设定/ 的/ 关键字/ 和/ 公钥/ 下/ 加密/ ,/ 并用/ Alice/ 的/ 重加/ 密钥/ 执行/ 重/ 加密/ ./ 最后/ 返回/ Alice/ 的/ 凭证/ (/ 包括/ 重/ 加密/ 后/ 的/ 密文/ 和/ 关于/ 消息/ 、/ 关键字/ 、/ 重/ 加密/ 后/ 密文/ 的/ 签名/ )/ ./ Bob/ 的/ 凭证/ 用/ 同样/ 的/ 方法/ 产生/ ./ (/ 3/ )/ 双方/ 把/ 各自/ 凭证/ 给/ 对方/ ./ 并/ 通过/ 解密/ 密文/ 、/ 验证/ 签名/ 来/ 判断/ 对方/ 给/ 云/ 服务商/ 的/ 代理/ 重/ 加密/ 密钥/ 是否/ 正确/ ./ (/ 4/ )/ 验证/ 完后/ 给/ 云/ 服务商/ 是否/ 正确/ 的/ 消息/ ./ (/ 5/ )/ 云/ 服务商/ 收到/ 交易/ 双方/ 都/ 返回/ “/ 正确/ ”/ 的/ 信息/ 后/ ,/ 分别/ 用/ 一方/ 的/ 条件/ 重加/ 密钥/ 重/ 加密/ 同/ 一方/ 满足条件/ 的/ 密文/ ,/ 并/ 把/ 结果/ 返回/ 给/ 另一方/ ./ 通过/ 上面/ 的/ 步骤/ 后/ ,/ 双方/ 可以/ 得到/ 各自/ 想要/ 的/ 数据/ ./ 但是/ Weng/ 等/ 人/ [/ 2/ -/ 3/ ]/ 提出/ 的/ 方案/ 不能/ 应用/ 于/ 多/ 条件/ 的/ 环境/ ./ 可以/ 肯定/ 的/ 是/ ,/ 在/ 实际/ 生活/ 中/ ,/ 交换/ 的/ 数据/ 也许/ 是/ 多个/ 关键字/ 按/ 某种/ 逻辑关系/ 的/ 组合/ ,/ 例如/ 其中/ 一个/ 交易/ 方想/ 从/ 另/ 一个/ 交易/ 方/ 那里/ 得到/ 网络通信/ 中/ 与/ 网络层/ 有关/ 的/ 安全/ 协议/ 的/ 文档/ 信息/ ./ 为了/ 使/ 方案/ 能/ 有效/ 支持/ 多个/ 条件/ 的/ 情况/ ,/ 本文/ 首次/ 采用/ 秘密/ 共享/ 机制/ [/ 5/ ]/ 构造/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 方案/ 的/ 安全性/ 是/ 基于/ 变性/ 的/ 判断/ 双线性/ Diffie/ -/ Hellman/ 问题/ ,/ 并且/ 能够/ 很/ 好/ 支持/ 多个/ 条件/ 的/ “/ 与/ ”/ 和/ “/ 或/ ”/ ./ 1.1/ 相关/ 研究/ Blaze/ 等/ 人/ [/ 1/ ]/ 首次/ 提出/ 代理/ 重/ 密码/ 的/ 概念/ ,/ 并/ 构造/ 了/ 基于/ ElGamal/ 的/ 双向/ 代理/ 重/ 加密/ 方案/ ./ 但是/ ,/ 直到/ 2006/ 年/ Ateniese/ 等/ 人/ [/ 6/ ]/ 才/ 对/ 代理/ 重/ 加密/ 进行/ 了/ 严格/ 的/ 定义/ ,/ 同时/ 提出/ 了/ 基于/ 对/ 的/ 选择/ 明文/ 安全/ 的/ 单向/ 代理/ 重/ 加密/ 方案/ ,/ 并用/ 代理/ 重/ 加密/ 设计/ 了/ 一个/ 分布式/ 存储系统/ ./ 2007/ 年/ ACMCCS/ 会议/ 上/ ,/ Canetti/ 和/ Hohenberger/ [/ 7/ ]/ 提出/ 了/ 第一个/ 能/ 在/ 标准/ 模型/ 下/ 证明/ 安全/ 的/ 双向/ 代理/ 重/ 加密/ 方案/ ./ 后来/ ,/ Libert/ 和/ Vergnaud/ [/ 8/ ]/ 在/ PKC/ 会议/ 上/ 提出/ 了/ 一个/ 基于/ 对/ 的/ 单向/ 的/ 代理/ 重/ 加密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ 选择/ 密文/ 安全/ ,/ 可/ 认为/ 是/ Canetti/ -/ Hohenberger/ 定义/ 的/ 自然/ 扩展/ ./ 2009/ 年/ AsiaCCS09/ 会议/ 上/ ,/ Weng/ 等/ 人/ [/ 2/ ]/ 提出/ 了/ 条件/ 代理/ 重/ 加密/ ,/ 在/ 方案/ 中/ 授权人/ 可以/ 控制/ 代理人/ 的/ 代理/ 权限/ ./ 同年/ ,/ Weng/ 等/ 人/ [/ 3/ ]/ 在/ ISO09/ 会议/ 上/ 提出/ 了/ 一个/ 更/ 高效/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ./ 他们/ 的/ 两个/ 方案/ 都/ 是/ 基于/ 对/ 运算/ 的/ ,/ 且/ 都/ 是/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 安全/ 的/ ,/ 但/ 不能/ 很/ 好/ 支持/ 多个/ 条件/ ./ 2010/ 年/ ,/ Shao/ 等/ 人/ 在/ 文献/ [/ 9/ ]/ 中/ 提出/ 具有/ 关键字/ 搜索/ 的/ 代理/ 重/ 加密/ 方案/ ,/ 方案/ 中/ 受理/ 人/ 的/ 网关/ 能够/ 检测/ 转换/ 后/ 的/ 密文/ 是否/ 包含/ 特定/ 的/ 关键字/ ./ 1.2/ 本文/ 方案/ 本文/ 采用/ 秘密/ 共享/ 机制/ 来/ 设计/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 此/ 方案/ 能/ 很/ 好/ 支持/ 多个/ 条件/ 的/ “/ 与/ ”/ 和/ “/ 或/ ”/ 运算/ ,/ 并/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 了/ 它/ 的/ 安全性/ 是/ 基于/ 变性/ 的/ 判断/ 双线性/ Diffie/ -/ Hellman/ 问题/ ./ 为了/ 满足/ 多/ 条件/ 的/ 代理/ 重/ 加密/ 要求/ ,/ 需要/ 对/ 密钥/ 共享/ 技术/ 进行/ 适当/ 改变/ ./ 特别/ 是/ 在/ 生成/ 密钥/ 片时/ 不/ 公开/ 拉格朗/ 日/ 系数/ ,/ 也/ 不/ 提供/ 对应/ 多项式/ 的/ 值/ ./ 而是/ 用/ 关键字/ W/ / =/ (/ w/ / 1/ ,/ w/ / 2/ ,/ …/ ,/ w/ / t/ )/ 和/ n/ -/ t/ +/ 1/ 个/ 随机数/ ki/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ -/ t/ +/ 1/ )/ 生成/ 两/ 部分/ 代理/ 重密/ ①/ 可/ 参见/ WindowsAzurePlatform/ [/ EB/ // OL/ ]/ ./ 2009.07/ ./ Page3/ 钥片/ ,/ 其中/ 一部分/ 为/ 关键字/ 的/ 代理/ 重/ 加密/ 密钥/ 而/ 另/ 一部分/ 为/ 随机数/ 的/ 代理/ 重/ 加密/ 密钥/ rkkj/ =/ g/ 这/ 一部分/ 可以/ 合并/ ./ 这里/ f/ 为/ 一/ n/ 阶/ 多项式/ ,/ 而/ lw/ / lkj/ 为/ 拉格朗/ 日/ 系数/ ./ 2/ 预备/ 知识/ 2.1/ 双线性/ 对设/ G1/ 和/ G2/ 是/ 两个/ p/ 阶/ 循环群/ ,/ p/ 为/ 一大/ 素数/ ,/ 两个/ 群/ 之间/ 的/ 双线性/ 对/ e/ :/ G1/ ×/ G1/ →/ G2/ 是/ 满足/ 以下/ 条件/ 的/ 映射/ :/ (/ 1/ )/ 双线性/ 性/ ./ / g1/ ,/ g2/ ∈/ G1/ ,/ / a/ ,/ b/ ∈/ Zp/ ,/ 满足/ 1/ ,/ gb2/ )/ =/ e/ (/ g1/ ,/ g2/ )/ ab/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ / g1/ ,/ g2/ ∈/ G1/ 满足/ e/ (/ g1/ ,/ g2/ )/ ≠/ 1G2/ ./ (/ 3/ )/ 可计算性/ ./ 对/ / g1/ ,/ g2/ ∈/ G1/ ,/ 存在/ 高效/ 的/ 算法/ e/ (/ ga/ 能/ 计算/ 出/ e/ (/ g1/ ,/ g2/ )/ ./ 2.2/ 复杂性/ 假设/ 设/ G1/ 和/ G2/ 是/ 两个/ p/ 阶/ 循环群/ ,/ p/ 为/ 一大/ 素数/ ,/ 两个/ 群/ 之间/ 的/ 双线性/ 对/ e/ :/ G1/ ×/ G1/ →/ G2/ 和/ G1/ 的/ 生成元/ g/ ./ 定义/ 1/ ./ 变性/ 的/ 判定/ 双线性/ 对/ 的/ Diffie/ -/ Hellman/ 问题/ (/ mDBDHP/ )/ ./ 已知/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ )/ 和/ 另/ 一个/ 元素/ Q/ ∈/ G2/ ,/ 判定/ 是否/ Q/ =/ ?/ e/ (/ g/ ,/ g/ )/ ab/ // c/ 成立/ ./ 它/ 等价/ 于/ 判定/ 双线性/ 对/ 的/ Diffie/ -/ Hellma/ 问题/ (/ DBDHP/ )/ ./ 2.3/ 条件/ 代理/ 重/ 加密/ 括/ 以下/ 6/ 个/ 算法/ [/ 2/ -/ 3/ ]/ ./ 定义/ 2/ ./ 一个/ 单向/ 的/ 条件/ 代理/ 重/ 加密算法/ 包/ (/ 1/ )/ SetUp/ (/ λ/ )/ ./ 给定/ 安全/ 参数/ λ/ ,/ 算法/ 输出/ 全局/ 参数/ param/ ./ (/ 2/ )/ KeyGen/ (/ i/ )/ ./ 为/ 用户/ Ui/ 产生/ 公私/ 钥对/ (/ pki/ ,/ ski/ )/ ./ (/ 3/ )/ RkeyGen/ (/ ski/ ,/ pkj/ ,/ w/ / )/ ./ 给定/ 用户/ Ui/ 的/ 私钥/ ski/ 、/ 关键字/ w/ / 和/ 用户/ Uj/ 的/ 公钥/ pkj/ ,/ 用户/ Ui/ 计算/ 出/ 代理/ 重加/ 密钥/ rkiw/ / j/ ./ (/ 4/ )/ Encrypt/ (/ pki/ ,/ m/ ,/ w/ )/ ./ 输入/ pki/ 、/ 关键字/ w/ (/ 5/ )/ ReEncrypt/ (/ CTi/ ,/ rkiw/ / j/ )/ ./ 给定/ 密文/ CTi/ 和/ 代理/ 重加/ 密钥/ rkiw/ / j/ ,/ 当/ w/ =/ w/ / ,/ 输出/ 基于/ 公钥/ pkj/ 的/ 密文/ CTj/ ,/ 否则/ ,/ 输出/ ⊥/ ./ (/ 6/ )/ Decrypt/ (/ CT/ ,/ sk/ )/ ./ 给定/ 私钥/ sk/ 和/ 密文/ 和/ 消息/ m/ ,/ 输出/ 与/ w/ 有关/ 的/ 密文/ CTi/ ./ CT/ ,/ 输出/ 消息/ m/ 或者/ 是/ 一个/ 错误/ 符号/ ⊥/ ./ 对/ 任意/ w/ / 、/ 任意/ 的/ (/ m/ ,/ w/ )/ 以及/ 任意/ 的/ (/ pki/ ,/ ski/ )/ ←/ KeyGen/ (/ i/ )/ 、/ (/ pkj/ ,/ skj/ )/ ←/ KeyGen/ (/ j/ )/ 和/ CTi/ ←/ Encrypt/ (/ pki/ ,/ m/ ,/ w/ )/ ,/ 一个/ 正确/ 的/ 条件/ 代理/ 重/ 加密/ 必须/ 满/ 下面/ 两个/ 性质/ :/ (/ 1/ )/ Pr/ [/ Decrypt/ (/ CTi/ ,/ ski/ )/ =/ m/ ]/ =/ 1/ ./ (/ 2/ )/ 若/ w/ =/ w/ / ,/ 有/ Pr/ [/ Decrypt/ (/ ReEncrypt/ (/ CTi/ ,/ RkeyGen/ (/ ski/ ,/ w/ ,/ pkj/ )/ )/ ,/ skj/ )/ =/ m/ ]/ =/ 1/ ,/ 否则/ Pr/ [/ Decrypt/ (/ ReEncrypt/ (/ CTi/ ,/ RkeyGen/ (/ ski/ ,/ w/ ,/ pkj/ )/ )/ ,/ skj/ )/ =/ ⊥/ ]/ / 1/ -/ neg/ (/ λ/ )/ ./ 代理/ 重/ 加密算法/ 也/ 包括/ 了/ 上述/ 6/ 个/ 算法/ ,/ 只是/ 输入/ 的/ 时候/ 没有/ 关键字/ ./ 3/ 条件/ 代理/ 重/ 加密/ 方案/ 分析/ 在/ Weng/ 等/ 人/ 的/ 方案/ [/ 2/ ]/ 中/ ,/ 授权人/ 的/ 密文/ 为/ (/ A/ =/ grH4/ (/ e/ (/ gx/ -/ 1/ 人用/ 代理/ 重加/ 密钥/ rk/ =/ gxjx/ -/ 1pki/ )/ x/ -/ 1i/ 转换成/ 受理/ 人/ 的/ 密文/ (/ B/ =/ e/ (/ B/ ,/ rk/ )/ ,/ C/ =/ C/ / H4/ (/ e/ (/ A/ ,/ ck/ )/ )/ )/ ./ 这里/ {/ g/ ,/ g1/ ,/ f/ ,/ f1/ ,/ H1/ ,/ H2/ ,/ H3/ ,/ H4/ ,/ H5/ }/ 为/ 全局/ 参数/ ;/ (/ gxi/ ,/ gx/ -/ 1/ (/ xi/ ,/ x/ -/ 1i/ )/ 为/ 私钥/ ;/ r/ 是/ 一个/ 随机数/ ,/ 且/ r/ =/ H1/ (/ m/ ,/ r/ ,/ w/ )/ ,/ w/ 是/ 消息/ m/ 的/ 关键字/ ./ 显然/ ,/ (/ B/ =/ gxir/ ,/ C/ =/ H2/ (/ e/ (/ g/ ,/ g/ )/ r/ )/ / (/ m/ ‖/ r/ )/ )/ 可以/ 认为/ 是/ 另/ 一个/ 代理/ 重/ 加密/ 中/ 授权人/ 的/ 密文/ ,/ 因为/ 可以/ 通过/ 代理/ 钥/ rk/ 转换成/ 公钥/ (/ gxj/ ,/ gx/ -/ 1/ 文/ (/ B/ =/ e/ (/ g/ ,/ g/ )/ xjr/ ,/ C/ =/ H2/ (/ e/ (/ g/ ,/ g/ )/ r/ )/ / (/ m/ ‖/ r/ )/ )/ ;/ 而/ (/ A/ =/ gr/ 看成/ 是/ 基于/ 身份/ w/ 的/ 密文/ ,/ 私钥/ 为/ ck/ ./ 很/ 容易/ 看出/ 他们/ 的/ 方案/ 是/ 通过/ 基于/ 身份/ (/ 关键字/ )/ 的/ 加密/ 机制/ 限制/ 代理/ 权限/ ./ 然而/ ,/ 采用/ 这种/ 方法/ 构造/ 的/ 条件/ 代理/ 重/ 加密/ 不能/ 很/ 好/ 支持/ 多个/ 条件/ 的/ “/ 与/ ”/ 和/ “/ 或/ ”/ 的/ 情况/ ./ 假设/ W/ =/ (/ w1/ ,/ w2/ ,/ …/ ,/ ws/ )/ 是/ 消息/ 关键字/ ,/ W/ / =/ (/ w/ / 1/ ,/ w/ / 2/ ,/ …/ ,/ w/ / t/ )/ 是/ 授权人/ 设定/ 的/ 关键字/ :/ (/ 1/ )/ “/ 与/ ”/ ./ 由于/ 消息/ m/ 的/ 关键字/ W/ 与/ 授权人/ 设定/ W/ / 不/ 一定/ 相同/ ,/ 我们/ 不能/ 构造/ 代理/ 重/ 加密/ 方案/ 通过/ 更新/ 条件/ 钥/ ck/ =/ H3/ (/ h/ (/ w/ / 1/ …/ w/ / t/ )/ ,/ pki/ )/ x/ -/ 1/ 改/ 密文/ C/ =/ C/ / H4/ (/ e/ (/ gx/ -/ 1pka/ )/ )/ r/ )/ ;/ 或/ 更新/ 条件/ 钥/ ck/ =/ {/ ck1/ ,/ …/ ,/ ckt/ }/ =/ {/ H3/ (/ w/ / 1/ ,/ pki/ )/ x/ -/ 1a/ ,/ …/ ,/ H3/ (/ w/ / m/ ,/ pki/ )/ x/ -/ 1Page4H4/ (/ e/ (/ gx/ -/ 1H3/ (/ ws/ ,/ pki/ )/ )/ r/ )/ ./ 这里/ 的/ h/ 为/ 一/ Hash/ 函数/ ./ 为了/ 能/ 达到/ 条件/ 限制/ ,/ 需要/ 比较/ W/ 和/ W/ / ,/ 根据/ 不同/ 的/ 情况/ 分别/ 加密/ ,/ 例如/ W/ / 是/ W/ 的/ 子集/ ,/ 用/ W/ / 加密/ ,/ 否则/ 用/ W/ 加密/ ./ 这/ 显然/ 不/ 符合实际/ 情况/ ./ (/ 2/ )/ “/ 或/ ”/ ./ 修改/ 条件/ 钥/ ck/ =/ {/ ck1/ ,/ …/ ,/ ckt/ }/ =/ {/ H3/ (/ w/ / 1/ ,/ pka/ )/ x/ -/ 1H4/ (/ e/ (/ H3/ (/ w1/ ,/ pki/ )/ )/ r/ )/ ,/ …/ ,/ C/ / H4/ (/ e/ (/ gx/ -/ 1pki/ )/ )/ r/ )/ }/ ./ 虽然/ 修改/ 后/ 的/ 方案/ 满足/ 正确性/ ,/ 但/ 非常/ 低效/ ./ 同年/ ,/ Weng/ 等/ 人/ [/ 3/ ]/ 提出/ 另/ 一个/ 更/ 有效/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 在/ 这个/ 方案/ 中/ 代理人/ 只/ 需要/ 一个/ 代理/ 钥/ ./ 但是/ 方案/ 同样/ 不能/ 有效/ 支持/ 多个/ 条件/ 的/ 情况/ ,/ 因为/ 方案/ 还是/ 雇用/ 了/ 基于/ 身份/ 的/ 加密/ 机制/ 思想/ 来/ 限制/ 代理/ 权限/ ./ 4/ 本文/ 方案/ 在/ 秘密/ 共享/ 机制/ 的/ 基础/ 上/ ,/ 我们/ 将/ 构造/ 一个/ 新/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 并/ 给出/ 正确性/ 和/ 安全性/ 证明/ ./ 在/ 描述/ 方案/ 前/ ,/ 我们/ 以/ 多个/ 关键字/ “/ 与/ ”/ 简要/ 概述/ 构造/ 的/ 思路/ :/ 设/ (/ Setup/ ,/ KG/ ,/ RG/ ,/ E/ ,/ Re/ ,/ D/ )/ 是/ 一个/ 代理/ 重/ 加密算法/ ,/ 其中/ rk/ 为/ 代理/ 重加/ 密钥/ ./ 另外/ ,/ 设/ W/ =/ (/ w1/ ,/ w2/ ,/ …/ ,/ ws/ )/ 是/ 消息/ 关键字/ ,/ W/ / =/ (/ w/ / 1/ ,/ w/ / 2/ ,/ …/ ,/ w/ / t/ )/ 是/ 授权人/ 设定/ 的/ 关键字/ ./ 一般来说/ ,/ 在/ 多个/ 关键字/ 需要/ 比较/ 的/ 情况/ 下/ ,/ 加密/ 需要/ 分别/ 为/ 每个/ 关键字/ 生成/ 相关/ 的/ 消息/ ,/ 我们/ 假设/ B/ =/ (/ B1/ ,/ …/ ,/ Bs/ )/ ./ 我们/ 的/ 想法/ 是/ 用/ 秘密/ 共享/ 的/ 思想/ 对/ 代理/ 重加/ 密钥/ rk/ 按/ W/ / 进行/ 密钥/ 分片/ ,/ 利用/ B/ 进行/ 条件/ 控制/ ./ 然而/ ,/ 代理人/ 知道/ 关键字/ 和/ 密钥/ 片/ 可以/ 恢复/ 出/ rk/ ,/ 这样/ 代理人/ 可以/ 产生/ 其它/ 关键字/ 的/ 重加/ 密钥/ ./ 为了/ 防止/ 这样/ 情况/ ,/ 我们/ 用/ 关键字/ W/ / 和/ 随机数/ 将/ rk/ 分成/ 关键字/ 代理/ 密钥/ 片/ (/ rkw/ / 密钥/ 片/ rkAB/ ,/ 随机数/ 不/ 公开/ ./ 方案/ 中/ ,/ 可以/ 提取/ 出/ 另/ 一个/ 代理/ 重/ 加密/ 方案/ ./ 若/ 我们/ 的/ 方案/ 和/ 所/ 提取/ 的/ 方案/ 的/ 系统/ 参数/ 、/ 加密/ 消息/ 和/ 加密/ 消息/ 时所选/ 随机数/ 一致/ ,/ 则/ 满足/ φ/ (/ Bk1/ ,/ C/ ,/ rkw/ / C/ ,/ rkAB/ )/ =/ Re/ (/ A/ ,/ C/ ,/ rk/ )/ ,/ (/ A/ ,/ C/ )/ 为/ 提取/ 方案/ 的/ 授权人/ 密文/ ,/ (/ A/ ,/ B/ ,/ C/ )/ 是/ 我们/ 方案/ 的/ 授权人/ 密文/ ,/ φ/ ,/ φ/ 为/ 我们/ 的/ 方案/ 中重/ 加密算法/ 的/ 子/ 算法/ ./ 4.1/ 方案/ 描述/ SetUp/ (/ λ/ )/ ./ 系统/ 参数/ 由/ (/ λ/ ,/ p/ ,/ G1/ ,/ G2/ ,/ e/ ,/ g/ ,/ z/ ,/ H1/ ,/ H2/ )/ 构成/ ./ 其中/ G1/ ,/ G2/ 是/ 阶为/ p/ 的/ 循环群/ ,/ e/ :/ G1/ ×/ G1/ →/ G2/ 是/ 两个/ 群间/ 的/ 双线性/ 对/ ;/ g/ 是/ G1/ 的/ 生成元/ ,/ 并/ 定义/ z/ =/ e/ (/ g/ ,/ g/ )/ ;/ H1/ :/ G2/ →/ G1/ 和/ H2/ :/ G2/ ×/ G2/ →/ {/ 0/ ,/ 1/ }/ / 是/ 两个/ 抗/ 碰撞/ 的/ Hash/ 函数/ ./ KeyGen/ (/ i/ )/ ./ 用户/ Ui/ 选择/ 多项式/ fi/ (/ x/ )/ =/ ai0/ +/ ai1x/ +/ …/ +/ ainxn/ ,/ aij/ ∈/ Z/ / 公钥/ pki/ =/ (/ gai0/ ,/ gai2/ ,/ …/ ,/ gain/ )/ 和/ 保密/ 私钥/ ski/ =/ (/ ai0/ ,/ ai1/ ,/ …/ ,/ ain/ )/ ./ RkeyGen/ (/ skA/ ,/ pkB/ ,/ W/ / )/ ./ 给定/ 私钥/ skA/ ,/ 公钥/ pkB/ 和/ 关键字/ W/ / =/ (/ w/ / 1/ ,/ w/ / 2/ ,/ …/ ,/ w/ / t/ )/ ,/ 这里/ 考虑/ 的/ 是/ 多个/ 条件/ “/ 与/ ”/ 的/ 情况/ ,/ 并/ 要求/ t/ </ n/ ./ 按/ 如下/ 步骤/ 输出/ 代理/ 重加/ 密钥/ rk/ :/ (/ 1/ )/ 选择/ n/ -/ t/ +/ 1/ 个/ 随机数/ ki/ ∈/ Z/ / n/ -/ m/ +/ 1/ )/ ,/ 计算/ 拉格朗/ 日/ 系数/ i/ =/ ∏/ tlw/ / j/ =/ 1/ ,/ j/ ≠/ ilki/ =/ ∏/ t/ (/ 2/ )/ 计算/ 关键字/ 的/ 代理/ 密钥/ 片/ rkw/ / 1/ ,/ 2/ ,/ …/ ,/ t/ )/ 和/ 随机数/ 代理/ 密钥/ 片/ rkAB/ =/ ∏/ n/ -/ t/ +/ 1Encrypt/ (/ pki/ ,/ m/ ,/ W/ )/ ./ 给定/ pkA/ ,/ 消息/ m/ 及/ 关键字/ W/ =/ (/ w1/ ,/ w2/ ,/ …/ ,/ ws/ )/ ,/ 按/ 如下/ 步骤/ 输出/ 密文/ CTA/ ./ (/ 1/ )/ 计算/ A/ =/ pkrA0/ =/ gaA0r/ ,/ Bi/ =/ grf/ (/ H/ (/ wi/ )/ )/ =/ [/ gaA0/ (/ gaA1/ )/ H1/ (/ wi/ )/ …/ (/ gaAn/ )/ H1/ (/ wi/ )/ n/ ]/ r/ ,/ i/ =/ 1/ ,/ …/ ,/ s/ ,/ C/ =/ zrm/ ,/ D/ =/ H2/ (/ zr/ ,/ C/ )/ ./ 随机数/ r/ ∈/ Z/ / (/ 2/ )/ 输出/ CTA/ =/ (/ A/ ,/ B1/ ,/ B2/ ,/ …/ ,/ Bs/ ,/ C/ ,/ D/ )/ ./ ReEncrypt/ (/ CT/ ,/ rk/ )/ )/ ./ 给定/ 密文/ CTA/ 和/ 重/ 加密/ i/ 和/ rkAB/ ,/ 按/ 如下/ 步骤/ 产生/ 公钥/ pkB/ 下/ 的/ 密文/ :/ (/ 1/ )/ 判断/ w/ / 1/ =/ wj1/ ∩/ w/ / 2/ =/ wj2/ ∩/ …/ ∩/ w/ / t/ =/ wjt/ ./ 这里/ j1/ ,/ …/ ,/ jt/ 分别/ 为/ w/ / i/ (/ i/ =/ 1/ ,/ …/ ,/ m/ )/ 在/ W/ =/ (/ w1/ ,/ w2/ ,/ …/ ,/ ws/ )/ 中/ 的/ 下标/ ./ (/ 2/ )/ 若/ 满足/ ,/ 输出/ 密文/ CTB/ =/ (/ A/ ,/ C/ ,/ D/ )/ ,/ 其中/ A/ =/ e/ (/ Bj1/ ,/ rkw1/ )/ …/ e/ (/ Bjt/ ,/ rkwt/ )/ e/ (/ A/ ,/ rkAB/ )/ ;/ 否则/ 输出/ 错误/ 符号/ ⊥/ ./ 事实上/ 有/ A/ =/ e/ (/ g/ ,/ g/ )/ ∑/ t/ 钥/ rkw/ / Page5/ 按/ 如下/ 两种/ 方式/ 解密/ :/ Decrypt/ (/ CTu/ ,/ sku/ )/ ./ 给定/ 密文/ CTu/ 和/ 私钥/ sku/ ,/ (/ 1/ )/ CTu/ 为/ 原始/ 密文/ CTA/ =/ (/ A/ ,/ B1/ ,/ …/ ,/ Bs/ ,/ C/ ,/ D/ )/ :/ 检查/ 等式/ 是否/ 成立/ :/ Aa/ -/ 11/ ,/ …/ ,/ s/ )/ ,/ D/ =/ H2/ (/ Z/ =/ e/ (/ A/ ,/ g/ )/ a/ -/ 1CZ/ -/ 1/ ,/ 否则/ 输出/ 错误/ 符号/ ⊥/ ./ (/ 2/ )/ CTu/ 为/ 转换/ 后/ 的/ 密文/ CTB/ =/ (/ A/ ,/ C/ ,/ D/ )/ :/ 检查/ D/ =/ H2/ (/ T/ =/ Aa/ -/ 1CT/ -/ 1/ ,/ 否则/ 输出/ 错误/ 符号/ ⊥/ ./ 加/ 密钥/ 和/ 代理/ 重/ 加密算法/ ,/ 如下/ :/ 当/ 多个/ 条件/ “/ 或/ ”/ 的/ 时候/ ,/ 仅仅/ 需要/ 改变/ 代理/ 重/ i/ =/ g/ 在/ 生成/ 代理/ 重/ 加密/ 密钥/ 时/ ,/ 需要/ 选择/ nt/ 个/ 随机数/ kij/ ∈/ Z/ / (/ kt1/ ,/ …/ ,/ ktn/ )/ ./ 利用/ 上面/ 的/ 代理/ 重/ 加密/ 密钥/ 生成/ 算法/ 分别/ 对/ w/ / i/ ,/ 利用/ 随机数/ Ki/ ,/ 产生/ 重/ 加密/ 密钥/ rki/ =/ (/ rkw/ / 即/ 在/ 多个/ 条件/ “/ 或/ ”/ 时/ ,/ 重/ 加密/ 密钥/ 为/ rk/ =/ (/ rk1/ ,/ rk2/ ,/ …/ ,/ rkt/ )/ ./ CTB/ =/ (/ e/ (/ Bi/ ,/ rkw/ / t/ }/ ,/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ s/ }/ ./ 同样/ 可以/ 应用/ 于/ 条件/ “/ 与/ ”/ 和/ “/ 或/ ”/ 混合/ 的/ 情况/ ./ 4.2/ 正确性/ 为了/ 表述/ 方便/ ,/ 我们/ 假设/ 授权人/ 设定/ 的/ 关键字/ 为/ 消息/ 关键字/ 的/ 前/ t/ 个/ ,/ 方案/ 的/ 正确性/ 由/ 下面/ 两个/ 等式/ 保证/ :/ 而/ 代理/ 重/ 加密/ 的/ 算法/ 改为/ :/ 若/ w/ / (/ 1/ )/ m/ =/ C/ (/ 2/ )/ m/ =/ C4/ ./ 3/ 性能/ 分析/ 假设/ 用户/ 选择/ 了/ n/ 阶/ 多项式/ ;/ 授权人/ 设定/ 的/ 关键字/ 的/ 个数/ 为/ t/ ;/ 消息/ 的/ 关键字/ 的/ 个数/ 为/ s/ ./ 在/ 和/ Weng/ 等/ 人/ [/ 2/ -/ 3/ ]/ 的/ 方案/ 作/ 比较/ 时/ (/ 表/ 1/ ,/ 表/ 2/ )/ ,/ 由于/ 他们/ 的/ 方案/ 不能/ 有效/ 支持/ 条件/ 的/ “/ 与/ ”/ 逻辑/ ,/ 且/ Weng/ 等/ 人/ 也/ 没有/ 具体/ 给出/ 多/ 条件/ “/ 或/ ”/ 的/ 构造/ ,/ 所以/ 我们/ 在/ 计算/ 他们/ 的/ 代价/ 时/ 按/ 级联/ 的/ 方式/ 给出/ (/ 这样/ 构造/ 方案/ 可以/ 保证/ 正确/ ,/ 但/ 不/ 一定/ 具有/ 选择/ 密文/ 安全/ )/ ./ 另外/ ,/ 假设/ 每/ 一级/ 联/ 模块/ 所选/ 的/ 随机数/ 相同/ 且/ 相同/ 部分/ 只/ 传输/ 一次/ ./ 例如/ :/ 在/ 方案/ [/ 2/ ]/ 中/ ,/ 原始/ 密文/ 是/ 一个/ 四元组/ (/ A/ ,/ B/ ,/ C/ ,/ D/ )/ 且/ A/ ,/ B/ 与/ 随机数/ 有关/ ,/ 若/ 把/ 它/ 扩展/ 成/ s/ 个/ 关键字/ “/ 或/ ”/ 的/ 情形/ ,/ 原始/ 密文/ 为/ {/ A/ ,/ B/ ,/ (/ C1/ ,/ D1/ )/ ,/ …/ ,/ (/ Cs/ ,/ Ds/ )/ }/ ,/ 而/ 不是/ {/ (/ A1/ ,/ B1/ ,/ C1/ ,/ D1/ )/ ,/ …/ ,/ (/ As/ ,/ Bs/ ,/ Cs/ ,/ Ds/ )/ }/ ./ 显然/ ,/ 计算/ 代价/ 包括/ 计算/ A/ ,/ B/ 和/ (/ C1/ ,/ D1/ )/ ,/ …/ ,/ (/ Cs/ ,/ Ds/ )/ ,/ 传输/ 带宽/ 也/ 只/ 包括/ A/ ,/ B/ 和/ (/ C1/ ,/ D1/ )/ ,/ …/ ,/ (/ Cs/ ,/ Ds/ )/ ./ 从/ 上面/ 的/ 算法/ 可知/ 用户/ 需要/ 保存/ n/ 个/ 私钥/ ,/ 多/ 条件/ “/ 与/ ”/ 时/ 需要/ 生成/ t/ +/ 1/ 个/ 代理/ 重加/ 密钥/ ,/ 多个/ 条件/ “/ 或/ ”/ 时/ 需要/ 2t/ 个/ ;/ 原始/ 密文/ 包括/ 了/ s/ +/ 3/ 个/ 模块/ ,/ 传输/ 的/ 带宽/ 为/ (/ s/ +/ 2/ )/ logp/ 数/ 的/ 输出/ 长度/ ;/ 转换/ 后/ 的/ 密文/ 包括/ 了/ 3/ 个/ 模块/ ,/ 传输/ 的/ 带宽/ 为/ 2logp/ 方案/ 私钥/ 文献/ [/ 2/ ]/ 2t/ +/ 1/ (/ s/ +/ 2/ )/ logp/ 文献/ [/ 3/ ]/ 中/ 方案/ 112t/ (/ 2s/ +/ 1/ )/ logp/ 本文/ 方案/ n2t/ (/ s/ +/ 2/ )/ logp/ 由于/ 用户/ 密钥/ 和/ 代理/ 重/ 密钥/ 的/ 生成/ 只/ 需/ 一次/ ,/ 所以/ 我们/ 只/ 分析/ 加密算法/ 、/ 重/ 加密算法/ 和/ 解密/ 算法/ 的/ 时间/ 复杂性/ ./ 为了/ 简单/ ,/ 我们/ 只/ 考虑/ 用时/ 多/ 的/ 乘法/ 运算/ 、/ 指数/ 运算/ (/ 包括/ 逆运算/ )/ 和/ 对/ 运算/ ,/ 并/ 分别/ 用/ Tmu/ ,/ Tme/ 和/ Tpar/ 表示/ ./ 在/ 我们/ 的/ 方案/ 中/ ,/ 加密算法/ 的/ 主要/ 花费/ 在/ 计算/ Bi/ ,/ Bi/ 的/ 计算/ 包括/ H1/ (/ wi/ )/ ,/ …/ ,/ H1/ (/ wi/ )/ n/ 的/ 计算/ (/ 需要/ (/ n/ -/ 1/ )/ Tmu/ )/ 和/ gaA0/ (/ gaA1/ )/ H1/ (/ wi/ )/ …/ (/ gaAn/ )/ H1/ (/ wi/ )/ n/ 的/ 计算/ (/ 需要/ nTmu/ 和/ nTme/ )/ ,/ 所以/ 加密/ 需要/ 的/ 总/ 运算/ 包括/ (/ 2ns/ -/ s/ +/ 1/ )/ 次/ 乘法/ 运算/ 和/ (/ sn/ +/ 2/ )/ 次/ 指数/ 运算/ ;/ 在/ 重/ 加密/ 中/ 计算/ A/ (/ 需要/ 2Tpar/ )/ ;/ 原始/ 密文/ 解密/ 计算/ f/ (/ H1/ (/ wi/ )/ )/ -/ 1/ (/ 需要/ (/ 2n/ -/ 1/ )/ Tmu/ 和/ Tme/ )/ ,/ 所以/ 总/ 运算/ 为/ (/ 2ns/ -/ s/ +/ 1/ )/ 次/ 乘法/ 运算/ 、/ (/ s/ +/ 5/ )/ 次/ 指数/ 运算/ 和/ 一次/ 对/ 运算/ ;/ 转换/ 后/ 的/ 密文/ 解密/ 需要/ 3Tme/ +/ Tmu/ ./ 实际上/ ,/ 在/ 多个/ 条件/ “/ 或/ ”/ 时/ ,/ 只/ 需/ 选择/ 一个/ 二阶/ 多项式/ 就/ 可以/ 保证/ 安全/ ./ 这样/ ,/ 本文/ 方案/ 在/ 乘法/ 和/ 指数/ 运算/ 上/ 的/ 次数/ 和/ Weng/ 等/ 人/ [/ 2/ -/ 3/ ]/ 方案/ 相当/ ,/ 但是/ 显著/ 地/ 降低/ 了/ 运算/ 的/ 次数/ ./ Page6/ 方案/ 加密/ 重/ 加密/ 原始/ 密文/ 文献/ [/ 2/ ]/ 文献/ [/ 3/ ]/ 中/ 方案/ 1/ 本/ 方案/ (/ 2ns/ -/ s/ +/ 1/ )/ Tmu5/ 安全性/ 分析/ 这/ 一节/ ,/ 将/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 本文/ 方案/ 是/ IND/ -/ CPRE/ -/ CCA/ 安全/ [/ 2/ ]/ ./ 定理/ 1/ ./ 假设/ 在/ (/ G1/ ,/ G2/ )/ 中/ ,/ 变性/ 的/ 判定/ 双线/ 对/ Diffie/ -/ Hellman/ 问题/ (/ mDBDHP/ )/ 是/ 困难/ 的/ ,/ 则/ 方案/ 在/ 随机/ 预言/ 模型/ 下/ 是/ IND/ -/ CPRE/ -/ CCA/ 安全/ ./ 证明/ ./ 区分/ 者/ / 收到/ 一个/ 随机/ 实例/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Q/ )/ ,/ 他/ 的/ 目标/ 是/ 判断/ Q/ =/ e/ (/ g/ ,/ g/ )/ ab/ // c/ 是否/ 成立/ ./ / 把/ 攻击者/ / 作为/ 子程序/ 并/ 扮演/ IND/ -/ CPRE/ -/ CCA/ 游戏/ 中/ / 的/ 挑战者/ ,/ 假设/ 攻击者/ / 以/ ε/ 的/ 优势/ 赢得/ 游戏/ ./ 游戏/ 一/ 开始/ ,/ / 将/ 系统/ 参数/ param/ =/ (/ g/ ,/ e/ ,/ Z/ =/ e/ (/ g/ ,/ g/ )/ ,/ H1/ ,/ H2/ )/ 发送给/ / ./ 采用/ 文献/ [/ 2/ ]/ 中/ 的/ 方法/ :/ / 利用/ 一个/ 有/ 偏量/ coin/ ∈/ {/ 0/ ,/ 1/ }/ 产生/ 不同/ 的/ 公钥/ 并存/ 放在/ 列表/ k/ _/ list/ ,/ 若/ coin/ =/ 0/ ,/ 公钥/ 为/ gx0/ ,/ …/ ,/ gxn/ (/ 表示/ 用户/ 已/ 腐化/ ,/ 可以/ 询问/ 到/ 私钥/ x0/ ,/ …/ xn/ )/ ,/ 反之/ ,/ 公钥/ 为/ gcx0/ ,/ …/ ,/ gcxn/ (/ 表示/ 不能/ 询问/ 到/ 私钥/ cx1/ ,/ …/ ,/ cxn/ )/ ,/ 进一步/ ,/ / 模拟出/ 条件/ 代理/ 重加/ 密钥/ 并存/ 放在/ 列表/ rk/ _/ list/ ./ 另外/ ,/ / 还/ 需要/ 维护/ 两个/ Hash/ 列表/ H1/ _/ list/ 和/ H2/ _/ list/ ./ 这些/ 列表/ 初始化/ 都/ 为/ 空/ ./ / 通过/ 列表/ 的/ 信息/ 回答/ / 的/ 重/ 加密/ 和/ 解密/ 询问/ ./ 询问/ 结束/ 后/ ,/ / 利用/ 随机/ 实例/ 中/ 的/ 信息/ 生成/ 一个/ 密文/ 返回/ 给/ / ,/ 并/ 根据/ / 的/ 回答/ 判断/ ./ 具体/ 如下/ :/ Hash/ 询问/ ./ 任何/ 时间/ / 可以/ 询问/ H1/ ,/ H2/ :/ H1/ (/ w/ )/ 询问/ :/ 假如/ 列表/ H1/ _/ list/ 存在/ (/ w/ ,/ h1/ )/ ,/ 则/ 返回/ h1/ ;/ 否则/ ,/ 随机/ 选择/ h1/ ∈/ Z/ / H1/ _/ list/ 并/ 返回/ h1/ ;/ H2/ (/ H/ ,/ C/ )/ 询问/ :/ 假如/ (/ H/ ,/ c/ ,/ h2/ )/ 在/ 列表/ H2/ _/ list/ 中/ ,/ 则/ 输出/ h2/ ;/ 否则/ 随机/ 选择/ h2/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ 添加/ (/ H/ ,/ c/ ,/ h2/ )/ 到/ H2/ _/ list/ ,/ 同时/ 返回/ h2/ ./ 阶段/ 1/ ./ 在/ 这个/ 阶段/ ,/ 攻击者/ / 可以/ 要求/ / 回答/ IND/ -/ CPRE/ -/ CCA/ 游戏/ 中/ 的/ 一系列/ 询问/ :/ 公钥/ 产生/ 询问/ (/ i/ )/ :/ / 首先/ 定义/ 一个/ 随机数/ coin/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 满足/ Pr/ [/ coin/ =/ 0/ ]/ =/ δ/ ./ 然后/ 选择/ xij/ ∈/ Zp/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ n/ )/ ,/ 如果/ (/ coini/ =/ 0/ )/ ,/ 则/ 公钥/ 为/ pkij/ =/ gxij/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ n/ )/ ,/ 否则/ 为/ pkij/ =/ gcxij/ ./ 最后/ 增加/ (/ pki0/ ,/ …/ ,/ pkin/ ,/ xi0/ ,/ …/ ,/ xin/ ,/ coin/ )/ 到/ 列表/ k/ _/ list/ ;/ 私钥/ 产生/ 询问/ (/ i/ )/ :/ 从/ k/ _/ list/ 查找/ (/ pki0/ ,/ …/ ,/ pkin/ ,/ xi0/ ,/ …/ ,/ xin/ ,/ coin/ )/ ,/ 若/ (/ coini/ =/ 1/ )/ ,/ 则/ 输出/ “/ failure/ ”/ 并/ 终止/ ;/ 否则/ 返回/ xij/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ n/ )/ ;/ 代理/ 重加/ 密钥/ 产生/ 询问/ (/ pki/ ,/ pkj/ ,/ W/ )/ :/ 从/ 列表/ k/ _/ list/ 中/ 取出/ (/ pki0/ ,/ …/ ,/ pkin/ ,/ xi0/ ,/ …/ ,/ xin/ ,/ coin/ )/ 和/ (/ pkj0/ ,/ …/ ,/ pkjn/ ,/ xj0/ ,/ …/ ,/ xjn/ ,/ coinj/ )/ ./ 按/ 以下/ 情形/ 计算/ 代理/ 重加/ 密钥/ rk/ ,/ 其中/ W/ =/ (/ w1/ ,/ w2/ ,/ …/ ,/ wt/ )/ :/ (/ 1/ )/ 当/ (/ coini/ =/ 0/ )/ ,/ 它/ 表示/ ski/ =/ (/ xi0/ ,/ …/ ,/ xin/ )/ :/ 首先/ 从/ H1/ _/ list/ 得到/ hs/ (/ s/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ )/ ,/ 然后/ 选择/ 随机/ p/ (/ d/ =/ 0/ ,/ 1/ ,/ …/ ,/ n/ -/ t/ +/ 1/ )/ ,/ 返回/ 代理/ 重加/ 密钥/ kd/ ∈/ Z/ / rk/ (/ 包括/ 关键字/ 的/ 代理/ 密钥/ 片/ rkws/ (/ s/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ )/ 和/ 随机数/ 密钥/ 代理/ 密钥/ 片/ rkAB/ )/ ,/ 并/ 把/ (/ pki/ ,/ pkj/ ,/ W/ ,/ rk/ )/ 添加/ 到/ rk/ _/ list/ ./ rkws/ =/ grkAB/ =/ ∏/ n/ -/ t/ +/ 1/ (/ 2/ )/ 当/ (/ coini/ =/ 1/ ∧/ coinj/ =/ 1/ )/ ,/ 它/ 表示/ ski/ =/ (/ cxi0/ ,/ …/ ,/ cxin/ )/ 和/ skj/ =/ (/ cxj0/ ,/ …/ ,/ cxjn/ )/ :/ 首先/ 从/ H1/ _/ list/ 得到/ hs/ (/ s/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ )/ ,/ 然后/ 选择/ 随机数/ p/ (/ t/ =/ 0/ ,/ 1/ ,/ …/ ,/ n/ -/ t/ +/ 1/ )/ ,/ 返回/ rk/ 并/ 将/ (/ pki/ ,/ kd/ ∈/ Z/ / pkj/ ,/ W/ ,/ rk/ )/ 添加/ 到/ rk/ _/ list/ ./ (/ 3/ )/ 当/ (/ coini/ =/ 1/ ∧/ coinj/ =/ 0/ )/ ,/ 它/ 表示/ ski/ =/ (/ cxi0/ ,/ …/ ,/ cxin/ )/ 和/ skj/ =/ (/ xj0/ …/ ,/ xjn/ )/ :/ 输出/ “/ failure/ ”/ 并/ 终止/ ./ 解密/ 询问/ (/ pki/ ,/ CTi/ )/ :/ 从/ k/ _/ list/ 获得/ (/ pki0/ ,/ …/ ,/ pkin/ ,/ xi0/ ,/ …/ ,/ xin/ ,/ coini/ )/ ./ 若/ coini/ =/ 0/ ,/ 返回/ Decrypt/ (/ ski/ ,/ CTi/ )/ ,/ 否则/ ,/ 按/ 如下/ 两种/ 情形/ 处理/ :/ (/ 1/ )/ CTi/ =/ (/ A/ ,/ B1/ ,/ B2/ ,/ …/ ,/ Bs/ ,/ C/ ,/ D/ )/ 是/ 原始/ 密文/ :/ 查找/ H1/ _/ list/ 和/ H2/ _/ list/ ,/ 是否/ 存在/ (/ wi/ ,/ h1i/ )/ ∈/ H1/ _/ list/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ s/ )/ 和/ (/ H/ ,/ C/ ,/ h2/ )/ ∈/ H2/ _/ list/ 满足/ D/ =/ h2/ 和/ A/ =/ B/ (/ xi0/ +/ xi1hi/ +/ …/ +/ xinhn/ 存在/ 返回/ m/ =/ C/ (/ 2/ )/ CTi/ =/ (/ A/ ,/ C/ ,/ D/ )/ 是/ 转换/ 后/ 的/ 密文/ :/ 是否/ 存在/ (/ H/ ,/ C/ ,/ h2/ )/ ∈/ H2/ _/ list/ 满足/ D/ =/ h2/ ./ 存在/ 返回/ m/ =/ Page7CH/ ,/ 否则/ ,/ 拒绝/ 并/ 终止/ ./ 重/ 加密/ 询问/ (/ pki/ ,/ pkj/ ,/ CTi/ )/ :/ 首先/ 从/ k/ _/ list/ 获得/ coini/ 和/ coinj/ ./ 如果/ (/ coini/ =/ 1/ ∧/ coinj/ =/ 0/ )/ ,/ 输出/ “/ failure/ ”/ 并/ 终止/ ,/ 否则/ ,/ 按/ 如下/ 步骤/ 处理/ :/ (/ 1/ )/ 获得/ rk/ 从/ rk/ _/ list/ 或/ 执行/ 代理/ 重加/ 密钥/ 产生/ 询问/ (/ pki/ ,/ pkj/ ,/ W/ )/ ./ (/ 2/ )/ 返回/ CTj/ =/ ReEncrypt/ (/ CTi/ ,/ rk/ )/ ./ 挑战/ 阶段/ :/ 当/ / 结束/ 阶段/ 1/ ,/ 输出/ 目标/ 公钥/ pk/ / 和/ 两个/ 等长/ 的/ 明文/ m0/ ,/ m1/ ./ / 首先/ 从/ k/ _/ list/ 获得/ (/ pk/ / 0/ ,/ …/ ,/ pk/ / n/ ,/ x/ / 0/ ,/ …/ ,/ x/ / n/ ,/ coin/ / )/ ,/ 若/ coin/ / =/ 0/ ,/ 输出/ “/ failure/ ”/ 并/ 终止/ ,/ 否则/ 返回/ 密文/ CT/ / ./ 这里/ 要求/ 明文/ 有/ 相同/ 关键字/ 个数/ ,/ 并设/ Wd/ =/ (/ wd1/ ,/ wd2/ ,/ …/ ,/ wds/ )/ ,/ d/ ∈/ {/ 0/ ,/ 1/ }/ ./ CT/ / =/ (/ A/ / =/ gbx/ / 0/ =/ pkb/ // cB/ / i/ =/ gb/ (/ x/ / 0/ +/ x/ / 1hdi/ +/ …/ +/ x/ / nhn/ 其中/ hdi/ 可以/ 从/ H1/ _/ list/ 获得/ ./ C/ / =/ Qmd/ ,/ D/ / =/ H2/ (/ Q/ ,/ C/ / )/ ,/ 显然/ ,/ CT/ / 是/ 具有/ 关键字/ Wd/ =/ (/ wd1/ ,/ wd2/ ,/ …/ ,/ wds/ )/ 的/ 消息/ md/ 在/ 公钥/ pk/ / =/ (/ ga/ -/ 1cx/ / 0/ ,/ ga/ -/ 1cx/ / 1/ ,/ …/ ,/ ga/ -/ 1cx/ / n/ )/ 下/ 的/ 密文/ ,/ 且/ 加密/ 中/ 的/ 随机数/ r/ / =/ abQ/ =/ e/ (/ g/ ,/ g/ )/ r/ / =/ e/ (/ g/ ,/ g/ )/ ab/ // c/ ,/ 则/ CT/ / 是/ md/ 合法/ 密文/ ;/ 否则/ ,/ 就是/ 其它/ 消息/ 的/ 密文/ ./ 这样/ ,/ 挑战者/ 可以/ 攻击者/ 的/ 回答/ 来/ 判断/ Q/ 是否/ 等于/ e/ (/ g/ ,/ g/ )/ ab/ // c/ ./ 阶段/ 2/ ./ 攻击者/ / 可以/ 在/ IND/ -/ CPRE/ -/ CCA/ 游戏/ [/ 2/ ]/ 的/ 限制/ 下/ 继续/ 发起/ 询问/ ,/ 挑战者/ / 像/ 在/ 阶段/ 1/ 一样/ 回答/ 攻击者/ 的/ 询问/ ./ 猜测/ :/ 最后/ / 输出/ 一个/ 猜测/ 值/ d/ ∈/ {/ 0/ ,/ 1/ }/ ./ 若/ d/ =/ d/ ,/ / 输出/ 1/ ,/ 否则/ 输出/ 0/ ./ 进一步/ ,/ 我们/ 假设/ qH1/ ,/ qH2/ ,/ qsk/ ,/ qrk/ 和/ qre/ 分别/ 表示/ H1/ 、/ H2/ 、/ 私钥/ 产生/ 、/ 代理/ 重加/ 密钥/ 产生/ 以及/ 代理/ 重/ 加密/ 的/ 询问/ 的/ 次数/ ,/ e/ 表示/ 自然对数/ 的/ 底数/ ./ 用/ E1/ 表示/ 事件/ pk/ / =/ (/ ga/ -/ 1cx/ / 0/ ,/ ga/ -/ 1cx/ / 1/ ,/ …/ ,/ ga/ -/ 1cx/ / n/ )/ 没有/ 被/ 私钥/ 询问/ (/ coin/ / =/ 0/ )/ ,/ E2/ 表示/ 询问/ H2/ 时/ 没有/ 返回/ D/ / ./ 显然/ ,/ 两个/ 事件/ 是/ 独立/ 的/ ./ 在/ pk/ / 的/ 私钥/ 被/ 询问/ 的/ 情况/ 下/ ,/ / 可以/ 通过/ 私钥/ 解密/ ;/ 若/ 询问/ H2/ 时/ 返回/ D/ / ,/ / 可以/ 查询/ H2/ 来/ 解密/ ,/ 即/ E1/ ,/ E2/ 不/ 成立/ 时/ ,/ / 可以/ 准确/ 输出/ d/ ,/ 且/ Pr/ [/ E1/ ]/ =/ qsk/ “/ failure/ ”/ 的/ 情况/ 下/ :/ Pr/ [/ 输出/ 1/ ]/ =/ Pr/ [/ d/ =/ d/ ]/ =/ Pr/ [/ d/ =/ d/ |/ [/ ~/ (/ E1/ ∩/ E2/ )/ ]/ Pr/ [/ ~/ (/ E1/ ∩/ E2/ )/ ]/ +/ Pr/ [/ d/ =/ d/ |/ (/ E1/ ∩/ E2/ )/ ]/ Pr/ [/ E1/ ∩/ E2/ ]/ 2/ +/ (/ )/ ε/ 1/ -/ qsk/ +/ qH2/ (/ =/ 1/ 的/ 优势/ 为/ Pr/ [/ 输出/ 1/ ]/ -/ 1/ 我们/ 可以/ 得出/ 在/ 没有/ 输出/ “/ failure/ ”/ 的/ 情况/ 下/ ,/ / 并/ 终止/ :/ 另外/ ,/ / 在/ 下面/ 几种/ 情形/ 下/ 可能/ 会/ 输出/ “/ failure/ ”/ (/ 1/ )/ 私钥/ 产生/ 询问/ 当/ coin/ =/ 1/ ./ (/ 2/ )/ 代理/ 重加/ 密钥/ 产生/ 询问/ (/ pki/ ,/ pkj/ ,/ w/ )/ 当/ (/ 3/ )/ 在/ 挑战/ 阶段/ 当/ coin/ / =/ 0/ ./ 让/ qmax/ =/ max/ (/ qsk/ ,/ qrk/ ,/ qre/ )/ ,/ 很/ 容易/ 看出/ / 在/ 整个/ (/ coini/ =/ 1/ ∧/ coinj/ =/ 0/ )/ ./ 游戏/ 过程/ 中/ 没有/ 输出/ 的/ 概率/ 至少/ 有/ 根据/ 文献/ [/ 10/ ]/ 的/ 结果/ ,/ δ/ qmax/ (/ 1/ -/ δ/ )/ 在/ δ/ =/ qmax1/ +/ qmax/ 达到/ 最大值/ ./ 当/ qmax/ 充分/ 大时/ (/ 1/ -/ (/ 1/ -/ δ/ )/ δ/ )/ 2qmax/ 的/ 值/ e2/ ./ 因此/ 没有/ 输出/ “/ failure/ ”/ 至少/ 有/ 1/ 接近/ 1/ 综上/ ,/ 可以/ 知道/ / 的/ 优势/ 至少/ 为/ 6/ 总结/ 本文/ 简要地/ 分析/ 了/ Weng/ 等/ 人/ [/ 2/ ]/ 基于/ 身份/ 加密技术/ 构造/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ,/ 因该/ 方案/ 不能/ 很/ 好/ 支持/ 多个/ 条件/ 的/ “/ 与/ ”/ 和/ “/ 或/ ”/ 运算/ ,/ 需要/ 新/ 的/ 技术/ 来/ 设计/ 多个/ 条件/ 的/ 代理/ 重/ 加密/ 方案/ ./ 本文/ 利用/ 秘密/ 共享/ 机制/ ,/ 构造/ 了/ 一个/ 新/ 的/ 条件/ 代理/ 重/ 加密/ 方案/ ./ 方案/ 在/ 随机/ 预言/ 模型/ 下/ 证明/ 了/ 其/ 安全性/ ,/ 并/ 能够/ 很/ 好/ 支持/ 多个/ 条件/ 的/ 情况/ ./ 

