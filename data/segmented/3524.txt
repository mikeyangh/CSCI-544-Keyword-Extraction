Page1/ 云/ 环境/ 中/ 支持/ 隐私/ 保护/ 的/ 可/ 计算/ 加密/ 方法/ 黄汝维/ 1/ )/ ,/ 2/ )/ 桂/ 小林/ 1/ )/ 余思/ 1/ )/ 庄威/ 1/ )/ 1/ )/ (/ 西安交通大学/ 电子/ 与/ 信息/ 工程学院/ 西安/ 710049/ )/ 2/ )/ (/ 广西大学/ 计算机/ 与/ 电子信息/ 学院/ 南宁/ 530004/ )/ 摘要/ 随着/ 云/ 计算/ 的/ 深入/ 发展/ ,/ 隐私/ 安全/ 成为/ 了/ 云/ 安全/ 的/ 一个/ 关键问题/ ./ 加密/ 是/ 一种/ 常用/ 的/ 保护/ 敏感数据/ 的/ 方法/ ,/ 但是/ 它/ 不/ 支持/ 有效/ 的/ 数据/ 操作/ ./ 为了/ 提供/ 云/ 计算环境/ 中/ 的/ 隐私/ 保护/ ,/ 设计/ 了/ 一个/ 基于/ 矩阵/ 和/ 向量/ 运算/ 的/ 可/ 计算/ 加密/ 方案/ CESVMC/ ./ 通过/ 运用/ 向量/ 和/ 矩阵/ 的/ 各种/ 运算/ ,/ CESVMC/ 实现/ 了/ 对/ 数据/ 的/ 加密/ ,/ 并/ 支持/ 对/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 对/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除/ 四种/ 算术/ 运算/ ./ 安全/ 分析/ 和/ 性能/ 评估/ 证明/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ,/ 并/ 能/ 有效/ 地/ 实现/ 对/ 加密/ 数据/ 的/ 计算/ ./ 关键词/ 云/ 计算/ ;/ 向量/ 和/ 矩阵/ ;/ 字符串/ 模糊/ 检索/ ;/ 算术/ 运算/ ;/ 可/ 计算/ 加密/ 1/ 引言/ 云/ 计算/ 作为/ 一种/ 新型/ 的/ 网络/ 计算/ 模式/ ,/ 以/ 一种/ 相比/ 传统/ IT/ 更/ 经济/ 的/ 方式/ 向/ 用户/ 提供/ 按/ 需/ 的/ IT/ 服务/ (/ 计算/ 、/ 存储/ 和/ 应用/ 等/ )/ ./ 由于/ 云/ 计算/ 的/ 发展/ 理念/ 但/ 在/ 已经/ 实现/ 的/ 云/ 计算/ 服务/ 中/ ,/ 隐私/ 安全/ 问题/ 一直/ 令人担忧/ ,/ 并/ 已经/ 成为/ 阻碍/ 云/ 计算/ 发展/ 和/ 推广/ 的/ 主要/ 因素/ 之一/ ./ 用户/ 的/ 隐私/ 数据/ 包括/ 可用/ 来/ 识别/ Page2/ 或/ 定位/ 个人/ 的/ 信息/ (/ 例如/ 电话号码/ 、/ 地址/ 和/ 信用卡/ 号/ 等/ )/ 、/ 敏感/ 的/ 信息/ (/ 例如/ 个人/ 的/ 健康状况/ 、/ 财务/ 信息/ 、/ 公司/ 的/ 重要文件/ 等/ )/ ./ 云/ 计算/ 的/ 隐私/ 安全/ 问题/ 源于/ 云/ 计算/ 的/ 数据/ 外包/ 和/ 服务/ 租赁/ 的/ 特点/ ./ 用户/ 数据/ 存储/ 到/ 云/ 环境/ 中/ ,/ 人们/ 失去/ 了/ 对/ 数据/ 的/ 直接/ 控制力/ ,/ 可能/ 会/ 导致/ 个人隐私/ 数据/ 的/ 泄露/ 和/ 滥用/ ./ 而/ 近年来/ 发生/ 的/ Google/ 、/ MediaMax/ 和/ Salesforce/ ./ com/ 等/ 云/ 服务商/ 泄露/ 或/ 丢失/ 用户/ 数据/ 的/ 事实/ 证实/ 了/ 人们/ 的/ 担心/ [/ 1/ ]/ ./ 加密/ 是/ 一种/ 常用/ 的/ 保护/ 用户/ 隐私/ 数据/ 的/ 方法/ ,/ 但/ 目前/ 的/ 大多数/ 加密/ 方案/ 都/ 不/ 支持/ 对/ 密文/ 的/ 运算/ ,/ 如对/ 加密/ 的/ 文件/ 进行/ 模糊/ 检索/ 、/ 对/ 加密/ 的/ 公司财务/ 信息/ 进行/ 统计分析/ 等/ ,/ 因而/ 严重/ 妨碍/ 了/ 云/ 服务商/ 为/ 用户/ 提供/ 更进一步/ 的/ 数据管理/ 和/ 运算/ 服务/ ,/ 从而/ 削弱/ 了/ 云/ 计算/ 的/ 优势/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 提出/ 了/ 一个/ 基于/ 矩阵/ 和/ 向量/ 运算/ 的/ 可/ 计算/ 加密/ 方案/ CESVMC/ (/ ComputableEncryptionSchemebasedonVectorandMatrixCalculations/ )/ ./ CESVMC/ 将/ 云/ 数据/ 分为/ 字符串/ 和/ 数值数据/ 两大类/ ,/ 支持/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除/ 四种/ 基本/ 算术/ 运算/ ,/ 并/ 保证/ 了/ 数据/ 存储/ 、/ 运算/ 过程/ 中/ 的/ 隐私/ 安全性/ ./ 本文/ 第/ 2/ 节/ 回顾/ 相关/ 研究/ 的/ 进展/ 情况/ ;/ 第/ 3/ 节/ 建立/ 支持/ 隐私/ 保护/ 的/ 云/ 计算/ 模型/ 并/ 定义/ 可/ 计算/ 加密技术/ ;/ 第/ 4/ 节/ 具体/ 介绍/ CESVMC/ 的/ 设计/ 与/ 实现/ ;/ 第/ 5/ 节/ 和/ 第/ 6/ 节/ 分别/ 就/ CESVMC/ 的/ 安全性/ 和/ 性能/ 进行/ 评估/ ;/ 第/ 7/ 节/ 做出/ 总结/ ./ 2/ 相关/ 工作/ 可/ 计算/ 加密技术/ 是/ 一种/ 加密/ 方法/ ,/ 它/ 通过/ 加密/ 保证/ 数据安全/ ,/ 同时/ 加密/ 后/ 的/ 数据/ 能够/ 支持/ 某些/ 计算/ ./ 目前/ 已有/ 的/ 可/ 计算/ 加密技术/ 可/ 分为/ 两类/ :/ 支持/ 检索/ 的/ 加密技术/ 和/ 支持/ 运算/ 的/ 加密技术/ ./ (/ 1/ )/ 支持/ 检索/ 的/ 加密技术/ ./ Liu/ 等/ 人/ [/ 2/ ]/ 提出/ 了/ 一种/ 基于/ 对称/ 加密/ 的/ 密文/ 检索/ 方法/ ;/ Bonech/ 等/ 人/ [/ 3/ -/ 5/ ]/ 提出/ 了/ 基于/ 非对称/ 加密/ 的/ 密文/ 检索/ 方法/ ;/ Bellovin/ 等/ 人/ [/ 1/ ,/ 6/ -/ 7/ ]/ 提出/ 了/ 基于/ BloomFilter/ 的/ 密文/ 检索/ 方法/ ./ 但/ 这些/ 方法/ 只/ 支持/ 精确/ 的/ 字符串/ 匹配/ ,/ 即/ 两/ 字符串/ 是否/ 相等/ ./ 然而/ ,/ 在/ 许多/ 实际/ 的/ 情况/ 下/ ,/ 错别字/ 和/ 格式/ 不/ 一致/ 是/ 不可避免/ 的/ ,/ 因此/ ,/ Li/ 等/ 人/ [/ 8/ ]/ 设计/ 了/ 一个/ 支持/ 加密/ 字符串/ 模糊/ 检索/ 的/ 方案/ ,/ 它/ 使用/ 编辑/ 距离/ 来/ 量化/ 字符串/ 的/ 相似/ 度/ ,/ 并/ 为/ 每个/ 字符串/ 附加/ 一个/ 基于/ 通配符/ 的/ 模糊/ 字符串/ 组/ ,/ 用/ 多个/ 精确/ 匹配/ 来/ 实现/ 模糊/ 检索/ ./ 该/ 方法/ 的/ 不足/ 是/ 它/ 不能/ 对/ 满足/ 检索/ 条件/ 的/ 字符串/ 进行/ 相似/ 度/ 排序/ ,/ 而且/ 计算/ 、/ 存储/ // 通信/ 负载/ 很大/ ./ 对于/ 一个/ 长度/ 为/ l/ 的/ 字符串/ ,/ 为了/ 能/ 处理/ d/ 位/ 的/ 错别字/ 和/ 格式/ 不/ 一致/ ,/ 需要/ 进行/ O/ (/ ld/ )/ 次/ Hash/ 运算/ 并/ 产生/ O/ (/ ld/ ×/ 160/ )/ 位/ 的/ 存储/ // 通信/ 负载/ ./ Wang/ 等/ 人/ [/ 9/ ]/ 提出/ 一个/ 基于/ 保序/ 加密技术/ OPSE/ [/ 10/ ]/ 的/ 分级/ 字符串/ 检索/ 方案/ ,/ 能够/ 根据/ 某一/ 指标/ 对/ 检索/ 的/ 关键字/ 分级/ ,/ 并/ 按/ 用户/ 的/ 要求/ 返回/ 前/ N/ 个/ 符合要求/ 的/ 结果/ ./ 该/ 方案/ 要求/ 数据/ 拥有者/ 在外/ 包/ 文件/ 前/ 对/ 每个/ 文件/ 进行/ 全文/ 扫描/ ,/ 计算/ 出/ 每个/ 关键字/ 在/ 该/ 文件/ 中/ 的/ 出现/ 频率/ ,/ 这/ 对于/ 数据/ 拥有者/ 来说/ 是/ 一件/ 非常/ 麻烦/ 的/ 事情/ ./ Hacg/ ü/ m/ ü/ 等/ 人/ [/ 11/ ]/ 提出/ 了/ 基于/ 同态/ 加密技术/ 的/ 密文/ 聚集/ 查询/ 方案/ ,/ 但是/ 要求/ 数据/ 拥有者/ 自己/ 建立/ 一个/ 加密/ 的/ 索引/ 表/ ./ (/ 2/ )/ 支持/ 运算/ 的/ 加密/ 方法/ ./ Agrawal/ 等/ 人/ [/ 12/ ]/ 提出/ 一个/ 基于/ 桶/ 划分/ 和/ 分布/ 概率/ 映射/ 思想/ 的/ 保序/ 对称/ 加密算法/ OPES/ ,/ 支持/ 对/ 加密/ 数值数据/ 的/ 各种/ 比较/ 操作/ ./ Boldyreva/ 等/ 人/ [/ 10/ ]/ 提出/ 一个/ 基于/ 折半/ 查找/ 和/ 超/ 几何/ 概率分布/ 的/ 保序/ 对称/ 加密算法/ OPSE/ ,/ 支持/ 对/ 加密/ 数据/ 的/ 各种/ 比较/ 操作/ ,/ 但是/ 由于/ 在/ 计算/ 超/ 几何/ 概率/ 时/ 需要/ 进行/ 多次/ 组合/ 运算/ ,/ 其/ 计算/ 负载/ 较大/ ./ 以上/ 两种/ 保序/ 加密算法/ 都/ 是/ 确定性/ 的/ 加密/ 方案/ ,/ 这/ 使得/ 它们/ 不/ 具有/ 语义/ 安全性/ ./ Wong/ 等/ 人/ [/ 13/ ]/ 设计/ 了/ 一个/ 基于/ 向量/ 标量/ 积/ 的/ 对称/ 加密/ 方案/ ,/ 该/ 方案/ 支持/ 对/ 加密/ 数据库/ 进行/ KNN/ (/ k/ -/ nearestneighbor/ )/ 计算/ ./ 除此之外/ ,/ 目前/ 已有/ 一些/ 同态/ 加密算法/ ,/ 例如/ unpadded/ _/ RSA/ 、/ ElGamal/ 、/ Goldwasser/ -/ Micali/ 、/ Benaloh/ 和/ Paillier/ 等/ ,/ 但/ 它们/ 只/ 支持/ 加法/ 同态/ 和/ 乘法/ 同态/ 运算/ 中/ 的/ 一种/ ./ Gentry/ [/ 14/ -/ 15/ ]/ 首次/ 设计/ 出/ 了/ 一种/ 基于/ 理想/ 格/ 的/ 全/ 同态/ 加密/ 方案/ ,/ 该/ 方案/ 能/ 同时/ 支持/ 加法/ 和/ 乘法/ 同态/ ./ 之后/ ,/ Smart/ 等/ 人/ [/ 16/ -/ 17/ ]/ 对/ Gentry/ 的/ 工作/ 进行/ 了/ 改进/ ./ 但是/ 目前/ 已有/ 的/ 全/ 同态/ 方案/ 都/ 太/ 复杂/ 且/ 计算/ 量/ 太大/ ,/ 还/ 不/ 适合/ 应用/ 到/ 云/ 计算/ 的/ 环境/ 中/ ./ 根据/ 以上/ 分析/ ,/ 我们/ 发现/ :/ (/ 1/ )/ 目前/ 还/ 没有/ 一种/ 加密/ 方案/ 能够/ 同时/ 支持/ 字符串/ 的/ 检索/ 和/ 数值数据/ (/ 包括/ 整数/ 和/ 浮点数/ )/ 的/ 算术/ 运算/ ;/ (/ 2/ )/ 目前/ 对/ 加密/ 字符串/ 的/ 模糊/ 检索/ 还/ 没有/ 一个/ 实际/ 可行/ 的/ 方案/ ;/ (/ 3/ )/ 目前/ 还/ 没有/ 一种/ 支持/ 密文/ 运算/ 的/ 方案/ 能/ 轻松/ 地/ 同时/ 解决/ 整数/ 和/ 浮点数/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除法/ 运算/ ;/ (/ 4/ )/ 已有/ 的/ 一些/ 方案/ 往往/ 要求/ 数据/ 拥有者/ 在/ 数据/ 外/ 包前/ 做/ 大量/ 的/ 准备/ 工作/ ,/ 这会/ 使/ 用户/ 的/ 使用/ 体验/ 大打折扣/ ./ 针对/ 以上/ 问题/ ,/ 我们/ 设计/ 了/ 一个/ 支持/ 隐私/ 保护/ 的/ 可/ 计算/ 加密/ 方案/ CESVMC/ (/ ComputableEncryptionSchemebasedonVectorandMatrixCalculations/ )/ ./ CESVMC/ 基于/ 向量/ 和/ 矩阵/ 运算/ ,/ 支持/ 对/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 对/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除法/ 运算/ ./ Page33/ 问题/ 描述/ 3.1/ 支持/ 隐私/ 保护/ 的/ 云/ 计算/ 模型/ 如图/ 1/ 所示/ ,/ 支持/ 隐私/ 保护/ 的/ 云/ 计算/ 模型/ 反映/ 了/ 数据/ 拥有者/ (/ Owner/ )/ 、/ 用户/ (/ User/ )/ 和/ 服务提供者/ (/ ServiceProvider/ ,/ SP/ )/ 之间/ 的/ 交互/ ,/ 具体/ 过程/ 如下/ :/ (/ 1/ )/ Owner/ 用/ 加密算法/ E/ 对/ 敏感数据/ di/ (/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ n/ / 1/ )/ 加密/ 得到/ E/ (/ di/ )/ ,/ 然后/ 存储/ 到/ SP/ 的/ 服务器/ 上/ ;/ 图/ 1/ 支持/ 隐私/ 保护/ 的/ 云/ 计算/ 模型/ 在/ 这个/ 过程/ 中/ ,/ 由于/ Owner/ 和/ User/ 分别/ 对/ 敏感/ 的/ 外包/ 数据/ 和/ 计算/ 参数/ 进行/ 了/ 加密/ 处理/ ,/ 使得/ Owner/ 和/ User/ 的/ 隐私/ 得到/ 了/ 很/ 好/ 的/ 保护/ ./ 但/ 同时/ 也/ 带来/ 了/ 一个/ 新/ 的/ 问题/ :/ SP/ 如何/ 对/ 加密/ 的/ 数据/ 进行/ 计算/ 呢/ ?/ 如果/ 这个/ 问题/ 不能/ 得到/ 有效/ 的/ 解决/ ,/ Owner/ 和/ User/ 就/ 不能/ 利用/ 云/ 计算/ 中/ 的/ 计算资源/ 对/ 敏感数据/ 进行/ 处理/ ,/ 从而/ 削弱/ 了/ 云/ 计算/ 的/ 优势/ ./ 因此/ ,/ 本文/ 提出/ 的/ 可/ 计算/ 加密/ 方案/ 是/ 解决/ 这一/ 矛盾/ 的/ 关键技术/ ./ 3.2/ 可/ 计算/ 加密/ 方案/ 的/ 定义/ Σ/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ ,/ Cal/ )/ 由/ 以下/ 4/ 个/ 算法/ 组成/ :/ K/ ←/ Gen/ (/ U/ ,/ d/ )/ ,/ d/ 为/ 安全/ 参数/ ;/ (/ 2/ )/ 加密算法/ Enc/ 可能/ 为/ 概率/ 算法/ ,/ D/ 和/ V/ 分别/ 为/ 该/ 算法/ 的/ 定义域/ 和/ 值域/ ,/ 对于/ 数据/ m/ ∈/ D/ ,/ c/ ←/ Enc/ (/ K/ ,/ m/ )/ 且/ c/ ∈/ V/ ;/ (/ 3/ )/ 解密/ 算法/ Dec/ 为/ 确定/ 算法/ ,/ 对于/ 密文/ c/ ,/ m/ ∪/ {/ ⊥/ }/ ←/ Dec/ (/ c/ ,/ K/ )/ ,/ ⊥/ 表示/ 无/ 解/ ;/ (/ 4/ )/ 密文/ 计算/ 算法/ Cal/ 可能/ 为/ 概率/ 算法/ ,/ 对于/ 密文/ 集合/ {/ c1/ ,/ c2/ ,/ …/ ,/ ct/ }/ ,/ 其中/ ci/ ∈/ V/ ,/ Cal/ (/ Dec/ (/ c1/ ,/ 定义/ 1/ (/ 可/ 计算/ 加密/ 方案/ )/ ./ 可/ 计算/ 加密/ 方案/ (/ 1/ )/ 密钥/ 生成/ 算法/ Gen/ 为/ 用户/ U/ 产生/ 密钥/ K/ ,/ (/ 2/ )/ User/ 获得/ Owner/ 的/ 授权/ 后/ ,/ 对/ 敏感/ 计算/ 参数/ (/ para/ )/ 加密/ 得到/ E/ (/ para/ )/ ,/ 并/ 将/ E/ (/ para/ )/ 和/ 计算/ 要求/ (/ type/ )/ 提交/ 给/ SP/ ;/ (/ 3/ )/ SP/ 验证/ User/ 的/ 权限/ ,/ 然后/ 根据/ User/ 的/ 计算/ 要求/ ,/ 对/ 其/ 权限/ 范围/ 的/ E/ (/ di/ )/ 和/ 计算/ 参数/ E/ (/ para/ )/ 进行/ 计算/ ,/ 得到/ 计算结果/ E/ (/ result/ )/ ,/ 并/ 将/ E/ (/ result/ )/ 返回/ 给/ User/ ./ (/ 4/ )/ User/ 对/ E/ (/ result/ )/ 进行/ 解密/ ,/ 得到/ 结果/ 的/ 明文/ result/ ./ K/ )/ ,/ Dec/ (/ c2/ ,/ K/ )/ ,/ …/ ,/ Dec/ (/ ct/ ,/ K/ )/ ,/ op/ )/ ←/ Dec/ (/ Cal/ (/ c1/ ,/ c2/ ,/ …/ ,/ ct/ ,/ op/ )/ )/ ,/ op/ 为/ 计算/ 类型/ (/ 例如/ 模糊/ 匹配/ 、/ 算术/ 运算/ 等/ )/ ,/ Cal/ 是/ 与/ Cal/ 对应/ 的/ 对/ 明文/ 数据/ 运算/ 的/ 算法/ ./ 定义/ 2/ (/ 正确性/ )/ ./ 可/ 计算/ 加密/ 方案/ Σ/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ ,/ Cal/ )/ 是/ 正确/ 的/ :/ (/ 1/ )/ / m/ ∈/ D/ ,/ / Dec/ (/ Enc/ (/ m/ ,/ K/ )/ )/ =/ m/ ;/ (/ 2/ )/ / {/ m1/ ,/ m2/ ,/ …/ ,/ mt/ }/ ,/ 其中/ mi/ ∈/ D/ ,/ / Cal/ (/ m1/ ,/ m2/ ,/ …/ ,/ mt/ ,/ op/ )/ =/ Dec/ (/ Cal/ (/ Enc/ (/ m1/ ,/ K/ )/ ,/ Enc/ (/ m2/ ,/ K/ )/ ,/ …/ ,/ Enc/ (/ mt/ ,/ K/ )/ ,/ op/ )/ )/ ./ 定义/ 3/ (/ 安全性/ )/ ./ 可/ 计算/ 的/ 加密/ 方案/ Σ/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ ,/ Cal/ )/ 是/ 安全/ 的/ :/ (/ 1/ )/ Σ/ 在/ 提供/ 外/ 包/ 数据/ 的/ 加密/ Oracle/ 和/ 解密/ Oracle/ 的/ 情况/ 下/ 是/ IND/ -/ CCA/ 安全/ 的/ ;/ (/ 2/ )/ Σ/ 保证/ SP/ 在/ 进行/ Cal/ 运算/ 的/ 过程/ 中/ 不能/ 推断出/ 原始/ 明文/ 、/ 中间/ 或/ 最终/ 结果/ 的/ 任何/ 信息/ ./ 4/ 可/ 计算/ 的/ 加密/ 方案/ CESVMC4/ ./ 1CESVMC/ 定义/ 本节/ 将/ 构造/ 一个/ 基于/ 向量/ 和/ 矩阵/ 运算/ 的/ 可/ 计算/ Page4/ 加密/ 方案/ CESVMC/ ./ CESVMC/ 在/ 确保/ Owner/ 和/ User/ 数据安全/ 的/ 前提/ 下/ ,/ 支持/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除法/ 运算/ ./ 下面/ 对/ CESVMC/ 进行/ 定义/ ./ 定义/ 4/ (/ CESVMC/ )/ ./ CESVMC/ =/ (/ Gen/ ,/ Enc/ ,/ Dec/ ,/ Cal/ )/ 由/ 以下/ 4/ 个/ 算法/ 组成/ :/ (/ 1/ )/ 密钥/ 生成/ 算法/ Gen/ :/ {/ M/ ,/ W/ ,/ S/ }/ ←/ Gen/ (/ n/ ,/ k/ )/ ,/ 其中/ n/ 、/ k/ 分别/ 表示/ 计算/ 元素/ 个数/ 和/ 随机/ 元素/ 个数/ ,/ 且/ n/ ,/ k/ ∈/ N/ ;/ 一个/ 向量/ 犘/ 由/ 计算/ 元素/ 和/ 随机/ 元素/ 组成/ ,/ 假设/ d/ 表示/ 犘/ 的/ 维/ 数/ ,/ 则/ 有/ d/ =/ n/ +/ k/ ;/ Gen/ 生成/ 的/ 密钥/ 由/ 3/ 部分/ 组成/ ,/ 一个/ d/ ×/ d/ 可逆/ 矩阵/ 犕/ ,/ 一个/ 随机数/ 数组/ W/ =/ {/ w1/ ,/ w2/ ,/ …/ ,/ wk/ -/ 3/ ,/ wk/ -/ 2/ }/ (/ k/ / 4/ ,/ wi/ ∈/ R/ 且/ i/ ∈/ [/ 1/ ,/ k/ -/ 2/ ]/ )/ 和/ 一个/ 分裂/ 串/ S/ =/ {/ 0/ ,/ 1/ }/ d/ 组成/ ,/ 分裂/ 串/ 只/ 用于/ 字符串/ 中/ ./ (/ 2/ )/ 加密算法/ Enc/ :/ 假设/ D/ 和/ V/ 分别/ 为/ Enc/ 的/ 定义域/ 和/ 值域/ ,/ 对于/ 数据/ m/ ∈/ D/ ,/ 犘/ ←/ Enc/ (/ m/ ,/ 犕/ ,/ W/ ,/ S/ ,/ U/ // O/ )/ ,/ 其中/ 犘/ 为/ m/ 对应/ 的/ d/ 维/ 密文/ 向量/ 且/ 犘/ ∈/ V/ ,/ U/ // O/ 表示/ 是/ 数据/ 使用者/ 或/ 数据/ 拥有者/ ,/ 用户/ 身份/ 不/ 同时/ ,/ 加密算法/ 略有不同/ ./ (/ 3/ )/ 解密/ 算法/ Dec/ :/ m/ ←/ Dec/ (/ 犘/ ,/ 犕/ ,/ S/ ,/ op/ )/ ,/ 其中/ op/ 是/ 计算/ 类型/ ,/ 当/ op/ =/ “/ original/ ”/ 时/ ,/ 表示/ 对/ 原始数据/ 的/ 密文/ 进行/ 解密/ ;/ 当/ op/ =/ “/ add/ ”/ 时/ ,/ 表示/ 对/ 加法/ 运算/ 的/ 结果/ 进行/ 解密/ ;/ 当/ op/ =/ “/ sub/ ”/ 时/ ,/ 表示/ 对/ 减法/ 运算/ 的/ 结果/ 进行/ 解密/ ;/ 当/ op/ =/ “/ mul/ ”/ 时/ ,/ 表示/ 对/ 乘法/ 运算/ 的/ 结果/ 进行/ 解密/ ;/ 当/ op/ =/ “/ div/ ”/ 时/ ,/ 表示/ 对/ 除法/ 运算/ 的/ 结果/ 进行/ 解密/ ./ (/ 4/ )/ 密文/ 计算/ 算法/ Cal/ :/ P/ ←/ Cal/ (/ P1/ ,/ P2/ ,/ …/ ,/ Pt/ ,/ op/ )/ ,/ 根据/ 计算/ 类型/ op/ 的/ 不同/ ,/ 对/ P1/ ,/ P2/ ,/ …/ ,/ Pt/ (/ Pi/ ∈/ V/ 且/ i/ ∈/ [/ 1/ ,/ t/ ]/ ,/ t/ ∈/ N/ )/ 进行/ 不同/ 的/ 运算/ ,/ 主要/ 有/ 模糊/ 检索/ 、/ 加法/ 、/ 减法/ 、/ 乘法/ 和/ 除法/ 等/ 运算/ ,/ P/ 是/ 计算结果/ 的/ 密文/ 且/ P/ ∈/ V/ ./ 4.2/ 算法/ 描述/ CESVMC/ 将/ 云/ 数据/ 分为/ 字符串/ 和/ 数值数据/ 两类/ ,/ 支持/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除法/ 运算/ ./ 4.2/ ./ 1/ 字符串/ 为了/ 更好/ 地/ 设计/ 模糊/ 检索/ 机制/ ,/ 首先/ 观察/ 人们/ 的/ 查询/ 习惯/ ./ CESVMC/ 的/ 字符串/ 模糊/ 检索/ 目前/ 主要/ 是/ 针对/ 英文/ 数据/ ,/ 但/ 其/ 原理/ 也/ 可以/ 应用/ 到/ 中文/ 数据/ 的/ 模糊/ 检索/ 中/ ./ 根据/ 英文单词/ 的/ 构成/ 方式/ ,/ 人们/ 经常/ 认为/ “/ cloudy/ ”/ 与/ “/ clout/ ”/ 相比/ ,/ “/ cloudy/ ”/ 的/ 意思/ 与/ “/ cloud/ ”/ 更为/ 相近/ ,/ 因为/ “/ cloudy/ ”/ 以/ “/ cloud/ ”/ 为/ 前缀/ ,/ 称之为/ 前缀/ 匹配/ ;/ 另外/ ,/ 对于/ 大多数/ 人/ 来说/ ,/ 检索/ 一个/ 单词/ 在/ 一个/ 句子/ 或/ 词组/ 中/ 的/ 情况/ 比该/ 单词/ 是/ 构成/ 另/ 一个/ 单词/ 的/ 一部分/ 更有意义/ ,/ 例如/ 单词/ “/ alone/ ”/ 在/ “/ bealone/ ”/ 中/ 和/ 它/ 在/ 单词/ “/ abalone/ ”/ 中/ ,/ 检索/ 前者/ 比/ 后者/ 更有意义/ ,/ 称之为/ 关键字/ 匹配/ ./ 因此/ ,/ 对/ 一个/ 字符串/ 进行/ 加密/ 即/ 是/ 要/ 构造/ 它/ 的/ 前缀/ 匹配/ 密文/ 和/ 关键字/ 匹配/ 密文/ ./ 但/ 在/ 检索/ 的/ 时候/ ,/ 对/ 前缀/ 匹配/ 密文/ 和/ 关键字/ 匹配/ 密文/ 都/ 可以/ 采用/ 前缀/ 匹配/ 的/ 方法/ 进行/ ,/ 从而/ 实现/ 模糊/ 检索/ ./ 在/ 进行/ 模糊/ 检索/ 时/ 将/ 按照/ 以下/ 规则/ 返回/ 有序/ 的/ 检索/ 结果/ :/ (/ 1/ )/ 与/ 检索/ 参数/ 一样/ 的/ 字符串/ 构成/ 了/ 最/ 匹配/ 的/ 结果/ 集/ ;/ (/ 2/ )/ 以/ 检索/ 参数/ 开始/ 的/ 字符串/ 构成/ 了/ 第/ 2/ 匹配/ 的/ 结果/ 集/ ;/ (/ 3/ )/ 假设/ 检索/ 参数/ 的/ 字符/ 数为/ m/ ,/ 前/ m/ -/ 1/ 个字符/ 与/ 检索/ 参数/ 一致/ ,/ 但/ 第/ m/ 个字符/ 与/ 检索/ 参数/ 不/ 一样/ 的/ 字符串/ 构成/ 了/ 第/ 3/ 匹配/ 的/ 结果/ 集/ ,/ 以此类推/ ;/ (/ 4/ )/ 在/ 同一个/ 结果/ 集中/ ,/ 字符串/ 与/ 检索/ 参数/ 的/ 第一个/ 不同/ 字符/ ASCII/ 码值/ 的/ 差越/ 小/ ,/ 它们/ 就/ 越/ 相似/ ./ 4.2/ ./ 1.1/ 字符串/ 转换/ 为/ 向量/ 假设/ 有/ 一个/ 字符串/ np/ ,/ Owner/ 首先/ 生成/ np/ 的/ 子串/ ./ 其/ 基本/ 思想/ 是/ 按照/ 空格/ 将/ 字符串/ 分割/ ,/ 例如/ ,/ 字符串/ “/ cloudcomputing/ ”/ 对应/ 的/ 子串/ 分别/ 为/ “/ cloud/ ”/ 和/ “/ computing/ ”/ ./ 然后/ ,/ Owner/ 对/ np/ 及其/ 子串/ 执行/ 以下/ 操作/ :/ 假设/ 计算/ 元素/ 组/ ce/ 由/ n/ 个/ 元素/ 组成/ ,/ 算法/ 允许/ 的/ 字符串/ 最大/ 长度/ 为/ len/ =/ (/ n/ -/ 1/ )/ ×/ 6/ ,/ 即/ 每/ 6/ 个字符/ 构成/ 一个/ 元素/ ;/ np/ 的/ 长度/ 为/ len/ ,/ 则/ 可/ 形成/ 前/ len/ // 6/ 个/ 元素/ ,/ 后面/ 的/ (/ n/ -/ len/ // 6/ )/ 个/ 元素/ 都/ 为/ 0/ ./ 对于/ 第/ i/ 个/ 元素/ ,/ 将/ 其中/ 每个/ 字符/ 转换/ 为/ 对应/ 的/ ASCII/ 码/ 减去/ 23/ ,/ 从而/ 确保/ 了/ 每/ 一个/ 字符/ 都/ 用/ 一个/ 两位数/ 来/ 表示/ ;/ 接着/ 将/ 每个/ 字符/ 的/ 对应/ 两位数/ 连接起来/ ,/ 形成/ 数字/ vi/ ,/ 再/ 计算/ vi/ =/ vi/ ×/ 10m/ ,/ 其中/ m/ =/ 12/ ×/ (/ n/ -/ i/ -/ 1/ )/ ./ 通过/ 以上/ 运算/ ,/ Owner/ 将/ 字符串/ np/ 转换/ 为/ 一个/ (/ n/ -/ 1/ )/ 维/ 的/ 向量/ 狆/ =/ (/ v1/ ,/ v2/ ,/ …/ ,/ vn/ -/ 1/ )/ ./ 当/ len/ >/ len/ 时/ ,/ np/ 可以/ 转换/ 为/ len/ // len/ 个/ (/ n/ -/ 1/ )/ 维/ 向量/ ./ 由于/ 每个/ (/ n/ -/ 1/ )/ 维/ 向量/ 的/ 后续/ 操作/ 都/ 是/ 一样/ 的/ ,/ 因此/ ,/ 本文/ 就/ 假设/ np/ 只/ 转换成/ 了/ 一个/ (/ n/ -/ 1/ )/ 维/ 向量/ ./ 当/ User/ 准备/ 发出/ 检索/ 请求/ 时/ ,/ 也/ 是/ 用/ 同样/ 的/ 方法/ 来/ 转换/ 检索/ 参数/ ./ 4.2/ ./ 1.2/ 外包/ 字符串/ 的/ 加/ 、/ 解密/ 假设/ 外/ 包/ 字符串/ npi/ 对应/ 的/ (/ n/ -/ 1/ )/ 维/ 向量/ 为/ 狆/ i/ ./ Owner/ 创建/ 一个/ d/ 维/ 向量/ 狆/ i/ =/ (/ pi/ ,/ -/ 0.5/ ×/ ‖/ pi/ ‖/ 2/ ,/ r1/ ,/ w2/ ,/ …/ ,/ rk/ -/ 3/ ,/ wk/ -/ 2/ ,/ -/ (/ ∑/ k/ // 2/ -/ 1/ 其中/ ‖/ pi/ ‖/ 2/ 是/ 狆/ i/ 的/ 标量/ 积/ ,/ rj/ 是/ 随机数/ 且/ rj/ ∈/ R/ ./ 也就是说/ ,/ 计算/ 元素/ 组/ ce/ =/ (/ 狆/ i/ ,/ -/ 0.5/ ×/ ‖/ pi/ ‖/ 2/ )/ ,/ 随机/ 元素/ 组为/ re/ =/ (/ r1/ ,/ w2/ ,/ …/ ,/ rk/ -/ 3/ ,/ wk/ -/ 2/ ,/ -/ (/ ∑/ k/ // 2/ -/ 1w2/ ×/ j/ -/ 1/ )/ ,/ 1/ )/ ./ 然后/ Owner/ 根据/ 分裂/ 串/ S/ 将/ pi/ 分割/ 成/ Page5/ 两个/ d/ 维子/ 向量/ 狆/ i1/ 和/ 狆/ i2/ :/ 假设/ S/ [/ z/ ]/ 表示/ 分裂/ 串/ S/ 的/ 第/ z/ (/ z/ ∈/ N/ 且/ z/ ∈/ [/ 1/ ,/ d/ ]/ )/ 位/ ,/ 如果/ S/ [/ z/ ]/ 为/ ‘/ 0/ ’/ ,/ 则/ 狆/ i/ 的/ 第/ z/ 个/ 元素/ pi/ [/ z/ ]/ 分裂/ 为/ x1/ 和/ x2/ ,/ 使得/ pi/ [/ z/ ]/ =/ x1/ +/ x2/ ,/ 分别/ 作为/ pi1/ [/ z/ ]/ 和/ pi2/ [/ z/ ]/ ;/ 如果/ S/ [/ z/ ]/ 为/ ‘/ 1/ ’/ ,/ 则/ pi/ 的/ 第/ z/ 个/ 元素/ pi/ [/ z/ ]/ 不用/ 分裂/ ,/ pi1/ [/ z/ ]/ =/ pi2/ [/ z/ ]/ =/ pi/ [/ z/ ]/ ;/ 加密/ 向量/ 狆/ i1/ 和/ 狆/ i2/ 得到/ 犘/ i1/ =/ 犕/ ×/ 狆/ i1/ 和/ 犘/ i2/ =/ 犕/ ×/ 狆/ i2/ ,/ 并/ 将/ 犘/ i/ =/ (/ 犘/ i1/ ,/ 犘/ i2/ )/ 存储/ 到/ SP/ 处/ ./ 对/ 加密/ 的/ 外包/ 字符串/ 犘/ i/ 解密/ 是/ 加密算法/ 的/ 逆/ 过程/ ,/ 所以/ 不再/ 详述/ ./ 4.2/ ./ 1.3/ 检索/ 参数/ 的/ 加密/ 当/ User/ 想/ 检索/ 字符串/ nq/ 时/ ,/ 他/ 首先/ 选择/ 一个/ 随机数/ r/ (/ r/ >/ 0/ 且/ r/ ∈/ R/ )/ 并/ 根据/ 以上/ 字符串/ 转换方法/ 生成/ 对应/ 的/ (/ n/ -/ 1/ )/ 维/ 向量/ 狇/ ,/ 然后/ 将/ 狇/ 扩充/ 为/ 一个/ d/ 维/ 向量/ 狇/ =/ r/ ×/ (/ 狇/ ,/ 1/ ,/ w1/ ,/ r2/ ,/ …/ ,/ wk/ -/ 3/ ,/ rk/ -/ 2/ ,/ 1/ ,/ -/ (/ ∑/ k/ // 2/ -/ 1/ 也就是说/ ,/ 计算/ 元素/ 组为/ ce/ =/ (/ 狇/ ,/ 1/ )/ ,/ 随机/ 元素/ 组为/ re/ =/ (/ w1/ ,/ r2/ ,/ …/ ,/ wk/ -/ 3/ ,/ rk/ -/ 2/ ,/ 1/ ,/ -/ (/ ∑/ k/ // 2/ -/ 1w2/ ×/ j/ )/ )/ ./ 然后/ User/ 根据/ 分裂/ 串/ S/ 将/ 狇/ 分割/ 成/ 两个/ d/ 维子/ 向量/ 狇/ 1/ 和/ 狇/ 2/ :/ 如果/ S/ [/ z/ ]/ 为/ ‘/ 1/ ’/ ,/ 则/ 狇/ 的/ 第/ z/ 个/ 元素/ q/ [/ z/ ]/ 分裂/ 为/ x1/ 和/ x2/ ,/ 使得/ q/ [/ z/ ]/ =/ x1/ +/ x2/ ,/ 分别/ 作为/ q1/ [/ z/ ]/ 和/ q2/ [/ z/ ]/ ;/ 如果/ S/ [/ z/ ]/ 为/ ‘/ 0/ ’/ ,/ 则/ 狇/ 的/ 第/ z/ 个/ 元素/ q/ [/ z/ ]/ 不用/ 分裂/ ,/ q1/ [/ z/ ]/ =/ q2/ [/ z/ ]/ =/ q/ [/ z/ ]/ ;/ 加密/ 狇/ 1/ 和/ 狇/ 2/ 得到/ 犙/ 1/ =/ 狇/ 1/ ×/ (/ 犕/ -/ 1/ )/ 和/ 犙/ 2/ =/ 狇/ 2/ ×/ (/ 犕/ -/ 1/ )/ ,/ 并/ 将/ 犙/ =/ (/ 犙/ 1/ ,/ 犙/ 2/ )/ 提交/ 给/ SP/ ./ 4.2/ ./ 1.4/ 加密/ 字符串/ 的/ 检索/ 的/ Pi/ 进行/ 如下/ 运算/ :/ Q/ ×/ Pi/ =/ (/ (/ q1/ ,/ q2/ )/ ×/ M/ -/ 1/ )/ ×/ (/ M/ ×/ (/ pi1/ ,/ pi2/ )/ )/ =/ (/ q1/ ,/ q2/ )/ ×/ M/ -/ 1/ ×/ M/ ×/ (/ pi1/ ,/ pi2/ )/ =/ (/ q1/ ,/ q2/ )/ ×/ (/ pi1/ ,/ pi2/ )/ =/ q1/ ×/ pi1/ +/ q2/ ×/ pi2/ =/ r/ ×/ (/ q/ ,/ 1/ ,/ w1/ ,/ r2/ ,/ …/ ,/ wk/ -/ 3/ ,/ rk/ -/ 2/ ,/ 1/ ,/ 当/ SP/ 接到/ 检索/ 请求/ 时/ ,/ 将/ 对/ User/ 权限/ 范围/ 内/ j/ =/ 1/ =/ r/ ×/ (/ pi/ ×/ q/ -/ 0.5/ ‖/ pi/ ‖/ 2/ +/ ∑/ 2k/ =/ r/ ×/ (/ pi/ ×/ q/ -/ 0.5/ ‖/ pi/ ‖/ 2/ )/ 然后/ SP/ 比较/ 结果/ 的/ 值/ ,/ 其值/ 越大/ ,/ nq/ 与/ npi/ 越/ 相似/ ./ 其/ 原因/ 如下/ :/ 假设/ 犘/ 1/ 和/ 犘/ 2/ 是/ 两个/ 外/ 包/ 字符串/ np1/ 和/ np2/ 对应/ 的/ 加密/ 向量/ ,/ 犙/ 是/ 检索/ 参数/ nq/ 的/ 加密/ 向量/ :/ 犙/ ×/ 犘/ 1/ -/ 犙/ ×/ 犘/ 2/ =/ r/ ×/ (/ p1/ ×/ q/ -/ 0.5/ ×/ ‖/ p1/ ‖/ 2/ -/ =/ r/ ×/ (/ p1/ ×/ q/ -/ 0.5/ ×/ ‖/ p1/ ‖/ 2/ -/ p2/ ×/ q/ +/ 0.5/ ×/ ‖/ p2/ ‖/ 2/ -/ 0.5/ ×/ ‖/ q/ ‖/ 2/ +/ 0.5/ ×/ ‖/ q/ ‖/ 2/ )/ =/ -/ 0.5/ ×/ r/ ×/ (/ ‖/ p1/ ‖/ 2/ -/ 2p1q/ +/ ‖/ q/ ‖/ 2/ )/ +/ 0.5/ ×/ r/ ×/ (/ ‖/ p2/ ‖/ 2/ -/ 2p2q/ +/ ‖/ q/ ‖/ 2/ )/ =/ 0.5/ ×/ r/ ×/ [/ d2/ (/ p2/ ,/ q/ )/ -/ d2/ (/ p1/ ,/ q/ )/ ]/ (/ 2/ )/ 其中/ ,/ d/ (/ 狆/ ,/ 狇/ )/ 表示/ 向量/ 狆/ 和/ 狇/ 的/ 欧几里得/ 距离/ ./ 由式/ (/ 2/ )/ 得/ 因为/ d/ (/ pi/ ,/ q/ )/ / 0/ 且/ r/ ∈/ R/ +/ 所以/ 犙/ ×/ 犘/ 1/ -/ 犙/ ×/ 犘/ 2/ =/ 0.5/ ×/ r/ ×/ (/ d2/ (/ 狆/ 2/ ,/ 狇/ )/ -/ d2/ (/ 狆/ 1/ ,/ 狇/ )/ )/ >/ 0/ / d/ (/ 狆/ 2/ ,/ 狇/ )/ >/ d/ (/ 狆/ 1/ ,/ 狇/ )/ (/ 3/ )/ 所以/ SP/ 可以/ 通过/ 对/ Pi/ 和/ Q/ 的/ 标量/ 积/ 进行/ 从大到/ 小/ 的/ 排序/ 从而/ 得到/ 一个/ 按/ 相似/ 度/ 由/ 高到/ 低/ 排列/ 的/ 序列/ ,/ 从而/ 实现/ 了/ 模糊/ 检索/ ./ 4.2/ ./ 2/ 数值数据/ 对/ 数值数据/ 的/ 操作/ 可以/ 简单/ 地/ 分为/ 4/ 种/ 基本/ 算术/ 运算/ :/ 加法/ 、/ 减法/ 、/ 乘法/ 和/ 除法/ ./ 为了/ 实现/ 加/ // 减法/ 和/ 乘/ // 除法/ ,/ 计算/ 元素/ 组/ ce/ 由/ 加法/ 因子/ addF/ 和/ 乘法/ 因子/ mulF/ 组成/ ,/ 其中/ addF/ 由/ da/ (/ da/ ∈/ N/ 且/ da/ >/ 3/ )/ 个/ 元素/ 组成/ ,/ mulF/ 由/ dm/ (/ dm/ ∈/ N/ 且/ dm/ / 2/ )/ 个/ 元素/ 组成/ ./ 也就是说/ ,/ ce/ =/ (/ addF/ ,/ mulF/ )/ 且/ n/ =/ da/ +/ dm/ ./ 4.2/ ./ 2.1/ 数值数据/ 的/ 转换/ 和/ 加/ 、/ 解密/ 转换/ 一个/ 数值数据/ np/ 为/ d/ 维/ 向量/ 的/ 过程/ 可以/ 分为/ 以下/ 4/ 步/ :/ 首先/ ,/ 选择/ (/ da/ -/ 1/ )/ 个/ 随机数/ {/ ar1/ ,/ ar2/ ,/ …/ ,/ arda/ -/ 1/ }/ (/ ari/ ∈/ R/ 且/ i/ ∈/ [/ 1/ ,/ da/ -/ 1/ ]/ )/ ,/ 并/ 计算/ arda/ =/ np/ -/ ∑/ da/ -/ 1/ (/ ar1/ ,/ ar2/ ,/ …/ ,/ arda/ )/ T/ ;/ 再/ 生成/ da/ 个/ 随机数/ {/ cr1/ ,/ cr2/ ,/ …/ ,/ crda/ }/ (/ cri/ ∈/ R/ 且/ i/ ∈/ [/ 1/ ,/ da/ ]/ )/ ,/ 使/ 狆/ 变为/ 狆/ =/ (/ ar1/ +/ cr1/ ,/ ar2/ +/ cr2/ ,/ …/ ,/ arda/ +/ crda/ )/ T/ ./ 然后/ ,/ 随机/ 选择/ (/ dm/ -/ 1/ )/ 个/ 随机数/ {/ mr1/ ,/ mr2/ ,/ …/ ,/ mrdm/ -/ 1/ }/ (/ mri/ ∈/ R/ 且/ mri/ 的/ 倒数/ 都/ 是/ 有限小数/ ,/ i/ ∈/ [/ 1/ ,/ dm/ -/ 1/ ]/ )/ ,/ 计算/ mrdm/ =/ np/ ∏/ dm/ -/ 1/ (/ da/ +/ dm/ )/ 维/ 的/ 向量/ 狆/ =/ (/ ar1/ +/ cr1/ ,/ ar2/ +/ cr2/ ,/ …/ ,/ arda/ +/ crda/ ,/ mr1/ ,/ mr2/ ,/ …/ ,/ mrdm/ )/ T/ ./ 第/ 3/ 步/ ,/ Owner/ 通过/ 加入/ 随机/ 元素/ 组/ re/ 扩充/ 狆/ 从而/ 构成/ 了/ 一个/ (/ da/ +/ dm/ +/ k/ )/ 维/ 的/ 向量/ 狆/ / =/ (/ ar1/ +/ cr1/ ,/ ar2/ +/ cr2/ ,/ …/ ,/ arda/ +/ crda/ ,/ mr1/ ,/ mr2/ ,/ …/ ,/ mrdm/ ,/ r1/ ,/ …/ ,/ rk/ -/ 1/ ,/ -/ ∑/ dacri/ )/ T/ ,/ 其中/ k/ ∈/ N/ 且/ k/ / 2/ ,/ rj/ 是/ 随机数/ 且/ rj/ ∈/ Ri/ =/ 1Page6/ (/ j/ ∈/ [/ 1/ ,/ k/ -/ 1/ ]/ )/ ./ 最后/ ,/ Owner/ 加密/ 狆/ / 形成/ 了/ 外包/ 向量/ 犘/ =/ 犕/ ×/ 狆/ / ,/ 并/ 存储/ 到/ SP/ 的/ 服务器/ 上/ ./ 对/ 加密/ 的/ 外包/ 数值数据/ 犘/ 解密/ 是/ 加密算法/ 的/ 逆/ 过程/ ,/ 所以/ 不再/ 详述/ ./ User/ 将/ 检索/ 参数/ 转换/ 为/ 向量/ 的/ 步骤/ 与/ Owner/ 的/ 步骤/ 一样/ ./ 只是/ 在/ 进行/ 加/ // 减法/ 运算/ 时/ ,/ User/ 可以/ 设置/ mulF/ =/ (/ 0/ ,/ 0/ ,/ …/ 烐/ 烏/ 烑/ 0/ 的/ 转换/ 过程/ 是/ 一样/ 的/ ,/ 因此/ 两个/ 数值数据/ 的/ 运算/ ,/ 无论/ 它们/ 同时/ 为/ 外包/ 数据/ ,/ 或者/ 一个/ 是/ 外包/ 数据/ 一个/ 是/ 检索/ 参数/ ,/ 或者/ 两个/ 都/ 是/ 检索/ 参数/ ,/ 处理/ 的/ 方法/ 都/ 是/ 一样/ ./ 所以/ ,/ 我们/ 假设/ 两个/ 数值数据/ np/ 和/ nq/ 对应/ 的/ 加密/ 向量/ 为/ 犘/ 和/ 犙/ ./ 接下来/ ,/ 我们/ 将/ 阐述/ 如何/ 实现/ 各种/ 算术/ 运算/ ./ 4.2/ ./ 2.2/ 加法/ 犘/ +/ 犙/ =/ 犕/ ×/ 狆/ / +/ 犕/ ×/ 狇/ / SP/ 直接/ 对/ 犘/ 和/ 犙/ 执行/ 加法/ 运算/ :/ =/ 犕/ ×/ [/ (/ arp1/ +/ crp1/ ,/ arp2/ +/ crp2/ ,/ …/ ,/ arpda/ +/ crpda/ ,/ mrp1/ ,/ mrp2/ ,/ …/ ,/ mrpdm/ ,/ rp1/ ,/ …/ ,/ rp/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ da/ (/ arq1/ +/ crq1/ ,/ arq2/ +/ crq2/ ,/ …/ ,/ arqda/ +/ crqda/ ,/ mrq1/ ,/ mrq2/ ,/ …/ ,/ mrqdm/ ,/ rq1/ ,/ …/ ,/ rq/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ da/ =/ 犕/ ×/ (/ (/ arp1/ +/ arq1/ +/ crp1/ +/ crq1/ )/ ,/ …/ ,/ (/ arpda/ +/ arqda/ +/ crpda/ +/ crqda/ )/ ,/ (/ mrp1/ +/ mrq1/ )/ ,/ …/ ,/ (/ mrpdm/ +/ mrqdm/ )/ ,/ (/ rp1/ +/ rq1/ )/ ,/ …/ ,/ (/ rp/ (/ k/ -/ 1/ )/ +/ rq/ (/ k/ -/ 1/ )/ )/ ,/ (/ -/ ∑/ da/ 然后/ ,/ SP/ 将/ 计算结果/ 返回/ 给/ User/ ./ User/ 对/ 结果/ 解密/ :/ 犕/ -/ 1/ ×/ (/ 犘/ +/ 犙/ )/ =/ 犕/ -/ 1/ ×/ 犕/ ×/ (/ (/ arp1/ +/ arq1/ +/ crp1/ +/ crq1/ )/ ,/ …/ ,/ (/ arpda/ +/ arqda/ +/ crpda/ +/ crqda/ )/ ,/ =/ (/ (/ arp1/ +/ arq1/ +/ crp1/ +/ crq1/ )/ ,/ …/ ,/ (/ arpda/ +/ 通过/ 式/ (/ 5/ )/ ,/ User/ 得到/ 一个/ d/ 维/ 向量/ ,/ 于是/ 它/ i/ =/ 1/ 通过/ 公式/ (/ ∑/ da/ (/ -/ ∑/ da/ 后/ 一个/ 元素/ 相加/ 从而/ 得到/ 最后/ 的/ 结果/ ./ 该/ 方案/ 支持/ 在/ 不/ 解密/ 的/ 情况/ 下/ 进行/ 多次/ 加法/ 操作/ ./ 4.2/ ./ 2.3/ 减法/ SP/ 直接/ 对/ 犘/ 和/ 犙/ 执行/ 减法/ 运算/ :/ 犘/ -/ 犙/ =/ 犕/ ×/ 狆/ / -/ 犕/ ×/ 狇/ / =/ 犕/ ×/ [/ (/ arp1/ +/ crp1/ ,/ arp2/ +/ crp2/ ,/ …/ ,/ arpda/ +/ =/ 犕/ ×/ (/ (/ arp1/ -/ arq1/ +/ crp1/ -/ crq1/ )/ ,/ …/ ,/ 然后/ ,/ SP/ 将/ 计算结果/ 返回/ 给/ User/ ./ User/ 对/ 结果/ 进行/ 解密/ :/ 犕/ -/ 1/ ×/ (/ 犘/ -/ 犙/ )/ =/ 犕/ -/ 1/ ×/ 犕/ ×/ (/ (/ arp1/ -/ arq1/ +/ crp1/ -/ =/ (/ (/ arp1/ -/ arq1/ +/ crp1/ -/ crq1/ )/ ,/ …/ ,/ (/ arpda/ -/ 通过/ 式/ (/ 7/ )/ ,/ User/ 得到/ 一个/ d/ 维/ 向量/ ,/ 于是/ 它/ i/ =/ 1/ 通过/ 公式/ (/ ∑/ da/ (/ -/ ∑/ da/ 后/ 一个/ 元素/ 相加/ 从而/ 得到/ 最后/ 的/ 结果/ ./ 该/ 方案/ 支持/ 在/ 不/ 解密/ 的/ 情况/ 下/ 进行/ 多次/ 减法/ 操作/ ./ 4.2/ ./ 2.4/ 乘法/ 首先/ ,/ 我们/ 介绍/ 实现/ 乘法/ 计算/ 的/ 原理/ ./ 假设/ 有/ 两个/ 数值数据/ np/ 和/ nq/ ,/ 它们/ 对应/ 的/ 6/ 维/ 向量/ 分别/ 为/ Page7x1/ +/ y1/ ,/ np/ =/ a1/ ×/ b1/ ,/ nq/ =/ x2/ +/ y2/ 和/ nq/ =/ a2/ ×/ b2/ ,/ c1/ 、/ 狏/ 1/ =/ (/ x1/ +/ c1/ ,/ y1/ +/ c2/ ,/ a1/ ,/ b1/ ,/ r1/ ,/ -/ c1/ -/ c2/ )/ 和/ 狏/ 2/ =/ c2/ 、/ c3/ 、/ c4/ 、/ r1/ 和/ r2/ 是/ 随机/ 实数/ ./ 我们/ 观察/ 以下/ 运算/ 结果/ :/ (/ x2/ +/ c3/ ,/ y2/ +/ c4/ ,/ a2/ ,/ b2/ ,/ r2/ ,/ -/ c3/ -/ c4/ )/ ,/ 其中/ np/ =/ 狏/ 1/ ×/ (/ 狏/ 2/ )/ T/ =/ x1/ +/ c1y1/ +/ c2a1b1r1/ -/ c1/ -/ c/ )/ 2T/ ×/ x2/ +/ c3y2/ +/ c4a2b2r2/ -/ c3/ -/ cx1x2/ +/ x1c3/ +/ c1x2/ +/ c1c3x1y2/ +/ x1c4/ +/ c1y2/ +/ c1c4x1a2/ +/ c1a2x1b2/ +/ c1b2x1r2/ +/ c1r2/ -/ x1c3/ -/ x1c4/ -/ c1c3/ -/ c1c4/ 烄/ y1x2/ +/ y1c3/ +/ c2x2/ +/ c2c3y1y2/ +/ y1c4/ +/ c2y2/ +/ c2c4y1a2/ +/ c2a2y1b2/ +/ c2b2y1r2/ +/ c2r2/ -/ y1c3/ -/ y1c4/ -/ c2c3/ -/ c2c4a1y2/ +/ a1c4a1a2a1b2a1r2b1y2/ +/ b1c4b1a2b1b2b1r2r1y2/ +/ r1c4r1a2r1b2r1r2/ 烆/ -/ c1x2/ -/ c1c3/ -/ c2x2/ -/ c2c3/ -/ c1y2/ -/ c1c4/ -/ c2y2/ -/ c2c4/ -/ c1a2/ -/ c2a2/ -/ c1b2/ -/ c2b2/ -/ c1r2/ -/ c2r2c1c3/ +/ c1c4/ +/ c2c3/ +/ c2c/ 根据/ 式/ (/ 8/ )/ 可/ 得到/ :/ np/ ×/ nq/ =/ (/ a1/ ×/ b1/ )/ ×/ (/ a2/ ×/ b2/ )/ =/ (/ a1/ ×/ a2/ )/ ×/ (/ b1/ ×/ b2/ )/ 设/ matrix/ 表示/ 狏/ 1/ ×/ (/ 狏/ 2/ )/ T/ 的/ 结果/ ,/ 我们/ 可以/ 通过/ 公式/ ∏/ 4/ 以上/ 分析/ ,/ SP/ 可以/ 对/ 犘/ 和/ 犙/ 进行/ 如下/ 操作/ :/ 犘/ ×/ (/ 犙/ )/ T/ =/ 犕/ ×/ 狆/ / ×/ (/ 犕/ ×/ 狇/ / )/ T/ =/ 犕/ ×/ 狆/ / ×/ (/ 狇/ / )/ T/ ×/ 犕/ T/ 式/ (/ 10/ )/ 的/ 结果/ 是/ 一个/ d/ ×/ d/ 矩阵/ ./ SP/ 将/ 结果/ 返回/ 给/ User/ ./ User/ 对/ 结果/ 进行/ 解密/ :/ 犕/ -/ 1/ ×/ 犘/ ×/ (/ 犙/ )/ T/ ×/ (/ 犕/ T/ )/ -/ 1/ =/ 犕/ -/ 1/ ×/ 犕/ ×/ (/ arp1/ +/ crp1/ ,/ arp2/ +/ crp2/ ,/ …/ ,/ arpda/ +/ crpda/ ,/ mrp1/ ,/ mrp2/ ,/ …/ ,/ mrpdm/ ,/ rp1/ ,/ …/ ,/ rp/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ dacrq1/ ,/ arq2/ +/ crq2/ ,/ …/ ,/ arqda/ +/ crqda/ ,/ mrq1/ ,/ mrq2/ ,/ …/ ,/ mrqdm/ ,/ rq1/ ,/ …/ ,/ rq/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ da/ 犕/ T/ ×/ (/ 犕/ T/ )/ -/ 1/ =/ (/ arp1/ +/ crp1/ ,/ arp2/ +/ crp2/ ,/ …/ ,/ arpda/ +/ crpda/ ,/ mrp1/ ,/ mrp2/ ,/ …/ ,/ mrpdm/ ,/ rp1/ ,/ …/ ,/ rp/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ da/ (/ arq1/ +/ crq1/ ,/ arq2/ +/ crq2/ ,/ …/ ,/ arqda/ +/ crqda/ ,/ mrq1/ ,/ mrq2/ ,/ …/ ,/ mrqdm/ ,/ rq1/ ,/ …/ ,/ rq/ (/ k/ -/ 1/ )/ ,/ -/ ∑/ da/ 式/ (/ 11/ )/ 的/ 计算结果/ 也/ 是/ 一个/ d/ ×/ d/ 矩阵/ ,/ 用/ matrix/ 表示/ ./ 接下来/ ,/ User/ 通过/ 公式/ ∏/ da/ +/ dm/ 来/ 计算/ 最终/ 结果/ ./ 本/ 方案/ 在/ 不/ 解密/ 的/ 情况/ 下/ 只/ 支持/ 一次/ 乘法/ 运算/ ./ (/ 4.2/ ./ 2.5/ 除法/ 同样/ ,/ 我们/ 先/ 介绍/ 实现/ 除法/ 操作/ 的/ 原理/ ./ 假设/ 有/ 两个/ 数值数据/ np/ 和/ nq/ ,/ 它们/ 对应/ 的/ 6/ 维/ 向量/ 分别/ 是/ 狏/ 1/ =/ (/ x1/ +/ c1/ ,/ y1/ +/ c2/ ,/ a1/ ,/ b1/ ,/ r1/ ,/ -/ c1/ -/ c2/ )/ 和/ 狏/ 2/ =/ (/ x2/ +/ c3/ ,/ y2/ +/ c4/ ,/ a2/ ,/ b2/ ,/ r2/ ,/ -/ c3/ -/ c4/ )/ ,/ 其中/ np/ =/ x1/ +/ y1/ ,/ np/ =/ a1/ ×/ b1/ ,/ nq/ =/ x2/ +/ y2/ 和/ nq/ =/ a2/ ×/ b2/ ,/ c1/ 、/ c2/ 、/ r1/ 和/ r2/ 是/ 随机/ 实数/ ./ 根据/ 式/ (/ 8/ )/ ,/ 我们/ 得到/ 以下/ 结果/ :/ ∏/ 4/ (/ x1/ +/ y1/ )/ 2/ ×/ (/ a2/ ×/ b2/ )/ =/ np2/ ×/ nq/ (/ 12/ )/ ∏/ 4/ (/ a1/ ×/ b1/ )/ ×/ (/ x2/ +/ y2/ )/ 2/ =/ np/ ×/ nq2/ (/ 13/ )/ 所以/ np/ // nq/ 可以/ 通过/ 如下/ 公式/ 得到/ :/ np/ // nq/ =/ i/ =/ 3/ (/ ∑/ 2/ ∏/ 4/ 烄/ i/ =/ 3/ (/ ∑/ 2/ ∏/ 4/ 烆/ 根据/ 式/ (/ 12/ )/ ~/ (/ 14/ )/ ,/ 我们/ 给出/ 除法/ 操作/ 的/ 方案/ ./ SP/ 首先/ 按照/ 式/ (/ 10/ )/ 对/ 犘/ 和/ 犙/ 进行/ 运算/ ,/ 然后/ 将/ 结果/ 返回/ 给/ User/ ./ User/ 根据/ 式/ (/ 11/ )/ 对/ 结果/ 进行/ 解密/ 得到/ 矩阵/ matrix/ ./ 为了/ 得到/ 最后/ 的/ 结果/ ,/ User/ 还/ 需要/ 按照/ 以下/ 步骤/ 进行/ 处理/ :/ 1/ )/ ∏/ da/ +/ dm2/ )/ ∏/ da/ +/ dm3/ )/ dm/ -/ 1npdm/ ×/ nq/ 式/ (/ 17/ )/ 的/ 结果/ 就是/ 最后/ 的/ 结果/ ./ 本/ 方案/ 在/ 不/ 解密/ 的/ 情况/ 下/ 只/ 支持/ 一次/ 除法/ 运算/ ./ Page84/ ./ 3CESVMC/ 的/ 正确性/ (/ 1/ )/ / m/ ∈/ 犕/ ,/ 证明/ Dec/ (/ Enc/ (/ m/ ,/ k/ )/ )/ =/ m/ ./ 证明/ ./ CESVMC/ 基于/ 向量/ 和/ 矩阵/ 运算/ ,/ 密钥/ 犕/ 是/ 一个/ d/ ×/ d/ 的/ 可逆/ 矩阵/ ,/ 因此/ ,/ 将/ 明文/ 数据/ m/ 转换/ 为/ 对应/ 的/ d/ 维/ 向量/ 狆/ ,/ 则/ 有/ Dec/ (/ Enc/ (/ m/ ,/ k/ )/ )/ =/ 犕/ -/ 1/ ×/ (/ 犕/ ×/ 狆/ )/ =/ 狆/ ,/ 因此/ 狆/ 是/ 可/ 恢复/ 的/ ,/ 即/ m/ 是/ 可以/ 恢复/ 的/ ./ 所以/ / m/ ∈/ D/ ,/ / Dec/ (/ Enc/ (/ m/ ,/ k/ )/ )/ =/ m/ ./ 证毕/ ./ (/ 2/ )/ / {/ m1/ ,/ m2/ ,/ …/ ,/ mt/ }/ ,/ 其中/ mi/ ∈/ D/ ,/ 证明/ Cal/ (/ m1/ ,/ m2/ ,/ …/ ,/ mt/ ,/ op/ )/ =/ Dec/ (/ Cal/ (/ Enc/ (/ m1/ ,/ K/ )/ ,/ Enc/ (/ m2/ ,/ K/ )/ ,/ …/ ,/ Enc/ (/ mt/ ,/ K/ )/ ,/ op/ )/ )/ ./ 证明/ ./ 由/ 矩阵/ 和/ 向量/ 运算/ 的/ 性质/ 易/ 见/ ,/ 在/ 进行/ 加/ 、/ 减/ 、/ 乘/ 和/ 除法/ 运算/ 时/ ,/ 满足/ Cal/ (/ m1/ ,/ m2/ ,/ …/ ,/ mt/ ,/ op/ )/ =/ Dec/ (/ Cal/ (/ Enc/ (/ m1/ ,/ K/ )/ ,/ Enc/ (/ m2/ ,/ K/ )/ ,/ …/ ,/ Enc/ (/ mt/ ,/ K/ )/ ,/ op/ )/ )/ ./ 因此/ ,/ 本/ 证明/ 重点/ 分析/ 字符串/ 模糊/ 检索/ 的/ 正确性/ ./ 根据/ 第/ 4.2/ ./ 1.1/ 节/ ,/ 将/ 两个/ 外/ 包/ 字符串/ np1/ 和/ np2/ 分别/ 转换/ 为/ 两个/ (/ n/ -/ 1/ )/ 维/ 的/ 向量/ 狆/ 1/ =/ (/ v11/ ,/ v12/ ,/ …/ ,/ v1/ (/ n/ -/ 1/ )/ )/ 和/ 狆/ 2/ =/ (/ v21/ ,/ v22/ ,/ …/ ,/ v2/ (/ n/ -/ 1/ )/ )/ ,/ 检索/ 参数/ nq/ 对应/ 的/ (/ n/ -/ 1/ )/ 维/ 向量/ 为/ 狇/ =/ (/ v1/ ,/ v2/ ,/ …/ ,/ vn/ -/ 1/ )/ ,/ 则/ 有/ 犙/ ×/ 犘/ 1/ -/ 犙/ ×/ 犘/ 2/ =/ r/ ×/ (/ 狆/ 1/ ×/ 狇/ -/ 0.5/ ×/ ‖/ 狆/ 1/ ‖/ 2/ -/ =/ r/ ×/ (/ 狆/ 1/ ×/ 狇/ -/ 0.5/ ×/ ‖/ 狆/ 1/ ‖/ 2/ -/ 狆/ 2/ ×/ 狇/ +/ 0.5/ ×/ ‖/ 狆/ 2/ ‖/ 2/ -/ 0.5/ ×/ ‖/ 狇/ ‖/ 2/ +/ 0.5/ ×/ ‖/ 狇/ ‖/ 2/ )/ =/ -/ 0.5/ ×/ r/ ×/ (/ (/ ‖/ 狆/ 1/ ‖/ 2/ -/ 2/ 狆/ 1/ 狇/ +/ ‖/ 狇/ ‖/ 2/ )/ -/ (/ ‖/ 狆/ 2/ ‖/ 2/ -/ 2/ 狆/ 2/ 狇/ +/ ‖/ 狇/ ‖/ 2/ )/ )/ =/ -/ 0.5/ ×/ r/ ×/ (/ ∑/ n/ -/ 1/ =/ -/ 0.5/ ×/ r/ ×/ ∑/ n/ -/ 1/ 对于/ 每个/ 字符串/ 的/ 第/ i/ 段/ 子串/ ,/ 由于/ 向量/ 元素/ vi/ 是/ 由/ 该段/ 的/ 组成/ 字符/ 的/ ASCII/ 码/ 转换/ 而/ 来/ ,/ 因此/ 越/ 相近/ 的/ 字符/ 之间/ 的/ 差值/ 越小/ ,/ 从而/ 保证/ 了/ 该段/ 上/ 的/ vi/ 值之差/ 的/ 大小/ 反映/ 了/ 第/ i/ 段/ 子串/ 的/ 相似/ 程度/ ./ 对于/ 不同/ 段/ ,/ 根据/ 前缀/ 匹配/ 原则/ ,/ 越/ 前面/ 的/ 段/ 对/ 整个/ 差值/ 的/ 影响/ 也/ 越/ 大/ ,/ 因此/ ,/ 前后/ 两段/ 的/ 关系/ 为/ vi/ +/ 1/ =/ vi/ ×/ 1012/ (/ 每段/ 由/ 6/ 个字符/ 组成/ ,/ 每个/ 字符/ 用/ 2/ 位数/ 的/ ASCII/ 值/ 表示/ )/ ,/ 从而/ 实现/ 了/ 前缀/ 匹配/ ./ 证毕/ ./ 5CESVMC/ 的/ 安全性/ tance/ -/ recoverable/ )/ ./ 定理/ 1/ ./ CESVMC/ 是/ 距离/ 不可/ 恢复/ 的/ (/ dis/ -/ 证明/ ./ 如果/ CESVMC/ 是/ 距离/ 可/ 恢复/ 的/ ,/ 那么/ 必然/ 存在/ 一个/ 函数/ f/ ,/ 使得/ 对于/ / m1/ ,/ m2/ ∈/ D/ ,/ f/ (/ Enc/ (/ m1/ ,/ M/ )/ ,/ Enc/ (/ m2/ ,/ 犕/ )/ )/ =/ d/ (/ m1/ ,/ m2/ )/ ./ 选择/ 两个/ 不同/ 的/ 密钥/ 犕/ 1/ ,/ 犕/ 2/ 和/ x1/ ,/ x2/ ∈/ D/ ,/ CESVMC/ 满足/ (/ 1/ )/ a1/ =/ Enc/ (/ m1/ ,/ 犕/ 1/ )/ =/ Enc/ (/ x1/ ,/ 犕/ 2/ )/ ;/ (/ 2/ )/ a2/ =/ Enc/ (/ m2/ ,/ 犕/ 1/ )/ =/ Enc/ (/ x2/ ,/ 犕/ 2/ )/ ;/ (/ 3/ )/ d/ (/ m1/ ,/ m2/ )/ ≠/ d/ (/ x1/ ,/ x2/ )/ ./ 则/ 由于/ f/ (/ a1/ ,/ a2/ )/ =/ f/ (/ Enc/ (/ m1/ ,/ M1/ )/ ,/ Enc/ (/ m2/ ,/ M1/ )/ )/ =/ d/ (/ m1/ ,/ m2/ )/ ,/ f/ (/ a1/ ,/ a2/ )/ =/ f/ (/ Enc/ (/ x1/ ,/ M2/ )/ ,/ Enc/ (/ x2/ ,/ M2/ )/ )/ =/ d/ (/ x1/ ,/ x2/ )/ ;/ 所以/ d/ (/ m1/ ,/ m2/ )/ =/ d/ (/ x1/ ,/ x2/ )/ ./ 以上/ 结论/ 与/ 条件/ (/ 3/ )/ 冲突/ ,/ 因此/ 函数/ f/ 是/ 不/ 存在/ 的/ ./ 所以/ CESVMC/ 是/ 距离/ 不可/ 恢复/ 的/ ./ 证毕/ ./ 定义/ 5/ (/ 方程/ 不可/ 解/ )/ ./ 假设/ 犘/ 为/ d/ 维/ 向量/ 集合/ ,/ 犕/ 为/ d/ ×/ d/ 矩阵/ 集合/ ,/ 方程/ f/ (/ Pi/ ,/ Mj/ )/ =/ Pk/ 是/ 不可/ 解/ 的/ ,/ 如果/ 已知/ / Pi/ ∈/ 犘/ 和/ / Mj/ ∈/ 犕/ ,/ 在/ 方程/ f/ (/ Pi/ ,/ Mj/ )/ =/ Pk/ (/ Pk/ ∈/ 犘/ ,/ i/ ,/ j/ ,/ k/ ∈/ N/ )/ 中/ ,/ 方程/ 等/ 号/ 两边/ 的/ 未知/ 元素/ 个数/ 分别/ 为/ s1/ 和/ s2/ ,/ 且/ 保持/ s1/ >/ s2/ ./ 定理/ 2/ ./ 从/ 字符串/ 加密/ 与/ 检索/ 的/ 角度/ ,/ (/ 1/ )/ 当/ 适应性/ 选择/ 密文/ 攻击者/ 只/ 获得/ 外/ 包/ 数据/ 的/ 加密/ 和/ 解密/ Oracle/ 的/ 情况/ 下/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ;/ (/ 2/ )/ 当/ 适应性/ 选择/ 密文/ 攻击者/ 获得/ 了/ 检索/ 参数/ 的/ 加密/ Oracle/ 后/ ,/ CESVMC/ 是/ 不/ 安全/ 的/ ./ 证明/ ./ (/ 1/ )/ 当/ 一个/ 适应性/ 选择/ 密文/ 攻击者/ A/ 只/ 获得/ 外/ 包/ 数据/ 的/ 加密/ 和/ 解密/ Oracle/ 的/ 情况/ 下/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ./ 1/ )/ A/ 可以/ 通过/ CESVMC/ 的/ 外包/ 数据/ 加密/ 和/ 解密/ Oracle/ 获得/ t/ (/ t/ ∈/ N/ )/ 对明/ // 密文/ 对/ ,/ 假设/ CES/ -/ VMC/ 使用/ d/ (/ d/ ∈/ N/ ,/ d/ =/ n/ +/ k/ ,/ n/ 表示/ 计算/ 元素/ 个数/ ,/ k/ 表示/ 随机/ 元素/ 个数/ )/ 维/ 向量/ 和/ d/ ×/ d/ 矩阵/ ,/ 根据/ 4.2/ ./ 1/ 节/ 可知/ ,/ 由于/ 分裂/ 串/ S/ 的/ 存在/ ,/ 当/ A/ 在/ 不/ 知道/ S/ 的/ 具体/ 值/ 的/ 时候/ ,/ 使得/ 分裂/ 后/ 的/ 两个/ 方程组/ 的/ 元素/ 对于/ A/ 来说/ 都/ 变成/ 了/ 未知数/ ,/ 因此/ 方程/ 等/ 号/ 两边/ 的/ 未知数/ 个数/ 的/ 关系/ 为/ d/ ×/ d/ +/ t/ ×/ 2/ ×/ d/ >/ t/ ×/ 2/ ×/ d/ / d/ ×/ d/ >/ 0/ ./ 所以/ ,/ CESVMC/ 的/ 矩阵/ 方程组/ 是/ 不可/ 解/ 的/ ;/ 当/ A/ 对/ 分裂/ 串/ 进行/ 穷举法/ 攻击/ 时/ ,/ 其/ 破解/ 函数/ 的/ 时间/ 复杂度/ 为/ O/ (/ 2d/ )/ ./ 根据/ 文献/ [/ 18/ ]/ ,/ 当/ 系统/ 的/ 复杂度/ 按/ 指数/ 形式/ 增长/ ,/ 那么/ 系统/ 为/ 实际/ 有效/ 安全/ 的/ ./ 2/ )/ A/ 发起/ 以下/ 攻击/ :/ (/ 1/ )/ A/ 选择/ 一些/ 明/ // 密文/ 向/ CESVMC/ 进行/ 加/ // 解密/ 询问/ ,/ E/ 将加/ // 解密/ 的/ 结果/ 返回/ 给/ A/ ;/ (/ 2/ )/ A/ 选择/ 两个/ 数据/ m0/ ,/ m1/ 发给/ CESVMC/ ,/ CESVMC/ 随机/ 加密/ 其中/ 一条/ 消息/ mb/ (/ b/ ∈/ {/ 0/ ,/ 1/ }/ )/ ,/ 并/ 将/ 产生/ 的/ 密文/ c/ 返回/ 给/ A/ ;/ (/ 3/ )/ A/ 继续/ 选择/ 一些/ 明/ // 密文/ 向/ CESVMC/ 进行/ 加/ // 解密/ 询问/ ,/ 唯一/ 的/ 限制/ 就是/ 不能/ 要求/ 解密/ c/ ,/ CESVMC/ 将加/ // 解密/ 的/ 结果/ 返回/ 给/ A/ ,/ 这时/ A/ 一共/ 得到/ t/ 组明/ // 密文/ 对/ Page9/ {/ (/ m1/ ,/ P1/ )/ ,/ (/ m2/ ,/ P2/ )/ ,/ …/ ,/ (/ mt/ ,/ Pt/ )/ }/ ;/ (/ 4/ )/ A/ 输出/ b/ 作为/ 对/ b/ 的/ 猜测/ ./ 根据/ 4.2/ ./ 1.2/ 和/ 4.2/ ./ 1.3/ 节/ 可知/ ,/ 对于/ 外/ 包/ 字符串/ np/ 和/ 检索/ 参数/ nq/ ,/ 它们/ 对应/ 的/ 密文/ 分别/ 是/ 犘/ 和/ 犙/ (/ 未分裂/ )/ :/ 犘/ =/ 犕/ ×/ (/ 狆/ i/ ,/ -/ 0.5/ ×/ ‖/ 狆/ i/ ‖/ 2/ ,/ r1/ ,/ w2/ ,/ …/ ,/ rk/ -/ 3/ ,/ 犙/ =/ r/ ×/ (/ 狇/ ,/ 1/ ,/ w1/ ,/ r2/ ,/ …/ ,/ wk/ -/ 3/ ,/ rk/ -/ 2/ ,/ 1/ ,/ wk/ -/ 2/ ,/ -/ (/ ∑/ k/ // 2/ -/ 1/ -/ (/ ∑/ k/ // 2/ -/ 1/ 其中/ r/ 和/ ri/ 都/ 是/ 随机/ 实数/ ,/ 它们/ 在/ 每个/ 字符串/ 中/ 的/ 取值/ 都/ 是/ 随机/ 的/ ./ 根据/ 矩阵/ 和/ 向量/ 运算/ 的/ 规则/ ,/ 如式/ (/ 21/ )/ 所示/ ,/ 犕/ ×/ (/ 狏/ )/ T/ =/ a11a12/ 结果/ 向量/ 的/ 每个/ 元素/ 是/ 由/ 作为/ 操作数/ 的/ 矩阵/ 和/ 向量/ 的/ 多个/ 元素/ 共同/ 决定/ 的/ ,/ 并且/ 都/ 受/ 随机数/ r/ 的/ 影响/ ,/ 这/ 就/ 保证/ 了/ 同一/ 字符串/ 在/ 相同/ 的/ 密钥/ 下/ 加密/ 多次/ 会/ 产生/ 不同/ 的/ 值/ ./ 再/ 根据/ 定理/ 1/ 可知/ ,/ CESVMC/ 是/ 距离/ 不可/ 恢复/ 的/ ./ 由于/ CESVMC/ 的/ 值域/ 为/ 实数/ 域/ R/ ,/ 设/ |/ R/ |/ 表示/ R/ 中/ 的/ 元素/ 个数/ ,/ 所以/ A/ 的/ 优势/ 概率/ 为/ 因此/ ,/ A/ 的/ 优势/ 概率/ 是/ 可/ 忽略/ 的/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ./ (/ 2/ )/ 当/ 适应性/ 选择/ 密文/ 攻击者/ 获得/ 了/ 检索/ 参数/ 的/ 加密/ Oracle/ 后/ ,/ CESVMC/ 是/ 不/ 安全/ 的/ ./ 假设/ 数据库/ 中有/ t/ 个/ 数据/ {/ np1/ ,/ np2/ ,/ …/ ,/ npt/ }/ 对应/ 的/ 密文/ {/ 犘/ 1/ ,/ 犘/ 2/ ,/ …/ ,/ 犘/ t/ }/ ,/ 攻击者/ A/ 可以/ 通过/ 以下/ 步骤/ 展开/ 攻击/ :/ ①/ A/ 首先/ 选取/ 一个/ 极小/ 的/ 检索/ 参数/ nq0/ ,/ 例如/ 由/ 一个/ 空格/ 组成/ 的/ 字符串/ ,/ 通过/ 检索/ 参数/ 加密/ Oracle/ 后/ 得到/ 对应/ 的/ 密文/ Q0/ ./ 根据/ 4.2/ ./ 1.4/ 节/ 可知/ ,/ A/ 可/ 做/ 如下/ 运算/ :/ Q0/ ×/ 犘/ i/ -/ Q0/ ×/ 犘/ j/ =/ d2/ (/ 狆/ j/ ,/ 狇/ 0/ )/ -/ d2/ (/ 狆/ i/ ,/ 狇/ 0/ )/ >/ 0/ / |/ npi/ -/ nq0/ |/ </ |/ npj/ -/ nq0/ |/ 从而/ 对/ {/ np1/ ,/ np2/ ,/ …/ ,/ npt/ }/ 进行/ 排序/ ,/ 相似/ 度由大到/ 小/ 排序/ 的/ 结果/ 为/ {/ np1/ ,/ np2/ ,/ …/ ,/ npt/ }/ ./ 由于/ nq0/ 足够/ 小/ ,/ 所以/ {/ np1/ ,/ np2/ ,/ …/ ,/ npt/ }/ 反映/ 了/ 数据/ {/ np1/ ,/ np2/ ,/ …/ ,/ npt/ }/ 的/ 大小/ 关系/ ;/ ②/ A/ 重复/ 步/ ①/ k/ 次/ ,/ 选择/ 的/ k/ 个/ 检索/ 参数/ {/ nq1/ ,/ nq2/ ,/ …/ ,/ nqk/ }/ 满足/ nqi/ </ nqj/ (/ i/ ∈/ [/ 0/ ,/ k/ -/ 1/ ]/ ,/ j/ ∈/ [/ 1/ ,/ k/ ]/ ,/ i/ </ j/ )/ ,/ 可以/ 猜测出/ 密文/ 犘/ 对应/ 的/ 明文/ 值/ ,/ 原理/ 如下/ :/ 因为/ dis/ =/ 犙/ ×/ 犘/ =/ 狆/ ×/ 狇/ -/ 0.5/ ×/ ‖/ p/ ‖/ 2/ ,/ dis/ 的/ 值/ 随着/ nq/ 逐渐/ 靠近/ np/ 逐渐/ 变小/ ;/ 当/ nq/ =/ np/ 时/ ,/ dis/ 最小/ ;/ 当/ nq/ 逐渐/ 远离/ np/ 变大时/ ,/ dis/ 的/ 值/ 又/ 逐渐/ 变/ 大/ ;/ 又/ 因为/ k/ 个/ 检索/ 参数/ {/ nq1/ ,/ nq2/ ,/ …/ ,/ nqk/ }/ 满足/ nqi/ </ nqj/ 所以/ A/ 可以/ 通过/ 逐渐/ 逼近/ 的/ 方法/ 获得/ 密文/ np/ 对应/ 的/ 明文/ ./ 故当/ A/ 获得/ 检索/ 参数/ 加密/ Oracle/ 情况/ 下/ ,/ CESVMC/ 是/ 不/ 安全/ 的/ ./ 定理/ 3/ ./ 从/ 数值数据/ 的/ 加解密/ 和/ 算术/ 运算/ 的/ 角度/ ,/ 当/ 加法/ 因子/ 的/ 个数/ da/ >/ 3/ 时/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ./ 证明/ ./ (/ 1/ )/ 一个/ 适应性/ 选择/ 密文/ 攻击者/ A/ 使用/ CESVMC/ 的/ 外包/ 数据/ 加密/ 和/ 解密/ Oracle/ 获得/ 了/ t/ (/ t/ ∈/ N/ )/ 对明/ 密文/ 对/ ,/ 假设/ CESVMC/ 使用/ d/ (/ d/ ∈/ N/ ,/ d/ =/ n/ +/ k/ ,/ n/ 表示/ 计算/ 元素/ 个数/ ,/ k/ 表示/ 随机/ 元素/ 个数/ )/ 维/ 向量/ 和/ d/ ×/ d/ 矩阵/ ,/ 根据/ 4.2/ ./ 2/ 节/ 可知/ ,/ 方程/ 等/ 号/ 两边/ 的/ 未知数/ 个数/ 的/ 关系/ 为/ d/ ×/ d/ +/ t/ ×/ (/ da/ +/ (/ n/ -/ 2/ )/ +/ k/ -/ 1/ )/ ×/ d/ >/ t/ ×/ d/ / (/ d/ +/ da/ -/ 3/ )/ >/ d/ / da/ >/ 3/ ./ 所以/ ,/ 当/ da/ >/ 3/ ,/ CESVMC/ 的/ 矩阵/ 方程组/ 是/ 不可/ 解/ 的/ ./ (/ 2/ )/ A/ 发起/ 以下/ 攻击/ :/ ①/ A/ 选择/ 一些/ 明/ // 密文/ 向/ CESVMC/ 进行/ 加/ // 解密/ 询问/ ,/ CESVMC/ 将加/ // 解密/ 的/ 结果/ 返回/ 给/ A/ ;/ ②/ A/ 选择/ 两个/ 数据/ m0/ ,/ m1/ 发给/ CESVMC/ ,/ CESVMC/ 随机/ 加密/ 其中/ 一条/ 消息/ mb/ (/ b/ ∈/ {/ 0/ ,/ 1/ }/ )/ ,/ 并/ 将/ 产生/ 的/ 密文/ c/ 返回/ 给/ A/ ;/ ③/ A/ 继续/ 选择/ 一些/ 明/ // 密文/ 向/ CESVMC/ 进行/ 加/ // 解密/ 询问/ ,/ 唯一/ 的/ 限制/ 就是/ 不能/ 要求/ 解密/ c/ ,/ CESVMC/ 将加/ // 解密/ 的/ 结果/ 返回/ 给/ A/ ,/ 这时/ A/ 一共/ 得到/ t/ 组明/ // 密文/ 对/ {/ (/ m1/ ,/ 犘/ 1/ )/ ,/ (/ m2/ ,/ 犘/ 2/ )/ ,/ …/ ,/ (/ mt/ ,/ 犘/ t/ )/ }/ ;/ ④/ A/ 输出/ b/ 作为/ 对/ b/ 的/ 猜测/ ./ 根据/ 4.2/ ./ 2.1/ 节/ ,/ 对于/ 数值数据/ np/ ,/ 其/ 对应/ 的/ 密文/ 为/ 犘/ =/ 犕/ ×/ (/ ar1/ +/ cr1/ ,/ ar2/ +/ cr2/ ,/ …/ ,/ arda/ +/ crda/ ,/ mr1/ ,/ mr2/ ,/ …/ ,/ mrdm/ ,/ r1/ ,/ …/ ,/ rk/ -/ 1/ ,/ -/ ∑/ da/ 其中/ 除/ arda/ 、/ mrdm/ 和/ -/ ∑/ da/ 们/ 在/ 每个/ 数值数据/ 中/ 的/ 取值/ 都/ 是/ 随机/ 的/ ./ 根据/ 矩阵/ 和/ 向量/ 运算/ 的/ 规则/ ,/ 如式/ (/ 21/ )/ 所示/ ,/ 结果/ 向量/ 的/ 每个/ 元素/ 是/ 由/ 作为/ 操作数/ 的/ 矩阵/ 和/ 向量/ 的/ 多个/ 元素/ 共同/ 决定/ 的/ ,/ 并且/ 都/ 受/ 随机数/ 的/ 影响/ ,/ 这/ 就/ 保证/ 了/ 同一/ 数值/ 在/ 相同/ 的/ 密钥/ 下/ 加密/ 多次/ 会/ 产生/ 不同/ 的/ 值/ ./ 由于/ CESVMC/ 的/ 值域/ 为/ 实数/ 域/ R/ ,/ 设/ |/ R/ |/ 表示/ R/ 中/ 的/ 元/ Page10/ 素/ 个数/ ,/ 所以/ A/ 的/ 优势/ 概率/ 为/ 因此/ ,/ 当/ da/ >/ 3/ 时/ ,/ A/ 的/ 优势/ 概率/ 是/ 可/ 忽略/ 的/ ./ (/ 3/ )/ 在/ 进行/ 算术/ 运算/ 时/ ,/ 根据/ 4.2/ ./ 2.2/ 节至/ 4.2/ ./ 2.5/ 节易/ 见/ ,/ 运算/ 过程/ 并/ 没有/ 破坏/ 密文/ 数据/ 的/ 不确定性/ ,/ 在/ 没有/ 密钥/ 的/ 情况/ 下/ ,/ A/ 的/ 优势/ 概率/ 如/ (/ 2/ )/ ./ 综合/ (/ 1/ )/ ,/ (/ 2/ )/ 和/ (/ 3/ )/ 可知/ ,/ 当/ 加法/ 因子/ 的/ 个数/ da/ >/ 3/ 时/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ./ 证毕/ ./ 6CESVMC/ 的/ 性能/ 本节/ 将/ 通过/ 对/ CESVMC/ 和/ 已有/ 的/ 方案/ 进行/ 比图/ 2CESVMC/ (/ d/ =/ 10/ )/ 与/ OPES/ (/ b1/ =/ 6/ ,/ b2/ =/ 4/ )/ 的/ 性能/ 对比/ 根据/ 图/ 2/ (/ a/ )/ ,/ 当/ len/ / 500/ 时/ ,/ CESVMC/ 的/ 数据/ 加密/ 时间/ 比/ OPES/ 少/ ,/ 当/ len/ >/ 500/ 后/ ,/ CESVMC/ 的/ 加密/ 时间/ 比/ OPES/ 多/ ,/ 且/ 随着/ len/ 增加/ ,/ 二者/ 的/ 差距/ 缓慢/ 变/ 大/ ;/ CESVMC/ 的/ 解密/ 时间/ 和/ 检索/ 参数/ 加密/ 时间/ 始终/ 比/ OPES/ 小/ ,/ 且/ 随着/ len/ 的/ 增加/ ,/ 差距/ 显著/ 增加/ ./ 根据/ 图/ 2/ (/ b/ )/ 和/ 2/ (/ c/ )/ ,/ CESVMC/ 的/ 检索/ 时间/ 和/ 存储/ // 通信/ 负载/ 明显/ 比/ OPES/ 大/ ./ 本节/ 所说/ 的/ 检索/ 时间/ 都/ 是/ 指/ 进行/ 一次/ 比较/ 操作/ 所花/ 的/ 时间/ ,/ 而/ 真正/ 的/ 检索/ 时间/ 应/ 与/ 数据库/ 中/ 的/ 记录/ 数/ 有关/ ./ 实验/ 2/ 评估/ 了/ CESVMC/ 在/ 向量/ 维度/ d/ 取/ 不同/ 值/ 的/ 情况/ 下/ 对/ 长度/ len/ =/ 200/ 的/ 字符串/ 加解密/ 和/ 检索/ 的/ 性能/ ,/ 结果/ 如图/ 3/ 所示/ ./ 根据/ 图/ 3/ (/ a/ )/ 和/ 3/ (/ b/ )/ ,/ CESVMC/ 的/ 加解密/ 时间/ 、/ 检索/ 时间/ 和/ 存储/ // 通信/ 负载/ 随着/ d/ 的/ 增加/ 而/ 增加/ ,/ 其中/ 加解密/ 时间/ 受/ d/ 的/ 影响/ 最大/ ./ 其/ 原因/ 是/ ,/ 加解密/ 的/ 计算/ 复杂度/ 为/ O/ (/ d2/ )/ ,/ 检索/ 的/ 复杂度/ 为/ O/ (/ d/ )/ ,/ 存储/ // 通信/ 复杂度/ 为/ O/ (/ d/ )/ ./ 较/ ,/ 从而/ 评估/ CESVMC/ 的/ 性能/ ./ 对比/ 方案/ 包括/ 基于/ OPES/ [/ 12/ ]/ 的/ 加密/ 字符串/ 模糊/ 检索/ 方案/ ,/ 支持/ 乘法/ 同态/ 的/ unpadded/ _/ RSA/ 和/ 支持/ 加法/ 同态/ 的/ Paillier/ ./ 性能指标/ 包括/ 加解密/ 性能/ 、/ 计算/ (/ 检索/ 和/ 算术/ 运算/ )/ 性能/ 以及/ 存储/ // 通信/ 负载/ 等/ ./ 实验/ 部署/ 在/ 由/ 本/ 研究/ 小组/ 自行/ 研发/ 的/ 青云/ 实验/ 平台/ 3.0/ 上/ ./ 该/ 平台/ 是/ 一个/ 基于/ Web/ 的/ 面向/ 校园/ 的/ 云/ 计算环境/ ,/ 以/ KVM/ 和/ Ha/ -/ doop/ 的/ HDFS/ 为/ 底层/ 支撑/ 技术/ ,/ 并/ 部署/ 在/ 由/ 10/ 台/ 服务器/ 构成/ 的/ 集群/ 上/ ./ 6.1/ 字符串/ 实验/ 1/ 对/ 不同/ 长度/ (/ len/ )/ 的/ 字符串/ 进行/ 了/ 加解密/ 、/ 检索/ 操作/ ,/ 其中/ CESVMC/ 的/ 向量/ 维度/ d/ =/ 10/ ,/ OPES/ 的/ 输入/ 分布/ 桶/ 数/ 和/ 输出/ 分布/ 桶/ 数/ 分别/ 为/ b1/ =/ 6/ 和/ b2/ =/ 4/ ,/ 结果/ 如图/ 2/ 所示/ ./ 6.2/ 数值数据/ 实验/ 3/ 比较/ 了/ CESVMC/ 与/ unpadded/ _/ RSA/ 、/ Paillier/ 在/ 加解密/ 、/ 计算/ 以及/ 存储/ // 通信/ 负载/ 三/ 方面/ Page11/ 的/ 性能/ ,/ 其中/ ,/ unpadded/ _/ RSA/ 和/ Paillier/ 均/ 采用/ 两个/ 7/ 位/ 素数/ 作为/ 密钥/ ,/ 结果/ 如表/ 1/ 所示/ ./ 其中/ “/ SP/ ”/ 表示/ 服务提供者/ ,/ “/ 加法/ _/ SP/ ”/ 表示/ 由/ 服务提供者/ 承表/ 1CESVMC/ 对/ 数值数据/ 加解密/ 和/ 计算/ 性能/ unpadded/ _/ RSA/ 两个/ 7/ 位/ 素数/ Paillier/ 两个/ 7/ 位/ 素数/ CESVMC/ 向量/ 根据/ 表/ 1/ ,/ (/ 1/ )/ 当/ d/ / 10/ 时/ ,/ CESVMC/ 的/ 加解密/ 时间/ 小于/ Paillier/ ,/ 大于/ unpadded/ _/ RSA/ ;/ CESVMC/ 的/ 存储/ // 通信/ 负载/ 始终/ 大于/ Paillier/ 和/ unpadded/ _/ RSA/ ;/ 加解密/ 的/ 计算/ 复杂度/ 为/ O/ (/ d2/ )/ ,/ 存储/ // 通信/ 复杂度/ 为/ O/ (/ d/ )/ ./ (/ 2/ )/ CESVMC/ 的/ 加减法/ 运算/ 的/ 时间/ 几乎/ 一样/ ,/ 当/ d/ / 100/ 时/ ,/ CESVMC/ 的/ 加减法/ 运算/ 时间/ 远/ 小于/ Paillier/ ,/ 但是/ 由于/ CESVMC/ 在/ 进行/ 加减法/ 运算/ 时/ 的/ 计算/ 复杂度/ 为/ O/ (/ d/ )/ ,/ 所以/ ,/ 当/ d/ 达到/ 一定/ 值/ 的/ 时候/ 会/ 超过/ Paillier/ ;/ (/ 3/ )/ CESVMC/ 的/ 加减法/ 运算/ 结果/ 的/ 解密/ 时间/ 几乎/ 一样/ ,/ 当/ d/ </ 80/ 时/ ,/ 其值/ 小于/ Paillier/ ;/ 加减法/ 运算/ 结果/ 的/ 解密/ 复杂度/ 为/ O/ (/ d2/ )/ ./ (/ 4/ )/ CESVMC/ 的/ 乘除/ 法/ 运算/ 的/ 时间/ 几乎/ 一样/ ,/ 且/ 远大于/ unpadded/ _/ RSA/ ,/ 其/ 计算/ 复杂度/ 为/ O/ (/ d2/ )/ ./ (/ 5/ )/ CESVMC/ 的/ 乘除/ 法/ 运算/ 结果/ 的/ 解密/ 时间/ 也/ 几乎/ 是/ 一样/ 的/ ,/ 且/ 均/ 大于/ unpadded/ _/ RSA/ ,/ 其/ 计算/ 复杂度/ 为/ O/ (/ d3/ )/ ./ 总的说来/ ,/ CESVMC/ 具有/ 以下/ 特点/ :/ (/ 1/ )/ 加解密/ 性能/ 很/ 好/ ;/ (/ 2/ )/ 加减法/ 效率/ 很/ 高/ ,/ 但/ 字符串/ 模糊/ 检索/ 和/ 乘除/ 法/ 运算/ 的/ 时间/ 相对/ 较长/ ;/ (/ 3/ )/ 加减法/ 运算/ 结果/ 的/ 解密/ 时间/ 适中/ ,/ 但/ 乘除/ 法/ 运算/ 结果/ 的/ 解密/ 时间/ 较长/ ;/ (/ 4/ )/ 存储/ // 通信/ 负载/ 较大/ ;/ (/ 5/ )/ 各/ 性能指标/ 的/ 值/ 随着/ 维度/ 的/ 增加/ 而/ 增加/ ./ 7/ 结束语/ 针对/ 云/ 计算/ 中/ 的/ 隐私/ 保护/ 问题/ ,/ 本文/ 提出/ 了/ 支持/ 隐私/ 保护/ 的/ 云/ 计算/ 模型/ ,/ 并/ 设计/ 了/ 一种/ 支持/ 隐私/ 保护/ 的/ 可/ 计算/ 加密/ 方案/ CESVMC/ ./ CESVMC/ 支持/ 加密/ 字符串/ 的/ 模糊/ 检索/ 和/ 加密/ 数值数据/ 的/ 加/ 、/ 减/ 、/ 乘/ 、/ 除/ 四种/ 算术/ 运算/ ./ 通过/ 安全/ 分析/ 证明/ :/ 对于/ 字符串/ ,/ 当/ 攻击者/ 只/ 获得/ 外/ 包/ 数据/ 的/ 加密/ 和/ 解密/ Oracle/ 担/ 的/ 加法/ 操作/ 的/ 计算/ 时间/ ;/ “/ U/ ”/ 表示/ 用户/ ,/ “/ 加法/ _/ U/ ”/ 表示/ 用户/ 对/ 服务提供者/ 返回/ 的/ 加法/ 运算/ 结果/ 进行/ 解密/ 的/ 计算/ 时间/ ,/ 其它/ 表示/ 与/ 此/ 类似/ ./ 指标/ // ms/ 的/ 情况/ 下/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ;/ 对于/ 数值数据/ ,/ 当/ 加法/ 因子/ 的/ 个数/ 大于/ 3/ 时/ ,/ CESVMC/ 是/ IND/ -/ CCA/ 安全/ 的/ ./ 同时/ ,/ 性能/ 评估/ 证实/ CESVMC/ 具有/ 很/ 好/ 的/ 加解密/ 性能/ ,/ 能/ 高效/ 地/ 实现/ 加减法/ 运算/ ,/ 但/ 字符串/ 模糊/ 检索/ 和/ 乘除/ 法/ 运算/ 的/ 计算/ 时间/ 稍长/ ,/ 存储/ // 通信/ 负载/ 较大/ ,/ 各/ 性能指标/ 的/ 值/ 随着/ 维度/ 的/ 增加/ 而/ 增加/ ./ 下/ 一步/ ,/ 我们/ 将/ 改进/ 方案/ 中/ 乘除/ 法/ 运算/ 的/ 性能/ ,/ 使/ 之/ 支持/ 多次/ 乘/ // 除法/ 运算/ ,/ 同时/ 减少/ 存储/ // 通信/ 负载/ ,/ 并/ 进一步/ 研究/ 数值数据/ 排序/ 问题/ ./ 我们/ 也/ 计划/ 研究/ 新/ 的/ 加密技术/ 来/ 实现/ 安全/ 的/ 密文/ 计算/ ./ 

