Page1/ 自/ 适应/ 代理/ 粒子/ 的/ 非线性/ 有限元/ 与/ 不可/ 压缩/ 流体/ 实时/ 耦合/ 袁志勇/ 廖/ 祥云/ 郭甲翔/ 童倩倩/ 郑棉仑/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 摘要/ 该文/ 提出/ 了/ 利用/ 生成/ 自/ 适应/ 代理/ 粒子/ 来/ 实时/ 耦合/ TLED/ 非线性/ 有限元/ 与/ 隐式/ 不可/ 压缩/ 流体/ 的/ 新/ 方法/ ./ 首先/ ,/ 该文/ 根据/ 固体/ 表面/ 的/ 局部/ 高斯曲率/ 对/ 固体/ 表面/ 采样/ 生成/ 不同/ 分辨率/ 的/ 代理/ 粒子/ ./ 其次/ ,/ 为了/ 避免/ 代理/ 粒子/ 和/ 流体/ 粒子/ 间/ 过早/ 的/ 耦合/ ,/ 文中/ 设计/ 代理/ 粒子/ 光滑/ 核/ 函数/ 的/ 支持/ 域/ 为/ 椭球/ 型/ ./ 其次/ ,/ 为了/ 防止/ 流体/ 粒子/ 在/ 固体/ 发生/ 形变/ 时/ 产生/ 穿透/ 现象/ ,/ 作者/ 在/ 每个/ 时间/ 步长/ 内/ 对/ 固体/ 表面/ 进行/ 重/ 采样/ 生成/ 代理/ 粒子/ ,/ 并/ 自/ 适应/ 地/ 改变/ 其/ 支持/ 域/ 的/ 大小/ ,/ 最后/ ,/ 在/ 处理/ 边界/ 时/ 运用/ 正则/ 化/ 方法/ 计算/ 边界/ 处/ 粒子/ 的/ 物理量/ ,/ 并/ 利用/ 基于/ 统一/ 计算/ 设备/ 架构/ 的/ GPU/ 并行计算/ 方法/ 对/ 耦合/ 过程/ 进行/ 加速/ ./ 实验/ 结果表明/ ,/ 该文/ 提出/ 的/ 方法/ 能/ 在/ 减少/ 采样/ 粒子/ 、/ 提高/ 计算/ 效率/ 的/ 同时/ ,/ 实现/ 实时/ 逼真/ 的/ 流固/ 耦合/ 效果/ ./ 关键词/ 自/ 适应/ 代理/ 粒子/ ;/ 流固/ 耦合/ ;/ 非线性/ 有限元/ ;/ 不可/ 压缩/ 流体/ ;/ GPU/ 加速/ 1/ 引言/ 随着/ 计算机/ 仿真/ 和/ 虚拟现实/ 技术/ 的/ 快速/ 发展/ ,/ 近年来/ 基于/ 物理/ 的/ 流固/ 耦合/ 仿真/ 及其/ 相关/ 应用/ 已经/ 成为/ 一个/ 重要/ 的/ 研究/ 方向/ ./ 它/ 在/ 计算机/ 动画/ 、/ 游戏/ 开发/ 和/ 工业/ 设计/ 等/ 领域/ 具有/ 巨大/ 的/ 应用/ 价值/ ./ 流固/ 耦合/ 涉及/ 流体/ 和/ 固体/ 之间/ 的/ 许多/ 复杂/ 交互/ ,/ 包括/ 边界/ 处理/ 、/ 耦合/ 力/ 计算/ 和/ 耦合/ 响应/ 等/ 方面/ ./ 近年来/ ,/ 研究/ 人员/ 提出/ 了/ 许多/ 基于/ 物理/ 的/ 流固/ 耦合/ 仿真/ 方法/ ./ 这些/ 方法/ 通常/ 可/ 分为/ 网格法/ 和/ 无/ 网格法/ ./ 网格法/ 适用/ 于/ 固体/ 的/ 建模/ ,/ 但/ 不适/ 用于/ 处理/ 流体/ 的/ 自由/ 表面/ 和/ 流固/ 耦合/ 中/ 边界/ 处/ 的/ 运动/ ,/ 然而/ 无/ 网格法/ 可以/ 有效/ 地/ 解决/ 这些/ 问题/ [/ 1/ ]/ ./ 光滑/ 粒子/ 流体/ 动力学/ (/ SmoothedParticleHydrodynamics/ ,/ SPH/ )/ [/ 2/ ]/ 是/ 近几年/ 应用/ 最/ 广泛/ 的/ 无/ 网格法/ ,/ 它/ 的/ 粒子/ 特性/ 使/ 其/ 天然/ 的/ 适合/ 于/ 流体/ 的/ 建模/ 仿真/ ①/ ./ 但是/ SPH/ 方法/ 在/ 模拟/ 流体/ 时/ 不能/ 保持/ 流体/ 的/ 不/ 可压缩性/ ,/ 导致/ 仿真/ 场景/ 中/ 部分/ 流体/ 效果/ 失真/ ,/ 如何/ 使/ SPH/ 方法/ 具备/ 不/ 可压缩性/ 对于/ 提升/ 仿真/ 场景/ 的/ 视觉效果/ 具有/ 重要/ 意义/ [/ 3/ ]/ ./ 因此/ ,/ 为了/ 获得/ 逼真/ 的/ 流体/ 视觉效果/ ,/ 本文/ 采用/ 隐式/ 不可/ 压缩/ 光滑/ 粒子/ 流体/ 动力学/ (/ ImplicitIncompressibleSmoothedParticleHydrodynamics/ ,/ IISPH/ )/ [/ 3/ ]/ 建立/ 不可/ 压缩/ 流体/ 模型/ ./ 对/ 可/ 形变/ 固体/ 而言/ ,/ 非线性/ 有限元/ 能够/ 较/ 好/ 的/ 模拟/ 变形/ 仿真/ 的/ 效果/ ,/ 本文/ 运用/ 完全/ 拉格朗/ 日/ 显式/ 动力学/ (/ TotalLagrangianExplicitDynamics/ ,/ TLED/ )/ 有限元/ 方法/ [/ 4/ ]/ 建立/ 非线性/ 有限元/ 固体/ 模型/ ./ 目前/ 研究/ 人员/ 提出/ 了/ 一些/ 最新/ 的/ 方法/ [/ 3/ -/ 8/ ]/ 用于/ 耦合/ 流体/ 与/ 复杂/ 的/ 固体/ 模型/ ,/ 例如/ 刚体/ 和/ 可/ 变形/ 固体/ ,/ 并/ 取得/ 了/ 较/ 好/ 的/ 效果/ ./ 通过/ 在/ 固体/ 表面/ 三角/ 网格/ 上/ 采样/ 代理/ 粒子/ 或/ 边界/ 粒子/ 用以/ 实现/ 固体/ 与/ 流体/ 的/ 耦合/ 是/ 最近/ 比较/ 流行/ 的/ 一种/ 方法/ ./ Akinci/ 等/ 人/ [/ 5/ ]/ 在/ 刚体/ 表面/ 采样/ 均匀分布/ 的/ 边界/ 粒子/ 与/ 流体/ 粒子/ 相互/ 耦合/ ,/ 所/ 采样/ 的/ 边界/ 粒子/ 被/ 用于/ 修改/ 边界/ 流体/ 的/ 密度/ 以及/ 计算/ 与/ 流体/ 粒子/ 间/ 的/ 双向/ 耦合/ 力/ ./ Akinci/ 等/ 人/ [/ 6/ ]/ 进一步/ 扩展/ 他们/ 的/ 方法/ 并/ 将/ 其/ 用于/ 弹性/ 固体/ 与/ 流体/ 的/ 耦合/ ,/ 提出/ 了/ 在/ 弹性/ 固体/ 形变/ 后/ 采样/ 均匀分布/ 的/ 边界/ 粒子/ 和/ 重/ 采样/ 边界/ 粒子/ 的/ 方法/ ,/ 并/ 取得/ 了/ 不错/ 的/ 流体/ 与/ 可/ 形变/ 固/ 耦合/ 效果/ ./ 但是/ ,/ 他们/ 的/ 方法/ 在/ 每个/ 步长/ 都/ 对/ 固体/ 表面/ 所有/ 三角/ 面片/ 以/ 同样/ 分辨率/ 进行/ 无差别/ 采样/ ,/ 这样/ 对于/ 复杂/ 仿真/ 场景/ 或/ 较大/ 的/ 固体/ 模型/ 而言/ 会/ 导致/ 采样/ 粒子/ 数量/ 过大/ ,/ 从而/ 增加/ 计算/ 负担/ ./ 实际上/ ,/ 在/ 几何/ 复杂/ 区域/ (/ 如尖/ 、/ 角/ 、/ 弯曲/ 的/ 区域/ )/ 粒子/ 间/ 耦合/ 过程/ 的/ 情况/ 差异/ 较大/ ,/ 而/ 在/ 几何/ 简单/ 区域/ (/ 如/ 平滑/ 区域/ )/ 粒子/ 间/ 耦合/ 情况/ 差异/ 较/ 小/ ./ 如果/ 能够/ 根据/ 固体/ 表面/ 的/ 几何/ 特点/ 自/ 适应/ 地/ 对/ 几何/ 复杂/ 区域/ 以较/ 高/ 的/ 分辨率/ 采样/ 代理/ 粒子/ ,/ 而/ 对/ 几何/ 简单/ 区域/ 以较/ 低/ 的/ 分辨率/ 采样/ 代理/ 粒子/ ,/ 通过/ 调整/ 代理/ 粒子/ 的/ 属性/ 以/ 满足/ 流体/ 与/ 固体/ 耦合/ 过程/ 的/ 准确性/ 要求/ ,/ 那么/ 将/ 能/ 减少/ 代理/ 粒子/ 的/ 数量/ ,/ 进而/ 提高/ 整体/ 的/ 计算/ 效率/ ./ 本文/ 针对/ 非线性/ 有限元/ 固体/ 与/ 不可/ 压缩/ 流体/ 的/ 耦合/ ,/ 提出/ 了/ 一种/ 在/ 可/ 形变/ 固体/ 表面/ 自/ 适应/ 采样/ 代理/ 粒子/ 的/ 方法/ ,/ 按照/ 固体/ 表面/ 局部/ 高斯曲率/ 采样/ 生成/ 不同/ 分辨率/ 的/ 代理/ 粒子/ ,/ 并/ 设计/ 其/ 支持/ 域/ 为/ 椭球/ 型/ 用于/ 避免/ 过早/ 发生/ 耦合/ ./ 在/ 固体/ 产生/ 形变/ 时/ ,/ 重/ 采样/ 代理/ 粒子/ 并/ 调整/ 代理/ 粒子/ 的/ 支持/ 域/ 大小/ 以/ 实现/ 更加/ 精确/ 的/ 耦合/ 计算/ ,/ 在/ 处理/ 边界/ 时/ 采用/ 正则/ 化/ 方法/ 计算/ 边界/ 处/ 粒子/ 的/ 物理量/ ,/ 并/ 采样/ 基于/ 统一/ 计算/ 设备/ 架构/ (/ ComputeUnifiedDeviceArchitecture/ ,/ CUDA/ )/ 的/ GPU/ 并行计算/ 方法/ 对/ 耦合/ 过程/ 进行/ 加速/ ./ 本文/ 在/ 减少/ 采样/ 粒子/ 、/ 提高/ 计算/ 效率/ 的/ 同时/ 实现/ 了/ 实时/ 逼真/ 的/ 流固/ 耦合/ 效果/ ./ 2/ 相关/ 工作/ 基于/ 物理/ 的/ 流体/ 仿真/ 在/ 计算机/ 动画/ 、/ 游戏/ 开发/ 和/ 工业/ 设计/ 等/ 领域/ 有着/ 广泛/ 的/ 应用/ ./ 采用/ SPH/ 方法/ 离散/ 化/ Navier/ -/ Stokes/ 方程/ 是/ 近年来/ 用于/ 流体/ 仿真/ 最/ 常用/ 的/ 方法/ ,/ 并/ 已/ 成功/ 地/ 运用/ 于/ 各种/ 流体/ 仿真/ 应用/ 中/ [/ 8/ -/ 12/ ]/ ./ M/ ü/ ller/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 基于/ SPH/ 的/ 交互式/ 流体/ 和/ 自由/ 表面/ 仿真/ 的/ 方法/ ,/ 他们/ 直接/ 从/ Navier/ -/ Stokes/ 方程/ 中/ 推导/ 出/ 流体/ 的/ 密度/ ,/ 通过/ 添加/ 表面张力/ 项来/ 仿真/ 表面张力/ ,/ 而/ 无需/ 使用/ 质量守恒/ 方程/ 和/ 对流/ 项/ ,/ 从而/ 降低/ 了/ 仿真/ 的/ 复杂性/ ./ 常元章/ 等/ 人/ [/ 14/ ]/ 基于/ SPH/ 方法/ ,/ 通过/ 对/ 传统/ Navier/ -/ Stokes/ 方程/ 添加/ 弹性/ 应力/ 项/ ,/ 提出/ 了/ 一种/ 新/ 的/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 方法/ ,/ 该/ 方法/ 具有/ 良好/ 的/ 可控性/ ,/ 仅仅/ 通过/ 调节/ 参数/ 就/ 可以/ 模拟/ 不同/ 粘弹性/ 、/ 不同/ 类型/ 的/ 流体/ ./ Macklin/ 等/ 人/ [/ 15/ ]/ 提出/ 了/ 一个/ 统一/ 粒子/ 框架/ ,/ 采用/ 粒子/ 对/ 流体/ 、/ 弹性体/ 和/ 刚体/ 建模/ ,/ 并/ 使用/ 了/ GPU/ 并行计算/ 以/ 获得/ 实时/ 的/ 仿真/ ./ 最近/ ,/ 流体/ 仿真/ ①/ http/ :/ // // www/ ./ matmidia/ ./ mat/ ./ puc/ -/ rio/ ./ br/ // ~/ tomlew/ // pdfs/ // lucas/ _/ wuw/ ./ pdfPage3/ 的/ 研究/ 工作/ 集中/ 在/ 不可/ 压缩/ 流体/ 的/ 仿真/ 上/ [/ 3/ ,/ 8/ ,/ 16/ -/ 18/ ]/ ./ Becker/ 和/ Teschner/ [/ 19/ ]/ 提出/ 了/ 一种/ 弱/ 压缩性/ SPH/ 方法/ (/ WeaklyCompressibleformofSPH/ ,/ WCSPH/ )/ 来/ 仿真/ 体积/ 守恒/ 的/ 低/ 粘性流体/ ./ Solenthaler/ 和/ Pajarola/ [/ 20/ ]/ 提出/ 了/ 预测/ 修正/ 不可/ 压缩/ SPH/ (/ Predictive/ -/ CorrectiveIncompressibleSPH/ ,/ PCISPH/ )/ 方法/ ,/ 采用/ 预测/ 修正/ 的/ 方案/ 来/ 确定/ 粒子/ 的/ 压力/ ,/ 相比/ WCSPH/ 方法/ ,/ 该/ 方法/ 使用/ 更少/ 的/ 时间/ 便/ 可/ 获得/ 相同/ 的/ 流体/ 仿真/ 效果/ ./ Ihmsen/ 等/ 人/ [/ 3/ ]/ 提出/ 了/ 隐式/ 不可/ 压缩/ SPH/ (/ ImplicitIncompressibleSPH/ ,/ IISPH/ )/ 方法/ ,/ 通过/ 结合/ 对称/ 的/ SPH/ 压力/ 和/ SPH/ 离散/ 化/ 的/ 连续性/ 方程/ 获得/ 压力/ 泊松/ 方程/ 的/ 离散/ 形式/ ,/ 并且/ 可以/ 基于/ 速度/ 计算/ 密度/ 的/ 偏差/ ./ Cornelis/ 等/ 人/ [/ 8/ ]/ 提出/ 了/ IISPH/ -/ FLIP/ (/ Fluid/ -/ Implicit/ -/ Particle/ ,/ FLIP/ )/ 方法/ 来/ 仿真/ 不可/ 压缩/ 流体/ ,/ 该/ 组合/ 方法/ 能够/ 在/ 实现/ 质量守恒/ 的/ 条件/ 下以/ 较/ 少/ 的/ 内存/ 实现/ 不可/ 压缩/ 流体/ 的/ 仿真/ ./ 基于/ 物理/ 的/ 固体/ 形变/ 仿真/ 通常/ 采用/ 有限元/ 方法/ ,/ 因而/ 具有/ 较/ 高/ 的/ 准确性/ ,/ 但/ 有限元/ 方法/ 同时/ 具有/ 较大/ 的/ 计算/ 量/ ./ Miller/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ 完全/ 拉格朗/ 日/ 显式/ 动力学/ (/ TotalLagrangianExplicitDynamics/ ,/ TLED/ )/ 有限元/ 方法/ ,/ 能够/ 快速/ 有效/ 地/ 对/ 非线性/ 有限元/ 弹性体/ 进行/ 建模/ 和/ 仿真/ ./ TLED/ 有限元/ 算法/ 是/ 在/ 单元/ 层次/ 上/ 进行/ 预计/ 算/ ,/ 可/ 避免/ 整体/ 刚度/ 矩阵/ 的/ 求解/ ,/ 并/ 支持/ 大规模/ 的/ 并行计算/ [/ 7/ ]/ ,/ Taylor/ 和/ Joldes/ 等/ 人/ [/ 21/ -/ 22/ ]/ 分别/ 在/ GPU/ 上/ 使用/ TLED/ 方法/ 实现/ 了/ 手术/ 仿真/ 中/ 的/ 实时/ 非线性/ 有限元/ 分析/ ./ 为了/ 解决/ 流固/ 耦合/ 问题/ ,/ Solenthaler/ 等/ 人/ [/ 23/ ]/ 将/ 流体/ 和/ 固体/ 都/ 采用/ 粒子/ 表示/ ,/ 采用/ SPH/ 邻域/ 搜索/ 来/ 计算/ 接触/ 表面/ 的/ 粒子/ 作用力/ ,/ 但/ 基于/ 粒子/ 的/ 线性/ 弹性/ 模型/ ,/ 当/ 形变/ 较大/ 时/ ,/ 其/ 精确性/ 和/ 稳定性/ 相比/ 非线性/ 有限元/ 模型/ 较差/ ./ Schechter/ 和/ Bridson/ [/ 24/ ]/ 在/ 流体/ 和/ 固体/ 粒子/ 表面/ 的/ 支持/ 域/ 内/ 设置/ 了/ 一层/ ghost/ 粒子/ ,/ 这样/ 既保证/ 了/ 固体/ 粒子/ 的/ 稳定性/ ,/ 又/ 防止/ 了/ 流体/ 粒子/ 和/ 固体/ 粒子/ 互相/ 穿透/ ./ Paiva/ 等/ 人/ [/ 25/ ]/ 将/ 流体/ 粒子/ 的/ 速度/ 分解/ 为/ 切向速度/ 和/ 法向/ 速度/ ,/ 在/ 耦合/ 过程/ 中/ 对/ 它们/ 分别/ 进行/ 处理/ ./ Ihmsen/ 等/ 人/ [/ 26/ ]/ 结合/ PCISPH/ 方法/ 提出/ 了/ 一种/ 用于/ 不可/ 压缩/ 流体/ 边界/ 处理/ 的/ 新/ 方案/ ,/ 其/ 允许/ 在/ 求解/ 过程/ 中/ 使用/ 更大/ 的/ 时间/ 步长/ ,/ 他们/ 还/ 提出/ 了/ 一种/ 能/ 独立/ 于/ 场景/ 且/ 自动/ 估计/ 合适/ 的/ 时间/ 步长/ 的/ 方法/ ,/ 使得/ 总/ 的/ 计算/ 时间/ 减少/ ./ Yang/ 等/ 人/ [/ 7/ ]/ 在/ 流体/ 粒子/ 与/ 固体/ 表面/ 网格/ 碰撞/ 处/ 生成/ 代理/ 粒子/ 来/ 与/ 流体/ 粒子/ 相互作用/ ,/ 并/ 计算/ 代理/ 粒子/ 的/ 位置/ 、/ 速度/ 、/ 质量/ 和/ 法/ 向量/ ./ Clausen/ 等/ 人/ [/ 27/ ]/ 描述/ 了/ 拉格朗/ 日/ 有限元/ 方法/ 在/ 统一/ 框架/ 下/ 仿真/ 流体/ 和/ 固体/ 的/ 行为/ ,/ 该/ 框架/ 可以/ 用/ 同一个/ 网格/ 模型/ 对/ 弹性体/ 、/ 塑性体/ 和/ 流体/ 进行/ 建模/ ./ Akinci/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 适用/ 于/ 单向/ 和/ 双向/ 流体/ 与/ 刚体/ 耦合/ 的/ 边界/ 处理/ 方法/ ,/ 在/ 刚体/ 表面/ 均匀/ 采样/ 边界/ 粒子/ ./ 该/ 方法/ 应用/ 到/ IISPH/ [/ 3/ ]/ 的/ 流固/ 耦合/ 的/ 应用/ 中/ ,/ 通过/ 进一步/ 扩展/ 被/ 用于/ 耦合/ 弹性/ 固体/ 与/ SPH/ 流体/ ,/ 并/ 在/ 弹性/ 固体/ 形变/ 后/ 对/ 其/ 进行/ 重/ 采样/ [/ 6/ ]/ ,/ 且/ 该/ 方法/ 被/ 用于/ Cornelis/ 等/ 人/ [/ 8/ ]/ 关于/ 流体/ 与/ 固体/ 耦合/ 的/ 工作/ 中/ ./ M/ ü/ ller/ 等/ 人/ [/ 28/ ]/ 基于/ 七点/ 规则/ 对/ 固体/ 表面/ 三角/ 面片/ 进行/ 采样/ ,/ 获得/ 了/ 较/ 好/ 的/ 流固/ 耦合/ 效果/ ./ Si/ 等/ 人/ [/ 29/ ]/ 以/ 每个/ 三角/ 面片/ 两边/ 上/ 的/ 单位向量/ 为/ 基对/ 三角/ 面片/ 采样/ ./ M/ ü/ ller/ 等/ 人/ [/ 30/ ]/ 提出/ 的/ positionbaseddynamics/ 对/ 粒子/ 的/ 位置/ 进行/ 强制/ 迭代/ 约束/ ,/ 来/ 满足/ 耦合/ 的/ 约束条件/ ,/ 以/ 防止/ 穿透/ 现象/ 的/ 发生/ ,/ 该/ 方法/ 具有/ 较/ 高/ 的/ 准确性/ ,/ 但是/ 由于/ 迭代/ 约束/ 的/ 存在/ 也/ 加大/ 了/ 整体/ 系统/ 的/ 计算/ 负担/ ./ Batty/ 等/ 人/ [/ 31/ ]/ 通过/ 提出/ 一种/ 新/ 的/ 变分法/ 在/ 相对/ 粗糙/ 的/ 笛卡尔/ 网格/ 上/ 实现/ 了/ 流体/ 与/ 不规则/ 几何/ 刚体/ 的/ 快速/ 、/ 鲁棒/ 、/ 精确/ 的/ 耦合/ 仿真/ ,/ 该/ 方法/ 将/ 刚体/ 的/ 边界条件/ 离散/ 化到/ 网格/ 中/ ,/ 并/ 按照/ 固体/ 表面/ 曲率/ 的/ 不同/ 分别/ 予以/ 计算/ ,/ 与/ SPH/ 流体/ 和/ 自/ 适应/ 采样/ 的/ 代理/ 粒子/ 的/ 耦合/ 方法/ 具有/ 较大/ 区别/ ./ He/ 等/ 人/ [/ 32/ ]/ 提出/ 了/ 一种/ 交错/ 的/ 无/ 网格/ 方法/ ,/ 在/ 每个/ 时间/ 步长/ 内/ 生成/ 一系列/ 的/ 交错/ 粒子/ 将/ 速度/ 场/ 从/ 压力/ 场中/ 分离/ ,/ 因此/ 能够/ 非常/ 方便/ 地/ 实现/ 自由/ 表面/ 流体/ 和/ 刚体/ 的/ 耦合/ ,/ 但/ 该/ 方法/ 不适/ 用于/ 流体/ 与/ 薄片/ 型/ 固体/ 的/ 耦合/ ,/ 且/ 仅/ 通过/ 惩罚/ 力来/ 防止/ 穿透/ 现象/ ,/ 未/ 对/ 流体/ 与/ 可/ 形变/ 固体/ 的/ 耦合/ 做/ 相关/ 工作/ ./ Adams/ 等/ 人/ [/ 33/ ]/ 根据/ 流体/ 粒子/ 距/ 流体/ 模型/ 中轴/ 的/ 距离/ 定义/ 其/ 局部/ 几何/ 特征值/ ,/ 并/ 基于/ 此/ 设定/ 采样/ 条件/ ,/ 对/ 流体/ 进行/ 自/ 适应/ 的/ 采样/ ,/ 减少/ 几何/ 特征/ 简单/ 区域/ (/ 如/ 液体/ 内部/ 、/ 靠近/ 厚/ 而/ 平坦/ 液体/ 表面/ 的/ 区域/ )/ 的/ 采样/ 粒子/ 数量/ ,/ 并/ 动态/ 地/ 对/ 液体/ 重/ 采样/ ,/ 将/ 计算资源/ 集中/ 到/ 几何/ 特征/ 复杂/ 区域/ 的/ 计算/ 上/ ,/ 但是/ 该/ 方法/ 会/ 降低/ 流体/ 的/ 仿真/ 精度/ ./ 3/ 不可/ 压缩/ 流体/ 和/ 非线性/ 有限元/ 固体/ 建模/ 为了/ 获得/ 逼真/ 的/ 流体/ 和/ 固体/ 形变/ 视觉效果/ ,/ 本文/ 采用/ 隐式/ 不可/ 压缩/ 光滑/ 粒子/ 流体/ 动力学/ (/ IISPH/ [/ 3/ ]/ )/ 建立/ 不可/ 压缩/ 流体/ 模型/ ,/ 采用/ 完全/ 拉格朗/ 日/ 显式/ 动力学/ TLED/ 有限元/ 算法/ [/ 4/ ]/ 建立/ 非线性/ 有限元/ 固体/ 模型/ ./ Page43/ ./ 1/ 不可/ 压缩/ 流体/ 建模/ SPH/ 方法/ 的/ 基本/ 思想/ 是/ 将/ 连续/ 的/ 流体/ 描述/ 为/ 相互作用/ 的/ 粒子/ 群/ ,/ 每个/ 粒子/ 携带/ 物理量/ ,/ 包括/ 质量/ 、/ 速度/ 、/ 密度/ 等/ ./ 通过/ 求解/ 粒子/ 群/ 的/ 动力学/ 方程/ 并/ 跟踪/ 每个/ 粒子/ 的/ 运动/ 轨迹/ 可以/ 获得/ 整个/ 粒子系统/ 的/ 物理/ 行为/ ,/ 而/ 每个/ 粒子/ 的/ 物理量/ 可/ 通过/ 粒子/ 支持/ 域/ 内/ 所有/ 粒子/ 的/ 加权/ 求和/ 近似/ 获得/ ./ 隐式/ 不可/ 压缩/ 光滑/ 粒子/ 流体/ 动力学/ (/ IISPH/ [/ 3/ ]/ )/ 和/ 标准/ 的/ SPH/ 方法/ 不同/ ,/ IISPH/ 通过/ 迭代/ 求解/ 线性方程组/ 来/ 求解/ 压力/ ./ 为了/ 建立/ 求解/ 压力/ 的/ 线性方程组/ ,/ IISPH/ 采用/ 连续/ 方程/ 和/ 投影/ 策略/ 的/ 离散/ 形式/ [/ 34/ ]/ ,/ 而且/ 线性方程/ 可以/ 转换/ 为/ 非/ 矩阵/ 形式/ 进行/ 高效/ 求解/ ./ IISPH/ 是/ 一种/ 基于/ 密度/ 变化率/ 的/ 半/ 隐性/ 的/ 密度/ 预测/ 技术/ ,/ 密度/ 预测/ 方程/ 通过/ 直接/ 离散/ t/ 时刻/ 的/ 连续性/ 方程/ D/ ρ/ // Dt/ =/ -/ ρ/ / ·/ 狏/ 得到/ ,/ 由前/ 向/ 差分/ 公式/ D/ ρ/ // Dt/ =/ (/ ρ/ i/ 法/ 计算速度/ 散度/ / ·/ 狏/ i/ =/ -/ 1/ // ρ/ i/ 是/ 有/ (/ ρ/ i/ (/ t/ +/ Δ/ t/ )/ -/ ρ/ i/ 其中/ :/ Wij/ 为/ 光滑/ 核/ 函数/ ,/ t/ +/ Δ/ t/ 的/ 粒子/ 相对速度/ 狏/ ij/ (/ t/ +/ Δ/ t/ )/ =/ 狏/ i/ (/ t/ +/ Δ/ t/ )/ -/ 狏/ j/ (/ t/ +/ Δ/ t/ )/ 是/ 未知/ 的/ ,/ 它/ 依赖于/ 未知/ 的/ t/ 时刻/ 的/ 粒子/ 压力/ ,/ 压力/ 又/ 与/ t/ 时刻/ 的/ 粒子/ 压强/ 线性相关/ ./ 采用/ 半/ 隐性/ 的/ 欧拉/ 方法/ 来/ 更新/ 粒子/ 位置/ 和/ 速度/ ,/ 方程/ (/ 1/ )/ 中/ 的/ 速度/ 可以/ 被/ 重写/ 为/ 狏/ i/ (/ t/ +/ Δ/ t/ )/ =/ 狏/ i/ (/ t/ )/ +/ Δ/ t/ (/ 犉/ adv/ 其中/ :/ 犉/ p/ 是/ 除/ 压力/ 外/ 的/ 其他/ 力/ ,/ 如/ 重力/ 、/ 粘性力/ 等/ ./ 由/ 投影/ 策略/ 可/ 将/ t/ +/ Δ/ t/ 时刻/ 的/ 速度/ 分解/ 为/ 其他/ 力/ 产生/ 的/ 速度/ 狏/ advi/ =/ 狏/ i/ (/ t/ )/ +/ Δ/ t/ 犉/ adv/ 狏/ pi/ =/ 狏/ i/ (/ t/ +/ Δ/ t/ )/ -/ 狏/ adv/ 的/ 粒子/ 密度/ 分解/ 为/ 压力/ 产生/ 的/ 密度/ 和/ 其他/ 力/ 产生/ 的/ 密度/ :/ ρ/ i/ 推出/ :/ 由/ 方程/ (/ 1/ )/ 和/ 狏/ ppi/ =/ Δ/ t2/ ∑/ j/ ρ/ 而后/ 寻找/ 防止/ 流体/ 压缩/ 的/ 粒子/ 压力/ ,/ 即/ 通过/ 压力/ 修正/ t/ +/ Δ/ t/ 粒子/ 密度/ 的/ 偏差/ ,/ 使/ ρ/ i/ 中/ ρ/ 0/ 为/ 静态/ 密度/ ,/ 可以/ 得到/ Δ/ t2/ ∑/ j/ 其中/ 犉/ p/ 式/ 计算/ 得到/ [/ 2/ ]/ 犉/ pi/ (/ t/ )/ =/ -/ mi/ ∑/ j/ 其中/ pi/ 式/ 中/ κ/ 和/ γ/ 是/ 控制/ 刚度/ 的/ 系数/ ./ 将式/ (/ 6/ )/ 代入/ 式/ (/ 5/ )/ 中/ ,/ 可以/ 得到/ 形/ 如/ 犃/ (/ t/ )/ 狆/ (/ t/ )/ =/ 犫/ (/ t/ )/ 的/ 线性方程组/ ,/ 其中/ 犫/ (/ t/ )/ 对应/ 方程/ (/ 5/ )/ 的/ 右侧/ ,/ 对于/ 每/ 一个/ 粒子/ 有/ 如下/ 形式/ 的/ 方程/ :/ 为了/ 能够/ 求解/ 方程/ (/ 8/ )/ ,/ 必须/ 获得/ ∑/ j/ 体/ 形式/ ./ 首先/ ,/ 对/ 方程/ (/ 6/ )/ 两边/ 都/ 乘以/ Δ/ t2/ // mi/ ,/ 得到/ Δ/ t2/ 犉/ p/ 其中/ 犱/ ii/ =/ -/ Δ/ t2/ ∑/ j/ 同理/ 可/ 得/ Δ/ t2/ 犉/ p/ 程/ (/ 5/ )/ ,/ 可/ 得/ ρ/ 0/ -/ ρ/ ∑/ jmj/ 犱/ iipi/ +/ ∑/ j/ 由于/ 粒子/ i/ 和/ 粒子/ j/ 互为/ 邻域/ ,/ 因此/ ∑/ k/ 也/ 包含/ 了/ pi/ 将/ 方程/ (/ 11/ )/ 代入/ 方程/ (/ 10/ )/ ,/ 则/ 方程/ (/ 10/ )/ 可写/ 为/ ρ/ 0/ -/ ρ/ ∑/ j/ 由于/ ∑/ j/ 如式/ (/ 13/ )/ 形式/ :/ Page5/ 对比/ 式/ (/ 12/ )/ 和/ (/ 13/ )/ ,/ 我们/ 可以/ 得到/ ∑/ j/ ≠/ iaijpj/ =/ ∑/ j/ 使用/ RelaxedJacobi/ 方法/ 迭代/ 求解/ 式/ (/ 13/ )/ 中/ 的/ pips/ +/ 1/ 其中/ :/ s/ 为/ 迭代/ 次数/ ;/ ω/ 为/ 松弛/ 系数/ ;/ aii/ 和/ ∑/ j/ ≠/ i/ 别如式/ (/ 14/ )/ 和/ (/ 15/ )/ 所示/ ./ 求解/ 出/ pi/ 之后/ 可/ 根据/ 式/ (/ 5/ )/ i/ (/ t/ )/ ,/ 而后/ 可以/ 通过/ 式/ (/ 17/ )/ 和/ (/ 18/ )/ 获得/ 粒子/ 求解/ 犉/ p/ 在/ 下/ 一/ 时刻/ 的/ 速度/ 和/ 位移/ :/ 3.2/ TLED/ 非线性/ 有限元/ 固体/ 建模/ 可/ 形变/ 固体/ 的/ 非线性/ 有限元/ 模型/ 的/ 动态平衡/ 方程/ 可/ 描述/ 为/ 其中/ :/ 狌/ n/ 为/ 节点/ 位移/ ;/ 犕/ 为/ 常数/ 质量/ 矩阵/ ;/ 犚/ n/ 为/ 节点/ 力/ 向量/ ;/ 犓/ (/ 狌/ n/ )/ 为/ 整体/ 刚度/ 矩阵/ ,/ 与/ 节点/ 位移/ 为/ 非线性/ 关系/ ;/ 犇/ 为/ 阻尼/ 矩阵/ ,/ 可定义/ 为犇/ =/ α/ 犕/ ,/ 其中/ α/ 为/ 常数/ ,/ 且/ 质量/ 矩阵/ 犕/ 和/ 阻尼/ 矩阵/ 犇/ 近似/ 为/ 对角/ 矩阵/ [/ 36/ ]/ ./ Miller/ 等/ 人/ [/ 4/ ]/ 采用/ TLED/ 计算/ 非线性/ 有限元/ 动态平衡/ 方程/ 中/ 的/ 刚度/ 项/ 犓/ (/ 狌/ n/ )/ 狌/ n/ =/ ∑/ i/ 犉/ (/ i/ )/ n/ 是/ 由/ 四面体/ 有限元/ 单元/ i/ 中/ 应力/ 造成/ 的/ 全局/ 节点/ 力/ ,/ 对于/ t/ 时刻/ 的/ 给定/ 单元/ ,/ t/ 犉/ 通过/ 式/ (/ 20/ )/ 计算/ :/ 其中/ t0/ 珘/ 犛是/ 向量/ 形式/ 的/ 第/ 2/ 类/ Piola/ -/ Kirchhoff/ 应力/ ,/ t0/ 犅/ TL/ 是/ 应变/ -/ 位移/ 矩阵/ ,/ 0V/ 是/ 初始/ 时刻/ 单元/ 的/ 体积/ ./ TLED/ 非线性/ 有限元/ 方法/ 使得/ 不必/ 获得/ 整体/ 刚度/ 矩阵/ 犓/ (/ 狌/ n/ )/ ,/ 就/ 可以/ 在/ 单元/ 层次/ 上/ 计算/ 由/ 单元/ 应力/ 产生/ 的/ 节点/ 力/ 的/ 分布/ ./ 由于/ 质量/ 矩阵/ 和/ 阻尼/ 矩阵/ 近似/ 为/ 对角/ 矩阵/ ,/ 因此/ 有限元/ 的/ 平衡/ 方程/ 变得/ 可以/ 在/ 单元/ 层次/ 上/ 进行/ 求解/ ,/ 并且/ 能够/ 对/ 形状/ 函数/ 的/ 空间/ 导数/ 进行/ 预计/ 算/ ,/ 从而/ 减少/ 模拟/ 时/ 的/ 计算/ 量/ [/ 36/ ]/ ,/ 这些/ 特性/ 使得/ TLED/ 非线性/ 有限元/ 方法/ 非常适合/ 在/ GPU/ 上/ 进行/ 大规模/ 的/ 并行计算/ ./ 4/ 耦合/ 仿真/ 4.1/ 自/ 适应/ 代理/ 粒子/ 生成/ 本文/ 根据/ 固体/ 模型/ 表面/ 的/ 局部/ 几何/ 特征/ 自/ 适应/ 地/ 采样/ ,/ 在/ 固体/ 模型/ 的/ 表面/ 三角/ 片上/ 根据/ 局部/ 高斯曲率/ 计算/ 生成/ 不同/ 分辨率/ (/ 即/ 粒子/ 间隔/ )/ 的/ 代理/ 粒子/ 和/ 不同/ 大小/ 的/ 光滑/ 核/ 半径/ ./ 固体/ 模型/ 表面/ 局部/ 变化/ 剧烈/ 且/ 具有/ 复杂/ 几何/ 特征/ 的/ 区域/ 所/ 生成/ 的/ 代理/ 粒子/ 间隔/ 较/ 小/ ,/ 支持/ 域/ 光滑/ 核/ 半径/ 较/ 小/ ,/ 代理/ 粒子/ 的/ 采样/ 分辨率/ 较大/ ;/ 而/ 局部/ 变化/ 平缓/ 且/ 具有/ 简单/ 几何/ 特征/ 的/ 区域/ ,/ 代理/ 粒子/ 间隔/ 较大/ ,/ 光滑/ 核/ 半径/ 较大/ ,/ 代理/ 粒子/ 的/ 采样/ 分辨率/ 较/ 小/ ./ 为了/ 避免/ 代理/ 粒子/ 光滑/ 核/ 半径/ 过大而/ 导致/ 过早/ 的/ 发生/ 耦合/ 现象/ ,/ 本文/ 将/ 代理/ 粒子/ 光滑/ 核/ 函数/ 的/ 支持/ 域/ 设成/ 椭球/ 型/ (/ 详见/ 4.1/ ./ 3/ 节/ )/ ,/ 在/ 固体/ 表面/ 法向/ 方向/ 代理/ 粒子/ 的/ 核/ 半径/ 和/ 流体/ 粒子/ 相同/ ,/ 切向/ 方向/ 则/ 根据/ 局部/ 高斯曲率/ 来/ 设定/ 每个/ 切向/ 光滑/ 核/ 半径/ 的/ 大小/ ./ 为了/ 防止/ 穿透/ 现象/ 的/ 发生/ ,/ 在/ 固体/ 发生/ 形变/ 后/ 根据/ 新/ 的/ 局部/ 高斯曲率/ 对/ 固体/ 表面/ 重/ 采样/ 代理/ 粒子/ ,/ 并/ 自/ 适应/ 地/ 改变/ 切向/ 光滑/ 核/ 半径/ 的/ 大小/ ,/ 采用/ 正则/ 化/ 方法/ 修正/ 耦合/ 处/ 的/ 物理量/ ./ 本文/ 方法/ 可/ 在/ 降低/ 采样/ 代理/ 粒子/ 的/ 同时/ 保持/ 几何/ 复杂/ 区域/ 的/ 细节/ ,/ 并且/ 允许/ 将/ 计算资源/ 集中/ 在/ 几何/ 复杂/ 区域/ ,/ 提高/ 计算/ 效率/ 并/ 实现/ 逼真/ 的/ 流固/ 耦合/ 效果/ ./ 4.1/ ./ 1/ 局部/ 高斯曲率/ 本文/ 高斯曲率/ 实际/ 反映/ 的/ 是/ 曲面/ 的/ 弯曲/ 程度/ ,/ 曲面/ 的/ 高斯曲率/ 越大/ 意味着/ 曲面/ 的/ 光滑/ 程度/ 越低/ ,/ 对于/ 一个/ 固体/ 模型/ 而言/ ,/ 高斯曲率/ 较大/ 的/ 区域/ 通常/ 是/ 耦合/ 情况/ 较为/ 复杂/ 的/ 区域/ ./ Meyer/ 等/ 人/ [/ 37/ ]/ 提出/ 了/ 一种/ 可以/ 灵活/ 地/ 估算/ 曲面/ 重要/ 几何/ 性质/ 的/ 方法/ ,/ 包括/ 任意/ 三角/ 网格/ 顶点/ 的/ 曲率/ ,/ 此/ 方法/ 的/ 基本/ 思想/ 是/ 把/ 光滑/ 曲面/ 看作/ 是/ 一簇/ 网格/ 的/ 极限/ 或者/ 线性/ 逼近/ ,/ 把/ 三角/ 网格/ 每个/ 顶点/ 的/ 度量/ 性质/ 看作/ 是/ 此/ 空间/ 网格/ 在/ 此点/ 一个/ 小/ 邻域/ 的/ 平均/ 度量/ ./ 对于/ 离散/ 的/ 三角/ 网格/ 模型/ 顶点/ pi/ 斯/ 曲率/ κ/ ⌒/ 其中/ :/ m/ 是/ 顶点/ pi/ 周围/ 三角形/ 面片/ 数量/ ;/ θ/ j/ 是/ pipj/ 和/ pipj/ +/ 1/ 的/ 夹角/ ./ AM/ (/ pi/ )/ 为/ 图/ 1/ 中/ 的/ 阴影/ 区域/ 面积/ :/ Page6/ 如果/ △/ pipjpj/ +/ 1/ 是/ 锐角三角/ 形/ ,/ 则/ Sj/ 是/ 多边形/ pipjpj/ +/ 1cj/ 的/ 面积/ ,/ 其中/ pj/ 和/ pj/ +/ 1/ 是/ △/ pipjpj/ +/ 1/ 边/ 的/ 中点/ ,/ cj/ 是/ 锐角/ △/ pipjpj/ +/ 1/ 的/ 外心/ ./ 如果/ △/ pipjpj/ +/ 1/ 是/ 直角/ 或/ 钝角/ 三角形/ ,/ 则/ Sj/ 是/ △/ pipjpj/ +/ 1/ 面积/ 的/ 二分之一/ ,/ 即/ Sj/ 为/ 以/ pi/ 为/ 顶点/ 、/ 钝角/ 对应/ 边/ 的/ 中点/ 和/ 另/ 两条/ 边/ 的/ 中点/ 相连/ 形成/ 的/ 多边形/ 的/ 面积/ ,/ 其/ 恰好/ 为/ 三角形/ 面积/ 的/ 一半/ ./ 对于/ 任意/ 一个/ 三角形/ 面片/ ,/ 本文/ 定义/ 了/ 3/ 种/ 类型/ 的/ 局部/ 高斯曲率/ :/ 第/ 1/ 种/ 是/ 三角形/ 顶点/ 的/ 局部/ 高斯曲率/ ,/ 即/ 为/ 顶点/ 的/ 高斯曲率/ ;/ 第/ 2/ 种为/ 三角形/ 3/ 条/ 边上/ 的/ 局部/ 高斯曲率/ ,/ 第/ 3/ 种为/ 三角形/ 面片/ 内部/ 的/ 局部/ 高斯曲率/ ./ 设/ 三角形/ 3/ 个/ 顶点/ 的/ 高斯曲率/ 绝对值/ 从大到/ 小/ 的/ 顺序/ 分别/ 为/ 珔/ κ/ G/ (/ A/ )/ 、/ 珔/ κ/ G/ (/ B/ )/ 、/ 珔/ κ/ G/ (/ C/ )/ ,/ 定义/ 三角形/ 面片/ 内/ 的/ 局部/ 高斯曲率/ 如式/ (/ 23/ )/ 所示/ :/ 珔/ κ/ G/ (/ T/ )/ =/ λ/ A/ 珔/ κ/ G/ (/ A/ )/ +/ λ/ B/ 珔/ κ/ G/ (/ B/ )/ +/ λ/ C/ 珔/ κ/ G/ (/ C/ )/ (/ 23/ )/ 另外/ 3/ 条边/ 的/ 局部/ 高斯曲率/ 分别/ 为/ 图/ 2/ 均匀/ 采样/ 的/ 边界/ 粒子/ (/ a/ )/ 和/ 自/ 适应/ 采样/ 的/ 代理/ 粒子/ (/ b/ )/ λ/ A/ ,/ λ/ B/ ,/ λ/ C/ ,/ τ/ 1/ ,/ τ/ 2/ 是/ 权值/ ,/ 有/ 1/ / λ/ A/ / λ/ B/ / λ/ C/ / 0/ ,/ 1/ / τ/ 1/ / τ/ 2/ / 0/ ,/ 本文/ 选取/ λ/ A/ =/ 0.5/ ,/ λ/ B/ =/ 0.3/ ,/ λ/ C/ =/ 0.2/ ,/ τ/ 1/ =/ 0.6/ ,/ τ/ 2/ =/ 0.4/ ./ 4.1/ ./ 2/ 代理/ 粒子/ 的/ 自/ 适应/ 分布/ 本文/ 在/ 固体/ 模型/ 的/ 三角/ 片上/ 根据/ 局部/ 高斯曲率/ 计算/ 生成/ 不同/ 分辨率/ (/ 即/ 粒子/ 间隔/ )/ 的/ 代理/ 粒子/ 和/ 不同/ 大小/ 的/ 光滑/ 核/ 半径/ ./ 局部/ 高斯曲率/ 越大/ ,/ 则/ 所/ 生成/ 的/ 代理/ 粒子/ 分辨率/ 越高/ 、/ 粒子/ 间距/ 越小/ 、/ 代理/ 粒子/ 的/ 切/ 向/ 光滑/ 核/ 半径/ 越小/ ./ 由于/ 高斯曲率/ 的/ 值/ 范围/ 变化/ 较大/ ,/ 为了/ 方便/ 计算/ ,/ 本文/ 将/ 局部/ 高斯曲率/ 归于/ 区间/ ,/ η/ [/ η/ 1/ ]/ 2G/ ,/ 珔/ κ/ min/ 其中/ 珔/ κ/ max/ 值/ ,/ 本文/ 中/ η/ 1/ 三角/ 网格/ 顶点/ ,/ 我们/ 直接/ 在/ 顶点/ 上/ 生成/ 一个/ 代理/ 粒子/ ,/ 设其法/ 向/ 和/ 切/ 向/ 光滑/ 核/ 半径/ 与/ 流体/ 一致/ 皆/ 为/ hf/ ./ 对于/ 边上/ E/ 的/ 代理/ 粒子/ ,/ 其/ 间距/ 为/ ds/ -/ E/ =/ hf/ // 2/ ·/ 珔/ κ/ G/ (/ E/ (/ 最短边/ 的/ 法向/ 方向/ 采用/ 扫描线/ 算法/ [/ 3/ ]/ 生成/ 代理/ 粒子/ ,/ 其/ 间距/ 为/ ds/ -/ T/ =/ hf/ // 2/ ·/ 珔/ κ/ G/ (/ T/ (/ 图/ 2/ 显示/ 了/ 均匀/ 采样/ 粒子/ (/ a/ )/ 和/ 本文/ 自/ 适应/ 采样/ 方法/ 采样/ 的/ 代理/ 粒子/ (/ b/ )/ 对比/ ,/ 在/ 几何/ 复杂/ 区域/ 采样/ 的/ 代理/ 粒子/ 较/ 多/ ,/ 而/ 在/ 几何/ 简单/ 区域/ 采样/ 的/ 代理/ 粒子/ 较少/ ./ Page74/ ./ 1.3/ 代理/ 粒子/ 的/ 支持/ 域/ 本文/ 根据/ 局部/ 高斯曲率/ 以/ 不同/ 密度/ 对/ 固体/ 表面/ 采样/ 代理/ 粒子/ ,/ 采样/ 的/ 代理/ 粒子/ 数量/ 越少/ 的/ 三角/ 面片/ ,/ 其上/ 的/ 代理/ 粒子/ 支持/ 域/ 半径/ 则/ 越/ 大/ ./ 如果/ 垂直于/ 三角/ 面片/ 的/ 轴向/ 半径/ 过大/ ,/ 则/ 会/ 导致/ 粒子/ 在/ 距离/ 三角/ 面片/ 还/ 较/ 远时/ 便/ 已/ 进入/ 代理/ 粒子/ 的/ 支持/ 域/ ,/ 受到/ 耦合/ 作用力/ ,/ 导致/ 过早/ 耦合/ 现象/ 的/ 发生/ ./ 本文/ 将/ 代理/ 粒子/ 光滑/ 核/ 函数/ 的/ 支持/ 域/ 设计/ 为/ 椭球/ ,/ 将/ 垂直于/ 三角/ 面片/ 的/ 轴向/ 半径/ 设置/ 为/ 较/ 小值/ ,/ 以/ 代理/ 粒子/ 为/ 中心/ 建立/ 局部/ 坐标系/ 狀/ x/ ,/ 狀/ y/ ,/ 狀/ 局部/ 坐标系/ 下/ 的/ 方程/ 为/ 其中/ :/ a/ 、/ b/ 为/ 赤道/ 半径/ ,/ c/ 为/ 极/ 半径/ ,/ 如图/ 3/ 所示/ ;/ 狀/ x/ 、/ 狀/ y/ 分别/ 沿着/ 椭球/ 的/ 赤道/ 半径/ 并/ 与/ a/ 和/ b/ 重合/ ;/ 狀/ z/ 沿着/ 极/ 半径/ 方向/ ,/ 狀/ x/ 、/ 狀/ y/ 、/ 狀/ z/ 都/ 为/ 单位向量/ ,/ 每/ 一个/ 支持/ 域/ 内/ 可能/ 包含/ 了/ 流体/ 粒子/ 和/ 代理/ 粒子/ ./ 对于/ △/ ABC/ 面片/ 内部/ 的/ 代理/ 粒子/ ,/ 狀/ x/ 和/ 狀/ y/ 在/ 平面/ 切向/ 方向/ 上/ ,/ 狀/ x/ 沿着/ 扫描线/ 方向/ 并且/ 狀/ y/ 垂直于/ 狀/ x/ ,/ 狀/ z/ 为/ 平面/ 法向/ 方向/ ,/ 初始/ 情况/ 下/ ,/ 设置/ 此/ 椭球/ 形核/ 函数/ 支持/ 域/ 在/ 狀/ x/ 、/ 狀/ y/ 方向/ 的/ 光滑/ 核/ 半径/ 皆/ 为/ hs/ -/ T/ =/ 2ds/ -/ T/ =/ hf/ // 珔/ κ/ G/ (/ T/ )/ ,/ 狀/ z/ 方向/ 的/ 光滑/ 核/ 半径/ 为/ hf/ ,/ 即/ a/ =/ b/ =/ hf/ // 珔/ κ/ G/ (/ T/ )/ ,/ c/ =/ hf/ ./ 对于/ △/ ABC/ 边上/ 的/ 代理/ 粒子/ ,/ 以/ AC/ 为例/ ,/ 狀/ z/ 图/ 3/ 代理/ 粒子/ 的/ 支持/ 域/ 2D/ 和/ 3D/ 示意图/ 4.1/ ./ 4/ 代理/ 粒子/ 自/ 适应/ 更新/ 当流固/ 耦合/ 现象/ 发生/ 时/ ,/ 代理/ 粒子/ 根据/ 其/ 在/ 固体/ 表面/ 三角形/ 面片/ 内/ 的/ 重心坐标/ 与/ 三角/ 面片/ 顶点/ 保持/ 对应/ 关系/ ./ 流体/ 与/ 固体/ 的/ 耦合/ 力作/ 用于/ 代理/ 粒子/ 上/ ,/ 代理/ 粒子/ 则/ 根据/ 其/ 重心坐标/ 将/ 耦合/ 力/ 映射/ 到/ 固体/ 表面/ 三角/ 面片/ 的/ 顶点/ 上/ ,/ 耦合/ 力/ 转化/ 为/ 固体/ 非线性/ 有限元/ 顶点/ 受到/ 的/ 作用力/ ./ 固体/ 随之/ 发生/ 形变/ ,/ 为了/ 防止/ 固体/ 形变/ 后/ 代理/ 粒子/ 间距/ 拉大/ 而/ 导致/ 穿透/ 现象/ 和/ 过早/ 耦合/ 的/ 发生/ ,/ 本文/ 将/ 重新/ 根据/ 固体/ 表面/ 局部/ 高斯曲率/ 重/ 采样/ 代理/ 粒子/ ,/ 同时/ 根据/ 固体/ 表面/ 三角/ 面片/ 形变/ 的/ 大小/ 自/ 适应/ 地/ 改变/ 代理/ 粒子/ 的/ 切/ 向/ 光为/ 法向/ 方向/ ,/ 为/ 与/ 此边/ 相邻/ 的/ 两个/ 三角形/ 的/ 法/ 向量/ 均值/ ./ 切向/ 方向/ 上/ ,/ 狀/ x/ 沿着/ 边/ AC/ 方向/ ,/ 则/ 狀/ y/ =/ 狀/ x/ ×/ 狀/ z/ ./ 所以/ AC/ 边上/ 椭球/ 形核/ 函数/ 支持/ 域/ 在/ 狀/ x/ 方向/ 的/ 光滑/ 核/ 半径/ 为/ hs/ -/ AC/ ,/ 狀/ y/ 方向/ 的/ 光滑/ 核/ 半径/ 为/ hf/ ,/ 狀/ z/ 方向/ 的/ 光滑/ 核/ 半径/ 为/ hf/ ,/ 即/ a/ =/ hs/ -/ AC/ ,/ b/ =/ c/ =/ hf/ ./ 对于/ AB/ 边上/ 的/ 代理/ 粒子/ ,/ 有/ a/ =/ hs/ -/ AB/ ,/ b/ =/ c/ =/ hf/ ,/ 对于/ BC/ 边上/ 的/ 代理/ 粒子/ a/ =/ hs/ -/ BC/ ,/ b/ =/ c/ =/ hf/ ./ 对于/ 代理/ 粒子/ 狓/ i/ 邻域/ 网格/ 内/ 的/ 流体/ 粒子/ 狓/ j/ ,/ 判断/ 其/ 是否/ 位于/ 代理/ 粒子/ 狓/ i/ 光滑/ 核/ 函数/ 支持/ 域/ 内/ ,/ 只/ 需要/ 计算/ 出该/ 粒子/ 在/ 局部/ 坐标系/ 下/ 的/ 位置矢量/ 狉/ j/ =/ 狓/ j/ -/ 狓/ i/ ,/ 以及/ 该/ 粒子/ 在/ 局部/ 坐标系/ 下/ 的/ 坐标/ (/ x/ ,/ y/ ,/ z/ )/ =/ (/ 狀/ x/ ·/ 狉/ j/ ,/ 狀/ y/ ·/ 狉/ j/ ,/ 狀/ z/ ·/ 狉/ j/ )/ ,/ 并/ 代入/ 局部/ 椭球/ 方程/ (/ 28/ )/ ,/ 看/ 是否/ 满足/ ,/ 如果/ 满足/ 则/ 位于/ 支持/ 域/ 内/ ./ 对于/ 此/ 椭球/ 形/ 的/ 光滑/ 核/ 函数/ 支持/ 域/ ,/ 本文/ 设计/ 了/ 一个/ 相应/ 的/ 椭球/ 型/ 的/ 光滑/ 核/ 函数/ :/ s/ -/ T/ ,/ h2/ 其中/ :/ ξ/ 为/ 系数/ ,/ 狉/ =/ 狓/ -/ 狓/ i/ ,/ 由于/ 代理/ 粒子/ 在/ 椭球/ 的/ 各个/ 方向/ 上/ 有/ 不同/ 的/ 光滑/ 核/ 半径/ h/ ,/ 本文/ 引入/ 椭圆/ 对角/ 矩阵/ 犌/ ./ 对于/ △/ ABC/ 内部/ 的/ 代理/ 粒子/ ,/ 则/ 犌/ =/ diag/ (/ h2/ 粒子/ ,/ 则/ 可以/ 得到/ 犌/ =/ diag/ (/ h2/ 得到/ AC/ 边/ 和/ BC/ 边上/ 的/ 代理/ 粒子/ 相应/ 的/ 犌/ ./ P/ (/ 犌/ 狉/ )/ 是/ 关于/ 犌/ 狉/ 的/ 多项式/ ,/ 本文/ 采用/ 的/ 是/ 三次/ 样条/ 多项式/ ./ 滑核/ 半径/ 的/ 大小/ ./ 本文/ 将/ 代理/ 粒子/ 的/ 切/ 向/ 光滑/ 核/ 半径/ 初始化/ 为/ 其/ 粒子/ 间距/ 的/ 2/ 倍/ ,/ 而后/ 随/ 三角/ 面片/ 的/ 形变/ 而/ 自/ 适应/ 调整/ ./ 对于/ 边上/ 的/ 代理/ 粒子/ ,/ 以/ 三角形/ 的/ 边/ AB/ 为例/ ,/ 具体/ 过程/ 为/ :/ 设/ lAB/ 为/ 三角形/ AB/ 边/ 的/ 初始/ 长度/ ,/ 那么/ 形变/ 之后/ AB/ 边/ 的/ 长度/ 为/ lAB/ ,/ 形变/ 后/ 的/ 边长/ 比值/ 为/ η/ AB/ =/ lAB/ // lAB/ ,/ 那么/ AB/ 边上/ 的/ 代理/ 粒子/ 的/ 切/ 向/ 光滑/ 核/ 半径/ hs/ -/ AB/ =/ 2/ η/ ABds/ -/ AB/ ,/ 同理/ ,/ 对/ BC/ 、/ AC/ 两边/ 同样/ 采用/ 此/ 方法/ 得到/ hs/ -/ AC/ 和/ hs/ -/ BC/ ./ 设/ 三角形/ 的/ 初始/ 面积/ 为/ S/ ,/ 形变/ 后/ 三角形/ 的/ 面积/ 为/ S/ ,/ 那么/ 设/ η/ T/ =/ S/ // S/ ,/ 那么/ 三角/ 面片/ 内/ 代理/ 粒子/ 的/ 切/ 向/ 光滑/ 核/ 半径/ 为/ hs/ -/ T/ =/ 2/ η/ 槡/ Tds/ -/ T/ ./ Page84/ ./ 2/ 耦合/ 力/ 的/ 计算/ 和/ 边界/ 处理/ 在/ 计算/ 流体/ 粒子/ 和/ 代理/ 粒子/ 的/ 耦合/ 力时/ ,/ 以/ 代理/ 粒子/ 为/ 中心/ 进行/ 计算/ [/ 5/ ]/ ,/ 采用/ 式/ (/ 30/ )/ 计算/ :/ 其中/ :/ Kc/ 为/ 耦合/ 系数/ ;/ mf/ 和/ ms/ 分别/ 是/ 流体/ 粒子/ 和/ 代理/ 粒子/ 的/ 质量/ ,/ 而后/ 采用/ 动量/ 守恒定律/ 计算/ 流体/ 粒子/ 的/ 耦合/ 响应/ :/ 狏/ f/ 和/ 狏/ f/ -/ next/ 分别/ 是/ 流体/ 粒子/ 当前/ 速度/ 和/ 下/ 一/ 时刻/ 速度/ ./ 对于/ 代理/ 粒子/ ,/ 则/ 根据/ 其/ 在/ 三角/ 面片/ 中/ 的/ 重心坐标/ 与/ 3/ 个/ 顶点/ 的/ 重心/ 映射/ 关系/ ,/ 将/ 每个/ 代理/ 粒子/ 的/ 耦合/ 力/ 映射/ 到/ 三角/ 面片/ 的/ 顶点/ 上/ ,/ 而/ 这些/ 顶点/ 所受/ 的/ 力/ 即/ 为/ TLED/ 非线性/ 有限元/ 算法/ 中/ 的/ 节点/ 所/ 受/ 外力/ ./ 为了/ 处理/ SPH/ 核/ 函数/ 在/ 边界/ 处/ 不/ 连续/ 的/ 问题/ ,/ 减少/ 因此/ 带来/ 的/ 计算误差/ ,/ 本文/ 采用/ 正则/ 化/ 的/ 方式/ 求解/ 边界/ 处/ 代理/ 粒子/ 和/ 流体/ 粒子/ 的/ 物理量/ A/ :/ A/ =/ ∑/ j/ ∑/ j4/ ./ 3/ 基于/ CUDA/ 的/ GPU/ 并行计算/ 非线性/ 有限元/ 固体/ 与/ 不可/ 压缩/ 流体/ 的/ 耦合/ 过程/ 需要/ 进行/ 大量/ 的/ 计算/ ,/ 当流固/ 耦合/ 仿真/ 场景/ 中/ 粒子/ 数目/ 较多时/ 很/ 难/ 实现/ 实时/ 的/ 流固/ 耦合/ 仿真/ ./ 本文/ 运图/ 4/ 基于/ CUDA/ 的/ GPU/ 并行计算/ 用/ 基于/ CUDA/ 的/ GPU/ 并行计算/ 方法/ 来/ 加速/ 流固/ 耦合/ 的/ 计算/ ,/ 使得/ 流固/ 耦合/ 仿真/ 达到/ 实时性/ 的/ 要求/ ./ 基于/ CUDA/ 的/ GPU/ 并行计算/ 是/ 以/ 线程/ 为/ 基本/ 单位/ 的/ 高度/ 并行计算/ 方式/ ,/ GPU/ 线程/ 以/ 网格/ 的/ 方式/ 组织/ ,/ 每个/ 网格/ 又/ 包含/ 若干个/ 线程/ 块/ ,/ 同一/ 线程/ 块/ 中/ 的/ 众/ 多线程/ 拥有/ 相同/ 的/ 指令/ 地址/ ,/ 可以/ 并行执行/ 且/ 能够/ 通过/ 共享存储器/ 实现/ 高效/ 的/ 数据通信/ ./ 在/ 流固/ 耦合/ 场景/ 初始化/ 阶段/ ,/ 我们/ 先对/ 不可/ 压缩/ 流体/ 和/ 非线性/ 有限元/ 固体/ 模型/ 进行/ 预处理/ ,/ 预先/ 计算/ 出/ 并行/ 过程/ 中/ 经常/ 使用/ 且/ 不会/ 改变/ 的/ 量/ ,/ 如/ 有限元/ 单元/ 的/ 节点/ 链接/ 关系/ 、/ 粒子/ 的/ 属性/ 常量/ 、/ 有限元/ 质量/ 矩阵/ 、/ 阻尼/ 矩阵/ 等/ ./ 而后/ 将/ 所/ 需要/ 用到/ 的/ 物理量/ 从/ CPU/ 内存/ 载入/ 至/ GPU/ 内存/ 中/ ,/ 其中/ 将/ 常用/ 到/ 的/ 不变/ 的/ 量/ 载入/ 常量/ 内存/ 中/ ,/ 以/ 减少/ 并行计算/ 过程/ 中/ 的/ 内存/ 访问/ 时间/ ./ 在/ 并行计算/ 过程/ 中/ 运用/ 线程/ 块/ 和/ 共享内存/ 以/ 实现/ 高效/ 并行执行/ 和/ 通信/ ./ 首先/ 并行/ 求解/ 固体/ 几何/ 表面/ 的/ 局部/ 高斯曲率/ ,/ 并/ 自/ 适应/ 地/ 生成/ 代理/ 粒子/ ;/ 其次/ 求解/ IISPH/ 不可/ 压缩/ 流体/ 的/ 运动/ ;/ 而后/ 并行/ 求解/ 代理/ 粒子/ 与/ 流体/ 粒子/ 的/ 耦合/ 过程/ ,/ 并/ 将/ 代理/ 粒子/ 所受/ 的/ 耦合/ 力/ 通过/ 重心坐标/ 映射/ 到/ TLED/ 非线性/ 有限元/ 模型/ 的/ 单元/ 节点/ 处/ ,/ 以/ 求解/ 固体/ 模型/ 的/ 形变/ ;/ 最后/ ,/ 当/ 固体/ 模型/ 发生/ 形变/ 时/ ,/ 将/ 计算结果/ 传输/ 至/ CPU/ 内存/ 渲染/ ./ 在/ 物体/ 形变/ 后/ ,/ 需/ 重新/ 计算/ 固体/ 几何/ 表面/ 局部/ 高斯曲率/ ,/ 重/ 采样/ 自/ 适应/ 地/ 生成/ 代理/ 粒子/ ,/ 而后/ 继续/ 上述/ 过程/ 直至/ 结束/ 程序/ ,/ 并行计算/ 过程/ 如图/ 4/ 所示/ ./ Page95/ 实验/ 结果/ 与/ 分析/ 为了/ 验证/ 本文/ 方法/ 的/ 有效性/ ,/ 我们/ 分别/ 使用/ 了/ 兔子/ 、/ 章鱼/ 和/ 怪兽/ 的/ 模型/ 进行/ IISPH/ 不可/ 压缩/ 流体/ 和/ TLED/ 非线性/ 有限元/ 固体/ 的/ 耦合/ 实验/ ./ 实验/ 平台/ 为/ :/ (/ 1/ )/ 硬件/ :/ 英特尔/ Intel/ ?/ Xeon/ ?/ E3/ -/ 1230CPU/ ,/ 3.30/ GHz/ ,/ 8GB/ 内存/ ,/ 显卡/ GeforceGTX650Ti/ ;/ (/ 2/ )/ 软件/ :/ VisualStudio2012/ ,/ Mitsuba/ ①/ ,/ OpenGL/ ./ 5.1/ 不可/ 压缩/ 流体/ 与/ 可/ 形变/ 固体/ 的/ 耦合/ 当/ 流体/ 与/ 固体/ 耦合/ 时/ ,/ 可/ 形变/ 固体/ 在/ 流体/ 的/ 作图/ 5/ 非线性/ 有限元/ 球体/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果/ 5.2/ 方法/ 对比/ 表/ 1/ 与/ 图/ 8/ 表示/ 在/ 怪兽/ 模型/ 上/ 分别/ 使用/ 文献/ [/ 3/ ,/ 5/ -/ 6/ ,/ 8/ ,/ 28/ -/ 29/ ]/ 与/ 本文/ 方法/ 进行/ 对比/ 的/ 仿真/ 实验/ 数据/ 和/ 流固/ 耦合/ 效果/ ,/ 所有/ 实验/ 均/ 使用/ 了/ 基于/ CUDA/ 的/ GPU/ 并行计算/ 来/ 对流/ 固/ 耦合/ 过程/ 进行/ 加速/ ./ 从表/ 1/ 和/ 图/ 8/ 的/ 结果/ 可以/ 看出/ ,/ 相比/ 于/ 其他/ 方法/ ,/ 本文/ 方法/ 减少/ 了/ 采样/ 粒子/ ,/ 具有/ 更/ 高/ 的/ 效率/ ,/ 且/ 实现/ 了/ 逼真/ 的/ 流固/ 耦合/ 仿真/ 效果/ ,/ 帧/ 率/ 达到/ 了/ 30.1/ fps/ ,/ 满足/ 仿真/ 的/ 实时性/ 要求/ ./ 实验/ 结果表明/ 本文/ 方法/ 在/ 保持/ 逼真/ 的/ 流固/ 耦合/ 仿真/ 效果/ 的/ 同时/ 降低/ 了/ 计算成本/ ./ 用下会/ 发生/ 形变/ ,/ 为了/ 在/ 固体/ 形变/ 时/ 仍/ 实现/ 逼真/ 的/ 流固/ 耦合/ 效果/ ,/ 本文/ 将/ 重新/ 根据/ 固体/ 形变/ 后/ 表面/ 局部/ 高斯曲率/ 重/ 采样/ 代理/ 粒子/ ,/ 并/ 根据/ 固体/ 表面/ 三角/ 面片/ 形变/ 的/ 大小/ 自/ 适应/ 地/ 改变/ 代理/ 粒子/ 的/ 切/ 向/ 光滑/ 核/ 半径/ 的/ 大小/ ./ 图/ 5/ 为/ 非线性/ 有限元/ 球体/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果/ ,/ 球体/ 在/ 水流/ 的/ 冲击/ 下/ 发生/ 较大/ 的/ 形变/ ,/ 而后/ 慢慢/ 恢复/ 原有/ 形状/ ./ 图/ 6/ 为/ 非线性/ 有限元/ 平板/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果/ ,/ 水流/ 冲击/ 平板/ 并/ 停留/ 在/ 其/ 上/ ,/ 造成/ 平板/ 的/ 形变/ ./ 图/ 7/ 为/ 非线性/ 有限元/ 怪兽/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果/ ,/ 水流/ 冲击/ 怪兽/ 模型/ 导致/ 其/ 弯曲/ ,/ 而后/ 恢复/ 原有/ 形状/ ./ 图/ 9/ 和/ 图/ 10/ 分别/ 展示/ 了/ 兔子/ 与/ 不可/ 压缩/ 流体/ 的/ 耦合/ 效果/ 的/ 流体/ 渲染/ 图/ 和/ 粒子/ 渲染/ 图/ ./ 实验/ 中/ ,/ 兔子/ 模型/ 的/ 非线性/ 有限元/ 单元/ 数为/ 3216/ ,/ 流体/ 粒子/ 数为/ 25920/ ,/ 均匀/ 采样/ 粒子/ 数为/ 32666/ ,/ 本文/ 方法/ 的/ 采样/ 粒子/ 数为/ 7055/ ./ 从图/ 9/ 和/ 图/ 10/ 的/ 对比/ 中/ 可以/ 得出/ 以下/ 结论/ ,/ 采用/ 均匀/ 采样/ [/ 3/ ,/ 5/ -/ 6/ ,/ 8/ ]/ 的/ 代理/ 粒子/ (/ 第/ 1/ 排/ 图片/ )/ 所/ 得到/ 的/ 耦合/ 仿真/ 效果/ 与/ 本文/ 方法/ (/ 第/ 2/ 排/ 图片/ )/ 所/ 得到/ 的/ 耦合/ 仿真/ 效果/ 没有/ 显著/ 的/ 差别/ ,/ 然而/ 对于/ 同样/ 的/ 仿真/ 场景/ 和/ 同样/ 的/ 兔子/ 模型/ ,/ 采用/ 自适/ ①/ http/ :/ // // www/ ./ mitsuba/ -/ renderer/ ./ org/ // Page10/ 图/ 6/ 非线性/ 有限元/ 平板/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果图/ 7/ 非线性/ 有限元/ 怪兽/ 模型/ 与/ 不可/ 压缩/ 流/ 的/ 耦合/ 效果/ 表/ 1/ 使用/ 不同/ 采样/ 方法/ 的/ 流固/ 耦合/ 实验/ 数据/ 对比/ 流体/ 粒子/ 数/ 模型/ 怪兽/ 怪兽/ 怪兽/ 怪兽/ 2000200020002000Page11/ 图/ 8/ 使用/ 不同/ 采样/ 方法/ 的/ 流固/ 耦合/ 效果图/ 9/ 采用/ 均匀/ 采样/ 方法/ (/ 第/ 1/ 排/ 图片/ )/ 和/ 本文/ 方法/ (/ 第/ 2/ 排/ 图片/ )/ 的/ 兔子/ 与/ 不可/ 压缩/ 流体/ 耦合/ 结果/ 流体/ 渲染/ 图应/ 代理/ 粒子/ 的/ 场景/ ,/ 其流固/ 耦合/ 仿真/ 帧/ 率/ 达到/ 了/ 19.3/ ,/ 而/ 采用/ 均匀/ 采样/ 的/ 代理/ 粒子/ 其帧/ 率/ 仅/ 为/ 5.6/ ,/ 由此可知/ 本文/ 方法/ 的/ 计算/ 效率/ 更高/ ,/ 获得/ 了/ 实时/ 逼真/ 的/ 流固/ 耦合/ 仿真/ 效果/ ./ 5.3/ 收敛性/ 分析/ 目前/ 比较/ 成熟/ 的/ SPH/ 方法/ ,/ 例如/ 文献/ [/ 3/ ]/ 和/ 文献/ [/ 20/ ]/ 中/ 的/ 方法/ ,/ 所有/ 粒子/ 的/ 支持/ 域/ 通常/ 为/ 球形/ 支持/ 域/ ,/ 且/ 已/ 具有/ 较/ 好/ 的/ 计算/ 收敛性/ ./ 本文/ 将/ 代理/ 粒子/ Page12/ 图/ 10/ 采用/ 均匀/ 采样/ 方法/ (/ 第/ 1/ 排/ 图片/ )/ 和/ 本文/ 方法/ (/ 第/ 2/ 排/ 图片/ )/ 的/ 兔子/ 与/ 不可/ 压缩/ 流体/ 耦合/ 结果/ 粒子/ 渲染/ 图/ 的/ 支持/ 域/ 设置/ 为/ 椭球/ 形/ ,/ 由于/ 代理/ 粒子/ 是/ 连接/ 不可/ 压缩/ 流体/ 和/ 非线性/ 有限元/ 固体/ 的/ 纽带/ ,/ 因此/ 我们/ 分别/ 从/ 流体/ 和/ 固体/ 的/ 角度/ 考察/ 将/ 球形/ 支持/ 域/ 改为/ 椭球/ 形/ 支持/ 域/ 后/ 对/ 收敛性/ 的/ 影响/ ./ 对/ 流体/ 而言/ ,/ 将/ 代理/ 粒子/ 的/ 支持/ 域/ 设置/ 为/ 椭球/ 形/ ,/ 将会/ 影响/ 着/ 支持/ 域/ 内部/ 所有/ 流体/ 粒子/ 的/ 状态/ (/ 受/ 影响/ 的/ 流体/ 粒子/ 集合/ 称为/ Q/ )/ ./ 因此/ 本文/ 主要/ 考察/ 粒子/ 集合/ Q/ 的/ 平均/ 密度/ 的/ 变化/ ,/ 如果/ Q/ 的/ 平均/ 密度/ 能够/ 收敛/ 到/ 初始化/ 密度/ 值/ (/ 初始化/ 密度/ 为/ 15/ )/ 附近/ ,/ 则/ 说明/ 将/ 代理/ 粒子/ 支持/ 域/ 设置/ 为/ 椭球/ 形后/ 仍/ 具有/ 良好/ 的/ 收敛性/ ,/ 能够/ 保证/ 液体/ 的/ 不/ 可压缩性/ ./ 且/ 本文/ 方法/ 与/ 代理/ 粒子/ 支持/ 域/ 为/ 球形/ 的/ 情形/ 进行/ 对比/ ,/ 当/ 代理/ 粒子/ 支持/ 域/ 为/ 球形/ 时/ ,/ 实际上/ 所有/ 流体/ 粒子/ 将/ 与/ 文献/ [/ 3/ ]/ 中/ 的/ IISPH/ 流体/ 情形/ 一致/ ,/ 而/ 文献/ [/ 3/ ]/ 中/ 已/ 证明/ IISPH/ 具有/ 良好/ 的/ 图/ 11/ 代理/ 粒子/ 球形/ 支持/ 域/ 与/ 椭球/ 形/ 支持/ 域/ 的/ 平均/ 密度/ 和/ 平均/ 速率/ 的/ 收敛性/ 对比/ 收敛性/ ./ 实验/ 结果/ 如图/ 11/ 所示/ ,/ 当/ 代理/ 粒子/ 支持/ 域/ 为/ 椭球/ 形时/ ,/ 流体/ 粒子/ 集合/ Q/ 的/ 平均/ 密度/ 将/ 收敛/ 于/ 初始化/ 密度/ 为/ 15/ 附近/ ,/ 且/ 与/ 支持/ 域/ 为/ 球形/ 时/ 的/ 收敛/ 情况/ 非常/ 接近/ ./ 实验/ 结果表明/ ,/ 代理/ 粒子/ 的/ 支持/ 域/ 设置/ 为/ 椭球/ 形/ 之后/ ,/ 本文/ 方法/ 中/ 流体/ 的/ 计算/ 仍/ 将/ 具有/ 良好/ 的/ 收敛性/ ./ 对/ 固体/ 而言/ ,/ 本文/ 将/ 固体/ 采样/ 粒子/ 的/ 支持/ 域/ 设置/ 为/ 椭球/ ,/ 并/ 将/ 采样/ 粒子/ 的/ 受力/ 通过/ 重心/ 映射/ 转换/ 为/ 固体/ 有限元/ 模型/ 顶点/ 的/ 受力/ ,/ 流固/ 耦合/ 发生/ 后/ ,/ 流体/ 和/ 固体/ 模型/ 最终/ 会/ 稳定下来/ ,/ 有限元/ 顶点/ 的/ 平均/ 速率/ 收敛/ 于/ 0/ ,/ 则/ 整个/ 系统/ 是/ 收敛/ 的/ ./ 将/ 本文/ 方法/ 与/ 将/ 支持/ 域/ 设为/ 球形/ 时/ 的/ 平均/ 速率/ 的/ 演变/ 进行/ 对比/ ,/ 实验/ 结果/ 如图/ 11/ 所示/ ,/ 当/ 代理/ 粒子/ 支持/ 域/ 分别/ 为/ 椭球/ 形/ 和/ 球形/ 时/ ,/ 其/ 速率/ 演变/ 非常/ 接近/ ,/ 最终/ 将/ 收敛/ 于/ Page130/ ,/ 这/ 说明/ 本文/ 方法/ 中/ 固体/ 的/ 计算/ 仍/ 将/ 具有/ 良好/ 的/ 收敛性/ ./ 5.1/ 节/ 、/ 5.2/ 节及/ 5.3/ 节/ 的/ 实验/ 结果表明/ ,/ 本文/ 的/ 方法/ 采样/ 的/ 代理/ 粒子/ 较/ 少/ ,/ 提高/ 了/ 流固/ 耦合/ 的/ 计算/ 效率/ ,/ 同时/ 获得/ 了/ 实时/ 稳定/ 逼真/ 的/ 流固/ 耦合/ 仿真/ 效果/ ./ 然而/ 本文/ 也/ 具有/ 一定/ 的/ 局限性/ ,/ 如/ 本文/ 方法/ 在/ 稀疏/ 的/ 采样/ 区域/ 内/ 的/ 耦合/ 力/ 在/ 平滑/ 长度/ 太大时/ 可能/ 产生/ 扭曲/ ./ 本文/ 方法/ 亦/ 未/ 对流/ 固/ 耦合/ 时/ 的/ 过/ 采样/ 以及/ 能量守恒/ 问题/ 进行/ 考虑/ ./ 6/ 总结/ 针对/ 非线性/ 有限元/ 固体/ 与/ IISPH/ 液体/ 的/ 耦合/ ,/ 本文/ 提出/ 了/ 一种/ 根据/ 固体/ 表面/ 模型/ 的/ 局部/ 高斯曲率/ 自/ 适应/ 采样/ 代理/ 粒子/ 的/ 新/ 方法/ ,/ 且/ 设计/ 代理/ 粒子/ 的/ 支持/ 域/ 为/ 椭球/ 形以/ 更/ 精确/ 地/ 实现/ 耦合/ ,/ 在/ 固体/ 形变/ 时自/ 适应/ 地重/ 采样/ 代理/ 粒子/ 以/ 防止/ 发生/ 穿透/ 现象/ ./ 本文/ 方法/ 将/ 计算资源/ 集中/ 于/ 几何/ 复杂/ 区域/ ,/ 同时/ 降低/ 了/ 代理/ 粒子/ 的/ 数量/ ./ 此外/ ,/ 本文/ 采用/ 基于/ CUDA/ 的/ GPU/ 并行计算/ 对流/ 固/ 耦合/ 过程/ 进行/ 加速/ ./ 实验/ 结果表明/ 本文/ 的/ 方法/ 提高/ 了/ 流固/ 耦合/ 的/ 计算/ 效率/ ,/ 同时/ 获得/ 了/ 实时/ 逼真/ 的/ 流固/ 耦合/ 仿真/ 效果/ ./ 在/ 未来/ 的/ 工作/ 中/ ,/ 我们/ 将/ 在/ 本文/ 方法/ 的/ 可行性/ 以及/ 局限性/ 方面/ 进行/ 改进/ ,/ 并/ 对流/ 固/ 耦合/ 过程/ 的/ 能量守恒/ 问题/ 进行/ 分析/ 以/ 完善/ 本文/ 方法/ ./ 此外/ ,/ 我们/ 会/ 考虑/ 增大/ 粒子/ 的/ 规模/ 并且/ 采用/ GPU/ 并行计算/ 以/ 仿真/ 大规模/ 应用/ 场景/ 中/ 的/ 流固/ 耦合/ ./ 

