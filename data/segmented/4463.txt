Page1/ 针对/ SSH/ 匿名/ 流量/ 的/ 网站/ 指纹/ 攻击/ 方法/ 顾晓丹/ 1/ )/ 杨明/ 1/ )/ 罗军舟/ 1/ )/ 蒋平/ 2/ )/ 1/ )/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 211189/ )/ 2/ )/ (/ 南京市/ 公安局/ 南京/ 210005/ )/ 摘要/ 目前/ 在/ Internet/ 上/ 广泛/ 部署/ 的/ SSH/ 单/ 代理/ 匿名/ 通信/ 系统/ 利用/ 其/ 动态/ 端口/ 转发/ 功能/ ,/ 在/ 用户/ 和/ 代理/ 之间/ 构建/ 加密/ 隧道/ ,/ 通过/ 对/ 数据/ 进行/ 加密/ 封装/ 和/ 转发/ ,/ 隐藏/ 用户/ 所/ 访问/ 站点/ 的/ 真实/ 地址/ ./ 为了/ 实现/ 对/ 匿名/ Web/ 访问/ 的/ 监管/ ,/ 现有/ 工作/ 基于/ 流量/ 分析/ 技术/ 提出/ 了/ 多种/ 针对/ 网站/ 主页/ 的/ 指纹/ 攻击/ 方法/ ,/ 但/ 在/ 如何/ 对/ 目标/ 网站/ 建模/ 、/ 如何/ 选择/ 区分度/ 高/ 的/ 流量/ 特征/ 以/ 提高/ 攻击/ 准确率/ 等/ 问题/ 上/ 仍/ 需/ 进一步/ 的/ 研究/ ./ 针对/ 这些/ 问题/ ,/ 深入分析/ SSH/ 匿名/ 流量/ 的/ 特征/ ,/ 提出/ 一种/ 新型/ 的/ 网站/ 指纹/ 攻击/ 方法/ ./ 该/ 方法/ 基于/ 上下行/ 流量/ 的/ 不同/ 特性/ ,/ 分别/ 抽取/ 不同/ 的/ 区分度/ 高/ 的/ 特征/ 形成/ 上下行/ 指纹/ ,/ 并/ 采取相应/ 的/ 匹配/ 算法/ 进行/ 指纹/ 比/ 对/ ./ 在/ 此基础/ 上/ ,/ 根据/ 用户/ 访问/ 关联/ Web/ 页面/ 的/ 行为/ 模式/ ,/ 对/ 所/ 监管/ 的/ 目标/ 网站/ 建立/ 隐/ 马尔科夫/ 模型/ ,/ 将/ 目前/ 只/ 针对/ 网站/ 主页/ 的/ 识别/ 扩展/ 到/ 了/ 多级/ 页面/ ./ 通过/ 使用/ 公开/ 数据/ 集/ 和/ 在/ Internet/ 环境/ 中/ 部署/ 实验/ 进行/ 验证/ ,/ 该/ 攻击/ 方法/ 获得/ 了/ 96.8/ %/ 的/ 准确率/ ,/ 可以/ 有效/ 地/ 识别/ 被/ 监管者/ 所/ 访问/ 的/ 网站/ ./ 关键词/ 匿名/ 通信/ ;/ 流量/ 分析/ ;/ 网站/ 指纹/ 攻击/ ;/ 隐/ 马尔科夫/ 模型/ 1/ 引言/ 随着/ Internet/ 的/ 飞速发展/ ,/ 人类/ 已/ 逐步/ 进入/ 了/ 信息/ 社会/ ./ 其中/ ,/ 日新月异/ 的/ Web/ 技术/ 正/ 不断/ 地/ 变革/ 着/ 人们/ 的/ 生活/ 和/ 工作/ 方式/ ./ 作为/ 现今/ 通信/ 与/ 信息/ 传播/ 的/ 主要/ 途径/ 之一/ ,/ Web/ 技术/ 承载/ 了/ 电子商务/ 、/ 网上银行/ 、/ 网络营销/ 、/ 网络/ 医疗/ 咨询/ 等/ 各种/ 在线/ 服务/ ,/ 用户/ 只/ 需要/ 通过/ 浏览器/ 就/ 能/ 获取/ 所/ 需/ 的/ 服务/ ./ 然而/ ,/ 这些/ 服务/ 都/ 会/ 存在/ 一定/ 程度/ 的/ 隐私/ 信息/ 交互/ 的/ 情况/ ,/ 使得/ 用户/ 在/ 需求/ 得到/ 满足/ 的/ 同时/ ,/ 对/ 自身/ 信息/ 隐私/ 性/ 的/ 担忧/ 也/ 愈加/ 强烈/ ./ 成熟/ 的/ 加密技术/ 的/ 使用/ 虽然/ 保障/ 了/ 用户/ 传输/ 的/ 信息/ 本身/ 的/ 安全性/ ,/ 但/ 这/ 并/ 不/ 意味着/ 用户/ 的/ 隐私/ 得到/ 了/ 充分/ 的/ 保护/ ,/ 攻击者/ 仍/ 可/ 根据/ 通信/ 对/ 端的/ 身份/ 等/ 未/ 被/ 隐藏/ 的/ 信息/ 对/ 用户/ 的/ 隐私/ 进行/ 推理/ 分析/ ./ 匿名/ 通信/ 技术/ 的/ 产生/ 与/ 兴起/ 在/ 很大/ 程度/ 上/ 缓解/ 了/ 这种/ 使用/ 障碍/ ./ 相比/ 于/ Tor/ [/ 1/ ]/ 等/ 多/ 跳/ 匿名/ 通信/ 系统/ 复杂/ 的/ 部署/ 和/ 较差/ 的/ 用户/ 体验/ ,/ 作为/ 单跳/ 的/ 匿名/ 通信/ 系统/ ,/ SSH/ (/ SecureShell/ )/ 加密/ 代理/ 得到/ 了/ 更为/ 广泛/ 的/ 部署/ 和/ 使用/ ./ SSH/ 在/ 用户/ 和/ 代理服务器/ 之间/ 构建/ 加密/ 隧道/ ,/ 通过/ 该/ 隧道/ 的/ 数据包/ 均/ 被/ 加密/ 封装/ ,/ 因此/ 攻击者/ 无法/ 查看/ 用户/ 的/ 通信/ 内容/ 和/ 其/ 真正/ 的/ 目的/ 地址/ ,/ 从而/ 保证/ 了/ 用户/ 的/ 隐私/ 信息/ 不/ 被/ 泄露/ ./ 虽然/ 匿名/ 通信/ 技术/ 的/ 初衷/ 是/ 为/ 用户/ 提供/ 隐私/ 保护/ 服务/ 使/ 其/ 个人信息/ 不/ 被/ 泄露/ ,/ 但/ 也/ 可能/ 会/ 被/ 网络/ 犯罪者/ 利用/ ,/ 掩盖/ 其/ 从事/ 的/ 恶意/ 犯罪活动/ ,/ 如/ 匿名/ 的/ 恐怖活动/ 、/ 传播/ 儿童/ 色情/ 信息/ 、/ 发布/ 反/ 社会/ 言论/ 、/ 散布/ 谣言/ 以及/ 敲诈勒索/ 等/ ,/ 造成/ 匿名/ 滥用/ ./ 由于/ 其/ 通信/ 内容/ 和/ 通信/ 关系/ 皆/ 被/ 隐藏/ ,/ 使得/ 普通/ 的/ 包/ 检测/ 技术/ 失效/ ,/ 很大/ 程度/ 上/ 阻碍/ 了/ 执法者/ 对/ 其/ 网络/ 行为/ 的/ 监控/ 与/ 审查/ ,/ 这/ 对/ 打击/ 网络/ 犯罪/ 和/ 网络/ 监管/ 提出/ 了/ 严峻/ 的/ 挑战/ ./ 针对/ 现实存在/ 的/ 匿名/ 滥用/ 问题/ ,/ 研究者/ 提出/ 了/ 多种/ 匿名/ 通信/ 追踪/ 技术/ ,/ 例如/ 使用/ 流水/ 印/ 攻击/ 技术/ [/ 2/ -/ 4/ ]/ ,/ 通过/ 在/ 目标/ 流量/ 中/ 主动/ 嵌入/ 流水/ 印/ ,/ 然后/ 在/ 嫌疑/ 的/ 目的/ 端/ 进行/ 检测/ 确认/ 两者/ 的/ 通信/ 关系/ ./ 然而/ 此类/ 方法/ 要求/ 攻击/ 实施者/ 能够/ 同时/ 监控/ 嫌疑/ 的/ 通信/ 两端/ 的/ 网络/ ,/ 攻击/ 成本/ 高/ ,/ 而且/ 攻击/ 效率/ 受/ 网络/ 延迟/ 、/ 抖动/ 等/ 影响/ 较大/ ./ 不同于/ 上述/ 主动/ 的/ 攻击/ 技术/ ,/ 网站/ 指纹/ 攻击/ 方法/ [/ 5/ -/ 7/ ]/ 采用/ 被动/ 的/ 流量/ 分析/ 技术/ ,/ 攻击者/ 只/ 需/ 配置/ 与/ 被/ 监管者/ 相/ 类似/ 的/ 网络/ 环境/ ,/ 并/ 使用/ 相同/ 的/ 加密/ 代理/ 技术/ 访问/ 每个/ 目标/ 站点/ ,/ 通过/ 分析/ 、/ 提取/ 和/ 比/ 对/ 所/ 产生/ 的/ 通信/ 流量/ 的/ 特征/ 来/ 识别/ 被/ 监管者/ 通信/ 对/ 端的/ 真实/ 地址/ ./ 现有/ 工作/ [/ 8/ -/ 13/ ]/ 已经/ 证明/ 了/ 网站/ 指纹/ 攻击/ 方法/ 的/ 可行性/ ,/ 但/ 在/ 如何/ 选择/ 合理/ 的/ 区分度/ 高/ 的/ 流量/ 特征/ 以/ 提高/ 攻击/ 准确率/ 等/ 方面/ 依然/ 有待/ 进一步/ 的/ 研究/ ./ 此外/ ,/ 这些/ 研究/ 工作/ 仅仅/ 关注/ 针对/ 目标/ 网站/ 主页/ 的/ 指纹/ 攻击/ ,/ 忽视/ 了/ 用户/ 在/ 浏览/ 主页/ 后/ 往往/ 会/ 对/ 其/ 关联/ 链接/ 的/ 页面/ 进行/ 访问/ 的/ 行为/ 模式/ ,/ 存在/ 一定/ 的/ 局限性/ ./ 本/ 论文/ 针对/ 上述/ 问题/ ,/ 提出/ 了/ 一种/ 新型/ 的/ 网站/ 指纹/ 攻击/ 方法/ ./ 主要/ 的/ 研究成果/ 包括/ :/ (/ 1/ )/ 在/ 对/ SSH/ 封装/ 的/ HTTP/ 流量/ 深入分析/ 的/ 基础/ 上/ ,/ 根据/ 上下行/ 流量/ 特征/ 的/ 区别/ ,/ 提出/ 了/ 抽取/ 不同/ 的/ 区分度/ 高/ 的/ 特征/ 分别/ 形成/ 上下行/ 指纹/ 的/ 方法/ ;/ (/ 2/ )/ 根据/ 所/ 提取/ 的/ 上下行/ 指纹/ 的/ 不同/ 特性/ ,/ 分别/ 采用/ 最长/ 公共/ 子串/ 算法/ 和/ 朴素/ 贝叶斯/ 分类器/ ,/ 进行/ 单个/ 页面/ 指纹/ 的/ 相似/ 度/ 匹配/ ;/ (/ 3/ )/ 根据/ 目标/ 网站/ 的/ 拓扑/ 结构/ ,/ 建立/ 对应/ 的/ 隐/ 马尔科夫/ 模型/ (/ HiddenMarkovModel/ ,/ HMM/ )/ ,/ 将/ 现有/ 的/ 只/ 针对/ 网站/ 主页/ 的/ 指纹/ 攻击/ 扩展/ 到/ 多级/ 页面/ ,/ 从而/ 识别/ 整个/ 站点/ ./ 通过/ 大规模/ 的/ 实验/ 验证/ ,/ 该/ 攻击/ 方法/ 获得/ 了/ 96.8/ %/ 的/ 检测/ 率/ ,/ 证明/ 了/ 所/ 抽取/ 指纹/ 特征/ 的/ 高/ 区分/ 性/ 以及/ 攻击/ 方法/ 的/ 高效性/ ./ 本文/ 第/ 2/ 节/ 简要/ 介绍/ 目前/ 网站/ 指纹/ 攻击/ 方面/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 基于/ SSH/ 代理/ 的/ 工作/ 原理/ ,/ 描述/ 所/ 采用/ 的/ 攻击/ 模型/ ;/ 第/ 4/ 节/ 深入分析/ HTTP/ 和/ SSH/ 协议/ ,/ 详细/ 阐述/ 所/ 提出/ 的/ 网站/ 指纹/ 攻击/ 方法/ ,/ 将/ 单/ 页面/ 的/ 指纹/ 攻击/ 扩展/ 到/ 多级/ 页面/ ;/ 第/ 5/ 节/ 通过/ 大规模/ 的/ 实验/ 证明/ 所/ 抽取/ 指纹/ 特征/ 的/ 高/ 区分/ 性/ 以及/ 该/ 攻击/ 方法/ 的/ 高效性/ ;/ 最后/ 一节/ 总结/ 全文/ 并/ 指出/ 下/ 一步/ 的/ 工作/ ./ 2/ 相关/ 工作/ 网站/ 指纹/ 攻击/ 是/ 伴随/ 着/ 匿名/ 技术/ 的/ 产生/ 而/ 出现/ 的/ ./ 当/ 加密技术/ 最初/ 被/ 引入/ 蓬勃发展/ 的/ Web/ 应用/ 时/ ,/ 在/ 实际/ 网络/ 环境/ 下/ 部署/ 和/ 使用/ 的/ 是/ HTTP/ // 1.0/ 协议/ ./ 该/ 版本/ 协议/ 规定/ 对于/ 每个/ 被/ 请求/ 的/ 对象/ (/ object/ )/ Page3/ 都/ 会/ 建立/ 一条/ 新/ 的/ TCP/ 连接/ ,/ 且/ 一旦/ 该/ 对象/ 传输/ 完成/ ,/ 就/ 会/ 关闭/ 对应/ 的/ TCP/ 连接/ ./ 由于/ 此时/ 的/ 匿名/ 技术/ 研究/ 还/ 处在/ 起步/ 阶段/ ,/ 主要/ 是/ 通过/ 简单/ 的/ SSL/ 加密/ 来/ 提供/ 隐私/ 保护/ 服务/ ./ 该/ 技术/ 只是/ 单纯/ 地/ 加密/ TCP/ 通信/ 内容/ ,/ 并/ 不会/ 改变/ 所/ 传输/ 流量/ 的/ 特征/ ./ 利用/ 这一/ 缺陷/ ,/ 研究者/ 在/ 进行/ 匿名/ Web/ 流量/ 的/ 特征/ 选取/ 时/ ,/ 主要/ 采用/ 了/ 每个/ 站点/ 主页/ 中/ 对象/ 的/ 个数/ 和/ 长度/ 作为/ 原始/ 特征/ ./ Hintz/ [/ 5/ ]/ 针对/ 加密/ 代理/ SafeWeb/ 存在/ 的/ 安全隐患/ ,/ 首次/ 阐述/ 了/ 网站/ 指纹/ 攻击/ 的/ 概念/ ,/ 并/ 在/ 理论/ 上/ 分析/ 和/ 证明/ 了/ 该/ 方法/ 的/ 可行性/ 及/ 有效性/ ./ Sun/ 等/ 人/ [/ 6/ ]/ 同样/ 也/ 发现/ 了/ 此类/ SSL/ 代理/ 存在/ 的/ 漏洞/ ,/ 在/ S/ &/ P2002/ 会议/ 上/ 提出/ 了/ 网站/ 指纹/ 攻击/ 方法/ ,/ 并/ 阐述/ 了/ 其/ 进行/ 的/ 大/ 样本量/ 的/ 实验/ :/ 针对/ 每个/ 目标/ 页面/ 所/ 产生/ 的/ TCP/ 连接/ 计算/ 其/ 个数/ 和/ 响应/ 报文/ 的/ 长度/ 总和/ ,/ 从而/ 获得/ 页面/ 对象/ 的/ 数量/ 及/ 大小/ ,/ 形成/ 指纹/ 建立/ 特征/ 库/ ;/ 随后/ 使用/ Jaccard/ 系数/ 方法/ 计算/ 其/ 与/ 用户/ 模拟/ 访问/ 所/ 产生/ 指纹/ 的/ 相似/ 度/ ,/ 并/ 选择/ 相似/ 度/ 最高/ 的/ 站点/ 作为/ 用户/ Web/ 访问/ 的/ 辨识/ 结果/ ./ 随着/ HTTP/ // 1.1/ 协议/ 的/ 推广/ 以及/ 匿名/ 技术/ 的/ 日趋/ 成熟/ ,/ 一方面/ 浏览器/ 在/ 访问/ Web/ 页面/ 时/ 采用/ 了/ 持久/ 连接/ (/ PersistentConnections/ )/ 和/ 流水线/ (/ Pipe/ -/ lining/ )/ 技术/ ,/ 另一方面/ 多种/ 单跳/ 或/ 多/ 跳/ 匿名/ 通信/ 系统/ 例如/ SSH/ 加密/ 代理/ 、/ Tor/ 匿名/ 网络/ 等/ 相继/ 被/ 提出/ ./ 此类/ 匿名/ 系统/ 会/ 在/ 其/ 和/ 用户/ 之间/ 建立/ 一条/ 加密/ 隧道/ ,/ 将/ 浏览器/ 发起/ 的/ TCP/ 连接/ 映射/ 到/ 不同/ 的/ 信道/ ./ 上述/ 多种/ 技术/ 的/ 应用/ 导致/ 了/ 攻击者/ 无法/ 使用/ 之前/ 的/ 方法/ 计算/ 每个/ 页面/ 含有/ 的/ 对象/ 数量/ 及/ 长度/ 来/ 形成/ 指纹/ ./ 经过/ 进一步/ 的/ 深入研究/ ,/ 研究/ 人员/ 相继/ 采用/ 了/ 一些/ 新/ 的/ 流量/ 特征/ 和/ 相似/ 度/ 对比/ 方法/ ./ Bissias/ 等/ 人/ [/ 7/ ]/ 首次/ 提出/ 将/ 每次/ 通信/ 时/ 产生/ 的/ 所有/ 响应/ 报文/ 的/ 长度/ 和/ 报文/ 之间/ 的/ 间隔时间/ 作为/ 原始/ 特征/ ,/ 使用/ 交叉/ 关联/ (/ CrossCorrelation/ )/ 方法/ 针对/ 单个/ 特征/ 及/ 联合/ 特征/ 分别/ 计算/ 指纹/ 相似/ 度/ 进行/ 身份/ 识别/ ,/ 考察/ 所/ 选/ 特征/ 的/ 可/ 区分度/ ./ 实验/ 结果表明/ ,/ 报文/ 长度/ 特征/ 的/ 识别/ 准确率/ 远高于/ 报文/ 之间/ 的/ 间隔时间/ ./ 此外/ ,/ 作者/ 还/ 指出/ 指纹/ 库/ 建立/ 和/ 攻击/ 实施/ 之间/ 的/ 延迟时间/ 只会/ 轻微/ 影响/ 网站/ 指纹识别/ 的/ 准确率/ ./ 而/ Liberatore/ 等/ 人/ [/ 8/ ]/ 吸取/ 了/ 之前/ 工作/ 的/ 研究成果/ ,/ 仅/ 采用/ Web/ 访问/ 时/ 产生/ 的/ 报文/ 长度/ 分布/ 这个/ 流量/ 特征/ 生成/ 指纹/ ./ 在/ 识别/ 方面/ ,/ 则/ 首次/ 使用/ 了/ 机器/ 学习/ 领域/ 中/ 成熟/ 的/ 分类/ 技术/ ,/ 即/ 采用/ 朴素/ 贝叶斯/ 分类器/ (/ NaiveBayesClassifier/ )/ 进行/ 相似/ 度/ 的/ 评估/ ./ 作者/ 为了/ 验证/ 其/ 攻击/ 方法/ 的/ 现实/ 可行性/ ,/ 针对/ 黑名单/ 站点/ 列表/ 中/ 1000/ 个/ 网站/ 进行/ 了/ 实验/ ,/ 获得/ 了/ 73/ %/ 的/ 准确率/ ./ 同时/ ,/ 作者/ 还/ 证明/ 了/ 在/ 嗅/ 探/ 用户/ 访问/ 产生/ 的/ 匿名/ 流量/ 后/ 再/ 进行/ 指纹/ 库/ 建立/ 的/ 可行性/ ,/ 为/ 数字/ 取证/ 技术/ 发展/ 提供/ 了/ 有力/ 的/ 实验/ 依据/ ./ 为了/ 便于/ 其他/ 研究者/ 进行/ 研究/ ,/ Liberatore/ 等/ 人/ 公布/ 了/ 他们/ 的/ 数据/ 集/ OpenSSH2000/ ,/ 并/ 在/ CCS2006/ 会议/ 上/ 发表/ 了/ 他们/ 的/ 研究成果/ ./ Herrmann/ 等/ 人/ [/ 9/ ]/ 在/ 此基础/ 上/ 进行/ 了/ 改进/ ,/ 在/ 特征/ 抽取/ 方面/ 同样/ 选择/ 了/ 链路/ 上/ 产生/ 的/ 双向/ 的/ 报文/ 长度/ 分布/ ,/ 并/ 采用/ 文本/ 挖掘/ 中权值/ 计算技术/ 对/ 特征向量/ 进行/ 标准化/ ,/ 然后/ 再/ 使用/ 多项式/ 朴素/ 贝叶斯/ 分类器/ (/ MultinomialNaiveBayesClassifier/ )/ 进行/ 分类/ ./ 不同于/ Liberatore/ 的/ 工作/ 只/ 关注/ 某个/ 长度/ 的/ 数据包/ 是否/ 出现/ ,/ Herrmann/ 等/ 人/ 还/ 考虑/ 了/ 该/ 长度/ 的/ 数据包/ 出现/ 的/ 频率/ ./ 相对/ 于/ 大部分/ 研究/ 工作/ 只/ 关心/ 报文/ 长度/ ,/ Lu/ 等/ 人/ [/ 10/ ]/ 提出/ 多次/ 访问/ 相同/ 站点/ 时/ 产生/ 的/ 匿名/ 流量/ 在/ 报文/ 顺序/ 上/ 也/ 非常/ 的/ 相似/ ./ 他们/ 利用/ 报文/ 长度/ 和/ 顺序/ 作为/ 特征/ ,/ 针对/ 每个/ 目标/ 站点/ 的/ 主页/ 形成/ 2/ 个/ 报文/ 长度/ 序列/ (/ 请求/ 序列/ 和/ 响应/ 序列/ )/ ,/ 并/ 使用/ 编辑/ 距离/ (/ EditDistance/ )/ 计算/ 相似/ 度/ 进行/ 比/ 对/ ,/ 实验/ 结果表明/ 该/ 方法/ 对于/ 经过/ 变形/ 的/ 流量/ 仍然/ 有效/ ./ Ling/ 等/ 人/ [/ 11/ ]/ 则/ 认为/ 除了/ 报文/ 长度/ 、/ 顺序/ 等/ 特征/ 以外/ ,/ 用户/ 与/ Web/ 站点/ 之间/ 的/ RTT/ 的/ 统计/ 信息/ 也/ 可以/ 用来/ 推断/ 用户/ 所/ 访问/ 站点/ 的/ 真实/ 地址/ ./ 作者/ 提取/ RTT/ 的/ 样本均值/ 和/ 样本/ 方差/ 作为/ 分类/ 特征/ ,/ 并/ 使用/ 贝叶斯/ 分类/ 算法/ 进行/ 决策/ ./ 另外/ ,/ 他们/ 还/ 在/ 理论/ 上/ 分析/ 了/ 该/ 攻击/ 方法/ 可/ 正确/ 识别/ 一个/ 目标/ 站点/ 的/ 概率/ ./ 不同于/ SSH/ 代理/ 这类/ 单/ 跳/ 的/ 匿名/ 系统/ ,/ 一些/ 低/ 延迟/ 的/ 多/ 跳/ 匿名/ 通信/ 系统/ ,/ 例如/ Tor/ 、/ JAP/ 等/ ,/ 会/ 将/ 转发/ 的/ 流量/ 填充/ 成等/ 长信/ 元/ ./ 这种/ 处理/ 机制/ 破坏/ 了/ 报文/ 长度/ 这一/ 关键/ 特征/ ,/ 导致/ 提取/ 的/ 特征/ 失效/ ./ 针对/ 这一/ 问题/ ,/ Panchenko/ 等/ 人/ [/ 12/ ]/ 基于/ Tor/ 等/ 匿名/ 系统/ 的/ 特性/ ,/ 就/ 流量/ 的/ 大小/ 、/ 时间/ 和/ 方向/ 等/ 方面/ ,/ 提出/ 了/ 多种/ 新/ 的/ 有效/ 特征/ 形成/ 指纹/ ,/ 然后/ 使用/ 支持/ 向量/ 机/ (/ SupportVectorMachine/ )/ 进行/ 分类/ ./ 实验/ 结果表明/ 即使/ 在/ 多/ 跳/ 的/ 低/ 延迟/ 匿名/ 通信/ 系统/ 下/ ,/ 指纹/ 攻击/ 方法/ 仍然/ 可行/ ,/ 并且/ 将/ Tor/ 下/ 的/ 攻击/ 准确率/ 由/ 3/ %/ 提高/ 到/ 55/ %/ 、/ JAP/ 下/ 的/ 准确率/ 由/ 20/ %/ 提高/ 到/ 80/ %/ ./ 而/ Yu/ 等/ 人/ [/ 13/ ]/ 放弃/ 了/ 常用/ 的/ 包长/ 等/ 流量/ 特征/ ,/ 关注/ 目标/ 用户/ 的/ 行为/ 模式/ ,/ 第一次/ 提出/ 了/ 将/ 用户/ 访问/ 一个/ 网页/ 所/ 花费/ 的/ 时间/ 作为/ 特征/ ,/ 并/ 采用/ 隐/ 马尔科夫/ 模型/ 来/ 对/ 目标/ 网站/ 进行/ 建模/ ./ 但/ 由于/ 此/ 攻击/ 仅/ 依赖于/ 浏览/ 网页/ 所/ 耗费/ 时间/ 这一/ 动态性/ 极强/ 的/ 特征/ ,/ 降低/ 了/ 该/ 方法/ 的/ 鲁棒性/ ./ 此外/ ,/ 攻击/ 实施者/ 还/ 必须/ 对/ 用户/ Page4/ 的/ 明文/ 流量/ 进行/ 建模/ 获取/ 其/ 访问/ 目标/ 站点/ 的/ 时间/ 动态性/ ,/ 对/ 攻击者/ 的/ 能力/ 要求/ 较/ 高/ ./ 研究/ 人员/ 在/ 提出/ 新/ 的/ 网站/ 指纹/ 攻击/ 方法/ 的/ 同时/ ,/ 也/ 给出/ 了/ 一些/ 他们/ 认为/ 有效/ 的/ 规避/ 措施/ ,/ 例如/ 包/ 填充/ 、/ 流量/ 变形/ 等/ [/ 14/ ]/ ./ 通过/ 大幅度/ 地/ 改变/ 指纹/ 特征/ ,/ 试图/ 降低/ 现有/ 的/ 依靠/ 指纹/ 相似/ 度/ 匹配/ 的/ 攻击/ 方法/ 的/ 检测/ 准确率/ ./ 但/ 在/ S/ &/ P2012/ 会议/ 上/ ,/ Dyer/ 等/ 人/ [/ 15/ ]/ 证明/ 了/ 这些/ 规避/ 措施/ 并/ 不能/ 很/ 好/ 地/ 抵御/ 网站/ 指纹/ 攻击/ ./ 他们/ 使用/ 现有/ 的/ 指纹/ 攻击/ 方法/ ,/ 针对/ 9/ 种包/ 填充/ 和/ 流量/ 变形/ 的/ 规避/ 措施/ 进行/ 了/ 大量/ 的/ 实验/ ./ 结果表明/ ,/ 当/ 目标/ 站点/ 列表/ 集/ 等于/ 128/ 时/ ,/ 仍能/ 获得/ 80/ %/ 左右/ 的/ 准确率/ ./ Cai/ 等/ 人/ [/ 16/ ]/ 则/ 针对/ 应用层/ 的/ 抵御/ 措施/ ,/ 如/ HTTPOS/ [/ 17/ ]/ 、/ Tor/ 中/ 的/ 随机/ 流水线/ 技术/ ①/ 等/ ,/ 通过/ 提取/ 匿名/ 流量/ 中/ 数据包/ 长/ 和/ 顺序/ 等/ 特征/ 形成/ 指纹/ ,/ 获得/ 了/ 较/ 好/ 的/ 识别/ 结果/ ./ 这/ 就/ 意味着/ 即使/ 耗费/ 高额/ 成本/ 去/ 实施/ 大量/ 的/ 抵御/ 措施/ ,/ 也/ 无法/ 高效/ 地/ 降低/ 指纹/ 攻击/ 的/ 准确率/ ./ 上文/ 所述/ 的/ 攻击/ 方法/ 忽视/ 了/ 上下行/ 流量/ 特性/ 不同/ 的/ 事实/ ,/ 在/ 特征/ 抽取/ 时/ ,/ 对于/ 上下行/ 流量/ 均/ 选择/ 了/ 相同/ 的/ 流量/ 特征/ 来/ 生成/ 指纹/ ,/ 降低/ 了/ 网站/ 指纹/ 攻击/ 的/ 准确率/ ./ 本文/ 通过/ 对/ SSH/ 封装/ 的/ 匿名/ 流量/ 的/ 深入分析/ ,/ 分别/ 从/ 上下行/ 数据包/ 中/ 提取/ 不同/ 的/ 特征/ 生成/ 指纹/ ./ 在/ 指纹/ 比/ 对/ 阶段/ 亦/ 基于/ 所比/ 对/ 指纹/ 的/ 属性/ 特征选择/ 了/ 合适/ 的/ 匹配/ 算法/ ./ 此外/ ,/ 现有/ 工作/ 仅/ 针对/ 目标/ 网站/ 的/ 主页/ 进行/ 指纹/ 匹配/ 攻击/ ,/ 但/ 真实/ 情景/ 是/ 用户/ 在/ 访问/ 网站/ 时/ 经常/ 会/ 连续/ 地/ 访问/ 关联/ 链接/ 页面/ ./ 根据/ 这种/ 访问/ 模式/ ,/ 本文/ 将/ 引入/ 隐/ 马尔科夫/ 模型/ ,/ 将/ 单/ 页面/ 的/ 指纹/ 扩展/ 到/ 多级/ 页面/ 的/ 联合/ 指纹/ ,/ 可以/ 更/ 高效/ 地/ 进行/ 网站/ 指纹/ 攻击/ ./ 在/ 方法/ 有效性/ 验证/ 部分/ ,/ 为了/ 体现/ 结果/ 的/ 可比性/ ,/ 论文/ 也/ 在/ OpenSSH2000/ 数据/ 集/ [/ 8/ ]/ 上/ 进行/ 了/ 相关/ 实验/ ./ 3/ 攻击/ 模型/ 由于/ 目前/ SSH/ 加密/ 代理/ 已/ 被/ 广泛/ 地/ 部署/ ,/ 其/ 用户/ 人数/ 远超过/ Tor/ 等/ 多/ 跳/ 匿名/ 通信/ 系统/ ,/ 本文/ 将/ 针对/ SSH/ 封装/ 的/ 匿名/ Web/ 流量/ 进行/ 网站/ 指纹/ 攻击/ 方法/ 的/ 研究/ ./ SSH/ 协议/ 使用/ 身份/ 认证/ 和/ 非对称/ 加密技术/ ,/ 保证/ SSH/ 客户端/ 和/ 服务器之间/ 远程/ 登录/ 、/ 数据传输/ 和/ 其他/ 网络服务/ 的/ 安全性/ ./ SSH/ 代理/ 利用/ 其/ 协议/ 中/ 提出/ 的/ 动态/ 端口/ 转发/ 功能/ ,/ 将/ 其他/ TCP/ 端口/ 的/ 报文/ 通过/ SSH/ 加密/ 隧道/ 进行/ 转发/ ./ 如图/ 1/ 所示/ ,/ 通过/ 配置/ 本地/ 监听/ 端口/ ,/ 并/ 在/ 具体/ 的/ 应用程序/ 中将/ 本/ 机/ 地址/ 和/ 监听/ 端口/ 设置/ 为/ SOCKS/ 代理/ ,/ 则/ 该/ 应用程序/ 产生/ 的/ 所有/ 数据包/ 都/ 会/ 被/ 本地/ 监听/ 端口/ 转发给/ SSHClient/ ,/ 然后/ 通过/ 加密/ 隧道/ 到达/ SSH/ 代理服务器/ ./ 在/ 这/ 一/ 过程/ 中/ ,/ 转发/ 报文/ 的/ 内容/ 和/ 目的/ 地址/ 均/ 被/ 加密/ 封装/ ,/ 外部/ 攻击者/ 无法/ 获知/ 通信/ 数据/ 的/ 内容/ ,/ 也/ 不/ 知道/ 用户/ 真正/ 的/ 通信/ 目标/ ,/ 从而/ 保证/ 了/ 用户/ 的/ 通信/ 关系/ 和/ 通信/ 内容/ 的/ 隐私/ 安全/ ./ 此后/ SSH/ 代理会/ 根据/ 解密/ 后/ 数据包/ 中/ 的/ 目的/ 地址/ ,/ 和/ 真正/ 的/ 通信/ 目的/ 端/ 进行/ 数据/ 交互/ ,/ 并/ 将/ 接收/ 到/ 的/ 数据包/ 通过/ 相同/ 的/ 加密/ 隧道/ 转发给/ 用户/ ./ 针对/ SSH/ 代理/ 提供/ 的/ 匿名/ 保护/ 服务/ ,/ 网络/ 监管者/ 一方面/ 无法/ 在/ 有限/ 的/ 时间/ 内/ 对/ 加密/ 数据/ 进行/ 密码/ 破译/ ;/ 另一方面/ ,/ 由于/ 网络/ 监管者/ 难以/ 具有/ 监控/ 全局/ 网络/ 信息/ 的/ 能力/ ,/ 从而/ 也/ 无法/ 使用/ 深度/ 包/ 检测/ 等/ 常用/ 技术/ 对/ 被/ 监管者/ 的/ 网络/ 行为/ 进行/ 审/ 和/ 管理/ ./ 鉴于/ 监管者/ 的/ 监测/ 能力/ 受限/ ,/ 现有/ 研究/ 工作/ 都/ 采用/ 了/ 如下/ 的/ 攻击/ 模型/ :/ 被/ 监管者/ 通过/ SSH/ 代理/ 进行/ Web/ 站点/ 的/ 访问/ ,/ 攻击者/ 仅/ 可以/ 在/ 被/ 监管者/ 和/ SSH/ 代理/ 之间/ 嗅探/ 并/ 记录/ 交互/ 的/ 报文/ (/ 如图/ 2/ 所示/ )/ ./ 通过/ 嗅探/ ,/ 攻击者/ 可以/ 获得/ 关于/ 报文/ 长度/ 、/ 时间/ 等/ 方面/ 的/ 少量/ 信息/ ./ 网站/ 指纹/ 攻击/ 方法/ 采用/ 被动/ 的/ 流量/ 分析/ 技术/ ,/ 基于/ 流量/ 模式匹配/ 的/ 思想/ 来/ 识别/ 被/ 监管者/ 所/ 访问/ 的/ 真实/ 地址/ ./ 为了/ 提高/ 指纹/ 攻击/ 方法/ 的/ 部署/ 可行性/ ①/ Experimentaldefenseforwebsitetrafficfingerprinting/ ./ https/ :/ fic/ -/ fingerprinting/ ,/ 2011Page5/ 和/ 工程/ 可用性/ ,/ 本文/ 采用/ 与/ 现有/ 工作/ 相同/ 的/ 前提/ 假设/ :/ 入/ 环境/ ./ (/ 1/ )/ 攻击者/ 可以/ 配置/ 类似/ 于/ 被/ 监管者/ 的/ 网络/ 接/ (/ 2/ )/ 攻击者/ 拥有/ 一个/ 黑名单/ 站点/ 列表/ ,/ 并/ 能/ 使用/ 和/ 被/ 监管者/ 相同/ 的/ SSH/ 代理服务器/ 进行/ 站点/ 访问/ ,/ 从而/ 建立/ 对应/ 的/ 指纹/ 库/ ./ (/ 3/ )/ 攻击者/ 掌握/ 被/ 监管者/ 所/ 使用/ 浏览器/ 的/ 配置/ 信息/ ,/ 并/ 能/ 进行/ 相同/ 的/ 配置/ ,/ 例如/ 使用/ HTTP/ // 1.1/ 协议/ 、/ 禁用/ cache/ 、/ 关闭/ 插件/ 等/ ./ (/ 4/ )/ 攻击者/ 可以/ 根据/ 页面/ 请求/ 过程/ 中/ 的/ 时间/ 间隔/ 等/ 信息/ 从/ 嗅/ 探/ 得到/ 的/ 数据/ 中/ 提取/ 出/ 属于/ 同一个/ 页面/ 的/ 数据包/ ./ 4/ 针对/ SSH/ 匿名/ 流量/ 的/ 网站/ 指纹/ 攻击/ 本/ 节/ 首先/ 详细分析/ 了/ 经过/ SSH/ 封装/ 的/ HTTP/ 流量/ 的/ 特性/ ;/ 然后/ ,/ 在/ 此基础/ 上/ 对于/ 上下行/ 数据包/ 提取/ 不同/ 的/ 特征/ 分别/ 形成/ 上下行/ 指纹/ ,/ 并/ 采用/ 对应/ 的/ 匹配/ 算法/ 进行/ 单/ 页面/ 的/ 指纹/ 比/ 对/ ;/ 最后/ 根据/ 被/ 监管者/ 的/ Web/ 访问/ 模式/ ,/ 基于/ 网站/ 主页/ 和/ 次级/ 页面/ 的/ 链图/ 3HTTP/ 协议/ 各/ 版本/ 特点/ 但/ 随着/ HTTP/ // 1.1/ 的/ 普遍/ 应用/ ,/ 其/ 支持/ 的/ 持久/ 连接/ 和/ 流水线/ 技术/ 隐藏/ 了/ 这些/ 特征/ ./ 持久/ 连接/ 技术/ 是/ 指/ 服务器/ 在/ 发出/ 响应/ 后/ 仍/ 维持/ 该/ TCP/ 连接/ ,/ 后续/ 接/ 关系/ ,/ 建立/ 对应/ 的/ 隐/ 马尔科夫/ 模型/ ,/ 将/ 现有/ 的/ 只/ 针对/ 主页/ 的/ 指纹/ 攻击/ 扩展/ 到/ 多/ 页面/ ,/ 实现/ 针对/ SSH/ 匿名/ 流量/ 的/ 网站/ 指纹/ 攻击/ ./ 4.1/ HTTPoverSSH/ 流量/ 分析/ 网站/ 指纹/ 攻击/ 方法/ 最初/ 提出/ 的/ 时候/ ,/ Internet/ 上/ 广泛/ 部署/ 的/ 是/ HTTP/ // 1.0/ 协议/ ./ 该/ 版本/ 协议/ 采用/ 非/ 持久/ 模式/ ,/ 每个/ TCP/ 连接/ 只能/ 交互/ 一个/ 请求/ 消息/ 和/ 对应/ 的/ 响应/ 消息/ ,/ 在/ 服务器端/ 传送/ 完/ 一个/ 对象/ 后/ 就/ 会/ 关闭/ 该/ TCP/ 连接/ ,/ 使/ 之/ 无法/ 持续/ 传输/ 其他/ 对象/ ./ 这/ 就/ 意味着/ ,/ 针对/ 载入/ 的/ 页面/ 中/ 每个/ 待/ 请求/ 的/ 对象/ ,/ HTTP/ 的/ 客户端/ (/ 浏览器/ )/ 都/ 会/ 建立/ 并/ 维护/ 一个/ 新/ 的/ TCP/ 连接/ ./ 如图/ 3/ 所示/ ,/ 当/ 浏览器/ 进行/ 页面/ 访问/ 时/ ,/ 会/ 和/ Web/ 服务器/ 建立/ 一条/ TCP/ 连接/ Connection1/ 来/ 发送/ Requeset1/ ;/ 当/ 响应/ Response1/ 发送/ 完毕/ 后/ ,/ 该/ 连接/ 断开/ ./ 当要/ 发送/ Requeset2/ 请求/ 时则/ 会/ 重新/ 进行/ 三次/ 握手/ 建立/ 连接/ Connection2/ ,/ 以此类推/ 进行/ 后续/ 的/ 数据/ 交互/ 操作/ ./ 通过/ 嗅探/ 数据/ 可以/ 获得/ 一个/ 网页/ 的/ TCP/ 连接/ 个数/ 及/ 每个/ 连接/ 传送/ 的/ 数据/ 总量/ ,/ 即/ 对应/ 了/ 该/ 页面/ 的/ 对象/ 个数/ 及/ 大小/ ./ 早期/ 的/ 网站/ 指纹/ 攻击/ 技术/ 使用/ 这些/ 信息/ 作为/ 指纹/ 特征/ ,/ 识别/ 效果/ 十分/ 显著/ ./ 请求/ 和/ 响应/ 都/ 可以/ 通过/ 这个/ 连接/ 进行/ 交互/ ./ 如图/ 3/ 中/ ,/ Connection1/ 在/ 传输/ 完/ Response1/ 后/ ,/ 并/ 没有/ 断开连接/ ,/ 而是/ 继续/ 发出/ 了/ Requeset3/ 进行/ 后续/ 对/ Page6/ 象/ 的/ 请求/ ./ 在/ 流水线/ 模式/ 下/ ,/ HTTP/ 客户端/ 在/ Html/ 页面/ 解析/ 时/ 每/ 遇到/ 一个/ 对象/ 引用/ 就/ 立即/ 发出/ 一个/ 请求/ ,/ 允许/ 连续/ 发出/ 多个/ 请求/ ./ 服务器端/ 收到/ 这些/ 请求/ 后/ ,/ 按/ 顺序/ 响应/ ,/ 即/ 对应/ 图中/ HTTP1/ ./ 1/ (/ 流水线/ )/ 部分/ ,/ Connection1/ 发出/ Requeset1/ 请求/ 后/ 不/ 需要/ 等待/ 其/ 响应/ Response1/ 返回/ ,/ 可以/ 继续/ 发送/ Requeset3/ 、/ Requeset5/ 请求/ ./ 而/ 此时/ 服务器/ 会/ 顺序/ 地/ 响应/ Response1/ 、/ Response3/ 和/ Response5/ ./ 如上所述/ ,/ 从/ 嗅/ 探/ 的/ 加密/ 数据包/ 中/ 无法/ 获得/ 反映/ 页面/ 对象/ 个数/ 及/ 大小/ 的/ 特征/ ./ 再/ 加上/ 使用/ SSH/ 代理/ 进行/ HTTP/ 访问/ 的/ 时候/ ,/ SSH/ 协议/ 规定/ 了/ 所有/ 的/ 流量/ 都/ 必须/ 通过/ 加密/ 链路/ 转发/ 到/ 同一个/ 端口/ (/ 默认/ 为/ 22/ )/ ,/ 多/ TCP/ 连接/ 被/ 映射/ 到/ 同一个/ SSH/ 链路/ 的/ 多个/ 信道/ ,/ 导致/ 数据包/ 嗅探/ 无法/ 区分/ 每个/ TCP/ 连接/ 产生/ 的/ 数据包/ ./ 同时/ ,/ 多/ 信道/ 的/ 并行传输/ 也/ 使得/ 数据包/ 之间/ 的/ 顺序/ 存在/ 一定/ 扰乱/ ./ 尤其/ 对于/ 下行/ 数据/ ,/ 因为/ 它/ 主要/ 传输/ 页面/ 中/ 嵌入/ 对象/ 的/ 内容/ ,/ 相/ 较/ 上行/ HTTP/ 请求/ 多出/ 了/ 很多/ 的/ 数据包/ ,/ 使得/ 包/ 顺序/ 具有/ 很大/ 的/ 不稳定性/ ,/ 所以/ 必须/ 要/ 寻找/ 新/ 的/ 特征/ 才能/ 建立/ 目标/ 页面/ 的/ 指纹/ 库/ ./ 本文/ 拟/ 采用/ 更为/ 细粒度/ 的/ 特征/ ,/ 如/ 访问/ 目标/ 页面/ 产生/ 的/ 每个/ 数据包/ 的/ 长度/ 等/ ./ 这些/ 特征/ 通用性/ 更强/ ,/ 除非/ 对/ 数据包/ 逐个/ 进行/ 特殊/ 处理/ ,/ 否则/ 是/ 无法/ 隐藏/ 这些/ 基本特征/ 的/ ./ 除了/ 数据包/ 包长/ 等/ 基本特征/ ,/ SSH/ 协议/ 本身/ 的/ 特性/ 也/ 产生/ 了/ 一些/ 可/ 供/ 进行/ 指纹识别/ 的/ 特征/ ./ 对于/ 浏览器/ 新/ 发起/ 的/ 每个/ TCP/ 连图/ 4SSH/ 协议/ 报文格式/ 4.2/ 指纹/ 特征/ 的/ 提取/ 与/ 比/ 对/ 4.2/ ./ 1/ 特征提取/ 通过/ 以上/ 对/ SSH/ 封装/ 的/ 匿名/ 流量/ 的/ 分析/ ,/ 页面/ 访问/ 所/ 产生/ 的/ 上下行/ 流量/ 存在/ 各自/ 的/ 可/ 区分/ 特性/ ./ 不同于/ 现有/ 工作/ ,/ 对于/ 上下行/ 流量/ 统一/ 提取/ 相同/ 的/ 接/ ,/ SSH/ 连接/ 协议/ ①/ 指出/ SSH/ 会/ 打开/ 一个/ 新/ 的/ 信道/ 与/ 之/ 对应/ 来/ 传输数据/ ,/ 因此/ SSH/ 信道/ 数即/ 为/ 浏览器/ 针对/ 该/ 页面/ 所/ 发起/ 的/ TCP/ 连接数/ ./ 通过/ 多次/ 嗅探/ 分析/ Firefox/ 访问/ 相同/ 页面/ 产生/ 的/ 匿名/ 流量/ ,/ 我们/ 发现/ 其/ 建立/ 的/ TCP/ 连接数/ 和/ 上行/ HTTP/ 请求/ 的/ 顺序/ 都/ 很/ 稳定/ ,/ 因此/ 发起/ 的/ TCP/ 连接数/ (/ SSH/ 信道/ 数/ )/ 和/ 上行/ 数据包/ 的/ 顺序/ 也/ 可以/ 作为/ 指纹/ 特征/ 进行/ 使用/ ./ 当/ SSH/ 客户端/ 请求/ 打开/ 一个/ 新/ 的/ 信道/ 时/ ,/ 会/ 向/ SSH/ 服务器/ 发出/ 一个/ SSH/ _/ MSG/ _/ CHANNEL/ _/ OPEN/ 的/ 消息/ ./ 如果/ 新/ 的/ 信道/ 成功/ 打开/ ,/ 服务器/ 就/ 会/ 回复/ SSH/ _/ MSG/ _/ CHANNEL/ _/ OPEN/ _/ CONFOR/ -/ MATION/ 消息/ ,/ 表示/ 可以/ 使用/ 该/ 新/ 信道/ 进行/ 数据传输/ ./ SSH/ 包/ 格式/ 如图/ 4/ 所示/ ,/ SSH/ _/ MSG/ _/ CHAN/ -/ NEL/ _/ OPEN/ 消息/ 的/ 包长/ 一般/ 被/ 填充/ 为/ 96Bytes/ ,/ SSH/ _/ MSG/ _/ CHANNEL/ _/ OPEN/ _/ CONFORMA/ -/ TION/ 消息/ 的/ 包长/ 则/ 为/ 48Bytes/ ./ 通过/ 计算/ 流量/ 中/ 含有/ 此类/ 信道/ 建立/ 控制/ 包/ 的/ 个数/ 就/ 可以/ 得知/ Firefox/ 访问/ 该/ 页面/ 时/ 建立/ 的/ TCP/ 连接数/ ./ 除了/ 上述/ 的/ 信道/ 打开/ 相关/ 的/ 两类/ 控制/ 包外/ ,/ SSH/ 客户端/ 和/ 服务器/ 在/ 进行/ 数据/ 转发/ 的/ 过程/ 中/ ,/ 双方/ 都/ 还/ 可能/ 发出/ SSH/ _/ MSG/ _/ CHANNEL/ _/ CLOSE/ (/ 32Bytes/ )/ 、/ SSH/ _/ MSG/ _/ CHANNEL/ _/ EOF/ (/ 32Bytes/ )/ 、/ SSH/ _/ MSG/ _/ CHAN/ -/ NEL/ _/ WINDOW/ _/ ADJUST/ (/ 40Bytes/ )/ 等/ 控制/ 包/ ,/ 这些/ 控制/ 包/ 的/ 出现/ 频率/ 受/ 网络/ 干扰/ 影响/ 较大/ ,/ 所以/ 可以/ 将/ 这些/ 长度/ 的/ 数据包/ 过滤/ 后/ 再/ 进行/ 特征/ 抽取/ ./ 特征/ ,/ 如/ 包长/ 、/ 顺序/ 或者/ 频率/ 等/ ,/ 本文/ 将/ 嗅/ 探/ 获得/ 的/ 数据包/ 分为/ 上行/ 和/ 下行/ 两类/ ,/ 根据/ 其/ 不同/ 的/ 特性/ ,/ 分别/ 抽取/ 特征/ 生成/ 对应/ 的/ 上行/ 指纹/ 和/ 下行/ 指纹/ ./ ①/ RFC4254/ :/ TheSecureShell/ (/ SSH/ )/ ConnectionProtocol/ ./ Page7/ (/ 1/ )/ 上行/ 数据包/ 在/ 页面/ 访问/ 的/ 过程/ 中/ ,/ 上行/ 数据包/ 的/ 大小/ 和/ 数量/ 相对/ 较/ 小/ ,/ 且/ 顺序/ 比较稳定/ ,/ 可以/ 抽取/ 数据包/ 的/ 长度/ 和/ 顺序/ ,/ SSH/ _/ MSG/ _/ CHANNEL/ _/ OPEN/ 消息/ 数/ 以及/ 所有/ 数据包/ 的/ 总长度/ 作为/ 上行/ 流量/ 的/ 特征/ ./ 一条/ 流/ 记录/ 的/ 所有/ 上行/ 数据包/ 可以/ 表示/ 为/ Fup/ =/ {/ x1/ ,/ x2/ ,/ …/ ,/ xsx/ ,/ ltcp/ ,/ sum/ (/ sx/ )/ }/ ./ 其中/ xi/ 为/ 除/ SSH/ 控制/ 包/ 、/ ACK/ 包外/ 的/ 第/ i/ 个/ 非/ 0/ 数据包/ 包长/ ;/ ltcp/ 为/ 该条/ 记录/ 中/ 所/ 含有/ 的/ SSH/ _/ MSG/ _/ CHANNEL/ _/ OPEN/ 消息/ 数/ ,/ 即/ 建立/ TCP/ 连接/ 的/ 总/ 个数/ ;/ sx/ 为/ 该条/ 记录/ 中除/ 控制/ 包外/ 所有/ 的/ 非/ 0/ 上/ 行包/ 总/ 个数/ ,/ sum/ (/ sx/ )/ 则/ 为/ 这些/ 数据包/ 的/ 总长度/ ./ (/ 2/ )/ 下行/ 数据包/ 由于/ 下行/ 数据包/ 数量/ 较/ 多/ ,/ 长度/ 多为/ MTU/ 值/ ,/ 且/ 通过/ SSH/ 封装/ 后/ 相对/ 顺序/ 紊乱/ ,/ 因此/ 对于/ 下行/ 流量/ ,/ 本文/ 只/ 抽取/ 其/ 包长/ 分布/ 的/ 统计/ 信息/ 作为/ 特征值/ ./ 可/ 将/ 一条/ 记录/ 中除/ 控制/ 报文/ 以外/ 的/ 非/ 0/ 下/ 行包/ 表示/ 为/ Fdown/ =/ {/ fx1/ ,/ fx2/ ,/ …/ ,/ fxMTU/ }/ ,/ 其中/ fxi/ 标志/ 该条/ 记录/ 中/ 包长/ xi/ 是否/ 出现/ :/ 出现/ 为/ 1/ ,/ 不/ 出现/ 为/ 0.4/ ./ 2.2/ 指纹/ 比/ 对/ 4.2/ ./ 2.1/ 上行/ 指纹/ 比/ 对/ 在/ 前文/ 描述/ 的/ 攻击/ 场景/ 下/ ,/ 当/ 用户/ 使用/ 浏览器/ 进行/ Web/ 访问/ 时/ ,/ 即使/ 在/ 间隔时间/ 很/ 短/ 的/ 情况/ 下/ 多次/ 访问/ 相同/ 的/ 网页/ ,/ 产生/ 的/ 上行/ 数据包/ 序列/ 也/ 会/ 存在/ 一定/ 的/ 差异性/ ./ 这种/ 差异/ 可/ 认为/ 主要/ 是/ 由/ 以下/ 几类/ 情况/ 造成/ 的/ ,/ 如图/ 5/ 所示/ ./ (/ 1/ )/ 数据包/ 的/ 合并/ 和/ 分裂/ 此类情况/ 属于/ 网络流量/ 存在/ 的/ 普遍现象/ ./ 由于/ 机器/ 的/ 繁忙/ 程度/ 不同/ 等/ 原因/ ,/ 会/ 导致/ 数据包/ 的/ 合并/ 和/ 分裂/ ./ 图/ 5/ 数据包/ 序列/ 差异/ (/ 2/ )/ SSH/ 对/ 相同/ 的/ 数据包/ 随机/ 填充/ 长度/ 不同/ SSH/ 协议/ 中/ 规定/ 会/ 对/ 数据包/ 进行/ 随机/ 长度/ 的/ 填充/ ,/ 使得/ 封装/ 后/ 的/ 数据/ 长度/ 必须/ 是/ 块/ 加密/ 长度/ 或/ 8Bytes/ 的/ 倍数/ ./ 但/ 在/ 工程/ 实现/ 时/ 为了/ 较/ 少/ 开销/ ,/ 一般/ 都/ 会/ 尽量减少/ 无/ 意义/ 的/ 填充/ 数据/ 的/ 长度/ ./ 通过/ 手动/ 分析/ 报文/ ,/ 可以/ 发现/ 相同/ 的/ 数据包/ 往往/ 也/ 被/ 填充/ 成/ 一样/ 的/ 长度/ ./ 当然/ ,/ 必然/ 也/ 会/ 存在/ 一些/ 数据包/ 随机/ 填充/ 的/ 长度/ 不/ 一致/ ,/ 使得/ 多次/ 访问/ 相同/ 网页/ 得到/ 的/ 数据包/ 序列/ 存在/ 差异/ ./ (/ 3/ )/ 数据包/ 乱序/ HTTP/ // 1.1/ 采用/ 了/ 多/ TCP/ 连接/ 和/ 流水线/ 机制/ ,/ 当/ 浏览器/ 发起/ 的/ 多个/ TCP/ 连接/ 并发/ 地/ 传输/ 请求/ 数据包/ 时/ ,/ 很大/ 可能/ 会/ 产生/ 数据包/ 乱序/ 的/ 现象/ ./ 除此以外/ ,/ SSH/ 进行/ 端口/ 转发/ ,/ 将/ 多个/ TCP/ 连接/ 映射/ 到/ 同/ 一条/ 连接/ 的/ 不同/ 信道/ ,/ 也/ 会/ 加剧/ 此类情况/ 的/ 出现/ ./ (/ 4/ )/ 数据包/ 丢失/ 重传/ 由于/ 网络/ 繁忙/ 等/ 原因/ ,/ 通信/ 对端/ 没有/ 接收/ 到/ 用户/ 发出/ 的/ 某些/ 请求/ 数据包/ 或者/ 用户/ 没有/ 收到/ ACK/ 报文/ ,/ 根据/ TCP/ 的/ 重传/ 机制/ 会/ 对/ 这些/ 丢失/ 的/ 数据包/ 进行/ 重传/ ./ 指纹/ 比/ 对/ 是/ 指/ 通过/ 测量/ 未知/ 类别/ 的/ 指纹/ 和/ 已知/ 指纹/ 之间/ 的/ 相似/ 度来/ 判断/ 未知/ 指纹/ 最有/ 可能/ 的/ 身份/ 类别/ ,/ 之前/ 的/ 一些/ 工作/ 采用/ 了/ Jaccard/ 系数/ 等/ 相似/ 度/ 测量方法/ 来/ 进行/ 指纹/ 的/ 匹配/ ./ 但/ 由于/ 本文/ 在/ 抽取/ 上行/ 指纹/ 时/ 包含/ 数据包/ 的/ 顺序/ 和/ 包长/ 等/ 特征/ ,/ 而/ 分类器/ 或/ Jaccard/ 系数/ 等/ 方法/ 都/ 无法/ 很/ 好/ 地/ 处理/ 这种/ 数据包/ 之间/ 的/ 顺序/ 关系/ ,/ 所以/ 并/ 不适/ 用于/ 上行/ 指纹/ 的/ 匹配/ ./ 最长/ 公共/ 子串/ (/ LongestCommonSubstring/ )/ 算法/ 通过/ 计算/ 两个/ 字符串/ x/ 和/ y/ 之间/ 的/ 最长/ 不/ 连续/ 的/ 公共/ 子串/ ,/ 可以/ 快速/ 高效/ 地/ 对/ 顺序/ 序列/ 进行/ 相/ Page8/ 似度/ 匹配/ ./ 字符串/ x/ 和/ y/ 的/ 相似/ 度/ Lcssim/ (/ x/ ,/ y/ )/ 计算/ 如式/ (/ 1/ )/ 所示/ :/ 其中/ ,/ lcs/ (/ x/ ,/ y/ )/ 表示/ x/ 和/ y/ 的/ 最长/ 公共/ 子串/ 的/ 长度/ ,/ max/ (/ x/ ,/ y/ )/ 用来/ 进行/ 规格化/ ./ 对于/ 相同/ 网站/ 的/ 两个/ 指纹/ ,/ 我们/ 发现/ Lu/ 等/ 人/ [/ 10/ ]/ 提出/ 的/ 最小/ 编辑/ 距离/ 和/ 最长/ 公共/ 子串/ 算法/ 计算/ 相似/ 度/ 得到/ 的/ 结果/ 基本/ 保持一致/ ,/ 但/ 当包/ 序列/ 出现/ 乱序/ 情况/ 的/ 时候/ ,/ 最长/ 公共/ 子串/ 算法/ 的/ 结果/ 优于/ 最小/ 编辑/ 距离/ :/ ①/ 对于/ (/ 1/ )/ 类中/ 的/ 数据包/ 分裂/ 的/ 情况/ ,/ 假设/ 属于/ 相同/ 类别/ 的/ 两个/ 包/ 序列/ x/ 和/ y/ ,/ 其中/ y/ 序列/ 出现/ 了/ 一次/ 包/ 分裂/ 现象/ ,/ 其他/ 都/ 保持一致/ ,/ 则/ y/ =/ x/ +/ 1/ ./ x/ 和/ y/ 的/ 编辑/ 距离/ 为/ 2/ ,/ 即/ 需要/ 一次/ 删除/ 和/ 一次/ 替换/ 操作/ 才能/ 使得/ 两个/ 序列/ 一致/ ,/ 则/ 最小/ 编辑/ 距离/ 计算/ 两者/ 的/ 相似/ 度为/ Edsim/ (/ x/ ,/ y/ )/ =/ 1/ -/ Ed/ (/ x/ ,/ y/ )/ 而/ x/ 和/ y/ 的/ 最长/ 公共/ 子串/ 长度/ 为/ x/ -/ 1/ ,/ 相似/ 度/ 计算/ 的/ 结果/ 为/ Lcssim/ (/ x/ ,/ y/ )/ =/ x/ -/ 1Edsim/ (/ x/ ,/ y/ )/ ./ ②/ 对于/ (/ 1/ )/ 类中/ 的/ 数据包/ 合并/ 的/ 情况/ ,/ 和/ 包/ 分裂/ 是/ 类似/ 的/ ./ ③/ 对于/ (/ 2/ )/ 类/ 填充/ 长度/ 不同/ 导致/ 序列/ 差异/ 的/ 情况/ ,/ 两种/ 算法/ 计算/ 的/ 结果/ 一致/ ./ ④/ 对于/ (/ 3/ )/ 类中/ 一个/ 数据包/ 相对/ 位置/ 改变/ 的/ 情况/ ,/ 假设/ 属于/ 相同/ 类别/ 的/ 两个/ 包/ 序列/ x/ 和/ y/ ,/ 其中/ y/ 序列/ 出现/ 了/ 一个/ 数据包/ 位置/ 改变/ 的/ 现象/ ,/ 其他/ 都/ 保持一致/ ,/ 则/ y/ =/ x/ ./ 而/ x/ 和/ y/ 的/ 编辑/ 距离/ 为/ 2/ ,/ 即/ 需要/ 一次/ 删除/ 和/ 一次/ 插入/ 操作/ ,/ 则/ 使用/ 该/ 算法/ 获得/ 的/ 相似/ 度为/ Edsim/ (/ x/ ,/ y/ )/ =/ y/ -/ 2/ 子串/ 为/ y/ -/ 1/ ,/ 相似/ 度/ 计算结果/ 为/ Lcssim/ (/ x/ ,/ y/ )/ =/ y/ -/ 1y/ ,/ 可得/ Lcssim/ (/ x/ ,/ y/ )/ >/ Edsim/ (/ x/ ,/ y/ )/ ./ ⑤/ 对于/ (/ 3/ )/ 类中/ 两个/ 非/ 相邻/ 数据包/ 互换/ 位置/ 的/ 情况/ ,/ 编辑/ 距离/ 为/ 2/ ,/ 即/ 需要/ 两次/ 替换/ 操作/ ,/ 而/ 此时/ 的/ 最长/ 公共/ 子串/ 长度/ 也/ 是/ 原串/ 长/ 减去/ 2/ ,/ 两种/ 算法/ 结果/ 一致/ ./ ⑥/ 对于/ (/ 4/ )/ 类/ 情况/ ,/ 编辑/ 距离/ 为/ 1/ ,/ 最长/ 公共/ 子串/ 也/ 是/ 原串/ 长减/ 1/ ,/ 两个/ 算法/ 结果/ 相同/ ./ 综上所述/ ,/ 考虑/ 到/ 使用/ SSH/ 加密/ 代理/ 封装/ 的/ 数据包/ 流量/ 中/ 会/ 出现/ 较/ 多/ 乱序/ 情况/ ,/ 在/ 本文/ 中/ 选择/ 使用/ 最长/ 公共/ 子串/ 算法/ 来/ 进行/ 上行/ 指纹/ 的/ 相似/ 度/ 匹配/ ,/ 提高/ 属于/ 相同/ 类别/ 的/ 两个/ 指纹/ 的/ 匹配/ 程度/ ./ 除了/ 比对/ 包长/ 和/ 顺序/ 这/ 两个/ 特征/ ,/ 我们/ 还/ 考虑/ 了/ TCP/ 连接/ 总数/ 和/ 数据包/ 总长度/ ./ 上行/ 指纹/ Fup/ (/ x/ )/ 与/ 已知/ 类别/ 为/ ci/ 的/ 指纹/ Fup/ (/ y/ )/ 的/ 相似/ 度/ 计算/ 如式/ (/ 2/ )/ 所示/ :/ simci/ (/ Fup/ (/ x/ )/ )/ =/ α/ ×/ Lcssim/ (/ 〈/ x1/ ,/ x2/ ,/ …/ ,/ xsx/ 〉/ ,/ 〈/ y1/ ,/ y2/ ,/ …/ ,/ ysy/ 〉/ )/ +/ β/ ×/ ltcp/ (/ x/ )/ -/ ltcp/ (/ y/ )/ +/ γ/ ×/ sum/ (/ sx/ )/ -/ sum/ (/ sy/ )/ ,/ β/ ,/ γ/ </ 0/ (/ 2/ )/ 其中/ α/ 、/ β/ 和/ γ/ 均/ 为/ 可调/ 参数/ ,/ 表示/ 对应/ 特征/ 所/ 占/ 的/ 权重/ 系数/ ,/ 其/ 数值/ 设置/ 与/ 实验/ 使用/ 的/ 数据/ 集/ 相关/ ./ 但/ 必须/ 保证/ β/ 和/ γ/ 均/ 为/ 负数/ ,/ 因为/ ltcp/ (/ x/ )/ -/ ltcp/ (/ y/ )/ 和/ sum/ (/ sx/ )/ -/ sum/ (/ sy/ )/ 的/ 值/ 越/ 大/ ,/ 就/ 代表/ 两个/ 记录/ 中/ TCP/ 连接数/ ,/ 数据包/ 总长度/ 差异/ 越大/ ,/ 即/ 两个/ 指纹/ 的/ 相似/ 度越/ 低/ ./ 4.2/ ./ 2.2/ 下行/ 指纹/ 比/ 对/ 在/ 下行/ 指纹/ 比/ 对/ 过程/ 中/ ,/ 本文/ 主要/ 采用/ 朴素/ 贝叶斯/ 分类器/ 来/ 识别/ 一个/ 指纹/ 所属/ 的/ 网站/ 类别/ ./ 朴素/ 贝叶斯/ 分类器/ [/ 18/ ]/ 是/ 目前/ 使用/ 最/ 广泛/ 的/ 一种/ 有/ 监督/ 的/ 机器/ 学习/ 方法/ ,/ 它/ 有/ 坚实/ 的/ 数学/ 理论/ 基础/ ,/ 分类/ 效率/ 稳定/ ./ 朴素/ 贝叶斯/ 假设/ 目标/ 对象/ 的/ 各/ 属性/ 之间/ 相互/ 独立/ ,/ 根据/ 目标/ 对象/ 类别/ 的/ 先验概率/ ,/ 基于/ 贝叶斯/ 公式/ 计算/ 其后/ 验/ 概率/ ,/ 即该/ 对象/ 属于/ 某/ 一类/ 别的/ 概率/ ,/ 然后/ 选择/ 具有/ 最大/ 后验/ 概率/ 的/ 类/ 作为/ 该/ 对象/ 所属/ 类别/ ./ 文献/ [/ 19/ ]/ 中/ ,/ Zhang/ 通过/ 证明/ 朴素/ 贝叶斯/ 最优性/ 的/ 充要条件/ ,/ 指出/ 各个/ 属性/ 之间/ 的/ 依赖性/ 会/ 相互/ 抵消/ ./ 因而/ 在/ 实际/ 情形/ 下/ ,/ 即使/ 所比/ 对/ 指纹/ 的/ 各个/ 属性/ 之间/ 并/ 不/ 相互/ 独立/ ,/ 它/ 仍/ 能/ 获得/ 较/ 好/ 的/ 分类/ 结果/ ./ 对于/ 一个/ 未知/ 指纹/ ,/ 朴素/ 贝叶斯/ 分类器/ 针对/ 每/ 一个/ 待选/ 的/ 网站/ 类别/ ci/ ,/ 都/ 会/ 使用/ 如下/ 公式/ 计算/ 该/ 指纹/ 身份/ 为/ ci/ 的/ 概率/ :/ pci/ (/ Fdown/ )/ =/ p/ (/ ciFdown/ )/ =/ p/ (/ ci/ )/ p/ (/ Fdownci/ )/ 其中/ ,/ 未知/ 指纹/ Fdown/ 对于/ 任意/ 的/ 类别/ ci/ ,/ p/ (/ Fdown/ )/ 都/ 相同/ ,/ 因此/ 可以/ 忽略/ ./ 4.2/ ./ 3/ 单个/ 页面/ 的/ 指纹/ 匹配/ 对于/ 一个/ 未知/ 页面/ 的/ 指纹/ F/ (/ F/ =/ Fup/ ∪/ Fdown/ )/ ,/ 根据上述/ 方法/ 分别/ 抽取/ 上行/ 和/ 下行/ 指纹/ 后/ ,/ 考虑/ 到/ 候选/ 类别/ 总数/ 对/ 贝叶斯/ 分类器/ 分类/ 准确率/ 和/ 计算/ 复杂度/ 的/ 影响/ ,/ 先/ 进行/ 上行/ 指纹/ 的/ 相似/ 度/ 比/ 对/ ,/ 从/ 结果/ Page9/ 中/ 抽取/ 排名/ 前/ R/ 个/ 候选/ 类/ ci1/ …/ ciR/ (/ 降序/ 排列/ )/ ,/ 记录/ 下/ 其/ 对应/ 相似/ 度/ simci1/ …/ simciR/ ;/ 在/ 下行/ 指纹识别/ 时/ ,/ 使得/ 分类器/ 只/ 在/ ci1/ …/ ciR/ 这/ R/ 个/ 类别/ 中/ 进行/ 分类/ 并/ 获得/ 对应/ 的/ 概率/ pci1/ …/ pciR/ ,/ 然后/ 按照/ 式/ (/ 4/ )/ 即可/ 计算/ 出/ 这个/ 未知/ 指纹/ F/ 属于/ 这/ R/ 个/ 类别/ 范围/ 中/ cij/ 类/ 的/ 概率/ PF/ (/ cij/ )/ :/ PF/ (/ cij/ )/ =/ ξ/ ×/ 其中/ ,/ 由于/ 上行/ 指纹/ 相似/ 度/ 需要/ 和/ 下行/ 指纹/ 进行/ 加权/ 相加/ ,/ 所以/ 必须/ 对/ 上行/ 指纹/ 相似/ 度值/ 先/ 进行/ 归一化/ 处理/ :/ simcij/ -/ simciksimci1/ -/ simcik/ 因为/ 上行/ 指纹/ 的/ 稳定性/ 强于/ 下行/ 指纹/ ,/ 建议/ ξ/ >/ 0.5/ ./ 而/ R/ 值则/ 需要/ 根据/ 实际/ 数据/ 在/ 匹配/ 准确率/ 和/ 计算/ 复杂度/ 之间/ 折中/ 选择/ ./ 当/ R/ 个/ 类别/ 的/ 概率/ 都/ 计算/ 过后/ ,/ 其中/ 最大值/ 对应/ 的/ 类别/ 即/ 为/ 未知/ 指纹/ F/ 的/ 最终/ 结果/ ./ 4.3/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 当/ 一个/ 用户/ 进行/ Web/ 访问/ 的/ 时候/ ,/ 通常/ 不会/ 仅/ 局限于/ 网站/ 主页/ 的/ 访问/ ,/ 还会/ 对/ 页面/ 中/ 相关/ 链接/ 进行/ 次级/ 页面/ 的/ 访问/ ./ 不同于/ 现有/ 工作/ 只/ 针对/ 目标/ 网站/ 主页/ 进行/ 指纹/ 攻击/ ,/ 本文/ 根据/ 被/ 监管者/ 的/ 这种/ 行为/ 模式/ ,/ 引入/ 隐/ 马尔科夫/ 模型/ 进行/ 场景/ 建模/ ,/ 将/ 单/ 页面/ 的/ 指纹/ 扩展/ 到/ 多级/ 页面/ 的/ 联合/ 指纹/ ,/ 更/ 高效/ 地/ 进行/ 网站/ 指纹/ 攻击/ ./ 隐/ 马尔科夫/ 模型/ [/ 20/ ]/ 是/ 一种/ 特殊/ 的/ 马尔科夫/ 模型/ ,/ 它/ 的/ 状态/ 是/ 隐藏/ 的/ ,/ 无法/ 直接/ 观察/ 获得/ ./ 但是/ 每/ 一个/ 隐藏/ 状态/ 的/ 转移/ 都/ 会/ 输出/ 和/ 该/ 隐藏/ 状态/ 相关/ 的/ 可/ 观察/ 值/ ,/ 通过/ 这些/ 输出/ 值/ 可以/ 对/ 隐藏/ 状态/ 进行/ 推测/ ./ 直观/ 地说/ ,/ HMM/ 可以/ 分为/ 可/ 观察/ 层/ 和/ 隐藏/ 层/ ,/ 可/ 观察/ 层/ 是/ 一个/ 输出/ 值/ 序列/ ,/ 其中/ 每个/ 可/ 观察/ 值/ 出现/ 的/ 概率/ 只/ 和/ 当前/ 的/ 隐藏/ 状态/ 有关/ ;/ 隐藏/ 层/ 是/ 一个/ 马尔科夫/ 过程/ ,/ 可用/ 状态/ 转移/ 概率/ 进行/ 描述/ ./ 一个/ HMM/ 可以/ 定义/ 为/ 一个/ 五元/ 组/ {/ S/ ,/ O/ ,/ A/ ,/ B/ ,/ Π/ }/ :/ 其中/ S/ =/ {/ S1/ ,/ …/ ,/ SN/ }/ 表示/ 所有/ 隐藏/ 状态/ 的/ 有限/ 集合/ ;/ O/ =/ {/ v0/ ,/ v1/ ,/ …/ ,/ vM/ }/ 表示/ 输出/ 的/ 可/ 观察/ 值/ 序列/ ;/ π/ i/ 表示/ 某个/ 隐藏/ 状态/ Si/ 为/ 初始状态/ 的/ 概率/ ,/ 其/ 集合/ 记/ 为/ Π/ =/ π/ 1/ ,/ π/ 2/ ,/ …/ ,/ π/ {/ 另/ 一个/ 状态/ Sj/ 的/ 概率/ 记为/ aij/ (/ i/ ,/ j/ >/ 0/ )/ ,/ 犃/ =/ {/ aij/ }/ 即/ 为/ 该/ HMM/ 的/ 状态/ 转移/ 概率/ 矩阵/ ;/ bi/ (/ k/ )/ 表示/ 在/ 隐藏/ 状态/ Si/ 时/ 出现/ 观察/ 值/ vk/ 的/ 输出/ 概率/ ,/ 其/ 集合/ 记为/ B/ =/ {/ bi/ (/ k/ )/ }/ ,/ 且/ 满足/ ∑/ M/ 被/ 监管者/ 进行/ Web/ 访问/ 的/ 模式/ 如图/ 6/ 所示/ :/ 被/ 监管者/ 首先/ 访问/ 某/ 目标/ 站点/ 的/ 主页/ ,/ 然后/ 点击/ 主页/ 中/ 的/ 某个/ 超链接/ 进入/ 次级/ 页面/ Page2/ 的/ 访问/ ,/ 以此类推/ ,/ 直至/ 其/ 浏览/ 完/ Pagen/ 后/ 结束/ 本次/ Web/ 访问/ ./ 在/ 此/ 过程/ 中/ ,/ 被/ 监管者/ 每/ 访问/ 一个/ 页面/ ,/ 就/ 会/ 产生/ 一系列/ 的/ 上下行/ 流量/ ./ 由于/ 被/ 监管者/ 是/ 通过/ 点击/ 当前/ 页面/ 中所含/ 的/ 链接/ 才/ 访问/ 下/ 一个/ 页面/ ,/ 下/ 一个/ 页面/ 的/ 访问/ 仅/ 取决于/ 当前/ 页面/ ,/ 满足/ 马尔科夫/ 链/ 的/ 特性/ ./ 被/ 监管者/ 通过/ SSH/ 代理/ 匿名/ 访问/ 某/ 网站/ 页面/ ,/ 攻击者/ 只能/ 观测/ 到/ 访问/ 该/ 页面/ 所/ 产生/ 的/ 流量/ ,/ 无法/ 得知/ 页面/ 所/ 包含/ 的/ 内容/ ./ 因此/ 可/ 将/ 每/ 一次/ 页面/ 的/ 访问/ 视为/ 一个/ 隐藏/ 状态/ ,/ 所有/ 黑名单/ 中/ 站点/ 的/ 目标/ 页面/ 即/ 构成/ 了/ 隐藏/ 状态/ 集合/ ./ 在/ 对/ 目标/ 网站/ 构建/ 隐/ 马尔科夫/ 模型/ 时/ ,/ 我们/ 没有/ 使用/ 现有/ 的/ 前/ 向/ -/ 后/ 向/ 算法/ ,/ 通过/ 数据/ 集/ 训练/ 来/ 获得/ 模型/ 的/ 各个/ 参数/ ,/ 而是/ 基于/ 网站/ 指纹识别/ 的/ 需求/ ,/ 根据/ 目标/ 网站/ 的/ 拓扑/ 结构/ 计算/ 并/ 设置/ 各个/ 参数/ ./ 假设/ 黑名单/ 站点/ 列表/ 含有/ N/ 个/ 站点/ ,/ 每个/ 站点/ 有/ n/ 个/ 目标/ 页面/ ,/ 则/ S/ =/ {/ S1/ ,/ …/ ,/ Sn/ ,/ Sn/ +/ 1/ ,/ …/ ,/ Sn/ ×/ N/ }/ ./ 被/ 监管者/ 未/ 产生/ 流量/ 时/ 的/ 状态/ 记/ 为/ 一个/ 可见/ 状态/ S0/ ,/ 其/ 第一个/ 访问/ 的/ 目标/ 网站/ 页面/ 的/ 概率/ 为/ 初始状态/ 的/ 概率/ ./ 考虑/ 到/ 攻击者/ 无法/ 获得/ 被/ 监管者/ 的/ Web/ 访问/ 历史记录/ ,/ 根据/ 最大/ 熵/ 原理/ ,/ 假定/ 被/ 监管者/ 等/ 概率/ 地/ 访问/ 每个/ 目标/ 网站/ ,/ 且/ 每次/ 访问/ 都/ 是从/ 该/ 网站/ 主页/ 开始/ ,/ 即/ 每个/ 目标/ 网站/ 主页/ 作为/ 初始状态/ 的/ 概率/ π/ x/ ×/ n/ +/ 1/ =/ 1/ // N/ (/ x/ ∈/ [/ 0/ ,/ N/ )/ )/ ,/ 其他/ 非/ 主页/ 的/ 目标/ 页面/ 作为/ 初始状态/ 的/ 概率/ 为/ 0/ ./ 至于/ 状态/ 转移/ 概率/ ,/ 则/ 取决于/ 两个/ 页面/ 之间/ 的/ 链接/ 关系/ ./ 当/ 被/ 监管者/ 从/ 当前/ 页面/ Si/ 通过/ 链接/ 跳转/ 到/ 下/ 一个/ 页面/ Sj/ 时/ ,/ 攻击者/ 可以/ 观测/ 到/ 其/ 产生/ 的/ 一系列/ 上下行/ 数据包/ ,/ 通过/ 使用/ 4.2/ 节中/ 特征/ 抽取/ 方法/ 产生/ 的/ 指纹/ 即/ 为/ 观察/ 值/ vk/ ./ 根据/ 数据/ 集中/ 的/ 样本/ 记录/ ,/ 通过/ 上述/ 方法/ 可以/ 直接/ 计算/ 出所/ 构建/ 的/ HMM/ 的/ 各个/ 参数/ ,/ 建立/ 对应/ 的/ 模型/ ./ 然后/ 使用/ Viterbi/ 算法/ [/ 21/ ]/ 寻找/ 可能性/ 最大/ Page10/ 的/ 隐藏/ 状态/ 序列/ ,/ 即可/ 得知/ 被/ 监管者/ 访问/ 的/ 网站/ 的/ 真实/ 身份/ ./ 值得注意/ 的/ 是/ ,/ 在/ 每/ 一步/ 递归计算/ Viterbi/ 路径/ 时/ ,/ 因为/ 观察/ 值/ vk/ 所属/ 的/ 类别/ 是/ 不/ 确定/ 的/ ,/ 还/ 必须/ 根据/ 式/ (/ 4/ )/ 来/ 获得/ 指纹/ 匹配/ 的/ 相似/ 度/ 结果/ ,/ 具体/ 计算方法/ 如下/ :/ δ/ j/ (/ 1/ )/ =/ max/ ω/ ∈/ CPv0/ (/ c/ ω/ )/ bj/ (/ v0/ )/ π/ j/ δ/ j/ (/ t/ +/ 1/ )/ =/ max/ ω/ ∈/ C/ ,/ i/ ∈/ S/ δ/ j/ (/ t/ )/ aijbj/ (/ v/ )/ Pvt/ (/ c/ ω/ )/ (/ 6/ )/ / t/ +/ 1/ (/ i/ )/ =/ argmax/ ω/ ∈/ C/ ,/ i/ ∈/ S/ δ/ j/ (/ t/ )/ aijbj/ (/ v/ )/ Pvt/ (/ c/ ω/ )/ (/ 7/ )/ 其中/ ,/ C/ 为/ 观测/ 到/ 的/ 指纹/ vk/ 所有/ 可能/ 的/ 候选/ 类别/ 集合/ ,/ Pvt/ (/ c/ ω/ )/ 表示/ 观察/ 值/ vt/ 属于/ 类别/ c/ ω/ 的/ 概率/ ./ 通过/ 上述/ 对隐/ 马尔科夫/ 模型/ 的/ 修改/ 和/ 调整/ ,/ 一方面/ 可以/ 节省/ 模型/ 训练/ 学习/ 所/ 需要/ 的/ 大量/ 时间/ ,/ 另一方面/ 也/ 能/ 防止/ 因/ 训练/ 数据/ 偏移/ 导致/ 所/ 建/ 模型/ 与/ 真实情况/ 不符/ 的/ 情况/ 的/ 出现/ ./ 5/ 实验/ 评估/ 5.1/ 数据/ 采集/ 为了/ 评估/ 指纹/ 攻击/ 方法/ 的/ 高效性/ ,/ 本文/ 根据/ 图/ 2/ 所示/ 的/ 攻击/ 模型/ 部署/ 实验/ ,/ 在/ 真实/ 的/ Internet/ 环境/ 下/ 进行/ 数据/ 采集/ ./ 论文/ 针对/ Alexa/ 排名/ 前/ 200/ 的/ 网站/ ,/ 通过/ 多次/ 随机/ 访问/ ,/ 选取/ 了/ 其中/ 可/ 稳定/ 访问/ 的/ 前/ 100/ 个/ 网站/ 作为/ 黑名单/ 站点/ 列表/ ,/ 并/ 在/ Ubuntu10/ ./ 10/ 的/ 客户端/ 主机/ 上/ 使用/ Firefox3/ ./ 6.13/ 通过/ OpenSSH/ 代理/ 来/ 访问/ 目标/ 站点/ ./ 我们/ 在/ Firefox/ 中/ 应用/ Pagestates/ 扩展/ ,/ 通过/ 编写/ 脚本/ 以/ 达到/ 浏览器/ 自动/ 访问/ 目标/ 站点/ 列表/ 的/ 目的/ ./ 当/ Firefox/ 载入/ 一个/ 页面/ 时/ ,/ Tcpdump/ 将/ 被/ 调用/ 来/ 记录/ 所/ 产生/ 的/ 加密/ 数据包/ ,/ 并/ 存入/ 数据库/ ./ 为了/ 保证/ 指纹/ 攻击/ 方法/ 的/ 工程/ 可行性/ 及/ 与/ 之前/ 工作/ 的/ 可比性/ ,/ 我们/ 根据/ 第/ 3/ 节中/ 提出/ 的/ 前提/ 假设/ 对/ Firefox/ 浏览器/ 进行/ 了/ 参数/ 配置/ ./ 在/ 下行/ 指纹/ 的/ 比/ 对/ 过程/ 中/ ,/ 本文/ 将/ 修改/ 开源/ 工具/ Weka/ [/ 22/ ]/ 中/ 的/ 朴素/ 贝叶斯/ 分类器/ 来/ 实现/ 分类/ ./ 考虑/ 到/ 多级/ 页面/ 建立/ 隐/ 马尔科夫/ 模型/ 的/ 高/ 复杂性/ ,/ 本文/ 目前/ 仅/ 关注/ 网站/ 主页/ 和/ 次级/ 页面/ 的/ 链接/ 关系/ ./ 首先/ 对/ 黑名单/ 站点/ 列表/ 进行/ 了/ 扩展/ ,/ 对于/ 每个/ 网站/ 的/ 主页/ 选取/ 25/ 个/ 次级/ 页面/ ,/ 即/ 每个/ 站点/ 选取/ 26/ 个/ 页面/ 作为/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 的/ 目标/ 列表/ ,/ 一共/ 产生/ 2600/ 个/ 链接/ ./ 然后/ 在/ 2/ 个/ 月/ 的/ 时间/ 内/ ,/ 每天/ 访问/ 这些/ 目标/ 页面/ 2/ 次/ ,/ 生成/ 一个/ 多级/ 页面/ 的/ 数据/ 集/ SSH100/ ,/ 包含/ 312000/ 条/ 记录/ ./ 此外/ ,/ 本文/ 还/ 使用/ 了/ 现有/ 的/ 公开/ 数据/ 集/ OpenSSH/ -/ 2000/ ./ 该/ 数据/ 集是/ 由/ Liberatore/ 等/ 人/ 选择/ 了/ 2000/ 个/ 可/ 访问/ 的/ 热门/ 网站/ 作为/ 目标/ 站点/ 列表/ ,/ 进行/ 了/ 2/ 个/ 月/ 的/ 数据/ 采集/ 形成/ 的/ ./ 由于/ 该/ 数据/ 集仅/ 针对/ 目标/ 网站/ 的/ 主页/ 进行/ 数据/ 抓取/ ,/ 无法/ 实施/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 方法/ ,/ 因此/ 本文/ 在/ 该/ 数据/ 集仅/ 实现/ 了/ 单个/ 页面/ 的/ 指纹/ 攻击/ 方法/ ./ 通过/ 和/ Liberatore/ 等/ 人/ 的/ 实验/ 结果/ 的/ 比较/ ,/ 来/ 验证/ 所/ 选/ 流量/ 特征/ 的/ 高/ 区分/ 性/ 以及/ 相应/ 匹配/ 算法/ 的/ 有效性/ ./ 5.2/ 实验/ 参数设置/ 网站/ 指纹/ 攻击/ 主要/ 包括/ 样本/ 数据/ 训练/ 和/ 未知/ 数据测试/ 两个/ 阶段/ ,/ 而/ 其/ 最/ 重要/ 的/ 结果/ 评估/ 准则/ 就是/ 该/ 攻击/ 方法/ 的/ 准确率/ ./ 在/ 实验/ 过程/ 中/ 所/ 涉及/ 的/ 参数设置/ ,/ 例如/ 每组/ 训练样本/ 大小/ ntrain/ 、/ 每组/ 测试/ 样本/ 大小/ ntest/ 、/ 训练样本/ 和/ 测试/ 样本/ 之间/ 的/ 间隔时间/ Δ/ t/ 等/ ,/ 都/ 会/ 在/ 一定/ 程度/ 上/ 影响/ 攻击/ 方法/ 的/ 准确率/ ./ 为了/ 设置/ 合适/ 的/ 参数值/ ,/ 我们/ 在/ 数据/ 集/ SSH100/ 上/ 进行/ 了/ 小/ 样本/ 集/ 的/ 对照/ 实验/ ,/ 在/ 固定/ 其他/ 参数/ 的/ 情况/ 下/ ,/ 代入/ 待选/ 参数/ 的/ 多个/ 取值/ 进行/ 单个/ 页面/ 指纹/ 攻击/ 方法/ ,/ 然后/ 根据/ 所得/ 的/ 攻击/ 准确率/ 选取/ 合适/ 的/ 参数/ ./ 直观/ 地/ ,/ 指纹识别/ 结果/ 的/ 准确率/ 会/ 随着/ 训练样本/ 的/ 增大/ 而/ 呈上升/ 趋势/ ,/ 但/ 同时/ 也/ 会/ 造成/ 大量/ 的/ 计算/ 开销/ ./ 如图/ 7/ 所示/ ,/ 对于/ 数据/ 集/ SSH100/ ,/ 在/ Δ/ t/ =/ 0.5/ 、/ 测试/ 样本/ 大小/ ntest/ =/ 4/ 的/ 情况/ 下/ ,/ 单个/ 页面/ 指纹/ 匹配/ 的/ 准确率/ 随着/ 训练样本/ 增加/ 而/ 逐步/ 上升/ :/ 当/ ntrain/ =/ 1/ 时/ ,/ 准确率/ 仅/ 有/ 81.6/ %/ ;/ 当/ ntrain/ =/ 4/ 时/ ,/ 准确率/ 上升/ 到/ 93.7/ %/ ;/ 当/ ntrain/ 继续/ 增大/ 时/ ,/ 准确率/ 基本/ 趋于稳定/ ,/ 增幅/ 下降/ ./ 考虑/ 到/ 训练/ 集/ 增大/ 会/ 增加/ 计算/ 复杂度/ ,/ 以及/ 与/ 现有/ 工作/ 结果/ 的/ 可比性/ ,/ 我们/ 在/ 实验/ 中将/ ntrain/ 的/ 值/ 设为/ 4/ ./ 图/ 8/ 显示/ 了/ 在/ ntrain/ =/ 4/ 、/ ntest/ =/ 4/ 的/ 条件/ 下/ ,/ 单个/ 页面/ 指纹/ 匹配/ 的/ 准确率/ 随着/ 间隔时间/ Δ/ t/ 增大/ 的/ 变化趋势/ ./ 当/ 目标/ 列表/ 中/ 的/ 站点/ 普遍/ 更新/ 频繁/ 的/ 情况/ 下/ ,/ 我们/ 仍/ 可以/ 从图/ 中/ 明显/ 看出/ ,/ 即使/ 训练样本/ 和/ 测试/ 样本/ 之间/ 存在/ 较大/ 的/ 时间延迟/ ,/ 也/ 只会/ 轻微/ 影响/ Page11/ 指纹识别/ 的/ 准确率/ ./ 究其原因/ ,/ 是因为/ 这些/ 站点/ 一般/ 都/ 只是/ 更新/ 其/ 页面/ 中/ 嵌入/ 的/ 文本/ 或/ 对象/ ,/ 并/ 不会/ 改变/ 网页/ 的/ 总体/ 架构/ ,/ 所以/ 上行/ 请求/ 的/ 数据包/ 变化/ 较/ 小/ ;/ 而/ 下行/ 数据包/ 是/ 用来/ 传输/ 页面/ 所/ 嵌入/ 的/ 对象/ ,/ 此类/ 更新/ 操作/ 对于/ 单个/ 对象/ 的/ 数据包/ 改变/ 较大/ ,/ 但/ 对/ 整个/ 页面/ 报文/ 长度/ 分布/ 的/ 影响/ 甚微/ ./ 而/ 本文/ 所/ 提出/ 的/ 攻击/ 方法/ 对于/ 上行/ 数据包/ 进行/ 顺序/ 与/ 大小/ 的/ 匹配/ ,/ 在/ 下行/ 方面/ 则/ 根据/ 包长/ 分布/ 进行/ 分类/ ,/ 因此/ 即使/ 是/ 内容/ 更新/ 较为/ 频繁/ 的/ 站点/ ,/ 该/ 方法/ 对于/ 时间/ 的/ 延迟/ 仍/ 具有/ 较/ 高/ 的/ 鲁棒性/ ./ 反之/ ,/ 即/ 意味着/ 我们/ 不/ 需要/ 频繁/ 地/ 更新/ 指纹/ 库/ ,/ 却/ 仍/ 可以/ 获得/ 较/ 好/ 的/ 指纹识别/ 准确率/ ./ 但/ 为了/ 更好/ 地/ 验证/ 本文/ 所/ 提出/ 的/ 指纹/ 攻击/ 方法/ 的/ 高效性/ ,/ 在/ 之后/ 的/ 实验/ 中/ ,/ 我们/ 将/ Δ/ t/ 的/ 值/ 设置/ 为/ 0.5/ ./ 5.3/ 实验/ 结果/ 对于/ 数据/ 集/ OpenSSH2000/ ,/ 因为/ Liberatore/ 等/ 人/ 只/ 针对/ 目标/ 网站/ 主页/ 进行/ 数据/ 采集/ ,/ 没有/ 提供/ 次级/ 页面/ 的/ 流量/ 数据/ ,/ 所以/ 我们/ 仅/ 执行/ 单个/ 页面/ 指纹/ 匹配/ 方法/ ./ 如图/ 9/ 所示/ ,/ 在/ 其他/ 条件/ 相同/ 的/ 情况/ 下/ ,/ 当/ 目标/ 站点/ 个数/ N/ =/ 1000/ 时/ ,/ 单个/ 页面/ 指纹/ 匹配/ (/ OneLayer/ )/ 获得/ 了/ 81.7/ %/ 的/ 识别率/ ,/ 相较/ 于/ Liberatore/ 等/ 人/ 使用/ 的/ Bayes/ 和/ Jaccard/ 系数/ 方法/ ,/ 准确率/ 提高/ 了/ 近/ 9/ %/ ./ 值得注意/ 的/ 是/ ,/ OneLayer/ 和/ Bayes/ 方法/ 的/ 区别/ 只/ 在于/ 我们/ 对于/ 上行/ 流量/ 提取/ 了/ 不同/ 的/ 特征/ 然后/ 使用/ 最长/ 公共/ 子串/ 算法/ 进行/ 相似/ 度/ 比/ 对/ ,/ 而/ 在/ 下行/ 流量/ 的/ 处理/ 上/ 是/ 一致/ 的/ ./ 如果/ 将/ 未知/ 指纹/ 的/ 真实/ 身份/ 在/ 分类/ 预测/ 结果/ 排名/ 前/ K/ 位/ 也/ 视为/ 准确/ 识别/ 的话/ ,/ 当/ K/ =/ 3/ 时/ ,/ 仅/ 使用/ 单个/ 页面/ 指纹/ 匹配/ 方法/ 就/ 可以/ 准确/ 识别/ 90/ %/ 的/ 记录/ 的/ 类别/ ,/ 而/ 此时/ Bayes/ 和/ Jaccard/ 的/ 识别/ 准确率/ 仅为/ 78/ %/ 和/ 82/ %/ ,/ 证明/ 了/ 我们/ 所/ 抽取/ 指纹/ 特征/ 的/ 高/ 区分/ 性/ 以及/ 相应/ 匹配/ 算法/ 的/ 有效性/ ./ 图/ 93/ 种/ 攻击/ 在/ 不同/ 的/ K/ 值下/ 对应/ 的/ 攻击/ 准确率/ 针对/ 数据/ 集/ SSH100/ ,/ 我们/ 分别/ 测试/ 了/ 5/ 种/ 指纹/ 攻击/ 方法/ :/ Liberatore/ 等/ 人/ 提出/ 的/ Jaccard/ 系数/ 、/ 使用/ 核/ 密度估计/ 的/ 朴素/ 贝叶斯/ 分类器/ 、/ Herrmann/ 等/ 人/ 提出/ 的/ 多项式/ 朴素/ 贝叶斯/ 分类器/ 、/ Panchenko/ 等/ 人/ 提出/ 的/ 支持/ 向量/ 机/ 方法/ 以及/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 方法/ (/ TwoLayer/ )/ ,/ 实验/ 结果/ 如图/ 10/ 所示/ ./ 当/ 目标/ 站点/ 的/ 类别/ 为/ 100/ 、/ Δ/ t/ =/ 0.5/ 、/ ntrain/ =/ 4/ 时/ ,/ 我们/ 的/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 方法/ 获得/ 了/ 近/ 96.8/ %/ 的/ 准确率/ ./ 在/ 上述/ 实验/ 中/ ,/ 鉴于/ 多级/ 页面/ 建立/ 隐/ 马尔科夫/ 模型/ 的/ 高/ 复杂性/ ,/ 本文/ 仅/ 针对/ 两级/ 页面/ 这种/ 最/ 简单/ 的/ 情况/ 进行/ 攻击/ ,/ 而/ 这/ 已经/ 获得/ 了/ 较/ 好/ 的/ 实验/ 结果/ ./ 可以/ 预期/ 的/ 是/ ,/ 当/ 两级/ 页面/ 扩展/ 到/ 多级/ 页面/ ,/ 甚至/ 是/ 目标/ 网站/ 的/ 所有/ 页面/ 时/ ,/ 建立/ 对应/ 的/ 精确/ 的/ 隐/ 马尔科夫/ 模型/ 来/ 进行/ 网站/ 指纹/ 攻击/ ,/ 将会/ 进一步提高/ 攻击/ 的/ 准确率/ ./ 6/ 结束语/ 本文/ 针对/ SSH/ 加密/ 代理/ 匿名/ 滥用/ 的/ 问题/ ,/ 在/ 详细分析/ SSH/ 封装/ 的/ Web/ 流量/ 特征/ 的/ 基础/ 上/ ,/ 将/ 嗅/ Page12/ 探/ 获得/ 的/ 数据包/ 分为/ 上行/ 和/ 下行/ 两类/ ,/ 根据/ 其/ 不同/ 的/ 特性/ ,/ 分别/ 抽取/ 特征/ 生成/ 对应/ 的/ 指纹/ ,/ 然后/ 根据/ 待/ 识别/ 的/ 指纹/ 的/ 特性/ 选择/ 了/ 合适/ 的/ 比/ 对/ 算法/ ,/ 实现/ 了/ 单个/ 页面/ 的/ 指纹/ 匹配/ ./ 通过/ 在/ 公开/ 数据/ 集上/ 和/ 现有/ 工作/ 进行/ 实验/ 比较/ ,/ 证明/ 了/ 所选/ 特征/ 的/ 高/ 区分/ 性/ 和/ 匹配/ 算法/ 的/ 高效性/ ./ 同时/ ,/ 本文/ 根据/ 被/ 监管者/ 的/ Web/ 访问/ 模式/ ,/ 针对/ 目标/ 站点/ 首页/ 和/ 次级/ 页面/ 之间/ 的/ 链接/ 关系/ 建立/ 对应/ 的/ 隐/ 马尔科夫/ 模型/ ,/ 将/ 单个/ 页面/ 指纹/ 的/ 匹配/ 扩展/ 到/ 多级/ 页面/ ,/ 实现/ 了/ 多级/ 页面/ 联合/ 指纹/ 攻击/ 方法/ ./ Internet/ 环境/ 下/ 的/ 实验/ 结果表明/ 了/ 该/ 方法/ 的/ 高效性/ ./ 现有/ 研究/ 工作/ 所/ 采用/ 的/ 攻击/ 模型/ 普遍存在/ 一些/ 具有/ 较大/ 限制/ 的/ 前提/ 假设/ ,/ 例如/ 关闭/ 浏览器/ 的/ cache/ 功能/ ./ 虽然/ 这些/ 假设/ 存在/ 一定/ 的/ 合理性/ ,/ 但会/ 降低/ 攻击/ 方法/ 的/ 实用性/ ./ 因此/ ,/ 在/ 下/ 一步/ 的/ 工作/ 中/ ,/ 将/ 针对/ 浏览器/ cache/ 开启/ 等/ 情况/ 进行/ 指纹/ 攻击/ 方法/ 研究/ ./ 同时/ ,/ 鉴于/ 破损/ 数据/ 对/ 指纹/ 攻击/ 方法/ 准确率/ 的/ 影响/ ,/ 如何/ 区分/ 并/ 处理/ 破损/ 数据/ 也/ 是/ 亟需/ 解决/ 的/ 问题/ ./ 

