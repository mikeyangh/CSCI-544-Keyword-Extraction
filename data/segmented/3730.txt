Page1/ 可追踪/ 并/ 撤销/ 叛徒/ 的/ 属性/ 基/ 加密/ 方案/ 马海英/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 曾国荪/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 同济大学/ 计算机科学/ 与/ 技术/ 系/ 上海/ 201804/ )/ 2/ )/ (/ 嵌入式/ 系统/ 与/ 服务/ 计算/ 教育部/ 重点/ 实验室/ 上海/ 201804/ )/ 3/ )/ (/ 南通/ 大学/ 计算机科学/ 与/ 技术/ 学院/ 江苏/ 南通/ 226019/ )/ 摘要/ 属性/ 基/ 加密/ (/ ABE/ )/ 是/ 一种/ 有效/ 地/ 对/ 加密/ 数据/ 实现/ 细粒度/ 访问控制/ 的/ 密码学/ 体制/ ./ 在/ ABE/ 系统/ 中/ ,/ 存在/ 恶意/ 用户/ (/ 或/ 叛徒/ )/ 泄露/ 私钥/ 生成/ 盗版/ 解码器/ ,/ 并/ 将/ 其分/ 发给/ 非法/ 用户/ 的/ 问题/ ./ 现有/ 的/ 解决方案/ 仅能/ 追查/ 到/ 密钥/ 泄漏/ 者/ 的/ 身份/ ,/ 但/ 不能/ 将/ 其/ 从/ ABE/ 系统/ 中/ 撤销/ ./ 文中/ 提出/ 了/ 一种/ 既/ 可追踪/ 又/ 可/ 撤销/ 叛徒/ 的/ 属性/ 基/ 加密/ 方案/ (/ ABTR/ )/ ./ 首先/ ,/ 给出/ 一个/ 具有/ 扩展/ 通配符/ 的/ 属性/ 基/ 加密/ 方案/ (/ GWABE/ )/ ,/ 基于/ 3/ 个/ 3/ 素数/ 子群/ 判定/ 假设/ ,/ 采用/ 双系统/ 加密/ 方法/ 证明/ 该/ GWABE/ 方案/ 是/ 完全/ 安全/ 的/ ./ 然后/ ,/ 利用/ 完全/ 子树/ 构架/ 将/ GWABE/ 转化成/ ABTR/ 方案/ ,/ 并/ 证明/ 该/ ABTR/ 方案/ 是/ 完全/ 安全/ 的/ ,/ 且/ 用户/ 私钥/ 长度/ 是/ 固定/ 的/ ./ 而/ 此前/ 的/ 可追踪/ 叛徒/ 的/ ABE/ 方案/ 仅/ 满足/ 选择/ 安全性/ ./ 关键词/ 属性/ 基/ 加密/ ;/ 访问控制/ ;/ 完全/ 子树/ 框架/ ;/ 叛徒/ 追踪/ ;/ 撤销/ 1/ 引言/ 2005/ 年/ Sahai/ 和/ Waters/ [/ 1/ ]/ 在/ 欧洲/ 密码学/ 年/ 会上/ 提出/ 了/ 属性/ 基/ 加密/ 机制/ (/ Attribute/ -/ BasedEncryption/ ,/ ABE/ )/ 的/ 概念/ ./ 在/ 该/ ABE/ 机制/ 中/ ,/ 可信/ 授权/ 机构/ 为/ 用户/ 颁发/ 私钥/ ,/ 用户/ 私钥/ 和/ 密文/ 分别/ 与/ 一组/ 属性/ 相关/ ,/ 当/ 用户/ 的/ 私钥/ 属性/ 与/ 密文/ 属性/ 相互/ 匹配/ 度/ 达到/ 系统/ 规定/ 的/ 门/ 限值/ 时/ ,/ 用户/ 才能/ 解密/ 密文/ ./ 该/ ABE/ 机制/ [/ 1/ ]/ 仅能/ 支持/ 门限/ 访问/ 控制策略/ ./ 为了/ 表达/ 更/ 灵活/ 的/ 访问/ 控制策略/ ,/ 2006/ 年/ Goyal/ 等/ 人/ [/ 2/ ]/ 在/ CCS/ 会议/ 上/ 提出/ 了/ 密钥/ 策略/ 的/ ABE/ 机制/ (/ KP/ -/ ABE/ )/ ,/ 实现/ 了/ 对/ 加密/ 数据/ 的/ 细粒度/ 访问控制/ ./ 在/ KP/ -/ ABE/ 中/ ,/ 密钥/ 与/ 访问/ 策略/ 相关/ ,/ 密文/ 与/ 属性/ 集合/ 相关/ ,/ 只有/ 密文/ 的/ 属性/ 满足/ 密钥/ 的/ 访问/ 策略/ 时/ ,/ 才能/ 解密/ 密文/ ./ 2007/ 年/ ,/ Bethencourt/ 等/ 人/ [/ 3/ ]/ 提出/ 了/ 密文/ 策略/ 的/ ABE/ 机制/ (/ CP/ -/ ABE/ )/ ./ 在/ CP/ -/ ABE/ 中/ ,/ 密文/ 与/ 访问/ 策略/ 相关/ ,/ 密钥/ 与/ 属性/ 集合/ 相关/ ,/ 只有/ 密钥/ 的/ 属性/ 满足/ 密文/ 的/ 访问/ 策略/ 时/ ,/ 才能/ 解密/ 密文/ ./ 上述/ 两种/ ABE/ 机制/ 实现/ 了/ 基于/ 属性/ 的/ 灵活/ 访问/ 控制策略/ ,/ 使得/ 它们/ 在/ 细粒度/ 访问控制/ 领域/ 具有/ 广阔/ 的/ 应用/ 前景/ [/ 2/ -/ 5/ ]/ ,/ 例如/ 付费/ 电视/ 系统/ 、/ 审计/ 日志/ 、/ 数据库/ 访问/ 等/ ./ 在/ ABE/ 系统/ 中/ ,/ 用户/ 的/ 访问/ 权利/ 与其/ 私钥/ 直接/ 关联/ [/ 1/ -/ 6/ ]/ ./ 如果/ 合法/ 用户/ 泄露/ 自己/ 的/ 私钥/ 构造/ 盗版/ 解密/ 设备/ ,/ 并/ 将/ 其分/ 发给/ 非法/ 用户/ ,/ 则/ 系统/ 的/ 访问/ 控制策略/ 将会/ 被/ 打破/ [/ 7/ ]/ ./ 特别/ 的/ ,/ 在/ ABE/ 机制/ 中/ ,/ 用户/ 私钥/ 仅/ 与其/ 属性/ 相关/ ,/ 而/ 与/ 用户/ 的/ 任何/ 特定/ 信息/ (/ 如/ 身份/ )/ 无关/ ,/ 即使/ 泄露/ 的/ 密钥/ 后来/ 被/ 发现/ ,/ 我们/ 也/ 无法/ 将/ 其/ 与/ 任何/ 合法/ 用户/ 相关联/ ./ 因此/ ,/ 合法/ 用户/ 可以/ 轻易/ 的/ 与/ 他人/ 共享/ 自己/ 的/ 私钥/ 而/ 不用/ 担心/ 被/ 发现/ [/ 7/ -/ 10/ ]/ ./ 针对/ 这个/ 密钥/ 滥用/ 问题/ ,/ 学者/ 们/ 进行/ 了/ 深入/ 的/ 研究/ ,/ 提出/ 了/ 不同/ 的/ 解决方案/ ./ 2008/ 年/ Hinek/ 等/ 人/ [/ 7/ ]/ 提出/ 基于/ 标号/ 的/ ABE/ 方案/ ,/ 使得/ 密钥/ 代理/ 将会/ 暴露/ 用户/ 的/ 隐私/ 信息/ ,/ 对/ 预防/ 密钥/ 克隆/ 起到/ 威慑/ 作用/ ./ 但是/ ,/ 该/ 方案/ 无法/ 追查/ 到/ 密钥/ 滥用/ 者/ 的/ 真实/ 身份/ ./ YRLL09/ [/ 8/ ]/ 和/ LRZW09/ [/ 9/ ]/ 基于/ DBDH/ 和/ D/ -/ Linear/ 假设/ 分别/ 提出/ 了/ 防/ 滥用/ KP/ -/ ABE/ 方案/ 和/ 可/ 追责/ 的/ 匿名/ CP/ -/ ABE/ 方案/ ,/ 解决/ 了/ ABE/ 机制/ 中/ 密钥/ 滥用/ 者/ 的/ 身份/ 追踪/ 问题/ ./ WCC11/ [/ 10/ ]/ 提出/ 了/ 属性/ 基/ 叛徒/ 追踪/ 方案/ ,/ 使用/ 唯一/ 身份/ 标识/ 用户/ ,/ 采用/ 联合/ 安全/ 编码/ [/ 11/ ]/ 和/ 叛徒/ 追踪/ [/ 12/ ]/ 技术/ 来/ 确定/ 密钥/ 滥用/ 者/ 的/ 身份/ ./ 但是/ 联合/ 安全/ 编码/ 的/ 使用/ 导致/ 密文/ 和/ 公钥/ 长度/ 过大/ ,/ 系统/ 效率/ 过低/ ./ 因此/ ,/ 他们/ 将/ 构造/ 一个/ 高效/ 的/ 属性/ 基/ 叛徒/ 追踪/ 方案/ 作为/ 一个/ 公开/ 问题/ ./ 然而/ ,/ 上述/ 可追踪/ 叛徒/ 的/ ABE/ 方案/ [/ 7/ -/ 10/ ]/ 均/ 不能/ 将/ 叛徒/ 从/ 系统/ 中/ 撤销/ ,/ 从而/ 无法/ 使/ 盗版/ 解密/ 设备/ 无效/ ./ 针对/ 用户/ 私钥/ 的/ 泄露/ 问题/ ,/ Pirretti/ 等/ 人/ [/ 13/ ]/ 最早/ 提出/ 可/ 撤销/ 的/ ABE/ 机制/ ,/ 使/ 用户/ 私钥/ 与/ 有效期/ 相关/ ,/ 授权/ 机构/ 周期性/ 更新/ 未/ 撤销/ 用户/ 的/ 私钥/ ,/ 从而/ 使/ 已/ 撤销/ 用户/ 的/ 私钥/ 无效/ ,/ 但/ 该/ 方案/ 不/ 支持/ 用户/ 的/ 即时/ 撤销/ ./ Ostrovsky/ 等/ 人/ [/ 14/ ]/ 将/ 用户/ 标识/ 作为/ 一个/ 属性/ ,/ 把/ 密文/ 和/ 被/ 撤销/ 用户/ 标识/ 的/ “/ 非/ ”/ 相关联/ ,/ 实现/ 了/ CP/ -/ ABE/ 中/ 用户/ 的/ 即时/ 撤销/ ,/ 但是/ 增加/ 了/ 用户/ 私钥/ 和/ 密文/ 的/ 长度/ ./ Attrapadung/ 和/ Imai/ [/ 15/ ]/ 对/ 其/ 进行/ 了/ 改进/ ,/ 减少/ 撤销/ 的/ 开销/ ,/ 提出/ 广播/ ABE/ 机制/ ./ Boldyreva/ 等/ 人/ [/ 16/ ]/ 采用/ 二叉树/ 提出/ 可/ 撤销/ 的/ ABE/ 方案/ ,/ 实现/ 了/ KP/ -/ ABE/ 中/ 用户/ 的/ 撤销/ ./ 但是/ ,/ 现有/ 可/ 撤销/ 的/ ABE/ 方案/ [/ 13/ -/ 16/ ]/ 都/ 不能/ 追查/ 到/ 叛徒/ 的/ 真实/ 身份/ ./ 综上所述/ ,/ 现有/ 的/ ABE/ 方案/ 都/ 无法/ 同时/ 实现/ 叛徒/ 的/ 追踪/ 和/ 撤销/ [/ 17/ ]/ ./ 为了/ 更好/ 地/ 防止/ ABE/ 系统/ 中/ 盗版/ 密钥/ 的/ 产生/ 和/ 传播/ ,/ 构建/ 既/ 可追踪/ 又/ 可/ 撤销/ 叛徒/ 的/ 属性/ 基/ 加密/ 方案/ 具有/ 十分/ 重要/ 的/ 现实意义/ ./ 本文/ 基于/ 完全/ 子树/ 构架/ [/ 18/ ]/ 提出/ 一个/ 可追踪/ 并/ 撤销/ 叛徒/ 的/ 属性/ 基/ 加密/ 方案/ (/ ABTR/ )/ ./ 在/ 完全/ 子树/ 构架/ 中/ ,/ 需要/ 根据/ 身份/ 撤销/ 列表/ 将/ 未/ 撤销/ 用户/ 划分/ 成/ 不/ 相交/ 的/ 子集/ ,/ 然后/ 为/ 每个/ 子集/ 的/ 用户/ 生成/ 子/ 密文/ ,/ 整个/ 密文/ 由/ 所有/ 子/ 密文/ 构成/ ./ 但是/ ,/ 一般/ 的/ ABE/ 方案/ 无法/ 为/ 由/ 身份/ 撤销/ 列表/ 划分/ 成/ 的/ 用户/ 子集/ 生成/ 密文/ ./ 因此/ ,/ 无法/ 利用/ 完全/ 子树/ 构架/ 将/ 一般/ 的/ ABE/ 方案/ 直接/ 转化成/ ABTR/ 方案/ ./ 针对/ 这个/ 问题/ ,/ 我们/ 首先/ 给出/ 了/ 具有/ 扩展/ 通配符/ 的/ 属性/ 基/ 加密/ 方案/ (/ GWABE/ )/ ,/ 基于/ 3/ 个/ 3/ 素数/ 子群/ 判定/ 假设/ ,/ 采用/ 双系统/ 加密/ 方法/ [/ 6/ ]/ 证明/ 该/ GWABE/ 方案/ 在/ 标准/ 模型/ 下/ 是/ 完全/ 安全/ 的/ ./ 然后/ ,/ 我们/ 利用/ 完全/ 子树/ 构架/ 将/ 该/ GWABE/ 转化成/ ABTR/ 方案/ ,/ 并/ 证明/ 该/ ABTR/ 方案/ 是/ 完全/ 安全/ 的/ ,/ 且/ 用户/ 私钥/ 长度/ 是/ 固定/ 的/ ./ 第/ 2/ 节/ 给出/ 本文/ 所/ 使用/ 的/ 预备/ 知识/ ;/ 第/ 3/ 节/ 给出/ GWABE/ 的/ 定义/ 及其/ 安全性/ 模型/ ,/ 提出/ 一个/ 具体/ 的/ GWABE/ 方案/ ,/ 并/ 证明/ 其/ 相应/ 的/ 安全性/ ;/ 第/ 4/ 节/ 采用/ 完全/ 子树/ 构架/ 将/ 第/ 3/ 节/ 的/ GWABE/ 转化成/ ABTR/ 方案/ ,/ 并/ 证明/ 该/ ABTR/ 方案/ 是/ 完全/ 安全/ 的/ ,/ 随后/ 将/ 该/ 方案/ 与/ 相关/ 方案/ 在/ 性能/ 方面/ 进行/ 比较/ ;/ 第/ 5/ 节/ 给出/ 全文/ 的/ 总结/ ./ 2/ 预备/ 知识/ 2.1/ 符号/ 说明/ 本文/ 中/ ,/ Z/ 表示/ 整数/ 环/ ,/ 对于/ 正整数/ p/ ,/ Zp/ 表示/ 模为/ p/ 的/ 整数/ 环/ ./ 符号/ x/ ←/ / / RZp/ 表示/ 在/ Zp/ 中/ 随机/ 选取/ 元素/ x/ ./ 当/ / 表示/ 某个/ 算法/ 时/ ,/ 符号/ / (/ a1/ ,/ a2/ ,/ …/ ,/ Page3an/ )/ →/ b1/ ,/ …/ ,/ bm/ 表示/ 算法/ / 以/ a1/ ,/ a2/ ,/ …/ ,/ an/ 为/ 输入/ ,/ 输出/ b1/ ,/ …/ ,/ bm/ ./ 2.2/ 访问/ 结构/ 和/ 线性/ 秘密/ 共享/ 方案/ (/ LSSS/ )/ 定义/ 1/ (/ 访问/ 结构/ [/ 6/ ]/ )/ ./ 设/ / =/ {/ / 1/ ,/ / 2/ ,/ …/ ,/ / n/ }/ 是/ n/ 个/ 参与者/ 的/ 集合/ ,/ 集族/ / / 2/ / 称为/ 单调/ 的/ ,/ 如果/ 对/ 任意/ 集合/ B/ 、/ C/ ,/ 都/ 有/ :/ 若/ B/ ∈/ / 且/ B/ / C/ ,/ 则/ C/ ∈/ / ./ 访问/ 结构/ (/ 或/ 单调/ 访问/ 结构/ )/ 是/ / 的/ 某些/ 非/ 空子/ 集/ 构成/ 的/ 集族/ / (/ 或单/ 调集/ 族/ )/ ,/ 即/ / / 2/ / \/ / ,/ / 中/ 的/ 集合/ 称为/ 授权/ 集/ ,/ 不/ 在/ / 中/ 的/ 集合/ 称为/ 非/ 授权/ 集/ ./ 定义/ 2/ (/ LSSS/ [/ 6/ ]/ )/ ./ 称/ 参与者/ 集合/ / =/ {/ / 1/ ,/ / 2/ ,/ …/ ,/ / n/ }/ 上/ 的/ 一个/ 秘密/ 共享/ 方案/ Π/ 是/ 线性/ 的/ ,/ 如果/ ①/ 参与者/ 的/ 秘密/ 分享/ 值/ 构成/ Zp/ 上/ 的/ 一个/ 向量/ ;/ ②/ 对于/ Π/ ,/ 存在/ 一个/ 秘密/ 份额/ 生成/ 矩阵/ 犃/ l/ ×/ h/ 和行/ 标号/ 函数/ ρ/ :/ {/ 1/ ,/ …/ ,/ / }/ →/ / ,/ 设/ s/ ∈/ Zp/ 是/ 待/ 共享/ 的/ 秘密/ 值/ ,/ 随机/ 选择/ r2/ ,/ …/ ,/ rh/ ∈/ Zp/ ,/ 构成/ 向量/ 狏/ =/ (/ s/ ,/ r2/ ,/ …/ ,/ rh/ )/ ,/ 令/ 狏/ 为/ 狏/ 的/ 转置/ ,/ 则/ 犃/ ·/ 狏/ 是/ / 个/ 秘密/ 份额/ 构成/ 的/ 向量/ ,/ 根据/ 标号/ 函数/ 将/ 秘密/ 份额/ λ/ i/ =/ (/ 犃/ 狏/ )/ i/ (/ 1/ / i/ / / )/ 分配/ 给/ 参与者/ ρ/ (/ i/ )/ ./ LSSS/ 的/ 线性/ 重构/ 性质/ :/ 假定/ Π/ 是/ 访问/ 结构/ / 的/ 线性/ 秘密/ 共享/ 方案/ ,/ 令/ S/ ∈/ / 是/ 授权/ 集/ ,/ 定义/ I/ =/ {/ i/ :/ ρ/ (/ i/ )/ ∈/ S/ }/ / {/ 1/ ,/ …/ ,/ / }/ ,/ 则/ 存在/ 多项式/ 时间/ 算法/ 计算/ {/ ci/ ∈/ Zp/ }/ i/ ∈/ I/ ,/ 使得/ 对于/ 秘密/ 共享/ 值/ s/ 的/ 任意/ 有效/ 份额/ {/ λ/ i/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ / }/ ,/ 满足/ Σ/ i/ ∈/ Ici/ λ/ i/ =/ s/ ./ 将/ LSSS/ 引入/ 到/ 本文/ 的/ 方案/ 中/ ,/ 参与者/ 为/ 属性/ ,/ 访问/ 结构/ 包含/ 所有/ 的/ 授权/ 属性/ 集/ ./ 2.3/ 合数/ 阶/ 双线性/ 群/ 和/ 复杂性/ 假设/ 文献/ [/ 6/ ]/ 提出/ 合数/ 阶/ 双线性/ 群/ 的/ 概念/ ,/ 本文/ 利用/ 一个/ 群/ 生成器/ 算法/ / 对/ 其/ 定义/ ./ 该/ 算法/ 输入/ 系统/ 的/ 安全/ 参数/ λ/ ,/ 输出/ 一个/ 对/ 双线性/ 群/ G/ 的/ 描述/ ,/ 即/ / 输出/ 一个/ 元组/ (/ p1/ ,/ p2/ ,/ p3/ ,/ G/ ,/ GT/ ,/ e/ )/ ,/ 其中/ p1/ ,/ p2/ ,/ p3/ 为/ 3/ 个/ 不同/ 素数/ ,/ G/ 和/ GT/ 是/ N/ =/ p1p2p3/ 阶/ 循环群/ ,/ 映射/ e/ :/ G/ ×/ G/ →/ GT/ 满足/ :/ (/ 1/ )/ 双线性/ ./ / u/ ,/ v/ ∈/ G/ ;/ a/ ,/ b/ ∈/ ZN/ ;/ e/ (/ ua/ ,/ vb/ )/ =/ e/ (/ u/ ,/ v/ )/ ab/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ / g/ ∈/ G/ 使得/ e/ (/ g/ ,/ g/ )/ 在/ GT/ 中/ 的/ 阶为/ N/ ./ (/ 3/ )/ 可计算性/ ./ G/ 和/ GT/ 中/ 的/ 运算/ 以及/ 双线性/ 映射/ e/ 都/ 是/ 在/ 多项式/ 时间/ 内/ 可/ 计算/ 的/ ./ 令/ Gp1/ ,/ Gp2/ ,/ Gp3/ 分别/ 表示/ 群/ G/ 的/ p1/ ,/ p2/ ,/ p3/ 阶/ 子群/ ,/ 当/ hi/ ∈/ Gpi/ ,/ hj/ ∈/ Gpj/ ,/ 且/ i/ ≠/ j/ 时/ ,/ e/ (/ hi/ ,/ hj/ )/ 为/ GT/ 的/ 单位/ 元/ ./ 子群/ Gp1/ ,/ Gp2/ 和/ Gp3/ 之间/ 的/ 正交/ 性/ [/ 6/ ]/ 是/ 本文/ 构造/ 方案/ 的/ 一个/ 主要/ 工具/ ./ 下面/ ,/ 我们/ 给出/ 用于/ 证明/ 本文/ 方案/ 安全性/ 的/ 复杂性/ 假设/ ./ 本文/ 中/ 的/ 3/ 个/ 3/ 素数/ 子群/ 判定/ 假设/ 是/ 在/ 文献/ [/ 6/ ]/ 中/ 被/ 提出/ 的/ ,/ 在/ 这些/ 假设/ 中/ ,/ 令/ Gp1p2/ 等/ 表示/ 群/ G/ 的/ p1p2/ 阶/ 子群/ ,/ Pr/ 是/ 概率函数/ ./ 假设/ 1/ ./ 给定/ 群/ 生成器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / =/ (/ N/ =/ p1p2p3/ ,/ G/ ,/ GT/ ,/ e/ )/ ←/ / / RX2/ ,/ Y2/ ←/ / / RGp2/ ;/ X3/ ,/ Y3/ ←/ / / RGp3/ ,/ D/ =/ (/ / ,/ g/ ,/ X1X2/ ,/ X3/ ,/ Y2Y3/ )/ ,/ T1/ ←/ / / RG/ ,/ T2/ ←/ / / RGp1p3/ ./ 我们/ 定义/ 敌手/ / 攻破/ 假设/ 2/ 的/ 优势/ 为/ Adv2/ / ,/ / (/ λ/ )/ ·/ ·/ =/ |/ Pr/ (/ / (/ D/ ,/ T1/ )/ =/ 1/ )/ -/ Pr/ (/ / (/ D/ ,/ T2/ )/ =/ 1/ )/ |/ ./ 假设/ 3/ ./ 给定/ 群/ 生成器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / =/ (/ N/ =/ p1p2p3/ ,/ G/ ,/ GT/ ,/ e/ )/ ←/ / / RX3/ ←/ / / RGp3/ ,/ D/ =/ (/ / ,/ g/ ,/ X3/ )/ ,/ T1/ ←/ / / RGp1p2/ ,/ T2/ ←/ / / RGp1/ ./ 我们/ 定义/ 敌手/ / 攻破/ 假设/ 1/ 的/ 优势/ 为/ Adv1/ / ,/ / (/ λ/ )/ ·/ ·/ =/ |/ Pr/ (/ / (/ D/ ,/ T1/ )/ =/ 1/ )/ -/ Pr/ (/ / (/ D/ ,/ T2/ )/ =/ 1/ )/ |/ ./ 假设/ 2/ ./ 给定/ 群/ 生成器/ / ,/ 我们/ 定义/ 如下/ 分布/ :/ / =/ (/ N/ =/ p1p2p3/ ,/ G/ ,/ GT/ ,/ e/ )/ ←/ / / Rg/ ←/ / / RGp1/ ;/ X2/ ,/ Y2/ ,/ Z2/ ←/ / / RGp2/ ,/ X3/ ←/ / / RGp3/ ,/ D/ =/ (/ / ,/ g/ ,/ g/ α/ X2/ ,/ X3/ ,/ gtY2/ ,/ Z2/ )/ ,/ T1/ ←/ / / Re/ (/ g/ ,/ g/ )/ α/ t/ ,/ T2/ ←/ / / RGT/ ./ 我们/ 定义/ 敌手/ / 攻破/ 假设/ 3/ 的/ 优势/ 为/ Adv3/ / ,/ / (/ λ/ )/ ·/ ·/ =/ |/ Pr/ (/ / (/ D/ ,/ T1/ )/ =/ 1/ )/ -/ Pr/ (/ / (/ D/ ,/ T2/ )/ =/ 1/ )/ |/ ./ 定义/ 3/ ./ 如果/ 对于/ 任意/ 多项式/ 时间/ 的/ 敌手/ / ,/ Adv1/ / ,/ / (/ λ/ )/ ,/ Adv2/ / ,/ / (/ λ/ )/ ,/ Adv3/ / ,/ / (/ λ/ )/ 都/ 是/ 可/ 忽略/ 的/ ,/ 我们/ 就/ 说/ 群/ 生成器/ / 满足/ 假设/ 1/ ,/ 2/ ,/ 3/ ,/ 即/ 假设/ 1/ ,/ 2/ ,/ 3/ 均/ 成立/ ./ 2.4/ 子集覆盖/ 构架/ 和/ 完全/ 子树/ 构架/ 令/ / 表示/ 全体/ 用户/ 的/ 集合/ ,/ / 表示/ 撤销/ 用户/ 的/ 集合/ ,/ / \/ / 表示/ 未/ 撤销/ 用户/ 集合/ ./ 子集覆盖/ 构架/ [/ 18/ ]/ 将/ 每个/ 用户/ 与/ 二叉树/ 的/ 一个/ 叶子/ 节点/ 相对/ 应/ ,/ 由/ Subset/ 算法/ 和/ Cover/ 算法/ 组成/ ./ Subset/ 算法/ 定义/ 一个/ 子集/ 的/ 集合/ (/ S1/ ,/ S2/ ,/ …/ ,/ Sw/ )/ ,/ 每个/ 子集/ Si/ / / (/ 1/ / i/ / w/ )/ 具有/ 一个/ 身份/ 模式/ Pi/ ,/ Si/ 中/ 的/ 每个/ 用户/ 都/ 能/ 解密/ 在/ 模式/ Pi/ 下/ 加密/ 的/ 密文/ ./ 当有/ 用户/ 子集/ / 被/ 系统/ 撤销/ 时/ ,/ Cover/ 算法/ 将/ 未/ 撤销/ 用户/ 集合/ / \/ / 划分/ 成/ 若干个/ 互不/ 相交/ 的/ 集合/ (/ Si1/ ,/ Si2/ ,/ …/ ,/ Sim/ )/ ,/ 使得/ Si1/ ∪/ Si2/ ∪/ …/ ∪/ Sim/ =/ / \/ / ./ 完全/ 子树/ 构架/ 是/ 对/ 子集覆盖/ 构架/ 的/ 一个/ 具体/ 实现/ ,/ 基于/ 完全/ 子树/ 构架/ 定义/ 的/ 加密/ 系统/ 由/ 3/ 个/ 算法/ 组成/ :/ (/ 1/ )/ 初始化/ 算法/ ./ 给/ 每个/ 合法/ 用户/ 指定/ 秘密/ 信息/ ,/ 用于/ 解密/ 消息/ ./ (/ 2/ )/ 加密算法/ ./ 给定/ 消息/ M/ 和/ 撤销/ 用户/ 集合/ / ,/ 系统/ 利用/ Cover/ 算法/ 将/ 未/ 撤销/ 用户/ 集合/ / \/ / 划分/ 成/ (/ Si1/ ,/ Si2/ ,/ …/ ,/ Sim/ )/ ,/ 随后/ 选择/ 会话/ 密钥/ K/ ,/ 分别/ 用/ 这些/ 子集/ 对应/ 的/ 身份/ 模式/ Pij/ (/ 1/ / Page4j/ / m/ )/ 对会话/ 密钥/ K/ 进行/ 公钥/ 加密/ ,/ 而用/ K/ 对/ 消息/ M/ 进行/ 对称/ 加密/ ,/ 密文/ 形/ 如/ {/ [/ i1/ ,/ i2/ ,/ …/ ,/ im/ ,/ EncPi1/ (/ K/ )/ ,/ …/ ,/ EncPim/ (/ K/ )/ ]/ ,/ EK/ (/ M/ )/ }/ ,/ 其中/ ,/ Enc/ 为/ 公钥/ 加密算法/ ,/ 为了/ 提高效率/ 减少/ 带宽/ ,/ E/ 采用/ 快速/ 的/ 对称/ 加密算法/ ,/ 例如/ M/ 和/ K/ 的/ 异或/ 运算/ ./ (/ 3/ )/ 解密/ 算法/ ./ 未/ 撤销/ 用户/ u/ ∈/ / \/ / 首先/ 找到/ j/ 使得/ u/ ∈/ Sij/ ,/ 利用/ 自己/ 的/ 秘密/ 信息/ 解密/ EncPij/ (/ K/ )/ ,/ 得到/ 会话/ 密钥/ K/ ,/ 计算/ DK/ (/ EK/ (/ M/ )/ )/ ,/ 得到/ 消息/ M/ ./ 3/ 具有/ 扩展/ 通配符/ 的/ ABE/ 方案/ (/ GWABE/ )/ 为了/ 将/ ABE/ 和/ 完全/ 子树/ 构架/ 相结合/ 实现/ 用户/ 的/ 撤销/ ,/ 本/ 节/ 基于/ LW/ 的/ KP/ -/ ABE/ 方案/ [/ 6/ ]/ 提出/ 具有/ 扩展/ 通配符/ 的/ 属性/ 基/ 加密/ 方案/ (/ GWABE/ )/ ,/ GWABE/ 本质/ 上/ 是/ ABE/ 的/ 一种/ 变形/ ./ 为了/ 更好/ 地/ 理解/ GWABE/ 的/ 定义/ ,/ 我们/ 首先/ 给出/ 身份/ 模式/ (/ 或/ 模式/ )/ 和/ 匹配/ 的/ 概念/ ./ 身份/ 模式/ P/ 是/ 由/ 长度/ 为/ n/ 的/ 位串/ 来/ 表示/ ,/ 其中/ 可能/ 包含/ 一个/ 通配符/ / ,/ 通配符/ / 由/ 其/ 开始/ 位置/ 和/ 终止/ 位置/ 决定/ ,/ 例如/ ,/ 长度/ 为/ 9/ 的/ 身份/ 模式/ P/ =/ “/ 101/ / 101/ ”/ ,/ 其中/ ,/ 通配符/ / 的/ 长度/ 为/ 3/ ,/ 开始/ 位置/ 为/ 4/ ,/ 终止/ 位置/ 为/ 6/ ./ 如果/ P/ 中/ 确实/ 包含/ 一个/ 通配符/ ,/ 则/ 称/ P/ 为/ 扩展/ 通配符/ ./ 每个/ 身份/ 模式/ 可记/ 为/ P/ =/ Pip/ ‖/ / ‖/ Pis/ ,/ 其中/ ,/ Pip/ ,/ Pis/ 分别/ 是/ 长度/ 为/ ip/ ,/ is/ 的/ 位串/ (/ 1/ / ip/ ,/ is/ / n/ )/ ,/ 通配符/ / 的/ 长度/ 为/ n/ -/ ip/ -/ is/ ,/ 开始/ 位置/ 为/ ip/ +/ 1/ ,/ 终止/ 位置/ 为/ n/ -/ is/ ./ 给定/ 用户/ 的/ 身份/ id/ 和/ 身份/ 模式/ P/ ,/ 如果/ id/ =/ P/ 或者/ id/ 和/ P/ 的/ 形式/ 为/ P/ =/ Pip/ ‖/ / ‖/ Pis/ 且/ id/ =/ Pip/ ‖/ id/ / ‖/ Pis/ ,/ 其中/ id/ / 是/ 长度/ 为/ n/ -/ ip/ -/ is/ 的/ 位串/ ,/ 称/ id/ 和/ P/ 相匹配/ ,/ 记作/ id/ ∈/ / P/ ./ 在/ GWABE/ 方案/ 中/ ,/ 用户/ 是/ 由/ 一个/ 元组/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 来/ 标识/ ,/ id/ 是/ 一个/ 长度/ 为/ n/ 的/ 位串/ ,/ 表示/ 用户/ 的/ 身份/ ,/ (/ 犃/ ,/ ρ/ )/ 是/ 用户/ 的/ 访问/ 结构/ ./ 用户/ 的/ 私钥/ 与/ 身份/ id/ 和/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 相关/ ,/ 密文/ 与/ 身份/ 模式/ P/ 和/ 属性/ 集/ ω/ 相关/ ,/ 当且/ 仅/ 当/ id/ ∈/ / P/ 且/ ω/ 满足/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 时/ ,/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 才能/ 解密/ 密文/ ./ 3.1/ GWABE/ 的/ 定义/ 和/ 安全性/ 模型/ 一个/ GWABE/ 方案/ 由/ 4/ 个/ 算法/ 组成/ :/ 初始化/ (/ Setup/ )/ ,/ 密钥/ 生成/ (/ KeyGen/ )/ ,/ 加密/ (/ Enc/ )/ ,/ 解密/ (/ Dec/ )/ ./ Setup/ (/ λ/ )/ →/ PK/ ,/ MSK/ ./ 初始化/ 算法/ 输入/ 系统安全/ 参数/ λ/ ,/ 输出/ 系统/ 公钥/ PK/ 和/ 主/ 密钥/ MSK/ ./ KeyGen/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ MSK/ )/ →/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ 密钥/ 生成/ 算法/ 输入/ 用户/ 的/ 身份/ id/ 、/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 、/ 主/ 密钥/ MSK/ ,/ 输出/ 用户/ 私钥/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ Enc/ (/ M/ ,/ ω/ ,/ P/ ,/ PK/ )/ →/ CT/ ./ 加密算法/ 输入/ 消息/ M/ 、/ 属性/ 集/ ω/ 、/ 身份/ 模式/ P/ 和/ 公钥/ PK/ ,/ 输出/ 密文/ CT/ ./ Dec/ (/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ CT/ )/ →/ M/ ./ 解密/ 算法/ 输入/ 用户/ 私钥/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 和/ 在/ ω/ 和/ P/ 下/ 加密/ 的/ 密文/ CT/ ,/ 仅当/ id/ ∈/ / P/ 且/ ω/ 满足/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 时/ ,/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 才能/ 解密/ 密文/ ,/ 否则/ ,/ 解密/ 失败/ ./ 正确性/ ./ 系统/ 运行/ 初始化/ 算法/ 生成/ PK/ 和/ MSK/ ,/ 对于/ 所有/ 消息/ M/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ id/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 身份/ 模式/ P/ ,/ 当/ ω/ 满足/ (/ 犃/ ,/ ρ/ )/ 且/ id/ ∈/ / P/ 时/ ,/ Dec/ (/ KeyGen/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ MSK/ )/ ,/ Enc/ (/ M/ ,/ ω/ ,/ P/ ,/ PK/ )/ )/ =/ M/ 的/ 概率/ 为/ 1/ ./ 下面/ ,/ 我们/ 通过/ 挑战者/ / 和/ 敌手/ / 之间/ 的/ 交互性/ 游戏/ 定义/ GWABE/ 的/ 完全/ 安全性/ ./ (/ 1/ )/ 初始化/ ./ 挑战者/ / 运行/ 系统/ 初始化/ 算法/ ,/ 生成/ 公钥/ PK/ 和/ 主/ 密钥/ MSK/ ,/ 并/ 将/ PK/ 发送给/ 敌手/ / ./ (/ 2/ )/ 阶段/ 1/ ./ 敌手/ / 适应性/ 地/ 询问/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 挑战者/ 生成/ 私钥/ 并/ 其/ 发送给/ 敌手/ / ,/ 敌手/ 可以/ 重复/ 多次/ 询问/ 私钥/ ./ (/ 3/ )/ 挑战/ ./ 敌手/ / 向/ 挑战者/ / 提交/ 等/ 长/ 消息/ M0/ 、/ M1/ 、/ 挑战/ 属性/ 集/ ω/ / 和/ 挑战/ 身份/ 模式/ P/ / ,/ 挑战者/ 抛掷/ 一枚/ 公平/ 硬币/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 计算/ CT/ / =/ Enc/ (/ Mb/ ,/ ω/ / ,/ P/ / ,/ PK/ )/ ,/ 并/ 将/ CT/ / 发送给/ 敌手/ ./ (/ 4/ )/ 阶段/ 2/ ./ 重复/ 执行/ 阶段/ 1/ ./ (/ 5/ )/ 猜测/ ./ 敌手/ / 输出/ 对/ 密文/ CT/ / 的/ 一个/ 猜测/ 值/ b/ ∈/ {/ 0/ ,/ 1/ }/ ./ 若/ b/ =/ b/ ,/ 且/ 敌手/ 从未/ 询问/ 这/ 类/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 其中/ id/ ∈/ / P/ / ,/ 且/ ω/ / 满足/ (/ 犃/ ,/ ρ/ )/ ,/ 则/ 称/ 敌手/ 赢得/ 这个/ 游戏/ ./ 敌手/ 在/ 上述/ 游戏/ 中/ 获胜/ 的/ 优势/ 定义/ 为/ Adv/ / =/ |/ Pr/ [/ b/ =/ b/ ]/ -/ 1/ // 2/ |/ ./ 定义/ 4/ ./ 如果/ 任意/ 多项式/ 时间/ 敌手/ / 赢得/ 上述/ 游戏/ 的/ 优势/ 都/ 是/ 可以/ 忽略/ 的/ ,/ 则/ 称/ 这个/ GWABE/ 方案/ 是/ 完全/ 安全/ 的/ ./ 3.2/ GWABE/ 方案/ 我们/ 首先/ 解释/ 本/ 小节/ 中/ 所/ 使用/ 的/ 标号/ ./ j/ ∈/ id/ 表示/ 变量/ j/ 取遍/ 位串/ id/ 中/ 所有/ 是/ 1/ 的/ 位置/ ,/ 定义/ Waters/ 散列/ 函数/ 为/ F/ (/ id/ )/ =/ u0/ Π/ j/ ∈/ iduj/ ,/ 其中/ ,/ uj/ 是/ 系统/ 公钥/ PK/ 中/ 的/ 元素/ ./ 对于/ 一个/ 模式/ P/ =/ Pip/ ‖/ / ‖/ Pis/ ,/ 定义/ F/ (/ Pip/ ‖/ / ‖/ Pis/ )/ =/ F/ (/ Pip/ ‖/ 0/ …/ 0/ ‖/ Pis/ )/ ,/ 其中/ ,/ 0/ 的/ 个数/ 为/ n/ -/ ip/ -/ is/ ./ 注意/ :/ 如果/ 已知/ 所有/ 的/ utip/ +/ 1/ ,/ …/ ,/ n/ -/ is/ )/ ,/ 则/ 对/ 任意/ 长度/ 为/ n/ -/ ip/ -/ is/ 的/ 位串/ id/ / ,/ 我们/ 可以/ 使用/ F/ (/ idip/ ‖/ / ‖/ idis/ )/ t/ 计算/ F/ (/ idip/ ‖/ id/ / ‖/ idis/ )/ t/ ,/ 即/ F/ (/ idip/ ‖/ id/ / ‖/ idis/ )/ t/ =/ F/ (/ idip/ ‖/ / ‖/ idis/ )/ t/ ·/ Π/ j/ ∈/ id/ / ut/ 利用/ 上述/ 特性/ ,/ 如果/ 密文/ 中/ 包含/ 与/ 通配符/ 相应/ 的/ 元/ j/ ,/ 解密/ 者/ 可以/ 组合/ 与/ 自己/ 身份/ 相应/ 的/ ut/ 素/ ut/ 解密/ ./ 令/ G/ ,/ GT/ 是/ 阶为/ N/ =/ p1p2p3/ 的/ 循环群/ ,/ 其中/ ,/ Page5p1/ ,/ p2/ ,/ p3/ 是/ 3/ 个/ 互不/ 相同/ 的/ 素数/ ,/ e/ :/ G/ ×/ G/ →/ GT/ 是/ 双线性/ 映射/ ,/ Gpi/ 是/ 群/ G/ 的/ 阶为/ pi/ 的/ 子群/ ./ / 为/ 全体/ 用户/ 的/ 集合/ ,/ |/ / |/ 是/ / 中/ 的/ 用户/ 个数/ ,/ n/ =/ log2/ |/ / |/ ./ Setup/ (/ λ/ )/ →/ PK/ ,/ MSK/ ./ 可信/ 授权/ 机构/ 输入/ 安全/ 参数/ λ/ ,/ 随机/ 选择/ α/ ∈/ ZN/ ,/ g/ ,/ u0/ ,/ …/ ,/ un/ ∈/ Gp1/ 和/ Gp3/ 的/ 生成元/ X3/ ./ 对/ 每个/ 属性/ i/ ,/ 选择/ 一个/ 随机数/ si/ ∈/ ZN/ ,/ 计算/ Ti/ =/ gsi/ / i/ ./ 定义/ Waters/ 散列/ 函数/ F/ :/ {/ 0/ ,/ 1/ }/ n/ →/ p1/ 为/ F/ (/ id/ )/ =/ u0/ Π/ j/ ∈/ iduj/ ./ 输出/ 系统/ 公钥/ PK/ =/ G/ / {/ N/ ,/ g/ ,/ e/ (/ g/ ,/ g/ )/ α/ ,/ Ti/ / i/ ,/ u0/ ,/ …/ ,/ un/ }/ ,/ 主/ 密钥/ MSK/ =/ {/ α/ ,/ X3/ }/ ./ KeyGen/ (/ MSK/ ,/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ →/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ 授权/ 机构/ 随机/ 选择/ v2/ ,/ …/ ,/ vh/ ∈/ ZN/ ,/ 构成/ 向量/ 狏/ =/ (/ α/ ,/ v2/ ,/ …/ ,/ vh/ )/ ./ 对/ 矩阵/ 犃/ 的/ 每个/ 行向量/ 犃/ x/ ,/ 随机/ 选择/ rx/ ,/ rx/ ∈/ ZN/ ,/ Ux/ ,/ Vx/ ,/ Wx/ ∈/ Gp3/ ,/ 计算/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 为/ Enc/ (/ M/ ,/ ω/ ,/ P/ ,/ PK/ )/ →/ CT/ ./ 加密算法/ 输入/ 消息/ M/ 、/ 属性/ 集合/ ω/ 、/ 模式/ P/ =/ Pip/ ‖/ / ‖/ Pis/ 和/ 公钥/ PK/ ./ 随机/ 选择/ t/ ∈/ ZN/ ,/ 计算/ 密文/ CT/ 如下/ :/ C1/ =/ M/ ·/ e/ (/ g/ ,/ g/ )/ α/ t/ ,/ C2/ =/ gt/ ,/ C3/ ,/ i/ =/ Tti/ / i/ ∈/ ω/ ,/ C4/ =/ (/ C4/ ,/ ip/ ,/ is/ =/ F/ (/ Pip/ ‖/ 0/ …/ 0/ ‖/ Pis/ )/ t/ ,/ 其中/ ,/ 位串/ Pip/ ‖/ 0/ …/ 0/ ‖/ Pis/ 的/ 长度/ 为/ n/ ,/ 0/ 的/ 个数/ 为/ n/ -/ ip/ -/ is/ ,/ 即用/ n/ -/ ip/ -/ is/ 个/ 0/ 替代/ P/ 中/ 的/ 通配符/ ./ Dec/ (/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ CT/ ,/ PK/ )/ →/ M/ ./ 解密/ 算法/ 收到/ 在/ P/ 和/ ω/ 下/ 加密/ 的/ 密文/ CT/ 时/ ,/ 如果/ id/ ∈/ / P/ 且/ ω/ 满足/ (/ 犃/ ,/ ρ/ )/ ,/ 首先/ 计算/ :/ C4/ =/ F/ (/ id/ )/ t/ =/ C4/ ,/ ip/ ,/ is/ Π/ j/ ∈/ id/ ,/ j/ =/ ip/ +/ 1/ ,/ …/ ,/ n/ -/ isC4/ ,/ j/ ./ 然后/ ,/ 计算/ 常量/ cx/ 使得/ ∑/ ρ/ (/ x/ )/ ∈/ ω/ 并/ 计算/ ∏/ ρ/ (/ x/ )/ ∈/ ω/ =/ ∏/ ρ/ (/ x/ )/ ∈/ ω/ =/ e/ (/ g/ ,/ g/ )/ t/ ∑/ ρ/ (/ x/ )/ ∈/ ω/ 最后/ ,/ 恢复/ 消息/ M/ =/ C1/ // Me/ (/ g/ ,/ g/ )/ t/ α/ ./ 3.3/ 安全性/ 证明/ 为了/ 证明/ GWABE/ 方案/ 是/ 完全/ 安全/ 的/ ,/ 我们/ 需要/ 首先/ 定义/ 半/ 功能/ 密文/ 和/ 半/ 功能/ 私钥/ ./ 令/ 1/ =/ (/ 1/ ,/ 0/ ,/ …/ ,/ 0/ )/ ,/ g2/ 为/ 子群/ Gp2/ 的/ 生成元/ ./ 半/ 功能/ 密文/ ./ 加密算法/ 首先/ 计算/ 消息/ M/ 的/ 正规/ 密文/ ,/ 然后/ ,/ 选择/ 随机数/ c/ ∈/ ZN/ ,/ 对/ 每个/ 属性/ i/ ∈/ ω/ ,/ 选择/ 随机数/ zi/ ∈/ ZN/ ,/ 为/ 矩阵/ 犃/ 的/ 每个/ 行向量/ 犃/ x/ ,/ 随机/ 选择/ Rx/ ,/ Rx/ ∈/ Gp2/ ,/ 计算/ 半/ 功能/ 密文/ 为/ C1/ =/ M/ ·/ e/ (/ g/ ,/ g/ )/ α/ t/ ,/ C2/ =/ gtgcC4/ =/ (/ C4/ ,/ ip/ ,/ is/ =/ F/ (/ Pip/ ‖/ 0/ …/ 0/ ‖/ Pis/ )/ tRx/ ,/ 半/ 功能/ 私钥/ ./ 密钥/ 生成/ 算法/ 首先/ 为/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 生成/ 正规/ 密钥/ ,/ 选择/ 随机/ 向量/ 狏/ ∈/ Zh/ 数/ γ/ x/ ∈/ ZN/ ,/ 令/ δ/ x/ =/ 犃/ x/ ·/ 狏/ ,/ 计算/ I/ 型/ 半/ 功能/ 私钥/ 为/ II/ 型/ 半/ 功能/ 私钥/ 为/ 注意/ :/ 当/ 密文/ 的/ 属性/ 满足/ 访问/ 结构/ 且/ 用户/ 身份/ 匹配/ 密文/ 中/ 的/ 模式/ 时/ ,/ 正规/ 私钥/ 可以/ 解密/ 半/ 功能/ 密文/ ,/ 半/ 功能/ 私钥/ 也/ 可以/ 解密/ 正规/ 密文/ ,/ 但/ 半/ 功能/ 私钥/ 不能/ 解密/ 半/ 功能/ 密文/ ,/ 因为/ 存在/ 一个/ 多余/ 项/ e/ (/ g2/ ,/ g2/ )/ ∑/ ρ/ (/ x/ )/ ∈/ ω/ 若/ 狏/ ·/ 1/ =/ 0/ 且/ id/ ∈/ / P/ ,/ 我们/ 称/ I/ 型/ 半/ 功能/ 私钥/ 为/ I/ 型/ 名义/ 半/ 功能/ 私钥/ ,/ 注意/ :/ I/ 型/ 名义/ 半/ 功能/ 私钥/ 可以/ 解密/ 相应/ 的/ 半/ 功能/ 密文/ ./ 该/ GWABE/ 方案/ 的/ 安全性/ 依赖于/ 2.3/ 节中/ 给出/ 的/ 假设/ 1/ ~/ 3/ ,/ 我们/ 利用/ 混合/ 争论/ 技术/ ,/ 借助/ 一系列/ 相邻/ 游戏/ (/ GameReal/ ,/ Game0/ ,/ Game1/ ,/ 1/ ,/ Game1/ ,/ 2/ ,/ …/ ,/ Gamek/ -/ 1/ ,/ 2/ ,/ Gamek/ ,/ 1/ ,/ Gamek/ ,/ 2/ ,/ …/ ,/ Gameq/ -/ 1/ ,/ 2/ ,/ Gameq/ ,/ 1/ ,/ Gameq/ ,/ 2/ ,/ GameFinal/ )/ 的/ 不可/ 区分/ 性/ 证明/ 该/ 方案/ 的/ 安全性/ ,/ 其中/ ,/ q/ 是/ 敌手/ 询问/ 密钥/ 的/ 最大/ 次数/ ./ GameReal/ :/ 一个/ 真实/ 的/ GWABE/ 系统/ 的/ 安全性/ 游戏/ ,/ 私钥/ 和/ 密文/ 都/ 是/ 正规/ 的/ ./ Game0/ :/ 与/ GameReal/ 类似/ ,/ 除了/ 挑战/ 密文/ 是/ 半/ 功能/ 密文/ ./ Gamek/ ,/ 1/ :/ 与/ Game0/ 类似/ ,/ 除了/ 前/ k/ -/ 1/ 次/ 询问/ 的/ 私钥/ 是/ II/ 型/ 半/ 功能/ 的/ ,/ 第/ k/ 次/ 询问/ 私钥/ 是/ I/ 型/ 半/ 功能/ 的/ ,/ 剩余/ 的/ 私钥/ 是/ 正规/ 的/ ./ Gamek/ ,/ 2/ :/ 与/ Game0/ 类似/ ,/ 除了/ 前/ k/ 次/ 询问/ 的/ 私钥/ 是/ II/ 型/ 半/ 功能/ 的/ ,/ 剩余/ 的/ 私钥/ 是/ 正规/ 的/ ./ GameFinal/ :/ 在/ 这个/ 安全性/ 游戏/ 中/ ,/ 所有/ 询问/ 私钥/ 都/ 是/ II/ 型/ 半/ 功能/ 的/ ,/ 且/ 挑战/ 密文/ 是/ 对/ 一个/ 随机/ 明文/ 加密/ 生成/ 的/ 半/ 功能/ 密文/ ./ 引理/ 1/ ./ 如果/ 存在/ 一个/ 多项式/ 时间/ (/ PPT/ )/ 算法/ / (/ 敌手/ )/ 使得/ GameRealAdv/ / -/ Game0Adv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ PPT/ 算法/ / 以/ ε/ 的/ 优势/ 攻破/ 假设/ 1/ ./ 证明/ ./ 挑战者/ / 接收/ 到/ 假设/ 1/ 的/ 条件/ {/ g/ ,/ X3/ ,/ T/ }/ ,/ 能够/ 模拟/ GameReal/ 或/ Game0/ ./ / 设置/ 公共/ 参数/ 如下/ :/ 随机/ 选择/ α/ ,/ si/ ∈/ ZN/ (/ / i/ )/ ,/ 向量/ τ/ =/ (/ τ/ y/ )/ y/ =/ 0/ ,/ …/ ,/ n/ ∈/ N/ ,/ 计算/ 狌/ =/ (/ uy/ =/ g/ τ/ y/ )/ y/ =/ 0/ ,/ …/ ,/ n/ ,/ 生成/ 公钥/ PK/ =/ Zn/ +/ 1/ {/ N/ ,/ g/ ,/ 狌/ ,/ e/ (/ g/ ,/ g/ )/ α/ ,/ Ti/ =/ gsi/ / i/ }/ 并/ 将/ 其/ 发送给/ 敌手/ / ,/ Page6/ 保存/ 主/ 密钥/ MSK/ =/ {/ α/ ,/ X3/ }/ ./ 当/ / 询问/ 私钥/ 时/ ,/ / 利用/ MSK/ 和/ 密钥/ 生成/ 算法/ 给/ / 颁发/ 正规/ 私钥/ ./ / 用/ 属性/ 集/ ω/ 和/ 身份/ 模式/ P/ =/ Pip/ ‖/ / ‖/ Pis/ 对/ 消息/ Mb/ 进行/ 加密/ ,/ 令/ T/ 的/ Gp1/ 部分/ 为/ gt/ ,/ 生成/ 挑战/ 密文/ 为/ C1/ =/ Mb/ ·/ e/ (/ g/ ,/ T/ )/ α/ ,/ C2/ =/ T/ ,/ C3/ ,/ i/ =/ Tsi/ / i/ ∈/ ω/ ,/ C4/ =/ (/ C4/ ,/ ip/ ,/ is/ =/ T/ τ/ 0/ +/ ∑/ j/ ∈/ Pip/ ‖/ Pis/ 注意/ :/ 挑战/ 密文/ 隐式/ 的/ 设置/ zi/ =/ si/ ,/ 但是/ ,/ 由/ 中国/ 剩余/ 定理/ 可知/ ,/ simodp1/ 与/ zimodp2/ 是/ 无关/ 的/ ./ 如果/ T/ =/ gt/ ∈/ Gp1/ ,/ 上述/ 密文/ 是/ 一个/ 均匀分布/ 的/ 正规/ 密文/ ;/ 如果/ T/ =/ gtX2/ ∈/ Gp1p2/ ,/ 上述/ 密文/ 是/ 一个/ 均匀分布/ 的/ 半/ 功能/ 密文/ ./ 因此/ ,/ / 可以/ 根据/ / 的/ 输出/ 以/ ε/ 优势/ 攻破/ 假设/ 1/ ./ 引理/ 2/ ./ 如果/ 存在/ 一个/ PPT/ 算法/ / (/ 敌手/ )/ 使得/ Gamek/ -/ 1/ ,/ 2Adv/ / -/ Gamek/ ,/ 1Adv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ PPT/ 算法/ / 以/ 几乎/ 为/ ε/ 的/ 优势/ 攻破/ 假设/ 2/ ./ 证明/ ./ 挑战者/ / 接收/ 到/ 假设/ 2/ 的/ 条件/ {/ g/ ,/ X3/ ,/ gtX2/ ,/ Y2Y3/ ,/ T/ }/ ,/ 能够/ 模拟/ Gamek/ -/ 1/ ,/ 2/ 或/ Gamek/ ,/ 1/ ./ / 设置/ 公共/ 参数/ 如下/ :/ 随机/ 选择/ α/ ,/ si/ ∈/ ZN/ (/ / i/ )/ ,/ 向量/ τ/ =/ (/ τ/ y/ )/ y/ =/ 0/ ,/ …/ ,/ n/ ∈/ Zn/ +/ 1/ 成公钥/ PK/ =/ {/ N/ ,/ g/ ,/ 狌/ ,/ e/ (/ g/ ,/ g/ )/ α/ ,/ Ti/ =/ gsi/ / i/ }/ 并/ 发送给/ 敌手/ / ,/ 保存/ 主/ 密钥/ MSK/ =/ {/ α/ ,/ X3/ }/ ./ / 用/ 属性/ 集/ ω/ 和/ 身份/ 模式/ P/ =/ Pip/ ‖/ / ‖/ Pis/ 对/ 明文/ Mb/ 进行/ 加密/ ,/ 生成/ 挑战/ 密文/ 为/ C1/ =/ Mb/ ·/ e/ (/ g/ ,/ g/ )/ α/ t/ =/ Mb/ ·/ e/ (/ g/ ,/ gtX2/ )/ α/ ,/ C2/ =/ gtX2/ ,/ C3/ ,/ i/ =/ (/ gtX2/ )/ si/ / i/ ∈/ ω/ ,/ C4/ =/ (/ C4/ ,/ ip/ ,/ is/ =/ (/ gtX2/ )/ τ/ 0/ +/ ∑/ j/ ∈/ Pip/ ‖/ Pis/ 挑战/ 密文/ 隐式/ 的/ 设置/ zi/ =/ si/ ,/ 但是/ simodp1/ 与/ zimodp2/ 是/ 无关/ 的/ ./ 下面/ ,/ 我们/ 将/ 私钥/ 询问/ 分为/ 3/ 部分/ ./ (/ 1/ )/ 当/ / 询问/ 私钥/ 次数/ 大于/ k/ 时/ ,/ / 利用/ MSK/ 和/ 私钥/ 生成/ 算法/ 给/ / 颁发/ 相应/ 的/ 正规/ 私钥/ ./ (/ 2/ )/ 当/ / 询问/ 私钥/ 次数/ 小于/ k/ 时/ ,/ / 选择/ 随机/ 向量/ 狏/ ,/ 狏/ 2/ ∈/ ZhWx/ ,/ Vx/ ,/ Ux/ ∈/ Gp3/ ,/ 计算/ II/ 型/ 半/ 功能/ 私钥/ 为/ K1x/ =/ g/ 犃/ x/ ·/ 狏/ TrxK2x/ =/ grxVx/ ,/ K3x/ =/ grxUx/ ./ 注意/ :/ 若/ Y2/ =/ gc/ 狏/ =/ c/ 狏/ 2/ ./ (/ 3/ )/ 当/ / 进行/ 第/ k/ 次/ 私钥/ 询问/ 时/ ,/ / 选择/ 随机/ 向量/ 狌/ ,/ 狌/ ∈/ Zh/ 部分/ 为/ gr/ ,/ / 隐式/ 的/ 设置/ 狏/ =/ r/ 狌/ +/ 狌/ ,/ 随机/ 选择/ γ/ x/ ,/ rx/ ∈/ ZN/ ,/ Wx/ ,/ Vx/ ,/ Ux/ ∈/ Gp3/ ,/ 计算/ 注意/ :/ 在/ 这个/ 私钥/ 中/ ,/ rx/ =/ r/ ·/ γ/ x/ ,/ 但是/ rxmodp1/ 与/ γ/ xmodp2/ 是/ 无关/ 的/ ./ 当/ T/ ∈/ Gp1p3/ ,/ 这个/ 私钥/ 是/ 正规/ 私钥/ ;/ 当/ T/ ∈/ G/ ,/ 这个/ 私钥/ 是/ I/ 型/ 半/ 功能/ 私钥/ ,/ 此时/ ,/ 若/ id/ ∈/ / P/ ,/ 这个/ 私钥/ 是/ I/ 型/ 名义/ 半/ 功能/ 私钥/ ./ 下面/ 我们/ 证明/ ,/ 当/ / 的/ 第/ k/ 个/ 询问/ 私钥/ 不能/ 解密/ 挑战/ 密文/ 时/ ,/ / 无法/ 区分/ 第/ k/ 个/ 私钥/ 是/ I/ 型/ 名义/ 半/ 功能/ 私钥/ 还是/ I/ 型/ 半/ 功能/ 私钥/ ./ 注意/ :/ 在/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 中/ ,/ 每个/ 属性/ 在/ ρ/ 中/ 至多/ 出现/ 一次/ ./ 当/ 属性/ i/ / ω/ 时/ ,/ 由于/ 除了/ 第/ k/ 个/ 以外/ 的/ 半/ 功能/ 私钥/ 都/ 是/ II/ 型/ 的/ ,/ 所以/ zi/ 仅/ 可能/ 在/ 第/ k/ 个/ 私钥/ 中/ 出现/ ./ 由/ 安全性/ 模型/ 可知/ ,/ 第/ k/ 个/ 询问/ 私钥/ 无法/ 解密/ 挑战/ 密文/ ,/ 所以/ 当/ id/ ∈/ / P/ ,/ 犃/ 中/ ρ/ (/ x/ )/ ∈/ ω/ 的/ 所有/ 行/ x/ 生成/ 的/ 行/ 空间/ 犚/ 不/ 包含/ 1/ ./ 因此/ ,/ 存在/ 一个/ 向量/ 狑/ 使得/ 狑/ 正交/ 于/ 犚/ ,/ 但/ 狑/ 不/ 正交/ 于/ 1/ ,/ 即/ 1/ ·/ 狑/ ≠/ 0/ ./ 我们/ 固定/ 一个/ 包含/ 狑/ 的/ 基/ ,/ 则/ 存在/ f/ ∈/ ZN/ ,/ 使得/ 狌/ =/ f/ 狑/ +/ 狌/ 1modp2/ ,/ 其中/ 狌/ 1/ 属于/ 除/ 狑/ 外/ 的/ 基/ 向量/ 扩张/ 的/ 空间/ 中/ ,/ 注意/ 到/ 狌/ 1/ 是/ 均匀分布/ 的/ ,/ 且/ 无法/ 揭露/ f/ 的/ 任何/ 信息/ ./ 由于/ 狌/ ·/ 1/ =/ f/ ·/ 1/ ·/ 狑/ +/ 1/ ·/ 狌/ 1/ ,/ 且/ 1/ ·/ 狑/ ≠/ 0/ ,/ 所以/ 狌/ ·/ 1/ 与/ f/ 相关/ ./ 当/ ρ/ (/ x/ )/ ∈/ ω/ 时/ ,/ 犃/ x/ ·/ 狌/ =/ 犃/ x/ ·/ (/ f/ ·/ 狑/ +/ 狌/ 1/ )/ =/ 犃/ x/ ·/ 狌/ 1/ ,/ 与/ f/ 无关/ ./ 当/ ρ/ (/ x/ )/ / ω/ 时/ ,/ f/ ·/ 狑/ 仅/ 出现/ 在/ 犃/ x/ ·/ 狌/ +/ γ/ xz/ ρ/ (/ x/ )/ 中/ ,/ 当/ γ/ x/ ≠/ 0modp2/ 时/ ,/ 每/ 项/ 犃/ x/ ·/ 狌/ +/ γ/ xz/ ρ/ (/ x/ )/ 都/ 引入/ 一个/ 新/ 的/ 未知量/ z/ ρ/ (/ x/ )/ ,/ 且/ z/ ρ/ (/ x/ )/ 不/ 出现/ 在/ 其它/ 项中/ ,/ 因此/ ,/ / 无法/ 从/ 这些/ 项中/ 得知/ f/ 的/ 任何/ 信息/ ./ 准确/ 地说/ ,/ 无论/ 狌/ 的/ 第一个/ 分量/ 为何/ 值/ ,/ 上述/ 方程/ 都/ 有/ 相同/ 个数/ 的/ 解/ ,/ 因此/ ,/ 当/ 所有/ 的/ γ/ xmodp2/ 都/ 不/ 为/ 0/ 时/ ,/ 在/ / 看来/ ,/ 挑战/ 密文/ 和/ 第/ k/ 个/ 私钥/ 以/ 几乎/ 为/ 1/ 的/ 概率/ 均匀分布/ ./ 因此/ ,/ 当/ T/ ∈/ Gp1p3/ ,/ / 完美/ 仿真/ Gamek/ -/ 1/ ,/ 2/ ;/ 当/ T/ ∈/ G/ ;/ / 以/ 几乎/ 为/ 1/ 的/ 概率/ 完美/ 仿真/ Gamek/ ,/ 1/ ,/ 所以/ ,/ / 可以/ 根据/ / 的/ 输出/ 以/ 几乎/ 为/ ε/ 的/ 概率/ 攻破/ 假设/ 2/ ./ 引理/ 3/ ./ 如果/ 存在/ 一个/ PPT/ 算法/ / 使得/ Gamek/ ,/ 1Adv/ / -/ Gamek/ ,/ 2Adv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ PPT/ 算法/ / 以/ ε/ 的/ 优势/ 攻破/ 假设/ 2/ ./ 证明/ ./ 挑战者/ / 接收/ 到/ 假设/ 2/ 的/ 条件/ {/ g/ ,/ X3/ ,/ gtX2/ ,/ Y2Y3/ ,/ T/ }/ ,/ 能够/ 模拟/ Gamek/ ,/ 1/ 或/ Gamek/ ,/ 2/ ./ / 设置/ 公共/ 参数/ 如下/ :/ 随机/ 选择/ α/ ,/ si/ ∈/ ZN/ (/ / i/ )/ ,/ 向量/ τ/ =/ (/ τ/ y/ )/ y/ =/ 0/ ,/ …/ ,/ n/ ∈/ Zn/ +/ 1/ 公钥/ PK/ =/ {/ N/ ,/ g/ ,/ 狌/ ,/ e/ (/ g/ ,/ g/ )/ α/ ,/ Ti/ =/ gsi/ / i/ }/ 并/ 将/ 其/ 发送给/ 敌手/ / ,/ 保存/ 主/ 密钥/ MSK/ =/ {/ α/ ,/ X3/ }/ ./ 挑战/ 密文/ 、/ 前/ k/ -/ 1/ 个/ II/ 型/ 半/ 功能/ 私钥/ 和/ 询问/ 次数/ 大于/ k/ 的/ 所有/ 正规/ 私钥/ 的/ 构造方法/ 与/ 引理/ 2/ 相同/ ./ 当/ / 进行/ 第/ k/ 次/ 私钥/ 询问/ 时/ ,/ / 选择/ 随机/ 向量/ 狏/ ,/ Page7/ 狏/ ∈/ ZhWx/ ∈/ Gp3/ ,/ 计算/ N/ ,/ 使得/ 狏/ ·/ 1/ =/ α/ ./ 随机/ 选择/ γ/ x/ ,/ rx/ ∈/ ZN/ ,/ Ux/ ,/ Vx/ ,/ K1x/ =/ g/ 犃/ x/ ·/ 狏/ T/ γ/ xs/ ρ/ (/ x/ )/ F/ (/ id/ )/ rxWx/ (/ Y2Y3/ )/ 犃/ x/ ·/ 狏/ ,/ K2x/ =/ T/ γ/ xVx/ ,/ K3x/ =/ grxUx/ ./ 注意/ :/ 若/ T/ 的/ Gp1/ 部分/ 为/ gr/ ,/ 则/ rx/ =/ r/ ·/ γ/ x/ ./ 如果/ T/ ∈/ G/ ,/ 则/ 这个/ 私钥/ 是/ 均匀分布/ 的/ I/ 型/ 半/ 功能/ 私钥/ ;/ 如果/ T/ ∈/ Gp1p3/ ,/ 则/ 这个/ 私钥/ 是/ 均匀分布/ 的/ II/ 型/ 半/ 功能/ 私钥/ ./ 因此/ ,/ / 将/ 根据/ / 的/ 输出/ 以/ ε/ 的/ 概率/ 攻破/ 假设/ 2/ ./ 引理/ 4/ ./ 如果/ 存在/ 一个/ PPT/ 算法/ / 使得/ Gameq/ ,/ 2Adv/ / -/ GameFinalAdv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ PPT/ 算法/ / 以/ ε/ 的/ 优势/ 攻破/ 假设/ 3/ ./ 证明/ ./ 挑战者/ / 接收/ 到/ 假设/ 3/ 的/ 条件/ {/ g/ ,/ X3/ ,/ g/ α/ X2/ ,/ gtY2/ ,/ Z2/ ,/ T/ }/ ,/ 能够/ 模拟/ Gameq/ ,/ 2/ 或/ GameFinal/ ./ / 设置/ 公共/ 参数/ 如下/ :/ 随机/ 选择/ si/ ∈/ ZN/ (/ / i/ )/ ,/ 向量/ τ/ =/ (/ τ/ y/ )/ y/ =/ 0/ ,/ …/ ,/ n/ ∈/ Zn/ +/ 1/ 成公钥/ PK/ =/ {/ N/ ,/ g/ ,/ 狌/ ,/ e/ (/ g/ ,/ g/ α/ X2/ )/ ,/ Ti/ =/ gsi/ / i/ }/ 并/ 将/ 其/ 发送给/ 敌手/ / ,/ 注意/ :/ / 不/ 知道/ 主/ 密钥/ 中/ 的/ α/ ./ / 用/ 属性/ 集/ ω/ 和/ 身份/ 模式/ P/ =/ Pip/ ‖/ / ‖/ Pis/ 生成/ 挑战/ 密文/ 为/ C1/ =/ MbT/ ,/ C2/ =/ gtX2/ ,/ C3/ ,/ i/ =/ (/ gtX2/ )/ si/ / i/ ∈/ ω/ ,/ C4/ =/ (/ (/ gtX2/ )/ τ/ 0/ +/ ∑/ j/ ∈/ Pip/ ‖/ Pis/ 如果/ T/ =/ e/ (/ g/ ,/ g/ )/ α/ t/ ,/ 上述/ 密文/ 为/ Mb/ 的/ 半/ 功能/ 密文/ ,/ 如果/ T/ 是/ GT/ 中/ 的/ 随机/ 元素/ ,/ 上述/ 密文/ 为/ 随机/ 消息/ 的/ 半/ 功能/ 密文/ ,/ 此时/ / 无法/ 获知/ b/ 的/ 任何/ 信息/ ./ 为了/ 给/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 生成/ II/ 型/ 半/ 功能/ 私钥/ ,/ / 隐式/ 的/ 选择/ 向量/ 狏/ =/ (/ α/ ,/ v2/ ,/ …/ ,/ vh/ )/ ,/ 其中/ ,/ v2/ ,/ …/ ,/ vh/ ←/ / / RZN/ ,/ 然后/ ,/ 随机/ 选择/ 向量/ 狏/ ∈/ ZhWx/ ∈/ Gp3/ ,/ rx/ ,/ rx/ ∈/ ZN/ ,/ 计算/ K1x/ =/ (/ g/ α/ X2/ )/ 犃/ x/ ,/ 1g/ ∑/ hK2x/ =/ grxVx/ ,/ K3x/ =/ grxUx/ ./ 注意/ :/ 若/ X2/ =/ gc/ 图/ 1/ 基于/ 完全/ 子树/ 构架/ 和/ GWABE/ 的/ ABTR/ 方案/ ABTR/ 的/ 目标/ 是/ 追踪/ 所有/ 叛徒/ 的/ 身份/ ,/ 并/ 将/ 其/ 从/ 系统/ 中/ 撤销/ ,/ 使得/ 盗版/ 解密/ 设备/ 无效/ ,/ 即/ 允许/ 任何/ 用户/ 在/ ω/ 和/ / 下/ 加密/ 消息/ ,/ 使得/ 用户/ 是/ 未/ 撤销/ 用户/ ,/ 且/ 密文/ 中/ ω/ 满足/ 该/ 用户/ 的/ 访问/ 结构/ ,/ 才能/ 解密/ 密文/ ./ 同时/ ,/ / 中/ 的/ 所有/ 用户/ 联合/ 起来/ 也/ 无法/ 解密/ 则/ δ/ x/ =/ 犃/ x/ ·/ 狏/ 2/ ,/ 其中/ 狏/ 2/ =/ d/ 狏/ +/ (/ c/ ,/ 0/ ,/ …/ ,/ 0/ )/ ,/ 从而/ 可/ 得/ 上述/ II/ 型/ 半/ 功能/ 私钥/ 是/ 均匀分布/ 的/ ./ 综上所述/ ,/ / 可以/ 根据/ / 的/ 输出/ 以/ ε/ 的/ 概率/ 攻破/ 假设/ 3/ ./ 定理/ 1/ ./ 如果/ 假设/ 1/ ~/ 3/ 均/ 成立/ ,/ 则/ 该/ GWABE/ 方案/ 是/ 完全/ 安全/ 的/ ./ 证明/ ./ 根据上述/ 4/ 个/ 引理/ 可知/ ,/ 如果/ 假设/ 1/ ~/ 3/ 成立/ ,/ 则/ 真实/ 游戏/ GameReal/ 和/ GameFinal/ 是/ 不可/ 区分/ 的/ ,/ 又/ 因为/ 在/ 信息论/ 意义/ 上/ GameFinal/ 中/ 的/ b/ 对/ 敌手/ 是/ 隐藏/ 的/ ,/ 所以/ 敌手/ 在/ GameFinal/ 中/ 的/ 优势/ 为/ 0/ ,/ 从而/ 可/ 得/ 敌手/ 在/ 真实/ 游戏/ 中/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 证毕/ ./ 4/ 可追踪/ 并/ 撤销/ 叛徒/ 的/ ABE/ 方案/ (/ ABTR/ )/ 本/ 节/ 利用/ 完全/ 子树/ 构架/ 将/ 第/ 3/ 节/ 的/ GWABE/ 转化成/ ABTR/ 方案/ ./ 在/ 该/ ABTR/ 方案/ 中/ ,/ 令/ / 表示/ 所有/ 用户/ 的/ 集合/ ,/ |/ / |/ 是/ / 中/ 用户/ 的/ 个数/ ,/ n/ =/ 2/ ,/ / 为/ 撤销/ 用户/ 的/ 集合/ ./ 我们/ 首先/ 构造/ 一棵/ 深/ log/ |/ / |/ 度为/ n/ 的/ 完全/ 二叉树/ ,/ 在/ 该/ 树/ 的/ 每/ 一层/ 上/ ,/ 左/ 分支/ 对应/ 0/ ,/ 右/ 分支/ 对应/ 1/ ./ 与/ GWABE/ 方案/ 相同/ ,/ 每个/ 用户/ 由/ 一个/ 元组/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 来/ 标识/ ,/ 用户/ 的/ 身份/ id/ ∈/ {/ 0/ ,/ 1/ }/ n/ 被/ 指定/ 到/ 二叉树/ 的/ 一个/ 叶子/ 节点/ ./ 如果/ 用/ GWABE/ 在/ 节点/ S/ 和/ 属性/ 集/ ω/ 下/ 加密/ 消息/ ,/ 我们/ 将/ 用/ 通配符/ 来/ 替代/ S/ 以下/ 的/ 层次/ ,/ 当/ 密文/ 中/ 的/ 属性/ 满足用户/ 的/ 访问/ 结构/ ,/ 且/ 该/ 用户/ 为/ 以/ S/ 为根/ 节点/ 的/ 子树/ 中/ 的/ 用户/ 时/ 才能/ 解密/ 密文/ ./ 如图/ 1/ 所示/ ,/ 叶子/ 节点/ 对应/ 用户/ ,/ Si1/ ,/ …/ ,/ Si4/ 是/ 未/ 撤销/ 用户/ 的/ 一个/ 覆盖/ ,/ 使用/ GWABE/ 在/ 属性/ 集/ ω/ 和/ 子集/ Sij/ (/ 1/ / j/ / 4/ )/ 的/ 身份/ 模式/ 下/ 对/ K/ 进行/ 加密/ ,/ 以/ S4/ 为例/ ,/ 我们/ 用/ GWABE/ ./ Enc/ (/ K/ ,/ ω/ ,/ “/ 11/ / ”/ ,/ PK/ )/ 加密/ K/ ./ ABTR/ 对/ 消息/ M/ 的/ 加密/ 生成/ 的/ 密文/ 为/ {/ ω/ ,/ [/ i1/ ,/ i2/ ,/ i3/ ,/ i4/ ,/ GWABE/ ./ Enc/ (/ K/ ,/ ω/ ,/ “/ 00/ / ”/ ,/ PK/ )/ ,/ …/ ,/ GWABE/ ./ Enc/ (/ K/ ,/ ω/ ,/ “/ 11/ / ”/ ,/ PK/ )/ ]/ ,/ EK/ (/ M/ )/ }/ ,/ 其中/ ,/ K/ 为会话/ 密钥/ ,/ E/ 为/ 对称/ 加密算法/ ./ 密文/ ./ 4.1/ ABTR/ 的/ 定义/ 和/ 安全性/ 模型/ 一个/ ABTR/ 方案/ 由/ 5/ 个/ 算法/ 构成/ :/ 初始化/ (/ Setup/ )/ ,/ 密钥/ 生成/ (/ KeyGen/ )/ ,/ 加密/ (/ Enc/ )/ ,/ 解密/ (/ Dec/ )/ ,/ 叛徒/ 追踪/ (/ Trace/ )/ ./ Page8Setup/ (/ λ/ )/ →/ PK/ ,/ MSK/ ./ 初始化/ 算法/ 输入/ 系统安全/ 参数/ λ/ ,/ 输出/ 系统/ 公钥/ PK/ 和/ 主/ 密钥/ MSK/ ./ KeyGen/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ MSK/ )/ →/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ 密钥/ 生成/ 算法/ 输入/ 用户/ 的/ 身份/ id/ 、/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 、/ 主/ 密钥/ MSK/ ,/ 输出/ 用户/ 私钥/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ Enc/ (/ M/ ,/ ω/ ,/ / ,/ PK/ )/ →/ CT/ ./ 加密算法/ 输入/ 消息/ M/ 、/ 属性/ 集/ ω/ 、/ 撤销/ 列表/ / 和/ 公钥/ PK/ ,/ 输出/ 密文/ CT/ ./ Dec/ (/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ CT/ )/ →/ M/ ./ 解密/ 算法/ 输入/ 密钥/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 和/ 密文/ CT/ ,/ 仅当/ 用户/ 的/ 身份/ id/ ∈/ / \/ / 且/ 密文/ 中/ 的/ ω/ 满足用户/ 的/ 访问/ 结构/ (/ 犃/ ,/ ρ/ )/ 时/ ,/ 输出/ 消息/ M/ ,/ 否则/ ,/ 解密/ 失败/ ./ Trace/ / (/ MSK/ ,/ ω/ ,/ / )/ ./ 叛徒/ 追踪/ 算法/ 输入/ 主/ 密钥/ MSK/ 、/ 属性/ 集合/ ω/ 、/ 撤销/ 列表/ / 、/ 盗版/ 解码器/ / ,/ 输出/ 用户/ 身份/ 的/ 集合/ (/ 称/ 此类/ 用户/ 为/ “/ 叛徒/ ”/ )/ ./ 正确性/ ./ 系统/ 运行/ 初始化/ 算法/ 生成/ PK/ 和/ MSK/ ,/ 对于/ 所有/ 消息/ M/ ∈/ {/ 0/ ,/ 1/ }/ / ,/ id/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 撤销/ 列表/ / ,/ 属性/ 集/ ω/ ,/ 当/ ω/ 满足/ (/ 犃/ ,/ ρ/ )/ 且/ id/ ∈/ / \/ / 时/ ,/ Dec/ (/ KeyGen/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ MSK/ )/ ,/ Enc/ (/ M/ ,/ ω/ ,/ / ,/ PK/ )/ )/ =/ M/ 的/ 概率/ 为/ 1/ ./ 注意/ :/ 本文/ 的/ 叛徒/ 追踪/ 算法/ 基于/ 子集/ 追踪/ 过程/ ,/ 用户/ 只能/ 用/ 叶子/ 节点/ 的/ 私钥/ 解密/ 密文/ ,/ 而/ 叶子/ 节点/ 的/ 私钥/ 直接/ 暴露/ 用户/ 的/ 身份/ ,/ 因此/ ,/ 叛徒/ 追踪/ 算法/ 可以/ 追查/ 到/ 所有/ 叛徒/ ./ 该/ 算法/ 还/ 要求/ 所有/ 盗版/ 解密/ 设备/ 可以/ 重置/ ,/ 即/ 在/ 两次/ 解密/ 之间/ 不/ 保留/ 状态/ 信息/ ,/ 特别/ 的/ ,/ 盗版/ 设备/ 不能/ 自毁/ ./ ABTR/ 的/ 完全/ 安全/ 模型/ 通过/ 挑战者/ / 和/ 敌手/ / 之间/ 的/ 攻击性/ 游戏/ 来/ 定义/ ./ (/ 1/ )/ 初始化/ ./ 挑战者/ / 运行/ Setup/ 算法/ ,/ 生成/ 系统/ 公钥/ PK/ 和/ 主/ 密钥/ MSK/ ,/ 并/ 将/ PK/ 发送给/ 敌手/ / ./ (/ 2/ )/ 阶段/ 1/ ./ 敌手/ 向/ 挑战者/ 询问/ 任意/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 挑战者/ 运行/ 密钥/ 生成/ 算法/ ,/ 将/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 返回/ 给/ 敌手/ ,/ 并/ 将/ id/ 添加/ 到/ 撤销/ 列表/ / (/ / 初始化/ 为空/ )/ ./ (/ 3/ )/ 挑战/ ./ 敌手/ 提交/ 等/ 长/ 消息/ M0/ ,/ M1/ 和/ 挑战/ 属性/ 集/ ω/ / ./ 挑战者/ 随机/ 选取/ 一个/ 比特/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 利用/ ω/ / 和/ / 对/ Mb/ 加密/ ,/ 生成/ 挑战/ 密文/ CT/ / ,/ 并/ 将/ CT/ / 发送给/ 敌手/ ./ (/ 4/ )/ 阶段/ 2/ ./ 重复/ 执行/ 阶段/ 1/ ,/ 但/ 敌手/ 不能/ 询问/ 这/ 类/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 其中/ ω/ / 满足/ (/ 犃/ ,/ ρ/ )/ 且/ id/ ∈/ / \/ / ./ (/ 5/ )/ 猜测/ ./ 敌手/ 输出/ 一个/ 猜测/ 值/ b/ ∈/ {/ 0/ ,/ 1/ }/ ./ 若/ b/ =/ b/ ,/ 则/ 称/ 敌手/ / 赢得/ 这个/ 游戏/ ./ 敌手/ / 在/ 上述/ 游戏/ 中/ 的/ 优势/ Adv/ / ,/ ABTR/ 定义/ 为/ |/ Pr/ [/ b/ =/ b/ ]/ -/ 1/ // 2/ |/ ./ 如果/ 任意/ 多项式/ 时间/ 敌手/ / 赢得/ 上述/ 游戏/ 的/ 优势/ 都/ 是/ 可以/ 忽略/ 的/ ,/ 则/ 称/ ABTR/ 方案/ 是/ 完全/ 安全/ 的/ ./ 4.2/ ABTR/ 方案/ Setup/ (/ λ/ )/ →/ PK/ ,/ MSK/ ./ 可信/ 授权/ 机构/ 执行/ 初始化/ 算法/ ,/ 选择/ 一个/ 阶为/ N/ =/ p1p2p3/ (/ 3/ 个/ 互不/ 相同/ 的/ 素数/ )/ 的/ 双线性/ 群/ G/ ./ 令/ Gpi/ 表示/ 群/ G/ 的/ pi/ 阶/ 子群/ ./ 该/ 算法/ 随机/ 选择/ α/ ∈/ ZN/ ,/ g/ ,/ u0/ ,/ …/ ,/ un/ ∈/ Gp1/ ,/ Gp3/ 的/ 生成元/ X3/ ./ 对/ 每个/ 属性/ i/ ,/ 选择/ 一个/ 随机数/ si/ ∈/ ZN/ ,/ 计算/ Ti/ =/ gsi/ ./ 定义/ Waters/ 散列/ 函数/ F/ :/ {/ 0/ ,/ 1/ }/ n/ →/ p1/ 为/ F/ (/ id/ )/ =/ u0/ Π/ y/ ∈/ iduy/ ./ 输出/ 系统/ 公钥/ PK/ =/ G/ / {/ N/ ,/ g/ ,/ e/ (/ g/ ,/ g/ )/ α/ ,/ Ti/ / i/ ,/ u0/ ,/ …/ ,/ un/ }/ ,/ 主/ 密钥/ MSK/ =/ {/ α/ ,/ X3/ }/ ./ 此外/ ,/ 初始化/ 算法/ 还/ 定义/ 了/ 一个/ 对称/ 加密/ 方案/ (/ EK/ ,/ DK/ )/ 来/ 加密/ 消息/ ./ KeyGen/ (/ MSK/ ,/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ →/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ./ 授权/ 机构/ 随机/ 选择/ v2/ ,/ …/ ,/ vh/ ∈/ ZN/ ,/ 构成/ 向量/ 狏/ =/ (/ α/ ,/ v2/ ,/ …/ ,/ vh/ )/ ./ 对/ 犃/ 的/ 每/ 一行/ 犃/ x/ ,/ 随机/ 选择/ rx/ ,/ rx/ ∈/ ZN/ ,/ Ux/ ,/ Vx/ ,/ Wx/ ∈/ Gp3/ ,/ 计算/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 为/ Enc/ (/ M/ ,/ ω/ ,/ / ,/ PK/ )/ →/ CT/ ./ 加密算法/ 输入/ 消息/ M/ ,/ 属性/ 集/ ω/ ,/ 用户/ 撤销/ 列表/ / 和/ 公钥/ PK/ ./ 该/ 算法/ 运行/ 完全/ 子树/ 构架/ ,/ 将/ 未/ 撤销/ 用户/ / \/ / 划分/ 成/ 不/ 相交/ 子集/ Si1/ ,/ …/ ,/ Sim/ ,/ 每个/ 子集/ Sij/ (/ 1/ / j/ / m/ )/ 对应/ 一个/ 身份/ 模式/ Pij/ =/ idij/ ‖/ / ,/ 其中/ idij/ =/ idij/ ,/ 1idij/ ,/ 2/ …/ idij/ ,/ ip/ 是从/ 根/ 节点/ 到/ 节点/ Sij/ 的/ 道路/ ,/ idij/ 的/ 长度/ 是/ ip/ ./ 然后/ ,/ 加密算法/ 随机/ 选择/ 一个/ 会话/ 密钥/ K/ ,/ 用/ GWABE/ 在/ 每个/ 子集/ 的/ 身份/ 模式/ Pij/ 和/ ω/ 下/ 对/ K/ 进行/ m/ 次/ 加密/ ./ 最后/ ,/ 利用/ 会话/ 密钥/ K/ 对/ 消息/ M/ 进行/ 对称/ 加密/ ,/ 即/ EK/ (/ M/ )/ ./ 下面/ ,/ 我们/ 详细/ 介绍/ 如何/ 用/ GWABE/ 在/ 模式/ Pij/ (/ 1/ / j/ / m/ )/ 和/ ω/ 下/ 对/ K/ 进行/ 加密/ ./ GWABE/ 的/ 加密算法/ 选择/ 一个/ 随机数/ t/ ∈/ ZN/ ,/ 计算/ Cj/ =/ (/ Pij/ ,/ Cj2/ ,/ CjCj1/ =/ Ke/ (/ g/ ,/ g/ )/ α/ t/ ,/ CjCj4/ =/ (/ CjCj/ 输出/ 密文/ CT/ =/ {/ ω/ ,/ [/ i1/ ,/ …/ ,/ im/ ,/ C1/ ,/ …/ ,/ Cm/ ]/ ,/ EK/ (/ M/ )/ }/ ./ Decrypt/ (/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ CT/ ,/ PK/ )/ →/ M/ ./ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 收到/ 用/ ω/ 和/ / 加密/ 的/ 密文/ CT/ ,/ 如果/ ω/ 满足/ (/ 犃/ ,/ ρ/ )/ 且/ id/ ∈/ / \/ / ,/ 用户/ 首先/ 找到/ j/ 使得/ id/ ∈/ / Pij/ ,/ 并/ 计算/ 常量/ cx/ 使得/ ∑/ ρ/ (/ x/ )/ ∈/ ω/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 解密/ Cj/ 得到/ K/ ./ 最后/ ,/ 计算/ DK/ (/ EK/ (/ M/ )/ )/ 得到/ 消息/ M/ ./ 3/ ,/ i/ ,/ Cj/ 下面/ ,/ 我们/ 解释/ 如何/ 解密/ Cj/ 得到/ K/ ,/ 计算/ CjCjPage9Trace/ / (/ MSK/ ,/ ω/ ,/ / )/ ./ 可信/ 授权/ 机构/ 执行/ 叛徒/ 追踪/ 算法/ ,/ 该/ 算法/ 得到/ 一个/ 盗版/ 解码器/ / ,/ 它/ 能/ 以/ 大于/ 门/ 限值/ q/ 的/ 概率/ p/ 解密/ 在/ ω/ 和/ / 下/ 加密/ 的/ 密文/ ./ 当/ / 中/ 包含/ t/ 个/ 叛徒/ 的/ 密钥/ ,/ 追踪/ 算法/ 执行/ 以下/ 子集/ 追踪/ 过程/ tlog2/ |/ / |/ 次/ ,/ 追查/ 到/ 所有/ 叛徒/ 的/ 确切/ 身份/ ,/ 并/ 将/ 其/ 添加/ 到/ 撤销/ 列表/ / ./ (/ 1/ )/ 追踪/ 算法/ 用/ 撤销/ 列表/ / 生成/ 一个/ 划分/ / \/ / =/ Si1/ ∪/ …/ ∪/ Sim/ ,/ 令/ pj/ (/ 0/ / j/ / m/ )/ 表示/ / 正确/ 解密/ 追踪/ 密文/ {/ ω/ ,/ [/ i1/ ,/ i2/ ,/ …/ ,/ im/ ,/ GWABE/ ./ Enc/ (/ RK/ ,/ ω/ ,/ Pi1/ ,/ PK/ )/ ,/ …/ ,/ GWABE/ ./ Enc/ (/ RK/ ,/ ω/ ,/ Pij/ ,/ PK/ )/ ,/ GWABE/ ./ Enc/ (/ K/ ,/ ω/ ,/ Pi/ (/ j/ +/ 1/ )/ ,/ PK/ )/ ,/ …/ ,/ GWABE/ ./ Enc/ (/ K/ ,/ ω/ ,/ Pim/ ,/ PK/ )/ ]/ ,/ EK/ (/ M/ )/ }/ 的/ 概率/ ,/ 其中/ RK/ 是/ 一个/ 与会/ 话/ 密钥/ K/ 等长/ 的/ 随机/ 位串/ ,/ 注意/ :/ p0/ =/ p/ ,/ pm/ =/ 0/ ./ (/ 2/ )/ 追踪/ 算法/ 对/ 当前/ 划分/ 使用/ 子集/ 追踪/ 过程/ ,/ 子集/ 追踪/ 过程/ 使用/ 类似/ 二分/ 查找/ 法/ 找到/ 索引/ j/ 使得/ |/ pj/ -/ 1/ -/ pj/ |/ / p/ // m/ ./ 初始/ 搜索/ 区间/ 为/ [/ 0/ ,/ m/ ]/ ,/ 子集/ 追踪/ 过程/ 递归/ 地/ 执行/ 搜索/ 过程/ 将/ 区间/ 缩短/ 到/ [/ a/ ,/ b/ ]/ ./ 在/ 每次/ 递归/ 执行/ 时/ ,/ 计算/ 中值/ c/ =/ (/ a/ +/ b/ )/ // 2/ 和/ pc/ ,/ 如果/ |/ pc/ -/ pa/ |/ / |/ pb/ -/ pc/ |/ ,/ 将/ 搜索/ 区间/ 折半/ 到/ [/ a/ ,/ c/ ]/ ,/ 否则/ ,/ 区间/ 折半/ 到/ [/ c/ ,/ b/ ]/ ./ 经过/ log2m/ 次/ 递归/ 执行/ ,/ 当/ a/ =/ b/ -/ 1/ 时/ ,/ 子集/ 追踪/ 过程/ 结束/ 并/ 将/ b/ 返回/ 给/ 索引/ j/ ,/ 输出/ 叛徒/ 所在/ 子集/ Sij/ (/ 3/ )/ 如果/ Sij/ 中/ 用户/ 个数/ 大于/ 1/ ,/ 将/ Sij/ 分割/ 为/ 2/ 个/ 大小/ 相同/ 的/ 子集/ Sij/ ,/ 1/ ,/ Sij/ ,/ 2/ ,/ 得到/ 一个/ 新/ 的/ 划分/ Si1/ ,/ …/ ,/ Si/ (/ j/ -/ 1/ )/ ,/ Sij/ ,/ 1/ ,/ Sij/ ,/ 2/ ,/ Si/ (/ j/ +/ 1/ )/ ,/ …/ ,/ Sim/ ,/ 追踪/ 算法/ 对/ 新/ 的/ 划分/ 继续/ 使用/ 二分/ 查找/ 法/ 搜索/ 包含/ 叛徒/ 的/ 子集/ ./ 如果/ Sij/ 中仅/ 包含/ 一个/ 用户/ ,/ 该/ 用户/ 一定/ 是/ 叛徒/ 并/ 将/ 其/ 撤销/ ,/ 得到/ 一个/ 新/ 的/ 撤销/ 列表/ ,/ 则/ 当前/ 划分/ 为/ Si1/ ,/ …/ ,/ Si/ (/ j/ -/ 1/ )/ ,/ Si/ (/ j/ +/ 1/ )/ ,/ …/ ,/ Sim/ ./ 此时/ ,/ 追踪/ 算法/ 在/ 该/ 划分/ 下/ 检测/ 解码器/ / 解密/ 密文/ 的/ 概率/ p/ ,/ 当/ p/ 大于/ 门/ 限值/ q/ 时/ ,/ 追踪/ 算法/ 对此/ 划分/ 继续/ 使用/ 二分/ 查找/ 法/ 搜索/ 包含/ 叛徒/ 的/ 子集/ ./ 否则/ ,/ 追踪/ 算法/ 结束/ ,/ 并/ 输出/ 所有/ 叛徒/ ./ 4.3/ 安全性/ 证明/ 该/ ABTR/ 的/ 安全性/ 依赖于/ GWABE/ 的/ 安全性/ ./ 我们/ 利用/ 混合/ 争论/ 技术/ ,/ 借助/ 一系列/ 相邻/ 游戏/ (/ TRGame0/ ,/ TRGame1/ ,/ …/ ,/ TRGamem/ )/ 的/ 不可/ 区分/ 性/ 证明/ ABTR/ 的/ 安全性/ ,/ 其中/ ,/ m/ 是/ / \/ / 的/ 划分/ 中/ 子集/ 的/ 个数/ ./ TRGame0/ :/ 是/ 真实/ ABTR/ 的/ 安全性/ 游戏/ ./ / 接收/ 到/ PK/ 后/ ,/ 询问/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 挑战者/ / 使用/ 密钥/ 生成/ 算法/ ABTR/ ./ KeyGen/ (/ MSK/ ,/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 生成/ 私钥/ did/ ,/ (/ 犃/ ,/ ρ/ )/ ,/ 并/ 将/ 其/ 发送给/ / ,/ / 将/ id/ 添加/ 到/ / 中/ ./ / 提交/ 等长/ 的/ 消息/ M0/ 、/ M1/ 和/ 挑战/ 属性/ 集/ ω/ / ,/ / 随机/ 选择/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 计算/ 挑战/ 密文/ CT/ / =/ ABTR/ ./ Enc/ (/ Mb/ ,/ ω/ ,/ / ,/ MSK/ )/ ,/ 并/ 将/ 其/ 发送给/ / ./ / 输出/ 猜测/ 值/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 如果/ b/ =/ b/ ,/ 称/ / 赢得/ 这个/ 游戏/ ./ 定义/ / 赢得/ 这个/ 游戏/ 的/ 优势/ TRGame0Adv/ / 为/ |/ Pr/ [/ / (/ ABTR/ ./ Enc/ (/ M1/ ,/ ω/ ,/ / ,/ MSK/ )/ )/ =/ 1/ ]/ -/ Pr/ [/ / (/ ABTR/ ./ Enc/ (/ M0/ ,/ ω/ ,/ / ,/ MSK/ )/ )/ =/ 1/ ]/ |/ ./ 如果/ 这个/ 优势/ 是/ 不可/ 忽略/ 的/ ,/ 我们/ 称/ / 可以/ 攻破/ ABTR/ 的/ 完全/ 安全性/ ./ 我们/ 构造/ ABTR/ 的/ 密文/ 如下/ :/ ABTR/ ./ Enc/ (/ M/ ,/ ω/ ,/ / ,/ MSK/ )/ =/ (/ GWABE/ ./ Enc/ (/ M/ ,/ ω/ ,/ Pi1/ ,/ PK/ )/ ,/ …/ ,/ 其中/ ,/ / \/ / 被/ 划分/ 成/ m/ 个/ 子集/ Si1/ ,/ …/ ,/ Sim/ ,/ 每个/ 子集/ Sij/ 对应/ 身份/ 模式/ Pij/ ./ 在/ 后面/ 的/ 游戏/ 中/ ,/ 我们/ 逐步/ 修改/ 挑战/ 密文/ ,/ 定义/ 修改/ 后/ 的/ 加密算法/ ABTR/ ./ Enck/ 为/ ABTR/ ./ Enck/ (/ M/ ,/ ω/ ,/ / ,/ MSK/ )/ =/ (/ GWABE/ ./ Enc/ (/ M0/ ,/ ω/ ,/ Pi1/ ,/ PK/ )/ ,/ …/ ,/ 注意/ :/ ABTR/ ./ Enc0/ (/ ·/ )/ =/ ABTR/ ./ Enc/ (/ ·/ )/ ,/ ABTR/ ./ Enck/ (/ M0/ ,/ ω/ ,/ / ,/ PK/ )/ =/ ABTR/ ./ Enc/ (/ M0/ ,/ ω/ ,/ / ,/ PK/ )/ ,/ 0/ / k/ / m/ ,/ ABTR/ ./ Encm/ (/ M/ ,/ ω/ ,/ / ,/ PK/ )/ =/ ABTR/ ./ Enc/ (/ M0/ ,/ ω/ ,/ / ,/ PK/ )/ ,/ 其中/ M/ 为/ 任意/ 消息/ ./ TRGamek/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ :/ 与/ TRGamek/ -/ 1/ 相同/ ,/ 除了/ 挑战者/ 用/ ABTR/ ./ Enck/ (/ ·/ )/ 替代/ ABTR/ ./ Enck/ -/ 1/ (/ ·/ )/ ./ 我们/ 用/ TRGamekAdv/ / 表示/ 敌手/ / 在/ TRGamek/ 中/ 的/ 优势/ ./ 注意/ :/ 在/ 最后/ 一个/ 游戏/ TRGamem/ 中/ ,/ 挑战/ 密文/ 总是/ 对/ 消息/ M0/ 的/ 加密/ ,/ 因此/ ,/ / 在/ 该游戏/ 中/ 的/ 优势/ 为/ 0/ ./ 引理/ 5/ ./ 如果/ 存在/ 一个/ PPT/ 算法/ / 使得/ TRGamekAdv/ / -/ TRGamek/ -/ 1Adv/ / =/ ε/ ,/ 那么/ 我们/ 可以/ 构造/ 一个/ PPT/ 算法/ / 以/ ε/ 的/ 优势/ 攻破/ GWABE/ 安全性/ ./ 证明/ ./ / 的/ 挑战者/ 运行/ GWABE/ 的/ 初始化/ 算法/ ,/ 生成/ PK/ ,/ MSK/ ,/ 并/ 将/ PK/ 发送给/ / ,/ / 收到/ GWABE/ 的/ 公钥/ PK/ ,/ 能够/ 模拟/ TRGamek/ 或/ TRGamek/ -/ 1/ ./ 由于/ GWABE/ 和/ ABTR/ 具有/ 相同/ 的/ 公钥/ ,/ / 将/ PK/ 作为/ ABTR/ 的/ 公钥/ 发送给/ / ./ 当/ / 询问/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ 时/ ,/ / 向/ 其/ 挑战者/ 询问/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ / 得到/ did/ ,/ (/ 犃/ ,/ ρ/ )/ 并/ 将/ 其/ Page10/ 发送给/ / ./ 由于/ GWABE/ 方案/ 和/ ABTR/ 方案/ 的/ 密钥/ 生成/ 算法/ 是/ 相同/ 的/ ,/ 所以/ / 可以/ 确保/ 给/ / 的/ 私钥/ 是/ 正确/ 的/ ./ 当/ 敌手/ / 询问/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ 后/ ,/ / 将/ id/ 添加/ 到/ 撤销/ 列表/ / 中/ (/ / 初始/ 为/ 空集/ )/ ./ / 将/ / \/ / 划分/ 成/ Si1/ ,/ Si2/ ,/ …/ ,/ Sim/ ,/ 提交/ 等/ 长/ 消息/ M0/ 、/ M1/ 、/ 模式/ Pik/ 和/ 挑战/ 属性/ 集/ ω/ / 给/ 其/ 挑战者/ ,/ 该/ 挑战者/ 生成/ GWABE/ 的/ 挑战/ 密文/ CTb/ =/ GWABE/ ./ Enc/ (/ Mb/ ,/ ω/ / ,/ Pik/ ,/ PK/ )/ 并/ 将/ 其/ 发送给/ / ./ / 计算/ ABTR/ 的/ 挑战/ 密文/ CT/ / =/ (/ GWABE/ ./ Enc/ (/ M0/ ,/ ω/ / ,/ Pi1/ ,/ PK/ )/ ,/ …/ ,/ 并/ 将/ 其/ 发送给/ / ./ / 接收/ 到/ CT/ / 后/ ,/ 可以/ 继续/ 询问/ 用户/ 的/ 私钥/ ,/ 注意/ :/ / 此时/ 不能/ 询问/ 这/ 类/ 用户/ (/ id/ ,/ (/ 犃/ ,/ ρ/ )/ )/ 的/ 私钥/ ,/ 其中/ ,/ ω/ / 满足/ (/ 犃/ ,/ ρ/ )/ 且/ id/ ∈/ / \/ / ./ 当/ / 输出/ 它/ 的/ 猜测/ 值后/ ,/ / 将/ 输出/ 相应/ 的/ 猜测/ 表/ 1/ 本文/ ABTR/ 方案/ 与/ 相关/ 方案/ 的/ 性能/ 对比/ 密文/ 长度/ 方案/ 私钥/ 长度/ NNL/ [/ 18/ ]/ O/ (/ log/ |/ / |/ )/ IDTR/ [/ 19/ ]/ O/ (/ 1/ )/ O/ (/ log/ |/ / |/ )/ O/ (/ rlog/ (/ |/ / |/ // r/ )/ ·/ log/ |/ / |/ )/ O/ (/ rlog/ (/ |/ / |/ // r/ )/ ·/ log/ |/ / |/ )/ O/ (/ log/ |/ / |/ )/ 完全/ 安全/ ABTT/ [/ 10/ ]/ O/ (/ 1/ )/ O/ (/ c2log/ (/ |/ / |/ // r/ )/ +/ log/ (/ 1/ // ε/ )/ )/ O/ (/ c2log/ (/ |/ / |/ // r/ )/ +/ log/ (/ 1/ // ε/ )/ )/ O/ (/ c2log/ (/ |/ / |/ // r/ )/ +/ log/ (/ 1/ // ε/ )/ )/ O/ (/ log/ |/ / |/ )/ 选择/ 安全/ 本文/ 的/ ABTRO/ (/ 1/ )/ O/ (/ log/ |/ / |/ )/ O/ (/ rlog/ (/ |/ / |/ // r/ )/ ·/ log/ |/ / |/ )/ O/ (/ rlog/ (/ |/ / |/ // r/ )/ ·/ log/ |/ / |/ )/ O/ (/ log/ |/ / |/ )/ 完全/ 安全/ 销/ 用户/ ./ 事实上/ ,/ 还/ 存在/ 其它/ 的/ 撤销/ 方法/ ,/ 例如/ 周期性/ 更新/ 用户/ 私钥/ [/ 13/ ]/ 和/ 引入/ 半/ 可信/ 的/ 仲裁者/ [/ 20/ ]/ 等/ 撤销/ 方法/ ,/ 如何/ 将/ 这些/ 撤销/ 方法/ 和/ 叛徒/ 追踪/ 算法/ 有机/ 结合/ 起来/ ,/ 生成/ 效率/ 更/ 高/ 的/ ABTR/ 方案/ ,/ 是/ 我们/ 未来/ 重点/ 的/ 研究/ 工作/ ./ 致谢/ 在/ 此/ ,/ 我们/ 向/ 对/ 本文/ 提出/ 宝贵/ 修改意见/ 的/ 匿名/ 审稿/ 老师/ 表示/ 衷心/ 的/ 感谢/ !/ 与/ ABTT/ 方案/ [/ 10/ ]/ 相比/ ,/ 本文/ 的/ ABTR/ 方案/ 同时/ 支持/ 叛徒/ 的/ 追踪/ 和/ 撤销/ ,/ 且/ 当/ 叛徒/ 个数/ 较大/ 时/ ,/ 该/ ABTR/ 方案/ 的/ 效率/ 高于/ ABTT/ 方案/ ./ 与/ NNL/ [/ 18/ ]/ 和/ IDTR/ [/ 19/ ]/ 方案/ 相比/ ,/ 该/ ABTR/ 方案/ 支持/ 加密/ 数据/ 的/ 细粒度/ 访问控制/ ,/ 且/ 用户/ 的/ 私钥/ 长度/ 是/ 固定/ 的/ ./ 5/ 结论/ 本文/ 首先/ 提出/ 一个/ 具有/ 扩展/ 通配符/ 的/ ABE/ 方案/ (/ GWABE/ )/ ,/ 然后/ ,/ 将/ GWABE/ 和/ 完全/ 子树/ 构架/ [/ 18/ ]/ 相结合/ ,/ 提出/ 一个/ 可追踪/ 并/ 撤销/ 叛徒/ 的/ 属性/ 基/ 加密/ 方案/ (/ ABTR/ )/ ,/ 并/ 证明/ 该/ ABTR/ 方案/ 是/ 完全/ 安全/ 的/ ,/ 且/ 用户/ 私钥/ 长度/ 是/ 固定/ 的/ ./ 本文/ 的/ 主要/ 贡献/ 有/ 3/ 个/ 方面/ :/ (/ 1/ )/ 该/ ABTR/ 方案/ 同时/ 支持/ 属性/ 基/ 加密/ 系统/ 的/ 叛徒/ 追踪/ 和/ 用户/ 撤销/ 两种/ 功能/ ./ (/ 2/ )/ 该/ ABTR/ 方案/ 能够/ 在/ 标准/ 模型/ 下/ 证明/ 其/ 完全/ 安全性/ ,/ 而/ 此前/ 可追踪/ 叛徒/ 的/ ABE/ 方案/ 仅/ 满足/ 选择/ 安全性/ ./ (/ 3/ )/ 我们/ 提出/ 了/ 一个/ GWABE/ 方案/ ,/ 并/ 证明/ 其/ 完全/ 安全性/ ./ GWABE/ 可以/ 用来/ 设计/ 可/ 撤销/ 的/ ABE/ 方案/ ,/ 可能/ 具有/ 独立/ 的/ 学术/ 价值/ ./ 本文/ 基于/ 完全/ 子树/ 构架/ 采用/ 撤销/ 列表/ 的/ 方法/ 撤值/ ./ 由/ ABTR/ 挑战/ 密文/ 的/ 构造/ 可知/ ,/ 当/ b/ =/ 0/ ,/ / 模拟/ 的/ 游戏/ 是/ TRGamek/ ;/ 当/ b/ =/ 1/ ,/ / 模拟/ 的/ 游戏/ 是/ TRGamek/ -/ 1/ ./ 因此/ ,/ / 能够/ 以/ ε/ 的/ 优势/ 攻破/ GWABE/ 的/ 安全性/ ./ 定理/ 2/ ./ 如果/ GWABE/ 是/ 完全/ 安全/ 的/ ,/ 则/ ABTR/ 是/ 完全/ 安全/ 的/ ./ 证明/ ./ 由/ 引理/ 5/ 可知/ ,/ 如果/ GWABE/ 是/ IND/ -/ CPA/ 安全/ 的/ ,/ 则/ 相邻/ 游戏/ TRGamek/ 和/ TRGamek/ -/ 1/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ 是/ 不可/ 区分/ 的/ ./ 因此/ ,/ TRGame0/ 和/ TRGamem/ 是/ 不可/ 区分/ 的/ ,/ 由于/ 敌手/ / 在/ TRGamem/ 中/ 的/ 优势/ 为/ 0/ ,/ 所以/ ,/ 敌手/ / 在/ TRGame0/ 中/ 的/ 优势/ 是/ 可以/ 忽略/ 的/ ,/ 即/ 定理/ 2/ 成立/ ./ 4.4/ 性能/ 比较/ 表/ 1/ 将/ 本文/ ABTR/ 方案/ 和/ 相关/ 方案/ 在/ 效率/ 和/ 安全/ 模型/ 方面/ 进行/ 了/ 详细/ 比较/ ,/ 其中/ ABTT/ [/ 10/ ]/ 方案/ 需要/ 在/ 系统/ 初始化/ 前/ 设置/ 叛徒/ 的/ 最大/ 个数/ c/ ,/ 且/ 追踪/ 算法/ 出错/ 的/ 概率/ 为/ ε/ ./ r/ 表示/ 撤销/ 用户/ 的/ 个数/ ,/ |/ / |/ 表示/ 全体/ 用户/ 的/ 个数/ ./ 

