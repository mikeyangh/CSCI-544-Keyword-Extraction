Page1/ 标准/ 模型/ 下/ 一种/ 实用/ 的/ 和/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 徐鹏/ 1/ )/ 崔/ 国华/ 1/ )/ 雷凤宇/ 1/ )/ 汤学明/ 1/ )/ 陈晶/ 2/ )/ 1/ )/ (/ 华中科技大学/ 计算机科学/ 与/ 技术/ 学院/ 信息安全/ 实验室/ 武汉/ 430074/ )/ 2/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 摘要/ 组合/ 公钥/ 方案/ 是/ 一种/ 用于/ 基于/ 身份/ 密码/ 体制/ 中/ 生成/ 用户加密/ 密钥/ 和/ 私钥/ 的/ 知名/ 方案/ ./ 针对/ 组合/ 公钥/ 方案/ 存在/ 合谋/ 攻击/ 的/ 问题/ ,/ 通过/ 仅/ 扩展/ 该/ 方案/ 的/ 私钥/ 生成/ 过程/ ,/ 实现/ 了/ 扩展/ 方案/ 的/ 抗/ 合谋/ 攻击性/ ./ 在/ 此基础/ 上/ 构建/ 标准/ 模型/ 下/ 基于/ DecisionalBilinearDiffie/ -/ Hellman/ 假设/ 可/ 证明/ 安全/ 的/ 一种/ 新/ 的/ 基于/ 身份/ 加密/ 方案/ ./ 最后/ ,/ 为了/ 说明/ 所构/ 新/ 方案/ 的/ 实用性/ ,/ 分析/ 了/ 扩展/ 组合/ 公钥/ 方案/ 的/ 用户加密/ 密钥/ 抗/ 碰撞/ 性/ ;/ 对比/ 了/ 新/ 方案/ 和/ 同类/ 的/ 3/ 个/ 知名/ 方案/ 在/ 安全性/ 证明/ 的/ 归约/ 程度/ 方面/ 、/ 加解密/ 的/ 时间/ 复杂度/ 方面/ 和/ 密文/ 的/ 长度/ 方面/ 的/ 性能/ ,/ 表明/ 了/ 新/ 方案/ 在/ 以上/ 3/ 点上/ 具有/ 目前/ 最优/ 的/ 指标/ ./ 因此/ 新/ 方案/ 是/ 相对/ 较/ 实用/ 的/ ./ 关键词/ 组合/ 公钥/ ;/ 合谋/ 攻击/ ;/ 标准/ 模型/ ;/ DecisionalBilinearDiffie/ -/ Hellman/ 假设/ ;/ 基于/ 身份/ 加密/ 1/ 引言/ 1984/ 年/ ,/ Shamir/ 创造性地/ 提出/ 了/ 基于/ 身份/ 的/ 加密/ 体制/ (/ Identity/ -/ BasedEncryption/ ,/ IBE/ )/ 的/ 概念/ [/ 1/ ]/ ./ 和/ 传统/ 的/ 公钥/ 加密/ 体制/ 不同/ ,/ 它/ 可以/ 使用/ 任意/ 字符串/ 作为/ 用户/ 的/ 公钥/ ,/ 这样/ 取消/ 了/ 传统/ 公钥/ 加密/ 体制/ 对/ 在线/ 密钥/ 管理中心/ 的/ 需要/ ,/ 从而/ 大大/ 地/ 提高/ 了/ 效率/ ./ 虽然/ IBE/ 的/ 概念/ 提出/ 得/ 很早/ ,/ 但/ 直到/ 2001/ 年/ 才/ 由/ Boneh/ 提出/ 了/ 第一个/ 实用/ 的/ IBE/ 方案/ [/ 2/ ]/ ,/ 并且/ 该/ 方案/ 成功/ 地/ 在/ 随机/ 预言/ 机/ 模型/ (/ RandomOracleModel/ ,/ ROModel/ )/ 下/ 将/ 双线性/ 计算/ 难题/ BilinearDiffie/ -/ Hellman/ 问题/ (/ BDH/ 问题/ )/ 的/ 求解/ 归约/ 到/ 其/ IBE/ 方案/ 的/ 破解/ ,/ 因此/ 是/ RO/ 模型/ 下/ 可/ 证明/ 安全/ 的/ ./ 与此同时/ ,/ Boneh/ 也/ 提出/ 了/ 新/ 的/ 问题/ ,/ 即/ 能否/ 构建/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ./ 在/ 标准/ 模型/ 下/ 构建/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 具有/ 十分/ 重要/ 的/ 实用/ 意义/ ./ 众所周知/ ,/ RO/ 模型/ 下/ 的/ 安全性/ 证明/ 中/ 使用/ 了/ 随机/ 预言/ 机/ 提供/ 询问/ 应答/ 服务/ ,/ 而/ 真实/ 环境/ 中/ 并/ 不/ 存在/ 随机/ 预言/ 机/ ,/ 因此/ 一个/ RO/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 在/ 实用/ 中/ 必须/ 选取/ 合适/ 的/ Hash/ 函数/ 或/ 伪/ 随机/ 函数/ 等/ 算法/ 来/ 代替/ 方案/ 中/ 的/ 随机/ 预言/ 机/ (/ 即/ 实例/ 化/ 随机/ 预言/ 机/ 过程/ )/ ,/ 这样/ 对/ 实例/ 化后/ 的/ 方案/ 是否/ 安全/ 和/ 实用/ 需要/ 做/ 进一步/ 的/ 评估/ [/ 3/ ]/ ./ 而/ 在/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 通常/ 只/ 需要/ 抗/ 碰撞/ 的/ Hash/ 函数/ 或/ 伪/ 随机/ 函数/ 或/ 单向/ 函数/ ,/ 甚至/ 有/ 的/ 方案/ 根本/ 不/ 需要/ 此类/ 函数/ ,/ 因此/ 其/ 可/ 证明/ 安全性/ 更/ 实用/ ./ 当然/ ,/ 这些/ 并/ 不能/ 说明/ 标准/ 模型/ 绝对/ 优于/ RO/ 模型/ ,/ 因为/ 成功/ 实例/ 化/ 随机/ 预言/ 机后/ 的/ 加密/ 方案/ 并不一定/ 比/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 方案/ 的/ 安全性/ 和/ 执行/ 效率/ 低/ ,/ 而且/ 有/ 的/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 很/ 显然/ 就是/ 不/ 实用/ 的/ ,/ 例如/ ,/ 文献/ [/ 4/ ]/ 中/ 的/ IBE/ 方案/ ./ 由于/ 在/ 标准/ 模型/ 下/ 构建/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 比/ RO/ 模型/ 要/ 难/ ,/ 而且/ 其/ 安全性/ 证明/ 更/ 实用/ ,/ 因此/ 近几年/ 得到/ 了/ 广泛/ 的/ 重视/ ,/ 特别/ 是/ 构建/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ./ 在/ 证明/ 安全性/ 的/ 过程/ 中/ ,/ 必须/ 选取/ 一个/ 公认/ 的/ 难题/ (/ 或/ 称之为/ 假设/ )/ ,/ 并/ 完成/ 该/ 难题/ 的/ 求解/ 到/ 加密/ 方案/ 破解/ 的/ 归约/ ./ 这些/ 难题/ 可/ 分为/ 计算/ 难题/ 和/ 判定/ 难题/ ./ 而/ 要/ 在/ 标准/ 模型/ 下/ 建立/ 可/ 证明/ 安全/ 的/ 加密/ 方案/ 必须/ 选取/ 判定/ 难题/ ,/ 因为/ 在/ RO/ 模型/ 下/ 安全性/ 证明/ 的/ 归约/ 过程/ 中/ ,/ 计算/ 难题/ 的/ 求解/ 是/ 依赖/ 随机/ 预言/ 机/ 的/ ,/ 而/ 标准/ 模型/ 下/ 由于/ 不/ 存在/ 随机/ 预言/ 机/ ,/ 并且/ 在/ 安全性/ 定义/ 的/ 攻击/ 游戏/ 中/ [/ 2/ ]/ ,/ 仿真器/ 不/ 可能/ 根据/ 其/ 与/ 相应/ 攻击者/ 的/ 交互/ 信息/ 求解/ 计算/ 难题/ ,/ 例如/ ,/ IND/ -/ ID/ -/ CPA/ 安全性/ 定义/ 的/ 攻击/ 游戏/ 中/ ,/ 攻击者/ 告诉/ 仿真器/ 的/ 只有/ 身份/ 信息/ 、/ 两个/ 等长/ 的/ 明文/ 信息/ 和/ 攻击/ 结束/ 时/ 的/ 一位/ 猜测/ 信息/ ,/ 而/ 这些/ 信息/ 或者/ 是/ 仿真器/ 已知/ 的/ ,/ 或者/ 和/ 计算/ 难题/ 的/ 求解/ 无关/ ,/ 因此/ 无法/ 正确/ 地/ 归约/ 并/ 求解/ 计算/ 难题/ ./ 由此可见/ ,/ 判定/ 难题/ 在/ 标准/ 模型/ 中/ 构建/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 是/ 至关重要/ 的/ ./ 2004/ 年/ ,/ Boneh/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 第一个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ,/ 即/ 在/ 相对/ 较弱/ 的/ 安全性/ 定义/ 下/ (/ 即非/ 适应性/ 选择/ 挑战/ ID/ 和/ 选择/ 明文/ 攻击/ 下/ 的/ 语义/ 不可/ 区分/ 性/ ,/ 简称/ 为/ IND/ -/ sID/ -/ CPA/ 安全性/ )/ 成功/ 地/ 实现/ 了/ DecisionalBilinearDiffie/ -/ Hellman/ 问题/ (/ DecisionalBDH/ 问题/ )/ 的/ 求解/ 到/ 该/ 方案/ 破解/ 的/ 归约/ ./ 但是/ 在/ 相对/ 较强/ 的/ 安全性/ 定义/ 下/ (/ 即/ 适应性/ 选择/ 挑战/ ID/ 和/ 选择/ 明文/ 攻击/ 下/ 的/ 语义/ 不可/ 区分/ 性/ ,/ 简称/ 为/ IND/ -/ ID/ -/ CPA/ 安全性/ )/ ,/ 该/ IBE/ 方案/ 的/ 归约/ 十分/ “/ 松散/ ”/ ,/ 具体地说/ 该/ 归约/ 是/ 指数/ 级/ 的/ 归约/ ,/ 因而/ 在/ 实用/ 中/ 为了/ 保证/ IND/ -/ ID/ -/ CPA/ 安全性/ 会/ 选取/ 一个/ 很大/ 的/ 安全/ 参数/ ,/ 但/ 这/ 使得/ 该/ IBE/ 方案/ 不/ 具有/ 实用性/ ./ 同年/ ,/ Boneh/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ 另/ 一个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ,/ 虽然/ 该/ 方案/ 实现/ 了/ IND/ -/ ID/ -/ CPA/ 安全性/ 下/ DecisionalBDH/ 问题/ 的/ 求解/ 到/ IBE/ 方案/ 破解/ 相对/ 有效/ 的/ 归约/ ,/ 但/ 其/ 方案/ 中/ 密文/ 的/ 长度/ 与/ 用户/ ID/ 的/ 长度/ 有关/ ,/ 因而/ 密文/ 较长/ ,/ 同时/ 也/ 增加/ 了/ 加解密/ 的/ 时间/ 复杂度/ ,/ 从而/ 降低/ 了/ 实用性/ ./ 2005/ 年/ ,/ Waters/ [/ 6/ ]/ 提出/ 了/ 第/ 1/ 个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 且/ 综合/ 来说/ 较/ 实用/ 的/ IBE/ 方案/ ,/ 即该/ 方案/ 不仅/ 具有/ 固定/ 长度/ 的/ 密文/ (/ 安全/ 参数/ 的/ 3/ 倍/ )/ ,/ 同时/ 实现/ 了/ IND/ -/ ID/ -/ CPA/ 安全性/ 下/ DecisionalBDH/ 问题/ 的/ 求解/ 到/ IBE/ 方案/ 破解/ 相对/ 有效/ 的/ 归约/ ./ 2006/ 年/ ,/ Gentry/ [/ 7/ ]/ 提出/ 了/ 另/ 一个/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ,/ 该/ 方案/ 不仅/ 减少/ 了/ 公开/ 参数/ 的/ 个数/ ,/ 提高/ 了/ 性能/ ,/ 并且/ 实现/ 了/ 更/ 紧/ 的/ 归约/ ,/ 但是/ 该/ 归约/ 是/ 基于/ 一个/ 更强/ 的/ 问题/ ,/ 即/ 判定/ 的/ 双线性/ Diffie/ -/ Hellman/ 指数/ 的/ 扩展/ 问题/ (/ DecisionalAugmentedBilinearDiffie/ -/ HellmanExponentProblem/ ,/ DecisionalAB/ -/ DHEProblem/ )/ ,/ 因而/ 该/ 方案/ 的/ 性能/ 和/ 安全性/ 并不一定/ 比/ 前述/ 方案/ 优秀/ [/ 7/ ]/ ,/ 因此/ 其/ 实用性/ 是否/ 真的/ 提高/ 还有/ 待/ 研究/ ./ 通过/ 研究/ 发现/ ,/ 采用/ 组合/ 公钥/ 方案/ [/ 8/ ]/ (/ Com/ -/ binedPublic/ -/ KeyScheme/ ,/ CPK/ )/ 可以/ 构建/ 更/ 高效/ 的/ IBE/ 方案/ ,/ 并且/ 若/ 不/ 考虑/ CPK/ 本身/ 的/ 安全性/ 问题/ ,/ 该/ 方案/ 是/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ ,/ 而且/ 具有/ 目前/ 同类/ 方案/ [/ 4/ -/ 6/ ]/ 中/ 最优/ 的/ DecisionalBDH/ 问题/ 的/ 求解/ 到/ IBE/ 方案/ 破解/ 的/ 归约/ 有/ 相对/ 最优/ 的/ 加解密/ 时间/ Page3/ 复杂度/ 和/ 密文/ 长度/ ./ 但是/ 众所周知/ ,/ CPK/ 存在/ 合谋/ 攻击/ 问题/ [/ 9/ ]/ ,/ 即令/ CPK/ 中/ 私钥/ 种子/ 矩阵/ 为/ m/ ×/ h/ 阶/ ,/ 则/ 若/ 有/ m/ ×/ h/ 个/ 合法/ 用户/ 参与/ 合谋/ 即可/ 计算/ 出/ 私钥/ 种子/ 矩阵/ ./ 目前/ ,/ 现有/ 的/ 防范/ 该/ 攻击/ 的/ 方法/ [/ 9/ ]/ 都/ 是/ 不合理/ 的/ ,/ 例如/ ,/ 要求/ 合法/ 用户/ 的/ 总数/ 小于/ m/ ×/ h/ ,/ 很/ 明显/ 这/ 和/ CPK/ 的/ 设计/ 宗旨/ 是/ 相/ 违背/ ;/ 通过/ 加强/ 管理/ 使得/ 合谋/ 用户数量/ 小于/ m/ ×/ h/ ,/ 这种/ 方法/ 是/ 不/ 具有/ 说服力/ 的/ ./ 因而/ ,/ 本文/ 提出/ 的/ 新/ IBE/ 方案/ 首先/ 继承/ CPK/ 的/ 优点/ 及/ 加密/ 密钥/ 和/ 私钥/ 的/ 生成/ 方法/ ,/ 通过/ 扩展/ 私钥/ 的/ 生成/ 过程/ 实现/ 根本/ 上/ 的/ 抗/ 合谋/ 攻击性/ ;/ 再/ 由/ 该/ 扩展/ CPK/ 方案/ 构建/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ;/ 最后/ 通过/ 与/ 前述/ 的/ 同类/ 方案/ 对比/ 归约/ 程度/ 、/ 加解密/ 执行/ 效率/ 、/ 密文/ 长度/ 来/ 说明/ 该/ 方案/ 具有/ 相对/ 较/ 好/ 的/ 实用性/ ./ 另外/ ,/ 在/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 中/ ,/ 要求/ 不同/ 用户/ 的/ 加密/ 密钥/ 具有/ 抗/ 碰撞/ 性/ (/ 通常/ 由/ 输入/ 为/ 用户/ ID/ 的/ 某个/ 抗/ 碰撞/ 的/ Hash/ 函数/ 实现/ )/ ,/ 因此/ 为了/ 说明/ 扩展/ CPK/ 方案/ 生成/ 的/ 用户加密/ 密钥/ 具有/ 抗/ 碰撞/ 性/ ,/ 本文/ 将/ 详细分析/ 新/ 方案/ 中/ 加密/ 密钥/ 种子/ 矩阵/ 的/ 规模/ (/ 即/ m/ ×/ h/ 的/ 大小/ )/ 对抗/ 碰撞/ 性/ 的/ 影响/ ,/ 得出/ 具有/ 某种程度/ 的/ 抗/ 碰撞/ 性所/ 需要/ 的/ 矩阵/ 规模/ ,/ 而且/ 由于/ 扩展/ CPK/ 方案/ 和/ 原/ CPK/ 方案/ 的/ 加密/ 密钥/ 的/ 生成/ 方法/ 相同/ ,/ 因此/ 该/ 结论/ 也/ 适用/ 于原/ CPK/ 方案/ ./ 中/ 在/ 下/ 一节/ 中/ 描述/ ,/ 并/ 进行/ 简要/ 的/ 分析/ ./ 2/ 预备/ 知识/ 为了/ 方便/ 理解/ ,/ 本文/ 将/ 一些/ 重要/ 的/ 预备/ 知识/ 集/ 本章/ 将/ 简要/ 介绍/ 与/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 有关/ 的/ 重要/ 基础知识/ ,/ 分别/ 是/ IBE/ 方案/ 的/ 核心/ 构件/ —/ —/ —/ 单向/ 函数/ “/ 双线性/ 映射/ ”/ ;/ 安全性/ 归约/ 中/ 基于/ 的/ 难题/ ;/ 安全性/ 证明/ 所/ 要/ 达到/ 的/ 安全/ 目标/ ,/ 即/ 安全性/ 定义/ ./ 2.1/ 双线性/ 映射/ 双线性/ 映射/ 是/ 对/ 修正/ 后/ 的/ Weil/ 对/ 和/ Tate/ 对/ 的/ 总结/ 和/ 抽象/ ,/ 是/ 第一个/ 实用/ 的/ IBE/ 方案/ [/ 2/ ]/ 之所以/ 成功/ 的/ 关键/ ,/ 因而/ 在/ 2001/ 年/ 后/ 的/ 大部分/ IBE/ 方案/ 中/ 都/ 得到/ 了/ 应用/ ./ 定义/ 1/ ./ 令/ G1/ 和/ G2/ 分别/ 是/ 两个/ 大/ 素数/ q/ 阶/ 加法/ 循环群/ 和/ 乘法/ 循环群/ ./ 称/ 满足/ 以下/ 条件/ 的/ 映射/ ^/ e/ :/ G1/ ×/ G1/ →/ G2/ 为/ 双线性/ 映射/ ,/ 条件/ 如下/ :/ (/ 1/ )/ 双线性/ 性/ ./ 对/ / P/ ,/ Q/ ∈/ G1/ 和/ a/ ,/ b/ ∈/ 犣/ ,/ 有/ ^/ e/ (/ aP/ ,/ bQ/ )/ =/ ^/ e/ (/ P/ ,/ Q/ )/ ab/ 成立/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ 若/ P/ 为群/ G1/ 的/ 生成元/ ,/ 则/ ^/ e/ (/ P/ ,/ P/ )/ 是/ G2/ 的/ 生成元/ ./ (/ 3/ )/ 可计算性/ ./ 对/ / P/ ,/ Q/ ∈/ G1/ ,/ 映射/ ^/ e/ (/ P/ ,/ Q/ )/ 在/ 有效/ 时间/ 内/ 可/ 计算/ ./ 一个/ 具体/ 的/ 双线性/ 映射/ 可以/ 参考文献/ [/ 2/ ]/ ./ 2.2/ ComputationalDiffie/ -/ Hellman/ 假设/ 定义/ 2/ [/ 10/ ]/ ./ 令/ G1/ 为/ 素数/ q/ 阶/ 加法/ 群/ ,/ P/ 为/ 该/ 群/ 的/ 一个/ 生成元/ ./ 群/ G1/ 上/ 的/ CDH/ 问题/ (/ CDHP/ )/ 为/ :/ 给定/ P/ ,/ aP/ ,/ bP/ ,/ 计算/ abP/ ,/ 其中/ a/ ,/ b/ 在/ 犣/ / 取/ ./ 若/ 有效/ 时间/ 内/ ,/ 任意/ 概率/ 多项式/ 时间/ 算法/ 的/ 求解/ 优势/ 可/ 忽略/ ,/ 则/ 称群/ G1/ 上/ CDH/ 假设/ 成立/ ./ 2.3/ DecisionalBilinearDiffie/ -/ Hellman/ 假设/ DecisionalBDH/ 问题/ 的/ 提出/ 是因为/ 在/ 具有/ 双线性/ 映射/ 的/ 群中/ ,/ 判定/ Diffie/ -/ Hellman/ (/ DDH/ )/ 问题/ 是/ 易解/ 的/ ,/ 即/ DDH/ 假设/ 不/ 成立/ ,/ 因此/ Boneh/ 在/ 双线性/ 映射/ 群中/ 扩展/ 了/ DDH/ 问题/ ,/ 即/ 得到/ DecisionalBDH/ 问题/ ,/ 并/ 提出/ 了/ 研究/ 热点/ ,/ 即/ 若/ DecisionalBDH/ 假设/ 成立/ 如何/ 在/ 标准/ 模型/ 下/ 构建/ 基于/ 该/ 假设/ 的/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ./ 定义/ 3/ ./ 令/ G1/ 和/ G2/ 是/ 两个/ 大/ 素数/ q/ 阶/ 加法/ 循环群/ 和/ 乘法/ 循环群/ ,/ 且/ 存在/ 双线性/ 映射/ ^/ e/ :/ G1/ ×/ G1/ →/ G2/ ,/ P/ 为群/ G1/ 的/ 生成元/ ./ DecisionalBDH/ 问题/ 定义/ 如下/ ./ DecisionalBDH/ 问题/ ./ 给定/ 一个/ 具有/ 若干/ 形/ 如/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ abcP/ 〉/ 的/ Diffie/ -/ Hellman/ 分组/ 的/ 分布/ D/ 和/ 一个/ 具有/ 若干/ 形/ 如/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ rP/ 〉/ 的/ 随机/ 分组/ 的/ 分布/ R/ ,/ 区分/ 这/ 两个/ 分布/ ,/ 其中/ a/ ,/ b/ ,/ c/ ,/ r/ 在/ q/ 中/ 随机/ 选取/ ./ 范围/ 犣/ / 若/ 不/ 存在/ 有效/ 的/ 统计/ 测试/ 算法/ 能/ 在/ 概率/ 多项式/ 时间/ T/ 内/ ,/ 以/ 至少/ ε/ 的/ 优势/ 解/ DecisionalBDH/ 问题/ ,/ 则/ 称为/ (/ T/ ,/ ε/ )/ -/ DecisionalBDH/ 假设/ ,/ 即/ Deci/ -/ sionalBDH/ 假设/ 成立/ ./ 总的来说/ ,/ 判定/ 难题/ 属于/ 不可/ 区分/ 性/ 问题/ ,/ 而/ 不可/ 区分/ 性/ 问题/ 又/ 分为/ :/ 计算/ 不可/ 区分/ 性/ 问题/ 和/ 统计/ 不可/ 区分/ 性/ 问题/ ./ 到/ 目前为止/ ,/ 绝大多数/ 基于/ 判定/ 问题/ 可/ 证明/ 安全/ 的/ 公钥/ 加密/ 方案/ 中/ ,/ 其/ 判定/ 问题/ 均/ 是/ 计算/ 不可/ 区分/ 性/ 问题/ ,/ 例如/ :/ 著名/ 的/ Cramer/ -/ Shoup/ 方案/ [/ 11/ ]/ ;/ 还有/ 本文/ 第/ 1/ 节中/ 介绍/ 的/ 所有/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ [/ 4/ ,/ 6/ -/ 7/ ]/ ./ 关于/ 统计/ 不可/ 区分/ 性/ 的/ 定义/ 可以/ 参考文献/ [/ 12/ ]/ ./ 2.4/ IND/ -/ ID/ -/ CPA/ 安全性/ IND/ -/ ID/ -/ CPA/ 安全性/ 指/ 的/ 是/ 适应性/ 选择/ 挑战/ ID/ 和/ 选择/ 明文/ 攻击/ 下/ 的/ 语义/ 不可/ 区分/ 性/ ,/ 是/ 目前/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 中/ 最受/ 重视/ 的/ 安全性/ 定义/ ,/ 因为/ 凡是/ 具有/ 该/ 安全性/ 的/ IBE/ 方案/ 均/ 可/ 由/ Canetti/ 等/ 人/ [/ 13/ ]/ 、/ Boneh/ 等/ 人/ [/ 14/ ]/ 和/ Boyen/ 等/ 人/ [/ 15/ ]/ 分别/ 提出/ 的/ 通用/ 方法/ 有效/ 地/ 扩展/ 为/ 具有/ IND/ -/ ID/ -/ CCA/ 安全性/ Page4/ (/ 适应性/ 选择/ 挑战/ ID/ 和/ 选择/ 密文/ 攻击/ 下/ 的/ 语义/ 不可/ 区分/ 性/ )/ 的/ IBE/ 方案/ ,/ 因此/ 一般/ 只/ 证明/ 某/ IBE/ 方案/ 具有/ IND/ -/ ID/ -/ CPA/ 安全性/ ./ 但是/ 实现/ IND/ -/ ID/ -/ CPA/ 安全性/ 并/ 不/ 容易/ ,/ 有些/ 方案/ 只/ 在/ 较弱/ 的/ 安全性/ 定义/ IND/ -/ sID/ -/ CPA/ 下才/ 具有/ 相对/ 较/ 实用/ 的/ 安全性/ 归约/ ,/ 而/ 在/ IND/ -/ ID/ -/ CPA/ 安全性/ 下/ 的/ 归约/ 完全/ 不/ 实用/ [/ 5/ ]/ ,/ 因此/ 这/ 也/ 是/ 标准/ 模型/ 下/ 构建/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 的/ 难点/ ./ 下面/ 给出/ IND/ -/ ID/ -/ CPA/ 攻击/ 的/ 通用/ 定义/ ,/ 再/ 根据/ 该/ 攻击/ 给出/ IND/ -/ ID/ -/ CPA/ 安全性/ 的/ 定义/ ./ 定义/ 4/ ./ IND/ -/ ID/ -/ CPA/ 攻击/ 由/ 如下/ 几个/ 阶段/ 构成/ ./ 初始化/ 阶段/ ./ 挑战者/ 生成/ 公开/ 参数/ 和/ 秘密/ 参数/ ,/ 并/ 将/ 公开/ 参数传递/ 给/ 攻击者/ ./ 私钥/ 查询/ 阶段/ 1/ ./ 攻击者/ 可以/ 向/ 挑战者/ 多次/ 查询/ 任意/ 用户/ 的/ 私钥/ ./ 挑战/ 阶段/ ./ 攻击者/ 提交/ 等长/ 的/ 明文/ m0/ ,/ m1/ 和/ 要/ 挑战/ 的/ 用户/ 身份/ IDch/ 给/ 挑战者/ ,/ 其中/ 要求/ 攻击者/ 没有/ 询问/ 过/ IDch/ 的/ 私钥/ ;/ 挑战者/ 随机/ 选取/ d/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 并/ 利用/ IDch/ 的/ 加密/ 密钥/ 加密/ md/ 生成/ 挑战/ 密文/ C/ ;/ 最后/ 返回/ C/ 给/ 攻击者/ ./ 私钥/ 查询/ 阶段/ 2/ ./ 除了/ 攻击者/ 不能/ 询问/ IDch/ 的/ 私钥/ 外/ ,/ 该/ 阶段/ 的/ 执行/ 和/ 私钥/ 查询/ 阶段/ 1/ 相同/ ./ 猜测/ 阶段/ ./ 攻击者/ 向/ 挑战者/ 提交/ 对/ d/ 的/ 猜测/ d/ ,/ 则/ 完成/ 了/ 一次/ IND/ -/ ID/ -/ CPA/ 攻击/ ./ 定义/ 5/ ./ 称/ 一个/ IBE/ 方案/ θ/ 是/ (/ T/ ,/ qID/ ,/ ε/ )/ -/ IND/ -/ ID/ -/ CPA/ 安全/ 的/ ,/ 若/ 在/ 时间/ T/ 内/ 对/ 任意/ 一个/ IND/ -/ ID/ -/ CPA/ 攻击者/ A/ 在/ 进行/ 最多/ qID/ 次/ 私钥/ 查询/ 后/ ,/ 其/ 破解/ 方案/ θ/ 的/ 优势/ Adv/ θ/ ,/ A/ </ ε/ ./ IND/ -/ sID/ -/ CPA/ 攻击/ 和/ IND/ -/ ID/ -/ CPA/ 攻击/ 的/ 差别/ 仅/ 在于/ :/ 前者/ 的/ 攻击者/ 在/ 初始化/ 阶段/ 必须/ 提交/ 给/ 挑战者/ 其/ 准备/ 挑战/ 的/ 用户/ 身份/ IDch/ ,/ 而/ 后者/ 的/ 攻击者/ 在/ 挑战/ 阶段/ 才/ 提交/ 其/ 挑战/ 的/ 用户/ 身份/ IDch/ ./ 显然/ ,/ IND/ -/ ID/ -/ CPA/ 攻击/ 中/ 的/ 攻击者/ 具有/ 更强/ 的/ 攻击能力/ ./ 3/ 基于/ 扩展/ CPK/ 方案/ 的/ IBE/ 方案/ 本/ 方案/ 首先/ 对/ CPK/ 方案/ 进行/ 扩展/ ,/ 实现/ 抗/ 合谋/ 攻击性/ ,/ 即/ 所有/ 的/ 合法/ 用户/ 合谋/ 也/ 不/ 可能/ 求/ 出/ 私钥/ 种子/ 矩阵/ ;/ 再/ 基于/ 该/ 扩展/ CPK/ 构建/ IBE/ 方案/ ./ 明确/ 地说/ ,/ 这项/ 研究/ 的/ 难点/ 就/ 在于/ 不仅/ 可以/ 实现/ 扩展/ CPK/ 方案/ 的/ 完全/ 抗/ 合谋/ 攻击性/ ,/ 同时/ 可以/ 基于/ 该/ 扩展/ CPK/ 方案/ 构建/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ ./ 本文/ 将/ 以上/ 两个/ 过程/ 合为一体/ 作为/ 一个/ 完整/ 的/ IBE/ 方案/ 来/ 描述/ ,/ 并/ 不/ 单独/ 描述/ 扩展/ CPK/ 方案/ ./ 基于/ 扩展/ CPK/ 方案/ 的/ IBE/ 方案/ 由/ 4/ 个/ 算法/ 组成/ :/ 系统/ 初始化/ 算法/ Setup/ 、/ 用户/ 公私/ 钥/ 生成/ 算法/ Extract/ 、/ 加密算法/ Encrypt/ 、/ 解密/ 算法/ Decrypt/ ./ 令/ η/ (/ k/ )/ 为/ DecisionalBDH/ 假设/ 的/ 参数/ 生成/ 算法/ ,/ 其中/ k/ 为/ 安全/ 参数/ ./ 各/ 算法/ 具体/ 如下/ ./ Setup/ 算法/ ./ 输入/ 系统安全/ 参数/ k/ ,/ 密钥/ 管理中心/ 进行/ 如下/ 初始化/ 过程/ :/ 1/ ./ 运行/ 算法/ η/ (/ k/ )/ 生成/ 两个/ 大/ 素数/ q/ 阶/ 加法/ 循环群/ G1/ 和/ q/ 阶/ 乘法/ 循环群/ G2/ 、/ 双线性/ 映射/ ^/ e/ :/ G1/ ×/ G1/ →/ G2/ ,/ G1/ 的/ 生成元/ P/ ./ 2/ ./ 随机/ 选取/ a/ ,/ b/ ∈/ 犣/ / q/ ,/ 计算/ g1/ =/ aP/ 和/ g2/ =/ bP/ ./ 3/ ./ (/ 生成/ CPK/ 的/ 所有/ 参数/ )/ 生成/ m/ ×/ h/ 阶/ 私钥/ 种子/ 矩阵/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ :/ r1/ ,/ 1/ …/ r1/ ,/ h/ 烄/ rm/ ,/ 1/ …/ rm/ ,/ 烆/ 生成/ 相应/ 的/ m/ ×/ h/ 阶/ 加密/ 密钥/ 种子/ 矩阵/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ :/ 选取/ h/ 个/ 不同/ 的/ 伪/ 随机/ 函数/ (/ 或/ 带/ 密钥/ 的/ Hash/ 函数/ )/ 组成/ 函数/ 集/ F/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fh/ }/ ,/ 且/ 满足/ 对/ / i/ ∈/ [/ 1/ ,/ h/ ]/ 和/ ID/ ∈/ {/ 0/ ,/ 1/ }/ / 有/ fi/ (/ ID/ )/ ∈/ [/ 1/ ,/ m/ ]/ ./ 4/ ./ 保密/ 私钥/ 种子/ 矩阵/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ 和/ 犪/ ;/ 公开/ 系统/ 参数/ params/ =/ 〈/ q/ ,/ G1/ ,/ G2/ ,/ ^/ e/ ,/ P/ ,/ g1/ ,/ g2/ ,/ F/ ,/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ 〉/ ,/ 其中/ G2/ 也/ 为/ 明文/ 空间/ ./ Extract/ 算法/ ./ 给定/ 用户/ ID/ ∈/ {/ 0/ ,/ 1/ }/ / ;/ 令/ 用户/ 的/ 私钥/ 为/ SKID/ ,/ 密钥/ 管理中心/ 随机/ 选取/ σ/ ∈/ 犣/ / 计算/ 用户/ 私钥/ SKID/ =/ (/ a/ ·/ g2/ +/ σ/ ·/ SKID/ ·/ P/ ,/ σ/ ·/ P/ )/ ,/ 其中/ SKID/ =/ (/ rf1/ (/ ID/ )/ ,/ 1/ +/ …/ +/ rfh/ (/ ID/ )/ ,/ h/ )/ modq/ ∈/ q/ ,/ rfi/ (/ ID/ )/ ,/ i/ ∈/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ ./ 显然/ :/ SKID/ 的/ 计算/ 和/ CPK/ 方/ 犣/ / 案/ 的/ 私钥/ 计算/ 完全/ 一样/ ./ 扩展/ CPK/ 方案/ 只是/ 在/ SKID/ 的/ 基础/ 上/ 额外/ 进行/ 了/ 形如/ (/ a/ ·/ g2/ +/ σ/ ·/ SKID/ ·/ P/ ,/ σ/ ·/ P/ )/ 的/ 计算/ ,/ 并/ 将/ 其/ 作为/ 用户/ 的/ 私钥/ ,/ 记为/ SKID/ ./ Encrypt/ 算法/ ./ 给定/ 用户/ ID/ 和/ 明文/ m/ ∈/ G2/ ;/ 加密/ 过程/ 如下/ :/ 1/ ./ 计算/ 该/ 用户/ 的/ 加密/ 密钥/ PKID/ =/ (/ rf1/ (/ ID/ )/ ,/ 1P/ +/ …/ +/ rfh/ (/ ID/ )/ ,/ hP/ )/ ∈/ G/ / 1/ ,/ 其中/ rfi/ (/ ID/ )/ ,/ iP/ ∈/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ ./ 2/ ./ 随机/ 选取/ t/ ∈/ 犣/ / q/ ,/ 计算/ 密文/ c/ =/ 〈/ ^/ e/ (/ g1/ ,/ g2/ )/ t/ ·/ m/ ,/ t/ ·/ P/ ,/ t/ ·/ PKID/ 〉/ ./ Decrypt/ 算法/ ./ 给定/ 密文/ c/ =/ 〈/ c1/ ,/ c2/ ,/ c3/ 〉/ ;/ 令/ 私钥/ SKID/ =/ (/ a/ ·/ g2/ +/ σ/ ·/ SKID/ ·/ P/ ,/ σ/ ·/ P/ )/ ,/ 解密/ 过程/ 如下/ :/ m/ =/ c1/ ·/ ^/ e/ (/ c3/ ,/ σ/ ·/ P/ )/ 密/ 算法/ 的/ 一致性/ 验证/ 如下/ :/ 令/ c2/ =/ t/ ·/ P/ ,/ c3/ =/ t/ ·/ PKID/ ,/ 由于/ ^/ e/ (/ t/ ·/ PKID/ ,/ σ/ ·/ P/ )/ Page5/ ^/ e/ (/ t/ ·/ P/ ,/ a/ ·/ g2/ )/ ·/ ^/ e/ (/ t/ ·/ P/ ,/ σ/ ·/ SKID/ ·/ P/ )/ =/ 1/ 又/ 有/ c1/ =/ ^/ e/ (/ g1/ ,/ g2/ )/ t/ ·/ m/ ,/ 所以/ 显然/ 有/ 一致性/ 成立/ ,/ 即/ 解密/ 过程/ 正确/ ./ 通过/ 以上/ 新/ IBE/ 方案/ 的/ 描述/ 可以/ 看出/ :/ 系统/ 初始化/ 阶段/ 引入/ 了/ DecisionalBDH/ 假设/ 的/ 参数/ 生成/ 算法/ ;/ 加密/ 密钥/ 和/ 私钥/ 的/ 生成/ 过程/ 在/ 继承/ CPK/ 方案/ 的/ 基础/ 上/ 进行/ 了/ 扩展/ ,/ 使得/ 私钥/ 变成/ 一个/ 随机化/ 的/ 值/ ;/ 加密/ 的/ 密文/ 长度/ 为/ 固定/ 长度/ ./ 这些/ 为/ 该/ 方案/ 的/ 安全性/ 证明/ 和/ 实用性/ 提供/ 了/ 必要/ 的/ 条件/ ./ 4/ 新/ 方案/ 的/ 安全性/ 证明/ 本章/ 分/ 两个/ 部分/ 分别/ 证明/ 扩展/ CPK/ 方案/ 的/ 抗/ 合谋/ 攻击性/ 和/ 新/ IBE/ 方案/ 在/ 标准/ 模型/ 下/ IND/ -/ ID/ -/ CPA/ 安全性/ ./ 4.1/ 扩展/ CPK/ 方案/ 的/ 抗/ 合谋/ 攻击性/ 扩展/ CPK/ 方案/ 由/ 新/ IBE/ 方案/ 的/ Extract/ 算法/ 、/ Encrypt/ 算法/ 中/ 接收/ 方/ 加密/ 密钥/ 的/ 生成/ 算法/ 及其/ 相应/ 的/ 系统/ 参数/ 共同/ 组成/ ./ 本节/ 将/ 根据/ 合谋/ 攻击/ 的/ 直观/ 含义/ 和/ IBE/ 体制/ 的/ 特点/ ,/ 即/ 攻击者/ 有/ 可能/ 预先/ 知道/ 某些/ 合法/ 用户/ 的/ 私钥/ ,/ 给出/ 具有/ 针对性/ 的/ 合谋/ 攻击/ 的/ 定义/ ./ 并/ 在/ 此基础/ 上/ ,/ 基于/ CDH/ 假设/ 证明/ 扩展/ CPK/ 方案/ 的/ 抗/ 合谋/ 攻击性/ ./ 定义/ 6/ ./ IBE/ 体制/ 中/ 针对/ 私钥/ 的/ 合谋/ 攻击/ ./ IBE/ 体制/ 中/ 针对/ 私钥/ 的/ 合谋/ 攻击/ 由/ 以下/ 阶段/ 组成/ ./ 初始化/ 阶段/ ./ 挑战者/ 执行/ IBE/ 体制/ 的/ Setup/ 算法/ ,/ 但仅/ 生成/ 与/ 计算/ 加密/ 密钥/ 和/ 私钥/ 相关/ 的/ 公开/ 参数/ 和/ 秘密/ 参数/ ,/ 并/ 将/ 公开/ 参数/ 发送给/ 攻击者/ ./ 私钥/ 查询/ 阶段/ ./ 输入/ 用户/ 身份/ 信息/ ,/ 攻击者/ 可以/ 向/ 挑战者/ 询问/ 任意/ 合法/ 用户/ 的/ 私钥/ ./ 私钥/ 生成/ 阶段/ ./ 攻击者/ 根据/ 获取/ 的/ 用户/ 私钥/ ,/ 生成/ 并/ 输出/ 某/ 合法/ 用户/ 的/ 身份/ 信息/ 及其/ 私钥/ ,/ 且/ 攻击者/ 在/ 私钥/ 查询/ 阶段/ 未/ 询问/ 过该/ 用户/ 的/ 私钥/ ./ 根据上述/ 定义/ ,/ 若/ 有效/ 时间/ 内/ ,/ 在/ 私钥/ 生成/ 阶段/ 攻击者/ 输出/ 的/ 私钥/ 为/ 该/ 用户/ 的/ 合法/ 私钥/ ,/ 即/ 满足/ IBE/ 体制/ 的/ 私钥/ 的/ 结构/ ,/ 则/ 称为/ IBE/ 体制/ 中/ 一次/ 成功/ 的/ 私钥/ 合谋/ 攻击/ ./ 由于/ 原/ CPK/ 方案/ 和/ 扩展/ CPK/ 方案/ 的/ 合谋/ 攻击/ 均/ 是/ 仅/ 针对/ 私钥/ 的/ 攻击/ ,/ 因此/ 上述/ 定义/ 的/ 初始化/ 阶段/ 并/ 不/ 要求/ 生成/ 完整/ 的/ IBE/ 体制/ 的/ 公开/ 参数/ 和/ 秘密/ 参数/ ,/ 而/ 仅仅/ 生成/ 与/ 计算/ 加密/ 密钥/ 和/ 私钥/ 有关/ 的/ 参数/ ./ 定理/ 1/ ./ 假设/ 新/ IBE/ 方案/ 中/ ,/ 群/ G1/ 上/ CDH/ 假设/ 成立/ ,/ 则/ 其/ 扩展/ CPK/ 方案/ 抗/ IBE/ 体制/ 中/ 针对/ 私钥/ 的/ 合谋/ 攻击/ ./ 证明/ ./ 假设/ 新/ IBE/ 方案/ 中/ 存在/ 成功/ 的/ 针对/ 私钥/ 的/ 合谋/ 攻击者/ A/ ,/ 则/ 可以/ 构造/ 有效/ 的/ 仿真/ 算法/ B/ 实现/ 一次/ A/ 和/ B/ 间/ 合谋/ 攻击/ 的/ 有效/ 仿真/ ,/ 且/ 最终/ 仿真/ 算法/ B/ 求解/ 出/ CDH/ 问题/ ./ 令/ η/ (/ k/ )/ 为/ CDH/ 问题/ 的/ 参数/ 生成/ 算法/ ,/ 其中/ k/ 为/ 安全/ 参数/ ./ 仿真/ 算法/ B/ 如下/ :/ 初始化/ 阶段/ ./ 由/ 算法/ η/ (/ k/ )/ 生成/ CDH/ 问题/ 实例/ 〈/ q/ ,/ G1/ ,/ P/ ,/ aP/ ,/ bP/ 〉/ ;/ 根据/ 新/ IBE/ 方案/ 的/ 生成/ 针对/ 私钥/ 的/ 合谋/ 攻击/ 所/ 需要/ 的/ 公开/ 参数/ 〈/ q/ ,/ G1/ ,/ P/ ,/ g1/ ,/ g2/ ,/ F/ ,/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ 〉/ 和/ 秘密/ 参数/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ ,/ 其中/ g1/ =/ aP/ ,/ g2/ =/ bP/ ,/ F/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fh/ }/ ,/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ =/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ =/ 阶段/ 也/ 是/ 扩展/ CPK/ 方案/ 的/ 实例/ 化/ 过程/ )/ ./ 私钥/ 查询/ 阶段/ ./ 合谋/ 攻击者/ A/ 可以/ 询问/ 任意/ 合法/ 用户/ 的/ 私钥/ ./ 令/ 查询/ 的/ 用户/ 身份/ 信息/ 为/ 〈/ ID/ 〉/ ,/ 若/ fh/ (/ ID/ )/ =/ m/ 则/ 仿真/ 算法/ B/ 停止/ 并/ 退出/ ;/ 否则/ 仿真/ 算法/ 随机/ 选取/ σ/ ∈/ 犣/ / q/ ,/ 计算/ 并/ 返还/ 私钥/ 其中/ ,/ SKID/ 的/ 计算/ 与/ 新/ IBE/ 方案/ 的/ Extract/ 算法/ 相同/ ./ 显然/ SKID/ 可/ 有效/ 计算/ ,/ 且易证/ SKID/ =/ 〈/ a/ ·/ g2/ +/ (/ σ/ +/ a/ )/ ·/ (/ SKID/ -/ b/ )/ ·/ P/ ,/ (/ σ/ +/ a/ )/ P/ 〉/ ./ 由于/ a/ 为/ 随机/ 选取/ ,/ 且/ SKID/ 和/ 新/ IBE/ 方案/ 的/ Extract/ 算法/ 生成/ 的/ 算法/ 具有/ 相同/ 的/ 结构/ ,/ 因此/ 合谋/ 攻击者/ A/ 在/ 有效/ 时间/ 内/ 无法/ 区分/ 仿真/ 算法/ B/ 和/ 新/ IBE/ 方案/ 的/ Extract/ 算法/ 的/ 输出/ ,/ 即/ 仿真/ 算法/ B/ 为/ 有效/ 仿真/ ./ 私钥/ 生成/ 阶段/ ./ 攻击者/ 生成/ 并/ 输出/ 某/ 合法/ 用户/ 的/ 有效/ 的/ 私钥/ ,/ 令/ 输出/ 为/ 〈/ ID/ / ,/ SKID/ / 〉/ ,/ 且/ 在/ 私钥/ 查询/ 阶段/ 攻击者/ 没有/ 询问/ 过/ ID/ / 的/ 私钥/ ./ 若/ fh/ (/ ID/ )/ ≠/ m/ 则/ 仿真/ 算法/ B/ 停止/ 并/ 退出/ ./ 仿真/ 算法/ B/ 由/ 〈/ ID/ / ,/ SKID/ / 〉/ 求解/ CDH/ 问题/ :/ 由于/ SKID/ / 为/ 有效/ 私钥/ ,/ 即/ SKID/ / =/ 〈/ a/ ·/ g2/ +/ σ/ ·/ SKID/ ·/ P/ ,/ σ/ P/ 〉/ ,/ 其中/ σ/ ∈/ 犣/ / tract/ 算法/ 相同/ ,/ 由/ ID/ / 计算/ SKID/ / ;/ 由于/ 已知/ SKID/ / ,/ σ/ P/ ,/ a/ ·/ g2/ +/ σ/ ·/ SKID/ ·/ P/ ,/ 易求/ a/ ·/ g2/ ;/ 由于/ a/ ·/ g2/ =/ abP/ ,/ 因此/ 仿真/ 算法/ B/ 成功/ 求解/ CDH/ 问题/ ./ 最后/ 计算/ 仿真/ 算法/ B/ 在/ 私钥/ 查询/ 阶段/ 和/ 私钥/ 生成/ 阶段/ 不会/ 停止/ 并/ 退出/ 的/ 概率/ ./ 令该/ 事件/ 为/ Abort/ 、/ 合谋/ 攻击者/ A/ 询问/ 用户/ 私钥/ 的/ 次数/ 为/ qID/ ,/ Page6/ 则/ 显然/ 有/ Pr/ [/ Abort/ ]/ =/ 1/ 综上所述/ ,/ 可以/ 得出/ :/ 若/ 新/ IBE/ 方案/ 中/ 存在/ 针对/ 私钥/ 的/ 合谋/ 攻击者/ A/ ,/ 且/ 仿真/ 算法/ B/ 不会/ 中途/ 停止/ 并/ 退出/ ,/ 则/ 以/ 概率/ “/ 1/ ”/ 求解/ CDH/ 问题/ ;/ 又/ 由于/ 合谋/ 攻击者/ A/ 的/ 询问/ 必须/ 在/ 有效/ 时间/ 内/ 完成/ ,/ 因此/ 其/ 询问/ 次数/ qID/ 必是/ 关于/ 安全/ 参数/ k/ 的/ 多项式/ ,/ 则/ 令/ m/ =/ qID/ ,/ 显然/ 可以/ 看出/ Pr/ [/ Abort/ ]/ 的/ 值/ 为/ 不可/ 忽略/ 数/ ./ 结合/ 以上/ 两点/ 可以/ 看出/ ,/ 仿真/ 算法/ B/ 求解/ CDH/ 问题/ 的/ 概率/ 不可/ 忽略/ ,/ 而/ 和/ 群/ G1/ 上/ CDH/ 假设/ 成立/ 相/ 矛盾/ ,/ 因此/ 新/ IBE/ 方案/ 不/ 存在/ 针对/ 私钥/ 的/ 有效/ 的/ 合谋/ 攻击/ ,/ 即/ 扩展/ CPK/ 方案/ 具有/ 抗/ 合谋/ 攻击性/ ./ 4.2/ 新/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 安全性/ 新/ IBE/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 安全性/ 的/ 证明/ :/ 将/ 某/ 难题/ 的/ 求解/ 归约/ 到/ 某/ 方案/ 的/ 破解/ ,/ 从而/ 推出/ 矛盾/ (/ 难题/ 通常/ 认为/ 是/ 不可/ 解/ 的/ )/ ,/ 并/ 证明/ 该/ 方案/ 的/ 安全性/ ./ 针对/ 本文/ 提出/ 的/ 新/ IBE/ 方案/ 和/ 安全性/ 目标/ ,/ 即/ IND/ -/ ID/ -/ CPA/ 安全性/ ,/ 该/ 方案/ 的/ 安全性/ 证明/ 主要/ 在于/ 如何/ 有效/ 地/ 仿真/ 各/ 用户/ 私钥/ ,/ 并/ 在/ 某些/ 条件/ 下/ 生成/ 有效/ 的/ 挑战/ 密文/ (/ 具体条件/ 见下文/ )/ ./ 本节/ 将/ 先/ 提出/ 安全性/ 定理/ 并/ 详细/ 证明/ ./ 定理/ 2/ ./ 假设/ 新/ IBE/ 方案/ 中/ ,/ 群/ G1/ (/ 上/ T/ +/ O/ (/ qIDTE/ )/ ,/ 1/ 立/ ,/ 则/ 该/ 方案/ 的/ 实例/ θ/ 是/ (/ T/ ,/ qID/ ,/ ε/ )/ -/ IND/ -/ ID/ -/ CPA/ 安全/ 的/ ,/ 其中/ TE/ 是/ 群/ G1/ 中/ 一次/ 模幂/ 运算/ 的/ 最大/ 时间/ ./ 证明/ ./ 假设/ 存在/ IND/ -/ ID/ -/ CPA/ 攻击者/ A/ 在/ 时间/ T/ 内以/ 不可/ 忽略/ 的/ 优势/ Adv/ θ/ ,/ A/ =/ ε/ 攻破/ 新/ IBE/ 方案/ θ/ ,/ 本文/ 将/ 构建/ 仿真器/ B/ 实现/ 一次/ A/ 与/ B/ 间/ 的/ IND/ -/ ID/ -/ CPA/ 攻击/ 的/ 有效/ 仿真/ ,/ 并/ 通过/ 多次/ 该/ 仿真/ 完成/ 一次/ 统计/ 测试/ 过程/ ,/ 最终/ 以/ 压倒性/ 概率/ 求解/ DecisionalBDH/ 问题/ ./ 从/ DecisionalBDH/ 问题/ 的/ 分布/ D/ 和/ R/ 中/ ,/ 任意/ 取定/ 一个/ 分布/ ,/ 并/ 从中/ 随机/ 选取/ 一个/ 分组/ ,/ 且/ 令/ 该/ 分组/ 为/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ ./ 输入/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 到/ 仿真器/ B/ ,/ 并/ 仿真/ 新/ IBE/ 方案/ 的/ 实例/ ,/ 过程/ 如下/ :/ 1/ ./ 初始化/ 阶段/ ./ 继承/ DecisionalBDH/ 问题/ 的/ 系统/ 参数/ 〈/ q/ ,/ G1/ ,/ G2/ ,/ ^/ e/ ,/ P/ 〉/ ;/ 根据/ 新/ IBE/ 方案/ 的/ Setup/ 算法/ 生成/ 系统/ 参数/ 〈/ q/ ,/ G1/ ,/ G2/ ,/ ^/ e/ ,/ P/ ,/ g1/ ,/ g2/ ,/ F/ 〉/ ,/ 其中/ g1/ =/ aP/ ,/ g2/ =/ bP/ ,/ F/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fh/ }/ ;/ 选取/ 私钥/ 种子/ 矩阵/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ =/ 实现/ 私钥/ 查询/ 阶段/ 和/ 挑战/ 密文/ 阶段/ 的/ 有效/ 仿真/ ,/ 计算/ 加密/ 密钥/ 种子/ 矩阵/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ =/ 且/ 由于/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ 中/ 各/ 元素/ 和/ b/ 均/ 是/ 随机/ 选取/ ,/ 所以/ 该/ 加密/ 密钥/ 种子/ 矩阵/ 和/ 真实/ 的/ 新/ IBE/ 方案/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 不可/ 区分/ ;/ 保密/ 私钥/ 种子/ 矩阵/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ ,/ 公开/ 系统/ 参数/ 〈/ q/ ,/ G1/ ,/ G2/ ,/ ^/ e/ ,/ P/ ,/ g1/ ,/ g2/ ,/ F/ ,/ 犘/ 狌/ 犫/ 犓/ 犛/ 犕/ 〉/ ./ 2/ ./ 私钥/ 查询/ 阶段/ 1/ ./ 攻击者/ A/ 可以/ 向/ 仿真器/ B/ 多次/ 询问/ 任意/ 用户/ 的/ 私钥/ ./ 令/ 私钥/ 查询/ 为/ 〈/ ID/ 〉/ ,/ 仿真器/ B/ 的/ 私钥/ 生成/ 过程/ 如下/ :/ 2.1/ ./ 若/ fh/ (/ ID/ )/ =/ m/ ,/ 则/ B/ 随机/ 输出/ “/ 1/ ”/ 或/ “/ 0/ ”/ ,/ 并/ 提前结束/ 该次/ 仿真/ ./ 2.2/ ./ 否则/ ,/ 与/ 新/ 方案/ 的/ Extract/ 算法/ 相同/ ,/ 根据/ 私钥/ 种子/ 矩阵/ 犘/ 狉/ 犻/ 犓/ 犛/ 犕/ 和/ 函数/ 集/ F/ 计算/ SKID/ ./ 2.3/ ./ 选取/ 随机数/ σ/ ∈/ 犣/ / q/ ,/ 计算/ 该/ 用户/ 私钥/ 如下/ :/ 根据/ 初始化/ 阶段/ 的/ 已知/ 参数/ ,/ 上/ 式/ 显然/ 可/ 计算/ ;/ (/ 用户/ 私钥/ 的/ 有效性/ 分析/ )/ 根据/ 私钥/ 生成/ 方式/ ,/ 有/ 如下/ 等式/ 成立/ :/ σ/ ·/ SKID/ ·/ P/ -/ σ/ ·/ b/ ·/ P/ +/ a/ ·/ SKID/ ·/ P/ =/ σ/ ·/ SKID/ ·/ P/ -/ σ/ ·/ b/ ·/ P/ +/ a/ ·/ SKID/ ·/ P/ -/ a/ ·/ b/ ·/ P/ +/ a/ ·/ b/ ·/ P/ =/ a/ ·/ g2/ +/ (/ σ/ +/ a/ )/ ·/ (/ SKID/ -/ b/ )/ ·/ P/ ,/ 即/ 私钥/ SKID/ =/ (/ a/ ·/ g2/ +/ (/ σ/ +/ a/ )/ ·/ (/ SKID/ -/ b/ )/ ·/ P/ ,/ (/ σ/ +/ a/ )/ ·/ P/ )/ ./ 又/ 根据/ 初始化/ 阶段/ 的/ 加密/ 密钥/ 种子/ 矩阵/ ,/ 显然/ 有/ 该/ 用户/ 的/ 加密/ 密钥/ PKID/ =/ (/ SKID/ -/ b/ )/ ·/ P/ ./ 对比/ 新/ IBE/ 方案/ 和/ 仿真器/ B/ 可以/ 发现/ ,/ 由于/ σ/ ,/ a/ ,/ b/ 和/ 私钥/ 种子/ 矩阵的元/ 素均/ 是/ 随机/ 选取/ ,/ 因此/ 这/ 两种/ 方式/ 生成/ 的/ 加密/ 密钥/ 和/ 私钥/ 不可/ 区分/ ,/ 即/ 仿真器/ B/ 生成/ 的/ 私钥/ 有效/ ./ 2.4/ ./ 返回/ 查询/ 结果/ SKID/ 给/ A/ ./ 3/ ./ 挑战/ 阶段/ ./ 攻击者/ A/ 结束/ 私钥/ 查询/ 阶段/ 1/ 后/ ,/ 提交/ 等长/ 的/ 明文/ m0/ ,/ m1/ 和/ 要/ 挑战/ 的/ 用户/ 身份/ IDch/ 给/ 仿真器/ B/ ,/ 其中/ A/ 没有/ 询问/ 过/ IDch/ 的/ 私钥/ ./ B/ 生成/ 挑战/ 密文/ 过程/ 如下/ :/ 3.1/ ./ 若/ fh/ (/ ID/ )/ ≠/ m/ ,/ 则/ B/ 随机/ 输出/ “/ 1/ ”/ 或/ “/ 0/ ”/ ,/ 并/ 提前结束/ 该次/ 仿真/ ./ 3.2/ ./ 否则/ ,/ 随机/ 选取/ d/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 并/ 根据/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 生成/ md/ 的/ 挑战/ 密文/ C/ =/ 〈/ ^/ e/ (/ P/ ,/ Z/ )/ ·/ md/ ,/ c/ ·/ P/ ,/ SKIDch/ ·/ c/ ·/ P/ 〉/ ,/ 由于/ B/ 已知/ SKIDch/ ,/ 所以/ 挑战/ 密文/ 可/ 计算/ ./ 3.3/ ./ 将/ 挑战/ 密文/ C/ 返回/ 给/ A/ ./ 4/ ./ 私钥/ 查询/ 阶段/ 2/ ./ 除了/ 攻击者/ A/ 不能/ 询问/ IDch/ 的/ 私钥/ 外/ ,/ 该/ 阶段/ 的/ 执行/ 和/ 私钥/ 查询/ 阶段/ 1/ 相同/ ./ 5/ ./ 猜测/ 阶段/ ./ 攻击者/ A/ 向/ 仿真器/ B/ 提交/ 对/ d/ 的/ 猜测/ d/ ./ 若/ d/ =/ d/ ,/ 则/ B/ 输出/ “/ 1/ ”/ ;/ 若/ d/ ≠/ d/ ,/ 则/ B/ 输出/ “/ 0/ ”/ ./ 最后/ 结束/ 该次/ 仿真/ ./ 以上/ 过程/ 即/ 为/ 一次/ 完整/ 的/ IND/ -/ ID/ -/ CPA/ 攻击/ 的/ 仿真/ ,/ 而且/ 由于/ 仿真/ 不/ 提前结束/ 时/ ,/ 系统/ 参数/ 和/ 私钥/ 查询/ 的/ 结果/ 和/ 真实/ 环境/ 不可/ 区分/ ,/ 因此/ 是/ 一次/ 有效/ 的/ 仿真/ ./ 若能/ 证明/ 当/ 仿真器/ 的/ 输入/ 分组/ 来自/ 不同/ Page7/ 的/ 分布/ 时/ ,/ 攻击者/ A/ 将/ 以/ 不可/ 忽略/ 的/ 优势/ 成功/ 猜测/ d/ ,/ 则/ 此时/ B/ 也/ 将/ 以/ 不可/ 忽略/ 的/ 优势/ 输出/ “/ 1/ ”/ ,/ 那么/ 就/ 可以/ 通过/ 执行/ 多次/ 以上/ 仿真/ (/ 每次/ 仿真器/ 的/ 输入/ 分组/ 在/ 取定/ 的/ 分布/ 中/ 随机/ 选取/ )/ 构成/ 一次/ 统计/ 测试/ 求解/ DecisionalBDH/ 问题/ (/ 具体/ 的/ 求解/ 方法/ 将/ 在/ 后面/ 描述/ )/ ./ 因此/ ,/ 通过/ 以下/ 两个/ 引理/ 的/ 证明/ ,/ 最终/ 可以/ 证明/ 定理/ 2/ ./ 引理/ 1/ ./ 当/ 仿真器/ 的/ 输入/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ D/ ,/ 并且/ 仿真/ 不/ 提前结束/ 时/ ,/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 联合/ 分布/ 与/ 真实/ 环境/ 统计/ 不可/ 区分/ ./ 证明/ ./ 根据/ 以上/ 仿真/ 过程/ ,/ 当/ 仿真/ 不/ 提前结束/ 时/ ,/ 显然/ 有/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 联合/ 部分/ 只/ 在/ 挑战/ 密文/ 阶段/ 有效/ ,/ 因此/ 只/ 需/ 证明/ 该/ 阶段/ 的/ 统计/ 不可/ 区分/ 性/ ./ 已知/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ D/ ,/ 则/ Z/ =/ abcP/ ./ 根据/ 挑战/ 密文/ 的/ 生成/ 方式/ ,/ 挑战/ 密文/ C/ =/ 〈/ ^/ e/ (/ g1/ ,/ g2/ )/ c/ ·/ md/ ,/ c/ ·/ P/ ,/ SKIDch/ ·/ c/ ·/ P/ 〉/ ./ 由于/ c/ 是/ 随机/ 选取/ ,/ 并且/ 挑战/ 密文/ 的/ 生成/ 形式/ 和/ 真实/ 的/ 新/ IBE/ 方案/ 相同/ ,/ 因此/ 在/ 一次/ 仿真/ 中/ ,/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 联合/ 分布/ 与/ 真实/ 环境/ 不可/ 区分/ ./ 又/ 因为/ 由/ 多次/ IND/ -/ ID/ -/ CPA/ 攻击/ 的/ 仿真/ 构成/ 的/ 统计/ 测试/ 中/ ,/ 每次/ 仿真器/ 的/ 输入/ 分组/ 均/ 是/ 随机/ 选取/ ,/ 且/ 每个/ 分布/ 中/ 的/ 分组/ 是/ 均匀/ 的/ 和/ 随机/ 生成/ 的/ ,/ 所以/ 每次/ 仿真/ 所/ 生成/ 的/ 挑战/ 密文/ 是/ 均匀/ 的/ 和/ 相互/ 独立/ 的/ ./ 因此/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 联合/ 部分/ 与/ 真实/ 环境/ 是/ 统计/ 不可/ 区分/ 的/ ./ 引理/ 1/ 得证/ ./ 证毕/ ./ 引理/ 2/ ./ 当/ 仿真器/ 的/ 输入/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ R/ ,/ 并且/ 仿真/ 不/ 提前结束/ 时/ ,/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 分布/ 相互/ 独立/ ./ 证明/ ./ 与/ 引理/ 1/ 相同/ ,/ 只/ 需/ 证明/ 挑战/ 密文/ 阶段/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 分布/ 相互/ 独立/ ./ 已知/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ R/ ,/ 则/ Z/ =/ rP/ ./ 根据/ 挑战/ 密文/ 的/ 生成/ 方式/ ,/ 挑战/ 密文/ C/ =/ 〈/ ^/ e/ (/ P/ ,/ P/ )/ r/ ·/ md/ ,/ c/ ·/ P/ ,/ SKIDch/ ·/ c/ ·/ P/ 〉/ ./ 由于/ r/ 是/ 随机/ 选取/ 并且/ 和/ a/ ,/ b/ ,/ c/ 无关/ ,/ 更进一步/ 的/ 说/ ,/ r/ 和/ A/ 所/ 看到/ 的/ 无关/ ,/ 因此/ ^/ e/ (/ P/ ,/ P/ )/ r/ ·/ md/ 是/ 一次/ 完美/ 填充/ ,/ 即/ 攻击者/ A/ 所/ 看到/ 的/ 和/ d/ 的/ 分布/ 相互/ 独立/ ./ 引理/ 2/ 得证/ ./ 证毕/ ./ 一方面/ ,/ 综合/ 引理/ 1/ 和/ 2/ ,/ 可以/ 看出/ :/ 当/ 仿真器/ 的/ 输入/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ D/ 并且/ 仿真/ 不/ 提前结束/ 时/ ,/ 一次/ 仿真/ 中/ 攻击者/ A/ 在/ 时间/ T/ 内以/ 优势/ Adv/ θ/ ,/ A/ =/ ε/ 使得/ d/ =/ d/ ;/ 当/ 仿真器/ 的/ 输入/ 分组/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ Z/ 〉/ 来自/ 分布/ R/ 并且/ 仿真/ 不/ 提前结束/ 时/ ,/ 一次/ 仿真/ 中/ 攻击者/ A/ 在/ 时间/ T/ 内以/ 优势/ Adv/ θ/ ,/ A/ =/ 0/ 使得/ d/ =/ d/ ./ 又/ 根据/ 仿真/ 过程/ 中/ ,/ 函数/ 集/ F/ 的/ 选取/ 方式/ ,/ 可以/ 估算/ 出/ 一次/ 仿真/ 不/ 提前结束/ 的/ 概率/ ./ 令/ Abort/ 表示/ 一次/ 仿真/ 提前结束/ 事件/ ,/ 则/ Pr/ [/ Abort/ ]/ =/ 1/ 来自/ 不同/ 分布/ 时/ ,/ B/ 输出/ “/ 1/ ”/ 的/ 优势/ 为/ :/ |/ Pr/ [/ B/ (/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ abcP/ 〉/ )/ =/ 1/ ]/ -/ Pr/ [/ B/ (/ 〈/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ rP/ 〉/ )/ =/ 1/ ]/ |/ =/ 1m1/ -/ 1/ (/ )/ m1/ 以/ 构建/ 由/ 若干次/ 以上/ 仿真/ 组成/ 的/ 一次/ 统计/ 测试/ ,/ 并且/ 若/ 统计/ 测试/ 结果/ 中/ B/ 输出/ “/ 1/ ”/ 的/ 次数/ 多于/ 输出/ “/ 0/ ”/ 的/ 次数/ ,/ 则/ B/ 的/ 输入/ 分组/ 来自/ 分布/ D/ ;/ 若/ 统计/ 测试/ 结果/ 中/ B/ 输出/ “/ 1/ ”/ 的/ 次数/ 等于/ 输出/ “/ 0/ ”/ 的/ 次数/ ,/ 则/ B/ 的/ 输入/ 分组/ 来自/ 分布/ R/ ,/ 从而/ 实现/ 以/ 压倒性/ 的/ 概率/ 求解/ DecisionalBDH/ 问题/ ./ 另一方面/ ,/ 易/ 计算/ 仿真器/ B/ 的/ 时间/ 复杂度/ 约/ 为/ O/ (/ qIDTE/ )/ ./ 又/ 因为/ 攻击者/ A/ 的/ 时间/ 约束/ 为/ T/ ,/ 所以/ 一次/ 仿真/ 中/ B/ 利用/ A/ 求解/ DecisionalBDH/ 问题/ 的/ 时间/ 约束/ 为/ T/ +/ O/ (/ qIDTE/ )/ ./ 综合/ 以上/ 两/ 方面/ 可以/ 得出/ ,/ DecisionalBDH/ 问题/ 在/ 时间/ T/ +/ O/ (/ qIDTE/ )/ 内以/ 不/ 小于/ 1/ 的/ 优势/ 被/ B/ 破解/ ./ m1/ -/ 1/ (/ )/ m1/ 所以/ 上述/ 新/ IBE/ 方案/ θ/ 是/ (/ T/ ,/ qID/ ,/ ε/ )/ -/ IND/ -/ ID/ -/ CPA/ 安全/ 的/ ./ 定理/ 2/ 得证/ ./ 综上所述/ ,/ 新/ IBE/ 方案/ 在/ 标准/ 模型/ 下/ 具有/ 可/ 证明/ 的/ IND/ -/ ID/ -/ CCA/ 安全性/ ,/ 即/ 在/ 标准/ 模型/ 下/ 有效/ 地/ 实现/ 了/ DecisionalBDH/ 问题/ 到/ 新/ IBE/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 攻击者/ 的/ 归约/ ./ 5/ 新/ 方案/ 的/ 实用性/ 分析/ 众所周知/ ,/ 用户加密/ 密钥/ 的/ 抗/ 碰撞/ 性是/ 一个/ 重要/ 的/ 安全性/ 和/ 实用性/ 指标/ ./ 由于/ 扩展/ CPK/ 方案/ 和/ 其它/ 的/ IBE/ 方案/ 的/ 加密/ 密钥/ 生成/ 过程/ 不同/ ,/ 因此/ 需要/ 单独/ 讨论/ 其抗/ 碰撞/ 性/ ./ 本节/ 还/ 将/ 通过/ 与/ 同类/ 方案/ 的/ 归约/ 程度/ 和/ 时空/ 复杂度/ 对比/ ,/ 讨论/ 新/ IBE/ 方案/ 的/ 实用性/ ./ 5.1/ 扩展/ CPK/ 方案/ 的/ 加密/ 密钥/ 抗/ 碰撞/ 分析/ 根据/ 扩展/ CPK/ 方案/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 可以/ 看出/ ,/ 共/ 存在/ 两种/ 可能/ 的/ 碰撞/ :/ (/ 1/ )/ 两/ 用户/ 的/ ID/ 对应/ 不同/ 索引/ 值时/ ,/ 即/ / fi/ ∈/ F/ 使得/ 两/ 用户/ 的/ fi/ (/ ID/ )/ 值/ 不/ 同时/ ,/ 对应/ 的/ 加密/ 密钥/ 相同/ ;/ (/ 2/ )/ 两/ 用户/ 的/ ID/ 对应/ 的/ 索引/ 值/ 相同/ ,/ 则/ 加密/ 密钥/ 相同/ ./ 本节/ 将/ 分别/ 讨/ Page8/ 论/ 以上/ 两种/ 情况/ ./ 情况/ 1/ ./ 由于/ 私钥/ 种子/ 矩阵的元/ 素是/ 随机/ 选取/ ,/ 且/ 加密/ 密钥/ 种子/ 矩阵/ 基于/ 素数/ 阶/ 循环群/ ,/ 因此/ 任意/ 用户/ 对应/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 中/ 元素/ 的/ 组合/ 也/ 是/ 循环群/ 中/ 的/ 随机/ 元/ ./ 由于/ m/ ×/ h/ 阶/ 加密/ 密钥/ 种子/ 矩阵/ 可以/ 产生/ mh/ 种/ 组合/ ,/ 因此/ mh/ 种/ 组合/ 不/ 发生/ 碰撞/ 的/ 概率/ Pr1/ 为/ Pr1/ =/ 1/ -/ 1/ (/ )/ q1/ -/ 2/ (/ )/ q/ …/ 1/ -/ mh/ -/ 1/ (/ )/ q/ =/ 1/ +/ -/ i/ (/ )/ q/ ≈/ ∏/ mh/ -/ 1/ ∏/ mh/ -/ 1i/ =/ 1/ 加密/ 密钥/ 种子/ 矩阵/ 为例/ ,/ Pr1/ ≈/ e/ -/ 2320/ // O/ (/ 21024/ )/ ,/ 可见/ 此时/ 不/ 发生/ 碰撞/ 的/ 概率/ 极高/ ./ 虽然/ 根据/ Pr1/ 的/ 计算公式/ 可以/ 看出/ :/ 不/ 发生/ 碰撞/ 的/ 概率/ Pr1/ 随/ m/ ×/ h/ 增大/ 而/ 减小/ ,/ 但是/ 在/ 实际/ 应用/ 中/ 显然/ 较/ 小/ 的/ m/ ×/ h/ 已经/ 满足/ 应用/ ,/ 例如/ 32/ ×/ 32/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 具有/ 大约/ 1048/ 种/ 组合/ ./ 因此/ 在/ 实际/ 应用/ 中/ ,/ 第/ 1/ 种/ 情况/ 几乎/ 不会/ 发生/ ./ 情况/ 2/ ./ 由于/ 目前/ 对/ 所有/ 实用/ 中/ 的/ Hash/ 函数/ 很难/ 精确/ 地/ 刻画/ 其抗/ 碰撞/ 概率/ ,/ 因此/ 本文/ 无法/ 精确/ 地/ 计算/ 出该/ 情况/ 下/ 扩展/ CPK/ 方案/ 发生/ 碰撞/ 的/ 概率/ ./ 但是/ 从/ 实用/ 角度/ 出发/ ,/ 可以/ 通过/ 存在/ 性/ 证明/ 的/ 方法/ 得出/ ,/ 当/ 加密/ 密钥/ 种子/ 矩阵/ 的/ 规模/ 达到/ 一定/ 时/ ,/ 存在/ 某种/ 方法/ 使/ 其/ 该/ 情况/ 下/ 碰撞/ 发生/ 的/ 概率/ 和/ 某/ 实用/ Hash/ 函数/ 相同/ ,/ 具体/ 的/ 过程/ 见/ 定理/ 3/ ./ 定理/ 3/ ./ 若/ 扩展/ CPK/ 方案/ 的/ m/ ×/ h/ 阶/ 加密/ 密钥/ 种子/ 矩阵/ 满足/ m/ / 2160/ 用户/ 的/ 索引/ 值/ 发生/ 碰撞/ 的/ 概率/ 不/ 大于/ Hash/ 函数/ SHA/ -/ 1/ ./ 证明/ ./ 本文/ 通过/ 构造/ 具体/ 的/ 方法/ 证明/ 该/ 定理/ ./ 已知/ Hash/ 函数/ SHA/ -/ 1/ 的/ 输出/ 为/ 160/ 位/ ./ 因此/ 分为/ 以下/ 两种/ 情况/ 分别/ 证明/ :/ (/ 1/ )/ 当/ h/ |/ 160/ 时/ ,/ 构造/ 用户/ ID/ 的/ 加密/ 密钥/ 生成/ 方式/ 为/ :/ 计算/ 用户/ ID/ 的/ Hash/ 值/ SHA/ -/ 1/ (/ ID/ )/ ;/ 将/ 该值/ 依次/ 分为/ 等长/ 的/ h/ 份/ 并/ 依次/ 对应/ 扩展/ CPK/ 方案/ 加密/ 密钥/ 种子/ 矩阵/ 的/ h/ 列/ ,/ 每份/ 的/ 值/ 对应/ 相应/ 列/ 的/ 行号/ ;/ 依次/ 提取/ h/ 列/ 的/ 相应/ 行值/ 作为/ 该/ 用户/ 的/ 加密/ 密钥/ 种子/ 组合/ ,/ 并/ 计算/ 加密/ 密钥/ ./ 由于/ 每份/ 长为/ 160/ 位/ ,/ 因此/ 当/ m/ / 2160/ 相同/ ./ 而且/ 此时/ 不同/ 用户/ 的/ 索引/ 值/ 发生/ 碰撞/ 的/ 概率/ 不/ 大于/ SHA/ -/ 1/ ./ (/ 2/ )/ 当/ h/ // |/ 160/ 时/ ,/ 构造/ 用户/ ID/ 的/ 加密/ 密钥/ 生成/ 方式/ 为/ :/ 计算/ 用户/ ID/ 的/ Hash/ 值/ SHA/ -/ 1/ (/ ID/ )/ ;/ 将/ 该值/ 依次/ 分为/ h/ 份/ ,/ 其中/ 二进制/ 长度/ 为/ 160/ 份/ 、/ 二进制/ 长度/ 为/ 160160h/ ×/ X/ +/ 160/ 烄/ 烅/ 烆/ hX/ +/ Y/ =/ 将/ h/ 份/ 依次/ 对应/ 扩展/ CPK/ 方案/ 加密/ 密钥/ 种子/ 矩阵/ 的/ h/ 列/ ,/ 每份/ 的/ 值/ 对应/ 相应/ 列/ 的/ 行号/ ;/ 依次/ 提取/ h/ 列/ 的/ 相应/ 行值/ 作为/ 该/ 用户/ 的/ 加密/ 密钥/ 种子/ 组合/ ,/ 并/ 计算/ 加密/ 密钥/ ./ 由于/ 每份/ 的/ 长/ 小于/ 等于/ 160/ 当/ m/ / 2160/ 且/ 此时/ 不同/ 用户/ 的/ 索引/ 值/ 发生/ 碰撞/ 的/ 概率/ 不/ 大于/ SHA/ -/ 1/ ./ 综合/ 1/ 、/ 2/ ,/ 定理/ 3/ 得证/ ./ 根据/ 定理/ 3/ 可知/ ,/ 当/ 扩展/ CPK/ 方案/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 达到/ 32/ ×/ 32/ 阶/ 以上/ 时/ ,/ 必然/ 存在/ 某种/ 方法/ 使/ 其/ 不同/ 用户/ 索引/ 值/ 发生/ 碰撞/ 的/ 概率/ 不/ 大于/ Hash/ 函数/ SHA/ -/ 1/ ./ 同理/ ,/ 当/ 扩展/ CPK/ 方案/ 的/ 加密/ 密钥/ 种子/ 矩阵/ 达到/ 16/ ×/ 32/ 阶/ 以上/ 时/ ,/ 必然/ 存在/ 某种/ 方法/ 使该/ 碰撞/ 的/ 发生/ 概率/ 不/ 大于/ Hash/ 函数/ MD5/ ./ 进一步/ 可以/ 看出/ ,/ 与/ 情况/ 1/ 相反/ ,/ 情况/ 2/ 不/ 发生/ 碰撞/ 的/ 概率/ 随/ m/ ×/ h/ 增大/ 而/ 增大/ ,/ 但是/ 通过/ 以上/ 分析/ 可见/ 存在/ 很/ 多种/ 加密/ 密钥/ 种子/ 矩阵/ 规模/ 使/ 以上/ 两种/ 情况/ 发生/ 的/ 概率/ 很小/ ./ 另外/ ,/ 由于/ 原/ CPK/ 方案/ 和/ 扩展/ CPK/ 方案/ 的/ 加密/ 密钥/ 生成/ 方式/ 相同/ ,/ 因此/ 上述/ 用户加密/ 密钥/ 的/ 碰撞/ 分析/ 同样/ 适用/ 于/ 前者/ ./ 5.2/ 新/ 方案/ 与/ 同类/ 方案/ 的/ 归约/ 程度/ 对比/ 可/ 证明/ 安全性/ 的/ 归约/ 程度/ 是/ 衡量/ 一个/ 密码/ 体制/ 安全性/ 和/ 实用性/ 的/ 重要/ 指标/ ./ 总的来说/ ,/ 基于/ 同一个/ 困难/ 假设/ (/ 不仅/ 假设/ 的/ 文字描述/ 相同/ ,/ 且/ 安全性/ 的/ 量化/ 也/ 相同/ )/ 的/ 不同/ 密码/ 体制/ 的/ 可/ 证明/ 安全性/ ,/ 归约/ 程度/ 越/ “/ 紧/ ”/ (/ 具体/ 的/ 含义/ 见下文/ )/ 则/ 密码/ 体制/ 越/ 安全/ ;/ 换句话说/ ,/ 基于/ 同/ 一类/ 困难/ 假设/ (/ 假设/ 的/ 文字描述/ 相同/ ,/ 但/ 安全性/ 的/ 量化/ 不同/ )/ ,/ 且/ 具有/ 相同/ 安全性/ 量化/ 的/ 不同/ 密码/ 体制/ ,/ 归约/ 程度/ 越/ “/ 紧/ ”/ 则/ 密码/ 体制/ 的/ 安全/ 参数/ 越小/ ,/ 计算/ 效率/ 更高/ ./ 本节/ 将/ 对比/ 新/ IBE/ 方案/ 和/ 3/ 个/ 知名/ 的/ 基于/ 同一个/ 困难/ 假设/ 的/ IBE/ 方案/ [/ 4/ ,/ 6/ -/ 7/ ]/ 在/ 可/ 证明/ 安全性/ 中/ 的/ 归约/ 程度/ ,/ 从而/ 得出/ 新/ IBE/ 方案/ 在/ 归约/ 程度/ 方面/ 的/ 实用性/ ./ 由于/ 文献/ [/ 4/ -/ 6/ ]/ 中/ 各/ IBE/ 方案/ 的/ 安全性/ 定理/ 的/ 描述/ 方式/ 不同/ ,/ 为了/ 方便/ 进行/ 归约/ 程度/ 的/ 比较/ ,/ 本文/ 将/ 各/ 安全性/ 定理/ 等价/ 转换/ 为同/ 一种/ 描述/ 形式/ ,/ 即/ 假设/ (/ T/ ,/ ε/ )/ -/ DecisionalBDH/ 假设/ 在/ 群/ G1/ 中/ 成立/ 时/ ,/ 各/ IBE/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 安全性/ ,/ 并且/ 对/ 结论/ 进行/ 了/ 优化/ (/ 选取/ 适当/ 参数/ 使/ 归约/ 达到/ 最/ “/ 紧/ ”/ )/ ,/ 具体/ 结论/ 见表/ 1/ (/ 称/ 文献/ [/ 4/ -/ 6/ ]/ 中/ 的/ IBE/ 体制/ 分别/ 为/ BB04a/ 、/ BB04b/ 、/ W05/ )/ ./ Page9/ 表/ 14/ 种/ IBE/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 安全性/ 对比/ IBE/ 方案/ 名称/ BB04aBB04bW05/ (/ T/ -/ O/ (/ ε/ -/ 2ln/ (/ ε/ -/ 1/ )/ λ/ -/ 1ln/ (/ λ/ -/ 1/ )/ )/ ,/ qID/ ,/ 32/ (/ N/ +/ 1/ )/ qID/ ε/ )/ 新/ IBE/ 方案/ 归约/ 程度/ 越/ “/ 紧/ ”/ 指/ 的/ 是/ :/ 若/ 可以/ 证明/ 基于/ (/ T/ ,/ ε/ )/ -/ HA/ 假设/ ,/ 密码/ 体制/ 是/ (/ T/ -/ TR/ ,/ ε/ )/ -/ SD/ 安全/ 的/ ,/ 其中/ HA/ 表示/ 某/ 难题/ (/ 例如/ ,/ DecisionalBDH/ 难题/ 等等/ )/ 、/ SD/ 表示/ 某/ 安全性/ 定义/ (/ 例如/ ,/ IND/ -/ ID/ -/ CPA/ 安全性/ 等等/ )/ 、/ TR/ 表示/ 归约/ 的/ 时间/ 复杂度/ ,/ 那么/ ε/ 和/ ε/ 越/ 接近/ ,/ 归约/ 程度/ 越/ “/ 紧/ ”/ ./ 根据/ 表/ 1/ 可以/ 看出/ ,/ 基于/ 同一个/ 困难/ 假设/ 的/ 新/ IBE/ 方案/ 和/ BB04b/ 方案/ 具有/ 目前/ 同类/ 方案/ 中/ 最/ “/ 紧/ ”/ 的/ 归约/ ,/ 换句话说/ ,/ 当/ 以上/ 4/ 个/ 方案/ 具有/ 相同/ 的/ 安全/ 参数/ 时/ ,/ 新/ IBE/ 方案/ 和/ BB04b/ 方案/ 的/ 安全性/ 最高/ ./ 另一方面/ ,/ 虽然/ 难题/ 和/ 密码/ 方案/ 的/ 破解/ 难度/ 与/ 时间/ 有关/ ,/ 即/ 时间/ 越长/ 破解/ 优势/ 越高/ ,/ 但是/ 由于/ 实用/ 中/ 安全/ 的/ 密码/ 方案/ 和/ 难题/ 通常/ 是/ 指/ 在/ 相当/ 长/ 的/ 时间/ 内/ 它们/ 的/ 破解/ 优势/ 可/ 忽略/ ,/ 表/ 24/ 个/ IBE/ 方案/ 的/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 长度/ 对比/ IBE/ 方案/ 的/ 名称/ BB04aBB04bN/ +/ 1W05/ 新/ IBE/ 方案/ 2N/ +/ 1N/ +/ 2/ 根据/ 表/ 2/ 显然/ 可以/ 看出/ ,/ 虽然/ BB04b/ 和/ 新/ IBE/ 方案/ 具有/ 目前/ 最优/ 的/ 归约/ 程度/ ,/ 但是/ BB04b/ 方案/ 的/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 长度/ 是/ 4/ 个/ 方案/ 中/ 最差/ 的/ ,/ 相反/ 新/ IBE/ 方案/ 和/ W05/ 方案/ 具有/ 目前/ 最优/ 的/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 长度/ ./ 综合/ 以上/ 两点/ 可以/ 得出/ ,/ 新/ IBE/ 方案/ 不仅/ 具有/ 目前/ 最优/ 的/ 归约/ 程度/ ,/ 同时/ 具有/ 目前/ 最优/ 的/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 长度/ ,/ 是/ 相对/ 比较/ 实用/ 的/ 加密/ 方案/ ./ 6/ 总结/ 与/ 展望/ 针对/ CPK/ 方案/ 存在/ 合谋/ 攻击/ 的/ 缺陷/ ,/ 本文/ 在/ 完全/ 继承/ CPK/ 方案/ 的/ 基础/ 上/ ,/ 对/ 其/ 私钥/ 生成/ 过程/ 进行/ 了/ 扩展/ ,/ 使得/ 扩展/ CPK/ 方案/ 具有/ 可/ 证明/ 的/ 抗/ 合谋/ 攻击性/ ./ CPK/ 方案/ 是/ 一种/ 用于/ 给/ 基于/ 身份/ 密码/ 体制/ 生成/ 加密/ 密钥/ 和/ 私钥/ 的/ 方案/ ,/ 其/ 最终/ 意义/ 还是/ 要/ 运用/ 在/ 某/ 基于/ 身份/ 密码/ 体制/ 中/ ,/ 因此/ 构建/ 可/ 证明/ 安全/ 的/ 基于/ 扩展/ CPK/ 方案/ 的/ IBE/ 方案/ 具有/ 重要/ 意义/ ./ 本文/ 基于/ 扩展/ CPK/ 方案/ 提出/ 了/ 一个/ 在/ 标准/ 模型/ 下基/ 通过/ 适当/ 取/ 系统/ 参数/ 使/ 归约/ 达到/ 最/ “/ 紧/ ”/ 时/ 的/ 近似值/ ;/ e/ =/ 2.71/ (/ 下同/ )/ 通过/ 适当/ 取/ m/ 使/ 归约/ 达到/ 最/ “/ 紧/ ”/ 时/ 的/ 近似值/ (/ m/ =/ qID/ )/ 因此/ 基于/ 难题/ 的/ 时间/ 参数/ T/ 很大/ ,/ 而/ 又/ 因为/ 归约/ 过程/ 是/ 有效/ 时间/ 内/ 可/ 完成/ 的/ (/ 否则/ 证明/ 过程/ 无/ 意义/ )/ ,/ 即/ TR/ 最多为/ 多项式/ 时间/ 复杂度/ ,/ 所以/ 不/ 考虑/ 表/ 1/ 中/ 4/ 个/ IBE/ 方案/ 的/ IND/ -/ ID/ -/ CPA/ 安全性/ 因/ 时间/ 参数/ 的/ 不同/ 对/ 安全性/ 的/ 影响/ ./ 由此可见/ ,/ 在/ 归约/ 程度/ 上/ 新/ IBE/ 方案/ 具有/ 相对/ 较/ 好/ 的/ 实用性/ ./ 5.3/ 新/ 方案/ 与/ 同类/ 方案/ 的/ 时空/ 复杂度/ 对比/ 除了/ 归约/ 程度/ 外/ ,/ 由于/ 较长时间/ 的/ 加解密/ 过程/ 会/ 降低/ 密码/ 方案/ 的/ 应用/ 范围/ ,/ 较长/ 的/ 密文/ 会/ 消耗/ 更/ 多/ 的/ 传输/ 资源/ ,/ 因此/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 长度/ 是/ 衡量/ 密码/ 方案/ 的/ 另/ 一个/ 重要/ 指标/ ./ 与/ 上/ 一节/ 相同/ ,/ 本节/ 将/ 对比/ 表/ 1/ 中/ 4/ 个/ IBE/ 方案/ 的/ 加解密/ 时间/ 复杂度/ 和/ 密文/ 的/ 长度/ ,/ 具体/ 数据/ 见表/ 2/ ./ 解密/ 时间/ 复杂度/ 群/ G2/ 的/ 模乘/ 运算/ // 次/ 222/ 于/ DecisionalBDH/ 假设/ 可/ 证明/ 安全/ 的/ 新/ IBE/ 方案/ ./ 最后/ ,/ 为了/ 说明/ 扩展/ CPK/ 方案/ 具有/ 基本/ 的/ 实用性/ ,/ 即/ 用户加密/ 密钥/ 的/ 抗/ 碰撞/ 性/ ,/ 本文/ 分析/ 了/ 加密/ 密钥/ 种子/ 矩阵/ 的/ 规模/ 对/ 该/ 碰撞/ 性/ 的/ 影响/ ./ 另一方面/ ,/ 本文/ 对比/ 了/ 目前/ 知名/ 的/ 3/ 个/ 同类/ 方案/ 和/ 新/ IBE/ 方案/ 的/ 3/ 个/ 重要/ 的/ 实用性/ 指标/ ,/ 即/ 安全性/ 证明/ 中/ 的/ 归约/ 程度/ 、/ 加解密/ 时间/ 复杂度/ 、/ 密文/ 长度/ ,/ 并/ 得出/ 新/ IBE/ 方案/ 在/ 以上/ 三点/ 上/ 具有/ 目前/ 最优/ 的/ 性能/ ,/ 因此/ 新/ IBE/ 方案/ 是/ 相对/ 较/ 实用/ 的/ ./ 目前/ ,/ 研究/ 在/ 标准/ 模型/ 下/ 基于/ DecisionalBDH/ 假设/ 具有/ 更/ “/ 紧/ ”/ 归约/ 的/ 可/ 证明/ 安全/ 的/ IBE/ 方案/ 仍然/ 是/ 一个/ 公开/ 的/ 问题/ [/ 7/ ]/ ./ 致谢/ 感谢/ 华中科技大学/ 计算机/ 学院/ 信息安全/ 实验室/ 的/ 郑明辉/ 博士/ 、/ 粟栗/ 博士/ 对/ 可/ 证明/ 安全性/ 理论/ 的/ 前期/ 指导/ 和/ 对/ 文章/ 有/ 价值/ 的/ 讨论/ !/ 

