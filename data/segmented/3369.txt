Page1/ 一种/ 面向/ 虚拟化/ 云/ 计算/ 平台/ 的/ 内存/ 优化/ 技术/ 李亚琼/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 宋莹/ 2/ )/ ,/ 3/ )/ 黄永兵/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 中国科学院/ 研究生院/ 北京/ 100049/ )/ 2/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 3/ )/ (/ 中国科学院/ 计算机系统/ 结构/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 虚拟化/ 技术/ 和/ 云/ 计算/ 平台/ 的/ 结合/ 带来/ 了/ 全新/ 的/ 资源整合/ 和/ 使用/ 模式/ ,/ 基于/ 虚拟化/ 技术/ 的/ 资源/ 按需分配/ 与/ 调度/ 可以/ 提高/ 云/ 平台/ 资源/ 的/ 利用率/ ,/ 提升/ 云/ 服务/ 的/ 服务质量/ ,/ 并/ 降低/ 云/ 用户/ 的/ 总体/ 拥有/ 成本/ ./ 但是/ ,/ 物理/ 服务器/ 的/ 资源/ 边界/ 限制/ 了/ 资源/ 的/ 全局/ 优化/ 能力/ ./ 文中/ 引入/ 了/ 一种/ 面向/ 虚拟化/ 云/ 平台/ 的/ 全局/ 内存/ 优化/ 框架/ —/ —/ —/ 通过/ 引入/ 由/ 逻辑/ 地址/ 空间/ 和/ 全局/ 扩展/ 地址/ 空间/ 构成/ 的/ 双层/ 地址/ 空间/ 映射/ 机制/ 来/ 构建/ 跨/ 物理/ 服务器资源/ 边界/ 的/ 高效/ 、/ 可靠/ 的/ 内存/ 资源/ 抽象/ ./ 同时/ ,/ 引入/ 一种/ 透明/ 的/ 页面/ 交换/ 机制/ 来/ 实现/ 对于/ 虚拟机/ 透明/ 的/ 空闲/ 页面/ 回收/ ,/ 达到/ 资源/ 流动/ 的/ 目的/ ./ 实验/ 结果表明/ ,/ 该/ 框架/ 能够/ 很/ 好/ 地/ 优化/ 云/ 平台/ 中/ 内存/ 资源配置/ ,/ 提升/ 整个/ 平台/ 的/ 资源/ 利用率/ ,/ 并/ 对/ 关键/ 任务/ 的/ 执行/ 有/ 显著/ 的/ 加速/ 作用/ ./ 关键词/ 云/ 计算/ ;/ 虚拟化/ ;/ 内存/ 优化/ ;/ 透明/ ;/ 内存/ 流动/ 1/ 引言/ 云/ 计算/ 的/ 兴起/ 正在/ 逐渐/ 地/ 改变/ 整个/ 计算机/ 产业界/ 和/ 学术界/ ,/ 这种/ 把/ 计算机/ 作为/ 一种/ 效能/ (/ utility/ )/ 工具/ 、/ 把/ 软件/ 作为/ 一种/ 服务/ 来/ 使用/ 计算机/ 的/ 方式/ 为/ 计算机软件/ 和/ 硬件/ 设计/ 都/ 带来/ 了/ 巨大/ 的/ 挑战/ ./ 在/ 软件/ 的/ 构建/ 和/ 分发/ 方式/ 上/ ,/ SOA/ (/ 面向/ 服务/ 的/ 软件结构/ )/ 和/ SaaS/ (/ 软件/ 即/ 服务/ )/ 正/ 越来越/ 多地/ 成为/ 云/ 计算/ 模式/ 下/ 的/ 软件/ 构建/ 和/ 分发/ 的/ 核心/ 方式/ ./ 而/ 对于/ 支撑/ 服务/ 运行/ 的/ 底层/ 计算/ 基础设施/ ,/ 挑战/ 主要/ 集中/ 在/ 两个/ 方面/ :/ 系统软件/ 和/ 硬件/ ./ 其中/ ,/ 自适应性/ 资源配置/ 是/ 系统软件/ 面临/ 的/ 最大/ 挑战/ ,/ 如何/ 分配资源/ 又/ 是/ 这个/ 挑战/ 的/ 最/ 核心/ 问题/ ./ 根据/ 峰值/ 负载/ 来/ 静态/ 分配资源/ ,/ 会/ 带来/ 资源/ 的/ 严重/ 浪费/ ./ 据统计/ ,/ 在/ 当前/ 的/ 数据中心/ 中/ ,/ CPU/ 资源/ 的/ 利用率/ 平均/ 在/ 5/ %/ ~/ 20/ %/ 之间/ ,/ 而/ 内存/ 资源/ 的/ 利用率/ 也/ 不/ 超过/ 60/ %/ [/ 1/ -/ 2/ ]/ ./ 很/ 明显/ ,/ 当前/ 的/ 资源分配/ 模式/ 具有/ 很/ 高/ 的/ 资源/ 浪费/ 度/ ,/ 增加/ 了/ 用户/ 的/ 总体/ 拥有/ 成本/ (/ TCO/ )/ ./ 而/ 以/ 平均/ 负载/ 为/ 基准/ 来/ 静态/ 分配资源/ 则/ 会/ 使得/ 在/ 峰值/ 负载/ 的/ 情况/ 下/ 服务质量/ 下降/ ,/ 并/ 最终/ 影响/ 云/ 用户/ 的/ 潜在/ 利润/ [/ 3/ ]/ ./ 虚拟化/ 技术/ [/ 4/ -/ 5/ ]/ 的/ 引入/ 带来/ 了/ 如下/ 几个/ 方面/ 的/ 好处/ :/ 更/ 细粒度/ 的/ 资源共享/ 、/ 安全/ 隔离/ 、/ 高可靠性/ 等/ ./ 通过/ 以/ 虚拟机/ (/ VM/ )/ 为/ 粒度/ 的/ 分时/ 复用技术/ ,/ 虚拟化/ 平台/ 可以/ 有效/ 地/ 进行/ 服务器/ 整合/ (/ serverconsolidation/ )/ 以/ 提升/ 资源/ 利用率/ ,/ 并/ 最终/ 提高/ 云/ 计算/ 基础设施/ 的/ 整体/ 资源/ 利用率/ ./ 但是/ ,/ 现在/ 的/ 虚拟化/ 技术/ 主要/ 关注/ 在/ 一台/ 物理/ 服务器/ 内/ 的/ 资源/ 优化/ ,/ 通过/ 资源/ 的/ 复用技术/ 来/ 提高/ 单台/ 服务器/ 的/ 资源/ 利用率/ ./ 而/ 对于/ 全局/ 资源/ 优化/ 来说/ ,/ 由于/ 缺乏/ 访问/ 远程/ 资源/ 的/ 虚拟化/ 支撑/ 技术/ ,/ 全局/ 优化/ 的/ 研究/ 更/ 多/ 地/ 从/ 操作系统/ 的/ 角度/ 进行/ 相关/ 研究/ ,/ 如/ 分布式/ 共享内存/ 系统/ (/ DSM/ )/ [/ 6/ -/ 7/ ]/ 以及/ 网络/ 内存/ [/ 8/ -/ 10/ ]/ 等/ ./ 这些/ 工作/ 都/ 需要/ 修改/ 操作系统/ 的/ 源代码/ 或/ 插入/ 对应/ 的/ 驱动/ 来/ 利用/ 远程/ 资源/ ,/ 对于/ 部署/ 多种/ 操作系统/ 平台/ 的/ 云/ 数据中心/ 来说/ 增加/ 了/ 部署/ 的/ 成本/ ./ 总的来说/ ,/ 利用/ 虚拟化/ 技术/ 来/ 构建/ 对/ 操作系统/ 透明/ 的/ 云/ 数据中心/ 面临/ 如下/ 两大/ 挑战/ :/ (/ 1/ )/ 如何/ 构建/ 更/ 有/ 弹性/ 的/ 、/ 可靠/ 的/ 全局/ 资源/ 空间/ ,/ 并/ 建立/ 资源/ 流动/ 框架/ ,/ 实现/ 跨越/ 物理/ 机/ 边界/ 的/ 资源/ 优化/ ;/ (/ 2/ )/ 如何/ 动态/ 地/ 识别/ 闲置/ 资源/ ,/ 为/ 资源/ 优化/ 提供/ 可以/ 流动/ 的/ 资源/ 空间/ ./ 针对/ 这/ 两个/ 问题/ ,/ 本文/ 引入/ 了/ 一个/ 基于/ 双层/ 地址/ 空间/ 映射/ 的/ 虚拟化/ 内存/ 优化/ 方案/ ,/ 通过/ 双层/ 地址/ 空间/ 映射/ 机制/ 提供/ 跨越/ 物理/ 服务器资源/ 边界/ 、/ 按/ 需/ 流动/ 的/ 内存/ 资源/ 抽象/ ,/ 同时/ 提供/ 高可靠性/ 保证/ ./ 由/ 逻辑/ 扩展/ 地址/ 空间/ 和/ 全局/ 扩展/ 地址/ 空间/ 构成/ 的/ 双层/ 空间/ 映射/ 可以/ 动态/ 地/ 收集/ 云/ 平台/ 内/ 的/ 空闲/ 内存/ 资源/ ,/ 并/ 通过/ 内存/ 资源/ 流动/ 技术/ 实现/ 跨/ 物理/ 服务器/ 的/ 内存/ 按/ 需/ 供应/ ./ 由于/ 内存/ 资源/ 具有/ 独占性/ 的/ 使用/ 特点/ ,/ 它/ 很/ 难/ 能够/ 像/ CPU/ 上下文/ 切换/ 和/ 磁盘控制器/ 的/ 调度/ 执行/ 那样/ 被/ 分时/ 复用/ ./ 并且/ 随着/ 多核/ 时代/ 的/ 来临/ ,/ 由于/ 能耗/ 的/ 限制/ ,/ 使得/ 每个/ 处理器/ 核/ 的/ 平均/ 内存空间/ 越来越/ 小/ ./ 在/ 内存/ 资源/ 的/ 优化/ 上/ ,/ 本文/ 尝试/ 通过/ 资源/ 流动/ 的/ 方式/ 来/ 优化/ 其/ 配置/ ,/ 提高/ 内存/ 利用率/ ./ 由于/ 半/ 虚拟化/ 情况/ 下/ ,/ 利用/ 气球/ 驱动/ (/ balloondriver/ )/ [/ 11/ -/ 12/ ]/ 能够/ 实现/ 对于/ 虚拟机/ 内存/ 的/ 调节/ [/ 13/ -/ 16/ ]/ ,/ 本文/ 主要/ 关注/ 全/ 虚拟化/ 场景/ 下/ 如何/ 实现/ 对/ 虚拟机/ 透明/ 地/ 进行/ 内存/ 优化/ 等/ 相关/ 技术/ 的/ 研究/ ./ 本文/ 的/ 主要/ 贡献/ 主要/ 有/ 三点/ :/ (/ 1/ )/ 针对/ 虚拟化/ 云/ 计算/ 平台/ 下/ 的/ 内存/ 优化/ 需要/ ,/ 本文/ 构建/ 了/ 一种/ 利用/ 虚拟化/ 技术/ 来/ 无缝/ 聚合/ 闲置/ 内存/ 资源/ 的/ 机制/ ;/ 通过/ 跨越/ 物理/ 平台/ 的/ 寻址/ 技术/ ,/ 实现/ 对于/ 远程/ 空闲/ 内存/ 资源/ 的/ 访问/ ;/ (/ 2/ )/ 在/ 虚拟化/ 云/ 计算/ 基础设施/ 之上/ ,/ 引入/ 了/ 一种/ 基于/ 逻辑/ 扩展/ 地址/ 空间/ 和/ 全局/ 扩展/ 地址/ 空间/ 的/ 双层/ 地址/ 空间/ 映射/ 机制/ ;/ 利用/ 该/ 机制/ ,/ 重构/ 了/ 虚拟化/ 云/ 平台/ 下/ 内存/ 层次结构/ ,/ 构建/ 了/ 基于/ 冗余/ 备份/ 机制/ 的/ 高可靠性/ 的/ 扩展/ 内存/ 区来/ 优化/ 内存/ 利用/ ;/ (/ 3/ )/ 通过/ 扩展/ 虚拟机/ 监控器/ ,/ 实现/ 了/ 一种/ 对/ 虚拟机/ 透明/ 的/ 闲置/ (/ 及/ 利用率/ 不高/ 的/ )/ 页面/ 回收/ 机制/ ,/ 该/ 机制/ 对于/ 不/ 适合/ 修改/ 操作系统/ 代码/ 而/ 进行/ 空闲/ 内存/ 回收/ 的/ 情形/ 具有/ 特别/ 的/ 意义/ ./ 本文/ 第/ 2/ 节/ 简要/ 介绍/ 与/ 本文/ 相关/ 的/ 研究/ 工作/ ,/ 并/ 分析/ 它们/ 与/ 我们/ 研究/ 工作/ 的/ 异同/ ;/ 第/ 3/ 节/ 重点/ 介绍/ 基于/ 双层/ 地址/ 空间/ 映射/ 机制/ 的/ 远程/ 空闲/ 内存/ 访问/ 机制/ ,/ 并/ 详细/ 介绍/ 其中/ 的/ 关键技术/ ;/ 第/ 4/ 节/ 介绍/ 基于/ Xen/ 虚拟机/ 监控器/ 的/ 实现/ 技术/ ;/ 第/ 5/ 节/ 给出/ 实验/ 平台/ 配置/ 和/ 初步/ 实验/ 结果/ ;/ 最后/ ,/ 对/ 全文/ 进行/ 总结/ 并/ 对/ 未来/ 工作/ 给出/ 展望/ ./ 2/ 相关/ 研究/ 工作/ 在/ 本节/ ,/ 我们/ 将/ 介绍/ 在/ 虚拟化/ 平台/ 下/ 的/ 内存/ 优化/ 的/ 相关/ 研究/ 工作/ ,/ 并/ 与/ 我们/ 的/ 工作/ 进行/ 对比/ ./ 2.1/ 虚拟化/ 内存/ 复用技术/ 虚拟化/ 平台/ 下/ 内存/ 复用/ (/ MemoryMultiplexing/ )/ 研究/ 主要/ 的/ 研究/ 方向/ 包括/ :/ (/ 1/ )/ 增加/ 内存/ 的/ 共享/ 度/ ,/ 提升/ 单位/ 页面/ 的/ 数据量/ ,/ 如/ 基于/ 内容/ 的/ 页面/ 共享/ 技术/ [/ 12/ ,/ 17/ ]/ 、/ 页面/ 压缩/ [/ 17/ ]/ 、/ 页面/ 补丁/ 技术/ [/ 17/ ]/ 等/ ;/ (/ 2/ )/ 通过/ Page3/ 释放/ 空闲/ 内存/ 资源/ 来/ 达到/ 资源/ 优化/ 部署/ 的/ 目的/ ,/ 包括/ 气球/ 驱动/ 技术/ [/ 11/ -/ 12/ ]/ 和/ 页面/ 交换/ (/ swap/ )/ 技术/ [/ 12/ ,/ 18/ ]/ ./ VMWareESXServer/ [/ 4/ ,/ 12/ ]/ 首先/ 引入/ 了/ 一种/ 基于/ 内容/ 的/ 页面/ 共享/ 机制/ —/ —/ —/ 通过/ 共享/ 同一/ 虚拟机/ 或/ 不同/ 虚拟机/ 间/ 存储/ 同样/ 内容/ 的/ 页面/ 来/ 达到/ 节约/ 内存/ 的/ 目的/ ./ 实验/ 表明/ ,/ 该/ 机制/ 大部分/ 情况/ 下/ 能够/ 回收/ 10/ %/ ~/ 15/ %/ 的/ 内存/ ./ 然而/ ,/ 这种/ 技术/ 的/ 最大化/ 效果/ 依赖于/ 虚拟机/ 的/ 配置/ 情况/ ,/ 只有/ 在/ 部署/ 同构/ 服务/ (/ 包括/ 操作系统/ 和/ 应用/ )/ 的/ 虚拟机/ 整合/ 到/ 同一个/ 物理/ 服务器/ 上时/ 才能/ 达到/ 节约/ 内存/ 的/ 最大/ 效果/ [/ 17/ ]/ ./ 为了/ 更加/ 充分/ 地/ 提高/ 页面/ 的/ 利用率/ ,/ 文献/ [/ 17/ ]/ 除了/ 利用/ 基于/ 内容/ 的/ 页/ 共享/ 技术/ 外/ ,/ 还/ 把/ 页面/ 压缩/ 和/ 页面/ 补丁/ 技术/ 引入/ 到/ Xen/ [/ 5/ ,/ 11/ ]/ 虚拟机/ 监控器/ 中/ ,/ 通过/ 复合/ 多种/ 技术/ 来/ 大幅度/ 地/ 提高/ 内存/ 资源/ 的/ 利用率/ ./ 文献/ [/ 14/ ]/ 和/ 文献/ [/ 15/ ]/ 则/ 采用/ 通过/ 在/ 虚拟机/ 监控器/ 层/ 构建/ 共享/ 的/ 磁盘/ Cache/ 系统/ 来/ 调节/ 内/ 存在/ 各个/ 虚拟机/ 之间/ 的/ 分配/ 和/ 流动/ ./ 文献/ [/ 15/ ]/ 和/ 文献/ [/ 16/ ]/ 研究/ 了/ 基于/ 缺页/ 率/ 曲线/ (/ missratecurve/ )/ 的/ 虚拟机/ 内存/ 实际/ 需求/ 大小/ 估计/ 方法/ ,/ 并/ 通过/ “/ 气球/ ”/ 机制/ 来/ 动态/ 调节/ 虚拟机/ 间/ 的/ 内存/ 分配/ ./ 上述/ 的/ 研究/ 工作/ 主要/ 关注/ 一台/ 物理/ 服务器/ 内/ 不同/ 的/ 虚拟机/ 之间/ 的/ 内存/ 分配/ 优化/ 问题/ ,/ 本文/ 的/ 研究/ 工作/ 定位/ 在/ 云/ 计算/ 平台/ 下多/ 机间/ 内存/ 优化/ 问题/ ,/ 重点/ 解决/ 虚拟化/ 场景/ 下/ 的/ 空闲/ 内存/ 页面/ 再/ 利用/ 问题/ ./ 2.2/ 多/ 机场/ 景下/ 的/ 内存/ 优化/ 多机/ 环境/ 下/ 的/ 内存/ 优化/ 技术/ 基本思路/ 就是/ 把/ 空闲/ 的/ 内存/ 资源/ 重新/ 利用/ ,/ 主要/ 技术/ 包括/ 分布式/ 共享内存/ (/ DSM/ )/ 技术/ ,/ 如/ IVY/ [/ 6/ ]/ 、/ JIAJIA/ [/ 7/ ]/ 、/ TreadMarks/ [/ 19/ ]/ 等/ 和/ 网络/ 内存/ 技术/ ,/ 如/ Anemone/ [/ 10/ ]/ 、/ Nswap/ [/ 9/ ]/ 等/ ./ DSM/ 系统/ 由于/ 要/ 维护/ 复杂/ 的/ 缓存/ 一致性/ 协议/ ,/ 使得/ 扩展性/ 差/ ,/ 最终/ 导致/ 开销/ 很大/ ./ 网络/ 内存/ 技术/ 则/ 提供/ 了/ 一种/ 粗粒度/ 的/ 内存/ 共享/ 机制/ ,/ 协议/ 简单/ ,/ 具有/ 很/ 好/ 的/ 可扩展性/ ,/ 是/ 典型/ 的/ 网络/ 内存/ 系统/ ./ 然而/ ,/ 传统/ 上/ 的/ 网络/ 内存/ 技术/ 需要/ 在/ 操作系统/ 中/ 插入/ 相应/ 的/ 驱动/ 来/ 访问/ 远程/ 内存/ 资源/ ,/ 资源/ 的/ 使用/ 方式/ 虽然/ 能够/ 对/ 应用程序/ 保持/ 透明/ ,/ 但/ 操作系统/ 往往/ 需要/ 修改/ 或/ 定制/ 才能/ 高效/ 地/ 使用/ 远程/ 内存/ ./ 在/ 虚拟化/ 场景/ 下/ ,/ 内存/ 管理机制/ 发生/ 了/ 改变/ ./ 由/ 操作系统/ 独占/ 内存/ 资源管理/ ,/ 演变成/ 了/ 由/ 虚拟机/ 监控器/ 和/ 虚拟机/ 内/ 操作系统/ 共同/ 控制/ 的/ 协作/ 机制/ ./ 其中/ ,/ 虚拟机/ 监控器/ 负责/ 内存/ 页面/ 的/ 分配/ ,/ 而/ 操作系统/ 负责/ 响应/ 应用/ 对/ 内存/ 的/ 请求/ 、/ 分配/ 页面/ 给/ 应用程序/ ./ 由于/ 虚拟机/ 创建/ 的/ 动态性/ 和/ 可/ 定制/ 性/ ,/ 基于/ 操作系统/ 的/ 远程/ 内存/ 技术/ 在/ 虚拟化/ 环境/ 下/ 缺乏/ 相应/ 的/ 弹性/ ./ 比如/ ,/ 当云/ 用户/ 的/ 操作系统/ 因为/ 不/ 开源/ 或/ 兼容性/ 原因/ 无法/ 插入/ 新/ 的/ 驱动/ 时/ ,/ 都/ 会/ 使得/ 传统/ 的/ 基于/ 操作系统/ 的/ 方式/ 无法/ 正常/ 工作/ ./ 文献/ [/ 18/ ]/ 的/ 工作/ 实现/ 了/ 在/ 一个/ 共享内存/ 的/ 多处理器/ 系统/ 中/ 的/ 内存/ 资源管理/ 系统/ ,/ 通过/ 页面/ 交换/ 和/ 请求/ 调页/ 机制/ 等/ 机制/ 来/ 优化/ 内存/ 的/ 使用/ ./ 与/ 这些/ 研究/ 工作/ 相比/ ,/ 我们/ 的/ 工作/ 主要/ 面向/ 商业/ 的/ cluster/ 机群系统/ ./ 由于/ 没有/ 直接/ 访问/ 远程/ 内存/ 的/ 硬件/ 支撑/ 机制/ ,/ 所以/ 最大/ 的/ 挑战/ 在于/ 访存/ 延迟/ 和/ 可靠性/ 挑战/ 以及/ 由于/ 虚拟化/ 平台/ 带来/ 的/ 特殊性/ 挑战/ ,/ 如/ Xen/ 虚拟机/ 监控器/ 中/ 的/ 网络协议/ 栈/ 问题/ ./ 3/ 系统结构/ 及/ 关键技术/ 在/ 我们/ 的/ 设计/ 中/ ,/ 系统/ 中/ 的/ 服务器/ 根据/ 其/ 内存/ 的/ 使用/ 情况/ 分为/ 内存/ 服务器/ 和/ 内存/ 客户端/ ,/ 其中/ ,/ 内存/ 服务器/ 向外/ 提供/ 基于/ 空闲/ 内存/ 的/ 存储/ 服务/ ,/ 而/ 内存/ 客户端/ 则/ 利用/ 远程/ 内存/ 调节/ 其/ 内部/ 内存/ 分配/ 以/ 加速/ 关键/ 应用/ ./ 整个/ 系统/ 的/ 示意图/ 如图/ 1/ 所示/ ./ 如图/ 1/ 所示/ ,/ 分布/ 在/ 各个/ 物理/ 平台/ 中/ 的/ 虚拟机/ (/ VM/ )/ 由于/ 其/ 负载/ 的/ 动态变化/ ,/ 其/ 内存/ 利用率/ 在/ 一定/ 的/ 时间/ 内会/ 随/ 负载/ 变化/ 产生/ 波动/ ./ 所以/ ,/ 每台/ 物理/ 服务器/ 内部/ 及/ 不同/ 物理/ 机/ 之间/ 内存/ 的/ 利用率/ 就/ 呈现/ 不/ 均衡性/ ,/ 并且/ 这种/ 不/ 均衡性/ 随/ 时间/ 而/ 动态变化/ ./ 这种/ 不/ 均衡性/ 使得/ 平台/ 上/ 的/ 应用/ 性能/ 受到/ 一定/ 的/ 限制/ ./ 因此/ ,/ 通过/ 一种/ 基于/ 双层/ 地址/ 空间/ 的/ 映射/ 机制/ ,/ 本文/ 引入/ 了/ 一种/ 分布式/ 空闲/ 内存/ 池来/ 调节/ 内/ 存在/ 各个/ 虚拟机/ 内/ 的/ 分配/ ./ 低/ 负载/ 压力/ 的/ 虚拟机/ 释放/ 空闲/ 内存/ 进入/ 空闲/ 内存/ 池/ ,/ 高/ 负载/ 压力/ 的/ 虚拟机/ 从/ 空闲/ Page4/ 内存/ 池中/ 申请/ 内存/ 来/ 降低/ 其/ 内存/ 压力/ ./ 下面/ ,/ 我们/ 首先/ 介绍/ 基于/ 双层/ 地址/ 空间/ 映射/ 机制/ 的/ 远程/ 空闲/ 内存/ 的/ 管理/ 和/ 访问/ 机制/ ,/ 随后/ 介绍/ 高效/ 高可靠性/ 访存/ 协议/ 以及/ 空闲/ 页面/ 回收/ 机制/ ./ 3.1/ 双层/ 地址/ 空间/ 构建/ 为了/ 能够/ 利用/ 分布/ 在/ 整个/ 平台/ 各个/ 物理/ 服务器/ 上/ 的/ 空闲/ 内存/ 资源/ ,/ 考虑/ 到/ 分布式/ 平台/ 的/ 特性/ ,/ 本文/ 引入/ 了/ 一个/ 由/ 双层/ 地址/ 空间/ 映射/ 构成/ 的/ 分布式/ 内存/ 池/ ./ 双层/ 地址/ 空间/ 的/ 构建/ 兼顾/ 了/ 效率/ 和/ 可靠性/ ,/ 提供/ 最大/ 程度/ 的/ 内存/ 资源/ 抽象/ ./ 图/ 2/ 给出/ 了/ 双层/ 地址/ 空间/ 构造/ 图/ ./ 双层/ 地址/ 空间/ 由/ 两个/ 逻辑/ 部分/ 和/ 一个/ 映射/ 组件/ 构成/ ./ 其中/ ,/ 全局/ 扩展/ 地址/ 空间/ 用于/ 管理/ 所有/ 映射/ 到/ 本地/ 扩展/ 地址/ 空间/ 的/ 远程/ 空闲/ 内存/ ,/ 逻辑/ 扩展/ 地址/ 空间/ 则/ 用于/ 扩展/ 本地/ 物理地址/ 空间/ ./ 最终/ ,/ 由/ 映射/ 组件/ 根据/ 一定/ 的/ 规则/ 完成/ 从/ 全局/ 扩展/ 地址/ 空间/ 到/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 映射/ ./ 全局/ 扩展/ 地址/ 空间/ 用来/ 管理/ 所有/ 被/ 本地/ 虚拟机/ 监控器/ 所/ 使用/ 的/ 远程/ 内存空间/ ,/ 由/ 〈/ 服务器/ ID/ ,/ 地址/ 段/ 〉/ 来/ 标示/ 其/ 地址/ 构成/ ./ 每个/ 远程/ 内存/ 服务器/ 可以/ 包含/ 多个/ 地址/ 段/ ,/ 这样/ 的/ 设计/ 可以/ 根据/ 空闲/ 内存/ 变化/ 动态/ 地/ 调整/ 可/ 共享/ 的/ 地址/ 空间/ ./ 为了/ 支持/ 远程/ 空间/ 的/ 退出/ ,/ 地址映射/ 组件/ 实现/ 了/ 数据/ 同步/ 方法/ 来/ 迁移/ 数据/ 、/ 保证数据/ 的/ 有效性/ ./ 远程/ 服务器/ 的/ 空闲/ 内存/ 通过/ 地址映射/ 组件/ 被/ 映射/ 到/ 逻辑/ 扩展/ 空间/ ,/ 通过/ 多个/ 服务器/ 空间/ 映射/ 到/ 一个/ 空间/ 的/ 方法/ 可以/ 实现/ 数据/ 的/ 冗余/ 存储/ ,/ 提高/ 远程/ 内存/ 的/ 可靠性/ ./ 系统/ 引入/ 如下/ 接口/ 来/ 操作/ 全局/ 扩展/ 地址/ 空间/ :/ (/ 1/ )/ Gsm/ _/ addr/ _/ space/ _/ add/ (/ server/ _/ id/ ,/ start/ _/ addr/ ,/ size/ )/ ./ 添加/ 一段/ 远程/ 内存/ 到/ 全局/ 扩展/ 地址/ 空间/ ,/ 返回/ 该/ 内存/ 段/ 在/ 地址/ 空间/ 中/ 的/ 起始/ 地址/ ./ (/ 2/ )/ Gsm/ _/ addr/ _/ space/ _/ del/ (/ server/ _/ id/ ,/ start/ _/ addr/ ,/ size/ )/ ./ 删除/ 一段/ 全局/ 地址/ 空间/ ./ (/ 3/ )/ Gsm/ _/ addr/ _/ space/ _/ map/ (/ start/ _/ addr/ ,/ size/ )/ ./ 影射/ 一段/ 全局/ 地址/ 空间/ 到/ 逻辑/ 扩展/ 地址/ 空间/ ,/ 返回/ 其/ 在/ 逻辑/ 扩展/ 地址/ 空间/ 中/ 的/ 起始/ 地址/ ./ (/ 4/ )/ Gsm/ _/ addr/ _/ space/ _/ unmap/ (/ start/ _/ addr/ ,/ size/ )/ ./ 释放/ 从/ 逻辑/ 扩展/ 地址/ 空间/ 中/ start/ _/ addr/ 开始/ size/ 大小/ 的/ 空间/ 映射/ ./ 逻辑/ 扩展/ 地址/ 空间/ 位于/ 虚拟机/ 监控器/ 中/ ,/ 由/ 一个/ 从零开始/ 的/ 独立/ 地址/ 空间/ 和/ 一个/ 标识/ 其/ 空间/ 的/ 全局/ 唯一/ 标识符/ 构成/ ./ 通过/ 〈/ 地址/ ,/ 标识符/ 〉/ 对来/ 对/ 空间/ 进行/ 寻址/ ,/ 并/ 在/ 地址映射/ 组件/ 的/ 翻译/ 下/ 最终/ 确定/ 要/ 访问/ 的/ 远程/ 内存/ 页面/ ./ 逻辑/ 扩展/ 地址/ 空间/ 的/ 申请/ 和/ 回收/ 都/ 是/ 由/ 虚拟机/ 监控器/ 来/ 控制/ ,/ 这样/ 可以/ 提供/ 更为/ 弹性/ 的/ 空间/ 使用/ 模式/ ,/ 比如/ 既/ 可以/ 用作/ RAMDisk/ ,/ 也/ 可以/ 用作/ Swap/ 设备/ ./ 地址映射/ 组件/ 地址映射/ 组件/ 的/ 核心/ 功能/ 是/ 提供/ 全局/ 扩展/ 地址/ 空间/ 和/ 逻辑/ 扩展/ 地址/ 空间/ 之间/ 的/ 双向/ 映射/ ,/ 通过/ 维护/ 相关/ 的/ 映射/ 关系/ 来/ 提供/ 高效/ 可靠/ 的/ 远程/ 内存/ 存储/ 抽象/ ./ 地址映射/ 组件/ 支持/ 两类/ 基本/ 的/ 数据/ 操作/ :/ 数据/ 存取/ 和/ 数据/ 同步/ ./ 其中/ ,/ 数据/ 存取/ 是/ 基本/ 的/ 远程/ 内存/ 操作/ ,/ 实现/ 对于/ 远程/ 数据/ 的/ 读取/ 和/ 写入/ ./ 数据/ 同步操作/ 为/ 远程/ 内存/ 服务/ 的/ 退出/ 提供/ 支持/ ,/ 通过/ 从/ 退出/ 服务器/ 到/ 其它/ 备份/ 服务器/ 同步/ 数据/ 可以/ 实现/ 数据/ 存储/ 的/ 高可靠性/ ./ 3.2/ 高效率/ 、/ 高可靠性/ 远程/ 内存/ 访问/ 远程/ 内存/ 系统/ 的/ 设计/ 需要/ 考虑/ 两个/ 方面/ 的/ 要求/ :/ (/ 1/ )/ 尽量/ 缩短/ 访存/ 延迟/ ,/ 提高效率/ ;/ (/ 2/ )/ 分布式系统/ 的/ 可靠性/ 问题/ ,/ 提供/ 可靠/ 稳定/ 的/ 基于/ 内存/ 的/ 存储/ 服务/ ./ 本文/ 充分考虑/ 了/ 这/ 两个/ 方面/ 的/ 要求/ ,/ 通过/ 全局/ 扩展/ 地址/ 空间/ 到/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 多/ 对/ 一/ 映射/ 机制/ 和/ 效率/ 优先/ 的/ 访存/ 协议/ 来/ 达到/ 高效/ 可靠/ 的/ 目的/ ./ 图/ 3/ 描绘/ 了/ 映射/ 过程/ 及/ 访存/ 的/ 路径/ :/ 如图所示/ ,/ 两个/ 内存/ 服务器/ 和/ 本地/ 磁盘/ 一起/ 构/ Page5/ 成/ 了/ 三个/ 不同/ 的/ 全局/ 扩展/ 地址/ 空间/ 地址/ 段/ ,/ 它们/ 被/ 映射/ 到/ 同/ 一段/ 逻辑/ 扩展/ 地址/ 空间/ 上/ ./ 当/ 系统/ 触发/ 对于/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 寻址/ 时/ ,/ 地址映射/ 组件/ 会/ 把/ 寻址/ 分别/ 发送到/ 三段/ 地址/ 段/ 上/ ,/ 并/ 最终/ 驱动/ 相关/ 的/ 服务器/ 完成/ 数据/ 读写操作/ ./ 下面/ 就/ 可靠性/ 、/ 高效性/ 及/ 对/ 服务器/ 退出/ 机制/ 的/ 支持/ 进行/ 详细/ 介绍/ :/ 可靠性/ 设计/ ./ 通过/ 从/ 全局/ 扩展/ 地址/ 空间/ 到/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 多/ 对/ 一/ 的/ 映射/ 来/ 达到/ 数据/ 冗余/ 、/ 提高/ 可靠性/ 的/ 目的/ ./ 高效性/ 设计/ ./ 高效性/ 的/ 保证/ 源自/ 基于/ 平均/ 延迟/ 优先级/ 的/ 访存/ 协议/ ./ 在/ 我们/ 的/ 设计/ 中/ ,/ 根据/ 服务器/ 平均/ 延迟/ 来/ 确定/ 的/ 远程/ 服务器/ 访问/ 优先级/ 可以/ 最大/ 程度/ 地/ 提高/ 系统/ 效率/ ./ 以/ 数据/ 读/ 操作/ 为例/ ,/ 读/ 操作/ 会/ 根据/ 平均/ 读/ 延迟/ 依次/ 发送给/ 远程/ 服务器/ ,/ 当/ 数据/ 返回/ 时/ 优先/ 处理/ 先/ 返回/ 的/ 数据/ ./ 在/ 数据传输/ 不/ 出错/ 的/ 前提/ 下/ ,/ 随后/ 到来/ 的/ 数据/ 都/ 会/ 被/ 丢弃/ ,/ 这样/ 可以/ 减少/ 因为/ 冗余/ 带来/ 的/ 数据处理/ 开销/ ,/ 提供/ 读取/ 效率/ ./ 服务器/ 退出/ 机制/ 支持/ ./ 当/ 一个/ 服务器/ 因为/ 自身/ 负载/ 增加/ 需要/ 收回/ 共享/ 的/ 内存/ 或者/ 服务器/ 无法/ 正常/ 提供/ 服务/ 时/ ,/ 系统/ 会/ 主动/ 或/ 被动/ 地/ 启动/ 数据/ 同步操作/ 来/ 迁移/ 数据备份/ 到/ 其它/ 内存/ 服务器/ 上/ ./ 数据/ 同步操作/ 会/ 逐页/ 地/ 复制/ 数据/ 到/ 新/ 的/ 服务器/ ,/ 同时/ 新/ 的/ 远程/ 服务器/ 开始/ 加入/ 全局/ 扩展/ 地址/ 空间/ 并/ 被/ 映射/ 到/ 同/ 一段/ 逻辑/ 扩展/ 地址/ 空间/ 上/ ./ 由于/ 数据/ 同步/ 过程/ 中/ 中间状态/ 的/ 出现/ ,/ 服务器端/ 页/ 数据/ 的/ 状态/ 被/ 分为/ 如下/ 3/ 种/ :/ 未/ 初始化/ 、/ 页面/ 脏/ 和/ 页面/ 空闲/ ./ 在/ 支持/ 的/ 两类/ 操作/ 数据/ 读写/ 和/ 数据/ 同步/ 的/ 驱动/ 下/ ,/ 其/ 状态/ 转化/ 关系/ 如图/ 4/ 所示/ ./ 3.3/ 空闲/ 内存/ 透明/ 回收/ 除了/ 未/ 被/ 分配/ 的/ 内存/ 或/ 虚拟机/ 主动/ 共享/ 的/ 内存/ 外/ ,/ 由于/ 数据/ 访问/ 模式/ 的/ 限制/ ,/ 虚拟机/ 内部/ 还有/ 部分/ 已经/ 分配/ 使用/ 但/ 访问/ 频率/ 极低/ 的/ 内存空间/ ./ 为了/ 最大/ 程度/ 地/ 增加/ 内存/ 的/ 共享/ 度/ ,/ 本文/ 引入/ 了/ 一种/ 对/ 虚拟机/ 透明/ 的/ 空闲/ 页面/ 回收/ 技术/ ./ 为了/ 实现/ 对于/ 页面/ 的/ 透明/ 回收/ ,/ 本文/ 扩展/ Xen/ 虚拟机/ 监控器/ 以/ 实现/ 基于/ 内存/ 页面/ 访问信息/ 的/ 动态/ “/ 偷取/ ”/ 运行/ 时/ 系统/ ./ 图/ 5/ 是/ 扩展/ 后/ 的/ Xen/ 结构图/ ./ 如图所示/ ,/ 本文/ 对/ Xen/ 的/ 扩展/ 主要/ 包括/ 两个/ 部分/ ,/ 分别/ 是/ 位于/ Xen/ 内核/ 中/ 的/ 核心/ 运行/ 时/ 系统/ 和/ 管理/ 虚拟机/ Domain/ -/ 0/ 中/ 的/ 支撑/ 模块/ 组/ ./ 下面/ 分/ 模块/ 介绍/ 各/ 部分/ 的/ 功能/ 以及/ 其/ 核心作用/ :/ (/ 1/ )/ 逻辑/ 扩展/ 地址/ 空间/ 模块/ (/ Xen/ )/ 逻辑/ 地址/ 空间/ 管理/ 模块/ ,/ 负责管理/ 逻辑/ 扩展/ 地址/ 空间/ ,/ 并/ 对外/ 提供/ 操作/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 接口/ 服务/ ,/ 比如/ 空间/ 申请/ 、/ 回收/ 、/ 删除/ 等/ 操作/ ./ (/ 2/ )/ SwapDomain/ 模块/ (/ Xen/ )/ SwapDomain/ 是/ 一个/ 位于/ Xen/ 中/ 的/ 特殊/ 虚拟机/ ,/ 是/ 一系列/ 资源/ 的/ 聚合/ ,/ 但/ 不/ 参与/ CPU/ 的/ 调度/ 执行/ ./ 在/ 本文/ 中/ ,/ 它/ 主要/ 的/ 功能/ 是/ 提供/ 一层/ 缓存/ 机制/ 来/ 减少/ 由于/ 访问/ 远程/ 内存/ 带来/ 的/ 开销/ ./ (/ 5/ )/ 异常/ 重播/ 机制/ (/ Xen/ )/ 支持/ 全/ 虚拟化/ 虚拟机/ 的/ 空闲/ 页面/ 回收/ ,/ 和/ 指令/ (/ 3/ )/ 页面/ 交换/ 引擎/ (/ Xen/ )/ 收回/ 空闲/ 页面/ 的/ 核心部件/ ./ 通过/ 监控/ 页面/ 访问信息/ 来/ 确定/ 空闲/ 页面/ ,/ 一旦/ 确定/ 了/ 要/ 收回/ 的/ 页面/ 后/ 就/ 可以/ 通过/ 页面/ 交换/ 引擎/ 来/ 存储/ 数据/ 到/ 磁盘/ 或/ 远程/ 内存/ 以及/ 更新/ 页表/ 等/ 操作/ ./ (/ 4/ )/ 指令/ 运行/ 回滚/ 运行/ 时/ (/ Xen/ )/ 支持/ 全/ 虚拟化/ 虚拟机/ 的/ 空闲/ 页面/ 回收/ ,/ 和/ 异常/ 重播/ 机制/ 配合/ 来/ 支持/ 对于/ 不/ 在/ 内存/ 中/ 的/ 页面/ 的/ 访问/ ./ 当/ Xen/ 访问/ 一个/ 被/ 换/ 出/ 的/ 页面/ 时/ ,/ 通常/ 发生/ 在/ Xen/ 模拟/ 特权/ 指令/ 执行/ 时/ ./ 这时/ ,/ 指令/ 的/ 模拟/ 过程/ 会/ 被/ 暂停/ ,/ 虚拟机/ 状态/ 被/ 回退/ 到/ 可以/ 安全/ 暂停/ 的/ 时刻/ ,/ 以/ 等待/ 页面/ 被/ 重新/ 装载/ 进/ 内存/ ./ Page6/ 运行/ 回滚/ 运行/ 时/ 系统/ 配合/ 来/ 支持/ 对于/ 不/ 在/ 本地/ 内存/ 中/ 的/ 页面/ 的/ 访问/ ./ 当/ 虚拟机/ 访问/ 的/ 页面/ 被/ 重新/ 装载/ 进/ 内存/ 后/ ,/ 异常/ 重播/ 机制/ 会/ 恢复/ 虚拟机/ 到/ 发生/ 访问/ 被/ 换/ 出/ 页面/ 之前/ 的/ 状态/ ,/ 并/ 调度/ 执行/ ./ (/ 6/ )/ 全局/ 扩展/ 地址/ 空间/ 管理/ 模块/ (/ Domain/ -/ 0/ )/ 负责管理/ 全局/ 扩展/ 地址/ 空间/ ,/ 提供/ 远程/ 空闲/ 内存/ 区间/ 的/ 注册/ 、/ 映射/ 、/ 同步/ 、/ 删除/ 等/ API/ 接口/ ./ 通过/ 从/ 逻辑/ 扩展/ 地址/ 空间/ 到/ 全局/ 扩展/ 地址/ 空间/ 的/ 一对/ 多/ 的/ 映射/ ,/ 可以/ 实现/ 数据/ 的/ 冗余/ 备份/ ,/ 提高/ 系统/ 的/ 可靠性/ ./ (/ 7/ )/ Swap/ 设备/ 驱动/ (/ Domain/ -/ 0/ )/ 提供/ 对/ 远程/ 空闲/ 内存地址/ 空间/ 和/ 本地/ 磁盘/ 的/ 访问/ 接口/ ./ (/ 8/ )/ Swap/ 守护/ 进程/ 集/ (/ Domain/ -/ 0/ )/ 处理/ 从/ Xen/ 空间/ 发送/ 过来/ 的/ 对/ 远程/ 内存空间/ 的/ 读写/ 请求/ ,/ 通过/ 驱动/ Swap/ 设备/ 来/ 访问/ 相关/ 的/ 存储空间/ ./ (/ 9/ )/ 基于/ 共享内存/ 的/ 消息/ 通道/ (/ Xen/ 和/ Domain/ -/ 0/ )/ 图/ 5/ 中/ 圆环/ 所/ 代表/ 的/ 是/ 一个/ 基于/ 共享内存/ 的/ 消息传递/ 通道/ ./ 共享/ 的/ 内存/ 来自/ 于/ SwapDomain/ 管理/ 的/ 内存空间/ ,/ 通过/ 虚拟机/ 间/ 页面/ 映射/ 机制/ 被/ 映射/ 到/ Domain/ -/ 0/ 的/ 地址/ 空间/ ./ Xen/ 对于/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 操作/ ,/ 如/ 读取/ 和/ 写入/ ,/ 都/ 以/ 消息传递/ 的/ 方式/ 通过/ 共享/ 空间/ 传递/ 给/ Domain/ -/ 0/ 中/ 的/ 组件/ 进行/ 地址/ 翻译/ 和/ 执行/ 具体操作/ ./ 3.4/ 冷/ 页面/ 判定/ 机制/ 与/ 算法/ 由于/ “/ 语义/ 鸿沟/ ”/ 的/ 存在/ ,/ 如何/ 确定/ 哪些/ 页面/ 是/ 空闲/ 页面/ 是/ 一项/ 重要/ 的/ 技术/ 挑战/ ./ 尝试/ 用/ 固定/ 的/ 算法/ 去/ 匹配/ 各种/ 操作系统/ 或/ 应用/ 的话/ ,/ 往往/ 会/ 产生/ 算法/ 之间/ 的/ 不/ 匹配/ ./ 一种/ 可/ 配置/ 的/ Under/ -/ Utilized/ 页面/ 确定/ 算法/ 选择/ 框架/ 被/ 引入/ 到/ 系统/ 中/ ./ 系统/ 可以/ 根据/ 不同/ 的/ 虚拟机/ 选择/ 不同/ 的/ Under/ -/ Utilized/ 内存/ 选择/ 算法/ ,/ 算法/ 选择/ 框架/ 接口/ 如下/ :/ get/ _/ swap/ _/ page/ ./ 核心/ 接口/ —/ —/ —/ 选择/ 需要/ 被/ 回收/ 的/ Under/ -/ Utilized/ 内存/ 页面/ ,/ 返回/ 页面/ 在/ Xen/ 中/ 的/ page/ _/ info/ 数据结构/ ;/ ack/ _/ swap/ _/ page/ ./ 页面/ 回收/ 成功/ 或/ 失败/ 时/ 调用/ ,/ 对/ 页面/ 状态/ 进行/ ack/ 确认/ ;/ add/ _/ swap/ _/ page/ ./ 把/ 一个/ 新/ 的/ 页面/ 加入/ 算法/ 管理/ 的/ 页面/ 集合/ 中/ ;/ mark/ _/ page/ _/ accessed/ ,/ mark/ _/ page/ _/ locality/ ./ 当/ 页面/ 被/ 访问/ 到/ 时/ 调用/ 前者/ ,/ 当/ 一个/ 页面/ 的/ “/ 附近/ ”/ 页面/ 被/ 访问/ 到/ 时/ 调用/ 后者/ ;/ get/ _/ prefetch/ _/ pfns/ ./ 得到/ 需要/ 被/ 预取/ 的/ 页面/ 的/ pfn/ (/ s/ )/ ;/ set/ _/ page/ _/ attr/ ./ 设置/ 页面/ 的/ 属性/ ,/ 比如/ 锁定/ (/ lock/ )/ 一个/ 页面/ 使得/ 不/ 能够/ 被/ 回收/ 时/ 调用/ ./ 本文/ 中/ ,/ 采用/ Multi/ -/ Queue/ [/ 18/ ]/ 算法/ 去/ 判定/ 虚拟机/ 内/ 的/ 冷/ 页面/ 集合/ 的/ 分布/ 和/ 大小/ ./ Multi/ -/ Queue/ 算法/ 能够/ 在/ 局部性/ 信息/ 缺失/ 的/ 情况/ 下/ 具有/ 很/ 好/ 的/ 性能/ ./ 4/ 实现/ 细节/ 本文/ 的/ 研究/ 工作/ 在/ Xen/ 平台/ 上/ 实现/ ,/ 基于/ Xen/ -/ 3.3/ ./ 1/ 系统/ 开发/ ./ Xen/ 虚拟机/ 监控器/ 原始/ 的/ 设计/ 通过/ 修改/ 操作系统/ 的/ 代码/ 来/ 完成/ 虚拟化/ 任务/ ,/ 通过/ 在/ 操作系统/ 内核/ 中/ 调用/ 超级/ 调用/ (/ Hypercall/ )/ 实现/ 对于/ 敏感/ 指令/ 的/ 模拟/ 执行/ ,/ 这种/ 虚拟化/ 方式/ 被称作/ 半/ 虚拟化/ (/ para/ -/ virtualization/ )/ ./ 在/ Intel/ 公司/ 的/ VT/ -/ x/ 和/ AMD/ 公司/ 的/ SVM/ 技术支持/ 下/ ,/ Xen/ 虚拟机/ 监控器/ 也/ 支持/ 不/ 修改/ 操作系统/ 源代码/ 的/ 全/ 虚拟化/ 方案/ ./ 我们/ 的/ 实现/ 对于/ 这/ 两种/ 情况/ 都/ 是/ 适用/ 的/ ./ 4.1/ Xen/ 扩展/ 我们/ 扩展/ 了/ Xen/ 虚拟机/ 监控器/ 来/ 完成/ 两个/ 核心/ 功能/ :/ (/ 1/ )/ 引入/ 了/ 逻辑/ 扩展/ 地址/ 空间/ 以/ 支持/ 远程/ 内存/ 访问/ ;/ (/ 2/ )/ 对/ 不/ 在/ 本地/ 内存/ 的/ 页面/ 提供/ 透明/ 寻址/ 支持/ ./ 为了/ 支持/ 逻辑/ 扩展/ 地址/ 空间/ ,/ 我们/ 修改/ 了/ Xen/ 虚拟机/ 监控器/ 中/ 从/ 虚假/ 物理地址/ 到/ 机器/ 地址/ 的/ 映射/ (/ p2m/ 机制/ )/ 部分/ ,/ 增加/ 了/ 新/ 的/ 地址/ 类型/ 来/ 标示/ 逻辑/ 扩展/ 地址/ 空间/ ./ 当/ 虚拟机/ 访问/ 逻辑/ 扩展/ 地址/ 空间/ 时/ ,/ 要么/ 会/ 触发/ 一次/ 缺页/ 异常/ ,/ 要么/ 触发/ 逻辑/ 扩展/ 地址/ 空间/ 寻址/ 机制/ ./ 通过/ 缺页/ 异常/ 处理/ 和/ 指令/ 运行/ 回滚/ 运行/ 时/ ,/ 虚拟机/ 被/ 暂停/ 执行/ 以/ 等待/ 页面/ 重新/ 被/ 装入/ 本地/ 内存/ ./ 当/ 页面/ 被/ 重新/ 装入/ 内存/ 时/ ,/ p2m/ 被/ 重新/ 设置/ 以/ 指向/ 新/ 装入/ 的/ 内存/ 页面/ ./ 如果/ 是/ 半/ 虚拟化/ 情况/ ,/ 缺页/ 异常/ 的/ 处理/ 流程/ 会/ 继续/ ./ 而/ 在/ 全/ 虚拟化/ 时/ ,/ 异常/ 重播/ 机制/ 将/ 发挥作用/ 以/ 重新/ 调度/ 虚拟机/ 执行/ ,/ 恢复/ 异常/ 的/ 处理过程/ ./ 指令/ 运行/ 回滚/ 运行/ 时/ 系统/ 截取/ 在/ 指令/ 模拟/ 执行/ 过程/ 中/ 对/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 访问/ ,/ 触发/ 逻辑/ 扩展/ 地址/ 空间/ 访问/ 异常/ 并/ 逐级/ 往/ 上层/ 函数/ 传递/ ,/ 直到/ 执行/ 逻辑/ 到达/ 虚拟机/ 陷入/ 到/ Xen/ 的/ 入口/ 点/ ./ 在/ 那里/ ,/ 虚拟机/ 被/ 暂停/ ,/ 对/ 逻辑/ 扩展/ 地址/ 空间/ 的/ 操作命令/ 通过/ 共享内存/ 空间/ 传递/ 给/ Domain/ -/ 0/ ./ 当/ 数据/ 返回/ 后/ ,/ 指令/ 模拟/ 操作/ 或/ 异常/ 处理/ 操作/ 被/ 继续执行/ ,/ 虚拟机/ 重新/ 被/ 调度/ ./ Page7/ 对/ 远程/ 内存/ 进行/ 读写/ 的/ 命令/ 通过/ Xen/ 和/ Domain/ -/ 0/ 之间/ 的/ 共享/ 缓冲区/ 由/ Xen/ 发出/ ,/ Domain/ -/ 0/ 中/ 的/ Swap/ 守护/ 进程/ 负责/ 具体/ 处理/ ./ 这样/ 做/ 的/ 原因/ 在于/ Xen/ 本身/ 缺乏/ 网络协议/ 栈/ ,/ 且/ 这样/ 的/ 设计/ 可以/ 很大/ 程度/ 地/ 提高/ 系统/ 弹性/ ./ 4.2/ Domain/ -/ 0/ 空间/ Domain/ -/ 0/ 作为/ Xen/ 架构/ 下/ 的/ 特殊/ 虚拟机/ ,/ 除了/ 提供/ 虚拟机/ 创建/ 、/ 查看/ 、/ 删除/ 等/ 控制/ 功能/ 外/ ,/ 其/ 本身/ 就/ 运行/ 着/ 一个/ 完整/ 的/ 操作系统/ ./ 因此/ ,/ 我们/ 充分利用/ Domain/ -/ 0/ 种/ 的/ 网络通信/ 、/ 磁盘/ 驱动/ 等/ 核心/ 功能/ 实现/ 对于/ 远程/ 内存/ 或/ 本地/ 磁盘/ 的/ 访问/ ,/ 并且/ 通过/ 模块/ 的/ 形式/ 构建/ 更/ 富有/ 弹性/ 的/ 地址/ 空间/ 映射/ 机制/ ./ 在/ Domain/ -/ 0/ 中/ ,/ 我们/ 实现/ 了/ 弹性/ 的/ 全局/ 扩展/ 地址/ 空间/ 管理机制/ ./ 其中/ ,/ 每/ 段/ 连续/ 的/ 地址/ 空间/ 由/ 一个/ 地址/ 空间/ 描述符/ 和/ 空间/ 范围/ 来/ 表示/ ,/ 每个/ 内存/ 服务器/ 可以/ 有/ 一个/ 或/ 多个/ 地址/ 空间/ 构成/ ./ 通过/ 映射/ 多个/ 地址/ 空间/ 到/ 同/ 一段/ 逻辑/ 扩展/ 地址/ 空间/ 上/ ,/ 可以/ 实现/ 数据/ 的/ 冗余/ 存储/ ./ 通过/ 模块/ 的/ 形式/ ,/ 我们/ 支持/ 两种/ 形式/ 的/ 外部/ 存储/ :/ 远程/ 空闲/ 内存/ 和/ 本地/ 磁盘/ ./ 把/ 本地/ 磁盘/ 和/ 远程/ 内存/ 的/ 叠加/ 映射/ ,/ 可以/ 获取/ 具有/ 高可靠性/ 、/ 高性能/ 的/ 附加/ 存储系统/ ./ 我们/ 通过/ mmap/ 的/ 方式/ 实现/ 基于/ 共享/ 页/ 的/ 、/ 与/ Xen/ 之间/ 的/ 信息/ 通信/ ,/ Xen/ 通过/ 共享/ 的/ 消息/ 通道/ 传递/ 请求/ 给/ Domain/ -/ 0/ ./ 在/ Domain/ -/ 0/ 中/ ,/ 守护/ 进程/ KXenSwap/ 内核/ 线程/ 被/ 创建/ 以/ 相应/ 从/ Xen/ 中/ 发出/ 的/ 控制/ 命令/ ,/ 如/ 远程/ 内存/ 的/ 读写操作/ ./ 当/ KXenSwap/ 通过/ 驱动/ 完成/ 了/ 相关/ 命令/ 后/ ,/ 一个/ 新/ 的/ Hypercall/ 被/ 调用/ 通知/ Xen/ 完成/ 后续/ 的/ p2m/ 表/ 修改/ 、/ 页表/ 更新/ 等/ 过程/ 以/ 恢复/ 虚拟机/ 的/ 调度/ 执行/ ./ 5/ 实验/ 分析/ 本文/ 从/ 两个/ 方面/ 来/ 验证/ 我们/ 的/ 工作/ :/ 可靠性/ 测试/ 和/ 性能/ 测试/ ./ 5.1/ 可靠性/ 测试/ 本/ 测试/ 用来/ 评估/ 基于/ 双层/ 地址/ 空间/ 映射/ 机制/ 的/ 可靠性/ 保障/ ./ 在/ 本次/ 测试/ 中/ ,/ 我们/ 通过/ 人为/ 的/ 关闭/ 提供/ 远程/ 内存/ 服务/ 的/ 服务器/ 来/ 测试/ 系统/ 的/ 可靠性/ ./ 我们/ 选用/ SPECWeb2005/ [/ 20/ ]/ 作为/ 我们/ 的/ 基准/ 测试程序/ ,/ 在/ 一台/ 配制/ AMDOpteron/ 四核/ 处理器/ (/ 2.0/ GHz/ )/ 、/ 8GB/ 内存/ 的/ 曙光/ 服务器/ 上/ 运行/ SPECWeb2005/ 基准/ 测试程序/ ,/ 使用/ 一台/ 同样/ 配置/ 的/ 物理/ 服务器/ 用作/ 远程/ 内存/ 服务器/ ./ 同时/ ,/ 我们/ 选用/ 了/ 多台/ 其它/ 服务器/ 作为/ SPECWeb/ 的/ 负载/ 产生器/ ,/ 服务器/ 的/ 数量/ 保证/ 客户端/ 不/ 成为/ 影响/ 系统/ 性能/ 的/ 瓶颈/ ./ 实验/ 1/ ./ 我们/ 创建/ 了/ 一个/ 配置/ 一个/ 虚拟机/ CPU/ 和/ 1024MB/ 内存/ 的/ 虚拟机/ 来/ 运行/ SPECWeb2005/ ,/ 内存/ 的/ 具体/ 配置/ 是/ 本地/ 896MB/ 加上/ 远程/ 128MB/ ./ 通过/ 运行/ 连续/ 9/ 轮/ 测试/ 来/ 评估/ 其/ 可靠性/ ,/ 在/ 进行/ 到/ 第/ 7/ 轮时/ ,/ 人为/ 地/ 关闭/ 用作/ 远程/ 内存/ 服务器/ 的/ 物理/ 机/ ./ 图/ 6/ (/ a/ )/ 是/ 实验/ 的/ 结果/ ,/ 从图/ 中/ 我们/ 可以/ 看到/ 第/ 7/ 轮/ 的/ 实验/ 由于/ 远程/ 服务器/ 的/ 关机/ 而/ 使得/ 实验/ 性能/ 大幅度/ 下降/ ,/ 第/ 8/ 、/ 9/ 轮/ 由于/ 虚拟机/ 崩溃/ 而/ 无法/ 继续/ ./ 实验/ 2/ ./ 这次/ 实验/ 我们/ 选择/ 两台/ 服务器/ 作为/ 空闲/ 内存/ 服务器/ ,/ 并且/ 两台/ 服务器/ 的/ 空闲/ 内存空间/ 被/ 映射/ 到/ 同/ 一段/ 逻辑/ 扩展/ 地址/ 空间/ 上/ ./ 同样/ 进行/ 了/ 9/ 轮/ 的/ 测试/ ,/ 结果/ 如图/ 6/ (/ b/ )/ 示/ ./ 同样/ 的/ ,/ 也/ 是/ 第/ 7/ 轮时/ 关闭/ 一台/ 内存/ 服务器/ ,/ 实验/ 结果表明/ ,/ 虚拟机/ 提供/ 的/ Web/ 服务/ 依然/ 可用/ 且/ 没有/ 出现/ 性能/ 下降/ ,/ 系统/ 仍然/ 继续/ 工作/ ,/ 顺利完成/ 9/ 轮/ 测试/ ./ 5.2/ 性能/ 测试/ 性能/ 测试/ 从/ 两个/ 方面/ 进行/ :/ 首先/ ,/ 我们/ 通过/ 实验/ 来/ 验证/ 释放/ 空闲/ 内存/ 对于/ 虚拟机/ 性能/ 带来/ 的/ 影响/ ;/ 其次/ ,/ 我们/ 测试/ 了/ 一种/ 利用/ 远程/ 内存/ 来/ 加速/ 虚拟机/ 的/ 场景/ ,/ 通过/ 具体/ 的/ 场景/ 验证/ 本文/ 工作/ 的/ 实际/ 效用/ ./ 5.2/ ./ 1/ 释放/ 空闲/ 内存/ 对于/ 虚拟机/ 性能/ 的/ 影响/ 在/ 这组/ 实验/ 中/ ,/ 我们/ 选择/ 了/ SPECWeb2005/ [/ 20/ ]/ Page8/ 和/ Linpack/ [/ 21/ ]/ 来/ 作为/ 基准/ 测试程序/ ./ 我们/ 的/ 实验/ 采用/ 两台/ 由/ AMD/ 的/ Opteron/ 四核/ 处理器/ (/ 2.0/ GHz/ )/ 、/ 8GB/ 内存/ 构成/ 的/ 曙光/ 服务器/ 来/ 构建/ 我们/ 的/ 试验/ 平台/ ,/ 其中/ ,/ 一台/ 用作/ 内存/ 服务器/ ,/ 一台/ 用作/ 内存/ 客户端/ ./ 同时/ ,/ 为了/ 驱动/ SPECWeb/ ,/ 我们/ 还/ 配置/ 了/ 多台/ 作为/ 该/ 基准/ 测试/ 需要/ 的/ 负载/ 发生器/ 的/ 机器/ ,/ 机器/ 的/ 数量/ 保证/ 了/ 这些/ 客户端/ 不/ 成为/ 影响/ 系统/ 性能/ 的/ 瓶颈/ 因素/ ./ (/ 1/ )/ Linpack/ 测试/ 我们/ 选择/ 了/ Linpack/ 作为/ 计算/ 密集型/ 应用/ ,/ 来/ 研究/ 通过/ 透明/ 方法/ 回收/ 其/ 空闲/ 内存/ 时/ 对/ 其/ 性能/ 的/ 影响/ ./ 在/ 这组/ 实验/ 中/ ,/ 我们/ 选择/ 了/ 一台/ 物理/ 服务器/ ,/ 在/ 该/ 平台/ 上/ 创建/ 一个/ 配置/ 两个/ 虚拟/ CPU/ 和/ 2GB/ 内存/ 的/ 虚拟机/ 来/ 进行/ Linpack/ 测试/ ./ 通过/ 不断/ 地/ 释放/ 其/ 空闲/ 内存/ ,/ 我们/ 来/ 观察/ 透明/ 释放/ 空闲/ 内存/ 对/ 计算/ 密集型/ 应用/ 的/ 影响/ ./ 如图/ 7/ 所示/ ,/ 我们/ 通过/ 不断/ 地/ 释放/ 虚拟机/ 的/ 空闲/ 内存/ 来/ 研究/ 释放/ 不同/ 大小/ 的/ 空闲/ 内存/ 对/ Linpack/ 性能/ 的/ 影响/ ./ 从/ 实验/ 结果/ 中/ ,/ 我们/ 可以/ 看到/ 在/ 0/ ~/ 1024MB/ 的/ 范围/ 内/ 不断/ 地/ 释放/ 空闲/ 的/ 内存/ 对/ Linpack/ 的/ 性能/ 影响/ 基本/ 可以/ 忽略不计/ ./ 图/ 7Linpack/ 基准/ 测试运行/ 时间/ (/ 越小越/ 好/ )/ (/ 2/ )/ SpecWeb/ 测试/ 在/ 这/ 一组/ 的/ 实验/ 中/ ,/ 我们/ 选择/ 了/ SpecWeb2005/ 作为/ 我们/ 这组/ 实验/ 的/ Benchmark/ ./ 一个/ 主要/ 的/ 原因/ 是/ 现在/ 的/ 云/ 计算/ 平台/ 越来越/ 多地/ 通过/ Web/ 的/ 形式/ 对外/ 提供/ 服务/ ,/ 通过/ 对/ Web/ 服务/ 的/ 验证/ 可以/ 更加/ 贴近/ 真实/ 的/ 场景/ ./ 在/ 这组/ 实验/ 中/ ,/ 我们/ 同样/ 在/ 一台/ 服务器/ 上/ 运行/ 了/ 一个/ 具有/ 两个/ 虚拟/ CPU/ 的/ 虚拟机/ ,/ 分别/ 观察/ 在/ 释放/ 一定量/ 的/ 内存/ 时/ 对/ Web/ 性能/ 的/ 影响/ 以及/ 在/ 一定/ 的/ 负载/ 压力/ 下/ 测试/ 释放/ 不同/ 大小/ 的/ 空闲/ 内存/ 对/ Web/ 性能/ 的/ 影响/ ./ 首先/ ,/ 我们/ 测试/ 了/ 释放/ 一定量/ 的/ 内存/ 时/ 性能/ 随/ 负载/ 的/ 变化/ 关系/ ./ 在/ 这组/ 实验/ 中/ ,/ 我们/ 研究/ 了/ 总/ 内存大小/ 为/ 1024MB/ 的/ 虚拟机/ 在/ 其/ 被/ 释放/ 了/ 128MB/ 的/ 空闲/ 内存/ 后/ 性能/ 随/ 负载/ 的/ 变化/ 情况/ ./ 测试/ 结果/ 如图/ 8/ 所示/ ./ 从/ 测试/ 结果/ 中/ 我们/ 可以/ 看出/ ,/ 在/ 负载/ 压力/ 不大/ 的/ 时候/ (/ 小于/ 每秒/ 200/ 个会话/ )/ ,/ 释放/ 128MB/ 的/ 空闲/ 内存/ 基本上/ 对/ 性能/ 没有/ 影响/ ./ 随着/ 每秒/ 会话数/ 的/ 增加/ ,/ 性能/ 曲线/ 开始/ 下降/ ,/ 但/ 释放/ 了/ 空闲/ 内存/ 的/ 虚拟机/ 和/ 没有/ 释放/ 的/ 情况/ 下/ 相比/ 性能/ 相差/ 依然/ 不大/ ./ 实验/ 结果/ 进一步/ 表明/ ,/ 在/ 释放/ 空闲/ 内存/ 的/ 时候/ 对/ 性能/ 带来/ 的/ 影响/ 基本上/ 可以/ 忽略不计/ ./ 图/ 8SpecWeb/ 随/ 请求/ 数/ 变化/ (/ 释放/ 128MB/ 时/ )/ 我们/ 又/ 测试/ 了/ 在/ 负载/ 压力/ 一定/ 的/ 情况/ 下/ 性能/ 随/ 释放/ 的/ 内存/ 数/ 的/ 变化/ 曲线/ ,/ 其/ 结果/ 如图/ 9/ 所示/ ./ 从图/ 中/ 我们/ 可以/ 看出/ ,/ 在/ 负载/ 压力/ 一定/ 的/ 情况/ 下/ ,/ 释放/ 的/ 内/ 存在/ 一定/ 的/ 大小/ 范围/ 内/ 对于/ 性能/ 基本上/ 没有/ 影响/ ./ 一旦/ 超过/ 某个/ 最大值/ 后/ ,/ 开始/ 降低/ 性能/ ./ 一般/ 情况/ 下该/ 最大值/ 是/ 比/ 系统/ 中/ 剩余/ 的/ 空闲/ 内存/ 稍/ 小/ 的/ 一个/ 值/ ,/ 对于/ 这个/ 值得/ 研究/ 超出/ 了/ 本文/ 的/ 研究/ 范围/ ,/ 不/ 在/ 这里/ 阐述/ ./ 总的来说/ ,/ 释放/ 空闲/ 内存/ 来/ 扩充/ 全局/ 扩展/ 地址/ 空间/ 对于/ 虚拟机/ 的/ 性能/ 影响/ 很小/ ,/ 在/ 大部分/ 的/ 情况/ 下/ 都/ 可以/ 忽略不计/ ./ 5.2/ ./ 2/ 利用/ 远程/ 空闲/ 内存/ 来/ 加速/ 应用/ 由于/ 远程/ 内存/ 的/ 访问/ 延迟/ 介于/ 本地/ 内存/ 和/ 本地/ 磁盘/ 之间/ [/ 9/ ]/ ,/ 所以/ ,/ 远程/ 内存/ 一般/ 用作/ 构建/ 介于/ 磁盘/ 和/ 本地/ 内存/ 之间/ 的/ 存储/ 层次/ ./ 本文/ 中/ ,/ 我们/ 利用/ 远程/ 内存/ 来/ 存储/ 内存/ 压力/ 比较/ 小/ 的/ 虚拟机/ 中/ 的/ 访问/ 频率/ 较/ 低/ 的/ 内存/ 中/ 的/ 数据/ ,/ 被/ 释放/ 的/ 内存/ 被/ 用来/ 加速/ 对/ Page9/ 内存/ 有/ 更/ 大/ 需求/ 的/ 虚拟机/ 上面/ 的/ 应用/ ./ 我们/ 的/ 实验/ 是/ 这样/ 安排/ 的/ :/ 在/ 一台/ 物理/ 服务器/ 上/ 创建/ 两个/ 虚拟机/ 分别/ 运行/ Linpack/ 和/ SpecWeb/ ,/ 其中/ Linpack/ 具有/ 较大/ 的/ 空闲/ 内存/ ,/ 而/ SpecWeb/ 需要/ 更/ 多/ 的/ 存储空间/ 来/ 加速/ 其/ 执行/ ;/ 另外/ 一台/ 物理/ 服务器/ 提供/ 远程/ 内存/ 服务/ ,/ 通过/ 双层/ 地址/ 空间/ 映射/ 被/ 运行/ Linpack/ 和/ SPECWeb/ 的/ 服务器/ 使用/ ./ 实验/ 结果/ 如图/ 10/ 所示/ ./ 其中/ ,/ 图/ 10/ (/ a/ )/ 是/ Linpack/ 释放/ 空闲/ 内存/ 后/ 其/ 性能/ 随/ 释放/ 内存大小/ 的/ 变化/ 关系/ ,/ 从图/ 中/ 我们/ 可以/ 看到/ ,/ 其/ 性能/ 的/ 变化/ 基本/ 可以/ 忽略不计/ ./ 图/ 10/ (/ b/ )/ 是/ 运行/ SpecWeb2005/ 的/ 虚拟机/ 在/ 不断/ 地/ 增加/ 其/ 内存/ 后/ 性能/ 的/ 变化/ 曲线/ ./ 实验/ 结果表明/ ,/ 利用/ 远程/ 内存/ 可以/ 为/ 高效/ 的/ 调解/ 内存/ 分配/ 提供/ 一种/ 更/ 有/ 弹性/ 的/ 方案/ ./ 6/ 总结/ 虚拟化/ 技术/ 和/ 云/ 计算/ 平台/ 的/ 结合/ 带来/ 了/ 全新/ 的/ 资源整合/ 和/ 使用/ 模式/ ,/ 资源/ 的/ 按需分配/ 和/ 动态/ 流动/ 对于/ 提高/ 云/ 平台/ 资源/ 的/ 利用率/ 、/ 提高/ 云/ 服务/ 的/ 服务质量/ 和/ 降低/ 云/ 用户/ 的/ 总体/ 拥有/ 成本/ 具有/ 十分/ 重要/ 的/ 意义/ ./ 但是/ ,/ 传统/ 的/ 虚拟化/ 技术/ 基本/ 局限/ 在/ 一台/ 物理/ 服务器/ 内部/ ,/ 缺乏/ 虚拟化/ 全局/ 资源/ 、/ 优化/ 全局/ 资源/ 部署/ 的/ 能力/ ./ 为了/ 解决/ 传统/ 虚拟化/ 技术/ 在/ 内存/ 全局/ 优化/ 上/ 的/ 问题/ ,/ 本文/ 引入/ 了/ 一种/ 面向/ 虚拟化/ 云/ 平台/ 的/ 全局/ 内存/ 优化/ 框架/ ,/ 通过/ 引入/ 双层/ 地址/ 空间/ 映射/ 机制/ 来/ 构建/ 跨越/ 物理/ 服务器资源/ 边界/ 的/ 内存/ 资源/ 抽象/ ./ 为了/ 能够/ 很/ 好/ 地/ 兼顾/ 效率/ 和/ 可靠性/ ,/ 本文/ 通过/ 释放/ 空闲/ 内存/ 和/ 使用/ 远程/ 内存/ 的/ 方式/ 来/ 达到/ 动态/ 调解/ 虚拟机/ 内存/ 分配/ 大小/ 的/ 目的/ ,/ 而/ 双层/ 地址/ 空间/ 及其/ 映射/ 机制/ 提供/ 可靠性/ 保证/ ./ 我们/ 的/ 实验/ 结果/ 进一步/ 证明/ 释放/ 空闲/ 内存空间/ 对/ 虚拟机/ 性能/ 的/ 影响/ 基本上/ 可以/ 忽略不计/ ,/ 同时/ 通过/ 把/ 远程/ 内存/ 作为/ 附加/ 的/ 存储/ 层次/ 的/ 方式/ 来/ 调解/ 内存/ 分配/ 可以/ 达到/ 最大/ 优化/ 内存/ 资源配置/ ,/ 并/ 提高/ 了/ 关键/ 应用/ 的/ 性能/ ./ 从/ 实验/ 结果/ 上/ 看/ ,/ 通过/ 基于/ 双层/ 地址/ 空间/ 的/ 调解机制/ ,/ 在/ 基本/ 不/ 影响/ 其它/ 虚拟机/ 性能/ 的/ 情况/ 下/ ,/ 能够/ 提高/ 关键/ 虚拟机/ 性能/ 高达/ 400/ %/ ./ 基于/ 本文/ 现在/ 的/ 工作/ ,/ 未来/ 的/ 研究/ 主要/ 集中/ 在/ 空间/ 映射/ 中/ 的/ 全局/ 优化/ 以及/ 探索/ 更加/ 有/ 成效/ 的/ 远程/ 内存/ 使用/ 方案/ ./ 

