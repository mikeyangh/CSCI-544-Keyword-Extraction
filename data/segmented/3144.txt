Page1/ 一种/ 基于/ 随机/ 游走/ 模型/ 的/ 多/ 标签/ 分类/ 算法/ 郑伟/ 王朝/ 坤/ 刘璋/ 王建民/ (/ 清华大学/ 软件/ 学院/ 北京/ 100084/ )/ (/ 清华/ 信息科学/ 与/ 技术/ 国家/ 实验室/ 北京/ 100084/ )/ (/ 信息系统/ 安全/ 教育部/ 重点/ 实验室/ 北京/ 100084/ )/ 摘要/ 在/ 数据挖掘/ 领域/ ,/ 传统/ 的/ 单/ 分类/ 和/ 多/ 分类/ 问题/ 已经/ 得到/ 了/ 广泛/ 的/ 研究/ ./ 但是/ 多/ 标签/ 数据/ 的/ 普遍存在/ 性/ 和/ 重要性/ 直到/ 近些年来/ 才/ 逐渐/ 得到/ 人们/ 的/ 关注/ ./ 在/ 多/ 标签/ 分类/ 问题/ 中/ ,/ 由于/ 标签/ 相关性/ 的/ 存在/ ,/ 传统/ 的/ 单/ 分类/ 和/ 多/ 分类/ 问题/ 的/ 解决/ 方法/ ,/ 无法/ 简单/ 地/ 应用/ 于/ 多/ 标签/ 分类/ 问题/ ./ 文中/ 提出/ 了/ 一种/ 基于/ 随机/ 游走/ 模型/ 的/ 多/ 标签/ 分类/ 算法/ ,/ 称为/ 多/ 标签/ 随机/ 游走/ 算法/ ./ 首先/ ,/ 将/ 多/ 标签/ 数据/ 映射/ 成为/ 多/ 标签/ 随机/ 游走/ 图/ ./ 当/ 输入/ 一个/ 未分类/ 数据/ 时/ ,/ 建立/ 一个多/ 标签/ 随机/ 游走/ 图/ 系列/ ./ 而后/ ,/ 对图/ 系列/ 中/ 的/ 每个/ 图/ 应用/ 随机/ 游走/ 模型/ ,/ 得到/ 遍历/ 每个/ 顶点/ 的/ 概率分布/ ,/ 并/ 将/ 这个/ 点/ 概率分布/ 转化成/ 每个/ 标签/ 的/ 概率分布/ ./ 最后/ ,/ 基于/ 多/ 标签/ 随机/ 游走/ 算法/ ,/ 文中/ 给出/ 了/ 一种/ 新/ 的/ 阈值/ 学习/ 算法/ ./ 真实/ 数据/ 集上/ 的/ 实验/ 表明/ ,/ 多/ 标签/ 随机/ 游走/ 算法/ 可以/ 有效/ 地/ 解决/ 多/ 标签/ 分类/ 问题/ ./ 关键词/ 多/ 标签/ ;/ 分类/ 算法/ ;/ 随机/ 游走/ ;/ 阈值/ 学习/ 1/ 引言/ 数据/ 分类/ (/ dataclassification/ )/ 是/ 数据挖掘/ (/ datamining/ )/ 的/ 一个/ 重要/ 研究/ 方向/ ./ 一直/ 以来/ ,/ 数据/ 分类/ 问题/ 和/ 方法/ 受到/ 了/ 人们/ 的/ 广泛/ 关注/ 和/ 研究/ ./ 传统/ 数据/ 分类/ 问题/ 的/ 研究/ 目标/ 是/ 如何/ 将/ 每条/ 数据/ 准确/ 地/ 划分/ 到/ 某/ 一类/ 中/ ./ 如果/ 候选/ 类别/ 只有/ 一个/ ,/ 则/ 分类/ 目标/ 转化/ 为/ 判断/ 未分类/ 数据/ 是否/ 属于/ 该/ 类别/ ,/ 这/ 类/ 问题/ 被称作/ 单/ 分类/ 问题/ (/ single/ -/ classclassification/ )/ 或二值/ 分类/ 问题/ (/ binaryclassifica/ -/ tion/ )/ ./ 如果/ 候选/ 类别/ 有/ 多个/ ,/ 在/ 传统/ 的/ 分类/ 问题/ 中/ ,/ 分类器/ 仅能/ 在/ 这些/ 候选/ 类别/ 中/ 选择/ 一个/ 作为/ 输出/ ,/ 这/ 类/ 问题/ 被称作/ 多/ 分类/ 问题/ (/ multi/ -/ classclassifica/ -/ tion/ )/ ./ 多/ 分类/ 问题/ 可以/ 比较/ 容易/ 地/ 转化成/ 单/ 分类/ 问题/ ./ 单/ 分类/ 问题/ 和/ 多/ 分类/ 问题/ 统称/ 为单/ 标签/ 分类/ 问题/ (/ single/ -/ labelclassification/ )/ ./ 它们/ 和/ 本文/ 研究/ 的/ 多/ 标签/ 分类/ (/ multi/ -/ labelclassification/ )/ 问题/ 有着/ 本质/ 的/ 区别/ [/ 1/ ]/ ./ 在/ 实际/ 应用/ 中/ ,/ 普遍存在/ 如下/ 情况/ :/ 一条/ 数据/ 可能/ 同时/ 属于/ 多个/ 不同/ 的/ 类别/ ./ 这类/ 数据/ 被称作/ 多/ 标签/ 数据/ ./ 例如/ ,/ Lewis/ 等/ 研究/ 了/ 路透社/ 的/ 804414/ 条/ 新闻/ ,/ 发现/ 平均/ 每条/ 新闻/ 同时/ 属于/ 2.6/ 个/ 不同/ 的/ 类别/ [/ 2/ ]/ ;/ 在/ ACMComputing/ 分类/ 体系/ 中/ ,/ 存在/ 着/ 一级/ 类别/ 11/ 个/ 、/ 二级/ 类别/ 81/ 个/ ,/ 而/ 作者/ 可以/ 为/ 每篇/ 文章/ 选择/ 多个/ 不同/ 的/ 类别/ [/ 3/ ]/ ;/ Snoek/ 等/ 人/ 通过/ 分析/ 43907/ 个/ 从/ 非洲/ 、/ 中国/ 和/ 美国/ 收集/ 的/ 音频/ 片段/ 以及/ 与/ 这些/ 音频/ 片段/ 相关/ 的/ 101/ 个/ 标签/ ,/ 发现/ 平均/ 每个/ 音频/ 片段/ 具有/ 4.4/ 个/ 不同/ 的/ 标签/ [/ 4/ ]/ ./ 这样/ 的/ 分类/ 问题/ 被称作/ 多/ 标签/ 分类/ 问题/ (/ 见/ 定义/ 1/ )/ ./ 和/ 传统/ 的/ 单/ 标签/ 分类/ 问题/ 相比/ ,/ 多/ 标签/ 分类/ 问题/ 存在/ 着/ 显著/ 的/ 区别/ ,/ 类别/ 间/ 的/ 相关性/ (/ relevance/ )/ 和/ 共/ 现性/ (/ co/ -/ occurrence/ )/ 直接/ 导致/ 传统/ 的/ 单/ 标签/ 分类/ 方法/ 不能/ 被/ 直接/ 应用/ 到/ 多/ 标签/ 分类/ 问题/ 中/ [/ 1/ ,/ 5/ ]/ ./ 多/ 标签/ 分类/ 问题/ 正/ 逐渐/ 成为/ 当前/ 的/ 一个/ 研究/ 热点/ ./ 多/ 标签/ 分类/ 问题/ 的/ 形式化/ 定义/ 如下/ 所示/ ./ 定义/ 1/ ./ 已知/ 一个/ 定义/ 在/ 实数/ 域/ R/ 上/ 的/ d/ 维/ 输入/ 数据/ 空间/ ,/ 记作/ X/ =/ Rd/ ;/ 一个/ 包含/ q/ 个/ 标签/ 的/ 标签/ 集合/ ,/ 记作/ Y/ =/ {/ λ/ 1/ ,/ λ/ 2/ ,/ …/ ,/ λ/ q/ }/ 和/ 一个/ 包含/ m/ 个/ 训练/ 数据/ 的/ 训练/ 集合/ ,/ 记作/ D/ =/ {/ (/ xi/ ,/ Yi/ )/ |/ 1/ / i/ / m/ ,/ xi/ ∈/ X/ ,/ Yi/ / Y/ }/ (/ 1/ )/ 其中/ xi/ 是/ 输入/ 空间/ X/ 中/ 的/ 一个/ 训练/ 数据/ ,/ Yi/ 是/ xi/ 的/ 真实/ 标签/ 集合/ (/ actuallabelset/ )/ ./ 多/ 标签/ 分类/ 问题/ 指/ :/ 根据/ 训练/ 数据/ D/ 学习/ 分类/ 函数/ f/ :/ X/ →/ 2Y/ ,/ 当/ 输入/ 一个/ 未分类/ 数据/ x/ ∈/ X/ 时/ ,/ 通过/ 函数/ f/ 得到/ x/ 的/ 预测/ 标签/ 集合/ Px/ / Y/ ,/ 使得/ Px/ 与/ x/ 的/ 真实/ 标签/ 集合/ Yx/ 最为/ 接近/ ./ 易知/ ,/ 单/ 标签/ 分类/ 问题/ 是/ 多/ 标签/ 分类/ 问题/ 的/ 一个/ 特例/ ./ 当/ 训练/ 和/ 测试数据/ 都/ 满足/ |/ Yi/ |/ =/ 1/ 时/ ,/ 多/ 标签/ 分类/ 问题/ 退化/ 成多/ 分类/ 问题/ ./ 特别/ 地/ ,/ 当/ q/ =/ 1/ 时/ ,/ 多/ 标签/ 分类/ 问题/ 退化/ 为单/ 分类/ 问题/ ./ 多/ 标签/ 排序/ 问题/ 是/ 与/ 多/ 标签/ 分类/ 问题/ 直接/ 相关/ 的/ 一类/ 问题/ ,/ 其/ 形式化/ 定义/ 如下/ ./ 定义/ 2/ ./ 已知/ 输入/ 空间/ X/ 、/ 标签/ 集合/ Y/ 和/ 训练/ 数据/ 集合/ D/ 如/ 定义/ 1/ 所示/ ./ 多/ 标签/ 排序/ 问题/ 指/ :/ 根据/ 训练/ 数据/ D/ 学习/ 函数/ g/ :/ X/ ×/ Y/ →/ R/ ,/ 当/ 输入/ 一个/ 未分类/ 数据/ x/ ∈/ X/ 时/ ,/ 对于/ 任意/ 的/ y/ ∈/ Y/ ,/ 得到/ 一个/ 置信/ 系数/ g/ (/ x/ ,/ y/ )/ ,/ 并/ 根据/ 该/ 置信/ 系数/ 对/ Y/ 中/ 的/ 所有/ 标签/ 进行/ 排序/ ,/ 使得/ 此/ 排序/ 结果/ 与/ 真实/ 结果/ 最为/ 接近/ ./ 不同/ 的/ 指标/ 被/ 用于/ 度量/ 分类/ 或/ 排序/ 结果/ 的/ 正确性/ ,/ 例如/ Precision/ // Recall/ // F/ -/ Measure/ 、/ Subsetaccu/ -/ racy/ 、/ HammingLoss/ 、/ One/ -/ Error/ 、/ RankingLoss/ 、/ Coverage/ 、/ AveragePrecision/ 等/ [/ 5/ ]/ (/ 见/ 5.1/ 节/ )/ ./ 多/ 标签/ 分类/ 问题/ 主要/ 有/ 两大类/ 解决/ 方法/ :/ 基于/ 问题/ 转化/ 的/ 方法/ 和/ 基于/ 算法/ 转化/ 的/ 方法/ [/ 5/ ]/ (/ 见/ 第/ 2/ 节/ )/ ./ 本文/ 提出/ 了/ 一种/ 基于/ 随机/ 游走/ 模型/ 的/ 多/ 标签/ 分类/ 算法/ MLRW/ (/ Amulti/ -/ labelclassificationalgorithmbasedontherandomwalkmodel/ )/ ./ 主要/ 贡献/ 有/ (/ 1/ )/ 提出/ 了/ 一种/ 新/ 的/ 多/ 标签/ 分类/ 算法/ MLRW/ ./ MLRW/ 在/ 预测/ 未分类/ 数据/ 时/ ,/ 除了/ 能够/ 给出/ 分类/ 结果/ ,/ 还/ 可以/ 结合/ 条件/ 概率模型/ ,/ 给出/ 该/ 数据/ 具有/ 每个/ 标签/ 的/ 概率分布/ ./ (/ 2/ )/ 基于/ MLRW/ 算法/ ,/ 提出/ 了/ 一种/ 分类/ 阈值/ 学习/ 方法/ ,/ 该/ 方法/ 可以/ 解决/ 多/ 标签/ 分类/ 算法/ 中/ 的/ 阈值/ 设置/ 问题/ ./ (/ 3/ )/ 真实/ 数据/ 集上/ 的/ 实验/ 结果表明/ ,/ MLRW/ 算法/ 和/ 分类/ 阈值/ 学习/ 方法/ 能/ 有效/ 解决/ 多/ 标签/ 分类/ 问题/ 和/ 多/ 标签/ 排序/ 问题/ ./ 本文/ 第/ 2/ 节/ 介绍/ 与/ 本文/ 有关/ 的/ 研究/ 工作/ ;/ 第/ 3/ 节/ 和/ 第/ 4/ 节/ 分别/ 给出/ MLRW/ 算法/ 和/ 阈值/ 学习/ 方法/ ;/ 第/ 5/ 节/ 给出/ MLRW/ 算法/ 的/ 相关/ 讨论/ ;/ 第/ 6/ 节/ 介绍/ 实验/ 方法/ 和/ 实验/ 结果/ ;/ 最后/ 总结/ 全文/ ./ 2/ 相关/ 工作/ 近年来/ ,/ 多/ 标签/ 分类/ 和/ 排序/ 问题/ 受到/ 了/ 人们/ 的/ 广泛/ 关注/ 和/ 研究/ ./ 其/ 解决/ 方法/ 主要/ 分为/ 基于/ 问题/ 转/ Page3/ 化/ 的/ 方法/ (/ ProblemTransformationbasedmeth/ -/ ods/ ,/ PT/ )/ 和/ 基于/ 算法/ 转化/ 的/ 方法/ (/ AlgorithmAdap/ -/ tationbasedmethods/ ,/ AA/ )/ ./ 2.1/ 基于/ 问题/ 转化/ 的/ 方法/ PT/ 类/ 方法/ 的/ 主要/ 目标/ 是/ 将/ 一个多/ 标签/ 分类/ 问题/ 转化成/ 一个/ 或/ 一组/ 单/ 标签/ 分类/ 问题/ ,/ 从而/ 运用/ 已有/ 的/ 单/ 标签/ 分类/ 方法/ 解决/ 该/ 问题/ ./ BR/ (/ BinaryRelevance/ )/ 是/ 一种/ 典型/ 的/ PT/ 方法/ ,/ 它/ 将/ 每个/ 标签/ 的/ 预测/ 看作/ 一个/ 独立/ 的/ 单/ 分类/ 问题/ ,/ 并/ 为/ 每个/ 标签/ 训练/ 一个/ 独立/ 的/ 分类器/ ,/ 用/ 全部/ 的/ 训练/ 数据/ 对/ 每个/ 分类器/ 进行/ 训练/ ./ 这种/ 算法/ 忽略/ 了/ 标签/ 之间/ 的/ 相互/ 关系/ ,/ 往往/ 无法/ 达到/ 令人满意/ 的/ 分类/ 效果/ ./ 文献/ [/ 6/ ]/ 通过/ 拷贝/ (/ copy/ )/ 和/ 带/ 权重/ 拷贝/ (/ copy/ -/ weight/ )/ 的/ 方法/ ,/ 对/ BR/ 进行/ 改进/ ,/ 将/ 原/ 训练/ 集合/ 中/ 的/ 一条/ 多/ 标签/ 数据/ 拆/ 分成/ 多条/ 单/ 标签/ 数据/ ,/ 并/ 给予/ 相应/ 的/ 权重/ ./ Hullermeier/ 等/ 提出/ 了/ 基于/ 标签/ 对比/ (/ pairwisecomparison/ )/ 的/ 分类/ 方法/ ./ 通过/ 对比/ 标签/ 集合/ 中/ 任意/ 两个/ 标签/ 之间/ 的/ 关系/ ,/ 建立/ q/ (/ q/ -/ 1/ )/ // 2/ 个/ 分类器/ ./ 每个/ 分类器/ 在/ 两个/ 标签/ λ/ i/ 和/ λ/ j/ 之间/ 投票/ ,/ 然后/ 组合/ 这些/ 投票/ 结果/ 作为/ 最终/ 的/ 多/ 标签/ 分类/ 结果/ [/ 7/ ]/ ./ 假设/ 多/ 标签/ 分类/ 算法/ 中/ 采用/ 的/ 基础/ 分类器/ (/ baseclassifier/ )/ 的/ 复杂度/ 为/ O/ (/ t/ (/ D/ )/ )/ ,/ 其中/ 函数/ t/ (/ D/ )/ 表示/ 分类器/ 在/ 训练/ 集合/ D/ 上/ 建立/ 分类/ 模型/ 的/ 复杂度/ ,/ 则/ 基于/ 标签/ 对比/ 的/ 多/ 标签/ 分类/ 算法/ 的/ 复杂度/ 为/ O/ (/ q/ (/ q/ -/ 1/ )/ // 2/ ·/ t/ (/ D/ )/ )/ ./ LP/ (/ LabelPowerset/ )/ 是/ 另外/ 一种/ 被/ 广泛/ 使用/ 的/ PT/ 方法/ ./ 它/ 将/ 训练/ 数据/ 中/ 的/ 每种/ 标签/ 组合/ 进行/ 二进制/ 编码/ ,/ 从而/ 形成/ 新/ 的/ 标签/ ./ 在/ LP/ 中/ ,/ 多/ 标签/ 数据/ 被/ 以/ 这种/ 方式/ 转化成/ 单/ 标签/ 数据/ ./ LP/ 算法/ 的/ 显著/ 缺点/ 是/ 不能/ 预测/ 新/ 的/ 标签/ 组合/ ./ Read/ 等/ 将/ 概率分布/ 模型/ 应用/ 到/ LP/ 中/ ,/ 当对/ 未分类/ 数据/ 进行/ 预测/ 时/ ,/ 可以/ 预测出/ 训练/ 集合/ 中未/ 出现/ 的/ 标签/ 组合/ [/ 8/ ]/ ./ 但是/ LP/ 算法/ 的/ 复杂度/ 较/ 高/ ,/ 达到/ O/ (/ min/ {/ 2q/ ,/ m/ }/ ·/ t/ (/ D/ )/ )/ ,/ 可以/ 通过/ 剪枝/ [/ 8/ ]/ 或/ 随机/ 标签/ 组合/ [/ 9/ ]/ 的/ 方法/ 在/ 一定/ 程度/ 上/ 降低/ 复杂度/ ,/ 但/ 降低/ 的/ 幅度/ 有限/ ./ 2.2/ 基于/ 算法/ 转化/ 的/ 方法/ AA/ 类/ 方法/ 的/ 主要/ 目标/ 是/ ,/ 通过/ 改变/ 已有/ 的/ 单/ 标签/ 分类/ 算法/ ,/ 使/ 其/ 能够/ 处理/ 多/ 标签/ 数据/ ./ 典型/ 的/ AA/ 算法/ 有/ 以下/ 几种/ :/ 基于/ 单/ 标签/ 分类/ 算法/ AdaBoost/ ./ M1/ ,/ Schapire/ 等/ 提出/ 了/ 适用/ 于/ 多/ 标签/ 数据/ 的/ AdaBoost/ ./ MH/ 算法/ [/ 10/ ]/ ,/ 该/ 算法/ 使用/ 每个/ 多/ 标签/ 训练/ 数据/ 生成/ q/ 个/ 新/ 的/ 单/ 标签/ 训练/ 数据/ ./ 该/ 算法/ 的/ 主要/ 缺点/ 是/ ,/ 显著/ 地/ 增加/ 了/ 训练/ 数据/ 的/ 数量/ ,/ 进而/ 增加/ 了/ 建模/ 时/ 的/ 消耗/ ./ 人工/ 神经元网络/ 也/ 可以/ 应用/ 到/ 多/ 标签/ 分类/ 问题/ 中/ ./ Zhang/ 等/ 人/ 通过/ 定义/ 针对/ 多/ 标签/ 数据/ 的/ 全局/ 优化/ 函数/ ,/ 使得/ 人工/ 神经元网络/ 能够/ 处理/ 多/ 标签/ 数据/ [/ 11/ ]/ ./ 该/ 算法/ 基本/ 思想/ 是/ ,/ 如果/ 很多/ 实例/ 同时/ 具备/ 两个/ 标签/ ,/ 那么/ 这/ 两个/ 标签/ 中/ 的/ 一个/ 出现/ 了/ ,/ 另外/ 一个/ 也/ 很/ 可能/ 同时/ 出现/ ./ 经典/ 的/ kNN/ 方法/ 也/ 可以/ 应用/ 到/ 多/ 标签/ 分类/ 问题/ 中/ ,/ 例如/ 文献/ [/ 12/ ]/ 中/ 介绍/ 的/ MLkNN/ 算法/ ./ MLkNN/ 通过/ 统计/ 方法/ ,/ 得出/ 每个/ 标签/ 的/ 先验概率/ ./ 当/ 输入/ 一个/ 未分类/ 数据/ x/ 时/ ,/ 对/ 标签/ 集合/ Y/ 中/ 的/ 每个/ 标签/ λ/ ,/ 分别/ 计算/ x/ 具有/ 标签/ λ/ 和/ 不/ 具有/ 标签/ λ/ 的/ 概率/ ,/ 进而/ 预测/ x/ 是否/ 具有/ 标签/ λ/ ./ C4/ ./ 5/ 决策树/ 也/ 可/ 应用/ 于/ 多/ 标签/ 分类/ 问题/ 中/ ,/ 只/ 需要/ 将/ 单/ 标签/ 分类/ 问题/ 中/ 熵/ 的/ 定义/ 扩展/ 到/ 多/ 标签/ 分类/ 问题/ ./ Clare/ 等/ 定义/ 多/ 标签/ 分类/ 问题/ 中/ 的/ 熵/ 为/ MLEntropy/ =/ ∑/ y/ ∈/ Y/ 而后/ 便/ 可以/ 基于/ 熵/ 计算/ 信息/ 增益/ ,/ 从而/ 对/ 多/ 标签/ 数据/ 建立/ 决策树/ [/ 13/ ]/ ./ 此外/ ,/ 经典/ 的/ Bayes/ 等/ 算法/ 也/ 可以/ 通过/ 修改/ 而/ 被/ 用于/ 多/ 标签/ 分类/ 问题/ 中/ ./ 此外/ ,/ 基于/ 已有/ 的/ 多/ 标签/ 分类/ 算法/ ,/ Tsoumakas/ 等/ 提出/ 了/ 二层/ 的/ 多/ 标签/ 分类/ 模型/ ,/ 第一层/ 中/ 采用/ BR/ 、/ 决策树/ 或/ SVM/ 等/ 进行/ k/ -/ fold/ 交叉/ 训练/ ;/ 在/ 第二层/ 中/ ,/ 采用/ BR/ 、/ SVM/ 等/ 算法/ ,/ 使用/ 第一层/ 训练/ 后/ 得到/ 的/ 各/ 标签/ 的/ 得分/ 或/ 概率分布/ 作为/ 输入/ ,/ 来/ 预测/ 最终/ 的/ 标签/ 输出/ 结果/ [/ 14/ ]/ ./ 2.3/ 随机/ 游走/ 模型/ 随机/ 游走/ 模型/ 的/ 基本/ 思想/ 是/ ,/ 从/ 一个/ 或/ 一系列/ 顶点/ 开始/ 遍历/ 一张/ 图/ ./ 在/ 任意/ 一个/ 顶点/ ,/ 遍历/ 者/ 将/ 以/ 概率/ 1/ -/ α/ 游走/ 到/ 这个/ 顶点/ 的/ 邻居/ 顶点/ ,/ 以/ 概率/ α/ 随机/ 跳跃/ (/ teleport/ )/ 到/ 图/ 中/ 的/ 任何/ 一个/ 顶点/ ,/ 称/ α/ 为/ 跳转/ 发生/ 概率/ ./ 每次/ 游走/ 后/ 得出/ 一个/ 概率分布/ ,/ 该/ 概率分布/ 刻画/ 了/ 图/ 中/ 每/ 一个/ 顶点/ 被/ 访问/ 到/ 的/ 概率/ ./ 用/ 这个/ 概率分布/ 作为/ 下/ 一次/ 游走/ 的/ 输入/ 并/ 反复/ 迭代/ 这一/ 过程/ ./ 当/ 满足/ 一定/ 前提条件/ 时/ ,/ 这个/ 概率分布/ 会/ 趋于/ 收敛/ ./ 收敛/ 后/ ,/ 即/ 可以/ 得到/ 一个/ 稳定/ 的/ 概率分布/ ./ 随机/ 游走/ 模型/ 广泛应用/ 于/ 数据挖掘/ 和/ 互联网/ 领域/ ,/ PageRank/ 算法/ 可以/ 看作/ 是/ 随机/ 游走/ 模型/ 的/ 一个/ 实例/ [/ 15/ ]/ ./ Zhang/ 等/ 人/ 使用/ 该/ 模型/ 从/ 书评/ 中/ 挖掘/ 关键词/ [/ 16/ ]/ ;/ Zhu/ 等/ 人/ 提出/ 了/ 有/ 吸收/ 状态/ 的/ 随机/ 游走/ 模型/ ,/ 该/ 模型/ 可以/ 用于/ 文本/ 自动/ 摘要/ (/ textsummariza/ -/ tion/ )/ 和/ 基于/ 社会/ 网络/ 的/ 分析/ 与/ 挖掘/ [/ 17/ ]/ ./ 本文/ 使用/ 收/ Page4/ 敛/ 后/ 的/ 概率分布/ 来/ 刻画/ 未分类/ 数据/ 具有/ 每个/ 标签/ 的/ 概率/ ./ 3MLRW/ 和/ 阈值/ 学习/ 算法/ 3.1/ 随机/ 游走/ 图/ 的/ 生成/ MLRW/ 算法/ 首先/ 将/ 训练/ 集合/ D/ 映射/ 成/ d/ 维度/ 空间/ 中/ 的/ 多/ 标签/ 随机/ 游走/ 图/ ./ 我们/ 使用/ 随机/ 游走/ 模型/ 的/ 原因/ 是/ :/ 该/ 模型/ 通过/ 点/ 与/ 点/ 之间/ 的/ 连通性/ 准确/ 地/ 刻画/ 训练/ 数据/ 之间/ 的/ 相关性/ ,/ 进而/ 刻画/ 候选/ 标签/ 之间/ 的/ 相关性/ ./ MLRW/ 的/ 基本思路/ 是/ :/ 将/ 集合/ D/ 中/ 的/ 每个/ 训练/ 数据/ x/ ∈/ X/ 映射/ 为/ 图/ 中/ 的/ 一个点/ v/ ./ 如果/ 两个/ 训练/ 数据/ xi/ 、/ xj/ 具有/ 相同/ 的/ 标签/ ,/ 则/ 将/ 这/ 两个/ 训练/ 数据/ 对应/ 的/ 顶点/ vi/ 、/ vj/ 相连/ ./ 形式化/ 地/ ,/ 已知/ 训练/ 集合/ D/ 如式/ (/ 1/ )/ 所示/ ,/ 则/ 由/ 训练/ 集合/ D/ 导出/ 的/ 多/ 标签/ 随机/ 游走/ 图记/ 作/ :/ E/ =/ {/ (/ vi/ ,/ vj/ )/ |/ vi/ ,/ vj/ ∈/ V/ ,/ Yi/ ∩/ Yj/ ≠/ / ,/ i/ ≠/ j/ }/ (/ 4/ )/ 如/ 无/ 特别/ 说明/ ,/ 本文/ 余下/ 部分/ 使用/ vi/ 表示/ 训练/ 数据/ xi/ 在/ 随机/ 游走/ 图上/ 对应/ 的/ 顶点/ ./ 例如/ ,/ 式/ (/ 3/ )/ 表示/ 每个/ 训练/ 数据/ xi/ 将/ 对应/ 图/ G/ 中/ 的/ 一个/ 顶点/ vi/ ,/ 这些/ 顶点/ 构成/ 了/ 图/ G/ 的/ 顶点/ 集合/ V/ ./ 接下来/ ,/ 我们/ 计算/ 随机/ 游走/ 图/ G/ 上/ 的/ 权重/ 矩阵/ 犠/ ./ 如式/ (/ 5/ )/ ,/ 边/ 的/ 权值/ 即/ 为/ 训练/ 数据/ 对应/ 顶点/ 在/ d/ 维空间/ 中/ 的/ 距离/ ,/ 记作/ dis/ (/ vi/ ,/ vj/ )/ ./ 本文/ 采用/ 欧式/ 距离/ 作为/ 距离/ 函数/ ./ Wij/ =/ 不失/ 一般性/ ,/ 可以/ 假定/ 图/ G/ 是/ 连通/ 的/ ./ 如果/ G/ 中/ 存在/ 不/ 连通/ 的/ 子/ 图/ ,/ 则/ 说明/ 标签/ 集合/ Y/ 中/ 存在/ 相互/ 独立/ 的/ 标签/ 子集/ ,/ G/ 中/ 的/ 每个/ 连通/ 分量/ 对应/ Y/ 中/ 的/ 一个/ 独立/ 子集/ ./ 此时/ ,/ 我们/ 可以/ 根据/ G/ 中/ 的/ 连通/ 分量/ ,/ 将/ 标签/ 集合/ Y/ 拆/ 分成/ 多个/ 互不/ 相交/ 的/ 子集/ ,/ 并/ 对/ 每个/ 子集/ 分别/ 应用/ MLRW/ 算法/ ./ 因此/ ,/ 本文/ 后面/ 的/ 内容/ 都/ 将/ 基于/ 图/ G/ 是/ 连通/ 图/ 这/ 一/ 前提/ 展开/ ./ 例如/ ,/ 给定/ 一个/ 标签/ 集合/ Y/ =/ {/ λ/ 1/ ,/ λ/ 2/ }/ ,/ 训练/ 集合/ 中/ 包含/ 6/ 条/ 数据/ (/ 如表/ 1/ )/ ,/ 训练/ 数据/ x1/ ,/ x2/ ,/ x3/ 有/ 相同/ 的/ 标签/ λ/ 1/ ,/ 则/ 将/ 这/ 3/ 个点/ 两/ 两/ 相连/ ,/ 连接/ 它们/ 的/ 边/ 的/ 权重/ 即/ 为/ 这/ 3/ 个/ 数据/ 的/ 特征向量/ 在/ 输入/ 空间/ 中/ 的/ 欧式/ 距离/ ./ 同理/ ,/ x3/ ,/ x4/ ,/ x5/ ,/ x6/ 同时/ 具有/ 标签/ λ/ 2/ ,/ 把/ 它们/ 两/ 两/ 相连/ ,/ 则/ 由/ 训练/ 集合/ D/ 导出/ 的/ 随机/ 游走/ 图如图/ 1/ 所示/ ./ 123456/ 可以/ 看出/ ,/ 随机/ 游走/ 模型/ 无法/ 直接/ 应用/ 于/ 传统/ 的/ 单/ 标签/ 分类/ 问题/ ./ 如果/ 将/ 单/ 标签/ 数据/ 映射/ 为/ 随机/ 游走/ 图/ ,/ 得到/ 的/ 将/ 会/ 是/ 不/ 连通/ 图/ ,/ 这/ 不/ 满足/ 随机/ 游走/ 算法/ 的/ 收敛/ 条件/ (/ 见/ 定理/ 1/ )/ ./ 然而/ ,/ 将/ 多/ 标签/ 数据/ 映射/ 为/ 随机/ 游走/ 图时/ ,/ 满足/ 随机/ 游走/ 模型/ 的/ 收敛/ 条件/ ,/ 因而/ 得以/ 应用/ ./ 3.2/ 多/ 标签/ 随机/ 游走/ 过程/ 3.2/ ./ 1/ 随机/ 游走/ 过程/ 随机/ 游走/ 过程/ 需要/ 4/ 个/ 输入/ 参数/ :/ 邻接矩阵/ 犘/ (/ adjacentmatrix/ )/ ,/ 初始/ 概率分布/ 向量/ 狊/ 0/ ,/ 跳转/ 发生/ 概率/ α/ (/ teleportingprobability/ )/ ,/ 发生/ 跳转/ 时/ 跳转/ 到/ 图/ 中/ 每个/ 顶点/ 的/ 概率分布/ 向量/ 犱/ ./ 每次/ 游走/ 过程/ 后/ 的/ 输出/ 概率分布/ 向量/ 记/ 作/ 狊/ ,/ 则/ 狊/ 的/ 计算/ 法/ 方法/ 为/ 将/ 向量/ 狊/ 作为/ 式/ (/ 6/ )/ 的/ 输入/ 狊/ 0/ ,/ 反复/ 迭代/ 式/ (/ 6/ )/ 直至/ 收敛/ ,/ 将/ 此时/ 的/ 概率分布/ 向量/ 记/ 作/ π/ ,/ 满足/ 式/ (/ 7/ )/ 中/ 的/ 向量/ π/ 即/ 为/ 稳定/ 的/ 概率分布/ 向量/ ./ 为了/ 应用/ 式/ (/ 6/ )/ ,/ 首先/ 基于/ 权重/ 矩阵/ 犠/ 计算/ 邻接矩阵/ 犘/ ./ 基本/ 思想/ 是/ ,/ 对/ 任意/ 顶点/ v/ ,/ 在/ v/ 的/ 所有/ 邻居/ 顶点/ 中/ ,/ 如果/ 一个/ 顶点/ 距离/ v/ 越远/ ,/ 则/ 游走/ 到/ 这个/ 顶点/ 的/ 概率/ 就/ 越/ 低/ ,/ 如式/ (/ 8/ )/ 所示/ ./ Mij/ =/ 对/ 矩阵/ 犕/ 进行/ 归一化/ 处理/ :/ 此时/ 的/ 概率分布/ 矩阵/ 犘/ 即/ 为/ 算法/ 输入/ 的/ 邻接矩阵/ ./ Page53/ ./ 2.2/ 多/ 标签/ 随机/ 游走/ 图/ 系列/ 当/ 输入/ 一个/ 未分类/ 数据/ x/ 时/ ,/ 将/ x/ 对应/ 的/ 顶点/ 记作/ u/ ,/ MLRW/ 将/ 以/ u/ 作为/ 起始/ 点/ 应用/ q/ 次/ 随机/ 游走/ 模型/ ./ 具体/ 地/ ,/ 在/ 第/ k/ 次/ 应用/ 随机/ 游走/ 模型/ 时/ ,/ 将/ u/ 与/ 所有/ 具有/ 标签/ λ/ k/ 的/ 点/ 相连/ 得到/ 多/ 标签/ 随机/ 游走/ 图/ Gk/ ./ 我们/ 将/ 这些/ 图/ 的/ 集合/ {/ Gk/ }/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ q/ )/ 定义/ 为/ 多/ 标签/ 随机/ 游走/ 图/ 系列/ (/ 如图/ 2/ 所示/ )/ ./ 图/ 2/ 输入/ 未分类/ 数据/ x/ 时/ (/ 将/ x/ 对应/ 的/ 点/ 记作/ u/ )/ :/ (/ a/ )/ 将/ u/ 与/ 具有/ 标签/ λ/ 1/ 的/ 点/ (/ v1/ ,/ v2/ ,/ v3/ )/ 相连/ ,/ 得到/ 图/ G1/ ;/ (/ b/ )/ 将/ u/ 与/ 具有/ 标签/ λ/ 2/ 的/ 点/ (/ v3/ ,/ v4/ ,/ v5/ ,/ v6/ )/ 相连/ ,/ 得到/ 图/ G2/ 定义/ 3/ ./ 已知/ 多/ 标签/ 随机/ 游走/ 图/ G/ 、/ 标签/ 集合/ Y/ 和/ 一个/ 未分类/ 数据/ x/ ,/ 则/ 定义/ 由/ G/ 和/ x/ 导出/ 的/ 多/ 标签/ 随机/ 游走/ 图/ 系列/ 为/ T/ =/ {/ Gk/ |/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ q/ }/ ,/ 其中/ 其中/ ,/ u/ 是/ 未分类/ 数据/ x/ 对应/ 的/ 顶点/ ,/ vi/ 是/ 训练/ 数据/ xi/ 对应/ 的/ 顶点/ ,/ Yi/ 是/ xi/ 的/ 真实/ 标签/ 集合/ ./ 接下来/ ,/ 我们/ 对/ T/ 中/ 的/ 每个/ 图以/ u/ 为/ 起点/ 应用/ 本文/ 3.2/ ./ 1/ 节所/ 描述/ 的/ 随机/ 游走/ 过程/ ./ 此时/ ,/ 我们/ 还/ 需要/ 计算/ 初始/ 向量/ 狊/ 0/ ./ 首先/ 计算/ 狊/ 0/ ,/ 狊/ 0/ 是/ 一个/ m/ 维/ 向量/ ,/ 它/ 的/ 第/ i/ 个/ 元素/ 为/ 对/ 狊/ 0/ 使用/ 类似/ 于式/ (/ 8/ )/ ~/ (/ 10/ )/ 的/ 方法/ 进行/ 归一化/ ,/ 即/ 得到/ 初始/ 向量/ 狊/ 0/ ./ 在/ 本文/ 中/ ,/ 我们/ 假设/ 从/ 某个/ 顶点/ 出发/ 跳转/ 到/ 图/ 中/ 任意/ 一个/ 顶点/ 的/ 概率/ 是/ 相等/ 的/ ,/ 得到/ 随机/ 跳转/ 到/ 每个/ 顶点/ 的/ 概率分布/ 向量/ :/ 此外/ ,/ 我们/ 还/ 得知/ α/ 的/ 一般/ 取值/ 为/ 0.15/ [/ 16/ ]/ ,/ 本文/ 的/ 实验/ 部分/ 将/ 对/ α/ 取值/ 对/ 结果/ 的/ 影响/ 进行/ 讨论/ ./ 至此/ ,/ 我们/ 已经/ 得到/ 了/ 随机/ 游走/ 过程/ 所/ 需/ 的/ 所有/ 输入/ ,/ 将/ 它们/ 代入/ 式/ (/ 6/ )/ 中/ ,/ 可以/ 得到/ 概率分布/ 向量/ 狊/ ,/ 通过/ 反复/ 迭代/ 式/ (/ 6/ )/ 直至/ 收敛/ ,/ 可/ 得出/ 最终/ 的/ 概率分布/ 向量/ π/ ./ π/ 刻画/ 了/ 将/ 未分类/ 数据/ x/ 对应/ 的/ 顶点/ u/ 与/ 具有/ 标签/ λ/ k/ 的/ 数据/ 对应/ 的/ 顶点/ 相连/ (/ 记作/ x/ </ λ/ k/ )/ 时/ ,/ 以/ u/ 点为/ 起点/ 游走/ 到/ 图/ Gk/ 中/ 每个/ 顶点/ 的/ 条件/ 概率/ ./ 我们/ 将/ 该/ 条件/ 概率/ 记/ 作/ 其中/ ,/ π/ (/ i/ )/ 表示/ 向量/ π/ 的/ 第/ i/ 个/ 元素/ ./ 将/ 每个/ 标签/ 对应/ 的/ 点取/ 其/ 条件/ 概率/ 的/ 平均值/ ,/ 即/ 为/ 以/ u/ 点为/ 起点/ 遍历/ 图/ Gk/ 时/ 游走/ 到/ 每个/ 标签/ 的/ 平均/ 条件/ 概率/ :/ P/ (/ λ/ j/ ∈/ Yx/ |/ x/ </ λ/ k/ )/ =/ avg/ {/ P/ (/ vi/ |/ x/ </ λ/ k/ )/ |/ λ/ j/ ∈/ Yi/ }/ 3.2/ ./ 3/ 条件/ 概率模型/ 根据/ 条件/ 概率模型/ ,/ 未分类/ 数据/ x/ 具有/ 标签/ λ/ j/ 的/ 概率/ 可以/ 采用/ 以下/ 公式/ 计算/ :/ P/ (/ λ/ j/ ∈/ Yx/ )/ =/ ∑/ 1/ / k/ / q/ 因此/ ,/ 我们/ 还/ 需/ 要求/ 出/ 未知/ 数据/ 与/ 具有/ 标签/ λ/ k/ 的/ 点/ 相邻/ 的/ 先验概率/ P/ (/ x/ </ λ/ k/ )/ ./ 在/ 本文/ 中/ ,/ 使用/ u/ 点/ 和/ 具有/ 标签/ λ/ k/ 的/ 数据/ 对应/ 顶点/ 的/ 平均/ 距离/ 来/ 刻画/ 这个/ 先验概率/ ./ 即/ 平均/ 距离/ 越大/ ,/ 则/ 该/ 先验概率/ 的/ 值/ 就/ 越/ 小/ ./ 为此/ ,/ 首先/ 计算/ 一个/ 临时/ 变量/ ,/ 记/ 作/ 而后/ ,/ 使用/ 类似/ 于式/ (/ 8/ )/ ~/ (/ 10/ )/ 的/ 方法/ 对式/ (/ 19/ )/ 进行/ 归一化/ ,/ 即可/ 得到/ 所/ 需/ 的/ 先验概率/ P/ (/ x/ </ λ/ k/ )/ ,/ 将/ 其/ 代入/ 式/ (/ 18/ )/ ,/ 得到/ 最终/ 的/ 概率分布/ 结果/ ./ MLRW/ 算法/ 的/ 形式化/ 描述/ 如图/ 3/ 所示/ ./ 3.3/ 图/ 剪枝/ 标签集/ 的/ 势/ 指/ 平均/ 每条/ 数据/ 具有/ 的/ 标签/ 数/ [/ 5/ ]/ ,/ 记作/ c/ ./ 我们/ 发现/ ,/ 当/ 训练/ 集中/ 标签/ 的/ 势/ 较大/ 时/ ,/ 图/ G/ 中边/ 的/ 数量/ 会/ 大大增加/ ./ 这/ 是因为/ ,/ 平均/ 每个/ 标签/ 关联/ 的/ 数据/ 为/ O/ (/ mc/ // q/ )/ ,/ 则/ 每个/ 点/ 平均/ 具有/ 边/ O/ (/ mc2/ // q/ )/ ,/ 图/ G/ 中边/ 的/ 总数/ 为/ O/ (/ m2c2/ // 2q/ )/ ./ 由此/ 可以/ 看出/ 图/ G/ 中/ 的/ 总边/ 数随/ c/ 的/ 增大/ 而/ 快速/ 增大/ ,/ 当/ c/ / 槡/ q/ 时/ ,/ MLRW/ 算法/ 的/ 空间/ 消耗/ 快速/ 上升/ ./ 因此/ ,/ 我们/ 对图/ G/ 进行/ 如下/ 剪枝/ ,/ 以/ 降低/ 算法/ 的/ 空间/ 消耗/ ./ 定义/ 4/ ./ 已知/ 图/ G/ =/ (/ V/ ,/ E/ )/ ,/ 其上/ 的/ 权重/ 矩阵/ 为/ 犠/ ,/ 则/ 图/ G/ 上/ 的/ Top/ -/ k/ 剪枝/ 指/ 的/ 是/ ,/ 对/ 每个/ 顶点/ vi/ ∈/ V/ ,/ 将/ 其/ 相关联/ 的/ 所有/ 边/ {/ (/ vi/ ,/ vj/ )/ |/ i/ ≠/ j/ ,/ (/ vi/ ,/ vj/ )/ ∈/ Page6E/ }/ ,/ 按照/ 其/ 权重/ Wij/ 排序/ ,/ 保留/ 其中/ 权重/ 最小/ (/ 即/ 距离/ 最近/ )/ 的/ k/ 条边/ ,/ 将/ 其它/ 边/ 从/ 图/ G/ 中/ 删除/ ./ 我们/ 将/ 在/ 本文/ 实验/ 部分/ 对/ 剪枝/ 的/ 影响/ 进行/ 讨论/ ./ 算法/ 1/ ./ 多/ 标签/ 随机/ 游走/ 算法/ MLRW/ ./ 输入/ :/ 训练/ 数据/ 集合/ D/ ,/ 随机/ 跳转/ 发生/ 概率/ α/ ,/ 输出/ :/ x/ 具有/ Y/ 中/ 每个/ 标签/ 的/ 概率分布/ P/ (/ λ/ j/ ∈/ Yx/ )/ MLRW/ (/ D/ ,/ α/ ,/ x/ ,/ Y/ )/ 1/ ./ 初始化/ 数组/ PC/ 、/ PP/ // // 临时/ 保存/ 条件/ 概率/ 、/ 先验概率/ 2/ ./ 构造/ 随机/ 跳转/ 到/ 每个/ 顶点/ 的/ 概率分布/ 向量/ 犱/ // // 式/ (/ 15/ )/ 3/ ./ fork/ ←/ 1toqdo4/ ./ 根据/ D/ ,/ x/ ,/ λ/ k/ 构造/ 随机/ 游走/ 图/ Gk/ // // 式/ (/ 11/ )/ ~/ (/ 13/ )/ 5/ ./ 根据/ Gk/ 计算/ 邻接矩阵/ 犘/ 6/ ./ 根据/ Gk/ 计算/ 随机/ 游走/ 初始/ 向量/ 狊/ 0/ // // 式/ (/ 14/ )/ 7/ ./ 应用/ 随机/ 游走/ 模型/ 得出/ 条件/ 概率分布/ 向量/ ,/ 记/ 作/ 犙/ :/ 犙/ (/ j/ )/ =/ P/ (/ λ/ j/ ∈/ Yx/ |/ x/ </ λ/ k/ )/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ q/ // // 式/ (/ 16/ )/ ~/ (/ 17/ )/ 8/ ./ 将/ 向量/ 犙/ 保存/ 到/ 数组/ PC/ 中/ ,/ 即/ PC/ [/ k/ ]/ =/ 犙/ 9/ ./ 计算/ 先验概率/ 并/ 保存/ 在/ 数组/ PP/ 中/ :/ PP/ [/ k/ ]/ =/ P/ (/ x/ </ λ/ k/ )/ 10/ ./ endfor11/ ./ foreach/ λ/ j/ ∈/ Ydo11/ ./ 根据/ PP/ ,/ PR/ 计算/ 概率分布/ P/ (/ λ/ j/ ∈/ Yx/ )/ // // 式/ (/ 18/ )/ 12/ ./ endfor4/ 分类/ 阈值/ 学习/ 方法/ 由式/ (/ 18/ )/ ,/ 当/ 输入/ 一个/ 未分类/ 数据/ x/ 时/ ,/ 可求/ 出/ x/ 具有/ 每个/ 标签/ 的/ 概率分布/ ./ 通过/ 该/ 概率分布/ ,/ 可以/ 得到/ 一个/ 排序/ 后/ 的/ 标签/ 集合/ ./ 此时/ ,/ 为了/ 决定/ 每个/ 标签/ 的/ 取舍/ ,/ 还/ 需要/ 为/ 每个/ 标签/ 给定/ 一个/ 阈值/ ,/ 将/ 概率/ 大于/ 阈值/ 的/ 标签/ 集合/ 作为/ x/ 的/ 预测/ 标签/ 集合/ Px/ ./ 多/ 标签/ 分类/ 中/ 的/ 阈值/ 确定/ 问题/ ,/ 同样/ 得到/ 了/ 人们/ 的/ 广泛/ 研究/ ./ 例如/ ,/ Fan/ 等/ 提出/ 了/ SCutFBR/ 算法/ [/ 18/ ]/ ,/ Tang/ 等/ 人/ 提出/ 了/ 基于/ 训练/ 数据/ 的/ 阈值/ 学习/ 方法/ [/ 19/ ]/ ./ 但是/ ,/ 这些/ 阈值/ 学习/ 的/ 方法/ 由于/ 没有/ 与/ 具体/ 的/ 分类/ 方法/ 相结合/ ,/ 往往/ 难以/ 取得/ 好/ 的/ 效果/ ./ 本文/ 基于/ MLRW/ 算法/ ,/ 给出/ 一种/ 新/ 的/ 阈值/ 学习/ 方法/ ./ 具体/ 地/ ,/ 首先/ 对/ 训练/ 集合/ D/ 进行/ 随机/ 采样/ ,/ 生成/ 采样/ 集合/ D/ ./ 对/ D/ 中/ 的/ 每/ 一个/ 数据/ xi/ ,/ 以/ xi/ 对应/ 的/ 顶点/ 为/ 输入/ 应用/ MLRW/ 算法/ ,/ 由式/ (/ 18/ )/ 可以/ 得到/ 一个/ q/ 维/ 的/ 概率分布/ 向量/ ,/ 记/ 作/ 犘/ i/ ./ 而后/ 我们/ 使用/ 这/ |/ D/ |/ 个/ 向量/ 通过/ 如下/ 操作/ 得到/ 一个/ q/ 维/ 的/ 接受/ 阈值/ (/ acceptthreshold/ )/ 向量/ 和/ 一个/ q/ 维/ 的/ 拒绝/ 阈值/ (/ rejectthreshold/ )/ 向量/ ,/ 分别/ 记/ 作/ 犘/ a/ 、/ 犘/ r/ ,/ 如/ 其中/ ,/ 犘/ a/ (/ j/ )/ 表示/ 向量/ 犘/ a/ 的/ 第/ j/ 个/ 元素/ ,/ 其它/ 类同/ ./ 最终/ 的/ 阈值/ 向量/ 为/ 这/ 两个/ 阈值/ 的/ 平均/ :/ 当/ 输入/ 一个/ 未分类/ 数据/ 时/ ,/ 首先/ 通过/ 算法/ 1/ 得到/ x/ 具有/ 每个/ 标签/ 的/ 概率/ ,/ 而后/ 与/ 阈值/ 向量/ 犘/ T/ 比较/ ,/ 进而/ 确定/ 每个/ 标签/ 的/ 有无/ ./ 5/ 算法/ 讨论/ 5.1/ 收敛性/ 定理/ 1/ ./ MLRW/ 算法/ 是/ 收敛/ 的/ ./ 证明/ ./ (/ 1/ )/ 因为/ 向量/ 犱/ 中/ 不/ 包含/ 非零/ 元素/ ,/ 并且/ 0/ </ α/ </ 1/ ,/ 所以/ 从/ 任意/ 点/ 开始/ ,/ 随机/ 跳跃/ 到/ 图/ Gk/ 中/ 的/ 任意/ 点/ 都/ 是/ 可能/ 的/ ,/ 故/ 邻接矩阵/ 犘/ 是/ 不可/ 规约/ 的/ (/ irreducible/ )/ ./ (/ 2/ )/ 当/ 随机/ 游走/ 过程/ 遍历/ 到/ 某/ 一/ 顶点/ 后/ ,/ 再次/ 遍历/ 到/ 这个/ 顶点/ 所/ 需/ 的/ 步数/ 是/ 不/ 确定/ 的/ ,/ 故/ 整个/ 随机/ 游走/ 过程/ 是/ 一个/ 非/ 周期/ 的/ 过程/ (/ aperiodic/ )/ ./ (/ 3/ )/ 显然/ ,/ 当图/ 中/ 任意/ 一个/ 顶点/ 被/ 遍历/ 后/ ,/ 都/ 可能/ 在/ 有限/ 步数/ 内/ 再次/ 遍历/ 这个/ 顶点/ ,/ 且/ 再次/ 遍历/ 之前/ 经过/ 的/ 步数/ 是/ 不/ 完全相同/ 的/ (/ positiverecurrent/ )/ ./ 由/ 以上/ 3/ 点/ ,/ 可以/ 得出/ MLRW/ 算法/ 是/ 各态/ 历经/ 的/ (/ ergodic/ )/ [/ 20/ ]/ ,/ 故此/ 算法/ 是/ 收敛/ 的/ ./ 即/ 存在/ 向量/ π/ ,/ 满足/ 式/ (/ 7/ )/ ./ 5.2/ 复杂度/ 分析/ 定理/ 2/ ./ MLRW/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ qlogm/ )/ ,/ 空间/ 复杂度/ 为/ O/ (/ q/ |/ E/ |/ )/ ./ 其中/ ,/ q/ 表示/ 标签/ 集合/ Y/ 的/ 大小/ ,/ E/ 表示/ 由/ 训练/ 集合/ D/ 导出/ 的/ 随机/ 游走/ 图/ G/ 中边/ 的/ 集合/ ,/ m/ 是/ 训练/ 集/ 的/ 大小/ ./ 证明/ ./ 算法/ 1/ 的/ 第/ 3/ ~/ 6/ 行/ 循环/ 的/ 复杂度/ 由/ 算法/ 第/ 6/ 行/ 随机/ 游走/ 的/ 迭代/ 次数/ 决定/ ./ 根据/ 文献/ [/ 21/ ]/ ,/ MLRW/ 算法/ 中/ 随机/ 游走/ 的/ 迭代/ 次数/ 为/ O/ (/ log/ |/ E/ |/ )/ =/ O/ (/ logm/ )/ ./ |/ Y/ |/ =/ q/ ,/ 故/ MLRW/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ qlogm/ )/ ./ 算法/ 1/ 中/ 需要/ 存储/ 的/ 变量/ 为/ 转移/ 矩阵/ 犘/ 、/ 随机/ 跳/ 转向/ 量/ 犱/ 、/ 每次/ 迭代/ 后/ 的/ 概率分布/ 向量/ 狊/ 、/ 数值/ α/ 和/ λ/ k/ ./ 其中/ ,/ 转移/ 矩阵/ 犘/ 的/ 大小/ 等于/ 图/ Gk/ 中边/ 的/ 数目/ ./ 故/ 算法/ 的/ 空间/ 复杂度/ 为/ O/ (/ (/ m/ +/ m/ +/ |/ E/ |/ )/ q/ +/ 1/ +/ 1/ )/ ,/ 由于/ 图/ Gk/ 连通/ ,/ 所以/ 总/ 的/ 空间/ 复杂度/ 为/ O/ (/ q/ |/ E/ |/ )/ ./ 证毕/ ./ 6/ 实验/ 6.1/ 数据/ 集/ 和/ 度量/ 标准/ 本文/ 采用/ yeast/ 数据/ 集/ ①/ ,/ 该/ 数据/ 集是/ 对/ 啤酒/ 酵/ ①/ 数据/ 集可/ 在/ http/ :/ // // mulan/ ./ sourceforge/ ./ net/ // datasets/ ./ htmlPage7/ 母菌/ 细胞/ 基因/ 表达/ 的/ 研究/ 结果/ ./ 经过/ 微阵列/ 实验/ (/ microarrayexperiments/ )/ ,/ 大量/ 的/ 基因/ 片段/ (/ 大约/ 3300/ 个/ )/ 被/ 按照/ 功能/ 进行/ 分类/ ,/ 其中/ 的/ 2417/ 条/ 数据/ 构成/ 了/ yeast/ 数据/ 集/ [/ 22/ ]/ ,/ 其/ 统计数据/ 如表/ 2/ 所示/ ./ 其中/ 标签/ 密度/ 等于/ 标签集/ 的/ 大小/ q/ 除以/ 标签集/ 的/ 势/ c/ ,/ 表示/ 每个/ 标签/ 出现/ 的/ 平均/ 概率/ ./ 数据/ 集/ 名称/ yeast1500917103140/ ./ 304.20/ 本文/ 使用/ 平均/ 精度/ (/ Avg/ -/ Precision/ )/ 、/ (/ One/ -/ Error/ )/ 、/ 结果/ 覆盖/ 长度/ (/ Coverage/ )/ 等/ 指标/ 对/ 实验/ 结果/ 进行/ 度量/ ,/ 它们/ 的/ 定义/ 分别/ 为/ [/ 23/ ]/ One/ -/ Error/ =/ 1Avg/ -/ Precison/ =/ 1/ 其中/ ri/ (/ λ/ )/ 表示/ 标签/ λ/ 的/ 排名/ ./ 本文/ 实验/ 环境/ 为/ IntelCore2/ ./ 33GHz/ 的/ CPU/ ,/ 4GB/ 内存/ ,/ 1.5/ TB/ 硬盘/ 的/ PC机/ ./ 操作系统/ 为/ Ubuntu9/ ./ 10/ ,/ Java/ 版本/ SunJDK1/ ./ 6.0/ ./ 6.2/ 实验/ 结果/ 6.2/ ./ 1/ 对比/ 实验/ 我们/ 基于/ MuLan/ ①/ 实现/ 了/ MLRW/ 算法/ ./ Mu/ -/ Lan/ 是/ 一个/ 基于/ Weka/ ②/ 的/ 开源/ 项目/ ,/ 它/ 实现/ 了/ 一些/ 最近/ 提出/ 的/ 多/ 标签/ 分类/ 和/ 排序/ 算法/ ./ 实验/ 中/ 采用/ 的/ 对比/ 算法/ 有/ Homer/ 、/ BR/ (/ BinaryRelevance/ )/ 、/ CLR/ (/ CalibratedLabelRanking/ )/ 、/ MLkNN/ (/ Multi/ -/ Labelk/ -/ nearestneighbor/ )/ 、/ RAkEL/ (/ Random/ -/ kLabelsets/ )/ 、/ LP/ (/ LabelPowerset/ )/ 等/ (/ 见/ 第/ 2/ 节/ )/ ./ 其中/ Homer/ 算法/ 中/ Cluster/ 的/ 数量/ 为/ 3/ ,/ MLkNN/ 中/ k/ =/ 10/ ,/ 其它/ 均/ 采用/ 默认/ 参数/ ./ BR/ 、/ CLR/ 、/ IncludeLabels/ 、/ RAkEL/ 、/ LP/ 算法/ 的/ 基础/ 分类器/ (/ baseclassifier/ )/ 采用/ SVM/ 分类器/ ,/ 该/ SVM/ 分类器/ 采用/ 线性/ 核/ 函数/ ,/ 常数/ c/ 的/ 值/ 为/ 1/ ./ Homer/ 分类/ 算法/ 采用/ CalibratedLabel/ 分类器/ 作为/ 基础/ 分类器/ ./ 在/ 对比/ 实验/ 中/ ,/ 我们/ 将/ 原有/ 数据/ 集中/ 的/ 训练/ 集/ 和/ 测试/ 集/ 混合/ ,/ 随机/ 重新/ 采样/ 排序/ ,/ 然后/ 用/ 10/ -/ fold/ 交叉/ 验证/ (/ crossvalidation/ )/ 的/ 方法/ 对/ 结果/ 进行/ 验证/ ./ 对/ 以上/ 实验/ 重复/ 进行/ 10/ 次/ ,/ 取其/ 平均值/ ./ MLRW/ 算法/ 中/ 剪枝/ 粒度/ k/ 设定/ 为/ 100/ ./ 如表/ 3/ 所示/ ,/ MLRW/ 算法/ 可以/ 达到/ 较/ 好/ 的/ 平均/ 精度/ 和/ 较/ 小/ 的/ 误差/ ./ MLRW/ 算法/ 的/ 平均/ 精度/ 与/ MLkNN/ 算法/ 几乎/ 相同/ ,/ 但/ MLRW/ 算法/ 的/ 结果/ 覆盖/ 长度/ 比较/ 小/ ,/ 也就是说/ ,/ 使用/ MLRW/ 算法/ 可以/ 用/ 较/ 小/ 的/ 误差/ 找全/ 所有/ 的/ 正确/ 标签/ 集合/ ./ 而/ 较/ 低/ 的/ One/ -/ Error/ 值/ (/ 相比/ MLkNN/ 领先/ 5.6/ %/ )/ ,/ 则/ 说明/ MLRW/ 算法/ 给出/ 的/ 排名/ 最靠/ 前/ 的/ 标签/ (/ top/ -/ onere/ -/ latedlabel/ )/ 不/ 在/ 该/ 数据/ 实际/ 标签/ 集合/ 中/ 的/ 概率/ 较/ 低/ ./ 这/ 在/ 信息检索/ 应用/ 中/ 非常/ 重要/ ,/ 因为/ 大多数/ 用户/ 往往/ 只/ 关心/ 排名/ 靠/ 前/ 的/ 检索/ 结果/ [/ 24/ ]/ ./ Homer0/ ./ 25018.23020/ ./ 6955BR0/ ./ 36647.50700/ ./ 6613CLR0/ ./ 25976.79710/ ./ 7097MLkNN0/ ./ 28447.41430/ ./ 7284LP0/ ./ 52679.59650/ ./ 5633RAkEL0/ ./ 29117.65430/ ./ 7096MLRW0/ ./ 24517.41000/ ./ 70696.2/ ./ 2/ 剪枝/ 粒度/ 对/ 实验/ 结果/ 的/ 影响/ 通过/ 实验/ 我们/ 发现/ ,/ 剪枝/ 粒度/ 越大/ (/ k/ 值越/ 小/ )/ ,/ 随机/ 游走/ 过程/ 中/ ,/ 达到/ 稳定/ 前/ 迭代/ 的/ 次数/ 就/ 越/ 多/ ./ 从图/ 4/ 中/ 可以/ 看出/ ,/ 随着/ k/ 值/ 的/ 增大/ ./ 迭代/ 数目/ 明显/ 减小/ ./ 这/ 是因为/ ,/ 剪枝/ 粒度/ 的/ 减小/ ,/ 图/ G/ 中边/ 的/ 数量/ 增加/ ,/ 图/ 的/ 连通性/ 增强/ ,/ 邻接矩阵/ 犘/ 中/ 每/ 一列/ 的/ 方差/ 减小/ ,/ 遍历/ 到/ 每点/ 的/ 概率/ 趋于/ 平均/ ,/ 因此/ 收敛/ 速度/ 加快/ ./ 通过/ 对比/ 剪枝/ 粒度/ 对/ 算法/ 精度/ 的/ 影响/ ,/ 我们/ 发现/ ,/ 改变/ 剪枝/ 粒度/ 的/ 大小/ (/ k/ 值/ )/ ,/ 对/ 实验/ 精度/ 的/ 影响/ 极小/ ,/ 算法/ 的/ 平均/ 精度/ 维持/ 在/ 69.75/ %/ ±/ 0.5/ %/ (/ 如图/ 5/ 所示/ )/ ./ 可以/ 认为/ ,/ 剪枝/ 的/ 粒度/ 只会/ 改变/ 算法/ 的/ 收敛/ 速度/ ,/ 不会/ 对/ 算法/ 的/ 精度/ 造成/ 大幅度/ 影响/ ./ ①/ ②/ Page86/ ./ 2.3/ α/ 取值/ 对/ 实验/ 精度/ 的/ 影响/ 由式/ (/ 6/ )/ 得知/ ,/ α/ 表示/ 游走/ 过程/ 中/ 随机/ 跳跃/ 到/ 某个/ 点/ 进行/ 遍历/ 的/ 概率/ ./ α/ 值越/ 大/ ,/ 则/ 随机/ 跳跃/ 到/ 其它/ 点/ 的/ 概率/ 就/ 越/ 大/ ./ 当取/ k/ =/ 100/ 时/ ,/ α/ 变化/ 对/ 算法/ 精度/ 的/ 影响/ 如图/ 6/ 所示/ ./ 从中/ 可以/ 看出/ ,/ α/ 取值/ 的/ 变化/ 对/ 算法/ 精度/ 的/ 影响/ 比较/ 小/ (/ 不/ 超过/ ±/ 3/ %/ )/ ./ 当/ 算法/ 进行/ 迭代/ 时/ ,/ 尽管/ 随/ α/ 的/ 变化/ ,/ 实验/ 结果/ 也/ 会/ 有所/ 变化/ ,/ 但是/ 由于/ 该/ 数据/ 集中/ 标签集/ 的/ 势/ 较/ 高/ (/ c/ =/ 4.20/ )/ ,/ 图/ G/ 的/ 连通性/ 较强/ ,/ 因此/ ,/ α/ 取值/ 的/ 变化/ 对/ 收敛/ 后/ 的/ 概率分布/ 影响/ 不大/ ./ 7/ 结论/ 本文/ 介绍/ 了/ 一种/ 基于/ 随机/ 游走/ 模型/ 的/ 多/ 标签/ 分类/ 算法/ MLRW/ ,/ 能够/ 有效/ 解决/ 多/ 标签/ 分类/ 和/ 排序/ 问题/ ./ 今后/ 将/ 考虑/ 标签/ 数量/ 和/ 分布/ 对/ 分类/ 结果/ 的/ 影响/ ./ 同时/ ,/ 在/ 今后/ 的/ 工作/ 中/ 也/ 将/ 考虑/ 进一步提高/ 算法/ 的/ 效率/ ./ 

