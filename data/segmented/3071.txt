Page1/ 犱/ -/ 子树/ 划分/ 问题/ 蔡延光/ 1/ )/ 章云/ 1/ )/ 钱积/ 新/ 2/ )/ 1/ )/ (/ 广东/ 工业/ 大学/ 自动化/ 学院/ 广州/ 510006/ )/ 2/ )/ (/ 浙江大学/ 工业/ 控制技术/ 国家/ 重点/ 实验室/ 杭州/ 310027/ )/ 摘要/ 边/ 赋非/ 负权/ 无/ 向/ 简单/ 图/ 的/ 一簇/ 顶点/ 两/ 两/ 不/ 相交/ 的/ 子树/ 称为/ 它/ 的/ 一个/ d/ -/ 子树/ 划分/ (/ d/ 为/ 非负/ 实数/ )/ ,/ 如果/ 这些/ 子树/ 的/ 顶点/ 集/ 的/ 并/ 等于/ 此图/ 的/ 顶点/ 集/ ,/ 且/ 每/ 棵子/ 树/ 的/ 直径/ 不/ 超过/ d/ ./ 图/ 的/ d/ -/ 子树/ 划分/ 问题/ 就是/ 求/ 它/ 的/ 一个/ 含子/ 树数/ 最少/ 的/ d/ -/ 子树/ 划分/ 及其/ 所含/ 的/ 子树数/ ./ d/ -/ 子树/ 划分/ 问题/ 在/ 有线/ 通信/ 网络/ 、/ 道路交通/ 网络/ 、/ 城市/ 供水/ 网络/ 、/ 电力/ 传输/ 网络/ 等/ 网络/ 的/ 运行/ 管理/ 、/ 维护/ 与/ 测试/ 中/ 具有/ 很强/ 的/ 应用/ 背景/ ./ 文中/ 证明/ 了/ 对/ 任意/ 正/ 实数/ d/ ,/ 边/ 赋非/ 负权/ 二分/ 平面图/ 的/ d/ -/ 子树/ 划分/ 问题/ 是/ NP/ -/ 完全/ 问题/ ;/ 提出/ 了/ 求解/ 边/ 赋非/ 负权/ 树/ d/ -/ 子树/ 划分/ 问题/ 的/ 一个/ 线性/ 时间/ 算法/ ,/ 详细/ 地/ 讨论/ 了/ 算法/ 的/ 实现/ 策略/ ./ 所/ 提出/ 的/ 算法/ 具有/ 简明/ 易/ 实现/ 、/ 耗费/ 时间/ 少/ 等/ 特点/ ./ 关键词/ d/ -/ 子树/ 划分/ ;/ 子树/ 划分/ ;/ NP/ -/ 完全/ ;/ 树/ ;/ 算法/ ;/ 复杂度/ 1/ 引言/ 定义/ 1/ ./ 设/ G/ =/ (/ V/ ,/ E/ )/ 是/ 一个/ 边/ 赋非/ 负权/ 的/ 无/ 向/ 简单/ 图/ ,/ 顶点/ 数为/ n/ =/ |/ V/ (/ G/ )/ |/ ,/ d/ / 0/ 为/ 实数/ ./ 如果/ G/ 中/ m/ 棵/ 顶点/ 两/ 两/ 不/ 相交/ 的/ 子树/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ 满足/ ∪/ mi/ =/ 1V/ (/ Ti/ )/ =/ V/ (/ G/ )/ ,/ d/ (/ Ti/ )/ / d/ (/ 这里/ d/ (/ Ti/ )/ =/ maxu/ ,/ v/ ∈/ V/ (/ Ti/ )/ d/ (/ u/ ,/ v/ )/ 为/ Ti/ 的/ 直径/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ ,/ 则/ 称/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 为/ G/ 的/ 一个/ d/ -/ 子树/ 划分/ ./ G/ 的/ 含子/ 树数/ 最少/ 的/ d/ -/ 子树/ 划分/ 称为/ G/ 的/ 最小/ d/ -/ 子树/ 划分/ ;/ 最小/ d/ -/ 子树/ 划分/ 所含/ 的/ 子树数/ 称为/ G/ 的/ d/ -/ 子树/ 划分/ 数/ ,/ 记/ 作/ π/ d/ (/ G/ )/ ./ 所谓/ G/ 的/ d/ -/ 子树/ 划分/ 问题/ 就是/ 求/ π/ d/ (/ G/ )/ 和/ G/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ./ d/ -/ 子树/ 划分/ 问题/ 在/ 有线/ 通信/ 网络/ 、/ 道路交通/ 网络/ 、/ 城市/ 供水/ 网络/ 、/ 电力/ 传输/ 网络/ 等/ 网络/ 的/ 运行/ 管理/ 、/ 维护/ 与/ 测试/ 中/ 具有/ 很强/ 的/ 应用/ 背景/ ./ 例如/ ,/ 在/ 对/ 某种/ 有线/ 通信/ 网络/ 进行/ 维护/ 时/ ,/ 需要/ 把/ 该/ 通信/ 网络/ 中/ 的/ 结点/ 划分/ 为/ 尽量少/ 的/ 组/ ,/ 使得/ 每组/ 中/ 的/ 结点/ 可用/ 一个/ 直径/ 不/ 超过/ 预定/ 值/ d/ 的/ 树型/ 子网/ 通信/ ./ 这/ 就是/ 一个/ d/ -/ 子树/ 划分/ 问题/ ./ 理论/ 上/ 看来/ ,/ d/ -/ 子树/ 划分/ 问题/ 是/ 路/ 划分/ 问题/ [/ 1/ ]/ (/ pathpartitionproblem/ )/ 、/ k/ -/ 路/ 划分/ 问题/ [/ 2/ ]/ (/ k/ -/ pathpartitionproblem/ )/ 、/ ω/ -/ 路/ 划分/ 问题/ [/ 3/ ]/ (/ ω/ -/ pathparti/ -/ tionproblem/ )/ 等/ 的/ 推广/ ./ 如果/ 将子/ 树/ 限定/ 为/ 路径/ ,/ d/ 为/ 非负/ 实数/ ω/ ,/ 则/ d/ -/ 子树/ 划分/ 问题/ 成为/ ω/ -/ 路/ 划分/ 问题/ ;/ 当/ G/ 是/ (/ 边/ )/ 非/ 赋权/ 图/ ,/ ω/ 是/ 一个/ 正整数/ k/ 时/ ,/ ω/ -/ 路/ 划分/ 问题/ 就是/ k/ -/ 路/ 划分/ 问题/ ;/ 当/ k/ / n/ -/ 1/ 时/ (/ 实际上/ 对/ 路径/ 的/ 长度/ 无/ 限制/ )/ ,/ k/ -/ 路/ 划分/ 问题/ 简称/ 为路/ 划分/ 问题/ ./ d/ -/ 子树/ 划分/ 问题/ 可/ 进一步/ 推广/ 为图/ 聚类/ 问题/ (/ graphclusteringproblem/ )/ ,/ 包括/ 直径/ 有限/ 的/ 子/ 图/ 划分/ 问题/ [/ 4/ ]/ ./ 从/ Hamilton/ 路/ 的/ NP/ -/ 完全性/ 容易/ 看/ 出路/ 划分/ 问题/ 属于/ NP/ -/ 完全/ 问题/ ./ 由于/ k/ -/ 路/ 划分/ 问题/ 、/ ω/ -/ 路/ 划分/ 问题/ 是/ 路/ 划分/ 问题/ 的/ 直接/ 推广/ ,/ 因此/ 它们/ 也/ 均/ 属于/ NP/ -/ 完全/ 问题/ ./ 到/ 目前为止/ ,/ 仅/ 对于/ 树/ [/ 5/ ]/ (/ tree/ )/ 、/ 圆弧/ 图/ [/ 6/ ]/ (/ circulararcgraph/ )/ 、/ 区间/ 图/ [/ 7/ ]/ (/ intervalgraph/ )/ 、/ 仙人掌/ [/ 8/ ]/ (/ cactus/ )/ 、/ 上/ 比较/ 图/ [/ 9/ ]/ (/ cocompara/ -/ bilitygraph/ )/ 、/ 块/ 图/ [/ 1/ ,/ 10/ -/ 11/ ]/ (/ blockgraph/ )/ 、/ 二分/ 置换/ 图/ [/ 10/ ]/ (/ bipartitepermutationgraph/ )/ 、/ 上/ 图/ [/ 12/ -/ 13/ ]/ (/ cograph/ )/ 、/ 距离/ 遗传/ 图/ [/ 14/ ]/ (/ distance/ -/ hereditarygraph/ )/ 、/ P4/ -/ 稀疏/ 图/ [/ 15/ ]/ (/ P4/ -/ sparsegraph/ )/ 以及/ 块/ 为/ 完全/ 图/ 、/ 圈/ 、/ 完全/ 二分/ 图/ 的/ 图/ [/ 16/ ]/ 等/ 获得/ 了/ 多项式/ 时间/ 算法/ 求解/ 路/ 划分/ 问题/ ./ 对于/ k/ -/ 路/ 划分/ 问题/ ,/ 仅/ 对/ 树/ [/ 17/ ]/ 、/ 二分/ 置换/ 图/ [/ 2/ ]/ 和/ 仙人掌/ [/ 18/ ]/ 等/ 获得/ 了/ 多项式/ 时间/ 算法/ ./ 对于/ ω/ -/ 路/ 划分/ 问题/ ,/ 仅/ 对/ 树/ 和/ 森林/ [/ 3/ ]/ 获得/ 了/ 多项式/ 时间/ 算法/ ./ 由于/ d/ -/ 子树/ 划分/ 问题/ 的/ 问题/ 结构/ 更加/ 复杂/ ,/ 因此/ 求解/ 起来/ 亦非/ 易事/ ./ 本文/ 证明/ 了/ 对/ 任何/ 固定/ 的/ d/ >/ 0/ ,/ 边/ 赋非/ 负权/ 二分/ 平面图/ 的/ d/ -/ 子树/ 划分/ 问题/ 是/ NP/ -/ 完全/ 问题/ ./ 这/ 表明/ 即使/ 对/ 结构/ 非常简单/ 的/ 边/ 赋非/ 负权/ 图/ ,/ d/ -/ 子树/ 划分/ 问题/ 也/ 是/ 非常/ 困难/ 的/ ./ 树是/ 一类/ 特殊/ 的/ 二分/ 平面图/ ,/ 也/ 是/ 理论/ 研究/ 和/ 实际/ 应用/ 中/ 最/ 常见/ 的/ 网络拓扑/ 结构/ 之一/ ./ 本文/ 提出/ 了/ 求解/ 边/ 赋非/ 负权/ 树/ d/ -/ 子树/ 划分/ 问题/ 的/ 一个/ 线性/ 时间/ 算法/ ;/ 为了/ 进一步提高/ 算法/ 的/ 效率/ ,/ 还/ 详细/ 地/ 讨论/ 了/ 算法/ 的/ 实现/ 策略/ ./ 所/ 提出/ 的/ 算法/ 具有/ 简明/ 易/ 实现/ 、/ 耗费/ 时间/ 少/ 等/ 特点/ ./ 定义/ 2/ ./ 考虑/ 边/ 赋非/ 负权/ 的/ 无/ 向/ 简单/ 图/ G/ =/ (/ V/ ,/ E/ )/ ./ (/ 1/ )/ 设/ (/ u/ ,/ v/ )/ ∈/ E/ (/ G/ )/ ,/ 以/ w/ (/ u/ ,/ v/ )/ 表示/ 边/ (/ u/ ,/ v/ )/ 的/ 权/ ./ (/ 2/ )/ 设/ u/ ,/ v/ ∈/ V/ (/ G/ )/ ,/ 以/ d/ (/ u/ ,/ v/ )/ 表示/ u/ ,/ v/ 之间/ 的/ 距离/ ;/ 如果/ P/ 是/ u/ ,/ v/ 之间/ 的/ 最/ 短路/ 且/ d/ (/ u/ ,/ v/ )/ =/ d/ (/ G/ )/ ,/ 则/ 称/ P/ 为/ G/ 的/ 直径/ 路/ ;/ 以/ (/ u/ ~/ v/ )/ 表示/ u/ 到/ v/ 的/ 一条/ 路径/ ,/ 分别/ 以/ V/ (/ u/ ~/ v/ )/ 、/ E/ (/ u/ ~/ v/ )/ 表示/ (/ u/ ~/ v/ )/ 的/ 顶点/ 集和边/ 集/ ./ (/ 3/ )/ 设/ v/ ∈/ V/ (/ G/ )/ ,/ 如果/ v/ 的/ 顶点/ 度/ d/ (/ v/ )/ =/ 1/ ,/ 则/ 称/ v/ 为/ G/ 的/ 端/ 顶点/ ./ (/ 4/ )/ 设/ H/ ,/ K/ / G/ ,/ 以/ H/ / K/ 表示/ 在/ H/ 中/ 删除/ V/ (/ K/ )/ 以及/ 与/ V/ (/ K/ )/ 相关联/ 的/ 所有/ 边/ 而/ 形成/ 的/ 子/ 图/ ./ (/ 5/ )/ 设/ v/ ∈/ V/ (/ G/ )/ ,/ G1/ 是/ G/ -/ v/ 的/ 一个/ 连通分支/ ,/ 称/ 导出/ 子图/ G/ [/ V/ (/ G1/ )/ ∪/ {/ v/ }/ ]/ 为/ v/ (/ 点/ )/ 的/ 一个/ 分支/ ;/ 任取/ x/ ∈/ V/ (/ G1/ )/ ,/ 以/ G/ (/ v/ ,/ x/ )/ 表示/ v/ 的/ 包含/ x/ 的/ 分支/ ./ 显然/ ,/ x/ ≠/ v/ ,/ |/ V/ (/ G/ (/ v/ ,/ x/ )/ )/ |/ / 2/ ./ (/ 6/ )/ 设/ G1/ ,/ G2/ / G/ ,/ V/ (/ G1/ )/ ∩/ V/ (/ G2/ )/ =/ {/ v/ }/ ,/ 记/ G1/ ○/ vG2/ =/ G1/ ∪/ G2/ ,/ 称/ G1/ ○/ vG2/ 为/ G1/ ,/ G2/ 在/ v/ 的/ 粘合/ 子图/ ./ 显然/ ,/ 若/ G1/ ,/ G2/ 为树/ ,/ 则/ G1/ ○/ vG2/ 也/ 是/ 树/ ./ 除非/ 特别/ 声明/ ,/ 本文/ 所/ 提及/ 的/ 图/ 、/ 树/ 、/ 路径/ 分别/ 指边/ 赋非/ 负权/ 的/ 无/ 向/ 简单/ 图/ 、/ 树/ 、/ 路径/ ,/ 并/ 分别/ 简称/ 为/ 图/ 、/ 树/ 、/ 路径/ ./ 约定/ 空树/ 也/ 是/ 树/ 、/ 空树/ 的/ 直径/ 为/ 0/ ./ 文中/ 未定义/ 的/ 术语/ 和/ 记号/ 与/ 文献/ [/ 19/ ]/ 一致/ ./ 为了/ 表述/ 方便/ ,/ 算法/ 采用/ C语言/ 风格/ 设计/ ./ 2/ 犱/ -/ 子树/ 划分/ 问题/ 的/ 计算/ 复杂性/ 分/ 平面图/ 的/ d/ -/ 子树/ 划分/ 问题/ 是/ NP/ -/ 完全/ 问题/ ./ 定理/ 1/ ./ 对/ 任意/ d/ >/ 0/ 的/ 实数/ ,/ 边/ 赋非/ 负权/ 二/ 证明/ ./ 利用/ 平面图/ 的/ 顶点/ 覆盖/ 问题/ 的/ NP/ -/ 完/ Page3/ 全性/ [/ 20/ -/ 21/ ]/ ./ 设/ G/ =/ (/ V/ ,/ E/ )/ 是/ 一个/ 平面图/ ,/ V/ =/ {/ vi/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ./ 构造/ 新图/ G1/ =/ (/ V1/ ,/ E1/ )/ 如下/ :/ V1/ =/ {/ vi/ ,/ xi/ ,/ yi/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ∪/ E1/ =/ {/ (/ vi/ ,/ xi/ )/ ,/ (/ xi/ ,/ yi/ )/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ∪/ {/ zij/ |/ (/ vi/ ,/ vj/ )/ ∈/ E/ (/ G/ )/ ,/ i/ </ j/ ;/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ;/ {/ (/ vi/ ,/ zij/ )/ ,/ (/ zij/ ,/ vj/ )/ |/ zij/ ∈/ V/ (/ G1/ )/ ;/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ;/ 对/ 任意/ e/ ∈/ E1/ ,/ 定义/ w/ (/ e/ )/ =/ d/ // 2/ (/ 见图/ 1/ )/ ./ 容易/ 看出/ ,/ 因为/ G/ 是/ 平面图/ 及/ G1/ 不含/ 奇圈/ ,/ 故/ G1/ 是/ 一个/ 边/ 赋非/ 负权/ 的/ 二分/ 平面图/ ./ 一方面/ ,/ 设/ S/ 是/ G/ 的/ 任意/ 最小/ 顶点/ 覆盖/ 集/ ,/ 不妨/ 设/ S/ =/ {/ vi/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ }/ (/ m/ / n/ )/ ./ 构造/ G1/ 的/ d/ -/ 子树/ 划分/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ +/ n/ }/ 如下/ :/ Ti/ =/ {/ vi/ }/ ∪/ {/ zij/ |/ zij/ ∈/ V/ (/ G1/ )/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ 的/ 导出/ 子图/ (/ 实际上/ 是/ 以/ vi/ 为/ 中心/ 、/ 直径/ 不/ 大于/ d/ 的/ 一颗/ 星/ )/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ;/ Tm/ +/ i/ =/ {/ xi/ ,/ yi/ }/ 的/ 导出/ 子图/ (/ 实际上/ 是/ K2/ ,/ 直径/ 为/ d/ // 2/ )/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ;/ Tm/ +/ i/ =/ {/ vi/ ,/ xi/ ,/ yi/ }/ 的/ 导出/ 子图/ (/ 实际上/ 是/ 以/ xi/ 为/ 中心/ 、/ 直径/ 为/ d/ 的/ 一颗/ 星/ )/ ,/ i/ =/ m/ +/ 1/ ,/ m/ +/ 2/ ,/ …/ ,/ n/ ./ 因此/ ,/ π/ d/ (/ G1/ )/ / β/ (/ G/ )/ +/ n/ ,/ 其中/ β/ (/ G/ )/ 为/ G/ 的/ 顶点/ 覆盖/ 数/ ./ 另一方面/ ,/ 对/ G1/ 的/ 任何/ 最小/ d/ -/ 子树/ 划分/ ,/ 因为/ 其中/ 每/ 棵子/ 树/ 的/ 直径/ 不/ 大于/ d/ ,/ 故/ 含有/ y/ 型/ 顶点/ (/ 这里/ ,/ y/ 型/ 顶点/ 是/ 形为/ yi/ 的/ 顶点/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 以下/ 提及/ 的/ v/ 型/ 顶点/ 有/ 类似/ 的/ 解释/ )/ 的/ 子树/ 必不含/ z/ 型/ 顶点/ (/ z/ 型/ 顶点/ 是/ 形为/ zij/ 的/ 顶点/ ,/ zij/ ∈/ V/ (/ G1/ )/ ;/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ;/ 且/ 对/ 一切/ i/ ≠/ j/ ,/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ 含有/ yi/ 的/ 子树/ 不/ 含/ yj/ ./ 因此/ ,/ G1/ 的/ 任何/ 最小/ d/ -/ 子树/ 划分/ 中不含/ z/ 型/ 顶点/ 的/ 子树数/ 至少/ 为/ n/ ./ 然而/ ,/ 我们/ 有/ :/ 存在/ G1/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ Π/ / ,/ 使得/ 其中/ 任何/ 含有/ z/ 型/ 顶点/ 的/ 子树/ 恰好/ 含/ 一个/ v/ 型/ 顶点/ ./ 事实上/ ,/ 设/ Π/ =/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 任意/ 最小/ d/ -/ 子树/ 划分/ ,/ 从/ Π/ 出发/ ,/ 分/ 两步/ 构造/ Π/ / ./ 第/ 1/ 步/ ./ 构造/ G1/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ Π/ ,/ 使得/ 其中/ 任何/ 含有/ z/ 型/ 顶点/ 的/ 子树/ 至少/ 含有/ 一个/ v/ 型/ 顶点/ ./ 在/ Π/ 中/ ,/ 如果/ 有/ 某/ 棵子/ 树/ 譬如/ T1/ 含有/ zij/ 而/ 不/ 含/ v/ 型/ 顶点/ ,/ 此时/ 必有/ V/ (/ T1/ )/ =/ {/ zij/ }/ ./ 考虑/ G1/ 中/ 与/ zij/ 相邻/ 的/ 顶点/ vi/ ,/ 不妨/ 设/ vi/ 所在/ 的/ 子树为/ T2/ ./ 在/ T2/ 中/ ,/ vi/ 的/ 顶点/ 度/ d/ (/ vi/ )/ 必/ 等于/ 1/ (/ 否则/ ,/ 如果/ d/ (/ vi/ )/ >/ 1/ ,/ 则/ T2/ 是/ 一个/ 以/ vi/ 为/ 中心/ 的/ 直径/ 为/ d/ 的/ 一颗/ 星/ ;/ 因此/ ,/ {/ T2/ ∪/ (/ zij/ ~/ vi/ )/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 与/ Π/ 的/ 最小/ 性/ 相/ 矛盾/ ./ 对于/ d/ (/ vi/ )/ =/ 0/ 可/ 类似/ 讨论/ )/ ./ 下面/ 分/ 两种/ 情形/ 讨论/ ./ 情形/ 1/ ./ 若/ T2/ 不含/ z/ 型/ 顶点/ ,/ 则/ {/ (/ zij/ ~/ vi/ )/ ,/ T2/ -/ vi/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ,/ 但/ 其中/ 含有/ z/ 型/ 顶点/ 而/ 不/ 含有/ v/ 型/ 顶点/ 的/ 子树少/ 了/ 一棵/ ./ 情形/ 2/ ./ 若/ T2/ 含有/ z/ 型/ 顶点/ ,/ 并/ 不妨/ 设为/ zis/ (/ i/ </ s/ )/ ,/ 此时/ T2/ 必/ 含有/ vs/ (/ 否则/ 应有/ T2/ =/ (/ zis/ ~/ vi/ )/ ,/ 于是/ {/ (/ zij/ ~/ vi/ )/ ∪/ (/ zis/ ~/ vi/ )/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 与/ Π/ 的/ 最小/ 性/ 相/ 矛盾/ )/ ,/ 于是/ {/ (/ zij/ ~/ vi/ )/ ,/ T2/ -/ vi/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ,/ 但/ 其中/ 含有/ z/ 型/ 顶点/ 而/ 不/ 含/ v/ 型/ 顶点/ 的/ 子树少/ 了/ 一棵/ ./ 重复使用/ 上述/ 方法/ ,/ 即可/ 得到/ Π/ ./ 第/ 2/ 步/ ./ 从/ Π/ 构造/ Π/ / ./ 设/ Π/ =/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ ./ 在/ Π/ 中/ ,/ 如果/ 有/ 某/ 棵子/ 树/ 譬如/ T1/ 含有/ zij/ 且/ 含/ 两个/ v/ 型/ 顶点/ (/ 因为/ T1/ 的/ 直径/ 不/ 大于/ d/ ,/ T1/ 不/ 可能/ 含有/ 两个/ 以上/ 的/ v/ 型/ 顶点/ )/ ,/ 此时/ T1/ =/ (/ vi/ ~/ zij/ ~/ vj/ )/ ,/ 不妨/ 设含/ xi/ 的/ 子树为/ T2/ (/ 显然/ ,/ T2/ =/ (/ xi/ ~/ yi/ )/ )/ ,/ 于是/ {/ (/ zij/ ~/ vj/ )/ ,/ T2/ ∪/ (/ vi/ ~/ xi/ )/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ G1/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ,/ 但/ 含有/ z/ 型/ 顶点/ 且/ 含/ 两个/ v/ 型/ 顶点/ 的/ 子树少/ 了/ 一棵/ ./ 重复使用/ 此/ 方法/ ,/ 就/ 可/ 获得/ Π/ / ./ 在/ Π/ / 中/ ,/ 不妨/ 设含/ z/ 型/ 顶点/ 的/ 子树为/ T/ / 1/ ,/ T/ / 2/ ,/ …/ ,/ q/ ,/ 对应/ 的/ v/ 型/ 顶点/ 分别/ 为/ v1/ ,/ v2/ ,/ …/ ,/ vq/ ./ 显然/ ,/ T/ / {/ v1/ ,/ v2/ ,/ …/ ,/ vq/ }/ 是/ G/ 的/ 一个/ 顶点/ 覆盖/ 集/ ,/ 即/ β/ (/ G/ )/ / q/ ./ 但是/ π/ d/ (/ G1/ )/ =/ Π/ / 中含/ z/ 型/ 顶点/ 的/ 子树数/ +/ Π/ / 中不含/ z/ 型/ 顶点/ 的/ 子树数/ / q/ +/ n/ / β/ (/ G/ )/ +/ n/ ./ 因此/ ,/ π/ d/ (/ G1/ )/ =/ β/ (/ G/ )/ +/ n/ ./ 因为/ 求/ β/ (/ G/ )/ 为/ NP/ -/ 完全/ 问题/ ,/ 故求/ π/ d/ (/ G1/ )/ 也/ 是/ NP/ -/ 完全/ 问题/ ./ 3/ 边/ 赋非/ 负权/ 树/ 的/ 犱/ -/ 子树/ 划分/ 问题/ 标号/ D/ ./ 设/ T/ 是/ 一棵树/ ,/ n/ =/ |/ V/ (/ T/ )/ |/ / 1/ ,/ 任选/ v0/ ∈/ V/ (/ T/ )/ ./ T/ 的/ 每个/ 顶点/ v/ 标号/ 为/ l/ (/ v/ )/ :/ l/ (/ v/ )/ =/ d/ (/ v/ ,/ v0/ )/ ,/ 称/ l/ (/ v/ )/ 为/ v/ 的/ 标号/ ./ 通过/ 标号/ D/ 标号/ 的/ 树/ T/ 可以/ 看作/ 是/ 一棵/ 以/ v0/ 为根/ 的/ (/ 倒立/ 的/ )/ 有/ 根树/ ;/ 这样/ ,/ 我们/ 就/ 可/ 使用/ 与/ 有/ 根/ Page4/ 如果/ d/ (/ v/ )/ / 3/ ,/ 则/ 将/ v/ 置于/ Q/ 之首/ (/ 即/ v/ 进栈/ Q/ )/ ;/ 第/ 2/ 步/ ./ 对/ 每个/ 刚刚/ 在/ 第/ 1/ 步/ 获得/ 标号/ 的/ 顶点/ u/ ,/ 依次/ 对/ u/ 的/ 每个/ 子女/ v/ 标号/ :/ l/ (/ v/ )/ =/ l/ (/ u/ )/ +/ w/ (/ u/ ,/ v/ )/ ,/ 如果/ d/ (/ v/ )/ / 3/ ,/ 则/ v/ 进栈/ Q/ ;/ 树/ 有关/ 的/ 一些/ 术语/ ,/ 如根/ (/ 顶点/ )/ 、/ 双亲/ (/ 顶点/ )/ 、/ 子女/ (/ 顶点/ )/ 、/ 祖先/ (/ 顶点/ )/ 、/ 后代/ (/ 顶点/ )/ ./ 如/ 无/ 特别/ 说明/ ,/ 本节/ 所/ 论及/ 的/ 树/ T/ 均/ 是/ 指/ 按/ 标号/ D/ 对/ 所有/ 顶点/ 进行/ 标号/ 的/ 以/ v0/ 为根/ 的/ 有/ 根树/ ./ 注/ 1/ ./ 标号/ D/ 可/ 在/ 线性/ 时间/ 内/ 完成/ ./ 事实上/ ,/ 在/ 用/ 标号/ D/ 对/ T/ 的/ 顶点/ 进行/ 标号/ 时/ ,/ 还/ 可/ 建立/ 一个/ 包含/ 根/ v0/ 和/ T/ 的/ 所有/ 使/ d/ (/ v/ )/ / 3/ 的/ 顶点/ v/ 组成/ 的/ 有序/ 集/ Q/ (/ Q/ 实际/ 是/ 一个/ 栈/ )/ ./ Q/ 的/ 构造方法/ 如下/ :/ 初始/ ,/ Q/ =/ {/ v0/ }/ ,/ l/ (/ v0/ )/ =/ 0/ ;/ 第/ 1/ 步/ ./ 依次/ 对/ v0/ 的/ 每个/ 子女/ v/ 标号/ :/ l/ (/ v/ )/ =/ w/ (/ v0/ ,/ v/ )/ ,/ …/ 第/ k/ 步/ ./ 对/ 每个/ 刚刚/ 在/ 第/ k/ -/ 1/ 步/ 获得/ 标号/ 的/ 顶点/ u/ ,/ 依次/ 对/ u/ 的/ 每个/ 子女/ v/ 标号/ :/ l/ (/ v/ )/ =/ l/ (/ u/ )/ +/ w/ (/ u/ ,/ v/ )/ ,/ 如果/ d/ (/ v/ )/ / 3/ ,/ 则/ v/ 进栈/ Q/ ;/ …/ 继续/ 这一/ 过程/ ,/ 直至/ T/ 的/ 所有/ 顶点/ 均/ 已/ 标号/ ./ 因为/ T/ 的/ 每个/ 顶点/ 用/ 标号/ D/ 恰好/ 标号/ 一次/ ,/ 故/ 标号/ D/ 可/ 在/ O/ (/ n/ )/ 时间/ 内/ 完成/ ./ 显然/ ,/ 如果/ T/ 是/ 路径/ ,/ 则/ Q/ 只/ 包含/ 根/ v0/ ;/ 否则/ ,/ Q/ 的/ 首/ 元素/ (/ 即栈/ 顶/ 元素/ )/ 是/ 使/ |/ E/ (/ v0/ ~/ v/ )/ |/ 最大/ 的/ d/ (/ v/ )/ / 3/ 的/ 顶点/ v/ ,/ 即/ Q/ 的/ 栈顶/ 元素/ v/ 是/ T/ 的/ 深度/ 最大/ 的/ 使/ d/ (/ v/ )/ / 3/ 的/ 顶点/ ./ 定义/ 3/ ./ 设/ v/ ∈/ V/ (/ T/ )/ ,/ T/ (/ v/ ,/ x/ )/ 是/ v/ 的/ 一个/ 分支/ ,/ 如果/ v0/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ (/ 即/ T/ (/ v/ ,/ x/ )/ 的/ 顶点/ 或者/ 为/ v/ 、/ 或者/ 是/ v/ 的/ 后代/ )/ ,/ 则/ 称/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 后代/ 分支/ ./ 注/ 2/ ./ 对于/ v/ ∈/ V/ (/ T/ )/ ,/ v/ 的/ 后代/ 分支/ 与/ v/ 的/ 子女/ 形成/ 一一对应/ 的/ 关系/ ./ 可以/ 把/ v/ 的/ 子女/ 看作/ 是/ 从左到右/ 排列/ 的/ ,/ 即/ 把/ v/ 的/ 后代/ 分支/ 也/ 看作/ 是/ 从左到右/ 排列/ 的/ ./ 显然/ ,/ 若/ T/ (/ v/ ,/ x/ )/ 是/ v/ 的/ 一个/ 后代/ 分支/ ,/ 则/ 存在/ T/ 的/ 端/ 顶点/ y/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ y/ ≠/ v/ ,/ 使/ y/ 是/ T/ (/ v/ ,/ x/ )/ 中/ 标号/ 最大/ 的/ 顶点/ ./ 把/ T/ 的/ 所有/ 顶点/ 分为/ 3/ 类/ :/ 未/ 检查/ 、/ 已/ 检查和/ 待/ 检查/ ,/ T/ 的/ 每个/ 顶点/ 属于/ 且/ 仅/ 属于/ 其中/ 某/ 一类/ ./ 定义/ 4/ ./ 设/ v/ ∈/ V/ (/ T/ )/ ,/ T/ (/ v/ ,/ x/ )/ 是/ v/ 的/ 一个/ 分支/ ,/ 如果/ T/ (/ v/ ,/ x/ )/ -/ v/ 的/ 所有/ 顶点/ 均/ 为/ 已/ 检查/ 顶点/ ,/ 则/ 称/ T/ (/ v/ ,/ x/ )/ 为/ 已/ 检查/ (/ 的/ )/ 分支/ ;/ 否则/ 称/ T/ (/ v/ ,/ x/ )/ 为/ 未/ 检查/ (/ 的/ )/ 分支/ ./ 将/ T/ (/ v/ ,/ x/ )/ 标为/ 已/ 检查/ 是/ 指/ 将/ T/ (/ v/ ,/ x/ )/ -/ v/ 的/ 所有/ 顶点/ 标为/ 已/ 检查/ ./ 特别/ 地/ ,/ 如果/ T/ (/ v/ ,/ x/ )/ 是/ v/ 的/ 一个/ 后代/ 分支/ ,/ 则/ T/ (/ v/ ,/ x/ )/ 为/ 已/ 检查/ 分支/ 当且/ 仅/ 当/ v/ 的/ 所有/ 后代/ 均/ 为/ 已/ 检查/ 顶点/ ;/ 将/ T/ (/ v/ ,/ x/ )/ 标为/ 已/ 检查/ 是/ 指/ 将/ T/ (/ v/ ,/ x/ )/ 中/ 的/ v/ 的/ 全部/ 后代/ 标为/ 已/ 检查/ ./ 定义/ 5/ ./ 设/ v/ ∈/ V/ (/ T/ )/ ,/ T/ (/ v/ ,/ xi/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ ,/ k/ / 0/ )/ 为/ v/ 的/ 全部/ (/ 不同/ 的/ )/ 已/ 检查/ 的/ 后代/ 分支/ ,/ 其中/ xi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ k/ )/ 为/ T/ 的/ 端/ 顶点/ 且/ 是/ T/ (/ v/ ,/ xi/ )/ 中/ 具有/ 最大/ 标号/ 的/ 顶点/ ,/ l/ (/ x1/ )/ / l/ (/ x2/ )/ / …/ / l/ (/ xk/ )/ ;/ 记/ Tv/ 为/ v/ 的/ 全部/ 已/ 检查/ 的/ 后代/ 分支/ 在/ v/ 的/ 粘合/ 子树/ ,/ 即/ Tv/ =/ T/ (/ v/ ,/ x1/ )/ ○/ vT/ (/ v/ ,/ x2/ )/ ○/ v/ …/ ○/ vT/ (/ v/ ,/ xk/ )/ ./ 定义/ v/ 处/ 的/ 二元/ 组/ (/ v/ (/ 1/ )/ ,/ v/ (/ 2/ )/ )/ 如下/ :/ 当/ k/ / 1/ 时/ 定义/ v/ (/ 1/ )/ =/ x1/ ,/ 否则/ v/ (/ 1/ )/ =/ v/ ;/ 当/ k/ / 2/ 时/ 定义/ v/ (/ 2/ )/ =/ x2/ ,/ 否则/ v/ (/ 2/ )/ =/ v/ ./ 注意/ ,/ 当/ k/ =/ 0/ 时/ ,/ Tv/ =/ / ,/ d/ (/ Tv/ )/ =/ 0/ ./ 特别/ 地/ ,/ 因为/ 端/ 顶点/ (/ 除/ v0/ 外/ )/ 没有/ 后代/ 分支/ ,/ 故/ 对于/ 任意/ 端/ 顶点/ v/ (/ v/ ≠/ v0/ )/ :/ v/ (/ 1/ )/ =/ v/ ,/ v/ (/ 2/ )/ =/ v/ ,/ Tv/ =/ / ./ 3.1/ 算法/ 对于/ 树/ T/ ,/ 算法/ 1/ 通过/ 自/ 底向上/ 检查/ d/ (/ v/ )/ / 3/ 的/ 顶点/ v/ (/ 即/ 自顶/ 向/ 底/ 检查/ 栈/ Q/ 中/ 的/ 元素/ )/ 、/ 从左到右/ 考虑/ v/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ 等/ 方法/ 求解/ π/ d/ (/ T/ )/ 及/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ Π/ / d/ (/ T/ )/ ./ 主要/ 步骤/ 如下/ :/ 1/ ./ 初始/ 时/ ,/ 将/ T/ 的/ 所有/ 端/ 顶点/ v/ (/ v/ ≠/ v0/ )/ 标为/ 待/ 检查/ ,/ 其余/ 顶点/ 标为/ 未/ 检查/ ./ 因此/ ,/ 初始/ 时/ ,/ 对于/ 一切/ v/ ∈/ V/ (/ T/ )/ ,/ 有/ v/ (/ 1/ )/ =/ v/ ,/ v/ (/ 2/ )/ =/ v/ ,/ d/ (/ Tv/ )/ =/ 0/ ./ 但/ 算法/ 1/ 只用/ 到/ 了/ v/ ∈/ Q/ 和/ v/ 为端/ 顶点/ 的/ (/ v/ (/ 1/ )/ ,/ v/ (/ 2/ )/ )/ 及/ d/ (/ Tv/ )/ ;/ 因此/ ,/ 算法/ 1/ 在/ 执行/ 过程/ 中仅/ 更新/ 这些/ 顶点/ 的/ (/ v/ (/ 1/ )/ ,/ v/ (/ 2/ )/ )/ 及/ d/ (/ Tv/ )/ ./ 2/ ./ 取/ Q/ 的/ 栈顶/ 元素/ v/ ,/ 考虑/ v/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ ,/ 转步/ 3/ ./ 当/ 不/ 存在/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ 时/ ,/ 如果/ v/ =/ v0/ 则/ d/ (/ T/ )/ / d/ ,/ T/ 作为/ Π/ / d/ (/ T/ )/ 的/ 一个/ 元素/ ,/ 结束/ ;/ 否则/ 将/ v/ 标为/ 待/ 检查/ ,/ 并/ 从/ Q/ 中/ 删除/ v/ ,/ 转步/ 2.3/ ./ 如果/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ >/ d/ ,/ 则/ 从/ T/ (/ v/ ,/ x/ )/ 中/ 找出/ Π/ / d/ (/ T/ )/ 的/ 一个/ 元素/ ,/ 并/ 进行/ 相关/ 的/ 更新/ ,/ 转步/ 2/ ;/ 否则/ 转步/ 4.4/ ./ 如果/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ >/ d/ ,/ 则/ T/ (/ v/ ,/ x/ )/ -/ v/ 、/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ 中必/ 有/ 某/ 一个/ 可/ 作为/ Π/ / d/ (/ T/ )/ 的/ 一个/ 元素/ ,/ 辨出/ 之/ ,/ 并/ 进行/ 相关/ 的/ 更新/ ,/ 转步/ 2/ ;/ 否则/ 转步/ 5.5/ ./ 将/ T/ (/ v/ ,/ x/ )/ 标为/ 已/ 检查/ ,/ 并/ 进行/ 相关/ 的/ 更新/ ,/ 转步/ 2/ ./ 以上/ 步/ 3/ 、/ 4/ 需要/ 计算/ 相关/ 子树/ 的/ 直径/ ,/ 常规/ 方法/ 计算/ 树/ 的/ 直径/ 需要/ 线性/ 时间/ (/ 例如/ 见/ 文献/ [/ 22/ ]/ )/ ./ 这里/ 提供/ 了/ 一种/ 方法/ ,/ 用/ 常数/ 时间/ 计算/ 相关/ 子树/ 的/ 直径/ (/ 见/ 算法/ 1/ 及/ 3.2/ 节/ 、/ 3.3/ 节/ 的/ 讨论/ )/ ,/ 从而/ 计算/ 所有/ 的/ 相关/ 子树/ 的/ 直径/ 才/ 耗费/ 线性/ 时间/ ./ 具体/ 算法/ 如下/ ./ 算法/ 1/ ./ 求解/ 边/ 赋非/ 负权/ 树/ 的/ d/ -/ 子树/ 划分/ 问题/ ./ 输入/ :/ 树/ T/ (/ n/ / 1/ )/ ,/ 常数/ d/ / 0/ ./ 输出/ :/ π/ d/ (/ T/ )/ 及/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ Π/ / d/ (/ T/ )/ ./ Page5/ 初始化/ :/ π/ d/ (/ T/ )/ =/ 0/ ;/ Π/ / d/ (/ T/ )/ =/ / ;/ 将/ T/ 按/ 标号/ D/ 标号/ 并/ 构造/ Q/ ;/ // // 片段/ 1/ 将/ T/ 的/ 所有/ 端/ 顶点/ v/ (/ v/ ≠/ v0/ )/ 标为/ 待/ 检查/ ,/ 其余/ 顶点/ 对于/ 一切/ v/ ∈/ Q/ 或/ v/ 为端/ 顶点/ ,/ v/ (/ 1/ )/ =/ v/ ,/ v/ (/ 2/ )/ =/ v/ ,/ d/ (/ Tv/ )/ =/ 0/ ;/ whileV/ (/ T/ )/ ≠/ / {/ 取/ Q/ 的/ 栈顶/ 元素/ v/ ;/ // // 对应/ 引理/ 1/ 如果/ 不/ 存在/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ // // 片段/ 4/ {/ }/ 取/ v/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ ;/ // // 片段/ 7/ 取/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ (/ u/ ≠/ v/ )/ ;/ 如果/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ >/ d/ // // 对应/ 引理/ 6/ {/ }/ // // 以下/ 处理/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / d/ 的/ 情形/ 如果/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ // // 对应/ 引理/ 4/ 、/ 引理/ 7/ {/ }/ // // 以下/ 处理/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / d/ 且/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ {/ }/ {/ }/ }/ // // 循环/ 结束/ 输出/ π/ d/ (/ T/ )/ 、/ Π/ / d/ (/ T/ )/ ;/ 结束/ ./ 3.2/ 算法/ 的/ 正确性/ 除非/ 特别/ 声明/ ,/ 本/ 小节/ 及/ 3.3/ 节所/ 讨论/ 的/ T/ 、/ Q/ 分别/ 指/ 算法/ 1/ 执行/ 过程/ 中/ 任何/ 阶段/ 的/ T/ 、/ Q/ ;/ T0/ 、/ Q0/ 分别/ 为/ 算法/ 1/ 初始/ 时/ 的/ T/ 、/ Q/ ./ 性质/ 1/ ./ 设/ T1/ 为/ T/ 的/ 子树/ ,/ v/ ∈/ V/ (/ T/ )/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 任意/ 分支/ ,/ 则/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 是/ 树/ ./ 特别/ 地/ ,/ 如果/ T/ 是/ 以/ v0/ 为根/ 的/ 有/ 根树/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 任意/ 后代/ 分支/ ,/ 则/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 是/ 以/ v0/ 为根/ 的/ 有/ 根树/ ./ 证明/ ./ 记/ T/ =/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ./ 因为/ T/ 不/ 含有/ 圈/ ,/ 故/ 只/ 需/ 证明/ T/ 连通/ ./ 反证/ ,/ 设/ 存在/ y/ ,/ z/ ∈/ V/ (/ T/ )/ ,/ y/ ,/ z/ 在/ T/ 中/ 不/ 存在/ 路径/ 相连/ ./ 因为/ y/ ,/ z/ 在/ T1/ 中有/ 路径/ 相连/ ,/ 故/ 存在/ 路径/ P/ =/ (/ y/ ~/ z/ )/ ,/ P/ / T1/ 但/ P/ / // T/ ./ 因此/ ,/ P/ 含有/ T/ (/ v/ ,/ x/ )/ -/ v/ 中/ 的/ 顶点/ u/ ./ 又/ 因/ v/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ 故/ u/ ≠/ v/ ./ 因为/ T1/ 是/ 树/ ,/ 且/ y/ ,/ z/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ 故/ 从/ y/ 到/ u/ 先必/ 经过/ v/ 才能/ 达到/ u/ ,/ 从/ u/ 到/ z/ 也/ 必须/ 最后/ 经过/ v/ 才能/ 离开/ T/ (/ v/ ,/ x/ )/ ./ 这样/ ,/ P/ / (/ y/ ~/ v/ )/ ∪/ (/ v/ ~/ u/ )/ ∪/ (/ u/ ~/ v/ )/ ∪/ (/ v/ ~/ z/ )/ ./ 但/ (/ v/ ~/ u/ )/ ∪/ (/ u/ ~/ v/ )/ 含有/ 圈/ ,/ 与/ P/ 是/ 路径/ 相/ 矛盾/ ./ 因此/ ,/ Page6T/ 是/ 树/ ./ 特别/ 地/ ,/ 取/ T1/ =/ T/ ,/ T/ =/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ =/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 是/ 树/ ./ 而/ 当/ T/ 是/ 以/ v0/ 为根/ 的/ 有/ 根树/ 、/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 后代/ 分支/ 时/ ,/ 因为/ T/ (/ v/ ,/ x/ )/ -/ v/ 的/ 所有/ 顶点/ 都/ 是/ v/ 的/ 后代/ ,/ 故/ v0/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ 即/ v0/ ∈/ V/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ,/ 从而/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ 是/ 以/ v0/ 为根/ 的/ 有/ 根树/ ./ 由此/ ,/ 容易/ 得到/ 性质/ 2/ ~/ 性质/ 4/ ./ 性质/ 2/ ./ 设/ v/ ∈/ V/ (/ T/ )/ ,/ u/ 为/ v/ 的/ 后代/ ,/ 则/ l/ (/ u/ )/ =/ l/ (/ v/ )/ +/ d/ (/ u/ ,/ v/ )/ ./ 性质/ 3/ ./ 设/ v/ ∈/ V/ (/ T/ )/ ,/ T/ (/ v/ ,/ xi/ )/ (/ i/ =/ 1/ ,/ 2/ )/ 为/ v/ 的/ 任意/ 两个/ 不同/ 的/ 分支/ ,/ 则/ 对/ 任意/ yi/ ∈/ V/ (/ T/ (/ v/ ,/ xi/ )/ )/ (/ i/ =/ 1/ ,/ 2/ )/ ,/ d/ (/ y1/ ,/ y2/ )/ =/ d/ (/ y1/ ,/ v/ )/ +/ d/ (/ y2/ ,/ v/ )/ ./ 特别/ 地/ ,/ 如果/ T/ (/ v/ ,/ xi/ )/ (/ i/ =/ 1/ ,/ 2/ )/ 为/ v/ 的/ 任意/ 两个/ 不同/ 的/ 后代/ 分支/ ,/ 则/ 对/ 任意/ yi/ ∈/ V/ (/ T/ (/ v/ ,/ xi/ )/ )/ (/ i/ =/ 1/ ,/ 2/ )/ ,/ d/ (/ y1/ ,/ y2/ )/ =/ l/ (/ y1/ )/ +/ l/ (/ y2/ )/ -/ 2l/ (/ v/ )/ ./ 性质/ 4/ ./ 树/ 的/ 直径/ 不/ 小于/ 其/ 任何/ 子树/ 的/ 直径/ ./ 性质/ 5/ [/ 22/ ]/ ./ 设/ |/ V/ (/ T/ )/ |/ / 2/ ,/ u/ ,/ v/ ∈/ V/ (/ T/ )/ ,/ v/ 是/ T/ 的/ 端/ 顶点/ 且/ 使/ d/ (/ u/ ,/ v/ )/ =/ maxx/ ∈/ V/ (/ T/ )/ d/ (/ u/ ,/ x/ )/ (/ 即/ v/ 是/ 离/ u/ 最远/ 的/ 顶点/ )/ ,/ 则/ 存在/ T/ 的/ 直径/ 路/ P/ 使/ v/ ∈/ V/ (/ P/ )/ ./ 引理/ 1/ ./ 若/ V/ (/ T/ )/ ≠/ / ,/ 则/ v0/ ∈/ V/ (/ T/ )/ ,/ v0/ ∈/ Q/ ./ 证明/ ./ 算法/ 1/ 对/ T/ 的/ 更新/ 是/ 在/ 片段/ 5/ 通过/ 置/ T/ =/ / (/ 更新/ 后/ 的/ T/ 不/ 满足/ 引理/ 的/ 条件/ )/ 、/ 在/ 片段/ 10/ 、/ 片段/ 12/ 、/ 片段/ 14/ 通过/ / 运算/ 进行/ 的/ ./ 由/ 性质/ 1/ ,/ 通过/ / 运算/ 更新/ 后/ 的/ T/ 仍/ 有/ v0/ ∈/ V/ (/ T/ )/ ./ Q/ 是/ 在/ 片段/ 1/ (/ 指/ 算法/ 1/ 的/ 片段/ 1/ ,/ 下/ 类同/ ./ 不再/ 一一/ 说明/ )/ 建立/ 的/ ,/ 初始/ 的/ Q/ 满足/ v0/ ∈/ Q/ ./ 对/ Q/ 的/ 更新/ 仅/ 在/ 片段/ 6/ 进行/ ./ 显然/ ,/ 直至/ 算法/ 1/ 结束/ 仍然/ 有/ v0/ ∈/ Q/ ./ 引理/ 2/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ 则/ (/ 1/ )/ 在/ T/ (/ v/ ,/ x/ )/ 中/ ,/ 存在/ 唯一/ 的/ 待/ 检查/ 顶点/ u/ ,/ 且/ (/ 2/ )/ 对/ 一切/ y/ ∈/ V/ (/ u/ ~/ v/ )/ (/ y/ ≠/ u/ ,/ y/ ≠/ v/ )/ ,/ 都/ 有/ y/ (/ 3/ )/ u/ 的/ 全部/ 后代/ 分支/ 均/ 是/ 已/ 检查/ 分支/ ./ 证明/ ./ (/ 1/ )/ 首先/ 证明/ u/ 的/ 存在/ 性/ ./ 设/ u/ 是/ T/ (/ v/ ,/ x/ )/ 中使/ |/ E/ (/ u/ ~/ v/ )/ |/ 最大/ 的/ 非/ 已/ 检查/ 顶点/ (/ 即/ u/ 是/ T/ (/ v/ ,/ x/ )/ 中/ 深度/ 最大/ 的/ 非/ 已/ 检查/ 顶点/ ./ u/ 可能/ 是/ 待/ 检查/ 顶点/ ,/ 也/ 可能/ 是/ 未/ 检查/ 顶点/ )/ ./ 由/ |/ E/ (/ u/ ~/ v/ )/ |/ 的/ 最大/ 性知/ ,/ u/ 的/ 所有/ 后代/ 分支/ 都/ 为/ 已/ 检查/ 分支/ ./ 因此/ ,/ u/ ≠/ v/ ./ 而/ u/ 为/ v/ 的/ 后代/ 表明/ u/ ≠/ v0/ ./ 由/ 引理/ 1/ 知/ v0/ ∈/ V/ (/ T/ )/ ,/ 故/ u/ 不是/ 孤立/ 点/ ./ u/ ≠/ v/ ,/ u/ ≠/ v0/ ,/ u/ 不是/ 孤立/ 点/ ;/ 为/ 未/ 检查/ 顶点/ 且/ d/ (/ y/ )/ =/ 2/ ;/ 我们/ 有/ :/ u/ 必定/ 是/ 待/ 检查/ 顶点/ ./ 反证/ ,/ 设/ u/ 是/ 未/ 检查/ 顶点/ ./ 首先/ ,/ u/ / Q0/ ./ 否则/ ,/ u/ ∈/ Q0/ ./ 因为/ v/ 是/ Q/ 的/ 栈顶/ 元素/ 、/ u/ 为/ v/ 的/ 后代/ ,/ 故/ u/ / Q/ ./ 因此/ ,/ 按/ 算法/ 1/ ,/ u/ 或者/ 标为/ 待/ 检查/ (/ 片段/ 6/ )/ ,/ 或者/ 标为/ 已/ 检查/ (/ 片段/ 13/ 、/ 片段/ 16/ )/ ,/ 与/ u/ 是/ 未/ 检查/ 顶点/ 的/ 假设/ 相/ 矛盾/ ./ 其次/ ,/ 对/ u/ / Q0/ ,/ u/ 不会/ 是/ 端/ 顶点/ ,/ 因为/ 算法/ 1/ 将/ 端/ 顶点/ (/ 除/ v0/ 外/ )/ 或者/ 标为/ 待/ 检查/ (/ 片段/ 2/ 、/ 片段/ 11/ )/ ,/ 或者/ 标为/ 已/ 检查/ (/ 片段/ 13/ 、/ 片段/ 16/ )/ ./ 因此/ ,/ u/ 不是/ 端/ 顶点/ ,/ 且/ u/ / Q0/ ./ u/ 不是/ 端/ 顶点/ 也/ 不是/ 孤立/ 点/ 表明/ u/ 至少/ 有/ 一个/ 后代/ u/ (/ 注意/ u/ 是/ 已/ 检查/ 顶点/ )/ ./ 按/ 算法/ 1/ ,/ u/ 成为/ 已/ 检查/ 顶点/ 必定/ 是/ 在/ 考虑/ 离/ u/ 最近/ 的/ 祖先/ w/ ∈/ Q0/ 时/ ,/ 将/ w/ 的/ u/ 所在/ 的/ 后代/ 分支/ 标为/ 已/ 检查/ 所致/ ./ 作为/ w/ 的/ 后代/ u/ 也/ 将/ 同时/ 标为/ 已/ 检查/ (/ 片段/ 13/ 、/ 片段/ 16/ )/ ,/ 与/ u/ 是/ 未/ 检查/ 顶点/ 的/ 假设/ 相/ 矛盾/ ./ 因此/ ,/ u/ 必定/ 是/ 待/ 检查/ 顶点/ ./ 下面/ 证明/ u/ 的/ 唯一性/ ./ 设/ u1/ ≠/ v/ ,/ u2/ ≠/ v/ ,/ 且/ u1/ ,/ u2/ 为/ T/ (/ v/ ,/ x/ )/ 上/ 的/ 两个/ 待/ 检查/ 顶点/ ./ 情形/ 1/ ./ u1/ 位于/ u2/ 的/ 某个/ 后代/ 分支/ 上/ ./ 按/ 算法/ 1/ ,/ 当/ u2/ 标为/ 待/ 检查/ 时/ ,/ 必定/ 有/ 它/ 的/ 所有/ 后代/ 均/ 为/ 已/ 检查/ 顶点/ ,/ 故/ u1/ 为/ 已/ 检查/ 顶点/ ./ 矛盾/ ./ 类似/ 讨论/ u2/ 位于/ u1/ 的/ 某个/ 后代/ 分支/ 上/ 的/ 情形/ ./ 情形/ 2/ ./ u1/ 不/ 在/ u2/ 的/ 任何/ 后代/ 分支/ 上/ ,/ 且/ u2/ 不/ 在/ u1/ 的/ 任何/ 后代/ 分支/ 上/ ./ 此时/ 路径/ (/ u1/ ~/ v/ )/ 、/ (/ u2/ ~/ v/ )/ 必在/ T/ (/ v/ ,/ x/ )/ -/ v/ 上/ 相交/ ,/ 设/ y/ 是/ 标号/ 最大/ 的/ 交点/ ./ 因此/ ,/ d/ (/ y/ )/ / 3/ ,/ 即/ y/ ∈/ Q0/ ./ 因为/ v/ 是/ Q/ 的/ 栈顶/ 元素/ 、/ y/ 为/ v/ 的/ 后代/ ,/ 故/ y/ / Q/ ./ 因此/ ,/ 按/ 算法/ 1/ ,/ y/ 要么/ 是/ 已/ 检查/ 顶点/ ,/ 要么/ 是/ 待/ 检查/ 顶点/ ./ 不论是/ 何种/ 情况/ 出现/ ,/ 作为/ y/ 的/ 后代/ ,/ u1/ ,/ u2/ 均/ 是/ 已/ 检查/ 顶点/ ./ 矛盾/ ./ 综上所述/ ,/ 在/ T/ (/ v/ ,/ x/ )/ 中/ ,/ 存在/ 唯一/ 的/ 待/ 检查/ 顶点/ u/ ,/ 且/ u/ ≠/ v/ ./ (/ 2/ )/ 先/ 证明/ 对/ 一切/ y/ ∈/ V/ (/ u/ ~/ v/ )/ (/ y/ ≠/ u/ ,/ y/ ≠/ v/ )/ ,/ 都/ 有/ y/ 为/ 未/ 检查/ 顶点/ ./ 反证/ ,/ 设/ 存在/ y/ ∈/ V/ (/ u/ ~/ v/ )/ (/ y/ ≠/ u/ ,/ y/ ≠/ v/ )/ ,/ y/ 是/ 待/ 检查/ 顶点/ 或是/ 已/ 检查/ 顶点/ ./ 情形/ 1/ ./ y/ 是/ 待/ 检查/ 顶点/ ./ 按/ 算法/ 1/ ,/ y/ 要么/ 是/ 端/ 顶点/ (/ 但/ y/ 有/ 后代/ u/ ,/ 矛盾/ )/ ,/ 要么/ y/ ∈/ Q0/ (/ 此时/ ,/ 类似/ 上面/ 的/ 分析/ 可/ 得/ ,/ y/ 的/ 所有/ 后代/ 均/ 为/ 已/ 检查/ 顶点/ ,/ 但/ 其/ 后代/ u/ 却是/ 待/ 检查/ 顶点/ ,/ 矛盾/ )/ ./ 因此/ ,/ y/ 不是/ 待/ 检查/ 顶点/ ./ 情形/ 2/ ./ y/ 是/ 已/ 检查/ 顶点/ ./ 按/ 算法/ 1/ ,/ y/ 成为/ 已/ 检查/ 顶点/ 必定/ 是/ 在/ 考虑/ 离/ y/ 最近/ 的/ 祖先/ w/ ∈/ Q0/ 时/ ,/ 将/ w/ 的/ y/ 所在/ 的/ 后代/ 分支/ 标为/ 已/ 检查/ 所致/ ./ 因为/ y/ 的/ Page7/ 后代/ u/ 也/ 是/ w/ 的/ 后代/ ,/ u/ 将/ 同时/ 标为/ 已/ 检查/ ./ 矛盾/ ./ 因此/ ,/ y/ 为/ 未/ 检查/ 顶点/ ./ 再/ 证明/ d/ (/ y/ )/ =/ 2/ ./ 反证/ ,/ 设/ 存在/ y/ ∈/ V/ (/ u/ ~/ v/ )/ ,/ y/ ≠/ u/ ,/ y/ ≠/ v/ ,/ 使/ d/ (/ y/ )/ ≠/ 2/ ./ 因为/ y/ 有/ 后代/ u/ ,/ 故/ y/ 不是/ 端/ 顶点/ 、/ 也/ 不是/ 孤立/ 点/ ./ 从而/ d/ (/ y/ )/ / 3/ ,/ 即/ y/ ∈/ Q0/ ./ 类似/ 上面/ 的/ 分析/ 可/ 得/ ,/ y/ 要么/ 是/ 已/ 检查/ 顶点/ ,/ 要么/ 是/ 待/ 检查/ 顶点/ ./ 不论是/ 何种/ 情况/ 出现/ ,/ y/ 的/ 后代/ u/ 必为/ 已/ 检查/ 顶点/ ./ 矛盾/ ./ (/ 3/ )/ 上述/ 证明/ 过程/ (/ 1/ )/ 已经/ 证明/ ./ 证毕/ ./ 注/ 3/ ./ v/ 、/ T/ (/ v/ ,/ x/ )/ 如/ 引理/ 2/ 所设/ ./ 算法/ 1/ 只/ 对/ 除/ v0/ 外/ 的/ 端/ 顶点/ 、/ Q0/ 中/ 的/ 元素/ 标为/ 待/ 检查/ ,/ 且/ v0/ 永远/ 是/ 未/ 检查/ 顶点/ ./ 因此/ ,/ 引理/ 2/ 中/ 的/ u/ 要么/ 是/ 端/ 顶点/ ,/ 要么/ 是/ Q0/ 中/ 的/ 元素/ ;/ u/ (/ 1/ )/ 为/ T/ 和/ T/ (/ v/ ,/ x/ )/ 的/ 端/ 顶点/ 且/ 是/ T/ (/ v/ ,/ x/ )/ 中/ 具有/ 最大/ 标号/ 的/ 顶点/ ./ 此外/ ,/ 根据/ 引理/ 2/ (/ 2/ )/ ,/ 可/ 通过/ 以下/ 方法/ 在/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ 中/ 寻找/ 唯一/ 的/ 待/ 检查/ 顶点/ u/ :/ 从/ v/ 出发/ ,/ 如果/ v/ 的/ 唯一/ 子女/ x1/ 为/ 待/ 检查/ 顶点/ ,/ 则/ u/ =/ x1/ ;/ 否则/ 考虑/ x1/ 的/ 唯一/ 子女/ x2/ ./ 如果/ x2/ 为/ 待/ 检查/ 顶点/ ,/ 则/ u/ =/ x2/ ;/ 否则/ 考虑/ x2/ 的/ 唯一/ 子女/ x3/ ,/ …/ ,/ 最后/ 必/ 能/ 找到/ 待/ 检查/ 顶点/ u/ ./ 根据/ 引理/ 2/ (/ 2/ )/ 和/ 性质/ 5/ ,/ 易得/ 下面/ 性质/ ./ 性质/ 6/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ }/ ./ 引理/ 3/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ./ (/ 1/ )/ 如果/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ (/ 2/ )/ 如果/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ 且/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 2/ )/ )/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ d/ (/ Tv/ )/ ./ (/ 3/ )/ 如果/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 2/ )/ )/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ 证明/ ./ 根据/ 性质/ 4/ 有/ 后代/ 分支/ 上/ ./ 由/ 性质/ 3/ 有/ 情形/ 1/ ./ V/ (/ Tv/ )/ ≠/ / ./ 此时/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ 在/ v/ 的/ 不同/ d/ (/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ (/ 3/ )/ 由/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ / d/ (/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ )/ 知/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ / l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ (/ 4/ )/ 情形/ 2/ ./ V/ (/ Tv/ )/ =/ / ./ 此时/ v/ (/ 1/ )/ =/ v/ ./ 由/ 性质/ 2/ ,/ d/ (/ u/ (/ 1/ )/ ,/ v/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ ./ 故式/ (/ 3/ )/ 成立/ ,/ 从而/ 式/ (/ 4/ )/ 仍然/ 成立/ ./ (/ 1/ )/ 因为/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ ,/ 故/ u/ (/ 1/ )/ 为/ T/ 的/ 端/ 顶点/ 且/ 是/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 中/ 具有/ 最大/ 标号/ 的/ 顶点/ ,/ 即/ u/ (/ 1/ )/ 是/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 中离/ v/ 最远/ 的/ 端/ 顶点/ ./ 由/ 性质/ 5/ 知/ ,/ 存在/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 的/ 直/ 路径/ (/ u/ (/ 1/ )/ ~/ y/ )/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ y/ )/ ,/ 其中/ y/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ ./ 情形/ 1/ ./ y/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ )/ ./ 因为/ u/ (/ 1/ )/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ 故/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ / d/ (/ u/ (/ 1/ )/ ,/ y/ )/ =/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ ./ 结合/ 式/ (/ 1/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ ;/ 再/ 结合/ 式/ (/ 4/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ / l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ./ 从而/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 情形/ 2/ ./ y/ ∈/ V/ (/ Tv/ )/ ./ 因为/ y/ =/ v/ 可归为/ 情形/ 1/ ,/ 不妨/ 设/ y/ ≠/ v/ ./ 从而/ y/ 在/ v/ 的/ 某个/ 已/ 检查/ 的/ 后代/ 分支/ 中/ ./ 由/ 性质/ 3/ 有/ d/ (/ u/ (/ 1/ )/ ,/ y/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ y/ )/ -/ 2l/ (/ v/ )/ ./ 因为/ l/ (/ v/ (/ 1/ )/ )/ / l/ (/ y/ )/ ,/ 故/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ / l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ y/ )/ -/ 2l/ (/ v/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ y/ )/ =/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ ./ 结合/ 式/ (/ 4/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ;/ 再/ 结合/ 式/ (/ 1/ )/ 有/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ / d/ (/ T/ (/ v/ ,/ x/ )/ )/ ./ 从而/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 由/ 性质/ 6/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ }/ ./ 又/ 因/ v/ (/ 1/ )/ 是/ v/ 的/ 后代/ ,/ 故/ l/ (/ v/ (/ 1/ )/ )/ / l/ (/ v/ )/ ,/ 即得/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ./ 从而/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 结论/ (/ 1/ )/ 得证/ ./ (/ 2/ )/ 因为/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ )/ ,/ 再/ 由/ 条件/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ 有/ l/ (/ v/ (/ 1/ )/ )/ >/ l/ (/ v/ )/ ,/ 故/ v/ (/ 1/ )/ ≠/ v/ ,/ 即/ Tv/ 是非/ 空/ 的/ 树/ ,/ v/ (/ 1/ )/ 是/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 中离/ v/ 最远/ 的/ 端/ 顶点/ ./ 由/ 性质/ 5/ 知/ ,/ 存在/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 的/ 直/ 路径/ (/ v/ (/ 1/ )/ ~/ y/ )/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ ,/ 其中/ y/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ ./ 情形/ 1/ ./ y/ ∈/ V/ (/ T/ (/ v/ ,/ x/ )/ )/ ./ 由/ 性质/ 3/ ,/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ =/ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ y/ )/ -/ 2l/ (/ v/ )/ ./ 因为/ l/ (/ y/ )/ / l/ (/ u/ (/ 1/ )/ )/ ,/ 故/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ / l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ u/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ./ 结合/ 式/ (/ 4/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ u/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ;/ 再/ 结合/ 式/ (/ 2/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ Page8/ 情形/ 2/ ./ y/ ∈/ V/ (/ Tv/ )/ ./ 因/ (/ v/ (/ 1/ )/ ~/ y/ )/ 是/ Tv/ 中/ 的/ 路径/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ / d/ (/ Tv/ )/ ./ 结合/ 式/ (/ 2/ )/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ Tv/ )/ ;/ 再/ 结合/ 式/ (/ 4/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ (/ 3/ )/ 由/ 条件/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 2/ )/ )/ 知/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ ,/ 即/ v/ (/ 1/ )/ 为/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 中离/ v/ 最远/ 的/ 端/ 顶点/ ./ 由/ 性质/ 5/ 知/ ,/ 存在/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ 的/ 直/ 路径/ (/ v/ (/ 1/ )/ ~/ y/ )/ ./ 我们/ 有/ y/ / V/ (/ T/ (/ v/ ,/ x/ )/ )/ ./ 否则/ ,/ 由/ 性质/ 3/ ,/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ =/ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ y/ )/ -/ 2l/ (/ v/ )/ / l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ u/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ </ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ v/ (/ 2/ )/ )/ / d/ (/ Tv/ )/ ,/ 即/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ </ d/ (/ Tv/ )/ ,/ 与/ 式/ (/ 2/ )/ 相/ 矛盾/ ./ 因此/ ,/ y/ ∈/ V/ (/ Tv/ )/ ,/ 即/ (/ v/ (/ 1/ )/ ~/ y/ )/ 是/ Tv/ 中/ 的/ 路径/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ v/ (/ 1/ )/ ,/ y/ )/ / d/ (/ Tv/ )/ ;/ 再/ 结合/ 式/ (/ 2/ )/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ d/ (/ Tv/ )/ ./ 证毕/ ./ 注/ 4/ ./ v/ 、/ T/ (/ v/ ,/ x/ )/ 、/ u/ 如/ 引理/ 3/ 所设/ ./ 算法/ 1/ 在/ 片段/ 16/ 将/ T/ (/ v/ ,/ x/ )/ 标为/ 已/ 检查/ 后/ ,/ 引理/ 3/ 表明/ ,/ 算法/ 1/ 正确/ 地/ 计算/ 了/ d/ (/ Tv/ )/ 的/ 新值/ ./ 其中/ ,/ 引理/ 3/ (/ 3/ )/ 表明/ ,/ 若/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 2/ )/ )/ ,/ d/ (/ Tv/ )/ 保持/ 不变/ ./ 引理/ 3/ (/ 1/ )/ 、/ (/ 2/ )/ 表明/ ,/ 若/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 2/ )/ )/ ,/ 按/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ 是否/ 成立/ ,/ 片段/ 17/ 、/ 片段/ 18/ 分别/ 正确/ 地/ 计算/ 了/ d/ (/ Tv/ )/ 的/ 新值/ ;/ 且/ d/ (/ Tv/ )/ 的/ 新值/ 只/ 与其/ 原值/ 或/ d/ (/ Tu/ )/ 以及/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ 有关/ ./ 而/ 在/ 计算/ d/ (/ Tv/ )/ 的/ 新值/ 时/ ,/ d/ (/ Tu/ )/ 是/ 已知/ 的/ ./ 事实上/ ,/ 因/ u/ 为/ 待/ 检查/ 顶点/ ,/ 若/ u/ 是/ 端/ 顶点/ ,/ 算法/ 1/ 在/ 片段/ 3/ 和/ 片段/ 11/ ,/ 正确/ 地置/ d/ (/ Tu/ )/ =/ 0/ ;/ 若/ u/ ∈/ Q0/ ,/ 算法/ 1/ 也/ 事先/ 计算/ 了/ d/ (/ Tu/ )/ ./ 此外/ ,/ 不难看出/ ,/ 片段/ 16/ 执行/ 后/ ,/ 对于/ w/ ∈/ V/ (/ T/ )/ ∩/ Q0/ ,/ w/ ≠/ v/ ,/ Tw/ 无/ 变化/ ./ 利用/ 引理/ 3/ 及/ 性质/ 4/ ,/ 可/ 进一步/ 得到/ 下面/ 性质/ ./ 性质/ 7/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vTv/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 引理/ 4/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ./ 记/ T/ / / 为/ v/ 的/ 、/ 除/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ 外/ 的/ 全部/ 已/ 检查/ 的/ 后代/ 分支/ 在/ v/ 的/ 粘合/ 子树/ ./ 如果/ d/ (/ Tv/ )/ / d/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ ,/ 则/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vT/ / / )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ }/ ,/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 2/ )/ )/ ./ 证明/ ./ 首先/ ,/ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ / d/ (/ Tv/ )/ / d/ ./ 再/ 由/ 引理/ 条件/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ ,/ 得/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 2/ )/ )/ ./ 考虑/ v/ 的/ 后代/ 分支/ T/ (/ v/ ,/ x/ )/ 和/ v/ 的/ 、/ 除/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ 外/ 的/ 全部/ 已/ 检查/ 的/ 后代/ 分支/ T/ (/ v/ ,/ v/ (/ 2/ )/ )/ ,/ …/ ,/ 因为/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 2/ )/ )/ / …/ ,/ 应用/ 引理/ 3/ (/ 1/ )/ 得/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vT/ / / )/ =/ d/ (/ T/ (/ v/ ,/ x/ )/ ○/ vT/ (/ v/ ,/ v/ (/ 2/ )/ )/ ○/ v/ …/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 注/ 5/ ./ v/ 、/ T/ (/ v/ ,/ x/ )/ 、/ u/ 如/ 引理/ 4/ 所设/ ,/ 并设/ d/ (/ Tv/ )/ / d/ ./ 算法/ 1/ 在/ 片段/ 13/ 将/ T/ (/ v/ ,/ x/ )/ 标为/ 已/ 检查/ 、/ 片段/ 14/ 将/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ 通过/ / 运算/ 删除/ 后/ ,/ 引理/ 4/ 表明/ ,/ 算法/ 1/ 的/ 片段/ 15/ 正确/ 地/ 计算/ 了/ d/ (/ Tv/ )/ 的/ 新值/ ./ 且/ d/ (/ Tv/ )/ 的/ 新值/ 只/ 与/ d/ (/ Tu/ )/ 以及/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ 有关/ ./ 而/ 在/ 计算/ d/ (/ Tv/ )/ 的/ 新值/ 时/ ,/ d/ (/ Tu/ )/ 是/ 已知/ 的/ (/ 参考/ 注/ 4/ )/ ./ 此外/ ,/ 不难看出/ ,/ 片段/ 13/ 、/ 片段/ 14/ 执行/ 后/ ,/ 对于/ w/ ∈/ V/ (/ T/ )/ ∩/ Q0/ ,/ w/ ≠/ v/ ,/ Tw/ 无/ 变化/ ./ 性质/ 8/ ./ 若/ V/ (/ T/ )/ ≠/ / ,/ v/ ∈/ V/ (/ T/ )/ ,/ 则/ d/ (/ Tv/ )/ / d/ ./ 证明/ ./ 情形/ 1/ ./ v/ 为端/ 顶点/ 且/ v/ ≠/ v0/ ./ 显然/ ,/ d/ (/ Tv/ )/ =/ 0/ / d/ ./ 情形/ 2/ ./ v/ ∈/ Q0/ ./ 应用/ 归纳法/ 原理/ 证明/ ./ 初始/ 阶段/ ,/ d/ (/ Tv/ )/ =/ 0/ / d/ ./ 考虑/ 到/ 算法/ 1/ 的/ 操作/ ,/ d/ (/ Tv/ )/ 仅当/ v/ 的/ 某个/ 后代/ 分支/ 标为/ 已/ 检查/ 、/ 或者/ v/ 的/ 某个/ 已/ 检查/ 的/ 后代/ 分支/ 中/ 的/ 除/ v/ 外/ 的/ 所有/ 顶点/ 通过/ / 运算/ 被/ 删除/ 时才/ 会/ 发生变化/ ./ 因此/ ,/ 按照/ 注/ 4/ 、/ 注/ 5/ 的/ 说明/ ,/ 仅/ 需/ 证明/ :/ 对于/ Q/ 的/ 栈顶/ 元素/ v/ ,/ 若/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ 、/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ,/ 如果/ 在/ 算法/ 1/ 的/ 片段/ 13/ 、/ 片段/ 14/ 、/ 片段/ 16/ 执行/ 前有/ d/ (/ Ty/ )/ / d/ (/ 一切/ y/ ∈/ V/ (/ T/ )/ )/ ,/ 则/ 执行/ 后/ 仍然/ 有/ d/ (/ Tv/ )/ / d/ ./ 为/ 方便/ ,/ 这里/ 将/ 上述/ 相关/ 片段/ 执行/ 前/ 、/ 后/ 的/ d/ (/ Tv/ )/ 分别/ 记作/ d/ (/ Tv/ )/ 、/ d/ (/ Tv/ )/ ./ (/ i/ )/ 片段/ 13/ 、/ 片段/ 14/ 执行/ 后/ ./ 片段/ 13/ 、/ 片段/ 14/ 执行/ 前/ 满足/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ ,/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ ,/ d/ (/ Tu/ )/ / d/ 、/ d/ (/ Tv/ )/ / d/ (/ 归纳法/ 假设/ )/ ./ 由/ 引理/ 4/ ,/ 片段/ 13/ 、/ 片段/ 14/ 执行/ 后/ ,/ d/ (/ Tv/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ }/ ,/ 而/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ </ l/ (/ v/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 2/ )/ )/ -/ 2l/ (/ v/ )/ / d/ (/ Tv/ )/ / d/ ,/ 因此/ ,/ d/ (/ Tv/ )/ </ d/ ./ (/ ii/ )/ 片段/ 16/ 执行/ 后/ ./ 片段/ 16/ 执行/ 前/ 满足/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ / d/ ,/ d/ (/ Tu/ )/ / d/ 、/ d/ (/ Tv/ )/ / d/ (/ 归纳法/ 假设/ )/ ./ 那么/ ,/ 当/ 片段/ 16/ 执行/ 后/ ,/ 若/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ ,/ 由/ 引理/ 3/ (/ 1/ )/ ,/ d/ (/ Tv/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ / d/ ./ 若/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ 且/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 2/ )/ )/ ,/ 由/ 引理/ 3/ (/ 2/ )/ ,/ d/ (/ Tv/ )/ =/ max/ {/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ / d/ ./ Page9/ 若/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 2/ )/ )/ ,/ 由/ 引理/ 3/ (/ 3/ )/ ,/ d/ (/ Tv/ )/ =/ d/ (/ Tv/ )/ / d/ ./ 情形/ 3/ ./ v/ 不是/ 端/ 顶点/ ,/ 且/ v/ / Q0/ ./ v/ 不是/ 端/ 顶点/ 表明/ v/ 有/ 唯一/ 子女/ y/ (/ 因为/ V/ (/ T/ )/ ≠/ / ,/ 由/ 引理/ 1/ ,/ v0/ ∈/ V/ (/ T/ )/ ;/ 由/ v/ / Q0/ 知/ v/ ≠/ v0/ ./ 即/ v/ 不是/ 孤立/ 点/ )/ ./ (/ i/ )/ y/ 是/ 已/ 检查/ 顶点/ ./ 按/ 算法/ 1/ ,/ y/ 成为/ 已/ 检查/ 顶点/ 必定/ 是/ 在/ 考虑/ 离/ v/ 最近/ 的/ 祖先/ w/ ∈/ Q0/ 时/ ,/ 将/ w/ 的/ v/ 所在/ 的/ 后代/ 分支/ 标为/ 已/ 检查/ 所致/ ./ 因此/ ,/ Tv/ / Tw/ ./ 由/ 性质/ 4/ 及/ 情形/ 2/ ,/ d/ (/ Tv/ )/ / d/ (/ Tw/ )/ / d/ ./ (/ ii/ )/ y/ 是/ 未/ 检查/ 顶点/ 或待/ 检查/ 顶点/ ./ 此时/ Tv/ =/ / ,/ d/ (/ Tv/ )/ =/ 0/ / d/ ./ 注/ 6/ ./ 按照/ 性质/ 8/ ,/ 引理/ 4/ 中/ 的/ 条件/ d/ (/ Tv/ )/ / d/ 是/ 冗余/ 的/ ,/ 可以/ 去掉/ ./ 引理/ 5/ ./ 若/ V/ (/ T/ )/ ≠/ / ,/ 如果/ v0/ 的/ 所有/ 后代/ 分支/ 均/ 为/ 已/ 检查/ 分支/ ,/ 则/ d/ (/ T/ )/ / d/ ./ 证明/ ./ 因为/ v0/ 的/ 所有/ 后代/ 分支/ 均/ 为/ 已/ 检查/ 分支/ ,/ 故/ Tv0/ =/ T/ ,/ d/ (/ T/ )/ =/ d/ (/ Tv0/ )/ ./ 再/ 由/ 性质/ 8/ 知/ ,/ d/ (/ T/ )/ / d/ ./ 引理/ 6/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ v/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ./ 如果/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ >/ d/ ,/ 则/ 在/ 路径/ (/ u/ ~/ v/ )/ 中/ 存在/ 两个/ 相邻/ 的/ 顶点/ z/ ,/ z1/ ,/ 使/ (/ 1/ )/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z/ )/ / d/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z1/ )/ >/ d/ ;/ (/ 2/ )/ 存在/ T/ 的/ 最小/ d/ -/ 子树/ 划分/ Π/ / d/ (/ T/ )/ ,/ 使/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ ∈/ Π/ / d/ (/ T/ )/ ;/ (/ 3/ )/ π/ d/ (/ T/ )/ =/ π/ d/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ +/ 1/ ;/ 其中/ z1/ 为/ z/ 的/ 双亲/ ./ 证明/ ./ (/ 1/ )/ 把/ 路径/ (/ u/ ~/ v/ )/ 表示/ 为/ 顶点/ 序列/ ,/ 即/ (/ u/ ~/ v/ )/ =/ y0y1y2/ …/ yryr/ +/ 1/ ,/ 其中/ y0/ =/ u/ ,/ v/ =/ yr/ +/ 1/ ./ 故/ d/ (/ u/ (/ 1/ )/ ,/ yi/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ yi/ -/ 1/ )/ +/ w/ (/ yi/ -/ 1/ ,/ yi/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ r/ +/ 1/ )/ ./ 而/ w/ (/ yi/ -/ 1/ ,/ yi/ )/ / 0/ ,/ 故/ d/ (/ u/ (/ 1/ )/ ,/ y0/ )/ ,/ d/ (/ u/ (/ 1/ )/ ,/ y1/ )/ ,/ …/ ,/ d/ (/ u/ (/ 1/ )/ ,/ yr/ +/ 1/ )/ 是/ 非减/ 序列/ ./ 但/ 由/ 性质/ 8/ ,/ d/ (/ u/ (/ 1/ )/ ,/ y0/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ u/ )/ / d/ (/ Tu/ )/ / d/ ./ 由/ 性质/ 2/ 和/ 引理/ 条件/ 有/ d/ (/ u/ (/ 1/ )/ ,/ yr/ +/ 1/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ v/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ >/ d/ ./ 因此/ ,/ 必/ 存在/ 两个/ 相邻/ 的/ 顶点/ z/ =/ yi/ ,/ z1/ =/ yi/ +/ 1/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ …/ ,/ r/ )/ ,/ 使/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ / d/ ,/ d/ (/ u/ (/ 1/ )/ ,/ z1/ )/ >/ d/ (/ 显然/ ,/ z/ ,/ z1/ ∈/ V/ (/ u/ ~/ v/ )/ ,/ (/ z/ ,/ z1/ )/ ∈/ E/ (/ u/ ~/ v/ )/ ,/ z1/ ≠/ u/ ,/ z1/ ≠/ u/ (/ 1/ )/ ,/ z1/ 为/ z/ 的/ 双亲/ )/ ./ 由/ 性质/ 2/ ,/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z/ )/ ,/ d/ (/ u/ (/ 1/ )/ ,/ z1/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z1/ )/ ./ 于是/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z/ )/ / d/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z1/ )/ >/ d/ ./ (/ 2/ )/ 记/ T1/ =/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ ./ 注意/ ,/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ 是/ z1/ 的/ 后代/ 分支/ ,/ 且/ 由/ 引理/ 2/ (/ 2/ )/ 知/ T1/ =/ Tu/ ∪/ (/ u/ ~/ z/ )/ ;/ 由/ 引理/ 2/ (/ 1/ )/ ,/ u/ 不是/ 孤立/ 点/ ./ 情形/ 1/ ./ d/ (/ u/ )/ / 2/ ./ 此时/ |/ V/ (/ Tu/ )/ |/ / 2/ ./ T1/ 中离/ z/ 最远/ 的/ 端/ 顶点/ 是/ u/ (/ 1/ )/ ./ 由/ 性质/ 5/ ,/ 即知/ T1/ 的/ 直/ 路径/ 或者/ 是/ Tu/ 中/ 的/ 一端/ 为/ u/ (/ 1/ )/ 的/ 直/ 路径/ 、/ 或者/ 是/ (/ u/ (/ 1/ )/ ~/ z/ )/ ,/ 即/ d/ (/ T1/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ }/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z/ )/ }/ ,/ 由/ 性质/ 8/ 和/ 结论/ (/ 1/ )/ 有/ d/ (/ T1/ )/ / d/ ./ 情形/ 2/ ./ d/ (/ u/ )/ =/ 1/ ./ 此时/ Tu/ =/ / ,/ 即/ u/ =/ u/ (/ 1/ )/ ./ 因此/ ,/ T1/ =/ (/ u/ ~/ z/ )/ =/ (/ u/ (/ 1/ )/ ~/ z/ )/ ,/ d/ (/ T1/ )/ =/ d/ (/ (/ u/ (/ 1/ )/ ~/ z/ )/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ z/ )/ ;/ 由/ 结论/ (/ 1/ )/ 有/ d/ (/ T1/ )/ / d/ ./ 综合/ 情形/ 1/ 、/ 情形/ 2/ ,/ 即得/ d/ (/ T1/ )/ / d/ ./ 设/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ,/ 不妨/ 设/ u/ (/ 1/ )/ ∈/ V/ (/ T1/ )/ ./ 对于/ 任意/ y/ ∈/ V/ (/ T/ )/ ,/ y/ / V/ (/ T1/ )/ ,/ 因为/ T1/ =/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ ,/ 故/ 路径/ (/ u/ (/ 1/ )/ ~/ y/ )/ 必/ 经过/ z1/ ./ 于是/ d/ (/ u/ (/ 1/ )/ ,/ y/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ z1/ )/ +/ d/ (/ z1/ ,/ y/ )/ ,/ 故/ d/ (/ u/ (/ 1/ )/ ,/ y/ )/ / d/ (/ u/ (/ 1/ )/ ,/ z1/ )/ >/ d/ ,/ 即/ y/ / V/ (/ T1/ )/ ./ 可见/ V/ (/ T1/ )/ / V/ (/ T1/ )/ ./ 记/ T2/ =/ T2/ / T1/ ,/ T3/ =/ T3/ / T1/ ,/ …/ ,/ Tm/ =/ Tm/ / T1/ ./ 由/ 性质/ 1/ 知/ Ti/ / Ti/ (/ i/ =/ 2/ ,/ …/ ,/ m/ )/ 是/ 树/ ./ 由/ 性质/ 4/ ,/ d/ (/ Ti/ )/ / d/ (/ Ti/ )/ / d/ (/ i/ =/ 2/ ,/ …/ ,/ m/ )/ ./ 显然/ ,/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ 顶点/ 两/ 两/ 不/ 相交/ ./ 又/ ∪/ mi/ =/ 1V/ (/ Ti/ )/ =/ V/ (/ T1/ )/ ∪/ (/ ∪/ m/ =/ V/ (/ T1/ )/ ∪/ (/ ∪/ m/ =/ V/ (/ T/ )/ ./ 因此/ ,/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ d/ -/ 子树/ 划分/ (/ 从而/ 是/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ )/ ,/ 结论/ (/ 2/ )/ 成立/ ./ (/ 3/ )/ 由/ 结论/ (/ 2/ )/ 的/ 证明/ 过程/ 得知/ ,/ {/ T2/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ 树/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ =/ T/ / T1/ 的/ 一个/ d/ -/ 子树/ 划分/ ./ 因此/ ,/ π/ d/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ / π/ d/ (/ T/ )/ -/ 1/ ,/ 即/ π/ d/ (/ T/ )/ / π/ d/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ +/ 1/ ./ 另一方面/ ,/ 如果/ {/ T2/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 则/ {/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ ,/ T2/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ ∪/ (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ =/ T/ -/ (/ z1/ ,/ z/ )/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 于是/ {/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ ,/ T2/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 即/ π/ d/ (/ T/ )/ / π/ d/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ +/ 1/ ./ 从而/ π/ d/ (/ T/ )/ =/ π/ d/ (/ T/ / (/ T/ (/ z1/ ,/ u/ (/ 1/ )/ )/ -/ z1/ )/ )/ +/ 1/ ./ 这样/ 就/ 获得/ 了/ 结论/ (/ 3/ )/ ./ 注/ 7/ ./ v/ 、/ T/ (/ v/ ,/ x/ )/ 、/ u/ 如/ 引理/ 6/ 所设/ ./ 由/ 性质/ 6/ ,/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ }/ ./ 又/ d/ (/ Tu/ )/ / d/ ./ 因此/ ,/ 引理/ 6/ 的/ 条件/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ >/ d/ 等价/ 于/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ >/ d/ ./ 引理/ 7/ ./ 设/ v/ 为/ Q/ 的/ 栈顶/ 元素/ ,/ T/ (/ v/ ,/ x/ )/ 为/ vPage10x/ )/ -/ v/ ∈/ Π/ / d/ (/ T/ )/ ;/ 1/ )/ -/ v/ ∈/ Π/ / d/ (/ T/ )/ ;/ v/ (/ 1/ )/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ u/ 为/ T/ (/ v/ ,/ x/ )/ 中/ 的/ 待/ 检查/ 顶点/ ,/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / d/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ ./ (/ 1/ )/ 如果/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ ,/ 则/ ①/ 存在/ T/ 的/ 最小/ d/ -/ 子树/ 划分/ Π/ / d/ (/ T/ )/ ,/ 使/ T/ (/ v/ ,/ ②/ π/ d/ (/ T/ )/ =/ π/ d/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ +/ 1/ ./ (/ 2/ )/ 如果/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ ,/ 则/ ①/ 存在/ T/ 的/ 最小/ d/ -/ 子树/ 划分/ Π/ / d/ (/ T/ )/ ,/ 使/ T/ (/ v/ ,/ ②/ π/ d/ (/ T/ )/ =/ π/ d/ (/ T/ / (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ )/ +/ 1/ ./ 证明/ ./ 首先/ ,/ 据注/ 7/ 及/ 条件/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / d/ ,/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ )/ / d/ ./ 其次/ ,/ v/ (/ 1/ )/ ≠/ v/ ,/ 否则/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ )/ -/ 2l/ (/ v/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ / d/ ,/ 与/ 条件/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ 相/ 矛盾/ ./ 设/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ ,/ 由/ 性质/ 3/ 有/ d/ (/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ ,/ 据/ 引理/ 条件/ 即得/ d/ (/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ )/ >/ d/ ,/ 这/ 意味着/ 不/ 存在/ i/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ 使/ v/ (/ 1/ )/ ∈/ V/ (/ Ti/ )/ ,/ 且/ u/ (/ 1/ )/ ∈/ V/ (/ Ti/ )/ ./ 因此/ ,/ 不妨/ 设/ v/ (/ 1/ )/ ∈/ V/ (/ T1/ )/ ,/ u/ (/ 1/ )/ ∈/ V/ (/ T2/ )/ ./ 记/ T1/ =/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ∪/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ,/ T2/ =/ (/ T2/ / (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ )/ ∪/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ T3/ =/ T3/ / (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ …/ ,/ Tm/ =/ Tm/ / (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ./ 注意/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ / T1/ 、/ T/ (/ v/ ,/ x/ )/ -/ v/ / T2/ ./ 由/ 性质/ 1/ ,/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 是/ 树/ ./ 但/ v/ (/ 1/ )/ ∈/ V/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ∩/ V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ,/ 故/ T1/ 是/ 树/ ./ 我们/ 有/ d/ (/ T1/ )/ / d/ ./ 事实上/ ,/ 任取/ y/ ,/ z/ ,/ 使/ y/ ,/ z/ ∈/ V/ (/ T1/ )/ ,/ 只要/ 证明/ d/ (/ y/ ,/ z/ )/ / d/ ./ 分/ 4/ 种/ 情形/ 讨论/ ./ 情形/ 1/ ./ y/ ,/ z/ ∈/ V/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ./ d/ (/ y/ ,/ z/ )/ / d/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ / d/ (/ T1/ )/ / d/ ./ 情形/ 2/ ./ y/ ,/ z/ ∈/ V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ./ d/ (/ y/ ,/ z/ )/ / d/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ / d/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ )/ / d/ (/ Tv/ )/ / d/ ./ 情形/ 3/ ./ y/ ∈/ V/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ 且/ z/ ∈/ V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ./ 不妨/ 设/ y/ / V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ (/ 否则/ 归为/ 情形/ 2/ )/ ,/ 即/ y/ ,/ z/ 在/ v/ 的/ 不同/ 分支/ 上/ ,/ 于是/ 路径/ (/ y/ ~/ z/ )/ 必/ 经过/ v/ ./ 又/ 由/ 性质/ 2/ ,/ d/ (/ v/ ,/ z/ )/ =/ l/ (/ z/ )/ -/ l/ (/ v/ )/ ./ 因/ y/ ,/ v/ (/ 1/ )/ ∈/ V/ (/ T1/ )/ ,/ 故/ d/ (/ y/ ,/ v/ (/ 1/ )/ )/ / d/ (/ T1/ )/ ./ 由/ 性质/ 3/ ,/ d/ (/ y/ ,/ z/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ l/ (/ z/ )/ -/ l/ (/ v/ )/ / d/ (/ y/ ,/ v/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ d/ (/ v/ (/ 1/ )/ ,/ v/ )/ =/ d/ (/ y/ ,/ v/ (/ 1/ )/ )/ / d/ (/ T1/ )/ / d/ ./ 情形/ 4/ ./ y/ ∈/ V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ 且/ z/ ∈/ V/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ./ 仿/ 情形/ 3/ 的/ 证明/ ,/ 可得/ d/ (/ y/ ,/ z/ )/ / d/ ./ d/ (/ Ti/ )/ / d/ (/ Ti/ )/ / d/ ./ 类似/ ,/ 可以/ 证明/ :/ T2/ 是/ 树/ ,/ 且/ d/ (/ T2/ )/ / d/ ./ 对于/ i/ =/ 3/ ,/ …/ ,/ m/ ,/ 由/ 性质/ 1/ 、/ Ti/ 是/ 树且/ 由/ 性质/ 4/ ,/ 易见/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ 顶点/ 两/ 两/ 不/ 相交/ ,/ 且/ ∪/ mi/ =/ 1V/ (/ Ti/ )/ =/ V/ (/ T/ )/ ./ 因此/ ,/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ d/ -/ 子树/ 划分/ (/ 从而/ 是/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ )/ ./ (/ 1/ )/ 当/ l/ (/ u/ (/ 1/ )/ )/ / l/ (/ v/ (/ 1/ )/ )/ ,/ 记/ T1/ 为/ V/ (/ T1/ )/ ∪/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ 的/ 导出/ 子图/ ./ 首先/ ,/ T1/ 是/ 树/ ./ 分/ 两种/ 情形/ 证明/ ./ 情形/ 1/ ./ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ =/ / ./ 显然/ ,/ T1/ 是/ 树/ ./ 情形/ 2/ ./ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ≠/ / ./ 任取/ y/ ∈/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ./ 注意/ T/ (/ v/ ,/ x/ )/ -/ v/ / T2/ ./ 在/ T2/ 中/ ,/ y/ 要/ 到达/ T/ (/ v/ ,/ x/ )/ -/ v/ 中/ 的/ 顶点/ 必/ 经过/ v/ ,/ 即/ v/ ∈/ V/ (/ T2/ )/ ;/ 但/ v/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ,/ 故/ v/ ∈/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ,/ 即/ v/ ∈/ V/ (/ T1/ )/ ./ 又/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ / T1/ ,/ 故/ V/ (/ T1/ )/ ∪/ {/ v/ }/ 的/ 导出/ 子图/ 是/ 连通/ 的/ ./ 另外/ ,/ 由/ 性质/ 1/ ,/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 是/ 树/ ./ 从而/ T1/ 中/ 的/ 任意/ 顶点/ 经/ v/ 可/ 到达/ y/ ,/ 于是/ T1/ 是/ 连通/ 的/ ,/ 即/ T1/ 是/ 树/ ./ 其次/ ,/ d/ (/ T1/ )/ / d/ ./ 任取/ y/ ,/ z/ ,/ 使/ y/ ,/ z/ ∈/ V/ (/ T1/ )/ ,/ 只要/ 证明/ d/ (/ y/ ,/ z/ )/ / d/ ./ 分/ 4/ 种/ 情形/ 讨论/ ./ 情形/ 1/ ./ y/ ,/ z/ ∈/ V/ (/ T1/ )/ ./ d/ (/ y/ ,/ z/ )/ / d/ (/ T1/ )/ / d/ ./ 情形/ 2/ ./ y/ ,/ z/ ∈/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ./ d/ (/ y/ ,/ z/ )/ 情形/ 3/ ./ y/ ∈/ V/ (/ T1/ )/ ,/ z/ ∈/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ./ 显然/ ,/ z/ / V/ (/ T1/ )/ ,/ z/ / V/ (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ ./ 因此/ ,/ 路径/ (/ u/ (/ 1/ )/ ~/ z/ )/ 必/ 经过/ v/ ./ 又/ 由/ 上面/ 的/ 讨论/ 易知/ ,/ 路径/ (/ y/ ~/ z/ )/ 必/ 经过/ v/ ./ 注意/ T1/ =/ (/ T1/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ∪/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ./ (/ i/ )/ y/ ∈/ V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ./ 此时/ d/ (/ y/ ,/ v/ )/ / d/ (/ v/ (/ 1/ )/ ,/ v/ )/ ./ 故/ d/ (/ y/ ,/ z/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ / d/ (/ v/ (/ 1/ )/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ =/ l/ (/ v/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ / l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ / d/ (/ 注意/ z/ ,/ u/ (/ 1/ )/ ∈/ V/ (/ T2/ )/ )/ ./ (/ ii/ )/ y/ / V/ (/ T/ (/ v/ ,/ v/ (/ 1/ )/ )/ -/ v/ )/ ./ 此时/ 必有/ d/ (/ y/ ,/ v/ )/ / d/ (/ u/ (/ 1/ )/ ,/ v/ )/ ./ 否则/ d/ (/ y/ ,/ v/ )/ >/ d/ (/ u/ (/ 1/ )/ ,/ v/ )/ ,/ 因/ y/ 、/ v/ (/ 1/ )/ 、/ u/ (/ 1/ )/ 在/ v/ 的/ 不同/ 分支/ 上/ ,/ 由/ 性质/ 3/ ,/ d/ (/ y/ ,/ v/ (/ 1/ )/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ d/ (/ v/ ,/ v/ (/ 1/ )/ )/ >/ d/ (/ u/ (/ 1/ )/ ,/ v/ )/ +/ d/ (/ v/ ,/ v/ (/ 1/ )/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ v/ (/ 1/ )/ )/ =/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ / d/ (/ T1/ )/ ,/ 即/ d/ (/ y/ ,/ v/ (/ 1/ )/ )/ >/ d/ (/ T1/ )/ ;/ 与/ y/ ,/ v/ (/ 1/ )/ ∈/ V/ (/ T1/ )/ 相/ 矛盾/ ./ 从而/ d/ (/ y/ ,/ z/ )/ =/ d/ (/ y/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ / d/ (/ u/ (/ 1/ )/ ,/ v/ )/ +/ d/ (/ v/ ,/ z/ )/ =/ d/ (/ u/ (/ 1/ )/ ,/ z/ )/ / d/ ./ 情形/ 4/ ./ y/ ∈/ V/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ,/ z/ ∈/ / d/ (/ T2/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ / d/ (/ T2/ )/ / d/ ./ Page11V/ (/ T1/ )/ ./ 仿/ 情形/ 3/ 的/ 证明/ ,/ 可得/ d/ (/ y/ ,/ z/ )/ / d/ ./ 最后/ ,/ 容易/ 验证/ {/ T1/ ,/ T/ (/ v/ ,/ x/ )/ -/ v/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ T/ 的/ 一个/ d/ -/ 子树/ 划分/ (/ 从而/ 是/ T/ 的/ 一个/ 最小/ d/ -/ 子树/ 划分/ )/ ,/ 于是/ 结论/ 1/ )/ 成立/ ./ 因为/ {/ T1/ ,/ T3/ ,/ …/ ,/ Tm/ }/ 是/ 树/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 故/ π/ d/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ / π/ d/ (/ T/ )/ -/ 1/ ,/ 即/ π/ d/ (/ T/ )/ / π/ d/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ +/ 1/ ./ 另一方面/ ,/ 如果/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ -/ 1/ }/ 是/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 则/ {/ T/ (/ v/ ,/ x/ )/ -/ v/ ,/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ -/ 1/ }/ 是/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ∪/ T/ (/ v/ ,/ x/ )/ 的/ 一个/ d/ -/ 子树/ 划分/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ 中/ 含有/ v/ )/ ./ 而/ V/ (/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ ∪/ T/ (/ v/ ,/ x/ )/ )/ =/ V/ (/ T/ )/ ./ 因此/ ,/ {/ T/ (/ v/ ,/ x/ )/ -/ v/ ,/ T1/ ,/ T2/ ,/ …/ ,/ Tm/ -/ 1/ }/ 也/ 是/ T/ 的/ 一个/ d/ -/ 子树/ 划分/ ,/ 即/ π/ d/ (/ T/ )/ / π/ d/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ +/ 1/ ./ 从而/ π/ d/ (/ T/ )/ =/ π/ d/ (/ T/ / (/ T/ (/ v/ ,/ x/ )/ -/ v/ )/ )/ +/ 1/ ./ 这样/ 就/ 获得/ 了/ 结论/ 2/ )/ ./ (/ 2/ )/ 当/ l/ (/ u/ (/ 1/ )/ )/ </ l/ (/ v/ (/ 1/ )/ )/ ,/ 因由/ 引理/ 4/ 知/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 2/ )/ )/ ,/ 故/ l/ (/ v/ (/ 1/ )/ )/ >/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 2/ )/ )/ ./ 若/ 将/ T/ (/ v/ ,/ x/ )/ 、/ 1/ )/ 换位/ ,/ 以下/ 就/ 可/ 类似/ (/ 1/ )/ 证明/ ,/ 不再/ 赘述/ ./ T/ (/ v/ ,/ v/ (/ 1/ )/ 注/ 8/ ./ v/ 、/ T/ (/ v/ ,/ x/ )/ 、/ u/ 如/ 引理/ 7/ 所设/ ./ 由/ 性质/ 7/ ,/ 有/ d/ (/ T/ (/ v/ ,/ x/ )/ / Tv/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ d/ (/ Tv/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ ./ 又/ d/ (/ Tu/ )/ / d/ ,/ d/ (/ Tv/ )/ / d/ ./ 因此/ ,/ 引理/ 7/ 的/ 条件/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ >/ d/ 等价/ 于/ d/ (/ T/ (/ v/ ,/ x/ )/ / Tv/ )/ >/ d/ ./ 根据/ 性质/ 1/ ,/ 引理/ 1/ ~/ 引理/ 7/ ,/ 我们/ 有/ 定理/ 2/ ./ 算法/ 1/ 正确/ 地/ 求解/ 边/ 赋非/ 负权/ 树/ 的/ d/ -/ 子树/ 划分/ 问题/ ./ 3.3/ 算法/ 的/ 复杂性/ 定理/ 3/ ./ 算法/ 1/ 在/ O/ (/ n/ )/ 时间/ 内/ 完成/ ,/ 其中/ n/ =/ |/ V/ (/ T0/ )/ |/ ./ 证明/ ./ 算法/ 1/ 的/ 执行/ 时间/ 主要/ 取决于/ 片段/ 1/ ~/ 片段/ 4/ 、/ 片段/ 7/ ~/ 片段/ 10/ 、/ 片段/ 12/ ~/ 片段/ 18/ 以及/ 循环/ ./ (/ 1/ )/ 片段/ 1/ 、/ 片段/ 2/ 、/ 片段/ 3/ ./ 根据/ 注/ 1/ ,/ 片段/ 1/ 可/ 在/ O/ (/ n/ )/ 时间/ 完成/ ;/ 而/ 片段/ 2/ 、/ 片段/ 3/ 也/ 可/ 在/ 标号/ D/ 进行/ 时/ 同时/ 进行/ ,/ 所/ 耗时间/ 也/ 为/ O/ (/ n/ )/ ./ (/ 2/ )/ 片段/ 4/ 、/ 片段/ 7/ ./ 参考/ 注/ 2/ 的/ 说明/ ,/ 考虑/ 到/ 循环/ (/ 见/ 下面/ 关于/ 循环/ 次数/ 的/ 讨论/ ,/ 下同/ )/ ,/ 总/ 的/ 时间/ 耗费/ 为/ O/ (/ n/ )/ ./ (/ 3/ )/ 片段/ 8/ ./ 根据/ 注/ 3/ 的/ 讨论/ ,/ 在/ 一次/ 循环/ 中/ ,/ 为了/ 找到/ u/ ,/ 片段/ 8/ 把/ (/ u/ ~/ v/ )/ (/ u/ ,/ v/ 如/ 算法/ 1/ 或/ 引理/ 2/ 约定/ )/ 上/ 的/ 所有/ 顶点/ (/ 除/ v/ 外/ )/ 均/ 访问/ 了/ 一次/ ;/ 但/ 下/ 一次/ 循环/ 片段/ 8/ 可能/ 还会/ 访问/ (/ u/ ~/ v/ )/ 上/ 的/ 某些/ 顶点/ ,/ 这样/ 片段/ 8/ 可能/ 重复/ 访问/ (/ u/ ~/ v/ )/ 上/ 的/ 某些/ 顶点/ ./ 不过/ ,/ 应用/ 下面/ 的/ 策略/ ,/ 即使/ 考虑/ 到/ 循环/ ,/ (/ u/ ~/ v/ )/ 上/ 的/ 顶点/ (/ 除/ v/ 外/ )/ 被/ 片段/ 8/ 恰好/ 访问/ 一次/ ./ 片段/ 9/ ./ 我们/ 可以/ 从/ u/ 出发/ 沿着/ (/ u/ ~/ v/ )/ 、/ 通过/ 逐个/ 顶点/ 验证/ 方式/ 来/ 寻找/ z/ ,/ z1/ (/ z/ ,/ z1/ 如/ 算法/ 1/ 或/ 引理/ 6/ 约定/ )/ ./ 由于/ u/ 的/ 所有/ 后代/ 分支/ 均/ 为/ 已/ 检查/ 分支/ (/ 引理/ 2/ )/ ,/ 从而/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ u/ )/ / d/ (/ Tu/ )/ / d/ (/ 性质/ 8/ )/ ./ 在/ (/ u/ ~/ v/ )/ 上取/ u/ 的/ (/ 唯一/ )/ 双亲/ x1/ ,/ 如果/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ x1/ )/ >/ d/ ,/ 则/ z/ =/ u/ ,/ z1/ =/ x1/ ;/ 否则/ ,/ 在/ (/ u/ ~/ v/ )/ 上取/ x1/ 的/ 双亲/ x2/ ,/ 如果/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ x2/ )/ >/ d/ ,/ 则/ z/ =/ x1/ ,/ z1/ =/ x2/ ;/ …/ 依/ 此/ 方法/ ,/ 最后/ 必/ 能/ 找到/ z/ ,/ z1/ ./ 因此/ ,/ 片段/ 9/ 访问/ (/ u/ ~/ z1/ )/ 上/ 的/ 每个/ 未/ 检查/ 顶点/ 一次/ ;/ 但/ 随后/ 的/ 片段/ 10/ 进行/ 的/ / 运算/ 将/ 删除/ 这些/ 访问/ 过/ 的/ 顶点/ (/ 除/ z1/ 外/ )/ ./ 在/ 片段/ 11/ ,/ 当/ z1/ 是/ 端/ 顶点/ 且/ z1/ ≠/ v0/ ,/ z1/ 将/ 标为/ 待/ 检查/ ,/ 此时/ ,/ 我们/ 可以/ 直接/ 转/ 到/ 片段/ 8/ 后面/ 一行/ 的/ 条件/ 判断/ (/ 取/ u/ =/ z1/ ./ 注意/ ,/ 片段/ 8/ 不需/ 访问/ 此种/ 待/ 检查/ 顶点/ u/ )/ 而/ 无需/ 从/ 循环/ 的/ 入口处/ 开始/ 下次/ 循环/ ,/ 避免/ 了/ 片段/ 8/ 重复/ 访问/ (/ u/ ~/ v/ )/ 上/ 的/ 顶点/ ;/ 若/ z1/ 不是/ 端/ 顶点/ ,/ 必有/ z1/ =/ v/ (/ 意味着/ 前面/ 片段/ 10/ 进行/ 的/ / 运算/ 删除/ 了/ v/ 的/ 一个/ 分支/ )/ ./ 根据/ 以上/ 讨论/ ,/ 我们/ 可/ 得到/ :/ 算法/ 1/ 直至/ 结束/ ,/ 片段/ 8/ 不/ 访问/ 已/ 检查/ 顶点/ ,/ 待/ 检查/ 顶点/ 可能/ 被/ 片段/ 8/ 访问/ 一次/ ,/ 不/ 在/ Q0/ 中/ 的/ 未/ 检查/ 顶点/ 被/ 片段/ 8/ 访问/ 一次/ ,/ 不/ 访问/ Q0/ 中/ 的/ 未/ 检查/ 顶点/ ./ 片段/ 9/ 不/ 访问/ 已/ 检查/ 顶点/ 和/ 待/ 检查/ 顶点/ ,/ 不/ 在/ Q0/ 中/ 的/ 未/ 检查/ 顶点/ 被/ 片段/ 9/ 访问/ 一次/ ,/ Q0/ 中/ 的/ 未/ 检查/ 顶点/ v/ 被/ 片段/ 9/ 访问/ 至多/ d/ (/ v/ )/ 次/ (/ 若/ v/ ≠/ v0/ ,/ v/ 的/ 每个/ 后代/ 分支/ 各/ 对应/ 一次/ ,/ 共/ d/ (/ v/ )/ -/ 1/ 次/ ;/ 若/ v/ =/ v0/ ,/ v0/ 的/ 每个/ 后代/ 分支/ 也/ 各/ 对应/ 一次/ ,/ 共/ d/ (/ v/ )/ 次/ )/ ./ 因为/ 已/ 检查/ 顶点/ 、/ 待/ 检查/ 顶点/ 、/ 未/ 检查/ 顶点/ 分别/ 至多/ 有/ n/ 个/ ,/ 故/ 考虑/ 到/ 循环/ ,/ 片段/ 8/ 、/ 片段/ 9/ 访问/ 的/ 顶点/ 总数/ 不/ 超过/ (/ n/ +/ n/ )/ +/ n/ +/ ∑/ v/ ∈/ Q0/ ,/ v/ ≠/ v0/ (/ 4/ )/ 片段/ 10/ 、/ 片段/ 12/ 、/ 片段/ 14/ ./ 主要/ 时间/ 耗费/ 在/ / 运算/ ./ 考虑/ 到/ 循环/ ,/ 全部/ / 运算/ 所/ 耗费/ 的/ 时间/ 为/ O/ (/ n/ )/ ./ (/ 5/ )/ 片段/ 15/ 、/ 片段/ 17/ 、/ 片段/ 18/ ./ 分别/ 参考/ 注/ 5/ 、/ 注/ 4/ 的/ 说明/ ./ 考虑/ 到/ 循环/ ,/ 总/ 的/ 时间/ 耗费/ 为/ O/ (/ n/ )/ ./ (/ 6/ )/ 片段/ 13/ 、/ 片段/ 16/ ./ 实际上/ ,/ 片段/ 13/ 、/ 片段/ 16/ 只/ 需/ 把/ 不是/ 已/ 检查/ 顶点/ 的/ 顶点/ 标为/ 已/ 检查/ (/ 即/ 路径/ (/ u/ ~/ v/ )/ 中除/ v/ 外/ 的/ 顶点/ ,/ 引理/ 2/ )/ ./ 注意/ ,/ 任何/ 顶点/ 只要/ 标为/ 已/ 检查/ 后/ ,/ 不/ 可能/ 标为/ 未/ 检查/ 、/ 待/ 检查/ ./ 考虑/ 到/ 循环/ ,/ 总/ 的/ 时间/ 耗费/ 为/ O/ (/ n/ )/ ./ (/ 7/ )/ 循环/ ./ 每次/ 循环/ 将/ 处理/ T/ 中/ 对应/ Q/ 的/ 栈顶/ 元素/ 的/ 顶点/ 的/ 一个/ 后代/ 分支/ ,/ 该/ 顶点/ 的/ 某个/ 后代/ 分/ Page12/ 支/ 每/ 多/ 处理/ 一次/ ,/ 表明/ 前次/ 循环/ 刚刚/ 得到/ 了/ Π/ / d/ (/ T0/ )/ 的/ 一个/ 元素/ ./ 因此/ ,/ 循环/ 次数/ 不/ 超过/ π/ d/ (/ T0/ )/ +/ ∑/ v/ ∈/ Q0/ ,/ v/ ≠/ v0/ 综上所述/ ,/ 算法/ 1/ 的/ 时间/ 耗费/ 为/ O/ (/ n/ )/ ./ 证毕/ ./ 4/ 算/ 例例/ ./ 求图/ 2/ 所示/ 树/ T/ 的/ 3/ -/ 子树/ 划分/ 问题/ ,/ 其中/ 顶点/ 旁/ 的/ 数字/ 为/ 顶点/ 编号/ (/ 例如/ 顶点/ 编号/ 1/ 表示/ 顶点/ v1/ 、/ 顶点/ 编号/ 10/ 表示/ 顶点/ v10/ )/ ,/ 标在/ 边/ 的/ 上方/ 或/ 右边/ 的/ 数字/ 为/ 对应/ 边/ 的/ 权值/ ./ 解/ ./ 现用/ 算法/ 1/ 求解/ ./ 置/ d/ =/ 3/ ./ (/ 1/ )/ 初始化/ ./ π/ 3/ (/ T/ )/ =/ 0/ ;/ Π/ / 3/ (/ T/ )/ =/ / ./ 取/ v0/ =/ v1/ ,/ 将/ T/ 按/ 标号/ D/ 标号/ (/ 见图/ 2/ ,/ 顶点/ 的/ 标号/ 写/ 在/ 顶点/ 编号/ 后面/ 的/ 括号/ 中/ )/ ,/ Q/ =/ {/ v5/ ,/ v1/ }/ ./ 把/ 所有/ 的/ 端/ 顶点/ 标为/ 待/ 检查/ ,/ 其余/ 顶点/ 标为/ 未/ 检查/ (/ 见图/ 2/ ,/ 未/ 检查/ 顶点/ 、/ 已/ 检查/ 顶点/ 、/ 待/ 检查/ 顶点/ 分别/ 用/ 白色/ 、/ 黑色/ 、/ 半/ 白半黑/ 小圆圈/ 表示/ ./ 下同/ )/ ./ 对/ i/ =/ 1/ ,/ 3/ ,/ 5/ ,/ 6/ ,/ 7/ ,/ 8/ ,/ 10/ ,/ 置/ v/ (/ 1/ )/ (/ 2/ )/ 取/ Q/ 的/ 栈顶/ 元素/ v5/ ,/ v/ =/ v5/ ,/ 取/ v5/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v5/ ,/ v6/ )/ ,/ 取/ T/ (/ v5/ ,/ v6/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v6/ ./ 因为/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ =/ l/ (/ v/ (/ 1/ )/ 3/ =/ 1/ </ d/ ,/ 且/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ =/ l/ (/ v/ (/ 1/ )/ 2l/ (/ v5/ )/ =/ l/ (/ v6/ )/ +/ l/ (/ v5/ )/ -/ 2l/ (/ v5/ )/ =/ 4/ +/ 3/ -/ 2/ ×/ 3/ =/ 1/ </ d/ ,/ 故/ 将/ T/ (/ v5/ ,/ v6/ )/ 标为/ 已/ 检查/ ./ 又/ 因/ l/ (/ u/ (/ 1/ )/ )/ =/ l/ (/ v/ (/ 1/ )/ l/ (/ v/ (/ 1/ )/ )/ =/ l/ (/ v/ (/ 1/ )/ d/ (/ Tv5/ )/ =/ max/ {/ d/ (/ Tu/ )/ ,/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ }/ =/ max/ {/ d/ (/ Tv6/ )/ ,/ l/ (/ v/ (/ 1/ )/ 3/ }/ =/ 1/ ;/ v/ (/ 2/ )/ =/ v/ (/ 2/ )/ T/ (/ v5/ ,/ v6/ )/ 标为/ 已/ 检查/ ,/ d/ (/ Tv5/ )/ =/ 1/ ,/ v/ (/ 1/ )/ (/ 3/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v5/ ,/ v/ =/ v5/ ,/ 取/ v5/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v5/ ,/ v7/ )/ ,/ 取/ T/ (/ v5/ ,/ v7/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v7/ ./ 类似/ (/ 2/ )/ 可/ 得/ :/ T/ (/ v5/ ,/ v7/ )/ 标为/ 已/ 检查/ ,/ d/ (/ Tv5/ )/ =/ 2/ ,/ 5/ =/ v7/ ,/ v/ (/ 2/ )/ v/ (/ 1/ )/ (/ 4/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v5/ ,/ v/ =/ v5/ ,/ 取/ v5/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v5/ ,/ v8/ )/ ,/ 取/ T/ (/ v5/ ,/ v8/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v8/ ./ 类似/ (/ 2/ )/ 可/ 得/ :/ T/ (/ v5/ ,/ v8/ )/ 标为/ 已/ 检查/ ,/ d/ (/ Tv5/ )/ =/ 3/ ,/ 5/ =/ v8/ ,/ v/ (/ 2/ )/ v/ (/ 1/ )/ 5/ )/ -/ 2l/ (/ v5/ )/ =/ l/ (/ v10/ )/ +/ l/ (/ v8/ )/ -/ 2l/ (/ v5/ )/ =/ 6/ +/ 5/ -/ 2/ ×/ 3/ =/ 5/ >/ (/ 5/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v5/ ,/ v/ =/ v5/ ,/ 取/ v5/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v5/ ,/ v9/ )/ ,/ 取/ T/ (/ v5/ ,/ v9/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v10/ ./ 因为/ l/ (/ u/ (/ 1/ )/ )/ -/ l/ (/ v/ )/ =/ l/ (/ v10l/ (/ v5/ )/ =/ 6/ -/ 3/ =/ 3/ =/ d/ ,/ 但/ l/ (/ u/ (/ 1/ )/ )/ +/ l/ (/ v/ (/ 1/ )/ )/ -/ 2l/ (/ v/ )/ =/ l/ (/ v10l/ (/ v/ (/ 1/ )/ d/ ,/ l/ (/ u/ (/ 1/ )/ )/ =/ l/ (/ v/ (/ 1/ )/ 即/ l/ (/ u/ (/ 1/ )/ )/ >/ l/ (/ v/ (/ 1/ )/ )/ ,/ 故/ Π/ / 3/ (/ T/ )/ =/ Π/ / 3/ (/ T/ )/ ∪/ {/ T/ (/ v5/ ,/ v9/ )/ -/ v5/ }/ =/ {/ {/ v9/ ,/ v10/ }/ }/ (/ 为了/ 简明/ 起/ 见/ ,/ Π/ / 3/ (/ T/ )/ 中/ 的/ 子树用/ 该子/ 树/ 的/ 顶点/ 集/ 表示/ ./ 下同/ )/ ,/ π/ 3/ (/ T/ )/ =/ π/ 3/ (/ T/ )/ +/ 1/ =/ 1/ ,/ T/ =/ T/ / (/ T/ (/ v5/ ,/ v9/ )/ -/ v5/ )/ (/ 见图/ 3/ )/ ./ (/ 6/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v5/ ,/ v/ =/ v5/ ,/ v/ ≠/ v0/ 且/ 不/ 存在/ v5/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ 于是/ 将/ v5/ 标为/ 待/ 检查/ ;/ Q/ =/ Q/ -/ {/ v/ }/ =/ {/ v1/ }/ ./ (/ 7/ )/ 取/ Q/ 的/ 栈顶/ 元素/ v1/ ,/ v/ =/ v1/ ,/ 取/ v1/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v1/ ,/ v2/ )/ ,/ 取/ T/ (/ v1/ ,/ v2/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v3/ ./ 类似/ (/ 2/ )/ 可/ 得/ :/ T/ (/ v1/ ,/ v2/ )/ 标为/ 已/ 检查/ ,/ d/ (/ Tv1/ )/ =/ 3/ ,/ v/ (/ 1/ )/ v3/ ,/ v/ (/ 2/ )/ 1/ =/ v1/ ./ (/ 8/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v1/ ,/ v/ =/ v1/ ,/ 取/ v1/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v1/ ,/ v4/ )/ ,/ 取/ T/ (/ v1/ ,/ v4/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v5/ ./ 易得/ Π/ / 3/ (/ T/ )/ =/ {/ {/ v9/ ,/ v10/ }/ ,/ {/ v5/ ,/ v6/ ,/ v7/ ,/ v8/ }/ }/ ,/ π/ 3/ (/ T/ )/ =/ 2/ ;/ v4/ 标为/ 待/ 检查/ ,/ v/ (/ 1/ )/ (/ 9/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v1/ ,/ v/ =/ v1/ ,/ 取/ v1/ 的/ 最/ 左边/ 的/ 未/ 检查/ 的/ 后代/ 分支/ T/ (/ v1/ ,/ v4/ )/ ,/ 取/ T/ (/ v1/ ,/ v4/ )/ 中/ 的/ 待/ 检查/ 顶点/ u/ =/ v4/ ./ 易得/ T/ (/ v1/ ,/ v4/ )/ 标为/ 已/ 检查/ ,/ Π/ / 3/ (/ T/ )/ =/ {/ {/ v9/ ,/ v10/ }/ ,/ {/ v5/ ,/ v6/ ,/ v7/ ,/ v8/ }/ ,/ {/ v2/ ,/ v3/ }/ }/ ,/ π/ 3/ (/ T/ )/ =/ 3/ ;/ d/ (/ Tv1/ )/ =/ 1/ ,/ v/ (/ 1/ )/ (/ 10/ )/ 继续/ 考虑/ Q/ 的/ 栈顶/ 元素/ v1/ ,/ v/ =/ v1/ ,/ v/ =/ v0/ 且/ 不/ 存在/ v1/ 的/ 未/ 检查/ 的/ 后代/ 分支/ ,/ 于是/ Π/ / 3/ (/ T/ )/ =/ Π/ / 3/ (/ T/ )/ ∪/ {/ T/ }/ =/ Π/ / 3/ (/ T/ )/ ∪/ {/ (/ v1/ ,/ v4/ )/ }/ =/ {/ {/ v9/ ,/ v10/ }/ ,/ {/ v5/ ,/ v6/ ,/ v7/ ,/ v8/ }/ ,/ {/ v2/ ,/ v3/ }/ ,/ {/ v1/ ,/ v4/ }/ }/ ,/ π/ 3/ (/ T/ )/ =/ π/ 3/ (/ T/ )/ +/ 1/ =/ 4/ ,/ T/ =/ / ./ 从而/ Π/ / 3/ (/ T/ )/ =/ {/ {/ v9/ ,/ v10/ }/ ,/ {/ v5/ ,/ v6/ ,/ v7/ ,/ v8/ }/ ,/ {/ v2/ ,/ v3/ }/ ,/ {/ v1/ ,/ v4/ }/ }/ ,/ π/ 3/ (/ T/ )/ =/ 4/ ./ 算法/ 1/ 结束/ ./ Page135/ 结束语/ 由于/ 对/ 结构/ 非常简单/ 的/ 图/ ,/ d/ -/ 子树/ 划分/ 问题/ 是/ 一个/ NP/ -/ 完全/ 问题/ ,/ 因此/ ,/ 研究/ 一般/ 图/ 的/ d/ -/ 子树/ 划分/ 问题/ 的/ 多项式/ 时间/ 近似算法/ 非常/ 有/ 必要/ ./ 当然/ ,/ 寻找/ 在/ 实际/ 应用/ 中/ 常见/ 网络/ 类型/ 或/ 理论/ 上/ 有/ 较大/ 价值/ 的/ 特殊/ 类图/ (/ 如/ 区间/ 图/ 、/ 仙人掌/ 图/ )/ 的/ d/ -/ 子树/ 划分/ 问题/ 的/ 多项式/ 时间/ 精确/ 算法/ 也/ 值得/ 重视/ ./ 

