Page1/ 对/ pSFLASH/ 扰动/ 公钥/ 密码/ 的/ 一个/ 实际/ 攻击/ 孙/ 思维/ 1/ )/ 胡磊/ 1/ )/ 蒋鑫/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 中国科学院/ 研究生院/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100049/ )/ 2/ )/ (/ 中国航天科技集团公司/ 第九/ 研究院/ 第七/ 零四/ 研究所/ 北京/ 100076/ )/ 摘要/ 通过/ 对/ SFLASH/ 的/ 中心/ 映射/ 进行/ 扰动/ ,/ 最近/ Wang/ 等/ 人/ 提出/ 了/ 一个/ 新/ 的/ 多/ 变量/ 公钥/ 系统/ pSFLASH/ ./ pSFLASH/ 的/ 设计者/ 认为/ ,/ 扰动/ 后/ 的/ 中心/ 映射/ 可以/ 破坏/ SFLASH/ 公钥/ 潜在/ 的/ 数学/ 结构/ ,/ 从而/ 抵抗/ 针对/ SFLASH/ 的/ 差分/ 代数/ 攻击/ [/ 2/ -/ 3/ ]/ ./ 然而/ 对于/ 以/ (/ T/ -/ 1/ ,/ U/ -/ 1/ ,/ β/ ,/ γ/ )/ 为/ 私钥/ 的/ 任一/ pSFLASH/ 实例/ ,/ 一定/ 存在/ 一个/ 可逆/ 仿射变换/ 珦/ U/ ,/ 使/ 它/ 变成/ 一个/ 以/ (/ T/ -/ 1/ ,/ 珦/ U/ -/ 1/ )/ 为/ 私钥/ 的/ SFLASH/ 实例/ ,/ 因此/ 利用/ 对/ SFLASH/ 的/ 差分/ 代数/ 攻击/ [/ 2/ -/ 3/ ]/ ,/ 在/ 几秒钟/ 的/ 时间/ 内/ 可以/ 实际/ 地/ 伪造/ 出/ 任意/ 消息/ 的/ 合法/ 的/ pSFLASH/ 签名/ ./ 关键词/ 多/ 变量/ 公钥/ 密码/ ;/ SFLASH/ ;/ 线性化/ 方程/ 攻击/ ;/ 差分/ 代数/ 攻击/ 1/ 引言/ 公钥/ 密码/ 已经/ 成为/ 现代/ 信息/ 社会/ 中/ 保护/ 数据通信/ 的/ 一种/ 重要/ 工具/ ./ 经典/ 的/ 公钥/ 密码/ 算法/ 主要/ 基于/ 大/ 整数/ 分解/ (/ 如/ RSA/ 算法/ )/ 和/ 离散/ 对数/ (/ 如/ ElGmalPage2/ 常有/ 意义/ ./ 研究者/ 们/ 在/ 此/ 方向/ 上/ 进行/ 了/ 各种/ 努力/ 与/ 尝试/ ,/ 构造/ 了/ 一些/ 新/ 的/ 公钥/ 算法/ ./ 一些/ 著名/ 的/ 例子/ 包括/ 基于/ 一般/ 线性/ 码/ 译码/ 问题/ 的/ McEliece/ 公钥/ 算法/ [/ 5/ ]/ 、/ 基于/ 格/ 问题/ 的/ NTRU/ 公钥/ 算法/ [/ 6/ ]/ 和/ 基于/ 有限/ 域/ 上/ 多项式/ 方程组/ 求解/ 问题/ 的/ 多/ 变量/ 公钥/ 系统/ MI/ [/ 7/ ]/ ./ 这些/ 新/ 提出/ 的/ 公钥/ 算法/ 所/ 基于/ 的/ 数学/ 问题/ ,/ 至今/ 没有/ 找到/ 有效/ 的/ 量子/ 多项式/ 时间/ 算法/ ./ 多/ 变量/ 公钥/ 密码/ 被/ 认为/ 是/ 一类/ 很/ 有/ 前途/ 的/ 可以/ 抵抗/ 量子/ 计算机/ 攻击/ 的/ 公钥/ 系统/ ./ 近年来/ 各种/ 新/ 的/ 多/ 变量/ 公钥/ 系统/ 的/ 构造方法/ 层出不穷/ [/ 8/ -/ 10/ ]/ ,/ 同时/ 在/ 对/ 多/ 变量/ 公钥/ 系统/ 的/ 攻击/ 方面/ ,/ 研究者/ 也/ 积累/ 了/ 大量/ 的/ 经验/ ./ 一些/ 著名/ 的/ 攻击/ 包括/ 线性化/ 方程/ 攻击/ [/ 11/ ]/ 、/ 高阶/ 线性化/ 方程/ 攻击/ [/ 12/ ]/ 、/ 小/ 秩/ 攻击/ [/ 13/ ]/ 和/ 差分/ 代数/ 攻击/ [/ 2/ -/ 3/ ]/ 等等/ ./ 其中/ 差分/ 代数/ 攻击/ 成功/ 攻破/ 了/ SFLASH/ 多/ 变量/ 公钥/ 系统/ ./ 最近/ ,/ 一些/ 研究者/ 研究/ 了/ 如何/ 修复/ SFLASH/ 公钥/ 系统/ ,/ 文献/ [/ 14/ ]/ 将/ SFLASH/ 密码/ 系统/ 的/ 消息/ 空间/ 定义/ 在/ 一个/ 超平面/ 上/ ,/ 以/ 挫败/ 差分/ 代数/ 攻击/ [/ 2/ -/ 3/ ]/ 中/ 所/ 利用/ 的/ 差分/ 对称/ 性质/ ./ 而/ 在/ 文献/ [/ 1/ ]/ 中/ ,/ 设计者/ 试图/ 通过/ 对/ SFLASH/ 算法/ 的/ 中心/ 映射/ F/ 进行/ 扰动/ ,/ 设计/ 出/ 抵抗/ 差分/ 代数/ 攻击/ 的/ 新/ 的/ 多/ 变量/ 公钥/ 密码/ ./ 第/ 2/ 节/ 介绍/ 原始/ SFLASH/ 多/ 变量/ 公钥/ 系统/ 以及/ 文献/ [/ 1/ ]/ 设计/ 的/ 扰动/ SFLASH/ —/ —/ —/ pSFLASH/ ;/ 在/ 第/ 3/ 节中/ ,/ 我们/ 简要/ 描述/ 对/ SFLASH/ 的/ 线性化/ 方程/ 攻击/ 和/ 差分/ 代数/ 攻击/ ;/ 在/ 第/ 4/ 节中/ ,/ 我们/ 证明/ pS/ -/ FLASH/ 系统/ 等价/ 于/ 原始/ 的/ SFLASH/ 系统/ ,/ 并/ 给出/ 对/ pSFLASH/ 的/ 实际/ 攻击/ ./ 2SFLASH/ 和/ pSFLASH/ 多/ 变量/ 公钥/ 系统/ SFLASH/ 是/ 一个/ 用于/ 签名/ 的/ 多/ 变量/ 公钥/ 系统/ ,/ 它/ 是/ 2003/ 年/ NESSIE/ 推荐/ 的/ 3/ 个/ 签名/ 算法/ 之一/ ,/ SFLASH/ 算法/ 的/ 签名/ 速度/ 很快/ ,/ 并且/ 适合/ 在/ 一些/ 轻量级/ 设备/ (/ 如/ RFID/ 智能卡/ )/ 上/ 实现/ ,/ 下面/ 我们/ 给出/ SFLASH/ 的/ 描述/ ./ 2.1/ MI/ 和/ SFLASH/ 多/ 变量/ 公钥/ 系统/ 设/ k/ 是/ 一个/ 有/ q/ 个/ 元素/ 且/ 特征/ 为/ 2/ 的/ 有限/ 域/ ,/ 而/ K/ =/ k/ [/ x/ ]/ // g/ (/ x/ )/ 是/ k/ 的/ 一个/ n/ 次/ 扩域/ ,/ 其中/ g/ (/ x/ )/ 是/ k/ [/ x/ ]/ 上/ 的/ n/ 次/ 不可/ 约/ 多项式/ ./ 令/ / :/ K/ →/ kn/ 是/ K/ 与/ kn/ 的/ 自然/ 同构/ ,/ 即/ Matsumoto/ -/ Imai/ (/ MI/ )/ 型/ 多/ 变量/ 公钥/ 系统/ [/ 7/ ]/ 的/ 公钥/ P/ :/ kn/ →/ kn/ 为/ 而/ SFLASH/ 型/ 多/ 变量/ 公钥/ 系统/ 的/ 公钥/ P/ Π/ :/ kn/ →/ kn/ -/ r/ 为/ 其中/ ,/ U/ ,/ T/ 是/ kn/ 到/ kn/ 上/ 的/ 可逆/ 仿射变换/ ;/ Π/ n/ -/ r/ 的/ 作用/ 是/ n/ 个/ 坐标/ 到/ 它/ 前/ n/ -/ r/ 个/ 坐标/ 的/ 投影/ ./ 因此/ ,/ SFLASH/ 是/ 一个/ “/ 减/ ”/ 版本/ 的/ MI/ 系统/ [/ 15/ ]/ ./ 以下/ 记/ Π/ n/ -/ r/ / T/ 为/ T/ Π/ ./ F/ 是/ K/ 到/ K/ 上/ 的/ 一个/ 可逆/ 变换/ ,/ 我们/ 称其为/ 中心/ 映射/ ,/ 按/ 如下/ 的/ 方式/ 定义/ 其中/ gcd/ (/ q/ θ/ +/ 1/ ,/ q/ θ/ -/ 1/ )/ =/ 1/ ./ 因为/ τ/ :/ X/ / Xq/ θ/ 是/ K/ 到/ K/ 上/ 的/ k/ -/ 线性/ 映射/ ,/ 所以/ SFLASH/ 系统/ 的/ 公钥/ 可以/ 写成/ 一组/ k/ 上/ 的/ 二次/ 多项式/ ,/ 形如/ yi/ =/ ∑/ 0/ / j/ / k/ / n/ ξ/ ijkxjxk/ +/ ∑/ 0/ / j/ / n/ 注意/ ,/ 虽然/ 这组/ 多项式/ 是/ 公开/ 的/ ,/ 但/ U/ 和/ T/ 是/ 保密/ 的/ ,/ U/ -/ 1/ 和/ T/ -/ 1/ 作为/ SFLASH/ 系统/ 的/ 私钥/ ./ 对于/ 消息/ 狔/ =/ (/ y0/ ,/ y1/ ,/ …/ ,/ yn/ -/ r/ -/ 1/ )/ T/ ∈/ kn/ -/ r/ ,/ 签名/ 的/ 过程/ 为/ :/ 首先/ 任取/ r/ 个/ k/ 上/ 的/ 元素/ ,/ 把/ 狔/ 补成/ 一个/ n/ 维/ 向量/ z/ ,/ 然后/ 计算/ 狓/ 即/ 为/ 消息/ 狔/ 的/ 签名/ ./ 签名/ 的/ 验证/ 过程/ 为/ :/ 计算/ ω/ =/ P/ Π/ (/ 狓/ )/ ,/ 然后/ 比较/ ω/ 是否/ 与/ 狔/ 相同/ ,/ 如果/ 相同/ ,/ 签名/ 验证/ 通过/ ./ 由于/ P/ 是/ 公开/ 的/ ,/ 所以/ 任何人/ 都/ 可以/ 执行/ 签名/ 验证/ 这个/ 操作/ ./ 但/ 只有/ 私钥/ 拥有者/ ,/ 才能/ 通过/ U/ -/ 1/ 和/ T/ -/ 1/ 来/ 计算/ 签名/ ./ 对于/ 一个/ 想要/ 伪造/ 消息/ 狔/ 的/ 签名/ 的/ 攻击者/ ,/ 伪造/ 签名/ 最/ 直接/ 的/ 方式/ 就是/ 解/ 如下/ 由公钥/ P/ 得到/ 的/ 多项式/ 方程组/ 若/ 得到/ 一个/ 解/ 狓/ ,/ 从而/ P/ Π/ (/ 狓/ )/ =/ 狔/ ./ 然而/ ,/ 解/ 一个/ 有限/ 域/ 上/ 的/ 一般/ 的/ 多项式/ 方程组/ 通常/ 是/ 困难/ 的/ ./ 虽然/ 通过/ 直接/ 解/ 上述/ 方程组/ 来/ 攻击/ SFLASH/ 是/ 困难/ 的/ ,/ 但/ Dubois/ 等/ 人/ 利用/ SFLASH/ 公钥/ 差分/ 的/ 结构/ 攻破/ 了/ 该/ 系统/ [/ 2/ -/ 3/ ]/ ./ 为了/ 抵抗/ 这种/ 差分/ 攻击/ ,/ 文献/ [/ 1/ ]/ 提出/ 了/ 一个/ 新/ 的/ 用于/ 签名/ 的/ 多/ 变量/ 公钥/ 系统/ pSFLASH/ ./ 下面/ 给出/ pSFLASH/ 的/ 具体/ 构造/ ./ Page32/ ./ 2pSFLASH/ 多/ 变量/ 公钥/ 系统/ pSFLASH/ 的/ 构造/ 思想/ 是/ ,/ 对/ 原始/ 的/ SFLASH/ 系统/ 的/ 中心/ 映射/ F/ 进行/ 所谓/ 的/ “/ 噪声/ 扰动/ ”/ ,/ 从而/ 破坏/ 公钥/ 的/ 差分/ 结构/ ./ 定义/ 1/ ./ 定义/ 二元/ 运算/ / :/ K/ ×/ K/ →/ K/ 为/ a/ / b/ =/ / -/ 1/ (/ a0b0/ ,/ a1b1/ ,/ …/ ,/ an/ -/ 1bn/ -/ 1/ )/ ,/ 其中/ (/ a0/ ,/ a1/ ,/ …/ ,/ an/ -/ 1/ )/ =/ / (/ a/ )/ ,/ (/ b0/ ,/ b1/ ,/ …/ ,/ bn/ -/ 1/ )/ =/ / (/ b/ )/ ./ 文献/ [/ 1/ ]/ 称其为/ 噪声/ 运算/ ./ 定义/ 2/ ./ 称/ 〈/ PG/ ,/ / 〉/ =/ {/ β/ :/ β/ ∈/ K/ ,/ / -/ 1/ (/ β/ )/ ∈/ (/ k/ / )/ n/ }/ 为/ SFLASH/ 系统/ 的/ 噪声/ 群/ ,/ 其中/ k/ / 表示/ 有限/ 域/ k/ 的/ 乘法/ 群/ ./ 从/ SFLASH/ 的/ 噪声/ 群中/ 任意/ 取/ 两个/ 元素/ β/ ,/ γ/ ,/ 令/ Fd/ :/ K/ →/ K/ 为/ 现在/ 我们/ 用/ Fd/ 替换/ SFLASH/ 的/ 中心/ 映射/ F/ ,/ 其它/ 运算/ 保持/ 不变/ ,/ 便/ 得到/ 了/ pSFLASH/ 系统/ ,/ 即/ pS/ -/ FLASH/ 的/ 公钥/ 为/ 在/ 以后/ 的/ 讨论/ 中/ ,/ 我们/ 记/ T/ / / / Fd/ / / -/ 1/ / U/ 为/ Q/ ./ 因此/ ,/ Q/ Π/ =/ Π/ n/ -/ r/ / Q/ ./ 文献/ [/ 1/ ]/ 认为/ ,/ SFLASH/ 的/ 中心/ 映射/ 经过/ 这样/ 的/ “/ 噪声/ 扰动/ ”/ ,/ 就/ 可以/ 避免/ 差分/ 代数/ 攻击/ ,/ 下面/ 两节/ 的/ 分析/ 指出/ ,/ 事实上/ 并非如此/ ./ 3/ 对/ SFLASH/ 的/ 攻击/ 3.1/ MI/ 系统/ 的/ 线性化/ 方程/ 攻击/ 由/ Y/ =/ F/ (/ X/ )/ =/ Xq/ θ/ +/ 1/ 可以/ 得到/ 两边/ 同乘/ XY/ ,/ 有/ 而/ 对/ K/ 上/ 的/ 元素/ 进行/ q/ θ/ 和/ q2/ θ/ 次/ 幂/ ,/ 都/ 是/ K/ 上/ 的/ k/ -/ 线性/ 映射/ ,/ 所以/ 对于/ 任意/ 的/ 满足/ 狔/ =/ P/ (/ 狓/ )/ 的/ 狓/ 和/ 狔/ ,/ 其/ 分量/ 一定/ 满足/ 一些/ 形/ 如/ ∑/ i/ ,/ j/ 的/ 多项式/ 方程/ ./ 文献/ [/ 11/ ]/ 的/ 分析表明/ ,/ 对于/ MI/ 系统/ 任意/ 给定/ 的/ 公钥/ ,/ 一定/ 可以/ 找到/ 足够/ 多/ 的/ 、/ 相互/ 独立/ 的/ 形如式/ (/ 2/ )/ 的/ 多项式/ 方程/ ./ 这样/ ,/ 当/ 攻击者/ 想/ 恢复/ 狔/ =/ P/ (/ 狓/ )/ 的/ 原象/ 时/ ,/ 他/ 并不需要/ 去解/ 由/ 狔/ =/ P/ (/ 狓/ )/ 对应/ 的/ 多项式/ 方程组/ ,/ 而是/ 将/ 狔/ 代入/ 形如式/ (/ 2/ )/ 的/ 多项式/ 方程组/ ,/ 此时/ 便/ 得到/ 了/ 一个/ 关于/ xi/ 的/ 线性方程组/ ,/ 解/ 这个/ 线性方程组/ 便/ 可以/ 得到/ 狔/ 在/ P/ 下/ 的/ 原象/ 狓/ ./ 这种/ 恢复原/ 象/ 的/ 过程/ ,/ 就是/ 著名/ 的/ 线性化/ 方程/ 攻击/ [/ 7/ ]/ ./ 为了/ 避免/ 上述/ 线性化/ 方程/ 攻击/ ,/ SFLASH/ 的/ 设计者/ 在/ MI/ 系统/ 的/ 中心/ 映射/ P/ 的/ 基础/ 上/ 加入/ 了/ 一个/ 投影/ 映射/ Π/ n/ -/ r/ ,/ 即/ 隐藏/ 了/ 由/ P/ (/ 狓/ )/ 导出/ 的/ 多项式/ 方程组/ 的/ 最后/ r/ 个/ 多项式/ ./ 文献/ [/ 15/ ]/ 的/ 分析表明/ ,/ 攻击者/ 无法/ 直接/ 利用/ 这样/ 处理/ 后/ 所/ 得到/ 的/ 公钥/ 多项式/ 组/ ,/ 找到/ 足够/ 多/ 的/ 、/ 相互/ 独立/ 的/ 形如式/ (/ 2/ )/ 的/ 多项式/ 方程组/ ,/ 从而/ 线性化/ 方程/ 攻击/ 对/ SFLASH/ 失效/ ./ 3.2/ SFLASH/ 的/ 差分/ 代数/ 攻击/ 由/ 上/ 一/ 小节/ 的/ 分析/ 可知/ ,/ 如果/ 我们/ 能克服/ SFLASH/ 系统/ 中/ 投影变换/ Π/ n/ -/ r/ 的/ 作用/ ,/ 便/ 有/ 可能/ 利用/ 线性化/ 方程/ 攻击/ 来/ 伪造/ SFLASH/ 系统/ 的/ 合法/ 签名/ ./ 而/ SFLASH/ 系统/ 公钥/ 差分/ 的/ 对称/ 性质/ ,/ 使得/ 攻击者/ 可以/ 达到/ 这一/ 目的/ [/ 2/ -/ 3/ ]/ ./ 为了/ 叙述/ 方便/ ,/ 下面/ 不再/ 显式/ 地/ 写出/ 自然/ 同构/ 映射/ / ,/ 当/ 运算/ 需要/ 时/ ,/ 我们/ 认为/ 所/ 考虑/ 的/ 元素/ 或/ 向量/ 被/ 自然/ 地/ 同构/ 映射/ 或/ 逆映射/ 到/ 相应/ 的/ 向量/ 或域/ 元素/ ./ 另外/ ,/ 假设/ 所有/ 可逆/ 仿射变换/ 为/ 可逆/ 线性变换/ ,/ 这/ 并/ 不/ 影响/ 分析/ ,/ 具体/ 细节/ 参考文献/ [/ 16/ -/ 18/ ]/ ./ 首先/ ,/ 引入/ 差分/ 算子/ D/ :/ Df/ (/ a/ ,/ x/ )/ =/ f/ (/ a/ +/ x/ )/ -/ f/ (/ a/ )/ -/ f/ (/ x/ )/ +/ f/ (/ 0/ )/ ,/ 则/ 对于/ SFLASH/ 系统/ 的/ 中心/ 映射/ F/ ,/ 有/ 对于/ / ξ/ ∈/ K/ ,/ 可以/ 得到/ DF/ (/ ξ/ ·/ a/ ,/ x/ )/ +/ DF/ (/ a/ ,/ ξ/ ·/ x/ )/ =/ (/ ξ/ +/ ξ/ q/ θ/ )/ ·/ DF/ (/ a/ ,/ x/ )/ 这是/ MI/ 系统/ 中心/ 映射/ 的/ 差分/ 具备/ 的/ 一个/ 重要/ 的/ 对称/ 性质/ ./ 令/ P/ =/ T/ / / / F/ / / -/ 1/ / U/ ,/ 则/ 由/ DP/ (/ a/ ,/ x/ )/ =/ T/ / DF/ (/ U/ (/ a/ )/ ,/ U/ (/ x/ )/ )/ 与/ 式/ (/ 3/ )/ 可以/ 得到/ T/ / DF/ (/ ξ/ ·/ U/ (/ a/ )/ ,/ U/ (/ x/ )/ )/ +/ T/ / DF/ (/ U/ (/ a/ )/ ,/ ξ/ ·/ U/ (/ x/ )/ )/ =/ T/ / (/ ξ/ +/ ξ/ q/ θ/ )/ ·/ DF/ (/ U/ (/ a/ )/ ,/ U/ (/ x/ )/ )/ =/ T/ / (/ ξ/ +/ ξ/ q/ θ/ )/ ·/ T/ -/ 1/ (/ DP/ (/ a/ ,/ x/ )/ )/ ./ 用/ M/ ξ/ ,/ ML/ (/ ξ/ )/ 和/ N/ ξ/ 分别/ 表示/ 映射/ M/ ξ/ :/ x/ / ξ/ ·/ x/ ,/ ML/ (/ ξ/ )/ :/ x/ / (/ ξ/ +/ ξ/ q/ θ/ )/ ·/ x/ 和/ N/ ξ/ :/ x/ / U/ -/ 1/ / M/ ξ/ / U/ (/ x/ )/ ./ 将/ Π/ n/ -/ r/ 作用/ 到/ 上式/ ,/ 得到/ 其中/ Λ/ (/ L/ (/ ξ/ )/ )/ 表示/ 映射/ T/ Π/ / ML/ (/ ξ/ )/ / T/ -/ 1/ ./ 当/ U/ 固定/ 时/ ,/ {/ N/ ξ/ :/ ξ/ ∈/ K/ }/ 是/ 一个/ 由/ 线性变换/ 组成/ 的/ n/ 维/ k/ -/ 线性/ 空间/ ,/ 它/ 是/ 由/ 全体/ 线性变换/ 组成/ 的/ n2/ 维/ k/ -/ 线性/ 空间/ 的/ 一个/ 子/ 空间/ ./ 而/ 一般/ 的/ 线性变换/ 并/ 不/ 满足/ 上/ 式/ ,/ 由此/ 可以/ 用/ 简单/ 的/ 线性代数/ 很/ 容易/ 地/ 计算/ 出/ 这个/ 子/ Page4/ 空间/ ,/ 请/ 参考文献/ [/ 2/ -/ 3/ ]/ ./ 实际上/ ,/ 由/ 这个/ 子/ 空间/ 还/ 可以/ 计算/ 出/ U/ 的/ 一部分/ 信息/ ,/ 见/ 文献/ [/ 19/ ]/ ,/ 不过/ 下面/ 的/ 分析/ 并不需要/ 这/ 一点/ ./ 注意/ ,/ 在/ 复合/ 映射/ P/ Π/ (/ 狓/ )/ =/ Π/ n/ -/ r/ / T/ / / / F/ / / -/ 1/ / U/ (/ 狓/ )/ 式/ 中/ ,/ T/ 的/ 作用/ 实质/ 上/ 是/ 通过/ 对/ / / F/ / / -/ 1/ / U/ (/ 狓/ )/ 的/ 分量/ 多项式/ 进行/ 新/ 的/ 线性组合/ 得到/ 一组/ 新/ 的/ 分量/ 多项式/ ./ 如果/ 能/ 在/ T/ Π/ =/ Π/ n/ -/ r/ / T/ 的/ 复合/ 之前/ 引入/ 一个/ 新/ 的/ 线性变换/ ,/ 则/ 很/ 可能/ 得到/ 一些/ 与/ P/ Π/ 所/ 对应/ 的/ 多项式/ 组/ 线性/ 独立/ 的/ 多项式/ ,/ 从而/ 得到/ 与/ MI/ 系统/ 等价/ 的/ 公钥/ 多项式/ ,/ 进而/ 利用/ 线性化/ 方程/ 攻击/ ,/ 就/ 可以/ 伪造/ 出/ SFLASH/ 系统/ 的/ 合法/ 签名/ ./ 注意/ 到/ P/ Π/ / N/ ξ/ =/ T/ Π/ / F/ / U/ / (/ U/ -/ 1/ / M/ ξ/ / U/ )/ 由于/ T/ Π/ / M/ ξ/ q/ θ/ +/ 1/ 与/ Π/ n/ -/ r/ / T/ 一般/ 是/ 线性/ 独立/ 的/ 线性变换/ ,/ 所以/ 利用/ P/ Π/ / N/ ξ/ ,/ 就/ 可以/ 得到/ 所/ 需/ 的/ 与/ P/ Π/ 所/ 对应/ 的/ 多项式/ 组/ 线性/ 独立/ 的/ 公钥/ 多项式/ ./ 实验/ 证明/ ,/ 这种/ 方法/ 是/ 完全/ 可行/ 的/ [/ 2/ -/ 3/ ]/ ./ 4/ 对/ SFLASH/ 及/ pSFLASH/ 的/ 攻击/ 4.1/ 理论/ 分析/ 对于/ pSFLASH/ 系统/ 的/ 中心/ 映射/ Fd/ ,/ 我们/ 有/ DFd/ (/ a/ ,/ x/ )/ =/ β/ / a/ ·/ (/ β/ / x/ )/ q/ θ/ +/ (/ β/ / a/ )/ q/ θ/ ·/ β/ / x/ ./ pSFLASH/ 的/ 设计者/ 认为/ ,/ 由于/ β/ 是/ 未知/ 的/ ,/ 所以/ 上述/ 差分/ 攻击/ 对/ SFLASH/ 无效/ ./ 我们/ 指出/ ,/ pSFLASH/ 公钥/ 系统/ 与/ SFLASH/ 系统/ 实质/ 上/ 是/ 等价/ 的/ ./ 定理/ 1/ ./ 对于/ 任意/ 给定/ 的/ β/ ,/ γ/ ∈/ 〈/ PG/ ,/ / 〉/ ,/ 一定/ 存在/ 仿射变换/ 珦/ U/ ,/ 使得/ 对/ 任意/ 的/ x/ ∈/ kn/ ,/ 有/ 其中/ Q/ Π/ 是/ pSFLASH/ 系统/ 的/ 公钥/ 映射/ ./ 证明/ ./ 设/ 可逆/ 仿射变换/ U/ 为/ U/ (/ 狓/ )/ ·/ ·/ =/ 犃/ 狓/ +/ 犫/ ,/ 其中/ 犃/ 是/ k/ 上/ n/ ×/ n/ 可逆/ 矩阵/ ,/ 犫/ 为/ k/ 上/ 的/ n/ 维常/ 向量/ ./ 令/ 犃/ 狓/ +/ 犫/ =/ 狌/ =/ (/ u0/ ,/ u1/ ,/ …/ ,/ un/ -/ 1/ )/ T/ ,/ 并令/ 珦/ U/ (/ 狓/ )/ =/ 犕/ 犃/ 狓/ +/ 犕/ 犫/ +/ γ/ =/ 犕/ (/ 犃/ 狓/ +/ 犫/ )/ +/ γ/ ,/ 可见/ 珦/ U/ 仍然/ 是/ 一个/ 可逆/ 的/ 仿射变换/ ./ 此时/ ,/ 我们/ 有/ 它/ 进一步/ 等于/ 珟/ P/ =/ 烄/ T/ / / -/ 1/ 烆/ 烄/ 烆/ T/ (/ / (/ (/ / -/ 1/ (/ β/ 0u0/ +/ β/ 1u1/ +/ …/ +/ β/ n/ -/ 1un/ -/ 1/ )/ )/ q/ θ/ +/ 1/ )/ )/ =/ T/ (/ / (/ (/ β/ / 狌/ +/ γ/ )/ q/ θ/ +/ 1/ )/ )/ =/ T/ (/ / (/ (/ β/ / (/ 犃/ 狓/ +/ 犫/ )/ +/ γ/ )/ q/ θ/ +/ 1/ )/ )/ =/ Q/ (/ 狓/ )/ ./ 上述/ 等式/ 两边/ 同时/ 作用/ 投影/ 映射/ Π/ n/ -/ r/ ,/ 得到/ 也就是说/ ,/ 只要/ 把/ pSFLASH/ 系统/ 中/ 的/ 秘密/ 仿射变换/ U/ 换成/ 珦/ U/ ,/ 并/ 去掉/ pSFLASH/ 对/ SFLASH/ 系统/ 中心/ 映射/ F/ 的/ 扰动/ ,/ 则/ pSFLASH/ 系统/ 变成/ SFLASH/ 系统/ ./ 由前/ 一节/ 的/ 分析/ 可以/ 看出/ ,/ 对/ SFLASH/ 的/ 差分/ 攻击/ 与/ 仿射变换/ U/ 的/ 选取/ 无关/ ./ 4.2/ 实验/ 数据/ 下面/ 给出/ 伪造/ pSFLASH/ 消息/ 狔/ ∈/ kn/ -/ r/ 的/ 签名/ 的/ 具体步骤/ 并/ 给出/ 相应/ 的/ 实验/ 结果/ ./ 1/ ./ 把/ pSFLASH/ 的/ 公钥/ 多项式/ 组/ Q/ Π/ 看成/ 一组/ SFLASH/ 系统/ 对应/ 的/ 公钥/ 多项式/ ./ 利用/ 差分/ 攻击/ ,/ 求/ 出/ 相应/ 的/ 线性/ 空间/ {/ N/ ξ/ :/ ξ/ ∈/ K/ }/ ./ 它/ 是/ 线性变换/ 的/ 集合/ ./ 2/ ./ 从/ {/ N/ ξ/ :/ ξ/ ∈/ K/ }/ 中/ 任选/ 一/ 线性变换/ ,/ 计算/ Q/ Π/ / N/ ξ/ (/ 狓/ )/ ,/ 从而/ 得到/ n/ -/ r/ 个/ 多项式/ ,/ 从/ 这/ n/ -/ r/ 个/ 多项式/ 中/ 随机/ 选取/ r/ 个/ ,/ 加入/ 到/ 由/ Q/ Π/ (/ 狓/ )/ 对应/ 的/ 公钥/ 多项式/ 组中/ 去/ ,/ 记新/ 得到/ 的/ 公钥/ 多项式/ 组为/ 珟/ Q/ (/ 狓/ )/ ./ 3/ ./ 对/ 珟/ Q/ (/ 狓/ )/ 实施/ 线性化/ 方程/ 攻击/ ,/ 得到/ 狓/ ,/ 验证/ Q/ Π/ (/ 狓/ )/ =/ 狔/ 因为/ SFLASH/ 两个/ 推荐/ 版本/ 的/ 参数/ 为/ :/ SFLASHv2/ —/ q/ =/ 27/ ,/ n/ =/ 37/ ,/ θ/ =/ 11/ ,/ r/ =/ 11/ ;/ SFLASHv3/ —/ q/ =/ 27/ ,/ n/ =/ 67/ ,/ θ/ =/ 33/ ,/ r/ =/ 11/ ,/ 所以/ 我们/ 选取/ 的/ 攻击/ 目标/ 的/ 参数/ 都/ 与/ 上述/ 参数/ 相同/ 或/ 相近/ ,/ 在/ 一台/ 内存/ 为/ 3.25/ GB/ ,/ 主频/ 为/ 2.83/ GHz/ ,/ Intel/ (/ R/ )/ Core/ (/ TM/ )/ 2QuadCPU/ 的/ 计算机/ 上/ ,/ 我们/ 用/ Magma/ 代数/ 系统/ 实现/ 了/ 上述/ 攻击/ (/ 只用/ 了/ 单核/ )/ ,/ 实验/ 结果/ 见表/ 1/ ,/ 另外/ 我们/ 在/ 附录/ 中/ 给出/ 了/ 一个/ 小规模/ 的/ 例子/ ./ 其中/ 表/ 1/ 中/ 预计/ 算/ 耗时/ 一行/ 中/ 显示/ 的/ 是/ 恢复/ {/ N/ ξ/ :/ ξ/ ∈/ K/ }/ 的/ 时间/ 与/ 恢复/ r/ 个/ 缺失/ 多项式/ 所用/ 时间/ 之/ 和/ ./ 是否/ 成立/ ,/ 如果/ 成立/ ,/ 签名/ 伪造/ 成功/ ,/ 否则/ 重复/ 步/ 2/ ./ qn/ θ/ r/ 预计/ 算/ 耗时/ // s/ 伪造/ 签名/ 耗时/ // s273681168/ +/ 527371111100/ +/ 232740812121/ +/ 1727441213140/ +/ 56276733113523/ +/ 8122712833132210/ +/ 513Page5/ 实验/ 表明/ ,/ 在/ 各种/ 典型/ 的/ 参数/ 下/ ,/ 对/ 一个/ 给定/ 的/ pSFLASH/ 系统/ ,/ 通过/ 最/ 多/ 两个/ 小时/ 的/ 预计/ 算后/ (/ 此/ 预计/ 算/ 对/ 一个/ 给定/ 的/ 公钥/ 是/ 一次性/ 的/ )/ ,/ 对/ 任意/ 消息/ 狔/ ,/ 我们/ 可以/ 在/ 几秒钟/ 内/ 伪造/ 一个/ 合法/ 的/ pSFLASH/ 签名/ ./ 从而/ ,/ 文献/ [/ 1/ ]/ 中/ 的/ 扰动/ 方法/ 对/ 原始/ 算法/ 安全性/ 的/ 加强/ 是/ 无效/ 的/ ./ 5/ 结束语/ 在/ 本文/ 中/ ,/ 我们/ 证明/ 了/ pSFLASH/ 系统/ 与/ SFLASH/ 系统/ 在/ 不/ 考虑/ 公钥/ 中/ 的/ 两个/ 可逆/ 仿射变换/ 的/ 意义/ 下/ 是/ 等价/ 的/ ,/ 因此/ 利用/ 差分/ 攻击/ 和/ 线性化/ 方程/ 攻击/ 可以/ 给出/ 一个/ 对/ pSFLASH/ 的/ 实际/ 攻击/ ,/ pSFLASH/ 系统/ 是/ 完全/ 不/ 安全/ 的/ ./ 实际上/ ,/ 通过/ 简单/ 的/ 扰动/ 来/ 增强/ 类似/ 于/ SFLASH/ 这样/ 的/ 公钥/ 系统/ 的/ 安全性/ 是/ 相当/ 困难/ 的/ 问题/ [/ 20/ -/ 21/ ]/ ,/ 这方面/ 的/ 研究/ 仍然/ 是/ 一个/ 公开/ 课题/ ./ 

