Page1/ 一种/ 基于/ 选择性/ 协同/ 学习/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 方法/ 陆悠/ 1/ )/ ,/ 2/ )/ 李伟/ 1/ )/ 罗军舟/ 1/ )/ 蒋健/ 1/ )/ 夏怒/ 1/ )/ 1/ )/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 210096/ )/ 2/ )/ (/ 苏州/ 科技/ 学院/ 电子/ 与/ 信息/ 工程学院/ 江苏/ 苏州/ 215000/ )/ 摘要/ 为了/ 快速/ 准确/ 检测/ 网络/ 用户/ 的/ 异常/ 行为/ ,/ 机器/ 学习/ 技术/ 得到/ 了/ 广泛应用/ ./ 但/ 随着/ 用户/ 规模/ 的/ 扩大/ 及/ 用户/ 行为/ 的/ 复杂化/ ,/ 基于/ 机器/ 学习/ 的/ 传统/ 检测/ 方法/ 面临/ 着/ 大量/ 标记/ 训练样本/ 而/ 导致/ 的/ 巨大/ 开销/ 、/ 实际/ 网络/ 用户/ 异常/ 行为/ 数据/ 非/ 平衡性/ 而/ 导致/ 的/ 检测/ 准确性/ 不足/ 等/ 问题/ ./ 因此/ ,/ 将/ 选择性/ 集成/ 技术/ 引入/ 到/ 协同/ 学习/ 过程/ 中/ ,/ 提出/ 了/ 一种/ 基于/ 选择性/ 协同/ 学习/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 方法/ ,/ 使用/ 基于/ 多数/ 类/ 分布/ 的/ 改进/ EasyEnsemble/ 方法/ 将/ 非/ 平衡/ 训练样本/ 划分/ 为/ 平衡/ 的/ 样本/ 子集/ ,/ 然后/ 使用/ 基于/ 混合/ 扰动/ 的/ 生成/ 方法/ 构造/ 差异性/ 成员/ 分类器/ 对/ 样本/ 子集/ 进行/ 协同/ 学习/ ,/ 在/ 学习/ 过程/ 中/ 使用/ 选择性/ 集成/ 进行/ 置信度/ 计算/ 与/ 数据/ 更新/ 以/ 减少/ 开销/ ,/ 并/ 基于/ 准确性/ 选择/ 构建/ 集成/ 分类器/ 用于/ 实际/ 检测/ ,/ 使得/ 检测/ 方法/ 在/ 获得/ 非/ 平衡性/ 复杂/ 分布/ 数据/ 的/ 处理/ 能力/ 的/ 同时/ 进一步提高/ 检测/ 准确性/ ./ 实验/ 结果表明/ ,/ 该/ 方法/ 较/ 传统/ 方法/ 减少/ 了/ 对/ 训练样本/ 中/ 标记/ 数据/ 的/ 需求/ ,/ 同时/ 在/ 准确性/ 评价/ 指标/ 上/ 表现/ 更好/ ,/ 能/ 更/ 快速/ 准确/ 地/ 检测/ 出/ 网络/ 用户/ 的/ 异常/ 行为/ ./ 关键词/ 网络/ 用户/ 异常/ 行为/ 检测/ ;/ 协同/ 学习/ ;/ 选择性/ 集成/ 学习/ ;/ 支持/ 向量/ 机/ ;/ 机器/ 学习/ 1/ 引言/ 网络/ 用户/ 异常/ 行为/ 是/ 网络/ 面临/ 的/ 一大/ 威胁/ ,/ 所谓/ 异常/ 行为/ ,/ 顾名思义/ ,/ 是/ 指/ 与/ 正常/ 行为/ 相对/ 应/ ,/ 由/ 网络/ 用户/ 实施/ 的/ 对/ 网络/ 正常/ 运行/ 造成/ 影响/ 的/ 行为/ ,/ 例如/ 传播/ 蠕虫/ 、/ DDoS/ 攻击/ 等/ ./ 这些/ 行为/ 会/ 造成/ 网络/ 服务质量/ 急剧下降/ ,/ 网络/ 负载/ 加重/ 甚至/ 瘫痪/ 等/ 后果/ ./ 随着/ 网络/ 快速/ 发展/ ,/ 网络/ 用户/ 异常/ 行为/ 的/ 新/ 变种/ 以及/ 新/ 行为/ 层出不穷/ ,/ 其/ 威胁/ 也/ 日益严重/ ./ 因此/ 无论是/ 加强/ 对/ 用户/ 行为/ 的/ 管控/ ,/ 还是/ 保障/ 网络/ 的/ 正常/ 运行/ ,/ 都/ 要求/ 能够/ 对/ 网络/ 用户/ 的/ 异常/ 行为/ 实施/ 快速/ 、/ 准确/ 的/ 检测/ [/ 1/ -/ 2/ ]/ ./ 早期/ 人们/ 通常/ 采用/ 端口扫描/ 、/ 报文/ 特征/ 字/ 段/ 匹配/ 等/ 方法/ 对/ 异常/ 行为/ 进行/ 深入分析/ 以/ 获取/ 特征/ ,/ 从而/ 实现/ 网络/ 用户/ 异常/ 行为/ 的/ 检测/ ./ 然而/ ,/ 随着/ 用户/ 异常/ 行为/ 不断/ 变化/ ,/ 依靠/ 人工/ 对/ 异常/ 行为/ 进行/ 分析/ 以/ 获取/ 特征/ 的/ 代价/ 越来越/ 高昂/ 甚至/ 不/ 可行/ [/ 3/ ]/ ./ 随着/ 人工智能/ 技术/ 的/ 发展/ ,/ 机器/ 学习/ 技术/ 更/ 多/ 地被/ 用于/ 从/ 网络/ 数据/ 中/ 自动/ 计算/ 异常/ 行为/ 模式/ 、/ 提取/ 其/ 特征/ ,/ 从而/ 自动/ 产生/ 检测/ 规则/ ,/ 大大降低/ 了/ 开发/ 代价/ [/ 3/ ]/ ./ 根据/ 使用/ 的/ 机器/ 学习/ 技术/ 不同/ ,/ 检测/ 方法/ 大致/ 分为/ 以下/ 几类/ :/ (/ 1/ )/ 基于/ 无/ 监督/ 学习/ (/ UnsupervisedLearning/ )/ 的/ 检测/ 方法/ ./ 这类/ 方法/ 无需/ 使用/ 有/ 标记/ 的/ 训练样本/ ,/ 通过/ 聚类/ [/ 4/ ]/ 、/ 自/ 组织/ 图/ (/ Self/ -/ OrganizingMap/ ,/ SOM/ )/ [/ 5/ ]/ 等/ 算法/ 实现/ 对/ 异常/ 模式/ 的/ 自动/ 获取/ ./ 但/ 该类/ 方法/ 训练/ 开销/ 大/ ,/ 分类/ 模型/ 可读性/ 差/ ,/ 检测/ 率低/ ./ (/ 2/ )/ 基于/ 监督/ 学习/ (/ SupervisedLearning/ )/ 的/ 检测/ 方法/ ./ 这类/ 方法/ 需要/ 使用/ 有/ 标记/ 的/ 训练样本/ ,/ 按/ 分类器/ 类型/ 不同/ ,/ 有隐/ 马尔可夫/ 模型/ [/ 6/ ]/ 、/ 贝叶斯/ 网络/ [/ 7/ ]/ 、/ 决策树/ [/ 8/ ]/ 及/ 支持/ 向量/ 机/ (/ SupportVectorMachine/ ,/ SVM/ )/ [/ 9/ -/ 12/ ]/ 等/ 不同/ 方法/ ./ 该类/ 方法/ 在/ 准确性/ 、/ 模型/ 可读性/ 等/ 方面/ 优于/ 无/ 监督/ 学习/ 的/ 检测/ 方法/ ,/ 但/ 其/ 对/ 训练样本/ 中/ 标记/ 数据/ 数量/ 及/ 分布/ 平衡性/ 等/ 方面/ 要求/ 较/ 高/ ,/ 实际/ 应用/ 时/ 为了/ 获取/ 标记/ 数据/ ,/ 往往/ 需/ 积累/ 不同/ 时间段/ 甚至/ 不同/ 网络/ 环境/ 数据/ 并/ 进行/ 大量/ 的/ 筛选/ 与/ 标记/ 工作/ ,/ 不但/ 开销/ 巨大/ ,/ 甚至/ 还会/ 损失/ 实际/ 数据/ 的/ 分布/ 情况/ ,/ 进而/ 影响/ 检测/ 结果/ 的/ 准确性/ ./ (/ 3/ )/ 基于/ 半/ 监督/ 学习/ (/ Semi/ -/ supervisedLearning/ )/ 的/ 检测/ 方法/ ./ 半/ 监督/ 学习/ 又/ 称为/ 协同/ 学习/ (/ Collabo/ -/ rativeLearning/ )/ ,/ 通过/ 生成/ 的/ 若干/ 成员/ 分类器/ 进行/ 协作/ 学习/ ,/ 能够/ 充分利用/ 蕴含/ 在/ 无/ 标记/ 训练样本/ 中/ 的/ 信息/ ,/ 从而/ 降低/ 了/ 对/ 训练样本/ 数据/ 进行/ 标记/ 的/ 数量/ 要求/ ,/ 在/ 检测/ 准确性/ 和/ 标记/ 训练样本/ 数量/ 之间/ 取得/ 了/ 较/ 好/ 的/ 折中/ [/ 13/ -/ 14/ ]/ ./ 目前/ 已/ 得到/ 广泛应用/ ,/ 例如/ Zhang/ 等/ 人/ [/ 15/ ]/ 分析/ 了/ 协同/ 学习/ 对/ 聚类/ 相关/ 应用/ 的/ 效果/ ,/ Erman/ 等/ 人/ [/ 16/ ]/ 首次/ 将/ 协同/ 学习/ 应用/ 于/ 实时/ 流量/ 分类/ 并/ 验证/ 了/ 有效性/ ,/ Meng/ 等/ 人/ [/ 17/ ]/ 提出/ 基于/ SVM/ 协同/ 学习/ 方法/ 用于/ 修正/ 入侵/ 检测/ 的/ 误报率/ ,/ Li/ 等/ 人/ [/ 18/ ]/ 分析/ 了/ 将/ Tri/ -/ Training/ 协同/ 学习/ 方法/ 应用/ 于/ 主机/ 系统/ 入侵/ 检测/ 的/ 效果/ 等等/ ./ 虽然/ 协同/ 学习/ 方法/ 能够/ 因/ 只/ 需/ 部分/ 标记/ 的/ 训练样本/ 数据/ 而/ 降低/ 系统/ 开销/ ,/ 但/ 其/ 通常/ 假设/ 训练样本/ 是/ 均匀/ 和/ 平衡/ 的/ ,/ 而/ 实际/ 的/ 网络/ 环境/ 中/ ,/ 包含/ 网络/ 用户/ 异常/ 行为/ 的/ 网络/ 数据/ 中/ 存在/ 着/ 明显/ 的/ 非/ 平衡性/ 和/ 分布/ 复杂性/ [/ 19/ ]/ ,/ 若/ 将/ 协同/ 学习/ 方法/ 直接/ 用于/ 网络/ 用户/ 异常/ 行为/ 的/ 检测/ ,/ 则/ 其/ 生成/ 的/ 成员/ 分类器/ 会/ 产生/ 过/ 拟合/ (/ overfit/ )/ 现象/ ,/ 从而/ 影响/ 协同/ 学习/ 的/ 效果/ 、/ 降低/ 检测/ 的/ 准确性/ ./ 为了/ 解决/ 上述/ 问题/ ,/ 本文/ 将/ 选择性/ 集成/ 学习/ (/ SelectiveEssembleLearning/ )/ 技术/ 引入/ 到/ 协同/ 学习/ 过程/ 中/ ,/ 提出/ 了/ 一种/ 基于/ 选择性/ 协同/ 学习/ (/ SelectiveCollaborativeLearning/ )/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 方法/ ,/ 以/ 提升/ 协同/ 学习/ 方法/ 处理/ 非/ 平衡/ 复杂/ 分布/ 数据/ 的/ 能力/ ,/ 提高/ 网络/ 用户/ 异常/ 行为/ 的/ 检测/ 准确性/ ./ 该/ 方法/ 在/ 训练样本/ 处理/ 环节/ 使用/ 改进/ 的/ EasyEssemble/ 方法/ ,/ 针对/ 训练样本/ 存在/ 非/ 平衡性/ 、/ 多数/ 类/ 分布/ 复杂/ 以及/ 部分/ 标记/ 的/ 特点/ ,/ 在/ 分析/ 多数/ 类/ 分布/ 基础/ 上将/ 非/ 平衡/ 训练样本/ 划分/ 为/ 多个/ 均衡/ 且/ 保留/ 原/ 分布/ 信息/ 的/ 训练样本/ 子集/ ,/ 分别/ 供/ 成员/ 分类器/ 训练/ ;/ 在/ 成员/ 分类器/ 生成/ 环节/ ,/ 结合/ 训练样本/ 处理/ 方法/ ,/ 使用/ 样本/ 子/ 空间/ 、/ 样本/ 子/ 空间/ 特征/ 和/ 分类器/ 参数/ 互相/ 组合/ 的/ 混合/ 扰动/ 方法/ 生成/ 足够/ 数量/ 且/ 具备/ 差异性/ 的/ 成员/ 分类器/ ,/ 然后/ 在/ 成员/ 分类器/ 的/ 训练/ 过程/ 中/ 使用/ 选择性/ 集成/ 结果/ 计算/ 置信度/ 及/ 更新/ 数据/ 以/ 降低/ 开销/ ,/ 最后/ 在/ 集成/ 环节/ 则/ 根据/ 所有/ 成员/ 分类器/ 在/ 训练/ 过程/ 中/ 积累/ 的/ 准确性/ 进行/ 选择/ 和/ 组合/ ,/ 构造/ 最终/ 的/ 集成/ 分类器/ 用于/ 网络/ 用户/ 异常/ 行为/ 的/ 检测/ ./ 实验/ 结果表明/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 减少/ 对/ 标记/ 数据/ 需求/ 、/ 降低/ 系统/ 开销/ 以及/ 提高/ 检测/ 准确性/ 等/ 方面/ 均/ 优于/ 其它/ 基于/ 机器/ 学习/ 的/ 传统/ 检测/ 方法/ ./ 本文/ 第/ 2/ 节/ 介绍/ 网络/ 用户/ 异常/ 行为/ 检测/ 模型/ ;/ 第/ 3/ 节/ 描述/ 选择性/ 协同/ 学习/ 方法/ ,/ 包括/ 训练样本/ 处理/ 、/ 成员/ 分类器/ 生成/ 以及/ 分类器/ 的/ 选择性/ 集成/ ;/ 第/ 4/ 节/ 介绍/ 网络/ 用户/ 异常/ 行为/ 检测/ 方法/ ;/ 第/ 5/ 节对/ 本文/ 方法/ 进行/ 实验/ 验证/ 分析/ ;/ 第/ 6/ 节为/ 总结/ 和/ 展望/ ./ Page32/ 网络/ 用户/ 异常/ 行为/ 检测/ 模型/ 2.1/ 相关/ 概念/ 用户/ 不同/ 的/ 网络/ 行为/ 数据/ 往往/ 具有/ 不同/ 的/ 统计/ 特征/ ,/ 这些/ 特征/ 反映/ 行为/ 的/ 内在/ 特性/ ./ 基于/ 选择性/ 协同/ 学习/ 的/ 用户/ 异常/ 行为/ 检测/ ,/ 实质/ 即/ 使用/ 选择性/ 协同/ 学习/ 方法/ 自/ 适应/ 地/ 学习/ 用户/ 正常/ 和/ 异常/ 行为/ 在/ 不同/ 统计/ 特征/ 上/ 的/ 差异/ ,/ 以此/ 检测/ 异常/ 行为/ ./ 为/ 更好/ 地/ 描述/ 检测/ 方法/ ,/ 本文/ 给出/ 如下/ 定义/ ./ 定义/ 1/ ./ 网络/ 用户/ 异常/ 行为/ ./ 即/ 影响/ 网络/ 平稳/ 运行/ 的/ 用户/ 某/ 类型/ 特定/ 行为/ ,/ 例如/ 某种/ DDoS/ 攻击行为/ 、/ 过度/ 占用/ 带宽/ 的/ P2P/ 下载/ 应用/ 等/ ./ 本文/ 使用/ Object/ 来/ 表示/ 需要/ 被/ 检测/ 的/ 异常/ 网络/ 行为/ ./ 定义/ 2/ ./ 检测/ 特征/ 指标/ 集/ ./ 即/ 用户/ 网络/ 行为/ 流量/ 中/ 具备/ 的/ 可能/ 包含/ 用户/ 正常/ 和/ 异常/ 行为/ 差异/ 的/ 可/ 统计/ 考察/ 因素/ 集/ ,/ 如流/ 持续时间/ 、/ 报文/ 到达/ 间隔/ 等/ ,/ 使用/ 向量/ 犉/ object/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ Cn/ }/ 表示/ ,/ 其中/ Ci/ (/ i/ ∈/ [/ 1/ ,/ n/ ]/ )/ 表示/ 第/ i/ 项/ 考察/ 因素/ ./ 为了/ 保证/ 检测/ 方法/ 的/ 有效性/ ,/ 须/ 选择/ 对/ 用户/ 应用/ 覆盖面/ 较广/ 的/ 特征/ 指标/ 集/ 犉/ object/ ./ 目前/ 在/ 流量/ 识别/ 、/ 网络安全/ 等/ 领域/ 已有/ 较/ 多/ 研究成果/ 可/ 借鉴/ ,/ 如/ 文献/ [/ 20/ ]/ 提出/ 了/ 高达/ 246/ 种/ 候选/ 指标/ 等等/ ./ 但/ 在/ 具体/ 的/ 异常/ 行为/ 识别/ 环境/ 中/ ,/ 考虑/ 这些/ 考察/ 因素/ 在/ 采集/ 以及/ 数据处理/ 时/ 的/ 可行性/ 和/ 效率/ 因素/ ,/ 可以/ 有/ 选择地/ 去除/ 一些/ 冗余/ 或/ 难以/ 采集/ 的/ 特征/ 指标/ ./ 定义/ 3/ ./ 网络/ 用户/ 行为/ 数据/ :/ 即/ 按/ 检测/ 特征/ 指标/ 集对/ 网络流量/ 进行/ 采集/ 和/ 预处理/ 后/ 所得/ 的/ 网络/ 用户/ 行为/ 具体/ 数据/ ,/ 基于/ 给定/ 的/ 检测/ 特征/ 指标/ 集/ 犉/ object/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ Cn/ }/ ,/ 当前/ 收集/ 到/ 的/ 第/ i/ 条/ 用户/ 行为/ 数据/ 可以/ 使用/ 向量/ 犃/ 犮/ 狋/ 犻/ 狅/ 狀/ i/ =/ {/ xi1/ ,/ xi2/ ,/ …/ ,/ xin/ }/ 表示/ ,/ 其中/ xij/ (/ j/ ∈/ [/ 1/ ,/ n/ ]/ )/ 为/ 在/ 特征/ 指标/ Cj/ 下/ 得到/ 的/ 测量/ 值/ ./ 网络/ 用户/ 行为/ 数据/ 可/ 直接/ 供/ 检测/ 使用/ ./ 定义/ 4/ ./ 标记/ ./ 即/ 对/ 获得/ 的/ 用户/ 网络/ 行为/ 数据/ 使用/ 人工/ 或/ 其它/ 方法/ 分析/ 后/ 所/ 作出/ 的/ 类别/ 标识/ ,/ 用/ t/ 表示/ ,/ 由于/ SVM/ 是/ 一种/ 二/ 分类/ 的/ 检测/ 方法/ ,/ 因此/ 标记/ 具体/ 取值/ 为/ t/ ∈/ {/ 1/ ,/ 0/ ,/ -/ 1/ }/ ,/ 其中/ 取值/ 1/ 为/ 正/ 标记/ ,/ 对应/ 异常/ 行为/ ;/ -/ 1/ 为/ 负/ 标记/ ,/ 对应/ 用户/ 正常/ 行为/ ;/ 0/ 则/ 表示/ 无/ 标记/ ,/ 即/ 该行/ 数据/ 行为/ 类别/ 未知/ ./ 定义/ 5/ ./ 训练样本/ ./ 即经/ 部分/ 标记/ 处理/ 后/ 所得/ 的/ 可/ 用于/ 训练/ 分类器/ 的/ 带/ 标记/ 的/ 用户/ 网络/ 行为/ 数据/ 犡/ ./ 所谓/ 部分/ 标记/ 数据/ 即/ 从/ 采集/ 得到/ 的/ 用户/ 网络/ 行为/ 数据/ 中/ 选择/ 一部分/ 使用/ 人工/ 或/ 其它/ 技术/ 方法/ 进行/ 分析/ ,/ 根据/ 结果/ ,/ 将/ 异常/ 行为/ 标记/ 为/ 1/ ,/ 正常/ 行为/ 标记/ 为/ -/ 1/ ,/ 其余/ 未/ 分析/ 数据/ 标记/ 为/ 0/ ./ m/ 条/ 用户/ 行为/ 数据/ 进行/ 部分/ 标记/ 后/ 构成/ 的/ 训练样本/ 犡/ 可/ 表示/ 为/ 熿/ 犡/ =/ 燀/ 其中/ 每/ 一行/ 都/ 由/ 用户/ 行为/ 数据/ xij/ ,/ i/ ∈/ [/ 1/ ,/ m/ ]/ ,/ j/ ∈/ [/ 1/ ,/ n/ ]/ 与/ 对应/ 的/ 类别/ 标记/ ti/ ,/ i/ ∈/ [/ 1/ ,/ m/ ]/ ,/ ti/ ∈/ {/ 1/ ,/ -/ 1/ ,/ 0/ }/ 联立/ 而成/ ./ 2.2/ 异常/ 行为/ 检测/ 模型/ 描述/ 为了/ 快速/ 准确/ 地/ 检测/ 出/ 网络/ 用户/ 的/ 异常/ 行为/ ,/ 首先/ 需要/ 对/ 从/ 网络/ 上/ 采集/ 到/ 的/ 反映/ 网络/ 用户/ 行为/ 的/ 网络/ 数据/ 进行/ 训练/ 和/ 学习/ ,/ 获取/ 用户/ 行为/ 特征/ ,/ 生成/ 分类/ 模型/ ./ 然后/ ,/ 基于/ 生成/ 的/ 分类/ 模型/ 对/ 从/ 网络/ 上/ 获得/ 的/ 实时/ 数据/ 进行/ 检测/ ,/ 从而/ 识别/ 出/ 网络/ 用户/ 的/ 异常/ 行为/ ./ 其中/ ,/ 所/ 采用/ 的/ 学习/ 技术/ 的/ 性能/ 和/ 学习效果/ 直接/ 影响/ 着/ 用户/ 行为/ 检测/ 结果/ 的/ 准确性/ ./ 协同/ 学习/ 技术/ 因其/ 在/ 检测/ 准确性/ 和/ 标记/ 训练样本/ 数量/ 之间/ 取得/ 了/ 较/ 好/ 的/ 折中/ 而/ 得到/ 广泛应用/ ,/ 但/ 其/ 要求/ 训练样本/ 必须/ 是/ 均匀/ 和/ 平衡/ 的/ ,/ 这/ 并/ 不适/ 用于/ 从/ 网络/ 上/ 获取/ 的/ 、/ 具有/ 明显/ 非/ 平衡性/ 和/ 分布/ 复杂性/ 的/ 网络/ 用户/ 行为/ 数据/ ./ 为此/ ,/ 将/ 选择性/ 集成/ 学习/ 技术/ 引入/ 到/ 协同/ 学习/ 过程/ 中/ ,/ 提出/ 了/ 一种/ 选择性/ 协同/ 学习/ 方法/ 用于/ 获取/ 用户/ 行为/ 分类/ 模型/ ,/ 在/ 适应/ 非/ 平衡/ 训练样本/ 数据/ 的/ 同时/ ,/ 提升/ 训练/ 学习效果/ ./ 首先/ 采集/ 网络/ 实际/ 流量/ 数据/ 并/ 进行/ 预处理/ ,/ 包括/ 根据/ 检测/ 特征/ 指标/ 对/ 流量/ 数据/ 进行/ 统计/ 和/ 测量/ 以/ 构造/ 网络/ 用户/ 行为/ 数据/ ,/ 使用/ 软件工具/ 、/ 人工/ 分析/ 等/ 方法/ 对/ 部分/ 网络/ 用户/ 行为/ 数据/ 进行/ 标记/ ,/ 得到/ 部分/ 标记/ 的/ 训练样本/ ;/ 然后/ 使用/ 改进/ 的/ EasyEnssemble/ 方法/ 对/ 训练样本/ 进行/ 处理/ ,/ 包括/ 使用/ 基于/ 特征/ 子/ 空间/ 的/ 聚类/ 方法/ 获取/ 样本分布/ 情况/ ,/ 将/ 训练/ 数据/ 划分/ 为/ 保留/ 原有/ 分部/ 信息/ 的/ 、/ 平衡/ 的/ 样本/ 子集/ ;/ 随后/ 采用/ 基于/ 混合/ 扰动/ 方法/ 生成/ 具备/ 差异性/ 的/ 成员/ 分类器/ ;/ 最后/ 使用/ 改进/ 的/ 协同/ 学习/ 方法/ 对/ 成员/ 分类器/ 进行/ 训练/ 并/ 根据/ 准确性/ 筛选/ 成员/ 构建/ 集成/ 分类器/ ./ 基于/ 集成/ 分类器/ ,/ 则/ 可以/ 根据/ 检测/ 特征/ 对/ 经过/ 预处理/ 的/ 网络/ 原始/ 流量/ 数据/ 进行/ 检测/ ,/ 以/ 对/ 用户/ 行为/ 进行/ 识别/ ./ 由此/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 选择性/ 协同/ 学习/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 模型/ ,/ 该/ 模型/ 由/ 选择性/ 协同/ 学习/ 和/ 异常/ 行为/ 检测/ 两/ 部分/ 组成/ ,/ 其/ 结构/ 如图/ 1/ 所示/ ./ Page4/ (/ 1/ )/ 选择性/ 协同/ 学习/ 训练/ 数据/ 预处理/ 模块/ ./ 对/ 采集/ 到/ 的/ 用户/ 行为/ 流量/ 数据/ 进行/ 统计/ 、/ 测量/ 以及/ 标记/ ,/ 生成/ 样本/ 处理/ 模块/ 使用/ 的/ 训练样本/ ./ 样本/ 处理/ 模块/ ./ 使用/ 基于/ 多数/ 类/ 分布/ 的/ 改进/ EasyEnssemble/ 方法/ 处理/ 训练样本/ ,/ 生成/ 训练样本/ 子集/ ./ 成员/ 分类器/ 构建/ 模块/ ./ 使用/ 混合/ 扰动/ 技术/ 生成/ 成员/ 分类器/ ,/ 供/ 后续/ 的/ 协同/ 学习/ 和/ 选择性/ 集成/ 使用/ ./ 协同/ 学习/ 模块/ ./ 使用/ 改进/ 的/ 协同/ 学习/ 方法/ 对/ 成员/ 分类器/ 进行/ 训练/ ,/ 供/ 生成/ 集成/ 分类器/ 使用/ ./ 选择性/ 集成/ 模块/ ./ 基于/ 准确性/ 筛选/ 成员/ 分类器/ 来/ 构建/ 集成/ 分类器/ ,/ 用以/ 检测/ 网络/ 用户/ 异常/ 行为/ ./ (/ 2/ )/ 用户/ 异常/ 行为/ 检测/ 检测/ 数据/ 预处理/ 模块/ ./ 对/ 欲/ 检测/ 的/ 用户/ 行为/ 流量/ 数据/ 进行/ 统计/ 测量/ ,/ 生成/ 集成/ 分类器/ 可/ 处理/ 的/ 用户/ 行为/ 数据/ ./ 异常/ 行为/ 识别/ 模块/ ./ 使用/ 集成/ 分类器/ 对/ 网络/ 用户/ 行为/ 数据/ 进行/ 分类/ ,/ 根据/ 结果/ 识别/ 用户/ 的/ 异常/ 行为/ ./ 3/ 选择性/ 协同/ 学习/ 3.1/ 训练样本/ 的/ 处理/ 基于/ 协同/ 学习/ 的/ 检测/ 方法/ 不足之处/ 主要/ 在于/ 缺乏/ 对非/ 平衡/ 数据/ 的/ 处理/ 能力/ ,/ 引入/ 非/ 平衡/ 数据处理/ 方法/ 可/ 对/ 其/ 进行/ 改进/ ./ 但/ 传统/ 非/ 平衡性/ 数据处理/ 方法/ 如过/ 取样/ 、/ 欠/ 取样/ 等/ 对/ 实际/ 数据/ 有/ 较/ 多增/ 、/ 删/ 操作/ ,/ 会/ 损失/ 实际/ 分布/ 信息/ ,/ 对于/ 非/ 平衡/ 较为/ 严重/ 的/ 网络/ 数据/ 而言/ ,/ EasyEssemble/ 方法/ 更为/ 合适/ ./ 该/ 方法/ 利用/ 集成/ 分类/ 思想/ ,/ 根据/ 非/ 平衡/ 程度/ ,/ 将/ 训练样本/ 划分/ 为/ 若干/ 平衡/ 的/ 子集/ 并/ 以此/ 训练/ 相应/ 数量/ 的/ 成员/ 分类器/ ,/ 最后/ 集成/ 成员/ 分类器/ 进行/ 检测/ ,/ 从而/ 避免/ 直接/ 增删/ 数据/ 导致/ 遗漏/ 样本/ 信息/ 、/ 引入/ 误差/ 等/ 缺陷/ ./ 然而/ EasyEnsemble/ 方法/ 并/ 不/ 适宜/ 直接/ 引入/ 基于/ 选择性/ 协同/ 学习/ 的/ 检测/ 方法/ ./ 一方面/ ,/ 选择性/ 协同/ 学习/ 使用/ 部分/ 标记/ 训练样本/ ,/ 样本/ 包含/ 的/ 大量/ 无/ 标记/ 数据/ 并未/ 明确/ 归属/ 少数类/ 或/ 多数/ 类/ ,/ 无法/ 直接/ 进行/ 划分/ ;/ 另一方面/ ,/ EasyEssemble/ 方法/ 假设/ 多数/ 类/ 数据/ 是/ 均匀分布/ ,/ 对/ 其/ 进行/ 随机/ 划分/ ,/ 然而/ 网络/ 用户/ 正常/ 行为/ 数据/ 的/ 分布/ 有/ 偏重/ ,/ 很多/ 研究/ 结果/ 都/ 指出/ ,/ 当前/ 的/ 网络流量/ 组成/ 存在/ 着/ 类似/ “/ 重尾/ 分布/ ”/ 的/ 结构/ ,/ 少数/ 行为/ 占据/ 流量/ 数据/ 中/ 的/ 大部分/ ,/ 而/ 其余/ 行为/ 数据/ 仅/ 占/ 流量/ 的/ 一小部分/ ,/ 例如/ 根据/ 文献/ [/ 21/ ]/ ,/ 当前/ Internet/ 网络/ 的/ 流量/ 从/ 应用/ 类型/ 来看/ ,/ 基于/ TCP/ 的/ WWW/ 应用/ 可/ 占/ 40/ %/ 以上/ ,/ 主要/ 基于/ UDP/ 的/ 如/ P2P/ 等/ 应用/ 占据/ 了/ 30/ %/ 左右/ ,/ 两者/ 占据/ 流量/ 大部分/ ,/ 反之/ 基于/ 其它/ 协议/ 如/ ICMP/ 等/ 的/ 网络/ 操作/ 仅/ 占/ 2/ %/ ,/ 而/ 一些/ 恶意/ 行为/ (/ 例如/ ICMPFlood/ 攻击/ 等/ )/ 恰是/ 利用/ 此类/ 协议/ 进行/ 的/ ./ 显然/ 对/ 这种/ 复杂/ 分布/ 的/ 数据/ 进行/ 随机/ 划分/ 会/ 严重/ 影响/ 样本/ 子集/ 质量/ :/ 随机/ 划分/ 所得/ 的/ n/ (/ n/ 值/ 与/ 平衡性/ 相关/ ,/ 非/ 平衡性/ 越/ 严重/ ,/ n/ 值越/ 大/ )/ 个/ 子集/ 内/ 少数/ 协议/ 数据量/ 将/ 非常/ 稀疏/ ,/ 甚至/ 成为/ 孤立/ 点/ ,/ 由此/ 训练/ 而/ 得/ 的/ 成员/ 分类器/ 将/ 难以/ 识别/ 此类/ 恶意/ 行为/ ,/ 进而/ 影响/ 最终/ 的/ 检测/ 准确性/ ./ 因此/ 需要/ 对/ EasyEssemble/ 方法/ 进行/ 改进/ ,/ 引入/ 聚类/ 技术/ 来/ 确定/ 无/ 标记/ 数据/ 的/ 归属/ 及/ 分析/ 多数/ 类/ 分布/ 信息/ 来/ 帮助/ 样本/ 划分/ ,/ 划分/ 时向/ 低/ 比例/ 数据/ 倾斜/ ,/ 增加/ 样本/ 子/ 集中/ 低/ 比例/ 数据/ 的/ 数量/ ,/ 最终/ 构造/ 平衡/ 、/ 尽可能/ 包含/ 全部/ 分布/ 信息/ 的/ 训练样本/ 子集/ ./ 另外/ ,/ 由于/ 样本/ 数据/ 属于/ 高维/ 数据/ ,/ 因此/ 在/ 选择/ 聚类/ 算法/ 时/ 可/ 采用/ 子/ 空间/ 聚类/ 算法/ ,/ 该类/ 算法/ 将/ 特征/ 指标/ 集/ 划分/ 为/ 若干/ 特征/ 子/ 空间/ ,/ 这些/ 特征/ 子/ 空间/ 还/ 可/ 用于/ 3.2/ 节中/ 成员/ 分类器/ 生成/ 算法/ ,/ 从而/ 进一步/ 降低/ 检测/ 方法/ 的/ 开销/ ./ 基于/ 以上/ 分析/ ,/ 本文/ 提出/ 基于/ 多数/ 类/ 分布/ 的/ 改进/ EasyEssemble/ 方法/ ,/ 通过/ 两/ 阶段/ 处理/ 划分/ 训练样本/ 子集/ :/ (/ 1/ )/ 第/ 1/ 阶段/ 任务/ 为/ 识别/ 无/ 标记/ 数据/ 的/ 归属/ ,/ 首先/ 划分/ 特征/ 指标/ 子/ 空间/ ,/ 随后/ 使用/ 子/ 空间/ 聚类/ 的/ 两/ 分类/ 聚类/ 处理/ 包含/ 所有/ 数据/ 的/ 训练样本/ ,/ 最后/ 根据/ 结果/ 中/ 包含/ 少数类/ 标记/ 的/ 数量/ 投票/ 来/ 确定/ 无/ 标记/ 数据/ 的/ 归属/ 等/ 步骤/ ./ (/ 2/ )/ 第/ 2/ 阶段/ 任务/ 是/ 多数/ 类/ 数据/ 进行/ 划分/ ,/ 首先/ 使用/ 子/ 空间/ 聚类/ 的/ 多/ 类别/ 聚类/ 方法/ 分析/ 正常/ 行为/ 数据类型/ 及其/ 数量/ 比例/ ,/ 然后/ 根据/ 比例/ 有/ 倾斜/ 地划/ Page5/ 分/ 训练样本/ 子集/ ,/ 增加/ 子/ 集中/ 低/ 比例/ 数据/ 的/ 数量/ ,/ 相对/ 减少/ 高/ 比例/ 数据/ ,/ 确保/ 划分/ 后/ 的/ 每个/ 子集/ 都/ 包含/ 足够/ 的/ 、/ 包含/ 所有/ 类别/ 行为/ 的/ 信息/ ./ 改进/ EasyEnssemble/ 样本/ 处理/ 算法/ 描述/ 如/ 算法/ 1/ 所示/ ,/ 其中/ 1/ ~/ 3/ 行为/ 无/ 标记/ 数据/ 的/ 处理过程/ ,/ 4/ ~/ 8/ 行为/ 对/ 多数/ 类/ 数据/ 的/ 划分/ ,/ 9/ ~/ 10/ 行为/ 最终/ 训练样本/ 子集/ 的/ 生成/ ./ 相对/ 通用/ 的/ EasyEssemble/ 方法/ ,/ 本文/ 样本/ 处理/ 方法/ :/ (/ 1/ )/ 具备/ 处理/ 部分/ 标记/ 训练样本/ 的/ 能力/ ;/ (/ 2/ )/ 能/ 对/ 多数/ 类/ 数据/ 的/ 复杂/ 分布/ 进行/ 分析/ ,/ 并/ 根据/ 分析/ 结果/ 进行/ 有/ 倾斜/ 的/ 划分/ ,/ 构建/ 平衡/ 且/ 包含/ 全部/ 分布/ 信息/ 的/ 训练样本/ 子集/ ;/ (/ 3/ )/ 形成/ 的/ 特征/ 指标/ 子/ 空间/ 还/ 可/ 用于/ 后续/ 的/ 成员/ 分类器/ 生成/ ,/ 有利于/ 降低/ 开销/ ./ 算法/ 1/ ./ 基于/ 多数/ 类/ 分布/ 的/ 改进/ EasyEnssemble/ 样本/ 处理/ 算法/ ./ 输入/ :/ 训练样本/ 输出/ :/ 训练样本/ 子集/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ ,/ 检测/ 特征/ 指标/ 1/ ./ 随机/ 从/ 犉/ object/ 中/ 选取/ s/ 项/ 特征/ 指标/ ,/ 重复/ N/ 次/ ,/ 构造/ N/ 个/ 特征/ 指标/ 子集/ {/ F1/ ,/ F2/ ,/ …/ ,/ FN/ }/ ,/ 对/ 每/ 一个/ Fi/ (/ i/ ∈/ [/ 1/ ,/ N/ ]/ )/ ,/ 有/ Fi/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ Cs/ }/ ,/ 其中/ C1/ ,/ C2/ ,/ …/ ,/ Cs/ ∈/ 犉/ object/ 且/ 各/ 特征/ 指标/ 子集/ 互不/ 相同/ ./ 2/ ./ 根据/ 每个/ Fi/ (/ i/ ∈/ [/ 1/ ,/ N/ ]/ )/ 对/ 训练样本/ 犡/ 进行/ 投影/ ,/ 得/ 对应/ 特征/ 指标/ 子/ 空间/ 上/ 的/ 样本/ 犡/ Fi/ =/ 使用/ CURE/ 方法/ 对/ {/ a1/ ,/ a2/ ,/ …/ ,/ am/ }/ 进行/ 二/ 分类/ 聚类/ (/ 取聚类/ 数目/ K/ =/ 2/ ,/ 收缩/ 因子/ a/ =/ 0.3/ ,/ 从/ 两种/ 已/ 标记/ 数据/ 中/ 抽取/ 约/ 10/ %/ 作为/ 代表/ 点/ )/ ,/ 计算结果/ 两个/ 类别/ 中/ 对应/ t/ =/ 1/ 的/ 元素/ 数量/ ,/ 令/ 数量/ 多者/ 为/ 少数类/ 结果/ Minor/ (/ Fi/ )/ ./ 3/ ./ 对/ 所有/ Minor/ (/ Fi/ )/ (/ i/ ∈/ [/ 1/ ,/ N/ ]/ )/ 中/ 对应/ t/ =/ 0/ 的/ 元素/ 进行/ 投票/ ,/ 按/ 简单/ 多数/ 确定/ 其/ 是否/ 为/ 少数类/ 元素/ ,/ 投票/ 结果/ 与/ 训练样本/ 犡/ 中/ t/ =/ 1/ 元素/ 合并/ ,/ 构成/ 少数类/ 样本/ 集合/ Minor/ (/ Minor/ / X/ )/ ,/ 设其/ s1/ 项/ 数据/ ,/ 则/ Minor/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ as1/ }/ ,/ 其中/ / aj/ (/ j/ ∈/ [/ 1/ ,/ N/ ]/ )/ 或/ aj/ 对应/ 的/ t/ =/ 1/ ,/ 或者/ t/ =/ 0/ 但/ 其/ 出现/ 在/ 过半数/ 的/ Minor/ (/ Fi/ )/ 中/ ,/ 其余/ 元素/ 构成/ 多数/ 类/ 样本/ 集合/ Mayor/ (/ Mayor/ / X/ )/ ,/ 设其/ 有/ s2/ 项/ 数据/ ,/ 则/ 有/ s1/ +/ s2/ =/ m/ ./ 4/ ./ 根据/ 每个/ Fi/ 对/ 少数类/ 样本/ 集合/ Mayor/ 进行/ 投影/ ,/ 得/ 对应/ 特征/ 指标/ 子/ 空间/ 上/ 的/ 少数类/ 样本/ Minor/ (/ Fi/ )/ =/ 计算/ 其/ 中心/ 位置/ ,/ 公式/ 为/ Minor/ (/ Fi/ )/ =/ (/ x/ -/ x/ -/ i/ =/ ∑/ s1j/ =/ 1s15/ ./ 根据/ 每个/ Fi/ 对/ 多数/ 类/ 样本/ 集合/ Mayor/ 进行/ 投影/ ,/ 得/ 对应/ 特征/ 指标/ 子/ 空间/ 上/ 的/ 多数/ 类/ 样本/ Mayor/ (/ Fi/ )/ =/ 对/ 其/ 使用/ CLIQUE/ 方法/ 进行/ 多/ 类别/ 聚类/ ,/ 设/ 结果/ 中/ 类别/ 数量/ 最多/ 的/ 子/ 空间/ 为/ Mayor/ (/ Fmax/ )/ ,/ 计算/ 其中/ 每/ 一类/ 别的/ 中心/ 位置/ ,/ 公式/ 为/ Mayor/ (/ Fmax/ )/ =/ (/ x/ -/ 搜索/ 距/ 中心/ 距离/ 最近/ 的/ 数据/ 为/ 投票/ 参照/ 点/ ,/ 距离/ 公式/ 为/ daj/ =/ Dist/ (/ Minor/ (/ Fi/ )/ ,/ ai/ )/ =/ (/ x/ -/ 设/ 共有/ t/ 个/ 类别/ ,/ 对应/ 的/ 参照/ 点/ 集合/ 为/ T/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ at/ }/ ./ 6/ ./ 对/ 其余/ 子/ 空间/ 的/ 分类/ 结果/ 进行/ 集成/ :/ 在/ 每个/ 子/ 空间/ 的/ 分类/ 结果/ 中/ 查看/ 不/ 属于/ T/ 的/ 所有/ 数据/ ,/ 若/ 其/ 与/ 参照/ 点/ xt/ ,/ (/ xt/ ∈/ T/ )/ 同属/ 一类/ ,/ 则/ 将/ xt/ 标记/ 加入/ 该/ 数据/ (/ 若/ 与/ 多个/ xt/ 同属/ 一类/ 则/ 加入/ 多个/ 标记/ )/ ./ 完毕/ 后/ 对/ 多数/ 类/ Mayor/ 所有/ 数据/ 的/ 标记/ 投票/ ,/ 选择/ 支持/ 数最多/ (/ 若/ 相同/ 则/ 选择/ T/ 中/ 排列/ 靠/ 前/ 的/ 类别/ )/ 的/ 标记/ 作为/ 该/ 数据/ 类别/ ,/ 检查/ 结果/ 并/ 去除/ 仅/ 含/ 少数/ 点/ 的/ 类别/ ./ 7/ ./ 设/ 多数/ 类/ 分布/ 的/ 分析/ 结果/ 为/ D1/ ,/ D2/ ,/ …/ ,/ Dt/ ,/ 每个/ 类别/ 包含/ 数据/ 数量/ 为/ Count/ (/ D1/ )/ ,/ Count/ (/ D2/ )/ ,/ …/ ,/ Count/ (/ Dt/ )/ ,/ 确定/ D1/ ,/ D2/ ,/ …/ ,/ Dt/ 的/ 抽样/ 权重/ 于是/ 类别/ Di/ 的/ 抽样/ 数量/ 为/ 8/ ./ 计算/ 子/ 样本空间/ 数量/ M/ =/ s2/ // s1/ ,/ 构造/ M/ 个/ 多数/ 类/ 样本/ 子集/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ ,/ 每个/ 子集/ 初值/ 为空/ ,/ 依次/ 对/ 多数/ 类/ 元素/ 每个/ 类别/ Di/ 进行/ 无放回/ 抽样/ ,/ 取样/ 数量/ 计算/ 为/ Size/ (/ Di/ )/ ,/ 若/ 取样/ 过程/ Di/ 中/ 数据/ 已/ 被/ 取/ 完/ ,/ 则/ 将/ 该类/ 数据/ 重置/ 为/ 初始状态/ 再/ 继续/ 抽取/ ,/ 共取/ M/ 次/ ,/ 分别/ 加入/ 每个/ Xj/ (/ j/ ∈/ [/ 1/ ,/ M/ ]/ )/ 中/ ./ 9/ ./ 构造/ M/ 个/ 训练样本/ 子集/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ ,/ 其中/ Xi/ =/ 10/ ./ 返回/ 训练样本/ 子集/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ 和/ 特征/ 指标/ 子/ Xi/ ∪/ Minor/ (/ i/ ∈/ [/ 1/ ,/ M/ ]/ )/ ./ 集合/ {/ F1/ ,/ F2/ ,/ …/ ,/ FN/ }/ ./ Page63/ ./ 2/ 成员/ 分类器/ 的/ 生成/ 协同/ 学习/ 方法/ 能够/ 使用/ 样本/ 中有/ 标记/ 数据/ 先行/ 训练/ 分类器/ ,/ 继而/ 对/ 无/ 标记/ 数据/ 分类/ ,/ 将/ 置信度/ 较/ 高/ 的/ 结果/ 加入/ 有/ 标记/ 数据/ ,/ 如此/ 反复/ 迭代/ 后/ 可/ 充分利用/ 无/ 标记/ 数据/ 的/ 信息/ 对/ 分类器/ 进行/ 强化/ ,/ 从而/ 确保/ 准确性/ 同时/ 减少/ 对/ 训练样本/ 中/ 标记/ 数据/ 的/ 开销/ 需求/ ./ 然而/ 目前/ 较为/ 普及/ 的/ 协同/ 学习/ 技术/ 如/ 基于/ 双/ 分类器/ 的/ Co/ -/ Training/ [/ 13/ ]/ 、/ 三/ 分类器/ 的/ Tri/ -/ Training/ [/ 13/ ]/ 以及/ 多/ 分类器/ 的/ CoForest/ 方法/ [/ 14/ ]/ 等/ 都/ 倾向/ 于/ 使用/ 较少/ 的/ 成员/ 分类器/ (/ 最受/ 认可/ 的/ Tri/ -/ Training/ 方法/ 使用/ 3/ 个/ 成员/ 分类器/ )/ ,/ 但/ 非/ 平衡性/ 较为/ 严重/ 的/ 网络/ 数据/ 经/ 本文/ 训练样本/ 处理/ 方法/ 划分/ 后/ 会/ 形成/ 较/ 多/ 的/ 样本/ 子集/ ,/ 仍/ 使用/ 较少/ 的/ 成员/ 分类器/ 对/ 其/ 进行/ 协同/ 学习/ 会/ 造成/ 成员/ 分类器/ 出现/ 过/ 拟合/ 等/ 现象/ ,/ 影响/ 准确性/ ,/ 因此/ 需要/ 对/ 其/ 进行/ 改进/ ,/ 生成/ 足够/ 数量/ 的/ 有/ 差异性/ 的/ 成员/ 分类器/ ./ 文献/ [/ 22/ ]/ 已/ 证明/ SVM/ 分类器/ 是/ 特征/ 及/ 参数/ 敏感/ 的/ ,/ 特征/ 敏感/ 指/ 不同/ 特征/ 空间/ 下/ 的/ 样本/ 子集/ 训练/ 而/ 得/ 的/ 分类器/ 具有/ 较大/ 差异/ ,/ 参数/ 敏感/ 则/ 指/ 基于/ 高斯/ 核/ 函数/ 的/ SVM/ 的/ 分类/ 能力/ 与其/ 参数/ ξ/ 和/ 惩罚/ 参数/ C/ 密切相关/ ./ 另外/ 训练样本/ 不同/ 也/ 可/ 造成/ 一定/ 差异性/ ./ 根据/ 以上/ 结论/ ,/ 本文/ 提出/ 一种/ 对/ 特征/ 子/ 空间/ 、/ 训练样本/ 子集/ 以及/ SVM/ 参数/ 三者/ 进行/ 充分/ 组合/ 的/ 基于/ 混合/ 扰动/ 的/ 成员/ 分类器/ 生成/ 方法/ ,/ 首先/ 对/ 样本/ 处理过程/ 中/ 生成/ 的/ 特征/ 子/ 空间/ 和/ 训练样本/ 子集/ 进行/ 组合/ ;/ 然后/ 按/ 文献/ [/ 22/ ]/ 在/ 每个/ 组合/ 上/ 计算/ 可/ 降低/ 分类器/ 偏差/ 的/ 参数/ ξ/ 和/ C/ 取值/ 空间/ (/ 即/ “/ 低/ 偏差/ 区域/ ”/ RegLow/ )/ ,/ 从中/ 随机/ 选择/ 参数/ ξ/ 和/ C/ ,/ 并/ 进一步/ 与/ 特征/ 指标/ 、/ 样本空间/ 进行/ 组合/ ,/ 最终/ 生成/ 一定/ 数量/ 的/ 、/ 有/ 差异/ 的/ 成员/ 分类器/ ./ 过程/ 描述/ 如/ 算法/ 2/ 所示/ ./ 算法/ 2/ ./ 基于/ 混合/ 扰动/ 的/ 个体/ 分类器/ 生成/ 算法/ ./ 输入/ :/ 训练样本/ 子集/ {/ X1/ ,/ X2/ ,/ …/ ,/ XM/ }/ ,/ 特征/ 指标/ 子集/ 输出/ :/ 个体/ 分类器/ 集合/ Fall/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fN/ ×/ M/ ×/ W/ }/ 及/ 对/ 1/ ./ FORi/ =/ 1toN2/ ./ FORj/ =/ 1toM3/ ./ 根据/ 特征/ 指标/ 集/ Fi/ ,/ 对/ 训练样本/ 子集/ Xj/ 进行/ 4/ ./ 分析/ 样本/ Yi/ ,/ j/ ,/ 使用/ 文献/ [/ 23/ ]/ 方法/ 计算/ 其/ RegLow/ ,/ 5/ ./ FORk/ =/ 1tow6/ ./ 使用/ 参数/ ξ/ k/ 和/ Ck/ ,/ 生成/ 个体/ 分类器/ f/ (/ fi/ ×/ j/ ×/ k/ )/ ,/ 7/ ./ 令/ 对应/ 的/ 训练样本/ Y/ (/ fi/ ×/ j/ ×/ k/ )/ =/ Yi/ ,/ j/ ,/ 将/ 其加/ 8/ ./ 返回/ 分类器/ 集合/ Fall/ 和/ 对应/ 的/ 训练样本/ 集合/ Yall3/ ./ 3/ 成员/ 分类器/ 的/ 选择性/ 协同/ 学习/ 选择性/ 协同/ 学习/ 方法/ 在/ 完成/ 样本/ 处理/ 以及/ 成员/ 分类器/ 生成/ 后/ ,/ 接下来/ 的/ 工作/ 则/ 是/ 对/ 这些/ 差异性/ 成员/ 分类器/ 进行/ 协同/ 训练/ ,/ 然而/ 传统/ 的/ 协同/ 训练方法/ 在/ 成员/ 分类器/ 数量/ 增加/ 时/ 存在/ 不足/ :/ 一方面/ ,/ 传统/ 方法/ (/ 如/ CoForest/ 方法/ )/ 采取/ 每个/ 成员/ 分类器/ 相对/ 其余/ 所有/ 成员/ 分别/ 计算/ 的/ 方案/ 计算/ 置信度/ ,/ n/ 个/ 分类器/ 时间/ 复杂度/ 大致/ 为/ O/ (/ n/ ×/ (/ n/ -/ 1/ )/ )/ =/ O/ (/ n2/ )/ ,/ 置信度/ 本身/ 则/ 采用/ 十折/ 交叉/ 验证/ 等/ 方法/ 计算/ ,/ 显然/ 当非/ 平衡性/ 较为/ 严重/ 导致/ 成员/ 分类器/ 数量/ n/ 增大/ 时/ ,/ 这种/ 方法/ 会/ 极大/ 地/ 增加/ 时间/ 开销/ ;/ 另一方面/ ,/ 传统/ 方法/ 将/ 所有/ 成员/ 分类器/ 用于/ 最终/ 的/ 检测/ ,/ 成员/ 分类器/ 数量/ 增大/ 时/ 更易/ 出现/ 受/ 噪音/ 积累/ 影响/ 的/ 成员/ 影响/ 检测/ 准确性/ 的/ 情况/ ./ 针对/ 以上/ 不足/ ,/ 本文/ 在/ 成员/ 分类器/ 的/ 协同/ 学习/ 和/ 集成/ 环节/ 分别/ 进行/ 改进/ ,/ 主要/ 思路/ 是/ 应用/ 选择性/ 集成/ 技术/ :/ 首先/ 在/ 成员/ 分类器/ 协同/ 学习/ 环节/ 使用/ 选择性/ 集成/ 方法/ 对/ 置信度/ 计算/ 进行/ 简化/ ,/ 即/ 每次/ 迭代/ 中/ 不再/ 对/ 每个/ 成员/ 分类器/ 分别/ 计算/ 置信度/ 并/ 更新/ 数据/ ,/ 而是/ 基于/ 准确性/ 选择/ 部分/ 成员/ 分类器/ 的/ 集成/ 分类/ 结果/ 来/ 计算/ 无/ 标记/ 数据/ 的/ 置信度/ 并/ 从/ 整体/ 上/ 更新/ 数据/ ,/ 从而/ 较/ 传统/ 方法/ 的/ 时间/ 复杂度/ 降为/ O/ (/ n/ )/ ;/ 然后/ 在/ 成员/ 分类器/ 集成/ 环节/ 进行/ 选择性/ 集成/ ,/ 基于/ 协同/ 学习/ 过程/ 中/ 积累/ 的/ 准确性/ 选择/ 质量/ 较/ 高/ 的/ 成员/ 分类器/ 来/ 构建/ 最终/ 用于/ 检测/ 的/ 集成/ 分类器/ ./ 使用/ 选择性/ 集成/ 分类/ 方法/ 简化/ 置信度/ 计算/ 的/ 关键在于/ 保证/ 选择性/ 集成/ 分类/ 结果/ 的/ 准确性/ ./ 由于/ 协同/ 训练/ 起始/ 时/ 成员/ 分类器/ 已/ 使用/ 有/ 标记/ 的/ 数据/ 进行/ 过/ 训练/ ,/ 本文/ 所/ 使用/ 泛化/ 能力/ 较强/ 的/ SVM/ 成员/ 分类器/ 可/ 被/ 认为/ 至少/ 是/ 一个/ 弱/ 分类器/ (/ 准确性/ 大于/ 随机/ 猜测/ 的/ 50/ %/ )/ ,/ 据/ 文献/ [/ 23/ ]/ ,/ 集成/ 分类/ 在/ 成员/ 分类器/ 具有/ 较/ 高/ 的/ 准确性/ 及/ 差异性/ 条件/ 下/ 可/ 将/ 一定/ 数量/ 的/ 弱/ 分类器/ 集/ 成为/ 一个/ 强/ 分类器/ ,/ 本文/ 的/ 分类器/ 生成/ 方法/ 已/ 保证/ 了/ 成员/ 分类器/ 的/ 差异性/ ,/ 因此/ 置信度/ 准确性/ 依赖于/ 参与/ 计算/ 的/ 成员/ 分类器/ 准确性/ ./ 基于/ 以上/ 分析/ ,/ 本文/ 使用/ 选择性/ 集成/ 技术/ ,/ 在/ 迭代/ 过程/ 中/ 累计/ 成员/ 分类器/ 准确性/ ,/ 选择/ 准确度/ 较/ 高/ 的/ 成员/ 分类器/ 的/ 结果/ 进行/ 集成/ (/ 初始化/ 时/ 使用/ 随机/ 选择/ )/ ,/ 进而/ 计算/ 置信度/ 并/ 更新/ 数据/ ./ 协同/ 学习/ 过程/ 中/ 噪音/ 积累/ 问题/ 较难/ 避免/ ,/ 若/ 所有/ 成员/ 分类器/ 用于/ 最终/ 检测/ ,/ 则/ 受/ 其/ 影响/ 而/ 质量/ 较差/ 的/ 成员/ 会/ 影响/ 准确性/ ./ 考虑/ 到/ 集成/ 分类器/ 性能/ 达/ Page7/ 到/ 最优/ 所/ 需/ 分类器/ 数量/ 存在/ 上限/ [/ 24/ ]/ (/ 20/ ~/ 30/ )/ ,/ 因此/ 本文/ 基于/ 准确性/ 集成/ 这一/ 数量/ 的/ 成员/ 分类器/ ,/ 剔除/ 受/ 噪音/ 积累/ 影响/ 而/ 准确性/ 较差/ 的/ 成员/ 分类器/ ,/ 确保/ 用于/ 检测/ 的/ 集成/ 分类器/ 的/ 准确性/ ./ 分类器/ 协同/ 学习/ 和/ 选择性/ 集成/ 的/ 具体步骤/ 如/ 算法/ 3/ 所/ 描述/ ./ 算法/ 3/ ./ 成员/ 分类器/ 协同/ 学习/ 和/ 选择性/ 集成/ 算法/ ./ 输入/ :/ 个体/ 分类器/ 集合/ Fall/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fN/ ×/ M/ ×/ W/ }/ 及/ 输出/ :/ 集成/ 分类器/ Fresemble/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fz/ }/ 1/ ./ 记/ 每个/ 成员/ 分类器/ fi/ (/ i/ ∈/ [/ 1/ ,/ N/ ×/ M/ ×/ W/ ]/ )/ 的/ 准确/ 2/ ./ FOR/ 每个/ 成员/ 分类器/ fi/ ∈/ Fall3/ ./ 使用/ 样本/ Y/ (/ fi/ )/ 中有/ 标记/ 数据/ 训练/ 成员/ 分类器/ 4/ ./ 对/ 无/ 标记/ 数据/ 的/ 分类/ 结果/ 进行/ 集成/ ,/ 每/ 项/ 数据/ 置/ 5/ ./ IF/ (/ R/ =/ 0/ )/ or/ (/ 稳定/ 值/ >/ Ma/ )/ or/ (/ 迭代/ 次数/ >/ Mb/ )/ 6/ ./ GOTO127/ ./ ELSE8/ ./ 使用/ Result/ 更新/ 所有/ 成员/ 分类器/ 的/ 样本/ Yi/ ,/ 9/ ./ 选择/ 准确性/ 最高/ 前/ TOP/ 个/ 成员/ 分类器/ (/ 如果/ 10/ ./ GOTO211/ ./ 选择/ 准确度/ 最高/ 的/ z/ 个/ 成员/ 分类器/ 构成/ 集成/ 分类/ 12/ ./ 返回/ Fresemble4/ 网络/ 用户/ 异常/ 行为/ 检测/ 利用/ 选择性/ 协同/ 学习/ 所/ 生成/ 的/ 集成/ 分类器/ ,/ 可/ 从/ 网络/ 数据/ 中/ 检测/ 网络/ 用户/ 异常/ 行为/ ./ 然而/ 网络/ 的/ 流量/ 数据/ 并/ 不能/ 被/ 集成/ 分类器/ 直接/ 识别/ ,/ 还/ 需要/ 根据/ 检测/ 特征/ 指标/ 对/ 网络流量/ 数据/ 进行/ 预处理/ ,/ 构造/ 集成/ 分类器/ 可以/ 识别/ 的/ 网络/ 用户/ 行为/ 数据/ ,/ 因此/ 网络/ 用户/ 异常/ 行为/ 检测/ 过程/ 可以/ 划分/ 为/ 数据/ 预处理/ 和/ 检测/ 两个/ 阶段/ ./ (/ 1/ )/ 数据/ 预处理/ 阶段/ 的/ 主要/ 工作/ 包括/ :/ 采集/ 某/ 连续/ 时间段/ 内/ 的/ 网络/ 原始/ 流量/ 数据/ ,/ 根据/ 检测/ 特征/ 指标/ 对/ 其/ 统计/ 和/ 测量/ ,/ 构造/ 供/ 集成/ 分类器/ 使用/ 的/ 检测/ 样本/ ./ 在/ 实现/ 上/ 可/ 在/ 用户/ 接入点/ 设备/ (/ 通常/ 为/ 网关/ 或者/ 交换机/ 等/ ,/ 在/ 一个/ 自治/ 域/ 内/ ,/ 接入点/ 可以/ 为/ 多个/ )/ 上/ 使用/ 端口/ 镜像/ 等/ 方法/ 对/ 捕捉/ 网络/ 报文/ ,/ 然后/ 分析/ 数据/ 并/ 转化/ 为/ 具体/ 用户/ 对应/ 的/ 流/ (/ Flow/ )/ ,/ 最后/ 根据/ 检测/ 特征/ 指标/ 集对/ 这些/ 流/ 进行/ 测量/ ,/ 构造/ 检测/ 样本/ ./ (/ 2/ )/ 检测/ 阶段/ 的/ 主要/ 工作/ 包括/ :/ 将/ 预处理/ 生成/ 的/ 网络/ 用户/ 行为/ 数据/ 输入/ 集成/ 分类器/ ,/ 由于/ 其中/ 各/ 成员/ 分类器/ 通常/ 建立/ 在/ 不同/ 特征/ 子/ 空间/ 上/ ,/ 因此/ 输入/ 时/ 还/ 需/ 进行/ 必要/ 的/ 投影/ 操作/ ./ 当/ 所有/ 成员/ 分类器/ 输出/ 结果/ 后/ ,/ 使用/ 简单/ 多数/ 原则/ 进行/ 投票/ 后/ 即/ 得/ 检测/ 结果/ ./ 网络/ 用户/ 的/ 行为/ 数据/ 具有/ 流式/ 数据/ 的/ 特征/ ,/ 而/ 无论/ 数据/ 预处理/ 还是/ 检测/ 都/ 需要/ 一定/ 的/ 时间/ 开销/ ,/ 在/ 这/ 段时间/ 内/ 必然/ 有/ 新/ 行为/ 数据/ 到达/ ,/ 为/ 避免/ 因/ 处理/ 开销/ 而/ 遗漏/ 新/ 到达/ 的/ 数据/ ,/ 本文/ 检测/ 方法/ 采取/ 数据/ 预处理/ 与/ 检测/ 两/ 阶段/ 交互/ 迭代/ 的/ 方案/ ,/ 即/ 确定/ 一定/ 长度/ 的/ 时间/ 间断/ ,/ 设/ 时间段/ T/ 内/ 数据/ 预处理/ 工作/ 生成/ 相应/ 的/ 网络/ 用户/ 行为/ 数据/ ./ 则/ 该/ 数据/ 将/ 在/ 时间段/ T/ +/ 1/ 内/ 进行/ 检测/ ,/ 而/ 数据/ 预处理/ 工作/ 在/ 时间段/ T/ +/ 1/ 内则/ 生成/ 新/ 的/ 行为/ 数据/ ,/ 如图/ 2/ 所示/ ./ 显然/ ,/ 需要/ 综合/ 考虑/ 数据/ 预处理/ 与/ 检测/ 等/ 方面/ 开销/ 来/ 设置/ 时间/ 间断/ 的/ 长度/ ,/ 一般/ 以/ 能够/ 及时/ 检测/ 完/ 数据/ 预处理/ 阶段/ 提交/ 的/ 检测/ 数据/ 为宜/ ,/ 当/ 网络/ 繁忙/ 时/ 可/ 适当/ 缩短/ ,/ 空闲/ 时/ 可/ 适当/ 延长时间/ 间断/ ./ 图/ 2/ 两/ 阶段/ 交互/ 迭代/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 流程/ 由此/ ,/ 网络/ 用户/ 异常/ 行为/ 检测/ 的/ 具体步骤/ 可以/ 由/ 过程/ 1/ 描述/ ./ Page8/ 过程/ 1/ ./ 网络/ 用户/ 异常/ 行为/ 检测/ ./ 输入/ :/ 集成/ 分类器/ Fresemble/ =/ {/ f1/ ,/ f2/ ,/ …/ ,/ fz/ }/ ,/ 每个/ 成员/ 输出/ :/ 检测/ 结果/ 1/ ./ 设/ 本次/ 迭代/ 时间/ 为/ T/ ,/ 上轮/ 迭代/ 得到/ 的/ 用户/ 网络/ 行/ 2/ ./ 按/ 特征/ 指标/ 犉/ object/ =/ {/ C1/ ,/ C2/ ,/ …/ ,/ Cn/ }/ 进行/ 测量/ ,/ 得待/ 3/ ./ FOR/ 每个/ 成员/ 分类器/ fi/ ∈/ Fall4/ ./ 将/ 向量/ 犇/ 犜/ T/ -/ 1/ 按/ 成员/ 分类器/ fi/ 对应/ 的/ 特征/ 指标/ 5/ ./ 整理/ 向量/ 犇/ 犜/ T/ -/ 1/ 在/ Fresemble/ 中/ 每个/ 分类器/ 输出/ 的/ 分/ 6/ ./ 根据/ 简单/ 多数/ 原则/ ,/ 输出/ 流量/ 的/ 最终/ 标记/ ,/ 若/ 标记/ 7/ ./ 返回/ 检测/ 结果/ ,/ 进入/ 下/ 一轮/ 迭代/ ,/ goto15/ 实验/ 与/ 分析/ 5.1/ 实验/ 环境/ 为/ 验证/ 本文/ 检测/ 方法/ 的/ 实际/ 性能/ ,/ 本文/ 基于/ 校园网/ 中/ 电子/ 与/ 信息/ 工程学院/ 两处/ 实验楼/ 局域网/ 的/ 实际/ 网络/ 环境/ 进行/ 实验/ ,/ 网络/ 环境/ 拓扑/ 结构/ 如图/ 3/ 所示/ ./ 网络/ 环境/ 中共/ 有/ 约/ 400/ 多台/ 主机/ ,/ 两处/ 实验楼/ 分别/ 有/ 一台/ CiscoCatalyst2928/ 路由/ 交换机/ 作为/ 汇聚/ 交换机/ ,/ 使用/ 百兆/ 带宽/ 链路/ 出口/ 与/ 教育网/ 路由器/ 连接/ ./ 对/ 汇聚/ 交换机/ 处/ 的/ 网络流量/ 进行/ 端口/ 镜像/ ,/ 所得/ 数据/ 供/ 本文/ 实验/ 使用/ ./ 实验/ 使用/ 的/ 软硬件/ 平台/ 设置/ 如下/ :/ 软件/ 采取/ 自行/ 开发/ 并/ 结合/ svmlib/ 等/ 相关/ 软件/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 系统/ ,/ 对应/ 使用/ 的/ 数据库/ 为/ SQLServer2005/ ,/ 硬件/ 配置/ 为/ IntelCore2Quad2/ ./ 3GHz/ ,/ 4GB/ 内存/ ,/ 操作系统/ 为/ WindowsXPSP3/ ./ 两处/ 实验楼/ 作为/ 电子/ 与/ 信息/ 工程学院/ 学生/ 的/ 专业课程/ 实验/ 及/ 全校学生/ 课余/ 上网/ 使用/ ,/ 实验/ 安排/ 学生/ 在/ 该/ 网络/ 环境/ 中/ 进行/ 预定/ 的/ 网络攻击/ 行为/ (/ DDoS/ 攻击/ 域/ 内/ 服务器/ )/ 以及/ 相应/ 的/ 各类/ 正常/ 行为/ (/ 包括/ Web/ 浏览/ 、/ 视频点播/ 以及/ 非/ 多线程/ 的/ P2P/ 文件/ 下载/ 等/ )/ ,/ 因此/ 可以/ 采集/ 到/ 正常/ 与/ 异常/ 的/ 网络/ 用户/ 行为/ 数据/ 用于/ 实验/ ./ 针对/ 训练样本/ 中/ 的/ 数据/ 标记/ 问题/ ,/ 本文/ 采取/ 的/ 方法/ 是/ 使用/ 流量/ 分析/ 工具/ L7/ -/ filter/ 对/ 正常/ 行为/ 进行/ 标记/ ,/ 然后/ 根据/ 实验/ 安排/ 结合/ 防火墙/ 告警信息/ 、/ 服务器/ 记录/ 以及/ 人工/ 分析/ 标记/ 用户/ 的/ 恶意/ 行为/ ,/ 进而/ 构建/ 训练样本/ ./ 实验/ 采集/ 了/ 2012/ 年/ 9/ 月/ 17/ 日/ 从/ 上午/ 8/ :/ 00/ 到/ 晚上/ 21/ :/ 00/ 时间段/ 内/ 的/ 约/ 26G/ 的/ 网络流量/ ,/ 从中/ 获取/ 用户/ 行为/ 数据/ ./ 根据/ 检测/ 方法/ 设计/ ,/ 本文/ 需要/ 根据/ 测量/ 指标/ 对/ 采集/ 到/ 的/ 流量/ 数据/ 进行/ 分析/ 、/ 测量/ 等/ 预处理/ 工作/ ,/ 构建/ 训练样本/ 及/ 检测/ 数据/ ./ 因此/ 参考文献/ [/ 24/ ]/ 使用/ 如表/ 1/ 所示/ 的/ 23/ 维/ 测量/ 指标/ 对/ 获取/ 的/ 用户/ 流量/ 进行/ 测量/ ./ 指标/ 类别/ 报文/ 特征/ 流/ 特征/ 源/ 端口数/ 、/ 目的/ 端口数/ 、/ 目的/ IP地址/ 数/ 、/ 平均/ 流长/ 应用层/ 特征/ 上传/ 流量/ 、/ 下载/ 流量/ 、/ TCP/ 上传/ 流量/ 、/ TCP/ 下载/ 流/ 5.2/ 对照/ 方法/ 及/ 评估/ 指标/ 为/ 衡量/ 和/ 验证/ 本文/ 检测/ 方法/ 的/ 准确性/ 以及/ 开销/ 方面/ 的/ 性能/ ,/ 本文/ 采用/ 2/ 类/ 对照/ 方法/ :/ 一类/ 为/ 基于/ CoForest/ 协同/ 学习/ 的/ 检测/ 方法/ (/ 分别/ 使用/ SVM/ 、/ 朴素/ 贝叶斯/ 和/ C4/ ./ 5/ 的/ 成员/ 分类器/ )/ ,/ 具备/ 协同/ 学习/ 能力/ ,/ 可/ 使用/ 部分/ 标记/ 数据/ 样本/ 进行/ 训练/ ;/ 另一类/ 为/ 基于/ 单/ 分类器/ 的/ 检测/ 方法/ ,/ 这/ 类/ 方法/ 不/ 进行/ 协同/ 学习/ ,/ 仅/ 使用/ 有/ 标记/ 数据/ 进行/ 训练/ ./ 本文/ 采用/ 查全率/ 、/ 查准率/ 和/ 调和/ 平均值/ 作为/ 评价/ 指标/ ,/ 设/ 用于/ 检测/ 的/ 网络/ 用户/ 行为/ 样本/ 中/ ,/ TP/ 表示/ 被/ 正确/ 识别/ 为/ 异常/ 行为/ 的/ 样本数/ ,/ FN/ 表示/ 被/ 误判/ 为/ 正常/ 行为/ 的/ 样本数/ ,/ FP/ 表示/ 被/ 误判/ 为/ 异常/ 行为/ 的/ 样本数/ ,/ 评价/ 指标/ 如下/ :/ (/ 1/ )/ 查全率/ (/ Recall/ )/ :/ R/ =/ TP/ (/ 2/ )/ 查准率/ (/ Precision/ )/ :/ P/ =/ TP/ (/ 3/ )/ 调和/ 平均值/ (/ F/ -/ measure/ )/ :/ F/ =/ 2/ ×/ P/ ×/ R/ 查全率/ 和/ 查准率/ 能/ 反映/ 检测/ 方法/ 针对/ 异常/ 行为/ Page9/ 的/ 分类/ 能力/ ,/ 而/ 查全率/ 和/ 查准率/ 的/ 调和/ 平均值/ 综合/ 评价/ 能力/ 更好/ ,/ 这/ 3/ 个/ 指标/ 应用/ 较/ 广泛/ ,/ 几乎/ 为/ 所有/ 研究/ 采纳/ ./ 5.3/ 实验/ 方案/ 及/ 结果/ 分析/ 为了/ 验证/ 本文/ 检测/ 方法/ 在/ 网络/ 用户/ 行为/ 数据/ 存在/ 非/ 平衡性/ 情况/ 下/ ,/ 能否/ 在/ 降低/ 对/ 训练样本/ 中/ 标记/ 数据/ 需求/ 的/ 同时/ 确保/ 准确性/ ,/ 本文/ 主要/ 从/ 以下/ 方面/ 进行/ 验证/ :/ 首先/ 验证/ 异常/ 行为/ 数据/ 的/ 不同/ 平衡/ 程度/ 下/ 本文/ 检测/ 方法/ 的/ 准确性/ ;/ 然后/ 验证/ 训练样本/ 中/ 标记/ 数据/ 的/ 不同/ 比例/ 下/ 本文/ 方法/ 的/ 性能/ ./ 由于/ 训练/ 开销/ (/ 包括/ 准备/ 数据/ 标记/ 和/ 训练/ 分类器/ )/ 是/ 决定/ 检测/ 方法/ 能否/ 快速/ 准确/ 检测/ 异常/ 行为/ 的/ 重要/ 因素/ ,/ 因此/ 最后/ 还/ 对/ 检测/ 方法/ 的/ 开销/ 进行/ 了/ 验证/ ./ 因此/ 本文/ 设计/ 以下/ 3/ 个/ 实验/ ./ 实验/ 1/ ./ 验证/ 在/ 异常/ 行为/ 数据/ 不同/ 平衡/ 程度/ 下/ 本文/ 方法/ 的/ 性能/ ./ 其/ 步骤/ 为/ :/ 首先/ 分析/ 不同/ 用户/ 行为/ 数据/ 集中/ 异常/ 行为/ 的/ 比例/ ,/ 然后/ 选择/ 比例/ 不同/ 的/ 数据/ 集/ 构建/ 训练样本/ 分别/ 进行/ 选择性/ 协同/ 学习/ ,/ 最后/ 使用/ 相同/ 的/ 验证/ 数据/ (/ 从/ 全部/ 用户/ 行为/ 数据/ 中/ 随机/ 抽取/ )/ 比较/ 不同/ 平衡/ 程度/ 的/ 训练样本/ 下/ 本文/ 方法/ 与/ 对照/ 方法/ 的/ 准确性/ ./ 实验/ 1/ 所/ 使用/ 的/ 数据/ 设置/ 如表/ 2/ 所示/ ./ 实验/ 1/ 的/ 对比/ 分析/ 结果/ 则/ 由/ 图/ 4/ 给出/ ,/ 图/ 4/ 的/ (/ a/ )/ 、/ (/ b/ )/ 和/ (/ c/ )/ 分别/ 给出/ 了/ 训练样本/ 中/ 异常/ 行为/ 比例/ 为/ 1.12/ %/ 、/ 5.32/ %/ 、/ 9.76/ %/ 、/ 20.60/ %/ 、/ 31.62/ %/ 和/ 41.76/ %/ 时/ 准确性/ 指标/ 的/ 比较/ 结果/ ,/ 从中/ 可以/ 看出/ ,/ 由于/ 选择性/ 协同/ 学习/ 方法/ 在/ 样本/ 处理/ 环节/ 对非/ 平衡/ 图/ 4/ 实验/ 1/ 的/ 结果/ 实验/ 2/ ./ 验证/ 训练样本/ 中/ 不同/ 标记/ 数据/ 数量/ 下/ 本文/ 方法/ 的/ 性能/ ./ 其/ 步骤/ 为/ :/ 首先/ 选择/ 某一/ 数据/ 集/ (/ 本文/ 选取/ 异常/ 行为/ 数据/ 比例/ 在/ 20/ %/ 左右/ 的/ 数据/ 集/ )/ 构建/ 训练样本/ ,/ 然后/ 并/ 分别/ 设置/ 样本/ 中/ 标记/ 数据/ 的/ 比例/ ,/ 构建/ 相应/ 的/ 训练样本/ 进行/ 选择性/ 协同/ 学习/ ,/ 最后/ 使用/ 相同/ 的/ 验证/ 数据/ 比较/ 本文/ 方法/ 与/ 对照/ 方法/ 的/ 准确性/ ./ 实验/ 2/ 所/ 使用/ 的/ 数据/ 设置/ 如表/ 3/ 所示/ ./ 性/ 的/ 数据/ 进行/ 了/ 有效/ 处理/ ,/ 在/ 成员/ 分类器/ 集成/ 环节/ 则/ 利用/ 选择性/ 集成/ 进一步提高/ 了/ 准确性/ ,/ 因此/ 检测/ 准确性/ 在/ 不同/ 的/ 非/ 平衡/ 程度/ 上/ 都/ 较/ 对照/ 方法/ 高/ (/ 与/ 所有/ 对照/ 方法/ 相比/ ,/ 查全率/ 提高/ 至少/ 约/ 14.4/ 个/ 百分点/ 、/ 查准率/ 提高/ 17.3/ 个/ 百分点/ ,/ 调和/ 平均值/ 提高/ 20.3/ 个/ 百分点/ )/ ,/ 尤其/ 当/ 异常/ 行为/ 数据/ 比例/ 极低/ (/ 例如/ 异常/ 行为/ 比例/ 仅为/ 1.12/ %/ 以及/ 5.32/ %/ )/ 时/ ,/ 本文/ 方法/ 仍能/ 取得/ 80/ %/ 左右/ 的/ 准确率/ (/ 对照/ 方法/ 普遍/ 低于/ 70/ %/ ,/ 甚至/ 接近/ 60/ %/ )/ ./ 观察/ 准确性/ 的/ 变化趋势/ 则/ 可/ 看出/ ,/ 对照/ 方法/ 大多/ 存在/ 着/ 随/ 训练样本/ 中/ 异常/ 行为/ 比例/ 逐步提高/ 而/ 准确性/ 逐步提高/ 的/ 现象/ ,/ 当/ 比例/ 逐步/ 接近/ 均衡/ 时/ (/ 如/ 对照/ 方法/ 1/ 在/ 30/ %/ 到/ 40/ %/ 比例/ 间/ )/ 性能/ 有/ 较大/ 提升/ ,/ 说明/ 对照/ 方法/ 的/ 准确性/ 与/ 异常/ 行为/ 数据/ 平衡/ 程度/ 正/ 相关/ ./ 但/ 本文/ 方法/ 性能/ 在/ 平衡/ 程度/ 较/ 低/ 的/ 时候/ 即可/ 逐步/ 趋于稳定/ (/ 异常/ 行为/ 比例/ 在/ 20/ %/ 以上/ 时即/ 稳定/ 在/ 90/ %/ 左右/ )/ ,/ 这/ 说明/ 本文/ 方法/ 更能/ 适应/ 当今/ 网络/ 环境/ 下/ 用户/ 异常/ 行为/ 数据/ 比例/ 较/ 低/ 的/ 非/ 平衡性/ 特点/ ./ 数据/ 集/ 异常/ 行为/ 1150133871.123023838721525/ ./ 323035167529419.76304200859750020/ ./ 60305208326588231.62306348188337741/ ./ 7630/ 数据/ 集/ 标记/ 15879111706520.602117591058271020/ ./ 60317638999471520.60423517940682020/ ./ 60517638999472520.60635276823103020/ ./ 60Page10/ 实验/ 2/ 的/ 对比/ 分析/ 结果/ 由图/ 5/ 给出/ :/ 图/ 5/ 的/ (/ a/ )/ 、/ (/ b/ )/ 和/ (/ c/ )/ 分别/ 比较/ 了/ 训练样本/ 中/ 标记/ 数据/ 比例/ 为/ 5/ %/ 、/ 10/ %/ 、/ 15/ %/ 、/ 20/ %/ 、/ 25/ %/ 和/ 30/ %/ 时/ 各个/ 指标/ 的/ 比较/ 结果/ ,/ 从中/ 可以/ 看出/ :/ 由于/ 选择性/ 协同/ 学习/ 方法/ 在/ 样本/ 处理/ 环节/ 引入/ 了/ 非/ 平衡性/ 数据处理/ 方法/ ,/ 并/ 把/ 选择性/ 集成/ 技术/ 引入/ 到/ 成员/ 分类器/ 协同/ 学习/ 和/ 集成/ 环节/ 中/ ,/ 从而/ 有效/ 地/ 降低/ 了/ 对/ 标记/ 数据/ 的/ 需求/ ,/ 提高/ 了/ 检测/ 准确性/ ,/ 因此/ 检测/ 准确性/ 在/ 不同/ 的/ 标记/ 数据/ 比例/ 上/ 都/ 比/ 对照/ 方法/ 要/ 好/ (/ 与/ 所有/ 对照/ 方法/ 相比/ ,/ 查全率/ 至少/ 领先/ 约/ 19.6/ 个/ 百分点/ 、/ 查准率/ 领先/ 25.3/ 个/ 百分/ 图/ 5/ 实验/ 2/ 的/ 结果/ 实验/ 3/ ./ 验证/ 本文/ 方法/ 与/ 对照/ 方法/ 在/ 开销/ 方面/ 的/ 差别/ ./ 其/ 步骤/ 则/ 为/ :/ 首先/ 在/ 实验/ 2/ 的/ 数据/ 集/ 基础/ 上/ 进一步/ 进行/ 数据/ 标记/ 工作/ ,/ 然后/ 分别/ 比较/ 不同/ 比例/ 的/ 样本/ 数据/ 进行/ 标记/ 的/ 开销/ 情况/ ,/ 接着/ 比较/ 了/ 本文/ 方法/ 与/ 对照/ 方法/ 使用/ 不同/ 比例/ 标记/ 数据/ 的/ 训练样本/ 进行/ 协同/ 学习/ (/ 单/ 分类器/ 对照/ 方法/ 则/ 仅/ 使用/ 标记/ 数据/ 进行/ 学习/ )/ 的/ 开销/ ,/ 最后/ 将/ 两者/ 开销/ 结合/ 起来/ ,/ 比较/ 本文/ 方法/ 与/ 对照/ 方法/ 取得/ 的/ 准确性/ 相对/ 开销/ 的/ 对比/ 情况/ ,/ 即/ 取得/ 同样/ 检测/ 性能/ 所/ 需要/ 的/ 开销/ 情况/ ./ 传统/ 的/ 检测/ 方法/ 更/ 多/ 关注/ 分类器/ 训练/ 方面/ 所/ 需要/ 的/ 开销/ ,/ 但/ 实际上/ 与/ 训练/ 开销/ 相比/ ,/ 对/ 基于/ 机器/ 学习/ 的/ 检测/ 方法/ 而言/ ,/ 准备/ 训练样本/ 尤其/ 是/ 对/ 其中/ 的/ 数据/ 进行/ 标记/ 所/ 耗费/ 的/ 时间/ 开销/ 更为/ 巨大/ ,/ 标记/ 不同/ 比例/ 的/ 样本/ 数据/ 的/ 开销/ 情况/ 如表/ 4/ 所示/ ,/ 本文/ 以及/ 对照/ 方法/ 使用/ 不同/ 标记/ 比例/ 的/ 训练样本/ 的/ 训练/ 开销/ 情况/ 如表/ 5/ 所示/ ./ 从表/ 4/ 和表/ 5/ 的/ 结果/ 来看/ ,/ 基于/ SVM/ 协同/ 学习/ 的/ 传统/ 检测/ 方法/ 在/ 训练/ 开销/ 方面/ 非常/ 巨大/ ,/ 在/ 标记/ 比例/ 较/ 少时/ (/ 少于/ 20/ %/ )/ 甚至/ 超过/ 了/ 标记/ 数据/ 的/ 开销/ ,/ 本文/ 方法/ 的/ 训练/ 时间/ 开销/ 较/ 同样/ 基于/ SVM/ 的/ 传统/ 协同/ 学习/ 检测/ 方法/ 下降/ 了/ 约/ 71.3/ %/ ,/ 说明/ 本文/ 方法/ 在/ 成员/ 分类器/ 的/ 协同/ 学习/ 方面/ 的/ 改进/ 起到/ 了/ 作用/ ./ 但/ 总体/ 来说/ ,/ 所有/ 检测/ 方法/ 在/ 点/ ,/ 调和/ 平均值/ 领先/ 22.3/ 个/ 百分点/ )/ ,/ 尤其/ 当/ 标记/ 数据/ 比例/ 较/ 低时/ (/ 仅/ 5/ %/ )/ ,/ 本文/ 方法/ 准确性/ 仍能/ 超过/ 80/ %/ ./ 观察/ 准确性/ 变化趋势/ 可以/ 看出/ ,/ 对照/ 方法/ 存在/ 准确性/ 随着/ 标记/ 数据/ 比例/ 的/ 上升/ 而/ 线性/ 提升/ 现象/ (/ 在/ 标记/ 数据/ 比例/ 从/ 20/ %/ 到/ 30/ %/ 时/ 尤为/ 明显/ )/ ,/ 但/ 准确性/ 多/ 在/ 80/ %/ 以下/ ,/ 而/ 当/ 样本/ 中/ 标记/ 数据/ 的/ 比例/ 提高/ 到/ 30/ %/ 以上/ 时/ 性能/ 即/ 趋于稳定/ (/ 90/ %/ 左右/ )/ ./ 说明/ 对照/ 方法/ 的/ 准确性/ 与/ 样本/ 标记/ 数据/ 数量/ 存在/ 依赖/ 关系/ ,/ 而/ 本文/ 方法/ 则/ 更/ 适应/ 非/ 平衡/ 的/ 训练样本/ ,/ 能够/ 使用/ 更少/ 的/ 标记/ 数据/ 进行/ 训练/ 并/ 取得/ 更好/ 的/ 性能/ ./ 准备/ 标记/ 方面/ 耗费/ 的/ 时间/ 还是/ 较/ 训练/ 的/ 开销/ 要/ 高/ 一个/ 数量级/ (/ 标记/ 数据/ 耗时/ 最多/ 在/ 3h/ 左右/ ,/ 而/ 训练方法/ 的/ 耗时/ 最多仅/ 在/ 15min/ 左右/ )/ ,/ 因此/ 降低/ 检测/ 方法/ 对/ 标记/ 数据/ 需求/ 所/ 节省/ 的/ 时间/ 开销/ 对/ 实现/ 快速/ 检测/ 用户/ 异常/ 行为/ 更/ 有/ 实际意义/ ,/ 例如/ 标记/ 90/ %/ 的/ 数据/ 需要/ 耗费/ 至少/ 约/ 3h/ ,/ 而/ 标记/ 25/ %/ 左右/ 的/ 数据/ 仅/ 需/ 45min/ 左右/ ,/ 如果/ 使用/ 25/ %/ 标记/ 数据/ 的/ 检测/ 方法/ 在/ 检测/ 性能/ 上/ 能够/ 与/ 基于/ 90/ %/ 标记/ 数据/ 的/ 方法/ 相当/ 甚至/ 更优/ ,/ 那么/ 这种/ 方法/ 必然/ 能够/ 更为/ 快速/ 准确/ 地/ 应对/ 用户/ 异常/ 行为/ ./ 因此/ 本文/ 比较/ 了/ 本文/ 和/ 对照/ 方法/ 在/ 不同/ 时间/ 开销/ (/ 包括/ 样本/ 标记/ 和/ 分类器/ 训练/ )/ 相对/ 取得/ 的/ 检测/ 性能/ 的/ 对照/ 情况/ ,/ 结果/ 如图/ 6/ 所示/ ./ 开销/ 情况/ Page11/ 表/ 5/ 分类器/ 训练/ 开销/ 情况/ 标记/ 比例/ 本文/ 方法/ 1245.652534/ ./ 4710245.402528/ ./ 5520240.502535/ ./ 1330238.742516/ ./ 2040239.642507/ ./ 3850240.462505/ ./ 1560236.742498/ ./ 91670238.232493/ ./ 62580236.352484/ ./ 80690235.562476/ ./ 928/ 从图/ 6/ 可以/ 看出/ ,/ 本文/ 方法/ 使用/ 较少/ 的/ 时间/ 开销/ (/ 2000s/ 左右/ )/ 即可/ 趋于/ 较为/ 稳定/ 的/ 性能/ (/ 约/ 90/ %/ 的/ 准确/ 程度/ )/ ,/ 而/ 对照/ 方法/ 在/ 同样/ 的/ 时间/ 开销/ 条件/ 下/ 其/ 检测/ 性能/ 都/ 在/ 75/ %/ 以下/ ,/ 需要/ 更/ 多/ 的/ 时间/ 开销/ 之后/ 才能/ 提高/ 检测/ 性能/ ,/ 而/ 获得/ 接近/ 90/ %/ 的/ 准确/ 程度/ 普遍/ 需要/ 6000s/ ~/ 10000s/ 甚至/ 更/ 多/ 的/ 时间/ ./ 充分说明/ 本文/ 方法/ 有效/ 地/ 降低/ 了/ 对/ 标记/ 数据/ 的/ 需求/ ,/ 同时/ 仍能/ 维持/ 甚至/ 提高/ 检测/ 准确性/ ,/ 可以/ 更为/ 快速/ 准确/ 地/ 检测/ 用户/ 异常/ 行为/ ./ 综合/ 以上/ 实验/ 结果/ 可知/ ,/ 与/ 传统/ 的/ 网络/ 用户/ 异常/ 行为/ 检测/ 方法/ 相比/ ,/ 本文/ 方法/ 能够/ 有效/ 处理/ 异常/ 行为/ 数据/ 的/ 非/ 平衡性/ 和/ 分布/ 复杂性/ ,/ 在/ 减少/ 训练样本/ 中/ 标记/ 数据量/ 前提/ 下/ 获得/ 更/ 高/ 的/ 分类/ 准确性/ 能/ ./ 6/ 总结/ 和/ 展望/ 在/ 用户/ 规模/ 日益/ 扩大/ 、/ 行为/ 日趋/ 多样化/ 的/ 当今/ 网络/ 环境/ 下/ ,/ 如何/ 快速/ 准确/ 地/ 检测/ 出/ 用户/ 异常/ 行为/ 是/ 网络管理/ 人员/ 的/ 一大/ 挑战/ ./ 在/ 网络/ 的/ 大/ 数据/ 规模/ 下/ ,/ 传统/ 基于/ 无/ 监督/ 学习/ 和/ 监督/ 学习/ 的/ 检测/ 方法/ 由于/ 对/ 网络/ 数据/ 进行/ 标记/ 的/ 巨大/ 开销/ 而/ 无法/ 胜任/ ,/ 基于/ 协同/ 学习/ 的/ 检测/ 方法/ 虽然/ 降低/ 了/ 对/ 标记/ 数据/ 的/ 需求/ ,/ 但/ 不能/ 处理/ 实际/ 网络/ 数据/ 所/ 存在/ 的/ 非/ 平衡/ 和/ 复/ 46.332/ ./ 590.010/ ./ 1247.8742/ ./ 9042.7741/ ./ 91103.470/ ./ 474.7040/ ./ 10129.340/ ./ 595.8839/ ./ 37155.210/ ./ 717.0638/ ./ 73181.080/ ./ 828.2337/ ./ 49206.950/ ./ 949.4136/ ./ 42232.821/ ./ 0610.58/ 杂/ 分布/ 的/ 不足/ 使/ 其/ 在/ 准确性/ 方面/ 受到/ 影响/ ./ 因此/ 本文/ 引入/ 选择性/ 集成/ 技术/ 对/ 传统/ 基于/ 协同/ 学习/ 的/ 检测/ 方法/ 进行/ 改进/ ,/ 提出/ 基于/ 选择性/ 协同/ 学习/ 的/ 检测/ 方法/ ,/ 使用/ 基于/ 多数/ 类/ 分布/ 的/ 改进/ EasyEnssemble/ 方法/ ,/ 将/ 非/ 平衡性/ 和/ 复杂/ 分布/ 的/ 训练样本/ 划分/ 为/ 若干/ 平衡/ 、/ 充分/ 包含/ 分布/ 信息/ 的/ 样本/ 子集/ ,/ 随后/ 使用/ 基于/ 混合/ 扰动/ 方法/ 的/ 成员/ 分类器/ 生成/ 方法/ 构造/ 差异性/ 成员/ 分类器/ 对/ 样本/ 子集/ 进行/ 协同/ 学习/ ,/ 从而/ 获得/ 非/ 平衡/ 数据/ 的/ 处理/ 能力/ ,/ 同时/ 在/ 协同/ 学习/ 过程/ 中/ 使用/ 选择性/ 集成/ 分类/ 方法/ 进行/ 置信度/ 计算/ 及/ 更新/ 数据/ 以/ 降低/ 训练/ 开销/ ,/ 在/ 成员/ 分类器/ 集成/ 过程/ 中/ 基于/ 准确性/ 选择/ 成员/ 分类器/ ,/ 剔除/ 受/ 噪音/ 积累/ 影响/ 的/ 成员/ 以/ 提高/ 准确性/ ,/ 最终/ 使/ 检测/ 方法/ 具备/ 对非/ 平衡/ 、/ 复杂/ 分布/ 的/ 数据处理/ 能力/ ,/ 同时/ 进一步提高/ 了/ 准确性/ ,/ 实现/ 对/ 用户/ 异常/ 行为/ 快速/ 准确/ 的/ 检测/ ./ 实际/ 网络/ 环境/ 的/ 实验/ 表明/ ,/ 本文/ 检测/ 方法/ 在/ 开销/ 、/ 准确性/ 等/ 多个/ 指标/ 上/ 比/ 传统/ 方法/ 表现/ 更好/ ./ 我们/ 下/ 一步/ 的/ 工作/ 包括/ :/ 引入/ 在线/ 学习/ 等/ 方法/ 实现/ 检测/ 模型/ 的/ 动态/ 更新/ ;/ 基于/ 异常/ 行为/ 检测/ 结果/ 研究/ 相应/ 的/ 网络/ 用户/ 行为/ 控制/ 机制/ ,/ 最终/ 实现/ 网络/ 用户/ 行为/ 的/ 可/ 感知/ 、/ 可/ 控制/ ./ 

