Page1Hidasav/ :/ 一种/ 层次化/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 李杰/ 1/ )/ ,/ 2/ )/ 吴建平/ 1/ )/ 徐恪/ 1/ )/ 陈/ 文龙/ 3/ )/ 1/ )/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 3/ )/ (/ 北京科技大学/ 信息/ 工程学院/ 北京/ 100083/ )/ 2/ )/ (/ 国防/ 信息/ 学院/ 武汉/ 430010/ )/ 摘要/ 可/ 信任/ 是/ 下一代/ 互联网/ 的/ 重要/ 特征/ ,/ 真实/ 地址/ 访问/ 是/ 可/ 信任/ 的/ 基础/ 和/ 前提/ ./ 自治/ 域级/ 真实/ 地址/ 访问/ 是/ 整个/ 可/ 信任/ 互联网/ 体系结构/ 中/ 最为/ 复杂/ 的/ 一个/ 层次/ ./ 基于/ 标签/ 的/ 源地址/ 验证/ 不/ 受/ 拓扑/ 结构/ 影响/ ,/ 无需/ 中间/ 节点/ 特殊/ 处理/ ,/ 是/ 实现/ 域间/ 真实/ 地址/ 访问/ 的/ 有效/ 方法/ ./ 然而/ ,/ 现有/ 方法/ 中/ 信任/ 联盟/ 过于/ 扁平化/ 和/ 单一化/ 的/ 问题/ 导致/ 验证/ 开销/ 随/ 联盟/ 规模/ 增大/ 而/ 急剧/ 增大/ ,/ 影响/ 和/ 制约/ 了/ 机制/ 的/ 可扩展性/ 和/ 过滤/ 能力/ ,/ 难以/ 进行/ 增量/ 部署/ ./ 对此/ ,/ 文中/ 提出/ 了/ 一种/ 层次化/ 的/ 基于/ 标签/ 替换/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ (/ Hidasav/ )/ ,/ 该/ 方法/ 通过/ 合理/ 规划/ 联盟/ 层次/ 和/ 聚类/ 整合/ ,/ 构建/ 出/ 一种/ 多级/ 并存/ 的/ 信任/ 联盟/ 体系结构/ ,/ 通过/ 引入/ 实现/ 轻量级/ 标签/ 替换/ 的/ 联盟/ 边界/ ,/ 将/ 每/ 一层/ 级/ 联盟/ 和/ 外界/ 网络/ 隔离/ ,/ 使得/ 下层/ 联盟/ 和/ 更/ 高层/ 联盟/ 内部/ 的/ 网络/ 环境/ 彼此/ 互不/ 可见/ 、/ 互无/ 影响/ ./ 与/ 现有/ 同类/ 典型/ 方法/ 在/ CNGI/ 真实/ 环境/ 中/ 的/ 实验/ 结果/ 比较/ 表明/ ,/ 该/ 方法/ 能够/ 在/ 确保/ 域间/ 高速通信/ 的/ 同时/ 有效/ 降低/ 边界/ 路由/ 设备/ 的/ 状态机/ 存储/ 、/ 更新/ 和/ 报文/ 验证/ 开销/ ./ 关键词/ 层次化/ ;/ 自治/ 域间/ ;/ IP地址/ 验证/ ;/ 网络安全/ 1/ 引言/ 可/ 信任/ 是/ 下一代/ 互联网/ 的/ 重要/ 特征/ ,/ 其/ 内涵/ 是/ 下一代/ 互联网/ 在/ 开放/ 、/ 简单/ 的/ 技术/ 基础/ 上/ ,/ 以/ 安全性/ 、/ 真实性/ 、/ 可/ 审计/ 性/ 、/ 私密性/ 、/ 抗毁/ 性/ 和/ 可控性/ 为/ 主要/ 特性/ ,/ 建立/ 完备/ 的/ 安全/ 保障体系/ ,/ 从/ 网络体系结构/ 上/ 保证/ 网络/ 信息/ 的/ 真实/ 和/ 可追溯/ ,/ 进而/ 提供/ 安全/ 可信/ 的/ 网络服务/ 和/ 应用/ ./ 从/ 可/ 信任/ 的/ 角度/ 出发/ ,/ 真实/ IP地址/ 访问/ 的/ 问题/ 实际上/ 是/ 地址/ 的/ 归属/ 关系/ 问题/ :/ 网络/ 实体/ 发出/ 的/ 报文/ 只应/ 携带/ 它/ 拥有/ 的/ 地址/ ,/ 报文/ 只应/ 被/ 拥有/ 其/ 源地址/ 的/ 实体/ 发出/ ,/ 真实/ 源/ IP地址/ 验证/ 则/ 是/ 对/ 实体/ 发出/ 的/ 报文/ 进行/ 检验/ 和/ 追溯/ 进而/ 确保/ 实体/ 本身/ 、/ 信息/ 来源/ 、/ 信息内容/ 的/ 真实性/ ./ 当前/ 的/ 互联网/ ,/ 报文/ 转发/ 的/ 基本/ 依据/ 是/ 目的/ IP地址/ ,/ 一般/ 不/ 对/ 报文/ 的/ 源/ IP地址/ 做/ 真实性/ 检查/ ,/ 导致/ 其易/ 被/ 伪造/ ,/ 接收/ 方/ 不能/ 判别/ 报文/ 源/ IP地址/ 的/ 真实性/ ,/ 也/ 就/ 无法/ 确定/ 报文/ 是否/ 来自/ 真实/ 的/ 发送/ 方/ ./ 因此/ ,/ 目前/ 的/ 网络服务/ 只是/ 停留/ 在/ 尽力而为/ 地向/ 目的/ 端/ 转发/ 的/ 层次/ ,/ 而/ 达/ 不到/ 确保/ 源端/ 可信/ 的/ 高度/ ./ 随着/ 互联网/ 规模/ 的/ 日益/ 拓展/ 和/ 商业/ 应用/ 的/ 日益/ 丰富/ ,/ 网络/ 用户/ 的/ 成分/ 变得/ 异常/ 复杂/ ,/ 来自/ 某些/ 高级/ 用户/ 的/ 恶意/ 攻击/ 常常/ 是/ 通过/ 伪造/ 报文/ 的/ 源/ IP地址/ 来/ 实施/ 的/ ,/ 伪造/ 的/ 源/ IP地址/ 同时/ 又/ 为/ 恶意/ 攻击者/ 隐匿/ 真实/ 身份/ 、/ 逃避/ 制裁/ 提供/ 了/ 温床/ ,/ 并/ 由此/ 引发/ 了/ 很多/ 安全/ 、/ 管理/ 和/ 计费/ 问题/ ./ 例如/ DoS/ [/ 1/ ]/ // DDoS/ 攻击/ [/ 2/ ]/ 、/ 僵尸/ 网络/ (/ Botnet/ )/ [/ 3/ ]/ 、/ 垃圾/ 流量/ (/ SPAM/ )/ [/ 4/ ]/ 等等/ ,/ 目前/ 已有/ 许多/ 研究/ 工作/ 是/ 就/ 它们/ 展开/ 的/ [/ 5/ -/ 10/ ]/ ./ 当前/ ,/ 源/ IP地址/ 的/ 真实性/ 验证/ 已/ 给/ 互联网/ 的/ 安全/ 运营/ 和/ 可/ 持续/ 发展/ 提出/ 了/ 诸多/ 挑战/ ./ 致力于/ 互联网/ 的/ 长远利益/ ,/ 互联网/ 只有/ 提供/ 高度/ 可信/ 的/ 网络服务/ ,/ 才能/ 满足/ 未来/ 发展/ 的/ 需求/ ./ 因此/ ,/ 确保/ 源/ IP地址/ 的/ 真实性/ 是/ 实现/ 可/ 信任/ 下一代/ 互联网/ 的/ 核心/ 问题/ ./ 自治/ 域间/ 真实/ 源地址/ 验证/ 是/ 整个/ 可/ 信任/ 互联网/ 体系结构/ 中/ 最为/ 复杂/ 的/ 一个/ 层次/ ./ 自治/ 域间/ 真实/ 源地址/ 验证/ 方法/ 旨在/ 实现/ 自治/ 域/ 粒度/ 的/ 真实/ 源地址/ 验证/ ,/ 其/ 特点/ 是/ :/ 能够/ 在/ 不同/ 自治/ 域间/ 协同工作/ ;/ 机制/ 必须/ 简单/ 轻权/ ,/ 不给域/ 间/ 高速通信/ 带来/ 明显/ 影响/ ./ 然而/ ,/ 现有/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 存在/ 诸多/ 不足/ ./ 典型/ 的/ 有/ Bremler/ -/ Barr/ 等/ 人/ [/ 11/ ]/ 提出/ 的/ 基于/ 源/ -/ 目的/ 自治/ 域/ 对应/ 密钥/ 的/ 域间/ IP/ 欺骗/ 过滤/ 机制/ SPM/ ,/ 能够/ 过滤/ 自治/ 域间/ IP/ 欺骗/ 报文/ ,/ 保护/ 本域/ 范围/ 网络/ 用户/ ./ 然而/ 密钥/ 的/ 管理/ 、/ 协商/ 和/ 同步/ 引入/ 了/ 较大/ 的/ 通信/ 开销/ ,/ 降低/ 了/ 验证/ 性能/ ,/ 增大/ 了/ 验证/ 复杂度/ ./ Shen/ 等/ 人/ [/ 12/ ]/ 借鉴/ SPM/ 的/ 加密/ 认证/ 机制/ ,/ 提出/ 了/ 基于/ 标签/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ (/ APPA/ )/ ./ 参与/ 的/ 自治/ 域/ 构建/ 信任/ 联盟/ ,/ 联盟/ 内源/ 和/ 目的/ 自治/ 域间/ 通过/ 状态机/ 来/ 生成/ 用于/ 源地址/ 检查/ 的/ 轻量级/ 标签/ ,/ 标签/ 随着/ 状态/ 的/ 变迁/ 而/ 自动更新/ ,/ 从而/ 减小/ 了/ 标签/ 管理/ 、/ 协商/ 和/ 同步/ 等/ 通信/ 开销/ ,/ 同时/ 加快/ 了/ 标签/ 更新/ 的/ 频率/ 和/ 速度/ ,/ 进一步提高/ 了/ 安全/ 性能/ ./ 但是/ ,/ 过于/ 扁平化/ 和/ 单一化/ 的/ 信任/ 联盟/ 体系结构/ 导致/ 了/ 状态机/ 存储/ 和/ 处理/ 等/ 验证/ 开销/ 随/ 联盟/ 规模/ 增大/ 而/ 急剧/ 增大/ ,/ 影响/ 和/ 制约/ 了/ 机制/ 的/ 可扩展性/ 和/ 过滤/ 能力/ ,/ 难以/ 适应/ 增量/ 部署/ ./ 对此/ ,/ 本文/ 提出/ 了/ 层次化/ 的/ 基于/ 标签/ 替换/ 的/ 自治/ 域间/ 真实/ 源地址/ 验证/ 方法/ (/ Hidasav/ )/ ./ 与/ 传统/ 的/ 扁平化/ 的/ 基于/ 标签/ 的/ 验证/ 方法/ 相比/ ,/ 本/ 方法/ 着力/ 解决/ 了/ 以下/ 3/ 个/ 方面/ 的/ 问题/ :/ (/ 1/ )/ 通过/ 分层/ ,/ 改变传统/ 方法/ 中/ 扁平/ 的/ 、/ 单一/ 的/ 信任/ 联盟/ 体系结构/ ,/ 构建/ 了/ 新型/ 的/ 多级/ 共存/ 的/ 、/ 层次化/ 的/ 体系结构/ ,/ 避免/ 了/ 联盟/ 成员/ 间/ 建立/ 不必要/ 的/ 全/ 连接/ 的/ 状态机/ 双向/ 共享/ 关系/ 和/ 覆盖/ 全局/ 的/ 前缀/ 和/ 自治/ 域/ 对应/ 信息/ ,/ 实现/ 了/ 验证/ 机制/ 的/ 简化/ ;/ (/ 2/ )/ 通过/ 引入/ 实现/ 标签/ 替换/ 的/ “/ 中继/ 代理/ ”/ —/ —/ —/ 联盟/ 边界/ ,/ 将/ 每/ 一层/ 级/ 联盟/ 和/ 外界/ 网络/ 隔离/ ,/ 使得/ 不同/ 层级/ 联盟/ 内部/ 网络/ 环境/ 彼此/ 互不/ 可见/ ,/ 在/ 确保/ 域间/ 高速通信/ 的/ 同时/ 排除/ 了/ 拓扑/ 结构/ 和/ 成员/ 变化/ (/ 加入/ 和/ 退出/ )/ 带来/ 的/ 影响/ ,/ 有效/ 控制/ 了/ 验证/ 规则/ 信息/ 更新/ 的/ 范围/ 和/ 频度/ ;/ (/ 3/ )/ 减少/ 了/ 用于/ 标签/ 添加/ 、/ 替换/ 和/ 验证/ 的/ 状态机/ 的/ 数量/ ,/ 降低/ 了/ 边界/ 路由/ 设备/ 的/ 状态机/ 存储/ 和/ 更新/ 开销/ ,/ 缩减/ 了/ 数据/ 报文/ 验证/ 开销/ ./ 实验/ 证明/ ,/ 本/ 方法/ 在/ 规模/ 较大/ 的/ 层次化/ 信任/ 联盟/ 体系结构/ 中/ 仍/ 能/ 保证/ 验证/ 的/ 简单/ 、/ 轻权/ 、/ 有效/ ,/ 具备/ “/ 先/ 部署/ 先/ 受益/ ”/ 的/ 激励机制/ ,/ 可以/ 实现/ 增量/ 部署/ ./ 第/ 2/ 节/ 介绍/ 问题/ 的/ 研究/ 背景/ 和/ 相关/ 工作/ ;/ 第/ 3/ 节/ 回顾/ 基于/ 标签/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 的/ 基本/ 思想/ ;/ 第/ 4/ 节/ 阐述/ Hidasav/ 的/ 设计/ 原理/ ;/ 第/ 5/ 节/ 描述/ Hidasav/ 构建/ 的/ 层次化/ 信任/ 联盟/ 的/ 体系结构/ 并/ 详细/ 论述/ 验证/ 机制/ 的/ 实现/ ;/ 第/ 6/ 节对本/ 方法/ 的/ 有效性/ 进行/ 分析/ 并/ 通过/ 实验/ 论证/ 本/ 方法/ 的/ 性能/ ;/ 第/ 7/ 节/ 总结/ 全文/ ./ 2/ 相关/ 研究/ 近年来/ ,/ 在/ 源地址/ 验证/ 研究/ 领域/ ,/ 国际/ 学术界/ 和/ 工业界/ 已/ 做出/ 了/ 许多/ 研究/ 工作/ ,/ 概括/ 起来/ 可/ 分为/ 3/ 类/ :/ 基于/ 追踪/ 的/ 方法/ 、/ 基于/ 过滤/ 的/ 方法/ 和/ 基于/ 加密/ 认/ Page3/ 证/ 的/ 方法/ ./ 基于/ 追踪/ 的/ 方法/ 的/ 核心思想/ 是/ 对/ 伪造/ 报文/ 的/ 传输/ 进行/ 全程/ 跟踪/ ,/ 解析/ 其/ 相应/ 的/ 转发/ 路由/ ,/ 最终/ 追溯/ 和/ 定位/ 报文/ 的/ 真实/ 发送/ 源/ ./ 依据/ 追踪/ 过程/ 中/ 对/ 相关/ 信息/ 的/ 记录/ 方式/ ,/ 基于/ 追踪/ 的/ 方法/ 可/ 分为/ 3/ 类/ :/ (/ 1/ )/ 将/ 报文/ 传输/ 途径/ 的/ 路由器/ 信息/ 记录/ 在/ 报文/ 头/ 的/ 某/ 一/ 区段/ ,/ 主要/ 有/ PPM/ [/ 13/ ]/ 和/ DPM/ [/ 14/ ]/ ./ 该类/ 方法/ 的/ 局限性/ 体现/ 在/ 只能/ 追踪/ 流量/ 规模/ 较大/ 的/ 报文/ 流/ ;/ (/ 2/ )/ 在/ 路由器/ 上/ 追踪/ 记录/ 一定/ 时间/ 间隔/ 内/ 经过/ 的/ 报文/ 的/ 部分/ 信息/ ,/ 主要/ 有/ SPIE/ [/ 15/ ]/ ./ 该类/ 方法/ 的/ 局限性/ 体现/ 在/ 给/ 路由器/ 带来/ 庞杂/ 的/ 计算/ 和/ 存储/ 开销/ ;/ (/ 3/ )/ 利用/ ICMP/ 消息报/ 文/ 存储/ 报文/ 转发/ 路由/ 路径/ ,/ 主要/ 有/ iTrace/ [/ 16/ ]/ 和/ iTrace/ -/ CP/ [/ 17/ ]/ ./ 该类/ 方法/ 的/ 局限性/ 体现/ 在/ 实施/ 追溯/ 时/ 无法/ 有效/ 避免/ ICMP/ 协议/ 本身/ 的/ 缺陷/ 即/ ICMP/ 报文/ 易/ 被/ 伪造/ 和/ 匿名/ 攻击/ ./ 从根本上/ 讲/ ,/ 基于/ 追踪/ 的/ 方法/ 强调/ 一种/ 事后/ 弥补/ 的/ 被动/ 追溯/ 机制/ ,/ 无法/ 实现/ 在/ 源地址/ 假冒/ 等/ 网络/ 灾害/ 发生/ 前/ 主动性/ 、/ 前瞻性/ 的/ 采取/ 防御/ ./ 基于/ 过滤/ 的/ 方法/ 是/ 一种/ 预先/ 处置/ 的/ 方法/ ,/ 该类/ 方法/ 通过/ 预先/ 设定/ 的/ 一些/ 过滤/ 规则/ 检查/ 报文/ 中/ 的/ 某些/ 字/ 段/ ,/ 以/ 验证/ 报文/ 是否/ 来自/ 真实/ 源/ ,/ 将/ 伪造/ 报文/ 过滤/ 在/ 到达/ 接收/ 方/ 之前/ 的/ 网络/ 中/ ./ 典型/ 的/ 有/ DPF/ [/ 18/ ]/ 、/ SAVE/ [/ 19/ ]/ 、/ IngressFiltering/ [/ 20/ ]/ 、/ uRPF/ [/ 21/ ]/ 、/ HCF/ [/ 22/ ]/ 以及/ 基于/ 转/ 发表/ 的/ 过滤/ 方法/ [/ 23/ ]/ 等/ ./ 基于/ 转/ 发表/ 的/ 过滤/ 方法/ 规定/ ,/ 报文/ 的/ 进入/ 端口/ 必须/ 与/ 源地址/ 的/ 转发/ 端口/ 一致/ ./ 然而/ ,/ 网络/ 中/ 报文/ 实际/ 转发/ 路由/ 的/ 不对称性/ 往往/ 导致/ 很多/ 来自/ 真实/ 源地址/ 的/ 合法/ 报文/ 被/ 滤除/ ;/ uRPF/ 无法/ 解决/ 非对称/ 路由/ 的/ 问题/ ;/ IngressFiltering/ 要求/ 在/ 边界/ 路由器/ 上/ 部署/ 报文/ 过滤器/ ,/ 引入/ 了/ 一定/ 的/ 额外/ 开销/ ,/ 不仅/ 导致/ 网络/ 性能/ 有所/ 下降/ ,/ 而且/ 必须/ 得到/ 设备/ 制造商/ 的/ 支持/ 和/ 各/ ISP/ 间/ 的/ 合作/ 以及/ 广泛/ 部署/ 才/ 会/ 奏效/ ,/ 因此/ 缺乏/ 部署/ 激励/ ./ DPF/ 将/ 验证/ 规则/ 的/ 部署/ 位置/ 从/ 边缘/ 网络/ 延伸/ 到/ 了/ 核心/ 网络/ 且/ 支持/ 增量/ 部署/ ,/ 但/ 代价/ 是/ 需/ 对/ BGP/ 协议/ 进行/ 扩展/ ,/ 当/ 路由/ 动态变化/ 时/ 可能/ 导致/ 滤除/ 合法/ 的/ 报文/ ;/ SAVE/ 设计/ 了/ 一种/ 新/ 的/ 协议/ ,/ 在/ 网络/ 中/ 传递/ 源地址/ 验证/ 规则/ 信息/ ,/ 但是/ 协议/ 没有/ 考虑/ 路由/ 系统/ 的/ 层次结构/ ,/ 变化/ 的/ 域/ 内/ 路由/ 可能/ 频繁/ 导致/ 验证/ 规则/ 的/ 更新/ ,/ 增大/ 了/ 通信/ 开销/ 也/ 影响/ 了/ 源地址/ 验证/ 的/ 准确性/ ,/ 并且/ 要求/ 全局/ 部署/ ,/ 使/ 协议/ 的/ 可扩展性/ 受到/ 制约/ ./ 基于/ 加密/ 认证/ 的/ 方法/ 引入/ 了/ 一种/ 端到/ 端的/ 加密/ 认证/ 机制/ ,/ 排除/ 了/ 网络拓扑/ 、/ 路由/ 路径/ 的/ 影响/ ,/ 无需/ 中间/ 节点/ 特殊/ 处理/ ./ 加密/ 由源/ 自治/ 域端/ 添加/ 认证/ 源/ 真实/ 身份/ 的/ 标签/ 完成/ ./ 报文/ 转发/ 至/ 目的/ 自治/ 域端/ 时/ 检查/ 报文/ 携带/ 标签/ ,/ 如果/ 标签/ 验证/ 正确/ ,/ 即/ 把/ 标签/ 从/ 报文/ 中/ 去除/ 并/ 将/ 报文/ 转发给/ 目的/ 主机/ ;/ 如果/ 标签/ 验证/ 不/ 正确/ ,/ 就/ 将/ 报文/ 丢弃/ ./ SPM/ [/ 11/ ]/ 是/ 一种/ 典型/ 的/ 基于/ 加密/ 认证/ 的/ 自治/ 域端/ 到/ 自治/ 域/ 端的/ 解决方案/ ,/ 每/ 一对/ 互为/ 通信/ 对/ 端的/ 自治/ 域/ 维护/ 一对/ 私密/ 的/ 、/ 唯一/ 的/ 密钥/ 来/ 验证/ 源地址/ 的/ 真实性/ ,/ 源端/ 自治/ 域/ 通过/ 添加/ 密钥/ 可/ 保证/ 源地址/ 的/ 真实性/ ,/ 目的/ 端/ 自治/ 域/ 通过/ 检查/ 密钥/ 可验证/ 源地址/ 的/ 真实性/ ./ 到达/ 目的/ 端/ 自治/ 域/ 的/ 报文/ 密钥/ 被/ 验证/ 正确/ 后/ ,/ 即/ 把/ 密钥/ 从/ 报文/ 中/ 去除/ ,/ 若/ 验证/ 不/ 正确/ ,/ 则/ 将/ 报文/ 丢弃/ ./ SPM/ 可/ 实现/ 自治/ 域/ 粒度/ 的/ 真实/ 源地址/ 验证/ ,/ 使得/ 部署/ SPM/ 的/ 自治/ 域/ 可以/ 有效/ 保护/ 本域/ 网络/ 中/ 的/ 用户/ ,/ 具有/ 部署/ 激励/ ./ 然而/ ,/ SPM/ 密钥/ 的/ 协商/ 、/ 管理/ 和/ 同步/ 需要/ 收发/ 双方/ 频繁/ 进行/ 通信/ ,/ 致使/ 当/ 网络/ 繁忙/ 或/ 遭受/ DoS/ // DDoS/ 攻击/ 时/ ,/ 其/ 验证/ 性能/ 大幅/ 下降/ ,/ 这/ 也/ 构成/ 制约/ 其/ 推广/ 的/ 软肋/ ./ 针对/ 上述/ 问题/ ,/ APPA/ [/ 12/ ]/ 在/ SPM/ 的/ 基础/ 上/ 进行/ 了/ 有益/ 的/ 改进/ ./ APPA/ 的/ 实现/ 思想/ 我们/ 将/ 在/ 第/ 3/ 节中/ 简要/ 介绍/ ./ 互联网/ 的/ 路由/ 和/ 寻址/ 是/ 一个/ 层次结构/ ,/ 要/ 实现/ 全网/ 的/ 真实/ 源/ IP地址/ 验证/ ,/ 依赖/ 单一/ 的/ 方法/ ,/ 部署/ 在/ 单一/ 层次/ 和/ 位置/ 是/ 不/ 现实/ 的/ [/ 24/ ]/ ./ 为了/ 解决/ 全网/ 真实/ 源/ IP地址/ 问题/ ,/ 清华大学/ 提出/ 了/ 基于/ 真实/ IPv6/ 源地址/ 的/ 网络/ 寻址/ 体系结构/ (/ SAVA/ )/ [/ 25/ ]/ ,/ 设计/ 和/ 实现/ 了/ 一种/ 包括/ 接入/ 、/ 域/ 内/ 、/ 域间/ 源地址/ 验证/ 3/ 个/ 层次/ 的/ 真实/ IPv6/ 源地址/ 网络/ 寻址/ 系统/ ,/ 分别/ 在/ 主机/ 、/ IP地址/ 前缀/ 和/ 自治/ 域/ 粒度/ 上/ 保证/ 源/ IP地址/ 的/ 真实性/ ./ 其中/ ,/ 域间/ 源地址/ 验证/ 是/ SAVA/ 体系结构/ 中/ 最/ 困难/ 和/ 复杂/ 的/ 部分/ ,/ 根据/ 自治/ 域/ 邻接/ 关系/ ,/ SAVA/ 设计/ 了/ 2/ 种/ 生成/ 域间/ 验证/ 规则/ 的/ 机制/ :/ 应用/ 于/ 相邻/ 自治/ 域间/ 的/ 基于/ 路由/ 的/ 机制/ 和/ 应用/ 在/ 非/ 相邻/ 自治/ 域间/ 的/ 基于/ 签名/ 的/ 机制/ ./ SAVA/ 通过/ IPv6/ 源地址/ 验证/ ,/ 为/ 解决/ 下一代/ 互联网/ 的/ 安全隐患/ 提供/ 了/ 重要/ 保证/ ,/ 成为/ 可/ 信任/ 下一代/ 互联网/ 的/ 重要/ 技术/ 基础/ ./ 目前/ ,/ 清华大学/ 已/ 在/ IETF/ 完成/ 一项/ RFC/ 标准/ [/ 26/ ]/ ,/ 提交/ 3/ 项/ 标准/ 草案/ [/ 27/ -/ 29/ ]/ ,/ 并/ 以此/ 为/ 基础/ 推动/ IETF/ 成立/ 专门/ 工作组/ SAVI/ ,/ 使/ 中国/ 参与/ IETF/ 国际标准/ 方面/ 实现/ 了/ 新/ 的/ 突破/ ,/ 产生/ 了/ 重要/ 的/ 国际/ 影响/ ./ 3/ 自治/ 域间/ 源地址/ 验证/ 方法/ 概述/ 在/ 基于/ 加密/ 认证/ 的/ 方法/ 中/ ,/ 典型/ 的/ 是/ 文献/ [/ 12/ ]/ 的/ 基于/ 标签/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ ,/ 其/ 实现/ 思想/ 是/ :/ 由/ 部署/ 验证/ 机制/ 的/ 自治/ 域/ 作为/ 成员/ 单位/ 组建/ 一个/ 信任/ 联盟/ ,/ 联盟/ 内/ 每/ 一对/ 互为/ 通信/ 对/ 端的/ 成员/ Page4/ 自治/ 域/ ASX/ 和/ ASY/ 都/ 各自/ 维护/ 有/ 一对/ 分别/ 用来/ 生成/ 和/ 验证/ 标签/ 的/ 状态机/ 〈/ ASX/ ,/ ASY/ 〉/ 和/ 〈/ ASY/ ,/ ASX/ 〉/ (/ 状态机/ 的/ 双向/ 有序性/ )/ ,/ 当/ ASX/ 作为/ 源域/ 时/ 即/ 数据/ 报文/ 源自/ ASX/ 发往/ ASY/ ,/ ASX/ 的/ 出口/ 边界/ 路由器/ 依据/ 状态机/ 〈/ ASX/ ,/ ASY/ 〉/ 生成/ 确保/ 源于/ 本域/ 的/ 数据/ 报文/ 源地址/ 真实性/ 的/ 标签/ 并/ 添加/ 在/ 报文/ 扩展/ 头/ 中/ ,/ 目的/ 域/ ASY/ 的/ 入口/ 边界/ 路由器/ 则/ 依据/ 相同/ 的/ 状态机/ 〈/ ASX/ ,/ ASY/ 〉/ 来/ 验证/ 标签/ ,/ 若/ 验证/ 通过/ 则/ 判定/ 源地址/ 是/ 真实可信/ 的/ ,/ 即/ 数据/ 报文/ 的确/ 源自/ ASX/ ,/ 从而/ 去除/ 标签/ 进一步/ 转发/ ,/ 否则/ 判定/ 该/ 源地址/ 系/ 伪造/ ,/ 数据/ 报文/ 予以/ 丢弃/ ;/ 同样/ 原理/ ,/ 当/ ASY/ 作为/ 源域/ ASX/ 作为/ 目的/ 域时/ ,/ 通信/ 双方/ 的/ 边界/ 路由器/ 依据/ 状态机/ 〈/ ASY/ ,/ ASX/ 〉/ 来/ 生成/ 和/ 验证/ 标签/ ,/ 从而/ 实现/ 源地址/ 前缀/ 的/ 验证/ ./ 图/ 1/ 基于/ 端到/ 端/ 轻量级/ 标签/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 该/ 方法/ 完善/ 了/ SPM/ 方法/ 的/ 加密/ 认证/ 机制/ ,/ 解决/ 了/ 密钥/ 的/ 协商/ 、/ 管理/ 和/ 同步/ 导致/ 频繁/ 通信/ 的/ 问题/ ,/ 降低/ 了/ 控制/ 服务器之间/ 的/ 通信/ 开销/ ,/ 在/ 确保/ 本域/ 的/ 地址/ 不/ 被/ 伪造/ 的/ 同时/ 还/ 可验证/ 其它/ 来源/ 地址/ 的/ 真实性/ ,/ 具有/ 一定/ 的/ 部署/ 激励/ ./ 但是/ ,/ 由于/ 部署/ 该/ 方法/ 的/ 所有/ 自治/ 域/ 同属/ 一个/ 信任/ 联盟/ ,/ 为/ 确保/ 验证/ 机制/ 的/ 有效/ 运转/ ,/ 所有/ 成员/ 间/ 必须/ 建立/ 全/ 连接/ 的/ 状态机/ 双向/ 共享/ 关系/ 和/ 前缀/ 与/ 自治/ 域/ 全局/ 对应/ 信息/ ,/ 由此/ 导致/ 边界/ 路由器/ 必须/ 维护/ 数量/ 庞大/ 的/ 全局/ 验证/ 规则/ 信息/ 才能/ 正确/ 实施/ 验证/ ./ 比如/ ,/ 当/ 联盟/ 成员数/ 为/ N/ 时/ ,/ 每一/ 边界/ 路由器/ 需/ 维护/ 的/ 状态/ 机数量/ 达到/ 2/ (/ N/ -/ 1/ )/ 个/ ,/ 状态机/ 存储/ 的/ 空间/ 复杂度/ 达到/ O/ (/ N/ )/ 量级/ ,/ 状态/ 该/ 方法/ 的/ 有效/ 实施/ 需要/ 由/ 联盟/ 注册/ 服务器/ 、/ 控制/ 服务器/ 以及/ 边界/ 路由器/ 协同工作/ 来/ 完成/ ,/ 如图/ 1/ 所示/ ./ 在/ 每/ 一/ 成员/ 域/ 内部/ ,/ 都/ 配属/ 有/ 一台/ 控制/ 服务器/ ,/ 该/ 服务器/ 主要/ 完成/ 以下/ 职能/ :/ 与/ 注册/ 服务器/ 通信/ ,/ 完成/ 自身/ 注册/ 并/ 获取/ 联盟/ 成员/ 列表/ 以及/ 其它/ 成员/ 域/ 的/ 控制/ 服务器/ 地址/ 列表/ ;/ 与/ 其它/ 控制/ 服务器/ 交换/ 各自/ 所辖/ 的/ 地址/ 前缀/ 信息/ 并/ 协商/ 生成/ 标签/ 所/ 需/ 的/ 状态机/ ;/ 控制/ 本域/ 的/ 边界/ 路由器/ ,/ 配置/ 地址/ 前缀/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 和/ 进出/ 方向/ 的/ 状态机/ 列表/ ,/ 上述/ 环节/ 以下/ 简称/ “/ 验证/ 规则/ 部署/ ”/ ./ 在/ 整个/ 信任/ 联盟/ 内部/ ,/ 配属/ 有/ 一台/ 联盟/ 注册/ 服务器/ ,/ 用于/ 动态/ 维护/ 信任/ 联盟/ 全局/ 成员/ 的/ 列表/ 信息/ ,/ 管理/ 和/ 控制/ 成员/ 的/ 加盟/ 及/ 退出/ ,/ 向/ 控制/ 服务器/ 实时/ 发布/ 联盟/ 成员/ 信息/ ./ 上述/ 环节/ 以下/ 简称/ “/ 成员/ 信息管理/ ”/ ./ 机/ 更新/ 代价/ 达到/ O/ (/ N2/ )/ 量级/ ./ 大/ 数量/ 的/ 状态机/ 加重/ 了/ 路由器/ 存储/ 开销/ 和/ 更新/ 延时/ ,/ 使得/ 状态机/ 的/ 协商/ 和/ 同步/ 难以/ 控制/ ,/ 报文/ 验证/ 延时/ 增大/ 、/ 效率/ 降低/ ,/ 由/ 成员/ 变化/ 带来/ 的/ 影响/ 辐射/ 整个/ 联盟/ 范围/ ./ 上述/ 分析表明/ ,/ 导致/ 传统/ 的/ 基于/ 标签/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 难以实现/ 大规模/ 部署/ 的/ 根本/ 问题/ 是/ :/ 信任/ 联盟/ 体系结构/ 的/ 扁平化/ 和/ 单一化/ ./ 4Hidasav/ 方法/ 总体设计/ 针对/ 上述/ 问题/ ,/ 本文/ 在/ 文献/ [/ 12/ ]/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一种/ 可/ 自下而上/ 分/ 层级/ 建立/ 信任/ 联盟/ 的/ 、/ 基于/ 轻/ Page5/ 量级/ 标签/ 替换/ 的/ 自治/ 域间/ 真实/ 源地址/ 验证/ 方法/ ./ 本节/ 将/ 详细/ 阐述/ 本/ 方法/ 的/ 设计/ 思想/ 以及/ 验证/ 机制/ ./ 在/ 中文/ 信任/ 联盟/ TrustAlliance/ 联盟/ 注册/ 服务器/ RegistrationServer/ 控制/ 服务器/ ASControlServer/ 边界/ 路由器/ / ASEdgeRouter/ 联盟/ 边界/ TrustAllianceEdge/ 标签/ Tag/ 表/ 1/ 相关/ 术语/ 和/ 定义/ 对照表/ TA/ 部署/ 了/ 验证/ 机制/ 的/ 成员/ 集合/ 多台/ AER/ )/ 确定/ )/ 多台/ TAER/ )/ 联盟/ 边界/ 路由器/ / TrustAllianceEdgeRouterTAER/ 在/ 联盟/ 边界/ 处/ 连接/ 联盟/ 外部/ 网络/ 的/ 出口/ 路由器/ (/ 实际/ 中/ ,/ 每个/ TAE/ 可能/ 有/ 本级/ 联盟/ 状态机/ LocalAllianceStateMachineLSM/ 某一子/ 联盟/ 内部/ 成员/ 间/ 用以/ 生成/ 和/ 验证/ 标签/ 序列/ 的/ 状态机/ (/ 在/ 不同/ 场景/ 中/ ,/ 该/ 本级/ 联盟/ 状态机/ 表/ LocalAllianceStateMachine/ 全局/ 状态机/ GlobalAllianceStateMachineGSM/ 联盟/ 全局/ 范围/ 内/ 的/ 不同/ 层级/ 联盟/ 成员/ 间/ 用以/ 生成/ 和/ 验证/ 标签/ 序列/ 的/ 状态机/ 全局/ 状态机/ 表/ GlobalAllianceStateMachine/ 联盟/ 映射/ 状态机/ Membervs/ ./ AllianceMapping/ 联盟/ 映射/ 状态机/ 表/ Membervs/ ./ AllianceMapping/ 注/ :/ / 目前/ ,/ “/ 可/ 信任/ 下一代/ 互联网/ 关键技术/ 及/ 应用/ 示范/ 研究/ ”/ 课题组/ 已/ 委托/ 设备/ 制造商/ 研制/ 出试/ 商用/ 源地址/ 验证/ 设备/ AER/ // TAER/ ,/ 提出/ 了/ 相/ GSMT/ 用于/ 存储/ 全局/ 状态机/ 的/ 信息/ 表应/ 的/ 技术规范/ 和/ 标准/ ,/ 并/ 组织/ 技术/ 团队/ 对/ 设备/ 软/ 、/ 硬件/ 进行/ 了/ 系统/ 测试/ 和/ 验收/ ./ 4.1/ 设计/ 目标/ 本/ 方法/ 的/ 总体设计/ 目标/ 是/ :/ 遵从/ 系统/ 设计/ 的/ 开放性/ 、/ 简单/ 性/ 原则/ [/ 30/ ]/ ,/ 立足/ 实际/ 网络体系结构/ ,/ 能够/ 分/ 层级/ 构建/ 信任/ 联盟/ ,/ 能够/ 在/ 不同/ 自治/ 域间/ 协调/ 工作/ ,/ 从/ 终端用户/ 的/ 角度/ 使/ 信任/ 联盟/ 的/ 层次化/ 结构/ 趋于/ 透明/ ,/ 它们/ 无需/ 关心/ 验证/ 机制/ 的/ 实现/ 即可/ 受益/ ,/ 从/ 系统/ 设计/ 的/ 角度/ 则/ 需/ 做到/ 异常/ 行为/ 状态/ 可/ 监测/ 、/ 结果/ 可/ 评估/ 、/ 过程/ 可/ 控制/ [/ 31/ ]/ ,/ 以/ 尽量少/ 的/ 通信/ 、/ 存储/ 和/ 处理/ 开销/ ,/ 获得/ 最大/ 限度/ 的/ 验证/ 实效/ ,/ 维护/ 自治/ 域/ 粒度/ 的/ 信任/ 关系/ 和/ 不良行为/ 控制/ ,/ 形成/ 一个/ 高性能/ 的/ 信任/ 系统/ ./ 具体/ 而言/ ,/ 本/ 方法/ 在/ 实施/ 和/ 技术/ 层面/ 应该/ 包括/ 以下/ 一组/ 设计/ 目标/ :/ (/ 1/ )/ 优化/ 性能/ ./ 验证/ 方法/ 应该/ 简单/ 轻权/ ,/ 以/ 尽可能/ 小/ 的/ 路由器/ 存储空间/ 、/ 计算资源/ 和/ 通信/ 开销/ ,/ 获得/ 较/ 高/ 的/ 真实/ 源地址/ 的/ 安全/ 保障/ [/ 32/ ]/ ,/ 不/ 影响/ 交换/ 路由/ 信息/ 和/ 降低/ 路由/ 收敛/ 速度/ ,/ 不/ 给/ 自治/ 域间/ 的/ 高速通信/ 带来/ 明显/ 影响/ ./ (/ 2/ )/ 安全/ 机制/ 可/ 扩展/ ./ 验证/ 方法/ 的/ 效能/ 应该/ 与/ 部署/ 规模/ 成正比/ ,/ 能够/ 增强/ 现有/ 规模/ 信任/ 联盟/ 网络/ 主动/ 预防/ 和/ 积极/ 抵御/ 多种/ 攻击/ 、/ 威慑/ 的/ 能力/ ,/ 尽可能/ 地/ 将/ 不/ 信任/ 的/ 访问/ 操作/ 遏制/ 在/ 源端/ ,/ 而且/ 这种/ 能力/ 能/ 给出/ 详细/ 的/ 讨论/ 前/ ,/ 首先/ 列出/ 本/ 方法/ 涉及/ 的/ 相关/ 术语/ 和/ 定义/ ,/ 如表/ 1/ 所示/ ./ 够/ 随着/ 机制/ 部署/ 规模/ 的/ 扩大/ 而/ 相应/ 增长/ ,/ 使/ 网络/ 的/ 安全/ 机制/ 具有/ 健壮性/ 和/ 可扩展性/ ,/ 同时/ 还/ 可为/ 其它/ 多种/ 网络应用/ 服务/ 提供/ 安全/ 支持/ (/ 组播/ 准入/ 控制/ 等/ )/ [/ 33/ ]/ ./ (/ 3/ )/ 支持/ 增量/ 部署/ ./ 验证/ 方法/ 能够/ 提供/ 自治/ 域间/ 端/ 到/ 端的/ 安全/ 服务/ ,/ 必须/ 立足/ 实际/ 网络拓扑/ 结构/ 和域/ 间/ 路由/ 决策/ 机制/ ,/ 验证/ 设备/ (/ RES/ 和/ ACS/ )/ 的/ 引入/ 既/ 不/ 触及/ 核心/ 网络/ (/ 设备/ )/ 也/ 不/ 对/ 边缘/ 网络/ (/ 设备/ )/ 做/ 任何/ 改变/ ,/ 无需/ 终端用户/ 和/ 中间/ 节点/ (/ 报文/ 转发/ 途经/ 的/ 部署/ 或/ 未/ 部署/ 验证/ 机制/ 的/ 节点/ )/ 特殊/ 处理/ ,/ 只/ 需/ 通过/ 带外/ 接入/ 的/ 方式/ 部署/ 在/ 联盟/ 成员/ 网络/ 边缘/ ,/ 无需/ 进行/ 域间/ 路由/ 协议/ 扩展/ ,/ 对/ 路由/ 协议/ 的/ 稳定性/ 没有/ 负面影响/ ,/ 能够/ 以较/ 小/ 的/ 部署/ 复杂度/ 提供/ 足够/ 充分/ 的/ 信任/ 保障/ ./ (/ 4/ )/ 松/ 耦合/ ./ 验证/ 方法/ 的/ 实现/ 能够/ 有效/ 排除/ 实际/ 网络/ 中域/ 间/ 路由/ 变化/ 及/ 非对称/ 路由/ 的/ 影响/ ,/ 不/ 依赖/ 自治/ 域间/ 的/ 邻接/ 关系/ ,/ 部署/ 验证/ 机制/ 的/ 各个/ 自治/ 域/ 相互/ 独立/ ,/ 允许/ 各域/ 依据/ 实际/ 情况/ (/ 隶属/ 关系/ 、/ 自身/ 策略/ 、/ 网络结构/ 和/ 经济/ 、/ 政治/ 、/ 军事/ 利益/ )/ 灵活/ 构建/ 多/ 层级/ 的/ 信任/ 联盟/ ;/ 同时/ 还/ 允许/ 各/ 自治/ 域/ 内部/ 灵活/ 实现/ 更/ 细粒度/ 的/ 真实/ 源地址/ 验证/ ,/ 域/ 内外/ 验证/ 系统/ 相互/ 独立/ ,/ 最大/ 限度/ 地/ 保证/ 验证/ 的/ 准确性/ 、/ 严密性/ 和/ Page6/ 灵活性/ ./ 4.2/ 基本/ 思想/ 本/ 方法/ 采用/ 一种/ 基于/ 轻量级/ 标签/ 替换/ 的/ 自治/ 域端/ 到/ 自治/ 域/ 端的/ 加密/ 认证/ 机制/ ,/ 通过/ 自下而上/ 的/ 分层/ ,/ 将/ 部署/ 了/ 本/ 方法/ 的/ 所有/ 自治/ 域/ (/ AS/ )/ 划分/ 为/ 多/ 层级/ 信任/ 联盟/ ,/ 每/ 一层/ 级/ 联盟/ 可以/ 作为/ 成员/ (/ 抽象/ 为/ 一个/ 系统/ 整体/ )/ 参加/ 更/ 高层/ 级/ 的/ 联盟/ ,/ 使得/ 整个/ 信任/ 联盟/ 系统/ 构成/ 一种/ 具有/ 源地址/ 验证/ 功能/ 的/ 、/ 层次化/ 的/ 体系结构/ ./ 我们/ 将/ 在/ 第/ 5.1/ 节中/ 给出/ 体系结构/ 的/ 详细/ 阐述/ ./ 在/ 数据/ 层面/ ,/ 与/ 扁平化/ 结构/ 中/ 单一/ 的/ 数据通信/ 场景/ 相比/ ,/ 在/ 层次化/ 的/ 信任/ 联盟/ 体系结构/ 中/ ,/ 通过/ 分层/ 数据通信/ 场景/ 被/ 扩展/ 为/ 3/ 类/ :/ (/ 1/ )/ 单一/ 信任/ 联盟/ 数据通信/ ,/ 某一/ 最低/ 层级/ 信任/ 联盟/ 内/ 成员/ AS/ 互为/ 通信/ 对端/ ,/ 报文/ 仅/ 在/ 该/ 联盟/ 内部/ 网络/ 中/ 交互/ ./ 在/ 此类/ 数据通信/ 场景/ 中/ ,/ 源地址/ 验证/ 过程/ 无需/ 标签/ 替换/ ,/ 只/ 需/ 依据/ 该/ 最低/ 层级/ 联盟/ 状态机/ ,/ 采用/ 传统/ 的/ 验证/ 机制/ 即可/ 有效/ 实现/ 源地址/ 验证/ ;/ (/ 2/ )/ 跨/ 信任/ 联盟/ 数据通信/ ,/ 隶属于/ 不同/ 层级/ 信任/ 联盟/ 的/ AS/ 互为/ 通信/ 对端/ ,/ 数据/ 报文/ 需要/ 在/ 跨越/ 联盟/ 的/ 网络/ 中/ 交互/ ./ 在/ 此类/ 数据通信/ 场景/ 中/ ,/ 处在/ 不同/ 层级/ 联盟/ 中/ 的/ 源/ AS/ 和/ 目的/ AS/ 间/ 无需/ 通过/ 建立/ 状态机/ 双向/ 共享/ ,/ 而是/ 通过/ 引入/ TAE/ 和/ 联盟/ 映射/ 状态机/ 来/ 实现/ 源地址/ 验证/ ./ 其/ 原理/ 是/ :/ 数据/ 报文/ 由源/ AS/ 端/ AER/ 依据/ 联盟/ 映射/ 状态机/ 生成/ 并/ 添加/ 确保/ 源地址/ 真实性/ 的/ 第一个/ 标签/ ,/ 建立/ 最初/ 的/ 信任/ 关系/ ,/ 报文/ 沿着/ 路由/ 协议/ 决策/ 的/ 域间/ 路由/ 正常/ 转发/ 的/ 过程/ 中/ ,/ 在/ 途经/ 第一个/ TAE/ 时/ ,/ 由/ 该处/ 的/ TAER/ 根据/ 联盟/ 映射/ 状态机/ 表/ 和/ 全局/ 状态机/ 表将/ 标签/ 替换成/ 数据/ 报文/ 转发/ 途经/ 的/ 更/ 高层/ 级/ 联盟/ 的/ 标签/ 后/ 向/ 本级/ 联盟/ 外部/ 网络/ 转发/ ,/ 如果/ 报文/ 穿越/ 多个/ 更/ 高层/ 级/ 的/ 联盟/ ,/ 则/ 多次/ 执行/ 上述/ 过程/ 由/ TAER/ 充当/ 跨/ 联盟/ 数据/ 报文/ 交互/ 的/ “/ 中继/ 代理/ ”/ ,/ 完成/ 自下而上/ 的/ 逐级/ 标签/ 替换/ ,/ 延续/ 报文/ 源地址/ 真实性/ 的/ 信任/ 关系/ ,/ 当/ 报文/ 送达/ 目的/ AS/ 所在/ 的/ 各级/ 联盟/ 的/ TAE/ 时/ ,/ 相应/ 地/ 由/ 每/ 一层/ 级/ 的/ TAER/ 对/ 报文/ 进行/ 自上而下/ 的/ 逐级/ 标签/ 替换/ ,/ 直至/ 将/ 数据/ 报文/ 转发/ 至/ 目的/ AS/ 所在/ 最低/ 层级/ 联盟/ 的/ TAE/ ,/ 由/ 该处/ 的/ TAER/ 根据/ 联盟/ 映射/ 状态机/ 表/ 进行/ 最后/ 一次/ 标签/ 替换/ ,/ 当/ 报文/ 到达/ 目的/ AS/ 端时/ 由/ AER/ 依据/ 联盟/ 映射/ 状态机/ 进行/ 标签/ 检验/ 和/ 去除/ ,/ 完成/ 源地址/ 验证/ ,/ 验证/ 机制/ 的/ 实现/ 我们/ 将/ 在/ 5.2/ 节/ 详细/ 阐述/ ;/ (/ 3/ )/ 非/ 信任/ 联盟/ 数据通信/ ,/ 信任/ 联盟/ 中/ 的/ AS/ 与/ 其它/ 非/ 信任/ 联盟/ AS/ 间/ 进行/ 的/ 数据通信/ ./ 在/ 此类/ 数据通信/ 场景/ 中/ 无需/ 源地址/ 验证/ 也/ 不/ 涉及/ 标签/ 的/ 任何/ 操作/ ./ 在/ 控制/ 层面/ ,/ 本/ 方法/ 借鉴/ 了/ 文献/ [/ 12/ ]/ 中/ 有关/ 控制/ 层面/ 和/ 数据/ 层面/ 的/ 处理/ 机制/ ,/ 同样/ 需要/ 由/ RES/ 、/ ACS/ 以及/ 路由/ 设备/ 协同工作/ 来/ 完成/ 验证/ 策略/ 的/ 协商/ 和/ 决策/ ,/ 生成/ 相应/ 的/ 验证/ 控制/ 规则/ 和/ 指令/ ,/ 控制数据/ 报文/ 的/ 验证/ 动作/ ./ 所/ 不同/ 的/ 是/ ,/ 在/ 我们/ 提出/ 的/ 层次化/ 体系结构/ 中/ ,/ RES/ 和/ ACS/ 被/ 赋予/ 新/ 的/ 职能/ ./ 每一/ 联盟/ 内部/ 均/ 需/ 配属/ 一台/ RES/ ,/ 在/ 对/ 下/ 完成/ 本级/ 联盟/ 的/ 成员/ 信息管理/ 的/ 同时/ ,/ 对/ 上/ 还/ 须/ 与/ 其它/ 各/ 层级/ 联盟/ 的/ RES/ 交互/ 成员/ 列表/ ;/ 参与/ 信任/ 联盟/ 的/ 每/ 一/ 自治/ 域/ 均/ 配属/ 一台/ ACS/ ,/ 对/ 下须/ 完成/ 本级/ 联盟/ 范围/ 的/ 验证/ 规则/ 部署/ ,/ 对/ 上/ 须/ 与/ 其它/ 层级/ 联盟/ 建立/ 通信/ ,/ 参与/ 更/ 高层/ 级/ 联盟/ 的/ 验证/ 规则/ 部署/ ;/ ACS/ 还须/ 接收/ AER/ // TAER/ 的/ 运行/ 状态/ 汇报/ ./ 需要/ 说明/ 的/ 是/ 伴随/ 上述/ 过程/ 的/ 实施/ ,/ 所有/ TAE/ 会/ 同时/ 明确/ 自身/ “/ 中继/ 代理/ ”/ 的/ 职能/ ,/ TAE/ 的/ ACS/ 会/ 相应/ 完成/ 对/ TAER/ 的/ 配置/ ./ 4.3/ 安全/ 机制/ 为/ 有效/ 抵御/ 针对/ 验证/ 规则/ 部署/ 和/ 成员/ 信息管理/ 过程/ 的/ 窃听/ 、/ 截获/ 和/ 破解/ 等/ 安全/ 威胁/ ,/ 增强/ 验证/ 机制/ 的/ 健壮性/ ,/ 本/ 方法/ 着重/ 考虑/ 了/ 以下/ 4/ 点/ 设计/ :/ (/ 1/ )/ 状态机/ 的/ 周期/ 自动/ 更替/ 机制/ ./ 为/ 每/ 一个/ 状态机/ 设置/ 了/ 启用/ 和/ 到期/ 时间/ ,/ 在/ 到期/ 时间/ 来临/ 之后/ ,/ 互为/ 通信/ 对/ 端的/ 源域/ 和/ 目的/ 域/ 必须/ 同步/ 自动/ 完成/ 新旧/ 状态机/ 更替/ ,/ 确保/ 了/ 生成/ 的/ 标签/ 在/ 一定/ 周期/ 内/ 的/ 时效性/ 、/ 唯一性/ 和/ 可靠性/ ,/ 降低/ 了/ ACS/ 之间/ 的/ 通信/ 开销/ ;/ (/ 2/ )/ 时间/ 同步/ ./ 要求/ RES/ 通过/ NTP/ 协议/ 定期/ 向/ 各/ 成员/ ACS/ 发送/ 时间/ 校准/ 报文/ ,/ 由/ ACS/ 实时/ 校准/ 本域/ AER/ // TAER/ 的/ 时间/ ,/ 同时/ 在/ 各/ AER/ // TAER/ 上/ 设置/ 一个/ 共享/ 时间/ 片/ ,/ 规定/ 在/ 该/ 时间/ 片内/ ,/ 刚刚/ 到期/ 的/ 标签/ 与/ 新/ 的/ 标签/ 均/ 被/ 认为/ 是/ 有效/ 的/ ,/ 从而/ 确保/ 各/ 成员/ AER/ // TAER/ 之间/ 的/ 时间/ 同步/ ,/ 进而/ 实现/ 状态机/ 的/ 同步/ ;/ (/ 3/ )/ 安全/ 信道/ ./ 立足/ 现有/ 域间/ 链路/ ,/ 采用/ 开启/ TCP/ 拦截/ 和/ Diffie/ -/ Hellman/ 协议/ 结合/ 的/ 方式/ ,/ 通过/ TCP/ 连接/ 建立/ 起/ 验证/ 规则/ 信息/ 交互/ 的/ 安全/ 信道/ ;/ (/ 4/ )/ TAER/ 工作/ 模式/ ./ 允许/ TAER/ 在/ 进行/ 标签/ 替换/ 的/ 同时/ 可/ 依据/ 网络安全/ 等级/ 灵活/ 设置/ 工作/ 模式/ (/ 直接/ 替换/ 模式/ 或/ 替换/ 并/ 验证/ 模式/ )/ ./ 5/ 体系结构/ 与/ 实现/ 本/ 节/ 介绍/ 层次化/ 信任/ 联盟/ 的/ 体系结构/ ,/ 并/ 通过/ 实例/ 讨论/ 验证/ 涉及/ 的/ 控制/ 层面/ 和/ 数据/ 层面/ 的/ 处理/ 流程/ ./ Page75/ ./ 1/ 体系结构/ 层次化/ 的/ 域间/ 源地址/ 验证/ 方法/ 允许/ 联盟/ 管理机构/ 依据/ 实际/ 情况/ ,/ 灵活/ 选取/ 不同/ 的/ 划分/ 原则/ 和/ 组合/ 模式/ 构建/ 层次化/ 的/ 信任/ 联盟/ 体系结构/ ./ 首先/ 以/ AS/ 为/ 单位/ 成员/ ,/ 将/ 部署/ 本/ 方法/ 的/ 所有/ AS/ 按照/ 相同/ 属性/ 聚合/ 成/ 多个/ 最低/ 层级/ 信任/ 联盟/ ,/ 然后/ 再/ 以/ 这些/ 最低/ 层级/ 信任/ 联盟/ 为/ 单位/ 成员/ ,/ 依据/ 一定/ 的/ 划分/ 原则/ 聚合/ 成/ 更/ 高层/ 级/ 的/ 信任/ 联盟/ ,/ 由此/ 自下而上/ 地/ 不断/ 以/ 同一/ 层级/ 的/ 信任/ 联盟/ 为/ 单位/ 嵌套/ 式/ 聚合/ ,/ 直至/ 形成/ 一个/ 最高/ 层级/ 信任/ 联盟/ ,/ 如图/ 2/ 所示/ ./ 在/ 层次化/ 的/ 信任/ 联盟/ 体系结构/ 中/ ,/ 进行/ 标签/ 添加/ 、/ 替换/ 和/ 检验/ 的/ 图/ 2/ 基于/ 标签/ 替换/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 构建/ 的/ 层次化/ 的/ 信任/ 联盟/ 体系结构/ 5.2/ 验证/ 机制/ 实现/ 下面/ 选取/ 图/ 2/ 中/ 的/ 最低/ 层级/ 和/ 其/ 上/ 一级/ 的/ 两层/ 级/ 信任/ 联盟/ 体系结构/ 为例/ ,/ 说明/ AER/ // TAER/ 如何/ 进行/ 基于/ 标签/ 替换/ 的/ 域间/ 真实/ 源地址/ 验证/ 过程/ ,/ 如图/ 3/ 所示/ ./ 在/ 以下/ 的/ 讨论/ 中/ ,/ 最低/ 层级/ 信任/ 联盟/ 分别/ 表示/ 为/ Sub/ -/ TA1/ 、/ Sub/ -/ TA2/ 、/ Sub/ -/ TA3/ 等/ ,/ 其上/ 一级/ 信任/ 联盟/ 表示/ 为/ TA/ ,/ 〈/ ASX/ ,/ Sub/ -/ TAY/ 〉/ 二元/ 组/ 表示/ 成员/ ASX/ 个体/ 与/ 最低/ 层级/ 联盟/ Sub/ -/ TAY/ 整体/ 对应/ 的/ 联盟/ 映射/ 状态机/ ,/ 〈/ Sub/ -/ TAX/ ,/ Sub/ -/ TAY/ 〉/ 二元/ 组/ 表示/ 在/ TA/ 中源端/ 成员/ Sub/ -/ TAX/ 与/ 目的/ 端/ 成员/ Sub/ -/ TAY/ 对应/ 的/ 状态机/ ,/ 〈/ Sub/ -/ TAX/ ,/ ASY/ 〉/ 二元/ 组/ 表示/ 最低/ 层级/ 联盟/ Sub/ -/ TAX/ 整体/ 与/ 成员/ ASY/ 个体/ 对应/ 的/ 联盟/ 映射/ 状态机/ ,/ tag1/ 表示/ 由/ 〈/ ASX/ ,/ Sub/ -/ TAY/ 〉/ 生成/ 的/ 标签/ ,/ tag2/ 表示/ 由/ 〈/ Sub/ -/ TAX/ ,/ Sub/ -/ TAY/ 〉/ 生成/ 的/ 标签/ ,/ tag3/ 表示/ 由/ 〈/ Sub/ -/ TAX/ ,/ ASY/ 〉/ 生成/ 的/ 标签/ ,/ AER/ _/ AS/ / 表示/ 最低/ 层级/ 信任/ 联盟/ 中/ 某/ 一/ 成员/ AS/ / 的/ 主体/ 是/ 边界/ 路由器/ ,/ 它们/ 区分/ 为/ 2/ 类/ :/ AER/ 和/ TAER/ ./ AER/ 位于/ 最低/ 层级/ 信任/ 联盟/ 内部/ ,/ 无需/ 进行/ 标签/ 替换/ ,/ 其/ 职责/ 是/ 添加/ 数据/ 报文/ 的/ 第一个/ 标签/ 和/ 完成/ 最后/ 一次/ 标签/ 验证/ ,/ 只/ 需/ 维护/ 最低/ 层级/ 信任/ 联盟/ 成员/ 数量级/ 的/ 状态机/ 有序/ 对/ 和/ 前缀/ -/ 自治/ 域/ 对应/ 关系/ 等/ 验证/ 规则/ 信息/ 而/ 无需/ 掌握/ 全局/ 情况/ ;/ TAER/ 位于/ 联盟/ 边界/ 是/ 连接/ 不同/ 层级/ 联盟/ 的/ 桥梁/ 和/ 纽带/ ,/ 其/ 职责/ 是/ 在/ 跨/ 联盟/ 数据通信/ 时/ 完成/ 数据/ 报文/ 标签/ 的/ 逐级/ 替换/ ,/ 由于/ 处理过程/ 涉及/ 多个/ 层级/ 的/ 信任/ 联盟/ ,/ 因此/ 每/ 一层/ 级/ 的/ TAER/ 必须/ 掌握/ 全局/ 验证/ 规则/ 信息/ ./ AER/ ,/ TAER/ _/ AS/ / 表示/ 某一/ 联盟/ 边界/ AS/ / 中/ 的/ TAER/ ,/ TAER/ 在/ 进行/ 标签/ 替换/ 时/ 工作/ 模式/ 设置/ 为/ 直接/ 替换/ 模式/ ./ 图/ 3/ 中/ ,/ 不同/ 灰度/ 的/ 实心/ 圆/ 分别/ 表示/ AER/ 和/ TAER/ ,/ 各圆间/ 的/ 连接线/ 标识/ 了/ 各个/ 自治/ 域间/ 建立/ 的/ BGP/ 会话/ ,/ 同时/ 也/ 表示/ BGP/ 决策/ 的/ 从源/ 到/ 目的/ 自治/ 域/ 的/ 域间/ 路由/ 路径/ ./ 在/ 以下/ 实例/ 中/ ,/ RES/ 、/ ACS/ 和/ AER/ // TAER/ 已/ 完成/ 了/ 成员/ 信息管理/ 和/ 验证/ 规则/ 部署/ 等/ 各项/ 初始化/ 阶段/ 工作/ 程序/ ,/ 进入/ 稳定/ 工作/ 状态/ ./ 这里/ ,/ 着重/ 说明/ 跨/ 联盟/ 数据通信/ 时/ 数据/ 层面/ 的/ 处理过程/ ,/ 其余/ 2/ 种/ 通信/ 场景/ 不再/ 赘述/ ./ 1/ ./ 源域/ ASX/ 的/ AER/ _/ ASX/ 收到/ 域/ 内/ 用户/ 发来/ 的/ 数据/ 报文/ ,/ 根据/ 地址/ 前缀/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 对/ 源地址/ 和/ 目的/ 地址/ 依次/ 检查/ ,/ 判定/ 数据/ 报文/ 源地址/ 属于/ 本域/ (/ ASX/ )/ 、/ 目的/ 地址/ 属于/ 对/ 等/ 联盟/ Sub/ -/ TA3/ 中/ 成员/ ASY/ ,/ 随即/ 启动/ 如下/ 处理/ 策略/ :/ 查询/ MSMT/ ,/ 定位/ 状态机/ 〈/ ASX/ ,/ Sub/ -/ TA2/ 〉/ ,/ 生成/ 并/ 添加/ tag1/ ,/ 向/ 本域/ 外部/ 网络/ 转发/ ./ 2/ ./ 报文/ 转发/ 至/ 中间/ 节点/ ASM/ 时/ ,/ 该/ 节点/ 根据/ 地址/ 前缀/ Page8/ 图/ 3/ 基于/ 标签/ 替换/ 的/ 域间/ 真实/ 源地址/ 验证/ 方法/ 验证/ 过程/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 对/ 源地址/ 和/ 目的/ 地址/ 依次/ 检查/ ,/ 当/ 发现/ 报文/ 源地址/ 不/ 属于/ 本域/ 时/ 即/ 停止/ 检查/ ,/ 不/ 对/ 报文/ 做/ 任何/ 处理/ 直接/ 按照/ 目的/ 地址/ 转发/ 至下/ 一/ 跳/ ./ 3/ ./ 报文/ 转发/ 至/ 路由/ 路径/ 上/ 的/ 第/ 1/ 个/ TAE/ 即/ 本级/ 联盟/ Sub/ -/ TA2/ 与/ 外部/ 网络/ 的/ “/ 中继/ 代理/ ”/ ASZ/ (/ 所有/ TAE/ 事先/ 就/ 已/ 明确/ 自身/ “/ 中继/ 代理/ ”/ 的/ 职能/ )/ 处/ 完成/ 第一次/ 标签/ 替换/ ,/ TAER/ _/ ASZ/ 处理/ 策略/ 如下/ :/ 根据/ 地址/ 前缀/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 对/ 源地址/ 和/ 目的/ 地址/ 依次/ 检查/ ,/ 查询/ MSMT/ 找到/ 对应状态/ 机/ 〈/ ASX/ ,/ Sub/ -/ TA2/ 〉/ ,/ 去除/ 标签/ tag1/ ,/ 紧接着/ 查询/ GSMT/ ,/ 定位/ 状态机/ 〈/ Sub/ -/ TA2/ ,/ Sub/ -/ TA3/ 〉/ ,/ 生成/ 并/ 添加/ tag2/ ,/ 向/ 本级/ 联盟/ 外部/ 网络/ 转发/ ./ 4/ ./ 报文/ 转发/ 至/ 中间/ 节点/ ASW/ 时/ ,/ 该/ 节点/ 不/ 对/ 报文/ 做/ 任何/ 处理/ ,/ 直接/ 按照/ 目的/ 地址/ 转发/ 至下/ 一/ 跳/ ./ 5/ ./ 报文/ 转发/ 至/ 路由/ 路径/ 上源端/ 所在/ 联盟/ Sub/ -/ TA3/ 的/ TAE/ 即/ ASU/ 处/ 完成/ 第/ 2/ 次/ 标签/ 替换/ ,/ TAER/ _/ ASU/ 处理/ 策略/ 如下/ :/ 根据/ 地址/ 前缀/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 对/ 源地址/ 和/ 目的/ 地址/ 依次/ 检查/ ,/ 查询/ GSMT/ 找到/ 对应状态/ 机/ 〈/ Sub/ -/ TA2/ ,/ Sub/ -/ TA3/ 〉/ ,/ 去除/ 标签/ tag2/ ,/ 紧接着/ 查询/ MSMT/ ,/ 定位/ 状态机/ 〈/ Sub/ -/ TA3/ ,/ ASY/ 〉/ ,/ 生成/ 并/ 添加/ tag3/ ,/ 完成/ 最后/ 一次/ 标签/ 替换/ ,/ 向/ 本级/ 联盟/ 内部/ 网络/ 转发/ ./ 6/ ./ 报文/ 转发/ 至/ 中间/ 节点/ ASK/ 时/ ,/ 该/ 节点/ 不/ 对/ 报文/ 做/ 任何/ 处理/ ,/ 直接/ 按照/ 目的/ 地址/ 转发/ 至下/ 一/ 跳/ ./ 7/ ./ 目的/ 域/ ASY/ 的/ AER/ _/ ASY/ 收到/ 数据/ 报文/ ,/ 根据/ 地址/ 前缀/ 与/ 自治/ 域/ 的/ 映射/ 列表/ 对/ 源地址/ 和/ 目的/ 地址/ 依次/ 检查/ ,/ 判定/ 数据/ 报文/ 源地址/ 属于/ 对/ 等/ 联盟/ Sub/ -/ TA3/ 中/ 成员/ ASX/ 目的/ 地址/ 属于/ 本域/ ASY/ ,/ 随即/ 启动/ 如下/ 处理/ 策略/ :/ 查询/ MSMT/ ,/ 定位/ 状态机/ 〈/ Sub/ -/ TA3/ ,/ ASY/ 〉/ ,/ 验证/ 并/ 去除/ tag3/ ,/ 向/ 本域/ 内部/ 网络/ 转发/ ./ 至此/ ,/ 域间/ 真实/ 源地址/ 验证/ 过程/ 结束/ ,/ 过程/ 中/ 一旦/ 检测/ 到/ 非法/ 报文/ 则/ 立即/ 丢弃/ ./ 6/ 有效性/ 分析/ 与/ 性能/ 评价/ 本/ 节/ 首先/ 分别/ 分析/ 了/ Hidasav/ 对于/ 状态机/ 存储/ 开销/ 和/ 更新/ 代价/ 的/ 优化/ 以及/ 对于/ 单位/ 数据/ 报文/ 验证/ 开销/ 的/ 影响/ ,/ 接着/ 进行/ 了/ 实验/ 评估/ ./ 6.1/ 有效性/ 分析/ 假设/ 在/ 扁平化/ 的/ 信任/ 联盟/ 中/ ,/ 加入/ 联盟/ 的/ AS/ 总数/ 为/ N/ ,/ 那么/ ,/ 每个/ AER/ 所需/ 维护/ 的/ 状态机/ 列表/ 规模/ 是/ SAER/ =/ 2/ (/ N/ -/ 1/ )/ ,/ 并设/ 其/ 对应/ 的/ 集合/ 为/ CF/ ;/ 在/ 层次化/ 的/ 信任/ 联盟/ 中/ ,/ 所有/ 部署/ Hidasav/ 的/ AS/ 组建/ 信任/ 联盟/ TA/ (/ N/ ,/ L/ )/ ,/ N/ 是/ 加入/ 信任/ 联盟/ 的/ AS/ 总数/ ,/ L/ 是/ TA/ (/ N/ ,/ L/ )/ 的/ 层级/ 总数/ (/ 1/ </ L/ </ log2N/ +/ 1/ ,/ L/ ∈/ Z/ )/ ./ 令/ mi/ 表示/ TA/ (/ N/ ,/ L/ )/ 中/ 第/ i/ 层级/ 子/ 联盟/ 共有/ mi/ 个/ (/ 1/ </ mi/ / L/ -/ 1/ 槡/ N/ ,/ mi/ ∈/ Z/ 且/ 均匀/ )/ ,/ pij/ 表示/ 第/ i/ 层中/ 第/ j/ 个子/ 联盟/ Sub/ -/ TA/ (/ N/ ,/ L/ )/ ij/ 中/ 的/ 成员/ 个数/ ,/ (/ 1/ / i/ / L/ ,/ 1/ / j/ / mi/ ,/ 1/ </ pij/ / L/ -/ 1/ 槡/ N/ ,/ i/ ,/ j/ ,/ pij/ ∈/ Z/ )/ 为了/ 易于/ 描述/ 和/ 反映/ TA/ (/ N/ ,/ L/ )/ 的/ 层次/ 关系/ ,/ 将/ TA/ (/ N/ ,/ L/ )/ 抽象/ 为/ 一棵/ 高/ L/ 的/ 树/ / ,/ 其中/ 每个/ 节点/ 表示/ 一个/ 信任/ 联盟/ ,/ 所有/ 叶子/ 节点/ 代表/ 联盟/ 的/ 成员数/ 的/ 总和/ 即/ 为/ 加入/ 信任/ 联盟/ 的/ AS/ 总数/ N/ ,/ 如图/ 4/ 所示/ ./ TA/ (/ N/ ,/ L/ )/ 中/ 每个/ AER/ 所需/ 维护/ 的/ 状态机/ 列表/ 规模/ 是/ 珚/ SAER/ ,/ 并设/ 其/ 对应/ 的/ 集合/ 为/ CAER/ ;/ 每个/ TAER/ 所需/ 维护/ 的/ 状态机/ 列表/ 规模/ 是/ 珚/ STAER/ ,/ 并设/ 其/ 对应/ 的/ 集合/ 为/ CTAER/ ./ Page9/ 图/ 4/ / 树/ 层次化/ 的/ 体系结构/ (/ 该树型/ 结构/ 反映/ 了/ 层次化/ 6.1/ ./ 1/ 合理/ 规划/ 、/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ (/ 1/ )/ 状态机/ 存储/ 开销/ 合理/ 规划/ 是/ 指/ 联盟/ 管理机构/ 必须/ 允许/ 自治/ 域/ 依据/ 隶属/ 关系/ 、/ 路由/ 策略/ 、/ 网络结构/ 、/ 数据通信/ 统计分析/ 和/ 经济/ 、/ 政治/ 、/ 军事/ 利益/ 等/ 现实情况/ 自主/ 决策/ 加入/ 不同/ 的/ 子/ 信任/ 联盟/ ,/ 灵活/ 构建/ 多/ 层级/ 的/ 信任/ 联盟/ ./ 合理/ 规划/ 的/ 目的/ 是/ 既/ 确保/ 互访/ 数据通信/ 频度/ 较大/ 的/ 自治/ 域/ 聚类/ 整合/ 在/ 同一/ 子/ 联盟/ 内部/ ,/ 最大/ 限度/ 地/ 简化/ 子/ 联盟/ 内部/ 管理/ 的/ 验证/ 规则/ 信息/ ,/ 同时/ 又/ 能/ 保证/ 隶属/ 不同/ 子/ 联盟/ 的/ 自治/ 域间/ 的/ 互联互通/ ,/ 而且/ 应当/ 尽可能/ 既区/ 分出层次/ 又/ 不至于/ 造成/ 层级/ 过多/ 引入/ 标签/ 替换/ 开销/ 增大/ 的/ 负面影响/ ./ 均匀/ 构建/ 是/ 指/ TA/ (/ N/ ,/ L/ )/ 中/ 的/ 所有/ 层级/ 联盟/ 规模/ 一致/ 即/ 从上到下/ 每/ 一层/ 联盟/ 均/ 分为/ m/ 个子/ 联盟/ ./ 由此/ ,/ / 为/ 一棵/ 高为/ L/ 、/ 具有/ N/ 个/ 叶子/ 节点/ 的/ 满/ m/ 叉/ / ,/ AER/ 维护/ 的/ 状态机/ 量级/ 缩减/ 为式/ (/ 1/ )/ 所示/ :/ 树/ / 因为/ L/ 、/ m/ 远/ 小于/ N/ 且/ 均/ 为/ 正整数/ ,/ 那么/ N/ // mL/ -/ 1/ / N/ 必然/ 成立/ ,/ 所以/ 分层/ 后/ AER/ 维护/ 的/ 状态/ 机数量/ 远/ 小于/ 未/ 分层/ 时/ 的/ 状态/ 机数量/ 如式/ (/ 2/ )/ 所示/ ./ 珚/ SAER/ =/ 2/ (/ N/ // mL/ -/ 1/ -/ 1/ )/ +/ 2/ / SAER/ =/ 2/ (/ N/ -/ 1/ )/ (/ 2/ )/ 对于/ TAER/ ,/ 在/ 本级/ 联盟/ 内部/ 它/ 维护/ 着/ 本级/ AS/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ,/ 当/ 作为/ 本级/ 联盟/ 沟通/ 外部/ 其它/ 联盟/ 的/ 中继/ 时/ ,/ 它/ 还/ 需/ 维护/ 本级/ 联盟/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ./ 不失/ 一般性/ ,/ 可以/ 推断/ 当/ 多个/ 不同/ 层次/ 的/ 信任/ 联盟/ 的/ TAE/ 发生/ 重叠/ 时/ ,/ 该/ TAE/ 处/ 的/ TAER/ 就/ 必然/ 在/ 多个/ 层级/ 的/ 信任/ 联盟/ 中/ 分别/ 履行/ TAER/ 的/ 职能/ ./ 那么/ ,/ 考虑/ 最/ 极端/ 的/ 情况/ 即/ TA/ (/ N/ ,/ L/ )/ 中/ 的/ 某个/ 路由器/ 在/ 多个/ 不同/ 层次/ 的/ 信任/ 联盟/ 中/ 兼/ 是/ TAER/ ,/ 记为/ TAERmax/ ,/ 其/ 状态机/ 列表/ 规模/ 记/ 为/ 珚/ STAER/ ./ max/ ./ 显然/ TAERmax/ 需要/ 存储/ 的/ 状态/ 机数量/ 最为/ 庞大/ ,/ 其/ 列表/ 规模/ 由/ 3/ 部分/ 组成/ :/ 一是/ 在/ 最低/ 层级/ 联盟/ 中/ TAERmax/ 所属/ 的/ AS/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ;/ 二是/ 在/ 自下而上/ 的/ 多/ 层级/ 联盟/ 中/ TAERmax/ 所属/ 的/ 成员/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ;/ 三是/ 在/ 自下而上/ 的/ 多/ 层级/ 联盟/ 中/ TAERmax/ 所属/ 的/ 每/ 一个/ 联盟/ 的/ 联盟/ 映射/ 状态机/ ,/ 如式/ (/ 3/ )/ :/ 珚/ STAER/ ./ max/ =/ 2N/ // mL/ -/ 1/ +/ 2/ (/ L/ -/ 1/ )/ m/ -/ 4L/ (/ 3/ )/ 根据/ 第/ 4/ 节中/ 阐述/ 的/ 层次化/ 的/ 验证/ 机制/ 和/ 标签/ 替换/ 规律/ ,/ L/ 的/ 取值/ 应当/ 尽可能/ 兼顾/ 既/ 有效/ 区/ 分出层次/ 、/ 缩减/ AER/ // TAER/ 的/ 状态/ 机数量/ 又/ 不至于/ 造成/ 层级/ 过多/ 而/ 导致/ 标签/ 替换/ 的/ 开销/ 增大/ 的/ 负面影响/ ,/ 因此/ m/ 从/ 上/ 至/ 下/ 一定/ 满足/ 数值/ 没有/ 激增/ 且/ 尽量/ 保持/ 均匀/ ./ 由此/ ,/ 可以/ 推断/ 对于/ 取值/ 范围/ 内/ 的/ 任意/ 的/ L/ 和/ m/ 当/ N/ 达到/ 一定/ 数量级/ 时/ 总有且/ 至少/ 有/ 一组/ L/ 和/ m/ 能够/ 使得/ 2N/ // mL/ -/ 1/ +/ 2/ (/ L/ -/ 1/ )/ m/ -/ 4L/ 最小/ ./ 于是/ ,/ 对式/ (/ 3/ )/ 求导/ ,/ 可/ 得当/ m/ =/ L/ 槡/ N/ 时式/ (/ 3/ )/ 达到/ 最小值/ ./ 也就是说/ ,/ 当/ 采用/ 这样/ 的/ 分层/ 原则/ 和/ 构建/ 方法/ ,/ TAER/ 维护/ 的/ 状态/ 机数量/ 是/ 最小/ 的/ ,/ 如式/ (/ 4/ )/ :/ 因为/ 1/ </ L/ </ log2N/ +/ 1/ ,/ L/ ∈/ Z/ ,/ 所以/ 式/ (/ 4/ )/ 必然/ 成立/ ./ 根据/ 集合论/ ,/ 仍然/ 可以/ 推导/ 出/ 任何/ AER/ ∈/ TA/ (/ N/ ,/ L/ )/ 或/ TAER/ ∈/ TA/ (/ N/ ,/ L/ )/ 对应/ 的/ CAER/ 或/ CTAER/ 都/ 是/ CF/ 的/ 子集/ 即/ CAER/ / CF/ ,/ CTAER/ / CF/ ./ 同时/ ,/ 由于/ 状态机/ 的/ 双向/ 共享/ 特性/ ,/ 状态机/ 列表/ 规模/ 直接/ 决定/ 了/ 其/ 存储/ 开销/ 和/ 更新/ 代价/ ,/ 结合/ 上述/ 分析/ ,/ 由式/ (/ 2/ )/ 和/ (/ 4/ )/ 可知/ ,/ 相对/ 于/ 传统/ 的/ 扁平化/ 的/ 验证/ 方法/ ,/ 当/ 采用/ Hidasav/ 方法/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ 状态机/ 信息/ 的/ 存储/ 开销/ 和/ 更新/ 代价/ 可/ 得到/ 有效/ 缩减/ ,/ 如表/ 2/ 所示/ ./ 表/ 2/ 状态机/ 信息/ 的/ 存储/ 开销/ 和/ 更新/ 代价/ 对照表/ (/ 均匀/ )/ 验证/ 机制/ 联盟/ 规模/ 验证/ 设备/ 状态机/ 存储/ 开销/ 状态机/ 更新/ 代价/ APPANAERO/ (/ N/ )/ O/ (/ N2/ )/ HidasavNAERO/ (/ N/ // mL/ -/ 1/ )/ O/ (/ (/ N/ // m/ (/ L/ -/ 1/ )/ )/ 2/ )/ (/ 2/ )/ 单位/ 数据/ 报文/ 验证/ 开销/ 为了/ 便于/ 分析/ ,/ 表/ 3/ 给出/ 了/ 分析/ 过程/ 需要/ 用到/ 的/ 变量/ 定义/ 及/ 说明/ ./ 变量/ tSM/ 状态机/ 查询/ 单位/ 开销/ tPREIP/ 前缀/ 和/ 所属/ 自治/ 域/ 对应/ 关系/ 查询/ 单位/ 开销/ tOPE/ 添加/ // 去除/ 标签/ 操作/ 单位/ 开销/ SPRE/ 信任/ 联盟/ 全局/ IP/ 前缀/ 数/ 珚/ SPRE/ 最低/ 层次/ 信任/ 联盟/ IP/ 前缀/ 数/ ,/ 是/ SPRE/ 的/ 子集/ Page10/ 当以/ 文献/ [/ 12/ ]/ 方法/ 构建/ 扁平化/ 信任/ 联盟/ 时/ ,/ 其/ 单位/ 数据/ 报文/ 最大/ 验证/ 开销/ CostmaxF/ 是/ :/ CostmaxF/ =/ SAER/ ·/ tSM/ +/ 2/ (/ SPRE/ ·/ tPRE/ +/ tOPE/ )/ 当以/ Hidasav/ 方法/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ 涉及/ 标签/ 验证/ 和/ 处理/ 的/ 数据通信/ 场景/ 由/ 单一/ 信任/ 联盟/ 数据通信/ 和/ 跨/ 联盟/ 数据通信/ 2/ 种/ 组成/ ,/ 假设/ 单一/ 信任/ 联盟/ 数据通信/ 和/ 跨/ 联盟/ 数据通信/ 所/ 占/ 比例/ 分别/ 为/ p/ 和/ 1/ -/ p/ ,/ 那么/ ,/ 单位/ 数据/ 报文/ 最大/ 验证/ 总开销/ 为/ CostmaxH/ ./ u/ =/ CostmaxH/ ./ u/ ./ STA/ ·/ p/ +/ CostmaxH/ ./ u/ ./ CTA/ ·/ (/ 1/ -/ p/ )/ ./ 这里/ 以图/ 3/ 为例/ ,/ 分别/ 在/ 单一/ 信任/ 联盟/ 数据通信/ 和/ 跨/ 联盟/ 数据通信/ 2/ 种/ 场景/ 中/ 对/ 单位/ 数据/ 报文/ 验证/ 开销/ 进行/ 分析/ :/ (/ i/ )/ 单一/ 信任/ 联盟/ 数据通信/ 单位/ 数据/ 报文/ 验证/ 开销/ CostmaxH/ ./ u/ ./ STA/ =/ 2N/ // mL/ -/ 1/ ·/ tSM/ +/ 2/ 珚/ SPRE/ ·/ tPRE/ +/ 2tOPE/ / CostmaxF/ =/ 2/ (/ N/ -/ 1/ )/ ·/ tSM/ +/ 2SPRE/ ·/ tPRE/ +/ 2tOPE/ 因为/ N/ // mL/ -/ 1/ / N/ ,/ 珚/ SPRE/ / SPRE/ ,/ 可得式/ (/ 6/ )/ 必然/ 成立/ ./ 即/ 在/ 单一/ 信任/ 联盟/ 数据通信/ 场景/ 中/ ,/ 以/ Hidasav/ 方法/ 均匀/ 构建/ 层次化/ 信任/ 联盟/ ,/ 能够/ 减小/ 单位/ 数据/ 报文/ 验证/ 开销/ ./ CostmaxH/ ./ u/ ./ CTA/ =/ (/ 珚/ SAER/ +/ 4m/ -/ 2/ )/ ·/ tSM/ +/ (/ ii/ )/ 跨/ 联盟/ 数据通信/ 单位/ 数据/ 报文/ 验证/ 开销/ 根据/ 分析/ 发现/ ,/ 层次化/ 后/ 在/ 跨/ 联盟/ 数据通信/ 场景/ 中/ ,/ 单位/ 数据/ 报文/ 验证/ 开销/ 的/ 组成/ 中/ 有关/ 状态机/ 处理/ 的/ 开销/ 部分/ 有/ 较/ 大幅度/ 缩减/ ,/ 而/ 跨/ 联盟/ 过程/ 中/ 涉及/ 的/ 标签/ 替换/ 开销/ 以及/ 地址/ 前缀/ 和/ 所属/ 自治/ 域/ 对应/ 关系/ 查询/ 开销/ 均/ 有/ 较/ 小幅度/ 的/ 增加/ ,/ 此时/ 的/ 单位/ 数据/ 报文/ 验证/ 开销/ 受/ L/ ,/ m/ 和/ p/ 数值/ 大小/ 因素/ 制约/ ./ 综合/ 评估/ ,/ 通过/ 合理/ 规划/ 即/ 信任/ 联盟/ 层次/ 较/ 小/ 以及/ 互访/ 数据通信/ 频度/ 较大/ 的/ 自治/ 域/ 聚类/ 整合/ 在/ 同一/ 子/ 联盟/ 内部/ ,/ 能够/ 实现/ p/ 和/ m/ 值/ 较大/ 、/ L/ 和/ (/ 1/ -/ p/ )/ 较/ 小/ ,/ 总/ 能够/ 使得/ CostmaxH/ ./ u/ / CostmaxF/ 成立/ ./ 6.1/ ./ 2/ 合理/ 规划/ 、/ 非/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ (/ 1/ )/ 状态机/ 存储/ 开销/ 非/ 均匀/ 构建/ 是/ 指/ TA/ (/ N/ ,/ L/ )/ 中/ 的/ 不同/ 层级/ 或/ 同一/ 层级/ 联盟/ 间/ 规模/ 不/ 完全一致/ ,/ 各/ 联盟/ 可以/ 根据/ 不同/ 的/ 划分/ 原则/ 和/ 构建/ 方法/ 适当/ 地/ 、/ 灵活/ 地/ 组织/ 联盟/ 规模/ ./ 此时/ ,/ TA/ (/ N/ ,/ L/ )/ 可/ 抽象/ 为/ 一棵/ 高为/ L/ 的/ 一般/ 树/ / ./ AER/ 的/ 状态机/ 列表/ 规模/ 缩减/ 为/ 2pLj/ ,/ 因为/ pLj/ 远/ 小于/ N/ ,/ 所以/ 分层/ 后/ 的/ 状态/ 机数量/ 远/ 小于/ 未/ 分层/ 时/ 的/ ,/ 如式/ (/ 8/ )/ 所示/ ./ 珚/ SAER/ =/ 2/ (/ pLj/ -/ 1/ )/ +/ 2/ / SAER/ =/ 2/ (/ N/ -/ 1/ )/ (/ 8/ )/ 对于/ TAER/ ,/ 在/ 本级/ 联盟/ 内部/ 它/ 维护/ 着/ 本级/ AS/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ,/ 当/ 作为/ 本级/ 联盟/ 沟通/ 外部/ 其它/ 联盟/ 的/ 中继/ 时/ ,/ 它/ 还/ 需/ 维护/ 本级/ 联盟/ 与/ 对/ 等/ 节点/ 间/ 的/ 状态机/ 有序/ 对/ ./ 不失/ 一般性/ ,/ 可以/ 推断/ 当/ 多个/ 不同/ 层次/ 的/ 信任/ 联盟/ 的/ TAE/ 发生/ 重叠/ 时/ ,/ 该/ TAE/ 处/ 的/ TAER/ 就/ 必然/ 在/ 多个/ 层级/ 的/ 信任/ 联盟/ 中/ 分别/ 履行/ TAER/ 的/ 职能/ ./ 那么/ ,/ 考虑/ 最/ 极端/ 的/ 情况/ 即/ TA/ (/ N/ ,/ L/ )/ 中/ 的/ 某个/ 路由器/ 在/ 每/ 一层/ 级/ 联盟/ 中/ 都/ 是/ TAER/ ,/ 记为/ TAERmax/ ,/ 其/ 状态机/ 列表/ 规模/ 记/ 为/ 珚/ STAER/ ./ max/ ./ 显然/ TAERmax/ 需要/ 存储/ 的/ 状态/ 机数量/ 最为/ 庞大/ ,/ 其/ 构成/ 同/ 6.1/ ./ 1/ 节中/ (/ 1/ )/ 中/ 所述/ ,/ 如式/ (/ 9/ )/ 所示/ ./ 珚/ STAER/ ./ max/ =/ 4/ ∑/ L/ 其中/ ,/ ∑/ L/ 成员数/ 总和/ ,/ 根据/ 第/ 4/ 节中/ 阐述/ 的/ 层次化/ 的/ 验证/ 机制/ 和/ 标签/ 替换/ 规律/ ,/ L/ 的/ 取值/ 应当/ 尽可能/ 兼顾/ 既/ 有效/ 区/ 分出层次/ 、/ 缩减/ AER/ // TAER/ 的/ 状态机/ 表项/ 又/ 不至于/ 造成/ 层级/ 过多/ 而/ 导致/ 标签/ 替换/ 的/ 开销/ 增大/ 的/ 影响/ ,/ 因此/ mi/ 和/ pij/ 从/ 上/ 至/ 下/ 一定/ 满足/ 数值/ 没有/ 激增/ 且/ 尽量/ 保持/ 均匀/ ./ 由此/ ,/ 可以/ 推断/ 对于/ 取值/ 范围/ 内/ 的/ 任意/ 的/ L/ 和/ pij/ 当/ N/ 达到/ 一定/ 数量级/ 时/ 总有且/ 至少/ 有/ 一个/ 4/ ∑/ L/ 可/ 表示/ 为式/ (/ 10/ )/ :/ i/ =/ 1/ 根据/ 集合论/ ,/ 仍/ 可/ 推导/ 出/ 任何/ AER/ ∈/ TA/ (/ N/ ,/ L/ )/ 或/ TAER/ ∈/ TA/ (/ N/ ,/ L/ )/ 对应/ 的/ CAER/ 或/ CTAER/ 都/ 是/ CF/ 的/ 子集/ 即/ CAER/ / CF/ ,/ CTAER/ / CF/ ./ 同时/ ,/ 由于/ 状态机/ 的/ 双向/ 共享/ 特性/ ,/ 状态机/ 列表/ 规模/ 直接/ 决定/ 了/ 其/ 存储/ 开销/ 和/ 更新/ 代价/ ,/ 分别/ 令/ pLj/ _/ max/ 表示/ AER/ 所在/ 的/ 规模/ 最大/ 的/ 某/ 一/ 最低/ 层级/ 联盟/ 的/ 成员/ 总数/ ,/ plj/ _/ max/ 表示/ TAERmax/ 所在/ 的/ 规模/ 最大/ 的/ 某/ 一层/ 级/ 联盟/ 的/ 成员/ 总数/ ,/ 显然/ pLj/ _/ max/ / N/ ,/ plj/ _/ max/ / N/ ,/ 结合/ 上述/ 分析/ ,/ 由式/ (/ 8/ )/ 和/ 式/ (/ 10/ )/ 可知/ ,/ 相对/ 于/ 传统/ 的/ 扁平化/ 的/ 验证/ 方法/ ,/ 当/ 采用/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ 状态机/ 信息/ 的/ 存储/ 开销/ 和/ 更新/ 代价/ 仍/ 可/ 得到/ 有效/ 缩减/ ,/ 如表/ 4/ 所示/ ./ Page11/ 表/ 4/ 状态机/ 信息/ 的/ 存储/ 开销/ 和/ 更新/ 代价/ 对照表/ (/ 非/ 均匀/ )/ 验证/ 机制/ 联盟/ 规模/ 验证/ 设备/ 状态机/ 存储/ 开销/ 状态机/ 更新/ 代价/ APPANAERO/ (/ N/ )/ O/ (/ N2/ )/ HidasavNAERO/ (/ pLj/ _/ max/ )/ O/ (/ p2Lj/ _/ max/ )/ (/ 2/ )/ 单位/ 数据/ 报文/ 验证/ 开销/ 当以/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ 涉及/ 标签/ 验证/ 和/ 处理/ 的/ 数据通信/ 场景/ 中/ 单位/ 数据/ 报文/ 最大/ 验证/ 总开销/ 为/ CostmaxH/ ./ un/ =/ CostmaxH/ ./ un/ ./ STA/ ·/ p/ +/ CostmaxH/ ./ un/ ./ CTA/ ·/ (/ 1/ -/ p/ )/ ./ 这里/ 以图/ 3/ 为例/ ,/ 分别/ 在/ 单一/ 信任/ 联盟/ 数据通信/ 和/ 跨/ 联盟/ 数据通信/ 2/ 种/ 场景/ 中/ 对/ 单位/ 数据/ 报文/ 验证/ 开销/ 进行/ 分析/ :/ (/ i/ )/ 单一/ 信任/ 联盟/ 数据通信/ 单位/ 数据/ 报文/ 验证/ 开销/ CostmaxH/ ./ un/ ./ STA/ =/ =/ 2/ (/ N/ -/ 1/ )/ ·/ tSM/ +/ 2SPRE/ ·/ tPRE/ +/ 2tOPE/ (/ 11/ )/ 因为/ pLj/ / N/ ,/ 珚/ SPRE/ / SPRE/ ,/ 可得式/ (/ 11/ )/ 必然/ 成立/ ./ 即/ 在/ 单一/ 信任/ 联盟/ 数据通信/ 场景/ 中/ ,/ 以/ Hidasav/ 方法/ 均匀/ 构建/ 层次化/ 信任/ 联盟/ ,/ 能够/ 减小/ 单位/ 数据/ 报文/ 验证/ 开销/ ./ 图/ 5/ 采用/ 均匀/ 方法/ 构建/ 的/ 层次化/ 信任/ 联盟/ 中/ 边界/ 路由/ 设备/ AER/ 维护/ 状态机/ 开销/ (/ ii/ )/ 跨/ 联盟/ 数据通信/ 单位/ 数据/ 报文/ 验证/ 开销/ CostmaxH/ ./ un/ ./ CTA/ =/ (/ 珚/ SAER/ +/ 4mL/ -/ 2/ )/ ·/ tSM/ +/ 同/ 6.1/ ./ 1/ 节中/ (/ 2/ )/ (/ ii/ )/ 中/ 分析/ 发现/ ,/ 层次化/ 后/ 在/ 跨/ 联盟/ 数据通信/ 场景/ 中/ ,/ 单位/ 数据/ 报文/ 最大/ 验证/ 开销/ 的/ 组成/ 中/ 有关/ 状态机/ 处理/ 的/ 开销/ 部分/ 有/ 较/ 大幅度/ 缩减/ ,/ 而/ 跨/ 联盟/ 过程/ 中/ 涉及/ 的/ 标签/ 替换/ 开销/ 以及/ 地址/ 前缀/ 和/ 所属/ 自治/ 域/ 对应/ 关系/ 查询/ 开销/ 均/ 有/ 小幅/ 增加/ ,/ 此时/ 的/ 单位/ 数据/ 报文/ 验证/ 开销/ 受/ L/ 、/ pLj/ 和/ p/ 数值/ 大小/ 因素/ 制约/ ./ 综合/ 评估/ ,/ 通过/ 合理/ 规划/ 即/ 信任/ 联盟/ 层次/ 较/ 小/ 以及/ 互访/ 数据通信/ 频度/ 较大/ 的/ 自治/ 域/ 聚类/ 整合/ 在/ 同一/ 子/ 联盟/ 内部/ ,/ 能够/ 实现/ p/ 较大/ ,/ L/ 、/ pLj/ 和/ (/ 1/ -/ p/ )/ 较/ 小/ ,/ 总/ 能够/ 使得/ CostmaxH/ ./ un/ / CostmaxF/ 成立/ ./ 6.2/ 实验/ 评估/ 6.2/ ./ 1/ 状态机/ 存储/ 开销/ 评估/ (/ 1/ )/ 实验/ 1/ ./ 根据/ Hidasav/ 方法/ 均匀/ 构建/ 信任/ 联盟/ 时/ 状态机/ 的/ 优化/ 验证/ ./ 图/ 5/ (/ X/ 轴为/ 线性/ 坐标/ ,/ Y/ 轴为/ 对数/ 坐标/ )/ 显示/ 了/ {/ L/ =/ 4/ ,/ m/ =/ 5/ }/ ,/ {/ L/ =/ 5/ ,/ m/ =/ 5/ }/ ,/ Page12/ 图/ 6/ 采用/ 均匀/ 方法/ 构建/ 的/ 层次化/ 信任/ 联盟/ 中/ 边界/ 路由/ 设备/ TAER/ 维护/ 状态机/ 开销/ {/ L/ =/ 5/ ,/ m/ =/ 4/ }/ ,/ {/ L/ =/ 4/ ,/ m/ =/ 4/ }/ 时/ 边界/ 路由器/ AER/ 状态机/ 的/ 数量级/ ,/ 图/ 6/ (/ X/ 轴为/ 线性/ 坐标/ ,/ Y/ 轴为/ 对数/ 坐标/ )/ 显示/ 了/ 当/ {/ L/ =/ 2/ ,/ m/ =/ 2/ 槡/ N/ }/ ,/ {/ L/ =/ 3/ ,/ m/ =/ 3/ 槡/ N/ }/ ,/ {/ L/ =/ 4/ ,/ m/ =/ 4/ 槡/ N/ }/ ,/ {/ L/ =/ 5/ ,/ m/ =/ 5/ 槡/ N/ }/ 时/ 边界/ 路由器/ TAER/ 状态机/ 的/ 数量级/ ./ 图/ 5/ 、/ 图/ 6/ 中/ 的/ 实验/ 结果表明/ ,/ 采用/ 文献/ [/ 12/ ]/ 的/ 方法/ 构建/ 扁平化/ 的/ 信任/ 联盟/ 时/ ,/ 边界/ 路由器/ 维护/ 的/ 状态/ 机数量/ 随着/ 联盟/ 规模/ 的/ 增大/ 呈/ 较/ 大幅度/ 的/ 快速增长/ ,/ 当/ 联盟/ 成员/ 数量/ 达到/ 5000/ 时/ ,/ 状态机/ 就/ 已/ 接近/ 104/ 数量级/ ,/ 而/ 采用/ Hidasav/ 方法/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ ,/ 边界/ 路由器/ 维护/ 的/ 状态/ 机数量/ 均/ 得到/ 了/ 有效/ 缩减/ ,/ 状态机/ 存储空间/ 复杂度/ 也/ 由/ O/ (/ N/ )/ 量级/ 降低/ 为/ O/ (/ N1/ // L/ )/ 量级/ ./ 可以/ 看出/ 对于/ AER/ ,/ 即使/ 在/ 最/ 大规模/ 的/ 信任/ 联盟/ 中/ ,/ 状态机/ 的/ 数量/ 平均/ 还/ 不到/ 103/ 数量级/ ,/ 与/ 文献/ [/ 12/ ]/ 中/ 的/ 105/ 对比/ ,/ 平均/ 优化/ 幅度/ 达到/ 93/ %/ ./ 对于/ TAER/ ,/ 因为/ 联盟/ 规模/ 的/ 扩展/ 而/ 带来/ 的/ 状态机/ 增长/ 明显/ 放缓/ ,/ 并且/ 随着/ L/ 值/ 的/ 增大/ 缩减/ 的/ 幅度/ 也/ 不断/ 增大/ ,/ 当/ L/ </ 5/ 时/ ,/ 状态/ 机数量/ 的/ 优化/ 幅度/ 平均/ 达到/ 了/ 103/ 数量级/ ,/ 当/ L/ =/ 5/ 时/ ,/ 状态/ 机数量/ 增长/ 函数/ 演变成/ 了/ 近似/ 对数函数/ 接近/ 102/ 数量级/ ,/ 状态机/ 维护/ 开销/ 平均/ 优化/ 幅度/ 达到/ 95/ %/ ./ (/ 2/ )/ 实验/ 2/ ./ 根据/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 信任/ 联盟/ 时/ 状态机/ 的/ 优化/ 验证/ ./ 目前/ ,/ 清华大学/ 主持/ 建设/ 的/ 真实/ IPv6/ 源地址/ 验证/ 体系结构/ 已/ 在/ CNGI/ -/ CER/ -/ NET2/ 网络/ 上/ 部署/ 、/ 运行/ 和/ 测试/ ,/ 并/ 有/ 多家/ 国内外/ 机构/ 、/ 运营商/ 和/ 设备/ 制造商/ 参与/ 实现/ ,/ 国内/ 主要/ 有/ CERNET2/ ①/ 、/ 中国电信/ 、/ 中国移动/ 等/ ,/ 国际/ 上/ 主要/ 有/ TEIN3/ ②/ 、/ G/ ?/ ANT2/ ③/ 、/ APAN/ -/ JP/ ④/ 、/ KREONet2/ ⑤/ ./ 上述/ 机构/ 都/ 拥有/ 多个/ 全局/ 独立/ 的/ 自治/ 域/ 编号/ ,/ 共同/ 为/ 本文/ 实验/ 2/ 提供/ 了/ 一个多/ 自治/ 域/ 的/ 实验/ 环境/ ./ 实验/ 在/ CNGI/ -/ CERNET2/ 网络/ 运行/ 管理中心/ 的/ Aladdin/ 网络流量/ 监测/ 系统/ 上/ 进行/ 了/ 数据/ 采集/ 和/ 分析/ ,/ 如图/ 7/ 数据/ 显示/ :/ 较之/ 访问/ NGI/ (/ 国际/ 下一代/ 互联网/ )/ 的/ 流量/ (/ 浅/ )/ ,/ CNGI/ 内部/ 用户/ 的/ 互访/ 流量/ 约/ 占/ 90/ %/ (/ 深/ )/ ;/ 较之/ 访问/ CNGI/ 的/ 流量/ (/ 浅/ )/ ,/ CERNET2/ 内部/ 用户/ 的/ 互访/ 流量/ 约/ 占/ 92/ %/ (/ 深/ )/ ./ 基于/ 层次化/ 的/ 验证/ 机制/ 和/ 标签/ 替换/ 规律/ ,/ 结合/ 上述/ 分析/ ,/ 认为/ 将/ CNGI/ 和/ CERNET2/ 构建/ 为/ 2/ 个/ ①/ ②/ ③/ ④/ ⑤/ Page13/ 不同/ 层级/ 的/ 信任/ 联盟/ 可/ 合理/ 实现/ 区分/ 层次/ 和/ 标签/ 替换/ 开销/ 的/ 权衡/ ,/ 并/ 构建/ 了/ 全球/ 下一代/ 互联网/ 信任/ 联图/ 7CNGI/ -/ 6IX/ 和/ CNGI/ -/ CERNET2/ 主干网/ 入/ // 出站/ 流量/ 统计/ (/ CNGI/ -/ 6IX/ :/ 09.10/ ~/ 10.09/ ,/ CNGI/ -/ CERNET2/ :/ 10.01/ ~/ 10.08/ )/ 图/ 8/ 全球/ 下一代/ 互联网/ 信任/ 联盟/ 的/ 体系结构/ 和/ 层次/ 关系/ 表/ 5/ 显示/ 了/ 根据/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ AER/ // TAER/ 维护/ 的/ 状态/ 机数量/ 均/ 得到/ 了/ 有效/ 缩减/ ,/ 与/ 文献/ [/ 12/ ]/ 的/ 方法/ 对比/ ,/ 状态机/ 表/ 5/ 扁平化/ 结构/ 和/ 层次化/ 结构/ 中/ 边界/ 路由/ 设备/ 状态机/ 存储/ 和/ 更新/ 开销/ 对比/ 机构名称/ ASCERNET225/ +/ 4484482t4890482t985887582t98/ 中国移动/ 45/ +/ 4484482t8880882t969878982t95/ 中国电信/ 55/ +/ 4484482t108761082t94118741182t93TEIN320/ +/ 4484482t3892382t994889482t98G/ ?/ ANT234/ +/ 4484482t6685662t987683762t97APAN/ -/ JP32/ +/ 4484482t6286622t987284722t97KREONet214/ +/ 4484482t2694262t993692362t99/ 注/ :/ 数据/ 来源于/ CNGI/ -/ CERNET2NOC/ ;/ t/ 表示/ 状态机/ 更新/ 单位/ 时间/ ./ 盟/ ,/ 如图/ 8/ 所示/ ./ 的/ 存储/ 开销/ 最大/ 缩减/ 了/ 94/ %/ ,/ 最小/ 也/ 缩减/ 了/ 74/ %/ ,/ 平均/ 缩减/ 幅度/ 达到/ 85/ %/ ;/ 状态机/ 的/ 更新/ 开销/ 也/ 缩减/ 了/ 95/ %/ 以上/ ,/ 优化/ 明显/ ,/ 达到/ 了/ 实验/ 预期/ 的/ 效果/ ./ 状态机/ 更新/ 开销/ Page146/ ./ 2.2/ 单位/ 数据/ 报文/ 验证/ 开销/ 评估/ (/ 1/ )/ 实验/ 1/ ./ 根据/ Hidasav/ 方法/ 均匀/ 构建/ 信任/ 联盟/ 时/ 单位/ 数据/ 报文/ 验证/ 开销/ 的/ 优化/ 验证/ ./ 图/ 9/ 显示/ 了/ {/ p/ =/ 0.4/ ,/ m/ =/ 12/ }/ ,/ {/ p/ =/ 0.5/ ,/ m/ =/ 16/ }/ ,/ {/ p/ =/ 0.6/ ,/ m/ =/ 20/ }/ ,/ {/ p/ =/ 0.7/ ,/ m/ =/ 24/ }/ ,/ {/ p/ =/ 0.8/ ,/ m/ =/ 28/ }/ ,/ {/ p/ =/ 0.9/ ,/ m/ =/ 32/ }/ 时/ 采用/ Hidasav/ 方法/ 均匀/ 构建/ 2/ 层级/ 信任/ 联盟/ 时/ 单位/ 数据/ 报文/ 的/ 验证/ 开销/ ./ 实验/ 结果表明/ ,/ 采用/ 文献/ [/ 12/ ]/ 方法/ 构建/ 扁平化/ 信任/ 联盟/ 时/ ,/ 单位/ 数据/ 报文/ 的/ 验证/ 开销/ 伴随/ 联盟/ 规模/ 的/ 扩大/ 增长/ 图/ 9/ 采用/ 均匀/ 方法/ 构建/ 的/ 层次化/ 信任/ 联盟/ 中/ 单位/ 数据/ 报文/ 验证/ 开销/ (/ 2/ )/ 实验/ 2/ ./ 根据/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 信任/ 联盟/ 时/ 单位/ 数据/ 报文/ 验证/ 开销/ 的/ 优化/ 验证/ ./ 基于/ 6.2/ ./ 1/ 节中/ 的/ 实验/ 2/ ,/ 选取/ CNGI/ 信任/ 联盟/ 中/ 的/ CERNET2/ 子/ 信任/ 联盟/ 进行/ 评估/ ,/ 其中/ 跨/ 联盟/ 数据通信/ 场景/ 通信/ 对端/ 为/ 中国电信/ 信任/ 联盟/ ./ 实验/ 在/ CNGI/ -/ CERNET2/ 网络/ 运行/ 管理中心/ 的/ Aladdin/ 网络流量/ 监测/ 系统/ 上/ 进行/ 了/ 数据/ 采集/ 和/ 分析/ ,/ 此时/ p/ =/ 0.92/ (/ 如图/ 7/ 所示/ )/ ,/ CNGI/ 信任/ 联盟/ 内/ 成员数/ N/ =/ 448/ +/ ,/ CERNET2/ 子/ 联盟/ P21/ =/ 25/ +/ ,/ 中国电信/ 表/ 6/ 扁平化/ 和/ 层次化/ 信任/ 联盟/ 中/ 单位/ 数据/ 报文/ 验证/ 开销/ 对照表/ 验证/ 机制/ APPAHidasavO/ [/ p/ ·/ (/ P21/ +/ 珚/ SPRE/ )/ +/ (/ 1/ -/ p/ )/ ·/ (/ 珚/ SPRE/ +/ SPRE/ )/ ]/ 53/ ·/ tSM/ +/ 174/ ·/ tPRE/ +/ (/ 2/ +/ 0.23/ )/ ·/ tOPE7/ 结论/ 及下/ 一步/ 工作/ 与/ 现有/ 的/ 基于/ 标签/ 的/ 域间/ 源地址/ 验证/ 方法/ 对比/ ,/ 较/ 快/ ,/ 平均/ 增幅/ 达到/ 联盟/ 规模/ 增幅/ 的/ 2/ 倍/ ;/ 当/ 采用/ Hidasav/ 方法/ 均匀/ 构建/ 层次化/ 的/ 信任/ 联盟/ 时/ ,/ 单位/ 数据/ 报文/ 验证/ 开销/ 的/ 增幅/ 明显/ 放缓/ ,/ 并且/ 随着/ p/ 和/ m/ 的/ 增大/ 而/ 逐渐/ 减小/ ,/ 较之/ 文献/ [/ 12/ ]/ 方法/ ,/ 当/ {/ p/ =/ 0.4/ ,/ m/ =/ 12/ }/ 时/ 单位/ 报文/ 验证/ 开销/ 缩减/ 较/ 小/ ,/ 为/ 35.5/ %/ ,/ 当/ {/ p/ =/ 0.9/ ,/ m/ =/ 32/ }/ 时/ 缩减/ 较大/ ,/ 达到/ 87.6/ %/ ,/ 分析/ 6/ 组/ 实验/ 数据/ ,/ 单位/ 数据/ 报文/ 验证/ 开销/ 平均/ 缩减/ 达到/ 62.1/ %/ ./ 子/ 联盟/ 内/ 成员数/ P23/ =/ 55/ +/ (/ 如表/ 5/ 所示/ )/ ,/ 属于/ CERNET2/ 子/ 联盟/ 内/ 的/ 前缀/ 为/ 珚/ SPRE/ =/ 52/ +/ ,/ 属于/ CNGI/ 信任/ 联盟/ 的/ 前缀/ SPRE/ =/ 437/ +./ 实验/ 数据/ 显示/ ,/ 与/ 文献/ [/ 12/ ]/ 的/ 方法/ 对比/ ,/ 在/ CNGI/ -/ CERNET2/ 网络/ 环境/ 下/ ,/ 采用/ Hidasav/ 方法/ 非/ 均匀/ 构建/ 信任/ 联盟/ 时/ ,/ 验证/ 过程/ 中/ :/ 由/ 分层/ 引入/ 的/ 标签/ 操作/ 开销/ 仅为/ 0.23/ ·/ tOPE/ ,/ 而/ 前缀/ 和/ 状态机/ 的/ 处理/ 操作/ 开销/ 则/ 分别/ 缩减/ 了/ 79/ %/ 和/ 81/ %/ ,/ 单位/ 数据/ 报文/ 验证/ 开销/ 平均/ 优化/ 幅度/ 为/ 74/ %/ ,/ 达到/ 了/ 实验/ 预期/ 效果/ ,/ 如表/ 6/ 所示/ ./ 248/ ·/ tSM/ +/ 874/ ·/ tPRE/ +/ 2/ ·/ tOPE/ 本/ 方法/ 立足/ 实际/ 网络/ 环境/ ,/ 可/ 灵活/ 构建/ 层次化/ 的/ 多级/ 信任/ 联盟/ 体系结构/ ,/ 通过/ 分层/ 和/ 引入/ “/ 中继/ 代理/ ”/ TAE/ ,/ 将/ 每/ 一层/ 级/ 联盟/ 和/ 外界/ 网络/ 隔离/ ,/ 无需/ 协议/ 扩展/ ,/ 不/ 依赖/ 域间/ 的/ 邻接/ 关系/ ,/ 在/ 确保/ 路由/ 协议/ 的/ 稳/ Page15/ 定性/ 和域/ 间/ 高速通信/ 的/ 情况/ 下/ ,/ 使得/ 下层/ 联盟/ 和/ 更/ 高层/ 联盟/ 内部/ 的/ 网络/ 环境/ 彼此/ 互不/ 可见/ 、/ 互无/ 影响/ ,/ 实验/ 证明/ 该/ 方法/ 通过/ 规划/ 联盟/ 层次/ 和/ 聚类/ 整合/ ,/ 有效/ 缩减/ 了/ 边界/ 路由/ 设备/ 的/ 状态机/ 存储/ 、/ 更新/ 开销/ 和/ 单位/ 数据/ 报文/ 验证/ 开销/ ./ 下/ 一步/ 将/ 在/ CNGI/ -/ CER/ -/ NET2/ 网络/ 上/ 进行/ 试验/ 部署/ 和/ 可靠性/ 测试/ ,/ 为/ 大规模/ 工程/ 部署/ 做/ 准备/ ./ 同时/ ,/ 在/ 本文/ 研究/ 的/ 基础/ 上/ ,/ 还/ 将/ 立足/ 不同/ 的/ 实际/ 网络/ 环境/ 进一步/ 开展/ 有关/ 构建/ 层次化/ 信任/ 联盟/ 体系结构/ 方法/ 的/ 研究/ ./ 

