Page1/ 基于/ 概率/ 攻击/ 图/ 的/ 内部/ 攻击/ 意图/ 推断/ 算法/ 研究/ 陈小军/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 方滨兴/ 1/ )/ ,/ 2/ )/ 谭/ 庆丰/ 2/ )/ ,/ 3/ )/ 张浩亮/ 2/ )/ 1/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 2/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息内容/ 安全/ 技术/ 国家/ 工程/ 实验室/ 北京/ 100093/ )/ 3/ )/ (/ 中国科学院/ 大学/ 信息科学/ 与/ 工程学院/ 北京/ 100049/ )/ 摘要/ 内部/ 攻击行为/ 具有/ 明显/ 的/ 多/ 步骤/ 性/ 和/ 伪装/ 性/ ./ 这些/ 特性/ 增加/ 内部/ 攻击/ 检测/ 的/ 难度/ ,/ 影响/ 检测/ 结果/ 的/ 准确性/ ./ 攻击/ 图/ 模型/ 能够/ 描述/ 攻击行为/ 的/ 多个/ 攻击/ 步骤/ 之间/ 的/ 因果关系/ ,/ 但/ 由于/ 单步/ 攻击/ 检测/ 结果/ 存在/ 的/ 不确定性/ ,/ 使得/ 攻击/ 图/ 模型/ 无法/ 准确/ 地/ 推断/ 攻击者/ 的/ 意图/ ./ 该文/ 在/ 攻击/ 图/ 模型/ 中/ 引入/ 转移/ 概率/ 表/ ,/ 刻画/ 单步/ 攻击/ 检测/ 结果/ 的/ 不确定性/ ,/ 即/ 从/ 观测/ 事件/ 推导/ 出/ 某步/ 攻击/ 发生/ 的/ 概率/ ,/ 提出/ 了/ 一个/ 面向/ 内部/ 攻击/ 意图/ 推断/ 的/ 概率/ 攻击/ 图/ 模型/ ./ 基于/ 该/ 模型/ ,/ 提出/ 了/ 一种/ 推断/ 内部/ 攻击/ 意图/ 的/ 算法/ 以及/ 针对/ 攻击/ 目标/ 的/ 最大/ 概率/ 攻击/ 路径/ 的/ 计算方法/ ./ 实验/ 结果表明/ 该文/ 的/ 工作/ 能够/ 有效/ 地/ 推断/ 攻击/ 意图/ 和/ 计算/ 攻击/ 路径/ ,/ 减少/ 不可/ 信/ 报警/ 数量/ ,/ 为/ 网络安全/ 管理员/ 提供/ 良好/ 的/ 可/ 配置/ 性/ ./ 关键词/ 内部/ 攻击/ ;/ 概率/ 攻击/ 图/ ;/ 行为/ 分析/ ;/ 意图/ 推断/ ;/ 网络/ 行为/ 1/ 引言/ 随着/ 计算机网络/ 的/ 发展/ ,/ 网络攻击/ 技术/ 也/ 在/ 快速/ 发展/ ,/ 各种/ 安全/ 攻击/ 事件/ 层出不穷/ ,/ 而/ 其中/ 来自/ 内部/ 恶意/ 人员/ 的/ 攻击/ 事件/ 所/ 占/ 比例/ 越来越重/ ./ 内部/ 恶意/ 人员/ 是/ 指/ 具有/ 以下/ 行为/ 的/ 恶意/ 的/ 前/ 或者/ 现/ 职员/ 、/ 承包商/ 和/ 商业伙伴/ :/ (/ 1/ )/ 被/ 授权/ 访问/ 组织/ 的/ 网络/ 、/ 系统/ 或/ 数据/ ;/ (/ 2/ )/ 故意/ 超越/ 或/ 滥用/ 其/ 访问/ 权限/ ;/ (/ 3/ )/ 行为/ 损害/ 该/ 组织/ 的/ 信息/ 或者/ 信息系统/ 的/ 机密性/ 、/ 完整性/ 和/ 可用性/ [/ 1/ ]/ ./ 典型/ 的/ 内部/ 攻击/ 包括/ 知识产权/ 窃取/ 、/ 欺诈/ 和/ IT/ 破坏/ 等/ 行为/ ./ 内部/ 攻击/ 能/ 给/ 企业/ 甚至/ 国家/ 带来/ 巨大/ 的/ 危害/ ,/ 最为/ 著名/ 的/ 例子/ 是/ 2010/ 年/ ,/ 美国士兵/ 曼宁/ 非法/ 下载/ 大量/ 机密/ 文档/ 和/ 视频/ ,/ 刻录/ 在/ CD/ 上/ 并/ 带/ 出/ 军事基地/ ,/ 随后/ ,/ 逾/ 9/ 万份/ 阿富汗/ 战争/ 文件/ 被/ 维基/ 解密/ 组织/ 暴露/ [/ 2/ ]/ ./ 该/ 事件/ 在/ 全球/ 政界/ 和/ 安全/ 界/ 引发/ 了/ 强烈/ “/ 地震/ ”/ ,/ 内部/ 攻击/ 威胁/ 也/ 受到/ 各界/ 关注/ ,/ 防护/ 内部/ 攻击/ 迫在眉睫/ ./ 如何/ 尽早/ 地/ 发现/ 内部/ 攻击/ 并/ 推断/ 其/ 攻击/ 意图/ 是/ 内部/ 攻击/ 检测/ 研究/ 面临/ 的/ 一个/ 难题/ ./ 该/ 问题/ 主要/ 面临/ 着/ 两个/ 挑战/ :/ (/ 1/ )/ 内部/ 攻击行为/ 具有/ 较强/ 的/ 伪装/ 性/ ,/ 这/ 导致/ 检测/ 结果/ 具有/ 一定/ 的/ 不确定性/ ;/ (/ 2/ )/ 内部/ 恶意/ 人员/ 可以/ 有/ 充裕/ 的/ 时间/ 安排/ 攻击/ 行动/ ,/ 其/ 攻击行为/ 具有/ 多/ 步骤/ 性/ ./ 内部/ 攻击/ 的/ 伪装/ 性/ 体现/ 在/ 两个/ 方面/ ./ 恶意/ 内部人员/ 可以/ 滥用/ 自己/ 的/ 合法权利/ ,/ 在/ 正常/ 行为/ 遮掩/ 下/ 从事/ 非法活动/ ,/ 称为/ 行为/ 伪装/ ;/ 也/ 可以/ 通过/ 职便/ 或者/ 社会/ 工程学/ 的/ 手段/ 获取/ 他人/ 的/ 身份/ 认证/ 信息/ ,/ 冒充/ 合法/ 用户/ 进入/ 他人/ 电脑/ 或/ 数据中心/ 窃取/ 机密/ 数据/ ,/ 称为/ 身份/ 伪装/ ./ 在/ 具有/ 行为/ 伪装/ 和/ 身份/ 伪装/ 的/ 内部/ 攻击者/ 面前/ ,/ 传统/ 的/ 防火墙/ 和/ 访问控制/ 等/ 手段/ 基本/ 会/ 失效/ ./ 因此/ 内部/ 攻击行为/ 检测/ 方法/ 更多地/ 采用/ 异常/ 检测/ 的/ 算法/ 来/ 发现/ 用户/ 偏离/ 正常/ 行为/ 模式/ 的/ 行为/ ,/ 从而/ 确定/ 攻击/ 的/ 存在/ ,/ 比如/ Schonlau/ 等/ 人/ [/ 3/ ]/ 通过/ 检测/ 用户/ 的/ 命令/ 执行/ 序列/ 来/ 发现异常/ 行为/ ,/ Salem/ 等/ 人/ [/ 4/ ]/ 对/ 用户/ 的/ 文件/ 搜索/ 访问/ 行为/ 建立/ 一类/ 支持/ 向量/ 机/ 模型/ 来/ 检测/ 身份/ 冒用/ 者/ (/ Masquerader/ )/ ,/ Zheng/ 等/ 人/ [/ 5/ ]/ 通过/ 鼠标/ 移动/ 等/ 的/ 生物/ 行为/ 特征/ 来/ 确定/ 当前/ 用户/ 是否/ 为/ 合法/ 用户/ ./ 这些/ 方法/ 能/ 检测/ 一些/ 异常/ 行为/ ,/ 但/ 也/ 存在/ 较/ 高/ 的/ 假/ 阳性/ FalsePositive/ (/ FP/ )/ 和/ 假/ 阴性/ FalseNegative/ (/ FN/ )/ ,/ 如/ Schonlau/ 等/ 人/ [/ 3/ ]/ 用/ 贝叶斯/ 一步/ 马尔科夫/ 模型/ 检测/ 执行命令/ 序列/ ,/ 其/ FP/ 为/ 6.7/ %/ ,/ FN/ 为/ 21.3/ %/ ./ 较/ 高/ 的/ 假/ 阳性/ 会/ 浪费/ 网络安全/ 管理员/ 大量/ 的/ 人力/ 分析/ 成本/ ,/ 而/ 错误/ 的/ 指控/ 内部人员/ 会/ 带来/ 破坏性/ 的/ 影响/ ./ 内部/ 攻击/ 的/ 多/ 步骤/ 性/ 体现/ 在/ 内部/ 攻击者/ 有/ 足够/ 的/ 时间/ 观察/ 、/ 计划/ 和/ 实施/ 攻击/ 方案/ ,/ 逐步/ 攻击/ 系统/ 的/ 弱点/ ,/ 达到/ 攻击/ 目标/ ./ 这种/ 多/ 步骤/ 性/ 加重/ 了/ 内部/ 攻击/ 检测/ 方法/ 的/ 复杂度/ ./ 攻击/ 树/ // 攻击/ 图/ 模型/ 可以/ 模拟/ 不同/ 节点/ 之间/ 的/ 因果/ 依赖/ 关系/ ,/ 常/ 被/ 人/ 用来/ 研究/ 复杂/ 的/ 多步/ 攻击行为/ ./ 攻击/ 图/ 通过/ 对/ 攻击行为/ 和/ 目标/ 网络/ 进行/ 建模/ ,/ 刻画/ 了/ 攻击者/ 有步骤/ 地/ 实施/ 攻击/ ,/ 一步步/ 提升/ 权限/ ,/ 获取/ 更/ 多/ 的/ 资源/ ,/ 并/ 达到/ 攻击/ 目标/ 的/ 过程/ ./ 但/ 现有/ 的/ 攻击/ 图/ 大多/ 通过/ 分析/ 漏洞/ 之间/ 的/ 关系/ 构建/ ,/ 攻击/ 事件/ 一旦/ 被/ 观测/ 到/ ,/ 则/ 对应/ 的/ 攻击/ 被/ 认为/ 已经/ 发生/ ,/ 在/ 单步/ 攻击/ 检测/ 过程/ 中/ 可能/ 引入/ 的/ 不确定性/ 被/ 忽略/ ./ 图/ 1/ 中/ 展示/ 了/ 两种/ 内部/ 攻击/ 过程/ 的/ 实例/ ./ 攻击/ 场景/ A/ 描述/ 了/ 内部/ 漏洞/ 利用/ 攻击/ 的/ 过程/ 图/ ,/ 恶意/ 用户/ MaliciousUser/ (/ M/ )/ 利用/ Web/ 服务器/ 上/ 的/ 漏洞/ CVE/ -/ 2002/ -/ 0640/ (/ URL/ 缓冲区/ 溢出/ )/ 获取/ Web/ 服务器/ 的/ 管理员/ 权限/ ,/ 进而/ 通过/ 网络/ 文件系统/ 接口/ 在/ 文件/ 服务器/ 上/ 写入/ 木马程序/ ,/ 最后/ 该/ 木马/ 被/ 管理员/ Admin/ (/ A/ )/ 不/ 小心/ 执行/ 从而/ 让/ 恶意/ 用户/ M/ 可以/ 窃取/ 到/ 管理员/ A/ 计算机/ 内/ 的/ 机密/ 数据/ ./ 该/ 场景/ 中/ 的/ 大/ Page3/ 部分/ 动作/ 都/ 可以/ 被/ 安全监控/ 系统/ 检测/ 到/ ,/ M/ 的/ 攻击行为/ 明显/ 具备/ 多/ 步/ 攻击/ 的/ 特性/ ,/ 他/ 通过/ 5/ 个/ 攻击/ 步骤/ 完成/ 对/ 机密信息/ 的/ 窃取/ 企图/ ,/ 每/ 一步/ 攻击/ 都/ 具有/ 明确/ 目的/ ,/ 前后/ 两次/ 攻击/ 动作/ 是/ 一种/ 依赖/ 关系/ ./ 图/ 1/ 的/ 攻击/ 场景/ B/ 描述/ 了/ 一个/ 恶意/ 的/ 内部人员/ M/ 利用/ 职便/ ,/ 通过/ “/ 猜/ 密码/ ”/ 的/ 方式/ 进入/ 了/ 管理员/ A/ 的/ 个人电脑/ ,/ 并/ 安装/ 了/ 一种/ 具备/ KeyLogger/ 功能/ 的/ 恶意软件/ ./ A/ 负责管理/ 企业/ 中/ 的/ 文件/ 服务器/ (/ FileServer/ )/ 和/ 其它/ 资源/ ./ 由此/ ,/ M/ 获得/ 了/ A/ 在/ 文件/ 服务器/ 上/ 的/ 用户/ 权限/ ,/ M/ 通过/ A/ 的/ 权限/ 登入/ 了/ 文件/ 服务器/ ,/ 并/ 下载/ 机密/ 文档/ ./ 该/ 场景/ 下/ ,/ 除了/ 恶意软件/ KeyLogger/ 行为/ 可能/ 会/ 被/ 杀毒软件/ 检测/ 到/ 外/ ,/ 大部分/ 的/ 攻击行为/ 都/ 是/ 在/ 合法/ 权限/ 下/ 进行/ 的/ 常规/ 操作/ ,/ 难以/ 被/ 普通/ 安全/ 防护系统/ 检测/ 到/ ./ M/ 也/ 可能/ 通过/ 其它/ 手段/ 替代/ KeyLogger/ 获取/ 文件/ 服务器/ 的/ 密码/ ,/ 比如/ 拷贝/ 走/ A/ 的/ 密码/ 维护/ 文件/ ./ 攻击/ 场景/ B/ 中/ ,/ M/ 的/ 每/ 一步/ 攻击行为/ 都/ 具有/ 伪装/ 性/ ,/ 只能/ 利用/ 异常/ 检测/ 算法/ 检测/ 每/ 一个/ 步骤/ 的/ 行为/ 异常/ ./ 不少/ 异常/ 检测/ 算法/ 可以/ 为/ 每/ 一个/ 检测/ 结果/ 给出/ 分值/ ,/ 指示/ 算法/ 对/ 结果/ 的/ 置信/ 程度/ ,/ 我们/ 称为/ 检测/ 结果/ (/ 观测/ 事件/ )/ 的/ 置信度/ ./ 置信度/ 反应/ 从/ 一个/ 观测/ 事件/ 推导/ 出/ 某步/ 攻击/ 真实/ 发生/ 的/ 概率/ ./ 传统/ 的/ 攻击/ 图/ 模型/ 将/ 检测/ 结果/ 作为/ 确定性/ 事件处理/ ,/ 无法/ 在/ 检测/ 结果/ 存在/ 不确定性/ 的/ 情况/ 下/ 有效/ 地/ 推断/ 攻击者/ 的/ 真实/ 意图/ ./ 针对/ 该/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 面向/ 内部/ 攻击/ 意图/ 推断/ 的/ 概率/ 攻击/ 图/ 模型/ ,/ 该/ 模型/ 利用/ 概率/ 转移/ 表/ 刻画/ 了/ 单步/ 攻击/ 检测/ 结果/ 的/ 不确定性/ ./ 在/ 此基础/ 上/ ,/ 提出/ 了/ 一种/ 能/ 根据/ 安全监控/ 系统/ 的/ 报警/ 日志/ 序列/ 和/ 相关/ 的/ 置信度/ ,/ 推断/ 当前/ 网络/ 中/ 内部/ 攻击/ 潜在/ 意图/ 的/ 方法/ ,/ 并/ 给出/ 针对/ 攻击/ 目标/ 计算/ 最大/ 概率/ 攻击/ 路径/ 的/ 方法/ ./ 本文/ 的/ 主要/ 贡献/ 有/ ;/ (/ 1/ )/ 提出/ 面向/ 实时/ 内部/ 攻击/ 意图/ 推断/ 的/ 概率/ 攻击/ 图/ 模型/ ,/ 并/ 在/ 攻击/ 图中/ 刻画/ 了/ 单步/ 攻击/ 检测/ 结果/ 的/ 不确定性/ ,/ 给出/ 其/ 概率/ 推导/ 方法/ ;/ (/ 2/ )/ 在/ 已知/ 概率/ 攻击/ 图/ 和/ 观察/ 事件/ 序列/ 的/ 前提/ 下/ ,/ 给出/ 推断/ 当前/ 攻击/ 潜在/ 意图/ 的/ 算法/ 以及/ 针对/ 攻击/ 目标/ 的/ 最大/ 概率/ 攻击/ 路径/ ./ (/ 3/ )/ 在/ 实际/ 的/ 攻击/ 场景/ 下/ 对/ 本文/ 的/ 概率/ 攻击/ 图/ 模型/ 和/ 攻击/ 意图/ 推断/ 方法/ 进行/ 了/ 验证/ ,/ 实验/ 结果表明/ 本文/ 的/ 工作/ 能够/ 有效/ 地/ 推断/ 攻击/ 意图/ 和/ 计算/ 攻击/ 路径/ ,/ 减少/ 不可/ 信/ 报警/ 数量/ ,/ 为/ 网络安全/ 管理员/ 提供/ 良好/ 的/ 可/ 配置/ 性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节/ 给出/ 概率/ 攻击/ 图/ 模型/ 的/ 定义/ 并/ 依次/ 介绍/ 概率/ 攻击/ 图/ 的/ 构建/ 方法/ 、/ 攻击/ 意图/ 推断/ 和/ 最大/ 概率/ 攻击/ 路径/ 计算/ 算法/ ;/ 第/ 4/ 节/ 通过/ 实验/ 展示/ 概率/ 攻击/ 图/ 模型/ 的/ 计算/ 过程/ ,/ 证明/ 其/ 在/ 减少/ 不可/ 信/ 报警/ 数量/ 和/ 可/ 配置/ 性/ 方面/ 的/ 优势/ ;/ 最后/ 总结/ 本文/ 的/ 工作/ 并/ 对/ 未来/ 的/ 研究/ 进行/ 展望/ ./ 2/ 相关/ 工作/ 在/ 内部/ 攻击行为/ 检测/ 方面/ ,/ Brackney/ 等/ 人/ [/ 6/ ]/ 首先/ 比较/ 全面/ 地/ 描述/ 了/ 内部/ 攻击/ 在/ IntelligenceCom/ -/ munity/ (/ IC/ )/ 系统/ 里/ 的/ 危害/ 和/ 实施/ 过程/ ,/ 并/ 由此/ 提出/ 了/ 一个/ 全面/ 的/ 检测/ 框架/ ./ 该/ 框架/ 包含/ 了/ 对/ 个人/ 角色/ 、/ 用户/ 动作/ 、/ 系统/ 事件/ 、/ 监视器/ 、/ 融合/ 分析/ 和/ 安全策略/ 等/ 6/ 个/ 方面/ 的/ 检测/ 与/ 分析/ ./ 在/ Brackney/ 框架/ 的/ 基础/ 上/ ,/ Zheng/ 等/ 人/ [/ 5/ ]/ 构建/ 了/ 基于/ 用户/ 的/ 鼠标/ 移动/ 等/ 生物/ 特性/ 身份/ 冒用/ 者/ 检测/ 框架/ ,/ 取得/ 了/ 不错/ 的/ 效果/ ./ Maloof/ 等/ 人/ [/ 7/ ]/ 根据/ 用户/ 的/ 文件/ 访问/ 行为/ 设计/ 了/ 一个/ 系统/ Elicit/ ,/ 来/ 检测/ 那些/ 违背/ “/ 需要/ 知悉/ ”/ (/ need/ -/ to/ -/ know/ )/ 原则/ 的/ 用户/ 行为/ ./ 以上/ 工作/ 致力于/ 检测/ 内部人员/ 单一/ 的/ 异常/ 行为/ ,/ 这些/ 异常/ 检测/ 能/ 揭示/ 某些/ 简单/ 的/ 内部/ 攻击/ 意图/ ,/ 但/ 对/ 精明/ 熟练/ 的/ 内部/ 攻击者/ ,/ 其/ 行为/ 具有/ 明显/ 的/ 多步性/ 和/ 计划性/ ,/ 这/ 类/ 方法/ 就/ 具有/ 一定/ 的/ 局限性/ ./ 但/ 上述/ 工作/ 都/ 可以/ 作为/ 本文/ 的/ 基础/ ,/ 提供/ 对/ 具体/ 某/ 一步/ 攻击行为/ 的/ 观测/ 事件/ 和/ 相关/ 的/ 不确定性/ 估计/ ,/ 比如/ Zheng/ 等/ 人/ 的/ 工作/ 可以/ 用来/ 检测/ 身份/ 冒用/ 攻击/ ,/ Maloof/ 等/ 人/ 的/ 工作/ 可以/ 检测/ 异常/ 下载/ 攻击/ ./ 攻击/ 图/ 已/ 被/ 人们/ 广泛应用/ 在/ 网络安全/ 状态/ 和/ 风险/ 评估/ [/ 8/ ]/ 、/ 分析/ 系统安全/ 的/ 最优/ 弥补/ 集/ [/ 9/ ]/ 等/ 方面/ ./ 在/ 概率/ 攻击/ 图/ 研究成果/ 中/ 与/ 本文/ 相关/ 的/ 主要/ 有/ 两/ 方面/ 的/ 研究/ ./ 首先/ ,/ 在/ 概率/ 攻击/ 图/ 结构/ 与/ 不确定性/ 的/ 研究/ 方面/ ,/ Wang/ 等/ 人/ [/ 10/ ]/ 根据/ 漏洞/ 攻击/ 的/ 难度/ 和/ 配置/ 网络/ 的/ 代价/ ,/ 建立/ 了/ 攻击/ 图/ 的/ 概率/ 属性/ ,/ 首次/ 正式/ 地/ 提出/ 了/ 评估/ 网络/ 风险/ 的/ 一种/ 概率/ 安全/ 属性/ ,/ 并/ 在/ 此基础/ 上/ 提出/ 了/ 用/ 累积/ 概率/ 的/ 方法/ 计算/ 整个/ 网络/ 的/ 安全/ 属性/ ./ 该/ 方法/ 讨论/ 概率/ 属性/ 的/ 几种/ 计算方法/ ,/ 但/ 并未/ 引入/ 观测/ 事件/ 的/ 置信度/ 进行/ 概率/ 计算/ ./ Xie/ 等/ 人/ [/ 11/ ]/ 第一次/ 深入/ 地/ 探讨/ 了/ 在/ 攻击/ 图中/ 3/ 种/ 不/ 确性/ 的/ 来源/ ,/ 分别/ 为/ 攻击/ 图/ 结构/ 的/ 不确定性/ 、/ 攻击/ 动作/ 发生/ 的/ 不确定性/ 以及/ 触发/ 报警/ 的/ 不确定性/ ./ 其/ 触发/ 报警/ 的/ 不确定性/ 与/ 本文/ 所/ 提单/ 步/ 攻击/ 检测/ 结果/ 的/ 不确定性/ 有/ 一定/ 类似/ ,/ 但/ 他们/ 的/ 模型/ 中仅/ 对/ 一些/ 重要/ 攻击/ 节点/ 引入/ 前提条件/ ,/ 即/ 攻击/ 动作/ 节点/ AttackActionPage4Node/ (/ AAN/ )/ ,/ 计算/ 中/ 只有/ 当/ 攻击/ 动作/ 节点/ 为/ 真时/ 才/ 对/ 攻击/ 节点/ 进行/ 概率/ 推导/ ,/ 因此/ 他们/ 也/ 未/ 完全/ 将/ 单步/ 攻击/ 检测/ 结果/ 的/ 不确定性/ 纳入/ 到/ 概率/ 推导/ 计算/ 过程/ 中来/ ./ 其次/ ,/ 在/ 概率/ 攻击/ 图/ 的/ 推导/ 计算/ 方面/ ,/ 张少俊/ 等/ 人/ [/ 12/ ]/ 提出/ 了/ 一个/ 在/ 满足/ 观测/ 事件/ 偏序/ 条件/ 的/ 情况/ 下/ ,/ 利用/ 贝叶斯/ 推理/ 计算/ 攻击/ 图/ 节点/ 的/ 置信度/ 方法/ ./ 他们/ 的/ 模型/ 中/ 攻击/ 节点/ 与/ 观测/ 事件/ 的/ 条件/ 关系/ 与/ 本文/ 所提/ 的/ 正好/ 相反/ ,/ 该/ 模型/ 根据/ 当前/ 攻击/ 节点/ 的/ 概率/ ,/ 使用/ 似然/ 抽样/ 算法/ 推导/ 观测/ 事件/ 的/ 置信度/ ,/ 而/ 我们/ 的/ 工作/ 则/ 利用/ 安全监控/ 系统/ 给出/ 的/ 观测/ 事件/ 的/ 置信度/ 来/ 计算/ 攻击/ 意图/ 的/ 概率/ ./ 在/ Wang/ 等/ 人/ [/ 10/ ]/ 工作/ 的/ 基础/ 上/ ,/ 叶云/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 一种/ 攻击/ 图/ 简化/ 算法/ 来/ 解决/ 存在/ 环时/ 攻击/ 图/ 推导/ 存在/ 的/ 性能/ 瓶颈/ 问题/ ,/ 基于/ 简化/ 的/ 攻击/ 图/ ,/ 给出/ 计算/ 最大/ 可/ 达/ 概率/ 的/ 方法/ ./ 最大/ 可/ 达/ 概率/ 的/ 概念/ 与/ 本文/ 的/ 累积/ 概率/ 类似/ ,/ 本文/ 扩展/ 其/ 用法/ ,/ 不仅仅/ 计算/ 目标/ 攻击/ 节点/ 的/ 最大/ 可/ 达/ 概率/ ,/ 而且/ 计算/ 其/ 最大/ 概率/ 的/ 攻击/ 路径/ ./ 另外/ 与/ Wang/ 等/ 人/ 的/ 工作/ 一样/ ,/ 该/ 工作/ 也/ 未/ 引入/ 观测/ 事件/ 的/ 置信度/ 进行/ 概率/ 计算/ ./ 综上所述/ ,/ 针对/ 内部/ 攻击/ 的/ 研究/ 能/ 检测/ 内部/ 攻击/ 人员/ 某一方面/ 的/ 行为/ 异常/ ,/ 但/ 该类/ 方法/ 一方面/ 其/ 结果/ 具有/ 较大/ 的/ 不确定性/ ,/ 另一方面/ 无法/ 应对/ 有/ 计划/ 分/ 步骤/ 的/ 复杂/ 内部/ 攻击/ ./ 攻击/ 图/ 的/ 研究/ 工作/ 较/ 好/ 地/ 刻画/ 了/ 多步/ 攻击/ ,/ 但/ 大都/ 关注/ 在/ 预先/ 固定/ 的/ 网络/ 配置/ 环境/ 下/ 的/ 安全/ 风险/ 评估/ 计算/ ,/ 没有/ 利用/ 当前/ 攻击/ 动作/ 检测/ 结果/ 的/ 不确定性/ 进行/ 概率/ 计算/ ,/ 在/ 进行/ 内部/ 攻击/ 意图/ 的/ 推断/ 计算/ 方面/ 有/ 一定/ 的/ 限制/ ./ 3/ 概率/ 攻击/ 图及/ 攻击/ 意图/ 推断/ 3.1/ 概率/ 攻击/ 图/ 的/ 定义/ 内部/ 攻击/ 是/ 一种/ 很/ 复杂/ 的/ 多/ 步骤/ 行为/ ,/ 包含/ 着/ 一些/ 完成/ 最终/ 攻击/ 意图/ 所/ 必须/ 达到/ 的/ 子/ 攻击/ 目标/ 和/ 一组/ 紧密/ 关联/ 的/ 基本/ 攻击/ 动作/ ./ 基本/ 攻击/ 动作/ 的/ 实施/ 帮助/ 攻击者/ 达到/ 子/ 攻击/ 意图/ ,/ 攻击者/ 相应/ 地/ 获得/ 更/ 多/ 的/ 资源/ 和/ 权限/ ,/ 以/ 实施/ 下/ 一次/ 攻击/ ./ 攻击/ 图/ 可以/ 静态/ 地/ 评估/ 一个/ 网络系统/ 的/ 安全/ 状况/ ,/ 但是/ 很难/ 动态/ 地/ 攻击/ 意图/ 推断/ ,/ 即/ 根据/ 当前/ 安全/ 系统/ 的/ 运行/ 状态/ ,/ 评估/ 可能/ 存在/ 的/ 攻击/ ./ 实时/ 的/ 攻击/ 意图/ 推断/ 主要/ 面临/ 着/ 几个/ 不确定性/ 的/ 因素/ :/ (/ 1/ )/ 某个/ 状态/ 下/ 是否/ 一定/ 会/ 发生/ 某种/ 攻击/ ;/ (/ 2/ )/ 攻击/ 是否/ 一定/ 会/ 成功/ ;/ (/ 3/ )/ 安全监控/ 系统/ 的/ 异常/ 告警/ 多/ 大程度/ 上/ 预示/ 着/ 攻击/ 正在/ 发生/ ./ 为了/ 建立/ 适用/ 于/ 充满/ 不确定性/ 的/ 内部/ 攻击/ 意图/ 推断/ 的/ 模型/ ,/ 本文/ 在/ Ou/ 等/ 人/ [/ 14/ ]/ 的/ 攻击/ 图/ 模式/ 上/ 进行/ 修改/ ,/ 加入/ 了/ 3/ 类/ 条件/ 概率/ 转移/ 表/ ,/ 以此/ 来/ 表示/ 上述/ 讨论/ 的/ 3/ 类/ 不确定性/ ./ 概率/ 攻击/ 图/ 的/ 形式化/ 定义/ 如下/ ./ 定义/ 1/ ./ 概率/ 攻击/ 图/ 定义/ 为/ 一个/ 有/ 向/ 无/ 环图/ PAG/ =/ (/ N/ ,/ E/ ,/ Δ/ )/ ,/ 其中/ :/ (/ 1/ )/ N/ 代表/ 节点/ 集合/ ,/ N/ =/ S/ ∪/ A/ ∪/ O/ ./ S/ 是/ 状态/ 节点/ 集合/ ,/ 每/ 一个/ 状态/ 节点/ 代表/ 攻击者/ 每步/ 攻击/ 后/ 所处/ 的/ 状态/ ,/ 包括/ 取得/ 的/ 攻击/ 资源/ 或/ 权限/ 能力/ ./ s0/ 是/ 初始状态/ 节点/ ,/ 表示/ 攻击者/ 最初/ 所处/ 的/ 攻击/ 状态/ ./ G/ 表示/ 攻击/ 目标/ 节点/ 集合/ ,/ 满足/ 约束/ :/ G/ / S/ ./ A/ 是/ 攻击/ 动作/ 节点/ 集合/ ,/ ai/ 表示/ 某个/ 具体/ 的/ 攻击/ 动作/ 发生/ ./ 而/ O/ 为/ 观察/ 事件/ 节点/ 集合/ ,/ 假定/ 每次/ 攻击/ ai/ 发生/ ,/ 安全监控/ 系统/ 能以/ 一定/ 的/ 概率/ 监控/ 到/ 某些/ 事件/ oi/ ./ 所有/ 节点/ 的/ 取值/ 为/ (/ 0/ ,/ 100/ ]/ ,/ 分别/ 表示/ “/ 攻击/ 状态/ 达到/ (/ S/ )/ ”/ ,/ “/ 攻击/ 意图/ 成功/ (/ G/ )/ ”/ ,/ “/ 攻击/ 动作/ 发生/ (/ A/ )/ ”/ 以及/ “/ 攻击/ 被/ 检测/ 系统/ 观察/ 到/ (/ O/ )/ ”/ 的/ 置信度/ ./ (/ 2/ )/ E/ 是/ 表示/ 各类/ 节点/ 之间/ 因果关系/ 的/ 有/ 向/ 边/ 集合/ ./ 细分/ E/ 可/ 表示/ 为/ E/ =/ Es/ ∪/ Ea/ ∪/ Eo/ ./ 其中/ Es/ / S/ ×/ A/ ,/ 表示/ 攻击者/ 拥有/ 某些/ 资源/ 后/ 才能/ 实施/ 某些/ 攻击/ 动作/ ./ Ea/ / A/ ×/ S/ ,/ 表示/ 一次/ 攻击/ 成功/ 后/ 能够/ 获取/ 更/ 多/ 的/ 资源/ ,/ 进入/ 新/ 的/ 攻击/ 状态/ ./ Eo/ / O/ ×/ A/ ,/ 表示/ 根据/ 安全监控/ 系统/ 观测/ 到/ 的/ 事件/ 可以/ 确定/ 或者/ 推断/ 某个/ 攻击/ 已经/ 发生/ ./ (/ 3/ )/ Δ/ 为/ 条件/ 概率/ 表/ CPT/ (/ ConditionalProba/ -/ bilityTable/ )/ ,/ 依附于/ 每/ 一条/ 有/ 向/ 边上/ ./ 根据/ 有/ 向/ 边/ 的/ 分类/ ,/ Δ/ =/ (/ Δ/ s/ ,/ Δ/ a/ ,/ Δ/ o/ )/ ,/ Δ/ s/ 是/ 依附于/ 有/ 向/ 边集/ Es/ 上/ 的/ 条件/ 概率/ 表/ ,/ Δ/ sij/ 表示/ 在/ 攻击/ 状态/ si/ 下/ 可能/ 发生/ 后续/ 攻击/ aj/ 的/ 概率/ ./ Δ/ a/ 是/ 依附于/ 有/ 向/ 边集/ Ea/ 的/ 条件/ 概率/ 表/ ,/ Δ/ aij/ 表示/ 攻击/ 动作/ ai/ 成功/ 并/ 进入/ 下/ 一/ 状态/ sj/ 的/ 概率/ ./ Δ/ o/ 是/ 依附于/ 有/ 向/ 边集/ Eo/ 的/ 条件/ 概率/ 表/ ,/ Δ/ oi/ 表示/ 观测/ 事件/ 的/ 置信/ 概率/ ,/ 即察到/ oi/ 事件/ 时能/ 证明/ 攻击/ ai/ 发生/ 的/ 概率/ ,/ 即/ P/ (/ ai/ |/ oi/ )/ ./ 根据/ 以上/ 定义/ ,/ 图/ 2/ 展示/ 了/ 攻击/ 图/ 的/ 几种/ 可能/ 的/ 情况/ ./ 其中/ 攻击/ 状态/ 节点/ 用不带/ 线条/ 的/ 圆圈/ 表示/ ,/ 攻击/ 动作/ 节点/ 用带/ 空心/ 的/ 黑色/ 圆圈/ 表示/ ,/ 观察/ 事件/ 节点/ 用/ 黑色/ 实心/ 节点/ 表示/ ./ 每/ 一条/ 便/ 都/ 依附/ 着/ 一个/ 概率/ 属性/ ,/ 用/ Δ/ 表示/ ./ 定义/ 2/ ./ 指向/ 同一/ 节点/ 的/ 边/ 之间/ 存在/ “/ 与/ ”/ 和/ “/ 或/ ”/ 的/ 关系/ ,/ 具体/ 定义/ 如下/ :/ (/ 1/ )/ 依附于/ 状态/ 节点/ 的/ 边/ 都/ 是/ “/ 或/ ”/ 关系/ ./ (/ 2/ )/ 依附于/ 攻击/ 动作/ 节点/ 的/ 边/ 有/ 两种/ 情况/ ,/ 如果/ ei/ ,/ ej/ ∈/ Es/ ,/ 即/ 从/ 攻击/ 状态/ 节点/ 到/ 攻击/ 动作/ 节点/ ,/ Page5/ 则/ ei/ ,/ ej/ 之间/ 是/ “/ 与/ ”/ 关系/ ,/ 表示/ 要/ 发动/ 某次/ 攻击/ 必须/ 同时/ 满足/ 所有/ 前提/ 状态/ ./ 如果/ 某条/ 边/ ei/ ∈/ Eo/ ,/ 则/ 该/ 有/ 向/ 边/ 与/ 其它/ 依附于/ 该/ 攻击/ 节点/ 的/ 所有/ 其它/ 边/ 是/ “/ 或/ ”/ 的/ 关系/ ./ 如图/ 3/ 中/ 的/ 状态/ 节点/ s2/ ,/ 表示/ 该/ 攻击/ 状态/ 能/ 通过/ 攻击/ a2/ 达到/ ,/ 也/ 能/ 通过/ 实施/ 攻击/ a3/ 达到/ ./ 依附于/ a4/ 的/ 边/ 有/ 3/ 条/ ,/ 从/ s2/ 和/ s3/ 到/ a4/ 的/ 两条/ 边/ 是/ “/ 与/ ”/ 的/ 关系/ ,/ 而/ 从/ o4/ 到/ a4/ 的/ 边/ 与/ 其它/ 两条/ 边/ 是/ “/ 或/ ”/ 的/ 关系/ ./ 本/ 模型/ 把/ 观察/ 事件/ 节点/ 到/ 攻击/ 节点/ 之间/ 的/ 边/ 认为/ 是/ 和/ 其余/ 所有/ 依附于/ 该/ 攻击/ 节点/ 的/ 边用/ “/ 或/ ”/ 连接起来/ ,/ 这/ 在/ 现实/ 中/ 具有/ 合理/ 的/ 解释/ :/ 当/ 人们/ 观察/ 到/ 事件/ 发生/ 时/ ,/ 可以/ 不用/ 考虑/ 其/ 前提条件/ 是否/ 满足/ 即可/ 推断/ 该/ 攻击行为/ 可能/ 确实/ 发生/ 了/ ;/ 而/ 如果/ 没有/ 观察/ 到/ 事件/ (/ 比如/ IDS/ 被/ 攻击者/ 成功/ 欺骗/ )/ ,/ 则/ 可以/ 通过/ 其/ 已经/ 满足/ 的/ 前提条件/ 来/ 推断/ 该/ 攻击/ 发生/ 的/ 可能性/ ./ 3.2/ 概率/ 攻击/ 图/ 的/ 构建/ 过程/ 概率/ 攻击/ 图/ 的/ 构造/ 分为/ 两/ 部分/ :/ 攻击/ 图/ 基本/ 结构/ 的/ 确定/ 和/ 条件/ 概率/ 表/ CPT/ 的/ 生成/ ./ 攻击/ 图/ 结构/ 的/ 生成/ 目前/ 大部分/ 都/ 依赖于/ 专家/ 知识库/ 来/ 生成/ ,/ 比如/ Ou/ 等/ 人/ [/ 14/ ]/ 采用/ Horn/ 逻辑/ 描述/ 攻击/ 模板/ ,/ 可以/ 利用/ 漏洞/ 和/ 攻击/ 之间/ 的/ 逻辑关系/ 半自动/ 辅助/ 安全/ 专家/ 来/ 生成/ 大规模/ 的/ 攻击/ 图/ 结构/ ./ 攻击/ 图/ 结构/ 的/ 生成/ 是/ 一个/ 复杂/ 的/ 问题/ ,/ 本文/ 的/ 攻击/ 图/ 结构/ 假定/ 利用/ 专家/ 知识库/ 来/ 生成/ ,/ 而/ 主要/ 关注/ 如何/ 确定/ 攻击/ 图中/ 的/ 条件/ 概率/ 表/ CPT/ ./ 在/ 3.1/ 节/ 介绍/ 的/ 概率/ 攻击/ 图中/ ,/ 条件/ 概率/ 表/ CPT/ 是/ 其中/ 最/ 重要/ 的/ 部分/ ./ 张少俊/ 等/ 人/ [/ 12/ ]/ 在/ 其/ 模型/ 上/ 也/ 引入/ 攻击行为/ 发生/ 的/ 概率/ 、/ 攻击行为/ 成功/ 的/ 概率/ 以及/ 攻击/ 证据/ 被/ 观察/ 到/ 的/ 概率/ P/ (/ oi/ |/ ai/ )/ ,/ 与/ 本文/ 介绍/ 的/ 概率/ 攻击/ 图/ 最为/ 相似/ ./ 但是/ 他们/ 在/ 计算/ 过程/ 中/ ,/ 假设/ 攻击行为/ 发生/ 概率/ 和/ 成功/ 的/ 概率/ 为/ 0.5/ ,/ P/ (/ oi/ |/ ai/ )/ 为/ 1.0/ ./ 他们/ 没有/ 给出/ 这/ 3/ 种/ 概率/ 在/ 实际/ 系统/ 中/ 的/ 含义/ ,/ 且/ 将/ P/ (/ oi/ |/ ai/ )/ 定义/ 为/ 1.0/ ,/ 本质/ 上/ 与/ 没有/ 引入/ 观测/ 事件/ 节点/ 其/ 结果/ 是/ 相同/ 的/ ./ 本文/ 根据/ 已有/ 的/ 静态/ 漏洞/ 分析/ 知识库/ 和/ 安全监控/ 系统/ 动态/ 生成/ 的/ 事件/ 置信度/ 作为/ 确定/ 条件/ 概率/ 表/ 的/ 依据/ ,/ 很/ 好/ 的/ 与/ 实际/ 情况/ 结合/ ,/ 使得/ 后续/ 的/ 攻击/ 意图/ 推断/ 算法/ 更/ 具有/ 说服力/ ./ Δ/ s/ 表示/ 攻击/ 发生/ 的/ 概率/ ./ Δ/ sij/ 为/ 在/ 状态/ si/ 下/ ,/ 攻击/ aj/ 发生/ 的/ 概率/ P/ (/ aj/ |/ si/ )/ ./ 如果/ 攻击/ 方法/ 是/ 利用/ 某个/ 软件/ 固有/ 的/ 漏洞/ ,/ 那么/ 攻击/ 发生/ 的/ 概率/ 与/ 该/ 漏洞/ 被/ 利用/ 的/ 难易/ 程度/ 非常/ 相关/ ./ 一般来说/ ,/ 攻击/ 方法/ 越/ 简单/ ,/ 其/ 发生/ 概率/ 越大/ ./ NationalVulnerabilityDatabase/ (/ NVD/ )/ 发布/ 了/ 大量/ 软件/ 漏洞/ ,/ 通用/ 安全/ 脆弱/ 点/ 评估/ 系统/ CommonVulnerabilityScoringSystem/ (/ CVSS/ )/ 是/ 一个/ 能量/ 化/ 各个/ 软件/ 漏洞/ 属性/ 的/ 工具/ ./ 其中/ 存取/ 复杂度/ Ac/ -/ cessComplexity/ (/ AC/ )/ 描述/ 了/ 发动/ 漏洞/ 攻击/ 的/ 难度/ ,/ 可以/ 取值/ 高/ 、/ 中/ 、/ 低/ ./ 因此/ CVSS/ 系统对/ 漏洞/ 的/ 评估/ 可以/ 被/ 作为/ 确定/ Δ/ sij/ 的/ 来源/ ./ 在/ 内部/ 攻击/ 中/ ,/ 也/ 存在/ 大量/ 攻击/ 方法/ 不是/ 利用软件/ 漏洞/ 来/ 发动/ ,/ 比如/ 猜/ 口令/ 攻击/ 、/ KeyLogger/ 攻击/ 等/ ./ 这种/ 攻击/ 手段/ 发生/ 的/ 概率/ 可以/ 通过/ 安全/ 专家/ 指定/ ,/ 比如/ 猜/ 口令/ 攻击/ 很/ 容易/ 实现/ ,/ 但/ 不易/ 成功/ ./ 本文/ 通过/ 给/ 每类/ 攻击/ 指定/ 一个/ 类似/ 于/ CVSS/ 系统/ 的/ AC/ 属性/ 一样/ 的/ 参数/ ,/ 来/ 给出/ 相应/ 的/ 概率/ 取值/ ./ 另外/ ,/ 也/ 可以/ 通过/ 网络安全/ 系统/ 给出/ 的/ 攻击/ 日志/ 数量/ 来/ 确定/ ./ 表/ 1/ 给出/ 了/ 本文/ 所/ 使用/ 的/ 标准/ ,/ 如果/ 一个/ 漏洞/ 在/ CVSS/ 系统/ 中/ 的/ AC/ 属性/ 为/ “/ High/ ”/ ,/ 或者/ 某类/ 攻击/ 被/ 安全/ 专家/ 标记/ 为/ “/ High/ ”/ ,/ 则/ 说明/ 该/ 攻击/ 实施/ 的/ 难度很大/ ,/ 满足/ 预设/ 条件/ 时/ ,/ 其/ 可能/ 发生/ 的/ 概率/ 被/ 设置/ 为/ 0.2/ ./ 如果/ 某类/ 攻击/ 在/ 一周/ 内/ 安全监控/ 系统/ 报警/ 次数/ 小于/ 5/ 次/ ,/ 则/ 说明/ 该类/ 攻击/ 手段/ 很少/ 被/ 使用/ ,/ 其/ 可能/ 发生/ 的/ 概率/ 被/ 设置/ 为/ 0.1/ ./ Δ/ a/ 表示/ 攻击/ 成功/ 的/ 概率/ ./ Δ/ aij/ 为/ 攻击/ ai/ 成功/ 后达/ Page6/ 到/ 状态/ sj/ 的/ 概率/ P/ (/ sj/ |/ ai/ )/ ./ 实际上/ 攻击/ 发生/ 概率/ 和/ 攻击/ 成功/ 的/ 概率/ 是/ 相关/ 的/ ,/ 比如/ 攻击者/ 选择/ 一个/ 软件/ 漏洞/ 进行/ 攻击/ 与其/ 是否/ 成功/ 都/ 是/ 跟/ 利用/ 该软件/ 漏洞/ 的/ 难易/ 程度/ 相关/ ./ 但是/ 它们/ 又/ 不/ 完全/ 一样/ ,/ 比如/ 猜/ 口令/ 攻击/ ,/ 一个/ 网络/ 中/ 很/ 容易/ 发生/ 这种/ 攻击/ ,/ 但是/ 成功/ 的/ 可能性/ 却/ 比较/ 低/ ./ 因此/ ,/ 这里/ 将/ 软件/ 漏洞/ 攻击/ 的/ 成功/ 概率/ 置/ 为/ 1.0/ ,/ 攻击/ 发生/ 概率/ 中/ 已经/ 考虑/ 了/ 其/ 难度/ ,/ 而/ 对/ 其它/ 异常/ 攻击/ ,/ 则/ 根据/ 专家/ 知识库/ 来/ 设置/ ./ Δ/ o/ 表示/ 观察/ 到/ 的/ 事件/ 确定/ 攻击/ 正在/ 发生/ 的/ 概率/ ,/ 即/ 观测/ 事件/ 的/ 置信度/ ./ Δ/ oi/ 表示/ 攻击/ 观察/ 事件/ oi/ 能/ 证明/ ai/ 正在/ 发生/ 的/ 概率/ ./ 现代/ 的/ 信息安全/ 监控/ 系统/ 能/ 根据/ 特定/ 的/ 规则/ 检测/ 某些/ 具体/ 攻击/ ,/ 也/ 能/ 根据/ 用户/ 的/ 日常行为/ 模式/ 检测/ 异常/ ./ 前者/ 通常/ 预示/ 着/ 某些/ 确定性/ 的/ 攻击/ 正在/ 发生/ ,/ 而/ 后者/ 给出/ 的/ 危险/ 报警/ 常常/ 具有/ 比较/ 高/ 的/ FP/ 和/ FN/ ,/ 信息安全/ 监控/ 系统/ 也/ 常常/ 能/ 给出/ 该类/ 事件/ 的/ 置信度/ p/ ./ 对于/ 确定性/ 的/ 攻击/ oi/ ,/ Δ/ oi/ 可以/ 取值/ 为/ 1/ ;/ 对/ 有/ 不确定性/ 的/ 异常/ 事件/ oj/ ,/ Δ/ oj/ 可以/ 取值/ 为/ 其/ 相对/ 应/ 的/ 置信度/ p/ (/ oj/ )/ ./ Δ/ o/ 在/ 概率/ 攻击/ 图中/ 是/ 一个/ 延迟/ 变量/ ,/ 其值/ 在/ 安全/ 监测/ 系统/ 观测/ 到/ 具体/ 事件/ 时/ 才能/ 被/ 决定/ ./ 3.3/ 攻击/ 意图/ 推导/ 算法/ 定义/ 了/ 概率/ 攻击/ 图后/ ,/ 需要/ 解决/ 如下/ 问题/ :/ 对/ 给定/ 的/ 当/ 观测/ 到/ 一些/ 攻击行为/ 告警/ 时/ ,/ 如何/ 推断/ 当前/ 网络/ 中/ 潜在/ 的/ 攻击/ 意图/ 和/ 可能/ 的/ 攻击/ 路径/ ?/ 该/ 问题/ 可/ 形式化/ 表述/ 如下/ ./ 问题/ 1/ ./ 给定/ 概率/ 攻击/ 图/ PAG/ =/ (/ S/ ,/ E/ ,/ Δ/ )/ 和/ 一个/ 观察/ 事件/ 序列/ O/ =/ {/ o1/ ,/ o2/ ,/ …/ ,/ on/ }/ 及其/ 对应/ 的/ 置信/ 概率/ PO/ =/ {/ p1/ ,/ p2/ ,/ …/ ,/ pn/ }/ ,/ 求/ :/ (/ 1/ )/ P/ (/ G/ |/ O/ ,/ PO/ )/ ;/ (/ 2/ )/ 从/ S0/ 到/ G/ 的/ 一条/ 路径/ (/ S0/ ,/ …/ ,/ Si/ ,/ …/ ,/ G/ )/ ,/ 使得/ 攻击/ 概率/ 最大/ ./ 为了/ 解决/ 该/ 问题/ ,/ 下面/ 首先/ 定义/ 累积/ 概率/ ,/ 然后/ 给出/ 攻击/ 意图/ 的/ 推断/ 算法/ ,/ 最后/ 给出/ 最大/ 概率/ 攻击/ 路径/ 选择/ 算法/ ./ 3.3/ ./ 1/ 累积/ 概率/ 累积/ 概率/ 本来/ 定义/ 一个/ 随机变量/ 取值/ 某个/ 范围/ 的/ 概率/ ./ 在/ 此处/ ,/ 状态/ 节点/ 和/ 攻击/ 节点/ 的/ 累积/ 概率/ 定义/ 为/ 在/ 给定/ 攻击/ 图/ 和/ 当前/ 观测/ 到/ 事件/ 的/ 情况/ 下/ ,/ 达到/ 当前/ 攻击/ 状态/ 或者/ 发生/ 当前/ 攻击行为/ 的/ 整个/ 可能性/ ./ 累积/ 概率/ 的/ 具体/ 定义/ 如下/ ./ 定义/ 3/ ./ 给定/ 概率/ 攻击/ 图/ PAG/ =/ (/ N/ ,/ E/ ,/ Δ/ )/ ,/ 状态/ 节点/ 集合/ S/ 和/ 攻击/ 节点/ 集合/ A/ 中/ 节点/ 的/ 累积/ 概率/ CP/ (/ CumulativeProbability/ )/ 被/ 定义/ 为/ :/ (/ 1/ )/ CP/ (/ oi/ )/ =/ 1/ ,/ 即/ 如果/ 从/ 安全监控/ 系统/ 观察/ 到/ 事件/ oi/ ,/ 则/ 该/ 事件/ 就是/ 确定性/ 发生/ 了/ ;/ (/ 2/ )/ CP/ (/ s0/ )/ =/ 1/ ;/ 否则/ ,/ CP/ (/ si/ )/ =/ / (/ Pre/ (/ si/ )/ )/ ;/ (/ 3/ )/ CP/ (/ ai/ )/ =/ U/ (/ Pre/ (/ ai/ )/ )/ ,/ 如果/ oi/ 没有/ 看到/ ;/ 否/ (/ 4/ )/ / (/ s/ ,/ s1/ ,/ s2/ )/ 表示/ 指向/ s/ 的/ 节点/ 确定/ 的/ 所有/ 则/ ,/ CP/ (/ ai/ )/ =/ / (/ U/ (/ Pre/ (/ ai/ )/ )/ ,/ oi/ )/ ./ 边/ 执行/ 概率/ “/ 或/ ”/ 操作/ ,/ 计算/ 如下/ :/ 边/ 执行/ 概率/ “/ 与/ ”/ 操作/ ,/ 计算/ 如下/ :/ (/ 5/ )/ U/ (/ s/ ,/ s1/ ,/ s2/ )/ 表示/ 指向/ s/ 的/ 节点/ 确定/ 的/ 所有/ U/ (/ s/ ,/ s1/ ,/ s2/ )/ =/ CP/ (/ s1/ )/ Δ/ 1/ ×/ CP/ (/ s2/ )/ Δ/ 2/ ./ (/ 6/ )/ Δ/ 1/ ,/ Δ/ 2/ 分别/ 是/ 依附/ 在/ 从/ s1/ 到/ s/ 和/ s2/ 到/ s/ 的/ 边上/ 的/ 条件/ 概率/ ./ 3.3/ ./ 2/ 攻击/ 意图/ 推断/ 算法/ 在/ 上述/ 对/ 节点/ 累积/ 概率/ 的/ 定义/ 下/ ,/ CP/ (/ G/ )/ 即/ 在/ 观测/ 事件/ 序列/ 下/ 可能/ 发生/ 攻击/ 意图/ 的/ 总体/ 概率/ 估计/ ./ 因此/ ,/ 只/ 需要/ 计算/ 每个/ 攻击/ 目标/ 节点/ 的/ 累积/ 概率/ ,/ 然后/ 对/ 其/ 进行/ 排序/ 即可/ 知道/ 当前/ 网络/ 最/ 可能/ 发生/ 的/ 攻击/ 意图/ ./ 积/ 概率/ ./ 算法/ 1/ 采用/ 广度/ 优先/ 算法/ 对/ 各个/ 节点/ 计算/ 其累/ 算法/ 1/ ./ 攻击/ 意图/ 推断/ 算法/ ./ 输入/ :/ 概率/ 攻击/ 图/ PAG/ =/ (/ N/ ,/ E/ ,/ Δ/ )/ ;/ 观察/ 事件/ 序列/ O/ =/ {/ o1/ ,/ o2/ ,/ …/ ,/ on/ }/ 及其/ 对应/ 的/ 置信/ 概率/ PO/ =/ {/ p1/ ,/ p2/ ,/ …/ ,/ pn/ }/ ./ 输出/ :/ 攻击/ 图中/ 各个/ 节点/ 的/ 累积/ 概率/ ./ FUNCTIONIntentInferring/ (/ PAG/ ,/ O/ ,/ PO/ )/ 1/ ./ Queue/ _/ Init/ (/ Q/ )/ ;/ 2/ ./ Queue/ _/ Push/ (/ Q/ ,/ s0/ )/ ;/ // // 将/ 初始/ 节点/ 压入/ 队列/ 中/ 3/ ./ WHILE/ (/ Queue/ _/ Empty/ (/ Q/ )/ )/ DO/ // // 判断/ 4/ ./ n/ =/ Queue/ _/ Pop/ (/ Q/ )/ ;/ 5/ ./ FOREACHciischildofnDO6/ ./ Queue/ _/ Push/ (/ Q/ ,/ ci/ )/ ;/ 7/ ./ IFn/ ∈/ 状态/ 节点/ 集/ STHEN8/ ./ n/ / cp/ =/ P/ _/ OR/ (/ n/ ,/ Pre/ (/ n/ )/ )/ ;/ Page79/ ./ IFn/ ∈/ 攻击/ 节点/ 集/ ATHEN10/ ./ (/ o/ ,/ p/ )/ =/ 从/ 输入/ (/ O/ ,/ PO/ )/ 中/ 找到/ 与/ 节点/ n/ 相关/ 11/ ./ n/ ./ cp/ =/ ∏/ Ri/ ∈/ Pre/ (/ n/ )/ Ri/ ./ cp/ / ;/ // // 计算/ 节点/ n/ 的/ 12/ ./ IF/ (/ o/ ,/ p/ )/ 不为/ 空/ THEN13/ ./ n/ / cp/ =/ n/ / cp/ +/ 1/ / p/ -/ n/ / cp/ / 1/ / p14/ ./ ENDWHILE15/ ./ RETURN/ 所有/ 节点/ 的/ 累积/ 概率/ ;/ 其中/ ,/ 概率/ “/ 或/ ”/ 函数/ P/ _/ OR/ (/ s/ ,/ Pre/ (/ s/ )/ )/ 的/ 定义/ 如下/ :/ FUNCTIONP/ _/ OR/ (/ s/ ,/ Pre/ (/ s/ )/ )/ 1/ ./ Not/ _/ N/ =/ 12/ ./ FOREACHciinPre/ (/ s/ )/ DO3/ ./ Not/ _/ N/ =/ Not/ _/ N/ / (/ 1/ -/ ci/ ./ cp/ / Δ/ )/ ;/ 4RETURN1/ -/ Not/ _/ N/ 复杂度/ 分析/ :/ 本/ 算法/ 与/ 图/ 上/ 的/ 广度/ 搜索算法/ 复杂度/ 相同/ ,/ 为/ O/ (/ N/ _/ num/ +/ E/ _/ num/ )/ ,/ 即/ 节点/ 数和有/ 向/ 边数/ 规模/ 的/ 和/ ./ 3.3/ ./ 3/ 最大/ 概率/ 攻击/ 路径/ 选择/ 算法/ 定义/ 4/ ./ 最大/ 概率/ 攻击/ 路径/ 指/ 这样/ 一条/ 攻击/ 路径/ Path/ =/ (/ s0/ ,/ …/ ,/ si/ ,/ …/ ,/ G/ )/ ,/ 在/ 所有/ 的/ 路径/ 中/ CP/ (/ Path/ |/ (/ GAE/ ,/ O/ )/ )/ 最大/ ./ 经典/ 的/ Viterbi/ 算法/ 常用/ 于/ 在/ 隐/ 马尔可夫/ 模型/ 中/ ,/ 寻找/ 最优/ 可能/ 产生/ 观测/ 事件/ 序列/ 的/ 隐含/ 状态/ 序列/ ./ 最大/ 概率/ 攻击/ 路径/ 本质/ 上同/ Viterbi/ 算法/ 的/ 目的/ 类似/ ,/ 只是/ 最大/ 概率/ 攻击/ 图/ 状态/ 节点/ 取值/ 空间/ 与/ 隐/ 马尔科夫/ 模型/ 中/ 的/ 状态/ 空间/ 不/ 一样/ ,/ 而且/ 观测/ 序列/ 允许/ 事件/ 缺失/ ./ 因此/ ,/ 我们/ 在/ Viterbi/ 算法/ 的/ 基础/ 上/ 进行/ 修改/ 来/ 寻找/ 最大/ 概率/ 攻击/ 路径/ ./ 在/ 算法/ 1/ 得到/ 的/ 所有/ 节点/ 累积/ 概率/ 基础/ 上/ ,/ 算法/ 2/ 利用/ 贪心/ 算法/ 反向/ 查找/ ./ 如果/ 当前/ 节点/ 为/ 状态/ 节点/ ,/ 则/ 寻找/ 概率/ 最大/ 的/ 攻击/ 节点/ ;/ 如果/ 当前/ 节点/ 为/ 攻击/ 节点/ ,/ 则/ 包含/ 所有/ 前提/ 状态/ 节点/ 到/ 路径/ 中/ ./ 算法/ 2/ ./ 最大/ 概率/ 攻击/ 路径/ 选择/ 算法/ ./ 输入/ :/ 攻击/ 图/ PAG/ =/ (/ N/ ,/ E/ ,/ Δ/ )/ ;/ 以及/ 各个/ 节点/ 的/ 累积/ 概率/ CP/ =/ {/ ni/ / cp/ |/ ni/ ∈/ N/ }/ ./ 输出/ :/ 最大/ 概率/ 攻击/ 路径/ Path/ =/ (/ S0/ ,/ …/ ,/ Si/ ,/ …/ ,/ G/ )/ ./ FUNCTIONMaxProbabilityPath/ (/ PAG/ ,/ CP/ )/ 1/ ./ Path/ =/ {/ }/ ;/ 2/ ./ Queue/ _/ Init/ (/ Q/ )/ ;/ 3/ ./ g/ =/ argmaxg/ ∈/ G/ (/ g/ / cp/ )/ ;/ // // 从/ 目标/ 节点/ 集中/ 取出/ 最/ 4/ ./ AddgtoPath/ ;/ // // 节点/ 放入/ 路径/ 中/ 5/ ./ Queue/ _/ Push/ (/ Q/ ,/ g/ )/ ;/ 6/ ./ WHILE/ (/ Queue/ _/ Empty/ (/ Q/ )/ )/ DO7/ ./ n/ =/ Queue/ _/ Pop/ (/ Q/ )/ ;/ 8/ ./ IFn/ ∈/ ATHEN9/ ./ Queue/ _/ Push/ (/ Pre/ (/ n/ )/ )/ ;/ // // 将/ n/ 的/ 所有/ 前提/ 10/ ./ AddPre/ (/ n/ )/ toPath/ ;/ 11/ ./ IFn/ ∈/ STHEN12/ ./ c/ =/ argmaxc/ ∈/ pre/ (/ n/ )/ (/ c/ / cp/ / Δ/ c/ )/ ;/ 13/ ./ Queue/ _/ Push/ (/ c/ )/ ;/ // // 节点/ 出/ 队列/ 14/ ./ AddcintoPath/ ;/ // // 将/ 节点/ 加入/ 路径/ 中/ 15/ ./ ENDWHILE16/ ./ RETURNPath/ ;/ 复杂度/ 分析/ :/ 该/ 算法/ 与/ 算法/ 1/ 相似/ ,/ 复杂度/ 也/ 是/ O/ (/ N/ _/ num/ +/ E/ _/ num/ )/ ,/ 即/ 节点/ 数和有/ 向/ 边数/ 规模/ 的/ 和/ ./ 4/ 实验/ 验证/ 本/ 节/ 首先/ 以图/ 1/ 所/ 代表/ 的/ 网络拓扑/ 为例/ ,/ 介绍/ 在/ 实验/ 环境/ 中/ 真实/ 搭建/ 的/ 网络/ 环境/ 以及/ 在/ 此/ 网络/ 环境/ 中/ 的/ 安全漏洞/ 和/ 内部/ 攻击/ 手段/ ./ 然后/ 利用/ 第/ 3/ 节/ 介绍/ 的/ 概率/ 攻击/ 图/ 定义/ ,/ 给出/ 了/ 此/ 场景/ 下/ 的/ 概率/ 攻击/ 图/ 结构/ 和/ 对应/ 的/ CPT/ 表/ ./ 最后/ 通过/ 捕获/ 了/ 一些/ 模拟/ 攻击/ 数据/ ,/ 给出/ 概率/ 攻击/ 图/ 的/ 计算/ 过程/ 以及/ 和/ 其它/ 方法/ 检测/ 结果/ 的/ 比较/ 和/ 分析/ ,/ 其/ 结果/ 证明/ 了/ 我们/ 算法/ 的/ 可行性/ ,/ 以及/ 在/ 缩小/ 攻击/ 报警/ 范围/ 方面/ 的/ 有效性/ 和/ 灵活性/ ./ 4.1/ 实验/ 网络/ 环境/ 在/ 图/ 1/ 所示/ 的/ 网络拓扑/ 中/ ,/ 网络/ 被/ 分为/ 3/ 部分/ :/ 外/ 网/ 区域/ 、/ 内部/ 办公区/ 和/ 内部/ 服务器/ 区/ ./ 外网/ 与/ 内网/ 通过/ 防火墙/ 系统/ 逻辑/ 隔离/ 开来/ ;/ 内部/ 服务器/ 区/ 部署/ 一台/ 网站/ 服务器/ (/ apache2/ ./ 2/ )/ 、/ 文件/ 服务器/ (/ Linux2/ ./ 4/ )/ 和/ 其它/ 服务器/ ;/ 内部/ 办公区/ 部署/ 一些/ 终端/ 和/ 个人/ PC/ ,/ 包括/ 一台/ 模拟/ 的/ 恶意/ 内部/ 用户/ 终端/ 和/ 管理员/ 终端/ ./ 内部/ 服务器/ 区上/ 存在/ 的/ 漏洞/ 包括/ 网站/ 服务器/ 上/ apache/ 的/ CVE/ -/ 2006/ -/ 3747/ (/ Apachemod/ _/ rewrite/ 模块/ 单字节/ 缓冲区/ 溢出/ 漏洞/ )/ 和/ 文件/ 服务器/ 上/ 存在/ CVE/ -/ 2003/ -/ 0252/ (/ Linuxnfs/ -/ utilsxlog/ (/ )/ 远程/ 缓冲区/ 单字节/ 溢出/ 漏洞/ )/ ,/ 两种/ 漏洞/ 的/ 攻击/ 复杂度/ 分别/ 为/ High/ 和/ Low/ ./ 实验/ 环境/ 中/ 部署/ 了/ 一些/ 安全监控/ 软件/ ,/ 包括/ Snort/ 用来/ 捕获/ 各种/ 漏洞/ 利用/ 攻击行为/ 和/ 网络/ 行为/ 异常/ 事件/ ,/ Tripwire/ 部署/ 在/ 文件/ 服务器/ 上/ ,/ 用来/ 监控/ 文件系统/ 的/ 完整性/ ,/ 各个/ 终端/ 和/ 个人/ 计算机/ 上/ 部署/ OSSEC/ ,/ 用来/ 监控/ PC/ 端的/ 木马/ 活动/ 和/ 异常/ 行为/ ./ Page84/ ./ 2/ 概率/ 攻击/ 图/ 的/ 结构/ 和/ CPT/ 表图/ 3/ 表示/ 了/ 图/ 1/ 两种/ 攻击/ 过程/ 的/ 完整/ 攻击/ 图/ ./ 为了/ 避免/ 繁琐/ ,/ 图/ 3/ 中/ 省去/ 了/ 条件/ 概率/ 表/ ,/ 除/ 观测/ 事件/ 到/ 攻击/ 节点/ 的/ 条件/ 概率/ 在/ 实际/ 计算/ 过程/ 外/ ,/ 其它/ 条件/ 概率/ 取值/ 根据/ 3.2/ 节中/ 定义/ 的/ 方式/ 在/ 表/ 4/ 中/ 给出/ ./ 4.3/ 实验/ 及/ 结果/ 分析/ 4.3/ ./ 1/ 计算/ 过程/ 与/ 分析/ 根据/ 图/ 3/ 和表/ 4/ 确定/ 了/ 本文/ 所/ 定义/ 的/ 概率/ 攻击/ 图/ ,/ 通过/ 实验/ 环境/ 部署/ 的/ Snort/ 、/ Tripwire/ 和/ OSSEC/ 等/ 安全监控/ 软件/ 可以/ 观测/ 到/ 观测/ 事件/ 以及/ 其/ 对应/ 的/ 转移/ 概率/ ,/ 以此/ 为/ 输入/ ,/ 即可/ 通过/ 3.3/ 节/ 定义/ 算法/ 1/ 和/ 算法/ 2/ 计算/ 当前/ 的/ 潜在/ 攻击/ 意图/ 及其/ 最大/ 概率/ 攻击/ 路径/ ./ 实验/ 结果/ 如表/ 5/ 所示/ ./ 边/ 概率/ 取值/ 边/ (/ s0/ ,/ a1/ )/ 0.9/ (/ s0/ ,/ a6/ )/ (/ s0/ ,/ a10/ )/ 0.8/ (/ a1/ ,/ s1/ )/ (/ a6/ ,/ s6/ )/ 1.0/ (/ a10/ ,/ s7/ )/ (/ s1/ ,/ a2/ )/ 0.4/ (/ s1/ ,/ a3/ )/ (/ s6/ ,/ a7/ )/ 0.8/ (/ a2/ ,/ s2/ )/ (/ a3/ ,/ s2/ )/ 1.0/ (/ a7/ ,/ s7/ )/ (/ s2/ ,/ a4/ )/ 0.6/ (/ s3/ ,/ a4/ )/ (/ s7/ ,/ a8/ )/ 0.8/ (/ a8/ ,/ s8/ )/ (/ a4/ ,/ s4/ )/ 1.0/ (/ s8/ ,/ a9/ )/ (/ a9/ ,/ s4/ )/ 1.0/ (/ s4/ ,/ a5/ )/ (/ a5/ ,/ s5/ )/ 1.0/ 编号/ 观测/ 事件/ 序列/ O1O2/ {/ o6/ :/ 1/ ,/ o7/ :/ 0.85/ ,/ o9/ :/ 0.9/ }/ {/ s0/ ,/ a6/ ,/ s6/ ,/ a7/ ,/ s7/ ,/ a8/ ,/ s8/ ,/ a9/ ,/ s4/ ,/ a5/ ,/ s5/ }/ O3/ {/ o2/ :/ 1/ ,/ o4/ :/ 0.9/ ,/ o8/ :/ 0.5/ }/ {/ s0/ ,/ a1/ ,/ s1/ ,/ a2/ ,/ s2/ ,/ a4/ ,/ s4/ ,/ a5/ ,/ s5/ }/ 状态/ 节点/ O1O2O3/ 攻击/ 节点/ O1O2O3s0100100100a1909090s1999a23/ ./ 63.6100/ s210/ ./ 510.5100/ a37/ ./ 27.27/ ./ 2s3100100100a45/ ./ 055.0594/ ./ 8s436/ ./ 694.396/ ./ 9a532/ ./ 984.987/ ./ 2s62010020a62010020s783/ ./ 299.483/ ./ 2a7169716s866/ ./ 579.566/ ./ 5a866/ ./ 579.583/ ./ 2/ 狊/ 532.984/ ./ 987.2/ a933/ ./ 29441.6/ 在/ 表/ 5/ 中/ ,/ 我们/ 针对/ 3/ 种/ 情况/ 对/ 攻击/ 意图/ 进行/ 推断/ 和/ 攻击/ 路径/ 计算/ ./ 为了/ 不失/ 一般性/ ,/ 假定/ 第/ 1/ 个/ 实验/ 中/ 没有/ 观测/ 到/ 任何/ 事件/ ,/ 这/ 相当于/ 传统/ 的/ 网络安全/ 风险/ 评估/ 方法/ ,/ 根据/ 已有/ 的/ 漏洞/ 知识/ 和/ 专家/ 知识库/ 可以/ 发现/ 系统/ 中/ 最/ 脆弱/ 的/ 攻击/ 路径/ ./ 图/ 4/ (/ a/ )/ 直观/ 地/ 体现/ 了/ 攻击者/ 最/ 可能/ 的/ 攻击/ 路径/ 以及/ 置信度/ 评估/ ./ 在/ 没有/ 看到/ 任何/ 报警/ 事件/ 的/ 情况/ 下/ ,/ 可能/ 存在/ 攻击/ 成功/ 的/ 概率/ 是/ 32.9/ %/ ,/ 最/ 可能/ 采取/ 的/ 攻击/ 路径/ 是/ {/ s0/ ,/ a10/ ,/ s7/ ,/ a8/ ,/ s8/ ,/ a9/ ,/ s4/ ,/ a5/ ,/ s5/ }/ ./ 第/ 2/ 个/ 实验/ 假设/ 系统/ 观测/ 到/ 了/ o6/ ,/ o7/ 和/ o9/ 事件/ ,/ 其/ 对应/ 的/ 置信度/ 分别/ 为/ 1.0/ ,/ 0.85/ 和/ 0.9/ ./ 在/ 此/ 情况/ 下/ ,/ 推测/ 攻击/ 成功/ 的/ 概率/ 为/ 84.9/ %/ ,/ 最/ 可能/ 的/ 攻击/ 路径/ 为/ {/ s0/ ,/ a6/ ,/ s6/ ,/ a7/ ,/ s7/ ,/ a8/ ,/ s8/ ./ a9/ ,/ s4/ ,/ a5/ ,/ s5/ }/ ,/ 如图/ 4/ (/ b/ )/ 所示/ ./ 第/ 3/ 个/ 实验/ 假设/ 系统/ 观测/ 到/ 事件/ o2/ ,/ o4/ ,/ o8/ ,/ 对应/ 置信度/ 分别/ 为/ 1.0/ ,/ 0.9/ ./ 0.5/ ./ 在/ 此/ 情况/ 下/ ,/ 推测/ 攻击/ 成功/ 的/ 概率/ 为/ 87.2/ %/ ,/ 最/ 可能/ 的/ 攻击/ 路径/ 为/ {/ s0/ ,/ a1/ ,/ s1/ ,/ a2/ ,/ s2/ ,/ a4/ ,/ s4/ ,/ a5/ ,/ s5/ }/ ,/ 如图/ 4/ (/ c/ )/ 所示/ ./ 需要/ 说明/ 的/ 一点/ 是/ ,/ 在/ 第/ 3/ 个/ 实验/ 中/ s1/ 的/ 累积/ 概率/ 非常/ 小/ ,/ 只有/ 9/ %/ ,/ 但/ 该/ 路径/ 上/ 的/ 其它/ 累积/ 概率/ 都/ 非常/ 大/ ,/ 这/ 可/ 解释/ 为/ 安全/ 监测/ 系统/ 极有/ 可能/ 没有/ 捕获/ 到/ “/ 猜/ 密码/ 成功/ ”/ 事件/ ,/ 也/ 说明/ 本文/ 所提/ 方法/ 能够/ 处理/ 在/ 某些/ 观测/ 事件/ 缺失/ 的/ 情况/ 下/ 推断/ 攻击/ 意图/ 和/ 攻击/ 路径/ ./ 4.3/ ./ 2/ 检测/ 结果/ 的/ 比较/ 与/ 分析/ 贝叶斯/ 网络/ 算法/ 被/ 广泛应用/ 在/ 攻击/ 图中/ 检测/ 攻击/ ./ 叶云/ 等/ 人/ [/ 13/ ]/ 的/ 工作/ 在/ 攻击/ 图上/ 计算/ 累积/ 概率/ ,/ 但/ 他们/ 的/ 模型/ 中/ 没有/ 考虑/ 观察/ 事件/ 推导/ 到/ 攻击/ 发生/ 的/ 不确定性/ ,/ 观测/ 事件/ 与/ 攻击/ 发生/ 是/ 一一对应/ 的/ ,/ 对应/ 到/ 我们/ 的/ 模型/ 中即/ Δ/ oi/ 取值/ 全为/ 1/ ./ Xie/ 等/ 人/ [/ 11/ ]/ 的/ 工作/ 中/ 观测/ 节点/ 被/ 有/ 选择地/ 引入/ ,/ 某些/ 重要/ 的/ 攻击/ 节点/ 引入/ 一个/ 特殊/ 的/ 前提/ 节点/ AAN/ ./ 攻击/ 节点/ 的/ 概率/ 计算/ 方式/ 与/ 本文/ 所述/ 方法/ 不同/ ,/ 只有/ 当/ AAN/ 节点/ 为/ 真/ (/ 被/ 观测/ 到/ )/ 才/ 用/ 其/ 前提/ 节点/ 进行/ 与/ 或/ 计算/ 得到/ 攻击/ 节点/ 的/ 概率/ ./ 否则/ ,/ 其/ 攻击/ 节点/ 的/ 概率/ 被/ 置/ 为/ 0/ ./ Page9/ 图/ 4/ 在/ 观测/ 序列/ O1/ ,/ O2/ 和/ O3/ 上/ 的/ 推断/ 过程/ 示意图/ 从/ 实验/ 环境/ 中/ 安全监控/ 软件/ 的/ 日志/ 数据/ 中/ ,/ 我们/ 提取/ 了/ 100/ 个/ 观测/ 序列/ 及其/ 相关/ 的/ 转移/ 概率/ ,/ 加上/ 4.3/ ./ 1/ 节/ 的/ 两次/ 攻击/ 序列/ O2/ 和/ O3/ ,/ 共有/ 102/ 个/ 观测/ 序列/ ./ 本文/ 实现/ 了/ 叶云/ 等/ 人/ 的/ 算法/ (/ Inferring/ _/ Ye/ )/ 和/ Xie/ 等/ 人/ 的/ 算法/ (/ Inferring/ _/ Xie/ )/ ,/ 其中/ Xie/ 的/ 算法/ 分别/ 选择/ a7/ (/ 1/ _/ AAN/ )/ ,/ a7/ 和/ a9/ (/ 2/ _/ AAN/ )/ 作为/ 具有/ AAN/ 节点/ 的/ 攻击/ 节点/ ./ 将/ 这/ 102/ 个/ 观测/ 序列/ 作为/ 输入/ ,/ 在/ 为/ 目标/ 节点/ 选择/ 不同/ 的/ 置信度/ 阈值/ 情况/ 下/ ,/ 3/ 个/ 算法/ 的/ 检测/ 结果/ 情况/ 如表/ 6/ 所示/ ./ 置信/ 阈值/ Inferring/ _/ OurInferring/ _/ YeInferring/ _/ Xie0/ ./ 5380.6260/ ./ 7220.8170/ ./ 9/ 从/ 结果/ 对比/ 表/ 6/ 中/ ,/ 首先/ 观察/ 到/ 的/ 是/ 我们/ 的/ 算法/ (/ Inferring/ _/ Our/ )/ 的/ 报警/ 数量/ 明显/ 要/ 比/ 其它/ 两种/ 算法/ 少/ ./ 通过/ 分析/ 那些/ 在/ 其它/ 算法/ 中/ 报警/ 但/ 我们/ 的/ 算法/ 中/ 没有/ 被/ 检测/ 出来/ 的/ 案例/ ,/ 发现/ 很多/ 在/ 叶云/ 等/ 人/ 的/ 算法/ 中/ 被/ 检测/ 命中/ 观测/ 序列/ ,/ 其/ 观测/ 事件/ 的/ 置信/ 概率/ 都/ 很/ 低/ ,/ 如/ 第/ 10/ 、/ 30/ 和/ 31/ 个/ 观测/ 序列/ (/ O10/ =/ {/ o2/ :/ 0.1/ }/ ,/ O30/ =/ {/ o4/ :/ 0.1/ }/ ,/ O31/ =/ {/ o4/ :/ 0.2/ }/ )/ ,/ 在/ In/ -/ ferring/ _/ Ye/ 和/ Inferring/ _/ Xie1AAN/ 都/ 检测/ 命中/ ,/ 而/ 在/ Inferring/ _/ Our/ 中/ 检测/ 结果/ 的/ 置信度/ 分别/ 为/ 35.5/ %/ 、/ 38.7/ %/ 和/ 44.4/ %/ ./ 这种/ 差别/ 的/ 原因/ 在于/ 其它/ 两种/ 算法/ 只/ 考虑/ 观测/ 事件/ 是否/ 发生/ ,/ 而/ 没有/ 考虑/ 观测/ 事件/ 的/ 置信度/ ,/ 这/ 也/ 正是/ 内部/ 攻击行为/ 检测/ 会/ 造成/ 大量/ 报警/ 日志/ 的/ 原因/ ./ 通过/ 利用/ 安全监控/ 软件/ 中/ 异常/ 检测/ 算法/ 提供/ 的/ 观测/ 事件/ 的/ 置信/ 概率/ ,/ 我们/ 的/ 算法/ 能/ 更/ 有效/ 地/ 检测/ 攻击/ 威胁/ ./ 另一方面/ ,/ 如果/ 网络安全/ 管理员/ 也/ 可以/ 通过/ 调节/ 攻击/ 目标/ 节点/ 的/ 置信/ 阈值/ 实现/ 捕获/ 更/ 多/ 攻击/ ./ 上/ 一/ 小节/ 的/ 实验/ 已经/ 表明/ 在/ 没有/ 任何/ 输入/ 事件/ (/ O1/ =/ {/ null/ }/ )/ 的/ 情况/ 下/ ,/ 概率/ 攻击/ 图/ 的/ 目标/ 节点/ 受到/ 攻击/ 的/ 概率/ 是/ 32.9/ %/ ./ 只要/ 选择/ 的/ 置信/ 阈值/ 等于/ 或/ 低于/ 32.9/ %/ ,/ 所有/ 的/ 攻击行为/ 都/ 会/ 被/ 检测/ 到/ ./ 其次/ ,/ 我们/ 的/ 算法/ 对/ 阈值/ 变化/ 的/ 敏感性/ 要/ 优于/ 其它/ 的/ 算法/ ./ 当/ 调节/ 阈值/ 从/ 0.5/ ~/ 0.9/ 时/ ,/ 我们/ 的/ 算法/ 给出/ 的/ 检测/ 结果/ 数量/ 从/ 38/ 降到/ 2/ ,/ 且/ 每/ 一次/ 阈值/ 调节/ 带来/ 的/ 变化/ 都/ 很/ 明显/ ./ 而/ 算法/ Inferring/ _/ Ye/ 和/ Inferring/ _/ Xie/ 则/ 表现/ 得/ 不/ 敏感/ ./ 这/ 也/ 是因为/ 这/ 两种/ 算法/ 仅/ 考虑/ 了/ 攻击/ 图/ 结构/ 的/ 不确定性/ ,/ 这些/ 不确定性/ 都/ 是/ 在/ 攻击/ 图/ 构造/ 过程/ 中/ 就/ 已经/ 固定/ 下来/ 了/ ,/ 因此/ ,/ 以上/ 两种/ 算法/ 的/ 计算/ 过程/ 对/ 输入/ 观测/ 序列/ 的/ 敏感性/ 不高/ ./ 而/ 我们/ 的/ 算法/ 更/ 重要/ 的/ 是/ 将/ 运行/ 期/ 监控/ 到/ 的/ 观测/ 事件/ 及其/ 置信/ 概率/ 作为/ 输入/ ,/ 可以/ 实时/ 计算/ 攻击/ 意图/ 和/ 攻击/ 路径/ ./ 算法/ 对/ 阈值/ 选择/ 的/ 敏感性/ 可以/ 帮助/ 网络安全/ 管理员/ 更快/ 地/ 找到/ 嫌疑/ 最大/ 的/ 攻击行为/ ,/ 提供/ 了/ 良好/ 的/ 可/ 配置/ 性/ ./ 5/ 结束语/ 内部/ 攻击行为/ 的/ 检测/ 面临/ 着/ 复杂性/ 和/ 不确定性/ Page10/ 的/ 挑战/ ./ 本文/ 描述/ 了/ 如何/ 在/ 目标/ 网络/ 中/ 根据/ 安全/ 专家/ 知识库/ 和/ 各种/ 安全监控/ 软件/ 的/ 实时/ 检测/ 结果/ 建立/ 概率/ 攻击/ 图/ ,/ 推断/ 攻击/ 意图/ 并/ 计算/ 可能/ 的/ 最大/ 概率/ 攻击/ 路径/ ./ 本文/ 提出/ 的/ 模型/ 和/ 算法/ 考虑/ 了/ 监测/ 事件/ 的/ 不确定性/ ,/ 可以/ 利用/ 现有/ 的/ 安全/ 监测/ 系统/ 的/ 异常/ 检测/ 功能/ ,/ 应对/ 内部/ 攻击行为/ 的/ 伪装/ 性/ 和/ 多/ 步骤/ 性/ 带来/ 的/ 挑战/ ./ 实验/ 结果表明/ 本文/ 的/ 工作/ 能够/ 有效/ 推断/ 攻击/ 意图/ 和/ 计算/ 攻击/ 路径/ ,/ 减少/ 不可/ 信/ 报警/ 数量/ ,/ 为/ 网络安全/ 管理员/ 提供/ 良好/ 的/ 可/ 配置/ 性/ ./ 本文/ 的/ 概率/ 攻击/ 图/ 模型/ 完全/ 依靠/ 专家/ 知识库/ 来/ 构建/ ,/ 这/ 对/ 在/ 大规模/ 网络/ 中/ 推广/ 使用/ 该/ 模型/ 有/ 一定/ 的/ 限制/ ,/ 未来/ 我们/ 开展/ 对/ 自动/ 构建/ 大规模/ 的/ 内部/ 攻击/ 概率/ 攻击/ 图以/ 试图/ 解决/ 该/ 问题/ ./ 本文/ 的/ 另/ 一个/ 限制/ 是/ 由于/ 缺乏/ 大规模/ 的/ 内部/ 攻击/ 公开/ 数据/ 集/ ,/ 算法/ 没有/ 在/ 公开/ 数据/ 集/ 得到/ 验证/ ./ 由于/ 安全/ 和/ 隐私/ 等/ 问题/ ,/ 安全/ 行为/ 分析/ 方面/ 的/ 公开/ 数据/ 集/ 一直/ 很少/ ,/ 据/ 我们/ 所知/ ,/ 仅/ 有/ KDD/ ’/ 99/ 的/ 入侵/ 检测/ 数据/ 集/ 得到/ 大家/ 的/ 广泛/ 认可/ ./ 而/ 这个/ 数据/ 集因/ 不/ 太/ 适用/ 于/ 本文/ 所提/ 的/ 内部/ 攻击/ 意图/ 推断/ ,/ 寻找/ 或者/ 构建/ 适合/ 内部/ 攻击/ 意图/ 推断/ 的/ 数据/ 集/ ,/ 并/ 建立/ 可/ 量化/ 的/ 评价/ 指标/ 也/ 是/ 我们/ 下/ 一步/ 的/ 工作/ 方向/ ./ 

