Page1Kad/ 网络/ 恶意/ 索引/ 节点/ 行为/ 研究/ 刘丙双/ 1/ )/ 韦韬/ 1/ )/ 邹维/ 2/ )/ 张/ 建宇/ 1/ )/ 周渊/ 3/ )/ 韩/ 心慧/ 1/ )/ 1/ )/ (/ 北京大学/ 计算机/ 科学技术/ 研究所/ 北京/ 100080/ )/ 2/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 3/ )/ (/ 国家/ 计算机网络/ 应急/ 技术/ 处理/ 协调/ 中心/ 北京/ 100029/ )/ 摘要/ 作为/ 当前/ 十分/ 流行/ 的/ P2P/ 文件共享/ 网络/ ,/ Kad/ 网络/ 容易/ 受到/ 来自/ 索引/ 节点/ 层面/ 的/ 攻击/ ./ 索引/ 节点/ 负责/ 存储资源/ 索引/ ,/ 并/ 响应/ 其他/ 节点/ 的/ 搜索/ 请求/ ,/ 其/ 行为/ 正确性/ 会/ 对/ P2P/ 网络/ 服务质量/ 产生/ 直接/ 的/ 影响/ ./ 文中/ 基于/ Anthill/ 测量/ 系统/ ,/ 从/ IMDb/ ,/ iTunes/ 和/ Amazon/ 网站/ 中/ 选取/ 热门资源/ 作为/ 测量/ 目标/ ,/ 在/ 真实/ Kad/ 网络/ 中/ 系统地/ 测量/ 和/ 分析/ 了/ 资源共享/ 过程/ 中/ 各类/ 节点/ 的/ 行为/ ;/ 通过/ 与/ 标准/ Kad/ 协议/ 进行/ 对比/ ,/ 对/ 节点/ 行为/ 的/ 正确性/ 进行/ 全面/ 验证/ ,/ 从而/ 获取/ 恶意/ 节点/ 的/ 行为/ 特征/ ./ 结果显示/ ,/ 目前/ Kad/ 网络/ 中/ 存在/ 两类/ 恶意/ 索引/ 节点/ :/ 选择性/ 拒绝服务/ 节点/ 和/ 无/ 意义/ 应答/ 节点/ ./ 这/ 两类/ 节点/ 广泛/ 存在/ 于/ Kad/ 网络/ 中/ ,/ 总数/ 高/ 达/ 数十万/ ,/ 并且/ 其/ 攻击行为/ 具有/ 相当/ 的/ 隐蔽性/ ,/ 严重/ 干扰/ 了/ 正常/ 文件/ 搜索/ 和/ 下载/ 过程/ ./ 文中/ 对/ 两类/ 节点/ 的/ 行为/ 特征/ 进行/ 了/ 深入分析/ ,/ 并/ 在/ 此基础/ 上/ ,/ 提出/ 了/ 针对性/ 较强/ 、/ 易于/ 部署/ 的/ 防御/ 方法/ ./ 关键词/ 对/ 等/ 网络/ ;/ 文件共享/ ;/ Kad/ ;/ 索引/ 节点/ ;/ 索引/ 污染/ ;/ 信息安全/ ;/ 网络安全/ 1/ 引言/ DHT/ (/ DistributedHashTable/ ,/ 分布式/ Hash/ 表/ )/ 已经/ 成为/ 目前/ 主流/ 的/ P2P/ 文件共享/ 网络/ 中/ 资源/ 查找/ 和/ 定位/ 的/ 核心技术/ ./ 其/ 摆脱/ 了/ 传统/ 非/ 结构化/ P2P/ 网络/ 对/ 中心化/ 索引/ 服务器/ 的/ 依赖/ ,/ 具有/ 良好/ 的/ 可扩展性/ 和/ 强/ 容错/ 机制/ ,/ 较/ 好/ 地/ 实现/ 了/ Log/ (/ N/ )/ 级别/ 的/ 节点/ 定位/ 和/ 资源/ 查找/ 操作/ ./ 在/ 众多/ 的/ DHT/ 协议/ [/ 1/ -/ 4/ ]/ 中/ ,/ 只有/ Kademlia/ 协议/ [/ 4/ ]/ 在/ 实际/ 互联网/ 环境/ 中/ 得到/ 了/ 大规模/ 部署/ 和/ 应用/ ./ 目前/ ,/ 广为/ 流行/ 的/ eMule/ ①/ 和/ BT/ ②/ 文件共享/ 系统/ 都/ 已经/ 实现/ 了/ 该/ 协议/ ,/ 二者/ 在/ 实现/ 上/ 有/ 一些/ 细微差别/ ,/ 其/ 构成/ 的/ 网络/ 分别/ 被/ 称为/ eMule/ -/ Kad/ 网络/ (/ 简称/ Kad/ 网络/ )/ 和/ MainlineDHT/ 网络/ ./ 然而/ ,/ 在/ P2P/ 文件共享/ 取得/ 巨大成功/ 的/ 同时/ ,/ 其/ 存在/ 的/ 安全/ 问题/ 同样/ 不容忽视/ ./ 在/ 一个/ 缺少/ 中心化/ 认证/ 和/ 授权/ 机制/ 、/ 完全/ 开放/ 的/ 网络/ 中/ ,/ 恶意/ 节点/ 可以/ 用/ 很小/ 的/ 代价/ 实施/ 对/ 整个/ 网络/ 的/ 攻击/ ./ 在/ 其/ 面临/ 的/ 各种/ 安全/ 威胁/ 中/ ,/ 对/ 索引/ 信息/ 存取/ 过程/ 的/ 破坏/ ,/ 即/ 攻击者/ 通过/ 一定/ 手段/ 阻碍/ 用户/ 快速/ 地/ 、/ 正确/ 地/ 发布/ 或/ 获取/ 共享资源/ ,/ 已经/ 严重/ 干扰/ 了/ P2P/ 网络/ 的/ 可用性/ 和/ 服务质量/ ./ 文献/ [/ 5/ ]/ 早/ 在/ 2006/ 年/ 就/ 明确指出/ ,/ 在/ 当前/ 主流/ P2P/ 文件共享/ 网络/ 中/ ,/ 存在/ 着/ 普遍/ 的/ 索引/ 污染/ 现象/ ./ 由于/ 巨大/ 的/ 利益冲突/ ,/ 以/ 美国电影协会/ (/ MPAA/ )/ 和/ 美国/ 唱片业/ 协会/ (/ RIAA/ )/ 为/ 代表/ 的/ 版权保护/ 组织/ ,/ 对/ 处于/ 版权保护/ 有效期/ 内/ 的/ 电影/ 和/ 音乐/ 资源/ ,/ 采取/ 了/ 各种/ 手段/ 干扰/ P2P/ 文件共享/ 网络/ 的/ 正常/ 服务/ ./ 文献/ [/ 6/ ]/ 也/ 明确指出/ 在/ Kad/ 网络/ 中/ 27/ %/ ~/ 35/ %/ 的/ 索引/ 条目/ 是/ 被/ 污染/ 的/ ./ 在/ Kad/ 网络/ 中/ ,/ 索引/ 信息/ 的/ 存取/ 过程/ 涉及/ 两类/ 节点/ :/ 发布/ 节点/ 和/ 索引/ 节点/ ./ 针对/ 索引/ 信息/ 的/ 安全/ 问题/ ,/ 现有/ 研究/ 工作/ 大多/ 集中/ 在/ 发布/ 节点/ 上/ ,/ 攻击/ 形式/ 主要/ 为/ 索引/ 污染/ ,/ 即/ 恶意/ 发布/ 节点/ 主动/ 发布/ 大量/ 虚假/ 索引/ 信息/ ,/ 干扰/ 文件/ 搜索/ 和/ 下载/ 过程/ ./ 然而/ 从/ 另一方面/ 来看/ ,/ 恶意/ 索引/ 节点/ 在/ 该/ 过程/ 中/ 可能/ 产生/ 的/ 威胁/ 却/ 没有/ 得到/ 足够/ 的/ 重视/ ./ 索引/ 节点/ 负责/ 存储资源/ 索引/ ,/ 并/ 响应/ 其它/ 节点/ 的/ 搜索/ 请求/ ,/ 其/ 行为/ 的/ 正确/ 与否/ 将/ 直接/ 影响/ P2P/ 网络/ 的/ 服务质量/ ./ 本文/ 利用/ Anthill/ 测量/ 系统/ ,/ 在/ 实际/ Kad/ 网络/ 中/ 对/ 恶意/ 索引/ 节点/ 的/ 行为/ 进行/ 了/ 系统地/ 测量/ 和/ 分析/ ./ 测量/ 结果显示/ ,/ 当前/ Kad/ 网络/ 中/ 存在/ 大量/ 恶意/ 索引/ 节点/ ,/ 总数/ 高/ 达/ 数十万/ ./ 对/ 这些/ 节点/ 的/ 行为/ 特征/ 进行/ 全面/ 分析/ 后/ ,/ 发现/ 目前/ Kad/ 网络/ 中/ 存在/ 两类/ 恶意/ 索引/ 节点/ :/ 选择性/ 拒绝服务/ 节点/ (/ SDoS/ 节点/ ,/ 简称/ S/ -/ 节点/ )/ 和/ 无/ 意义/ 应答/ 节点/ (/ MeaninglessResponse/ 节点/ ,/ 简称/ M/ -/ 节点/ )/ ./ 最后/ ,/ 在/ 行为/ 特征分析/ 的/ 基础/ 上/ ,/ 提出/ 了/ 有效/ 的/ 防御/ 方法/ ./ 本文/ 第/ 2/ 节/ 主要/ 介绍/ Kad/ 网络/ 背景/ 知识/ ;/ 第/ 3/ 节/ 介绍/ 相关/ 的/ 研究/ 工作/ ;/ 第/ 4/ 节/ 主要/ 描述/ Anthill/ 测量/ 系统/ 和/ 实验/ 过程/ 及/ 结果/ ;/ 第/ 5/ 节在/ 测量/ 的/ 基础/ 上/ 对/ 恶意/ 索引/ 节点/ 的/ 行为/ 进行/ 全面/ 的/ 分析/ ;/ 第/ 6/ 节/ 给出/ 相应/ 的/ 防御/ 措施/ ;/ 最后/ 对本/ 工作/ 进行/ 总结/ ./ 2Kad/ 网络/ 背景/ 简介/ Kad/ 网络/ 中/ 的/ 每个/ 节点/ 通过/ 对/ 一个/ 随机数/ 进行/ Hash/ ,/ 得到/ 一个/ 128/ 位/ 二进制/ 数/ 作为/ 其/ 节点/ ID/ ./ 网络/ 中/ 存在/ 关键词/ 和/ 文件/ 两类/ 目标/ ./ 前者/ 根据/ 关键词/ 文本/ 的/ Hash/ 值得/ 到/ 其/ 关键词/ ID/ ,/ 而/ 后者/ 则/ 通过/ 对/ 文件/ 内容/ 进行/ Hash/ 获得/ 其/ 文件/ ID/ ./ 在/ 理想/ 情况/ 下/ ,/ 节点/ 、/ 关键词/ 和/ 文件/ ID/ 在/ 同一个/ 128/ 位/ ID/ 空间/ 内/ 是/ 全局/ 唯一/ 的/ ./ 通过/ 按位/ 异或/ 操作/ XOR/ ,/ ID/ 之间/ 的/ 距离/ 可以/ 被/ 量化/ ,/ 计算结果/ 越小/ 表明/ 二者/ 在/ 逻辑/ ID/ 空间/ 中/ 越/ 接近/ ./ 在/ Kad/ 网络/ 中/ ,/ 两类/ 基本/ 的/ 操作/ :/ 发布/ 和/ 搜索/ ,/ 均/ 需/ 首先/ 通过/ 路由/ 过程/ 定位/ 距离/ 其/ 操作/ 目标/ 最近/ 的/ 节点/ 集合/ ./ Kad/ 的/ 路由/ 算法/ 采用/ 基于/ 迭代/ 的/ 贪心/ 算法/ ./ 在/ 路由/ 过程/ 中/ ,/ 每个/ 中间/ 节点/ 从/ 自身/ 路由表/ 中/ 获取/ 一定/ 数量/ 的/ 距离/ 目标/ 较近/ 的/ 节点/ 返回/ 给/ 路由/ 发起者/ ,/ 随后/ 路由/ 发起者/ 从/ 这些/ 候选/ 节点/ 中/ 选择/ 较近/ 的/ 继续/ 发送/ 路由/ 请求/ ./ 该/ 过程/ 会/ 一直/ 迭代/ 下去/ ,/ 直到/ 发起者/ 无法/ 找到/ 更/ 接近/ 的/ 节点/ 为止/ ./ Kad/ 使用/ 如图/ 1/ 所示/ 的/ “/ 关键词/ -/ 文件/ ”/ 和/ “/ 文件/ -/ 来源/ ”/ 两级/ 索引/ 结构/ 管理/ 索引/ 信息/ ,/ 帮助/ 用户/ 快速/ 查找/ 和/ 定位/ 欲/ 下载/ 的/ 资源/ ./ 基于/ 如/ 上/ 索引/ 结构/ ,/ Kad/ 支持/ “/ 发布/ ”/ 和/ “/ 搜索/ ”/ 两个/ 基本操作/ ./ 发布/ 节点/ 通过/ 路由/ 过程/ 定位/ 距离/ 目标/ 最近/ 的/ 若干/ 节点/ ,/ 把/ 索引/ 信息/ 发布/ 到/ 这些/ 节点/ 上/ ,/ 使/ 之/ 成为/ 该/ 资源/ 的/ 索引/ 节点/ (/ 每次/ 发布/ 选择/ 的/ 索引/ 节点/ 数量/ 上限/ 为/ 10/ )/ ./ 而/ 索引/ 节点/ 则/ 负责/ 维护/ 自身/ 存储/ 的/ 索引/ 信息/ ,/ 并/ 响应/ 其他/ 节点/ 的/ 资源/ 搜索/ 请求/ ./ 以/ 电影/ “/ 阿凡/ 达/ ./ avi/ ”/ 举/ ①/ ②/ Page3/ 例/ 说明/ ,/ 整个/ 下载/ 过程/ 如下/ :/ 首先/ ,/ 用户/ 在/ 客户端/ 搜索/ 框中/ 输入/ “/ 阿凡/ 达/ ”/ ,/ 客户端/ 对/ 该/ 关键词/ 进行/ Hash/ 后/ 获得/ 关键词/ ID/ ,/ 定位/ 候选/ 索引/ 节点/ 集合/ 后/ ,/ 向/ 其/ 发送/ 文件/ 搜索/ 请求/ ,/ 索引/ 节点/ 通过/ 检索/ 本地/ 存储/ 的/ “/ 文件/ 索引/ ”/ 列表/ ,/ 返回/ 若干/ 候选/ 视频文件/ 信息/ ;/ 然后/ ,/ 用户/ 从/ 该/ 列表/ 中/ 选择/ 欲/ 下载/ 的/ 文件/ 执行/ 文件/ 来源/ 搜索/ ./ 同样/ 过程/ ,/ 用户/ 获得/ 一定/ 数量/ 的/ “/ 文件/ 来源/ 信息/ ”/ 后/ ,/ 开始/ 从/ 这些/ 来源/ 处/ 直接/ 下载/ 该/ 文件/ ./ 在/ Kad/ 网络/ 中/ 文件/ 搜索/ 和/ 文件/ 来源/ 搜索/ 每次/ 获得/ 的/ 索引/ 信息/ 条目/ 数量/ 上限/ 为/ 300/ ./ 文件/ 的/ 发布/ 过程/ 与/ 下载/ 过程/ 类似/ ,/ 此处/ 不再/ 赘述/ ./ 3/ 相关/ 工作/ P2P/ 文件共享/ 网络/ 自/ 诞生/ 之日起/ ,/ 就/ 受到/ 了/ 广大/ 互联网/ 用户/ 的/ 青睐/ ,/ 同时/ 其/ 安全/ 问题/ 也/ 受到/ 国内外/ 学术界/ 和/ 工业界/ 的/ 重视/ ./ Urdaneta/ 等/ 人/ [/ 7/ ]/ 总结/ 了/ DHT/ 领域/ 的/ 安全/ 问题/ 和/ 防御/ 方法/ ,/ 主要/ 包括/ Sybil/ 攻击/ [/ 8/ ]/ 、/ Eclipse/ 攻击/ 以及/ 路由/ 和/ 存储/ 攻击/ [/ 9/ -/ 10/ ]/ ./ 本文/ 主要/ 关注/ 的/ 安全/ 威胁/ 是/ 恶意/ 节点/ 对/ 索引/ 信息/ 存取/ 过程/ 的/ 干扰/ 和/ 破坏/ ./ 下面/ 将/ 从/ 发布/ 节点/ 和/ 索引/ 节点/ 两/ 方面/ 阐述/ 相关/ 研究/ 工作/ ./ 从/ 发布/ 节点/ 来讲/ ,/ 主要/ 的/ 攻击/ 方法/ 是/ 索引/ 污染/ ./ 该/ 攻击/ 的/ 表现形式/ 为/ :/ 针对/ 某些/ 特定/ 的/ 文件/ ,/ 恶意/ 发布/ 节点/ 通过/ 在/ 网络/ 中/ 发布/ 大量/ 虚假/ 或者/ 错误/ 的/ 索引/ 信息/ ,/ 干扰/ 用户/ 正常/ 的/ 搜索/ 过程/ ,/ 最终/ 导致用户/ 无法/ 定位/ 和/ 下载/ 正确/ 的/ 文件/ ./ 在/ 此/ 过程/ 中/ ,/ 索引/ 节点/ 只是/ 单纯/ 地/ “/ 存储/ ”/ 和/ “/ 转发/ ”/ 这些/ 异常/ 的/ 索引/ 信息/ ./ Liang/ 等/ 人/ [/ 5/ ,/ 11/ ]/ 最早/ 于/ 2006/ 年/ 就/ 指出/ P2P/ 文件共享/ 网络/ 中/ 存在/ 广泛/ 的/ 索引/ 污染/ 攻击/ ./ 其/ 通过/ 研究/ FastTrack/ 和/ Overnet/ 网络/ 中/ 10/ 首/ 最/ 流行歌曲/ 的/ 污染/ 情况/ ,/ 发现/ 70/ %/ ~/ 90/ %/ 相同/ 文件名/ 的/ 文件/ 都/ 受到/ 了/ 索引/ 污染/ 攻击/ ,/ 且/ Overnet/ 中/ 污染/ 更加/ 严重/ ./ Thomas/ 等/ 人/ [/ 12/ ]/ 在/ 真实/ 的/ Kad/ 网络/ 中/ 对/ 索引/ 污染/ 攻击/ 效果/ 进行/ 了/ 测量/ ,/ 证明/ 了/ 通过/ 持续/ 向/ 目标/ 节点/ 发布/ 虚假/ 索引/ 信息/ ,/ 可以/ 完全/ 阻断/ 网络/ 中/ 其他/ 用户/ 对/ 特定/ 资源/ 的/ 访问/ ./ Guillaume/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 一种/ 测量/ Kad/ 网络/ 中/ 索引/ 污染/ 攻击/ 的/ 方法/ ,/ 发现/ 真实/ Kad/ 网络/ 中/ 流行/ 度/ 最高/ 的/ 1000/ 个/ 文件/ 有/ 2/ // 3/ 的/ 文件/ 索引/ 信息/ 被/ 污染/ ./ 目前/ 对/ P2P/ 网络/ 恶意/ 节点/ 行为/ 研究/ 大多/ 集中/ 在/ 发布/ 节点/ 上/ ,/ 这/ 很大/ 程度/ 上/ 与/ 大量/ 版权保护/ 组织/ 实施/ 的/ 索引/ 污染/ 攻击/ 相关/ ./ 然而/ ,/ 正常/ 的/ 索引/ 信息/ 存取/ 过程/ 不仅/ 与/ 发布/ 节点/ 相关/ ,/ 负责/ 存储/ 并/ 对/ 响应/ 查询/ 请求/ 的/ 索引/ 节点/ 同样/ 不容忽视/ ./ 当前/ 从/ 恶意/ 索引/ 节点/ 层面/ 展开/ 的/ 研究/ 工作/ 相对/ 较/ 少/ ,/ 并且/ 绝大多数/ 研究/ [/ 12/ ,/ 14/ -/ 17/ ]/ 均/ 只是/ 从/ 理论/ 上/ 指出/ :/ Kad/ 网络/ 可能/ 存在/ 恶意/ 索引/ 节点/ ,/ 通过/ 主动/ 篡改/ 文件/ 元/ 信息/ 或/ 来源/ 信息/ 干扰/ 资源/ 搜索/ 过程/ 、/ 甚至/ 利用/ P2P/ 网络/ 发起/ DDoS/ 攻击/ ./ 但是/ 在/ 实际/ 网络/ 中/ 对/ 该类/ 节点/ 的/ 捕获/ 和/ 攻击行为/ 的/ 测量/ 分析/ 工作/ 并/ 没有/ 展开/ ./ 本文/ 作者/ 前期/ 的/ 研究/ [/ 18/ -/ 19/ ]/ 是/ 在/ 测量/ Kad/ 网络/ 查询/ 可靠性/ 的/ 过程/ 中/ ,/ 采用/ 随机/ 生成/ 目标/ 的/ 方式/ ,/ 利用/ Anthill/ 测量/ 系统/ 首次/ 在/ 实际/ Kad/ 网络/ 中/ 发现/ 并/ 确认/ 了/ 一种/ 新型/ 的/ 恶意/ 索引/ 节点/ :/ 选择性/ 拒绝服务/ 节点/ ./ 本文/ 在/ 前期工作/ 的/ 基础/ 上/ ,/ 利用/ 改进/ 的/ Anthill/ 实验/ 平台/ ,/ 有/ 针对性/ 地/ 选取/ 了/ 具有/ 版权/ 信息/ 的/ 热门/ 电影/ 和/ 音乐/ 等/ 资源/ ,/ 在/ 真实/ Kad/ 网络/ 中/ 深入研究/ 该类/ 节点/ 的/ 行为/ 特征/ ,/ 并/ 进一步/ 挖掘/ 了/ 其他/ 类型/ 恶意/ 索引/ 节点/ 行为/ ./ 在/ 恶意/ 节点/ 的/ 防御/ 方面/ ,/ 研究/ 工作/ 主要/ 集中/ 在/ 黑名单/ [/ 5/ ]/ 、/ 信誉/ 系统/ [/ 16/ ,/ 20/ -/ 23/ ]/ 和/ 协同/ 过滤/ [/ 6/ ,/ 24/ ]/ 等/ 方面/ ./ 这些/ 方法/ 需要/ 引入/ 中心化/ 认证/ 服务器/ ,/ 或/ 新/ 的/ 控制协议/ ,/ 导致/ 与/ 现有/ Kad/ 网络/ 不/ 兼容/ ,/ 实施/ 代价/ 过高/ ,/ 最终/ 无一/ 在/ 实际/ 网络/ 中/ 得到/ 部署/ 和/ 应用/ ./ 目前/ Kad/ 网络/ 采用/ 的/ 仍然/ 是/ 非常/ 初级/ 的/ 基于/ 目标/ 的/ 信誉/ 模型/ ,/ 通过/ 下载/ 用户/ 对/ 某项/ 资源/ 打分/ 进行/ 信誉/ 模型/ 的/ 构建/ ./ 但/ 在/ 用户/ 实际/ 使用/ 过程/ 中/ ,/ 该/ 机制/ 由于/ 作用/ 有限/ ,/ 且/ 使用/ 起来/ 较/ 繁琐/ ,/ 因此/ 该/ 信誉/ 机制/ 在/ Kad/ 广大/ 用户/ 群体/ 中/ 并/ 没有/ 得到/ 普及/ ./ 本文/ 在/ 恶意/ 节点/ 行为/ 特征分析/ 的/ 基础/ 上/ ,/ 提出/ 了/ 富有/ 针对性/ 、/ 可/ 部署/ 性/ 良好/ 的/ 解决方案/ ,/ 并/ 在/ 真实/ 的/ eMule/ 客户端/ 上/ 加以/ 实现/ ,/ 有效/ 遏制/ 了/ 恶意/ 索引/ 节点/ 对/ Kad/ 网络/ 的/ 干扰/ 和/ 破坏/ ./ 4/ 测量/ 系统/ 和/ 实验/ 4.1/ Anthill/ 测量/ 系统/ 在/ 我们/ 的/ 工作/ [/ 18/ ]/ 中/ ,/ 为了/ 测量/ Kad/ 网络/ 查询/ 可靠性/ ,/ 设计/ 了/ Anthill/ 测量/ 系统/ ./ 该/ 系统/ 基于/ eMule/ (/ Kad/ 网络/ 跨平台/ 开源/ 客户端/ ,/ 最新/ 版本/ 为/ 2.3/ ./ 1/ )/ 客户端/ 创建/ Anthill/ 发布/ 和/ 搜索/ 节点/ ,/ 在/ Kad/ 网络/ Page4/ 中/ 灵活/ 地/ 与/ 其它/ 节点/ 进行/ 交互/ ,/ 执行/ 特定/ 目标/ 的/ 发布/ 和/ 搜索/ 任务/ ;/ 借助/ Kad/ 网络日志/ 和/ Graphviz/ 可视化/ 技术/ ①/ ,/ 完整/ 展示/ 发布/ 和/ 搜索/ 过程/ ,/ 进而/ 分析/ 其中/ 潜在/ 的/ 恶意/ 节点/ 行为/ ./ 在/ Anthill/ 中/ ,/ 针对/ 一个/ 目标/ 的/ 发布/ 操作/ 与/ 搜索/ 操作/ 合/ 起来/ 称为/ 一个/ “/ 任务/ ”/ ./ 其/ 标准/ 工作/ 流程/ 可/ 参见/ 图/ 2/ ,/ 说明/ 如下/ :/ (/ 1/ )/ 根据/ 事先/ 选定/ 的/ 测量/ 目标/ 生成/ 任务/ 集合/ ;/ (/ 2/ )/ 创建/ 发布/ 节点/ 组和/ 搜索/ 节点/ 组/ ,/ 每组/ 包含/ 相同/ 数量/ 的/ 节点/ ;/ 图/ 2Anthill/ 工作/ 流程图/ 为了/ 更/ 灵活/ 有效/ 地/ 测量/ 和/ 优化/ Kad/ 网络/ ,/ Anthill/ 充分利用/ 了/ 模块化/ 、/ 参数/ 化/ 方法/ ,/ 通过/ 添加/ 必要/ 的/ 模块/ ,/ 如/ 消息/ 重/ 发/ 、/ 邻域/ 搜索/ 等/ ,/ 改进/ 现有/ Kad/ 的/ 搜索/ 能力/ 和/ 效率/ ./ 表/ 1/ 列举/ 了/ 实验/ 过程/ 中/ 涉及/ 到/ 的/ 一系列/ 参数/ 及其/ 说明/ ,/ 包括/ 关键/ 的/ Kad/ 网络/ 参数/ 和/ Anthill/ 主要/ 模块/ 的/ 参数/ ./ 2/ (/ 搜索/ )/ 从/ 下/ 一/ 跳/ 节点/ 请求/ 返回/ 的/ 节点/ 数量/ 符号/ 默认值/ α/ 3/ 路由/ 并行度/ β/ 4/ (/ 发布/ )/ ;/ γ/ 10/ 每次/ 发布/ 时/ 索引/ 节点/ 上限/ τ/ 3/ 路由/ 收敛/ 超时/ 时间/ // s/ ρ/ 140/ 发布/ 过程/ 超时/ 时间/ // s/ η/ 45/ 搜索/ 过程/ 超时/ 时间/ // s/ κ/ 1.5/ Kad/ 请求/ 超时/ 时间/ // s/ ν/ 否/ 是否/ 爬取/ 索引/ 节点/ 路由表/ 以/ 获取/ 更/ 多/ 索引/ 节点/ λ/ 0Kad/ 请求/ 包/ 重传/ 次数/ θ/ 128/ 执行/ 邻域/ 发布/ 和/ 搜索/ 的/ 区域/ ,/ 此/ 区域/ 大小/ 从/ δ/ 是/ 是否/ 需要/ Anthill/ 为/ 每个/ 任务/ 执行/ 发布/ 操作/ (/ 3/ )/ 发布/ 节点/ 组中/ 某个/ 空闲/ 的/ 发布/ 节点/ 从/ 任务/ 集合/ 中/ 选择/ 一个/ 未/ 被/ 执行/ 的/ 任务/ ,/ 在/ Kad/ 网络/ 中/ 执行/ 发布/ 操作/ ;/ (/ 4/ )/ 一旦/ 完成/ 某个/ 任务/ 的/ 发布/ 操作/ ,/ 发布/ 节点/ 立即/ 通知/ 某个/ 空闲/ 的/ 搜索/ 节点/ 对/ 该/ 目标/ 执行/ 搜索/ ./ 图/ 2/ 中/ 显示/ 1/ 号/ 和/ 2/ 号/ 任务/ 成功/ 完成/ ,/ 而/ 3/ 号/ 任务/ 却/ 由于/ 某些/ 原因/ 导致/ 搜索/ 失败/ ;/ (/ 5/ )/ 在/ 此/ 过程/ 中/ ,/ 日志/ 模块/ 记录/ 所有/ Kad/ 网络流量/ ,/ 为/ 每个/ 任务/ 生成/ 一个/ KadTrace/ 文件/ ,/ 以便/ 后续/ 分析/ ./ 4.2/ 实验/ 设置/ 4.2/ ./ 1/ 运行/ 环境/ Anthill/ 测量/ 系统/ 运行/ 在/ 一台/ Linux/ 服务器/ 上/ ,/ 其/ 硬件/ 配置/ 为/ Intel/ (/ R/ )/ Xeon/ (/ R/ )/ CPUE56452/ ./ 40GHz/ ,/ 32GBRAM/ ,/ 500GBSATA2HardDisk/ ./ 搜索/ 节点/ 组和/ 发布/ 节点/ 组各有/ 32/ 个/ 被/ 改造/ 过/ 的/ eMule/ 节点/ ./ 每个/ 节点/ 的/ ID/ 均/ 不同/ ,/ 各自/ 维护/ 独立/ 的/ 路由表/ ,/ 通过/ 一条/ 独占/ 的/ 4MbpsADSL/ 链路/ 直接/ 连接/ Internet/ ,/ 避免/ 防火墙/ 对/ 测量/ 产生/ 影响/ ./ 4.2/ ./ 2/ 测量/ 目标/ 的/ 选取/ 相关/ 研究/ 工作/ 显示/ ,/ 处于/ 版权保护/ 期内/ 的/ 资源/ 更/ 容易/ 被/ 污染/ ,/ 因此/ 为了/ 最大/ 限度/ 揭示/ 当前/ Kad/ 网络/ 中/ 恶意/ 索引/ 节点/ 现状/ ,/ 我们/ 选择/ 了/ 著名/ 电影/ 数据库/ IMDb/ 中/ 当前/ 上映/ 的/ 电影/ ②/ 、/ 苹果/ 音乐/ 商店/ iTunes/ ①/ ②/ Page5/ 中/ Top100/ 歌曲/ ①/ 和/ 亚马逊/ 网上商城/ 中/ 热销/ 的/ 电子游戏/ 软件/ ②/ 等/ 资源/ 作为/ 测量/ 目标/ ./ 首先/ ,/ 对/ 资源/ 名字/ 进行/ 切词/ 以/ 获得/ 关键词/ 集合/ ,/ 过滤/ 掉/ 其中/ 无/ 意义/ 的/ 关键词/ ,/ 如/ the/ ,/ an/ ,/ of/ 等/ ,/ 对/ 余下/ 的/ 关键词/ 进行/ Hash/ 获得/ 关键词/ ID/ ,/ 生成/ “/ 关键词/ 任务/ ”/ (/ 通过/ 该/ ID/ 发布/ 或/ 搜索/ 相关/ 文件/ 索引/ )/ ;/ 接下来/ ,/ 使用/ 资源/ 名字/ 在/ Kad/ 网络/ 中/ 搜索/ 获得/ 相关/ 文件/ 信息/ ,/ 选择/ 可用/ 源数/ 大于/ 50/ 的/ 文件/ 作为/ 目标/ 文件/ ,/ 获得/ 其/ 文件/ ID/ ,/ 生成/ “/ 文件/ 任务/ ”/ (/ 通过/ 该/ ID/ 发布/ 和/ 搜索/ 相关/ 的/ 文件/ 来源/ 索引/ )/ ./ 表/ 2/ 给出/ 了/ 测量/ 目标/ 选取/ 的/ 总体/ 情况/ ./ 来源/ 日期/ 资源/ 数量/ 关键词/ 任务/ 文件/ 任务/ IMDb2013/ // 3/ // 221626102iTunes2013/ // 3/ // 2510068120/ / Amazon2013/ // 6/ // 163282189/ 注/ :/ 由于/ 服务器资源/ 限制/ ,/ 表中带/ “/ / ”/ 仅/ 包括/ 与/ Top15/ 歌曲/ 相关/ 的/ 文件/ ./ 4.3/ 实验/ 过程/ 及/ 结果/ 本文/ 在/ 对/ Kad/ 网络/ 节点/ 行为/ 进行/ 测量/ 的/ 过程/ 中/ ,/ 共/ 发现/ 两类/ 恶意/ 索引/ 节点/ :/ S/ -/ 节点/ 和/ M/ -/ 节点/ ./ 关于/ 二者/ 的/ 行为/ 特征分析/ 将/ 在/ 下/ 一节/ 详细/ 讨论/ ./ 为了/ 证明/ 这/ 两类/ 节点/ 在/ Kad/ 网络/ 中/ 的/ 广泛/ 存在/ 性/ 和/ 测量/ 其/ 行为/ 特征/ ,/ 本文/ 利用/ Anthill/ 测量/ 系统/ 设计/ 了/ 如下/ 两个/ 实验/ ./ 实验/ 1/ ./ S/ -/ 节点/ 测量/ 实验/ ./ 该/ 实验/ 主要/ 用来/ 测量/ Kad/ 网络/ 中/ 是否/ 存在/ S/ -/ 节点/ ,/ 该类/ 节点/ 故意/ 拒绝/ 应答/ 针对/ 某些/ 资源/ 的/ 搜索/ 请求/ ./ 实验/ 过程/ 中/ ,/ 在/ 标准/ Kad/ 网络/ (/ 参数设置/ 参见/ 表/ 1/ 中/ 的/ 默认值/ )/ 中/ 引入/ 了/ 消息/ 重/ 发/ 机制/ ,/ 即/ λ/ 设置/ 为/ 3/ ,/ 用以/ 消除/ 广泛/ 存在/ 的/ 底层/ 物理/ 网络/ 丢包/ 和/ 其他/ 偶然/ 因素/ 的/ 影响/ ./ 关于/ 消息/ 重/ 发/ 机制/ 的/ 引入/ ,/ 细节/ 可/ 参考文献/ [/ 18/ ]/ ./ 实验/ 流程/ 与/ 标准/ Anthill/ 实验/ 流程/ 一致/ ./ 在/ 此/ 过程/ 中/ ,/ 为了/ 确保/ 搜索/ 节点/ 得到/ 的/ 索引/ 信息/ 确实/ 来自/ Anthill/ 发布/ 节点/ ,/ 发布/ 的/ 索引/ 条目/ 结构/ 必须/ 具有/ 一定/ 特殊性/ ,/ 以/ 区分/ 现有/ 网络/ 中该/ 目标/ 的/ 其他/ 无关/ 索引/ 条目/ ./ 本文/ 采用/ 的/ 索引/ 结构/ 主要/ 有/ 以下/ 特征/ :/ 文件名/ 包含/ 某/ 一个/ 特定/ 字符串/ Anthill/ _/ test/ ,/ 文件大小/ 为/ 343434/ 字节/ ,/ 文件/ 来源/ 节点/ IP/ 为/ 1.1/ ./ 1.1/ ./ 实验/ 2/ ./ M/ -/ 节点/ 测量/ 实验/ ./ 该/ 实验/ 主要/ 是/ 用来/ 测量/ Kad/ 网络/ 中/ 是否/ 存在/ M/ -/ 节点/ ,/ 该类/ 节点/ 恶意/ 返回/ 虚假/ 的/ 、/ 无/ 意义/ 的/ 索引/ 信息/ ,/ 干扰/ 正常/ 搜索/ 过程/ ./ 为了/ 最大/ 限度/ 获取/ 索引/ 节点/ 的/ 数量/ 及其/ 行为/ ,/ 实验/ 采取/ 了/ 一系列/ 措施/ ,/ 涉及/ 到/ 的/ 主要参数/ 如下/ {/ β/ :/ 4/ ,/ η/ :/ 1200/ ,/ ν/ :/ 是/ ,/ λ/ :/ 3/ ,/ θ/ :/ 8/ ,/ δ/ :/ 否/ }/ ,/ 其余/ 设置/ 与表/ 1/ 相同/ ./ 这些/ 措施/ 包括/ :/ 增强/ 路由/ 能力/ ,/ 延长/ 每轮/ 搜索/ 超时/ 时间/ ,/ 爬取/ 已知/ 索引/ 节点/ 路由表/ 以/ 获取/ 更/ 多/ 新/ 的/ 索引/ 节点/ 等/ ./ 测量/ 结果显示/ ,/ 改进/ 后/ 每个/ 搜索/ 过程/ 平均/ 获取/ 的/ 索引/ 节点/ 数量/ 为/ 234.6/ 个/ ,/ 而/ 标准/ Kad/ 中该/ 值仅/ 为/ 8.3/ 个/ ./ 按照/ 上述/ 实验/ 过程/ ,/ 使用/ Anthill/ 系统/ 在/ 真实/ Kad/ 网络/ 中对表/ 2/ 中/ 587/ 个/ 关键词/ 和/ 文件/ 目标/ 进行/ 了/ 测量/ ./ 实验/ 过程/ 记录/ 了/ 全部/ Kad/ 流量/ 数据/ ,/ 包括/ 返回/ 的/ 详细/ 索引/ 信息/ ,/ 执行/ 这些/ 任务/ 产生/ 约/ 40GB/ 的/ KadTrace/ 文件/ ./ 在此期间/ 为了/ 避免/ 带宽/ 对/ 测量/ 产生/ 影响/ ,/ 每个/ 发布/ 节点/ 和/ 搜索/ 节点/ 在/ 同一/ 时刻/ 只/ 执行/ 一个/ 任务/ ,/ 因此/ 一次/ 完整/ 测量/ 会/ 持续/ 5h/ 左右/ ./ 另外/ 为了/ 消除/ 不同/ 地点/ 对/ 测量/ 结果/ 的/ 影响/ ,/ 同时/ 也/ 为了/ 分析/ 节点/ 对/ 来自/ 不同/ 地理位置/ 的/ 请求/ 是否/ 具有/ 不同/ 的/ 行为/ ,/ 本文/ 所有/ 实验/ 均/ 在/ 北京/ 和/ 海南/ 同步进行/ ,/ 两个/ 地点/ 的/ 软/ 、/ 硬件/ 以及/ 带宽/ 环境/ 完全一致/ ./ 为了/ 方便/ 叙述/ ,/ 本文/ 如/ 没有/ 特别/ 指出/ ,/ 实验/ 结果/ 均/ 以/ 海南/ 测量点/ 为例/ 进行/ 说明/ ./ 表/ 3/ 给出/ 了/ 实验/ 结果/ 汇总/ 情况/ ,/ 包括/ 两类/ 恶意/ 索引/ 节点/ 的/ 总数/ 和/ 受/ 影响/ 的/ 任务/ 分布/ 情况/ ./ 结合/ 表/ 2/ 中/ 测量/ 目标/ 的/ 分布/ 情况/ ,/ 可以/ 看出/ ,/ 在/ Kad/ 网络/ 中/ ,/ 针对/ 受/ 版权保护/ 的/ 资源/ ,/ 恶意/ 索引/ 节点/ 的/ 存在/ 是/ 非常/ 普遍/ 的/ ,/ 且/ 针对/ 文件/ 目标/ 的/ 攻击/ 更加/ 严重/ ./ 下/ 一节/ 将/ 在/ 上述/ 实验/ 的/ 基础/ 上/ 全面/ 分析/ 恶意/ 索引/ 节点/ 的/ 行为/ 特征/ ./ 类别/ 节点/ S/ -/ 节点/ 22755522511163M/ -/ 节点/ 44.7/ 万/ 11623373561625/ 节点/ 行为/ 特征分析/ 利用/ Anthill/ 输出/ 的/ KadTrace/ 日志/ 文件/ 和/ 可视化/ 功能/ ,/ 可以/ 直观/ 地/ 重现/ 完整/ 的/ Kad/ 发布/ 和/ 搜索/ 过程/ ./ 本文/ 通过/ 将/ 实际/ 测量/ 获得/ 的/ 节点/ 行为/ 与/ 标准/ Kad/ 协议/ 对比/ ,/ 发现/ 了/ 真实/ Kad/ 网络/ 中/ 存在/ 的/ 两类/ ①/ ②/ Page6/ 恶意/ 索引/ 节点/ :/ 选择性/ 拒绝服务/ 节点/ (/ S/ -/ 节点/ )/ 和/ 无/ 意义/ 应答/ 节点/ (/ M/ -/ 节点/ )/ ./ 下面/ 将/ 详细分析/ 二者/ 的/ 行为/ 特性/ ,/ 并/ 评估/ 其/ 对/ Kad/ 网络/ 正常/ 索引/ 服务/ 产生/ 的/ 影响/ ./ 5.1/ 犛/ -/ 节点/ 行为/ 特征分析/ 文献/ [/ 18/ ]/ 给出/ 了/ S/ -/ 节点/ 的/ 定义/ :/ “/ 服务/ ”/ 是/ 指该/ 节点/ 为/ 其他/ Kad/ 节点/ 提供/ 诸如/ 路由/ 、/ 索引/ 信息/ 存取/ 等/ 服务/ ,/ 而/ “/ 选择性/ 拒绝/ ”/ 则/ 是/ 指/ 该类/ 索引/ 节点/ 有/ 选图/ 3S/ -/ 节点/ 与/ 其他/ 节点/ 的/ 交互/ 图/ 在/ 图/ 3/ 中/ ,/ 一个/ 发布/ 节点/ 在/ 获得/ S/ -/ 节点/ 的/ 路由/ 应答/ 后/ ,/ 根据/ Kad/ 协议/ 向/ 其/ 发送/ 文件/ 或/ 文件/ 来源/ 发布/ 请求/ ;/ S/ -/ 节点/ 正常/ 应答/ 该/ 发布/ 请求/ ,/ 声称/ 自己/ 愿意/ 成为/ 该条/ 索引/ 条/ 目的/ 索引/ 节点/ ;/ 在/ 另一方面/ ,/ 搜索/ 节点/ 通过/ 路由/ 过程/ 定位/ 到/ 该/ S/ -/ 节点/ ,/ 同样/ 能够/ 收到/ 其/ 路由/ 应答/ ./ 在此之前/ ,/ S/ -/ 节点/ 表现/ 一切正常/ ./ 然而/ ,/ 当/ 搜索/ 节点/ 向/ 该/ 节点/ 发送/ 文件/ 或/ 文件/ 来源/ 搜索/ 请求/ 的/ 时候/ ,/ 其/ 拒绝/ 提供/ 索引/ 信息/ ./ 即便/ 是/ 发布/ 节点/ 出于/ 验证/ 目的/ 发送/ 的/ 搜索/ 请求/ ,/ S/ -/ 节点/ 仍然/ 会/ 保持沉默/ ./ 在/ 此/ 过程/ 中/ ,/ 为了/ 消除/ 互联网/ 丢包/ 和/ 偶然/ 因素/ 的/ 影响/ [/ 18/ ]/ ,/ Anthill/ 采取/ 了/ 自/ 适应/ 消息/ 重/ 发/ 机制/ ,/ 将/ 此/ 影响/ 降低/ 到/ 可以/ 忽略不计/ 的/ 程度/ ./ 由此/ 可以/ 说明/ 该类/ 节点/ 拒绝/ 回应/ 搜索/ 请求/ 的/ 行为/ 是/ 主观/ 的/ 、/ 故意/ 的/ ./ 表/ 3/ 中/ 实验/ 结果显示/ ,/ 在/ 实验/ 1/ 中/ ,/ 587/ 个/ 任务/ 中有/ 207/ 个/ 任务/ (/ 38/ 个/ 关键词/ ,/ 55/ 个/ IMDb/ 文件/ 、/ 51/ 个/ iTunes/ 文件/ 和/ 63/ 个/ Amazon/ 文件/ )/ 受到/ 了/ S/ -/ 节点/ 攻击/ ,/ 共/ 涉及/ 227/ 个/ S/ -/ 节点/ 和/ 546/ 次/ SDoS/ 攻击/ ./ 可以/ 看出/ ,/ SDoS/ 攻击/ 已经/ 广泛/ 存在/ 于/ P2P/ 网络/ 中/ 处于/ 版权/ 有效期/ 内/ 的/ 资源/ 上/ ,/ 并且/ 同时/ 针对/ 关键词/ 目标/ 和/ 文件/ 目标/ ./ 表/ 4/ 给出/ 了/ 受/ SDoS/ 攻击/ 次数/ 最多/ 的/ 10/ 个/ 目标/ ./ 结果显示/ 当前/ 正在/ 上映/ 的/ 两部/ 电影/ “/ Loveand/ 择性/ 地/ 应答/ 路由/ 和/ 发布/ 请求/ ,/ 却/ 对/ 至关重要/ 的/ 搜索/ 请求/ 保持沉默/ ./ 在/ 实验/ 1/ 中/ 为了/ 消除/ 底层/ 互联网/ 丢包/ 以及/ 偶然/ 因素/ (/ 链路/ 问题/ 、/ 节点/ 负载/ 过重/ 等/ )/ 的/ 影响/ ,/ 针对/ 同一个/ 目标/ 节点/ ,/ Kad/ 搜索/ 请求/ 在/ 最坏/ 情况/ 下会/ 被/ 发送/ 4/ 次/ ./ 只有/ 在/ Anthill/ 搜索/ 节点/ 未/ 收到/ 该/ 节点/ 的/ 任何/ 搜索/ 应答/ 的/ 情况/ 下/ ,/ 才/ 会/ 判定/ 该/ 节点/ 为/ S/ -/ 节点/ ./ 这里/ 进一步/ 使用/ S/ -/ 节点/ 与/ 其他/ 节点/ 的/ 交互/ 过程/ 来/ 说明/ 其/ 行为/ 特征/ ,/ 参见/ 图/ 3/ ./ Honor/ ”/ 和/ “/ Starbuck/ ”/ 受到/ 了/ 明显/ 的/ SDoS/ 攻击/ ./ 进一步/ 观察/ 文件/ 信息/ ,/ 发现/ 有/ 两个/ 文件/ 均/ 为/ 西班牙语/ 版本/ ./ 利用/ 最新/ 的/ Maxmind/ 数据库/ ①/ 把/ IP/ 映射/ 到/ 所属/ 国家/ 或/ 地区/ ,/ 发现/ 12/ %/ 的/ S/ -/ 节点/ 来自/ 西班牙/ ./ 这/ 说明/ 该国/ 某些/ 组织/ 在/ P2P/ 版权保护/ 方面/ 已经/ 做/ 了/ 大量/ 工作/ ./ 此外/ ,/ 有/ 4/ 个/ 文件/ 为/ 目前/ iTunes/ 上/ 的/ 流行歌曲/ ,/ 说明/ 在/ 音乐/ 方面/ ,/ 受/ SDoS/ 攻击/ 的/ 情况/ 同样/ 不容乐观/ ./ (/ centraldivx/ ./ com/ )/ ./ avi/ ,/ 1.35/ GBPLATINUMvol/ ./ 27/ )/ ./ mp3/ ,/ 8.76/ MBmpg/ ,/ 799.03/ MB/ 排名/ 1Love/ ./ and/ ./ Honor/ ./ (/ Spanish/ )/ ./ DVD/ -/ Rip/ ./ XviD/ -/ AC3/ ./ 2Pitbullfeat/ ./ ChristinaAguilera/ -/ feelthismoment/ (/ Disco3Starbuck/ ./ [/ Spanish/ ]/ ./ CVCD/ ./ BR/ -/ Screener/ ./ [/ DTL/ ]/ ./ 4Starbuck/ ./ avi/ ,/ 706.51/ MB5/ 关键词/ :/ VHStoDVD6/ 关键词/ :/ Downtown7Pitbullfeat/ ./ ChristinaAguilera/ -/ FeelThisMoment8BrunoMars/ -/ WhenIWasYourMan/ ./ mp3/ ,/ 8.26/ MB10918/ ./ Baauer/ -/ HarlemShake/ ./ mp3/ ,/ 7.46/ MB10Starbuck/ ./ DVD/ ./ XviD/ ./ [/ www/ ./ DivxTotaL/ ./ com/ ]/ ./ avi/ ,/ (/ DJSequenceRemix/ )/ ./ mp3/ ,/ 10.79/ MB1/ ./ 15GB/ ①/ IndustryleadingIPDatabase/ [/ EB/ // OL/ ]/ ,/ http/ :/ // // www/ ./ max/ -/ Page7/ 下面/ 继续/ 分析/ S/ -/ 节点/ 在/ 面对/ 发布/ 节点/ 和/ 搜索/ 节点/ 的/ “/ 搜索/ 请求/ ”/ 时/ 是否/ 会/ 有/ 不同/ 的/ 表现/ ./ 统计/ 结果显示/ ,/ 227/ 个/ S/ -/ 节点/ 中/ ,/ 有/ 38/ 个/ 对/ 发布/ 节点/ 和/ 搜索/ 节点均/ 不/ 应答/ 搜索/ 请求/ ,/ 56/ 个/ 只/ 不/ 应答/ 发布/ 节点/ ,/ 而/ 余下/ 的/ 133/ 个/ 则/ 只/ 不/ 应答/ 搜索/ 节点/ ./ 这/ 说明/ S/ -/ 节点/ 的/ 攻击行为/ 更/ 倾向/ 于/ 搜索/ 节点/ ,/ 对/ 发布者/ 的/ 验证/ 过程/ 有/ 一定/ 对抗/ 能力/ ,/ 具有/ 很强/ 的/ 隐蔽性/ ./ 从/ 防御/ 角度/ 来看/ ,/ 如果/ 发布/ 节点/ 和/ 搜索/ 节点/ 之间/ 没有/ 有效/ 的/ 信息/ 交流/ 渠道/ (/ 目前/ Kad/ 网络/ 并/ 不/ 具备/ 这种/ 沟通/ 机制/ )/ ,/ 该类/ 索引/ 节点/ 将/ 非常/ 难以/ 检测/ ./ 最后/ ,/ 不同/ 地点/ 的/ 测量/ 结果表明/ ,/ S/ -/ 节点/ 的/ 行为/ 并/ 没有/ 明显/ 的/ 地理/ 针对性/ ./ 在/ 北京/ 点/ 进行/ 的/ 相同/ 实验/ 表明/ ,/ 海南/ 点/ 发现/ 的/ 超过/ 80/ %/ 的/ S/ -/ 节点/ 同样/ 会/ 出现/ 在/ 北京/ 点/ 的/ 测量/ 结果/ 中/ ./ 5.2/ 犕/ -/ 节点/ 行为/ 特征分析/ 在/ 实验/ 2/ 中/ ,/ 本文/ 发现/ 另一类/ 恶意/ 索引/ 节点/ 无/ 意义/ 应答/ 节点/ ,/ 即/ 该类/ 节点/ 虽然/ 能够/ 正常/ 回应/ 搜索/ 请求/ ,/ 但是/ 返回/ 的/ 索引/ 信息/ 无/ 任何/ 意义/ ./ 所谓/ 的/ “/ 无/ 意义/ 索引/ 信息/ ”/ 是/ 指/ ,/ 索引/ 节点/ 返回/ 的/ 文件/ 或/ 文件/ 来源/ 信息/ 对/ 下载者/ (/ 搜索/ 者/ )/ 的/ 资源/ 获取/ 过程/ 无/ 任何/ 帮助/ ./ 下面/ 在/ 实验/ 2/ 的/ 基础/ 上/ ,/ 全面/ 分析/ M/ -/ 节点/ 的/ 行为/ 特征/ ./ 图/ 4/ 给出/ 了/ M/ -/ 节点/ 与/ 搜索/ 节点/ 的/ 交互/ 过程/ :/ 搜索/ 节点/ 定位/ 到/ M/ -/ 节点/ 后/ ,/ 向/ 其/ 发送/ 文件/ 或/ 文件/ 来源/ 搜索/ 请求/ ;/ 与/ S/ -/ 节点/ 不同/ 的/ 是/ ,/ M/ -/ 节点/ 正常/ 应答/ 该/ 请求/ ,/ 但是/ 应答/ 的/ 内容/ 在/ Kad/ 协议/ 中/ 无/ 任何/ 意义/ ./ 具体来讲/ ,/ 对于/ 文件/ 搜索/ 请求/ ,/ 其/ 返回/ 的/ 应答/ 中应/ 包括/ 文件/ ID/ 、/ 文件名/ 、/ 文件大小/ 等/ 信息/ ,/ 而/ M/ -/ 节点/ 的/ 应答/ 中仅/ 含有/ 文件/ ID/ ,/ 且/ 这个/ ID/ 与/ 关键词/ ID/ 相同/ ,/ 实际上/ 是/ 无效/ 的/ ;/ 而/ 对于/ 文件/ 来源/ 搜索/ 请求/ ,/ 其/ 返回/ 的/ 应答/ 中应/ 包含/ 来源/ 节点/ 类型/ (/ 主要/ 是/ 防火墙/ 状态/ )/ 、/ IP/ 和/ 端口/ 等/ 连接/ 信息/ ,/ 但/ M/ -/ 节点/ 返回/ 的/ 应答/ 中/ ,/ 来源/ 节点/ 类型/ 均/ 为/ 0/ ,/ 该/ 类型/ 在/ Kad/ 中是/ 无效/ 的/ ,/ 并且/ 对于/ 任何/ 搜索/ 目标/ ,/ 其/ 返回/ 的/ 来源/ 节点/ IP/ 和/ 端口/ 均/ 为/ 某个/ 特定/ 值/ :/ 181.74/ ./ 13.60/ :/ 4462/ ./ 利用/ 节点/ 探测/ 工具/ 对/ 其/ 进行/ 探测/ ,/ 发现/ 该/ 来源/ 节点/ 不/ 回应/ 任何/ Kad/ 请求/ ,/ 表明/ 其/ 并/ 不是/ 一个/ 真正/ 的/ Kad/ 节点/ ./ 根据/ 文献/ [/ 25/ ]/ ,/ 如此/ 大规模/ 地/ 返回/ 指向/ 某个/ 特定/ IP地址/ 的/ 来源/ 节点/ ,/ 很/ 可能/ 是/ 由于/ 攻击者/ 利用/ M/ -/ 节点/ 发动/ 了/ 针对/ 该/ IP/ 的/ DDoS/ (/ 分布式/ 拒绝服务/ )/ 攻击/ ./ 表/ 3/ 中/ 的/ 结果显示/ ,/ 在/ 实验/ 2/ 中共/ 有/ 397/ 个/ 任务/ 受到/ 了/ M/ -/ 节点/ 攻击/ ,/ 并且/ 该类/ 节点/ 数量/ 十分/ 庞大/ ,/ 总数/ 高达/ 44.7/ 万/ ./ 297/ 个/ 被/ 攻击/ 的/ 文件/ 来源/ 搜索/ 任务/ 中/ ,/ M/ -/ 节点/ 的/ 平均/ 数量/ 为/ 3926/ 个/ ;/ 而/ 余下/ 的/ 文件/ 搜索/ 任务/ 中/ ,/ 平均/ M/ -/ 节点/ 数为/ 734/ 个/ ./ 这/ 表明/ 该类/ 节点/ 对/ 正常/ 获取/ 文件/ 来源/ 信息/ 的/ 干扰/ 和/ 破坏/ 更加/ 严重/ ./ 6.22/ MBNako/ ./ me/ ./ mp4/ ,/ 1.18/ GBHoldUs/ ./ mp3/ ,/ 9.93/ MB/ 排名/ 1MobileAVGInternetSecurity2013/ ./ rar/ ./ exe/ ,/ 357.64/ KBAVG/ -/ InternetSecurity2013betabuild201302615withKeyWorkingLikeFullVersionh33tiahq76/ ./ mp3/ ./ exe/ ,/ 2357.69/ KB3LATESTPRISMVIDEOFILECONVERTERPLUS1/ ./ 79WITHSERIAL/ ./ zip/ ,/ 7.41/ MB4FallOutBoy/ -/ MySongsKnowWhatYouDidIntheDark/ (/ LightEmUp/ )/ ./ mp3/ ,/ 7.32/ MB5Starbuck2011BluRay720pDualSub/ [/ HDTeam/ ]/ ./ mkv/ ,/ 5.19/ GB6Pitbullfeat/ ./ ChristinaAguilera/ -/ FeelThisMoment/ ./ mp3/ ,/ 7Jack/ ./ the/ ./ Giant/ ./ Slayer/ ./ 2013/ ./ CAM/ ./ XViD/ -/ NOGRP/ ./ 8069/ ./ Macklemore/ &/ RyanLewisFeat/ ./ RayDalton/ -/ Can/ ’/ t9ImagineDragons/ -/ Radioactive/ ./ mp3/ ,/ 5.64/ MB10Love/ ./ and/ ./ Honor/ ./ [/ 2006/ ]/ [/ DVDRIP/ ./ Espaol/ ]/ ./ avi/ ,/ 1.35/ GB/ 表/ 5/ 给出/ 了/ 测量/ 过程/ 中/ 发现/ M/ -/ 节点/ 数量/ 最多/ 的/ 10/ 个/ 目标/ ./ 总体/ 来看/ ,/ 热门/ 电影/ 、/ 音乐/ 和/ 软件/ 均/ 受到/ 了/ 来自/ 大量/ M/ -/ 节点/ 的/ 攻击/ ./ 与表/ 4/ 中受/ SDoS/ 攻击/ 次数/ 最多/ 的/ 10/ 个/ 目标/ 对比/ ,/ 发现/ 其中/ 有/ 两个/ 目标/ 是/ 相同/ 的/ ,/ 分别/ 是/ 电影/ “/ LoveandHonor/ ”/ 和/ “/ Starbuck/ ”/ ./ 此外/ 安全软件/ “/ AVGInternetSecurity2013/ ”/ 的/ 两个/ 版本/ 文件/ 也/ 同时/ 受到/ 比较严重/ 的/ 攻击/ ./ 把/ 这/ 两类/ 恶意/ 索引/ 节点/ 的/ 攻击/ 目标/ 联系/ 起来/ 可以/ 发现/ ,/ 攻击者/ 对/ 某些/ 重点/ 目标/ 采取/ 了/ 多种/ 攻击/ 方法/ ./ 为了/ 确认/ M/ -/ 节点/ 的/ 行为/ 是/ 自发/ 的/ ,/ 而/ 不是/ 恶/ Page8/ 意/ 发布/ 节点/ 发起/ 的/ 索引/ 污染/ 攻击/ (/ 索引/ 节点/ 只是/ 被动/ 存储/ 和/ 应答/ 虚假/ 索引/ 信息/ )/ ,/ 进行/ 了/ 如下/ 实验/ :/ 表/ 5/ 中/ 的/ 10/ 个/ 目标/ 作为/ 原始/ 目标/ ;/ 把/ 每个/ 原始/ 目标/ 分别/ 加/ 1/ (/ 128/ 位/ ID/ 的/ 最低/ 位加/ 1/ )/ ,/ 获取/ 10/ 个/ 修改/ 目标/ ;/ 利用/ Anthill/ 同时/ 执行/ 上述/ 20/ 个/ 目标/ 的/ 搜索/ 任务/ ,/ 分别/ 统计/ 每个/ 任务/ 遭遇/ 的/ M/ -/ 节点/ 数量/ ,/ 以及/ 原始/ 目标/ 与/ 修改/ 目标/ 的/ M/ -/ 节点/ 集合/ 的/ 交集/ ./ 根据/ Kad/ 的/ ID/ 生成/ 算法/ ,/ 在/ 128/ 位/ ID/ 空间/ 中/ ,/ 理论/ 上/ 两个/ ID/ 距离/ 相差/ 为/ 1/ 不/ 可能/ 发生/ ,/ 即/ 修改/ 目标/ 在/ Kad/ 网络/ 中/ 不/ 可能/ 存在/ ./ 如果/ 这些/ M/ -/ 节点/ 对/ 这些/ 目标/ 仍然/ 返回/ 搜索/ 应答/ ,/ 那么/ 就/ 可以/ 确认/ M/ -/ 节点/ 的/ 行为/ 是/ 自发/ 的/ ,/ 因为/ 恶意/ 发布/ 节点/ 绝不/ 可能/ 事先/ 对/ ID/ 空间/ 内/ 的/ 所有/ 目标/ 进行/ 污染/ ./ 图/ 5/ 的/ 结果显示/ ,/ 6/ 个/ 修改/ 目标/ 同样/ 受到/ 了/ M/ -/ 节点/ 的/ 攻击/ ,/ 并且/ 原始/ 目标/ 和/ 修改/ 目标/ 的/ M/ -/ 节点/ 集合/ 相似/ 度/ 很/ 高/ ,/ 平均/ Jaccard/ 相似性/ 系数/ 高达/ 0.76/ ./ 由此/ 可以/ 肯定/ 这/ 6/ 个/ 任务/ 中/ M/ -/ 节点/ 的/ 行为/ 一定/ 是/ 自发/ 的/ ./ 而/ 余下/ 的/ 4/ 个/ 修改/ 目标/ 没有/ 遇到/ M/ -/ 节点/ ,/ 有/ 两种/ 可能/ :/ (/ 1/ )/ 这些/ M/ -/ 节点/ 发起/ 的/ 攻击/ 具有/ 很强/ 的/ 目的性/ ,/ 只/ 针对/ 网络/ 中/ 存在/ 的/ 资源/ ;/ (/ 2/ )/ 这些/ 索引/ 节点/ 的/ 行为/ 是/ 由/ 恶意/ 发布/ 节点/ 实施/ 的/ 索引/ 污染/ 引起/ 的/ ./ 以上/ 实验/ 结果/ 至少/ 可以/ 证明/ ,/ 在/ 捕获/ 的/ M/ -/ 节点/ 集合/ 中/ ,/ 大部分/ 节点/ 的/ 行为/ 是/ 自发/ 的/ ./ 接下来/ 分析/ 这些/ M/ -/ 节点/ 的/ 分布/ 情况/ ,/ 图/ 6/ 给出/ 了/ M/ -/ 节点/ Top10/ 地理分布/ ./ 利用/ MaxmindIP/ 数据库/ ,/ 获得/ 这些/ 节点/ 所在/ 的/ 地理位置/ ./ 结果显示/ ,/ 有/ 超过/ 一半/ 的/ 节点/ 来自/ 中国/ ,/ 接下来/ 是/ 意大利/ 和/ 西班牙/ ,/ 比例/ 分别/ 为/ 11/ %/ 和/ 10/ %/ ./ 考虑/ 到/ 中国/ 版权保护/ 组织/ 与/ 欧美/ 等国/ 的/ 差距/ ,/ 中国/ 有/ 如此/ 大规模/ 的/ M/ -/ 节点/ ,/ 我们/ 有/ 理由/ 推测/ 国际/ 上/ 某些/ 版权保护/ 机构/ 可能/ 已经/ 开始/ 利用/ 中国/ 的/ 僵尸/ 网络/ 来/ 干扰/ P2P/ 文件共享/ 网络/ 的/ 正常/ 运行/ ./ 考虑/ 到/ IP/ 资源/ 的/ 稀缺性/ ,/ 攻击者/ 会/ 最大/ 限度/ 利用/ 掌握/ 的/ IP/ 资源/ ,/ 所以/ 一个/ M/ -/ 节点/ 很/ 可能/ 同时/ 攻击/ 多个/ 目标/ ./ 图/ 7/ 给出/ 了/ 对数/ 尺度/ 下/ 每个/ M/ -/ 节点/ 攻击/ 任务/ 数/ 的/ 逆/ 累积/ 分布/ 曲线/ (/ CCDF/ )/ ./ 虽然/ 98/ %/ 左右/ 的/ M/ -/ 节点/ 只/ 在/ 一个/ 目标/ 中/ 出现/ 过/ ,/ 但是/ 仍然/ 有/ 100/ 个/ M/ -/ 节点/ 攻击/ 的/ 任务/ 数/ 超过/ 30/ ,/ 甚至/ IP/ :/ 60.250/ ./ 192.28/ (/ 来自/ 台湾/ 新竹/ )/ 在/ 126/ 个/ 被/ M/ -/ 节点/ 攻击/ 的/ 任务/ 中/ 都/ 出现/ 过/ ./ 图/ 7/ 每个/ M/ -/ 节点/ 攻击/ 任务/ 数/ 的/ 逆/ 累积/ 分布图/ 最后/ ,/ 我们/ 对比/ 了/ 北京/ 和/ 海南/ 两地/ 的/ 测量/ 结果/ ,/ 发现/ M/ -/ 节点/ 的/ 行为/ 具有/ 明显/ 的/ 地理/ 针对性/ ./ 虽然/ 北京/ 的/ 实验/ 遇到/ 了/ 在/ 海南/ 捕获/ 到/ 的/ 超过/ 90/ %/ 的/ M/ -/ 节点/ ,/ 但是/ 这些/ M/ -/ 节点/ 并/ 没有/ 对/ 来自/ 北京/ 的/ 搜索/ 请求/ 发起/ 攻击/ ./ 这/ 一方面/ 说明/ 该类/ 节点/ 的/ 行为/ 具有/ 明显/ 的/ 地理/ 针对性/ ,/ 另一方面/ 也/ 表明/ M/ -/ 节点/ 并/ 不是/ 真正/ 的/ 索引/ 节点/ ,/ 再次/ 佐证/ 了/ 其/ 行为/ 的/ 自发性/ ./ 5.3/ 两种/ 恶意/ 索引/ 节点/ 的/ 关联/ 在/ 实验/ 过程/ 中/ ,/ 共有/ 560/ 个/ 任务/ 受到/ 了/ 来自/ 索引/ 节点/ 层面/ 的/ 攻击/ ,/ 其中/ 有/ 66/ 个/ 任务/ 同时/ 受到/ S/ -/ 节点/ 和/ M/ -/ 节点/ 的/ 影响/ ./ 此外/ ,/ 超过/ 30/ %/ 的/ S/ -/ 节/ Page9/ 点/ 出现/ 在/ M/ -/ 节点/ 集合/ 之中/ ,/ 这/ 说明/ 这/ 两类/ 索引/ 节点/ 并/ 不是/ 完全/ 分离/ 的/ ,/ 某些/ 恶意/ 索引/ 节点/ 对/ 同一个/ 目标/ 能够/ 同时/ 发起/ 上述/ 两种/ 攻击/ ,/ 表/ 4/ 和表/ 5/ 也/ 证实/ 了/ 这/ 一点/ ./ 这/ 也/ 说明/ 了/ Kad/ 协议/ 在/ 设计/ 上/ 还/ 存在/ 很多/ 缺陷/ ,/ 很/ 容易/ 被/ 攻击者/ 找到/ 安全漏洞/ 并/ 加以/ 利用/ ./ 6/ 防御/ 方法/ 本文/ 描述/ 的/ 两类/ 恶意/ 索引/ 节点均/ 会/ 对/ Kad/ 网络服务/ 可用性/ 和/ 服务质量/ 产生/ 非常/ 不利/ 的/ 影响/ ./ S/ -/ 节点/ 对/ 发布者/ 声称/ 自己/ 愿意/ 成为/ 该/ 资源/ 的/ 索引/ 节点/ ,/ 消耗/ 发布/ 过程/ 有限/ 的/ 索引/ 节点/ 指标/ (/ Kad/ 每次/ 选择/ 10/ 个/ 索引/ 节点/ 进行/ 发布/ )/ ,/ 却/ 拒绝/ 响应/ 查询/ 者/ 的/ 搜索/ 请求/ ,/ 直接/ 影响/ Kad/ 网络/ 查询/ 的/ 可靠性/ ./ 根据/ 文献/ [/ 18/ ]/ 的/ 测量/ ,/ 对于/ 随机/ 生成/ 的/ 目标/ ,/ SDoS/ 节点/ 直接/ 导致/ 了/ 4.4/ %/ 的/ 查询/ 失败/ ./ 而/ M/ -/ 节点/ 则/ 是/ 对/ 查询/ 者/ 的/ 请求/ ,/ 随意/ 构造/ 一些/ 无/ 意义/ 的/ 应答/ ,/ 占用/ 每次/ 查询/ 可以/ 获得/ 的/ 索引/ 条目/ 指标/ (/ Kad/ 每次/ 查询/ 最/ 多/ 获得/ 300/ 条/ 索引/ 条目/ )/ ,/ 促使/ 其/ 提前/ 终止/ 查询/ 过程/ ,/ 无法/ 获得/ 真正/ 有用/ 的/ 信息/ ./ 除了/ 浪费/ 大量/ 的/ 网络流量/ ,/ 更/ 可怕/ 的/ 是/ ,/ 只/ 需/ 将/ 受害者/ IP/ 写入/ 应答/ 消息/ ,/ 攻击者/ 就/ 能/ 以/ 很小/ 的/ 代价/ 利用/ P2P/ 平台/ 的/ 强大/ 优势/ 发起/ DDoS/ 攻击/ ./ 最后/ ,/ 如果/ 把/ 这/ 两类/ 恶意/ 索引/ 节点/ 同/ Eclipse/ 攻击/ [/ 26/ ]/ 结合/ 起来/ ,/ 阻断/ 其他/ 节点/ 对/ 某些/ 资源/ 的/ 访问/ 是/ 完全/ 有/ 可能/ 的/ ./ 实际/ 情况/ 下/ ,/ 我们/ 使用/ eMule/ 客户端/ 对表/ 5/ 中/ 10/ 个/ 文件/ 进行/ 了/ 24h/ 的/ 持续/ 下载/ ,/ 结果显示/ 一直/ 无法/ 获得/ 任何/ 有效/ 的/ 来源/ 节点/ ,/ 最终/ 均/ 下载/ 失败/ ./ 在/ 恶意/ 索引/ 节点/ 的/ 防御/ 上/ ,/ 虽然/ 可以/ 参照/ 之前/ 对/ 恶意/ 发布/ 节点/ 的/ 防御/ 方法/ ,/ 但是/ 这些/ 方法/ 需要/ 引入/ 中心化/ 认证/ 服务器/ 或/ 新/ 的/ 控制协议/ ,/ 导致/ 与/ 现有/ Kad/ 网络/ 不/ 兼容/ ,/ 实施/ 代价/ 过高/ ,/ 不/ 适合/ 在/ 实际/ Kad/ 网络/ 中/ 部署/ 应用/ ./ 本文/ 以/ 不/ 增加/ 新/ 的/ 控制协议/ 、/ 与/ 现有/ Kad/ 网络/ 完全/ 兼容/ 为/ 原则/ ,/ 在/ 行为/ 分析/ 的/ 基础/ 上/ ,/ 提出/ 了/ 富有/ 针对性/ 的/ 、/ 可/ 部署/ 性/ 良好/ 的/ 防御/ 方法/ :/ (/ 1/ )/ 对于/ S/ -/ 节点/ 的/ 识别/ ,/ 由于/ 其/ 行为/ 具有/ 很强/ 的/ 隐蔽性/ ,/ 并且/ Kad/ 网络/ 中/ 发布者/ 和/ 搜索/ 者/ 之间/ 不/ 存在/ 有效/ 的/ 沟通/ 机制/ ,/ 因此/ 直接/ 对/ 该类/ 节点/ 进行/ 识别/ 十分困难/ ./ 但是/ 仍然/ 可以/ 采取/ 一定/ 的/ 策略/ 尽可能/ 降低/ S/ -/ 节点/ 的/ 影响/ ,/ 文献/ [/ 18/ ]/ 提出/ 的/ 邻域/ 搜索/ 和/ 邻域/ 发布/ (/ Neighborhoodlookup/ )/ 策略/ ,/ 能够/ 尽量/ 降低/ 该类/ 节点/ 在/ 全部/ 索引/ 节点/ 中/ 的/ 比例/ ,/ 限制/ 该类/ 节点/ 的/ 攻击能力/ ./ 邻域/ 搜索/ 是/ 指/ ,/ 搜索/ 者/ 只要/ 进入/ 目标/ ID/ 附近/ 区域/ (/ 在/ 该/ 区域/ 内/ ,/ 节点/ 与/ 目标/ ID/ 的/ 共同/ 前缀/ 大于/ 某一/ 阈值/ )/ ,/ 即可/ 直接/ 对/ 该/ 区域/ 内/ 的/ 活跃/ 节点/ 发送/ 查询/ 请求/ ,/ 而/ 不必/ 等到/ 路由/ 收敛/ 之后/ 进行/ ./ 邻域/ 发布/ 则/ 是/ 发布者/ 在/ 目标/ ID/ 附近/ 区域/ 直接/ 发布/ 相关/ 索引/ 条目/ ./ 该/ 策略/ 可以/ 大大增加/ 搜索/ 者/ 找到/ 的/ 索引/ 节点/ 数量/ ,/ 进而/ 缩/ 小S/ -/ 节点/ 的/ 比例/ 和/ 提高/ 查询/ 可靠性/ ./ 实验/ 结果表明/ ,/ 当/ 邻域/ 大小/ 设置/ 为/ 14/ 时/ ,/ 就/ 能够/ 以/ 可/ 接受/ 的/ 通信/ 代价/ 将/ 其/ 不利/ 影响/ 降低/ 到/ 1/ ;/ (/ 2/ )/ 在/ M/ -/ 节点/ 的/ 识别/ 和/ 防御/ 上/ ,/ 搜索/ 者/ 可以/ 在/ 搜索/ 过程/ 中/ 根据/ 图/ 4/ 中/ 描述/ 的/ M/ -/ 节点/ 应答/ 消息/ 的/ 特征/ 有效/ 识别/ 该类/ 节点/ ./ 具体来讲/ ,/ 搜索/ 者/ 对/ 搜索/ 应答/ 中/ 的/ 索引/ 条目/ 进行/ 审查/ ,/ 根据/ M/ -/ 节点/ 应答/ 消息/ 的/ 特征/ (/ 文件/ 索引/ 缺少/ 关键/ 信息/ ,/ 文件/ 来源/ 索引/ 指向/ 固定/ IP/ 和/ 节点/ 类型/ 异常/ )/ ,/ 有效/ 过滤/ 掉/ 那些/ 无/ 意义/ 的/ 应答/ ,/ 使/ 搜索/ 过程/ 可以/ 顺利进行/ 下去/ ./ 本文/ 在/ eMule/ 客户端/ 上/ 实现/ 了/ 上述/ 防御/ 方法/ ,/ 并/ 对表/ 4/ 和表/ 5/ 中/ 的/ 目标/ 进行/ 了/ 搜索/ 和/ 下载/ 测试/ ./ 实验/ 结果表明/ 改进/ 后/ 的/ eMule/ 能够/ 更快/ 地/ 获得/ 正确/ 的/ 文件/ ./ 具体/ 优化/ 效果/ 如下/ :/ 获取/ 第/ 1/ 个/ 文件/ 的/ 时间/ 从/ 平均/ 8.6/ s/ 缩短/ 至/ 1s/ ;/ 获取/ 的/ 有效/ 文件/ 数量/ 从/ 平均/ 212/ 个/ 增加/ 至/ 298/ 个/ (/ eMule/ 客户端/ 规定/ 每次/ 获取/ 的/ 文件/ 数量/ 不/ 多于/ 300/ )/ ;/ 此外/ ,/ 由于/ 在/ 搜索/ 阶段/ 就/ 排除/ 了/ 大量/ 无/ 意义/ 的/ 文件/ 和/ 文件/ 来源/ ,/ 改进/ 后/ 的/ eMule/ 大大降低/ 了/ 随后/ 下载/ 过程/ 中/ 的/ 流量/ 开销/ ./ 7/ 结论/ 在/ P2P/ 文件共享/ 网络/ 中/ ,/ 索引/ 节点/ 负责/ 存储资源/ 索引/ ,/ 并/ 响应/ 其它/ 节点/ 的/ 搜索/ 请求/ ,/ 其/ 行为/ 的/ 正确/ 与否/ 直接/ 影响/ 资源/ 查找/ 的/ 可靠性/ 和/ 效率/ ./ 本文/ 通过/ 广泛/ 的/ 实验/ 测量/ 和/ 分析/ ,/ 在/ 实际/ Kad/ 网络/ 中/ 发现/ 了/ 两类/ 恶意/ 索引/ 节点/ :/ 选择性/ 拒绝服务/ 节点/ 和/ 无/ 意义/ 应答/ 节点/ ./ 本文/ 选取/ 了/ 当前/ 流行/ 的/ 电影/ 、/ 音乐/ 和/ 应用软件/ 资源/ 作为/ 测量/ 目标/ ,/ 利用/ Ant/ -/ hill/ 测量/ 系统/ ,/ 获取/ 了/ 在/ 索引/ 信息/ 存取/ 过程/ 中/ 索引/ 节点/ 全面/ 的/ 行为/ 特征/ ,/ 进而/ 根据/ Kad/ 协议/ 识别/ 出/ 恶意/ 节点/ ./ 测量/ 结果显示/ ,/ 恶意/ 索引/ 节点/ 广泛/ 存在/ 于/ 当前/ Kad/ 网络/ 中/ ,/ 总数/ 高/ 达/ 数十万/ ,/ 其/ 攻击行为/ 也/ 具有/ 相当/ 的/ 隐蔽性/ ./ 最后/ ,/ 在/ 行为/ 特征分析/ 的/ 基础/ 上/ ,/ 本文/ 针对/ 以上/ 恶意/ 攻击/ ,/ 提出/ 了/ 针对性/ 较强/ 、/ 易于/ 部署/ 的/ 防御/ 方法/ ,/ 能够/ 消除/ 或/ 有效/ 缓解/ 恶/ Page10/ 意/ 索引/ 节点/ 产生/ 的/ 不利/ 影响/ ./ 

