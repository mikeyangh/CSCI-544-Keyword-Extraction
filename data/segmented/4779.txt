Page1/ 云/ 计算/ 模式/ 内部/ 威胁/ 综述/ 王国峰/ 1/ )/ ,/ 2/ )/ 刘川意/ 2/ )/ ,/ 3/ )/ 潘鹤中/ 1/ )/ ,/ 2/ )/ 方滨兴/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 北京邮电大学/ 计算机/ 学院/ 北京/ 100876/ )/ 2/ )/ (/ 哈尔滨工业大学/ (/ 深圳/ )/ 广东/ 深圳/ 518055/ )/ 3/ )/ (/ 东莞/ 电子科技/ 大学/ 电子/ 信息工程/ 研究院/ 广东/ 东莞/ 523000/ )/ 摘要/ 云/ 计算/ 模式/ 的/ 本质特征/ 是/ 数据/ 所有权/ 和/ 管理权/ 的/ 分离/ ,/ 即/ 用户/ 将/ 数据/ 迁移/ 到/ 云上/ ,/ 失去/ 了/ 对/ 数据/ 的/ 直接/ 控制权/ ,/ 需要/ 借助/ 云/ 计算/ 平台/ 实现/ 对/ 数据/ 的/ 管理/ ./ 而云/ 计算/ 模式/ 的/ 引入/ 带来/ 了/ 很多/ 新/ 的/ 安全/ 问题/ 和/ 挑战/ ,/ 如/ 恶意/ 的/ 云/ 管理员/ 、/ 可/ 利用/ 的/ 安全漏洞/ 和/ 不当/ 的/ 访问/ 接口/ 等/ ./ 尤其/ 是/ 当云/ 管理员/ 客观/ 上/ 具备/ 偷窥/ 和/ 泄露/ 用户/ 数据/ 和/ 计算资源/ 的/ 能力/ 时/ ,/ 如何/ 保障/ 用户/ 数据/ 的/ 权益/ ,/ 成为/ 一个/ 极具/ 挑战/ 的/ 问题/ ./ 因此/ ,/ 内部/ 威胁/ 的/ 研究/ 和/ 应对/ 在/ 云/ 计算/ 模式/ 下/ 变得/ 尤为重要/ ,/ 也/ 是/ 近年来/ 学术界/ 和/ 工业界/ 共同/ 关注/ 的/ 热点/ ./ 为/ 进一步/ 深入研究/ 云/ 计算/ 模式/ 内部/ 威胁/ 问题/ 及其/ 应对/ ,/ 从/ 具体/ 方式/ 方法/ 上作/ 系统/ 的/ 归纳/ 和/ 梳理/ ,/ 并/ 促进/ 国内/ 在/ 该/ 方向/ 上/ 的/ 研究/ ,/ 该文/ 系统分析/ 和/ 总结/ 了/ 云/ 计算/ 模式/ 下/ 内部/ 威胁/ 的/ 类型/ 、/ 特点/ ,/ 并/ 针对/ 真实/ 的/ 云/ 平台/ 构建/ 和/ 实施/ 切实可行/ 的/ 内部/ 威胁/ 攻击/ 实例/ ,/ 展示/ 了/ 云/ 平台/ 客观存在/ 的/ 可/ 利用/ 内部/ 风险/ 以及/ 典型/ 攻击/ 方法/ ./ 在/ 此基础/ 上/ ,/ 通过/ 梳理/ 相关/ 研究/ 工作/ ,/ 该文/ 总结/ 了/ 三类/ 应对/ 云/ 计算/ 模式/ 内部/ 威胁/ 的/ 主要/ 技术/ 路线/ ,/ 即/ 人员/ 评价/ 与/ 行为/ 分析/ 、/ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 和/ 用户/ 可控/ 的/ 数据/ 加密/ ./ 针对/ 每/ 一类/ 技术/ 路线/ ,/ 该文/ 深入分析/ 了/ 其/ 主要/ 原理/ 、/ 关键技术/ 、/ 最新进展/ 和/ 产业/ 实用性/ ./ 最后/ 给出/ 了/ 云/ 计算/ 模式/ 下/ 内部/ 威胁/ 的/ 重要/ 研究/ 点/ 和/ 未来/ 发展/ 方向/ ./ 关键词/ 云/ 计算/ ;/ 内部/ 威胁/ ;/ 行为/ 分析/ ;/ 权限/ 管控/ ;/ 数据/ 加密/ 1/ 引言/ 内部/ 威胁/ 是/ 云/ 计算/ 安全/ 面临/ 最/ 严重/ 挑战/ 之一/ [/ 1/ ]/ ./ 2013/ 年/ 斯诺/ 登/ 事件/ 即/ 内部人员/ 公开/ 内部/ 数据/ 让/ 媒体/ 引起/ 广泛/ 关注/ ,/ 但/ 这/ 只是/ 内部/ 威胁/ 安全/ 的/ 冰山一角/ ./ SailPoint/ 安全/ 公司/ 曾/ 做/ 过/ 一个/ 安全/ 调查/ ,/ 受访者/ 中/ 20/ %/ 的/ 人/ 表示/ 只要/ 价钱/ 合适/ 会/ 出卖/ 自己/ 的/ 工作/ 账号/ 和/ 密码/ ;/ 美国/ 计算机/ 安全/ 协会/ (/ CSI/ )/ 和/ 联邦调查局/ (/ FBI/ )/ 在/ 2008/ 年/ 的/ 报告/ 中/ 指出/ 内部/ 安全事件/ 所/ 造成/ 的/ 损失/ 明显/ 高于/ 外部/ 安全事件/ ;/ 2015/ 年/ 普华永道/ 的/ 调查/ 指出/ 中国/ 大陆/ 与/ 香港地区/ 的/ 企业/ 信息安全/ 事件/ 中/ 50/ %/ 以上/ 是/ 由/ 内部人员/ 造成/ 的/ ./ 学术界/ 对/ 内部/ 威胁/ 越来越/ 重视/ ,/ 网络安全/ 顶级/ 会议/ CCS/ (/ ACMConferenceonComputerandCommunicationsSecurity/ )/ 针对/ 如何/ 防护/ 内部/ 威胁/ 专门/ 成立/ 研讨会/ ./ CERT/ (/ ComputerEmergencyResponseTeams/ )/ 研究/ 中心/ 2000/ 年/ 即/ 开启/ 内部/ 威胁/ 检测/ 项目/ ,/ 根据/ CERT/ 的/ 定义/ ,/ 内部/ 威胁/ 是/ 指/ 一个/ 或/ 多个/ 现在/ 或/ 以前/ 的/ 公司员工/ 、/ 外/ 包商/ 或/ 合作伙伴/ ,/ 具有/ 对/ 网络/ 、/ 系统/ 或/ 数据/ 的/ 访问/ 权限/ ,/ 故意/ 滥用/ 或/ 误用/ 自己/ 的/ 权限/ 损害/ 公司/ 信息/ 或/ 信息系统/ 保密性/ 、/ 完整性/ 、/ 可用性/ [/ 2/ -/ 4/ ]/ ./ 2016/ 年/ 2/ 月/ ,/ CSA/ (/ CloudSecurityAlliance/ )/ 在/ 报告/ 中/ 列举/ 了/ 云/ 计算/ 模式/ 下/ 的/ 十二大/ 风险/ ①/ ,/ 其中/ 恶意/ 内部人员/ (/ MaliciousInsiders/ )/ 威胁/ 赫然/ 在/ 列/ ;/ 对比/ 传统模式/ 下/ 应对/ 内部/ 威胁/ 的/ 典型/ 方法/ [/ 5/ -/ 8/ ]/ ,/ 云/ 计算/ 模式/ 的/ 引入/ 带来/ 了/ 很多/ 新/ 的/ 安全/ 问题/ 和/ 挑战/ [/ 9/ -/ 10/ ]/ ,/ 亟需/ 找到/ 有效/ 的/ 解决办法/ ,/ 比如说/ :/ (/ 1/ )/ 云/ 恶意/ 管理员/ ./ 在/ 云/ 环境/ 下/ 恶意/ 管理员/ (/ 包括/ 云/ 平台/ 管理员/ 、/ 虚拟/ 镜像/ 管理员/ 、/ 系统管理员/ 、/ 应用程序/ 管理员/ 等/ )/ 可/ 利用/ 自己/ 的/ 特权/ 窃取/ 用户/ 隐私/ 数据/ ,/ 由于/ 本身/ 属于/ 防范/ 边界/ 内受/ 信任/ 的/ 实体/ ,/ 传统/ 的/ 安全策略/ 难以/ 防范/ ,/ 如云/ 平台/ 管理员/ 转储/ 虚拟机/ 内存/ 并/ 分析/ 其中/ 的/ 用户/ 数据/ [/ 11/ -/ 12/ ]/ ./ (/ 2/ )/ 利用/ 云/ 带来/ 的/ 漏洞/ ./ 内部人员/ 了解/ 云/ 的/ 组织/ 结构/ 和/ 应用程序/ 特点/ ,/ 可/ 利用/ 其中/ 的/ 漏洞/ 实施/ 恶意/ 攻击/ ./ 如/ 部署/ 在/ 云/ 环境/ 下/ 不同/ 区域/ 的/ 多/ 服务器程序/ 同步/ 消息/ 时/ ,/ 一般/ 情况/ 下/ 同步/ 过程/ 比/ 传统/ 的/ 处于/ 同一/ 区域/ 的/ 本地/ 服务器程序/ 要慢/ ,/ 恶意/ 内部人员/ 可/ 利用/ 这一/ 时间差/ 作恶/ ,/ 窃取/ 数据/ 或/ 获取/ 利益/ [/ 1/ ]/ ./ (/ 3/ )/ 复杂/ 的/ 数据/ 资源/ 和/ 访问/ 接口/ ./ 在/ 云/ 环境/ 下/ 用户/ 和/ 资源/ 的/ 关系/ 是/ 动态变化/ 的/ ,/ 云/ 服务提供商/ 和/ 用户/ 往往/ 并/ 不/ 在/ 相同/ 的/ 安全/ 域/ 中/ ,/ 用户/ 使用/ 的/ 访问/ 终端/ 也/ 是/ 多种多样/ 的/ ,/ 需要/ 动态/ 访问控制/ ./ 基于/ 传统/ 的/ 安全/ 认证/ 并/ 不能/ 防止/ 内部人员/ 作恶/ ,/ 如/ 2.5/ 节/ 所述/ 恶意/ 管理员/ 可/ 偷窥/ 到/ 用户/ 正在/ 访问/ 的/ 虚拟机/ 的/ URL/ 并/ 可/ 直接/ 利用/ 此/ URL/ 进入/ 虚拟机/ ./ (/ 4/ )/ 使用/ 云/ 作恶/ ./ 云/ 环境/ 的/ 引入/ 也/ 为/ 内部人员/ 作恶/ 带来/ 了/ 便利/ ,/ 如/ 恶意/ 内部人员/ 利用/ 云/ 服务/ 的/ 计算/ 处理/ 能力/ 来/ 破解/ 密码文件/ ,/ 或/ 利用/ 云/ 相对/ 便宜/ 、/ 轻松/ 配置/ 的/ 特性/ 发动/ 分布式/ 拒绝服务/ 攻击/ 等/ ./ 内部/ 威胁/ 是/ 近年来/ 网络安全/ 领域/ 研究/ 的/ 热点/ ,/ 国际/ 上/ 也/ 发表/ 了/ 很多/ 这方面/ 的/ 学术/ 成果/ ,/ 如/ 研究/ 人员/ [/ 1/ ,/ 13/ -/ 14/ ]/ 针对/ 新型/ 的/ 云/ 计算/ 模式/ 内部/ 威胁/ 风险/ 及其/ ①/ AllianceCS/ ,/ “/ CSA/ ’/ sCloudComputingTopThreatsinPage3/ 应对/ 展开/ 了/ 研究/ 工作/ ,/ 并/ 取得/ 了/ 一些/ 进展/ ./ 当前/ 国内/ 的/ 内部/ 威胁/ 研究/ 落后/ 于/ 国际/ ,/ 应/ 给予/ 充分/ 重视/ ./ 目前/ CERT/ 安全事件/ 数据库/ 中/ 关于/ 云/ 服务/ 内部/ 攻击/ 的/ 案例/ 并/ 不多见/ [/ 1/ ]/ ,/ 很多/ 公司/ 即使/ 发生/ 了/ 内部/ 攻击/ 也/ 不愿/ 主动/ 向/ 外界/ 公开/ ./ 对于/ 云/ 计算/ 模式/ 内部人员/ 的/ 作恶/ 手段/ ,/ 大部分/ 研究/ 还/ 停留/ 在/ 设想/ 和/ 理论/ 阶段/ ,/ 缺少/ 实际/ 的/ 内部人员/ 攻击/ 案例/ ./ 本文/ 针对/ 真实/ 的/ 云/ 平台/ ,/ 构建/ 和/ 实施/ 切实可行/ 的/ 内部/ 威胁/ 攻击/ 实例/ ,/ 从而/ 让/ 云/ 平台/ 内部/ 安全/ 防护/ 更/ “/ 有的放矢/ ”/ ./ 为/ 进一步/ 深入研究/ 云/ 计算/ 模式/ 内部/ 威胁/ 问题/ 及其/ 应对/ ,/ 从/ 具体/ 方式/ 方法/ 上作/ 系统/ 的/ 归纳/ 和/ 梳理/ ,/ 并/ 促进/ 国内/ 在/ 该/ 方向/ 上/ 的/ 研究/ ,/ 本文/ 结合/ 近几年/ 研究成果/ 从/ 人员/ 评价/ 与/ 行为/ 分析/ 、/ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 、/ 用户/ 可控/ 的/ 数据/ 加密/ 这/ 3/ 个/ 方面/ 进行/ 综述/ ,/ 并/ 对/ 云/ 模式/ 下/ 内部/ 威胁/ 问题/ 的/ 研究/ 方向/ 进行/ 了/ 展望/ ./ 2/ 典型/ 攻击/ 实例/ 为/ 揭示/ 云/ 计算/ 模式/ 内部/ 威胁/ 问题/ ,/ 本文/ 真实/ 实现/ 了/ 恶意/ 内部人员/ 窃取/ 用户/ 数据/ 的/ 攻击/ 实例/ ./ 实例/ 中/ 内部人员/ 可/ 利用/ 自己/ 的/ 特权/ 成功/ 得到/ 用户/ 的/ 隐私/ 数据/ ,/ 例如/ 云/ 管理员/ 可/ 通过/ 修改/ Linux/ 或/ Windows/ 用户/ 虚拟机/ 登录/ 密码/ 侵入/ 虚拟机/ ,/ 制作/ 虚拟机/ 镜像/ 时/ 安装/ 后门/ 程序/ ,/ 利用/ 内存/ 分析/ 工具/ 将/ 虚拟机/ 内存/ 图/ 2/ 修改/ Linux/ 虚拟机/ 密码/ 2.2/ 云/ 管理员/ 篡改/ 虚拟机/ 登录/ 密码/ 在/ 着/ 被/ 入侵/ 的/ 风险/ ./ 如图/ 3/ 所示/ ,/ 大致/ 过程/ 为/ :/ 对于/ 主流/ 云/ 平台/ 上/ 的/ Windows/ 虚拟机/ ,/ 同样/ 存/ (/ 1/ )/ 在/ 主流/ 云/ 平台/ 下/ ,/ 云/ 管理员/ 将/ 安装/ 光盘/ 挂载/ 到/ 虚拟机/ ,/ 并/ 以/ 安装盘/ 启动/ 虚拟机/ ./ (/ 2/ )/ 选择/ 修复/ 计算机/ ,/ 在/ 系统/ 恢复/ 选项/ 中/ ,/ 运行/ 命令提示符/ ./ 在/ system32/ 目录/ 下/ ,/ 用/ cmd/ ./ exe/ 替换/ 导出/ 并/ 分析/ ,/ 通过/ 截获/ 虚拟机/ 的/ 访问/ 会话/ 、/ 进入/ 虚拟机/ 等/ 手段/ 窃取/ 用户/ 隐私/ 数据/ ,/ 如图/ 1/ 所示/ ./ 2.1/ 云/ 管理员/ 删除/ 虚拟机/ 登录/ 密码/ 用户/ 放在/ 云上/ 的/ Linux/ 虚拟机/ ,/ 其/ Root/ 密码/ 是/ 用户/ 自己/ 设定/ 的/ ,/ 防止/ 别人/ 入侵/ ./ 但云/ 管理员/ 可/ 直接/ 对/ Linux/ 虚拟机/ 磁盘/ 文件/ 进行/ 修改/ 绕过/ 检测/ ,/ 登入/ 虚拟机/ 窃取/ 数据/ ./ 如图/ 2/ 所示/ ,/ 大致/ 过程/ 为/ :/ (/ 1/ )/ 在/ OpenStack/ 云/ 平台/ (/ 也/ 可/ 适用/ 于/ 其它/ 云/ 平台/ )/ 下/ ,/ 云/ 管理员/ 登录/ 云/ 平台/ 后/ ,/ 获取/ 云/ 主机/ ID/ ./ (/ 2/ )/ 云/ 管理员/ 登录/ 运行/ 该云/ 主机/ 的/ 物理/ 机/ ,/ 拷贝/ 一个/ 云/ 主机/ 实例/ (/ instance/ )/ ,/ 并/ 将/ 其/ 挂载/ 到/ 另/ 一个/ 操作系统/ 中/ ./ (/ 3/ )/ 编辑/ 用户/ 密码文件/ ,/ 将/ 含有/ 登录/ 用户名/ 和/ 密码/ 的/ 一行/ 删除/ ,/ 绕过/ 用户/ 虚拟机/ 的/ 密码/ 登录/ 环节/ ./ (/ 4/ )/ 云/ 管理员/ 启动/ 该云/ 主机/ 时/ ,/ 可/ 无需/ 密码/ 直接/ 登录/ 该云/ 主机/ ,/ 对云/ 主机/ 进行/ 操作/ ./ 其它/ 可执行程序/ ./ (/ 3/ )/ 重新启动/ 虚拟机/ ,/ 执行/ 被/ 替换/ 的/ 程序/ ,/ 此时/ 实际/ 执行/ cmd/ ./ exe/ ./ (/ 4/ )/ 使用/ 命令行/ 方式/ 修改/ 管理员/ 登录/ 密码/ ./ 2.3/ 云/ 管理员/ 制作/ 带有/ 后门/ 或/ 木马/ 的/ 虚拟机/ 镜像/ 云/ 平台/ 一般/ 拥有/ 大量/ 的/ 计算/ 节点/ ,/ 不/ 可能/ 一个个/ 安装/ ,/ 而是/ 利用/ 虚拟机/ 镜像/ 启动/ 虚拟机/ ./ 如果/ 镜像/ Page4/ 由云/ 平台/ 内部/ 管理人员/ 制作/ ,/ 则/ 云/ 管理员/ 可/ 在/ 镜像/ 中/ 轻松/ 植入/ 后门/ 或/ 木马程序/ ./ 如图/ 4/ 所示/ ,/ 在/ 使用/ 该图/ 3/ 修改/ Windows/ 虚拟机/ 密码/ 图/ 5/ 内存/ 导出/ 与/ 分析/ 2.5/ 云/ 管理员/ 伪造/ URL/ 连接/ 租户/ 虚拟机/ 如图/ 6/ 所示/ ,/ 在/ OpenStack/ 云/ 平台/ 下/ ,/ 云/ 管理员/ 通过/ 更改/ 计算/ 服务/ 配置/ ,/ 以/ 导出/ 虚拟机/ 用户/ VNC/ 方式/ 访问/ 虚拟机/ 的/ 令牌/ (/ token/ )/ 值/ ,/ 从而/ 可以/ 通过/ 构造/ 含有/ 该/ token/ 的/ URL/ ,/ 连接/ 进入/ 到/ 用户/ 虚拟机/ 活动/ 会话/ 的/ VNC/ 桌面/ ./ 3/ 人员/ 评价/ 与/ 行为/ 分析/ 人员/ 评价/ 主要/ 利用/ 心理学/ 和/ 社会学/ 技术/ ,/ 监控/ 并/ 分析/ 内部人员/ 的/ 心理/ 状态/ 变化/ ,/ 一定/ 程度/ 上/ 可以/ 镜像/ 生成/ 用户/ 虚拟机/ 时/ ,/ 系统/ 中将/ 会/ 留下/ 后门/ ,/ 使得/ 云/ 管理员/ 轻松/ 获取/ 虚拟机/ 运行/ 中/ 生成/ 的/ 数据/ ./ 2.4/ 云/ 管理员/ 获取/ 虚拟机/ 敏感/ 信息/ 如图/ 5/ 所示/ ,/ 在/ 主流/ 云/ 平台/ 下/ ,/ 虚拟机/ 用户/ 使用/ 虚拟机/ 时/ 输入/ 了/ 敏感/ 信息/ ./ 云/ 管理员/ 利用/ VMI/ (/ VirtualMachineIntrospection/ )/ [/ 15/ ]/ 工具/ ,/ 导出/ 正在/ 运行/ 的/ 虚拟机/ 的/ 内存/ ,/ 并/ 使用/ 取证/ 工具/ ,/ 如/ Volatility/ ①/ 分析/ 内存/ 内容/ ,/ 通过/ 关键/ 字符串/ 查找/ 匹配/ ,/ 找到/ 敏感/ 信息/ 的/ 内容/ ./ 预测/ 他们/ 的/ 恶意/ 入侵/ 倾向/ ,/ 做到/ 防患于未然/ ./ 行为/ 分析/ 主要/ 通过/ 深度/ 解析/ 历史记录/ 中/ 的/ 用户/ 行为/ 数据/ 形成/ 用户/ 行为/ 特征/ ,/ 然后/ 比/ 对/ 用户/ 操作/ 的/ 实时/ 数据/ 和/ 基于/ 历史/ 操作/ 记录/ 得到/ 的/ 模型/ 就/ 能够/ 识别/ 出/ 恶意/ 的/ 用户/ 行为/ 并/ 提出/ 预警/ ./ 同时/ 人员/ 评价/ 和/ 行为/ 分析/ 可/ 互为补充/ ,/ 协同工作/ ./ 3.1/ 人员/ 评价/ 根据/ 以往/ 的/ 研究/ 报告/ ,/ 内部人员/ 进行/ 恶意/ 操作/ ①/ WaltersA/ ./ Volatility/ :/ AnAdvancedMemoryForensicsPage5/ 图/ 6/ 截获/ token/ 进入/ 虚拟机/ 之前/ 常常/ 伴有/ 较为/ 明显/ 的/ 心理学/ 波动/ 和/ 社会学/ 消极/ 言论/ [/ 16/ ]/ ./ 监控/ 并/ 分析/ 内部人员/ 的/ 心理/ 状态/ 变化/ 一定/ 程度/ 上/ 可以/ 预测/ 他们/ 的/ 恶意/ 入侵/ 倾向/ ,/ 做到/ 防患于未然/ ./ 内部人员/ 心理/ 分析/ 角度/ 可能/ 包括/ 他们/ 是否/ 以/ 自我/ 为/ 中心/ 、/ 是否/ 为/ 人/ 冷漠/ 、/ 是否/ 承受/ 压力/ 、/ 是否/ 傲慢/ 自大/ 、/ 是否/ 敢于/ 铤而走险/ 、/ 是否/ 有/ 很/ 强/ 的/ 抵触情绪/ 等等/ [/ 17/ ]/ ./ 较为/ 公认/ 的/ 心理学/ 分析/ 体系/ 包括/ “/ 黑暗/ 三元组/ ”/ (/ DarkTriad/ )/ 理论/ 和/ “/ 五大/ 人格/ ”/ (/ BigFive/ )/ 理论/ [/ 18/ ]/ ./ 这些/ 理论体系/ 可以/ 将/ 心理学/ 指标/ 数字化/ ,/ 以便/ 更加/ 准确/ 地/ 找出/ 有/ 恶意/ 企图/ 的/ 内部人员/ ./ 内部人员/ 心理学/ 指标/ 的/ 确定/ ,/ 可以/ 依据/ 多方面/ 数据/ 的/ 综合/ 评估/ ./ 分析/ 内部人员/ 的/ 网络/ 言论/ 、/ 工作/ 状态/ 或/ 对/ 内部人员/ 进行/ 心理/ 测验/ 可以/ 直接/ 有效/ 地/ 得到/ 心理学/ 数据/ ./ 也/ 可以/ 根据/ 内部人员/ 的/ 工作/ 环境/ 或/ 人员/ 之间/ 的/ 互相/ 评价/ 间接/ 地/ 分析/ 出/ 他们/ 的/ 心理/ 状态/ ./ 下面/ 将/ 简要/ 介绍/ 几个/ 较/ 有/ 代表性/ 的/ 相关/ 工作/ ./ Greitzer/ 等/ 人/ [/ 19/ ]/ 基于/ 大量/ 的/ 事件/ 实例/ 和/ 行为/ 心理学/ 关联/ 研究/ 构建/ 了/ 较为/ 成熟/ 的/ 内部人员/ 潜在/ 威胁/ 分析模型/ ./ 为/ 收集/ 内部人员/ 的/ 心理学/ 数据/ ,/ 该/ 研究/ 项目组/ 首先/ 咨询/ 了/ 组织/ 内部/ 的/ 管理/ 阶层/ 和/ 人力资源/ 团队/ ,/ 收集整理/ 出/ 人为/ 观测/ 的/ 结果/ ./ 而后/ 数据/ 驱动/ 的/ 心理学/ 推理/ 系统/ 将/ 观测/ 结果/ 对应/ 到/ 不同/ 的/ 心理学/ 指示器/ 上/ (/ 包括/ 压力/ 指数/ 、/ 不满/ 指数/ 等等/ )/ ./ 该/ 模型/ 的/ 实现/ 主要/ 可/ 分为/ 两大/ 步骤/ :/ 第/ 1/ 步/ 将/ 心理学/ 指示器/ 和/ 心理学/ 风险/ 指数/ 对应/ 为/ “/ 贝叶斯/ 信念/ 网/ ”/ 的/ 二进制/ 变量/ 节点/ ,/ 并/ 进行/ 有/ 监督/ 的/ 机器/ 学习/ [/ 20/ ]/ ./ 该/ 学习/ 的/ 目的/ 是/ 模拟出/ 各个/ 指示器/ 优先级/ 和/ 权值/ ./ 第/ 2/ 步/ 利用/ 学习/ 得到/ 的/ 模型/ 分析/ 新/ 的/ 员工/ 心理/ 指标/ ,/ 得出/ 他们/ 造成/ 内部/ 威胁/ 的/ 可能/ 值/ ./ 这种/ 方法/ 的/ 优点/ 在于/ 将/ 抽象/ 的/ 心理学/ 指标/ 数字化/ ,/ 有助于/ 进行/ 准确/ 的/ 量化/ 分析/ ./ 随后/ Greitzer/ 等/ 人/ [/ 21/ ]/ 分析/ 内部人员/ 作恶/ 前/ 的/ 行为表现/ ,/ 提出/ 的/ 心理学/ 指标/ 包括/ 愤怒/ 、/ 不/ 接受/ 反馈/ 、/ 情绪/ 管理/ 问题/ 、/ 空闲/ 时间/ 、/ 无视/ 权威/ 、/ 效率/ 、/ 压力/ 、/ 对抗性/ 行为/ 、/ 个人/ 问题/ 、/ 自我/ 、/ 可靠性/ 、/ 旷工/ 等/ ./ Nurse/ 等/ 人/ [/ 22/ ]/ 构建/ 表征/ 内部/ 威胁/ 的/ 一个/ 基础/ 框架/ ,/ 提出/ 内部/ 威胁/ 问题/ 空间/ 的/ 分类/ ,/ 包括/ 突发事件/ 、/ 人格/ 特征/ 、/ 历史/ 行为/ 、/ 心理/ 状态/ 、/ 对待/ 工作/ 态度/ 、/ 技能/ 、/ 机会/ 和/ 攻击/ 动机/ ./ Hashem/ 等/ 人/ [/ 23/ ]/ 利用/ 人类/ 生物/ 信号/ (/ 脑电图/ 和/ 心电图/ 信号/ )/ 来/ 检测/ 恶意/ 活动/ ./ Tausczik/ 等/ 人/ [/ 24/ ]/ 分析/ 日常/ 使用/ 的/ 词语/ 中/ 在/ 心理学/ 有/ 意义/ 的/ 类别/ 词/ ,/ 用以/ 检测/ 人员/ 的/ 心理/ 状态/ ,/ 如/ 注意/ 焦点/ 、/ 情感/ 、/ 社会关系/ 、/ 思维/ 样式/ 和/ 个体差异/ 等/ ./ 通过/ 案例/ 研究/ 证明/ 这种/ 方法/ 对/ 预防/ 内部/ 威胁/ 的/ 发生/ 具有/ 一定/ 的/ 有效性/ ,/ 但/ 这种/ 方法/ 容易/ 侵犯/ 用户/ 隐私/ ,/ 且/ 应用/ 与/ 实践/ 的/ 成熟/ 系统/ 很少/ ,/ 准确性/ 不好/ 验证/ ./ 3.2/ 行为/ 分析/ 用户/ 在/ 使用/ 云/ 平台/ 服务/ 时/ ,/ 会/ 留下/ 大量/ 的/ 日志/ 信息/ 和/ 行为/ 轨迹/ ,/ 我们/ 将/ 其/ 称之为/ “/ 用户/ 行为/ 数据/ ”/ ./ 这些/ 数据/ 一定/ 程度/ 上/ 反映/ 出/ 了/ 用户/ 的/ 个人/ 特征/ 和/ 使用/ 意图/ ./ 作为/ 用户/ 行为/ 分析/ 的/ 基石/ ,/ 用户/ 行为/ 数据/ 的/ 采集/ 和/ 处理/ 可谓/ 至关重要/ ./ 因此/ ,/ 如何/ 采集/ 数据/ 和/ 采集/ 什么/ 数据/ 这/ 两大/ 问题/ 是/ 用户/ 行为/ 分析/ 工作/ 开展/ 之前/ 要/ 着重/ 调研/ 和/ 解决/ 的/ 问题/ ./ 本文/ 汇总/ 了/ 目前/ 用户/ 行为/ 分析/ 中/ 常见/ 的/ 数据/ 类别/ ,/ 并/ 对/ 相关/ 工作/ 进行/ 了/ 总结/ 和/ 评价/ ./ 本文/ 将/ 目前/ 可/ 用于/ 用户/ 行为/ 分析/ 的/ 数据/ 概括/ 为/ 以下/ 4/ 个/ 类别/ :/ 用户/ 的/ 认证/ 信息/ 、/ 网络/ 数据/ 信息/ 、/ 用户/ 的/ 活动/ 日志/ 、/ 用户/ 的/ 生物学/ 行为/ 特征/ ./ 其/ 具体/ 阐述/ 如下/ :/ (/ 1/ )/ 用户/ 的/ 认证/ 信息/ ./ 用户/ 在/ 接入/ 云/ 服务/ 时/ 用于/ 确认/ 用户/ 身份/ 的/ 基本/ 信息/ ,/ 包括/ 用户/ 标志/ 、/ 用户/ 密码/ 、/ 用户/ 指纹/ 等/ ./ 更进一步/ 地/ 采集/ 用户/ 所在/ 的/ 位置/ (/ IP地址/ )/ 、/ 用户/ 的/ 权限/ 等级/ [/ 25/ ]/ 、/ 用户/ 的/ 物理地址/ [/ 26/ ]/ 也/ 属于/ 直接/ 认证/ 的/ 范畴/ ./ 直接/ 采集/ 用户/ 的/ 基本/ 认证/ 信息/ 可以/ 准确/ 快速/ 地/ 识别/ 用户/ ,/ 当/ 用户/ 进行/ 恶意/ 操/ Page6/ 作时/ ,/ 这/ 一类/ 数据/ 有助于/ 直接/ 定位/ 恶意/ 用户/ ./ 然而/ 仅仅/ 采集/ 用户/ 基本/ 认证/ 信息/ 来/ 定位/ 恶意/ 用户/ 的/ 方式/ 并/ 不/ 完善/ ,/ 例如/ 用户名/ 和/ 密码/ 等/ 信息/ 已/ 被/ 他人/ 窃取/ [/ 27/ ]/ ,/ 用户/ 的/ IP地址/ 等/ 信息/ 已/ 被/ 伪造/ ./ Kent/ 等/ 人/ [/ 28/ ]/ 基于/ 图/ 的/ 用户/ 分类/ 和/ 入侵/ 检测/ 方法/ ,/ 把/ 网络/ 身份/ 认证/ 活动/ 的/ 数据/ 通过/ 用户/ 特定/ 的/ 图/ 和/ 图/ 特征/ 表现/ 出来/ ,/ 提供/ 综合/ 分析/ 用户/ 异常/ 行为/ 的/ 方法/ ./ (/ 2/ )/ 网络/ 数据/ 信息/ ./ 用户/ 在/ 使用/ 云/ 服务/ 的/ 过程/ 中/ ,/ 会/ 在/ 网络/ 上/ 留下/ 大量/ 的/ 数据/ 信息/ (/ 网站/ 接入/ 信息/ 、/ 云/ 主机/ 记录/ 、/ 网络/ 输出/ 记录/ 、/ 网站/ 访问/ 记录/ 、/ 防火墙/ 信息/ 、/ DNS/ 记录/ 等/ )/ ,/ 深入分析/ 这些/ 信息/ 可以/ 及时发现/ 内部/ 危险/ 行为/ 并/ 进行/ 预警/ ./ 采集/ 这些/ 细节/ 的/ 网络/ 数据/ 信息/ ,/ 可以/ 从根本上/ 对/ 内部/ 入侵/ 进行/ 防护/ ,/ 但/ 其/ 缺点/ 在于/ 数据/ 收集/ 和/ 整理/ 的/ 工作量/ 较大/ ./ Gavai/ 等/ 人/ [/ 29/ ]/ 首先/ 提出/ 标志/ 内部/ 威胁/ 的/ 相关/ 特征/ ,/ 如/ 电子邮件/ 交流/ 模式/ 和/ 内容/ 特征/ 、/ 电子邮件/ 频率/ 、/ 登入/ 登出/ 特征/ 、/ 应用程序/ 使用/ 特征/ 、/ 浏览/ 网页/ 使用/ 特征/ 及/ 文件/ 机器/ 访问/ 模式/ ,/ 结合/ 异常/ 分析/ 算法/ 预测/ 异常/ 行为/ ./ Mayhew/ 等/ 人/ [/ 25/ ]/ 使用/ 基于/ 行为/ 的/ 访问控制/ (/ BBAC/ )/ 计算/ 访问者/ 的/ 可信性/ (/ 如/ 行为/ 和/ 使用/ 模式/ )/ 及/ 验证/ 文件/ 的/ 属性/ (/ 如/ 数据/ 依赖/ 关系/ )/ ,/ 以/ 判断/ 活动/ 是否/ 合法/ ./ 观测/ 内容/ 包括/ 网络连接/ 、/ HTTP/ 请求/ 、/ 电子邮件/ 或/ 聊天/ 信息/ 及/ 文档/ 编辑/ 序列/ ./ (/ 3/ )/ 用户/ 的/ 活动/ 日志/ ./ 用户/ 在/ 使用/ 系统/ 时/ 系统对/ 用户/ 具体操作/ 进行/ 的/ 详细/ 记录/ ./ 用户/ 日志/ 详尽/ 地/ 描述/ 了/ 用户/ 进行/ 的/ 一系列/ 活动/ ,/ 例如/ Web/ 服务器/ 日志/ [/ 30/ ]/ 、/ 活动/ 目录/ 日志/ 数据/ [/ 31/ ]/ 、/ 用户/ 使用/ Unix/ 命令/ 日志/ [/ 32/ ]/ 等/ ./ 因此/ ,/ 它/ 被/ 广泛/ 地/ 用于/ 检测/ 组织/ 内部人员/ 的/ 可疑/ 活动/ ./ 由于/ 用户/ 日志/ 数据/ 数量/ 庞大/ ,/ 且/ 随着/ 用户/ 的/ 使用/ 不断/ 增长/ ,/ 自动化/ 数据分析/ 成为/ 目前/ 面临/ 的/ 一大/ 挑战/ ./ (/ 4/ )/ 用户/ 的/ 生物学/ 行为/ 特征/ ./ 用户/ 在/ 使用/ 终端/ 进行/ 操作/ 时/ ,/ 硬件/ 可以/ 采集/ 用户/ 使用/ 模式/ 特征/ 或/ 固有/ 特性/ ./ 如/ 用户/ 使用/ 键盘/ 和/ 鼠标/ [/ 33/ -/ 36/ ]/ 的/ 最/ 常用/ 的/ 使用/ 习惯/ 信息/ 、/ 用户/ 的/ 指纹/ 或/ 虹膜/ 信息/ [/ 37/ -/ 38/ ]/ 等/ ./ 分析/ 这/ 类/ 数据/ 可以/ 准确/ 地/ 判断/ 操作者/ 是否/ 为/ 本人/ ,/ 从而/ 及时发现/ 用户/ 账号密码/ 被/ 窃取/ 情况/ ./ 分析/ 某一/ 用户/ 的/ 生物学/ 特征/ 可以/ 模拟出/ 他/ 的/ 使用/ 习惯/ 和/ 个人/ 特征/ ./ 当/ 其他/ 人员/ (/ 可能/ 包括/ 恶意/ 人员/ )/ 得到/ 该/ 用户/ 的/ 账户/ 和/ 密码/ 并/ 接入/ 系统/ 时/ ,/ 系统/ 会/ 发现/ 其/ 使用/ 习惯/ 或/ 个人/ 特征/ 异常/ 之/ 处/ ,/ 从而/ 引发/ 预警/ ./ 评价/ 用户/ 生物/ 、/ 行为学/ 特征/ 的/ 认证/ 分析/ 系统/ 可以/ 从/ 漏报/ 率/ 、/ 误报率/ 、/ 学习/ 构建/ 时间/ 和/ 健壮性/ 四个/ 方面/ 着手/ ./ 不同/ 角度/ 和/ 侧重/ 的/ 用户/ 生物学/ 特征/ 具有/ 各自/ 的/ 优势/ 和/ 不足/ ./ 例如/ :/ 采集/ 并/ 分析/ 用户/ 的/ 指纹/ 或/ 虹膜/ 信息/ 可以/ 最/ 准确/ 地/ 识别/ 用户/ 是否/ 为/ 本人/ ,/ 但/ 需要/ 昂贵/ 的/ 硬件/ 支持/ 和/ 特定/ 采集/ 环境/ ;/ 采集/ 用户/ 键盘/ 的/ 击键/ 序列/ 和/ 击键/ 习惯/ 信息/ 也/ 是/ 一种/ 常见/ 的/ 用户/ 身份验证/ 方式/ ,/ 这种/ 方式/ 的/ 采集/ 不/ 需要/ 额外/ 的/ 硬件/ 添加/ 方案/ 实施/ 简单/ ,/ 但是/ 容易/ 因为/ 硬件/ 的/ 更换/ 而/ 受到/ 影响/ ,/ 并且/ 在/ 采集/ 生物学/ 特征/ 的/ 同时/ 收集/ 了/ 大量/ 的/ 用户/ 个人信息/ (/ 个人/ 密码/ 、/ 输入/ 信息/ 等/ )/ ./ 本文/ 选取/ 了/ 以下/ 两种/ 生物学/ 特征分析/ 方法/ 进行/ 研究/ 和/ 评估/ ./ 利用/ 键盘/ 和/ 鼠标/ 使用/ 习惯/ 的/ 分析/ 可以/ 实时/ 验证/ 用户/ 的/ 行为/ 特征/ ,/ 防止/ 了/ 用户/ 登录/ 后/ 暂离/ 时/ 的/ 安全隐患/ ./ Zheng/ 等/ 人/ [/ 33/ ]/ 提出/ 了/ 一种/ 基于/ 鼠标/ 轨迹/ 分析/ 的/ 用户/ 身份验证/ 系统/ ./ 该/ 系统/ 具有/ 三大/ 优势/ :/ 较/ 低/ 的/ 漏报/ 率/ 和/ 误报率/ 、/ 快速/ 的/ 验证/ 响应速度/ 、/ 强大/ 的/ 抗/ 模仿/ 能力/ ./ 根据/ 具体/ 功能/ 的/ 不同/ ,/ 我们/ 可/ 将/ 该/ 系统/ 划分/ 为/ 四大/ 部分/ :/ 记录器/ (/ Recorder/ )/ 、/ 预/ 处理器/ (/ Pre/ -/ processor/ )/ 、/ 分类器/ (/ Classifier/ )/ 和/ 决策/ 器/ (/ Decision/ )/ ./ 记录器/ 以/ 四元组/ (/ 操作/ 类型/ ,/ 时间/ ,/ X/ 坐标/ ,/ Y/ 坐标/ )/ 的/ 形式/ 实时/ 记录/ 用户/ 的/ 鼠标/ 轨迹/ ,/ 而后/ 输出/ 到/ 预/ 处理器/ ./ 预/ 处理器/ 以/ 鼠标/ 点击/ 为/ 分隔/ 整理/ 成/ 多组/ 序列/ ./ 与此同时/ ,/ 预/ 处理器/ 还/ 将/ 原本/ 的/ 四元组/ 数据/ 换算/ 成/ 向量/ 方向/ (/ Direction/ )/ 、/ 曲率/ 角/ (/ AngleofCurvature/ )/ 、/ 曲率/ 距离/ 比例/ (/ CurvatureDistance/ )/ 的/ 三元组/ ,/ 从而/ 降低/ 了/ 硬件平台/ 的/ 依赖性/ ,/ 提高/ 了/ 用户/ 之间/ 的/ 独特性/ ./ 分类器/ 针对/ 每一/ 用户/ ,/ 将/ 本/ 用户/ 的/ 鼠标/ 轨迹/ 信息/ 作为/ 正/ 样本/ 、/ 将/ 非本/ 用户/ 的/ 鼠标/ 轨迹/ 信息/ 作为/ 负/ 样本/ 输入/ 支持/ 向量/ 机/ (/ SVM/ )/ 中/ ,/ 从而/ 得到/ 本/ 用户/ 的/ 鼠标/ 特征/ 分类/ ./ 最后/ ,/ 身份验证/ 系统/ 实时/ 采集/ 用户/ 的/ 鼠标/ 轨迹/ 信息/ ,/ 根据/ 分类器/ 的/ 结果/ 进行/ 决策/ ./ 为/ 使得/ 决策/ 结果/ 更加/ 准确/ ,/ 该/ 系统/ 使用/ 了/ 多数/ 投票/ 法/ (/ MajorityVotes/ )/ 作为/ 决策/ 器/ 的/ 主要/ 决策/ 算法/ ./ 目前/ ,/ 触屏/ 智能手机/ 得到/ 了/ 广泛/ 地/ 应用/ 于/ 公司/ 内部人员/ 的/ 日常/ 工作/ ,/ 然而/ 相比/ 于/ 个人/ PC/ ,/ 终端设备/ 更/ 易/ 丢失/ 或/ 泄漏/ 重要/ 办公/ 信息/ ./ 为/ 解决/ 触屏/ 移动/ 终端/ 被/ 入侵/ 的/ 问题/ ,/ Sae/ -/ Bae/ 等/ 人/ [/ 34/ ]/ 和/ DeLuca/ 等/ 人/ [/ 35/ ]/ 等/ 人/ 针对/ 目前/ 广泛/ 使用/ 的/ 智能手机/ ,/ 设计/ 了/ 基于/ 触屏/ 使用/ 轨迹/ 的/ 认证/ 系统/ ./ 相比/ 上述/ 两者/ 的/ 工作/ ,/ Frank/ 等/ 人/ [/ 36/ ]/ 实现/ 了/ 触屏/ 轨迹/ 的/ 连续/ 认证/ (/ ContinuousAuthentication/ )/ 系统/ ,/ 其/ 优点/ 在于/ 认证/ 过程/ 透明/ 于/ 用户/ 且/ 可以/ 分析/ 检验/ 日常/ 的/ 用户/ 操作/ ./ 从/ 宏观/ 上/ 来讲/ ,/ Frank/ 等/ 人/ 构建/ 的/ 系统/ 可/ 分为/ 两/ 大部分/ :/ 登记/ 学习/ 阶段/ (/ EnrollmentPhase/ )/ 和/ 连续/ 认证/ 阶段/ (/ ContinuousAuthenticationPhase/ )/ ./ 前者/ 是/ 认证/ 系统/ 的/ 数据/ 训练/ 阶段/ ./ 由于/ 该/ 阶段/ 使用/ 有/ 监督/ 学习/ ,/ 系/ Page7/ 统/ 需要/ 依赖/ 常规/ 认证/ 手段/ (/ 如/ 账户/ 密码/ 等/ )/ ./ 为/ 更好/ 地/ 采集/ 数据/ ,/ 作者/ 定义/ 了/ 触发/ 动作/ (/ Trigger/ -/ Actions/ )/ 这一/ 概念/ ,/ 触发/ 动作/ 在/ 所有/ 的/ 用户/ 用例/ 中/ 都/ 很/ 常见/ 而且/ 几乎/ 是/ 所有/ 复杂/ 动作/ 的/ 一部分/ ./ 该/ 系统/ 选定/ 的/ 触发/ 动作/ 有/ 两种/ :/ 水平/ 划过/ 屏幕/ 、/ 以/ 页面/ 上下/ 移动/ 为/ 目的/ 的/ 垂直/ 划过/ 屏幕/ ./ 通过/ 不断/ 监听/ 、/ 分析/ 这些/ 动作/ ,/ 系统/ 提取/ 出/ 用户/ 触屏/ 轨迹/ 特征/ 并/ 加以/ 分类/ ./ 分类/ 学习/ 完成/ 之后/ ,/ 系统/ 进入/ 连续/ 认证/ 阶段/ ./ 这一/ 阶段/ 中/ ,/ 系统/ 不间断/ 地/ 采集/ 所有/ 用户/ 触屏/ 轨迹/ ,/ 并/ 通过/ 分类器/ 识别/ 这些/ 轨迹/ 是否/ 来自/ 合法/ 用户/ ./ 这/ 一部分/ 的/ 性能/ (/ 包括/ 认证/ 准确性/ 和/ 响应/ 时间/ )/ 主要/ 受到/ 登记/ 学习/ 阶段/ 过程/ 中/ 分类/ 精度/ 的/ 影响/ ./ 当/ 用户/ 的/ 移动/ 终端/ 被/ 窃取/ 时/ ,/ 系统/ 可以/ 及时发现/ 手机/ 遗失/ ,/ 并/ 根据/ GPS/ 定位/ 窃取/ 者/ ./ 行为/ 分析/ 需要/ 收集/ 大量/ 用户/ 历史/ 操作/ 数据/ ,/ 存在/ 一定/ 的/ 误报率/ 或/ 漏报/ 率/ ,/ 结合/ 其他/ 技术/ 如/ 人员/ 评价/ 可/ 在/ 一定/ 程度/ 上/ 缓解/ 处理/ 大量/ 数据/ 的/ 压力/ ,/ 降低/ 误报率/ 或/ 漏报/ 率/ ./ Greitzer/ 等/ 人/ [/ 16/ ]/ 描述/ 了/ 一个/ 用于/ 检测/ 内部/ 风险/ 行为/ 并/ 触发/ 报警/ 的/ 预测/ 模型/ ,/ 行为/ 分析/ 结合/ 心理/ 数据/ ,/ 捕获/ 恶意/ 内部人员/ 从事/ 恶意/ 活动/ 的/ 迹象/ ,/ 用于/ 告警/ ./ 心理学/ 指标/ 包括/ 职场/ 行为/ 、/ 个人行为/ 、/ 人力资源/ 数据/ 等/ ./ 技术指标/ 包括/ 系统日志/ 、/ 入侵/ 检测/ 、/ 数据/ 防/ 丢失/ 等/ ./ 本/ 方法/ 使用/ 人员/ 评价/ 过滤/ 数据/ ,/ 准确性/ 有待/ 验证/ ,/ 需/ 进一步/ 优化/ 改进/ ./ Brdiczka/ 等/ 人/ [/ 39/ ]/ 提出/ 了/ 一种/ 基于/ 用户/ 日志/ 的/ 图/ 结构/ 行为/ 分析/ 系统/ ,/ 并/ 结合/ 心理学/ 剖析/ 进行/ 威胁/ 综合/ 评定/ ,/ 心理学/ 剖析/ 的/ 加入/ 大大降低/ 了/ 结构/ 异常/ 分析/ 的/ 误警率/ ,/ 提高/ 了/ 系统/ 的/ 可用性/ ./ 相对而言/ ,/ 结构/ 异常/ 分析/ 的/ 加入/ 使得/ 该/ 系统/ 比/ 单纯/ 进行/ 心理学/ 、/ 社会学/ 分析/ 的/ 系统/ 更加/ 精确/ 、/ 更加/ 严谨/ ./ 其/ 系统/ 概况/ 如图/ 7/ 所示/ ./ 结构/ 异常/ 分析/ 可/ 分为/ 4/ 个/ 步骤/ :/ (/ 1/ )/ 图/ 结构/ 分析/ (/ GraphStructureAnalysis/ )/ ./ 内部/ 员工/ 在/ 进行/ 日常/ 工作/ 时/ 总是/ 大量/ 地/ 重复/ 某些/ 操作/ ./ 我们/ 认为/ 这些/ 日常/ 操作/ 是/ 无害/ 、/ 安全/ 的/ “/ 正常/ 行为/ ”/ ./ 图/ 结构/ 分析/ 的/ 作用/ 是/ 将/ “/ 正常/ 行为/ ”/ 与/ “/ 异常/ 行为/ ”/ 进行/ 区分/ ,/ 从而/ 发现/ 信息网络/ 数据/ 的/ 异常/ 特征/ ,/ 根据/ 这种/ 特征/ 将/ 类似/ 数据/ 进行/ 关联/ ,/ 从而/ 减少/ 数据分析/ 的/ 工作量/ ./ (/ 2/ )/ 图/ 嵌入/ (/ GraphEmbedding/ )/ ./ 将/ 图/ 结构/ 分析/ 中得/ 的/ 关联/ 数据/ 进行/ 聚类/ ,/ 同一/ 分类/ 中/ 的/ 图/ 节点/ (/ 代表/ 用户/ )/ 具有/ 更/ 高/ 的/ 关联性/ ,/ 这/ 当中/ 运用/ 到/ 了/ 机器/ 学习/ 的/ 一些/ 分类/ 算法/ ./ (/ 3/ )/ 动态/ 追迹/ (/ DynamicTracking/ )/ ./ 动态/ 追迹/ 用于/ 监视/ 异常/ 行为/ 模式/ 下/ 的/ 个人行为/ ,/ 其中/ 用到/ 了/ 一些/ 固定/ 欧式/ 空间/ 下/ 的/ 动态/ 实体/ 追迹/ 方法/ (/ 如/ 贝叶斯/ 方法/ )/ ./ (/ 4/ )/ 异常/ 检测/ (/ AnomalyDetection/ )/ ./ 动态/ 追迹/ 过程/ 中/ ,/ 追迹/ 系统/ 将/ 主体/ 行为/ 处理/ 成多/ 变量/ 行为/ 序列/ ,/ 序列/ 中/ 的/ 变量/ 是/ 一些/ 内部人员/ 的/ 属性/ ./ 异常/ 检测/ 利用/ 这些/ 序列/ 和/ 已知/ 的/ 异常/ 行为/ 构建/ 一个/ 概率模型/ ,/ 并/ 利用/ 这一/ 模型/ 来/ 识别/ 新/ 的/ 异常/ 行为/ ./ 行为/ 分析/ 可以/ 有效/ 地/ 验证/ 用户/ 是否是/ 真正/ 的/ 用户/ ,/ 但/ 其/ 本身/ 为/ 被动/ 防御/ ,/ 如果/ 用户/ 本身/ 想要/ 作恶/ ,/ 且/ 操作/ 极其/ 隐蔽/ ,/ 则/ 可能/ 逃/ 过/ 检测/ ,/ 怎样/ 提高/ 拦截/ 的/ 时效性/ 也/ 是/ 研究/ 的/ 重点/ ./ 4/ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 这种/ 技术/ 路线/ 主要/ 针对/ 云/ 系统/ 中/ 资源/ 或/ 数据/ 制定/ 细粒度/ 权限/ 划分/ ;/ 或是/ 在/ 硬件/ 层/ 或/ 虚拟机/ 管理器/ 层/ 对/ 用户/ 数据/ 的/ 访问/ 进行/ 执行/ 时/ 验证/ ,/ 使/ 管理员/ 即使/ 拥有/ 系统/ 权限/ 也/ 无法/ 得到/ 客户/ 的/ 真实/ 数据/ ./ 4.1/ 云/ 管理权限/ 划分/ 在/ 虚拟化/ 平台/ 中/ ,/ 虚拟机/ 管理器/ (/ VMM/ )/ 是/ 云/ 平台/ 最有/ 权限/ 的/ 软件/ ,/ 可以/ 访问/ 包括/ 用户/ 虚拟机/ (/ VM/ )/ 的/ 所有/ 资源/ ./ 特权/ 域/ (/ Dom0/ )/ 是/ 用户/ VM/ 管理/ 域/ ,/ 管理/ 和/ 复用/ 硬件资源/ ,/ 管理/ 客户/ 虚拟机/ ,/ 比/ 客户/ 虚拟机/ 拥有/ 更/ 多/ 特权/ ./ 传统/ 的/ VMM/ 赋予/ Dom0/ 的/ 权限/ 太/ 大/ ,/ 致使/ 恶意/ 的/ 内部/ 管理员/ 可以/ 利用/ Dom0/ 的/ 权限/ 侵害/ 用户/ 数据/ 隐私/ ,/ 如云/ 管理员/ 可/ 利用/ 虚拟机/ 管理/ 域/ 导出/ 虚拟机/ 内存/ 窃取/ 用户/ 数据/ ./ 自/ 服务/ 云/ 计算/ 模型/ (/ SSC/ )/ [/ 40/ ]/ 利用/ 隔离/ 虚拟机/ 、/ 分割/ Dom0/ 特权/ 来/ 防止/ 特权/ 域/ 对/ 用户/ 隐私/ 造成/ 威胁/ ,/ VMM/ 将/ 原有/ Dom0/ 的/ 权限/ 分离/ ,/ 以/ 防止/ 用户/ 数据/ 受到/ 来自/ 管理/ 域/ 的/ 攻击/ 威胁/ ./ SSC/ 中/ 的/ 虚拟机/ 管理器/ 将/ 原有/ 管理/ 域/ 的/ 权限/ 分离/ ,/ 并/ 提供/ 了/ 两类/ 管理/ 域/ :/ (/ 1/ )/ 由云/ 管理员/ 使用/ 的/ 解除/ 特权/ 的/ 系统管理/ 域/ ./ Page8/ (/ 2/ )/ 基于/ 用户/ 的/ 管理/ 域/ ,/ 用户/ 可以/ 使用/ 该/ 管理/ 域/ 管理/ 自身/ 虚拟机/ ./ 这种/ 新型/ 权限/ 模型/ 阻止/ 了/ 恶意/ 的/ 内部/ 管理员/ 去/ 监听/ 或者/ 修改/ 用户/ 虚拟机/ 状态/ ,/ 并且/ 使/ 用户/ 更加/ 灵活/ 地/ 控制/ 自己/ 的/ 虚拟机/ ./ 如图/ 8/ 所示/ ,/ SSC/ 特权/ 模型/ 划分/ 为/ 4/ 类/ 计算/ 模型/ :/ Sdom0/ 是/ 由/ 云/ 管理员/ 使用/ 的/ 解除/ 特权/ 的/ 系统管理/ 域/ ./ Sdom0/ 中/ 保留/ 启动/ 或/ 停止/ Udom0/ 域/ 的/ 权限/ ,/ 并/ 运行/ 虚拟化/ 设备/ 的/ 驱动程序/ ,/ 管理/ 硬件资源/ ./ SSC/ 的/ 权限/ 模型/ 禁止/ Sdom0/ 检查/ 客户/ 域/ 的/ 状态/ ,/ 没有/ 访问/ 客户/ 虚拟机/ 的/ 权限/ ,/ 确保/ 客户/ 域/ 的/ 安全性/ 和/ 隐私/ 性/ ./ Udom0/ 为/ 基于/ 用户/ 的/ 管理/ 域/ ,/ 用户/ 可以/ 使用/ 该/ 管理/ 域/ 实现/ 对/ 自身/ 虚拟机/ 的/ 管理/ ,/ 委托/ 其/ 特权/ 到/ 服务/ 域/ ./ ServiceVM/ 为/ 客户/ 虚拟机/ 提供/ 客户/ 定制/ 的/ 服务/ ,/ 如/ 验证/ VM/ 完整性/ 、/ 入侵/ 检测/ 和/ VM/ 数据/ 加密/ 等/ ./ MutuallyTrustedServiceVM/ 按照/ 云/ 平台/ 和/ 用户/ 之间/ 的/ 协商/ 执行/ 对/ 虚拟机/ 的/ 监控/ ,/ 防止/ 虚拟机/ 用户/ 滥用/ 服务/ ./ 客户/ 首先/ 与/ DomB/ 建立/ 加密/ 通道/ 传输数据/ ,/ 如/ Udom0/ 镜像/ ./ Udom0/ 由/ DomB/ 验证/ 镜像/ 完整性/ 并/ 启动/ Udom0/ ,/ 从而/ 确保/ Udom0/ 的/ 安全/ 可信/ ./ DomB/ 建立/ Udom0/ 虚拟机/ ,/ 将/ 用户/ 密钥/ 置于/ Udom0/ 内存/ 中/ ,/ 之后/ Udom0/ 与/ 用户/ 建立/ 加密/ 可信/ 通道/ ,/ 传输/ 虚拟机/ 镜像/ 或/ 服务/ 镜像/ ./ Udom0/ 调用/ DomB/ 建立/ 镜像/ 对应/ 的/ 虚拟机/ ./ 这种/ 新型/ 权限/ 模型/ 的/ 不足/ 是/ 需要/ 在/ 云/ 平台/ 安装/ 安全/ 芯片/ ,/ 且/ 需要/ 改变/ 虚拟机/ 管理程序/ 架构/ 和/ 用户/ 镜像/ ,/ 不利于/ 实施/ ./ 4.2/ 云/ 执行/ 时/ 验证/ 云/ 执行/ 时/ 验证/ 通过/ 仲裁/ VMM/ 和/ 虚拟机/ 之间/ 的/ 控制/ 转移/ 保护/ 用户/ 的/ 数据/ 隐私/ ./ 为/ 防止/ 恶意/ 或/ 好奇/ 的/ 管理员/ 偷窥/ 或/ 修改/ 租户/ 的/ 虚拟机/ 状态/ ,/ 缩小/ 可信计算/ 域/ ,/ CloudVisor/ [/ 41/ ]/ 利用/ 嵌套/ 虚拟化/ 技术/ 保护/ 虚拟化/ 资源/ ,/ 使/ 恶意/ 管理员/ 即使/ 完全/ 控制/ VMM/ 和/ Dom0/ 也/ 不能/ 窃取/ 用户/ 虚拟机/ 隐私/ ,/ 大大减少/ 了/ 可信计算/ 域/ 的/ 大小/ 和/ 风险/ ./ CloudVisor/ 通过/ 在/ 一般/ 云/ 操作系统/ 上加/ 一层/ 安全/ 管理层/ ,/ 来/ 保证/ 云/ 操作系统/ 本身/ 的/ 安全性/ ,/ 提供/ 虚拟机/ 状态/ 的/ 保密性/ 和/ 完整性/ ./ CloudVisor/ 运行/ 在/ 最高/ 特权/ 模式/ 下/ ,/ 而/ VMM/ 运行/ 在/ 非/ 特权/ 模式/ ./ CloudVisor/ 利用/ 最高/ 特权/ 层/ ,/ 使用/ 硬件/ 辅助/ 虚拟化/ 技术/ 实施/ 内存/ 隔离/ ,/ VMM/ 和/ 虚拟机/ 之间/ 的/ 控制/ 转移/ 通过/ CloudVisor/ 仲裁/ ,/ 不/ 允许/ VMM/ 到/ VM/ 内存/ 的/ 非法/ 映射/ ./ 其中/ ,/ 控制/ 转移/ 过程/ 中/ 虚拟机/ 的/ 执行/ 上下文/ 被/ CloudVisor/ 安全/ 的/ 保存/ 和/ 恢复/ ./ 这种/ 方法/ 也/ 需要/ 在/ 云/ 平台/ 安装/ 安全/ 芯片/ ,/ 并且/ 需要/ 修改/ VMM/ 程序/ ,/ 存在/ 兼容性问题/ ./ 为/ 保证/ 平台/ 可信/ 启动/ ,/ 在/ BIOS/ 载入/ 启动/ 程序/ 之前/ ,/ BIOS/ 首先/ 会/ 利用/ 哈希/ 验证/ 启动/ 程序/ ./ 哈希/ 存储/ 在/ 硬件安全/ 芯片/ 中/ ./ 启动/ 程序/ 会/ 去/ 验证/ CloudVisor/ 二进制/ 程序/ ./ 平台/ 启动/ 后/ ,/ 远程/ 用户/ 可/ 利用/ 云/ 平台/ 安全/ 芯片/ 远程/ 验证/ 运行/ 的/ CloudVisor/ 是否/ 完整/ 可信/ ,/ 没有/ 受到/ 损害/ ./ 客户/ VM/ 镜像/ 加密传输/ 存储/ 到/ 云/ 平台/ ,/ 并/ 可/ 利用/ 元/ 数据/ 验证/ 是否/ 被/ 篡改/ ./ 在/ CloudVisor/ 系统/ 中/ ,/ VMM/ 的/ 扩展/ 页表/ (/ ExtendedPageTables/ ,/ EPT/ )/ 只/ 具有/ 读/ 权限/ ,/ Cloud/ -/ Visor/ 维持/ 一份/ 相同/ 的/ EPT/ 页表/ 完成/ 客户/ 物理地址/ 到/ 主机/ 物理地址/ 的/ 转换/ ./ 分配/ 给/ VM/ 的/ 页面/ 会/ 改变/ 其/ 所有者/ 为/ VM/ ,/ CloudVisor/ 将/ 此/ 页面/ 从/ VMM/ 的/ EPT/ 页表/ 中/ 解除/ 映射/ ./ 当/ 页面/ 回收/ 时/ ,/ 页面/ 重新/ 被/ VMM/ 所有/ ./ 页面/ 只能/ 被/ 所有者/ 访问/ ,/ 这样/ 当/ VMM/ 访问/ 客户/ 虚拟机/ 页面/ 时会/ 出现/ 错误/ 陷入/ CloudVisor/ ,/ CloudVisor/ 加密/ 后/ 映射/ 到/ VMM/ 页表/ ,/ 把/ 页面/ 所有权/ 设为/ VMM/ ./ 当/ VMM/ 要/ 改变/ VM/ 页表/ 时/ 也/ 会/ 引起/ 修改/ 页表/ 错误/ ,/ 陷入/ CloudVisor/ 处理/ ,/ CloudVisor/ 判断/ 页面/ 是否/ 属于/ VMM/ ./ 如图/ 9/ 所示/ ,/ VM/ 特权/ 事件/ 执行/ 流程/ 为/ :/ (/ 1/ )/ 当/ VM/ 执行/ 特权/ 事件/ 时会/ 先/ 陷入/ CloudVisor/ ;/ (/ 2/ )/ CloudVisor/ 执行/ 必要/ 的/ 操作/ ,/ 如/ 保护/ CPU/ 上下文/ 和/ 解析/ I/ // O/ 指令/ ,/ 如果/ 需要/ 再/ 交给/ VMM/ 执行/ ;/ (/ 3/ )/ VMM/ 执行/ 后/ 回到/ CloudVisor/ ;/ (/ 4/ )/ 经过/ CloudVisor/ 处理/ 后/ 如/ 恢复/ CPU/ 的/ 上下文/ ,/ 再/ 转到/ VM/ 执行/ ./ 用户/ 的/ 虚拟机/ 是/ 有/ 可能/ 被/ 云/ 管理员/ 非法/ 入侵/ 和/ 掌控/ 的/ ,/ 所以/ 针对/ 虚拟机/ 被/ 入侵/ 情况/ 下/ 用户程序/ 的/ 安全/ 保护/ 也/ 是/ 尤为重要/ 的/ ./ Overshadow/ [/ 42/ ]/ 和/ Inktag/ [/ 43/ ]/ 研究/ 怎样/ 在/ 用户/ 虚拟机/ 被/ 入侵/ 情况/ 下/ 保证/ 用户/ 虚拟机/ 重要/ 程序/ 的/ 安全性/ ./ 假定/ VMM/ 是/ 可/ Page9/ 图/ 9CloudVisor/ 系统/ 架构/ 信/ 的/ ,/ 而/ 操作系统/ 是/ 不可/ 信/ 的/ ,/ 通过/ VMM/ 和/ 保护/ 程序/ 之间/ 的/ 协商/ ,/ 仲裁/ 程序/ 与/ 系统/ 交互/ 以/ 验证/ 不可/ 信/ 系统/ 行为/ ./ Overshadow/ 基于/ 虚拟化/ 技术/ ,/ 采用/ 额外/ 的/ 阴影/ (/ shadow/ )/ 页表/ 映射/ ,/ 包括/ 系统/ shadow/ 页表/ 和/ 保护/ 应用程序/ shadow/ 页表/ ,/ 提供/ 不同/ 的/ 客户机/ 物理/ 内存/ 视图/ ,/ 对/ 虚拟机/ 中要/ 保护/ 的/ 应用程序/ (/ CloakedAPP/ )/ 所有/ 内存/ 页/ 加密/ 的/ 方法/ 来/ 保护/ 用户/ 的/ 隐私/ 性/ ,/ 并/ 根据/ 当前/ 访问/ 视图/ 动态/ 地/ 加密/ 和/ 解密/ 内容/ ,/ 向/ 保护/ 程序/ 提供/ 明文/ 视图/ ,/ 向/ 操作系统/ 提供/ 加密/ 视图/ ,/ 保证/ 用户/ 数据/ 不/ 被/ 侵入/ 虚拟机/ 的/ 恶意/ 用户/ 窃取/ ./ 如图/ 10/ 所示/ ,/ VMM/ 与/ Shim/ 合作/ 仲裁/ 保护/ 程序/ 和/ 操作系统/ (/ OS/ )/ 之间/ 的/ 交互/ ./ Shim/ 是/ 与/ OS/ 相关/ 的/ 用户/ 级/ 程序/ ,/ 链接/ 在/ 保护/ 程序/ 地址/ 空间/ ./ Over/ -/ shadow/ 加载/ 程序/ 时/ 在/ 保护/ 程序/ 的/ 地址/ 空间/ 引入/ Shim/ ,/ 仲裁/ 程序/ 和/ 操作系统/ 的/ 交互/ ,/ 分为/ UncloakedShim/ 和/ CloakedShim/ ,/ OS/ 调用/ UncloakedShim/ 超级/ 调用/ (/ Hypercall/ )/ 初始化/ 新/ 的/ 保护/ 程序/ 上下文/ ,/ 并且/ 进入/ 并/ 恢复/ 保存/ 的/ 保护/ 程序执行/ 环境/ ,/ 程序/ 调用/ CloakedShim/ ,/ 可以/ 保护/ 新/ 的/ 内存/ 区域/ ,/ 解密/ 保护/ 数据/ ,/ 建立/ 新/ 的/ shadow/ 上下文/ 等/ ./ 当/ 启动/ 一个/ 保护/ 程序/ 时/ ,/ Shim/ 必须/ 首先/ 安全/ 启动/ ,/ 调用/ Hypercall/ 验证/ 自身/ 的/ 完整性/ 并/ 启动/ 保护/ 程序/ ./ 然后/ Shim/ 运行/ 它/ 的/ 加载/ 程序/ ,/ 该/ 程序/ 读取/ 应用程序/ 二进制/ 文件/ ,/ 将/ 适当/ 段/ 映射/ 到/ 内存/ 中/ ./ 当/ 页面/ 在/ 系统/ shadow/ 页表/ 上/ 无法/ 映射/ 时/ 发生/ 错误/ 陷入/ VMM/ ,/ VMM/ 加密/ 页面/ ,/ 计算/ 哈希/ ,/ 并/ 将/ 页面/ 重新/ 映射/ 到/ 系统/ shadow/ 页表/ ./ 当/ 页面/ 在/ 程序/ shadow/ 页表/ 上/ 无法/ 映射/ 时/ 发生/ 错误/ 陷入/ VMM/ ,/ VMM/ 验证/ 完整性/ ,/ 解密/ 页面/ ,/ 将/ 明文/ 页面/ 重新/ 映射/ 到/ 程序/ shadow/ 页表/ ./ 解密/ 用到/ 的/ 元/ 数据/ 存储/ 在/ VMM/ 或/ 程序/ 内存/ ,/ OS/ 访问/ 不到/ ./ VMM/ 执行/ shadow/ 页表/ 转换/ 时/ 必须/ 识别/ 程序/ 上下文/ ,/ CTC/ (/ CloakedThreadContext/ )/ 结构/ 用于/ 保存/ 程序/ 和/ 系统控制/ 转换/ 的/ 隐私/ 数据/ ,/ CTC/ 置于/ 保护/ 内存/ 区域/ ,/ 受/ 加密/ 和/ 完整性/ 保护/ ,/ OS/ 不能/ 读/ 或/ 修改/ 它/ ./ 当/ 执行/ 从/ OS/ 恢复/ 到/ 保护/ 程序/ 时/ ,/ 系统/ 调用/ UncloakedShim/ 传入/ ASID/ (/ AddressSpaceIdenti/ -/ fier/ )/ 和/ CTC/ 指针/ 给/ VMM/ ,/ VMM/ 验证/ ASID/ 和/ 随机数/ ./ 如果/ OS/ 在/ 不/ 合适/ 的/ 地点/ 恢复/ 保护/ 程序/ ,/ 完整性/ 验证/ 不会/ 通过/ ,/ 所以/ 只能/ 在/ 适当/ 的/ 程序代码/ 及/ 适当/ 的/ 地点/ 恢复程序/ ./ 通过/ 以上/ 机制/ 确保/ 进入/ 或/ 退出/ 保护/ 程序/ 时/ 的/ 数据/ 隐私/ ,/ 如/ 系统/ 调用/ 、/ 错误/ 、/ 中断/ 和/ 信号/ 传递/ 等/ ./ VMM/ 保证/ 保护/ 程序/ 内存/ 页面/ 完整性/ 和/ 安全性/ ,/ 维持/ 页面/ 和/ 页面/ 元/ 数据/ 的/ 映射/ 关系/ ./ 典型/ 错误/ 或/ 中断/ 处理/ 流程/ :/ (/ 1/ )/ CloakedAPP/ 执行/ 错误/ 或/ 中断/ ,/ 陷入/ VMM/ ./ (/ 2/ )/ VMM/ 保护/ 程序/ 寄存器/ 内容/ 到/ CloakedShimCTC/ ,/ 并/ 修改/ 寄存器/ 内容/ ,/ 执行/ shadow/ 页表/ Page10/ 函数/ ./ 切换/ ./ (/ 3/ )/ 修改/ IP/ 和/ SP/ 寄存器/ 指向/ UncloakedShim/ 地址/ ,/ 设置/ 内核/ 执行/ 完/ 返回/ 的/ 处理函数/ ./ (/ 4/ )/ VMM/ 转换/ 控制权/ 到/ 内核/ 执行/ ./ (/ 5/ )/ 内核/ 处理/ 完/ 返回/ 到/ UncloakedShim/ 处理/ (/ 6/ )/ UncloakedShim/ 调用/ Hypercall/ 进入/ VMM/ ./ (/ 7/ )/ VMM/ 恢复/ 寄存器/ 内容/ 返回/ CloakedAPP/ ,/ 执行/ shadow/ 页表/ 切换/ ./ Overshadow/ 目前/ 使用/ 单/ 密钥/ ,/ 由/ VMM/ 管理/ 来/ 加密/ 所有/ 页/ ;/ 这种/ 方法/ 需要/ 在/ 云/ 平台/ 安装/ 安全/ 芯片/ ,/ 并且/ 每个/ 安全/ 程序/ 需要/ 两套/ 页表/ ,/ 内存/ 占用率/ 高/ ,/ 一次/ 控制/ 转换/ 需要/ 在/ 保护/ 程序/ 和/ VMM/ 之间/ 执行/ 数据保护/ 及/ 加解密/ 等/ 多步/ 操作/ ,/ 从而/ 带来/ 一定/ 的/ 性能/ 损耗/ ./ Inktag/ 基于/ 虚拟化/ 技术/ 在/ 不可/ 信/ 的/ 操作系统/ 中/ 保护/ 关键/ 应用/ ,/ 当/ 属于/ 某/ 被/ 保护/ 程序/ 的/ 页表/ 更新/ 时/ ,/ InkTag/ 要/ 验证/ 虚拟机/ 操作系统/ 内存/ 映射/ 和/ 程序/ 请求/ 是/ 一致/ 的/ ,/ 确保/ 该/ 更新/ 反映/ 了/ 应用程序/ 的/ 意图/ ./ InkTag/ 提供/ 以下/ 安全/ 保证/ :/ (/ 1/ )/ 控制流/ 完整性/ :/ OS/ 不能/ 改变程序/ 计数器/ 、/ 寄存器/ ;/ (/ 2/ )/ 地址/ 空间/ 完整性/ :/ OS/ 不能/ 读/ 、/ 改变程序/ 数据/ ;/ (/ 3/ )/ 文件/ I/ // O/ :/ 保证/ 文/ CryptDB/ [/ 44/ ]/ ShadowCrypt/ [/ 46/ ]/ Over/ -/ encryption/ [/ 47/ ]/ 表/ 1/ 典型/ 用户/ 可控/ 的/ 数据/ 加密/ 系统/ 对比/ 不/ 需要/ 客户端/ 与/ 服务端/ 之间/ 不/ 需要/ 用户/ 与/ 客户端/ 之间/ 不/ 需要/ 客户端/ 与/ 服务端/ 之间/ 需要/ 客户端/ 与/ 服务端/ 之间/ 5.1/ 对云/ 服务商/ 透明/ 的/ 用户/ 数据/ 加密/ 不/ 依赖/ 云/ 服务提供商/ 的/ 用户/ 数据/ 加密/ 不/ 需要/ 云/ 服务提供商/ 配合/ ,/ 如/ CryptDB/ [/ 44/ ]/ 有效/ 预防/ 第三方/ 数据/ 存储管理/ 人员/ 的/ 内部/ 威胁/ ;/ Mylar/ [/ 45/ ]/ 有效/ 预防/ 服务器端/ 管理人员/ 的/ 内部/ 威胁/ ;/ ShadowCrypt/ [/ 46/ ]/ 可/ 预防/ 客户端/ 恶意代码/ 及/ 服务器端/ 的/ 内部/ 威胁/ ./ 5.1/ ./ 1CryptDBCryptDB/ 对/ 数据/ 在/ 存入/ 数据库/ 前/ 进行/ 加密/ ,/ 并/ 在/ 加密/ 数据/ 上/ 进行/ 数据/ 查询处理/ ,/ 从而/ 有效/ 防范/ 了/ 恶意/ 的/ 数据库管理员/ ./ CryptDB/ 利用/ 数据库/ 代理/ ,/ 对/ 用户/ 的/ 操作/ 进行/ 转换/ ,/ 得到/ 加密/ 结果/ ,/ 然后/ 解密/ 返回/ 给/ 用户/ ./ 如图/ 11/ 所示/ ,/ CryptDB/ 主要/ 由/ 数据库/ 代理/ (/ proxy/ )/ 、/ CryptDBUDFs/ (/ User/ -/ DefinedFunctions/ )/ 模块/ 组成/ ,/ proxy/ 执行/ 加解密/ 操作/ ,/ CryptDBUDFs/ 在/ DBMS/ 端/ 执行/ 用户/ 定义/ 的/ 操作/ ./ 针对/ 不同/ 的/ 操作/ 件/ 数据/ 的/ 隐私/ 性/ 和/ 完整性/ ./ InkTag/ 目前/ 基于/ 半/ 虚拟化/ 技术/ 实现/ ,/ 从而/ 不/ 具有/ 普遍性/ ;/ 这种/ 方法/ 也/ 需要/ 在/ 云/ 平台/ 安装/ 安全/ 芯片/ ,/ 并且/ 每个/ 安全/ 程序/ 需要/ VMM/ 和/ 程序/ 配合/ 实现/ ,/ 不/ 具有/ 通用性/ ./ 5/ 用户/ 可控/ 的/ 数据/ 加密/ 第/ 3/ 节/ 和/ 第/ 4/ 节/ 主要/ 是/ 针对/ 如何/ 管控/ 云端/ 的/ 管理权限/ ./ 但是/ 云/ 模式/ 的/ 实质/ 是/ 数据/ 的/ 所有权/ 和/ 控制权/ 分离/ 了/ ,/ 用户/ 失去/ 了/ 对/ 其/ 数据/ 的/ 直接/ 管理/ ./ 因此/ ,/ 用户/ 的/ 最后/ “/ 杀手锏/ ”/ 即/ 是/ 把/ 数据/ 加密/ 以后/ 再/ 存储/ 到/ 云端/ ./ 若/ 用户/ 密钥/ 也/ 在/ 云中/ 存储/ 和/ 使用/ ,/ 则/ 云/ 管理员/ 可/ 通过/ 特权/ 域/ 得到/ 密钥/ 进而/ 窃取/ 用户/ 数据/ [/ 11/ -/ 12/ ]/ ./ 所以/ 数据/ 最好/ 在/ 客户端/ 加密/ 再/ 上/ 传到/ 云/ 服务器/ ,/ 解密/ 密钥/ 在/ 用户/ 手里/ ,/ 而/ 服务商/ 只能/ 看到/ 密文/ ,/ 数据/ 控制权/ 完全/ 在/ 用户/ 手中/ ./ 我们/ 把/ 这种/ 思路/ 称为/ “/ 用户/ 可控/ 的/ 数据/ 加密/ ”/ ./ 进一步/ 从/ 是否/ 依赖/ 云/ 服务商/ 的/ 角度/ 可/ 将/ 现有/ 工作/ 分为/ 不/ 依赖/ 云/ 服务提供商/ 的/ 用户/ 数据/ 加密/ 和/ 依赖/ 云/ 服务提供商/ 的/ 用户/ 数据/ 加密/ 两类/ ./ 表/ 1/ 为/ 典型/ 用户/ 可控/ 的/ 数据/ 加密/ 原型/ 系统/ 对比/ ./ 加解密/ 位置/ 数据库/ 代理/ 有/ 不同/ 的/ 加密/ 方案/ ,/ 如/ RND/ 加密/ 安全性/ 最高/ ,/ 但/ 不/ 支持/ 任何/ 数据/ 操作/ ;/ HOM/ 加密/ 方案/ 用于/ 密文/ 加法/ 操作/ ;/ SEARCH/ 加密/ 可/ 用于/ 密文/ 搜索/ ;/ DET/ 用于/ 相等/ 比较/ ;/ JOIN/ 加密/ 用于/ 聚合/ 操作/ ;/ OPE/ 加密/ 用于/ 排序/ 比较/ 操作/ ,/ 其/ 安全性/ 依次/ 降低/ ./ 对于/ 相同/ 加密/ 层/ 同一/ 列/ 加密/ 密钥/ 是/ 相同/ 的/ ,/ 而/ 不同/ 列/ 加密/ 密钥/ 则/ 不/ 相同/ ./ 数据/ 存入/ 数据库/ 前/ 多层/ 加密/ ,/ 为了/ 使用/ 安全性/ 先/ 在/ 操作/ 列/ RND/ 加密/ 层上/ 操作/ ,/ 若/ 不/ 支持/ 则/ 把/ RND/ 层/ 密钥/ 传到/ 服务端/ 执行/ UDF/ 操作/ 降到/ 可/ 支持/ 的/ 加密/ 层/ 继续/ 处理/ ,/ 并/ 维持/ 在/ 支持/ 的/ 加密/ 层/ ,/ 同时/ proxy/ 更新/ 相应/ 列/ 加密/ 层/ ,/ 当/ 服务器返回/ 加密/ 数据/ 时/ 对/ 数据/ 解密/ 并/ 返回/ 给/ 用户/ ./ 针对/ 一次/ 请求/ 操作/ ,/ 可能/ 需要/ 以下/ 过程/ :/ (/ 1/ )/ 当/ 用户程序/ 发起/ 数据/ 查询/ 请求/ ./ (/ 2/ )/ proxy/ 拦截/ 并/ 重写/ 请求/ ,/ 隐匿/ 并/ 转换/ 表名/ 和/ Page11/ 图/ 11CryptDB/ 系统/ 架构/ 列名/ (/ 如/ emp/ 对于/ table1/ ,/ salary/ 对应/ col2/ )/ ,/ 并/ 利用/ 主/ 密钥/ 选择/ 合适/ 的/ 加密/ 方案/ 加密/ 请求/ 中/ 含有/ 的/ 常量/ ./ 当/ proxy/ 判断/ DBMSserver/ 需要/ 调整/ 加密/ 层/ 执行/ 请求/ 操作/ 时/ ,/ 代理会/ 传送/ 相应/ 层/ 的/ 解密/ 密钥/ 给/ DBMSserver/ ,/ 并/ 发起/ UPDATE/ 请求/ 使/ DBMSserver/ 调用/ UDF/ 调整/ 相应/ 操作/ 列/ 加密/ 层到/ 适合/ 的/ 加密/ 方案/ 层/ (/ 如/ 调整/ RND/ 层到/ DET/ 层/ )/ ./ (/ 3/ )/ proxy/ 再/ 转发/ 加密/ 请求/ 到/ DBMSserver/ ,/ DBMSserver/ 利用/ 标准/ 的/ SQL/ 处理/ 语句/ 处理/ (/ 有时/ 需要/ 调用/ 相应/ 的/ UDF/ 处理/ 聚合/ 或/ 关键字/ 搜索/ )/ ./ (/ 4/ )/ 最后/ DBMSserver/ 返回/ 加密/ 结果/ 给/ proxy/ ,/ 并/ 传送/ 相应/ 的/ 密钥/ ./ (/ 5/ )/ 代理/ 解密/ 并/ 返回/ 客户/ 相应/ 数据/ ./ 针对/ 密文/ 搜索/ SEARCH/ 的/ 实现/ ,/ CryptDB/ 采用/ Song/ 等/ 人/ [/ 49/ ]/ 提出/ 的/ 密文/ 搜索/ 方案/ SSKE/ (/ SearchableSymmetricKeyEncryption/ )/ ,/ 该/ 方案/ 首先/ 把/ 全文/ 处理/ 成/ 固定/ 长度/ (/ 如/ n/ 位/ )/ 的/ 单词/ ,/ 对/ 任意/ 单词/ Wi/ 利用/ 密钥/ k/ 加密/ 生成/ Ek/ (/ Wi/ )/ ,/ 拆/ 分成/ Li/ (/ 前/ n/ -/ m/ 位/ )/ 和/ Ri/ (/ 后/ m/ 位/ )/ ;/ 利用/ 伪/ 随机/ 函数/ f/ 生成/ Ki/ =/ fK/ (/ Li/ )/ ;/ 生成/ (/ n/ -/ m/ )/ 位伪/ 随机/ 位/ Si/ ,/ 利用/ 伪/ 随机/ 函数/ F/ 生成/ 后/ m/ 位/ FKi/ (/ Si/ )/ ,/ 拼接/ 在/ 一起/ 为/ n/ 位/ 与/ Ek/ (/ Wi/ )/ 亦/ 或/ 生成/ 密文/ ./ 查询/ 时/ 用户/ 传给/ 服务器/ Ek/ (/ Wi/ )/ 和/ Ki/ ,/ 服务器/ 利用/ 密文/ 单词/ 与/ Ek/ (/ Wi/ )/ 亦/ 或/ 看/ 结果/ 是否/ 满足/ (/ s/ ,/ FKi/ (/ s/ )/ )/ 的/ 形式/ ,/ 如/ 满足/ 则/ 返回/ 对应/ 的/ 密文/ 文件/ ./ 这种/ 方法/ 优点/ 是/ 搜索/ 运算/ 简单/ ,/ 缺点/ 是/ 云端/ 需要/ 全文/ 线性/ 搜索/ ,/ 计算/ 量/ 与/ 文件大小/ 成正比/ ;/ 不能/ 应用/ 于/ 公私/ 钥/ 加密/ 体系/ ;/ 此外/ ,/ 服务器/ 可/ 利用/ 查询/ 请求/ 获得/ 额外/ 的/ 用户/ 信息/ ./ 针对/ 聚合/ 操作/ JOIN/ ,/ 若/ 两列/ 使用/ 相同/ 密钥/ ,/ 则/ 很/ 容易/ 支持/ 聚合/ 操作/ ./ 若/ 两列/ 使用/ 不同/ 密钥/ 加密/ ,/ CryptDB/ 采用/ JOIN/ -/ ADJ/ 方案/ ,/ 直观/ 地说/ ,/ JOIN/ -/ ADJ/ 可以/ 使/ DBMSserver/ 在/ 不/ 去/ 解密/ 的/ 情况/ 下/ 调整/ 某列/ 的/ 密钥/ 使/ 相同/ 的/ 明文/ 有/ 相同/ 的/ 密钥/ ./ 两列/ 首先/ 在/ JOIN/ 层/ 使用/ 不用/ 密钥/ 加密/ ,/ 当有/ 聚合/ 请求/ 时/ ,/ proxy/ 计算/ 两列/ 密钥/ 之间/ 的/ 陷门/ 并/ 发送给/ DBMSserver/ ,/ DBMSserver/ 调用/ UDF/ 使用/ 陷门/ 调整/ 某列/ ,/ 使/ 两列/ 有/ 相同/ 的/ 密钥/ ,/ 而后/ 可/ 执行/ 聚合/ 操作/ ./ 针对/ 排序/ 比较/ 操作/ OPE/ (/ Order/ -/ PreservingEncryption/ )/ 的/ 实现/ ,/ CryptDB/ 采用/ 第一个/ 符合/ 安全性/ 需求/ 的/ 保序/ 加密技术/ OPSE/ [/ 50/ ]/ (/ Order/ -/ PreservingSymmetricEncryption/ )/ 方案/ ./ OPE/ 最早/ 由/ Agrawal/ 等/ 人/ [/ 51/ ]/ 提出/ ,/ 支持/ 对/ 加密/ 数值数据/ 的/ 各种/ 比较/ 操作/ ,/ 但/ 不/ 支持/ 其他/ 数据类型/ ./ Wang/ 等/ 人/ [/ 52/ ]/ 基于/ OPSE/ 实现/ 检索/ 结果/ 可/ 排序/ 方案/ ./ 近年来/ ,/ 为/ 进一步提高/ 安全性/ ,/ Chenette/ 等/ 人/ [/ 53/ ]/ 通过/ 使用/ “/ 虚拟/ 查询/ ”/ 避免/ 泄露/ MOPE/ [/ 54/ ]/ 秘密/ 偏移/ ./ 然而/ ,/ 如果/ 分布/ 极/ 不/ 均匀/ ,/ 虚拟/ 查询/ 的/ 数目/ 可能/ 会/ 很大/ ./ Liu/ 等/ 人/ [/ 55/ ]/ 指出/ 理想/ 的/ 安全/ OPE/ 方案/ [/ 56/ ]/ 效率/ 低/ ,/ 在/ 某些/ 方面/ 不/ 适用/ ,/ 其/ 通过/ 信息/ 空间/ 扩展/ 和/ 非线性/ 空间/ 分割/ 隐藏/ 数据分布/ 和/ 频率/ ./ Kerschbaum/ [/ 57/ ]/ 使用/ 随机化/ 密文/ 来/ 隐藏/ 明文/ 的/ 频率/ ,/ 如对/ 精确/ 值/ 的/ 查询/ 转变/ 为/ 对/ 精确/ 值/ 所属/ 范围/ 的/ 查询/ ./ 密文/ 加法/ 操作/ HOM/ 借鉴/ 了/ 全/ 同态/ 加密/ 计算/ ,/ 即/ 直接/ 对/ 密文/ 进行/ 计算/ 获得/ 密文/ 结果/ ,/ 密文/ 结果/ 解密/ 后/ 即/ 是/ 对应/ 的/ 明文/ 运算/ 结果/ ./ Gentry/ [/ 58/ ]/ 首次/ 设计/ 出/ 了/ 一种/ 基于/ 理想/ 格/ 的/ 全/ 同态/ 加密/ 方案/ ,/ 能/ 同时/ 支持/ 加法/ 和/ 乘法/ 同态/ ./ 但/ 该/ 方案/ 伴随/ 着/ 密文/ 同态/ 运算/ 次数/ 增加/ 噪声/ 也/ 会/ 相应/ 增加/ ,/ 且/ 噪声/ 积累/ 到/ 一定量/ 后/ 就/ 不能/ 作/ 密文/ 计算/ 了/ ,/ 故/ 只能/ 支持/ 有限/ 的/ 密文/ 加法/ 和/ 乘法/ 运算/ 次数/ ./ Gentry/ 的/ 解决方案/ 是/ 引入/ Bootstrapping/ 技术/ ,/ 当/ 密文/ 噪声/ 达到/ 一定/ 阈值/ 时/ ,/ 利用/ 同态/ 运算/ 将/ 密文/ 和/ 其/ 对应/ 的/ 密钥/ 用/ 新/ 的/ 密钥/ 加/ Page12/ 密/ 并作/ 同态/ 解密/ 操作/ ,/ 由于/ 是/ 对/ 新/ 的/ 密钥/ 产生/ 的/ 密文/ 做/ 操作/ ,/ 从而/ 自动/ 对/ 明文/ 加密/ ,/ 完成/ 对/ 密文/ 的/ 重/ 加密/ ,/ 消除/ 了/ 一定/ 的/ 噪声/ ,/ 从而/ 支持/ 任意/ 次数/ 的/ 密文/ 计算/ ./ 该/ 方案/ 理论/ 上/ 可行/ ,/ 但/ 计算/ 复杂/ ①/ ②/ ,/ 导致/ 现有/ 方案/ 在/ 云/ 计算环境/ 中/ 不/ 具有/ 实用性/ ./ CryptDB/ 的/ 解决方案/ 是/ 基于/ Paillier/ 加密/ 系统/ [/ 59/ ]/ ,/ 可/ 有效/ 地/ 支持/ 特定/ 的/ 运算/ ,/ 如/ 两个/ 数值/ 密文/ 的/ 乘/ 得到/ 相应/ 明文/ 和/ ./ 如图/ 11/ 所示/ ,/ CryptDB/ 可/ 有效/ 防范/ Threat1/ ,/ 但/ 针对/ Threat2/ ,/ 当/ 用户/ 在线/ 且/ 密钥/ 被/ 服务器程序/ 窃取/ 时/ 不能/ 防止/ 服务器程序/ 作恶/ ,/ 且/ 客户端程序/ 如果/ 被/ 篡改/ 也/ 有/ 可能/ 泄露/ 数据/ 隐私/ ./ 同时/ 一次/ 查询/ 有/ 可能/ 需要/ 多次/ 加解密/ ,/ 使/ 执行/ 时间/ 较长/ ./ 图/ 12Mylar/ 系统/ 架构/ 如图/ 12/ 系列/ B/ 所示/ ,/ 用户/ 上传/ 数据/ 时/ ,/ 利用/ 数据/ Principal/ 的/ 公钥/ 对/ 数据/ 加密/ 并/ 附加/ 加密/ 的/ 元/ 数据/ ,/ 再/ 上/ 传到/ 服务器/ ./ 如/ 系列/ A/ 所示/ ,/ 当要/ 共享/ 数据/ 时/ ,/ 获取/ 共享/ 数据/ 对应/ 的/ Principal/ 密钥/ ,/ 加密/ 数据/ 再/ 发送给/ 服务器/ ./ 数据共享/ ,/ 也/ 就是/ 密钥/ 分发/ ,/ 要/ 访问共享/ 数据/ ,/ 就要/ 把/ 加密/ 数据/ 的/ 私钥/ 用/ 用户/ 的/ 公钥/ 加密/ 存储/ 在/ 服务器/ 上/ ,/ 这样/ 用户/ 可用/ 自己/ 私钥/ 解密/ 得到/ 加密/ 数据/ 的/ 私钥/ ,/ 进而/ 解密/ 得到/ 数据/ ./ 数据/ 访问/ 授权/ 是/ 传递性/ 的/ ,/ 也/ 就是/ 如果/ A/ 授权/ B/ 访问/ ,/ B/ 授权/ C/ 访问/ ,/ 则/ C/ 有权/ 访问/ A/ ./ 因此/ 这种/ 授权/ 关系/ 形成/ 了/ 一张/ 图/ ,/ 称为/ AccessGraph/ ./ 如/ 系列/ C/ 所示/ ,/ 用户/ 登录/ 时/ 经过/ 验证/ 根据/ Principal/ 库/ 获取/ 自己/ 的/ 公私/ 钥/ ,/ 当/ 收到/ 数据/ 时/ ,/ 首先/ 利用/ 密文/ 数据/ 的/ 注解/ 获得/ 对应/ 的/ Principal/ ,/ 然后/ 利用/ 自己/ 对应/ 的/ Principal/ 根据/ AccessGraph/ 看/ 是否/ 能/ 访问/ 密文/ 数据/ 对应/ 的/ Principal/ ,/ 如果/ 能则/ 利用/ 数据/ 对应/ 的/ Principal/ 的/ 私钥/ 解密/ 数据/ 获得/ 明文/ ./ 如/ 系列/ D/ 所示/ ,/ 密文/ 搜索/ 仅仅/ 需要/ 提供/ 一个/ 搜索/ token/ ,/ 服务器/ 利用/ 私钥/ 差/ 调整/ token/ 到/ 另/ 一个/ 可/ 搜索/ 值/ ,/ 保证/ 服务器/ 不能/ 获取/ 5.1/ ./ 2Mylar/ 针对/ 预防/ 服务器端/ 应用程序/ ,/ Mylar/ 扩展/ MeteorJavaScript/ 框架/ ,/ 通过/ 对/ 应用程序/ 传送/ 到/ 服务器/ 的/ 数据/ 加密/ 来/ 保证数据/ 的/ 隐私/ 性/ 和/ 安全性/ ,/ 从而/ 可/ 有效/ 防范/ 恶意/ 的/ 服务器/ 管理员/ ./ 如图/ 12/ 所示/ ,/ Mylar/ 主要/ 由/ 以下/ 部分/ 组成/ :/ (/ 1/ )/ 浏览器/ 插件/ ,/ 负责/ 验证/ 客户端/ 代码/ 的/ 数字签名/ (/ 与/ 验证/ HTTPS/ 网页/ 的/ 数字签名/ 类似/ )/ ,/ 保证/ 没/ 被/ 篡改/ ;/ (/ 2/ )/ 客户端/ 库/ ,/ 对/ 发往/ 服务器/ 的/ 数据/ 进行/ 加密/ ,/ 对/ 来自/ 服务器/ 的/ 数据/ 进行/ 解密/ ;/ (/ 3/ )/ 服务器端/ 库/ ,/ 在/ 加密/ 数据/ 中/ 进行/ 搜索/ ;/ (/ 4/ )/ 身份/ 鉴别/ 服务/ ,/ 验证/ 公钥/ 是否/ 属于/ 特定/ 用户/ ./ 要/ 搜索/ 的/ 词/ ,/ 不能/ 获取/ 文档/ 的/ 内容/ ./ 搜索/ 具体/ 算法/ 如下/ :/ 利用/ 椭圆/ 曲线/ 上/ 双线性/ 映射函数/ e/ :/ G1/ ×/ G2/ →/ GT/ ,/ 其中/ G1/ ,/ G2/ ,/ GT/ 是/ 椭圆/ 曲线/ 上阶为/ p/ 的/ 特殊/ 构造/ 群/ ,/ g/ 为/ G2/ 的/ 生成元/ ./ H/ 和/ H2/ 是/ 椭圆/ 曲线/ 上/ 特定/ 的/ 哈希/ 函数/ ./ e/ 满足/ 方程/ e/ (/ H/ (/ w/ )/ a/ ,/ gb/ )/ =/ e/ (/ H/ (/ w/ )/ ,/ g/ )/ ab/ ./ 过程/ 1/ ./ 生成/ 密钥/ :/ KEYGEN/ (/ )/ ./ key/ ←/ randomvaluefromZp/ (/ p/ 阶/ 循环群/ )/ returnkey/ 过程/ 2/ ./ 加密/ :/ ENC/ (/ key/ ,/ word/ )/ ./ r/ ←/ randomvaluefromGTc/ ←/ (/ r/ ,/ H2/ (/ r/ ,/ e/ (/ H/ (/ word/ )/ ,/ g/ )/ key/ )/ )/ returnc/ ①/ it/ ./ ComputerWorld/ ;/ 2009June25/ ./ Availableat/ :/ http/ :/ // // ②/ Page13/ 〈/ r/ ,/ h/ 〉/ )/ ./ tk/ ←/ H/ (/ word/ )/ keyinG1/ 过程/ 3/ ./ 生成/ token/ :/ TOKEN/ (/ key/ ,/ word/ )/ ./ returntk/ 过程/ 4/ ./ 密钥/ 差/ 计算/ :/ DELTA/ (/ key1/ ,/ key2/ )/ ./ Δ/ key1/ →/ key2/ ←/ gkey2/ // key1inG2return/ Δ/ key1/ →/ key2/ 过程/ 5/ ./ 服务端/ 调整/ token/ :/ ADJUST/ (/ tk/ ,/ Δ/ k1/ →/ k2/ )/ ./ atk/ ←/ e/ (/ tk/ ,/ Δ/ k1/ →/ k2/ )/ inGTreturnatk/ 过程/ 6/ ./ 服务端/ 匹配/ 程序/ :/ MATCH/ (/ atk/ ,/ c/ =/ h/ ←/ H2/ (/ r/ ,/ atk/ )/ returnh/ ?/ =/ h/ 利用/ 以上/ 算法/ 针对/ 具体/ 程序实现/ 具体/ 的/ 密文/ 搜索/ 功能/ ./ 如/ 在/ 聊天室/ 程序/ 中/ ,/ Bob/ 被/ 授权/ 访问/ 聊天室/ party/ 时/ ,/ Mylar/ 计算/ 出/ Bob/ 的/ 私钥/ 和/ 聊天室/ party/ 的/ 私钥/ 之差/ ,/ 并/ 把/ 这个/ 差/ 存储/ 在/ 服务器/ 上/ ./ 当/ Bob/ 被/ 授权/ 访问/ 聊天室/ work/ 时/ ,/ Mylar/ 把/ 其/ 私钥/ 和/ 聊天室/ work/ 的/ 私钥/ 之差/ 存储/ 服务器/ 上/ ./ 当/ Bob/ 需要/ 在/ 所有/ 聊天室/ 中/ 搜索/ 时/ ,/ 只/ 需/ 将/ 待查/ 词/ 利用/ 自己/ 的/ 私钥/ 形成/ 搜索/ token/ 并/ 发给/ 服务器/ ,/ 服务器/ 会/ 利用/ 之前/ 存储/ 的/ “/ 私钥/ 差/ ”/ 把/ 待查/ 词用/ party/ 和/ work/ 私钥/ 加密/ 的/ 结果/ 分别/ 计算出来/ ,/ 再/ 利用/ party/ 和/ work/ 聊天室/ 中/ 已经/ 存在/ 的/ 索引/ ,/ 就/ 可以/ 在/ 较/ 短时间/ 内/ 找到/ 包含/ 待查/ 词/ 的/ 文档/ ./ Mylar/ 程序/ 需要/ 开发者/ 告诉/ Mylar/ 什么/ 数据/ 需要/ 加密/ ,/ 影响/ 了/ 向/ 后/ 兼容性/ ,/ 且/ 针对/ 开发者/ 实施/ 加密/ ,/ 并/ 不是/ 针对/ 用户/ ,/ 需要/ 应用程序/ 在/ MeteorJavaScript/ 框架/ 开发/ ./ 客户端/ 代码/ 验证/ 需要/ 服务端/ 配合/ ,/ 需要/ 修改/ 服务端/ 代码/ ./ 服务器端/ 无法/ 对/ 加密/ 数据/ 执行/ 计数/ 、/ 排/ 文献/ 简称/ SWP/ [/ 49/ ]/ Goh/ [/ 62/ ]/ CGK/ [/ 63/ ]/ XWS/ [/ 66/ ]/ YLW/ [/ 67/ ]/ BCO/ [/ 60/ ]/ SLN/ [/ 68/ ]/ WWP/ [/ 69/ ]/ M/ -/ Aegis/ [/ 70/ ]/ 表/ 2/ 密文/ 搜索/ 相关/ 文献/ 的/ 功能/ 对比/ ShadowCrypt/ [/ 46/ ]/ 不/ 支持/ 不/ 支持/ 不/ 支持/ 非/ 索引/ 不/ 需要/ 单/ // 单不/ 支持/ 不/ 支持/ 不/ 支持/ 非/ 索引/ 不/ 需要/ 单/ // 单/ 近年来/ ,/ 密文/ 搜索/ 研究/ 进一步/ 发展/ ,/ 实现/ 可多/ 关键字/ 搜索/ 、/ 智能/ 排序/ 、/ 索引/ 更新/ 、/ 模糊/ 匹配/ 等/ 高级/ 功能/ ./ Sun/ 等/ 人/ [/ 64/ ]/ 、/ Cao/ 等/ 人/ [/ 65/ ]/ 支持/ 多/ 关键字/ 和/ 结果/ 排序/ ./ Xia/ 等/ 人/ [/ 66/ ]/ 在/ 云/ 加密/ 数据/ 上/ 实现/ 多/ 关键字/ 排名/ 的/ 搜索/ 方案/ ,/ 同时/ 支持/ 动态/ 更新/ 操作/ ,/ 如/ 文件/ 删除/ 序/ 等/ 操作/ ./ Mylar/ 构建/ 的/ 面向/ 多用户/ 使用/ 索引/ 的/ 密文/ 搜索/ 需要/ 服务端/ 调用/ Mylar/ 库/ 实现/ ,/ 利用/ 特定/ 的/ 数据/ 加密/ 方案/ ,/ 使用/ 陷门/ 函数/ 获取/ 特定/ 的/ 密文/ ./ 密文/ 搜索/ 一直/ 是/ 数据/ 加密/ 研究/ 的/ 热点/ ,/ 表/ 2/ 是/ 密文/ 搜索/ 相关/ 文献/ 的/ 功能/ 对比/ ./ 针对/ 多用户/ 密文/ 搜索/ ,/ Boneh/ 等/ 人/ [/ 60/ ]/ 利用/ 非对称/ 加密/ 实现/ 了/ PEKS/ (/ PublicKeyEncryptionwithKeywordSearch/ )/ 算法/ ./ 数据/ 拥有者/ 在/ 向/ 云/ 服务提供商/ 上传/ 数据/ 前/ ,/ 用/ 数据/ 使用者/ 的/ 公钥/ 加密/ 数据/ ,/ 并/ 将/ 该/ 文件/ 的/ 所有/ 关键字/ 分别/ 用/ 特殊/ 的/ 可/ 搜索算法/ (/ PEKS/ )/ 进行/ 加密/ ./ 上传/ 文件/ 时/ ,/ 拥有者/ 一并/ 上传/ 密文/ 和/ 加密/ 后/ 的/ 关键字/ ./ 数据/ 使用者/ 进行/ 搜索/ 时/ ,/ 事先/ 将要/ 搜索/ 的/ 关键字/ 换算/ 成陷门/ (/ trapdoor/ )/ Tw/ 发送给/ 云/ 服务提供商/ ./ 云/ 服务提供商/ 利用/ 比/ 对/ 函数/ 处理/ Tw/ 、/ 使用者/ 的/ 公钥/ 和/ 所有/ 加密/ 的/ 关键字/ ,/ 从而/ 断定/ 要/ 搜索/ 的/ 关键字/ 是否/ 在/ 某/ 一/ 文档/ 中/ ,/ 并/ 向/ 用户/ 返回/ 结果/ ./ Liu/ 等/ 人/ [/ 61/ ]/ 基于/ PEKS/ 提出/ SPKS/ (/ SecureandPrivacyPreservingKeywordSearching/ )/ 方案/ ,/ 使云/ 服务提供商/ 可以/ 在/ 不/ 知道/ 明文/ 具体内容/ 的/ 前提/ 下/ 参与/ 部分/ 的/ 解密/ 工作/ ,/ 从而/ 降低/ 了/ 数据/ 用户/ 解密/ 密文/ 的/ 运算/ 压力/ ./ Goh/ [/ 62/ ]/ 提出/ 了/ 使用/ 安全/ 索引/ 的/ 方法/ 实现/ 密文/ 搜索/ ./ 用户/ 将/ 文档/ 加密/ 并/ 利用/ BloomFilter/ 为/ 每个/ 文档/ 生成/ Z/ -/ IDX/ 索引/ ,/ 然后/ 将/ 安全/ 加密/ 索引/ 和/ 加密/ 文件/ 上/ 传到/ 云端/ ./ 搜索/ 时/ ,/ 用户/ 将/ 搜索/ 关键字/ 对应/ 的/ 查询/ 单射/ 函数/ 发给/ 云端/ ,/ 云端/ 对/ 索引/ 进行/ 搜索/ 并/ 返回/ 结果/ ./ 然而/ 该/ 方案/ 采用/ 的/ BloomFilter/ 存在/ 错误率/ ,/ 可能/ 导致/ 搜索/ 结果/ 不/ 准确/ ./ Curtmola/ 等/ 人/ [/ 63/ ]/ 首次/ 使用/ 倒排/ 索引/ 构建/ 密文/ 搜索/ 机制/ ,/ 使/ 搜索/ 效率/ 大大提高/ ,/ 并/ 提升/ 密文/ 搜索/ 的/ 安全性/ ./ 支持/ 和/ 插入/ ./ 以上/ 密文/ 搜索/ 方案/ 需要/ 将/ 加密/ 索引/ 上/ 传到/ 服务器/ 且/ 需要/ 服务器/ 配合/ 实现/ 特定/ 搜索/ 功能/ ./ 针对/ 不/ 改变/ 服务器程序/ 逻辑/ 且/ 不/ 改变/ 用户/ 使用/ 习惯/ 而/ 实现/ 密文/ 搜索/ ,/ ShadowCrypt/ [/ 46/ ]/ 利用/ 浏览器/ 插件/ 对/ 关键字/ 建立/ 哈希/ 存在/ 密文/ 数据/ 之后/ ,/ M/ -/ Aegis/ [/ 70/ ]/ 基于/ Page14/ 手机/ 平台/ 提出/ 介于/ 用户/ 和/ 应用程序/ 之间/ 的/ 7.5/ 层/ ,/ 可/ 透明/ 地/ 加解密/ 用户/ 数据/ 并/ 设计/ 密文/ 搜索/ 方案/ EDESE/ (/ Efficiently/ -/ SearchableSymmetricEncryptionScheme/ )/ ,/ 使/ 搜索/ 依然/ 可以/ 使用/ 原来/ 的/ 字符串/ 匹配/ 逻辑/ ./ 5.1/ ./ 3ShadowCrypt/ 针对/ 预防/ 客户端/ 应用程序/ 及/ 服务器端/ 应用程序/ 偷窥/ 用户/ 隐私/ 数据/ ,/ ShadowCrypt/ 作为/ 浏览器/ 插件/ 运行/ ,/ 为/ 网络应用/ 程序/ 加密/ 文本/ 数据/ ./ 如图/ 13/ 所示/ ,/ ShadowCrypt/ 把/ 用户/ 输入输出/ 数据/ 从/ 原程序/ DOM/ 隔离/ 开来/ ,/ 在/ 浏览器/ 插件/ 中/ 利用/ shadowDOM/ 和/ shadowJS/ 执行/ 加解密/ 等/ 功能/ ./ 如图/ 13/ 右/ 部分/ 所示/ ,/ 当/ 载入/ 网页/ 时/ ShadowCrypt/ 对图/ 13ShadowCrypt/ 系统/ 架构/ ShadowCrypt/ 对/ 程序/ 没有/ 特殊要求/ ,/ 针对/ 用户服务/ ,/ 支持/ 目前/ 的/ WEB/ 程序/ ./ ShadowCrypt/ 在/ 用户/ 与/ 客户端程序/ 之间/ 加解密/ ,/ 从而/ 最小化/ 可/ 信任/ 基/ ./ 但/ ShadowCrypt/ 只能/ 在/ PC/ 平台/ WEB/ 浏览器/ 如/ Chrome/ 或/ Firefox/ 上/ 运行/ ,/ 不能/ 加密/ 手机/ 应用程序/ 的/ 数据/ ,/ 且/ 不是/ 通过/ 输入/ 元素/ 传输/ 的/ 隐私/ 数据/ 不能/ 被/ 加密/ ./ 5.2/ 需要/ 云/ 服务商/ 配合/ 的/ 用户/ 数据/ 加密/ 依赖/ 云/ 服务提供商/ 的/ 用户/ 数据/ 加密/ 需要/ 云/ 服务提供商/ 配合/ ./ 如/ 客户端/ 和/ 云端/ 双层/ 加密/ 需要/ 云/ 服务商/ 执行/ 多用户/ 密文/ 访问控制/ 加密/ ,/ 硬件/ 层/ 配合/ 客户端/ 加密/ 需要/ 云/ 平台/ 硬件/ 层/ 提供/ 加解密/ 密码/ 协处理器/ ./ 以上/ 方案/ 虽然/ 需要/ 云/ 服务商/ 配合/ ,/ 但是/ 数据/ 到/ 云/ 数据/ 进行/ 扫描/ ,/ 根据/ DOM/ 找到/ 其中/ 的/ 数据/ 输入/ 部分/ ,/ 建立/ 对应/ 的/ shadowDOM/ 树/ ,/ 利用/ 安全/ 独立/ 的/ 阴影/ 输入/ 替换/ 页面/ 中/ 的/ 输入/ 元素/ ,/ 用户/ 输入/ 的/ 内容/ 先/ 要/ 经过/ shadowJS/ 加密/ ,/ 然后/ 再/ 给/ 应用程序/ ./ 这样/ 即使/ 应用程序/ 或/ 服务器/ 被/ 入侵/ 也/ 不会/ 泄露/ 用户/ 的/ 隐私/ 数据/ ./ 应用程序/ 返回/ 给/ 用户/ 的/ 数据/ 会/ 回调/ shadowJS/ 程序/ 进行/ 解密/ 密文/ 数据/ ,/ 再/ 返回/ 给/ 用户/ ./ 加密/ 后/ 的/ 数据/ 赋予/ 加密/ 特征/ ,/ 如/ 含有/ 密钥/ 指纹/ 及/ 用到/ 的/ 参数/ ,/ 来/ 帮助/ 应用程序/ 识别/ 密文/ 数据/ 并/ 解密/ 返回/ 给/ 用户/ ./ 如图/ 13/ 左下/ 部分/ 所示/ ,/ 当/ 进行/ 数据/ 搜索/ 时/ ,/ ShadowCrypt/ 对/ 文本/ 内/ 的/ 关键字/ 建立/ 哈希/ 存在/ 密文/ 数据/ 之后/ ,/ 这样/ 对/ 数据/ 进行/ 搜索/ 时/ 把/ 数据/ 转换成/ 对应/ 的/ 哈希/ 值/ 进行/ 搜索/ ,/ 安全性/ 较/ 低/ ,/ 容易/ 遭受/ 统计/ 攻击/ ./ 服务商/ 之前/ 已经/ 过/ 加密/ ,/ 故可/ 有效/ 预防/ 云/ 服务商/ 内部人员/ 偷窥/ 或/ 窃取/ 用户/ 隐私/ ./ 5.2/ ./ 1/ 客户端/ 和/ 云端/ 双层/ 加密/ Over/ -/ encryption/ [/ 47/ ]/ 为了/ 实现/ 客户端/ 加密/ 同时/ 实现/ 在/ 云端/ 对/ 用户/ 数据/ 作/ 访问控制/ ,/ 将/ 数据保护/ 加密/ 与/ 动态/ 授权/ 加密/ 分离/ ,/ 而/ 不必/ 请求/ 所有者/ 每次/ 在/ 授权/ 策略/ 改变/ 时/ 下载/ 并/ 重新/ 加密/ 资源/ ./ 第一层/ Bel/ 层/ 加密/ 由/ 数据/ 所有者/ 在/ 发送数据/ 到/ 服务器/ 之前/ 执行/ ,/ 在/ 初始化/ 时使/ 每个/ 用户/ 拥有/ 自己/ 的/ 密钥/ ,/ 并/ 分配/ 一些/ 可用/ 的/ 令牌/ ,/ 用户/ 利用/ 公共/ 令牌/ 结合/ 自己/ 的/ 密钥/ 得到/ 其他/ 资源/ 密钥/ 解密/ 自己/ 可/ 访问/ 的/ 资源/ ,/ 从而/ 服务商/ 窃取/ 不到/ 用户/ 的/ 隐私/ 数据/ ./ 第二层/ Sel/ 层/ 加密/ 在/ 服务端/ 执行/ ,/ 对/ 数据/ 所有者/ 已经/ 加密/ 的/ 数据/ 选/ Page15/ 择性/ 加密/ ,/ 在/ 第一层/ 加密/ 的/ 方案/ 下/ 调整/ 自己/ 的/ 密钥/ 转换/ 方案/ 实行/ 动态/ 资源/ 授权/ 与/ 撤销/ ,/ 用户/ 拥有/ 双层/ 密钥/ 才能/ 访问/ 数据/ ./ 其中/ Sel/ 层/ 分为/ FullSEL/ 和/ DeltaSEL/ 层/ ,/ FullSEL/ 方法/ 提供/ 更/ 安全/ 的/ 保护/ ,/ 但/ 性能/ 较/ 高/ ;/ DeltaSEL/ 方法/ 提供/ 了/ 优越/ 的/ 性能/ ,/ 但/ 安全性/ 较/ 低/ ./ 如图/ 14/ 所示/ ,/ 首先/ 根据/ 资源/ 访问/ 策略/ 建立/ 访问控制/ 树/ ,/ 如/ 资源/ r1/ ,/ r2/ 可/ 被/ 用户/ C/ 访问/ ,/ 资源/ r3/ ,/ r4/ 被/ 用户/ C/ 、/ D/ 访问/ ,/ 资源/ r5/ ,/ r6/ ,/ r7/ 被/ 用户/ A/ 、/ B/ 、/ C/ 访问/ ,/ 资源/ r8/ 可/ 被/ 用户/ A/ 、/ B/ 、/ C/ 、/ E/ 访问/ ./ 得到/ 资源/ 加密/ 密钥/ 之间/ 的/ 关系/ 后/ ,/ 对/ 不同/ 资源/ 利用/ 相应/ 的/ 密钥/ 进行/ 加密/ ,/ 如/ r1/ ,/ r2/ 用/ 密钥/ v3/ ./ k/ 加密/ ,/ 可/ 被/ C/ 访问/ ;/ r3/ ,/ r4/ 用/ 密钥/ v7/ ./ k/ 加密/ ,/ 可/ 被/ C/ 、/ D/ 利用/ 密钥/ 和/ token/ 转化/ 解密/ 密钥/ 访问/ ;/ r5/ ,/ r6/ ,/ r7/ 被/ 密钥/ v6/ ./ k/ 加密/ ,/ 可/ 被/ A/ 、/ B/ 、/ C/ 访问/ ;/ r8/ 利用/ 密钥/ v8/ ./ k/ 加密/ ,/ 可/ 被/ A/ 、/ B/ 、/ C/ 、/ E/ 访问/ ./ 然后/ 在/ 服务端/ 初始化/ 相应/ 的/ FullSEL/ 或/ Delta/ 图/ 14Over/ -/ encryption/ 密文/ 访问控制/ Over/ -/ encryption/ 使用/ 两层/ 加密/ 和/ 密钥/ 转换/ 的/ 思想/ 解决/ 多用户/ 密文/ 访问控制/ 问题/ ,/ 但/ 其/ 首先/ 要/ 在/ 客户端/ 计算资源/ 和/ 根据/ 用户/ 的/ 对应/ 关系/ 初始化/ 加密/ ,/ 实施/ 起来/ 具有/ 一定/ 的/ 限制/ ./ 针对/ 多用户/ 密文/ 访问控制/ 和/ 密/ SEL/ ,/ FullSEL/ 加密/ 方案/ 和/ Bel/ 相同/ ,/ 若/ 是/ DeltaSEL/ 则/ 不用/ 再次/ 加密/ ,/ 初始化/ 为/ NULL/ ./ 当/ 分配/ 给/ D/ 用户/ r5/ 资源/ 时/ ,/ Bel/ 层/ 添加/ D/ 用户/ 拥有/ 的/ 密钥/ 到/ 加密/ r5/ 的/ 密钥/ 之间/ 的/ 转化/ token/ ,/ 这样/ D/ 就/ 可以/ 访问/ r5/ 了/ ./ 但是/ 加密/ r5/ 的/ 密钥/ 也/ 用来/ 加密/ r6/ 和/ r7/ ,/ 故/ 在/ Sel/ 层/ 需要/ 做/ 访问控制/ 限制/ D/ 用户/ 访问/ r6/ ,/ r7/ ./ DeltaSEL/ 在/ SEL/ 层/ 对/ r6/ ,/ r7/ 重新/ 加密/ ,/ 并/ 添加/ A/ 、/ B/ 、/ C/ 用户/ 的/ 密钥/ 到/ 加密/ 密钥/ 之间/ 的/ 转化/ token/ ;/ 而/ D/ 用户/ 没有/ 可/ 转化/ 的/ token/ ,/ 则/ 访问/ 不到/ r6/ ,/ r7/ ./ 而/ FullSEL/ 在/ SEL/ 层/ 首先/ 添加/ A/ 、/ B/ 、/ C/ 密钥/ 到/ r6/ ,/ r7/ 密钥/ 的/ 转化/ token/ ,/ 再/ 添加/ A/ 、/ B/ 、/ C/ 、/ D/ 密钥/ 到/ r5/ 密钥/ 的/ 转化/ token/ ,/ 也/ 就/ 实现/ 了/ 上述/ 的/ 访问控制/ ./ 当/ 撤销/ C/ 对/ r2/ 的/ 访问/ 权时/ ,/ 由于/ r2/ 现在/ 没有/ 人/ 可/ 访问/ ,/ 则/ FullSEL/ 和/ DeltaSEL/ 都/ 是/ 产生/ 新/ 的/ Sel/ 层/ 密钥/ 来/ 加密/ r2/ ,/ 这样/ 所有/ 用户/ 都/ 访问/ 不了/ r2/ 了/ ./ 钥/ 分发/ 管理/ 问题/ ,/ 研究/ 人员/ 已经/ 做/ 了/ 大量/ 的/ 研究/ 工作/ ,/ 其中/ 基于/ 属性/ 的/ 加密/ (/ Attribute/ -/ BasedEncryption/ ,/ ABE/ )/ 是/ 一个/ 热点/ 研究/ 方向/ ./ 基于/ 属性/ 加密/ 由/ Sahai/ 等/ 人/ [/ 71/ ]/ 提出/ ,/ 将/ 数据/ 加密/ 与/ 用户/ 属性/ 相关联/ ,/ 每个/ Page16/ 用户/ 拥有/ 不同/ 的/ 属性/ ,/ 数据/ 拥有者/ 根据/ 用户/ 属性/ 制定/ 数据/ 加密/ 策略/ 加密/ 数据/ 生成/ 密文/ ,/ 相应/ 地/ ,/ 只有/ 用户/ 密钥/ 包含/ 的/ 属性/ 满足/ 密文/ 要求/ 的/ 属性/ 时/ ,/ 用户/ 才能/ 解密/ 密文/ 数据/ ./ 不同/ 用户/ 的/ 密钥/ 往往/ 是/ 由/ 可信/ 的/ 密钥/ 发布者/ 根据/ 用户/ 属性/ 生成/ ,/ 与/ 不同/ 的/ 随机/ 多项式/ 相关/ ,/ 从而/ 可以/ 有效/ 防范/ 合谋/ 攻击/ ,/ 即/ 不同/ 用户/ 联合/ 各自/ 拥有/ 的/ 不同/ 属性/ 以/ 访问/ 原来/ 都/ 不/ 具有/ 访问/ 权限/ 的/ 资源/ ./ 利用/ 秘密/ 分享/ 方案/ [/ 72/ ]/ ,/ 当/ 用户/ 的/ 身份/ 属性/ 与/ 访问控制/ 的/ 属性/ 之间/ 的/ 交集/ 大于/ 一定/ 阈值/ 时/ 用户/ 即可/ 解密/ 密文/ ,/ 由于/ 阈值/ 在/ 初始化/ 系统/ 时/ 需要/ 确定/ ,/ 具有/ 一定/ 的/ 局限性/ ./ Goyal/ 等/ 人/ [/ 73/ ]/ 提出/ KP/ -/ ABE/ (/ KeyPolicyAttributeBasedEncryption/ )/ ,/ 数据/ 由/ 用户/ 属性/ 加密/ ,/ 而/ 用户/ 的/ 密钥/ 与/ 任意/ 单调/ 的/ 树形/ 访问/ 结构/ 相关/ ./ 但/ 这种/ 方案/ 加密/ 者/ 只能/ 对/ 密文/ 赋予/ 一组/ 相关/ 的/ 属性/ ,/ 不能/ 控制/ 可以/ 访问/ 自己/ 加密/ 数据/ 的/ 用户/ ./ Bethencourtet/ 等/ 人/ [/ 74/ ]/ 提出/ CP/ -/ ABE/ (/ CiphertextPolicyAttributeBasedEncryption/ )/ ,/ 使/ 加密/ 者/ 可以/ 控制/ 拥有/ 什么/ 属性/ 的/ 用户/ 可以/ 访问/ 密文/ 数据/ ,/ 用户/ 的/ 密钥/ 与/ 一组/ 属性/ 相关/ ,/ 而/ 密文/ 与/ 一个/ 基于/ 一组/ 属性/ 的/ 访问控制/ 树/ 相关/ ,/ 但/ 不能/ 实现/ 完全/ 授权/ ./ 针对/ 细粒度/ 的/ 访问控制/ 和/ 完全/ 授权/ 问题/ ,/ Wang/ 等/ 人/ [/ 75/ ]/ 结合/ HIBE/ (/ HierarchicalIdentityBasedEncryption/ )/ [/ 76/ ]/ 系统/ 和/ CP/ -/ ABE/ 系统/ 提出/ 支持/ 分层/ 的/ 密文/ 访问控制/ 的/ HABE/ (/ HierarchicalAttributeBasedEncryption/ )/ 系统/ ,/ 实现/ 完全/ 授权/ ,/ 但/ 不能/ 表现/ 分层/ 的/ 属性/ 集合/ ./ HASBE/ [/ 77/ ]/ (/ HierarchicalAttributeSetBasedEncryption/ )/ 方案/ 扩展/ 了/ 基于/ 属性/ 集/ 的/ 加密/ 方案/ ,/ 支持/ 复合/ 属性/ ./ 针对/ 用户/ 撤销/ 问题/ ,/ Wang/ 图/ 15PasS/ 系统/ 模型/ PasS/ 云端/ 加解密/ 数据/ 利用/ 密码/ 协处理器/ ,/ 即/ 一个/ 用于/ 加解密/ 的/ 计算机芯片/ ,/ 并/ 具有/ 防/ 窜改/ 的/ 特性/ ./ 由/ 可信/ 第三方/ 对/ 注册/ 的/ 用户/ 分发/ 密钥/ ,/ 并/ 把/ 密码/ 协等/ 人/ [/ 75/ ]/ 赋予/ 云/ 服务商/ 更/ 多/ 的/ 计算/ 任务/ 从而/ 实现/ 可/ 扩展/ 的/ 用户/ 撤销/ 机制/ ./ HASBE/ [/ 77/ ]/ 为/ 访问/ 到期/ 时间/ 采用/ 多重/ 赋值/ ,/ 比/ 现有/ 方案/ 更/ 有效/ 地/ 处理/ 用户/ 撤销/ ./ Sieve/ [/ 78/ ]/ 结合/ 密钥/ 同态/ 首先/ 在/ 云端/ 使用/ 不同/ 密钥/ 重新/ 加密/ 用户/ 数据/ ,/ 然后/ 新/ 数据/ 密钥/ 及/ 数据/ 指针/ 等/ 以/ 用户/ 属性/ 加密/ 替换/ 原来/ 的/ 元/ 数据/ 块/ ,/ 撤销/ 解密/ 密钥/ 且/ 不会/ 泄露/ 新/ 密钥/ ./ 针对/ 多/ 授权/ 中心/ 及/ 隐私/ 保护/ 问题/ ,/ Ruj/ 等/ 人/ [/ 79/ ]/ 在/ 云/ 存储/ 信息/ 之前/ 验证/ 用户/ 的/ 真伪/ ,/ 不/ 需要/ 知道/ 用户/ 的/ 身份/ ,/ 并/ 采取/ 分散/ 的/ 认证/ 和/ 访问控制/ ./ Lewko/ 等/ 人/ [/ 80/ ]/ 设计/ 支持/ 多/ 授权/ 方/ 的/ ABE/ 系统/ ,/ 用户/ 通过/ 自己/ 身份/ ID/ 标志/ 私钥/ 的/ 唯一性/ ,/ 预防/ 多/ 授权/ 方/ 联合/ 恢复/ 出/ 用户/ 的/ 私钥/ 窃取/ 用户/ 数据/ ./ Rouselakis/ 等/ 人/ [/ 81/ ]/ 和/ Han/ 等/ 人/ [/ 82/ ]/ 设计/ 的/ 方案/ 中/ 不/ 存在/ 唯一/ 授权/ 中心/ ,/ 而是/ 有/ 不同/ 的/ 授权/ 中心/ 分发/ 密钥/ 给/ 用户/ ,/ 每个/ 授权/ 中心/ 负责/ 一组/ 特定/ 属性/ 的/ 授权/ 密钥/ 分发/ ./ Zhang/ 等/ 人/ [/ 83/ ]/ 使用/ 两个/ 授权/ 部门/ ,/ 任何一方/ 都/ 不能/ 独立/ 地/ 解密/ 密文/ ./ Jung/ 等/ 人/ [/ 84/ ]/ 提出/ 半/ 匿名/ 权限/ 控制/ 方案/ AnonyControl/ ,/ 分散/ 了/ 中央/ 权威/ 以/ 限制/ 身份/ 泄漏/ ,/ 不仅/ 实现/ 文件/ 访问控制/ ,/ 还/ 实现/ 了/ 文件/ 访问控制/ 的/ 特权/ 控制/ ,/ 可以/ 细粒度/ 地/ 管理/ 数据/ 的/ 所有/ 操作/ 权限/ ./ Veluru/ 等/ 人/ [/ 85/ ]/ 提出/ 任何/ 属性/ 权威/ (/ AA/ )/ 可以/ 独立/ 加入/ 和/ 离开/ 系统/ ,/ 而/ 无需/ 与/ 现有/ 的/ AA/ 合作/ ./ 用户/ 从/ 多/ 授权/ 方/ 获得/ 用户/ 密钥/ ,/ 保护/ 用户/ 的/ 隐私/ ./ 5.2/ ./ 2/ 硬件/ 层/ 配合/ 客户端/ 加密/ 如图/ 15/ 所示/ ,/ PasS/ (/ PrivacyasaService/ )/ [/ 48/ ]/ 基于/ 硬件/ 的/ 方法/ ,/ 用户/ 用/ 自己/ 的/ 密钥/ 对/ 数据/ 加密/ 后/ 传到/ 云端/ ,/ 并/ 对/ 云端/ 传回/ 的/ 密文/ 数据/ 进行/ 解密/ 获得/ 明文/ ,/ 从而/ 有效/ 预防/ 云端/ 的/ 内部/ 威胁/ ./ 处理器/ 配置/ 在/ 云/ 平台/ 物理/ 硬件/ 上/ ./ 密码/ 协处理器/ 里面/ 有/ 专门/ 的/ 存储单元/ 存储用户/ 密钥/ 、/ 可信/ 第三方/ 密钥/ 、/ 用户/ 隐私/ 程序/ 数据/ 等/ ,/ 用户/ 密钥/ 用于/ 加解密/ 用户/ Page17/ 数据/ ,/ 第三方/ 密钥/ 用于/ 执行/ 可信/ 第三方/ 传来/ 的/ 加密/ 的/ 命令/ ./ 云/ 平台/ 上/ 有/ 个/ 特权/ 程序/ 和/ 密码/ 协处理器/ 交互/ ,/ 确保/ 用户/ 的/ 隐私/ 程序/ 和/ 数据/ 在/ 密码/ 协处理器/ 可信/ 的/ 存储单元/ 上/ 执行/ ,/ 数据/ 加密/ 存储/ 在/ 可信/ 的/ 资源/ 池中/ ,/ 确保/ 不/ 被/ 云/ 平台/ 人员/ 窃取/ ./ 特权/ 程序/ 还/ 对/ 用户程序/ 的/ 执行/ 进行/ 审计/ 并/ 加密/ 反馈/ 给/ 用户/ ,/ 使/ 用户/ 了解/ 自己/ 程序/ 在/ 云/ 平台/ 上/ 的/ 执行/ 是/ 可信/ 的/ ./ 这种/ 方案/ 需要/ 购买/ 硬件/ ,/ 且/ 需要/ 在/ 云/ 平台/ 上作/ 配置/ ,/ 并/ 需要/ 客户端程序/ 配合/ ,/ 不利于/ 实施/ ./ 6/ 总结/ 与/ 展望/ 本文/ 总结/ 分析/ 了/ 云/ 计算/ 模式/ 下/ 特有/ 的/ 内部/ 威胁/ ,/ 并/ 通过/ 真实/ 攻击/ 实例/ 说明/ 云/ 平台/ 确实/ 可能/ 遭受/ 的/ 内部/ 威胁/ ./ 通过/ 梳理/ 国内外/ 相关/ 研究/ 文献/ ,/ 本文/ 针对/ 云/ 计算/ 模式/ 内部/ 威胁/ 问题/ 及其/ 应对/ 做/ 了/ 较为/ 全面/ 的/ 介绍/ 和/ 讨论/ ,/ 从/ 人员/ 评价/ 与/ 行为/ 分析/ 、/ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 、/ 用户/ 可控/ 的/ 数据/ 加密/ 这/ 3/ 个/ 方面/ 进行/ 综述/ ,/ 并/ 认为/ 进一步/ 的/ 研究/ 重点/ 应/ 解决/ 以下/ 问题/ :/ 第一/ ,/ 怎样/ 把/ 人员/ 评价/ 技术/ 更好/ 地/ 应用/ 到/ 实际/ 中来/ ,/ 并/ 提高/ 人员/ 行为/ 分析/ 的/ 时效性/ 和/ 有效性/ ./ 怎样/ 实现/ 在/ 不/ 侵犯/ 用户/ 隐私/ 的/ 前提/ 下/ ,/ 使/ 人员/ 评价/ 技术/ 和/ 现有/ 成熟/ 技术相结合/ ,/ 才能/ 更/ 有效/ 地/ 防范/ 内部/ 威胁/ 问题/ ./ 用户/ 行为/ 分析/ 可以/ 有效/ 地/ 验证/ 用户/ 是否是/ 真正/ 的/ 用户/ ,/ 但/ 需要/ 收集/ 大量/ 用户/ 历史/ 操作/ 数据/ ,/ 往往/ 存在/ 一定/ 的/ 误报率/ 或/ 漏报/ 率/ ./ 其/ 本身/ 为/ 被动/ 防御/ ,/ 怎样/ 提高/ 拦截/ 的/ 时效性/ 也/ 是/ 研究/ 的/ 重点/ ./ 如果/ 用户/ 本身/ 想要/ 作恶/ ,/ 且/ 操作/ 极其/ 隐蔽/ ,/ 则/ 可能/ 逃/ 过/ 检测/ ,/ 需要/ 结合/ 其他/ 技术/ 如/ 数据/ 加密/ 来/ 保护/ 用户/ 隐私/ ./ 第二/ ,/ 提高/ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 的/ 适用性/ 和/ 可操作性/ ./ 云/ 管理权限/ 划分/ 和/ 执行/ 时/ 验证/ 机制/ 往往/ 需要/ 修改/ 虚拟机/ 管理器/ ,/ 需要/ 可信/ 机制/ 验证/ 系统/ 行为/ ,/ 往往/ 机制/ 比较复杂/ ,/ 与/ 现有/ 的/ 公有/ 云/ 平台/ 不/ 兼容/ ./ 未来/ 的/ 研究/ 重点/ 是/ 如何/ 在/ 不/ 改变/ 虚拟机/ 管理器/ 及/ 虚拟机/ 的/ 前提/ 下/ ,/ 采用/ 带外/ 方式/ 监控/ 虚拟机/ 及/ 程序/ 状态/ ,/ 并/ 可/ 对/ 恶意/ 攻击/ 主动/ 预警/ ./ 第三/ ,/ 提高/ 基于/ 用户/ 可控/ 的/ 数据/ 加密/ 的/ 计算/ 性能/ 和/ 计算/ 功能/ ./ 加密/ 通常/ 作为/ 一种/ 手段/ 保护/ 用户/ 数据/ 的/ 隐私/ ,/ 但/ 需要/ 妥善/ 管理/ 密钥/ 不/ 被/ 窃取/ ,/ 用户/ 可控/ 的/ 数据/ 加密/ 可/ 有效/ 保护/ 用户/ 数据/ 和/ 密钥/ ,/ 但/ 势必会/ 影响/ 云端/ 数据/ 计算/ 功能/ ,/ 如/ 数据/ 访问控制/ 问题/ 和/ 数据/ 计算/ 问题/ ./ 未来/ 用户/ 数据/ 加密/ 的/ 研究/ 重点/ 是/ 怎么/ 有效/ 地/ 对/ 密文/ 数据/ 作/ 访问控制/ 和/ 数据/ 计算/ ,/ 同时/ 不会/ 引入/ 过大/ 的/ 计算/ 开销/ 和/ 复杂/ 的/ 机制/ ,/ 提高/ 可用性/ ./ 另外/ ,/ 预防/ 云/ 计算/ 模式/ 内部/ 威胁/ 还应/ 包括/ 其他/ 技术/ ,/ 如/ 管理员/ 权限/ 细粒度/ 管控/ 、/ 云/ 平台/ 安全/ 机制/ 防护/ 、/ 云/ 平台/ 操作/ 审计/ 与/ 回溯/ 等/ 措施/ ,/ 做到/ 多/ 措施/ 预防/ ,/ 及早/ 发现/ ,/ 出现/ 后/ 及时/ 应对/ ,/ 将/ 风险/ 降到/ 最低/ ./ 通过/ 大量/ 分析/ 实践/ ,/ 我们/ 认为/ 以下几点/ 是/ 重要/ 的/ 云/ 安全/ 防护/ 关键技术/ ,/ 包括/ :/ (/ 1/ )/ 云/ 系统资源/ 访问/ 入口/ 严格/ 管控/ 所有/ 访问/ 云/ 平台/ 内/ 的/ 资源/ 或/ 数据/ 要/ 经过/ 统一/ 的/ 入口/ 中转/ ,/ 如/ 访问/ 具体/ 云/ 平台/ 、/ 虚拟机/ 或/ 网络设备/ 等/ ,/ 在/ 入口/ 经过/ 认证/ 后方/ 能/ 单点/ 登录/ 到/ 相关/ 的/ 资源/ 或/ 数据/ ,/ 从而/ 避免/ 访问/ 认证/ 上/ 的/ 混乱/ ,/ 做到/ 统一/ 管控/ ,/ 防止/ 内部人员/ 绕开/ 认证/ 系统实施/ 恶意/ 行为/ ./ (/ 2/ )/ 云/ 系统资源/ 操作/ 留痕/ 登录/ 云/ 系统资源/ 访问/ 入口/ 后/ 所有/ 对/ 资源/ 或/ 数据/ 的/ 操作/ 都/ 要/ 详细/ 记录/ ,/ 并/ 能/ 做到/ 操作/ 记录/ 审计/ 回放/ ./ 对/ 用户/ 的/ 操作/ 数据/ 进行/ 处理/ ,/ 通过/ 心理学/ 和/ 行为/ 分析/ 检测/ 到/ 恶意/ 行为/ ,/ 并/ 能/ 对/ 可疑/ 行为/ 进行/ 追溯/ ./ (/ 3/ )/ 云/ 系统/ 重要/ 数据/ 加密/ 通过/ 加密/ 保障/ 用户/ 的/ 数据/ 不/ 被/ 恶意/ 内部人员/ 窃取/ ,/ 针对/ 访问控制/ 问题/ ,/ 建立/ 可信/ 的/ 第三方/ 服务/ ,/ 在/ 利用/ 原有/ 系统/ 访问控制/ 的/ 基础/ 上/ ,/ 用户/ 可/ 对/ 授权/ 的/ 不同/ 密钥/ 密文/ 数据/ 向/ 可信/ 第三方/ 认证/ 申请/ 获得/ 明文/ ./ 同时/ 研究/ 密文/ 搜索/ 技术/ ,/ 从而/ 节约/ 带宽/ 资源/ ,/ 提高效率/ ./ 致谢/ 在/ 此/ ,/ 我们/ 向/ 对/ 本文/ 的/ 工作/ 给予/ 支持/ 和/ 建议/ 的/ 同行/ 表示/ 衷心/ 的/ 感谢/ !/ 

