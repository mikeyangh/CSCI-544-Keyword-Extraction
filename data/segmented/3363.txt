Page1/ 一种/ 针对/ Camellia/ 的/ 改进/ 差分/ 故障/ 分析/ 赵新杰/ 1/ )/ 王韬/ 1/ )/ 郭/ 世泽/ 2/ )/ 1/ )/ (/ 军械/ 工程学院/ 计算机/ 工程系/ 石家庄/ 050003/ )/ 2/ )/ (/ 北方/ 电子设备/ 研究所/ 北京/ 100083/ )/ 摘要/ 查找/ S/ 盒/ 是/ 分组/ 密码/ 设计/ 中/ 的/ 一种/ 重要/ 操作/ ,/ 也/ 是/ 防御/ 传统/ 线性/ 和/ 差分/ 分析/ 的/ 有效/ 手段/ ,/ 但是/ 当/ 考虑/ 到/ 密码/ 实现/ 泄露/ 的/ 物理/ 效应/ 信息/ 时/ ,/ 其/ 却/ 成为/ 了/ 密码/ 系统/ 最/ 脆弱/ 的/ 一部分/ ./ 文中/ 对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 攻击/ 进行/ 了/ 研究/ ,/ 给出/ 了/ 一种/ 针对/ Camellia/ 的/ 改进/ 差分/ 故障/ 分析方法/ ./ 首先/ ,/ 将/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 差分/ 故障/ 分析/ 归结为/ 求解/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 问题/ ,/ 给出/ 了/ 基本/ 的/ 差分/ 故障/ 分析模型/ 并/ 演化出/ 了/ SPN/ 和/ Feistel/ 结构/ 分组/ 密码/ 的/ 差分/ 故障/ 分析模型/ ./ 然后/ ,/ 提出/ 了/ 针对/ Camellia/ 的/ 改进/ 差分/ 故障/ 分析方法/ ,/ 对/ 攻击/ 复杂度/ 进行/ 了/ 分析/ ,/ 并/ 通过/ 仿真/ 实验/ 进行/ 验证/ ./ 结果表明/ ,/ 由于/ 扩散/ 函数/ 的/ 可逆性/ 和/ Feistel/ 结构/ ,/ Camellia/ 易/ 遭受/ 深度/ 差分/ 故障/ 分析/ ,/ 16/ 次/ 和/ 24/ 次/ 故障注入/ 即可/ 分别/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ./ 最后/ ,/ 分析/ 了/ 密码/ 设计/ 中/ 的/ 查找/ S/ 盒/ 操作/ 和/ 针对/ 密码/ 实现/ 物理/ 效应/ 的/ 攻击/ 之间/ 的/ 矛盾/ ,/ 并/ 讨论/ 了/ 分组/ 密码/ 故障/ 攻击/ 可能/ 的/ 发展趋势/ ./ 关键词/ Camellia/ ;/ 分组/ 密码/ ;/ 差分/ 故障/ 分析/ ;/ 查找/ S/ 盒/ ;/ SPN/ 结构/ ;/ Feistel/ 结构/ 1/ 引言/ 1.1/ 相关/ 工作/ 密码学/ 由/ 密码术/ 和/ 密码/ 分析/ 术/ 两/ 方面/ 组成/ ,/ 密码术/ 主要/ 用来/ 设计/ 和/ 发展/ 一些/ 基于/ 数学/ 的/ 算法/ 、/ 协议/ 以/ 保障/ 信息安全/ ,/ 而/ 密码/ 分析/ 术/ 则/ 是/ 对/ 这些/ 算法/ 和/ 协议/ 安全/ 进行/ 分析/ 从而/ 促进/ 和/ 提高/ 密码术/ 安全/ 的/ 学科/ ./ 传统/ 的/ 密码/ 分析/ 将/ 密码/ 实现/ 当成/ 一种/ 黑盒/ ,/ 通过/ 观测/ 密码/ 实现/ 的/ 输入/ 和/ 输出/ ,/ 利用/ 线性/ 和/ 差分/ 数学分析/ 方法/ 去/ 推测/ 密钥/ ./ 随着/ 密钥/ 长度/ 和/ 设计/ 复杂度/ 的/ 增加/ ,/ 密码/ 算法/ 的/ 安全性/ 得到/ 了/ 很大/ 提升/ ,/ 传统/ 的/ 数学分析/ 已/ 远远/ 不能/ 在/ 有效/ 时间/ 和/ 空间/ 复杂度/ 内/ 完成/ 攻击/ ./ 然而/ 在/ 密码/ 算法/ 实现/ 过程/ 中/ ,/ 由于/ 其/ 实现/ 需/ 依附/ 一个/ 物理/ 设备/ 平台/ ,/ 加解密/ 过程/ 中/ 会/ 泄露/ 出如/ 时间/ [/ 1/ ]/ 、/ 故障/ [/ 2/ ]/ 、/ 功耗/ [/ 3/ ]/ 、/ 电磁/ [/ 4/ ]/ 、/ 声音/ [/ 5/ ]/ 等/ 额外/ 物理/ 效应/ 信息/ ,/ 而/ 这些/ 物理/ 效应/ 和/ 密钥/ 紧密/ 相关/ ,/ 可/ 被/ 用来/ 进行/ 密钥/ 破解/ ,/ 利用/ 这些/ 物理/ 效应/ 信息/ 进行/ 的/ 密码/ 攻击/ 国际/ 上/ 称之为/ “/ 针对/ 密码/ 实现/ 的/ 攻击/ ”/ ,/ 简称/ “/ 实现/ 攻击/ ”/ (/ ImplementationAttack/ ,/ IMA/ )/ ./ 目前/ 大部分/ 密码/ 算法/ 的/ 实现/ 安全性/ 均遭/ 此类/ 攻击/ 严重威胁/ ,/ 随着/ 先进/ 的/ 测试/ 仪器/ 和/ 计量/ 手段/ 的/ 出现/ 和/ 发展/ ,/ 实现/ 攻击/ 已经/ 具备/ 实际/ 攻击/ 可行性/ ./ 本文/ 对/ Camel/ -/ lia/ 分组/ 密码/ 的/ 故障/ 攻击/ 技术/ 进行/ 了/ 研究/ ./ Boneh/ 等/ 人于/ 1996/ 年/ 率先/ 提出/ 了/ 故障/ 攻击/ [/ 2/ ]/ ,/ 并用/ 这种/ 方法/ 成功/ 攻破/ 了/ RSA/ 签名/ 算法/ ./ 之后/ ,/ Biham/ 和/ Shamir/ 将/ 这种/ 攻击/ 思想/ 进行/ 改进/ ,/ 在/ 1997/ 年/ 提出/ 了/ 著名/ 的/ 差分/ 故障/ 分析方法/ [/ 6/ ]/ ,/ 成功/ 攻破/ 了/ DES/ 算法/ ,/ 为/ 密码/ 算法/ 故障/ 分析/ 提供/ 了/ 思路/ ./ 后来/ ,/ 研究者/ 利用/ 差分/ 故障/ 分析/ 又/ 分别/ 提出/ 了/ 对/ ECC/ [/ 7/ ]/ 、/ 3DES/ [/ 8/ ]/ 、/ AES/ [/ 9/ -/ 17/ ]/ 、/ Camellia/ [/ 18/ -/ 19/ ]/ 、/ ARIA/ [/ 20/ ]/ 、/ CLEFIA/ [/ 21/ -/ 22/ ]/ 、/ SMS4/ [/ 23/ -/ 26/ ]/ 、/ MIBS/ [/ 27/ ]/ 、/ RC4/ [/ 28/ -/ 29/ ]/ 、/ Trivium/ [/ 30/ -/ 31/ ]/ 等/ 其它/ 密码/ 算法/ 的/ 攻击/ 手段/ 及/ 相应/ 的/ 对策/ ./ 可见/ 不论是/ 公钥/ 密码/ 算法/ 、/ 分组/ 密码/ 算法/ 还是/ 流/ 密码/ 算法/ ,/ 无一幸免/ ,/ 都/ 面临/ 着/ 故障/ 攻击/ 的/ 严重威胁/ ./ Camellia/ [/ 32/ ]/ 是/ 由/ NTT/ 和/ Mitsubishi/ 电子/ 公司/ 在/ 2000/ 年/ 联合/ 提交/ 的/ 一个/ 分组/ 密码/ ,/ 2003/ 年/ 被/ 选择/ 成为/ 欧洲/ NESSIE/ 计划/ [/ 33/ ]/ 的/ 获胜者/ ,/ 2005/ 年/ 被/ 选择/ 成为/ XML/ 安全/ URIs/ [/ 34/ ]/ 、/ SSL/ // TLS/ 密码/ 套件/ 集/ [/ 35/ ]/ 、/ IPsec/ [/ 36/ ]/ 等/ 的/ IETF/ 标准/ 算法/ ./ 2009/ 年/ 3/ 月/ ,/ Camellia/ 被/ 集成/ 到/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta1/ [/ 37/ ]/ 密码/ 库中/ ,/ 2009/ 年/ 5/ 月/ Camellia/ 的/ CTR/ 模式/ 、/ CCM/ 模式/ 被/ IEFT/ 标准化/ 成为/ RFC5528/ ,/ 2009/ 年/ 6/ 月/ IEFT/ 标准/ OpenPGP/ 协议/ 加入/ Camellia/ 算法/ 成为/ RFC5581/ ,/ 2009/ 年/ 7/ 月/ 加入/ 成为/ Linux2/ ./ 4/ 和/ 2.6/ 内核/ IPsec/ 的/ 一部分/ ,/ 其/ 影响力/ 越来越/ 大/ ./ 近年来/ ,/ 各国/ 的/ 密码/ 研究/ 结构/ 对/ 其/ 安全性/ 进行/ 了/ 大量/ 的/ 分析/ ,/ 在/ Camellia/ 故障/ 分析/ 方面/ 的/ 主要/ 进展/ 如下/ :/ 周永彬/ 等/ [/ 18/ ]/ 提出/ 了/ 一种/ 针对/ Camellia/ 的/ 故障/ 攻击/ 方法/ ,/ 将/ Shamir/ 针对/ DES/ 的/ 差分/ 故障/ 分析方法/ [/ 6/ ]/ 引入/ 到/ Camellia/ 中/ ,/ 通过/ 在/ Camellia/ 第/ r/ 轮/ 左/ 寄存器/ 导入/ 1/ 个/ 随机/ 单字节/ 故障/ 恢复/ 第/ r/ 轮/ 1/ 个/ 等效/ 轮/ 密钥/ 字节/ ,/ 理想/ 情况/ 下/ ,/ 64/ 个/ 和/ 96/ 个/ 故障/ 可/ 分别/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ./ 由于/ 在/ 相同/ 字节/ 位置/ 连续/ 导入/ 两次/ 故障/ 方可/ 恢复/ 一个/ 等效/ 轮/ 密钥/ 字节/ ,/ 恢复/ 一轮/ 64/ 位/ 等效/ 轮/ 密钥/ 需/ 至少/ 注入/ 16/ 次/ 单字节/ 故障/ ,/ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ 需/ 注入/ 64/ 次/ 故障/ 获取/ 后/ 4/ 轮/ 等效/ 轮/ 密钥/ ,/ 恢复/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ 需/ 注入/ 96/ 次/ 故障/ 获取/ 后/ 6/ 轮/ 等效/ 轮/ 密钥/ ./ 对于/ 使用/ 和/ 不/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 该/ 故障/ 分析方法/ 均/ 适用/ ,/ 但/ 实际/ 情况/ 下/ ,/ 由于/ 注入/ 故障/ 字节/ 位置/ 的/ 随机性/ ,/ 应用/ 该/ 方法/ 比/ 理论/ 上/ 需要/ 更/ 多/ 的/ 故障注入/ 次数/ ./ 李玮/ 等/ [/ 19/ ]/ 也/ 对/ Camellia/ 进行/ 了/ 故障/ 分析/ ,/ 通过/ 在/ Camellia/ 第/ r/ -/ 1/ 轮/ P/ 混淆/ 层/ 前导/ 入/ 1/ 个/ 单字节/ 故障/ 恢复/ 第/ r/ 轮/ 多个/ 等效/ 轮/ 密钥/ 字节/ ,/ 通过/ 在/ Camellia/ 加密/ 倒数/ 2/ ~/ 7/ 轮/ 分别/ 注入/ 多次/ 单字节/ 故障/ ,/ 共/ 30/ 次/ 故障注入/ 可/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ./ 文献/ [/ 19/ ]/ 的/ 单字节/ 故障/ 模型/ 并/ 没有/ 涵盖/ 将/ 故障注入/ 到/ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ 这种/ 情况/ ,/ 如果/ 单字节/ 故障/ 被/ 注入/ 到/ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ 中/ ,/ 由于/ 第/ r/ 轮右/ 寄存器/ 中/ 存在/ 单字节/ 故障/ ,/ 其/ 分析方法/ 并/ 不/ 直接/ 适用/ ;/ 另外/ ,/ 其/ 认为/ 恢复/ Camellia/ -/ 128/ // 192/ // 256/ 均/ 需/ 获取/ 后/ 6/ 轮/ 等效/ 轮/ 密钥/ ,/ 对于/ 攻击/ 使用/ 了/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 由于/ 在/ 倒数第/ 7/ 轮/ 注入/ 的/ 故障/ 经过/ FL/ // FL/ -/ 1/ 混淆/ 层/ 传播/ 后/ 会/ 变得/ 十分/ 杂乱/ ,/ 其/ 分析方法/ 将会/ 失效/ ,/ 导致/ 无法/ 获取/ 倒数第/ 6/ 轮/ 等效/ 轮/ 密钥/ ,/ 因此/ 根据/ 其/ 论文/ 描述/ ,/ 其/ 攻击/ 仅/ 适用/ 于/ 没有/ 使用/ 了/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 而/ 在/ 实际/ 分析/ 中/ 我们/ 发现/ ,/ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ 仅/ 需/ 获取/ 最后/ 4/ 轮/ 等效/ 扩展/ 密钥/ 即可/ ,/ 这点/ 在/ 文献/ [/ 18/ ]/ 中/ 也/ 得到/ 认同/ ./ 1.2/ 本文/ 的/ 贡献/ 本文/ 对/ Camellia/ 抗/ 故障/ 攻击/ 安全性/ 也/ 进行/ 了/ 独立/ 的/ 研究/ 工作/ ,/ 初步/ 研究/ 结果/ 已/ 被/ 国际/ 密码/ 协会/ 在线/ 电子/ 读物/ eprint/ 收录/ 为/ 2009/ // 585/ 报告/ [/ 38/ ]/ ./ 同样/ 基于/ Camellia/ 第/ r/ -/ 1/ 轮/ P/ 混淆/ 层/ 前导/ 入/ 1/ 个/ 随/ Page3/ 机/ 单字节/ 故障/ 模型/ ,/ 本文/ 提出/ 了/ 一种/ 文献/ [/ 18/ ]/ 的/ Camellia/ 改进/ 差分/ 故障/ 分析方法/ ,/ 16/ 次/ 和/ 24/ 次/ 故障注入/ 即可/ 分别/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ,/ 降低/ 了/ 攻击/ 所/ 需/ 故障注入/ 次数/ ,/ 提高/ 了/ 密钥/ 分析/ 效率/ ./ 同/ 文献/ [/ 19/ ]/ 相比/ ,/ 本文/ 的/ 故障/ 模型/ 涵盖/ 了/ 其/ 故障/ 模型/ ,/ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ 是否/ 导入/ 单字节/ 故障/ 均/ 可/ ;/ 我们/ 将/ 所有/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 分析/ 归结为/ 求解/ S/ 盒/ 输入/ 差分/ 和/ 输出/ 差分/ 问题/ ,/ 攻击者/ 在/ 对/ 每轮/ 等效/ 轮/ 密钥/ 进行/ 分析/ 时/ ,/ 只/ 需/ 关注/ 求解/ 该轮/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 即可/ ,/ 简化/ 了/ 差分/ 故障/ 分析/ 的/ 过程/ ;/ 在/ 对/ Camellia/ 主/ 密钥/ 进行/ 分析/ 表/ 1/ 本文/ 方法/ 和/ 现有/ Camellia/ 故障/ 分析/ 工作/ 比较/ Camellia/ 密钥/ 长度/ 分析方法/ Camellia/ -/ 128Camellia/ -/ 128Camellia/ -/ 128Camellia/ -/ 192/ // 256/ 文献/ [/ 18/ ]/ 第/ 13/ ~/ 18/ 轮/ 左/ 寄存器/ Camellia/ -/ 192/ // 256/ 文献/ [/ 19/ ]/ 第/ 11/ ~/ 17/ 轮/ P/ 函数/ 输入/ (/ 左/ 寄存器/ 输入/ 无故障/ )/ Camellia/ -/ 192/ // 256/ 本文/ 4.4/ 节/ 第/ 11/ ~/ 17/ 轮/ P/ 函数/ 输入/ (/ 左/ 寄存器/ 有/ 无故障/ 均/ 可/ )/ ×/ Camellia/ -/ 192/ // 256/ 本文/ 4.4/ 节/ 第/ 12/ ~/ 17/ 轮/ P/ 函数/ 输入/ (/ 左/ 寄存器/ 有/ 无故障/ 均/ 可/ )/ / 1.3/ 结构/ 组织/ 本文/ 结构/ 组织/ 如下/ :/ 第/ 2/ 节/ 给出/ 故障/ 攻击/ 原理/ 和/ Camellia/ 算法/ 介绍/ ;/ 第/ 3/ 节/ 给出/ 通用/ 的/ 差分/ 故障/ 分析模型/ ;/ 第/ 4/ 节/ 提出/ 针对/ Camellia/ 的/ 改进/ 差分/ 故障/ 分析方法/ ,/ 对/ 攻击/ 复杂度/ 进行/ 理论/ 分析/ ,/ 并/ 通过/ 软件/ 仿真/ 实验/ 进行/ 验证/ ;/ 第/ 5/ 节/ 分析/ 传统/ 密码/ 设计/ 中/ 的/ 查找/ S/ 盒/ 操作/ 和/ 针对/ 密码/ 实现/ 物理/ 效应/ 的/ 攻击/ 之间/ 矛盾/ ,/ 并/ 讨论/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 攻击/ 可能/ 的/ 发展趋势/ ;/ 第/ 6/ 节为/ 结束语/ ./ 2/ 相关/ 知识/ 2.1/ 故障/ 攻击/ 故障/ 攻击/ 一般/ 由/ 故障/ 诱导/ (/ 也/ 称/ 故障/ 植入/ )/ 和/ 故障/ 分析/ 两/ 部分/ 组成/ ./ 故障/ 诱导/ 的/ 主要/ 工作/ 是/ 在/ 某个/ 合适/ 的/ 时间/ 将/ 故障注入/ 密码/ 运行/ 中/ 的/ 某/ 中间状态/ 位置/ ,/ 其/ 技术/ 实施/ 和/ 实际效果/ 严重/ 依赖于/ 攻击者/ 的/ 工作/ 环境/ 与/ 所/ 使用/ 的/ 设备/ ./ 常用/ 的/ 故障/ 诱导/ 条件/ 包括/ 电压/ 、/ 时钟/ 、/ 温度/ 、/ 辐射/ 、/ 强光/ 、/ 涡流/ 等/ 因素/ 的/ 突然/ 变化/ 等/ ./ 故障/ 分析/ 的/ 主要/ 内容/ 是/ 利用/ 错误/ 的/ 结果/ ,/ 使用/ 特定/ 的/ 分析方法/ 恢复/ 出/ 全部/ 或/ 部分/ 密钥/ 信息/ ./ 故障/ 分析/ 依赖于/ 密码/ 系统/ 设计/ 与/ 实现/ 、/ 密码/ 算法/ 规范/ 、/ 所/ 诱导/ 的/ 故障/ 类型/ ,/ 并且/ 在/ 大多数/ 条件/ 下/ ,/ 故障/ 分析/ 都/ 会同/ 传统/ 的/ 密码/ 分析方法/ 相结合/ ./ 典型/ 的/ 故障/ 分析方法/ 包括/ 差分/ 故障/ 分析/ (/ DifferentialFaultAnalysis/ ,/ 时/ ,/ 我们/ 认为/ ,/ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ 只/ 需/ 得到/ 最后/ 4/ 轮/ 等效/ 扩展/ 密钥/ 即可/ ,/ 并/ 给出/ 了/ 具体/ 的/ 主/ 密钥/ 恢复/ 算法/ ,/ 本文/ 的/ 故障/ 分析方法/ 直接/ 适用/ 于/ 攻击/ 使用/ 和/ 未/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ -/ 128/ 算法/ 以及/ 未/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ,/ 此外/ ,/ 本文/ 故障/ 模型/ 同/ 文献/ [/ 18/ ]/ 中/ 故障/ 模型/ 结合/ ,/ 也/ 可/ 适用/ 于/ 攻击/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ;/ 最后/ ,/ 结合/ Camellia/ 密码/ 差分/ S/ 盒/ 和/ P/ 函数/ 扩散/ 度/ 特性/ ,/ 对/ 攻击/ 复杂度/ 进行/ 了/ 分析/ ,/ 并/ 通过/ 仿真/ 实验/ 进行/ 了/ 验证/ ./ 本文/ 方法/ 和/ 现有/ Camellia/ 故障/ 分析/ 工作/ 比较/ 见表/ 1/ ./ 故障/ 位置/ DFA/ )/ [/ 6/ ]/ 、/ 碰撞/ 故障/ 分析/ (/ CollisionFaultAnalysis/ ,/ CFA/ )/ [/ 12/ ]/ 、/ 不/ 可能/ 故障/ 分析/ (/ ImpossibleFaultAnal/ -/ ysis/ ,/ IFA/ )/ [/ 29/ ]/ 、/ 浮动/ 故障/ 分析/ (/ FloatingFaultAnalysis/ ,/ FFA/ )/ [/ 30/ ]/ 等/ ./ 在/ 分组/ 密码/ 故障/ 分析/ 方面/ 常用/ 的/ 分析方法/ 是/ Biham/ 和/ Shamir/ 在/ 1997/ 年/ 提出/ 的/ 差分/ 故障/ 分析/ ,/ 分析/ 对象/ 主要/ 为/ S/ 盒/ 查表/ 操作/ ./ 本文/ 主要/ 对/ Camellia/ 分组/ 密码/ 差分/ 故障/ 分析方法/ 进行/ 研究/ ,/ 故障/ 诱导/ 的/ 问题/ 不是/ 本文/ 的/ 主要/ 研究/ 对象/ ,/ 其/ 在/ 很多/ 文献/ 中/ 都/ 有/ 讨论/ ,/ 如/ 文献/ [/ 39/ ]/ ,/ 本文/ 在/ 此/ 不再/ 赘述/ ./ 2.2/ Camellia/ 算法/ 对/ Camellia/ 算法/ 的/ 完整/ 介绍/ 可/ 参考文献/ [/ 32/ -/ 33/ ]/ ,/ 下面/ 仅/ 对/ 本文/ 中/ 用到/ 的/ Camellia/ 算法/ 特性/ 进行/ 描述/ ./ 加密/ 过程/ ./ Camellia/ 是/ 一个/ 迭代/ 型/ 分组/ 密码/ ,/ 分组/ 长度/ 为/ 128bits/ ,/ 支持/ 128/ ,/ 192/ 和/ 256bits3/ 种/ 规模/ 的/ 密钥/ 长度/ ,/ 采用/ Feistel/ 整体/ 结构/ ./ 为/ 提高/ 安全性/ ,/ 在/ 第一轮/ 前/ 和/ 最后/ 一轮/ 后/ 分别/ 做/ 前期/ 和/ 后期/ 白化/ ,/ 即子/ 密钥/ 加/ ,/ 同时/ 每隔/ 6/ 轮/ 增加/ 一个/ 不规则/ 轮/ ,/ 即/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ ./ 设/ Lr/ 和/ Rr/ 为/ 第/ r/ 轮/ 输入/ ,/ 则/ 轮/ 变换/ 可/ 表示/ 为/ 其中/ kr/ 为/ 第/ r/ 轮/ 的/ 子/ 密钥/ ,/ F/ =/ P/ / S/ 为/ 轮/ 函数/ ,/ S/ 和/ P/ 定义/ 如下/ :/ S/ :/ F64l1/ (/ 8/ )/ ‖/ l2/ (/ 8/ )/ ‖/ l3/ (/ 8/ )/ ‖/ l4/ (/ 8/ )/ ‖/ l5/ (/ 8/ )/ ‖/ l6/ (/ 8/ )/ ‖/ l7/ (/ 8/ )/ ‖/ l8/ (/ 8/ )/ →/ Page4l1/ (/ 8/ )/ ‖/ l2/ (/ 8/ )/ ‖/ l3/ (/ 8/ )/ ‖/ l4/ (/ 8/ )/ ‖/ l5/ (/ 8/ )/ ‖/ l6/ (/ 8/ )/ ‖/ l7/ (/ 8/ )/ ‖/ l8/ (/ 8/ )/ l1/ =/ s1/ (/ l1/ )/ ,/ l2/ =/ s2/ (/ l2/ )/ ,/ l3/ =/ s3/ (/ l3/ )/ ,/ l4/ =/ s4/ (/ l4/ )/ ,/ l5/ =/ s2/ (/ l5/ )/ ,/ l6/ =/ s3/ (/ l6/ )/ ,/ l7/ =/ s4/ (/ l7/ )/ ,/ l8/ =/ s1/ (/ l8/ )/ ./ P/ :/ F64z1/ (/ 8/ )/ ‖/ z2/ (/ 8/ )/ ‖/ z3/ (/ 8/ )/ ‖/ z4/ (/ 8/ )/ ‖/ z5/ (/ 8/ )/ ‖/ z6/ (/ 8/ )/ ‖/ z7/ (/ 8/ )/ ‖/ z8/ (/ 8/ )/ →/ z1/ (/ 8/ )/ ‖/ z2/ (/ 8/ )/ ‖/ z3/ (/ 8/ )/ ‖/ z4/ (/ 8/ )/ ‖/ z5/ (/ 8/ )/ ‖/ z6/ (/ 8/ )/ ‖/ z7/ (/ 8/ )/ ‖/ z8/ (/ 8/ )/ z1/ =/ z1/ / z3/ / z4/ / z6/ / z7/ / z8/ ,/ z2/ =/ z1/ / z2/ / z4/ / z5/ / z7/ / z8/ ,/ z3/ =/ z1/ / z2/ / z3/ / z5/ / z6/ / z8/ ,/ z4/ =/ z2/ / z3/ / z4/ / z5/ / z6/ / z7/ ,/ z5/ =/ z1/ / z2/ / z6/ / z7/ / z8/ ,/ z6/ =/ z2/ / z3/ / z5/ / z7/ / z8/ ,/ z7/ =/ z3/ / z4/ / z5/ / z6/ / z8/ ,/ z8/ =/ z1/ / z4/ / z5/ / z6/ / z7/ 密钥/ 扩展/ 算法/ ./ 首先/ 由/ 初始/ 种子/ 密钥/ 和/ 64/ 位/ 常量/ Σ/ i/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ 6/ )/ 经过/ 几个/ 轮/ 函数/ F/ 生成/ 4/ 个/ 128/ 位/ 变量/ KL/ 、/ KR/ 、/ KA/ 和/ KB/ ,/ KA/ 和/ KB/ 生成/ 过程/ 如图/ 1/ 所示/ ./ 白化/ 层子/ 密钥/ kwi/ (/ 64/ )/ 、/ 普通/ 轮/ 密钥/ ki/ (/ 64/ )/ 、/ FL/ // FL/ -/ 1/ 函数/ 层子/ 密钥/ kli/ (/ 64/ )/ 均/ 由/ KL/ 、/ KR/ 、/ KA/ 和/ KB/ 循环/ 移位/ 而成/ ,/ 详见/ 文献/ [/ 32/ -/ 33/ ]/ ./ 3/ 差分/ 故障/ 分析模型/ 为/ 增强/ 分组/ 密码/ 抗/ 线性/ 和/ 差分/ 分析/ 能力/ ,/ 现代/ 分组/ 密码/ 大都/ 使用/ S/ 盒/ 查表/ 操作/ 提高/ 密码/ 非线性/ 度/ ,/ 同时/ 使用/ S/ 盒/ 查找/ 表/ 访问/ Cache/ 又/ 可/ 提高/ 算法/ 软件/ 实现/ 执行/ 效率/ ,/ 但是/ 恰恰/ 是/ 由于/ 差分/ S/ 盒/ 的/ 分布/ 特性/ ,/ 导致/ 其/ 面临/ 严重/ 的/ 故障/ 攻击/ 威胁/ ./ 假如/ 在/ 分组/ 密码/ 查表/ 时/ ,/ 在/ 最后/ 一轮/ 对/ 未知/ 查表/ 输入/ 值/ a/ 导入/ 随机/ 字节/ 故障/ f/ ,/ 一般来说/ ,/ 攻击者/ 可/ 得到/ 密文/ 差分/ 字节/ f/ ,/ 且/ 满足/ 通过/ 一定/ 分析/ 可/ 获取/ 最后/ 一轮/ S/ 盒/ 输入/ 值/ a/ ,/ 该值/ 常同/ 扩展/ 密钥/ 紧密/ 相关/ ,/ 结合/ 密文/ 可/ 获取/ 相关/ 扩展/ 密钥/ ./ a/ 求解/ 方法/ 如下/ ,/ 假设/ a/ 为/ 一个/ 8/ 位/ 字节/ ,/ 根据/ f/ 值/ 是否/ 为/ 已知/ 可/ 将/ a/ 求解/ 问题/ 分为/ 下面/ 两种/ 情况/ :/ (/ 1/ )/ f/ 已知/ ./ 这种/ 情况/ 常/ 适用/ 于/ Feistel/ 结构/ 分组/ 密码/ 故障/ 分析/ ,/ 分析方法/ 比较简单/ ./ 以/ Camellia/ 最后/ 一轮/ 故障/ 攻击/ [/ 18/ ]/ 为例/ ,/ 在/ Camellia/ 加密/ 最后/ 一轮/ 左/ 寄存器/ Lr/ -/ 1/ 导入/ 单字节/ 故障/ f/ ,/ 故障/ 传播/ 如图/ 2/ 所示/ ./ 易见/ ,/ 通过/ 对/ 密文/ 差分/ 进行/ 分析/ 可/ 得到/ 最后/ 一轮/ 查找/ S/ 盒/ 的/ 输入/ 和/ 输出/ 差分/ ,/ 故障/ 位置/ 也/ 可/ 直观/ 得到/ ./ 将/ a/ (/ a/ =/ L0/ 式/ (/ 3/ )/ ,/ 满足/ 等式/ 的/ 值/ 作为/ a/ 的/ 有效/ 候选/ 值/ ,/ 由于/ S/ 盒/ 的/ 雪崩/ 性/ ,/ 对于/ 给定/ 的/ f/ 和/ f/ ,/ 一般/ 可/ 得到/ a/ 的/ 2/ ~/ 4/ 个/ 候选/ 值/ ./ 由于/ L0/ 半/ 部分/ C0L/ ./ 多次/ 导入/ 不同/ 索引/ 位置/ 故障/ 可/ 恢复/ 64/ 位密/ a/ / C0/ 钥/ kr/ / kw3/ ,/ 然后/ 通过/ 在/ 其它/ 轮/ 导入/ 故障/ ,/ 经/ 分析/ 得到/ 足够/ 的/ 相关/ 密钥/ 恢复/ 初始/ 主/ 密钥/ ./ (/ 2/ )/ f/ 未知/ ./ 这种/ 情况/ 常/ 适用/ 于/ SPN/ 结构/ 分组/ 密码/ 故障/ 分析/ ,/ 由于/ S/ 盒/ 输入/ 差分/ f/ 未知/ ,/ 分析方法/ 要/ 稍/ 显/ 复杂/ ./ 下面/ 给出/ 如何/ 利用/ 差分/ S/ 盒/ 分布/ 特性/ 求解/ 输入/ 差分/ f/ 的/ 方法/ ./ 以/ ARIA/ 为例/ ,/ 图/ 3/ 是/ ARIA/ 的/ S/ 盒/ 和/ 差分/ S/ 盒/ (/ Δ/ =/ 1/ )/ 按照/ 大小/ 值/ 递增/ 的/ 分布图/ ,/ 灰色/ 方块/ 表示/ 覆盖/ 到/ 的/ 值/ ,/ 白色/ 方块/ 表示/ 没有/ 覆盖/ 到/ Page5/ 的/ 值/ ,/ 易/ 见/ ,/ ARIAS/ 盒/ 覆盖/ 到/ 了/ 所有/ 256/ 个/ 候选/ 值/ ,/ 而/ 差分/ S/ 盒/ 没有/ 完全/ 覆盖/ ,/ 仅/ 有/ 127/ 个/ 左右/ ./ 如果/ 经/ 故障/ 导入/ 后/ 得到/ 的/ S/ 盒/ 输出/ 差分/ f/ 恰好/ 为/ 白图/ 3ARIAS/ 盒/ 和/ 差分/ S/ 盒值/ (/ Δ/ =/ 1/ )/ 按/ 大小/ 值/ 递增/ 分布/ 一般来说/ ,/ 在/ SPN/ 结构/ 分组/ 密码/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 前/ 注入/ 单字节/ 故障/ f/ ,/ 经/ P/ 变换/ f/ 可/ 扩散/ 至/ m/ 个/ 故障/ 字节/ (/ m/ >/ 1/ )/ ,/ 且/ 这/ m/ 个/ 字节/ 差分/ 均/ 和/ f/ 线性相关/ (/ 大部分/ 情况/ 这/ m/ 个/ 字节/ 差分/ 均/ 相同/ ,/ 如/ ARIA/ 分组/ 密码/ )/ ,/ 可用/ f/ 的/ 线性/ 函数/ Li/ (/ a/ ,/ f/ )/ 表示/ (/ 1/ / i/ / m/ )/ ,/ 再经/ 第/ r/ 轮/ 查找/ S/ 盒/ 运算/ 和/ 白化/ 操作/ ,/ 得到/ m/ 个/ 错误/ 密文/ 差分/ ,/ 通常/ 也/ 是/ 第/ r/ 轮/ 查找/ S/ 盒/ 输出/ 差分/ ./ 图/ 4/ 为/ ARIA/ 分组/ 密码/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 前/ 单字节/ 故障/ 传播/ 图/ ,/ 易见/ P/ 函数/ 线形/ 扩散/ 度/ m/ =/ 7/ ,/ 第/ r/ 轮/ S/ 盒/ 输入/ 差分/ f/ 共有/ 255/ 个/ (/ 非/ 0/ )/ ,/ 首先/ 为/ 每个/ 输入/ 差分/ f/ 利用/ Li/ (/ a/ ,/ f/ )/ / Li/ (/ a/ ,/ 0/ )/ 计算/ m/ 种/ 差分/ S/ 盒/ (/ 每个/ 差分/ S/ 盒/ 256/ 个/ 元素/ )/ ,/ 然后/ 检查/ 这/ m/ 个/ S/ 盒/ 输出/ 差分/ 是否/ 同时/ 位于/ 其/ 对应/ 的/ 差分/ S/ 盒中/ ,/ 只有/ 这/ m/ 个/ 输出/ 差分/ 均/ 同时/ 位于/ 其/ 对应/ 的/ 差分/ S/ 盒中/ ,/ f/ 值/ 保留/ ,/ 否则/ 可/ 排除/ 掉/ f/ ,/ 通过/ 255/ 次/ 迭代/ 分析/ 得到/ 有限/ 的/ f/ 候选/ 值/ ./ 一般来说/ ,/ 基于/ 差分/ S/ 盒/ 的/ 分布/ 特性/ ,/ 对于/ 扩散/ 度为/ m/ 的/ P/ 函数/ ,/ f/ 经/ 排除/ 分析/ 后/ 可/ 大约/ 得到/ 255/ ×/ 2/ -/ m/ 个/ 候选/ 值/ ./ 这样/ ,/ SPN/ 结构/ 分组/ 密码/ 的/ f/ 未知/ 故障/ 分析/ 问题/ 可/ 转化/ 为/ f/ 为/ 有限/ 解/ 的/ Feistel/ 结构/ 分组/ 密码/ 故障/ 分析/ 问题/ ,/ 经/ 分析/ 得到/ a/ 和/ S/ [/ a/ ]/ ,/ 显然/ 扩展/ 密钥/ kr/ 的/ m/ 个/ 字节/ 可/ 通过/ 分析/ S/ [/ a/ ]/ 和/ 密文/ 得到/ ./ 多次/ 导入/ 不同/ 位置/ 故障/ 可/ 恢复/ kr/ ,/ 然后/ 通过/ 在/ 其它/ 轮/ 导入/ 故障/ ,/ 经/ 分析/ 得到/ 足够/ 的/ 相关/ 密钥/ 恢复/ 初始/ 主/ 密钥/ ./ 色/ 方块/ 的/ 值/ ,/ 则/ 可以/ 断定/ 输入/ 差分/ 不为/ 1/ ,/ 这样/ 就/ 得到/ 了/ SPN/ 结构/ 下/ 利用/ 差分/ S/ 盒/ 分布/ 特性/ 求解/ 输入/ 差分/ f/ 的/ 一种/ 简便/ 方法/ ./ 我们/ 认为/ ,/ 对于/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 分析/ ,/ 可/ 抛开/ 密码/ 总体设计/ 结构/ ,/ 将/ 其/ 归结为/ 求解/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 的/ 问题/ ,/ 该/ 方法/ 有/ 如下/ 特点/ :/ (/ 1/ )/ 基于/ 不同/ 故障/ 模型/ 条件/ 下/ ,/ 通过/ 分析/ 分组/ 密码/ 故障/ 传播/ 过程/ ,/ 观察/ 某轮/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 是否/ 可/ 求解/ ,/ 可以/ 验证/ 对/ 该/ 分组/ 密码/ 故障/ 分析/ 的/ 可行性/ ./ (/ 2/ )/ 如果/ 可行/ ,/ 通过/ 结合/ 算法/ S/ 盒/ 和/ P/ 扩散/ 函数/ 特性/ 对/ S/ 盒/ 输入/ 、/ 输出/ 差分/ 个数/ 以及/ 单次/ 故障注入/ 可/ 恢复/ 密钥/ 字节/ 个数/ 进行/ 精确/ 分析/ ,/ 就/ 可以/ 得到/ 恢复/ 每轮/ 相关/ 扩展/ 密钥/ 所/ 需/ 的/ 故障注入/ 次数/ ;/ 然后/ 通过/ 分析/ 密钥/ 扩展/ 算法/ 得到/ 恢复/ 主/ 密钥/ 所/ 需/ 相关/ 扩展/ 密钥/ 的/ 轮数/ ,/ 最终/ 得到/ 恢复/ 主/ 密钥/ 所/ 需/ 的/ 理论/ 故障注入/ 次数/ ./ Page64Camellia/ 改进/ 差分/ 故障/ 分析/ 4.1/ 基本/ 假设/ 和/ 符号/ 标记/ 基本/ 假设/ :/ (/ 1/ )/ 攻击者/ 每次/ 诱导/ 中间/ 变量值/ 的/ 存储单元/ 发生/ 任意/ 单字节/ 错误/ ,/ 但/ 故障/ 字节/ 索引/ 和/ 故障/ 差分/ 未知/ ./ (/ 2/ )/ 对于/ 同一个/ 选定/ 明文/ P/ ,/ 攻击者/ 可/ 得到/ 在/ 同一个/ 密钥/ K/ 作用/ 下/ 的/ 正确/ 密文/ C/ 和/ 错误/ 密文/ C/ / ./ (/ 3/ )/ 攻击/ 所/ 需/ 的/ 满足/ 理想/ 故障/ 模型/ 下/ 的/ 错误/ 密文/ 样本/ 可/ 预先/ 得到/ ./ 如何/ 精确/ 地/ 注入/ 故障/ 不是/ 本文/ 的/ 研究/ 重点/ ,/ 本文/ 假定/ 攻击者/ 具备/ 从/ 大量/ 的/ 错误/ 密文/ 样本/ 中/ 找出/ 攻击/ 所/ 需/ 的/ 理想/ 错误/ 密文/ 样本/ 的/ 能力/ ./ (/ 4/ )/ 在/ 一次/ 成功/ 的/ 攻击/ 过程/ 中/ ,/ 加密/ 主/ 密钥/ 不变/ ./ 符号/ 标记/ :/ (/ 1/ )/ kr/ :/ 第/ r/ 轮/ 扩展/ 密钥/ ./ (/ 2/ )/ Kr/ :/ 表示/ 第/ r/ 轮/ 等效/ 扩展/ 密钥/ [/ 18/ ]/ ,/ 常为/ 后/ 白化/ 密钥/ 和/ 第/ r/ 轮/ 扩展/ 密钥/ 的/ 异或/ 结果/ ./ 对于/ Camellia/ -/ 128/ 来说/ ,/ K18/ =/ k18/ / kw3/ 、/ K17/ =/ k17/ / kw4/ 、/ K16/ =/ k16/ / kw3/ 、/ K15/ =/ k15/ / kw4/ ./ (/ 3/ )/ Lr/ -/ 1/ ,/ Rr/ -/ 1/ :/ 第/ r/ 轮/ 64/ 位/ 左半/ 部分/ 和/ 右半/ 部分/ 输入/ ./ (/ 4/ )/ Δ/ ILir/ ,/ Δ/ IRir/ :/ 第/ r/ 轮/ 左半/ 部分/ 和/ 右半/ 部分/ 输入/ 差分/ 第/ i/ 个/ 字节/ (/ i/ ∈/ [/ 0/ ,/ 7/ ]/ )/ ./ (/ 5/ )/ Δ/ OLri/ ,/ Δ/ ORri/ :/ 第/ r/ 轮/ 左半/ 部分/ 和/ 右半/ 部分/ 输出/ 差分/ 第/ i/ 个/ 字节/ (/ i/ ∈/ [/ 0/ ,/ 7/ ]/ )/ ./ (/ 6/ )/ Δ/ Sir/ ,/ Δ/ Pir/ :/ 第/ r/ 轮/ S/ 函数/ 和/ P/ 函数/ 的/ 输出/ 差分/ 第/ i/ 个/ 字节/ (/ i/ ∈/ [/ 0/ ,/ 7/ ]/ )/ ./ (/ 7/ )/ Δ/ CLi/ ,/ Δ/ CRi/ :/ 密文/ 左半/ 部分/ 和/ 右半/ 部分/ 差分/ 第/ i/ 个/ 字节/ (/ i/ ∈/ [/ 0/ ,/ 7/ ]/ )/ ./ 4.2/ 攻击/ 基本/ 思想/ 故障/ 模型/ ./ 本文/ 故障/ 模型/ 为/ 在/ Camellia/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 输入/ 前/ 注入/ 单字节/ 故障/ ,/ 故障/ 诱导/ 位置/ 分为/ A/ 、/ B/ 两种/ 类型/ :/ A/ 类型/ ./ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ Lr/ -/ 2/ 的/ 一个/ 字节/ 产生/ 故障/ ,/ 此时/ 第/ r/ 轮/ 的/ 左右/ 寄存器/ 均/ 产生/ 故障/ ;/ B/ 类型/ ./ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ Lr/ -/ 2/ 没有/ 故障/ ,/ 但/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 输入/ 产生/ 单字节/ 故障/ ,/ 故障/ 诱导/ 位置/ 有/ 3/ 种/ 可能/ :/ (/ 1/ )/ 对/ 第/ r/ -/ 1/ 轮/ 扩展/ 密钥/ kr/ -/ 1/ 进行/ 故障/ 诱导/ ;/ (/ 2/ )/ 对/ 第/ r/ -/ 1/ 轮/ Lr/ -/ 2/ 同/ kr/ -/ 1/ 异或/ 操作/ 进行/ 故障/ 诱导/ ;/ (/ 3/ )/ 对/ 第/ r/ -/ 1/ 轮/ 查找/ S/ 盒/ 输出/ 进行/ 故障/ 诱导/ ./ 故障/ 攻击/ 过程/ ./ 1/ ./ 对/ Camellia/ 第/ r/ -/ 1/ 轮/ 进行/ 故障/ 诱导/ ,/ 推断/ 第/ r/ 轮/ 等效/ 扩展/ 密钥/ Kr/ ./ (/ a/ )/ 选择/ 明文/ P/ ,/ 经/ 加密/ 获取/ 该/ 明文/ 对应/ 的/ 正确/ 密文/ C/ ./ (/ b/ )/ 选择/ 同样/ 的/ 明文/ P/ ,/ 在/ 加密/ 过程/ 中/ 对/ 第/ r/ -/ 1/ 轮/ 进行/ 单字节/ 故障/ 诱导/ ,/ 获取/ 错误/ 的/ 密文/ C/ / ./ (/ c/ )/ 使用/ 差分/ 故障/ 分析方法/ 推断/ Kr/ 的/ 5/ ~/ 6/ 个/ 密钥/ 字节/ ./ 出来/ ./ (/ d/ )/ 反复/ 执行/ 步骤/ (/ a/ )/ ~/ (/ c/ )/ ,/ 直至/ Kr/ 所有/ 字节/ 均/ 被/ 恢复/ 2/ ./ 对/ Camellia/ 第/ r/ -/ 2/ 轮/ 进行/ 故障/ 诱导/ ,/ 推断/ 第/ r/ -/ 1/ 轮/ 等效/ 扩展/ 密钥/ Kr/ -/ 1/ ./ (/ a/ )/ 选择/ 明文/ P/ ,/ 经/ 加密/ 获取/ 该/ 明文/ 对应/ 的/ 正确/ 密文/ C/ ./ (/ b/ )/ 选择/ 同样/ 的/ 明文/ P/ ,/ 在/ 加密/ 过程/ 中/ 对/ 第/ r/ -/ 2/ 轮/ 进行/ 单字节/ 故障/ 诱导/ ,/ 获取/ 错误/ 的/ 密文/ C/ / ./ (/ c/ )/ 使用/ 差分/ 故障/ 分析方法/ 推断/ Kr/ -/ 1/ 的/ 5/ ~/ 6/ 个/ 密钥/ 字节/ ./ 复/ 出来/ ./ (/ d/ )/ 反复/ 执行/ 步骤/ (/ a/ )/ ~/ (/ c/ )/ ,/ 直至/ Kr/ -/ 1/ 所有/ 字节/ 均/ 被/ 恢/ 3/ ./ 同样/ 的/ ,/ 使用/ 上述/ 相同/ 方法/ 对/ Camellia/ 加密/ 第/ r/ -/ 3/ 、/ r/ -/ 4/ 等/ 轮/ 进行/ 故障/ 诱导/ ,/ 推断/ Kr/ -/ 2/ ,/ Kr/ -/ 3/ 等/ 对应/ 轮/ 等效/ 扩展/ 密钥/ ./ 5/ ./ 对/ 预测/ 的/ Camellia/ 密钥/ 正确性/ 进行/ 验证/ ./ 4/ ./ 通过/ 对/ 最后/ 4/ 轮/ 等效/ 扩展/ 密钥/ Kr/ -/ 3/ ,/ Kr/ -/ 2/ ,/ Kr/ -/ 1/ ,/ Kr/ 进行/ 分析/ 推断/ Camellia/ -/ 128/ 密钥/ ,/ 通过/ 对/ 最后/ 6/ 轮/ 等效/ 扩展/ 密钥/ Kr/ -/ 5/ ,/ Kr/ -/ 4/ ,/ Kr/ -/ 3/ ,/ Kr/ -/ 2/ ,/ Kr/ -/ 1/ ,/ Kr/ 进行/ 分析/ 推断/ Camellia/ -/ 192/ // 256/ 密钥/ ./ 4.3/ Camellia/ -/ 128/ 改进/ 差分/ 故障/ 分析/ Camellia/ -/ 128/ 进行/ 故障/ 攻击/ 的/ 过程/ ./ 本节/ 将/ 介绍/ 根据/ 4.2/ 节/ 攻击/ 基本/ 思想/ 对/ 在/ 第/ 17/ 轮/ 注入/ 故障/ 恢复/ 犓/ 18/ 在/ Camellia/ -/ 128/ 第/ 17/ 轮/ P/ 函数/ 输入/ 值/ 注入/ 单字节/ 故障/ ,/ 以/ A/ 类型/ 第/ 17/ 轮/ 左/ 寄存器/ L16/ 故障/ 、/ B/ 类型/ 第/ 17/ 轮轮/ 密钥/ k17/ 故障/ 为例/ ,/ 假设/ 故障注入/ 索引/ 均/ 为/ 0/ ,/ 其/ 故障/ 传播/ 过程/ 分别/ 如图/ 5/ (/ a/ )/ 和/ 图/ 5/ (/ b/ )/ 所示/ ./ K18/ 的/ 具体/ 恢复/ 方法/ 如下/ :/ (/ 1/ )/ 确定/ 故障注入/ 索引/ 位置/ ./ 不同/ 索引/ 位置/ 的/ 第/ 17/ 轮/ P/ 函数/ 输入/ 故障/ 会/ 使得/ 密文/ 产生/ 不同/ 位置/ 的/ 故障/ ,/ 具体来说/ ,/ CL/ 会受/ 其/ 影响/ 产生/ 不同/ 位置/ 的/ 5/ ~/ 6/ 个/ 字节/ 故障/ ,/ 而/ CR/ 的/ 8/ 个/ 字节/ 均会/ 产生/ 故障/ ./ 第/ 17/ 轮/ P/ 函数/ 输入/ 不同/ 单字节/ 故障/ 索引/ 和/ CL/ 的/ 故障/ 字节/ 索引/ 关系/ 如表/ 2/ 所示/ ./ 可见/ 故障/ 索引/ 位置/ 为/ 0/ ~/ 3/ 时/ ,/ CL/ 均/ 产生/ 5/ 个/ 字节/ 故障/ ,/ 故障/ 索引/ 位置/ 为/ 4/ ~/ 7/ 时/ ,/ CL/ 均/ 产生/ 6/ 个/ 字节/ 故障/ ./ Page7/ 图/ 5Camellia/ 第/ 17/ 轮/ 故障/ 传播/ 图/ 第/ 17/ 轮/ P/ 函数/ 输入/ 故障/ 字节/ 索引/ CL/ 故障/ 字节/ 索引/ 5/ ~/ 6/ 个/ 故障/ 字节/ ./ (/ 2/ )/ 计算/ 第/ 18/ 轮/ S/ 盒/ 输入/ 差分/ Δ/ IL18/ ./ 显然/ ,/ Δ/ IL18/ 等于/ 密文/ 左半/ 部分/ 差分/ Δ/ CL/ ,/ 其有/ (/ 3/ )/ 计算/ 第/ 18/ 轮/ S/ 盒/ 输出/ 差分/ Δ/ S18/ ./ 第/ 18/ 轮/ 的/ 左半/ 部分/ 输出/ 差分/ Δ/ OL18/ 可/ 通过/ 密文/ 右半/ 部分/ 差分/ Δ/ CR/ 得到/ ./ 对于/ A/ 类型/ 故障/ 模型/ ,/ Δ/ OL18/ 的/ 8/ 个/ 非/ 0/ 字节/ 等于/ Δ/ S18/ 的/ 5/ ~/ 6/ 个/ 字节/ 经/ P/ 函数/ 变换/ 结果/ 同/ Δ/ IR18/ 的/ 1/ 个/ 字节/ 的/ 异或/ 结果/ 值/ ,/ Δ/ S18/ 可/ 表示/ 为/ Δ/ S18/ =/ P/ -/ 1/ (/ Δ/ OL18/ / Δ/ IR18/ )/ =/ P/ -/ 1/ (/ Δ/ CR/ / Δ/ IR18/ )/ Δ/ S18/ 可/ 由/ 下面/ 两种/ 方法/ 进行/ 恢复/ :/ 方法/ 1/ ./ 将/ Δ/ IR18/ 的/ 1/ 个/ 字节/ 所有/ 候选/ 值/ 代入/ 式/ (/ 4/ )/ 并/ 进行/ P/ -/ 1/ 变换/ ,/ 如果/ 得到/ 的/ Δ/ S18/ 值/ 的/ 非/ 0/ 索引/ 值和表/ 2/ 中/ 的/ Δ/ CL/ 对应/ 非/ 0/ 索引/ 值/ 相同/ ,/ 其它/ 2/ ~/ 3/ 个/ 索引/ 值均/ 为/ 0/ ,/ 则/ 可/ 求解/ 出/ Δ/ IR18/ 的/ 1/ 个/ 故障/ 字节/ 同/ Δ/ S18/ 的/ 5/ ~/ 6/ 个/ 故障/ 字节/ 值/ ,/ 实验/ 中/ 发现/ 只有/ 1/ 个/ Δ/ IR18/ 候选/ 值/ 满足/ 上述/ 条件/ ./ 方法/ 2/ ./ 通过/ 求解/ Δ/ OL18/ 的/ 8/ 个/ 方程/ ,/ 可/ 得到/ Δ/ S18/ 的/ 5/ ~/ 6/ 个/ 非/ 0/ 字节/ 和/ Δ/ IR18/ 的/ 1/ 个/ 非/ 0/ 字节/ 值/ ./ 例如/ 当/ 故障/ 索引/ 为/ 0/ 时/ ,/ Δ/ S0/ Δ/ S718/ ,/ Δ/ IL0/ Δ/ OL0/ Δ/ OL1/ Δ/ OL2/ Δ/ OL3/ Δ/ OL4/ Δ/ OL5/ Δ/ OL186/ =/ Δ/ S2/ Δ/ OL7Page818/ =/ Δ/ OL218/ =/ Δ/ OL518/ =/ Δ/ OL118/ =/ Δ/ OL118/ =/ Δ/ OL3/ Δ/ S0/ Δ/ S1/ Δ/ S2/ Δ/ S4/ Δ/ S7/ Δ/ IL0/ 方法/ 1/ 的/ 求解/ 过程/ 比较/ 通用/ ,/ 8/ 种/ 不同/ 位置/ 的/ 故障/ 分析/ 均/ 可/ 使用/ P/ -/ 1/ 函数/ 和/ Δ/ IR18/ 的/ 1/ 个/ 字节/ 有限/ 候选/ 值经/ 分析判断/ 得到/ ;/ 方法/ 2/ 则/ 需为/ 每种/ 位置/ 的/ 故障/ 分别/ 求解/ 8/ 个/ 方程/ ,/ 其本质/ 和/ 方法/ 1/ 相同/ ./ 对于/ B/ 类型/ 故障/ 模型/ ,/ 第/ 18/ 轮/ P/ 函数/ 输出/ 差分/ Δ/ P18/ =/ Δ/ OL18/ ,/ 由于/ 第/ 18/ 轮右/ 寄存器/ 没有/ 故障/ 导入/ ,/ Δ/ S18/ =/ P/ -/ 1/ (/ Δ/ CL/ )/ ,/ 求解/ 十分/ 简单/ ./ (/ 4/ )/ 恢复/ K18/ ./ 通过/ 步/ (/ 2/ )/ 和/ (/ 3/ )/ 分析/ 可/ 得到/ 第/ 18/ 轮/ S/ 盒/ 输入/ 差分/ Δ/ IL18/ 和/ 输出/ 差分/ Δ/ S18/ ,/ 应用/ 第/ 3/ 节/ Feistel/ 结构/ 分组/ 密码/ 故障/ 分析模型/ ,/ 可/ 恢复/ 第/ 18/ 轮/ 5/ ~/ 6/ 个/ S/ 盒/ 索引/ 字节/ Likiw3/ =/ Ciw3/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 4/ ,/ 7/ )/ 可/ 被/ 恢复/ 出来/ ./ 通过/ 多次/ 在/ kiCamellia/ -/ 128/ 第/ 17/ 轮/ P/ 函数/ 输入/ 值/ 其它/ 索引/ 位置/ 注入/ 单字节/ 故障/ ,/ 应用/ 上面/ 的/ 分析方法/ ,/ 可/ 获取/ K18/ 全部/ 字节/ 值/ ./ 在/ 第/ 16/ 轮/ 注入/ 故障/ 恢复/ 犓/ 17/ 在/ Camellia/ -/ 128/ 第/ 16/ 轮/ P/ 函数/ 输入/ 注入/ 单字节/ 故障/ ,/ 故障/ 索引/ 为/ 0/ ,/ A/ 类型/ 故障/ 传播/ 过程/ 如图/ 6/ 所示/ ./ K17/ 的/ 具体/ 恢复/ 方法/ 如下/ :/ (/ 1/ )/ 计算/ 第/ 17/ 轮/ 输出/ 差分/ Δ/ IL18/ 和/ Δ/ IR18/ ./ 第/ 17/ 轮/ 左半/ 部分/ 输出/ 差分/ Δ/ IL18/ 等于/ Δ/ CL/ ,/ 结合/ 前面/ 求解/ K18/ 和/ 密文/ ,/ 可/ 求解/ 第/ 17/ 轮/ 右半/ 部分/ 输出/ 差分/ Δ/ IR18/ ./ Δ/ IR18/ =/ Δ/ CR/ / P/ (/ S/ (/ L17/ / k18/ )/ )/ / P/ (/ S/ (/ L/ / 17/ / k18/ )/ )/ =/ Δ/ CR/ / P/ (/ S/ (/ CL/ / K18/ )/ )/ / P/ (/ S/ (/ C/ / L/ / K18/ )/ )/ (/ 2/ )/ 确定/ 故障注入/ 索引/ 位置/ ./ 显然/ ,/ 求解/ 出/ Δ/ IR18/ 值后/ ,/ 可/ 根据/ Δ/ IR18/ 非/ 0/ 字节/ 位置/ ,/ 并/ 参考/ 表/ 2/ 推断/ 第/ 16/ 轮/ P/ 函数/ 输入/ 故障/ 字节/ 索引/ ./ (/ 3/ )/ 计算/ 第/ 17/ 轮/ S/ 盒/ 输入/ 差分/ Δ/ IL17/ ./ 显然/ ,/ Δ/ IL17/ 等于/ 前面/ 求解/ 的/ Δ/ IR18/ ./ (/ 4/ )/ 计算/ 第/ 17/ 轮/ S/ 盒/ 输出/ 差分/ Δ/ S17/ ./ 第/ 17/ 轮/ 的/ 左半/ 部分/ 输出/ 差分/ Δ/ IL18/ 可/ 通过/ 密文/ 左半/ 部分/ 差分/ Δ/ CL/ 得到/ ./ 对于/ A/ 类型/ 故障/ 模型/ ,/ Δ/ IL18/ 的/ 8/ 个/ 非/ 0/ 字节/ 等于/ Δ/ S18/ 的/ 5/ ~/ 6/ 个/ 字节/ 经第/ 17/ 轮/ P/ 函数/ 变换/ 结果/ 同/ Δ/ IR17/ 的/ 1/ 个/ 字节/ 的/ 异或/ 结果/ 值/ ,/ Δ/ S17/ 可/ 表示/ 为/ Δ/ S17/ =/ P/ -/ 1/ (/ Δ/ IL18/ / Δ/ IR17/ )/ =/ P/ -/ 1/ (/ Δ/ CL/ / Δ/ IR17/ )/ 应用/ 前面/ 两种/ 方法/ 可/ 求解/ Δ/ S17/ 和/ Δ/ IR17/ ./ (/ 5/ )/ 恢复/ K17/ ./ 通过/ 步/ (/ 3/ )/ 和/ (/ 4/ )/ 分析/ 可/ 得到/ 第/ 17/ 轮/ S/ 盒/ 输入/ 差分/ Δ/ IL17/ 和/ 输出/ 差分/ Δ/ S17/ ,/ 应用/ 第/ 3/ 节/ Feistel/ 结构/ 分组/ 密码/ 故障/ 分析模型/ ,/ 可/ 恢复/ 第/ 17/ 轮/ 5/ ~/ 6/ 个/ S/ 盒/ 输入/ 索引/ 字节/ LiL16/ / P/ (/ S18/ )/ / kw4/ =/ CR/ ,/ S18/ =/ S/ [/ CL/ / K18/ ]/ ,/ CL/ 和/ K18/ 已知/ ,/ 则/ 5/ ~/ 6/ 个/ 密钥/ 字节/ Ki1/ ,/ 2/ ,/ 4/ ,/ 7/ )/ 可/ 被/ 恢复/ 出来/ ./ 多次/ 在/ Camellia/ -/ 128/ 第/ 16/ 轮/ P/ 函数/ 输入/ 其它/ 索引/ 位置/ 注入/ 故障/ ,/ 应用/ 上面/ 的/ 分析方法/ ,/ 可/ 获取/ K17/ 全部/ 字节/ 值/ ./ Page9/ 在/ 第/ 15/ 轮/ 注入/ 故障/ 恢复/ 犓/ 16/ ,/ 在/ 第/ 14/ 轮/ 注入/ 故障/ 恢复/ 犓/ 15/ 应用/ 前面/ 方法/ 通过/ 在/ 第/ 15/ 轮/ 注入/ 故障/ 恢复/ K16/ ,/ 在/ 第/ 14/ 轮/ 注入/ 故障/ 恢复/ K15/ ./ 分析/ 的/ 关键在于/ 利用/ 前面/ 密钥/ 分析/ 结果/ 去/ 计算/ 攻击/ 轮/ 的/ S/ 盒/ 输入/ 和/ 输出/ 差分/ ,/ 然后/ 结合/ 第/ 3/ 节/ 故障/ 分析模型/ 去/ 恢复/ 等效/ 轮/ 密钥/ ./ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ 通过/ 故障/ 分析/ 可/ 获取/ 最后/ 4/ 轮/ 等效/ 扩展/ 密钥/ K15/ ,/ K16/ ,/ K17/ ,/ K18/ ,/ 结合/ Camellia/ 算法/ 设计/ 文档/ ,/ 可/ 表示/ 为/ K18/ =/ (/ KA/ </ </ </ 111/ )/ L/ / (/ KL/ </ </ </ 111/ )/ RK17/ =/ (/ KA/ </ </ </ 111/ )/ R/ / (/ KL/ </ </ </ 111/ )/ LK16/ =/ (/ KA/ </ </ </ 111/ )/ L/ / (/ KA/ </ </ </ 94/ )/ RK15/ =/ (/ KA/ </ </ </ 111/ )/ R/ / (/ KA/ </ </ </ 94/ )/ K18/ ‖/ K17/ =/ (/ KA/ </ </ </ 111/ )/ / (/ KL/ </ </ </ 47/ )/ K16/ ‖/ K15/ =/ (/ KA/ </ </ </ 111/ )/ / (/ KA/ </ </ </ 30/ 烍/ 烌/ (/ K16/ ‖/ K15/ )/ </ </ </ 17/ =/ KA/ / (/ KA/ </ </ </ 47/ )/ KL/ =/ (/ (/ K18/ ‖/ K17/ )/ >/ >/ >/ 47/ )/ / (/ KA/ </ </ </ 64/ 烍/ 烌/ 根据/ 式/ (/ 8/ )/ 可/ 推断出/ 128/ 位/ 变量/ KA/ / (/ KA/ </ </ </ 47/ )/ ,/ 然后/ 根据/ 下面/ 算法/ 可/ 恢复/ KA/ ./ 犓/ 犃/ 恢复/ 算法/ ./ SearchingKA/ (/ SK/ ,/ C/ )/ unsignedcharKP/ [/ 128/ ]/ ,/ cTempSK/ ←/ / Foreachifrom0x00to0x01/ {/ KP/ [/ 0/ ]/ ←/ iForeachjfrom0to127/ {/ }/ 应用/ 上面/ 的/ 算法/ ,/ 最多/ 可/ 得到/ 2/ 个/ KA/ 候选/ 值/ ,/ 甚至/ 可/ 得到/ 唯一/ KA/ 值/ ,/ 结合/ 式/ (/ 8/ )/ 可/ 恢复/ 初始/ 主/ 密钥/ KL/ ./ 验证/ Camellia/ -/ 128/ 主/ 密钥/ 通过/ 对/ 相同/ 明文/ 利用/ 预测/ 密钥/ 加密/ ,/ 同/ 采集/ 的/ 正确/ 密文/ 比较/ 验证/ Camellia/ -/ 128/ 主/ 密钥/ KL/ 正确性/ ./ 4.4/ Camellia/ -/ 192/ // 256/ 改进/ 差分/ 故障/ 分析/ 恢复/ 犓/ 13/ ,/ 犓/ 14/ ,/ 犓/ 15/ ,/ 犓/ 16/ ,/ 犓/ 17/ ,/ 犓/ 18/ 对/ Camellia/ -/ 192/ // 256/ 的/ 改进/ 差分/ 故障/ 分析方法/ 同/ Camellia/ -/ 128/ 类似/ ./ 需要/ 说明/ 的/ 是/ ,/ 对于/ 攻击/ 没有/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ,/ 应用/ 4.3/ 节/ 方法/ 可/ 直接/ 恢复/ K13/ ,/ K14/ ,/ K15/ ,/ K16/ ,/ K17/ 值/ ./ 但是/ 对于/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ,/ 由于/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ 存在/ ,/ 在/ 第/ 12/ 轮/ 注入/ 单字节/ 故障/ 经/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 传播/ 到/ 第/ 13/ 轮时/ ,/ 故障/ 传播/ 变得/ 十分复杂/ ,/ 很难/ 进行/ 分析/ ,/ 因此/ 应用/ 4.3/ 节/ 方法/ 通过/ 在/ 第/ 13/ ~/ 17/ 轮/ 注入/ 单字节/ 故障/ ,/ 可/ 恢复/ K14/ ,/ K15/ ,/ K16/ ,/ K17/ ,/ K18/ 字节/ ,/ 同时/ 应用/ 第/ 3/ 节/ 在/ 第/ 13/ 轮/ 注入/ 单字节/ 故障/ 恢复/ 第/ 13/ 轮/ 单个/ 等效/ 轮/ 密钥/ 方法/ (/ 也/ 可/ 参考文献/ [/ 18/ ]/ 方法/ )/ 可/ 恢复/ K13/ 值/ ./ 恢复/ RetrievetheinitialCamellia/ -/ 192/ // 256key/ 结合/ Camellia/ 算法/ 设计/ 文档/ ,/ K13/ ,/ K14/ ,/ K15/ ,/ K16/ ,/ K17/ ,/ K18/ 可/ 表示/ 为/ K18/ =/ (/ KB/ </ </ </ 111/ )/ L/ / (/ KL/ </ </ </ 111/ )/ RK17/ =/ (/ KB/ </ </ </ 111/ )/ R/ / (/ KL/ </ </ </ 111/ )/ LK16/ =/ (/ KB/ </ </ </ 111/ )/ L/ / (/ KA/ </ </ </ 94/ )/ RK15/ =/ (/ KB/ </ </ </ 111/ )/ R/ / (/ KA/ </ </ </ 94/ )/ LK14/ =/ (/ KB/ </ </ </ 111/ )/ L/ / (/ KR/ </ </ </ 94/ )/ RK13/ =/ (/ KB/ </ </ </ 111/ )/ R/ / (/ KR/ </ </ </ 94/ )/ K18/ ‖/ K17/ =/ (/ KB/ </ </ </ 111/ )/ / (/ KL/ </ </ </ 47/ )/ K16/ ‖/ K15/ =/ (/ KB/ </ </ </ 111/ )/ / (/ KA/ </ </ </ 30/ )/ K14/ ‖/ K13/ =/ (/ KB/ </ </ </ 111/ )/ / (/ KR/ </ </ </ 30KA/ / KR/ =/ (/ (/ K16/ ‖/ K15/ )/ / (/ K14/ ‖/ K13/ )/ )/ >/ >/ >/ 30KB/ =/ F/ (/ F/ (/ (/ KA/ / KR/ )/ ,/ Σ/ 5/ (/ 64/ )/ )/ ,/ Σ/ 6/ (/ 64/ )/ )/ KL/ =/ (/ K18/ ‖/ K17/ )/ >/ >/ >/ 47/ / (/ KB/ </ </ </ 64/ 根据/ 式/ (/ 9/ )/ 可/ 直接/ 恢复/ KA/ / KR/ ,/ 由于/ KA/ / KR/ 和/ 常量/ Σ/ 5/ ,/ Σ/ 6/ 为/ 已知/ ,/ 根据/ Camellia/ -/ 192/ // 256/ 密钥/ 扩展/ 算法/ (/ 也/ 可/ 参考/ 图/ 1/ )/ ,/ 可/ 计算/ 出/ KB/ ,/ 然后/ 进一步/ 得到/ KL/ 和/ KR/ 值/ ,/ 最终/ 得到/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ./ 4.5/ 攻击/ 复杂度/ 分析/ 受/ 攻击者/ 能力/ 限制/ ,/ 精确/ 地/ 注入/ 故障/ 分析/ 所/ 需/ 的/ 理想/ 深度/ 和/ 宽度/ 的/ 故障/ 十分困难/ ,/ 所以/ 故障/ 攻击/ 所/ 需/ 样本量/ 下限/ 分析/ 显得/ 十分/ 重要/ ./ 下面/ ,/ 我们/ 将/ 对/ 本文/ 改进/ 故障/ 分析方法/ 攻击/ 复杂度/ 进行/ 分析/ :/ (/ 1/ )/ 单字节/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 密钥/ 分析/ 效率/ 分析/ 以/ 在/ Camellia/ -/ 128/ 最后/ 一轮/ 注入/ 单字节/ 故障/ 为例/ ,/ 如图/ 2/ 所示/ ,/ 故障/ 分析/ 需/ 满足/ 下/ 式/ :/ Page1017/ / k0S/ [/ L0L017/ / k0w3/ =/ C0k018/ / k0S/ [/ C0/ / K0/ 结合/ S0/ 盒/ 特性/ ,/ 将/ C0/ ,/ Δ/ IL0/ 所有/ 候选/ 值/ 代入/ 式/ (/ 10/ )/ ,/ 可/ 得/ 满足/ 上式/ 的/ K0/ 计/ 分析/ 表/ ,/ 如表/ 3/ 所示/ ./ Camellia/ 算法/ 使用/ 了/ S0/ ,/ S1/ ,/ S2/ ,/ S34/ 种/ S/ 盒/ ,/ 其它/ 3/ 种/ S/ 盒/ 的/ 故障/ 分析/ 效率/ 同/ S0/ 盒/ 相同/ ./ 可见/ ,/ 单个/ S/ 盒/ 字节/ 经/ 1/ 次/ 故障/ 分析/ 可/ 将/ K0/ 个/ ,/ 两次/ 故障注入/ 即/ 可以/ 高达/ 98.8/ %/ 的/ 概率/ 恢复/ 唯一/ 的/ K0k/ 数目/ 出现/ 次数/ 出现/ 概率/ 2164505600.98441/ ./ 96884/ 总数/ 167116801/ (/ 2/ )/ 第/ 4/ 节/ 改进/ 差分/ 故障/ 攻击/ 密钥/ 恢复/ 效率/ 分析/ 第/ r/ -/ 1/ 轮/ 注入/ 单字节/ 故障/ 索引/ i/ 和/ 恢复/ 的/ 第/ r/ 轮/ 等效/ 扩展/ 密钥/ Kr/ 字节/ 索引/ 值/ j/ 的/ 关系/ 如式/ (/ 11/ )/ 所示/ ,/ Mij/ =/ 1/ 表示/ i/ 对应/ 的/ Kr/ 第/ j/ 个/ 字节/ 可/ 被/ 恢复/ 出来/ ./ 易见/ ,/ i/ ∈/ [/ 0/ ,/ 3/ ]/ 时/ ,/ 一次/ 可/ 恢复/ 5/ 个/ Kr/ 字节/ ,/ i/ ∈/ [/ 4/ ,/ 7/ ]/ 时/ ,/ 一次/ 可/ 恢复/ 6/ 个/ Kr/ 字节/ ,/ 至少/ 3/ 次/ 故障注入/ 可/ 对/ Kr/ 的/ 8/ 个/ 字节/ 均/ 分析/ 两次/ ,/ 则/ 可以/ 说/ ,/ 至少/ 3/ 次/ 故障/ 可/ 恢复/ 一轮/ 等效/ 扩展/ 密钥/ ./ 在/ 对/ S/ 盒/ 同一/ 索引/ 字节/ 位置/ 故障/ 进行/ 两次/ 分析/ 可/ 获取/ 1/ 个/ 字节/ 的/ S/ 盒/ 输入/ 索引/ 前提条件/ 下/ ,/ 将/ 故障注入/ 次数/ n/ 和/ 故障注入/ 索引/ 所有/ 可能/ 值/ 利用/ 式/ (/ 10/ )/ 进行/ 穷举/ 统计分析/ ,/ 可/ 得到/ 故障注入/ 次数/ 和/ 直接/ 恢复/ Kr/ 的/ 成功率/ 统计/ ,/ 见表/ 4/ ./ 表/ 4/ 故障注入/ 次数/ 和/ 直接/ 恢复/ 犓/ 狉/ 成功率/ 的/ 关系/ 故障注入/ 次数/ n/ 成功/ 次数/ 所有/ 次数/ 成功率/ // %/ 345678163783761677721697.62/ 将/ 故障注入/ 次数/ 、/ 故障注入/ 索引/ 所有/ 可能/ 值/ 、/ 表/ 3/ 中/ 单字节/ 故障/ 密钥/ 分析/ 效率/ 统计/ 值/ 利用/ 式/ (/ 10/ )/ 进行/ 穷举/ 统计分析/ ,/ 可/ 得到/ 故障注入/ 次数/ n/ 和/ Kr/ 平均/ 搜索/ 空间/ 的/ 成功率/ 统计/ ,/ 见表/ 5/ ./ 可见/ ,/ 如果/ n/ 次/ 故障/ 索引/ 均/ 不/ 重复/ ,/ 4/ 次/ 故障注入/ 理论/ 上/ 即可/ 将/ Kr/ 平均/ 密钥/ 搜索/ 空间/ 降低/ 到/ 25.446/ ./ 表/ 5/ 故障注入/ 次数/ 犿/ 和/ 犓/ 狉/ 平均/ 密钥/ 搜索/ 空间/ 的/ 关系/ 故障注入/ 次数/ n3504178/ ./ 07512131759.97456720971442/ ./ 24209715233.428167772081/ ./ 11167772164.4854/ ./ 6/ 实验/ 结果/ 比较/ 与/ 分析/ 在/ 普通/ PC机/ (/ CPU/ 为/ Athlon643000/ +/ 1.81/ GHz/ ,/ 内存/ 为/ 1GB/ )/ 上/ 使用/ C++/ 语言/ 编程/ 实现/ 了/ 本文/ 给出/ 的/ Camellia/ 故障/ 攻击/ ,/ 其中/ 故障/ 诱导/ 过程/ 是/ 通过/ 计算机软件/ 模拟/ 的/ ./ Camellia/ -/ 128/ 故障/ 攻击/ 的/ 一组/ 数据/ 见/ 附录/ A/ ./ 首先/ 给出/ 在/ Camellia/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 输入/ 值/ 注入/ 单字节/ 故障/ 恢复/ Kr/ 的/ 实际/ 数据/ 统计/ ,/ 图/ 7/ 为/ 5/ 万次/ 故障/ 攻击/ 中/ 不同/ 故障注入/ 次数/ n/ 的/ Kr/ 平均/ 密钥/ 搜索/ 空间/ 统计/ ,/ 可以/ 看出/ ,/ 该/ 实际/ 攻击/ 值同表/ 5/ 理论值/ 基本一致/ ./ 图/ 7/ 不同/ 故障注入/ 次数/ 时/ Kr/ 平均/ 密钥/ 搜索/ 空间/ 统计图/ 8/ 为/ 5/ 万次/ 故障/ 攻击/ 中/ 不同/ 故障注入/ 次数/ n/ 对应/ 的/ K18/ 平均/ 密钥/ 空间频率/ 统计/ ,/ 可以/ 看出/ ,/ 实际/ 攻击/ 中/ K18/ 候选/ 值为/ 1/ 的/ 出现/ 频率/ 和表/ 4/ 基本一致/ ,/ 当/ n/ / 4/ 时/ ,/ K18/ 密钥/ 候选/ 值/ 个数/ 大部分/ 情况/ 下均/ 在/ 8/ 个/ 以内/ ./ 图/ 9/ 为/ 5/ 万次/ 故障/ 攻击/ 中/ 对/ 直接/ 成功/ 恢复/ Kr/ 所需/ 故障注入/ 次数/ 出现/ 的/ 频率/ 统计/ ,/ 可以/ 看出/ 当/ n/ / 4/ 时/ ,/ 就/ 能/ 以/ 34.6/ %/ 的/ 概率/ 直接/ 恢复/ Kr/ ./ 攻击/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ 所/ 需/ 样本量/ 如/ 前面/ 表/ 1/ 所示/ ./ 对于/ 攻击/ 使用/ 和/ 没有/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ Camellia/ -/ 128Page11/ 图/ 8/ 不同/ 故障注入/ 次数/ 时/ Kr/ 平均/ 密钥/ 空间/ 出现/ 频率/ 统计图/ 9/ 成功/ 恢复/ Kr/ 所需/ 故障注入/ 次数/ 出现/ 频率/ 统计算法/ ,/ 在/ 第/ 14/ ~/ 17/ 轮/ 每轮/ 注入/ 4/ 次/ 单字节/ 故障/ 共/ 16/ 次/ 故障注入/ ,/ 应用/ 4.3/ 节/ 方法/ 即可/ 恢复/ 128/ 位主/ 密钥/ ./ 对于/ 攻击/ 没有/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ,/ 在/ 第/ 12/ ~/ 17/ 轮/ 每轮/ 注入/ 4/ 次/ 单字节/ 故障/ 共/ 24/ 次/ 故障注入/ ,/ 应用/ 4.4/ 节/ 方法/ 即可/ 恢复/ Camellia/ -/ 192/ // 256/ 主/ 密钥/ ;/ 但是/ 对于/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ Camellia/ -/ 192/ // 256/ 算法/ ,/ 由于/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 的/ 存在/ ,/ 在/ 第/ 12/ 轮/ 注入/ 单字节/ 故障/ 经/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ 传播/ 到/ 第/ 13/ 轮时/ ,/ 故障/ 传播/ 变得/ 十分复杂/ ,/ 很难/ 进行/ 分析/ ,/ 因此/ 应用/ 4.3/ 节/ 方法/ 通过/ 在/ 第/ 13/ ~/ 17/ 轮/ 分别/ 注入/ 4/ 次/ 单字节/ 故障/ ,/ 可/ 基本/ 恢复/ 后/ 5/ 轮/ 扩展/ 密钥/ 字节/ ,/ 同时/ 在/ 第/ 13/ 轮/ 注入/ 12/ 次/ 单字节/ 故障/ ,/ 应用/ 第/ 3/ 节/ 方法/ 可/ 恢复/ K13/ 值/ ./ 同/ 现有/ 故障/ 攻击/ 相比/ ,/ 本文/ 方法/ 具有/ 以下/ 特点/ :/ (/ 1/ )/ 同/ 文献/ [/ 18/ ]/ 和/ 文献/ [/ 19/ ]/ 相比/ ,/ 本文/ 故障/ 模型/ 中/ 故障/ 宽度/ 同其/ 相同/ ,/ 均/ 基于/ 单字节/ 故障/ 模型/ ,/ 故障/ 索引/ 位置/ 和/ 故障/ 值/ 未知/ ./ (/ 2/ )/ 同/ 文献/ [/ 18/ ]/ 在/ 第/ r/ 轮/ 左/ 寄存器/ 注入/ 单字节/ 故障/ 恢复/ Kr/ 的/ 1/ 个/ 字节/ 不同/ ,/ 本文/ 的/ 故障注入/ 位置/ 比/ 文献/ [/ 18/ ]/ 要/ 深/ ,/ 单次/ 故障注入/ 恢复/ 的/ 密钥/ 字节数/ 要/ 多/ ,/ 1/ 次第/ r/ -/ 1/ 轮/ 单字节/ 故障/ 分析/ 可/ 恢复/ Kr/ 的/ 5/ ~/ 6/ 个/ 密钥/ 字节/ ,/ 将/ 文献/ [/ 18/ ]/ 密钥/ 分析/ 效率/ 提高/ 了/ 5/ ~/ 6/ 倍/ ./ 此外/ ,/ 本文/ 故障/ 攻击/ 模型/ 比/ 文献/ [/ 18/ ]/ 要广/ ,/ 可/ 适用/ 于/ 对/ 第/ r/ -/ 1/ 轮/ 扩展/ 密钥/ 进行/ 故障/ 攻击/ 等/ 情况/ ,/ 而/ 文献/ [/ 18/ ]/ 方法/ 仅/ 适用/ 于/ 对/ 第/ r/ 轮/ 左/ 寄存器/ 故障/ 进行/ 密钥/ 分析/ ,/ 并/ 不适/ 用于/ 对/ 第/ r/ 轮/ 扩展/ 密钥/ 注入/ 故障/ 等/ 情况/ 进行/ 密钥/ 分析/ (/ 第/ r/ 轮/ S/ 盒/ 输入/ 差分/ 无法/ 求解/ )/ ./ (/ 3/ )/ 本文/ 故障/ 模型/ 深度/ 同/ 文献/ [/ 19/ ]/ 相同/ ,/ 但/ 故障/ 位置/ 适用范围/ 要广/ ,/ 文献/ [/ 19/ ]/ 中/ 故障/ 模型/ 并/ 没有/ 涵盖/ 将/ 故障注入/ 到/ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ 这种/ 情况/ ,/ 如果/ 单字节/ 故障/ 被/ 注入/ 到/ 第/ r/ -/ 1/ 轮/ 左/ 寄存器/ 中/ ,/ 由于/ 第/ r/ 轮右/ 寄存器/ 中/ 存在/ 单字节/ 故障/ ,/ 其/ 分析方法/ 并/ 不/ 直接/ 适用/ ,/ 而/ 本文/ 故障/ 模型/ 则/ 涵盖/ 了/ 在/ Camellia/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 输入/ 注入/ 故障/ 的/ 所有/ 情况/ ;/ 另外/ ,/ 文献/ [/ 19/ ]/ 认为/ 恢复/ Camellia/ -/ 128/ // 192/ // 256/ 均/ 需/ 获取/ 后/ 6/ 轮/ 等效/ 轮/ 密钥/ ,/ 对于/ 攻击/ 使用/ 了/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 由于/ 在/ 倒数第/ 7/ 轮/ 注入/ 的/ 故障/ 经过/ FL/ // FL/ -/ 1/ 混淆/ 层/ 传播/ 后/ 会/ 变得/ 十分/ 杂乱/ ,/ 其/ 分析方法/ 将会/ 失效/ ,/ 导致/ 无法/ 获取/ 倒数第/ 6/ 轮/ 等效/ 轮/ 密钥/ ,/ 因此/ 根据/ 其/ 论文/ 描述/ ,/ 攻击/ 仅/ 适用/ 于/ 没有/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 而/ 本文/ 故障/ 分析/ 研究/ 则/ 表明/ ,/ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ 仅/ 需/ 获取/ 最后/ 4/ 轮/ 等效/ 扩展/ 密钥/ 即可/ ,/ 并/ 给出/ 了/ 具体/ 的/ Camellia/ -/ 128/ 主/ 密钥/ 恢复/ 算法/ ,/ 这点/ 在/ 文献/ [/ 18/ ]/ 中/ 也/ 得到/ 认同/ ./ 5/ 攻击/ 讨论/ 5.1/ 传统/ 密码/ 查找/ S/ 盒/ 设计/ 和/ 实现/ 攻击/ 之间/ 矛盾/ 的/ 分析/ 在/ 分组/ 密码/ 设计/ 中/ ,/ 密码/ 设计者/ 常/ 使用/ S/ 盒来/ 增加/ 算法/ 非线性/ 度/ ,/ 并/ 以此/ 来/ 抵御/ 差分/ 和/ 线性/ 密码/ 分析/ ./ S/ 盒/ 对于/ 防御/ 传统/ 的/ 差分/ 和/ 线性/ 分析/ 确实/ 十分/ 有效/ ,/ 但/ 当/ 考虑/ 到/ 密码/ 算法/ 实现/ 主动/ 和/ 被动/ 泄漏/ 的/ 物理/ 效应/ 信息/ 时/ ,/ 其/ 面临/ 了/ 前所未有/ 的/ 挑战/ ,/ S/ 盒/ 往往/ 成为/ 密码/ 系统/ 破解/ 被/ 突破/ 的/ 第一道/ 防线/ ./ 通常/ 来说/ ,/ S/ 盒/ 输入/ 索引/ 常/ 和/ 明文/ // 密文/ 、/ 相关/ 密钥/ 、/ 物理/ 效应/ 紧密/ 相关/ ,/ 在/ 采集/ 到/ 这些/ 物理/ 效应/ 信息/ 后/ ,/ 结合/ 明文/ // 密文/ 信息/ 和/ 各种/ 分析方法/ ,/ 即可/ 快速/ 恢复/ 相关/ 密钥/ 信息/ ./ 下面/ ,/ 我们/ 将/ 讨论/ 利用/ 物理/ 效应/ 信息/ 和/ S/ 盒/ 进行/ 分组/ 密钥/ 破解/ 的/ 典型/ 攻击/ ./ (/ 1/ )/ Cache/ 计时/ 攻击/ 大量/ 的/ 分组/ 密码/ 设计/ 采用/ S/ 盒/ 查表/ 访问/ Cache/ 提高/ 软件/ 实现/ 效率/ ,/ 但是/ Cache/ 访问/ 命中/ 和/ 失效/ 时间/ 差异/ 信息/ 却/ 恰恰/ 构成/ 了/ 天然/ 的/ Cache/ 信息/ 泄露/ 源/ ,/ 而/ 操作系统/ 多线程/ 共享/ Cache/ 机制/ 又/ 为/ 恶意/ 线程/ 监视/ 密码/ 线程/ Cache/ 访问信息/ 搭建/ 了/ 时间/ 信息/ 泄露/ 隐/ 通道/ ./ 根据/ 攻击者/ 采集/ 的/ 时间/ 信息/ 不同/ ,/ 通常/ 将/ Page12/ 针对/ 分组/ 密码/ 的/ Cache/ 计时/ 攻击/ 分为/ 时序/ 驱动/ 、/ 访问/ 驱动/ 、/ 踪迹/ 驱动/ 3/ 种/ ./ 在/ 时序/ 驱动/ 攻击/ 中/ ,/ 攻击者/ 主要/ 采集/ 一次/ 完整/ 的/ 加密/ 时间/ ,/ 使用/ 大量/ 的/ 样本/ 来/ 推断/ 某次/ 查找/ 表/ 是否/ 发生/ Cache/ 命中/ ,/ 并/ 利用/ 这些/ 碰撞/ 信息/ 结合/ 明文/ 或/ 密文/ 信息/ 预测/ 密钥/ ;/ 在/ 访问/ 驱动/ 攻击/ 中/ ,/ 攻击者/ 常/ 使用/ 一个/ 恶意/ 进程/ 在/ 加密/ 前/ 清空/ 数据/ Cache/ ,/ 然后/ 触发/ 加密/ 操作/ ,/ 之后/ 通过/ 对/ 其/ 私有/ 数据/ 访问/ 的/ 命中/ 和/ 失效/ 信息/ 推断/ 加密/ 过程/ 中/ 查找/ S/ 盒/ 访问/ 的/ Cache/ 组/ 地址/ 信息/ ,/ 并/ 转化/ 为/ 查表/ 索引/ 信息/ ,/ 结合/ 明文/ 或/ 密文/ 信息/ 预测/ 密钥/ ;/ 在/ 踪迹/ 驱动/ 攻击/ 中/ ,/ 攻击者/ 能够/ 采集/ 到/ 每次/ 查找/ S/ 盒/ 访问/ Cache/ 的/ 命中/ 和/ 失效/ 序列/ 信息/ ,/ 并/ 结合/ 明文/ 或/ 密文/ 信息/ 预测/ 密钥/ ./ (/ 2/ )/ 差分/ 旁路/ 攻击/ 在/ 差分/ 旁路/ 攻击/ 中/ ,/ 攻击者/ 首先/ 通过/ 示波器/ 、/ 接收机/ 等/ 设备/ 采集/ 到/ 加密/ 过程/ 中/ 泄露/ 的/ 功耗/ 和/ 电磁/ 信息/ ,/ 然后/ 将/ 密钥/ 搜索/ 空间/ 分成/ 多个/ 子/ 密钥/ 块/ ,/ 将/ 每个/ 子/ 密钥/ 块/ 的/ 候选/ 值同/ 明文/ 或/ 密文/ 信息/ 结合/ ,/ 预测/ 可能/ 的/ 查表/ Hamming/ 重量/ 或/ Hamming/ 距离/ ,/ 并/ 和/ 真实/ 的/ 功耗/ 或/ 电磁/ 曲线/ 中/ 的/ 每个/ 点/ 进行/ 相关性/ 匹配/ ,/ 对于/ 正确/ 的/ 密钥/ 候选/ 值/ 来说/ ,/ 每条/ 匹配/ 曲线/ 中常会/ 出现/ 尖峰/ ,/ 否则/ 匹配/ 曲线/ 将会/ 比较/ 平坦/ ./ 这样/ ,/ S/ 盒/ 查表/ 操作/ 的/ 非线性/ 特性/ 恰好/ 构成/ 了/ 差分/ 旁路/ 分析/ 中/ 的/ 天然/ 区分/ 器/ ./ (/ 3/ )/ 模板/ 攻击/ 在/ 模板/ 攻击/ 中/ ,/ 攻击者/ 首先/ 使用/ 已/ 控制/ 的/ 密码/ 设备/ ,/ 利用/ 其/ 加密/ 过程/ 中/ 泄露/ 的/ 信号/ 信息/ 为/ 每个/ 子/ 密钥/ 块/ 的/ 所有/ 候选/ 值/ 构建/ 一个/ 唯一/ 的/ 区分/ 器/ ,/ 搭建/ 好/ 模板/ ;/ 然后/ 采集/ 到/ 目标/ 密钥/ 设备/ 加密/ 过程/ 中/ 泄露/ 的/ 信号/ 信息/ ,/ 并/ 和/ 前面/ 搭建/ 的/ 模板/ 进行/ 相关性/ 匹配/ ,/ 最/ 匹配/ 的/ 模板/ 对应/ 的/ 密钥/ 候选/ 值常为/ 正确/ 密钥/ ./ 同样/ ,/ S/ 盒/ 查表/ 操作/ 的/ 非线性/ 特性/ 也/ 恰好/ 构成/ 了/ 模板/ 攻击/ 中/ 的/ 天然/ 区分/ 器/ ./ (/ 4/ )/ 差分/ 故障/ 攻击/ 根据/ 本文/ 第/ 3/ 节/ 分析/ 可以/ 发现/ ,/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 分析/ 的/ 主要/ 研究/ 对象/ 就是/ S/ 盒/ 查表/ 操作/ ./ 只要/ 在/ 故障注入/ 后/ ,/ 某轮/ S/ 盒/ 的/ 输入/ 和/ 输出/ 差分/ 是/ 已知/ 或/ 为/ 有限/ 值/ 的/ ,/ 攻击者/ 就/ 可/ 恢复/ S/ 盒/ 输入/ 索引/ 或/ 查表/ 结果/ ,/ 并/ 用于/ 相关/ 密钥/ 破解/ ./ 由于/ S/ 盒/ 可/ 提供/ 很/ 好/ 的/ 非线性/ 度/ ,/ 对于/ 256/ 个/ 元素/ 的/ 差分/ S/ 盒/ 来说/ ,/ 差分/ S/ 盒/ 的/ 元素/ 不能/ 覆盖/ 到/ 所有/ 的/ 256/ 个/ 候选/ 值/ ,/ 对于/ SPN/ 分组/ 密码/ ,/ 一旦/ 攻击者/ 根据/ 密文/ 差分/ 获取/ 到/ 最后/ 一轮/ 查表/ 的/ 输出/ 差分/ ,/ 并/ 检查/ 这些/ 差/ 分值/ 是否/ 位于/ 某个/ 差分/ S/ 盒中/ ,/ 如果/ 不/ 在/ 则/ 可/ 排除/ 掉/ 其/ 对应/ 的/ 输入/ 差分/ ,/ 这样/ 可以/ 得到/ 有限/ 的/ S/ 盒/ 输入/ 差/ 分值/ 用于/ 相关/ 密钥/ 破解/ ;/ 即使/ 差分/ S/ 盒/ 的/ 分布/ 特性/ 是/ 完美/ 的/ ,/ 即/ 覆盖/ 到/ 所有/ 的/ 256/ 个/ 候选/ 值/ ,/ 对于/ 攻击/ Feistel/ 结构/ 分组/ 密码/ ,/ 攻击者/ 常可/ 得到/ 唯一/ 的/ S/ 盒/ 输入/ 和/ 输出/ 差分/ ,/ 那么/ 此时/ 可能/ 直接/ 就/ 可/ 获取/ 到/ 唯一/ 的/ 相关/ 密钥/ 值/ ./ 综上/ ,/ 我们/ 不难/ 发现/ ,/ S/ 盒/ 的/ 非线性/ 度/ 已经/ 成为/ 针对/ 密码/ 实现/ 物理/ 效应/ 攻击/ 中/ 的/ 天然/ 区分/ 器/ ,/ 传统/ 的/ 密码/ 设计/ 和/ 针对/ 密码/ 实现/ 的/ 攻击/ 确实/ 存在/ 较大/ 的/ 矛盾/ ,/ 通过/ 掩码/ 、/ 噪声/ 随机化/ 、/ 多次/ 校验/ 等/ 方法/ 能够/ 在/ 一定/ 程度/ 上/ 防御/ 密码/ 实现/ 攻击/ ,/ 但/ 所有/ 的/ 防御/ 措施/ 都/ 是/ 要/ 以/ 牺牲/ 加密/ 速度/ 为/ 代价/ 的/ ,/ 所以/ 如何/ 在/ 速度/ 和/ 安全性/ 这/ 一对/ 矛盾/ 的/ 指标/ 上/ 进行/ 平衡/ 选择/ 也/ 是/ 目前/ 密码/ 实现/ 所/ 面临/ 的/ 巨大/ 挑战/ ./ 5.2/ 分组/ 密码/ 故障/ 攻击/ 现状/ 和/ 发展趋势/ 分析/ 通过/ 对/ 已/ 发表/ 的/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 故障/ 攻击/ 文献/ 进行/ 分析/ ,/ 我们/ 发现/ 目前/ 现有/ 攻击/ 本质/ 上/ 来说/ 都/ 是/ 基于/ 求解/ S/ 盒/ 输入/ 和/ 输出/ 差分/ 问题/ ,/ 然后/ 基于/ 各种/ 故障/ 模型/ 结合/ SPN/ 、/ Feistel/ 等/ 密码/ 结构/ 特性/ 进行/ 差分/ 故障/ 分析/ ./ 下面/ 我们/ 将/ 通过/ 对/ 现有/ 文献/ 分析/ ,/ 探讨/ 分组/ 密码/ 故障/ 攻击/ 的/ 可能/ 发展趋势/ ./ (/ 1/ )/ 硬件/ 攻击/ 是/ 趋势/ ,/ 攻击/ 代价/ 越来越/ 小/ ./ 从/ 近年来/ 对/ 密码/ 故障/ 攻击/ 专业/ 会议/ —/ —/ —/ 密码/ 故障诊断/ 与/ 容忍/ FDTC/ 会议/ 2004/ 年/ ~/ 2010/ 年/ 的/ 统计/ 来看/ ,/ 硬件/ 故障/ 攻击/ 文章/ 越来越/ 多/ ,/ 硬件/ 故障/ 攻击/ 的/ 代价/ 也/ 由/ 2000/ 年初/ 激光/ 注入/ 故障/ 的/ 几百万美元/ 降低/ 到/ 目前/ 使用/ “/ 函数/ 任意/ 波形发生器/ ”/ 产生/ 脉冲/ 注入/ 故障/ 所/ 需/ 的/ 3/ 万元/ 人民币/ ,/ 攻击/ 的/ 代价/ 越来越/ 小/ ./ (/ 2/ )/ 拓展/ 故障/ 宽度/ 较/ 实用/ ./ 最初/ 针对/ DES/ 的/ 故障/ 攻击/ [/ 6/ ]/ 中/ ,/ 故障/ 宽度/ 为/ 1/ 位/ ,/ 这/ 主要/ 由于/ DES/ 是/ 一个/ 基于/ 位/ 进行/ 置换/ 的/ 分组/ 密码/ ;/ 后来/ 在/ 针对/ AES/ 的/ 故障/ 攻击/ 中/ ,/ 故障/ 宽度/ 也/ 是/ 1/ 位/ ,/ 如/ 文献/ [/ 9/ ]/ ./ 由于/ 在/ 实际/ 故障/ 攻击/ 物理/ 实验/ 中/ ,/ 故障/ 宽度/ 一般/ 很难/ 精确/ 控制/ ,/ 常为/ 1/ 个/ 或/ 多个/ 字节/ ,/ 故/ 之后/ 大部分/ 针对/ AES/ 和/ 其它/ 分组/ 密码/ 的/ 故障/ 攻击/ 中/ 故障/ 宽度/ 均/ 为/ 基于/ 1/ 个/ 字节/ ,/ 近年来/ ,/ 也/ 逐渐/ 出现/ 了/ 一些/ 针对/ 多/ 字节/ 故障/ 的/ 故障/ 攻击/ ,/ 如/ 文献/ [/ 15/ -/ 16/ ]/ ./ (/ 3/ )/ 延伸/ 故障/ 深度/ 可/ 提高/ 攻击/ 效率/ ./ 最初/ 故障/ 攻击/ 中/ ,/ 注入/ 故障/ 的/ 深度/ 一般/ 比较/ 浅/ ,/ 对于/ Feistel/ 结构/ 分组/ 密码/ ,/ 攻击者/ 常/ 在/ 第/ r/ 轮/ 查找/ S/ 盒前/ 注入/ 故障/ 来/ 恢复/ 第/ r/ 轮/ 相关/ 密钥/ ,/ 如/ 文献/ [/ 18/ ,/ 21/ ,/ 23/ ]/ ,/ 后续/ 逐渐/ 出现/ 了/ 在/ 第/ r/ -/ m/ 轮/ (/ m/ / 1/ )/ 注入/ 故障/ 的/ 故障/ 分析/ ,/ 如/ 文献/ [/ 22/ ,/ 24/ -/ 27/ ,/ 38/ ]/ ;/ 而/ 对/ Page13/ 于/ SPN/ 结构/ 分组/ 密码/ ,/ 攻击者/ 常/ 在/ 第/ r/ -/ 1/ 轮/ P/ 函数/ 前/ 注入/ 故障/ 来/ 恢复/ 第/ r/ 轮/ 相关/ 密钥/ ,/ 如/ 文献/ [/ 10/ ,/ 20/ ]/ ,/ 随着/ 差分/ 故障/ 分析/ 研究/ 的/ 深入/ ,/ 故障/ 深度/ 得以/ 加深/ ,/ 后续/ 逐渐/ 出现/ 了/ 在/ 第/ r/ -/ m/ 轮/ (/ m/ / 2/ )/ 注入/ 故障/ 的/ 故障/ 分析/ ,/ 如/ 文献/ [/ 11/ ,/ 13/ -/ 14/ ]/ ./ (/ 4/ )/ 组合/ 故障/ 分析/ ./ 在/ 实现/ 攻击/ 中/ ,/ 除了/ 故障/ 分析/ 以外/ ,/ 还有/ 计时/ 分析/ 、/ 功耗/ 分析/ 、/ 电磁/ 分析方法/ ,/ 如果/ 能/ 将/ 这/ 3/ 种/ 方法/ 和/ 故障/ 分析/ 结合/ 起来/ ,/ 可能/ 会/ 减少/ 攻击/ 所/ 需/ 样本量/ ,/ 提高/ 分析/ 效率/ ;/ 另外/ ,/ 随着/ 新/ 的/ 数学/ 统计分析/ 理论/ 的/ 发展/ ,/ 新/ 的/ 分析方法/ 同/ 故障/ 分析/ 的/ 结合/ ,/ 也/ 是/ 一个/ 可能/ 的/ 发展/ 方向/ ./ 6/ 结束语/ 在/ 故障/ 攻击/ 方面/ 大体/ 有/ 3/ 个/ 研究/ 方向/ :/ 故障注入/ 、/ 故障/ 分析/ 、/ 故障/ 攻击/ 检测/ 与/ 防护/ ./ 本文/ 主要/ 对/ 分组/ 密码/ 故障/ 分析/ 进行/ 了/ 研究/ ,/ 并/ 通过/ 软件/ 仿真/ 进行/ 了/ 验证/ ,/ 故障/ 攻击/ 硬件/ 物理/ 实验/ 方面/ 我们/ 拟/ 在/ 后续/ 研究/ 工作/ 中/ 开展/ ./ 本文/ 给出/ 了/ 针对/ 使用/ S/ 盒/ 的/ 分组/ 密码/ 差分/ 故障/ 攻击/ 通用/ 模型/ ,/ 并/ 由此/ 演化出/ SPN/ 和/ Feistel/ 结构/ 两种/ 具体/ 攻击/ 模型/ ,/ 然后/ 以/ Camellia/ 分组/ 密码/ 为例/ ,/ 基于/ 单字节/ 故障/ 模型/ ,/ 给出/ 了/ 一种/ 改进/ 的/ Camellia/ 差分/ 故障/ 分析方法/ ,/ 对/ 攻击/ 复杂度/ 进行/ 了/ 理论/ 分析/ ,/ 并/ 通过/ 软件/ 仿真/ 实验/ 进行/ 了/ 验证/ ./ 实验/ 结果表明/ ,/ 由于/ 其/ Feistel/ 结构/ 和/ 差分/ S/ 盒/ 特性/ ,/ Camellia/ 易/ 遭受/ 深度/ 故障/ 攻击/ ,/ 最好/ 的/ 实验/ 结果/ 为/ 16/ 次/ 故障/ 导入/ 可/ 恢复/ Camellia/ -/ 128/ 主/ 密钥/ ,/ 24/ 次/ 故障注入/ 可/ 恢复/ 没有/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 32/ 次/ 故障注入/ 可/ 恢复/ 使用/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ Camellia/ 算法/ ,/ 本文/ 中/ 故障/ 分析方法/ 也/ 可为/ 其它/ 分组/ 密码/ 差分/ 故障/ 分析/ 提供/ 一定/ 思路/ ./ 

