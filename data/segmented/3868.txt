Page1/ 两层/ 传感器/ 网络/ 中/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ 协议/ 李睿林/ 亚平/ 易叶青/ 胡玉鹏/ (/ 湖南大学/ 信息科学/ 与/ 工程学院/ 长沙/ 410082/ )/ 摘要/ 针对/ 两层/ 传感器/ 网络/ 中/ 存储/ 节点/ 更/ 容易/ 受到/ 攻击/ 这一/ 问题/ ,/ 文中/ 提出/ 一种/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ 协议/ :/ VQuery/ ./ VQuery/ 在/ 保证/ 存储/ 节点/ 正确/ 执行/ 查询/ 的/ 同时/ 能/ 有效/ 防止/ 敏感数据/ 与/ 查询/ 条件/ 的/ 泄露/ ./ 为了/ 保护/ 数据/ 的/ 隐私/ 性/ ,/ 提出/ 了/ 一种/ 基于/ 多项式/ 技术/ 的/ 隐私/ 保护/ 方案/ ,/ 该/ 方案/ 利用/ 多项式/ 技术/ 对/ 节点/ 采集/ 的/ 数据/ 范围/ 信息/ 和/ 查询/ 条件/ 进行/ 编码/ ,/ 保证/ 存储/ 节点/ 在/ 不/ 知道/ 数据/ 和/ 查询/ 条件/ 真实/ 内容/ 的/ 情况/ 下/ 正确/ 地/ 执行/ 查询处理/ ./ 为了/ 保护/ 查询/ 结果/ 的/ 完整性/ ,/ 提出/ 了/ 一种/ 基于/ 水印/ 链/ 技术/ 的/ 完整性/ 认证/ 方案/ ,/ 该/ 方案/ 能/ 有效/ 检测/ 查询/ 结果/ 的/ 完整性/ ./ 为了/ 对/ 多维/ 数据/ 查询/ 结果/ 的/ 完整性/ 认证/ ,/ 提出/ 了/ 一种/ 多维/ 区间/ 树/ 的/ 数据结构/ 来/ 表示/ 多维/ 数据/ ./ 分析/ 和/ 实验/ 结果/ 论证/ 了/ VQuery/ 协议/ 的/ 有效性/ ./ 关键词/ 两层/ 传感器/ 网络/ ;/ 隐私/ 与/ 完整性/ 保护/ ;/ 范围/ 查询/ ;/ 多项式/ ;/ 水印/ 链/ 1/ 引言/ 无线/ 传感器/ 网络/ 为/ 环境监测/ 和/ 移动/ 目标/ 识别/ 与/ 跟踪/ 提供/ 了/ 一种/ 非常/ 经济/ 的/ 分布式/ 解决方案/ [/ 1/ -/ 2/ ]/ ./ 本文/ 研究/ 两层/ 架构/ 的/ 传感器/ 网络/ (/ Two/ -/ tieredsensornetworks/ )/ ,/ 如图/ 1/ 所示/ ./ 在/ 两层/ 传感器/ 网络/ 中/ ,/ 存储/ 节点/ 为/ 附近/ 的/ 传感器/ 提供数据/ 存储/ 服务/ 的/ 同时/ ,/ 也/ 负责/ 执行/ Sink/ 发送/ 来/ 的/ 查询处理/ ./ 相对/ 于/ 传统/ 的/ 传感器/ 网络/ ,/ 两层/ 传感器/ 网络/ 具有/ 3/ 个/ 明显/ 的/ 优势/ :/ (/ 1/ )/ 每个/ 传感器/ 可/ 将/ 数据/ 发送到/ 附近/ 的/ 存储/ 节点/ ,/ 不必/ 以多/ 跳/ 的/ 形式/ 发送给/ 远处/ 的/ Sink/ ,/ 从而/ 降低/ 了/ 传感器/ 的/ 通信/ 开销/ ;/ (/ 2/ )/ 每个/ 传感器/ 可以/ 周期性地/ 将/ 采集/ 到/ 的/ 数据/ 提交/ 给/ 存储/ 节点/ 进行/ 存储/ ,/ 大大/ 改善/ 了/ 传感器/ 存储资源/ 不足/ 的/ 问题/ ;/ (/ 3/ )/ 查询处理/ 变得/ 更加/ 方便/ 有效/ ,/ 因为/ 当/ Sink/ 执行/ 查询/ 时/ 只/ 需要/ 和/ 存储/ 节点/ 进行/ 通信/ ,/ 存储/ 节点/ 也/ 只/ 需要/ 在/ 本地/ 执行/ 查询/ 即可/ ./ 两层/ 传感器/ 网络/ 最先/ 在/ 文献/ [/ 3/ ]/ 中/ 介绍/ ,/ 然后/ 被/ 广泛应用/ 于/ 各类/ 监测/ [/ 4/ -/ 7/ ]/ ./ 目前/ 市面上/ 也/ 出现/ 了/ 一些/ 存储/ 节点/ 的/ 产品/ 如/ StarGate/ ①/ 和/ RISE/ ②/ 等/ ./ 然而/ ,/ 在/ 两层/ 传感器/ 网络/ 当中/ ,/ 存储/ 节点/ 扮演/ 了/ 一个/ 关键/ 角色/ ,/ 因此/ 在/ 敌对/ 环境/ 中/ 更/ 容易/ 招致/ 攻击/ ./ 一个/ 妥协/ (/ compromised/ )/ 的/ 存储/ 节点/ 将会/ 对/ 网络/ 产生/ 重大/ 的/ 威胁/ :/ (/ 1/ )/ 攻击者/ 可以/ 获取/ 存储/ 或/ 将要/ 存储/ 在/ 妥协/ 的/ 存储/ 节点/ 上/ 的/ 敏感数据/ ;/ (/ 2/ )/ 妥协/ 的/ 存储/ 节点/ 可能/ 会/ 向/ Sink/ 返回/ 虚假/ 的/ 或者/ 不/ 完整/ 的/ 查询/ 结果/ ./ 在/ 两层/ 传感器/ 网络/ 当中/ 设计/ 一个/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ 协议/ 是/ 一个/ 非常/ 具有/ 挑战性/ 的/ 难题/ ./ 其/ 困难/ 之/ 处/ 在于/ :/ (/ 1/ )/ 为了/ 防止/ 信息/ 泄露/ ,/ 传感器/ 在/ 发送数据/ 给/ 存储/ 节点/ 之前/ 需要/ 对/ 数据/ 进行/ 加密/ 处理/ ./ 同样/ ,/ Sink/ 发送/ 查询/ 条件/ 给/ 存储/ 节点/ 时/ 也/ 需要/ 对/ 查询/ 条件/ 进行/ 加密/ ./ 因此/ 需要/ 解决/ 在/ 既/ 不/ 知道/ 查询/ 条件/ 真实/ 值/ ,/ 又/ 不/ 知道/ 待/ 查询/ 数据/ 真实/ 值/ 的/ 情况/ 下/ 如何/ 实现/ 正确/ 的/ 查询处理/ ;/ (/ 2/ )/ 一个/ 妥协/ 的/ 存储/ 节点/ 可能/ 会/ 伪造/ 虚假/ 的/ 查询/ 结果/ 或/ 删除/ 一些/ 满足/ 查询/ 条件/ 的/ 数据/ ./ 因此/ 需要/ 对/ 查询/ 结果/ 进行/ 完整性/ 认证/ ,/ 以/ 检测/ 出/ 这种/ 恶意/ 行为/ ./ 为此/ ,/ 本文/ 提出/ 了/ 一种/ 新颖/ 的/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ 协议/ :/ VQuery/ ./ 为了/ 实现/ 隐私/ 保护/ ,/ VQuery/ 采用/ 多项式/ 技术/ 对/ 数据/ 范围/ 与/ 查询/ 条件/ 进行/ 编码/ ,/ 实现/ 了/ 存储/ 节点/ 在/ 不/ 知道/ 查询/ 条件/ 和/ 数据/ 真实/ 值/ 的/ 情况/ 下/ ,/ 正确/ 地/ 执行/ 查询处理/ ./ 为了/ 保护/ 查询/ 结果/ 的/ 完整性/ ,/ 本文/ 采用/ 水印/ 链/ 技术/ ,/ 将/ 数据/ 区间/ 形成/ 一条/ 水印/ 链/ ./ Sink/ 利用/ 这种/ 水印/ 链/ 技术/ 可以/ 验证/ 查询/ 结果/ 的/ 完整性/ ./ 为了/ 实现/ 对/ 多维/ 数据/ 查询/ 结果/ 的/ 隐私/ 与/ 完整性/ 保护/ ,/ 本文/ 提出/ 了/ 一种/ 多维/ 区间/ 树/ 的/ 数据结构/ 来/ 表示/ 多维/ 数据/ ./ 为了/ 验证/ VQuery/ 的/ 有效性/ ,/ 本文/ 利用/ IntelLab/ ③/ 提供/ 的/ 真实/ 数据/ 对/ VQuery/ 协议/ 与/ 已有/ 的/ 协议/ 进行/ 测试/ 与/ 比较/ ./ 实验/ 结果表明/ 无论/ 在/ 通信/ 开销/ 还是/ 存储空间/ 开销/ 上/ ,/ VQuery/ 协议/ 均/ 优于/ 已有/ 的/ 协议/ ./ 本文/ 考虑/ 的/ 传感器/ 采集/ 的/ 数据/ 均/ 为/ 整数/ ,/ 然而/ 在/ 实际/ 中/ ,/ 传感器/ 采集/ 的/ 数据/ 的/ 原始/ 形态/ 可能/ 不是/ 整数/ ,/ 如/ 温度/ 、/ 湿度/ ,/ 但/ 这些/ 数据/ 能/ 很/ 方便/ 转换成/ 整数/ ,/ 因此/ ,/ 经过/ 数据/ 转换/ 后/ ,/ 本文/ 提出/ 的/ 协议/ 也/ 适合/ 这些/ 情况/ ./ 2/ 相关/ 工作/ 在/ 两层/ 结构/ 传感器/ 网络/ 中/ ,/ 范围/ 查询/ 的/ 隐私/ 与/ 完整性/ 保护/ 问题/ 已/ 引起/ 一些/ 学者/ 的/ 关注/ [/ 8/ -/ 11/ ]/ ./ 在/ 隐私/ 保护/ 方面/ :/ Sheng/ 和/ Li/ [/ 8/ ]/ 及/ Shi/ 等/ 人/ [/ 9/ -/ 10/ ]/ 采用/ Hacigumus/ 等/ 人/ [/ 12/ ]/ 提出/ 的/ 用于/ 数据库/ 隐私/ 保护/ 的/ 桶/ 划分/ 方法/ 保护/ 两层/ 结构/ 传感器/ 网络/ 中/ 的/ 范围/ 查询/ 的/ 隐私/ 性/ 与/ 完整性/ ./ 该/ 方法/ 首先/ 根据/ 数据分布/ 规律/ 将/ 数据/ 划分/ 成/ 多个/ 桶/ ,/ 每个/ 桶/ 分配/ 一个/ 唯一/ 的/ ID/ ./ 当/ 传感器/ 完成/ 数据/ 采集/ 后/ ,/ 将/ 这些/ 数据/ 分配/ 到/ 相应/ 的/ 桶/ 内/ ,/ 并/ 加密/ 这些/ 数据/ ,/ 连同/ 桶/ ID/ 一起/ 发送给/ 最近/ 的/ 存储/ 节点/ ./ 当/ Sink/ 执行/ 一个/ 范围/ 查询/ 时/ ,/ 首先/ 将/ 查询/ 条件/ 转换/ 为/ 最小/ 的/ 桶/ ID/ 集/ ,/ 然后/ 将/ 这个/ 桶/ ID/ 集/ 作为/ 查询/ 条件/ 发送给/ 存储/ 节点/ ,/ 存储/ 节点/ 找到/ 所有/ 满足条件/ 的/ 桶/ ,/ 将/ 桶/ 内/ 加密/ 数据/ 与/ 桶/ ID/ 作为/ 查询/ 结果/ 发送给/ Sink/ ./ S/ &/ L/ 方案/ 的/ 不足之处/ 在于/ :/ 在/ 桶/ 划分/ 技术/ 中/ ,/ 一个/ 妥协/ 的/ 存储/ 节点/ 能/ 估算/ 数据/ 与/ 查询/ 条件/ 的/ 实际/ 值/ [/ 13/ ]/ ;/ 对于/ 多维/ 数据/ ,/ 传感器/ 与/ 存储/ 节点/ 的/ 通信/ 能量/ 开销/ 和/ 存储空间/ 开销/ 随/ 维度/ 数/ ①/ ②/ ③/ Page3/ 的/ 增加/ 呈/ 指数/ 增长/ ./ 为了/ 解决/ 这一/ 问题/ ,/ Chen/ 和/ Liu/ [/ 11/ ]/ 提出/ 了/ 一种/ 称之为/ SafeQ/ 的/ 安全/ 查询/ 协议/ ./ SafeQ/ 采用/ 前缀/ 编码/ 的/ 方法/ 对/ 查询/ 条件/ 和/ 数据/ 进行/ 编码/ ,/ 一方面/ 能/ 使/ 存储/ 节点/ 正确/ 地/ 执行/ 查询处理/ ,/ 另一方面/ 能/ 有效/ 地/ 防止/ 妥协/ 的/ 存储/ 节点/ 估算/ 数据/ 与/ 查询/ 条件/ 的/ 实际/ 值/ ./ 相对/ 于/ S/ &/ L/ 协议/ ,/ 在/ 多维/ 数据/ 的/ 情况/ 下/ ,/ SafeQ/ 协议/ 在/ 存储空间/ 开销/ 和/ 通信/ 能量/ 开销/ 方面/ 有/ 了/ 较大/ 的/ 改善/ ./ 然而/ ,/ 由于/ SafeQ/ 采用/ 前缀/ 编码/ 的/ 方法/ 进行/ 隐私/ 保护/ ,/ 需要/ 将/ 采集/ 的/ n/ 个/ 数据/ 转换/ 为/ n/ +/ 1/ 个/ 区间/ ,/ 每个/ 区间/ 需要/ 多个/ 前缀/ 来/ 表示/ ,/ 因此/ 其/ 空间/ 开销/ 与/ 通信/ 能量/ 开销/ 依然/ 很大/ ,/ 这/ 对于/ 资源/ 受限/ 的/ 传感器/ 网络/ 来说/ 是/ 难以承受/ 的/ ./ 例如/ ,/ 在/ 一个/ 周期/ 中/ ,/ 一个/ 传感器/ 采集/ 了/ 4/ 个/ 数据/ {/ 9/ ,/ 17/ ,/ 33/ ,/ 43/ }/ ,/ 假定/ 下界/ 与/ 上界/ 分别/ 为/ 1/ 和/ 100/ ./ 根据/ SafeQ/ 协议/ ,/ 这些/ 数据/ 将/ 被/ 转换/ 为/ 5/ 个/ 区间/ {/ [/ 1/ ,/ 9/ ]/ ,/ [/ 9/ ,/ 17/ ]/ ,/ [/ 17/ ,/ 33/ ]/ ,/ [/ 33/ ,/ 43/ ]/ ,/ [/ 43/ ,/ 100/ ]/ }/ ,/ 用/ 前缀/ 编码/ 的/ 方式/ 表示/ 这些/ 区间/ 为/ {/ 100/ / ,/ 01/ / / ,/ 001/ / ,/ 0001/ }/ ,/ {/ 1001/ ,/ 101/ / ,/ 11/ / / ,/ 1000/ / }/ ,/ {/ 10001/ ,/ 1001/ / ,/ 101/ / / ,/ 11/ / / / ,/ 10000/ / }/ ,/ {/ 100001/ ,/ 10001/ / ,/ 1001/ / / ,/ 1010/ / / }/ ,/ {/ 101011/ ,/ 1011/ / / ,/ 11/ / / / / ,/ 10/ / / / / / ,/ 11000/ / / ,/ 1100100/ }/ ./ 显然/ SafeQ/ 需要/ 用/ 23/ 个/ 前缀/ 才能/ 表示/ 这/ 采集/ 的/ 4/ 个/ 数据/ ,/ 其/ 数据量/ 增大/ 了/ 近/ 6/ 倍/ ./ 在/ 多维/ 情况/ 下/ ,/ 区间/ 数将/ 随/ 维度/ 成倍增长/ ,/ 所/ 需/ 的/ 前缀/ 会/ 非常/ 多/ ./ 在/ 完整性/ 保护/ 方面/ :/ Sheng/ 和/ Li/ [/ 8/ ]/ 首先/ 提出/ 了/ 一种/ 基于/ 桶/ 的/ 信息/ 编码/ 技术/ ,/ 该/ 技术/ 的/ 基本思路/ 是/ 让/ 每个/ 传感器/ 为/ 每个/ 空桶/ 产生/ 一个/ 唯一/ 的/ 编码/ 数/ ,/ Sink/ 利用/ 这些/ 编码/ 数对/ 查询/ 结果/ 的/ 完整性/ 进行/ 认证/ ./ 为了/ 降低/ 通信/ 能量/ 开销/ ,/ Shi/ 等/ 人/ [/ 9/ -/ 11/ ]/ 则/ 提出/ 了/ 一种/ 时空/ 交错/ (/ SpatiotemporalCrosscheck/ )/ 的/ 校验/ 方案/ ./ 其/ 基本/ 思想/ 是/ :/ 每个/ 传感器/ 用/ 一个/ 位/ 图/ (/ BitMap/ )/ 描述/ 哪些/ 桶/ 有/ 数据/ ,/ 并/ 将/ 位图/ 广播/ 给/ 其/ 附近/ 的/ 传感器/ ,/ 每个/ 传感器/ 接收/ 到/ 其它/ 传感器/ 的/ 位图/ 后/ ,/ 将/ 其/ 附加/ 到/ 数据项/ 中/ ,/ 并/ 加密/ 发送给/ Sink/ ./ 该/ 方案/ 的/ 不足/ 是/ :/ 若/ 一个/ 妥协/ 的/ 传感器/ 伪造/ 虚假/ 的/ 位图/ 将/ 会/ 危及/ 其它/ 节点/ ./ 为了/ 解决/ 这一/ 问题/ ,/ Chen/ 和/ Liu/ [/ 11/ ]/ 提出/ 了/ 一种/ 称之为/ 邻居/ 链表/ (/ NeighborhoodChain/ )/ 的/ 数据结构/ 用于/ 对/ 查询/ 结果/ 进行/ 完整性/ 认证/ ,/ 但/ 在/ 邻居/ 链表/ 中/ 每/ 一个/ 数据/ 将/ 被/ 存储/ 两次/ ,/ 增大/ 了/ 传感器/ 与/ 存储/ 节点/ 的/ 存储空间/ 与/ 通信/ 能量/ 开销/ ./ 例如/ ,/ 一个/ 传感器/ 采集/ 2/ 个/ 三维/ 数据/ (/ 3/ ,/ 2/ ,/ 4/ )/ 和/ (/ 5/ ,/ 4/ ,/ 7/ )/ ,/ 假定/ 最低/ 界/ 与/ 最高/ 界/ 分别/ 为/ (/ 0/ ,/ 0/ ,/ 0/ )/ 和/ (/ 10/ ,/ 10/ ,/ 10/ )/ ,/ 根据/ SafeQ/ ,/ 构造/ 这/ 两个/ 数据/ 的/ 邻居/ 界为/ {/ (/ 0/ ,/ 0/ ,/ 0/ )/ |/ (/ 3/ ,/ 2/ ,/ 4/ )/ ,/ (/ 3/ ,/ 2/ ,/ 4/ )/ |/ (/ 5/ ,/ 4/ ,/ 7/ )/ ,/ (/ 5/ ,/ 4/ ,/ 7/ )/ |/ (/ 10/ ,/ 10/ ,/ 10/ )/ ,/ (/ 10/ ,/ 10/ ,/ 10/ )/ }/ ,/ 显然/ 邻居/ 链表/ 的/ 数据量/ 比/ 原始数据/ 量/ 增大/ 了/ 2/ 倍/ 多/ ./ 数字水印/ (/ DigitalWatermarking/ )/ 技术/ 是/ 将/ 一些/ 标识/ 信息/ 直接/ 嵌入/ 数字/ 载体/ (/ 如/ 媒体/ 、/ 文档/ 、/ 软件/ 等/ )/ 当中/ ,/ 但/ 不/ 影响/ 原/ 载体/ 的/ 使用/ 价值/ ,/ 也/ 不/ 容易/ 被/ 人/ 的/ 知觉/ 系统/ 觉察/ ./ 通过/ 这些/ 隐藏/ 在/ 载体/ 中/ 的/ 信息/ ,/ 可以/ 达到/ 确认/ 内容/ 创建者/ 、/ 购买者/ 、/ 传送/ 隐秘/ 信息/ 或者/ 判断/ 载体/ 是否/ 被/ 篡改/ 等/ 目的/ [/ 14/ -/ 15/ ]/ ./ 最近/ 有/ 一些/ 学者/ 应用/ 数字水印/ 技术/ 解决/ 无线/ 传感器/ 网络/ 中/ 的/ 一些/ 安全/ 问题/ ./ Feng/ 等/ 人/ [/ 16/ ]/ 提出/ 了/ 一种/ 知识产权/ 保护/ 技术/ ,/ 该/ 方法/ 利用/ 传感器/ 感知/ 数据/ 可能/ 有/ 微量/ 误差/ 的/ 特性/ 嵌入/ 水印/ ,/ 保护/ 无线/ 传感器/ 网络/ 采集/ 的/ 数据/ 版权/ ./ Zhang/ 等/ 人/ [/ 17/ ]/ 将/ 扩频/ 水印/ 技术/ 用于/ 无线/ 传感器/ 网络/ ,/ 解决/ 安全/ 聚合/ 的/ 问题/ ./ 在/ 数据完整性/ 认证/ 方面/ ,/ 文献/ [/ 18/ ]/ 提出/ 了/ 一种/ 水印/ 链/ 技术/ 用于/ 检查/ 流/ 数据/ 的/ 完整性/ ,/ 文献/ [/ 19/ ]/ 在/ 文献/ [/ 18/ ]/ 的/ 基础/ 上/ 进一步/ 提出/ 了/ 两种/ 脆弱/ 水印/ 技术/ ,/ 用于/ 传感器/ 数据/ 的/ 完整性/ 认证/ ./ 3/ 问题/ 陈述/ 与/ 基本/ 假设/ 如图/ 1/ 所示/ ,/ 一个/ 典型/ 的/ 两层/ 传感器/ 网络/ 包括/ 3/ 种/ 类型/ 的/ 节点/ :/ 传感器/ 、/ 存储/ 节点/ 和/ Sink/ ./ 传感器/ 的/ 主要/ 任务/ 是/ 采集/ 环境/ 数据/ (/ 如/ 温度/ 、/ 湿度/ 等/ )/ ,/ 但/ 数量/ 众多/ 的/ 传感器/ 存储/ 能力/ 与/ 计算能力/ 受限/ ,/ 节点/ 易/ 失效/ ./ 存储/ 节点/ 相对/ 于/ 传感器/ 来说/ 具有/ 较强/ 的/ 计算能力/ 与/ 较大/ 的/ 存储容量/ ,/ 节点/ 能/ 移动/ 且/ 不易/ 失效/ ./ 传感器/ 将/ 自身/ 采集/ 的/ 数据/ 周期性地/ 报告/ 给/ 最近/ 的/ 存储/ 节点/ ,/ 用户/ 根据/ 需要/ 向/ Sink/ 发出/ 查询/ 命令/ ,/ Sink/ 对/ 查询/ 命令/ 进行/ 改写/ ,/ 然后/ 发送给/ 存储/ 节点/ ,/ 存储/ 节点/ 根据/ 查询/ 命令/ 返回/ 满足条件/ 的/ 数据/ 给/ Sink/ ,/ Sink/ 对/ 返回/ 的/ 查询/ 结果/ 进行/ 完整性/ 认证/ ,/ 并/ 将/ 最终/ 结论/ 返回/ 给/ 用户/ ./ 对于/ 上述/ 两层/ 传感器/ 网络/ ,/ 本文/ 做出/ 如下/ 假设/ :/ (/ 1/ )/ 所有/ 的/ 传感器/ 在/ 部署/ 前/ 分配/ 一个/ 唯一/ 的/ ID/ 以及/ 预置/ 相应/ 的/ 隐私/ 保护/ 函数/ ,/ 如/ 传感器/ s/ η/ 分配/ 的/ ID/ 为/ η/ ,/ 预置/ 的/ 隐私/ 保护/ 函数/ 为/ P/ η/ (/ x/ )/ ;/ 存储/ 节点/ 预置/ 查询/ 函数/ Q/ (/ x/ ,/ y/ )/ ;/ (/ 2/ )/ 所有/ 传感器/ 与/ 存储/ 节点均/ 是/ 松散/ 同步/ ,/ 本文/ 将/ 时间/ 划分/ 成/ 互不/ 重叠/ 的/ 周期/ ,/ 每个/ 周期/ 内/ 节点/ 采样/ 的/ 次数/ 为/ n/ 次/ ,/ 传感器/ s/ η/ 所/ 采集/ 的/ 数据/ 用/ 三元组/ (/ η/ ,/ t/ ,/ {/ d1/ ,/ d2/ ,/ …/ ,/ dn/ }/ )/ 表示/ ,/ 其中/ t/ 表示/ 周期/ 序列/ ,/ d1/ ,/ d2/ ,/ …/ ,/ dn/ 表示/ 传感器/ 采集/ 的/ 数据/ ;/ (/ 3/ )/ 每/ 一个/ 传感器/ 单独/ 与/ Sink/ 共享/ 一个/ 密钥/ ,/ Page4/ 如/ 传感器/ s/ η/ 与/ Sink/ 共享/ 的/ 密钥/ 为/ k/ η/ ./ 本文/ 假设/ Sink/ 是/ 可信/ 的/ ./ 在/ 敌对/ 环境/ 中/ ,/ 传感器/ 和/ 存储/ 节点均/ 有/ 可能/ 被/ 攻击者/ 俘获/ ,/ 当/ 一个/ 传感器/ 被/ 俘获/ 后/ ,/ 攻击者/ 既/ 可以/ 读取/ 传感器/ 内/ 的/ 数据/ ,/ 也/ 可以/ 伪造/ 虚假/ 的/ 数据/ 发送给/ 最近/ 的/ 存储/ 节点/ ./ 由于/ 传感器/ 缺乏/ 抗/ 篡改/ 机制/ ,/ 要/ 想/ 阻止/ 这/ 类/ 攻击/ 是/ 十分困难/ 的/ ,/ 但/ 传感器/ 数量/ 众多/ ,/ 单个/ 传感器/ 所/ 采集/ 的/ 数据/ 仅仅/ 是/ 整个/ 结果/ 的/ 一个/ 小/ 片段/ ./ 存储/ 节点/ 与/ 传感器/ 不同/ ,/ 它/ 存储/ 了/ 大量/ 传感器/ 节点/ 的/ 数据/ ,/ 也/ 是/ 执行/ 查询处理/ 的/ 场地/ ,/ 当/ 一个/ 存储/ 节点/ 被/ 俘获/ 时/ ,/ 攻击者/ 可以/ 获取/ 大量/ 的/ 敏感数据/ ,/ 伪造/ 虚假/ 的/ 查询/ 结果/ 或/ 向/ 用户/ 提供/ 不/ 完整/ 的/ 查询/ 结果/ 等/ ,/ 因此/ 妥协/ 一个/ 存储/ 节点/ 其/ 危害性/ 将/ 大大/ 超过/ 妥协/ 一个/ 传感器/ ./ 本文/ 主要/ 关注/ 存储/ 节点/ 被/ 妥协/ 的/ 情况/ ./ 4/ 一维/ 数据/ 的/ 隐私/ 与/ 完整性/ 保护/ 4.1/ 一维/ 数据/ 的/ 隐私/ 保护/ 为了/ 保护/ 数据/ 的/ 隐私/ 性/ ,/ 需要/ 对/ 数据/ 进行/ 加密/ ,/ 以/ 防止/ 非法/ 用户/ 的/ 读取/ ./ 如何/ 在/ 加密/ 后/ 的/ 数据/ 中/ 实施/ 有效/ 的/ 查询处理/ 是/ 一个/ 挑战性/ 的/ 难题/ ./ 本节/ 主要/ 讨论/ 一维/ 数据/ 的/ 隐私/ 保护/ 方法/ ./ 一维/ 数据/ 的/ 隐私/ 保护/ 方法/ 的/ 基本/ 过程/ 如下/ :/ 当/ 传感器/ s/ η/ 完成/ 一个/ 周期/ 的/ 数据/ 采集/ 后/ ,/ 首先/ 利用/ 给定/ 的/ 参数/ Δ/ t/ 将/ 采集/ 的/ 数据/ 分配/ 到/ 相应/ 的/ 数据/ 区间/ 中/ ,/ 并/ 对/ 相邻/ 的/ 空/ 区间/ 进行/ 合并/ ;/ 然后/ 利用/ 密钥/ k/ η/ 对/ 每个/ 区间/ 内/ 的/ 数据/ 进行/ 块/ 加密/ ,/ 同时/ 也/ 利用/ 构造/ 的/ 隐私/ 保护/ 函数/ P/ η/ (/ x/ )/ 对/ 区间/ 信息/ 进行/ 编码/ ,/ 然后/ 将/ 加密/ 和/ 编码/ 的/ 结果/ 发送给/ 附近/ 的/ 存储/ 节点/ ./ 当/ Sink/ 需要/ 执行/ 一个/ 查询/ 时/ ,/ Sink/ 先/ 利用/ 查询/ 函数/ 将/ 查询/ 条件/ 转换/ 为/ 关于/ 传感器/ ID/ 号/ 的/ 函数/ 发送给/ 存储/ 节点/ ,/ 存储/ 节点/ 将/ 按照/ 4.1/ ./ 3/ 节所/ 描述/ 的/ 方法/ 执行/ 查询处理/ ,/ 并/ 向/ Sink/ 返回/ 查询/ 结果/ ./ 下面/ 分别/ 介绍/ 隐私/ 保护/ 函数/ 和/ 查询/ 函数/ 的/ 构造/ ,/ 然后/ 分/ 两个/ 阶段/ 详细/ 介绍/ 一维/ 数据/ 的/ 隐私/ 保护/ 方法/ ./ 4.1/ ./ 1/ 隐私/ 保护/ 函数/ 和/ 查询/ 函数/ 的/ 设计/ 本/ 小节/ 讨论/ 隐私/ 保护/ 函数/ 和/ 查询/ 函数/ 的/ 设计/ ./ 隐私/ 保护/ 函数/ 和/ 查询/ 函数/ 需要/ 满足/ 如下/ 条件/ :/ (/ 1/ )/ 为了/ 使/ 存储/ 节点/ 在/ 不/ 知道/ 数据/ 真实/ 值/ 的/ 情况/ 下能/ 确定/ 哪些/ 数据/ 在/ 查询/ 结果/ 中/ ,/ 隐私/ 保护/ 函数/ 和/ 查询/ 函数/ 都/ 应能/ 对/ 数据/ 保序/ ./ 另外/ ,/ 采用/ 隐私/ 保护/ 函数/ 编码/ 的/ 结果/ 不能/ 太/ 大/ ,/ 避免/ 消耗/ 过多/ 的/ 空间/ 和/ 能量/ ;/ (/ 2/ )/ 不同/ 传感器/ 应/ 具有/ 不同/ 的/ 隐私/ 保护/ 函数/ ,/ Sink/ 发送/ 查询/ 条件/ 给/ 存储/ 节点/ 后/ ,/ 存储/ 节点/ 应能/ 在/ 采用/ 不同/ 隐私/ 保护/ 函数/ 编码/ 后/ 的/ 数据/ 上/ 进行/ 查询处理/ ;/ (/ 3/ )/ 根据/ Sink/ 发送/ 的/ 查询/ 条件/ 和/ 一个/ 或/ 几个/ 隐私/ 保护/ 函数/ 应/ 不能/ 破解/ 查询/ 函数/ 和/ 其它/ 隐私/ 保护/ 函数/ ./ 为了/ 满足/ 以上/ 要求/ ,/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 需要/ 包含/ 3/ 部分/ :/ (/ 1/ )/ 数据处理/ 部分/ g/ (/ x/ ,/ ·/ )/ ./ 数据处理/ 部分/ 应能/ 对/ 数据/ 保序/ ,/ 且/ g/ (/ x/ ,/ ·/ )/ 计算/ 出/ 的/ 结果/ 值/ 不能/ 太/ 大/ ,/ 避免/ 消耗/ 过多/ 的/ 存储空间/ ;/ (/ 2/ )/ 传感器/ ID/ 处理/ 部分/ f/ (/ y/ ,/ ·/ )/ ./ 该/ 部分/ 使/ 不同/ 传感器/ 具有/ 不同/ 隐私/ 保护/ 函数/ ,/ 且/ 存储/ 节点/ 能/ 在/ 经过/ 不同/ 隐私/ 保护/ 函数/ 编码/ 后/ 的/ 数据/ 上/ 进行/ 查询处理/ ;/ (/ 3/ )/ 结果/ 扰动/ 部分/ φ/ (/ y/ )/ 和/ r/ η/ ,/ 分别/ 对/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 的/ 结果/ 进行/ 扰动/ ,/ 增强/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 的/ 安全性/ ./ 文献/ [/ 20/ ]/ 采用/ 多项式/ 技术/ 为/ 动态/ 会议/ 设计/ 了/ 一种/ 密钥/ 分配/ 方案/ ,/ 在/ 该文/ 的/ 启示/ 下/ ,/ 本文/ 查询/ 函数/ 设计/ 如下/ ①/ :/ Q/ (/ x/ ,/ y/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ 式/ (/ 1/ )/ 中/ ,/ 要求/ Ai/ ,/ j/ 为/ 非负/ 整数/ ,/ τ/ 为/ 该/ 多项式/ 的/ 阶/ ./ 可以/ 将/ 传感器/ 的/ ID/ 号/ 也/ 看成/ 是/ 传感器/ 采集/ 的/ 数据/ ,/ 因此/ ,/ 为/ 简单/ 起/ 见/ ,/ 我们/ 让/ 函数/ g/ (/ x/ ,/ ·/ )/ 和/ f/ (/ x/ ,/ ·/ )/ 为/ 同一/ 函数/ ./ 我们/ 参照/ logistical/ 模型/ 来/ 设计/ g/ (/ x/ ,/ ·/ )/ ./ g/ (/ x/ ,/ ·/ )/ 定义/ 如下/ :/ g/ (/ x/ ,/ i/ )/ =/ (/ g/ (/ x/ ,/ i/ -/ 1/ )/ +/ α/ )/ (/ 1/ +/ r/ (/ g/ (/ x/ ,/ i/ -/ 1/ )/ )/ )/ ,/ i/ / 2xi/ ,/ {/ 式/ (/ 2/ )/ 中/ ,/ α/ 为/ 一个/ 正常/ 数/ ,/ r/ (/ x/ )/ 定义/ 为/ r/ (/ x/ )/ =/ β/ (/ 1/ -/ x/ // Nm/ )/ ,/ 1/ -/ x/ // Nm/ >/ 0/ 式/ (/ 3/ )/ 中/ ,/ β/ 为/ 一个/ 正常/ 数/ ./ 根据/ 传感器/ 采集/ 的/ 数据/ 的/ 取值/ 范围/ ,/ 选择/ 一个/ 合适/ 的/ Nm/ ,/ 确保/ g/ (/ x/ ,/ ·/ )/ 在/ 该/ 范围/ 内/ 是/ 增函数/ ./ 传感器/ 节点/ s/ η/ 的/ 隐私/ 保护/ 函数/ 定义/ 如下/ :/ P/ η/ (/ x/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ 接下来/ 讨论/ 结果/ 扰动/ 部分/ φ/ (/ y/ )/ 和/ r/ η/ 的/ 取值/ ./ 为/ 满足条件/ 1/ ,/ 当/ x1/ >/ x2/ 时/ ,/ 应有/ P/ η/ (/ x1/ )/ >/ P/ η/ (/ x2/ )/ 和/ Q/ (/ x1/ ,/ y/ )/ >/ Q/ (/ x2/ ,/ y/ )/ 成立/ ./ 设/ M/ (/ y/ )/ 是/ Q/ (/ x/ ,/ y/ )/ 去掉/ 扰动/ 部分/ φ/ (/ y/ )/ 对于/ 变量/ y/ 的/ 最小/ 差值/ 函数/ ,/ 则/ M/ (/ y/ )/ 为/ M/ (/ y/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ ①/ 与/ 文献/ [/ 20/ ]/ 区别/ 的/ 是/ ,/ 本文/ 设计/ 的/ 多项式/ 不是/ 对称/ 多项式/ ./ Page5/ 式/ (/ 5/ )/ 中/ Bj/ =/ ∑/ 0/ / i/ / τ/ 是/ 一个/ 单调/ 递增/ 函数/ ,/ 传感器/ ID/ / 1/ ,/ 当/ y/ =/ 1/ 时/ ,/ 函数/ M/ (/ y/ )/ 取/ 最小值/ :/ M/ (/ 1/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ 为/ 一个/ 正整数/ ,/ 且/ 2l/ -/ 1/ / M/ (/ 1/ )/ / 2l/ 成立/ ./ 引入/ 系统/ 参数/ r/ (/ 0/ </ r/ </ l/ -/ 1/ )/ ./ 扰动/ 部分/ r/ η/ 取/ 随机数/ ,/ 且/ r/ η/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2r/ -/ 1/ }/ ./ 显然/ 有/ P/ η/ (/ x/ +/ 1/ )/ >/ P/ η/ (/ x/ )/ 成立/ ./ 接下来/ 讨论/ 扰动/ 函数/ φ/ (/ y/ )/ 的/ 产生/ ,/ 设/ φ/ (/ y/ )/ =/ ∑/ 0/ / j/ / τ/ Cjg/ (/ y/ ,/ j/ )/ +/ 2r/ -/ 1/ ,/ 系数/ Cj/ (/ 0/ / j/ / τ/ )/ 为/ 随机数/ ,/ 产生/ 规则/ 为/ :/ 先/ 产生/ 高阶/ 系数/ ,/ 在/ 高阶/ 系数/ 确定/ 的/ 情况/ 下/ 逐步/ 产生/ 低阶/ 系数/ ,/ 具体/ 如下/ :/ 烄/ 烅/ P/ η/ (/ x/ +/ 1/ )/ 成立/ ./ 烆/ 定理/ 1/ ./ 当/ x/ ∈/ N/ ,/ 有/ P/ η/ (/ x/ )/ / Q/ (/ x/ ,/ η/ )/ </ 证明/ ./ 首先/ 证明/ P/ η/ (/ x/ )/ / Q/ (/ x/ ,/ η/ )/ ./ 因为/ Q/ (/ x/ ,/ η/ )/ -/ P/ η/ (/ x/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ 所以/ P/ η/ (/ x/ )/ / Q/ (/ x/ ,/ η/ )/ ./ 接下来/ 证明/ Q/ (/ x/ ,/ η/ )/ </ P/ η/ (/ x/ +/ 1/ )/ ./ 因为/ P/ η/ (/ x/ +/ 1/ )/ -/ Q/ (/ x/ ,/ η/ )/ =/ ∑/ 0/ / i/ ,/ j/ / τ/ / ∑/ 0/ / i/ ,/ j/ / τ/ / ∑/ 0/ / i/ ,/ j/ / τ/ =/ ∑/ 0/ / i/ / τ/ =/ ∑/ 0/ / i/ / τ/ >/ 12/ ∑/ 0/ / i/ / τ/ / 12/ ∑/ 0/ / i/ ,/ j/ / τ/ / 12/ ∑/ 0/ / i/ ,/ j/ / τ/ 又/ 因为/ r/ </ l/ -/ 1/ ,/ 所以/ 2l/ -/ 2/ -/ 2r/ +/ 1/ / 2l/ -/ 2/ -/ 2l/ -/ 2/ +/ 1/ >/ 0/ ,/ 所以/ P/ η/ (/ x/ +/ 1/ )/ >/ Q/ (/ x/ ,/ η/ )/ ./ 由于/ P/ η/ (/ x/ )/ / Q/ (/ x/ ,/ η/ )/ </ P/ η/ (/ x/ +/ 1/ )/ ,/ 因此/ x1/ >/ x2/ ,/ 有/ Q/ (/ x1/ ,/ y/ )/ >/ Q/ (/ x2/ ,/ y/ )/ 成立/ ,/ 即/ Q/ (/ x/ ,/ y/ )/ 对/ 数据/ 保序/ ./ 传感器/ 在/ 部署/ 前/ 分配/ 唯一/ 的/ ID/ 号/ ,/ 并/ 预置/ 一个/ 与/ ID/ 号/ 相关/ 的/ 隐私/ 保护/ 函数/ ./ 传感器/ 利用/ 隐私/ 保护/ 函数/ 对/ 区间/ 信息/ 进行/ 编码/ ./ 同时/ ,/ 安全/ 服务器/ 给/ Sink/ 预置/ 查询/ 函数/ Q/ (/ x/ ,/ y/ )/ ./ 当/ 进行/ 范围/ 查询/ Qt/ :/ {/ t/ ,/ [/ a/ ,/ b/ ]/ }/ 时/ ,/ Sink/ 利用/ 查询/ 函数/ 将/ 查询/ 条件/ 转换成/ Qt/ :/ {/ t/ ,/ [/ Qa/ (/ y/ )/ ,/ Qb/ (/ y/ )/ ]/ }/ (/ 注/ :/ Qx/ (/ y/ )/ =/ Q/ (/ x/ ,/ y/ )/ ,/ 该/ 查询/ 条件/ 为/ 关于/ 传感器/ ID/ 号/ 的/ 一元函数/ )/ ,/ 并/ 将/ 该/ 查询/ 条件/ 发送给/ 存储/ 节点/ ./ 存储/ 节点/ 接收/ 到/ 查询/ 条件/ 后/ ,/ 为/ 不同/ 传感器/ 采集/ 的/ 数据/ 计算/ 查询/ 条件/ ./ 设/ 传感器/ S/ η/ 的/ ID/ 号/ 为/ η/ ,/ 存储/ 节点/ 为/ S/ η/ 采集/ 的/ 数据/ 计算/ 的/ 查询/ 条件/ 为/ Qt/ :/ {/ t/ ,/ [/ Qa/ (/ η/ )/ ,/ Qb/ (/ η/ )/ ]/ }/ ./ 设/ S/ η/ 的/ 一个/ 数据/ 区间/ 为/ (/ di/ ,/ dj/ ]/ ,/ 该/ 区间/ 中/ 的/ 数据/ 在/ 查询/ 结果/ 中/ ,/ 当且/ 仅/ 当/ 不等式/ Qa/ (/ η/ )/ </ P/ η/ (/ di/ )/ / Qb/ (/ η/ )/ 或/ (/ P/ η/ (/ di/ )/ </ Qa/ (/ η/ )/ )/ ∩/ (/ P/ η/ (/ dj/ )/ >/ Qb/ (/ η/ )/ )/ 或/ Qa/ (/ η/ )/ </ P/ η/ (/ dj/ )/ / Qb/ (/ η/ )/ 成立/ ./ 根据/ 这一/ 条件/ ,/ 存储/ 节点/ 能/ 在/ 不/ 知道/ 数据/ 与/ 查询/ 条件/ 真实/ 值/ 的/ 情况/ 下/ 实现/ 正确/ 查询/ ./ 4.1/ ./ 2/ 传感器/ 内/ 的/ 数据处理/ 阶段/ 本/ 小节/ 主要/ 描述/ 传感器/ 怎样/ 处理/ 在/ 一个/ 周期/ 内/ 采集/ 的/ 数据/ ./ 用/ (/ η/ ,/ t/ ,/ {/ d1/ ,/ d2/ ,/ …/ ,/ dn/ }/ )/ 表示/ 传感器/ S/ η/ 在/ 周期/ t/ 内/ 采集/ 的/ 数据/ ./ 当/ S/ η/ 完成/ 一个/ 周期/ 的/ 数据/ 采样/ 后/ ,/ 数据处理/ 过程/ 可以/ 描述/ 为/ 如下/ 两个/ 步骤/ :/ 1/ ./ 根据/ 参数/ Δ/ t/ 划分/ 数据/ 区间/ {/ 〈/ (/ b0/ ,/ b1/ ]/ ,/ x1/ 〉/ ,/ 〈/ (/ b1/ ,/ b2/ ]/ ,/ x2/ 〉/ ,/ …/ ,/ 〈/ (/ bm/ -/ 1/ ,/ bm/ ]/ ,/ xm/ 〉/ }/ ,/ 其中/ bi/ -/ bi/ -/ 1/ =/ Δ/ t/ ,/ b0/ 与/ bm/ 分别/ 表示/ 数据/ 可能/ 的/ 最小/ 和/ 最大值/ ,/ 且/ Sink/ 知道/ b0/ 与/ bm/ 的/ 值/ ,/ (/ bi/ -/ 1/ ,/ bi/ ]/ 表示/ 一个/ 数据/ 范围/ ,/ xi/ 表示/ 在/ 范围/ (/ bi/ -/ 1/ ,/ bi/ ]/ 内/ 的/ 数据/ 个数/ ,/ 然后/ 每个/ 传感器/ 将/ 采集/ 的/ 数据/ 分配/ 到/ 相应/ 的/ 区间/ ,/ 并/ 进一步/ 合并/ 相邻/ 的/ 空/ 区间/ ./ 2/ ./ 用/ DSi/ 表示/ 第/ i/ 个/ 区间/ (/ bi/ ,/ bi/ +/ 1/ ]/ 内/ 的/ 数据/ 集/ ,/ 则/ 〈/ (/ bi/ ,/ bi/ +/ 1/ ]/ ,/ (/ DSi/ )/ 〉/ 表示/ 第/ i/ 个/ 区间/ 及/ 该/ 区间/ 内/ 的/ 数据/ ,/ 若/ DSi/ 为空/ ,/ 则/ 在/ DSi/ 中/ 加入/ 一个/ 为空/ 的/ 特殊/ 标识符/ Null/ ./ 每个/ 传感器/ 利用/ 隐私/ 保护/ 函数/ 对/ 每个/ 区间/ 的/ 起/ 、/ 止值/ 进行/ 编码/ ,/ 然后/ 再/ 利用/ 节点/ 自身/ 的/ 密钥/ 对/ 每个/ 区间/ 的/ 数据/ 集/ 进行/ 加密/ ,/ 去除/ 重复/ 区间/ 信息/ 后/ 发送给/ 最近/ 的/ 存储/ 节点/ ./ 例如/ ,/ 假设/ S/ η/ 采集/ 的/ 数据/ 为/ (/ η/ ,/ t/ ,/ {/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 7/ }/ )/ ,/ Δ/ t/ =/ 2/ ,/ b0/ =/ 1/ ,/ bm/ =/ 12/ ./ 执行/ 步骤/ 1/ 可/ 得到/ 如下/ 区间/ :/ {/ η/ ,/ t/ ,/ 〈/ (/ 0/ ,/ 2/ ]/ ,/ 2/ 〉/ ,/ 〈/ (/ 2/ ,/ 4/ ]/ ,/ 2/ 〉/ ,/ 〈/ (/ 4/ ,/ 6/ ]/ ,/ 0/ 〉/ ,/ 〈/ (/ 6/ ,/ 8/ ]/ ,/ 1/ 〉/ ,/ 〈/ (/ 8/ ,/ 10/ ]/ ,/ 0/ 〉/ ,/ 〈/ (/ 10/ ,/ 12/ ]/ ,/ 0/ 〉/ }/ ,/ 合并/ 空/ 区间/ 得/ {/ η/ ,/ t/ ,/ 〈/ (/ 0/ ,/ 2/ ]/ ,/ 2/ 〉/ ,/ 〈/ (/ 2/ ,/ 4/ ]/ ,/ 2/ 〉/ ,/ 〈/ (/ 4/ ,/ 6/ ]/ ,/ 0/ 〉/ ,/ 〈/ (/ 6/ ,/ 8/ ]/ ,/ 1/ 〉/ ,/ Page6/ 〈/ (/ 8/ ,/ 12/ ]/ ,/ 0/ 〉/ }/ ./ 在/ 上述/ 例子/ 中/ S/ η/ 的/ 数据/ 可以/ 组织/ 成/ 如下/ 的/ 形式/ :/ {/ η/ ,/ t/ ,/ 〈/ (/ 0/ ,/ 2/ ]/ ,/ (/ 1/ ,/ 2/ )/ 〉/ ,/ 〈/ (/ 2/ ,/ 4/ ]/ ,/ (/ 3/ ,/ 4/ )/ 〉/ ,/ 〈/ (/ 4/ ,/ 6/ ]/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ 6/ ,/ 8/ ]/ ,/ (/ 7/ )/ 〉/ ,/ 〈/ (/ 8/ ,/ 12/ ]/ ,/ (/ Null/ )/ 〉/ }/ ./ 利用/ 隐私/ 保护/ 函数/ 对/ 区间/ 信息/ 进行/ 编码/ ,/ 并/ 利用/ 密钥/ k/ η/ 对/ 数据/ 进行/ 加密/ 得/ {/ η/ ,/ t/ ,/ 〈/ (/ P/ η/ (/ 0/ )/ ,/ P/ η/ (/ 2/ )/ ]/ ,/ (/ 1/ ,/ 2/ )/ k/ η/ 〉/ ,/ 〈/ (/ P/ η/ (/ 2/ )/ ,/ P/ η/ (/ 4/ )/ ]/ ,/ (/ 3/ ,/ 4/ )/ k/ η/ 〉/ ,/ 〈/ (/ P/ η/ (/ 4/ )/ ,/ P/ η/ (/ 6/ )/ ]/ ,/ (/ Null/ )/ k/ η/ 〉/ ,/ 〈/ (/ P/ η/ (/ 6/ )/ ,/ P/ η/ (/ 8/ )/ ]/ ,/ (/ 7/ )/ k/ η/ 〉/ ,/ 〈/ (/ P/ η/ (/ 8/ )/ ,/ P/ η/ (/ 12/ )/ ]/ ,/ (/ Null/ )/ k/ η/ 〉/ }/ ./ 去除/ 重复/ 区间/ 信息/ 得/ {/ η/ ,/ t/ ,/ 〈/ P/ η/ (/ 0/ )/ ,/ (/ 1/ ,/ 2/ )/ k/ η/ 〉/ ,/ 〈/ P/ η/ (/ 2/ )/ ,/ (/ 3/ ,/ 4/ )/ k/ η/ 〉/ ,/ 〈/ P/ η/ (/ 4/ )/ ,/ (/ Null/ )/ k/ η/ 〉/ ,/ 〈/ P/ η/ (/ 6/ )/ ,/ (/ 7/ )/ k/ η/ 〉/ ,/ 〈/ (/ P/ η/ (/ 8/ )/ ,/ P/ η/ (/ 12/ )/ ]/ (/ Null/ )/ k/ η/ 〉/ }/ ./ 传感器/ S/ η/ 将/ 这些/ 经过/ 编码/ 和/ 加密/ 的/ 数据/ 发送给/ 附近/ 的/ 存储/ 节点/ ./ 4.1/ ./ 3/ 存储/ 节点/ 内/ 的/ 查询处理/ 阶段/ 本/ 小节/ 主要/ 阐述/ Sink/ 如何/ 将/ 一个/ 范围/ 查询/ 发送给/ 存储/ 节点/ ,/ 以及/ 存储/ 节点/ 如何/ 在/ 不知/ 真实/ 数据/ 的/ 情况/ 下/ 执行/ 查询处理/ ./ 当/ Sink/ 需在/ 存储/ 节点/ 上/ 执行/ 查询/ Qt/ :/ {/ t/ ,/ [/ a/ ,/ b/ ]/ }/ (/ [/ a/ ,/ b/ ]/ / (/ b0/ ,/ bm/ ]/ )/ 时/ ,/ 须/ 执行/ 如下/ 4/ 个/ 步骤/ :/ 1/ ./ Sink/ 首先/ 利用/ 查询/ 函数/ 将/ 查询/ 条件/ Qt/ :/ {/ t/ ,/ [/ a/ ,/ b/ ]/ }/ 转换/ 为/ 一个/ 关于/ 传感器/ ID/ 号/ 函数/ 形式/ 的/ 查询/ 条件/ Qt/ :/ {/ t/ ,/ [/ Qa/ (/ y/ )/ ,/ Qb/ (/ y/ )/ ]/ }/ ./ 然后/ 将/ 该/ 查询/ 函数/ 发送给/ 存储/ 节点/ ./ 2/ ./ 存储/ 节点/ 接收/ 到/ Sink/ 发来/ 的/ 查询/ 函数/ 后/ ,/ 分别/ 为/ 每个/ 提交/ 数据/ 的/ 传感器/ 计算/ 查询/ 条件/ ,/ 如给/ ID/ 号/ 为/ η/ 的/ 传感器/ 节点/ S/ η/ 计算/ 的/ 查询/ 条件/ 为/ Qt/ :/ {/ t/ ,/ [/ Qa/ (/ η/ )/ ,/ Qb/ (/ η/ )/ ]/ }/ ./ 3/ ./ 存储/ 节点/ 根据/ 最终/ 编码/ 的/ 查询/ 条件/ 完成/ 查询处理/ ./ 假设/ 传感器/ S/ η/ 提交/ 的/ 数据/ 为/ {/ η/ ,/ t/ ,/ 〈/ P/ η/ (/ b0/ )/ ,/ (/ DS0/ )/ k/ η/ 〉/ ,/ …/ ,/ 〈/ (/ P/ η/ (/ bl/ )/ ,/ P/ η/ (/ bl/ +/ 1/ )/ ]/ (/ DSl/ )/ k/ η/ 〉/ }/ ,/ 若/ (/ DSi/ )/ k/ η/ 满足/ 查询/ 条件/ ,/ 当且/ 仅/ 当/ 不等式/ (/ P/ η/ (/ bi/ )/ </ Qa/ (/ η/ )/ )/ ∩/ (/ P/ η/ (/ bi/ +/ 1/ )/ >/ Qb/ (/ η/ )/ )/ 或/ Qa/ (/ η/ )/ </ P/ η/ (/ bi/ )/ / Qb/ (/ η/ )/ 或/ Qa/ (/ η/ )/ </ P/ η/ (/ bi/ +/ 1/ )/ / Qb/ (/ η/ )/ 成立/ ./ 4/ ./ 将/ 查询/ 结果/ 与/ 查询/ 结果/ 所在/ 区间/ 的/ 上/ 、/ 下界/ 信息/ (/ 用于/ 验证/ 查询/ 结果/ 的/ 完整性/ )/ 发送给/ Sink/ ./ 例如/ ,/ 假设/ S/ η/ 采集/ 数据/ 中/ 满足/ 查询/ 条件/ 的/ 数据/ 为/ {/ η/ ,/ t/ ,/ 〈/ P/ η/ (/ bi/ )/ ,/ (/ DSi/ )/ k/ η/ 〉/ ,/ …/ ,/ 〈/ (/ P/ η/ (/ bi/ +/ q/ )/ ]/ ,/ (/ DSi/ +/ q/ )/ k/ η/ 〉/ }/ (/ 该/ 数据/ 是/ 已经/ 去/ 除了/ 重复/ 区间/ 信息/ 的/ 数据/ )/ ,/ 则/ 查询/ 结果/ 所在/ 区间/ 的/ 上界/ 为/ P/ η/ (/ bi/ +/ q/ +/ 1/ )/ ,/ 下界/ 为/ P/ η/ (/ bi/ )/ ./ 4.2/ 一维/ 数据/ 的/ 完整性/ 保护/ 本文/ 考虑/ 查询/ 结果/ 的/ 完整性/ 保护/ 包括/ 两/ 方面/ :/ (/ 1/ )/ 验证/ 查询/ 结果/ 是否/ 被/ 伪造/ ;/ (/ 2/ )/ 验证/ 查询/ 结果/ 中/ 是否/ 有/ 符合/ 查询/ 条件/ 的/ 数据/ 被/ 删除/ ./ 存储/ 节点/ 在/ 没有/ 获得/ 加密/ 数据/ 密钥/ 的/ 情况/ 下去/ 伪造/ 查询/ 结果/ ,/ 最有/ 可能/ 就是/ 采用/ 重/ 放/ 攻击/ ./ 因此/ ,/ 本文/ 将/ 数据/ 所在/ 的/ 周期/ 信息/ 嵌入/ 到/ 数据/ 中来/ 防止/ 这种/ 攻击/ ./ 为了/ 验证/ 满足/ 查询/ 条件/ 的/ 数据/ 是否/ 被/ 删除/ ,/ 本文/ 采用/ 水印/ 链/ 技术/ [/ 18/ -/ 19/ ]/ 将/ 数据/ 区间/ 形成/ 一条/ 链/ ,/ Sink/ 通过/ 验证/ 查询/ 结果/ 中/ 水印/ 链/ 的/ 连续性/ 以及/ 查询/ 结果/ 区间/ 是否/ 覆盖/ 查询/ 区间/ 来/ 确认/ 查询/ 结果/ 中/ 是否/ 有/ 符合条件/ 的/ 数据/ 被/ 删除/ ./ 采用/ 水印/ 技术/ 最大/ 的/ 好处/ 就是/ 没有/ 额外/ 的/ 数据通信/ 开销/ 和/ 存储/ 开销/ ./ 一维/ 数据/ 查询/ 结果/ 完整性/ 保护/ 的/ 基本/ 过程/ 可以/ 描述/ 为/ 如下/ 过程/ :/ (/ 1/ )/ 在/ 一个/ 传感器/ 采集/ 的/ 数据/ 中/ ,/ 根据/ 每个/ 区间/ 内/ 数据/ 的/ 大小/ 确定/ 每个/ 区间/ 的/ 前驱/ 与/ 后继/ ;/ (/ 2/ )/ 采用/ Hash/ 的/ 办法/ 为/ 除/ 第一个/ 区间/ 外/ 的/ 每个/ 区间/ 内/ 的/ 数据/ 与/ 当前/ 周期/ 号/ 计算/ 一个/ 长度/ 为/ l/ 的/ Hash/ 值/ ;/ (/ 3/ )/ 将/ 每个/ 区间/ 的/ l/ 位/ Hash/ 值/ 作为/ 水印/ 嵌入/ 到/ 其/ 前驱/ 区间/ 内/ 的/ 数据/ 中/ ,/ 其中/ l/ 表示/ 嵌入/ 的/ 数据/ 位数/ ,/ 将/ 在/ 第/ 6/ 节中/ 讨论/ l/ 的/ 取值/ ;/ (/ 4/ )/ 当/ Sink/ 接收/ 到/ 存储/ 节点/ 返回/ 的/ 查询/ 结果/ 时/ ,/ 用户/ 将/ 通过/ 判断/ 水印/ 链/ 的/ 完整性/ ,/ 查询/ 结果/ 的/ 界/ 是否/ 包含/ 查询/ 条件/ 分别/ 验证/ 每个/ 传感器/ 所/ 提供/ 的/ 查询/ 结果/ 是否/ 完整/ ./ 下面/ 分/ 两个/ 小节/ 分别/ 阐述/ 水印/ 的/ 生成/ 、/ 嵌入/ 和/ 查询/ 结果/ 的/ 完整性/ 认证/ ./ 4.2/ ./ 1/ 水印/ 的/ 生成/ 与/ 嵌入/ 假定/ 传感器/ S/ η/ 在/ 周期/ t/ 内/ 采集/ 的/ 数据/ 被/ 划分/ 成/ m/ 个/ 区间/ ,/ DS0/ ,/ DS1/ ,/ …/ ,/ DSm/ -/ 1/ 分别/ 表示/ 这些/ 区间/ 相应/ 的/ 数据/ 集/ ,/ 用/ hl/ (/ DSi/ ‖/ t/ )/ 表示/ 数据/ 集/ DSi/ 连接/ 周期/ 信息/ t/ 产生/ 的/ l/ 位/ Hash/ 值/ ./ hl/ (/ DSi/ ‖/ t/ )/ 定义/ 如下/ :/ hl/ (/ DSi/ ‖/ t/ )/ =/ HASH/ (/ DSi/ ‖/ t/ )/ mod/ (/ 2l/ -/ 1/ )/ (/ 7/ )/ 式/ (/ 7/ )/ 中/ ,/ HASH/ (/ )/ 函数/ 为/ MD5/ 或者/ SHA/ ,/ 这些/ Hash/ 函数/ 对/ 任意/ 长度/ 的/ 输入/ 数据/ 产生/ 一个/ 定长/ 的/ Hash/ 值/ ./ 水印/ 的/ 生成/ 与/ 嵌入/ 描述/ 为/ 如下/ 的/ 步骤/ :/ 1/ ./ 判断/ 每个/ 数据/ 集内/ 的/ 数据/ 是否/ 为空/ 标识/ ,/ 如果/ 为/ 空则/ 用/ 该/ 区间/ 的/ 大小/ (/ 区间/ 的/ 终止/ 值/ 减去/ 起始值/ )/ 加入/ 到/ 该/ 数据/ 集合/ ,/ 保证/ 每/ 一个/ 数据/ 集中/ 均/ 存在/ 数据/ ./ 2/ ./ 为/ 每个/ 数据/ 集/ DS0/ ,/ DS1/ ,/ …/ ,/ DSm/ -/ 1/ 分别/ 产生/ l/ 位/ Hash/ 值/ ./ 3/ ./ 将/ hl/ (/ DSi/ ‖/ t/ )/ 嵌入/ 到/ DSi/ -/ 1/ 中/ ,/ 其中/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ,/ 并用/ 函数/ E/ (/ DSi/ -/ 1/ ,/ hl/ (/ DSi/ ‖/ t/ )/ )/ 表示/ 以/ hl/ (/ DSi/ ‖/ t/ )/ 为/ 水印/ 嵌入/ 到/ 数据/ 集/ DSi/ -/ 1/ 中/ ,/ 具体/ 的/ 水印/ 嵌入/ 过程/ 为/ :/ 将/ l/ 位/ 水印/ 数据/ 平均分配/ 给/ 该/ 数据/ 集/ 的/ 每个/ 数据/ ,/ 每个/ 数据/ 将/ 分配/ 到/ 的/ 水印/ 位/ 直接/ 链接/ 到/ 其/ 最低/ 位/ ,/ 如/ :/ 数据/ 3/ 需要/ 嵌入/ 两位/ 水印/ ‘/ 01/ ’/ ,/ 3/ 的/ 二进制/ 表示/ 为/ ‘/ 11/ ’/ ,/ 链接/ 水印/ 位/ ‘/ 01/ ’/ 后/ 得/ ‘/ 1101/ ’/ ,/ 若/ 数据/ 集中/ 的/ 数据/ 个数/ 大于/ l/ ,/ 则/ 选取/ 最/ 前/ (/ 或/ 最后/ )/ 的/ l/ 个/ 数据/ 嵌入/ 水印/ 即可/ ,/ 如果/ 数据/ 集中/ 的/ 数据/ 个数/ 太/ 少/ ,/ 本文/ 将/ 不能/ 嵌入/ 到/ 数据/ 中/ 的/ 水印/ 位/ 作为/ 一个/ 数据/ 加入/ 到/ 数据/ 集中/ ,/ 并/ 进行/ 标记/ ./ 4.2/ ./ 2/ 查询/ 结果/ 的/ 完整性/ 验证/ Sink/ 收到/ 查询/ 结果/ 后/ ,/ 首先/ 对/ 每个/ 传感器/ 的/ 数据/ 进行/ 解密/ ,/ 然后/ 对/ 存储/ 节点/ 提供/ 的/ 每个/ 传感器/ 的/ 查询/ 结果/ 进行/ 完整性/ 认证/ ./ 假定/ 传感器/ 节点/ S/ η/ 所/ 提供/ Page7/ 的/ 查询/ 结果/ 为/ (/ E/ (/ DSi/ ,/ hl/ (/ DSi/ +/ 1/ ‖/ t/ )/ )/ )/ k/ η/ ,/ (/ E/ (/ DSi/ +/ 1/ ,/ hl/ (/ DSi/ +/ 2/ ‖/ t/ )/ )/ )/ k/ η/ ,/ …/ ,/ (/ E/ (/ DSi/ +/ q/ ,/ hl/ (/ DSi/ +/ q/ +/ 1/ ‖/ t/ )/ )/ )/ k/ η/ ./ 查询/ 结果/ 所在/ 区间/ 的/ 上/ 、/ 下界/ 分别/ 为/ P/ η/ (/ bi/ +/ q/ +/ 1/ )/ 与/ P/ η/ (/ bi/ )/ ,/ 则/ 认证/ 过程/ 主要/ 包含/ 如下/ 步骤/ :/ 1/ ./ 首先/ 利用/ 查询/ 函数/ 计算/ 初始/ 查询/ 条件/ Qt/ :/ {/ t/ ,/ [/ a/ ,/ b/ ]/ }/ 的/ 最终/ 编码/ Qt/ :/ {/ t/ ,/ [/ Qa/ (/ η/ )/ ,/ Qb/ (/ η/ )/ ]/ }/ ,/ 并/ 判断/ 表达式/ [/ Qa/ (/ η/ )/ ,/ Qb/ (/ η/ )/ ]/ / (/ P/ η/ (/ bi/ )/ ,/ P/ η/ (/ bi/ +/ q/ +/ 1/ )/ ]/ 是否/ 成立/ ,/ 若/ 表达式/ 不/ 成立/ 则/ 表明/ 查询/ 结果/ 不/ 完整/ ,/ 否则/ 继续执行/ 步/ 2.2/ ./ 对/ 查询/ 结果/ 解密/ 得/ (/ E/ (/ DSi/ ,/ hl/ (/ DSi/ +/ 1/ ‖/ t/ )/ )/ )/ ,/ (/ E/ (/ DSi/ +/ 1/ ,/ hl/ (/ DSi/ +/ 2/ ‖/ t/ )/ )/ )/ ,/ …/ ,/ (/ E/ (/ DSi/ +/ q/ ,/ hl/ (/ DSi/ +/ q/ +/ 1/ ‖/ t/ )/ )/ )/ ./ 3/ ./ 从/ 查询/ 结果/ 的/ 每个/ 数据/ 集/ 提取/ l/ 位/ 水印/ 并/ 恢复/ 为/ 原始/ 的/ 查询/ 结果/ ,/ 即/ 得到/ 查询/ 结果/ 为/ DSi/ ,/ DSi/ +/ 1/ ,/ …/ ,/ DSi/ +/ q/ ,/ 水印/ 信息/ 为/ hl/ (/ DSi/ +/ 1/ ‖/ t/ )/ ,/ hl/ (/ DSi/ +/ 2/ ‖/ t/ )/ ,/ …/ ,/ hl/ (/ DSi/ +/ q/ +/ 1/ ‖/ t/ )/ ./ 4/ ./ 分别/ 计算/ 数据/ 集/ DSi/ +/ 1/ ,/ DSi/ +/ 2/ ,/ …/ ,/ DSi/ +/ q/ 的/ l/ 位/ Hash/ 值/ ,/ 并/ 将/ 计算/ 得到/ 的/ Hash/ 值/ 与/ 提取/ 的/ 水印/ hl/ (/ DSi/ +/ 1/ ‖/ t/ )/ ,/ hl/ (/ DSi/ +/ 2/ ‖/ t/ )/ ,/ …/ ,/ hl/ (/ DSi/ +/ q/ +/ 1/ ‖/ t/ )/ 进行/ 比较/ ,/ 若/ 不/ 匹配/ 则/ 表明/ 查询/ 结果/ 不/ 完整/ ,/ 否则/ 查询/ 结果/ 是/ 完整/ 的/ ./ 5/ 多维/ 数据/ 的/ 隐私/ 与/ 完整性/ 保护/ 为了/ 实现/ 更为/ 精确/ 的/ 监控/ ,/ 部署/ 在/ 自然环境/ 中/ 的/ 传感器/ 一般/ 会/ 同时/ 监测/ 多种/ 数据/ ,/ 比如/ ,/ 湿度/ 、/ 温度/ 、/ 光/ 强度/ 等/ ,/ 在/ 这种/ 情况/ 下/ ,/ 节点/ 所/ 采集/ 的/ 数据/ 是/ 多维/ 的/ ./ 一个/ z/ 维/ 的/ 数据项/ D/ 可用/ 一个/ z/ 元组/ 来/ 表示/ (/ d1/ ,/ d2/ ,/ …/ ,/ dz/ )/ ,/ 其中/ dl/ (/ 1/ / l/ / z/ )/ 表示/ 第/ l/ 维的值/ ./ 一个/ z/ 维/ 的/ 范围/ 查询/ 包括/ 了/ z/ 个子/ 范围/ 查询/ [/ a1/ ,/ b1/ ]/ ,/ [/ a2/ ,/ b2/ ]/ ,/ …/ ,/ [/ az/ ,/ bz/ ]/ ,/ 其中/ [/ al/ ,/ bl/ ]/ 表示/ 在/ 第/ l/ 维上/ 的/ 范围/ 查询/ 条件/ ./ 5.1/ 多维/ 数据/ 的/ 隐私/ 保护/ 本文/ 将/ 4.1/ 节/ 的/ 一维/ 数据/ 隐私/ 保护/ 方案/ 扩展/ 为/ 如下/ 的/ 多维/ 数据/ 的/ 隐私/ 保护/ 方案/ ./ 不妨/ 用/ {/ η/ ,/ t/ ,/ (/ D1/ ,/ D2/ ,/ …/ ,/ Dn/ )/ }/ 表示/ 传感器/ S/ η/ 在/ 周期/ t/ 内/ 采集/ 的/ n/ 个/ 多维/ 数据/ ,/ 式/ 中/ Dj/ =/ (/ d1/ 情况/ 类似/ ,/ 多维/ 数据/ 隐私/ 保护/ 描述/ 为/ 如下/ 步骤/ ./ 首先/ ,/ 当/ 一个/ 传感器/ 完成/ 一个/ 周期/ 的/ 数据/ 采集/ 后/ ,/ 利用/ 给定/ 的/ 参数/ (/ Δ/ 1t/ ,/ …/ ,/ Δ/ zt/ )/ 将/ 采集/ 的/ 数据/ 分配/ 到/ 相应/ 的/ 多维/ 区间/ 中/ ,/ 考虑/ 到/ 多维/ 数据/ 的/ 复杂性/ ,/ 本文/ 提出/ 了/ 一种/ 多维/ 区间/ 树/ (/ Multi/ -/ DimensionalRangeTree/ ,/ MDRT/ )/ 的/ 数据结构/ ,/ 利用/ 多维/ 区间/ 树/ 可以/ 有效/ 地/ 处理/ 空/ 区间/ 合并/ 问题/ ,/ 达到/ 节省/ 资源/ 的/ 目的/ ./ 然后/ ,/ 对/ 每个/ 区间/ 内/ 的/ 数据/ 进行/ 块/ 加密/ 以及/ 对/ 区间/ 信息/ 进行/ 编码/ ,/ 将/ 这些/ 加密/ 和/ 编码/ 的/ 数据/ 发送给/ 附近/ 的/ 存储/ 节点/ ./ 当/ Sink/ 需要/ 执行/ 查询/ Qt/ :/ {/ t/ ,/ (/ [/ a1/ ,/ b1/ ]/ ,/ …/ ,/ [/ az/ ,/ bz/ ]/ )/ }/ 时/ ,/ 与/ 处理/ 一维/ 数据/ 的/ 情况/ 类似/ ,/ Sink/ 先/ 利用/ 查询/ 函数/ 将/ 查询/ 条件/ 转换/ 为/ 关于/ 传感器/ ID/ 号/ 的/ 函数/ 的/ 查询/ 条件/ Qt/ :/ {/ t/ ,/ (/ [/ Qa1/ (/ y/ )/ ,/ Qb1/ (/ y/ )/ ]/ ,/ …/ ,/ [/ Qaz/ (/ y/ )/ ,/ Qbz/ (/ y/ )/ ]/ )/ }/ ,/ 并/ 发送给/ 存储/ 节点/ ./ 存储/ 节点/ 接收/ 到/ Sink/ 的/ 查询/ 条件/ 后/ ,/ 分别/ 为/ 每个/ 传感器/ 计算/ 最终/ 查询/ 条件/ ./ 如为/ ID/ 号/ 为/ η/ 的/ 传感器/ S/ η/ 计算/ 的/ 查询/ 条件/ 为/ Qt/ :/ {/ t/ ,/ (/ [/ Qa1/ (/ η/ )/ ,/ Qb1/ (/ η/ )/ ]/ ,/ …/ ,/ [/ Qaz/ (/ η/ )/ ,/ Qbz/ (/ η/ )/ ]/ )/ }/ ./ 最后/ ,/ 存储/ 节点/ 根据/ 为/ 每/ 一个/ 传感器/ 计算/ 的/ 查询/ 条件/ 完成/ 查询处理/ ./ 如/ S/ η/ 的/ 一个/ 区间/ (/ (/ b1i1/ ,/ b1i1/ +/ 1/ ]/ ,/ …/ ,/ (/ bziz/ ,/ bziz/ +/ 1/ ]/ )/ 内/ 的/ 数据/ 集/ (/ DSi/ )/ k/ η/ t/ 满足/ 查询/ 条件/ ,/ 当且/ 仅/ 当/ 表达式/ {/ (/ P/ η/ (/ b1i1/ )/ </ Qa1/ (/ η/ )/ )/ ∩/ (/ P/ η/ (/ b1i1/ +/ 1/ )/ >/ Qb1/ (/ η/ )/ )/ ∨/ (/ Qa1/ (/ η/ )/ </ P/ η/ (/ b1i1/ )/ / Qb1/ (/ η/ )/ )/ ∨/ (/ Qa1/ (/ η/ )/ </ P/ η/ (/ b1i/ +/ 1/ )/ / Qb1/ (/ η/ )/ )/ }/ ∧/ …/ ∧/ {/ (/ P/ η/ (/ bz/ (/ Qaz/ (/ η/ )/ </ P/ η/ (/ bziz/ )/ / Qbz/ (/ η/ )/ )/ ∨/ (/ Qaz/ (/ η/ )/ </ P/ η/ (/ bzi/ +/ 1/ )/ / Qbz/ (/ η/ )/ )/ }/ 的/ 值/ 为/ 真/ ./ 显然/ 根据/ 这一/ 条件/ 能/ 让/ 存储/ 节点/ 在/ 不/ 知道/ 数据/ 与/ 查询/ 条件/ 真实/ 值/ 的/ 情况/ 下/ 正确/ 判断/ 一个/ 多维/ 数据/ 集/ 是否/ 满足/ 查询/ 条件/ ./ 本文/ 提出/ 的/ MDRT/ 是/ 一棵/ 有/ 向/ 树/ ,/ 具有/ 下列/ 5/ 个/ 性质/ :/ (/ 1/ )/ 在/ MDRT/ 中/ 存在/ 一个/ 没有/ 入边/ (/ incomingedges/ )/ 的/ 节点/ ,/ 称之为/ 根/ 节点/ ,/ 在/ MDRT/ 中/ 也/ 存在/ 一些/ 没有/ 出边/ (/ outgoingedge/ )/ 的/ 节点/ ,/ 称之为/ 终端/ 节点/ (/ 或/ 叶子/ 节点/ )/ ;/ (/ 2/ )/ 处在/ MDRT/ 中/ 第/ 1/ 层/ 的/ 每/ 条边/ 表示/ 第/ 1/ 维/ 的/ 一个/ 子/ 区间/ ,/ 第/ 2/ 层/ 的/ 每/ 条边/ 表示/ 第/ 2/ 维/ 的/ 一个/ 子/ 区间/ ,/ …/ ,/ 第/ z/ 层/ 的/ 每/ 一条/ 边/ 表示/ 第/ z/ 维/ 的/ 一个/ 子/ 区间/ ;/ (/ 3/ )/ 同/ 一层/ 上/ 的/ 同一个/ 节点/ 的/ 出边/ 所/ 表示/ 的/ 子/ 区间/ 互不/ 交叠/ ./ 任何/ 一条/ 由根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ 长度/ 都/ 相等/ ;/ (/ 4/ )/ 从根/ 节点/ 到/ 叶子/ 节点/ 的/ 一条/ 有/ 向/ 路径/ 均表/ (/ 5/ )/ 每个/ 节点均/ 有/ 一个/ 标签/ ,/ 叶子/ 节点/ 的/ 标签/ 是/ 满足/ 由根/ 节点/ 到/ 叶子/ 节点/ 的/ 路径/ 所/ 表示/ 的/ 多维/ 区间/ 内/ 的/ 元素/ 的/ 个数/ ,/ 非/ 叶子/ 节点/ 的/ 标签/ 则/ 用/ 节点/ 所处/ 的/ 层数/ 来/ 表示/ ./ 如果/ 一棵/ MDRT/ 的/ 第/ i/ 层/ (/ 1/ / i/ / z/ ,/ 根/ 节点/ 为/ 第/ 1/ 层/ )/ 的/ 共父/ 节点/ 的/ 每个/ 节点/ 的/ 出边/ 所/ 表示/ 的/ 子/ 区间/ 是/ 连续/ 的/ ,/ 并且/ 将/ 这些/ 子/ 区间/ 合并/ 之后/ 就是/ 第/ l/ 维/ 的/ 整个/ 范围/ ,/ 本文/ 称/ 这样/ 的/ MDRT/ 为/ 完全/ 多维/ 区间/ 树/ (/ CompleteMulti/ -/ DimensionalRangeTree/ ,/ CMDRT/ )/ ./ 对于/ 一棵/ MDRT/ ,/ 如果/ 不是/ 一棵/ CMDRT/ ,/ 可以/ 插入/ 一些/ 子树/ 使/ 之/ 成为/ CMDRT/ ,/ 基本思路/ 是/ 按照/ 层次/ 扫描/ MDRT/ 及其/ 子树/ ,/ 当/ 发现/ 任意/ MDRT/ 树中/ ,/ 根/ 结点/ 的/ 下/ 一层/ 的/ 孩子/ 结点/ 不能/ 覆盖/ 其/ 对应/ 示/ 一个/ 多维/ 区间/ ;/ Page8/ 的/ 范围/ ,/ 则/ 插入/ 相应/ 的/ 孩子/ 结点/ ,/ 使该/ 层/ 结点/ 所/ 覆盖/ 的/ 范围/ 与/ 对应/ 层/ 的/ 范围/ 一致/ ./ 例如/ ,/ 对于/ 图/ 2/ ,/ 以/ D1/ 为根/ 结点/ 的/ MDRT/ 树/ ,/ 其/ 孩子/ 结点/ 覆盖/ 的/ 范围/ 是/ (/ 0/ ,/ 3/ ]/ ∪/ (/ 3/ ,/ 6/ ]/ ∪/ (/ 6/ ,/ 9/ ]/ =/ (/ 0/ ,/ 9/ ]/ ;/ 该层/ 实际/ 对应/ 的/ 范围/ 是/ (/ 0/ ,/ 12/ ]/ ,/ 因此/ 插入/ 子/ 树根/ 结点/ (/ 9/ ,/ 12/ ]/ ./ 然后/ 依次/ 处理/ 各层/ ,/ 得到/ 如图/ 3/ 所示/ 的/ CMDRT/ ./ 下面/ 结合/ 一个/ 实例/ 来/ 阐述/ 多维/ 数据/ 的/ 隐私/ 保护/ 的/ 具体/ 过程/ ./ 假定/ 传感器/ S/ η/ 在/ 周期/ t/ 内/ 采集/ 的/ 数据/ 为/ {/ η/ ,/ t/ ,/ (/ (/ 1/ ,/ 3/ )/ ,/ (/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 1/ )/ ,/ (/ 3/ ,/ 1/ )/ ,/ (/ 3/ ,/ 2/ )/ ,/ (/ 1/ ,/ 10/ )/ ,/ (/ 2/ ,/ 10/ )/ ,/ (/ 2/ ,/ 11/ )/ ,/ (/ 3/ ,/ 12/ )/ ,/ (/ 4/ ,/ 5/ )/ ,/ (/ 4/ ,/ 4/ )/ ,/ (/ 4/ ,/ 6/ )/ ,/ (/ 5/ ,/ 6/ )/ ,/ (/ 6/ ,/ 6/ )/ ,/ (/ 7/ ,/ 10/ )/ ,/ (/ 7/ ,/ 11/ )/ ,/ (/ 8/ ,/ 10/ )/ ,/ (/ 9/ ,/ 12/ )/ )/ }/ ,/ 参数/ Δ/ t/ =/ (/ 3/ ,/ 3/ )/ ,/ 每维/ 取值/ 范围/ 均/ 为/ [/ 1/ ,/ 12/ ]/ ./ 按照/ 上述/ 的/ 方法/ 将/ 传感器/ S/ η/ 的/ 数据/ 分配/ 到/ 如下/ 4/ 个/ 多维/ 区间/ :/ 〈/ (/ (/ 0/ ,/ 3/ ]/ ,/ (/ 0/ ,/ 3/ ]/ )/ ,/ (/ (/ 1/ ,/ 3/ )/ ,/ (/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 1/ )/ ,/ (/ 3/ ,/ 1/ )/ ,/ (/ 3/ ,/ 2/ )/ )/ 〉/ ,/ 〈/ (/ 0/ ,/ 3/ ]/ ,/ (/ 9/ ,/ 12/ ]/ ,/ (/ (/ 1/ ,/ 10/ )/ ,/ (/ 2/ ,/ 10/ )/ ,/ (/ 2/ ,/ 11/ )/ ,/ (/ 3/ ,/ 12/ )/ )/ 〉/ ,/ 〈/ (/ 3/ ,/ 6/ ]/ ,/ (/ 3/ ,/ 6/ ]/ ,/ (/ (/ 4/ ,/ 5/ )/ ,/ (/ 4/ ,/ 4/ )/ ,/ (/ 4/ ,/ 6/ )/ ,/ (/ 5/ ,/ 6/ )/ ,/ (/ 6/ ,/ 6/ )/ )/ 〉/ ,/ 〈/ (/ 6/ ,/ 9/ ]/ ,/ (/ 9/ ,/ 12/ ]/ ,/ (/ (/ 7/ ,/ 10/ )/ ,/ (/ 7/ ,/ 11/ )/ ,/ (/ 8/ ,/ 10/ )/ ,/ (/ 9/ ,/ 12/ )/ )/ 〉/ ./ 然后/ ,/ 将/ 这些/ 非空/ 的/ 多维/ 数据/ 区间/ 构造/ 成/ 一棵/ 多维/ 区间/ 树/ (/ 如图/ 2/ 所示/ )/ ,/ 再/ 将/ 多维/ 区间/ 树/ 转换成/ 完全/ 多维/ 区间/ 树/ ,/ 本例/ 插入/ 5/ 个空/ 区间/ 即可/ 转换/ 为/ 一颗/ 完全/ 多维/ 区间/ 树/ (/ 如图/ 3/ 所示/ )/ ,/ 在/ 这/ 5/ 个空/ 区间/ 内/ 加入/ 空/ 标识/ 后/ 得/ 〈/ (/ (/ 0/ ,/ 3/ ]/ ,/ (/ 3/ ,/ 9/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ (/ 3/ ,/ 6/ ]/ ,/ (/ 0/ ,/ 3/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ 3/ ,/ 6/ ]/ ,/ (/ 6/ ,/ 12/ ]/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ (/ 6/ ,/ 9/ ]/ ,/ (/ 1/ ,/ 9/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ (/ 9/ ,/ 12/ ]/ ,/ (/ 0/ ,/ 12/ ]/ )/ ,/ (/ Null/ )/ 〉/ ./ 再/ 利用/ 隐私/ 保护/ 函数/ 对/ 多维/ 区间/ 信息/ 进行/ 编码/ ,/ 利用/ 私钥/ 加密/ 区间/ 内/ 的/ 数集/ ,/ 将/ 结果/ 发送给/ 附近/ 的/ 存储/ 节点/ ./ 当/ Sink/ 需要/ 在/ 存储/ 节点/ 上/ 执行/ 查询/ [/ 4/ ,/ 12/ ]/ [/ 1/ ,/ 9/ ]/ 时/ ,/ Sink/ 首先/ 用/ 查询/ 函数/ 将/ 查询/ 条件/ 转换成/ 关于/ 传感器/ ID/ 的/ 函数/ 并/ 发送给/ 存储/ 节点/ ./ 存储/ 节点/ 收到/ Sink/ 发来/ 的/ 查询/ 条件/ 后/ ,/ 为/ 每/ 一个/ 传感器/ 节点/ 计算/ 最终/ 查询/ 条件/ 并/ 执行/ 查询处理/ ,/ 将/ 查询/ 结果/ 与/ 查询/ 结果/ 的/ 上/ 、/ 下界/ 发送给/ Sink/ ./ 与/ 一维/ 数据/ 不同/ 的/ 是/ ,/ 查询/ 结果/ 的/ 界/ 为/ 一个/ 多维/ 区间/ ,/ 它/ 是/ 每/ 一维/ 上/ 的/ 查询/ 结果/ 的/ 界/ 的/ 最大/ 公共/ 界/ ,/ 在/ 上述/ 的/ 实例/ 中/ 查询/ 结果/ 的/ 最大/ 公共/ 界为/ (/ (/ 3/ ,/ 12/ ]/ ,/ (/ 0/ ,/ 9/ ]/ )/ ./ 5.2/ 多维/ 数据/ 的/ 完整性/ 保护/ 多维/ 数据/ 查询/ 结果/ 的/ 完整性/ 保护/ 与/ 一维/ 数据/ 查询/ 结果/ 的/ 完整性/ 保护/ 一样/ ,/ 同样/ 需要/ 验证/ 查询/ 结果/ 是否/ 被/ 伪造/ 以及/ 满足/ 查询/ 条件/ 的/ 数据/ 是否/ 被/ 删除/ ./ 为了/ 有效/ 验证/ 多维/ 数据/ 查询/ 结果/ 的/ 完整性/ ,/ 本文/ 将/ 一维/ 数据/ 中/ 使用/ 的/ 水印/ 链/ 技术/ 扩展/ 为/ 多/ 水印/ 链/ 技术/ ,/ 多/ 水印/ 链/ 技术/ 与/ 4.2/ 节/ 的/ 水印/ 链/ 技术/ 最/ 主要/ 的/ 区别/ 是/ 在/ 一个/ 多维/ 的/ 查询/ 结果/ 中/ 只有/ 最后/ 一维/ 数据/ 不同/ 的/ 数据/ 通过/ 水印/ 链接/ 起来/ 的/ ,/ 因此/ 在/ 一个/ 多维/ 的/ 查询/ 结果/ 中/ 存在/ 多条/ 水印/ 链/ ./ 多维/ 数据/ 的/ 查询/ 结果/ 的/ 完整性/ 保护/ 的/ 基本/ 过程/ 描述/ 为/ 如下/ 过程/ :/ (/ 1/ )/ 根据/ 参数/ (/ Δ/ 1t/ ,/ …/ ,/ Δ/ zt/ )/ 将/ 传感器/ 采集/ 的/ 数据/ 分别/ 配/ 到/ 相应/ 的/ 区间/ ,/ 然后/ 建立/ 一棵/ MDRT/ 树/ ,/ 并/ 将/ 所/ 建立/ 的/ MDRT/ 转换/ 为/ 相应/ 的/ CMDRT/ ;/ (/ 2/ )/ 根据/ 每个/ 区间/ 在/ CMDRT/ 中/ 的/ 位置/ 确定/ 每个/ 区间/ 的/ 前驱/ 与/ 后继/ ,/ 具体方法/ 为/ :/ 若/ 叶子/ 节点/ ui/ 与/ 叶子/ 节点/ uj/ 共父/ 节点/ 且/ 节点/ ui/ 在/ uj/ 的/ 左边/ ,/ ui/ 与/ uj/ 间/ 再/ 无/ 其它/ 节点/ ,/ 则/ 称/ ui/ 是/ uj/ 前驱/ ,/ 那么/ 从根/ 节点/ 到/ ui/ 的/ 路径/ 所/ 表示/ 的/ 多维/ 区间/ 则/ 是从/ 根/ 节点/ 到/ uj/ 的/ 路径/ 所/ 表示/ 的/ 多维/ 区间/ 的/ 前驱/ ;/ (/ 3/ )/ 利用/ Hash/ 函数/ 为/ 一个/ 具有/ 前驱/ 区间/ 的/ 多维/ 区间/ 内/ 的/ 数据/ 产生/ l/ 位/ Hash/ 值/ ;/ (/ 4/ )/ 将/ 每个/ 区间/ 的/ l/ 位/ Hash/ 值/ 作为/ 水印/ 嵌入/ 到/ 其/ 前驱/ 区间/ 内/ 的/ 数据/ 中/ ;/ (/ 5/ )/ 当/ Sink/ 接收/ 到/ 存储/ 节点/ 返回/ 的/ 查询/ 结果/ 时/ ,/ 用户/ 将/ 通过/ 判断/ 水印/ 链/ 的/ 完整性/ 以及/ 查询/ 结果/ 的/ 界/ 是否/ 包含/ 查询/ 条件/ ,/ 分别/ 验证/ 每个/ 传感器/ 所/ 提供/ 的/ 查询/ 结果/ 的/ 完整性/ ./ 在/ 多/ 水印/ 链/ 技术/ 中/ 水印/ 的/ 生成/ 、/ 嵌入/ 和/ 提取/ 与/ 4.2/ 节所/ 描述/ 的/ 水印/ 链/ 技术/ 是/ 一致/ 的/ ,/ 当/ Sink/ 接收/ 到/ 存储/ 节点/ 返回/ 的/ 查询/ 结果/ 时/ ,/ 同样/ 用户/ 通过/ 判断/ 水印/ 链/ 的/ 完整性/ 以及/ 查询/ 结果/ 的/ 界/ 是否/ 包含/ 查询/ 条件/ ,/ 其/ 步骤/ 与/ 4.2/ 节/ 一维/ 数据/ 的/ 完整性/ 认证/ 一致/ ./ 例如/ ,/ 一个/ 传感器/ 有/ 如下/ 的/ 区间/ 与/ 数据/ :/ 〈/ (/ (/ 0/ ,/ 3/ ]/ ,/ (/ 0/ ,/ 3/ ]/ )/ ,/ (/ (/ 1/ ,/ 3/ )/ ,/ (/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 1/ )/ ,/ (/ 3/ ,/ 1/ )/ ,/ (/ 3/ ,/ 2/ )/ )/ 〉/ ,/ 〈/ (/ 0/ ,/ 3/ ]/ ,/ (/ 9/ ,/ 12/ ]/ ,/ (/ (/ 1/ ,/ 10/ )/ ,/ (/ 2/ ,/ 10/ )/ ,/ (/ 2/ ,/ 11/ )/ ,/ (/ 3/ ,/ 12/ )/ )/ 〉/ ,/ 〈/ (/ 3/ ,/ 6/ ]/ ,/ (/ 3/ ,/ 6/ ]/ ,/ (/ (/ 4/ ,/ 5/ )/ ,/ (/ 4/ ,/ 4/ )/ ,/ (/ 4/ ,/ 6/ )/ ,/ (/ 5/ ,/ 6/ )/ ,/ (/ 6/ ,/ 6/ )/ )/ 〉/ ,/ 〈/ (/ 6/ ,/ 9/ ]/ ,/ (/ 9/ ,/ 12/ ]/ ,/ (/ (/ 7/ ,/ 10/ )/ ,/ (/ 7/ ,/ 11/ )/ ,/ (/ 8/ ,/ 10/ )/ ,/ (/ 9/ ,/ 12/ )/ )/ 〉/ ,/ 〈/ (/ (/ 0/ ,/ 3/ ]/ ,/ (/ 3/ ,/ 9/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ Page9/ 〈/ (/ (/ 3/ ,/ 6/ ]/ ,/ (/ 0/ ,/ 3/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ 3/ ,/ 6/ ]/ ,/ (/ 6/ ,/ 12/ ]/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ (/ 6/ ,/ 9/ ]/ ,/ (/ 1/ ,/ 9/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 〈/ (/ (/ 9/ ,/ 12/ ]/ ,/ (/ 0/ ,/ 12/ ]/ )/ ,/ (/ Null/ )/ 〉/ ,/ 即/ 对应/ 了/ 图/ 3/ 所示/ 的/ CMDRT/ ,/ 根据上述/ 描述/ 的/ 多/ 水印/ 链/ 技术/ ,/ 区间/ (/ 0/ ,/ 3/ ]/ ,/ (/ 0/ ,/ 3/ ]/ )/ 没有/ 前驱/ ,/ 区间/ (/ 0/ ,/ 3/ ]/ ,/ (/ 3/ ,/ 9/ ]/ 的/ 前驱/ 区间/ 为/ (/ 0/ ,/ 3/ ]/ ,/ (/ 0/ ,/ 3/ ]/ ./ 同样/ 区间/ (/ 3/ ,/ 6/ ]/ ,/ (/ 0/ ,/ 3/ ]/ 无/ 前驱/ 区间/ ,/ 区间/ (/ 3/ ,/ 6/ ]/ ,/ (/ 3/ ,/ 6/ ]/ 的/ 前驱/ 区间/ 为/ (/ 3/ ,/ 6/ ]/ ,/ (/ 0/ ,/ 3/ ]/ ./ 图/ 4/ 描述/ 了/ 这些/ 区间/ 的/ 前驱/ 关系/ ./ 6/ 分析/ 首先/ 对/ 本文/ 方案/ 进行/ 复杂性/ 分析/ 与/ 安全性/ 分析/ ./ 复杂性/ 分析/ 主要/ 包括/ 传感器/ 处理/ 数据/ 的/ 时间/ 复杂度/ 与/ 空间/ 复杂度/ 以及/ 存储/ 节点/ 处理/ 数据/ 的/ 空间/ 复杂度/ ;/ 安全性/ 分析/ 主要/ 包含/ 数据/ 的/ 隐私/ 性/ 与/ 查询/ 结果/ 的/ 完整性/ ./ 然后/ 再/ 讨论/ 方案/ 中/ 的/ 一些/ 重要/ 参数/ 的/ 取值/ 问题/ ./ 6.1/ 复杂度/ 分析/ 假定/ 一个/ 传感器/ 在/ 一个/ 周期/ 内/ 采集/ 了/ n/ 个/ 数据/ ,/ z/ 表示/ 数据/ 的/ 维数/ ./ 表/ 1/ 分别/ 列出/ 本文/ 所提/ 协议/ 针对/ 单个/ 传感器/ 、/ 存储/ 节点/ 以及/ Sink/ 节点/ 的/ 计算/ 复杂度/ 、/ 通信/ 能量/ 开销/ 与/ 存储空间/ 复杂度/ ,/ 其中/ 计算/ 复杂度/ 均/ 是/ 考虑/ 最坏/ 情况/ 下/ 的/ 计算/ 复杂度/ ./ SensorStorageNodeSinkO/ (/ z/ )/ 查询/ 条件/ 处理/ 6.2/ 安全性/ 分析/ (/ 1/ )/ 隐私/ 性/ 分析/ 在/ 两层/ 结构/ 的/ 传感器/ 网络/ 中/ ,/ 当/ 存储/ 节点/ 被/ 妥协/ 时/ ,/ 本文/ 提出/ 的/ 隐私/ 保护/ 方法/ 能/ 有效/ 地/ 保护/ 数据/ 的/ 隐私/ 性/ ./ 这/ 是因为/ :/ 本文/ 方案/ 让/ 每个/ 传感器/ 在/ 递交/ 数据/ 给/ 存储/ 节点/ 之前/ ,/ 利用/ 预置/ 的/ 密钥/ 对/ 数据/ 进行/ 加密/ ./ 如果/ 没有/ 加密/ 的/ 密钥/ ,/ 攻击者/ 仅/ 通过/ 存储/ 节点/ 存储/ 的/ 密文/ 来/ 计算/ 每个/ 传感器/ 采集/ 的/ 数据/ 是/ 十分困难/ 的/ ./ 接下来/ 讨论/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 的/ 安全性/ ./ 本文/ 在/ 文献/ [/ 20/ ]/ 的/ 研究/ 结果/ 的/ 基础/ 上/ 设计/ 了/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ ./ 文献/ [/ 20/ ]/ 采用/ 的/ 是/ 对称/ 多项式/ ,/ 并/ 证明/ 了/ 当/ 多项式/ 的/ 阶为/ t/ 时/ ,/ 所提/ 方案/ 是/ t/ 安全/ 的/ ,/ 即/ 攻击者/ 妥协/ 节点/ 小于/ t/ 的/ 情况/ 下/ 无法/ 破解/ 剩下/ 的/ 多项式/ ./ 本文/ 设计/ 的/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 与/ 文献/ [/ 20/ ]/ 存在/ 两点/ 不同/ :/ (/ 1/ )/ 本文/ 多项式/ 为/ 非对称/ ;/ (/ 2/ )/ 本文/ 设计/ 了/ 函数/ g/ (/ x/ ,/ i/ )/ 来/ 替代/ 文献/ [/ 20/ ]/ 中/ 的/ 指数函数/ xi/ ,/ 用/ 函数/ g/ (/ x/ ,/ i/ )/ 代替/ xi/ 是/ 为了/ 减小/ 计算结果/ 的/ 值/ ,/ 在/ 安全性/ 上/ 没有/ 降低/ ./ 本文/ 与/ 文献/ [/ 20/ ]/ 在/ 安全性/ 的/ 分析/ 上/ 是/ 一致/ 的/ ./ 我们/ 从/ 两个/ 方面/ 来/ 分析/ 所/ 设计/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 的/ 安全性/ :/ ①/ 攻击者/ 妥协/ 小于/ τ/ 个/ 传感器/ 节点/ ,/ 并/ 获得/ 妥/ ②/ 攻击者/ 俘获/ 任意/ 多个/ 查询/ 条件/ 以及/ 妥协/ 一个/ 传感器/ 节点/ 并/ 获得/ 妥协/ 节点/ 上/ 的/ 隐私/ 保护/ 多项式/ (/ 妥协/ 不/ 超过/ τ/ 个/ 传感器/ 与/ 妥协/ 一个/ 传感器/ 情况/ 是/ 相同/ 的/ )/ ./ 对于/ 第/ 1/ 种/ 情况/ ,/ 本文/ 的/ 安全/ 分析/ 与/ 文献/ [/ 20/ ]/ 相同/ ,/ 为/ 简单/ 起/ 见/ ,/ 我们/ 先/ 不/ 考虑/ 扰动/ 系数/ 的/ 问题/ ./ 假设/ 攻击者/ 妥协/ 了/ k/ (/ k/ </ τ/ )/ 个/ 传感器/ 节点/ ,/ 并/ 获得/ 其上/ 的/ 隐私/ 保护/ 函数/ ,/ 可以/ 得到/ 如下/ 方程组/ (/ 以/ g/ (/ x/ ,/ i/ )/ 的/ 系数/ 为例/ )/ :/ 协/ 节点/ 的/ 隐私/ 保护/ 多项式/ ;/ 该/ 方程组/ 中/ 存在/ τ/ 个/ 系数/ 但/ 只有/ k/ 个/ 方程/ ,/ 根据/ 文献/ [/ 20/ ]/ 的/ 研究/ 结果/ ,/ 当/ k/ </ τ/ 时/ ,/ 攻击者/ 无法/ 破解/ 这些/ 系数/ ./ 另外/ ,/ 本文/ 设计/ 的/ 隐私/ 保护/ 函数/ 增加/ 了/ 扰动/ 系数/ ,/ 进一步/ 地/ 增加/ 了/ 破解/ 者/ 的/ 破解/ 难度/ ./ 从/ 上述/ 分析/ 可以/ 看出/ ,/ 在/ 实际/ 应用/ 中/ 应为/ 查询/ 函数/ 和/ 隐私/ 保护/ 函数/ 选取/ 合适/ 的/ τ/ 值/ ./ 接下来/ 分析/ 第/ 2/ 种/ 情况/ ,/ 即/ 攻击者/ 妥协/ 了/ 存储/ 节点/ 以及/ 一个/ 传感器/ S/ η/ 并/ 获得/ 隐私/ 保护/ 函数/ P/ η/ (/ x/ )/ 的/ 情况/ 下/ 是否/ 能/ 破解/ 查询/ 函数/ 和/ 其它/ 传感器/ 的/ 隐私/ 保护/ 函数/ 问题/ ./ 设/ 攻击者/ 收集/ 到/ Sink/ 发送/ 的/ 查询/ 条件/ Q/ :/ {/ t/ ,/ Qa/ (/ y/ )/ ,/ Qb/ (/ y/ )/ }/ ,/ 可/ 将/ S/ η/ 的/ ID/ 号/ 代入/ 该/ 查询/ 函数/ 计算/ 出/ 结果/ ,/ 并/ 建立/ 如下/ 方程/ :/ ∑/ 0/ / i/ ,/ j/ / τ/ 要/ 破解/ 查询/ 函数/ 或者/ 其它/ 传感器/ 的/ 隐私/ 保护/ 函/ Page10/ 数/ ,/ 关键/ 是/ 求解/ 系数/ Ai/ ,/ j/ ./ 由于/ 隐私/ 保护/ 函数/ P/ η/ (/ x/ )/ 的/ 单调/ 性/ 以及/ 已知/ 传感器/ 采集/ 数据/ 的/ 范围/ ,/ 采用/ 二分/ 查找/ 法可/ 查找/ 出式/ (/ 9/ )/ 中/ 的/ 查询/ 值/ ‘/ a/ ’/ ./ 但式/ (/ 9/ )/ 中/ 涉及/ 的/ φ/ (/ y/ )/ 是/ 随机/ 扰动/ 函数/ ,/ 对于/ 不同/ 的/ 查询/ 条件/ ,/ φ/ (/ y/ )/ 不同/ ,/ φ/ (/ y/ )/ 中/ 的/ 系数/ 是/ 在/ 一个/ 范围/ 内/ 的/ 随机数/ ,/ 系数/ Ck/ 的/ 取值/ 范围/ 为/ Ck/ ∈/ 0/ ,/ …/ ,/ 1Ai/ ,/ j/ -/ ∑/ k/ +/ 1/ / j/ / τ/ 整体/ 考虑/ ,/ 其/ 取值/ 范围/ 是/ (/ 0/ ,/ 2r/ -/ 1/ )/ (/ 注/ :/ 参数/ r/ 在/ 4.1/ ./ 1/ 节中/ 已经/ 说明/ )/ ./ 攻击者/ 收集/ 到/ n/ 个/ 查询/ 多项式/ 后/ 可以/ 建立/ n/ 个/ 等式/ ,/ 这些/ 等式/ 中共/ 有/ n/ +/ τ/ +/ 1/ 个/ 未知数/ ,/ 要/ 破解/ 系数/ Ai/ ,/ j/ ,/ 攻击者/ 需要/ 猜测/ τ/ +/ 1/ 个/ φ/ (/ y/ )/ 的/ 取值/ ,/ 其/ 破解/ 难度/ 至少/ 是/ Ω/ (/ 2r/ ×/ (/ τ/ +/ 1/ )/ )/ ./ (/ 2/ )/ 完整性/ 分析/ 在/ 一个/ 两层/ 结构/ 的/ 传感器/ 网络/ 中/ ,/ 本文/ 方案/ 能/ 让/ 用户/ 有效/ 地/ 验证/ 查询/ 结果/ 的/ 完整性/ ./ 本文/ 的/ 主要/ 思想/ 是/ :/ 让/ 每个/ 传感器/ 利用/ 上述/ 的/ 方法/ 为/ 每个/ 区间/ 内/ 的/ 数据/ 生成/ 水印/ 并/ 嵌入/ 到/ 其/ 前驱/ 区间/ 的/ 数据/ 中/ ,/ 每个/ 数据/ 区间/ 通过/ 嵌入/ 水印/ 后能/ 形成/ 一条/ 或/ 多条/ 链/ ,/ Sink/ 通过/ 判断/ 水印/ 链/ 的/ 完整性/ 以及/ 查询/ 结果/ 的/ 界/ 是否/ 包含/ 查询/ 条件/ 来/ 验证/ 查询/ 结果/ 的/ 完整性/ ./ 由于/ 传感器/ 在/ 递交/ 数据/ 给/ 存储/ 节点/ 前/ 将/ 嵌入/ 水印/ 的/ 数据/ 进行/ 加密/ ,/ 因此/ 一个/ 妥协/ 的/ 存储/ 节点/ 在/ 没有/ 获得/ 传感器/ 密钥/ 的/ 情况/ 下要/ 想/ 伪造/ 一个/ 合法/ 的/ 数据/ 并/ 为/ 其/ 嵌入/ 合法/ 的/ 水印/ 是/ 十分困难/ 的/ ./ 此外/ ,/ 删除/ 一些/ 查询/ 结果/ 中/ 的/ 数据/ 则/ 破坏/ 查询/ 结果/ 内/ 的/ 水印/ 链/ 的/ 完整性/ ./ 根据/ 文献/ [/ 18/ ]/ 的/ 分析/ ,/ 删除/ 一个/ 数据/ 块/ ,/ 而/ 不/ 被/ 检测/ 出来/ 的/ 概率/ 为/ 1/ // 2l/ -/ 1/ ./ 下面/ 讨论/ 水印/ 长度/ l/ 的/ 取值/ 问题/ ./ 显然/ ,/ l/ 的/ 值/ 越/ 大/ ,/ 本文/ 的/ 方案/ 检测/ 恶意/ 行为/ 的/ 概率/ 就/ 越/ 高/ ,/ 但/ l/ 的/ 值/ 受到/ 通信/ 开销/ 的/ 约束/ ./ 在/ 本文/ 的/ 方案/ 中/ 为了/ 保护/ 数据/ 的/ 隐私/ 性/ ,/ 同时/ 也/ 为了/ 方便/ 查询/ ,/ 每个/ 传感器/ 在/ 向/ 存储/ 节点/ 递交/ 数据/ 之前/ 将/ 数据/ 进行/ 块/ 加密/ ,/ 由于/ 传感器/ 资源/ 受限/ ,/ 不太可能/ 使用/ 开销/ 较大/ 的/ 非对称/ 加密/ 机制/ ,/ 因此/ 选用/ 开销/ 相对/ 较/ 小/ 的/ DES/ 对称/ 加密/ 机制/ ./ DES/ 是/ 一种/ 分组/ 密码/ 体制/ ,/ 要求/ 明文/ 按/ 64/ 位/ 一组/ 分成/ 若干组/ ,/ 若/ 不足/ 64bit/ ,/ 则/ 使用/ 任意/ 的/ 二进制/ 流/ 填充/ ,/ 密钥/ 长为/ 56/ 位/ ./ 假定/ 每个/ 传感器/ 采集/ 的/ 每个/ 数据/ 长度/ 为/ 16bit/ ,/ 首先/ 讨论/ 数据/ 不/ 进行/ 压缩/ 的/ 情况/ ,/ 在/ 保证/ 不/ 增加/ 通信量/ 的/ 情况/ 下/ ,/ 可以/ 嵌入/ 的/ 水印/ 长度/ ./ 由于/ 传感器/ 采集/ 的/ 数据/ 的/ 高位/ 上/ 通常/ 有/ 2/ ~/ 3/ 位/ 的/ 冗余/ (/ 16bit/ 的/ 数据/ 最大/ 可以/ 表示/ 65536/ ,/ 而/ 实际/ 的/ 采集/ 的/ 数据/ 通常/ 小于/ 10000/ )/ ,/ 可以/ 利用/ 这些/ 位/ 以及/ 进行/ 加密/ 时/ 需要/ 填充/ 的/ 数据位/ 嵌入/ 水印/ ./ 因此/ ,/ 当/ 数据/ 集中/ 只有/ 一个/ 数据/ 时/ ,/ 则/ 至少/ 可以/ 嵌入/ 48/ +/ 2/ =/ 50bit/ 的/ 水印/ 位/ (/ 其中/ 48bit/ 为/ 填充/ 位/ ,/ 2bit/ 为/ 数据/ 冗余/ 位/ )/ ./ 同理/ 若/ 数据/ 集中/ 只有/ 2/ 个/ 数据/ ,/ 至少/ 可/ 嵌入/ 36bit/ 的/ 水印/ 位/ ./ 最坏/ 情况/ ,/ 若/ 数据/ 集中/ 恰有/ 4/ 个/ 数据/ ,/ 其/ 长度/ 为/ 64bit/ 刚好/ 构成/ 一个组/ ,/ 只能/ 利用/ 数据/ 冗余/ 位/ 至少/ 可/ 嵌入/ 8/ 位/ 水印/ ./ 当/ 数据/ 集中/ 的/ 数据/ 多于/ 4/ 个/ 时/ ,/ 则/ 可以/ 嵌入/ 的/ 水印/ 位/ 又/ 会/ 增加/ ,/ 因为/ 一个/ 数据/ 集/ 对应/ 的/ 加密/ 数据/ 块/ 会/ 增加/ ,/ 为/ 水印/ 的/ 嵌入/ 提供/ 了/ 更/ 多/ 的/ 空间/ ./ 因此/ ,/ 当/ 数据/ 集中/ 含有/ 4/ 个/ 数据/ 的/ 时候/ 可以/ 嵌入/ 的/ 水印/ 位/ 最少/ ./ 我们/ 希望/ 在/ 数据/ 集中/ 含有/ 4/ 个/ 数据/ 时/ ,/ 能/ 嵌入/ 更/ 多/ 的/ 水印/ 位/ ./ 因此/ ,/ 我们/ 采用/ 数据压缩/ 的/ 办法/ 寻找/ 更/ 多/ 的/ 数据位/ 用于/ 水印/ 的/ 嵌入/ ./ 按照/ 本文/ 的/ 方案/ ,/ 当/ 数据/ 集不为/ 空时/ ,/ 该/ 数据/ 区间/ 的/ 取值/ 范围/ 由/ 参数/ Δ/ t/ 确定/ ,/ 因此/ 在/ 该/ 区间/ 中/ 数据/ 的/ 最大/ 增量/ 可以/ 用/ log2/ Δ/ t/ 位来/ 表示/ ./ 因此/ ,/ 该/ 数据/ 块/ 中/ 可以/ 用于/ 嵌入/ 水印/ 的/ 位为/ 64/ -/ 14/ -/ 3/ / log2/ Δ/ t/ 位/ ./ 其中/ ‘/ 14/ ’/ 是/ 表示/ 用/ 14/ 位/ 表示/ 该/ 数据/ 集中/ 的/ 最小/ 数据/ ,/ 3/ / log2/ Δ/ t/ 表示/ 用/ 增量/ 式/ 方式/ 表示/ 后面/ 3/ 个/ 数据/ 所/ 需要/ 的/ 位数/ ./ 当/ Δ/ t/ / 100/ 时/ ,/ 可以/ 嵌入/ 的/ 水印/ 位/ 至少/ 为/ 29/ 位/ ./ 则/ 删除/ 一个/ 数据/ 块/ 不/ 被/ 检测/ 出来/ 的/ 概率/ 非常/ 小/ ./ 6.3/ 查询/ 结果/ 的/ 假/ 阳性/ 分析/ 当/ 利用/ 区间/ 信息/ 对/ 密文/ 直接/ 进行/ 查询/ 操作/ 时/ ,/ 其/ 查询/ 结果/ 集/ 为/ 正确/ 结果/ 集/ 的/ 一个/ 超集/ (/ 含有/ 错检/ 的/ 数据/ )/ ,/ 因此/ 本文/ 称/ 这/ 一/ 问题/ 为/ 查询/ 结果/ 的/ 假/ 阳性/ 问题/ ./ 该/ 结果/ 集以/ 密文/ 的/ 形式/ 发送给/ Sink/ ,/ Sink/ 进行/ 解密/ 后/ 进行/ 处理/ ,/ 得到/ 正确/ 的/ 查询/ 结果/ 后/ 返回/ 给/ 用户/ ./ 为了/ 定量分析/ 查询/ 结果/ 的/ 假/ 阳性/ 问题/ ,/ 设/ 区间/ (/ bi/ -/ 1/ ,/ bi/ ]/ (/ bi/ -/ bi/ -/ 1/ =/ Δ/ t/ )/ 为/ 查询/ 结果/ 中/ 的/ 任意/ 区间/ ./ 用/ 向量/ 犞/ =/ (/ v1/ ,/ v2/ ,/ …/ ,/ v/ Δ/ t/ )/ (/ v1/ </ v2/ </ …/ </ v/ Δ/ t/ )/ 表示/ 所有/ 可能/ 处于/ 区间/ (/ bi/ -/ 1/ ,/ bi/ ]/ 内/ 的/ 数据/ ,/ 用/ 向量/ 犉/ 犞/ =/ (/ fv1/ ,/ fv2/ ,/ …/ ,/ fv/ Δ/ t/ )/ 表示/ 向量/ 犞/ 内/ 数据/ 在/ 区间/ (/ bi/ -/ 1/ ,/ bi/ ]/ 内/ 的/ 频度/ ,/ 并设/ N/ =/ ∑/ Δ/ t/ 例如/ ,/ 区间/ (/ 0/ ,/ 5/ ]/ 内有/ 数据/ {/ 1/ ,/ 1/ ,/ 1/ ,/ 2/ ,/ 2/ ,/ 5/ }/ ,/ 则/ 犞/ =/ (/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ )/ ,/ 犉/ 犞/ =/ (/ 3/ ,/ 2/ ,/ 0/ ,/ 0/ ,/ 1/ )/ ./ 根据/ 本文/ 的/ 协议/ 易知/ ,/ 若/ (/ bi/ -/ 1/ ,/ bi/ ]/ / [/ a/ ,/ b/ ]/ 时/ ,/ 区间/ (/ bi/ -/ 1/ ,/ bi/ ]/ 内/ 所有/ 的/ 数据/ 都/ 满足/ 查询/ 条件/ ,/ 因此/ 该/ 区间/ 没有/ 假/ 阳性/ 现象/ ./ 若/ bi/ -/ 1/ </ a/ / bi/ 或/ bi/ -/ 1/ </ b/ / bi/ 时/ ,/ 区间/ (/ bi/ -/ 1/ ,/ bi/ ]/ 内/ 只有/ 部分/ 的/ 数据/ 满足/ 查询/ 条件/ ,/ 因此/ 存在/ 假/ 阳性/ 问题/ ./ 首先/ 考虑/ bi/ -/ 1/ </ a/ / bi/ 情况/ ./ 当/ a/ =/ v1/ 时/ ,/ 数据/ (/ v1/ ,/ v2/ ,/ …/ ,/ v/ Δ/ t/ )/ 都/ 满足/ 查询/ 条件/ ,/ 不/ 满足/ 查询/ 条件/ 的/ Page11/ 数据/ 个数/ 为/ 0/ ;/ 当/ a/ =/ v2/ 时/ ,/ 数据/ (/ v2/ ,/ …/ ,/ v/ Δ/ t/ )/ 都/ 满足/ 查询/ 条件/ ./ 不/ 满足/ 查询/ 条件/ 的/ 数据/ 个数/ 为/ f1/ ;/ 当/ a/ =/ v3/ 时/ ,/ 数据/ (/ v3/ ,/ …/ ,/ v/ Δ/ t/ )/ 都/ 满足/ 查询/ 条件/ ./ 不/ 满足/ 查询/ 条件/ 的/ 数据/ 个数/ 为/ f1/ +/ f2/ ;/ 由此/ 类推/ ,/ 当/ a/ =/ vi/ 时/ ,/ 数据/ (/ vi/ ,/ …/ ,/ v/ Δ/ t/ )/ 都/ 满足/ 查询/ 条件/ ./ 不/ 满足/ 查询/ 条件/ 的/ 数据/ 个数/ 为/ f1/ +/ f2/ +/ …/ +/ fi/ -/ 1/ ./ 假定/ a/ 为/ (/ v1/ ,/ v2/ ,/ …/ ,/ v/ Δ/ t/ )/ 中/ 任意/ 一个/ 值/ 的/ 概率/ 相等/ ,/ 因此/ 不/ 满足/ 查询/ 条件/ 的/ 数据/ 个数/ 的/ 期望/ 数为/ Δ/ tf1/ +/ 11/ 同理/ 可/ 得/ ,/ 当/ bi/ -/ 1/ </ b/ / bi/ 时/ 不/ 满足/ 查询/ 条件/ 的/ 数据/ 个数/ 的/ 期望/ 数为/ 1/ Δ/ tf/ Δ/ t/ +/ 1/ 当/ b/ -/ a/ >/ Δ/ t/ 时/ ,/ 上述/ 两种/ 情况/ 都/ 会/ 同时/ 存在/ 于/ 查询/ 结果/ 之中/ ,/ 因此/ 查询/ 结果/ 的/ 假/ 阳性/ 的/ 总/ 期望值/ 为式/ (/ 10/ )/ 与/ 式/ (/ 11/ )/ 的/ 和/ ,/ 即得/ 6.4/ 参数/ 分析/ 传感器/ 递交/ 数据量/ 的/ 大小/ 与/ 存储/ 节点/ 返回/ 查询/ 结果/ 数据量/ 的/ 大小/ 是/ 衡量/ 本文/ 的/ 协议/ 的/ 效率/ 的/ 两个/ 重要/ 指标/ ./ 实际上/ ,/ 传感器/ 递交/ 数据量/ 是/ 由/ 两/ 部分/ 组成/ ,/ 一部分/ 是/ 传感器/ 采集/ 的/ 加密/ 后/ 的/ 数据/ ,/ 这部分/ 的/ 数据量/ 的/ 大小/ 与/ 参数/ Δ/ t/ 值/ 无关/ ,/ 只/ 与/ 周期/ 的/ 长短/ 与/ 实际上/ ,/ 对于/ 传感器/ 的/ 通信/ 能量/ 开销/ 和/ 存储/ 节点/ 的/ 存储空间/ 开销/ 是/ 一致/ 的/ ,/ Δ/ t/ 的/ 值/ 越/ 大/ ,/ 则/ 传感器/ 的/ 通信/ 能量/ 开销/ 和/ 存储/ 节点/ 的/ 存储空间/ 开销/ 越小/ ./ 由于/ 查询/ 结果/ 的/ 最小化/ 问题/ 已经/ 合理/ 地/ 平衡/ 了/ 假/ 阳性/ 问题/ 与/ 区间/ 信息/ 的/ 大小/ ,/ 因此/ 用/ 上述/ 模型/ 的/ 结果/ 作为/ 传感器/ 最优/ 结果/ ./ 考虑/ 多维/ 数据/ 的/ 情况/ ,/ 令/ 传感器/ Si/ 所/ 采集/ 的/ n/ 个/ 多维/ 数据/ 中/ dln/ 与/ dl1/ 分别/ 代表/ 第/ l/ (/ 1/ / l/ / z/ )/ 维中/ 最大值/ 与/ 最小值/ ,/ 参数/ Δ/ t/ =/ (/ Δ/ 1t/ ,/ Δ/ 2t/ ,/ …/ ,/ Δ/ zt/ )/ ,/ 同样/ 忽略/ 区间/ (/ bl0/ ,/ dl1/ ]/ 与/ (/ dln/ ,/ blm/ ]/ 对/ 结果/ 的/ 影响/ ,/ 将/ 这些/ 采集/ 的/ 数据/ 分配/ 至/ ∏/ z/ 采样/ 频率/ 有关/ ;/ 另/ 一部分/ 数据/ 是/ 编码/ 后/ 的/ 区间/ 信息/ ,/ 显然/ Δ/ t/ 值越/ 小/ 区间/ 数越/ 多/ ,/ 相应/ 的/ 信息量/ 也/ 就/ 越/ 大/ ./ 由于/ 本文/ 协议/ 与/ 已有/ 的/ 工作/ 一样/ ,/ 在/ 查询/ 结果/ 中/ 存在/ 着/ 假/ 阳性/ 问题/ ,/ 假/ 阳性/ 问题/ 越/ 突出/ ,/ 则/ 存储/ 节点/ 的/ 返回/ 给/ Sink/ 的/ 查询/ 结果/ 就/ 越/ 大/ ,/ 由/ 6.3/ 节/ 的/ 结论/ 可知/ ,/ 假/ 阳性/ 的/ 大小/ 与/ Δ/ t/ 取值/ 有关/ ,/ 显然/ Δ/ t/ 的/ 值/ 越/ 大/ 区间/ 数越/ 少/ ,/ 每个/ 区间/ 内/ 的/ 数据量/ 越/ 多/ ,/ 因此/ 假/ 阳性/ 问题/ 越/ 突出/ ./ 为了/ 得到/ 参数/ Δ/ t/ 的/ 最优/ 值/ ,/ 建立/ 如下/ 的/ 数学模型/ ./ 考虑/ 一维/ 数据/ 的/ 情况/ ,/ 令/ 传感器/ Si/ 所/ 采集/ 的/ n/ 个/ 数据/ 按/ 升序/ 排列/ 为/ {/ d1/ ,/ d2/ ,/ …/ ,/ dn/ }/ ,/ 由于/ 本文/ 的/ 方案/ 会/ 对/ 相邻/ 的/ 空/ 区间/ 进行/ 合并/ ,/ 因此/ 忽略/ 区间/ (/ b0/ ,/ d1/ ]/ 与/ (/ dn/ ,/ bm/ ]/ 对/ 结果/ 的/ 影响/ ,/ 将/ 这些/ 采集/ 的/ 数据/ 划入/ (/ dn/ -/ d1/ )/ // Δ/ t/ 个/ 区间/ ,/ 平均/ 每个/ 区间/ 将/ 有/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ 个/ 数据/ ,/ 由/ 6.3/ 节对/ 假/ 阳性/ 分析/ 的/ 结论/ 可知/ 对于/ 任意/ 查询/ ,/ 其假/ 阳性/ 的/ 大小/ 约/ 为/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ ./ 用/ ω/ 表示/ 平均/ 每个/ 区间/ 所/ 需/ 的/ 编码/ 信息量/ ./ 要/ 使/ 本文/ 的/ 协议/ 效率/ 达到/ 最高/ ,/ 只要/ 区间/ 信息/ 与/ 假/ 阳性/ 两者/ 之/ 和/ 最小/ 即可/ ,/ 因此/ 可/ 得到/ 如下/ 的/ 目标/ 函数/ :/ min/ (/ ω/ ×/ (/ dn/ -/ d1/ )/ // Δ/ t/ +/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ )/ (/ 13/ )/ 式/ (/ 12/ )/ 是/ 一个/ 单/ 决策/ 变量/ 的/ 优化/ 模型/ ,/ 不妨/ 令/ G/ (/ Δ/ t/ )/ =/ ω/ ×/ (/ dn/ -/ d1/ )/ // Δ/ t/ +/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ ,/ 因为/ (/ ω/ ×/ (/ dn/ -/ d1/ )/ // Δ/ t/ )/ ×/ (/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ )/ ≡/ ω/ n/ ,/ 所以/ 当且/ 仅/ 当/ ω/ ×/ (/ dn/ -/ d1/ )/ // Δ/ t/ =/ n/ Δ/ t/ // (/ dn/ -/ d1/ )/ 时/ G/ (/ Δ/ t/ )/ 有/ 最小值/ ./ 考虑/ 到/ 约束条件/ Δ/ t/ 为/ 非负/ 整数/ ,/ 参数/ Δ/ t/ 的/ 值/ 为/ )/ / Gdn/ -/ d1n/ ×/ n/ 槡/ ω/ (/ )/ >/ Gdn/ -/ d1n/ ×/ n/ 槡/ ω/ (/ 阳性/ 分析/ 的/ 结论/ 可知/ 对于/ 任意/ 查询/ ,/ 其假/ 阳性/ 的/ 大小/ 约/ 为/ n/ ∏/ z/ 编码/ 信息量/ ./ 要/ 使/ 本文/ 的/ 协议/ 效率/ 达到/ 最高/ ,/ 只要/ 区间/ 信息/ 与/ 假/ 阳性/ 两者/ 之/ 和/ 最小/ 即可/ ,/ 因此/ 可/ 得到/ 如下/ 的/ 规划/ 方程/ :/ 式/ (/ 14/ )/ 是/ 一个/ 单/ 决策/ 变量/ 的/ 优化/ 模型/ ,/ 不妨/ 令/ G/ (/ Δ/ 1t/ ,/ …/ ,/ Δ/ zt/ )/ =/ ω/ ∏/ zG/ (/ Δ/ 1t/ ,/ …/ ,/ Δ/ zt/ )/ 的/ 极值/ 即可/ 转换/ 为/ 求解/ 如下/ 的/ 方程组/ :/ Page12l/ =/ 1/ Δ/ 1t/ ∏/ z/ Δ/ 2t/ ∏/ z/ Δ/ zt/ ∏/ zl/ =/ 1l/ =/ 1/ 求解/ 上述/ 方程组/ 并/ 对/ 结果/ 取整/ 后/ 即可/ 得到/ Δ/ 1t/ ,/ …/ ,/ Δ/ zt/ 的/ 最优/ 值/ ./ 7/ 实验/ 为了/ 验证/ VQuery/ 的/ 有效性/ ,/ 本文/ 将/ VQuery/ 与/ 已有/ 工作/ (/ 包括/ SafeQ/ -/ bloom/ [/ 11/ ]/ 、/ SafeQ/ -/ basic/ [/ 11/ ]/ 、/ S/ &/ Lscheme/ [/ 8/ ]/ )/ 进行/ 详细/ 的/ 比较/ ./ 我们/ 在/ OMnet/ ++/ 平台/ 上/ 实现/ 了/ VQuery/ 、/ SafeQ/ 与/ S/ &/ Lscheme/ ./ 并/ 采用/ 平均/ 通信/ 开销/ 和/ 存储空间/ 开销/ 两个/ 指标/ 来/ 评估/ 实验/ 结果/ ,/ 为了/ 增强/ 实验/ 结果/ 的/ 可信性/ ,/ 本文/ 仍/ 采用/ SafeQ/ [/ 11/ ]/ 与/ S/ &/ Lscheme/ [/ 8/ ]/ 所/ 使用/ 的/ 测试数据/ 集/ ,/ 该/ 数据/ 集是/ 由/ IntelLab/ 部署/ 的/ 具有/ 44/ 个/ 节点/ 的/ 真实/ 传感器/ 网络/ ,/ 在/ 2004/ 年/ 1/ 月/ 3/ 日至/ 2004/ 年/ 3/ 月/ 10/ 日/ 期间/ 内所/ 采集/ 的/ 数据/ ,/ 并且/ 每个/ 节点/ 同时/ 采集/ 了/ 3/ 个/ 方面/ 的/ 数据/ 即/ :/ 温度/ 、/ 湿度/ 与/ 电压/ ./ 为了/ 得到/ 不同/ 维度/ 的/ 测试数据/ ,/ 仿照/ SafeQ/ ,/ 取/ 温度/ 数据/ 作为/ 一维/ 数据/ 集/ ,/ 取/ 温度/ 和/ 湿度/ 作为/ 二维/ 测试数据/ 集/ ,/ 取/ 温度/ 、/ 湿度/ 和/ 电压/ 则/ 作为/ 三维/ 测试数据/ 集/ ./ 本文/ 采用/ 两种/ 方案/ 与/ SafeQ/ 与/ S/ &/ Lscheme/ 进行/ 比较/ :/ 方案/ 1/ ,/ 采用/ 与/ SafeQ/ 相同/ 的/ 网络拓扑/ ,/ 即将/ 44/ 个/ 传感器/ 分成/ 4/ 个组/ ,/ 每个/ 组内/ 有/ 11/ 个/ 传感/ 节点/ 和/ 一个/ 存储/ 节点/ ;/ 方案/ 2/ ,/ 将/ 44/ 个/ 传感器/ 作为/ 一个组/ ,/ 所有/ 传感器/ 采集/ 的/ 数据/ 提交/ 到/ 一个/ 存储/ 节点/ 上/ ./ 在/ VQuery/ 协议/ 的/ 实现/ 中/ ,/ 参数/ Δ/ t/ 的/ 取值/ 直接/ 影响/ 能量/ 开销/ 和/ 查询/ 结果/ 的/ 精确度/ 问题/ ./ 为了/ 进一步/ 验证/ 和/ 直观/ 化/ 6.3/ 节中/ 的/ 分析/ 结果/ ,/ 本文/ 对/ 该/ 参数/ 进行/ 了/ 实验/ ./ 为/ 便于/ 分析/ ,/ 本文/ 考虑/ 一维/ 数据/ 在/ 时隙/ time/ -/ slot/ =/ 1/ 情形/ 下/ 的/ 查询/ 结果/ ./ 图/ 5/ (/ a/ )/ 是/ 参数/ Δ/ t/ 和/ 查询/ 结果/ 精度/ 的/ 关系/ ./ 如图所示/ ,/ 随着/ Δ/ t/ 的/ 不断/ 增大/ ,/ 区间/ 划分/ 也/ 不断/ 增大/ ,/ 此时/ 查询/ 精度/ 逐渐/ 下降/ ./ Δ/ t/ =/ 1/ 时/ ,/ 即/ 每个/ 区间/ 至多/ 只/ 存在/ 一个/ 数据/ ,/ 查询/ 精度/ 为/ 100/ %/ ,/ 不/ 存在/ 任何/ 假/ 阳性/ 数据/ ./ Δ/ t/ =/ 20/ 时/ ,/ 查询/ 精度/ 为/ 99.21/ %/ ./ Δ/ t/ =/ 80/ 时/ ,/ 查询/ 精度/ 下降/ 比较/ 明显/ ,/ 为/ 94.13/ %/ ./ 图/ 5/ (/ b/ )/ 是/ 传感器/ 节点/ 和/ 存储/ 节点/ 的/ 总/ 传输/ 能/ dln/ -/ dl1/ Δ/ lt/ +/ ndln/ -/ dl1/ Δ/ lt/ +/ ndln/ -/ dl1/ Δ/ lt/ +/ n/ 耗/ 和/ 参数/ Δ/ t/ 的/ 关系/ ./ 根据/ 6.3/ 节/ 数学模型/ 中/ 的/ 分析/ ,/ 随着/ Δ/ t/ 的/ 增大/ ,/ 区间/ 划分/ 变/ 大/ ,/ 编码/ 信息量/ 减少/ ,/ 因此/ 传感器/ 节点/ 的/ 传输/ 能耗/ 会/ 不断/ 减少/ ./ 但/ 随着/ 区间/ 划分/ 增大/ ,/ 存储/ 节点/ 传输/ 的/ 查询/ 结果/ 中/ 包含/ 的/ 假/ 阳性/ 数据/ 会/ 逐渐/ 增多/ ,/ 因此/ 传输/ 能耗/ 增大/ ./ 图/ 5/ (/ b/ )/ 中/ 反映/ 的/ 是/ 两者/ 的/ 总/ 能耗/ ./ 在/ 参数/ Δ/ t/ 实验/ 的/ 基础/ 上/ ,/ 在/ 接下来/ 的/ VQuery/ 协议/ 实现/ 的/ 过程/ 中/ ,/ 采用/ 了/ 使/ 总/ 能耗/ 最小/ 的/ Δ/ t/ 值/ ,/ 并/ 根据/ 该值/ 划分/ 区间/ ,/ 将/ 节点/ 所/ 采集/ 的/ 数据/ 分配/ 致/ 相应/ 的/ 区间/ ,/ 然后/ 根据/ 5.1/ 节/ 的/ 方法/ 构建/ 一棵/ 完全/ 多维/ 区间/ 树/ (/ CMDRT/ )/ ,/ 并/ 利用/ 构造/ 的/ 隐私/ 保护/ 函数/ 对/ 每个/ 区间/ 的/ 起始值/ 与/ 终止/ 值/ 进行/ 编码/ ,/ 并/ 按/ 4.2/ ./ 1/ 节/ 的/ 方法/ 为/ 每个/ 区间/ 内/ 的/ 数据/ 生成/ 和/ 嵌入/ 水印/ (/ 每个/ 区间/ 的/ 水印/ 位为/ 29bit/ )/ ./ 在/ 实验/ 中/ ,/ 我们/ 选用/ DES/ 作为/ 加密算法/ ,/ 每个/ 密文/ 块/ 的/ 大小/ 为/ 64bit/ ,/ 每个/ 周期/ 的/ 大小/ 设为/ 10min/ ~/ 80min/ ,/ 在/ 一个/ 周期/ 内/ 让/ Sink/ 随机/ 地/ 产生/ 1000/ 个/ 范围/ 查询/ ./ SafeQ/ 与/ S/ &/ Lscheme/ 的/ 实现/ 我们/ 分别/ 参考/ 了/ 文献/ [/ 11/ ]/ 和/ 文献/ [/ 8/ ]/ ./ 实验/ 结果表明/ 本文/ 所/ 提出/ 的/ VQuery/ 协议/ 在/ 通信/ 能量/ 开销/ 与/ 存储空间/ 开销/ 方面/ 均/ 优于/ SafeQ/ -/ bloom/ 、/ SafeQ/ -/ basic/ 与/ S/ &/ Lscheme/ ./ 采用/ 方案/ 1/ 得到/ 的/ 详细/ 数据/ 如下/ :/ (/ 1/ )/ 存储/ 节点/ 的/ 存储空间/ 开销/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 5.84/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 12.23/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 5.71/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 的/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.43/ 倍/ ,/ 比/ Safe/ -/ basicPage13/ 小/ 11.50/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 45.14/ 倍/ ;/ 三维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 的/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.90/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 9.96/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 656.12/ 倍/ ./ (/ 2/ )/ 传感器/ 的/ 通信/ 能量/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 5.72/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 12.1/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 5.71/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.39/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 11.44/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 45.06/ 倍/ ;/ 三维/ 数据/ 的/ 测试表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.83/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 9.81/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 657.25/ 倍/ ./ (/ 3/ )/ 存储/ 节点/ 提交/ 查询/ 结果/ 的/ 通信/ 能量/ 开销/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.86/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 9.33/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 4.06/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.43/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 7.89/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 21.53/ 倍/ ;/ 三维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.93/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 7.54/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 192.55/ 倍/ ./ 采用/ 方案/ 2/ 得到/ 的/ 详细/ 数据/ 如下/ :/ (/ 1/ )/ 存储/ 节点/ 的/ 存储空间/ 开销/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 4.38/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 16.59/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 7.36/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 的/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 4.16/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 15.95/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 68.88/ 倍/ ;/ 三维/ 数据/ 图/ 6/ 一个/ 传感器/ 在/ 数据/ 提交/ 阶段/ 的/ 平均/ 通信/ 能量/ 开销/ (/ 方案/ 1/ )/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 的/ 存储空间/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.64/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 12.85/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 691.323/ 倍/ ./ (/ 2/ )/ 传感器/ 的/ 通信/ 能量/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.39/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 11.25/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 1.46/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 1.47/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 8.06/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 47.66/ 倍/ ;/ 三维/ 数据/ 的/ 测试表明/ ,/ 传感器/ 在/ VQuery/ 协议/ 中/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 2.24/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 13.35/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 796.28/ 倍/ ./ (/ 3/ )/ 存储/ 节点/ 提交/ 查询/ 结果/ 的/ 通信/ 能量/ 开销/ ./ 一维/ 数据/ 的/ 测试/ 情况/ 表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.63/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 9.41/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 4.98/ 倍/ ;/ 二维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.09/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 6.73/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 31.25/ 倍/ ;/ 三维/ 数据/ 的/ 测试表明/ ,/ 存储/ 节点/ 在/ VQuery/ 协议/ 中/ 提交/ 查询/ 结果/ 时/ 的/ 通信/ 能量/ 开销/ 比/ SafeQ/ -/ bloom/ 协议/ 小/ 3.94/ 倍/ ,/ 比/ Safe/ -/ basic/ 小/ 4.21/ 倍/ ,/ 比/ S/ &/ Lscheme/ 小/ 236.79/ 倍/ ./ 图/ 6/ ~/ 图/ 8/ 是/ 在/ 方案/ 1/ 下/ 得到/ 的/ 实验/ 结果/ ;/ 图/ 9/ ~/ 图/ 11/ 是/ 在/ 方案/ 2/ 下/ 得到/ 的/ 实验/ 结果/ ./ 图/ 6/ (/ a/ )/ 、/ 图/ 7/ (/ a/ )/ 、/ 图/ 9/ (/ a/ )/ 、/ 图/ 10/ (/ a/ )/ 分别/ 描绘/ 了/ VQuery/ 、/ SafeQ/ -/ bloom/ 、/ SafeQ/ -/ basic/ 与/ S/ &/ L4/ 个/ 协议/ 在/ 一维/ 测试数据/ 集/ 的/ 情况/ 下/ ,/ 一个/ 传感器/ 与/ 存储/ 节点/ 在/ 不同/ 长度/ 的/ 周期/ 内/ 的/ 平均/ 通信/ 能耗/ 情况/ ;/ 类似/ 地/ ,/ 图/ 6/ (/ b/ )/ 、/ 图/ 7/ (/ b/ )/ 、/ 图/ 9/ (/ b/ )/ 、/ 图/ 10/ (/ b/ )/ 则/ 描述/ 的/ 是/ 二维/ 测试数据/ 集/ 的/ 情况/ 下/ 一个/ 传感器/ 与/ 存储/ 节点/ 平均/ 通信/ 能耗/ 情况/ ,/ 图/ 6/ (/ c/ )/ 、/ 图/ 7/ (/ c/ )/ 、/ 图/ 9/ (/ c/ )/ 、/ 图/ 10/ (/ c/ )/ 则/ Page14/ 图/ 7/ 一个/ 存储/ 节点/ 在/ 回复/ 查询/ 结果/ 时/ 的/ 平均/ 通信/ 能量/ 开销/ (/ 方案/ 1/ )/ 图/ 8/ 一个/ 存储/ 节点/ 的/ 平均/ 存储空间/ 开销/ (/ 方案/ 1/ )/ 图/ 9/ 一个/ 传感器/ 在/ 数据/ 提交/ 阶段/ 的/ 平均/ 通信/ 能量/ 开销/ (/ 方案/ 2/ )/ 图/ 10/ 一个/ 存储/ 节点/ 在/ 回复/ 查询/ 结果/ 时/ 的/ 平均/ 通信/ 能量/ 开销/ (/ 方案/ 2/ )/ 图/ 11/ 一个/ 存储/ 节点/ 的/ 平均/ 存储空间/ 开销/ (/ 方案/ 2/ )/ Page15/ 描述/ 的/ 是/ 三维/ 测试数据/ 集/ 的/ 情况/ 下/ ,/ 一个/ 传感器/ 与/ 存储/ 节点/ 平均/ 通信/ 能耗/ 情况/ ./ 图/ 8/ (/ a/ )/ ~/ (/ c/ )/ 和/ 图/ 11/ (/ a/ )/ ~/ (/ c/ )/ 分别/ 描绘/ 了/ 在/ 方案/ 1/ 和/ 方案/ 2/ 下/ VQuery/ 、/ SafeQ/ -/ bloom/ 、/ SafeQ/ -/ basic/ 与/ S/ &/ L4/ 个/ 协议/ 中/ 存储/ 节点/ 在/ 一/ 、/ 二/ 、/ 三维/ 测试数据/ 集/ 情况/ 下/ 的/ 存储空间/ 开销/ (/ 注/ :/ 图/ 6/ (/ c/ )/ ,/ 图/ 7/ (/ c/ )/ ,/ 8/ (/ b/ )/ ,/ 图/ 8/ (/ c/ )/ ,/ 图/ 9/ (/ c/ )/ ,/ 图/ 10/ (/ c/ )/ ,/ 图/ 11/ (/ b/ )/ ,/ 图/ 11/ (/ c/ )/ 的/ 纵坐标/ 采用/ 的/ 是/ 对数/ 坐标/ )/ ./ 本文/ 提出/ 的/ 方案/ 在/ 进行/ 数据完整性/ 认证/ 方面/ 采用/ 区间/ 信息/ 与/ 水印/ 技术相结合/ 的/ 办法/ ,/ 水印/ 嵌入/ 不/ 需要/ 增加/ 额外/ 的/ 空间/ ,/ 提出/ 的/ MDRT/ 树/ 在/ 空/ 区间/ 合并/ 上/ 具有/ 很/ 高/ 的/ 效率/ ,/ 能/ 有效/ 地/ 减少/ 区间/ 的/ 个数/ ,/ 从而/ 降低/ 了/ 验证/ 信息量/ ,/ 实验/ 结果/ 也/ 体现/ 了/ 这/ 一/ 方案/ 的/ 有效性/ ./ 8/ 结束语/ 本文/ 提出/ 了/ 一种/ 针对/ 两层/ 结构/ 传感器/ 网络/ 的/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ 协议/ :/ VQuery/ ,/ 该/ 协议/ 能/ 让/ 存储/ 节点/ 正确/ 地/ 处理/ 查询/ 的/ 同时/ 也/ 能/ 有效/ 地/ 保护/ 数据/ 的/ 隐私/ 性/ 与/ 查询/ 结果/ 的/ 完整性/ ./ 为了/ 实现/ 保护/ 数据/ 的/ 隐私/ 性/ ,/ 提出/ 了/ 一种/ 基于/ 多项式/ 技术/ 的/ 隐私/ 保护/ 方案/ ,/ 对/ 区间/ 信息/ 与/ 查询/ 条件/ 进行/ 编码/ ,/ 能/ 使/ 存储/ 节点/ 在/ 不/ 知道/ 查询/ 条件/ 与/ 待/ 查询/ 数据/ 真实/ 值/ 的/ 情况/ 下/ 正确/ 执行/ 查询处理/ ./ 为了/ 保护/ 数据/ 的/ 完整性/ ,/ 提出/ 了/ 一种/ 基于/ 水印/ 链/ 技术/ 的/ 完整性/ 保护/ 方案/ ,/ 该/ 方案/ 通过/ 在/ 数据/ 中/ 嵌入/ 水印/ 信息/ 后/ 使/ 数据/ 形成/ 一条/ 或/ 多条/ 链/ ,/ 因此/ 能/ 有效/ 地/ 验证/ 一维/ 或/ 多维/ 查询/ 结果/ 的/ 完整性/ ./ 为了/ 实现/ 多维/ 数据/ 的/ 隐私/ 与/ 完整性/ 保护/ 的/ 范围/ 查询/ ,/ 提出/ 了/ 一种/ 多维/ 区间/ 树/ 的/ 数据结构/ ,/ 该/ 结构/ 能/ 有效/ 地/ 表示/ 多维/ 数据/ ./ 为了/ 验证/ VQuery/ 协议/ 的/ 有效性/ ,/ 本文/ 利用/ IntelLab/ 提供/ 的/ 真实/ 数据/ 对/ 协议/ 进行/ 测试/ ,/ 实验/ 结果表明/ 在/ 一/ 维和/ 多维/ 情况/ ,/ VQuery/ 都/ 比/ SafeQ/ -/ basic/ 、/ SafeQ/ -/ bloom/ 和/ S/ &/ L/ 具有/ 更/ 低/ 的/ 通信/ 能量/ 与/ 存储空间/ 开销/ ./ 

