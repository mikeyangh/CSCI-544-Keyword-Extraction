Page1/ 基于/ 属性/ 的/ 可/ 搜索/ 加密/ 方案/ 李双/ 1/ )/ 徐茂智/ 2/ )/ 1/ )/ (/ 北京工商大学/ 理学院/ 北京/ 100048/ )/ 2/ )/ (/ 北京大学/ 数学/ 科学/ 学院/ 北京/ 100871/ )/ 摘要/ 2004/ 年/ ,/ Boneh/ 等/ 人/ 利用/ 匿名/ 的/ 基于/ 身份/ 的/ 加密/ 方案/ 构造/ 了/ 一个/ 公钥/ 可/ 搜索/ 加密/ 方案/ (/ PEKS/ )/ ,/ 解决/ 了/ 特定/ 环境/ 下/ 对/ 加密/ 数据/ 进行/ 检索/ 的/ 这/ 一/ 困难/ 问题/ ./ 已有/ 的/ 可/ 搜索/ 加密/ 方案/ ,/ 通信/ 模式/ 往往/ 是/ 一对一/ 的/ ,/ 关键词/ 密文/ 也/ 只能/ 被/ 特定/ 的/ 单个/ 用户/ 查询/ 或/ 解密/ ,/ 这样/ 的/ 通讯/ 模式/ 在/ 实际/ 的/ 系统/ 中有/ 很多/ 局限性/ ./ 作者/ 首次/ 给出/ 了/ 基于/ 属性/ 的/ 可/ 搜索/ 方案/ (/ ATT/ -/ PEKS/ )/ 的/ 定义/ 和/ 构造/ 算法/ ./ 此/ 方案/ 与/ PEKS/ 的/ 不同之处/ 在于/ 基于/ 属性/ 的/ 可/ 搜索/ 方案/ 是/ 适应/ 群组/ 的/ 公钥/ 加密/ 搜索/ 方案/ ,/ 扩大/ 了/ 信息/ 的/ 共享性/ ,/ 节省/ 了/ 第三方/ 信息/ 存储/ 的/ 空间/ ./ 作者/ 同时/ 对此/ 方案/ 进行/ 了/ 一致性/ 分析/ 和/ 安全性/ 证明/ ./ 关键词/ 可/ 搜索/ 加密/ ;/ 基于/ 属性/ 的/ 加密/ ;/ 双线性/ Diffie/ -/ Hellman/ 问题/ ;/ 安全性/ 证明/ ;/ 信息安全/ ;/ 网络安全/ 1/ 引言/ 在/ 网络/ 迅猛发展/ 、/ 信息/ 爆炸/ 的/ 今天/ ,/ 为了/ 能/ 快速/ 查询/ 到/ 所/ 需要/ 的/ 信息/ ,/ 搜索/ 工具/ 变得/ 异常/ 重要/ ,/ 如/ Google/ 、/ 百度/ 已/ 成为/ 我们/ 日常/ 学习/ 、/ 生活/ 的/ 工具/ ./ 如何/ 使得/ 搜索/ 安全/ 是/ 一个/ 重要/ 的/ 问题/ ,/ 于是/ 一些/ 关于/ 加密/ 数据/ 的/ 搜索/ 技术/ 应运而生/ ./ 2004/ 年/ ,/ Boneh/ 等/ Page2/ 人/ [/ 1/ ]/ 利用/ 匿名/ 的/ 基于/ 身份/ 的/ 加密/ 方案/ 构造/ 了/ 一个/ 公钥/ 可/ 搜索/ 加密/ 方案/ (/ PEKS/ )/ ,/ 该/ 方案/ 是/ 针对/ 在/ 加密/ 的/ 邮件系统/ 中/ 邮件/ 网关/ 搜索/ 带/ 特定/ 关键词/ 邮件/ 的/ 应用/ 场景/ 而/ 提出/ 的/ ./ 独立/ 于/ 文献/ [/ 1/ ]/ 中/ 的/ 工作/ ,/ Waters/ 等/ 人/ 基于/ 文献/ [/ 2/ ]/ 提出/ 了/ 一个/ 针对/ 加密/ 的/ 审计/ 日志/ 进行/ 检索/ 的/ 公钥/ 加密/ 方案/ [/ 3/ ]/ ./ Park/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ 两个/ 支持/ 逻辑/ “/ 与/ ”/ 的/ 检索/ 功能/ 的/ 可/ 搜索/ 公钥/ 加密/ 方案/ ./ 2005/ 年/ ,/ Abdalla/ 等/ 人/ [/ 5/ ]/ 对公/ 钥可/ 搜索/ 加密/ 方案/ 的/ 一致性/ 进行/ 了/ 重新/ 定义/ ,/ 将/ 其/ 划分/ 为/ 计算/ 的/ 、/ 统计/ 的/ 和/ 完美/ 的/ 三个/ 类别/ ./ 随后/ ,/ 他们/ 给出/ 了/ 将/ 匿名/ 的/ 基于/ 身份/ 的/ 加密/ 方案/ 转化/ 为/ 具有/ 计算/ 一致性/ 的/ 可/ 搜索/ 公钥/ 加密/ 方案/ 的/ 通用/ 方法/ ,/ 并/ 基于/ Boyen/ 和/ Waters/ [/ 6/ ]/ 的/ 匿名/ 的/ 基于/ 层级/ 身份/ 的/ 加密/ 方案/ 在/ 标准/ 模型/ 中/ 提出/ 了/ 一个/ 基于/ 身份/ 的/ 可/ 搜索/ 加密/ 方案/ 的/ 一般/ 定义/ ,/ 但/ 没有/ 给出/ 具体/ 的/ 算法/ ./ 2010/ 年/ ,/ Li/ 等/ 人/ [/ 7/ ]/ 针对/ 云/ 计算环境/ 提出/ 了/ 一个/ 基于/ 通配符/ 的/ 模糊/ 的/ 可/ 搜索/ 公钥/ 加密/ 方案/ ./ 2011/ 年/ ,/ Cao/ 等/ 人/ [/ 8/ ]/ 提出/ 了/ 一个/ 可以/ 同时/ 对/ 多个/ 关键词/ 进行/ 检索/ 的/ 可/ 搜索/ 公钥/ 加密/ 方案/ ./ 已有/ 可/ 搜索/ 加密/ 方案/ 大都/ 是/ 针对/ 关键词/ 密文/ 与/ 查询/ 方/ 之间/ 的/ 关系/ 是/ 一对一/ 的/ 情形/ ,/ 在/ 越来越/ 多/ 的/ 信息/ 共享/ 的/ 大/ 背景/ 下/ ,/ 这些/ 方案/ 显然/ 不/ 适合/ 关键词/ 可/ 被/ 多方/ 查询/ 的/ 需求/ ./ 比如/ 数字电视/ 、/ 视频点播/ 、/ 个人/ 微博/ 、/ 个人/ 藏品/ 展示/ 等/ 都/ 可以/ 存储/ 在/ 如/ Google/ 或/ Yahoo/ 这样/ 的/ 第三方/ 服务器/ 上/ ,/ 此时/ 数据/ 与/ 接收/ 方是/ 一对/ 多/ 的/ 关系/ ,/ 也就是说/ 数据/ 可以/ 被/ 多个/ 用户/ 进行/ 查询/ ,/ 传统/ 的/ 可/ 搜索/ 加密/ 方案/ 只能/ 解决/ 数据/ 被/ 唯一/ 对应/ 用户/ 查询/ 访问/ 的/ 问题/ ./ 此时/ 当/ 加密/ 方/ 想要/ 将/ 一个/ 信息/ 和/ 对应/ 的/ 关键词/ 让/ 目标/ 的/ 一群/ 人/ 得以/ 分享/ ,/ 以/ 现在/ 的/ 系统/ 只能/ 针对/ 每/ 一个/ 人/ 的/ 私钥/ 进行/ 加密/ ,/ 将/ 不同/ 的/ 机密/ 结果/ 在/ 公共信道/ 传送/ 至/ 对应/ 的/ 人群/ ./ 查询/ 者/ 先是/ 根据/ 关键词/ 查询/ 到/ 一些/ 相关/ 信息/ ,/ 然后/ 再/ 将/ 对应/ 消息/ 解密/ ./ 在/ 这种/ 情况/ 下用/ 已有/ 的/ 可/ 搜索/ 加密/ 方案/ 进行/ 查询/ ,/ 无论是/ 在/ 效率/ 上/ 还是/ 实际/ 应用/ 都/ 是/ 难以/ 让/ 人/ 满意/ 的/ ./ 基于/ 属性/ 的/ 加密/ 体制/ (/ ABE/ )/ [/ 9/ ]/ ,/ 2005/ 年/ 首次/ 被/ 提出/ ./ 在/ 这种/ 加密/ 体制/ 中/ 加密/ 者/ 无需/ 知道/ 每个/ 解密/ 者/ 的/ 具体/ 身份/ 信息/ ,/ 而/ 只/ 需要/ 掌握/ 解密/ 者/ 一系列/ 描述/ 的/ 属性/ ,/ 然后/ 在/ 加密/ 过程/ 中/ 用/ 属性/ 定义/ 访问/ 结构/ 对/ 消息/ 进行/ 加密/ ,/ 当/ 用户/ 的/ 密钥/ 满足/ 这个/ 访问/ 结构/ 时/ 就/ 可以/ 解密/ 该/ 密文/ ./ 因此/ 我们/ 利用/ 基于/ 属性/ 的/ 加密/ 方案/ 可以/ 实现/ 一对/ 多/ 的/ 通信/ 特性/ 提出/ 基于/ 属性/ 的/ 可/ 搜索/ 加密/ 方案/ ,/ 给出/ 了/ 一般/ 定义/ 、/ 具体/ 算法/ 构造/ 、/ 复杂度/ 分析/ 和/ 安全性/ 分析/ ./ 基于/ 属性/ 的/ 可/ 搜索/ 加密/ 方案/ 与/ 基于/ 身份/ 的/ 可/ 搜索/ 加密/ 方案/ 相比/ ,/ 解除/ 了/ 关键词/ 密文/ 只能/ 被/ 唯一/ 用户/ 正确/ 查询/ 的/ 限制/ ,/ 使得/ 关键词/ 密文/ 可以/ 被/ 多个/ 用户/ 共享/ 检索/ ,/ 节省/ 了/ 网络/ 存储空间/ ,/ 提高/ 了/ 检索/ 效率/ ,/ 特别/ 适合/ 网络/ 迅猛发展/ 下/ 的/ 各种/ 应用/ ./ 2/ 基础知识/ G2/ 群/ 的/ 单位/ ./ 设/ p/ ,/ q/ 是/ 素数/ ,/ G1/ 和/ G2/ 分别/ 是/ 阶为/ p/ ,/ q/ 的/ 乘法/ 循环群/ ./ 称/ 映射/ e/ :/ G1/ ×/ G1/ →/ G2/ 为/ 一个/ 双线性/ 对/ ,/ 如果/ 映射/ e/ 满足/ 下述/ 性质/ [/ 10/ ]/ :/ (/ 1/ )/ 双线性/ (/ Bilinear/ )/ 对于/ 任意/ a/ ,/ b/ ∈/ Zp/ 和/ x/ ,/ y/ ∈/ G1/ ,/ 都/ 有/ 对于/ 任意/ x1/ ,/ x2/ ,/ y/ ∈/ G1/ ,/ 有/ 对于/ 任意/ x/ ,/ y1/ ,/ y2/ ∈/ G1/ ,/ 有/ (/ 2/ )/ 非/ 退化/ 性/ (/ Non/ -/ degenerate/ )/ 存在/ x/ ,/ y/ ∈/ G1/ ,/ 使得/ e/ (/ x/ ,/ y/ )/ ≠/ 1G2/ ./ 这里/ 1G2/ 代表/ (/ 3/ )/ 可计算性/ (/ Computable/ )/ 存在/ 有效/ 的/ 多项式/ 时间/ 算法/ 对/ 任意/ 的/ x/ ,/ y/ ∈/ G1/ ,/ 计算/ e/ (/ x/ ,/ y/ )/ 的/ 值/ ./ 在/ 群/ G1/ 上/ ,/ 作为/ 密码学/ 的/ 安全/ 假设/ ,/ 有/ 以下/ 几个/ 密码学/ 困难/ 问题/ ./ 定义/ 1/ ./ 计算/ Diffie/ -/ Hellman/ 问题/ (/ CDH/ )/ :/ 给定/ 三元组/ (/ g/ ,/ ga/ ,/ gb/ )/ ,/ 其中/ a/ ,/ b/ ∈/ Zp/ 且/ 未知/ ,/ g/ 为/ 循环群/ G1/ 的/ 一个/ 生成元/ ,/ 计算/ gab/ 的/ 值/ ./ 定义/ 2/ ./ 判定/ Diffie/ -/ Hellman/ 问题/ (/ DDH/ )/ :/ 给定/ 四元组/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ )/ ,/ 其中/ a/ ,/ b/ ,/ c/ ∈/ Zp/ 且/ 未知/ ,/ g/ 为/ 循环群/ G1/ 的/ 一个/ 生成元/ ,/ 判定/ c/ =/ ab/ (/ modp/ )/ 是否/ 成立/ ./ 定义/ 3/ ./ 双线性/ Diffie/ -/ Hellman/ 问题/ [/ 6/ ]/ (/ BDH/ )/ :/ 给定/ 四元组/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ )/ ,/ 其中/ a/ ,/ b/ ,/ c/ ∈/ Zp/ 且/ 未知/ ,/ 计算/ e/ (/ g/ ,/ g/ )/ abc/ ∈/ G2/ ./ 定义/ 4/ ./ 判定/ 双线性/ Diffie/ -/ Hellman/ 问题/ (/ DBDH/ )/ :/ 给定/ 五元/ 组/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ r/ )/ ,/ 其中/ a/ ,/ b/ ,/ c/ ∈/ Zp/ 且/ 未知/ ,/ r/ ∈/ G2/ ,/ g/ 为/ 循环群/ G1/ 的/ 一个/ 生成元/ ,/ 判定/ 是否/ r/ =/ e/ (/ g/ ,/ g/ )/ abc/ ./ 目前/ 仍/ 未有/ 解决/ BDH/ 的/ 有效/ 算法/ ,/ 所以/ 普遍认为/ BDH/ 是/ 一个/ 困难/ 问题/ ./ 定义/ 5/ ./ 访问/ 结构/ [/ 10/ ]/ (/ AccessStructure/ )/ :/ 一个/ 实体/ 集/ P/ =/ {/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ }/ ,/ 对于/ A/ / 2P/ 是/ 2P/ 上/ Page3/ 的/ 一个/ 非/ 空子/ 集/ ,/ / B/ ,/ C/ ,/ 如果/ 当/ B/ ∈/ A/ 且/ B/ / C/ 时/ ,/ 则/ 有/ C/ ∈/ A/ ,/ 那么/ 称/ 集合/ A/ / 2P/ 是/ 单调/ 的/ ./ 一个/ 访问/ 结构/ A/ (/ 通常/ 是/ 指/ 单调/ 的/ 访问/ 结构/ )/ 是/ P/ =/ {/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ }/ 的/ 一个/ 非/ 空子/ 集合/ ,/ 即/ A/ / 2P/ \/ {/ Φ/ }/ ./ 包含/ 于/ A/ 中/ 的/ 集合/ 称为/ 授权/ 集合/ (/ AuthorizedSet/ )/ ,/ 而/ 不/ 包含/ 在/ A/ 中/ 的/ 集合/ 称为/ 非/ 授权/ 集合/ (/ Non/ -/ AuthorizedSet/ )/ ./ 定义/ 6/ ./ Υ/ 表示/ 一棵/ 访问/ 树/ ,/ 树中/ 每个/ 非/ 叶子/ 节点/ 表示/ 的/ 是/ 一个/ 由子/ 节点/ 和/ 阈值/ 所/ 描述/ 的/ 门限/ ./ 假设/ numx/ 表示/ 节点/ x/ 的/ 子/ 节点/ 数目/ ,/ kx/ 表示/ 节点/ x/ 的/ 阈值/ ,/ 则/ 有/ 0/ </ kx/ / numx/ ./ 当/ kx/ =/ 1/ 时/ ,/ 门限/ 表示/ “/ 或/ ”/ 门/ ,/ 而/ 当/ kx/ =/ numx/ ,/ 时/ ,/ 它/ 表示/ “/ 与/ ”/ 门/ ./ 另外/ ,/ 树中/ 的/ 叶子/ 节点/ 可以/ 认为/ 是/ 一个/ 属性/ 且/ 阈值/ kx/ =/ 1/ ./ 为了/ 简化/ 对/ 访问/ 树/ 的/ 操作/ ,/ 定义/ 了/ 一些/ 函数/ ./ 函数/ parent/ (/ x/ )/ 表示/ 节点/ x/ 的/ 父/ 节点/ ./ 如果/ x/ 是/ 叶子/ 节点/ ,/ 则/ att/ (/ x/ )/ 表示/ 与子/ 节点/ x/ 关联/ 起来/ 的/ 属性/ 值/ ./ 访问/ 树/ Υ/ 对/ 每个/ 节点/ 的/ 子/ 节点/ 进行/ 编号/ ,/ 即子/ 节点/ 的/ 编号/ 是从/ l/ 到/ num/ ,/ 而/ 函数/ index/ (/ x/ )/ 返回/ 节点/ x/ 的/ 编号/ ./ 满足/ 访问/ 树/ :/ 令/ r/ 表示/ Υ/ 的/ 根/ 节点/ ,/ 而/ Υ/ x/ 表示/ 是/ 访问/ 树/ Υ/ 中以/ x/ 为根/ 的/ 子树/ ,/ 因此/ Υ/ 也/ 可以/ 表示/ 为/ Υ/ r/ ./ Υ/ x/ (/ γ/ )/ =/ 1/ 表示/ 属性/ 集合/ γ/ 满足/ 访问/ 树/ Υ/ x/ ./ 我们/ 可以/ 通过/ 以下/ 方式/ 递归/ 去/ 计算/ Υ/ x/ (/ γ/ )/ 的/ 值/ ./ 如果/ x/ 是/ 一个/ 非/ 叶子/ 节点/ ,/ 则/ 计算/ x/ 所有/ 子/ 节点/ x/ 的/ Υ/ x/ (/ γ/ )/ ,/ 当且/ 仅/ 当/ 有/ 至少/ kx/ 个子/ 节点/ 返回/ 1/ 时/ ,/ Υ/ x/ (/ γ/ )/ 返回/ 1/ ;/ 如果/ x/ 是/ 叶子/ 节点/ 并/ 当且/ 仅/ 当/ att/ (/ x/ )/ ∈/ γ/ ,/ 则/ Υ/ x/ (/ γ/ )/ 返回/ 1.3/ 基于/ 属性/ 可/ 搜索/ 加密/ 方案/ 的/ 定义/ 3.1/ ATT/ -/ PEKS/ 算法/ 定义/ 首先/ 给出/ 基于/ 属性/ 的/ 可/ 搜索/ 加密/ 方案/ (/ AttributeBasedPEKS/ ,/ 记为/ ATT/ -/ PEKS/ )/ 的/ 定义/ ./ ATT/ -/ PEKS/ 是/ 在/ 基于/ 属性/ 的/ 加密/ 方案/ (/ ABE/ )/ 的/ 基础/ 上/ 提出/ 来/ 的/ ,/ 基于/ 属性/ 的/ 可/ 搜索/ 加密/ 方案/ 引入/ 属性/ 的/ 概念/ ,/ 从而/ 使得/ 满足/ 相关/ 属性/ 的/ 用户/ 均/ 可以/ 对/ 加密/ 数据/ 进行/ 查询/ ,/ 不同于/ 基于/ 身份/ 的/ 可/ 搜索/ 加密/ ,/ 每个/ 关键词/ 密文/ 与/ 唯一/ 查询/ 用户/ 对应/ ./ 定义/ 7/ ./ 一个/ 基于/ 属性/ 的/ 可/ 搜索/ 加密算法/ ATT/ -/ PEKS/ 由/ 5/ 个/ 多项式/ 时间/ 随机/ 算法/ Setup/ 、/ KeyGen/ 、/ PEKS/ 、/ Trapdoor/ 、/ Test/ 组成/ :/ (/ 1/ )/ Setup/ (/ 1/ λ/ )/ :/ (/ Pub/ ,/ Msk/ )/ ←/ Setup/ (/ 1/ λ/ )/ 其中/ λ/ 是/ 系统/ 参数/ ./ Setup/ 是/ 由/ 系统/ 参数/ λ/ 生成/ 公共/ 参数/ Pub/ 和/ 主/ 密钥/ Msk/ 的/ 概率/ 多项式/ 算法/ ;/ (/ 2/ )/ KeyGen/ (/ Msk/ ,/ A/ )/ :/ PrivA/ ←/ KeyGen/ (/ Msk/ ,/ A/ )/ 密钥/ 生成/ 中心/ (/ KGC/ )/ 根据/ 访问/ 结构/ A/ 和/ 系统/ 主/ 密钥/ Msk/ 生成/ 用户/ 的/ 私钥/ PrivA/ ,/ 其中/ KeyGen/ 是/ 由/ 系统/ 主/ 密钥/ Msk/ 和/ 访问/ 结构/ 生成/ 用户/ 私钥/ 的/ 概率/ 多项式/ 算法/ ;/ (/ 3/ )/ PEKS/ (/ Pub/ ,/ w/ ,/ γ/ )/ :/ C/ ←/ PEKS/ (/ Pub/ ,/ w/ ,/ γ/ )/ 发送/ 方/ 利用/ 公共/ 参数/ Pub/ 和/ 属性/ γ/ 加密/ 关键词/ w/ ,/ 生成/ 可/ 搜索/ 关键词/ 的/ 密文/ C/ ,/ 只有/ 属性/ 满足/ 访问/ 结构/ 的/ 用户/ 才能/ 对/ 关键词/ 密文/ 进行/ 解密/ ./ 其中/ PEKS/ 是/ 由/ 系统/ 公共/ 参数/ Pub/ ,/ 关键词/ w/ 和/ 属性/ γ/ 生成/ 关键词/ 密文/ 的/ 概率/ 多项式/ 算法/ ;/ (/ 4/ )/ Trapdoor/ (/ PrivA/ ,/ w/ )/ :/ Tw/ ←/ Trapdoor/ (/ PrivA/ ,/ w/ )/ 接收/ 方/ 利用/ 个人/ 私钥/ PrivA/ 计算/ 查询/ 关键词/ w/ ∈/ {/ 0/ ,/ 1/ }/ / 的/ 门/ 限值/ Tw/ 发送给/ 网关/ 服务器/ ,/ 其中/ Trapdoor/ 是/ 由/ 用户/ 私钥/ PrivA/ 和/ 关键词/ w/ 生成/ 关键词/ 门限/ Tw/ 的/ 概率/ 多项式/ 算法/ ;/ (/ 5/ )/ Test/ (/ Pub/ ,/ Tw/ ,/ C/ )/ :/ b/ ←/ Test/ (/ Pub/ ,/ Tw/ ,/ C/ )/ 已知/ 公共/ 参数/ Pub/ ,/ 一个/ 关键词/ w/ 的/ 密文/ C/ =/ PEKS/ (/ Pub/ ,/ w/ ,/ γ/ )/ 和/ 关键词/ w/ 的/ 门/ 限值/ Tw/ =/ Trapdoor/ (/ PrivA/ ,/ w/ )/ ,/ 如果/ w/ =/ w/ ,/ 输出/ b/ =/ 1/ ,/ 否则/ b/ =/ 0/ ,/ 其中/ Test/ 是/ 判断/ 密文/ C/ 是否是/ 门限/ Tw/ 对应/ 关键词/ w/ 的/ 密文/ 的/ 概率/ 多项式/ 算法/ ./ 

