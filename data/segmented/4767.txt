Page1/ 基于/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 清洗/ 方法/ 杜岳峰/ 申德荣/ 聂铁铮寇/ 月/ 于/ 戈/ (/ 东北大学/ 计算机科学/ 与/ 工程学院/ 沈阳/ 110819/ )/ 摘要/ 数据/ 一致性/ 和/ 数据/ 时效性/ 是/ 大/ 数据/ 质量/ 管理所/ 关注/ 的/ 两个/ 重要/ 内容/ ./ 条件/ 函数/ 依赖/ (/ CFDs/ )/ 和/ 时效/ 约束/ (/ CCs/ )/ 分别/ 是/ 用于/ 分析/ 数据/ 一致性/ 和/ 数据/ 时效性/ 的/ 有效/ 技术手段/ ./ 现实生活/ 中/ 的/ 数据/ 会/ 夹杂/ 一些/ 关于/ 一致性/ 和/ 时效性/ 的/ 潜在/ 错误/ ,/ 这些/ 错误/ 又/ 无法/ 为/ CFDs/ 和/ CCs/ 检测/ 和/ 修复/ ,/ 最终/ 影响/ 数据/ 的/ 整体/ 质量/ ./ 值得一提的是/ ,/ 这些/ 数据/ 通常/ 是/ 相互/ 关联/ 的/ ,/ 这种/ 关联/ 关系/ 可以/ 用来/ 发现/ 数据/ 中/ 的/ 潜在/ 错误/ ./ 文中/ 使用/ 了/ 一种/ 条件/ 合并/ 的/ 函数/ 依赖/ (/ CCFDs/ )/ 将/ 关联/ 数据/ 放在/ 一起/ 进行/ 处理/ ./ 基于/ 此/ ,/ 该文/ 提出/ 了/ 一种/ 基于/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 清洗/ 方法/ ./ 在/ 数据/ 清洗/ 过程/ 中/ ,/ 数据/ 的/ 检测/ 和/ 修复/ 是/ 两个/ 相互影响/ 的/ 过程/ ./ 所以/ ,/ 该文/ 设计/ 了/ 一种/ 新/ 的/ 自动/ 清洗/ 框架/ ,/ 迭代/ 地/ 进行/ 数据/ 检测/ 和/ 数据/ 修复/ ./ 其次/ ,/ 该文/ 对/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 清洗/ 的/ 相关/ 问题/ 进行/ 了/ 分析/ ,/ 并且/ 证明/ 了/ 关于/ CCFDs/ 和/ CCs/ 的/ 最小/ 代价/ 修复/ 问题/ 是/ 一个/ Σ/ p/ 行/ 修复/ ./ 为了/ 提高/ 修复/ 的/ 准确性/ ,/ 该文/ 还/ 提出/ 了/ 一种/ 修复/ 序列图/ 的/ 概念/ ./ 最后/ ,/ 通过/ 在/ 两组/ 真实/ 数据/ 上/ 进行/ 实验/ ,/ 验证/ 了/ 方法/ 的/ 实用性/ 和/ 高效性/ ./ 关键词/ 数据/ 一致性/ ;/ 数据/ 时效性/ ;/ 大/ 数据/ 质量/ ;/ 关联/ 数据/ ;/ 数据/ 清洗/ 1/ 引言/ 数据/ 一致性/ 和/ 数据/ 时效性/ 是/ 大/ 数据/ 质量/ 管理/ 的/ 重要/ 事务/ [/ 1/ ]/ ./ 由/ 数据/ 一致性/ 和/ 数据/ 时效性/ 引发/ 的/ 数据/ 质量/ 问题/ 每年/ 都/ 会/ 给/ 社会/ 造成/ 巨大/ 的/ 经济损失/ ./ 2006/ 年/ ,/ 仅/ 信誉/ 卡/ 信息管理/ 一项/ 事务/ 中/ ,/ 由于/ 冲突/ 数据/ (/ 不/ 一致/ 数据/ )/ 造成/ 的/ 损失/ 就/ 高达/ 48/ 亿美元/ [/ 2/ ]/ ./ 在/ 美国/ ,/ 时效/ 错误/ 数据/ 占/ 企业/ 数据/ 总数/ 的/ 0.6/ %/ ~/ 18.5/ %/ [/ 2/ ]/ ./ 冲突/ 数据/ 和/ 时效/ 错误/ 数据/ 相/ 叠加/ 而/ 产生/ 的/ 错误/ 数据/ 将/ 更为严重/ ,/ 根据/ 德国/ 数据分析/ 机构/ 的/ 调查/ 显示/ :/ “/ 美国/ 每年/ 因为/ 劣质/ 数据/ 而/ 造成/ 的/ 损失/ 高达/ 6000/ 亿美元/ ”/ [/ 3/ ]/ ./ 所以/ ,/ 从/ 数据/ 一致性/ 和/ 时效性/ 着手/ 修复/ 错误/ 数据/ ,/ 提升/ 数据/ 质量/ ,/ 是/ 一个/ 非常/ 重要/ 的/ 问题/ ./ 在/ 处理/ 冲突/ 数据/ 和/ 时效/ 错误/ 数据/ 时/ ,/ 条件/ 函数/ 依赖/ CFDs/ [/ 4/ ]/ (/ ConditionalFunctionalDependencies/ )/ 以及/ 时效/ 约束/ CCs/ [/ 5/ ]/ (/ CurrencyConstraints/ )/ 都/ 是/ 进行/ 数据管理/ 的/ 有效/ 技术/ ./ 其中/ ,/ 条件/ 函数/ 依赖/ 可以/ 检测/ 某些/ 特定条件/ 下/ 的/ 冲突/ 数据/ ;/ 时效/ 约束/ 可以/ 对/ 时效/ 错误/ 数据/ 进行/ 检测/ ./ 进而/ ,/ 可以/ 将/ 条件/ 函数/ 依赖/ 和/ 时效/ 约束/ 混合/ 使用/ ,/ 解决/ 冲突/ 数据/ 和/ 时效/ 错误/ 数据/ 的/ 叠加/ 问题/ ./ 但是/ ,/ 数据/ 中/ 可能/ 会/ 夹杂/ 一些/ 关于/ 一致性/ 和/ 时效性/ 的/ 潜在/ 错误/ ,/ 这些/ 错误/ 无法/ 为/ 条件/ 函数/ 依赖/ 和/ 时效/ 约束/ 所/ 检测/ 并/ 加以/ 处理/ ,/ 进而/ 对/ 数据分析/ 造成/ 影响/ ,/ 导致/ 决策/ 失误/ ./ 如何/ 解决/ 数据/ 中/ 存在/ 的/ 潜在/ 错误/ ,/ 就/ 成为/ 一个/ 亟需/ 解决/ 的/ 问题/ ./ 现实生活/ 中/ 的/ 事物/ 都/ 是/ 相互/ 关联/ 的/ ./ 对大/ 数据/ 而言/ ,/ 其/ 数据/ 的/ 关联/ 关系/ 更加/ 复杂/ ./ 并且/ ,/ 这些/ 关联/ 关系/ 有助于/ 解决/ 数据/ 中/ 的/ 潜在/ 错误/ ./ 因此/ ,/ 本文/ 的/ 重点/ 就是/ 利用/ 关联/ 数据/ 检测/ 并/ 修复/ 数据/ 中/ 一致性/ 和/ 时序/ 性/ 问题/ ./ 例/ 1/ 中/ 举例说明/ 了/ 数据/ 中/ 潜在/ 一致性/ 和/ 时效性/ 问题/ ./ 例/ 1/ ./ Joe/ 和/ Ada/ 是/ 一对/ 夫妇/ ./ 图/ 1/ 给出/ 了/ 关于/ 实体/ Joe/ (/ e1/ )/ 和/ Ada/ (/ e2/ )/ 的/ 个人信息/ 关系/ 实例/ ,/ 其/ 关系/ 模式/ R/ 包含/ 姓名/ (/ NM/ )/ 、/ 年份/ (/ Year/ )/ 、/ 婚姻/ 状态/ (/ Sta/ )/ 、/ 性别/ (/ Gen/ )/ 和/ 家庭/ 关系/ (/ Rel/ )/ 这/ 5/ 个/ 属性/ ./ 在/ 实体/ e1/ 的/ 关系/ 实例/ 中/ ,/ 高亮/ 部分/ 数据表示/ 与/ 实际/ 情况/ 相冲突/ 的/ 错误/ 数据/ ,/ 括号/ 内为/ 相应/ 的/ 真实/ 值/ ./ 现实生活/ 中/ ,/ 实体/ 信息/ 通常/ 来自/ 不同/ 的/ 数据源/ ,/ 并且/ 数据源/ 的/ 置信度/ 存在/ 差异/ ./ 所以/ ,/ 数据/ 的/ 修复/ 代价/ 也/ 不尽相同/ ./ 本文/ 使用/ 文献/ [/ 6/ ]/ 中/ 提出/ 的/ 方法/ 计算/ 源/ 数据/ 的/ 置信度/ 作为/ 实体/ 的/ 修复/ 代价/ 权重/ ./ 实体/ e1/ 的/ 数据/ 修复/ 代价/ 权重/ wt/ 为/ 1/ 和/ 1.1/ ,/ 实体/ e2/ 的/ 数据/ 修复/ 代价/ 权重/ wt/ 为/ 3/ ./ CFDs/ :/ / 1/ :/ NM/ ,/ Year/ →/ Sta/ (/ tp/ {/ tp0/ (/ “/ Joe/ ”/ ,/ _/ ‖/ _/ )/ ,/ tp1/ (/ “/ Ada/ ”/ ,/ _/ ‖/ _/ )/ }/ )/ / 2/ :/ Sta/ ,/ Gen/ →/ Rel/ (/ tp/ {/ tp0/ (/ “/ married/ ”/ ,/ _/ ‖/ _/ )/ ,/ tp1/ (/ “/ single/ ”/ ,/ _/ ‖/ _/ )/ }/ )/ CCs/ :/ φ/ 1/ :/ / t1/ ,/ t2/ (/ t1/ / Yeart2/ →/ t1/ / Stat2/ )/ φ/ 2/ :/ / t1/ ,/ t2/ (/ t1/ [/ Sta/ ]/ =/ “/ single/ ”/ ∧/ t2/ [/ Sta/ ]/ =/ “/ married/ ”/ →/ t1/ / Stat2/ )/ / 1/ 和/ / 2/ 是/ R/ 上/ 的/ 条件/ 函数/ 依赖/ CFDs/ ,/ tp/ 为/ 条件/ 模板/ ,/ φ/ 1/ 和/ φ/ 2/ 是/ R/ 上/ 的/ 时效/ 约束/ CCs/ ./ / 1/ 表示/ ,/ 对于/ Joe/ 和/ Ada/ ,/ 他们/ 的/ 年份/ 可以/ 唯一/ 决定/ 他们/ 的/ 婚姻/ 状态/ ./ / 2/ 表示/ ,/ 对于/ 一个/ 未婚/ 或/ 已婚/ 的/ 人/ 而言/ ,/ 他/ 的/ 性别/ 可以/ 唯一/ 决定/ 他/ 的/ 家庭/ 关系/ ./ φ/ 1/ 表示/ ,/ 一个/ 人/ 的/ 婚姻/ 状态/ 会/ 随/ 时间/ 的/ 推移/ 而/ 保持/ 或者/ 发展/ ,/ 但是/ Page3/ 不会/ 出现/ 倒退/ 的/ 情况/ ./ 因而/ ,/ 一条/ 记录/ 的/ Year/ 值越/ 新/ ,/ 其所/ 对应/ 的/ Sta/ 值/ 或者/ 保持/ 不变/ ,/ 或者/ 比/ 其他/ 记录/ 的/ Sta/ 值新/ ./ φ/ 2/ 表示/ ,/ 如果/ 一条/ 记录/ 的/ Sta/ 值为/ “/ single/ ”/ ,/ 那么/ 它/ 比/ 其他/ Sta/ 值为/ “/ married/ ”/ 的/ 记录/ 要/ 陈旧/ ./ 在/ 现实生活/ 中/ ,/ 一个/ 人/ 的/ 婚姻/ 状态/ 只能/ 由/ “/ single/ ”/ 发展/ 成/ “/ married/ ”/ ,/ 或者/ 保持/ “/ single/ ”/ 的/ 状态/ ,/ 而/ 不/ 可能/ 出现/ 由/ “/ married/ ”/ 倒退/ 回/ “/ single/ ”/ 的/ 情况/ ./ / 1/ ,/ / 2/ ,/ φ/ 1/ 和/ φ/ 2/ 将/ 作为/ 用于/ 检测/ 实体/ e1/ ,/ e2/ 的/ 一致性/ 和/ 时效性/ 的/ 约束/ 规则/ ./ 在/ 进行/ 一致性/ 检测/ 时/ ,/ 条件/ 函数/ 依赖/ 模板/ 中/ 的/ 每一项/ tpi/ 将会/ 被/ 当成/ 一条/ 独立/ 的/ 规则/ ,/ 被/ 分别/ 用于/ 数据/ 的/ 一致性/ 检测/ ./ 其中/ ,/ / 2/ 的/ tp0/ 可以/ 检测/ 出/ e1/ 中/ 存在/ 的/ 数据/ 冲突/ :/ 记录/ t1/ ,/ t2/ ,/ t3/ ,/ t5/ 的/ Sta/ 属性/ 值均/ 为/ “/ single/ ”/ ,/ 并且/ 它们/ 的/ Gen/ 属性/ 值为/ “/ male/ ”/ ./ 然而/ ,/ t1/ ,/ t2/ ,/ t5/ 的/ Rel/ 属性/ 值/ “/ unmarried/ ”/ 与/ t3/ 的/ Rel/ 属性/ 值/ “/ husband/ ”/ 却是/ 相互/ 冲突/ 的/ ./ 为了/ 修复/ 冲突/ 数据/ ,/ 樊文飞/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 一种/ 代价/ 最优/ 的/ 方法/ ./ 该/ 方法/ 将/ t3/ 的/ Rel/ 属性/ 值/ 由/ “/ husband/ ”/ 修改/ 为/ “/ unmarried/ ”/ (/ 因为/ 修改/ t3/ 需要/ 改变/ 1/ 条/ 记录/ ,/ 而/ 修改/ t1/ ,/ t2/ ,/ t5/ 需要/ 改变/ 3/ 条/ 记录/ )/ ./ 修改/ 完后/ ,/ 关系/ 中/ 的/ 所有/ 数据/ 都/ 满足/ 约束/ 规则/ 的/ 要求/ ,/ 结束/ 整个/ 数据/ 修复/ 的/ 过程/ ./ 但是/ ,/ 一些/ 错误/ 数据/ 却/ 没有/ 被/ 检测/ 出来/ ,/ 比如/ t2/ ,/ t3/ ,/ t5/ 中/ 的/ Sta/ 属性/ 值/ “/ single/ ”/ (/ 对于/ Joe/ 和/ Ada/ 夫妇/ ,/ 他们/ 1972/ 年/ 的/ 婚姻/ 状态/ 应该/ 保持一致/ ,/ 同/ 为/ “/ married/ ”/ )/ ,/ 这些/ 数据/ 将/ 被/ 遗漏/ 并/ 成为/ 潜在/ 错误/ ./ 现实生活/ 上/ ,/ 数据/ 之间/ 是/ 相互/ 关联/ 的/ ,/ 并且/ 应该/ 将/ 关联/ 数据/ 放在/ 一起/ 进行/ 检测/ ,/ 而/ 不是/ 分开/ 地/ 、/ 独立/ 地/ 进行/ ./ 对于/ Joe/ 和/ Ada/ 夫妇/ ,/ 他们/ 之间/ 的/ 数据/ 是/ 相互/ 关联/ 的/ ,/ 可以/ 将/ e1/ 和/ e2/ 放在/ 一起/ 进行/ 检测/ ./ 同时/ ,/ eCFDs/ [/ 8/ ]/ 和/ CCFDs/ [/ 9/ ]/ (/ ConditionCombinedFunc/ -/ tionalDependencies/ )/ 验证/ 了/ CFDs/ 的/ 可/ 合并/ 性/ ./ 本文/ 使用/ CCFDs/ 对/ 规则/ 进行/ 合并/ ,/ 得到/ 的/ CCFDs/ 如下/ 所示/ :/ ψ/ 1/ 表示/ 当/ 把/ Joe/ 和/ Ada/ 的/ 数据/ 放在/ 一起/ 时/ ,/ 数据/ 应该/ 整体/ 满足/ 年份/ 唯一/ 决定/ 婚姻/ 状态/ 的/ 规则/ 要求/ ./ 使用/ ψ/ 1/ ,/ / 2/ ,/ φ/ 1/ 和/ φ/ 2/ 对/ 实体/ e1/ ,/ e2/ 进行/ 检测/ 时/ ,/ ψ/ 1/ 将/ t1/ ~/ t7/ 放在/ 一起/ 检测/ ,/ 进而/ 可以/ 检测/ 到/ t2/ ,/ t5/ 与/ t6/ 之间/ 发生/ 的/ 冲突/ ,/ 并/ 将/ t2/ ,/ t5/ 的/ Sta/ 属性/ 由/ “/ single/ ”/ 修改/ 为/ “/ married/ ”/ ./ 然后/ ,/ φ/ 1/ 和/ φ/ 2/ 可以/ 检测/ 出/ t3/ 与/ t2/ ,/ t5/ 之间/ 发生/ 的/ 时序/ 错误/ ,/ 将/ t3/ 的/ Sta/ 属性/ 由/ “/ single/ ”/ 修改/ 为/ “/ married/ ”/ ./ 接下来/ ,/ / 2/ 可以/ 检测/ 出/ t2/ ,/ t3/ ,/ t4/ ,/ t5/ 之间/ 发生/ 的/ 冲突/ ,/ 将/ t2/ ,/ t5/ 的/ Rel/ 属性/ 由/ “/ unmarried/ ”/ 修改/ 为/ “/ husband/ ”/ ./ 到/ 此/ ,/ 数据/ 中/ 的/ 所有/ 错误/ 均/ 已/ 被/ 修复/ ./ 因此/ ,/ 将/ 关联/ 数据/ 放在/ 一起/ 更/ 有利于/ 检测/ 和/ 修复/ 数据/ 中/ 的/ 潜在/ 错误/ ./ 另外/ ,/ 人工/ 处理/ 潜在/ 数据/ 的/ 代价/ 过大/ ,/ 而且/ 人工/ 处理/ 在/ 分析/ 潜在/ 错误/ 的/ 过程/ 中/ 也/ 极易/ 发生/ 错误/ ./ 基于/ 此/ ,/ 本文/ 提出/ 了/ 一种/ 自动/ 清洗/ 关联/ 数据/ 中/ 一致性/ 和/ 时序/ 性/ 错误/ 的/ 方法/ ./ 尽管/ ,/ 文献/ [/ 5/ ,/ 10/ -/ 11/ ]/ 提出/ 了/ 一些/ 关于/ 数据/ 一致性/ 问题/ 和/ 时序/ 性/ 问题/ 的/ 解决/ 方法/ ./ 但是/ ,/ 目前/ 仍然/ 缺少/ 解决/ 关于/ 关联/ 数据/ 的/ 一致性/ 和/ 时序/ 性/ 问题/ 的/ 相关/ 方法/ ./ 本文/ 在/ 研究/ 关联/ 数据/ 的/ 修复/ 问题/ 时/ ,/ 遇到/ 了/ 以下/ 难题/ :/ (/ 1/ )/ 如何/ 计算/ 关联/ 数据/ 的/ 修复/ 代价/ ?/ 由于/ 数据/ 修复过程/ 使用/ 了/ 关联/ 数据/ ,/ 因此/ 需要/ 考虑/ 关联/ 数据/ 对/ 修复/ 代价/ 的/ 影响/ ./ (/ 2/ )/ 如何/ 计划/ 合理/ 的/ 数据/ 修复/ 顺序/ ?/ 不同/ 的/ 修复/ 顺序/ 会/ 产生/ 不同/ 的/ 修复/ 结果/ ,/ 其中/ 的/ 一些/ 修复/ 顺序/ 可能/ 导致/ 错误/ 的/ 修复/ 结果/ ./ 对于/ 之前/ 给出/ 的/ 使用/ ψ/ 1/ ,/ / 2/ 和/ φ/ 1/ 的/ 修复/ 方法/ ,/ 如果/ 按照/ / 2/ →/ ψ/ 1/ →/ φ/ 1/ →/ / 2/ 的/ 顺序/ 进行/ 检测/ 和/ 修复/ ,/ 就/ 会/ 将/ t3/ 和/ t4/ 的/ Rel/ 属性/ 值/ 改为/ “/ unmarried/ ”/ 而/ 出现/ 错误/ ./ 所以/ ,/ 需要/ 选择/ 正确/ 的/ 修复/ 顺序/ 来/ 克服/ 错误/ 的/ 修复/ ./ (/ 3/ )/ 如何/ 选取/ 合适/ 的/ 修复/ 目标值/ ?/ 从/ 对/ 上面/ 修复/ 顺序/ 问题/ 的/ 描述/ 中/ ,/ 可以/ 看出/ 某/ 一次/ 数据/ 修改/ 可能/ 会/ 对/ 下/ 一次/ 的/ 数据/ 检测/ 和/ 修改/ 造成/ 影响/ ./ 一方面/ ,/ 对于/ 同一个/ 错误/ ,/ 可能/ 存在/ 多个/ 供/ 选取/ 的/ 目标值/ ;/ 另一方面/ ,/ 某些/ 目标值/ 可能/ 只是/ 修复过程/ 中/ 的/ 一个/ 临时/ 值/ ,/ 需要/ 反复/ 修改/ 几次/ 才能/ 得到/ 最终/ 的/ 修复/ 状态/ ./ 不论是/ 多个/ 目标值/ 的/ 选取/ 还是/ 临时/ 状态值/ 的/ 选取/ ,/ 都/ 需要/ 选择/ 一个/ 合适/ 的/ 目标值/ ,/ 最终/ 得到/ 正确/ 的/ 修复/ 结果/ ./ 本文/ 利用/ CCFDs/ 和/ CCs/ ,/ 考虑/ 数据/ 之间/ 的/ 关联/ 关系/ ,/ 提出/ 了/ 一种/ 解决/ 数据/ 一致性/ 和/ 时效性/ 混合/ 问题/ 的/ 数据/ 清洗/ 方法/ ,/ 具体/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 了/ 一种/ CCFDs/ 和/ CCs/ 的/ 混合/ 清洗/ 方法/ ,/ 可以/ 解决/ 数据/ 一致性/ 和/ 时效性/ 的/ 混合/ 问题/ ,/ 并且/ 分析/ 了/ CCFDs/ 和/ CCs/ 混合/ 规则/ 的/ 可/ 满足/ 性/ 问题/ 和/ 蕴含/ 问题/ ./ (/ 2/ )/ 设计/ 了/ 一种/ 数据/ 修复/ 框架/ ./ 考虑/ 到/ 数据/ 检测/ 和/ 数据/ 修复/ 的/ 相互作用/ ,/ 本/ 框架/ 迭代/ 地/ 进行/ 执行/ 这/ 两个/ 过程/ ,/ 直到/ 得到/ 一个/ 一致/ 的/ 、/ 时序/ 正确/ 的/ 清洗/ 结果/ ./ (/ 3/ )/ 提出/ 了/ 一种/ “/ 修复/ 序列图/ ”/ 的/ 结构/ ./ 在/ 数据/ Page4/ 修复/ 的/ 过程/ 中/ ,/ 错误/ 的/ 修复/ 顺序/ 可能/ 导致/ 错误/ 的/ 修复/ 结果/ ./ 修复/ 序列图/ 可以/ 计算/ 出/ 应该/ 优先/ 修复/ 的/ 数据/ 错误/ ,/ 从而/ 避免/ 错误/ 修复/ ./ (/ 4/ )/ 证明/ 了/ 关于/ CCFDs/ 和/ CCs/ 的/ 最小/ 代价/ 一致性/ 和/ 时效性/ 清洗/ 问题/ 是/ 一个/ Σ/ p/ 题/ ,/ 进而/ 提出/ 了/ 一种/ 启发式/ 的/ 修复/ 方法/ ./ (/ 5/ )/ 通过/ 在/ HOSP/ 数据/ 集/ 和/ NBA/ 数据/ 集上/ 进行/ 实验/ ,/ 说明/ 了/ 本/ 方法/ 的/ 实用性/ 和/ 高效性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 给出/ 关于/ 关联/ 数据/ 一致性/ 和/ 时效性/ 清洗/ 的/ 相关/ 概念/ ;/ 第/ 4/ 节/ 提出/ 一种/ 一致性/ 和/ 时效性/ 的/ 清洗/ 框架/ 并/ 介绍/ 相应/ 的/ 检测/ 方法/ 和/ 修复/ 方法/ ;/ 第/ 5/ 节/ 分析/ 讨论/ 实验/ 结果/ ;/ 第/ 6/ 节/ 总结/ 全文/ 工作/ 并/ 对/ 未来/ 工作/ 进行/ 概述/ ./ 2/ 相关/ 工作/ 数据/ 质量/ 的/ 研究/ 是/ 一个/ 传统/ 问题/ ,/ 现存/ 大量/ 相关/ 文献/ ,/ 但是/ 在/ 该/ 领域/ 中/ 仍然/ 存在/ 一些/ 问题/ 需要/ 探询/ ./ 本文/ 研究/ 的/ 问题/ 亦/ 在/ 此/ 领域/ 范畴/ 之内/ ,/ 主要/ 研究/ 的/ 内容/ 是/ :/ 利用/ 规则/ 约束/ ,/ 解决/ 关联/ 数据/ 中/ 一致性/ 和/ 时效性/ 问题/ ./ 目前/ 的/ 研究/ 中/ ,/ 与/ 本文/ 研究/ 密切相关/ 的/ 相关/ 工作/ 主要/ 类别/ 于/ 以下/ 3/ 个/ 方面/ :/ (/ 1/ )/ 约束/ 规则/ ./ 约束/ 规则/ 是/ 数据/ 质量/ 管理/ 的/ 一个/ 重要/ 技术/ ,/ 可以/ 简单/ 、/ 快速/ 地/ 实现/ 数据/ 的/ 检测/ 与/ 修复/ ./ 约束/ 规则/ 有/ 很多/ 种类/ ,/ 如/ 函数/ 依赖/ FDs/ [/ 1/ ]/ (/ FunctionalDependencies/ )/ 、/ 条件/ 函数/ 依赖/ CFDs/ [/ 4/ ]/ 、/ 否定/ 约束/ DCs/ [/ 12/ ]/ (/ DenialConstraints/ )/ 、/ 时效/ 约束/ CCs/ [/ 5/ ]/ 等/ ./ 通过/ 实践证明/ 这些/ 规则/ 是/ 非常/ 有效/ 的/ ./ 在/ CFDs/ 的/ 基础/ 上/ ,/ eCFDs/ [/ 8/ ]/ (/ extendedConditionalFunctionalDependencies/ )/ 和/ CCFDs/ [/ 9/ ]/ 分析/ 了/ 规则/ 合并/ 的/ 可行性/ ./ 本文/ 使用/ CCFDs/ 来/ 检测/ 关联/ 数据/ 的/ 一致性/ ./ 对于/ 不同/ 类型/ 的/ 规则/ ,/ 他们/ 既/ 可以/ 独立/ 运行/ ,/ 解决/ 一类/ 数据/ 质量/ 问题/ ,/ 也/ 可以/ 混合/ 使用/ ,/ 同时/ 解决/ 多/ 类/ 数据/ 质量/ 的/ 混合/ 问题/ ./ 文献/ [/ 13/ ]/ 通过/ 将/ 匹配/ 规则/ MDs/ (/ MatchingDependencies/ )/ 与/ CFDs/ 相结合/ ,/ 利用/ 主/ 关系/ 中/ 的/ 记录/ 指导/ 从属关系/ 中/ 出现/ 的/ 错误/ 修复/ ./ 文献/ [/ 14/ ]/ 分析/ 讨论/ 了/ CFDs/ 和/ CINDs/ (/ Condi/ -/ tionalInclusionDependencies/ )/ 之间/ 的/ 相互作用/ 关系/ ,/ 进而/ 混合/ 使用/ CFDs/ 和/ CINDs/ 对/ 多/ 数据源/ 中/ 的/ 数据/ 冲突/ 进行/ 检测/ ./ 文献/ [/ 5/ ]/ 通过/ 将/ CFDs/ 和/ CCs/ 结合/ 使用/ ,/ 进而/ 得到/ 关于/ 实体/ 的/ 一致/ 的/ 、/ 最新/ 的/ 记录/ 信息/ ./ 与/ 以往/ 的/ 研究/ 有所区别/ 的/ 是/ ,/ 本文/ 关心/ 的/ 是/ 关联/ 数据/ 中/ 的/ 一致性/ 和/ 时效性/ 问题/ ,/ 所以/ 本文/ 使用/ 的/ 是/ CCFDs/ 和/ CCs/ ./ (/ 2/ )/ 数据/ 一致性/ 分析/ ./ 数据/ 一致性/ 是/ 数据/ 质量/ 管理/ 研究/ 的/ 重要/ 事务/ 之一/ ./ 解决/ 数据/ 一致性/ 问题/ 可以/ 通过/ 实体/ 识别/ [/ 15/ ]/ 等/ 方法/ 来/ 实现/ ./ 其中/ ,/ 使用/ 规则/ 约束/ 来/ 验证/ 数据/ 一致性/ 并/ 对/ 其/ 修复/ 是/ 最/ 有效/ 的/ 一致性/ 管理/ 方法/ 之一/ ./ 文献/ [/ 16/ -/ 17/ ]/ 提出/ 了/ 一致性/ 规则/ 的/ 发现/ 方法/ ./ 文献/ [/ 18/ ]/ 研究/ 了/ 如何/ 使用/ CFDs/ 进行/ 一致性/ 检测/ 和/ 修复/ 的/ 相关/ 问题/ ./ (/ 3/ )/ 数据/ 时效性/ 分析/ ./ 时序/ 错误/ 的/ 检测/ 和/ 错误/ 数据/ 的/ 修复/ 是/ 时效性/ 分析/ 的/ 两个/ 关键问题/ ./ 使用/ 规则/ 约束/ 进行/ 数据/ 时效性/ 分析/ 是/ 目前/ 最/ 有效/ 的/ 方法/ 之一/ ./ 文献/ [/ 5/ ]/ 提出/ 一种/ ,/ 在/ 没有/ 时间/ 戳/ 的/ 条件/ 下/ ,/ 使用/ 时效/ 约束/ 查询/ 数据/ 时效/ 的/ 方法/ ,/ 以此/ 来/ 判定/ 实体/ 的/ 最新/ 状态/ 信息/ ./ 文献/ [/ 19/ ]/ 提出/ 了/ 一种/ 时效/ 图/ 的/ 结构/ 对/ 数据/ 的/ 实效性/ 进行/ 判定/ ./ 文献/ [/ 20/ ]/ 通过/ 结合/ 使用/ 规则/ 和/ 统计/ 的/ 方法/ 对/ 数据/ 进行/ 修复/ ./ 此外/ ,/ 对于/ 数据/ 清洗/ 而言/ ,/ 文献/ [/ 11/ ]/ 提出/ 了/ 的/ 多种/ 修复过程/ 和/ 修复/ 方法/ ,/ 对/ 修复过程/ 的/ 相关/ 问题/ 进行/ 了/ 研究/ ./ 本文/ 具体/ 研究/ 了/ 在/ CCFDs/ 和/ CCs/ 混合/ 规则/ 作用/ 下/ ,/ 关于/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 检测/ 和/ 修复/ 问题/ ./ 3/ 相关/ 概念/ 本/ 节/ 针对/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 清洗/ 问题/ ,/ 首先/ 对/ 条件/ 合并/ 的/ 函数/ 依赖/ 和/ 时效/ 约束/ 进行/ 介绍/ ,/ 然后/ 提出/ 了/ 用于/ 数据/ 清洗/ 的/ 相关/ 概念/ ./ 本文/ 使用/ 关系数据/ 的/ 形式/ 对/ 实体/ 进行/ 描述/ ,/ 假定/ 相同/ 实体/ 的/ 数据/ 已经/ 经过/ 识别/ 并/ 集中/ 在/ 一起/ ./ 关系/ 模式/ R/ =/ (/ 犲/ id/ ,/ 狋/ id/ ,/ A1/ ,/ …/ ,/ An/ )/ ,/ 其中/ ,/ 犲/ id/ 为/ 实体/ 编号/ ,/ 具有/ 相同/ 实体/ 编号/ 的/ 记录/ 都/ 指向/ 同一/ 实体/ ;/ 狋/ id/ 表示/ 记录/ 编号/ ;/ A1/ ,/ …/ ,/ An/ 表示/ R/ 上/ 的/ 属性/ ,/ dom/ (/ A/ )/ 表示/ 属性/ A/ 的/ 值域/ ;/ R/ 上/ 的/ 所有/ 属性/ 集合/ 记作/ attr/ (/ R/ )/ ,/ N/ 表示/ 集合/ 中/ 的/ 属性/ 个数/ ./ 3.1/ 约束/ 规则/ (/ 1/ )/ 条件/ 合并/ 的/ 函数/ 依赖/ CCFDs/ (/ Condition/ -/ CombinedFunctionalDependencies/ )/ [/ 9/ ]/ ./ CCFDs/ 是/ 一种/ 可以/ 同时/ 对/ 多个/ 条件/ 值/ 进行/ 一致性/ 检测/ 的/ 完整性/ 约束/ ./ 关系/ 模式/ R/ 上/ 的/ 一条/ CCFD/ 记作/ 其中/ :/ C/ 为/ 条件/ 属性/ 集合/ ;/ Y/ 为/ 变量/ 属性/ 集合/ ,/ C/ 和/ Y/ 由/ “/ |/ ”/ 分隔/ ,/ 并且/ C/ ,/ Y/ / attr/ (/ R/ )/ ,/ C/ ∩/ Y/ =/ / ,/ C/ ,/ Y/ 合/ 称为/ 规则/ 左部/ ,/ 记作/ LHS/ (/ ψ/ )/ ,/ 单/ 属性/ A/ 称为/ 规则/ 右部/ ,/ 记作/ RHS/ (/ ψ/ )/ ;/ Y/ →/ A/ 是/ 一个/ 标准/ 函数/ 依/ Page5/ 赖/ ;/ Sci/ 是/ 关于/ C/ 的/ 属性/ 值/ 集合/ ,/ Sci/ / dom/ (/ C/ )/ ,/ Sc/ 是/ Sci/ 的/ 集合/ ,/ 即/ Sc/ =/ ∪/ Sci/ ./ 并且/ 对于/ 任意/ 元组/ ti/ ,/ tj/ ,/ 如果/ ti/ [/ C/ ]/ ,/ tj/ [/ C/ ]/ ∈/ Sci/ ,/ ti/ 和/ tj/ 需要/ 放在/ 一起/ 进行/ 检测/ ./ ψ/ 1/ 是/ CCFDs/ 的/ 一个/ 具体/ 实例/ ./ 特别/ 地/ ,/ / 2/ 也/ 可以/ 表示/ 成/ :/ Sc1/ {/ “/ single/ ”/ }/ }/ ./ ψ/ 2/ :/ (/ Sta/ |/ Gen/ →/ Rel/ ,/ Sc/ )/ Sc/ {/ Sc0/ {/ “/ married/ ”/ }/ ,/ I/ 是/ R/ 上/ 的/ 一个/ 实例/ ,/ ti/ ,/ tj/ 是/ I/ 中/ 的/ 任意/ 两个/ 元组/ ./ 一条/ 条件/ 合并/ 的/ 函数/ 依赖/ ψ/ 关于/ I/ 是/ 成立/ 的/ ,/ 当且/ 仅/ 当/ ,/ 在/ ti/ [/ C/ ]/ ,/ tj/ [/ C/ ]/ ∈/ Sci/ 的/ 条件/ 下/ ,/ 如果/ ti/ [/ Y/ ]/ =/ tj/ [/ Y/ ]/ ,/ 则/ 有/ ti/ [/ A/ ]/ =/ tj/ [/ A/ ]/ ,/ 并且/ 记作/ I/ / ψ/ ./ 否则/ ,/ 记作/ I/ // / ψ/ ./ Σ/ ψ/ 是/ 条件/ 合并/ 的/ 函数/ 依赖/ 的/ 规则/ 集合/ ,/ 对于/ / ψ/ ∈/ Σ/ ψ/ ,/ 都/ 有/ I/ / ψ/ ,/ 则/ 称/ Σ/ ψ/ 关于/ I/ 成立/ ,/ 记作/ I/ / Σ/ ψ/ ./ 对于/ CFDs/ ,/ 每/ 一个/ tpi/ ∈/ tp/ 都/ 是/ 一条/ 独立/ 的/ 规则/ / :/ (/ X/ →/ A/ ,/ tpi/ )/ ,/ 那么/ / 也/ 可以/ 表示/ 成/ / :/ (/ C/ |/ Y/ →/ A/ ,/ tpi/ )/ ./ 对于/ 满足/ 相同/ 形式/ C/ |/ Y/ →/ A/ 的/ CFDs/ ,/ 尽管/ tpi/ 不同/ ,/ 它们/ 的/ Y/ →/ A/ 中/ 包含/ 的/ 信息/ 可能/ 存在/ 重叠/ 的/ 部分/ ./ 相应/ 地/ 在/ 现实生活/ 中/ ,/ 隶属/ 不同/ 条件/ 的/ 事物/ ,/ 可能/ 是/ 相互/ 关联/ 的/ ,/ 从而/ 共同/ 遵从/ 相同/ 的/ 规则/ ./ 需要/ 说明/ 的/ 是/ :/ ①/ 规则/ 发现/ 不是/ 本文/ 的/ 主要/ 工作/ ,/ 因而/ 本文/ 使用/ 文献/ [/ 9/ ]/ 提出/ 方法/ ,/ 将/ 规则/ 合并/ 在/ 一起/ ./ 然后/ 由/ 数据/ 专家/ 从中/ 选取/ 重叠/ 部分/ 较/ 高/ 的/ CCFDs/ ,/ 用于/ 关联/ 数据/ 的/ 一致性/ 分析/ ;/ ②/ 并/ 不是/ 所有/ 的/ CFDs/ 都/ 能/ 进行/ 合并/ ,/ 有些/ CFDs/ 可能/ 存在/ 冲突/ (/ 比如/ ,/ / ,/ / ,/ / 是/ 3/ 条/ CFDs/ 规则/ ,/ 它们/ 可能/ 存在/ 这样/ 的/ 情况/ :/ / 可以/ 分别/ 与/ / 和/ / 进行/ 合并/ ,/ 但是/ / 不能/ 与/ / 进行/ 合并/ )/ ./ 本文/ 采用/ 不/ 相交/ Sci/ 的/ CCFD/ ψ/ ,/ 即/ 对于/ / Sci/ ,/ Scj/ ∈/ Sc/ ,/ 有/ Sci/ ∩/ Scj/ =/ / ./ 所以/ ,/ 同一/ CFD/ 规则/ 将/ 不会/ 被/ 重复/ 合并/ ./ (/ 2/ )/ 时序/ 关系/ (/ CurrencyOrder/ )/ ./ I/ 是/ 关系/ 模式/ R/ 上/ 的/ 实例/ ,/ I/ 中/ 的/ 关联/ 数据/ ti/ 和/ tj/ 满足/ 关于/ 属性/ A/ 的/ 时序/ 关系/ 当且/ 仅/ 当/ 下述/ 条件/ 同时/ 成立/ :/ ①/ ti/ [/ 犲/ id/ ]/ =/ tj/ [/ 犲/ id/ ]/ ;/ ②/ ti/ / Atj/ ./ 其中/ ,/ ti/ [/ 犲/ id/ ]/ =/ tj/ [/ 犲/ id/ ]/ 表示/ ti/ 和/ tj/ 是/ 关于/ 同一/ 实体/ 犲/ id/ 的/ 不同/ 记录/ ./ ti/ / Atj/ 表示/ ti/ 关于/ 属性/ A/ 的/ 时效性/ 要/ 高于/ tj/ ,/ 即/ ti/ [/ A/ ]/ 相比/ tj/ [/ A/ ]/ ,/ 更能/ 表示/ 犲/ id/ 的/ 最新/ 情况/ ./ 如例/ 1/ 中所/ 给出/ 的/ 关于/ Joe/ 的/ 信息/ ,/ t1/ ,/ t2/ 分别/ 是/ Joe/ 在/ 1971/ 年/ 和/ 1972/ 年/ 的/ Sta/ 状态/ ,/ 那么/ t2/ [/ Sta/ ]/ 要/ 更新/ 一些/ ,/ 即/ t1/ / Stat2/ ./ 时序/ 关系/ 描述/ 了/ 关联/ 数据/ 之间/ 的/ 时间/ 先后顺序/ ,/ 通常/ 使用/ 时序/ 约束/ 来/ 具体/ 描述/ 数据/ 之间/ 的/ 时序/ 关系/ ./ 时效/ 约束/ CCs/ (/ CurrencyConstraints/ )/ [/ 5/ ]/ ./ CCs/ 是/ 一种/ 可以/ 用来/ 判定/ 数据/ 时效/ 信息/ 的/ 规则/ 约束/ ./ ti/ ,/ tj/ 是/ 关系/ 实例/ I/ 中/ 的/ 任意/ 两个/ 元组/ ,/ 关系/ 模式/ R/ 上/ 的/ 一条/ CC/ 记作/ 其中/ ,/ ω/ 是/ 约束/ 的/ 前件/ ,/ 使用/ 断言/ 的/ 合取/ 来/ 进行/ 表示/ ,/ 记作/ LHS/ (/ φ/ )/ ./ 断言/ 包含/ 以下/ 3/ 种/ 具体/ 形式/ :/ ①/ 偏序/ ti/ / Altj/ ,/ 在/ ti/ 和/ tj/ 关于/ 属性/ Al/ 的/ 顺序/ 关系/ 不/ 相等/ 的/ 情况/ 下/ ,/ ti/ / Altj/ 也/ 可以/ 表示/ 成/ ti/ / Altj/ ;/ ②/ 二元/ 谓词/ ti/ [/ Al/ ]/ opti/ [/ Al/ ]/ ,/ op/ 可以/ 是/ =/ 、/ ≠/ 、/ </ 、/ >/ 、/ / 或/ / 中/ 的/ 其中/ 一种/ ;/ ③/ 常数/ 谓词/ ti/ [/ Al/ ]/ opc/ 或者/ tj/ [/ Al/ ]/ opc/ ,/ c/ 是/ 一个/ 常数/ ./ ti/ / Altj/ 是/ 规则/ 右部/ ,/ 记作/ RHS/ (/ φ/ )/ ./ 接下来/ ,/ 基于/ 时效/ 约束/ CCs/ ,/ 本文/ 提出/ 时序/ 关系/ 断言/ 和/ 时序/ 关系/ 表达式/ 的/ 概念/ ,/ 用来/ 判断/ 实例/ 中/ 元组/ 是否/ 存在/ 时序/ 性上/ 的/ 错误/ ./ 定义/ 1/ ./ 时序/ 关系/ 断言/ (/ CurrencyAssertion/ )/ ./ 对于/ 给定/ 的/ 元组/ ti/ ,/ tj/ ,/ 它们/ 关于/ 时效/ 约束/ φ/ 的/ 时序/ 关系/ 断言/ q/ φ/ 定义/ 为/ 时序/ 关系/ 断言/ 描述/ 了/ 经过/ φ/ 推演/ 后/ ,/ 元组/ ti/ ,/ tj/ 关于/ 属性/ Ar/ 的/ 时序/ 关系/ ./ 定义/ 2/ ./ 时序/ 关系/ 表达式/ (/ CurrencyExpres/ -/ sion/ )/ ./ Σ/ φ/ 是/ 时效/ 约束/ 的/ 规则/ 集合/ ,/ 元组/ ti/ 和/ tj/ 关于/ Σ/ φ/ 的/ 时序/ 关系/ 表达式/ Q/ 定义/ 为/ 元组/ ti/ 和/ tj/ 是/ 时序/ 正确/ 的/ ,/ 当且/ 仅/ 当/ ,/ 他们/ 的/ 时序/ 表达式/ Q/ 的/ 值/ 为/ 真/ (/ True/ )/ ,/ 即/ ti/ 和/ tj/ 的/ 任意/ 两个/ 时序/ 关系/ 断言/ 都/ 不/ 互为/ 矛盾/ 式/ ./ 换言之/ ,/ ti/ 和/ tj/ 经过/ Σ/ φ/ 推理/ 得到/ 的/ 所有/ 时序/ 关系/ 断言/ 中/ ,/ 不会/ 同时/ 出现/ 类似/ ti/ / Artj/ 和/ ti/ / Artj/ 的/ 情况/ ./ 实例/ I/ 满足/ 时效/ 约束/ 集合/ Σ/ φ/ 是/ 成立/ 的/ ,/ 当且/ 仅/ 当/ ,/ 对于/ / ti/ ,/ tj/ ∈/ I/ ,/ 它们/ 的/ 时序/ 表达式/ Q/ 的/ 值/ 都/ 为/ 真/ ,/ 并且/ 记作/ I/ / Σ/ φ/ ./ 否则/ ,/ 记作/ I/ // / Σ/ φ/ ./ 例/ 2/ ./ 例/ 1/ 中/ 给出/ 的/ 实体/ e1/ 的/ 记录/ 和/ 时效/ 规则/ 集合/ CCs/ Σ/ φ/ =/ {/ φ/ 1/ ,/ φ/ 2/ }/ 为例/ ,/ 由/ t1/ [/ Year/ ]/ =/ “/ 1971/ ”/ / t2/ [/ Year/ ]/ =/ “/ 1972/ ”/ 可得/ t1/ ,/ t2/ 关于/ φ/ 1/ 的/ 时序/ 关系/ 断言/ q/ φ/ 1/ :/ t1/ / Stat2/ ./ 由/ t1/ [/ Sta/ ]/ =/ “/ single/ ”/ 和/ t2/ [/ Sta/ ]/ =/ “/ married/ ”/ 可得/ t1/ ,/ t2/ 关于/ φ/ 2/ 的/ 时序/ 关系/ 断言/ q/ φ/ 2/ :/ t1/ / Stat2/ ./ 那么/ ,/ t1/ ,/ t2/ 关于/ φ/ 1/ 和/ φ/ 2/ 的/ 时序/ 关系/ 表达式/ 为/ Q/ =/ q/ φ/ 1/ ∧/ q/ φ/ 2/ =/ t1/ / Stat2/ ∧/ t1/ / Stat2/ =/ True/ ./ 说明/ t1/ 和/ t2/ 之间/ 没有/ 发生/ 时序/ 性/ 错误/ ./ 对于/ e1/ 中/ 的/ 所有/ 记录/ t1/ ~/ t5/ ,/ 其中/ 所有/ 的/ 时序/ 表达式/ Q/ 都/ 为/ 真/ ,/ 那么/ e1/ 中/ 的/ 元组/ 都/ 满足/ 时序/ 约束/ Σ/ φ/ 的/ 要求/ ,/ 即/ e1/ / Σ/ φ/ ./ Page6/ 用于/ 数据/ 清洗/ 的/ 混合/ 规则/ 集合/ 记/ 作/ Σ/ =/ Σ/ ψ/ ∪/ Σ/ φ/ ,/ 它/ 是/ 由/ CCFDs/ 和/ CCs/ 组成/ 的/ 混合/ 规则/ 集合/ ./ 如果/ I/ / Σ/ ψ/ 并且/ I/ / Σ/ φ/ 同时/ 成立/ ,/ 那么/ 称/ 实例/ I/ 满足/ 混合/ 规则/ 集合/ Σ/ ,/ 记作/ I/ / Σ/ ./ 3.2/ 修复/ 代价/ 修复/ 代价/ 是/ 数据/ 质量/ 清洗/ 过程/ 中/ 的/ 一项/ 基本/ 衡量标准/ ./ 设/ Σ/ =/ Σ/ ψ/ ∪/ Σ/ φ/ 是/ 由/ CCFDs/ 和/ CCs/ 组成/ 的/ 混合/ 规则/ 集合/ ,/ t/ 是/ 实例/ I/ 中/ 存在/ 错误/ 的/ 元组/ ,/ 对于/ 任意/ 规则/ η/ ∈/ Σ/ ,/ t/ 是/ t/ 关于/ η/ 的/ 修复/ 目标/ 元组/ ,/ 并且/ t/ 与/ t/ 只/ 在/ RHS/ (/ η/ )/ 属性/ 上/ 存在/ 差别/ ,/ 4.3/ ./ 3/ 节将/ 讨论/ 如何/ 选取/ 修复/ 目标/ 元组/ ./ 接下来/ ,/ 本文/ 给出/ 在/ η/ 作用/ 下/ ,/ 将/ t/ 改为/ t/ 的/ 修复/ 代价/ 的/ 计算方法/ ./ 对于/ 选取/ 的/ 不同/ 类型/ 的/ 规则/ η/ ,/ 修复/ 代价/ 计算方法/ 也/ 有所不同/ ./ 如果/ η/ 是/ 一条/ CCFD/ 规则/ (/ C/ |/ Y/ →/ A/ ,/ Sc/ )/ ,/ 在/ 修复/ 的/ 过程/ 中/ ,/ 需要/ 考虑/ 关联/ 数据/ 对/ 数据/ 修复/ 产生/ 的/ 影响/ ./ 对于/ 一个/ 条件/ 合并/ 集合/ Sci/ ∈/ Sc/ ,/ 同一/ Sci/ 支配/ 下/ 的/ 元组/ 都/ 是/ 相互/ 关联/ 的/ ./ 定义/ 3/ ./ 关联/ 数据/ 集/ (/ RelatedDateSet/ )/ ./ 在/ 实例/ I/ 中/ ,/ 元组/ t/ 关于/ |/ I/ |/ 2/ 的/ 关联/ 数据/ 集/ 定义/ IC/ (/ t/ ,/ η/ )/ 为/ 其中/ :/ Sci/ 是/ η/ 中/ 包含/ t/ 的/ 条件/ 合并/ 集合/ ;/ σ/ f/ 是/ 关系数据库/ 中/ 的/ 选择/ 操作/ ,/ f/ 是/ 进行/ 选择/ 的/ 条件/ ./ IC/ (/ t/ ,/ η/ )/ 选取/ Sci/ 中/ 所有/ 与/ t/ 享有/ 相同/ Y/ 属性/ 值/ 和/ A/ 属性/ 值/ 的/ 元组/ 作为/ t/ 的/ 关联/ 数据/ ./ 在/ 进行/ 数据/ 修复/ 的/ 过程/ 中/ ,/ 如果/ 关联/ 数据/ 集/ 的/ 一个/ 元组/ 发生变化/ ,/ 集合/ 中/ 的/ 其他/ 元组/ 也/ 要/ 随之/ 变化/ ./ 关联/ 数据/ 的/ 选取/ 同样/ 会/ 对/ 修复/ 代价/ 权重/ 造成/ 影响/ ./ 定义/ 4/ ./ 在/ 关联/ 数据/ 集/ IC/ (/ t/ ,/ η/ )/ 中/ ,/ 元组/ t/ 的/ 关联/ 数据/ 的/ 修复/ 代价/ 权重/ wt/ (/ t/ ,/ η/ )/ 定义/ 为/ wt/ (/ t/ ,/ η/ )/ =/ wt/ (/ t/ )/ +/ 1/ 其中/ ,/ wt/ (/ ti/ )/ 表示/ 元组/ ti/ 在/ 实例/ I/ 中/ 的/ 初始/ 的/ 修复/ 代价/ 权重/ ./ 由于/ 考虑/ 了/ 关联/ 数据/ 的/ 影响/ ,/ 初始/ 的/ 修复/ 代价/ 权重/ 得到/ 了/ 进一步/ 加强/ ./ 式/ (/ 6/ )/ 使用/ 关联/ 数据/ 修复/ 权重/ 的/ 平均值/ 来/ 描述/ 元组/ t/ 受/ 关联/ 数据/ 的/ 影响/ 而/ 导致/ 的/ 初始/ 权重/ 的/ 变化/ 情况/ ./ 如果/ 与/ t/ 相关/ 的/ 元组/ ti/ 的/ 修复/ 权重/ 都/ 比较/ 高/ ,/ 那么/ t/ 的/ 修复/ 代价/ 权重/ 的/ 变化/ 就/ 比较/ 大/ ./ 例/ 3/ ./ 以/ t1/ ,/ t2/ 和/ CCFD/ ψ/ 1/ 为例/ ,/ 其中/ 的/ Sc0/ 是/ 包含/ t1/ ,/ t2/ 的/ 条件/ 合并/ 集合/ ,/ t1/ 关于/ ψ/ 1/ 的/ 关联/ 数据/ 集/ IC/ (/ t1/ ,/ ψ/ 1/ )/ =/ {/ t1/ ,/ t6/ }/ ,/ 其/ 关联/ 数据/ 的/ 修复/ 代价/ 权重/ wt/ (/ t1/ ,/ ψ/ 1/ )/ =/ 1/ +/ 0.5/ ×/ (/ 1/ +/ 3/ )/ =/ 3/ ;/ t2/ 关于/ ψ/ 1/ 的/ 关联/ 数据/ 集/ IC/ (/ t2/ ,/ ψ/ 1/ )/ =/ {/ t2/ ,/ t5/ }/ ,/ 其/ 关联/ 数据/ 的/ 修复/ 代价/ 权重/ wt/ (/ t2/ ,/ ψ/ 1/ )/ =/ 2.05/ ./ 在/ 考虑/ 关联/ 数据/ 的/ 影响/ 的/ 情况/ 下/ ,/ t1/ 和/ t2/ 的/ 修复/ 代价/ 权重/ 都/ 得到/ 了/ 相应/ 的/ 增强/ ./ 并且/ ,/ 关联/ 数据/ 的/ 修复/ 代价/ 权重/ 越大/ ,/ t1/ 和/ t2/ 的/ 权重/ 变化/ 也/ 越/ 大/ ./ 如果/ η/ 是/ 一条/ CC/ 规则/ ,/ 在/ 修复/ 代价/ 的/ 计算/ 过程/ 中/ ,/ 修复/ 代价/ 权重/ 不会/ 受/ 其他/ 元组/ 的/ 影响/ ,/ 可以/ 直接/ 计算/ 求解/ ./ 定义/ 5/ ./ 鉴于/ CCFDs/ 和/ CCs/ 对/ 修复/ 代价/ 的/ 影响/ 不同/ ,/ 在/ η/ 的/ 作用/ 下/ ,/ 元组/ t/ 改为/ t/ 的/ 修复/ 代价/ 定义/ 为/ cost/ (/ t/ ,/ t/ ,/ η/ )/ =/ {/ wt/ (/ t/ ,/ η/ )/ ·/ Isrepair/ (/ t/ ,/ t/ )/ ,/ 如果/ η/ 是/ CCFDwt/ (/ t/ )/ ·/ Isrepair/ (/ t/ ,/ t/ )/ ,/ 其中/ ,/ Isrepair/ (/ t/ ,/ t/ )/ 是/ 一个/ 判别函数/ :/ 如果/ 目标值/ t/ 与/ 初始值/ t/ 不/ 相同/ ,/ 那么/ 将/ 元组/ t/ 改为/ t/ ,/ 并/ 计算/ 其/ 修复/ 代价/ ./ 并且/ ,/ 修复/ 代价/ 权重/ 越高/ ,/ 修复/ 的/ 代价/ 也/ 越/ 大/ ./ 例/ 4/ ./ 基于/ 例/ 3/ 得到/ 的/ 关联/ 修复/ 代价/ 权重/ ,/ 假设/ t2/ 是/ 修复/ 的/ 目标值/ ,/ 并且/ t2/ [/ Sta/ ]/ =/ “/ married/ ”/ ,/ 那么/ 把/ t2/ 修改/ 为/ t2/ ,/ 对于/ 单个/ 元组/ 进行/ 修复/ 的/ 代价/ 为/ cost/ (/ t2/ ,/ t2/ ,/ ψ/ 1/ )/ =/ 2.05/ ./ 在/ 考虑/ 到/ 关联/ 数据/ 的/ 情况/ 下/ 虽然/ 增加/ 了/ 修复/ 代价/ ,/ 但是/ 使用/ 关联/ 数据/ 为/ 修改/ 提供/ 参考/ 可以/ 提高/ 修复/ 的/ 准确性/ ./ 定义/ 6/ ./ I/ 是/ 实例/ I/ 关于/ 规则/ 集合/ Σ/ 的/ 修复/ 目标/ 实例/ ,/ 对于/ / t/ ∈/ I/ ,/ / η/ ∈/ Σ/ ,/ I/ 存储/ 了/ 所有/ 与/ 之/ 相对/ 应/ 的/ 修复/ 目标/ 元组/ t/ ./ 那么/ 实例/ I/ 关于/ 规则/ 集合/ Σ/ 的/ 修复/ 代价/ 定义/ 为/ cost/ (/ I/ ,/ I/ ,/ Σ/ )/ =/ ∑/ t/ ∈/ I/ ∑/ η/ ∈/ Σ/ 其中/ ,/ f/ (/ t/ ,/ η/ ,/ I/ )/ 是/ 一个/ 查询/ 函数/ ,/ 利用/ 索引/ 从/ I/ 中/ 返回/ 元组/ t/ 关于/ 规则/ η/ 的/ 修复/ 目标/ 元组/ ./ 3.3/ 问题/ 定义/ 后/ ,/ 本文/ 需要/ 解决/ 的/ 问题/ 描述/ 如下/ :/ 在/ 给出/ 约束/ 规则/ 和/ 修复/ 代价/ 的/ 基本/ 定义/ 描述/ 之/ 最小/ 代价/ 修复/ ./ 给定/ 一个/ 关系/ 模式/ R/ 上/ 的/ 多/ 实体/ 实例/ I/ 以及/ 条件/ 合并/ 的/ 函数/ 依赖/ Σ/ ψ/ 和/ 时效/ 约束/ Σ/ φ/ 的/ 混合/ 规则/ 集合/ Σ/ =/ Σ/ ψ/ ∪/ Σ/ φ/ ,/ 找到/ 一个/ 修复/ 目标/ 实例/ I/ ,/ 使得/ I/ / Σ/ 并且/ cost/ (/ I/ ,/ I/ ,/ Σ/ )/ 最小/ ,/ 即/ 不/ 存在/ I/ / Σ/ 并且/ cost/ (/ I/ ,/ I/ ,/ Σ/ )/ </ cost/ (/ I/ ,/ I/ ,/ Σ/ )/ ./ 进而/ ,/ 最小/ 代价/ 修复/ 的/ 判定/ 问题/ 表述/ 为/ :/ 对于/ 给定/ 的/ 实例/ I/ 、/ 规则/ 集合/ Σ/ 及/ 一个/ 正整数/ k/ ,/ 是否/ 存在/ 一个/ 修复/ Page7/ 目标/ 实例/ I/ ,/ 使得/ I/ / Σ/ 并且/ cost/ (/ I/ ,/ I/ ,/ Σ/ )/ / k/ ./ 定理/ 1/ ./ 最小/ 代价/ 修复/ 的/ 判定/ 问题/ 是/ 一个/ Σ/ p/ 完全/ (/ NPNP/ )/ 问题/ ./ 证明/ ./ 文献/ [/ 5/ ]/ 通过/ “/ / / / / DNF/ ”/ 问题/ 规约/ 证明/ 了/ 在/ CFDs/ 和/ CCs/ 混合/ 使用/ 的/ 情况/ 下/ ,/ 进行/ 最小/ 代价/ 修复/ 的/ 判定/ 问题/ 是/ 一个/ Σ/ pDNF/ ”/ 即/ τ/ =/ / X/ / Y/ δ/ ,/ 其中/ X/ 和/ Y/ 的/ 真值/ 集合/ 为/ X/ =/ {/ x1/ ,/ …/ ,/ xn/ }/ 和/ Y/ =/ {/ y1/ ,/ …/ ,/ ym/ }/ ,/ δ/ =/ C1/ ∨/ …/ ∨/ Cr/ ,/ 对于/ 任意/ j/ ∈/ [/ 1/ ,/ r/ ]/ ,/ Cj/ =/ lj/ 个/ 变量/ 或者/ X/ ∪/ Y/ 的/ 补/ 集中/ 的/ 一个/ 元素/ ,/ 在/ 此/ 情况/ 下/ ,/ 对/ τ/ 进行/ 真值/ 判定/ 就是/ “/ / / / / DNF/ ”/ 问题/ ./ 对于/ 一个/ 由/ s/ 条/ CFDs/ 合并/ 得到/ 的/ CCFD/ ψ/ ,/ 其/ 修复/ 问题/ 可以/ 在/ O/ (/ s/ )/ 内/ 转化/ 成为/ CFDs/ 的/ 修复/ 问题/ ./ 同理/ 对于/ CCFDs/ 集合/ Σ/ ψ/ ,/ 其/ 修复/ 问题/ 可以/ 在/ O/ (/ |/ Σ/ / |/ )/ 内/ 转化/ 成为/ CFDs/ 的/ 修复/ 问题/ ,/ 其中/ |/ Σ/ / |/ 表示/ Σ/ ψ/ 中/ 包含/ 的/ CFDs/ 规则/ 数量/ ./ 并且/ ,/ CFDs/ 规则/ 的/ 合并/ 与/ CFDs/ -/ CCs/ 的/ 混合/ 使用/ 是/ 相互/ 独立/ 的/ ./ 规则/ 合并/ 不会/ 对/ 规则/ 的/ 混合/ 造成/ 影响/ ./ 进而/ ,/ CCFDs/ -/ CCs/ 的/ 规则/ 混合/ 可以/ 通过/ CFDs/ -/ CCs/ 的/ 混合/ 来/ 实现/ ./ 所以/ ,/ 使用/ CCFDs/ 和/ CCs/ 混合/ 规则/ 的/ 修复/ 问题/ 可以/ 在/ O/ (/ |/ Σ/ / |/ )/ 等价/ 地/ 转化/ 成为/ CFDs/ 和/ CCs/ 混合/ 规则/ 的/ 修复/ 问题/ ./ 那么/ ,/ 在/ CCFDs/ 和/ CCs/ 混合/ 使用/ 的/ 条件/ 下/ 的/ 最小/ 代价/ 修复/ 的/ 判定/ 问题/ 也/ 是/ 一个/ Σ/ p4/ 一致性/ 和/ 时效性/ 混合/ 清洗/ 对于/ 给定/ 数据/ 实例/ I/ 和/ 用于/ 清洗/ 的/ 约束/ 规则/ Σ/ ,/ 为了/ 修复/ I/ 中/ 存在/ 的/ 一致性/ 和/ 时效性/ 的/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 一致性/ 和/ 时效性/ 混合/ 清洗/ 框架/ ,/ 并/ 讨论/ 了/ 清洗/ 过程/ 中/ 的/ 相关/ 问题/ ./ 4.1/ 清洗/ 框架/ 定义/ ./ 定义/ 7/ ./ 给定/ 数据/ 实例/ I/ 及/ 混合/ 规则/ 集合/ Σ/ ,/ η/ ∈/ Σ/ ,/ η/ 是/ 一条/ 异常/ 规则/ 当且/ 仅/ 当/ η/ 至少/ 满足/ 以下/ 其中/ 一个/ 条件/ :/ 在/ 描述/ 清洗/ 框架/ 之前/ ,/ 首先/ 给出/ 异常/ 规则/ 的/ (/ 1/ )/ η/ 是/ 一条/ CCFD/ ψ/ 并且/ I/ // / ψ/ ./ (/ 2/ )/ η/ 是/ 一条/ CC/ φ/ :/ / ti/ ,/ tj/ (/ ω/ →/ ti/ / Artj/ )/ ,/ 如果/ / u/ ,/ v/ ∈/ I/ ,/ / φ/ ∈/ Σ/ ,/ 使得/ u/ 和/ v/ 关于/ φ/ 和/ φ/ 的/ 时序/ 关系/ 表达式/ Q/ =/ q/ φ/ ∧/ q/ φ/ =/ False/ ./ 异常/ 规则/ 表示/ 的/ 是/ 在/ 检测/ 过程/ 中/ 发现/ 数据/ 错误/ 的/ 规则/ ./ 接下来/ ,/ 给出/ 一致性/ 和/ 时效性/ 混合/ 清洗/ 框架/ 的/ 基本/ 结构/ ./ 如图/ 2/ 所示/ ,/ 框架/ 中/ 包含/ 数据/ 检测/ 组件/ 和/ 数据/ 修复/ 组件/ 两个/ 部分/ ./ 其中/ ,/ 数据/ 检测/ 组件/ 利用/ CCFDs/ 和/ CCs/ 的/ 混合/ 规则/ 进行/ 检测/ ,/ 返回/ 发现/ 检测/ 错误/ 的/ 异常/ 规则/ ./ 数据/ 修复/ 组件/ 通过/ :/ (/ 1/ )/ 修复/ 序列/ 判别/ ;/ (/ 2/ )/ 错误/ 元组/ 定位/ ;/ (/ 3/ )/ 错误/ 元组/ 修复/ 这/ 3/ 个/ 过程/ 对/ 错误/ 数据/ 进行/ 修复/ ./ 然后/ ,/ 框架/ 对/ 修复/ 的/ 结果/ 再次/ 进行/ 检测/ 和/ 修复/ ,/ 迭代/ 此/ 过程/ ,/ 直到/ 数据/ 的/ 错误/ 全部/ 被/ 修复/ 并/ 返回/ 清洗/ 后/ 的/ 实例/ I/ ./ 算法/ 1/ 描述/ 了/ 清洗/ 框架/ 的/ 执行/ 过程/ ./ 算法/ 1/ ./ 数据/ 清洗/ 方法/ cc/ -/ Cleaning/ (/ I/ ,/ Σ/ )/ ./ 输入/ :/ I/ ,/ Σ/ 输出/ :/ I1/ ./ I/ =/ I/ ;/ 2/ ./ WHILETRUEDO3/ ./ Σ/ =/ cc/ -/ Detect/ (/ I/ ,/ Σ/ )/ ;/ 4/ ./ IF/ Σ/ ≠/ / THEN5/ ./ Σ/ p/ =/ vr/ -/ Find/ (/ Σ/ )/ ,/ 6/ ./ Γ/ s/ =/ e/ -/ Locate/ (/ I/ ,/ Σ/ p/ )/ ,/ 7/ ./ I/ =/ e/ -/ Repair/ (/ I/ ,/ Γ/ s/ )/ ,/ 8/ ./ I/ =/ I/ ;/ 9/ ./ ENDIF10/ ./ ELSE11/ ./ RETURNI/ ;/ 12/ ./ ENDELSE13/ ./ ENDWHILE/ 其中/ ,/ cc/ -/ detect/ (/ I/ ,/ Σ/ )/ 是/ 数据/ 检测/ 组件/ 对应/ 的/ 方法/ ./ 数据/ 修复/ 组件/ cc/ -/ repair/ (/ I/ ,/ Σ/ )/ 包含/ 修复/ 序列/ 判别/ 方法/ vr/ -/ Find/ (/ Σ/ )/ 、/ 错误/ 元组/ 定位/ 方法/ e/ -/ Locate/ (/ I/ ,/ Σ/ p/ )/ 和/ 错误/ 元组/ 修复/ 方法/ e/ -/ Repair/ (/ I/ ,/ Γ/ s/ )/ ./ 方法/ 的/ 细节/ 将/ 在/ 4.2/ 节/ 和/ 4.3/ 节中/ 进行/ 介绍/ ./ 讨论/ ./ 本文/ 将/ 从/ 以下/ 4/ 点/ 对/ 数据/ 清洗/ 框架/ 进行/ 讨论/ :/ (/ 1/ )/ 数据/ 检测/ 的/ 返回值/ ./ 不同于/ 以往/ 的/ 检测/ 过程/ [/ 11/ ,/ 18/ ]/ ,/ 框架/ 中/ 的/ 数据/ 检测/ 组件/ 返回/ 的/ 是/ 发现/ 检测/ 错误/ 的/ 异常/ 规则/ ,/ 而/ 不是/ 实际/ 发生/ 错误/ 的/ 元组/ ./ 因/ Page8/ 为/ ,/ 在/ 后续/ 的/ 修复过程/ 中/ ,/ 需要/ 判定/ 哪些/ 是/ 需要/ 优先/ 修复/ 的/ 数据/ 错误/ ,/ 哪些/ 是/ 不/ 需要/ 优先/ 修复/ 的/ 数据/ ./ 例/ 1/ 中/ ,/ 与/ φ/ 1/ ,/ φ/ 2/ 有关/ 的/ 数据/ 错误/ 应该/ 在/ ψ/ 1/ 的/ 错误/ 数据/ 解决/ 之后/ 进行/ ./ 对于/ 那些/ 不/ 需要/ 优先/ 修复/ 的/ 数据/ ,/ 实际/ 元组/ 的/ 计算/ 会/ 造成/ 一种/ 资源/ 的/ 浪费/ ./ 因此/ ,/ 使用/ 异常/ 规则/ 可以/ 减少/ 这些/ 不必要/ 的/ 计算/ 代价/ ./ (/ 2/ )/ 检测/ 和/ 修复过程/ 的/ 迭代/ ./ 一方面/ ,/ 数据/ 中/ 的/ 潜在/ 错误/ 只能/ 在/ 经过/ 一次/ 修复/ 之后/ 才能/ 被/ 发现/ ./ 如例/ 1/ 中/ ,/ t3/ 的/ 潜在/ 错误/ 只有/ 在/ φ/ 1/ ,/ φ/ 2/ 修复/ 完后/ 再次/ 检测/ 才能/ 会/ 发现/ ./ 所以/ ,/ 需要/ 使用/ 迭代/ 的/ 方法/ 解决/ 数据/ 中/ 的/ 潜在/ 错误/ ./ 另一方面/ ,/ 修复过程/ 中/ 可能/ 会/ 产生/ 新/ 的/ 错误/ ,/ 这/ 就/ 需要/ 重新/ 进行/ 一次/ 检测/ 来/ 验证/ 是否/ 产生/ 了/ 新/ 的/ 错误/ ./ 文献/ [/ 1/ ]/ 中/ 提出/ 了/ 一种/ 迭代/ 清洗/ 的/ 修复/ 方法/ ,/ 针对/ 检测/ 得到/ 的/ 错误/ 需要/ 人为/ 参与/ 进行/ 修复/ ,/ 并且/ 由/ 人为/ 判定/ 迭代/ 的/ 终止/ 条件/ ./ 区别/ 于/ 文献/ [/ 1/ ]/ 的/ 清洗/ 过程/ ,/ 本/ 框架/ 使用/ 一种/ 自动/ 迭代/ 的/ 数据/ 清洗/ 方法/ ,/ 在/ 数据/ 修复/ 和/ 程序/ 终止/ 的/ 问题/ 上/ 可以/ 避免/ 某些/ 人为因素/ 产生/ 的/ 修复/ 错误/ ./ (/ 3/ )/ 混合/ 规则/ 的/ 可/ 满足/ 性/ 和/ 蕴含/ 性/ ./ 这/ 两个/ 问题/ 是/ 规则/ 约束/ 的/ 两个/ 基本/ 问题/ ./ CCFDs/ 和/ CCs/ 的/ 混合/ 规则/ 可/ 满足/ 性/ 问题/ 可以/ 描述/ 为/ :/ 给定/ 一个/ 混合/ 规则/ 集合/ Σ/ =/ Σ/ ψ/ ∪/ Σ/ φ/ ,/ 是否/ 存在/ 一个/ 完整/ 实例/ I/ ,/ 使得/ I/ / Σ/ ./ 对于/ 一个/ 关系/ 模式/ R/ ,/ dom/ (/ A/ )/ 表示/ 属性/ A/ 的/ 有限/ 阈值/ 范围/ ,/ 那么/ R/ 上/ 的/ 完整/ 值域/ 空间/ 可以/ 由/ 所有/ 属性/ 的/ dom/ (/ A/ )/ 的/ 组合/ 得到/ ./ 完整/ 实例/ 是/ 指/ 包含/ 一个/ 完整/ 值域/ 空间/ 的/ 实例/ ./ 规则/ 的/ 可/ 满足/ 性/ 问题/ 研究/ 的/ 是/ 规则/ 之间/ 是否/ 存在/ 冲突/ 的/ 问题/ ./ 例如/ ,/ η/ ,/ η/ 是/ Σ/ 中/ 的/ 两条/ 规则/ ,/ 但是/ 无论如何/ 也/ 找/ 不到/ 一个/ 完整/ 实例/ I/ ,/ 使/ I/ 同时/ 满足/ η/ 和/ η/ ./ 这/ 说明/ η/ 和/ η/ 本身/ 是/ 冲突/ 的/ ,/ 那么/ Σ/ 不/ 满足/ 规则/ 可/ 满足/ 性/ 的/ 要求/ ./ CCFDs/ 和/ CCs/ 的/ 混合/ 规则/ 蕴含/ 性/ 问题/ 可以/ 描述/ 为/ :/ 给定/ 一个/ 混合/ 规则/ 集合/ Σ/ 和/ 一条/ 规则/ η/ ,/ 对于/ 所有/ 实例/ I/ ,/ 如果/ 同时/ 有/ I/ / Σ/ 和/ I/ / η/ ,/ 那么/ 称/ Σ/ 蕴含/ η/ ,/ 记/ 作/ Σ/ / η/ ./ 并且/ ,/ 不/ 包含/ 蕴含/ 关系/ 的/ 规则/ 集合/ 被/ 成为/ 最小/ 规则/ 集合/ ./ 规则/ 蕴含/ 研究/ 的/ 是/ 规则/ 之间/ 的/ 推导/ 关系/ :/ 一条/ 规则/ 是否/ 可以/ 由/ 其它/ 规则/ 的/ 组合/ 来/ 推导/ 得到/ ./ 规则/ 的/ 蕴含/ 性/ 可以/ 用来/ 判别/ 规则/ 集合/ 中/ 是否/ 包含/ 冗余/ 的/ 规则/ ./ 文献/ [/ 5/ ]/ 通过/ “/ 3/ -/ SAT/ ”/ 问题/ 规约/ 证明/ 了/ CFDs/ 和/ CCs/ 混合/ 规则/ 的/ 可/ 满足/ 性/ 问题/ 和/ 蕴含/ 问题/ 分别/ 是/ 一个/ NP/ 完全/ 问题/ 和/ 一个/ co/ -/ NP/ 完全/ 问题/ ./ CCFDs/ 是/ 一类/ 特殊/ 的/ CFDs/ ,/ 并且/ CCFDs/ 的/ 相关/ 问题/ 可以/ 在/ O/ (/ |/ Σ/ / |/ )/ 时间/ 内/ 转化/ 成为/ CFDs/ 的/ 相关/ 问题/ ./ 所以/ ,/ CCFDs/ 和/ CCs/ 混合/ 规则/ 的/ 可/ 满足/ 性/ 问题/ 和/ 蕴含/ 问题/ 同样/ 是/ NP/ 完全/ 问题/ 和/ co/ -/ NP/ 完全/ 问题/ ./ 本文/ 将/ 使用/ 同时/ 满足/ 可/ 满足/ 性/ 的/ 最小/ 混合/ 规则/ 集合/ 进行/ 清洗/ ./ (/ 4/ )/ 程序/ 的/ 终止/ 性/ ./ 由于/ 在/ 修复过程/ 中/ 使用/ 的/ 是/ 可/ 满足/ 的/ 最小/ 规则/ 集合/ ,/ 所以/ 框架/ 在/ 迭代/ 修复/ 后/ 最终/ 会/ 达到/ 终止/ 的/ 状态/ ,/ 并且/ 终止/ 的/ 条件/ 是/ 数据/ 中/ 不再/ 检测/ 到/ 新/ 的/ 错误/ ./ 4.2/ 数据/ 检测/ 对于/ 给定/ 的/ 数据/ 实例/ I/ 和/ 混合/ 规则/ 集合/ Σ/ =/ Σ/ ψ/ ∪/ Σ/ φ/ ,/ 针对/ 框架/ 中/ 的/ 数据/ 检测/ 组件/ ,/ 本文/ 提出/ 了/ 一种/ 数据/ 检测/ 方法/ cc/ -/ Detect/ (/ I/ ,/ Σ/ )/ ,/ 用以/ 返回/ Σ/ 的/ 异常/ 规则/ 集合/ Σ/ ./ 算法/ 2/ 描述/ 了/ 数据/ 检测/ 的/ 执行/ 过程/ ./ 第/ 3/ 行中/ ,/ I/ // / η/ 用来/ 判断/ η/ 是否是/ 一条/ 异常/ 规则/ ./ 首先/ 区别/ 规则/ η/ 是/ 一条/ CCFD/ 还是/ 一条/ CC/ ,/ 然后/ 判断/ η/ 是否/ 满足/ I/ ./ 算法/ 2/ ./ 数据/ 检测/ 方法/ cc/ -/ Detect/ (/ I/ ,/ Σ/ )/ ./ 输入/ :/ I/ ,/ Σ/ 输出/ :/ Σ/ 1/ ./ Σ/ =/ / ;/ 2/ ./ FOReach/ η/ in/ Σ/ DO3/ ./ IFI/ // / η/ THEN4/ ./ Σ/ =/ Σ/ ∪/ η/ ;/ 5/ ./ ENDIF6/ ./ ENDFOR7/ ./ RETURN/ Σ/ ;/ 复杂度/ 分析/ ./ 如果/ η/ 是/ 一条/ CCFD/ ,/ I/ // / η/ 的/ 检测/ 过程/ 可以/ 在/ Θ/ (/ |/ I/ |/ 2/ )/ 完成/ ,/ 如果/ η/ 是/ 一条/ CC/ ,/ I/ // / η/ 的/ 检测/ 过程/ 可以/ 在/ Θ/ (/ |/ Σ/ φ/ |/ ×/ |/ I/ |/ 2/ )/ 完成/ ./ 其中/ ,/ CCFDs/ 和/ CCs/ 规则/ 数量/ 的/ 上界/ 均/ 为/ |/ Σ/ |/ ./ 那么/ ,/ 算法/ 2/ 的/ 计算/ 复杂度/ 为/ O/ (/ |/ Σ/ |/ 2/ ×/ |/ I/ |/ 2/ )/ ./ 4.3/ 数据/ 修复/ 数据/ 修复/ 组件/ 针对/ 数据/ 检测/ 组件/ 返回/ 的/ 异常/ 规则/ 集合/ ,/ 通过/ 修复/ 序列/ 判别/ ,/ 错误/ 数据/ 定位/ 以及/ 目标值/ 选取/ 3/ 个/ 过程/ 来/ 实现/ 数据/ 修复/ ./ 4.3/ ./ 1/ 修复/ 序列/ 判别/ 为了/ 计算/ 出/ 异常/ 规则/ 集合/ Σ/ 中/ 需要/ 优先/ 修复/ 的/ 规则/ Σ/ p/ ,/ 本文/ 提出/ 了/ 规则/ 序列图/ 的/ 定义/ ./ 定义/ 8/ ./ 对于/ 给定/ 的/ 规则/ 集合/ Σ/ ,/ 其/ 规则/ 序列图/ 定义/ 为/ Gs/ (/ V/ ,/ E/ )/ ,/ 其中/ V/ =/ Σ/ ./ 对于/ 任意/ η/ 1/ ,/ η/ 2/ ∈/ Σ/ ,/ 如果/ RHS/ (/ η/ 1/ )/ / LHS/ (/ η/ 2/ )/ ,/ 则/ 在/ η/ 1/ ,/ η/ 2/ 之间/ 存在/ 一条/ 由/ η/ 1/ 指向/ η/ 2/ 的/ 边/ ,/ 记作/ eij/ ,/ 则/ E/ =/ {/ eij/ |/ i/ ,/ j/ ∈/ [/ 1/ ,/ |/ Σ/ |/ ]/ }/ ./ 例/ 5/ ./ 针对/ 例/ 1/ 中/ 出现/ 的/ 问题/ ,/ 使用/ Σ/ =/ {/ ψ/ 1/ ,/ ψ/ 2/ ,/ φ/ 1/ ,/ φ/ 2/ }/ 作为/ 数据/ 清洗/ 的/ 混合/ 规则/ 集合/ ./ 第/ 1/ 次迭/ Page9/ 代/ 的/ 过程/ 中/ ,/ Σ/ =/ {/ ψ/ 1/ ,/ ψ/ 2/ }/ 是/ 得到/ 的/ 异常/ 规则/ 集合/ ./ Σ/ 和/ Σ/ 的/ 规则/ 序列图/ 如图/ 3/ 所示/ ./ 从图/ 3/ 右半部/ 中/ 可以/ 看出/ ,/ 对/ ψ/ 2/ 的/ 修复过程/ 会/ 受到/ ψ/ 1/ 的/ 影响/ ./ 所以/ ,/ 数据/ 修复/ 的/ 过程/ 需要/ 找到/ 需要/ 优先/ 修复/ 的/ 异常/ 规则/ ./ 值得一提的是/ ,/ 规则/ 序列图/ 中入度/ 为/ 0/ 的/ 规则/ 不会/ 受到/ 其他/ 规则/ 的/ 影响/ ./ 所以/ ,/ 修复过程/ 只/ 需要/ 选取/ 这些/ 入度/ 为/ 0/ 的/ 规则/ 作为/ 优先/ 修复/ 的/ 规则/ 即可/ ./ 对于/ 序列图/ 非空/ ,/ 又/ 不/ 包含/ 入度/ 为/ 0/ 的/ 规则/ 的/ 情况/ ,/ 即/ 序列图/ 中/ 只/ 存在/ 回路/ ./ 回路/ 情况/ 下/ 求解/ 最小/ 修复/ 代价/ 时/ ,/ 就/ 需要/ 考虑/ 回路/ 中/ 所有/ 修复/ 情况/ ,/ 这些/ 修复/ 会/ 对/ 后续/ 的/ 修复/ 产生/ 影响/ ,/ 进而/ 通过/ 这种/ 动态/ 规划/ 的/ 方法/ 得到/ 所有/ 的/ 修复/ 策略/ 并/ 计算/ 其/ 修复/ 代价/ ./ 定理/ 1/ 中/ 证明/ 了/ 最小/ 代价/ 修复/ 是/ 一个/ 2/ 完全/ 问题/ ./ 所以/ ,/ 本文/ 采用/ 了/ 一种/ 启发式/ 方法/ ,/ 计/ Σ/ p/ 算/ 回路/ 中/ 每/ 一条/ 规则/ 所/ 覆盖/ 的/ 错误/ 元组/ 修复/ 代价/ 权重/ 总和/ ,/ 并/ 选取/ 总和/ 最小/ 的/ 规则/ ./ 算法/ 3/ 描述/ 了/ 修复/ 顺序/ 的/ 判别/ 方法/ 的/ 执行/ 过程/ ./ 算法/ 3/ ./ 修复/ 序列/ 判别/ 方法/ vr/ -/ Find/ (/ Σ/ )/ ./ 输入/ :/ Σ/ 输出/ :/ Σ/ p1/ ./ Σ/ p/ =/ / ,/ Gs/ (/ V/ ,/ E/ )/ =/ G/ -/ gen/ (/ Σ/ )/ ;/ 2/ ./ FOReach/ η/ inVDO3/ ./ IFdegree/ (/ η/ )/ =/ =/ 0THEN4/ ./ Σ/ p/ =/ Σ/ p/ ∪/ η/ ;/ 5/ ./ ENDIF6/ ./ ENDFOR7/ ./ IF/ Σ/ p/ =/ / THEN8/ ./ Σ/ p/ =/ Σ/ p/ ∪/ minwt/ (/ V/ )/ ;/ 9/ ./ ENDIF10/ ./ RETURN/ Σ/ p/ ;/ 第/ 1/ 行中/ ,/ G/ -/ gen/ (/ Σ/ )/ 按照/ 定义/ 的/ 方法/ 生成/ Σ/ 的/ 规则/ 序列图/ ./ 第/ 2/ ~/ 6/ 行/ 计算/ Gs/ 中入度/ 为/ 0/ 的/ 规则/ ./ 第/ 8/ 行中/ ,/ minwt/ (/ V/ )/ 将/ 从/ V/ 中/ 选取/ 修复/ 代价/ 权重/ 总和/ 最小/ 的/ 规则/ ./ 复杂度/ 分析/ ./ 规则/ 序列图/ 的/ 生成/ 过程/ 可以/ 在/ Θ/ (/ |/ Σ/ |/ 2/ )/ 完成/ ./ 计算/ 入度/ 为/ 0/ 的/ 规则/ 可以/ 在/ Θ/ (/ |/ Σ/ |/ )/ 完成/ ./ 随机/ 挑选/ 异常/ 规则/ 的/ 过程/ 可以/ 在/ Θ/ (/ 1/ )/ 完成/ ./ 并且/ |/ Σ/ |/ 的/ 上界/ 为/ |/ Σ/ |/ ./ 那么/ ,/ 算法/ 3/ 的/ 计算/ 复杂度/ 为/ O/ (/ |/ Σ/ |/ 2/ )/ ./ 4.3/ ./ 2/ 错误/ 元组/ 定位/ 确定/ 需要/ 优先/ 修复/ 的/ 规则/ 以后/ ,/ 需要/ 找到/ 与/ 规则/ 相对/ 应/ 的/ 具体/ 的/ 错误/ 元组/ ./ 错误/ 元组/ 不是/ 单一/ 存在/ 的/ ,/ 他们/ 都/ 是/ 与/ 其它/ 互相冲突/ 而/ 出现/ 的/ ,/ 所以/ 这些/ 发生冲突/ 的/ 元组/ 应该/ 放在/ 一起/ 进行/ 修复/ ./ 进而/ ,/ 本文/ 提出/ 错误/ 元组/ 集合/ 的/ 定义/ ./ 定义/ 9/ ./ 假设/ t/ 是/ 实例/ I/ 存在/ 错误/ 的/ 元组/ ,/ η/ 是/ 关于/ t/ 的/ 异常/ 规则/ ,/ 那么/ 元组/ t/ 关于/ η/ 的/ 错误/ 元组/ 集合/ S/ (/ t/ ,/ η/ )/ 定义/ 为/ 其中/ ,/ (/ t/ ,/ s/ )/ // / η/ 表示/ t/ ,/ s/ 关于/ η/ 是/ 相互/ 冲突/ 的/ ./ S/ (/ t/ ,/ η/ )/ 中/ 存储/ 了/ 所有/ 与/ t/ 相冲突/ 的/ 元组/ s/ 以及/ 那些/ 与/ t/ 类似/ 的/ 元组/ ./ 这些/ 与/ t/ 类似/ 的/ 元组/ 虽然/ 不/ 与/ t/ 发生冲突/ ,/ 但是/ 它们/ 与/ s/ 发生冲突/ ,/ 所以/ 它们/ 都/ 属于/ 相同/ 类别/ 的/ 错误/ ,/ 应该/ 放在/ 一起/ ./ 另外/ ,/ 这些/ 元组/ 的/ 错误/ 元组/ 集合/ 是/ 相同/ 的/ ,/ 所以/ 在/ 实际/ 使用/ 的/ 时候/ ,/ 会/ 将/ 它们/ 合并/ 在/ 一起/ ,/ 只/ 保留/ 一个/ 即可/ ./ 最后/ ,/ 将/ 所有/ 的/ 错误/ 数据/ 集合/ 存储/ 在/ 集合/ Γ/ s/ 中/ ./ 例/ 6/ ./ 回顾/ 例/ 1/ 中/ 的/ 实例/ ,/ t1/ 与/ t3/ 是/ 关于/ ψ/ 2/ 相互/ 冲突/ 的/ ./ 那么/ t1/ 关于/ ψ/ 2/ 的/ 错误/ 数据/ 集合/ S/ (/ t1/ ,/ ψ/ 2/ )/ =/ {/ t1/ ,/ t2/ ,/ t3/ ,/ t5/ }/ ./ 虽然/ t2/ ,/ t5/ 与/ t1/ 不/ 发生冲突/ ,/ 但是/ t2/ ,/ t5/ 与/ t3/ 却是/ 冲突/ 的/ ,/ 所以/ 将/ 它们/ 放在/ 一起/ ./ 并且/ 对于/ t1/ ,/ t2/ ,/ t3/ ,/ t5/ ,/ 只/ 保留/ S/ (/ t1/ ,/ ψ/ 2/ )/ 即可/ ./ 算法/ 4/ 描述/ 了/ 错误/ 元组/ 定位/ 的/ 执行/ 过程/ ./ 算法/ 4/ ./ 错误/ 元组/ 定位/ 方法/ e/ -/ Locate/ (/ I/ ,/ Σ/ p/ )/ ./ 输入/ :/ I/ ,/ Σ/ p/ 输出/ :/ Γ/ s1/ ./ Γ/ s/ =/ / ;/ 2/ ./ FOReach/ η/ in/ Σ/ pDO3/ ./ It/ =/ I/ ;/ 4/ ./ FOReachtiinItDO5/ ./ S/ (/ ti/ ,/ η/ )/ =/ / ;/ 6/ ./ FOReachtjinItDO7/ ./ IF/ (/ ti/ ,/ tj/ )/ // / η/ THEN8/ ./ S/ (/ ti/ ,/ η/ )/ =/ S/ (/ ti/ ,/ η/ )/ ∪/ tj/ ,/ It/ =/ It/ // ti/ ;/ 9/ ./ ENDIF10/ ./ ENDFOR11/ ./ IFS/ (/ ti/ ,/ η/ )/ ≠/ / THEN12/ ./ FOReachtkinItDO13/ ./ IFti/ ~/ tkTHEN14/ ./ S/ (/ ti/ ,/ η/ )/ =/ S/ (/ ti/ ,/ η/ )/ ∪/ tk/ ,/ It/ =/ It/ // tk/ ;/ 15/ ./ ENDIF16/ ./ ENDFOR17/ ./ Γ/ s/ =/ Γ/ s/ ∪/ S/ (/ ti/ ,/ η/ )/ ;/ Page1018/ ./ ENDIF19/ ./ ENDFOR20/ ./ ENDFOR21/ ./ RETURN/ Γ/ s/ ;/ 第/ 3/ 行/ ,/ It/ 是/ 一个/ 临时/ 实例/ ,/ 用来/ 控制/ 合并/ 相同/ 的/ 错误/ 元组/ 集合/ ./ 第/ 6/ ~/ 9/ 行/ 用于/ 找到/ 所有/ 与/ ti/ 发生冲突/ 的/ 元组/ ./ 第/ 13/ 行中/ ,/ ti/ ~/ tk/ 用来/ 判断/ ti/ 与/ tk/ 是否/ 相似/ ./ 第/ 12/ ~/ 16/ 行/ 使用/ ti/ ~/ tk/ 找到/ 所有/ 与/ ti/ 类似/ 的/ 元组/ ./ 复杂度/ 分析/ ./ (/ ti/ ,/ tj/ )/ // / η/ 与/ ti/ ~/ tk/ 都/ 可以/ 在/ Θ/ (/ 1/ )/ 完成/ ./ 发现/ 冲突/ 元组/ 和/ 发现/ 类似/ 元组/ 的/ 过程/ 都/ 可以/ 在/ Θ/ (/ |/ I/ |/ 2/ )/ 完成/ ./ 所以/ ,/ 算法/ 4/ 的/ 计算/ 复杂度/ 为/ O/ (/ |/ Σ/ p/ |/ ×/ |/ I/ |/ 2/ )/ ./ 4.3/ ./ 3/ 目标值/ 选取/ 对于/ 数据/ 修复过程/ 而言/ ,/ 修复/ 目标值/ 的/ 选取/ 是/ 一个/ 关键问题/ ./ 给定/ 错误/ 元组/ ,/ 选定/ 不同/ 的/ 修复/ 目标值/ ,/ 修复/ 的/ 结果/ 不尽相同/ ,/ 与/ 之/ 对应/ 的/ 修复/ 代价/ 也/ 有所不同/ ./ 问题/ 定义/ 部分/ 证明/ 了/ 最小/ 代价/ 修复/ 问题/ 是/ 2/ 完全/ (/ NPNP/ )/ 问题/ ./ 所以/ ,/ 本文/ 设计/ 了/ 一种/ 启/ 一个/ Σ/ p/ 发式/ 方法/ 来/ 选取/ 修复/ 目标值/ 并/ 对/ 错误/ 元组/ 进行/ 修复/ ./ 算法/ 5/ 描述/ 了/ 目标值/ 选取/ 和/ 错误/ 修复/ 的/ 执行/ 过程/ ./ 算法/ 5/ ./ 错误/ 元组/ 修复/ 方法/ e/ -/ Repair/ (/ I/ ,/ Γ/ s/ )/ ./ 输入/ :/ I/ ,/ Γ/ s/ 输出/ :/ I1/ ./ I/ =/ I/ ;/ 2/ ./ FOReachS/ (/ t/ ,/ η/ )/ in/ Γ/ sDO3/ ./ tvalue/ =/ NULL/ ,/ count/ =/ ;/ 4/ ./ FOReachviindom/ (/ RHS/ (/ η/ )/ )/ DO5/ ./ cost/ =/ 0/ ;/ 6/ ./ FOReachtiinS/ (/ t/ ,/ η/ )/ DO7/ ./ ti/ =/ t/ -/ gen/ (/ ti/ ,/ vi/ ,/ RHS/ (/ η/ )/ )/ ,/ 8/ ./ ENDFOR9/ ./ IFcost/ </ countTHEN10/ ./ tvalue/ =/ vi/ ,/ count/ =/ cost/ ;/ 11/ ./ ENDIF12/ ./ ENDFOR13/ ./ FOReachtiinS/ (/ t/ ,/ η/ )/ DO14/ ./ I/ =/ repair/ (/ ti/ ,/ tvalue/ ,/ I/ )/ ;/ 15/ ./ ENDFOR16/ ./ ENDFOR17/ ./ RETURNI/ ;/ 第/ 3/ 行/ ,/ tvalue/ 和/ count/ 分别/ 用来/ 存储/ 最小/ 代价/ 修复/ 的/ 目标值/ 及其/ 代价/ ./ 第/ 7/ 行/ ,/ t/ -/ gen/ (/ ti/ ,/ vi/ ,/ RHS/ (/ η/ )/ )/ 方法/ 将/ ti/ 的/ RHS/ (/ η/ )/ 属性/ 值/ 改为/ vi/ ,/ 以此/ 生成/ ti/ 的/ 目标/ 元组/ ./ 第/ 4/ ~/ 12/ 行/ 计算/ 关于/ S/ (/ t/ ,/ η/ )/ 的/ 最小/ 代价/ 的/ 修复/ 目标值/ tvalue/ ./ 第/ 13/ ~/ 15/ 行/ 使用/ repair/ (/ ti/ ,/ tvalue/ ,/ I/ )/ 将/ S/ (/ t/ ,/ η/ )/ 中/ 的/ 错误/ 元组/ ti/ 修改/ 为/ tvalue/ ./ 复杂度/ 分析/ ./ 对于/ 如何/ 选取/ 最小/ 修复/ 代价/ 的/ 目标值/ ,/ 其/ 计算/ 代价/ 为/ Θ/ (/ |/ Γ/ s/ |/ ×/ |/ S/ (/ t/ ,/ η/ )/ |/ ×/ |/ π/ RHS/ (/ η/ )/ (/ I/ )/ |/ )/ ,/ 其中/ |/ Γ/ s/ |/ ×/ |/ S/ (/ t/ ,/ η/ )/ |/ 表示/ 所有/ 错误/ 数据/ 的/ 数量/ ,/ 其/ 上限/ 为/ |/ I/ |/ ×/ |/ N/ |/ ./ |/ π/ RHS/ (/ η/ )/ (/ I/ )/ |/ 表示/ I/ 关于/ 属性/ RHS/ (/ η/ )/ 的/ 不同/ 值/ 的/ 个数/ ,/ 其/ 上限/ 为/ |/ I/ |/ ./ 对于/ 所有/ 错误/ 数据/ 的/ 修复过程/ 可以/ 在/ Θ/ (/ |/ Γ/ s/ |/ ×/ |/ S/ (/ t/ ,/ η/ )/ |/ )/ 完成/ ./ 另外/ ,/ 在/ 目标值/ 选取/ 的/ 过程/ 中/ ,/ cost/ (/ ti/ ,/ ti/ ,/ η/ )/ 的/ 计算/ 代价/ 为/ O/ (/ |/ I/ |/ )/ ./ 那么/ ,/ 算法/ 5/ 的/ 计算/ 复杂度/ 为/ O/ (/ |/ I/ |/ 3/ ×/ |/ N/ |/ )/ ./ 但是/ ,/ 实际/ 的/ 错误/ 量/ 和/ 不同/ 值/ 的/ 个数/ 分别/ 远/ 小于/ |/ I/ |/ ×/ |/ N/ |/ 和/ |/ I/ |/ ,/ 并且/ 实验/ 结果/ 可以/ 更好/ 地/ 说明/ 这/ 一点/ ./ 5/ 实验/ 本文/ 通过/ 在/ 两组/ 真实/ 数据/ 上/ 进行/ 实验/ ,/ 来/ 验证/ 一致性/ 和/ 时效性/ 混合/ 清洗/ 方法/ 的/ 性能/ ./ 5.1/ 实验/ 设置/ 硬件/ 方面/ ,/ 本/ 实验/ 使用/ IntelCorei7/ -/ 2600/ (/ 3.4/ GHz/ )/ CPU/ ,/ 搭载/ 8GBRAM/ 的/ 主机/ ./ 程序/ 方面/ ,/ 本/ 实验/ 使用/ Java/ 语言/ 进行/ 实现/ ,/ 并且/ 对于/ 每组/ 实验/ 均/ 重复/ 5/ 次/ ,/ 取/ 平均值/ 进行/ 比较/ ./ 实验/ 数据/ 集/ ./ 本文/ 使用/ HOSP/ 和/ NBA/ 两组/ 真实/ 数据/ ,/ 并/ 使用/ 实验/ 中/ 发现/ 的/ 规则/ 对/ 数据/ 中/ 本身/ 存在/ 的/ 错误/ 进行/ 检测/ ./ (/ 1/ )/ HOSP/ ①/ ./ 该/ 数据/ 集是/ 一个/ 真实/ 数据/ 集/ ,/ 来自/ 于/ 美国/ 国民/ 卫生/ 服务中心/ ,/ 记录/ 了/ 病人/ 在/ 住院/ 期间/ 的/ 医疗/ 统计/ 信息/ ./ HOSP/ 数据/ 集/ 包含/ 17/ 个/ 属性/ 和/ 1.3/ K/ 个/ 实体/ ,/ 并且/ 包含/ 了/ 超过/ 200KB/ 的/ 信息/ 记录/ ./ (/ 2/ )/ NBA/ ./ 队员/ 的/ 信息/ 数据/ Players/ 和/ 赛季/ 比赛/ 统计/ 信息/ 数据/ Stat/ 是从/ 体育/ 信息/ 数据库/ 网站/ ②/ 上/ 抽取/ 得到/ 真实/ 数据表/ ./ NBA/ 是/ 由/ Players/ 和/ Stat/ 集成/ 得到/ 的/ 数据/ 集/ ./ 在/ 集成/ 的/ 过程/ 中/ ,/ 使用/ eid/ 作为/ 连接/ 属性/ ,/ 对/ 两个/ 表/ 进行/ 等值/ 连接/ ./ 融合/ 后/ 的/ NBA/ 数据/ 集/ 的/ 关系/ 模式/ 为/ (/ pid/ ,/ name/ ,/ team/ ,/ league/ ,/ tname/ ,/ points/ ,/ poss/ ,/ allpoints/ ,/ min/ ,/ arena/ ,/ opened/ ,/ capacity/ ,/ state/ )/ ,/ 涉及/ 758/ 个/ 实体/ ,/ 并且/ 包含/ 18753/ 条/ 记录/ ./ 需要/ 说明/ 的/ 是/ ,/ HOSP/ 数据/ 集中/ 本身/ 存在/ 冲突/ ①/ ②/ Page11/ 数据/ 和/ 时序/ 错误/ 的/ 数据/ ,/ NBA/ 是/ 由于/ 数据/ 融合/ 的/ 过程/ 而/ 产生/ 的/ 数据/ 的/ 不/ 一致/ 和/ 时序/ 错误/ ./ 对/ 错误/ 数据/ 的/ 甄别/ 使用/ 样本/ 分析/ 的/ 方法/ ,/ 从/ 数据/ 中/ 抽取/ 样本/ 采用/ 人工/ 甄别/ 的/ 方法/ 找出/ 数据/ 中/ 的/ 错误/ ./ 在/ 具体/ 的/ 甄别/ 过程/ 中/ 采用/ “/ 封闭/ 世界/ ”/ 原理/ ,/ 即/ 只/ 找出/ 能够/ 被/ 确认/ 是/ 错误/ 的/ 数据/ ,/ 对于/ 无法/ 辨别/ 的/ 数据/ ,/ 且/ 当做/ 真实/ 数据/ 进行/ 处理/ ./ 规则/ 集/ ./ 本/ 实验/ 首先/ 从/ HOSP/ 和/ NBA/ 数据/ 集上/ 分别/ 抽取/ 高质量/ 的/ 数据/ 样本/ ,/ 然后/ 使用/ 文献/ [/ 9/ ]/ 中/ 提出/ 的/ 方法/ 计算/ 出/ 所有/ 的/ 一致性/ 候选/ 规则/ ,/ 由/ 领域专家/ 从/ 候选/ 规则/ 中/ 选出/ 适合/ 的/ 规则/ 进行/ 清洗/ ./ 时效/ 规则/ 则/ 由/ 领域专家/ 采用/ 人工/ 方法/ 对/ 数据/ 进行/ 分析/ 得到/ ./ 对于/ HOSP/ 数据/ 集/ ,/ 选取/ 120/ 条/ 支持率/ 大于/ 0.05/ 的/ CFDs/ (/ 即/ 每条/ 规则/ 至少/ 可以/ 控制/ 200/ 条/ 记录/ )/ 合并/ 成/ 19/ 条/ CCFDs/ ,/ 然后/ 与/ 22/ 条/ CCs/ 进行/ 混合/ ./ 对于/ NBA/ 数据/ 集/ ,/ 选取/ 190/ 条/ 支持率/ 大于/ 0.05/ 的/ CFDs/ (/ 即/ 每条/ 规则/ 至少/ 可以/ 控制/ 90/ 条/ 记录/ )/ 合并/ 成/ 27/ 条/ CCFDs/ ,/ 然后/ 与/ 35/ 条/ CCs/ 进行/ 混合/ ./ 以/ NBA/ 数据/ 集为例/ ,/ 表/ 1/ 给出/ 了/ 其中/ 的/ 部分/ 规则/ ./ 混合/ 规则/ 范例/ CCFDs/ ψ/ 1/ :/ (/ arena/ |/ →/ state/ ,/ Sc/ )/ Sc/ {/ Sc0/ {/ “/ ConsecoFieldhouse/ ”/ ,/ “/ ToyotaCenter/ ”/ ,/ Sc1/ {/ “/ UnitedCenter/ ”/ }/ }/ CCs/ φ/ 1/ :/ / t1/ ,/ t2/ (/ t1/ [/ tname/ ]/ =/ “/ NewOrleansJazz/ ”/ ∧/ φ/ 2/ :/ / t1/ ,/ t2/ (/ t1/ [/ allpoints/ ]/ / t2/ [/ allpoints/ ]/ →/ t1/ / tnamet2/ )/ 对比/ 方法/ ./ 为了/ 便于/ 观察/ 分析/ 修复/ 方法/ 的/ 性能/ ,/ 本文/ 使用/ 如下/ 的/ 4/ 种/ 方法/ 进行/ 对比/ 实验/ :/ (/ 1/ )/ CCFD/ 方法/ 只/ 使用/ CCFDs/ 进行/ 检测/ 和/ 修复/ ;/ (/ 2/ )/ CC/ 方法/ 只是/ 用/ CCs/ 进行/ 检测/ 和/ 修复/ ;/ (/ 3/ )/ CFD/ +/ CC/ 方法/ 和/ (/ 4/ )/ CCFD/ +/ CC/ 方法/ 分别/ 使用/ CFDs/ -/ CCs/ 和/ CCFDs/ -/ CCs/ 的/ 混合/ 规则/ 进行/ 检测/ 和/ 修复/ ./ 4/ 种/ 方法/ 均/ 按照/ 本文/ 提出/ 的/ 框架/ 进行/ 清洗/ ,/ 具体/ 实现/ 时/ 只/ 需要/ 将/ 输表/ 2/ 不同/ 数据/ 集上/ 的/ 检测/ 效果/ HOSP0/ ./ 0720.0590/ ./ 1320.1390/ ./ 4820.3920/ ./ 8820.9250/ ./ 1250.1030/ ./ 2300.242/ NBA0/ ./ 0580.0460/ ./ 0990.1060/ ./ 5270.4170/ ./ 9010.9650/ ./ 1040.0830/ ./ 1780.191/ 表/ 3/ 不同/ 数据/ 集上/ 的/ 修复/ 效果/ HOSP0/ ./ 0660.0560/ ./ 1250.1320/ ./ 4520.3720/ ./ 8310.8820/ ./ 1150.0860/ ./ 2170.230/ NBA0/ ./ 0540.0430/ ./ 0950.1010/ ./ 4910.3890/ ./ 8620.9230/ ./ 0970.0770/ ./ 1710.181/ 本文/ 从/ 总体/ 性能/ 、/ 扩展性/ 两个/ 方面/ 对/ 修复/ 方法/ 入/ 部分/ 的/ 规则/ 约束/ 替换成/ 上述/ 规则/ 即可/ ./ 同时/ ,/ 本文/ 使用/ 元组/ t/ 关于/ 属性/ A/ 的/ 属性/ 值/ t/ [/ A/ ]/ 作为/ 修复/ 的/ 基础/ 计数/ 单位/ ,/ 称为/ 元子/ ./ 在/ 此基础/ 之上/ ,/ 使用/ 准确率/ 、/ 召回/ 率/ 和/ F/ -/ measure/ 来/ 评价/ 检测/ 方法/ 的/ 效果/ ,/ 其中/ 检测/ 准确率/ Pd/ =/ 检测/ 错误/ 数/ 召回/ 率/ Rd/ =/ 检测/ 错误/ 数于/ 修复过程/ ,/ 只/ 需要/ 评价/ 方法/ 中/ 的/ 检测/ 错误/ 数/ 换成/ 正确/ 修复/ 数/ ,/ 得到/ 修复/ 准确率/ Pr/ 、/ 修复/ 召回/ 率/ Rr/ 以及/ 对应/ 的/ Fr/ -/ measure/ ./ 其中/ ,/ 检测/ 错误/ 数/ 和/ 正确/ 修复/ 数均/ 由/ 每次/ 迭代/ 检测/ 和/ 正确/ 修复/ 的/ 属性/ 值/ 个数/ 求/ 并/ 集/ 得到/ ./ 并且/ ,/ 召回/ 率越/ 高/ 说明/ 检测/ 和/ 修复/ 的/ 效果/ 越好/ ./ 5.2/ 实验/ 结果/ 进行/ 评估/ ./ 5.2/ ./ 1/ 总体/ 性能/ 对/ 修复/ 方法/ 的/ 总体/ 性能/ 进行/ 评价/ ./ 检测/ 和/ 修复/ 效果/ ./ 表/ 2/ 和表/ 3/ 分别/ 描述/ 了/ 在/ HOSP/ 和/ NBA/ 数据/ 集上/ 的/ 检测/ 效果/ 和/ 修复/ 效果/ ./ 从/ 实验/ 中/ 可以/ 看出/ :/ (/ 1/ )/ 检测/ 和/ 修复/ 方法/ 的/ 召回/ 率/ 比/ 对应/ 的/ 准确率/ 和/ F/ -/ measure/ 高/ ./ 准确率/ 由/ 数据/ 中/ 的/ 错误/ 比例/ 所/ 决定/ ,/ 对于/ HOSP/ 和/ NBA/ 数据/ 集/ ,/ 他们/ 的/ 错误率/ 分别/ 在/ 15/ %/ 和/ 11/ %/ 左右/ ,/ 另外/ ,/ 实际/ 检测/ 到/ 和/ 修复/ 正确/ 的/ 错误/ 数/ 还要/ 略少/ 一些/ ,/ 所以/ 得到/ 的/ 准确率/ 较/ 小/ ,/ 对应/ 的/ F/ -/ measure/ 也/ 较/ 小/ ;/ (/ 2/ )/ 对于/ CCFD/ +/ CC/ ,/ 其/ 修复/ 召回/ 率/ 和/ 检测/ 召回/ 率/ 分别/ 在/ 92/ %/ 以上/ 和/ 88/ %/ 以上/ ./ 这/ 说明/ 本文/ 提出/ 的/ 方法/ 具有/ 非常/ 显著/ 的/ 清洗/ 效果/ ./ 相比/ CFD/ +/ CC/ ,/ CCFD/ +/ CC/ 的/ 检测/ 结果/ 和/ 修复/ 结果/ 分别/ 高出/ 4/ %/ ~/ 6/ %/ 和/ 5/ %/ ~/ 6/ %/ ./ 清洗/ 过程/ 中/ ,/ 考虑/ 数据/ 之间/ 的/ 关联/ 关系/ 更/ 有利于/ 发现/ 数据/ 中/ 的/ 潜在/ 错误/ ;/ (/ 3/ )/ 从/ 召回/ 率/ 的/ 角度/ 来看/ ,/ 相比/ 单独/ 使用/ CCFD/ 和/ CC/ ,/ CCFD/ +/ CC/ 可以/ 得到/ 更加/ 准确/ 的/ 清洗/ 结果/ ,/ 其/ 检测/ 结果/ 和/ 修复/ 结果/ 分/ 首先/ ,/ 从/ 检测/ 和/ 修复/ 效果/ 、/ 运行/ 时间/ 、/ 迭代/ 情况/ Page12/ 别/ 高出/ 二者/ 总和/ 的/ 6/ %/ ~/ 10/ %/ 和/ 3/ %/ ~/ 4/ %/ ./ 这/ 说明/ 规则/ 之间/ 是/ 相互作用/ 的/ ,/ 并且/ 相互促进/ ./ 运行/ 时间/ ./ 图/ 4/ 描述/ 了/ 4/ 种/ 算法/ 中/ 各个/ 过程/ 的/ 运行/ 时间/ 分配情况/ ./ 总体/ 上/ 看/ ,/ CCFD/ +/ CC/ 的/ 运行/ 时间/ 最高/ ,/ 比/ CFD/ +/ CC/ 高出/ 7/ %/ ./ 这种/ 开销/ 是/ 由于/ 在/ 计算/ 相关/ 数据/ 过程/ 中/ ,/ 一些/ 数据/ 被/ 重复/ 计算所/ 产生/ 的/ ,/ 并且/ 开销/ 的/ 程度/ 是/ 可以/ 被/ 接受/ 的/ ./ 从/ 具体/ 的/ 时间/ 分配/ 上/ 看/ ,/ 错误/ 的/ 检测/ 、/ 定位/ 和/ 目标值/ 的/ 选取/ 这/ 3/ 个/ 过程/ 占/ 主要/ 时间/ 开销/ ./ 迭代/ 情况/ ./ 图/ 5/ 描述/ 了/ HOSP/ 数据/ 集上/ 的/ 迭代/ 情况/ ./ 每/ 一次/ 迭代/ 都/ 会/ 在/ 上/ 一次/ 迭代/ 的/ 基础/ 上/ 进行/ ./ 所以/ ,/ 随着/ 迭代/ 次数/ 的/ 增加/ ,/ 检测/ 和/ 修复/ 的/ 效果/ 越来越/ 准确/ ./ 对于/ HOSP/ 数据/ 集/ ,/ 从/ 第/ 5/ 次/ 迭代/ 开始/ 清洗/ 效果/ 趋于稳定/ ,/ 到/ 第/ 7/ 次/ 迭代/ 时/ ,/ 清洗/ 过程/ 终止/ ./ 5.2/ ./ 2/ 扩展性/ 接下来/ ,/ 本文/ 在/ 不同/ 规则/ 数量/ 和/ 不同/ 元组/ 数量/ 情况/ 下/ ,/ 研究/ 修复/ 方法/ 的/ 扩展性/ ./ 本/ 实验/ 分别/ 改变/ 规则/ 数量/ 和/ 元组/ 数量/ ,/ 观察/ HOSP/ 数据/ 集上/ 修复/ 召回/ 率/ 、/ 运行/ 时间/ 和/ 迭代/ 次数/ 的/ 变化/ 情况/ ./ 变化/ 的/ 规则/ 数量/ ./ 图/ 6/ 描述/ 了/ 在/ 规则/ 数量/ 变化/ 的/ 情况/ 下/ ,/ 清洗/ 方法/ 的/ 性能/ 变化/ ./ 横坐标/ 表示/ 混合/ 规则/ 的/ 数量/ ,/ “/ +/ ”/ 的/ 前后/ 分别/ 表示/ 混合/ 规则/ 中/ CCFD/ 的/ 数量/ 和/ CC/ 的/ 数量/ ./ 在/ 清洗/ 的/ 过程/ 中/ ,/ CCFD/ +/ CC/ 方法/ 使用/ 规则/ 总和/ 进行/ 修复/ ,/ CCFD/ 方法/ 和/ CC/ 方法/ 分别/ 使用/ 与/ 之/ 对应/ 的/ 规则/ 进行/ 修复/ ,/ CFD/ +/ CC/ 方法/ 则/ 将/ 其中/ 的/ CCFD/ 规则/ 拆/ 分成/ 等价/ 的/ CFD/ 规则/ 进行/ 修复/ ./ 从图/ 6/ (/ a/ )/ 可以/ 看出/ ,/ 修复/ 方法/ 的/ 召回/ 率受/ 规则/ 数量/ 的/ 影响/ 比较/ 明显/ ./ 这/ 说明/ 规则/ 集合/ 的/ 数量/ 越/ 多/ 、/ 越/ 完备/ ,/ 其/ 修复/ 的/ 效果/ 越好/ ./ 实验/ 中/ 所/ 给出/ 的/ 19/ +/ 22/ 条/ 规则/ 可以/ 检测/ 出/ 数据/ 中/ 92/ %/ 以上/ 的/ 错误/ ,/ 说明/ 这些/ 规则/ 与/ 数据/ 中/ 的/ 错误/ 是/ 最为/ 相关/ 的/ ./ 虽然/ 可以/ 通过/ 增加/ 规则/ 数量/ 的/ 方法/ 来/ 提高/ 检测/ 的/ 准确性/ ,/ 但是/ 效果/ 不会/ 非常明显/ ./ 所以/ ,/ 制定/ 高质量/ 的/ 清图/ 6/ 不同/ 规则/ 数量/ 的/ 清洗/ 结果/ (/ CCFD/ +/ CC/ )/ Page13/ 洗/ 规则/ ,/ 对/ 进行/ 数据/ 修复/ 至关重要/ ./ 从图/ 6/ (/ b/ )/ 可以/ 看出/ ,/ CCFD/ 和/ CC/ 分别/ 呈现/ 正比/ 增长/ 和/ 二次/ 幂数/ 增长/ ,/ 混合/ 后/ 的/ CFD/ +/ CC/ 和/ CCFD/ +/ CC/ 介于/ 两者之间/ 并/ 大于/ CCFD/ 的/ 增长速度/ ./ 从图/ 6/ (/ c/ )/ 可以/ 看出/ ,/ 迭代/ 次数/ 随/ 规则/ 数量/ 增加/ 快速/ 上升/ ./ 需要/ 说明/ 的/ 是/ ,/ 规则/ 数量/ 的/ 增加/ 可能/ 增加/ 修复/ 序列/ 的/ 长度/ ,/ 进而/ 增加/ 清洗/ 的/ 迭代/ 次数/ 和/ 清洗/ 时间/ ./ 另一方面/ ,/ 由于/ 每次/ 迭代/ 后/ 都/ 需要/ 重新/ 对/ 修复/ 序列/ 进行/ 计算/ ,/ 所以/ 无法/ 对/ 清洗/ 的/ 迭代/ 次数/ 和/ 运行/ 时间/ 进行/ 估计/ ./ 在/ 实际操作/ 时/ ,/ 如果/ 运行/ 的/ 时间/ 过长/ ,/ 可以/ 在/ 清洗/ 效果/ 满足用户/ 需求/ 的/ 情况/ 下/ 人为/ 地/ 进行/ 程序/ 终止/ ./ 变化/ 的/ 元组/ 数量/ ./ 图/ 7/ 描述/ 了/ 在/ HOSP/ 数据/ 集上/ 元组/ 数量/ 的/ 变化/ 对/ 清洗/ 方法/ 的/ 性能/ 影响/ ./ 从图/ 7/ (/ a/ )/ 可以/ 看出/ ,/ 元组/ 数量/ 对/ 修复/ 召回/ 率/ 影响/ 较/ 小/ ./ 新/ 添加/ 的/ 元组/ 中/ 可能/ 会/ 包含/ 一些/ 关联/ 数据/ ,/ 也/ 可能/ 会/ 夹杂/ 一些/ 新/ 的/ 错误/ 数据/ ,/ 这些/ 会/ 对/ 请/ 洗/ 的/ 结果/ 产生/ 波动/ ./ 从图/ 7/ (/ b/ )/ 可以/ 看出/ ,/ 4/ 种/ 修复/ 方法/ 的/ 运行/ 时间/ 呈/ 二次/ 幂数/ 增长/ ./ 因为/ 在/ 第/ 4/ 节中/ 各项/ 算法/ 复杂度/ 分析/ 中/ ,/ 关于/ 元组/ 数量/ I/ ,/ 数据/ 检测/ 和/ 错误/ 定位/ 的/ 复杂度/ 均/ 为/ |/ I/ |/ 2/ ,/ 而/ 目标值/ 选取/ 的/ 复杂度/ 虽然/ 为/ |/ I/ |/ 3/ ,/ 但/ 实际/ 的/ 错误/ 量会/ 趋近/ 于/ |/ I/ |/ 2/ ,/ 所以/ 整个/ 方法/ 的/ 运行/ 时间/ 呈/ 二次/ 幂数/ 增长/ ./ 特别/ ,/ 在/ 处理/ “/ 大/ 数据/ ”/ 的/ 一致性/ 和/ 实效性/ 的/ 清洗/ 问题/ 时/ ,/ 并且/ 结合/ 图/ 6/ 给出/ 的/ 结论/ ,/ 可以/ 通过/ 适当/ 减少/ 迭代/ 次数/ 进行/ 清洗/ ,/ 既/ 可以/ 缩短/ 运行/ 时间/ ,/ 又/ 不会/ 损失/ 很大/ 的/ 清洗/ 精度/ ./ 对于/ 本文/ 使用/ 的/ 数据/ 集/ ,/ 建议/ 迭代/ 次数/ 缩短/ 到/ 原来/ 的/ 70/ %/ 以上/ 即可/ ./ 如果/ 采用/ 并行计算/ ,/ 可以/ 将/ 数据/ 按照/ 80KB/ 进行/ 分片/ ./ 从图/ 7/ (/ c/ )/ 可以/ 看出/ ,/ 迭代/ 次数/ 随/ 元组/ 数量/ 的/ 增长/ 而/ 缓慢/ 上升/ ./ 这/ 是因为/ 新/ 增加/ 的/ 元组/ 中/ 可能/ 会/ 夹杂/ 一些/ 新/ 的/ 潜在/ 错误/ ,/ 从而/ 增加/ 了/ 迭代/ 次数/ ./ 通过/ 上述/ 的/ 总体/ 性能/ 实验/ 和/ 扩展性/ 实验/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 方法/ 可以/ 有效/ 地/ 解决/ 数据/ 中/ 一致性/ 和/ 时效性/ 的/ 混合/ 错误/ ,/ 并/ 保持/ 较/ 高/ 的/ 清洗/ 效率/ ./ 6/ 结束语/ 基于/ 条件/ 合并/ 的/ 函数/ 依赖/ CCFDs/ 和/ 时效/ 约束/ CCs/ ,/ 本文/ 提出/ 了/ 一种/ 关于/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 的/ 清洗/ 方法/ ./ 利用/ CCFDs/ 将/ 关联/ 数据/ 放在/ 一起/ ,/ 用以/ 检测/ 出/ 数据/ 中/ 的/ 潜在/ 错误/ ;/ 同时/ 将/ CCFDs/ 和/ CCs/ 进行/ 混合/ ,/ 用以/ 解决/ 一致性/ 和/ 时效性/ 的/ 混合/ 问题/ ./ 本文/ 对/ CCFDs/ 和/ CCs/ 混合/ 的/ 基本/ 问题/ 进行/ 分析/ ,/ 并且/ 分别/ 证明/ 了/ 混合/ 规则/ 的/ 可/ 满足/ 性/ 问题/ 和/ 蕴含/ 问题/ 均/ 是/ co/ -/ NP/ 完全/ 问题/ ./ 为了/ 对/ 错误/ 数据/ 进行/ 修复/ ,/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 自动/ 清洗/ 框架/ ./ 由于/ 清洗/ 中/ 的/ 检测/ 过程/ 和/ 修复过程/ 的/ 相互作用/ 关系/ ,/ 本/ 框架/ 采用/ 一种/ 迭代/ 的/ 方法/ 对/ 数据/ 进行/ 修复/ ./ 基于/ 本文/ 提出/ 的/ 关联/ 数据/ 的/ 修复/ 代价/ 模型/ ,/ 进一步/ 证明/ 了/ 关于/ 关联/ 数据/ 的/ 一致性/ 和/ 时效性/ 的/ 最小/ 代价/ 修复/ 问题/ 是/ 一个/ Σ/ p/ 启发式/ 方法/ 对/ 数据/ 进行/ 修复/ ./ 此外/ ,/ 为了/ 得到/ 正确/ 的/ 修复/ 顺序/ ,/ 本文/ 提出/ 了/ 修复/ 序列图/ 的/ 概念/ ,/ 有助于/ 找到/ 需要/ 优先/ 修复/ 的/ 错误/ 数据/ ./ 最后/ ,/ 通过/ HOSP/ 和/ NBA/ 两组/ 真实/ 数据/ 集上/ 进行/ 实验/ ,/ 证明/ 了/ 本文/ 提出/ 的/ 修复/ 方法/ 的/ 实用性/ 和/ 高效性/ ./ Page14/ 未来/ 我们/ 将/ 继续/ 致力于/ 研究/ 数据/ 检测/ 和/ 数据/ 修复/ 的/ 相关/ 问题/ ./ 我们/ 将/ 重点/ 研究/ :/ 对于/ 检测/ 出/ 的/ 错误/ ,/ 是/ 选择/ 对/ 错误/ 数据/ 进行/ 修复/ 还是/ 对/ 规则/ 进行/ 修复/ ,/ 并且/ 如何/ 修复/ ./ 

