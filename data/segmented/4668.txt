Page1/ 近场/ 通信/ 技术/ 的/ 安全/ 研究进展/ 与/ 发展趋势/ 刘奇旭/ 1/ )/ 1/ )/ (/ 中国科学院/ 大学/ 国家/ 计算机网络/ 入侵/ 防范/ 中心/ 北京/ 101408/ )/ 2/ )/ (/ 北京/ 电子科技/ 学院/ 北京/ 100070/ )/ 3/ )/ (/ 西安电子科技大学/ 综合/ 业务网/ 理论/ 及/ 关键技术/ 国家/ 重点/ 实验室/ 西安/ 710071/ )/ 摘要/ 随着/ 移动/ 互联网/ 和/ 移动/ 支付/ 的/ 发展/ ,/ NFC/ 技术/ 因/ 其/ 天然/ 的/ 安全/ 特性/ 和/ 便利性/ ,/ 成为/ 运营商/ 、/ 银行/ 、/ 厂商/ 等/ 热/ 捧/ 的/ 对象/ ./ 由于/ 涉及/ 到/ 移动/ 支付/ 和/ 敏感/ 信息/ 的/ 传输/ ,/ 该/ 技术/ 也/ 受到/ 安全/ 研究/ 人员/ 和/ 攻击者/ 的/ 广泛/ 关注/ ./ 虽然/ 国内外/ 安全/ 专家/ 和/ 学者/ 对/ NFC/ 安全/ 问题/ 已/ 进行/ 了/ 一定/ 的/ 研究/ ,/ 但/ 目前/ 还/ 没有/ 详细/ 和/ 全面/ 介绍/ 最新/ 安全/ 研究成果/ 的/ 论文/ ./ 为/ 解决/ 此/ 问题/ ,/ 该文/ 分析/ 和/ 总结/ 了/ 国内外/ 最新/ 的/ 研究成果/ ,/ 并/ 对/ NFC/ 安全/ 问题/ 未来/ 的/ 研究/ 方向/ 进行/ 了/ 展望/ ./ 首先/ ,/ 介绍/ 了/ NFC/ 技术/ 的/ 基本/ 特性/ 、/ 通信/ 过程/ 、/ 协议/ 栈/ 、/ 工作/ 模式/ 等/ ,/ 分析/ 了/ 该/ 技术/ 面临/ 的/ 安全/ 威胁/ ,/ 包括/ 通信安全/ 、/ 安全漏洞/ 、/ 安全/ 元件/ 、/ 恶意软件/ 、/ 网络/ 钓鱼/ 等/ 内容/ ./ 然后/ ,/ 通过/ 分析/ 相关/ 研究/ 工作/ ,/ 总结/ 了/ NFC/ 技术/ 的/ 安全/ 研究/ 现状/ ./ 最后/ ,/ 从/ 安全/ 威胁/ 的/ 角度/ ,/ 对/ 未来/ 的/ 研究/ 方向/ 进行/ 展望/ ,/ 在/ 安全/ 信道/ 、/ 漏洞/ 挖掘/ 、/ 安全/ 元件/ 、/ 恶意软件/ 检测/ 、/ 恶意/ 内容/ 检测/ 、/ 移动/ 支付/ 等/ 方面/ 分析/ 了/ 研究/ 内容/ 和/ 研究/ 方法/ ./ 关键词/ 近/ 场/ 通信/ 技术/ ;/ 安全/ 威胁/ ;/ 研究进展/ ;/ 发展趋势/ ;/ 网络安全/ ;/ 信息安全/ ;/ 网络空间/ 安全/ 1/ 引言/ NFC/ (/ NearFieldCommunication/ )/ 技术/ 是/ 一种/ 近距离/ 的/ 双向/ 高频/ 无线通信/ 技术/ ,/ 能够/ 在/ 移动/ 终端/ 、/ 智能/ 标签/ (/ Tag/ )/ 等/ 设备/ 间/ 进行/ 非/ 接触式/ 数据交换/ [/ 1/ -/ 3/ ]/ ./ NFC/ 技术/ 具有/ 通信/ 距离/ 短/ 、/ 一次/ 只/ 和/ 一台/ 设备/ 连接/ 、/ 硬件安全/ 模块/ 加密/ 等/ 特点/ ,/ 具有/ 较/ 好/ 的/ 保密性/ 和/ 安全性/ ./ 由于/ NFC/ 技术/ 天然/ 的/ 保密性/ 和/ 安全性/ ,/ 所以/ 该/ 技术/ 受到/ 移动/ 支付/ 厂商/ 、/ 运营商/ 、/ 银行/ 等/ 的/ 重视/ 和/ 推广/ ./ 当前/ 主流/ 的/ 移动/ 支付/ [/ 4/ ]/ 包括/ 运营商/ 计费/ 、/ 手机/ 外设/ 支付/ [/ 5/ ]/ 、/ NFC/ 支付/ [/ 6/ -/ 7/ ]/ 、/ 图像识别/ 支付/ [/ 8/ ]/ 、/ 条形码/ // 二维码/ 支付/ [/ 9/ -/ 12/ ]/ 、/ 生物/ 特征/ 识别/ 支付/ [/ 13/ -/ 15/ ]/ 、/ 超声波/ 支付/ [/ 16/ ]/ 等/ 支付/ 方式/ ./ 运营商/ 计费/ 是/ 指/ 用户/ 通过/ 短信/ 等/ 方式/ 对/ 支付/ 的/ 行为/ 进行/ 授权/ ,/ 运营商/ 处理/ 用户/ 的/ 支付/ 行为/ 并/ 从/ 用户/ 的/ 账户/ 中/ 扣除/ 相应/ 的/ 费用/ ./ 例如/ ,/ 用户/ 通过/ 短信/ 代码/ 购买/ 网络流量/ ,/ 运营商/ 根据/ 价格/ 从/ 用户/ 的/ 手机号/ 账户/ 中/ 扣除/ 流量/ 费用/ ./ 该/ 支付/ 方式/ 的/ 支付/ 过程/ 比较简单/ 和/ 直接/ ,/ 是/ 移动/ 支付/ 最初/ 的/ 支付/ 方式/ ,/ 但/ 其/ 支付/ 范围/ 和/ 扣费/ 方式/ 具有/ 一定/ 的/ 局限性/ ,/ 且/ 安全性/ 较差/ ./ 手机/ 外设/ 支付/ 是/ 指/ 通过/ 插入/ 手机/ 音频/ 、/ 基座/ 等/ 接口/ 的/ 硬件/ 设备/ 读取/ 银行卡/ 获取/ 账号/ 信息/ ,/ 并/ 完成/ 支付/ 的/ 过程/ ./ 比较/ 典型/ 的/ 支付/ 例子/ 包括/ Square/ 、/ 拉/ 卡拉/ 、/ 盒子/ 支付/ 等/ ./ 该/ 支付/ 方式/ 通过/ 硬件/ 读取/ 银行卡/ 信息/ ,/ 安全性/ 比较/ 高/ ,/ 应用/ 的/ 范围/ 比较/ 广/ ,/ 局限性/ 较/ 小/ ,/ 但/ 该/ 方式/ 需要/ 用户/ 和/ 商家/ 配置/ 读卡/ 的/ 硬件/ 设备/ ,/ 增大/ 了/ 支付/ 的/ 硬件/ 成本/ ./ NFC/ 支付/ 是/ 指/ 通过/ 移动/ 终端/ 的/ NFC/ 模块/ 读取/ 银行卡/ 获取/ 账户/ 信息/ 来/ 完成/ 支付/ 的/ 过程/ ./ 该/ 支付/ 方式/ 具有/ 良好/ 的/ 保密性/ 和/ 安全性/ ,/ 且/ 当/ NFC/ 手机/ 没电时/ 也/ 能/ 完成/ 支付/ ./ 因此/ ,/ 该/ 方式/ 是/ 目前/ 比较/ 受/ 推崇/ 的/ 一种/ 支付/ 手段/ ./ 图像识别/ 支付/ 是/ 指/ 通过/ 图像识别/ 技术/ 扫描/ 银行卡/ 等/ 卡片/ 信息/ 来/ 获取/ 用户/ 的/ 账号/ 信息/ 完成/ 支付/ 的/ 过程/ ./ 该/ 支付/ 方式/ 受/ 识别/ 过程/ 的/ 环境影响/ 较大/ ,/ 且/ 无法/ 保证/ 卡片/ 的/ 安全性/ 和/ 真实性/ ,/ 具有/ 很大/ 的/ 安全隐患/ ./ 条形码/ // 二维码/ 支付/ 是/ 指/ 通过/ 移动/ 终端/ 扫描/ 条形码/ // 二维码/ 获取/ 商品信息/ ,/ 并/ 通过/ 银行卡/ 、/ 电子/ 钱包/ 等/ 手段/ 完成/ 支付/ 的/ 过程/ ./ 该/ 支付/ 方式/ 可以/ 与/ 手机/ 外设/ 支付/ 、/ NFC/ 支付/ 、/ 图像识别/ 支付/ 等/ 结合/ ,/ 共同完成/ 支付/ 过程/ ./ 该/ 支付/ 方式/ 易于/ 实现/ ,/ 支付/ 便捷/ ,/ 但/ 容易/ 受到/ 虚假/ 或/ 恶意/ 条形码/ // 二维码/ 的/ 攻击/ ,/ 安全性/ 较差/ ./ 生物/ 特征/ 识别/ 支付/ 是/ 指以/ 人脸/ 、/ 虹膜/ 、/ 指纹/ 等/ 生物/ 特征/ 作为/ 安全/ 校验/ 手段/ ,/ 来/ 完成/ 支付/ 的/ 过程/ ./ 生物/ 特征/ 具有/ 唯一性/ ,/ 能够/ 保证/ 支付/ 过程/ 的/ 安全性/ ,/ 但/ 某些/ 人/ 、/ 群体/ 的/ 生物/ 特征/ 难/ 成像/ ,/ 识别/ 困难/ ,/ 且/ 容易/ 受到/ “/ 复制/ 生物/ 特征/ ”/ 的/ 安全/ 威胁/ ./ 例如/ ,/ 通过/ 整容手术/ 可/ 实现/ 相似/ 的/ 面部/ 特征/ ,/ 通过/ 复制/ 指纹/ 痕迹/ 可/ 重现/ 用户/ 指纹/ 等/ ./ 超声波/ 支付/ 是/ 指/ 通过/ 手机/ 客户端/ 发出/ 超声波/ ,/ 终端设备/ 获取/ 声波/ 并/ 转化/ 为/ 支付/ 交易/ 号/ ,/ 进而/ 通过/ 订单/ 支付/ 完成/ 交易/ 的/ 过程/ ./ 该/ 支付/ 方式/ 需要/ 依赖/ 网络/ 信号/ 的/ 质量/ ,/ 这是/ 超声波/ 支付/ 的/ 先天/ 缺点/ ,/ 使得/ 用户/ 体验/ 大打折扣/ ,/ 且/ 需要/ 增加/ 一定/ 的/ 硬件/ 成本/ ./ 以上/ 简单/ 介绍/ 了/ 几种/ 主流/ 的/ 移动/ 支付/ 手段/ ,/ 从/ 安全性/ 、/ 硬件/ 成本/ 、/ 用户/ 体验/ 等/ 方面/ 综合/ 分析/ ,/ NFC/ 支付/ 是/ 未来/ 最有/ 前景/ 的/ 支付/ 手段/ 之一/ ./ 随着/ 物/ 联网/ 和/ 电子商务/ 的/ 发展/ ,/ NFC/ 技术/ 被/ 迅速/ 推广/ 并/ 应用/ 于/ 移动/ 终端/ 等/ 支持/ NFC/ 技术/ 的/ 设备/ 上/ ./ 根据/ 研究/ 公司/ IHSTechnology/ 的/ 统计/ 报告/ ①/ ,/ 在/ 2013/ 年/ 的/ 智能手机/ 市场/ 上/ ,/ 配备/ NFC/ 功能/ 的/ 智能手机/ 出货量/ 从/ 2012/ 年/ 的/ 1.2/ 亿台/ 上升/ 到/ 2.75/ 亿台/ ,/ 增幅/ 达到/ 128/ %/ ./ 根据/ IHS/ 的/ 统计/ 报告/ ,/ 2014/ 年/ NFC/ 智能手机/ 出货量/ 在/ 2013/ 年/ 的/ 基础/ 上/ 增长/ 50/ %/ 多/ ,/ 达到/ 4.44/ 亿台/ ;/ 总体而言/ ,/ 到/ 2018/ 年/ ,/ 该类/ 智能手机/ 出货量/ 将/ 在/ 2013/ 年/ 的/ 基础/ 上/ 增长/ 325/ %/ ,/ 达到/ 12/ 亿台/ ./ 这些/ 数据/ 从/ 侧面/ 反映/ 了/ NFC/ 技术/ 在/ 移动/ 领域/ 逐渐/ 被/ 推广/ 和/ 应用/ ./ 虽然/ NFC/ 技术/ 具有/ 天然/ 的/ 保密性/ 和/ 安全性/ ,/ 但/ 其/ 安全性/ 仍/ 受到/ 很多/ 威胁/ 和/ 挑战/ ./ 2012/ 年/ 2/ 月/ ,/ zvelo/ 公司/ 发现/ 一个/ 谷歌/ 电子/ 钱包/ NFC/ 支付/ 系统/ 的/ 漏洞/ ,/ 通过/ 该/ 漏洞/ 可/ 暴力/ 获取/ PIN/ 码盗/ 刷/ 用户/ 的/ 信用卡/ ,/ 这个/ 漏洞/ 需要/ Root/ 权限/ 且/ 未/ 设置/ 锁屏/ 密码/ ②/ ./ 随后/ ,/ TheSmartphoneChamp/ 又/ 发现/ 了/ 不/ 需/ ①/ ②/ Page3Root/ 权限/ 即可/ 获取/ PIN/ 码/ 的/ 漏洞/ ,/ 通过/ 在/ 设置/ 菜单/ 清空/ 数据/ 即可/ 设置/ 新/ 的/ PIN/ 码/ ①/ ./ 2012/ 年/ 7/ 月/ ,/ 在/ Blackhat/ 大会/ 上/ ,/ Accuvant/ 实验室/ 首席/ 顾问/ Miller/ 利用/ Android/ 操作系统/ 的/ NFC/ 漏洞/ ,/ 读取/ 并/ 自动/ 开启/ 网址/ 下载/ 恶意软件/ ,/ 来/ 入侵/ 移动/ 设备/ [/ 17/ ]/ ./ 同年/ 9/ 月/ ,/ Intrepidus/ 公司/ 的/ CoreyBenninger/ 和/ MaxSobell/ 在/ EUSecWest/ 会议/ ②/ 上/ 利用/ NFC/ 支付/ 漏洞/ 实现/ 零/ 花费/ 的/ 刷卡/ ,/ 该/ 漏洞/ 波及/ 波士顿/ 、/ 费城/ 、/ 芝加哥/ 等/ 多个/ 城市/ 的/ 地铁/ 系统/ ./ 2014/ 年/ ,/ “/ NFC/ 手机/ 能够/ 轻松/ 读取/ 银行卡/ 信息/ ”/ 的/ 新闻/ 迅速/ 传播/ ,/ 引发/ 了/ 人们/ 对/ NFC/ 技术/ 的/ 担忧/ ③/ ./ 虽然/ 读取/ 的/ 银行卡/ 信息/ 不能/ 影响/ 银行卡/ 的/ 交易/ 安全/ ,/ 但/ 在/ 一定/ 程度/ 上/ 造成/ 了/ 个人信息/ 的/ 泄露/ ./ 随着/ NFC/ 技术/ 的/ 推广/ 和/ 应用/ ,/ 尤其/ 在/ 移动/ 支付/ 领域/ ,/ NFC/ 安全/ 问题/ 越来越/ 受/ 关注/ ,/ 国内外/ 已经/ 逐步/ 开始/ 对/ NFC/ 安全/ 问题/ 进行/ 深入/ 的/ 研究/ ./ 不管/ 从/ 理论/ 还是/ 实践/ 的/ 角度/ ,/ 国内外/ 学者/ 提出/ 了/ 各种/ 攻击/ 向量/ 、/ 防御/ 措施/ 和/ 解决方案/ ,/ 取得/ 了/ 很多/ 研究成果/ ./ 然而/ ,/ 目前/ 还/ 没有/ 详细/ 而/ 全面/ 介绍/ 这些/ 最新/ 研究成果/ 的/ 综述/ 论文/ ./ 为了/ 深入/ 理解/ NFC/ 技术/ 的/ 原理/ 、/ 面临/ 的/ 安全/ 威胁/ 、/ 防御/ 方案/ 及/ 未来/ 安全/ 研究/ 发展趋势/ ,/ 并/ 掌握/ 国内外/ 研究/ 的/ 新动向/ ,/ 阐述/ 和/ 总结/ NFC/ 技术/ 及/ 安全/ 研究/ 的/ 发展趋势/ 具有/ 重要/ 的/ 意义/ ./ 本文/ 第/ 2/ 节/ 介绍/ NFC/ 协议/ 栈/ 和/ 工作/ 模式/ 技术/ ;/ 第/ 3/ 节/ 介绍/ NFC/ 技术/ 面临/ 的/ 安全/ 威胁/ ;/ 第/ 4/ 节/ 介绍/ NFC/ 安全/ 研究/ 现状/ ;/ 第/ 5/ 节/ 分析/ 未来/ 的/ 研究/ 方向/ ;/ 最后/ 是/ 结束语/ ./ 2NFC/ 协议/ 栈/ 和/ 工作/ 模式/ 2.1/ 通信/ 过程/ 和/ 基本/ 设备/ 为了/ 更好/ 地/ 描述/ NFC/ 协议/ 栈/ 和/ 工作/ 模式/ ,/ 首先/ 简单/ 介绍/ 下/ NFC/ 的/ 通信/ 过程/ 和/ 基本/ 设备/ ./ NFC/ 通信/ 是/ 指/ NFC/ 设备/ 之间/ 或/ NFC/ 设备/ 与/ NFC/ 标签/ 之间/ 的/ 数据传输/ [/ 18/ ]/ ./ 其中/ ,/ NFC/ 设备/ 是/ 指/ NFC/ 通信/ 的/ 读写/ 设备/ 和/ 操作/ 对象/ ,/ 可/ 作为/ 通信/ 的/ 发起者/ (/ Initiator/ )/ 或/ 目标/ (/ Target/ )/ ④/ ,/ 包括/ NFC/ 读写器/ 和/ NFC/ 电子标签/ ./ NFC/ 读写器/ 包括/ NFC/ 控制器/ (/ NFCController/ )/ 、/ 主/ 控制器/ (/ HostController/ )/ 、/ 安全/ 元件/ (/ SecureElement/ )/ 和/ 天线/ ,/ 如图/ 1/ 所示/ ./ NFC/ 控制器/ ,/ 也/ 称/ NFC/ 芯片/ ,/ 负责/ 将/ 数字信号/ 转换/ 为/ 射频/ 信号/ ,/ 并/ 通过/ 13.56/ MHz/ 天线/ 发送/ ;/ 同时/ 负责/ 接收/ 射频/ 信号/ ,/ 并/ 将/ 其/ 转换/ 为/ 数字信号/ ,/ 与/ 主/ 控制器/ 和/ 安全/ 元件/ 进行/ 通信/ ./ 主/ 控制器/ ,/ 负责/ 实现/ 对/ NFC/ 控制器/ 的/ 控制/ 和/ 操作/ 以及/ 与/ 安全/ 元件/ 之间/ 通过/ 私有/ 接口/ 进行/ 数据/ 交互/ ./ 安全/ 元件/ ,/ 用于/ 存储/ 敏感数据/ ,/ 例如/ 密钥/ 、/ 余额/ 等/ ,/ 通过/ NFC/ 控制器/ 与/ 外界/ 设备/ 进行/ 通信/ ,/ 保证数据/ 存储/ 和/ 交易过程/ 的/ 安全性/ ./ 天线/ ,/ 通过/ 无线/ 接口/ 与/ NFC/ 控制器/ 进行/ 通信/ ,/ 实现/ 13.56/ MHz/ 射频/ 信号/ 的/ 发射/ 与/ 接收/ ./ 此外/ ,/ NFC/ 电子标签/ 是/ 存储/ 数据/ 的/ IC卡/ ,/ 能够/ 被/ NFC/ 读写/ 设备/ 读取/ ,/ 可/ 作为/ 通信/ 的/ 目标/ (/ Target/ )/ ./ 2.2/ 协议/ 栈/ NFC/ 是/ 在/ RFID/ 的/ 基础/ 上/ 演变/ 而来/ 的/ ,/ 其/ 协议/ 规范/ 也/ 是/ 基于/ RFID/ 的/ 众多/ 标准/ 制定/ 和/ 扩展/ 的/ ,/ 可/ 分为/ 物理层/ (/ PhysicalLayer/ )/ 、/ 数据/ 链路层/ (/ DataLinkLayer/ )/ 、/ 协议/ 层/ (/ ProtocolLayer/ )/ 和/ 应用层/ (/ ApplicationLayer/ )/ [/ 17/ ]/ ./ 物理层/ ,/ 是/ NFC/ 协议/ 参考模型/ 的/ 最底层/ ,/ 它/ 包括/ 物理/ 通信/ 媒介/ 及其/ 物理/ 特性/ ,/ 该层/ 主要/ 的/ 作用/ 是/ 产生/ 并/ 检测/ 磁场/ 以便/ 发送/ 和/ 接收/ 携带/ 数据/ 的/ 信号/ ,/ 为/ 上层/ 提供/ 一个/ 通信/ 媒介/ 以及/ 它们/ 的/ 机械/ 、/ 电气/ 、/ 功能/ 和/ 规程/ 特性/ ./ 例如/ 邻近/ 集成电路/ 卡/ (/ ProximityIntegratedCircuitCard/ ,/ PICC/ )/ 特性/ 、/ 天线/ 、/ 交变/ 磁场/ 、/ 工作频率/ 、/ 输出功率/ 等/ ./ 物理层/ 的/ 协议/ 主要/ 有/ ISO14443A/ -/ 1/ // ISO18092/ 、/ ISO14443B/ -/ 1/ 、/ FelicaJISX6319/ -/ 4/ // ISO18092/ ⑤/ 等/ ,/ 其中/ NFCA/ 、/ NFCB/ 和/ NFCF/ 是/ ①/ ②/ ③/ ④/ ⑤/ tions/ // files/ // ECMA/ -/ ST/ // Ecma/ -/ 340/ ./ pdf/ ,/ 2015/ ,/ 1/ ,/ 9Page4/ 指/ NFCTag/ 的/ 3/ 种/ 协议/ ,/ 分别/ 代表/ 遵循/ ISO14443TypeA/ 、/ ISO14443TypeB/ 和/ ISO18092/ (/ JISX6319/ -/ 4/ )/ 标准/ 的/ 协议/ ,/ 三者/ 的/ 主要/ 区别/ 在于/ 所/ 关注/ 的/ 调制/ 方式/ 、/ 编码方案/ 和/ 协议/ 初始化/ 程序/ 不同/ ./ 数据/ 链路层/ 可/ 分为/ 两层/ :/ 媒体/ 接入/ 控制/ 层/ (/ MediaAccessControl/ )/ 和/ 逻辑/ 链路/ 控制/ 层/ (/ LogicalLinkControl/ )/ ./ 媒体/ 接入/ 控制/ 层/ ,/ 主要/ 负责/ 控制/ 与/ 连接/ 物理层/ 的/ 物理介质/ ,/ 描述/ 了/ 工作频率/ 、/ 磁场强度/ 、/ 不同/ 设备/ 之间/ 的/ 通信/ 信号/ 调制/ 和/ 解调/ 等/ 特性/ ,/ 代表/ 协议/ 主要/ 有/ ISO14443A/ -/ 2/ // ISO18092/ 、/ ISO14443B/ -/ 2/ 、/ FelicaJISX6319/ -/ 4/ // ISO18092/ 等/ ./ 逻辑/ 链路/ 控制/ 层/ ,/ 主要/ 定义/ 了/ 磁场/ 内/ 轮询/ 、/ 帧/ 格式/ 、/ 命令/ 的/ 请求/ 和/ 应答/ 、/ 冲突检测/ 机制/ 、/ 通信/ 链路/ 初始化/ 等/ ,/ 与/ LLC/ 层/ 一起/ 控制协议/ 层/ 与/ 物理层/ 之间/ 的/ 通信/ ,/ 代表/ 协议/ 主要/ 有/ ISO14443A/ -/ 3/ // ISO18092/ 、/ ISO14443B/ -/ 3/ 、/ FelicaJISX6319/ -/ 4/ // ISO18092/ 等/ ./ 协议/ 层/ ,/ 该层/ 类似/ 于/ OSI/ 七层/ 模型/ 中/ 的/ 传输层/ ,/ 负责/ 非/ 接触/ 环境/ 下/ 数据/ 的/ 半双工/ 数据/ 块/ 的/ 传输/ ./ 代表/ 协议/ 有/ Topaz/ 、/ MIFARE/ 、/ MIFAREUltralight/ 、/ ISO14443A/ -/ 4/ 、/ ISO14443B/ -/ 4/ 、/ LLCP/ 等/ ,/ 这些/ 协议/ 定义/ 了/ 近/ 耦合/ 磁场/ 环境/ 下/ 的/ 数据/ 发送/ 、/ 接收/ 等/ 命令/ 格式/ 和/ 数据传输/ 流程/ ./ 协议/ 层/ 是/ 在/ 数据通信/ 过程/ 中/ 真正/ 传输/ 和/ 发送数据/ 的/ 层/ ,/ 通信/ 载荷/ 可以/ 是/ 任意/ 格式/ 的/ 数据/ ,/ 载荷/ 数据/ 一般/ 由/ 应用层/ 协议/ 定义/ ./ 应用层/ 为/ NFC/ 协议/ 参考模型/ 的/ 顶层/ ,/ 用于/ 为/ 用户/ 提供/ 各种/ 应用服务/ ./ 该层/ 协议/ 主要/ 指/ NFC/ 数据交换/ 格式/ (/ NFCDataExchangeFormat/ ,/ NDEF/ )/ 协议/ ,/ 其/ 定义/ 了/ 用户/ 数据交换/ 的/ 各类/ 报文/ ,/ 例如/ URI/ 、/ TEXT/ 、/ SmartPoster/ 等/ 类型/ 报文/ ./ 2.3/ 工作/ 模式/ NFC/ 工作/ 模式/ 是/ 指/ NFC/ 设备/ 之间/ 的/ 通信/ 方式/ 和/ 操作过程/ ,/ 文献/ [/ 1/ ,/ 7/ ,/ 18/ ]/ 也/ 称之为/ 通信/ 模式/ 或/ 操作/ 模式/ (/ 参见/ 前页/ 脚注/ ⑤/ )/ ./ 这里/ 把/ 通信/ 模式/ 和/ 工作/ 模式/ 看成/ 按照/ 不同/ 参照/ 划分/ 的/ 种类/ ,/ 按照/ 通信/ 的/ 发起者/ 划分/ ,/ 工作/ 模式/ 可/ 分为/ 主动/ 模式/ (/ Activiemode/ )/ 和/ 被动模式/ (/ Passivemode/ )/ ①/ ./ 在/ 主动/ 模式/ 下/ ,/ 通信/ 双方/ 均/ 产生/ RF/ 场/ ;/ 在/ 被动模式/ 下/ ,/ 只有/ 通信/ 发起者/ 产生/ RF/ 场/ ./ 在/ 主动/ 模式/ 下/ ,/ 发起者/ 和/ 目标/ 设备/ 均/ 产生/ RF/ 场/ ,/ 并/ 使用/ 各自/ 的/ RF/ 场/ 传输数据/ ./ 发起者/ 按照/ 选定/ 的/ 传输速度/ 进行/ 通信/ ,/ 目标/ 设备/ 按/ 相同/ 的/ 速度/ 应答/ ./ 发起者/ 可以/ 选择/ 106kbps/ 、/ 212kbps/ 或/ 424kbps/ 其中/ 一种/ 传输速度/ ,/ 目标/ 设备/ 必须/ 按照/ 相同/ 的/ 速度/ 将/ 数据/ 传回/ 发起者/ ;/ 在/ 被动模式/ 下/ ,/ 发起者/ 按照/ 选定/ 的/ 传输速度/ 发起/ 通信/ ,/ 目标/ 设备/ 以/ 加载/ 调制/ 的/ 方式/ 响应/ 发起者/ 命令/ ,/ 按照/ 相同/ 的/ 传输速度/ 应答/ ./ 从/ 产生/ RF/ 场/ 的/ 角度看/ ,/ 发起者/ 是/ 主动/ 的/ ,/ 目标/ 设备/ 是/ 被动/ 的/ ./ 因此/ ,/ 单纯/ 的/ 从/ 产生/ RF/ 场/ 的/ 角度/ 来/ 区别/ 发起者/ 和/ 目标/ 设备/ 是/ 不/ 合适/ 的/ ,/ 因为/ 在/ 主动/ 模式/ 下/ 两者/ 均/ 产生/ RF/ 场/ ,/ 应该/ 从/ 通信/ 的/ 发起者/ 来/ 区分/ 发起者/ 和/ 目标/ 设备/ ./ 按照/ 通信/ 的/ 对象/ 划分/ ,/ 可/ 分为/ 点对点/ 模式/ (/ P2Pmode/ )/ 、/ 读卡器/ 模式/ (/ Reader/ // Writermode/ )/ 和/ 卡/ 模拟/ 模式/ (/ CardEmulationmode/ )/ ②/ ./ 点对点/ 模式/ 能够/ 在/ 两个/ 具备/ NFC/ 功能/ 的/ 设备/ 之间/ 实现/ 数据/ 点对点/ 传输/ ,/ 如/ 共享/ 音乐/ 、/ 传输/ 图片/ 等/ ./ 在/ 此/ 模式/ 下/ ,/ 发起者/ 发起/ 通信/ ,/ 与/ 目标/ 设备/ 建立/ 链接/ 进行/ 数据传输/ ./ 发起者/ 首先/ 产生/ RF/ 场/ 初始化/ NFCIP/ -/ 1/ 通信/ ,/ 目标/ 设备/ 则/ 响应/ 发起者/ 所/ 发出/ 的/ 命令/ ,/ 并/ 选择/ 由/ 发起者/ 所/ 发出/ 的/ 或是/ 自行/ 产生/ 的/ RF/ 场/ 进行/ 通信/ ./ NFCIP/ -/ 1/ 是/ NFC/ 技术/ 的/ 基础/ ,/ 其/ 定义/ 了/ 电感/ 耦合/ 设备/ 在/ 频率/ 13.56/ MHz/ 下/ 的/ 通信/ 模式/ ,/ 并/ 规定/ 了/ RF/ 接口/ 的/ 调制/ 、/ 编码/ 、/ 传输速度/ 、/ 帧/ 格式/ 以及/ 初始化/ 等/ ./ 在/ 读卡器/ 模式/ 下/ ,/ NFC/ 设备/ 作为/ 读卡器/ ,/ 使用/ 13.56/ MHz/ 载波/ 振幅/ 调制/ 与/ NFC/ 标签/ (/ Tag/ )/ 进行/ 通信/ ,/ 载波/ 的/ 振幅/ 变化/ 导致/ Tag/ 感应/ 线圈/ 的/ 电压/ 随之/ 改变/ ,/ Tag/ 使用/ 简单/ 的/ 解码/ 电路/ 对/ 信号/ 进行/ 解码/ ./ Tag/ 与/ 读卡器/ 的/ 通信/ ,/ 采用/ 负载/ 调制/ 的/ 方法/ 来/ 实现/ ,/ 通过/ Tag/ 线圈/ 的/ 负载/ 是/ 通过/ 改变/ 并联/ 电容/ 的/ 开关/ 实现/ 的/ ./ 卡/ 模拟/ 模式/ ,/ 相当于/ 采用/ RFID/ 技术/ 的/ IC卡/ ,/ NFC/ 设备/ 可以/ 代替/ 信用卡/ 、/ 公交/ 卡/ 、/ 门禁卡/ 等/ IC卡/ ./ 在/ 该/ 模式/ 下/ ,/ 充当/ IC卡/ 的/ NFC/ 设备/ 不用/ 产生/ RF/ 场来/ 供电/ ,/ 其/ 属于/ 被动/ 组件/ ,/ RF/ 场/ 由/ 读卡器/ 产生/ ./ 当/ 宿主/ 设备/ 没有/ 电时/ ,/ 例如/ 手机/ ,/ 充当/ IC卡/ 的/ NFC/ 设备/ 仍/ 可以/ 正常/ 工作/ ,/ 这/ 是/ 该/ 模式/ 最大/ 的/ 优点/ ./ 3/ 面临/ 的/ 安全/ 威胁/ 随着/ 移动/ 互联网/ 和/ 移动/ 支付/ 的/ 发展/ ,/ NFC/ 技术/ 和/ NFC/ 移动/ 终端/ 以及/ 应用/ 被/ 迅速/ 推广/ 和/ 普及/ ./ 2014/ 年/ ,/ 中国人民银行/ 因/ 安全/ 问题/ 叫停/ 二维码/ 支付/ ,/ 鼓励/ 银行/ 拓展/ NFC/ 手机/ 支付/ 应用/ ,/ 中国银联/ 和/ 三大/ 运营商/ 斥/ 巨资/ 开发/ NFC/ 支付/ 软件/ 和/ 硬件/ ③/ ./ 在/ 政府/ 和/ 法规/ 政策/ 的/ 支持/ 下/ ,/ NFC/ 技术/ 的/ 发展/ 如火如荼/ ,/ 基于/ ①/ ②/ ③/ Page5NFC/ 技术/ 的/ 应用/ ,/ 尤其/ 在/ 移动/ 支付/ 方面/ ,/ 在/ 不断/ 推广/ 和/ 流行/ ./ 由于/ NFC/ 系统/ 和/ 应用/ 可能/ 包含/ 敏感/ 的/ 个人隐私/ 、/ 支付/ 信息/ 等/ ,/ 其/ 安全性/ 更加/ 重要/ ./ 如图/ 2/ ,/ NFC/ 安全/ 威胁/ 从/ 整体/ 上/ 可/ 分为/ 终端/ 安全/ 威胁/ 、/ 系统安全/ 威胁/ 、/ 应用/ 安全/ 威胁/ 和/ 通信安全/ 威胁/ ./ 终端/ 安全/ 威胁/ 包括/ 终端/ 丢失/ 、/ 设备/ 损坏/ 、/ SIM卡/ 克隆/ 、/ 电磁辐射/ 窃听/ 、/ 芯片/ 安全/ 等/ ./ 终端/ 丢失/ 将/ 可能/ 直接/ 造成/ 用户/ 信息/ 被/ 窃取/ ,/ 是/ 终端/ 安全/ 面临/ 的/ 最大/ 的/ 安全/ 风险/ ./ 此外/ ,/ 设备/ 损坏/ 将/ 导致/ 信息/ 不可/ 用/ ,/ SIM卡/ 克隆/ 能够/ 通过/ 复制/ 手机/ SIM卡/ 获取/ 用户/ 信息/ ,/ 电磁辐射/ 窃听/ 可/ 获取/ 手机/ 通信/ 的/ 信息/ ,/ 智能/ 芯片/ 可/ 被/ 植入/ 恶意程序/ 来/ 获取/ 用户/ 信息/ 等/ ./ 系统安全/ 威胁/ 包括/ 系统漏洞/ 、/ 图/ 2NFC/ 安全/ 威胁/ 以上/ 从/ 4/ 个/ 方面/ 概述/ 了/ NFC/ 面临/ 的/ 安全/ 威胁/ ,/ 下面/ 将/ 针对/ 重要/ 的/ 安全/ 威胁/ 或/ 安全/ 部件/ 详细/ 阐述/ 安全/ 威胁/ 和/ 相关/ 解决/ 方法/ ,/ 包括/ 通信安全/ 、/ 安全漏洞/ 、/ 安全/ 元件/ 、/ 恶意软件/ 、/ 网络/ 钓鱼/ 等/ ./ 下面/ 将/ 具体/ 介绍/ 这些/ 安全/ 威胁/ ./ 3.1/ 通信安全/ 通信安全/ 是/ NFC/ 技术/ 面临/ 的/ 比较/ 传统/ 的/ 安全/ 威胁/ ,/ 主要/ 分为/ 窃听/ 、/ 数据/ 破坏/ 、/ 数据/ 复制/ 、/ 中间人/ 攻击/ 等/ [/ 7/ ,/ 17/ -/ 23/ ]/ ./ 窃听/ 是/ 指/ 攻击者/ 在/ NFC/ 通信/ 过程/ 中/ 使用/ 特殊/ 设备/ 捕捉/ 通信/ 数据/ 的/ 过程/ ./ 在/ NFC/ 非/ 支付/ 的/ 通信/ 过程/ 中/ ,/ 链路层/ 通讯/ 一般/ 不/ 加密/ ,/ 攻击者/ 可以/ 轻易/ 获取/ NFC/ 标签/ 中/ 的/ 内容/ ./ 尽管/ NFC/ 技术/ 的/ 通信/ 距离/ 不/ 超过/ 20cm/ ,/ 但/ 这种/ 特性/ 并/ 不能/ 阻止/ 其/ 被/ 窃听/ ,/ 通过/ 利用/ 定制/ 的/ 特种/ 天线/ [/ 24/ -/ 25/ ]/ 或者/ 增强/ 的/ 信号/ 接收器/ 等/ 就/ 可以/ 扩大/ 近/ 场/ 通信/ 的/ 距离/ ,/ 进而/ 截获/ 通信/ 数据/ ,/ 且/ 窃听/ 者/ 不必/ 完全/ 截获/ 就/ 能够/ 还原/ 通信/ 内容/ ./ 如果/ NFC/ 标签/ 存在/ 于/ 身份证/ 、/ 护照/ 等/ 包含/ 个人/ 敏感/ 信息/ 的/ IC卡/ 中/ ,/ 遭遇/ 窃听/ 将/ 导致/ 个人隐私/ 的/ 泄露/ ./ 数据/ 破坏/ 是/ 指/ 攻击者/ 通过/ 发送/ 预先/ 构造/ 的/ 数据/ 来/ 干扰/ 或者/ 阻塞/ 正常/ 通信/ 信道/ 进而/ 实现/ 破坏/ 正常/ 通信/ 数据/ 的/ 目的/ ./ 该/ 过程/ 不/ 需要/ 破解/ 通信/ 数据/ ,/ 仅/ 需要/ 使用/ 大功率/ 的/ 设备/ 发送/ 干扰/ 数据/ 就/ 可/ 导致/ 目标/ 恶意软件/ 、/ 系统/ API/ 滥用/ 、/ 权限/ 滥用/ 、/ 系统/ 后门/ 等/ ./ 智能/ 终端/ 操作系统/ 存在/ 大量/ 安全漏洞/ 或/ 后门/ ,/ 系统/ API/ 和/ 权限/ 存在/ 被/ 滥用/ 的/ 风险/ ,/ 且/ 恶意软件/ 也/ 能/ 危及/ 系统/ 的/ 安全/ ,/ 这些/ 因素/ 将/ 危及/ NFC/ 依赖/ 的/ 智能/ 操作系统/ 安全/ ./ 应用/ 安全/ 威胁/ 包括/ 应用/ 漏洞/ 、/ 逆向/ 工程/ 、/ 重/ 打包/ 、/ 恶意软件/ 等/ ./ 应用程序/ 开发者/ 良莠不齐/ ,/ 应用/ 存在/ 大量/ 安全漏洞/ ;/ 由于/ 对/ 安全/ 重视/ 不足/ ,/ 通过/ 逆向/ 工程技术/ 或重/ 打包/ ,/ 能够/ 获取/ 应用程序/ 的/ 源代码/ 、/ 用户/ 信息/ ,/ 并/ 植入/ 恶意程序/ ,/ 严重危害/ 了/ 应用程序/ 的/ 安全/ ./ 通信安全/ 包括/ 窃听/ 、/ 数据/ 破坏/ 、/ 中间人/ 攻击/ 、/ 拒绝服务/ 攻击/ 等/ ,/ 通过/ 监听/ 数据/ 、/ 修改/ 数据/ 、/ 重/ 放/ 数据/ 等/ 导致/ 通信/ 中断/ 、/ 信息/ 泄露/ 、/ 金钱/ 损失/ 等/ 严重/ 的/ 后果/ ./ NFC/ 设备/ 拒绝服务/ ./ 例如/ ,/ 在/ NFC/ 支付/ 系统/ ,/ 票务/ 系统/ 等/ 应用/ 中/ ,/ 将/ 导致/ NFC/ 终端/ 无法/ 提供/ 服务/ 或者/ 产生/ 错误/ 的/ 交易/ ./ 数据/ 篡改/ 主要/ 是/ 指/ 利用/ 特殊/ 设备/ 更改/ 或者/ 使用/ 预先/ 构造/ 的/ 恶意/ NFC/ 标签/ 替换/ 有效/ 的/ 标签/ ./ 由于/ 很多/ 标签/ 应用/ 设置/ 了/ 逻辑/ 保护/ ,/ 不/ 允许/ 修改/ 内容/ ,/ 例如/ ,/ 商品/ 标签/ 是/ 用来/ 描述/ 商品价格/ 、/ 用途/ 、/ 支付/ 数据/ 等/ 内容/ 的/ ,/ 商场/ 或者/ 超市/ 一般/ 均会/ 设置/ 写/ 保护/ ./ 但是/ ,/ 当前/ 便宜/ 的/ 读写/ 设备/ 和/ 特殊/ 的/ IC卡/ 将/ 使得/ 更改/ 、/ 复制/ 或者/ 替换/ 标签/ 内容/ 成为/ 现实/ ,/ 攻击者/ 可以/ 把/ 篡改/ 的/ 标签/ 贴/ 到/ 商品/ 上/ ,/ 顾客/ 将/ 按照/ 修改/ 后/ 的/ 标签/ 进行/ 支付/ ,/ 最终/ 将/ 导致用户/ 和/ 商家/ 的/ 利益/ 受损/ ./ 在/ NFC/ 的/ 通信/ 过程/ 中/ ,/ 中间人/ 攻击/ 是/ 指/ NFC/ 通信/ 双方/ 的/ 通信/ 数据/ 被/ 攻击者/ 截获/ ,/ 攻击者/ 利用/ 截获/ 的/ 信息/ 在/ 特定/ 的/ 位置/ 加以/ 篡改/ 以/ 达到/ 其/ 攻击/ 的/ 目的/ ./ 中间人/ 攻击/ 包含/ 了/ 数据/ 窃听/ 、/ 篡改/ 以及/ 数据/ 的/ 转发/ ,/ 虽然/ 中间人/ 攻击/ 在/ 真实/ 环境/ 中会/ 因/ 通信/ 距离/ 、/ 通信/ 模式/ 等/ 遭到/ 较大/ 限制/ ,/ 但/ 该/ 攻击/ 仍然/ 会/ 对/ NFC/ 通信/ ,/ 尤其/ 是/ NFC/ 支付/ 带来/ 很大/ 的/ 威胁/ ./ 为了/ 确保/ NFC/ 技术/ 的/ 通信安全/ ,/ 最/ 有效/ 的/ 方法/ 就是/ 建立/ 安全/ 信道/ [/ 20/ ]/ ,/ 通过/ 密钥/ 共享/ 和/ 加密传输/ 等/ 手段/ 来/ 保证数据/ 的/ 完整性/ 、/ 保密性/ [/ 26/ -/ 27/ ]/ ./ 安全/ 信道/ 能够/ 防止/ 窃听/ 、/ 数据/ 篡改/ 等/ ,/ 保证/ 通信/ 设备/ 之间/ 数据/ 传/ Page6/ 输/ 的/ 机密性/ 、/ 完整性/ 和/ 真实性/ ./ 对于/ 中间人/ 攻击/ ,/ 建议/ 采用/ 主动/ 通信/ 模式/ ,/ 且/ 主动/ 通信/ 者/ 应该/ 主动/ 监听/ 任何/ 攻击者/ 发出/ 的/ 干扰/ 磁场/ ./ 3.2/ 安全漏洞/ 安全漏洞/ (/ SecurityVulnerability/ ,/ SV/ )/ [/ 28/ -/ 29/ ]/ 是/ 研究/ 安全/ 问题/ 的/ 生命线/ ,/ 是/ 网络/ 和/ 信息安全/ 的/ 核心/ 问题/ ./ 它/ 是/ 指/ 信息系统/ 在/ 设计/ 、/ 实现/ 或者/ 运行/ 管理/ 过程/ 中/ 存在/ 的/ 缺陷/ 或/ 不足/ ,/ 从而/ 使/ 攻击者/ 能够/ 在/ 未/ 授权/ 的/ 情况/ 下/ 利用/ 这些/ 缺陷/ 破坏/ 系统/ 的/ 安全/ ./ 网络攻击/ 和/ 防御/ 的/ 核心/ 就是/ 安全漏洞/ ,/ 攻击者/ 能够/ 通过/ 安全漏洞/ 攻击/ 软硬件/ 目标/ ,/ 访问/ 未/ 授权/ 的/ 资源/ 或者/ 破坏/ 目标/ 系统/ 等/ ./ 提前/ 发现/ 并/ 修补/ NFC/ 安全漏洞/ 是/ NFC/ 系统/ 和/ 应用/ 安全/ 的/ 重要/ 保障/ ./ 关于/ NFC/ 技术/ ,/ 已知/ 且/ 细节/ 公开/ 的/ 漏洞/ 总结/ 如下/ :/ CVE/ -/ 2008/ -/ 5825/ ①/ :/ 手机/ Nokia6131/ (/ 固件/ 为/ 05.12/ )/ 的/ 智能/ 海报/ 应用/ 遇到/ 包含/ 空格/ (/ 0x20/ )/ 、/ 回车/ (/ 0x0D/ )/ 或点/ (/ 0x2E/ )/ 字符/ 的/ URI/ 记录/ 时/ ,/ 无法/ 正常/ 显示/ 该/ 记录/ ./ 攻击者/ 通过/ 构造/ 包含/ 以上/ 畸形/ 数据/ 的/ URI/ 记录/ ,/ 可以/ 诱导/ 用户/ 访问/ 恶意/ 网站/ 、/ 拨打/ 收费/ 的/ 电话/ 或/ 发送/ 购买/ 彩铃/ 的/ 短信/ ./ CVE/ -/ 2008/ -/ 5826/ ②/ :/ 通过/ 把/ NDEF/ 记录/ 的/ 载荷/ 长度/ 、/ NDEFURI/ 电话/ 记录/ 的/ 长度/ 字段/ 或/ NDEFURI/ 短信/ 记录/ 的/ 长度/ 字/ 段/ 设置/ 为/ 一个/ 大值/ 并/ 写入/ 标签/ ,/ 会/ 导致/ 手机/ Nokia6131/ (/ 固件/ 为/ 05.12/ )/ 在/ 触/ 碰/ 该类/ 标签/ 时/ 崩溃/ ./ CVE/ -/ 2008/ -/ 5827/ ③/ :/ 手机/ Nokia6131/ (/ 固件/ 为/ 05.12/ )/ 在/ 下载/ 完/ JAR/ 文件/ 时会/ 自动/ 安装/ 软件/ ,/ 远程/ 攻击者/ 可以/ 利用/ 此/ 特性/ 构造/ URI/ 记录/ 执行/ 任意/ 代码/ ./ BugtraqID68470/ ④/ :/ Android/ 及/ 定制/ ROM/ 系统/ 存在/ 一个/ 拒绝服务/ 漏洞/ ,/ 当/ NFC/ 手机/ 在/ 触/ 碰/ 包含/ 蓝牙/ 配对/ 报文/ 时/ ,/ 导致/ NFC/ 服务/ 崩溃/ ./ 该/ 漏洞/ 是/ 由/ 蓝牙/ 配对/ 报文/ 中/ 畸形/ 的/ 本地/ 名字/ 段长度/ 造成/ ,/ 畸形/ 的/ 长度/ 值为/ 0b00000000/ 或/ 0b1XXXXXXX/ (/ X/ 代表/ 0/ 或/ 1/ )/ 时/ ./ E/ 乐充/ 公交/ 卡/ 支付/ 漏洞/ ⑤/ :/ e/ 乐充/ 公交/ 卡是/ 调用/ 支付宝/ 接口/ 为/ 北京/ 市政/ 交通/ 一卡通/ 进行/ 支付/ 的/ 软件/ ./ 该软件/ 存在/ 一个/ 逻辑/ 漏洞/ ,/ 通过/ 二次/ 利用/ 支付宝/ 的/ 支付/ 结果/ 再次/ 充值/ ,/ 将/ 导致/ e/ 乐充/ 公交/ 卡/ 应用/ 发生/ 异常/ ,/ 退还/ 第一次/ 支付/ 的/ 充值/ 金额/ ,/ 实现/ 零元/ 充值/ ./ 安全漏洞/ 是/ NFC/ 支付/ 和/ 应用/ 的/ 最大/ 威胁/ 之一/ ,/ 有效/ 挖掘/ NFC/ 的/ 漏洞/ ,/ 提出/ 相应/ 的/ 修复/ 措施/ 和/ 建议/ ,/ 是/ 保证/ NFC/ 安全/ 的/ 重要/ 手段/ 之一/ ./ 3.3/ 安全/ 元件/ 安全/ 元件/ (/ SecureElement/ ,/ SE/ )/ ,/ 是/ 存储/ 密钥/ 、/ 敏感数据/ 、/ 加密/ 运算/ 等/ 操作/ 的/ 安全/ 芯片/ ./ 由于/ NFC/ 最/ 重要/ 的/ 应用/ 就是/ 移动/ 支付/ 功能/ ,/ SE/ 则/ 是/ 保证/ 支付/ 安全/ 的/ 核心/ 硬件/ ,/ 故其/ 安全性/ 不容忽视/ ./ 目前/ 包含/ SE/ 的/ NFC/ 终端/ 类型/ 可/ 分成/ 3/ 类/ :/ 单线/ 协议/ (/ SingleWireProtocol/ ,/ NFC/ -/ SWP/ )/ 方案/ 、/ 全/ 终端/ 方案/ 、/ MicroSD/ 方案/ [/ 30/ ]/ ,/ 如图/ 3/ 所示/ ./ 3/ 种/ 方案/ 是/ 根据/ SE/ 的/ 存在/ 位置/ 划分/ 的/ ,/ NFC/ -/ SWP/ 方案/ 中/ SE/ 是/ 放置/ 在/ SIM卡/ 中/ ,/ 全/ 终端/ 方案/ 中是/ 把/ SE/ 安置/ 在/ 终端/ 上/ ,/ MicroSD/ 方案/ 中/ 使用/ 包含/ SE/ 的/ 独立/ 外置/ MicroSD/ 卡/ 插入/ 终端/ 上/ ./ 其中/ NFC/ -/ SWP/ 方案/ 是/ 目前/ 比较/ 流行/ 的/ 方案/ ,/ 并/ 逐步/ 得到/ 推广/ ./ 从图/ 3/ 可以/ 看出/ ,/ 不管/ 是/ 哪种/ 方案/ ,/ SE/ 是/ NFC/ 支付/ 和/ 敏感/ 数据通信/ 的/ 重要/ 安全/ 保障/ ,/ 在/ 设计/ 过程/ 中均/ 需要/ 考虑/ SE/ 面临/ 的/ 安全/ 威胁/ 及/ 相应/ 的/ 安全措施/ ./ 例如/ ,/ SE/ 与/ NFC/ 控制器/ 之间/ 、/ SE/ 与/ 操作系统/ 之间/ 的/ 访问/ API/ 以及/ 访问控制/ 权限/ 等/ ,/ 一旦/ 发生/ 权限/ 越界/ 或者/ 其他/ 威胁/ 安全/ 的/ 操作/ ,/ 将/ 导致/ SE/ 中/ 的/ 敏感/ 信息/ 泄露/ 或/ 金钱/ 损失/ 等/ ./ 3.4/ 恶意软件/ 恶意软件/ (/ Malware/ )/ [/ 31/ -/ 40/ ]/ 是/ 指/ 在/ 未/ 明确/ 提示/ 用户/ 或/ 未经/ 用户/ 许可/ 的/ 情况/ 下/ ,/ 在/ 用户/ 计算机/ 或/ 其他/ 终端/ 上/ 安装/ 运行/ ,/ 侵犯/ 用户/ 合法权益/ 的/ 软件/ ⑥/ ./ 针对/ NFC/ 技术/ 来说/ ,/ 恶意软件/ 的/ 恶意/ 行为/ 一般/ 包括/ 内容/ 劫持/ 、/ 广告/ 弹/ 出/ 、/ 窃取/ 用户/ 支付/ 信息/ 、/ 恶意/ 扣费/ 、/ 恶意/ 卸载/ 、/ 恶意/ 捆绑/ 或者/ 其他/ 侵犯/ 用户/ 知情权/ 和/ 选择权/ 的/ 行为/ ./ 随着/ 智能手机/ 的/ 普及/ 和/ 流行/ ,/ 恶意软件/ 逐渐/ 开始/ 从/ 传统/ 的/ PC/ 平台/ 扩散/ 到/ 移动/ 平台/ ./ 根据/ F/ -/ Secure/ 实验室/ 和/ Sophos/ 实验室/ 的/ 研究/ 报告/ ⑦/ ⑧/ ,/ 与/ PC/ 平台/ 相比/ ,/ 移动/ 平台/ 恶意软件/ 的/ 数量/ 几乎/ 可以/ 忽略/ ./ 但/ 由于/ 移动/ 操作系统/ 存在/ 的/ 漏洞/ 和/ 薄弱/ 的/ 安全/ 设计/ ,/ 尤/ ①/ ②/ ③/ ④/ ⑤/ ⑥/ ⑦/ ⑧/ Page7/ 图/ 3/ 包含/ SE/ 的/ NFC/ 终端/ 类型/ [/ 30/ ]/ 其是/ 开源/ 的/ Android/ 操作系统/ ,/ 且/ 移动/ 终端设备/ 包含/ 更/ 多/ 的/ 隐私/ 信息/ 等/ ,/ 导致/ 移动/ 操作系统/ 平台/ 成为/ 恶意软件/ 新/ 的/ 温床/ ./ 根据/ 网秦/ 公司/ 最新/ 的/ 研究/ 报告/ ①/ ,/ 2014/ 年/ 第一季度/ 手机/ 恶意软件/ 同比/ 增长/ 63.9/ %/ ,/ 被/ 感染/ 的/ 智能手机/ 同比/ 增长/ 71.5/ %/ ./ 根据/ 360/ 互联网安全/ 中心/ 发布/ 的/ 《/ 中国移动/ 支付/ 安全/ 报告/ 》/ ②/ ,/ 具有/ NFC/ 支付/ 功能/ 的/ 支付宝/ 钱包/ 占/ 移动/ 支付/ 下载量/ 近/ 6/ 成/ ,/ 而/ 其他/ NFC/ 相关/ 应用/ ,/ 如/ NFC/ 快/ 拍/ 、/ e/ 乐充/ 、/ 云飞/ 等/ ,/ 下载量/ 达到/ 几十万/ 次/ ./ 一旦/ 攻击者/ 通过/ 捆绑/ 恶意/ 的/ 应用程序/ 诱骗/ 用户/ 下载/ NFC/ 恶意/ 支付/ 应用/ ,/ 用户/ 的/ 手机/ 将/ 成为/ 攻击者/ 的/ “/ 取款机/ ”/ ./ 2014/ 年/ 11/ 月/ ,/ AVL/ 安全/ 研究/ 团队/ ③/ 发现/ 一款/ 利用/ NFC/ 手机/ 攻击/ 交通卡/ 的/ 恶意软件/ ,/ 通过/ 将/ 该款/ 恶意软件/ 安装/ 在/ 一个/ NFC/ 手机/ 上/ ,/ 攻击者/ 手持/ 该/ NFC/ 手机/ 轻轻/ 靠近/ 圣地亚哥/ 交通卡/ (/ bip/ !/ -/ card/ )/ ,/ 就/ 可以/ 任意/ 篡改/ 卡中/ 的/ 余额/ ./ 由于/ NFC/ 支付/ 和/ NFC/ 应用/ 的/ 推广/ 和/ 普及/ ,/ 针对/ NFC/ 技术/ 的/ 恶意软件/ 检测/ 就/ 成为/ 了/ 保证/ NFC/ 支付/ 安全/ 的/ 关键/ 研究/ 方向/ 之一/ ./ 3.5/ 网络/ 钓鱼/ 网络/ 钓鱼/ [/ 41/ -/ 42/ ]/ 是/ 指/ 攻击者/ 通过/ 构造/ 恶意/ 的/ 内容/ ,/ 并/ 通过/ 欺诈/ 、/ 利益/ 诱惑/ 和/ 其他/ 社会/ 工程学/ 手段/ 使得/ 用户/ 去/ 访问/ 或/ 读取/ 恶意/ 内容/ ,/ 并/ 进行/ 敏感/ 信息/ 交换/ 、/ 支付/ 等/ 操作/ ,/ 最终/ 导致用户/ 隐私/ 泄露/ 或/ 利益/ 损失/ ④/ ./ 例如/ ,/ 攻击者/ 伪造/ 一个/ 智能/ 海报/ 标签/ ,/ 其中/ 包含/ 一个/ 恶意/ 的/ 网址/ ,/ 用户/ 由于/ 无法/ 识别/ 智能/ 海报/ 的/ 真伪/ ,/ 一旦/ 触碰该/ 标签/ ,/ 可能/ 打开/ 钓鱼/ 网站/ 或者/ 其他/ 恶意/ 网址/ ,/ 造成/ 财产损失/ ./ 除了/ 以上/ 针对/ NFC/ 技术/ 的/ 安全/ 威胁/ ,/ 还/ 包括/ 硬件安全/ 威胁/ 、/ 接入/ 网络安全/ 威胁/ 、/ 云/ 安全/ 威胁/ 等等/ ,/ 这里/ 不/ 具体/ 介绍/ 了/ ./ 以上/ 从/ 通信安全/ 、/ 安全漏洞/ 、/ 安全/ 元件/ 、/ 恶意软件/ 、/ 网络/ 钓鱼/ 等/ 方面/ 介绍/ 了/ NFC/ 技术/ 面临/ 的/ 安全/ 威胁/ ./ 针对/ 这些/ 安全/ 威胁/ ,/ 研究/ 人员/ 已经/ 做/ 了/ 大量/ 的/ 研究/ ,/ 下节/ 将/ 介绍/ NFC/ 安全/ 研究/ 的/ 现状/ ./ 4NFC/ 安全/ 研究/ 现状/ 由于/ NFC/ 技术/ 的/ 迅速/ 发展/ ,/ 其/ 安全性/ 受到/ 越来越/ 多/ 的/ 威胁/ 和/ 挑战/ ./ 在/ 工业界/ 和/ 学术界/ ,/ 研究/ 人员/ 针对/ NFC/ 安全/ 技术/ 已经/ 做/ 了/ 大量/ 的/ 研究/ ,/ 并/ 取得/ 了/ 一定/ 的/ 进展/ ,/ 下面/ 将/ 按照/ 时间/ 顺序/ 依次/ 介绍/ 相关/ 研究进展/ ./ Haselsteiner/ 等/ 人/ [/ 20/ ]/ 从/ 非/ 接触式/ Token/ 、/ 票据/ // 微/ 支付/ 、/ 配对/ 3/ 个/ 应用/ 场景/ 分析/ 了/ NFC/ 面临/ 的/ 威胁/ ,/ 包括/ 数据/ 劫持/ // 破坏/ // 修改/ 、/ 中间人/ 攻击/ 等/ ,/ 并/ 提出/ 了/ 安全/ 通道/ 、/ 能量/ 检测/ 等/ 防御/ 措施/ ,/ 且/ 针对/ 安全/ 通道/ 措施/ 提出/ 一个/ NFC/ 秘钥/ 认证/ 机制/ ./ Mulliner/ [/ 22/ ]/ 提出/ 一种/ 支持/ NFC/ 的/ 移动/ 手机/ 安全/ 测试方法/ ,/ 通过/ 对/ NFC/ 子系统/ 和/ NFC/ 接口/ 控制/ 的/ 软件/ 组件/ 进行/ 测试/ ,/ 发现/ 了/ 大量/ 未知/ 漏洞/ ,/ 其中/ 一些/ 可以/ 被/ 用来/ 标签/ 内容/ 欺骗/ ,/ 即/ 通过/ 插入/ 一些/ 空白/ ,/ 导致用户/ 打开/ 网络/ 钓鱼/ 等/ 恶意/ 网址/ 或/ APP/ ,/ 进而/ 导致/ 隐私/ 泄露/ 等/ ,/ 还/ 可/ 制作/ NFC/ 蠕虫/ 以及/ 构造/ 畸形/ NDEF/ 数据包/ 进行/ DoS/ 攻击/ ./ 该/ 方法/ 采用/ 手工/ 构造/ 测试用例/ 进行/ 测试/ ,/ 无法/ 实现/ 自动化/ ,/ 耗费/ 大量/ 人力/ ①/ ②/ ③/ ④/ Page8/ 和/ 时间/ ,/ 效率/ 低下/ ./ VanDamme/ 等/ 人/ [/ 23/ ]/ 提出/ 了/ 一个/ 针对/ NFC/ 的/ 安全/ 保护/ 系统/ ,/ 并/ 在/ Nokia6313/ // 2/ 上/ 开发/ 了/ 一个/ NFC/ 应用/ 支付/ 程序/ ,/ 其中/ 使用/ 了/ 基于/ PKI/ (/ PublicKeyInfrastructure/ )/ 的/ 安全/ 协议/ 加密/ ,/ 最后/ 对/ 结果/ 进行/ 评估/ ./ 该/ 方案/ 是从/ 防御/ 的/ 角度/ 对/ NFC/ 支付/ 安全/ 进行/ 研究/ ,/ 通过/ 加密/ 手段/ 会/ 造成/ 一定/ 的/ 时间/ 开销/ ./ Jara/ 等/ 人/ [/ 21/ ]/ 认为/ RFID/ 是/ 一种/ 局限于/ 身份/ 认证/ 的/ 解决方案/ ,/ 扩展/ 到/ NFC/ 上/ 就/ 会/ 产生/ 安全/ 问题/ ,/ 因为/ NFC/ 涉及/ 到/ 身份/ 认证/ 、/ 支付/ 等/ 问题/ ,/ 他们/ 首先/ 使用/ 公钥/ 密码/ 算法/ RSA/ 评估/ 了/ NFC/ 设备/ (/ GoogleNexusOne/ 、/ PDAAcerN30/ 等/ )/ 执行/ 非对称/ 加密/ 方案/ 的/ 能力/ ./ 根据/ 数据/ 载荷/ 和/ 等待时间/ 指标/ ,/ 分别/ 使用/ 不同/ 的/ 密钥/ 长度/ 和/ 信息/ 长度/ 进行/ 评估/ ./ 最后/ ,/ 他们/ 提出/ 了/ 使用/ 非对称/ 加密/ 方案/ 例如/ RSA/ 交换/ 共享/ 密钥/ 、/ 再/ 使用/ 对称/ 密钥/ 算法/ 例如/ AES/ 传输数据/ 的/ 混合/ 安全/ 方案/ ./ 该/ 方案/ 的/ 缺点/ 是/ 密钥/ 长度/ 太/ 长/ 以及/ 生成/ 证书/ 的/ 时间/ 过长/ ./ 贾凡/ 等/ 人/ [/ 7/ ]/ 采用/ 威胁/ 建模/ 的/ 方法/ 分析/ 了/ NFC/ 支付/ 的/ 流程/ 以及/ 各个/ 模块/ 之间/ 的/ 数据流/ 图/ ,/ 确定/ 整个/ 支付/ 系统/ 的/ 入口/ 和/ 要/ 保护/ 的/ 数据/ ,/ 并/ 分析/ 了/ 潜在/ 的/ 安全/ 威胁/ 和/ 攻击/ 场景/ ,/ 最后/ 从/ 安全/ 技术/ 及/ 使用/ 过程/ 两个/ 方面/ 提出/ 相应/ 的/ 威胁/ 对付/ 策略/ ./ 该/ 方案/ 从/ 理论/ 的/ 角度/ 分析/ NFC/ 支付/ 安全/ 和/ 相关/ 措施/ ,/ 需要/ 一定/ 的/ 评估/ 和/ 验证/ ./ Miller/ [/ 17/ ]/ 使用/ 基于/ 生成/ 和/ 变异/ 策略/ 结合/ 的/ Fuzzing/ 技术/ 对/ 协议/ 层/ 和/ 应用层/ 测试/ ,/ 利用/ Sulley/ 完成/ 变异/ 测试/ ,/ 同时/ 使用/ logcat/ 进行/ 监控/ 异常/ ,/ 发现/ 了/ 大量/ 的/ 漏洞/ ./ 该/ 方法/ 虽然/ 采用/ 基于/ 生成/ 和/ 变异/ 结合/ 的/ 方法/ 构造/ 测试用例/ ,/ 但/ 针对/ 具体/ 报文/ 时/ 却/ 采用/ 单一/ 的/ 策略/ 构造/ 测试用例/ ,/ 此外/ ,/ 针对/ 目标/ 异常/ 的/ 监控/ 手段/ 也/ 比较/ 单一/ ./ Ghag/ 从/ NFC/ 的/ 角度/ 上/ 分析/ 了/ 谷歌/ 电子/ 钱包/ 受到/ 的/ 威胁/ 并/ 评估/ 了/ 谷歌/ 钱包/ 的/ 安全措施/ [/ 6/ ]/ ,/ 他/ 的/ 工作/ 是/ 基于/ 现有/ 的/ 移动/ 支付/ 解决方案/ ,/ 包括/ 嵌入式/ 的/ 解决方案/ 、/ 基于/ SIM卡/ 的/ 解决方案/ 和/ 基于/ 安全/ 存储卡/ 的/ 解决方案/ ./ 该/ 文献/ 也/ 是/ 仅仅/ 从/ 理论/ 的/ 角度/ 进行/ 分析/ 和/ 评估/ ./ Wiedermann/ [/ 43/ ]/ 提出/ 一个/ 基于/ Fuzzing/ 技术/ 的/ 漏洞/ 挖掘/ 架构/ ,/ 并/ 开发/ 一个/ 测试工具/ Fuzzing/ -/ to/ -/ go/ ,/ 针对/ AndroidNFCAPI/ 和/ NFCAPP/ 进行/ 测试/ ,/ 使用/ Sulley/ 生成/ 测试用例/ ,/ 利用/ Intent/ 发送/ 报文/ ,/ 对/ 7/ 个/ 应用/ 进行/ 测试/ ,/ 发现/ 了/ 一些/ DoS/ 漏洞/ ./ 该/ 方法/ 采用/ Sulley/ 的/ 进程/ 监控/ 方式/ ,/ 对/ 智能手机/ 的/ 监控/ 效果/ 不好/ ,/ 且/ 监控/ 手段/ 比较/ 单一/ ,/ 不能/ 提供/ 详细/ 的/ logcat/ 异常/ 日志/ ;/ 同时/ ,/ 该/ 方法/ 对/ Android/ 系统/ 和/ API/ 版本/ 依赖性/ 强/ ,/ 可移植性/ 差/ ./ Gummeson/ 等/ 人/ [/ 44/ ]/ 提出/ 一种/ 基于/ 硬件/ 的/ NFC/ 防护/ 方案/ ,/ 他/ 设计/ 并/ 开发/ 了/ 小型/ 无源/ 的/ “/ 补丁/ ”/ EnGarde/ ,/ 可/ 嵌入/ 手机/ 后壳/ ,/ 用于/ 拦截/ NFC/ 恶意/ 交互/ ,/ 包括/ 拦截/ 恶意/ 操作/ 、/ 智能/ 拦截/ 黑名单/ 中/ 的/ 行为/ 事件/ 等/ ./ 该/ 方法/ 是从/ 防护/ 的/ 角度/ 对/ NFC/ 安全/ 进行/ 研究/ ,/ 同时/ 该/ 方案/ 需要/ 增加/ 一定/ 的/ 硬件/ 成本/ ./ Roland/ 针对/ Android/ 平台/ 的/ 两种/ 场景/ 设计/ 了/ 安全/ 元件/ SecureElement/ 模拟器/ [/ 45/ ]/ ,/ 包括/ Android/ 模拟器/ 和/ Android/ 手机/ ./ 该/ 模拟器/ 可以/ 用来/ 测试/ 和/ 调试/ JavaCard/ 语言/ 编写/ 的/ applet/ 程序/ ,/ 应用程序/ 开发者/ 可以/ 使用/ SE/ 模拟器/ 取代/ 真实/ 的/ SE/ 模块/ ,/ 极大/ 简化/ 和/ 降低/ 了/ SE/ 应用/ 程序开发/ 的/ 复杂度/ 和/ 开销/ ./ 王志强/ 等/ 人/ [/ 46/ ]/ 针对/ Android/ 系统/ 和/ WindowsPhone/ 系统/ 等/ 移动/ 终端/ 平台/ 、/ NFC/ 第三方/ 应用程序/ 进行/ 了/ 系统/ 和/ 全面/ 的/ 测试/ ,/ 采用/ ACSACR122U/ 模拟/ 标签/ ,/ 通过/ 进程/ 操作/ 模拟/ “/ 触碰/ ”/ 操作/ ,/ 实现/ 了/ 自动化/ 的/ 漏洞/ 挖掘/ ,/ 并/ 发现/ 了/ 蓝牙/ 自动/ 打开/ 、/ Wifi/ 自动/ 打开/ 、/ 第三方/ 应用程序/ 解析/ 等/ 大量/ 未知/ 的/ 漏洞/ ./ 文献/ [/ 6/ -/ 7/ ,/ 20/ -/ 21/ ]/ 从/ 安全/ 信道/ 、/ 身份/ 认证/ 、/ 安全/ 支付/ 等/ 方向/ 研究/ NFC/ 的/ 数据传输/ 安全/ ,/ 是从/ 积极/ 防御/ 的/ 角度/ 进行/ 研究/ ,/ 提出/ 的/ 方案/ 停留/ 在/ 理论/ 层面/ ,/ 有待/ 实践/ 的/ 检验/ ./ 文献/ [/ 22/ ]/ 从/ 手工/ 的/ 角度/ 进行/ 测试/ ,/ 效率/ 比较/ 低下/ ./ 文献/ [/ 23/ ]/ 实现/ 了/ 一个/ 支付/ 方案/ ,/ 对/ 未来/ NFC/ 支付/ 的/ 发展/ 具有/ 一定/ 的/ 借鉴/ 意义/ ,/ 需要/ 考虑/ 加密算法/ 的/ 安全性/ 和/ 时间/ 开销/ ./ 文献/ [/ 17/ ,/ 43/ ,/ 46/ ]/ 均/ 是从/ 漏洞/ 挖掘/ 的/ 角度/ 去/ 分析/ NFC/ 的/ 安全/ ,/ 均/ 实现/ 了/ 自动化/ 的/ 测试/ ,/ 但/ 文献/ [/ 17/ ,/ 43/ ]/ 中/ 的/ 协议/ 测试用例/ 构造/ 策略/ 比较/ 粗糙/ ,/ 且/ 仅/ 针对/ Android/ 平台/ 有效/ ./ 从/ 整体/ 上/ 看/ ,/ NFC/ 的/ 研究/ 工作/ 可/ 分为/ 攻击/ 和/ 防御/ 两个/ 部分/ ./ 从/ 攻击/ 的/ 角度/ ,/ NFC/ 的/ 研究/ 工作/ 侧重于/ 挖掘/ 和/ 检测/ NFC/ 技术/ 相关/ 的/ 应用程序/ 、/ 支付/ 系统/ 等/ 中/ 的/ 安全漏洞/ 或者/ 安全隐患/ ,/ 并/ 针对/ 这些/ 安全漏洞/ 或/ 安全隐患/ 提出/ 相应/ 的/ 攻击/ 方案/ ,/ 最后/ 提出/ 漏洞/ 修复/ 和/ 安全/ 防御/ 措施/ ./ 此类/ 研究/ 工作/ 以/ 文献/ [/ 17/ ,/ 22/ ,/ 43/ ,/ 46/ ]/ 为/ 代表/ ,/ 这些/ 文献/ 使用/ Fuzzing/ 测试/ 等/ 技术/ 挖掘/ NFC/ 相关/ 应用程序/ 的/ 安全漏洞/ ,/ 按照/ 漏洞/ 挖掘/ 、/ 漏洞/ 利用/ 、/ 漏洞/ 修复/ 的/ 过程/ 研究/ NFC/ 技术/ 相关/ 的/ 应用/ 安全/ 状况/ ./ 该类/ 研究/ 工作/ 研究/ 的/ 对象/ 是/ 已有/ 的/ NFC/ 应用程序/ 、/ 系统/ 等/ ,/ 具有/ 一定/ 的/ 滞后性/ ./ 因此/ ,/ 该类/ 研究/ 工作/ 的/ 特点/ 是/ “/ 先/ 攻击/ 后/ 防御/ ”/ ,/ 即/ 在/ 发/ Page9/ 现/ NFC/ 安全漏洞/ 和/ 利用/ 漏洞/ 造成/ 的/ 损失/ 或/ 影响/ 后/ ,/ 根据/ 攻击/ 的/ 机理/ 针对/ 特定/ 的/ 漏洞/ 、/ 设计/ 缺陷/ 等/ 提出/ 相应/ 的/ 修复/ 措施/ 和/ 防御/ 方案/ ./ 从/ 防御/ 的/ 角度/ ,/ NFC/ 研究/ 工作/ 侧重于/ 使用/ 加解密/ 算法/ 、/ 密钥/ 共享/ 、/ 签名/ 算法/ 、/ 恶意/ 内容/ 检测/ 算法/ 等/ 研究/ 具体/ 的/ 软件/ 和/ 硬件/ 防御/ 系统/ 设计/ 、/ 防御/ 措施/ 等/ ,/ 该类/ 研究/ 工作/ 以/ 文献/ [/ 20/ -/ 21/ ,/ 23/ -/ 44/ ]/ 为/ 代表/ ./ 加解密/ 和/ 密钥/ 共享/ 算法/ 用于/ 保证/ NFC/ 通信/ 过程/ 中/ 的/ 数据安全/ ,/ 防止/ 数据/ 和/ 信息/ 泄露/ ;/ 签名/ 算法/ 用于/ 防止/ 数据/ 被/ 篡改/ 、/ 重放/ 等/ ,/ 确保/ 数据/ 的/ 完整性/ ;/ 恶意/ 内容/ 检测/ 算法/ 用于/ 防止/ 通过/ NFC/ 方式/ 传入/ 恶意/ 内容/ 和/ 数据/ ,/ 确保/ NFC/ 应用程序/ 等/ 的/ 可用性/ 和/ 安全性/ ./ 防御/ 角度/ 的/ 研究/ 工作/ ,/ 是从/ 秘密性/ 、/ 完整性/ 、/ 可用性/ 3/ 个/ 角度/ 为/ NFC/ 通信/ 过程/ 提供/ 安全/ 保证/ ./ 该类/ 研究/ 工作/ 的/ 特点/ 就是/ “/ 超前性/ ”/ ,/ 即/ 在/ NFC/ 系统/ 、/ 应用程序/ 等/ 的/ 设计/ 和/ 开发阶段/ ,/ 就/ 积极/ 图/ 4NFC/ 安全/ 研究/ 工作/ 硬件安全/ 通过/ 可信/ 执行/ 环境/ (/ TrustedExecu/ -/ tionEnvironment/ ,/ TEE/ )/ 和/ 移动/ 可信/ 模块/ (/ MobileTrustedModule/ ,/ MTM/ )/ 来/ 实现/ ./ TEE/ 是/ GP/ (/ GlobalPlatform/ )/ 组织/ 设计/ 的/ 一种/ 安全/ 区域/ ①/ ,/ 位于/ 智能/ 电话/ 的/ 主/ 处理器/ 中/ ,/ 确保/ 敏感数据/ 存储/ 、/ 处理/ 及/ 保护/ 等/ 操作/ 处于/ 一个/ 可信/ 环境/ 中/ ./ 它/ 为/ 授权/ 的/ 安全软件/ (/ TrustedApplications/ )/ 提供/ 安全/ 的/ 运行/ 环境/ ,/ 并/ 对/ 安全软件/ 的/ 数据/ 与/ 资源/ 实施/ 机密性/ 、/ 完整性/ 及/ 访问控制/ 等/ 安全/ 保护/ ./ MTM/ ②/ 是/ TCG/ (/ TrustedComputingGroup/ )/ 组织/ 设计/ 的/ 用于/ 移动/ 设备/ 的/ 安全/ 组件/ ,/ 支持/ 安全/ 启动/ 、/ 安全/ 的/ 根/ 密钥/ 及/ 免疫/ 数据保护/ 等/ ./ TEE/ 和/ MTM/ 是/ GP/ 和/ TCG/ 组织/ 从/ 硬件/ 级别/ 针对/ 移动/ 平台/ 设备/ 提出/ 的/ 安全/ 解决方案/ ,/ 目前/ 很多/ 硬件/ 厂商/ 均/ 提出/ 了/ 自己/ 的/ 可信计算/ 体系结构/ ,/ 但/ 这些/ 体系/ 结地/ 加入/ 安全/ 防御/ 措施/ ,/ 这部分/ 工作/ 是/ 未来/ 软件开发/ 和/ 安全/ 研究/ 工作/ 的/ 发展/ 方向/ 和/ 趋势/ ./ 以上/ 是/ NFC/ 技术/ 安全/ 研究/ 主要/ 进展/ 的/ 介绍/ 和/ 整体/ 分析/ ./ 随着/ 移动/ 支付/ 和/ NFC/ 手机/ 的/ 普及/ 和/ 推广/ ,/ 针对/ NFC/ 技术/ 的/ 安全/ 威胁/ 和/ 挑战/ 还/ 将/ 不断/ 出现/ ,/ 需要/ 安全/ 人员/ 继续/ 从/ 攻击/ 和/ 防御/ 的/ 角度/ 研究/ NFC/ 相关/ 的/ 安全/ 技术/ ,/ 为/ NFC/ 应用/ 和/ 支付/ 等/ 提供/ 安全/ 保障/ ./ 5/ 未来/ 的/ 研究/ 方向/ 通过/ 调研/ NFC/ 安全/ 的/ 研究/ 现状/ 和/ 分析/ NFC/ 技术/ 面临/ 的/ 安全/ 威胁/ ,/ 将/ NFC/ 安全/ 研究/ 工作/ 分为/ 5/ 个/ 部分/ :/ 硬件安全/ 、/ 移动/ 操作系统/ 安全/ 、/ 应用程序/ 安全/ 、/ 数据安全/ 、/ 支付/ 安全/ ,/ 如图/ 4/ 所示/ ./ 构/ 大都/ 依赖于/ 被动/ 的/ 硬件/ 设备/ 或者/ 没有/ 可信/ 的/ 操作系统/ 支持/ ,/ 导致/ 信任/ 链/ 的/ 源头/ 存在/ 安全/ 风险/ ,/ 因此/ 并/ 不能/ 保证系统/ 运行/ 时/ 计算环境/ 的/ 可信/ ./ 如何/ 设计/ 完整/ 的/ 可信计算/ 平台/ 体系结构/ 是/ 目前/ 需要/ 解决/ 的/ 核心/ 问题/ 之一/ [/ 47/ ]/ ./ 在/ 可信计算/ 的/ 关键技术/ 中/ ,/ 信任/ 链/ 扩展/ 也/ 是/ 需要/ 解决/ 的/ 问题/ 之一/ ,/ 它/ 的/ 思想/ 是/ 以/ 底层/ 硬件/ 为/ 基础/ 通过/ 层层/ 度量/ 和/ 认证/ 的/ 方式/ 构建/ 从/ 系统启动/ 到/ 操作系统/ 运行/ 的/ 可信计算/ 环境/ ./ 由于/ 可信计算/ 平台/ 基于/ 不可/ 信/ 的/ 硬件/ 设备/ 上/ ,/ 不仅/ 为/ 可信/ 平台/ 带/ ①/ ②/ Page10/ 来/ 不/ 安全/ 因素/ ,/ 还/ 将/ 借助/ 信任/ 链/ 的/ 传递/ 导致/ 风险/ 扩散/ [/ 47/ ]/ ./ 因此/ ,/ 需要/ 针对/ 信任/ 链/ 的/ 扩展/ 技术/ 进行/ 深入/ 的/ 研究/ ./ 此外/ ,/ 系统/ 运行/ 时刻/ 的/ 完整性/ 度量/ 也/ 是/ 可信计算/ 需要/ 解决/ 的/ 难题/ ./ 以上/ 就是/ 可信计算/ 面临/ 的/ 主要/ 问题/ 和/ 研究/ 内容/ ,/ 实现/ 安全/ 可信/ 的/ 移动/ 平台/ [/ 48/ -/ 49/ ]/ 是/ 在/ 硬件/ 级别/ 保证/ 上层/ 安全/ 的/ 基础/ ./ 移动/ 操作系统/ 安全/ ,/ 以/ Android/ 系统/ 为例/ ,/ 一般/ 包括/ 内核/ 访问控制/ 机制/ 、/ 沙盒/ 机制/ 、/ 权限/ 检查/ 机制/ 、/ 数字签名/ 机制/ 等/ [/ 50/ ]/ ./ 访问控制/ 机制/ 包括/ 身份/ 认证/ 和/ 授权/ [/ 51/ ]/ ,/ 身份/ 认证/ 解决/ 的/ 是/ 口令/ 认证/ ,/ 即/ “/ 你/ 是/ 谁/ ”/ 问题/ ,/ 授权/ 解决/ 的/ 是/ “/ 你/ 能/ 干什么/ ”/ 问题/ ./ 设计/ 安全/ 的/ 访问/ 控制策略/ ,/ 能/ 消除/ 隐蔽/ 信道/ 带来/ 的/ 安全/ 风险/ ,/ 是/ 保证/ 移动/ 操作系统/ 安全/ 的/ 核心技术/ 之一/ ./ 沙盒/ (/ sandbox/ )/ 机制/ [/ 52/ -/ 53/ ]/ 是/ 为了/ 实现/ 不同/ 应用程序/ 和/ 进程/ 之间/ 的/ 相互/ 隔离/ ,/ 保证/ 应用程序/ 无法访问/ 没有/ 授权/ 的/ 系统资源/ 或/ 其他/ 应用程序/ 的/ 资源/ ./ Android/ 系统/ 使用/ Dalvik/ 虚拟机/ 和/ Linux/ 的/ 文件/ 访问控制/ 来/ 实现/ 沙盒/ 机制/ ,/ 任何/ 应用程序/ 如果/ 想要/ 访问/ 系统资源/ 或者/ 其他/ 应用程序/ 的/ 资源/ 必须/ 在/ 自己/ 的/ manifest/ 文件/ 中/ 进行/ 声明/ 权限/ 或者/ 共享/ uid/ ./ 权限/ 检查/ 机制/ 是/ Android/ 系统/ 中/ 一个/ 重要/ 的/ 安全/ 机制/ [/ 54/ ]/ ,/ 任何/ 一个/ 应用程序/ 在/ 使用/ Android/ 受限/ 资源/ (/ 网络/ 、/ 短信/ 、/ 蓝牙/ 、/ 通讯录/ 、/ 照片/ 等/ )/ 之前/ 都/ 必须/ 提前/ 向/ Android/ 系统/ 提出申请/ ,/ 等待/ Android/ 系统/ 批准/ 后/ 应用程序/ 方可/ 访问/ 和/ 使用/ 相应/ 的/ 资源/ ./ 数字签名/ 机制/ [/ 50/ ]/ 是/ 指/ 所有/ 安装/ 到/ Android/ 系统/ 中/ 的/ 应用程序/ 都/ 必须/ 拥有/ 一个/ 数字证书/ ,/ 此/ 数字证书/ 用于/ 标识/ 应用程序/ 的/ 作者/ 和/ 应用程序/ 之间/ 的/ 信任/ 关系/ ./ 只有/ 当/ 应用程序/ 的/ 数字签名/ 与/ 声明/ 此/ 权限/ 的/ 应用程序/ 所用/ 数字签名/ 相同/ 时/ ,/ Android/ 系统/ 才/ 会/ 授权/ ./ 以上/ 是/ Android/ 系统/ 主要/ 的/ 安全/ 机制/ ,/ 不同/ 操作系统/ 的/ 安全/ 机制/ 并/ 不/ 完全相同/ ,/ 需要/ 具体分析/ 和/ 研究/ ./ 如何/ 设计/ 安全/ 的/ 保护/ 机制/ ,/ 是/ 保证/ 移动/ 操作系统/ 安全/ 的/ 重要/ 研究/ 内容/ ./ 应用程序/ 安全/ 研究/ 包括/ 安全漏洞/ 挖掘/ 、/ 安全/ 加固/ 、/ 敏感数据/ 保护/ 等/ ./ 安全漏洞/ 挖掘/ 是从/ 攻击/ 的/ 角度/ 寻找/ 应用程序/ 的/ 漏洞/ ,/ 并/ 提出/ 相应/ 的/ 修复/ 措施/ 和/ 解决方案/ ./ 安全/ 加固/ 是/ 保障/ 应用程序/ 安全/ 的/ 主要/ 技术/ 之一/ ,/ 是/ 指/ 通过/ 对/ 应用程序/ 加密/ 、/ 混淆/ 、/ 加壳/ 等/ ,/ 防止/ 应用程序/ 被/ 执行/ 反编译/ 、/ 二次/ 打包/ 、/ 插入/ 恶意代码/ 等/ 恶意/ 操作/ ,/ 保护/ 应用程序/ 的/ 源代码/ 和/ 知识产权/ ./ 敏感数据/ 保护/ ,/ 指/ 应用程序/ 包含/ 的/ 数据库/ 、/ 口令/ 、/ 账号/ 等/ 敏感/ 信息/ 的/ 存储/ 和/ 保护/ ,/ 防止/ 被/ 越权/ 读取/ 和/ 修改/ 等/ 恶意/ 操作/ ,/ 常用/ 的/ 方法/ 包括/ 加密/ 、/ 身份/ 认证/ 等/ ./ 应用程序/ 安全/ 研究/ 的/ 目标/ 就是/ 保护/ 敏感数据/ 和/ 应用程序/ 源代码/ ,/ 修复/ 存在/ 的/ 安全漏洞/ ,/ 防止/ “/ 跟踪/ // 调试/ // 窃听/ ”/ 等/ 逆向/ 技术/ ./ 关键/ 和/ 具体/ 的/ 研究/ 技术/ 将/ 在/ 后面/ 深入/ 介绍/ ./ 数据安全/ ,/ 涉及/ 数据/ 的/ 加解密/ 算法/ 、/ 签名/ 算法/ 、/ 密钥/ 共享/ 算法/ 、/ 密钥/ 证书/ 存储/ 等/ 研究/ 内容/ ./ 如何/ 设计/ 安全/ 的/ 加解密/ 算法/ ,/ 防止/ 数据/ 被/ 未/ 授权/ 读写/ ;/ 如何/ 设计/ 安全/ 的/ 签名/ 算法/ ,/ 防止/ 数据/ 伪造/ 和/ 抵赖/ ;/ 如何/ 共享/ 密钥/ 和/ 存储/ 密钥/ 证书/ ,/ 保证/ 加解密/ 过程/ 的/ 安全/ ./ 解决/ 这些/ 问题/ ,/ 是/ 保证/ 敏感数据/ 安全/ 存储/ 和/ 传输/ 的/ 关键/ ./ 此外/ ,/ 建立/ 安全/ 的/ 数据传输/ 通道/ 是/ 保证/ 数据安全/ 传输/ 的/ 关键技术/ ,/ 后面/ 将/ 具体/ 介绍/ 安全/ 通道/ ./ 支付/ 安全/ 是/ 属于/ NFC/ 技术/ 应用/ 层面/ 的/ 安全/ ./ 基于/ NFC/ 技术/ 的/ 支付/ 安全/ 研究/ 工作/ 包括/ 安全/ 元件/ SE/ 的/ 安全/ 、/ NFC/ 支付/ 安全/ 验证/ 、/ 平台/ 安全/ 、/ NFC/ 应用程序/ 安全/ 等/ ./ SE/ 是/ 移动/ 支付/ 的/ 核心/ 组件/ ,/ 研究/ SE/ 自身/ 和/ 相关/ 的/ 安全/ 问题/ 是/ 移动/ 支付/ 安全/ 的/ 核心/ 问题/ ./ NFC/ 支付/ 安全/ 验证/ 涉及/ 签名/ 验证/ 、/ 支付/ 口令/ 验证/ 等/ 算法/ ,/ 这是/ 整个/ 近/ 场/ 支付/ 的/ 关键/ 阶段/ ./ 平台/ 安全/ ,/ 是/ 指/ 从/ 移动/ 支付/ 的/ 角度/ 研究/ 支付/ 平台/ 的/ 安全/ 体系/ 设计/ ,/ 该/ 部分/ 可/ 参考/ 图/ 4/ 中/ 硬件安全/ 部分/ ./ NFC/ 应用程序/ 安全/ ,/ 是/ 指/ 从/ NFC/ 技术/ 的/ 角度/ 分析/ 相关/ 应用程序/ 的/ 安全/ 问题/ ,/ 可/ 参考/ 图/ 4/ 中/ 应用程序/ 安全/ 部分/ ./ 以上/ 从/ 硬件安全/ 、/ 移动/ 操作系统/ 安全/ 、/ 应用程序/ 安全/ 、/ 数据安全/ 、/ NFC/ 支付/ 安全/ 等/ 五个/ 部分/ 概述/ 了/ NFC/ 安全/ 研究/ 工作/ 涉及/ 的/ 内容/ ./ 根据/ NFC/ 面临/ 的/ 安全/ 威胁/ 和/ 研究/ 现状/ ,/ 下面/ 将/ 选择/ 核心/ 和/ 关键/ 的/ 技术/ 或/ 问题/ 具体/ 介绍/ NFC/ 技术/ 相关/ 的/ 研究/ 内容/ 和/ 研究/ 方向/ ,/ 包括/ 安全/ 信道/ 、/ 漏洞/ 挖掘/ 、/ 安全/ 元件/ 、/ 恶意软件/ 、/ 恶意/ 内容/ 检测/ 、/ 移动/ 支付/ 等/ 相关/ 研究/ 内容/ ./ 5.1/ 安全/ 信道/ 安全/ 信道/ [/ 7/ ,/ 17/ -/ 23/ ,/ 55/ -/ 56/ ]/ 是/ 抵抗/ 嗅探/ 、/ 篡改/ 、/ 伪造/ 、/ 中间人/ 攻击/ 的/ 重要/ 手段/ ,/ 是从/ 积极/ 防御/ 的/ 角度/ 保证/ NFC/ 的/ 通信安全/ ./ 如何/ 建立/ 一个/ 有效/ 的/ 安全/ 通道/ ,/ 是/ 确保/ NFC/ 技术/ 在/ 数据传输/ 过程/ 中/ 的/ 安全/ 所/ 面临/ 的/ 重要/ 研究/ 问题/ ./ 安全/ 的/ 通信/ 信道/ 具有/ 两个/ 特点/ :/ 保密性/ 和/ 完整性/ ./ 保密性/ 是/ 指/ 确保/ 数据/ 内容/ 的/ 安全/ ,/ 不会/ 被/ 窃听/ 者/ 查看/ 到/ ,/ 该/ 特性/ 一般/ 采用/ 加密/ 和/ 解密/ 来/ 实现/ ./ 加解密/ 算法/ 分为/ 对称/ 和/ 非对称/ 算法/ ,/ 对称/ 算法/ 效率高/ ,/ 缺点/ 是/ 密钥/ 共享/ 需要/ 建立/ 专门/ 的/ 信道/ ;/ 非对称/ 算法/ 能够/ 提供方便/ 和/ 安全/ 的/ 密钥/ 管理/ ,/ 并/ 具有/ 数字签名/ 的/ 功能/ ./ 两类/ 算法/ 的/ 选择/ 需要/ 根据/ 具体/ 算法/ 的/ 强度/ 、/ 效率/ 和/ 系统/ 的/ 性能/ 等/ 方面/ 综合/ 考虑/ ./ 完整性/ 是/ 指/ 安全/ 信道/ 在/ 传输/ 过程/ 中/ 没有/ 受到/ 恶意/ 的/ 或者/ 意外/ 的/ 修改/ ./ Page11/ 完整性/ 一般/ 通过/ 散列/ 函数/ 、/ 消息/ 认证码/ 、/ 加密/ 等/ 方法/ 来/ 鉴别/ ./ 散列/ 函数/ ①/ ,/ 又称/ 哈希/ 函数/ 、/ 杂凑/ 函数/ ,/ 是/ 指/ 把/ 任意/ 长/ 的/ 输入/ 消息/ 串/ 变化/ 成/ 固定/ 长/ 的/ 输出/ 串/ 的/ 一种/ 函数/ ,/ 其中/ 固定/ 长/ 的/ 输出/ 串/ 称为/ 该/ 消息/ 的/ 杂凑/ 值/ ./ 消息/ 认证码/ ②/ ,/ 又/ 称为/ 带/ 密钥/ 的/ 消息/ 认证码/ ,/ 是/ 基于/ 密钥/ 和/ 消息/ 认证码/ 获得/ 的/ 一个/ 值/ ,/ 用于/ 数据/ 认证/ 和/ 完整性/ 校验/ ./ 加密/ ,/ 是/ 指/ 把/ 明文/ 加密/ 后以/ 密文/ 作为/ 数据/ 认证/ 符/ ./ 建立/ 一个/ 安全/ 信道/ ,/ 就要/ 考虑/ 以上/ 两个/ 特性/ ,/ 选择/ 合适/ 的/ 加密/ 和/ 完整性/ 校验/ 算法/ ,/ 确保/ 数据/ 的/ 通信安全/ ./ 5.2/ 漏洞/ 挖掘/ 漏洞/ 挖掘/ 针对/ 的/ 是/ 移动/ 操作系统/ 、/ 系统/ NFC/ 处理/ 模块/ 和/ 第三方/ 应用程序/ ,/ 通过/ 检测/ 其中/ 的/ 安全漏洞/ ,/ 提前/ 修复/ 这些/ 漏洞/ ,/ 是从/ 主动攻击/ 的/ 角度/ 保证/ NFC/ 技术/ 在/ 通信/ 过程/ 中/ 的/ 数据安全/ ./ 下面/ 将/ 具体/ 介绍/ 针对/ NFC/ 技术/ 的/ 主要/ 漏洞/ 挖掘/ 方法/ ./ 5.2/ ./ 1/ 手工/ 测试/ 手工/ 测试/ (/ manualtesting/ )/ ,/ 就是/ 由/ 测试人员/ 手工/ 构造/ 测试用例/ ,/ 并/ 逐个/ 将/ 其/ 输入/ 到/ 被/ 测/ 目标/ ,/ 观察/ 目标/ 的/ 响应/ ,/ 是/ 最/ 原始/ 的/ 漏洞/ 挖掘/ 方法/ [/ 57/ ]/ ./ 手工/ 测试/ 一般/ 适用/ 于/ 时间/ 资源/ 不足/ 、/ 技术水平/ 不足/ 以及/ 无法/ 自动化/ 的/ 场合/ ,/ 可以/ 最大/ 程度/ 地/ 发挥/ 人/ 的/ 主观/ 能动性/ ,/ 设计/ 出/ 最/ 真实/ 的/ 用户/ 情况/ ,/ 容易/ 识别/ 出/ 显而易见/ 的/ 缺陷/ 和/ 难以/ 发现/ 的/ 缺陷/ ,/ 尤其/ 是/ 业务/ 逻辑/ 类/ 的/ 问题/ ./ 手工/ 测试/ 的/ 效果/ 完全/ 依赖于/ 测试人员/ 的/ 业务知识/ 、/ 计算机操作/ 能力/ 、/ 测试/ 经验/ 等/ ,/ 没有/ 规律/ 可循/ ,/ 不可/ 重复使用/ ,/ 无法/ 移植/ ,/ 不适/ 用于/ 大规模/ 测试/ ./ 在/ NFC/ 相关/ 漏洞/ 挖掘/ 的/ 过程/ 中/ ,/ 手工/ 测试/ 具有/ 非常/ 重要/ 的/ 作用/ ./ 由于/ 部分/ NFC/ 协议/ 规范/ 是/ 收费/ 的/ 或者/ 自定义/ 的/ ,/ 例如/ Wifi/ 简单/ 配置/ 协议/ 规范/ 需要/ 收费/ 99/ 美元/ ,/ NFC/ 标签/ 助手/ 使用/ 了/ 自定义/ 的/ 控制/ 屏幕/ 亮度/ 、/ 铃声/ 等/ 报文/ ,/ 导致/ 构造/ 的/ 测试用例/ 效率/ 比较/ 低/ ./ 使用/ 手工/ 分析/ 和/ 测试/ 的/ 方法/ 可以/ 最大/ 限度/ 发挥/ 人/ 的/ 主观/ 能动性/ ,/ 分析/ 并/ 推断出/ 协议/ 报文/ 的/ 格式/ ,/ 提高/ 测试用例/ 的/ 有效性/ ./ 手工/ 测试/ 是/ 漏洞/ 挖掘/ 初期/ 经常/ 采用/ 的/ 一种/ 方法/ ./ 5.2/ ./ 2Fuzzing/ 测试/ Fuzzing/ 测试/ ,/ 也/ 称为/ Fuzz/ 测试/ 或/ 模糊/ 测试/ ,/ 是/ 指/ 通过/ 向/ 被/ 测/ 目标/ 输入/ 大量/ 的/ 畸形/ 数据/ 并/ 监测/ 异常/ 来/ 发现/ 漏洞/ 的/ 一种/ 自动化/ 测试/ 技术/ [/ 43/ ,/ 58/ -/ 60/ ]/ ./ Fuzzing/ 测试/ 过程/ 一般/ 分为/ 6/ 个/ 阶段/ ,/ 分别/ 为/ 识别/ 目标/ 、/ 识别/ 输入/ 、/ 生成/ 测试用例/ 、/ 执行/ 测试用例/ 、/ 监视/ 异常/ 、/ 确定/ 可/ 利用/ 性/ [/ 58/ ]/ ./ (/ 1/ )/ 识别/ 目标/ ./ 确定/ 被/ 测试/ 的/ 目标程序/ ,/ 包括/ 识别/ 目标/ 应用程序/ 中/ 具体/ 的/ 文件/ 、/ 库/ 、/ 使用/ 的/ 协议/ 等/ ./ 主要/ 是/ 指/ 确定/ 被测/ 的/ NFC/ 协议/ 和/ 被/ 测/ 的/ 目标/ ,/ 例如/ 测试/ NDEF/ 协议/ 和/ Android/ 系统/ 的/ NFC/ 类/ ./ (/ 2/ )/ 识别/ 输入/ ./ 确定/ 输入/ 变量/ ,/ 包括/ 数据包/ 、/ 文件/ 、/ 环境变量/ 、/ 端口号/ 等/ 所有/ 发送到/ 目标程序/ 的/ 数据/ ,/ 这/ 对于/ 测试用例/ 的/ 构造/ 是/ 至关重要/ 的/ ./ 如果/ 没有/ 输入/ ,/ Fuzzing/ 测试/ 无法/ 继续/ 进行/ ,/ 几乎/ 所有/ 的/ 安全漏洞/ 均是由/ 特定/ 的/ 输入/ 变量/ 触发/ 的/ ./ 针对/ NFC/ 技术/ ,/ 输入/ 变量/ 一般/ 是/ 指/ 数据包/ 以及/ 测试/ 过程/ 中/ 需要/ 设置/ 的/ 环境参数/ ./ (/ 3/ )/ 生成/ 测试用例/ ./ 测试用例/ ,/ 是/ 指/ 根据/ 确定/ 的/ 输入/ 变量/ 生成/ 的/ 输入/ 数据/ ./ 测试用例/ 生成/ ,/ 是/ Fuzzing/ 测试/ 最/ 关键/ 的/ 一个/ 阶段/ ,/ 直接/ 影响/ 到/ 测试/ 结果/ 的/ 好坏/ ./ 通过/ 分析/ NFC/ 论坛/ 官方/ 文档/ ,/ 获取/ 各类/ NDEF/ 报文/ 的/ 格式/ ,/ 使用/ 半/ 有效/ 的/ 数据/ 生成/ NFC/ 各种/ 协议/ 报文/ 的/ 一个/ 或/ 多个/ 测试/ 字/ 段/ ,/ 其他/ 字/ 段/ 使用/ 正常/ 数据/ 填充/ ,/ 进而/ 生成/ 各类/ 测试用例/ ./ (/ 4/ )/ 执行/ 测试用例/ ./ 执行/ 是/ 指/ 把/ 生成/ 的/ 测试用例/ 输入/ 到/ 目标程序/ ,/ 包括/ 发送/ 数据包/ 给/ 目标/ 应用程序/ 、/ 打开/ 一个/ 文件/ 、/ 发起/ 一个/ 目标/ 进程/ 等/ ,/ 其中/ 数据包/ 、/ 文件/ 为/ 测试用例/ ./ 针对/ NFC/ 的/ 协议/ ,/ 执行/ 测试用例/ 的/ 环境/ 搭配/ 如图/ 5/ 所示/ ./ 图中/ 使用/ 的/ 设备/ ACR122U/ 模拟/ 虚拟/ 的/ 标签/ ,/ 在/ Ubuntu/ 系统/ 下向/ 虚拟/ 标签/ 中/ 写入/ 测试用例/ ,/ 然后/ 把/ NFC/ 手机/ 放到/ ACR122U/ 上/ ,/ 利用/ 进程/ 操控/ 模拟/ “/ 触碰/ ”/ 标签/ 的/ 过程/ ,/ 实现/ 自动化/ 的/ 执行/ 测试用例/ ./ 其中/ ACR122U/ 也/ 可/ 使用/ 其他/ 设备/ 代替/ ./ (/ 5/ )/ 监视/ 异常/ ./ 该/ 步骤/ 是/ Fuzzing/ 测试/ 必不可少/ 的/ 阶段/ ,/ 也/ 是/ 经常/ 被/ 安全/ 研究/ 人员/ 忽视/ 的/ 步骤/ ./ 如果/ 没有/ 异常/ 监控/ ,/ 在/ 自动化/ 测试/ 过程/ 中/ 仅靠/ 肉眼/ 观察/ 是/ 无法/ 确定/ 触发/ 异常/ 的/ 模糊/ 数据/ ,/ 而且/ 还会/ 导致/ 安全漏洞/ 的/ 漏报/ ./ 一般/ 使用/ 监控/ 进程/ 的/ CPU/ 利用率/ 、/ 监控/ 被测/ 目标/ 的/ 日志/ 等/ 方法/ 检测/ 异常/ ./ 例如/ ,/ 在/ ①/ ②/ Page12Android/ 目标/ 平台/ 下/ ,/ logcat/ 就是/ 一个/ 有效/ 的/ 日志/ 监控/ 工具/ ./ (/ 6/ )/ 确定/ 可/ 利用/ 性/ ./ 针对/ 发现/ 的/ 异常/ ,/ 一般/ 需要/ 确定/ 异常/ 是否/ 可以/ 利用/ ,/ 这个/ 过程/ 需要/ 人工/ 的/ 参与/ ,/ 但/ 该/ 过程/ 不是/ 必需/ 的/ ./ 根据/ Fuzzing/ 测试/ 的/ 6/ 个/ 过程/ ,/ 可以/ 发现/ 该/ 技术/ 具有/ 一些/ 天生/ 的/ 缺点/ ,/ 即/ 无法/ 发现/ 某些/ 类型/ 的/ 漏洞/ ./ 这些/ 漏洞/ 包括/ 访问控制/ 缺陷/ 、/ 设计/ 逻辑/ 不良/ 、/ 后门/ 、/ 多/ 阶段/ 安全漏洞/ [/ 58/ ]/ 等/ ./ 因为/ Fuzzing/ 测试/ 并/ 不是/ 完全/ 智能/ 的/ ,/ 无法/ 理解/ 目标/ 应用程序/ 的/ 设计/ 逻辑/ ,/ 因此/ 无法/ 检测/ 逻辑/ 类型/ 的/ 漏洞/ ./ 5.2/ ./ 3/ 程序/ 分析程序/ 分析/ 技术/ 包括/ 静态/ 程序/ 分析/ 技术/ 和/ 动态/ 程序/ 分析/ 技术/ ./ 静态/ 程序/ 分析/ ,/ 也/ 称/ 静态/ 应用程序/ 安全/ 检测/ (/ StaticApplicationSecurityTesting/ ,/ SAST/ )/ ,/ 是/ 指/ 在/ 不/ 运行/ 计算机程序/ 的/ 条件/ 下/ ,/ 通过/ 词法/ 分析/ 、/ 语法分析/ 、/ 语义/ 分析/ 、/ 控制流/ 分析/ 、/ 污点/ 分析/ 等/ 技术/ [/ 61/ -/ 63/ ]/ 对/ 程序代码/ 进行/ 扫描/ ,/ 验证/ 代码/ 是否/ 满足/ 规范性/ 、/ 安全性/ 等/ 指标/ 的/ 一种/ 代码/ 分析/ 技术/ ./ 该/ 技术/ 需要/ 使用/ 人工/ 指定/ 或者/ 自动/ 推断/ 的/ 方法/ 设定/ 安全/ 代码/ 应该/ 遵循/ 的/ 程序/ 规范/ ,/ 然后/ 使用/ 代码/ 分析/ 技术/ 进行/ 语义/ 分析/ ,/ 从而/ 挖掘/ 违背/ 程序/ 规范/ 的/ 行为/ ,/ 即/ 漏洞/ [/ 64/ ]/ ./ 该/ 技术/ 拥有/ 应用程序/ 的/ 全部/ 源代码/ ,/ 因此/ 可以/ 完全/ 遍历/ 程序/ ,/ 代码/ 覆盖率/ 可以/ 达到/ 100/ %/ ./ 由于/ 任何/ 关于/ 程序/ 分析/ 的/ 问题/ 都/ 是/ 不可判定/ 的/ [/ 65/ -/ 66/ ]/ ,/ 不/ 存在/ 任何/ 一种/ 机械化/ 的/ 方法/ 能够/ 证明/ 程序/ 的/ 完全/ 正确性/ ./ 因此/ ,/ 静态/ 程序/ 分析/ 技术/ 不可避免/ 地/ 存在/ 漏报/ 和/ 误报/ ./ 针对/ NFC/ 应用程序/ ,/ 静态/ 程序/ 分析/ 的/ 方法/ 如图/ 6/ 所示/ ./ 首先/ ,/ 通过/ 直接/ 获取/ 、/ 静态/ 反编译/ 、/ 逆向/ 工程/ 等/ 手段/ 获得/ NFC/ 应用程序/ 的/ 源代码/ 或/ 二进制/ 代码/ ./ 其次/ ,/ 通过/ 词法/ 分析/ 和/ 语法分析/ 等/ 手段/ 把/ 源代码/ 转换成/ 中间代码/ ,/ 并/ 利用/ 流/ 分析/ 获取/ 数据流/ 和/ 控制流/ ./ 再次/ ,/ 针对/ 安全漏洞/ 进行/ 分析/ 和/ 建模/ ,/ 并/ 对/ 中间代码/ 、/ 数据流/ 和/ 控制流/ 进行/ 漏洞/ 挖掘/ ./ 最后/ ,/ 分析/ 检测/ 出/ 的/ 漏洞/ ,/ 输出/ 结果/ ./ 动态/ 程序/ 分析/ 一般/ 通过/ 插桩/ 技术/ 分析程序/ 的/ 异常/ 行为/ ./ 插桩/ 技术/ [/ 67/ ]/ 是/ 指/ 在/ 保证/ 被测/ 程序逻辑/ 完整性/ 的/ 基础/ 上/ 在/ 程序/ 的/ 关键/ 位置/ 插入/ 一些/ “/ 桩/ ”/ ,/ 即/ 加入/ 一些/ 测试代码/ ,/ 然后/ 执行/ 插桩/ 后/ 的/ 程序/ ,/ 通过/ “/ 桩/ ”/ 的/ 执行/ 获取/ 程序/ 的/ 控制流/ 和/ 数据流/ 信息/ ,/ 进而/ 分析程序/ 的/ 异常/ 行为/ ./ 由于/ 该/ 技术/ 需要/ 插入/ 冗余/ 代码/ “/ 桩/ ”/ ,/ 因此/ 大大增加/ 了/ 程序运行/ 分析/ 的/ 时间/ 开销/ ,/ 这是/ 动态/ 程序/ 分析/ 面临/ 的/ 一个/ 严峻/ 问题/ ./ 同时/ ,/ “/ 桩/ ”/ 仅/ 在/ 关键/ 位置/ 被/ 插入/ ,/ 无法/ 保证/ 代码/ 的/ 完全/ 覆盖/ ./ 和/ 静态/ 程序/ 分析/ 一样/ ,/ 动态/ 程序/ 分析/ 同样/ 存在/ 漏报/ 和/ 误报/ 的/ 问题/ ./ 针对/ NFC/ 应用程序/ ,/ 动态/ 程序/ 分析/ 常常/ 根据/ Android/ 系统/ 的/ 关键/ API/ 进行/ 监控/ 和/ 插/ 桩/ ,/ 例如/ 蓝牙/ 、/ wifi/ 、/ sms/ 等/ ./ 首先/ ,/ 针对/ 漏洞/ 进行/ 建模/ ,/ 确定/ 漏洞/ 的/ 规则/ 和/ 描述/ ./ 其次/ ,/ 对/ 关键/ API/ 进行/ 插桩/ ,/ 并/ 获取/ NFC/ 应用程序/ 的/ 系统/ 调用/ 序列/ ./ 最后/ ,/ 使用/ 漏洞/ 规则/ 匹配/ 的/ 方法/ ,/ 针对/ 获取/ 的/ 序列/ 进行/ 漏洞/ 检测/ ./ 5.2/ ./ 4/ 二进制/ 代码/ 审核/ 由于/ 大部分/ NFC/ 应用程序/ 并/ 不是/ 开源/ 的/ ,/ 甚至/ 采取/ 加密/ 、/ 方法/ 名/ 混淆/ 、/ 第三方/ so/ 库/ 等/ 多种/ 方式/ 对/ APK/ 文件/ 进行/ 加固/ ,/ 很难/ 获取/ 程序/ 的/ 源代码/ ./ 为了/ 理解/ 程序/ 具体/ 功能/ 的/ 操作/ 细节/ ,/ 研究/ 人员/ 一般/ 采取/ 分析程序/ 编译/ 后/ 的/ 汇编/ 指令/ 的/ 方法/ ,/ 即/ 使用/ 代码/ 逆向/ 工程/ (/ ReverseCodeEngineering/ ,/ RCE/ )/ [/ 68/ -/ 71/ ]/ ./ 在/ 汇编/ 代码/ 层次/ 上/ 进行/ 安全/ 评估/ 而/ 不是/ 在/ 源代码/ 层次/ 上/ 进行/ 安全/ 评估/ ,/ 这种/ 安全/ 评估/ 一般/ 称为/ 二进制/ 审核/ [/ 58/ ]/ (/ binaryauditing/ )/ ./ 针对/ Android/ 系统/ 平台/ ,/ 二进制/ 代码/ 审核/ 获取/ 的/ 是/ 反编译/ 后/ 的/ 二进制/ 代码/ ,/ 即/ smali/ 代码/ ./ 但/ 由于/ 反编译/ 技术/ 的/ 限制/ ,/ 在/ 反编译/ 的/ 过程/ 中/ 会/ 导致/ 大量/ 的/ 变量/ 信息/ 丢失/ ,/ 包括/ 变量/ 类型/ 和/ 函数参数/ 类型/ 等/ ,/ 这样/ 获得/ 的/ 二进制/ 代码/ 较难/ 理解/ ,/ 甚至/ 会/ 存在/ 逻辑/ Page13/ 错误/ ./ 因此/ ,/ 该/ 技术/ 对/ 研究/ 人员/ 的/ 技术/ 要求/ 很/ 高/ ,/ 且/ 一般/ 存在/ 比较/ 高/ 的/ 漏报/ 率/ 和/ 误报率/ ,/ 自动化/ 效率/ 比较/ 低/ ./ 5.3/ 安全/ 元件/ 安全/ 元件/ SE/ 是/ NFC/ 支付/ 的/ 核心部件/ ,/ 其/ 控制权/ 也/ 受到/ 了/ 移动/ 运营商/ 、/ 银联/ 等/ 的/ 竞争/ 和/ 抢占/ ,/ 如何/ 确保/ SE/ 的/ 安全/ 是/ NFC/ 支付/ 研究/ 面临/ 的/ 关键问题/ 之一/ ./ SE/ 是/ 一个/ 安全/ 芯片/ ,/ 敏感/ 数据处理/ 、/ 加密/ 运算/ 等/ 业务/ 均/ 需要/ 单独/ 的/ 安全/ 芯片/ 处理/ ,/ 例如/ 公交/ 刷卡/ 、/ 银行卡/ 支付/ 、/ 余额/ 等/ ./ 除了/ SE/ 本身/ 的/ 数据处理/ 事务/ 外/ ,/ SE/ 还/ 向/ 客户端/ 开放/ 了/ 访问/ SE/ 的/ 接口/ ,/ 以/ 实现/ 余额/ 查询/ 、/ 空中/ 充值/ 等/ 功能/ ./ 针对/ SE/ 的/ 功能/ 和/ 安全/ 特性/ ,/ 具体/ 的/ 研究/ 点/ 包括/ :/ 内部/ 加密算法/ 的/ 设计/ 及其/ 安全性/ 、/ SE/ 访问/ 控制策略/ 的/ 安全/ 设计/ 、/ APP/ 访问/ SE/ 的/ API/ 安全性/ 等/ ./ 加密算法/ 是/ 确保/ 事务处理/ 安全/ 的/ 重要/ 手段/ ,/ 算法/ 设计/ 原则/ 是/ 在/ 没有/ 解密/ 密钥/ 的/ 情况/ 下/ 通信/ 或者/ 其他/ 事务/ 处理过程/ 中/ 的/ 数据/ 在/ 有效期/ 内/ 无法/ 被/ 破解/ ./ SE/ 访问/ 控制策略/ 是/ 控制/ 客户端/ 应用/ 对/ SE/ 的/ 访问/ 操作/ 权限/ ,/ 对/ SE/ 访问/ 的/ 控制/ 和/ 授权/ 是/ 确保/ SE/ 安全/ 的/ 重要/ 手段/ 之一/ ./ APP/ 访问/ SE/ 的/ API/ 安全性/ 是/ 指/ 客户端/ 应用程序/ 访问/ SE/ 的/ API/ 是否/ 安全/ ,/ API/ 安全/ 与否/ 主要/ 在于/ 参数/ 、/ 数据/ 等/ 输入/ 变量/ 是否/ 会/ 导致/ 信息/ 泄露/ 、/ 越权/ 访问/ 、/ 拒绝服务/ 等/ 危害/ SE/ 安全/ 的/ 结果/ ./ 需要/ 注意/ 的/ 是/ ,/ 客户端/ 通过/ 应用/ 处理器/ 访问/ SE/ 的/ 接口/ 芯片/ ,/ 由于/ SE/ 的/ 位置/ 不同/ ,/ 接口/ 芯片/ 也/ 会/ 不同/ ,/ 例如/ NFC/ -/ SWP/ 终端/ 类型/ ,/ SE/ 集成/ 在/ SIM卡/ 中/ ./ 5.4/ 恶意软件/ 检测/ 随着/ 智能手机/ 的/ 普及/ 和/ 流行/ ,/ 恶意软件/ 开始/ 向/ 手机/ 平台/ 蔓延/ ,/ 包括/ 安卓/ 系统/ (/ Android/ )/ 、/ 苹果/ 手机/ 系统/ (/ IOS/ )/ 、/ 微软/ 手机/ 系统/ (/ WindowsPhone/ )/ 等/ 手机操作系统/ 平台/ ./ 同时/ ,/ 由于/ 移动/ 支付/ 和/ NFC/ 技术/ 的/ 发展/ 和/ 普及/ ,/ 移动/ 智能/ 操作系统/ 和/ NFC/ 技术/ 存在/ 的/ 漏洞/ 或/ 针对/ NFC/ 模块/ 的/ 恶意软件/ 逐渐/ 开始/ 出现/ ./ 例如/ ,/ 节/ 3.4/ 中/ AVL/ 团队/ 发现/ 的/ 一款/ 利用/ NFC/ 手机/ 攻击/ 交通卡/ 的/ 恶意软件/ ./ 为了/ 保证/ NFC/ 数据传输/ 和/ 移动/ 支付/ 的/ 安全/ ,/ 移动/ 恶意软件/ 的/ 检测/ 研究/ 势在必行/ ./ 在/ 工业界/ ,/ 安全/ 厂商/ 大部分/ 采用/ 和/ Windows/ 平台/ 相同/ 的/ 检测/ 方法/ ,/ 主要/ 使用/ 基于/ 特征/ 码/ 的/ 方法/ 检测/ 恶意软件/ ,/ 这种/ 方法/ 检测/ 精度高/ ,/ 误报率/ 比较/ 低/ ,/ 但/ 不能/ 检测/ 的/ 特征/ 库外/ 的/ 恶意软件/ [/ 38/ ]/ ./ 此外/ ,/ 恶意软件/ 的/ 变种/ 行为/ 相似/ ,/ 但/ 特征/ 签名/ 不同/ ,/ 导致/ 此类/ 检测/ 方法/ 不能/ 抵抗/ 混淆/ 、/ 加壳/ 等/ 攻击/ [/ 72/ ]/ ./ 恶意软件/ 及其/ 变种/ 数量/ 非常/ 大/ ,/ 需要/ 创建/ 大量/ 的/ 特征/ 签名/ 添加/ 到/ 特征/ 库/ ,/ 这会/ 增加/ 检测/ 的/ 时间/ 开销/ [/ 40/ ]/ ,/ 降低/ 恶意软件/ 检测/ 系统/ 的/ 性能/ ./ 在/ 学术界/ ,/ 研究/ 人员/ 基于/ 静态/ 特征/ 、/ 动态/ 行为/ 等/ 作为/ 恶意软件/ 检测/ 的/ 依据/ ,/ 包括/ 权限/ 、/ 系统/ 调用/ 、/ 能量/ 、/ 时间/ 开销/ 、/ 组件/ 、/ 消息传递/ 等/ 特征/ ,/ 然后/ 使用/ 相似/ 度/ 算法/ 、/ 数据挖掘/ 或/ 机器/ 学习/ 算法/ 检测/ 恶意软件/ [/ 73/ -/ 79/ ]/ ./ 恶意软件/ 检测/ 评价/ 最/ 重要/ 的/ 指标/ 就是/ 漏报/ 率/ 和/ 误报率/ ,/ 如何/ 降低/ 误报/ 并/ 减少/ 漏报/ 仍/ 将/ 是/ 未来/ 恶意软件/ 检测/ 面临/ 的/ 关键问题/ ./ 5.5/ 恶意/ 内容/ 检测/ 随着/ 移动/ 互联网/ 和/ 移动/ 支付/ 的/ 发展/ ,/ 智能手机/ 、/ 平板/ 电脑/ 、/ 路由器/ 等/ 移动/ 智能/ 终端设备/ 逐渐/ 开始/ 内置/ NFC/ 模块/ ,/ NFC/ 技术/ 在/ 提供/ 了/ 便利/ 的/ 同时/ ,/ 也/ 给/ 智能/ 终端设备/ 带来/ 了/ 安全隐患/ ./ 从/ 安全/ 威胁/ 入口/ 的/ 角度/ 分析/ ,/ NFC/ 技术/ 给/ 移动/ 互联网/ 带来/ 了/ 新/ 的/ 安全/ 威胁/ 入口/ ./ 通过/ NFC/ 模块/ ,/ 手机/ 、/ 平板/ 电脑/ 、/ 智能家居/ 设备/ 等/ 终端/ 可以/ 从/ 外部/ NFC/ 标签/ 和/ 其他/ NFC/ 终端设备/ 接收/ 各种/ 数据/ ,/ 包括/ 短信/ 、/ 电话/ 、/ 智能/ 海报/ 、/ 支付/ 信息/ 、/ 功能/ 设置/ 等/ 数据/ ./ 然而/ ,/ 接收数据/ 的/ 终端设备/ 往往/ 忽略/ 从/ NFC/ 模块/ 获取/ 的/ 数据/ 的/ 安全/ 检测/ ,/ 或者/ 对/ 这些/ 数据/ 的/ 检测/ 和/ 过滤/ 较少/ ./ 例如/ ,/ 在/ 触/ 碰/ 智能/ 海报/ 或者/ 包含/ URL/ 的/ NFC/ 标签/ 时/ ,/ 具有/ NFC/ 功能/ 的/ Android/ 手机/ 会/ 自动/ 打开/ 网址/ ,/ 不/ 进行/ 任何/ 的/ 安全/ 检测/ 或/ 人工/ 交互/ ;/ 在/ 通过/ NFC/ 标签/ 进行/ 拨打/ 电话/ 时/ ,/ NFC/ 手机/ 没有/ 检测/ 电话号码/ 的/ 正常/ 与否/ ,/ 直接/ 进行/ 拨号/ ,/ 这/ 将/ 导致/ “/ @/ %/ &/ \/ …/ ”/ 等/ 畸形/ 的/ 数据/ 串/ 能够/ 突破/ 拨号/ 键盘/ 的/ 限制/ ./ 根据/ NFC/ 入口/ 安全/ 的/ 威胁/ 分析/ ,/ 针对/ 入口/ 内容/ 的/ 检测/ 和/ 过滤/ ,/ 有/ 必要/ 进行/ 深入/ 的/ 研究/ 和/ 开发/ ./ 由于/ 通过/ NFC/ 传输/ 的/ 数据/ 种类/ 众多/ ,/ 需要/ 根据/ 具体/ 的/ 传输/ 内容/ 研究/ 具体/ 的/ 安全/ 检测/ 方法/ ,/ 并/ 把/ 相应/ 的/ 检测/ 方法/ 应用/ 到/ NFC/ 应用程序/ 的/ 开发/ 工作/ 上/ ./ 例如/ ,/ 针对/ 包含/ URL/ 的/ 标签/ 内容/ 或者/ P2P/ 传输/ 的/ 数据/ ,/ 需要/ 在/ 接收端/ 开发/ 相应/ 的/ 恶意/ 网址/ 检测/ 模块/ ,/ 减少/ 钓鱼/ 网站/ 、/ 恶意软件/ 网址/ 、/ 利用/ 特定/ 漏洞/ 构造/ 的/ 恶意/ 网址/ 等/ 带来/ 的/ 安全/ 威胁/ ./ 5.6/ 移动/ 支付/ 移动/ 支付/ 是/ NFC/ 技术/ 得以/ 大力推广/ 的/ 一个/ 重要/ 原因/ ,/ 反之/ ,/ 正是/ 由于/ NFC/ 技术/ 天然/ 的/ 安全/ 特性/ 使/ 其/ 成为/ 移动/ 支付/ 的/ 重要/ 媒介/ ./ 在/ NFC/ 技术/ 的/ 应用/ 方面/ ,/ 移动/ 支付/ 的/ 存在/ 形式/ 分为/ 两类/ :/ 圈存/ 和/ 电子/ 钱包/ ./ Page14/ 圈存/ 就是/ 用户/ 从/ 银行/ 等/ 单位/ 的/ 个人账户/ 中/ 把/ 金钱/ 存入/ IC卡/ 上/ ,/ 它/ 是/ 增加/ IC卡/ 中/ 电子/ 现金余额/ 的/ 过程/ ./ 圈存/ 到/ IC卡/ 上/ 的/ 资金/ 大多/ 是/ 在/ 特定/ 的/ 消费/ 环境/ 下/ 进行/ 刷卡/ 消费/ 的/ ./ 例如/ ,/ 在/ 校园/ 里/ ,/ 一卡通/ 一般/ 与/ 银行/ 的/ 个人账户/ 进行/ 关联/ 和/ 绑定/ ,/ 学生/ 可以/ 通过/ 自助/ 终端设备/ 把/ 银行/ 中/ 的/ 金钱/ 圈存/ 到/ 一卡通/ 中/ ,/ 用于/ 校园/ 消费/ ./ 在/ NFC/ 技术推广/ 的/ 阶段/ ,/ 北京/ 亿阳汇/ 智通/ 科技股份/ 有限公司/ 开发/ 的/ e/ 乐充/ 应用程序/ 或/ 写卡器/ 即可/ 把/ 银行/ 、/ 支付宝/ 等/ 个人账户/ 的/ 金钱/ 充值/ 到/ 北京/ 市政/ 交通/ 一卡通/ 中/ ./ 通过/ NFC/ 手机/ 直接/ 给/ 一卡通/ 充值/ ,/ 不仅/ 使得/ 充值/ 更加/ 灵活/ 和/ 方便/ ,/ 还/ 大大减少/ 了/ 人力/ 和/ 物力/ ./ 从/ 工作/ 模式/ 的/ 角度/ ,/ 圈存/ 属于/ NFC/ 的/ 读卡器/ 模式/ ,/ NFC/ 手机/ 或/ 其他/ 终端/ 充当/ 智能/ 读卡器/ 和/ 写卡器/ ./ 电子/ 钱包/ 是/ 指/ 装入/ 电子/ 现金/ 、/ 电子/ 信用卡/ 、/ 电子/ 借记卡/ 、/ 电子/ 零钱/ 等/ 电子货币/ ,/ 集/ 多种/ 功能/ 于/ 一体/ 的/ 电子货币/ 支付/ 方式/ [/ 80/ -/ 81/ ]/ ./ 由于/ NFC/ 技术/ 天然/ 的/ 安全/ 特性/ ,/ 使得/ 基于/ 该/ 技术/ 的/ 电子/ 钱包/ 受到/ 银行/ 和/ 电信/ 运营商/ 等/ 的/ 青睐/ ,/ 并/ 开始/ 逐渐/ 推广/ ,/ 例如/ 和/ 包/ 、/ 翼/ 支付/ 、/ 沃/ 支付/ 等/ ./ 目前/ NFC/ -/ SWP/ 方案/ 是/ 国内/ 最/ 流行/ 的/ 电子/ 钱包/ 解决方案/ ,/ 即/ 把/ SE/ 和/ 手机号码/ 卡/ 合并/ ,/ 例如/ 中国电信/ 的/ RFID/ -/ UIM/ 卡/ 、/ 中国移动/ 的/ NFC/ -/ SIM卡/ 、/ 中国联通/ 的/ RF/ -/ SIM卡/ 等/ ./ 该类/ 电子/ 钱包/ 采用/ 的/ 安全/ 方法/ 主要/ 包括/ 数据/ 加密/ 、/ 数字签名/ 、/ 安全/ 支付/ 口令/ 等/ 方法/ ,/ 这些/ 方法/ 能够/ 基本/ 保证/ 支付/ 交易/ 的/ 安全/ 进行/ ./ 由于/ 涉及/ 到/ 资金/ 交易/ ,/ 基于/ NFC/ 技术/ 的/ 移动/ 支付/ 受到/ 了/ 研究/ 人员/ 和/ 攻击者/ 的/ 关注/ ./ 2014/ 年/ 5/ 月/ ,/ e/ 乐充/ 应用程序/ 爆出/ 支付/ 漏洞/ ,/ 可/ 免费/ 给/ 公交/ 卡/ 充值/ ./ 该/ 漏洞/ 通过/ hook/ 方式/ 获取/ 支付/ 成功/ 的/ pay/ 返回值/ ,/ 并/ 再次/ 通过/ hook/ 手段/ 把/ 支付/ 撤销/ 时/ 的/ 返回值/ 替换/ 为/ 获取/ 的/ pay/ 返回值/ ,/ 导致/ 支付/ 金额/ 退回/ 到/ 支付宝/ 账户/ ,/ 最终/ 实现/ 免费/ 充值/ 的/ 目的/ ./ 同年/ 10/ 月/ ,/ 北京地铁/ 收费/ 系统/ 被/ 爆/ 存在/ 设计/ 缺陷/ ,/ 攻击者/ 使用/ NFC/ 手机/ 能够/ 随意/ 修改/ 单程/ 地铁票/ 卡/ 的/ 金额/ ./ 该/ 漏洞/ 存在/ 于/ 地铁票/ 卡中/ 不/ 安全/ 的/ 签名/ 算法/ ,/ 可/ 被/ 轻易/ 破解/ ./ 从/ 安全/ 研究/ 的/ 角度/ 分析/ ,/ NFC/ 移动/ 支付/ 应用/ 面临/ 的/ 安全/ 风险/ 主要/ 来自/ 于/ NFC/ 支付/ 类/ 客户端/ 、/ 操作系统/ 、/ NFC/ 手机卡/ 、/ 数据通信/ 、/ 恶意软件/ 、/ 安全/ 单元/ 等/ ./ NFC/ 支付/ 类/ 客户端/ 面临/ 的/ 安全/ 威胁/ 主要/ 指/ 应用程序/ 存在/ 的/ 安全/ 风险/ ,/ 例如/ 密码/ 明文/ 传输/ 和/ 本地/ 保存/ 、/ 应用/ 程序设计/ 缺陷/ 等等/ ./ 操作系统/ 存在/ 的/ 安全/ 风险/ 主要/ 是/ 指/ 系统/ 安全漏洞/ ,/ 该类/ 漏洞/ 可/ 导致系统/ 提权/ 、/ 敏感/ 信息/ 泄露/ 、/ 系统/ 功能/ 打开/ 等/ 后果/ ./ NFC/ 手机卡/ 由/ SE/ 和/ 手机卡/ 组成/ ,/ 该/ 方式/ 也/ 是/ 目前/ 最/ 流行/ 的/ NFC/ 支付/ 方式/ ,/ 安全/ 风险/ 主要/ 来自/ SE/ ,/ 具体/ 请/ 参考/ 5.3/ 节/ ./ 在/ 支付/ 过程/ 中/ ,/ 通信/ 的/ 数据/ 一旦/ 被/ 嗅/ 探/ 、/ 破解/ 、/ 修改/ ,/ 将/ 可能/ 造成/ 支付/ 金额/ 的/ 损失/ ,/ 其/ 危害/ 比非/ 支付/ 类/ 应用/ 的/ 数据/ 泄露/ 更/ 严重/ ./ 为了/ 保证/ 支付/ 过程/ 中/ 的/ 数据通信/ 安全/ ,/ 最好/ 的/ 方法/ 是/ 建立/ 安全/ 通道/ ,/ 具体/ 请/ 参考/ 5.1/ 节/ ./ 恶意软件/ 是/ Android/ 系统/ 等/ 移动/ 操作系统/ 最大/ 的/ 安全/ 威胁/ 之一/ ,/ 也/ 是/ NFC/ 支付/ 面临/ 的/ 安全/ 威胁/ 之一/ ,/ 例如/ 山寨/ 的/ NFC/ 支付/ 软件/ 、/ 包含/ 恶意代码/ 的/ NFC/ 支付/ 软件/ 等/ ,/ 该类/ 恶意软件/ 的/ 分析/ 和/ 检测/ 是/ 保障/ NFC/ 支付/ 安全/ 的/ 重要/ 手段/ 之一/ ,/ 具体/ 介绍/ 参考/ 5.4/ 节/ ./ 6/ 结束语/ 随着/ 移动/ 互联网/ 和/ 移动/ 支付/ 的/ 发展/ ,/ NFC/ 技术/ 由于/ 其/ 天然/ 的/ 安全/ 特性/ 和/ 便利性/ ,/ 成为/ 运营商/ 、/ 银行/ 、/ 软件/ 开发者/ 等/ 热/ 捧/ 的/ 对象/ ./ 同时/ ,/ NFC/ 技术/ 也/ 受到/ 安全/ 研究/ 人员/ 和/ 攻击者/ 的/ 关注/ ./ 虽然/ 国内外/ 安全/ 研究/ 人员/ 已经/ 逐步/ 开始/ 对/ NFC/ 安全/ 问题/ 进行/ 了/ 一定/ 的/ 研究/ ,/ 但/ 目前/ 还/ 没有/ 详细/ 和/ 全面/ 介绍/ NFC/ 安全/ 研究进展/ 的/ 论文/ ./ 本文/ 首先/ 从/ 基本/ 特性/ 、/ 通信/ 过程/ 、/ 协议/ 栈/ 、/ 工作/ 模式/ 等/ 方面/ 介绍/ 了/ NFC/ 技术/ ,/ 并/ 分析/ 了/ 该/ 技术/ 面临/ 的/ 安全/ 威胁/ ,/ 包括/ 通信安全/ 、/ 安全漏洞/ 、/ 安全/ 元件/ 、/ 恶意软件/ 、/ 网络/ 钓鱼/ 等/ 内容/ ./ 然后/ ,/ 通过/ 分析/ 相关/ 参考文献/ ,/ 对/ NFC/ 技术/ 的/ 安全/ 研究/ 现状/ 进行/ 分析/ 和/ 总结/ ./ 最后/ ,/ 从/ 安全/ 信道/ 、/ 漏洞/ 挖掘/ 、/ 安全/ 元件/ 、/ 恶意软件/ 检测/ 、/ 恶意/ 内容/ 检测/ 、/ 移动/ 支付/ 等/ 方面/ 对/ NFC/ 技术/ 的/ 研究/ 内容/ 进行/ 分析/ ,/ 并/ 展望未来/ 的/ 研究/ 方向/ 和/ 方法/ ./ 致谢/ 感谢/ 所有/ 对/ 本文/ 研究/ 给予/ 支持/ 和/ 帮助/ 的/ 人/ !/ 

