Page1/ 基于/ 犽/ 近邻/ 最/ 弱/ 前置条件/ 的/ 程序/ 多路径/ 验证/ 方法/ 1/ )/ (/ 华中农业大学/ 信息/ 学院/ 武汉/ 430070/ )/ 2/ )/ (/ 武汉/ 电力/ 职业/ 技术/ 学院/ 电力/ 工程系/ 武汉/ 430079/ )/ 3/ )/ (/ 软件工程/ 国家/ 重点/ 实验室/ (/ 武汉大学/ )/ 武汉/ 430072/ )/ 4/ )/ (/ 佐治亚/ 理工学院/ 计算机科学/ 系/ 亚特兰大/ 30332/ 美国/ )/ 摘要/ 程序/ 多路径/ 验证/ 方法/ 是/ 对/ 软件/ 性质/ 进行/ 发掘/ 的/ 重要/ 方法/ 之一/ ,/ 现有/ 的/ 验证/ 方法/ 主要/ 通过/ 求解/ 路径/ 条件/ 或者/ 自动/ 构造/ 不同/ 的/ 输入/ 来/ 触发/ 生成/ 不同/ 的/ 路径/ ,/ 从而/ 分析程序/ 中/ 潜在/ 的/ 安全/ 问题/ ,/ 但/ 存在/ 对/ 路径/ 条件/ 不/ 加/ 选择地/ 进行/ 多路径/ 扩展/ 而/ 生成/ 缺乏/ 针对性/ 的/ 路径/ 的/ 问题/ ,/ 另外/ 由于/ 路径/ 条件/ 过长/ 而/ 难以/ 求解/ 也/ 限制/ 了/ 它/ 的/ 使用/ 范围/ ./ 该文/ 提出/ 基于/ k/ 近邻/ 最/ 弱/ 前置条件/ 的/ 程序/ 多路径/ 验证/ 方法/ ,/ 该/ 方法/ 通过/ 后/ 向/ 符号分析/ 对/ 程序/ 调用/ 图/ 的/ 构建/ 过程/ 进行/ 改进/ ,/ 同时/ 对/ 指定/ 的/ 程序/ 检测点/ 生成/ 最/ 弱/ 前置条件/ ,/ 并/ 以/ 该/ 最弱/ 前置条件/ 为/ 引导/ 信息/ 使用/ 符号执行/ 的/ 方法/ 在/ 保证/ 检测点/ 可达/ 的/ 前提/ 下/ 有/ 针对性/ 地/ 生成/ 对/ 程序/ 性质/ 进行/ 验证/ 的/ 精简/ 路径/ 集合/ ./ 实验/ 结果表明/ ,/ 该/ 方法/ 可以/ 提高/ 程序验证/ 的/ 精度/ 和/ 准确性/ ,/ 并/ 减少/ 误报/ ./ 关键词/ 程序验证/ ;/ 静态/ 分析/ ;/ 最/ 弱/ 前置条件/ ;/ 符号执行/ ;/ 控制流/ 图/ 1/ 引言/ 程序/ 分析/ 的/ 目的/ 是/ 为了/ 验证/ 系统/ 代码/ 是否/ 满足/ 给定/ 的/ 安全/ 准则/ ,/ 以/ 达到/ 对/ 程序/ 所/ 具有/ 的/ 性质/ 进行/ 验证/ 的/ 目的/ ./ 传统/ 的/ 人工/ 分析方法/ 由于/ 效率/ 较/ 低且/ 容易/ 出现/ 误报/ 和/ 漏报/ 等/ 现象/ ,/ 故/ 自动化/ 的/ 程序验证/ 方法/ 和/ 错误/ 检查/ 方法/ 成为/ 当前/ 主流/ 的/ 研究/ 方向/ ,/ 如/ 定理/ 证明/ [/ 1/ ]/ 、/ 约束/ 求解/ [/ 2/ ]/ 、/ 模型/ 检验/ [/ 3/ ]/ 等/ ./ 程序验证/ 的/ 重点/ 是/ 对/ 程序/ 属性/ 的/ 分析/ ,/ 例如/ 程序/ 中/ 某条/ 语句/ 是否/ 可/ 达/ ,/ 多线程/ 程序/ 中/ 是否/ 存在/ 竞争/ 或/ 互斥/ 等/ 逻辑/ 属性/ ./ 目前/ 程序/ 属性/ 验证/ 工具/ 的/ 主要/ 目标/ 是/ 判断/ 程序/ 中/ 是否/ 存在/ 违反/ 待/ 验证/ 属性/ 的/ 执行/ 路径/ ,/ 即/ 判断/ 该/ 工具/ 是否/ 会/ 生成/ 对应/ 的/ 反例/ 程序/ ./ 路径/ 可行性/ 判定/ 问题/ 是/ 程序验证/ 中/ 的/ 重要/ 问题/ [/ 4/ ]/ ,/ 它/ 指/ 的/ 是/ 对于/ 一条/ 指定/ 的/ 程序执行/ 路径/ ,/ 通过/ 符号执行/ [/ 5/ ]/ (/ SymbolicExecution/ ,/ SE/ )/ 和/ 约束/ 求解/ 等/ 方法/ 判断/ 该/ 程序/ 的/ 输入/ 变量/ 是否/ 存在/ 一组/ 初始/ 取值/ ,/ 使得/ 程序/ 能够/ 沿着/ 该/ 路径/ 执行/ ./ 由于/ 属性/ 验证/ 工具/ 大多/ 都/ 采用/ 对/ 源代码/ 进行/ 抽象/ 的/ 方法/ 来/ 生成/ 反例/ ,/ 故/ 源代码/ 对应/ 的/ 抽象/ 模型/ 会/ 直接/ 影响/ 到/ 反例/ 的/ 正确性/ ./ 最弱/ 前置条件/ [/ 6/ ]/ (/ WeakestPrecondition/ ,/ WP/ )/ 作为/ 一种/ 后/ 向/ 符号分析/ 方法/ (/ BackwardSymbolicAnalysis/ )/ ,/ 能够/ 可靠/ 地/ 对/ 程序/ 的/ 执行/ 语义/ 进行/ 建模/ ,/ 并/ 减小/ 静态/ 分析/ 过程/ 中/ 对/ 程序/ 状态/ 进行/ 抽象/ 操作/ 所/ 带来/ 的/ 验证/ 精度/ 上/ 的/ 损失/ ./ 但/ 最弱/ 前置条件/ 分析/ 在/ 实际/ 应用/ 过程/ 中/ ,/ 往往/ 由于/ 程序/ 对应/ 的/ 控制流/ 图/ (/ ControlFlowGraph/ ,/ CFG/ )/ 规模/ 较大/ ,/ 其/ 路径/ 条件/ 的/ 解/ 空间/ 与/ 程序/ 分枝/ 数量/ 呈/ 指数/ 关系/ ,/ 即/ 存在/ 路径/ 搜索/ 空间/ 爆炸/ 的/ 问题/ ./ 此外/ 最/ 弱/ 前置条件/ 在/ 计算/ 过程/ 中/ 依赖/ 循环/ 变量/ ,/ 故/ 可能/ 存在/ 死循环/ 等/ 问题/ 影响/ 验证/ 的/ 效果/ ./ 目前/ 程序/ 多/ 路径分析/ 与/ 验证/ 存在/ 的/ 主要/ 问题/ 是/ 分析/ 效率/ 较/ 低/ ,/ 在/ 分析/ 过程/ 中/ 容易/ 产生/ 大量/ 不可/ 达/ 或/ 不能/ 对/ 性质/ 进行/ 验证/ 的/ 无用/ 路径/ ,/ 同时/ 大多数/ 分析方法/ 仅用/ 求解/ 器/ 对/ 路径/ 约束条件/ 进行/ 优化/ 求解/ ,/ 缺乏/ 对/ 程序/ 检测点/ 和/ 路径/ 条件/ 之间/ 关联/ 关系/ 的/ 深入研究/ ,/ 导致/ 由于/ 没有/ 足够/ 的/ 路径/ 引导/ 信息/ 而/ 产生/ 较/ 多/ 缺乏/ 针对性/ 的/ 程序执行/ 路径/ ,/ 从而/ 降低/ 对/ 性质/ 进行/ 验证/ 的/ 精度/ 与/ 效率/ ./ 本文/ 针对/ 以上/ 问题/ ,/ 以/ 程序/ 路径/ 的/ 可/ 满足/ 性为/ 研究/ 对象/ ,/ 提出/ k/ 近邻/ 最/ 弱/ 前置条件/ (/ kWP/ )/ 的/ 多路径/ 程序验证/ 方法/ :/ 在/ 分析/ 过程/ 中/ 不/ 立即/ 对/ 路径/ 条件/ 进行/ 求解/ ,/ 而是/ 加入/ 后/ 向/ 符号分析/ 所/ 生成/ 的/ 路径/ 信息/ ,/ 当/ 遇到/ 程序/ 的/ 检测点/ 的/ 时候/ ,/ 根据/ 路径/ 信息/ 有/ 针对性/ 的/ 生成/ 执行/ 路径/ 并/ 进行/ 筛选/ ,/ 从/ 语义上/ 对/ 路径/ 表达式/ 进行/ 简化/ 与/ 合并/ ,/ 减少/ 待/ 分析/ 的/ 路径/ 数量/ ,/ 并/ 减少/ 求解/ 器/ 的/ 误报/ 与/ 漏报/ ./ 具体/ 的/ 过程/ 是/ 通过/ 对/ 程序/ 的/ 控制流/ 图/ 进行/ 改进/ ,/ 消除/ 循环/ 结构/ ,/ 使得/ 每条/ 执行/ 路径/ 都/ 可以/ 表示/ 成/ 惟一/ 的/ 语句/ 串/ ;/ 通过/ 引入/ 因子/ k/ ,/ 可以/ 得到/ 一个/ 与/ 待/ 分析/ 的/ 路径/ 的/ 编辑/ 距离/ (/ EditDistance/ )/ 不/ 超过/ k/ 的/ 路径/ 集合/ ,/ 对/ 该/ 集合/ 中/ 的/ 每条/ 路径/ 进行/ kWP/ 运算/ 并/ 对/ 运算/ 结果/ 进行/ 析取/ 操作/ ,/ 这样/ 就/ 可以/ 得到/ 对/ 输入/ 变量/ 的/ 一个/ 近似/ 的/ 取值/ ,/ 通过/ 不断/ 优化/ 调整/ k/ 的/ 大小/ ,/ 可以/ 得到/ 更为/ 精确/ 的/ 变量/ 输入/ 值/ ,/ 从而/ 引导/ 程序执行/ 到/ 待/ 验证/ 的/ 检测点/ ,/ 并/ 减小/ 路径/ 空间/ 爆炸/ 在/ 程序验证/ 过程/ 中/ 所/ 带来/ 的/ 影响/ ,/ 故/ kWP/ 是/ 对/ 传统/ 的/ 最弱/ 前置条件/ 的/ 一种/ 近似/ ./ 基于/ kWP/ 的/ 路径/ 可行性/ 问题/ 是/ 需求/ 驱动/ (/ demanddriven/ )/ 的/ ,/ 符号分析/ 的/ 结果/ 可以/ 及时/ 反馈/ 于/ 符号执行/ 过程/ 中/ 的/ 程序/ 分支/ 路径/ 的/ 选择/ ,/ 故/ 与/ 传统/ 的/ 符号执行/ 相比/ ,/ 本文/ 的/ 方法/ 在/ 路径/ 搜索/ 过程/ 中有/ 更/ 强/ 的/ 针对性/ ./ 本文/ 的/ 主要/ 贡献/ 是/ :/ (/ 1/ )/ 在/ 程序/ 调用/ 图/ 的/ 构建/ 过程/ 中/ 加入/ 后/ 向/ 符号分析/ ,/ 使得/ 后/ 向/ 符号分析/ 的/ 结果/ 能够/ 引导/ 程序/ 调用/ 图/ 的/ 构建/ ,/ 从而/ 避免/ 生成/ 与/ 待/ 验证/ 性质/ 无关/ 的/ 程序/ 调用/ 图/ ,/ 提高/ 验证/ 的/ 精度/ 与/ 效率/ ./ (/ 2/ )/ 提出/ 基于/ k/ 近邻/ 最/ 弱/ 前置条件/ 的/ 程序/ 多/ 路径分析/ 方法/ ,/ 通过/ 计算/ 程序/ 中/ 断言/ 的/ 最弱/ 前置条件/ 并/ 调整/ k/ 的/ 取值/ ,/ 从而/ 生成/ 有/ 针对性/ 的/ 可行/ 路径/ 并/ 对待/ 验证/ 的/ 性质/ 进行/ 判定/ ./ 本文/ 第/ 2/ 节/ 介绍/ 与/ 论文/ 相关/ 的/ 概念/ ,/ 给出/ 最/ 弱/ 前置条件/ 和/ 过程/ 间/ 程序/ 调用/ 图/ 的/ 计算方法/ ;/ 第/ 3/ 节/ 给出/ kWP/ 的/ 形式化/ 定义/ 和/ k/ 近邻/ 路径/ 生成/ 算法/ ;/ Page3/ 第/ 4/ 节/ 从/ 输入/ 域/ 的/ 角度/ 对/ 本文/ 方法/ 的/ 有效性/ 进行/ 证明/ ,/ 并/ 给出/ 本文/ 方法/ 的/ 分析/ 过程/ ;/ 第/ 5/ 节/ 介绍/ 实验/ 环境/ 和/ 系统/ 的/ 框架/ ,/ 并/ 对/ 基准/ 测试/ 集/ 的/ 结果/ 进行/ 分析/ ;/ 第/ 6/ 节/ 给出/ 相关/ 研究进展/ 和/ 对比/ ;/ 第/ 7/ 节/ 总结/ 全文/ 并/ 展望/ 下/ 一步/ 研究/ 工作/ ./ 2/ 最弱/ 前置条件/ 的/ 生成/ 方法/ 定义/ 1/ ./ 控制流/ 图/ (/ ControlFlowGraph/ ,/ CFG/ )/ ./ 程序/ 的/ 控制流/ 图是/ 由/ 节点/ 和/ 边/ 组成/ 的/ 有向图/ ,/ 可以/ 形式化/ 地/ 表示/ 为/ 〈/ N/ ,/ E/ 〉/ ./ 其中/ N/ 是/ 节点/ 的/ 集合/ ,/ 每个/ 节点/ 代表/ 程序/ 中/ 指定/ 位置/ 的/ 语句/ ,/ 边/ 的/ 集合/ E/ / N/ ×/ N/ 表示/ 程序/ 在/ 执行/ 过程/ 中/ 节点/ 间/ 可能/ 的/ 流向/ ./ 定义/ 2/ ./ CFG/ 路径/ 的/ 可行性/ ./ 它/ 表示/ 为/ N/ ×/ N/ →/ {/ T/ ,/ F/ }/ 的/ 计算/ 过程/ ,/ 对于/ 一对/ 节点/ (/ ni/ ,/ nj/ )/ ,/ 若/ 存在/ 一个/ 节点/ 序列/ π/ ·/ E/ ,/ 其中/ 0/ / k/ / |/ π/ |/ -/ 1/ ,/ n0/ =/ ni/ ,/ n/ |/ π/ |/ -/ 1/ =/ nj/ ,/ 那么/ 这/ 一对/ 节点/ 之间/ 存在/ 可达/ 的/ 路径/ ;/ 反之/ 若/ 不/ 存在/ 节点/ 序列/ ,/ 则/ 表示/ 不/ 存在/ 可/ 达/ 路径/ ./ 用/ (/ n0/ ,/ n1/ ,/ …/ ,/ nk/ ]/ 表示/ 所有/ 以/ n0/ 的/ 后继/ 节点/ 为/ 起点/ ,/ 以/ nk/ 为/ 终点/ 的/ 路径/ ;/ 用/ [/ n0/ ,/ n1/ ,/ …/ ,/ nk/ )/ 表示/ 所有/ 以/ n0/ 为/ 起点/ ,/ 以/ nk/ 的/ 前驱/ 节点/ 为/ 终点/ 的/ 路径/ ,/ 使用/ |/ π/ |/ 表示/ 当前/ 路径/ 的/ 长度/ ./ 定义/ 3/ ./ 路径/ 条件/ (/ PathCondition/ )/ ./ 它/ 是/ 在/ 控制流/ 迭代/ 过程/ 中/ 产生/ 分支/ 路径/ 的/ 数据流/ 值/ ./ 在/ CFG/ 中/ ,/ 新/ 的/ 路径/ 只会/ 在/ 条件/ 语句/ 与/ 循环/ 语句/ 的/ 判断/ 条件/ 处/ 产生/ ,/ 故/ 在/ CFG/ 中/ 节点/ 的/ 路径/ 条件/ 为/ 此处/ 条件/ 分支/ 或/ 循环/ 分支/ 的/ 约束/ 所/ 组成/ 的/ 一阶/ 逻辑/ 公式/ (/ First/ -/ OrderLogic/ ,/ FOL/ )/ ./ 在/ 本文/ 方法/ 的/ 分析/ 过程/ 中/ ,/ 可以/ 将/ CFG/ 的/ 表示/ 形式/ 扩展/ 为/ 〈/ N/ ,/ E/ ,/ Ninfea/ ,/ φ/ 〉/ ./ 其中/ Ninfea/ 表示/ 程序/ 的/ 可行/ 路径/ 不能到达/ 的/ 节点/ 的/ 集合/ ;/ φ/ 表示/ 待/ 验证/ 路径/ 所/ 表示/ 的/ 状态/ ,/ 即/ 断言/ 的/ 集合/ ./ 程序/ 从/ CFG/ 的/ 起始/ 节点/ 开始/ ,/ 依据/ 路径/ 的/ 可行性/ 定义/ 运行/ 到/ 待/ 验证/ 的/ 位置/ ,/ 若/ 要/ 验证/ 程序/ 在/ 该处/ 的/ 断言/ φ/ 成立/ ,/ 则/ 需要/ 验证/ 程序/ 以/ 不同/ 的/ 执行/ 路径/ 达到/ 该处/ 时/ ,/ 该/ 断言/ φ/ 都/ 要/ 成立/ ./ 定义/ 4/ ./ 静态/ 单/ 赋值/ (/ StaticSingleAssignment/ ,/ SSA/ )/ ./ 静态/ 单/ 赋值/ 是/ 程序/ 的/ 一种/ 中间/ 表示/ (/ IR/ )/ 形式/ ,/ 在/ 程序/ 中若/ 出现/ 了/ 对/ 变量/ a/ 的/ 多次/ 赋值/ ,/ 即该/ 变量/ 存在/ 多处/ 定义/ ,/ 则/ 通过/ 对/ 变量/ a/ 采用/ 下/ 标的/ 方式/ (/ a0/ ,/ a1/ ,/ …/ )/ 来/ 区分/ a/ 在/ 每处/ 的/ 定义/ ,/ 同时/ 在/ 程序/ 的/ 控制流/ 图中/ 加入/ 一个/ φ/ 函数/ 节点/ :/ a/ =/ φ/ (/ a0/ ,/ a1/ ,/ …/ )/ ,/ 使得/ 每个/ 变量/ ai/ 均/ 有/ 惟一/ 的/ 一处/ 定义/ ,/ 同时/ 变量/ ai/ 也/ 只有/ 惟一/ 的/ 一条/ 到达/ 该/ 定义/ 的/ 路径/ ./ 在/ 计算/ 过程/ 内/ 最弱/ 前置条件/ 之前/ ,/ 需要/ 将/ 程序转换/ 为/ 其/ 对应/ 的/ 静态/ 单/ 赋值/ 形式/ ,/ 使得/ 程序/ 的/ 过程/ 内/ 控制流/ 图中/ 每/ 一个/ 基本块/ (/ BasicBlock/ )/ 最/ 多/ 代表/ 一条/ 语句/ ,/ 同时/ 过程/ 内/ 控制流/ 图/ 拥有/ 惟一/ 的/ 入/ 节点/ (/ Entrynode/ )/ 和/ 出/ 节点/ (/ Exitnode/ )/ ./ 静态/ 单/ 赋值/ 操作/ 可以/ 有效/ 地区/ 分/ 程序/ 中/ 的/ 变量/ 与其/ 存储/ 位置/ ,/ 使得/ 程序控制/ 流图/ 中/ 每/ 条边/ 代表/ 一次/ 路径/ 条件/ 的/ 运算/ 过程/ ,/ 若/ 程序/ 中/ 存在/ 异常/ 退出/ 等/ 情况/ ,/ 则/ 有/ 一条/ 指向/ 出/ 节点/ 的/ 边/ ,/ 以/ 提高/ 后/ 向/ 符号分析/ 的/ 效率/ ./ 定义/ 5/ ./ 最弱/ 前置条件/ (/ WeakestPrecondition/ ,/ WP/ )/ ./ 它/ 是/ 保证/ 程序/ 中/ 一条/ 语句/ 正常/ 执行/ 并/ 满足/ 结果/ 断言/ (/ 后置/ 条件/ )/ 的/ 限制/ 最小/ 的/ 前提条件/ ./ 它/ 表示/ 为/ 一组/ 谓词/ 公式/ :/ WP/ (/ S/ ,/ R/ )/ ,/ 其中/ R/ 是/ 语句/ S/ 执行/ 后/ 所/ 期望/ 的/ 结果/ 断言/ ./ 在/ 证明/ 程序正确性/ 过程/ 中/ ,/ 以/ 程序/ 的/ 执行/ 结果/ 作为/ 最后/ 一条/ 语句/ 的/ 后置/ 条件/ ,/ 通过/ 该/ 后置/ 条件/ 和/ 最后/ 一条/ 语句/ 可以/ 计算/ 出/ 最后/ 一条/ 语句/ 的/ 最弱/ 前置条件/ ,/ 以此类推/ 到/ 程序/ 的/ 开始/ ,/ 第一条/ 语句/ 的/ 前置条件/ 即/ 为/ 满足/ 结果/ 断言/ 所/ 需/ 的/ 条件/ ./ 若该/ 条件/ 包含/ 在/ 程序/ 的/ 输入/ 中/ ,/ 则/ 可/ 证明/ 程序/ 是/ 正确/ 的/ ./ 表/ 1/ 列举/ 了/ 程序/ 中/ 常见/ 类型/ 语句/ 的/ 最弱/ 前置条件/ 的/ 转换方法/ ,/ 当/ 过程/ 内/ 控制流/ 图中/ 的/ 节点/ 有/ 出边/ 的/ 时候/ 就/ 需/ 使用/ 该/ 转换方法/ ./ 其中/ φ/ [/ s1/ // s2/ ]/ 表示/ 使用/ 语句/ s2/ 去/ 替换/ 语句/ s1/ ,/ 谓词/ get/ 和/ set/ 分别/ 表示/ 获取/ 和/ 设置/ 变量/ 的/ 值/ ./ 语句/ sv/ =/ uv/ =/ u1opu2v/ =/ u/ ./ mv/ ./ m/ =/ uu/ [/ i/ ]/ =/ v/ (/ u/ ≠/ null/ )/ ∧/ (/ i/ / 0/ )/ ∧/ (/ i/ </ get/ (/ length/ )/ )/ ∧/ φ/ [/ v/ // get/ (/ u/ ,/ i/ )/ ]/ v/ =/ u/ [/ i/ ]/ (/ u/ ≠/ null/ )/ ∧/ (/ i/ / 0/ )/ ∧/ (/ i/ </ get/ (/ length/ )/ )/ ∧/ φ/ [/ get/ (/ u/ ,/ i/ )/ // v/ ]/ v/ =/ (/ T/ )/ vassumev/ 算法/ 1/ 是/ 过程/ 内/ 最弱/ 前置条件/ 的/ 生成/ 算法/ ./ 对于/ 程序/ 中/ 的/ 每/ 一条/ 语句/ s/ 和/ 它/ 对应/ 的/ 后置/ 条件/ φ/ post/ ,/ 该/ 算法/ 计算/ 过程/ 内/ 控制流/ 图中/ 每个/ 节点/ 的/ 符号/ 状态/ 的/ 集合/ S/ ,/ 并/ 对/ 结果/ 进行/ 简化/ (/ simplify/ )/ ,/ 同时/ 在/ 其/ 基础/ 上/ 进行/ 合并/ (/ merge/ )/ 操作/ ./ 简化/ 操作/ 是/ 基于/ 最/ 弱/ 前置条件/ 所/ 具有/ 的/ 析取/ 性质/ :/ WP/ (/ s/ ,/ φ/ 1/ ∨/ φ/ 2/ )/ =/ WP/ (/ s/ ,/ φ/ 1/ )/ ∨/ WP/ (/ s/ ,/ φ/ 2/ )/ ./ 它/ 是/ 状态/ 集合/ 中/ 被/ 选取/ 的/ 条件/ 的/ 析取范式/ (/ DisjunctiveNormalForm/ ,/ DNF/ )/ ./ Page4/ 下面/ 给出/ 该/ 算法/ 所/ 采用/ 的/ 合并/ 策略/ ,/ 即/ 对/ 当前/ 的/ 符号/ 状态/ 进行/ 重写/ 操作/ ,/ 例如/ merge/ (/ φ/ ∧/ a/ ,/ φ/ ∧/ / a/ )/ ./ 其中/ 谓词/ get/ 可/ 同时/ 用来/ 判断/ 数组/ 是否/ 出现/ 越界/ 现象/ ,/ 谓词/ typeOf/ 与/ subType/ 用来/ 处理程序/ 的/ 类型/ 判断/ 与/ 类型转换/ 语句/ ./ 此外/ 在/ 合并/ 过程/ 中/ 还/ 使用/ 了/ 常量/ 折叠/ (/ constantfolding/ )/ 的/ 分析方法/ ,/ 该/ 方法/ 作为/ 程序/ 优化/ 中/ 的/ 一种/ 技术/ 可以/ 将/ 程序/ 中/ 的/ 常量/ 表达式/ 存入/ 常量/ 表/ ,/ 以/ 减少/ 最/ 弱/ 前置条件/ 计算/ 过程/ 中/ 求解/ 器/ 对/ 常量/ 表达式/ 的/ 计算/ 求值/ 次数/ ,/ 同时/ 该/ 方法/ 可以/ 增加/ 程序/ 中/ 需要/ 多次/ 被/ 调用/ 的/ 过程/ 的/ 分析/ 结果/ 的/ 重用/ 率/ ./ 算法/ 1/ ./ 过程/ 内/ 最弱/ 前置条件/ (/ WPintra/ )/ 的/ 生成/ 算法/ ./ 输入/ :/ CFG/ ,/ φ/ post/ 输出/ :/ intraproceduralweakestprecondition1/ ./ varF/ :/ {/ Formula/ }/ ←/ Statement/ ;/ 2/ ./ varList/ :/ pairof/ (/ Statement/ ,/ Formula/ )/ ;/ 3/ ./ / s/ ∈/ Statement/ ,/ F/ (/ s/ )/ ←/ / ;/ 4/ ./ List/ ←/ {/ (/ ExitNode/ ,/ φ/ post/ )/ }/ ;/ 5/ ./ WHILEList/ ≠/ / DO6/ ./ (/ s/ ,/ φ/ post/ )/ ←/ selectfromList/ ;/ 7/ ./ WHILE/ (/ s/ ,/ s/ )/ ∈/ EofCFGDO8/ ./ φ/ pre/ ←/ merge/ (/ F/ (/ s/ )/ ,/ simplify/ (/ WP/ (/ s/ ,/ φ/ post/ )/ )/ )/ ;/ 9/ ./ IF/ φ/ pre/ ≠/ falseTHEN10/ ./ F/ (/ s/ )/ ←/ F/ (/ s/ )/ ∪/ φ/ pre/ ;/ 11/ ./ List/ ←/ List/ ∪/ (/ s/ ,/ φ/ pre/ )/ ;/ 12/ ./ ENDIF13/ ./ ENDWHILE14/ ./ ENDWHILE15/ ./ RETURNF/ (/ EntryNode/ )/ 对于/ 过程/ 间/ 的/ 最弱/ 前置条件/ WPinter/ ,/ 本文/ 采用/ 上下文/ 敏感/ 的/ 分析方法/ ,/ 其/ 过程/ 间/ 控制流/ 图/ (/ ICFG/ )/ 由/ 多个/ 过程/ 内/ 控制流/ 图/ 连接/ 而成/ ./ 对于/ 一个/ 调用/ v/ =/ u/ ./ f/ (/ …/ )/ (/ 此处/ 省略/ 其/ 参数/ 列表/ )/ ,/ WPinter/ 首先/ 将/ 条件/ φ/ post/ 映射/ 到/ 被/ 调用/ 的/ 函数/ f/ (/ …/ )/ 的/ 命名/ 空间/ ,/ 得到/ 函数/ f/ (/ …/ )/ 在/ 出/ 节点/ ExitNode/ 处/ 的/ 分析/ 结果/ ,/ 然后/ 通过/ 上述/ 过程/ 内/ 最弱/ 前置条件/ 算法/ WPinter/ 获得/ 函数/ f/ (/ …/ )/ 在/ 入/ 节点/ EnterNode/ 处/ 的/ 最弱/ 前置条件/ φ/ pre/ ,/ 即/ 产生/ 从/ 后置/ 条件/ 到/ 前置条件/ 的/ 一个/ 映射/ :/ φ/ post/ 以/ 引导/ 程序/ 获得/ 出/ 节点/ ExitNode/ 处/ 的/ 后置/ 条件/ φ/ post/ ,/ 最后/ 不断/ 通过/ 过程/ 内/ 控制流/ 图/ 的/ 传递/ 计算/ 出/ 控制流/ 图/ 的/ 前置条件/ φ/ pre/ ./ 在/ 得到/ 过程/ 间/ 最弱/ 前置条件/ 的/ 基础/ 上/ ,/ 由于/ 程序/ 中/ 存在/ 大量/ 的/ 过程/ 调用/ ,/ 此时/ 若/ 直接/ 依据/ 过程/ 间/ 的/ 关系/ 生成/ 调用/ 图/ ,/ 则/ 会/ 产生/ 较/ 多/ 无用/ 的/ 调用/ 关系/ ,/ 影响/ 程序验证/ 的/ 效率/ ./ 本文/ 在/ 过程/ 间/ 最弱/ 前置条件/ 生成/ 过程/ 中/ ,/ 使用/ 后/ 向/ 符号分析/ 的/ 结果/ 来/ 引导/ 程序/ 调用/ 图/ 的/ 构建/ ,/ 从而/ 生成/ 与/ 待/ 验证/ 的/ 兴趣/ 点/ 相关联/ 的/ 过程/ 调用/ 图/ ./ 算法/ 2/ ./ 带/ 过程/ 间/ 最弱/ 前置条件/ (/ WPinter/ )/ 的/ 程序/ 调用/ 图/ 生成/ 算法/ ./ 输入/ :/ CFG/ ,/ φ/ post/ 输出/ :/ callgraphunderWPintercallGraphWithWP/ (/ CFG/ ,/ φ/ post/ )/ 1/ ./ varCG/ ←/ WPinter/ (/ CFG/ ,/ φ/ post/ )/ ;/ 2/ ./ varCG/ ←/ {/ cg/ ∈/ CG/ |/ cgcanbesolved/ }/ ;/ 3/ ./ IFCG/ =/ / 4/ ./ FOREACHm/ ∈/ CGDO5/ ./ selectonemethodfromm/ ;/ 6/ ./ selects/ / subroutinesinmethod/ ∧/ 7/ ./ IFsdoesnotexist8/ ./ CONTINUE/ ;/ 9/ ./ ENDIF10/ ./ CFG/ ←/ CFG/ +/ s/ ;/ 11/ ./ RETURNcallGraphWithWP/ (/ CFG/ ,/ φ/ post/ )/ ;/ 12/ ./ ENDFOR13/ ./ ELSE14/ ./ RETURNCG/ ;/ 算法/ 2/ 中/ 第/ 4/ ~/ 11/ 行/ 通过/ 判断/ 过程/ 内/ 控制流/ 图/ 的/ 函数调用/ 关系/ 来/ 扩展/ 程序/ 中/ 的/ 调用/ 关系/ ,/ 并/ 使用/ 递归/ 运算/ 得出/ 与/ 兴趣/ 点/ 相关/ 的/ 程序/ 调用/ 图/ ./ 由于/ 该/ 精简/ 的/ 调用/ 图/ 删除/ 了/ 与/ 待/ 验证/ 性质/ 无关/ 的/ 函数调用/ 集合/ ,/ 故/ 可以/ 在/ 此基础/ 上/ 生成/ 有/ 针对性/ 的/ 路径/ 验证/ 集合/ ./ 图/ 1/ 表示/ 一个/ 程序/ 片段/ (/ 图/ 1/ (/ a/ )/ )/ 以/ 最弱/ 前置条件/ 为/ 引导/ 信息/ 的/ 程序验证/ 过程/ ./ 程序/ 第/ 10/ 行/ 存在/ 一条/ 断言/ 语句/ ,/ 若该/ 语句/ 被/ 触发/ 即/ 表示/ 验证/ 过程/ 失败/ ./ 文献/ [/ 7/ ]/ 指出/ :/ 若/ 程序/ 中/ 一条/ 具体/ 的/ 执行/ 路径/ 不/ 可行/ ,/ 那么/ 其/ 临近/ 路径/ 也/ 是/ 不/ 可行/ 的/ 概率/ 较/ 高/ ./ 本文/ 据此/ 理论/ 采用/ 后/ 向/ 符号分析/ 方法/ ,/ 使用/ 最/ 弱/ 前置条件/ 和/ 断言/ 得到/ 的/ 具体/ 执行/ 路径/ 来/ 构建/ 有限/ 符号分析/ 树/ ,/ 并/ 生成/ 与/ 此/ 路径/ 临近/ 的/ 尽可能/ 多/ 的/ 可行/ 路径/ 来/ Page5/ 图/ 1/ 带/ 最弱/ 前置条件/ 的/ 符号分析/ 树对/ 程序/ 进行/ 验证/ ./ 在/ 最弱/ 前置条件/ 的/ 计算/ 过程/ 中/ 的/ 两个/ 主要/ 的/ 规则/ 表示/ 如下/ :/ WP/ (/ x/ ·/ WP/ (/ if/ (/ c/ )/ s1elses2/ ,/ Q/ )/ =/ 图/ 1/ (/ b/ )/ ~/ (/ d/ )/ 表示/ 该/ 程序/ 片段/ 所/ 对应/ 的/ 符号分析/ 树/ ,/ 程序/ 中/ (/ / )/ 表示/ 该处/ 的/ 验证/ 条件/ 可能/ 为/ true/ 也/ 可能/ 为/ false/ ,/ 在/ 分析/ 过程/ 中/ 主要/ 的/ 问题/ 就是/ 如何/ 使用/ 这些/ 规则/ 来/ 产生/ 路径/ 条件/ 对应/ 的/ 合取/ 公式/ ./ 在/ 符号分析/ 过程/ 中/ ,/ 求解/ 器会/ 在/ 每/ 一个/ 分支/ 位置/ 对/ 路径/ 条件/ 进行/ 计算/ 以/ 删除/ 那些/ 冗余/ 的/ 或者/ 不可/ 解/ 的/ 路径/ 条件/ ./ 图/ 1/ (/ b/ )/ 表示/ 后/ 向/ 符号分析/ 的/ 第/ 1/ 阶段/ ,/ 其中/ 在/ 每个/ 节点/ 处/ 加入/ 了/ 最弱/ 前置条件/ :/ τ/ 1/ :/ s0/ / 6/ ;/ τ/ 2/ :/ s0/ / 6/ ;/ τ/ 5/ :/ s1/ / 7/ ;/ τ/ 6/ :/ s1/ / 7/ ;/ τ/ 9/ :/ s2/ / 8/ ,/ 例如/ τ/ 6/ :/ s1/ / 7/ 可以/ 通过/ WP/ (/ s2/ =/ s1/ +/ 1/ ,/ s2/ / 8/ )/ 计算/ 得出/ ,/ 注意/ 此处/ 采用/ 了/ SSA/ 方法/ 的/ 表达形式/ ./ 图/ 1/ (/ c/ )/ 表示/ 后/ 向/ 符号分析/ 的/ 第/ 2/ 阶段/ ,/ 在/ 第/ 9/ 行/ 由于/ 符号/ 状态/ s0/ =/ 0/ ∧/ s1/ =/ s0/ +/ 1/ ∧/ s2/ =/ s1/ +/ 2/ →/ s2/ / 8/ ,/ 故/ 在/ 此处/ 可以/ 使用/ 上述/ simplify/ 与/ merge/ 操作/ 来/ 对/ 路径分析/ 的/ 结果/ 进行/ 约简/ ,/ 其中/ 虚线/ 箭头/ 表示/ 被/ 包含/ 的/ 路径/ ./ 类似/ 地/ ,/ 在/ 图/ 1/ (/ d/ )/ 中/ 由于/ (/ s0/ =/ 0/ ∧/ s1/ =/ s0/ +/ 2/ )/ →/ s1/ / 7/ ,/ 故/ 通过/ 该/ 分析方法/ 之后/ ,/ 符号分析/ 树/ 的/ 规模/ 与/ 分支/ 的/ 数目/ 呈/ 线性关系/ ,/ 有效/ 地/ 减少/ 了/ 分析/ 空间/ 的/ 规模/ ./ 3/ 犽/ 近邻/ 路径/ 生成/ 方法/ 设/ 程序/ Prog/ 在/ 其/ 对应/ 的/ 过程/ 间/ 控制流/ 图中/ 的/ 执行/ 路径/ 为/ 集合/ Paths/ ,/ 为了/ 验证/ Prog/ 的/ 可达性/ ,/ 需要/ 在/ 程序/ 中待/ 分析/ 的/ 检测点/ 设置/ 断言/ φ/ ,/ 通过/ 计算/ φ/ 与/ 此处/ 的/ 路径/ 条件/ (/ PathCondition/ ,/ PC/ )/ 的/ 逻辑/ 包含/ 关系/ 来/ 对/ Prog/ 进行/ 验证/ ,/ PC/ 是/ 程序/ 能/ 执行/ 到/ 此处/ 的/ 由/ 约束条件/ 所/ 组成/ 的/ 一阶/ 逻辑/ 公式/ ./ 定义/ 6/ ./ 编辑/ 距离/ (/ EditDistance/ )/ ./ 它/ 是/ 指/ 两个/ 串/ (/ S/ ,/ T/ )/ 之间/ ,/ 由/ 一个/ 串/ 通过/ 替换/ 、/ 插入/ 、/ 删除/ 操作/ 转换成/ 另/ 一个/ 串/ 的/ 最少/ 操作/ 次数/ ./ 在/ 实际/ 应用/ 过程/ 中/ ,/ 常/ 采用/ 动态/ 规划/ 的/ 方法/ 来/ 计算/ 编辑/ 距离/ ,/ 其/ 动态/ 规划/ 公式/ 为/ (/ 1/ )/ i/ =/ =/ 0/ &&/ j/ =/ =/ 0/ ,/ edit/ (/ i/ ,/ j/ )/ =/ 0/ ;/ (/ 2/ )/ i/ =/ =/ 0/ &&/ j/ >/ 0/ ,/ edit/ (/ i/ ,/ j/ )/ =/ j/ ;/ (/ 3/ )/ i/ >/ 0/ &&/ j/ =/ =/ 0/ ,/ edit/ (/ i/ ,/ j/ )/ =/ i/ ;/ (/ 4/ )/ i/ >/ 0/ &&/ j/ >/ 0/ ,/ edit/ (/ i/ ,/ j/ )/ =/ min/ (/ edit/ (/ i/ -/ 1/ ,/ 其中/ edit/ (/ i/ ,/ j/ )/ 表示/ S/ 的/ 子串/ [/ 0/ …/ i/ ]/ 到/ T/ 的/ 子串/ [/ 0/ …/ j/ ]/ 的/ 编辑/ 距离/ ,/ f/ (/ i/ ,/ j/ )/ 表示/ S/ 中/ 第/ i/ 个字符/ S/ [/ i/ ]/ 转换/ 到/ T/ 中/ 第/ j/ 个字符/ T/ [/ j/ ]/ 所/ 需要/ 的/ 操作/ 次数/ ,/ 若/ S/ [/ i/ ]/ =/ =/ T/ [/ j/ ]/ ,/ 则/ f/ (/ i/ ,/ j/ )/ =/ 0/ ;/ 否则/ f/ (/ i/ ,/ j/ )/ =/ 1/ ./ 本文/ 使用/ 编辑/ 距离/ 计算/ 两条/ 执行/ 路径/ 的/ 相似/ 度/ ,/ 因子/ k/ 用来/ 指导/ 生成/ 一个/ 与/ 当前/ 分析/ 路径/ l/ 相似/ 的/ 路径/ 集合/ L/ ,/ 其中/ 每条/ 路径/ 与/ l/ 的/ 编辑/ 距离/ 相差/ 不/ 超过/ k/ ,/ 显然/ L/ / Paths/ :/ 其中/ 算子/ △/ 用来/ 计算/ 待/ 分析/ 的/ 路径/ 与/ 当前/ 生成/ 的/ 路径/ 之间/ 的/ 编辑/ 距离/ ./ kWP/ 的/ 定义/ 如下/ :/ kWP/ :/ {/ (/ s/ ,/ pc/ ,/ path/ ,/ k/ )/ ∈/ Prog/ ×/ PC/ ×/ Paths/ ×/ k/ →/ PC/ }/ ./ 上式/ 所/ 得到/ 的/ 是/ 经/ 最弱/ 前置条件/ 计算/ 后/ 的/ 更新/ 的/ 路径/ 条件/ 集合/ ,/ 通过/ SMT/ 求解/ 器/ [/ 8/ ]/ 可/ 得到/ 路径/ l/ 所/ 对应/ 的/ 输入/ 变量/ 的/ 近似值/ ./ 对于/ 程序/ 中/ 常见/ 的/ 循环/ 语句/ ,/ 其/ 执行/ 路径/ 在/ 过程/ 间/ 控制流/ 图中/ 表示/ 为/ 一个/ 带回/ 边/ 的/ 节点/ 集合/ ./ 图/ 2/ 是/ 一个/ 带/ 循环/ 的/ 控制流/ Page6/ 图/ 及其/ 对应/ 的/ 消除/ 循环/ 节点/ 的/ 控制流/ 图/ CFG/ ./ 图中/ 每/ 条边/ 都/ 有/ 一个/ 符号/ 与其/ 对应/ ,/ 这样/ 每条/ 执行/ 路径/ 都/ 有/ 一个/ 特定/ 的/ 符号串/ ,/ 即该/ 路径/ 的/ 编码/ ./ 对于/ 循环体/ 执行/ n/ 次/ 的/ 某条/ 执行/ 路径/ ,/ 其/ 路径/ 编码/ 可以/ 记录/ 为/ CFGn/ ,/ 显然/ CFGn/ 是/ CFG/ 的/ 一个/ 子图/ ./ 算法/ 3/ 是/ 计算/ 与/ 指定/ 路径/ 的/ 编辑/ 距离/ 不/ 超过/ k/ 的/ 执行/ 路径/ 集合/ 的/ 生成/ 算法/ ./ 图/ 2/ 循环/ 结构/ 过程/ 间/ 控制流/ 图/ 及其/ ICFG/ 形式/ 算法/ 3/ ./ k/ 近邻/ 路径/ 生成/ 算法/ ./ 输入/ :/ k/ ,/ ICFG/ ,/ l/ 输出/ :/ Pathswithkdistancetol1/ ./ G/ ←/ reverseArcs/ (/ ICFG/ )/ ;/ 2/ ./ l/ ←/ reverse/ (/ l/ )/ ;/ 3/ ./ Paths/ ←/ / ;/ 4/ ./ q/ ./ append/ (/ l/ [/ 0/ ]/ ,/ 〈/ 〉/ )/ ;/ 5/ ./ WHILEq/ ≠/ / DO6/ ./ 〈/ v/ ,/ p/ 〉/ ←/ q/ ./ dequeue/ (/ )/ ;/ 7/ ./ IF/ (/ v/ =/ l/ [/ |/ l/ |/ -/ 1/ ]/ )/ ∧/ (/ △/ (/ p/ ,/ l/ )/ / k/ )/ THEN8/ ./ Paths/ ←/ Paths/ ∪/ {/ p/ }/ ;/ 9/ ./ ENDIF10/ ./ index/ ←/ min/ (/ |/ p/ |/ -/ 1/ ,/ |/ l/ |/ )/ ;/ 11/ ./ IF/ △/ (/ p/ ,/ l/ [/ 0/ ,/ index/ ]/ )/ / 2kTHEN12/ ./ p/ ./ append/ (/ v/ )/ ;/ 13/ ./ selectnfromV/ ;/ 14/ ./ q/ ./ append/ (/ 〈/ n/ ,/ p/ 〉/ )/ ;/ 15/ ./ ENDIF16/ ./ ENDWHILE17/ ./ RETURNPaths/ 其中/ 算子/ △/ 用来/ 计算/ 两个/ 路径/ 串/ 之间/ 的/ 编辑/ 距离/ ,/ 对于/ 一条/ 执行/ 路径/ l/ ,/ 变量/ |/ l/ |/ 表示/ l/ 中/ 节点/ 的/ 个数/ ,/ l/ [/ i/ ,/ j/ ]/ 是/ 路径/ l/ 的/ 子串/ (/ 0/ / i/ </ j/ / |/ l/ |/ -/ 1/ )/ ,/ l/ [/ |/ l/ |/ -/ 1/ ]/ 表示/ l/ 中/ 最后/ 一个/ 节点/ ./ 该/ 算法/ 通过/ 对/ 参数/ ICFG/ 所/ 表示/ 的/ 控制流/ 图和待/ 分析/ 的/ 执行/ 路径/ 的/ 指向/ 进行/ 翻转/ ,/ 若/ 生成/ 的/ 执行/ 路径/ 与/ l/ 的/ 编辑/ 距离/ 不/ 超过/ 2k/ ,/ 则/ 不断/ 扩展/ 搜索/ 的/ 路径/ ,/ 在/ 能够/ 到达/ 程序/ 入/ 节点/ 的/ 路径/ 中/ ,/ 若/ k/ 的/ 值/ 不能/ 更/ 小/ ,/ 则/ 保留/ 该/ 执行/ 路径/ ./ 故/ 对于/ 距离/ 执行/ 路径/ l/ 的/ 编辑/ 距离/ 不/ 超过/ k/ 的/ 路径/ 集合/ 中/ ,/ 存在/ 对应/ 的/ CFGn/ ./ 值得注意/ 的/ 是/ 该/ 算法/ 可能/ 生成/ 不可/ 达/ 的/ 执行/ 路径/ ,/ 例如/ 程序/ 的/ 循环/ 次数/ 超过/ 了/ 设定/ 的/ 一个/ 阈值/ ,/ 那么/ 在/ 随后/ 的/ 符号分析/ 过程/ 中/ ,/ 符号执行/ 工具/ 所/ 采用/ 的/ 求解/ 器会/ 对/ 当前/ 的/ 谓词/ 集合/ 进行/ 求解/ 以/ 确定/ 其/ 可/ 满足/ 性/ ./ 例如/ 对于/ α/ </ 3/ ∧/ α/ =/ 5/ 这样/ 谓词/ 集合/ 不/ 存在/ 解/ ,/ 故/ 对应/ 的/ 条件/ 在/ 传递/ 到/ 下/ 一个/ 节点/ 前会/ 被/ 删除/ ./ 对于/ 最后/ 所/ 生成/ 的/ 可/ 执行/ 路径/ 集合/ L/ ,/ 其/ kWP/ 是/ 各/ 路径/ 最/ 弱/ 前置条件/ 的/ 析取/ :/ kWP/ (/ Prog/ ,/ PC/ ,/ Paths/ ,/ k/ )/ =/ ∨/ 当/ k/ =/ 0/ 时/ ,/ kWP/ 对/ 当前/ 待/ 分析/ 的/ 路径/ 进行/ 分析/ ;/ 随着/ k/ 的/ 增大/ ,/ 算法/ 3/ 将会/ 生成/ 越来越/ 多/ 的/ 符合条件/ 的/ 路径/ ./ 在/ k/ →/ 的/ 情况/ 下/ ,/ kWP/ 的/ 计算方法/ 与/ 传统/ 最/ 弱/ 前置条件/ 的/ 计算方法/ 存在/ 如下/ 关系/ :/ kWP/ (/ Prog/ ,/ PC/ ,/ Paths/ ,/ k/ )/ =/ WP/ (/ Prog/ ,/ PC/ )/ ,/ limk/ →/ 当/ k/ 值/ 发生变化/ 的/ 时候/ ,/ 算法/ 会/ 生成/ 不同/ 的/ 路径/ 集合/ ,/ 这样/ 就/ 需要/ 在/ 分析/ 精度/ 和/ 分析/ 的/ 规模/ 之间/ 进行/ 权衡/ ,/ 以/ 获得/ 最优/ 的/ 分析/ 结果/ ,/ 本文/ 的/ 方法/ 比/ 传统/ 的/ 最弱/ 前置条件/ 分析方法/ 能/ 更加/ 有效/ 地/ 获得/ 反例/ 程序/ ./ 4/ 犽/ WP/ 的/ 有效性/ 为了/ 验证/ 本文/ 方法/ 的/ 有效性/ ,/ 从/ 路径/ 可/ 满足/ 性/ 的/ 角度/ 提出/ 验证/ 方法/ ./ 对于/ 程序/ Prog/ ,/ 其/ 输入/ 域/ 为/ I/ ,/ 对应/ 的/ 值域/ 为/ O/ ,/ 则/ 程序/ 可以/ 表示/ 为/ 输入/ 集合/ 到/ 输出/ 集合/ 上/ 的/ 映射/ I/ →/ O/ ./ 对于/ 输入/ i/ (/ i/ ∈/ I/ )/ ,/ 其/ 对应/ 的/ 执行/ 路径/ 记为/ l/ ,/ 待/ 验证/ 的/ 断言/ 为/ φ/ ,/ 一条/ 可/ 满足/ 的/ 路径/ 可以/ 表示/ 为/ Prog/ (/ i/ )/ / φ/ ./ 定义/ 7/ ./ 失效/ 路径/ 输入/ 域/ Iinfea/ =/ {/ i/ |/ i/ ∈/ I/ ,/ Prog/ (/ i/ )/ / / φ/ }/ ./ 上节/ 分析/ 到/ kWP/ 可能/ 会/ 生成/ 不可/ 达/ 的/ 路径/ ,/ 故/ 使用/ Iinfea/ 表示/ 那些/ 不能/ 被/ 满足/ 或者/ 不能到达/ 指定/ 位置/ 的/ 路径/ 所/ 对应/ 的/ 输入/ 值/ ./ 本文/ 的/ 方法/ 生成/ 与/ 设定/ 的/ 因子/ k/ 相关/ 的/ 路径/ 集合/ ,/ 在/ 此/ 阶段/ 可以/ 不断/ 调整/ k/ 的/ 取值/ ,/ 以/ 发掘/ 类似/ 的/ 可达/ 路径/ 集合/ ./ 定义/ 8/ ./ kWP/ 可达/ 路径/ 输入/ 域/ IfeaI/ \/ Ifea/ ,/ Prog/ (/ i/ )/ / φ/ }/ ./ 本文/ 可/ 达/ 路径/ 输入/ 域/ 是/ 在/ 已知/ 可/ 满足/ 的/ 路径/ 的/ 基础/ 上/ 通过/ kWP/ 计算/ 得出/ 的/ ,/ 其/ 结果/ 是/ 对/ 程序/ 的/ 可达/ 路径/ 输入/ 域/ Ifea/ 的/ 一种/ 逼近/ ,/ 显然/ Ifea/ 这/ 几种/ 输入/ 域/ 之间/ 的/ 包含/ 关系/ ,/ IfeakWP/ / Ifea/ ,/ 理想/ 情况/ 下有/ IfeaPage7/ 表示/ kWP/ 生成/ 的/ 路径/ 集合/ 中/ 那些/ 无效/ 的/ 路径/ 集合/ 或者/ 不能/ 对/ 性质/ 进行/ 验证/ 的/ 路径/ 集合/ ,/ 在/ 最后/ 生成/ 的/ 可行/ 路径/ 集合/ 中/ 需要/ 将/ 该/ 无效/ 路径/ 集合/ 删除/ ./ 在/ 定义/ 4/ 中/ ,/ 记/ 那些/ 在/ kWP/ 计算/ 过程/ 中/ 对应/ 输入/ i/ 所/ 生成/ 的/ 不可/ 达/ 路径/ 为/ Pi/ 定义/ 9/ ./ kWP/ 程序验证/ 问题/ ./ 设待/ 分析/ 的/ 程序/ Prog/ ,/ 它/ 的/ 一条/ 可执行程序/ 路径/ l/ 对应/ 的/ 输入/ 为/ i/ ,/ 待/ 验证/ 的/ 条件/ 为/ φ/ ,/ 经/ kWP/ 计算/ 得到/ 与/ l/ 的/ 编辑/ 距离/ 不/ 超过/ k/ 的/ 路径/ 集合/ 及其/ 对应/ 的/ 前置条件/ WP/ ,/ 对于/ 其中/ 的/ 可达/ 路径/ ,/ 以/ WP/ 为/ 引导/ 条件/ 对/ 程序/ 进行/ 符号执行/ 操作/ 所/ 得到/ 的/ 后置/ 条件/ 记为/ P/ ,/ 通过/ 计算/ 逻辑/ 蕴含/ P/ →/ φ/ 来/ 判断/ 路径/ 的/ 可/ 满足/ 性/ ./ 对于/ k/ 的/ 不同/ 取值/ 所/ 生成/ 的/ 路径/ 集合/ ,/ 为了/ 比较/ 所/ 生成/ 的/ 路径/ 可行性/ 的/ 程度/ ,/ 可以/ 对/ k/ 的/ 优化/ 取值/ 做出/ 如下/ 定义/ ./ 定义/ 10/ ./ k/ 的/ 优化/ 取值/ 问题/ ./ 对于/ 不同/ 的/ k/ 值/ 所/ 生成/ 的/ 可行/ 路径/ 后置/ 条件/ Pk1/ 、/ Pk2/ ,/ 以及/ 所/ 生成/ 的/ 不/ 可行/ 路径/ 所/ 对应/ 的/ 输入/ 域/ Iinfeak2/ 更加/ 优化/ ,/ 当且/ 仅/ 当/ Pk1/ 逻辑/ 蕴含/ Pk2/ ,/ 且/ IinfeaIinfea2/ 的/ 子集/ ,/ 即/ k1/ / k2/ / (/ Pk1/ →/ Pk2/ ∧/ Iinfea/ 下面/ 给出/ 本文/ 验证/ 程序/ 可行性/ 所/ 采用/ 的/ 计算方法/ :/ exeSE/ (/ Prog/ ,/ kWP/ (/ Prog/ ,/ PC/ ,/ exe/ (/ Prog/ (/ i/ )/ )/ ,/ k/ )/ ∧/ PC/ )/ ./ (/ 1/ )/ 上式/ 中/ 的/ exe/ (/ Prog/ (/ i/ )/ )/ 函数/ 表示/ 以/ 数据/ i/ 为/ 输入/ 来/ 执行程序/ Prog/ ,/ 获得/ 指定/ 的/ 路径/ l/ ;/ (/ 2/ )/ kWP/ (/ Prog/ ,/ PC/ ,/ exe/ (/ Prog/ (/ i/ )/ )/ ,/ k/ )/ 在/ 计算/ 过程/ 中/ 采用/ 本文/ 的/ 方法/ 生成/ 与/ l/ 的/ 编辑/ 距离/ 不/ 超过/ k/ 的/ 路径/ 集合/ ,/ 并/ 计算/ 出/ 最弱/ 前置条件/ RWP/ ;/ (/ 3/ )/ 最后/ 使用/ RWP/ 作为/ 引导/ 条件/ 进行/ 符号执行/ 的/ 操作/ ,/ 获得/ 程序/ 的/ 后置/ 条件/ P/ ,/ 通过/ 计算/ 路径/ 可/ 满足/ 性/ 验证/ 条件/ δ/ :/ P/ ∧/ PC/ 来/ 验证/ 生成/ 的/ 路径/ 的/ 可达性/ ,/ 即/ 采用/ 逻辑/ 蕴含/ 的/ 方法/ 来/ 判断/ P/ →/ PC/ 是否/ 成立/ ,/ 如果/ 成立/ ,/ 则/ 表示/ 生成/ 的/ 路径/ 是/ 可达/ 的/ ;/ 如果/ 不/ 成立/ ,/ 则/ 可以/ 生成/ 一组/ 对应/ 的/ 路径/ 条件/ ,/ 表明/ 当前/ 的/ 路径/ 不可/ 达/ ,/ 并/ 生成/ 相应/ 的/ 程序/ 输入/ 数据/ ./ 定理/ 1/ ./ 程序/ 过程/ 内/ 控制流/ 图中/ 一条/ 可行/ 路径/ l/ 的/ 起始/ 节点/ 和/ 末尾/ 节点/ 分别/ 记为/ nh/ 和/ nt/ ,/ 在/ nt/ 处待/ 验证/ 的/ 断言/ 为/ φ/ ,/ 若/ 使用/ 本文/ 方法/ 生成/ 的/ 路径/ 可/ 满足/ 验证/ 条件/ δ/ 是/ 不可/ 满足/ 的/ ,/ 则/ 在/ 程序/ 的/ 过程/ 间/ 控制流/ 图中/ 流经/ l/ 的/ 执行/ 路径/ 在/ nt/ 处/ 可/ 使得/ φ/ 成立/ ./ 证明/ ./ 本文/ 计算/ 路径/ 可/ 满足/ 的/ 验证/ 条件/ δ/ 是/ 在/ nt/ 处/ 程序/ 的/ 路径/ 条件/ pc/ 与/ / φ/ 的/ 合取/ 操作/ :/ pc/ ∧/ / φ/ ./ 若/ 验证/ 条件/ δ/ 是/ 不可/ 满足/ 的/ ,/ 则/ 表示/ / (/ pc/ ∧/ / φ/ )/ 成立/ ,/ 即/ / δ/ →/ / (/ pc/ ∧/ / φ/ )/ ./ 依据/ 命题逻辑/ 可/ 得/ / (/ pc/ ∧/ / φ/ )/ / pc/ →/ φ/ ,/ 故/ pc/ →/ φ/ 也/ 成立/ ,/ 即/ 在/ 程序/ 的/ 过程/ 间/ 控制流/ 图中/ 流经/ l/ 的/ 执行/ 路径/ 在/ nt/ 处/ 可/ 使得/ φ/ 成立/ ./ 5/ 实验/ 与/ 分析/ 本文/ 采用/ k/ 近邻/ 最/ 弱/ 前置条件/ 和/ 符号执行/ 的/ 方法/ 来/ 分析程序/ 的/ 路径/ 可行性/ 问题/ ,/ 通过/ 比较/ kWP/ 与/ 传统/ 的/ 符号执行/ 在/ 发掘/ 程序/ 可行/ 路径/ 方面/ 的/ 数量/ 与/ 效率/ 来/ 验证/ 本文/ 方法/ 的/ 有效性/ ./ 本文/ 以/ WALA/ ①/ 作为/ 实验/ 平台/ ,/ 使用/ 平台/ 提供/ 的/ T/ ./ J/ ./ WatsonLibraries/ 作为/ 程序/ 过程/ 内/ 和/ 过程/ 间/ 分析/ 的/ 工具/ ,/ 并/ 构建/ 程序/ 的/ 控制流/ 图/ 与/ 调用/ 图/ ,/ 在/ 因子/ k/ 的/ 作用/ 下/ 生成/ 待/ 分析/ 的/ 路径/ 集合/ ,/ 并/ 使用/ CVC3/ 工具/ [/ 9/ ]/ 对/ 本文/ 算法/ 1/ 过程/ 中/ 所/ 得到/ 的/ 路径/ 谓词/ 进行/ 计算/ ,/ 保留/ 那些/ 可以/ 求解/ 的/ 路径/ 谓词/ 集合/ ,/ 最后/ 符号执行/ 工具/ JavaPathFinder/ [/ 10/ ]/ 以该/ 谓词/ 集合/ 作为/ 前置条件/ 引导/ 程序运行/ ,/ 并/ 对/ 路径/ 的/ 可行性/ 进行/ 验证/ ./ 在/ 实验/ 过程/ 中/ 涉及/ 到/ 的/ 验证/ 性质/ 包括/ 缓冲区/ 溢出/ 、/ 悬空/ 指针/ 、/ 内存/ 泄漏/ 、/ 类型/ 状态/ 属性/ 等/ ./ 实验/ 的/ 整体/ 分析/ 流程/ 如图/ 4/ 所示/ ./ 本文/ 的/ 实验/ 环境/ 是/ IntelCorei52/ ./ 5GHz/ 的/ CPU/ ,/ 内存大小/ 为/ 4GB/ ,/ 操作系统/ 采用/ Ubuntu12/ ./ 04/ ,/ 内核/ 版本/ 为/ 3.2/ ./ 0/ -/ 24/ ,/ Java/ 运行/ 时/ 的/ 版本/ 为/ JRE6/ ./ ①/ http/ :/ // // wala/ ./ sf/ ./ netPage8/ 本文/ 采用/ 的/ 测试/ 基准/ 程序/ 集合/ 来自/ DaCapo/ [/ 11/ ]/ 和/ 常见/ 的/ 开源/ JAVA/ 程序/ ,/ 如表/ 2/ 所示/ ./ 其中/ hedc/ 和/ weblech/ 分别/ 是/ 网络/ 爬虫/ 和/ 网站/ 下载工具/ ,/ lusearch/ 是/ 文本/ 索引/ 工具/ ,/ sunflow/ 是/ 照片/ 渲染/ 工具/ ,/ avrora/ 是/ 微控制器/ 仿真/ 分析/ 工具/ ,/ hsqldb/ 是/ 一款/ 关系数据库/ 引擎/ ,/ antlr/ 是/ 一款/ 支持/ 结构化/ 文本/ 和/ 二进制/ 文件/ 的/ 扫描器/ 生成/ 工具/ ,/ batik/ 是/ 一个/ 基于/ Java/ 的/ 支持/ 可/ 缩放/ 矢量图/ 的/ 浏览器/ ./ 这些/ 程序/ 的/ 主要/ 特点/ 是/ 规模/ 较大/ ,/ 具有/ 较/ 多/ 的/ 分支/ 语句/ 和/ 循环/ 语句/ ,/ 可/ 较为/ 方便/ 地/ 设置/ 待/ 验证/ 的/ 断言/ 并/ 验证/ 本文/ 方法/ 的/ 有效性/ ./ 测试程序/ hedcweblech2793167lusearch2934121sunflow5210371avrora4761423hsqldb3593287antlrbatik/ 本文/ 所/ 提出/ 的/ kWP/ 方法/ 由于/ 是/ 对/ 最弱/ 前置条件/ 的/ 一种/ 近似/ ,/ 故/ k/ 的/ 值/ 越/ 大/ ,/ 其/ 分析/ 精度/ 也/ 越/ 高/ ,/ 相应/ 的/ 时间/ 开销/ 也/ 会/ 越/ 大/ ,/ 在/ 验证/ 程序/ 路径/ 的/ 可行性/ 方面/ ,/ 由于/ 最/ 弱/ 前置条件/ 是/ 一种/ 后/ 向/ 符号分析/ 方法/ ,/ 故/ 需要/ 将/ kWP/ 的/ 结果/ 反馈/ 于/ 符号执行/ 工具/ ,/ 以/ 引导/ 其/ 发掘/ 可行性/ 路径/ ./ 本文/ 的/ 主要/ 贡献/ 在于/ 通过/ 使用/ kWP/ 方法/ 更加/ 高效/ 地/ 通过/ 当前/ 的/ 失效/ 路径/ 来/ 发掘/ 尽可能/ 多/ 的/ 失效/ 路径/ ,/ 而/ 不用/ 像/ 单纯/ 的/ 符号执行/ 工具/ 那样/ 去/ 分析/ 整个/ 程序/ 状态/ 空间/ ./ 在/ 实验/ 过程/ 中/ ,/ 主要/ 考察/ 本文/ 方法/ 对/ 符号执行/ 工具/ 在/ 发掘/ 可行/ 路径/ 方面/ 的/ 效率/ ,/ 主要/ 考察/ 指标/ 为/ 本文/ 方法/ 的/ 运算/ 时间/ 以及/ 因子/ k/ 的/ 取值/ 对/ 可行/ 路径/ 数量/ 的/ 影响/ ./ 测试/ 基准/ 程序/ 的/ 相关/ 信息/ 如表/ 2/ 所示/ ,/ 其中/ 圈/ 复杂度/ [/ 12/ ]/ (/ CyclomaticComplexity/ ,/ CC/ )/ 表示/ 程序/ 中/ 判定/ 节点/ 的/ 个数/ ,/ 它/ 是/ 一种/ 代码/ 复杂度/ 的/ 衡量标准/ ,/ 其值/ 表示/ 的/ 是/ 可行/ 路径/ 的/ 条数/ ,/ 即/ 为了/ 验证/ 程序/ 的/ 某个/ 断言/ 所/ 需/ 的/ 最少/ 路径/ 条数/ ./ 圈/ 复杂度/ 越大/ ,/ 表明/ 程序/ 可能/ 存在/ 的/ 错误/ 数量/ 越/ 多/ ,/ 从而/ 其/ 验证/ 的/ 难度/ 也/ 相对/ 较大/ ./ 圈/ 复杂度/ 的/ 计算方法/ 为/ CC/ (/ G/ )/ =/ e/ -/ n/ +/ 2/ ,/ 其中/ e/ 表示/ 控制流/ 图中边/ 的/ 数量/ ,/ n/ 表示/ 节点/ 的/ 数量/ ./ 断言/ 表示/ 程序/ 中待/ 验证/ 的/ 路径/ 所/ 到达/ 的/ 位置/ 需/ 满足/ 的/ 条件/ ,/ 即待/ 验证/ 的/ 兴趣/ 点/ ./ 对于/ 不同/ 的/ 断言/ ,/ 有/ 一个/ 对应/ 的/ k/ 值来/ 表示/ 对/ 当前/ 路径/ 可行性/ 的/ 判定/ ,/ 表中/ kmax/ 和/ kmin/ 分别/ 表示/ 在/ 待/ 验证/ 的/ 断言/ 集合/ 中/ k/ 的/ 最大/ 取值/ 与/ 最小/ 取值/ ,/ 平均/ 运行/ 时间/ 是/ 在/ 各自/ 程序/ k/ 的/ 取值/ 范围/ 内/ 对/ 断言/ 集合/ 进行/ 验证/ 的/ 运行/ 时间/ 的/ 平均值/ ,/ 这样/ 可以/ 从/ 整体/ 上/ 对比/ 本文/ 方法/ 的/ 时间/ 开销/ ./ 在/ 图/ 5/ 中/ 我们/ 定义/ 了/ 加速/ 比/ (/ SpeedupRatio/ )/ 的/ 概念/ ,/ 它/ 表示/ 在/ 不同/ k/ 值/ 的/ 影响/ 下/ ,/ 对于/ 当前/ 待/ 分析/ 的/ 一条/ 失效/ 路径/ ,/ 本文/ 方法/ 在/ 发掘/ 与其/ 近邻/ 的/ 失效/ 路径/ 集合/ 所/ 使用/ 的/ 时间/ (/ TkWP/ )/ 与/ 直接/ 采用/ 符号执行/ 的/ 方法/ (/ TSE/ )/ 所/ 使用/ 的/ 时间/ 的/ 比值/ (/ TkWP/ // TSE/ )/ ./ 为了/ 更加/ 直观/ 地/ 体现/ 本文/ 方法/ 的/ 效果/ ,/ 对于/ 每/ 一个/ 测试/ 基准/ 程序/ 的/ 不同/ 兴趣/ 点/ 在/ 同一个/ k/ 值/ 的/ 约束/ 下/ 采用/ 取/ 平均值/ 的/ 方式/ 来/ 计算/ 该处/ 的/ 加速/ 比/ 的/ 值/ ./ 从图/ 可/ 看出/ 加速/ 比/ 的/ 值域/ 为/ (/ 0/ ,/ 1/ )/ ,/ 并/ 没有/ 出现/ 加速/ 比/ 大于/ 1/ 的/ 情况/ ,/ 表明/ 本文/ 的/ 方法/ 由于/ 在/ 路径/ 搜索/ 过程/ 中/ 加入/ 了/ 与/ 失效/ 路径/ 相关/ 的/ 最弱/ 前置条件/ ,/ 在/ 发掘/ 失效/ 路径/ 过程/ 中/ 消耗/ 的/ 时间/ 较/ 单纯/ 的/ 符号执行/ 时间/ 要少/ ./ 加速/ 比/ 的/ 值/ 越/ 小/ ,/ 表明/ 时间/ 开销/ 也/ 越少/ ./ 从图/ 5/ 可以/ 看出/ ,/ 加速/ 比/ 的/ 值/ 随/ k/ 的/ 取值/ 的/ 增大/ 而/ 增大/ ,/ 反映/ 出/ 发掘/ 失效/ 路径/ 的/ 时间/ 开销/ 会/ 不断/ 增加/ ./ 尤其/ 在/ k/ 值较/ 小/ 的/ 时候/ ,/ 加速/ 比/ 上升/ 的/ 幅度/ 较/ 快/ ,/ 当/ k/ 的/ 值/ 逐渐/ 增加/ ,/ 其/ 加速/ 比/ 的/ 值/ 趋向于/ 1/ ,/ 即/ 表明/ 本文/ 方法/ 的/ 效率/ 逐渐/ 下降/ ,/ 趋向于/ 单纯/ 使用/ 符号执行/ 方法/ 所/ 得到/ 的/ 结果/ ./ 这是/ 由于/ 随着/ k/ 值/ 的/ 增加/ ,/ 最/ 弱/ 前置条件/ 在/ 计算/ 过程/ 中/ 所/ 分析/ 的/ 路径/ 谓词/ 也/ 越/ 多/ ,/ 根据/ 本文/ 第/ 3/ 节/ kWP/ 与/ 传统/ 最/ 弱/ 前置条件/ 之间/ 的/ 关系/ ,/ 其/ 分析/ 精度/ 也/ 趋向于/ 单纯/ 使用/ 符号执行/ 工具/ 的/ 结果/ ./ 当/ k/ 的/ 取值/ 较/ 小/ 的/ 时候/ ,/ 加速/ 比/ 上升/ 较/ 快/ 的/ 现象/ 反映/ 出/ 与/ 失效/ 路径/ 的/ 编辑/ 距离/ 较近/ 的/ 路径/ 会/ 较/ 快/ 地被/ 符号执行/ 工具/ 检测/ 出来/ ,/ 体现/ 为/ 加速/ 比有/ 较/ 小/ 的/ 值/ ,/ 同时/ 也/ 验证/ 了/ 距离/ 失效/ 路径/ 较近/ 的/ 路径/ 其/ 失效/ 的/ 概率/ 也/ 较/ 高/ 的/ 结论/ ./ 对/ 加速/ 比有/ 直接/ 影响/ 的/ 是/ 程序/ 内部/ 的/ 控制流/ 结构/ 的/ 复杂程度/ 以及/ 数据流/ 的/ 对象/ 数量/ ,/ 从/ 本组/ 实验/ 可以/ 看出/ 程序/ lusearch/ 的/ 加速/ 比值/ 最小/ 为/ 0.73/ ,/ 即/ 表明/ 本文/ 的/ 方法/ 相对/ 于/ 传统/ Page9/ 的/ 符号执行/ 方法/ 最多/ 有/ 0.73/ 的/ 加速/ 比/ ;/ 而/ 程序/ weblech/ 的/ 加速/ 比值/ 为/ 0.91/ ,/ 其/ 原因/ 是/ 程序/ 中有/ 较/ 多/ 的/ 全局变量/ 和/ 环境变量/ 作为/ 路径/ 分支/ 的/ 判断/ 条件/ ,/ 对/ 程序/ 的/ 控制流/ 结构/ 的/ 影响/ 较为/ 明显/ ./ 另外/ 在/ kWP/ 分析/ 过程/ 中/ ,/ 由于/ SSA/ 对/ 变量/ 的/ 重命名/ 以及/ 上下文/ 敏感/ 的/ 分析/ 过程/ 导致/ 产生/ 了/ 较/ 多/ 需要/ 识别/ 的/ 新/ 对象/ ,/ 从而/ 对/ kWP/ 的/ 时间/ 和/ 空间/ 复杂度/ 带来/ 了/ 一定/ 的/ 影响/ ,/ 但是/ 从图/ 5/ 中/ 可以/ 看出/ ,/ 由于/ kWP/ 为/ 符号执行/ 工具/ 提供/ 了/ 与/ 待/ 验证/ 性质/ 相关/ 的/ 路径/ 引导/ 信息/ ,/ 故/ 能够/ 对/ 控制流/ 结构/ 以及/ 数据流/ 对象/ 进行/ 约/ 减/ ,/ 使得/ 加速/ 比值/ 能够/ 小于/ 1/ (/ TkWP/ // TSE/ </ 1/ )/ ,/ 即/ 表明/ 本文/ 的/ 方法/ 相对/ 于/ 传统/ 的/ 符号执行/ 分析方法/ 有/ 更/ 高/ 的/ 执行/ 效率/ ./ 图/ 6/ 表示/ 在/ 路径/ 可行性/ 验证/ 过程/ 中/ ,/ 在/ 符号执行/ 工具/ JavaPathFinder/ 运行/ 前/ 加入/ kWP/ 分析/ 的/ 可行/ 路径/ 百分比/ 对比/ 图/ ./ 柱状图/ 中/ 的/ 黑色/ 部分/ 表示/ 只/ 使用/ JavaPathFinder/ 的/ 可行/ 路径/ 占/ 所/ 生成/ 路径/ 集合/ 的/ 百分比/ ;/ 灰色/ 部分/ 表示/ 加入/ kWP/ 分析/ 后/ ,/ 可行/ 路径/ 所/ 占/ 的/ 百分比/ 相对/ 于/ 加入/ 之前/ 的/ 增加/ 幅度/ ;/ 斜纹/ 部分/ 表示/ 加入/ kWP/ 分析/ 后/ ,/ 不/ 可行/ 的/ 路径/ 或者/ 冗余/ 的/ 路径/ 所/ 占/ 的/ 比例/ ./ 从图/ 6/ 可以/ 看出/ 基于/ 符号执行/ 的/ 路径/ 搜索/ 方法/ 在/ 加入/ kWP/ 后/ ,/ 能/ 较/ 大幅度/ 地/ 提高/ 路径/ 可行性/ 的/ 验证/ 效率/ ,/ 同时/ 误报/ 和/ 漏报/ 数量/ 均/ 相应/ 减少/ ./ 在/ 实际/ 分析/ 过程/ 中/ ,/ JavaPathFinder/ 存在/ 循环/ 条件/ 的/ 计算/ 较为/ 复杂/ 难以/ 求解/ ,/ 导致/ 容易/ 在/ 设定/ 时间/ 阈值/ 内/ 出现/ 死循环/ 的/ 现象/ ,/ 故/ 对于/ 程序/ 中/ 的/ 循环/ 变量/ ,/ 本文/ 中/ 采用/ 图/ 2/ 的/ 方法/ 将/ 循环/ 结构/ 展开/ ,/ 并/ 逐渐/ 增加/ k/ 的/ 取值/ 来/ 调整/ 循环体/ 执行/ 的/ 次数/ ,/ 通过/ 计算/ 不可/ 解/ 的/ 循环/ 条件/ 来/ 生成/ 对应/ 的/ 反例/ 程序/ 来/ 引导/ 生成/ 可行/ 的/ 路径/ ./ 影响/ 可行/ 路径/ 百分比/ 的/ 因素/ 与/ 影响/ 加速/ 比/ 的/ 因素/ 类似/ ,/ 不同之处/ 在于/ 加速/ 比/ 突出/ 的/ 是/ 在/ 某个/ k/ 值/ 的/ 作用/ 下/ 本文/ 方法/ 与/ 传统/ 符号执行/ 方法/ 在/ 时间/ 开销/ 方面/ 的/ 比较/ ;/ 而/ 可行/ 路径/ 百分比/ 强调/ 的/ 是/ 能够/ 发掘/ 的/ 可行/ 路径/ 的/ 数量/ ./ 如图/ 6/ 所示/ ,/ 本文/ 方法/ 在/ 发掘/ 与/ 兴趣/ 点/ 相关/ 的/ 路径/ 集合/ 方面/ 相对/ 于/ 传统/ 符号执行/ 方法/ 有/ 大/ 的/ 性能/ 提升/ ,/ 程序/ lusearch/ 的/ 提升/ 幅度/ 最高/ ,/ 幅度/ 约/ 为/ 41.2/ %/ ;/ 提升/ 幅度/ 最少/ 的/ 为/ 程序/ avrora/ ,/ 其/ 提升/ 幅度/ 约/ 为/ 17.1/ %/ ./ 测试/ 基准/ 程序/ 集/ 的/ 平均/ 提升/ 幅度/ 为/ 27.6/ %/ ,/ 表明/ 本文/ 的/ 方法/ kWP/ 在/ 发掘/ 程序/ 可行/ 路径/ 方面/ 有/ 较/ 高/ 的/ 精度/ 提升/ ./ 图/ 7/ 表示/ 因子/ k/ 的/ 取值/ 与/ 测试/ 基准/ 集/ 的/ 可行/ 路径/ 之间/ 的/ 关系/ :/ 随着/ k/ 取值/ 的/ 增加/ ,/ 所/ 能/ 生成/ 的/ 可行/ 路径/ 的/ 数量/ 也/ 在/ 不断/ 增加/ ./ 在/ 本文/ 方法/ 中/ k/ 的/ 取值/ 对/ 分析/ 的/ 精度/ 与/ 生成/ 的/ 可行/ 路径/ 数量/ 有/ 直接/ 的/ 影响/ ,/ 即/ 因子/ k/ 的/ 取值/ 可以/ 平衡/ 程序/ 的/ 分析/ 规模/ 以及/ 分析/ 的/ 精度/ ,/ 故/ 在/ 实验/ 过程/ 中/ ,/ 我们/ 主要/ 从/ 发掘/ 不/ 可行/ 路径/ 效率/ 的/ 角度/ 出发/ ,/ 在/ 设定/ 的/ 执行/ 时间/ 阈值/ 内来/ 分析/ k/ 的/ 取值/ ./ 另外/ 本文/ 方法/ 在/ 执行/ 过程/ 中/ ,/ 可能/ 存在/ 引入/ 新/ 的/ 不可/ 解/ 路径/ 条件/ 的/ 现象/ ,/ 故/ 本文/ 结合/ 测试/ 基准/ 集/ 的/ 实际/ 分析/ 效果/ ,/ 设定/ k/ 的/ 取值/ 一般/ 不/ 超过/ 20/ ./ 若/ k/ 的/ 取值/ 继续/ 增大/ ,/ 则/ 可能/ 导致/ 分析/ 时间/ 过长/ 而/ 超时/ 或者/ 符号执行/ 工具/ 和/ 求解/ 器/ 开销/ 过大而/ 内存/ 资源/ 耗尽/ ./ 从图/ 7/ 中/ 可以/ 看出/ 对于/ 有/ 的/ 测试/ 基准/ 程序/ ,/ 其/ 可行/ 路径/ 数量/ 在/ 因子/ k/ 的/ 某个/ 取值/ 区间/ 内/ 无/ 变化/ ,/ 其/ 原因/ 是/ 循环/ 结构/ 的/ 执行/ 次数/ 在/ 不断/ 增加/ ,/ 或者/ 求解/ 器/ 在/ 求解/ 过程/ 中/ 出现/ 了/ 不可/ 解/ 的/ 情况/ ./ 图/ 7/ 因子/ k/ 的/ 取值/ 对/ 可/ 执行/ 路径/ 数量/ 的/ 影响/ 6/ 相关/ 工作/ 对比/ 可信计算/ 是/ 信息安全/ 领域/ 的/ 重要/ 研究/ 方向/ ,/ TCG/ (/ TrustedComputingGroup/ )/ 对/ 可信/ 的/ 定义/ 是/ :/ 若/ 一个/ 实体/ 是/ 可信/ 的/ ,/ 那么/ 该/ 实体/ 在/ 实现/ 预定/ 目标/ Page10/ 过程/ 中/ ,/ 其/ 行为/ 也/ 是/ 符合/ 预期/ 的/ ./ 文献/ [/ 13/ ]/ 认为/ :/ 可信/ ≈/ 可靠/ +/ 安全/ ,/ 故/ 需要/ 对/ 软件/ 的/ 可信性/ 进行/ 验证/ ./ 目前/ ,/ 程序验证/ 过程/ 中/ 通常/ 使用/ 定理/ 证明/ 和/ 模型/ 检验/ 的/ 方法/ ,/ ESC/ // JAVA/ [/ 14/ ]/ 采用/ 定理/ 证明/ 的/ 方法/ 验证/ 函数/ 是否/ 满足/ 给定/ 的/ 前置条件/ 和/ 后置/ 条件/ ,/ 但/ 该/ 方法/ 需要/ 人工/ 地/ 在/ 程序/ 中/ 增加/ 注释/ 来/ 引导/ 其/ 分析/ 过程/ ./ 模型/ 检验/ 的/ 方法/ 可以/ 对/ 程序/ 属性/ 的/ 正确性/ 进行/ 证明/ ,/ SLAM/ [/ 15/ ]/ 采用/ 逐步/ 精化/ 的/ 方法/ 对/ 程序/ 待/ 验证/ 的/ 性质/ 进行/ 近似/ ,/ 然后/ 以/ 目标/ 制导/ 的/ 方式/ 进行/ 抽象/ 精化/ ;/ BLAST/ [/ 16/ ]/ 采用/ 惰性/ 抽象/ 和/ 基于/ 反例/ 的/ 抽象/ 求精/ 的/ 方法/ 对/ 程序/ 属性/ 进行/ 验证/ ,/ 但是/ 这些/ 方法/ 常常/ 遇到/ 状态/ 空间/ 爆炸/ 或者/ 由于/ 抽象/ 所/ 带来/ 的/ 分析/ 精度/ 较/ 低等/ 问题/ ./ 在/ 通过/ 验证/ 来/ 发现/ 软件缺陷/ 方面/ ,/ 文献/ [/ 17/ ]/ 从/ 程序/ 漏洞/ 溢出/ 的/ 角度/ 提出/ 一种/ 基于/ 有限/ 约束/ 满足/ 性/ 的/ 检测/ 方法/ ,/ 可/ 在/ 无/ 源代码/ 的/ 情况/ 下/ 直接/ 分析/ 可执行程序/ ./ Metal/ [/ 18/ ]/ 是/ 一个/ 采用/ 局部/ 数据流/ 分析/ 的/ 上下文/ 不/ 敏感/ 错误/ 检测工具/ ,/ 但/ 它/ 采用/ 的/ 分析方法/ 是/ 路径/ 不/ 敏感/ 的/ ,/ 故其/ 分析/ 精度/ 有限/ ./ PREFix/ [/ 19/ ]/ 依据/ CFG/ 图/ 采用/ 自/ 底向上/ 的/ 方法/ 来/ 构建/ 近似/ 的/ 过程/ 摘要/ (/ proceduresummary/ )/ ,/ 但是/ 它/ 不能/ 描述/ 函数/ 的/ 输入/ 域/ ,/ 故其/ 采用/ 保守/ 的/ 方式/ 来/ 预测/ 程序/ 的/ 行为/ ,/ 相比之下/ 本文/ 的/ 方法/ 由于/ 是/ 一种/ 基于/ 需求/ 驱动/ 的/ 路径/ 敏感/ 分析方法/ ,/ 其/ 分析/ 过程/ 有/ 较/ 强/ 的/ 针对性/ ./ PSE/ [/ 20/ ]/ 是/ 一款/ 使用/ 过程/ 间/ 后/ 向/ 符号分析/ 对/ 程序/ 的/ 缺陷/ 进行/ 验证/ 的/ 工具/ ,/ 但是/ 由于/ 该/ 工具/ 不能/ 获得/ 程序/ 所有/ 的/ 路径/ 条件/ ,/ 故常/ 需对/ 程序/ 的/ 堆栈/ 进行/ 摘要/ 操作/ ,/ 而/ 该/ 工具/ 并/ 没有/ 提出/ 相应/ 的/ 近似/ 分析方法/ ./ ESC/ // Java/ 也/ 是/ 一种/ 基于/ 最/ 弱/ 前置条件/ 的/ 分析方法/ ,/ 但是/ 它/ 采用/ 的/ 只是/ 过程/ 内/ 的/ 分析方法/ ,/ 依赖/ 用户/ 的/ 注释/ 来/ 推理/ 程序/ 中/ 的/ 调用/ 关系/ ./ DSD/ -/ Crasher/ [/ 21/ ]/ 通过/ 使用/ ESC/ // Java/ 生成/ 测试用例/ 作为/ 程序/ 反例/ ,/ 但是/ 该/ 工具/ 通过/ 符号分析/ 所/ 生成/ 的/ 最弱/ 前置条件/ 中/ 的/ 一个/ 子集/ 可能/ 会/ 被/ 其它/ 变量/ 消除/ ,/ 从而/ 导致/ 整个/ 最/ 弱/ 前置条件/ 无法/ 求解/ ./ 文献/ [/ 7/ ]/ 也/ 采用/ 最/ 弱/ 前置条件/ 的/ 方法/ 引导/ 符号执行/ 操作/ 来/ 对/ 程序/ 缺陷/ 进行/ 修复/ 和/ 验证/ ,/ 但是/ 没有/ 对/ 生成/ 的/ 最弱/ 前置条件/ 进行/ 化简/ 与/ 合并/ ./ 文献/ [/ 22/ ]/ 采用/ 基于/ 路径/ 的/ 最弱/ 前置条件/ 来/ 定位/ 并/ 纠正/ 函数/ 中/ 的/ 错误/ 语句/ ,/ 其/ 分析/ 过程/ 类似/ 本文/ 方法/ 中/ 的/ k/ =/ 0/ 的/ 情况/ ,/ 相比之下/ 本文/ 的/ 方法/ 可以/ 调整/ k/ 的/ 取值/ 来/ 扩展/ 分析/ 范围/ ,/ 具有/ 更好/ 的/ 灵活性/ ./ 7/ 结论/ 及/ 将来/ 工作/ 路径/ 可行性/ 是/ 验证/ 程序/ 安全/ 性质/ 中/ 的/ 主要/ 内容/ ,/ 但是/ 由于/ 在/ 验证/ 过程/ 中/ 容易/ 出现/ 状态/ 空间/ 爆炸/ 等/ 问题/ 而/ 生成/ 较/ 多/ 无用/ 的/ 路径/ ,/ 且/ 大量/ 的/ 路径/ 缺乏/ 针对性/ ./ 本文/ 在/ 文献/ [/ 23/ ]/ 的/ 工作/ 基础/ 上/ ,/ 提出/ 一种/ 改进/ 的/ 最弱/ 前置条件/ 与/ 符号执行/ 相结合/ 的/ 多路径/ 程序验证/ 方法/ ,/ 首先/ 对/ 程序/ 的/ 控制流/ 图/ 进行/ 改进/ ,/ 使得/ 路径/ 的/ 分析/ 不再/ 依赖于/ 程序/ 中/ 的/ 循环/ 变量/ ,/ 从而/ 每/ 一条/ 执行/ 路径/ 都/ 有/ 惟一/ 的/ 路径/ 编码/ ,/ 这样/ 就/ 可以/ 在/ 其/ 基础/ 上/ 使用/ 最/ 弱/ 前置条件/ 的/ 方法/ 生成/ 引导/ 信息/ 供/ 符号执行/ 生成/ 与/ 验证/ 性质/ 相关/ 的/ 路径/ 集合/ ./ 本文/ 方法/ 通过/ 分析/ 与/ 可行/ 路径/ 近邻/ 的/ 路径/ 集合/ 来/ 生成/ 程序/ 近似/ 的/ 有效/ 输入/ 域/ ,/ 从而/ 避免/ 对/ 所有/ 路径/ 的/ 最弱/ 前置条件/ 进行/ 计算/ ,/ 为/ 高效/ 地/ 分析程序/ 的/ 路径/ 可/ 满足/ 性/ 提供/ 了/ 一种/ 思路/ ./ 实验/ 结果表明/ 本文/ 的/ 方法/ 较/ 传统/ 的/ 符号执行/ 方法/ 能够/ 在/ 较/ 短时间/ 内/ 针对/ 路径/ 的/ 可/ 满足/ 性/ 问题/ 生成/ 更加/ 精简/ 而/ 高效/ 的/ 路径/ 集合/ ,/ 同时/ 在/ 分析/ 效率/ 上/ 有/ 较大/ 提高/ ./ 本文/ 的/ 方法/ 还/ 存在/ 需要/ 改进/ 的/ 地方/ ,/ 主要/ 体现/ 在/ 对/ 浮点运算/ ,/ 按/ 位操作/ 等/ 语句/ 的/ 语义/ 还/ 不能/ 较为/ 精确/ 地/ 进行/ 分析/ ,/ 此外/ 还/ 不能/ 处理/ 并发程序/ ,/ 在/ 以后/ 的/ 工作/ 中/ 可以/ 采用/ 诸如/ 线程/ 逃逸/ 的/ 方法/ 进行/ 研究/ ;/ 另外/ 的/ 一个/ 研究/ 方向/ 是/ 对/ 本文/ 的/ 方法/ 进行/ 扩展/ ,/ 建立/ 起/ 程序/ 的/ 功能属性/ 与非/ 功能属性/ 之间/ 的/ 关联/ 关系/ ,/ 通过/ 对/ 功能属性/ 的/ 分析/ 来/ 对/ 非/ 功能属性/ 进行/ 间接/ 地/ 验证/ ./ 致谢/ 感谢/ 美国/ 佐治亚/ 理工学院/ 计算机科学/ 系/ 的/ AlessandroOrso/ 教授/ 和/ 审稿/ 专家/ 对/ 本文/ 提出/ 的/ 修改/ 建议/ !/ 

