Page1/ 预测/ 状态/ 表示/ 模型/ 的/ 复位/ 算法/ 刘/ 云龙/ 吉/ 国力/ (/ 厦门大学/ 自动化系/ 福建厦门/ 361005/ )/ 摘要/ 预测/ 状态/ 表示/ (/ PredictiveStateRepresentations/ ,/ PSRs/ )/ 是/ 用于/ 解决/ 局部/ 可/ 观测/ 问题/ 的/ 有效/ 方法/ ./ 然而/ ,/ 现实/ 环境/ 中/ ,/ 通过/ 样本/ 学习/ 得到/ 的/ PSR/ 模型/ 不/ 可能/ 完全/ 准确/ ./ 随着/ 计算/ 步数/ 的/ 增多/ ,/ 利用/ PSR/ 模型/ 计算/ 得到/ 的/ 预测/ 向量/ 有/ 可能/ 越来越/ 偏离/ 其/ 真实/ 值/ ,/ 进而/ 导致/ PSR/ 模型/ 的/ 预测/ 精度/ 越来越低/ ./ 文中/ 提出/ 了/ 一种/ PSR/ 模型/ 的/ 复位/ 算法/ ./ 通过/ 使用/ 判别分析/ 方法/ 确定/ 系统/ 所处/ 的/ PSR/ 状态/ ,/ 文中/ 所提/ 算法/ 可/ 对/ 利用/ 计算/ 获取/ 的/ 预测/ 向量/ 复位/ ,/ 从而/ 提高/ PSR/ 模型/ 的/ 准确性/ ./ 实验/ 结果表明/ ,/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 在/ 预测/ 精度/ 上/ 明显/ 优于/ 未/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ ,/ 验证/ 了/ 所/ 提/ 算法/ 的/ 有效性/ ./ 关键词/ 预测/ 状态/ 表示/ 模型/ ;/ 预测/ 精度/ ;/ 复位/ ;/ 判别分析/ ;/ 预测/ 状态/ 表示/ 模型/ 的/ 准确性/ 1/ 引言/ 对/ 动态/ 系统/ 建模/ ,/ 是/ 科学/ 和/ 工程/ 中/ 普遍存在/ 的/ 一个/ 问题/ ,/ 在/ 很多/ 方面/ ,/ 如/ 社会/ 经济/ 系统/ 、/ 环境/ 生态系统/ 、/ 能源/ 系统/ 、/ 生物医学/ 系统/ 、/ 教育/ 训练/ 系统/ 等/ ,/ 都/ 有/ 很/ 广泛/ 的/ 应用/ [/ 1/ ]/ ./ 通过/ 对系统/ 建模/ ,/ 可以/ 预测/ 和/ 控制/ 该/ 系统/ ./ 例如/ ,/ 一个/ 投资者/ 可以/ 利用/ 一个/ 公司/ 以往/ Page2/ 的/ 股价/ ,/ 对/ 该/ 公司/ 的/ 股价/ 建立/ 一个/ 模型/ ,/ 从而/ 预测/ 该/ 公司/ 未来/ 股价/ 的/ 走势/ ,/ 决定/ 未来/ 投资/ 的/ 方向/ [/ 2/ ]/ ./ 具体/ 到/ 人工智能/ 领域/ ,/ 对于/ 一个/ 随机/ 的/ 、/ 局部/ 可/ 观测/ 的/ 环境/ ,/ 智能/ 体/ 由于/ 受到/ 其/ 感知/ 能力/ 的/ 限制/ ,/ 有/ 可能/ 会/ 感知/ 不到/ 所/ 处/ 环境/ 的/ 某些/ 重要/ 特征/ ,/ 同时/ ,/ 智能/ 体/ 采取/ 的/ 动作/ 也/ 往往/ 得不到/ 预期/ 的/ 效果/ [/ 3/ ]/ ./ 在/ 这种/ 局部/ 可/ 观测/ 、/ 随机/ 的/ 系统/ 中/ 如何/ 获取/ 智能/ 体/ 的/ 最优/ 策略/ —/ —/ —/ 即/ 不确定性/ 环境/ 下/ 的/ 规划/ 问题/ ,/ 是/ 人工智能/ 领域/ 研究/ 的/ 一个/ 重要/ 问题/ [/ 4/ ]/ ./ 解决/ 这种/ 问题/ 的/ 常规/ 途径/ 是/ 首先/ 对系统/ 建模/ ,/ 然后/ 根据/ 得到/ 的/ 系统/ 模型/ 对/ 问题/ 进行/ 求解/ ./ 局部/ 可/ 观测/ 马尔可夫/ 决策/ 过程/ (/ PartiallyOb/ -/ servableMarkovDecisionProcesses/ ,/ POMDPs/ )/ 为/ 解决/ 这种/ 不确定性/ 的/ 规划/ 问题/ 提供/ 了/ 丰富/ 的/ 数学/ 框架/ [/ 4/ ]/ ./ 但/ 众所周知/ ,/ POMDP/ 模型/ 的/ 建立/ ,/ 依赖于/ 局部/ 可/ 观测/ 的/ 名义/ 状态/ (/ nominalstate/ )/ ,/ 因此/ 学习/ 系统/ 的/ POMDP/ 模型/ 往往/ 很/ 困难/ ,/ 并且/ 需要/ 很多/ 先验/ 知识/ ./ 预测/ 状态/ 表示法/ (/ PredictiveStateRepresen/ -/ tations/ ,/ PSRs/ )/ 是/ 近年来/ 提出/ 的/ 一种/ 对/ 受控/ 动态/ 系统/ 建模/ 的/ 新/ 方法/ [/ 5/ ]/ ./ 和/ 基于/ 隐/ 状态/ (/ hidden/ -/ state/ -/ based/ )/ 的/ POMDP/ 模型/ 不同/ ,/ PSRs/ 完全/ 根据/ 可/ 观测/ 的/ 量/ 来/ 表现/ 系统/ 的/ 状态/ ./ 因此/ ,/ 通过/ 观测/ 数据/ ,/ 学习/ 动态/ 系统/ 的/ PSR/ 模型/ 比/ 学习/ 其/ POMDP/ 模型/ 应该/ 更/ 容易/ ,/ 并且/ 不/ 容易/ 陷于/ 局部/ 极小/ 点/ ./ 同时/ ,/ 相比/ 另外/ 一种/ 常用/ 的/ 动态/ 系统/ 模型/ —/ —/ —/ 基于/ 经历/ 的/ 模型/ (/ history/ -/ basedmodel/ )/ ,/ PSR/ 模型/ 有/ 更/ 强/ 的/ 表示/ 能力/ ,/ 有/ 更/ 多/ 的/ 应用领域/ [/ 1/ ]/ ./ PSRs/ 用/ 系统/ 中/ 可/ 执行/ 的/ 特定/ 检验/ (/ tests/ )/ 或/ 实验/ (/ experiments/ )/ 所/ 发生/ 的/ 概率/ ,/ 组成/ 向量/ ,/ 称为/ 预测/ 向量/ ,/ 表示/ 系统/ 所/ 处/ 状态/ ./ 如果/ 存在/ 一个/ 检验/ ,/ 它/ 在/ 两个/ 经历/ (/ history/ )/ 下/ 发生/ 的/ 概率/ 不同/ ,/ 则/ 表示/ 两个/ 经历/ 下/ 系统/ 的/ PSR/ 状态/ 不同/ ;/ 如果/ 对于/ 所有/ 可能/ 发生/ 的/ 检验/ ,/ 它们/ 在/ 两个/ 经历/ 下/ 发生/ 的/ 概率/ 均/ 相同/ ,/ 则/ 表示/ 两个/ 经历/ 下/ 系统/ 的/ PSR/ 状态/ 相同/ ./ 对/ 一个/ 受控系统/ ,/ 一个/ 经历/ 指/ 的/ 是从/ 初始/ 时刻/ 开始/ 的/ 一个/ 动作/ -/ 观测/ 对/ 序列/ ,/ 表示/ 到/ 目前为止/ ,/ 系统/ 所/ 经历/ 过/ 的/ 动作/ 、/ 观测/ ./ 同/ 经历/ 一样/ ,/ 一个/ 检验/ 指/ 的/ 也/ 是/ 一个/ 动作/ -/ 观测/ 对/ 序列/ ,/ 但/ 没有/ 从/ 初始/ 时刻/ 开始/ 的/ 限定/ ,/ 表示/ 从/ 当前/ 时刻/ 起/ ,/ 系统/ 将来/ 可能/ 经历/ 的/ 动作/ 、/ 观测/ ./ 已经/ 证明/ ,/ PSR/ 模型/ 的/ 状态/ 表示/ ,/ 不必/ 用到/ 所有/ 检验/ 发生/ 的/ 概率/ ,/ 只用/ 检验/ 核/ (/ core/ -/ tests/ )/ 中/ 所有/ 检验/ 发生/ 的/ 概率/ 即可/ [/ 5/ ]/ ./ 详细/ 介绍/ 见/ 第/ 2/ 节/ ./ 针对/ PSRs/ 的/ 主要/ 研究/ 内容/ 是/ 发现/ 和/ 学习/ 系统/ 的/ PSR/ 模型/ [/ 6/ -/ 9/ ]/ ,/ 并/ 根据/ PSR/ 模型/ 选取/ 动作/ ,/ 获取/ 智能/ 体/ 的/ 最优控制/ 策略/ [/ 10/ -/ 11/ ]/ ./ 在/ 现实/ 环境/ 中/ ,/ 学习/ 得到/ 的/ PSR/ 模型/ 不/ 可能/ 完全/ 准确/ ,/ 对/ 同一/ PSR/ 状态/ ,/ 在/ 不同/ 时刻/ ,/ 通过/ PSR/ 模型/ 计算/ 得到/ 的/ 用于/ 描述/ 该/ PSR/ 状态/ 的/ 预测/ 向量/ 也/ 往往/ 不同/ ,/ 仅凭/ 预测/ 向量/ 无法/ 确定/ 系统/ 所处/ 的/ PSR/ 状态/ ,/ 并且/ 在/ 利用/ PSR/ 模型/ 计算/ 任意/ 经历/ 的/ 预测/ 向量/ 时/ ,/ 随着/ 计算/ 步数/ 的/ 增多/ ,/ 得到/ 的/ 预测/ 向量/ 有/ 可能/ 越来越/ 偏离/ 其/ 真实/ 值/ ,/ 进而/ 导致/ PSR/ 模型/ 的/ 预测/ 精度/ 越来越低/ ,/ 而/ 模型/ 很/ 一个/ 作用/ 在于/ 其/ 能够/ 给予/ 我们/ 关于/ 某一/ 事件/ 的/ 预测/ ./ 本文/ 的/ 工作/ 是/ 首先/ 考虑/ 如何/ 利用/ 判别分析/ 方法/ ,/ 确定/ 每一/ 时刻/ 系统/ 所处/ 的/ PSR/ 状态/ ;/ 然后/ ,/ 在/ 每/ 一时间/ 步/ ,/ 以/ 系统/ 所处/ PSR/ 状态/ 的/ 预测/ 向量/ 对/ 当前/ PSR/ 模型/ 复位/ ;/ 最后/ ,/ 利用/ 3/ 个/ 标准/ 的/ POMDP/ 测试/ 系统/ ,/ 对/ 所/ 提/ 算法/ 的/ 效果/ 进行/ 验证/ ./ 仿真/ 结果表明/ ,/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ ,/ 在/ 预测/ 精度/ 上/ 明显/ 优于/ 未/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ ./ 本文/ 假定/ 所/ 研究/ 的/ 系统/ 是/ 离散/ 的/ 、/ 观测/ 值/ 有限/ 、/ 可用/ 有限/ POMDP/ 及/ 有限/ 阶/ 的/ 马尔可夫/ 模型表示/ ./ 2PSRs/ 简介/ 上面/ 已经/ 提到/ ,/ PSR/ 模型/ 采用/ 检验/ 核中/ 所有/ 检验/ 发生/ 概率/ 所/ 组成/ 的/ 向量/ 作为/ 其/ 状态/ 表示/ ./ 假定/ 当前/ 系统/ 的/ 观测/ 值/ 集合/ 为/ O/ =/ {/ o1/ ,/ o2/ ,/ …/ ,/ o/ |/ O/ |/ }/ ,/ 动作/ 集合/ 为/ A/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ a/ |/ A/ |/ }/ ,/ 则/ 长度/ 为/ n/ 的/ 经历/ h/ =/ {/ a1o1a2o2/ …/ anon/ }/ 发生/ 的/ 概率/ 是从/ 初始/ 时刻/ 开始/ ,/ 采取/ 动作/ 序列/ a1a2/ …/ an/ 后/ ,/ 观测/ 值/ 序列/ o1o2/ …/ on/ 出现/ 的/ 概率/ ,/ 即/ p/ (/ h/ )/ =/ prob/ (/ o1/ =/ o1/ ,/ o2/ =/ o2/ ,/ …/ ,/ on/ =/ on/ |/ a1/ =/ a1/ ,/ a2/ =/ a2/ ,/ …/ ,/ an/ =/ an/ )/ ./ 同样/ ,/ 长度/ 为/ m/ 的/ 检验/ t/ =/ {/ a1o1a2o2/ …/ amom/ }/ 在/ 经历/ h/ =/ {/ a1o1a2o2/ …/ anon/ }/ 下/ 发生/ 的/ 概率/ 为/ p/ (/ t/ |/ h/ )/ =/ p/ (/ ht/ )/ // p/ (/ h/ )/ =/ prob/ (/ on/ +/ 1/ =/ o1/ ,/ on/ +/ 2/ =/ o2/ ,/ …/ ,/ on/ +/ m/ =/ om/ |/ h/ ,/ an/ +/ 1/ =/ a1/ ,/ an/ +/ 2/ =/ a2/ ,/ …/ ,/ an/ +/ m/ =/ am/ )/ ,/ 其中/ ai/ 表示/ 在/ i/ 时刻/ 采取/ 的/ 动作/ ;/ oi/ 表示/ 在/ i/ 时刻/ 执行/ 动作/ ai/ 后/ 在/ 该/ 时刻/ 出现/ 的/ 观测/ 值/ ./ 给定/ 一系列/ 检验/ 的/ 集合/ :/ Q/ =/ {/ q1/ ,/ …/ ,/ qk/ }/ ,/ 如果/ 由/ 这些/ 检验/ 的/ 预测值/ 所/ 组成/ 的/ 向量/ 狆/ (/ Q/ |/ h/ )/ =/ (/ p/ (/ q1/ |/ h/ )/ ,/ p/ (/ q2/ |/ h/ )/ ,/ …/ ,/ p/ (/ qk/ |/ h/ )/ )/ T/ 是/ 所有/ 经历/ 的/ 充分/ 统计/ 量/ ,/ 即/ 狆/ (/ Q/ |/ h/ )/ 包含/ 了/ 经历/ h/ 下/ 所有/ 和/ 未来/ 预测/ 相关/ 的/ 信息/ ,/ 也/ 就是/ 存在/ 函数/ ft/ ,/ 对于/ 所有/ 经历/ h/ ,/ 使得/ 任意/ 检验/ t/ 发生/ 的/ 概率/ 为/ p/ (/ t/ |/ h/ )/ =/ ft/ (/ 狆/ (/ Q/ |/ h/ )/ )/ ,/ 则/ 认为/ 检验/ 集合/ Q/ 构成/ 一个/ PSRs/ ./ 其中/ p/ (/ qi/ |/ h/ )/ 是/ 在/ 经历/ h/ 下/ 检验/ qi/ 发生/ 的/ 概率/ ./ Q/ 被/ 称为/ 检验/ 核/ ,/ 狆/ (/ Q/ |/ h/ )/ 被/ 称为/ 预测/ 向量/ ,/ 以/ 狆/ (/ Q/ |/ h/ )/ 作为/ PSRs/ 的/ 状态/ 表示/ ./ 同时/ ,/ 如果/ ft/ 是/ 线性/ 函数/ ,/ 则/ 称/ Page3/ 该/ PSRs/ 是/ 线性/ PSRs/ ;/ 如果/ ft/ 是/ 非线性/ 函数/ ,/ 则/ 称/ 该/ PSRs/ 是/ 非线性/ PSRs/ ./ 本文/ 针对/ 的/ 是/ 线性/ PSRs/ ./ 在/ 数学/ 上/ ,/ 可用/ 系统/ 动态/ 矩阵/ 犣/ 描述/ 受控/ 和/ 非/ 受控系统/ ,/ 而/ PSR/ 模型/ 可以/ 直接/ 从/ 系统/ 动态/ 矩阵/ 犣/ 推导/ 出来/ [/ 1/ ]/ ./ 如图/ 1/ 所示/ ,/ 犣/ 的/ 行/ 对应/ 所有/ 可能/ 的/ 经历/ (/ 过去/ )/ ,/ 其中/ 第/ 1/ 行/ 对应/ 空/ 经历/ (/ nullhistory/ )/ / 即/ 初始/ 经历/ ,/ 列/ 对应/ 所有/ 可能/ 的/ 检验/ (/ 未来/ )/ ,/ 犣/ 的/ 元素/ 表示/ 在/ 给定/ 经历/ 情况/ 下/ ,/ 检验/ 发生/ 的/ 概率/ ./ 如果/ 系统/ 的/ 系统/ 动态/ 矩阵/ 的/ 秩为/ k/ ,/ 则/ 矩阵/ 中/ 存在/ k/ 个/ 线性/ 无关/ 的/ 检验/ 列/ ,/ 满足/ 检验/ 核/ 的/ 定义/ ,/ 可/ 将/ 其/ 作为/ 系统/ 的/ 检验/ 核/ Q/ ./ 同样/ ,/ 将/ 矩阵/ 犣/ 的/ 行向量/ 中/ 任意/ 一个/ 最大/ 线性/ 无关/ 组所/ 对应/ 的/ 经历/ 的/ 集合/ 称为/ 经历/ 核/ (/ core/ -/ histories/ )/ ./ 如果/ 已/ 获得/ 检验/ 核/ ,/ 则/ 对/ 每/ 一个/ 检验/ t/ ,/ 存在/ 长度/ 为/ k/ 的/ 权/ 向量/ 犿/ t/ ,/ 使得/ 相应/ 于/ 检验/ t/ 的/ 矩阵/ 的/ 列/ p/ (/ t/ |/ h/ )/ ,/ 可/ 表示/ 为/ p/ (/ t/ |/ h/ )/ =/ 狆/ (/ Q/ |/ h/ )/ T/ 犿/ t/ ./ 该式/ 表明/ ,/ 在/ 得到/ 经历/ h/ 的/ 预测/ 向量/ 狆/ (/ Q/ |/ h/ )/ 后/ ,/ 如/ 采取/ 任意/ 动作/ a/ ∈/ A/ ,/ 得到/ 任意/ 观测/ 值/ o/ ∈/ O/ ,/ 则/ 其/ 对应/ 的/ 预测/ 向量/ ,/ 即/ 当前/ 时刻/ 的/ 状态/ 表示/ 可/ 通过/ 式/ (/ 1/ )/ 进行/ 计算/ 或/ 更新/ ./ 即/ 对/ / qi/ ∈/ Q/ [/ 5/ ]/ :/ p/ (/ qi/ |/ hao/ )/ =/ p/ (/ aoqi/ |/ h/ )/ 其中/ 犿/ aoqi/ 是/ 检验/ aoqi/ 的/ 权/ 向量/ ,/ 犿/ ao/ 是/ 检验/ ao/ 的/ 权/ 向量/ ./ 所以/ 经历/ hao/ 的/ 预测/ 向量/ 为/ [/ 5/ ]/ 其中/ 犕/ ao/ 是/ 一个/ k/ ×/ k/ 矩阵/ ,/ 第/ i/ 列/ 对应/ 的/ 是/ 犿/ aoqi/ ./ 从式/ (/ 2/ )/ 可知/ ,/ 在/ 得到/ PSR/ 模型/ 参数/ 犕/ ao/ 、/ 犿/ ao/ 和/ 空/ 经历/ / 的/ 预测/ 向量/ 狆/ (/ Q/ |/ / )/ 后/ ,/ 通过/ 计算/ 可/ 得到/ 任意/ 经历/ 的/ 预测/ 向量/ ,/ 即可/ 得知/ 任意/ 经历/ 下/ 系统/ 所处/ 的/ 状态/ ./ 3PSR/ 模型/ 的/ 复位/ 算法/ 3.1/ 预备/ 知识/ 在/ 详细描述/ PSR/ 模型/ 的/ 复位/ 算法/ 之前/ ,/ 我们/ 给出/ 与/ 所/ 提/ 算法/ 相关/ 的/ 定理/ 以及/ 状态/ 经历/ 的/ 概念/ ./ 果/ 犣/ 中/ 的/ 任意/ 两行/ 不/ 相等/ ,/ 则/ 它们/ 线性/ 无关/ ./ 定理/ 1/ ./ 给定/ 一个/ 精确/ 的/ 系统/ 动态/ 矩阵/ 犣/ ,/ 如/ 证明/ ./ 利用/ 反证法/ 证之/ ./ 假定/ h1/ 、/ h2/ 是/ 犣/ 中/ 任意/ 不/ 相等/ 的/ 两行/ 所/ 对应/ 的/ 经历/ ./ 如果/ h1/ 对应/ 的/ 行向量/ 和/ h2/ 对应/ 的/ 行向量/ 线性相关/ ,/ 即/ 存在/ 常数/ b/ ≠/ 1/ ,/ 对于/ 任意/ 检验/ t/ ,/ 均/ 有/ p/ (/ t/ |/ h1/ )/ =/ b/ ×/ p/ (/ t/ |/ h2/ )/ ./ 然而/ ,/ 根据/ / k/ / a/ -/ ∈/ Ak/ ,/ ∑/ t/ ∈/ T/ (/ a/ -/ )/ p/ (/ t/ |/ h/ )/ =/ 1/ (/ 注/ :/ T/ (/ a/ -/ )/ 表示/ 所有/ 动作/ 序列/ 为/ a/ -/ 的/ 检验/ 集合/ ,/ Ak/ 表示/ 长度/ 为/ k/ 的/ 所有/ 动作/ 的/ 集合/ ,/ h/ 为/ 所有/ 可能/ 发生/ 的/ 经历/ )/ [/ 1/ ]/ ,/ 可/ 得/ ∑/ t/ ∈/ T/ (/ a/ -/ )/ p/ (/ t/ |/ h1/ )/ =/ ∑/ t/ ∈/ T/ (/ a/ -/ )/ b/ ×/ p/ (/ t/ |/ h2/ )/ 由于/ ∑/ t/ ∈/ T/ (/ a/ -/ )/ p/ (/ t/ |/ h1/ )/ =/ 1/ ,/ 得/ b/ =/ 1/ ,/ 与/ 前面/ b/ ≠/ 1/ 相/ 矛盾/ ./ 故/ 如果/ 犣/ 中/ 的/ 任意/ 两行/ 不/ 相等/ ,/ 则/ 它们/ 线性/ 无关/ ./ 定义/ 1/ ./ 系统/ 动态/ 矩阵/ 犣/ 中/ 所有/ 两/ 两/ 线性/ 无关/ 的/ 行向量/ ,/ 其/ 对应/ 的/ 经历/ 所/ 组成/ 的/ 集合/ 称为/ 犣/ 的/ 状态/ 经历/ 集合/ ,/ 集合/ 中/ 的/ 元素/ 称为/ 状态/ 经历/ ./ 根据/ 状态/ 经历/ 的/ 定义/ 和/ 定理/ 1/ 可知/ ,/ 状态/ 经历/ 集合/ 对应/ 了/ 系统/ 动态/ 矩阵/ 犣/ 中/ 所有/ 可能/ 发生/ 的/ 不同/ 的/ 行向量/ ,/ 状态/ 经历/ 可以/ 用来/ 描述/ 系统/ 所有/ 实际/ 存在/ 的/ PSR/ 状态/ ./ 并且/ 状态/ 经历/ 集合/ 中/ 状态/ 经历/ 和/ 系统/ 实际/ 存在/ 的/ PSR/ 状态/ 是/ 一一对应/ 的/ ./ 现实/ 环境/ 下/ ,/ 系统/ 的/ PSR/ 模型/ 往往/ 是/ 不/ 准确/ 的/ ,/ 导致/ 无法/ 根据/ 预测/ 向量/ 确定/ 某一时间/ 步/ 系统/ 所处/ 的/ PSR/ 状态/ ./ 结合/ 状态/ 经历/ 的/ 概念/ 及/ 性质/ ,/ 下面/ 讨论/ 了/ 如何/ 利用/ 判别分析/ 方法/ [/ 12/ ]/ 确定/ 系统/ 在/ 任意/ 时刻/ 的/ PSR/ 状态/ ./ 进而/ ,/ 对/ 通过/ 数据/ 学习/ 得到/ 的/ PSR/ 模型/ ,/ 讨论/ 如何/ 复位/ ./ 3.2/ PSR/ 模型/ 的/ 复位/ 现实/ 环境/ 下/ ,/ 获取/ 系统/ 的/ PSR/ 模型/ ,/ 首先/ 需要/ 估计/ 系统/ 动态/ 矩阵/ 犣/ 的/ 元素/ p/ (/ t/ |/ h/ )/ ./ 当前/ 大部分/ 发现/ 和/ 学习/ 系统/ 的/ PSR/ 模型/ 的/ 算法/ ,/ 都/ 利用/ 蒙特卡罗/ 方法/ 估计/ p/ (/ t/ |/ h/ )/ [/ 6/ -/ 8/ ]/ ./ 当/ p/ (/ t/ |/ h/ )/ 是/ 通过/ 蒙特卡罗/ 方法/ 估计/ 得到/ 的/ 时/ ,/ 可以/ 认为/ 系统/ 动态/ 矩阵/ 犣/ 中/ ,/ 对应/ 同一个/ PSR/ 状态/ 的/ 所有/ 行/ 构成/ 了/ 一个/ 正态/ 总体/ ./ 如果/ 当前/ 系统/ 有/ k/ 个/ 实际/ 存在/ PSR/ 状态/ ,/ 则/ 存在/ k/ 个/ 总体/ ./ 每个/ 总体/ ,/ 包含/ 了/ 对应/ 同一个/ PSR/ 状态/ 的/ 所有/ 行向量/ ./ 如果/ 已知/ 每个/ 总体/ 的/ 均值/ 向量/ 和/ 协方差/ 阵/ ,/ 那么/ ,/ 用/ 判别分析/ 方法/ ,/ 就/ 可/ 判断/ 一个/ 新/ 出现/ 的/ 预测/ 向量/ ,/ 属于/ 哪/ 一个/ 总体/ ,/ 即/ 对应/ 哪/ 一个/ PSR/ 状态/ ./ Page4/ 在/ 每个/ 总体/ 的/ 均值/ 向量/ 狌/ (/ i/ )/ 和/ 协方差/ 阵/ Σ/ (/ i/ )/ 未知/ 的/ 情况/ 下/ ,/ 要/ 判断/ 一个/ 预测/ 向量/ 对应/ 哪/ 一个/ PSR/ 状态/ ,/ 则/ 需要/ 通过/ 样本/ ,/ 估计/ 每个/ 总体/ 的/ 均值/ 向量/ 和/ 协方差/ 阵/ ./ 用于/ 估计/ 每个/ 总体/ 的/ 均值/ 向量/ 和/ 协方差/ 阵/ 的/ 样本/ ,/ 可/ 在/ 获取/ 系统/ 的/ PSR/ 模型/ 的/ 过程/ 中/ 得到/ ①/ ./ 判断/ 了/ 一个/ 新/ 的/ 预测/ 向量/ 所/ 对应/ 的/ PSR/ 状态/ 后/ ,/ 即可/ 对系统/ 的/ PSR/ 模型/ 复位/ ./ 下面/ 讨论/ 了/ 算法/ 的/ 具体步骤/ ./ PSR/ 模型/ 的/ 复位/ 算法/ 的/ 具体步骤/ 如下/ :/ 1/ ./ 在/ 获取/ 系统/ 的/ PSR/ 模型/ 的/ 过程/ 中/ ,/ 可以/ 得到/ 一组/ 不同/ 经历/ 下/ 的/ 预测/ 向量/ ,/ 这些/ 预测/ 向量/ 都/ 是/ 通过/ 蒙特卡罗/ 方法/ 估计/ 得到/ 的/ ./ 将/ 这些/ 预测/ 向量/ 按照/ 以下/ 原则/ 划分/ 为/ 多个/ 子/ 矩阵/ :/ 同一个/ 子/ 矩阵/ 中/ 的/ 预测/ 向量/ 两/ 两/ 线性相关/ ,/ 即该/ 矩阵/ 的/ 秩为/ 1/ ;/ 不同/ 子/ 矩阵/ 的/ 预测/ 向量/ 线性/ 无关/ (/ 由于/ 通过/ 估计/ 得到/ 的/ 犣/ 的/ 子/ 矩阵的元/ 素/ 存在/ 噪声/ ,/ 本文/ 采用/ 计算/ 元素/ 有/ 噪声/ 的/ 矩阵/ 的/ 秩/ 的/ 方法/ 来/ 计算/ 矩阵/ 的/ 秩/ [/ 6/ ]/ )/ ./ 2/ ./ 如上所述/ ,/ 如果/ 两个/ 向量/ 线性/ 无关/ ,/ 则/ 它们/ 对应/ 不同/ 的/ PSR/ 状态/ ;/ 如果/ 两个/ 向量/ 线性相关/ ,/ 则/ 它们/ 对应/ 同一个/ PSR/ 状态/ ./ 因此/ ,/ 一个/ 子/ 矩阵/ 中/ 所有/ 的/ 预测/ 向量/ 对应/ 同一个/ PSR/ 状态/ ./ 可以/ 认为/ 该子/ 矩阵/ 中/ 的/ 所有/ 预测/ 向量/ 是/ 其/ 对应/ 总体/ 的/ 一个/ 样本/ ./ 如果/ 有/ N/ 个子/ 矩阵/ ,/ 则/ 得到/ N/ 个/ 取自/ 不同/ 总体/ 的/ 样本/ ./ 3/ ./ 通过/ 样本/ i/ 估计/ 得到/ 总体/ i/ 的/ 均值/ 向量/ 狌/ (/ i/ )/ 和/ 协方差/ 阵/ Σ/ (/ i/ )/ (/ i/ =/ 1/ ,/ …/ ,/ N/ )/ ./ 4/ ./ 对于/ 每个/ 样本/ 中/ 的/ 所有/ 经历/ ,/ 为了/ 保留/ 初始状态/ 的/ 预测/ 向量/ ./ 如果/ 存在/ 空/ 经历/ ,/ 则/ 将/ 空/ 经历/ 标记/ 为/ 状态/ 经历/ ;/ 否则/ ,/ 将/ 发生/ 次数/ 最多/ 的/ 经历/ 标记/ 为/ 状态/ 经历/ ./ 5/ ./ 如果/ 已知/ 一个/ 经历/ 的/ 预测/ 向量/ ,/ 则/ 其/ 对应/ 的/ PSR/ 状态/ 可/ 通过/ 判别分析/ 方法/ 获得/ ./ 采用/ 距离/ 判别/ 法/ 确定/ 系统/ 的/ PSR/ 状态/ (/ 当然/ 也/ 可用/ 其它/ 的/ 判别分析/ 方法/ 确定/ 系统/ 的/ PSR/ 状态/ ,/ 在/ 这里/ 不再/ 详述/ )/ ./ 假定/ 当前/ 经历/ 为/ h/ ,/ 在/ 采取/ 动作/ a/ ,/ 得到/ 观测/ 值/ o/ 后/ ,/ 则/ 系统/ 所处/ 的/ PSR/ 状态/ 为/ 其中/ ,/ i/ =/ 1/ ,/ …/ ,/ N/ ./ 6/ ./ 将/ 状态/ 经历/ 的/ 预测/ 向量/ 作为/ 其/ 对应/ 的/ PSR/ 状态/ 的/ 预测/ 向量/ ./ 在/ 每/ 一时间/ 步下/ ,/ 确定/ 系统/ 所处/ 的/ PSR/ 状态/ 后/ ,/ 以/ 当前/ PSR/ 状态/ 的/ 预测/ 向量/ ,/ 代替/ 通过/ PSR/ 模型/ 计算/ 得到/ 的/ 预测/ 向量/ ,/ 即/ 对/ PSR/ 模型/ 复位/ ./ 现实/ 环境/ 下/ ,/ 通过/ 数据/ 学习/ 得到/ 的/ PSR/ 模型/ 不/ 可能/ 完全/ 准确/ ./ 因此/ ,/ 几乎/ 不/ 可能/ 得到/ 某一/ PSR/ 状态/ 的/ 精确/ 预测/ 向量/ ./ 但/ 根据/ 状态/ 经历/ 的/ 获取/ 方法/ ,/ 可以/ 认为/ 状态/ 经历/ 的/ 预测/ 向量/ 最/ 接近/ 其/ 对应/ 的/ PSR/ 状态/ 的/ 预测/ 向量/ 的/ 真实/ 值/ ,/ 同时/ 由于/ 状态/ 经历/ 和/ PSR/ 状态/ 一一对应/ ,/ 因此/ 可/ 将/ 状态/ 经历/ 的/ 预测/ 向量/ 作为/ 其/ 对应/ 的/ PSR/ 状态/ 的/ 预测/ 向量/ ./ 4/ 实验/ 将/ 本文/ 所提/ 算法/ 应用/ 于/ 一些/ 标准/ 的/ POMDP/ 环境/ ②/ ./ 针对/ 每个/ 环境/ ,/ 智能/ 体/ 采取/ 随机/ 策略/ 得到/ 一/ 训练/ 数据/ 后/ ,/ 得到/ 一组/ 不同/ 经历/ 下/ 的/ 预测/ 向量/ 、/ 当前/ 系统/ 的/ PSR/ 模型/ 、/ 状态/ 经历/ 的/ 集合/ 、/ 状态/ 经历/ 对应/ 的/ 预测/ 向量/ 的/ 集合/ 即/ PSR/ 状态/ 对应/ 的/ 预测/ 向量/ 的/ 集合/ 以及/ 每/ 一个/ PSR/ 状态/ 对应/ 总体/ 的/ 均值/ 向量/ 和/ 协方差/ 阵/ ./ 然后/ 采用/ 随机/ 策略/ 产生/ 一/ 测试数据/ ,/ 并/ 采用/ 一种/ 标准化/ 的/ 指标/ 衡量/ PSR/ 模型/ 的/ 准确性/ ,/ 即/ 在/ 采取/ 某一/ 动作/ 后/ ,/ 首先/ 根据/ 得到/ 的/ PSR/ 模型/ 计算/ 所有/ 观测/ 值/ 出现/ 的/ 概率/ ,/ 然后/ 根据/ 其/ 准确/ 的/ POM/ -/ DP/ 模型/ 计算/ 实际上/ 所有/ 观测/ 值/ 出现/ 的/ 概率/ ,/ 通过/ 两者之间/ 的/ 平方差/ 判断/ PSR/ 模型/ 的/ 准确性/ ,/ 具体地说/ 是/ 通过/ 式/ (/ 4/ )/ 来/ 判断/ [/ 13/ ]/ :/ L/ ∑/ L1/ 其中/ ,/ L/ 表示/ 的/ 是/ 产生/ 的/ 测试数据/ 的/ 长度/ ,/ 在/ 本文/ 中/ L/ =/ 10000/ ./ p/ (/ o/ |/ ht/ ,/ at/ )/ 是/ 在/ 经历/ ht/ 下/ 采取/ 动作/ at/ 产生/ 观测/ 值/ o/ 的/ 真实/ 概率/ ,/ p/ ^/ (/ o/ |/ ht/ ,/ at/ )/ 是/ 通过/ PSR/ 模型/ 计算/ 得到/ 在/ 经历/ ht/ 下/ 采取/ 动作/ at/ 产生/ 观测/ 值/ o/ 的/ 概率/ ,/ 即/ p/ ^/ (/ o/ |/ ht/ ,/ at/ )/ =/ 狆/ (/ Q/ |/ ht/ )/ 犿/ ato/ ./ 其中/ ,/ 针对/ 本文/ 算法/ ,/ 狆/ (/ Q/ |/ ht/ )/ 是/ 经过/ 复位/ 后/ 的/ 预测/ 向量/ ,/ 即/ 首先/ 根据/ 学习/ 得到/ 的/ PSR/ 模型/ 计算/ ht/ 对应/ 的/ 预测/ 向量/ ,/ 然后/ 判断/ 经历/ ht/ 对应/ 的/ PSR/ 状态/ s/ ,/ 最后/ 以/ 狆/ (/ Q/ |/ s/ )/ 作为/ 经历/ ht/ 的/ 预测/ 向量/ 狆/ (/ Q/ |/ ht/ )/ ./ 为了/ 验证/ 本文/ 算法/ 的/ 有效性/ ,/ 将/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 的/ 预测/ 效果/ 和/ 未/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 的/ 预测/ 效果/ 作/ 了/ 比较/ 分析/ ./ 其中/ ,/ 对于/ 未/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ ,/ 每/ 一时间/ 步/ 对应/ 的/ 预测/ 向量/ 直接/ 根据/ 学习/ 得到/ 的/ PSR/ 模型/ 计算/ 得出/ ./ 对于/ 两种/ 算法/ ,/ 各/ 做/ 了/ 10/ 次/ 试验/ ./ 对/ 相同/ 长度/ 的/ 训练/ 数据/ ,/ 以/ 10/ 次/ 实验/ 得到/ 的/ 平均值/ 作为/ 该/ 长度/ 对应/ 的/ 差值/ ./ 试验/ 结果/ 如图/ 2/ 所示/ ,/ 其中/ 横坐标/ 表示/ 的/ 是/ 用于/ 获得/ PSR/ 模型/ 的/ 训练/ 数据/ 的/ 长度/ ,/ 纵坐标/ 表示/ 的/ 是/ 采用/ 式/ (/ 4/ )/ 计算/ 得到/ 的/ 差值/ ./ 同时/ ,/ 表/ 1/ 给出/ 了/ ①/ ②/ Page5/ 在/ 实验/ 过程/ 中/ 所有/ 环境/ 下/ 两种/ 算法/ 得到/ 的/ 最小/ 差值/ ./ CheeseMaze0/ ./ 0352970.003642284/ ×/ 3Maze0/ ./ 03450Shuttle/ 根据/ 实验/ 结果/ 可知/ ,/ 在/ 大多数/ 情况/ 下/ ,/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 相比/ 未/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 更/ 准确/ ./ 但/ 从/ 图/ 2/ 可以/ 看出/ ,/ 在/ 4/ ×/ 3Maze/ 和/ Shuttle/ 环境/ 中/ ,/ 采用/ 复位/ 算法/ 的/ PSR/ 模型/ 的/ 预测/ 效果/ 并/ 不/ 稳定/ ./ 分析/ 原因/ 如下/ :/ 当/ 用/ 判别分析/ 方法/ 在/ 每/ 一时间/ 步/ 跟踪/ 系统/ 的/ PSR/ 状态/ 时/ ,/ 如果/ 实验/ 过程/ 中/ 不能/ 充分/ 发现/ 系统/ 的/ 状态/ 经历/ 的/ 集合/ ,/ 即/ 充分/ 发现/ 系统/ 的/ PSR/ 状态/ ,/ 或者/ 不同/ 的/ PSR/ 状态/ 对应/ 的/ 预测/ 向量/ 差别/ 不是/ 太/ 明显/ 时/ ,/ 在/ 某一时间/ 步下/ 确定/ 的/ PSR/ 状态/ 有/ 可能/ 是/ 错误/ 的/ ,/ 因此/ 会/ 导致/ 预测/ 效果/ 不/ 稳定/ 的/ 情况/ 发生/ ./ 虽然/ 如此/ ,/ 从/ 实验/ 结果/ 可以/ 看出/ ,/ 通过/ 采用/ 判别分析/ 方法/ 确定/ 系统/ 在/ 任意/ 时间/ 步/ 的/ PSR/ 状态/ ,/ 随后/ 对系统/ 的/ PSR/ 模型/ 复位/ ,/ 用于/ 提高/ PSR/ 模型/ 的/ 准确性/ 仍然/ 是/ 非常/ 有效/ 的/ ./ 本文/ 针对/ 的/ 是/ 可用/ 有限/ 阶/ 马尔可夫/ 模型表示/ 的/ 系统/ ,/ 即/ 系统/ 中/ 实际/ 存在/ 的/ PSR/ 状态/ 数量/ 有限/ ./ 对于/ 状态/ 空间/ 较大/ 的/ 系统/ ,/ 如果/ 在/ 每/ 一时间/ 步/ 都/ 对系统/ 的/ PSR/ 模型/ 复位/ ,/ 则/ 所/ 需/ 的/ 计算/ 量/ 较大/ ./ 对于/ 上述情况/ ,/ 可以/ 仅仅/ 在/ 当前/ 经历/ 是/ 状态/ 经历/ 时/ ,/ 对/ PSR/ 模型/ 复位/ ,/ 而/ 不是/ 在/ 每/ 一时间/ 步/ 都/ 对/ PSR/ 模型/ 复位/ ./ 5/ 结论/ 在/ 对/ 一个/ 离散/ 时间/ 、/ 有限/ 观测/ 值/ 的/ 受控/ 动态/ 系统/ 建模/ 时/ ,/ 相比/ 于/ 其它/ 两种/ 常用/ 的/ POMDPs/ 和/ 基于/ 经历/ 的/ 方法/ ,/ PSRs/ 具有/ 很多/ 优点/ ,/ 因此/ 得到/ 了/ 越来越/ 多/ 的/ 重视/ ./ 在/ 现实/ 环境/ 中/ ,/ 通过/ 学习/ 得到/ 的/ PSR/ 模型/ 不/ 可能/ 完全/ 准确/ ,/ 因此/ 在/ 用/ 学习/ 得到/ 的/ PSR/ 模型/ 计算/ 某一时间/ 步/ 对应/ 的/ 预测/ 向量/ 时/ ,/ 随着/ 计算/ 步数/ 的/ 增多/ ,/ 得到/ 的/ 预测/ 向量/ 有/ 可能/ 越来越/ 偏离/ 其/ 真实/ 值/ ./ 在/ 本文/ 工作/ 中/ ,/ 提出/ 了/ 一种/ PSR/ 模型/ 的/ 复位/ 算法/ ,/ 通过/ 在/ 每/ 一时间/ 步对/ PSR/ 模型/ 复位/ ,/ 提高/ PSR/ 模型/ 的/ 准确性/ ./ 算法/ 被/ 应用/ 于/ 一些/ 标准/ 的/ POMDP/ 问题/ ,/ 实验/ 结果/ 验证/ 了/ 本文/ 所提/ 方法/ 是/ 有效/ 的/ ./ 

