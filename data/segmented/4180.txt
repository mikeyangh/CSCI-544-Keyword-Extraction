Page1/ 移动/ 社交/ 应用/ 的/ 用户/ 隐私/ 泄漏/ 问题/ 研究/ 程瑶应/ 凌云/ 焦四辈/ 苏璞/ 睿/ 冯登国/ (/ 中国科学院/ 软件/ 研究所/ 可信计算/ 与/ 信息/ 保障/ 实验室/ 北京/ 100190/ )/ 摘要/ 智能/ 移动/ 终端/ 以/ 其/ 强大/ 的/ 处理/ 能力/ 和/ 丰富/ 的/ 功能/ 应用/ 迅速/ 得到/ 普及/ ,/ 成为/ 人们/ 日常生活/ 中/ 存储/ 和/ 处理/ 个人信息/ 必不可少/ 的/ 工具/ ./ 在/ 众多/ 的/ 移动/ 应用/ 中/ ,/ 社交/ 通信/ 类/ 应用/ 致力于/ 为/ 人们/ 提供/ 便捷/ 的/ 日常/ 通信/ 服务/ ,/ 这/ 类/ 应用/ 相比/ 移动/ 通信/ 运营商/ 提供/ 的/ 传统/ 短消息/ 服务/ 更加/ 经济实用/ ,/ 同时/ 提供/ 多媒体通信/ 方式/ 进一步/ 增强/ 用户/ 的/ 社交/ 体验/ ,/ 从而/ 迅速/ 地被/ 广泛/ 接受/ ./ 为了/ 进一步/ 巩固/ 自身/ 的/ 用户/ 群体/ ,/ 增加/ 用户/ 黏度/ ,/ 这/ 类/ 应用/ 在/ 其/ 内部/ 增添/ 了/ 一种/ 称为/ “/ 通讯录/ 匹配/ ”/ 的/ 功能/ ./ 该/ 功能/ 能够/ 向/ 用户/ 推荐/ 其/ 手机/ 通讯录/ 中/ 已经/ 注册/ 过该/ 应用/ 的/ 线下/ 联系人/ 为/ 好友/ ,/ 从而/ 帮助/ 用户/ 快速/ 地/ 将/ 线下/ 社交圈/ 移植/ 到/ 应用/ 线上/ ./ 然而/ ,/ 用户/ 在/ 获得/ 便利/ 的/ 同时/ 也/ 面临/ 着/ 潜在/ 的/ 隐私/ 泄露/ 风险/ ./ 文中/ 首次/ 提出/ 了/ 一种/ 独立/ 于/ 各/ 移动/ 智能/ 平台/ 的/ 、/ 能/ 有效/ 利用/ 移动/ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 实现/ 大规模/ 收集/ 用户/ 私人/ 数据/ 的/ 方法/ ,/ 该/ 方法/ 能够/ 收集/ 到/ 存储/ 于/ 目标/ 应用服务器/ 的/ 用户/ 个人资料/ ,/ 包括/ 手机号码/ 和/ 虚拟/ 应用/ 账户/ 资料/ 以及/ 两者之间/ 的/ 映射/ 关系/ ;/ 其次/ ,/ 为了/ 获取/ 规模/ 更大/ ,/ 内容/ 更/ 全面/ 、/ 更/ 真实/ 的/ 用户/ 资料/ ,/ 文本/ 提出/ 了/ 基于/ 多款/ 社交/ 通信/ 类/ 应用/ 的/ 跨/ 应用/ 整合/ 分析方法/ 以及/ 针对/ 不同/ 应用/ 来源/ 的/ 用户/ 资料/ 数据/ 一致性/ 与/ 真实性/ 分析/ ;/ 最后/ ,/ 在/ 信息/ 获取/ 和/ 分析方法/ 的/ 指导/ 下/ ,/ 文中/ 建立/ 了/ 利用/ 上述/ 漏洞/ 的/ 原型/ 系统/ ,/ 进行/ 了/ 大规模/ 数据/ 实验/ ,/ 最终/ 验证/ 了/ 上述/ 方法/ 的/ 有效性/ 和/ 良好/ 的/ 可扩展性/ ./ 关键词/ 智能/ 移动/ 终端/ ;/ 社交/ 通信/ 类/ 应用/ ;/ 隐私/ 泄露/ ;/ 移动/ 社交/ 网络/ ;/ 隐私/ 保护/ ;/ 智能手机/ 1/ 引言/ 近年来/ ,/ 风靡/ 全球/ 的/ 智能/ 移动/ 终端/ 逐渐/ 成为/ 人们/ 日常生活/ 必不可少/ 的/ 组成部分/ ./ 相比/ 传统/ 移动/ 终端/ ,/ 智能/ 移动/ 终端/ 的/ 优势/ 和/ 核心/ 价值/ 在于/ 用户/ 可/ 按照/ 个人/ 喜好/ 自行/ 安装/ 功能丰富/ 的/ 应用程序/ ./ 而/ 其中/ ,/ 基于/ 即时/ 通信/ 的/ 社交/ 应用程序/ (/ 简称/ “/ 社交/ 通信/ 类/ 应用/ ”/ ,/ 下同/ )/ 充分发挥/ 了/ 智能/ 终端/ 的/ 移动/ 通信/ 优势/ ,/ 极大/ 满足/ 了/ 用户/ 日常/ 通讯/ 需求/ ,/ 成为/ 用户/ 最/ 喜爱/ 的/ 应用/ 类别/ 之一/ ./ 这类/ 应用/ 主要/ 是/ 利用/ 移动/ 终端/ 的/ 蜂窝/ 移动/ 通信/ 网络/ 或者/ 无线通信/ 网络/ 发送/ 和/ 接收数据/ ,/ 因此/ 相对/ 于/ 传统/ 的/ SMS/ (/ ShortMessagingService/ )/ 和/ MMS/ (/ MultimediaMessageService/ )/ 来说/ 更加/ 经济/ 适用/ ;/ 同时/ ,/ 这/ 类/ 应用/ 借助/ 包括/ 文字/ 、/ 语音/ 、/ 图片/ 和/ 视频/ 等/ 在内/ 的/ 多媒体信息/ ,/ 充分发挥/ 了/ 移动/ 终端/ 的/ 即时/ 通信/ 特性/ ,/ 极大/ 地/ 丰富/ 了/ 用户/ 的/ 产品/ 体验/ ./ 相比/ 移动/ 通信/ 运营商/ 提供/ 的/ 传统/ 通信/ 服务/ ,/ 越来越/ 多/ 的/ 用户/ 更/ 倾向/ 于/ 使用/ 社交/ 通信/ 类/ 应用/ 进行/ 日常/ 通讯/ ./ 在/ 用户/ 使用/ 该类/ 应用/ 的/ 过程/ 中/ ,/ 为了/ 方便/ 现实/ 世界/ 的/ 好友/ 快速/ 而/ 准确/ 地/ 搜索/ 到/ 自己/ 并/ 添加/ 好友/ ,/ 在/ 注册/ 账号/ 时/ 用户/ 通常/ 会/ 提供/ 真实/ 的/ 个人信息/ ,/ 例如/ 姓名/ 、/ 年龄/ 、/ 性别/ ,/ 甚至/ 住址/ 和/ 工作/ 地点/ ./ 此外/ ,/ 同一个/ 用户/ 可能/ 使用/ 多款/ 社交/ 通信/ 类/ 应用/ ,/ 这/ 意味着/ 不同/ 应用服务器/ 将/ 存储/ 同一/ 用户/ 的/ 多份/ 个人信息/ 拷贝/ ,/ 这/ 潜在地/ 增加/ 了/ 用户/ 个人信息/ 被/ 他人/ 非法/ 获取/ 的/ 风险/ ./ 随着/ 社交/ 通信/ 类/ 应用/ 与/ 移动/ 运营商/ 通信/ 服务/ 在/ 移动/ 终端/ 上/ 越来越/ 紧密/ 地/ 结合/ ,/ 移动/ 终端/ 中/ 存储/ 的/ 用户/ 个人/ 通讯录/ 成为/ 了/ 各/ 应用/ 开发商/ 觊觎/ 已久/ 的/ 高/ 价值/ 用户/ 个性化/ 信息/ ./ 通常/ 情况/ 下/ ,/ 手机/ 通讯录/ 联系人/ 能够/ 相对/ 真实/ 地/ 反映/ 用户/ 的/ 线下/ 社交/ 关系/ ./ 如果/ 用户/ 需要/ 通过/ 社交/ 通信/ 类/ 应用/ 与/ 自己/ 的/ 朋友/ 进行/ 通信/ ,/ 用户/ 必须/ 在/ 应用/ 中/ 手动/ 搜索/ 目标/ 好友/ ,/ 这种/ 使用/ 方式/ 十分/ 繁琐/ 且/ 不/ 友好/ ./ 更好/ 的/ 方案/ 是/ 让/ 应用程序/ 自动/ 读取/ 用户/ 通讯录/ 存储/ 的/ 联系人/ 信息/ ,/ 并/ 主动/ 推荐/ 那些/ 正在/ 使用/ 该/ 应用/ 的/ 联系人/ 给/ 用户/ ./ 事实上/ ,/ 通过/ 实际/ 调研/ 发现/ 目前/ 绝大多数/ 社交/ 通信/ 类/ 应用/ 已经/ 可以/ 利用/ 通讯录/ 向/ 用户/ 推荐/ 合适/ 的/ 联系人/ 作为/ 线上/ 好友/ ./ 这是/ 用户/ 期望/ 已久/ 的/ 功能/ ,/ 同时/ 也/ 是/ 社交/ 通信/ 类/ 应用/ 能够/ 真正/ 凝聚/ 用户群/ ,/ 提高/ 用户/ 黏度/ 的/ 必经之路/ ./ 然而/ ,/ 虽然/ 从/ 技术/ 角度/ 来说/ 访问/ 用户/ 通讯录/ 已/ 没有/ 任何/ 困难/ ,/ 但/ 从/ 道德/ 和/ 法律/ 角度/ 来看/ ,/ 鉴于/ 通讯录/ 内容/ 属于/ 用户/ 的/ 私人/ 信息/ ,/ 因此/ 在/ 实际/ 中/ 应用程序/ 在/ 使用/ 用户/ 通讯录/ 之前/ 必须/ 首先/ 获得/ 来自/ 用户/ 的/ 关于/ 其/ 通讯录/ 信息/ 被/ 合法/ 访问/ 的/ 权限/ 许可/ ,/ 否则/ 将会/ 带来/ 严重/ 的/ 后果/ ./ 譬如/ ,/ 一款/ 热门/ 的/ 国外/ 社交/ 通信/ 类/ 应用/ Path/ ,/ 曾/ 在/ 未经/ 用户/ 允许/ 的/ 情况/ 下/ 擅自/ 存储用户/ 通讯录/ 信息/ ./ 虽然/ 其/ 初衷/ 是/ 为了/ 利用/ 通讯录/ 为/ 用户/ 推荐/ 高质量/ 的/ 好友/ ,/ 然而/ 这种/ 行为/ 显然/ 侵犯/ 了/ 用户/ 的/ 个人隐私/ ,/ 当时/ 这起/ 事件/ 在/ 业界/ 掀起/ 了/ 轩然大波/ ./ 幸运/ 的/ 是/ 目前/ 大部分/ 的/ 社交/ 通信/ 类/ 应用/ 都/ 意识/ 到/ 合理/ 利用/ 用户/ 信息/ 的/ 重要性/ ,/ 一切/ 涉及/ 访问/ 用户/ 通讯录/ 的/ 行为/ 皆/ 以/ 获得/ 用户/ 的/ 授权/ 许可/ 为/ 前提/ ./ 但是/ ,/ 在/ 获得/ 了/ 用户/ 许可/ 的/ 情况/ 下/ ,/ 被/ 访问/ 的/ 隐私/ 内容/ 就/ 安全/ 了/ 吗/ ?/ 正如/ 前/ 文/ 所述/ ,/ 移动/ 应用/ 市场/ 上/ 大部分/ 社交/ 通信/ 类/ 应用/ 已经/ 具备/ 了/ 自动/ 利用/ 通讯录/ 为/ 用户/ 推荐/ 真实/ 好友/ 的/ 功能/ (/ 称为/ “/ 通讯录/ 匹配/ ”/ ,/ 下同/ )/ ,/ 此/ 功能/ 允许/ 用户/ 上传/ 其/ 移动/ 终端/ 内/ 的/ 通讯录/ 到/ 应用服务器/ ,/ 随后/ 从/ 该/ 服务器返回/ 一组/ 存在/ 于/ 通讯录/ 中且/ 已/ 注册/ 过该/ 应用/ 的/ 联系人/ 列表/ 供/ 用户/ 选择/ 并/ Page3/ 添/ 加为好友/ ./ 例如/ ,/ 腾讯/ 公司/ 旗下/ 的/ 即时/ 移动/ 通信/ 应用/ “/ 微信/ ”/ ①/ 内/ 的/ “/ 手机/ 通讯录/ 匹配/ ”/ 功能/ 在/ 启用/ 之后/ 会/ 自动/ 向/ 用户/ 推荐/ 上述/ 类型/ 的/ 好友/ ,/ 同时/ 返回/ 好友/ 的/ 基本/ 信息/ ./ 实际/ 中/ ,/ 只要/ 用户/ 允许/ 应用程序/ 访问/ 其/ 通讯录/ 并/ 将/ 应用程序/ 账号/ 与/ 自己/ 的/ 手机号码/ 绑定/ ,/ 该/ 功能/ 便/ 被/ 激活/ ,/ 开始/ 向/ 用户/ 自动/ 推荐/ 好友/ ./ 然而/ ,/ 这里/ 存在/ 一种/ 安全隐患/ ,/ 即/ 如果/ 一个/ 攻击者/ 首先/ 伪造/ 自己/ 的/ 通讯录/ 列表/ ,/ 然后/ 激活/ 此/ 功能/ ,/ 这样/ 应用服务器/ 仍然/ 会/ 根据/ 其/ 伪造/ 的/ 通讯录/ 中/ 联系人/ 的/ 信息/ 来/ 向/ 攻击者/ 推荐/ 与/ 伪造/ 信息/ 对应/ 的/ 好友/ ,/ 这样/ 攻击者/ 就/ 获得/ 了/ 这些/ 伪造/ 的/ 联系人/ 的/ 应用/ 账户/ 资料/ ,/ 这些/ 资料/ 往往/ 包含/ 用户/ 真实/ 的/ 个人信息/ ,/ 如/ 用户名/ 、/ 性别/ 和/ 所在区域/ 等/ ./ 基于/ 这种/ 可能/ 的/ 攻击/ 思路/ ,/ 本文/ 从/ 攻击者/ 的/ 角度/ 提出/ 一种/ 利用/ 通讯录/ 匹配/ 功能/ 进行/ 个人隐私/ 刺探/ 的/ 方法/ 以/ 实现/ 大规模/ 用户/ 个人信息/ 的/ 收集/ ./ 本文/ 做出/ 了/ 以下/ 贡献/ :/ (/ 1/ )/ 本文/ 首次/ 提出/ 通过/ 移动/ 终端/ 社交/ 通信/ 类/ 应用/ 自动/ 收集/ 用户/ 个人信息/ 的/ 方法/ ,/ 这种/ 方法/ 在/ 用户/ 的/ 手机号码/ (/ 现实/ 世界/ 身份/ )/ 和/ 应用程序/ 账号/ 及/ 资料/ (/ 网络/ 虚拟/ 身份/ )/ 之间/ 建立/ 了/ 映射/ 关系/ ,/ 实验/ 结果表明/ 该/ 方法/ 将会/ 导致/ 上述/ 映射/ 信息/ 及/ 内容/ 无条件/ 地/ 泄露/ 给/ 任意/ 第三方/ ;/ (/ 2/ )/ 本文/ 提出/ 了/ 一种/ 基于/ 多款/ 社交/ 通信/ 类/ 应用/ 的/ 跨/ 应用/ 整合/ 分析方法/ ,/ 该/ 方法/ 通过/ 横向/ 整合/ 和/ 纵向/ 渗透/ 两种/ 模式/ ,/ 能够/ 获得/ 数量/ 更/ 庞大/ 、/ 信息/ 更/ 全面/ 的/ 用户/ 资料/ ./ 此外/ ,/ 基于/ 整合/ 的/ 用户/ 数据/ ,/ 本文/ 还/ 提出/ 了/ 用户/ 个人信息/ 的/ 一致性/ 和/ 真实性/ 分析方法/ ,/ 以/ 获取/ 更/ 真实/ 的/ 用户/ 资料/ 数据库/ ;/ (/ 3/ )/ 本文/ 实现/ 了/ 基于/ 上述/ 漏洞/ 利用/ 方法/ 的/ 原型/ 系统/ ,/ 并/ 通过/ 单/ 应用/ 分析/ 充分/ 验证/ 了/ 该/ 方法/ 的/ 有效性/ ,/ 同时/ 还/ 通过/ 一个/ 具体/ 攻击/ 实例/ 展示/ 了/ 跨/ 应用/ 整合/ 的/ 数据分析/ 过程/ 及/ 攻击/ 效果/ ,/ 实验/ 结果表明/ ,/ 相比/ 单/ 应用/ 分析/ ,/ 跨/ 应用/ 整合/ 方法/ 能够/ 获取/ 更/ 全面/ 、/ 更/ 真实/ 的/ 用户/ 个人信息/ ;/ (/ 4/ )/ 最后/ ,/ 在/ 分析/ 该/ 攻击/ 实施/ 过程/ 的/ 基础/ 上/ 确定/ 了/ 实施/ 攻击/ 所/ 必备/ 的/ 前提条件/ ,/ 并/ 具有/ 针对性/ 地/ 提出/ 相应/ 的/ 防御/ 策略/ 供应/ 用/ 开发者/ 参考/ ./ 这些/ 策略/ 能/ 有效/ 避免/ 用户/ 虚拟/ 网络/ 身份/ 与/ 真实世界/ 身份/ 映射/ 关系/ 的/ 建立/ ,/ 进而/ 防止/ 攻击者/ 通过/ 用户/ 的/ 网络/ 身份/ 获取/ 其/ 真实/ 身份/ 的/ 个人信息/ ./ 本文/ 第/ 2/ 节/ 介绍/ 拟/ 解决/ 的/ 问题/ 及/ 涉及/ 到/ 的/ 相关/ 概念/ ;/ 第/ 3/ 节对/ 本文/ 提出/ 的/ 漏洞/ 利用/ 方法/ 及/ 原形/ 系统/ 进行/ 深入/ 地/ 阐述/ ,/ 同时/ 展现/ 具体/ 的/ 实现/ 细节/ ;/ 实验/ 和/ 数据分析/ 部分/ 在/ 第/ 4/ 节/ 展示/ ;/ 第/ 5/ 节/ 分析攻击/ 形成/ 的/ 基本要素/ 和/ 前提/ ,/ 进而/ 为/ 应用/ 开发者/ 提出/ 一系列/ 可行/ 的/ 防御/ 策略/ ;/ 第/ 6/ 节/ 讨论/ 与/ 本文/ 相关/ 的/ 其它/ 研究/ 工作/ ;/ 最后/ 第/ 7/ 节/ 总结/ 全文/ ./ 2/ 问题/ 描述/ 本/ 节/ 主要/ 介绍/ 当下/ 社交/ 通信/ 类/ 应用/ 中/ 广泛/ 运用/ 的/ 通讯录/ 匹配/ 功能/ ,/ 并/ 就/ 其/ 潜在/ 的/ 安全/ 问题/ 进行/ 讨论/ ./ 2.1/ 通讯录/ 匹配/ 功能/ 为了/ 更/ 快速/ 地/ 获取/ 用户群/ ,/ 提升/ 用户/ 的/ 黏度/ ,/ 如何/ 将/ 用户/ 真实/ 生活/ 中/ 的/ 社交/ 关系/ 迁移/ 到/ 应用/ 平台/ 上/ 是/ 社交/ 通信/ 类/ 应用/ 所/ 要/ 考虑/ 的/ 一个/ 重要环节/ ./ 通讯录/ 匹配/ 功能/ 极大/ 地/ 满足/ 了/ 开发者/ 的/ 这/ 一/ 需求/ ,/ 该/ 功能/ 逐渐/ 成为/ 了/ 社交/ 通信/ 类/ 应用/ 的/ 标配/ ./ 通讯录/ 匹配/ 功能/ 的/ 使用/ 前提/ 有/ 两点/ :/ 首先/ ,/ 需要/ 将/ 用户/ 的/ 手机号码/ 和/ 在/ 应用/ 中/ 注册/ 的/ 用户/ 账户/ 进行/ 绑定/ ;/ 其次/ ,/ 需要/ 用户/ 显式/ 地/ 允许/ 应用程序/ 上传/ 通讯录/ 或者/ 通讯录/ 特征/ 摘要/ 信息/ ./ 在/ 以上/ 两个/ 前提/ 都/ 满足/ 后/ ,/ 应用程序/ 将/ 该/ 用户/ 的/ 通讯录/ 上传/ 至/ 应用/ 服务端/ ,/ 随即/ 返回/ 已经/ 注册/ 该/ 应用/ 并/ 绑定/ 了/ 应用/ 账户/ 与/ 手机号码/ 的/ 联系人/ 给/ 该/ 用户/ 供其/ 浏览/ 或添/ 加为好友/ ./ 这种/ 机制/ 一方面/ 极大/ 地方/ 便/ 了/ 用户/ 与/ 好友/ 之间/ 的/ 找寻/ 与/ 交流/ ,/ 另一方面/ 迅速/ 扩大/ 了/ 用户/ 在/ 新/ 应用/ 中/ 的/ 社交圈/ ,/ 提高/ 了/ 用户/ 对于/ 新/ 应用/ 的/ 依赖度/ ./ 该/ 功能/ 的/ 使用/ 基于/ 一个/ 潜在/ 的/ 默认/ 假设/ ,/ 即/ 通讯录/ 中/ 的/ 联系人/ 信息/ 能够/ 真实/ 反映/ 用户/ 现实/ 世界/ 中/ 的/ 社交/ 关系/ ./ 应用程序/ 默认/ 假设/ 用户/ 与其/ 联系人/ 之间/ 存在/ 一定/ 的/ 信任度/ ,/ 认为/ 向/ 用户/ 推送/ 其/ 联系人/ 账户/ 信息/ 将/ 不会/ 构成/ 潜在/ 的/ 安全/ 风险/ ./ 然而/ ,/ 事实/ 往往/ 不是/ 如此/ ./ 本文/ 经过/ 分析/ 发现/ 通讯录/ 匹配/ 功能/ 在/ 给/ 用户/ 带来/ 便利/ 的/ 同时/ ,/ 也/ 带来/ 了/ 潜在/ 的/ 用户/ 隐私/ 泄露/ 隐患/ ./ 2.2/ 恶意/ 利用/ 通讯录/ 匹配/ 功能/ 形式化/ 描述/ 首先/ ,/ 用户/ u/ 的/ 通讯录/ 可以/ 表示/ 为/ 联系人/ 的/ 集合/ :/ Cu/ =/ {/ cii/ ∈/ [/ 1/ ,/ N/ ]/ ;/ N/ 为/ u/ 的/ 联系人/ 总数/ }/ ,/ 其中/ ,/ ci/ 表示/ 用户/ u/ 的/ 通讯录/ 中/ 第/ i/ 个/ 联系人/ ,/ ci/ 是/ 一个二元/ 组/ (/ namec/ ,/ pnc/ )/ ,/ namec/ 和/ pnc/ 分别/ 表示/ 联系人/ c/ 的/ 姓名/ 和/ 手机号码/ ,/ pnc/ 通常/ 以/ 明文/ 的/ 形式/ 存储/ 在/ 本地/ 通讯录/ 中/ ,/ 且/ 能/ 唯一/ 确定/ ci/ ./ 应用服务器/ 的/ 数据库/ 中/ 存储/ 了/ 所有/ 的/ 用户/ 账户/ 信息/ ,/ 构成/ 整个/ 用户/ 账户/ 集合/ ADB/ (/ AccountData/ -/ base/ )/ :/ ①/ 微信/ ./ http/ :/ // // weixin/ ./ qq/ ./ comPage4/ 其中/ ,/ Accountappu/ 表示/ 已/ 注册/ 应用程序/ app/ 的/ 用户/ u/ 的/ 帐户/ :/ Accountappu/ =/ {/ IDappu/ ,/ PNu/ ,/ Profileappu/ }/ ./ IDappu/ 是/ 应用程序/ app/ 中/ 用户/ u/ 的/ 唯一/ 标识符/ ,/ PNu/ 表示/ 与/ 该/ 账户/ 绑定/ 的/ 手机号码/ 的/ 特征/ 信息/ ,/ Profileappu/ 表示/ 应用程序/ app/ 中/ 用户/ u/ 的/ 所有/ 个人信息/ ./ 当/ 用户/ 激活/ 通讯录/ 匹配/ 功能/ 后/ ,/ 形成/ 如下/ 的/ 实体/ 绑定/ :/ 该/ 绑定/ 涉及/ 两类/ 实体/ ,/ 即/ 用户/ 的/ 账户/ Accountappu/ 以及/ 用户/ 手机号码/ 的/ 摘要/ 值/ ./ 其中/ ,/ Hash/ 表示/ 摘要/ 函数/ ,/ 如/ MD5/ ./ 对/ 手机号码/ 的/ 摘要/ 处理/ 是/ 应用程序/ 出于/ 隐私/ 考虑/ ,/ 避免/ 手机号码/ 直接/ 存储/ 在/ 服务器/ 上/ 的/ 一种/ 保护/ 手段/ ./ 实际/ 中/ ,/ 该/ 绑定/ 将/ Hash/ (/ pnu/ )/ 的/ 值/ 赋予/ Accountappu/ 的/ PNu/ ./ 已/ 绑定/ 手机号码/ 到/ 应用程序/ app/ 的/ 用户/ 构成/ 了/ 如下/ 集合/ :/ BINDapp/ =/ {/ Accountappu/ |/ Binding/ (/ Accountappu/ ,/ 基于/ 对/ 上述/ 问题/ 的/ 描述/ ,/ 接下来/ 将/ 对/ 滥用/ 通讯录/ 匹配/ 功能/ 进行/ 用户/ 资料/ 获取/ 的/ 方法/ 进行/ 阐述/ ./ 值得注意/ 的/ 是/ ,/ 该/ 方法/ 不/ 针对/ 任何/ 特定/ 的/ 移动/ 终端/ 系统/ ,/ 对/ 任何/ 移动/ 平台/ ,/ 只要/ 存在/ 配备/ 通讯录/ 匹配/ 功能/ 的/ 社交/ 通信/ 类/ 应用/ ,/ 本/ 方法/ 都/ 将/ 适用/ ./ 首先/ ,/ 攻击者/ f/ 伪造/ 一个/ 通讯录/ Cf/ ,/ 其中/ 每条/ 联系人/ 都/ 由/ 姓名/ 和/ 手机号码/ 组成/ ./ 由于/ 手机号码/ 的/ 号码/ 段/ 具有/ 固定/ 的/ 格式/ ,/ 伪造/ 的/ 通讯录/ 中/ 手机号码/ 可以/ 自由选择/ ,/ 攻击者/ 可以/ 选择/ 感兴趣/ 的/ 号码/ 集合/ 、/ 随机/ 号码/ 集合/ 或者/ 特定/ 的/ 号码/ 段/ ./ 姓名/ 可以/ 与/ 手机号码/ 无关/ ,/ 选择/ 可读性/ 强且/ 唯一/ 的/ 标识/ 即可/ ./ 接下来/ ,/ 将/ Cf/ 上/ 传到/ 应用程序/ 服务器/ ,/ 随后/ 会/ 收到/ 从/ 服务器返回/ 的/ 已/ 绑定/ 该/ 应用/ 的/ 联系人/ 账户/ 信息/ 及其/ 资料/ ,/ 从而/ 构成/ 了/ 目标/ 联系人/ 集合/ Rapp/ ,/ 完成/ 了/ 目标/ 用户/ 信息/ 的/ 收集/ :/ Rapp/ =/ {/ Accountappu/ |/ Accountappu/ ∈/ BINDapp/ ,/ 此外/ ,/ 如上/ 文/ 所述/ ,/ 出于/ 隐私/ 保护/ 的/ 目的/ ,/ 部分/ 应用程序/ 在/ 服务器端/ 存储/ 手机号码/ 的/ 特征/ 信息/ 作为/ 匹配/ 标识/ ,/ 这种/ 隐私/ 保护/ 机制/ 并/ 不能/ 影响/ 本文/ 所述/ 方法/ 的/ 实施/ ./ 因为/ 本文/ 提出/ 的/ 方法/ 利用/ 了/ 应用程序/ 中/ 的/ 正常/ 功能/ ,/ 完全/ 从/ 正常/ 用户/ 的/ 使用/ 角度/ 进行/ 攻击/ ,/ 在/ 这种/ 场景/ 中/ ,/ 本地/ 通讯录/ 中/ 的/ 手机号码/ 是/ 明文/ 存储/ ,/ 而/ 不/ 需要/ 分析/ 应用/ 在/ 服务器/ 是否/ 以/ 特征/ 信息/ 形式/ 存储/ 手机号码/ ./ 2.3/ 威胁/ 分析/ 账户/ 是/ 用户/ 在/ 网络空间/ 中/ 的/ 唯一/ 可见/ 标识/ ./ 用户/ 通常/ 只能/ 通过/ 他人/ 的/ 账户/ 和/ 相应/ 的/ 资料/ 来/ 判断/ 对方/ 的/ 身份/ ./ 多数/ 情况/ 下/ ,/ 用户/ 习惯于/ 相信/ 那些/ 资料/ 详细/ 、/ 完整/ 且/ 合理/ 的/ 账户/ ./ 虽然/ 这些/ 账户/ 看似/ 可信/ ,/ 但/ 当/ 攻击者/ 能够/ 通过/ 某种/ 方法/ 大规模/ 获取/ 用户/ 资料/ 并/ 利用/ 窃取/ 的/ 用户/ 资料/ 进行/ 伪装/ 诈骗/ 时/ ,/ 这种/ 常识/ 将会/ 导致用户/ 严重/ 的/ 错误判断/ ,/ 从而/ 引发/ 网络/ 犯罪/ ,/ 特别/ 是/ 网络/ 欺诈/ ./ 本文/ 提出/ 的/ 利用/ 社交/ 通信/ 类/ 应用/ 通讯录/ 匹配/ 功能/ 获取/ 用户/ 资料/ 的/ 方法/ 具有/ 以下/ 被/ 攻击者/ 利用/ 的/ 潜在/ 威胁/ :/ (/ 1/ )/ 攻击者/ 可以/ 通过/ 该/ 方法/ 大量/ 获取/ 用户/ 的/ 个人资料/ 和/ 手机号码/ ./ 由于/ 手机号码/ 通常/ 能/ 唯一/ 确定/ 用户/ 的/ 真实/ 身份/ ,/ 在/ 结合/ 用户/ 资料/ 后/ 攻击者/ 对/ 手机号码/ 的/ 拥有者/ 具有/ 更/ 全面/ 的/ 了解/ ,/ 因此/ 本/ 方法/ 可以/ 作为/ 进一步/ 攻击/ 的/ 前期/ 准备/ 工作/ ,/ 例如/ 作为/ 社会/ 工程学/ 攻击/ 的/ 前期/ 信息/ 收集/ 阶段/ ;/ (/ 2/ )/ 通过/ 本/ 方法/ ,/ 网络/ 中/ 的/ 恶意/ 用户/ ,/ 特别/ 是/ 垃圾/ 短信/ 制作者/ 通过/ 向/ 社交/ 通信/ 类/ 应用服务器/ 提交/ 一组/ 指定/ 的/ 目标/ 手机号码/ ,/ 就/ 可以/ 确定/ 选定/ 的/ 手机号码/ 是否/ 处于/ 使用/ 状态/ ./ 这样/ 恶意/ 用户/ 能够/ 收集/ 大量/ 的/ 活跃/ 手机号码/ ,/ 进而/ 统计/ 收集/ 到/ 的/ 用户/ 资料/ 信息/ ,/ 最后/ 实现/ 根据/ 性别/ 、/ 地域/ 和/ 兴趣/ 等/ 不同/ 偏好/ 进行/ 广告/ 的/ 定向/ 投放/ ,/ 从而/ 扩大/ 了/ 广告投放/ 的/ 有效/ 受众/ 规模/ ;/ (/ 3/ )/ 当/ 用户注册/ 多个/ 应用程序/ 后/ ,/ 攻击者/ 可以/ 通过/ 本/ 方法/ 从/ 不同/ 的/ 应用程序/ 中/ 获取/ 多份/ 同一/ 用户/ 的/ 不同/ 资料/ ,/ 结合/ 本文/ 的/ 整合/ 方法/ ,/ 攻击者/ 可以/ 获取/ 该/ 用户/ 更加/ 全面/ 的/ 资料/ 信息/ ,/ 例如/ 包括/ 学校/ 、/ 院系/ 和/ 工作/ 单位/ 等/ ,/ 基于/ 这些/ 资料/ 攻击者/ 能够/ 开展/ 进一步/ 的/ 网络/ 诈骗/ 攻击/ ;/ (/ 4/ )/ 攻击者/ 也/ 可以/ 通过/ 获取/ 的/ 用户/ 资料/ 信息/ 实施/ 身份/ 盗窃/ ,/ 以/ 克隆/ 的/ 方式/ 创建/ 虚假/ 的/ 用户/ 身份/ ./ 克隆/ 身份/ 攻击/ 是/ 指/ 在/ 相同/ 或者/ 不同/ 的/ 应用/ 中/ 攻击者/ 根据/ 已有/ 的/ 目标/ 用户/ 的/ 资料/ 信息/ 克隆/ 出/ 一个/ 和/ 目标/ 用户/ 完全一致/ 的/ 虚假/ 账户/ 来/ 开展/ 进一步/ 的/ 攻击/ ./ 对于/ 攻击者/ 来说/ ,/ 获得/ 的/ 信息/ 越/ 全面/ ,/ 创建/ 的/ 克隆/ 身份/ 就/ 越/ 真实/ ,/ 攻击/ 效果/ 就/ 越/ 明显/ ./ 3/ 方法/ 与/ 实现/ 本/ 节/ 主要/ 介绍/ 利用/ 移动/ 社交/ 通信/ 类/ 应用/ 获取/ 用/ Page5/ 户/ 资料/ 的/ 方法/ 及/ 流程/ ,/ 然后/ 基于/ 此/ 流程/ 进一步/ 阐述/ 原形/ 系统/ 的/ 整体/ 架构/ 和/ 具体/ 实现/ 细节/ ./ 3.1/ 信息/ 获取/ 与/ 整合/ 分析/ 利用/ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 获取/ 用户/ 手机号码/ 及/ 账户/ 信息/ 的/ 整体/ 流程/ 如图/ 1/ 所示/ ./ 首先/ 是/ 伪造/ 候选/ 通讯录/ ,/ 候选/ 通讯录/ 的/ 每个/ 条目/ 包括/ 目标/ 联系人/ 的/ 唯一/ 标识符/ 和/ 手机号码/ ;/ 然后/ ,/ 将/ 伪造/ 的/ 通讯录/ 通过/ 目标/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 提交/ ,/ 这时/ ,/ 应用/ 将/ 通过/ 网络/ 将/ 通讯录/ 信息/ 以/ 原文/ 或者/ 摘要/ 信息/ 的/ 形式/ 上/ 传到/ 应用服务器/ 中/ ;/ 服务器/ 随后/ 会/ 返回/ 所有/ 与/ 该/ 通讯录/ 中/ 的/ 手机号码/ 绑定/ 的/ 用户/ 账户/ 及/ 相应/ 的/ 个人资料/ ,/ 这些/ 返回/ 的/ 信息/ 将/ 形成/ 目标/ 用户/ 的/ 初步/ 资料/ ;/ 最后/ ,/ 基于/ 返回/ 的/ 资料/ 作/ 进一步/ 的/ 数据/ 整合/ 与/ 分析/ ,/ 形成/ 了/ 更/ 完整/ 、/ 更/ 真实/ 的/ 目标/ 用户/ 信息/ ,/ 称为/ 用户/ 资料/ 数据库/ ./ 其中/ ,/ 获取/ 目标/ 用户/ 应用/ 账户/ 资料/ 的/ 具体/ 实现/ 方法/ 将/ 在/ 3.2/ 节中/ 介绍/ ./ 上述/ 流程/ 的/ 最后/ 一步/ 涉及/ 到/ 用户/ 个人资料/ 的/ 整合/ 和/ 分析/ ./ 其中/ ,/ 整合/ 主要/ 是/ 针对/ 已/ 获得/ 同一/ 用户/ 在/ 多个/ 不同/ 应用/ 中/ 多份/ 个人资料/ 的/ 情况/ ./ 实际/ 中/ ,/ 每种/ 应用/ 平台/ 要求/ 用户/ 填写/ 的/ 账户/ 注册/ 信息/ 或多或少/ 地/ 存在/ 差异/ 和/ 补充/ ,/ 因此/ 攻击者/ 通过/ 对/ 来自/ 多个/ 应用/ 平台/ 的/ 用户/ 资料/ 进行/ 有效/ 整合/ ,/ 往往/ 能够/ 获得/ 关于/ 目标/ 用户/ 更加/ 全面/ 的/ 个人信息/ ./ 用户/ 个人资料/ 的/ 整合/ 方法/ 主要/ 分为/ 两类/ :/ 即/ 横向/ 整合/ 和/ 纵向/ 渗透/ ./ 横向/ 整合/ 主要/ 针对/ 从/ 多个/ 非/ 同源/ 应用/ 平台/ (/ 出自/ 不同/ 开发商/ )/ 获取/ 用户/ 资料/ 的/ 情况/ ,/ 而/ 纵向/ 渗透/ 关注/ 从/ 多个/ 同源/ 应用/ 平台/ (/ 出自/ 相同/ 开发商/ )/ 获取/ 到/ 用户/ 资料/ 的/ 情况/ ./ 此外/ ,/ 出于/ 防范/ 意识/ 或者/ 其它/ 原因/ ,/ 用户/ 在/ 应用/ 中/ 提交/ 的/ 个人/ 注册/ 信息/ 不/ 一定/ 总是/ 反映/ 了/ 用户/ 的/ 真实情况/ ,/ 因此/ 本文/ 也/ 提出/ 了/ 一种/ 用于/ 确定/ 用户/ 资料/ 真实度/ 的/ 一致性/ 与/ 真实性/ 分析方法/ ./ 3.1/ ./ 1/ 横向/ 整合/ 目前/ 移动/ 应用/ 市场/ 中/ 不同/ 的/ 社交/ 通信/ 类/ 应用/ 在/ 完成/ 通讯录/ 匹配/ 后/ 返回/ 的/ 用户/ 资料/ 的/ 内容/ 和/ 格式/ 都/ 不尽相同/ ,/ 这/ 取决于/ 各种/ 应用/ 平台/ 的/ 用户/ 定位/ 和/ 对/ 用户/ 资料/ 的/ 需求/ ./ 因此/ ,/ 如果/ 攻击者/ 通过/ 通讯录/ 匹配/ 功能/ 获得/ 了/ 同一/ 用户/ 在/ 不同/ 应用/ 平台/ 注册/ 的/ 个人账户/ 信息/ ,/ 再/ 加以/ 比/ 对/ 和/ 聚合/ ,/ 就/ 能/ 得到/ 更加/ 完整/ 的/ 用户/ 资料/ ./ 这/ 便是/ 横向/ 整合/ 的/ 基本/ 思想/ ./ 横向/ 整合/ 按照/ 目的/ 不同/ 可以/ 分为/ 两类/ :/ 广并/ 集合/ 和/ 深交/ 集合/ ./ 由于/ 不同/ 的/ 应用程序/ 拥有/ 各自/ 不同/ 的/ 用户/ 群体/ ,/ 广并/ 集合/ 通过/ 结合/ 从/ 多个/ 应用/ 平台/ 获取/ 的/ 不同/ 用户/ 账户/ 来/ 获得/ 更/ 多/ 数量/ 的/ 用户/ 账户/ ,/ 这些/ 账户/ 构成/ 了/ 集合/ BroadUnion/ ./ 为/ 简单/ 起/ 见/ ,/ 本文/ 以/ 两个/ 应用程序/ 为例/ 进行/ 说明/ :/ BroadUnionapp1/ ∪/ app2/ =/ {/ Accountappu/ |/ Accountappu/ ∈/ 深交/ 集合/ 旨在/ 挖掘/ 同一/ 用户/ 更/ 完整/ 和/ 全面/ 的/ 个人信息/ ,/ 因此/ 深交/ 数据处理/ 主要/ 针对/ 同一个/ 用户/ 可能/ 活跃/ 在/ 多个/ 应用程序/ 的/ 情况/ ./ 这里/ PNu/ 作为/ 用户/ u/ 在/ 不同/ 应用/ 平台/ 上/ 的/ 唯一/ 标识符/ ,/ 每/ 一个/ PNu/ 将/ 确定/ 真实世界/ 中/ 的/ 一个/ 用户/ 身份/ ,/ 所以/ 通过/ PNu/ 能够/ 连接/ 同一/ 用户/ 身份/ 在/ 不同/ 应用/ 平台/ 中/ 的/ 多份/ 用户/ 账号/ 及/ 附带/ 资料/ ./ 深交/ 集合/ DeepIntersection/ 表示/ 为/ DeepIntersectionapp1/ ∩/ app2/ =/ {/ Accountapp1u/ ∪/ Accountapp2u/ |/ Accountapp1u/ ∈/ Rapp1/ ,/ Accountapp2u/ ∈/ Rapp2/ ,/ Accountapp1u/ ./ PNu/ =/ Accountapp2u/ ./ PNu/ }/ ./ 其中/ ,/ Accountapp1u/ ∪/ Accountapp2u/ =/ {/ IDapp1u/ ,/ Profileapp1u/ ,/ 3.1/ ./ 2/ 纵向/ 渗透/ 目前/ ,/ 许多/ 大型/ 应用/ 开发商/ 旗下/ 都/ 拥有/ 多款/ 应用/ 产品/ ,/ 并/ 在/ 这些/ 应用/ 之间/ 共享/ 用户/ 登录/ ID/ ./ 这样/ 做/ 不但/ 方便/ 用户/ 管理/ 自己/ 的/ 各种/ 应用/ 账号/ ,/ 更/ 重要/ 的/ 是/ 方便/ 开发商/ 整合/ 用户/ 资源/ 从而/ 扩大/ 其/ 每款/ 应用/ 的/ 用户/ 覆盖率/ ./ 另外/ ,/ 现在/ 诸多/ 类似/ 于/ Facebook/ 和/ 腾讯/ 的/ 在线/ 社交/ 服务提供商/ 逐步/ 对/ 第/ 3/ 方/ 站点/ 开放/ 了/ ID/ 登录/ 验证/ 服务/ 功能/ ./ 这/ 意味着/ 大量/ 的/ 应用程序/ 将会/ 共享/ 相同/ 的/ 账户/ 登录/ ID/ 数据/ ./ 这里/ ,/ 将/ 针对/ 共享/ 相同/ 账户/ 登录/ ID/ 的/ 多个/ 应用程序/ 间/ 实施/ 的/ 渗透/ 叫做/ 纵向/ 渗透/ ,/ 纵向/ 渗透/ 往往/ 需要/ 人工/ 参与/ ./ 相对/ 于/ 横向/ 整合/ ,/ 纵向/ 渗透/ 可以/ 提供/ 更为/ 全面/ 、/ 准确/ 的/ 个人信息/ ./ 本文/ 将/ 在/ 4.2/ ./ 2/ 节/ 呈现/ 一个/ 完整/ 的/ 纵向/ 渗透/ 的/ 案例/ ,/ 并/ 对/ 该/ 案例/ 进行/ 详细/ 的/ 阐述/ 和/ 分析/ ./ Page63/ ./ 1.3/ 一致性/ 与/ 真实性/ 分析/ 市场/ 上/ 不同/ 款/ 社交/ 通信/ 类/ 应用/ 各自/ 侧重于/ 满足用户/ 不同/ 的/ 社交/ 需求/ ,/ 有/ 的/ 应用/ 定/ 位于/ 促进/ 用户/ 与/ 朋友/ 间/ 的/ 通信/ 和/ 交流/ ,/ 例如/ 推荐/ 通讯录/ 联系人/ 为/ 待/ 添加/ 好友/ ;/ 有/ 的/ 应用/ 则/ 定/ 位于/ 帮助/ 用户/ 发掘/ 新/ 朋友/ ,/ 例如/ 基于/ 相似/ 的/ 兴趣爱好/ 或/ 相近/ 的/ 地理位置/ 为/ 用户/ 推荐/ 新/ 朋友/ ./ 不同/ 的/ 用户/ 定位/ 决定/ 了/ 用户/ 在/ 填写/ 账户/ 注册/ 信息/ 时/ 呈现出/ 不同/ 的/ 行为习惯/ ./ 在/ 使用/ 定/ 位于/ 促进/ 朋友/ 间通信/ 的/ 应用/ 时/ ,/ 为了/ 方便/ 被/ 朋友/ 找到/ 并/ 添加/ 自己/ 的/ 应用/ 账户/ 为/ 好友/ ,/ 用户/ 通常/ 倾向/ 于/ 填写/ 自己/ 真实/ 的/ 个人信息/ ,/ 同时/ 用户/ 也/ 会/ 潜意识/ 地/ 认为/ 这些/ 信息/ 会/ 被/ 自己/ 的/ 联系人/ 朋友/ 看到/ ./ 而/ 在/ 另一类/ 定/ 位于/ 推荐/ 和/ 挖掘/ 新/ 朋友/ 的/ 应用/ 中/ ,/ 用户/ 会/ 出于/ 自身/ 防卫/ 意识/ 而/ 填写/ 不/ 完全/ 真实/ 的/ 信息/ ./ 这种/ 情况/ 下/ ,/ 在/ 分析/ 来自/ 于/ 不同/ 社交/ 通信/ 类/ 应用/ 的/ 数据/ 时/ ,/ 用户/ 个人信息/ 数据/ 的/ 一致性/ 和/ 真实性/ 是/ 需要/ 关注/ 的/ 重点/ 之一/ ,/ 本文/ 针对/ 该/ 问题/ 提出/ 了/ 一致性/ 与/ 真实性/ 分析方法/ ./ 这里/ 的/ 一致性/ 和/ 真实性/ 是/ 指/ 来自/ 多个/ 应用/ 平台/ 的/ 用户/ 资料/ 中/ 相同/ 字段/ 的/ 内容/ 是否/ 统一/ ,/ 如果/ 不/ 统一/ ,/ 则/ 意味着/ 该字/ 段/ 的/ 某些/ 版本/ 可能/ 不/ 完全/ 为/ 真实情况/ ./ 一致性/ 与/ 真实性/ 分析方法/ 主要/ 针对/ 用户/ 来自/ 不同/ 应用/ 平台/ 的/ 个人信息/ 中共/ 有/ 的/ 字/ 段/ 进行/ 分析/ ,/ 其/ 核心思想/ 是/ 比较/ 同一/ 用户/ 的/ 多份/ 个人信息/ 的/ 差异/ ,/ 然后/ 根据/ 不同/ 的/ 信息/ 差别/ 对字段/ 真实情况/ 进行/ 不同/ 的/ 判断/ ./ 具体来说/ ,/ 对于/ 非/ 类别/ 信息/ 字/ 段/ (/ 如/ 姓名/ 、/ 住址/ 等/ )/ ,/ 如果/ 这些/ 字段/ 的/ 内容/ 趋于/ 一致/ (/ 内容/ 完全/ 匹配/ )/ 或/ 相似/ (/ 内容/ 部分/ 匹配/ )/ ,/ 则/ 认为/ 该字/ 段/ 的/ 内容/ 很/ 有/ 可能/ 反映/ 了/ 用户/ 的/ 真实/ 信息/ ./ 注意/ ,/ 对于/ 用户/ 在/ 任何/ 应用/ 平台/ 内/ 都/ 使用/ 一致/ 的/ 虚假/ 信息/ 来/ 注册/ 账户/ 的/ 情况/ ,/ 则/ 任何/ 一种/ 使用/ 用户注册/ 信息/ 进行/ 一致性/ 和/ 真实性/ 分析/ 的/ 方法/ 都/ 将/ 无法/ 判断/ 信息/ 真实/ 与否/ ./ 另一方面/ ,/ 对于/ 类别/ 信息/ (/ 如/ 性别/ )/ ,/ 如果/ 出现/ 不/ 一致/ 的/ 情况/ ,/ 则/ 字/ 段/ 采用/ “/ 胜者/ 全取/ ”/ 机制/ ,/ 即/ 选择/ 在/ 不同/ 应用/ 平台/ 中/ 出现/ 频率/ 最多/ 的/ 值/ 作为/ 最终/ 确定/ 的/ 真实/ 值/ ./ 特别/ 地/ ,/ 针对/ 用户/ “/ 用户名/ ”/ 字段/ 的/ 处理/ ,/ 由于/ 中文/ 姓名/ 具有/ 固定/ 的/ 组成/ 模式/ ,/ 在/ 处理/ 中文/ 姓名/ 时/ 本文/ 将/ 运用/ 模式匹配/ 技术/ 对/ 中文/ 姓名/ 的/ 真实性/ 进行/ 分析/ ./ 3.2/ 系统/ 架构/ 与/ 实现/ 本文/ 实现/ 了/ 利用/ 上述/ 漏洞/ 实施/ 大规模/ 获取/ 用户/ 信息/ 的/ 原型/ 系统/ ,/ 该/ 系统/ 分为/ 3/ 个/ 模块/ ,/ 即/ 通讯录/ 伪造/ 模块/ 、/ 信息提取/ 模块/ 和/ 数据分析/ 模块/ ./ 通讯录/ 伪造/ 模块/ 负责/ 自动/ 产生/ 候选/ 手机号码/ ,/ 并/ 以/ 标准/ 通讯录/ 格式/ 输出/ ./ 通常/ 情况/ 下/ ,/ 攻击者/ 可以/ 枚举/ 若干/ 号码/ 段/ ./ 通讯录/ 规模/ 的/ 设定/ 值得/ 关注/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 应用服务器/ 没有/ 限定/ 响应/ 通讯录/ 匹配/ 请求/ 数量/ 的/ 情况/ 下/ 具有/ 很/ 好/ 的/ 可扩展性/ ,/ 但/ 在/ 实际/ 实验/ 过程/ 中/ 需要/ 充分考虑/ 移动/ 终端/ 的/ 处理/ 能力/ ,/ 所以/ 选择/ 一个/ 合适/ 的/ 通讯录/ 规模/ 是/ 实验/ 成功/ 的/ 前提/ ./ 信息提取/ 模块/ 的/ 功能/ 是/ 将/ 应用程序/ 返回/ 的/ 一系列/ 用户/ 账户/ 及其/ 个人资料/ 从/ 移动/ 终端/ 系统/ 中/ 提取/ 出来/ ./ 该/ 模块/ 是/ 系统/ 的/ 核心/ ,/ 其/ 难点/ 在于/ 需要/ 考虑/ 终端/ 系统/ 的/ 资源/ 保护/ 机制/ ,/ 例如/ 沙盒/ 、/ 权限/ 机制/ 等/ ./ 最后/ ,/ 数据分析/ 模块/ 负责/ 对/ 从/ 信息提取/ 模块/ 提取/ 出/ 的/ 信息/ 进行/ 分析/ 处理/ ,/ 具体/ 的/ 处理过程/ 和/ 实验/ 结果/ 将/ 在/ 第/ 4/ 节/ 给出/ ./ 出于/ 安全/ 考虑/ ,/ 移动/ 终端/ 中/ 的/ 应用/ 数据/ 受/ 系统/ 保护/ 且/ 不/ 允许/ 其它/ 非/ 授权/ 应用/ 或者/ 进程/ 进行/ 访问/ ,/ 例如/ ,/ iOS/ 系统/ 的/ 沙盒/ 机制/ 和/ Android/ 系统/ 基于/ 权限/ 的/ 严格/ 访问控制/ 机制/ ./ 所以/ ,/ 具体/ 到/ 不同/ 的/ 平台/ ,/ 信息提取/ 的/ 方法/ 随着/ 平台/ 特性/ 的/ 不同/ 而/ 有所不同/ ./ 值得注意/ 的/ 是/ ,/ 本文/ 提出/ 的/ 利用/ 通讯录/ 匹配/ 功能/ 获取/ 用户/ 个人信息/ 的/ 方法/ 将/ 适用/ 于/ 所有/ 具备/ 该/ 功能/ 的/ 社交/ 通信/ 类/ 应用/ ,/ 而/ 与/ 具体/ 的/ 移动/ 系统/ 平台/ 无关/ ./ 本文/ 实现/ 的/ 原型/ 系统/ 基于/ 时/ 下/ 流行/ 的/ 智能/ 终端/ 系统/ Android/ 系统/ ,/ 作此/ 选择/ 主要/ 出于/ 以下/ 3/ 点/ 考虑/ :/ 首先/ ,/ 近年来/ 搭载/ Android/ 系统/ 的/ 移动/ 设备/ 的/ 销量/ 增长/ 迅速/ ,/ 市场占有率/ 大幅/ 提升/ ,/ 将/ Android/ 系统/ 作为/ 目标/ 系统/ 具有/ 更/ 广泛/ 的/ 应用/ 价值/ ;/ 其次/ ,/ 由于/ Android/ 设备/ 被/ 广泛/ 接纳/ ,/ 各个/ 应用/ 开发商/ 都/ 纷纷/ 推出/ 了/ 各自/ 应用/ 的/ Android/ 版本/ ,/ 选择/ Android/ 系统/ 不会/ 出现/ 应用/ 集合/ 覆盖面/ 不足/ 的/ 情况/ ;/ 最后/ 更/ 重要/ 的/ 是/ ,/ Android/ 系统/ 作为/ 一个/ 开源/ 软件/ 项目/ ,/ 极大/ 方便/ 了/ 本文/ 原型/ 系统/ 的/ 设计/ 和/ 实现/ ./ 在/ Android/ 系统/ 中/ ,/ 每/ 一个/ 应用/ 都/ 运行/ 在/ 单独/ 的/ Dalvik/ 虚拟机/ 中/ ,/ 这种/ 机制/ 是/ 为了/ 保证系统/ 中/ 运行/ 的/ 各/ 应用/ 之间/ 的/ 隔离/ 性/ ./ 每/ 一个/ Android/ 应用/ 的/ 组件/ ,/ 例如/ ContentProvider/ ,/ 都/ 具有/ 被/ 自身/ 或/ 其它/ 应用/ 调用/ 的/ 入口/ ./ 然而/ ,/ Android/ 系统/ 实现/ 的/ 权限/ 机制/ 有效/ 地/ 防止/ 了/ 肆意/ 调用/ 其它/ 应用/ 组件/ 的/ 情况/ ,/ 这/ 同时/ 也/ 意味着/ 寄宿/ 在/ 目标/ 应用/ 中/ 的/ 数据/ 将/ 无法/ 从/ 应用程序/ 外部/ 直接/ 访问/ ,/ 从而/ 给/ 本文/ 的/ 用户/ 资料/ 信息提取/ 工作/ 带来/ 巨大/ 的/ 挑战/ ./ 为了/ 提供/ 一种/ 可扩展性/ 良好/ 且/ 通用/ 的/ 解决方案/ ,/ 即/ 尽量避免/ 针对/ 不同/ 的/ 社交/ 通信/ 类/ 应用程序/ 需要/ 实现/ 不同/ 用户/ 资料/ 提取/ 方案/ ,/ 本文/ 采用/ 了/ 一种/ 独立/ 于/ 具体/ 应用/ 的/ 解决方案/ ./ Android/ 架构/ 拥有/ 一套/ 可/ 重用/ 的/ 应用程序/ 访问/ 接口/ (/ AndroidAPI/ )/ ,/ 该接/ Page7/ 口/ 封装/ 了/ 一系列/ 的/ Linux/ 系统/ 级/ 调用/ ./ 由于/ 任何/ 基于/ Android/ 系统/ 的/ 应用/ 在/ 开发/ 时/ 都/ 会/ 涉及/ 到/ AndroidAPI/ 的/ 调用/ ,/ 因此/ 本文/ 将/ 采用/ 动态/ 监控/ API/ 的/ 方法/ 来/ 提取/ 寄宿/ 于/ 应用/ 当中/ 的/ 用户/ 资料/ 数据/ ./ 如图/ 2/ 所示/ ,/ 信息提取/ 模块/ 位于/ Android/ 框架/ 层/ ./ 通过/ 通讯录/ 匹配/ 从/ 目标/ 应用服务器/ 返回/ 的/ 用户/ 账户/ 及/ 个人资料/ 是/ 实验所/ 需/ 的/ 目标/ 数据/ ,/ 当/ 目标/ 应用/ 将/ 这些/ 数据/ 显示/ 到/ 屏幕/ 时/ ,/ 需要/ 调用/ 与/ 在/ 设备/ 屏幕/ 上/ 显示/ 文本/ 数据/ 相关/ 的/ AndroidAPI/ ,/ 如/ setText/ (/ )/ ./ 所以/ ,/ 通过/ 修改/ Android/ 系统/ 代码/ ,/ 监控/ 这些/ 与/ 显示/ 数据/ 相关/ 的/ AndroidAPI/ 调用/ 及其/ 参数/ 并/ 记录/ 所有/ 经由/ 这些/ API/ 处理/ 的/ 信息/ ,/ 就/ 能够/ 记录/ 下/ 所有/ 被/ 显示/ 到/ 设备/ 屏幕/ 上/ 的/ 用户/ 数据/ ./ 最后/ ,/ 通过/ 重/ 放/ 一系列/ “/ sendevent/ ”/ ADB/ 命令/ 模拟/ 用户/ 的/ 浏览/ 动作/ ,/ 以/ 保证/ 每个/ 返回/ 的/ 用户/ 账户/ 及/ 个人账户/ 信息/ 都/ 被/ 信息提取/ 模块/ 过滤/ 并/ 保存/ ,/ 从而/ 实现/ 了/ 整个/ 用户/ 资料/ 数据/ 提取/ 过程/ 的/ 自动化/ ./ 4/ 实验/ 与/ 数据分析/ 本节/ 将/ 详细/ 阐述/ 利用/ 社交/ 通信/ 类/ 应用/ 通讯录/ 匹配/ 功能/ 获取/ 用户/ 应用/ 账户/ 数据/ 的/ 实验/ 过程/ 和/ 用户/ 应用/ 账户/ 数据/ 的/ 分析/ 结果/ ./ 由于/ 实验/ 可能/ 会/ 涉及/ 到/ 用户/ 隐私/ 问题/ ,/ 遂/ 在/ 此/ 做出/ 必要/ 的/ 隐私/ 尊重/ 与/ 保护/ 说明/ ./ 相对/ 于/ 其它/ 的/ 方法/ ,/ 从/ 真实世界/ 中/ 获得/ 用户/ 数据/ 进行/ 实验/ 能够/ 最/ 有效/ 、/ 最/ 直接/ 地/ 验证/ 本文/ 提出/ 的/ 思想/ 和/ 方法/ ./ 然而/ 这些/ 真实/ 的/ 用户/ 数据/ 在/ 一定/ 程度/ 上/ 也/ 触及/ 到/ 了/ 用户/ 隐私/ ,/ 因此/ 如何/ 有效/ 地/ 保护/ 实验/ 获取/ 的/ 真实/ 的/ 用户/ 数据/ 是/ 开展/ 此项工作/ 前/ 必须/ 考虑/ 的/ 问题/ ./ 事实上/ ,/ 在/ 此前/ 的/ 研究/ 项目/ 中/ ,/ 不少/ 研究/ 人员/ 也/ 遇到/ 过/ 同样/ 的/ 问题/ [/ 1/ -/ 2/ ]/ ,/ 人们/ 普遍认为/ 基于/ 真实世界/ 数据/ 的/ 实验/ 能够/ 提供/ 更具/ 说服力/ 的/ 实验/ 结果/ ./ 针对/ 实验/ 过程/ 中/ 涉及/ 到/ 的/ 用户/ 隐私/ 信息/ ,/ 本文/ 将/ 采用/ 必要措施/ ,/ 最大/ 限度/ 地/ 保证/ 这些/ 信息/ 仅/ 被/ 用于/ 本/ 工作/ 的/ 实验/ 过程/ 中/ ,/ 具体来说/ :/ 第一/ ,/ 禁止/ 用户/ 资料/ 信息/ 被/ 扩散/ 至/ 实验/ 设备/ 以外/ ,/ 同时/ 也/ 不/ 提供/ 任何/ 信息/ 给/ 任何/ 不/ 相关/ 的/ 个人/ 或/ 机构/ ;/ 第二/ ,/ 除/ 本文/ 展示/ 的/ 实验/ 内容/ 和/ 数据/ 外/ ,/ 作者/ 将/ 不会/ 使用/ 获取/ 的/ 用户/ 资料/ 信息/ 实施/ 进一步/ 的/ 渗透/ 攻击/ ./ 4.1/ 单/ 应用/ 分析/ 单/ 应用/ 分析/ 主要/ 针对/ 单独/ 一款/ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 利用/ 进行/ 分析/ ./ 实验/ 环境/ 部署/ 在/ Ubuntu12/ ./ 04/ 系统/ 中/ ,/ 应用/ 运行/ 环境/ 为/ Android/ 模拟器/ ,/ Android/ 版本/ 4.2/ ./ 这里/ 选取/ 市场/ 上/ 非常/ 流行/ 的/ 一款/ 社交/ 通信/ 类/ 应用/ 微信/ (/ 版本/ 4.2/ ,/ Android/ )/ 作为/ 分析/ 对象/ ./ 微信/ 是/ 由/ 腾讯/ 公司/ 开发/ 的/ 一款/ 跨平台/ 通信/ 工具/ ,/ 能够/ 支持/ 文字/ 、/ 图片/ 、/ 语音/ 短信/ 和/ 视频/ 等/ 多媒体信息/ ,/ 并/ 具有/ 各种/ 移动/ 终端/ 系统/ 平台/ 下/ 的/ 版本/ ,/ 包括/ iOS/ ,/ Android/ ,/ WindowsPhone/ ,/ Symbian/ 和/ BlackBerry/ 等/ ./ 据统计/ ,/ 截至/ 2013/ 年/ 1/ 月/ 微信/ 用户数量/ 已经/ 超过/ 了/ 3/ 亿/ ./ 根据/ 3.1/ 节/ 阐述/ 的/ 内容/ ,/ 单/ 应用/ 分析/ 的/ 第一步/ 是/ 伪造/ 候选/ 通讯录/ ./ 候选/ 通讯录/ 中/ 主要/ 包含/ 目标/ 用户/ 的/ 手机号码/ 和/ 姓名/ ,/ 其中/ 姓名/ 仅/ 用于/ 唯一/ 标识/ 每/ 一个/ 目标/ 用户/ ,/ 所以/ 这一/ 步骤/ 的/ 重点/ 在于/ 选取/ 合适/ 的/ 手机号码/ ./ 中国/ 大陆/ 的/ 手机号码/ 是/ 由/ 国际/ 电话/ 区位码/ +/ 86/ 和/ 一串/ 11/ 位/ 的/ 数字/ 组成/ ./ 实验/ 中/ 由/ 通讯录/ 伪造/ 模块/ 生成/ 的/ 手机号码/ 段/ 为/ :/ +/ 861521063/ 至/ +/ 861521070/ 和/ +/ 861521098/ 至/ +/ 861521099/ ./ 接下来/ ,/ 整个/ 实验/ 在/ 配置/ 了/ 3.2/ 节/ 所述/ 的/ 原型/ 系统/ 和/ 微信/ (/ 需/ 预先/ 注册/ 一个/ 实验/ 用/ 的/ 微信/ 账号/ )/ 的/ 模拟器/ 上/ 完成/ ./ 首先/ ,/ 在/ 微信/ 中/ 绑定/ 测试/ 手机号码/ 与/ 微信/ 实验/ 账号/ ,/ 并/ 开启/ 通讯录/ 匹配/ 功能/ ,/ 然后/ 导入/ 伪造/ 通讯录/ 文件/ ./ 微信/ 的/ 通讯录/ 匹配/ 功能/ 会/ 将/ 伪造/ 通讯录/ 上/ 传到/ 应用服务器/ ,/ 随后/ 便/ 开始/ 向/ 用户/ 推荐/ 一系列/ 微信/ 用户/ 账户/ 以及/ 对应/ 的/ 账户/ 信息/ ,/ 这些/ 账户/ 已经/ 与/ 上传/ 的/ 伪造/ 通讯录/ 中/ 的/ 手机号码/ 进行/ 过/ 绑定/ ./ 在/ 这些/ 推荐/ 账号/ 呈现/ 在/ 微信/ 程序界面/ 时/ ,/ 系统/ 中/ 的/ 信息提取/ 模块/ 已/ 记录/ 下/ 所有/ 返回/ 的/ 用户/ 信息/ ,/ 形成/ 了/ 用户/ 初步/ 资料/ ./ 用户/ 初步/ 资料/ 包括/ 与/ 伪造/ 通讯录/ 中/ 手机号码/ 绑定/ 的/ 所有/ 微信/ 账户/ ,/ 这些/ 账户/ 与/ 对应/ 的/ 手机号码/ 形成/ 了/ 一一/ 映射/ ./ 微信/ 账户/ 个人资料/ 包含/ 5/ 个/ 字/ 段/ ,/ 即/ 微信/ 账户/ ID/ 、/ 用户名/ 、/ 性别/ 、/ 所在/ 地区/ 和/ 个性/ 签名/ ./ 通常/ 用户/ 名字/ 段/ 已经/ 能够/ 让/ 好友/ 确定/ 账户/ 所属/ 者/ 的/ 身份/ ./ 用户名/ 通常/ 会/ 由/ 与/ 用户/ 真实/ 姓名/ 有关/ 的/ 字符/ 组成/ ,/ 甚至/ 就是/ 用户/ 真实/ 姓名/ 本身/ ./ 用户/ 使用/ 自己/ 真实/ 姓名/ 作为/ 用户名/ 是/ 为了/ 方便/ 被/ 好友/ 查询/ 和/ 识别/ ,/ 而/ 通常/ 不会/ 意识/ 到/ 这些/ 信息/ 是否/ 会/ 被/ 陌生人/ 获取/ ./ Page8/ 手机号码/ 段/ 返回/ 账户/ 数量/ 手机号码/ 段/ 返回/ 账户/ 数量/ +/ 8615210631531/ +/ 8615210681449/ +/ 8615210641469/ +/ 8615210691486/ +/ 8615210651390/ +/ 8615210700/ +/ 8615210661463/ +/ 8615210981936/ +/ 8615210671603/ +/ 8615210991852/ 本文/ 伪造/ 的/ 通讯录/ 总共/ 包含/ 100000/ 个/ 手机号码/ ,/ 通过/ 微信/ 的/ 通讯录/ 匹配/ 功能/ 成功/ 返回/ 了/ 14179/ 个/ 账户/ 及/ 对应/ 的/ 个人信息/ ./ 可见/ 实验/ 中/ 的/ 用户/ 渗透率/ 为/ 14.18/ %/ ,/ 这一/ 数字/ 与/ 实验/ 同期/ (/ 2012/ 年/ 11/ 月/ )/ 的/ 中国/ 互联网/ 信息中心/ (/ CNNIC/ )/ 公布/ 的/ 网民/ 微信/ 使用/ 调查结果/ 基本一致/ (/ 13.73/ %/ )/ ①/ ,/ 进一步/ 说明/ 了/ 本文/ 的/ 样本/ 具有/ 较/ 好/ 的/ 代表性/ ./ 返回/ 的/ 微信/ 账户/ 数量/ 在/ 对应/ 的/ 手机号码/ 段/ 中/ 的/ 分布/ 情况/ 如表/ 1/ 所示/ ./ 注意/ 到/ +/ 861521070/ 号码/ 段/ 没有/ 任何/ 对应/ 账号/ 返回/ ./ 经过/ 后期/ 调查/ ,/ 能够/ 确定/ 该/ 号码/ 段/ 目前/ 处于/ 空闲/ 状态/ ,/ 尚未/ 启用/ ./ 下面/ 对/ 返回/ 的/ 微信/ 账户/ 资料/ 的/ 各个/ 字/ 段/ 进行/ 分析/ ./ 从/ 返回/ 的/ 用户/ 数据/ 可以/ 看到/ 并/ 不是/ 所有/ 用户/ 都/ 完整/ 地/ 填写/ 了/ 账户/ 个人资料/ ./ 对于/ 一个/ 账户/ ,/ 首先/ 能/ 确定/ 的/ 是/ 账户/ 所属/ 者/ 的/ 手机号码/ ,/ 此外/ 由于/ 微信/ ID/ 字段/ 和/ 用户/ 名字/ 段/ 在/ 用户注册/ 时/ 都/ 是/ 必填/ 字/ 段/ ,/ 因此/ 这/ 两个/ 字段/ 的/ 完整/ 率为/ 100/ %/ ,/ 另外/ 3/ 项可选/ 填字/ 段/ (/ 性别/ 、/ 所在/ 地区/ 和/ 个性/ 签名/ )/ 的/ 完整/ 度/ 统计/ 如表/ 2/ 所示/ ./ 可以/ 看出/ 全部/ 5/ 项/ 资料/ 都/ 填写/ 完整/ 的/ 用户/ 比例/ 超过/ 了/ 一半/ (/ 55.13/ %/ )/ ,/ 而/ 不/ 填写/ 任何/ 可/ 选/ 资料/ 的/ 用户/ 占/ 总/ 人数/ 的/ 12.43/ %/ ./ 需要/ 注意/ 的/ 是/ ,/ 即使/ 用户/ 不/ 填写/ 任何/ 可/ 选/ 资料/ ,/ 攻击者/ 也/ 能够/ 获取/ 其微信/ ID/ 、/ 用户名/ 和/ 手机号码/ 等/ 关键/ 信息/ ./ 可选/ 资料/ 字/ 段/ 数目/ 填写/ 的/ 用户数量/ 完整/ 度/ 比例/ // %/ 对于/ 每个/ 可/ 选字/ 段/ ,/ 本文/ 也/ 进一步/ 确定/ 了/ 这些/ 字段/ 的/ 填写/ 情况/ (/ 表/ 3/ )/ ./ 可以/ 看到/ ,/ 性别/ 和/ 地区/ 的/ 填写/ 比例/ 都/ 在/ 85/ %/ 左右/ ,/ 而/ 个性/ 签名/ 的/ 完整/ 度为/ 57.86/ %/ ,/ 低于/ 其它/ 2/ 项/ 比例/ 值/ ./ 可选/ 资料/ 字/ 段/ 填写/ 的/ 用户数量/ 完整/ 度/ 比例/ // %/ 性别/ 地区/ 个性/ 签名/ 4.2/ 跨/ 应用/ 分析/ 跨/ 应用/ 分析/ 主要/ 针对/ 多款/ 社交/ 通信/ 类/ 应用/ 进行/ 分析/ ,/ 其/ 目的/ 在于/ 收集/ 同一/ 用户/ 在/ 不同/ 应用/ 平台/ 注册/ 的/ 账户/ 资料/ ./ 除微/ 信外/ ,/ 实验/ 中/ 选择/ 另/ 一款/ 流行/ 的/ 社交/ 通信/ 类/ 应用/ “/ 米/ 聊/ ”/ ②/ 作为/ 分析/ 对象/ ./ 米/ 聊/ 是/ 小米/ 科技/ 公司出品/ 的/ 一款/ 跨平台/ 的/ 通信/ 工具/ ./ 与/ 微信/ 类似/ ,/ 米/ 聊/ 也/ 支持/ 市场/ 上/ 大部分/ 主流/ 手机操作系统/ ,/ 并/ 支持/ 文字/ 、/ 语音/ 和/ 图片/ 等/ 多媒体通信/ ./ 据米/ 聊/ 官方/ 公布/ 的/ 数据/ 显示/ ,/ 截至/ 2013/ 年/ 1/ 月/ ,/ 米/ 聊/ 注册/ 用户/ 已经/ 达到/ 2300/ 万/ ,/ 是/ 目前/ 国内/ 最大/ 的/ 社交/ 通信/ 类/ 应用/ 之一/ ./ 米/ 聊/ 作为/ 基于/ 手机/ 通讯录/ 的/ 强/ 联系/ 社交/ 入口/ ,/ 同样/ 具有/ 推荐/ 用户/ 通讯录/ 好友/ 功能/ ./ 本文/ 使用/ 米/ 聊/ Android/ 版本/ 5.0/ ./ 565/ 进行/ 实验/ ./ 米/ 聊/ 的/ 通讯录/ 好友/ 推荐/ 机制/ 与/ 微信/ 的/ 略有不同/ ,/ 米/ 聊/ 实现/ 了/ 应用程序/ 与/ 通讯录/ 间/ 的/ 无缝/ 对接/ ,/ 在/ 通讯录/ 匹配/ 返回/ 推荐/ 好友/ 后/ ,/ 米/ 聊/ 一方面/ 会/ 直接/ 发送/ 好友/ 请求/ 至/ 被/ 推荐/ 的/ 好友/ 账户/ ,/ 另一方面/ 会/ 将/ 这些/ 好友/ 账户/ 直接/ 添加/ 至/ 用户/ 的/ “/ 已/ 添加/ 好友/ ”/ 列表/ ./ 4.2/ ./ 1/ 横向/ 整合/ 根据/ 4.1/ 节中表/ 1/ 显示/ 的/ 各个/ 手机号码/ 段/ 绑定/ 微信/ 账户/ 的/ 情况/ ,/ 实验/ 中/ 选择/ 返回/ 账户/ 数量/ 最多/ 的/ 3/ 个/ 号码/ 段/ 构造/ 候选/ 通讯录/ ,/ 分别/ 为/ +/ 861521098/ ,/ +/ 861521099/ 和/ +/ 861521067/ ,/ 共/ 覆盖/ 30000/ 个/ 手机号码/ ./ 随后/ 利用/ 米/ 聊/ 的/ 通讯录/ 匹配/ 漏洞/ 收集/ 米/ 聊/ 用户/ 的/ 账户/ 资料/ ,/ 最终/ 成功/ 返回/ 了/ 955/ 个/ 与/ 候选/ 通讯录/ 中/ 手机号码/ 绑定/ 的/ 米/ 聊/ 账户/ (/ 表/ 4/ )/ ./ 通过观察/ 收集/ 到/ 的/ 米/ 聊/ 账户/ ,/ 发现/ 米/ 聊/ 用户/ 的/ 账户/ 资料/ 比微信/ 更加/ 丰富/ ,/ 包括/ 的/ 字/ 段/ 有/ 名称/ 、/ 性别/ 、/ 生日/ 、/ 照片/ 链接/ 、/ 地区/ 、/ 学校/ 和/ 公司/ 等/ ./ 几乎/ 所有/ 返回/ 的/ 用户/ 都/ 至少/ 拥有/ 一个/ 照片/ URL/ 链接/ ./ 另外/ ,/ 近/ 30/ %/ 的/ 用户/ 填写/ 了/ 所在/ 学校/ 和/ 公司/ 信息/ ,/ 这些/ 信息/ 对于/ 攻击者/ 来说/ 都/ 具有/ 很/ 好/ 的/ 利用/ 价值/ ./ 如/ 3.1/ ./ 1/ 节/ 所述/ ,/ 横向/ 整合/ 可以/ 分为/ 两类/ ,/ 即广/ 并/ 和/ 深交/ ./ 其中/ ,/ 跨/ 应用/ 的/ 广/ 并/ 能够/ 收集/ 更/ 多/ 数量/ 的/ 不同/ 应用/ 下/ 的/ 目标/ 用户/ 账户/ ,/ 例如/ ,/ 对比/ 4.1/ 节/ 针对/ 微信/ 的/ 单/ 应用/ 分析/ 结果/ ,/ 实验/ 中/ 通过/ 米/ 聊/ 的/ 通讯录/ ①/ ②/ Page9/ 匹配/ 漏洞/ 又/ 收集/ 到/ 348/ 个/ 新增/ 的/ 手机号码/ 和/ 对应/ 的/ 米/ 聊/ 账户/ ./ 通过/ 跨/ 应用/ 的/ 广/ 并/ 操作/ ,/ 实验/ 一共/ 获得/ 了/ 两个/ 应用/ 中/ 的/ 5739/ 个/ 用户/ 账户/ 和/ 对应/ 的/ 手机号码/ ./ 另一方面/ ,/ 就/ 深交/ 而言/ ,/ 通过/ 对比/ 从/ 两个/ 应用/ 收集/ 到/ 的/ 账户/ 信息/ ,/ 发现/ 了/ 607/ 个/ 在/ 两个/ 应用/ 中/ 使用/ 相同/ 的/ 手机号码/ 绑定/ 的/ 账户/ ,/ 然后/ 通过/ 整合/ 这些/ 用户/ 在/ 两个/ 应用/ 中/ 的/ 用户/ 资料/ 字/ 段/ ,/ 便/ 获得/ 了/ 这些/ 用户/ 更/ 全面/ 的/ 个人信息/ ./ 4.2/ ./ 2/ 纵向/ 渗透/ 纵向/ 渗透/ 主要/ 应用/ 于/ 多个/ 应用程序/ 或者/ 服务/ 之间/ 共享/ 相同/ 用户/ 登录/ 数据库/ 的/ 场景/ ./ 例如/ ,/ 作为/ 一款/ 广泛/ 流行/ 的/ 即时通讯/ 工具/ ,/ QQ/ 软件/ 和/ 微信/ 平台/ 都/ 是/ 腾讯/ 公司/ 旗下/ 的/ 社交/ 应用/ 产品/ ./ 鉴于/ 共属/ 同一个/ 开发商/ ,/ 它们/ 共享/ 相同/ 的/ 用户/ 登录/ 认证/ 数据库/ ,/ 表现/ 出/ 用户/ 能够/ 通过/ 自己/ 的/ QQ/ 账号/ 和/ 密码/ 来/ 登录/ 微信/ 平台/ ./ 类似/ 的/ ,/ 这种/ 关系/ 同样/ 存在/ 于/ 小米/ 科技/ 公司/ 旗下/ 的/ 小米/ 手机/ 社区/ 官方论坛/ 和/ 米/ 聊/ 平台/ 之间/ ./ 跨平台/ 账户/ 共享/ 一方面/ 简化/ 了/ 用户/ 对/ 各种/ 应用/ 账号/ 的/ 管理/ ,/ 另一方面/ 也/ 方便/ 了/ 开发商/ 管理/ 自己/ 的/ 用户/ ,/ 同时/ 还/ 帮助/ 开发商/ 拓展/ 其老/ 用户/ 到/ 新/ 的/ 应用/ 平台/ ./ 纵向/ 渗透/ 攻击/ 就/ 利用/ 了/ 跨平台/ 账户/ 共享/ 特性/ ,/ 目的/ 在于/ 通过/ 已经/ 收集/ 的/ 关于/ 某个/ 应用/ 的/ 用户/ 账户/ 信息/ ,/ 来/ 进一步/ 发掘/ 另/ 一款/ 共享/ 相同/ 账户/ 登录/ 数据库/ 的/ 应用/ 中/ 对应/ 的/ 用户/ 账户/ 信息/ ,/ 以/ 获得/ 对/ 用户/ 更/ 丰富/ 的/ 了解/ ./ 下面/ 通过/ 一个/ 具体/ 的/ 案例/ 阐述/ 纵向/ 渗透/ 攻击/ 的/ 原理/ 和/ 步骤/ ./ 首先/ ,/ 从/ 深交/ 集合/ 中/ 选取/ 一条/ 记录/ ,/ 每条/ 记录/ 包含/ 每个/ 用户/ 在/ 不同/ 应用/ (/ 微信/ 和/ 米/ 聊/ )/ 中/ 填写/ 的/ 账户/ 资料/ ,/ 这里/ 选取/ 的/ 用户/ 的/ 手机号码/ 为/ “/ 152/ / / / / / / 56/ ”/ ,/ 微信/ ID/ 为/ “/ q76/ / / / / 74/ ”/ ,/ 米/ 聊/ ID/ 为/ “/ 47/ / / / 49/ ”/ ,/ 星号/ 字符/ 表示/ 被/ 隐去/ 的/ 部分/ 数字/ ./ 考虑/ 到/ 微信/ 平台/ 和/ QQ/ 软件/ 的/ 同源性/ ,/ 可以/ 推断/ 该/ 用户/ 微信/ ID/ 号/ 的/ 后/ 8/ 位/ 数字/ 很/ 可能/ 是/ 该/ 用户/ 的/ QQ号/ 码/ ./ 为了/ 验证/ 此/ 推测/ ,/ 将/ 此/ 8/ 位/ 数字串/ 作为/ 查询/ 输入/ ,/ 通过/ QQ/ 软件/ 的/ 账号/ 查询/ 功能/ 进行/ 查询/ ./ 查询/ 结果/ 成功/ 返回/ 了/ 一位/ 匹配/ 用户/ ,/ 通过/ “/ 查看/ 个人资料/ ”/ 面板/ 可以/ 了解/ 到/ 该/ 账号/ 的/ 主人/ 是/ 一位/ 1983/ 年/ 6/ 月/ 20/ 日/ 出生/ 的/ 女性/ ,/ 故乡/ 是/ 黑龙江省/ 大庆市/ ,/ 现居/ 北京市/ ,/ 姓名/ 备注/ 一栏/ 填写/ 的/ 内容/ 是/ “/ LMX/ ”/ ,/ 由于/ 从米/ 聊/ 获得/ 的/ 用户名/ 拼音/ 首字母/ 缩写/ 也/ 为/ “/ LMX/ ”/ ,/ 推测/ 该/ 备注/ 为/ 用户/ 姓名/ 的/ 拼音/ 缩写/ ./ 此外/ ,/ 通过/ 访问/ 该/ 用户/ 在/ 个人资料/ 中/ 提供/ 的/ 个人主页/ 网址/ ,/ 发现/ 该/ 用户/ 主页/ 上/ 有/ 24/ 篇/ 日志/ ,/ 377/ 张/ 照片/ ./ 从/ 这些/ 信息/ 中/ 进一步/ 了解/ 到/ 该/ 用户/ 的/ 职位/ 、/ 工作/ 的/ 单位/ 和/ 地址/ ,/ 以及/ 个人/ 的/ 兴趣爱好/ 等/ 信息/ ./ 最终/ ,/ 成功/ 在/ 相册/ 中/ 发现/ 了/ 与其/ 米/ 聊/ 账户/ 头像/ 相同/ 的/ 照片/ ,/ 从而/ 证实/ 了/ 上述/ 阐述/ 的/ 所有/ 信息/ 都/ 属于/ 同一个/ 用户/ ./ 另外/ ,/ 通过/ QQ/ 软件/ 和/ 小米/ 手机/ 社区/ 官方论坛/ 提供/ 的/ 找回/ 账户/ 密码/ 服务/ ,/ 也/ 可以/ 进一步/ 确定/ 该/ 账户/ 绑定/ 的/ 手机号码/ 的/ 部分/ 特征/ (/ 找回/ 密码/ 服务/ 页面/ 通常/ 会/ 显示/ 目标/ 用户/ 手机号码/ 的/ 部分/ 确定/ 数字/ ,/ 其它/ 部分/ 则/ 用/ 星号/ 字符/ 代替/ )/ ,/ 因此/ 更加/ 确定/ 了/ 该/ 用户/ 的/ 存在/ ./ 这样/ ,/ 通过/ 一次/ 完整/ 的/ 纵向/ 渗透/ 攻击/ 就/ 成功/ 地/ 获取/ 了/ 目标/ 用户/ 在/ 多个/ 应用/ 平台/ 中/ 留下/ 的/ 更加/ 全面/ 的/ 个人资料/ ./ 上述/ 纵向/ 渗透/ 的/ 具体/ 流程/ 及/ 获取信息/ 内容/ 如图/ 3/ 所示/ ./ 可以/ 看出/ ,/ 首先/ 针对/ 特定/ 的/ 应用/ 平台/ 利用/ 本文/ 提出/ 的/ 通讯录/ 匹配/ 漏洞/ ,/ 攻击者/ 可以/ 获取/ 目标/ 用户/ 的/ 手机号码/ 与其/ 应用/ 账号/ 间/ 的/ 映射/ 关系/ ,/ 然后/ 通过/ 跨/ 应用/ 的/ 横向/ 整合/ 继而/ 获得/ 了/ 目标/ 用户/ 多个/ 应用/ 账户/ 及/ 资料/ ,/ 最后/ 基于/ 同源/ 应用/ 平台/ 的/ 纵向/ 渗透/ 攻击/ 为/ 攻击者/ 提供/ 了/ 关于/ 目标/ 用户/ 更为/ 详细/ 和/ 全面/ 的/ 个人资料/ ,/ 这种/ 攻击/ 过程/ 呈现出/ 逐步/ 深入/ 递进/ 的/ 特性/ ./ 虽然/ 纵向/ 渗透/ 目前/ 主要/ 依靠/ 人工/ 完成/ ,/ 但/ 从/ 纵向/ 渗透/ 的/ 效果/ 来看/ ,/ 人工/ 分析/ 是/ 必要/ 且/ 很/ 有/ 价值/ 的/ ./ 此外/ ,/ 人工/ 分析/ 的/ 步骤/ 很/ 容易/ 标准化/ ,/ 这/ 将/ 进一步提高/ 纵向/ 渗透/ 攻击/ 的/ 实施/ 效率/ ./ 另外/ ,/ 在/ 本文/ 测试/ 的/ 其它/ 纵向/ 渗透/ 案例/ 中/ ,/ 还遇/ Page10/ 到/ 一种/ 情况/ 是/ 在/ 访问/ 目标/ 用户/ 的/ 个人主页/ 时/ 被/ 提示/ 回答/ 用户/ 预设/ 的/ 主页/ 访问控制/ 问题/ ,/ 例如/ “/ 我/ 的/ 真实/ 姓名/ 是/ ?/ ”/ ,/ 这种/ 问题/ 主要/ 用于/ 确保/ 访问/ 人群/ 为/ 自己/ 相识/ 的/ 人/ (/ 一般/ 假设/ 与/ 自己/ 相识/ 的/ 人会/ 知道/ 自己/ 的/ 姓名/ )/ ./ 而/ 这时/ 通过/ 4.2/ ./ 1/ 节/ 所述/ 的/ 横向/ 整合/ 多个/ 应用/ 提供/ 的/ 更加/ 详细/ 和/ 确定/ 的/ 用户/ 信息/ 可以/ 提供/ 极大/ 的/ 帮助/ ,/ 从而/ 使得/ 陌生人/ 能够/ 突破/ 预设/ 主页/ 问答/ 的/ 限制/ ,/ 给/ 用户/ 造成/ 了/ 极大/ 的/ 隐私/ 泄露/ ./ 4.3/ 一致性/ 与/ 真实性/ 分析/ 在/ 跨/ 应用/ 分析/ 中/ ,/ 不同/ 的/ 应用程序/ 返回/ 的/ 用户/ 账户/ 信息/ 常常/ 会/ 拥有/ 共同/ 的/ 字/ 段/ ,/ 例如/ 用户/ 姓名/ 和/ 性别/ ,/ 而/ 针对/ 同一/ 用户/ 来说/ ,/ 其/ 在/ 不同/ 应用/ 注册/ 的/ 个人信息/ 可能/ 会/ 不/ 一致/ ,/ 甚至/ 出现/ 相互/ 矛盾/ ./ 这种/ 情况/ 的/ 出现/ 说明/ 用户/ 提供/ 的/ 部分/ 信息/ 不能/ 反映/ 用户/ 的/ 真实情况/ ,/ 因此/ 需要/ 通过/ 某种/ 方法/ 辨别/ 出/ 用户/ 真实/ 的/ 个人资料/ (/ 即/ 有/ 利用/ 价值/ 的/ 资料/ )/ ,/ 本/ 小节/ 根据/ 3.1/ ./ 3/ 中/ 的/ 方法/ 进行/ 跨/ 应用环境/ 下/ 的/ 用户/ 信息/ 一致性/ 分析/ 与/ 真实性/ 分析方法/ 进行/ 相关/ 实验/ 分析/ ,/ 下面/ 通过/ 两个/ 典型/ 的/ 实例/ 来/ 进行/ 阐述/ ./ 第/ 1/ 个/ 实例/ 针对/ 用户/ 账户/ 中/ 的/ 非/ 类别/ 字/ 段/ 进行/ 一致性/ 与/ 真实性/ 分析/ ,/ 这里/ 以/ “/ 用户名/ ”/ 为例/ ./ 在/ 一致性/ 方面/ ,/ 根据/ 4.2/ 节/ 阐述/ 的/ 跨/ 应用/ 分析/ 的/ 结果/ ,/ 可以/ 发现/ 34.02/ %/ 的/ 用户/ 在/ 两个/ 应用程序/ 中/ 拥有/ 的/ 用户名/ 是/ 相近/ 的/ (/ 共同/ 字符/ 至少/ 占/ 较/ 短/ 用户名/ 的/ α/ 以上/ ,/ 这里/ α/ 取/ 0.5/ )/ ./ 基于/ 两个/ 应用/ 中/ 存在/ 的/ 用户名/ 不/ 一致/ 情况/ ,/ 本文/ 的/ 用户名/ 真实性/ 分析/ 采用/ 模式匹配/ 的/ 方法/ 来/ 确定/ 用户名/ 是否/ 可能/ 为/ 用户/ 真实/ 的/ 姓名/ ./ 典型/ 的/ 中文/ 姓名/ 是/ 由/ 一到/ 两个/ 汉字/ 构成/ “/ 姓/ ”/ 加上/ 一到/ 两个/ 汉字/ 构成/ 的/ “/ 名/ ”/ 组成/ ./ 本文/ 借助/ 2007/ 年/ 中华人民共和国/ 公安部/ 对/ 全国/ 户籍/ 人口/ 姓名/ 的/ 最新/ 统计/ 来/ 判别/ 应用程序/ 账户/ 姓名/ 的/ 真实/ 程度/ ./ 该/ 统计/ 列出/ 了/ 全国/ 范围/ 内/ 排名/ 前/ 一百/ 的/ 最/ 常用/ 的/ 姓氏/ ,/ 这/ 一百/ 姓氏/ 总人口/ 占/ 全国/ 人口/ 的/ 84.77/ %/ ./ 实验/ 中/ 假设/ 如果/ 应用程序/ 的/ 用户名/ 是/ 以/ 上述/ 姓氏/ 列表/ 中/ 的/ 特定/ 姓氏/ 开头/ 且/ 后/ 跟/ 有/ 一到/ 两个/ 中文/ 汉字/ 一起/ 组成/ 的/ ,/ 则/ 认为/ 该/ 用户名/ 接近/ 用户/ 的/ 真实/ 姓名/ ./ 接下来/ 分别/ 针对/ 微信/ 平台/ 收集/ 的/ 数据/ 集/ 、/ 米/ 聊/ 平台/ 收集/ 的/ 数据/ 集/ 和/ 深交/ 数据/ 集/ 进行/ 了/ 用户名/ 真实性/ 分析/ ,/ 结果/ 如图/ 4/ 所示/ ./ 可以/ 看出/ ,/ 米/ 聊/ 数据/ 集中/ 用户名/ 可能/ 是/ 真实/ 姓名/ 的/ 比例/ 为/ 53.61/ %/ ,/ 远超过/ 微信/ 平台/ 的/ 31.24/ %/ ./ 这/ 是因为/ 米/ 聊/ 平台/ 的/ 产品/ 定位/ 是/ 为/ 用户/ 提供/ 一个/ 基于/ 通讯录/ 的/ 社交/ 入口/ ./ 在/ 注册/ 米/ 聊/ 账户/ 时/ ,/ 用户/ 被/ 建议/ 尽可能/ 真实/ 地/ 填写/ 个人信息/ 以/ 方便/ 联系/ 好友/ ./ 在/ 这种/ 应用/ 定位/ 的/ 引导/ 下/ ,/ 用户/ 也/ 逐渐/ 把/ 米/ 聊/ 当成/ 了/ 传统/ 短信息/ 通讯/ 的/ 替代/ ,/ 因此/ 更/ 多/ 的/ 用户/ 在/ 注册/ 米/ 聊/ 账号/ 的/ 过程/ 中/ 往往/ 会/ 使用/ 自己/ 的/ 真实/ 姓名/ 作为/ 用户名/ ,/ 从而/ 导致/ 填写/ 真实/ 用户名/ 的/ 用户/ 比例/ 大大增加/ ./ 此外/ ,/ 前/ 文/ 提到/ 米/ 聊/ 致力于/ 在/ 用户/ 的/ 应用/ 线上/ 社交圈/ 和/ 基于/ 通讯录/ 的/ 真实/ 社会关系/ 网络/ 之间/ 建立/ 一个/ 无缝/ 的/ 连接/ ,/ 这种/ 战略/ 定位/ 使得/ 用户/ 更加/ 信任/ 米/ 聊/ 中/ 的/ 好友/ ,/ 同时/ 也/ 自然/ 以为/ 自己/ 的/ 个人资料/ 将会/ 被/ 真实世界/ 中/ 的/ 朋友/ 浏览/ ,/ 这/ 也/ 是/ 米/ 聊/ 数据/ 集中/ 用户名/ 更/ 接近/ 用户/ 的/ 真实/ 姓名/ 的/ 另/ 一个/ 原因/ ./ 在/ 多个/ 社交/ 应用/ 中/ 注册/ 的/ 用户/ 往往/ 是/ 在线/ 社交/ 的/ 活跃分子/ ,/ 因此/ 他们/ 更/ 愿意/ 把/ 自己/ 的/ 真实/ 信息/ 公布出来/ ,/ 从而/ 导致/ 了/ 深交/ 集合/ 中/ 姓名/ 的/ 真实度/ 高达/ 60.96/ %/ ,/ 这个/ 结果表明/ 在/ 同时/ 使用/ 微信/ 和/ 米/ 聊/ 两种/ 平台/ 的/ 用户/ 当中/ ,/ 有/ 超过/ 一半/ 的/ 用户/ 至少/ 在/ 一个/ 应用/ 中/ 使用/ 了/ 接近/ 真实/ 姓名/ 的/ 用户名/ 进行/ 账号/ 的/ 注册/ ./ 第/ 2/ 个/ 实例/ 针对/ 用户/ 账户/ 中/ 的/ 类别/ 字/ 段/ 进行/ 一致性/ 和/ 真实性/ 分析/ ,/ 这里/ 以/ “/ 性别/ ”/ 字段/ 为例/ ./ 实验/ 过程/ 中/ 发现/ 在/ 同时/ 注册/ 了/ 微信/ 账户/ 和/ 米/ 聊/ 账户/ 的/ 用户/ 当中/ ,/ 性别/ 不/ 一致/ 的/ 情况/ 非常/ 严重/ ,/ 这种/ 现象/ 同样/ 也/ 存在/ 于/ 不同/ 类型/ 的/ 社交/ 网络/ 中/ [/ 1/ ]/ ./ 一个/ 用户/ 的/ 真实性/ 别是/ 唯一/ 的/ ,/ 然而/ 其/ 网络/ 性别/ 可以/ 不同/ ./ 实验/ 进一步/ 对/ 这种/ 不/ 一致/ 的/ 情况/ 进行/ 了/ 统计分析/ ,/ 如表/ 5/ 所示/ ./ 其中/ ,/ “/ 米/ 聊/ 男/ ,/ 微信/ 女/ ”/ 的/ 比例/ 达到/ 了/ 不/ 一致/ 情况/ 总数/ 的/ 66.37/ %/ ./ 为了/ 进一步/ 确定/ 用户/ 的/ 真实性/ 别/ ,/ 在/ 考虑/ 多个/ 应用程序/ 时/ ,/ 可以/ 采用/ “/ 胜者/ 全取/ ”/ 的/ 策略/ ,/ 即/ 选择/ 大多数/ 一致/ 的/ 内容/ 作为/ 该字/ 段/ 的/ 内容/ ,/ 然而/ 本文/ 的/ 实验/ 只/ 涉及/ 了/ 两个/ 应用/ ,/ 故/ 无法/ 采取/ 该/ 方法/ ./ 但/ 通过观察/ 可以/ 发现/ 相对/ 于/ 米/ 聊/ 来说/ ,/ 微信/ 中/ 的/ 男女/ 用户/ 比例/ 严重/ 失衡/ ,/ 结合/ 前述/ 用户名/ 真实性/ 分析/ 的/ 结果/ ,/ 可以/ 看出/ 用户/ 在/ 米/ 聊/ 上/ 提供/ 个人信息/ 资料/ 更/ 接近/ 于/ 真实情况/ ./ 同时/ 实验/ 中/ 还/ 发现/ 用户/ 姓名/ 的/ 极性/ 与/ 米/ 聊/ 性别/ 字段/ 的/ 内容/ 基本一致/ ,/ 从而/ 进一步/ 佐证/ 了/ 上述/ 观点/ ./ Page11/ 微信/ 一致性/ 和/ 真实性/ 分析/ 是/ 信息/ 整合/ 分析/ 中/ 必不可少/ 的/ 一部分/ ,/ 只有/ 分析/ 确定/ 有/ 价值/ 的/ 真实/ 数据/ 才能/ 体现/ 出/ 信息/ 整合/ 的/ 意义/ ./ 在/ 跨/ 应用/ 分析/ 中/ 通过/ 收集/ 和/ 整合/ 多个/ 应用/ 账户/ 的/ 个人资料/ ,/ 利用/ 一致性/ 和/ 真实性/ 分析/ 将/ 可以/ 获得/ 更为/ 真实/ 的/ 用户/ 个人信息/ ./ 真实/ 的/ 信息/ 具有/ 极高/ 的/ 利用/ 价值/ ,/ 无论/ 对于/ 垃圾/ 短信/ 制造者/ 发放/ 目标/ 广告/ ,/ 还是/ 在线/ 欺诈/ 攻击/ 的/ 实施/ 等/ 行为/ 都/ 是/ 非常/ 宝贵/ 的/ 前期/ 资料/ ./ 4.4/ 其它/ 应用/ 实验/ 除/ 微信/ 和/ 米/ 聊/ 这/ 两款/ 拥有/ 国内/ 用户/ 基数/ 最大/ 的/ 应用/ 之外/ ,/ 本文/ 还/ 针对/ 其它/ 6/ 款/ 社交/ 通信/ 类/ 应用/ 进行/ 了/ 分析/ ,/ 包括/ 网络/ 通话/ 应用/ Viber/ 、/ 免费/ 聊天/ 应用/ KakaoTalk/ 、/ KikMessenger/ 、/ 有信/ 、/ 开心/ 网/ 手机/ 应用/ 和/ 人人/ 网/ 手机/ 应用/ 等/ ./ 实验/ 结果/ 如表/ 6/ 所示/ ./ 应用/ 名称/ Viber/ 通讯录/ 匹配/ 返回/ 率/ 7.9/ %/ ,/ 返回/ 资料/ 包括/ 手机号/ KakaoTalk/ 通讯录/ 匹配/ 返回/ 0.3/ %/ ,/ 返回/ 资料/ 包括/ 头像/ 、/ 手/ KikMessenger/ 无/ 返回/ 结果/ 有信/ 通讯录/ 匹配/ 返回/ 率/ 7/ %/ ,/ 自动/ 添加/ 已有/ 账户/ 到/ 有/ 信/ 开心/ 网/ 应用/ 返回/ 资料/ 有/ 用户/ 头像/ 、/ 姓名/ 、/ 性别/ 、/ 居住地/ 和/ 大学/ 人人/ 网/ 应用/ 加密/ 方式/ 上传/ 保存/ 通讯录/ ,/ 通讯录/ 匹配/ 进行/ 了/ 严/ 这/ 其中/ 有/ 一部分/ 应用/ 的/ 固有/ 用户/ 基数/ 较/ 少/ ,/ 因此/ 采用/ 本/ 方法/ 大规模/ 枚举/ 手机号码/ 返回/ 的/ 用户数量/ 有限/ ,/ 例如/ KakaoTalk/ 只有/ 3/ 的/ 返回/ 率/ ./ 目前/ 流行/ 的/ 通话/ 应用/ Viber/ 用户/ 资料/ 返回/ 率/ 达到/ 了/ 7.9/ %/ ,/ 然而/ 由于/ 该/ 应用/ 的/ 主要/ 功能/ 是/ 拨打/ 免费/ 网络电话/ ,/ 用户/ 需要/ 确定/ 的/ 信息/ 是/ 手机号码/ ,/ 所以/ Viber/ 用户/ 账户/ 信息/ 也/ 只/ 由/ 手机号码/ 、/ 显示/ 名称/ 和/ 用户/ 头像/ 构成/ ,/ 该/ 应用/ 中/ 没有/ 其它/ 对/ 攻击者/ 有/ 利用/ 价值/ 的/ 信息/ ./ 与/ Viber/ 具有/ 相同/ 功能/ 的/ 有/ 信/ 的/ 用户/ 资料/ 返回/ 率/ 也/ 达到/ 了/ 7/ %/ ,/ 而/ 该/ 应用/ 针对/ 大规模/ 通讯录/ 的/ 处理/ 十分/ 敏感/ ,/ 容易/ 出现/ 应用程序/ 崩溃/ 的/ 情况/ ./ 另外/ ,/ 社交/ 网站/ 开心/ 网/ 也/ 推出/ 了/ 自己/ 的/ 移动/ 版本/ ,/ 开心/ 网/ 手机/ 应用/ 也/ 同样/ 具有/ 通讯录/ 匹配/ 功能/ ,/ 在/ 匹配/ 成功/ 后/ 能够/ 返回/ 开心/ 网/ 用户/ 的/ 各项/ 资料/ ,/ 包括/ 用户/ 头像/ 、/ 姓名/ 、/ 性别/ 、/ 居住地/ 和/ 大学/ 等/ ./ 然而/ 值得注意/ 的/ 是/ ,/ 由于/ 开心/ 网/ 用户/ 设置/ 了/ 隐私/ 级别/ 访问控制/ ,/ 通常/ 情况/ 下/ 部分/ 信息/ (/ 如/ 被/ 用户/ 设置/ 了/ “/ 仅/ 对/ 好友/ 开放/ ”/ 的/ 个人资料/ )/ 对/ 陌生人/ 是/ 不/ 可见/ 的/ ,/ 而/ 那些/ 通过/ 开心/ 网/ 手机/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 返回/ 的/ 推荐/ 列表/ 中/ 的/ 用户/ ,/ 在/ 常理/ 之中/ 与/ 使用/ 该/ 功能/ 的/ 用户/ 具有/ 潜在/ 好友/ 关系/ ,/ 因此/ 通过/ 通讯录/ 匹配/ 返回/ 的/ 推荐/ 好友/ 信息/ 相对/ 于/ 陌生人/ 直接/ 从/ 这些/ 用户/ 的/ 页面/ 上/ 看到/ 的/ 信息/ 要/ 更加/ 完整/ ./ 通过/ 本文/ 的/ 方法/ 获得/ 的/ 用户/ 信息/ 包含/ 了/ 这部分/ 被/ 用户/ 设置/ 了/ 隐私/ 保护/ 的/ 信息/ ,/ 如/ 所在/ 学校/ 、/ 工作/ 单位/ 等/ ,/ 这些/ 信息/ 往往/ 是/ 用户/ 不愿/ 被/ 陌生人/ 见到/ 的/ ,/ 从而/ 产生/ 了/ 用户/ 隐私/ 的/ 泄露/ ./ 更/ 令人担忧/ 的/ 是/ ,/ 作为/ 目前/ 国内/ 领先/ 且/ 最具/ 影响力/ 的/ 实名制/ 社交/ 网站/ 之一/ 的/ 开心/ 网/ ,/ 其/ 用户/ 资料/ 的/ 真实度/ 较/ 其它/ 应用/ 更/ 有/ 保障/ 且/ 更具/ 价值/ ,/ 因此/ 一旦/ 泄露/ 将会/ 给/ 用户/ 带来/ 更大/ 的/ 损失/ ./ 人人/ 网/ 手机/ 应用/ 的/ 可靠性/ 在/ 所有/ 实验/ 应用/ 中/ 表现/ 较为/ 突出/ ,/ 其/ 通讯录/ 匹配/ 过程/ 以/ 加密/ 方式/ 上传/ ,/ 并/ 对/ 匹配/ 的/ 返回/ 内容/ 及/ 数量/ 进行/ 了/ 严格/ 的/ 控制/ ./ 5/ 防御/ 策略/ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 是/ 一个/ 非常/ 有/ 价值/ 的/ 功能/ ,/ 它/ 能够/ 给/ 用户线/ 上/ 交流/ 带来/ 极大/ 的/ 便利/ ,/ 同时/ 也/ 是/ 使/ 这类/ 应用/ 能够/ 迅速/ 融入/ 用户/ 日常生活/ 、/ 提高/ 用户/ 黏度/ 的/ 重要途径/ ./ 然而/ ,/ 本文/ 提出/ 的/ 这种/ 漏洞/ 利用/ 方法/ ,/ 让/ 攻击者/ 能够/ 通过/ 通讯录/ 匹配/ 对/ 用户/ 信息/ 进行/ 渗透/ ,/ 进而/ 获取/ 用户/ 手机号码/ 和/ 应用/ 账号/ 之间/ 的/ 关联/ ./ 为了/ 防范/ 这/ 类/ 行为/ 的/ 发生/ ,/ 避免/ 通讯录/ 匹配/ 功能/ 遭到/ 滥用/ ,/ 本文/ 提出/ 了/ 多种/ 可行/ 的/ 防御/ 策略/ 供应/ 用/ 程序开发/ 人员/ 参考/ ,/ 以/ 设计/ 出/ 更加/ 鲁棒/ 和/ 安全/ 的/ 社交/ 通信/ 类/ 应用程序/ ./ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 的/ 机理/ 是/ 将/ 用户/ 手机/ 通讯录/ 上传/ 至/ 应用/ 服务端/ ,/ 然后/ 将/ 该/ 通讯录/ 的/ 所有/ 联系人/ 与/ 所有/ 已/ 注册/ 用户/ 进行/ 比较/ ,/ 最后/ 将/ 通讯录/ 中/ 已/ 注册/ 该/ 应用/ 的/ 联系人/ 作为/ 推荐/ 的/ 好友/ 返回/ 给/ 用户/ ./ 在/ 此/ 过程/ 中/ ,/ 导致/ 通讯录/ 匹配/ 功能/ 被/ 滥用/ 的/ 前提条件/ 有/ 以下/ 4/ 个/ 方面/ :/ (/ 1/ )/ 手机号码/ 能够/ 唯一/ 标识/ 一个/ 手机用户/ ;/ (/ 2/ )/ 应用服务器/ 存储/ 着/ 用户/ 的/ 手机号码/ (/ 或/ 手机号码/ 摘要/ 值/ )/ 与/ 该/ 号码/ 所属/ 的/ 用户/ 账号/ 的/ 映射/ 关系/ ;/ (/ 3/ )/ 应用服务器/ 返回/ 到/ 应用/ 客户端/ 界面/ 上/ 的/ 内容/ 包含/ 了/ 用户/ 账户/ 与其/ 手机号码/ 的/ 映射/ 关系/ 信息/ ;/ (/ 4/ )/ 应用服务器/ 没有/ 限制/ 其/ 响应/ 请求/ 的/ 行为/ ,/ 其/ 返回/ 用户/ 数据/ 的/ 数量/ 仅/ 取决于/ 攻击者/ 设定/ 的/ 输入/ 请求/ ,/ 从而/ 使得/ 攻击者/ 能够/ 进行/ 大规模/ 的/ 自动化/ 攻击/ ./ 其中/ ,/ 条件/ (/ 1/ )/ 是/ 移动/ 通信/ 能够/ 实/ Page12/ 现/ 的/ 必要条件/ ;/ 条件/ (/ 2/ )/ 是/ 通讯录/ 匹配/ 功能/ 能够/ 实现/ 的/ 必要条件/ ,/ 如果/ 应用/ 没有/ 将/ 手机号码/ 和/ 用户/ 账号/ 进行/ 绑定/ ,/ 应用服务器/ 就/ 无法/ 实现/ 通讯录/ 联系人/ 的/ 自动/ 匹配/ 及/ 推荐/ ./ 所以/ ,/ 既然/ 应用/ 开发者/ 无法/ 保证/ 用户/ 的/ 通讯录/ 是否/ 真实/ 体现/ 了/ 用户/ 的/ 社交/ 关系/ ,/ 那么/ 就/ 需要/ 有效/ 地/ 限制/ 上述/ 条件/ (/ 3/ )/ 和/ (/ 4/ )/ 的/ 形成/ ./ 直观/ 地/ ,/ 限制/ 用户/ 单次/ 查询/ 手机号码/ 的/ 数量/ 是/ 最/ 简单/ 有效/ 的/ 方法/ ./ 然而/ ,/ 这种/ 对/ 数量/ 的/ 限制/ 虽然/ 降低/ 了/ 攻击者/ 大规模/ 发送/ 查询/ 请求/ 的/ 可能/ ,/ 但/ 仍/ 无法/ 阻止/ 攻击者/ 实施/ 多次/ 小规模/ 攻击/ ,/ 同时/ 这种/ 方法/ 也/ 增加/ 了/ 普通用户/ 查询/ 手机号码/ 的/ 重复/ 操作/ 频率/ ./ 为此/ ,/ 本文/ 提出/ 了/ 3/ 种/ 可行/ 的/ 方案/ :/ (/ 1/ )/ 基于/ 实名制/ 的/ 应用程序/ 中/ ,/ 账户/ 的/ 用户名/ 往往/ 能/ 提供/ 其他/ 用户/ 明确/ 的/ 身份/ 提示/ ,/ 鉴于/ 在/ 应用/ 中/ 查询/ 和/ 添加/ 通讯录/ 联系人/ 为/ 好友/ 时/ ,/ 用户/ 实际上/ 已/ 具备/ 了/ 对/ 目标/ 联系人/ 好友/ 的/ 先验/ 知识/ (/ 因为/ 被/ 应用/ 推荐/ 的/ 好友/ 都/ 来自/ 于/ 用户/ 自身/ 的/ 通讯录/ )/ ,/ 使/ 其仅/ 通过/ 用户名/ 就/ 能够/ 判断/ 该/ 用户/ 的/ 真实/ 身份/ ./ 因此/ ,/ 建议/ 实名制/ 社交/ 通信/ 类/ 应用/ 的/ 服务器/ 在/ 返回/ 通讯录/ 联系人/ 对应/ 账户/ 的/ 注册/ 信息/ 时/ ,/ 可以/ 仅/ 返回/ 该/ 账户/ 的/ 用户名/ ,/ 而/ 不/ 返回/ 除此以外/ 的/ 其它/ 个人信息/ ,/ 例如/ 手机号码/ ,/ 这样/ 就/ 能/ 有效/ 防止/ 用户/ 个人信息/ 被/ 攻击者/ 收集/ ;/ (/ 2/ )/ 针对/ 未/ 采取/ 实名制/ 的/ 社交/ 通信/ 类/ 应用/ ,/ 建议/ 仅/ 显示/ 目标/ 用户/ 在/ 通讯录/ 中/ 的/ 信息/ ,/ 包括/ 联系人/ 姓名/ 和/ 手机号码/ ,/ 因为/ 联系人/ 姓名/ 已经/ 能/ 给/ 使用/ 通讯录/ 匹配/ 功能/ 的/ 用户/ 以/ 足够/ 的/ 提示/ 来/ 确定/ 推荐/ 好友/ 的/ 身份/ ./ 推荐/ 好友/ 的/ 其它/ 信息/ 应该/ 设定/ 为/ 仅/ 对/ 已/ 添加/ 好友/ 可见/ ,/ 这样/ 避免/ 了/ 返回/ 手机号码/ 和/ 应用/ 账户/ 之间/ 的/ 绑定/ 映射/ ,/ 阻止/ 了/ 攻击者/ 获得/ 通讯录/ 联系人/ 对应/ 的/ 应用/ 账户/ 信息/ ;/ (/ 3/ )/ 在/ 使用/ 通讯录/ 匹配/ 功能/ 为/ 用户/ 推荐/ 好友/ 时/ ,/ 建议/ 向/ 用户/ 推荐/ 那些/ 通讯录/ 中/ 拥有/ 该/ 用户/ 的/ 手机号码/ 的/ 用户/ 为/ 好友/ ,/ 这种/ 方法/ 特别/ 适用/ 于/ 通过/ 手机号码/ 推荐/ 好友/ 的/ 情形/ ./ 与/ 公开/ 的/ 个人/ E/ -/ mail/ 地址/ 不同/ ,/ 手机号码/ 的/ 隐私/ 程度/ 更高/ ,/ 反映/ 出/ 的/ 用户/ 关系/ 也/ 更/ 近/ ,/ 相互/ 拥有/ 对方/ 的/ 手机号码/ 这一/ 事实/ 能够/ 反映/ 出/ 双边/ 的/ 朋友/ 关系/ ,/ 采用/ 这种/ 方法/ 不仅/ 不会/ 影响/ 通讯录/ 匹配/ 这一/ 功能/ 的/ 使用/ ,/ 也/ 最大/ 程度/ 地/ 减小/ 了/ 攻击者/ 利用/ 通讯录/ 匹配/ 获取/ 用户/ 资料/ 的/ 可能性/ ./ 作者/ 发现/ 本文/ 所述/ 问题/ 后/ ,/ 立即/ 分别/ 向/ 微信/ 和/ 米/ 聊/ 两款/ 应用/ 的/ 开发商/ 腾讯/ 公司/ 和/ 小米/ 科技/ 反应/ 上述情况/ ./ 随后/ ,/ 得到/ 腾讯/ 公司/ 的/ 回复/ ,/ 声明/ 已经/ 采取/ 了/ 相应/ 的/ 防御/ 措施/ ./ 作者/ 在/ 使用/ 较/ 大规模/ 的/ 候选/ 通讯录/ 在/ 当前/ (/ 2013/ 年/ 4/ 月/ )/ 最新/ 版本/ (/ 4.5/ ./ 1/ )/ 上/ 再次/ 进行/ 实验/ 后/ 发现/ ,/ 微信/ 通过/ 通讯录/ 匹配/ 推荐/ 好友/ 的/ 数量/ 和/ 频率/ 都/ 大大降低/ ,/ 并且/ 在/ 用户/ 添加/ 了/ 部分/ 推荐/ 好友/ 后/ 才/ 会/ 继续/ 向/ 用户/ 推荐/ 剩下/ 的/ 好友/ ,/ 这/ 使得/ 恶意/ 用户/ 无法/ 在短期内/ 实现/ 大规模/ 收集/ 用户/ 资料/ ,/ 但是/ 应用服务器/ 返回/ 用户/ 手机号码/ 与/ 账号/ 映射/ 关系/ 的/ 问题/ 仍然/ 存在/ ,/ 意味着/ 攻击者/ 可以/ 将/ 较/ 大规模/ 的/ 候选/ 通讯录/ 划分/ 至/ 较/ 小规模/ 实施/ 多次/ 自动化/ 攻击/ ,/ 从而/ 无限量/ 地/ 收集/ 微信/ 用户/ 的/ 账户/ 信息/ ./ 这种/ 仅/ 对/ 返回/ 推荐/ 用户数量/ 进行/ 限制/ 的/ 方法/ 使得/ 恶意/ 获取/ 用户/ 手机号码/ 及/ 对应/ 账号/ 的/ 问题/ 未/ 得到/ 根本性/ 的/ 解决/ ./ 米/ 聊/ 方面/ ,/ 作者/ 一直/ 没有/ 得到/ 小米/ 科技/ 的/ 相关/ 回应/ ./ 随后/ 作者/ 使用/ 米/ 聊/ 当前/ (/ 2013/ 年/ 4/ 月/ )/ 最新/ 版本/ (/ 5.0/ ./ 700/ )/ 进行/ 验证/ ./ 验证/ 结果表明/ ,/ 米/ 聊/ 仍然/ 存在/ 本文/ 描述/ 的/ 问题/ ./ 实验/ 过程/ 中/ ,/ 在/ 勾选/ 了/ 新/ 版本/ 米/ 聊/ 中/ 的/ “/ 推荐/ 手机/ 联系人/ ”/ 选项/ 后/ ,/ 程序/ 没有/ 直接/ 返回/ “/ 已/ 添加/ 好友/ ”/ 列表/ 界面/ ,/ 而/ 实验/ 账户/ 不断/ 地/ 收到/ 好友/ 添加/ 成功/ 提示/ ,/ 并/ 有/ 部分/ 好友/ 主动/ 发起/ 的/ 会/ 话/ ./ 这/ 表明/ 联系人/ 的/ 米/ 聊/ 帐户/ 已经/ 收到/ 了/ 米/ 聊/ 自动/ 发送/ 的/ 添加/ 好友/ 请求/ ,/ 因此/ 可以/ 看出/ 米/ 聊/ 仍然/ 会/ 在/ 通讯录/ 匹配/ 成功/ 后/ 自动/ 向/ 已/ 注册/ 的/ 通讯录/ 好友/ 账户/ 发送/ 添加/ 好友/ 请求/ ,/ 并/ 提示/ 该/ 添加/ 操作/ 是/ 通过/ 通讯录/ 匹配/ 进行/ 的/ ,/ 从而/ 使得/ 用户/ 放松/ 警惕/ 而/ 接受/ 此次/ 好友/ 请求/ 并/ 随即/ 主动/ 发起/ 会话/ ./ 同时/ 由于/ 米/ 聊/ 客户端/ 数据库/ 并/ 没有/ 实施/ 加密/ 保护/ ,/ 而/ 手机/ 通讯录/ 中/ 已经/ 注册/ 的/ 联系人/ 账户/ 及其/ 详细资料/ 已经/ 存储/ 在/ 本地/ 数据库/ ,/ 恶意/ 用户/ 可以/ 通过/ 读取/ 数据库/ 直接/ 获取/ 所/ 需/ 信息/ ,/ 用户/ 数据/ 仍然/ 存在/ 泄露/ 的/ 风险/ ./ 6/ 相关/ 工作/ 近几年/ 随着/ 移动/ 终端设备/ 逐渐/ 深入/ 人们/ 的/ 日常生活/ ,/ 移动/ 终端/ 应用程序/ 隐私/ 问题/ 成为/ 了/ 研究/ 人员/ 重点/ 关注/ 的/ 对象/ ./ Enck/ 等/ 人/ [/ 3/ ]/ 通过/ 修改/ Android/ 系统/ 的/ Dalvik/ 虚拟机/ 实现/ 了/ 动态/ 污点/ 传播/ 分析/ 工具/ TaintDroid/ ./ TaintDroid/ 可以/ 标记/ 敏感数据/ 作为/ 污点/ 源/ ,/ 跟踪/ 污点/ 数据/ ,/ 通过/ 污点/ 数据/ 是否/ 流出/ 手机/ 来/ 判断/ 该/ 应用/ 是否/ 存在/ 隐私/ 侵犯/ 行为/ ./ PiOS/ [/ 4/ ]/ 是/ 一款/ 针对/ 苹果公司/ iOS/ 系统/ 的/ 隐私/ 泄露/ 分析/ 工具/ ./ 作者/ 静态/ 分析/ iOS/ 应用/ 的/ 二进制/ 文件/ ,/ 根据/ Mach/ -/ O/ 文件/ 构造/ 控制/ 流程图/ (/ CFG/ ,/ ControlFlowGraph/ )/ ./ 通过/ 基于/ CFG/ 图/ 的/ 控制流/ 和/ 数据流/ 分析/ ,/ 检测/ 数据/ 是否/ 到达/ 一个/ 汇点/ ,/ 从而/ 确定/ 应用/ 是否/ 可能/ 存在/ 隐私/ 泄露/ ./ 此外/ ,/ 不少/ 研究/ 关注/ 于/ 隐私/ 泄露/ 的/ 防范/ ,/ 如/ Page13MockDroid/ [/ 5/ ]/ 、/ TISSA/ [/ 6/ ]/ 等/ ./ MockDroid/ 是/ 一款/ 控制/ Android/ 应用程序/ 访问/ 敏感/ 资源/ 的/ 工具/ ,/ 其/ 允许/ 用户/ 授予/ 应用程序/ 虚假/ 的/ 权限/ ,/ 所谓/ 虚假/ 是/ 指/ 系统/ 并/ 没有/ 真正/ 允许/ 其/ 访问/ 敏感/ 资源/ ,/ 而是/ 当/ 应用/ 访问/ 这些/ 资源/ 时/ ,/ 系统/ 根据/ 需求/ 返回/ 空值/ 、/ 不可/ 用/ 信息/ 等/ ./ 这样/ 的/ 修改/ 虽然/ 很/ 好/ 地/ 防止/ 了/ 敏感/ 信息/ 外流/ ,/ 但/ 当/ 应用程序/ 正常/ 访问/ 资源/ 时/ 返回/ 不可/ 用/ 信息/ 会/ 导致/ 应用/ 意外/ 崩溃/ ./ TISSA/ 同样/ 也/ 是/ 一款/ Android/ 系统/ 上/ 的/ 用户/ 隐私/ 控制/ 工具/ ,/ 允许/ 用户/ 在/ 应用/ 程序运行/ 时/ 动态/ 调整/ 授予/ 权限/ ./ 与/ 上述/ 研究/ 不同/ 的/ 是/ ,/ 本文/ 主要/ 提出/ 一种/ 利用/ 现有/ 社交/ 通信/ 类/ 应用/ 中/ 的/ 通讯录/ 匹配/ 功能/ 自动/ 收集/ 用户/ 手机号码/ 和/ 存储/ 在/ 应用服务器/ 上/ 的/ 个人资料/ 的/ 方法/ ,/ 而/ 隐私/ 信息/ 如何/ 从/ 手机/ 泄露/ 不是/ 本文/ 关注/ 的/ 内容/ ./ 此外/ ,/ 研究/ 人员/ 也/ 在/ 用户/ 资料/ 自动/ 收集/ 方面/ 做/ 了/ 很多/ 工作/ ,/ 尤其/ 是/ 面向/ 社交/ 网络/ (/ SocialNetworkService/ ,/ SNS/ )/ 方面/ ./ Bilge/ 等/ 人/ [/ 7/ ]/ 通过/ SNS/ 网络/ 收集/ 用户/ 资料/ ,/ 达到/ 了/ 自动/ 窃取/ 身份/ 的/ 目的/ ,/ 然而/ 该/ 方法/ 要求/ 目标/ 账号/ 与/ 攻击者/ 具备/ 好友/ 关系/ ,/ 也/ 就/ 意味着/ 攻击者/ 在/ 获取/ 用户/ 资料/ 之前/ 需要/ 首先/ 与/ 目标/ 对象/ 相互/ 添/ 加为好友/ ./ Barlduzzi/ 等/ 人/ [/ 1/ ]/ 利用/ 社交/ 网络/ 中/ 的/ E/ -/ mail/ 查询/ 功能/ 收集/ 用户/ 资料/ ./ 这个/ 功能/ 允许/ 用户/ 查询/ 并/ 验证/ 其/ E/ -/ mail/ 地址/ 列表/ 中/ 的/ 好友/ 是否/ 在/ 该/ 社交/ 网络/ 中/ 已/ 注册/ 了/ 账户/ ./ 该/ 团队/ 通过/ 抓取/ SNS/ 用户/ 主页/ 收集/ 了/ 大量/ 的/ 用户/ 信息/ ,/ 并/ 对/ 这些/ 信息/ 运用/ 了/ 关联/ 分析/ ./ 对比/ 前人/ 的/ 研究/ ,/ 到/ 目前为止/ 本文/ 是/ 首次/ 提出/ 利用/ 移动/ 终端/ 应用/ 作为/ 媒介/ 来/ 自动/ 收集/ 用户/ 的/ 个人资料/ ./ 本文/ 利用/ 社交/ 通信/ 类/ 应用/ 的/ 通讯录/ 匹配/ 功能/ 获取/ 用户/ 的/ 手机号码/ 及其/ 存储/ 在/ 应用/ 中/ 的/ 个人资料/ ,/ 通过/ 监控/ 与/ 处理/ 用户/ 资料/ 信息/ 相关/ 的/ AndroidAPI/ 和/ 模拟/ 用户/ 浏览/ 动作/ ,/ 实现/ 了/ 自动/ 收集/ 的/ 过程/ 且/ 不/ 需要/ 添加/ 目标/ 用户/ 为/ 好友/ ./ 本文/ 的/ 方法/ 与/ Barlduzzi/ 等/ 人/ 的/ 研究/ 都/ 可以/ 被/ 用来/ 完成/ 社交/ 工程/ 分析/ 的/ 前期/ 准备/ 工作/ ./ 目前/ 通讯/ 应用/ 中/ 使用/ 手机号码/ 作为/ 账户/ 唯一/ 标识符/ 的/ 情况/ 越来越/ 多/ ,/ Schrittwieser/ 等/ 人/ [/ 8/ ]/ 针对/ 这种/ 现状/ 做/ 了/ 一系列/ 的/ 分析/ ./ 该/ 工作/ 主要/ 针对/ 应用/ 的/ 认证/ 机制/ ./ 分析/ 结果显示/ ,/ 使用/ 手机号码/ 作为/ 账户/ 的/ 唯一/ 标识符/ 会/ 带来/ 众多/ 安全/ 问题/ ,/ 例如/ 账户/ 劫持/ 、/ ID/ 欺骗/ 等/ ./ 同样/ ,/ 本文/ 的/ 实验/ 结果显示/ ,/ 配置/ 了/ 通讯录/ 匹配/ 功能/ 的/ 应用/ 也/ 存在/ 用/ 手机号码/ 作为/ 用户/ 账户/ 的/ 唯一/ 标识符/ 的/ 情况/ ./ 针对/ 该/ 问题/ ,/ 本文/ 最后/ 提出/ 了/ 一系列/ 防御/ 策略/ 来/ 保证/ 通讯录/ 匹配/ 功能/ 在/ 正常/ 使用/ 的/ 同时/ 仍/ 能够/ 有效/ 地/ 防范/ 该/ 功能/ 被/ 恶意/ 利用/ ./ 7/ 结论/ 本文/ 揭示/ 了/ 移动/ 终端/ 中/ 配备/ 通讯录/ 匹配/ 功能/ 的/ 社交/ 通信/ 应用/ 存在/ 的/ 用户/ 隐私/ 泄露/ 安全隐患/ ,/ 该/ 安全隐患/ 使得/ 攻击者/ 能够/ 通过/ 通讯录/ 匹配/ 机制/ 自动/ 地/ 收集/ 应用/ 注册/ 用户/ 的/ 个人资料/ 信息/ ./ 本文/ 具体/ 展示/ 了/ 一种/ 利用/ 该/ 漏洞/ 来/ 自动/ 收集/ 用户/ 资料/ (/ 包括/ 手机号码/ )/ 的/ 方法/ ./ 这是/ 利用/ 移动/ 终端/ 应用/ 自动/ 收集/ 用户/ 个人资料/ 方向/ 的/ 首次/ 探索/ ./ 此外/ ,/ 本文/ 基于/ 实现/ 的/ 原型/ 系统/ 进行/ 大量/ 实验/ ,/ 实验/ 结果/ 充分/ 验证/ 了/ 该/ 方法/ 的/ 有效性/ ./ 针对/ 从/ 多个/ 应用/ 获取/ 用户/ 账户/ 个人信息/ 的/ 情况/ ,/ 本文/ 还/ 提出/ 了/ 两种/ 通过/ 跨/ 应用/ 分析/ 获得/ 数量/ 更加/ 庞大/ 、/ 字/ 段/ 更加/ 全面/ 的/ 用户/ 资料/ 的/ 方法/ ,/ 即/ 横向/ 整合/ 和/ 纵向/ 渗透/ ,/ 同时/ 还/ 进行/ 了/ 用户/ 数据/ 的/ 一致性/ 和/ 真实性/ 分析/ 以/ 确定/ 更/ 真实/ 的/ 用户/ 信息/ ./ 实验/ 结果表明/ ,/ 用户/ 通常/ 倾向/ 于/ 在/ 移动/ 社交/ 通信/ 类/ 应用/ 中/ 填写/ 真实/ 的/ 个人信息/ ,/ 而/ 对于/ 不同/ 的/ 应用/ ,/ 其/ 不同/ 的/ 用户/ 价值/ 定位/ 和/ 推广/ 策略/ 导致用户/ 对/ 其/ 信任度/ 略有/ 差异/ ,/ 从而/ 使/ 用户/ 在/ 各/ 应用/ 中/ 填写/ 的/ 用户/ 资料/ 的/ 真实性/ 也/ 各不相同/ ./ 最后/ ,/ 通过/ 分析/ 通讯录/ 匹配/ 功能/ 漏洞/ 产生/ 的/ 原因/ ,/ 本文/ 提出/ 了/ 一系列/ 防御/ 策略/ ./ 建议/ 开发者/ 在/ 设计/ 开发/ 社交/ 通信/ 类/ 应用/ 时应/ 时刻/ 关注/ 用户/ 真实世界/ 身份/ 和/ 虚拟/ 网络/ 身份/ 的/ 界限/ ,/ 当/ 两者/ 出现/ 关联/ 时/ ,/ 应/ 尽量避免/ 显式/ 返回/ 这种/ 关联/ 关系/ ,/ 同时/ 还/ 需要/ 一定/ 程度/ 地/ 限制/ 返回/ 的/ 数据量/ 大小/ ,/ 阻止/ 恶意/ 用户/ 的/ 自动/ 批量/ 攻击/ ./ 

