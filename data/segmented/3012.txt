Page1/ 基于/ 通信/ 特征提取/ 和/ IP/ 聚集/ 的/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ 李润恒/ 1/ )/ 王明/ 华/ 2/ )/ 贾焰/ 1/ )/ 1/ )/ (/ 国防科学技术大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 2/ )/ (/ 国家/ 计算机网络/ 应急/ 技术/ 处理/ 协调/ 中心/ 北京/ 100029/ )/ 摘要/ IRC/ 僵尸/ 网络/ (/ botnet/ )/ 是/ 攻击者/ 通过/ IRC/ 服务器/ 构建/ 命令/ 与/ 控制/ 信道/ 方式/ 控制/ 大量/ 主机/ (/ bot/ )/ 组成/ 的/ 网络/ ./ IRC/ 僵尸/ 网络/ 中/ IRC/ 服务器/ 与/ bot/ 连接/ 具有/ 很强/ 的/ 动态/ 特性/ ,/ 为/ 识别/ 使用/ 不同/ IRC/ 服务器/ 的/ 同一/ 僵尸/ 网络/ ,/ 文中/ 提取/ 并/ 比/ 对/ 僵尸/ 网络/ 的/ 通信量/ 特征/ 、/ 通信/ 频率/ 特征/ ,/ 建模/ 估算/ bot/ 重叠/ 率/ ,/ 通过/ 融合/ 以上/ 度量/ 指标/ ,/ 提出/ 了/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ./ 实验/ 验证/ 了/ 模型/ 的/ 有效性/ ,/ 计算/ 了/ 其/ 准确率/ ,/ 并/ 分析/ 了/ 僵尸/ 网络/ 的/ 迁移/ ./ 关键词/ 僵尸/ 网络/ ;/ 通信/ ;/ 聚集/ ;/ 相似性/ 度量/ ;/ 迁移/ 1/ 引言/ 僵尸/ 网络/ 是/ 攻击者/ 出于/ 恶意/ 目的/ ,/ 传播/ 僵尸/ 程/ Page2/ 窃取/ 、/ 分布式/ 拒绝服务/ 攻击/ 和/ 垃圾邮件/ 发送/ 等/ 攻击/ 目的/ ./ 僵尸/ 网络/ 正/ 步入/ 快速/ 发展期/ ,/ 对/ 因特网/ 安全/ 已/ 造成/ 严重威胁/ ./ 僵尸/ 网络/ 主要/ 分为/ IRC/ 僵尸/ 网络/ 、/ HTTP/ 僵尸/ 网络/ 和/ P2P/ 僵尸/ 网络/ ./ IRC/ 僵尸/ 网络/ 是/ 最早/ 产生/ 而/ 目前/ 仍然/ 大量/ 存在/ 的/ 一类/ 僵尸/ 网络/ ,/ 基于/ 标准/ IRC/ 协议/ 在/ IRC/ 聊天/ 服务器/ 上/ 构建/ 其/ 命令/ 与/ 控制/ 信道/ ,/ 控制者/ 通过/ 命令/ 与/ 控制/ 信道/ 实现/ 对/ 大量/ 受控/ 主机/ 的/ 僵尸/ 程序/ 版本/ 更新/ 、/ 恶意/ 攻击/ 等/ 行为/ 的/ 控制/ ,/ 其/ 控制者/ 、/ 命令/ 与/ 控制/ 服务器/ (/ IRC/ 服务器/ )/ 、/ 受控/ 主机/ (/ bot/ )/ 、/ 被/ 攻击/ 对象/ 的/ 关系/ 如图/ 1/ 所示/ ;/ HTTP/ 僵尸/ 网络/ 与/ 图/ 2IRC/ 僵尸/ 网络/ 衍变/ 示意图/ 因此/ IRC/ 服务器/ 与/ 僵尸/ 网络/ (/ 控制者/ )/ 并不一定/ 是/ 一一对应/ 关系/ ,/ 并且/ IRC/ 服务器/ 与/ 僵尸/ 网络/ (/ 控制者/ )/ 的/ 对应/ 关系/ 可能/ 随/ 时间/ 发生/ 转变/ ./ 利用/ IRC/ 服务器/ 与/ bot/ 的/ 一对/ 多/ 映射/ 关系/ ,/ 使用/ 聚类/ 等/ 数据分析/ 方法/ 可以/ 有效/ 地/ 检测/ IRC/ 服务器/ 与/ bot/ 的/ C/ &/ C/ 通信/ ,/ 以此/ 获得/ IRC/ 服务器/ 与/ bot/ 的/ 对应/ 关系/ ./ 但是/ 僵尸/ 网络/ 控制者/ 与/ IRC/ 服务器/ 是/ 一对一/ 映射/ 关系/ ,/ 很难/ 使用/ 数据分析/ 方法/ 获得/ 僵尸/ 网络/ 控制者/ 与/ IRC/ 服务器/ 的/ 对应/ 关系/ ./ IRC/ 僵尸/ 网络/ 中/ ,/ bot/ 与/ 控制者/ 是/ 实体/ ,/ IRC/ 服务器/ 只是/ 其中/ 间/ 桥梁/ ./ 要/ 准确/ 地/ 掌握/ 僵尸/ 网络/ ,/ 必须/ 掌握/ 僵尸/ 网络/ (/ 控制者/ )/ 与/ bot/ 的/ 对应/ 关系/ ./ 由于/ 僵尸/ 网络/ IRC/ 服务器/ 与/ bot/ 连接/ 的/ 复杂/ 衍变/ 特性/ (/ 如图/ 2/ 所示/ )/ 以及/ IRC/ 服务器/ 与/ 控制者/ 通信/ 检测/ 的/ 困/ IRC/ 僵尸/ 网络/ 的/ 功能/ 结构/ 相似/ ,/ 所/ 不同/ 的/ 是/ HTTP/ 僵尸/ 网络/ 控制器/ 是/ 以/ WEB/ 网站/ 方式/ 构建/ ;/ P2P/ 僵尸/ 网络/ 是/ 一种/ 较/ 新型/ 的/ 僵尸/ 网络/ ,/ 在/ P2P/ 僵尸/ 网络/ 中/ 僵尸/ 程序/ 同时/ 承担/ 客户端/ 和/ 服务器/ 的/ 双重/ 角色/ ./ 图/ 1/ 所示/ 的/ IRC/ 僵尸/ 网络/ 健壮性/ 差/ ,/ 存在/ 单点/ 失效/ 问题/ ,/ 可/ 通过/ 摧毁/ 单个/ IRC/ 服务器/ 来/ 切断/ 僵尸/ 网络/ 控制者/ 与/ bot/ 的/ 联系/ ,/ 导致/ 整个/ 僵尸/ 网络/ 瘫痪/ ./ 针对/ 这一/ 问题/ ,/ bot/ 的/ 僵尸/ 程序/ 使用/ 域名/ 而/ 非/ 固定/ 的/ IP地址/ 连接/ IRC/ 服务器/ ,/ 僵尸/ 网络/ 控制者/ 使用/ 动态域名/ 服务/ 将/ 僵尸/ 程序/ 连接/ 的/ 域名/ 映射/ 到/ 其/ 控制/ 的/ 多台/ IRC/ 服务器/ 上/ ,/ 一旦/ 正在/ 工作/ 的/ IRC/ 服务器/ 失效/ ,/ 僵尸/ 网络/ 的/ 受控/ 主/ 机会/ 连接/ 到/ 其他/ 的/ IRC/ 服务器/ ,/ 整个/ 僵尸/ 网络/ 继续/ 运转/ ,/ 如图/ 2/ (/ a/ )/ 所示/ ./ 此外/ ,/ 将/ 僵尸/ 网络/ 的/ 控制权/ 出租/ 出售/ 谋取/ 经济/ 利益/ 是/ 目前/ 僵尸/ 网络/ 产业链/ 的/ 重要/ 组成部分/ ./ 僵尸/ 网络/ 主动/ 或者/ 被动/ 改变/ 其/ IRC/ 服务器/ 的/ 行为/ 称为/ 僵尸/ 网络/ 的/ 迁移/ ./ 此外/ ,/ 出于/ 安全/ 的/ 考虑/ ,/ 某些/ 大型/ 僵尸/ 网络/ 采用/ 分层/ 管理模式/ ,/ 如图/ 2/ (/ b/ )/ 所示/ ,/ 由/ 多个/ IRC/ 服务器/ 控制/ 各自/ 不同/ 的/ bot/ 群体/ ,/ 而/ 所有/ 的/ IRC/ 服务器/ 同时/ 由/ 僵尸/ 网络/ 控制者/ 统一/ 控制/ ./ 难/ ,/ 目前/ 相关/ 研究/ 主要/ 集中/ 在/ IRC/ 服务器/ 与/ bot/ 的/ C/ &/ C/ 通信/ 检测/ ,/ 存在/ 局限/ ./ 此外/ ,/ 由于/ 很难/ 获取/ 大规模/ 僵尸/ 网络通信/ 数据/ ,/ 实验/ 数据/ 由/ 少量/ 已知/ 僵尸/ 网络通信/ 数据/ 集/ 仿真/ 产生/ ,/ 无法/ 对/ 大量/ 僵尸/ 网络通信/ 数据/ 进行/ 特征/ 比/ 对/ 等/ 关联/ 分析/ ./ 本文/ 首先/ 将/ IRC/ 服务器/ 与/ 所/ 关联/ 的/ bot/ 看作/ 一个/ 僵尸/ 网络/ ,/ 在/ 此基础/ 上/ 建立/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ,/ 根据/ 僵尸/ 网络/ 相似性/ 距离/ 值/ ,/ 分类/ 识别/ 相同/ 的/ 僵尸/ 网络/ ,/ 以此/ 准确/ 地/ 掌握/ 僵尸/ 网络/ ./ 准确/ 地/ 掌握/ 僵尸/ 网络/ 有利于/ 度量/ 僵尸/ 网络/ 的/ 大小/ ,/ 评估/ 僵尸/ 网络/ 的/ 危害/ ;/ 研究/ 僵尸/ 网络/ 的/ 生命周期/ ,/ 掌握/ 其/ 衍变/ 特性/ 等/ ./ 本文/ 基于/ 国家/ 网络安全/ 监测/ 平台/ 监测/ 到/ 的/ 僵尸/ 网络/ IRC/ 服务器/ 与/ bot/ 的/ C/ &/ C/ 通信/ 数据/ ,/ 从/ 不同/ 角度/ 对/ 僵尸/ 网络/ 的/ 相似性/ 进行/ 度量/ :/ 提取/ 并/ 比/ 对/ 僵/ Page3/ 尸/ 网络/ 的/ 通信/ 特征/ ;/ bot/ 重叠/ 率/ 的/ 建模/ 估算/ ./ 由于/ 僵尸/ 网络/ 间/ bot/ 群体/ 的/ 差异/ 、/ 僵尸/ 程序/ 版本/ 的/ 差异/ 等/ 因素/ ,/ 通信/ 特征/ 是/ 僵尸/ 网络/ 区别/ 其它/ 僵尸/ 网络/ 的/ 显著/ 特征/ ,/ 包括/ 通信量/ 特征/ 和/ 通信/ 频率/ 特征/ ./ 由于/ 大多数/ bot/ 夜间/ 关机/ 下线/ ,/ 僵尸/ 网络通信/ 量/ 有/ 明显/ 的/ 以/ 一天/ 为/ 周期/ 的/ 周期/ 规律/ ,/ 提取/ 僵尸/ 网络通信/ 量/ 日/ 周期/ 曲线/ 和/ 通信/ 频率/ 日/ 周期/ 曲线/ ./ 通信量/ 日/ 周期/ 曲线/ 反映/ 了/ bot/ 群体/ 的/ 普遍/ 上线/ 时间/ 习惯/ ,/ 而/ 通信/ 频率/ 日/ 周期/ 曲线/ 反映/ 了/ 僵尸/ 网络/ 控制者/ 的/ 使用/ 习惯/ 以及/ 僵尸/ 程序/ 版本/ 等/ 特征/ ./ 度量/ 僵尸/ 网络/ 相似性/ 的/ 另/ 一个/ 方法/ 是/ 建模/ 估算/ bot/ 的/ 重叠/ 率/ ./ 考虑/ 到/ 互联网/ 上/ 众多/ ADSL/ 上网/ 的/ 主机/ 使用/ 动态/ IP地址/ ,/ 直接/ 计算/ botIP/ 的/ 重叠/ 率会/ 导致/ 很大/ 的/ 误差/ ./ 本文/ 通过/ bot/ IP地址/ 的/ 聚集/ 操作/ ,/ 将/ bot/ IP地址/ 集合/ ,/ 映射/ 为/ bot/ 集合/ ,/ 估算/ 僵尸/ 网络/ 间/ bot/ 的/ 重叠/ 率/ ,/ 以此/ 来/ 度量/ 僵尸/ 网络/ 的/ 相似性/ ./ 两类/ 方法/ 各有/ 优缺点/ ,/ 适合/ 不同/ 的/ 情况/ ,/ 融合/ 其/ 相似性/ 度量/ 的/ 结果/ ,/ 本文/ 提出/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ./ 通过/ 蜜网/ 蜜罐/ 跟踪/ 、/ 域名/ 监测/ 系统日志/ 分析/ 等/ 手段/ 确认/ 相同/ 僵尸/ 网络/ ,/ 对模型/ 进行/ 有效性/ 验证/ ,/ 计算/ 其/ 准确率/ ,/ 并/ 分析/ 导致/ 错误/ 的/ 各类/ 原因/ ./ 最后/ 分析/ 僵尸/ 网络/ 的/ 迁移/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 研究/ ;/ 第/ 3/ 节/ 介绍/ 基于/ 通信/ 特征提取/ 和/ IP/ 聚集/ 的/ 相似性/ 度量/ 模型/ ,/ 3.1/ 节/ 介绍/ 国家/ 网络安全/ 监测/ 平台/ ,/ 3.2/ 节/ 介绍/ 通信量/ 特征提取/ ,/ 3.3/ 节/ 介绍/ 通信/ 频率/ 特征提取/ ,/ 3.4/ 节/ 介绍/ IP/ 聚集/ ,/ 3.5/ 节/ 介绍/ 相似性/ 度量/ 模型/ ;/ 第/ 4/ 节为/ 实验/ 和/ 验证/ ;/ 第/ 5/ 节为/ 结语/ 及/ 未来/ 工作/ 的/ 展望/ ./ 2/ 相关/ 研究/ 僵尸/ 网络/ 是/ 在/ 网络蠕虫/ 、/ 特洛伊木马/ 、/ 后门/ 工具/ 等/ 传统/ 恶意代码/ 形态/ 的/ 基础/ 上/ 发展/ 、/ 融合/ 而/ 产生/ 的/ 一种/ 新型/ 攻击方式/ ./ 采用/ 灵活/ 且/ 高效/ 的/ 一对/ 多/ 控制/ 机制/ ,/ 利用/ 僵尸/ 网络/ ,/ 攻击者/ 可以/ 轻易/ 地/ 控制/ 成千上万/ 台/ 主机/ 对/ 因特网/ 任意/ 站点/ 发起/ 分布式/ 拒绝服务/ 攻击/ ,/ 并/ 发送/ 大量/ 垃圾邮件/ ./ 因此/ ,/ 僵尸/ 网络/ 得到/ 了/ 攻击者/ 的/ 关注/ 并/ 进一步/ 发展/ 成为/ 因特网/ 最为/ 严重/ 的/ 威胁/ 之一/ ./ 近年来/ ,/ 僵尸/ 网络/ 的/ 活跃/ 已经/ 引起/ 国内外/ 安全/ 业界/ 的/ 充分/ 重视/ ,/ 僵尸/ 网络/ 已/ 成为/ 安全/ 领域/ 的/ 学术研究/ 和/ 讨论/ 的/ 热点问题/ ./ 目前/ 主流/ 的/ 僵尸/ 网络/ 是/ IRC/ 僵尸/ 网络/ ,/ 基于/ 标准/ IRC/ 协议/ 构建/ 其/ 命令/ 与/ 控制/ 信道/ ,/ 其/ 控制/ 服务器/ 可/ 构建/ 在/ 公用/ IRC/ 聊天/ 服务器/ 上/ ,/ 但/ 攻击者/ 为/ 保证/ 对/ 僵尸/ 网络/ 控制/ 服务器/ 的/ 绝对/ 控制权/ ,/ 一般/ 会/ 利用/ 其/ 完全/ 控制/ 的/ 主机/ 架设/ 专门/ 的/ 僵尸/ 网络/ 命令/ 与/ 控制/ 服务器/ ./ IRC/ 僵尸/ 网络/ 的/ 工作/ 机制/ :/ 攻击者/ 通过/ 各种/ 传播方式/ 使得/ 目标/ 主机/ 感染/ 僵尸/ 程序/ ;/ 僵尸/ 程序/ 加入/ 到/ 攻击者/ 私有/ 的/ IRC/ 命令/ 与/ 控制/ 信道/ 中/ ;/ 攻击者/ 登陆/ 并/ 加入/ 到/ IRC/ 命令/ 与/ 控制/ 信道/ 中/ ,/ 通过/ 认证/ 后/ 向/ 僵尸/ 网络/ 发出/ 各种/ 指令/ ;/ 僵尸/ 程序/ 接受/ 指令/ ,/ 执行/ 指令/ ,/ 必要/ 的/ 情况/ 下/ 返回/ 执行/ 指令/ 的/ 结果/ ./ IRC/ 僵尸/ 网络/ 的/ 跟踪/ 与/ 检测/ 方法/ 可以/ 分为/ 3/ 大类/ :/ 蜜网/ 蜜罐/ 跟踪/ 僵尸/ 网络/ [/ 1/ -/ 4/ ]/ 、/ 协议/ 与/ 结构/ 相关/ 检测/ 方法/ [/ 5/ -/ 9/ ]/ 、/ 协议/ 与/ 结构/ 无关/ 检测/ 方法/ [/ 10/ -/ 11/ ]/ ./ 蜜网/ 蜜罐/ 通过/ 捕获/ 并/ 分析/ 恶意代码/ 获取/ 僵尸/ 网络/ 命令/ 与/ 控制/ 信道/ 的/ 相关/ 信息/ ,/ 然后/ 模拟/ 受控/ 的/ 僵尸/ 主机/ 加入/ 僵尸/ 网络/ ,/ 对/ 僵尸/ 网络/ 的/ 内部/ 活动/ 进行/ 观察/ 和/ 跟踪/ ,/ 但是/ 这/ 类/ 方法/ 依赖于/ 蜜网/ 蜜罐/ 布控/ 点/ 的/ 分布/ ,/ 无法/ 有效/ 地/ 检测/ 出/ 全部/ 活跃/ 的/ 僵尸/ 网络/ ./ 协议/ 有关/ 的/ 检测/ 方法/ 利用/ 跟踪/ 方法/ 了解/ 僵尸/ 网络/ 内部/ 工作/ 机制/ ,/ 抽象/ 出/ 僵尸/ 网络/ 行为/ 特征/ ,/ 通过/ 异常/ 检测/ 等/ 方法/ 检测/ 僵尸/ 网络/ ./ 协议/ 无关/ 的/ 检测/ 方法/ 采用/ 聚类/ 算法/ 将/ 网络流量/ 分类/ ,/ 从而/ 识别/ 僵尸/ 网络流量/ 和/ 正常/ 流量/ ./ 关于/ 僵尸/ 网络/ 的/ 动态性/ 、/ 相似性/ 度量/ 方面/ 的/ 研究/ ,/ 文献/ [/ 12/ ]/ 从/ 评估/ 僵尸/ 网络/ 规模/ 的/ 角度/ 提出/ 了/ 僵尸/ 网络/ 相似性/ 度量/ 问题/ ,/ 文章/ 指出/ 评估/ 僵尸/ 网络/ 规模/ 的/ 难点/ 之一/ 是/ 僵尸/ 网络/ 的/ 动态性/ ,/ 通过/ 蜜网/ 蜜罐/ 跟踪/ 僵尸/ 网络/ 获取/ 其/ 僵尸/ 程序/ 版本/ 、/ IRC/ 服务器/ IP/ 、/ IRC/ 服务器/ 域名/ 、/ IRC/ 频道/ 名/ 、/ 控制者/ ID/ 等/ 信息/ ,/ 提出/ 了/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ,/ 最后/ 分析/ 了/ 僵尸/ 网络/ 的/ 迁移/ 情况/ ;/ 文献/ [/ 2/ ]/ 对/ 僵尸/ 网络/ 的/ 迁移/ 及/ 复制/ 现象/ 进行/ 了/ 分析/ ,/ 但是/ 只/ 针对/ 僵尸/ 网络/ 在/ 同一个/ IRC/ 服务器/ 上/ 不同/ 频道/ 的/ 迁移/ 与/ 复制/ ;/ 文献/ [/ 13/ ]/ 从/ 研究/ 僵尸/ 网络/ 传播/ 模型/ 的/ 角度/ ,/ 考虑/ 到/ 大多数/ 计算机/ 在/ 夜间/ 关机/ 下线/ ,/ 从而/ 僵尸/ 网络/ 的/ 通信量/ 呈现/ 周期/ 现象/ ,/ 提取/ 了/ 僵尸/ 网络/ 在/ 全球/ 不/ 同时/ 区/ 的/ 通信量/ 日/ 周期/ 曲线/ ./ 3/ 基于/ 通信/ 特征/ 和/ IP/ 聚集/ 的/ 相似性/ 度量/ 模型/ 3.1/ 国家/ 网络安全/ 监测/ 平台/ 863/ -/ 917/ 网络安全/ 监测/ 平台/ [/ 14/ ]/ 是/ 国家/ “/ 八/ 六三/ ”/ 计划/ 设立/ 的/ 网络安全/ 应急/ 项目/ (/ 917/ 工程/ )/ 建设/ 的/ 网络安全/ 监控/ 平台/ ./ 该/ 平台/ 是/ 保障/ 国家/ 网络安全/ 和/ 网上/ 重要/ 信息系统/ 安全/ 的/ 重要/ 监测/ 平台/ ,/ 由/ CNCERT/ // CC/ 负责/ 建设/ 并/ 运行/ ./ 863/ -/ 917/ 网络安全/ 监测/ 平台/ 底层/ 为/ 网络/ 型/ IDSPage4/ 系统/ ,/ 实时/ 监测/ 我国/ 互联网/ 中/ 特定/ 安全事件/ ,/ 诸如/ 僵尸/ 网络/ 、/ 木马/ 通信/ 事件/ 等/ ./ 采用/ 协议/ 与/ 结构/ 相关/ 的/ 僵尸/ 网络/ 检测/ 方法/ ,/ 利用/ 蜜网/ 蜜罐/ 获取/ 僵尸/ 网络/ 信息/ 、/ 提取/ 僵尸/ 网络/ 报文/ 级/ 通信/ 特征/ ,/ 在/ 国家/ 重要/ 路由器/ 节点/ 部署/ 网络/ 型/ IDS/ ,/ 对/ 路由/ 报文/ 使用/ 特征/ 匹配/ 检测/ 僵尸/ 网络/ C/ &/ C/ 通信/ ./ 检测/ 到/ 的/ 僵尸/ 网络/ C/ &/ C/ 通信/ 包括/ IRC/ 服务器/ 与/ bot/ 间/ 的/ 控制/ 命令/ 、/ 定期/ 存活/ 检测/ 通信/ 等/ ./ 863/ -/ 917/ 平台/ 记录/ 了/ 僵尸/ 网络通信/ 事件/ 的/ bot/ IP地址/ 、/ IRC/ 服务器/ IP地址/ 、/ 通信/ 时间/ 等/ 属性/ ./ 根据/ 863/ -/ 917/ 平台/ 的/ 检测/ 结果/ ,/ 能够/ 获取/ IRC/ 服务器/ 与/ bot/ 的/ 映射/ 关系/ ./ 3.2/ 通信量/ 日/ 周期/ 曲线/ 由于/ 僵尸/ 网络/ 间/ bot/ 群体/ 的/ 差异/ 、/ 僵尸/ 程序/ 版本/ 的/ 差异/ 等/ 因素/ ,/ 僵尸/ 网络/ 的/ 通信/ 特征/ 是/ 僵尸/ 网络/ 区别/ 其他/ 僵尸/ 网络/ 的/ 显著/ 特征/ ./ 通信/ 特征/ 包括/ 通信量/ 特征/ 和/ 通信/ 频率/ 特征/ ,/ 通信量/ 特征/ 反映/ 了/ bot/ 群体/ 的/ 普遍/ 上线/ 时间/ 习惯/ ,/ 由于/ 僵尸/ 网络/ 可能/ 是/ 针对/ 特定/ 的/ 漏洞/ (/ 比如/ Windows2000SP2/ 漏洞/ )/ 而/ 发展/ 形成/ 的/ ,/ 其/ bot/ 群体/ 的/ 上线/ 时间/ 习惯/ 具有/ 一定/ 的/ 相似性/ [/ 13/ ]/ ,/ 而/ 通信/ 频率/ 特征/ 反映/ 了/ 僵尸/ 网络/ 控制者/ 的/ 使用/ 习惯/ 以及/ 僵尸/ 程序/ 版本/ 等/ 特征/ ./ 首先/ 给出/ 两个/ 定义/ :/ 通信量/ (/ CommunicateCount/ )/ CCi/ (/ t/ )/ ,/ 僵尸/ 网络/ i/ 的/ 通信量/ 随/ 时间/ 变化/ 的/ 函数/ ,/ 它/ 是/ 一个/ 统计/ 值/ 函数/ ,/ 需要/ 给定/ 统计/ 时间/ 间隔/ 大小/ w/ ./ 其中/ i/ 为/ 僵尸/ 网络/ 标号/ ,/ 在/ 不/ 引起/ 岐义/ 的/ 情况/ 下/ ,/ 本文/ 省掉/ i/ ./ 在线/ (/ online/ )/ bot/ 数量/ Oboti/ (/ t/ )/ ,/ 僵尸/ 网络/ i/ 在线/ bot/ 数量/ 的/ 统计/ 函数/ ./ 大多数/ 计算机/ 在/ 夜间/ 关机/ 下线/ ,/ 僵尸/ 网络/ 的/ 通信量/ 在/ 夜间/ 有/ 明显/ 的/ 下降/ ,/ 具有/ 明显/ 的/ 周期性/ ,/ 如图/ 3/ 所示/ ./ 实验/ 显示/ 僵尸/ 网络/ 的/ 通信量/ 每/ 一天/ 的/ 变化/ 曲线/ 相似/ ,/ 统计/ n/ 天/ 的/ 数据/ 计算/ 僵尸/ 网络/ 的/ 通信量/ 日/ 周期函数/ C/ (/ t/ )/ (/ 0/ / t/ / 24h/ )/ 如下/ :/ (/ 1/ )/ 计算/ 每/ 一天/ 的/ 通信量/ CC/ (/ t/ )/ ;/ (/ 2/ )/ 对/ 每/ 一天/ 的/ 数据/ 进行/ 归一化/ ;/ (/ 3/ )/ 平均/ n/ 天/ 的/ 数据/ ;/ (/ 4/ )/ 对/ (/ 3/ )/ 的/ 结果/ 进行/ 归一化/ ,/ 得到/ C/ (/ t/ )/ ;/ 为了/ 度量/ 僵尸/ 网络/ 间/ 通信量/ 特征/ 的/ 相似性/ ,/ 计算/ 其/ 通信量/ 日/ 周期/ 曲线/ 的/ 距离/ ,/ 曲线/ 的/ 距离/ 有/ 欧氏/ 距离/ 、/ DTW/ 、/ LB/ _/ Keogh/ 、/ LB/ _/ PAA/ 距离/ 等/ [/ 15/ ]/ ,/ 此外/ 通信量/ 日/ 周期/ 曲线/ 还有/ 其/ 显著/ 的/ 特点/ :/ 由于/ bot/ 群体/ 的/ 相似性/ ,/ 上线/ 时段/ 集中/ ,/ 有/ 上线/ 高峰/ 和/ 低谷/ ,/ 通信量/ 日/ 周期/ 曲线/ 有/ 明显/ 的/ 曲线/ 峰/ 、/ 谷/ ./ 本文/ 采用/ 欧氏/ 距离/ 计算/ 两/ 曲线/ 的/ 距离/ ./ 3.3/ 通信/ 频率/ 日/ 周期/ 曲线/ 通信量/ 一定/ 程度/ 上/ 反映/ 了/ 僵尸/ 网络/ 在线/ bot/ 数量/ ,/ 而/ 通信/ 频率/ 即/ 单位/ bot/ 主机/ 的/ 通信量/ ,/ 反映/ 的/ 是/ 僵尸/ 网络/ IRC/ 服务器/ 与/ bot/ 间通信/ 的/ 频繁/ 程度/ ./ 实验/ 显示/ ,/ 僵尸/ 网络/ 的/ 通信/ 频率/ 在/ 一天/ 内/ 的/ 平均值/ 趋于/ 常量/ ,/ 如图/ 4/ 所示/ ./ 但是/ 僵尸/ 网络/ 的/ 通信/ 频率/ 在/ 一天/ 内/ 并/ 不/ 恒定/ ,/ 而是/ 同样/ 呈现/ 明显/ 的/ 周期性/ ./ 统计/ n/ 天/ 的/ 数据/ ,/ 计算/ 僵尸/ 网络通信/ 频率/ 日/ 周期函数/ CF/ (/ t/ )/ (/ 0/ / t/ / 24h/ )/ 如下/ :/ (/ 1/ )/ 把/ 每天/ 的/ 通信/ 数据/ 分成/ 24h/ // w/ 份/ (/ w/ 为/ 统计/ 时间/ 间隔/ 大小/ ,/ 它/ 的/ 含义/ 是/ :/ 认为/ 在/ w/ 间隔/ 内有/ 通信/ 的/ IP/ 数为/ 该/ 时间跨度/ 内/ 在线/ 肉/ 机数/ Obot/ (/ t/ )/ ,/ 根据/ 僵尸/ 网络/ IRC/ 服务器/ 与/ bot/ 通信/ 数据/ 的/ 特点/ ,/ 本文/ w/ 取/ 10min/ )/ ,/ 每/ 一份/ 时间跨度/ 为/ w/ ,/ 计算/ 每/ 一份/ 数据/ 中/ 不同/ IP/ 个数/ ,/ 得到/ 在线/ 肉机/ 函数/ Obot/ (/ t/ )/ 的/ 统计/ 值/ ;/ (/ 2/ )/ 计算/ 通信量/ CC/ (/ t/ )/ ,/ 通信/ 频率/ 函数/ CF/ (/ t/ )/ =/ CC/ (/ t/ )/ // Obot/ (/ t/ )/ ,/ 即/ 单位/ bot/ 的/ 通信量/ ./ 若/ Obot/ (/ t/ )/ =/ 0/ ,/ 使用/ 线性插值/ 的/ 方法/ 计算/ CF/ (/ t/ )/ ./ (/ 3/ )/ 平均/ n/ 天/ 的/ 数据/ ,/ 得到/ CF/ (/ t/ )/ (/ 0/ / t/ / 24h/ )/ ;/ (/ 4/ )/ 为了/ 去掉/ 噪声/ 的/ 影响/ ,/ 使用/ 多项式/ 拟合/ Page5CF/ (/ t/ )/ ,/ 得到/ CFS/ (/ t/ )/ ./ 由于/ 互联网/ IP地址/ 紧缺/ ,/ 一些/ 局域网/ 内部/ 网络/ 采用/ NAT/ (/ NetworkAddressTranslation/ )/ 技术/ ,/ 使/ 多台计算机/ 使用/ 一个/ IP/ 共享/ Internet/ 连接/ ,/ 在/ 局域网/ 内部/ 网络/ 中/ 使用/ 内部/ 地址/ ,/ 而/ 当/ 内部/ 节点/ 要/ 与/ 外部/ 网络/ 进行/ 通信/ 时/ ,/ 就/ 在/ 网关/ 将/ 内部/ 地址/ 替换成/ 公用/ 地址/ ./ bot/ 中/ 这类/ IP/ 的/ 通信/ 频率/ 明显/ 大于/ 所属/ 僵尸/ 网络/ 的/ 通信/ 频率/ ,/ 如图/ 5/ 所示/ ,/ 图中/ 两/ 曲线/ 分别/ 为/ 僵尸/ 网络通信/ 频率/ 和/ 该/ 僵尸/ 网络/ 某/ botIP/ 的/ 通信/ 频率/ ./ 因此/ 计算/ 僵尸/ 网络通信/ 频率/ 时/ ,/ 应该/ 剔除/ 掉/ 这些/ IP/ ./ 由于/ 共用/ botIP/ 为/ 静态/ IP/ ,/ 通信/ 时间跨度/ 较长/ ,/ 在/ 计算/ 僵尸/ 网络通信/ 频率/ 时/ ,/ 剔除/ 通信/ 时间跨度/ 超过/ 阈值/ m/ 的/ botIP/ ,/ 本文/ 实验/ m/ 取/ 10d/ ./ 图/ 5/ 共用/ IP/ 与其/ 所属/ 僵尸/ 网络通信/ 频率/ 曲线/ 对比/ 图/ 3.4/ IP/ 聚集/ 度量/ 僵尸/ 网络/ 相似性/ 的/ 另/ 一个/ 方法/ 是/ 计算/ bot/ 的/ 重叠/ 率/ ./ 考虑/ 到/ 互联网/ 上/ 众多/ ADSL/ 上网/ 的/ 主机/ 没有/ 一个/ 固定/ 的/ IP/ ,/ 当/ 主机/ 联网/ ,/ 互联网/ 服务提供商/ (/ ISP/ )/ 从/ 一个/ IP/ 库中/ 对/ 其/ 随意/ 分配/ 一个/ 未经/ 使用/ 的/ IP地址/ ./ 这一/ IP地址/ 只会/ 在/ 该/ 主机/ 上网/ 的/ 时间段/ 中/ 保留/ ,/ 下/ 一次/ 上线/ 可能/ 分配/ 不同/ 的/ IP地址/ ./ 因此/ bot/ 的/ IP地址/ 存在/ 大量/ 动态/ IP/ ,/ 直接/ 计算/ botIP/ 的/ 重叠/ 率会/ 导致/ 很大/ 的/ 误差/ ./ 本/ 小节/ 通过/ bot/ IP地址/ 的/ 聚集/ 操作/ ,/ 将/ bot/ 的/ IP地址/ 集合/ ,/ 映射/ 为/ bot/ 集合/ ,/ 再/ 计算/ 僵尸/ 网络/ 间/ bot/ 的/ 重叠/ 率/ ,/ 以此/ 来/ 度量/ 僵尸/ 网络/ 的/ 相似性/ ./ botIP/ 聚集/ 理想/ 的/ 结果/ 是/ 每/ 一个/ bot/ 使用/ 过/ 的/ IP/ 聚集/ 到/ 同一个/ 集合/ ,/ 不同/ bot/ 对应/ 聚集/ 后/ 的/ 集合/ 不同/ ,/ 即/ 聚集/ 后/ 的/ 集合/ 与/ bot/ 集合/ 一一对应/ ./ 对于/ 给定/ 的/ 僵尸/ 网络/ ,/ 设其/ bot/ 集合/ 为/ B/ ,/ B/ =/ {/ b1/ ,/ …/ ,/ bn/ }/ ,/ bot/ 数量/ 为/ n/ ,/ 即/ |/ B/ |/ =/ n/ ./ 这些/ bot/ 使用/ 过/ 的/ IP地址/ 集合/ 为/ I/ ,/ |/ I/ |/ =/ m/ ,/ m/ / n/ ,/ f/ (/ B/ )/ =/ I/ ,/ f/ 为/ B/ 到/ I/ 的/ 1/ 对/ 多/ 映射/ ./ IP地址/ 是/ 4/ 个/ 小数点/ 隔开/ 的/ 十进制/ 整数/ ,/ 考虑/ 到/ ISP/ 给/ bot/ 主机/ 动态分配/ 的/ IP地址/ 集合/ 具有/ 局部性/ ,/ 对/ bot/ IP地址/ 进行/ 聚集/ 操作/ ,/ 去掉/ IP地址/ 的/ 小数点/ 间隔/ 的/ 第/ 4/ 部分/ ,/ 这样/ 的/ 操作/ 记/ 作/ 映射/ g/ ./ g/ (/ IPi/ )/ =/ g/ (/ IPj/ )/ ,/ 则/ |/ g/ (/ I/ )/ |/ / |/ B/ |/ ;/ n/ ,/ k/ ≠/ l/ )/ ,/ g/ (/ IPi/ )/ ≠/ g/ (/ IPj/ )/ ,/ 则/ |/ g/ (/ I/ )/ |/ / |/ B/ |/ ./ 容易/ 证明/ 以下/ 定理/ ./ 定理/ 1/ ./ 若/ / IPi/ ,/ IPj/ ∈/ f/ (/ bk/ )/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 若/ / IPi/ ∈/ f/ (/ bk/ )/ ,/ / IPj/ ∈/ f/ (/ bl/ )/ (/ k/ ,/ l/ =/ 1/ ,/ 2/ ,/ …/ ,/ 由/ 定理/ 1/ 得到/ 定理/ 2/ ./ 定理/ 2/ ./ 若/ / IPi/ ,/ IPj/ ∈/ f/ (/ bk/ )/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ g/ (/ IPi/ )/ =/ g/ (/ IPj/ )/ ,/ / IPi/ ∈/ f/ (/ bk/ )/ ,/ / IPj/ ∈/ f/ (/ bl/ )/ (/ k/ ,/ l/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ k/ ≠/ l/ )/ ,/ g/ (/ IPi/ )/ ≠/ g/ (/ IPj/ )/ ,/ 则/ |/ g/ (/ I/ )/ |/ =/ |/ B/ |/ ./ 根据/ 定理/ 2/ 的/ 假设/ ,/ 对/ 僵尸/ 网络/ 的/ 足迹/ (/ foot/ -/ print/ )/ (/ 给定/ 监测/ 时间/ 内所/ 监测/ 到/ 的/ botIP/ )/ 即/ 集合/ I/ 进行/ 聚集/ 操作/ ,/ 得到/ g/ (/ I/ )/ ,/ 它/ 与/ bot/ 集合/ 一一对应/ ,/ 计算/ 僵尸/ 网络/ 间/ bot/ 的/ 重叠/ 率/ 以此/ 来/ 度量/ 僵尸/ 网络/ 的/ 相似性/ ./ 3.5/ 相似性/ 度量/ 模型/ 僵尸/ 网络/ 的/ 通信量/ 日/ 周期/ 曲线/ 距离/ 、/ 通信/ 频率/ 日/ 周期/ 曲线/ 距离/ 、/ bot/ 重叠/ 率均/ 可以/ 度量/ 僵尸/ 网络/ 的/ 相似性/ ./ 但是/ 这/ 几种/ 方法/ 各有/ 优缺点/ ,/ 适合/ 不同/ 的/ 情况/ ,/ 根据/ 单独/ 的/ 一个/ 特征/ 不能/ 准确/ 地/ 判断/ 僵尸/ 网络/ 的/ 相似性/ ./ 譬如/ 僵尸/ 网络/ 间/ 没有/ bot/ 的/ 重叠/ ,/ 也/ 可能/ 是/ 同一个/ 僵尸/ 网络/ ,/ 它们/ 是/ 同一个/ 僵尸/ 网络/ 的/ 不同/ bot/ 群体/ ,/ 如图/ 2/ (/ b/ )/ 所示/ ./ 本/ 小节/ 融合/ 以上/ 方法/ 的/ 度量/ 结果/ ,/ 建立/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ,/ 第/ 4/ 节将/ 验证/ 模型/ 的/ 有效性/ ./ 僵尸/ 网络/ 相似性/ 度量/ 指标/ :/ bot/ 重叠/ 率/ 、/ 通信量/ 日/ 周期/ 曲线/ 距离/ 、/ 通信/ 频率/ 日/ 周期/ 曲线/ 距离/ ./ 相似性/ 度量/ 函数/ 应该/ 满足/ 下面/ 的/ 性质/ :/ 单调/ 性/ ./ 函数/ 值/ 随/ 某个/ 指标/ 的/ 值/ 的/ 增加/ 而/ 增加/ 或者/ 随/ 某个/ 指标/ 的/ 值/ 的/ 增加/ 而/ 减小/ ./ 敏感性/ ./ 函数/ 值/ 随/ 各/ 指标值/ 变化/ 的/ 变化/ 速度/ 不同/ ,/ 对/ 更/ 重要/ 指标/ ,/ 函数/ 值/ 对/ 其/ 变化/ 更/ 敏感/ ./ 鲁棒性/ ./ 若/ 某个/ 指标/ 误差/ 较大/ ,/ 函数/ 值/ 能够/ 一定/ 程度/ 地/ 屏蔽其/ 对/ 结果/ 的/ 影响/ ./ bot/ 重叠/ 率/ 、/ 通信量/ 日/ 周期/ 曲线/ 距离/ 、/ 通信/ 频率/ 日/ 周期/ 曲线/ 距离/ 的/ 值/ 进行/ 归一化/ 处理/ 后/ 分别/ 计为/ S1/ ,/ S2/ ,/ S3/ ,/ 其权值/ 系数/ 记为/ w1/ ,/ w2/ ,/ w3/ ./ 相似性/ 度量/ 函数/ :/ 僵尸/ 网络/ 对/ 的/ 相似性/ 度量/ 函数/ 值越/ 小/ ,/ 表示/ 僵尸/ 网络/ 对/ 的/ 相似性/ 越大/ ./ 容易/ 验证/ ,/ 函数/ 满足/ 单调/ 性/ 、/ 敏感性/ 、/ 鲁棒性/ ./ 权值/ 系数/ 的/ 确定/ ,/ 最优/ 分类/ 判别/ 值/ 的/ 计算/ 以及/ 模型/ 有效性/ 验证/ 见/ 第/ 4/ 节/ ./ Page64/ 实验/ 及/ 验证/ 对/ 863/ -/ 917/ 网络安全/ 监测/ 平台/ 60d/ 内/ 监测/ 到/ 的/ 723/ 个/ 僵尸/ 网络/ ,/ 分别/ 计算/ 通信量/ 日/ 周期/ 曲线/ 、/ 通信/ 频率/ 日/ 周期/ 曲线/ ,/ 进行/ IP/ 聚集/ 操作/ ./ 4.1/ 节/ 列出/ 了/ 部分/ 结果/ ;/ 最优/ 分类/ 判别/ 值/ 的/ 计算/ 以及/ 相似性/ 度量/ 模型/ 有效性/ 的/ 验证/ 见/ 4.2/ 节/ ./ 4.1/ 实验/ 图/ 6/ 、/ 图/ 7/ 为/ 其中/ 两对/ 僵尸/ 网络通信/ 量/ 日/ 周期/ 曲线/ 对比/ 图/ ./ 图/ 6/ 两条/ 曲线/ 的/ 欧氏/ 距离/ 为/ 0.0672/ ./ 图/ 7/ 两条/ 曲线/ 的/ 欧氏/ 距离/ 0.0745/ ./ 两对/ 僵尸/ 网络/ 均/ 为/ 国外/ IRC/ 服务器/ 控制/ 国内/ 受控/ 主机/ ./ 僵尸/ 网络/ 1/ -/ 僵尸/ 网络/ 4/ 控制/ 服务器/ 分别/ 在/ 美国/ 、/ 美国/ 、/ 加拿大/ 、/ 加拿大/ ./ 图/ 6/ 僵尸/ 网络/ 对/ 通信量/ 日/ 周期/ 曲线/ 对比/ 图/ 1/ 图/ 7/ 僵尸/ 网络/ 对/ 通信量/ 日/ 周期/ 曲线/ 对比/ 图/ 2/ 图/ 8/ ~/ 图/ 11/ 为/ 僵尸/ 网络/ 1/ ~/ 4/ 的/ 通信/ 频率/ 日周/ 对/ 僵尸/ 网络/ 1/ ~/ 4/ 进行/ IP/ 聚集/ ,/ 结果/ 如表/ 1/ 、/ 期/ 曲线图/ ./ 表/ 2/ 所示/ ./ 聚集/ 前/ IP/ 数/ 4277851241272/ 聚集/ 后/ IP/ 数/ 8532110550346Page7/ 聚集/ 前/ IP/ 数/ 1130310634480545/ 聚集/ 后/ IP/ 数/ 40093903336086/ 这里/ 的/ IP/ 数指/ 僵尸/ 网络/ bot/ 的/ 足迹/ (/ foot/ -/ print/ )/ 大小/ ,/ 即/ 在/ 给定/ 监测/ 时间/ 内所/ 监测/ 到/ 的/ botIP/ 总数/ ./ 两对/ 僵尸/ 网络/ 的/ IP/ 重叠/ 率/ 聚集/ 后/ 有/ 明显增加/ ./ 4.2/ 有效性/ 验证/ 对于/ 监测/ 到/ 的/ 723/ 个/ 僵尸/ 网络/ ,/ 我们/ 采用/ 蜜网/ 蜜罐/ 跟踪/ 、/ 域名/ 监测/ 系统日志/ 分析/ 等/ 手段/ 确认/ 相同/ 僵尸/ 网络/ 150/ 对/ 和/ 不同/ 僵尸/ 网络/ 150/ 对/ ./ 其中/ 100/ 对/ 相同/ 僵尸/ 网络/ 和/ 100/ 对/ 不同/ 僵尸/ 网络/ 作为/ 模型/ 中/ 分类/ 方法/ 的/ 训练/ 集/ ,/ 其余/ 作为/ 测试/ 集/ ./ 使用/ 僵尸/ 网络通信/ 特征/ 曲线/ 距离/ 、/ bot/ 重叠/ 率/ 以及/ 综合/ 各/ 指标/ 的/ 相似性/ 度量/ 模型/ 均/ 可以/ 度量/ 僵尸/ 网络/ 的/ 相似性/ ,/ 本/ 小节/ 通过/ 训练/ 集/ 确定/ 各种/ 方法/ 的/ 最优/ 分类/ 判别/ 值/ ,/ 计算/ 其/ 分类/ 错误率/ ,/ 并/ 对/ 产生/ 错误/ 的/ 各类/ 情况/ 分析/ 了/ 可能/ 的/ 原因/ ./ 使用/ 测试/ 集/ 验证/ 了/ 相似性/ 度量/ 模型/ 分类/ 识别/ 相同/ 僵尸/ 网络/ 的/ 有效性/ ./ 图/ 12/ 为/ 僵尸/ 网络/ 对/ 通信量/ 日/ 周期/ 曲线/ 距离/ 值/ 分布/ ./ 横坐标/ 为/ 僵尸/ 网络/ 对/ 标号/ ,/ 标号/ 属于/ [/ 1/ ,/ 100/ ]/ 和/ [/ 101/ ,/ 200/ ]/ 分别/ 为/ 相同/ 僵尸/ 网络/ 对/ 和/ 不同/ 僵尸/ 网络/ 对/ ./ 记/ 相同/ 僵尸/ 网络/ 对/ 通信量/ 日/ 周期/ 曲线/ 距离/ 为/ Dtrue/ (/ i/ )/ ,/ 1/ / i/ / 100/ ,/ 不同/ 僵尸/ 网络/ 对/ 通信量/ 日/ 周期/ 曲线/ 距离/ 为/ Dfalse/ (/ i/ )/ ,/ 101/ / i/ / 200/ ./ 对/ 两/ 集合/ {/ Dtrue/ (/ i/ )/ |/ 1/ / i/ / 100/ }/ 、/ {/ Dfalse/ (/ i/ )/ |/ 101/ / i/ / 200/ }/ 分别/ 采用/ Shapiro/ -/ Wilk/ 算法/ 检验/ 数据/ 的/ 正态性/ ,/ 取/ α/ =/ 0.05/ ,/ 得到/ 两/ 数据/ 集/ 服从/ 正态分布/ ,/ 统计/ 计算/ 其/ 均值/ μ/ 和/ 方差/ δ/ 2/ ./ 根据/ 通信量/ 日/ 周期/ 曲线/ 距离/ 对/ 僵尸/ 网络/ 对/ 进行/ 分类/ ,/ 最优/ 分类/ 判别/ 值/ η/ (/ 分类/ 规则/ 为/ 距离/ 小于/ 或/ 等于/ η/ 认为/ 是/ 同一/ 僵尸/ 网络/ ,/ 距离/ 大于/ η/ 认为/ 是/ 不同/ 僵尸/ 网络/ )/ 的/ 理论值/ 为/ (/ P/ (/ Ftrue/ (/ x/ )/ >/ η/ )/ +/ P/ (/ Ffalse/ (/ x/ )/ / η/ )/ )/ // 2/ ,/ η/ =/ min/ ξ/ 错误率/ 为/ 其中/ P/ (/ Ftrue/ (/ x/ )/ >/ η/ )/ 为弃/ 真/ 错误率/ ,/ 弃真/ 错误/ 指/ 相同/ 僵尸/ 网络/ 而/ 作出/ 不同/ 僵尸/ 网络/ 的/ 判断/ ./ P/ (/ Ffalse/ (/ x/ )/ / η/ )/ 为/ 取伪/ 错误率/ ,/ 取伪/ 错误/ 指/ 不同/ 僵尸/ 网络/ 而/ 作出/ 相同/ 僵尸/ 网络/ 的/ 判断/ ./ 采用/ 迭代/ 的/ 方法/ 计算/ 最优/ 分类/ 判别/ 值/ η/ 和/ 3/ 类/ 错误率/ 如表/ 3/ ./ 图/ 13/ 为/ 进行/ 归一化/ 处理/ 的/ 僵尸/ 网络/ 对/ 通信/ 频率/ 日/ 周期/ 曲线/ 距离/ 值/ 分布/ ,/ 同样/ 的/ 方法/ 计算/ 最优/ 分类/ 判别/ 值/ η/ 和/ 3/ 类/ 错误率/ 如表/ 3/ ./ 错误率/ 较/ 高/ 的/ 原因/ 是/ 对/ 通信/ 频率/ 日/ 周期/ 曲线/ 只是/ 进行/ 简单/ 的/ 归一化/ 处理/ ,/ 没有/ 考虑/ 曲线/ 形状/ 、/ 均值/ 、/ 方差/ 等/ 与/ 通信/ 频率/ 特征/ 的/ 相关性/ ./ 图/ 13/ 僵尸/ 网络/ 对/ 通信/ 频率/ 日/ 周期/ 曲线/ 距离/ 图/ 14/ 为/ 僵尸/ 网络/ 对/ IP/ 聚集/ 后/ bot/ 重叠/ 率/ 计算/ 值/ 分布/ ,/ 不/ 考虑/ 样本/ 点/ 的/ 分布/ ,/ 计算/ 最优/ 分类/ 判别/ 值/ η/ 和/ 3/ 类/ 错误率/ 如表/ 3/ ./ 弃真/ 错误率/ 为/ 0/ ,/ 这/ 是因为/ 不同/ 的/ 僵尸/ 网络/ bot/ 重叠/ 率/ 很/ 低/ ,/ 但是/ 取伪/ 错误率/ 较/ 高/ ,/ 因为/ 相同/ 僵尸/ 网络/ 有/ 可能/ 是/ 图/ 2/ (/ b/ )/ 所示/ 分层/ 管理/ 的/ 情况/ ,/ 其/ bot/ 重叠/ 率低/ ,/ 从图/ 14/ 也/ 可以/ 看出/ ,/ Page8/ 相同/ 僵尸/ 网络/ 的/ bot/ 重叠/ 率/ 分布/ 点/ 聚集/ 在/ 两个/ 区域/ ;/ 此外/ ,/ IP/ 聚集/ 时/ 定理/ 2/ 的/ 假设/ 可能/ 并/ 不/ 严格/ 成立/ ,/ 导致/ 了/ 结果/ 的/ 偏差/ ./ 使用/ 相似性/ 度量/ 模型/ 计算/ 僵尸/ 网络/ 对/ 相似性/ 表/ 3/ 僵尸/ 网络/ 相似性/ 度量/ 各/ 方法/ 最优/ 分类/ 判别/ 值及/ 错误率/ 通信量/ 特征/ 比/ 对/ 方法/ 通信/ 频率/ 特征/ 比/ 对/ 方法/ 计算/ bot/ 重叠/ 率/ 方法/ 相似性/ 度量/ 模型/ (/ 训练/ 集/ )/ 相似性/ 度量/ 模型/ (/ 测试/ 集/ )/ 0.810/ ./ 840.940/ ./ 89/ 使用/ 训练/ 集/ 计算/ 所得/ 的/ 最优/ 分类/ 判别/ 值/ η/ ,/ 通过/ 测试/ 集/ 检测/ 模型/ 识别/ 相同/ 与/ 不同/ 僵尸/ 网络/ 的/ 准确率/ 结果/ 如图/ 16/ 、/ 表/ 3/ ./ 从/ 结果/ 可以/ 看出/ ,/ 融合/ 了/ 通信/ 特征提取/ 和/ IP/ 聚集/ 的/ 相似性/ 度量/ 模型/ 识别/ 相同/ 与/ 不同/ 僵尸/ 网络/ 的/ 准确率/ 较/ 高/ ./ 4.3/ 迁移/ 分析/ 利用/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ 计算/ 的/ 结果/ ,/ 对于/ 相同/ 僵尸/ 网络/ 对/ ,/ 本/ 小节/ 定性/ 地/ 分析/ 僵尸/ 网络/ 的/ 迁移/ ,/ 典型/ 的/ 几类/ 情况/ 如下/ ./ 图/ 17/ 为/ 某/ 对/ 僵尸/ 网络/ 的/ 通信量/ 曲线/ 对比/ 图/ ,/ 横坐标/ 单位/ 为天/ ./ 从图/ 17/ 可以/ 看出/ ,/ 在/ 某/ 时间段/ ,/ 僵尸/ 值/ ,/ 相似性/ 度量/ 函数/ 各/ 指标/ 的/ 权值/ 取/ 对应/ 方法/ 的/ 准确率/ ,/ 如表/ 3/ 所示/ ,/ 图/ 15/ 为/ 僵尸/ 网络/ 对/ 相似性/ 距离/ 值/ 分布/ ,/ 同样/ 不/ 考虑/ 样本/ 点/ 的/ 分布/ ,/ 计算/ 最优/ 分类/ 判别/ 值/ η/ 和/ 3/ 类/ 错误率/ (/ 如表/ 3/ 所示/ )/ ./ 网络/ 1/ 没有/ 通信/ ,/ 而/ 僵尸/ 网络/ 2/ 在/ 该/ 时间段/ 的/ 通信量/ 普遍/ 超过/ 其它/ 时间段/ 的/ 通信量/ ./ 图/ 18/ 为/ 另/ 一对/ 僵尸/ 网络/ 的/ 通信量/ 曲线/ 对比/ 图/ ,/ 在/ 其中/ 一/ 时间段/ ,/ 僵尸/ 网络/ 4/ 没有/ 通信/ ,/ 而/ 僵尸/ 网络/ 3/ 在/ 该/ 时间段/ 的/ 通信量/ 超过/ 其/ “/ 正常/ ”/ 通信量/ ./ 图/ 19/ 为/ 第/ 3/ 对/ 僵尸/ 网络/ 的/ 通信量/ 曲线/ 对比/ 图/ ,/ 从图/ 19/ 可以/ 看出/ ,/ 僵尸/ 网络/ 5/ 在/ 某/ 时间段/ 通信量/ 为/ 0/ ,/ 而/ 僵尸/ 网络/ 6/ 只/ 在/ 这个/ 时间段/ 有/ 通信/ ,/ 把/ 两/ 僵尸/ 网络通信/ 量/ 叠加/ ,/ 叠加/ 之后/ 的/ 通信量/ 按天/ 递减/ ./ 考虑/ 展示/ 时间/ 粒度/ 更细/ 的/ 情况/ ,/ 图/ 20/ 为/ 第/ 2/ 对/ Page9/ 僵尸/ 网络/ 的/ 通信量/ 曲线/ 对比/ 图/ ,/ 横坐标/ 单位/ 为/ 小时/ ./ 从图/ 20/ 可以/ 看出/ ,/ 在/ 某/ 时间段/ ,/ 僵尸/ 网络/ 4/ 没有/ 通信/ ,/ 而/ 僵尸/ 网络/ 3/ 在/ 该/ 时间段/ 的/ 通信量/ 超过/ 其他/ 时间段/ 的/ 通信量/ ./ 并且/ 在/ 这个/ 时间段/ 的/ 开端/ ,/ 僵尸/ 网络/ 3/ 的/ 通信量/ 大小/ 发生/ 了/ 跳跃/ ./ 这/ 是因为/ 僵尸/ 网络/ 在/ 迁移/ 初始/ 阶段/ bot/ 与/ 新/ 的/ IRC/ 服务器/ 有/ 额外/ 的/ 认证/ 等/ 通信/ ./ 从/ 以上/ 几个/ 例子/ 可以/ 看出/ ,/ 僵尸/ 网络/ 的/ 迁移/ 在/ 通信量/ 方面/ 有/ 如下/ 特点/ :/ 僵尸/ 网络/ 发生/ 迁移/ 所/ 导致/ 的/ 通信/ 对象/ 的/ 改变/ 会/ 反映/ 到/ 僵尸/ 网络/ 对/ 通信量/ 的/ 变化/ ,/ 即/ “/ 此消彼长/ ”/ ./ 若/ 把/ 两个/ 僵尸/ 网络通信/ 量/ 曲线/ 叠加/ ,/ 叠加/ 后/ 的/ 曲线/ 符合/ 自然/ 的/ 变化规律/ ;/ 迁移/ 初始/ 阶段/ 由于/ bot/ 与/ 新/ 的/ IRC/ 服务器/ 有/ 额外/ 的/ 认证/ 等/ 通信/ ,/ 迁移/ 目的/ 僵尸/ 网络通信/ 量/ 大小/ 在/ 短时间/ 内有/ 较/ 明显/ 的/ 跳跃/ ./ 当然/ ,/ 根据/ 僵尸/ 网络通信/ 量/ 的/ 变化/ 并不一定/ 能/ 检测/ 出/ 僵尸/ 网络/ 的/ 迁移/ ;/ 僵尸/ 网络/ 发生/ 迁移/ 也/ 不是/ 相同/ 僵尸/ 网络/ 的/ 必要条件/ ,/ 图/ 2/ (/ b/ )/ 所示/ 的/ 僵尸/ 子/ 网络/ 没有/ 迁移/ ,/ 但/ 它们/ 是/ 同一个/ 僵尸/ 网络/ 的/ 不同/ bot/ 群体/ ./ 5/ 结束语/ 本文/ 通过/ 提取/ 并/ 比/ 对/ 僵尸/ 网络通信/ 特征/ ,/ IP/ 聚集/ 估算/ bot/ 重叠/ 率/ ,/ 建立/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ,/ 分类/ 识别/ 使用/ 不同/ 控制/ 服务器/ 的/ 相同/ 僵尸/ 网络/ ./ 下/ 一步/ 的/ 工作/ 主要/ 有/ :/ (/ 1/ )/ 本文/ 计算/ 僵尸/ 网络通信/ 特征/ 曲线/ 距离/ 采用/ 欧氏/ 距离/ ,/ 考虑/ 到/ 曲线/ 自身/ 的/ 特点/ :/ 由于/ bot/ 群体/ 的/ 相似性/ ,/ 上线/ 时段/ 集中/ ,/ 有/ 上线/ 高峰/ 和/ 低谷/ ,/ 通信量/ 日/ 周期/ 曲线/ 有/ 明显/ 的/ 曲线/ 峰/ 、/ 谷/ 等/ ./ 应该/ 考虑/ 更/ 合理/ 有效/ 的/ 曲线/ 距离/ 计算方法/ ,/ 考虑/ 曲线/ 形状/ 、/ 均值/ 、/ 方差/ 与/ 通信/ 特征/ 的/ 相关性/ ./ (/ 2/ )/ 相似性/ 度量/ 模型/ 中/ 的/ 权值/ 系数/ 是/ 训练/ 集/ 所得/ 错误率/ 计算/ 所得/ ,/ 应该/ 再/ 考虑/ 弃真/ 错误率/ 和/ 取伪/ 错误率/ 以及/ 它们/ 的/ 方差/ 等/ ./ (/ 3/ )/ 形式化/ 描述/ 并/ 提取/ 僵尸/ 网络/ 迁移/ 时/ 通信量/ 变化/ 的/ 特征/ ,/ 研究/ 僵尸/ 网络/ 迁移/ 检测/ 方法/ ,/ 作为/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ 的/ 指标/ 之一/ ./ (/ 4/ )/ 在/ 建立/ 僵尸/ 网络/ 相似性/ 度量/ 模型/ ,/ 准确/ 识别/ 使用/ 不同/ 控制/ 服务器/ 的/ 相同/ 僵尸/ 网络/ 的/ 基础/ 上/ ,/ 评估/ 僵尸/ 网络/ 的/ 规模/ 以及/ 危害/ ;/ 建立/ 僵尸/ 网络/ 生命周期/ 模型/ ,/ 研究/ 僵尸/ 网络/ 的/ 衍变/ 特性/ ./ 

