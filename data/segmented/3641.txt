Page1/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 叶可江/ 吴/ 朝晖/ 姜晓红何/ 钦铭/ (/ 浙江大学/ 计算机科学/ 与/ 技术/ 学院/ 杭州/ 310027/ )/ 摘要/ 数据中心/ 的/ 高能耗/ 是/ 一个/ 亟待解决/ 的/ 问题/ ./ 近年来/ ,/ 虚拟化/ 技术/ 和/ 云/ 计算/ 模式/ 快速/ 发展/ 起来/ ,/ 因/ 其/ 具有/ 资源/ 利用率/ 高/ 、/ 管理/ 灵活/ 、/ 可扩展性/ 好/ 等/ 优点/ ,/ 未来/ 的/ 数据中心/ 将/ 广泛/ 采用/ 虚拟化/ 技术/ 和/ 云/ 计算技术/ ./ 将/ 传统/ 的/ 能耗/ 管理/ 技术/ 与/ 虚拟化/ 技术相结合/ ,/ 为云/ 计算/ 数据中心/ 的/ 能耗/ 管理/ 问题/ 提供/ 了/ 新/ 的/ 解决/ 思路/ ,/ 是/ 一个/ 重要/ 的/ 研究/ 方向/ ./ 文中/ 从/ 能耗/ 测量/ 、/ 能耗/ 建模/ 、/ 能耗/ 管理/ 实现/ 机制/ 、/ 能耗/ 管理/ 优化/ 算法/ 4/ 个/ 方面/ 对/ 虚拟化/ 云/ 计算/ 平台/ 能耗/ 管理/ 的/ 最新/ 研究成果/ 进行/ 了/ 介绍/ ./ 论文/ 分析/ 了/ 虚拟化/ 云/ 计算/ 平台/ 面临/ 的/ 操作/ 管理/ 和/ 能耗/ 管理/ 两/ 方面/ 的/ 问题/ ,/ 指出/ 了/ 虚拟化/ 云/ 计算/ 平台/ 能耗/ 监控/ 与/ 测量/ 的/ 难点/ ;/ 介绍/ 了/ 能耗/ 监测/ 步骤/ 及/ 能耗/ 轮廓/ 分析方法/ ;/ 提出/ 了/ 虚拟机/ 系统/ 的/ 整体/ 能耗/ 模型/ 及/ 服务器/ 整合/ 和/ 在线/ 迁移/ 两种/ 关键技术/ 本身/ 的/ 能耗/ 模型/ ;/ 从/ 虚拟化/ 层/ 和/ 云/ 平台/ 层/ 两个/ 层次/ 总结/ 了/ 目前/ 能耗/ 管理机制/ 方面/ 取得/ 的/ 进展/ ;/ 并/ 对/ 能耗/ 管理/ 算法/ 进行/ 分类/ 、/ 比较/ ./ 最后/ 对/ 全文/ 进行/ 总结/ ,/ 提出/ 了/ 未来/ 十个/ 值得/ 进一步/ 研究/ 的/ 方向/ ./ 关键词/ 虚拟化/ ;/ 云/ 计算/ ;/ 能耗/ 管理/ ;/ 绿色/ 计算/ ;/ 在线/ 迁移/ ;/ 服务器/ 整合/ 1/ 引言/ 近年来/ ,/ 数据中心/ 的/ 高能耗/ 逐渐/ 成为/ 一个/ 突出/ 的/ 问题/ ,/ 尤其/ 是/ 随着/ 云/ 计算/ 时代/ 的/ 到来/ ,/ 更/ 多/ 的/ 计算资源/ 和/ 存储资源/ 集中/ 在/ 云端/ ,/ 给/ 能耗/ 的/ 高效/ 管理/ 带来/ 更大/ 的/ 挑战/ [/ 1/ -/ 2/ ]/ ./ 据统计/ ,/ 2006/ 年/ 美国/ 6000/ 个/ 左右/ 的/ 数据中心/ ,/ 消耗/ 了/ 大约/ 610/ 亿千瓦时/ 的/ 电能/ ,/ 总值/ 高达/ 45/ 亿美元/ ,/ 超过/ 了/ 当年/ 美国/ 所有/ 彩色/ 电视机/ 的/ 总/ 能耗/ [/ 3/ ]/ ./ 来自/ 美国能源部/ 的/ 数据/ 表明/ ,/ 数据中心/ 的/ 能耗/ 占/ 全美/ 所有/ 能耗/ 的/ 1.5/ %/ ,/ 并且/ 对/ 电能/ 的/ 需求/ 仍/ 在/ 以/ 每年/ 12/ %/ 的/ 速度/ 增长/ ./ 如/ 按/ 这种/ 速度/ 增长/ ,/ 到/ 2011/ 年/ ,/ 数据中心/ 会/ 消耗/ 1000/ 亿千瓦时/ 的/ 电能/ ,/ 每年/ 花费/ 约/ 74/ 亿美元/ [/ 3/ ]/ ./ 此外/ ,/ IDC/ (/ Interna/ -/ tionalDataCorporation/ )/ 市场/ 研究/ 公司/ 对/ 全球/ 所有/ 企业/ 电能/ 花费/ 的/ 评估/ 结果表明/ ,/ 每年/ 全球/ 的/ 企业/ 大概/ 要花费/ 400/ 亿美元/ 在/ 能耗/ 上/ [/ 4/ ]/ ./ 数据中心/ 的/ 高能耗/ 问题/ 不仅/ 造成/ 电能/ 的/ 浪费/ 、/ 系统/ 运行/ 的/ 不/ 稳定/ ,/ 同时/ 也/ 对/ 环境/ 造成/ 不良影响/ ./ 美国联邦/ 机构/ 已经/ 指出/ 高能耗/ 问题/ 将/ 对/ 空气质量/ 、/ 国家/ 安全/ 、/ 气候变化/ 、/ 电网/ 可靠性/ 等/ 方面/ 造成/ 严重/ 影响/ ./ 高能耗/ 问题/ 主要/ 来源于/ 两个/ 方面/ ,/ 一个/ 是/ 处理器/ 层次/ 的/ 能耗/ ,/ 另/ 一个/ 是/ 数据中心/ 层次/ 的/ 能耗/ ./ 随着/ 处理器/ 制造/ 工艺/ 的/ 不断进步/ ,/ 今天/ 的/ IntelItanium2/ 处理器/ 的/ 晶体管/ 数量/ 已/ 达到/ 10/ 亿个/ [/ 5/ ]/ ./ 处理器/ 在/ 获得/ 高/ 运行/ 速度/ 的/ 同时/ ,/ 带来/ 了/ 高能耗/ 问题/ ./ 尽管/ 一些/ 硬件/ 上/ 的/ 优化/ 技术/ 在/ 一定/ 程度/ 上/ 提升/ 了/ 能量/ 的/ 使用/ 效率/ ,/ 但是/ 处理器/ 的/ 能耗/ 受/ 应用程序/ 使用/ 模式/ 的/ 影响/ ,/ 过高/ 的/ 负载/ 和/ 过/ 低/ 的/ 利用率/ 都/ 会/ 导致/ 高能耗/ 和/ 电能/ 低效/ 使用/ 的/ 问题/ ./ 在/ 数据中心/ 层次/ ,/ 随着/ 数据中心/ 规模/ 的/ 不断/ 增长/ ,/ 数据中心/ 出现/ 了/ 两难/ 的/ 境况/ ./ 一方面/ 由于/ 物理/ 服务器/ 数量/ 不断/ 增多/ 和/ 处理/ 能力/ 不断/ 增强/ ,/ 带来/ 了/ 更/ 多/ 的/ 能量消耗/ ,/ 另一方面/ 每个/ 服务器/ 过低/ 的/ 利用率/ 又/ 造成/ 了/ 巨大/ 的/ 电能/ 浪费/ ./ IBM/ 的/ Bohrer/ 等/ 人/ [/ 6/ ]/ 曾/ 对/ 真实/ 的/ 若干/ 典型/ Web/ 服务器/ 负载/ (/ 体育/ 、/ 电子商务/ 、/ 财经/ 、/ 互联网/ 代理/ 集群/ )/ 进行/ 研究/ ,/ 发现/ 数据中心/ 服务器/ 的/ 平均/ 利用率/ 在/ 11/ %/ ~/ 50/ %/ 之间/ ./ Barroso/ 等/ 人/ [/ 7/ ]/ 对/ 超过/ 5000/ 台/ 服务器/ 长达/ 6/ 个/ 月/ 的/ 运行/ 情况/ 进行/ 统计分析/ ,/ 也/ 得出/ 类似/ 的/ 结论/ ./ 高能耗/ 带来/ 的/ 另/ 一个/ 问题/ 是/ 配套/ 的/ 冷却/ 设施/ 开销/ 极大/ ./ 据统计/ ,/ 计算资源/ 消耗/ 的/ 每/ 1/ 瓦/ 电能/ ,/ 就/ 需要/ 额外/ 的/ 0.5/ ~/ 1/ 瓦特/ 进行/ 冷却/ [/ 8/ ]/ ./ 另外/ ,/ 也/ 有/ 统计数据/ 表明/ ,/ Google/ 数据中心/ 的/ 能耗/ 有/ 一半/ 是/ 花/ 在/ 了/ 冷却/ 上/ [/ 3/ ]/ ./ 因此/ ,/ 迫切需要/ 开发新/ 的/ 技术/ 来/ 解决/ 数据中心/ 的/ 高能耗/ 问题/ ,/ 包括/ 重新考虑/ 硬件/ 、/ 软件/ 、/ 算法/ 的/ 设计/ ,/ 特别/ 是/ 必须/ 把/ 能耗/ 作为/ 数据中心/ 设计/ 和/ 管理/ 的/ 一个/ 重要/ 参数/ 进行/ 考虑/ ,/ 而/ 不仅仅/ 是/ 考虑/ 数据中心/ 的/ 性能参数/ ./ 针对/ 数据中心/ 的/ 高能耗/ 问题/ ,/ 相关/ 政府/ 机构/ 、/ 社会/ 团体/ 、/ 学术/ 组织/ 已经/ 开始/ 积极关注/ ./ 2007/ 年/ ,/ 绿色/ 网格/ 组织/ (/ GreenGrid/ )/ ①/ 成立/ ,/ 它/ 的/ 目标/ 就是/ 要/ 降低/ 数据中心/ 和/ 商业/ 计算/ 系统/ 的/ 能耗/ ./ 为了/ 达到/ 这个/ 目标/ ,/ 绿色/ 网格/ 组织/ 联合/ 了/ 公司/ 、/ 政府部门/ 、/ 工业界/ 团体/ ,/ 共同/ 研究/ 并/ 试图/ 提供/ 最佳/ 的/ 数据中心/ 节能/ 实践/ 方法/ 、/ 评估/ 方法/ 和/ 技术/ ./ 同年/ ,/ Green500/ 组织/ (/ Green500List/ )/ ②/ 成立/ ,/ 该/ 组织/ 每年/ 会/ 发布/ 2/ 个/ 报告/ (/ 分别/ 是/ 在/ 当年/ 的/ 6/ 月/ 和/ 12/ 月/ )/ ,/ 以/ MegaFlops/ // W/ (/ 即/ 每/ 瓦特/ 电力/ 所/ 能/ 完成/ 的/ 每秒/ 百万/ 次/ 浮点/ 计算/ 操作/ )/ 为/ 指标/ ,/ 对/ 全球/ 范围/ 内/ 最快/ 的/ 500/ 台/ 超级计算机/ 的/ 节能/ 效率/ 进行/ 排序/ ,/ 作为/ 对/ TOP500/ 排名/ 的/ 补充/ ./ 2008/ 年/ ,/ 国际/ 气候/ 组织/ (/ TheClimateGroup/ )/ ③/ 和/ 全球/ 电子/ 可/ 持续/ 发展/ 倡议/ 组织/ (/ GeSI/ )/ ④/ 联合/ 发布/ 了/ 题为/ 《/ SMART2020/ :/ 实现/ 信息时代/ 的/ 低/ 碳/ 经济/ 》/ 的/ 报告/ ./ 该/ 报告/ 表明/ ,/ 到/ 2020/ 年/ ,/ 信息/ 通信/ 技术/ (/ ICT/ )/ 共计/ 能/ 减少/ 近/ 78/ 亿吨/ CO2/ 的/ 排放/ ,/ 相当于/ 2020/ 年/ 基准/ 情景/ 下/ 排放/ 总量/ 的/ 15/ %/ ./ IEEE/ 也/ 正在/ 制定/ 一项/ 能/ 被/ 国际/ 社会/ 接受/ 的/ 新/ 标准/ IEEEP1595/ ⑤/ ,/ 该/ 标准/ 旨在/ 检测/ 、/ 评估/ 和/ 量化/ 由/ 可/ 再生能源/ 和/ 节能/ 措施/ 所/ 带来/ 的/ 温室/ 气体/ 排放/ 的/ 改善/ 效果/ ./ Google/ 也/ 专门/ 成立/ 了/ 一个/ 能量/ 子公司/ GoogleEnergy/ 来/ 减少/ 本/ 公司/ 的/ 能耗/ ,/ 同时/ 也/ 制造/ 和/ 销售/ 清洁/ 能源/ ./ 此外/ ,/ SPEC/ (/ StandardPerformanceEvaluationCorporation/ )/ ⑥/ 、/ TPC/ (/ TheTransactionProcessingPerformanceCouncil/ )/ ⑦/ 等/ 国际/ 性能/ 评估/ 标准化/ 组织/ 也/ 都/ 在/ 致力于/ 能耗/ 的/ 标准化/ 评价/ 和/ 优化/ 问题/ ./ 当前/ ,/ 虚拟化/ 技术/ 的/ 快速/ 发展/ 给/ 数据中心/ 的/ 能耗/ 管理/ 问题/ 提供/ 了/ 新/ 的/ 解决/ 思路/ [/ 9/ ]/ ./ 尤其/ 是/ 当云/ 计算/ 成为/ 未来/ 数据中心/ 发展/ 的/ 主要/ 方向/ 时/ ,/ 因/ 其/ 拥有/ 服务器/ 整合/ [/ 10/ ]/ 、/ 在线/ 迁移/ [/ 11/ ]/ 、/ 隔离/ 性/ [/ 12/ ]/ 、/ 高可用性/ [/ 13/ ]/ 、/ 灵活/ 部署/ [/ 14/ ]/ 、/ 低/ 管理/ 开销/ 等/ 诸多方面/ 的/ 优点/ ,/ 虚拟化/ 技术/ 面临/ 更大/ 的/ 发展/ 空间/ ./ 加州大学/ 伯克利/ ①/ ②/ ③/ ④/ ⑤/ ⑥/ ⑦/ Page3/ 分校/ 的/ Patterson/ 教授/ 曾/ 提出/ “/ 数据中心/ 是/ 一个/ 计算机/ ”/ 的/ 著名/ 论断/ [/ 15/ ]/ ./ 云/ 计算/ 数据中心/ 就是/ 这样/ 一个/ 计算机/ ,/ 它/ 通过/ 网络/ ,/ 以/ 付费/ 即用/ 的/ 方式/ ,/ 为/ 全世界/ 的/ 用户/ 提供/ 基于/ 效用/ 的/ 信息/ 服务/ ./ 云/ 计算/ 数据中心/ 需要/ 管理/ 来自/ 不同/ 用户/ 的/ 各种各样/ 的/ 应用程序/ ,/ 如/ 科学计算/ 、/ 商业/ 领域/ 程序/ 等/ ./ 许多/ 云/ 计算/ 服务提供商/ ,/ 包括/ Amazon/ 、/ Google/ 、/ Microsoft/ 、/ Yahoo/ 和/ IBM/ 等/ ,/ 在/ 世界各地/ 部署/ 了/ 各自/ 的/ 数据中心/ 来/ 提供/ 云/ 计算/ 服务/ ./ 但是/ ,/ 管理/ 这些/ 云/ 程序/ 需要/ 消耗/ 大量/ 电能/ 并/ 带来/ 很/ 高/ 的/ 操作/ 开销/ ,/ 同时/ 也/ 会/ 对/ 环境/ 造成/ 负面影响/ ./ 能耗/ 的/ 持续/ 升高/ 会/ 增加/ 云/ 计算/ 基础设施/ 的/ 总/ 拥有/ 成本/ (/ TotalCostofOwnership/ ,/ TCO/ )/ ,/ 降低/ 投资/ 回报率/ (/ ReturnonInvestment/ ,/ ROI/ )/ ./ 因此/ ,/ 需要/ 一种/ 绿色/ 的/ 云/ 计算/ 解决方案/ [/ 16/ -/ 18/ ]/ ,/ 即/ 在/ 节约/ 能耗/ 的/ 同时/ 降低/ 管理/ 操作/ 的/ 开销/ ./ 绿色/ 云/ 计算/ 的/ 目标/ 是/ 在/ 高效/ 处理/ 和/ 使用/ 云/ 基础设施/ 的/ 同时/ 最小化/ 能量消耗/ ./ 但是/ 当前/ 的/ 云/ 计算/ 基础设施/ 很少/ 提供/ 支持/ 能量/ 感知/ 的/ 服务/ ,/ 无法/ 在/ 满足/ 服务质量/ 需求/ 的/ 同时/ 最小化/ 能耗/ 开销/ ,/ 以/ 获取/ 最大化/ 投资/ 回报/ ./ 虚拟化/ 技术/ 给/ 云/ 计算/ 数据中心/ 的/ 能耗/ 管理/ 带来/ 了/ 很多/ 解决/ 思路/ ./ 例如/ ,/ 在/ 数据中心/ 层次/ ,/ 虚拟化/ 技术/ 可以/ 通过/ 服务器/ 整合/ 把/ 多个/ 负载/ 整合/ 到/ 同一个/ 物理/ 机上/ ,/ 关闭/ 空闲/ 的/ 物理/ 机/ ,/ 达到/ 节能/ 目的/ ./ 但是/ 也/ 正/ 由于/ 虚拟化/ 层/ 的/ 存在/ ,/ 使得/ 传统/ 的/ 细粒度/ 能耗/ 管理/ 技术/ (/ 如/ 硬件/ 层/ 和/ 操作系统/ 层/ 的/ 能耗/ 管理/ 技术/ )/ 不能/ 直接/ 应用/ 到/ 虚拟化/ 环境/ 中/ ,/ 如/ 在/ 虚拟机/ (/ VirtualMachine/ ,/ VM/ )/ 里/ ,/ 资源/ 是/ 虚拟化/ 出来/ 的/ ,/ 它/ 无法/ 直接/ 获得/ 硬件/ 的/ 能耗/ 状态/ 数据/ ./ 这些/ 在/ 虚拟化/ 云/ 平台/ 的/ 能耗/ 管理/ 中/ 遇到/ 的/ 新/ 问题/ ,/ 目前/ 正/ 受到/ 越来越/ 广泛/ 的/ 关注/ ,/ 是/ 一个/ 热门/ 的/ 研究/ 方向/ [/ 19/ -/ 21/ ]/ ./ 通常/ 来讲/ ,/ 一个/ 高效/ 的/ 能耗/ 管理/ 解决方案/ 需要/ 考虑/ 3/ 方面/ 的/ 关键/ 元素/ :/ (/ 1/ )/ 丰富/ 的/ 能耗/ 监控/ 与/ 测量方法/ ,/ 及时/ 准确/ 地/ 提供/ 原始数据/ ;/ (/ 2/ )/ 精确/ 的/ 能耗/ 建模/ 与/ 分析/ ,/ 预测/ 能量/ 的/ 消耗/ 情况/ ,/ 指明/ 趋势/ 及/ 因果关系/ ;/ (/ 3/ )/ 节能/ 机制/ 及/ 优化/ 算法/ ,/ 用来/ 降低/ 能耗/ ,/ 同时/ 满足/ 性能/ 、/ 服务质量/ (/ QualityofService/ ,/ QoS/ )/ 或/ 服务/ 等级/ 协议/ (/ Service/ -/ LevelAgreement/ ,/ SLA/ )/ 等/ 的/ 要求/ ./ 本文/ 从/ 能耗/ 监控/ 与/ 测量/ 、/ 能耗/ 分析/ 与/ 建模/ 、/ 能耗/ 管理/ 实现/ 机制/ 、/ 能耗/ 管理/ 优化/ 算法/ 4/ 个/ 方面/ ,/ 对/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 研究/ 进行/ 系统分析/ ./ 论文/ 第/ 2/ 节/ 分析/ 虚拟化/ 云/ 计算/ 平台/ 面临/ 的/ 操作/ 管理/ 和/ 能耗/ 管理/ 的/ 挑战/ ,/ 指出/ 虚拟化/ 云/ 计算/ 平台/ 中/ 能耗/ 监控/ 与/ 测量/ 的/ 难点/ ,/ 介绍/ 能耗/ 监测/ 步骤/ 及/ 能耗/ 轮廓/ 分析方法/ ;/ 第/ 3/ 节/ 提出/ 虚拟机/ 系统/ 的/ 能耗/ 模型/ 及/ 服务器/ 整合/ 和/ 在线/ 迁移/ 两种/ 节能/ 关键技术/ 的/ 能耗/ 模型/ ;/ 第/ 4/ 节/ 从/ 虚拟化/ 层/ 和/ 云/ 平台/ 层/ 两个/ 层次/ 总结/ 目前/ 能耗/ 管理机制/ 方面/ 的/ 最新/ 研究进展/ ;/ 第/ 5/ 节对/ 常用/ 的/ 能耗/ 管理/ 算法/ 进行/ 分类/ 、/ 比较/ ;/ 最后/ 对/ 全文/ 进行/ 总结/ ,/ 提出/ 未来/ 十个/ 值得/ 进一步/ 研究/ 的/ 方向/ ./ 2/ 虚拟化/ 云/ 平台/ 的/ 能耗/ 监控/ 与/ 测量/ 2.1/ 虚拟化/ 云/ 平台/ 的/ 管理/ 挑战/ 2.1/ ./ 1/ 操作/ 管理/ 挑战/ 虚拟化/ 技术/ 通过/ 动态/ 资源/ 伸缩/ 的/ 方式/ 降低/ 了/ 云/ 计算/ 基础设施/ 的/ 总/ 拥有/ 成本/ ,/ 增加/ 了/ 负载/ 部署/ 的/ 灵活性/ ./ VMware/ 的/ 研究/ 人员/ 通过/ 对/ 来自/ 真实/ 虚拟化/ 部署/ 场景/ 的/ 数据/ 进行/ 分析/ ,/ 总结/ 出/ 虚拟化/ 场景/ 中/ 出现/ 的/ 常见/ 管理工作/ 流/ ,/ 并/ 评估/ 它们/ 对云/ 计算/ 数据中心/ 资源/ 使用/ 的/ 影响/ [/ 22/ ]/ ./ 虚拟化/ 技术/ 提供/ 了/ 很/ 好/ 的/ 管理/ 操作/ 灵活性/ ,/ 例如/ 当/ 虚拟化/ 数据中心/ 需要/ 维护/ 时/ ,/ 只/ 需/ 简单/ 地/ 把/ 虚拟机/ 迁移/ 到/ 另外/ 一台/ 服务器/ 上/ ,/ 而/ 不/ 需要/ 终止/ 应用程序/ 并/ 关闭/ 虚拟机/ ./ 但/ 虚拟机/ 迁移/ 也/ 会/ 带来/ 一定/ 的/ 开销/ ,/ 如给/ 数据中心/ 网络/ 增加/ 了/ 额外/ 的/ 通信/ 负载/ 和/ 带宽/ 需求/ ,/ 因此/ 需要/ 采用/ 高性能/ 的/ 网络设备/ 来/ 满足/ 负载/ 快速/ 迁移/ 的/ 需求/ ./ 此外/ ,/ 虚拟化/ 技术/ 的/ 引入/ 可能/ 改变/ 数据中心/ 的/ 某些/ 决策/ ,/ 例如/ 为了/ 获得/ 虚拟化/ 负载/ 的/ 最佳/ 性能/ ,/ 需要/ 选购/ 最新/ 的/ 具有/ 硬件/ 虚拟化/ (/ 如/ IntelVT/ 技术/ )/ 支持/ 的/ 处理器/ ,/ 遗留/ 的/ 处理器/ 将/ 不再/ 适用/ ./ 同时/ 由于/ 运行/ 着/ 数以百计/ 关键/ 任务/ 的/ 虚拟机/ 可能/ 同时/ 运行/ 在/ 同一/ 台/ 物理/ 主机/ 上/ ,/ 为了/ 获得/ 更/ 高/ 的/ 可靠性/ ,/ 需要/ 购买/ 更/ 可靠/ 更/ 昂贵/ 的/ 硬件/ ./ 这些/ 问题/ 导致/ 在/ 虚拟化/ 数据中心/ 设计/ 的/ 时候/ 需要/ 考虑/ 系统/ 性能/ 和/ 成本/ 的/ 权衡/ ./ 虚拟化/ 环境/ 具体/ 会/ 产生/ 什么样/ 的/ 管理/ 开销/ ?/ 为了/ 回答/ 这个/ 问题/ ,/ VMware/ 的/ 研究/ 人员/ 收集/ 了/ 运行/ VMware/ 虚拟化/ 软件/ 的/ 17/ 个/ 企业/ 数据中心/ 的/ 真实/ 管理/ 操作/ 的/ 详细/ 轮廓/ 数据/ [/ 22/ ]/ ,/ 如表/ 1/ 所示/ ./ 虚拟化/ 云/ 平台/ 特有/ 的/ 几种/ 管理/ 操作/ 定义/ 如下/ :/ (/ 1/ )/ 虚拟机/ 重/ 配置/ ./ 为/ 虚拟机/ 进行/ 硬件/ 的/ 重/ 配置/ (/ 如/ 增加/ 一块/ 网卡/ 或者/ 增加/ 一块/ 硬盘/ )/ ;/ (/ 2/ )/ 自动/ 在线/ 迁移/ ./ 为了/ 达到/ 自动/ 负载/ 均衡/ ,/ 虚拟机/ 需要/ 在/ 主机/ 间/ 动态/ 移动/ ,/ 这个/ 过程/ 中/ 虚拟机/ 始终/ 是/ 活着/ 的/ ;/ (/ 3/ )/ 虚拟机/ 开启/ ./ 开启/ 虚拟机/ ;/ (/ 4/ )/ 虚拟机/ 关闭/ ./ 关闭/ 虚拟机/ ;/ (/ 5/ )/ 虚拟/ Page4/ 机/ 重置/ ./ 对/ 虚拟机/ 进行/ 软/ 重置/ (/ 类似/ 于/ 打开/ 物理/ 主机/ 上/ 的/ 重置/ 开关/ )/ ;/ (/ 6/ )/ 补丁/ 安装/ ./ 包括/ 针对/ 物理/ 主机/ 的/ 补丁/ 安装/ (/ 如/ 更新/ Hypervisor/ )/ ,/ 或者/ 针对/ 虚拟机/ 的/ 程序安装/ (/ 如/ 更新/ 客户/ 操作系统/ ,/ 运行/ 最新/ 的/ 安全/ 修补/ 程序/ )/ ;/ (/ 7/ )/ 创建/ 快照/ ./ 对/ 虚拟机/ 的/ 状态/ 进行/ 检查点/ 操作/ ;/ (/ 8/ )/ 快照/ 恢复/ ./ 如果/ 发生/ 故障/ ,/ 可以/ 回滚/ 到/ 前/ 一个/ 已知/ 的/ 状态/ ;/ (/ 9/ )/ 快照/ 提交/ ./ 把/ 所有/ 的/ 变化/ 写/ 到/ 磁盘/ ,/ 真正/ 执行/ 快照/ 操作/ ,/ 并/ 移除/ 临时/ 快照/ 文件/ ;/ (/ 10/ )/ 虚拟机/ 克隆/ ./ 创建/ 一个/ 关闭/ 着/ 的/ 虚拟机/ 的/ 拷贝/ ,/ 这/ 对于/ 快速/ 复制/ 一个/ 新/ 的/ 配置/ 非常/ 有用/ ./ 例如/ 当/ 一个/ 新/ 员工/ 加入/ 到/ 一个/ 公司/ ,/ 通过/ 虚拟机/ 克隆/ ,/ 可以/ 把/ 标准/ 的/ 桌面/ 虚拟机/ 镜像/ 快速/ 部署/ 到/ 员工/ 的/ 虚拟/ 计算机/ 上/ ./ 当/ 进行/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 时/ ,/ 需要/ 考虑/ 这些/ 虚拟化/ 特有/ 的/ 管理/ 操作/ ./ 表/ 1/ 虚拟化/ 云/ 数据中心/ 常见/ 的/ 管理/ 操作/ [/ 22/ ]/ 操作/ 类型/ 不同/ 站点/ 每天/ 平均/ 虚拟机/ 重/ 配置/ 自动/ 在线/ 迁移/ 虚拟机/ 开启/ 虚拟机/ 关闭/ 虚拟机/ 重置/ 补丁/ 安装/ 创建/ 快照/ 快照/ 恢复/ 快照/ 提交/ 虚拟机/ 克隆/ 2.1/ ./ 2/ 能耗/ 管理/ 挑战/ 虚拟化/ 技术/ 给/ 数据中心/ 带来/ 新/ 的/ 日常/ 管理/ 操作/ 特征/ 的/ 同时/ ,/ 也/ 给/ 能耗/ 管理/ 操作/ 带来/ 新/ 的/ 挑战/ [/ 19/ ]/ ./ 首先/ ,/ 因为/ 虚拟化/ 平台/ 所/ 管理/ 的/ 虚拟/ 资源/ 和/ 物理/ 资源/ 是/ 相互/ 分离/ 的/ ,/ 因而/ 客户/ 机器/ 观察/ 到/ 的/ 虚拟/ 资源/ 与/ 底层/ 物理/ 资源/ 会/ 不/ 一致/ ,/ 特别/ 是/ 出现/ 迁移/ 的/ 时候/ ./ 所以/ ,/ 客户/ 虚拟机/ 如何/ 实现/ 虚拟机/ 程序/ 级/ 的/ 能耗/ 管理策略/ 是/ 一个/ 挑战性/ 问题/ ./ 其次/ ,/ 在/ 数据中心/ 中/ ,/ 不一致性/ 会/ 随着/ 平台/ 的/ 频繁/ 更新/ 、/ 故障/ 处理/ 、/ 添加/ 新/ 节点/ 扩容/ 等/ 操作/ 而/ 进一步/ 加重/ ./ 这些/ 平台/ 变化/ 的/ 一个/ 自然/ 结果/ 是/ 导致/ 异构/ 性/ 的/ 增加/ ./ 但是/ ,/ 出于/ 对/ 虚拟机/ 隔离/ 性/ 以及/ 独立性/ 的/ 需求/ 考虑/ ,/ 虚拟机/ 能耗/ 管理策略/ 要/ 做到/ 能够/ 以不变应/ 对/ 多变/ ./ 一般来讲/ ,/ 有/ 两种/ 解决/ 方法/ :/ (/ 1/ )/ 利用/ 客户/ 虚拟机/ 的/ 能耗/ 管理策略/ 实现/ 虚拟机/ 的/ 能耗/ 管理/ 操作/ ./ 但/ 这种/ 方法/ 存在/ 一些/ 问题/ ,/ 例如/ 不能/ 让/ 虚拟机/ 直接/ 使用/ 硬件/ 能耗/ 管理/ 功能/ ,/ 因为/ 这些/ 资源/ 是/ 虚拟化/ 后/ 的/ 硬件资源/ ,/ 并/ 为/ 多个/ 虚拟机/ 所/ 共享/ ./ 此外/ ,/ 直接/ 访问/ 硬件资源/ 也/ 会/ 影响/ 性能/ 隔离/ 性/ ./ 例如/ 虚拟机/ 增加/ 自己/ 所在/ 物理/ 核/ 的/ 频率/ 来/ 满足/ 自己/ 虚拟机/ 服务质量/ 需求/ 的/ 时候/ 会/ 影响/ 其它/ 的/ 物理/ 核/ 的/ 运行/ ./ 更坏/ 的/ 情况/ 是/ ,/ 有些/ 活动/ 可能/ 是/ 恶意/ 的/ ,/ 如/ 功耗/ 病毒/ (/ PowerVirus/ )/ ,/ 会/ 危害/ 其它/ 虚拟机/ 的/ 正常/ 运行/ ./ (/ 2/ )/ 利用/ 硬件/ 能耗/ 管理机制/ 实现/ 虚拟机/ 的/ 能耗/ 管理/ 操作/ ./ 但/ 这种/ 方法/ 也/ 存在/ 局限性/ ./ 硬件/ 支持/ 的/ 能耗/ 管理机制/ 对于/ 虚拟化/ 系统/ 的/ 问题/ 是/ ,/ 这些/ 硬件/ 层次/ 的/ 能耗/ 管理策略/ 会/ 被/ 多个/ 客户/ 虚拟机/ 所/ 共享/ ./ 例如/ ,/ 内存/ DIMM/ (/ Dual/ -/ Inline/ -/ Memory/ -/ Modules/ )/ 通过/ 同一个/ 总线/ 进行/ 访问/ ,/ 并且/ 共享/ 相同/ 的/ 电压/ 水平/ ,/ 而/ 这些/ 内存/ 可能/ 被/ 分配/ 给/ 多个/ 客户/ 虚拟机/ ./ 这/ 意味着/ ,/ 这个/ 部件/ 不能/ 被/ 用来/ 进行/ 特定/ 虚拟机/ 的/ 能耗/ 管理/ 操作/ ,/ 除非/ 所有/ 的/ 客户机/ 都/ 想/ 通过/ 总线/ 调节/ 来/ 降低/ 内存/ 带宽/ ./ 但/ 若/ 真的/ 这样/ 做/ ,/ 又/ 相当于/ 没有/ 发挥/ DIMM/ 的/ 优势/ ,/ 可以/ 直接/ 关闭/ DIMM/ 了/ ./ 相同/ 的/ 局限性/ 也/ 反映/ 在/ 磁盘/ 上/ ,/ 磁盘/ 包括/ 多个/ 分区/ ,/ 每个/ 分区/ 可能/ 被/ 分配/ 给/ 多个/ 不同/ 的/ 客户机/ ./ 只有/ 当/ 所有/ 的/ 分区/ 都/ 能/ 被/ 设置/ 为/ 某个/ 功率/ 状态/ 时/ ,/ 才能/ 通过/ 把/ 磁盘/ 调整/ 到/ 那个/ 功率/ 状态/ ,/ 实现/ 磁盘分区/ 层次/ 的/ 能耗/ 管理/ ./ 一个/ 解决/ 方法/ 是/ 采用/ 时间/ 域/ 多路复用/ ,/ 就是/ 根据/ 当前/ 虚拟机/ 的/ 功耗/ 标准/ 设置/ 硬件/ 状态/ ./ 但是/ 这样/ 也/ 存在/ 两个/ 问题/ :/ ①/ 首先/ ,/ 只有/ 在/ 资源管理/ 状态/ 转换/ 时间/ 比/ Hypervisor/ 的/ 调度/ 时间/ 粒度/ 更/ 小/ 的/ 时候/ 才能/ 采用/ 这种/ 方法/ ./ ②/ 这种/ 方法/ 对多核/ 平台/ 不/ 一定/ 有用/ ./ 大量/ 的/ 客户/ 虚拟机/ 在/ 可用/ 的/ 物理/ 核上/ 并发/ 执行/ ,/ 降低/ 了/ 时间/ 域/ 多路复用/ 的/ 可用/ 概率/ ./ 因为/ 在/ 多/ 核上/ ,/ 尽管/ 核/ 的/ 频率/ 可以/ 独立/ 调节/ ,/ 但是/ 主板/ 传过来/ 的/ 只有/ 一个/ 电压/ ./ 因此/ 工作电压/ 受/ 最高/ 频率/ 核/ 的/ 约束/ ./ 综上所述/ ,/ 需要/ 研究/ 一套/ 同时/ 结合/ “/ 软/ ”/ 、/ “/ 硬/ ”/ 能耗/ 调节/ 技术/ 的/ 方法/ 来/ 进行/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ ./ 2.2/ 虚拟机/ 能耗/ 测量/ 挑战/ 2.2/ ./ 1/ 虚拟机/ 能耗/ 无法/ 直接/ 测量/ 在/ 真实/ 的/ 云/ 计算/ 系统/ 中/ ,/ 能耗/ 管理/ 技术/ 的/ 一个/ 重要/ 方面/ 是/ 能耗/ 使用/ 情况/ 的/ 可视性/ ./ 基于/ 这些/ 可视/ 信息/ ,/ 可以/ 进行/ 自动/ 的/ 或者/ 人工/ 的/ 能耗/ 管理决策/ ,/ 这/ 就/ 涉及/ 一个/ 重要/ 问题/ ,/ 即/ 虚拟机/ 的/ 能耗/ 测量/ ./ 由于/ 现代/ 数据中心/ 对/ 能耗/ 管理/ 的/ 内在/ 需求/ ,/ 目前/ 绝大多数/ 的/ 新/ 服务器/ 都/ 在/ 硬件/ 层/ 提供/ 了/ 内置/ 的/ 能耗/ 测量/ 功能/ ,/ 而/ 旧/ 的/ 服务器/ 也/ 有/ 其它/ 一些/ 解决方案/ ,/ 如/ 使用/ 功耗/ 分布/ 单元/ (/ PowerDistributionUnits/ ,/ PDU/ )/ ,/ 通过/ 电源/ 测试/ 系统/ 的/ 能耗/ ./ 但是/ 在/ 虚拟化/ 环境/ 中/ ,/ 虚拟机/ 的/ 能耗/ 无法/ 直接/ 从/ 硬件/ 测量/ ./ Page5Kansal/ 等/ 人/ [/ 23/ ]/ 提出/ 了/ 一个/ 间接/ 的/ 虚拟机/ 能耗/ 测量/ 机制/ Joulemeter/ ,/ 使得/ 虚拟化/ 平台/ 也/ 能/ 像/ 目前/ 硬件/ 上/ 提供/ 给/ 服务器/ 的/ 功耗/ 测量/ 功能/ 一样/ 使用/ 能耗/ 管理机制/ ./ 首先/ 跟踪/ 虚拟机/ 使用/ 的/ 每个/ 硬件/ 部件/ 的/ 资源/ 使用/ 情况/ ,/ 然后/ 通过/ 一个/ 资源/ 能耗/ 模型/ ,/ 把/ 资源/ 使用率/ 转换/ 为/ 能耗/ 使用率/ ./ 有/ 了/ 资源/ 能耗/ 模型/ ,/ 就/ 可以/ 根据/ 模型/ 从/ 运行/ 时/ 资源/ 使用/ 情况/ 推断出/ 虚拟机/ 的/ 能量消耗/ ./ 传统/ 的/ 能耗/ 模型/ 对于/ 运行/ 单个/ 应用程序/ 的/ 物理/ 服务器/ 是/ 有效/ 的/ ,/ 但/ 不/ 适合/ 于云/ 计算/ 平台/ ./ 在/ 云/ 计算/ 平台/ 中/ 一个/ 服务器/ 可能/ 被/ 多个/ 不同/ 的/ 虚拟机/ 共享/ ,/ 每个/ 虚拟机/ 运行/ 不同/ 的/ 应用程序/ ./ Joulemeter/ 通过/ 服务器/ 硬件/ 和/ 对/ Hypervisor/ 插桩/ (/ Instrumen/ -/ tation/ )/ 来/ 建立/ 所/ 需/ 的/ 基于/ 真实/ 平台/ 的/ 能耗/ 模型/ ./ 这种/ 方法/ 的/ 误差率/ 较/ 低/ (/ 实验/ 表明/ 误差/ 保持/ 在/ 0.4/ W/ ~/ 2.4/ W/ 之间/ )/ ,/ 并且/ 运行/ 时/ 的/ 开销/ 也/ 较/ 小/ ./ Joulemeter/ 机制/ 的/ 优点/ 是/ 不/ 需要/ 对/ 应用程序/ 负载/ 或/ 虚拟机/ 里/ 的/ 操作系统/ 进行/ 额外/ 的/ 插/ 桩/ ,/ 能/ 自动/ 适应/ 应用程序/ 的/ 特征/ 甚至/ 硬件/ 配置/ 的/ 变化/ ./ 而/ Stoess/ 等/ 人/ [/ 21/ ]/ 提出/ 的/ 虚拟机/ 能耗/ 测量/ 机制/ ,/ 有/ 一个/ 前提/ 假设/ :/ 即/ 每个/ 硬件/ 部件/ 的/ 详细/ 能耗/ 模型/ 是/ 已知/ 的/ ,/ 但/ 实际上/ 这种/ 模型/ 很难/ 提供/ ./ McIntosh/ -/ Smith/ 等/ 人/ [/ 24/ ]/ 则/ 针对/ 异构/ 系统/ 提出/ 了/ 一种/ 性能/ 和/ 能耗/ 的/ 基准/ 测试方法/ ./ 2.2/ ./ 2/ 能耗/ 模型/ 精度/ 的/ 挑战/ 在/ 虚拟化/ 云/ 计算/ 数据中心/ 中/ ,/ 通常/ 是/ 通过/ 评估/ 当前/ 虚拟机/ 的/ CPU/ 利用率/ 来/ 确定/ 虚拟机/ 的/ 能耗/ 情况/ ./ 但是/ 不幸/ 的/ 是/ ,/ 这些/ 评估/ 可能/ 并/ 不/ 精确/ [/ 25/ ]/ ./ 因为/ 测量/ 出来/ 的/ CPU/ 利用率/ ,/ 无法/ 精确/ 反映/ 真实/ 的/ CPU/ 使用/ 情况/ ,/ 它/ 还/ 包括/ 了/ 内存/ 等待时间/ ,/ 因此/ 不能/ 真实/ 反映/ CPU/ 功耗/ 情况/ ./ 例如/ ,/ 有/ 两个/ 虚拟机/ ,/ 一个/ 是/ CPU/ 密集/ ,/ 一个/ 是/ 内存/ 密集/ ,/ 尽管/ 两个/ 虚拟机/ 的/ CPU/ 利用率/ 测量/ 值/ 相同/ ,/ 如/ 都/ 是/ 100/ %/ ,/ 但是/ 这/ 两个/ 虚拟机/ 的/ 能耗/ 来源/ 是/ 不同/ 的/ ./ 这/ 证明/ 了/ 简单/ 的/ 虚拟机/ 能耗/ 模型/ 存在/ 局限性/ ./ 为了/ 提高/ 虚拟机/ 能耗/ 模型/ 的/ 精度/ ,/ Krishnan/ 等/ 人/ [/ 25/ ]/ 研究/ 了/ 复杂/ 的/ 内存/ 层次/ 对/ 能耗/ 模型/ 精度/ 的/ 影响/ ,/ 因为/ 内存/ 正在/ 逐渐/ 变为/ 一个/ 重要/ 的/ 部件/ ./ 能耗/ 评估/ 的/ 精度/ 依赖于/ 虚拟机/ 对/ 内存/ 系统/ 的/ 使用/ 情况/ ,/ 如/ 不同/ Cache/ 层次/ 的/ 使用/ 情况/ 或者/ 内存/ 级/ 的/ 并行执行/ 情况/ ./ 在/ 云/ 计算/ 数据中心/ 中/ 精确/ 捕获/ 每个/ 虚拟机/ 的/ 能耗/ 不是/ 一件/ 容易/ 的/ 事/ ./ 这/ 是因为/ 今天/ 云/ 计算/ 数据中心/ 部署/ 着/ 各种类型/ 的/ 负载/ ,/ 它们/ 有着/ 不同/ 的/ 资源/ 使用/ 需求/ ,/ 并且/ 经常/ 动态变化/ ./ 此外/ ,/ 负责管理/ 数据中心/ 或云/ 基础设施/ 的/ 操作者/ 无法/ 知道/ 应用程序/ 所在/ 的/ 虚拟机/ 里/ 的/ 信息/ 以及/ 应用程序/ 本身/ 的/ 执行/ 行为/ ./ 没有/ 人/ 知道/ 虚拟机/ 上/ 的/ 应用程序/ 正在/ 做/ 什么/ ./ 因此/ ,/ 需要/ 采用/ 一种/ 黑盒/ 技术/ 来/ 捕捉/ 虚拟机/ 的/ 能耗/ 情况/ ,/ 即/ 轮廓/ 分析/ 的/ 方法/ ./ 2.3/ 虚拟机/ 能耗/ 测量/ 的/ 步骤/ 虚拟机/ 能耗/ 测量/ 的/ 基本思路/ 如下/ :/ (/ 1/ )/ 首先/ 建立/ 一个/ 能耗/ 模型/ ./ 把/ 特定/ 类型/ 资源/ 的/ 利用率/ (/ 如/ CPU/ )/ 和/ 整体/ 系统/ 能耗/ 建立联系/ ,/ 为/ 简单/ 起见/ 不/ 考虑/ 处在/ 相对/ 较/ 低/ 利用率/ 层次/ 的/ 其它/ 类型/ 资源/ 的/ 能耗/ ;/ (/ 2/ )/ 使用/ 轻量级/ 监控/ 工具/ 测量/ 每个/ 虚拟机/ 运行/ 时/ 的/ 不同/ 资源/ 的/ 利用率/ ,/ 例如/ 可以/ 通过/ 典型/ 虚拟化/ 平台/ (/ 如/ Xen/ )/ 提供/ 的/ 硬件/ 性能/ 计数器/ 进行/ 在线/ 的/ 轮廓/ 分析/ ;/ (/ 3/ )/ 评估/ 虚拟机/ 能耗/ 情况/ ./ 输入/ 资源/ 利用率/ ,/ 通过/ 资源/ 能耗/ 模型/ 的/ 计算/ ,/ 间接/ 推断/ 虚拟机/ 的/ 能耗/ ./ 式/ (/ 1/ )/ 表示/ :/ 基于/ 以上/ 思路/ ,/ 系统/ 的/ 总/ 能耗/ 可以/ 简单/ 地用/ 每个/ 系统/ 子/ 部件/ 的/ 能耗/ 计算方法/ 如下/ :/ CPU/ 子系统/ 的/ 精确/ 能耗/ 包括/ 处理器/ 能耗/ 和/ Cache/ 能耗/ ./ 可以/ 通过/ 监控/ 每秒钟/ 的/ 指令/ 执行/ 次数/ 来/ 表示/ 虚拟机/ CPU/ 的/ 使用率/ ./ 基于/ 此/ 就/ 可以/ 建立/ 每秒钟/ 指令/ 数/ 和/ 动态/ 服务器/ 能耗/ 的/ 相互/ 关系/ ./ 内存/ 子系统/ 的/ 能耗/ 模型/ 也/ 类似/ ,/ 可以/ 通过/ 每秒/ Cache/ 的/ 缺失/ 率/ 创建/ 内存/ 能耗/ 模型/ ,/ 建立/ 每秒钟/ 的/ Cache/ 缺失/ 数/ 和/ 服务器/ 能耗/ 的/ 关联/ 模型/ ./ 2.4/ 虚拟机/ 能耗/ 轮廓/ 分析方法/ 目前/ ,/ 大多数/ 在线/ 能耗/ 监控/ 都/ 是/ 基于/ 物理/ 节点/ 的/ ,/ 如/ Liu/ 等/ 人/ [/ 26/ ]/ 提出/ 的/ GreenCloud/ 架构/ ,/ 通过/ 使用/ 一个/ 外部/ 的/ 功耗/ 测量器/ 来/ 获得/ 物理/ 主机/ 的/ 总体/ 能耗/ ./ 它/ 只/ 提供/ 整个/ 系统/ 的/ 能量消耗/ ,/ 而/ 没有/ 提供/ 每个/ 虚拟机/ 的/ 能耗/ ,/ 是/ 一种/ 粗粒度/ 的/ 能耗/ 测量方法/ ,/ 能耗/ 精度/ 低/ ./ 为了/ 提升/ 能耗/ 测量/ 精度/ ,/ 需要/ 开发/ 细粒度/ 的/ 资源/ 和/ 能耗/ 轮廓/ 分析方法/ ,/ 不仅/ 分析/ 物理/ 节点/ 的/ 能耗/ ,/ 还要/ 分析/ 每个/ 虚拟机/ 的/ 能耗/ ./ Bohra/ 等/ 人/ [/ 27/ ]/ 提出/ 了/ 一个/ 新/ 的/ 能耗/ 轮廓/ 分析/ 工具/ VMeter/ ,/ 它/ 对/ 每个/ 虚拟机/ 的/ 资源/ 和/ 能耗/ 进行/ 轮廓/ 分析/ ./ 该/ 工具/ 对/ CPU/ 、/ Cache/ 、/ Disk/ 和/ DRAM/ 等/ 系统/ 子/ 部件/ 进行/ 分别/ 监控/ ./ Srikantaiah/ 等/ 人/ [/ 28/ ]/ 采用/ 类似/ 的/ 方法/ ,/ 通过/ 监控/ 底层/ 性能/ 计数器/ 预测/ 上层/ 应用程序/ 或/ 进程/ 的/ 能耗/ ./ 为了/ 在/ 软件设计/ 时/ 就/ 考虑/ 能耗/ 的/ 优化/ ,/ 需要/ 对/ 应用程序/ 层/ 的/ 能耗/ 轮廓/ 进行/ 分析/ ./ 为了/ 达到/ 这个/ 目标/ ,/ 来自/ 微软/ 的/ 研究/ 人员/ 提出/ 了/ 一个/ Page6/ 自动化/ 的/ 工具/ 进行/ 细粒度/ 的/ 应用程序/ 能耗/ 轮廓/ 分析/ ,/ 并/ 提供/ 有/ 价值/ 的/ 信息/ 给/ 程序/ 设计者/ [/ 29/ ]/ ./ Choi/ 等/ 人/ [/ 30/ -/ 31/ ]/ 通过/ 对/ 服务器/ 整合/ 场景/ 的/ 能耗/ 进行/ 轮廓/ 分析/ ,/ 开发/ 出/ 一个/ 模型/ 来/ 预测/ 整合/ 场景/ 下/ 应用程序/ 的/ 平均/ 和/ 持久/ 的/ 能耗/ ./ 3/ 虚拟化/ 云/ 平台/ 的/ 能耗/ 分析/ 与/ 建模/ 能耗/ 模型/ 可以/ 分成/ 两大类/ :/ 基于/ 系统/ 功能/ 单元/ 的/ 能耗/ 评估/ 模型/ 和/ 基于/ 硬件/ 性能/ 计数器/ 的/ 能耗/ 预测/ 模型/ ./ 出于/ 对模型/ 精度/ 的/ 考虑/ ,/ 大多数/ 的/ 能耗/ 模型/ 属于/ 第/ 2/ 类/ ,/ 即/ 对/ 通过/ 硬件/ 性能/ 计数器/ 收集/ 到/ 的/ 关键/ 系统/ 事件/ 进行/ 统计/ ,/ 预测/ 系统/ 能耗/ ,/ 然后/ 进行/ 各种/ 策略/ 的/ 能耗/ 优化/ ./ 图/ 1/ 给出/ 了/ 针对/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 建模/ 方法/ ,/ 我们/ 把/ 它/ 分为/ 静态/ 能耗/ 建模/ 和/ 动态/ 能耗/ 建模/ 两类/ ./ 静态/ 能耗/ 建模/ 刻画/ 的/ 是/ 单个/ 虚拟机/ 系统/ 功能/ 部件/ 的/ 能耗/ ,/ 可以/ 分别/ 对/ CPU/ 、/ 内存/ 、/ 磁盘/ 等/ 系统/ 子/ 部件/ 进行/ 建模/ ,/ 也/ 可以/ 对/ 虚拟机/ 系统/ 整体/ 进行/ 建模/ ./ 动态/ 能耗/ 建模/ ,/ 指/ 的/ 是/ 对/ 虚拟化/ 动态/ 应用/ 场景/ 的/ 能耗/ 进行/ 建模/ ,/ 包括/ 服务器/ 整合/ 能耗/ 建模/ 和/ 在线/ 迁移/ 能耗/ 建模/ ./ 图/ 1/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 建模/ 方法/ 分类/ 3.1/ 虚拟机/ 能耗/ 模型/ 3.1/ ./ 1/ 能耗/ 与/ 功耗/ 的/ 定义/ 及/ 相互/ 关系/ 能耗/ 和/ 功耗/ 是/ 用来/ 衡量/ 系统/ 能量消耗/ 的/ 两个/ 重要/ 概念/ ./ 在/ 计算机系统/ 中/ ,/ 能耗/ 是/ 指/ 计算机系统/ 一段时间/ 内/ 总/ 的/ 能量消耗/ ,/ 单位/ 是/ 焦耳/ (/ J/ )/ ./ 而/ 功耗/ 是/ 指/ 单位/ 时间/ 内/ 能量/ 的/ 消耗/ ,/ 反映/ 计算机系统/ 消耗/ 能量/ 的/ 速率/ ,/ 单位/ 是/ 瓦特/ (/ W/ )/ ./ 这/ 两者/ 都/ 能/ 表示/ 系统/ 的/ 能耗/ 情况/ ,/ 本文/ 不/ 作/ 特别/ 区别/ ./ 它们/ 之间/ 的/ 关系/ 如式/ (/ 2/ )/ 所示/ [/ 32/ ]/ 3.1/ ./ 2CPU/ 能耗/ 模型/ CPU/ 的/ 能耗/ 使用/ 模型/ 依赖于/ 多个/ 因素/ ,/ 如/ 处理器/ 子/ 单元/ 的/ 活动/ 情况/ ,/ 执行/ 特定/ 指令/ 的/ 情况/ ,/ 片上/ Cache/ 使用/ 情况/ 以及/ 处于/ 高/ 低频/ 的/ 情况/ ./ 一个/ 精确/ 的/ 能耗/ 模型/ ,/ 需要/ 考虑/ 所有/ 这些/ 因素/ ,/ 但是/ 这样/ 会/ 使得/ 监控/ 的/ 开销/ 很大/ ,/ 并且/ 不/ 适于/ 运行/ 时/ 的/ 虚拟机/ 的/ 实时/ 能耗/ 评估/ ./ 因此/ ,/ Kansal/ 等/ 人/ [/ 23/ ]/ 提出/ 了/ 一个/ 轻量级/ 的/ 替换/ 方法/ 来/ 跟踪/ 处理器/ 的/ 活动/ 和/ 休眠/ 次数/ ,/ 这/ 可以/ 很/ 容易/ 地/ 从/ 操作系统/ 里/ 的/ 处理器/ 使用/ 情况/ 获得/ ./ 令/ ucpu/ 表示/ 处理器/ 利用率/ ./ 对于/ 一个/ 给定/ 的/ 处理器/ 频率/ ,/ CPU/ 的/ 能耗/ 模型/ 如下/ [/ 23/ ]/ :/ 其中/ ,/ α/ cpu/ 和/ γ/ cpu/ 指/ 的/ 是/ 模型/ 的/ 特定/ 常数/ ,/ 可以/ 通过/ 训练/ 获得/ ./ 如果/ 一个/ 虚拟机/ A/ 的/ 处理器/ 利用率/ 表示/ 为/ ucpu/ ,/ A/ ,/ 那么/ 该/ 虚拟机/ 的/ 能耗/ Ecpu/ ,/ A/ 为/ 3.1/ ./ 3/ 内存/ 能耗/ 模型/ 现有/ 的/ 内存/ 能耗/ 模型/ 研究/ 发现/ 影响/ 内存/ 能耗/ 的/ 主要/ 因素/ 是/ 内存/ 读写/ 的/ 吞吐量/ ./ 尽管/ 有用/ 额外/ 的/ 插/ 桩/ 技术/ 来/ 捕获/ 内存/ 吞吐量/ [/ 33/ ]/ ,/ 也/ 有/ 一种/ 轻量级/ 的/ 内存/ 吞吐量/ 的/ 评估/ 方法/ ,/ 即/ 记录/ 最后/ 一层/ Cache/ (/ LastLevelCache/ ,/ LLC/ )/ 的/ 缺失/ 次数/ ,/ 这/ 在/ 大多数/ 处理器/ 上/ 很/ 容易/ 获得/ ./ 使用/ 这些/ 指标/ ,/ 内存/ 的/ 能耗/ 模型/ 可以/ 被/ 写/ 为/ 如下/ 形式/ [/ 23/ ]/ :/ 其中/ ,/ Emem/ (/ T/ )/ 表示/ T/ 时间/ 内/ 内存/ 的/ 总/ 能耗/ ,/ NLLC/ (/ T/ )/ 表示/ T/ 时间/ 内/ LLC/ 缺失/ 次数/ ,/ α/ mem/ 和/ γ/ mem/ 表示/ 线性/ 模型/ 的/ 参数/ ./ 与/ 跟踪/ 虚拟机/ 处理器/ 使用率/ 相比/ ,/ 跟踪/ 虚拟机/ 的/ LLC/ 缺失/ 没有/ 那么/ 直观/ ./ 因为/ 内存/ 访问/ 由/ 处理器/ 硬件/ 直接/ 管理/ ,/ 操作系统/ 和/ Hypervisor/ 不能/ 直接/ 看到/ ./ 大多数/ 的/ 处理器/ 把/ LLC/ 缺失/ 作为/ 硬件/ 的/ 一个/ 性能/ 计数器/ ,/ 如/ IntelNehalem/ 处理器/ 在/ 每个/ 核上/ 都/ 提供/ 这个/ 功能/ ./ 通过/ 跟踪/ 每个/ 虚拟机/ 在/ 每个/ 核上/ 因/ 上下文/ 切换/ 而/ 导致/ 的/ LLC/ 缺失/ 次数/ ,/ 我们/ 就/ 能/ 获得/ 相应/ 虚拟机/ 的/ LLC/ 的/ 缺失/ 次数/ ./ 因此/ 虚拟机/ 的/ 内存/ 能耗/ 模型/ 如下/ [/ 23/ ]/ :/ 其中/ ,/ ELLC/ ,/ A/ 表示/ 一个/ 虚拟机/ A/ 在/ 时间/ T/ 内在/ 所有/ 核上/ 的/ LLC/ 缺失/ 次数/ ,/ α/ mem/ 含义/ 与/ 式/ (/ 5/ )/ 中/ 一致/ ./ 3.1/ ./ 4/ 磁盘/ 能耗/ 模型/ 磁盘/ 子系统/ 的/ 能耗/ 模型/ 相对/ 较难/ 建立/ ,/ 这/ 是因为/ 无法/ 知道/ 磁盘/ 的/ 功耗/ 状态/ ,/ 以及/ 磁盘/ 硬件/ 缓存/ 的/ Page7/ 影响/ ./ 在/ 数据中心/ 服务器/ 中/ ,/ 磁盘/ 大多数/ 以/ RAID/ (/ RedundantArrayofIndependentDisks/ ,/ 磁盘阵列/ )/ 的/ 方式/ 存在/ ,/ 由/ RAID/ 控制器/ 控制/ 着/ 物理/ 磁盘/ ,/ Hypervisor/ 只能/ 看到/ 逻辑/ 驱动/ ./ 因此/ 只能/ 利用/ Hypervisor/ 能/ 看/ 得到/ 的/ 参数/ 来/ 进行/ 建模/ ./ 而/ Hyper/ -/ visor/ 只能/ 看到/ 读/ 和/ 写/ 的/ 字节数/ ,/ 以及/ 这些/ 读/ // 写/ 的/ 服务/ 时间/ ./ 因此/ 可以/ 使用/ 这些/ 参数/ 来/ 建立/ 磁盘/ 能耗/ 模型/ [/ 23/ ]/ :/ 其中/ ,/ Edisk/ (/ T/ )/ 表示/ T/ 时间/ 内/ 磁盘/ 的/ 能量消耗/ ,/ br/ 和/ bw/ 表示/ T/ 时间/ 内读/ 和/ 写/ 的/ 字节数/ ./ α/ 参数/ 和/ γ/ disk/ 可以/ 通过/ 训练/ 获得/ ./ 与/ CPU/ 和/ 内存/ 资源/ 一样/ ,/ 需要/ 跟踪/ 每个/ 虚拟机/ 的/ 磁盘/ 使用/ 参数/ ./ 值得注意/ 的/ 是/ ,/ 磁盘/ 活动/ 的/ 时候/ ,/ 虚拟机/ 不/ 一定/ 总是/ 活动/ 的/ ,/ 因为/ Hypervisor/ 可能/ 在/ 进行/ 批处理/ I/ // O/ 中断/ ,/ 或者/ 缓存/ I/ // O/ 等/ 操作/ ./ 因此/ ,/ 需要/ 在/ Hypervisor/ 中显式/ 的/ 跟踪/ I/ // O/ 操作/ ,/ 而/ 不是/ 观察/ 虚拟机/ 活动/ 时候/ 存储系统/ 的/ 活动/ 情况/ ./ WindowsHyper/ -/ VHypervisor/ 已经/ 实现/ 了/ 大部分/ 的/ 状态/ 跟踪/ 操作/ ,/ 每个/ 虚拟机/ 特定/ 的/ 磁盘/ 使用率/ 能/ 从/ Hyper/ -/ V/ 的/ 性能/ 计数器/ 里/ 获得/ ,/ 它们/ 是/ Hyper/ -/ VVirtualStorageDevice/ 和/ Hyper/ -/ VVirtualIDEController/ ./ 因此/ ,/ 可以/ 得到/ 以下/ 的/ 虚拟机/ 磁盘/ 能耗/ 模型/ [/ 23/ ]/ :/ 其中/ ,/ br/ ,/ A/ 和/ bw/ ,/ A/ 表示/ 虚拟机/ A/ 读/ 和/ 写/ 的/ 字节数/ ./ 此外/ ,/ 根据/ 实验/ 发现/ ,/ 可以/ 忽略/ 磁盘/ 读/ 和/ 写/ 的/ 能耗/ 差别/ ,/ 因此/ 得到/ 一个/ 共同/ 的/ 参数/ ,/ 由/ 前面/ 提到/ 的/ 虚拟机/ 磁盘/ 计数器/ 总和/ 表示/ ,/ 表示/ 读/ 和/ 写/ 的/ 总/ 字节数/ ,/ 因此/ 可以/ 把/ 模型简化/ 为/ 相应/ 的/ 虚拟机/ 的/ 磁盘/ 能耗/ 为/ 3.1/ ./ 5/ 系统/ 整体/ 能耗/ 模型/ 与/ 式/ (/ 1/ )/ 表示/ 的/ 系统/ 基本/ 能耗/ 模型/ 不同/ ,/ Bohra/ 等/ 人/ [/ 27/ ]/ 对/ 监控/ 事件/ 的/ 相互/ 关联/ 关系/ 进行/ 了/ 研究/ ,/ 他们/ 采用/ 主/ 成分/ 分析/ (/ PrincipalComponentAnalysis/ ,/ PCA/ )/ 方法/ 对/ 输入/ 数据/ 集/ 进行/ 分析/ ,/ 发现/ {/ CPU/ ,/ Cache/ }/ 对/ 和/ {/ Disk/ ,/ DRAM/ }/ 对/ 有/ 很/ 高/ 的/ 相关性/ ./ 因此/ ,/ 他们/ 把/ 系统/ 负载/ 分成/ 两大类/ :/ CPU/ 密集/ 的/ 负载/ 和/ I/ // O/ 密集/ 的/ 负载/ ./ 基于/ 此/ ,/ 可以/ 预测/ 系统/ 总/ 功耗/ ,/ 其/ 模型/ 表达/ 如下/ :/ 其中/ ,/ a1/ 和/ a4/ 是/ 用来/ 调节/ 系统/ 空闲/ 时/ 的/ 系统/ 能耗/ ,/ 参数/ a2/ 、/ a3/ 、/ a5/ 和/ a6/ 表示/ 权重/ ,/ Pcpu/ 、/ Pcache/ 、/ PDRAM/ 和/ Pdisk/ 分别/ 表示/ CPU/ 、/ Cache/ 、/ DRAM/ 和/ Disk/ 各子/ 部件/ 的/ 功耗/ ,/ 可/ 由/ 监控/ 到/ 的/ 系统/ 事件/ 计算/ 得到/ ./ P/ {/ cpu/ ,/ cache/ }/ 和/ P/ {/ DRAM/ ,/ disk/ }/ 分别/ 表示/ {/ CPU/ ,/ Cache/ }/ 和/ {/ DRAM/ ,/ Disk/ }/ 子系统/ 的/ 功耗/ ./ 使用/ 这个/ 模型/ ,/ 可以/ 计算/ 每个/ 活动/ 虚拟机/ 的/ 功耗/ ./ 整体/ 系统/ 功耗/ 可以/ 分为/ 两大类/ :/ 基数/ 功率/ 消耗/ 和/ 动态/ 功率/ 消耗/ ./ 根据/ 上/ 式/ ,/ a1/ 和/ a4/ 提供/ 系统/ 空闲/ 时/ 的/ 基数/ 功率/ 消耗/ ,/ 因此/ 基数/ 功耗/ 表示/ 如下/ :/ 其中/ ,/ P/ {/ baseline/ }/ 是/ 基数/ 功率/ 消耗/ ./ 系统/ 整体/ 功率/ 消耗/ 表示/ 如下/ :/ 其中/ ,/ P/ {/ total/ }/ 表示/ 总体/ 系统/ 功率/ 消耗/ ,/ P/ {/ domain/ (/ k/ )/ }/ 表示/ 一个/ 活动/ 虚拟机/ 域/ 的/ 功率/ 消耗/ ,/ N/ 是/ 活动/ 虚拟机/ 域/ 的/ 个数/ ./ 每个/ 虚拟机/ 域/ 可以/ 由/ 系统/ 提供/ 的/ 硬件/ 事件/ 的/ 计数器/ 值/ 获得/ 其中/ ,/ P/ {/ domain/ (/ i/ )/ }/ 是/ 指/ 一个/ 活动/ 虚拟机/ 或/ Dom0/ 的/ 功率/ 消耗/ ,/ pcpu/ (/ i/ )/ 、/ pcache/ (/ i/ )/ 、/ pDRAM/ (/ i/ )/ 可以/ 从/ 给定/ 域/ 的/ 硬件/ 事件/ 计数器/ 值/ 获得/ ,/ pdisk/ (/ i/ )/ 可以/ 从/ 给定/ 域/ 的/ 硬盘数据/ 传输/ 量/ 获得/ ./ 实验/ 证明/ ,/ 该/ 模型/ 能/ 很/ 好/ 地/ 满足/ 相应/ 的/ 测试/ 基准/ 程序/ 的/ 测试/ ,/ 计算/ 开销/ 也/ 不大/ ,/ 并且/ 提升/ 了/ 评价/ 预测/ 的/ 精度/ ./ 3.2/ 服务器/ 整合/ 建模/ 服务器/ 整合/ 指/ 的/ 是/ 把/ 多个/ 虚拟机/ 应用/ 负载/ 整合/ 在/ 一台/ 物理/ 主机/ 上/ 运行/ [/ 10/ ,/ 12/ ,/ 34/ ]/ ,/ 它/ 是/ 虚拟化/ 技术/ 的/ 一个/ 重要/ 应用/ 场景/ ./ 服务器/ 整合/ 可以/ 被/ 形式化/ 为/ 如下/ 形式/ [/ 35/ ]/ :/ 令/ 在/ T/ 时间段/ ,/ 有/ N/ 个/ 程序/ Ai/ 需要/ 被/ 部署/ 到/ M/ 个/ 物理/ 主机/ Hj/ 上/ ./ 对于/ 每个/ 程序/ Ai/ ,/ 令/ C/ (/ Ai/ ,/ t/ )/ 表示/ 在/ t/ 时刻/ 为了/ 满足/ SLA/ 所/ 需/ 的/ 资源/ ./ 这里/ 假设/ C/ (/ Ai/ ,/ t/ )/ 可以/ 从/ 资源/ 的/ 监控/ 数据/ 获得/ ,/ 而/ 不/ 去/ 考虑/ 怎样/ 把/ 程序/ 的/ SLA/ 转为/ 一个/ 资源/ 值/ ./ 令/ 物理/ 主机/ Hj/ 的/ 容量/ 为/ C/ (/ Hj/ )/ ,/ X/ 表示/ 一个/ 特定/ 的/ 整合/ 配置/ ,/ 把/ 程序/ 部署/ 到/ 物理/ 服务器/ 上/ ,/ 如果/ 程序/ Ai/ 被/ 部署/ 到/ 主机/ Hj/ ,/ 那么/ 令/ xij/ =/ 1/ ,/ 否则/ xij/ =/ 0/ ./ 服务器/ 整合/ 问题/ 就是/ 要/ 找/ 这样/ 一个/ 配置/ ,/ 优化/ 给定/ 的/ 开销/ 函数/ ./ 例如/ ,/ 如果/ 整合/ 的/ 目标/ 是/ 优化/ 能耗/ ,/ 那么/ 需要/ 寻找/ 一个/ 配置/ X/ ,/ 最小化/ P/ (/ X/ )/ ,/ P/ (/ X/ )/ 是/ 一个/ 真实/ 估价/ 的/ 函数/ ,/ 表示/ 一个/ 特定/ 程序/ 部署/ 的/ 能量消耗/ ./ 部署/ 应该/ 确保/ 所有/ 程序/ 的/ 资源/ 需求/ 满足/ 整个/ T/ 时间/ Page8/ 段/ ,/ 即/ / t/ ∈/ T/ ,/ ∑/ N/ 确保/ 所有/ 的/ 应用程序/ 被/ 成功/ 部署/ 上/ ,/ 即/ ∑/ M/ 动态/ 整合/ 假设/ T/ 非常/ 短/ ,/ 这/ 使得/ 应用程序/ 的/ 容量/ 请求/ C/ (/ Ai/ )/ 是/ 时间/ 无关/ 的/ ./ 因此/ ,/ 容量/ 约束/ 不再/ 是/ 随机/ 的/ ./ 在/ 动态/ 整合/ 场景/ 里/ ,/ 为了/ 评估/ C/ (/ Ai/ )/ 和/ C/ (/ Hj/ )/ ,/ 一个/ 主流/ 的/ 指标/ 是/ 来自/ IDEAS/ (/ IdeasIn/ -/ ternational/ )/ 组织/ 的/ RPE2/ (/ RelativeserverPerform/ -/ anceEstimate2/ )/ 指标/ ①/ ,/ 几乎/ 所有/ 的/ 常用/ 服务器/ 的/ 性能/ 都/ 用/ RPE2/ 值/ 测试/ 出来/ ./ C/ (/ Hj/ )/ 用/ RPE2/ 值来/ 表示/ ,/ 通过/ 分析/ 服务器/ CPU/ 的/ 利用率/ 对/ 应用程序/ 的/ 资源/ 请求/ 情况/ 进行/ 评估/ ./ 如果/ 没有/ 使用/ 虚拟化/ ,/ 服务器/ 的/ RPE2/ 值/ 和/ 该/ 时间段/ 内/ 服务器/ 的/ 最大/ CPU/ 利用率/ 的/ 乘积/ ,/ 被/ 用来/ 表示/ 应用程序/ 的/ 资源/ 需求/ 大小/ ./ 如果/ 使用/ 了/ 虚拟化/ ,/ 则/ 根据/ 其/ 物理/ 服务器/ 上/ 的/ 每个/ 虚拟机/ 的/ 权重/ 、/ 虚拟机/ 的/ CPU/ 利用率/ 和/ 物理/ 服务器/ 的/ RPE2/ 值/ 进行/ 综合/ 计算/ ./ 3.3/ 在线/ 迁移/ 建模/ 虚拟机/ 在线/ 迁移/ 指/ 的/ 是/ 一种/ 在/ 不/ 停机/ 的/ 情况/ 下/ 进行/ 虚拟机/ 迁移/ 的/ 技术/ [/ 11/ ,/ 36/ -/ 37/ ]/ ./ Liu/ 等/ 人/ [/ 38/ ]/ 对/ 虚拟机/ 迁移/ 的/ 能耗/ 进行/ 量化/ 建模/ ./ 虚拟机/ 迁移/ 的/ 能量消耗/ 主要/ 由/ 数据/ 传输率/ 决定/ ./ 源端/ 主机/ 在/ 进行/ 虚拟机/ 迁移/ 时/ 的/ 能量消耗/ 随/ 数据/ 传输率/ 的/ 上升/ 而/ 上升/ ./ 另一方面/ ,/ 当/ 数据/ 传输率/ 更/ 高/ 的/ 时候/ ,/ 迁移/ 延迟/ 变得/ 更/ 短/ ./ 实验/ 证明/ ,/ 因为/ 虚拟机/ 迁移/ 本身/ 而/ 产生/ 的/ 能量消耗/ 与/ 数据/ 传输率/ 无关/ ./ 注意/ 到/ ,/ 虚拟机/ 迁移/ 是/ 一个/ I/ // O/ 密集/ 的/ 程序/ ,/ 能耗/ 主要/ 消耗/ 在/ 网络/ 上/ 进行/ 数据传输/ 和/ 接收/ ./ 可以/ 推测/ 虚拟机/ 迁移/ 导致/ 的/ 能量/ 开销/ 只/ 由/ 网络流量/ 的/ 数据量/ 决定/ ./ 基于/ 此/ ,/ Liu/ 等/ 人/ 设计/ 了/ 一个/ 模型/ 来/ 评估/ 虚拟机/ 迁移/ 的/ 能量/ 开销/ ./ 实现/ 虚拟机/ 迁移/ 牵涉到/ 源/ 主机/ 、/ 网络/ 交换器/ 、/ 目标/ 主机/ 3/ 大/ 资源/ ./ 因为/ 交换/ 结构/ 非常复杂/ ,/ 能耗/ 很难/ 量化/ ,/ 因此/ 该/ 模型/ 只/ 考虑/ 源端/ 和/ 目标/ 端的/ 能量消耗/ ./ 一般来说/ ,/ 数据/ 在/ 源端/ 传输/ 的/ 量/ 与/ 数据/ 在/ 目标/ 端/ 接收/ 的/ 量/ 是/ 相等/ 的/ ,/ 另外/ 通过/ 实验/ 发现/ 在/ 同构/ 的/ 环境/ 中/ ,/ 数据传输/ 和/ 接收/ 的/ 能量消耗/ 差异/ 非常/ 小/ ./ 因此/ 以下/ 能耗/ 模型/ 假设/ 能量消耗/ 与/ 虚拟机/ 迁移/ 导致/ 的/ 网络/ 开销/ 成/ 线性/ 增长/ 关系/ :/ Emig/ =/ Esource/ +/ Edest/ =/ (/ α/ s/ +/ α/ d/ )/ Vmig/ +/ (/ β/ s/ +/ β/ d/ )/ (/ 17/ )/ 其中/ ,/ α/ s/ 、/ α/ d/ 、/ β/ s/ 、/ β/ d/ 表示/ 需要/ 训练/ 的/ 模型/ 参数/ ./ 在/ 异构/ 物理/ 机/ 环境/ 下/ ,/ 该/ 模型/ 仍然/ 适用/ ,/ 只是/ 这些/ 模型/ 参数/ 需要/ 重新/ 训练/ ./ 因为/ 当前/ 的/ 虚拟化/ 平台/ (/ 包括/ Xen/ 和/ VMware/ )/ 只/ 支持/ 虚拟机/ 在/ 同构/ 主机/ 间/ 的/ 迁移/ ,/ 为了/ 简化/ 问题/ ,/ 只/ 在/ 同构/ 环境/ 中/ 训练/ 能耗/ 模型/ ./ 因此/ ,/ 式/ (/ 17/ )/ 能/ 被/ 简化/ 为/ 网络流量/ Vmig/ 用兆/ 字节/ (/ Mb/ )/ 表示/ ,/ 能耗/ Emig/ 用/ Joules/ ②/ 表示/ ./ Vmig/ 可以/ 很/ 容易/ 从/ 真实/ 迁移/ 训练/ 实验/ 获得/ ./ 为了/ 计算/ 额外/ 的/ 能耗/ Emig/ ,/ 应该/ 获得/ 由/ 虚拟机/ 在线/ 迁移/ 导致/ 的/ 能耗/ 上升/ 部分/ ./ 首先/ 测量/ 物理/ 主机/ 的/ 静态/ 功耗/ P0/ ,/ 然后/ 测量/ 当/ 虚拟机/ 在/ 迁移/ 时/ 的/ 能耗/ Pt/ ,/ 那么/ 由/ 虚拟机/ 迁移/ 导致/ 的/ 动态/ 能耗/ 可以/ 由下式/ 计算/ 得到/ Emig/ =/ ∫/ Tmig4/ 虚拟化/ 云/ 平台/ 能耗/ 管理/ 实现/ 机制/ 节能/ 技术/ 可以/ 分为/ 静态/ 节能/ 技术/ 和/ 动态/ 节能/ 技术/ ./ 第/ 1/ 种/ 方法/ 在/ 最初/ 系统/ 和/ 部件/ 设计/ 的/ 时候/ 就/ 把/ 能耗/ 因素/ 考虑/ 进去/ ,/ 这种/ 方法/ 包括/ 电路/ 层/ 节能/ 技术/ (/ 如/ 对/ 未/ 使用/ 的/ 组件/ 禁用/ 时钟/ 信号/ )/ ,/ 节能/ 微/ 架构设计/ [/ 8/ ]/ ,/ 处理器/ 、/ 内存/ 和/ 磁盘/ 的/ 低功耗/ 状态/ 设计/ [/ 39/ ]/ 等/ ./ 第/ 2/ 种/ 方法/ 根据/ 负载/ 变化/ ,/ 从/ 资源管理/ 的/ 角度/ 自/ 适应/ 地/ 进行/ 节能/ 管理/ ,/ 这种/ 方法/ 需要/ 智能/ 的/ 管理软件/ 来/ 优化/ 服务器/ 层/ 和/ 集群/ 层/ 的/ 能量消耗/ ./ 把/ 软硬件/ 节能/ 技术/ 绑定/ 在/ 一起/ 是/ 一种/ 更为/ 有效/ 的/ 方法/ ,/ 也/ 是/ 虚拟化/ 云/ 计算/ 平台/ 可行/ 的/ 节能/ 实现/ 机制/ ./ 根据/ 之前/ 的/ 分析/ ,/ 虚拟化/ 云/ 平台/ 的/ 能耗/ 管理/ 面临/ 一些/ 新/ 的/ 挑战/ ,/ 因此/ 需要/ 针对/ 该/ 平台/ 开发新/ 的/ 能耗/ 管理机制/ ./ Nathuji/ 和/ Schwan/ [/ 19/ ]/ 考虑/ 了/ 面向/ 虚拟化/ 平台/ 的/ 能耗/ 管理/ 新机制/ 的/ 设计/ 问题/ :/ (/ 1/ )/ 软硬/ 结合/ 的/ 能耗/ 调整/ ./ 虚拟化/ 技术/ 可以/ 动态/ 扩展/ 物理/ 资源分配/ 给/ 虚拟机/ ,/ 有/ 两种/ 方式/ 可以/ 实现/ 能耗/ 调整/ :/ ①/ 软/ 的/ 技术/ ,/ 依靠/ Hypervisor/ 的/ 管理/ 来/ 限制/ 虚拟机/ 对/ 硬件资源/ 的/ 使用率/ ;/ ②/ 硬/ 的/ 技术/ ,/ 采用/ 底层/ 硬件/ 节能/ 技术/ ,/ 如/ 处理器/ 电压/ 频率/ 调整/ (/ DynamicVolt/ -/ ageandFrequencyScaling/ ,/ DVFS/ )/ 技术/ ./ 为了/ 实现/ 更/ 有效/ 的/ 虚拟化/ 层/ 能耗/ 管理/ ,/ 这/ 两/ 方面/ 的/ 技术/ 都/ 要/ 采用/ ./ (/ 2/ )/ 独立/ 和/ 协调/ ./ 客户/ 虚拟机/ 有/ 自己/ 的/ 能耗/ 管理/ 方法/ ,/ 如/ Linux/ 操作系统/ 允许/ 处理器/ 进行/ 动态/ 电压/ 频率/ 调整/ ,/ 这个/ 管理策略/ 既/ 可以/ 装载/ 到/ 内核/ ,/ 也/ 可以/ 在/ 用户/ 空间/ 执行/ ./ 此外/ ,/ 还/ 可以/ 采用/ 其它/ 特定/ 应用/ ①/ ②/ Page9/ 程序/ 的/ 节能/ 策略/ 解决/ 实时/ 负载/ 或者/ 满足/ 程序/ 最小化/ 能耗/ 的/ 需求/ ./ 从/ 这个/ 角度/ 来说/ ,/ 云/ 平台/ 能耗/ 管理/ 的/ 一个/ 必要/ 元素/ 是/ 需要/ 协调/ 各个/ 层次/ 的/ 节能/ 策略/ ,/ 如/ 硬件/ 层/ 、/ 操作系统/ 层/ 、/ 机架/ 层/ 、/ 数据中心/ 层/ 等/ ./ (/ 3/ )/ 管理/ 的/ 灵活性/ ./ 有/ 虚拟化/ 技术支持/ 的/ 现代/ 数据中心/ 拥有/ 多种/ 设备/ ,/ 这些/ 设备/ 有/ 不同/ 的/ 属性/ 和/ 管理/ 功能/ ,/ 或者/ 部署/ 了/ 不同/ 类型/ 的/ 应用程序/ ,/ 而且/ 这些/ 应用程序/ 有着/ 不同/ 的/ SLA/ 需求/ ./ 这种/ 场景/ 下/ 需要/ 不同/ 的/ 动态/ 能耗/ 管理策略/ ./ 因此/ 为了/ 有效/ 解决/ 虚拟化/ 环境/ 的/ 能耗/ 管理/ 问题/ ,/ 需要/ 给/ 管理员/ 提供/ 灵活/ 的/ 能耗/ 管理策略/ ./ 根据/ 管理/ 层次/ 的/ 不同/ ,/ 我们/ 把/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理机制/ 分为/ 两大类/ :/ 虚拟化/ 层/ 的/ 能耗/ 管理机制/ 和/ 云/ 平台/ 层/ 的/ 能耗/ 管理机制/ ./ 其中/ 在/ 虚拟化/ 层/ 的/ 能耗/ 管理机制/ 中/ ,/ 我们/ 分析/ 了/ 虚拟机/ 管理器/ (/ VirtualMachineMonitor/ ,/ VMM/ )/ 层/ 对/ 能耗/ 管理/ 的/ 支持/ ,/ 以及/ 虚拟机/ 层/ 对/ 能耗/ 管理/ 的/ 支持/ ./ 云/ 平台/ 层/ 的/ 能耗/ 管理机制/ 范围/ 很广/ ,/ 它/ 的/ 主要/ 思路/ 是从/ 虚拟/ 资源管理/ 的/ 角度/ 对云/ 平台/ 的/ 能耗/ 进行/ 管理/ ,/ 我们/ 又/ 把/ 它/ 具体/ 分为/ VPM/ (/ VirtualPowerManagement/ )/ 能耗/ 管理机制/ 和/ 能耗/ 管理/ 中间件/ 框架/ 两大类/ ,/ 如图/ 2/ 所示/ ./ 图/ 2/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理机制/ 分类/ 附录/ 表/ 1/ 列举/ 了/ 目前/ 各种/ 典型/ 的/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理机制/ ,/ 分别/ 从/ 实现/ 平台/ 、/ 考虑/ 的/ 资源/ 维度/ 、/ 同构/ // 异构/ 性/ 、/ 是否/ 用到/ 迁移/ 、/ 最终/ 优化/ 目标/ 、/ 采用/ 的/ 具体/ 节能/ 技术/ 和/ 实现/ 效果/ 7/ 大/ 方面/ ,/ 全面/ 总结/ 、/ 分析/ 和/ 比较/ 了/ 各种/ 能耗/ 管理机制/ 的/ 异同/ 点/ ./ 4.1/ 虚拟化/ 层/ 的/ 能耗/ 管理机制/ 4.1/ ./ 1VMM/ 层/ 的/ 能耗/ 管理机制/ 虚拟机/ 管理器/ (/ VMM/ )/ 可以/ 有/ 两种/ 方式/ 参与/ 能耗/ 管理/ [/ 55/ ]/ :/ (/ 1/ )/ 虚拟机/ 管理器/ 可以/ 看/ 作为/ 一个/ 能耗/ 感知/ 的/ 操作系统/ ,/ 对系统/ 整体/ 性能/ 进行/ 监控/ ,/ 并/ 利用/ DVFS/ 等/ 技术/ 降低/ 系统/ 部件/ 的/ 能耗/ ;/ (/ 2/ )/ 依靠/ 操作系统/ 特定/ 的/ 能耗/ 管理策略/ 和/ 应用程序/ 级/ 的/ 信息/ ,/ 把/ 不同/ 虚拟机/ 的/ 能耗/ 管理/ 操作/ 映射/ 到/ 硬件/ 功耗/ 状态/ 的/ 真实/ 改变/ 上/ ./ 虚拟机/ 管理器/ 一般/ 提供/ 类似/ 于/ Linux/ 本身/ 提供/ 的/ 按/ 需/ 能耗/ 管理机制/ ,/ 即/ 支持/ 基于/ 高级/ 配置/ 与/ 电源接口/ (/ AdvancedConfigurationandPowerManagementInterface/ ,/ ACPI/ )/ 的/ 能耗/ 管理机制/ ./ 系统/ 间隔性/ 的/ 监控/ CPU/ 利用率/ ,/ 检测/ 适合/ 的/ 功率/ 状态/ ,/ 生成/ 一个/ 平台/ 独立/ 的/ 命令/ ,/ 进而/ 调节/ 硬件/ 的/ 功率/ 状态/ ./ Xen/ 支持/ ACPI/ 的/ P/ 状态/ ,/ 并/ 在/ cpufreq/ 驱动/ 里/ 实现/ 这一/ 机制/ [/ 56/ ]/ ./ 与/ Linux/ 功耗/ 管理子系统/ 类似/ ,/ Xen/ 功耗/ 管理系统/ 包括/ 4/ 个/ 管理器/ :/ (/ 1/ )/ 按/ 需/ 管理器/ ./ 根据/ 当前/ 的/ 资源/ 需求/ 选择/ 最佳/ 的/ P/ 状态/ ;/ (/ 2/ )/ 用户/ 空间/ 管理器/ ./ 由/ 用户/ 指定/ 设置/ CPU/ 的/ 频率/ ;/ (/ 3/ )/ 性能/ 管理器/ ./ 设置/ 最高/ 的/ 可用/ 时钟/ 频率/ ;/ (/ 4/ )/ 节能/ 管理器/ ./ 设置/ 最低/ 的/ 时钟/ 频率/ ./ 除/ P/ 状态/ 外/ ,/ Xen/ 还/ 支持/ C/ 状态/ (/ CPU/ 睡眠/ 状态/ )/ [/ 56/ ]/ ./ 当/ 一个/ 物理/ CPU/ 没有/ 运行/ 任务/ 时/ ,/ 就/ 切换/ 到/ C/ 状态/ ./ 当新/ 的/ 请求/ 到来/ 时/ ,/ CPU/ 切换/ 回/ 活动状态/ ./ 一个/ 问题/ 是/ 进入/ 到/ 哪/ 一种/ C/ 状态/ :/ 深度/ C/ 状态/ 提供/ 更/ 高/ 的/ 节能/ 效果/ ,/ 但是/ 也/ 意味着/ 更/ 高/ 的/ 切换/ 开销/ ./ 目前/ ,/ Xen/ 缺省/ 地/ 把/ CPU/ 切换/ 到/ 第一个/ C/ 状态/ ./ 当/ CPU/ 收到/ 唤醒/ 信号/ 时/ ,/ 会/ 不可避免/ 地/ 带来/ 一定/ 的/ 性能/ 损失/ ./ 与/ Xen/ 相似/ ,/ VMware/ 也/ 支持/ 主机/ 层/ 的/ 能耗/ 管理机制/ ,/ 支持/ DVFS/ 技术/ ./ 系统/ 连续/ 监控/ CPU/ 使用率/ ,/ 并/ 恰当/ 地/ 使用/ ACPI/ 中/ 的/ P/ 状态/ ./ KVM/ 是/ 另外/ 一种/ 虚拟化/ 平台/ ,/ 它/ 是/ 作为/ Linux/ 内核/ 的/ 一个/ 模块/ ./ 在/ 这个/ 模块/ 下/ ,/ Linux/ 担任/ Hypervisor/ 的/ 角色/ ,/ 所有/ 的/ 虚拟机/ 按/ 正常/ 的/ 进程/ 由/ Linux/ 调度/ 器/ 进行/ 调度/ ./ 这种/ 方法/ 减少/ 了/ Hypervisor/ 实现/ 的/ 复杂度/ ,/ 因为/ 调度/ 和/ 内存/ 管理/ 都/ 是/ 由/ Linux/ 内核/ 完成/ ./ KVM/ 支持/ S4/ (/ 休眠/ )/ 和/ S3/ (/ 待机/ )/ 两种/ 功耗/ 状态/ ①/ ./ S4/ 不/ 需要/ KVM/ 任何/ 特殊/ 的/ 支持/ ,/ 在/ 休眠状态/ ,/ 客户/ 操作系统/ 把/ 内存/ 状态/ 保存/ 进/ 硬盘/ ,/ 并且/ 关闭/ 计算机/ ./ 在/ 下次/ 启动/ 的/ 时候/ ,/ 操作系统/ 从/ 磁盘/ 读取/ 保存/ 着/ 的/ 内存/ 状态/ ,/ 从/ 休眠/ 中/ 恢复/ ,/ 初始化/ 所有/ 设备/ ./ 在/ S3/ 状态/ ,/ 内存/ 是/ 开/ 着/ 的/ ,/ 数据/ 不/ 需要/ 保存/ 到/ 磁盘/ ./ 但是/ ,/ 客户/ 操作系统/ 必须/ 保存/ 设备/ 的/ 状态/ ,/ 因为/ 他们/ 需要/ 恢复/ 设备/ 状态/ ./ 在/ 下/ 一次/ 启动/ 时/ ,/ BIOS/ (/ BasicInputOutputSystem/ )/ 应该/ 识别/ S3/ 状态/ ,/ 而/ 不是/ 初始化/ 设备/ ,/ 直接/ 恢复/ S3/ 保存/ 着/ 的/ 设备/ 状态/ ./ 因此/ BIOS/ 需要/ 做/ 一些/ 修改/ 来/ 支持/ 这种/ 行为/ ./ 在/ 虚拟机/ 管理器/ 层/ ,/ 除了/ 对/ ACPI/ 的/ 支持/ 之外/ ,/ 另/ 一个/ 重要/ 的/ 特征/ 是/ 对/ 虚拟机/ 在线/ 迁移/ 的/ 支持/ ./ 通/ ①/ http/ :/ // // www/ ./ linux/ -/ kvm/ ./ org/ // page/ // PowerManagementPage10/ 过/ 这种/ 虚拟机/ 的/ 迁移/ 可以/ 进行/ 能耗/ 感知/ 的/ 动态/ 虚拟机/ 整合/ ,/ 进而/ 达到/ 节能/ 的/ 目的/ ./ 迁移/ 被/ 用来/ 在/ 物理/ 主机/ 间/ 转移/ 虚拟机/ ./ 离线/ 迁移/ 采用/ 暂停/ (/ Suspend/ )/ 的/ 方式/ 把/ 一个/ 虚拟机/ 从/ 一台/ 主机/ 移动/ 到/ 另外/ 一台/ 主机/ ,/ 拷贝/ 内存/ 内容/ ,/ 然后/ 在/ 目标/ 主机/ 恢复/ 运行/ 虚拟机/ ./ 而/ 在线/ 迁移/ 转移/ 虚拟机/ 时/ ,/ 不/ 需要/ 暂停/ 虚拟机/ ./ Xen/ 既/ 支持/ 离线/ 迁移/ 也/ 支持/ 在线/ 虚拟机/ 迁移/ ./ VMware/ 的/ VMotion/ 模块/ 使得/ 虚拟机/ 能/ 通过/ 自动/ 的/ 或者/ 管理员/ 手动/ 的/ 方式/ 在/ 物理/ 节点/ 间/ 在线/ 迁移/ 虚拟机/ ./ VMware/ 的/ DRS/ (/ DistributedResourceScheduler/ )/ 模块/ 包含/ 一个/ 专门/ 的/ 功耗/ 管理子系统/ 叫/ VMwareDPM/ (/ DistributedPowerManagement/ )/ ①/ ,/ 用来/ 动态/ 关闭/ 空闲/ 服务器/ ,/ 从而/ 减少/ 能量/ 的/ 消耗/ ./ 当/ 资源/ 请求/ 量/ 上升/ 的/ 时候/ ,/ 服务器/ 又/ 被/ 重新启动/ 起来/ ./ VMwareDPM/ 使用/ 在线/ 迁移/ 来/ 重新分配/ 虚拟机/ ,/ 保持/ 最小/ 的/ 活动/ 服务器/ 数目/ ./ KVM/ 也/ 支持/ 在线/ 迁移/ ./ 表/ 2/ 对/ 目前/ 流行/ 的/ 3/ 大/ 虚拟机/ 管理器/ (/ Xen/ 、/ VMware/ 和/ KVM/ )/ 的/ 能耗/ 管理机制/ 进行/ 了/ 比较/ 分析/ ./ 表/ 2/ 典型/ 虚拟机/ 管理器/ 的/ 能耗/ 管理机制/ 比较/ VMM/ 类型/ VMM/ 能耗/ 管理机制/ 基于/ 迁移/ 的/ 能耗/ 管理机制/ Xen/ 支持/ P/ 状态/ 、/ C/ 状态/ 基于/ 在线/ 迁移/ 的/ 整合/ VMware/ 支持/ P/ 状态/ 基于/ VMotion/ 迁移/ 的/ 整合/ 、/ KVM/ 支持/ S4/ 、/ S3/ 状态/ 基于/ 在线/ 迁移/ 的/ 整合/ 4.1/ ./ 2VM/ 层/ 的/ 能耗/ 管理机制/ 在/ 虚拟机/ 里/ 进行/ 能耗/ 管理/ 面临/ 很多/ 挑战/ ,/ Nathuji/ 等/ 人/ [/ 19/ ]/ 提出/ 的/ 虚拟/ 能耗/ 管理机制/ Virtual/ -/ 图/ 3VirtualPowever/ 能耗/ 管理机制/ 架构/ [/ 19/ ]/ 4.2/ 云/ 平台/ 层/ 的/ 能耗/ 管理机制/ 4.2/ ./ 1VPMtokens/ 管理机制/ 前面/ 提到/ 的/ VPM/ 机制/ 实现/ 了/ 在/ 虚拟机/ 里/ 进行/ 能耗/ 管理/ 操作/ 的/ 基本功能/ ,/ 这是/ 进一步/ 实现/ 复杂/ 在线/ 能耗/ 管理/ 的/ 基础/ ./ 这种/ 机制/ 为/ 底层/ 平台/ 能耗/ 管理/ Power/ 填补/ 了/ 在/ 虚拟机/ 内部/ 进行/ 能耗/ 管理/ 的/ 空白/ ,/ 它/ 结合/ 采用/ 硬件/ 能耗/ 调整/ 和/ 基于/ 软件/ 的/ 能耗/ 调整/ 方法/ 来/ 控制/ 虚拟化/ 平台/ 的/ 能耗/ ./ VirtualPower/ 定义/ 了/ 一整套/ 完整/ 的/ 虚拟/ 能耗/ 管理/ (/ VirtualPowerMan/ -/ agement/ ,/ VPM/ )/ 元素/ :/ VPM/ 状态/ 、/ VPM/ 通道/ 、/ VPM/ 规则/ 、/ VPM/ 机制/ ./ 通过/ 虚拟机/ 层/ 的/ “/ 软/ 的/ VPM/ 状态/ ”/ 管理策略/ ,/ 客户/ 机会/ 拥有/ 一致/ 的/ 硬件/ 管理/ 能力/ 视野/ ,/ 而/ 不用/ 考虑/ 底层/ 的/ 物理/ 资源/ ./ 然后/ 通过/ VPM/ 规则/ 把/ 这些/ 更改/ 映射/ 到/ 底层/ 硬件/ 的/ 改变/ ./ VirtualPow/ -/ er/ 把/ 能耗/ 管理策略/ 解释/ 成/ 一种/ 提示/ (/ hints/ )/ 而/ 不是/ 执行命令/ ./ 这些/ 提示/ 被/ ACPI/ 接口/ 捕获/ ./ 当/ 客户/ 虚拟机/ 想要/ 通过/ 这个/ 接口/ 进行/ 特权/ 操作/ 时/ ,/ 目前/ 的/ Hy/ -/ pervisor/ 的/ 做法/ 是/ 会/ 忽视/ 它们/ ,/ 但是/ VirtualPower/ 会/ 解释/ 提示/ 并/ 把/ 它们/ 映射/ 到/ VPM/ 通道/ ./ 这些/ 通道/ 提供/ 有用/ 的/ 提示/ 给/ VirtualPower/ 的/ VPM/ 规则/ ./ 然后/ ,/ VPM/ 规则/ 使用/ 由/ 这些/ 提示/ 组成/ 的/ “/ 软/ ”/ 的/ 状态/ 请求/ 作为/ 局部/ 能耗/ 管理/ 和/ 全局/ 能耗/ 管理/ 的/ 输入/ ./ VPM/ 状态/ 和/ 通道/ 的/ 绑定/ 提供/ 了/ 一致/ 的/ 能耗/ 管理/ ,/ 同时/ 维护/ 了/ 虚拟机/ 的/ 隔离/ 性/ 和/ 独立性/ ./ VirtualPower/ 不/ 需要/ 修改/ 客户/ 操作系统/ ./ 它/ 的/ 架构/ 流程/ 如图/ 3/ 所示/ :/ 每个/ 物理/ 平台/ 运行/ 一个/ Hypervisor/ 及/ 配套/ 的/ Dom0/ ./ 客户/ 虚拟机/ 基于/ “/ 软/ ”/ 的/ VPM/ 状态/ 进行/ 能耗/ 管理/ ./ VPM/ 通道/ 捕获/ 客户/ 虚拟机/ 的/ 能耗/ 管理/ 请求/ ,/ 通过/ 在/ Hypervisor/ 更新/ 这些/ “/ 软/ ”/ 的/ 状态/ ./ 这些/ 信息/ 随后/ 被/ 传递/ 到/ 能耗/ 管理软件/ 部件/ ,/ 这些/ 部件/ 由/ 运行/ 在/ Dom0/ 的/ VPM/ 规则/ 集合/ 组成/ ./ 最后/ 采用/ VPM/ 机制/ 来/ 真实/ 执行/ 能耗/ 管理决策/ ./ 方法/ 的/ 多样性/ 提供/ 了/ 一个/ 统一/ 的/ 管理/ 方式/ ./ VPM/ 支持/ 3/ 种/ 复杂/ 能耗/ 管理机制/ :/ 硬/ 伸缩/ 、/ 软/ 伸缩/ 和/ 整合/ [/ 19/ ]/ ./ ①/ http/ :/ // // www/ ./ vmware/ ./ com/ // pdf/ // vsphere4/ // r40/ // vsp/ _/ 40/ _/ re/ -/ Page11/ (/ 1/ )/ 硬/ 伸缩/ (/ HardwareScaling/ )/ ./ 不同/ 的/ 平台/ 和/ 设备/ 架构/ 有/ 不同/ 的/ 硬件/ 伸缩/ 能力/ ./ 这些/ 伸缩/ 功能/ 依赖于/ 虚拟机/ 层/ 的/ 资源共享/ 情况/ (/ 如/ 虚拟机/ 运行/ 在/ 多个/ 核上/ )/ ./ VPM/ 机制/ 支持/ 硬/ 伸缩/ ,/ 允许/ VPM/ 规则/ 在/ 客户/ 操作系统/ 运行/ 的/ 时候/ 进行/ 硬件/ 状态/ 的/ 设置/ ,/ 通过/ VirtualPower/ 超级/ 调用/ 接口/ 设置/ VPM/ _/ SET/ _/ PSTATE/ ./ 当然/ ,/ 规则/ 也/ 会/ 判断/ 这些/ 状态/ 改变/ 是否/ 容易/ 实现/ ./ 例如/ ,/ 策略/ 规则/ 必须/ 判断/ 是否/ 会/ 因为/ 资源共享/ 的/ 关系/ 导致/ 虚拟机/ 的/ 硬件/ 性能/ 状态/ 产生/ 冲突/ ./ 在/ 处理器/ 动态/ 电压/ 频率/ 调整/ 的/ 时候/ ,/ 这些/ 冲突/ 通过/ 硬件/ 解决/ ,/ 确保/ 给/ 芯片/ 提供/ 足够/ 的/ 电压/ 来/ 运行/ 最高/ 频率/ ./ (/ 2/ )/ 软/ 伸缩/ (/ SoftScaling/ )/ ./ 硬/ 伸缩/ 不/ 总是/ 有效/ ,/ 有时/ 只/ 提供/ 很小/ 的/ 收益/ ./ 因此/ ,/ 提出/ 了/ “/ 软/ ”/ 资源/ 伸缩/ 的/ 概念/ ,/ 通过/ 资源/ 调度/ 的/ 方式/ 来/ 模拟/ 硬/ 伸缩/ 动作/ 带来/ 的/ 性能/ 损耗/ ./ 对于/ 处理器/ 的/ 管理/ ,/ 可以/ 通过/ 修改/ Hypervisor/ 的/ 虚拟机/ 调度/ 属性/ 来/ 模拟/ 虚拟机/ 希望/ 获得/ 的/ 性能/ 模式/ ./ 例如/ ,/ 如果/ 一个/ 虚拟机/ 根据/ 之前/ 的/ 性能/ 状态/ 请求/ 把/ 一个/ 核/ 缩小/ 到/ 半个/ 核/ ,/ 这个/ 时候/ 执行/ 软/ 伸缩/ ,/ Hypervisor/ 调度/ 器/ 可以/ 把/ 客户机/ 的/ 最大/ 时间/ 片/ 降低/ 到/ 原来/ 的/ 一半/ ./ 调度/ 参数/ 的/ 调整/ 是/ 通过/ 在/ VirtualPower/ 超级/ 调度/ 接口/ 上/ 进行/ VPM/ _/ SET/ _/ SOFT/ 设置/ 来/ 实现/ ./ 软/ 伸缩/ 能/ 带来/ 很/ 好/ 的/ 节能/ 效果/ ./ 当/ 处理器/ 处于/ 空闲/ 状态/ 时/ ,/ 软/ 伸缩/ 很/ 有效/ ./ 同时/ ,/ 通过/ 在/ 多个/ 资源/ 上/ 正确/ 地/ 管理/ 软/ 伸缩/ ,/ 如/ 协调/ 并发/ 或者/ 使用/ 整合/ ,/ 也/ 能/ 获得/ 额外/ 的/ 节能/ 效果/ ./ (/ 3/ )/ 整合/ (/ Consolidation/ )/ ./ 在/ 多个/ 资源/ 上/ (/ 如多核/ 芯片/ 上/ 的/ 核/ )/ 进行/ 多个/ 虚拟机/ 的/ 软/ 伸缩/ ,/ 会/ 导致/ 共享资源/ 的/ 处理器/ 核/ 负载/ 不/ 平衡/ ,/ 可能/ 有些/ 核/ 空闲/ ,/ 有些/ 核/ 满载/ ./ 资源整合/ 的/ 第一个/ 优点/ 是/ 大幅/ 节能/ ,/ 通过/ 把/ 没有/ 负载/ 运行/ 的/ 资源/ 切换/ 到/ 空闲/ 或/ 暂停状态/ ./ 第二个/ 优点/ 是/ 可以/ 考虑/ 资源/ 异构/ 性/ ./ 特别/ 的/ 在/ 数据中心/ 环境/ ,/ 可能/ 存在/ 针对/ 特定/ 负载/ 更高/ 能效/ 的/ 服务器/ ./ 通过/ 绑定/ 软/ 伸缩/ 与/ 虚拟机/ 重/ 映射/ 或者/ 迁移/ ,/ 可以/ 把/ 多个/ 兼容/ 的/ 虚拟机/ 实例/ 映射/ 到/ 适合/ 的/ 高/ 能效/ 物理/ 资源/ 上/ ./ Nathuji/ 等/ 人/ [/ 20/ ]/ 进一步/ 提出/ 了/ 一套/ 集群/ 层/ 和/ 数据中心/ 层/ 的/ 管理/ 部件/ ,/ 他们/ 提出/ 的/ 虚拟机/ 感知/ 的/ 能耗/ 预算/ 把/ 多个/ 分布式/ 管理器/ 整合/ 到/ VirtualPower/ 管理/ 框架/ 中/ [/ 19/ ]/ ,/ 目标/ 是/ 在/ 一定/ 的/ 能耗/ 预算/ 下/ 最大化/ 性能/ 或/ 效用/ ./ 通过/ 实现/ 4/ 个/ 系统/ 功能/ 来/ 达到/ 这一/ 目标/ :/ (/ 1/ )/ 以/ 虚拟机/ 为/ 中心/ 的/ 预算/ (/ VM/ -/ CentricBudg/ -/ eting/ )/ ./ 提出/ 了/ 一个/ 按/ 比例/ 分配/ 的/ 模型/ ,/ 按/ 虚拟机/ 的/ 相对/ 效用/ (/ 重要性/ )/ 来/ 分配/ 能耗/ 预算/ ./ (/ 2/ )/ 应用/ 感知/ 的/ 管理/ (/ application/ -/ awaremanagement/ )/ ./ 在/ 维持/ 能耗/ 预算/ 的/ 同时/ ,/ 提供/ 足够/ 的/ 性能/ ./ (/ 3/ )/ 预算/ 补偿/ 应用/ (/ compensatingbudgetedapplications/ )/ ./ 当/ 一个/ 虚拟机/ 处于/ 低功耗/ 的/ 时候/ ,/ 可以/ 把/ 功耗/ 省/ 给/ 别的/ 虚拟机/ 用/ ,/ 当/ 虚拟机/ 需要/ 而/ 别的/ 又/ 处于/ 低功耗/ 的/ 时候/ ,/ 可以/ 获得/ 补偿/ ./ (/ 4/ )/ 预算/ 异构/ 资源/ (/ budgetingheteroge/ -/ neousresources/ )/ ./ 在/ 异构/ 平台/ 中/ ,/ 当/ 同时/ 降低/ 相同/ 能耗/ 数时/ ,/ 如/ 10W/ ,/ 各/ 平台/ 的/ 性能/ 下降/ 幅度/ 是/ 不/ 一样/ 的/ ./ 基于/ 此/ ,/ 可以/ 选择/ 最合适/ 的/ 平台/ 进行/ 降低功耗/ 操作/ ./ 4.2/ ./ 2/ 能耗/ 管理/ 中间件/ 框架/ 针对/ 模块化/ 和/ 多层/ 操作系统/ 结构/ ,/ Stoess/ 等/ 人/ [/ 21/ ]/ 提出/ 了/ 一种/ 创新/ 的/ 能耗/ 管理/ 框架/ ./ 这种/ 框架/ 提供/ 了/ 一个/ 统一/ 的/ 模型/ 进行/ 能量/ 分割/ 和/ 部署/ 以及/ 进行/ 能量/ 感知/ 的/ 资源/ 记账/ 和/ 分配/ ./ 他们/ 基于/ Hypervisor/ 的/ 虚拟机/ 系统/ 实现/ 了/ 一个/ 系统/ 原型/ ,/ 该/ 原型/ 由/ 两/ 部分/ 组成/ :/ (/ 1/ )/ 主机/ 层/ 子系统/ ./ 控制/ 整个/ 机器/ 的/ 能量/ 约束/ ,/ 并/ 最大化/ 所有/ 的/ 客户/ 操作系统/ 和/ 服务/ 部件/ 的/ 能效/ ./ (/ 2/ )/ 能量/ 感知/ 的/ 操作系统/ ./ 针对/ 特定/ 程序/ 进行/ 细粒度/ 的/ 能量/ 管理/ ./ 实验/ 证明/ ,/ 对于/ 能耗/ 感知/ 的/ 操作系统/ 和/ 普通/ 的/ 操作系统/ ,/ 这个/ 框架/ 都/ 能/ 精确/ 控制/ 和/ 保证/ 每个/ 硬件/ 设备/ 的/ 能耗/ ./ Jung/ 等/ 人/ [/ 40/ ]/ 提出/ 了/ 一个/ 整体/ 控制/ 框架/ Mistral/ ,/ 优化/ 能耗/ ,/ 提高/ 性能/ 收益/ ,/ 减少/ 由于/ 各种/ 操作/ 和/ 控制器/ 本身/ 带来/ 的/ 短暂/ 的/ 开销/ ,/ 来/ 最大化/ 整体/ 效用/ ./ Mistral/ 通过/ 多个/ 可/ 扩展/ 的/ 优化/ 算法/ ,/ 解决/ 了/ 不同/ 分布式应用/ 程序/ 和/ 大规模/ 基础设施/ 的/ 能耗/ 管理/ 问题/ ./ 最近/ Oh/ 等/ 人/ [/ 57/ ]/ 研究/ 了/ 虚拟机/ 共存/ 和/ CPU/ 热量/ 管理/ 的/ 影响/ ,/ 探索/ 性能/ 干扰/ ,/ 并且/ 基于/ 实验/ 结果/ ,/ 设计/ 了/ 一个/ 负载/ 感知/ 的/ 虚拟机/ 在线/ 调度/ 器/ 进行/ 云/ 计算环境/ 的/ 分布式/ 能耗/ 管理/ ./ 其它/ 还有/ 一些/ 虚拟机/ 管理/ 框架/ ,/ 解决/ 了/ 虚拟机/ 在/ 多/ 物理/ 机上/ 的/ 部署/ 问题/ ,/ 最小化/ 物理/ 机/ 个数/ ,/ 达到/ 适应/ 当前/ 负载/ 的/ 目的/ [/ 10/ ,/ 58/ ]/ ./ 云/ 计算/ 数据中心/ 的/ 一个/ 关键/ 目标/ 是/ 最大化/ 收益/ 、/ 最小化/ 能量消耗/ 和/ 主机/ 程序/ 的/ SLA/ 冲突/ ./ Van/ 等/ 人/ [/ 59/ ]/ 提出/ 了/ 一个/ 资源管理/ 框架/ ,/ 由/ 一个/ 基于/ 效用/ 的/ 动态/ 虚拟机/ 供给/ 管理器/ 和/ 一个/ 动态/ 虚拟机/ 部署/ 管理器/ 组成/ ./ 这/ 两个/ 问题/ 都/ 被/ 建模/ 成/ 约束/ 满足/ 问题/ (/ constraintsatisfactionproblem/ )/ ./ 虚拟机/ 供给/ 的/ 目标/ 是/ 最大化/ 全局/ 效用/ ,/ 同时/ 满足/ SLA/ 、/ 最小化/ 云/ 计算/ 基础设施/ 能量/ 相关/ 的/ 操作/ 开销/ ./ 另外/ ,/ Liu/ 等/ 人/ [/ 26/ ]/ 提出/ 了/ GreenCloud/ 架构/ ,/ 目标/ 是/ 降低/ 数据中心/ 的/ 能耗/ ,/ 同时/ 保证/ 性能/ ./ GreenCloud/ 架构/ 允许/ 在线/ 监控/ 、/ 在线/ 虚拟机/ 迁移/ 、/ 虚拟机/ 优化/ 部署/ 等/ 操作/ ./ Page124/ ./ 3/ 性能/ 与/ 能耗/ 的/ 权衡/ 分析/ 虚拟化/ 云/ 计算/ 平台/ 中/ 一种/ 常用/ 的/ 节能/ 方法/ 是/ 通过/ 虚拟机/ 在线/ 迁移/ 技术/ 进行/ 能耗/ 感知/ 的/ 服务器/ 整合/ ,/ 从而/ 腾出/ 空闲/ 的/ 服务器/ ,/ 关闭/ 或/ 转为/ 低功耗/ 状态/ 运行/ ./ 但/ 服务器/ 整合/ 同时/ 会/ 影响/ 程序/ 性能/ 或/ 服务质量/ [/ 60/ -/ 62/ ]/ ,/ 尤其/ 在/ 分布式/ 的/ 在线/ 服务/ 中要/ 小心/ 使用/ ,/ 如/ 在线/ 购物/ 、/ 企业/ 程序/ 等/ ,/ 因此/ 需要/ 权衡/ 性能/ 与/ 能耗/ 之间/ 的/ 关系/ ./ 因为/ 负载/ 是/ 动态变化/ 的/ ,/ 需要/ 进行/ 运行/ 时/ 的/ 整合/ 活动/ ,/ 而且/ 迁移/ 不是/ 免费/ 的/ ,/ 要/ 依赖于/ 负载/ 类型/ ./ 因此/ ,/ 除了/ 考虑/ 服务器/ 整合/ 内在/ 的/ 能耗/ 和/ 性能/ 权衡/ ,/ 基础设施/ 提供者/ 还要/ 考虑/ 进行/ 资源/ 重/ 配置/ 的/ 收益/ 和/ 开销/ 的/ 权衡/ [/ 63/ ]/ ./ 考虑/ 到/ 这种/ 重/ 配置/ 引起/ 的/ 开销/ ,/ 需要/ 重新/ 思考/ 最佳/ 的/ 节能/ 策略/ ./ 例如/ ,/ 当/ 负载/ 变化/ 很快/ 时/ ,/ 损失/ 掉/ 一些/ 性能比/ 触发/ 一个/ 昂贵/ 的/ 迁移/ 更好/ ,/ 否则/ 迁移/ 的/ 成本/ 可能/ 还/ 没有/ 被/ 收回/ ,/ 下/ 一个/ 迁移/ 又/ 开始/ 了/ ./ 或者/ 采用/ 简单/ 且/ 适中/ 的/ 变化/ ,/ 如对/ 虚拟机/ 重新分配/ 资源/ ,/ 比/ 启动/ 新/ 的/ 主机/ 更加/ 有效/ ./ 最后/ ,/ 能耗/ 开销/ 和/ 决策/ 延迟/ 导致/ 的/ 开销/ 也/ 需要/ 考虑/ ./ Chase/ 等/ 人/ [/ 64/ ]/ 使用/ 一个/ 经济模型/ 来/ 进行/ 集群/ 中/ 功耗/ 感知/ 的/ 资源分配/ ./ Kephart/ 等/ 人/ [/ 65/ ]/ 也/ 实现/ 了/ 一个/ 控制器/ 架构/ ,/ 用户/ 可以/ 指定/ 功耗/ 和/ 性能/ 目标/ ./ Park/ 等/ 人/ [/ 66/ ]/ 提出/ 了/ 一个/ 针对/ 在/ 多/ 核/ 处理器/ 上/ 运行/ 多线程/ 程序/ 的/ 有/ 性能/ 保障/ 的/ 能耗/ 管理/ 方法/ ,/ 节约/ 能耗/ 的/ 同时/ 减少/ 了/ 性能/ 的/ 损耗/ ./ Nathuji/ 等/ 人/ [/ 20/ ]/ 提出/ 了/ 一个/ 框架/ 来/ 维持/ 虚拟机/ 的/ 功耗/ 和/ 性能/ 权衡/ ,/ 并且/ 在/ 功耗/ 预算/ 下/ 有效/ 地/ 管理/ 物理/ 机/ ,/ 获得/ 好/ 的/ 性能/ ./ Ye/ 等/ 人/ [/ 45/ ]/ 针对/ 虚拟化/ 云/ 计算/ 数据中心/ 环境/ ,/ 从/ 实验/ 评估/ 的/ 角度/ 探索/ 了/ 通过/ 虚拟机/ 迁移/ 和/ 服务器/ 整合/ 获得/ 的/ 能耗/ 减少/ 与/ 迁移/ 和/ 整合/ 本身/ 的/ 性能/ 开销/ 的/ 权衡/ 关系/ ./ Gandhi/ 等/ 人/ [/ 67/ ]/ 从/ 理论/ 分析/ 的/ 角度/ 出发/ ,/ 采用/ 能量/ 和/ 响应/ 时间/ 乘积/ (/ ERP/ )/ 这个/ 广泛/ 使用/ 的/ 指标/ 来/ 计算/ 能量/ 与/ 性能/ 的/ 权衡/ 结果/ ,/ 并且/ 给出/ 了/ 服务器/ 群/ (/ ServerFarm/ )/ 能耗/ 管理策略/ 的/ 最优/ 理论/ 结果/ ./ 对于/ 一个/ 固定/ 的/ 资源/ 需求/ 模式/ ,/ 他们/ 证明/ 存在/ 一个/ 非常/ 小/ 的/ 自然/ 策略/ 集合/ ,/ 对于/ 单个/ 服务器/ ,/ 总是/ 包含/ 最优/ 策略/ ,/ 并且/ 推测/ 对于/ 多/ 服务器/ 系统/ ,/ 包含/ 近似/ 最优/ 的/ 策略/ ./ 对于/ 随/ 时间/ 变化/ 的/ 请求/ 模式/ ,/ 他们/ 给出/ 了/ 一个/ 简单/ 的/ 流量/ 无关/ 的/ 策略/ ,/ 为/ 近似/ 最优/ 策略/ 提供/ 分析/ 和/ 实证/ 证据/ ./ Beloglazov/ 等/ 人/ 针对/ 云/ 计算/ 应用程序/ 的/ 多样性/ 和/ 动态/ 可变性/ ,/ 提出/ 虚拟机/ 部署/ 应该/ 以/ 在线/ 的/ 方式/ 连续/ 优化/ ,/ 为了/ 了解/ 问题/ 的/ 在线/ 性质/ 的/ 影响/ ,/ 进行/ 竞争/ 分析/ ,/ 针对/ 单/ 虚拟机/ 迁移/ 和/ 动态/ 虚拟机/ 整合/ 问题/ ,/ 证明/ 最佳/ 的/ 在线/ 确定性/ 算法/ 的/ 竞争/ 比/ ./ 此外/ ,/ 他们/ 还/ 基于/ 虚拟机/ 资源/ 使用/ 的/ 历史数据/ 的/ 分析/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 的/ 启发式/ 算法/ 进行/ 虚拟机/ 的/ 动态/ 整合/ ,/ 该/ 算法/ 能/ 大幅/ 减少/ 能量/ 的/ 消耗/ ,/ 同时/ 满足/ SLA/ [/ 68/ ]/ ./ 5/ 虚拟化/ 云/ 平台/ 能耗/ 管理/ 算法/ 5.1/ 能耗/ 管理/ 算法/ 的/ 分类/ 从/ 随机/ 算法/ 到/ 基于/ 学习/ 的/ 算法/ ,/ 能耗/ 管理/ 算法/ 的/ 范围/ 很广/ [/ 69/ ]/ ./ 附录/ 表/ 2/ 从/ 不同/ 角度/ 对/ 能耗/ 管理/ 进行/ 总结/ 、/ 分类/ 和/ 比较/ ,/ 并/ 给出/ 了/ 典型/ 案例/ ./ 5.1/ ./ 1/ 按主/ 被动模式/ 分/ 按照/ 主/ 被动模式/ 分/ ,/ 能耗/ 管理/ 算法/ 可以/ 分为/ 主动/ 节能/ 方法/ 和/ 被动/ 节能/ 方法/ ./ 主动/ 节能/ 算法/ 指/ 的/ 是/ 通过/ 对/ 历史数据/ 学习/ 等/ 方法/ ,/ 对/ 未来/ 的/ 能耗/ 情况/ 进行/ 预测/ ,/ 并/ 预先/ 根据/ 预测/ 信息/ 进行/ 功耗/ 感知/ 的/ 资源管理/ ./ 被动/ 节能/ 算法/ 指/ 的/ 是/ 通过/ 实时/ 监控/ 等/ 手段/ ,/ 根据/ 当前/ 的/ 资源/ 使用/ 情况/ ,/ 进行/ 相应/ 的/ 资源/ 调整/ ,/ 达到/ 节能/ 的/ 目的/ ./ 采用/ 控制/ 理论/ 进行/ 能耗/ 管理/ 由来已久/ ./ Lefurgy/ 等/ 人/ [/ 84/ ]/ 证明/ 了/ 一个/ 控制/ 理论/ 解决方案/ 与/ 一个/ 常用/ 的/ 启发式/ 解决方案/ 相比/ ,/ 拥有/ 更/ 精确/ 的/ 功耗/ 控制/ 和/ 更好/ 的/ 性能/ ./ Wu/ 等/ 人/ [/ 85/ ]/ 通过/ 控制/ 多/ 时钟/ 域/ 处理器/ 上/ 的/ 同步/ 队列/ 来/ 管理/ 功耗/ ./ 采用/ 控制/ 理论/ 进行/ 虚拟/ 资源管理/ 的/ 研究/ 工作/ 还有/ 文献/ [/ 86/ -/ 88/ ]/ ,/ 但/ 他们/ 只/ 考虑/ 了/ 性能/ 的/ 控制/ ,/ 没有/ 考虑/ 功耗/ 的/ 控制/ ./ Bradley/ 等/ 人/ [/ 70/ ]/ 使用/ 短期/ 和/ 长期/ 负载/ 预测/ 提出/ 了/ 两个/ 主动/ 功耗/ 管理/ 算法/ ./ 这/ 两个/ 算法/ 根据/ 临时/ 负载/ 模式/ ,/ 积极主动/ 地/ 提供/ 足够/ 可用/ 的/ 资源/ ,/ 达到/ 节能/ 的/ 目的/ ./ Chen/ 等/ 人/ [/ 71/ ]/ 研究/ 了/ 负载/ 到达/ 流量/ 模式/ ,/ 并/ 使用/ 它们/ 来/ 预测/ 所/ 需/ 的/ 资源/ 总量/ ,/ 据此/ 进行/ 负载/ 的/ 能耗/ 管理/ ./ Choi/ 等/ 人/ [/ 31/ ]/ 开发/ 了/ 一个/ 模型/ 来/ 预测/ 整合/ 场景/ 下/ 应用程序/ 的/ 平均/ 功耗/ 和/ 持久/ 功耗/ ,/ 并/ 在/ Xen/ 平台/ 上/ 进行/ 了/ 实验/ 评估/ ,/ 实验/ 表明/ 该/ 方法/ 预测/ 平均/ 功耗/ 的/ 误差/ 在/ 5/ %/ 以内/ ,/ 持久/ 功耗/ 的/ 误差/ 在/ 10/ %/ 以内/ ./ 被动/ 节能/ 算法/ 包括/ :/ Liu/ 等/ 人/ [/ 26/ ]/ 提出/ 的/ 基于/ 监控/ 的/ 节能/ 架构/ GreenCloud/ 、/ Bohra/ 等/ 人/ [/ 27/ ]/ 提出/ 的/ 基于/ 系统/ 部件/ 监控/ 的/ 能耗/ 轮廓/ 分析/ 工具/ VMeter/ 以及/ Ye/ 等/ 人/ [/ 45/ ]/ 提出/ 的/ 基于/ 资源/ 监控/ 的/ 虚拟/ 数据中心/ 节能/ 架构/ 等/ ./ 5.1/ ./ 2/ 按/ 算法/ 精度/ 分论/ 的/ 精确/ 算法/ 和/ 基于/ 启发式/ 的/ 算法/ ./ 按照/ 算法/ 精度/ 分/ ,/ 能耗/ 管理/ 算法/ 分为/ 基于/ 控制/ Page13Kusic/ 等/ 人/ [/ 72/ ]/ 把/ 虚拟化/ 异构/ 环境/ 中/ 的/ 能耗/ 管理/ 问题/ 定义/ 为/ 一个/ 连续/ 优化/ 问题/ ,/ 并/ 采用/ 有限/ 的/ 超前/ 控制/ 方法/ 解决/ ,/ 目标/ 是/ 解决/ 最大化/ 资源/ 提供者/ 的/ 收益/ 、/ 最小化/ 功耗/ 和/ SLA/ 间/ 的/ 冲突/ ./ 最近/ ,/ Wang/ 等/ 人/ [/ 73/ -/ 74/ ]/ 针对/ 虚拟化/ 的/ 服务器/ 集群/ ,/ 提出/ 了/ 一个/ 创新/ 的/ 基于/ 反馈/ 控制/ 理论/ 的/ 集群/ 层/ 控制/ 架构/ Co/ -/ Con/ ,/ 协调/ 来自/ 不同/ 硬件/ // 软件/ 制造商/ 的/ 功耗/ 和/ 性能/ 控制策略/ ./ 实验/ 结果表明/ Co/ -/ Con/ 能/ 同时/ 对/ 程序/ 级/ 的/ 性能/ 和/ 底层/ 的/ 功耗/ 提供/ 有效/ 的/ 控制/ ./ 同时/ ,/ 他们/ 还/ 基于/ 控制/ 理论/ 提出/ 了/ 一个/ 两层/ 控制/ 架构/ PARTIC/ ,/ 解决/ 了/ 虚拟化/ 共享/ 平台/ 上/ 的/ 能耗/ 控制/ 问题/ [/ 75/ ]/ ./ Raghaven/ -/ dra/ 等/ 人/ [/ 76/ ]/ 采用/ 控制/ 理论/ 和/ 应用/ 反馈/ 控制/ 环路/ 来/ 绑定/ 和/ 协调/ 五个/ 不同/ 的/ 功耗/ 管理策略/ ./ 但是/ ,/ 基于/ 控制/ 理论/ 提出/ 的/ 模型/ 也/ 存在/ 一些/ 缺点/ ./ 如当/ 程序/ 调整/ 的/ 时候/ ,/ 需要/ 重新/ 基于/ 模拟/ 的/ 学习/ ,/ 这/ 对于/ 基础设施/ 即/ 服务/ (/ IaaS/ )/ 的/ 云/ 提供者/ (/ 如/ AmazonEC2/ )/ 来说/ 是/ 不/ 现实/ 的/ ./ 此外/ ,/ 模型/ 也/ 存在/ 着/ 固有/ 的/ 复杂度/ ,/ 主要/ 体现/ 在/ 执行/ 时间/ 上/ ./ 例如/ ,/ 对于/ 15/ 个/ 节点/ 来说/ ,/ 优化/ 控制器/ 本身/ 的/ 执行/ 时间/ 就/ 高达/ 30min/ [/ 72/ ]/ ,/ 这/ 对于/ 现实/ 中/ 大规模/ 的/ 云/ 计算/ 系统/ 来说/ 是/ 不可/ 接受/ 的/ ./ 基于/ 启发式/ 的/ 能耗/ 管理/ 算法/ 并不需要/ 在/ 程序/ 部署/ 前/ 进行/ 基于/ 模拟/ 的/ 学习/ ,/ 在/ 真实/ 的/ 大规模/ 云/ 计算/ 系统/ 中/ 可以/ 获得/ 较/ 高/ 的/ 性能/ ./ 目前/ ,/ 虚拟化/ 云/ 平台/ 的/ 绝大多数/ 自/ 适应/ 能耗/ 管理/ 算法/ 都/ 是/ 基于/ 启发式/ 的/ [/ 19/ -/ 21/ ,/ 26/ ,/ 30/ ,/ 57/ -/ 59/ ]/ ./ 5.1/ ./ 3/ 按/ 算法/ 粒度/ 分度/ 算法/ 、/ 粗粒度/ 算法/ 以及/ 粗细/ 粒度/ 混合/ 算法/ ./ 细粒度/ 的/ 能耗/ 管理/ 算法/ 指/ 的/ 是/ 在/ 单机/ 或者/ 系统/ 部件/ 层次/ 的/ 能耗/ 管理/ ./ Rajamani/ 等/ 人/ [/ 77/ ]/ 提出/ 了/ 一个/ 功耗/ 感知/ 的/ 请求/ 分配/ 系统/ ,/ 用来/ 解决/ 数据中心/ 的/ 功耗/ 问题/ ./ 他们/ 把/ 独立/ 的/ 功耗/ 请求/ 作为/ 基本/ 的/ 功耗/ 调度/ 工作/ 单位/ ./ 在/ 这个/ 环境/ 中/ ,/ 关闭/ 一个/ 节点/ 时/ 不/ 需要/ 迁移/ 或/ 备份/ ,/ 这是/ 一个/ 细粒度/ 的/ 电源/ 管理策略/ ./ 此外/ ,/ 也/ 有/ 一些/ 研究/ 人员/ 针对/ 多核/ 处理器/ 的/ 能耗/ 进行/ 细粒度/ 的/ 管理/ ,/ 如/ 从/ CPU/ 部署/ 和/ 节点/ 部署/ 角度/ 进行/ 的/ 细粒度/ 的/ 部署/ 研究/ [/ 78/ -/ 79/ ]/ ,/ 允许/ 作业/ 被/ 部署/ 到/ 可用/ 处理器/ 的/ 子集/ 上/ ,/ 而/ 把/ 剩余/ 的/ 关闭/ ./ 与/ 前面/ 的/ 工作/ 不同/ ,/ 粗粒度/ 的/ 能耗/ 管理/ 关注/ 的/ 基本/ 工作/ 单位/ 更大/ 一些/ ./ Lim/ 等/ 人/ [/ 53/ ]/ 把/ 虚拟机/ 域/ 作为/ 一个/ 基本/ 的/ 分配/ 单元/ ,/ 提出/ 了/ 一种/ 叫做/ 功耗/ 感知/ 的/ 域/ 部署/ (/ PADD/ )/ 方法/ ./ 该/ 方法/ 依靠/ 虚拟机/ 动态/ 迁移/ 技术/ ,/ 把/ 虚拟机/ 域/ 尽可能/ 地/ 部署/ 到/ 更/ 少/ 的/ 物理/ 机/ 按照/ 算法/ 的/ 粒度/ 分/ ,/ 能耗/ 管理/ 算法/ 可/ 分为/ 细粒/ 上/ ,/ 从而/ 达到/ 节能/ 的/ 目的/ ./ 此外/ ,/ 他们/ 还/ 开发/ 了/ 一个/ 两层/ 自/ 适应/ 缓存/ 机制/ 进行/ 容量/ 的/ 预留/ ,/ 以此/ 来/ 避免/ 与/ SLA/ 的/ 冲突/ ./ 也/ 有/ 一些/ 研究/ 人员/ 把/ 细粒度/ 的/ 方法/ 和/ 粗粒度/ 的/ 方法/ 综合/ 起来/ 使用/ ,/ 提出/ 一种/ 粗细/ 粒度/ 混合/ 的/ 算法/ ,/ 如/ Nathuji/ 等/ 人/ [/ 19/ ]/ 提出/ 了/ 一个/ 局部/ 和/ 全局/ 策略/ 混合/ 的/ 数据中心/ 资源管理/ 系统/ 的/ 架构/ ./ 在/ 局部/ 层/ ,/ 系统/ 利用/ 客户/ 操作系统/ 的/ 能耗/ 管理策略/ ./ 全局/ 管理器/ 则/ 获得/ 来自/ 局部/ 管理器/ 的/ 当前/ 资源分配/ 的/ 信息/ ,/ 并/ 应用/ 这个/ 策略/ 来/ 决定/ 是否/ 需要/ 采用/ 新/ 的/ 虚拟机/ 部署/ 方案/ ./ 5.1/ ./ 4/ 按/ 资源/ 种类/ 分/ 按照/ 资源/ 的/ 种类/ 分/ ,/ 能耗/ 管理/ 算法/ 分为/ 计算资源/ 节能/ 方法/ 、/ 存储资源/ 节能/ 方法/ 和/ 网络资源/ 节能/ 方法/ ./ 有关/ 计算资源/ 节能/ 的/ 研究/ 工作/ 非常/ 多/ ,/ 目前/ 大多数/ 的/ 能耗/ 管理/ 算法/ 都/ 是/ 针对/ 计算资源/ 的/ ,/ 如/ DVFS/ 等/ 机制/ 以及/ 通过/ 虚拟机/ 迁移/ 达到/ 节能/ 目的/ 的/ 方法/ [/ 19/ -/ 21/ ,/ 41/ -/ 42/ ,/ 45/ ,/ 47/ ,/ 51/ ,/ 53/ ]/ ./ Ye/ 等/ 人/ [/ 54/ ]/ 针对/ 存储/ 虚拟机/ 的/ 磁盘/ 能耗/ 情况/ ,/ 提出/ 了/ 3/ 种/ 优化/ 磁盘/ 能效/ 的/ 机制/ :/ 虚拟机/ 管理器/ 缓冲/ 、/ 早期/ 冲刷/ 和/ 有/ 缓冲/ 支持/ 的/ 早期/ 冲刷/ ./ 实验/ 表明/ 能/ 有效/ 优化/ 虚拟机/ 存储/ 磁盘/ 的/ 能效/ ./ Kaushik/ 等/ 人/ [/ 49/ ]/ 针对/ Hadoop/ 分布式文件系统/ 提出/ 了/ 一种/ 新/ 的/ 技术/ GreenHDFS/ ,/ 把/ Hadoop/ 集群/ 分成/ 逻辑/ 上/ 的/ 热点/ 区/ (/ HotZone/ )/ 和/ 冷点/ 区/ (/ ColdZone/ )/ ,/ 通过/ Green/ -/ HDFS/ 技术/ 增加/ 了/ 服务器/ 的/ 冷点/ 区/ 数量/ ,/ 然后/ 处于/ 冷点/ 区/ 的/ 服务器/ 的/ CPU/ 、/ 内存/ 、/ 磁盘/ 可以/ 被/ 转为/ 低功耗/ 模式/ ,/ 从而/ 达到/ 有效/ 节能/ 的/ 目的/ ./ 网络资源/ 的/ 节能/ 是/ 另/ 一个/ 重要/ 的/ 方向/ ./ Lin/ 等/ 人/ [/ 32/ ]/ 对/ 网络/ 的/ 节能/ 机制/ 进行/ 了/ 综述/ ,/ 分析/ 比较/ 了/ 不同/ 的/ 网络/ 节能/ 方法/ ./ Seetharaman/ [/ 50/ ]/ 针对/ 虚拟化/ 环境/ ,/ 提出/ 了/ 虚拟化/ 网络/ 能耗/ 在/ 多/ 租户/ 网络/ 中/ 的/ 节能/ 方法/ ,/ 通过/ 刺激/ 每个/ 租户/ 来/ 实现/ 节能/ ,/ 租户/ 可能/ 重新/ 调整/ 它们/ 的/ 活动/ 来/ 最小化/ 网络资源/ 的/ 能耗/ ./ 5.1/ ./ 5/ 按/ 应用/ 场景/ 分/ 虚拟化/ 技术/ 作为/ 一种/ 关键/ 的/ 底层/ 支撑/ 技术/ 应用/ 在/ 云/ 计算/ 数据中心/ 中/ ,/ 因此/ 对云/ 计算/ 数据中心/ 中/ 的/ 虚拟化/ 应用/ 场景/ 进行/ 能耗/ 研究/ 非常/ 必要/ ./ 对/ 这些/ 创新/ 场景/ 的/ 能耗/ 管理/ ,/ 在/ 传统/ 的/ 服务器/ 能耗/ 管理/ 活动/ 中是/ 没有/ 考虑/ 到/ 的/ ./ 下面/ ,/ 我们/ 重点/ 对/ 这些/ 特有/ 的/ 虚拟化/ 云/ 计算/ 平台/ 应用/ 场景/ 的/ 能耗/ 管理/ 算法/ 展开/ 分析/ ./ 按照/ 应用/ 场景/ 分/ ,/ 能耗/ 管理/ 算法/ 分为/ 3/ 大类/ :/ 节/ Page14/ 能/ 部署/ 算法/ 、/ 节能/ 整合/ 算法/ 和/ 节能/ 迁移/ 算法/ ,/ 如图/ 4/ 所示/ ./ 节能/ 部署/ 算法/ 可以/ 分为/ 静态/ 部署/ 算法/ 和/ 动态/ 部署/ 算法/ ./ 静态/ 部署/ 算法/ 包括/ 基于/ 相关性/ 的/ 部署/ 算法/ (/ CBP/ )/ 和/ 基于/ 峰值/ 聚类/ 的/ 部署/ 算法/ (/ PCP/ )/ ./ 动态/ 部署/ 算法/ 包括/ 能耗/ 最小化/ 部署/ 算法/ (/ mPP/ )/ 、/ 历史感/ 图/ 4/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 算法/ 分类/ 5.2/ 节能/ 部署/ 算法/ 能耗/ 感知/ 的/ 部署/ 算法/ (/ Power/ -/ AwarePlacementAlgorithm/ )/ 可以/ 抽象/ 为/ 一个/ 装箱/ 问题/ ,/ 目标/ 是/ 使得/ 能耗/ 最小/ ./ 当/ 数据中心/ 配置/ 发生/ 改变/ (/ 如/ 添加/ 了/ 额外/ 新/ 的/ 负载/ )/ 或者/ 负载/ 模式/ 发生变化/ (/ 如/ 某些/ 负载/ 的/ 程序/ 流量/ 发生变化/ )/ 时/ ,/ 会/ 重新/ 计算/ 部署/ ./ 最小化/ 功耗/ 的/ 装箱/ 有/ 如下/ 特征/ :/ (/ 1/ )/ 使用/ 尽可能少/ 的/ 服务器/ 来装/ 这些/ 虚拟机/ ;/ (/ 2/ )/ 优先选择/ 能量/ 使用/ 效率高/ 的/ 服务器/ ;/ (/ 3/ )/ 选择/ 跟/ 自己/ 容量/ 相近/ 的/ 服务器/ ,/ 避免/ 碎片/ ;/ (/ 4/ )/ 在/ 重/ 配置/ 过程/ 中/ 最小化/ 迁移/ 次数/ ./ 虚拟化/ 数据中心/ 的/ 负载/ 部署/ 包括/ 静态/ 部署/ 和/ 动态/ 部署/ ./ 静态/ 部署/ 方法/ 主要/ 是/ 出于/ 方便性/ 的/ 考虑/ 而/ 不是/ 效率/ ./ 早期/ 的/ 负载/ 管理工具/ 主要/ 功能/ 是/ 监控/ 和/ 报告/ 当前/ 的/ 状态/ 给/ 管理员/ ,/ 管理员/ 再/ 根据/ 报告/ 决定/ 合适/ 的/ 负载/ 管理策略/ ./ 容量/ 规划/ 就是/ 一种/ 典型/ 的/ 静态/ 初始/ 部署/ 活动/ ,/ 比较/ 著名/ 的/ 容量/ 规划/ 工具/ 有/ CirbaDataCenterIntelligence/ 、/ VMwareCapacityPlanner/ 和/ PlatespinPowerRecon/ 等/ ./ 也/ 存在/ 一些/ 动态/ 管理/ 的/ 工具/ ,/ 如/ VMwareDistributedResourceSchedu/ -/ ler/ (/ DRS/ )/ ./ 目前/ 有/ 一些/ 工具/ 支持/ 自动/ 制定/ 最优/ 的/ 数据中心/ 负载/ 配置/ ,/ 但/ 这些/ 工具/ 大都/ 基于/ 蛮力/ 搜索/ ,/ 而/ 没有/ 考虑/ 程序/ 敏感性/ 及/ 虚拟机/ 共存/ 等/ 开销/ [/ 89/ ]/ ./ 5.2/ ./ 1/ 部署/ 问题/ 的/ 形式化/ 描述/ 及其/ 目标/ 函数/ 虚拟机/ 部署/ 问题/ 可以/ 描述/ 为/ 把/ 虚拟机/ 分配/ 矩阵/ 犚/ g/ =/ {/ R11/ ,/ …/ ,/ Rij/ ,/ …/ ,/ Rms/ }/ 分解/ 为/ 虚拟机/ 集合/ V/ =/ {/ VM1/ ,/ …/ ,/ VMl/ }/ 和/ 物理/ 主机/ 集合/ H/ =/ {/ H1/ ,/ …/ ,/ Hn/ }/ ./ 部署/ 问题/ 的/ 目标/ 决定/ 了/ 部署/ 矩阵/ 犘/ ,/ 如果/ 虚拟/ 知/ 的/ 部署/ 算法/ (/ iFFD/ )/ 和/ 迁移开销/ 感知/ 的/ 部署/ 算法/ (/ pMaP/ )/ ./ 节能/ 整合/ 算法/ 分为/ ECTC/ 部署/ 算法/ 和/ MaxUtil/ 部署/ 算法/ ./ 节能/ 迁移/ 算法/ 又/ 细分/ 为/ :/ 单/ 阈值/ 迁移/ 算法/ (/ ST/ )/ 、/ 最小化/ 迁移/ 算法/ (/ MM/ )/ 、/ 最高/ 增长/ 潜力/ 算法/ (/ HPG/ )/ 和/ 随机/ 选择/ 算法/ (/ RC/ )/ ./ 节能/ 部署/ 的/ 目标/ 是/ 最大化/ 空闲/ 物理/ 主机/ 的/ 个数/ 机/ v/ 被/ 分配/ 到/ 主机/ h/ 上/ ,/ 则/ Phv/ =/ 1/ ,/ 反之/ Phv/ =/ 0/ ./ 任何/ 的/ 部署/ 解决方案/ 必须/ 满足/ 物理/ 主机/ 的/ 容量/ 约束/ :/ / h/ ∈/ {/ 1/ ,/ …/ ,/ n/ }/ ∑/ l/ / h/ ∈/ {/ 1/ ,/ …/ ,/ n/ }/ ∑/ lNidle/ ,/ 这些/ 空闲/ 主机/ 可以/ 被/ 关掉/ 以/ 达到/ 节能/ :/ Nidle/ =/ ∑/ n/ 根据/ 部署/ 目标/ 的/ 不同/ ,/ 虚拟机/ 部署/ 问题/ 可以/ 表示/ 成/ 不同/ 的/ 形式/ [/ 41/ ]/ ,/ 下面/ 介绍/ 3/ 种/ 不同/ 的/ 虚拟机/ 部署/ 问题/ :/ (/ 1/ )/ 开销/ 与/ 性能/ 的/ 权衡/ (/ costperformancetradeoff/ )/ ./ 部署/ 问题/ 一般/ 要/ 解决/ 两个/ 子/ 问题/ :/ ①/ 程序/ 大小/ 的/ 确定/ ;/ ②/ 程序/ 的/ 部署/ ./ 部署/ 的/ 目标/ 是/ 获得/ 最优/ 的/ 性能/ 和/ 开销/ 权衡/ ./ 这里/ 的/ 开销/ 只/ 考虑/ 能耗/ 和/ 迁移/ 的/ 开销/ ./ 给定/ 一个/ 旧/ 的/ 分配/ Ao/ ,/ 一个/ 性能/ 收益/ 函数/ B/ (/ A/ )/ ,/ 一个/ 能耗/ 开销/ 函数/ P/ (/ A/ )/ ,/ 一个/ 迁移开销/ 函数/ Mig/ ./ 对于/ 任何/ 一个/ 分配/ A/ ,/ 需要/ 找到/ 一个/ AI/ (/ 由/ xij/ 定义/ ,/ xij/ 表示/ 服务器/ Hj/ 上/ 的/ 资源分配/ 给/ 应用程序/ Vi/ )/ ,/ 使得/ 收益/ 最大化/ :/ max/ ∑/ N/ (/ 2/ )/ 性能/ 约束/ 下/ 的/ 成本/ 最小化/ (/ costminimiza/ -/ Page15tionwithperformanceconstraint/ )/ ./ 目前/ ,/ 数据中心/ 正在/ 走向/ 基于/ SLA/ 的/ 环境/ ,/ 即/ 有/ 量化/ 的/ 性能/ 保证/ ./ 因此/ ,/ 在/ 这样/ 一个/ 场景/ 中/ ,/ 性能/ 不再/ 是/ 一个/ 需要/ 最大化/ 的/ 指标/ ,/ 可以/ 被/ 约束条件/ 替换/ ./ 在/ 实际操作/ 中/ ,/ 把/ 虚拟机/ 的/ 大小/ 问题/ 从/ 决策/ 器中/ 拿走/ ,/ 虚拟机/ 大小/ 现在/ 由/ 基于/ SLA/ 的/ 性能/ 管理器/ 决定/ ./ 决策/ 器/ 只/ 需要/ 最小化/ 分配/ 的/ 整体/ 开销/ ./ 因此/ 该/ 优化/ 部署/ 问题/ 变成/ :/ (/ 3/ )/ 能耗/ 约束/ 下/ 的/ 性能/ 收益/ 最大化/ (/ performancebenefitmaximizationwithpowerconstraints/ )/ ./ 第/ 3/ 种/ 程序/ 部署/ 问题/ 是/ 在/ 每个/ 服务器/ 给定/ 一个/ 固定/ 的/ 能耗/ 预算/ ,/ 最大化/ 网络/ 性能/ 收益/ ./ 网络/ 性能/ 收益/ 可以/ 通过/ 计算/ 性能/ 收益/ 和/ 迁移开销/ 的/ 差/ 求得/ 5.2/ ./ 2/ 静态/ 及半/ 静态/ 部署/ 算法/ 服务器/ 整合/ 可以/ 分为/ :/ 静态/ 、/ 半/ 静态/ 和/ 动态/ 整合/ ./ 静态/ 整合/ 指/ 程序/ 或者/ 虚拟机/ 长时间/ (/ 如/ 几个/ 月/ 、/ 几年/ )/ 部署/ 到/ 物理/ 服务器/ 上/ ,/ 不/ 根据/ 负载/ 的/ 变化/ 进行/ 连续/ 迁移/ ./ 半/ 静态/ 整合/ 指/ 的/ 是/ 在/ 每天/ 或/ 每周/ 重新/ 整合/ 这些/ 程序/ ./ 动态/ 整合/ 要求/ 部署/ 管理器/ 根据/ 运行/ 时/ 特征/ 自动/ 迁移/ 虚拟机/ ,/ 响应/ 负载/ 的/ 变化/ ,/ 时间/ 粒度/ 往往/ 是/ 数个/ 小时/ ./ 许多/ 虚拟化/ 软件/ 提供/ 一些/ 工具/ 支持/ 静态/ 整合/ ./ 但是/ 这些/ 工具/ 只/ 提供/ 一个/ 基于/ 策略/ 的/ 框架/ ,/ 这些/ 策略/ 需要/ 用户/ 定义/ ,/ 部署/ 的/ 智能化/ 也/ 非常简单/ ./ 现在/ ,/ 已经/ 有/ 多个/ 研究/ 提出/ 了/ 动态/ 部署/ 框架/ ./ 实际上/ ,/ 管理员/ 往往/ 不/ 愿意/ 自动/ 迁移/ 虚拟机/ ./ 他们/ 喜欢/ 离线/ 的/ 或者/ 半/ 离线/ 的/ 框架/ ,/ 部署/ 生效/ 前会/ 先/ 对/ 提出/ 的/ 部署/ 策略/ 进行/ 评估/ ,/ 并/ 经过/ 人工/ 批准/ ./ 因此/ ,/ 对于/ 真实/ 数据中心/ 的/ 管理员/ 来说/ ,/ 静态/ 和/ 半/ 静态/ 整合/ 方式/ (/ 每天/ 或/ 每周/ 进行/ )/ 是/ 更/ 受欢迎/ 的/ 技术/ ./ 通过/ 整合/ 来/ 最小化/ 服务器/ 数目/ 和/ 节能/ 的/ 研究/ 工作/ 较/ 多/ ,/ 但是/ 利用/ 负载/ 的/ 相互/ 关联性/ 信息/ ,/ 系统性/ 地/ 决定/ 最/ 有效/ 的/ 静态/ 整合/ 配置/ 方面/ 的/ 研究/ 工作/ 还/ 较/ 少/ ./ 基于/ 负载/ 的/ 特征分析/ ,/ Verma/ 等/ 人/ [/ 35/ ]/ 提出/ 两个/ 新/ 的/ 整合/ 方法/ :/ 基于/ 相关性/ 的/ 部署/ (/ CorrelationBasedPlacement/ ,/ CBP/ )/ 和/ 基于/ 峰值/ 聚类/ 的/ 部署/ (/ PeakClusteringbasedPlacement/ ,/ PCP/ )/ ./ (/ 1/ )/ 基于/ 相关性/ 的/ 部署/ CBP/ ./ CBP/ 算法/ 的/ 提出/ 是/ 基于/ 以下/ 一些/ 现象/ :/ ①/ 一个/ 应用程序/ 使用/ 的/ 峰值/ 资源/ 比/ 其它/ 大多数/ 情况/ 高得/ 多/ ;/ ②/ 如果/ 用非/ 峰值/ 的/ 指标/ 来/ 确定/ 应用程序/ 的/ 规模/ ,/ 并/ 把/ 相关/ 的/ 应用程序/ 部署/ 在/ 一起/ ,/ 会/ 有/ 导致/ SLA/ 冲突/ 的/ 危险/ ;/ ③/ 如果/ 两个/ 不/ 相关/ 的/ 应用程序/ 部署/ 在/ 一起/ ,/ 并且/ 每个/ 应用程序/ 规模/ 冲突/ 概率/ 为/ X/ %/ ,/ 那么/ 在/ 同一/ 时刻/ ,/ 两个/ 应用程序/ 都/ 冲突/ 的/ 概率/ 是/ (/ X/ %/ )/ 2/ ./ CBP/ 算法/ 的/ 基本思路/ 是/ 基于/ 尾部/ 边界/ (/ tailbound/ )/ 来/ 进行/ 应用程序/ 规模/ 的/ 确定/ ,/ 而/ 不是/ 根据/ 应用程序/ 需要/ 的/ 最/ 大规模/ 来/ 判断/ ./ 而且/ CBP/ 考虑/ 了/ 程序/ 之间/ 的/ 正/ 相关性/ 约束/ ,/ 这样/ 保证/ 两个/ 正/ 相关/ 的/ 应用程序/ 不会/ 被/ 部署/ 到/ 同一个/ 服务器/ 中/ ./ 约束/ 数目/ 可以/ 用/ 可/ 调控/ 的/ 相关性/ 限制/ 进行/ 控制/ ./ 同时/ ,/ 因为/ 需要/ 对/ 所有/ 应用程序/ 对/ 的/ 相关性/ 进行/ 计算/ ,/ CBP/ 算法/ 也/ 导致/ 了/ 一定/ 的/ 额外/ 开销/ ./ 作者/ 证明/ 了/ 给定/ N/ 个/ 应用程序/ 以及/ 有/ d/ 个点/ 的/ 时间/ 序列/ ,/ CBP/ 要花费/ O/ (/ N2d/ )/ 的/ 时间/ 来/ 找到/ 新/ 的/ 部署/ ./ (/ 2/ )/ 基于/ 峰值/ 聚类/ 的/ 部署/ PCP/ ./ PCP/ 算法/ 的/ 提出/ 是/ 基于/ 以下/ 一些/ 现象/ :/ ①/ 应用程序/ 峰值/ 的/ 相关性/ 比/ 其它/ 时间段/ 的/ 相关性/ 更/ 重要/ ;/ ②/ 同时/ 出现/ 峰值/ 的/ 一组/ 应用程序/ ,/ 即使/ 以/ 最优/ 的/ 方式/ 被/ 均匀/ 地/ 分布/ 在/ 所有/ 活动/ 主机/ 上/ ,/ 也/ 会/ 出现/ 两个/ 有/ 相关/ 峰值/ 的/ 应用程序/ 被/ 部署/ 在/ 同一个/ 服务器/ 上/ ;/ ③/ 峰值/ 一起/ 出现/ 的/ 共存/ 应用程序/ 可以/ 使用/ 一个/ 共用/ 的/ 缓冲/ 来/ 对付/ 峰值/ ,/ 每个/ 应用程序/ 都/ 预留/ 与非/ 峰值/ 相同/ 的/ 一个/ 值/ ./ PCP/ 首先/ 把/ 这些/ 有/ 相关/ 峰值/ 的/ 应用程序/ 聚成/ 一类/ ./ 但是/ ,/ 如果/ 原始/ 时间/ 序列/ 数据/ 过大/ ,/ 会/ 导致/ 聚类/ 数很多/ ./ 因此/ ,/ PCP/ 采用/ 一个/ 应用程序/ 原始/ 时间/ 序列/ 两层/ 包围/ 的/ 方法/ ./ 用/ 一个/ 值来/ 代表/ CPU/ 利用率/ 分布/ 主体/ 部分/ ,/ 用/ 另/ 一个/ 值来/ 代表/ 其它/ 尾部/ 分布/ 的/ 所有/ 点/ ./ 然后/ ,/ 每个/ 活动/ 服务器/ 按/ 应用程序/ 规模/ 为/ 每个/ 聚类/ 进行/ 空间/ 预留/ ,/ 并/ 保留/ 一个/ 与/ 所有/ 聚类/ 中/ 最大/ 峰值/ 同等/ 大/ 的/ 缓冲/ 空间/ ./ 每个/ 应用程序/ 根据/ 聚类/ 结果/ 挑选/ 应用程序/ 集合/ 进行/ 预留/ ,/ 然后/ PCP/ 最终/ 为/ 服务器/ 选择/ 应用程序/ ./ 5.2/ ./ 3/ 动态/ 部署/ 算法/ 下面/ 介绍/ 3/ 种/ 动态/ 部署/ 算法/ :/ 能耗/ 最小化/ 部署/ 、/ 历史/ 感知/ 部署/ 和/ 迁移开销/ 部署/ 算法/ [/ 41/ ]/ ./ (/ 1/ )/ 能耗/ 最小化/ 部署/ 算法/ (/ Power/ -/ minimizingPlacementAlgorithm/ )/ ,/ 如/ 算法/ 1/ 所示/ ,/ 目标/ 是/ 最小化/ 能耗/ ./ 首先/ 提出/ 一个/ mPP/ 算法/ (/ minPowerParity/ )/ ,/ 把/ 虚拟机/ 部署/ 到/ 给定/ 集合/ 的/ 服务器/ 上/ ,/ 使得/ 所有/ 服务器/ 消耗/ 的/ 能耗/ 最小/ ./ 算法/ 分/ 两步/ :/ 第/ 1/ 步/ ,/ 根据/ 服务器/ 的/ 能耗/ 模型/ 决定/ 每个/ 服务器/ 的/ 目标/ 利用率/ ./ 目标/ 利用率/ 以/ 贪婪/ 方式/ 进行/ 计算/ ,/ 从/ 0/ 利用率/ 开始/ 为/ Page16/ 每个/ 服务器/ 计算/ ./ 然后/ 选择/ 那个/ 单位/ 容量/ 增长/ 能耗/ 最少/ 的/ 服务器/ ./ 重复/ 这个/ 过程/ ,/ 直到/ 虚拟机/ 都/ 分配/ 完/ ./ 第/ 2/ 步/ ,/ 也/ 叫做/ FFD/ (/ FirstFitDecreasing/ )/ 装箱/ 算法/ ,/ 是/ 基于/ FFD/ 来/ 部署/ 虚拟机/ 到/ 服务器/ 上/ ,/ 同时/ 满足/ 每个/ 服务器/ 的/ 目标/ 利用率/ ./ 算法/ 1/ ./ 能耗/ 最小化/ 部署/ mPP/ ./ 输入/ :/ / iVMi/ ,/ Allocold/ 输出/ :/ Allocnew/ / ServerjAllocj/ =/ / ,/ Usedj/ =/ 0SortVMsbysizeindecresingorderFORi/ =/ 1TON/ / ServerjcomputeSlope/ (/ Usedj/ )/ PicktheServerminwiththeleastSlopeAddVMitoAllocmin/ ,/ Usedmin/ +/ =/ Size/ (/ VMi/ )/ ENDFORAllocnew/ =/ FFD/ (/ Used/ )/ ReturnAllocnew/ (/ 2/ )/ 历史/ 感知/ 的/ 部署/ 算法/ (/ HistoryAwarePack/ -/ ingAlgorithm/ )/ ,/ 如/ 算法/ 2/ 所示/ ,/ 目标/ 是/ 减少/ 迁移/ 次数/ ./ 算法/ 2/ ./ 历史/ 感知/ 的/ 部署/ iFFD/ ./ 输入/ :/ Alloc0/ ,/ Used/ 输出/ :/ AllocnDonors/ =/ / ,/ Receivers/ =/ / FORallserversSjPrevj/ =/ sumofVMsinSjbyAlloc0IF/ (/ Prevj/ >/ Usedj/ )/ ELSEENDFORFORallSjinDonorsPickthesmallestVMsthatadduptoMigjandaddthemtoMigListENDFORSortMigListbasedonsizeFORallVMiinMigListPlaceVMionthefirstDonorjthatcanpackitwithinUsedjENDFORReturnAllocn/ 能量/ 最小化/ 部署/ 算法/ mPP/ 的/ 目标/ 是/ 最小化/ 能耗/ ,/ 但是/ 算法/ 没有/ 考虑/ 也/ 不/ 知道/ 前/ 一次/ 的/ 配置/ 结果/ ./ 因此/ 可能/ 导致/ 大规模/ 的/ 迁移/ 操作/ ,/ 这会/ 导致/ 很/ 高/ 的/ 整体/ 开销/ (/ 能耗/ 和/ 迁移/ )/ ./ 因此/ ,/ Verma/ 等/ 人/ 提出/ 了/ 一个/ 改进/ 的/ FFD/ 算法/ ,/ 称做/ iFFD/ (/ incrementalFFD/ )/ 来/ 进行/ 应用程序/ 到/ 物理/ 服务器/ 上/ 的/ 部署/ ./ iFFD/ 首先/ 计算/ 需要/ 请求/ 更高/ 利用率/ 的/ 服务器/ 列表/ ,/ 用/ receivers/ 标记/ ./ 对于/ 每个/ donor/ (/ 目标/ 利用率/ 低于/ 当前/ 的/ 利用率/ )/ ,/ 选择/ 规模/ 最小/ 的/ 应用程序/ 来/ 迁移/ ,/ 把/ 它们/ 添加/ 到/ 一个/ 虚拟机/ 迁移/ 列表/ ./ 然后/ 运行/ FFD/ ,/ 把/ receivers/ 剩余/ 容量/ (/ 目标/ 容量/ -/ 当前/ 容量/ )/ 作为/ 箱子/ ,/ 虚拟机/ 迁移/ 列表/ 作为/ 球/ ,/ 进行/ 装箱/ 操作/ ./ (/ 3/ )/ 迁移开销/ 感知/ 的/ 部署/ 算法/ (/ MigrationCost/ -/ awareLocallyOptimalPlacementAlgorithm/ )/ ,/ 如/ 算法/ 3/ 所示/ ,/ 目标/ 是/ 最小化/ 总开销/ ,/ 包括/ 能耗/ 和/ 迁移/ 的/ 开销/ ,/ 也/ 就是/ 考虑/ 单位/ 迁移开销/ 的/ 能耗/ 优化/ ./ 算法/ 3/ ./ 迁移开销/ 感知/ 的/ 局部优化/ 部署/ pMaP/ ./ 输入/ :/ Alloc0/ ,/ VMi/ 输出/ :/ MigsAllocn/ =/ mPPH/ (/ Alloc0/ ,/ VMi/ )/ MList/ =/ getMigList/ (/ Alloc0/ ,/ Allocn/ )/ / ServerjwithnoVMsplacedinAllocnVGj/ =/ VMsplacedonServerjinAlloc0/ / migi/ ∈/ MListCosti/ =/ getMigrationCost/ (/ migi/ )/ ,/ Benefiti/ =/ getBenefit/ (/ migi/ )/ SortMListbyBenefiti/ // costi/ (/ decreasing/ )/ migbest/ =/ mostprofitableentryinMListWHILE/ (/ profitbest/ >/ costbest/ )/ AND/ (/ MList/ ≠/ / )/ RecomputeCostandBenefitforMListENDWHILEReturnMigspMaP/ 算法/ 平衡/ 能耗/ 和/ 迁移/ 的/ 开销/ ,/ 目标/ 是/ 寻找/ 一个/ 最小化/ 总开销/ (/ 能耗/ 和/ 迁移/ )/ 的/ 分配/ ./ pMaP/ 以/ 最小化/ 能耗/ 的/ 方式/ 连续/ 寻找/ 新/ 的/ 虚拟机/ 分配/ ,/ 同时/ 考虑/ 迁移/ 的/ 开销/ ./ 算法/ 首先/ 调用/ 任意/ 的/ 能耗/ 最小化/ 部署/ 算法/ ,/ 得到/ 一个/ 新/ 的/ 能耗/ 最小化/ 部署/ ,/ 然后/ 比较/ 两种/ 部署/ 的/ 差异/ ,/ 决定/ 选择/ 一个/ 子集/ ./ 选择/ 过程/ 是/ 基于/ 对/ 所有/ 迁移/ 的/ 单位/ 迁移开销/ 的/ 能耗/ 上升/ 量/ 进行/ 升序/ 排序/ ./ 然后/ ,/ 选择/ 收益/ 最大/ 的/ 迁移/ ./ 重复/ 以上/ 步骤/ ,/ 直到/ 没有/ 能耗/ 和/ 迁移/ 权衡/ 优化/ 的/ 迁移/ 存在/ ./ 此外/ ,/ Moore/ 等/ 人/ [/ 80/ ]/ 开发/ 了/ 温度/ 感知/ 的/ 负载/ 部署/ 算法/ ,/ 最大/ 限度/ 减少/ 为/ 冷却/ 基础设施/ 而/ 支出/ 的/ 能耗/ ,/ 实现/ 较/ 低/ 的/ 冷却/ 开销/ ,/ 增加/ 硬件/ 可靠性/ ./ 他们/ 通过观察/ 数据中心/ 中热/ 气流/ 的/ 方法/ ,/ 提出/ 两种/ 负载/ 部署/ 策略/ :/ 基于/ 区域/ 离散/ 化/ (/ Zone/ -/ BasedDiscretiza/ -/ Page17tion/ ,/ ZBD/ )/ 和/ 最小化/ 热循环/ (/ Minimize/ -/ Heat/ -/ Recir/ -/ culation/ ,/ MinHR/ )/ ./ Verma/ 等/ 人/ [/ 81/ ]/ 特别/ 研究/ 了/ 在/ 虚拟化/ 支持/ 的/ 服务器/ 上/ ,/ 对/ 高性能/ 计算/ 应用程序/ 使用/ 节能/ 管理/ 技术/ ,/ 提出/ 了/ 一个/ 框架/ 和/ 方法论/ 进行/ 功耗/ 感知/ 的/ 高性能/ 计算/ 程序/ 部署/ ./ Lim/ 等/ 人/ [/ 53/ ]/ 采用/ 虚拟机/ 在线/ 迁移/ 技术/ ,/ 提出/ 了/ 一种/ 功耗/ 感知/ 的/ 域/ 部署/ (/ PADD/ )/ 策略/ ./ 5.3/ 节能/ 整合/ 算法/ Lee/ 和/ Zomaya/ [/ 5/ ]/ 提出/ 了/ 两种/ 能耗/ 感知/ 的/ 任务/ 整合/ 算法/ :/ ECTC/ 和/ MaxUtil/ ./ ECTC/ 和/ MaxUtil/ 的/ 步骤/ 相似/ (/ 如/ 算法/ 4/ 所示/ )/ ,/ 主要/ 的/ 区别/ 在于/ 它们/ 的/ 开销/ 函数/ ./ 对于/ 一个/ 给定/ 的/ 任务/ ,/ 这/ 两个/ 启发式/ 算法/ 检测/ 每个/ 资源/ ,/ 把/ 最高/ 能效/ 的/ 资源分配/ 给/ 该/ 任务/ ./ 算法/ 4/ ./ 能耗/ 感知/ 的/ 任务/ 整合/ 算法/ ./ 输入/ :/ AtasktjandasetRofrcloudresources/ 输出/ :/ Atask/ -/ resourcematchLetr/ / =/ / FOR/ / ri/ ∈/ RDOComputethecostfunctionvaluefi/ ,/ joftjonriIFfi/ ,/ j/ >/ f/ / jTHENLetr/ / =/ riLetf/ / j/ =/ fi/ ,/ jENDIFENDFORAssgintjtor/ / ECTC/ 的/ 开销/ 函数/ 计算/ 当前任务/ 的/ 真实/ 能耗/ 减去/ 运行/ 一个/ 任务/ 的/ 最小/ 能耗/ Pmin/ ,/ 如果/ 有/ 其它/ 任务/ 跟/ 这个/ 任务/ 并行/ 运行/ 的话/ ,/ 那么/ 这些/ 任务/ 和/ 当前任务/ 在/ 重叠/ 时间/ 的/ 能量消耗/ 需要/ 被/ 考虑/ 进来/ ./ 开销/ 函数/ 往往/ 区别对待/ 单独/ 运行/ 的/ 任务/ ./ 使用/ ECTC/ 开销/ 函数/ ,/ 任务/ tj/ 在/ 资源/ ri/ 获得/ 的/ 值/ fi/ ,/ j/ 被/ 定义/ 为/ fi/ ,/ j/ =/ (/ (/ p/ Δ/ ×/ uj/ +/ pmin/ )/ ×/ τ/ 0/ )/ -/ 其中/ ,/ p/ Δ/ 是/ pmax/ 和/ pmin/ 的/ 差值/ ,/ uj/ 是/ tj/ 的/ 利用率/ ,/ τ/ 0/ 、/ τ/ 1/ 、/ τ/ 2/ 分别/ 是/ tj/ 的/ 总体/ 处理/ 时间/ 、/ 单独/ 运行/ 时间/ 和/ 并行/ 运行/ 时间/ ./ 该/ 函数/ 表明/ 最低/ 利用率/ 时/ 的/ 能耗/ 比/ 空闲/ 时/ 的/ 能耗/ 多/ 的/ 多/ ,/ 由/ 重叠/ 任务/ 导致/ 的/ 能耗/ 增加/ 幅度/ 相对/ 较少/ ./ MaxUtil/ 的/ 开销/ 函数/ 由/ 在/ 当前任务/ 的/ 处理/ 时间/ 内/ 的/ 主要/ 系统/ 部件/ 的/ 平均/ 利用率/ 推断/ 而来/ ./ 该/ 函数/ 的/ 目标/ 是/ 增加/ 整合/ 的/ 密度/ ./ 有/ 两/ 方面/ 的/ 优点/ :/ 第/ 1/ 个/ 优点/ 是/ 降低/ 了/ 能量消耗/ ;/ 第/ 2/ 个/ 优点/ 是/ MaxUtil/ 的/ 开销/ 函数/ 暗中/ 降低/ 了/ 活动/ 资源/ 的/ 个数/ ./ 因为/ 与/ ECTC/ 的/ 开销/ 函数/ 相比/ 的话/ ,/ 该/ 开销/ 函数/ 趋向于/ 少数/ 高/ 利用率/ 的/ 资源/ ./ 使用/ MaxUtil/ 开销/ 函数/ ,/ 任务/ tj/ 在/ 资源/ ri/ 获得/ 的/ 值/ fi/ ,/ j/ 被/ 定义/ 为/ 此外/ ,/ Zhu/ 等/ 人/ [/ 52/ ]/ 针对/ 虚拟化/ 环境/ 下/ 的/ 科学/ 工作/ 流/ ,/ 开发/ 了/ 一个/ 能耗/ 感知/ 的/ 整合/ 框架/ pSciMap/ -/ per/ ./ Beloglazov/ 等/ 人/ [/ 68/ ]/ 基于/ 虚拟机/ 资源/ 使用/ 的/ 历史数据/ 的/ 分析/ ,/ 提出/ 了/ 一种/ 新/ 的/ 自/ 适应/ 启发式/ 算法/ 进行/ 虚拟机/ 的/ 动态/ 整合/ ,/ 该/ 算法/ 在/ 1000/ 台/ 虚拟机/ 上/ 进行/ 了/ 验证/ 分析/ ,/ 实验/ 证明/ 算法/ 能/ 大幅/ 减少/ 能耗/ ,/ 同时/ 保证/ 较/ 高/ 的/ SLA/ ./ Berral/ 等/ 人/ [/ 82/ ]/ 从/ 机器/ 学习/ 技术/ 角度/ ,/ 研究/ 虚拟机/ 的/ 动态/ 整合/ 问题/ ,/ 同时/ 满足/ 能耗/ 和/ SLA/ 的/ 双重/ 目标/ ./ 5.4/ 节能/ 迁移/ 算法/ Beloglazov/ 等/ 人/ [/ 47/ ]/ 提出/ 了/ 4/ 种/ 启发式/ 的/ 算法/ 来/ 选择/ 虚拟机/ 进行/ 迁移/ ./ 其中/ 单/ 阈值/ 方法/ (/ SingleThreshold/ ,/ ST/ )/ ,/ 是/ 基于/ 设置/ 主机/ 上限/ 利用率/ 的/ 想法/ ,/ 部署/ 虚拟机/ 的/ 时候/ 保持/ 总/ CPU/ 利用率/ 低于/ 这个/ 阈值/ ./ 目标/ 是/ 预留/ 空闲/ 资源/ ,/ 防止/ 在/ 整合/ 场景/ 下/ 虚拟机/ 资源/ 需求/ 增加/ 而/ 导致/ 的/ SLA/ 冲突/ ./ 在/ 每个/ 时间段/ ,/ 所有/ 的/ 虚拟机/ 根据/ MBFD/ (/ ModifiedBestFitDecreasing/ )/ 算法/ 进行/ 重/ 分配/ ,/ 额外/ 的/ 条件/ 是/ 保持/ 上限/ 利用率/ 阈值/ 没有/ 超过/ ./ 新/ 的/ 部署/ 可以/ 通过/ 虚拟机/ 在线/ 迁移/ 来/ 进行/ ./ 其它/ 3/ 个/ 启发式/ 算法/ 是/ 基于/ 设置/ 主机/ 利用率/ 上/ 下限/ ,/ 保持/ 整体/ CPU/ 利用率/ 在/ 这/ 两个/ 阈值/ 之间/ ./ 如果/ 主机/ CPU/ 的/ 利用率/ 低于/ 下界/ ,/ 所有/ 的/ 虚拟机/ 需要/ 被/ 迁移/ 走/ ,/ 这个/ 主机/ 需要/ 被/ 关掉/ ,/ 消除/ 空闲/ 主机/ 的/ 能耗/ ./ 如果/ 利用率/ 高于/ 上/ 界/ ,/ 则/ 一些/ 虚拟机/ 需要/ 被/ 迁移/ 走以/ 降低/ 利用率/ ,/ 防止/ 潜在/ SLA/ 冲突/ ./ 作者/ 提出/ 了/ 3/ 种/ 策略/ 来/ 选择/ 需要/ 从/ 主机/ 迁移/ 走/ 的/ 虚拟机/ :/ (/ 1/ )/ 最小化/ 迁移/ (/ MinimizationofMigrations/ ,/ MM/ )/ ./ 迁移/ 最小/ 的/ 虚拟机/ 个数/ 来/ 最小化/ 迁移开销/ ;/ (/ 2/ )/ 最高/ 增长/ 潜力/ (/ HighestPotentialGrowth/ ,/ HPG/ )/ ./ 迁移/ 那些/ 有/ 最低/ CPU/ 使用率/ 的/ 虚拟机/ ,/ 为了/ 最小化/ 整体/ 潜在/ 的/ 利用率/ 上升/ ,/ 进而/ 导致/ SLA/ 冲突/ ;/ (/ 3/ )/ 随机/ 选择/ (/ RandomChoice/ ,/ RC/ )/ ./ 迁移/ 必要/ 数目/ 的/ 虚拟机/ ,/ 根据/ 一个/ 均匀分布/ 的/ 随机变量/ 进行/ 选择/ ./ 最近/ ,/ Graubner/ 等/ 人/ [/ 83/ ]/ 提出/ 了/ 一个/ 提升/ IaaS/ 云/ 的/ 能效/ 的/ 方法/ ./ 与/ 前人/ 工作/ 不同/ 的/ 地方/ 在于/ ,/ 该/ 工作/ 考虑/ 了/ 在线/ 迁移/ 过程/ 中/ 的/ 预处理/ 和/ 后处理/ 阶段/ 的/ Page18/ 能量/ 开销/ ,/ 并/ 在/ Eucalyptus/ 开源/ 云/ 计算/ 系统/ 中/ 实现/ ./ 5.5/ 其它/ 算法/ Mazzucco/ 等/ 人/ [/ 90/ ]/ 提出/ 了/ 一个/ 能量/ 感知/ 的/ 分配/ 策略/ ,/ 目标/ 是/ 最大化/ 平均/ 收益/ ./ 这个/ 策略/ 基于/ 动态/ 评估/ 用户/ 需求/ 和/ 建模/ 系统/ 行为/ ./ Le/ 等/ 人/ [/ 91/ ]/ 提出/ 并/ 评估/ 了/ 一个/ 基于/ 优化/ 的/ 请求/ 分布/ 框架/ ,/ 进行/ 多/ 数据中心/ 的/ 分配/ ./ 这个/ 框架/ 允许/ 服务/ 管理/ 它们/ 自己/ 的/ 能耗/ 和/ 开销/ ,/ 同时/ 满足/ SLA/ ./ 基于/ 这个/ 框架/ ,/ 提出/ 两种/ 请求/ 分配/ 策略/ :/ 考虑/ 不同/ 的/ 时间/ 区域/ 和/ 不同/ 的/ 电力/ 价格/ ;/ 考虑/ 绿色/ 能源/ ./ Srikantaiah/ 等/ 人/ [/ 28/ ]/ 把/ 整合/ 问题/ 建模/ 成/ 一个/ 改进/ 的/ 装箱/ 问题/ ,/ 考虑/ CPU/ 和/ 磁盘/ 使用率/ ./ 该/ 算法/ 尝试/ 在/ 最/ 优点/ 整合/ 任务/ ,/ 平衡/ 能耗/ 和/ 性能/ ./ 算法/ 分/ 两步/ :/ (/ 1/ )/ 从/ 轮廓/ 分析/ 数据/ 决定/ 最/ 优点/ ;/ (/ 2/ )/ 使用/ 每个/ 服务器/ 当前/ 分配/ 和/ 最优/ 分配/ 之间/ 的/ 欧氏/ 距离/ ,/ 进行/ 能量/ 感知/ 的/ 资源分配/ ./ Liao/ 等/ 人/ [/ 44/ ]/ 提出/ 了/ 一个/ 概率/ 启发式/ 算法/ 来/ 优化/ 在/ 多维/ 资源/ 约束/ 下/ 的/ 虚拟机/ 在/ 物理/ 机上/ 的/ 映射/ 问题/ ,/ 并/ 给出/ 了/ 一个/ 经济学/ 方法/ 来/ 平衡/ 能耗/ 降低/ 和/ 性能/ 损耗/ 的/ 问题/ ./ Rodero/ 等/ 人/ [/ 92/ ]/ 针对/ 高性能/ 计算/ 程序/ ,/ 提出/ 了/ 一个/ 在/ 整合/ 的/ 虚拟化/ 计算/ 平台/ 中/ 的/ 能量/ 感知/ 的/ 在线/ 供给/ 算法/ ./ 通过/ 使用/ 一个/ 负载/ 感知/ 的/ 动态/ 供给/ 机制/ ,/ 以及/ 关闭/ 空闲/ 主机/ 等/ 操作/ 来/ 获得/ 节能/ ./ 对/ 新/ 进来/ 的/ 任务/ 请求/ ,/ 根据/ 他们/ 的/ 系统配置/ 和/ 运行/ 时/ 状态/ ,/ 使用/ 一个/ 在线/ 的/ 聚类/ 方法/ 来/ 动态/ 特征/ 化/ 和/ 聚类/ ,/ 再/ 根据/ 详细/ 的/ 虚拟机/ 配置/ 需求/ 聚类/ 结果/ 来/ 确定/ 节能/ 的/ 资源/ 供给/ ./ 6/ 结语/ 本文/ 分析/ 了/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 技术/ ,/ 从/ 能耗/ 测量/ 、/ 能耗/ 建模/ 、/ 能耗/ 管理机制/ 、/ 能耗/ 管理/ 算法/ 4/ 个/ 方面/ 进行/ 了/ 系统/ 的/ 阐述/ ./ 能耗/ 测量/ 的/ 开销/ 和/ 准确性/ 是/ 制定/ 高效/ 能耗/ 管理策略/ 的/ 基础/ ./ 能耗/ 建模/ 的/ 精度/ ,/ 直接/ 反映/ 了/ 虚拟机/ 能耗/ 数据/ 的/ 准确性/ ,/ 对/ 后续/ 节能/ 优化/ 非常/ 重要/ ./ 能耗/ 管理机制/ 被/ 分为/ 虚拟化/ 层/ 的/ 管理机制/ 和/ 云/ 平台/ 层/ 的/ 管理机制/ ./ 能耗/ 管理/ 算法/ 按/ 应用/ 场景/ 被/ 分为/ 节能/ 部署/ 算法/ 、/ 节能/ 整合/ 算法/ 、/ 节能/ 迁移/ 算法/ 等/ ./ 这/ 4/ 方面/ 的/ 内容/ 关系密切/ ,/ 相互/ 衔接/ ,/ 共同/ 构成/ 了/ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 解决方案/ ./ 它们/ 的/ 关系/ 是/ :/ 能耗/ 测量/ 获得/ 资源/ 使用/ 情/ (/ 2/ )/ 基于/ 统计/ 学习/ 的/ 能耗/ 建模/ 技术/ ./ 由于/ 能耗/ 相关/ 的/ 硬件/ 事件/ 种类/ 和/ 参数/ 众多/ ,/ 需要/ 引入/ 基于/ 统计/ 学习/ 的/ 方法/ 对/ 原始/ 监测数据/ 进行/ 统计分析/ ,/ 不断/ 修正/ 能耗/ 模型/ ,/ 提升/ 模型/ 的/ 精度/ ./ 同时/ 这种/ 基于/ 历史数据/ 学习/ 的/ 建模/ 方法/ ,/ 还/ 可以/ 用来/ 预测/ 未来/ 的/ 能量消耗/ 情况/ ,/ 提前/ 进行/ 相应/ 的/ 节能/ 决策/ ./ (/ 3/ )/ 能耗/ 和/ 性能/ 的/ 双/ 目标/ 优化/ ./ 一个/ 有效/ 的/ 节能/ 方法/ 不仅仅/ 能/ 减少/ 能耗/ ,/ 而且/ 要/ 保证/ 不/ 牺牲/ 性能/ ./ 由于/ 有时/ 性能/ (/ 包括/ QoS/ 或/ SLA/ )/ 和/ 能耗/ 的/ 优化/ 是/ 互斥/ 的/ ,/ 例如/ 服务器/ 整合/ 能/ 减少/ 物理/ 主机/ 数目/ ,/ 达到/ 节能/ 目的/ ,/ 但是/ 服务器/ 整合/ 同时/ 会因/ 共享资源/ 的/ 竞争/ 和/ 干扰/ 影响/ 共存/ 应用程序/ 的/ 性能/ ,/ 因此/ 需要/ 一种/ 双/ 目标/ 的/ 优化/ 方法/ ./ 况/ 的/ 原始数据/ ,/ 传递/ 给/ 能耗/ 模型/ ;/ 能耗/ 模型/ 根据/ 计算/ 得出/ 虚拟机/ 的/ 能耗/ 使用/ 情况/ ;/ 基于/ 这些/ 数据/ ,/ 可以/ 实现/ 复杂/ 的/ 能耗/ 管理机制/ 和/ 管理/ 算法/ ./ 虚拟化/ 云/ 计算/ 平台/ 的/ 能耗/ 管理/ 目前/ 还/ 处在/ 刚刚/ 兴起/ 的/ 阶段/ ,/ 大多数/ 研究成果/ 是/ 最近/ 几年/ 才/ 发表/ 的/ ,/ 还/ 存在/ 很多/ 问题/ 需要/ 进一步/ 研究/ ./ 下面/ 我们/ 根据/ 对/ 前人/ 工作/ 的/ 总结/ ,/ 并/ 结合/ 自己/ 的/ 理解/ ,/ 给出/ 未来/ 虚拟化/ 云/ 计算/ 平台/ 能耗/ 管理/ 领域/ 的/ 十个/ 需/ 进一步/ 研究/ 的/ 问题/ :/ (/ 1/ )/ 多/ 因素/ 驱动/ 的/ 轻量级/ 在线/ 能耗/ 轮廓/ 分析方法/ ./ 能耗/ 问题/ 不是/ 一个/ 孤立/ 的/ 问题/ ,/ 它/ 受到/ 多方面/ 因素/ 的/ 影响/ ./ 在/ 真实/ 的/ 云/ 计算环境/ 中/ ,/ 往往/ 需要/ 一种/ 在线/ 的/ 能耗/ 监测/ 方法/ 能/ 及时/ 准确/ 地/ 提供/ 虚拟机/ 的/ 能耗/ 使用/ 数据/ ,/ 但/ 同时/ 又/ 希望/ 能耗/ 监测/ 的/ 过程/ 是/ 轻量/ 的/ ,/ 即/ 占用/ 少量/ 的/ 系统资源/ 即可/ 完成/ ./ (/ 4/ )/ 迁移开销/ 和/ 状态/ 切换/ 开销/ 的/ 分析/ ./ 在线/ 迁移/ 技术/ 已经/ 成为/ 实现/ 数据中心/ 层次/ 节能/ 的/ 一个/ 重要/ 技术/ ./ 但/ 迁移/ 不是/ 免费/ 的/ ,/ 它/ 本身/ 是/ 存在/ 开销/ ,/ 包括/ 网络/ 传输/ 的/ 开销/ 以及/ 存在/ 短暂/ 的/ 停机/ 时间/ (/ 往往/ 几十/ 毫秒/ )/ ./ 另外/ ,/ 服务器/ 在/ 休眠/ 和/ 唤醒/ 之间/ 进行/ 状态/ 的/ 切换/ 也/ 是/ 需要/ 开销/ 的/ ./ 很多/ 前人/ 的/ 工作/ 都/ 忽略/ 了/ 这/ 一点/ ,/ 因此/ 需要/ 进行/ 重新考虑/ ./ (/ 5/ )/ 多维/ 资源/ 的/ 节能/ ./ 目前/ 的/ 大多数/ 的/ 工作/ 都/ 只/ 考虑/ 计算资源/ 的/ 节能/ ,/ 较/ 少/ 涉及/ 其它/ 诸如/ 存储资源/ (/ 包括/ 文件系统/ )/ 、/ 网络资源/ 等/ 的/ 节能/ ./ 当/ 计算资源/ 的/ 节能/ 优化/ 已经/ 发展/ 相对/ 成熟/ 的/ 时候/ ,/ 多/ 关注/ 其它/ 系统资源/ 的/ 节能/ 或许/ 可以/ 获得/ 良好/ 的/ 效果/ ./ (/ 6/ )/ 能耗/ 感知/ 的/ 资源管理/ 算法/ 研究/ ./ 传统/ 的/ 资源管理/ 方法/ 主要/ 关注/ 性能/ 的/ 提升/ ,/ 当/ 考虑/ 能耗/ 因素/ 时/ ,/ 这些/ 方法/ 可能/ 会/ 发生变化/ ./ 研究/ 能耗/ 感知/ 的/ 云计/ Page19/ 算/ 资源管理/ 算法/ ,/ 包括/ 节能/ 调度/ 、/ 节能/ 分配/ 、/ 节能/ 部署/ 等/ ,/ 能/ 有效/ 降低/ 云/ 数据中心/ 的/ 能耗/ ./ (/ 7/ )/ 个性化/ 节能/ 方案/ 的/ 推荐/ ./ 在/ 云/ 计算环境/ 中/ ,/ 负载/ 是/ 多种多样/ 的/ ,/ 它们/ 对/ 资源/ 的/ 需求/ 和/ 对/ 服务器/ 能效/ 的/ 需求/ 也/ 是/ 不/ 一样/ 的/ ,/ 同时/ 系统/ 的/ 软硬件/ 运行/ 环境/ 也/ 是/ 存在/ 差异/ 的/ ./ 如何/ 根据/ 已有/ 的/ 信息/ ,/ 主动/ 地/ 推荐/ 个性化/ 的/ 节能/ 方案/ 是/ 一个/ 有意思/ 的/ 问题/ ./ (/ 8/ )/ 复杂/ 应用程序/ 的/ 能耗/ 分析/ ./ 通用/ 的/ 节能/ 方法/ (/ 如/ 整合/ )/ 对于/ 不同/ 的/ 应用程序/ 来说/ ,/ 获得/ 的/ 效果/ 参差不齐/ ./ 因此/ ,/ 需要/ 分析/ 特定/ 应用程序/ (/ 如/ Multi/ -/ tier/ 程序/ 、/ 数据/ 密集/ 程序/ 等/ )/ 的/ 行为/ 特征/ 和/ 资源/ 访问/ 模式/ ,/ 进行/ 针对性/ 的/ 优化/ ./ (/ 9/ )/ 协同/ 节能/ 方法/ ./ 当前/ ,/ 不同/ 的/ 系统/ 部件/ 和/ 层次/ ,/ 如/ 处理器/ 层/ 、/ 操作系统/ 层/ 、/ 集群/ 层/ 、/ 数据中心/ 层/ 等/ ,/ 都/ 提供/ 各自/ 的/ 能耗/ 管理机制/ ./ 此外/ 不同/ 的/ 软硬件/ 制造商/ 也/ 会/ 提供/ 各自/ 的/ 能耗/ 管理机制/ ./ 如何/ 协同/ 这些/ 处在/ 不同/ 层次/ 的/ 、/ 来源/ 不同/ 的/ 能耗/ 管理机制/ ,/ 发挥/ 最大/ 的/ 节能/ 优势/ ,/ 是/ 一个/ 需要/ 解决/ 的/ 问题/ ./ (/ 10/ )/ 虚拟化/ 能耗/ 的/ 标准化/ 评价/ 问题/ ./ 针对/ 传统/ 服务器/ 的/ 能耗/ 测试/ 基准/ 有/ SPECpower/ _/ ssj2008/ 和/ TPC/ _/ Energy/ ,/ 还/ 没有/ 专门/ 的/ 针对/ 虚拟化/ 云/ 计算环境/ 的/ 能耗/ 测试/ 基准/ ./ 因此/ ,/ 需要/ 研究/ 虚拟化/ 云/ 计算环境/ 下/ 的/ 能耗/ 评价/ 面临/ 的/ 新/ 问题/ ,/ 定义/ 评价/ 指标/ 并/ 制定/ 评价/ 方法/ ./ 

