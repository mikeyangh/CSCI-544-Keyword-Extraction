Page1/ 基于/ 混合/ 优化/ 的/ 快速/ 隐式/ 曲面/ 采样/ 方法/ 李伟涛/ 1/ )/ 周元峰/ 1/ )/ 高珊/ 珊/ 2/ )/ 张彩明/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 2/ )/ (/ 山东/ 财经大学/ 山东省/ 数字/ 媒体/ 技术/ 重点/ 实验室/ 济南/ 250014/ )/ 摘要/ 该文/ 提出/ 了/ 一种/ 新/ 的/ 隐式/ 曲面/ 快速/ 采样/ 方法/ ,/ 该/ 方法/ 首先/ 提出/ 了/ 一种/ 新/ 的/ 采样/ 点/ 互斥/ 能量/ 目标/ 函数/ ,/ 基于/ 该/ 目标/ 函数/ ,/ 通过/ 一种/ 混合/ 优化/ 方法/ 来/ 求解/ 采样/ 点/ 的/ 分布/ ./ 第/ 1/ 步为/ 采样/ 点/ 的/ 局部优化/ ,/ 通过/ 对/ 采样/ 点/ 移动/ 速度/ 的/ 控制参数/ 调整/ ,/ 避免/ 了/ 大量/ Hessian/ 矩阵/ 的/ 求/ 逆/ 操作/ ,/ 使得/ 采样/ 点/ 能够/ 根据/ 互斥/ 半径/ 快速/ 覆盖/ 整个/ 隐式/ 曲面/ ,/ 得到/ 初始/ 采样/ 点集/ ;/ 第/ 2/ 步为/ 采样/ 点/ 的/ 全局/ 优化/ ,/ 采用/ L/ -/ BFGS/ 方法/ 对/ 所有/ 采样/ 点/ 进行/ 优化/ ,/ 得到/ 最终/ 的/ 高质量/ 采样/ 结果/ ./ 通过/ 实验/ 表明/ ,/ 新/ 方法/ 的/ 采样/ 速度/ 大大提高/ ,/ 并/ 能够/ 获得/ 较/ 好/ 的/ 隐式/ 曲面/ 采样/ 点/ 分布/ ./ 关键词/ 隐式/ 曲面/ ;/ 动态/ 采样/ ;/ 优化/ ;/ 目标/ 函数/ 1/ 引言/ 近年来/ ,/ 随着/ CAGD/ 、/ CAD/ 、/ 计算机/ 仿真技术/ 的/ 发展/ ,/ 基于/ 隐式/ 曲面/ 的/ 建模/ 方法/ 得到/ 了/ 越来越/ 广泛/ 的/ 关注/ 和/ 应用/ ./ 在/ 曲面/ 建模/ 中/ ,/ 与/ 参数/ 曲面/ 相比/ ,/ 基于/ 隐式/ 曲面/ 的/ 建模/ 具有/ 以下/ 优势/ :/ 可以/ 提供/ 更为/ 简洁/ 直观/ 的/ 表达方法/ ;/ 具有/ 很/ 高/ 的/ 连续性/ ;/ 能够/ 容易/ 地/ 表示/ 拓扑/ 复杂/ 的/ 曲面/ ,/ 并且/ 容易/ 改变/ 曲面/ 的/ 拓扑/ 结构/ ;/ 空间/ 点/ 与/ 隐式/ 曲面/ 的/ 相对/ 位置/ 容易/ 判断/ ./ 隐式/ 曲/ Page2/ 面/ 绘制/ 方法/ 一般/ 有/ 两种/ :/ 光线/ 跟踪/ 方法/ 和/ 多边形/ 化/ 方法/ ./ 光线/ 跟踪/ 方法/ 可以/ 得到/ 隐式/ 曲面/ 的/ 高质量/ 的/ 图像/ 显示/ ,/ 但是/ 需要/ 进行/ 大量/ 的/ 光线/ 与/ 隐式/ 曲面/ 求交/ 运算/ ,/ 因此/ 绘制/ 速度/ 受到/ 影响/ ,/ 快速/ 高质量/ 的/ 隐式/ 曲面/ 采样/ 有助于/ 提高/ 光线/ 投射/ 算法/ 效率/ ./ 同时/ ,/ 高效/ 的/ 隐式/ 曲面/ 采样/ 方法/ 可以/ 有助于/ 对/ 隐式/ 曲面/ 进行/ 显示/ 和/ 控制/ ./ 因此/ ,/ 隐式/ 曲面/ 采样/ 问题/ 在/ 科学计算/ 可视化/ 、/ 隐式/ 曲面/ 绘制/ 、/ 计算机/ 动画/ 等/ 领域/ 有/ 很/ 高/ 的/ 应用/ 价值/ ./ 目前/ 在/ 计算机/ 图形学/ 领域/ 中/ ,/ 隐式/ 曲面/ 的/ 采样/ 方法/ 已经/ 被/ 应用/ 于/ 隐式/ 曲面/ 绘制/ [/ 1/ ]/ 、/ 形状/ 控制/ [/ 2/ ]/ 、/ 曲面/ 多边形/ 化/ [/ 3/ -/ 8/ ]/ 、/ 动画设计/ [/ 9/ ]/ 、/ 纹理/ 映射/ [/ 10/ ]/ 等/ 应用/ 中/ ,/ 在/ 这些/ 应用/ 中/ ,/ 如何/ 快速/ 获得/ 高质量/ 的/ 采样/ 结果/ 是/ 其中/ 的/ 关键问题/ 之一/ ./ 利用/ 粒子/ 采样/ 对/ 隐式/ 曲面/ 进行/ 建模/ 和/ 绘制/ 的/ 方法/ [/ 11/ -/ 12/ ]/ 最先/ 由/ Szeliski/ 和/ Tonnesen/ 等/ 人/ 提出/ ,/ 该/ 方法/ 能够/ 对/ 变形/ 曲面模型/ 计算/ 有/ 向/ 粒子/ 采样/ ,/ 称为/ 粒子系统/ (/ ParticleSystem/ )/ ,/ 是/ 目前/ 使用/ 较/ 多/ 的/ 隐式/ 曲面/ 采样/ 与/ 绘制/ 方法/ 之一/ ./ Witkin/ 等/ 人/ [/ 13/ ]/ 基于/ 优化/ 方法/ 提出/ 了/ 一种/ 用/ 采样/ 粒子/ 对/ 隐式/ 曲面/ 进行/ 采样/ 和/ 控制/ 的/ 方法/ ,/ 该/ 方法/ 将/ 一组/ 粒子/ 约束/ 在/ 曲面/ 上/ ,/ 粒子/ 之间/ 的/ 互斥/ 力使/ 粒子/ 均匀/ 地/ 分布/ 在/ 曲面/ 上/ ,/ 从而/ 实现/ 对/ 曲面/ 的/ 采样/ ./ 该/ 方法/ 可以/ 实现/ 动态/ 、/ 实时/ 地/ 在/ 曲面/ 上/ 去掉/ 或者/ 增加/ 粒子/ ,/ 但是/ 该/ 方法/ 需要/ 求解/ 大量/ 参数/ ,/ 其/ 优化/ 方法/ 无法/ 达到/ 稳定/ 收敛/ 效果/ ,/ 难以获得/ 一组/ 稳定/ 的/ 采样/ 粒子/ ./ 在/ Witkin/ 方法/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一些/ 对/ 该/ 方法/ 的/ 改进/ ,/ 如/ 文献/ [/ 14/ -/ 16/ ]/ 中/ 能够/ 根据/ 曲率/ 变化/ 约束/ 粒子/ 的/ 数量/ ,/ 在/ 曲率/ 高/ 的/ 地方/ 生成/ 较/ 多/ 的/ 采样/ 点/ ,/ Hart/ 等/ 人/ [/ 17/ ]/ 改进/ 了/ Witkin/ 的/ 方法/ ,/ 给出/ 了/ 一种/ 自动/ 确定/ 参数/ 的/ 方法/ ,/ 能够/ 对/ 较为/ 复杂/ 的/ 隐式/ 曲面/ 进行/ 采样/ ,/ 但/ 这些/ 方法/ 的/ 不足/ 仍然/ 是/ 采样/ 过程/ 不够/ 稳定/ ./ Heckbert/ 等/ 人/ [/ 18/ ]/ 提出/ 了/ 一种/ 采样/ 粒子/ 影响/ 半径/ 估计/ 方法/ ,/ 为/ 每个/ 粒子/ 设定/ 一个/ 不同/ 的/ 影响/ 区域/ ,/ 方法/ 的/ 优点/ 是/ 在/ 计算/ 互斥/ 能量/ 时/ 只/ 需要/ 考虑/ 该/ 区域/ 内/ 的/ 采样/ 点/ ,/ 缺点/ 是/ 需要/ 不断更新/ 每个/ 采样/ 粒子/ 的/ 包围/ 球/ ./ Meyer/ 等/ 人/ [/ 14/ ]/ 采用/ 了/ 一种/ 优化/ 的/ 方法/ 求解/ 曲率/ 约束/ 下/ 的/ 粒子/ 采样/ ,/ 该/ 方法/ 计算/ 稳定/ (/ 本文/ 称为/ Meyer/ 方法/ )/ ,/ 对/ 拓扑/ 复杂/ 的/ 曲面/ 能够/ 获得/ 好/ 的/ 采样/ 结果/ ,/ 但/ 因为/ 在/ 调整/ 采样/ 点/ 位置/ 时/ 需要/ 大量/ 重复/ 计算/ 目标/ 函数/ 的/ Hessian/ 矩阵/ 及其/ 逆/ 矩阵/ ,/ 求解/ 过程/ 缓慢/ ,/ 因此/ 难以达到/ 快速/ 采样/ 的/ 效果/ ./ 基于/ 以上/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 对/ 隐式/ 曲面/ 快速/ 采样/ 的/ 新/ 方法/ ,/ 能够/ 快速/ 获得/ 隐式/ 曲面/ 上/ 高质量/ 的/ 采样/ 结果/ ./ 如图/ 1/ 所示/ ,/ 给出/ 了/ 一个/ 对于/ 球面/ 进行/ 表面/ 采样/ 的/ 结果/ ./ 新/ 方法/ 采用/ 两步/ 优化/ 方法/ 对/ 隐式/ 曲面/ 进行/ 快速/ 高质量/ 采样/ ,/ 分别/ 是/ 采样/ 点/ 的/ 局部优化/ 和/ 全局/ 优化/ ./ 为了/ 能够/ 使/ 采样/ 点/ 快速/ 分布/ 到/ 整个/ 隐式/ 曲面/ 上/ ,/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 能量/ 目标/ 函数/ ,/ 首先/ 采用/ 牛顿/ 法/ 获得/ 每个/ 粒子/ 的/ 移动/ 速率/ 及/ 方向/ ,/ 通过/ 对/ 移动/ 速率/ 的/ 调整/ 获得/ 隐式/ 曲面/ 的/ 初始/ 采样/ ,/ 在/ 初始/ 采样/ 的/ 基础/ 上/ ,/ 利用/ 全局/ 优化/ 方法/ L/ -/ BFGS/ (/ LimitedMemoryBFGS/ )/ 方法/ 对/ 采样/ 点/ 进行/ 进一步/ 优化/ ,/ 从而/ 获得/ 稳定/ 的/ 采样/ 结果/ ./ 本文/ 的/ 主要/ 创新/ 点/ 如下/ :/ (/ 1/ )/ 提出/ 了/ 一种/ 新/ 的/ 采样/ 点/ 互斥/ 能量/ 目标/ 函数/ ,/ 该/ 函数/ 具有/ 更快/ 的/ 下降/ 速度/ ,/ 能够/ 快速/ 获得/ 采样/ 点/ 在/ 隐式/ 曲面/ 上/ 的/ 初始/ 分布/ ;/ (/ 2/ )/ 采用/ 一种/ 新/ 的/ 采样/ 点/ 更新/ 策略/ 获得/ 初始/ 采样/ ,/ 避免/ 了/ 大量/ 重复/ Hessian/ 矩阵/ 的/ 求/ 逆/ 计算/ ;/ (/ 3/ )/ 引入/ L/ -/ BFGS/ 方法/ ,/ 对/ 隐式/ 曲面/ 初始/ 采样/ 结果/ 进行/ 进一步/ 优化/ ,/ 从而/ 获得/ 高质量/ 稳定/ 的/ 采样/ 点集/ ./ 2/ 基于/ 粒子系统/ 的/ 隐式/ 曲面/ 采样/ 方法/ Witkin/ 等/ 人/ [/ 13/ ]/ 提出/ 的/ 隐式/ 曲面/ 建模/ 方法/ 基于/ 粒子系统/ ,/ 可以/ 实时/ 地/ 显示/ 和/ 交互/ 控制/ 隐式/ 曲面/ ./ 在/ 此/ 我们/ 简单/ 介绍/ 一下/ Witkin/ 粒子/ 采样/ 方法/ 的/ 基本/ 思想/ ./ 首先/ 给出/ 采样/ 粒子/ 的/ 定义/ :/ 对/ 隐式/ 曲面/ ,/ 定义/ 约束/ 在/ f/ 上/ 的/ 一个点/ 为/ 该/ 曲面/ 上/ 的/ 一个/ 采样/ 粒子/ ./ 假定/ 狆/ 为/ f/ 上/ 的/ 一个/ 粒子/ ,/ 狆/ 满足/ 如下/ 约束/ :/ 这里/ f/ 可/ 看作/ 随/ 时间/ t/ 变化/ 的/ 动态/ 隐式/ 曲面/ ,/ 狆/ i/ (/ t/ )/ 为/ 约束/ 于/ 隐式/ 曲面/ 上/ 的/ 第/ i/ 个/ 粒子/ 位置/ ,/ 狇/ i/ (/ t/ )/ 为/ 隐式/ 曲面/ 的/ 系数/ 向量/ ./ 利用/ 式/ (/ 1/ )/ 将/ 一定/ 数量/ 的/ 粒子/ 约束/ 在/ 隐式/ 曲面/ 上/ ,/ 可以/ 构成/ 对/ 隐式/ 曲面/ 的/ 表面/ Page3/ 采样/ ./ Witkin/ 方法/ 为/ 每个/ 粒子/ 定义/ 一个/ 与其/ 相邻/ 粒子/ 间/ 的/ 互斥/ 作用力/ ,/ 互斥/ 力/ 将/ 粒子/ 与/ 粒子/ 之间/ 分隔/ 出/ 一定/ 的/ 距离/ ,/ 当/ 所有/ 粒子/ 的/ 互斥/ 作用/ 达到/ 均衡/ 时/ ,/ 可以/ 将/ 粒子/ 均匀/ 地/ 分布/ 在/ 曲面/ 之上/ ./ 根据/ 高斯/ 函数/ ,/ 粒子/ 与/ j/ 粒子/ 之间/ 的/ 互斥/ 能量/ 定义/ 为/ 其中/ :/ |/ rij/ |/ 为/ 两个/ 粒子/ 之间/ 的/ 距离/ ;/ σ/ i/ 为/ 局部/ 互斥/ 半径/ ,/ 并/ 根据/ 粒子/ 的/ 局部/ 能量/ 值/ 进行/ 变化/ ;/ α/ 为/ 可调/ 互斥/ 参数/ ./ 第/ i/ 个/ 粒子/ 的/ 能量/ 定义/ 为/ Ei/ =/ ∑/ j/ 度/ 下降/ 法知/ ,/ 粒子/ 沿/ 能量/ Ei/ 的/ 梯度方向/ 移动/ 能量/ 减小/ 最快/ ./ 由式/ (/ 2/ )/ 知/ ,/ 粒子/ 移动/ 速率/ 可/ 由/ 对/ 互斥/ 能量/ 求导/ 得到/ vi/ =/ -/ (/ σ/ i/ )/ 2EiPi/ =/ (/ σ/ i/ )/ 2/ ∑/ n/ 当/ 粒子/ 的/ 能量/ 不/ 满足/ 一定/ 阈值/ 时/ ,/ 将/ vi/ 投影/ 到/ 粒子/ 所在/ 的/ 局部/ 切/ 平面/ ,/ 使得/ 粒子/ 沿/ vi/ 进行/ 移动/ ,/ 此时/ 粒子/ 可能/ 会/ 脱离/ 隐式/ 曲面/ ,/ 可以/ 将/ 更新/ 后/ 的/ 粒子/ 再/ 反投影/ 到/ 隐式/ 曲面/ 上/ ./ Witkin/ 采样/ 方法/ 采用/ 粒子/ 动态/ 分裂/ // 死亡/ 机制/ 将/ 粒子/ 约束/ 在/ 曲面/ 上/ ,/ 初始/ 给定/ 一个/ 随机/ 粒子/ 和/ 一个/ 比较/ 大/ 的/ 互斥/ 半径/ ,/ 用/ 迭代/ 方法/ 对/ 粒子/ 进行/ 分裂/ 或者/ 死亡/ ,/ 若/ 粒子/ 的/ 互斥/ 半径/ 大于/ 设定/ 的/ 半径/ 阈值/ 或者/ 粒子/ 能量/ 大于/ 设定/ 的/ 能量/ 阈值/ ,/ 则/ 将/ 该/ 粒子/ 一分为二/ ,/ 并/ 减少/ 粒子/ 之间/ 的/ 互斥/ 半径/ ;/ 反之/ ,/ 若/ 粒子/ 的/ 互斥/ 半径/ 过/ 小/ ,/ 则/ 该/ 粒子/ 死亡/ ./ 迭代/ 重复/ 上述/ 步骤/ ,/ 直至/ 所有/ 粒子/ 满足/ 能量/ 和/ 互斥/ 半径/ 约束条件/ ./ Meyer/ 等/ 人/ [/ 14/ ]/ 在/ 此基础/ 上/ 提出/ 了/ 一种/ 更为/ 稳定/ 的/ 隐式/ 曲面/ 采样/ 方法/ ,/ 该/ 方法/ 采用/ Levenberg/ -/ Marquardt/ 方法/ 局部优化/ 采样/ 点/ 位置/ ,/ 通过/ 调整/ 目标/ 能量/ 函数/ 的/ Hessian/ 矩阵/ 来/ 更新/ 采样/ 点/ 移动/ 的/ 速率/ 及/ 方向/ ./ 该/ 方法/ 需要/ 多次/ 计算/ Hessian/ 矩阵/ 并求/ 逆/ ,/ 因此/ 计算/ 量/ 大/ ,/ 采样/ 点/ 移动/ 速度慢/ ./ 图/ 2/ 采样/ 点/ 能量/ 函数/ 比较/ 3/ 混合/ 优化/ 的/ 隐式/ 曲面/ 采样/ 方法/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 隐式/ 曲面/ 采样/ 方法/ ,/ 方法/ 可以/ 分为/ 两个/ 步骤/ :/ 第/ 1/ 步/ 建立/ 采样/ 点/ 互斥/ 能量/ 目标/ 函数/ ,/ 利用/ 牛顿/ 法/ 动态/ 获得/ 一个/ 隐式/ 曲面/ 上/ 的/ 初始/ 采样/ 点集/ ;/ 第/ 2/ 步/ ,/ 采用/ 全局/ 优化/ 方法/ L/ -/ BFGS/ 方法/ 对/ 初始/ 采样/ 点集/ 进行/ 进一步/ 优化/ ,/ 从而/ 获得/ 更为理想/ 的/ 采样/ 点集/ 位置/ ./ 本节/ 我们/ 详细/ 介绍/ 一下/ 新/ 的/ 采样/ 方法/ ./ 3.1/ 新/ 的/ 能量/ 目标/ 函数/ 建立/ 对于/ 隐式/ 曲面/ 采样/ 问题/ ,/ 粒子系统/ (/ ParticleSystem/ )/ 能够/ 通过/ 优化/ 采样/ 点间/ 的/ 互斥/ 能量/ 函数/ 调整/ 采样/ 点/ 的/ 位置/ ,/ 逐步/ 达到/ 采样/ 点/ 在/ 隐式/ 曲面/ 上/ 均匀分布/ ./ 在/ Meyer/ 方法/ 中/ [/ 14/ ]/ ,/ 作者/ 采用/ 了/ 三角函数/ 来/ 定义/ 两个/ 采样/ 点/ 之间/ 的/ 互斥/ 力/ 能量/ 函数/ ,/ 通过/ 对/ 该/ 能量/ 函数/ 求一阶/ 导数/ 得到/ 采样/ 点/ 的/ 移动/ 速度/ ,/ 并/ 进行/ 采样/ 点/ 更新/ ./ 在/ 本文/ 中/ ,/ 我们/ 提出/ 一种/ 新/ 的/ 采样/ 点间/ 的/ 互斥/ 能量/ 函数/ ,/ 为了/ 能/ 使/ 采样/ 点/ 获得/ 更快/ 的/ 更新/ 速度/ ,/ 采用/ 双曲/ 函数/ 定义/ 采样/ 点/ 之间/ 的/ 互斥/ 能量/ :/ 其中/ ,/ a/ 为/ 可/ 调节/ 参数/ ,/ 在/ 此/ 一般/ 取/ a/ =/ e2/ ./ 当/ 采样/ 点/ 能量/ 不/ 满足/ 给定/ 阈值/ 时/ ,/ 将/ 采样/ 点/ 沿着/ 函数/ (/ 4/ )/ 的/ 梯度/ 在/ 其切/ 平面/ 的/ 投影/ 进行/ 调整/ ,/ 能量/ 函数/ 的/ 梯度/ 表达式/ 为/ vi/ =/ -/ a/ 图/ 2/ 给出/ 了/ 对于/ 新/ 的/ 能量/ 目标/ 函数/ 同/ Meyer/ 方法/ 中/ 的/ 目标/ 函数/ 的/ 比较/ ,/ 通过/ 对/ 能量/ 函数/ ,/ 能量/ 函数/ 的/ 一阶/ 导数/ 与/ 二阶/ 导数/ 的/ 比较/ 可以/ 看出/ ,/ 当/ 两个/ 采样/ 点/ 之间/ 的/ 距离/ 接近/ 给定/ 阈值/ σ/ 时/ ,/ 能量/ 函数/ 具有/ 更/ 平缓/ 的/ 变化/ ,/ 采用/ 局部/ 调整/ 方法/ 能够/ 快速/ 获得/ 隐式/ 曲面/ 的/ 初始/ 采样/ ./ Page43/ ./ 2/ 采样/ 点/ 局部/ 快速/ 调整/ 在/ 建立/ 了/ 采样/ 点间/ 的/ 互斥/ 能量/ 函数/ 之后/ ,/ 本文/ 首先/ 采用/ Meyer/ 方法/ 中/ 的/ Gauss/ -/ Siedel/ 更新/ 策略/ 对/ 所有/ 采样/ 点/ 进行/ 局部/ 调整/ ,/ 获得/ 一个/ 初始/ 采样/ 结果/ ./ 采样/ 点/ 进行/ 局部/ 更新/ ,/ 通过/ 调整/ 采样/ 点/ 移动/ 的/ 速率/ 大小/ 使得/ 互斥/ 能量/ 下降/ ,/ 并且/ 该/ 采样/ 点/ 的/ 移动/ 方向/ 仅/ 根据/ 其/ 周围/ 最近/ 的/ 若干/ 采样/ 点/ 进行/ 计算/ ./ 首先/ 介绍/ 一下/ 对/ 每个/ 采样/ 点/ 的/ 局部/ 更新/ 策略/ ./ 以/ 一个/ 粒子/ pki/ 为例/ ,/ 根据/ 牛顿/ 法/ ,/ 能量/ 下降/ 的/ 梯度方向/ 可以/ 表示/ 为/ 其中/ ,/ Hi/ ,/ Di/ 分别/ 表示/ 能量/ 函数/ Ei/ 的/ Hessian/ 矩阵/ 和/ 梯度/ ,/ 其中/ Hi/ =/ / 2EiDi/ =/ ∑/ m/ 将/ 采样/ 点/ 移动/ 速度/ 向量/ 投影/ 到/ 该/ 采样/ 点/ 在/ 曲面/ 上/ 的/ 切/ 平面/ 上/ ,/ 待/ 采样/ 点/ 按照/ 该/ 投影/ 向量/ 进行/ 位置/ 调整/ 后/ ,/ 新/ 的/ 采样/ 点/ 位置/ pk/ +/ 1i/ 可以/ 表示/ 为/ pk/ +/ 1i/ =/ pki/ +/ I/ -/ / Fi/ / / Fi/ 其中/ ,/ α/ i/ ∈/ (/ 0/ ,/ 1/ ]/ 是/ 采样/ 点/ 移动/ 速度/ 控制参数/ ,/ 用于/ 控制/ 粒子/ 在/ vi/ 方向/ 上/ 运动/ 的/ 长度/ ./ 然后/ 使用/ Newton/ -/ Rhapson/ 方法/ 将/ 调整/ 之后/ 的/ 采样/ 点/ 重新/ 投影/ 到/ 隐式/ 曲面/ 上/ :/ 通过/ 调整/ 控制参数/ α/ i/ 的/ 大小/ ,/ 对/ 隐式/ 曲面/ 上/ 的/ 每个/ 采样/ 点/ 沿着/ 能量/ 下降/ 的/ 方向/ 进行/ 调整/ ,/ 若/ 采样/ 点/ 调整/ 后/ 不/ 满足/ 能量/ 下降/ 条件/ ,/ 则/ 逐步/ 调整/ α/ i/ 的/ 值/ 降低/ 采样/ 点/ 移动/ 速度/ ,/ 该/ 调整/ 能够/ 控制/ 采样/ 点/ 的/ 移动/ 范围/ ,/ 使得/ 最终/ 采样/ 点/ 达到/ 稳定/ 的/ 状态/ ./ 本节/ 提出/ 的/ 采样/ 点/ 局部/ 调整/ 算法/ 如/ 算法/ 1/ ./ 算法/ 1/ ./ 采样/ 点/ 快速/ 局部/ 调整/ 算法/ ./ 给定/ 一组/ 采样/ 点集/ 队列/ :/ 1/ ./ 如果/ 当前/ 采样/ 点/ pi/ 达到/ 稳定/ ,/ 则/ 调整/ 采样/ 点/ 队列/ 中/ 2/ ./ 计算/ Ei/ ,/ Di/ ,/ Hi/ ,/ 并/ 根据/ 牛顿/ 法/ 求解/ 采样/ 点/ 移动/ 速/ 3/ ./ 根据/ vi/ 尝试/ 更新/ 采样/ 点/ ,/ 并/ 计算/ 采样/ 点/ 在/ 新/ 位置/ 处/ 的/ 下/ 一个/ 采样/ 点/ ,/ 否则/ 转步/ 2/ ;/ 度/ vi/ ;/ 的/ 能量/ Enew4/ ./ 如果/ Enewvi/ =/ vi/ ·/ α/ i/ (/ 0/ </ α/ </ 1/ )/ ,/ 转步/ 3/ ;/ 5/ ./ 如果/ Enew/ 一个/ 采样/ 点/ ./ 当/ 采样/ 点/ 试图/ 移动/ 到/ 一个/ 能量/ 较/ 高/ 的/ 位置/ 时/ ,/ 新/ 的/ 局部/ 调整/ 算法/ 不/ 需要/ 多次重复/ 执行/ L/ -/ M/ 算法/ 计算/ 采样/ 点/ 的/ 速度/ ,/ 新/ 方法/ 通过/ 调整/ 当前/ 速度/ 尝试/ 让/ 采样/ 点/ 在/ 一个/ 局部/ 范围/ 内/ 进行/ 调整/ ,/ 从而/ 可以/ 克服/ 能量/ 突然/ 上升/ 的/ 问题/ ,/ 计算/ 复杂度/ 更/ 低/ ./ 采样/ 点/ 局部/ 调整/ 算法/ 能够/ 快速/ 获得/ 分布/ 于/ 隐式/ 曲面/ 上/ 的/ 采样/ 点集/ ,/ 但是/ 采样/ 点/ 的/ 分布/ 质量/ 较差/ ./ 因此/ 我们/ 引入/ 了/ 准/ 牛顿/ 算法/ L/ -/ BFGS/ 方法/ 来/ 进一步/ 优化/ 采样/ 点/ 的/ 位置/ ./ 3.3/ 基于/ L/ -/ BFGS/ 的/ 采样/ 点/ 全局/ 优化/ 采用/ 算法/ 1/ 可以/ 快速/ 获得/ 分布/ 于/ 隐式/ 曲面/ 上/ 的/ 采样/ 点集/ ,/ 但是/ 由于/ 初始/ 采样/ 点/ 分布/ 质量/ 较差/ ,/ 这里/ 我们/ 采用/ 一种/ 全局/ 优化/ 的/ 方法/ L/ -/ BFGS/ 方法/ 对/ 采样/ 点集/ 进行/ 进一步/ 优化/ ./ L/ -/ BFGS/ 方法/ 是/ 一种/ 准/ 牛顿/ 方法/ [/ 19/ ]/ ,/ 用于/ 求解/ 无约束/ 的/ 非线性/ 优化/ 问题/ ,/ 该/ 方法/ 可以/ 通过/ 对前/ m/ 次/ 迭代/ 的/ 目标/ 函数/ 梯度/ 和/ 目标/ 函数/ 值/ 的/ 逼近/ 得到/ 第/ k/ 次/ 迭代/ Hessian/ 矩阵/ 的/ 近似/ 逆/ 矩阵/ [/ 19/ ]/ ,/ 本文/ 实验/ 中/ 采用/ m/ =/ 7/ ./ L/ -/ BFGS/ 变量/ 更新/ 公式/ 为/ 其中/ ,/ ^/ Hk/ 为/ 函数/ F/ 在/ 狓/ k/ 处/ Hessian/ 矩阵/ 的/ 逼近/ ,/ δ/ 为/ 控制参数/ 用于/ 调整/ 步长/ 大小/ ./ 当/ 采用/ 算法/ 1/ 获得/ 了/ 隐式/ 曲面/ 上/ 的/ 一个/ 初始/ 采样/ 后/ ,/ 该/ 采样/ 结果/ 可以/ 作为/ L/ -/ BFGS/ 算法/ 的/ 一个/ 比较/ 好/ 的/ 输入/ ./ 图/ 3/ 给出/ 了/ 一个/ 对/ 算法/ 1/ 获得/ 隐式/ 曲面/ 初始/ 采样/ 后/ 进一步/ 对/ 采样/ 点集/ 进行/ 优化/ 的/ 结果/ ,/ 其中/ 图/ 3/ (/ a/ )/ 为/ 采用/ 算法/ 1/ 图/ 3L/ -/ BFGS/ 优化/ 结果/ 比较/ (/ 其中/ 混合/ 优化/ 方法/ 运行/ 时间/ 为/ 0.841/ s/ ,/ Meyer/ 方法/ 运行/ 时间/ 为/ 2.273/ s/ )/ Page5/ 获得/ 的/ 初始/ 采样/ 点集/ (/ 740/ 个/ 采样/ 点/ )/ ,/ 图/ 3/ (/ b/ )/ 为/ 经过/ L/ -/ BFGS/ 优化/ 后/ 得到/ 的/ 采样/ 点集/ ,/ 迭代/ 次数/ 为/ 36/ 次/ ,/ 图/ 3/ (/ c/ )/ 为/ 采用/ Meyer/ 方法/ 得到/ 的/ 采样/ 点集/ (/ 670/ 个/ 采样/ 点/ )/ ./ 从图/ 中/ 可以/ 看出/ ,/ 经过/ L/ -/ BFGS/ 方法/ 全局/ 优化/ 的/ 采样/ 点集/ 分布/ 更加/ 均匀/ ,/ 从/ 时间/ 比较/ 上/ 看/ ,/ 本文/ 的/ 混合/ 优化/ 方法/ 速度/ 更快/ ./ 本文/ 提出/ 的/ 隐式/ 曲面/ 混合/ 优化/ 采样/ 算法/ 如/ 算法/ 2/ ./ 算法/ 2/ ./ 基于/ 混合/ 优化/ 的/ 隐式/ 曲面/ 采样/ 算法/ ./ 输入/ :/ 隐式/ 曲面/ F/ ./ 输出/ :/ 采样/ 点集/ S/ ./ 1/ ./ 在/ 空间/ 中/ 随机/ 给定/ 一定/ 数量/ 的/ 采样/ 点集/ ,/ 并/ 将/ 其/ 投影/ 到/ 隐式/ 曲面/ 上/ ;/ 2/ ./ 使用/ 算法/ 1/ 调整/ 每个/ 采样/ 点/ 的/ 位置/ ;/ 3/ ./ 对/ 每/ 一个/ 采样/ 点/ pi/ :/ I/ ./ 如果/ λ/ i/ >/ 0/ ,/ 转/ 队列/ 中/ 的/ 下/ 一个/ 采样/ 点/ ,/ 否则/ 转/ II/ ;/ II/ ./ 如果/ Ei/ </ 0.35/ ^/ E/ ,/ 那么/ 在/ 该/ 粒子/ 的/ 周围/ 插入/ 一个/ 新/ 的/ 采样/ 点/ ./ 4/ ./ 如果/ 步/ 2/ 和步/ 3/ 得到/ 的/ 采样/ 点/ 的/ 位置/ 变化/ 小于/ 一个/ 给定/ 的/ 阈值/ ,/ 则/ 认为/ 所有/ 的/ 采样/ 点集/ 进入/ 稳定/ 状态/ ,/ 将/ 得到/ 的/ 采样/ 点集/ 作为/ 输入/ ,/ 调用/ L/ -/ BFGS/ 算法/ 对/ 所有/ 采样/ 点/ 进行/ 进一步/ 优化/ 调整/ ,/ 反之/ 转步/ 2/ ./ 图/ 4Doll/ 、/ Bunny/ 、/ Dragon/ 模型/ 采样/ 结果/ 4/ 实验/ 结果/ 比较/ 本/ 节/ 给出/ 了/ 新/ 的/ 混合/ 优化/ 方法/ 与/ 文献/ [/ 14/ ]/ 中/ 提出/ 的/ 方法/ 比较/ 的/ 结果/ ./ 本文/ 中/ 所有/ 实验/ 结果/ 均/ 是/ 在/ Inter/ (/ R/ )/ Xeon/ (/ R/ )/ CPUE5504/ ,/ 主频/ 2.00/ GHz/ ,/ 8GB/ 内存/ 的/ 计算机/ 上/ 运行/ 得到/ ./ 图/ 4/ 给出/ 了/ 采用/ 新/ 的/ 混合/ 优化/ 方法/ 对/ 3/ 个/ 隐式/ 曲面模型/ :/ Doll/ ,/ Bunny/ 和/ Dragon/ 的/ 采样/ 结果/ ./ 其中/ ,/ Doll/ 模型/ 为/ Blobby/ 曲面/ [/ 20/ ]/ ,/ Bunny/ 和/ Dragon/ 模型/ 是/ 变分/ 曲面/ [/ 21/ ]/ ./ 分别/ 对/ 这/ 3/ 个/ 模型/ 进行/ 不同/ 密度/ 的/ 均匀/ 采样/ ,/ 并/ 给出/ 了/ 文献/ [/ 14/ ]/ 中/ Meyer/ 算法/ 和/ 本文/ 算法/ 的/ 算法/ 运行/ 时间/ 比较/ 结果/ ./ 从/ 采样/ 结果/ 可以/ 看出/ ,/ Meyer/ 算法/ 和/ 本文/ 算法/ 都/ 能够/ 使/ 粒子/ 均匀/ 的/ 分布/ 到/ 曲面/ 上/ ,/ 即/ 每个/ 采样/ 点/ 周围/ 都/ 有/ 6/ 个/ 或者/ 接近/ 6/ 个成/ 六边形/ 分布/ 的/ 邻接/ 采样/ 点/ ./ 图/ 5/ 给出/ 了/ 图/ 4/ 中/ 各/ 模型/ 的/ 算法/ 运行/ 时间/ 统计/ 结果/ ,/ 从/ 直方图/ 的/ 对比/ 中/ 可以/ 明显/ 看出/ 当/ 采样/ 点数/ 一致/ 时/ ,/ 本文/ 提出/ 的/ 基于/ 混合/ 优化/ 的/ 采样/ 算法/ 比/ Meyer/ 采样/ 方法/ 要/ 快/ 很多/ ,/ Meyer/ 方法/ 与/ 本文/ 算法/ 的/ 运行/ 时间/ 之/ 比/ 在/ 2/ ~/ 8.5/ 之间/ ./ Page6/ 为/ 使/ 粒子/ 能够/ 根据/ 曲面/ 的/ 局部/ 几何/ 特征/ 自/ 适应/ 分布/ ,/ Meyer/ 方法/ 提出/ 了/ 一种/ 基于/ 曲率/ 约束/ 的/ 采样/ 策略/ ,/ 即/ 为/ 每/ 一个/ 采样/ 点/ 引入/ 一个/ 互斥/ 影响/ 因子/ β/ i/ ,/ 并/ 将/ 此/ 影响/ 因子/ 代入/ 到/ 采样/ 点/ 能量/ 公式/ ,/ 梯度/ 公图/ 6/ 曲率/ 自/ 适应/ 采样/ 结果/ 对于/ 互斥/ 能量/ 式/ (/ 4/ )/ 来说/ ,/ 不同/ 的/ 互斥/ 半径/ σ/ 会/ 得到/ 不同/ 数目/ 的/ 采样/ 点/ 分布/ ./ 因此/ ,/ 我们/ 通过/ 给出/ 不同/ 的/ 互斥/ 半径/ σ/ 验证/ 算法/ 的/ 有效性/ ./ 由于/ 单位/ 球/ 表示/ 形式/ 简单/ ,/ 其/ 函数/ 值/ 和/ 各阶/ 导数/ 的/ 计算/ 方便/ 且/ 快速/ ,/ 所以/ 单位/ 球/ 的/ 均匀/ 采样/ 时间/ 将/ 由/ 算法/ 的/ 速度/ 直接/ 决定/ ./ 在/ 这里/ 以/ 一个/ 单位/ 球为例/ ,/ 通过/ 比较/ 采样/ 点/ 的/ 期望/ 半径/ 和/ 采样/ 时间/ 统计/ 曲线/ ,/ 来/ 比较/ 本文/ 算法/ 和/ Meyer/ 算法/ 的/ 速度/ ./ 如图/ 7/ 所示/ ,/ 虚线/ 和/ 实线/ 分别/ 表示/ Meyer/ 算法/ 和/ 本文/ 算法/ 的/ 算法/ 收敛/ 时间/ 和/ 期望/ 半径/ σ/ 之间/ 的/ 关系/ ./ 从图/ 中/ 可以/ 看出/ ,/ 在/ 算法/ 执行/ 开始/ 时/ ,/ σ/ 比较/ 大/ ,/ 因此/ 每个/ 采样/ 点/ 的/ 影响/ 范围/ 比较/ 大/ ,/ 隐式/ 曲面/ 上/ 分布/ 的/ 采样/ 点/ 数量/ 比较/ 少/ ,/ Meyer/ 算法/ 和/ 本文/ 算法/ 的/ 收敛/ 时间/ 大致/ 相似/ ./ 但/ 随着/ σ/ 的/ 不断/ 减小/ ,/ 采样/ 点/ 数量/ 不断/ 增加/ ,/ Meyer/ 算法/ 和/ 本文/ 算法/ 的/ 收敛/ 时间/ 之差/ 不断/ 加大/ ,/ 当/ σ/ =/ 0.05/ 时/ ,/ Meyer/ 算法/ 的/ 收敛/ 时间/ 大约/ 是/ 本文/ 方法/ 的/ 4/ 倍/ ./ 此/ 结果/ 说明/ 了/ 本文/ 方法/ 与/ Meyer/ 方法/ 相比/ ,/ 收敛/ 速度/ 更快/ ./ 如图/ 2/ (/ a/ )/ 所示/ ,/ 当/ 两个/ 采样/ 点/ 之间/ 的/ 距离/ 逐式/ 和/ Hessian/ 矩阵/ 的/ 计算/ 中/ ./ 其/ 影响/ 因子/ 可以/ 表示/ 为/ 文献/ [/ 14/ ]/ 中/ 指出/ ,/ 当/ υ/ =/ 0.75/ ,/ γ/ =/ 0.1/ ,/ d/ =/ 2/ ,/ k/ ∈/ [/ 0/ ,/ 20/ ]/ 时/ ,/ 采样/ 点/ 能够/ 较/ 好/ 的/ 依据/ 曲面/ 的/ 曲率/ 自/ 适应/ 分布/ ,/ 其中/ 曲率/ 的/ 计算/ 采用/ 文献/ [/ 22/ ]/ 中/ 的/ 方法/ ./ 我们/ 将/ 该/ 曲率/ 影响/ 因子/ 引入/ 到/ 新/ 方法/ 中/ ,/ 图/ 6/ 给出/ 了/ 新/ 方法/ 和/ Meyer/ 方法/ 分别/ 对/ Doll/ 模型/ 和/ Bunny/ 模型/ 进行/ 曲率/ 自/ 适应/ 采样/ 的/ 结果/ ,/ 其中/ 采样/ 点/ 的/ 大小/ 反应/ 了/ 该/ 点/ 出/ 曲率/ 的/ 大小/ ./ 从图/ 6/ 可以/ 看出/ ,/ 对于/ 曲率/ 自/ 适应/ 方法/ 的/ 采样/ ,/ 新/ 方法/ 能够/ 避免/ 多次/ 计算/ 能量/ 函数/ Hessian/ 矩阵/ ,/ 并且/ 采样/ 点/ 曲率/ 求解/ 次数/ 也/ 相应/ 减少/ ,/ 因此/ 相比/ Meyer/ 方法/ ,/ 采样/ 速度/ 得到/ 了/ 大大提高/ ./ 渐/ 接近/ 期望/ 距离/ (/ 0.57/ σ/ )/ 时/ ,/ 本文/ 能量/ 函数/ 的/ 下降/ 速度/ 明显/ 大于/ Meyer/ 能量/ 函数/ ./ 通过/ 比较/ 图/ 2/ (/ b/ )/ 、/ 图/ 2/ (/ c/ )/ 中/ 采样/ 点/ 速度/ 曲线/ 、/ 加速度/ 曲线/ 可知/ :/ 随着/ 采样/ 点/ 之间/ 的/ 距离/ 由近及远/ 逐渐/ 接近/ 期望/ 距离/ (/ 0.57/ σ/ )/ ,/ 本文/ 采样/ 点/ 速度/ 的/ 变化率/ 更大/ ,/ 即/ 本文/ 算法/ 能量/ 能够/ 快速/ 促使/ 采样/ 点/ 由/ 高速度/ 的/ 不/ 稳定/ 状态/ 收敛/ 到/ 低/ 速度/ 的/ 稳定/ 状态/ ./ Page7/ 图/ 8/ 分别/ 给出/ 了/ Bunny/ 模型/ 自/ 适应/ 采样/ 的/ 三角/ 化/ 结果/ [/ 7/ ]/ 、/ 总/ 能量/ 和/ 迭代/ 次数/ 、/ 总/ 能量/ 的/ 梯度/ 模长/ 和/ 迭代/ 步数/ 之间/ 的/ 关系/ ./ 根据/ 图/ 8/ (/ a/ )/ 中/ 三角形/ 大小/ 和/ 分布/ ,/ 可以/ 直观/ 的/ 看出/ ,/ Bunny/ 模型/ 的/ 自/ 适应/ 采样/ 依据/ 曲面/ 的/ 曲率/ 自/ 适应/ 分布/ ,/ 且/ 能够/ 表现/ 原始/ 曲面/ 图/ 8/ 三角/ 化/ 结果/ 及其/ 能量/ 梯度/ 下降/ 曲线/ 为/ 比较/ 新/ 算法/ 和/ Meyer/ 算法/ 采样/ 结果/ 的/ 质量/ ,/ 本文/ 使用/ 采样/ 点间/ 平均/ 平方/ 距离/ 来/ 衡量/ 采样/ 点/ 的/ 分布/ 质量/ ,/ 该/ 能量/ 函数/ 可以/ 表示/ 为/ 其中/ :/ n/ ,/ r/ 分别/ 是/ 采样/ 点数/ 和/ 采样/ 点/ 查询/ 半径/ ,/ 狓/ 为/ 采样/ 点/ 位置/ ./ 对于/ 一个/ 模型/ ,/ 在/ 采样/ 点数/ ,/ 采样/ 点/ 查询/ 半径/ 相同/ ,/ 并且/ 采样/ 点/ 完全/ 覆盖/ 原始/ 模型/ 的/ 情况/ 下/ ,/ 距离/ d/ 越小/ ,/ 说明/ 采样/ 点/ 分布/ 越/ 均匀/ ./ 在/ 采样/ 点数/ 相同/ 且/ 固定/ 的/ 情况/ 下/ ,/ 使用/ 本文/ 算法/ 和/ Meyer/ 方法/ 对图/ 4/ 中/ 模型/ 进行/ 均匀/ 重/ 采样/ ,/ 并/ 计算/ 各/ 模型/ 的/ 平均/ 距离/ d/ ./ 表/ 1/ 列出/ 了/ 各/ 模型/ 的/ 统计数据/ ,/ 可以/ 直观/ 地/ 看出/ ,/ 新/ 算法/ 采样/ 点间/ 平均/ 距离/ 和/ Meyer/ 算法/ 的/ 平均/ 距离/ 接近/ ,/ 说明/ 新/ 算法/ 的/ 采样/ 质量/ 和/ Meyer/ 算法/ 的/ 采样/ 质量/ 相近/ ./ 模型/ 采样/ 点/ 个数/ Doll12800/ ./ 227524000.22482900/ Bunny25040/ ./ 030126100.03114520/ Dragon19830/ ./ 005540130.00530264/ 从/ 以上/ 实验/ 结果/ 比较/ 来看/ ,/ 新/ 方法/ 能够/ 通过/ 快速/ 的/ 局部/ 调整/ 获得/ 隐式/ 曲面/ 上/ 的/ 初始/ 采样/ ,/ 全局/ 优化/ 方法/ 能够/ 进一步/ 将/ 所有/ 采样/ 点/ 的/ 位置/ 进行/ 调整/ ,/ 从而/ 获得/ 高质量/ 的/ 采样/ 分布/ ./ 与/ Meyer/ 方法/ 相比/ ,/ 的/ 细节/ 特征/ ./ 图/ 8/ (/ b/ )/ 、/ (/ c/ )/ 中/ 函数/ 曲线/ 直观/ 的/ 体现/ 了/ 随着/ 迭代/ 次数/ 的/ 增加/ ,/ 粒子系统/ 总/ 能量/ 及其/ 梯度/ 模长/ 都/ 在/ 不断/ 减少/ ./ 此外/ ,/ 当/ 迭代/ 次数/ 大于/ 等于/ 15/ 时/ ,/ 系统/ 趋于稳定/ ,/ 且/ 收敛/ 速度/ 快/ ./ 在/ 获得/ 同样/ 高质量/ 采样/ 结果/ 的/ 前提/ 下/ ,/ 新/ 方法/ 比/ Meyer/ 方法/ 要/ 快/ ./ 5/ 结论/ 隐式/ 曲面/ 动态/ 采样/ 是/ 几何/ 造型/ 中/ 的/ 热点/ 研究/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 混合/ 优化/ 的/ 快速/ 隐式/ 曲面/ 采样/ 方法/ ./ 新/ 的/ 能量/ 函数/ 具有/ 更快/ 的/ 梯度/ 下降/ ,/ 并且/ 通过/ 调整/ 其/ 速度/ 能够/ 快速/ 获得/ 分布/ 在/ 隐式/ 曲面/ 表面/ 的/ 初始/ 采样/ 点集/ ./ 然后/ 采用/ L/ -/ BFGS/ 方法/ 对/ 初始/ 采样/ 点集/ 进行/ 全局/ 优化/ ,/ 使得/ 采样/ 点/ 均匀分布/ 在/ 曲面/ 上/ ./ 混合/ 优化/ 方法/ 的/ 优势/ 在于/ 既/ 具有/ 局部优化/ 方法/ 的/ 优势/ ,/ 可以/ 快速/ 获得/ 初始/ 采样/ 点/ ,/ 又/ 具有/ 全局/ 优化/ 方法/ 的/ 优势/ ,/ 能够/ 得到/ 高质量/ 的/ 采样/ 点/ 集合/ ,/ 在/ 大大/ 提升/ 采样/ 速度/ 的/ 同时/ 不会/ 降低/ 采样/ 质量/ ./ 我们/ 下/ 一步/ 的/ 工作/ 是/ 根据/ 混合/ 优化/ 方法/ 获取/ 隐式/ 曲面/ 上/ 的/ 具有/ 蓝/ 噪声/ 特性/ 的/ 采样/ 点集/ ./ 

