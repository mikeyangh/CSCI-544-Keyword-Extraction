Page1/ 基于/ X/ ./ 509/ 证书/ 测量/ 的/ 隐私/ 泄露/ 分析/ 曹自刚/ 1/ )/ 熊刚/ 2/ )/ 赵咏/ 2/ )/ 1/ )/ (/ 北京邮电大学/ 计算机/ 学院/ 北京/ 100876/ )/ 2/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 摘要/ SSL/ 协议/ 由于/ 易于/ 部署/ 以及/ 集成/ 在/ Web/ 浏览器/ 中/ 的/ 天然/ 属性/ ,/ 被/ 广泛应用/ 于/ 保障/ 网页/ 浏览/ 、/ 电子邮件/ 、/ 文件传输/ 等/ 应用服务/ 的/ 信息/ 传输/ 安全/ ,/ 其中/ 最/ 典型/ 的/ 应用/ 是/ HTTPS/ ./ 然而/ ,/ 实践/ 中/ 往往/ 由于/ HTTPS/ 服务/ 的/ 部署/ 存在/ 问题/ ,/ 比如/ 服务器/ 采用/ 自/ 签名/ X/ ./ 509/ 证书/ 等/ ,/ 给/ 用户/ 带来/ 严重/ 的/ 安全/ 威胁/ ,/ 包括/ 信息/ 遭/ 窃取/ 、/ 用户/ 身份/ 和/ 行为/ 隐私/ 泄露/ 等/ ./ 本文/ 从/ 标识/ 服务器/ 身份/ 的/ X/ ./ 509/ 证书/ 出发/ ,/ 通过/ 对/ 真实/ 环境/ HTTPS/ 服务端/ 证书/ 的/ 大/ 范围/ 测量/ 和/ 分析/ 来/ 揭示/ 采用/ 自/ 签名/ 证书/ 的/ HTTPS/ 服务/ 存在/ 的/ 应用服务/ 类型/ 泄露/ 问题/ ,/ 以及/ 由此/ 引起/ 的/ 用户/ 网络/ 行为/ 隐私/ 泄露/ 威胁/ ./ 针对/ 大规模/ 真实/ 环境/ 中/ 用户/ 网络/ 行为/ 的/ 测量/ 分析/ 和/ 海量/ 日志/ 挖掘/ 结果表明/ ,/ X/ ./ 509/ 自/ 签名/ 证书/ 提供/ 了/ 较/ 强/ 区分/ 服务器/ 加密/ 应用/ 类型/ 的/ 身份/ 信息/ ,/ 加密/ HTTPS/ 应用服务器/ 的/ 身份/ 隐藏/ 手段/ 在/ 很大/ 程度/ 上/ 可以/ 通过/ 统计/ 行为/ 分析/ 来/ 识破/ ,/ 提供/ 相同/ 或/ 相似/ 的/ 特定/ 应用服务/ 的/ 服务器/ 的/ 被/ 正确/ 分类/ 的/ 准确率/ 最高/ 可达/ 95/ %/ ./ 关键词/ HTTPS/ ;/ X/ ./ 509/ 证书/ ;/ 自/ 签名/ ;/ 测量/ ;/ 用户/ 行为/ 隐私/ ;/ 隐私/ 保护/ 1/ 引言/ 近年来/ ,/ 网络媒体/ 、/ 电子商务/ 和/ 社交/ 网站/ 的/ 迅速/ 发展/ ,/ 给/ 广大/ 互联网/ 用户/ 带来/ 了/ 极大/ 便利/ ./ 与此同时/ ,/ 不法分子/ 利用/ 互联网/ 的/ 开放性/ ,/ 采用/ 木马/ 、/ 网络/ 钓鱼/ 和/ 网络攻击/ 等/ 手段/ 盗取/ 信息/ 或/ 进行/ 破坏/ ,/ 给/ 人们/ 带来/ 信息/ 隐私/ 泄露/ 和/ 财产损失/ ./ 为/ 保护/ 用户/ 隐私/ 和/ 数据安全/ ,/ 基于/ X/ ./ 509/ 证书/ 公钥/ 基础设施/ (/ PKI/ )/ 的/ SSL/ // TLS/ 协议/ 被/ 广泛/ 用于/ 网络/ 身份/ 认证/ 和/ 信息/ 加密传输/ ,/ 其中/ 典型/ 应用/ 有/ HTTPS/ 、/ POPS/ 、/ SMTPS/ 和/ FTPS/ 等/ ,/ 且/ HTTPS/ 应用/ 最为/ 广泛/ ./ 然而/ ,/ 公钥/ 机制/ 安全性/ 的/ 实现/ 依赖于/ 安全/ 实施/ ./ 目前/ 大量/ 加密/ 网络服务/ 采用/ 不/ 安全/ 的/ SSL/ 部署/ ,/ 给/ 攻击者/ 以/ 可乘之机/ ./ 更/ 重要/ 的/ 是/ ,/ 服务提供者/ 和/ 用户/ 甚至/ 对/ 自身/ 面临/ 的/ 信息/ 泄露/ 等/ 安全/ 风险/ 毫不/ 知情/ ,/ 也/ 不会/ 改善/ 安全措施/ ,/ 因此/ 隐私/ 威胁/ 长期/ 无法/ 消除/ ./ 另一方面/ ,/ 目前/ 已知/ 的/ 恶意软件/ 如/ 木马/ 、/ 僵尸/ 网络/ 和/ APT/ (/ AdvancedPersistentThreat/ )/ 等/ 已经/ 出现/ 采用/ 常见/ SSL/ // TLS/ 服务/ 端口/ (/ 如/ 443/ )/ 以及/ SSL/ // TLS/ 协议/ 来/ 躲避/ 安全/ 防护/ 设备/ 检查/ 的/ 情况/ ,/ 这些/ 也/ 给/ 个人隐私/ 安全/ 与/ 企业/ 和/ 政府/ 机构/ 的/ 信息/ 保密/ 带来/ 极大/ 挑战/ ./ 因此/ ,/ 深入研究/ HTTPS/ 服务/ 的/ 网络/ 行为/ 特点/ ,/ 挖掘/ 背后/ 的/ 动机/ 和/ 目的/ ,/ 对于/ 提升/ 对/ 恶意/ 隐蔽/ 信道/ 和/ 行为/ 的/ 检测/ 能力/ ,/ 加强/ 用户/ 隐私/ 保护/ 和/ 网络安全/ 管理/ 等/ 都/ 具有/ 重要/ 意义/ ./ 一般/ 意义/ 的/ 隐私/ 含义/ 很/ 广泛/ ,/ 而/ 这里/ 的/ 隐私/ 仅指/ 互联网/ 中/ 用户/ 行为/ 的/ 隐私/ ,/ 包括/ 两个/ 层次/ :/ 第/ 1/ 层/ 是/ 指/ 用户/ 的/ 通信/ 内容/ 隐私/ ,/ 主要/ 针对/ 非/ 加密/ 通信/ 流量/ ,/ 包括/ 电子邮件/ 内容/ 、/ 访问/ 网页内容/ 、/ 观看/ 视频/ 内容/ 等/ ;/ 第/ 2/ 层/ 是/ 指/ 用户/ 的/ 网络/ 行为/ 隐私/ ,/ 主要/ 针对/ 加密/ 流量/ ,/ 比如/ 用户/ 访问/ 了/ 哪些/ 网站/ ,/ 加密/ 信道/ 内部/ 的/ 承载/ 应用/ 类型/ (/ 如/ HTTP/ 、/ 远程/ 登录/ 、/ 文件传输/ 、/ 视频/ )/ ./ 网络/ 行为/ 的/ 外/ 在/ 表现形式/ 是/ 网络流量/ ,/ 因此/ ,/ 对/ 网络/ 行为/ 的/ 隐私/ 分析/ 可以/ 转化/ 为/ 对/ 网络流量/ 的/ 分析/ ./ 本文/ 研究/ 对象/ 是/ HTTPS/ 加密/ 服务/ 的/ 网络/ 行为/ 隐私/ 问题/ ./ 针对/ HTTPS/ 等/ 加密/ 服务/ 的/ 隐私/ 研究/ ,/ 可/ 分为/ 隐私/ 泄露/ 发现/ 和/ 隐私/ 保护/ 两个/ 方面/ ./ 就/ 隐私/ 保护/ 方法/ 而言/ ,/ 目前/ 有/ 两大/ 途径/ :/ 一个/ 是/ 匿名/ 系统/ ,/ 如/ Tor/ ①/ 和/ JAP/ ②/ ,/ 通过/ 流量/ 伪装/ 、/ 信息/ 隐藏/ 和/ 密码/ 技术/ 实现/ 身份/ 和/ 内容/ 隐藏/ ;/ 另/ 一个/ 是/ 加密/ 机制/ ,/ 如/ SSL/ // TLS/ 、/ SSH/ 、/ VPN/ ,/ 借助于/ 密码学/ 和/ 公钥/ 基础设施/ 来/ 确保/ 信息/ 的/ 机密性/ 、/ 完整性/ ,/ 并/ 进行/ 身份/ 认证/ ./ 其中/ ,/ SSL/ // TLS/ 与/ PKI/ 结合/ 紧密/ 、/ 部署/ 方便/ ,/ 往往/ 应用/ 于/ 加密/ Web/ 浏览/ 、/ 文件传输/ 和/ 加密/ 电子邮件/ 等/ 网络/ 基本/ 常用/ 服务/ ./ 就/ 隐私/ 泄露/ 发现/ 而言/ ,/ 有/ 针对/ 匿名/ 网络/ 和/ 针对/ SSL/ 等/ 安全/ 机制/ 在/ 协议/ 和/ 应用/ 层面/ 的/ 攻击/ 等/ ./ 本文/ 重点/ 分析/ SSL/ 服务/ 实际/ 部署/ 中/ 的/ 安全/ 弱点/ 给/ 用户/ 造成/ 的/ 隐私/ 泄露/ ./ 要/ 想/ 从/ 宏观/ 上/ 把握/ 现实/ 环境/ 中/ HTTPS/ 隐私/ 威胁/ 现状/ ,/ 就/ 必须/ 对/ HTTPS/ 的/ 部署/ 实施/ 情况/ 有/ 真实/ 全面/ 的/ 了解/ ,/ 而/ 测量/ 是/ 把握/ HTTPS/ 服务/ 现状/ 最/ 直接/ 和/ 最/ 有效/ 的/ 方法/ 之一/ ,/ 也/ 是/ 网络协议/ 、/ 服务/ 和/ 应用/ 研究/ 的/ 一般性/ 方法/ ./ 通过/ 测量/ 可以/ 了解/ SSL/ // TLS/ 服务/ 的/ 总体/ 情况/ 并/ 发现/ 其中/ 的/ 规律/ 和/ 实际/ 问题/ ,/ 为/ 进一步/ 的/ 隐私/ 分析/ 和/ 保护/ 策略/ 的/ 制定/ 提供数据/ 支持/ ./ 目前/ ,/ 对于/ SSL/ // TLS/ 的/ 整体/ 状况/ 的/ 测量/ 研究/ 在/ 国外/ 已经/ 有人/ 做/ 了/ 较为/ 完整/ 的/ 工作/ [/ 1/ -/ 3/ ]/ ./ 国内/ 尚未/ 见到/ 系统/ 深入/ 的/ 测量/ 研究/ ,/ 也/ 没有/ 基于/ 证书/ 的/ 公开性/ 研究成果/ ./ 本文/ 的/ 测量/ 部分/ 的/ 工作/ 填充/ 了/ 这/ 一/ 空白/ ,/ 且/ 与/ 国外/ 相关/ 工作/ 在/ 测量方法/ 和/ 研究/ 侧重/ 方面/ 有/ 较大/ 差异/ ./ 针对/ HTTPS/ 隐私/ 发现/ 的/ 研究/ 方法/ 很多/ ,/ 比如/ 理论/ 分析/ 、/ 协议/ 漏洞/ 发现/ 与/ 利用/ 、/ 统计/ 学习/ 等/ ./ 目前/ 的/ 主流/ 方法/ 是/ 统计/ 学习/ ,/ 涉及/ 的/ 主要/ 领域/ 是/ 流量/ 分析/ ./ 此类/ 方法/ 大都/ 从/ 流量/ 统计/ 属性/ 出发/ 采用/ 机器/ 学习/ 等/ 方法/ 对/ 加密/ 信道/ 内部/ 应用/ 进行/ 分类/ ,/ 或者/ 对/ 访问/ 的/ 网站/ 等/ 进行/ 判定/ [/ 4/ -/ 6/ ]/ ,/ 发现/ 的/ 隐私/ 属于/ 用户/ 网络/ 行为/ 隐私/ ./ 首先/ 根据/ 包/ 长度/ 、/ 包/ 时间/ 间隔/ 、/ 传输/ 的/ 字节数/ 等/ 信息/ 建立/ 网站/ 指纹/ 库/ ,/ 然后/ 对/ 实际/ 流量/ 的/ 相应/ 属性/ 进行/ 抽取/ 并/ 进行/ 比较/ ./ 此类/ 研究/ 给/ 我们/ 以/ 启示/ ,/ 即/ 虽然/ 加密/ 后/ 攻击者/ 无法/ 查看/ 传输/ 的/ 真实/ 内容/ ,/ 但/ 可以/ 从/ 协议/ 、/ 传输/ 内容/ 以及/ 服务器/ 的/ 自身/ 特性/ (/ 如/ 网站/ 首页/ 的/ 资源/ 个数/ )/ 等/ 统计/ 属性/ 中/ 找到/ 识别/ 特征/ ./ 然而/ ,/ 这/ 一类/ 基于/ 学习/ 的/ 方法/ 能够/ 成功/ 的/ 前提/ 是/ 被/ 研究/ 对象/ 在/ 包长/ 、/ 包间/ 时间/ 间隔/ 等/ 属性/ 方面/ 具有/ 可/ 区分/ 彼此/ 的/ 统计/ 特征/ ./ 在/ 小/ 数据/ 集上/ 这/ 一/ 假设/ 基本/ 成立/ ,/ 但/ 在/ 真实/ 场景/ 中/ ,/ 这些/ 统计/ 特征/ 区分度/ 随着/ 数据/ 集/ 的/ 增大/ 和/ 应用/ 的/ 复杂化/ 越来越/ 不/ 明显/ ,/ 不能/ 作为/ 区分/ 判断/ 的/ 有效/ 依据/ ./ 因此/ ,/ 实验/ 结果/ 往往/ 随着/ 数据/ 集/ 的/ 增大/ 变差/ ,/ 或者/ 在/ 实验/ 结果/ 和/ 真实/ 环境/ 结果/ 有/ 较大/ 差距/ ,/ 距离/ 实际/ 应用/ 尚有/ 一段距离/ ,/ 比如/ 文献/ [/ 7/ -/ 9/ ]/ ./ 为了/ 解决/ 上述/ 统计/ 方法/ 面临/ 的/ 难题/ ,/ 我们/ 尝试/ ①/ ②/ Page3/ 从/ SSL/ 服务器/ 的/ 自/ 签名/ X/ ./ 509/ 证书/ 的/ 属性/ 出发/ ,/ 从中/ 挖掘出/ 服务器/ 相关/ 的/ 信息/ 并/ 提取/ 特征/ ,/ 以此/ 对/ 用户/ 访问/ 此类/ 加密/ 服务/ 的/ 细粒度/ 应用/ 类别/ 进行/ 区分/ ,/ 从而/ 揭示/ 出/ HTTPS/ 服务/ 长期存在/ 的/ 用户/ 访问/ 应用/ 内容/ 类别/ 隐私/ 泄露/ 问题/ ./ 需要/ 说明/ 的/ 是/ ,/ 基于/ 证书/ 是/ 服务器/ 的/ 真实/ 身份/ 标识/ 的/ 考虑/ ,/ 合法/ 有效/ 的/ X/ ./ 509/ 证书/ 一般/ 包含/ 了/ 其/ 域名/ 、/ 公司/ 机构/ 等/ 信息/ ,/ 识别/ 其/ 应用/ 类型/ 比较/ 容易/ ,/ 且/ 安全性/ 较/ 高/ ,/ 不太/ 具有/ 隐私/ 研究/ 价值/ ./ 本文/ 的/ 主要/ 研究/ 对象/ 是/ 采用/ 自/ 签名/ 证书/ 的/ HTTPS/ 服务/ ,/ 此类/ 服务器/ 的/ 证书/ 不是/ 由/ 权威机构/ 颁发/ ,/ 而是/ 自己/ 随意/ 制作/ ,/ 缺乏/ 也/ 无法/ 进行/ 完整/ 身份/ 认证/ ./ 由于/ 完全/ 自主/ 颁发/ ,/ 证书/ 的/ 身份/ 标识/ 可以/ 随意/ 伪造/ 、/ 空缺/ 、/ 隐藏/ 或/ 模糊/ 处理/ ,/ 因此/ 此类/ 服务/ 处于/ 相当/ 混乱/ 的/ 状态/ ,/ 也/ 存在/ 极大/ 的/ 安全隐患/ ,/ 属于/ 最/ 不/ 安全/ 的/ 数字证书/ 应用/ 之一/ ./ 我们/ 的/ 目的/ 是/ 识别/ 这些/ 不可/ 信/ 证书/ 的/ 真实/ 身份/ ,/ 比如/ 应用服务/ 类别/ 等/ 刻意/ 隐藏/ 的/ 信息/ ,/ 从而/ 揭示/ 其/ 存在/ 的/ 用户/ 行为/ 隐私/ 泄露/ 问题/ ./ 本文/ 面向/ X/ ./ 509/ 证书/ 的/ 隐私/ 分析/ 有/ 两个/ 方面/ :/ 一是/ 根据/ 测量/ 统计/ 结果/ ,/ 对/ 采用/ 自/ 签名/ 证书/ 的/ HT/ -/ TPS/ 服务/ 的/ 隐私/ 威胁/ 进行/ 分析/ ;/ 二是/ 通过/ 对/ 此类/ X/ ./ 509/ 证书/ 的/ 挖掘/ 分析/ ,/ 揭示/ 出/ 在/ 大量/ 自/ 签名/ 证书/ 缺乏/ 完整/ 可信/ 身份/ 标识/ 的/ 情况/ 下/ ,/ 仍然/ 可以/ 在/ 很大/ 程度/ 上/ 对/ SSL/ 服务/ 类别/ 进行/ 区分/ ./ 2/ 相关/ 研究/ 工作/ 2.1/ 网络/ 测量/ 从/ 传统意义/ 上/ 讲/ ,/ 网络/ 测量/ 是/ 指/ 借助/ 特定/ 的/ 方法/ ,/ 利用/ 已有/ 或/ 构造/ 的/ 软硬件/ 设施/ ,/ 对/ 网络/ 性能参数/ 进行/ 测试/ 评估/ 的/ 活动/ [/ 10/ ]/ ./ 随着/ 新/ 技术/ 、/ 新/ 应用/ 的/ 不断涌现/ ,/ 现在/ 的/ 网络/ 测量/ 不仅/ 包括/ 对/ 网络/ 自身/ 性能/ 的/ 评估/ ,/ 而且/ 融入/ 了/ 对/ 特定/ 应用/ 或/ 服务/ 流量/ 及/ 行为/ 特征/ 的/ 提取/ 、/ 建模/ 和/ 预测/ 等/ ./ 网络/ 测量/ 的/ 要素/ 主要/ 包括/ 测量/ 对象/ 、/ 测量/ 内容/ 和/ 测量方法/ ./ 其中/ ,/ 测量/ 对象/ 表明/ 测量范围/ 是/ 网络/ 、/ 服务/ 或者/ 应用/ ;/ 测量/ 内容/ 是/ 指/ 测量/ 对象/ 的/ 被/ 测/ 属性/ 和/ 特征/ ;/ 测量方法/ 是/ 指/ 最终/ 实施/ 测量/ 的/ 具体操作/ 流程/ 、/ 规范/ 等/ ./ 根据/ 测量/ 方式/ 的/ 不同/ ,/ 网络/ 测量/ 可/ 划分/ 为/ 主动/ 方法/ 和/ 被动/ 方法/ [/ 11/ ]/ ./ 被动/ 测量/ 借助/ 已有/ 网络/ 环境/ 或/ 在/ 网络/ 节点/ 等/ 特定/ 位置/ 增加/ 网络设备/ ,/ 通过/ 被动/ 捕获/ 流经/ 的/ 网络/ 数据流/ 来/ 记录/ 网络/ 活动/ 等/ 信息/ ./ 主动/ 测量/ 则/ 是/ 通过/ 人工/ 或/ 自动/ 向/ 网络/ 中/ 发送/ 特定/ 探测/ 数据/ ,/ 然后/ 观察/ 响应/ 并/ 记录/ 相应/ 参数信息/ ./ 两者/ 各有/ 优缺点/ ,/ 在/ 实际/ 应用/ 中/ 往往/ 需要/ 根据/ 实际/ 情况/ 进行/ 取/ 主动/ 测量/ 具有/ 如下/ 优点/ :/ (/ 1/ )/ 简单/ 便利性/ ./ 对/ 测量/ 位置/ 无/ 特殊要求/ ,/ 无需/ 考虑/ 网络拓扑/ 环境/ 等/ ,/ 只/ 需/ 发送/ 少量/ 数据/ 并/ 记录/ 被测/ 对象/ 的/ 响应/ 信息/ ,/ 适合/ 端点/ 间/ 网络/ 性能/ (/ 如/ 连通性/ 、/ 延迟/ 等/ )/ 的/ 测量/ ./ (/ 2/ )/ 无/ 侵犯/ 用户/ 隐私/ 法律/ 风险/ ./ 只/ 关心/ 自身/ 相关/ 数据/ ,/ 不/ 查看/ 网络/ 中/ 其他/ 用户/ 的/ 信息/ ./ (/ 3/ )/ 可控性/ ./ 如果/ 需要/ 观察/ 协议/ 、/ 应用服务/ 在/ 特定/ 情况/ 下/ 的/ 反应/ ,/ 只/ 需/ 构造/ 相应/ 参数/ 的/ 数据/ 进行/ 测试/ 即可/ ,/ 无需/ 长时间/ 被动/ 等待/ ./ 其/ 主要/ 缺点/ 如下/ :/ (/ 1/ )/ 增加/ 了/ 网络/ 中/ 的/ 流量/ ,/ 可能/ 影响/ 被测/ 对象/ ,/ 导致/ 测量/ 偏差/ ,/ 甚至/ 严重/ 影响/ 网络/ 的/ 正常/ 运行/ ./ (/ 2/ )/ 大面积/ 、/ 集中式/ 主动/ 测量/ 容易/ 被/ 网络安全/ 设备/ 当作/ 网络/ 异常/ 或/ 攻击/ ,/ 导致/ 探测/ 或/ 响应/ 包被/ 拦截/ 、/ 丢弃/ ,/ 从而/ 使/ 测量/ 失败/ 或/ 结果/ 偏差/ 极大/ ./ 舍/ ,/ 或者/ 将/ 两者/ 结合/ 起来/ ./ 何/ 影响/ ,/ 结果/ 可靠性/ 高/ ./ 息/ ,/ 比如/ 流量/ 大小/ 、/ 访问/ 次数/ 等/ 统计/ 信息/ ./ 被动/ 测量/ 具有/ 如下/ 优点/ :/ (/ 1/ )/ 不/ 增加/ 网络/ 负载/ ,/ 对/ 网络/ 中/ 用户/ 基本/ 无/ 任/ (/ 2/ )/ 能够/ 获得/ 一些/ 主动/ 方法/ 无法/ 获取/ 的/ 详细/ 信/ 被动/ 测量/ 的/ 缺点/ 有/ :/ (/ 1/ )/ 隐私/ 问题/ ./ 被动/ 监测/ 往往/ 需要/ 从/ 流经/ 的/ 所有/ 数据/ 中/ 过滤/ 所/ 需/ 信息/ ,/ 存在/ 侵犯/ 用户/ 隐私/ 的/ 法律/ 风险/ ./ (/ 2/ )/ 局部性/ ./ 由于/ 被动/ 测量/ 设备/ 一般/ 是/ 在/ 固定/ 地点/ ,/ 因此/ 只能/ 获得/ 相连/ 网络/ 的/ 数据/ ,/ 无法/ 获知/ 网络/ 大/ 范围/ 的/ 整体/ 情况/ ,/ 且/ 测量/ 数据/ 中/ 不/ 一定/ 包含/ 所/ 需/ 的/ 数据/ 样本/ ./ (/ 3/ )/ 可操作性/ ./ 被动/ 测量/ 严重/ 依赖/ 网络/ 环境/ 和/ 设备/ ,/ 灵活性/ 不强/ ./ 对于/ 缺乏/ 相应/ 网络/ 环境/ 的/ 研究者/ 来说/ ,/ 几乎/ 无法/ 开展/ 此类/ 测量/ 工作/ ./ 2.2/ SSL/ // TLS/ 测量/ 2.2/ ./ 1SSL/ // TLS/ 与/ X/ ./ 509/ 证书/ SSL/ (/ SecureSocketLayer/ )/ ,/ 即/ 安全套/ 接层/ 协议/ ,/ 是/ Netscape/ 公司/ 提出/ 的/ 信息/ 加密传输/ 协议/ ,/ 其/ 目的/ 是/ 为/ 客户端/ 与/ 服务器之间/ 的/ 信息/ 传输/ 构建/ 一个/ 加密/ 通道/ ./ SSL/ 通过/ 身份/ 认证/ 、/ 使用/ 数字签名/ 确保/ 完整性/ 、/ 使用/ 加密/ 确保/ 机密性/ ,/ 实现/ 安全/ 通讯/ ./ 该/ 协议/ 由/ 两层/ 组成/ :/ SSL/ 记录/ 协议/ 和/ SSL/ 握手/ 协议/ ./ 1994/ 年/ 11/ 月/ 首次/ 公开/ 发行/ 了/ SSL/ 协议/ 2.0/ 版本/ (/ 之前/ 版本/ 未公开/ )/ ./ 由于/ 此/ 版本/ 被/ 证实/ 有/ 很多/ 缺陷/ ,/ Netscape/ 公司/ 于/ 1996/ 年/ 5/ 月/ 发布/ 了/ SSL3/ ./ 0/ 版本/ ./ Page4IETF/ 以/ SSL3/ ./ 0/ 为/ 基础/ ,/ 于/ 1999/ 年/ 发布/ 了/ TLS/ (/ TransportLayerSecurity/ )/ 即/ 传输层/ 安全/ 协议/ 的/ 1.0/ 版本/ ,/ 之后/ 进行/ 修订/ 和/ 扩充/ ,/ 先后/ 发布/ 了/ TLS1/ ./ 1/ 版/ (/ 2006/ 年/ )/ 和/ TLS1/ ./ 2/ 版/ (/ 2008/ 年/ )/ 的/ 协议/ 标准/ ./ 目前/ 在/ SSL/ 握手/ 过程/ 中/ 常见/ 的/ 版本号/ 与/ 具体/ 协议/ 版本/ 对应/ 关系/ 如表/ 1/ 所示/ ./ 握手/ 协议/ 版本号/ SSL/ // TLS/ 版本/ RFC/ 编号/ 0x030x000x030x010x030x020x030x03SSL/ // TLS/ 协议/ 之所以/ 能够/ 广泛应用/ ,/ 最/ 重要/ 的/ 一点/ 是/ 其/ 依赖/ 公钥/ 基础设施/ 的/ 安全性/ ./ 公钥/ 基础设施/ 的/ 核心/ 是/ 基于/ X/ ./ 509/ 证书/ 的/ 认证/ 链/ ./ 理论/ 情况/ 下/ ,/ 依靠/ 这种/ 完整/ 机制/ 可以/ 保证/ 信息/ 的/ 完整性/ 、/ 机密性/ 和/ 不可否认/ 性/ ./ X/ ./ 509/ 证书/ ,/ 也/ 称公钥/ 证书/ ,/ 是/ SSL/ // TLS/ 握手/ 协议/ 进行/ 身份/ 认证/ 依赖/ 的/ 通用/ 实体/ ./ 只有/ 身份/ 认证/ 成功/ 才/ 会/ 协商/ 密钥/ 并/ 进行/ 应用/ 数据/ 加密传输/ ./ X/ ./ 509/ 证书/ 标准/ 包含/ 在/ X/ ./ 509/ 标准/ 中/ ,/ 由/ ITU/ -/ T/ (/ 国际电信联盟/ )/ 制定/ ./ X/ ./ 509/ 证书/ 版本/ 主要/ 有/ V1/ 、/ V2/ 、/ V3/ ,/ 目前/ 的/ 主流/ 版本/ 是/ V3/ ./ 其实/ ,/ 证书/ 根据/ 用途/ 分为/ PKCS/ 格式/ 和/ X/ ./ 509/ 格式/ ,/ 其中/ SSL/ 身份/ 认证/ 使用/ 的/ 是/ X/ ./ 509/ 公钥/ 证书/ ./ 一般而言/ ,/ 证书/ 必须/ 包含/ 的/ 属性/ 有/ 版本/ (/ version/ )/ 、/ 序列号/ (/ serialNumber/ )/ 、/ 签名/ (/ signature/ )/ 、/ 颁发/ 者/ (/ issuer/ )/ 、/ 有效期/ (/ validity/ )/ 、/ 持有者/ (/ subject/ )/ 和/ 主体/ 公钥/ 信息/ ,/ 其中/ 颁发/ 者/ 和/ 持有者/ 可能/ 包含/ 一个/ 或/ 多个/ 子项/ ,/ 常见/ 的/ 子项/ 有/ 通用/ 名/ (/ CommonName/ )/ 、/ 机构/ 名/ (/ OrganizationName/ )/ 、/ 国家/ 名/ (/ CountryName/ )/ 等/ ./ V2/ 和/ V3/ 版本/ 支持/ 颁发/ 者/ 唯一/ 标识符/ 和/ 持有者/ 唯一/ 标识符/ ,/ V3/ 版本/ 还/ 支持/ 扩展/ 项/ ./ 2.2/ ./ 2/ 证书/ 认证/ 体系/ 与/ 自/ 签名/ 证书/ 证书/ 的/ 颁发/ 由/ 证书/ 认证/ 机构/ CA/ (/ certificateau/ -/ thority/ )/ 实施/ ./ 证书/ 认证/ 采用/ 的/ 是/ 信任/ 链/ 机制/ ./ 验证/ 的/ 时候/ ,/ 最终用户/ 的/ 身份/ 通过/ 末端/ 实体/ 证书/ 中/ 的/ 公钥来/ 标识/ ,/ 而/ 证书/ 的/ 真实性/ 由/ 其/ 颁发/ 机构/ (/ 即/ 另/ 一个/ CA/ )/ 来/ 证明/ ,/ 但/ 最终/ 证书/ 链/ 的/ 顶点/ 即根/ 证书/ 的/ 公钥/ 真实性/ 无法/ 用此/ 方法/ 证明/ ./ 公钥/ 基础设施/ 一般/ 依靠/ 其他/ 安全/ 信道/ 解决/ ,/ 比如/ 对根/ CA/ 的/ 公钥/ 通过/ 公共/ 途径/ 公布/ ./ 而/ 公告/ 根/ CA/ 时/ 考虑/ 到/ 兼容性/ 和/ 便利性/ ,/ 通常/ 仍/ 采用/ 证书/ 形式/ ./ 这种/ 形式/ 上/ 的/ 证书/ 作为/ 一种/ 特殊/ 证书/ ,/ 称之为/ 自/ 签名/ (/ Self/ -/ signed/ )/ 证书/ ./ 与/ 末端/ 实体/ 的/ 证书/ 不同/ ,/ 自/ 签名/ 证书/ 是/ 自己/ 给/ 自己/ 签发/ 的/ 证书/ ,/ 颁发/ 者/ 和/ 持有者/ 相同/ ,/ 无法/ 被/ 验证/ ,/ 因此/ 必须/ 通过/ 可信/ 途径/ 获得/ ,/ 以/ 防止/ 被/ 假冒/ ./ 目前/ ,/ Web/ 浏览器/ 一般/ 通过/ 内置/ 方式/ 添加/ 特定/ 的/ 根/ CA/ 自/ 签名/ 证书/ 作为/ 默认/ 的/ 可信/ 根/ ./ 虽然/ 大部分/ 大型/ 机构/ 如/ 银行/ 等/ 采用/ 浏览器/ 内置/ 的/ 国外/ 知名/ 根/ CA/ 颁发/ 的/ 证书/ ,/ 但/ 小型/ 机构/ 或/ 个人/ 往往/ 采用/ 自/ 签名/ CA/ 证书/ 作为/ 身份/ 认证/ 实体/ ./ 这些/ 证书/ 一旦/ 被/ 浏览器/ 验证/ ,/ 都/ 会/ 弹出/ 安全/ 警告/ ./ 自/ 签名/ 证书/ 很/ 容易/ 被/ 一些/ 非法/ 应用/ 及/ 钓鱼/ 网站/ 等/ 利用/ ./ 由于/ 没有/ 可信/ 第/ 3/ 方对/ 其/ 身份/ 进行/ 验证/ ,/ 伪造/ 自/ 签名/ 证书/ 十分/ 容易/ ,/ 攻击者/ 可以/ 随意/ 签发/ 一个/ 和/ 真实/ 网站/ 证书/ 几乎/ 一模一样/ 的/ 证书/ ,/ 用户/ 难以/ 辨别/ 其/ 真实性/ ,/ 浏览器/ 也/ 无法/ 确认/ 真假/ ./ 如果/ 用户/ 访问/ 部署/ 此类/ 证书/ 的/ 服务器/ ,/ 容易/ 遭受/ 中间人/ 攻击/ 导致/ 信息/ 泄露/ ./ 而/ 恶意软件/ 也/ 可/ 采用/ 此类/ 证书/ 部署/ 加密/ 服务/ ,/ 既/ 能/ 躲避/ 安全/ 审查/ ,/ 又/ 便于/ 隐藏/ 真实/ 身份/ ./ 因此/ ,/ 自/ 签名/ 证书/ 是/ 公钥/ 证书/ 中/ 最/ 不/ 安全/ 的/ 一类/ ./ 2.2/ ./ 3SSL/ 测量/ 国内外/ 现状/ Holz/ 等/ 人/ [/ 1/ ]/ 从/ X/ ./ 509/ 证书/ 的/ 角度/ 借助/ 主/ 被动/ 测量/ 的/ 方法/ 对/ SSL/ 的/ 整体/ 态势/ 进行/ 了/ 深入分析/ ./ 在/ 一年/ 半/ 时间/ 内/ 从/ 全球/ 9/ 个/ 不同/ 地理位置/ 对/ 大量/ 流行/ 的/ HTTPS/ 服务器进行/ 了/ 扫描/ ,/ 并/ 利用/ 10Gbps/ 链路/ 进行/ 被动/ 监测/ ./ 通过/ 对/ 主机/ 响应/ 和/ 证书/ 有效期/ 、/ 证书/ 链/ 、/ 扩展/ 验证/ 、/ 主机名/ 、/ 公钥/ 和/ 颁发/ 者/ 等/ 多个/ 属性/ 的/ 分析/ 揭示/ 了/ 当前/ PKI/ 实施/ 的/ 糟糕/ 状况/ :/ 即使/ 在/ 绝对/ 合法/ 的/ 证书/ 中/ ,/ 高强度/ 属性/ 的/ 证书/ 比例/ 也/ 很/ 低/ ./ 作者/ 也/ 提到/ 了/ X/ ./ 509/ 自/ 签名/ 证书/ ,/ 根据/ 他们/ 的/ 测量/ 结果/ ,/ 97.78/ %/ 的/ 通用/ 名/ 与/ 主机名/ 不符/ ,/ 前/ 3/ 名/ 通用/ 名为/ plesk/ 、/ localhost/ 和/ localhost/ ./ localdomain/ ,/ 但/ 没有/ 进一步/ 深入分析/ ./ Levillain/ 等/ 人/ [/ 2/ ]/ 对/ 互联网/ 上/ 的/ HTTPS/ 服务器/ 在/ 2010/ 年/ 7/ 月/ 到/ 2011/ 年/ 7/ 月间/ 进行/ 了/ 枚举/ 探测/ 来/ 评估/ HTTPS/ 服务器/ 的/ 质量/ ./ 首先/ 探测/ 出/ 整个/ IPv4/ 网段/ 中/ 全部/ 可/ 路由/ IP/ 中/ 开放/ HTTPS/ 服务/ 端口/ 的/ IP/ 列表/ ,/ 然后/ 根据/ 一系列/ DNS/ 对/ 这些/ IP/ 解析/ 出/ 的/ 域名/ 进行/ HTTPS/ 连接/ 并/ 收集/ 真实/ 流量/ ./ 他们/ 从/ 协议/ 版本/ 、/ 密码/ 套件/ 、/ TLS/ 扩展/ 、/ 服务器/ 响应/ 和/ 证书/ 链/ 等/ 方面/ 分析/ 了/ SSL/ 主机/ 的/ 安全/ 状况/ ,/ 并/ 重点/ 分析/ 了/ 两类/ TLS/ 主机/ :/ 信任/ 主机/ (/ trustedhosts/ )/ 和/ 扩展/ 验证/ 主机/ (/ ExtendedValidationhosts/ )/ ./ 与/ 上述/ 已有/ 测量/ 工作/ 相比/ ,/ 我们/ 的/ 测量/ 有/ 如下/ 差异/ :/ (/ 1/ )/ 侧重点/ 不同/ ./ 已有/ 测量/ 工作/ 侧重于/ 从/ 整体/ Page5/ 上/ 测量/ ,/ 测量范围/ 全面/ ,/ 其/ 目的/ 在于/ 揭示/ SSL/ 的/ 总体/ 特性/ ;/ 我们/ 的/ 测量/ 以/ 一类/ 不/ 安全/ 的/ SSL/ 服务/ 为/ 重点/ ,/ 目的/ 是从/ 服务器/ 的/ X/ ./ 509/ 证书/ 这/ 一新/ 的/ 角度/ 探索/ HTTPS/ 在/ 实际/ 应用/ 中/ 的/ 隐私/ 泄露/ 威胁/ ./ (/ 2/ )/ 测量方法/ 细节/ 有/ 差异/ ./ 已有/ 的/ 主/ 被动/ 测量方法/ 是/ 主/ 被动/ 分离/ ,/ 主动/ 方法/ 是/ 对/ 整个/ IPv4/ 可/ 路由/ 地址/ 段/ 进行/ 主机/ 端口扫描/ 和/ 连接/ 探测/ ,/ 被动/ 则/ 是/ 对/ 实验/ 网络/ 的/ 纯/ 被动/ 数据/ 监测/ ;/ 我们/ 的/ 方法/ 将主/ 被动/ 进行/ 有机/ 结合/ ,/ 根据/ 被动/ 监测/ 到/ 的/ NetFlow/ 信息/ 对/ 其中/ 的/ HTTPS/ 服务器/ IP地址/ 进行/ 主动/ 探测/ ,/ 不仅/ 大大减少/ 了/ 需要/ 探测/ 的/ IP地址/ 数/ ,/ 避免/ 了/ 大面积/ 长时间/ 扫描/ ,/ 而且/ 成功率高/ ./ (/ 3/ )/ 测量/ 环境/ 及/ 性能/ 不同/ ./ 我们/ 的/ 测量/ 以/ 中国/ 教育/ 和/ 科研/ 网/ 的/ 实际/ 访问/ 的/ IP/ 范围/ 为/ 基础/ ,/ 数据/ 真实/ 可靠/ ./ 已有/ 方法/ 则/ 主要/ 或/ 仅仅/ 采用/ 主动/ 探测/ 方法/ ,/ 虽然/ 能够/ 通过/ 分布式/ 主动/ 探测/ 获得/ 全球/ 范围/ 服务器/ 的/ 行为/ ,/ 但/ 无法/ 获得/ 服务器/ 被/ 访问/ 的/ 频度/ 等/ 信息/ ,/ 无法/ 反映/ 实际/ 情况/ ./ 从/ 性能/ 上/ 讲/ ,/ 本/ 方法/ 将/ 探测/ IP地址/ 范围/ 缩小/ 到/ 十万/ 级别/ ,/ 与/ 已有/ 主动/ 探测/ 方法/ 相比/ 效率/ 更高/ 、/ 耗时/ 更/ 短/ ./ 2.2/ ./ 4/ 本文/ 中/ 测量/ 的/ 目的/ 和/ 内容/ 从/ 研究/ 安全/ 浏览/ 隐私/ 风险/ 的/ 角度/ 出发/ ,/ 我们/ 主要/ 关注/ SSL/ // TLS/ 的/ 安全/ 属性/ 测量/ ,/ 而/ 不是/ 性能/ 等/ 其他/ 方面/ ./ 根据/ 我们/ 的/ 研究/ 发现/ ,/ 缺乏/ 有效/ 认证/ 的/ 自/ 签名/ 证书/ 的/ 大量/ 使用/ 是/ Web/ 浏览/ 过程/ 中/ 安全/ 和/ 隐私/ 风险/ 主要/ 来源/ 之一/ ./ 同时/ ,/ 一些/ 僵尸/ 网络/ 如/ Spy/ -/ eye/ 采用/ SSL/ 的/ 服务/ 端口/ 通信/ 来/ 躲避/ 安全检查/ ./ 关于/ APT/ 的/ 研究/ [/ 12/ -/ 13/ ]/ 也/ 发现/ 了/ 恶意软件/ 通过/ 443/ 端口/ 传输/ 加密/ 数据/ 躲避/ 审查/ ./ 卡巴斯基/ 于/ 2012/ 年/ 发布/ 的/ 报告/ 中/ 也/ 指出/ Duqu/ 和/ Flame/ 等/ APT/ 样本/ 通过/ SSL/ 加密/ 连接/ 与/ 命令/ 和/ 控制/ 服务器/ 通信/ ,/ 且/ 服务器/ 采用/ 自/ 签名/ 证书/ ①/ ./ 因此/ ,/ 测量/ 工作/ 对于/ 隐私/ 分析/ 来讲/ 不仅/ 为/ 后续/ 的/ 隐私/ 安全/ 风险/ 分析/ 提供/ 基础/ 数据/ ,/ 还/ 有助于/ 分离/ SSL/ 服务/ 端口/ 上/ 的/ 非/ SSL/ 服务/ ,/ 进而/ 使用/ 信息熵/ 、/ 异常/ 检测/ 等/ 方法/ 来/ 发现/ 可能/ 导致/ 隐私/ 信息/ 泄露/ 的/ 恶意/ 应用/ 或/ 隐蔽性/ 攻击/ ./ 由于/ 加密/ 的/ 原因/ ,/ 对于/ SSL/ 几乎/ 无法/ 从/ 内容/ 层面/ 进行/ 深入分析/ ,/ 除了/ 常见/ 的/ 连接/ 持续时间/ 、/ 包/ 长度/ 序列/ 和/ 传输/ 字节数/ 等/ 统计/ 属性/ 外/ ,/ 难以/ 找到/ 有效/ 刻画/ 其/ 行为/ 的/ 测量/ 属性/ ./ 经过/ 调研/ ,/ 我们/ 最终/ 选取/ 了/ X/ ./ 509/ 证书/ 作为/ 测量/ 和/ 研究/ 内容/ ,/ 其/ 原因/ 如下/ :/ (/ 1/ )/ X/ ./ 509/ 数字证书/ 作为/ 加密/ 服务器/ 的/ 身份/ 标识/ 和/ 安全/ 标识/ ,/ 很/ 可能/ 是/ 加密/ 应用服务/ 的/ 外/ 在/ 表现/ ,/ 其/ 测量/ 结果/ 很大/ 程度/ 上/ 反映/ 出/ SSL/ 状态/ 信息/ ./ (/ 2/ )/ 虽然/ SSL/ 应用/ 数据/ 是/ 加密传输/ 的/ ,/ 但是/ 服务器/ 采用/ 的/ 证书/ 可以/ 通过/ 主动/ 探测/ 的/ 方法/ 获得/ ,/ 为/ 测量/ 分析/ 提供/ 了/ 方便/ ./ (/ 3/ )/ 就/ 测量/ 的/ 最终/ 目的/ —/ —/ —/ 隐私/ 分析/ 来说/ ,/ 根据/ SSL/ 协商/ 过程/ ,/ 身份/ 认证/ 总是/ 在/ 连接/ 的/ 开始/ 阶段/ ,/ 因此/ 基于/ 证书/ 的/ 隐私/ 发现/ 可较/ 早/ 进行/ ./ 主流/ 的/ 统计/ 方法/ 往往/ 需要/ 对/ SSL/ 、/ SSH/ 握手/ 结束/ 后/ 一段时间/ 的/ 应用/ 数据/ 信息/ 甚至/ 整个/ 连接/ 持续/ 过程/ 进行/ 统计/ 属性/ 分析/ ,/ 明显/ 在/ 时间/ 上/ 延迟/ 较大/ ./ (/ 4/ )/ 采用/ 流/ 级别/ 的/ 统计/ 属性/ 不/ 存在/ 任何/ 隐私/ 法律/ 风险/ ,/ 但/ 结果/ 往往/ 面临/ 着/ 实验/ 环境/ 和/ 真实/ 环境/ 在/ 数据/ 集/ 大小/ 和/ 复杂性/ 等/ 方面/ 差异/ 带来/ 的/ 挑战/ ./ 而/ 证书/ 作为/ 公钥/ 机制/ 的/ 身份/ 标识/ ,/ 其/ 意图/ 就是/ 公开/ 可见/ ./ 本/ 方法/ 若/ 应用/ 于/ 被动/ 监测/ ,/ 除了/ 对/ 证书/ 进行/ 分析/ 外/ 不/ 检查/ 任何/ 其它/ 通信/ 内容/ ,/ 尽力/ 做到/ 最大/ 程度/ 保护/ 用户/ 隐私/ ./ (/ 5/ )/ 目前/ 已有/ 利用/ X/ ./ 509/ 进行/ 的/ SSL/ 测量/ 的/ 相关/ 工作/ [/ 1/ ]/ ,/ 说明/ 了/ 基于/ 测量/ 的/ 分析方法/ 的/ 可行性/ ,/ 且/ 我们/ 的/ 研究/ 侧重点/ 是/ 证书/ 中/ 的/ 自/ 签名/ 证书及/ 隐私/ 安全/ 问题/ ,/ 与/ 之前/ 工作/ 差异/ 较大/ ./ 2.3/ 加密/ Web/ 浏览/ 隐私/ Web/ 浏览/ 的/ 隐私/ 安全/ 风险/ 问题/ 一直/ 是/ 安全/ 界/ 研究/ 的/ 热点问题/ ./ 近年来/ 加密/ Web/ 浏览/ 的/ 规模/ 不断/ 增大/ ,/ 受到/ 研究者/ 广泛/ 关注/ ./ CNCERT/ 统计/ 结果/ ②/ 显示/ HTTPS/ 默认/ 服务/ 端口/ 443/ 上/ 的/ 流量/ 在/ TCP/ 端口/ 流量/ 中/ 排行/ 第/ 4/ 位/ ,/ 因此/ 对/ 加密/ Web/ 浏览/ 的/ 研究/ 很/ 有/ 意义/ ./ 目前/ 的/ 研究/ 分为/ 隐私/ 威胁/ 分析/ 和/ 威胁/ 对抗/ 两/ 方面/ ,/ 其中/ 前者/ 主要/ 手段/ 是/ 流量/ 分析/ (/ trafficanalysis/ )/ [/ 14/ ]/ 攻击/ ,/ 且/ 基本/ 是/ 基于/ 统计/ 方法/ ./ 早/ 在/ 2002/ 年/ ,/ 微软/ 的/ 研究/ 人员/ 就/ 采用/ 统计/ 方法/ 对/ 加密/ Web/ 浏览/ 的/ 流量/ 进行/ 识别/ [/ 15/ ]/ ,/ 将/ HTTP/ 请求/ 对象/ 的/ 个数/ 和/ 对象/ 的/ 长度/ 作为/ 统计/ 特征/ 并/ 针对/ 不同/ 网页/ 建立/ 指纹/ 库/ ,/ 通过/ 流量/ 模式匹配/ 判断/ 与/ 库/ 中/ 的/ 哪个/ 网页/ 访问/ 指纹/ 最/ 相似/ ./ 作者/ 还/ 介绍/ 了/ 该/ 统计/ 方法/ 的/ 对抗/ 措施/ ,/ 包括/ 填充/ (/ Padding/ )/ 、/ 模仿/ (/ Mimic/ -/ king/ )/ 和/ 变形/ (/ Morphing/ )/ ./ Bissias/ 等/ 人/ [/ 16/ ]/ 指出/ 加密/ HTTP/ 流/ 无法/ 抵抗/ 针对/ 流量/ 模式/ 的/ 流量/ 分析攻击/ ./ 通过/ 对/ 收集/ 的/ 100/ 个/ 最常/ 访问/ 站点/ Web/ 请求/ 的/ 包长/ 和/ 时间/ 间隔/ 的/ 分布/ ①/ ②/ Page6/ 这/ 两个/ 统计/ 特征/ 抽取/ 并/ 建模/ ,/ 对/ 加密/ WEP/ // WPA/ 、/ IPsec/ 和/ SSH/ 隧道/ 的/ 加密/ HTTP/ 访问/ 进行/ 站点/ 识别/ ./ 对/ 25/ 个/ 最具/ 标识/ 性/ 站点/ 的/ 最优/ 实验/ 结果显示/ ,/ 3/ 次/ 猜测/ 可以/ 获得/ 100/ %/ 的/ 准确率/ ./ Schatzmann/ 等/ 人/ [/ 17/ ]/ 利用/ 协议/ 和/ 时间/ 之间/ 的/ 关联/ 关系/ ,/ 采用/ NetFlow/ 层面/ 的/ 统计/ 特征/ 对/ HTTPS/ 中/ 的/ 加密/ Webmail/ 流量/ 进行/ 分类/ ./ 3/ 个/ 特征/ 为/ Web/ -/ mail/ 与/ 传统/ POP/ 、/ IMAP/ 的/ 继承/ 相似性/ ,/ 回话/ 持续时间/ 和/ 每天/ 、/ 每周/ 流量/ 轮廓/ 以及/ AJAX/ 客户端/ 检查/ 新/ 消息/ 的/ 周期性/ ./ Dyer/ 等/ 人/ [/ 9/ ]/ 对/ HTTP/ 通过/ SSL/ 等/ 多种/ 加密/ 隧道/ 场景/ 下/ 的/ 通用/ 流量/ 分析/ 对抗/ 措施/ 进行/ 了/ 全面/ 分析/ ,/ 结果表明/ 9/ 种/ 已知/ 的/ 对抗/ 措施/ 无法/ 应对/ 利用/ 流量/ 粗/ 特征/ (/ time/ ,/ bandwidth/ ,/ burstbandwidth/ )/ 的/ 简单/ 攻击/ ./ Herrmann/ 等/ 人/ [/ 18/ ]/ 提出/ 一种/ 新/ 方法/ 将/ 常见/ 的/ 文本/ 挖掘/ 技术/ 应用/ 到/ 可/ 观察/ 的/ IP/ 分组/ 大小/ 归一化/ 频率/ 分布/ ,/ 采用/ 多项式/ 朴素/ 贝叶斯/ 分类器/ 对/ 775/ 个/ 样本/ 站点/ 的/ 分类/ 准确率/ 达到/ 97/ %/ ./ Cai/ 等/ 人/ [/ 19/ ]/ 提出/ 了/ 针对/ 几种/ 常见/ 流量/ 分析/ 防护/ 措施/ 的/ 网页/ 指纹/ 攻击/ 方法/ ,/ 防护/ 包括/ SSH/ 、/ HTT/ -/ POS/ [/ 20/ ]/ 、/ Tor/ 、/ 基于/ 样本/ 的/ 伪装/ 以及/ 他们/ 的/ 组合/ ./ 该/ 方法/ 采用/ Damerau/ -/ Levenshtein/ 距离/ 来/ 计算/ 网页/ 访问/ 流量/ 之间/ 的/ 相似性/ ,/ 并/ 通过/ 隐/ 马尔科夫/ 模型/ 将/ 网页/ 分类器/ 扩展/ 为/ 网站/ 分类器/ ./ 实验/ 结果显示/ ,/ 当前/ 的/ 防护/ 措施/ 不够/ 充分/ ,/ 指纹/ 攻击/ 十分/ 有效/ ./ 上述/ HTTPS/ 隐私/ 威胁/ 发现/ 研究/ 都/ 是/ 针对/ Web/ 客户端/ 对/ 特定/ 范围/ 内/ 服务器/ 访问/ 的/ 流量/ 统计/ 特征/ 进行/ 抽取/ ,/ 建立/ 指纹/ 库/ ,/ 然后/ 进行/ 匹配/ ./ 其/ 缺点/ 是/ 对/ 大规模/ 网站/ 集合/ 的/ 分类/ 效果/ 会/ 明显/ 变差/ ,/ 对于/ 非/ 已知/ 集合/ 内/ 的/ 网站/ 的/ 访问/ 很/ 可能/ 被误/ 识别/ ./ 另外/ ,/ HTTPS/ 流量/ 中/ 的/ 加密/ Web/ 服务/ 种类/ 很多/ ,/ 而/ 上述/ 研究/ 一般/ 仅仅/ 是/ 对/ 少量/ Web/ 浏览/ 访问/ 站点/ 的/ 区分/ ,/ 缺少/ 对/ SSL/ 加密/ 服务/ 整体/ 的/ 隐私/ 安全/ 研究/ ./ 我们/ 的/ 工作/ 则/ 是/ 在/ 测量/ 基础/ 上/ 从/ 服务器/ 的/ 角度/ 研究/ SSL/ 总体/ 的/ 泄露/ 用户/ 行为/ 的/ 隐私/ 安全/ 风险/ ,/ 侧重于/ 揭露/ 加密/ Web/ 服务/ 总体/ 的/ 粗粒度/ 隐私/ 威胁/ ./ 与/ 上述/ 研究/ 相比/ ,/ 出发点/ 不同/ ,/ 研究/ 面/ 也/ 更为/ 宽泛/ ,/ 更/ 具有/ 大规模/ 实际/ 应用/ 前景/ ./ 3/ 基于/ SSL/ 证书/ 测量/ 的/ 隐私/ 分析/ 3.1/ 主/ 被动/ 测量方法/ 及/ 过程/ 我们/ 采用/ 主/ 被动/ 结合/ 的/ 高效率/ 方法/ 进行/ SSL/ 测量/ ./ 实际/ 测量/ 时/ ,/ 为了/ 避免/ 大规模/ 扫描/ 对/ 网络/ 影响/ 和/ 节约资源/ ,/ 同时/ 尽量/ 不/ 侵犯/ 用户/ 隐私/ ,/ 我们/ 从/ 主干/ 网络/ 网关/ NetFlow/ 连接/ 信息/ 中/ 提取/ 443/ 端口号/ 的/ IP地址/ 列表/ 作为/ HTTPS/ 服务器/ 列表/ ./ 通过/ 真实/ NetFlow/ 提取/ 服务器/ IP/ 的/ 好处/ 是/ 大大/ 缩小/ 探测/ IP/ 范围/ 并/ 具有/ 很/ 高/ 的/ 访问/ 成功率/ ./ 获取/ 到/ IP地址/ 范围/ 后/ ,/ 通过/ 分布/ 在/ 多台/ 客户端/ 主机/ 上/ 的/ Python/ 脚本/ 程序/ 并行/ 访问/ 服务器/ 列表/ 中/ 的/ IP/ ./ 如果/ 连接/ IP/ 的/ 443/ 端口/ 失败/ ,/ 则/ 尝试/ 通过/ 域名解析/ 系统/ 获取/ 该/ IP地址/ 的/ 域名/ ,/ 一旦/ 获取/ 成功/ 则/ 模拟/ 浏览器/ 访问/ 该/ 域名/ ./ 整个/ 探测/ 过程/ 中/ 对/ 客户端/ 主机/ 的/ 443/ 端口/ 流量/ 进行/ 捕获/ 并/ 提取/ 服务器/ SSL/ // TLS/ 版本/ 和/ 证书/ 信息/ ./ 主/ 被动/ 测量/ 系统/ 的/ 流程/ 如图/ 1/ 所示/ ./ 需要/ 说明/ 的/ 是/ ,/ 图中/ 省略/ 了/ 与/ 主动/ 测量/ 并行/ 的/ 流量/ 记录/ 和/ 分析/ 步骤/ ,/ 具体/ 包括/ 探测/ 机/ 网卡/ 数据包/ 捕获/ 、/ 数据包/ 解析/ 、/ 服务器/ X/ ./ 509/ 证书/ 信息提取/ 等/ ./ 将/ 主动/ 测量/ 获取/ 的/ 证书/ 信息/ 与/ 从/ 网关/ 得到/ 的/ NetFlow/ 信息/ 根据/ 服务器/ 的/ IP地址/ 进行/ 对照/ ,/ 就/ 可以/ 获得/ 完整/ 的/ 测量/ 结果/ 数据/ 集/ ./ 3.2/ 测量/ 结果/ 3.2/ ./ 1SSL/ 基本/ 情况/ 根据/ 我们/ 从/ 教育/ 和/ 科研/ 网/ 主干/ 路由器/ 24h/ 采集/ 的/ NetFlow/ 信息/ 和/ 我们/ 主动/ 测量/ 的/ 结果/ ,/ 经过/ 数量/ 统计/ ,/ IP地址/ 和/ 证书/ 信息/ 去/ 重/ ,/ IP/ 地理位置/ 查询/ 等/ 分析/ 处理/ ,/ 有/ 如下/ 发现/ :/ (/ 1/ )/ 被测/ 网络/ 范围/ 内/ 客户端/ 访问/ 国外/ 443/ 端口/ 的/ 服务器/ IP/ 次数/ 为/ 8229/ 万次/ // d/ ,/ 服务器/ IP/ 数为/ Page734/ ./ 2/ 万/ // d/ ,/ 客户端/ IP/ 数为/ 89.0/ 万/ // d/ ./ 其中/ ,/ SSL/ 成功/ 访问/ 次数/ 为/ 7956/ 万/ // d/ ,/ 服务器/ IP/ 数为/ 27.1/ 万/ // d/ ,/ 客户端/ IP/ 数为/ 88.9/ 万/ // d/ ;/ 探测/ 失败/ 访问/ 次数/ 为/ 273/ 万/ // d/ ,/ 服务器/ IP/ 数为/ 7.1/ 万/ // d/ ,/ 客户端/ IP/ 数为/ 1.3/ 万/ // d/ ./ 即/ 确认/ 的/ SSL/ 访问/ 次数/ 占/ 96.7/ %/ ,/ 其余/ 占/ 3.3/ %/ ./ 探测/ 失败/ 的/ 服务器/ 提供/ 何种/ 服务/ 值得/ 进一步/ 探索/ ./ (/ 2/ )/ 所有/ SSL/ 访问/ 中/ ,/ 服务器/ SSL/ 握手/ 采用/ 的/ 协议/ 版本/ 分布/ 为/ TLS1/ ./ 0/ 占/ 86.27/ %/ 、/ TLS1/ ./ 1/ 占/ 9.50/ %/ 、/ TLS1/ ./ 2/ 占/ 2.36/ %/ 、/ SSL3/ ./ 0/ 占/ 1.87/ %/ ./ 从/ 安全/ 角度/ 考虑/ ,/ SSL3/ ./ 0/ 目前/ 应该/ 被/ 淘汰/ ,/ 而/ TLS1/ ./ 0/ 也/ 有/ 一些/ 安全/ 问题/ [/ 2/ ]/ ,/ 因此/ TLS/ 实际/ 部署/ 存在/ 明显/ 滞后性/ ,/ 存在/ 数据/ 隐私/ 泄露/ 的/ 安全隐患/ ./ (/ 3/ )/ 所有/ 访问/ 中/ ,/ 不同/ 版本/ 证书/ 比例/ 如表/ 2/ 所示/ ./ 由/ 结果/ 可知/ ,/ 服务器/ 实际/ 部署/ 的/ 证书/ 中/ ,/ 绝大部分/ 是/ V3/ 版本/ 的/ ,/ 其次/ 较/ 多/ 的/ 是/ V1/ 版本/ 的/ ./ 值得一提的是/ ,/ V1/ 版本/ 证书/ 中/ ,/ 自/ 签名/ 证书/ 比例/ 为/ 81.8/ %/ ;/ V3/ 版本/ 证书/ 中/ ,/ 自/ 签名/ 证书/ 比例/ 为/ 0.42/ %/ ./ 可见/ V3/ 版本/ 证书/ 是/ 目前/ 的/ 主流/ ,/ 而/ V1/ 版本/ 证书/ 具有/ 较/ 高/ 的/ 自/ 签名/ 比例/ ,/ 存在/ 隐私/ 安全/ 风险/ ./ 证书/ 版本/ (/ 4/ )/ 借助于/ MaxMind/ 公司/ 的/ GeoIP/ 数据库/ ①/ 和/ API/ 接口/ ,/ 我们/ 编写程序/ 对/ 27.1/ 万/ 服务器/ IP/ 地理位置/ 情况/ 进行/ 了/ 统计/ ,/ 结果/ 如表/ 3/ 所示/ ./ 排名/ 地理位置/ // 国家/ 12345/ 这里/ 的/ 结果/ 是/ 针对/ 去/ 重后/ 的/ IP/ 统计/ 得出/ 的/ ,/ 美国/ IP/ 比例/ 过半/ ./ 如果/ 按/ 访问/ 次数/ 计算/ ,/ 美国/ IP/ 的/ 比例/ 将/ 更/ 大/ ./ (/ 5/ )/ 最/ 活跃/ 的/ 服务器/ IP/ 段/ 信息/ :/ 在/ 访问/ 最多/ 的/ 服务器/ IP/ 中/ ,/ 按照/ B/ 段/ 进行/ 合并/ 得到/ ,/ 前/ 10/ 名/ 依次/ 为/ :/ 74.125/ ./ 0.0/ // 16/ 、/ 207.46/ ./ 0.0/ // 16/ 、/ 157.56/ ./ 0.0/ // 16/ 、/ 65.55/ ./ 0.0/ // 16/ 、/ 173.194/ ./ 0.0/ // 16/ 、/ 65.54/ ./ 0.0/ // 16/ 、/ 64.4/ ./ 0.0/ // 16/ 、/ 17.172/ ./ 0.0/ // 16/ 、/ 17.151/ ./ 0.0/ // 16/ 和/ 17.158/ ./ 0.0/ // 16/ ./ 通过/ WHOIS/ 信/ AOL/ 息/ 查询/ 得知/ ,/ 这些/ 网段/ 分别/ 属于/ Google/ 、/ Microsoft/ 和/ Apple/ 公司/ ./ 而/ 根据/ 访问/ 次数/ 前/ 20/ 名/ 服务器/ IP/ 段/ 的/ 汇总/ 归属/ 信息/ ,/ 可/ 得到/ 如表/ 4/ 所示/ 结果/ ./ 表/ 4/ 访问/ 次数/ 前/ 20/ 名/ 服务器/ IP/ 段/ 信息/ 统计/ 公司/ 名称/ 访问/ 次数/ 占/ 总/ 访问/ 次数/ 比例/ 累计/ 百分比/ // %/ Microsoft/ (/ 微软/ )/ Google/ (/ 谷歌/ )/ Apple/ (/ 苹果/ )/ DROPBOXAKAMAI/ 由此可见/ ,/ 中国/ 教育/ 和/ 科研/ 网/ 访问/ 的/ 国外/ HT/ -/ TPS/ 服务/ 中/ ,/ 最多/ 的/ 是/ 微软/ 、/ 谷歌/ 和/ 苹果/ ./ 推测/ 原因/ 是/ 这些/ 公司/ 的/ 多个/ SSL/ 服务/ 具有/ 大量/ 用户/ ,/ 比如/ 微软/ 操作系统/ 的/ 自动/ 升级/ 服务/ 、/ Hotmail/ 和/ Live/ 等/ ,/ 谷歌/ 的/ 加密/ Web/ 搜索/ 、/ Gmail/ 、/ Docs/ 、/ 开发/ 和/ 社交/ 应用/ 等/ ,/ 苹果公司/ 的/ 官方/ 应用/ 商店/ 和/ 消息/ 推送/ 等/ ./ 值得注意/ 的/ 是/ ,/ 前/ 3/ 个/ 公司/ IP/ 段/ 的/ SSL/ 访问量/ 占据/ 了/ 整个/ SSL/ 访问量/ 的/ 近/ 80/ %/ ,/ 而/ 排名/ 前/ 20/ 的/ IP/ 段仅/ 来自/ 6/ 个/ 公司/ ,/ 由此/ 可以/ 看出/ 访问/ 的/ 局部性/ ,/ 也/ 印证/ 了/ 美国/ 在/ 互联网/ 中/ 的/ 核心/ 地位/ ./ 3.2/ ./ 2/ 自/ 签名/ 证书/ 测量/ 结果/ 由于/ 自/ 签名/ 证书/ 是/ 我们/ 的/ 主要/ 研究/ 对象/ ,/ 因此/ 我们/ 进一步/ 扩展/ 了/ NetFlow/ 信息/ 采集/ 范围/ ,/ 并/ 根据/ 端口号/ 443/ 提取/ SSL/ 服务器/ IP/ 列表/ ,/ 通过/ 主动/ 探测/ 筛选/ 出/ 此类/ 证书/ 的/ 结果/ ./ 2013/ 年/ 1/ 月/ 30/ 日/ ~/ 2013/ 年/ 2/ 月/ 28/ 日共/ 30/ 天/ 的/ 自/ 签名/ 证书/ 的/ 统计/ 结果/ 如下/ 图/ 2/ ~/ 图/ 4/ 所示/ ./ 由图/ 2/ 可见/ ,/ 虽然/ 存在/ 较大/ 波动/ ,/ 平均/ 每天/ 的/ ①/ MaxMind/ -/ GeoIP/ |/ IP地址/ 位置/ 数据库/ [/ EB/ // OL/ ]/ ,/ http/ :/ // // Page8V1/ 自/ 签名/ 证书/ 服务器/ 访问/ 次数/ 接近/ 800/ 万次/ ,/ V3/ 自/ 签名/ 证书/ 服务器/ 访问/ 次数/ 从/ 600/ 多万/ 到/ 1000/ 多万/ 次/ ./ 总体/ 来讲/ ,/ 两者/ 差别/ 不大/ ./ 由图/ 3/ 中/ V1/ 、/ V3/ 自/ 签名/ 证书/ 服务器/ 的/ 数量/ 可以/ 看出/ ,/ V3/ 数量/ 明显/ 多于/ V1/ ,/ 前者/ 最大值/ 是/ 后者/ 的/ 4/ 倍/ 左右/ ./ 但/ V1/ 版本/ 证书/ 中自/ 签名/ 证书/ 比例/ 很/ 高/ ,/ 平均/ 约/ 65/ %/ ./ 由图/ 4/ 可见/ ,/ 国内/ HTTPS/ 客户端/ 数量/ 相对/ 稳定/ ,/ 访问/ V1/ 和/ V3/ 自/ 签名/ 证书/ 服务器/ 的/ 日/ 平均/ 客户端/ 数/ 分别/ 为/ 42/ 万/ 和/ 25/ 万/ ./ 经过/ 对/ 证书/ 常见/ 属性/ 的/ 统计/ ,/ 得到/ 如下/ 结果/ :/ (/ 1/ )/ 通用/ 名/ CN/ (/ CommonName/ )/ 证书/ 的/ 通用/ 名/ 作为/ 网站/ 身份/ 的/ 标识/ ,/ 一般/ 应该/ 与/ 服务器/ 域名/ 相符合/ ./ 由表/ 5/ 可以/ 看出/ ,/ 通用/ 名为/ 空缺/ 、/ localhost/ 和/ localhost/ ./ localdomain/ 这种/ 隐匿/ 真实/ 身份/ 信息/ 的/ 通用/ 名/ 在/ 自/ 签名/ 证书/ 中/ 大量/ 存在/ ./ (/ 2/ )/ 证书/ 有效期/ 对于/ 大型/ 公司/ 的/ 证书/ ,/ 有效期/ 一般/ 不/ 超过/ 两年/ ,/ 有效期/ 过长/ 将/ 给/ 攻击者/ 充足/ 时间/ 来/ 进行/ 密钥/ 破解/ ./ 然而/ ,/ 自/ 签名/ 证书/ 的/ 有效期/ 一般/ 较长/ ,/ 在/ 我们/ 的/ 测量/ 结果/ 中/ ,/ 证书/ 有效期/ 最长/ 有/ 7993/ 年/ ./ 按照/ PKI/ 诞生/ 时间/ 及/ RFC/ 规定/ ,/ 证书/ 有效期/ 开始/ 年份/ 值/ 不/ 早于/ 1950/ 年/ ,/ 但/ 我们/ 发现/ 有/ 少量/ 证书/ 有效期/ 起始/ 年份/ 值/ 很小/ ,/ 最早/ 为/ 1692/ 年/ ./ 同时/ ,/ 过期/ 失效/ 证书/ 大量/ 存在/ ,/ 所有/ 访问/ 中有/ 约/ 29/ %/ 使用/ 了/ 过期/ 证书/ ./ 自/ 签名/ 证书/ 有效期/ 年数/ 统计/ 结果/ (/ 取整/ )/ 如表/ 6/ 所示/ ./ 以上/ 有效期/ 的/ 证书/ ,/ 存在/ 隐私/ 安全隐患/ ./ 排名/ 有效期/ 年数/ 出现/ 次数/ 百分比/ // %/ 12345/ 累计/ 超过/ 50/ %/ 的/ 访问/ 中/ 服务器/ 使用/ 了/ 5/ 年/ 及/ (/ 3/ )/ 公钥/ 信息/ 主题/ 公钥/ 长度/ 是/ 防止/ 密码/ 破解/ 攻击/ 安全性/ 的/ 保证/ ./ 2009/ 年/ 12/ 月/ ,/ 编号/ 为/ RSA/ -/ 768/ (/ 768/ 位/ )/ 的/ 大数/ 也/ 被/ 成功/ 分解/ ,/ 威胁/ 到/ 1024/ 位/ 密钥/ 的/ 安全性/ ./ 目前/ 推荐/ 使用/ 2048/ 位/ 的/ 公钥/ 密钥/ ./ 表/ 7/ 是/ 自/ 签名/ 证书/ 公钥/ 算法/ 前/ 5/ 名/ ,/ 结合/ 上面/ 表/ 6/ 证书/ 有效期/ 结果/ 可知/ ,/ 有/ 相当/ 数量/ 的/ 服务器/ 使用/ 有效期/ 长/ 但/ 密钥/ 安全性/ 不足/ 的/ 证书/ ,/ 存在/ 严重/ 密钥/ 安全隐患/ ,/ 用户/ 信息/ 隐私/ 泄露/ 风险/ 巨大/ ./ 排名/ 算法/ 密钥/ 长度/ 12345/ (/ 4/ )/ 常见/ 异常/ 属性/ 汇总/ 由表/ 8/ 可知/ ,/ V4/ 版本/ 的/ 证书/ ,/ 随意/ 的/ 通用/ 名/ 身份/ 标识/ 、/ 异常/ 的/ 有效期/ 、/ 长度/ 为/ 32/ 字节/ 的/ 序号/ 等/ 异常现象/ 都/ 不/ 遵循/ RFC/ ,/ 这些/ 事实/ 表明/ X/ ./ 509/ 公钥/ 体系/ 实施/ 的/ 不/ 规范/ 状态/ ./ Page9/ 名称/ 版本号/ 4/ 通用/ 名空/ ;/ IP地址/ 有效期/ 过大/ ;/ 负数/ ;/ 起始/ 、/ 终止/ 时/ 序号/ 0/ ;/ 长度/ 过长/ ;/ 特殊/ 值/ 一般/ 为/ 1/ -/ 20/ 字节/ 整数/ 综合/ 测量/ 结果/ 可知/ ,/ 互联网/ 存在/ 大量/ HTTPS/ 应用/ ,/ 其中/ 采用/ 自/ 签名/ 证书/ 的/ 现象/ 是/ 较为/ 常见/ 的/ ,/ 且/ 存在/ 很大/ 的/ 隐私/ 安全/ 风险/ ./ 3.3/ 自/ 签名/ 证书/ 服务/ 行为/ 及/ 隐私/ 泄露/ 隐患/ 分析/ 开发者/ 应该/ 知道/ 自/ 签名/ 证书/ 安全性/ 差/ ,/ 且/ 明白/ 浏览器/ 会弹/ 出/ 安全/ 警告/ 提示/ 甚至/ 终止/ 连接/ 带来/ 不好/ 的/ 用户/ 体验/ ,/ 为什么/ 还要/ 采用/ 自/ 签名/ 证书/ ?/ 这种/ 网络/ 行为/ 背后/ 的/ 动机/ 又/ 是/ 什么/ 呢/ ?/ 我们/ 分析/ 如下/ :/ (/ 1/ )/ 经济性/ ./ 低成本/ ,/ 安装/ 开源/ 的/ OPENSSL/ 并/ 通过/ 简单/ 命令/ 即可/ 生成/ 自/ 签名/ 证书/ ,/ 无需/ 向/ 商业/ 公司/ 支付/ 任何/ 购买/ 和/ 服务/ 费用/ ,/ 对于/ 个人/ 和/ 小型/ 机构/ 非常/ 方便/ ,/ 因此/ 牺牲/ 安全性/ 换来/ 便利性/ ./ (/ 2/ )/ 便利性/ ./ 易/ 部署/ ,/ 可以/ 批量/ 生成/ 证书/ ,/ 一旦/ 出现/ 证书/ 丢失/ 或/ 损坏/ 等/ 问题/ 可以/ 快速/ 改变/ 证书/ 并/ 迁移/ 服务/ ./ (/ 3/ )/ 匿名性/ ./ 通过/ 隐匿/ 或者/ 伪造/ 服务器/ 身份/ 信息/ 实现/ 匿名性/ ,/ 比如/ 僵尸/ 网络/ 、/ 木马/ 等/ 的/ HTTPS/ 加密/ 控制/ 通道/ ./ 根据/ 文献/ [/ 1/ ]/ 的/ 测量/ 结果/ ,/ 自/ 签名/ 证书/ 中有/ 97.78/ %/ 的/ CN/ 域/ 与/ 主机名/ 不符/ ./ (/ 4/ )/ 自身/ 安全/ 考虑/ ./ 可信/ 的/ 国外/ 第/ 3/ 方/ 证书/ 认证/ 机构/ (/ 公司/ )/ 不/ 一定/ 永远/ 不/ 做出/ 欺骗/ 行为/ ,/ 尤其/ 是/ 在/ 国家/ 安全/ 的/ 名义/ 之下/ ./ 出于/ 安全/ 考虑/ ,/ 国内/ 小型/ 机构/ 或/ 个人/ 较/ 多/ 直接/ 采用/ 自/ 签名/ 证书/ ./ 一些/ 机构/ 通过/ 公开/ 自己/ 的/ 根/ CA/ 证书/ ,/ 并/ 部署/ 由/ 自己/ 根/ CA/ 颁发/ 的/ 证书/ 的/ 方式/ 来/ 实施/ 公钥/ 安全/ 设施/ ./ 这种/ 情况/ 并未/ 直接/ 采用/ 自/ 签名/ 证书/ ,/ 与/ 一般/ 意义/ 的/ 合法/ 证书/ 区别/ 在于/ 其根/ 证书/ 并未/ 内置在/ 浏览器/ 中/ ,/ 通过/ 浏览器/ HTTPS/ 访问/ 此类/ 网站/ 同样/ 会弹/ 出/ 安全/ 警告/ 提示/ ./ 而/ 一个/ 典型/ 例子/ 就是/ 铁路/ 客户服务/ 网站/ 12306/ ./ cn/ ./ 根据/ 自/ 签名/ 证书/ 的/ 测量/ 结果/ ,/ HTTPS/ 服务/ 行为/ 相当/ 不/ 规范/ ./ 大量/ 的/ 缺失/ 、/ 错误/ 和/ 异常/ 属性/ 表明/ 其/ 部署/ 相当/ 混乱/ ,/ 安全/ 状况/ 极差/ ./ 这种/ 特定/ 的/ 服务/ 行为/ 自身/ 给/ 用户/ 带来/ 的/ 隐私/ 安全/ 威胁/ 如下/ :/ (/ 1/ )/ 无法/ 察觉/ 的/ 中间人/ 攻击/ ./ 中间人/ 攻击/ ,/ 即/ MITM/ (/ ManInTheMiddle/ )/ 攻击/ ,/ 一般/ 是/ 指/ 恶意/ 攻击者/ (/ 称为/ 中间人/ )/ 通过/ 技术手段/ 作为/ 通信/ 中转/ 窥探/ 甚至/ 篡改/ 客户端/ 和/ 服务器之间/ 通信/ 内容/ 的/ 行为/ ./ 图/ 5/ 是/ 其/ 基本/ 示意图/ ./ 理论/ 上/ 讲/ ,/ SSL/ // TLS/ 提供/ 的/ 身份/ 认证/ 机制/ 可以/ 抵御/ 中间人/ 攻击/ ,/ 中间人/ 无法/ 假冒/ 服务器/ 欺骗/ 客户端/ ./ 当/ 用户/ 使用/ 浏览器/ 访问/ 使用/ 合法/ 的/ X/ ./ 509/ 证书/ 的/ HTTPS/ 服务器时/ ,/ 访问/ 页面/ 可/ 正常/ 打开/ ,/ 且/ 可以/ 看到/ 浏览器/ 的/ 安全/ 锁/ 标识/ ;/ 反之/ ,/ 当/ 访问/ 使用/ 有/ 问题/ 证书/ 的/ 网站/ 时/ ,/ 则/ 会/ 弹出/ 安全/ 警告/ ,/ 而/ 不/ 直接/ 打开/ 访问/ 网页/ ./ 通过/ 警告/ 页面/ 可以/ 看到/ 详细/ 原因/ ,/ 比如/ 证书/ 颁发/ 者/ 不/ 被/ 信任/ ,/ 有效期/ 过期/ ,/ 证书/ 所有者/ 与/ 访问/ 域名/ 不符/ 等/ ./ 当/ 用户/ 访问/ 银行/ 等/ 网站/ 时/ 被劫持/ ,/ 浏览器/ 会弹/ 出/ 安全/ 警告/ ,/ 此时/ 用户/ 就/ 知道/ 很/ 可能/ 受到/ 了/ 中间人/ 攻击/ ,/ 及早/ 终止/ 访问/ ,/ 防止/ 隐私/ 泄露/ ./ 但是/ ,/ 当/ 用户/ 访问/ 使用/ 自/ 签名/ 证书/ 的/ 服务器时/ ,/ 无法/ 知道/ 是否/ 真正/ 受到/ 了/ 中间人/ 攻击/ ,/ 因为/ 网站/ 自身/ 部署/ 了/ 不/ 安全/ 的/ X/ ./ 509/ 证书/ ,/ 无论/ 用户/ 是否/ 被/ 攻击者/ 劫持/ ,/ 都/ 是/ 会/ 弹出/ 警告/ ./ 在/ 这种/ 情况/ 下/ ,/ 一般/ 用户/ 都/ 会/ 选择/ 忽略/ 这些/ 警告/ ,/ 不知不觉/ 中/ 泄漏/ 了/ 个人隐私/ ,/ 比如/ 个人/ 账号密码/ 、/ 访问/ 的/ 页面/ 和/ 电子邮件/ 内容/ ./ 具备/ 安全/ 知识/ 的/ 用户/ 可能/ 会/ 查看/ 证书/ 信息/ 来/ 确认/ ,/ 然而/ 由于/ 自/ 签名/ 证书/ 的/ 随意性/ ,/ 攻击者/ 很/ 容易/ 伪造/ 一个/ 基本/ 一模一样/ 的/ 证书/ ,/ 让/ 用户/ 防不胜防/ ./ (/ 2/ )/ 不/ 安全/ 的/ 证书/ 属性/ 带来/ 的/ 隐私/ 威胁/ ./ 一般而言/ ,/ 只有/ 可/ 信任/ 根/ CA/ 证书/ 的/ 有效期/ 较长/ (/ 20/ 或/ 30/ 年/ )/ ,/ 如果/ 有效期/ 过/ 短/ 将/ 导致/ 频繁/ 的/ 用户/ 证书/ 更换/ ./ 这些/ 根/ 证书/ 都/ 采用/ 高强度/ 的/ 安全/ 参数/ ,/ 防止/ 私钥/ 在/ 其/ 有效期/ 内/ 被/ 攻击者/ 破解/ ,/ 从而/ 保证/ 部署/ 其/ 颁发/ 证书/ 的/ 服务器/ 安全/ ./ 对于/ 一般/ 商用/ 证书/ ,/ 有效期/ 一般/ 为/ 1/ ~/ 2/ 年/ ./ 然而/ ,/ 从/ 对/ 自/ 签名/ 证书/ 的/ 测量/ 结果/ 来看/ ,/ 去/ 重后/ 的/ 自/ 签名/ 证书/ 中有/ 51.8/ %/ 的/ 证书/ 有效期/ 在/ 5/ 年/ 以上/ 且/ 公钥/ 长度/ 不/ 大于/ 1024/ 位/ ,/ 更/ 令人震惊/ 的/ 是/ 有效期/ 10/ 年/ 以上/ 且/ 公钥/ 长度/ 不/ 大于/ 1024/ 位/ 的/ 证书/ 比例/ 高达/ 47.8/ %/ ./ 这样/ 的/ 证书/ 容易/ 受到/ 有/ 一定/ 计算资源/ 的/ 攻击者/ 的/ 暴力破解/ ,/ 访问/ 这些/ 服务器/ 所有/ 用户/ 面临/ 严重/ 的/ 信息/ 泄露/ 问题/ ./ Page104/ 基于/ 证书/ 的/ 应用/ 类型/ 泄露/ 研究/ 基于/ 测量/ 得到/ 的/ 统计数据/ ,/ 我们/ 进一步/ 提出/ 了/ 基于/ 自/ 签名/ 证书/ 的/ SSL/ 服务/ 分类/ 方法/ ,/ 对/ 大部分/ 同类/ 服务/ 进行/ 了/ 有效/ 聚类/ ,/ 从而/ 从/ 服务器/ 角度/ 证明/ 了/ 自/ 签名/ 证书/ 存在/ 泄露/ 服务/ 类别/ 的/ 隐私/ 安全/ 风险/ ./ 即/ 在/ 服务器/ 身份/ 标识/ 不可/ 信/ 、/ 不/ 全面/ 、/ 匿名/ 化/ 和/ 模糊化/ 情况/ 下/ ,/ 仍然/ 可以/ 从/ 统计/ 规律/ 上/ 找到/ 识别/ 其/ 应用服务/ 类别/ 的/ 方法/ ./ 访问/ 此类/ 加密/ 服务/ 的/ 用户/ 面临/ 访问/ 应用/ 类型/ 泄露/ 的/ 隐私/ 威胁/ ./ 4.1/ 基于/ 证书/ 的/ 应用服务/ 类型/ 聚类/ 我们/ 采用/ 了/ 两种/ 方法/ 对/ 服务器/ 自/ 签名/ 证书/ 进行/ 挖掘/ 和/ 分析/ ,/ 一种/ 是/ 基于/ Jaccard/ ’/ scoefficient/ [/ 21/ ]/ 的/ 文本/ 相似/ 度/ 度量/ ,/ 另/ 一种/ 是/ 基于/ 改进/ K/ -/ Means/ 的/ 文本属性/ 聚类/ 方法/ ./ 4.1/ ./ 1/ 特征/ 选取/ 和/ 数据/ 标注/ 我们/ 采用/ 的/ 特征/ 集合/ 为/ 8/ 个/ 证书/ 属性/ 的/ 集合/ ①/ :/ {/ 版本/ ,/ 序号/ ,/ 有效期/ 起始/ 年/ 月/ ,/ 有效期/ 天数/ ,/ 通用/ 名/ ,/ 签名/ 算法/ ,/ 公钥/ 算法/ ,/ 公钥/ 长度/ }/ ,/ 其中/ 标识/ 证书/ 身份/ 信息/ 的/ 主要/ 有/ 序号/ 、/ 通用/ 名/ (/ 颁发/ 者/ 和/ 持有者/ 信息/ )/ ,/ 而/ 其它/ 属性/ 主要/ 表示/ 其/ 安全性/ ,/ 这些/ 属性/ 的/ 集合/ 可以/ 较为/ 完整/ 地/ 衡量/ 一个/ 证书/ ./ 对/ HTTPS/ 服务器/ 应用/ 类型/ 的/ 标注/ ,/ 采用/ 了/ 多/ 维护/ 信息/ 综合/ 判定/ 方法/ 、/ 通过/ WHOIS/ 注册/ 信息/ 、/ 多个/ DNS/ 服务器/ 的/ 域名/ 查询/ 结果/ 、/ IP/ 地理位置/ 、/ https/ 访问/ 响应/ 及/ 域名/ 实体/ 信息/ 搜索/ 等/ 给出/ 可信/ 的/ 结果/ ./ 根据/ 文献/ [/ 22/ ]/ 中/ 对/ HTTPWeb/ 应用/ 的/ 类别/ 并/ 结合/ HTTPS/ 自身/ 的/ 服务/ 特点/ ,/ 我们/ 研究/ 的/ 加密/ Web/ 应用/ 类别/ 为/ 普通/ HTTPS/ 服务器/ 、/ 邮件/ 服务器/ 、/ 控制/ 管理/ 服务器/ 和/ 视频/ 服务器/ 等/ ./ 4.1/ ./ 2/ 相似/ 度/ 度量/ 方法/ Jaccard/ 系数/ 通常/ 用于/ 计算/ 个体/ 之间/ 的/ 相似性/ ,/ 比如/ 文本/ 相似/ 度/ 、/ 物种/ 多样性/ 相似/ 指数/ 等/ ,/ 计算公式/ 为/ Sim/ (/ X/ ;/ Y/ )/ =/ |/ X/ ∩/ Y/ |/ 公共/ (/ 即/ 交集/ )/ 元素/ 个数/ ,/ 分母/ 为/ 两个/ 集合/ 的/ 并/ 集中/ 元素/ 的/ 个数/ ./ 在/ 我们/ 的/ 实验/ 中/ ,/ X/ 与/ Y/ 分别/ 表示/ 两个/ X/ ./ 509/ 自/ 签名/ 证书/ ,/ X/ ,/ Y/ 的/ 元素/ 是/ 证书/ 的/ 属性/ ./ 为了/ 方便/ ,/ 选取/ 了/ 常见/ 的/ 公共/ 属性/ 进行/ 比较/ ,/ 即/ X/ 与/ Y/ 属性/ 个数/ 相同/ ,/ 均/ 为/ n/ =/ 8/ ,/ 且/ 属性/ 一一对应/ ./ 同时/ ,/ 我们/ 将/ 证书/ 的/ 各个/ 属性/ 进行/ 了/ 字符串/ 化/ ./ 两个/ 证书/ 的/ 相似/ 度/ 计算方法/ 如下/ :/ 设/ X/ =/ [/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ ]/ ,/ Y/ =/ [/ Y1/ ,/ Y2/ ,/ …/ ,/ Yn/ ]/ ,/ 其中/ Xi/ (/ i/ ∈/ [/ 1/ ,/ n/ ]/ )/ 表示/ X/ 的/ 一个/ 属性/ ,/ Yj/ (/ j/ ∈/ [/ 1/ ,/ n/ ]/ )/ 表示/ Y/ 的/ 一个/ 属性/ ,/ 且/ 当/ i/ =/ j/ 时/ ,/ Xi/ 与/ Yj/ 表示/ 同一/ 属性/ ,/ 比如/ 证书/ 版本/ ./ 为/ 方便/ 描述/ ,/ 引入/ 相似/ 度/ 向量/ 犛/ ./ 定义/ 1/ ./ 相似/ 度/ 向量/ 犛为/ X/ 与/ Y/ 的/ 相似/ 度/ ,/ 犛/ =/ [/ S1/ ,/ S2/ ,/ …/ ,/ Sn/ ]/ ,/ 其中/ X/ =/ [/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ ]/ ,/ Y/ =/ [/ Y1/ ,/ Y2/ ,/ …/ ,/ Yn/ ]/ ,/ Si/ 表示/ Xi/ 与/ Yi/ 的/ 字符串/ 相似/ 度/ 系数/ ,/ |/ S/ |/ 的/ 计算公式/ 为/ |/ S/ |/ =/ ∑/ nSi/ 计算方法/ 如下/ :/ (/ 1/ )/ 如果/ Xi/ =/ Yi/ ,/ Si/ =/ 1/ ;/ (/ 2/ )/ 如果/ Xi/ ≠/ Yi/ ,/ 则/ 按/ 如下/ 方法/ 计算/ Si/ ./ Si/ 计算方法/ 基于/ 广泛应用/ 的/ 字符串/ 相似性/ 度量/ 方法/ Levenshtein/ 距离/ ②/ ,/ 此处/ 简记/ 为/ Levens/ (/ Xi/ ,/ Yi/ )/ ./ 设/ Xi/ ,/ Yi/ 的/ 长度/ 分别/ 为/ Lx/ ,/ Ly/ ,/ 两者/ 较大/ 者/ 记为/ max/ {/ Lx/ ,/ Ly/ }/ ,/ 则/ Si/ =/ 1/ -/ Levens/ (/ Xi/ ,/ Yi/ )/ Levens/ (/ Xi/ ,/ Yi/ )/ ∈/ [/ 0/ ,/ max/ {/ Lx/ ,/ Ly/ }/ ]/ ./ 显然/ ,/ 字符串/ 之间/ 的/ 相似/ 度/ 随着/ 距离/ 的/ 增大/ 而/ 降低/ ./ 此/ 方法/ 可以/ 保证/ 两个/ 字符串/ 在/ 没有/ 公共/ 字符/ 时/ Si/ 值为/ 0/ ,/ 在/ 两/ 字符串/ 相同/ 时/ Si/ 值为/ 1/ ,/ 且/ 满足/ Si/ ∈/ [/ 0/ ,/ 1/ ]/ ./ 通过/ 计算/ 各个/ Si/ 得到/ |/ S/ |/ ,/ 即/ Jaccard/ 系数/ 计算公式/ 中/ 的/ 分子/ |/ X/ ∩/ Y/ |/ =/ |/ S/ |/ ./ 记/ n/ 个/ 不同/ Si/ 中值/ 为/ 1/ (/ 重合/ 元素/ )/ 的/ 个数/ 为/ m/ (/ m/ / n/ )/ ,/ 则/ 公式/ 中/ 分母/ 为/ |/ X/ ∪/ Y/ |/ =/ m/ +/ 2/ (/ n/ -/ m/ )/ =/ 2n/ -/ m/ ,/ 从而/ 得到/ 最终/ 计算公式/ 为/ 通过/ 设定/ 临界/ 阈值/ R/ (/ 0/ / R/ / n/ )/ ,/ 然后/ 根据/ 两个/ 证书/ X/ 与/ Y/ 之间/ 的/ 相似/ 度/ Sim/ (/ X/ ;/ Y/ )/ 来/ 判断/ 两个/ 服务器/ 是否/ 提供/ 同类/ 服务/ ,/ 即/ 如果/ Sim/ (/ X/ ;/ Y/ )/ / R/ ,/ 则/ X/ 与/ Y/ 为/ 同一/ 类别/ 服务/ ;/ 否则/ ,/ X/ 与/ Y/ 不是/ 同/ 类别/ 加密/ 应用服务/ ./ 通过/ 调整/ 阈值/ 取值/ 进行/ 实验/ 来/ 获取/ 最优/ 结果/ ./ 4.1/ ./ 3K/ -/ means/ 聚类/ 方法/ K/ -/ Means/ 是/ 数据挖掘/ 中/ 常用/ 的/ 一种/ 简单/ 的/ 无/ 监督/ 学习/ 算法/ ,/ 适合/ 对/ 无/ 标注/ 数据/ 集合/ 进行/ 基于/ 样本/ 距离/ 的/ 聚类/ ./ 相对/ 于/ 分类/ 算法/ ,/ 聚类/ 具有/ 不/ 依赖/ 预/ ①/ ②/ Page11/ 定义/ 的/ 类/ 和/ 类/ 标号/ 的/ 训练/ 实例/ 等/ 优势/ ./ 我们/ 使用/ Weka/ 平台/ ①/ 提供/ 的/ SimpleKmeans/ 算法/ 以及/ 自己/ 用/ Python/ 实现/ 的/ K/ -/ Means/ 算法/ 对/ 获得/ 的/ 全部/ 32.55/ 万个/ 不同/ 自/ 签名/ 证书/ 进行/ 了/ 聚类/ ,/ 希望/ 从/ 无/ 监督/ 学习/ 的/ 角度/ 找出/ 证书/ 内在/ 自然/ 规律性/ ./ 采用/ 自己/ 实现/ 的/ K/ -/ means/ 算法/ 是因为/ Weka/ 提供/ 的/ k/ -/ means/ 采用/ 的/ 距离/ 度量/ 方法/ 只能/ 为/ 欧式/ 距离/ ,/ 不/ 适合/ 对/ 字符串/ 度量/ ,/ 且/ 可能/ 因某/ 一个/ 维度/ 数值/ 差距/ 过大/ 导致/ 总体/ 距离/ 过大/ ,/ 无法/ 体现/ 多个/ 属性/ 的/ 综合/ 效果/ ./ 需要/ 说明/ 的/ 是/ ,/ 由于/ 对/ 整个/ 数据/ 集/ 标注/ 很/ 耗时/ ,/ 且/ 标注/ 存在/ 主观性/ 和/ 不确定性/ ,/ 我们/ 选用/ 了/ 无/ 监督/ 算法/ 而/ 不是/ 有/ 监督/ 算法/ 开展/ 实验/ ./ 选择/ K/ -/ Means/ 算法/ 的/ 另/ 一/ 原因/ 是/ 其/ 简单/ 实用/ ./ 我们/ 的/ 方法/ 采用/ 了/ 自定义/ 的/ 距离/ 度量/ 方法/ ,/ 充分考虑/ 了/ 证书/ 各个/ 属性/ 的/ 均衡性/ ,/ 针对/ 数值/ 型/ 属性/ 和/ 字符串/ 型/ 属性/ 分别/ 采用/ 各自/ 的/ 距离/ 计算方法/ (/ 欧式/ 距离/ 和/ 编辑/ 距离/ )/ ,/ 并/ 将/ 两个/ 证书/ 每个/ 分量/ 的/ 距离/ Di/ 取值/ 范围/ 归一化/ 为/ Di/ ∈/ [/ 0/ ,/ 1/ ]/ ,/ 避免/ 了/ 某个/ 属性/ 距离/ 较大/ 导致/ 的/ 整体/ 距离/ 偏差/ ./ 最终/ 的/ 距离/ D/ 计算公式/ 为/ 算法/ 的/ 一个/ 难点/ 是/ 依靠/ 均值/ 获得/ 每/ 一轮/ 循环/ 的/ 新/ 质心/ ./ 由于/ 通用/ 名/ 、/ 签名/ 算法/ 等/ 属性/ 是/ 字符串/ ,/ 字符串/ 的/ 平均值/ 难以/ 衡量/ ,/ 依靠/ 类似/ 算数/ 平均/ 的/ 方法/ 得到/ 的/ 新/ 字符串/ 可能/ 和/ 任何/ 一个/ 字符串/ 都/ 有/ 较大/ 距离/ ./ 为了/ 解决/ 这一/ 问题/ ,/ 我们/ 首先/ 计算/ 出/ 5/ 个/ 数值/ 型/ 属性/ 的/ 平均值/ ,/ 得到/ 新/ 质心/ 的/ 5/ 个/ 属性/ ,/ 然后/ 从/ 对应/ 簇/ 所有/ 样本/ 中/ 寻找/ 与/ 新/ 质心/ 的/ 这/ 5/ 个/ 已知/ 属性/ 距离/ 最近/ 的/ 样本/ 为/ 属性/ 完整/ 的/ 新/ 质心/ ./ 4.2/ 实验/ 结果/ 4.2/ ./ 1/ 相同/ 证书/ 聚合/ 经过/ 我们/ 的/ 实验/ 发现/ ,/ 即使/ 很/ 简单/ 的/ 方法/ 就/ 可以/ 得到/ 一些/ 有意思/ 的/ 结果/ ,/ 而/ 这些/ 结果/ 是/ 通过/ IP/ 域名解析/ 和/ 流/ 统计/ 属性/ 等/ 手段/ 难以获得/ 的/ ./ 比如/ ,/ 运用/ 相似/ 度/ 度量/ 方法/ 、/ 保留/ IP地址/ 标签/ ,/ 取/ 阈值/ R/ =/ 8/ ,/ 即仅/ 对/ 相同/ 证书/ 进行/ 合并/ 归类/ 时/ ,/ 我们/ 就/ 成功/ 发现/ 了/ 多个/ 同类/ 服务/ ,/ 表/ 9/ 举出/ 几个/ 例子/ ./ 序号/ 1/ 通用/ 名为/ localhost/ ./ localdomain/ ;/ 版本/ 3/ ;/ 序号/ 为/ 0/ ,/ 有效期/ 365/ 天/ ;/ 2/ 通用/ 名为/ 空/ ;/ 颁发/ 日期/ 为/ 2010/ 年/ 2/ 月/ ;/ 序号/ 为/ 8/ 字节/ 的/ 特定/ 数/ 3/ 通用/ 名为/ xxx/ ./ info/ 根据/ 相同/ 证书/ 合并/ 归类/ 结果/ ,/ 结合/ 每个/ 类别/ 中/ IP地址/ 集合/ 的/ 地址/ 熵/ (/ 即/ IP地址/ 的/ 离散/ 度/ )/ ,/ 可以/ 有效/ 推测/ 出该/ 类别/ 服务/ 的/ 类型/ ./ 一般来说/ ,/ 较为/ 公开/ 的/ 服务/ IP地址/ 一般/ 具有/ 较/ 高/ 的/ 集中度/ (/ 一个/ 或/ 几个/ 段/ ,/ 且/ 每个/ 段/ 内/ 的/ IP/ 数量/ 较/ 多/ )/ ,/ 而/ 匿名性/ 较强/ 的/ 服务/ ,/ 则/ 往往/ 表现/ 出较/ 强/ IP地址/ 分布/ 离散/ 度/ ./ 比如/ 表/ 9/ 的/ 结果/ ,/ 我们/ 发现/ 其中/ 第/ 3/ 个/ 例子/ IP地址/ 离散/ 度/ 很/ 高/ ,/ 经/ 确认/ 是/ 代理服务器/ ./ 4.2/ ./ 2/ 相似/ 证书/ 聚类/ 由于/ Weka/ 的/ K/ -/ means/ 只能/ 通过/ 计算/ 欧式/ 距离/ 和/ 曼哈顿/ 距离/ 来/ 聚类/ ,/ 因此/ 对/ 字符串/ 的/ 距离/ 度量/ 不太好/ ./ 即使/ 在/ 这种/ 情况/ 下/ ,/ 通过/ K/ -/ means/ 聚类/ 算法/ 对/ 证书/ 进行/ 聚类/ 的/ 结果表明/ ,/ 自/ 签名/ 证书/ 集合/ 内部/ 存在/ 明显/ 的/ 相似性/ ./ 我们/ 对/ K/ 取/ 不同/ 值/ (/ 2/ / K/ / 15/ )/ 进行/ 试验/ ,/ 观察/ 采用/ 相似/ 度/ 度量/ ,/ Weka/ 的/ SimpleKmeans/ 和/ 自定义/ 距离/ 度量/ 的/ K/ -/ means/ 算法/ 的/ 聚类/ 结果/ ./ 当/ K/ =/ 5/ 时/ ,/ 且/ 采用/ 我们/ 距离/ 度量/ 方法/ 的/ K/ -/ means/ 方法/ ,/ 结果/ 最好/ ,/ 此时/ 同类/ 别的/ 证书/ 能够/ 被/ 很/ 好/ 的/ 聚类/ ./ K/ 值过/ 小/ ,/ 区分度/ 太低/ ;/ K/ 值过/ 大/ ,/ 同类/ 证书/ 明显/ 被/ 过度/ 拆分/ 到/ 多个/ 簇中/ ./ K/ =/ 5/ 时/ 的/ 自定义/ 距离/ 度量/ 方法/ 的/ 一次/ 聚类/ 总体/ 结果/ 见表/ 10/ ./ 由表/ 10/ 可/ 直观/ 看出/ ,/ 5/ 个/ 质心/ 各个/ 属性/ 彼此/ 差距/ 很大/ ,/ 区分度/ 较强/ ./ 从/ 我们/ 对/ 聚类/ 结果/ 的/ 详细分析/ 看出/ ,/ 同类/ 别的/ 证书/ 能够/ 很/ 好/ 地被/ 聚类/ 同一个/ 簇中/ ./ K/ </ 5/ 时/ ,/ 区分度/ 不够/ 强/ ,/ 而/ K/ =/ 6/ ,/ 两个/ 将近/ 的/ 类/ 已/ 被/ 分开/ ./ 表/ 10/ 犓/ =/ 5/ 时/ 自定义/ 距离/ 度量/ 犓/ -/ means/ 聚类/ 结果/ 类别/ [/ version/ :/ ‘/ 3/ ’/ ,/ serial/ :/ ‘/ 3F3751F80977BB924D03FCABECD9E200/ ’/ ,/ NotBefore/ :/ ‘/ 201010/ ’/ ,/ valid/ _/ days/ :/ ‘/ 7/ ’/ ,/ CN/ :/ ‘/ “/ Webmail/ ./ sisgraph/ ./ com/ ./ br/ ”/ ’/ ,/ pubkey/ :/ ‘/ RSA/ ’/ ,/ keylen/ :/ ‘/ 1024/ ’/ ,/ sig/ _/ alg/ :/ ‘/ sha1WithRSA/ ’/ ]/ [/ version/ :/ ‘/ 3/ ’/ ,/ serial/ :/ ‘/ 02/ ’/ ,/ NotBefore/ :/ ‘/ 200301/ ’/ ,/ valid/ _/ days/ :/ ‘/ 3650/ ’/ ,/ CN/ :/ ‘/ “/ 00/ :/ 16/ :/ b6/ :/ 87/ :/ ea/ :/ 3e/ ”/ ’/ ,/ pubkey/ :/ ‘/ RSA/ ’/ ,/ keylen/ :/ ‘/ 1024/ ’/ ,/ sig/ _/ alg/ :/ ‘/ sha1WithRSAEncryption/ ’/ ]/ [/ version/ :/ ‘/ 1/ ’/ ,/ serial/ :/ ‘/ 4F87DAA1/ ’/ ,/ NotBefore/ :/ ‘/ 201204/ ’/ ,/ valid/ _/ days/ :/ ‘/ 365/ ’/ ,/ CN/ :/ ‘/ “/ plesk/ ”/ ’/ ,/ pubkey/ :/ ‘/ RSA/ ’/ ,/ keylen/ :/ ‘/ 2048/ ’/ ,/ sig/ _/ alg/ :/ ‘/ sha1WithRSAEncryption/ ’/ ]/ [/ ‘/ 3/ ’/ ,/ ‘/ FDF9389F38579658/ ’/ ,/ ‘/ 197001/ ’/ ,/ ‘/ 24852/ ’/ ,/ ‘/ “/ cbeckmann/ ./ dyndns/ ./ org/ ”/ ’/ ,/ ‘/ RSA/ ’/ ,/ ‘/ 1024/ ’/ ,/ ‘/ sha1WithRSAEncryption/ ’/ ]/ [/ ‘/ 3/ ’/ ,/ ‘/ 51310603/ ’/ ,/ ‘/ 201212/ ’/ ,/ ‘/ 1155/ ’/ ,/ ‘/ “/ firewareWebca/ ”/ ’/ ,/ ‘/ RSA/ ’/ ,/ ‘/ 2048/ ’/ ,/ ‘/ sha1WithRSAEncryption/ ’/ ]/ 12345/ ①/ Weka/ —/ MachineLearningSoftwareinJava/ [/ EB/ // OL/ ]/ ,/ ht/ -/ tp/ :/ // // sourceforge/ ./ net/ // projects/ // weka/ // ./ 2013/ -/ 04/ -/ 15Page12/ 我们/ 对/ 部分/ 实验/ 数据/ 进行/ 人工/ 分析/ ,/ 虽然/ 从/ 应用/ 上/ 讲/ ,/ 并非/ 所有/ 同类/ 别的/ 服务/ (/ 比如/ Webmail/ )/ 都/ 能/ 被/ 聚类/ 到/ 一起/ (/ 证书/ 差异/ 较大/ 必然/ 不能/ )/ ,/ 然而/ ,/ 同一/ 类别/ 的/ 地理位置/ 较/ 远/ (/ IP地址/ 分布/ )/ ,/ 但/ 应用/ 内容/ 相近/ 的/ 服务/ (/ 比如/ 同一/ 公司/ 的/ 游戏/ 服务/ ,/ 或/ 同一个/ 服务商/ 的/ 网络/ 认证/ 系统/ 等/ )/ 能够/ 非常/ 有效/ 地被/ 聚类/ 到/ 一起/ ,/ 准确率/ 在/ 95/ %/ 以上/ ./ 我们/ 发现/ ,/ 部署/ 相似/ 证书/ 的/ 服务器/ 往往/ 提供/ 着/ 相似/ 的/ 服务/ ./ 4.2/ ./ 3/ 自/ 签名/ 证书/ 的/ 持续性/ 验证/ 自/ 签名/ 证书/ 的/ 一个/ 显著/ 特征/ 是/ 构造/ 的/ 随意性/ ,/ 表/ 112013/ 年/ 2/ 月/ 和/ 6/ 月/ 自/ 签名/ 证书/ 服务器/ 结果/ 比较/ 日/ 平均/ 结果/ // 月份/ V1/ 自/ 签名/ 服务器/ 访问/ 次数/ V1/ 自/ 签名/ 服务器/ IP/ 数/ V3/ 自/ 签名/ 服务器/ 访问/ 次数/ V3/ 自/ 签名/ 服务器/ IP/ 数/ 2013/ 年/ 2/ 月/ 2013/ 年/ 6/ 月/ 增长幅度/ // %/ / 此处/ 数据/ 变化/ 大/ 很/ 可能/ 是因为/ 2/ 月份/ 由于/ 假期/ 等/ 原因/ 访问量/ 较少/ ./ (/ 2/ )/ 服务器/ IP/ 重合/ 度高/ ./ 重合/ 度/ 采用/ 类似/ 于/ 上述/ Jaccard/ 系数/ 的/ 定义/ 进行/ 计算/ ,/ 只不过/ 分母/ 不是/ 两个/ 集合/ 的/ 并/ 集中/ 元素/ 个数/ 而是/ 较/ 早/ 时间/ 点/ 的/ 集合/ 中/ 元素/ 的/ 个数/ ./ 为了/ 观察/ 总体/ 趋势/ ,/ 我们/ 将/ 2/ 月份/ 和/ 6/ 月份/ 的/ 自/ 签名/ 证书/ 服务器/ IP/ 分别/ 合并/ 去/ 重后/ 计算/ ,/ 其中/ 2/ 月份/ 总/ IP/ 数为/ 854.15/ 万/ ,/ 6/ 月份/ 总/ IP/ 数为/ 1033/ 万/ ./ 结果表明/ ,/ 重合/ IP/ 数量/ 为/ 349.20/ 万/ ,/ 与/ 2/ 月份/ 和/ 6/ 月份/ IP/ 重合/ 度/ 分别/ 为/ 40.9/ %/ 和/ 33.8/ %/ ./ 由此可见/ ,/ 相隔/ 4/ 个/ 月/ 仍/ 保持/ 高/ 重合/ 度/ ,/ 绝对/ 重合/ IP/ 数在/ 百万/ 数量级/ ./ (/ 3/ )/ 证书/ 信息/ 重合/ 度/ 通过/ 对比/ 证书/ 信息/ ,/ 我们/ 发现/ 重合/ IP/ 证书/ 保持/ 了/ 很/ 强/ 的/ 一致性/ ./ 而且/ 如果/ 一个/ 服务器/ 不断/ 更换/ 证书/ ,/ 但/ 总是/ 自/ 签名/ 证书/ ,/ 那么/ 持续性/ 仍然/ 成立/ ./ 而/ 对/ 2/ 月份/ 非/ 重合/ IP/ 的/ 抽样/ 探测/ 表明/ ,/ 这些/ 服务器/ 443/ 端口/ 关闭/ (/ TCP/ 握手/ 失败/ )/ ,/ 要么/ 仍/ 采用/ 自/ 签名/ 证书/ (/ 只是/ 近期/ 没有/ 访问/ )/ ./ 总之/ ,/ 自/ 签名/ 证书/ 的/ 部署/ 是/ 普遍/ 的/ ,/ 短期/ 使用/ 现象/ 大量/ 存在/ ,/ 但/ 我们/ 更/ 倾向/ 于/ 认为/ 此/ 现象/ 表明/ 了/ 特定/ 服务/ 行为/ 的/ 随意性/ 和/ 短暂性/ 特征/ ./ 4.2/ ./ 4/ 与/ 已有/ 隐私/ 发现/ 研究/ 结果/ 对比/ 比/ ,/ 如表/ 12/ 所示/ ./ 通过/ 对比/ 可知/ ,/ 已有/ 隐私/ 发现/ 工作/ 一般/ 是/ 细粒度/ 的/ 实验性/ 研究/ ,/ 对/ 用户/ 通过/ 加密/ 、/ 匿名/ 手段/ 访问/ 的/ 特定/ 网站/ 进行/ 识别/ ,/ 数据/ 集/ 很小/ ,/ 普适性/ 较差/ ,/ 目前/ 看/ 实际/ 应用/ 价值/ 有限/ ./ 我们/ 的/ 工作/ 基于/ 大/ 数据/ 集合/ ,/ 满足/ 实时性/ 要求/ ,/ 更具/ 实际/ 应用/ 价值/ ,/ 但/ 目前/ 是/ 粗粒度/ ,/ 对/ 一些/ 细节/ 还/ 需要/ 进一步/ 研究/ ./ 我们/ 选取/ 了/ 几个/ 具有/ 代表性/ 的/ 实验/ 结果/ 进行/ 对/ 因此/ 其/ 动态变化/ 肯定/ 存在/ ./ 自/ 签名/ 证书/ 究竟/ 是/ 长期/ 使用/ ,/ 还是/ 仅仅/ 在/ 加密/ 服务/ 部署/ 的/ 测试阶段/ 临时/ 使用/ ,/ 对于/ 我们/ 的/ 研究/ 结果/ 十分/ 重要/ ./ 借助于/ 后续/ 测量/ 结果/ ,/ 我们/ 对/ 2013/ 年/ 2/ 月/ 和/ 6/ 月/ 两个/ 月份/ 的/ 自/ 签名/ 证书/ 测量/ 结果/ 进行/ 对比/ ,/ 有/ 如下/ 发现/ ./ (/ 1/ )/ 数量/ 上/ 呈/ 增长/ 趋势/ ./ 2013/ 年/ 2/ 月/ 和/ 6/ 月/ 两个/ 月份/ 的/ 自/ 签名/ 证书/ 服务器/ 访问/ 次数/ 及/ IP/ 数量/ 比较/ 结果/ 如表/ 11/ 所示/ ./ 通过/ 2/ 月份/ 和/ 6/ 月份/ 结果/ 对比/ 可知/ ,/ 采用/ 自/ 签名/ 证书/ 的/ HTTPS/ 服务/ 数量/ 有/ 明显/ 上升/ 趋势/ ./ 方法/ 文献/ [/ 16/ ]/ 各/ 类型/ 加密/ HTTP/ ,/ 文献/ [/ 17/ ]/ HTTPSwebmail/ 文献/ [/ 19/ ]/ SSH/ ,/ Tor/ ,/ HTTPOS/ 及/ 本文/ 方法/ HTTPS5/ 结果/ 分析/ 实验/ 结果表明/ ,/ 我们/ 的/ 方法/ 可以/ 相当/ 有效/ 地/ 实现/ 加密/ SSL/ 服务/ 发现/ 和/ 服务/ 分类/ ,/ 从而/ 表明/ 了/ 采用/ 自/ 签名/ 证书/ 的/ HTTPS/ 服务/ 存在/ 用户/ 访问/ 应用/ 类别/ 隐私/ 泄露/ 的/ 风险/ ./ 主要/ 结论/ 如下/ :/ (/ 1/ )/ 由于/ 批量/ 生成/ 证书/ 、/ 批量/ 部署/ 等/ 原因/ ,/ 同一/ 服务/ 的/ 服务器/ 证书/ 往往/ 具有/ 很强/ 的/ 相似性/ ,/ 具体表现/ 为/ :/ 证书/ 颁发/ 时间/ 相近/ 、/ 序列号/ 长度/ 基本一致/ ,/ 在/ 证书/ 版本/ 、/ 签名/ 算法/ 和/ 密钥/ 长度/ 等/ 方面/ 表现/ 出/ 一致性/ ,/ 证书/ 的/ 通用/ 名/ 模式/ 表现/ 出/ 相似性/ ./ (/ 2/ )/ 属性/ 相似/ 的/ X/ ./ 509/ 自/ 签名/ 证书/ 往往/ 对应/ 着/ 相同/ 或/ 相近/ 的/ 服务/ 类别/ ./ (/ 3/ )/ 通过/ X/ ./ 509/ 证书/ 可以/ 有效/ 进行/ 服务/ 发现/ 和/ 粗/ 分类/ ,/ 即使/ 无法/ 确认/ 服务/ 的/ 类型/ 也/ 可以/ 进行/ 同类/ 服务/ 的/ 识别/ ./ 对于/ 采用/ SSL/ 的/ 新型/ 加密/ 应用/ 的/ 发现/ Page13/ 具有/ 重要/ 意义/ ./ (/ 4/ )/ 访问/ 采用/ 自/ 签名/ 证书/ 的/ HTTPS/ 加密/ 服务/ 的/ 用户/ 由于/ 服务器/ 泄露/ 的/ 信息/ 而/ 存在/ 行为/ 泄露/ 隐私/ 风险/ ,/ 即/ 用户/ 访问/ 的/ 应用/ 内容/ 的/ 类型/ 可能/ 被/ 监测/ 者/ 推测/ 出来/ ./ 6/ 结束语/ 本文/ 从/ SSL/ 的/ X/ ./ 509/ 自/ 签名/ 证书/ 测量/ 入手/ ,/ 首先/ 通过/ 测量/ 结果/ 数据分析/ 对/ 自/ 签名/ 证书/ 类/ HTTPS/ 服务/ 的/ 隐私/ 安全隐患/ 进行/ 了/ 分析/ ,/ 然后/ 通过/ 进一步/ 聚类/ 挖掘/ ,/ 对/ SSL/ 服务/ 中/ 部署/ X/ ./ 509/ 自/ 签名/ 证书/ 的/ 这/ 一/ 类型/ 应用/ 存在/ 的/ 用户/ 隐私/ 威胁/ 进行/ 了/ 较为/ 深入/ 的/ 研究/ ,/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 本/ 研究/ 基于/ 对/ SSL/ 服务/ 的/ 大/ 范围/ 真实/ 测量/ 结果/ ,/ 不同于/ 一般/ 实验/ 环境/ 进行/ 的/ 模型/ 验证/ 类/ 研究/ ./ 依据/ 数据/ 对/ 自/ 签名/ 证书/ 服务/ 行为/ 的/ 动机/ 、/ 持续性/ 及/ 隐私/ 泄露/ 隐患/ 进行/ 了/ 较为/ 深入/ 的/ 分析/ ,/ 之前/ 尚未/ 见到/ 此/ 方面/ 的/ 研究/ ./ (/ 2/ )/ 本文/ 的/ 测量/ 工作/ 采用/ 主/ 被动/ 结合/ 的/ 方法/ ,/ 以/ 被动/ 获取/ 的/ 真实/ 连接/ 信息/ 为/ 基础/ ,/ 进行/ 有/ 约束/ IP地址/ 范围/ 的/ 主动/ 探测/ ,/ 时间/ 短/ ,/ 效率高/ ,/ 成功率高/ ,/ 避免/ 了/ 大面积/ 主动/ 探测/ 耗时/ 太长且/ 容易/ 受到/ 环境/ 等/ 因素/ 影响/ 的/ 缺点/ ./ (/ 3/ )/ 本文/ 从/ 服务器端/ X/ ./ 509/ 自/ 签名/ 证书/ 出发/ 提取/ 加密/ Web/ 服务/ 行为/ 特征/ ,/ 与/ 本/ 领域/ 其他/ 研究/ 利用/ 流量/ 统计/ 属性/ 的/ 研究/ 相比/ ,/ 采用/ 了/ 一个/ 新/ 的/ 角度/ ,/ 且/ 可以/ 忽略/ 由于/ 客户端/ 行为/ 差异/ 带来/ 的/ 影响/ ./ (/ 4/ )/ 对/ 加密/ Web/ 服务/ 泄漏/ 用户/ 访问/ 的/ 应用/ 类型/ 的/ 研究/ 基于/ 对/ 测量/ 结果/ 中/ 证书/ 属性/ 关联/ 分析/ 和/ 相似/ 度/ 度量/ ,/ 不/ 依赖/ 证书/ 本身/ 的/ 身份/ 标识/ (/ 比如/ 通用/ 名中/ 的/ mail/ 、/ proxy/ 和/ video/ 等/ 关键字/ )/ ,/ 对/ 加密/ 服务/ 中/ 的/ 典型/ 应用/ 发现/ 十分/ 有效/ ,/ 从而/ 揭示/ 出自/ 签名/ 证书/ 暴露/ 的/ 用户/ 网络/ 行为/ 隐私/ 问题/ ./ (/ 5/ )/ 通过/ 对/ 已有/ 海量/ 数据/ 的/ 学习/ ,/ 本/ 方法/ 可/ 应用/ 在/ 实时/ 环境/ 下/ ,/ 能/ 在/ 加密/ Web/ 应用/ 网络连接/ 的/ 早期/ 就/ 进行/ 类别/ 预测/ ,/ 与/ 基于/ 流/ 统计/ 属性/ 的/ 方法/ 相比/ 能/ 更/ 早/ 进行/ 结果/ 判断/ ,/ 尽早/ 尽快/ 满足要求/ ./ 本/ 方法/ 的/ 局限性/ 及/ 应对/ 方法/ :/ 自/ 签名/ 证书/ 的/ 随意/ 构造性/ ,/ 为/ 恶意/ 应用/ 进行/ 对抗/ 提供/ 了/ 便利/ ./ 特定/ 恶意软件/ (/ 如/ APT/ )/ 可能/ 采用/ 伪装/ 混淆/ 来/ 躲避/ 安全/ 审查/ 或者/ 误导/ 安全软件/ ./ 对于/ 此类/ 问题/ ,/ 我们/ 认为/ 需要/ 引入/ 基于/ 历史数据/ 的/ 对抗/ ,/ 从/ 更长/ 的/ 时间段/ 来/ 挖掘出/ 异常/ 行为/ ./ 本文/ HTTPS/ 行为/ 测量/ 研究/ 的/ 一个/ 方面/ ,/ 可以/ 扩展/ 深入/ ,/ 我们/ 进一步/ 的/ 研究/ 计划/ 如下/ :/ (/ 1/ )/ SSL/ 服务类型/ 实时/ 判定/ ./ 通过/ 已有/ 知识库/ 和/ 在线/ 学习/ 更新/ ,/ 对/ 特定/ SSL/ 服务/ 实时/ 准确/ 识别/ ./ (/ 2/ )/ 针对/ SSL/ 服务/ 常用/ 端口/ (/ 如/ 443/ 、/ 993/ 、/ 995/ )/ 的/ 非/ SSL/ 服务/ 的/ 分析/ ,/ 通过/ 简单/ 的/ 熵/ 值/ 及/ 浅度/ 包/ 检测/ 来/ 发现/ 和/ 识别/ 隐蔽/ 信道/ ,/ 比如/ 僵尸/ 网络/ 和/ 木马/ 信道/ ./ 本文/ 仅/ 侧重于/ 自/ 签名/ 证书/ 的/ 相关/ 研究/ ,/ 下/ 一步/ 可以/ 扩展/ 到/ 全部/ 类型/ SSL/ 证书/ 的/ 分析/ ./ 由于/ 采用/ SSL/ 的/ 服务/ 有/ 多种/ ,/ 而/ 相应/ 服务/ 未必/ 按照/ 标准/ 端口/ 部署/ ,/ 因此/ 更为/ 宽泛/ 端口/ 范围/ 的/ 测量/ 是/ 必要/ 的/ ,/ 也/ 是/ 其它/ SSL/ 测量/ 工作/ 所/ 没有/ 做/ 的/ ./ 同时/ ,/ 将/ SSL/ 证书/ 的/ 属性/ 与/ 其它/ 可/ 观察/ 到/ 的/ 统计/ 属性/ 结合/ 起来/ 从/ 服务器/ 和/ 客户端/ 的/ 网络安全/ 行为/ 来/ 研究/ 加密/ Web/ 服务/ 隐私/ 问题/ 可能/ 会/ 得到/ 更好/ 结果/ ./ 

