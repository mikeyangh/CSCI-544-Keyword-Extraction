Page1/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ 1/ )/ (/ 北京/ 交通/ 大学/ 计算机/ 与/ 信息技术/ 学院/ 北京/ 100044/ )/ 2/ )/ (/ 交通/ 数据分析/ 与/ 挖掘/ 北京市/ 重点/ 实验室/ 北京/ 100044/ )/ 3/ )/ (/ 西北大学/ 电子/ 工程/ 与/ 计算机系/ 埃文斯/ 顿/ 美国/ 60201/ )/ 摘要/ 时间/ 序列/ shapelets/ 是/ 序列/ 之中/ 最/ 具有/ 辨别/ 性/ 的/ 子/ 序列/ ./ 解决/ 时间/ 序列/ 分类/ 问题/ 的/ 有效途径/ 之一/ 是/ 通过/ shapelets/ 转换/ 技术/ ,/ 将/ 其/ 发现/ 与/ 分类器/ 的/ 构建/ 相/ 分离/ ,/ 其/ 主要/ 优点/ 是/ 优化/ 了/ shapelets/ 的/ 选择/ 过程/ 并/ 能够/ 灵活/ 应用/ 不同/ 的/ 分类/ 策略/ ./ 但此/ 方法/ 也/ 存在/ 不足/ ,/ 仅仅/ 简单/ 地/ 应用/ 这些/ shapelets/ 而/ 忽略/ 它们/ 之间/ 的/ 逻辑/ 组合/ 关系/ ,/ 有/ 可能/ 降低/ 分类/ 的/ 效果/ ;/ 另外/ ,/ 离线/ 式/ 的/ 发现/ shapelets/ 的/ 过程/ 是/ 相当/ 耗时/ 的/ ./ 文中/ 针对/ 后/ 一个/ 问题/ ,/ 采用/ 了/ 一种/ 基于/ 智能/ 缓存/ 的/ 计算/ 重用/ 技术/ ,/ 将/ 发现/ shapelets/ 的/ 时间/ 复杂度/ 降低/ 了/ 一个/ 数量级/ ./ 在/ 此基础/ 上/ ,/ 作者/ 提出/ 了/ 一种/ 基于/ 合取/ 或/ 析取/ 的/ 逻辑/ shapelets/ 转换方法/ ,/ 并/ 通过/ 在/ 多个/ 经典/ 的/ 基准/ 数据/ 集上/ 测试/ ,/ 表明/ 了/ 该/ 方法/ 能够/ 在/ 提升/ 分类/ 准确性/ 的/ 同时/ 保持/ shapelets/ 所/ 具有/ 的/ 解释/ 力/ ./ 关键词/ 时间/ 序列/ ;/ 分类/ ;/ shapelets/ ;/ 逻辑/ shapelets1/ 引言/ 一条/ 时间/ 序列/ 是/ 一组/ 序列/ 数据/ ,/ 它/ 通常/ 是/ 在/ 相等/ 间隔/ 的/ 时间段/ 内/ ,/ 依照/ 给定/ 的/ 采样率/ ,/ 对/ 某种/ 潜在/ 过程/ 进行/ 观测/ 的/ 结果/ ./ 时间/ 序列/ 数据/ 广泛/ 地/ 存在/ 于/ 商业/ 、/ 农业/ 、/ 气象/ 、/ 生物科学/ 等/ 诸多/ 领域/ ./ 在/ 时间/ 序列/ 分类/ 问题/ 中/ ,/ 我们/ 将/ 任意/ 实值/ 型/ 有/ 次序/ 的/ 数据/ 看作/ 一条/ 时间/ 序列/ [/ 1/ ]/ ./ 它/ 与/ 传统/ 分类/ 问题/ 之间/ 的/ 差别/ 在于/ ,/ 对于/ 传统/ 分类/ 问题/ 而言/ ,/ 属性/ 次序/ 是/ 不/ 重要/ 的/ ,/ 并且/ 变量/ 之间/ 的/ 相互/ 关系/ 独立/ 于/ 它们/ 的/ 相对/ 位置/ ;/ 而/ 对于/ 时间/ 序列/ 数据/ 而言/ ,/ 在/ 寻找/ 最佳/ 的/ 辨别/ 性/ 特征/ 时/ ,/ 变量/ 的/ 次序/ 起着/ 至关重要/ 的/ 作用/ [/ 2/ ]/ ./ 因此/ ,/ 时间/ 序列/ 分类/ 问题/ 已/ 成为/ 机器/ 学习/ 领域/ 的/ 特殊/ 挑战/ 之一/ ./ 在/ 过去/ 的/ 十多年/ 中/ ,/ 针对/ 时间/ 序列/ 分类/ 问题/ 的/ 研究/ 主要/ 集中/ 在/ 基于/ 不同/ 距离/ 度量/ 方式/ 的/ 最近/ 邻/ (/ 1/ -/ NN/ )/ 算法/ 上/ ,/ 如/ 基于/ 欧氏/ 距离/ 或者/ 动态/ 时间/ 规整/ (/ DynamicTimeWrapping/ ,/ DTW/ )/ 的/ 1/ -/ NN/ 等/ [/ 3/ -/ 4/ ]/ ./ 近年来/ ,/ 基于/ 时间/ 序列/ shapelets/ 的/ 分类/ 算法/ 引起/ 了/ 相关/ 研究者/ 极大/ 的/ 兴趣/ ./ 所谓/ 的/ 时间/ 序列/ shapelets/ 是/ 序列/ 之中/ 最/ 具有/ 辨别/ 性/ 的/ 子/ 序列/ [/ 5/ ]/ ./ 最初/ 的/ 基于/ shapelets/ 的/ 分类/ 算法/ 是/ 由/ Ye/ 等/ 人/ [/ 5/ -/ 6/ ]/ 所/ 提出/ 的/ ,/ 其/ 采用/ 信息/ 增益/ 度量/ 数据/ 的/ 分裂/ 点/ ,/ 并/ 通过/ 递归/ 搜索/ 最/ 具有/ 辨别/ 性/ 的/ shapelets/ 来/ 构建/ 决策树/ ./ 如图/ 1/ 所示/ ,/ 对于/ 经典/ 的/ Gun/ // NoGun/ (/ 手中/ 有枪/ // 没枪/ )/ 问题/ [/ 5/ ]/ ,/ 最佳/ shapelet/ 如/ 粗/ 黑线/ 标注/ 部分/ 所示/ ,/ 它/ 能够/ 对/ Gun/ // NoGun/ 数据/ 集/ 进行/ 准确/ 的/ 分类/ ./ Mueen/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 使用/ 逻辑/ shapelets/ 来/ 构建/ 决策树/ 的/ 思想/ ,/ 并/ 采用/ 加速/ 技术/ 和/ 剪枝/ 策略/ 来/ 提升/ 文献/ [/ 5/ ]/ 中/ 算法/ 的/ 可/ 解释性/ 和/ 运行/ 效率/ ./ Rakthanmanon/ 等/ 人/ [/ 8/ ]/ 针对/ 原有/ 的/ shapelets/ 发现/ 算法/ 在/ 时间/ 效率/ 上/ 的/ 不足/ ,/ 提出/ 了/ 一种/ 基于/ SAX/ (/ SymbolicAggregateapproXimation/ )/ 表示/ 的/ 快速/ shapelets/ 发现/ 算法/ ,/ 此/ 算法/ 在/ 提升/ 发现/ shapelets/ 速率/ 的/ 同时/ 保证/ 了/ 一定/ 的/ 分类/ 准确性/ ./ 相/ 比较/ 于/ 具有/ 较/ 高/ 分类/ 准确率/ 且/ 易于/ 实现/ 的/ 1/ -/ NN/ 分类器/ ,/ 时间/ 序列/ shapelets/ 的/ 优点/ 主要/ 在于/ 两个/ 方面/ ./ (/ 1/ )/ 分类/ 结果/ 的/ 可/ 解释性/ 更强/ ./ 原因/ 是/ 1/ -/ NN/ 分类器/ 只能/ 说明/ 被/ 分类/ 对象/ 与/ 所分/ 到/ 的/ 类别/ 间/ 具有/ 较大/ 的/ 相似性/ ,/ 但/ 没有/ 指出/ 它/ 与/ 其他/ 类别/ 之间/ 具体/ 的/ 不同点/ ,/ 而/ shapelets/ 可以/ 较为/ 充分/ 地/ 解释/ 各类/ 之间/ 的/ 差异/ (/ 如图/ 1/ 所示/ )/ ,/ 即/ 具有/ 较强/ 的/ 辨别/ 性/ ./ (/ 2/ )/ 分类/ 速度/ 更快/ ./ 首先/ ,/ 由于/ shapelets/ 比较/ 的/ 是/ 子/ 序列/ (/ 一般/ 情况/ 下比/ 原始/ 的/ 时间/ 序列/ 要/ 短/ )/ 之间/ 的/ 相似性/ ,/ 所以/ 不像/ 基于/ 实例/ 的/ 方法/ 那样/ 需要/ 对比/ 整个/ 数据/ 集/ ./ 其次/ ,/ shapelets/ 能够/ 非常/ 简洁/ 紧凑/ 地/ 表示/ 一个/ 类/ 的/ 概念/ ,/ 有时/ 我们/ 仅/ 需要/ 一个/ shapelet/ 就/ 可以/ 出色/ 地/ 完成/ 分类/ 任务/ ,/ 此/ 简洁性/ 意味着/ 分类/ 所/ 需要/ 的/ 时间/ 和/ 空间/ 大量/ 地/ 减少/ ,/ 所以/ shapelets/ 具有/ 较/ 快/ 的/ 分类/ 速度/ ./ 上述/ 的/ 几种/ 方法/ 都/ 是/ 在/ 发现/ shapelets/ 的/ 同时/ 构建/ 分类器/ ./ 而/ Bagnall/ 等/ 人/ [/ 2/ ]/ 强调/ 了/ 数据/ 转换/ 在/ 时间/ 序列/ 分类/ 中/ 的/ 重要性/ ,/ 其为/ 解决/ 数据/ 转换/ 后/ 可能/ 引起/ 的/ 准确率/ 大幅度/ 差异/ 问题/ ,/ 提出/ 了/ 一种/ 集成/ 学习/ 技术/ 来/ 提升/ 分类/ 性能/ ./ Lines/ 等/ 人/ [/ 1/ ]/ 提出/ 了/ 一种/ 基于/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 方法/ ,/ 即将/ shapelets/ 的/ 发现/ 与/ 分类器/ 的/ 构建/ 过程/ 相/ 分离/ ,/ 其/ 主要/ 优点/ 是/ 优化/ 了/ shapelets/ 的/ 选择/ 过程/ 并/ 能够/ 灵活/ 应用/ 不同/ 的/ 分类/ 策略/ ./ 另外/ ,/ shapelets/ 也/ 被/ 广泛应用/ 于/ 时间/ 序列/ 聚类/ [/ 9/ ]/ 、/ 早期/ 分类/ 问题/ [/ 10/ ]/ 和/ 姿势/ 辨别/ 问题/ [/ 11/ ]/ 等等/ ./ 尽管/ 基于/ 时间/ 序列/ shapelets/ 的/ 方法/ 是/ 目前/ 解决/ 时间/ 序列/ 分类/ 问题/ 的/ 有效途径/ 之一/ ,/ 它/ 仍/ 存在/ 着/ 许多/ 不足/ ./ 以/ Lines/ 等/ 人/ 提出/ 的/ 基于/ shapelets/ 转换/ 的/ 方法/ 为例/ ,/ 一是/ 仅仅/ 简单/ 地/ 应用/ 这些/ shapelets/ 而/ 忽略/ 它们/ 之间/ 的/ 逻辑/ 组合/ 关系/ ,/ 有/ 可能/ 降低/ 分类/ 的/ 效果/ ./ 如图/ 2/ 所示/ ,/ 单个/ shapelet/ 无法/ 对/ SonyAIBOPage3Robot/ 数据/ 集/ 进行/ 严格/ 区分/ ,/ 此时/ 需要/ 联合/ 多个/ shapelets/ ,/ 即/ 使用/ 逻辑/ shapelets/ 才能/ 准确/ 区分/ 两种/ 类别/ ;/ 二是/ 尽管/ 发现/ shapelets/ 的/ 过程/ 是/ 离线/ 计算/ 的/ ,/ 它/ 仍然/ 需要/ 消耗/ 大量/ 的/ 时间/ ./ 针对/ 上述/ 两点/ 不足/ ,/ 本文/ 的/ 主要/ 贡献/ 在于/ 两个/ 方面/ ./ 首先/ 是/ 应用/ 了/ 一种/ 基于/ 智能/ 存储/ 和/ 计算/ 重用/ 的/ 技术/ ,/ 将/ 发现/ shapelets/ 的/ 时间/ 复杂度/ 降低/ 了/ 一个/ 数量级/ ./ 其次/ ,/ 我们/ 在/ 此基础/ 上/ 提出/ 了/ 一种/ 基于/ 合取/ 或/ 析取/ 的/ 逻辑/ shapelets/ 转换方法/ ./ 具体做法/ 是/ 首先/ 找到/ k/ 个/ 最好/ 的/ 逻辑/ shapelets/ ,/ 然后/ 通过/ 计算/ 这些/ 逻辑/ shapelets/ 与/ 原有/ 时间/ 序列/ 间/ 的/ 距离/ ,/ 将/ 原有/ 时间/ 序列/ 转换成/ 新/ 的/ 拥有/ k/ 个/ 属性/ 的/ 数据/ ,/ 同时/ 也/ 把/ 时间/ 序列/ 分类/ 问题/ 转化成/ 了/ 传统/ 的/ 分类/ 问题/ ./ 此/ 方法/ 在/ 保持/ shapelets/ 的/ 解释/ 力/ 的/ 同时/ 提升/ 了/ 分类/ 的/ 准确性/ ./ 本文/ 第/ 2/ 节将/ 阐述/ 时间/ 序列/ 分类/ 问题/ 的/ 相关/ 定义/ 和/ 符号/ ;/ 在/ 第/ 3/ 节/ ,/ 将/ 回顾/ 一下/ 文献/ [/ 1/ ]/ 中/ 提出/ 的/ 算法/ ;/ 第/ 4/ 节将/ 阐述/ 本文/ 所/ 应用/ 的/ 加速/ 技术/ 以及/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ 的/ 基本/ 思想/ ;/ 在/ 第/ 5/ 节/ ,/ 本文/ 将/ 进行/ 实验/ 描述/ 并/ 评估所/ 提出/ 的/ 算法/ ;/ 第/ 6/ 节/ 进行/ 相应/ 的/ 总结/ 以及/ 对/ 进一步/ 工作/ 的/ 展望/ ./ 2/ 符号/ 与/ 定义/ 将/ 时间/ 序列/ 分类/ 问题/ 定义/ 为/ 从/ 一系列/ 标定/ 的/ 时间/ 序列/ 训练/ 集上/ 建造/ 分类器/ 的/ 过程/ ./ 假设/ 有/ n/ 条/ 时间/ 序列/ ,/ D/ =/ {/ T1/ ,/ T2/ ,/ …/ ,/ Tn/ }/ ,/ 每/ 一条/ 时间/ 序列/ 有/ m/ 个/ 观测/ 值/ 和/ 一个/ 类值/ ci/ ,/ 即/ Ti/ =/ 〈/ ti1/ ,/ ti2/ ,/ …/ ,/ tim/ ,/ ci/ 〉/ ./ 目标/ 是/ 构造/ 一个/ 将/ 时间/ 序列/ 的/ 观测/ 值/ 映射/ 到/ 类值/ 的/ 函数/ ./ 为/ 方便/ 起/ 见/ ,/ 假设/ 每/ 一条/ 时间/ 序列/ 具有/ 相同/ 数目/ 的/ 观测/ 值/ ./ 文中/ 涉及/ 的/ 主要/ 符号/ 如表/ 1/ 所示/ ./ T/ ,/ X/ ,/ Ydist/ (/ x/ ,/ y/ )/ subdist/ (/ x/ ,/ y/ )/ C/ (/ x/ ,/ y/ )/ μ/ x/ ,/ σ/ x/ ,/ μ/ y/ ,/ σ/ y/ 定义/ 1/ ./ 时间/ 序列/ 及其/ 子/ 序列/ ./ 时间/ 序列/ T/ 是/ 一条/ 长度/ 为/ m/ 的/ 实值/ 序列/ ,/ 可/ 表示/ 为/ t1/ ,/ t2/ ,/ …/ ,/ tm/ ./ 一条/ 时间/ 序列/ 的/ 子/ 序列/ Si/ ,/ l/ =/ ti/ ,/ ti/ +/ 1/ ,/ …/ ,/ ti/ +/ l/ -/ 1/ 是/ 一个/ T/ 中/ 从/ 位置/ i/ 开始/ 长度/ 为/ l/ 的/ 连续/ 的/ 子/ 序列/ ,/ 其中/ 1/ / l/ / m/ ,/ 1/ / i/ / m/ -/ l/ +/ 1/ ./ 注意/ ,/ 数据/ t1/ ,/ t2/ ,/ …/ ,/ tm/ 是/ 按照/ 时间/ 顺序排列/ 的/ ,/ 两/ 两/ 之间/ 具有/ 相同/ 的/ 时间/ 间隔/ ./ 时间/ 序列/ 的/ 子/ 序列/ 可以/ 当作/ 是/ 时间/ 序列/ 的/ 局部/ 特征/ ./ 假设/ 一条/ 时间/ 序列/ 的/ 长度/ 为/ m/ ,/ 其子/ 序列/ 的/ 最小/ 长度/ 为/ 1/ ,/ 最大/ 长度/ 为/ m/ ,/ 那么/ 它/ 能/ 有/ m/ (/ m/ +/ 1/ )/ // 2/ 个子/ 序列/ ./ 定义/ 2/ ./ 时间/ 序列/ 间/ 的/ 距离/ ./ 所有/ 的/ 分类/ 问题/ 都/ 依赖于/ 数据/ 间/ 的/ 相似性/ 度量/ ,/ 时间/ 序列/ 分类/ 问题/ 也/ 不/ 例外/ ./ 对于/ 给定/ 的/ 具有/ 相同/ 长度/ m/ 的/ 两条/ 时间/ 序列/ X/ 和/ Y/ ,/ 我们/ 可以/ 使用/ 规范化/ 的/ 欧氏/ 距离/ 来/ 度量/ 它们/ 之间/ 的/ 不同/ ./ 如式/ (/ 1/ )/ 所示/ ./ 注意/ ,/ 为/ 获得/ 两条/ 时间/ 序列/ 之间/ 距离/ 的/ 有效/ 比/ 对/ 并/ 保证/ 缩放/ 和/ 偏移/ 的/ 不变性/ ,/ 在/ 计算/ 真正/ 的/ 距离/ 之前/ ,/ 必须/ 使用/ z/ -/ 规范化/ 方法/ (/ 如式/ (/ 2/ )/ 所示/ )/ 对/ 每条/ 时间/ 序列/ 进行/ 规范化/ 处理/ [/ 12/ ]/ ./ 因为/ 缩放/ 和/ 偏移/ 上/ 甚至/ 是/ 一丁点/ 的/ 不同/ 都/ 有/ 可能/ 对/ 形状/ 的/ 相似性/ 比/ 对/ 造成/ 巨大/ 的/ 影响/ ,/ 所以/ 这是/ 至关重要/ 的/ 一步/ ./ 此处/ 珡/ X/ 为/ 时间/ 序列/ 观测/ 值/ 的/ 均值/ ,/ δ/ x/ 为/ 时间/ 序列/ 观测/ 值/ 的/ 标准差/ ,/ xnorm/ 为/ z/ -/ 规范化/ 后/ 的/ 时间/ 序列/ 观测/ 值/ ./ 从式/ (/ 1/ )/ 可以/ 得到/ ,/ 两条/ 时间/ 序列/ 间/ 距离/ 计算/ 的/ 复杂度/ 和/ 时间/ 序列/ 的/ 长度/ 呈/ 线性关系/ ./ 相比之下/ ,/ 将/ 采用/ 从/ X/ 和/ Y/ 推演/ 而/ 得到/ 的/ 5/ 个/ 数据/ 来/ 计算/ X/ 与/ Y/ 之间/ 的/ 规范化/ 欧氏/ 距离/ ,/ 这些/ 数据/ 被/ 称为/ 充分/ 统计/ 量/ (/ sufficientstatistics/ )/ [/ 7/ ,/ 13/ ]/ ./ 它们/ 分别/ 为/ ∑/ x/ ,/ ∑/ y/ ,/ ∑/ x2/ ,/ ∑/ y2/ 和/ ∑/ xy/ ./ 通过/ 使用/ 此/ 方式/ 计算/ 规范化/ 的/ 欧氏/ 距离/ ,/ 可以/ 重新/ 利用/ 计算/ 的/ 中间/ 结果/ 并/ 降低/ 计算/ 规范化/ 欧氏/ 距离/ 的/ 时间/ 复杂度/ ./ 本文/ 将/ 在/ 第/ 4/ 节/ 进行/ 具体/ 的/ 阐述/ ,/ 相应/ 的/ 计算公式/ 如下/ ./ 一条/ 时间/ 序列/ X/ 的/ 均值/ 和/ 方差/ 可以/ 通过/ 式/ (/ 3/ )/ 和/ (/ 4/ )/ 计算/ ./ X/ 与/ Y/ 之间/ 的/ 欧氏/ 距离/ 可以/ 通过/ 式/ (/ 5/ )/ 和/ (/ 6/ )/ 计算/ ./ Page4/ 许多/ 时间/ 序列/ 数据挖掘/ 算法/ (/ 如/ 1/ -/ NN/ 分类/ 、/ 聚类/ 算法/ 等/ )/ 只/ 需要/ 对比/ 相等/ 长度/ 的/ 时间/ 序列/ ./ 相比之下/ ,/ 时间/ 序列/ shapelets/ 需要/ 测试/ 一个/ 短/ 的/ 时间/ 序列/ (/ 即/ shapelet/ )/ 是否/ 在/ 某/ 一/ 特定/ 阈值/ 下/ 包含/ 于/ 一个/ 更长/ 的/ 时间/ 序列/ 中/ ./ 为/ 得到/ 此/ 结果/ ,/ 短/ 的/ 时间/ 序列/ 必须/ 在/ 长/ 的/ 序列/ 上/ 滑动/ 以/ 得到/ 它们/ 之间/ 的/ 最佳/ 比/ 对/ 结果/ ,/ 称此/ 距离/ 度量/ 为子/ 序列/ 距离/ ,/ 并/ 定义/ 为/ 或者/ 根据/ 充分/ 统计/ 量/ 可/ 表示/ 为/ sufficientdist/ (/ x/ ,/ y/ )/ =/ 2/ (/ 1/ -/ Cs/ (/ x/ ,/ y/ 这里/ X/ 与/ Y/ 是/ 两个/ 长度/ 分别/ 为/ m/ 和/ n/ 的/ 时间/ 序列/ (/ m/ / n/ )/ ,/ y/ |/ x/ |/ 表示/ 时间/ 序列/ Y/ 中/ 长度/ 为/ |/ x/ |/ 的/ 子/ 序列/ ./ 相应/ 地/ 在/ 上述/ 定义/ 中/ ,/ μ/ y/ 和/ δ/ y/ 分别/ 表示/ Y/ 中/ 从/ l/ +/ 1/ 位置/ 开始/ 的/ m/ 个/ 连续/ 值/ 的/ 均值/ 和/ 标准差/ ./ 注意/ ,/ subdist/ (/ )/ 和/ sufficientdist/ (/ )/ 得到/ 的/ 是/ 两个/ 序列/ 间/ 的/ 最/ 短距离/ ./ 定义/ 3/ ./ 熵/ ./ 假设/ 数据/ 集/ D/ 中/ 包含/ N/ 条/ 时间/ 序列/ ,/ 类/ 的/ 个数/ 为/ C/ ,/ 类/ ci/ 在/ 数据/ 集/ D/ 中有/ ni/ 个/ 实例/ ,/ 并且/ n1/ +/ n2/ +/ …/ +/ nC/ =/ N/ ./ 由于/ 本文/ 采用/ 信息/ 增益/ 度量/ 来/ 评价/ shapelets/ 的/ 辨别/ 能力/ ,/ 首先/ 需要/ 在/ 此/ 回顾/ 一下/ 熵/ 的/ 概念/ ./ 数据/ 集/ D/ 的/ 熵/ 定义/ 为/ 定义/ 4/ ./ 分裂/ 点/ ./ 一个/ 分裂/ 点为/ 一个/ 元组/ (/ s/ ,/ t/ )/ ,/ 这里/ s/ 表示/ 一个/ 子/ 序列/ ,/ t/ 表示/ 距离/ 的/ 阈值/ ./ 一个/ 分裂/ 点/ (/ s/ ,/ t/ )/ 将/ 数据/ 集/ D/ 分割/ 成/ 两个/ 不/ 相交/ 的/ 子集/ ,/ 其中/ Dleft/ =/ {/ x/ :/ x/ ∈/ D/ ,/ subdist/ (/ s/ ,/ x/ )/ / t/ }/ ,/ Dright/ =/ {/ x/ :/ x/ ∈/ D/ ,/ subdist/ (/ s/ ,/ x/ )/ >/ t/ }/ ,/ 并且/ N1/ =/ |/ Dleft/ |/ ,/ N2/ =/ |/ Dright/ |/ ./ 定义/ 5/ ./ 信息/ 增益/ ./ 一个/ 分裂/ 点/ (/ s/ ,/ t/ )/ 的/ 信息/ 增益/ 为/ I/ (/ s/ ,/ t/ )/ =/ E/ (/ D/ )/ -/ 定义/ 6/ ./ 分裂/ 间隔/ ./ 一个/ 分裂/ 点/ 的/ 分裂/ 间隔/ 为/ G/ (/ s/ ,/ t/ )/ =/ 即/ 为/ 分裂/ 点/ 右侧/ 实例/ 的/ 平均/ 距离/ 减去/ 分裂/ 点/ 左侧/ 实例/ 的/ 平均/ 距离/ ./ 定义/ 7/ ./ Shapelet/ ./ 数据/ 集/ D/ 中/ 的/ 一个/ shapelet/ 是/ 由/ D/ 中/ 某/ 一/ 实例/ T/ 的/ 一个/ 子/ 序列/ S/ 和/ 一个/ 分裂/ 点/ 的/ 阈值/ t/ 所/ 组成/ 的/ 元组/ (/ S/ ,/ t/ )/ ,/ 它/ 试图/ 将/ 数据/ 集/ D/ 分割/ 成/ 两个/ 不同/ 的/ 群组/ ./ 现在/ 将/ 用/ 图/ 3/ 所示/ 的/ 例子/ 来/ 解释/ shapelet/ 的/ 概念/ ./ 左边/ 方框/ 中是/ 一个/ 候选/ 的/ shapelet/ ,/ 右边/ 的/ orderline/ 记录/ 了/ 该/ 候选/ shapelet/ 与/ 数据/ 集/ D/ 中/ 每条/ 时间/ 序列/ 之间/ 的/ 距离/ ,/ t/ 为/ 最佳/ 的/ 分裂/ 阈值/ ./ 在/ 图/ 3/ 中/ ,/ 数据/ 集/ D/ 为/ 经典/ 的/ Gun/ // NoGun/ 数据/ 集/ ,/ 圆形/ 表示/ NoGun/ 类/ 时间/ 序列/ 与/ 候选/ shapelet/ 之间/ 的/ 距离/ ,/ 它们/ 与/ 候选/ shapelet/ 间/ 的/ 距离/ 较/ 小/ ;/ 矩形/ 表示/ Gun/ 类/ 时间/ 序列/ 与/ 候选/ shapelet/ 之间/ 的/ 距离/ ,/ 它们/ 与/ 候选/ shapelet/ 间/ 的/ 距离/ 较大/ ./ orderline/ 创建/ 之后/ ,/ 就/ 可以/ 计算/ 候选/ shapelet/ 的/ 分裂/ 点/ 、/ 分裂/ 间隔/ 以及/ 信息/ 增益/ 等/ ./ 最终/ 选取/ 最优/ 的/ 一个/ 或/ 多个/ shape/ -/ lets/ 进行/ 分类/ ./ 需要/ 注意/ 的/ 是/ ,/ 当/ 我们/ 对/ shapelets/ 排序/ 时/ ,/ 优先选择/ 信息/ 增益/ 较大/ 的/ shapelet/ ;/ 若/ 两个/ shapelet/ 的/ 信息/ 增益/ 相同/ ,/ 则/ 优先选择/ 分裂/ 间隔/ 较大/ 的/ shapelet/ ;/ 若/ 两者/ 的/ 分裂/ 间隔/ 也/ 相同/ ,/ 则/ 优先选择/ 长度/ 较/ 短/ 的/ shapelet/ ;/ 若/ 两者/ 长度/ 相等/ ,/ 则/ 优先选择/ 先/ 产生/ 的/ shapelet/ ./ 也就是说/ ,/ 使用/ 分裂/ 间隔/ 以及/ shapelet/ 的/ 长度/ 等/ 作为/ 打破/ 平局/ 的/ 方法/ ./ 3Shapelets/ 转换/ 技术/ Lines/ 等/ 人/ [/ 1/ ]/ 提出/ 了/ 一种/ 基于/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 方法/ ,/ 此/ 方法/ 的/ 主要/ 贡献/ 是/ 将/ shapelets/ 的/ 发现/ 与/ 分类器/ 的/ 构建/ 相/ 分离/ ,/ 避免/ 了/ 文献/ [/ 5/ ]/ 中/ 发现/ shapelets/ 时/ 贪心/ 的/ 递归/ 搜索/ 过程/ ,/ 并/ 允许/ 转换/ 后/ 的/ 数据/ 应用/ 于/ 不同/ 的/ 分类器/ 中/ ./ 相应/ 的/ 算法/ 实现/ 主要/ 包括/ 3/ 个/ 步骤/ :/ 首先/ ,/ 通过/ 一次/ 扫描/ 数据/ 集/ ,/ 找到/ 最好/ 的/ k/ 个/ shapelets/ ;/ 其次/ ,/ 将/ 每/ 一条/ 时间/ 序列/ 转/ Page5/ 换成/ 具有/ k/ 个/ 属性/ 的/ 实例/ ./ 即/ 让/ 每个/ 属性/ 代表/ 一个/ shapelet/ ,/ 属性/ 值为/ 该/ shapelet/ 与/ 时间/ 序列/ 间/ 的/ 距离/ ,/ 这样/ 就/ 创建/ 了/ 一个/ 新/ 的/ 转换/ 后/ 的/ 数据/ 集/ ;/ 最后/ ,/ 将/ 转换/ 后/ 的/ 数据/ 集/ 用于/ 贝叶斯/ 网络/ 、/ 决策树/ 、/ 1/ -/ NN/ 等/ 分类器/ 进行/ 分类/ ./ 具体/ 的/ 描述/ 见/ 算法/ 1/ ./ 算法/ 1/ ./ Shapelets/ 发现/ 算法/ ShapeletFilter/ (/ D/ ,/ min/ ,/ max/ ,/ k/ )/ ./ 输入/ :/ 时间/ 序列/ 数据/ 集/ D/ ,/ 最小/ 长度/ min/ ,/ 最大/ 长度/ 输出/ :/ k/ 个/ 最好/ 的/ shapeletskShapelets1/ ./ kShapelets/ ←/ / ;/ 2/ ./ FORi/ ←/ 0to/ |/ D/ |/ DO/ {/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ }/ 3/ ./ shapelets/ ←/ / ;/ 4/ ./ FORl/ ←/ mintomaxDO/ {/ Ti/ 中/ 的/ 每/ 一个/ 长度/ }/ 5/ ./ FORu/ ←/ 0to/ |/ Ti/ |/ -/ l/ +/ 1DO/ {/ 每/ 一个/ 起始/ 位置/ }/ 6/ ./ S/ ←/ Ti/ (/ u/ ,/ l/ )/ ;/ 7/ ./ FORm/ ←/ 0to/ |/ D/ |/ DO/ {/ 计算/ 候选/ shapeletS/ 与/ 8/ ./ Ds/ ←/ 狊/ 狌/ 犫/ 犱/ 犻/ 狊/ 狋/ (/ S/ ,/ Tm/ )/ ;/ 9/ ./ orderline/ ←/ sort/ (/ Ds/ )/ ;/ 10/ ./ quality/ ←/ assessCandidate/ (/ S/ ,/ orderline/ ,/ Ds/ )/ ;/ 11/ ./ shapelets/ ./ add/ (/ S/ ,/ quality/ )/ ;/ 12/ ./ sortByQuality/ (/ shapelets/ )/ ;/ 13/ ./ removeSelfSimilar/ (/ shapelets/ )/ ;/ 14/ ./ kShapelets/ ←/ merge/ (/ k/ ,/ kShapelets/ ,/ shapelets/ )/ ;/ 15/ ./ RETURNkShapelets/ ;/ 算法/ 1/ 描述/ 了/ 从/ 数据/ 集中/ 抽取/ k/ 个/ 最好/ 的/ shapelets/ 的/ 过程/ ./ 根据/ min/ 和/ max/ 参数设置/ 的/ 范围/ ,/ 每/ 一条/ 时间/ 序列/ 的/ 每/ 一种/ 可能/ 长度/ 的/ 子/ 序列/ 都/ 被/ 做/ 了/ 相应/ 的/ 评估/ ,/ 并/ 最终/ 得到/ 最好/ 的/ k/ 个/ shapelets/ ./ 初始/ 时/ kShapelets/ 为空/ (/ 第/ 1/ 行/ )/ ./ 得到/ 一个/ 候选/ 的/ shapelet/ 之后/ ,/ 需要/ 计算/ 该/ shapelet/ 与/ 每/ 一条/ 时间/ 序列/ 间/ 的/ 距离/ 并/ 构建/ orderline/ (/ 第/ 7/ ~/ 9/ 行/ )/ ./ 如/ 算法/ 描述/ 的/ 第/ 9/ ~/ 11/ 行/ 所示/ ,/ 得到/ 一个/ shapelet/ 的/ orderline/ 之后/ ,/ 将/ 对/ 其/ 评估/ 并/ 得到/ 它/ 的/ 最大/ 信息/ 增益/ ,/ 然后/ 将/ 其/ 加入/ 到/ 候选/ shapelets/ 中/ ./ 在/ 对/ 候选/ shapelets/ 进行/ 排序/ 时/ (/ 第/ 12/ 行/ )/ ,/ 主要/ 根据/ 其/ 信息/ 增益/ 的/ 大小/ 进行/ 排列/ ,/ 具体/ 打破/ 平局/ 的/ 方法/ 参见/ 第/ 2/ 节/ 定义/ 7/ ./ 若/ 两个/ shapelets/ 来自/ 同/ 一条/ 时间/ 序列/ 并/ 有/ 重叠/ 之/ 处/ ,/ 则/ 认为/ 它们/ 是/ 自/ 相似/ 的/ ,/ 此时/ 需要/ 移除/ 自/ 相似/ 的/ shapelets/ (/ 第/ 13/ 行/ )/ ./ 一旦/ 得到/ 一条/ 时间/ 序列/ 中/ 所有/ 不/ 相似/ 的/ shapelets/ ,/ 就/ 将/ 它们/ 和/ 现有/ 的/ 最好/ 的/ shapelets/ 相结合/ ,/ 并/ 保留/ 最好/ 的/ k/ 个/ (/ 第/ 14/ 行/ )/ ./ 候选/ shapelets/ 与/ 时间/ 序列/ 间/ 距离/ 的/ 计算方法/ 如/ 算法/ 2/ 所示/ ./ Shapelets/ 与/ 时间/ 序列/ 比/ 对/ 时/ ,/ 都/ 进行/ 了/ 规范化/ 处理/ (/ 第/ 2/ ,/ 5/ 行/ )/ ./ 需要/ 注意/ 的/ 是/ ,/ 在/ 计算/ 距离/ 之前/ 重复/ 地/ 进行/ 规范化/ 会/ 消耗/ 大量/ 的/ 时间/ ,/ 而且/ 同一个/ 序列/ 可能/ 会/ 被/ 规范化/ 多次/ ,/ 而/ 本文/ 将/ 在/ 4.1/ 节所/ 介绍/ 的/ 技术/ 成功/ 避免/ 了/ 这/ 一点/ ./ 算法/ 2/ ./ 规范化/ 子/ 序列/ 距离/ subdist/ (/ x/ ,/ y/ )/ ./ 输入/ :/ 时间/ 序列/ x/ 和/ y/ ,/ |/ x/ |/ / |/ y/ |/ 输出/ :/ x/ 与/ y/ 的/ 规范化/ 距离/ 1/ ./ bestSum/ ←/ MAX/ _/ VALUE/ ;/ 2/ ./ x/ ←/ zNorm/ (/ x/ )/ ;/ 3/ ./ FORi/ ←/ 0to/ |/ y/ |/ -/ |/ x/ |/ +/ 1DO/ {/ y/ 中/ 的/ 每/ 一个/ 起始/ 4/ ./ sum/ ←/ 0/ ;/ 5/ ./ z/ ←/ zNorm/ (/ yi/ ,/ |/ x/ |/ )/ ;/ 6/ ./ FORj/ ←/ 0to/ |/ x/ |/ DO/ {/ 计算/ 欧氏/ 距离/ }/ 7/ ./ sum/ ←/ sum/ +/ (/ zi/ -/ xi/ )/ 2/ ;/ 8/ ./ bestSum/ ←/ min/ (/ bestSum/ ,/ sum/ )/ ;/ 9/ ./ RETURN/ (/ bestSum/ // |/ x/ |/ )/ 1/ // 2/ ;/ 得到/ k/ 个/ 最好/ 的/ shapelets/ 之后/ ,/ 利用/ 它们/ 将/ 原有/ 的/ 时间/ 序列/ 转换成/ 新/ 的/ 数据/ 集/ 的/ 算法/ 描述/ 如/ 算法/ 3/ 所示/ ./ 算法/ 3/ ./ Shapelets/ 数据/ 转换/ TransformData/ (/ S/ ,/ D/ )/ ./ 输入/ :/ 最好/ 的/ k/ 个/ shapeletsS/ ,/ 数据/ 集/ D/ 输出/ :/ 转换/ 后/ 的/ 数据/ 集/ output1/ ./ output/ ←/ / ;/ 2/ ./ FORi/ ←/ 0to/ |/ D/ |/ DO/ {/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ }/ 3/ ./ transformed/ ←/ / ;/ 4/ ./ FORj/ ←/ 0to/ |/ S/ |/ DO/ {/ S/ 中/ 的/ 每/ 一个/ shapelet/ }/ 5/ ./ dist/ ←/ 狊/ 狌/ 犫/ 犱/ 犻/ 狊/ 狋/ (/ Sj/ ,/ Ti/ )/ ;/ 6/ ./ transformed/ ./ add/ (/ dist/ )/ ;/ 7/ ./ output/ ./ add/ (/ transformed/ )/ ;/ 8/ ./ RETURNoutput/ ;/ 对于/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ ,/ 它/ 的/ 子/ 序列/ 距离/ 通过/ 与/ Sj/ (/ j/ =/ 0/ ,/ …/ ,/ k/ -/ 1/ )/ 计算/ 得出/ (/ 第/ 2/ ~/ 5/ 行/ )/ ,/ 得到/ 的/ k/ 个/ 距离/ 用于/ 构建/ 转换/ 后/ 数据/ 集/ ,/ 即/ 新/ 的/ 数据/ 集中/ 每/ 一条/ 实例/ 具有/ k/ 个/ 属性/ ,/ 每/ 一个/ 属性/ 值/ 都/ 对应/ 于/ 相应/ 的/ shapelet/ 到/ 原始/ 时间/ 序列/ 的/ 距离/ (/ 第/ 6/ ~/ 7/ 行/ )/ ./ 4/ 加速/ 技术/ 与/ 逻辑/ shapelets/ 下面/ ,/ 将/ 首先/ 介绍/ 一种/ 更加/ 有效率/ 的/ 时间/ 序列/ 间/ 距离/ 的/ 计算方法/ [/ 7/ ,/ 13/ ]/ ,/ 然后/ 阐述/ 逻辑/ shapelets/ 转换/ 的/ 基本/ 思想/ ,/ 并/ 给出/ 具体/ 的/ 算法/ 描述/ ./ 4.1/ 充分/ 统计/ 量/ 在/ 第/ 3/ 节所/ 描述/ 的/ 算法/ 中/ ,/ 对于/ 数据/ 集/ D/ 中/ 的/ 任意/ 一条/ 时间/ 序列/ Dx/ ,/ Dx/ 中起/ 始于/ 任何/ 位置/ 的/ 任意/ 长度/ 的/ 子/ 序列/ Si/ 都/ 可能/ 是/ 一个/ 候选/ 的/ shapelet/ ./ Page6/ 当/ 计算/ Si/ 与/ 其他/ 时间/ 序列/ 如/ Dy/ 之间/ 的/ 距离/ 时/ ,/ 需要/ 将/ Si/ 在/ Dy/ 上/ 逐步/ 滑动/ 来/ 找到/ 最小/ 的/ 距离/ ./ 如图/ 4/ 所示/ ,/ 对于/ 数据/ 集/ D/ 中/ 的/ 任意/ 两条/ 实例/ Dx/ 和/ Dy/ ,/ S1/ 和/ S2/ 均/ 为/ 长度/ 为/ l/ 的/ 子/ 序列/ ,/ 若/ 要/ 计算/ S1/ 与/ S2/ 之间/ 的/ 距离/ ,/ 首先/ 需要/ 对/ S1/ 与/ S2/ 进行/ 规范化/ 处理/ ,/ 然后/ 计算/ S1/ 与/ S2/ 中/ 每/ 一对/ 实值间/ 的/ 距离/ 并取/ 和/ ./ 显然/ ,/ 当/ S1/ 与/ S2/ 的/ 长度/ 和/ 起始/ 位置/ 不断/ 变化/ 时/ (/ 图/ 4/ 中/ 的/ 虚线/ 所示/ )/ ,/ 会/ 造成/ 许多/ 重复/ 的/ 冗余/ 的/ 计算/ ,/ 若/ 能够/ 将/ 这些/ 计算/ 的/ 中间/ 结果/ 存储/ 起来/ ,/ 等/ 需要/ 的/ 时候/ 直接/ 提取/ 出来/ ,/ 运算/ 效率/ 会/ 得到/ 明显/ 的/ 提升/ ,/ 充分/ 统计/ 量/ 方法/ 恰恰/ 做到/ 了/ 这/ 一点/ ./ 针对/ 每/ 一对/ 时间/ 序列/ (/ Dx/ ,/ Dy/ )/ ,/ 可以/ 计算/ 5/ 个/ 数组/ ,/ M/ ,/ Sx/ ,/ Sy/ ,/ Sx2/ 和/ Sy2/ ./ 其中/ 数组/ Sx/ ,/ Sy/ 用于/ 存储/ 时间/ 序列/ Dx/ 和/ Dy/ 中/ 观测/ 值/ 的/ 累加/ 和/ ,/ 即/ ∑/ x/ ,/ ∑/ y/ ;/ 数组/ Sx2/ 和/ Sy2/ 用于/ 存储/ Dx/ 和/ Dy/ 中/ 观测/ 值/ 平方/ 的/ 累加/ 和/ ,/ 即/ ∑/ x2/ ,/ ∑/ y2/ ./ M/ 是/ 一个/ 用于/ 存储/ Dx/ 和/ Dy/ 中/ 不同/ 子/ 序列/ 的/ 乘积/ 和/ ∑/ xy/ 的/ 二维/ 数组/ ./ 初始/ 时/ ,/ 所有/ 的/ 数组/ 都/ 被/ 初始化/ 为/ 0/ ,/ 具体/ 表示/ 如下/ :/ 在/ 式/ (/ 17/ )/ 中/ ,/ t/ =/ |/ u/ -/ v/ |/ ,/ u/ 和/ v/ 分别/ 为/ Dx/ 和/ Dy/ 中子/ 序列/ 的/ 起始/ 位置/ ./ 这/ 5/ 个/ 数组/ 并/ 称为/ Statsx/ ,/ y/ ./ 当/ 计算/ 过/ Statsx/ ,/ y/ 之后/ ,/ 首先/ 根据/ 它/ 得到/ 序列/ 的/ 均值/ 与/ 方差/ ,/ 然后/ 根据/ 式/ (/ 5/ )/ 和/ (/ 6/ )/ 计算/ 得到/ 规范化/ 的/ 欧氏/ 距离/ ./ 具体/ 的/ 算法/ 描述/ 如/ 算法/ 4/ 所示/ ,/ 均值/ 、/ 方差/ 以及/ 任意/ 长度/ 子/ 序列/ 乘积/ 和/ 的/ 计算/ 如下/ 所示/ ./ l/ -/ 1xu/ +/ iyv/ +/ i/ =/ M/ [/ u/ +/ l/ -/ 1/ ,/ v/ +/ l/ -/ 1/ ]/ -/ M/ [/ u/ -/ 1/ ,/ v/ -/ 1/ ]/ ∑/ i/ =/ 0/ 算法/ 4/ ./ 规范化/ 子/ 序列/ 距离/ sufficientdist/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ ./ 输入/ :/ 起始/ 位置/ u/ ,/ 长度/ l/ ,/ x/ 与/ y/ 的/ 充分/ 统计/ 量/ Statsx/ ,/ y/ 输出/ :/ xu/ ,/ l/ 与/ y/ 的/ 规范化/ 子/ 序列/ 距离/ 1/ ./ bestSum/ ←/ MAX/ _/ VALUE/ ;/ 2/ ./ {/ M/ ,/ Sx/ ,/ Sy/ ,/ S23/ ./ FORi/ ←/ 0to/ |/ y/ |/ -/ |/ x/ |/ +/ 1DO/ {/ y/ 中/ 的/ 每/ 一个/ 起始/ 4/ ./ d/ ←/ 由式/ (/ 5/ )/ 和/ (/ 6/ )/ 所/ 得到/ 的/ 距离/ ;/ 5/ ./ bestSum/ ←/ min/ (/ bestSum/ ,/ d/ )/ ;/ 6/ ./ RETURN/ (/ bestSum/ // |/ x/ |/ )/ 1/ // 2/ ;/ 在/ 算法/ sufficientdist/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ 中/ ,/ 输入/ 为/ 时间/ 序列/ Dx/ 中/ 某/ 一子/ 序列/ 的/ 起始/ 位置/ u/ 、/ 长度/ l/ 以及/ 事先/ 计算/ 好/ 的/ Statsx/ ,/ y/ ,/ 输出/ 为子/ 序列/ 通过/ 不断/ 地/ 滑动/ 而/ 得到/ 的/ 与/ Dy/ 间/ 的/ 最小/ 距离/ ./ 通过/ 与/ 算法/ 2/ 比较/ 可以/ 得出/ ,/ subdist/ (/ x/ ,/ y/ )/ 在/ 计算/ 规范化/ 的/ 子/ 序列/ 距离/ 时/ ,/ 最坏/ 情况/ 下/ 的/ 时间/ 复杂度/ 为/ O/ (/ m2/ )/ ,/ 而/ 充分/ 统计/ 量/ 的/ 计算方法/ 省略/ 了/ 内部/ 的/ for/ 循环/ ,/ 即/ 只/ 需要/ O/ (/ m/ )/ 的/ 时间/ 复杂度/ ./ 所以/ ,/ 依据/ sufficientdist/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ ,/ 将/ 获取/ 子/ 序列/ 距离/ 的/ 时间/ 复杂度/ 降低/ 了/ 一个/ 数量级/ ./ 由于/ 发现/ shapelets/ 时/ 需要/ 计算/ 每/ 一个/ 候选/ shapeletS/ 与/ 每/ 一条/ 时间/ 序列/ T/ 之间/ 的/ 子/ 序列/ 的/ 距离/ ,/ 所以/ 同时/ 也/ 将/ 发现/ shapelets/ 的/ 时间/ 复杂度/ 降低/ 了/ 一个/ 数量级/ ./ 4.2/ 逻辑/ shapalets/ 一个/ shapelet/ 是/ 由/ 数据/ 集/ D/ 中/ 某/ 一/ 实例/ 的/ 一个/ 子/ 序列/ S/ 和/ 一个/ 分裂/ 点/ 阈值/ t/ 所/ 组成/ 的/ 元组/ (/ S/ ,/ t/ )/ ./ 很/ 容易/ 想到/ 单个/ shapelet/ 不足以/ 区分/ 不同/ 的/ 类别/ 的/ 情景/ ./ 如图/ 5/ 所示/ ,/ 采用/ 一个/ 简单/ 的/ 人造/ 的/ 例子/ 来/ 进行/ 说明/ ./ 数据/ 集/ D/ 中/ 包含/ 两类/ 时间/ 序列/ ,/ A/ 类/ 时间/ 序列/ 既/ 包含/ 波峰/ 又/ 包含/ 波谷/ ,/ B/ 类/ 时间/ 序列/ 只/ 包含/ 波峰/ 或/ 波谷/ ./ 假设/ shapeletsS1/ ,/ S2/ ,/ S3/ 的/ 分裂/ 阈值/ 分别/ 为/ t1/ ,/ t2/ ,/ t3/ ,/ 从而/ 可以/ 观察/ 到/ ,/ (/ S1/ ,/ t1/ )/ ,/ (/ S2/ ,/ t2/ )/ ,/ (/ S3/ ,/ t3/ )/ 都/ 不能/ 很/ 好/ 地/ 将/ A/ ,/ B/ 类/ 区分/ 开/ ./ 当/ 将/ (/ S1/ ,/ t1/ )/ 和/ (/ S2/ ,/ t2/ )/ 联合/ 起来/ 时/ ,/ 可以/ 发现/ ,/ A/ 类/ 和/ B/ 类/ 被/ 明/ Page7/ 显/ 地区/ 分/ 了/ ./ 因此/ ,/ 为/ 达到/ 最好/ 的/ 区分/ 效果/ ,/ 考虑/ 将/ 逻辑/ 操作/ 增加/ 到/ shapelets/ 的/ 转换/ 中/ ./ 图/ 5/ 单个/ shapelet/ 无法/ 区分/ 不同/ 类别/ 的/ 例子/ 图/ 5/ 中/ 所示/ 的/ 逻辑/ 操作/ 是/ 合取/ 操作/ ,/ 用/ 符号/ “/ ∧/ ”/ 表示/ ,/ 即/ (/ S1/ ,/ t1/ )/ ∧/ (/ S2/ ,/ t2/ )/ ,/ 同样/ 析取/ 操作/ 用/ 符号/ “/ ∨/ ”/ 表示/ ./ 当/ 将/ 逻辑/ 操作/ 加入/ 到/ shapelets/ 的/ 发现/ 过程/ 中/ 之后/ ,/ 有/ 可能/ 出现/ (/ S1/ ,/ t1/ )/ ∨/ (/ S2/ ,/ t2/ )/ ∧/ (/ S3/ ,/ t3/ )/ 这样/ 一种/ 析取/ 操作/ 与/ 合取/ 操作/ 同时/ 出现/ 的/ 情况/ ,/ 为/ 保持/ 逻辑/ 操作/ 的/ 简洁性/ ,/ 本文/ 只/ 考虑/ 两种/ 情况/ ,/ 一种/ 情况/ 是/ 只有/ 合取/ 操作/ ,/ 另/ 一种/ 是/ 只有/ 析取/ 操作/ ./ 具体/ 定义/ 如下/ ./ 定义/ 8/ ./ 逻辑/ shapelets/ ./ 数据/ 集/ D/ 中/ 的/ 一个/ 逻辑/ shapelets/ 是/ 一个/ 元组/ ,/ 由/ D/ 中/ 一个/ 或/ 多个/ 实例/ 的/ 多个/ 子/ 序列/ 所/ 组成/ ,/ 同时/ 包含/ 一个/ 分裂/ 点/ 阈值/ t/ 以及/ 一个/ 逻辑/ 操作/ 标识/ opt/ (/ opt/ 大于/ 等于/ 0/ 为/ 合取/ 操作/ ,/ 小于/ 0/ 为/ 析取/ 操作/ )/ ,/ 它/ 试图/ 将/ 数据/ 集/ D/ 分割/ 成/ 两个/ 不同/ 的/ 群组/ ./ 其/ 可/ 表示/ 为/ (/ 〈/ S1/ ,/ S2/ ,/ …/ ,/ Sn/ 〉/ ,/ t/ ,/ opt/ )/ ,/ n/ (/ n/ / 2/ )/ 为/ 逻辑/ shapelets/ 中所/ 包含/ 经典/ shapelet/ 的/ 个数/ ,/ 并且/ S1/ ,/ S2/ ,/ …/ ,/ Sn/ 相互之间/ 不/ 重叠/ ./ 4.3/ 发现/ 逻辑/ shapelets/ 发现/ k/ 个/ 最好/ 的/ 逻辑/ shapelets/ 的/ 算法/ 如/ 算法/ 5/ 所示/ ./ 与/ 算法/ 1/ 相/ 比较/ 可以/ 发现/ ,/ 两者/ 的/ 前半部/ 分/ 基本相同/ ,/ 但/ 本文/ 在/ 寻找/ 逻辑/ shapelets/ 时/ 采用/ 了/ 充分/ 统计/ 量/ 技术/ (/ 第/ 5/ ~/ 12/ 行/ )/ ./ 注意/ ,/ 文献/ [/ 7/ ]/ 中/ 使用/ 充分/ 统计/ 量/ 来/ 递归/ 地/ 发现/ 当前/ 最好/ 的/ shapelets/ ,/ 而/ 本文/ 直接/ 用/ 其来/ 发现/ k/ 个/ 最好/ 的/ 逻辑/ shapelets/ ./ 另外/ ,/ 如/ 第/ 13/ ~/ 16/ 行/ 所示/ ,/ 每/ 找到/ 一个/ 候选/ shapelet/ ,/ 都/ 对/ 它/ 进行/ 评估/ ,/ 并/ 调用/ LogicalShapeletsCache/ (/ )/ 函数/ 来/ 寻找/ 是否/ 有/ 其他/ shapelet/ 能够/ 与/ 当前/ shapelet/ 相/ 联合/ ,/ 从而/ 提高/ 它/ 的/ 信息/ 增益/ 以及/ 辨别力/ ./ 当/ 一条/ 时间/ 序列/ 中/ 的/ 所有/ 逻辑/ shapelets/ 都/ 被/ 评估/ 之后/ ,/ 调用/ sortByQuality/ (/ )/ 函数/ 进行/ 排序/ (/ 第/ 18/ 行/ )/ ,/ 排序/ 方法/ 与/ 定义/ 7/ 中/ 介绍/ 的/ 相一致/ ,/ 然后/ 移除/ 自/ 相似/ 的/ 逻辑/ shapelets/ (/ 第/ 19/ 行/ )/ ./ 若/ 两个/ 逻辑/ shapelets/ 中/ 存在/ 来自/ 同/ 一条/ 时间/ 序列/ 并/ 有/ 重叠/ 之处/ 的/ shapelets/ ,/ 则/ 认为/ 它们/ 是/ 自/ 相似/ 的/ ./ 自/ 相似/ 的/ 逻辑/ shapelets/ 中/ 排序/ 靠/ 后者/ 将/ 被/ 移/ 除掉/ ./ 一旦/ 得到/ 一条/ 时间/ 序列/ 中/ 所有/ 非自/ 相似/ 的/ 逻辑/ shapelets/ ,/ 就/ 将/ 它们/ 和/ 当前/ 最好/ 的/ 逻辑/ shapelets/ 相结合/ ,/ 并/ 保留/ 当前/ 最好/ 的/ k/ 个/ (/ 第/ 20/ 行/ )/ ./ 注意/ 当/ 调用/ mergelogical/ (/ )/ 函数/ 时/ ,/ 仍/ 需要/ 进行/ 自/ 相似性/ 检测/ ,/ 因为/ 不同/ 时间/ 序列/ 的/ 子/ 序列/ 有/ 可能/ 合取/ 或/ 析取/ 同一/ 子/ 序列/ ./ 算法/ 5/ ./ 发现/ 逻辑/ shapeletsLogicalShapelet/ -/ Filter/ (/ D/ ,/ min/ ,/ max/ ,/ k/ )/ ./ 输入/ :/ 时间/ 序列/ 数据/ 集/ D/ ,/ 最小/ 长度/ min/ ,/ 最大/ 长度/ 输出/ :/ k/ 个/ 最好/ 的/ 逻辑/ shapeletskLGShapelets1/ ./ kLGShapelets/ ←/ / ;/ 2/ ./ FORi/ ←/ 0to/ |/ D/ |/ DO/ {/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ }/ 3/ ./ logicalshapelets/ ←/ / ;/ 4/ ./ tempLGShapelets/ ←/ / ;/ 5/ ./ x/ ←/ Ti/ ;/ 6/ ./ FORj/ ←/ 0to/ |/ D/ |/ DO/ {/ 计算/ x/ 与/ Tj/ 的/ 充分/ 统计/ 量/ }/ 7/ ./ y/ ←/ Tj/ ;/ 8/ ./ Statsx/ ,/ y/ ←/ {/ M/ ,/ Sx/ ,/ Sy/ ,/ S29/ ./ FORl/ ←/ mintomaxDO/ {/ 每/ 一个/ 可能/ 的/ 长度/ }/ 10/ ./ FORu/ ←/ 0to/ |/ Ti/ |/ -/ l/ +/ 1DO/ {/ 每/ 一个/ 起始/ 位置/ }/ 11/ ./ FORm/ ←/ 0to/ |/ D/ |/ DO/ {/ 计算/ 候选/ shapeletS/ 与/ 12/ ./ Ds/ ←/ 狊/ 狌/ 犳/ 犳/ 犻/ 犮/ 犻/ 犲/ 狀/ 狋/ 犱/ 犻/ 狊/ 狋/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ ;/ 13/ ./ orderline/ ←/ sort/ (/ Ds/ )/ ;/ 14/ ./ quality/ ←/ assessCandidate/ (/ S/ ,/ orderline/ ,/ Ds/ )/ ;/ 15/ ./ tempLGShapelets/ ./ add/ (/ S/ )/ ;/ 16/ ./ tempLGShapelets/ ←/ 犔/ 狅/ 犵/ 犻/ 犮/ 犪/ 犾/ 犛/ 犺/ 犪/ 狆/ 犲/ 犾/ 犲/ 狋/ 狊/ 犆/ 犪/ 犮/ 犺/ 犲/ (/ D/ ,/ 17/ ./ logicalshapelets/ ./ add/ (/ tempLGShapelets/ )/ ;/ 18/ ./ sortByQuality/ (/ logicalshapelets/ )/ ;/ 19/ ./ removeSelfSimilarlogical/ (/ logicalshapelets/ )/ ;/ 20/ ./ kLGShapelets/ ←/ mergelogical/ (/ k/ ,/ kLGShapelets/ ,/ 21/ ./ RETURNkLGShapelets/ ;/ 获取/ 逻辑/ shapelets/ 的/ 算法/ 如/ 算法/ 6/ 所示/ ./ 此/ 算法/ 是/ 一个/ 递归/ 算法/ ,/ 当/ 逻辑/ shapelets/ 中/ shapelet/ 的/ 数目/ 超过/ 阈值/ n/ 或者/ 找/ 不到/ 比/ 当前/ shapelet/ // 逻辑/ shapelets/ 更好/ 的/ 逻辑/ shapelets/ 时/ ,/ 递归/ 循环/ 终止/ (/ 第/ 1/ ~/ 3/ 行/ ,/ 18/ ~/ 25/ 行/ )/ ,/ 所以/ 此/ 算法/ 得到/ 的/ 是/ 合取/ 或/ 析取/ 后/ 能够/ 使/ 当前/ shapelet/ // 逻辑/ shapelets/ 的/ 信息/ 增益/ 最大/ 的/ 子/ 序列/ ./ 本文/ 仍/ 采用/ 充分/ 统计/ 量/ 来计/ Page8/ 算子/ 序列/ 距离/ (/ 第/ 6/ ~/ 8/ 行/ )/ ./ 若/ 一个/ 候选/ shapeletS/ 与/ LogicalShapelets/ 是/ 自/ 相似/ 的/ ,/ 则/ 不再/ 访问/ 此/ shapelet/ (/ 第/ 9/ ~/ 12/ 行/ )/ ./ 当/ 得到/ 一个/ 候选/ shapelet/ 的/ orderline/ 之后/ ,/ 需要/ 将/ 此/ 候选/ shapelet/ 的/ orderline/ 与/ 当前/ shapelet/ // 逻辑/ shapelets/ 的/ orderline/ 相结合/ ,/ 构建/ 逻辑/ shapelets/ 的/ orderline/ (/ 第/ 15/ ~/ 16/ 行/ )/ ./ 但/ 对于/ 逻辑/ shapelets/ 中/ 的/ 合取/ 与/ 析取/ 操作/ ,/ 怎么/ 定义/ 它/ 的/ orderline/ 呢/ ?/ 如/ 第/ 16/ 行/ 所示/ ,/ 这里/ 采用/ 一种/ 比较简单/ 的/ 方式/ 来/ 联合/ 各个/ shapelet/ 的/ orderline/ ,/ 从而/ 组成/ 逻辑/ shapelets/ 的/ orderline/ ./ 对于/ “/ ∧/ ”/ 操作/ ,/ 各个/ shapelet/ 的/ orderline/ 上/ 相应/ 实例/ 的/ 最大/ 距离/ 将/ 被/ 当做/ 新/ 的/ orderline/ 上/ 的/ 距离/ ;/ 而/ 对于/ “/ ∨/ ”/ 操作/ ,/ 则/ 选择/ 最小/ 的/ 距离/ ./ 注意/ ,/ 这些/ 操作/ 并/ 不/ 影响/ 熵/ 和/ 信息/ 增益/ 的/ 计算/ ./ 算法/ 6/ ./ 获取/ 逻辑/ shapeletsLogicalShapelets/ -/ Cache/ (/ D/ ,/ min/ ,/ max/ ,/ n/ ,/ lgshapelet/ ,/ orderline/ )/ ./ 输入/ :/ 时间/ 序列/ 数据/ 集/ D/ ,/ 最小/ 长度/ min/ ,/ 最大/ 长度/ max/ ,/ 输出/ :/ 逻辑/ shapeletsLogicalShapelets1/ ./ LogicalShapelets/ ←/ lgshapelet/ ;/ 2/ ./ IFn/ / LogicalShapelets/ ./ size/ (/ )/ 3/ ./ RETURNLogicalShapelets/ ;/ 4/ ./ BestQuality/ ←/ lgshapelet/ ./ quality/ ;/ 5/ ./ tempLGShapelets/ ←/ / ;/ 6/ ./ FORi/ ←/ 0to/ |/ D/ |/ DO/ {/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ }/ 7/ ./ FORj/ ←/ 0to/ |/ D/ |/ DO/ {/ 计算/ Ti/ 与/ Tj/ 的/ 充分/ 统计/ 量/ }/ 8/ ./ Statsx/ ,/ y/ ←/ {/ M/ ,/ Sx/ ,/ Sy/ ,/ S29/ ./ FORl/ ←/ mintomaxDO/ {/ 每/ 一个/ 可能/ 的/ 长度/ }/ 10/ ./ FORu/ ←/ 0to/ |/ Ti/ |/ -/ l/ +/ 1DO/ {/ 每/ 一个/ 起始/ 位置/ }/ 11/ ./ IFselfSimilaritylogical/ (/ LogicalShapelets/ ,/ S/ )/ 12/ ./ CONTINUE/ ;/ 13/ ./ FORm/ ←/ 0to/ |/ D/ |/ DO/ {/ 计算/ 候选/ shapeletS/ 与/ 14/ ./ Ds/ ←/ 狊/ 狌/ 犳/ 犳/ 犻/ 犮/ 犻/ 犲/ 狀/ 狋/ 犱/ 犻/ 狊/ 狋/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ ;/ 15/ ./ lgorderline/ ←/ sort/ (/ Ds/ )/ ;/ 16/ ./ orderline/ ←/ mergeTwoLines/ (/ lgorderline/ ,/ 17/ ./ quality/ ←/ assessCandidate/ (/ S/ ,/ orderline/ ,/ Ds/ )/ ;/ 18/ ./ IFquality/ ./ betterthan/ (/ BestQuality/ )/ 19/ ./ tempLGShapelets/ ←/ lgshapelet/ ;/ 20/ ./ tempLGShapelets/ ./ add/ (/ S/ )/ ;/ 21/ ./ BestQuality/ ←/ quality/ ;/ 22/ ./ LogicalShapelets/ ←/ tempLGShapelets/ ;/ 23/ ./ IFLogicalShapelets/ ./ size/ (/ )/ </ n24/ ./ LogicalShapelets/ ←/ 犔/ 狅/ 犵/ 犻/ 犮/ 犪/ 犾/ 犛/ 犺/ 犪/ 狆/ 犲/ 犾/ 犲/ 狋/ 狊/ 犆/ 犪/ 犮/ 犺/ 犲/ (/ D/ ,/ 25/ ./ RETURNLogicalShapelets/ ;/ 另外/ ,/ 采用/ 逻辑/ shapelets/ 进行/ 时间/ 序列/ 转换/ 时有/ 可能/ 发生/ 过/ 拟合/ 现象/ ./ 若/ 所/ 发现/ 的/ 逻辑/ shapelets/ 为/ (/ S1/ ,/ t1/ )/ ∨/ (/ S2/ ,/ t2/ )/ ∨/ …/ ∨/ (/ Sn/ ,/ tn/ )/ ,/ 其中/ n/ 为/ 数据/ 集/ D/ 中/ 某/ 一类/ 时间/ 序列/ (/ 如/ A/ )/ 的/ 实例/ 个数/ ,/ Si/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 为类/ A/ 中/ 不同/ 实例/ 的/ 子/ 序列/ ./ 此时/ ,/ 在/ 数据/ 转换/ 之后/ 所有/ 类标/ 为/ A/ 的/ 实例/ 与/ 此/ 逻辑/ shapelets/ 所/ 对应/ 的/ 属性/ 值均/ 为/ 0/ ,/ 并且/ 抽取/ 的/ 逻辑/ shapelets/ 的/ 数量/ 和/ 质量/ 也/ 会/ 因此/ 而/ 降低/ (/ 小于/ k/ )/ ,/ 进而/ 降低/ 分类/ 的/ 准确性/ ./ 为/ 避免/ 过/ 拟合/ 现象/ ,/ 一般/ 情况/ 下/ ,/ 将/ 逻辑/ shapelets/ 中/ 经典/ shapelet/ 的/ 数量/ 设置/ 为/ 2/ ,/ 并/ 根据/ 数据/ 集/ 的/ 大小/ 进行/ 不断/ 调整/ ,/ 最大/ 数量/ 硬性规定/ 为/ 5.4/ ./ 4/ 转换/ 时间/ 序列/ 采用/ 逻辑/ shapelets/ 转换/ 的/ 主要/ 动机/ 之一/ 是/ 为了/ 将/ 时间/ 序列/ 分类/ 问题/ 应用/ 于/ 传统/ 的/ 分类/ 算法/ 上/ ./ 当/ 抽取/ k/ 个/ 逻辑/ shapelets/ 之后/ ,/ 将/ 对/ 初始/ 数据/ 集/ 进行/ 基于/ 逻辑/ shapelets/ 的/ 时间/ 序列/ 转换/ ,/ 数据/ 集中/ 的/ 每/ 一条/ 时间/ 序列/ 被/ 转换成/ 拥有/ k/ 个/ 属性/ 的/ 实例/ ,/ 每个/ 属性/ 的/ 值/ 对应/ 于/ 该/ 时间/ 序列/ 与/ 逻辑/ shapelets/ 之间/ 的/ 距离/ ./ 如/ 算法/ 7/ 所示/ ,/ 距离/ 的/ 计算/ 采用/ 了/ 4.1/ 节所/ 描述/ 的/ 充分/ 统计/ 量/ 技术/ (/ 第/ 7/ 、/ 9/ 行/ )/ ,/ 当/ 逻辑/ 操作/ 标识/ opt/ 大于/ 等于/ 0/ 时/ ,/ 表示/ 合取/ 操作/ ,/ 此时/ 需/ 计算/ 逻辑/ shapelets/ 中/ 每/ 一个/ shapelet/ 与/ 当前/ 时间/ 序列/ 间/ 的/ 距离/ ,/ 并取/ 最大者/ 作为/ 转换/ 后/ 实例/ 的/ 属性/ 值/ ./ opt/ 小于/ 0/ 则/ 取/ 最小值/ ./ 算法/ 7/ ./ 逻辑/ shapelets/ 转换/ TransformData/ (/ S/ ,/ D/ ,/ opt/ )/ ./ 输入/ :/ 最好/ 的/ k/ 个/ 逻辑/ shapeletsS/ ,/ 数据/ 集/ D/ ,/ 逻辑/ 操/ 输出/ :/ 转换/ 后/ 的/ 数据/ 集/ output1/ ./ output/ ←/ / ;/ 2/ ./ FORi/ ←/ 0to/ |/ D/ |/ DO/ {/ D/ 中/ 的/ 每/ 一条/ 时间/ 序列/ }/ 3/ ./ transformed/ ←/ / ;/ 4/ ./ FORj/ ←/ 0to/ |/ S/ |/ DO/ {/ S/ 中/ 的/ 每/ 一个/ 逻辑/ shapelets/ }/ 5/ ./ FORm/ ←/ 0to/ |/ Sj/ |/ DO/ {/ Sj/ 中/ 的/ 每/ 一个/ shapelet/ }/ 6/ ./ IF/ (/ opt/ / 0/ )/ {/ 合取/ 操作/ }/ 7/ ./ dist/ ←/ Max/ (/ 狊/ 狌/ 犳/ 犳/ 犻/ 犮/ 犻/ 犲/ 狀/ 狋/ 犱/ 犻/ 狊/ 狋/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ )/ ;/ 8/ ./ ELSEIF/ (/ opt/ </ 0/ )/ {/ 析取/ 操作/ }/ 9/ ./ dist/ ←/ Min/ (/ 狊/ 狌/ 犳/ 犳/ 犻/ 犮/ 犻/ 犲/ 狀/ 狋/ 犱/ 犻/ 狊/ 狋/ (/ u/ ,/ l/ ,/ Statsx/ ,/ y/ )/ )/ ;/ 10/ ./ transformed/ ./ add/ (/ dist/ )/ ;/ 11/ ./ output/ ./ add/ (/ transformed/ )/ ;/ 12/ ./ RETURNoutput/ ;/ 初始/ 的/ 时间/ 序列/ 数据/ 集/ 被/ 转换/ 之后/ ,/ 即可/ 应用/ 于/ 传统/ 的/ 分类/ 算法/ 如/ 贝叶斯/ 分类器/ 、/ 决策树/ 、/ 1/ -/ NN/ 等等/ ./ 本文/ 将/ 在/ 第/ 5/ 节/ 验证/ 所/ 提出/ 算法/ 的/ 分类/ 准确率/ ./ Page94/ ./ 5/ 分类/ 与/ 准确率/ 计算/ 分类器/ 在/ 给定/ 测试/ 集上/ 的/ 准确率/ 是/ 分类器/ 正确/ 分类/ 的/ 测试/ 集/ 元组/ 所/ 占/ 的/ 百分比/ ./ 发现/ k/ 个/ 最好/ 的/ 逻辑/ shapelets/ 之后/ ,/ 通过/ 将/ 初始/ 数据/ 集/ 转换成/ 新/ 的/ 数据/ 集/ ,/ 就/ 可以/ 将/ 时间/ 序列/ 分类/ 问题/ 转换成/ 传统/ 的/ 分类/ 问题/ ,/ 并/ 使用/ 传统/ 分类器/ 在/ 测试/ 集上/ 的/ 分类/ 准确率/ 来/ 评价/ 逻辑/ shapelets/ 转换/ 的/ 表现/ ./ 如/ 算法/ 8/ 所示/ ,/ 首先/ 将/ 训练/ 集/ 和/ 测试/ 集/ 分别/ 转换成/ 新/ 的/ 训练/ 集/ 和/ 测试/ 集/ (/ 第/ 1/ ~/ 2/ 行/ )/ ,/ 然后/ 根据/ 转换/ 后/ 的/ 训练/ 集/ 和/ 相应/ 的/ 分类/ 算法/ 建造/ 分类器/ ,/ 此处/ 的/ 分类器/ C/ 可以/ 是/ 贝叶斯/ 分类器/ 、/ 决策树/ 、/ 1/ -/ NN/ 分类器/ 等等/ (/ 第/ 3/ 行/ )/ ./ 最后/ ,/ 针对/ 转换/ 后/ 测试/ 集中/ 的/ 每/ 一条/ 实例/ ,/ 若/ 分类器/ 预测/ 的/ 类标/ 与/ 真实/ 类标/ 相同/ ,/ 则/ 计/ 数值/ 加/ 1/ (/ 第/ 5/ ~/ 9/ 行/ )/ ,/ 最终/ 返回/ 该/ 分类器/ 的/ 分类/ 准确率/ (/ 第/ 10/ ~/ 11/ 行/ )/ ./ 算法/ 8/ ./ 分类/ 准确率/ Accuracy/ (/ C/ ,/ D/ ,/ T/ )/ ./ 输入/ :/ 分类器/ C/ ,/ 训练/ 数据/ 集/ D/ ,/ 测试数据/ 集/ T/ 输出/ :/ 分类/ 准确率/ accuracy1/ ./ D/ ←/ 犜/ 狉/ 犪/ 狀/ 狊/ 犳/ 狅/ 狉犿犇/ 犪/ 狋/ 犪/ (/ S/ ,/ D/ ,/ opt/ )/ ;/ 2/ ./ T/ ←/ 犜/ 狉/ 犪/ 狀/ 狊/ 犳/ 狅/ 狉犿犇/ 犪/ 狋/ 犪/ (/ S/ ,/ T/ ,/ opt/ )/ ;/ 3/ ./ C/ ←/ BuildClassifier/ (/ C/ ,/ D/ )/ ;/ 4/ ./ accuracy/ ←/ 0/ ;/ 5/ ./ FORi/ ←/ 0to/ |/ T/ |/ DO/ {/ T/ 中/ 的/ 每/ 一条/ 时间/ 序列/ Ti/ }/ 6/ ./ class/ _/ label/ ←/ getClasslabel/ (/ Ti/ )/ ;/ 7/ ./ predict/ _/ label/ ←/ ClassifyInstance/ (/ C/ ,/ Ti/ )/ ;/ 8/ ./ IFpredict/ _/ label/ ./ equal/ (/ class/ _/ label/ )/ 9/ ./ accuracy/ ←/ accuracy/ +/ 1/ ;/ 10/ ./ accuracy/ ←/ accuracy/ // |/ T/ |/ ;/ 11/ ./ RETURNaccuracy/ ;/ 5/ 实验/ 评估/ 在/ 此/ 部分/ ,/ 将/ 评估所/ 应用/ 的/ 加速/ 技术/ 以及/ 逻辑/ shapelets/ 转换/ 技术/ ./ 首先/ ,/ 将/ 应用/ 充分/ 统计/ 量/ 技术/ 后/ 的/ ShapeletFilter/ 算法/ [/ 1/ ]/ 命名/ 为/ ShapeletAcc/ 算法/ ,/ 由于/ 相关/ 的/ 时间/ 复杂度/ 分析/ 已/ 在/ 4.1/ 节中/ 给出/ ,/ 本文/ 将/ 从/ 时间/ 上/ 对比/ ShapeletAcc/ 算法/ 与/ Lines/ 等/ 人/ 提出/ 的/ ShapeletFilter/ 算法/ [/ 1/ ]/ ;/ 然后/ 通过/ 实验/ 验证/ 使用/ 逻辑/ shapelets/ 转换/ 进行/ 分类/ 的/ 准确性/ ./ 所/ 采用/ 的/ 数据/ 集由/ Ding/ 等/ 人/ [/ 3/ ]/ 以及/ Keogh/ 等/ 人/ ①/ 所/ 提供/ ./ 所有/ 的/ 算法/ 和/ 实验/ 都/ 是/ 在/ Weka/ 框架/ 下/ 实现/ 的/ ./ 5.1/ 参数设置/ 本文/ 所/ 提出/ 的/ 算法/ 需要/ 从/ 时间/ 序列/ 数据/ 集中/ 抽取/ 出/ k/ 个/ 逻辑/ shapelets/ ,/ 由于/ k/ 值/ 仅仅/ 表示/ 抽取/ 的/ 逻辑/ shapelets/ 的/ 数量/ ,/ 它/ 并/ 不/ 影响/ 得到/ 的/ 逻辑/ shapelets/ 的/ 质量/ ,/ 但/ 我们/ 无法/ 保证/ 设置/ 的/ k/ 值/ 能够/ 转换/ 出/ 最/ 适合/ 分类/ 的/ 数据/ ./ 当/ k/ 值/ 设置/ 过/ 小时/ ,/ 所/ 得到/ 的/ 逻辑/ shapelets/ 可能/ 不足以/ 提供/ 分类/ 决策/ 所/ 需要/ 的/ 信息/ ;/ 而/ k/ 值/ 设置/ 过大时/ ,/ 可能/ 造成/ 过/ 拟合/ 现象/ 或/ 降低/ 重要/ 逻辑/ shapelets/ 的/ 辨别/ 性/ ./ 在/ 实验/ 中/ ,/ 为/ 保持/ k/ 值/ 设置/ 的/ 一致性/ 和/ 简洁性/ ,/ 我们/ 将/ k/ 值/ 设置/ 为/ m/ // 2/ ,/ 这里/ m/ 为/ 时间/ 序列/ 中/ 属性/ 的/ 个数/ ./ 另外/ ,/ 算法/ 中/ 的/ 两个/ 长度/ 参数/ min/ 和/ max/ 的/ 设置/ 也/ 是/ 一个/ 难题/ ./ 由于/ 它们/ 定义/ 了/ 候选/ shapelets/ // 逻辑/ shapelets/ 的/ 长度/ 范围/ ,/ 参数设置/ 不/ 正确/ 时/ 可能/ 发现/ 不了/ 最/ 具有/ 辨别/ 性/ 的/ shapelets/ // 逻辑/ shapelets/ ,/ 从而/ 对/ 分类器/ 的/ 准确率/ 造成/ 影响/ ./ 同样/ 为/ 保持/ 最大/ 长度/ 和/ 最小/ 长度/ 设置/ 的/ 一致性/ 和/ 简洁性/ ,/ 统一/ 将/ 最小/ 长度/ 设置/ 为/ m/ // 10/ ,/ 最大/ 长度/ 设置/ 为/ m/ // 2.5/ ./ 2/ 速度/ 对比/ 此处/ 将/ 对比/ 基于/ shapelets/ 转换/ 的/ ShapeletFilter/ 算法/ 和/ 本文/ 使用/ 充分/ 统计/ 量/ 之后/ 的/ 改进/ 算法/ ShapeletAcc/ ./ 尽管/ 采用/ 充分/ 统计/ 量/ 之后/ ,/ 发现/ shapelets/ 的/ 速率/ 得到/ 了/ 很大/ 的/ 提升/ ,/ 但/ 由于/ 在/ 寻找/ 逻辑/ shapelets/ 时/ 需要/ 重复/ 地/ 遍历/ 数据/ 集/ ,/ 一般/ 情况/ 下/ ,/ 发现/ 逻辑/ shapelets/ 需要/ 消耗/ 较/ 多/ 的/ 时间/ ./ 虽然/ 改进/ 了/ 原有/ 算法/ 的/ 效率/ ,/ 但/ 发现/ shapelets/ 的/ 过程/ 仍/ 是/ 一项/ 耗时/ 的/ 工作/ ,/ 所以/ 尽量/ 采用/ 实例/ 或/ 属性/ 较少/ 的/ 数据/ 集/ 进行/ 测试/ ,/ 并/ 舍弃/ 了/ 那些/ 无法/ 在/ 24h/ 之内/ 得到/ 结果/ 的/ 数据/ 集/ ./ 所/ 采用/ 的/ 数据/ 集如表/ 2/ 所示/ ./ SonyAIBORobotSurfaceSonyAIBORobotSurfaceIIsynthetic/ _/ controlTwoLeadECGDiatomSizeReductionECGFiveDayGun/ _/ PointItalyPowerDemand/ ①/ KeoghE/ ,/ XiX/ ,/ WeiL/ ,/ RatanamahatanaCA/ ./ TheUCRPage10/ 表格/ 的/ 第/ 1/ 列为/ 数据/ 的/ 名称/ ,/ 发现/ k/ 个/ shapelets/ 的/ 过程/ 是/ 在/ 各个/ 数据/ 的/ 训练/ 集上/ 完成/ 的/ ,/ 时间/ 的/ 单位/ 为/ s/ ,/ 所得/ 数值/ 均/ 为/ 10/ 次/ 测量/ 求/ 平均值/ 的/ 结果/ ./ 从表中/ 可以/ 看到/ ,/ ShapeletAcc/ 算法/ 的/ 运行/ 时间/ 明显/ 少于/ ShapeletFilter/ 算法/ ,/ 最大/ 的/ 加速/ 比可达/ 47.78/ 倍/ ,/ 更/ 直观/ 的/ 图形/ 表示/ 如图/ 6/ 所示/ ./ 图/ 6ShapeletAcc/ 与/ ShapeletFilter/ 的/ 加速/ 比/ 5.3/ 逻辑/ shapelets/ 转换/ 与/ shapelets/ 转换/ 的/ 对比/ 此/ 部分/ 将/ 对比/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间表/ 3/ 逻辑/ shapelets/ 转换/ 与/ shapelets/ 转换/ 的/ 对比/ 算法/ LG/ -/ ANDLG/ -/ ORShapeletsLG/ -/ ANDLG/ -/ ORShapeletsLG/ -/ ANDLG/ -/ ORShapeletsLG/ -/ ANDLG/ -/ ORShapeletsLG/ -/ ANDLG/ -/ ORShapeletsLG/ -/ ANDLG/ -/ ORShapelets91/ ./ 0293.5192/ ./ 3589.3081/ ./ 0183.3299/ ./ 3999.9199/ ./ 8288.6685/ ./ 2287.2293/ ./ 2096.0293/ ./ 49100.0099/ ./ 5499.19/ 从表/ 3/ 中/ 可以/ 观察/ 到/ ,/ 多数/ 情况/ 下/ ,/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 算法/ LG/ -/ AND/ 和/ LG/ -/ OR/ 在/ 各种类型/ 分类器/ 上/ 的/ 表现/ 优于/ shapelets/ 转换/ 算法/ [/ 1/ ]/ ./ 平局/ 的/ 情况/ 大多/ 出现/ 在/ 以/ 信息/ 增益/ 为/ 度量/ 的/ 决策树/ 或/ 决策树/ 组合/ 模型/ 中/ ,/ 如/ 三者/ 在/ C4/ ./ 5/ 算法/ 的/ 准确率/ 对比/ 上/ 出现/ 了/ 5/ 次/ 平局/ ./ 究其原因/ ,/ 是因为/ 在/ 选取/ shapelets/ 或者/ 逻辑/ shapelets/ 时/ 采用/ 信息/ 增益/ 作为/ 度量/ 标准/ ,/ 而/ C4/ ./ 5/ 算法/ 在/ 选择/ 信息/ 增益/ 最大/ 的/ 属性/ 时/ ,/ 必然/ 优先选择/ 与/ 信息/ 增益/ 最大/ 的/ shapelet/ 或者/ 逻辑/ shapelets/ 相对/ 应/ 的/ 属性/ ,/ 若/ 两者/ 在/ 决策树/ 的/ 序列/ 分类/ 算法/ 和/ 基于/ 经典/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ ./ 在/ 进行/ 逻辑/ shapelets/ 转换/ 时/ ,/ 我们/ 考虑/ 只是/ 合取/ 或者/ 只是/ 析取/ 这/ 两种/ 情况/ ,/ 分别/ 将/ 两种/ 算法/ 命名/ LG/ -/ AND/ 和/ LG/ -/ OR/ ./ 需要/ 注意/ 的/ 是/ ,/ 初始/ 时/ ,/ 将/ k/ 值/ 设定/ 为/ m/ // 2/ ,/ m/ 为/ 时间/ 序列/ 中/ 属性/ 的/ 个数/ ./ 为/ 保持/ 对比/ 的/ 公平性/ ,/ 当/ 逻辑/ shapelets/ 的/ 个数/ 小于/ m/ // 2/ 时/ ,/ 将/ 补入/ 经典/ 的/ 不/ 相似/ 的/ shapelet/ 以/ 满足/ 相应/ 的/ 个数/ ./ 若/ 发现/ 的/ 全部/ shapelets/ 的/ 个数/ n/ 小于/ m/ // 2/ ,/ 则/ 将/ k/ 值/ 设置/ 为/ n/ ./ 为/ 避免/ 偏差/ ,/ 在/ 进行/ 实验/ 时/ ,/ 所有/ 的/ 逻辑/ shapelets/ 和/ 经典/ shapelets/ 都/ 是从/ 训练/ 集中/ 抽取/ 出来/ 的/ ,/ 然后/ 再/ 将/ 训练/ 集/ 和/ 测试/ 集/ 分别/ 转换成/ 新/ 的/ 适用/ 于/ 不同/ 分类器/ 的/ 数据/ ./ 所有/ 的/ 分类器/ 都/ 是/ 根据/ 训练/ 集/ 建立/ 然后/ 在/ 测试/ 集上/ 进行/ 测试/ 的/ ./ 由于/ 实验/ 是/ 在/ Weka/ 框架/ 下/ 进行/ 的/ ,/ 所/ 采用/ 的/ 分类器/ 均/ 使用/ 了/ Weka/ 的/ 默认设置/ ./ 具体/ 的/ 分类/ 准确率/ 对/ 比如/ 表/ 3/ 所示/ ./ 某条/ 路径/ 上/ 的/ 信息/ 增益/ 相同/ (/ 此时/ 逻辑/ shapelets/ 的/ 分裂/ 间隔/ 较大/ )/ 或/ 相近/ ,/ 则/ 会/ 生成/ 类似/ 的/ 决策/ 规则/ ./ 在/ LG/ -/ AND/ 和/ LG/ -/ OR/ 的/ 对比/ 中/ ,/ LG/ -/ AND/ 在/ 14/ 个/ 分类器/ 上/ 优于/ LG/ -/ OR/ ,/ LG/ -/ OR/ 在/ 15/ 个/ 分类器/ 上/ 占优/ ,/ 两者/ 持平/ 7/ 次/ ,/ 所以/ 从/ 整体/ 上/ 说/ ,/ LG/ -/ AND/ 与/ LG/ -/ OR/ 的/ 表现/ 差别/ 不大/ ./ 5.4/ 逻辑/ shapelets/ 转换/ 与/ 其他/ 分类器/ 的/ 对比/ 1/ -/ NN/ 分类器/ 是/ 当前/ 解决/ 时间/ 序列/ 分类/ 问题/ 的/ 最好/ 分类器/ 之一/ ,/ 为/ 进一步/ 验证/ 本文/ 所/ 提出/ 的/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ 的/ 性能/ ,/ 在/ 此/ Page11/ 部分/ ,/ 将/ 对比/ 基于/ 欧氏/ 距离/ 的/ 1/ -/ NN/ 分类器/ 和/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 1/ -/ NN/ 分类器/ ./ 另外/ ,/ 本文/ 也/ 对比/ 了/ 基于/ 逻辑/ shapelets/ 转换/ 后/ 的/ C4/ ./ 5/ 分类器/ 和/ 直接/ 采用/ shapelets/ 实现/ 的/ 决策树/ [/ 4/ ]/ 的/ 分类/ 准确性/ ./ 从表/ 4SonyAIBORobotSurfaceSonyAIBORobotSurfaceII/ 表/ 4/ 准确率/ 对比/ LG/ -/ 1NN/ // %/ 5.5/ 实验/ 总结/ 首先/ ,/ 通过/ 相应/ 的/ 时间/ 对比/ 实验/ ,/ 验证/ 了/ 充分/ 统计/ 量/ 技术/ 能够/ 大幅度提高/ shapelets/ 的/ 发现/ 效率/ ;/ 其次/ ,/ 通过/ 与/ 基于/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ 和/ 其他/ 经典/ 时间/ 序列/ 分类/ 算法/ 的/ 对比/ 实验/ ,/ 验证/ 了/ 所/ 提出/ 的/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ 的/ 分类/ 准确性/ ./ 同时/ ,/ 在/ 实验/ 过程/ 中/ 也/ 发现/ 了/ 一些/ shapelets/ 转换/ 技术/ 的/ 缺点/ ,/ 比如/ 分类器/ 训练/ 时间/ 较长/ ,/ k/ 值/ 以及/ shapelets/ 最大/ 最小/ 长度/ 的/ 设定/ 比较/ 困难/ 等/ ./ 6/ 结论/ 与/ 展望/ 在/ 本文/ 中/ ,/ 介绍/ 了/ 一种/ 用于/ 快速/ 发现/ shapelets/ 的/ 充分/ 统计/ 量/ 技术/ ,/ 并/ 针对/ shapelets/ 的/ 不足/ ,/ 提出/ 了/ 一种/ 基于/ 逻辑/ shapelets/ 转换/ 的/ 时间/ 序列/ 分类/ 算法/ ,/ 通过/ 实验/ 验证/ 了/ 所/ 提出/ 算法/ 的/ 分类/ 准确性/ ./ 基于/ 逻辑/ shapelets/ 转换/ 的/ 缺点/ 之一/ 是/ 训练/ 时间/ 相对/ 较长/ ,/ 一种/ 潜在/ 的/ 缓解/ 方式/ 是/ 通过/ 对/ 训练/ 集/ 采样/ ,/ 即/ 使用/ 原始数据/ 的/ 一小部分/ 子集/ 来/ 发现/ 逻辑/ shapelets/ ./ 另外/ ,/ 还/ 可以/ 进一步/ 考虑/ 聚类/ 相似/ 的/ 逻辑/ shapelets/ ,/ 然后/ 从/ 每/ 一簇/ 中/ 得到/ 一个/ 代表性/ 的/ 逻辑/ shapelets/ 来/ 代替/ 寻找/ k/ 个/ 逻辑/ shapelets/ 进行/ 数据/ 转换/ 等/ ./ 致谢/ 在/ 此/ 需要/ 感谢/ JasonLines/ 提供/ 关于/ shapelets/ 转换/ 的/ 源代码/ 和/ 针对/ 相关/ 问题/ 的/ 解答/ ./ 同时/ 也/ 感谢/ 匿名/ 审稿人/ 对/ 本文/ 提出/ 宝贵意见/ !/ 

