Page1/ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多/ 秘密/ 共享/ 于佳/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 陈养奎/ 1/ )/ 郝蓉/ 1/ )/ 孔凡玉/ 4/ )/ ,/ 5/ )/ 程/ 相国/ 1/ )/ 潘振宽/ 1/ )/ 1/ )/ (/ 青岛大学/ 信息/ 工程学院/ 山东/ 青岛/ 266071/ )/ 2/ )/ (/ 山东省/ 科学院/ 山东省/ 计算机网络/ 重点/ 实验室/ 济南/ 250014/ )/ 3/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100093/ )/ 4/ )/ (/ 山东大学/ 网络/ 信息安全/ 研究所/ 济南/ 250100/ )/ 5/ )/ (/ 山东大学/ 密码/ 技术/ 与/ 信息安全/ 教育部/ 重点/ 实验室/ 济南/ 250100/ )/ 摘要/ 多/ 秘密/ 共享/ 是/ 通过/ 一次/ 计算/ 过程/ 就/ 可以/ 实现/ 同时/ 对/ 多个/ 秘密/ 进行/ 共享/ 的/ 密码/ 体制/ ,/ 在/ 一般/ 的/ 多/ 秘密/ 共享/ 中/ ,/ 都/ 需要/ 可信/ 中心/ 的/ 参与/ ,/ 由/ 可信/ 中心/ 进行/ 秘密/ 份额/ 的/ 分发/ ./ 然而/ ,/ 在/ 很多/ 情况/ 下/ ,/ 无法/ 保证/ 可信/ 中心/ 的/ 存在/ ,/ 即使/ 存在/ 可信/ 中心/ ,/ 它/ 也/ 很/ 容易/ 遭受/ 敌手/ 的/ 攻击/ ,/ 成为/ 系统/ 的/ 盲点/ ./ 该文/ 提出/ 了/ 一个/ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多个/ 秘密/ 共享/ 方案/ ,/ 共享/ 的/ 多个/ 随机/ 秘密/ 是/ 由/ 参与/ 成员/ 共同/ 产生/ 的/ ,/ 密钥/ 份额/ 的/ 有效性/ 不仅/ 可以/ 被/ 份额/ 持有者/ 自己/ 验证/ ,/ 而且/ 可以/ 被/ 其他/ 任何/ 成员/ 验证/ ,/ 这使/ 方案/ 具有/ 更广/ 的/ 应用/ 背景/ ,/ 可/ 用于/ 设计/ 电子/ 投票/ 协议/ 、/ 密钥/ 托管/ 协议/ 等/ ./ 为了/ 适用/ 于/ 无线/ 自/ 组网/ 等/ 新/ 的/ 网络/ 环境/ ,/ 该文/ 也/ 讨论/ 了/ 无/ 可信/ 中心/ 的/ 条件/ 下/ 动态/ 撤出/ 和/ 增加/ 成员/ 的/ 问题/ ./ 关键词/ 秘密/ 共享/ ;/ 多/ 秘密/ 共享/ ;/ 可信/ 中心/ ;/ 可/ 公开/ 验证/ 方案/ ;/ 安全性/ ;/ 网络安全/ ;/ 信息安全/ 1/ 引言/ 为了/ 确保/ 秘密/ 的/ 安全性/ 和/ 有效性/ ,/ Shamir/ [/ 1/ ]/ 和/ Blakley/ [/ 2/ ]/ 于/ 1979/ 年/ 分别/ 基于/ 拉格朗/ 日/ 插值/ 多项式/ 和/ 射影/ 几何/ 理论/ 最先/ 提出/ 了/ 门限/ 秘密/ 共享/ 方案/ ./ 在/ 一个/ (/ t/ ,/ n/ )/ 的/ 秘密/ 共享/ 方案/ 中/ ,/ 一个/ 秘密/ 共享/ 在/ n/ 个/ 服务器/ 中/ ,/ 其中/ 的/ 任意/ t/ 个/ 服务器/ 都/ 可以/ 合作/ 重构/ 出/ 秘密/ ,/ 而/ 少于/ t/ 个/ 的/ 服务器/ 均/ 不能/ 正确/ 地/ 重构/ 出/ 秘密/ ./ 然而/ ,/ 这/ 两个/ 秘密/ 共享/ 方案/ 并/ 不能/ 保证/ 分发者/ 和/ 份额/ 持有者/ 的/ 诚实/ 性/ 问题/ ./ 文献/ [/ 3/ -/ 4/ ]/ 提出/ 了/ 两个/ 著名/ 的/ 可验证/ 秘密/ 共享/ 方案/ ,/ 解决/ 了/ 上述/ 问题/ ./ 文献/ [/ 5/ -/ 6/ ]/ 则/ 提出/ 了/ 两种/ 具有/ 公开/ 验证/ 能力/ 的/ 秘密/ 共享/ 方案/ ,/ 分发者/ 分发/ 的/ 秘密/ 份额/ 的/ 正确性/ 不仅/ 能/ 被/ 份额/ 持有者/ 自己/ 验证/ ,/ 而且/ 可以/ 被/ 其他/ 任何/ 成员/ 验证/ ./ Gennaro/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 一个/ 无/ 可信/ 中心/ 的/ 可验证/ 秘密/ 共享/ 方案/ ,/ 在/ 没有/ 可信/ 中心/ 的/ 情况/ 下/ ,/ 可以/ 实现/ 秘密/ 共享/ 的/ 目的/ ./ 上述/ 的/ 所有/ 方案/ 每次/ 只能/ 共享/ 一个/ 秘密/ ,/ 有时候/ 我们/ 需要/ 同时/ 保护/ 多个/ 秘密/ ,/ 或者/ 把/ 一个/ 比较/ 大/ 的/ 秘密/ 分成/ 多个/ 子/ 秘密/ ,/ 通过/ 保护/ 子/ 秘密/ 来/ 保护/ 秘密/ ,/ 这样/ 就/ 需要/ 一个/ 方案/ 能够/ 实现/ 一次/ 共享/ 多个/ 秘密/ 的/ 目的/ ./ 为此/ ,/ 多/ 秘密/ 共享/ 的/ 方法/ 被/ 提出/ 来/ ./ 在/ 一个多/ 秘密/ 共享/ 方案/ 中/ 可以/ 同时/ 共享/ 多个/ 秘密/ ,/ 门限/ 个/ 份额/ 持有者/ 合作/ 可以/ 重构/ 出/ 所有/ 秘密/ ./ He/ 和/ Dawson/ [/ 8/ ]/ 基于/ 单向/ 函数/ 提出/ 了/ 一个/ 实用/ 的/ 多/ 秘密/ 共享/ 方案/ ./ Yang/ 等/ 人/ [/ 9/ ]/ 基于/ Shamir/ 的/ 秘密/ 共享/ 体制/ [/ 1/ ]/ 提出/ 了/ 一个多/ 秘密/ 共享/ 方案/ ,/ 方案/ 的/ 运算/ 效率/ 较/ 高/ ,/ 但/ 不/ 具有/ 可验证/ 能力/ ./ 文献/ [/ 10/ -/ 14/ ]/ 提出/ 了/ 具有/ 可验证/ 功能/ 的/ 多/ 秘密/ 共享/ 方案/ ,/ 可/ 避免/ 因/ 份额/ 分发者/ 和/ 持有者/ 的/ 欺骗/ 而/ 导致/ 不能/ 重构/ 出/ 正确/ 秘密/ 的/ 问题/ ./ 观察/ 目前/ 已有/ 的/ 多/ 秘密/ 共享/ 方案/ ,/ 存在/ 下面/ 两个/ 问题/ 需要/ 进一步/ 解决/ ./ 首先/ ,/ 多/ 秘密/ 共享/ 方案/ 中/ 都/ 需要/ 一个/ 可信/ 中心/ 负责/ 分发/ 份额/ ,/ 这/ 在/ 很多/ 应用/ 中是/ 不/ 现实/ 并/ 难以实现/ 的/ ,/ 比如/ 在/ 无线/ 传感/ 网/ 和/ 无线/ 自/ 组网/ 中/ ./ 因此/ ,/ 提出/ 无/ 可信/ 中心/ 的/ 多/ 秘密/ 共享/ 方案/ 具有/ 重要/ 的/ 应用/ 背景/ ./ 其次/ ,/ 目前/ 已有/ 的/ 方案/ 多数/ 不/ 具备/ 可/ 公开/ 验证/ 的/ 属性/ ,/ 即/ 份额/ 持有者/ 所/ 得到/ 份额/ 的/ 正确性/ 只能/ 由/ 自己/ 验证/ ,/ 其他/ 成员/ 无法/ 验证/ 它/ 是否/ 正确/ ./ 由于/ 秘密/ 共享/ 的/ 许多/ 应用/ (/ 比如/ 电子/ 投票/ 、/ 密钥/ 托管/ 、/ 电子/ 支付/ 协议/ 等/ )/ 都/ 需要/ 可/ 公开/ 验证/ 的/ 性质/ ,/ 因此/ ,/ 构造/ 具有/ 可/ 公开/ 验证/ 性质/ 的/ 多/ 秘密/ 共享/ 方案/ 是/ 一项/ 非常/ 有/ 意义/ 的/ 研究/ 工作/ ./ 为了/ 解决/ 上述/ 这/ 两个/ 问题/ ,/ 本文/ 提出/ 了/ 一个/ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多/ 秘密/ 共享/ 方案/ ./ 方案/ 基于/ 同态/ 结构/ ,/ 与/ 使用/ 单向/ 函数/ (/ 或/ 双/ 变量/ 单向/ 函数/ )/ 的/ 多/ 秘密/ 共享/ 不同/ ,/ 具有/ 同态/ 性质/ 的/ 方案/ 可以/ 较/ 容易/ 的/ 实现/ 联合/ 生成/ 秘密/ 的/ 目标/ ./ 为了/ 使/ 联合/ 生成/ 的/ 份额/ 能/ 被/ 每个/ 成员/ 验证/ ,/ 利用/ 可/ 公开/ 验证/ 的/ 方法/ 进行/ 秘密/ 分发/ ,/ 任意/ 成员/ 都/ 可以/ 对/ 所有/ 份额/ 进行/ 验证/ ./ 为了/ 能够/ 一次性/ 重构/ 出/ 多个/ 秘密/ ,/ 文中/ 给出/ 了/ 一个多/ 秘密/ 求解/ 算法/ ,/ 多于/ 一定/ 数目/ 的/ 成员/ 通过/ 该/ 求解/ 算法/ ,/ 可以/ 计算/ 出/ 联合/ 生成/ 共享/ 的/ 多个/ 秘密/ ./ 此/ 方案/ 也/ 可/ 方便/ 地/ 实现/ 成员/ 的/ 撤出/ 和/ 加入/ ./ 2/ 预备/ 知识/ 2.1/ 定义/ 定义/ 1/ ./ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多/ 秘密/ 共享/ 由/ 两个/ 阶段/ 组成/ :/ 秘密/ 产生/ 阶段/ 和/ 秘密/ 恢复/ 阶段/ ./ (/ 1/ )/ 秘密/ 产生/ 阶段/ ./ 当/ 参与者/ 要/ 生成/ m/ 个/ 随机/ 秘密/ 时/ ,/ 每个/ 参与者/ Pi/ 都/ 分别/ 为/ 所有/ 参与者/ Pj/ (/ j/ =/ 1/ ,/ …/ ,/ n/ )/ 产生/ 随机/ 秘密/ 份额/ sij/ ,/ 使用/ 加密/ 函数/ Ei/ 生成/ 加密/ 的/ Sij/ =/ Ei/ (/ sij/ )/ ,/ 并/ 将/ Si1/ ,/ …/ ,/ Sin/ 公开/ ./ 任何/ 成员/ 都/ 可验证/ Sij/ 是否是/ Pi/ 为/ Pj/ 生成/ 的/ sij/ 的/ 正确/ 加密/ 形式/ ,/ 成员/ Pj/ 可以/ 通过/ 解密/ 函数/ 获取/ 份额/ sij/ ./ Pj/ 可以/ 通过/ sij/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ 最终/ 计算/ 获得/ 份额/ sj/ ./ (/ 2/ )/ 秘密/ 恢复/ 阶段/ ./ 当/ 参与者/ 要/ 重构/ 秘密/ 时/ ,/ Pj/ 提供/ 份额/ sj/ 并/ 证明/ 它/ 是/ 一个/ 正确/ 的/ 解密/ 形式/ ./ 运行/ 重构/ 函数/ 计算/ 最终/ 共享/ 的/ 秘密/ k0/ ,/ k1/ ,/ …/ ,/ km/ -/ 1.2/ ./ 2/ 所需/ 工具/ (/ 1/ )/ Shamir/ 的/ (/ t/ ,/ n/ )/ 秘密/ 共享/ 方案/ [/ 1/ ]/ 令/ q/ 为/ 大/ 素数/ ,/ 假定/ 要/ 分发/ 的/ 秘密/ 为/ s/ ∈/ Zq/ ,/ 分发者/ 选择/ 随机/ 多项式/ f/ (/ x/ )/ =/ ∑/ t/ -/ 1a0/ =/ s/ ,/ aj/ ∈/ RZq/ (/ j/ =/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ ./ 计算/ 份额/ si/ =/ f/ (/ i/ )/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ ,/ 并/ 将/ si/ 秘密/ 地/ 发送给/ 成员/ Pi/ ./ Page3/ 秘密/ 重构/ 时/ ,/ 任意/ t/ 个/ 成员/ 的/ 集合/ B/ 拿出/ 他们/ 的/ 份额/ si/ ,/ 计算/ s/ =/ ∑/ Pi/ ∈/ BCBi/ =/ ∏/ Pj/ ∈/ B/ \/ {/ Pi/ }/ DLE/ (/ g1/ ,/ h1/ ;/ g2/ ,/ h2/ ;/ α/ )/ [/ 15/ ]/ (/ 2/ )/ 非/ 交互/ 的/ 离散/ 对数/ 相等/ 的/ 零/ 知识/ 证明/ 协议/ 首先/ ,/ P/ 选取/ w/ ∈/ RZq/ ,/ 计算/ a1/ =/ gw/ 设/ g1/ ,/ g2/ 是/ 素数/ q/ 阶/ 乘法/ 群/ Gq/ 的/ 两个/ 生成元/ ,/ 证明/ 者/ P/ 向/ 验证/ 者/ V/ 证明/ 他/ 知道/ 某个/ 秘密/ α/ ∈/ Z/ / 满足/ α/ =/ logg1h1/ =/ logg2h2/ ,/ 而/ 不/ 泄露/ α/ 的/ 值/ ./ c/ =/ H/ (/ a1/ ‖/ a2/ )/ ,/ r/ =/ w/ -/ α/ c/ (/ modq/ )/ ,/ 公布/ (/ r/ ,/ c/ )/ ./ 然后/ ,/ V/ 验证/ c/ ≡/ H/ (/ gr/ 信/ P/ 确实/ 知道/ 秘密/ 信息/ α/ ;/ 否则/ ,/ 不/ 相信/ ./ 3/ 提出/ 的/ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多/ 秘密/ 共享/ 方案/ 3.1/ 符号/ 定义/ p/ ,/ q/ 表示/ 两个/ 大/ 素数/ ,/ 满足/ q/ |/ (/ p/ -/ 1/ )/ ,/ Gq/ 为/ Z/ / 的/ 唯一/ q/ 阶/ 子群/ ./ g/ ,/ h/ 表示/ Gq/ 中/ 两个/ 不同/ 的/ 生成元/ ./ Ω/ =/ {/ P1/ ,/ …/ ,/ Pn/ }/ 表示/ 所有/ 参与/ 成员/ 构成/ 的/ 集合/ ./ 成员/ Pi/ 的/ 私钥/ 表示/ 为/ zi/ ∈/ Zq/ ,/ 对应/ 的/ 公钥/ 表示/ 为/ yi/ =/ hzi/ (/ modp/ )/ ./ H/ 表示/ 一个/ 密码/ hash/ 函数/ ,/ t/ 表示/ 门/ 限值/ ,/ m/ 表示/ 共享/ 的/ 多/ 秘密/ 个数/ ,/ A/ 表示/ 协议/ 执行/ 中/ 不诚实/ 的/ 成员/ 集合/ ./ 3.2/ 提出/ 的/ 求解/ 多个/ 共享/ 秘密/ 的/ 算法/ 犆/ 犕/ 犛/ (/ 狆/ ,/ 狇/ ,/ 犌/ 狇/ ,/ 犵/ ,/ τ/ ,/ 犛/ 狓/ 1/ ,/ 犛/ 狓/ 2/ ,/ …/ ,/ 犛/ 狓/ τ/ )/ p/ ,/ q/ ,/ Gq/ ,/ g/ 遵循/ 3.1/ 节/ 的/ 定义/ ,/ τ/ -/ 1/ 表示/ 共享/ 多项式/ f/ (/ x/ )/ 的/ 指数/ ,/ Sx1/ ,/ Sx2/ ,/ …/ ,/ Sx/ τ/ 表示/ 以/ g/ 为底/ ,/ 以该/ 多项式/ τ/ 个解/ f/ (/ xi/ )/ (/ i/ =/ 1/ ,/ …/ ,/ τ/ )/ 为/ 指数/ 所/ 计算/ 的/ 幂/ ./ 令一/ 随机/ 多项式/ 为/ f/ (/ x/ )/ =/ ∑/ τ/ -/ 1/ α/ xi/ =/ f/ (/ xi/ )/ ,/ Sxi/ =/ g/ α/ xi/ (/ i/ =/ 1/ ,/ …/ ,/ τ/ )/ ,/ 该/ 算法/ 输入/ :/ p/ ,/ q/ ,/ Gq/ ,/ g/ ,/ τ/ ,/ Sx1/ ,/ Sx2/ ,/ …/ ,/ Sx/ τ/ ,/ 输出/ :/ k0/ =/ ga0/ ,/ k1/ =/ ga1/ ,/ …/ ,/ k/ τ/ -/ 1/ =/ ga/ τ/ -/ 1/ ./ 构造/ 的/ 算法/ 可以/ 按照/ 以下/ 过程/ 求解/ :/ (/ 1/ )/ 令/ 集合/ B/ =/ {/ x1/ ,/ x2/ ,/ …/ ,/ x/ τ/ }/ ,/ 将/ f/ (/ x/ )/ 写成/ f/ (/ x/ )/ =/ ∑/ τ/ 展开/ 多项式/ 整理/ 的/ xk/ 项/ 的/ 系数/ 其中/ k/ ∈/ {/ 0/ ,/ …/ ,/ τ/ -/ 1/ }/ ./ 因此/ ,/ 按照/ 式/ (/ 1/ )/ 可/ 展开/ 求解/ 出/ λ/ k/ ,/ xi/ ,/ k/ ∈/ {/ 0/ ,/ …/ ,/ τ/ -/ 1/ }/ ./ (/ 2/ )/ 对/ 所有/ 的/ k/ ∈/ {/ 0/ ,/ …/ ,/ τ/ -/ 1/ }/ ,/ 做/ 以下/ 计算/ :/ i/ =/ 1gak/ ≡/ g/ ≡/ ∏/ τ/ 输出/ :/ k0/ =/ ga0/ ,/ k1/ =/ ga1/ ,/ …/ ,/ k/ τ/ -/ 1/ =/ ga/ τ/ -/ 1.3/ ./ 3/ 方案/ 思想/ 为了/ 不/ 依赖于/ 可信/ 分发/ 中心/ ,/ 需要/ 所有/ 成员/ Pi/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ 联合/ 生成/ 秘密/ ./ 采用/ 同态/ 结构/ ,/ 所有/ 秘密/ 的/ 值/ 都/ 可/ 由/ 一个/ 多项式/ 的/ 相应/ 系数/ 来/ 计算/ ,/ 门限/ 个/ 成员/ 可/ 通过/ 线性插值/ 来/ 重构/ 秘密/ ./ 为了/ 获取/ 可/ 公开/ 验证/ 的/ 能力/ ,/ 采用/ 的/ 方法/ 考虑/ 下面/ 两种/ 情况/ :/ (/ 1/ )/ 当/ 秘密/ 个数/ 不/ 大于/ 门/ 限值/ ,/ 即/ m/ / t/ 时/ ./ 在/ 秘密/ 产生/ 阶段/ ,/ 各/ 成员/ 构造/ 的/ 多项式/ 次数/ 是/ t/ -/ 1/ ,/ 公开/ 对/ 多项式/ 系数/ 的/ 承诺/ ,/ 并/ 公开/ 加密/ 后/ 的/ 子/ 秘密/ 份额/ ,/ 该/ 成员/ 构造/ 证据/ 以便/ 使/ 他人/ 相信/ 他/ 所/ 公开/ 的/ 子/ 秘密/ 份额/ 都/ 是/ 正确/ 的/ ,/ 任何/ 成员/ 都/ 可以/ 通过/ 公开/ 信息/ 验证/ 子/ 密钥/ 的/ 正确性/ ,/ 最后/ ,/ 成员/ 可/ 通过/ 加密/ 子/ 密钥/ 和/ 他/ 的/ 私钥/ 来/ 计算/ 自己/ 的/ 份额/ ./ 在/ 秘密/ 恢复/ 阶段/ ,/ 该/ 成员/ 需向/ 其他/ 成员/ 证明/ 他/ 的/ 份额/ 确实/ 是从/ 加密/ 的/ 子/ 密钥/ 份额/ 中/ 解密/ 出来/ 的/ ,/ 不少/ 于/ t/ 个/ 诚实/ 成员/ 可/ 利用/ 提出/ 的/ 求解/ 多个/ 共享/ 秘密/ 的/ CMS/ 算法/ 来/ 获取/ 重构/ 秘密/ ./ (/ 2/ )/ 当/ 秘密/ 个数/ 大于/ 门/ 限值/ ,/ 即/ m/ >/ t/ 时/ ./ 在/ 秘密/ 产生/ 阶段/ ,/ 各/ 成员/ 所/ 要/ 构造/ 的/ 多项式/ 的/ 次数/ 是/ m/ -/ 1/ ,/ 公开/ 该/ 多项式/ 上/ 的/ m/ -/ t/ 个解/ 和/ 对应/ 的/ 承诺/ ,/ 其他/ 步骤/ 与/ m/ / t/ 时/ 相似/ ./ 重构/ 秘密/ 时/ ,/ 首先/ ,/ 通过/ 同态/ 关系/ ,/ 计算/ m/ -/ t/ 个/ 公开/ 份额/ ,/ 任何/ 不少/ 于/ t/ 个/ 诚实/ 成员/ 利用/ m/ -/ t/ 个/ 公开/ 份额/ 和/ 他们/ 的/ 子/ 密钥/ ,/ 执行/ 提出/ 的/ 求解/ 多个/ 共享/ 秘密/ 的/ CMS/ 算法/ ,/ 其/ 输出/ 即/ 为/ 所有/ 共享/ 的/ 全部/ 秘密/ ./ 3.4/ 方案/ 具体/ 描述/ 当/ m/ / t/ 时/ ,/ 方案/ 描述/ 如下/ :/ (/ 1/ )/ 秘密/ 产生/ 阶段/ ①/ 成员/ Pi/ 随机/ 选取/ aij/ ∈/ RZq/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ ,/ 构造/ 多项式/ fi/ (/ x/ )/ =/ ∑/ t/ -/ 1/ 系数/ 的/ 承诺/ Cik/ =/ gaikmodp/ (/ k/ =/ 0/ ,/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ 和/ Yij/ =/ yfi/ (/ j/ )/ jmodp/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ./ Page4/ ②/ 成员/ Pi/ 构造/ 证据/ ,/ 以便/ 使/ 其他/ 成员/ 相信/ 他们/ 收到/ 的/ Yij/ 是/ 有效/ 的/ ,/ 即/ 满足/ Xij/ =/ gfi/ (/ j/ )/ modp/ ,/ Yij/ =/ jmodp/ ./ 为此/ ,/ Pi/ 任意/ 选取/ n/ 个/ 随机数/ wij/ ∈/ RZqyfi/ (/ j/ )/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 计算/ a1ij/ =/ gwijmodp/ ,/ a2ij/ =/ ywijjmodp/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 然后/ 构造/ 质询/ 值/ ci/ =/ H/ (/ g/ ‖/ h/ ‖/ Xi1/ ‖/ …/ ‖/ Xin/ ‖/ Yi1/ ‖/ …/ 并/ 计算/ Ri/ =/ (/ ri1/ ,/ …/ ,/ rin/ )/ =/ (/ wi1/ -/ cifi/ (/ 1/ )/ (/ modq/ )/ ,/ …/ ,/ 公布/ 证据/ ProofPi/ =/ (/ ci/ ,/ Ri/ )/ ./ fi/ (/ x/ )/ 的/ 公开/ 承诺/ Cik/ 来/ 计算/ ③/ 任何/ 成员/ Pl/ ∈/ Ω/ // {/ Pi/ }/ 都/ 可/ 根据/ 对/ 多项式/ ④/ 然后/ ,/ Pl/ ∈/ Ω/ // {/ Pi/ }/ 再/ 利用/ 已知/ 的/ ci/ ,/ rij/ ,/ g/ ,/ h/ ,/ Xij/ ,/ Yij/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 计算/ a1ij/ 和/ a2ij/ :/ a1ij/ =/ grijXci/ 验证/ 式/ (/ 2/ )/ 是否/ 成立/ ./ 若/ 成立/ ,/ 则/ 表明/ 成员/ Pi/ 分发/ 的/ 份额/ 是/ 正确/ 的/ ./ 否则/ ,/ 广播/ 对/ 成员/ Pi/ 的/ 指控/ ,/ 经过/ 不少/ 于/ t/ 个/ 成员/ 的/ 确认/ 后/ ,/ 将/ Pi/ 加入/ 不诚实/ 成员/ 集合/ A/ ,/ A/ =/ A/ ∪/ {/ Pi/ }/ ./ ⑤/ 所有/ 成员/ 都/ 已/ 分发/ 了/ 子/ 秘密/ 份额/ 后/ ,/ 每个/ 成员/ Pj/ ∈/ Ω/ 可/ 计算/ 出/ 加密/ 的/ 秘密/ 份额/ Yj/ =/ ∏/ Pi/ ∈/ Ω/ -/ AYijmodp/ ,/ 再/ 利用/ 私钥/ zj/ 从/ 加密/ 子/ 密钥/ Yj/ 中/ 计算/ 出/ 最终/ 的/ 秘密/ 份额/ Sj/ =/ Yz/ -/ 1/ (/ 2/ )/ 秘密/ 恢复/ 阶段/ 参与/ 秘密/ 恢复/ 的/ 成员/ Pj/ ∈/ Ω/ 提供/ Sj/ ,/ 并/ 按/ 下面/ 的/ 步骤/ 向/ 其他/ 成员/ 证明/ Sj/ 确实/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ./ ①/ 成员/ Pj/ 任意/ 选取/ wj/ ∈/ RZq/ ,/ 并/ 计算/ b1j/ =/ hwjmodp/ ,/ b2j/ =/ Swjjmodp/ ,/ rj/ =/ wj/ -/ cjzj/ (/ modq/ )/ ,/ 其中/ cj/ =/ H/ (/ b1j/ ‖/ b2j/ )/ ./ ②/ 成员/ Pj/ 公布/ (/ rj/ ,/ cj/ )/ 作为/ 他/ 知道/ 秘密/ 信息/ zj/ 的/ 证据/ ./ ③/ 其他/ 验证/ 者/ 验证/ cj/ ≡/ H/ (/ hrjycj/ 成立/ ./ 若/ 成立/ ,/ 则/ 证明/ Sj/ 确实/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ./ ④/ 任何/ t/ 个/ 证明/ 了/ 他们/ 提供/ 了/ 正确/ 份额/ Sxi/ 的/ 成员/ Pxi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ ,/ xi/ ∈/ {/ 1/ ,/ …/ ,/ n/ }/ )/ ,/ 通过/ 执行/ CMS/ (/ p/ ,/ q/ ,/ Gq/ ,/ g/ ,/ t/ ,/ Sx1/ ,/ Sx2/ ,/ …/ ,/ Sxt/ )/ 算法/ ,/ 输出/ 的/ t/ 个值/ 的/ 前/ m/ 个/ 就是/ 联合/ 产生/ 的/ 随机/ 秘密/ k0/ ,/ k1/ ,/ …/ ,/ km/ -/ 1/ ./ 当/ m/ >/ t/ 时/ ,/ 方案/ 描述/ 如下/ :/ (/ 1/ )/ 秘密/ 产生/ 阶段/ ①/ 成员/ Pi/ 选取/ aij/ ∈/ RZq/ (/ j/ =/ 0/ ,/ 1/ ,/ …/ ,/ m/ -/ 1/ )/ ,/ 构造/ 多项式/ fi/ (/ x/ )/ =/ ∑/ m/ -/ 1m/ -/ t/ 对解/ (/ j/ ,/ fi/ (/ j/ )/ )/ ,/ 其中/ j/ =/ n/ +/ 1/ ,/ …/ ,/ n/ +/ m/ -/ t/ ,/ 并/ 公开/ 对/ 系数/ 的/ 承诺/ Cik/ =/ gaikmodp/ (/ k/ =/ 0/ ,/ 1/ ,/ …/ ,/ m/ -/ 1/ )/ ,/ Yij/ =/ yfi/ (/ j/ )/ ②/ 成员/ Pi/ 构造/ 证据/ ,/ 以便/ 使/ 其他/ 成员/ 相信/ 他们/ 收到/ 的/ Yij/ 是/ 有效/ 的/ ,/ 即/ 满足/ Xij/ =/ gfi/ (/ j/ )/ modp/ ,/ jmodp/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ./ 为此/ ,/ 成员/ Pi/ 任意/ Yij/ =/ yfi/ (/ j/ )/ 选取/ n/ 个/ 随机数/ wij/ ∈/ RZq/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 计算/ a1ij/ =/ gwijmodp/ ,/ a2ij/ =/ ywijjmodp/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 然后/ 构造/ 质询/ 值/ ci/ =/ H/ (/ g/ ‖/ h/ ‖/ Xi1/ ‖/ …/ ‖/ Xin/ ‖/ Yi1/ ‖/ …/ 并/ 计算/ Ri/ =/ (/ ri1/ ,/ …/ ,/ rin/ )/ =/ (/ wi1/ -/ cifi/ (/ 1/ )/ (/ modq/ )/ ,/ …/ ,/ 公布/ 证据/ ProofPi/ =/ (/ ci/ ,/ Ri/ )/ ./ fi/ (/ x/ )/ 的/ 公开/ 承诺/ Cik/ 来/ 计算/ ③/ 任何/ 成员/ Pl/ ∈/ Ω/ // {/ Pi/ }/ 都/ 可/ 根据/ 对/ 多项式/ ④/ 然后/ ,/ Pl/ ∈/ Ω/ // {/ Pi/ }/ 再/ 利用/ 已知/ 的/ ci/ ,/ rij/ ,/ g/ ,/ h/ ,/ Xij/ ,/ Yij/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ,/ 计算/ a1ij/ 和/ a2ij/ :/ a1ij/ =/ grijXciijmodp/ ,/ a2ij/ =/ yrij/ 验证/ 式/ (/ 3/ )/ 是否/ 成立/ ./ 若/ 成立/ ,/ 则/ 表明/ 成员/ Pi/ 分发/ 的/ Yij/ 是/ 正确/ 的/ ./ 否则/ ,/ 广播/ 对/ 成员/ Pi/ 的/ 指控/ ,/ 经过/ 不少/ 于/ t/ 个/ 成员/ 的/ 确认/ 后/ ,/ 将/ Pi/ 加入/ 不诚实/ 成员/ 集合/ A/ ,/ A/ =/ A/ ∪/ {/ Pi/ }/ ./ ⑤/ 任何/ 成员/ 都/ 可以/ 通过/ 下面/ 等式/ 验证/ (/ j/ ,/ fi/ (/ j/ )/ )/ ,/ (/ j/ =/ n/ +/ 1/ ,/ …/ ,/ n/ +/ m/ -/ t/ )/ 是否/ 成立/ 若/ 成立/ ,/ 则/ 表明/ 成员/ Pi/ 公开/ 的/ fi/ (/ j/ )/ (/ j/ =/ n/ +/ 1/ ,/ …/ ,/ n/ +/ m/ -/ t/ )/ 是/ 正确/ 的/ ./ 否则/ ,/ 广播/ 对/ 成员/ Pi/ 的/ 指控/ ,/ 经过/ 超过/ t/ 个/ 成员/ 的/ 确认/ 后/ ,/ 将/ Pi/ 加入/ 不诚实/ 成员/ 集合/ A/ ,/ A/ =/ A/ ∪/ {/ Pi/ }/ ./ ⑥/ 所有/ 成员/ 都/ 分发/ 了/ 子/ 秘密/ 份额/ 后/ ,/ 每个/ 成员/ Pj/ ∈/ Ω/ 可/ 计算/ 出/ 加密/ 的/ 秘密/ 份额/ Yj/ =/ ∏/ Pi/ ∈/ Ω/ -/ APage5/ 再/ 利用/ 私钥/ zj/ 从/ 加密/ 秘密/ 份额/ Yj/ 中/ 计算/ 出/ 最终/ 的/ 秘密/ 份额/ Sj/ =/ Yz/ -/ 1/ ⑦/ 每个/ 成员/ Pj/ ∈/ Ω/ 计算/ 联合/ 生成/ 多项式/ 的/ 另外/ m/ -/ t/ 个/ 份额/ Tj/ =/ ∏/ Pi/ ∈/ Ω/ -/ A/ (/ 2/ )/ 密钥/ 恢复/ 阶段/ 参与/ 秘密/ 恢复/ 的/ 成员/ Pj/ ∈/ Ω/ 提供/ Sj/ ,/ 并/ 按/ 下面/ 的/ 步骤/ 向/ 其他/ 成员/ 证明/ Sj/ 确实/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ./ ①/ 成员/ Pj/ 任意/ 选取/ wj/ ∈/ RZq/ ,/ 并/ 计算/ b1j/ =/ hwjmodp/ ,/ b2j/ =/ Swjjmodp/ ,/ rj/ =/ wj/ -/ cjzj/ (/ modq/ )/ ,/ 其中/ cj/ =/ H/ (/ b1j/ ‖/ b2j/ )/ ./ ②/ 成员/ Pj/ 公布/ (/ rj/ ,/ cj/ )/ 作为/ 他/ 知道/ 秘密/ 信息/ zj/ 的/ 证据/ ./ ③/ 其他/ 验证/ 者/ 验证/ cj/ ≡/ H/ (/ hrjycj/ 成立/ ,/ 若/ 成立/ ,/ 则/ 证明/ Sj/ 确实/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ./ ④/ 任何/ t/ 个/ 证明/ 了/ 他们/ 提供/ 了/ 正确/ 份额/ Sxi/ 的/ 成员/ Pxi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ ,/ xi/ ∈/ {/ 1/ ,/ …/ ,/ n/ }/ )/ ,/ 通过/ 执行/ CMS/ (/ p/ ,/ q/ ,/ Gq/ ,/ g/ ,/ m/ ,/ Sx1/ ,/ Sx2/ ,/ …/ ,/ Sxt/ ,/ Tn/ +/ 1/ ,/ …/ ,/ Tn/ +/ m/ -/ t/ )/ 算法/ ,/ 就/ 可以/ 输出/ m/ 个/ 联合/ 产生/ 的/ 随机/ 秘密/ k0/ ,/ k1/ ,/ …/ ,/ km/ -/ 1.4/ 安全性/ 分析/ 定理/ 1/ ./ 当/ n/ / 2t/ -/ 1/ 时/ ,/ 即使/ 存在/ 多达/ t/ -/ 1/ 个/ 成员/ 是/ 不诚实/ 的/ ,/ 通过/ 提出/ 方案/ ,/ 各/ 诚实/ 成员/ 在/ 分发/ 阶段/ 仍然/ 可以/ 获得/ 正确/ 的/ 份额/ ,/ 在/ 秘密/ 恢复/ 阶段/ ,/ 仍然/ 可以/ 恢复/ 出/ 正确/ 的/ 秘密/ ./ 证明/ ./ 首先/ ,/ 考虑/ m/ / t/ 的/ 时候/ ./ 在/ 密钥/ 产生/ 阶段/ ,/ 当/ 成员/ Pi/ 分发/ 了/ 份额/ 后/ ,/ 验证/ 者/ 利用/ 公开/ 的/ cij/ ,/ rij/ 计算/ a1ij/ ,/ a2ij/ ,/ 然后/ 把/ 得到/ 的/ a1ij/ ,/ a2ij/ 与/ g/ ,/ h/ ,/ Xij/ ,/ Yij/ 代入/ 式/ (/ 2/ )/ ,/ 如果/ 得到/ 的/ 结果/ 与/ 成员/ Pi/ 所/ 公布/ 的/ cij/ 相同/ ,/ 则/ 说明/ 成员/ Pi/ 分发/ 了/ 正确/ 的/ 份额/ ;/ 否则/ ,/ 当/ a1ij/ ,/ a2ij/ ,/ g/ ,/ h/ ,/ Xij/ ,/ Yij/ 中/ 的/ 任何/ 一个/ 值/ 有误/ 时/ ,/ 等式/ (/ 2/ )/ 均/ 不/ 成立/ ,/ 说明/ 成员/ Pi/ 分发/ 了/ 错误/ 的/ 份额/ ./ 事实上/ ,/ 如果/ 成员/ Pi/ 分发/ 了/ 正确/ 的/ 份额/ ,/ 那么/ grijXcijjycijfi/ (/ j/ )/ ywij/ -/ cijfi/ (/ j/ )/ 过/ 自己/ 的/ 私钥/ 解密/ Yj/ ,/ 获取/ 自己/ 正确/ 的/ 份额/ Sj/ =/ Yz/ -/ 1jmodp/ ./ 密钥/ 恢复/ 阶段/ ,/ 只有/ 当/ Sj/ 确实/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ,/ Pj/ 才能/ 通过/ ①/ ~/ ③/ 的/ 零/ 知识/ 证明/ 步骤/ ,/ 事实上/ ,/ 假设/ Sj/ 是从/ Yj/ 中/ 解密/ 出来/ 的/ ,/ 也/ 就是/ Sj/ =/ Yz/ -/ 1ij/ =/ gwij/ -/ cijfi/ (/ j/ )/ gcijfi/ (/ j/ )/ =/ gwij/ (/ modp/ )/ ,/ yrijjjjmodp/ ,/ 有/ Yj/ =/ Szjhwj/ -/ cjzjhzjcj/ =/ hwj/ =/ b1j/ (/ modp/ )/ ,/ Srjj/ =/ b2j/ =/ (/ modp/ )/ ./ 因为/ n/ / 2t/ -/ 1/ ,/ 即使/ 存在/ 多达/ Swjt/ -/ 1/ 个/ 成员/ 是/ 不诚实/ 的/ ,/ 仍然/ 有/ 不少/ 于/ t/ 个/ 成员/ 是/ 诚实/ 的/ ,/ 通过/ 这些/ 诚实/ 成员/ 仍然/ 可以/ 在/ ④/ 步中/ 联合/ 产生/ 共享/ 的/ 秘密/ ./ 相似/ 的/ ,/ 在/ m/ >/ t/ 时/ ,/ 定理/ 仍然/ 成立/ ./ 证毕/ ./ 定理/ 2/ ./ 若/ Diffie/ -/ Hellman/ 假设/ 成立/ ,/ 则/ 提出/ 方案/ 中/ 的/ 份额/ 加密算法/ 是/ 安全/ 的/ ./ fi/ (/ j/ )/ )/ ,/ 注意/ 到/ Xj/ =/ ∏/ Pi/ ∈/ Ω/ -/ A/ 证明/ ./ 假设/ 提出/ 方案/ 中/ 的/ 份额/ 加密算法/ 是/ 不/ 安全/ 的/ ,/ 即/ 存在/ 算法/ I/ 能/ 攻破/ 份额/ 加密算法/ ,/ 可以/ 利用/ 算法/ I/ 来/ 攻击/ Diffie/ -/ Hellman/ 假设/ ./ 假设/ 给定/ 输入/ g/ ,/ h/ ,/ Xij/ ,/ yj/ ,/ Yij/ (/ Pi/ ∈/ Ω/ -/ A/ )/ ,/ 算法/ I/ 能以/ 某个/ 不可/ 忽略/ 概率/ ε/ 成功/ 计算/ 出/ Pj/ 的/ 份额/ Sj/ (/ =/ hf/ (/ j/ )/ =/ h/ ∑/ Pi/ ∈/ Ω/ -/ A/ 定/ g/ α/ 和/ g/ β/ ,/ 我们/ 的/ 目标/ 是/ 使用/ 算法/ I/ 计算/ z/ =/ g/ α/ β/ ./ 令/ i/ =/ {/ min/ (/ i/ )/ |/ Pi/ ∈/ Ω/ -/ A/ }/ ,/ 选择/ α/ ,/ β/ i/ ,/ γ/ i/ (/ Pi/ ∈/ Ω/ -/ A/ )/ ,/ 提供/ 给/ 算法/ I/ 一/ 随机/ 输入/ g/ ,/ h/ =/ g/ α/ α/ ,/ Xij/ =/ g/ β/ β/ i/ ,/ Xij/ =/ g/ β/ i/ (/ Pi/ ∈/ Ω/ -/ A/ 且/ i/ ≠/ i/ )/ ,/ yj/ =/ h/ γ/ ,/ Yij/ =/ h/ β/ i/ γ/ ,/ Yij/ =/ h/ β/ i/ (/ Pi/ ∈/ Ω/ -/ A/ 且/ i/ ≠/ i/ )/ ,/ 则/ 算法/ I/ 能够/ 以/ ε/ 概率/ 输出/ :/ Sj/ =/ g/ α/ α/ β/ ∏/ Pi/ ∈/ Ω/ -/ A/ (/ g/ α/ α/ β/ ∏/ Pi/ ∈/ Ω/ -/ A/ 中/ 的/ 份额/ 加密算法/ 是/ 安全/ 的/ ./ 这/ 与/ Diffie/ -/ Hellman/ 假设/ 矛盾/ ,/ 所以/ 提出/ 方案/ 定理/ 3/ ./ 提出/ 的/ 方案/ 中/ ,/ 若/ Diffie/ -/ Hellman/ 假设/ 成立/ ,/ 则/ 任意/ t/ -/ 1/ 个/ 成员/ 利用/ 他们/ 的/ 份额/ 都/ 不能/ 恢复/ 出/ 任何/ 秘密/ ./ 证明/ ./ 利用/ 反证法/ ,/ 假设/ 攻击者/ 知道/ t/ -/ 1/ 个/ 成员/ 的/ 子/ 密钥/ ,/ 并/ 能/ 利用/ 这/ t/ -/ 1/ 个/ 成员/ 的/ 子/ 密钥/ 恢复/ 出/ 某个/ 秘密/ ./ 不失/ 一般性/ ,/ 假设/ 这/ t/ -/ 1/ 个/ 成员/ 是/ 前/ t/ -/ 1/ 个/ 成员/ Pi/ (/ i/ =/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ ,/ 恢复/ 的/ 秘密/ 是/ k1/ ./ 首先/ ,/ 考虑/ m/ / t/ 的/ 情况/ ./ 假定/ 每个/ 成员/ Pi/ 选择/ 的/ 多项式/ 为/ fi/ (/ x/ )/ =/ ∑/ t/ -/ 1/ 秘密/ 多项式/ 为/ f/ (/ x/ )/ =/ a0/ +/ a1x/ +/ …/ +/ at/ -/ 1xt/ -/ 1/ (/ modq/ )/ ,/ 因此/ f/ (/ x/ )/ =/ ∑/ Pi/ ∈/ Ω/ -/ A/ 攻击者/ I/ 在/ 实际/ 协议/ 中/ 的/ 所有/ 观察/ ,/ 设置/ 如下/ :/ Ci1/ (/ gai1/ )/ 满足/ ∏/ Pi/ ∈/ Ω/ -/ Ag/ β/ (/ a1/ =/ β/ )/ ,/ 也/ 隐含/ 确定/ 了/ ai1/ ./ (/ 1/ )/ 令/ h/ =/ g/ α/ ,/ 对/ 所有/ Pi/ ∈/ Ω/ -/ A/ ,/ 随机/ 选择/ Page6/ (/ 2/ )/ 对/ 所有/ 的/ i/ =/ 1/ ,/ …/ ,/ n/ ,/ 随机/ 选取/ t/ -/ 1/ 个值/ fi/ (/ 1/ )/ ,/ fi/ (/ 2/ )/ ,/ …/ ,/ fi/ (/ t/ -/ 1/ )/ ∈/ RZq/ ,/ 这/ t/ -/ 1/ 个值/ 和/ 所有/ Ci1/ 就/ 固定/ 了/ 函数/ fi/ (/ x/ )/ ./ (/ 3/ )/ 计算/ 前/ t/ -/ 1/ 个/ Xij/ 和/ Yij/ 的/ 值/ :/ Xij/ =/ gfi/ (/ j/ )/ ,/ j/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ -/ 1/ )/ ./ (/ 4/ )/ 下面/ 利用/ 公开/ 值/ 和/ 固定/ 的/ Ci1/ 值来/ 计算/ CijYij/ =/ yfi/ (/ j/ )/ (/ j/ =/ 0/ ,/ 2/ ,/ 3/ ,/ …/ ,/ t/ -/ 1/ )/ ./ 由/ fi/ (/ x/ )/ =/ ∑/ t/ -/ 1/ 可得/ 11/ …/ 1/ 烄/ 122/ …/ 2t/ -/ 1/ …/ …/ …/ …/ 1/ (/ t/ -/ 1/ )/ 2/ …/ (/ t/ -/ 1/ )/ t/ -/ 烆/ 烄/ fi/ (/ t/ -/ 1/ )/ -/ ai1/ ·/ (/ t/ -/ 1/ 烆/ 烄/ 记/ 犃/ =/ 烆/ 是/ t/ -/ 1/ ,/ 所以/ ,/ 它/ 必有/ 逆/ 矩阵/ ,/ 记/ 为/ 犃/ -/ 1/ ,/ 不妨/ 设/ 求解/ 的/ 犃/ -/ 1/ =/ 可以/ 写成/ 另/ 一种/ 形式/ 烄/ 烆/ ai/ (/ t/ -/ 1/ 故/ aij/ =/ ∑/ t/ -/ 1/ 可得/ gaij/ =/ g/ ∑/ t/ -/ 1/ 即/ Cij/ =/ ∏/ t/ -/ 1/ (/ 5/ )/ 计算/ 其余/ 的/ Xij/ ,/ Xij/ =/ ∏/ i/ -/ 1/ (/ 1/ )/ 令/ h/ =/ g/ α/ ,/ 对/ 所有/ Pi/ ∈/ Ω/ -/ A/ ,/ 随机/ 选择/ (/ 6/ )/ 最后/ ,/ 构造/ yi/ ,/ Yij/ (/ j/ =/ t/ ,/ …/ n/ )/ ./ 随机/ 选取/ uj/ ∈/ RZq/ (/ j/ =/ t/ ,/ …/ ,/ n/ )/ ,/ 令/ yj/ =/ guj/ ,/ Yij/ =/ (/ Xij/ )/ ui/ (/ i/ =/ t/ ,/ …/ ,/ n/ )/ ./ 则/ Yij/ 满足/ Yij/ ≡/ yfi/ (/ j/ )/ (/ Xij/ )/ uj/ =/ (/ gfi/ (/ j/ )/ )/ uj/ =/ (/ guj/ )/ fi/ (/ j/ )/ =/ (/ yj/ )/ fi/ (/ j/ )/ ./ 通过/ 以上/ 模型/ 系统/ 就/ 可以/ 模拟/ 敌手/ 的/ 所有/ 观察/ ./ 由于/ 已/ 假设/ t/ -/ 1/ 个/ 成员/ Pi/ (/ i/ =/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ 可以/ 恢复/ 出/ 秘密/ k1/ =/ ha1/ ,/ 又/ 因为/ h/ =/ g/ α/ ,/ C1/ =/ g/ β/ ./ 所以/ ,/ 这/ t/ -/ 1/ 个/ 成员/ 通过/ 模拟器/ 必/ 可以/ 计算/ 出/ g/ α/ β/ =/ (/ g/ α/ )/ β/ =/ ha1/ =/ k1/ ,/ 这/ 与/ Diffie/ -/ Hellman/ 假设/ 矛盾/ ./ 然后/ ,/ 考虑/ m/ >/ t/ 的/ 情况/ ,/ 假定/ 成员/ Pi/ 选择/ 的/ 多项式/ 为/ fi/ (/ x/ )/ =/ ∑/ m/ -/ 1/ 密/ 多项式/ 为/ f/ (/ x/ )/ =/ a0/ +/ a1x/ +/ …/ +/ am/ -/ 1xm/ -/ 1/ (/ modq/ )/ ,/ 因此/ f/ (/ x/ )/ =/ ∑/ Pi/ ∈/ Ω/ -/ A/ 攻击者/ I/ 在/ 实际/ 协议/ 中/ 的/ 所有/ 观察/ ,/ 设置/ 如下/ :/ Ci1/ (/ gai1/ )/ 满足/ ∏/ Pi/ ∈/ Ω/ -/ Ag/ β/ (/ a1/ =/ β/ )/ ,/ 也/ 隐含/ 确定/ 了/ ai1/ ./ n/ +/ 1/ ,/ …/ ,/ m/ +/ n/ -/ t/ )/ ,/ 计算/ f/ (/ j/ )/ =/ ∑/ Pi/ ∈/ Ω/ -/ A/ (/ j/ =/ n/ +/ 1/ ,/ …/ ,/ m/ +/ n/ -/ t/ )/ ./ 随机/ 选取/ t/ -/ 1/ 个值/ fi/ (/ 1/ )/ ,/ fi/ (/ 2/ )/ ,/ …/ ,/ fi/ (/ t/ -/ 1/ )/ ∈/ RZq/ ,/ 这/ t/ -/ 1/ 个值/ 和/ fi/ (/ j/ )/ (/ j/ =/ n/ +/ 1/ ,/ …/ ,/ m/ +/ n/ -/ t/ )/ 以及/ Ci1/ 就/ 固定/ 了/ 函数/ fi/ (/ x/ )/ ./ (/ 3/ )/ 计算/ 前/ t/ -/ 1/ 个/ Xij/ 和/ Yij/ 的/ 值/ :/ Xij/ =/ gfi/ (/ j/ )/ ,/ j/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ t/ -/ 1/ )/ ./ Yij/ =/ yfi/ (/ j/ )/ (/ 4/ )/ 利用/ 公开/ 值/ 和/ 固定/ 的/ Ci1/ 值来/ 计算/ Cij/ (/ j/ =/ 0/ ,/ 2/ ,/ 3/ ,/ …/ ,/ m/ -/ 1/ )/ ./ 由/ fi/ (/ x/ )/ =/ ∑/ m/ -/ 1/ 式/ (/ 4/ )/ 求解/ aij/ 的/ 方法/ 相似/ ,/ 可以/ 知道/ aij/ =/ ∑/ t/ -/ 1/ 这里/ (/ j/ =/ 0/ ,/ 2/ ,/ 3/ ,/ …/ ,/ m/ -/ 1/ )/ ,/ bji/ 是/ 相应/ 系数/ 矩阵/ 的/ 逆/ 矩阵/ 中/ 的/ 对应/ 元素/ ./ 因此/ (/ 2/ )/ 对/ 所有/ 的/ i/ =/ 1/ ,/ …/ ,/ n/ ,/ 根据/ 公开/ 的/ fi/ (/ j/ )/ (/ j/ =/ t/ ,/ …/ ,/ n/ )/ ./ l/ =/ 1gaij/ =/ g/ ∑/ t/ -/ 1Page7/ 即/ Cij/ =/ ∏/ t/ -/ 1/ 这里/ ,/ j/ =/ 0/ ,/ 2/ ,/ 3/ ,/ …/ ,/ m/ -/ 1/ ./ l/ =/ 1/ (/ 5/ )/ 计算/ 其余/ 的/ Xij/ ,/ Xij/ =/ ∏/ t/ -/ 1t/ ,/ …/ ,/ n/ )/ ./ (/ 6/ )/ 最后/ ,/ 构造/ yi/ ,/ Yij/ (/ j/ =/ t/ ,/ …/ ,/ n/ )/ ./ 随机/ 选取/ uj/ ∈/ RZq/ (/ j/ =/ t/ ,/ …/ ,/ n/ )/ ,/ 令/ yj/ =/ guj/ ,/ Yij/ =/ (/ Xij/ )/ ui/ ,/ 这里/ i/ =/ t/ ,/ …/ ,/ n/ ./ 则/ Yij/ 满足/ Yij/ ≡/ yfi/ (/ j/ )/ (/ Xij/ )/ uj/ =/ (/ gfi/ (/ j/ )/ )/ uj/ =/ (/ guj/ )/ fi/ (/ j/ )/ =/ (/ yj/ )/ fi/ (/ j/ )/ ./ 通过/ 以上/ 模型/ 系统/ 就/ 可以/ 模拟/ 敌手/ 的/ 所有/ 观察/ ./ 因为/ 已/ 假设/ t/ -/ 1/ 个/ 成员/ Pi/ (/ i/ =/ 1/ ,/ …/ ,/ t/ -/ 1/ )/ 可以/ 恢复/ 出/ 秘密/ k1/ =/ ha1/ ,/ 又/ 因为/ h/ =/ g/ α/ ,/ C1/ =/ g/ β/ ,/ 所以/ 这/ t/ -/ 1/ 个/ 成员/ 通过/ 模拟器/ 必/ 可以/ 计算/ 出/ g/ α/ β/ =/ (/ g/ α/ )/ β/ =/ ha1/ =/ k1/ ,/ 这/ 与/ Diffie/ -/ Hellman/ 假设/ 矛盾/ ./ 证毕/ ./ 5/ 相关/ 工作/ 的/ 比较/ 下面/ 该文/ 将/ 提出/ 的/ 方案/ 与/ 文献/ [/ 3/ ]/ 的/ 方案/ 、/ 文献/ [/ 6/ ]/ 的/ 方案/ 、/ 文献/ [/ 7/ ]/ 的/ 方案/ 、/ 文献/ [/ 8/ -/ 9/ ]/ 的/ 方案/ 和/ 文献/ [/ 10/ ]/ 的/ 方案/ 进行/ 比较/ ./ 文献/ [/ 3/ ]/ 的/ 方案/ 能/ 对/ 份额/ 进行/ 验证/ ,/ 但/ 不能/ 公开/ 验证/ 份额/ ,/ 且/ 不能/ 一次/ 对/ 多个/ 秘密/ 进行/ 共享/ ./ 文献/ [/ 6/ ]/ 的/ 方案/ 虽然/ 能/ 公开/ 验证/ 份额/ ,/ 但/ 也/ 不能/ 同时/ 对/ 多个/ 秘密/ 进行/ 共享/ ,/ 且/ 需要/ 可信/ 中心/ ./ 文献/ [/ 7/ ]/ 的/ 方案/ 虽然/ 不/ 需要/ 可信/ 中心/ ,/ 但/ 只能/ 一次/ 对/ 单个/ 秘密/ 进行/ 共享/ ./ 文献/ [/ 8/ -/ 9/ ]/ 的/ 方案/ 能/ 一次/ 对/ 任意/ 多个/ 秘密/ 进行/ 共享/ ,/ 但/ 不/ 具有/ 可/ (/ 公开/ )/ 验证/ 能力/ ,/ 也/ 需要/ 可信/ 中心/ 的/ 参与/ ./ 文献/ [/ 10/ ]/ 的/ 方案/ 能/ 一次/ 对/ 多个/ 秘密/ 进行/ 共享/ ,/ 但/ 不/ 具有/ 公开/ 验证/ 的/ 能力/ ,/ 且/ 需要/ 可信/ 中心/ 的/ 参与/ ./ 该文/ 提出/ 的/ 多/ 秘密/ 方案/ ,/ 不仅/ 能/ 公开/ 验证/ 份额/ ,/ 而且/ 不/ 需要/ 可信/ 中心/ ,/ 这/ 使得/ 方案/ 具有/ 更广/ 的/ 应用/ ,/ 如/ 应用/ 于/ 可/ 撤销/ 匿名性/ 的/ 电子/ 支付/ 协议/ 及/ 电子/ 选举/ 协议/ 等/ ./ 表/ 1/ 给出/ 了/ 几种/ 秘密/ 共享/ 方案/ 在/ 相关/ 方面/ 的/ 比较/ ./ 方案/ 是否/ 能/ 文献/ [/ 3/ ]/ 的/ 方案/ 是否/ 否否/ 文献/ [/ 6/ ]/ 的/ 方案/ 是/ 是否/ 否/ 文献/ [/ 7/ ]/ 的/ 方案/ 是否/ 否是/ 文献/ [/ 8/ -/ 9/ ]/ 的/ 方案/ 否否/ 是否/ 文献/ [/ 10/ ]/ 的/ 方案/ 是否/ 是否/ 提出/ 的/ 方案/ 是/ 是/ 是/ 是/ 6/ 成员/ 的/ 动态/ 加入/ 和/ 删除/ 在/ 一些/ 实际/ 的/ 网络/ 环境/ 诸如/ 无线/ 自/ 组网/ 中/ ,/ 秘密/ 共享/ 在/ 密钥/ 管理/ 等/ 方面/ 发挥/ 着/ 重要/ 的/ 作用/ ./ 然而/ ,/ 这些/ 网络/ 中/ ,/ 难以/ 存在/ 可信/ 中心/ 且/ 成员/ 往往/ 需要/ 动态变化/ ./ 因此/ ,/ 如何/ 在/ 无/ 可信/ 中心/ 的/ 情况/ 下/ 实现/ 成员/ 的/ 动态/ 撤出/ 和/ 加入/ 是/ 十分/ 有/ 意义/ 的/ 工作/ ./ 上述/ 提出/ 的/ 方案/ 实现/ 成员/ 的/ 撤出/ 是/ 十分/ 容易/ 的/ ,/ 如果/ 成员/ Pi/ 需要/ 撤出/ 多/ 秘密/ 共享/ 方案/ 时/ ,/ 只/ 需/ 所有/ 成员/ 将/ Pi/ 的/ 公钥/ yi/ 注销/ ,/ 在/ 以后/ 秘密/ 恢复/ 阶段/ ,/ 不再/ 接受/ Pi/ 的/ 份额/ 即可/ ./ 当/ 成员/ Pn/ +/ 1/ 加入/ 上述/ 多/ 秘密/ 共享/ 方案/ 时/ ,/ 可/ 利用/ 文献/ [/ 15/ ]/ 的/ 思想/ ,/ 执行/ 下面/ 的/ 协议/ 完成/ ./ 令/ B/ 表示/ 协议/ 执行/ 时/ 不诚实/ 的/ 成员/ 集合/ ,/ 初始化/ B/ =/ / ./ (/ 1/ )/ 首先/ ,/ Pn/ +/ 1/ 选择/ 他/ 的/ 私钥/ zn/ +/ 1/ ∈/ Zq/ ,/ 公开/ 对/ (/ 2/ )/ 每个/ 成员/ Pi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 选择/ 一/ 随机/ 多应/ 的/ 公钥/ yn/ +/ 1/ =/ hzn/ +/ 1/ (/ modp/ )/ ./ 项式/ gi/ (/ x/ )/ =/ ∑/ t/ -/ 1gbij/ (/ modp/ )/ ,/ 0/ / j/ / t/ -/ 1/ 和/ Zij/ =/ ygi/ (/ j/ )/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ ./ 令/ Eij/ =/ ∏/ t/ -/ 1ggi/ (/ j/ )/ (/ modp/ )/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ ./ 随机数/ wij/ ∈/ RZ/ / gwij/ (/ modp/ )/ ,/ a2ij/ =/ ywijj/ (/ modp/ )/ ,/ 这里/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ ./ 然后/ 构造/ 质询/ 值/ ci/ =/ H/ (/ g/ ‖/ y1/ ‖/ …/ ‖/ yn/ +/ 1/ ‖/ Ei1/ ‖/ …/ ‖/ Ei/ (/ n/ +/ 1/ )/ ‖/ Zi1/ ‖/ …/ ‖/ Zi/ (/ n/ +/ 1/ )/ ‖/ a1i1/ ‖/ …/ ‖/ a1i/ (/ n/ +/ 1/ )/ ‖/ a2i1/ ‖/ …/ ‖/ a2i/ (/ n/ +/ 1/ )/ )/ (/ 3/ )/ 每个/ 成员/ Pi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 选择/ n/ +/ 1/ 个/ 并/ 计算/ Ri/ =/ (/ ri1/ ,/ …/ ,/ ri/ (/ n/ +/ 1/ )/ )/ =/ (/ wi1/ -/ cigi/ (/ 1/ )/ (/ modq/ )/ ,/ …/ ,/ wi/ (/ n/ +/ 1/ )/ -/ cigi/ (/ n/ +/ 1/ )/ (/ modq/ )/ )/ ./ 最后/ ,/ 公布/ 证据/ ProofPi/ =/ (/ ci/ ,/ Ri/ )/ ./ (/ 4/ )/ 成员/ Pn/ +/ 1/ 对于/ 每个/ j/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ )/ ,/ 先/ 计算/ Eij/ =/ ∏/ t/ -/ 1/ 算/ a1ij/ =/ grijEci/ 后/ ,/ 验证/ 等式/ (/ 5/ )/ 是否/ 成立/ ./ 若/ 成立/ ,/ 则/ 表明/ 成员/ Pi/ 分发/ 的/ Zij/ 是/ 正确/ 的/ ,/ Pn/ +/ 1/ 计算/ δ/ i/ (/ n/ +/ 1/ )/ =/ (/ Zi/ (/ n/ +/ 1/ )/ )/ z/ -/ 1Page8/ 否则/ ,/ 广播/ 对/ 成员/ Pi/ 的/ 指控/ ,/ 经过/ 不少/ 于/ t/ 个/ 成员/ 的/ 确认/ 后/ ,/ 将/ Pi/ 加入/ 不诚实/ 成员/ 集合/ B/ ,/ 令/ B/ =/ B/ ∪/ {/ Pi/ }/ ./ 最后/ ,/ Pn/ +/ 1/ 计算/ δ/ n/ +/ 1/ =/ ∏/ Pi/ ∈/ Ω/ -/ B/ (/ 5/ )/ 每个/ 成员/ Pk/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 对于/ 每个/ j/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ )/ 需/ 验证/ Pi/ 分发/ 的/ Zij/ 是否/ 正确/ ./ 先/ 计算/ Eij/ =/ ∏/ t/ -/ 1/ 计算/ a1ij/ =/ grijEci/ 然后/ ,/ 验证/ 等式/ (/ 5/ )/ 是否/ 正确/ ./ 若/ 成立/ ,/ 则/ 表明/ 成员/ Pi/ 分发/ 的/ Zij/ 是/ 正确/ 的/ ;/ 否则/ ,/ 广播/ 对/ 成员/ Pi/ 的/ 指控/ ,/ 经过/ 不少/ 于/ t/ 个/ 成员/ 的/ 确认/ 后/ ,/ 将/ Pi/ 加入/ 不诚实/ 成员/ 集合/ B/ ,/ 令/ B/ =/ B/ ∪/ {/ Pi/ }/ ./ (/ 6/ )/ 每个/ 成员/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 计算/ Sj/ =/ Sj/ ·/ ∏/ Pi/ ∈/ Ω/ -/ B/ δ/ ij/ (/ modp/ )/ ./ (/ 7/ )/ 每个/ 成员/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 选择/ wj/ (/ n/ +/ 1/ )/ ∈/ RZ/ / q/ ,/ 先/ 计算/ a1j/ (/ n/ +/ 1/ )/ =/ hwj/ (/ n/ +/ 1/ )/ (/ modp/ )/ 和/ a2j/ (/ n/ +/ 1/ )/ =/ wj/ (/ n/ +/ 1/ )/ (/ modp/ )/ ;/ 再/ 计算/ Sjcj/ (/ n/ +/ 1/ )/ =/ (/ h/ ‖/ Sj/ ‖/ yj/ ‖/ Yj/ ∏/ Pi/ ∈/ Ω/ -/ B/ 最后/ ,/ 公布/ ProofPi/ =/ (/ cj/ (/ n/ +/ 1/ )/ ,/ rj/ (/ n/ +/ 1/ )/ )/ ./ Sj/ (/ yn/ +/ 1/ )/ zj/ (/ modp/ )/ ./ (/ 8/ )/ 每个/ 成员/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 计算/ 并/ 广播/ θ/ j/ =/ l/ =/ 0/ (/ 9/ )/ 成员/ Pn/ +/ 1/ 解密/ θ/ j/ ·/ (/ yzn/ +/ 1j/ )/ -/ 1/ =/ Sj/ (/ yn/ +/ 1/ )/ zj/ ·/ (/ yzn/ +/ 1j/ )/ -/ 1/ =/ Sjhzn/ +/ 1zj/ ·/ h/ -/ zjzn/ +/ 1/ =/ Sj/ (/ modp/ )/ ,/ 并/ 计算/ a1j/ (/ n/ +/ 1/ )/ =/ hrj/ (/ n/ +/ 1/ )/ rj/ (/ n/ +/ 1/ )/ Yj/ ∏/ Pi/ ∈/ Ω/ -/ BSj/ 式/ (/ 6/ )/ 是否/ 成立/ ./ 成员/ Pn/ +/ 1/ 选择/ t/ 个/ 通过/ 上述/ 验证/ 的/ 成员/ 的/ 编号/ j/ (/ j/ ∈/ Λ/ ,/ |/ Λ/ |/ =/ t/ )/ ,/ 最后/ 计算/ 它/ 的/ 份额/ Sn/ +/ 1/ =/ ∏/ j/ ∈/ Λ/ 1/ )/ =/ ∏/ i/ ∈/ Λ/ 在/ 上述/ 协议/ 的/ (/ 2/ )/ (/ 3/ )/ 步中/ ,/ 成员/ Pi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 产生/ 随机/ 份额/ δ/ ij/ 将/ 其/ 加密/ 的/ 版本/ Zij/ 分/ 发给/ 成员/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ )/ ;/ 在/ 第/ (/ 4/ )/ (/ 5/ )/ 步中/ ,/ Pn/ +/ 1/ 和/ Pk/ (/ k/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 验证/ Zij/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ +/ 1/ )/ 是否是/ 正确/ 的/ 加密/ 版本/ ,/ 并/ 分别/ 解密/ 获取/ δ/ i/ (/ n/ +/ 1/ )/ 和/ δ/ ij/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ ;/ 在/ (/ 6/ )/ 步中/ ,/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 计算/ 份额/ Sj/ 的/ 盲化/ 版本/ Sj/ ;/ 在/ 第/ (/ 7/ )/ (/ 8/ )/ 步中/ ,/ Pj/ (/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 将/ Sj/ 加密/ 成/ θ/ j/ 发送给/ Pn/ +/ 1/ ,/ 并/ 证明/ 它/ 是/ 一个/ 正确/ 的/ 加密/ 版本/ ;/ 在/ 第/ (/ 9/ )/ 步中/ ,/ 成员/ Pn/ +/ 1/ 解密/ Sj/ 的/ 盲化/ 版本/ Sj/ ,/ 并/ 验证/ 其/ 正确性/ ,/ 最后/ 插值/ 并解/ 盲化/ 获取/ 其/ 份额/ Sn/ +/ 1.7/ 结论/ 本文/ 提出/ 了/ 一个/ 无/ 可信/ 中心/ 的/ 可/ 公开/ 验证/ 多/ 秘密/ 共享/ 方案/ ,/ 在/ 没有/ 可信/ 分发/ 中心/ 的/ 情况/ 下/ ,/ 所有/ 成员/ 可/ 一次性/ 联合/ 生成/ 多个/ 随机/ 秘密/ ,/ 任意/ t/ 个/ 成员/ 只要/ 拿出/ 正确/ 的/ 秘密/ 份额/ 就/ 可/ 恢复/ 出/ 秘密/ ./ 方案/ 中/ ,/ 份额/ 的/ 正确性/ 不但/ 能/ 被/ 份额/ 持有者/ 验证/ ,/ 还/ 可以/ 被/ 任何/ 其他/ 成员/ 验证/ ./ 本文/ 证明/ 了/ 方案/ 的/ 安全性/ ,/ 也/ 给出/ 了/ 与/ 其他/ 相关/ 工作/ 的/ 对比/ ./ 最后/ ,/ 讨论/ 了/ 在/ 无/ 可信/ 中心/ 的/ 条件/ 下/ 成员/ 的/ 动态/ 撤出/ 和/ 加入/ 问题/ ./ 

