Page1/ 一种/ 基于/ 人工免疫/ 和/ 代码/ 相关性/ 的/ 计算机病毒/ 特征提取/ 方法/ 王维/ 张鹏涛/ 谭营何/ 新贵/ (/ 北京大学/ 信息/ 科学技术/ 学院/ 智能科学/ 系/ 北京/ 100871/ )/ (/ 机器/ 感知/ 与/ 智能/ 教育部/ 重点/ 实验室/ 北京/ 100871/ )/ 摘要/ 现有/ 的/ 计算机病毒/ 检测/ 方法/ 利用/ 病毒/ 特征/ 码来/ 检测/ 病毒/ ,/ 已经/ 不能/ 适应/ 病毒/ 技术/ 的/ 发展/ ,/ 特别/ 是/ 其/ 无法/ 检测/ 出/ 病毒/ 的/ 新/ 变种/ 与/ 未知/ 病毒/ ./ 受/ 自然免疫/ 系统/ 的/ 启发/ ,/ 该文/ 提出/ 了/ 一种/ 基于/ 人工免疫/ 的/ 利用/ 计算机病毒/ 代码/ 相关性/ 的/ 计算机病毒/ 特征提取/ 方法/ ./ 这种/ 特征提取/ 方法/ 在/ 底层/ 提取/ 出/ 与/ 病毒/ 相关/ 的/ 字节/ 模式/ ,/ 在/ 相对/ 更/ 高/ 的/ 层面/ 上/ 记录/ 这些/ 字节/ 模式/ 之间/ 的/ 共同/ 作用/ 信息/ ,/ 之后/ 利用/ 阴性/ 选择/ 算法/ 提取/ 出/ 计算机病毒/ 检测/ 基因库/ ,/ 实现/ 了/ 对/ 训练/ 集上/ 合法/ 程序/ 的/ 完美/ 记忆/ ,/ 从而/ 保证/ 了/ 该文/ 方法/ 的/ 误判/ 率/ 处于/ 极低/ 的/ 水平/ ./ 计算机病毒/ 检测/ 基因库/ 在/ 个体/ 层上/ 存储/ 病毒/ 样本/ ,/ 一个/ 样本/ 中/ 储存/ 了/ 若干个/ 不定/ 长/ 的/ 基因/ ,/ 充分利用/ 了/ 同一个/ 样本/ 的/ 不同/ 基因/ 代码/ 之间/ 的/ 相关性/ ./ 为了/ 尽可能少/ 地/ 丢失/ 有效/ 信息/ ,/ 这种/ 方法/ 在/ 基因/ 层上/ 对/ 基因/ 进行/ 匹配/ ,/ 在/ 个体/ 层上/ 对/ 可疑/ 程序/ 进行/ 分析/ ,/ 最终/ 由/ 整个/ 计算机病毒/ 检测/ 基因库/ 做出/ 分类/ 决策/ ./ 实验/ 表明/ :/ 此/ 方法/ 对/ 未知/ 病毒/ 的/ 平均/ 识别率/ 达到/ 94/ %/ ,/ 同时/ 对/ 合法/ 程序/ 的/ 误判/ 率/ 保持/ 在/ 2/ %/ 之内/ ,/ 具有/ 较强/ 的/ 泛化/ 能力/ ,/ 能够/ 有效/ 识别/ 病毒/ 伪装/ ,/ 检测/ 出/ 已知/ 病毒/ 的/ 新/ 变种/ ,/ 对/ 未知/ 病毒/ 也/ 具有/ 较强/ 的/ 识别/ 能力/ ./ 关键词/ 病毒检测/ ;/ 人工免疫/ ;/ 特征提取/ ;/ 代码/ 相关性/ ;/ 连续/ 一致/ 匹配/ 1/ 引言/ 传统/ 的/ 计算机/ 反病毒/ 方法/ 是/ 以/ 特征/ 检测/ 为/ 基础/ 的/ ,/ 这些/ 方法/ 利用/ 从/ 病毒/ 中/ 提取/ 的/ 特定/ 特征/ 来/ 检测/ 出/ 有/ 相似/ 行为/ 的/ 病毒程序/ ./ 它们/ 对于/ 已知/ 或者/ 是/ 出现/ 过/ 的/ 病毒/ 有着/ 很/ 高/ 的/ 识别率/ ,/ 但是/ 对于/ 没有/ 出现/ 过/ 的/ 未知/ 病毒/ 或者/ 病毒/ 的/ 新/ 变种/ 缺乏/ 快速/ 而/ 准确/ 的/ 识别/ 能力/ [/ 1/ ]/ ./ 各种/ 先进/ 的/ 病毒/ 技术/ 应用/ 多态/ 或是/ 变型/ 的/ 方式/ 企图/ 逃避/ 基于/ 特征/ 的/ 检测/ ,/ 常见/ 的/ 有/ 插入/ 冗余/ 代码/ 、/ 代码/ 位置/ 调换/ 、/ 寄存器/ 的/ 重新组合/ 和/ 同义/ 指令/ 代换/ 等/ [/ 2/ ]/ ./ 病毒/ 的/ 制造者/ 们/ ,/ 针对/ 了/ 传统/ 病毒/ 的/ 扫描器/ ,/ 通过/ 类似/ 方法/ 很/ 轻易/ 地/ 改写/ 自己/ 的/ 代码/ ,/ 躲避/ 了/ 包含/ 这些/ 病毒/ 传统/ 特征/ 的/ 扫描/ ./ 启发式/ 的/ 扫描器/ 试图/ 通过/ 利用/ 病毒/ 代码/ 更/ 一般化/ 的/ 特点/ ,/ 诸如/ 结构化/ 或者/ 行为/ 化/ 模式/ ,/ 来/ 弥补/ 这一/ 缺陷/ [/ 3/ ]/ ./ 不过/ 这个/ 过程/ 需要/ 介入/ 很多/ 专家/ 知识/ ,/ 而且/ 建立/ 出/ 的/ 模型/ 常常/ 在/ 对/ 未知/ 病毒/ 的/ 高/ 识别率/ 和/ 较/ 低/ 的/ 正常/ 文件/ 误判/ 率/ 之间/ 顾此失彼/ ./ 以/ 生物体/ 为/ 原型/ 的/ 计算机系统/ 和/ 自然/ 生物/ 系统/ 有着/ 天然/ 的/ 联系/ ,/ 而/ 自然免疫/ 系统/ 又/ 具有/ 强大/ 的/ 区分/ “/ 自体/ ”/ 和/ “/ 异体/ ”/ 的/ 能力/ ,/ 这种/ 功能/ 与/ 计算机/ 安全/ 系统/ 的/ 反病毒/ 功能/ 极为/ 类似/ [/ 4/ -/ 5/ ]/ ./ 因此/ ,/ 借助/ 自然免疫/ 机理/ ,/ 如/ 阴性/ 选择/ 机理/ 、/ 克隆选择/ 机理/ 等/ 机理/ ,/ 采用/ 人工免疫/ 模型/ 来/ 识别/ 计算机/ 中/ 的/ 合法/ 程序/ (/ 称为/ “/ 自体/ ”/ )/ 和/ 病毒程序/ (/ 称为/ “/ 异体/ ”/ )/ 成为/ 病毒检测/ 的/ 一个/ 可行/ 的/ 发展/ 方向/ [/ 6/ -/ 7/ ]/ ./ 许多/ 人/ 已经/ 提出/ 了/ 应用/ 于/ 计算机/ 安全/ 方面/ 的/ 人工免疫/ 模型/ ,/ 并/ 在/ 实际/ 应用/ 中/ 取得/ 了/ 较/ 好/ 的/ 结果/ ,/ 它/ 可以/ 自动/ 无/ 监督/ 地/ 完成/ 自体/ 和/ 异体/ 的/ 区分/ ,/ 阴性/ 选择/ 原理/ 能/ 保持/ 一个/ 较/ 低/ 的/ 程序/ 误判/ 率/ ./ 但/ 其中/ 仍/ 有/ 某些/ 方面/ 并/ 不/ 完善/ [/ 8/ ]/ ./ 例如/ ,/ 泛化/ 能力/ 较差/ ,/ 只能/ 用于/ 检测/ 少量/ 的/ 病毒/ ,/ 无法/ 在/ 大/ 数据/ 集上/ 取得/ 良好/ 的/ 表现/ ;/ 生成/ 检测器/ 时/ ,/ 采用/ 随机/ 产生/ 再/ 筛选/ 的/ 方法/ ,/ 无/ 向导/ 性/ ,/ 致使/ 检测器/ 生成/ 效率/ 低下/ ;/ 没有/ 充分利用/ 多个/ 相关/ 检测器/ 间/ 的/ 相关性/ ;/ 检测器/ 的/ 长度/ 常常/ 人为/ 根据/ 经验/ 设定/ ,/ 不能/ 推广/ 到/ 更/ 广泛/ 的/ 适用/ 环境/ ;/ 另外/ ,/ 各种/ 模型/ 对/ 病毒/ 的/ 识别率/ 也/ 不/ 高/ ,/ 不能/ 满足/ 实际/ 应用/ 的/ 要求/ ./ 在/ 病毒/ 的/ 实际/ 工作/ 机理/ 中/ ,/ 一个/ 病毒/ 的/ 多个/ 指令/ 都/ 是/ 相关/ 的/ ,/ 病毒/ 多个/ 关键/ 代码/ 的/ 有机/ 结合/ 才/ 产生/ 了/ 病毒/ 作用/ ./ 之前/ 的/ 研究成果/ 往往/ 不是/ 特别/ 关注/ 于/ 此/ ,/ 特征/ 储存/ 的/ 方式/ 通常/ 是/ 独立/ 的/ ./ 基于/ 此/ 思想/ ,/ 本文/ 提出/ 了/ 一种/ 新/ 的/ 特征提取/ 方法/ ,/ 充分利用/ 了/ 组成/ 病毒/ 的/ 相关/ 指令/ 的/ 相关性/ ,/ 使得/ 病毒/ 特征/ 的/ 提取/ 在/ 个体/ 层上/ 完成/ ,/ 将/ 每个/ 病毒/ 样本/ 的/ 多个/ 指令/ 存放/ 在/ 此/ 病毒/ 样本/ 对应/ 的/ 数据库/ 空间/ 中/ ,/ 采用/ 与其/ 特征/ 生成/ 、/ 储存/ 对应/ 的/ 匹配/ 检测/ 模式/ ,/ 并/ 由此/ 建立/ 了/ 模型/ ./ 2/ 相关/ 工作/ 病毒/ 特征/ 的/ 提取/ 并非/ 一个/ 新/ 问题/ ./ Kephart/ 等/ 人/ [/ 9/ ]/ 通过/ 运用/ 少量/ 已知/ 病毒/ 对/ 大量文件/ 的/ 感染/ ,/ 之后/ 提取/ 12/ ~/ 36/ 字节/ 的/ 不同/ 常数/ 定/ 长/ 区域/ ,/ 从中/ 挑选出/ 可以/ 得到/ 最低/ 误判/ 率/ 的/ 作为/ 病毒/ 的/ 特征/ ./ 虽然/ 这种/ 方法/ 不/ 需要/ 专家/ 的/ 帮助/ 就/ 可能/ 快速/ 提取/ 出/ 病毒/ 的/ 特征/ ,/ 但是/ 作者/ 也/ 都/ 承认/ 其/ 无法/ 适用/ 于/ 检测/ 病毒/ 在/ 一定/ 程度/ 的/ 多态/ 化/ ./ 其它/ 有些/ 检测/ 方法/ 还/ 尝试/ 使用/ 诸如/ win32dll/ 调用/ 、/ ASCII/ 字符串/ 或者/ 字节/ 序列/ 作为/ 特征/ ./ Henchiri/ 和/ Japkowicz/ 针对/ 这些/ 由于/ 特定/ 训练/ 集/ 产生/ 的/ 过/ 拟合/ 特征/ 现象/ 而/ 提出/ 了/ 一种/ 基于/ 数据挖掘/ 的/ 病毒检测/ 特征提取/ 和/ 评价/ 模式/ [/ 10/ ]/ ,/ 这项/ 工作/ 关注/ 于/ 不同/ 家族/ 病毒/ 的/ 分/ 种属/ 特征/ ,/ 采用/ 数据挖掘/ 家族/ 内部/ 和/ 外部/ 区分/ 开/ 对待/ 的/ 方法/ 来/ 管理/ 一个/ 建立/ 在/ 病毒/ 集上/ 的/ 详细/ 特征/ 搜索/ ./ 受/ 免疫系统/ 阴性/ 选择/ 机制/ 启发/ ,/ Forrest/ 等/ [/ 11/ -/ 15/ ]/ 提出/ 了/ 一种/ 检测/ 异常/ 变化/ 的/ 阴性/ 选择/ 算法/ ./ 该/ 算法/ Page3/ 识别/ 自己/ 和/ 非己/ 时/ ,/ 不/ 需要/ 参考/ 非己/ 的/ 信息/ ,/ 特别/ 适用/ 于/ 未知/ 时变/ 环境/ 下/ 的/ 故障诊断/ 和/ 计算机/ 安全监控/ 等/ 情况/ ,/ 所以/ 应用/ 其/ 进行/ 病毒检测/ 是/ 很/ 合理/ 的/ ,/ 有助于/ 研究者/ 用/ 有限/ 的/ 知识/ 来/ 认识/ 和/ 解释/ 未知/ 情形/ ./ 但是/ 在/ 这种/ 阴性/ 选择/ 算法/ 下/ ,/ 特征/ 集合/ 中/ 的/ 特征/ 与/ “/ 自体/ ”/ 的/ 信息/ 数目/ 成/ 指数/ 关系/ ./ 在/ 很多/ 情况/ 下/ ,/ 如/ 计算机系统/ 中/ ,/ “/ 自体/ ”/ 的/ 信息/ 数目/ 可以/ 被/ 看做/ 是/ 足够/ 大/ 的/ ,/ 此时/ 覆盖/ 整个/ “/ 异体/ ”/ 空间/ 所/ 需/ 的/ 特征/ 数目/ 就会/ 太大/ ,/ 因此/ 难以/ 在/ 大规模/ 数据/ 中/ 进行/ 应用/ ./ 此外/ ,/ 这种/ 无/ 向导/ 地/ 随机/ 产生/ 特征/ 会/ 进行/ 大量/ 的/ 无用/ 运算/ ,/ 消耗/ 大量/ 的/ 时间/ ./ 进一步/ ,/ 利用/ 固定/ 长度/ 的/ 字符串/ 来/ 标识/ 个体/ ,/ 也/ 存在/ 一定/ 的/ 不合理性/ ./ 文献/ [/ 16/ ]/ 改进/ 了/ 阴性/ 选择/ 算法/ ,/ 给出/ 了/ 一种/ 复杂度/ 较/ 低/ 的/ 随机/ 选择/ 的/ 检测器/ 生成/ 算法/ ,/ 使/ 特征/ 数目/ 和/ “/ 自体/ ”/ 信息/ 数目/ 成/ 正比例/ 关系/ ./ 这种/ 方法/ 使/ 特征/ 的/ 数目/ 大大减少/ ,/ 但是/ 没有/ 从根本上/ 解决/ 特征/ 过多/ 的/ 问题/ ./ 在/ 此基础/ 上/ Lee/ 等/ 人/ 提出/ 了/ 一个/ 可以/ 检测/ 出/ 未知/ 病毒/ 的/ 基于/ 人工免疫/ 的/ 病毒检测/ 系统/ [/ 17/ ]/ (/ VDS/ )/ ,/ 使用/ 基于/ 病毒/ 行为/ 的/ 检测/ 方法/ 从/ 这些/ 可疑/ 程序/ 中/ 选出/ 病毒程序/ ./ 该/ 模型/ 利用/ 已有/ 知识/ 来/ 有/ 向导/ 地/ 生成/ 病毒/ 特征/ (/ 即/ 病毒基因/ )/ ,/ 是/ 对/ 阴性/ 选择/ 算法/ 的/ 一个/ 改进/ ,/ 克服/ 了/ 阴性/ 选择/ 随机/ 生成/ 特征/ 和/ 只/ 适用/ 于/ 稳定/ 系统/ 的/ 缺点/ [/ 18/ -/ 19/ ]/ ./ 从/ 特征提取/ 的/ 角度/ 来看/ ,/ 该/ 模型/ 的/ 有效性/ 受到/ 特征提取/ 区/ 、/ 比较/ 单元/ 大小/ 、/ 位置/ 等/ 因素/ 的/ 严重/ 影响/ ,/ 并且/ 一个/ 病毒/ 只有/ 一个/ 特征/ ,/ 因此/ 特征/ 长度/ 通常/ 会/ 比较/ 长/ ,/ 而/ 特征/ 长度/ 太长/ 时/ ,/ 在/ 实际/ 中是/ 不可/ 用/ 的/ ,/ 往往/ 特征/ 的/ 一个/ 小/ 平移/ 都/ 会/ 致使/ 特征/ 失效/ ./ Deng/ 等/ 人/ 简要/ 分析/ 了/ 前人/ 的/ 工作/ ,/ 提出/ 了/ 特征提取/ 需要/ 着重/ 研究/ 的/ 几个/ 方面/ [/ 2/ ]/ ,/ 具体/ 为/ :/ 使用/ 变/ 长/ 特征/ 来/ 代替/ 固定/ 长度/ 的/ 特征/ ;/ 采用/ 多个/ 特征/ 并存/ 的/ 方式/ 来/ 标识/ 一个/ 病毒/ ,/ 而/ 不是/ 只/ 采用/ 一个/ 病毒/ 特征/ ;/ 充分利用/ 病毒/ 的/ 多个/ 特征/ 间/ 的/ 相关/ 信息/ ./ Karnik/ 等/ 人/ 提出/ 了/ 一个/ 基于/ 余弦/ 相似/ 度/ 度量/ 程序/ 特征/ 的/ 方法/ ,/ 用来/ 识别/ 文件/ 的/ 多态/ 形式/ ,/ 并/ 将/ 其/ 用于/ 病毒检测/ [/ 20/ -/ 21/ ]/ ./ 他们/ 的/ 工作/ 对象/ 是/ 已知/ 一个/ 病毒/ 代码/ 的/ 变种/ ,/ 期望/ 以较/ 高/ 的/ 概率/ 检测/ 出/ 这个/ 代码/ 的/ 任何/ 伪装/ 形式/ ./ 这种/ 针对/ 代码/ 调换/ 伪装/ 技术/ 的/ 特征/ 度量/ 方法/ 对/ 本文/ 的/ 特征/ 匹配/ 采用/ 方式/ 很/ 有/ 启发/ ./ 3/ 特征/ 的/ 提取/ 方法/ 3.1/ 特征/ 的/ 有/ 向导/ 生成/ 阴性/ 选择/ 算法/ 中/ ,/ 检测器/ 集合/ 中/ 的/ 检测器/ 与/ “/ 自体/ ”/ 的/ 信息/ 数目/ 基本/ 是/ 成/ 指数/ 关系/ 的/ ./ 在/ 很多/ 情况/ 下/ ,/ 如/ 计算机系统/ 中/ ,/ “/ 自体/ ”/ 的/ 信息/ 数目/ 可以/ 被/ 看做/ 是/ 足够/ 大/ 的/ ,/ 此时/ 覆盖/ 整个/ “/ 异体/ ”/ 空间/ 所/ 需/ 的/ 检测器/ 数目/ 就会/ 太大/ ,/ 因此/ 难以/ 在/ 大规模/ 数据/ 中/ 进行/ 应用/ ./ 此外/ ,/ 这种/ 无/ 向导/ 地/ 随机/ 产生/ 检测器/ 会/ 进行/ 大量/ 的/ 无用/ 运算/ ,/ 消耗/ 大量/ 的/ 时间/ ./ 进一步/ ,/ 利用/ 固定/ 长度/ 的/ 字符串/ 来/ 标识/ 个体/ ,/ 也/ 存在/ 一定/ 的/ 不合理性/ ./ 即使/ 有些/ 方法/ 对/ 其/ 特征提取/ 进行/ 优化/ ,/ 使/ 检测器/ 数目/ 和/ “/ 自体/ ”/ 信息/ 数目/ 成/ 线性关系/ [/ 22/ ]/ ,/ 可以/ 使/ 检测器/ 的/ 数目/ 大大减少/ ,/ 但是/ 仍然/ 没有/ 从根本上/ 解决/ 检测器/ 过多/ 的/ 问题/ ,/ 并且/ 仍然/ 是/ 无/ 向导/ 生成/ 检测器/ ./ 本文/ 试图/ 根据/ 病毒/ 特征/ 在/ 各个/ 不同/ 大小/ 训练/ 集中/ 呈现出/ 的/ 显著性/ ,/ 通过/ 阈值/ 疏导/ 或者/ 截流/ ,/ 利用/ 先验/ 的/ 信息/ 最大/ 程度/ 地/ 挖掘/ 可用/ 信息/ 和/ 计算/ 代价/ 的/ 平衡/ ./ 生物体/ 的/ 遗传信息/ 主要/ 存放/ 在/ DNA/ 上/ ,/ 但/ 并/ 不是/ DNA/ 上/ 的/ 所有/ 片段/ 都/ 能/ 表达/ 遗传信息/ ./ 基因/ 才/ 是/ 具有/ 遗传/ 效应/ 的/ DNA/ 片段/ ,/ 而/ 基因/ 又/ 是/ 由/ 若干个/ 脱氧核苷/ 酸/ (/ ODN/ )/ 组成/ 的/ ./ 三者/ 之间/ 的/ 关系/ 如图/ 1/ 所示/ ./ 测/ 的/ 比较/ 单元/ ;/ 下面/ 先/ 简要/ 解释一下/ 本文/ 中/ 用到/ 的/ 名词/ ./ (/ 1/ )/ DNA/ ./ 整个/ 程序/ 的/ bit/ 串/ 称为/ 程序/ 的/ DNA/ ;/ (/ 2/ )/ 基因/ ./ 病毒/ 的/ 检测器/ ,/ DNA/ 的/ 片断/ ,/ 病毒/ 检/ (/ 3/ )/ 脱氧核苷/ 酸/ ./ 每/ 两个/ 字节/ 看作/ 是/ 一个/ 脱氧核苷/ 酸/ ,/ 记作/ ODN/ ,/ 若干个/ 脱氧核苷/ 酸/ 组成/ 了/ 基因/ ./ 病毒程序/ 的/ 代码/ 对应/ 着/ 生物体/ 中/ 的/ DNA/ ./ 少量/ 起着/ 病毒/ 作用/ 的/ 关键/ 代码/ 被/ 认为/ 是/ 病毒/ 的/ 基因/ ,/ 这些/ 基因/ 由/ 病毒/ 的/ ODNs/ 组成/ ./ 多个/ ODN/ 的/ 有序/ 连接/ 表示/ 程序/ 的/ 一个/ 指令/ 或/ 多个/ 指令/ 的/ 有序/ 集合/ ./ 本文/ 采用/ 滑动/ 窗口/ 的/ 方法/ 来/ 计数/ ODN/ ./ 某/ 程序/ 的/ 一段/ DNA/ 为/ 其中/ 包含/ 的/ ODN/ :/ CD2121C3C307071F1FCDCD21218C8CC0C0B8/ ./ 病毒/ 特征/ 的/ 初始/ 选择/ 采用/ 了/ 有/ 向导/ 的/ 方式/ ,/ 利用/ 已知/ 浓度/ 的/ 信息/ (/ 式/ (/ 1/ )/ )/ 来/ 统计/ 每个/ ODN/ 趋向于/ 代表/ 病毒/ 的/ 程度/ ./ In/ 是/ 训练/ 集中/ 所有/ 病毒/ 的/ ODN/ 总数/ ;/ Page4Is/ 是/ 训练/ 集中/ 所有/ 合法/ 程序/ 的/ ODN/ 总数/ ;/ Iin/ 是/ 训练/ 集中/ ODNi/ 在/ 病毒/ 中/ 出现/ 的/ 次数/ ;/ Iis/ 是/ 训练/ 集中/ ODNi/ 在/ 合法/ 程序/ 中/ 出现/ 的/ 次数/ ;/ Fn/ 是/ 训练/ 集中/ 病毒/ 文件/ 数目/ ;/ Fs/ 是/ 训练/ 集中/ 合法/ 程序/ 数目/ ;/ Fin/ 是/ 训练/ 集中/ 含有/ ODNi/ 的/ 病毒/ 文件/ 数/ ;/ Fis/ 是/ 训练/ 集中/ 含有/ ODNi/ 的/ 合法/ 程序/ 数/ ;/ 统计算法/ 基本/ 步骤/ 如下/ :/ 1/ ./ 初始化/ In/ 、/ Is/ 、/ Iin/ 、/ Iis/ 、/ Fin/ 、/ Fis/ 为/ 0/ ;/ 2/ ./ 选择/ 一个/ 合法/ 程序/ ,/ 初始化/ 标志/ 数组/ flag/ [/ i/ ]/ =/ 0/ ;/ 3/ ./ 采用/ 长度/ 为/ 2/ 个/ 字节/ 的/ 滑动/ 窗口/ ,/ 读取/ 窗口/ 中/ 的/ 其中/ i/ ∈/ [/ 0/ ,/ 65535/ ]/ ./ ODN/ ,/ 计算/ 其值/ i/ ,/ 将/ 此/ 作为/ 其/ 索引/ ;/ 4/ ./ Iis/ ++/ ,/ Is/ ++/ ;/ 5/ ./ 如果/ flag/ [/ i/ ]/ =/ 0/ ,/ 则/ Fis/ ++/ ,/ 并/ 将/ flag/ [/ i/ ]/ 置/ 为/ 1/ ,/ 标记/ ODNi/ 已经/ 在/ 该/ 程序/ 中/ 出现/ 过/ 一次/ ;/ 6/ ./ 滑动/ 窗口/ 向前/ 滑动/ 一个/ 字节/ ,/ 返回/ 步/ 3/ ,/ 直到/ 该/ 合法/ 程序/ 文件/ 结束/ ;/ 7/ ./ 返回/ 步/ 2/ ,/ 直到/ 训练/ 集中/ 所有/ 合法/ 程序/ 统计/ 完成/ ;/ 8/ ./ 选择/ 一个/ 病毒程序/ ,/ 初始化/ 标志/ 数组/ flag/ [/ i/ ]/ =/ 0/ ;/ 9/ ./ 采用/ 长度/ 为/ 2/ 个/ 字节/ 的/ 滑动/ 窗口/ ,/ 读取/ 窗口/ 中/ 的/ ODN/ ,/ 计算/ 其值/ i/ ,/ 将/ 此/ 作为/ 其/ 索引/ ;/ 10/ ./ Iin/ ++/ ,/ In/ ++/ ;/ 11/ ./ 如果/ flag/ [/ i/ ]/ =/ 0/ ,/ 则/ Fin/ ++/ ,/ 并/ 将/ flag/ [/ i/ ]/ 置/ 为/ 1/ ,/ 标记/ ODNi/ 已经/ 在/ 该/ 程序/ 中/ 出现/ 过/ 一次/ ;/ 12/ ./ 滑动/ 窗口/ 向前/ 滑动/ 一个/ 字节/ ,/ 返回/ 步/ 3/ ,/ 直到/ 该/ 病毒程序/ 文件/ 结束/ ;/ 13/ ./ 返回/ 步/ 2/ ,/ 直到/ 训练/ 集中/ 所有/ 病毒程序/ 统计/ 完成/ ./ 由/ 上面/ 的/ 程序/ ,/ 模型/ 能够/ 统计/ 出/ ODN/ 在/ 合法/ 程序/ 和/ 病毒程序/ 中/ 出现/ 的/ 频率/ 信息/ ./ 模型/ 要/ 根据/ 其/ 频率/ 信息/ ,/ 计算/ 出/ 每个/ ODN/ 趋向于/ 代表/ 病毒/ 的/ 程度/ :/ ODNi/ 被/ 挑选/ 进入/ 病毒/ ODN/ 库/ 的/ 概率/ 与其/ 在/ 病毒程序/ 所有/ ODN/ 中/ 出现/ 的/ 频率/ 成正比/ ,/ 与其/ 在/ 合法/ 程序/ 所有/ ODN/ 中/ 出现/ 的/ 频率/ 成反比/ ;/ 与/ 训练/ 集中/ 包含/ ODNi/ 的/ 病毒/ 文件/ 数/ 与/ 所有/ 病毒/ 文件/ 数/ 的/ 比例/ 成正比/ ,/ 与/ 训练/ 集中/ 包含/ ODNi/ 的/ 合法/ 程序/ 数/ 与/ 所有/ 合法/ 程序/ 数/ 的/ 比例/ 成反比/ ./ 基于/ 上述/ 条件/ ,/ 本文/ 提出/ 了/ 一个/ ODN/ 选择/ 公式/ ,/ 如下/ :/ 其中/ ,/ Win/ =/ Iin/ ×/ FinIn/ ×/ Fn/ 度/ ;/ Wis/ =/ Iis/ ×/ FisIs/ ×/ FsODN/ 浓度/ 信息/ ./ 下/ 列表/ 1/ 是/ 在/ 本文/ 采用/ 的/ 病毒库/ 中/ 部分/ 病毒/ ODNIinFinIisFisSi0685181016141620/ ./ 03389706869032326470.9054806871616268420/ ./ 5368530688572015821590.18764206891752724141930/ ./ 340751068A148339261290/ ./ 675725068B44465109801950/ ./ 407222068C7939481700/ ./ 823437/ 表中/ Si/ 表示/ ODNi/ 趋向于/ 代表/ 病毒程序/ 的/ 程度/ ,/ 当/ Si/ 超过/ 某一/ 选择/ 阈值/ 之后/ ,/ 其/ 就/ 被/ 加入/ 到/ 病毒/ ODN/ 库中/ ./ 本文/ 将/ 此/ 阈值/ 记作/ S1/ ,/ 称作/ ODN/ 选择/ 阈值/ ./ 显然/ ,/ ODN/ 选择/ 阈值/ S1/ 是/ 一个/ 与/ 训练/ 集/ 有关/ 的/ 常数/ ,/ 即当/ 训练/ 集/ 固定/ 后/ ,/ 最优/ 的/ S1/ 也/ 就/ 固定/ 成为/ 一个/ 常数/ 选择/ ./ 选择/ 一个/ 合适/ 的/ 阈值/ 使得/ 病毒/ ODN/ 库中/ 个体/ 数目/ 最少/ 且/ 又/ 最具/ 病毒/ 特征/ 的/ 代表性/ 是/ 非常/ 重要/ 的/ ,/ 这个/ 参数/ 的/ 选择/ 会/ 在/ 之后/ 的/ 实验/ 分析/ 部分/ 给出/ 方法/ 讨论/ ./ 3.2/ 特征/ 的/ 存储/ 结构/ Deng/ 等/ 人/ 总结/ 的/ 病毒/ 特点/ 清晰/ 地/ 表明/ [/ 2/ ]/ ,/ 实际/ 的/ 病毒/ 运行/ 机理/ 是/ :/ (/ 1/ )/ 特征/ 不/ 应该/ 为了/ 计算/ 的/ 简洁/ 方便/ 而/ 采取/ 不/ 符合实际/ 的/ 固定/ 长度/ ;/ (/ 2/ )/ 多个/ 特征/ 并存/ 才/ 可以/ 用来/ 标识/ 一个/ 病毒/ ,/ 而/ 非/ 只/ 采用/ 一个/ 病毒/ 特征/ ;/ (/ 3/ )/ 病毒/ 的/ 多个/ 特征/ 间/ 是/ 有/ 极大/ 的/ 相关/ 联系/ 的/ ./ 这些/ 方面/ 的/ 研究/ 为/ 本文/ 采用/ 的/ 特征/ 存储/ 结构/ 指明/ 了/ 理论/ 方向/ ,/ 虽然/ 前人/ 的/ 工作/ 没有/ 包括/ 任何/ 建立/ 起来/ 的/ 模型/ 和/ 试验/ ./ 本文/ 首次/ 提出/ 了/ 在/ 个体/ 层上/ 检测/ 病毒/ 的/ 概念/ ,/ 以/ 充分利用/ 多个/ 相关/ 基因/ 的/ 相关性/ ./ 尝试/ 将/ 每个/ 病毒/ 样本/ 的/ 多个/ 基因/ 存放/ 在/ 此/ 病毒/ 样本/ 对应/ 的/ 一个/ 数据库/ 空间/ 中/ ,/ 最后/ 通过/ 空间/ 中/ 的/ 所有/ 病毒/ 进行/ 两/ 两/ 匹配/ ,/ 得出/ 病毒/ 个体/ 之间/ 定义出/ 的/ 相似/ 度值/ ,/ 为/ 充分利用/ 多个/ 基因/ 的/ 相关性/ 提供/ 基础/ ./ 这种/ 存储/ 方式/ 被/ 称为/ 个体/ 层上/ 的/ 存储/ ./ 基于/ 有/ 向导/ 的/ 特征/ 生成/ 方法/ ,/ 可以/ 很/ 好/ 控制/ 住/ ODN/ 的/ 个数/ ,/ 特征/ 存储/ 的/ 空间/ 即可/ 被/ 控制/ 住/ ,/ 从而/ 控制/ 了/ 最终/ 匹配/ 检测/ 时/ 的/ 计算/ 代价/ ,/ 避免/ 了/ 出现/ 训练/ 的/ 时间/ 过长/ 而致/ 模型/ 失去/ 实用性/ 的/ 问题/ ./ 本文/ 方法/ 的/ 训练/ 流程/ 和/ 检测/ 流程/ 分别/ 如图/ 2/ 、/ 图/ 3/ 所示/ ,/ 可以/ 简单/ 地/ 概括/ 为/ 首先/ 有/ 向导/ 地/ 生成/ 病毒/ 特征/ 的/ ODN/ 库/ ,/ 这是/ 组成/ 病毒/ 特征/ 的/ 最/ 基本/ 单/ Page5/ 元/ ,/ 在/ 此基础/ 上/ 与/ 任一/ 程序/ 的/ 字符串/ 进行/ 匹配/ ,/ 形成/ 一系列/ 不定/ 数目/ 的/ 不定/ 长/ ODN/ 串/ ,/ 属于/ 某个/ 程序/ 的/ 储存/ 在/ 一起/ ,/ 不同/ 程序/ 的/ 分开/ 储存/ ,/ 从而/ 得到/ 了/ 病毒/ 基因库/ 和/ 类病毒/ 基因库/ ,/ 在/ 这/ 过程/ 中/ ,/ 需要/ 运用/ 人工免疫/ 方法/ 中/ 的/ 阴性/ 选择/ 算法/ ,/ 对/ 初始/ 得到/ 的/ 这种/ 病毒/ 候选/ 基因/ 进行/ 免疫/ ,/ 去除/ 其/ 特征/ 表示/ 的/ 模糊/ 状态/ ,/ 进而/ 得到/ 用来/ 标示/ 文件/ 可以/ 应用/ 于/ 特征/ 检测/ 的/ 检测/ 基因库/ ./ 病毒/ 基因库/ 的/ 基本/ 存储/ 单位/ 是/ 病毒/ 样本/ 个体/ ./ 在/ 每个/ 病毒/ 样本/ 个体/ 中/ ,/ 保存/ 了/ 该/ 样本/ 的/ 所有/ 基因/ ,/ 这样/ 就/ 使得/ 同一/ 病毒/ 的/ 不同/ 基因/ 存放/ 在/ 一起/ ,/ 不同/ 病毒/ 的/ 基因/ 分离/ 保存/ ./ 每个/ 基因/ 是/ 不定/ 长/ 的/ ,/ 每个/ 样本/ 储存/ 的/ 基因/ 数目/ 也/ 不同/ ,/ 如图/ 4/ 所示/ ./ 3.2/ ./ 1/ 病毒/ 候选/ 基因库/ 模型/ 利用/ 上/ 一步/ 生成/ 的/ 病毒/ ODN/ 库中/ 的/ ODN/ ,/ 采用/ 连续/ 匹配/ 的/ 方式/ 匹配/ 病毒/ DNA/ ,/ 从而/ 生成/ 病毒/ 的/ 候选/ 基因/ ./ 所谓/ 连续/ 匹配/ 方式/ 是/ 指/ 从/ 第一个/ 发生/ 匹配/ 的/ 位置/ 开始/ ,/ 采用/ 滑动/ 窗口/ 的/ 方式/ 向/ 后/ 进行/ 匹配/ 比较/ ,/ 一直/ 匹配/ 前进/ ,/ 直到/ 发生/ 间断/ 为止/ ,/ 此时/ 检查/ 从/ 开始/ 匹配/ 到/ 结束/ 匹配/ 共有/ 多少/ 个/ 病毒/ ODN/ 库中/ 的/ ODN/ 参与/ 了/ 匹配/ ,/ 如果/ ODN/ 数目/ 超过/ 某个/ 阈值/ T/ ,/ 则/ 将/ 病毒/ DNA/ 的/ 这个/ 片段/ 作为/ 病毒基因/ ,/ 否则/ 认为/ 该/ 片段/ 不/ 包含/ 足够/ 多/ 的/ 信息/ ,/ 不是/ 病毒/ 的/ 关键/ 代码/ ,/ 即/ 不是/ 病毒/ 的/ 基因/ ./ 显然/ ,/ 这种/ 连续/ 匹配/ 方式/ 具有/ 一位/ ODN/ 的/ 容错/ 能力/ ./ 这里/ ,/ 如果/ T/ 太小/ ,/ 则/ 生成/ 的/ 基因/ 不能/ 包含/ 足够/ 的/ 信息/ ,/ 而/ 造成/ 基因/ 的/ 数量/ 庞大/ ,/ 包含/ 过多/ 的/ 无效/ 基因/ ,/ 从而/ 使/ 系统/ 性能/ 和/ 效果/ 大大/ 下降/ ;/ 而/ 如果/ T/ 太大/ ,/ 又/ 会/ 因为/ 匹配/ 长度/ 要求/ 较/ 高/ ,/ 漏选/ 一些/ 重要/ 信息/ ./ 综合/ 考虑/ 了/ 最/ 常用/ 的/ 计算机/ 指令/ 为/ 1/ 或/ 2/ 个/ 字节/ 后/ ,/ 本文/ 规定/ T/ 取/ 3/ ,/ 这时/ ,/ 最小/ 的/ 基因/ 长度/ 为/ 4/ 个/ 字节/ ,/ 包含/ 了/ 1/ ~/ 4/ 个/ 指令/ ,/ 具有/ 较/ 丰富/ 的/ 信息/ ,/ 可以/ 成为/ 一个/ 基因/ 了/ ,/ 在/ 信息/ 的/ 多选/ 和/ 漏选/ 之间/ 做/ 了/ 一个/ 平衡/ ./ 利用/ 连续/ 匹配/ 方式/ ,/ 生成/ 一个/ 不定/ 长/ 的/ 病毒/ 候选/ 基因/ 的/ 过程/ 如图/ 5/ 所示/ ./ Page6/ 采用/ 这种/ 方式/ ,/ 模型/ 将/ 所有/ 生成/ 的/ 病毒基因/ 都/ 保存/ 到/ 与其/ 对应/ 的/ 病毒/ 样本/ 的/ 数据库/ 空间/ 中/ ,/ 形成/ 了/ 病毒/ 候选/ 基因库/ ./ 因为/ 该/ 基因库/ 中/ 的/ 基因/ 有/ 可能/ 与/ 合法/ 程序/ 的/ 基因/ 发生/ 匹配/ ,/ 故/ 称作/ 病毒/ 候选/ 基因库/ ./ 3.2/ ./ 2/ 病毒检测/ 基因库/ 利用/ 病毒/ ODN/ 库中/ 的/ ODN/ ,/ 采用/ 生成/ 病毒/ 候选/ 基因库/ 的/ 方法/ ,/ 通过/ ODN/ 与/ 训练/ 集中/ 所有/ 合法/ 程序/ DNA/ 的/ 匹配/ ,/ 模型/ 能够/ 很/ 容易/ 地/ 生成/ 合法/ 程序/ 的/ 类病毒/ 基因库/ ./ 模型/ 将/ 合法/ 程序/ 的/ 类/ 病毒基因/ 看作/ “/ 自体/ ”/ ,/ 将/ 病毒/ 的/ 候选/ 基因/ 看作/ “/ 异体/ ”/ ,/ 采用/ T/ -/ 连续/ 一致/ 匹配/ 规则/ ,/ 进行/ 阴性/ 选择/ ,/ 即/ 一旦/ 病毒/ 的/ 某个/ 基因/ 与/ 合法/ 程序/ 的/ 任何/ 一个/ 基因/ 匹配/ 成功/ ,/ 则/ 删除/ 病毒/ 的/ 该/ 候选/ 基因/ ./ 重复/ 这个/ 过程/ ,/ 直到/ 病毒/ 候选/ 基因库/ 中/ 所有/ 和/ 合图/ 6T/ -/ 连续/ 一致/ 匹配/ 规则/ 由于/ 在/ 生成/ 病毒/ 候选/ 基因/ 时/ ,/ 阈值/ T/ 为/ 3/ ,/ 即/ 只有/ 大于/ 等于/ 3/ 个/ ODN/ 的/ 连续/ 连接/ 才/ 包含/ 了/ 足够/ 的/ 信息/ ,/ 形成/ 一个/ 基因/ ,/ 那么/ 也/ 只有/ 大于/ 等于/ 3/ 个/ ODN/ 的/ 连续/ 连接/ 都/ 匹配/ ,/ 才/ 可以/ 认为/ 这/ 两个/ 基因/ 具有/ 很强/ 的/ 相似性/ ,/ 此时/ 才/ 认为/ 两个/ 基因/ 匹配/ 成功/ ,/ 故/ T/ 取值/ 跟上/ 文/ 需要/ 保持一致/ ./ 3.2/ ./ 3/ 可疑/ 程序/ 类病毒/ 基因库/ 利用/ 病毒/ ODN/ 库中/ 的/ ODN/ ,/ 采用/ 生成/ 病毒/ 候选/ 基因库/ 的/ 方法/ ,/ 通过/ ODN/ 再/ 与/ 检测/ 集中/ 所有/ 待/ 检测/ 程序/ DNA/ 的/ 匹配/ ,/ 模型/ 能够/ 很/ 容易/ 地/ 生成/ 待/ 检测/ 程序/ 的/ 类病毒/ 基因库/ ,/ 整个/ 过程/ 相似/ 于/ 产生/ 检测/ 基因库/ 的/ 自体/ 部分/ 合法/ 程序/ 类病毒/ 基因库/ 的/ 产生/ ./ 这里/ 采用/ 类病毒/ 基因库/ 能够/ 减少/ 无效/ 基因/ 的/ 数目/ ,/ 从而/ 提高/ 模型/ 的/ 检测/ 效率/ 和/ 检测时间/ ./ 原因/ 在于/ 非/ 病毒/ ODN/ 组成/ 的/ 基因/ 与/ 经过/ 阴性/ 选择/ 的/ 病毒检测/ 基因/ 是/ 不能/ 发生/ 匹配/ 的/ ,/ 这样/ 的/ 基因/ 对/ 整个/ 系统/ 是/ 冗余/ 的/ ,/ 对/ 检测/ 没有/ 任何/ 帮助/ ./ 之后/ 的/ 检测/ 集待/ 检测/ 程序/ 和/ 病毒程序/ 的/ 匹配/ 是/ 由/ 待/ 检测/ 程序/ 的/ 类病毒/ 基因库/ 与/ 病毒检测/ 基因库/ 来/ 完成/ 的/ ,/ 它们/ 的/ 存储/ 方式/ 是/ 以/ 程序/ 为/ 基本/ 单元/ 的/ ./ 3.3/ 特征/ 的/ 多层次/ 匹配/ 在/ 特征/ 的/ 匹配/ 问题/ 之上/ ,/ 为了/ 提高/ 模型/ 的/ 准确/ 法/ 程序/ 类/ 病毒基因/ 发生/ 匹配/ 的/ 基因/ 都/ 被/ 删除/ 为止/ ./ 至此/ ,/ 病毒/ 候选/ 基因库/ 升级/ 成为/ 病毒/ 的/ 检测/ 基因库/ ./ 显然/ ,/ 此/ 基因库/ 中/ 的/ 基因/ 都/ 不/ 和/ 任何/ 合法/ 程序/ 的/ 类/ 病毒基因/ 匹配/ ,/ 能够/ 完美/ 地/ 识别/ 训练/ 集中/ 的/ 合法/ 程序/ ./ 在/ 图/ 6/ 中/ ,/ 显示/ 了/ 整个/ 免疫/ 的/ 进行/ 过程/ ,/ 基因/ 1/ 是/ 一个/ 病毒/ 候选/ 基因/ ,/ 而/ 基因/ 2/ 则/ 是/ 一个/ 类/ 病毒基因/ ,/ 它们/ 通过/ 以上/ 定义/ 的/ 一致/ 连续/ 匹配/ 进行/ 了/ 阴性/ 选择/ ,/ 对/ 传统/ 的/ R/ 位/ 连续/ 匹配/ 规则/ 进行/ 了/ 修改/ ./ 新/ 规则/ 如下/ :/ 两个/ 基因/ 串/ 进行/ 匹配/ ,/ 采用/ 滑动/ 窗口/ 的/ 方式/ 进行/ 分析/ ,/ 如果/ 二者/ 连续/ 不/ 小于/ T/ 个/ 属于/ 病毒/ ODN/ 库中/ 的/ ODN/ 相同/ ,/ 则/ 认为/ 这/ 两个/ 基因/ 匹配/ 成功/ ./ 需要/ 注意/ 的/ 是/ ,/ 这里/ 的/ T/ 指/ 的/ 是/ 发生/ 匹配/ 的/ 并且/ 属于/ 病毒/ ODN/ 库中/ 的/ ODN/ 数目/ ./ 以后/ 本文/ 中/ 提到/ 的/ 匹配/ 长度/ ,/ 均/ 为/ 发生/ 匹配/ 的/ 并且/ 属于/ 病毒/ ODN/ 库中/ 的/ ODN/ 的/ 数目/ ./ 度/ ,/ 本文/ 希望/ 利用/ 尽可能/ 多/ 的/ 有效/ 信息/ ,/ 根据/ 之前/ 提出/ 的/ 特征提取/ 方法/ 和/ 特征/ 储存/ 方式/ 的/ 特点/ ,/ 在/ 3/ 个/ 逻辑/ 层面/ 上/ 进行/ 逐一/ 匹配/ ./ 在/ 对/ 可疑/ 程序/ 进行/ 检测/ 时/ ,/ 在/ 底层/ ,/ 即/ 基因/ 层/ ,/ 本文/ 采用/ 了/ T/ -/ 连续/ 一致/ 匹配/ 规则/ ,/ 采用/ 模糊/ 匹配/ 的/ 方式/ 来/ 进行/ 容错/ 匹配/ ,/ 在/ 最大/ 限度/ 上/ 挖掘/ 两个/ 基因/ 的/ 相似性/ ;/ 在/ 中层/ ,/ 即/ 个体/ 层/ ,/ 本文/ 采用/ 个体/ 匹配/ 的/ 方式/ ,/ 得到/ 可疑/ 程序/ 和/ 病毒/ 样本/ 的/ 相似/ 度/ ,/ 最大/ 限度/ 上/ 识别/ 病毒/ 的/ 伪装/ ,/ 以/ 发现/ 已知/ 病毒/ 的/ 新/ 变种/ 和/ 未知/ 病毒/ ;/ 在/ 高层/ ,/ 即/ 决策层/ ,/ 本文/ 计算/ 出/ 可疑/ 程序/ 和/ 病毒检测/ 基因库/ 的/ 相似/ 度/ ,/ 由/ 整体/ 对/ 可疑/ 程序/ 进行/ 分类/ ,/ 符合/ 生物/ 免疫学/ 原理/ ,/ 即/ 对/ 抗原/ 的/ 识别/ 是/ 一种/ 整体/ 行为/ ,/ 能够/ 最大/ 程度/ 上/ 提高/ 模型/ 的/ 准确性/ ./ 如图/ 7/ 所示/ ./ 图/ 7/ 基于/ 人工免疫/ 系统/ 的/ 病毒/ 特征/ 分层/ 匹配/ Page73/ ./ 3.1/ 基因库/ 的/ 优化/ 本文/ 的/ 所有/ 基因库/ 都/ 是/ 在/ 个体/ 层上/ 对/ 样本/ 程序/ 基因/ 进行/ 存储/ ./ 由于/ 同一/ 病毒/ 有/ 可能/ 具有/ 多个/ 相同/ 基因/ ,/ 如果/ 这些/ 相同/ 基因/ 分别/ 存储/ 一次/ ,/ 则/ 会/ 浪费/ 许多/ 存储空间/ ,/ 增加/ 系统/ 中/ 的/ 基因/ 数目/ ,/ 在/ 基因库/ 升级/ 和/ 可疑/ 程序/ 检测/ 时/ 增加/ 许多/ 不必要/ 的/ 运算/ ,/ 降低/ 系统/ 性能/ ,/ 所以/ 模型/ 为/ 每个/ 基因/ 定义/ 了/ 一个/ 权值/ ,/ 该/ 权值/ 等于/ 该/ 基因/ 在/ 其/ 样本/ 程序/ 中/ 的/ 出现/ 次数/ ./ 这样/ ,/ 模型/ 就/ 对/ 基因/ 进行/ 了/ 一次/ 优化/ ,/ 大大降低/ 了/ 其中/ 的/ 基因/ 数目/ ,/ 使/ 无效/ 运算/ 降/ 至/ 最低/ ./ 另外/ ,/ 不同/ 病毒/ 也/ 有/ 可能/ 具有/ 相同/ 的/ 基因/ ,/ 因为/ 模型/ 是/ 在/ 个体/ 层上/ 对/ 样本/ 程序/ 基因/ 进行/ 存储/ ,/ 以/ 充分利用/ 每个/ 病毒/ 不同/ 基因/ 间/ 的/ 相关性/ ,/ 因此/ 这些/ 相同/ 基因/ 还是/ 需要/ 分别/ 存储/ ./ 实际上/ ,/ 基因库/ 的/ 优化/ 过程/ 是/ 随着/ 基因/ 的/ 生成/ 一起/ 完成/ 的/ ./ 3.3/ ./ 2/ 基因/ 匹配/ 的/ 相似/ 度/ 两个/ 基因/ 进行/ 匹配/ 时/ ,/ 仍然/ 需要/ 采用/ T/ -/ 连续/ 一致/ 匹配/ 规则/ ./ 两个/ 基因/ 间/ 的/ 匹配/ 程度/ 定义/ 为/ 相似/ 度值/ ./ 当/ 两个/ 基因/ 不/ 匹配/ 的/ 时候/ ,/ 本文/ 定义/ 这/ 两个/ 基因/ 的/ 相似/ 度值/ 为/ 0/ ;/ 当/ 两个/ 基因/ 能够/ 匹配/ 的/ 情况/ 下/ ,/ 应/ 满足/ 以下/ 的/ 一个/ 条件/ ,/ 即/ 如果/ T1/ =/ T2/ +/ T3/ ,/ 其中/ Ti/ / T/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ )/ ,/ 则/ 两个/ 基因/ T1/ 位/ ODN/ 匹配/ 时/ ,/ 这/ 两个/ 基因/ 的/ 相似/ 度值/ 要/ 大于/ 两个/ 基因/ T2/ 位/ 匹配/ 时/ 的/ 相似/ 度值/ 与/ 两个/ 基因/ T3/ 位/ 匹配/ 时/ 的/ 相似/ 度值/ 的/ 加/ 和/ ,/ 定义/ Si/ 为/ i/ 位/ ODN/ 匹配/ 的/ 相似/ 值/ ,/ 有/ Sn/ >/ Sn/ -/ i/ +/ Si/ ./ 通过/ 数学/ 归纳法/ ,/ 有/ 综上所述/ ,/ 得到/ 两个/ 基因/ 匹配/ 程度/ 的/ 度量/ 公式/ —/ —/ —/ 相似/ 度值/ 计算公式/ 如下/ :/ 其中/ ,/ S/ 为/ 基因/ 1/ 和/ 基因/ 2/ 的/ 相似/ 度值/ ,/ n/ 为/ 两个/ 基因/ 的/ 匹配/ 长度/ ,/ w1/ 、/ w2/ 分别/ 代表/ 基因/ 1/ 和/ 基因/ 2/ 的/ 权值/ ./ 3.3/ ./ 3/ 个体/ 间/ 的/ 匹配/ 方式/ 将/ 检测/ 程序/ 的/ 一个/ 基因/ 和/ 病毒/ 样本/ 的/ 每个/ 基因/ 进行/ 匹配/ 比较/ ,/ 采用/ T/ -/ 连续/ 一致/ 匹配/ 规则/ ,/ 利用/ 式/ (/ 3/ )/ 计算/ 出该/ 基因/ 和/ 病毒/ 样本/ 每个/ 基因/ 的/ 相似/ 度值/ ,/ 并/ 将/ 最大/ 的/ 相似/ 度值/ 作为/ 该/ 基因/ 和/ 病毒/ 样本/ 的/ 相似/ 度值/ ;/ 重复/ 这个/ 过程/ ,/ 直到/ 得到/ 可疑/ 程序/ 每个/ 基因/ 和/ 病毒/ 样本/ 的/ 相似/ 度值/ ;/ 最后/ 将/ 这些/ 相似/ 度值加/ 和/ ,/ 作为/ 可疑/ 程序/ 和/ 病毒/ 样本/ 个体/ 间/ 的/ 相似/ 度值/ ,/ 算法/ 如下/ :/ // // 初始化/ similarity/ [/ M/ ]/ ,/ 用于/ 保存/ 可疑/ 程序/ 每个/ 基因/ // // 和/ 病毒/ 样本/ 的/ 相似/ 度值/ initialsimilarity/ [/ M/ ]/ =/ 0/ ;/ // // 初始化/ simiarity/ _/ indi/ ,/ 用来/ 保存/ 可疑/ 程序/ 和/ 病毒/ 样/ // // 本/ 的/ 相似/ 度值/ initialsimilarity/ _/ indi/ =/ 0/ ;/ for/ (/ i/ =/ 0/ ;/ i/ </ M/ ;/ i/ ++/ )/ // // 遍历/ 可疑/ 程序/ 的/ 所有/ 基因/ {/ for/ (/ j/ =/ 0/ ;/ j/ </ N/ ;/ j/ ++/ )/ // // 遍历/ 病毒/ 样本/ 的/ 所有/ 基因/ {/ // // 得到/ 可疑/ 程序/ 第/ i/ 个/ 基因/ 和/ 病毒/ 样本/ 第/ j/ 个/ 基因/ 的/ // // 相似/ 度值/ temp/ =/ get/ _/ match/ _/ value/ (/ )/ ;/ // // 保存/ 可疑/ 程序/ 第/ i/ 个/ 基因/ 和/ 病毒/ 样本/ 前/ j/ 个/ 基因/ 的/ // // 最大/ 的/ 相似/ 度值/ if/ (/ similarity/ [/ i/ ]/ </ temp/ )/ }/ // // 计算/ 得到/ 可疑/ 程序/ 和/ 病毒/ 样本/ 的/ 相似/ 度值/ similarity/ _/ indi/ +/ =/ similarity/ [/ i/ ]/ ;/ }/ 为了/ 统一/ 地/ 对/ 训练/ 集/ 以及/ 检测/ 集/ 进行/ 分析/ 和/ 决策/ ,/ 标准化/ 处理/ 待/ 检测/ 程序/ 和/ 病毒检测/ 特征/ 库/ 的/ 匹配/ 值/ 计算/ ,/ 可以/ 得出/ 可用/ 阈值/ 进行/ 划分/ 的/ 检测/ 程序/ 和/ 病毒检测/ 基因库/ 中/ 每个/ 病毒/ 样本/ 的/ 相似/ 度值/ ,/ 计算公式/ 定义/ 如下/ :/ 其中/ ,/ Si/ 是/ 病毒检测/ 特征/ 库中/ 存储/ 在/ 一个/ 病毒/ 和/ 待/ 检测/ 程序/ 的/ 相似/ 度值/ ,/ ∑/ i/ 体层/ 匹配/ 之后/ 的/ 综合/ 决策/ 值/ ,/ max/ (/ (/ 2ni/ -/ 1/ )/ ×/ wi/ )/ 表示/ 病毒/ 样本/ i/ 里/ 包含/ 的/ 长度/ 为/ ni/ 的/ 检测/ 基因/ 能够/ 提供/ 最长/ 的/ 可能/ 基因/ 匹配/ 相似/ 度值/ ,/ ∑/ w/ 表示/ 待/ 检测/ 程序/ 所有/ 类/ 病毒基因/ 的/ 权值加/ 和/ ./ 3.3/ ./ 4/ 基因/ 匹配/ 过程/ 中/ 的/ 参数/ 选择/ 上文/ 提到/ 的/ 选择/ 阈值/ S1/ 和/ 对于/ 相似/ 度/ 度量/ 的/ 程序/ 分类/ 阈值/ S2/ 具有/ 较/ 高/ 的/ 耦合度/ ,/ 但/ 如果/ 同时/ 优化/ 选择/ 两个/ 参数/ 在/ 训练/ 集上/ 找到/ 的/ 使/ 系统对/ 训练/ 集/ Page8/ 识别率/ 最高/ 的/ 参数/ ,/ 其/ 推广/ 能力/ 会/ 变得/ 很差/ 而/ 无法/ 在/ 检测/ 集中/ 取得/ 较/ 好/ 的/ 结果/ ./ 分析/ 有/ 如下/ 原因/ :/ 病毒检测/ 基因库/ 经过/ 了/ 合法/ 程序/ 类病毒/ 基因库/ 的/ 阴性/ 选择/ 过程/ ,/ 在/ 训练/ 集上/ 合法/ 程序/ 和/ 病毒检测/ 基因库/ 的/ 相似/ 度值/ 为/ 0/ ,/ 绝大多数/ 病毒程序/ 和/ 病毒检测/ 基因库/ 的/ 相似/ 度值/ 不为/ 0/ ,/ 那么/ 此时/ 随着/ 程序/ 分类/ 阈值/ S2/ 的/ 提高/ ,/ 模型/ 对/ 合法/ 程序/ 的/ 识别率/ 没有/ 提高/ ,/ 而/ 模型/ 对/ 病毒程序/ 的/ 识别率/ 将会/ 降低/ ./ 由此/ ,/ 选择/ 阈值/ S1/ ,/ 程序/ 分类/ 阈值/ S2/ 选择/ 为/ 0/ ,/ 此时/ 才能/ 使/ 模型/ 以/ 最高/ 的/ 识别率/ 识别/ 训练/ 集/ ./ 往往/ 实际/ 情形/ 是/ 训练/ 集中/ 的/ 合法/ 程序/ 数目/ 有限/ ,/ 不能/ 完全/ 覆盖/ 自体/ 空间/ ,/ 所以/ 经过/ 阴性/ 选择/ 后/ 产生/ 的/ 病毒检测/ 基因库/ 中/ 仍然/ 可能/ 含有/ 非/ 病毒基因/ ,/ 这样/ 就/ 使得/ 检测/ 集上/ 的/ 合法/ 程序/ 和/ 病毒检测/ 基因库/ 的/ 相似/ 度值/ 不/ 一定/ 为/ 0/ ./ 如果/ 优化/ 选择/ 程序/ 分类/ 阈值/ S2/ 为/ 0/ ,/ 就/ 会/ 使/ 系统/ 将/ 检测/ 集上/ 所有/ 和/ 病毒检测/ 基因库/ 产生/ 很小/ 匹配/ 的/ 合法/ 程序/ 误判/ 为/ 病毒程序/ ,/ 从而/ 使/ 系统/ 具有/ 较/ 高/ 的/ 误警率/ ,/ 降低/ 系统/ 的/ 推广/ 泛化/ 能力/ ./ 从/ 这里/ 可以/ 看出/ ,/ 在/ 实际/ 应用/ 中/ ,/ 训练/ 集上/ 的/ 最优/ 参数/ 是/ 没有/ 意义/ 的/ ./ 鉴于/ 此/ ,/ 本/ 模型/ 将/ 选择/ 阈值/ 和/ 程序/ 分类/ 阈值/ 割裂/ 开来/ 考虑/ ,/ 采用/ 一维/ 搜索/ 的/ 方法/ ,/ 来/ 对/ 两个/ 阈值/ 参数/ 分别/ 进行/ 优化/ 选择/ ./ 具体/ 的/ 优化/ 选择/ 方式/ 如下/ ./ 首先/ 模型/ 固定/ 程序/ 分类/ 阈值/ ,/ 采用/ 一维/ 搜索/ 的/ 方法/ ,/ 根据/ 选择/ 阈值/ 的/ 取值/ 范围/ 及其/ 意义/ ,/ 从/ 0.5/ 开始/ ,/ 以/ 0.005/ 为/ 步长/ ,/ 前进/ 101/ 步/ ,/ 到/ 1/ 终止/ ./ 然后/ 模型/ 采用/ 上/ 一步/ 得到/ 的/ 训练/ 集上/ 最优/ 的/ S1/ ,/ 采用/ 一维/ 搜索/ 的/ 方法/ ,/ 根据/ 程序/ 分类/ 阈值/ S2/ 的/ 取值/ 范围/ 和/ 意义/ ,/ 从/ 0/ 开始/ ,/ 以/ 0.0001/ 为/ 步长/ ,/ 一直/ 前进/ ,/ 直到/ 模型/ 对/ 训练/ 集中/ 病毒程序/ 的/ 识别率/ 低于/ 50/ %/ ./ 搜索/ 过程/ 中/ ,/ 随着/ 程序/ 分类/ 阈值/ 的/ 增大/ ,/ 模型/ 对/ 病毒/ 的/ 识别率/ 会/ 单调/ 降低/ ,/ 对/ 合法/ 程序/ 将/ 达到/ 完美/ 识别/ 而/ 不能/ 再/ 提高/ ./ 这样/ 的/ 特点/ 导致/ 此/ 方法/ 可以/ 巧妙/ 地/ 利用/ 检测/ 集/ 的/ 一些/ 规律性/ 结论/ 来/ 为/ 本文/ 分类/ 阈值/ 参数/ 选择/ 提供/ 帮助/ ./ 通过观察/ 总结/ 可以/ 看到/ ,/ 在/ 检测/ 集上/ 程序/ 分类/ 阈值/ 和/ 模型/ 的/ 识别率/ 同样/ 有/ 上述/ 关系/ ,/ 即/ 程序/ 分类/ 阈值/ 越大/ ,/ 则/ 模型/ 对/ 检测/ 集中/ 合法/ 程序/ 的/ 识别率/ 越高/ ,/ 对/ 检测/ 集中/ 病毒程序/ 的/ 识别率/ 越低/ ./ 由此/ 可以/ 得到/ 两条/ 单调/ 曲线/ 的/ 叠加/ :/ 单调/ 增加/ 的/ 合法/ 程序/ 的/ 识别率/ 和/ 单调/ 减小/ 的/ 病毒程序/ 识别率/ ,/ 得到/ 的/ 模型/ 对/ 检测/ 集/ 的/ 总体/ 识别率/ (/ 即/ 正确/ 识别/ 的/ 程序/ 总数/ // 检测/ 集/ 程序/ 总数/ )/ 是/ 一个/ 单峰/ 曲线/ ./ 出于/ 对/ 容错/ 能力/ 和/ 高/ 识别率/ 的/ 一种/ 权衡/ ,/ 将/ 模型/ 对/ 训练/ 集/ 的/ 平均/ 识别率/ 曲线/ 第二个/ 阶梯/ 中点/ 所/ 对应/ 的/ 程序/ 分类/ 阈值/ S2/ 为/ 最优/ 的/ 程序/ 分类/ 阈值/ ./ 具体/ 的/ 过程/ 如图/ 8/ 、/ 图/ 9/ 所示/ ./ 4/ 实验/ 及/ 分析/ 本文/ 的/ 实验/ 使用/ 了/ 两组/ 数据/ 集/ :/ (/ 1/ )/ 文献/ [/ 10/ ,/ 23/ ]/ 中/ 使用/ 的/ 含有/ 1512/ 个/ 经典/ 病毒程序/ 的/ 数据/ 集/ ;/ (/ 2/ )/ Windows/ 平台/ 下/ 实际/ 运行/ 的/ 合法/ 和/ 非法/ 程序/ 中/ 采集/ 的/ 数据/ 集/ cilpku08/ ,/ 这个/ 数据/ 集/ 包含/ 了/ 最新/ 的/ 3547/ 个/ 病毒/ ,/ 根据/ 它们/ 各自/ 的/ 属性/ ,/ 可以/ 划分/ 归属于/ 685/ 个/ 不同/ 的/ 病毒/ 家族/ ./ 数据/ 集中/ 的/ 具体内容/ 可以/ 在/ 下列/ 网址/ 中/ 下载/ :/ http/ :/ // // www/ ./ cil/ ./ pku/ ./ edu/ ./ cn/ // resources/ ./ 表/ 2/ 和表/ 3/ 分别/ 是/ 两组/ 实验/ 数据/ 集/ 的/ 详细信息/ ,/ 表/ 4/ 是/ 本文/ 的/ 实验/ 环境/ ./ 合法/ 程序/ EXE141410716501/ 恶意程序/ 注/ :/ 表/ 2/ 中/ ,/ 平均/ 体积/ 和/ 最大/ 体积/ 的/ 单位/ 是/ KB/ ,/ 最小/ 体积/ 的/ 单位/ 是/ Byte/ ,/ 下同/ ./ Page9/ 合法/ 程序/ EXE915138/ ./ 5817997/ 恶意程序/ 0/ 〗/ 环境/ 操作系统/ 计算机硬件/ CPU/ :/ Pentium41/ ./ 5GHz/ ,/ RAM/ :/ 512MB/ 编程语言/ 编译/ 平台/ 在/ 第/ 1/ 个/ 数据/ 集上/ 本文/ 通过/ 实验/ 可以/ 比较/ 出/ 本文/ 方法/ 的/ 效果/ ,/ 在/ 第/ 2/ 个/ 数据/ 集上/ 通过/ 三组/ 随机/ 抽取/ 的/ 病毒程序/ ,/ 以/ 不同/ 的/ 集合/ 划分/ ,/ 来/ 验证/ 实验/ 结果/ 的/ 稳定性/ 以及/ 泛化/ 能力/ ./ 本文/ 将/ 文献/ [/ 10/ ]/ 作者/ Henchiri/ 提供/ 的/ 第一组/ 数据/ 集中/ 的/ 病毒/ 以/ 家族/ 为/ 单位/ 的/ 方法/ 分成/ 5/ 个/ 部分/ ./ 同时/ 从/ WindowsXP/ 平台/ 上/ 收集/ 到/ 1414/ 个/ 合法/ 程序/ ,/ 采用/ 同样/ 的/ 办法/ 也/ 将/ 其/ 划分/ 成/ 5/ 个/ 部分/ ./ 用/ 本文/ 提出/ 的/ 方法/ 进行/ 5/ 倍/ 的/ 交叉/ 验证/ 实验/ ,/ 此时/ 训练/ 集中/ 的/ 病毒/ 和/ 检测/ 集中/ 的/ 病毒/ 在/ 家族/ 级别/ 上/ 相互/ 独立/ ,/ 实验/ 结果/ 可信度/ 较/ 高/ ./ 实验/ 的/ 结果/ 如表/ 5/ 所示/ ./ 分类器/ 虚警率/ // %/ 病毒/ 识别率/ // %/ 识别率/ // %/ ID34/ ./ 16J485/ ./ 24NaveBayes0/ ./ 13SMO5/ ./ 71Fold11/ ./ 77Fold21/ ./ 77Fold30/ ./ 71Fold42/ ./ 47Fold51/ ./ 77OURS1/ ./ 70/ 本文/ 的/ 方法/ 在/ 保持/ 较/ 低/ 虚/ 警率/ 的/ 情况/ 下/ ,/ 取得/ 了/ 较/ 高/ 的/ 病毒/ 识别率/ ,/ 总体/ 识别率/ 较/ Henchiri/ 等/ 在/ 文献/ [/ 10/ ]/ 中/ 的/ 最优/ 识别率/ 高出/ 1/ %/ (/ 见图/ 10/ )/ ./ 表/ 6/ 数据/ 集/ 2/ 第/ 1/ 组/ 实验/ 结果/ 实验/ 编号/ Test122722710020319495/ ./ 697.9575698/ ./ 2514792.295/ ./ 4Test214214210012712497/ ./ 698.914214098/ ./ 612711993.796/ ./ 3Test35757100514996/ ./ 198.122722498/ ./ 720319395.197/ ./ 0/ 注/ :/ A/ 表示/ 数据/ 集中/ 相应/ 程序/ 的/ 程序/ 总数/ ;/ P/ 表示/ 模型/ 对/ 程序/ 的/ 正确/ 识别/ 数目/ ;/ PR/ 表示/ 模型/ 对/ 程序/ 的/ 正确/ 识别率/ ,/ 其中/ PR/ =/ P/ // A/ ;/ APR/ 表示/ 模型/ 对/ 程序/ 的/ 平均/ 识别率/ ,/ 其值/ 等于/ (/ 合法/ 程序/ 正确/ 识别/ 数/ +/ 病毒程序/ 正确/ 识别/ 数/ )/ // (/ 合法/ 程序/ 总数/ +/ 病毒程序/ 总数/ )/ ./ 第/ 2/ 组/ 实验/ 是/ 在/ 1815/ 个/ 程序/ 的/ 数据/ 集上/ 进行/ 的/ ,/ 其中/ 共有/ 915/ 个/ 合法/ 程序/ 和/ 900/ 个/ 病毒程序/ ./ 按照/ 训练/ 集/ 和/ 检测/ 集/ 2/ // 1/ 、/ 1/ // 1/ 、/ 1/ // 2/ 的/ 比例/ ,/ 对/ 1815/ 个/ 在/ 第/ 2/ 组/ 数据/ 集上/ ,/ 第/ 1/ 组/ 实验/ 是/ 在/ 538/ 个/ 程序/ 的/ 数据/ 集上/ 进行/ 的/ ,/ 其中/ 共有/ 284/ 个/ 合法/ 程序/ 和/ 254/ 个/ 病毒程序/ ./ 按照/ 训练/ 集/ 和/ 检测/ 集/ 4/ // 1/ 、/ 1/ // 1/ 、/ 1/ // 4/ 的/ 比例/ ,/ 进行/ 了/ 3/ 次/ 不同/ 的/ 划分/ ./ 实验/ 结果/ 如表/ 6/ 所示/ ./ 从表/ 6/ 可以/ 看出/ ,/ 模型/ 对/ 训练/ 集/ 和/ 检测/ 集都/ 有/ 较/ 高/ 的/ 识别率/ ./ 其中/ ,/ 模型/ 能够/ 完美/ 记忆/ 训练/ 集中/ 的/ 合法/ 程序/ ,/ 对/ 病毒程序/ 的/ 记忆/ 率/ 也/ 在/ 96/ %/ 左右/ ;/ 训练/ 好/ 的/ 模型/ 能够/ 以/ 98/ %/ 以上/ 的/ 识别率/ 识别/ 未知/ 的/ 合法/ 程序/ ,/ 对/ 完全/ 未知/ 的/ 病毒程序/ 也/ 能/ 达到/ 93/ %/ 左右/ 的/ 识别率/ ./ 值得/ 重点/ 说明/ 的/ 是/ ,/ 模型/ 对/ 训练/ 集/ 和/ 检测/ 集/ 的/ 识别率/ 并/ 没有/ 随着/ 训练/ 集/ 的/ 减小/ 而/ 降低/ ,/ 这是/ 传统/ 病毒检测/ 模型/ 所/ 难以实现/ 的/ ./ 尤其/ 是/ 在/ 实验/ Test3/ 上/ ,/ 训练/ 集中/ 程序/ 数目/ 远/ 小于/ 检测/ 集/ 程序/ 数目/ ,/ 此时/ 模型/ 对/ 训练/ 集中/ 的/ 病毒程序/ 的/ 识别率/ 为/ 96.1/ %/ ,/ 低于/ Test2/ ,/ 却/ 高于/ Test1/ ./ Test3/ 上/ 训练/ 好/ 的/ 模型/ 在/ 检测/ 集上/ 具有/ 更加/ 出色/ 的/ 表现/ ,/ 其/ 对/ 合法/ 程序/ 的/ 识别率/ 高达/ 98.7/ %/ ,/ 对/ 病毒程序/ 的/ 识别率/ 也/ 高达/ 95.1/ %/ ,/ 均/ 高于/ Test1/ 和/ Test2/ 的/ 模型/ 在/ 检测/ 集上/ 的/ 表现/ ./ 这/ 就/ 说明/ ,/ 本文/ 提出/ 的/ 模型/ 能够/ 在/ 小/ 数据/ 集上/ 学习/ 到/ 足够/ 的/ 知识/ ,/ 并/ 利用/ 这些/ 有限/ 的/ 知识/ ,/ 在/ 检测/ 无限大/ 的/ 空间/ 时/ ,/ 取得/ 足够/ 好/ 的/ 成绩/ ,/ 具有/ 较强/ 的/ 泛化/ 能力/ ./ APPR/ // %/ 程序/ 组成/ 的/ 数据/ 集/ 进行/ 了/ 3/ 次/ 不同/ 的/ 划分/ ./ 实验/ 结果/ 如表/ 7/ 所示/ ./ Page10/ 表/ 7/ 数据/ 集/ 2/ 第/ 2/ 组/ 实验/ 结果/ 实验/ 编号/ Test461061010060053889/ ./ 794.930530399/ ./ 330027090.094/ ./ 7Test545745710045039988/ ./ 794.445845098/ ./ 345040088.993/ ./ 6Test630530510030027993/ ./ 096.561060198/ ./ 560054390.594/ ./ 5/ 从/ 上述/ 两个/ 表/ 可以/ 看出/ 特征选择/ 对于/ 实验/ 结果/ 的/ 稳定性/ ./ 接下来/ ,/ 实验/ 被/ 推广/ 到/ 更/ 大/ 的/ 数据/ 集上/ ,/ 用/ 训练/ 好/ 的/ 模型/ 对/ 整个/ 数据/ 集/ 进行/ 检测/ ,/ 验证/ 对/ 已知/ 和/ 未知/ 程序/ 的/ 综合/ 识别/ 能力/ ,/ 在/ 最大/ 程度/ 上/ 反应/ 模型/ 的/ 泛化/ 能力/ ,/ 为/ 模型/ 在/ 实际/ 中/ 应用/ 提供/ 一定/ 的/ 根据/ ./ 表/ 8/ 是/ 上述/ 训练/ 好/ 的/ 模型/ 直接/ 应用/ 在/ 更/ 大/ 的/ 检测/ 空间/ 的/ 检测/ 结果/ ,/ 用以/ 验证/ 对/ 未知/ 程序/ 的/ 综合/ 识别/ 能力/ ./ 实验/ 编号/ Test191587595/ ./ 63547326392.092/ ./ 7Test291587195/ ./ 23547324891.692/ ./ 3Test391587595/ ./ 63547329893.093/ ./ 5Test491591399/ ./ 83547310787.690/ ./ 1Test591590799/ ./ 13547308486.989/ ./ 4Test691590699/ ./ 03547323591.292/ ./ 86/ 个/ 在/ 不同/ 训练/ 集上/ 训练/ 好/ 的/ 模型/ 对/ 检测/ 集中/ 合法/ 程序/ 的/ 识别率/ 基本/ 都/ 在/ 95/ %/ 以上/ ./ 特别/ 地/ ,/ Test4/ 、/ Test5/ 和/ Test6/ 的/ 模型/ 对/ 检测/ 集中/ 合法/ 程序/ 的/ 识别率/ 高达/ 99/ %/ 以上/ ,/ 这/ 主要/ 是因为/ 这/ 3/ 个/ 实验/ 的/ 训练/ 集中/ 合法/ 程序/ 数目/ 较/ 多/ ,/ 并且/ 本/ 模型/ 能够/ 完美/ 识别/ 训练/ 集中/ 的/ 合法/ 程序/ ./ 具有/ 代表/ 意义/ 的/ 一个/ 实验/ 是/ Test6/ ,/ 其中/ 的/ 合法/ 程序/ 数目/ 只有/ 305/ 个/ ,/ 但/ 其/ 对/ 检测/ 集合/ 法/ 程序/ 的/ 识别率/ 竟高达/ 99.0/ %/ ,/ 这样/ ,/ 本文/ 有/ 理由/ 认为/ ,/ 适当/ 地/ 提高/ 训练/ 集中/ 合法/ 程序/ 数目/ 能够/ 较大/ 地/ 提高/ 模型/ 对/ 检测/ 集中/ 合法/ 程序/ 的/ 识别率/ ./ 6/ 个/ 模型/ 对/ 病毒/ 的/ 识别率/ 稳定/ 在/ 92/ %/ 左右/ ./ 特别/ 地/ ,/ Test3/ 的/ 病毒程序/ 训练/ 数目/ 较/ 少/ ,/ 但/ 对于/ 包含/ 3547/ 个/ 病毒程序/ 的/ 检测/ 集/ ,/ 其/ 识别/ 病毒/ 率高达/ 93.0/ %/ ./ 由于/ 病毒检测/ 系统/ 是/ 一个/ 高度/ 的/ 实时/ 系统/ ,/ 因此/ 模型/ 检测/ 可疑/ 程序/ 的/ 速度/ 成为/ 了/ 模型/ 可用性/ 的/ 重要/ 指标/ ./ 上述/ 3/ 组/ 实验/ 中/ 检测/ 合法/ 程序/ 平均/ 耗时/ 约/ 为/ 0.013/ s/ ,/ 检测/ 病毒程序/ 平均/ 耗时/ 约/ 为/ 0.09/ s/ ./ 如图/ 11/ 所示/ ./ 通过/ 以上/ 几个/ 方面/ 的/ 分析/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 模型/ 不仅/ 能够/ 有效/ 地/ 检测/ 出/ 病毒程序/ ,/ 同时/ 能够/ APPR/ // %/ 在/ 一个/ 可以/ 接受/ 的/ 训练/ 时间/ 内/ ,/ 产生/ 一个/ 稳定/ 的/ 而且/ 基因/ 规模/ 不随/ 训练/ 集/ 大小/ 显著/ 增长/ 的/ 病毒检测/ 基因库/ ,/ 从而/ 快速/ 完成/ 对/ 可疑/ 程序/ 的/ 检测/ ,/ 可以/ 达到/ 实时/ 系统/ 的/ 要求/ ,/ 是/ 一个/ 有效/ 的/ 病毒检测/ 模型/ ./ 5/ 结论/ 本文/ 的/ 主要/ 贡献/ 在于/ 结合/ 了/ 免疫/ 思想/ 和/ 病毒/ 本身/ 两者/ 特点/ ,/ 提出/ 了/ 一种/ 新/ 的/ 更/ 符合实际/ 的/ 病毒/ 特征提取/ 的/ 方法/ ,/ 使得/ 病毒/ 被/ 提取/ 的/ 特征/ 生成/ 时/ 针对性/ 更强/ ;/ 储存/ 时/ 突破/ 了/ 原先/ 定长/ 的/ 限制/ ;/ 在/ 匹配/ 方面/ ,/ 比/ 对/ 在/ 一个/ 样本/ 与/ 另/ 一个/ 样本/ 之间/ 进行/ ,/ 样本/ 内部/ 的/ 基因/ 需要/ 共同/ 作用/ 才能/ 产生/ 病毒性/ 的/ 特点/ 被/ 挖掘/ 出来/ ,/ 病毒/ 关键/ 代码/ 之间/ 的/ 相关性/ 被/ 充分利用/ ,/ 将/ 对/ 病毒/ 的/ 检测/ 识别/ 上升/ 成为/ 一种/ 多层次/ 分阶段/ 的/ 整体/ 行为/ ./ 

