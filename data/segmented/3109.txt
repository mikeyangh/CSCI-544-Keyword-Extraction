Page1/ 基于/ 秘密/ 共享/ 模数/ 的/ 一般性/ 多方/ 求逆/ 协议/ 胡/ 华明/ 周展/ 飞/ (/ 中国科学院/ 研究生院/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100049/ )/ 摘要/ Catalano/ 、/ Gennaro/ 和/ Halevi/ 提出/ 了/ 一个/ 实用/ 的/ 基于/ 秘密/ 共享/ 模数/ 的/ 分布式/ 求逆/ 协议/ ,/ 然而/ 他们/ 仅仅/ 考虑/ 了/ 门限/ 敌手/ 结构/ 的/ 情况/ ./ 文中/ 考虑/ 了/ 一般/ 敌手/ 结构/ 的/ 情况/ ,/ 针对/ 半/ 诚实/ 敌手/ 和/ 恶意/ 敌手/ ,/ 利用/ Damgrd/ 和/ Thorbek/ 提出/ 的/ 线性/ 整数/ 秘密/ 共享/ 方案/ ,/ 分别/ 构造/ 了/ 一个/ 多方/ 模求/ 逆/ 协议/ ./ 该/ 协议/ 在/ 敌手/ 结构/ 是/ Q2/ (/ 对应/ Q3/ 以及/ 强/ RSA/ 假设/ )/ 的/ 条件/ 下/ 针对/ 半/ 诚实/ (/ 对应/ 恶意/ )/ 敌手/ 是/ 安全/ 的/ ./ 该/ 协议/ 是/ Catalano/ 等/ 人/ 方案/ 的/ 一个/ 推广/ ,/ 可以/ 用来/ 分布式/ 地/ 计算/ RSA/ 私钥/ 以及/ 构造/ 标准/ 模型/ 下/ 安全/ 的/ 分布式/ Gennaro/ -/ Halevi/ -/ Rabin/ 、/ Cramer/ -/ Shoup/ 和/ Mames/ -/ Joye/ 签名/ 方案/ ./ 另外/ ,/ 文中/ 的/ 构造方法/ 也/ 是/ 对/ 环上/ 的/ 安全/ 多方/ 协议/ 构造方法/ 的/ 一个/ 有力/ 补充/ ./ 关键词/ 模求/ 逆/ ;/ 一般/ 敌手/ 结构/ ;/ 线性/ 整数/ 秘密/ 共享/ ;/ 乘性/ 张成/ 方案/ ;/ 分布式/ RSA/ 签名/ 1/ 引言/ 本文/ 考虑/ 基于/ 秘密/ 共享/ 模数/ 进行/ 求逆/ 的/ 问题/ ,/ Page22000/ 年/ ,/ Catalano/ 、/ Gennaro/ 以及/ Halevi/ [/ 4/ ]/ 针对/ 上述/ 分布式/ 模求/ 逆/ 问题/ 提出/ 了/ 一个/ 高效/ 的/ 解决方案/ ./ 他们/ 的/ 基本/ 思想/ 是/ 利用/ 扩展/ 的/ 欧几里德/ 算法/ (/ 记为/ GCD/ 运算/ )/ 来/ 计算/ e/ -/ 1mod/ / ./ 他们/ 采用/ 了/ 整数/ 环上/ 的/ 秘密/ 共享/ 方案/ 来/ 避免/ / / (/ N/ )/ 上/ 的/ 求/ 逆运算/ ./ 然而/ ,/ Catalano/ 等/ 人/ 的/ 方案/ [/ 4/ ]/ 考虑/ 的/ 仅仅/ 是/ 门限/ 敌手/ 结构/ 的/ 情况/ ,/ 也/ 即/ 假设/ 所有/ 的/ 参与方/ 被/ 攻破/ 或者/ 被/ 收买/ 的/ 难度/ 是/ 相同/ 的/ ,/ 唯一/ 起/ 决定/ 作用/ 的/ 是/ 被/ 攻破/ 或者/ 被/ 收买/ 的/ 参与方/ 人数/ ./ 然而/ ,/ 在/ 现实/ 当中/ ,/ 可能/ 某些/ 参与方/ 会/ 比/ 其他/ 参与方/ 更/ 可靠/ 一些/ ,/ 因此/ 需要/ 以/ 一种/ 更/ 灵活/ 的/ 方式/ 来/ 明确/ 地/ 指出/ 哪些/ 参与方/ 是非/ 授权/ 的/ ,/ 也/ 即/ ,/ 需要/ 一般性/ 的/ 敌手/ 结构/ ./ Cramer/ 、/ Damgrd/ 和/ Maurer/ [/ 5/ ]/ 提出/ 了/ 利用/ 有限/ 域/ 上/ 的/ 线性/ 秘密/ 共享/ 方案/ 来/ 构造/ 相同/ 敌手/ 结构/ 的/ 安全/ 多方/ 协议/ ,/ 他们/ 给出/ 了/ 有限/ 域/ 上/ 单调/ 张成/ 方案/ 的/ 乘性/ 性质/ ./ 后来/ ,/ Cramer/ 、/ Fehr/ 等/ 人/ [/ 6/ ]/ 又/ 将/ 文献/ [/ 5/ ]/ 扩展/ 到/ 了/ 任意/ 的/ 含/ 1/ 交换/ 环上/ ,/ 证明/ 了/ 环上/ 安全/ 多方/ 计算/ 协议/ 的/ 存在/ 性/ ,/ 并/ 给出/ 了/ 整数/ 张成/ 方案/ 的/ 乘性/ 性质/ ./ 利用/ 乘性/ 性质/ ,/ Cramer/ 、/ Fehr/ 等/ 人/ [/ 6/ ]/ 使用/ 一般/ 敌手/ 结构/ 上/ 的/ 黑箱/ 秘密/ 共享/ (/ Black/ -/ BoxSecretSharing/ ,/ BBSS/ )/ 方案/ [/ 7/ ]/ 构造/ 了/ 一个/ 非常/ 有效/ 的/ 安全/ 多方/ 计算/ 协议/ ./ 由于/ 采用/ 了/ 黑箱/ 秘密/ 共享/ 方案/ ,/ 在/ 环上/ 做/ 运算/ 时/ 需要/ 黑箱/ 调用/ ./ 分布式/ 模求/ 逆/ 协议/ 可/ 用于/ 分布式/ 生成/ RSA/ 私钥/ 以及/ 构造/ 标准/ 模型/ 下/ 安全/ 的/ 分布式/ Gennaro/ -/ Halevi/ -/ Rabin/ [/ 1/ ]/ 、/ Cramer/ -/ Shoup/ [/ 2/ ]/ 和/ Mames/ -/ Joye/ [/ 3/ ]/ 签名/ 方案/ ./ 上述/ 两个/ 应用/ 都/ 需要/ 高效/ 的/ 模求/ 逆/ 协议/ ,/ 尤其/ 是/ 后者/ ,/ 这/ 是因为/ 每次/ 签名/ 时/ 都/ 要/ 使用/ 不同/ 的/ 素/ 指数/ e/ 来/ 运行/ 模求/ 逆/ 协议/ ./ 因此/ 设计/ 高效/ 的/ 分布式/ 模求/ 逆/ 协议/ 具有/ 现实意义/ ./ 1.1/ 相关/ 工作/ Damgrd/ 和/ Thorbek/ [/ 8/ ]/ 提出/ 了/ 线性/ 整数/ 秘密/ 共享/ (/ LinearIntegerSecretSharing/ ,/ LISS/ )/ 方案/ 来/ 构造/ 分布式/ RSA/ 签名/ 方案/ ./ 在/ 一个/ LISS/ 方案/ 中/ ,/ 秘密/ 为/ 选自/ 一个/ 公开/ 区间/ 的/ 整数/ ,/ 每个/ 份额/ (/ share/ )/ 为/ 秘密/ 和/ 一些/ 随机/ 整数/ 的/ 线性组合/ ,/ 秘密/ 的/ 重构/ 也/ 是/ 通过/ 计算/ 授权/ 集中/ 所有/ 份额/ 的/ 一个整/ 系数/ 线性组合/ 得到/ ./ LISS/ 方案/ 与/ BBSS/ 方案/ [/ 7/ ]/ 有着/ 紧密/ 的/ 联系/ ,/ 但/ 两者/ 并不相同/ ./ 在/ BBSS/ 方案/ 中/ ,/ 秘密/ 为/ 取自/ 于/ 任意/ 的/ 有限/ Abel/ 群中/ 的/ 元素/ ,/ 所有/ 的/ 运算/ 都/ 是/ 在/ 该/ 群中/ 完成/ ,/ 对于/ 环上/ 的/ 计算/ 和/ 元素/ 的/ 选取/ ,/ 需要/ 通过/ 黑箱/ 调用/ 来/ 完成/ ./ 而/ 在/ LISS/ 方案/ 中/ ,/ 所有/ 的/ 运算/ 都/ 是/ 在/ 整数/ 环上/ 进行/ ./ 1.2/ 我们/ 的/ 贡献/ Catalano/ 等/ 人/ [/ 4/ ]/ 的/ 方案/ 只/ 考虑/ 了/ 门限/ 敌手/ 结构/ 的/ 情况/ ,/ 为此/ 本文/ 给出/ 了/ 一般/ 敌手/ 结构/ 上/ 的/ 多方/ 模求/ 逆/ 协议/ ,/ 首先/ 构造/ 了/ 一个半/ 诚实/ 敌手/ 模型/ 下/ 的/ 简单/ 高效/ 的/ 安全/ 多方/ 模求/ 逆/ 协议/ ,/ 该/ 协议/ 在/ 给定/ 保密/ 信道/ 的/ 前提/ 下/ 以及/ 敌手/ 结构/ 是/ Q2/ 的/ 条件/ 下/ 是/ 无条件/ 安全/ 的/ ./ 然后/ 又/ 在/ 半/ 诚实/ 敌手/ 模型/ 下/ 的/ 协议/ 基础/ 上/ 增加/ 了/ 鲁棒性/ ,/ 将/ 其/ 改造/ 为/ 恶意/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ ./ 该/ 协议/ 在/ 强/ RSA/ 假设/ 下/ 以及/ 敌手/ 结构/ 是/ Q3/ 的/ 条件/ 下/ 是/ 安全/ 的/ ./ 协议/ 的/ 鲁棒性/ 是/ 通过/ 可验证/ 线性/ 整数/ 秘密/ 共享/ (/ VerifiableLinearIntegerSecretSharing/ ,/ VLISS/ )/ 方案/ 以及/ 一个零/ 知识/ 证明/ 协议/ 实现/ 的/ ./ 该/ VLISS/ 方案/ 是/ Pedersen/ -/ VSS/ [/ 9/ ]/ 的/ 一般/ 敌手/ 结构/ 上/ 的/ 变体/ ./ 相应/ 的/ 零/ 知识/ 证明/ 协议/ 是/ 统计/ 零/ 知识/ 的/ 基于/ 强/ RSA/ 假设/ 绑定/ 的/ ./ 本文/ 的/ 想法/ 主要/ 来源于/ 文献/ [/ 5/ -/ 6/ ]/ ,/ 即/ 利用/ 敌手/ 结构/ 为/ 的/ 线性/ 秘密/ 共享/ 方案/ 来/ 构造/ 相同/ 敌手/ 结构/ 的/ 多方/ 计算/ 协议/ ./ 为了/ 避免/ / / (/ N/ )/ 上/ 的/ 求/ 逆/ 问题/ ,/ 与/ 文献/ [/ 6/ ]/ 中/ 采取/ 黑箱/ 秘密/ 共享/ 方案/ 不同/ ,/ 本文/ 采用/ 了/ 敌手/ 结构/ 为/ 的/ LISS/ 方案/ 来/ 构造/ 针对/ 敌手/ 安全/ 的/ 多方/ 模求/ 逆/ 协议/ ,/ 这样/ 可以/ 在/ 整数/ 环上/ 做/ 所有/ 运算/ ,/ 从而/ 避免/ 了/ 黑箱/ 调用/ ./ 因此/ 本文/ 构造/ 多方/ 协议/ 的/ 方法/ 也/ 是/ 对/ 文献/ [/ 6/ ]/ 的/ 一个/ 有力/ 补充/ ./ 1.3/ 本文/ 的/ 组织/ 结构/ 第/ 2/ 节将/ 介绍/ 一些/ 预备/ 知识/ ;/ 第/ 3/ 节是/ 本文/ 的/ 重点/ ,/ 3.1/ 节/ 给出/ 协议/ 的/ 系统/ 模型/ ,/ 3.2/ 节/ 给出/ 多方/ 模求/ 逆/ 协议/ 及其/ 安全性/ 的/ 定义/ ,/ 3.3/ 节/ 和/ 3.4/ 节/ 分别/ 介绍/ 半/ 诚实/ 敌手/ 模型/ 下/ 和/ 恶意/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ ,/ 并/ 给出/ 安全性/ 证明/ ,/ 3.5/ 节/ 简单/ 分析/ 协议/ 的/ 效率/ ;/ 第/ 4/ 节/ 总结/ 全文/ ./ 2/ 张成/ 方案/ 和/ 线性/ 整数/ 秘密/ 共享/ 2.1/ 整数/ 张成/ 方案/ Karchmer/ 和/ Wigderson/ [/ 10/ ]/ 引入/ 了/ 有限/ 域/ 上/ 的/ 单调/ 张成/ 方案/ (/ MonotoneSpanPrograms/ ,/ MSP/ )/ ,/ 并/ 证明/ 了/ MSP/ 和域/ 上/ 的/ 线性/ 秘密/ 共享/ 方案/ 是/ 一一对应/ 的/ ./ 后来/ ,/ Damgrd/ 和/ Thorbek/ [/ 8/ ]/ 提出/ 了/ 线性/ 整数/ 秘密/ 共享/ 方案/ ,/ 并/ 证明/ 了/ 整数/ 张成/ 方案/ (/ IntegerSpanPrograms/ ,/ ISP/ )/ ,/ 即/ / 上/ 的/ 单调/ 张成/ 方案/ ,/ 与/ 线性/ 整数/ 秘密/ 共享/ 方案/ 有着/ 类似/ 的/ 对应/ 关系/ ./ 定义/ 1/ ./ 设/ P/ =/ {/ P1/ ,/ …/ ,/ Pn/ }/ 为/ n/ 个/ 参与方/ 组/ Page3/ / 成/ 的/ 集合/ ,/ 称/ Γ/ / 2P/ 为/ P/ 上/ 的/ 存取/ 结构/ ,/ 如果/ / / Γ/ 且/ Γ/ 满足/ :/ / A/ ∈/ Γ/ ,/ A/ / A/ ,/ 则/ A/ ∈/ Γ/ ./ 称/ / 2P/ 为/ P/ 上/ 的/ 敌手/ 结构/ ,/ 如果/ =/ 2P/ \/ 是/ 一个/ 存取/ 结构/ ./ 考虑/ / 上/ 的/ 一个/ l/ 行/ m/ 列/ 矩阵/ 犕/ (/ 记/ 作/ 犕/ ∈/ l/ ×/ m/ )/ ,/ 一个/ 标号/ 函数/ ψ/ :/ {/ 1/ ,/ …/ ,/ l/ }/ →/ P/ ,/ ψ/ 为/ 满射/ 以及/ 目标/ 向量/ ε/ =/ (/ 1/ ,/ 0/ ,/ …/ ,/ 0/ )/ T/ ∈/ / 方/ 标记/ 犕/ 的/ 行/ ,/ 不同/ 的/ 行/ 可以/ 有/ 相同/ 的/ 标记/ ,/ 因此/ 可以/ 看作/ 是/ 每个/ 参与方/ 拥有/ 犕/ 的/ 一行/ 或者/ 多行/ ./ 如果/ A/ / P/ ,/ 则/ 犕/ A/ 表示/ 犕/ 中/ 由/ 行/ i/ 组成/ 的/ 矩阵/ ,/ 其中/ ψ/ (/ i/ )/ ∈/ A/ ,/ lA/ 表示/ 犕/ A/ 的/ 行数/ ./ 类似/ 地/ ,/ 如果/ 狓/ 表示/ 任意/ 的/ l/ 维/ 向量/ ,/ 则/ 狓/ A/ 表示/ 狓/ 中/ 由/ 坐标/ i/ 标识/ 的/ 部分/ 向量/ ,/ 其中/ ψ/ (/ i/ )/ ∈/ A/ ./ 如果/ A/ =/ {/ Pi/ }/ ,/ 则/ 用/ 犕/ i/ ,/ 狓/ i/ ,/ li/ 代替/ 犕/ A/ ,/ 狓/ A/ ,/ lA/ ./ 最后/ ,/ im/ (/ ·/ )/ 和/ ker/ (/ ·/ )/ 分别/ 表示/ 矩阵/ 对应/ 的/ 像/ (/ image/ )/ 和/ 核/ (/ kernel/ )/ ./ 定义/ 2/ ./ 设/ =/ (/ / ,/ 犕/ ,/ ψ/ ,/ ε/ )/ 为/ 如/ 上/ 定义/ 的/ 四元组/ ,/ Γ/ 为/ P/ 上/ 的/ 一个/ 存取/ 结构/ ./ 称为/ 存取/ 结构/ Γ/ 或者/ 敌手/ 结构/ =/ 珚/ Γ/ 对应/ 的/ 整数/ 张成/ 方案/ (/ ISP/ )/ ,/ 如果/ 任意/ 的/ A/ / P/ 都/ 满足/ :/ (/ 1/ )/ 如果/ A/ ∈/ Γ/ ,/ 则/ 存在/ λ/ A/ =/ (/ λ/ 1/ ,/ …/ ,/ λ/ lA/ )/ T/ ∈/ lA/ ,/ 使得/ 犕/ TA/ λ/ A/ =/ ε/ ,/ 其中/ λ/ A/ 被/ 称为/ A/ 所/ 对应/ 的/ 张成/ 向量/ ;/ / (/ 2/ )/ 如果/ A/ / Γ/ ,/ 则/ 存在/ κ/ A/ =/ (/ κ/ 1/ ,/ …/ ,/ κ/ m/ )/ T/ ∈/ / 使得/ 犕/ A/ κ/ A/ =/ 0/ ,/ 其中/ κ/ 1/ =/ 1/ ,/ κ/ A/ 被/ 称为/ A/ 所/ 对应/ 的/ 消去/ 向量/ ./ 有时/ 也/ 称/ 计算/ Γ/ 或/ ./ 定义/ λ/ max/ =/ max/ {/ |/ a/ |/ |/ a/ 为/ 某/ 一张/ 成/ 向量/ 中/ 的/ 元素/ }/ ,/ κ/ max/ =/ max/ {/ |/ b/ |/ |/ b/ 为/ 某/ 一/ 消去/ 向量/ 中/ 的/ 元素/ }/ ./ 注/ 1/ ./ 由/ 线性代数/ 的/ 基本知识/ 可知/ ,/ 由/ κ/ A/ ∈/ ker/ (/ 犕/ A/ )/ 且/ κ/ 1/ =/ 1/ 可/ 推出/ ε/ / im/ (/ 犕/ TA/ )/ ,/ 然而/ 另/ 一个/ 方向/ 一般/ 只/ 在/ 有限/ 域/ 内/ 成立/ ./ 2.2/ 线性/ 整数/ 秘密/ 共享/ 现在/ 引入/ Damgrd/ 和/ Thorbek/ [/ 8/ ]/ 提出/ 的/ 线性/ 整数/ 秘密/ 共享/ (/ LinearIntegerSecretSharing/ ,/ LISS/ )/ 方案/ ./ 在/ LISS/ 方案/ 中/ ,/ 秘密/ 为/ 选自/ 一个/ 公开/ 区间/ 的/ 整数/ ,/ 每个/ 份额/ 是/ 秘密/ 和/ 分发者/ (/ dealer/ )/ 随机/ 选取/ 的/ 一些/ 整数/ 的/ 线性组合/ ./ 秘密/ 的/ 重构/ 也/ 是/ 通过/ 计算/ 一个/ 授权/ 集中/ 份额/ 的/ 整/ 系数/ 线性组合/ 来/ 完成/ ./ 设/ P/ ,/ Γ/ 的/ 定义/ 如/ 前/ ,/ 现在/ 有/ 一个/ 分发者/ (/ dealer/ )/ 想/ 在/ P/ 对应/ 的/ 参与方/ 中/ 共享/ 一个/ 取自/ 公开/ 区间/ [/ 0/ ,/ N/ ]/ 的/ 秘密/ s/ ,/ 对应/ 的/ 存取/ 结构/ 是/ Γ/ ./ 为了/ 实现/ 上述/ 目标/ ,/ 构造/ 如下/ 的/ 秘密/ 共享/ 方案/ ,/ 称之为/ LISS/ 方案/ :/ 首先/ 构造/ 一个/ 计算/ Γ/ 的/ ISP/ (/ 构造方法/ 详见/ 文献/ [/ 8/ ]/ 的/ 完整版/ )/ ,/ 称中/ 的/ 矩阵/ 犕/ 为/ 分发/ 矩阵/ ./ 然后/ 选择/ 一个/ 分发/ 向量/ ρ/ =/ (/ s/ ,/ ρ/ 2/ ,/ …/ ,/ ρ/ m/ )/ T/ ,/ 其中/ s/ 为/ 秘密/ ,/ ρ/ i/ 为/ 均匀/ 随机/ 选/ 自/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 2kN/ ]/ 的/ 整数/ ,/ 2/ / i/ / m/ ,/ k/ 为/ 一个/ 安全/ 参数/ ./ 通过/ 下式/ 来/ 共享/ 秘密/ s/ :/ 记/ 每个/ si/ 为/ 一个/ 份额/ ,/ 1/ / i/ / l/ ./ 将/ 第/ i/ 个/ 份额/ 秘密/ 地/ 发送给/ 参与方/ ψ/ (/ i/ )/ ./ 记/ 参与方/ Pi/ 的/ 所有/ 份额/ 为/ 狊/ Pi/ ,/ 参与方/ 集合/ A/ 的/ 所有/ 份额/ 为/ 狊/ A/ ./ 定义/ 3/ ./ 称/ 一个/ LISS/ 方案/ 是/ 正确/ 的/ ,/ 如果/ 份额/ 狊/ A/ 和/ A/ 的/ 张成/ 向量/ 的/ 线性组合/ 可以/ 重构/ 秘密/ s/ ,/ 其中/ A/ 为/ 任意/ 一个/ 授权/ 集/ ./ 定义/ 4/ ./ 称/ 一个/ LISS/ 方案/ 是/ 保密/ 的/ ,/ 如果/ 对于/ 公开/ 区间/ 内/ 的/ 任意/ 两个/ 秘密/ s/ ,/ s/ ,/ 独立/ 随机/ 的/ 掷/ 币/ r/ ,/ r/ 以及/ 任意/ 的/ 非/ 授权/ 集/ A/ ,/ 狊/ A/ 和/ 狊/ ′/ A/ 的/ 分布/ 是/ 统计/ 不可/ 区分/ 的/ ,/ 其中/ 狊/ A/ 为/ 由/ s/ ,/ r/ ,/ k/ 所/ 生成/ 的/ 份额/ ,/ 狊/ ′/ A/ 为/ 由/ s/ ,/ r/ ,/ k/ 所/ 生成/ 的/ 份额/ ./ 显然/ ,/ 定义/ 2/ 中/ 的/ 第一个/ 条件/ 使得/ 方案/ 是/ 正确/ 的/ ,/ 因为/ 对于/ 任意/ 的/ 授权/ 集/ A/ 通过/ 计算/ 份额/ 的/ 线性组合/ 都/ 能够/ 重构/ 出/ 秘密/ ,/ 也/ 即/ 存在/ 一个/ 张成/ 向量/ lA/ 使得/ 犕/ TA/ λ/ A/ =/ ε/ ,/ 从而/ 有/ 狊/ TA/ λ/ A/ =/ (/ 犕/ A/ ρ/ )/ T/ λ/ A/ =/ λ/ A/ ∈/ / ρ/ T/ (/ 犕/ TA/ λ/ A/ )/ =/ ρ/ T/ ε/ =/ s/ ./ 下面/ 的/ 引理/ 证明/ 了/ 定义/ 2/ 中/ 第/ 2/ 个/ 条件/ 是/ 保证/ 方案/ 是/ 保密/ 的/ 充分条件/ ./ 引理/ 1/ ./ 如果/ s/ ∈/ [/ 0/ ,/ N/ ]/ ,/ 而且/ 对于/ 所有/ 的/ 2/ / i/ / m/ ,/ ρ/ i/ 都/ 是/ 均匀/ 随机/ 地选自/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 2kN/ ]/ ,/ 则/ 由/ 得来/ 的/ LISS/ 方案/ 是/ 保密/ 的/ (/ 证明/ 请/ 参见/ 文献/ [/ 8/ ]/ )/ ./ 从/ 上面/ 的/ 介绍/ 可以/ 看到/ ,/ ISP/ 与/ 线性/ 整数/ 秘密/ 共享/ 方案/ 是/ 一一对应/ 的/ ./ 可以/ 看到/ 使用/ ISP/ 来/ 描述/ 协议/ 会/ 更加/ 方便/ ,/ 因此/ 后续/ 的/ 协议/ 将/ 使用/ ISP/ 来/ 描述/ LISS/ ./ 2.3/ 乘性/ 张成/ 方案/ Cramer/ 、/ Damgrd/ 以及/ Maurer/ [/ 5/ ]/ 引入/ 了/ 有限/ 域/ 上/ 张成/ 方案/ 的/ 乘性/ 性质/ ./ 后来/ Cramer/ 、/ Fehr/ 等/ 人/ [/ 6/ ]/ 将/ 乘性/ 性质/ 引入/ 到/ 了/ 任意/ 含/ 1/ 交换/ 环上/ 的/ 张成/ 方案/ 当中/ ./ 乘性/ 性质/ 的/ 本质/ 是/ 要求/ 两个/ 共享/ 秘密/ 的/ 乘积/ 可以/ 由/ 本地/ 份额/ 乘积/ 的/ 线性组合/ 重构/ 得到/ ./ 然而/ 在/ 某些/ 情况/ 下/ ,/ 给定/ 相应/ 的/ 张成/ 方案/ ,/ 并/ 不/ 清楚/ 秘密/ 以及/ 份额/ 将/ 选自于/ 哪个/ 环/ ,/ 因此/ Cramer/ 、/ Fehr/ 等/ 人/ [/ 6/ ]/ 将/ 乘性/ 性质/ 定义/ 为/ 张成/ 方案/ 自身/ 的/ 性质/ ./ 该/ 性质/ 在/ 文献/ [/ 6/ ]/ 中/ 被/ 用来/ 构造/ 门限/ 黑箱/ 安全/ 多方/ 计算/ 协议/ ,/ 本文/ 将/ 该/ 性质/ 具体/ 到/ 整数/ 环/ / 上/ ,/ 然后/ 利用/ 乘/ Page4A/ ∈/ ,/ 珡/ A/ 是/ 乘性/ 的/ ./ 设/ K/ 为/ 一个/ 含/ 1/ 的/ 交换/ 环/ ,/ Q2/ ,/ Q3/ 分别/ 表示/ 敌手/ 结构/ 中/ 的/ 任意/ 两个/ 和/ 三个/ 集合/ 的/ 并/ 集/ 都/ 不/ 等于/ 参与者/ 集合/ P/ ./ Cramer/ 、/ Fehr/ 等/ 人/ [/ 6/ ]/ 证明/ 了/ 对于/ 任意/ 的/ 敌手/ 结构/ ,/ 在/ K/ 上/ 存在/ 一个/ (/ 强/ )/ 乘性/ 张成/ 方案/ 当且/ 仅/ 当/ 是/ (/ Q3/ )/ Q2/ 的/ ./ 本文/ 将/ 考虑/ 一种/ 特殊/ 情况/ ,/ 即/ K/ =/ / ./ 因此/ 有/ 如下/ 相似/ 的/ 结论/ ./ 定理/ 1/ ./ 对于/ 任意/ 的/ 敌手/ 结构/ ,/ 存在/ 一个/ (/ 强/ )/ 乘性/ ISP/ 当且/ 仅/ 当/ 是/ (/ Q3/ )/ Q2/ 的/ ./ 证明/ 请/ 参见/ 文献/ [/ 5/ ,/ 6/ ,/ 11/ ]/ ./ 性/ ISP/ 来/ 构造/ 一般/ 敌手/ 结构/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ ./ 设/ =/ (/ / ,/ 犕/ ,/ ψ/ ,/ ε/ )/ 为/ 敌手/ 结构/ 对应/ 的/ ISP/ ./ 下面/ 的/ 定义/ 是/ 文献/ [/ 6/ ]/ 中/ 定义/ 3/ 的/ 一种/ 特殊/ 情况/ ./ 定义/ 5/ ./ 称/ 张成/ 方案/ 是/ 乘性/ 的/ ,/ 如果/ 存在/ 一个/ 块/ 对角/ 矩阵/ 犇/ ∈/ / 为/ 重构/ 矩阵/ ./ 块/ 对角/ 矩阵/ 可/ 按/ 如下/ 理解/ :/ 设犇/ 的/ 行和列/ 都/ 被/ ψ/ 所/ 标记/ ,/ 那么/ 犇/ 中/ 的/ 非/ 零/ 元素/ 都/ 被/ 集中/ 在/ 块犇/ 1/ ,/ …/ ,/ 犇/ n/ 中/ ,/ 使得/ 对于/ 任意/ 的/ Pi/ ∈/ P/ ,/ 犇/ i/ 中/ 的/ 行和列/ 都/ 被/ Pi/ 所/ 标记/ ./ 称/ 是/ 强/ 乘性/ 的/ ,/ 如果/ 对于/ 任意/ 的/ 参与方/ 集合/ 与域/ 上/ 的/ 情况/ 类似/ ,/ 环上/ 的/ 乘性/ 性质/ 也/ 可以/ 保证/ 分布式/ 地/ 计算/ 两个/ 共享/ 秘密/ 的/ 乘积/ ./ 设/ s/ ,/ s/ ∈/ [/ 0/ ,/ N/ ]/ 为/ 任意/ 的/ 两个/ 秘密/ ,/ 令/ 狊/ =/ 犕/ ρ/ 以及/ 狊/ ′/ =/ 犕/ ρ/ ′/ 为/ s/ ,/ s/ 所/ 对应/ 的/ 份额/ ,/ 则/ 乘积/ ss/ 可/ 表示/ 为/ ss/ =/ ρ/ T/ ε/ ε/ T/ ρ/ ′/ =/ ρ/ T/ 犕/ T/ 犇/ 犕/ ρ/ ′/ =/ (/ 犕/ ρ/ )/ T/ 犇/ (/ 犕/ ρ/ ′/ )/ =/ 狊/ T/ 犇/ 狊/ ′/ =/ ∑/ i/ 也/ 即/ 根据/ 犇/ 的/ 特殊/ 形式/ ,/ ss/ 可写/ 为/ 本地/ 可/ 计算/ 值/ 的/ 和/ ./ 3/ 多方/ 模求/ 逆/ 协议/ 3.1/ 系统/ 模型/ 网络/ 模型/ ./ 考虑/ 由/ 集合/ P/ =/ {/ P1/ ,/ …/ ,/ Pn/ }/ 中/ 的/ n/ 个/ 参与方/ 组成/ 的/ 网络/ ./ 任意/ 两个/ 参与方/ 之间/ 都/ 有/ 一个/ 保密/ 的/ 点对点/ 信道/ ,/ 除此之外/ ,/ 所有/ 的/ 参与方/ 还/ 共享/ 一个/ 广播/ 信道/ ①/ ./ 假设/ 通信/ 是/ 同步/ 的/ ./ 敌手/ 模型/ ./ 通常/ 用/ 一个/ 外部/ 敌手/ 来/ 模仿/ 不诚实/ 的/ 参与方/ ,/ 外部/ 敌手/ 可以/ 收买/ (/ corrupt/ )/ 某些/ 参与方/ 集合/ ./ 本文/ 考虑/ 下面/ 两种/ 类型/ 的/ 敌手/ :/ (/ 1/ )/ 半/ 诚实/ 的/ ./ 敌手/ 获得/ 了/ 被/ 收买/ 的/ 参与方/ 所/ 掌握/ 的/ 所有/ 信息/ ,/ 但/ 并/ 不/ 干涉/ 他们/ 的/ 行为/ ,/ 被/ 收买/ 的/ 参与方/ 仍然/ 忠实/ 地/ 执行/ 协议/ ./ (/ 2/ )/ 恶意/ 的/ ./ 敌手/ 完全/ 控制/ 了/ 被/ 收买/ 的/ 参与方/ ./ 被/ 收买/ 的/ 参与方/ 可能/ 会/ 破坏/ 或者/ 终止/ 协议/ ,/ 或者/ 任意/ 地/ 背离/ 协议/ 的/ 运行/ ./ 诚实/ 的/ 参与方/ (/ 至少/ 初始/ 时/ )/ 并不知道/ 哪些/ 参与方/ 被/ 收买/ 了/ ./ 敌手/ 的/ 收买/ 能力/ 由/ 敌手/ 所/ 能/ 收买/ 的/ 参与方/ 集合/ 组成/ 的/ 子集/ 簇/ -/ 敌手/ 结构/ 来/ 表征/ ./ 本文/ 假设/ 敌手/ 是/ 静态/ 的/ ,/ 也/ 即/ 在/ 协议/ 运行/ 之前/ ,/ 敌手/ 已经/ 确定/ 了/ 要/ 收买/ 的/ 参与方/ ,/ 而且/ 在/ 协议/ 运行/ 过程/ 当中/ 不再/ 改变/ ./ 3.2/ 多方/ 模求/ 逆/ 协议/ 的/ 定义/ 一个/ 多方/ 模求/ 逆/ 协议/ 是/ 一个/ (/ ,/ P/ )/ 协议/ ,/ P/ 中/ 所有/ 的/ 参与方/ 共享/ 一个/ 秘密/ 模数/ / (/ Pi/ 的/ 份额/ 为/ / Pi/ )/ 作为/ 协议/ 的/ 一个/ 私有/ 输入/ ,/ 所有/ 的/ 参与方/ 都/ 知道/ 公开/ 输入/ e/ (/ 一个/ 素数/ )/ 和/ N/ (/ / 的/ 近似/ 界/ )/ ./ 协议/ 的/ 最后/ ,/ 每个/ 参与方/ Pi/ 都/ 获得/ 一个/ 秘密/ 输出/ 犱/ Pi/ ,/ 该/ 输出/ 是/ d/ =/ e/ -/ 1mod/ / 的/ 秘密/ 共享/ 份额/ ./ (/ 1/ )/ 正确性/ ./ 称/ 一个/ 多方/ 模求/ 逆/ 协议/ 是/ 正确/ 的/ ,/ 如果/ P/ 利用/ 得到/ 的/ 份额/ 能够/ 重构/ d/ =/ e/ -/ 1mod/ / ,/ 即使/ 在/ 敌手/ A/ ∈/ 存在/ 的/ 情况/ 下/ ./ (/ 2/ )/ 保密性/ ./ 利用/ 模拟/ 的/ 方法/ 来/ 定义/ 保密性/ ,/ 也/ 即/ ,/ 考虑/ 协议/ 运行/ 当中/ 敌手/ A/ 的/ 视图/ (/ view/ )/ ./ 敌手/ 的/ 视图/ 包括/ 被/ 收买/ 的/ 参与方/ 所/ 拥有/ 的/ 私有/ 输入/ 、/ 协议/ 运行/ 期间/ 收到/ 的/ 来自/ 诚实/ 方/ 的/ 消息/ ./ 称/ 一个/ 多方/ 模求/ 逆/ 协议/ 是/ 保密/ 的/ ,/ 如果/ 对于/ 任意/ 的/ 敌手/ A/ ,/ 都/ 存在/ 一个/ 多项式/ 时间/ 模拟器/ S/ ,/ 使得/ S/ 和/ A/ 一起/ 运行/ 协议/ 时/ ,/ S/ 提供/ 给/ A/ 的/ 视图/ 与/ 真实/ 的/ 视图/ 是/ 不可/ 区分/ 的/ ./ (/ 3/ )/ 安全性/ ./ 称/ 一个/ 多方/ 模求/ 逆/ 协议/ 是/ 安全/ 的/ ,/ 如果/ 它/ 既/ 是/ 正确/ 的/ 又/ 是/ 保密/ 的/ ./ 3.3/ 半/ 诚实/ 敌手/ 模型/ 下/ 的/ 模求/ 逆/ 协议/ 设/ k/ 为/ 安全/ 参数/ ,/ RSA/ 模数/ 为/ N/ ,/ / =/ / (/ N/ )/ ∈/ [/ 0/ ,/ N/ ]/ ,/ 公开/ 素数/ e/ ./ 协议/ 的/ 详细描述/ 请/ 参见/ 图/ 1/ ./ 协议/ 的/ 大体/ 流程/ 如下/ ./ 1/ ./ 每个/ 参与方/ Pi/ ∈/ P/ 开始运行/ 协议/ ,/ 输入/ 其/ 私有/ 输入/ / Pi/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 2/ ./ 协议/ 第/ 1/ 轮/ ,/ 所有/ 参与方/ 共同/ 生成/ 三个/ 随机/ 的/ m/ 维/ 分发/ 向量/ ,/ 相应/ 的/ 秘密/ 分别/ 为/ Λ/ ,/ R/ 以及/ 0.3/ ./ 协议/ 第/ 2/ 轮/ ,/ 参与方/ 之间/ 交换/ 一些/ 有用/ 的/ 信息/ 来/ 重构/ F/ =/ Λ/ / +/ Re/ ./ 4/ ./ 最后/ ,/ 利用/ GCD/ 算法/ 计算/ 出/ a/ 和/ b/ ,/ 使得/ aF/ +/ be/ =/ 1/ ,/ 并设/ d/ =/ aR/ +/ b/ ≡/ e/ -/ 1mod/ / ./ 每个/ 参与方/ Pi/ 利用/ R/ 的/ 份额/ 计算/ 出/ 自己/ 对应/ d/ 的/ 份额/ ./ ①/ 使用/ 该/ 网络/ 模型/ ,/ 可以/ 把/ 精力/ 集中/ 到/ 协议/ 的/ 高层/ 描述/ 上/ ./ 可/ Page5/ 半/ 诚实/ 情况/ i/ =/ 1/ 私有/ 输入/ :/ 已/ 用/ 对应/ 的/ 乘性/ ISP/ 共享/ 了/ / ,/ 分发/ 向量/ 为/ ρ/ / =/ (/ / ,/ ρ/ / ,/ 2/ ,/ …/ ,/ ρ/ / ,/ m/ )/ T/ ,/ 其中/ ρ/ / ,/ j/ ∈/ R/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ N/ ]/ ,/ j/ =/ 2/ ,/ 3/ ,/ …/ ,/ m/ ,/ 公开/ 输入/ :/ RSA/ 模数/ N/ ,/ 素数/ e/ ,/ e/ >/ n/ ,/ (/ e/ ,/ / )/ =/ 1/ ;/ 第/ 1/ 轮/ ./ 每个/ 参与方/ Pi/ 按/ 如下/ 步骤/ 运行/ 协议/ 第/ 1/ 轮/ :/ 1/ ./ 选择/ ρ/ λ/ i/ =/ (/ λ/ i/ ,/ ρ/ λ/ i/ ,/ 2/ ,/ …/ ,/ ρ/ λ/ i/ ,/ m/ )/ T/ ,/ 其中/ λ/ i/ ∈/ R/ [/ 0/ ,/ 2kN/ ]/ ,/ ρ/ λ/ i/ ,/ j/ ∈/ R/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 22kN/ ]/ ,/ j/ =/ 2/ ,/ 3/ ,/ …/ ,/ m/ ;/ 选择/ ρ/ ri/ =/ (/ ri/ ,/ ρ/ ri/ ,/ 2/ ,/ …/ ,/ ρ/ ri/ ,/ m/ )/ T/ ,/ 其中/ ri/ ∈/ R/ [/ 0/ ,/ 2kN2/ ]/ ,/ ρ/ ri/ ,/ j/ ∈/ R/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 22kN2/ ]/ ,/ j/ =/ 2/ ,/ 3/ ,/ …/ ,/ m/ ;/ 选择/ ρ/ 0i/ =/ (/ 0/ ,/ ρ/ 0i/ ,/ 2/ ,/ …/ ,/ ρ/ 0i/ ,/ m/ )/ T/ ,/ 其中/ ρ/ 0i/ ,/ j/ ∈/ R/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 23kN2/ ]/ ,/ j/ =/ 2/ ,/ 3/ ,/ …/ ,/ m/ ./ 2/ ./ 利用/ 式/ (/ 1/ )/ 共享/ λ/ i/ ,/ ri/ ,/ 0/ 给/ 所有/ 的/ 参与方/ ,/ 其中/ ρ/ 分别/ 被/ ρ/ λ/ i/ ,/ ρ/ ri/ 以及/ ρ/ 0i/ 代替/ ./ 3/ ./ 发送/ λ/ iPj/ ,/ 狉/ iPj/ ,/ 0iPj/ 给/ 每个/ 参与方/ Pj/ ./ 第/ 2/ 轮/ ./ 每个/ 参与方/ Pj/ 按/ 如下/ 步骤/ 运行/ 协议/ 第/ 2/ 轮/ :/ 1/ ./ 令/ Λ/ j/ =/ ∑/ n/ 犕/ ρ/ R/ =/ 犕/ ∑/ n2/ ./ 将值/ Fj/ =/ Λ/ T/ (/ Λ/ / =/ ∑/ j/ 输出/ :/ 每个/ 参与方/ Pi/ 做/ 如下/ 操作/ :/ 1/ ./ 将/ 所有/ 的/ 广播/ 值加/ 起来/ ,/ 计算/ F/ =/ ∑/ n2/ ./ 利用/ GCD/ 算法/ 求出/ a/ 和/ b/ ,/ 使得/ aF/ +/ be/ =/ 1/ ./ 如果/ 找/ 不到/ 这样/ 的/ a/ 和/ b/ ,/ 则/ 返回/ 到/ 第/ 1/ 轮/ ;/ 3/ ./ e/ 的/ 逆/ 为/ d/ =/ aR/ +/ b/ ./ 秘密/ 地/ 输出/ d/ 的/ 份额/ 犱/ Pi/ =/ a/ 犚/ i/ +/ b/ 犕/ Pi/ ,/ 1/ ,/ 其中/ 犕/ Pi/ ,/ 1/ 表示/ 犕/ Pi/ 的/ 第/ 1/ 列/ ./ 注/ 2/ ./ 为了/ 便于/ 表示/ 和/ 计算/ ,/ 参与方/ Pi/ 的/ 份额/ 可以/ 设置/ 为/ a/ 犚/ i/ ,/ 在/ 重构/ d/ 时/ ,/ 可以/ 首先/ 重构/ 得到/ aR/ ,/ 然后/ 再/ 加上/ 常数/ b/ 即可/ 得到/ d/ ./ 图/ 1/ 半/ 诚实/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ 定理/ 2/ ./ 如果/ 所有/ 的/ 参与方/ 都/ 正确/ 地/ 执行/ 图/ 1/ 所/ 描述/ 的/ 协议/ ,/ 并且/ 敌手/ 结构/ 是/ Q2/ 的/ ,/ 那么/ 上述/ 协议/ 就是/ 一个/ 安全/ 的/ 多方/ 模求/ 逆/ 协议/ ./ 证明/ ./ 不难看出/ ,/ 协议/ 泄露/ 的/ 唯一/ 信息/ 就是/ 值/ F/ =/ Λ/ / +/ Re/ ./ 但是/ 可以/ 证明/ F/ 的/ 分布/ 是/ 与/ / (/ 几乎/ )/ 独立/ 无关/ 的/ ./ 具体来讲/ ,/ 可以/ 证明/ 当/ Λ/ 和/ R/ 遵从/ 协议/ 中/ 所/ 描述/ 的/ 概率分布/ 时/ ,/ {/ F/ =/ Λ/ / +/ Re/ }/ 的/ 分布/ 和/ {/ ^/ F/ =/ Λ/ N/ +/ Re/ }/ 的/ 分布/ 是/ 统计/ 不可/ 区分/ 的/ (/ 达/ O/ (/ 2/ -/ k/ )/ )/ ./ 下面/ 就/ 根据/ 3.2/ 节/ 的/ 安全性/ 定义/ 给出/ 具体/ 的/ 证明/ ./ 正确性/ ./ 很/ 容易/ 验证/ 协议/ 可以/ 得到/ 正确/ 的/ 输出/ ./ 由于/ 是/ Q2/ 的/ ,/ 则/ 存在/ 一个/ 与/ 对应/ 的/ 乘性/ ISP/ ,/ 也/ 即/ ,/ 存在/ 一个/ 重构/ 矩阵/ 犇/ ,/ 使得/ 参与方/ 利用/ 该/ 矩阵/ 以及/ 相应/ 的/ 份额/ 可以/ 重构/ Λ/ / ./ 另外/ 也/ 存在/ 一个/ 重构/ 向量/ 狋/ 来/ 重构/ R/ ./ 因此/ 参与方/ 可以/ 计算/ 得到/ F/ =/ Λ/ / +/ Re/ ./ 然后/ 可以/ 将/ 它/ 与/ e/ 做/ GCD/ 运算/ ./ 注意/ 到/ (/ e/ ,/ / )/ =/ 1/ ,/ GCD/ (/ F/ ,/ e/ )/ ≠/ 1/ 的/ 概率/ 约/ 为/ 1/ // e/ (/ 也/ 即/ e/ 整除/ Λ/ 的/ 概率/ )/ ,/ 因此/ 并不需要/ 重复/ 运行/ 协议/ 很/ 多次/ ./ 一旦/ 找到/ 了/ a/ 和/ b/ ,/ 使得/ aF/ +/ be/ =/ 1/ ,/ 可/ 将/ 它/ 写/ 为/ a/ (/ Λ/ / +/ Re/ )/ +/ be/ =/ 1/ ,/ 等式/ 两边/ 取/ mod/ / ,/ 则/ 等式/ 变为/ (/ aR/ +/ b/ )/ e/ =/ 1mod/ / ,/ 这样/ 就/ 得到/ 了/ d/ =/ aR/ +/ b/ =/ e/ -/ 1mod/ / ./ 注意/ 到/ R/ 已/ 由/ 共享/ ,/ 而且/ a/ 和/ b/ 都/ 是/ 常数/ ,/ 所以/ 由/ 输出/ 值/ 犱/ Pi/ 确实/ 可以/ 重构/ d/ ./ 保密性/ ./ (/ 1/ )/ 初始/ 输入/ ./ 敌手/ A/ 知道/ 所有/ 被/ 收买/ 的/ 参与/ λ/ i/ ,/ R/ =/ ∑/ ni/ =/ 1/ 方所/ 拥有/ 的/ 私有/ 输入/ ./ 模拟器/ 可以/ 利用/ 相同/ 的/ ISP/ 来/ 共享/ N/ ,/ 并/ 将/ 相应/ 的/ 份额/ 分/ 发给/ A/ ./ 由于/ N/ -/ / =/ O/ (/ 槡/ N/ )/ ,/ 仿照/ 引理/ 1/ ,/ 可以/ 证明/ 是/ 保密/ 的/ ,/ 份额/ 犖/ A/ 和/ / A/ 是/ 统计/ 不可/ 区分/ 的/ ./ (/ 2/ )/ 接收/ 到/ 的/ 消息/ ./ 协议/ 第/ 1/ 轮/ ,/ 模拟器/ 只/ 需/ 简单/ 地/ 遵从/ 协议/ 即可/ ,/ 这样/ 第/ 1/ 轮/ 过后/ ,/ 模拟器/ 共享/ 了/ ^/ Λ/ ,/ ^/ R/ 和/ ^/ Z/ ./ 显然/ ,/ ^/ Λ/ ,/ ^/ R/ ,/ ^/ Z/ 与/ Λ/ ,/ R/ ,/ Z/ 遵从/ 相同/ 的/ 分布/ ./ 同时/ 注意/ 到/ ,/ 与/ 初始/ 输入/ 类似/ ,/ 敌手/ 不能/ 获得/ ^/ Λ/ ,/ ^/ R/ 和/ ^/ Z/ 的/ 任何/ 信息/ ./ 协议/ 第/ 2/ 轮/ ,/ 模拟器/ 广播/ 值/ ^/ Fj/ =/ ^/ Λ/ Tj/ 犇/ j/ 犖/ Pj/ +/ e/ 〈/ 狋/ j/ ,/ ^/ 犚/ j/ 〉/ +/ 〈/ 狋/ j/ ,/ ^/ 犣/ j/ 〉/ (/ 对于/ 所有/ 的/ Pj/ ∈/ 珡/ A/ )/ ./ 因为/ ρ/ Z/ 和/ ρ/ Z/ ^/ 中/ 的/ 元素/ 分别/ 要/ 比/ ρ/ R/ ,/ ρ/ Λ/ ,/ ρ/ / 和/ ρ/ R/ ^/ ,/ ρ/ Λ/ ^/ ,/ ρ/ / ^/ 中/ 的/ 元素/ 分别/ 高出/ 一到/ 三阶/ (/ 相对/ 于/ 安全/ 参数/ k/ 和/ N/ )/ ,/ 因此/ 〈/ 狋/ j/ ,/ 犣/ j/ 〉/ 和/ 〈/ 狋/ j/ ,/ ^/ 犣/ j/ 〉/ 分别/ 要/ 比/ Λ/ Te/ 〈/ 狋/ j/ ,/ 犚/ j/ 〉/ 和/ ^/ Λ/ T/ 全/ 参数/ k/ )/ ,/ 从而/ Fj/ 和/ ^/ Fj/ 的/ 分布/ 都/ 在/ 统计/ 上/ 与/ 〈/ 狋/ j/ ,/ 犣/ j/ 〉/ 的/ 分布/ 接近/ ./ 最后/ 敌手/ 将/ 所有/ 的/ 广播/ 值加/ 起来/ ,/ 得到/ ^/ F/ =/ ^/ Λ/ N/ +/ ^/ Re/ ,/ 而/ 在/ 实际/ 的/ 协议/ 中/ 敌手/ 将/ 得到/ F/ =/ Λ/ / +/ Re/ ,/ 这是/ 模拟器/ 与/ 实际/ 协议/ 的/ 唯一/ 区别/ ./ 然而/ 可以/ 证明/ 这/ 两个/ 值/ 的/ 分布/ 是/ 统计/ 不可/ 区分/ 的/ ./ 此处/ 省略/ 了/ 该/ 证明/ 过程/ ,/ 读者/ 可/ 参见/ 文献/ [/ 4/ ]/ 的/ 完整版/ ./ 证毕/ ./ 3.4/ 恶意/ 敌手/ 模型/ 下/ 的/ 模求/ 逆/ 协议/ 本节/ 来/ 考虑/ 恶意/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ ./ 我们/ 构造/ 了/ 一个/ 一般性/ 模求/ 逆/ 协议/ ,/ 并/ 证明/ 了/ 如果/ 敌手/ 结构/ 是/ Q3/ 的/ ,/ 那么/ 该/ 协议/ 在/ 强/ RSA/ 假设/ 之下/ 是/ 安全/ 的/ ./ 协议/ 的/ 具体/ 描述/ 详见/ 图/ 2/ ./ Page6/ 私有/ 输入/ :/ 已/ 用/ 对应/ 的/ 强/ 乘性/ ISP/ 共享/ 了/ / ,/ 分发/ 向量/ 为/ ρ/ / =/ (/ / ,/ ρ/ / ,/ 2/ ,/ …/ ,/ ρ/ / ,/ m/ )/ T/ ,/ 并/ 选择/ ρ/ / ^/ =/ (/ / ^/ ,/ ρ/ / ^/ ,/ 2/ ,/ …/ ,/ ρ/ / ^/ ,/ m/ )/ T/ 对/ ρ/ / 做/ 承诺/ ,/ 其中/ 一般性/ 模求/ 逆/ 协议/ 公开/ 输入/ :/ RSA/ 模数/ N/ ,/ 素数/ e/ ,/ e/ >/ n/ ,/ (/ e/ ,/ / )/ =/ 1/ 以及/ 利用/ ρ/ / ^/ 得到/ 的/ 关于/ ρ/ / 的/ 公开/ 承诺/ ./ 第/ 1/ 轮/ :/ 每个/ 参与方/ Pi/ 选择/ λ/ i/ ∈/ R/ [/ 0/ ,/ N2k/ ]/ 和/ ri/ ∈/ R/ [/ 0/ ,/ N222k/ ]/ ,/ 然后/ 进行/ 如下/ 操作/ :/ ;/ 1/ ./ 使用/ VLISS/ 来/ 共享/ λ/ i/ ,/ 界为/ N2k/ ,/ 得到/ 的/ 分发/ 向量/ 分别/ 为/ ρ/ λ/ i/ 和/ ρ/ λ/ ^/ i2/ ./ 使用/ VLISS/ 来/ 共享/ ri/ ,/ 界为/ N222k/ ,/ 得到/ 的/ 分发/ 向量/ 分别/ 为/ ρ/ ri/ 和/ ρ/ r/ ^/ i/ ;/ 3/ ./ 使用/ VLISS/ 来/ 共享/ 0/ ,/ 界为/ N323k/ ,/ 得到/ 的/ 分发/ 向量/ 分别/ 为/ ρ/ 0i/ 和/ ρ/ 0/ ^/ i/ ./ 注/ 3/ ./ 在/ 此仅/ 用到/ 了/ VLISS/ 的/ 分发/ 阶段/ ,/ 其中/ 得到/ 的/ ρ/ λ/ ^/ i/ 设/ A/ 为/ 第/ 1/ 轮中/ 所有/ 通过/ VLISS/ 验证/ 的/ 参与方/ 组成/ 的/ 集合/ ,/ 令/ Λ/ =/ ∑/ Pi/ ∈/ A/ 第/ 2/ 轮/ :/ 每个/ 参与方/ Pj/ 进行/ 如下/ 操作/ :/ 1/ ./ 将/ 从/ 第/ 1/ 轮中/ 收到/ 的/ 所有/ 来自/ A/ 中/ 参与方/ 的/ 份额/ 加/ 起来/ ,/ 也/ 即/ ,/ 令注/ 4/ ./ 这些/ 份额/ 是/ 由/ 分发/ 矩阵/ 犕/ A/ 和/ 分发/ 向量/ ρ/ Λ/ ,/ ρ/ R/ ,/ ρ/ Z/ ,/ ρ/ Λ/ ^/ ,/ ρ/ R/ ^/ ,/ ρ/ Z/ ^/ 生成/ 的/ ./ Λ/ j/ ,/ 犚/ j/ ,/ 犣/ j/ 的/ 承诺/ 值/ 可以/ 由/ VLISS/ 得到/ ./ 2/ ./ 将值/ Fj/ =/ Λ/ T/ 输出/ :/ 每个/ 参与方/ Pi/ 进行/ 如下/ 操作/ :/ 1/ ./ Pi/ 利用/ 图/ 4/ 描述/ 的/ 子/ 协议/ Prove/ -/ Correct/ 来/ 证明/ Fi/ 是/ 正确/ 的/ ./ 令/ A/ 为/ 所有/ 能够/ 正确/ 执行/ Prove/ -/ Correct/ 的/ 参与方/ 组成/ 的/ 集合/ ./ 如果/ A/ =/ A/ ,/ 则/ 继续执行/ 后续/ 步骤/ ;/ 否则/ 返回/ 到/ 第/ 2/ 轮/ ,/ 并/ 将/ A/ 赋值/ 给/ A/ ,/ 重新/ 运行/ ,/ 直至/ 运行/ 到/ 这/ 一步/ 满足/ A/ =/ A/ 为止/ ./ 2/ ./ A/ 中/ 的/ 每个/ 参与方/ Pi/ 计算/ F/ =/ ∑/ Pi/ ∈/ A3/ ./ 利用/ GCD/ 算法/ ,/ 求出/ a/ 和/ b/ ,/ 满足/ aF/ +/ be/ =/ 1/ ./ 如果/ 不/ 存在/ 满足/ 上述/ 条件/ 的/ a/ 和/ b/ ,/ 则/ 返回/ 到/ 第/ 1/ 轮/ ./ 4/ ./ 每个/ 参与方/ Pi/ 秘密/ 地/ 计算/ 相应/ 的/ 份额/ 犱/ Pi/ =/ a/ 犚/ i/ +/ b/ 犕/ Pi/ ,/ 1/ ,/ 其中/ 犕/ Pi/ ,/ 1/ 为/ 犕/ Pi/ 的/ 第/ 1/ 列/ ./ 图/ 2/ 恶意/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ 在/ 恶意/ 敌手/ 模型/ 中/ ,/ 恶意/ 的/ 参与方/ 可能/ 任意/ 地/ 背离/ 协议/ 来/ 干扰/ 诚实/ 方/ 得到/ 正确/ 的/ 输出/ ,/ 或者/ 想方设法/ 地/ 获取/ 诚实/ 方/ 的/ 私有/ 信息/ ./ 多方/ 模求/ 逆/ 协议/ 要求/ 即使/ 在/ 恶意/ 敌手/ 存在/ 的/ 情况/ 下/ ,/ 诚实/ 方/ 仍然/ 能够/ 保密/ 地/ 计算/ 得到/ 正确/ 的/ 输出/ ./ 为了/ 做到/ 这/ 一点/ ,/ 本文/ 采用/ 了/ 如下/ 两种/ 常用/ 技术/ :/ VLISS/ 分发/ 阶段/ 公开/ 输入/ :/ RSA/ 模数/ N/ ,/ 两个/ 生成元/ G/ ,/ H/ ∈/ QN/ 以及/ 界/ β/ ./ 分发者/ (/ dealer/ )/ 的/ 输入/ :/ 秘密/ s/ ∈/ [/ 0/ ,/ β/ ]/ ./ 1/ ./ 分发者/ 选择/ s/ ^/ ∈/ R/ [/ 0/ ,/ β/ ]/ 以及/ ρ/ 2/ ,/ ρ/ ^/ 2/ ,/ …/ ,/ ρ/ m/ ,/ ρ/ ^/ m/ ∈/ R/ [/ 0/ ,/ κ/ max/ (/ m/ -/ 1/ )/ 2k/ β/ ]/ ./ 令/ ρ/ s/ =/ (/ s/ ,/ ρ/ 2/ ,/ …/ ,/ ρ/ m/ )/ T/ ,/ ρ/ s/ ^/ =/ (/ s/ ^/ ,/ ρ/ ^/ 2/ ,/ …/ ,/ ρ/ ^/ m/ )/ T/ ./ 利用/ 式/ (/ 1/ )/ 在/ P/ 中/ 共享/ s/ ,/ s/ ^/ ,/ 将/ 值/ 狊/ Pi2/ ./ 参与方/ Pi/ 验证/ (/ Cw/ )/ MPi/ ,/ j/ ,/ wmodNw/ =/ 1/ 其中/ sPi/ ,/ j/ 和/ s/ ^/ Pi/ ,/ j/ 分别/ 为/ 狊/ Pi/ 和/ 狊/ ^/ Pi/ 中/ 的/ 第/ j/ 个/ 元素/ ,/ MPi/ ,/ j/ ,/ w/ 为/ 犕/ Pi/ 中/ 第/ j/ 行/ 的/ 第/ w/ 个/ 元素/ ./ 如果/ 验证/ 失败/ ,/ Pi/ 则/ 公开/ 投诉/ ./ 如果/ 所有/ 投诉/ 的/ 参与方/ 能够/ 形成/ 一个/ 授权/ 集/ ,/ 那么/ 分发者/ 将/ 被/ 弹劾/ ./ 3/ ./ 如果/ 分发者/ 没有/ 被/ 弹劾/ ,/ 他会/ 公开/ 满足/ 式/ (/ 2/ )/ 的/ 值/ 狊/ Pi/ 和/ 狊/ ^/ Pi/ ./ 如果/ 分发者/ 不能/ 正确/ 执行/ 这/ 一步/ ,/ 他/ 将/ 被/ 弹劾/ ./ 4/ ./ Pi/ 验证/ 他/ 接收/ 到/ 的/ 值/ 以及/ 分发者/ 之前/ 广播/ 的/ 值/ 在/ 绝对值/ 上/ 是否/ 都/ 被/ 限制/ 在/ 界/ κ/ 2max/ (/ m/ -/ 1/ )/ 22k/ β/ +/ κ/ max/ β/ 之内/ ./ 如果/ 验证/ 失败/ ,/ Pi/ 则/ 会/ 公开/ 他/ 的/ 份额/ ./ 如果/ 公开/ 的/ 份额/ 确实/ 比/ κ/ 2max/ (/ m/ -/ 1/ )/ 22k/ β/ +/ κ/ max/ β/ 大/ ,/ 而且/ 满足/ 式/ (/ 2/ )/ ,/ 那么/ 分发者/ 将/ 被/ 弹劾/ ./ 重构/ 阶段/ 每个/ 参与方/ Pi/ 出示/ 狊/ Pi/ 和/ 狊/ ^/ Pi/ ,/ 只有/ 满足/ 式/ (/ 2/ )/ 的/ 值/ 才/ 会/ 被/ 接受/ ./ 利用/ 常用/ 的/ LISS/ 来/ 重构/ 秘密/ s/ ,/ 然后/ 将/ 它/ 输出/ ./ 图/ 3/ 可验证/ 线性/ 整数/ 秘密/ 共享/ 方案/ (/ VLISS/ )/ λ/ i/ ,/ R/ =/ ∑/ Pi/ ∈/ A/ ρ/ ri/ ,/ ρ/ Z/ =/ ∑/ Pi/ ∈/ A/ ρ/ r/ ^/ i/ ,/ ρ/ Z/ ^/ =/ ∑/ Pi/ ∈/ A/ 狉/ iPj/ ,/ 犣/ j/ =/ ∑/ Pi/ ∈/ A/ ^/ 狉/ iPj/ ,/ ^/ 犣/ j/ =/ ∑/ Pi/ ∈/ A/ (/ 1/ )/ 将/ 第/ 1/ 轮中/ 简单/ 的/ 线性/ 整数/ 秘密/ 共享/ 方案/ 替换/ 为/ 可验证/ 线性/ 整数/ 秘密/ 共享/ (/ VLISS/ ,/ Peders/ -/ en/ -/ VSS/ [/ 9/ ]/ 的/ 一个/ 变体/ )/ 方案/ ,/ 来/ 保证/ 参与方/ 在/ 分布式/ 生成/ 随机数/ 时/ 执行/ 正确/ 的/ 秘密/ 共享/ ,/ 保证/ 每个/ 参与方/ 共享/ 得到/ 的/ 份额/ 是/ 一致/ 的/ ./ 图/ 3/ 给出/ 了/ VLISS/ 的/ 详细描述/ ./ Page7Prove/ -/ CorrectP/ 的/ 私有/ 输入/ :/ 犪/ ,/ 犪/ ^/ ,/ 犫/ ,/ 犫/ ^/ ,/ 犮/ ,/ 犮/ ^/ (/ 定义/ 如上所述/ )/ ./ 公开/ 输入/ :/ RSA/ 模数/ N/ ,/ 两个/ 生成元/ G/ ,/ H/ ∈/ QN/ ,/ 素数/ e/ ,/ e/ >/ n/ ,/ (/ e/ ,/ / )/ =/ 1/ ./ F/ 和/ 承诺/ 值/ Ai/ ,/ Bi/ ,/ Ci/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ u/ ,/ C/ ρ/ / ,/ j/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ./ 目标/ :/ 证明/ F/ =/ 犪/ T/ 犇/ P/ 犫/ +/ e/ 〈/ 狋/ ,/ 犮/ 〉/ 1/ ./ V/ 验证/ 公开/ 承诺/ 值/ Ai/ ,/ Bi/ ,/ Ci/ 和/ C/ ρ/ / ,/ j/ 是否/ 满足/ 式/ (/ 2/ )/ ./ 2/ ./ Ρ/ 随机/ 选择/ 一个/ 矩阵/ Δ/ ∈/ [/ 0/ ,/ N2/ ]/ u/ ×/ u/ 并且/ 公开/ Eij/ =/ GaibjH/ Δ/ ij/ ,/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ u/ ./ 3/ ./ Ρ/ 以/ 零/ 知识/ 的/ 形式/ (/ 向/ 验证/ 者/ V/ )/ 证明/ Eij/ 相对/ Ai/ ,/ Bj/ (/ i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ u/ )/ 是/ 正确/ 的/ :/ (/ a/ )/ Ρ/ 随机/ 选择/ α/ ,/ α/ ^/ ,/ β/ ,/ β/ ^/ ∈/ [/ 0/ ,/ N323k/ ]/ u/ 以及/ Δ/ ^/ ∈/ R/ [/ 0/ ,/ N323k/ ]/ u/ ×/ u/ ,/ 并/ 将/ Mi/ =/ G/ α/ iH/ α/ ^/ i/ ,/ Xi/ =/ G/ β/ iH/ β/ ^/ i/ ,/ Yij/ =/ B/ α/ ijH/ ^/ Δ/ ij/ 发送给/ V/ ./ (/ b/ )/ V/ 随机/ 选择/ θ/ ∈/ [/ 0/ ,/ N/ ]/ ,/ 并/ 将/ 其/ 发送给/ Ρ/ ./ (/ c/ )/ Ρ/ 返回/ xi/ =/ α/ i/ +/ θ/ ai/ ,/ x/ ^/ i/ =/ α/ ^/ i/ +/ θ/ a/ ^/ i/ ,/ yi/ =/ β/ i/ +/ θ/ bi/ ,/ y/ ^/ i/ =/ β/ ^/ i/ +/ θ/ b/ ^/ i/ ,/ zij/ =/ Δ/ ^/ ij/ +/ θ/ (/ Δ/ ij/ -/ b/ ^/ jai/ )/ ./ (/ d/ )/ V/ 接受/ Eij/ 是/ 正确/ 的/ ,/ 如果/ GxiHx/ ^/ i/ =/ MiA/ θ/ i/ ,/ BxijHzij/ =/ YijE/ θ/ ij/ ,/ GyiHy/ ^/ i/ =/ XiB/ θ/ i/ ./ 4/ ./ Ρ/ 公开/ F/ =/ 犪/ T/ 犇/ Ρ/ 犫/ +/ e/ 〈/ 狋/ ,/ 犮/ 〉/ 和/ F/ ^/ =/ ∑/ ij/ (/ Eij/ )/ D/ Ρ/ ij/ ∏/ i/ 图/ 4/ 如何/ 证明/ F/ =/ 犪/ T/ 犇/ P/ 犫/ +/ e/ 〈/ 狋/ ,/ 犮/ 〉/ (/ 2/ )/ 第/ 2/ 轮/ 重构/ F/ 时/ ,/ 利用/ Prove/ -/ Correct/ 零/ 知识/ 证明/ 协议/ 来/ 防止/ 恶意/ 的/ 参与方/ 提供/ 错误/ 的/ 份额/ 。/ 图/ 4/ 给出/ 了/ Prove/ -/ Correct/ 协议/ 的/ 具体/ 实现/ ./ 为了/ 便于/ 理解/ 和/ 描述/ ,/ 本文/ 先/ 给出/ 一般性/ 模求/ 逆/ 协议/ 的/ 具体/ 描述/ ,/ 之后/ 再/ 分别/ 给出/ VLISS/ 和/ Prove/ -/ Correct/ 的/ 具体/ 描述/ ./ 设/ k/ 为/ 安全/ 参数/ ,/ RSA/ 模数/ 为/ N/ ,/ / =/ / (/ N/ )/ ∈/ [/ 0/ ,/ N/ ]/ ,/ 公开/ 素数/ e/ ./ 一般性/ 模求/ 逆/ 协议/ 的/ 完整/ 描述/ 见图/ 2/ ./ 在/ 一般性/ 模求/ 逆/ 协议/ 中/ ,/ “/ 使用/ VLISS/ 共享/ s/ ,/ 界为/ β/ ”/ 表示/ 共享/ s/ 时/ ,/ 选取/ 区间/ [/ 0/ ,/ β/ ]/ 的/ 元素/ 来/ 为/ s/ 做/ 承诺/ ,/ 分发/ 向量/ 中/ 其它/ 元素/ 也/ 由/ β/ 的/ 常数/ 倍/ 界定/ ./ 假设/ 所有/ 的/ 参与方/ 都/ 会/ 通过/ 下面/ 的/ 承诺/ 方案/ 对/ 分发/ 向量/ ρ/ / 中/ 的/ 元素/ 做/ 承诺/ ,/ 并/ 作为/ 公开/ 输入/ 的/ 一部分/ ,/ 在/ 执行/ Prove/ -/ Correct/ 协议/ 时会/ 用到/ 这些/ 承诺/ ./ VLISS/ 协议/ 也/ 会/ 用到/ 下面/ 的/ 承诺/ 方案/ C/ :/ 公开/ 参数/ 为/ 一个/ RSA/ 模数/ N/ =/ pq/ (/ p/ =/ 2p/ +/ 1/ ,/ q/ =/ 2q/ +/ 1/ ,/ p/ ,/ p/ ,/ q/ ,/ q/ 都/ 是/ 素数/ )/ 以及/ 两个/ 随机/ 元素/ G/ ,/ H/ ∈/ QN/ ./ QN/ 为/ / 阶/ 循环群/ ./ 可设/ G/ ,/ H/ 为/ QN/ 的/ 两个/ 生成元/ ,/ 因为/ 它们/ 不是/ 生成元/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 消息/ 空间/ 为/ 一个/ 整数/ 集/ ./ 为了/ 对/ 整数/ α/ 做/ 承诺/ ,/ 发送/ 方在/ 某个/ 给定/ 的/ 区间/ 内/ (/ 比如/ [/ 0/ ,/ N2/ ]/ )/ 随机/ 选择/ 一个/ 整数/ α/ ^/ ,/ 将/ C/ (/ α/ ,/ α/ ^/ )/ =/ G/ α/ H/ α/ ^/ modN/ 发送给/ 接收/ 方/ ./ 解/ 承诺/ 时/ ,/ 发送/ 方/ 给出/ α/ ,/ α/ ^/ ,/ 接收/ 方/ 验证/ 他们/ 是否/ 与/ C/ (/ α/ ,/ α/ ^/ )/ 匹配/ ./ 引理/ 2/ ./ 在/ 分解/ N/ 是/ 困难/ 的/ 假设/ 之下/ ,/ 上述/ 承诺/ 方案/ 是/ 一个/ 信息论/ 意义/ 下/ 保密/ 、/ 计算/ 意义/ 下/ 绑定/ 的/ 承诺/ 方案/ ./ 相关/ 证明/ 请/ 参见/ 文献/ [/ 4/ ]/ 的/ 完整版/ ./ 当/ 在/ 多方/ 模求/ 逆/ 协议/ 中/ 执行/ 子/ 协议/ Prove/ -/ Cor/ -/ (/ Ci/ )/ etimodNrect/ 时/ ,/ 每/ 一个/ 参与方/ 都/ 会/ 充当/ 证明/ 者/ 运行/ Prove/ -/ Correct/ 一次/ ./ 验证/ 者/ 的/ 挑战/ 将/ 由/ 其他/ 所有/ 的/ 参与方/ 共同/ 生成/ ./ Canetti/ 等/ 人/ [/ 12/ ]/ 证明/ 了/ 该/ 协议/ 是/ 一个/ 诚实/ 验证/ 者/ 零/ 知识/ 协议/ ,/ 因为/ 每个/ 运行/ 该/ 协议/ 的/ 证明/ 者/ 面对/ 的/ 是/ 由/ 其他/ 所有/ 参与方/ 组成/ 的/ 一个/ “/ 虚拟/ ”/ 的/ 验证/ 者/ ./ 该/ 验证/ 者/ 被/ 强制/ 是/ 诚实/ 的/ ,/ 因为/ 其它/ 所有/ 的/ 参与方/ 中/ 的/ 大多数/ 都/ 是/ 诚实/ 的/ ./ 3.4/ ./ 1/ 可验证/ 线性/ 整数/ 秘密/ 共享/ 方案/ 在/ 一般性/ 模求/ 逆/ 协议/ 中/ ,/ 考虑/ 到/ 是/ 在/ 整数/ 环上/ 进行/ 秘密/ 共享/ ,/ 因此/ 本文/ 给出/ 了/ Pedersen/ -/ VSS/ [/ 9/ ]/ 的/ 一个/ 变体/ -/ 可验证/ 线性/ 整数/ 秘密/ 共享/ (/ VLISS/ )/ 方案/ ./ 在/ Pedersen/ 的/ 方案/ 中/ ,/ 秘密/ 和/ 份额/ 被/ 视为/ 某个/ 循环群/ 〈/ g/ 〉/ 的/ “/ 指数/ ”/ ./ 因此/ 在/ 份额/ 和/ 群/ 元素/ 之间/ 存在/ 一个/ 有效/ 的/ 映射/ x/ / gx/ ,/ 参与方/ 可以/ 利用/ 群/ 运算/ 来/ 验证/ 份额/ 的/ 各种/ 性质/ ./ 在/ VLISS/ 中/ ,/ 秘密/ 和/ 份额/ 则/ 被/ 视为/ 循环群/ QN/ 的/ “/ 指数/ ”/ ,/ 因此/ 参与方/ 同样/ 可以/ 利用/ 群/ 运算/ 来/ 验证/ 份额/ 的/ 正确性/ ./ 后面/ 将/ 证明/ ,/ 在/ 分解/ N/ 是/ 困难/ 的/ 假设/ 下/ ,/ VLISS/ 是/ 一个/ 安全/ 的/ VSS/ ./ 协议/ VLISS/ 的/ 具体/ 描述/ 请/ 参见/ 图/ 3/ ./ 注/ 5/ ./ 为了/ 保证/ VLISS/ 是/ 一个/ 安全/ 的/ VSS/ ,/ 协议/ 中/ 的/ 第/ 4/ 步/ 并/ 不是/ 必须/ 的/ ./ 多方/ 模求/ 逆/ 协议/ 需要/ 这/ 一步/ 是因为/ Pedersen/ -/ VSS/ 并/ 没有/ 提供/ 工具/ 来/ 保证/ 所/ 共享/ 的/ 秘密/ 是/ “/ 足够/ 小/ 的/ ”/ ,/ 而/ 协议/ 的/ 保密性/ 就/ 依赖于/ 我们/ 知道/ 秘密/ 大小/ 的/ 某个/ 界值/ ./ 例如/ ,/ 如果/ F/ =/ Λ/ / +/ eR/ 中/ Λ/ 的/ 大小/ 比/ 其它/ 项大/ 很多/ ,/ 那么/ F/ 就/ 会/ 泄露/ / 的/ 部分/ 信息/ ./ 因此/ ,/ 每个/ 参与方/ 都/ 要/ 验证/ 一下/ 相应/ 的/ 份额/ 是否/ 界定/ 在/ 某个/ 区间/ [/ 0/ ,/ κ/ 2max/ (/ m/ -/ 1/ )/ 22k/ β/ +/ κ/ max/ β/ ]/ 之内/ ,/ 以此/ 确定/ 相应/ 的/ 秘密/ 是否/ 落/ 在/ 区间/ [/ 0/ ,/ λ/ max/ κ/ 2maxn/ (/ m/ -/ 1/ )/ 22k/ β/ +/ λ/ max/ κ/ maxn/ β/ ]/ 内/ ./ 引理/ 3/ ./ 如果/ 是/ Q2/ 的/ ,/ 那么/ 在/ 分解/ N/ 是/ 困难/ 的/ 假设/ 之下/ ,/ 针对/ 敌手/ 结构/ ,/ 图/ 3/ 描述/ 的/ 协议/ Page8VLISS/ 是/ 一个/ 安全/ 的/ VSS/ ./ 证明/ ./ 正确性/ ./ 由于/ 是/ Q2/ 的/ ,/ 对于/ 任意/ A/ ∈/ ,/ 珡/ A/ 是/ 一个/ 授权/ 集/ ,/ 正确性/ 可/ 由/ 珡/ A/ 实现/ ./ 而且/ ,/ 协议/ 中/ 的/ 承诺/ 是/ 计算/ 意义/ 下/ 绑定/ 的/ ,/ 敌手/ 在/ 解/ 承诺/ 时/ ,/ 无法/ 给出/ 两个/ 不同/ 的/ 解/ ./ 因此/ 任何/ 恶意/ 的/ 参与方/ 都/ 能够/ 被/ 检测/ 出来/ ./ 保密性/ ./ 很/ 容易/ 验证/ 敌手/ 所/ 拥有/ 的/ 份额/ 其/ 分布/ 是/ 和/ 其它/ 秘密/ 所/ 生成/ 份额/ 的/ 分布/ 是/ 统计/ 不可/ 区分/ 的/ ,/ 也/ 即/ 敌手/ 从/ 拥有/ 的/ 份额/ 中/ 无法/ 获得/ 秘密/ 的/ 相关/ 信息/ ./ 这/ 一点/ 是/ 由/ LISS/ 的/ 保密性/ 来/ 保证/ 的/ (/ 参见/ 引理/ 1/ )/ ./ 另外/ ,/ 敌手/ 看到/ 的/ 对/ 分发/ 向量/ 的/ 承诺/ 是/ 信息论/ 意义/ 下/ 保密/ 的/ ,/ 因此/ 从中/ 敌手/ 也/ 无法/ 获得/ 秘密/ 的/ 相关/ 信息/ ./ 3.4/ ./ 2/ 份额/ 正确性/ 的/ 证明/ 在/ 一般性/ 模求/ 逆/ 协议/ 第/ 2/ 轮/ 重构/ F/ 时/ ,/ 必须/ 要/ 防止/ 恶意/ 的/ 参与方/ 提供/ 错误/ 的/ 份额/ ,/ 这是/ 通过/ 图/ 4/ 介绍/ 的/ Prove/ -/ Correct/ 零/ 知识/ 证明/ 协议/ 实现/ 的/ ./ 该/ 协议/ 使用/ 了/ Fujisaki/ 和/ Okamoto/ [/ 13/ ]/ 提出/ 的/ 一项/ 基于/ 强/ RSA/ 假设/ 的/ 技术/ ,/ 其中/ N/ 同样/ 是/ 两个/ 安全/ 素数/ 的/ 乘积/ ./ 定义/ 6/ (/ 强/ RSA/ 假设/ )/ ./ 给定/ RSA/ 模数/ N/ 和/ 一个/ 随机/ 元素/ y/ ∈/ / 数对/ (/ e/ ,/ x/ )/ ,/ 其中/ x/ ∈/ / xe/ =/ y/ (/ modN/ )/ 的/ 成功/ 概率/ 是/ 可/ 忽略/ 的/ ./ 强/ RSA/ 假设/ 是/ 由/ 文献/ [/ 14/ ]/ 提出/ 来/ 的/ ,/ 后来/ 被/ 很多/ 协议/ [/ 1/ -/ 3/ ,/ 13/ ]/ 使用/ ./ 假设/ 使用/ 前面/ 介绍/ 的/ 基于/ 分解/ 困难性/ 假设/ 的/ 承诺/ 方案/ 来/ 对/ 共享/ / 时/ 的/ 分发/ 向量/ 做/ 承诺/ ./ 这样/ 一般性/ 模求/ 逆/ 协议/ 的/ 公开/ 输入/ 就/ 包括/ C/ ρ/ / ,/ j/ =/ G/ ρ/ / ,/ jH/ ρ/ / ^/ ,/ jmodN/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ ,/ 其中/ ρ/ / ,/ 1/ =/ / ,/ ρ/ / ^/ ,/ 1/ =/ / ^/ ./ 以/ 概括/ 如下/ :/ 有/ 如下/ 公开/ 值/ :/ 在/ 一般性/ 模求/ 逆/ 协议/ 中/ ,/ 参与/ 方面/ 临/ 的/ 问题/ 可以/ 及其/ 它/ 公开/ 输入/ ,/ 例如/ e/ ,/ 犇/ ,/ 狋/ 以及/ 上面/ 介绍/ 的/ C/ ρ/ / ,/ j/ ./ 参与方/ Ρ/ 已知/ 犪/ =/ (/ a1/ ,/ …/ ,/ au/ )/ T/ ,/ α/ ^/ =/ (/ α/ ^/ 1/ ,/ …/ ,/ α/ ^/ u/ )/ T/ ,/ 犫/ =/ (/ b1/ ,/ …/ ,/ bu/ )/ T/ ,/ ^/ 犫/ =/ (/ ^/ b1/ ,/ …/ ,/ ^/ bu/ )/ T/ ,/ 犮/ =/ (/ c1/ ,/ …/ ,/ cu/ )/ T/ ,/ 犮/ ^/ =/ (/ c/ ^/ 1/ ,/ …/ ,/ c/ ^/ u/ )/ T/ ,/ 并/ 公开/ 了/ 一个/ 值/ F/ ,/ 现在/ 需要/ 证明/ F/ =/ 犪/ T/ 犇/ Ρ/ 犫/ +/ e/ 〈/ 狋/ ,/ 犮/ 〉/ ./ 在/ 一般性/ 模求/ 逆/ 协议/ 中/ ,/ 每个/ 参与方/ Pi/ 都/ 要/ 执行/ 上述/ 证明/ 过程/ ,/ 并/ 将/ 犪/ =/ / Pi/ ,/ α/ ^/ =/ / ^/ Pi/ ,/ 犫/ =/ Λ/ i/ ,/ ^/ 犫/ =/ ^/ Λ/ i/ ,/ 犮/ =/ 犚/ i/ ,/ 犮/ ^/ =/ ^/ 犚/ i/ 以及/ 犇/ Ρ/ =/ 犇/ i/ 作为/ 输入/ ./ 为了/ 便于/ 描述/ ,/ 此处/ 没有/ 考虑/ 随机/ 化子/ (/ randomizers/ )/ 犣/ i/ 和/ ^/ 犣/ i/ ./ 该/ 零/ 知识/ 证明/ 是/ 一个/ 统计/ 零/ 知识/ 协议/ ,/ 这/ 是因为/ 犪/ T/ 犇/ Ρ/ 犫/ 是/ O/ (/ N222k/ )/ 的/ ,/ 通过/ 在/ 区间/ [/ 0/ ,/ N323k/ ]/ 中/ 随机/ 选择/ 元素/ ,/ 可以/ 保证/ 在/ 协议/ 中/ 第/ 3/ (/ c/ )/ 步时/ ,/ 证明/ 者/ 的/ 回答/ 与/ 区间/ 内/ 的/ 随机数/ 是/ 统计/ 不可/ 区分/ 的/ ./ 上面/ 介绍/ 了/ VLISS/ 和/ Prove/ -/ Correct/ 协议/ ,/ 并/ 做/ 了/ 简单/ 分析/ 和/ 证明/ ./ 本节/ 最后/ ,/ 给出/ 一般性/ 模求/ 逆/ 协议/ 的/ 安全性/ 证明/ ./ 定理/ 3/ ./ 如果/ 敌手/ 结构/ 是/ Q3/ 的/ ,/ 那么/ 在/ 强/ RSA/ 假设/ 下/ ,/ 图/ 2/ 描述/ 的/ 一般性/ 模求/ 逆/ 协议/ ,/ 在/ 恶意/ 敌手/ 存在/ 的/ 情况/ 下/ 是/ 一个/ 安全/ 的/ 多方/ 模求/ 逆/ 协议/ ./ 证明/ ./ 正确性/ ./ 利用/ VLISS/ 和/ Prove/ -/ Correct/ 两个/ 子/ 协议/ ,/ 可以/ 筛选/ 出/ 一般性/ 模求/ 逆/ 协议/ 中/ 的/ 恶意/ 参与方/ ./ 而且/ 很/ 容易/ 验证/ 一般性/ 模求/ 逆/ 协议/ 能够/ 计算/ 出/ 正确/ 的/ 输出/ ./ 因为/ 是/ Q3/ 的/ ,/ 所以/ 在/ 输出/ 的/ 第一步/ 时/ ,/ 可以/ 找到/ 一个/ A/ =/ A/ ,/ 并且/ A/ 是/ 乘性/ 的/ ,/ 因此/ 可以/ 由/ 所有/ 诚实/ 方/ 的/ 份额/ 犱/ Pi/ (/ Pi/ ∈/ A/ )/ 重构/ 得到/ d/ ./ 保密性/ ./ 在/ 强/ RSA/ 假设/ 下/ ,/ 分解/ N/ 是/ 困难/ 的/ ,/ 因此/ 子/ 协议/ VLISS/ 是/ 一个/ 安全/ 的/ VSS/ ./ 同时/ ,/ 子/ 协议/ Prove/ -/ Correct/ 是/ 一个/ 统计/ 零/ 知识/ 协议/ ./ 因此/ 一般性/ 模求/ 逆/ 协议/ 的/ 保密性/ 大部分/ 可以/ 由/ VLISS/ 的/ 保密性/ 和/ Prove/ -/ Correct/ 的/ 零/ 知识性/ 来/ 保证/ ,/ 其它/ 部分/ 与/ 半/ 诚实/ 敌手/ 模型/ 下/ 的/ 证明/ 类似/ ./ 与/ 半/ 诚实/ 模型/ 不同/ 的/ 是/ 敌手/ 在/ 选择/ λ/ i/ 时/ 可能/ 会/ 超出/ 指定/ 的/ 区间/ [/ 0/ ,/ N2k/ ]/ ./ 但是/ ,/ 正如/ 在/ 注/ 5/ 中/ 所说/ 的/ ,/ 敌手/ 能够/ 通过/ VLISS/ 验证/ 仅当/ λ/ i/ 是/ O/ (/ N22k/ )/ 的/ ,/ 最终/ Λ/ 将/ 是/ O/ (/ N23k/ )/ 的/ ./ 为了/ 补偿/ Λ/ 扩大/ 的/ 范围/ ,/ 有/ 必要/ 增加/ R/ 的/ 取值/ 范围/ 以及/ 共享/ 0/ 时/ 的/ 界/ ,/ 这/ 就是/ 为什么/ 要求/ ri/ 取自/ 区间/ [/ 0/ ,/ N222k/ ]/ 以及/ 共享/ 0/ 时界/ 为/ N323k/ ./ 证毕/ ./ 3.5/ 协议/ 的/ 效率/ 分析/ 为了/ 研究/ 一般/ 敌手/ 结构/ 上/ 多方/ 模求/ 逆/ 协议/ 的/ 存在/ 性/ ,/ 本文/ 并/ 没有/ 花费/ 过多/ 的/ 精力/ 去/ 提高/ 协议/ 的/ 效率/ 和/ 减小/ 运算/ 中/ 整数/ 的/ 大小/ ./ 但/ 相关/ 的/ 协议/ 确实/ 能够/ 更/ 优化/ 一些/ ,/ 运算/ 中/ 的/ 一些/ 整数/ 大小/ 是/ 可以/ 减小/ 的/ ,/ 这/ 一点/ 对于/ 份额/ 犱/ Pi/ 来讲/ 尤为重要/ ,/ 因为/ 在/ 多方/ RSA/ 签名/ 中/ 会/ 使用/ 该/ 份额/ 来/ 做/ 指数/ 运算/ ,/ 显然/ 份额/ 越小/ ,/ 计算/ 起来/ 越/ 方便/ ./ 在/ 半/ 诚实/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ 中/ ,/ 每个/ 份额/ 的/ 大小/ 都/ 限定/ 在/ O/ (/ N223k/ )/ ,/ 而/ 在/ 恶意/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ 中/ ,/ 每个/ 份额/ 的/ 大小/ 都/ 限定/ 在/ O/ (/ N323k/ )/ ./ 根据/ 不同/ 的/ 应用/ 场景/ ,/ 可以/ 选择/ 合适/ 的/ 安全/ 参数/ k/ 和/ RSA/ 模数/ N/ 来/ 减小/ 份额/ 的/ 大小/ ./ 多方/ 模求/ 逆/ 协议/ 是/ Catalano/ 、/ Gennero/ 和/ Hale/ -/ vi/ [/ 4/ ]/ 门限/ 协议/ 的/ 一个/ 推广/ ./ 实际/ 应用/ 时/ ,/ 如果/ 面临/ 的/ Page9/ 是/ 门限/ 敌手/ 结构/ ,/ 可以/ 使用/ Vandermonde/ 矩阵/ 作为/ 分发/ 矩阵/ ,/ 因此/ 相应/ 的/ ISP/ 是/ 乘性/ 的/ (/ 如果/ n/ >/ 2t/ ,/ t/ 为门/ 限值/ )/ 或者/ 强乘性/ 的/ (/ 如果/ n/ >/ 3t/ )/ ./ 因此/ 两个/ 协议/ 拥有/ 相同/ 的/ 效率/ ./ 但/ 多方/ 模/ 协议/ 同样/ 适合/ 其它/ 非/ 门限/ 类型/ 的/ 敌手/ 结构/ ./ 对于/ 其它/ 非/ 门限/ 类型/ 的/ 敌手/ 结构/ ,/ 可以/ 根据/ 计算/ 的/ 一般/ ISP/ 来/ 构造/ 乘性/ 或者/ 强乘性/ 的/ ISP/ ./ Cramer/ 、/ Damgrd/ 和/ Maurer/ [/ 5/ ]/ 证明/ 了/ 对于/ Q2/ 类型/ 的/ 敌手/ 结构/ ,/ 存在/ 有效/ 的/ 算法/ 将/ 计算/ 的/ 一般/ 的/ ISP/ 转化成/ 计算/ 相同/ 敌手/ 结构/ 的/ 乘性/ ISP/ ,/ 而/ 乘性/ ISP/ 的/ 大小/ 仅/ 是/ 原/ ISP/ 大小/ 的/ 两倍/ ./ 然而/ ,/ 如何/ 有效/ 地/ 将/ 计算/ Q3/ 类型/ 的/ 敌手/ 结构/ 的/ 一般性/ ISP/ 转化成/ 计算/ 相同/ 敌手/ 结构/ 的/ 强/ 乘性/ ISP/ 仍然/ 是/ 一个/ 公开/ 难题/ ,/ 但/ Cramer/ 、/ Damgrd/ 和/ Maurer/ [/ 5/ ]/ 给出/ 了/ 的/ 上界/ ./ 因此/ 最终/ 协议/ 运行/ 完/ 之后/ ,/ 每个/ 参与方/ 可能/ 持有/ 多个/ 份额/ ,/ 所有/ 份额/ 的/ 大小/ 将会/ 比/ 门限/ 情况/ 下/ 的/ 份额/ 大小/ 要/ 大/ 一些/ ./ 在/ 两种/ 敌手/ 模型/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ 中/ ,/ 本文/ 都/ 将/ 文献/ [/ 4/ ]/ 中/ 的/ 拉格朗/ 日/ 插值/ 替换/ 为/ 简单/ 的/ 加法/ 运算/ ,/ 只/ 需/ 将/ 所有/ 广播/ 的/ 份额/ 简单/ 加/ 起来/ 即可/ ,/ 因此/ 计算/ 起来/ 会/ 比/ 文献/ [/ 4/ ]/ 略/ 快/ 一些/ ./ 有/ 兴趣/ 的/ 朋友/ 可以/ 尽/ 一步/ 优化/ 和/ 改进/ 上述/ 协议/ ,/ 也/ 欢迎/ 更/ 多/ 的/ 朋友/ 去/ 设计/ 新/ 的/ 高效/ 协议/ 来/ 解决/ 分布式/ 模求/ 逆/ 问题/ ./ 4/ 总结/ 本文/ 构造/ 了/ 两个/ 一般/ 敌手/ 结构/ 下/ 的/ 多方/ 模求/ 逆/ 协议/ :/ 一个/ 是/ 半/ 诚实/ 模型/ 下/ 的/ ,/ 在/ 敌手/ 结构/ 是/ Q2/ 的/ 条件/ 下/ 是/ 安全/ 的/ ;/ 另/ 一个/ 是/ 恶意/ 敌手/ 模型/ 下/ 的/ ,/ 在/ 敌手/ 结构/ 是/ Q3/ 的/ 条件/ 下/ 以及/ 强/ RSA/ 假设/ 下/ 是/ 安全/ 的/ ./ 在/ 协议/ 的/ 构造/ 中/ ,/ 使用/ 了/ 线性/ 整数/ 秘密/ 共享/ 方案/ ,/ 在/ 做/ 环上/ 的/ 运算/ 时/ ,/ 避免/ 了/ 黑箱/ 调用/ ./ 因此/ ,/ 本文/ 构造/ 多方/ 协议/ 的/ 方法/ 对/ 文献/ [/ 6/ ]/ 是/ 一个/ 有力/ 的/ 补充/ ./ 

