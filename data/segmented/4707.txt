Page1/ 面向/ 三维/ 多/ 核片/ 上/ 系统/ 的/ 热/ 感知/ 硅后/ 能耗/ 优化/ 方法/ 1/ )/ (/ 华北电力大学/ 电气/ 与/ 电子/ 工程学院/ 电子/ 与/ 通信/ 工程系/ 河北/ 保定/ 071001/ )/ 2/ )/ (/ 中国科学院计算技术研究所/ 计算机/ 体系结构/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 高/ 能效/ (/ Energyefficiency/ )/ 已/ 成为/ 目前/ 嵌入式/ 多/ 核片/ 上/ 系统/ (/ System/ -/ on/ -/ Chips/ ,/ SoCs/ )/ 设计/ 中/ 的/ 首要/ 优化/ 目标/ ./ 基于/ 电压/ // 频率/ 岛/ 设计/ 的/ 三维/ 多/ 核片/ 上/ 系统/ 能够/ 为/ 构建/ 高/ 能效/ 系统/ 提供/ 一种/ 有力/ 的/ 解决方案/ ./ 然而/ ,/ 不断/ 增加/ 的/ 工艺/ 偏差/ 导致/ 制造/ 后/ 芯片/ 中/ 电压/ // 频率/ 岛/ 的/ 性能参数/ 偏离/ 其/ 额定值/ ./ 在/ 较大/ 偏差/ 的/ 影响/ 下/ ,/ 可能/ 无法/ 满足/ 任务/ 的/ 截止/ 时间/ 约束/ ./ 另外/ ,/ 已有/ 的/ 研究/ 工作/ 大多/ 针对/ 二维/ 平台/ ,/ 无法/ 很/ 好地解决/ 因/ 三维/ 集成/ 而/ 不断/ 恶化/ 的/ 发热/ 问题/ ./ 面向/ 采用/ 电压/ // 频率/ 岛/ 设计/ 的/ 三维/ 多核/ SoC/ ,/ 文中/ 提出/ 一个/ 硅后/ 优化/ 框架/ ,/ 在/ 最小化/ 系统/ 能耗/ 的/ 同时/ ,/ 能够/ 满足/ 任务/ 截止/ 时间/ 和/ 系统/ 热/ 约束/ ./ 除了/ 能效/ 感知/ 的/ 任务调度/ 和/ 电压/ // 频率/ 分派/ 方法/ ,/ 提出/ 的/ 优化/ 框架/ 还/ 采用/ 任务/ 迁移/ 平衡/ 核栈/ 的/ 功耗/ 以/ 实现/ 热/ 优化/ ./ 实验/ 结果表明/ ,/ 与/ 已有/ 的/ 热平衡/ 方法/ 比较/ ,/ 文中/ 提出/ 的/ 方法/ 能/ 减少/ 平均/ 18.6/ %/ 的/ 能耗/ ./ 同时/ ,/ 与/ 经典/ 的/ 能耗/ 优化/ 方法/ 比较/ ,/ 文中/ 提出/ 的/ 方法/ 能/ 降低/ 平均/ 5.6/ 的/ 峰值/ 温度/ ./ 关键词/ 系统/ 能耗/ ;/ 三维/ 多/ 核片/ 上/ 系统/ ;/ 工艺/ 偏差/ ;/ 电压/ // 频率/ 岛/ ;/ 任务调度/ ;/ 热/ 优化/ 1/ 引言/ 集成电路/ 制造/ 工艺/ 的/ 不断进步/ 大大增加/ 了/ 硅片/ 上/ 晶体管/ 的/ 集成/ 密度/ ./ 相应/ 的/ ,/ 嵌入式/ 系统/ 设计/ 开始/ 转向/ 多处理器/ // 多/ 核片/ 上/ 系统/ (/ Multi/ -/ Processor/ // Multi/ -/ coreSystem/ -/ on/ -/ Chip/ ,/ MP/ // Multi/ -/ coreSoC/ )/ ./ 一般来说/ ,/ 多核/ SoC/ 中/ 包含/ 多种/ 处理/ 芯核/ ,/ 例如/ 通用/ 处理器/ 、/ 数字/ 信号处理器/ 、/ 图形/ 处理器/ 和/ 低功耗/ 处理器/ 等/ ./ 通过/ 将/ 不同/ 类型/ 的/ 处理/ 芯核/ 集成/ 到/ 一个/ 硅片/ ,/ 多核/ SoC/ 能够/ 提供/ 完整/ 的/ 系统/ 功能/ ./ 对于/ 不断/ 增加/ 的/ 种类/ 繁多/ 的/ 应用程序/ 而言/ ,/ 多核/ SoC/ 无疑/ 具有/ 广阔/ 的/ 应用/ 前景/ ./ 对于/ 高性能/ 、/ 高端/ 片上/ 系统/ 而言/ ,/ 三维/ 多核/ 结构/ 极具/ 吸引力/ [/ 1/ -/ 2/ ]/ ./ 一方面/ ,/ 三维/ 集成/ 能够/ 克服/ 传统/ 二维/ 芯片/ 上/ 普遍存在/ 的/ 全局/ 互连/ 延迟/ 和/ 功耗/ 瓶颈/ 问题/ ./ 另一方面/ ,/ 多核/ 结构/ 不仅/ 能/ 提高/ 系统/ 吞吐量/ ,/ 还/ 能够/ 提高/ 偏差/ 影响/ 下/ 的/ 系统/ 鲁棒性/ ./ 正是/ 因为/ 结合/ 了/ 上述/ 优点/ ,/ 三维/ 多核/ SoC/ 非常适合/ 用于/ 复杂/ 系统/ 以/ 解决/ 未来/ 种类/ 繁多/ 的/ 应用/ 需求/ ./ 由于/ 嵌入式/ SoC/ 经常/ 采用/ 电池/ 供电/ ,/ 高/ 能效/ 、/ 低能耗/ 就/ 成为/ 一个/ 重要/ 的/ 设计/ 目标/ ./ 近年来/ ,/ 人们/ 向/ 二维/ 多核/ 设计/ 引入/ 电压/ // 频率/ 岛/ (/ Voltage/ // FrequencyIsland/ ,/ VFI/ )/ 以/ 优化/ 系统/ 能效/ [/ 3/ -/ 5/ ]/ ./ VFI/ 是/ 将/ 芯片/ 上/ 的/ 处理/ 芯核/ 划分/ 为/ 不同/ 的/ 电压/ // 频率/ 域/ ./ 每个/ VFI/ 都/ 可以/ 运行/ 在/ 各自/ 最优/ 的/ 电压/ 和/ 频率/ 下/ ./ 通过/ 与/ 任务调度/ 相结合/ ,/ 上述/ 设计/ 方法/ 能够/ 实现/ 细粒度/ 的/ 能耗/ 管理/ 和/ 优化/ ,/ 且/ 满足/ 任务/ 的/ 截止/ 时间/ 约束/ ./ 然而/ ,/ 随着/ 晶体管/ 特征/ 尺寸/ 的/ 不断/ 缩小/ ,/ 芯片/ 制造/ 过程/ 中/ 引入/ 的/ 工艺/ 偏差/ (/ ProcessVariation/ ,/ PV/ )/ 也/ 日益严重/ ,/ 给/ 多/ 核/ SoC/ 设计/ 带来/ 严峻/ 挑战/ [/ 6/ -/ 7/ ]/ ./ 在/ 工艺/ 偏差/ 影响/ 下/ ,/ 制造/ 后/ 的/ SoC/ 芯片/ 上/ 处理/ 芯核/ 的/ 性能参数/ (/ 如/ 频率/ 、/ 功耗/ )/ 常常/ 偏离/ 设计阶段/ 所/ 指定/ 的/ 额定值/ 且/ 应/ 被/ 看作/ 是/ 随机变量/ ./ 因而/ ,/ 对于/ 量产/ SoC/ 芯片/ 而言/ ,/ 处理/ 芯核/ 的/ 性能参数/ 表现/ 为/ 统计/ 分布/ ./ 相应/ 的/ ,/ 多核/ SoC/ 所/ 执行/ 的/ 应用程序/ 的/ 执行/ 时间/ 等/ 参数/ 同样/ 具有/ 了/ 概率/ 特征/ ./ 这种/ 执行/ 时间/ 的/ 不确定性/ 无法/ 保证/ 程序/ 的/ 执行/ 在/ 各种/ 工艺/ 拐点/ (/ processcorner/ )/ 处/ 都/ 能/ 满足/ 系统/ 的/ 实时性/ 约束/ ./ 已有/ 的/ 研究/ 工作/ 通常/ 是/ 在/ 设计阶段/ 对/ VFI/ 进行/ 划分/ ,/ 或者/ 假定/ 芯片/ 具备/ 每核/ VFI/ 的/ 配置/ ./ 然而/ ,/ 随着/ 工艺/ 偏差/ 日益/ 恶化/ ,/ 芯片/ 制造/ 后/ VFI/ 的/ 性能参数/ 可能/ 偏离/ 设计/ 额定值/ ./ 因此/ ,/ 很难/ 保证/ 设计阶段/ 所/ 制定/ 的/ VFI/ 划分/ 方案/ 在/ 硅后/ 仍然/ 是/ 最优/ 解/ ./ 另一方面/ ,/ 对于/ 大规模/ 多核/ 芯片/ 来说/ ,/ 每核/ 电压/ // 频率/ 域/ (/ 即/ 每核/ VFI/ )/ 配置/ 很难/ 实现/ ./ 随着/ 处理/ 芯核/ 数目/ 的/ 增加/ ,/ 每核/ VFI/ 需要/ 更/ 多/ 的/ 片外/ 电压/ 规整/ 器/ (/ regulator/ )/ 或片/ 上/ 电压/ 规整/ 器/ ./ 前者/ 数量/ 的/ 增加/ 会/ 极大地提高/ 封装/ 成本/ ;/ 而/ 后者/ 功率/ 传输/ 效率/ 较/ 低/ [/ 8/ ]/ ./ 由此可见/ ,/ 对于/ 大规模/ 多核/ 芯片/ ,/ 每个/ VFI/ 包含/ 多个/ 处理/ 芯核/ 较为/ 实际/ ./ 再者/ ,/ 与/ 二维/ 芯片/ 相比/ ,/ 面向/ 采用/ 电压/ // 频率/ 岛/ 设计/ 的/ 三维/ 多核/ 芯片/ 进行/ 能耗/ 优化/ 还/ 需要/ 解决/ 一些/ 新/ 的/ 挑战/ ./ 例如/ ,/ 三维/ 集成/ 导致/ 芯片/ 的/ 散热/ 问题/ 日益/ 严峻/ ./ 不断/ 增加/ 的/ 功耗/ 密度/ 恶化/ 了/ 热斑/ (/ hotspot/ )/ ,/ 同时/ 在/ 芯片/ 上/ 产生/ 高温/ [/ 9/ ]/ ./ 工作/ 负载/ 的/ 异质性/ (/ heterogeneous/ )/ 则/ 会/ 在/ 处理/ 芯核间/ 造成/ 功耗/ 偏差/ ,/ 导致/ 芯片/ 上/ 出现/ 热梯度/ (/ thermalgradient/ )/ ./ 高温/ 和/ 热梯度/ 不仅/ 会/ 降低/ 系统/ 性能/ 和/ 可靠性/ ,/ 而且/ 将会/ 抵消/ 优化/ 系统/ 能耗/ 的/ 努力/ ./ 为了/ 解决/ 上述/ 问题/ ,/ 面向/ 采用/ VFI/ 设计/ 的/ 三维/ 多核/ SoC/ ,/ 本文/ 提出/ 一个/ 硅后/ 优化/ 框架/ ,/ 在/ 最小化/ 系统/ 能耗/ 的/ 同时/ ,/ 满足/ 任务/ 截止/ 时间/ 和/ 系统/ 热/ 约束/ ./ 首先/ ,/ 根据/ 硅前/ 确定/ 的/ VFI/ 划分/ 方案/ 以及/ 工艺/ 偏差/ 造成/ 的/ 性能参数/ 偏差/ ,/ 提出/ 能效/ 感知/ 的/ 任务调度/ 算法/ ./ 该/ 算法/ 统一/ 考虑/ 后续/ 的/ 电压/ // 频率/ 分派/ 以/ 最小化/ 任务/ 的/ 执行/ 能耗/ ./ 随后/ ,/ 提出/ 任务/ 迁移/ 算法/ ,/ 在/ 任务/ 图/ 的/ 执行/ 过程/ 中/ 实现/ 核栈/ 间/ 的/ 功耗/ 平衡/ ,/ 降低/ 芯片/ 温度/ ./ 实验/ 结果表明/ ,/ 与/ 已有/ 的/ 热平衡/ 方法/ 比较/ ,/ 本文/ 提出/ 的/ 方法/ 能/ 减少/ 平均/ 18.6/ %/ 的/ 能耗/ ./ 同时/ ,/ 与/ 经典/ 的/ 能耗/ 优化/ 方法/ 比较/ ,/ 本文/ 提出/ 的/ 方法/ 能/ 降低/ 平均/ 5.6/ 的/ 峰值/ 温度/ ./ 2/ 相关/ 研究/ 现状/ 面向/ 采用/ VFI/ 设计/ 的/ 多/ 核/ 芯片/ 优化/ 能耗/ 方面/ ,/ Ogras/ 等/ 人/ [/ 10/ ]/ 提出/ 了/ VFI/ 划分/ 与/ 静态/ 电压/ // 频率/ 分派/ 的/ 混合/ 方法/ 优化/ 二维/ NoC/ 的/ 系统/ 能耗/ ./ 他们/ 首先/ 将/ 每个/ 处理/ 芯核/ 看成/ 是/ 单独/ 的/ VFI/ ,/ 按照/ 任务调度/ 的/ 结果/ 确定/ 每个/ 处理/ 芯核/ 的/ 最低/ 操作/ 电压/ ./ 随后/ 将/ 处理/ 芯核/ 进行/ 合并/ 以/ 形成/ 新/ 的/ VFI/ ./ VFI/ 的/ 数目/ 取决于/ 系统/ 设计/ 约束/ ./ 考虑/ 通信/ 能耗/ ,/ 文献/ [/ 11/ -/ 12/ ]/ 提出/ 了/ 电压/ 调节/ 和/ 任务调度/ 算法/ 相结合/ 的/ 方法/ 优化/ 二维/ 多核/ 芯片/ 的/ 能耗/ ./ 其中/ ,/ 文献/ [/ 11/ ]/ 整体/ 考虑/ 任务/ 的/ 执行/ 能耗/ 和/ 通信/ 能耗/ ,/ 提出/ 了/ 有效/ 的/ 启发式/ 算法/ 进行/ 任务/ 的/ 调度/ ./ 文献/ [/ 12/ ]/ 则/ 将/ 任务调度/ 完成/ 后/ 的/ 处理/ 芯核/ 电压/ 分派/ 模型/ 化/ 整数/ 线性规划/ 问题/ 进行/ 求解/ ./ 面向/ 二维/ NoC/ ,/ Jang/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ VFI/ 感知/ 的/ 能/ Page3/ 耗/ 优化/ 框架/ ,/ 通过/ 在/ 设计阶段/ 确定/ 最优/ 的/ 处理/ 芯核/ 映射/ 以及/ 路由/ 算法/ 来/ 优化/ 系统/ 能耗/ ./ 假定/ 多核/ 芯片/ 具有/ 每核/ 电压/ // 频率/ 域/ 的/ 配置/ ,/ Zhang/ 等/ 人/ [/ 14/ ]/ 提出/ 了/ 动态/ 电压/ // 频率/ 调节/ 和/ 任务调度/ 相结合/ 的/ 方法/ 优化/ 系统/ 能耗/ ./ 然而/ ,/ 他们/ 的/ 方法/ 不/ 适合/ 大规模/ 多核/ 芯片/ ./ 另外/ ,/ 由于/ 热/ 特性/ 的/ 差异/ ,/ 上述/ 文献/ 提出/ 的/ 方法/ 无法/ 直接/ 应用/ 于/ 三维/ 芯片/ ./ 面向/ 三维/ 多核/ 芯片/ ,/ Cheng/ 等/ 人/ [/ 15/ ]/ 提出/ 了/ 考虑/ 热/ 约束/ 的/ 任务分配/ 和/ 调度/ 算法/ 优化/ 通信/ 能耗/ ./ 然而/ ,/ 他们/ 的/ 工作/ 忽略/ 了/ 计算/ 能耗/ 的/ 优化/ ./ 在/ 三维/ 芯片/ 的/ 热/ 优化/ 方面/ ,/ 也/ 有/ 许多/ 有/ 价值/ 的/ 研究/ 工作/ ./ 硬件/ 方面/ ,/ Goplen/ 等/ 人/ [/ 16/ ]/ 提出/ 插入/ 热过/ 孔来/ 加速/ 三维/ 芯片/ 的/ 散热/ ./ 针对/ 三维/ 芯片/ 特定/ 的/ 面积/ ,/ 他们/ 借助/ 表面/ 元素/ 分析/ 迭代/ 计算/ 热过/ 孔/ 的/ 插入/ 位置/ 以及/ 调整/ 热传导/ 性/ ,/ 从而/ 有效/ 地/ 降低/ 芯片/ 温度/ ./ Wong/ 等/ 人/ [/ 17/ ]/ 提出/ 温度/ 感知/ 的/ 热过/ 孔/ 布局/ 方法/ 来/ 降低/ 芯片/ 温度/ ./ 基于/ 随机/ 行走/ 算法/ ,/ 他们/ 构建/ 了/ 一个/ 新/ 的/ 热/ 分析/ 模块/ ,/ 而/ 热/ 分析/ 的/ 结果/ 则/ 被/ 用来/ 指导/ 确定/ 热过/ 孔/ 的/ 插入/ 位置/ ./ Bakir/ 等/ 人/ [/ 18/ ]/ 提出/ 采用/ 流体/ 冷却/ 方法/ 帮助/ 三维/ 芯片/ 散热/ ./ 他们/ 的/ 方法/ 集成/ 了/ 电气/ 、/ 光和微/ 流体/ 互连/ ./ 软件/ 方面/ ,/ 文献/ [/ 19/ ]/ 提出/ 动态/ 热/ 管理/ 技术/ 处理程序/ 运行/ 时/ 的/ 热/ 紧急/ (/ thermalemergency/ )/ 情况/ ./ 他们/ 提出/ Adapt3D/ 算法/ ,/ 通过/ 考虑/ 处理/ 芯核/ 的/ 热/ 历史/ 信息/ 以及/ 三维/ 芯片/ 特性/ 来/ 平衡/ 芯片/ 温度/ ./ Zhou/ 等/ 人/ [/ 20/ ]/ 提出/ 均衡/ 线程/ 分配/ 算法/ ,/ 通过/ 图/ 1/ 目标/ 平台/ 和/ 目标/ 应用/ 示意图/ 目标/ 应用/ 为/ 具有/ 高/ 确定性/ 的/ 通信/ 任务/ 图/ ./ 如图/ 1/ (/ b/ )/ 所示/ ,/ 通信/ 任务/ 图/ 表现/ 为/ 有/ 向/ 非/ 循环/ 图/ ./ 图中/ ,/ 顶点/ 表示/ 任务/ ./ 很多/ 工业/ 级/ 基准/ 任务/ 图中/ 都/ 给出/ 了/ 每个/ 任务/ 在/ 不同/ 类型/ 处理/ 芯核/ 上/ 执行/ 的/ 功耗/ 和/ 延迟/ ./ 图中/ 有/ 方向/ 的/ 边/ 则/ 表示/ 任务/ 间/ 的/ 控制/ 和/ 数据/ 依赖/ 关系/ ./ 即/ 某/ 一/ 任务/ 必须/ 在/ 其/ 所有/ 前继/ 任务/ 执行/ 完成/ 且/ 完成/ 数据通信/ 后/ 才能/ 开始/ 执行/ ./ 有/ 向/ 边上/ 标示/ 的/ 数字/ 表示/ 任务/ 间/ 的/ 通信量/ ./ 一般/ 情况/ 下/ ,/ 每/ 一个/ 叶/ 节点/ 处均/ 会/ 有/ 一个/ 截止/ 时间/ 约束/ (/ 如图/ 1/ (/ b/ )/ 中/ 的/ Td/ (/ 3/ )/ 和/ 考虑/ 线程/ 间/ 的/ 热/ 差异/ 进行/ 线程/ 分组/ 并/ 调度/ 到/ 核栈/ 上/ ,/ 以/ 实现/ 三维/ 多核/ 芯片/ 的/ 热/ 均衡/ ./ Zhu/ 等/ 人/ [/ 21/ ]/ 提出/ 结合/ 任务调度/ 和/ 电压/ 调节/ 实现/ 三维/ 多处理器/ SoC/ 的/ 热/ 优化/ ./ 通过/ 考虑/ 工作/ 负载/ 和/ 异构/ 处理/ 芯核/ 本身/ 的/ 热/ 差异/ ,/ 提出/ 了/ 操作系统/ 级/ 的/ 动态/ 热/ 管理/ 技术/ ./ 然而/ ,/ 上述/ 研究/ 工作/ 均/ 只/ 关注/ 热/ 优化/ ,/ 忽略/ 了/ 系统/ 能耗/ 的/ 优化/ ./ 3/ 背景/ 知识/ 介绍/ 3.1/ 目标/ 平台/ 和/ 应用/ 参考/ 商用/ 多核/ 处理器/ 以及/ 目前/ 对于/ 三维/ 多核/ 芯片/ 的/ 研究/ 工作/ ,/ 本文/ 中/ 的/ 目标/ 平台/ 定义/ 如下/ ./ 如图/ 1/ (/ a/ )/ 所示/ ,/ 目标/ 平台/ 为/ 三维/ 同构/ 多核/ SoC/ ./ 平台/ 包含/ 多个/ 处理/ 芯核层/ [/ 1/ ,/ 22/ ]/ ./ 每/ 一层/ 采用/ 格状/ (/ tile/ )/ 结构/ ,/ 每个/ 格内/ 包含/ 一个/ 集成/ 私有/ 高速缓冲存储器/ (/ Cache/ )/ 的/ 处理/ 芯核/ 以及/ 一个/ 路由器/ [/ 5/ ]/ ./ 采用/ 片上/ 网络/ (/ Network/ -/ on/ -/ Chip/ ,/ NoC/ )/ 实现/ 格/ 间通信/ ./ 同/ 一层/ NoC/ 为/ 网状/ (/ mesh/ )/ 结构/ ;/ 层/ 间通信/ 通过/ 硅/ 通孔/ (/ ThroughSiliconVia/ ,/ TSV/ )/ 总线/ 实现/ ./ 本文/ 假定/ 处理/ 芯核/ 可以/ 工作/ 在/ 几个/ 不同/ 的/ 离散/ 电压/ // 频率/ 范围/ 内/ ./ VFI/ 由片/ 外/ 电压/ 规整/ 器/ 支持/ ./ 每个/ 电压/ 规整/ 器/ 支持/ 一个/ VFI/ 的/ 电压/ 域/ ./ 每个/ 处理/ 芯核/ 假定/ 拥有/ 自己/ 的/ 数字/ 锁相环/ (/ DLL/ )/ 部件/ 以/ 实现/ 独立/ 的/ 频率/ 域/ ./ 不同/ VFI/ 间/ 的/ 数据/ 同步/ 由/ VFI/ 边界/ 处/ 的/ 混合/ 电压/ // 频率/ 先入/ 先出/ (/ FIFO/ )/ 缓存/ 支持/ ./ Td/ (/ 5/ )/ )/ ./ 表示/ 这一/ 任务/ 通路/ (/ 由/ 多个/ 任务/ 串联/ 组成/ ,/ 一般/ 由/ 初始/ 任务/ 节点/ 开始/ 到/ 某/ 一叶/ 节点/ 任务/ 结束/ )/ 所/ 规定/ 的/ 最晚/ 完成/ 时间/ ./ 3.2/ 能耗/ 模型/ 根据上述/ 对/ 目标/ 平台/ 和/ 目标/ 应用/ 的/ 描述/ ,/ 可以/ 将/ 系统/ 能耗/ Esys/ 表示/ 为/ 计算/ 能耗/ 与/ 通信/ 能耗/ 之/ 和/ :/ 式/ (/ 1/ )/ 中/ ,/ Ecomp/ 和/ Ecomm/ 分别/ 表示/ 计算/ 和/ 通信/ 能耗/ ./ 计算/ 能耗/ 主要/ 源自/ 任务/ 在/ 处理/ 芯核/ 上/ 的/ 执行/ ./ Page4/ 对于/ 包含/ n/ 个/ 处理/ 芯核/ 的/ 芯片/ ,/ Ecomp/ 可以/ 表示/ 为式/ (/ 2/ )/ 中/ ,/ NCj/ 表示/ 任务/ 的/ 执行/ 周期/ 数/ ,/ Ci/ 表示/ 核/ i/ 每/ 周期/ 的/ 平均/ 开关/ 电容/ ,/ Vi/ 表示/ 核/ i/ 的/ 操作/ 电压/ ./ 为了/ 计算/ 总/ 的/ 通信/ 能耗/ ,/ 参考文献/ [/ 10/ ,/ 15/ ]/ ,/ 首先/ 定义/ 由核/ i/ 到/ 核/ j/ 传输/ 一位/ 所/ 消耗/ 的/ 位/ 能耗/ :/ Ebit/ =/ ∑/ 式/ (/ 3/ )/ 中/ ,/ ER/ 连线/ 消耗/ 的/ 位/ 能耗/ ,/ EFIFO/ 消耗/ 的/ 位/ 能耗/ ,/ nV/ 表示/ 根据/ 路由/ 算法/ 得到/ 的/ 核/ i/ 到/ 核/ j/ 的/ 跳数/ (/ hop/ )/ ,/ Vi/ 表示/ VFIi/ 的/ 工作电压/ ./ 根据/ 计算/ 所得/ 的/ 位/ 能耗/ ,/ 包含/ m/ 个/ 通信/ 事务/ 的/ 任务/ 图/ 总/ 的/ 通信/ 能耗/ 可以/ 表示/ 为/ 其中/ ,/ Qk/ 表示/ 核/ i/ 与/ 核/ j/ 之间/ 通信/ 事务/ k/ 的/ 数据通信/ 量/ ./ 3.3/ 延迟/ 模型/ 基于/ 任务/ j/ 的/ 执行/ 周期/ NCj/ ,/ 该/ 任务/ 在/ 操作/ 频率/ 为/ fi/ 的/ 核/ i/ 上/ 的/ 执行/ 时间/ 可以/ 表示/ 为/ 对于/ 通信/ 事务/ k/ ,/ 通信/ 延迟/ 表示/ 为式/ (/ 6/ )/ 中/ ,/ NCR/ 表示/ 一个/ 位片/ (/ flit/ )/ 经过/ 一个/ 路由器/ 及/ 外部/ 互连/ 所/ 需/ 的/ 时钟/ 周期/ 数/ ,/ NCFIFO/ 表示/ 位片/ 经过/ 混合/ 电压/ // 频率/ FIFO/ 所需/ 时钟/ 周期/ 数/ ,/ W/ 为/ 系统/ 带宽/ ./ 很/ 明显/ ,/ 式/ (/ 6/ )/ 中/ 的/ 前/ 两项/ 表示/ 头片/ (/ headerflit/ )/ 的/ 传输/ 延迟/ ./ 最后/ 一项/ 表示/ 数据/ 串行化/ 延迟/ ./ 3.4/ 热/ 模型/ 图/ 2/ 给出/ 了/ 三维/ 多核/ 芯片/ 的/ 热/ 模型/ 示意图/ [/ 23/ ]/ ./ 该/ 模型/ 将/ 芯片/ 面积/ 划分/ 为/ 网格/ ./ 每个/ 格/ 对应/ 一个/ 热/ 模型/ 元素/ ,/ 包含/ 热电阻/ 、/ 热/ 电容/ 和/ 一个/ 电流/ 源/ ./ 格内/ 的/ 温度/ 假定/ 为/ 均匀/ 的/ ./ 这种/ 细粒度/ 的/ 格状/ 热/ 模型/ 可以/ 很/ 容易/ 地/ 与/ HotSpot/ [/ 24/ ]/ 软件/ 进行/ 结合/ 以/ 计算/ 芯片/ 温度/ ./ 参照/ 此热/ 模型/ 图/ ,/ 核/ 2/ 和/ 核/ 3/ 的/ 温度/ 可以/ 计算/ 如下/ :/ 式/ (/ 7/ )/ 中/ ,/ P2/ 和/ P3/ 表示/ 核/ 2/ 和/ 核/ 3/ 的/ 功耗/ ,/ Rinter/ 表示/ 垂直/ 方向/ 上核/ 2/ 与/ 核/ 3/ 之间/ 的/ 热电阻/ ,/ Rhs/ 表示/ 处理/ 芯核/ 与/ 周围/ 材料/ 之间/ 的/ 热电阻/ ,/ Tamb/ 表示/ 周围/ 环境温度/ ./ 由式/ (/ 7/ )/ 可以/ 看出/ ,/ 假定/ 热电阻/ 参数/ 为/ 常量/ 的/ 情况/ 下/ ,/ 处理/ 芯核/ 执行程序/ 时/ 的/ 温度/ 主要/ 取决于/ 它/ 的/ 功耗/ ./ 另外/ ,/ 如/ 文献/ [/ 23/ ]/ 所示/ ,/ 不同/ 层/ 的/ 处于/ 垂直/ 方向/ 的/ 处理/ 芯核/ 之间/ 有着/ 较强/ 的/ 热/ 相关/ (/ Rintra/ / 16Rinter/ )/ ./ 由此可见/ ,/ 在/ 垂直/ 方向/ 的/ 核栈/ 间/ 保持/ 功耗/ 平衡/ 能够/ 有效/ 地/ 平衡/ 芯片/ 的/ 温度/ ./ 3.5/ 统计/ 偏差/ 模拟/ 出于/ 实验/ 的/ 需求/ ,/ 我们/ 借助/ 统计/ 偏差/ 模拟/ 分析/ 和/ 计算/ 参数/ 偏差/ 影响/ 下/ 三维/ 多核/ SoC/ 中/ 处理/ 芯核/ 的/ 频率/ 和/ 功耗/ 分布/ 以及/ 分布/ 的/ 相关性/ 信息/ ./ 偏差/ 模拟/ 首先/ 从/ 模型/ 化/ 晶体管/ 一些/ 典型/ 物理/ 参数/ (/ 如/ 沟道/ 长度/ 和/ 阈值电压/ )/ 的/ 偏差/ 开始/ ./ 在/ 模拟/ 中/ ,/ 片间/ 随机性/ 偏差/ 、/ 片内/ 随机性/ 和/ 具有/ 空间/ 相关性/ 的/ 系统性/ 偏差/ 全部/ 予以考虑/ ./ 其中/ ,/ 同/ 一层/ 的/ 硅片/ 里/ 器件/ 的/ 参数/ 偏差/ 主要/ 取决于/ 片内/ 偏差/ ./ 由于/ 三维/ 芯片/ 不同/ 层/ 的/ 硅片/ 一般/ 来自/ 于/ 不同/ 的/ 晶圆/ (/ wafer/ )/ ./ 因此/ ,/ 模拟/ 中/ ,/ 不同/ 层/ 的/ 硅片/ 间/ 的/ 片间/ 偏差/ 假定/ 为/ 独立/ 的/ ./ 按照/ 上述/ 约定/ ,/ 某/ 一层/ 硅片/ 中/ 晶体管/ 的/ 某/ 一/ 参数/ 的/ 偏差/ 可以/ 表示/ 为式/ (/ 8/ )/ 中/ ,/ Δ/ Pinter/ 表示/ 片间/ 随机性/ 偏差/ ,/ Δ/ Psys/ 表示/ 片内/ 系统性/ 偏差/ ,/ Δ/ Pran/ 表示/ 片内/ 随机性/ 偏差/ ./ 模拟/ 中/ ,/ 首先/ 按照/ 多核/ 芯片/ 的/ 版图/ ,/ 将/ 整个/ 硅片/ 面积/ 划分/ 成/ 许多/ 相等/ 尺寸/ 的/ 网格/ (/ grid/ )/ ./ 在/ 每/ 一个/ 格内/ ,/ 均/ 包含/ 唯一/ 一个/ 表示/ 片间/ 随机性/ 偏差/ 、/ 片内/ 系统性/ 和/ 随机性/ 偏差/ 的/ 随机变量/ ./ 随机变量/ 假定/ 服从/ 标准/ 正态分布/ ./ 同时/ ,/ 我们/ 采用/ 文献/ [/ 25/ ]/ 提出/ 的/ VARIUS/ 模型/ 来/ 刻画/ 片内/ 系统性/ 偏差/ 分布/ 的/ 空间/ 相关性/ ./ 根据/ VARIUS/ 模型/ ,/ 任意/ 两个/ 网格/ 内片/ 内/ 系统性/ 偏差/ 分布/ 的/ 空间/ 相关性/ 可以/ 表示/ 为/ Page5/ 式/ (/ 9/ )/ 中/ ,/ φ/ 表示/ 任意/ 两个/ 网格/ 内/ 器件/ 的/ 参数/ 分布/ 相关性/ 变为/ 零/ 的/ 物理/ 距离/ 范围/ ,/ r/ 表示/ 两个/ 网格/ 的/ 物理/ 距离/ ,/ ρ/ (/ r/ )/ ∈/ [/ 0/ ,/ 1/ ]/ ,/ 表示/ 空间/ 相关性/ 的/ 程度/ ,/ ρ/ (/ r/ )/ 取值/ 越/ 接近/ 于/ 1/ ,/ 表示/ 参数/ 分布/ 的/ 空间/ 相关性/ 也/ 就/ 越/ 大/ ./ 反之/ ,/ 越/ 接近/ 于/ 0/ ,/ 则/ 表示/ 参数/ 的/ 分布/ 相关性/ 越小/ ,/ 更/ 适合/ 表现/ 为/ 独立/ 分布/ ./ 基于/ 上述/ 的/ 偏差/ 模型/ ,/ 我们/ 采用/ 蒙特卡洛/ 模拟/ 来/ 获取/ 晶体管/ 沟道/ 长度/ 和/ 阈值电压/ 的/ 统计/ 分布/ 数据/ ./ 随后/ ,/ 将/ 参数/ 的/ 偏差/ 分布/ 数据/ 送入/ 关键/ 通路/ 模型/ [/ 7/ ,/ 25/ ]/ 以/ 获取/ 不同/ 类型/ 处理/ 芯核/ 的/ 频率/ 和/ 功耗/ 分布/ 信息/ ./ 关键/ 通路/ 模型/ 以/ 四扇/ 出/ 标准/ 与非门/ 为/ 基本/ 逻辑/ 单元/ ,/ 借助/ HSPICE/ 电路仿真/ 确定/ 不同/ 工艺/ 节点/ 下/ ,/ 不同/ 类型/ 的/ 处理/ 芯核/ 所/ 对应/ 的/ 逻辑/ 门/ 的/ 级数/ ./ 一个/ 处理/ 芯核/ 内/ 所/ 包含/ 的/ 关键/ 通路/ 数目/ 则/ 可以/ 将/ 处理/ 芯核/ 的/ 版图/ 面积/ 除以/ 具有/ 高度/ 相关性/ 的/ 单位/ 面积/ (/ 如/ 文献/ [/ 25/ ]/ 建议/ 采用/ 0.02/ mm2/ )/ 获得/ ./ 图/ 3/ 提出/ 的/ 优化/ 框架/ 示意图/ 4.1/ 能效/ 感知/ 的/ 任务调度/ 面向/ 多核/ 平台/ ,/ 以/ 优化/ 能耗/ 为/ 目的/ 的/ 任务调度/ 已/ 被/ 证明/ 为/ NP/ 困难/ 问题/ [/ 11/ ]/ ./ 为了/ 有效/ 地/ 优化/ 能耗/ ,/ 必须/ 统一/ 考虑/ 任务调度/ 与/ 接下来/ 的/ 处理/ 芯核/ 电压/ // 频率/ 分派/ ./ 即/ 任务调度/ 算法/ 必须/ 为/ 后续/ 的/ 电压/ // 频率/ 调节/ 保留/ 尽可能/ 多/ 的/ 优化/ 空间/ ./ 为了/ 实现/ 上述/ 目的/ ,/ 本文/ 采用/ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ 实现/ 任务调度/ 与/ 电压/ // 频率/ 调节/ 的/ 有机/ 统一/ ./ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ 表示/ 为了/ 最小化/ 任务/ 执行/ 能耗/ 且/ 同时/ 满足/ 截止/ 时间/ 约束/ ,/ 执行/ 任务/ 的/ 处理/ 芯核/ 运行/ 时/ 所/ 需/ 的/ 最低/ 电压/ 和/ 频率/ ./ 本文/ 提出/ 的/ 任务调度/ 算法/ 将/ 具有/ 相同/ 最低/ 操作/ 电压/ // 频率/ 的/ 任务/ 尽量/ 分配/ 到/ 同一个/ 处理/ 芯核/ 上/ ./ 这种/ 调度/ 策略/ 可以/ 保证/ 处理/ 芯核/ 采用/ 所/ 调度/ 的/ 任务/ 的/ 最低/ 电压/ 和/ 频率/ 运行/ ,/ 从而/ 为/ 后续/ 的/ 电压/ // 频率/ 调整/ 保留/ 最大/ 的/ 优化/ 空间/ ./ 算法/ 1/ 为/ 所/ 提出/ 的/ 任务调度/ 算法/ 的/ 伪/ 代码/ ./ 4/ 优化/ 框架图/ 3/ 给出/ 了/ 本文/ 提出/ 的/ 优化/ 框架/ 的/ 示意图/ ./ 如图所示/ ,/ 面向/ 已/ 完成/ VFI/ 划分/ 的/ 三维/ 多核/ 平台/ ,/ 首先/ 采用/ 能效/ 感知/ 的/ 任务调度/ 算法/ 将/ 任务分配/ 到/ 处理/ 芯核/ 上/ ./ 与/ 已有/ 的/ 研究/ 工作/ 不同/ ,/ 本文/ 提出/ 的/ 任务调度/ 算法/ 在/ 调度/ 任务/ 时即/ 考虑/ 为/ 后继/ 的/ 处理/ 芯核/ 电压/ // 频率/ 分派/ 保留/ 优化/ 空间/ ./ 因此/ ,/ 在/ 算法/ 中/ 采用/ 任务/ 的/ 最低/ 操作/ 电压/ 和/ 频率/ 作为/ 指导/ 参数/ 对/ 任务调度/ 和/ 电压/ // 频率/ 分派/ 进行/ 统一/ ./ 同时/ ,/ 任务调度/ 后/ ,/ 任务/ 图/ 的/ 整个/ 执行/ 时间/ 被/ 划分/ 为/ 许多/ 连续/ 的/ 时间/ 片段/ ./ 以/ 这些/ 时间/ 片段/ 为/ 参考/ ,/ 任务/ 迁移/ 算法/ 在/ 处理/ 芯核间/ 迁移/ 或/ 交换/ 少量/ 已/ 调度/ 的/ 任务/ ,/ 在/ 整个/ 任务/ 图/ 执行/ 期间/ 实现/ 核栈/ 的/ 功耗/ 平衡/ ./ 与/ 已有/ 的/ 在线/ 任务/ 迁移/ 方法/ 不同/ ,/ 本文/ 提出/ 的/ 任务/ 迁移/ 同样/ 是/ 在/ 设计阶段/ ,/ 即/ 任务/ 实际/ 开始/ 执行/ 前/ 完成/ 的/ ./ 这样/ 就/ 避免/ 了/ 在线/ 任务/ 迁移/ 所/ 引入/ 的/ 性能/ 和/ 硬件/ 方面/ 的/ 开销/ ./ 算法/ 1/ ./ 能效/ 感知/ 的/ 任务调度/ 算法/ ./ 输入/ :/ 任务/ 图/ ,/ 可用/ 离散/ 的/ 电压/ // 频率/ 范围/ 输出/ :/ 任务调度/ 结果/ ,/ 执行/ 时间/ 序列/ (/ ETS/ )/ 预处理/ 步骤/ :/ 1/ ./ 额定/ 电压/ // 频率/ 下/ ,/ 为/ 每个/ 任务/ 计算/ Ecomp/ ;/ 2/ ./ 为/ 任务/ 图中/ 每条/ 任务/ 通路/ 计算/ 总/ 的/ slack/ 和/ Ecomp/ ;/ 3/ ./ FOR/ 每个/ 任务/ Ti4/ ./ FORTi/ 所在/ 的/ 每条/ 通路/ Pj5/ ./ Tslack/ (/ i/ ,/ j/ )/ =/ [/ Ti/ _/ Ecomp/ // Pj/ _/ Ecomp/ ]/ ×/ Pj/ _/ slack/ ;/ 6/ ./ Ti/ _/ slack/ =/ min/ (/ Tslack/ (/ i/ ,/ j/ )/ )/ ;/ // // 若/ 某个/ 任务/ 处于/ 多条/ 7/ ./ 记录/ Ti/ _/ start/ ,/ Ti/ _/ finish/ ,/ Ti/ _/ deadline/ ;/ // // 计算/ 任务/ 开始/ 执/ 8/ ./ FOR/ 每个/ 任务/ 9/ ./ 计算/ 任务/ 的/ 最低/ 操作/ 电压/ 及/ 剩余/ slack/ ;/ 任务调度/ :/ // / FTL/ :/ 全/ 任务/ 列表/ ,/ RTL/ :/ 就绪/ 任务/ 列表/ ,/ rt/ :/ 就绪/ 任/ Page6/ 务/ ,/ ACL/ :/ 可用/ 处理/ 芯核/ 列表/ ,/ ac/ :/ 可用/ 处理/ 芯核/ ,/ STL/ :/ 调度/ 时间/ 列表/ ,/ st/ :/ 调度/ 时间/ 点/ / // 10/ ./ WHILE/ (/ !/ FTL/ ./ IsEmpty/ (/ )/ )/ {/ // // 全/ 任务/ 列表/ 不空/ ,/ 表/ 11/ ./ st/ =/ STL/ ./ GetHead/ (/ )/ ;/ // // 获得/ 当前/ 调度/ 时间/ 节点/ 12/ ./ RTL/ ./ Add/ (/ 当前/ st/ 下/ rts/ )/ ;/ ACL/ ./ Add/ (/ 当前/ st/ 下/ acs/ )/ ;/ 13/ ./ WHILE/ (/ !/ RTL/ ./ IsEmpty/ (/ )/ )/ {/ // // 当前/ 就绪/ 任务/ 列/ 14/ ./ rt/ =/ RTL/ ./ GetHead/ (/ )/ ;/ // // 取出/ 就绪/ 任务/ 列表/ 中/ 第/ 15/ ./ IFACL/ 中/ 所有/ ac/ 不/ 具备/ 与/ rt/ 相匹配/ 的/ 最低/ 电压/ 16/ ./ 将/ rt/ 调度/ 到/ 空闲/ 的/ ac/ ,/ 标记/ ac/ ./ V/ // F/ 为/ rt/ ./ V/ // F/ ;/ 17/ ./ ELSE18/ ./ 将/ rt/ 调度/ 到/ 具有/ 最大/ 通信量/ 的/ 匹配/ ac/ ;/ 19/ ./ STL/ ./ Add/ (/ rt/ ./ deadline/ )/ ;/ STL/ ./ Del/ (/ st/ )/ ;/ 20/ ./ 根据/ 任务调度/ 结果/ 生成/ ETS/ ;/ // // 对齐/ 任务/ 执行/ 时间/ ,/ 算法/ 首先/ 执行/ 预处理/ 步骤/ ./ 这一/ 步骤/ 首先/ 为/ 每个/ 任务分配/ 执行/ 时间/ 余量/ (/ slack/ )/ 以及/ 计算/ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ ./ 在/ 我们/ 提出/ 的/ 算法/ 中/ ,/ 任务/ 的/ 执行/ 能耗/ 越大/ ,/ 所/ 分配/ 的/ 执行/ 时间/ 余量/ 越多/ ./ 为/ 高能耗/ 任务分配/ 较/ 多/ 的/ 执行/ 时间/ 余量/ 能够/ 提供/ 更大/ 的/ 电压/ // 频率/ 调节/ 空间/ ,/ 从而/ 更/ 大程度/ 地/ 降低/ 执行/ 能耗/ ./ 任务/ 执行/ 时间/ 余量/ 的/ 分配/ 过程/ 如下/ ./ 首先/ ,/ 计算/ 每个/ 任务/ 在/ 额定/ 电压/ // 频率/ 下/ 的/ 执行/ 能耗/ (/ 行/ #/ 1/ )/ ,/ 即该/ 任务/ 在/ 额定/ 电压/ // 频率/ 下/ 的/ 功耗/ 和/ 执行/ 时间/ 的/ 乘积/ ./ 同样/ ,/ 为/ 任务/ 图中/ 每/ 一条/ 任务/ 通路/ (/ 任务/ 串联/ 组成/ 的/ 通路/ ,/ 由/ 任务/ 图中/ 某/ 一个/ 初始/ 任务/ 节点/ 开始/ 一直/ 到/ 某/ 一个/ 叶/ 节点/ 结束/ )/ 计算/ 总/ 执行/ 能耗/ 和/ 总/ 执行/ 时间/ 余量/ (/ 行/ #/ 2/ )/ ./ 其中/ ,/ 任务/ 通路/ 的/ 总/ 能耗/ 等于/ 该/ 通路/ 上/ 所有/ 任务/ 计算/ 能耗/ 之/ 和/ ;/ 而/ 任务/ 通路/ 的/ 总/ 执行/ 时间/ 余量/ 可/ 表示/ 为/ 该条/ 通路/ 叶/ 节点/ 上/ 的/ 截止/ 时间/ 约束/ 与/ 通路/ 上/ 所有/ 任务/ 额定/ 执行/ 时间/ 总和/ 之间/ 的/ 差值/ ./ 可用/ 如下/ 公式/ 表示/ :/ 式/ (/ 10/ )/ 中/ ,/ Pi/ _/ slack/ 表示/ 任务/ 通路/ i/ 总/ 的/ 执行/ 时间/ 余量/ ,/ Pi/ _/ deadline/ 表示/ 任务/ 通路/ i/ 叶/ 节点/ 上/ 的/ 截止/ 时间/ 约束/ ,/ Ti/ _/ exetime/ 表示/ 任务/ i/ 在/ 额定/ 电压/ // 频率/ 下/ 的/ 执行/ 时间/ ,/ m/ 表示/ 任务/ 通路/ 上/ 的/ 任务/ 数目/ ./ 随后/ ,/ 对于/ 每条/ 通路/ 上/ 每/ 一个/ 任务/ ,/ 按照/ 该/ 任务/ 与/ 所在/ 任务/ 通路/ 的/ 总/ 能耗/ 比值/ 分配/ 执行/ 时间/ 余量/ (/ 行/ #/ 3/ ~/ 5/ )/ ./ 对于/ 处于/ 多条/ 任务/ 通路/ 交叉点/ 上/ 的/ 任务/ ,/ 按/ 每条/ 任务/ 通路/ 计算/ 所得/ 的/ 执行/ 时间/ 余量/ 可能/ 不同/ ./ 这种/ 情况/ 下/ ,/ 取/ 计算/ 所得/ 的/ 执行/ 时间/ 余量/ 中/ 最小值/ 作为/ 该/ 任务/ 的/ 执行/ 时间/ 余量/ (/ 行/ #/ 6/ )/ ./ 随着/ 执行/ 时间/ 余量/ 的/ 分配/ ,/ 任务/ 的/ 开始/ 时间/ 、/ 结束/ 时间/ 和/ 截止/ 时间/ 约束/ 均/ 可/ 确定/ (/ 行/ #/ 7/ )/ ./ 同时/ ,/ 对/ 任务/ 的/ 最低/ 电压/ // 频率/ 也/ 可/ 进行/ 计算/ (/ 行/ #/ 8/ ~/ 9/ )/ ,/ 过程/ 如下/ ./ 任务/ 的/ 执行/ 时间/ 余量/ 为/ 其/ 截止/ 时间/ 和/ 执行/ 时间/ 之差/ ,/ 可/ 表示/ 为/ Texe/ -/ NC/ // fi/ ./ 其中/ ,/ Texe/ 表示/ 任务/ 的/ 执行/ 时间/ ;/ NC/ 表示/ 任务/ 的/ 执行/ 周期/ ;/ fi/ 表示/ 任务/ 所在/ 处理/ 芯核/ 工作频率/ ./ 由/ 上述/ 公式/ 可知/ ,/ 随着/ 处理/ 芯核/ 工作电压/ // 频率/ 的/ 降低/ ,/ 任务/ 执行/ 时间/ 将/ 增加/ ,/ 而/ 执行/ 时间/ 余量/ 则/ 会/ 减少/ ./ 因此/ ,/ 执行/ 时间/ 余量/ 接近/ 或/ 等于零/ 时/ 的/ 电压/ // 频率/ 则/ 确定/ 为/ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ ./ 接下来/ ,/ 在/ 每/ 一个/ 调度/ 时间/ 节点/ ,/ 算法/ 将/ 就绪/ 任务调度/ 到/ 处理/ 芯核/ 上/ ./ 每次/ 一个/ 任务调度/ 完成/ ,/ 该/ 任务/ 的/ 截止/ 时间/ 即/ 被/ 加入/ 到/ 调度/ 时间/ 列表/ 中/ 成为/ 新/ 的/ 调度/ 时间/ 节点/ ./ 在/ 每个/ 调度/ 时间/ 节点/ ,/ 当前/ 的/ 就绪/ 任务/ 和/ 空闲/ 处理/ 芯核/ 分别/ 被/ 加入/ 到/ 就绪/ 任务/ 列表/ 和/ 空闲/ 处理/ 芯核/ 列表/ 中/ (/ 行/ #/ 11/ ~/ 12/ )/ ./ 就绪/ 任务/ 表示/ 该/ 任务调度/ 前/ ,/ 其/ 所有/ 的/ 前/ 继/ 任务/ 均/ 已/ 调度/ 完毕/ ./ 在/ 全部/ 任务/ 图/ 调度/ 的/ 初始/ 阶段/ ,/ 一般/ 会/ 有/ 一些/ 处理/ 芯核/ 从未/ 被/ 分配任务/ ./ 这时/ ,/ 对于/ 某个/ 就绪/ 任务/ ,/ 如果/ 当前/ 所有/ 的/ 空闲/ 处理/ 芯核/ (/ 即/ 从未/ 被/ 分配任务/ 的/ 处理/ 芯核/ )/ 均/ 没有/ 被/ 标记/ 为/ 与/ 就绪/ 任务/ 相同/ 的/ 最低/ 操作/ 电压/ // 频率/ ,/ 则/ 该/ 任务/ 将/ 被/ 调度/ 到/ 任意/ 一个/ 空闲/ 处理/ 芯核/ 上/ ./ 随之/ ,/ 按/ 调度/ 的/ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ 标记/ 该/ 处理/ 芯核/ (/ 行/ #/ 15/ ~/ 16/ )/ ./ 相反/ ,/ 如果/ 有些/ 处理/ 芯核/ 已/ 被/ 标记/ 为/ 与/ 就绪/ 任务/ 相同/ 的/ 最低/ 操作/ 电压/ // 频率/ ,/ 则/ 就绪/ 任务/ 将/ 被/ 调度/ 到/ 与/ 该/ 任务/ 有/ 最大/ 通信量/ 的/ 处理/ 芯核/ 上/ (/ 行/ #/ 17/ ~/ 18/ )/ ./ 与/ 某/ 一/ 就绪/ 任务/ 有/ 最大/ 通信量/ 的/ 处理/ 芯核/ 是/ 指/ 所有/ 已经/ 调度/ 到/ 这个/ 处理/ 芯核/ 的/ 任务/ 与/ 该/ 就绪/ 任务/ 有/ 最大/ 通信量/ ./ 根据/ 通信/ 能耗/ 的/ 计算公式/ (/ 式/ (/ 4/ )/ )/ ,/ 将/ 就绪/ 任务调度/ 到/ 与/ 它/ 有/ 最大/ 通信量/ 的/ 处理/ 芯核/ 上/ 可以/ 有效/ 地/ 降低/ 通信/ 能耗/ ./ 这/ 是因为/ 数据/ 的/ 通信/ 不需/ 经过/ 片上/ 网络/ ./ 确定/ 最大/ 通信量/ 处理/ 芯核/ 的/ 方式/ 则/ 是/ 按照/ 通信/ 任务/ 图中/ 定义/ 的/ 数据/ 相关性/ (/ 即/ 任务/ 间/ 的/ 通信/ 数据/ )/ ,/ 计算/ 该/ 就绪/ 任务/ 与/ 每个/ 处理/ 芯核/ 上/ 已经/ 调度/ 的/ 任务/ 之间/ 的/ 通信量/ ,/ 最后/ 找到/ 有/ 最大/ 通信量/ 的/ 那个/ 处理/ 芯核/ ./ 上述/ 任务调度/ 过程/ 不断/ 重复/ ,/ 直到/ 成功/ 调度/ 完/ 任务/ 图中/ 的/ 所有/ 任务/ ./ 根据/ 任务调度/ 结果/ ,/ 算法/ 随即/ 生成/ 执行/ 时间/ 序列/ (/ 行/ #/ 20/ )/ ./ 在/ 执行/ 时间/ 序列/ 中/ ,/ 任务/ 图/ 的/ 执行/ 过程/ 被/ 划分/ 成/ 许多/ 连续/ 的/ 执行/ 时间/ 片段/ ./ 执行/ 时间/ 片段/ Page7/ 的/ 划分/ 采用/ 一种/ 粗粒度/ 方式/ 进行/ ./ 通过/ 简单/ 地/ 对齐/ 处理/ 芯核/ 上/ 所/ 调度/ 的/ 任务/ 的/ 执行/ 时间/ 划分/ 执行/ 时间/ 片段/ ./ 图/ 4/ (/ a/ )/ 展现/ 了/ 将/ 一个/ 含/ 16/ 个/ 任务/ 的/ 任务/ 图/ 调度/ 到/ 4/ 个/ 处理/ 芯核时/ 划分/ 所得/ 的/ 执行/ 时间/ 序列/ ./ 执行/ 时间/ 序列/ 包含/ 7/ 个/ 时间/ 片段/ (/ t1/ ~/ t7/ )/ ./ 调度/ 的/ 任务/ 以/ 矩形/ 表示/ ./ 矩形/ 的/ 高度/ 表示/ 任务/ 的/ 执行/ 功耗/ ./ 填充/ 矩形/ 的/ 颜色/ 则/ 表示/ 处理/ 芯核/ 所/ 运行/ 的/ 最低/ 操作/ 电压/ // 频率/ ./ 每个/ 时间/ 片段/ 的/ 划分/ 尽量/ 对齐/ 任务/ 的/ 执行/ 时间/ ./ 即/ 每个/ 时间/ 片段/ 内/ 尽量/ 有/ 尽可能/ 多/ 的/ 同时/ 执行/ 的/ 任务/ ;/ 相邻/ 时间/ 片段/ 之间/ 有/ 尽可能少/ 的/ 重叠/ 执行/ 的/ 任务/ ./ 4.2/ 任务/ 迁移/ 算法/ 任务/ 迁移/ 算法/ 在/ 处理/ 芯核/ 之间/ 迁移/ 或/ 交换/ 已/ 调度/ 的/ 任务/ ./ 目的/ 是/ 在/ 每个/ 执行/ 时间/ 片段/ 中/ 平衡/ 核栈/ 的/ 功耗/ ,/ 以/ 降低/ 芯片/ 温度/ ./ 迁移/ 任务/ 时/ ,/ 算法/ 主要/ 利用/ 处理/ 芯核/ 空闲/ 时间/ 以及/ 任务/ 经过/ 电压/ // 频率/ 调节/ 后/ 的/ 剩余/ 执行/ 时间/ 余量/ ./ 这里/ 需要/ 说明/ 的/ 是/ ,/ 本文/ 所/ 提出/ 的/ 任务/ 迁移/ 算法/ 并非/ 传统意义/ 上/ 的/ 在线/ 任务/ 迁移/ ./ 本文/ 中/ 的/ 任务/ 迁移/ 与/ 任务调度/ 算法/ 相似/ ,/ 均/ 是/ 在/ 设计阶段/ ,/ 即/ 实际/ 任务/ 执行/ 之前/ 完成/ ./ 目的/ 是/ 为了/ 平衡/ 核栈/ 间/ 的/ 功耗/ ,/ 实现/ 芯片/ 的/ 热平衡/ 并且/ 降低/ 芯片/ 温度/ ./ 任务/ 图/ 实际/ 执行/ 期间/ ,/ 即可/ 按照/ 预先确定/ 的/ 任务/ -/ 处理/ 芯核/ 对应/ 关系/ 进行/ 任务/ 的/ 分配/ ./ 算法/ 2/ 给出/ 了/ 任务/ 迁移/ 算法/ 的/ 伪/ 代码/ ./ 算法/ 2/ ./ 任务/ 迁移/ 算法/ ./ 输入/ :/ 任务调度/ 结果/ ,/ 电压/ // 频率/ 分派/ 结果/ ,/ 核栈/ ,/ 执行/ 输出/ :/ 任务/ 迁移/ 及/ 最终/ 调度/ 结果/ // / co/ :/ 处理/ 芯核/ ;/ CS/ :/ 核栈/ ;/ CSL/ :/ 核栈/ 链表/ ;/ te/ :/ 执行/ 时间/ 片段/ ;/ Σ/ P/ :/ 核栈/ 总/ 功耗/ ;/ LPT/ :/ 核栈/ 中/ 某个/ 核上/ 的/ 高功耗/ 任务/ ;/ SPT/ :/ 核栈/ 中/ 某个/ 核上/ 的/ 低功耗/ 任务/ ;/ IT/ :/ 空闲/ 时间/ ;/ ET/ :/ 执行/ 时间/ / // 1/ ./ FORETS/ 中/ 每个/ 执行/ 时间/ 片段/ te/ {/ 2/ ./ 为/ 每个/ CS/ 计算/ Σ/ P/ ,/ 计算/ 总/ 功耗/ 标准差/ Σ/ P/ ./ σ/ ;/ 3/ ./ IF/ Σ/ P/ ./ σ/ >/ 阈值/ {/ // // 如果/ 标准差/ 大于/ 设定/ 的/ 阈值/ ,/ 4/ ./ 将/ CSL/ 中/ 所有/ CSs/ 以/ Σ/ P/ 按/ 降序/ 排列/ ;/ 5/ ./ i/ =/ 0/ ;/ j/ =/ CSL/ ./ GetLengh/ (/ )/ ;/ CSh/ =/ CSL/ ./ GetAt/ (/ i/ )/ ;/ 6/ ./ WHILE/ (/ 1/ )/ {/ 7/ ./ CSt/ =/ CSL/ ./ GetAt/ (/ j/ )/ ;/ 8/ ./ IFCSt/ ./ co/ ./ IT/ 与/ CSh/ ./ co/ ./ SPT/ ./ ET/ 相匹配/ // // 低功耗/ 核栈/ 处理/ 芯核/ 的/ 空闲/ 时间/ 9.10/ ./ ELSEIFCSh/ ./ SPT/ 和/ CSt/ ./ LPT/ 能够/ 交换/ 11.12/ ./ ELSE13/ ./ j/ =/ j/ -/ 1/ ;/ }/ 14/ ./ 从/ CSL/ 中/ 移除/ CSh/ 和/ CSt/ ;/ 15/ ./ IFCSL/ ./ GetLenth/ (/ )/ >/ =/ 216/ ./ 在/ 每个/ 执行/ 时间/ 片段/ ,/ 对/ 每个/ 核栈/ 计算/ 总/ 功耗/ Σ/ P/ ./ 同时/ ,/ 计算/ 所有/ 核栈/ 总/ 功耗/ 的/ 标准差/ Σ/ P/ ./ σ/ ./ 如果/ 标准差/ 大于/ 指定/ 阈值/ (/ 例如/ 实验/ 中取/ 5/ %/ )/ ,/ 则/ 启动/ 任务/ 迁移/ ./ 首先/ ,/ 将/ 所有/ 核栈/ 按/ 总/ 功耗/ 大小/ 按/ 降序/ 排列/ ./ 随后/ ,/ 针对/ 具有/ 最大/ 总/ 功耗/ 的/ 核栈/ CSh/ ,/ 找出/ 具有/ 最小/ 总/ 功耗/ 的/ 匹配/ 核栈/ CSt/ ./ 这里/ ,/ 匹配/ 的/ 含义/ 有/ 两层/ :/ (/ 1/ )/ 匹配/ 的/ 核栈/ 其中/ 一方/ 能够/ 为/ 另一方/ 提供/ 空闲/ 时间/ 以供/ 任务/ 迁移/ ;/ (/ 2/ )/ 匹配/ 双方/ 可以/ 交换/ 任务/ ./ 如果/ 条件/ 1/ 满足/ ,/ CSh/ 中/ 的/ 低功耗/ 任务/ (/ SPT/ )/ 将/ 被/ 迁移/ 到/ CSt/ 上/ (/ 行/ #/ 8/ ~/ 9/ )/ ./ 如果/ 条件/ 2/ 满足/ ,/ CSh/ 中/ 的/ 低功耗/ 任务/ 将/ 与/ CSt/ 中/ 的/ 高功耗/ 任务/ (/ LPT/ )/ 进行/ 交换/ (/ 行/ #/ 10/ ~/ 11/ )/ ./ 本次/ 任务/ 迁移/ 完成/ 后/ ,/ 从/ CSL/ 中/ 移除/ CSh/ 和/ CSt/ ./ 上述/ 过程/ 不断/ 重复/ ,/ 直到/ 在/ 所有/ 执行/ 时间/ 片段/ 内/ 都/ 进行/ 了/ 任务/ 迁移/ (/ 行/ #/ 14/ ~/ 16/ )/ ./ 以图/ 4/ (/ a/ )/ 调度/ 的/ 任务/ 图为例/ ./ 如图/ 4/ (/ b/ )/ 所示/ ,/ Page8/ 处理/ 芯核/ 1/ 、/ 4/ 和/ 2/ 、/ 3/ 各/ 组成/ 两个/ 核栈/ ./ 现在/ 我们/ 考虑/ 时间/ 片段/ t3/ 中/ 的/ 功耗/ 情况/ ./ 在/ 没有/ 采取/ 任务/ 迁移/ 之前/ ,/ t3/ 期间/ ,/ 包含/ 处理/ 芯核/ 1/ 和/ 4/ 的/ 核栈/ 总/ 的/ 功耗/ 为/ 任务/ 3/ 和/ 任务/ 4/ 总/ 功耗/ 之/ 和/ ./ 很/ 明显/ ,/ 这个/ 总/ 的/ 功耗/ 远远/ 大于/ 包含/ 处理/ 芯核/ 2/ 和/ 3/ 的/ 核栈/ 的/ 总/ 功耗/ (/ 即/ 任务/ 2/ 的/ 功耗/ )/ ./ 因此/ ,/ 为了/ 在/ 执行/ 时间/ 片段/ t3/ 中/ 平衡/ 核栈/ 的/ 功耗/ ,/ 任务/ 3/ 可以/ 从核/ 1/ 迁移/ 到/ 核/ 2/ ./ 原因/ 在于/ 任务/ 1/ 和/ 任务/ 6/ 之间/ 的/ 空闲/ 时间/ 能够/ 容纳/ 任务/ 3/ 的/ 执行/ ./ 同理/ ,/ 为了/ 平衡/ 时间/ 片段/ t6/ 中/ 的/ 功耗/ ,/ 任务/ 10/ 可以/ 从核/ 2/ 迁移/ 到/ 核/ 4/ ./ 从而/ 保证/ 两个/ 核栈/ 中均/ 有/ 一个/ 执行/ 的/ 任务/ ,/ 以/ 实现/ 在/ t6/ 中/ 的/ 功耗/ 平衡/ ./ 图/ 5/ 任务/ 迁移/ 前后/ 功耗/ 和/ 温度/ 对比/ 5/ 实验/ 及/ 讨论/ 5.1/ 实验/ 配置/ 说明/ 5.1/ ./ 1/ 实验/ 平台/ 实验/ 在/ 一个/ 格状/ NoC/ -/ 总线结构/ 的/ 三维/ 多核/ SoC/ 模拟/ 平台/ 上/ 进行/ ./ 平台/ 拓扑/ 设为/ 4/ ×/ 4/ ×/ 2/ ,/ 即/ 两层/ 处理/ 芯核/ 堆叠/ ,/ 每层/ 处理/ 芯核/ 数目/ 设定/ 为/ 16/ 个/ ./ 同/ 一层/ 的/ 处理/ 芯核/ 采用/ 网状结构/ NoC/ 互连/ ./ 而/ 不同/ 层/ 的/ 处理/ 芯核/ 之间/ 则/ 通过/ 多/ TSV/ 总线/ 进行/ 通信/ ./ 芯片/ 绑定/ 方式/ 假定/ 为/ 面向/ 背/ (/ Face/ -/ to/ -/ back/ )/ 绑定/ 策略/ ./ 处理/ 芯核/ 假定/ 为/ TILE64/ 多核/ 处理器/ 中/ 采用/ 的/ VLIW/ 处理器/ [/ 26/ ]/ ./ 处理/ 芯核/ 在/ 1.0/ V/ 额定/ 操作/ 电压/ 下/ 的/ 操作/ 频率/ 设为/ 500MHz/ ,/ 可/ 运行/ 在/ 五个/ 不同/ 的/ 电压/ 级别/ 下/ [/ 0.7/ V/ ,/ 0.8/ V/ ,/ 0.9/ V/ ,/ 1.0/ V/ ,/ 1.1/ V/ ]/ ./ 通过/ 将/ 处理/ 芯核/ 模型/ 化为/ 4/ 扇出/ 与非门/ 链/ ,/ 采用/ 基于/ 值得注意/ 的/ 是/ ,/ 原本/ 任务/ 2/ 与/ 任务/ 9/ 之间/ 的/ 空闲/ 时间/ 不足以/ 容纳/ 任务/ 7/ 的/ 执行/ ./ 幸运/ 的/ 是/ ,/ 任务/ 7/ 的/ 前/ 继/ 任务/ ,/ 即/ 任务/ 2/ 在/ 电压/ // 频率/ 调节/ 后/ 仍/ 保留/ 有/ 一定/ 的/ 执行/ 时间/ 余量/ ./ 因此/ ,/ 迁移/ 算法/ 减少/ 任务/ 2/ 的/ 执行/ 时间/ 余量/ (/ 并/ 没有/ 造成/ 违背/ 任务/ 截止/ 时间/ 的/ 现象/ )/ ,/ 将/ 任务/ 7/ 的/ 执行/ 时间/ 提前/ ,/ 从而/ 可以/ 将/ 任务/ 7/ 从核/ 4/ 迁移/ 到/ 核/ 3/ ./ 图/ 5/ 展示/ 了/ 施行/ 任务/ 迁移/ 前后/ 两个/ 核栈/ 的/ 功耗/ 以及/ 生成/ 的/ 温度/ ./ 很/ 明显/ ,/ 任务/ 迁移/ 算法/ 有效/ 地/ 在/ 所有/ 执行/ 时间/ 片段/ 中/ 平衡/ 了/ 核栈/ 的/ 功耗/ ./ 相应/ 的/ ,/ 功耗/ 平衡/ 不仅/ 平衡/ 了/ 核栈/ 温度/ ,/ 而且/ 有效/ 地/ 降低/ 了/ 芯片/ 温度/ ./ 45nmPTM/ 晶体管/ 模型/ [/ 27/ ]/ 的/ HSPICE/ 仿真/ 来/ 评估/ 处理/ 芯核/ 在/ 不同/ 供电/ 电压/ 下/ 的/ 最大/ 操作/ 频率/ ./ 路由器/ 采用/ 4/ 级/ 流水线结构/ ,/ 包含/ 5/ 个/ 端口/ ./ 除了/ 用于/ 二维/ 平面/ 中东/ 、/ 西/ 、/ 南/ 和/ 北方/ 向/ 通信/ 的/ 4/ 个/ 端口/ 外/ ,/ 第/ 5/ 个/ 端口/ 用于/ 连接/ 垂直/ 总线/ 以/ 实现/ 垂直/ 方向/ 上/ 的/ 数据交换/ ./ 相同/ 格内/ 的/ 处理/ 芯核/ 和/ 路由器/ 假定/ 具有/ 相同/ 的/ 操作/ 频率/ ./ 采用/ 确定性/ x/ -/ y/ -/ z/ 路由/ 算法/ 来/ 避免/ 活锁/ 和/ 死锁/ ./ 在/ VFI/ 边界/ 处/ 采用/ 混合/ 电压/ // 频率/ FIFO/ 实现/ 数据/ 同步/ ./ 式/ (/ 3/ )/ 中/ 的/ 位/ 能耗/ 参考文献/ [/ 15/ ]/ 计算/ ./ 5.1/ ./ 2/ 任务/ 图/ 实验/ 中/ 采用/ 两组/ 任务/ 图/ ./ 第/ 1/ 组/ 取自/ 工业/ 级/ 基准/ 任务/ 图/ E3S/ ①/ ./ E3S/ 中/ 的/ 任务/ 图均/ 给出/ 了/ 所/ 包含/ ①/ DickR/ ./ EmbeddedSystemSynthesisBenchmarksSuitesPage9/ 的/ 任务/ 在/ 各种/ 实际/ 的/ 处理/ 芯核/ 上/ 执行/ 时/ 的/ 功耗/ 和/ 延迟/ ./ 不过/ ,/ E3S/ 中/ 的/ 任务/ 图所/ 包含/ 的/ 任务/ 数目/ 一般/ 小于/ 实验/ 平台/ 中/ 的/ 处理/ 芯核/ 数目/ ./ 因此/ ,/ 参照/ 实验/ 平台/ 中/ 处理/ 芯核/ 的/ 数目/ ,/ 实验/ 中将/ 基准/ 程序/ 中/ 多个/ 任务/ 图/ 组合成/ 新/ 的/ 任务/ 图/ ./ 第/ 2/ 组/ 采用/ TGFF/ ①/ 生成/ 6/ 个/ 伪/ 随机/ 任务/ 图/ (/ TG1/ ~/ TG6/ )/ ,/ 每个/ 任务/ 图/ 包含/ 80/ ~/ 100/ 个/ 任务/ ./ 任务/ 图/ 生成/ 过程/ 中/ ,/ 通过/ 更改/ 任务/ 的/ 入度/ 、/ 出/ 度/ 以及/ 通信量/ 来/ 覆盖/ 不同/ 类型/ 的/ 任务/ ./ 表/ 1/ 列出/ 实验/ 采用/ 的/ 任务/ 图/ 统计/ 信息/ ./ 任务/ 图/ ConsumerAuto/ -/ industryNetworksTelecommTG1TG2TG3TG4TG5TG65/ ./ 1.3/ 偏差/ 影响/ 下/ 的/ VFI/ 划分/ 图/ 本文/ 采用/ 文献/ [/ 25/ ]/ 提出/ 的/ VARIUS/ 模型/ 对/ 参数/ 差/ 偏差/ 进行/ 建模/ ./ 标准偏差/ 设/ 为/ 参数/ 期望值/ 的/ 10/ %/ ,/ 并/ 进一步/ 分为/ 6/ %/ 的/ 片间/ 偏差/ 和/ 8/ %/ 的/ 片/ 内/ 偏差/ ./ 片内/ 偏差/ 平均/ 分为/ 系统性/ 和/ 随机性/ 偏差/ 两/ 部分/ ./ 刻画/ 芯片/ 二维/ 平面/ 上/ 系统性/ 偏差/ 相关性/ 的/ 最大/ 物理/ 距离/ 设为/ 0.5/ [/ 25/ ]/ ./ 整个/ 芯片/ 面积/ 划分/ 为/ 64/ 个/ 网格/ ./ 每个/ 处理/ 芯核/ 占据/ 一部分/ 网格/ 并/ 被/ 模型/ 化为/ 100/ 条/ 四扇/ 出/ 的/ 与非门/ 链/ ./ 通过/ 应用/ VARIUS/ 模型/ ,/ 借助/ HSPICE/ 蒙特卡洛/ 模拟/ 获得/ 处理/ 芯核/ 的/ 频率/ 分布/ 数据/ ./ 将/ 频率/ 分布/ 的/ 均值/ 作为/ 处理/ 芯核/ 的/ 额定/ 操作/ 频率/ ./ 同样/ ,/ 5/ 种/ 供电/ 电压/ 下/ 处理/ 芯核/ 的/ 操作/ 频率/ 也/ 采用/ HSPICE/ 进行/ 评估/ ./ 根据/ 获得/ 的/ 处理/ 芯核/ 的/ 5/ 种/ 电压/ // 频率/ 组合/ ,/ 实验/ 中/ 采用/ 文献/ [/ 10/ ]/ 提出/ 的/ 方法/ 划分/ VFI/ ./ VFI/ 划分/ 采用/ 两层/ 统一/ 的/ 方式/ ./ 也就是说/ ,/ 同一个/ VFI/ 可能/ 包含/ 垂直/ 方向/ 上/ 位于/ 不同/ 层/ 的/ 处理/ 芯核/ ./ 划分/ 过程/ 中/ ,/ 操作/ 电压/ // 频率/ 相/ 接近/ 的/ 处理/ 芯核会/ 被/ 划归/ 于/ 一个/ VFI/ ./ 每个/ VFI/ 中/ 包含/ 的/ 处理/ 芯核/ 数目/ 可能/ 不同/ ./ VFI/ 的/ 划分/ 从/ 每核/ VFI/ 开始/ ,/ 随后/ 两/ 两/ 合并/ ,/ 直到/ 最终/ 所有/ 处理/ 芯核/ 同属/ 一个/ VFI/ 结束/ ./ 对/ 所有/ 划分/ 粒度/ 的/ VFI/ 方案/ ,/ 取/ 能耗/ 最低/ 的/ 那/ 一个/ 作为/ 最终/ VFI/ 划分/ 方案/ ./ 表/ 2/ 列出/ 与/ 各/ 任务/ 图/ 对应/ 的/ VFI/ 划分/ 结果/ ./ 5.1/ ./ 4/ 热/ 模拟/ 方法/ 采用/ HotSpot5/ ./ 0/ 计算/ 任务/ 执行/ 时/ 的/ 芯片/ 温度/ ./ 该软件/ 支持/ 基于/ 网格/ 的/ 三维/ 芯片/ 热/ 模拟/ [/ 24/ ]/ ./ 热/ 模拟/ 参数/ 参考文献/ [/ 15/ ]/ 中/ 的/ 数据/ ,/ 具体/ 值如表/ 3/ 所示/ ./ 模拟/ 所/ 需/ 的/ 功耗/ 痕迹/ (/ trace/ )/ 文件/ 通过/ 计算/ 每个/ 调度/ 间隔/ 任务/ 的/ 平均/ 执行/ 功耗/ 获得/ ./ 温度/ 计算/ 中/ 只/ 考虑/ 处理/ 芯核/ 的/ 静态/ 温度/ 及/ 芯片/ 的/ 峰值/ 温度/ ./ 5.2/ 实验/ 结果/ 出于/ 比较/ 目的/ ,/ 本文/ 修改/ 并/ 实现/ 了/ 文献/ [/ 20/ ]/ 提出/ 的/ 热平衡/ 算法/ ,/ 使/ 之/ 适用/ 于/ 基于/ VFI/ 设计/ 的/ 三维/ 多核/ 平台/ ./ 文献/ [/ 20/ ]/ 考虑/ 任务/ 间/ 的/ 热/ 特性/ 差异/ ,/ 在/ 每个/ 调度/ 时间/ 节点/ 将/ 高功耗/ 和/ 低功耗/ 的/ 任务/ 组合/ 在/ 一起/ 调度/ 到/ 一个/ 核栈/ 上/ ./ 在/ 本文/ 后续/ 的/ 内容/ 中将/ 文献/ [/ 20/ ]/ 提出/ 的/ 方法/ 称为/ TB/ 算法/ ./ 同时/ ,/ 本文/ 还/ 实现/ 了/ 文献/ [/ 10/ ]/ 提出/ 的/ 能效/ 感知/ 的/ 任务调度/ 算法/ ./ 他们/ 的/ 方法/ 通过/ 考虑/ 赋予/ 不同/ 能耗/ 任务/ 以/ 不同/ 的/ 优先级/ 指导/ 任务/ 的/ 分配/ 和/ 调度/ ./ 而/ 在/ VFI/ 划分/ 过程/ 中/ ,/ 他们/ 首先/ 将/ 每个/ 处理/ 芯核/ 看成/ 是/ 单独/ 的/ VFI/ ,/ 按照/ 任务调度/ 的/ 结果/ 确定/ 每个/ 处理/ 芯核/ 的/ 最低/ 操作/ 电压/ ./ 随后/ 将/ 处理/ 芯核/ 进行/ 合并/ 以/ 形成/ 新/ 的/ VFI/ ./ VFI/ 的/ 数目/ 取决于/ 系统/ 设计/ 约束/ ./ 在/ 本文/ 的/ 后续/ 内容/ 中将/ 文献/ [/ 10/ ]/ 提出/ 的/ 方法/ 称为/ EAS/ 算法/ ./ 5.2/ ./ 1/ 能耗/ 优化/ 结果/ 图/ 6/ 给出/ 采用/ 3/ 种/ 方法/ 后/ 的/ 能耗/ 优化/ 结果/ 及/ 优化/ 过程/ 中/ 的/ 芯片/ 峰值/ 温度/ 数据/ ./ 为了/ 更为/ 清晰/ 地展/ ①/ Available/ :/ http/ :/ // // ziyang/ ./ eecs/ ./ umich/ ./ edu/ // ~/ dickrp/ // tgff/ // Page10/ 示/ 结果/ 对比/ ,/ EAS/ 和/ 本文/ 提出/ 的/ 方法/ 所/ 取得/ 的/ 能耗/ 优化/ 结果/ 均/ 以/ TB/ 方法/ 取得/ 的/ 结果/ 为/ 参照/ 进行/ 归一化/ 处理/ ./ 由图/ 6/ (/ a/ )/ 可见/ ,/ 在/ 能耗/ 优化/ 方面/ ,/ 本文/ 提出/ 的/ 方法/ 以及/ EAS/ 算法/ 的/ 表现/ 明显/ 优于/ TB/ 算法/ ./ 相/ 比较/ 与/ TB/ 算法/ ,/ 本文/ 提出/ 的/ 方法/ 能/ 减少/ 平均/ 18.6/ %/ 的/ 能耗/ ./ 上述/ 结果/ 得益于/ 本文/ 提出/ 的/ 能效/ 感知/ 的/ 任务调度/ 算法/ ./ 通过/ 将/ 具有/ 相同/ 最低/ 操作/ 电压/ // 频率/ 的/ 任务调度/ 到/ 同一个/ 处理/ 芯核/ ,/ 处理/ 芯核/ 可/ 运行/ 在/ 所/ 调度/ 的/ 任务/ 的/ 最低/ 电压/ // 频率/ 上/ ,/ 从而/ 最大/ 程度/ 地/ 降低/ 任务/ 执行/ 能耗/ ./ 相反/ ,/ TB/ 算法/ 将/ 高功耗/ 和/ 低功耗/ 任务/ 组合/ 在/ 一起/ 调度/ 到/ 同一个/ 核栈/ 上/ ./ 这种/ 做法/ 虽然/ 可以/ 实现/ 核栈/ 间/ 的/ 功耗/ 平衡/ ,/ 但/ 却/ 难以/ 对/ 能耗/ 的/ 优化/ 产生/ 积极/ 作用/ ./ 另一方面/ ,/ 由图/ 6/ 所示/ ,/ 虽然/ 在/ 能耗/ 优化/ 方面/ ,/ 本文/ 提出/ 的/ 方法/ 与/ EAS/ 算法/ 的/ 效果/ 相当/ ./ 然而/ ,/ 相/ 比较/ 于/ EAS/ 算法/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 优化/ 能耗/ 的/ 同时/ 可以/ 有效/ 地/ 降低/ 芯片/ 温度/ ./ 如图/ 6/ (/ b/ )/ 所示/ ,/ 实施/ 本文/ 提出/ 的/ 方法/ 时/ ,/ 芯片/ 温度/ 略低于/ TB/ 算法/ ./ 在/ 达到/ 几乎/ 相同/ 的/ 能耗/ 优化/ 结果/ 的/ 前提/ 下/ ,/ 实施/ 本文/ 提出/ 的/ 方法/ 所/ 产生/ 的/ 芯片/ 温度/ 大大/ 低于/ EAS/ 算法/ ./ 与/ EAS/ 算法/ 比较/ ,/ 本文/ 提出/ 的/ 方法/ 能/ 降低/ 平均/ 5.6/ 的/ 峰值/ 温度/ ./ 以上/ 对于/ 温度/ 的/ 优化/ 效果/ 主要/ 得益于/ 本文/ 提出/ 的/ 任务/ 迁移/ 算法/ ./ 通过/ 在/ 核栈/ 间/ 交换/ 或/ 迁移/ 少量/ 的/ 任务/ ,/ 以较/ 小/ 的/ 影响/ 能耗/ 优化/ 为/ 代价/ ,/ 本文/ 的/ 方法/ 可以/ 实现/ 有效/ 的/ 功耗/ 平衡/ ,/ 同时/ 降低/ 了/ 芯片/ 温度/ ./ 由/ 上面/ 两/ 方面/ 的/ 比较/ 结果/ 可知/ ,/ 相对/ 于/ TB/ 和/ EAS/ 算法/ ,/ 本文/ 提出/ 的/ 方法/ 可以/ 在/ 能耗/ 优化/ 和/ 降低/ 温度/ 两/ 方面/ 取得/ 最佳/ 的/ 平衡/ ./ 5.2/ ./ 2/ 热/ 优化/ 结果/ 图/ 7/ 给出/ 了/ 采用/ 3/ 种/ 优化/ 方法/ 后/ 的/ 任务/ 图/ 执行/ 过程/ 中/ 的/ 芯片/ 平均温度/ 数据/ ./ 实验/ 中/ ,/ 两组/ 共/ 10/ 个/ 任务/ 图/ 一个/ 接/ 一个/ 的/ 连续/ 执行/ ./ 每个/ 任务/ 图/ 的/ 执行/ 时间/ 被/ 均匀/ 地/ 划分/ 为/ 10/ 个/ 执行/ 时间/ 片段/ ./ 随后/ ,/ 将/ 总共/ 100/ 个/ 时间/ 片段/ 内/ 的/ 功耗/ 痕迹/ (/ powertrace/ )/ 送入/ HotSpot/ 以/ 计算/ 所有/ 核栈/ 的/ 平均温度/ ./ 如图/ 7/ 所示/ ,/ TB/ 算法/ 和/ 本文/ 提出/ 的/ 方法/ 均/ 能/ 在/ 核栈/ 间/ 实现/ 温度/ 平衡/ ,/ 达到/ 较为理想/ 的/ 热/ 优化/ 效果/ ./ 比较/ 图/ 7/ (/ a/ )/ 和/ (/ c/ )/ ,/ 采用/ 本文/ 提出/ 的/ 方法/ 后/ ,/ 芯片/ 平均温度/ 还/ 略低于/ TB/ 算法/ ./ 另一方面/ ,/ 由图/ 7/ (/ b/ )/ 所示/ ,/ 采用/ EAS/ 方法/ 后/ ,/ 芯片/ 温度/ 出现/ 明显/ 波动/ 偏差/ ./ 这/ 是因为/ EAS/ 算法/ 在/ 优化/ 能耗/ 的/ 过程/ 中/ 并/ 没有/ 考虑/ 热/ 优化/ 问题/ ./ 上述/ 数据/ 也/ 表明/ ,/ 面向/ 三维/ 芯片/ 的/ 能耗/ 优化/ 方法/ 必须/ 将/ 热/ 问题/ 考虑/ 在内/ ./ 图/ 710/ 个/ 任务/ 图/ 连续/ 执行/ 时/ 的/ 平均温度/ 数据/ 统计/ 6/ 结论/ 面向/ 采用/ VFI/ 设计/ 的/ 三维/ 多核/ SoC/ ,/ 本文/ 提出/ 一个/ 硅后/ 优化/ 框架/ ,/ 在/ 最小化/ 系统/ 能耗/ 的/ 同时/ ,/ 满足/ 任务/ 截止/ 时间/ 和/ 系统/ 热/ 约束/ ./ 提出/ 的/ 优化/ 框架/ 统一/ 考虑/ 任务调度/ 和/ 电压/ // 频率/ 分派/ ,/ 通过/ 识别/ 任务/ 的/ 最低/ 操作/ 电压/ // 频率/ 指导/ 任务调度/ 策略/ ./ 同时/ ,/ 通过/ 任务/ 迁移/ 算法/ 平衡/ 核栈/ 的/ 功耗/ ,/ 以/ 达到/ 降低/ 芯片/ 温度/ 的/ 目的/ ./ 实验/ 结果表明/ ,/ 本文/ 提出/ 的/ 方法/ 能够/ 在/ 降低/ 系统/ 能耗/ 的/ 同时/ ,/ 有效/ 降低/ 芯片/ 温度/ ./ Page11/ 

