Page1/ 基于/ 触发/ 路径/ 的/ 主动/ 规则/ 集/ 终止/ 性/ 分析/ 熊伟/ 吴烨/ 张震/ 吴秋云/ (/ 国防科学技术大学/ 电子/ 科学/ 与/ 工程学院/ 长沙/ 410073/ )/ 摘要/ 为/ 满足用户/ 对/ 网络服务/ 的/ 个性化/ 、/ 定制/ 化/ 和/ 主动/ 化/ 需求/ ,/ 主动/ 规则/ 成为/ 解决/ 这些/ 问题/ 的/ 关键技术/ ./ 研究/ 了/ 在/ 网络/ 环境/ 下/ 基于/ 规则/ 的/ 复杂/ 应用/ 中/ ,/ 大量/ 规则/ 集/ 同时/ 触发/ 所/ 带来/ 的/ 规则/ 终止/ 性/ 问题/ ,/ 提出/ 的/ 分析方法/ 确保/ 主动/ 规则/ 能够/ 有效/ 运行/ ,/ 以/ 提供/ 更加/ 灵活/ 的/ 主动/ 服务/ ./ 讨论/ 了/ 以/ 静态/ 分析方法/ 为主/ 的/ 主动/ 规则/ 终止/ 性/ 分析/ 相关/ 工作/ ,/ 随后/ 给出/ 问题/ 描述/ 和/ 相关/ 形式化/ 定义/ ./ 分析/ 了/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析方法/ 的/ 保守/ 性/ ,/ 引入/ 触发/ 路径/ 和/ 有限/ 触发/ 环/ 概念/ ,/ 提出/ 了/ 基于/ 触发/ 路径/ 的/ 两种/ 终止/ 情形/ 分析方法/ ,/ 提高/ 了/ 规则/ 集/ 终止/ 性/ 分析/ 的/ 准确性/ ,/ 采用/ 两/ 阶段/ 分析/ 算法/ 保证/ 了/ 分析/ 效率/ ./ 与/ 相关/ 分析方法/ 的/ 实验/ 比较/ 说明/ ,/ 文中/ 方法/ 能够/ 更/ 准确/ 高效/ 地/ 检测/ 主动/ 规则/ 集/ 的/ 终止/ 性/ ,/ 并/ 适应/ 基于/ 主动/ 规则/ 的/ 其它/ 应用/ ./ 关键词/ 主动/ 规则/ ;/ 触发/ 路径/ ;/ 有限/ 触发/ 环/ ;/ 终止/ 性/ 分析/ ;/ 关联/ 图/ 1/ 引言/ 随着/ 以/ 服务/ 为/ 形式/ 的/ 各种/ 应用/ 的/ 发展/ ,/ 用户/ 对/ 网络服务/ 的/ 需求/ 呈现/ 个性化/ 、/ 定制/ 化/ 和/ 主动/ 化/ 的/ 趋势/ ,/ 主动/ 规则/ 成为/ 解决/ 这些/ 问题/ 的/ 关键技术/ ./ 例如/ ,/ 对/ 等/ 网络/ 中/ ,/ 用户/ 可以/ 利用/ 自定义/ 的/ 规则/ 来/ 进行/ 网络/ 学习/ 和/ 协作/ 科研/ [/ 1/ ]/ ./ 网络/ 中/ 用户/ 感兴趣/ 的/ 最新/ 学习/ 资料/ 、/ 实验/ 数据/ 和/ 结果/ 都/ 可以/ 实时/ 地向/ 用户/ 发布/ ./ 主动/ 规则/ 用来/ 实现/ 节点/ 或/ 超级/ 节点/ 片段/ 数据/ 的/ 更新/ ,/ 特殊/ 之/ 处/ 在于/ P2P/ 网络/ 中/ 参与/ 规则/ 计算/ 和/ 执行/ 的/ 节点/ 数量/ 是/ 非常/ 庞大/ 的/ ,/ 对/ 定义/ 的/ 规则/ 集/ 进行/ 准确/ 的/ 终止/ 性/ 分析/ ,/ 能够/ 提高/ P2P/ 网络/ 的/ 执行/ 效率/ ;/ 在/ 传感器/ 网络/ 中/ ,/ 主动/ 规则/ 作为/ 一种/ 新/ 的/ 查询处理/ 模式/ ,/ 可以/ 应用/ 于/ 安全/ 管理/ 、/ 环境/ 监控/ ,/ 当/ 出现/ 危险/ 情况/ 时/ 进行/ 应急/ 处理/ [/ 2/ ]/ ./ 其/ 与/ 传统/ 主动/ 数据库/ 应用/ 的/ 区别/ 在于/ 各个/ 传感器/ 节点/ 数目/ 众多/ 且/ 功能/ 独立/ ,/ 规则/ 终止/ 性/ 分析/ 需要/ 考虑/ 其/ 动态/ 自组/ 网络/ 特点/ ;/ 商业/ 数据库/ 产品/ 也/ 纷纷/ 推出/ 规则/ 管理器/ ,/ 以/ 支持/ 商品/ 订购/ 、/ 位置服务/ 等/ 应用/ [/ 3/ ]/ ,/ 通过/ 用户/ 自主/ 定制/ 的/ 主动/ 规则/ ,/ 随时/ 提供/ 满足用户/ 需求/ 的/ 商品/ 或/ 服务/ ./ 其/ 特点/ 是/ 引入/ 了/ 位置/ 信息/ 和/ 空间/ 查询/ ./ 从/ 这些/ 应用/ 来看/ ,/ 主动/ 规则/ 的/ 功能/ 已经/ 不再/ 局限于/ 传统/ 的/ 数据库/ 完整性/ 约束/ 维护/ ,/ 而是/ 逐渐/ 用于/ 满足/ 更/ 复杂/ 和/ 高级/ 的/ 商业/ 应用/ ./ 此外/ ,/ 这些/ 支持/ 规则/ 技术/ 的/ 大规模/ 复杂/ 网络应用/ 都/ 具备/ 类似/ 特点/ ,/ 即/ 常有/ 大量/ 的/ 用户/ 自定义/ 规则/ 集/ 同时/ 触发/ ,/ 网络结构/ 也/ 有/ 可能/ 发生/ 动态变化/ ,/ 因此/ 带来/ 了/ 规则/ 并/ 发行/ 为/ 的/ 控制/ 问题/ [/ 4/ ]/ ./ 每当/ 应用/ 及其/ 相关/ 数据/ 状态/ 发生/ 改变/ 时/ ,/ 都/ 会/ 进行/ 规则/ 处理/ ./ 由于/ 规则/ 动作/ 的/ 执行/ 也/ 会/ 产生/ 新/ 的/ 状态/ ,/ 从而/ 会/ 引起/ 一组/ 规则/ 集/ 的/ 相互/ 级联/ 触发/ ,/ 这种/ 级联/ 触发/ 可能/ 会/ 一直/ 延续下去/ ,/ 无法/ 在/ 有限/ 步内/ 终止/ ./ 终止/ 性/ (/ Termination/ )/ 问题/ 是/ 一个/ 不可判定/ 的/ 问题/ [/ 5/ ]/ ,/ 规则/ 处理/ 行为/ 的/ 非/ 结构化/ 、/ 不/ 可预测性/ 是/ 主动/ 规则/ 设计/ 的/ 一大/ 难题/ ./ 为此/ ,/ 需要/ 提供/ 一些/ 分析方法/ 和/ 工具/ ,/ 以/ 使/ 主动/ 规则/ 能够/ 更加/ 有效/ 地/ 运行/ ./ 主动/ 规则/ 常/ 采用/ 事件驱动/ 的/ ECA/ 规则/ 模型/ [/ 6/ ]/ ,/ 即/ 认为/ 一个/ 主动/ 规则/ 由/ 事件/ (/ Event/ )/ 、/ 条件/ (/ Condition/ )/ 、/ 动作/ (/ Action/ )/ 三/ 部分/ 组成/ ,/ 语义/ 是/ :/ 当/ 规定/ 的/ 事件/ E/ 发生/ 且/ 条件/ C/ 成立/ 时/ 自动/ 执行/ 相应/ 动作/ A/ ,/ 并且/ 在/ 动作/ 执行/ 过程/ 中/ 接着/ 逐个/ 检查/ 下/ 一个/ 被/ 级联/ 触发/ 的/ 规则/ ,/ 直到/ 执行/ 完/ 为止/ ./ 为了/ 使/ 研究/ 更/ 具有/ 普遍性/ ,/ 本文/ 讨论/ 的/ 范围/ 主要/ 是/ ECA/ 规则/ 模型/ ./ 首先/ 综述/ 以/ 静态/ 分析方法/ 为主/ 的/ 主动/ 规则/ 终止/ 性/ 分析/ 相关/ 工作/ ;/ 随后/ 给出/ 问题/ 描述/ 和/ 相关/ 形式化/ 定义/ ;/ 分析/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析方法/ 的/ 保守/ 性/ ,/ 通过/ 定义/ 触发/ 路径/ ,/ 证明/ 基于/ 触发/ 路径/ 的/ 规则/ 终止/ 性/ 相关/ 定理/ ,/ 并/ 给出/ 触发/ 路径/ 构建/ 算法/ 、/ 优先级/ 判定/ 算法/ 和/ 规则/ 集/ 终止/ 性/ 分析/ 算法/ ./ 最后/ 与/ 相关/ 分析方法/ 进行/ 比较/ ./ 本文/ 的/ 方法/ 能够/ 更/ 有效/ 地/ 检测/ 主动/ 规则/ 集/ 的/ 终止/ 性/ ,/ 并且/ 顾及/ 规则/ 执行/ 的/ 优先级/ ,/ 不/ 依赖于/ 具体/ 的/ 主动/ 数据库/ 实现/ 模型/ ,/ 复合/ 事件/ 、/ 复杂/ 条件/ 等/ 都/ 可以/ 很/ 方便/ 地/ 集成/ 于/ 该/ 方法/ ,/ 能够/ 适应/ 基于/ 主动/ 规则/ 的/ 其它/ 应用/ ./ 2/ 相关/ 工作/ 规则/ 的/ 终止/ 性/ 分析/ 目前/ 主要/ 有/ 两大类/ 方法/ :/ 静态/ 分析方法/ 和/ 动态分析/ 方法/ ./ 静态/ 分析方法/ 关注/ 于/ 提出/ 编译/ 时/ 保证/ 规则/ 集/ 终止/ 的/ 充分条件/ ,/ 动态分析/ 方法/ 则/ 通过/ 规则/ 执行/ 仿真/ 、/ 动态分析/ 方法/ 等/ 来/ 获取/ 运行/ 时/ 的/ 终止/ 性/ ./ 动态分析/ 也/ 称/ 运行/ 时/ 分析方法/ ,/ 需要/ 知道/ 数据库/ 的/ 内部/ 状态/ ,/ 分析/ 结果/ 也/ 只能/ 根据/ 测试/ 过/ 的/ 内部/ 数据库/ 状态/ 获得/ [/ 5/ -/ 7/ ]/ ./ 由于/ 该/ 方法/ 的/ 高昂/ 代价/ ,/ 在/ 商业/ 数据库/ 中/ 采取/ 的/ 是/ 比较简单/ 的/ 实现/ 方案/ ,/ 比如/ 可以/ 固定/ 规则/ 级联/ 的/ 深度/ 或者/ 指定/ 规则/ 执行/ 的/ 时间/ 来/ 控制/ 规则/ 终止/ ,/ 然而/ 这种/ 方法/ 无疑/ 会/ 回滚/ 掉/ 许多/ 本来/ 可以/ 终止/ 的/ 规则/ 事务/ ./ 本文/ 主要/ 关注/ 静态/ 分析/ ,/ 相关/ 研究/ 涉及面/ 广/ ./ Ray/ 等/ 人/ [/ 8/ ]/ 提出/ 的/ 使用/ 软件/ 规范/ 和/ 验证/ 的/ 自动/ 工具/ ,/ 如/ 符号/ 模型/ 检查/ 方法/ ,/ 将/ 规则/ 转化/ 为/ 一种/ 模型/ 检查/ 器/ 的/ 规范/ ,/ 然后/ 使用/ 模型/ 检查/ 器/ 通过/ 穷尽/ 搜索/ 检查/ 终止/ 性/ 是否/ 保持/ ;/ 有/ 学者/ 将/ 主动/ 规则/ 转化/ 为/ 形式化/ 逻辑/ 进行/ 推理/ 分析/ [/ 9/ ]/ ./ Baralis/ 等/ 人/ [/ 10/ ]/ 采用/ 代数/ 方法/ 对/ 转化/ 的/ 规则/ 进行/ 更强/ 的/ 终止/ 性/ 分析/ ,/ 但是/ 没有/ 考虑/ 触发/ 条件/ 的/ 影响/ ./ 另外/ Bailey/ 等/ 人/ 使用/ 抽象/ 解释/ 技术/ ,/ 基于/ 抽象/ 数据库/ 状态/ 来/ 对/ 主动/ 规则/ 的/ 执行/ 进行/ 仿真/ ,/ 如果/ 规则/ 在/ 抽象/ 状态/ 上/ 终止/ ,/ 则/ 真实/ 的/ 数据库/ 状态/ 也/ 可以/ 保证/ 终止/ [/ 5/ ]/ ./ 近几年/ ,/ Petri/ 网/ 理论/ 也/ 被/ 引入/ 到/ 规则/ 终止/ 性/ 分析方法/ 中/ ./ Li/ 介绍/ 了/ 将/ Petri/ 网/ 划分/ 为/ 多个/ 子网/ 负责/ ECA/ 规则/ 模型/ 的/ 各个/ 部分/ ,/ 分别/ 对应/ 于/ 激活/ 和/ 触发/ 状态/ ,/ 终止/ 性/ 分析/ 是/ 基于/ Petri/ 网/ 的/ 可达性/ 理论/ [/ 11/ ]/ ;/ 有/ 学者/ 对于/ 给定/ 任意/ 规则/ 集/ ,/ 构造/ 了/ 改进/ 的/ 谓词/ // 变迁/ 网/ ,/ 再/ 根据/ 该/ Petri/ 网/ 自动检测/ 出/ 循环/ 规则/ 集/ 、/ 不/ 一致/ 规则/ 集/ 和/ 矛盾/ 规则/ 集/ [/ 9/ ]/ ;/ Li/ 等/ 人/ [/ 11/ ]/ 基于/ 着色/ Petri/ 网对/ 主动/ 规则/ 行为/ 建模/ ,/ 采用/ Petri/ 网/ 理论/ 中/ 的/ 关联矩阵/ 来/ 检查/ 规/ Page3/ 则/ 集中/ 是否/ 存在/ 循环/ 路径/ ,/ 但/ 没有/ 考虑/ 规则/ 的/ 优先级/ ,/ Baha/ -/ hamed/ 等/ 人/ 对/ 该/ 方法/ 进行/ 了/ 扩展/ 以/ 支持/ 规则/ 优先级/ [/ 4/ ]/ ./ 上述/ 方法/ 都/ 是/ 通过/ 转化/ 的/ 策略/ ,/ 将/ 主动/ 规则/ 转化/ 到/ 另/ 一个/ 技术/ 比较/ 成熟/ 的/ 领域/ 来/ 解决/ 终止/ 性/ 分析/ 问题/ ./ 这些/ 方法/ 或者/ 在/ 转化/ 语义上/ 实现/ 复杂/ ,/ 或者/ 不够/ 直观/ ./ 大部分/ 静态/ 分析方法/ 研究/ 以/ Aiken/ 等/ 人/ [/ 12/ ]/ 定义/ 的/ 触发/ 图/ 概念/ 为/ 基础/ 进行/ 扩展/ 和/ 改进/ ./ Baralis/ 等/ 人/ [/ 7/ ]/ 通过/ 引入/ 激活/ 图/ 改善/ 了/ 触发/ 图/ 的/ 条件/ 分析/ 能力/ ./ 有/ 学者/ 提出/ 精化/ 触发/ 图/ 通过/ 对/ 触发/ 图中/ 触发/ 公式/ 的/ 分析/ ,/ 可以/ 得出/ 触发/ 图/ 继续/ 归约/ 的/ 算法/ [/ 9/ ]/ ./ 精化/ 触发/ 图/ 方法/ 的/ 改进/ 方法/ 如/ Lee/ 等/ 人/ [/ 13/ ]/ 提出/ 的/ 路径/ 删除/ 技术/ 和解/ 圈/ 技术/ ,/ 路径/ 删除/ 技术/ 解决/ 了/ 只/ 删除/ 一条/ 边/ 的/ 分析方法/ 的/ 不足/ ,/ 综合/ 考虑/ 规则/ 执行/ 路径/ ,/ 同时/ 考虑/ 了/ 可/ 更新/ 谓词/ // 属性/ 对/ 规则/ 终止/ 性/ 的/ 影响/ ,/ 采用/ 节点/ 分割/ 方法/ 删除/ 触发/ 图中/ 的/ 规则/ 路径/ ,/ 规则/ 归约/ 中/ 可以/ 删除/ 整条/ 路径/ 而/ 不是/ 一个/ 节点/ ./ 解圈/ 技术/ 对于/ 触发/ 图中/ 执行/ 次数/ 少于/ k/ 次/ 的/ 圈/ ,/ 构造/ 一个/ 等价/ 的/ 复制/ 节点/ 的/ 触发/ 图/ ,/ 这样/ 就/ 将/ 这个/ k/ 圈/ “/ 解开/ ”/ 并/ 进行/ 触发/ 图/ 归约/ ./ 关于/ 如何/ 计算/ 圈/ 的/ k/ 值/ ,/ 有/ 学者/ 提出/ 一种/ 基于/ 约束/ 的/ 方法/ 计算/ 圈/ 的/ 最大/ 迭代/ 次数/ [/ 9/ ]/ ./ 基于/ 精化/ 触发/ 图/ ,/ Couchot/ [/ 14/ ]/ 提出/ 了/ 一系列/ 的/ 改进/ 方法/ ,/ 通过/ 将/ 原始/ 的/ 触发/ 图/ 进行/ 分割/ ,/ 可以/ 删除/ 被/ 无限/ 次/ 触发/ 的/ 规则/ 节点/ ,/ 而且/ 该/ 节点/ 的/ 条件/ 也/ 可以/ 是/ 恒/ 真的/ ,/ 从而/ 检测/ 出新/ 的/ 终止/ 情况/ ;/ 也/ 提出/ 了/ 具有/ 复合/ 事件/ 的/ 主动/ 规则/ 的/ 静态/ 终止/ 性/ 分析/ 算法/ ,/ 扩展/ 了/ 触发/ 图/ ,/ 触发/ 图/ 节点/ 不仅仅/ 包括/ 规则/ ,/ 还/ 包括/ 事件/ ;/ 又/ 提出/ 复合/ 路径/ 的/ 概念/ ,/ 采用/ 处理/ 规则/ 的/ 路径/ 最大/ 序/ M/ 替换/ 传统/ 表示/ 圈/ 的/ 方法/ ./ 该/ 方法/ 对于/ 合取/ 事件/ 和/ 依次/ 事件/ 的/ 主动/ 规则/ 尤其/ 有效/ ./ 针对/ 规则/ 执行/ 优先级/ 问题/ ,/ Couchot/ 提出/ 一种/ 基于/ 触发/ 规则/ 及/ 路径/ 的/ 优先级/ 的/ 分析方法/ ./ 左万利/ 等/ 人/ [/ 15/ ]/ 引入/ 惰化图/ ,/ 提出/ 了/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ ,/ 但/ 该/ 算法/ 分析/ 结果/ 仍然/ 存在/ 保守/ 性/ ./ Xiong/ 等/ 人/ [/ 16/ ]/ 提出/ 为/ 有效/ 活化/ 路径/ 建立/ 条件/ 公式/ 的/ 思想/ ,/ 在/ 此基础/ 上/ 给出/ 处理/ 一个/ 新/ 的/ 主动/ 规则/ 终止/ 性/ 判定/ 方法/ ./ 郝/ 忠孝/ 等/ 人/ [/ 17/ ]/ 提出/ 了/ 判断/ 规则/ 集/ 活化/ 路径/ 的/ 同步/ 无限/ 次/ 执行/ 问题/ 的/ 方法/ ,/ 来/ 分析/ 终止/ 性/ ./ 熊伟/ 等/ 人/ [/ 9/ ]/ 采用/ 标注/ 事件/ 图/ 扩展/ Couchot/ 的/ 方法/ 并/ 应用/ 于/ 空间/ 数据库/ 主动/ 规则/ 终止/ 性/ 分析/ ./ 3/ 问题/ 描述/ 定义/ 1/ ./ 规则/ 集/ R/ =/ {/ ri/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ 是/ 所有/ 规则/ ri/ 的/ 有限/ 集合/ ,/ 规则/ ri/ 是/ 形如/ 〈/ Evt/ ,/ Cnd/ ,/ Act/ 〉/ 的/ 三元组/ ,/ 其中/ Evt/ 是/ 事件/ ,/ Cnd/ 是/ 条件/ ,/ Act/ 是/ 动作/ ./ 定义/ 2/ ./ 对于/ 任意/ 的/ ri/ ∈/ R/ ,/ pri/ (/ ri/ )/ 是/ 规则/ ri/ 的/ 优先级/ ,/ 它/ 是/ 一个/ 整数/ ./ 对/ 任意/ 的/ ri/ ,/ rj/ ∈/ R/ ,/ i/ ≠/ j/ ,/ 若/ pri/ (/ ri/ )/ >/ pri/ (/ rj/ )/ ,/ 则/ ri/ 优先/ rj/ 执行/ ;/ 反之/ ,/ 则/ rj/ 优先/ ri/ 执行/ ./ 尽管/ 分析方法/ 不同/ ,/ 规则/ 执行/ 模型/ 中/ 的/ 耦合/ 模式/ 也/ 不/ 一样/ ,/ 但是/ 主动/ 规则/ 的/ 处理/ 算法/ 是/ 相同/ 的/ ,/ 规则/ 处理/ 算法/ Rule/ _/ Process/ 的/ 自然语言/ 描述/ 如下/ :/ 1/ ./ 无规则/ 被/ 触发/ 则/ 退出/ ;/ 2/ ./ 令/ 被/ 触发/ 规则/ 的/ 集合/ 为/ RT/ ,/ / rj/ ∈/ RT/ ,/ j/ ≠/ i/ ,/ 若/ pri/ (/ ri/ )/ >/ pri/ (/ rj/ )/ ,/ 则/ 选择/ ri/ ;/ 3/ ./ 从/ 触发/ 规则/ 实例/ 集中/ 删除/ 选择/ 的/ 规则/ 实例/ ;/ 4/ ./ 计算/ ri/ 的/ 条件/ ,/ 若/ 条件/ 为/ 真/ ,/ 则/ 执行/ ri/ 的/ 动作/ ;/ 5/ ./ 转步/ 1/ ./ 基于/ 规则/ 执行/ 模型/ ,/ 相关/ 学者/ 提出/ 以下/ 定义/ ./ 定义/ 3/ ./ 规则/ 集/ R/ 的/ 触发/ 图/ (/ triggeringgraph/ )/ 为/ TG/ ,/ 它/ 是/ 由/ 〈/ R/ ,/ TE/ 〉/ 构成/ 的/ 有向图/ [/ 12/ ]/ ./ 图中/ 每个/ 结点/ 表示/ 规则/ ri/ ∈/ R/ ,/ 有/ 向/ 边/ 〈/ ri/ ,/ rj/ 〉/ ∈/ TE/ 为/ 触发/ 边/ ,/ 表示/ 规则/ ri/ 的/ 执行/ 产生/ 某/ 事件/ ,/ 该/ 事件/ 可能/ 触发/ 规则/ rj/ ./ 在/ 规则/ 的/ 触发/ 图中/ ,/ 触发/ 边用/ 带/ 箭头/ 的/ 实线/ 表示/ ./ 如果/ 一个/ 规则/ 的/ 执行/ 会/ 触发/ 自身/ ,/ 则/ 称之为/ 自/ 触发/ 规则/ ./ 定义/ 4/ ./ 规则/ 集/ R/ 的/ 活化/ 图/ (/ activationgraph/ )/ 为/ AG/ ,/ 它/ 是/ 由/ 〈/ R/ ,/ AE/ 〉/ 构成/ 的/ 有向图/ ./ 图中/ 每个/ 结点/ 表示/ 规则/ ri/ ∈/ R/ ,/ 有/ 向/ 边/ 〈/ ri/ ,/ rj/ 〉/ ∈/ AE/ 为/ 活化/ 边/ ,/ 表示/ 规则/ ri/ 的/ 执行/ 可能/ 会/ 使/ 规则/ rj/ 的/ 条件/ 为/ 真/ [/ 7/ ]/ ./ 在/ 规则/ 的/ 活化/ 图中/ ,/ 活化/ 边用/ 带/ 箭头/ 的/ 虚线/ 表示/ ./ 如果/ 一个/ 规则/ 的/ 执行/ 会/ 使/ 自身/ 的/ 条件/ 为/ 真/ ,/ 则/ 称之为/ 自/ 活化/ 规则/ ./ 定义/ 5/ ./ 规则/ 集/ R/ 的/ 惰化图/ (/ deactivationgraph/ )/ 为/ DG/ ,/ 它/ 是/ 由/ 〈/ R/ ,/ DE/ 〉/ 构成/ 的/ 有向图/ ./ 图中/ 每个/ 结点/ 表示/ 规则/ ri/ ∈/ R/ ,/ 有/ 向/ 边/ 〈/ ri/ ,/ rj/ 〉/ ∈/ DE/ 为/ 惰化边/ ,/ 表示/ 规则/ ri/ 的/ 执行/ 一定/ 使/ 规则/ rj/ 的/ 条件/ 为/ 假/ [/ 15/ ]/ ./ 在/ 规则/ 的/ 惰化/ 图中/ ,/ 惰化边/ 用/ 带/ 箭头/ 的/ 双/ 实线/ 表示/ ./ 如果/ 一个/ 规则/ 的/ 执行/ 使/ 自身/ 的/ 条件/ 为/ 假/ ,/ 则/ 称之为/ 自惰化/ 规则/ ./ 定义/ 6/ ./ 令/ 规则/ 集/ R/ 的/ 触发/ 图为/ TG/ =/ 〈/ R/ ,/ TE/ 〉/ ,/ 活化/ 图为/ AG/ =/ 〈/ R/ ,/ AE/ 〉/ ,/ 惰化/ 图为/ DG/ =/ 〈/ R/ ,/ DE/ 〉/ ,/ 则/ R/ 的/ 关联/ 图/ (/ relationshipgraph/ )/ 为/ RG/ =/ 〈/ R/ ,/ E/ 〉/ ,/ 其中/ R/ 为/ 所有/ 规则/ 结点/ 的/ 集合/ ,/ E/ =/ TE/ ∪/ AE/ ∪/ DE/ 是/ 所有/ 边/ 的/ 集合/ [/ 15/ ]/ ./ 定义/ 7/ ./ 规则/ r/ 由/ 规则/ 集/ R/ 直接/ 触发/ 可达/ 是/ Page4/ 指/ ,/ / r/ ∈/ R/ ,/ r/ 触发/ r/ ./ 规则/ r/ 由/ 规则/ 集/ R/ 触发/ 可达/ 是/ 指/ ,/ r/ 由/ R/ 直接/ 触发/ 可/ 达/ ,/ 或/ / r/ ,/ r/ 触发/ r/ 且/ r/ 由/ R/ 触发/ 可达/ ./ 令/ ri/ ,/ rj/ ∈/ R/ ,/ 由/ 规则/ ri/ 到/ 规则/ rj/ 的/ 触发/ 可达集/ tr/ (/ ri/ ,/ rj/ )/ 是/ 规则/ 集/ R/ 的/ 一个/ 子集/ ,/ 其中/ 包含/ rj/ 但/ 不/ 包含/ ri/ ,/ 它/ 满足/ 如下/ 特性/ :/ (/ 1/ )/ 使用/ 规则/ 集/ tr/ (/ ri/ ,/ rj/ )/ ,/ 由/ ri/ 触发/ 可达/ rj/ ;/ (/ 2/ )/ tr/ (/ ri/ ,/ rj/ )/ 是/ 最小/ 的/ ,/ 即/ 删除/ tr/ (/ ri/ ,/ rj/ )/ 中/ 的/ 任一/ 规则/ ,/ 性质/ (/ 1/ )/ 不再/ 成立/ ./ 由/ 规则/ ri/ 到/ 规则/ rj/ 的/ 触发/ 可达集/ 可能/ 不止/ 一个/ ,/ 这些/ 可达集/ 的/ 集合/ 记为/ Str/ (/ ri/ ,/ rj/ )/ ./ 定义/ 8/ ./ 触发/ 可达集/ 的/ tr/ (/ ri/ ,/ rj/ )/ 的/ 制约/ 优先级/ 是/ 指/ tr/ (/ ri/ ,/ rj/ )/ 中/ 所有/ 规则/ 的/ 最小/ 优先级/ ./ 触发/ 可达集/ 集合/ Str/ (/ ri/ ,/ rj/ )/ 中/ 的/ 最大/ 和/ 最小/ 制约/ 优先级/ 分别/ 记为/ pmax/ 定义/ 9/ ./ 令/ 规则/ 集/ R/ 的/ 触发/ 图为/ TG/ =/ 〈/ R/ ,/ TE/ 〉/ ,/ 若/ / r1/ ,/ r2/ ,/ …/ ,/ rk/ ∈/ R/ ,/ 〈/ r1/ ,/ r2/ 〉/ ∈/ TE/ ,/ 〈/ r2/ ,/ r3/ 〉/ ∈/ TE/ ,/ …/ ,/ 〈/ rk/ ,/ r1/ 〉/ ∈/ TE/ ,/ 则/ 称/ ρ/ =/ (/ r1/ ,/ r2/ ,/ …/ ,/ rk/ )/ 为/ TG/ 的/ 一个/ 触发/ 环/ ./ 触发/ 环/ ρ/ 上/ 所有/ 规则/ 的/ 集合/ 记为/ C/ ρ/ ./ 定义/ 10/ ./ 令/ ρ/ 为/ 一个/ 触发/ 环/ ,/ r/ / C/ ρ/ ,/ r/ 由/ C/ ρ/ 触发/ 可/ 达/ ,/ / rc/ ∈/ C/ ρ/ ,/ tr/ (/ rc/ ,/ r/ )/ ≠/ / 且/ tr/ (/ rc/ ,/ r/ )/ ∩/ C/ ρ/ =/ / ,/ 则/ 称/ rc/ 为/ r/ 与/ ρ/ 的/ 交点/ 规则/ ./ 即/ r/ 与/ ρ/ 的/ 交点/ 规则/ rc/ 位于/ 触发/ 环/ ρ/ 上/ ,/ 且/ 由/ rc/ 出发/ 不/ 经过/ ρ/ 上/ 的/ 其它/ 规则/ 触发/ 可达/ r/ ./ 基于/ 上述/ 定义/ ,/ 通过/ 分析/ 关联/ 图/ 的/ 特征/ ,/ 可以/ 对/ 规则/ 集/ 终止/ 性/ 进行/ 判定/ ./ 如/ :/ 基于/ 触发/ 图/ 和/ 活化/ 图/ 、/ 触发/ 环/ 和/ 活化/ 环是/ 主动/ 规则/ 集/ 呈现/ 非/ 终止/ 行为/ 的/ 必要条件/ [/ 7/ ]/ ./ 即/ 对于/ 任意/ ri/ ∈/ R/ ,/ 若/ 不/ 存在/ 与/ 之/ 相连/ 的/ 触发/ 边/ 或/ 活化/ 边/ ,/ 则/ ri/ 不会/ 执行/ 多次/ ,/ 连同/ 其/ 相关/ 边/ 可/ 在/ 关联/ 图中/ 去掉/ ,/ 这个/ 步骤/ 即/ 规则/ 集/ 的/ 基本/ 归约/ 算法/ Basic/ _/ Reduce/ ,/ 如果/ 规则/ 集/ 能够/ 归约/ 为空/ ,/ 那么/ 表明/ 其/ 行为/ 能够/ 终止/ ./ 4/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 4.1/ 关联/ 图/ 算法/ 保守/ 性/ 分析/ 文献/ [/ 15/ ]/ 提出/ 了/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ ,/ 但/ 对/ 禁止/ 触发/ 环/ 的/ 定义/ 中/ 条件/ 不够/ 充分/ ,/ 没有/ 明确/ 惰化/ 规则/ ./ 本文/ 在/ 此基础/ 上/ 进行/ 改进/ ,/ 并/ 分析/ 该/ 算法/ 的/ 保守/ 性/ ./ 定义/ 11/ ./ 令/ ρ/ 为/ 不可/ 归约/ 集/ R/ 上/ 的/ 一个/ 触发/ 环/ ,/ ro/ ∈/ C/ ρ/ ,/ 〈/ ro/ ,/ ro/ 〉/ ∈/ DE/ ,/ rt/ ∈/ C/ ρ/ ,/ 〈/ rt/ ,/ ro/ 〉/ ∈/ TE/ ,/ 〈/ rt/ ,/ ro/ 〉/ / AE/ ,/ 即/ ro/ 为/ 环上/ 的/ 一个/ 自惰化/ 规则/ ,/ rt/ 为/ 环上/ 触发/ 但/ 不/ 活化/ ro/ 的/ 规则/ ./ / ra/ ∈/ R/ ,/ 〈/ ra/ ,/ ro/ 〉/ ∈/ AE/ ,/ tr/ (/ ro/ ,/ ra/ )/ ≠/ / 即/ ra/ 由/ ro/ 触发/ 可/ 达/ ,/ 当/ 满足/ 以下/ 条件/ 之一/ 成立/ 时/ ,/ 称/ ro/ 为/ 被/ 禁止/ 的/ 规则/ ,/ 并称/ ρ/ 为/ 被/ 禁止/ 的/ 触发/ 环/ :/ (/ 1/ )/ ra/ ∈/ C/ ρ/ ,/ / rd/ ∈/ C/ ρ/ ,/ 〈/ rd/ ,/ ro/ 〉/ ∈/ DE/ ,/ 使/ ρ/ 呈/ (/ ro/ ,/ …/ ,/ ra/ ,/ …/ ,/ rd/ ,/ …/ ,/ rt/ )/ 形式/ ;/ (/ 2/ )/ ra/ / C/ ρ/ ,/ 令/ rc/ 为/ ra/ 与/ ρ/ 的/ 交点/ 规则/ ,/ / rd/ ∈/ C/ ρ/ ,/ 〈/ rd/ ,/ ro/ 〉/ ∈/ DE/ ,/ 使/ 触发/ 环/ ρ/ 的/ 形式/ 为/ (/ ro/ ,/ …/ ,/ rc/ ,/ …/ ,/ rd/ ,/ …/ ,/ rt/ )/ ,/ 且/ pmax/ (/ 3/ )/ ra/ / C/ ρ/ ,/ 令/ rc/ 为/ ra/ 与/ ρ/ 的/ 交点/ 规则/ ,/ pmaxc/ -/ t/ 且/ pmaxpmin/ 定理/ 1/ ./ 对于/ 不可/ 归约/ 集/ R/ ,/ 如果/ 由于/ 拓扑/ 结构/ 和/ 优先级/ 别的/ 设置/ 使得/ R/ 上/ 的/ 所有/ 触发/ 环都/ 被/ 禁止/ ,/ 则/ 仅/ 由/ R/ 确定/ 的/ 规则/ 集/ 不会/ 呈现/ 非/ 终止/ 行为/ [/ 15/ ]/ ./ 相应/ 的/ 终止/ 性/ 分析/ 算法/ 如下/ ./ 算法/ 1/ ./ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ Termination/ _/ RG/ ./ 输入/ :/ 关联/ 图/ G/ =/ 〈/ R/ ,/ E/ 〉/ 输出/ :/ 非/ 被/ 禁止/ 的/ 触发/ 环/ 及其/ 可达/ 的/ 边/ beginforeach/ ρ/ i/ ∈/ G/ 标记/ 为/ 非/ 被/ 禁止/ ;/ foreach/ ρ/ i/ ∈/ Gdoforall/ 没/ 被/ 禁止/ 的/ ρ/ ireturn/ (/ ρ/ i/ 是/ 没/ 被/ 禁止/ 的/ 触发/ 环/ )/ ;/ end/ 例/ 1/ ./ 考虑/ 如图/ 1/ 所示/ 的/ 规则/ 集/ R/ ,/ 该/ 规则/ 集/ 不可/ 用/ 基本/ 归约/ 算法/ 归约/ ,/ 是/ 不可/ 归约/ 集/ ./ Page5R/ 包含/ 3/ 个/ 触发/ 环/ :/ ρ/ 1/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ )/ ,/ ρ/ 2/ =/ (/ r6/ ,/ r7/ ,/ r8/ ,/ r9/ ,/ r10/ ,/ r11/ )/ ,/ ρ/ 3/ =/ (/ r19/ ,/ r15/ ,/ r16/ ,/ r17/ ,/ r18/ )/ ./ 令/ / ri/ ∈/ R/ ,/ pri/ (/ ri/ )/ =/ i/ ,/ 且/ ri/ 是/ 自/ 惰化/ 规则/ ,/ 则/ 对/ ρ/ 1/ :/ ro/ =/ r1/ ,/ ra/ =/ r5/ ,/ rt/ =/ r5/ ,/ / rd/ =/ r4/ ,/ ρ/ 1/ 呈/ (/ ro/ ,/ …/ ,/ ra/ ,/ …/ ,/ rd/ ,/ …/ ,/ rt/ )/ 形式/ ,/ 满足/ 定义/ 11/ 的/ 条件/ (/ 1/ )/ ,/ r1/ 是/ 被/ 禁止/ 的/ 规则/ ,/ ρ/ 1/ 是/ 被/ 禁止/ 的/ 触发/ 环/ ;/ 对/ ρ/ 2/ :/ ro/ =/ r6/ ,/ ra/ =/ r12/ ,/ rt/ =/ r11/ ,/ rc/ =/ r7/ 是/ ra/ 与/ ρ/ 2/ 的/ 交点/ 规则/ ,/ ρ/ 2/ 呈/ (/ ro/ ,/ …/ ,/ rc/ ,/ …/ ,/ rd/ ,/ …/ ,/ rt/ )/ 形式/ ,/ 且/ Str/ (/ r7/ ,/ r9/ )/ =/ {/ {/ r8/ ,/ r9/ }/ }/ ,/ pmaxc/ -/ a/ =/ pminpmin/ 禁止/ 的/ 规则/ ,/ ρ/ 2/ 是/ 被/ 禁止/ 的/ 触发/ 环/ ;/ 对/ ρ/ 3/ :/ ro/ =/ r19/ ,/ ra/ =/ r13/ ,/ rt/ =/ r18/ ,/ rc/ =/ r15/ 是/ ra/ 与/ ρ/ 3/ 的/ 交点/ 规则/ ,/ Str/ (/ r15/ ,/ r13/ )/ =/ {/ {/ r14/ ,/ r13/ }/ }/ ,/ pmaxStr/ (/ r15/ ,/ r18/ )/ =/ {/ {/ r16/ ,/ r17/ ,/ r18/ }/ }/ ,/ pminc/ -/ a/ </ pminpmax/ 禁止/ 的/ 规则/ ,/ ρ/ 3/ 是/ 被/ 禁止/ 的/ 触发/ 环/ ./ 综上/ ,/ 根据/ 算法/ 1/ 分析/ 可知/ R/ 是/ 可/ 终止/ 的/ 规则/ 集/ ./ 根据/ 重新/ 定义/ 的/ 有限/ 触发/ 环/ ,/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ 分析/ 结果/ 比/ 基本/ 归约/ 算法/ 更/ 精确/ ,/ 但/ 仍/ 存在/ 一定/ 的/ 保守/ 性/ ./ 即/ 由/ 该/ 算法/ 分析/ 可/ 终止/ 的/ 规则/ 集/ 一定/ 不/ 存在/ 非/ 终止/ 行为/ ,/ 然而/ ,/ 存在/ 非/ 有限/ 触发/ 环/ 的/ 规则/ 集/ 也/ 有/ 可能/ 终止/ ./ 如例/ 2/ 所示/ ./ pri/ (/ ri/ )/ =/ i/ ,/ 其/ 关联/ 图如图/ 2/ 所示/ ./ 例/ 2/ ./ 令/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r6/ }/ ,/ 该/ 规则/ 集是/ 不可/ 归约/ 集/ ,/ 且/ 不/ 满足/ 文献/ [/ 15/ ]/ 中/ 禁止/ 触发/ 环/ 的/ 任一/ 条件/ ,/ 故由/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 修正/ 算法/ 不能/ 判定/ R/ 是非/ 终止/ 的/ ./ 但是/ ,/ 我们/ 按/ 以下/ 步骤/ 分析/ :/ r3/ 的/ 执行/ 活化/ r1/ 并/ 活化/ 触发/ r4/ ;/ r4/ 的/ 执行/ 同时/ 活化/ 触发/ r5/ 和/ r6/ ;/ 由于/ pri/ (/ r6/ )/ >/ pri/ (/ r5/ )/ ,/ 先/ 执行/ r6/ ,/ r6/ 的/ 执行/ 惰化/ r1/ ;/ 再/ 执行/ r5/ ,/ r5/ 的/ 执行/ 触发/ r1/ ,/ 此时/ r1/ 条件/ 为/ 假/ 不会/ 执行/ ./ 因此/ ,/ 规则/ r1/ 不会/ 多次/ 执行/ ,/ 该/ 规则/ 集/ R/ 是/ 可以/ 终止/ 的/ ./ 因此/ ,/ 在/ 基于/ 关联/ 图/ 的/ 修正/ 算法/ 基础/ 上/ ,/ 为了/ 提高/ 规则/ 集/ 终止/ 性/ 分析/ 的/ 精确性/ ,/ 引入/ 触发/ 路径/ ,/ 并/ 提出/ 基于/ 触发/ 路径/ 的/ 主动/ 规则/ 集/ 终止/ 性/ 分析/ 算法/ ./ 4.2/ 触发/ 路径/ 相关/ 定义/ 为了/ 表达/ 规则/ 集中/ 两个/ 规则/ 之间/ 的/ 触发/ 关系/ ,/ 本文/ 提出/ 了/ 触发/ 路径/ 等/ 概念/ ,/ 并/ 提出/ 触发/ 路径/ 构建/ 算法/ 和/ 触发/ 路径/ 的/ 优先级/ 判定/ 算法/ ./ 定义/ 12/ ./ 令/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rN/ }/ ,/ 若/ 〈/ ri/ ,/ ri/ +/ 1/ 〉/ ∈/ TE/ ,/ 〈/ ri/ +/ 1/ ,/ ri/ +/ 2/ 〉/ ∈/ TE/ ,/ …/ ,/ 〈/ rj/ -/ 1/ ,/ rj/ 〉/ ∈/ TE/ ,/ i/ ≠/ j/ ,/ 则/ 存在/ 一条/ ri/ 到/ rj/ 的/ 触发/ 路径/ tpath/ (/ ri/ ,/ rj/ )/ =/ (/ ri/ ,/ ri/ +/ 1/ ,/ ri/ +/ 2/ ,/ …/ ,/ rj/ -/ 1/ ,/ rj/ )/ ./ 规则/ ri/ 到/ rj/ 的/ 触发/ 路径/ 可能/ 不止/ 一条/ ,/ 称/ 这些/ 路径/ 的/ 集合/ 为/ ri/ 到/ rj/ 的/ 触发/ 路径/ 集/ ,/ 记为/ Stpath/ (/ ri/ ,/ rj/ )/ ./ 若/ 触发/ 路径/ tpath/ (/ ri/ ,/ rj/ )/ 的/ 所有/ 规则/ 顶点/ 都/ 不/ 重复/ 出现/ ,/ 则/ 称/ 该/ 触发/ 路径/ 为/ 简单/ 触发/ 路径/ ,/ 否则/ 称/ 复合/ 触发/ 路径/ ./ 显然/ ,/ 复合/ 触发/ 路径/ 构成/ 触发/ 环/ ./ 定义/ 13/ ./ 考虑/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rN/ }/ ,/ 若/ :/ tpath/ (/ rm/ ,/ rn/ )/ =/ (/ rm/ ,/ rm/ +/ 1/ ,/ …/ ,/ rn/ -/ 1/ ,/ rn/ )/ ,/ m/ ,/ n/ </ N/ ,/ tpath/ (/ ri/ ,/ rj/ )/ =/ (/ ri/ ,/ …/ ,/ rm/ ,/ rm/ +/ 1/ ,/ …/ ,/ rn/ -/ 1/ ,/ rn/ ,/ …/ ,/ rj/ )/ ,/ i/ ,/ j/ </ N/ ,/ 则/ 称/ 触发/ 路径/ tpath/ (/ rm/ ,/ rn/ )/ 包含/ 于/ 触发/ 路径/ tpath/ (/ ri/ ,/ rj/ )/ ,/ 记为/ tpath/ (/ rm/ ,/ rn/ )/ / tpath/ (/ ri/ ,/ rj/ )/ ./ 若/ tpath/ (/ rm/ ,/ rn/ )/ / tpath/ (/ ri/ ,/ rj/ )/ ,/ tpath/ (/ ri/ ,/ rj/ )/ / tpath/ (/ rm/ ,/ rn/ )/ ,/ 则/ 称/ 触发/ 路径/ tpath/ (/ rm/ ,/ rn/ )/ 和/ 触发/ 路径/ tpath/ (/ ri/ ,/ rj/ )/ 完全/ 重合/ ./ 记为/ tpath/ (/ rm/ ,/ rn/ )/ =/ tpath/ (/ ri/ ,/ rj/ )/ ./ 定义/ 14/ ./ 考虑/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rN/ }/ ,/ 若/ :/ tpath/ (/ ri/ ,/ rj/ )/ =/ (/ ri/ ,/ ri/ +/ 1/ ,/ …/ ,/ rs/ ,/ rm/ ,/ …/ ,/ rj/ )/ ,/ tpath/ (/ ri/ ,/ rk/ )/ =/ (/ ri/ ,/ ri/ +/ 1/ ,/ …/ ,/ rs/ ,/ rn/ …/ ,/ rk/ )/ ,/ 即/ 这/ 两条路/ 径自/ rs/ 之前/ 的/ 路径/ 相同/ ,/ rs/ 之后/ 的/ 路径/ 不同/ ,/ 记为/ tpath/ (/ ri/ ,/ rj/ )/ ∧/ path/ (/ ri/ ,/ rk/ )/ =/ (/ ri/ ,/ …/ ,/ rs/ )/ ,/ 则/ 称/ rs/ 为/ 触发/ 路径/ tpath/ (/ ri/ ,/ rj/ )/ 和/ tpath/ (/ ri/ ,/ rk/ )/ 的/ 分离点/ ./ 若/ rs/ =/ ri/ ,/ 则/ 称/ tpath/ (/ ri/ ,/ rj/ )/ 和/ tpath/ (/ ri/ ,/ rk/ )/ 分离/ ;/ 若/ rs/ ≠/ ri/ ,/ 则/ 称/ tpath/ (/ ri/ ,/ rj/ )/ 和/ tpath/ (/ ri/ ,/ rk/ )/ 部分/ 分离/ ./ 令/ 规则/ 集/ R/ 的/ 触发/ 图为/ TG/ ,/ 则/ 由/ vo/ 到/ vt/ 的/ 触发/ 路径/ tpath/ (/ ro/ ,/ rt/ )/ 可/ 由/ 以下/ 算法/ 得出/ ./ 算法/ 2/ ./ 触发/ 路径/ 构建/ 算法/ Build/ _/ TP/ ./ 输入/ :/ 触发/ 图/ TG/ ,/ 出发/ 规则/ ro/ ,/ 目标/ 规则/ rt/ 输出/ :/ 触发/ 路径/ 集/ Lbeginlo/ ·/ ·/ =/ ro/ ;/ visited/ [/ ro/ ]/ ·/ ·/ =/ TRUE/ ;/ ifro/ =/ rtthenaddlotoL/ ;/ w/ ·/ ·/ =/ FIRSTADJ/ (/ TG/ ,/ ro/ )/ ;/ // // 找/ 邻接/ 点/ Page6end/ 定理/ 2/ ./ 算法/ 2/ 是/ 正确/ 的/ ,/ 可/ 终止/ 的/ ,/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ./ 其中/ n/ 为/ 触发/ 图/ 节点/ 个数/ ./ 证明/ ./ 正确性/ ./ 该/ 算法/ 从/ 规则/ ro/ 出发/ 进行/ 深度/ 优先/ 遍历/ ,/ 当/ 访问/ 到/ rt/ 时/ 找到/ 一条/ 触发/ 路径/ 并/ 存储/ ,/ 存储/ 的/ 路径/ 满足/ 定义/ 12/ ,/ 而且/ 由于/ 是/ 遍历/ ,/ 所以/ 所有/ 路径/ 都/ 会/ 被/ 找到/ ,/ 故/ 算法/ 是/ 正确/ 的/ ./ 可/ 终止/ 性/ ./ 该/ 算法/ 的/ 主要/ 步骤/ 是/ 由/ 一个/ 规则/ 出发/ 进行/ 深度/ 优先/ 遍历/ ,/ 由于/ 规则/ 集/ 有限/ ,/ 算法/ 是/ 可/ 终止/ 的/ ./ 时间/ 复杂度/ ./ 遍历/ 过程/ 的/ 实质/ 是/ 对/ 每个/ 顶点/ 查找/ 其/ 邻接/ 点/ ,/ 耗费/ 的/ 时间/ 取决于/ 所/ 采用/ 的/ 存储/ 结构/ ./ 仍/ 采用/ 邻接矩阵/ 作为/ 触发/ 图/ 的/ 存储/ 结构/ ,/ 找/ 邻接/ 点/ 所/ 需/ 时间/ 为/ O/ (/ n2/ )/ ,/ 其中/ n/ 为/ 触发/ 图/ 节点/ 个数/ ./ 综上/ ,/ 算法/ 2/ 是/ 正确/ 的/ ,/ 可/ 终止/ 的/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ./ 定义/ 15/ ./ 考虑/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ …/ ,/ rN/ }/ ,/ 存在/ ro/ 至/ ri/ 和/ rj/ 的/ 触发/ 路径/ tpath/ (/ ro/ ,/ ri/ )/ 和/ tpath/ (/ ro/ ,/ rj/ )/ ,/ i/ ≠/ j/ ,/ 当/ 满足/ 下列/ 条件/ 之一/ 时/ ,/ 称/ tpath/ (/ ro/ ,/ ri/ )/ 的/ 优先级/ 高于/ tpath/ (/ ro/ ,/ rj/ )/ ,/ 记为/ p/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ ro/ ,/ rj/ )/ )/ :/ (/ 1/ )/ tpath/ (/ ro/ ,/ ri/ )/ / tpath/ (/ ro/ ,/ rj/ )/ ,/ 即/ tpath/ (/ ro/ ,/ ri/ )/ 包含/ 于/ tpath/ (/ ro/ ,/ rj/ )/ ;/ (/ 2/ )/ 若/ tpath/ (/ ro/ ,/ ri/ )/ 和/ tpath/ (/ ro/ ,/ rj/ )/ 分离/ ,/ pmaxo/ -/ i/ ;/ pmin/ (/ 3/ )/ 若/ 触发/ 路径/ tpath/ (/ ro/ ,/ ri/ )/ 和/ tpath/ (/ ro/ ,/ rj/ )/ 部分/ 分离/ ,/ 它们/ 的/ 分离点/ 为/ rs/ ,/ 且/ p/ (/ tpath/ (/ rs/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ rs/ ,/ rj/ )/ )/ ./ 定理/ 3/ ./ 令/ 规则/ ro/ 至/ ri/ 和/ rj/ 的/ 触发/ 路径/ 集为/ S1/ =/ Stpath/ (/ ro/ ,/ ri/ )/ 和/ S2/ =/ Stpath/ (/ ro/ ,/ rj/ )/ ,/ 若/ / tpath/ (/ ro/ ,/ ri/ )/ ∈/ S1/ ,/ tpath/ (/ ro/ ,/ rj/ )/ ∈/ S2/ ,/ 有/ p/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ ro/ ,/ rj/ )/ )/ ,/ 则/ ri/ 将/ 优先/ 于/ rj/ 被/ ro/ 触发/ 执行/ ,/ 记为/ ptr/ (/ ro/ ,/ ri/ )/ >/ ptr/ (/ ro/ ,/ rj/ )/ ./ 证明/ ./ 首先/ 证明/ 若/ p/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ ro/ ,/ rj/ )/ )/ ,/ 则/ 在/ 只/ 考虑/ 这/ 两条/ 触发/ 路径/ 的/ 情况/ 下/ ,/ ri/ 优先/ 于/ rj/ 被/ ro/ 触发/ 执行/ ./ 按/ 定义/ 4/ 分/ 3/ 种/ 情况/ 考虑/ :/ (/ 1/ )/ tpath/ (/ ro/ ,/ ri/ )/ / tpath/ (/ ro/ ,/ rj/ )/ ,/ 则/ rj/ 的/ 触发/ 依/ (/ 2/ )/ pmax/ 赖于/ ri/ 的/ 执行/ ,/ 故/ ri/ 优先/ 于/ rj/ 被/ ro/ 触发/ 执行/ ;/ 执行/ ;/ (/ 3/ )/ 由于/ 分离点/ 为/ rs/ ,/ ri/ 和/ rj/ 的/ 触发/ 都/ 依赖于/ rs/ 的/ 执行/ ,/ 又/ 由于/ p/ (/ tpath/ (/ rs/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ rs/ ,/ rj/ )/ )/ ,/ ri/ 优先/ 于/ rj/ 被/ rs/ 触发/ 执行/ ,/ 故/ ri/ 优先/ 于/ rj/ 被/ ro/ 触发/ 执行/ ./ 然后/ 用/ 反证法/ ./ 假设/ rj/ 优先/ 于/ ri/ 被/ ro/ 触发/ ,/ 则/ 存在/ 两条/ 路径/ tpath/ (/ ro/ ,/ ri/ )/ ∈/ S1/ 和/ tpath/ (/ ro/ ,/ rj/ )/ ∈/ S2/ ,/ p/ (/ tpath/ (/ ro/ ,/ rj/ )/ )/ >/ p/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ ,/ 这/ 与/ 条件/ 矛盾/ ,/ 故/ 假设/ 不/ 成立/ ./ 综上/ ,/ 若/ / tpath/ (/ ro/ ,/ ri/ )/ ∈/ S1/ ,/ tpath/ (/ ro/ ,/ rj/ )/ ∈/ S2/ ,/ 有/ p/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ >/ p/ (/ tpath/ (/ ro/ ,/ rj/ )/ )/ ,/ 则/ ri/ 将/ 优先/ 于/ rj/ 被/ ro/ 触发/ ./ 需要/ 说明/ 的/ 是/ ,/ 对于/ 包含/ 触发/ 环/ 的/ 复合/ 路径/ ,/ 假设/ 复合/ 路径/ 为/ tpath/ (/ r1/ ,/ …/ ,/ ri/ ,/ rj/ ,/ r1/ …/ rn/ )/ ,/ 则/ 由于/ tpath/ (/ r1/ ,/ …/ ,/ ri/ ,/ rj/ ,/ r1/ )/ / tpath/ (/ r1/ ,/ …/ ,/ ri/ ,/ rj/ ,/ r1/ …/ rn/ )/ ,/ 所以/ ptr/ (/ r1/ ,/ …/ ,/ ri/ ,/ rj/ ,/ r1/ )/ >/ ptr/ (/ r1/ ,/ …/ ,/ ri/ ,/ rj/ ,/ r1/ ,/ …/ ,/ rn/ )/ ./ 因此/ 在/ 终止/ 性/ 分析/ 时/ 只/ 需要/ 考虑/ 其中/ 触发/ 环/ 部分/ 即可/ ,/ 对于/ 含/ 多个/ 触发/ 环/ 的/ 复合/ 路径/ ,/ 要/ 一一/ 判断/ ./ 算法/ 3/ ./ 触发/ 路径/ 的/ 优先级/ 判定/ 算法/ Deter/ -/ mination/ _/ Priority/ ./ 输入/ :/ G/ =/ 〈/ R/ ,/ E/ 〉/ ,/ ro/ ,/ ri/ ,/ rj/ 输出/ :/ TRUE/ 表示/ 规则/ ri/ 优先/ rj/ 被/ ro/ 触发/ ;/ FALSE/ 表/ beginS1/ ·/ ·/ =/ 0/ ;/ S2/ ·/ ·/ =/ 0/ ;/ Build/ _/ TP/ (/ TG/ ,/ ro/ ,/ ri/ ,/ S1/ )/ ;/ Build/ _/ TP/ (/ TG/ ,/ ro/ ,/ rj/ ,/ S2/ )/ ;/ result/ ·/ ·/ =/ TRUE/ ;/ {/ foreachp/ (/ tpath/ (/ ro/ ,/ ri/ )/ )/ ∈/ S1/ }/ return/ (/ result/ )/ ;/ end/ 根据/ 定理/ 3/ 可知/ 该/ 算法/ 是/ 正确/ 的/ ./ 算法/ 主要/ 步骤/ 是/ 分别/ 从/ 两个/ 触发/ 路径/ 集中/ 取/ 触发/ 路径/ 进行/ 对比/ ,/ 由于/ 触发/ 路径/ 集/ 有限/ ,/ 所以/ 触发/ 路径/ 的/ 个数/ 也/ 是/ 有限/ 的/ ,/ 故该/ 算法/ 可以/ 终止/ ./ 设/ n/ 为/ 触发/ 环/ 中/ 规则/ 的/ Page7/ 个数/ ,/ 构造/ 触发/ 路径/ 集/ 的/ 时间/ 复杂性/ 为/ O/ (/ n2/ )/ ,/ 比较/ 触发/ 路径/ 优先级/ 的/ 时间/ 复杂性/ 为/ O/ (/ n2/ )/ ,/ 故该/ 算法/ 的/ 时间/ 复杂性/ 为/ O/ (/ n2/ )/ ./ 4.3/ 基于/ 触发/ 路径/ 主动/ 规则/ 集/ 终止/ 性/ 分析/ 定义/ 16/ ./ 考虑/ 不可/ 归约/ 集/ R/ ,/ 令/ ρ/ 为/ R/ 上/ 的/ 一个/ 触发/ 环/ ,/ ro/ ∈/ C/ ρ/ ,/ rt/ ∈/ C/ ρ/ ,/ 〈/ rt/ ,/ ro/ 〉/ ∈/ TE/ ,/ 〈/ rt/ ,/ ro/ 〉/ / AE/ ,/ 即/ rt/ 为/ 环上/ 触发/ 但/ 不/ 活化/ ro/ 的/ 规则/ ;/ / ra/ ∈/ R/ ,/ 〈/ ra/ ,/ ro/ 〉/ ∈/ AE/ ,/ 〈/ ra/ ,/ ro/ 〉/ / TE/ ,/ tr/ (/ ro/ ,/ ra/ )/ ≠/ / 即/ ra/ 由/ ro/ 触发/ 可/ 达/ ;/ / rd/ ∈/ R/ ,/ 〈/ rd/ ,/ ro/ 〉/ ∈/ DE/ ,/ tr/ (/ ro/ ,/ rd/ )/ ≠/ / 即/ rd/ 由/ ro/ 触发/ 可达/ ./ 当/ 满足/ 下列/ 条件/ 之一/ 时/ ,/ 称/ ro/ 为/ 有限/ 规则/ ,/ 并称/ ρ/ 为/ 有限/ 触发/ 环/ :/ o/ -/ a/ </ pri/ (/ ro/ )/ ./ pmax/ 环/ ,/ 如果/ ρ/ 是/ 有限/ 触发/ 环/ ,/ 则/ R/ 具有/ 可/ 终止/ 性/ ./ (/ 1/ )/ ptr/ (/ ro/ ,/ ra/ )/ >/ ptr/ (/ ro/ ,/ rd/ )/ >/ ptr/ (/ ro/ ,/ rt/ )/ ;/ (/ 2/ )/ ptr/ (/ ro/ ,/ rd/ )/ >/ ptr/ (/ ro/ ,/ rt/ )/ >/ ptr/ (/ ro/ ,/ ra/ )/ ,/ 且/ 定理/ 4/ ./ 令/ ρ/ 为/ 不可/ 归约/ 集/ R/ 上/ 唯一/ 的/ 触发/ 证明/ ./ 分/ 情况/ 证明/ :/ (/ 1/ )/ 由于/ ptr/ (/ ro/ ,/ ra/ )/ >/ ptr/ (/ ro/ ,/ rd/ )/ >/ ptr/ (/ ro/ ,/ rt/ )/ ,/ 故/ ra/ 优先/ 于/ rd/ 被/ ro/ 触发/ 执行/ ,/ rd/ 优先/ 于/ rt/ 被/ ro/ 触发/ 执行/ ,/ 所以/ ro/ 先/ 被/ 活化/ ,/ 再/ 被/ 惰化/ ,/ 再/ 被/ 触发/ ,/ ro/ 不会/ 多次/ 执行/ ,/ 故则/ R/ 具有/ 可/ 终止/ 性/ ./ (/ 2/ )/ 由于/ ptr/ (/ ro/ ,/ rd/ )/ >/ ptr/ (/ ro/ ,/ rt/ )/ >/ ptr/ (/ ro/ ,/ ra/ )/ ,/ 故/ rd/ 优先/ 于/ rt/ 被/ ro/ 触发/ 执行/ ,/ rt/ 优先/ 于/ ra/ 被/ ro/ 触发/ 执行/ ,/ ro/ 先/ 被/ 惰化/ ,/ 再/ 被/ 触发/ ,/ 再/ 被/ 活化/ ;/ 又/ 由于/ o/ -/ a/ </ pri/ (/ ro/ )/ ,/ ro/ 会/ 在/ 被/ 活化/ 之前/ 选择/ 执行/ ;/ 而/ 此时/ pmaxro/ 条件/ 为/ 假/ ,/ 不会/ 多次/ 执行/ ,/ 故/ R/ 具有/ 可/ 终止/ 性/ ./ 综上/ ,/ 如果/ ρ/ 是/ 有限/ 触发/ 环/ ,/ R/ 具有/ 可/ 终止/ 性/ ./ 定理/ 5/ ./ 对于/ 不可/ 归约/ 集/ R/ ,/ 如果/ 由于/ 拓扑/ 结构/ 和/ 优先级/ 别的/ 设置/ 使得/ R/ 上/ 的/ 所有/ 触发/ 环是/ 有限/ 的/ ,/ 则/ 仅/ 由/ R/ 确定/ 的/ 规则/ 集/ 不会/ 呈现/ 非/ 终止/ 行为/ ./ 证明/ ./ 反证法/ ./ 假定/ R/ 呈/ 非/ 终止/ 行为/ ,/ 对于/ R/ 上/ 的/ 任一/ 触发/ 环/ ρ/ i/ ,/ 令/ ri/ 为/ ρ/ i/ 上/ 代表/ 制约/ 优先级/ 的/ 规则/ ./ 由于/ ρ/ i/ 是/ 有限/ 的/ ,/ 其上/ 规则/ 的/ 无限/ 执行/ 只能/ 依赖于/ 另外/ 的/ 呈/ 非/ 终止/ 行为/ 的/ 触发/ 环/ ,/ 且/ 另外/ 的/ 触发/ 环/ 必须/ 具有/ 相对/ 较/ 低/ 的/ 制约/ 优先级/ ./ 令/ ρ/ j/ 就是/ 这样/ 一个/ 触发/ 环/ ,/ rj/ 是/ ρ/ j/ 上/ 代表/ 其/ 制约/ 优先级/ 的/ 规则/ ,/ 那么/ 有/ pri/ (/ rj/ )/ </ pri/ (/ ri/ )/ ./ 同理/ ,/ ρ/ j/ 上/ 规则/ 的/ 无限/ 执行/ 依赖于/ 另外/ 的/ 呈/ 非/ 终止/ 行为/ 且/ 具有/ 相对/ 较/ 低/ 制约/ 优先级/ 别的/ 触发/ 环/ ,/ 令/ ρ/ k/ 为/ 这样/ 一个/ 触发/ 环/ ,/ rk/ 为/ ρ/ k/ 上/ 代表/ 其/ 制约/ 优先级/ 的/ 规则/ ,/ 则/ 有/ pri/ (/ rk/ )/ </ pri/ (/ rj/ )/ ./ 依次/ 下去/ ,/ 由于/ R/ 中/ 的/ 规则/ 个数/ 有限/ ,/ 根据上述/ 制约/ 优先级/ 之间/ 的/ 单向/ 依赖/ 关系/ ,/ 必在/ 有限/ 步骤/ 之后/ 找到/ 某一/ 触发/ 环/ ρ/ t/ ,/ 该/ 触发/ 环/ 没有/ 可以/ 依赖/ 的/ 触发/ 环/ ,/ 那么/ ρ/ t/ 必须/ 是/ 呈/ 非/ 终止/ 行为/ 才能/ 使/ 规则/ 集/ R/ 非/ 终止/ ,/ 这/ 与/ 所有/ 触发/ 环是/ 有限/ 的/ 相/ 矛盾/ ./ 证毕/ ./ 算法/ 4/ ./ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ Termination/ _/ TP/ ./ 输入/ :/ G/ =/ 〈/ R/ ,/ E/ 〉/ 输出/ :/ 触发/ 环/ 及其/ 可达/ 的/ 边/ ;/ NULL/ 表示/ 规则/ 集/ R/ 一定/ beginG/ ·/ ·/ =/ Basic/ _/ Reduce/ (/ G/ )/ ;/ if/ (/ G/ =/ NULL/ )/ thenreturn/ (/ NULL/ )/ ;/ elseend/ 由/ 定理/ 4/ 可知/ 该/ 算法/ 是/ 正确/ 的/ ./ 由于/ 规则/ 集中/ 的/ 规则/ 个数/ 有限/ ,/ 若/ n/ 为/ 触发/ 环/ 中/ 规则/ 的/ 个数/ ,/ 该/ 算法/ 是/ 可/ 终止/ 的/ ./ 该/ 算法/ 分/ 两个/ 部分/ :/ 第一/ 部分/ 调用/ 基本/ 归约/ 算法/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ;/ 第二/ 部分/ 对/ 每个/ 满足条件/ 的/ 规则/ 调用/ 触发/ 路径/ 优先级/ 判定/ 算法/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ n3/ )/ ./ 故/ 算法/ 的/ 总体/ 时间/ 复杂度/ 为/ O/ (/ n3/ )/ ./ 由于/ 该/ 算法/ 时间/ 复杂度/ 较/ 高/ ,/ 因此/ 可以/ 采用/ 两/ 阶段/ 算法/ 加以改进/ ,/ 第一阶段/ 采用/ 基本/ 归约/ 算法/ 和/ 关联/ 图/ 分析/ 算法/ ,/ 无法/ 得到/ 终止/ 性/ 结论/ 的/ 规则/ 集才/ 会/ 进入/ 第二阶段/ ,/ 从而/ 降低/ 了/ 规则/ 集/ 的/ 规模/ ,/ 减少/ 了/ 分析/ 时间/ ./ 算法/ 5/ ./ 两/ 阶段/ 终止/ 性/ 分析/ 算法/ Termination/ _/ 2P/ ./ 输入/ :/ G/ =/ 〈/ R/ ,/ E/ 〉/ 输出/ :/ 触发/ 环/ 及其/ 可达/ 的/ 边/ ;/ NULL/ 表示/ 规则/ 集/ R/ 一定/ Page8beginG/ ·/ ·/ =/ Basic/ _/ Reduce/ (/ G/ )/ ;/ If/ (/ G/ =/ NULL/ )/ thenreturn/ (/ NULL/ )/ ;/ elseend5/ 与/ 相关/ 算法/ 的/ 比较/ 下面/ 将/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 与/ 相关/ 算法/ 进行/ 比较/ ./ 例/ 3/ ./ 对于/ 例/ 2/ 中/ 的/ 规则/ 集/ R/ =/ {/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r6/ }/ ,/ pri/ (/ ri/ )/ =/ i/ ,/ 其/ 关联/ 图如图/ 2/ 所示/ ./ 应用/ 文献/ [/ 5/ ]/ 的/ 方法/ ,/ 通过/ 抽象/ 数据库/ 状态/ 来/ 模拟/ 规则/ 的/ 处理/ ,/ 需要/ 列出/ 规则/ 处理/ 前/ 所有/ 的/ 初始/ 触发/ 规则/ ./ 在/ 例/ 2/ 中/ ,/ 数据库/ 事务/ 可以/ 在/ 规则/ 处理/ 前/ 触发/ 每条/ 规则/ 任意/ 次数/ 目的/ 出现/ ,/ 如/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r1/ )/ 中/ r1/ 的/ 两次/ 出现/ 和/ r2/ 的/ 一次/ 出现/ ,/ 无法/ 准确/ 列出/ 初始/ 触发/ 规则/ ,/ 该/ 方法/ 也/ 无法/ 保证/ 规则/ 集/ 的/ 终止/ ./ 应用/ 文献/ [/ 7/ ]/ 的/ 方法/ ,/ 触发/ 环/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r1/ )/ 中/ 任何/ 一条/ 边/ 无法/ 移除/ ,/ 因此/ 无法/ 得到/ 终止/ 的/ 结论/ ./ 应用/ 文献/ [/ 13/ ]/ 的/ 方法/ ,/ 由/ Lee/ 给出/ 的/ 算法/ ,/ 触发/ 环/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r1/ )/ 的/ 激活/ 公式/ 只能/ 包含/ 不/ 被/ 规则/ 动作/ 更新/ 的/ 属性/ ,/ 或者/ 是/ 可以/ 从/ 触发/ 图中/ 删除/ 的/ 规则/ 所/ 更新/ 的/ 属性/ ./ 如果/ 环/ 中/ 任一/ 规则/ 包含/ 被/ 规则/ r6/ 所/ 更新/ 的/ 属性/ ,/ 则/ 解圈/ 方法/ 无法/ 保证/ 终止/ 性/ ./ 应用/ 文献/ [/ 17/ ]/ 的/ 方法/ ,/ 图/ 2/ 中/ 存在/ 一个/ 触发/ 环/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r1/ )/ 和/ 一个/ 活化/ 环/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r1/ )/ ,/ 由于/ ρ/ 中/ 每个/ 规则/ 都/ 处于/ 触发/ 环/ ρ/ 中/ ,/ 或者/ 由/ ρ/ 可/ 达/ ,/ 并且/ 每次/ 自惰/ 化后/ 均/ 可/ 再次/ 被/ 活化/ ,/ 因此/ 判定/ 此/ 规则/ 集/ 具有/ 不可/ 终止/ 性/ ./ 由图/ 2/ 可知/ ,/ 该/ 规则/ 集是/ 不可/ 归约/ 集/ ,/ 且/ 其/ 触发/ 环/ 不/ 满足/ 文献/ [/ 15/ ]/ 中/ 关于/ 被/ 禁止/ 的/ 触发/ 环/ 的/ 定义/ ,/ 故由/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ 不能/ 判定/ R/ 可/ 终止/ ./ 在/ 时间/ 复杂度/ 方面/ ,/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ n3/ )/ ,/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ 的/ 时间/ 复杂度/ 为/ O/ (/ n2/ )/ ,/ 因此/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 比/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ 在/ 时间/ 复杂度/ 高/ ./ 然而/ ,/ 在/ 大规模/ 的/ 网络/ 环境/ 中/ ,/ 触发/ 路径/ 方法/ 的/ 贡献/ 在于/ 辅助/ 应用/ 开发人员/ 设计/ 出/ 更加/ 合理/ 有效/ 的/ 规则/ 集/ ,/ 虽然/ 规则/ 分析/ 精度/ 的/ 提高/ 带来/ 分析/ 效率/ 的/ 降低/ ,/ 但/ 不会/ 影响/ 到/ 应用/ 本身/ 性能/ ,/ 而是/ 提高/ 了/ 应用/ 设计/ 的/ 灵活性/ ./ 对于/ 使用/ 规则/ 的/ 用户/ 来说/ ,/ 规则/ 集/ 已经/ 成为/ 了/ 应用/ 系统/ 的/ 一部分/ ,/ 复杂度/ 较/ 高/ 的/ 分析/ 在/ 设计阶段/ 已经/ 完成/ 了/ ,/ 即使/ 是/ 在/ 传感器/ 网络/ 这样/ 规则/ 集会/ 出现/ 动态变化/ 的/ 环境/ ,/ 采用/ 两/ 阶段/ 算法/ 也/ 可以/ 提高/ 分析/ 效率/ ./ 在/ 分析/ 结果/ 的/ 精确性/ 方面/ ,/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 比/ 基于/ 关联/ 图/ 的/ 终止/ 性/ 分析/ 算法/ 的/ 精确性/ 更高/ ./ 文献/ [/ 15/ ]/ 中/ 的/ 定义/ 禁止/ 触发/ 环/ 的/ 条件/ (/ 1/ )/ 和/ (/ 2/ )/ 是/ 本文/ 中/ 有限/ 触发/ 环/ 定义/ 条件/ (/ 1/ )/ 的/ 子集/ ,/ 其/ 条件/ (/ 3/ )/ 是/ 本文/ 定义/ 条件/ (/ 2/ )/ 的/ 子集/ ,/ 因此/ 被/ 禁止/ 的/ 环/ 一定/ 是/ 有限/ 环/ ,/ 即/ 由/ 基于/ 关联/ 图/ 的/ 算法/ 判定/ 可/ 终止/ 的/ 规则/ 集/ ,/ 用/ 基于/ 触发/ 路径/ 的/ 算法/ 分析/ 也/ 一定/ 是/ 是/ 可/ 终止/ 的/ ./ 而/ 对于/ 用/ 基于/ 关联/ 图/ 的/ 算法/ 分析/ 不/ 一定/ 终止/ 的/ 规则/ 集/ ,/ 用/ 基于/ 触发/ 路径/ 的/ 算法/ 有/ 可能/ 判定/ 可/ 终止/ ./ 对于/ 例/ 2/ ,/ 应用/ 本文/ 提出/ 的/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析方法/ 进行/ 分析/ ,/ 规则/ r1/ 满足/ 本文/ 有限/ 触发/ 环/ 定义/ ,/ 是/ 有限/ 规则/ ,/ 故/ 触发/ 环/ ρ/ =/ (/ r1/ ,/ r2/ ,/ r3/ ,/ r4/ ,/ r5/ ,/ r1/ )/ 是/ 有限/ 环/ ,/ 由/ 基于/ 触发/ 路径/ 的/ 分析/ 算法/ 可知/ 规则/ 集/ R/ 是/ 可/ 终止/ 的/ 规则/ 集/ ./ 因此/ ,/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ 比/ 上述/ 其它/ 算法/ 的/ 分析/ 结果/ 更/ 精确/ ,/ 进一步提高/ 了/ 规则/ 集/ 终止/ 性/ 分析/ 的/ 精确性/ ./ 6/ 实验/ 分析/ 以下/ 通过/ 实验/ 分析/ Basic/ _/ Reduce/ 、/ Termination/ _/ RG/ 、/ Termination/ _/ TP/ 、/ Termination/ _/ 2P4/ 个/ 算法/ 的/ 准确性/ 和/ 性能/ ./ 性能/ 测试/ 中/ ,/ Termination/ _/ RG/ 、/ Termination/ _/ TP/ 算法/ 均/ 先/ 执行/ Basic/ _/ Reduce/ 算法/ 过滤/ 规则/ 集/ ./ 实验/ 环境/ 设置/ 为/ :/ IntelPentium/ 双核/ CPU/ 主频/ 2.6/ GHz/ ,/ 内存/ 2048MB/ ,/ 算法/ 采用/ C语言/ 实现/ ,/ 操作系统/ 为/ Windows2003Server/ ./ 实验/ 数据/ 采用/ 随机/ 生成/ 规则/ 节点/ 数/ ,/ 规则/ 节点/ 之间/ 随机/ 生成/ 触发/ 边/ 、/ 活化/ 边/ 或/ 惰化边/ (/ 根据/ 实际/ 应用/ ,/ 惰化边/ 与/ 触发/ 边/ 、/ 活化/ 边/ 不/ 同时/ 出现/ )/ ,/ 各种/ 边/ 的/ 方向/ 随机/ ,/ 共/ 生成/ 1000/ 组/ ./ 测试/ 生成/ 的/ 规则/ 集/ 1000/ 组中/ 能够/ 得到/ 终止/ 性/ 结论/ 的/ 百分比/ 以及/ 得到/ 结果/ 所/ 需要/ 的/ 时间/ 如图/ 3/ 所示/ ./ Page9/ 根据/ 实验/ 结果/ ,/ Basic/ _/ Reduce/ 算法/ 得到/ 终止/ 性/ 结论/ 的/ 百分比/ 最低/ ,/ 依次/ 是/ Termination/ _/ RG/ 和/ Termination/ _/ TP/ 、/ Termination/ _/ 2P/ 算法/ (/ Termination/ _/ 2P/ 主要/ 提高/ Termination/ _/ TP/ 分析/ 效率/ ,/ 不/ 改变/ 其/ 结论/ )/ ,/ 表明/ 触发/ 路径分析/ 方法/ 提高/ 了/ 规则/ 集/ 终止/ 性/ 分析/ 的/ 准确性/ ./ 从/ 执行/ 时间/ 来看/ ,/ 如果/ 不/ 采用/ 两/ 阶段/ 分析方法/ ,/ Termination/ _/ TP/ 分析/ 时间/ 超出/ Termination/ _/ RG/ 很多/ ,/ 采用/ 两/ 阶段/ 算法/ 后/ ,/ 在/ 700/ 个/ 规则/ 节点/ 规模/ 内/ ,/ Termination/ _/ 2P/ 分析/ 时间/ 几乎/ 接近/ Termination/ _/ RG/ 算法/ ./ 考虑/ 到/ P2P/ 、/ 传感器/ 网络/ 中/ 应用/ 具有/ 多用户/ 并发/ 、/ 规则/ 集/ 规模/ 大/ 、/ 网络/ 动态变化/ 等/ 特点/ ,/ 进一步/ 基于/ Loadrunner8/ ./ 0/ 软件/ 仿真/ 测试/ 规则/ 分析方法/ 在/ 多用户/ 查询/ 并发/ 时/ 负载/ 情况/ ./ 实验/ 通过/ 1000/ 次/ 随机/ 增加/ 和/ 删除/ 规则/ 节点/ ,/ 分别/ 考察/ 规则/ 集/ 基数/ 为/ 500/ 时/ ,/ 分析方法/ 随/ 用户/ 访问/ 数/ 变化/ 的/ 负载/ 情况/ 以及/ 用户/ 访问/ 数为/ 60/ 时/ ,/ 分析方法/ 随/ 规则/ 集/ 基数/ 变化/ 时/ 的/ 负载/ 情况/ ./ 实验/ 结果/ 如图/ 4/ 所示/ ./ 根据/ 实验/ 结果/ ,/ 由于/ 规则/ 分析/ 时间/ 相对/ 于/ 仿真/ 设置/ 的/ 多用户/ 查询/ 访问/ 时间/ 消耗/ 很少/ ,/ 因此/ ,/ 3/ 种/ 方法/ 总体/ 负载/ 情况/ 相差/ 不大/ ./ 规则/ 集/ 基数/ 为/ 500/ 时/ ,/ 随/ 用户/ 访问/ 数/ 增加/ ,/ 系统/ 平均/ 响应/ 时间/ 也/ 增加/ ,/ Termination/ _/ TP/ 平均/ 响应/ 时间/ 最长/ ,/ Termination/ _/ RG/ 和/ Termination/ _/ 2P/ 算法/ 平均/ 响应/ 时间/ 几乎/ 相同/ ./ 表明/ 多用户/ 访问/ 时/ ,/ 即使/ 规则/ 集/ 发生/ 动态变化/ ,/ 规则/ 分析方法/ 性能/ 差异/ 也/ 不大/ ./ 对于/ 用户/ 访问/ 数/ 一定/ 的/ 情况/ ,/ 随着/ 规则/ 集/ 数目/ 增加/ ,/ Termination/ _/ RG/ 算法/ 性能/ 最为/ 稳定/ ,/ 平均/ 响应/ 时间/ 呈/ 线性/ 增长/ ,/ 但/ 增长幅度/ 很小/ ,/ 表明/ 在/ 规则/ 动态分析/ 中/ ,/ 如果/ 多用户/ 并发/ 访问/ 中/ 的/ 网络/ 延迟/ 、/ 任务调度/ 等/ 时间/ 消耗/ 远超过/ 规则/ 分析/ 时间/ 时/ ,/ 规则/ 数目/ 增加/ 与/ 分析/ 时间/ 基本/ 无关/ ./ 而/ Termination/ _/ TP/ 和/ Termination/ _/ 2P/ 算法/ 性能/ 随/ 规则/ 集/ 数目/ 增加/ 而/ 呈/ 下降/ 趋势/ ,/ 并且/ 中间/ 出现/ 动荡/ ,/ 可能/ 是因为/ 随机/ 增加/ 和/ 删除/ 规则/ 节点/ 产生/ 的/ 性能/ 差异/ ,/ 但/ Termination/ _/ 2P/ 算法/ 总体/ 性能/ 好于/ Termination/ _/ TP/ ,/ 而/ 接近/ 于/ Termination/ _/ RG/ ./ 7/ 结语/ 本文/ 分析/ 了/ 触发/ 环/ 中/ 规则/ 不会/ 多次/ 执行/ 的/ 两种/ 情形/ :/ (/ 1/ )/ 先/ 被/ 活化/ ,/ 再/ 被/ 惰化/ ,/ 最后/ 被/ 触发/ ;/ (/ 2/ )/ 先/ 被/ 惰化/ ,/ 再/ 被/ 触发/ ,/ 再/ 被/ 活化/ ./ 基于/ 此/ 原则/ ,/ 引入/ 了/ 触发/ 路径/ 和/ 有限/ 触发/ 环/ 的/ 概念/ ,/ 根据/ 触发/ 路径/ 优先级/ 判断/ 规则/ 触发/ 环/ 是否是/ 有限/ 触发/ 环/ ,/ 提出/ 了/ 基于/ 触发/ 路径/ 的/ 终止/ 性/ 分析/ 算法/ ,/ 提高/ 了/ 分析/ 结果/ 的/ 精确性/ ./ 本文/ 算法/ 已经/ 采用/ C语言/ 实现/ ,/ 并/ 将/ 其/ 应用/ 于/ 开源/ 数据库/ Ingres/ 的/ 规则/ 管理器/ ./ 本文/ 方法/ 与/ 基于/ 关联/ 图/ 的/ 规则/ 终止/ 性/ 分析/ 算法/ 相比/ 时间/ 复杂度/ 略/ 高/ ,/ 但/ 采用/ 第一阶段/ 进行/ 基本/ 归约/ 和/ 关联/ 图/ 分析/ ,/ 第二阶段/ 进行/ 触发/ 路径分析/ 后/ ,/ 能够/ 保证/ 分析/ 效率/ 不会/ 降低/ 太/ 多/ ,/ 并且/ 提高/ 了/ 分/ Page10/ 析/ 的/ 准确性/ ./ 实验/ 结果表明/ ,/ 基于/ 触发/ 路径/ 的/ 主动/ 规则/ 集/ 终止/ 性/ 分析/ 算法/ 结合/ 两/ 阶段/ 分析/ 策略/ 后/ ,/ 能够/ 很/ 好/ 地/ 适应/ 规则/ 集/ 动态变化/ 和/ 多用户/ 并发/ 的/ 负载/ 情况/ ./ 下/ 一步/ 的/ 工作/ 是/ 将/ 复合/ 事件/ 和/ 复杂/ 条件/ 集成/ 到/ 该/ 分析方法/ 中/ ,/ 进一步/ 加强/ 本文/ 算法/ 的/ 适应能力/ ./ 致谢/ 感谢/ 墨西哥/ Cinvestav/ -/ IPNXiaoouLi/ 教授/ 提供/ 了/ 相关/ 参考资料/ !/ 

