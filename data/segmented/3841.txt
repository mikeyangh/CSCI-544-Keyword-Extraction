Page1Piccolo/ 密码/ 代数/ 故障/ 分析/ 研究/ 赵新杰/ 1/ )/ ,/ 2/ )/ 郭/ 世泽/ 2/ )/ 王韬/ 1/ )/ 张帆/ 3/ )/ 刘会英/ 1/ )/ 黄静/ 4/ )/ 王平/ 5/ )/ 1/ )/ (/ 军械/ 工程学院/ 信息工程/ 系/ 石家庄/ 050003/ )/ 2/ )/ (/ 北方/ 电子设备/ 研究所/ 北京/ 100083/ )/ 3/ )/ (/ 康涅狄格/ 大学/ 计算机科学/ 与/ 工程系/ 斯托斯/ 康涅狄格州/ 美国/ 06269/ )/ 4/ )/ (/ 清华大学/ 计算机科学/ 与/ 技术/ 系/ 北京/ 100084/ )/ 5/ )/ (/ 航天/ 恒星/ 科技/ 有限公司/ 北京/ 100086/ )/ 摘要/ 应用/ 代数/ 故障/ 分析方法/ ,/ 对/ Piccolo/ 密码/ 抗/ 故障/ 攻击/ 安全性/ 进行/ 了/ 评估/ ./ 首先/ 利用/ 代数/ 方法/ 建立/ Piccolo/ 密码/ 等效/ 布尔/ 方程组/ ;/ 然后/ 通过/ 故障/ 攻击/ 手段/ 获取/ 故障/ 密文/ 并/ 将/ 故障注入/ 差分/ 进行/ 表示/ ,/ 给出/ 了/ 一种/ 故障注入/ 位置/ 未知/ 情况/ 下/ 的/ 故障/ 差分/ 布尔/ 方程组/ 表示/ 方法/ ;/ 最后/ 使用/ CryptoMiniSAT/ 解析器/ 求解/ 联立方程/ 组/ 恢复/ 密钥/ ./ 结果表明/ ,/ 代数/ 故障/ 分析/ 相比/ 传统/ 差分/ 故障/ 分析/ 具有/ 以下/ 优点/ :/ (/ 1/ )/ 在线/ 故障注入/ 较/ 少/ ,/ 在/ Piccolo/ -/ 80/ 第/ 23/ 轮/ 注入/ 4bit/ 故障/ ,/ 1/ 次/ 故障注入/ 即可/ 恢复/ 80/ 位/ 密钥/ ;/ (/ 2/ )/ 离线/ 分析方法/ 简单/ ,/ 无需/ 结合/ 算法/ 和/ 故障/ 模型/ 判断/ 故障/ 位置/ ,/ 执行/ 繁琐/ 的/ 故障/ 差分/ 传播/ 分析/ ,/ 自动化/ 程度较高/ ;/ (/ 3/ )/ 计算资源/ 利用率/ 高/ ,/ 可/ 将/ 故障/ 攻击/ 下/ 的/ 密钥/ 恢复/ 转化/ 为/ 代数方程/ 求解/ 问题/ ,/ 充分利用/ 计算资源/ ;/ (/ 4/ )/ 通用性/ 较/ 好/ ,/ 可/ 扩展/ 到/ 宽度/ 故障/ 模型/ 、/ 深度/ 故障/ 模型/ 、/ 其它/ 版本/ 的/ Piccolo/ 密码/ 以及/ 多种/ 分组/ 密码/ ,/ 有望/ 成为/ 评估/ 分组/ 密码/ 抗/ 故障/ 攻击能力/ 的/ 通用/ 方法/ ./ 关键词/ 代数/ 故障/ 分析/ ;/ 故障/ 模型/ ;/ CryptMinisat/ ;/ Piccolo/ ;/ 轻量级/ 分组/ 密码/ 1/ 引言/ 现实/ 世界/ 中/ ,/ 密码/ 算法/ 大都/ 在/ 特定/ 的/ 密码/ 设备/ 中/ 实现/ ./ 一般/ 情况/ 下/ ,/ 密码/ 设备/ 均/ 能/ 正确/ 地/ 执行/ 各种/ 密码/ 运算/ ,/ 但/ 在/ 有/ 外界/ 干扰/ 情况/ 下/ (/ 温度/ 、/ 电压/ 、/ 电磁脉冲/ 等/ 扰动/ )/ [/ 1/ -/ 2/ ]/ ,/ 密码/ 设备/ 可能/ 会/ 出现/ 寄存器/ 故障/ 或/ 运算/ 错误/ ,/ 利用/ 这些/ 故障/ 行为/ 或/ 错误信息/ 来/ 恢复/ 密钥/ 的/ 方法/ 即/ 是/ 故障/ 攻击/ ./ 由于/ 现代/ 密码/ 设备/ 大都/ 基于/ 电子/ 技术/ 进行/ 实现/ ,/ 接口/ 也/ 相对/ 比较简单/ ,/ 较易/ 受到/ 外界/ 干扰/ ,/ 故障/ 攻击/ 已/ 成为/ 最/ 有效/ 的/ 旁路/ 攻击/ 方法/ 之一/ ./ 1.1/ 相关/ 工作/ 故障/ 攻击/ 由/ Boneh/ 等/ 人/ [/ 3/ ]/ 于/ 1996/ 年/ 率先/ 提出/ ,/ 并/ 成功/ 攻破/ 基于/ CRT/ 方式/ 实现/ 的/ RSA/ 签名/ 算法/ ./ 之后/ ,/ Biham/ 和/ Shamir/ [/ 4/ ]/ 将/ 该/ 方法/ 推广/ 至/ DES/ ,/ 由于/ 攻击/ 时/ 采用/ 了/ 差分/ 分析/ 思想/ ,/ 推广/ 的/ 方法/ 被/ 称为/ “/ 差分/ 故障/ 分析/ ”/ (/ DiffertialFaultAnalysis/ ,/ DFA/ )/ ./ 此后/ 密码/ 学家/ 又/ 实现/ 了/ 针对/ ECC/ [/ 5/ ]/ 等/ 公钥/ 密码/ ,/ AES/ [/ 6/ ]/ 、/ Camellia/ [/ 7/ -/ 9/ ]/ 、/ SMS4/ [/ 10/ ]/ 、/ LED/ [/ 11/ -/ 15/ ]/ 等/ 分组/ 密码/ ,/ RC4/ [/ 16/ ]/ 、/ Trivium/ [/ 17/ ]/ 等流/ 密码/ 的/ 多种/ 差分/ 故障/ 分析/ ./ 然而/ 差分/ 故障/ 分析/ 也/ 具有/ 一定/ 的/ 缺点/ :/ (/ 1/ )/ 攻击者/ 需要/ 结合/ 算法/ 结构/ 和/ 操作/ 对/ 故障/ 传播/ 过程/ 进行/ 分析/ ,/ 并/ 进行/ 繁琐/ 的/ 手工/ 密钥/ 推导/ ,/ 通用性/ 较差/ ;/ (/ 2/ )/ 即使/ 在/ 相同/ 故障/ 模型/ 下/ ,/ 针对/ 同一/ 密码/ 算法/ 分析/ 中/ ,/ 受/ 研究者/ 对/ 算法/ 结构/ 的/ 认知/ 能力/ 和/ 故障/ 挖掘/ 方法/ 所/ 限制/ ,/ 常会/ 得到/ 不同/ 的/ 实验/ 结果/ [/ 11/ -/ 15/ ]/ ,/ 对/ 故障/ 的/ 分析/ 利用率/ 未/ 达到/ 最大/ ;/ (/ 3/ )/ 对于/ 某些/ 密码/ 算法/ 设计/ 、/ 宽度/ 故障/ 、/ 深轮/ 故障/ 模型/ ,/ 故障/ 差分/ 的/ 传播/ 特征/ 将/ 更为/ 复杂/ ,/ 差分/ 故障/ 分析/ 的/ 难度/ 将/ 大大/ 增大/ ./ 研究/ 自动化/ 、/ 通用化/ 的/ 密钥/ 分析方法/ 一直/ 是/ 故障/ 分析/ 尚待/ 解决/ 的/ 一个/ 问题/ ./ 代数/ 分析/ [/ 18/ ]/ 是/ 近年来/ 提出/ 的/ 一种/ 密码/ 分析方法/ ,/ 将/ 密钥/ 求解/ 转化/ 为/ 代数方程/ 组/ 求解/ 问题/ ,/ 利用/ 解析器/ 工具/ 进行/ 密钥/ 自动化/ 求解/ ,/ 可/ 充分利用/ 计算资源/ ,/ 为/ 密码/ 分析/ 提供/ 了/ 一种/ 新/ 的/ 自动化/ 、/ 通用化/ 分析/ 手段/ ./ 将/ 代数/ 分析方法/ 同/ 故障/ 分析/ 结合/ 起来/ ,/ 开展/ 代数/ 故障/ 分析/ ,/ 有望/ 弥补/ 传统/ 差分/ 故障/ 分析/ 的/ 不足/ ./ 代数/ 故障/ 分析/ 由/ Courtois/ 等/ 人/ [/ 19/ ]/ 在/ 2010/ 年/ 提出/ ,/ 对/ DES/ 进行/ 了/ 攻击/ ,/ 结果表明/ 通过/ 穷举/ 24/ 位/ DES/ 密钥/ ,/ 在/ DES/ 加密/ 第/ 13/ 轮/ 注入/ 1bit/ 故障/ ,/ 对于/ 1/ 次/ 穷举/ 可/ 在/ 1min/ 内/ 恢复/ 密钥/ ;/ 2011/ 年/ ,/ Mohamed/ 等/ 人/ [/ 20/ ]/ 将/ 代数/ 故障/ 分析/ 扩展/ 至流/ 密码/ Trivium/ ,/ 用于/ 提高/ 攻击/ 差分/ 故障/ 分析/ ,/ 结果表明/ 仅/ 需/ 两次/ 故障注入/ 对/ 420bit/ 密钥流/ 进行/ 分析/ 即可/ 恢复/ Trivium/ 密钥/ ;/ 2012/ 年/ ,/ Zhao/ 等/ 人/ [/ 13/ ]/ 和/ Jovanovic/ 等/ 人/ [/ 15/ ]/ 将/ 代数/ 故障/ 分析/ 扩展/ 至/ LED/ 分组/ 密码/ ,/ 结果表明/ 1/ 次/ 故障注入/ 使用/ 普通/ PC机/ 分析/ 即可/ 在/ 1min/ 内/ 恢复/ LED/ 密钥/ ./ 随着/ 电子/ 信息技术/ 和/ 普适/ 计算/ 的/ 发展/ ,/ RFID/ 标签/ 和/ 无线/ 传感器/ 网络/ 深入/ 到/ 人们/ 生活/ 的/ 方方面面/ ,/ 如何/ 在/ 此类/ 资源/ 受限/ 的/ 环境/ 下/ 提供/ 信息安全/ 保障/ 成为/ 重点/ 和/ 难点/ 问题/ ./ 轻量级/ 密码/ 算法/ 正是/ 在/ 这种/ 趋势/ 上/ 发展/ 起来/ 的/ ,/ 典型/ 算法/ 包括/ :/ PRESENT/ [/ 21/ ]/ 、/ MIBS/ [/ 22/ ]/ 、/ GOST/ [/ 23/ ]/ 、/ KLEIN/ [/ 24/ ]/ 、/ LED/ [/ 25/ ]/ 、/ Piccolo/ [/ 26/ ]/ 等/ ,/ 这些/ 算法/ 大都/ 可/ 在/ 3000/ 个/ 门电路/ 内/ 硬件/ 实现/ ,/ 特别/ 适用/ 于/ 轻量级/ 密码/ 设备/ 加解密/ 需要/ ./ 由于/ 其/ 轻量级/ 的/ 设计/ 和/ 实现/ 原则/ ,/ 轻量级/ 密码/ 设备/ 的/ 防护/ 程度/ 不高/ ,/ 导致/ 其易/ 遭受/ 故障注入/ 的/ 威胁/ ./ 此外/ ,/ 此类/ 密码/ 算法/ 代数/ 结构/ 相对/ 比较简单/ 也/ 导致/ 其/ 代数方程/ 求解/ 复杂度/ 较/ 低/ ,/ 这/ 都/ 为/ 代数/ 故障/ 分析/ 研究/ 提供/ 了/ 故障注入/ 和/ 分析/ 的/ 有利条件/ ./ 本文/ 代数/ 故障/ 分析/ 研究/ 主要/ 针对/ CHES2011/ 会议/ 上/ 提出/ 的/ 轻量级/ 分组/ 密码/ Piccolo/ ./ Piccolo/ 密码/ 分组/ 长度/ 为/ 64/ 位/ ,/ 密钥/ 长度/ 为/ 80/ 位/ 和/ 128/ 位/ ,/ 对应/ 算法/ 分别/ 为/ Piccolo/ -/ 80/ 和/ Piccolo/ -/ 128/ ,/ 迭代/ 轮数/ 分别/ 为/ 25/ 轮/ 和/ 31/ 轮/ ./ 算法/ 采用/ 非/ 平衡/ 型/ Feistel/ 结构/ ,/ 每轮/ 使用/ 2/ 个/ F/ 函数/ ,/ 基本/ 运算/ 单元/ 为/ Nibble/ (/ 4bit/ )/ ./ 2012/ 年/ ,/ Wang/ 等/ 人/ [/ 27/ ]/ 应用/ Biclique/ 分析方法/ ,/ 对/ 全轮/ 的/ Piccolo/ -/ 80/ 算法/ 和/ Page328/ 轮/ 的/ Piccolo/ -/ 128/ 算法/ 安全性/ 进行/ 了/ 分析/ ,/ 攻击/ 数据/ 复杂度/ 分别/ 为/ 248/ 和/ 224/ 个/ 选择/ 密文/ ,/ 时间/ 复杂度/ 分别/ 为/ 278.95/ 和/ 2126.79/ 次/ 加密/ ./ 在/ Piccolo/ 故障/ 攻击/ 方面/ 现有/ 工作/ 有/ 两例/ ,/ 均/ 基于/ 差分/ 故障/ 分析方法/ 实现/ ./ 一是/ 由/ Jeong/ [/ 28/ ]/ 在/ 2012/ 年/ 9/ 月/ 的/ Eprint2012/ // 399/ 报告/ 上/ 提出/ ,/ 通过/ 在/ Piccolo/ 倒数第/ 2/ 轮/ F/ 函数/ 的/ 1/ 个/ 输入/ 左/ 寄存器/ 注入/ 1/ 个/ 字节/ 故障/ ,/ 6/ 次/ 故障注入/ 可/ 将/ Piccolo/ -/ 80/ 密钥/ 搜索/ 空间/ 降低/ 到/ 224/ ,/ 应用/ 类似/ 方法/ ,/ 8/ 次/ 故障注入/ 可/ 将/ Piccolo/ -/ 128/ 密钥/ 搜索/ 空间/ 降低/ 到/ 240/ ./ 二是/ 赵/ 光耀/ 等/ 人/ [/ 29/ ]/ 在/ 计算机/ 学报/ 2012/ 年/ 9/ 月/ 信息安全/ 专辑/ 上/ 提出/ ,/ 通过/ 在/ Piccolo/ 倒数第/ 2/ 轮/ F/ 函数/ 的/ 2/ 个/ 输入/ 左/ 寄存器/ 分别/ 注入/ 1/ 个/ Nibble/ 故障/ ,/ 2/ 次/ 故障注入/ 可/ 将/ Piccolo/ -/ 80/ 密钥/ 搜索/ 空间/ 降低/ 到/ 222/ ./ 此外/ ,/ 上述/ 结果/ 还/ 表明/ ,/ Piccolo/ 密码/ 抗/ 故障/ 攻击/ 至少/ 要/ 防护/ 倒数/ 两轮/ ./ 如何/ 进一步/ 延伸/ 故障注入/ 轮数/ 、/ 降低/ 故障注入/ 次数/ 、/ 简化/ 故障/ 分析/ 过程/ 是/ 本文/ Piccolo/ 密码/ 故障/ 分析/ 重点/ 要/ 解决/ 的/ 问题/ ./ 1.2/ 本文/ 工作/ 故障/ 攻击/ 进行/ 了/ 评估/ ,/ 主要/ 创新/ 点/ 如下/ :/ 论文/ 应用/ 代数/ 故障/ 分析方法/ ,/ 对/ Piccolo/ 密码/ 抗/ (/ 1/ )/ 提出/ 了/ 一种/ 故障注入/ 索引/ 未知/ 条件/ 下/ 的/ 故障/ 差分/ 表示/ 方法/ ./ 在/ 差分/ 故障/ 分析/ 中/ ,/ 攻击者/ 需/ 根据/ 密文/ 差分/ 手动/ 分析/ 故障/ 在/ 倒数/ 几轮/ 的/ 传播/ 路径/ ,/ 并/ 判断/ 故障注入/ 索引/ ,/ 在/ 此基础/ 上/ 进行/ 繁琐/ 的/ 密钥/ 分析/ ./ 现有/ 代数/ 故障/ 分析/ 研究/ 均/ 假定/ 故障注入/ 位置/ 是/ 已知/ 的/ ,/ 由于/ 针对/ 的/ 分组/ 密码/ 算法/ 密钥/ 长度/ 较/ 短/ (/ DES/ 和/ LED/ 均/ 为/ 64bit/ )/ ,/ 攻击/ 所/ 需/ 的/ 故障注入/ 次数/ 较/ 少/ (/ DES/ 和/ LED/ 需要/ 1/ 次/ )/ ,/ 可能/ 的/ 故障注入/ 位置/ 有限/ ,/ 攻击者/ 可/ 穷举/ 执行/ 多次/ 代数/ 故障/ 攻击/ ./ 对于/ 某些/ 故障/ 攻击/ 场景/ 下/ ,/ 如/ 深轮/ 故障/ 攻击/ 或者/ 较长/ 密钥/ 的/ 分组/ 密码/ 故障/ 攻击/ ,/ 故障注入/ 次数/ 需要/ 多个/ ./ 如果/ 每次/ 故障注入/ 的/ 位置/ 均/ 为/ 未知/ ,/ 多次/ 故障注入/ 对应/ 的/ 故障/ 位置/ 组合/ 数量/ 较大/ ,/ 应用/ 差分/ 故障/ 分析/ 和/ 现有/ 代数/ 故障/ 分析/ 的/ 复杂度/ 也/ 较/ 高/ ./ 本文/ 提出/ 故障注入/ 索引/ 未知/ 下/ 的/ 故障/ 差分/ 表示/ 方法/ ,/ 较/ 好地解决/ 了/ 该/ 问题/ ./ 即使/ 在/ 多次/ 故障注入/ 条件/ 下/ ,/ 改进/ 代数/ 故障/ 分析/ 可/ 将/ 每次/ 注入/ 的/ 故障/ 差分/ 使用/ 代数方程/ 组/ 表示/ 出来/ ,/ 然后/ 执行/ 1/ 次/ 代数/ 求解/ 即可/ 恢复/ 密钥/ ,/ 提高/ 了/ 故障/ 分析/ 的/ 效率/ ,/ 降低/ 了/ 故障/ 分析/ 复杂度/ ./ (/ 2/ )/ 实现/ 了/ 多种/ 故障/ 模型/ 下/ 的/ Piccolo/ 密码/ 代数/ 故障/ 分析/ ./ 应用/ 提出/ 的/ 改进/ 代数/ 故障/ 分析方法/ ,/ 我们/ 实现/ 了/ 多种/ 故障/ 模型/ 下/ 的/ Piccolo/ 优化/ 故障/ 攻击/ ./ 结果表明/ :/ 基于/ Nibble/ 或/ 字节/ 故障/ 模型/ ,/ 通过/ 在/ 倒数第/ 3/ 轮/ 的/ 1/ 个/ F/ 函数/ 输入/ 寄存器/ 注入/ 故障/ ,/ 1/ 次/ 故障注入/ 即可/ 恢复/ Piccolo/ -/ 80/ 密钥/ ,/ 通过/ 在/ 倒数第/ 4/ 轮/ 的/ 1/ 个/ F/ 函数/ 输入/ 寄存器/ 注入/ 故障/ ,/ 2/ 次/ 故障注入/ 即可/ 恢复/ Piccolo/ -/ 80/ 密钥/ ;/ 基于/ Nibble/ 或/ 字节/ 故障/ 模型/ ,/ 通过/ 在/ 倒数第/ 2/ 或/ 3/ 轮/ 注入/ 2/ 次/ 故障/ 、/ 倒数第/ 5/ 或/ 6/ 轮/ 注入/ 1/ 次/ 故障/ ,/ 3/ 次/ 故障注入/ 即可/ 恢复/ Piccolo/ -/ 128/ 密钥/ ;/ 这些/ 结果/ 不仅/ 降低/ 了/ 故障注入/ 次数/ ,/ 而且/ 还/ 延伸/ 了/ Piccolo/ 故障/ 分析/ 轮数/ ./ 此外/ ,/ 本文/ 提出/ 的/ 代数/ 故障/ 分析方法/ 通用性/ 较强/ ,/ 可/ 将/ 其/ 成功/ 扩展/ 至/ DES/ 、/ PRESENT/ 、/ LED/ 、/ GOST/ 等/ 分组/ 密码/ ,/ 均/ 实现/ 最小/ 故障/ 次数/ 下/ 的/ 故障/ 分析/ ./ 1.3/ 结构/ 组织/ 本文/ 第/ 2/ 节/ 介绍/ Piccolo/ 算法/ ;/ 第/ 3/ 节/ 介绍/ 差分/ 故障/ 分析/ 原理/ 、/ 差分/ 故障/ 分析/ 不足/ 及/ 代数/ 故障/ 分析/ 原理/ ;/ 第/ 4/ 节/ 介绍/ Piccolo/ 代数/ 故障/ 分析方法/ ;/ 第/ 5/ 节/ 给出/ Piccolo/ 代数/ 故障/ 分析/ 实验/ 及/ 结果/ ;/ 第/ 6/ 节对/ 代数/ 故障/ 分析/ 的/ 特点/ 和/ 公开/ 问题/ 分析/ 讨论/ ;/ 第/ 7/ 节为/ 结束语/ ./ 2Piccolo/ 算法/ 2.1/ 符号/ 定义/ P/ ,/ K/ ,/ C/ :/ 加密/ 明文/ 、/ 主/ 密钥/ 、/ 密文/ ./ r/ :/ 迭代/ 轮数/ ./ ki/ :/ 密钥/ K/ 的/ 第/ i/ 个/ 16bit/ ./ wki/ :/ 第/ i/ 个/ 16bit/ 白化/ 密钥/ ./ rki/ :/ 第/ i/ // 2/ 轮/ 16bit/ 轮/ 密钥/ ./ a/ |/ b/ :/ 连接/ 操作/ ./ a/ (/ b/ )/ :/ b/ 表示/ a/ 的/ 比特/ 数量/ ./ {/ a/ }/ b/ :/ 用/ b/ 为底/ 表示/ a/ ./ 2.2/ 加密/ 函数/ 设计/ Piccolo/ 密码/ 设计/ [/ 26/ ]/ 采用/ 广义/ Feistel/ 宏观/ 结构/ ,/ 加密/ 过程/ 如图/ 1/ (/ a/ )/ 所示/ ./ 每轮/ 由/ 两个/ F/ 函数/ (/ F/ :/ {/ 0/ ,/ 1/ }/ 16/ →/ {/ 0/ ,/ 1/ }/ 16/ )/ 、/ 轮/ 密钥/ 加/ 函数/ AK/ 和/ 轮/ 置换/ 函数/ RP/ (/ RP/ :/ {/ 0/ ,/ 1/ }/ 64/ →/ {/ 0/ ,/ 1/ }/ 64/ )/ 组成/ ./ 初始/ 64bit/ 明文/ 输入/ 可/ 被/ 划分/ 两/ 部分/ (/ 每/ 部分/ 32bit/ )/ ,/ 两/ 部分/ 输入/ 的/ 左/ 16bit/ 和/ 前/ 白化/ 密钥/ 进行/ 异或/ (/ AddWhiteningKey/ ,/ AWK/ 操作/ )/ ,/ 然后/ 执行/ 若干/ 轮/ 加密/ 迭代/ (/ 最后/ 一轮/ 没有/ 使用/ RP/ 轮/ 置换/ 函数/ )/ ,/ 输出/ 的/ 64bit/ 同样/ 划分/ 为/ 长度/ 为/ 32bit/ 的/ 两/ 部分/ ,/ 两/ 部分/ 的/ 左/ 16bit/ 分别/ 和/ 后/ Page4/ 图/ 1Piccolo/ 密码/ 算法/ 设计/ 白化/ 密钥/ 进行/ 异或/ ,/ 最终/ 得到/ 64bit/ 密文/ 输出/ ./ F/ 函数/ 由/ 查找/ S/ 盒/ -/ 列/ 混淆/ -/ 查找/ S/ 盒/ 3/ 个/ 操作/ 顺序/ 组成/ ,/ AK/ 函数/ 将/ F/ 函数/ 输出/ 同/ 16bit/ 轮/ 密钥/ 进行/ 异或/ (/ AddRoundKey/ ,/ ARK/ 操作/ )/ ,/ RP/ 函数/ 将/ 输入/ 的/ 64bit/ 划分/ 为/ 8/ 个/ 字节/ ,/ 然后/ 执行/ 图/ 1/ (/ b/ )/ 所示/ 的/ 基于/ 字节/ 的/ 置换/ 操作/ ./ 下面/ 对/ F/ 函数/ 的/ 两个/ 操作/ 进行/ 简单/ 介绍/ :/ (/ 1/ )/ Nibble/ 代换/ :/ 将/ 输入/ 的/ 16bit/ 分为/ 4/ 个/ Nibble/ ,/ 执行/ 4/ 次/ 查找/ 4/ 进/ 4/ 出/ S/ 盒/ 操作/ ./ 令/ x/ 为/ S/ 盒/ 输入/ ,/ S/ [/ x/ ]/ 为/ S/ 盒/ 输出/ ,/ Piccolo/ 密码/ S/ 盒/ 设计/ 如表/ 1/ 所示/ ./ xS/ [/ x/ ]/ xS/ [/ x/ ]/ 01234567/ (/ 2/ )/ Nibble/ 混淆/ :/ 将/ 4/ ×/ 4/ 的/ 列/ 混淆/ 矩阵/ 犕/ 乘以/ 4/ 个/ Nibble/ 输入/ 组成/ 的/ 4/ ×/ 1/ 矩阵/ ,/ 得到/ 16/ 位/ 输出/ ./ 2.3/ 密钥/ 扩展/ 设计/ 为/ 提高/ 硬件/ 执行/ 效率/ ,/ 降低/ 密钥/ 扩展/ 开销/ ,/ Piccolo/ 的/ 密钥/ 扩展/ 设计/ 相对/ 较为简单/ ./ 在/ 密钥/ 扩展/ 中/ ,/ 引入/ 了/ 一系列/ 的/ 16bit/ 常量/ 组/ ,/ Piccolo/ -/ 80/ 和/ Piccolo/ -/ 128/ 的/ 密钥/ 扩展/ 中/ 使用/ 的/ 第/ i/ 个/ 16bit/ 常量/ 分别/ 用/ con80i/ 和/ con128i/ 来/ 表示/ ./ (/ 1/ )/ Piccolo/ -/ 80/ 密钥/ 扩展/ 设计/ 将主/ 密钥/ K/ 按/ 16bit/ 划分/ 为/ 5/ 部分/ ,/ 分别/ 用/ k0/ ,/ k1/ ,/ k2/ ,/ k3/ ,/ k4/ 来/ 表示/ ,/ 然后/ 根据/ 式/ (/ 1/ )/ 生成/ 64/ 位/ 白化/ 密钥/ 和/ 25/ 轮/ 的/ 轮/ 密钥/ ,/ 其中/ r/ =/ 25/ ./ wk0/ ←/ kLfori/ ←/ 0to/ (/ r/ -/ 1/ )/ do/ (/ rk2i/ ,/ rk2i/ +/ 1/ )/ ←/ (/ con80/ (/ 2/ )/ Piccolo/ -/ 128/ 密钥/ 扩展/ 设计/ 将主/ 密钥/ K/ 按/ 16bit/ 划分/ 为/ 8/ 部分/ ,/ 分别/ 用/ k0/ ,/ k1/ ,/ k2/ ,/ k3/ ,/ k4/ ,/ k5/ ,/ k6/ ,/ k7/ 来/ 表示/ ,/ 然后/ 根据/ 式/ (/ 2/ )/ 生成/ 64/ 位/ 白化/ 密钥/ 和/ 31/ 轮/ 的/ 轮/ 密钥/ ,/ 其中/ r/ =/ 31/ ./ wk0/ ←/ kLfori/ ←/ 0to/ (/ 2r/ -/ 1/ )/ doif/ (/ i/ +/ 2/ )/ mod8/ =/ 0then/ (/ k0/ ,/ k1/ ,/ k2/ ,/ k3/ ,/ k4/ ,/ k5/ ,/ k6/ ,/ k7/ )/ ←/ (/ k2/ ,/ k1/ ,/ k6/ ,/ k7/ ,/ k0/ ,/ k3/ ,/ k4/ ,/ k5/ )/ rki/ ←/ k/ (/ i/ +/ 2/ )/ mod8/ / con128i3/ 故障/ 分析/ 3.1/ 问题/ 提出/ 本质/ 上/ 来说/ ,/ 分组/ 密码/ 故障/ 分析/ 主要/ 利用/ 密码/ 正确/ // 错误/ 密文/ 同/ 故障/ 传播/ 中/ 涉及/ 到/ 的/ 相关/ 密钥/ 之间/ 的/ 关系/ 进行/ 密钥/ 破解/ ./ 以/ 针对/ 加密/ 过程/ 的/ 故障/ 攻击/ 为例/ ,/ 令/ T/ 表示/ 密码/ 运行/ 试图/ 干扰/ 的/ 加密/ 中间状态/ ,/ f/ 表示/ 注入/ 故障/ 的/ 中间状态/ 和/ 正确/ 中间状态/ 之/ Page5/ 间/ 的/ 差/ 分值/ ;/ g/ (/ )/ 表示/ 自/ 密码/ 注入/ 故障/ 后/ 的/ 加密/ 运算/ 函数/ ,/ Kf/ 表示/ 自/ 故障注入/ 后经/ 故障/ 传播/ 涉及/ 到/ 的/ 相关/ 密钥/ 变量/ ,/ h/ (/ )/ 表示/ 根据/ 密钥/ 扩展/ 得到/ 的/ Kf/ 和/ 主/ 密钥/ K/ 之间/ 的/ 相关/ 函数/ ,/ C/ 和/ C/ / 分别/ 表示/ 正确/ 和/ 错误/ 密文/ ./ 对于/ 正确/ 的/ 加密/ 样本/ 来说/ ,/ 正确/ 密文/ C/ =/ g/ (/ T/ ,/ Kf/ )/ ;/ 对于/ 注入/ 故障/ 的/ 加密/ 样本/ 来说/ ,/ 错误/ 图/ 2/ 分组/ 密码/ 故障/ 分析/ 原理/ 3.2/ 差分/ 故障/ 分析/ 现代/ 分组/ 密码/ 大都/ 使用/ S/ 盒/ 查表/ 操作/ 提高/ 密码/ 非线性/ 度/ 和/ 软件/ 执行/ 效率/ ,/ 但/ 恰恰/ 是/ 由于/ S/ 盒/ 的/ 非线性/ 特性/ ,/ 导致/ 其/ 面临/ 严重/ 的/ 故障/ 攻击/ 威胁/ ./ 假如/ 在/ 分组/ 密码/ 查表/ 时/ ,/ 在/ 最后/ 一轮/ 对/ 未知/ 查表/ 输入/ 值/ a/ 导入/ 随机/ 字节/ 故障/ f/ ,/ 一般来说/ ,/ 攻击者/ 可/ 得到/ 密文/ 差分/ f/ (/ 如/ 一个/ 字节/ 或/ Nibble/ )/ ,/ 且/ 满足/ 通过/ 一定/ 分析/ 可/ 获取/ 最后/ 一轮/ S/ 盒/ 输入/ a/ ,/ 主要/ 思路/ 是/ 通过/ 故障/ 分析/ 降低/ f/ 的/ 搜索/ 空间/ ,/ 然后/ 将/ a/ 的/ 所有/ 候选/ 值/ 、/ f/ 候选/ 值/ 、/ f/ 值/ 代入/ 式/ (/ 3/ )/ ,/ 满足/ 等式/ 的/ 值/ 作为/ a/ 的/ 有效/ 候选/ 值/ ;/ 由于/ a/ 值常同/ 扩展/ 密钥/ 紧密/ 相关/ ,/ 结合/ 密文/ 可/ 获取/ 相关/ 扩展/ 密钥/ ;/ 最后/ 根据/ 需要/ 进行/ 多样/ 本/ 分析/ 或者/ 迭代/ 分析/ 直至/ 获取/ 主/ 密钥/ ./ 可以/ 看出/ ,/ 差分/ 故障/ 的/ 关键在于/ 如何/ 获取/ 非线性/ 部件/ S/ 盒/ 的/ 故障/ 输入/ 和/ 输出/ 差分/ ./ 对于/ 大部分/ Feistel/ 结构/ 的/ 分组/ 密码/ 差分/ 故障/ 分析/ 来说/ ,/ 由于/ 其半/ 扩散/ 特性/ ,/ 如果/ F/ 函数/ 只有/ 1/ 组/ 查找/ S/ 盒/ 操作/ ,/ F/ 函数/ 的/ 输入/ 和/ 输出/ 差分/ 常可/ 从/ 密文/ 差分/ 中/ 获取/ ,/ 然后/ 代入/ 式/ (/ 3/ )/ ,/ 得到/ 查找/ S/ 盒/ 索引/ a/ 及/ 输出/ S/ [/ a/ ]/ ,/ 在/ 此基础/ 上/ 进行/ 密钥/ 恢复/ [/ 9/ ]/ ./ 以/ Camellia/ 最后/ 一轮/ 故障/ 攻击/ 为例/ ,/ 在/ Camellia/ 加密/ 最后/ 一轮/ 左/ 寄存器/ Lr/ -/ 1/ 导入/ 单字节/ 故障/ f/ ,/ 故障/ 传播/ 如图/ 3/ 所示/ ./ 易见/ ,/ 通过/ 对/ 密文/ 差分/ 进行/ 分析/ 可/ 得到/ 最后/ 一轮/ 查找/ S/ 盒/ 的/ 输入/ 差分/ f/ 和/ 输出/ 差分/ f/ ,/ 故障/ 位置/ 也/ 可/ 直观/ 得到/ ./ 将/ a/ (/ a/ =/ L0/ 个/ 候选/ 值/ 、/ f/ 、/ f/ 值/ 代入/ 式/ (/ 3/ )/ ,/ 满足/ 等式/ 的/ 值/ 作为/ a/ 的/ 有效/ 候选/ 值/ ./ 由于/ L0/ 半/ 部分/ C0/ 密文/ C/ / =/ g/ (/ T/ ,/ Kf/ ,/ f/ )/ ;/ 结合/ Kf/ 和/ 主/ 密钥/ K/ 之间/ 的/ 相关/ 函数/ Kf/ =/ h/ (/ K/ )/ ,/ 3/ 种/ 等式/ 联立/ ,/ 攻击者/ 即可/ 得到/ 密钥/ 的/ 部分/ 候选/ 值/ 集合/ ,/ 对/ 密文/ 输出/ 的/ 不同/ 部分/ 或者/ 多个/ 密文/ 分析/ 后/ 可/ 得到/ 这些/ 密钥/ 集合/ 的/ 交集/ ,/ 正确/ 的/ 密钥/ 肯定/ 在/ 交/ 集中/ ,/ 进而/ 实现/ 密钥/ 破解/ ./ 图/ 2/ 给出/ 了/ 分组/ 密码/ 故障/ 分析/ 的/ 原理/ 示意图/ ./ 次/ 导入/ 不同/ 索引/ 位置/ 故障/ 可/ 恢复/ 64/ 位/ 密钥/ kr/ / kw3/ ,/ 然后/ 通过/ 在/ 其它/ 轮/ 导入/ 故障/ ,/ 经/ 分析/ 得到/ 足够/ 的/ 相关/ 密钥/ 恢复/ 初始/ 主/ 密钥/ ./ 然而/ ,/ 对于/ Piccolo/ 分组/ 密码/ 来说/ ,/ 其/ Feistel/ 结构/ 中/ 的/ 两个/ F/ 函数/ 分别/ 由/ 查找/ S/ 盒/ -/ 列/ 混淆/ -/ 查找/ S/ 盒/ 操作/ 组成/ ,/ 虽然/ 最后/ 一轮/ 两个/ F/ 函数/ 的/ 故障/ 输入/ 差分/ (/ f1/ 和/ f3/ )/ 和/ 故障/ 输出/ 差分/ (/ f2/ 和/ f4/ )/ 均/ 为/ 已知/ ,/ 如图/ 4/ 所示/ ,/ 但/ 由于/ 轮/ 密钥/ 加/ 操作/ 和/ 白化/ 密钥/ 加/ 操作/ 的/ 影响/ ,/ 攻击者/ 并/ 不能/ 应用/ 其/ 计算/ 出/ 每个/ F/ 函数/ 的/ 第/ 1/ 组/ 查找/ S/ 盒/ 的/ 故障/ 输出/ 差分/ 和/ 第/ 2/ 组/ 查找/ S/ 盒/ 的/ 故障/ 输入/ 差分/ ,/ 如果/ 想/ 对/ 其/ 进行/ 有效/ 分析/ 只能/ 借助于/ 超级/ S/ 盒/ 概念/ [/ 30/ ]/ ,/ 将/ F/ 函数/ 的/ 3/ 个/ 操作/ 视为/ 一个/ 超级/ S/ 盒/ ,/ 在/ 此基础/ 上/ 进行/ 密钥/ 分析/ ./ Jeong/ [/ 28/ ]/ 和/ 赵/ 光耀/ 等/ 人/ [/ 29/ ]/ 的/ Piccolo/ 密码/ 攻击/ 均/ 为/ 借鉴/ 超级/ S/ 盒/ 思想/ 实现/ ./ 总之/ ,/ 应用/ 传统/ 的/ 差分/ 故障/ 分析方法/ 进行/ 密钥/ 分析/ 变得/ 较为/ 复杂/ ,/ 且/ 攻击/ 复杂度/ 将/ 随着/ 故障/ 深度/ 延伸/ 和/ 宽度/ 扩展/ 变得/ 越来越/ 大/ ./ Page6/ 图/ 4Piccolo/ 密码/ 最后/ 一轮/ 故障/ 传播/ 图/ 3.3/ 代数/ 故障/ 分析/ 为/ 克服/ 传统/ 差分/ 故障/ 分析/ 不足/ ,/ 寻找/ 通用/ 、/ 自动化/ 的/ 密钥/ 恢复/ 手段/ ,/ 将/ 代数/ 分析/ 同/ 故障/ 分析/ 结合/ 开展/ 代数/ 故障/ 分析/ 是/ 一个/ 可行/ 的/ 思路/ ./ 如图/ 5/ 所示/ ,/ 代数/ 故障/ 分析/ 一般/ 可/ 分为/ 3/ 个/ 阶段/ :/ 密码/ 算法/ 方程组/ 构建/ 、/ 故障注入/ 及/ 利用/ 和/ 代数方程/ 组/ 求解/ ./ 其中/ ,/ P/ 、/ Xi/ 、/ C/ 分别/ 表示/ 明文/ 、/ 中间状态/ 以及/ 密文/ ,/ K/ 、/ rk/ 分别/ 表示/ 主/ 密钥/ 和/ 轮/ 密钥/ ./ f/ 和/ g/ 分别/ 表示/ 加密/ 操作/ 和/ 密钥/ 扩展/ ./ X/ / i/ 和/ C/ / 分别/ 表示/ 故障/ 中间状态/ 及/ 错误/ 密文/ ,/ Δ/ Xi/ 和/ Δ/ C/ 则/ 表示/ 注入/ 故障/ 差分/ 和/ 密文/ 差分/ ./ (/ 1/ )/ 密码/ 算法/ 代数方程/ 组/ 构建/ 将/ 密码/ 算法/ 表示/ 为/ 关于/ 明文/ P/ ,/ 中间/ 变量/ X/ ,/ 密文/ C/ ,/ 密钥/ K/ 的/ 代数方程/ 组/ ,/ 在/ 密码/ 代数方程/ 组/ 构造/ 中/ ,/ 最为/ 关键/ 的/ 部分/ 是/ 如何/ 构造/ S/ 盒/ 、/ 模加/ 、/ 模减/ 等/ 非线性/ 部件/ 以及/ 矩阵/ 乘法/ 等/ 复杂/ 线性/ 部件/ 的/ 代数方程/ 组/ ./ 需要/ 说明/ 的/ 是/ ,/ 由于/ 故障/ 攻击/ 主要/ 利用/ 正确/ 密文/ 和/ 错误/ 密文/ 进行/ 密钥/ 恢复/ ,/ 为/ 加快/ 解析器/ 方程组/ 求解/ 速度/ ,/ 在/ 构建/ 加密/ 过程/ 和/ 密钥/ 扩展/ 方程组/ 时/ ,/ 经验/ 表明/ 从/ 密文/ 开始/ 逆向/ 构建/ 解密/ 方程组/ 效果/ 比较/ 好/ ./ (/ 2/ )/ 故障注入/ 及/ 利用/ 在/ 构建/ 密码/ 算法/ 等效/ 代数方程/ 组/ 之后/ ,/ 需要/ 进行/ 故障注入/ 和/ 利用/ ./ 故障注入/ 的/ 方法/ 有/ 很多/ ,/ 如/ 光学/ 辐射/ 诱导/ 、/ 电压/ 故障/ 诱导/ 、/ 临界温度/ 诱导/ 、/ 电磁辐射/ 诱导/ 等/ ./ 由于/ 故障注入/ 不是/ 本文/ 研究/ 重点/ ,/ 更/ 多/ 相关/ 内容/ 可/ 参考文献/ [/ 1/ -/ 2/ ]/ ./ 故障/ 利用/ 的/ 主要/ 思想/ 是/ 将/ 故障注入/ 差分/ Δ/ X/ 和/ 密文/ 输出/ 差分/ Δ/ C/ 使用/ 代数方程/ 组/ 表示/ ,/ 同/ 密码/ 算法/ 代数方程/ 组/ 联立/ ,/ 降低/ 代数方程/ 组/ 的/ 求解/ 复杂度/ ,/ 加快/ 方程组/ 求解/ 速度/ ./ (/ 3/ )/ 代数方程/ 组/ 求解/ 将/ 故障/ 信息/ 代数方程/ 组同/ 密码/ 算法/ 方程组/ 联立/ 后/ ,/ 密钥/ 恢复/ 攻击/ 等价/ 于/ 方程组/ 求解/ 问题/ ./ 典型/ 的/ 代数方程/ 组/ 求解/ 主要/ 包括/ 基于/ 可/ 满足/ 性/ 问题/ [/ 31/ ]/ (/ 使用/ zChaff/ 、/ Minisat/ 、/ CryptoMinisat/ 等/ 解析器/ )/ 、/ 基于/ 最优化/ 问题/ (/ 使用/ CPLEX/ 、/ SCIP/ 解析器/ )/ 、/ 基于/ 线性化/ (/ 直接/ 线性化/ XL/ 、/ 扩展/ 线性化/ XSL/ )/ 、/ 基于/ Grbner/ 基/ [/ 32/ ]/ 等/ 方法/ ./ 4Piccolo/ 代数/ 故障/ 分析/ 4.1/ 故障/ 模型/ 设定/ Piccolo/ 算法/ 可/ 采用/ 以/ Nibble/ (/ 4bit/ )/ 、/ 字节/ (/ 8bit/ )/ 甚至/ 字/ (/ 32bit/ )/ 为/ 基本/ 运算/ 单位/ 进行/ 实现/ ,/ 本/ 节/ 故障/ 模型/ 主要/ 面向/ Nibble/ 的/ 随机/ 故障/ 模型/ ,/ 但/ 其/ 分析方法/ 可/ 被/ 扩展/ 到/ 其它/ 故障/ 模型/ ./ 此外/ ,/ 如/ 无/ 特别/ 说明/ ,/ 下文/ 中/ Piccolo/ 均/ 指/ Piccolo/ -/ 80/ 算法/ ./ 本节/ 故障/ 模型/ 如图/ 6/ 所示/ ,/ 其/ 基本/ 假设/ 如下/ :/ 攻击者/ 每次/ 可以/ 诱发/ Piccolo/ 加密/ 过程/ 中/ 某/ 一轮/ F/ 函数/ 的/ 一个/ 运算/ 单元/ 发生/ 错误/ ,/ 但/ 无需/ 知道/ 具/ Page7/ 图/ 6/ 故障/ 模型/ 体/ 错误/ 位置/ 和/ 错误/ 值/ ./ 对于/ Piccolo/ 攻击/ ,/ 本/ 节/ 假定/ 攻击者/ 可/ 在/ Piccolo/ 加密/ 倒数第/ 3/ 轮/ ,/ 即/ 第/ 23/ 轮/ 的/ F/ 函数/ 输入/ 产生/ 一个/ Nibble/ 的/ 故障/ ,/ 具体/ 的/ 故障注入/ 位置/ 有/ 多种/ ,/ 如/ 第/ 23/ 轮/ F/ 函数/ 输入/ 、/ 第/ 22/ 轮/ F/ 函数/ Nibble/ 混淆/ 、/ 第/ 22/ 轮/ F/ 函数/ 第/ 2/ 组/ Nibble/ 代换/ 、/ 第/ 22/ 轮轮/ 密钥/ 加/ 等/ 位置/ ,/ 具体/ 可见/ 图/ 6/ 中/ 任意/ 的/ 一个/ 箭头/ 所/ 标示/ 位置/ ./ 需要/ 说明/ 的/ 是/ ,/ 我们/ 统一/ 将/ 能/ 使/ 第/ 23/ 轮/ F/ 函数/ 输入/ 产生/ 1/ 个/ Nibble/ 的/ 故障/ 模型/ 都/ 视为/ 第/ 23/ 轮/ 故障/ 模型/ ./ 此外/ ,/ 对/ 同一个/ 明文/ 而言/ ,/ 攻击者/ 可/ 获得/ 同一个/ 密钥/ 作用/ 下/ 的/ 正确/ 密文/ 和/ 错误/ 密文/ ./ 4.2/ 密码/ 代数方程/ 组/ 构建/ 由于/ 故障/ 攻击/ 从/ 密文/ 开始/ 进行/ 分析/ ,/ 因此/ 建立/ Piccolo/ 密码/ 解密/ 方程组/ 可以/ 加速/ 代数/ 故障/ 攻击/ 求解/ 过程/ ,/ 该/ 思想/ 在/ 文献/ [/ 13/ ]/ 也/ 有所/ 说明/ ./ 假定/ Ai/ =/ Ai/ ,/ 1/ (/ 16/ )/ |/ Ai/ ,/ 2/ (/ 16/ )/ |/ Ai/ ,/ 3/ (/ 16/ )/ |/ Ai/ ,/ 4/ (/ 16/ )/ 表示/ 第/ i/ 轮/ 64bit/ 输出/ ,/ Bi/ =/ Bi/ ,/ 1/ (/ 16/ )/ |/ Bi/ ,/ 2/ (/ 16/ )/ |/ Bi/ ,/ 3/ (/ 16/ )/ |/ Bi/ ,/ 4/ (/ 16/ )/ 表示/ 第/ i/ 轮/ RP/ 函数/ 64bit/ 输出/ ,/ C/ =/ C1/ (/ 16/ )/ |/ C2/ (/ 16/ )/ |/ C3/ (/ 16/ )/ |/ C4/ (/ 16/ )/ 表示/ 64bit/ 密文/ ,/ Ai/ ,/ j/ (/ 16/ )/ 、/ Bi/ ,/ j/ (/ 16/ )/ 、/ Aj/ (/ 16/ )/ 宽度/ 为/ 16bit/ (/ 1/ / i/ / 25/ ,/ 1/ / j/ / 4/ )/ ./ 由于/ Piccolo/ 密钥/ 扩展/ 较为简单/ ,/ 下面/ 仅/ 给出/ Piccolo/ 解密/ 方程组/ 构建/ 方法/ ,/ 如式/ (/ 4/ )/ 所示/ ./ Page8C/ =/ C1/ |/ C2/ |/ C3/ |/ C4/ 烄/ A25/ ,/ 1/ =/ C1/ / wk2/ ,/ A25/ ,/ 2/ =/ F/ (/ A25/ ,/ 1/ )/ / C2/ / rk48A25/ ,/ 3/ =/ C3/ / wk3/ ,/ A25/ ,/ 4/ =/ F/ (/ A25/ ,/ 3/ )/ / C4/ / rk49fori/ =/ 24to2do/ {/ Ai/ +/ 1/ =/ RP/ (/ Bi/ )/ Ai/ ,/ 1/ =/ Bi/ ,/ 1/ ,/ Ai/ ,/ 2/ =/ F/ (/ Ai/ ,/ 1/ )/ / Bi/ ,/ 2/ / rk2i/ -/ 2/ 烅/ Ai/ ,/ 3/ =/ Bi/ ,/ 3/ ,/ Ai/ ,/ 4/ =/ F/ (/ Ai/ ,/ 3/ )/ / Bi/ ,/ 4/ / rk2i/ -/ 1/ }/ A2/ =/ RP/ (/ B1/ )/ A1/ ,/ 1/ =/ B1/ ,/ 1/ / wk0/ ,/ A1/ ,/ 2/ =/ F/ (/ A1/ ,/ 1/ )/ / B1/ ,/ 2/ / rk0A1/ ,/ 3/ =/ B1/ ,/ 3/ / wk1/ ,/ A1/ ,/ 4/ =/ F/ (/ A1/ ,/ 3/ )/ / B1/ ,/ 4/ / rk1/ 烆/ P/ =/ A1/ ,/ 1/ |/ A1/ ,/ 2/ |/ A1/ ,/ 3/ |/ A1/ ,/ 根据/ 式/ (/ 4/ )/ 可以/ 看出/ ,/ 如何/ 构建/ F/ 函数/ 中/ 的/ Nibble/ 代换/ 和/ Nibble/ 混淆/ 是/ 重点/ 和/ 难点/ 问题/ ,/ 下面/ 分别/ 给出/ 其/ 具体/ 构建/ 方法/ ./ (/ 1/ )/ Nibble/ 代换/ 代数方程/ 组/ 构建/ 令/ X/ =/ X1/ |/ X2/ |/ X3/ |/ X4/ 和/ Y/ =/ Y1/ |/ Y2/ |/ Y3/ |/ Y4/ 分别/ 表示/ Nibble/ 代换/ 的/ 16bit/ 输入/ 和/ 输出/ ,/ 则/ Y/ 可/ 表示/ 为/ Y1/ =/ S/ (/ X1/ )/ ,/ Y2/ =/ S/ (/ X2/ )/ ,/ Y3/ =/ S/ (/ X3/ )/ ,/ Y4/ =/ S/ (/ X4/ )/ 式/ (/ 5/ )/ 中/ ,/ S/ (/ )/ 表示/ 一次/ 查找/ S/ 盒/ 操作/ ./ 假设/ S/ 盒/ 输入/ 和/ 输出/ 分别/ 用/ x1/ |/ x2/ |/ x3/ |/ x4/ 和/ y1/ |/ y2/ |/ y3/ |/ y4/ 来/ 表示/ ,/ 我们/ 利用/ 基于/ 布尔/ 函数/ 理论/ ,/ 参考文献/ [/ 33/ ]/ 中/ 方法/ ,/ 将/ Piccolo/ 的/ S/ 盒用/ 4/ 个/ 等式/ 表示/ 出来/ :/ 烄/ 烅/ x3x4/ +/ x1x2x3/ =/ 0y4/ +/ x1/ +/ x2/ +/ x3/ +/ x1x3/ +/ x1x4/ +/ x2x4/ +/ x3x4/ +/ x1x2x3/ +/ x2x3x4/ 烆/ (/ 2/ )/ Nibble/ 混淆/ 代数方程/ 组/ 构建/ 令/ X/ =/ X1/ |/ X2/ |/ X3/ |/ X4/ 和/ Y/ =/ Y1/ |/ Y2/ |/ Y3/ |/ Y4/ 分别/ 表示/ Nibble/ 混淆/ 的/ 16bit/ 输入/ 和/ 输出/ ,/ 则/ Y/ 可/ 表示/ 为/ 烄/ 烅/ 烆/ 其中/ ,/ “/ ·/ ”/ 表示/ GF/ (/ 24/ )/ 域/ 上/ 的/ 乘法/ 运算/ ./ 在/ Nibble/ 混淆/ 中/ ,/ 输出/ 矩阵/ 由/ 混淆/ 矩阵/ 犕/ 和/ 输入/ 状态/ 矩阵/ 相乘/ 得到/ ,/ 对于/ 某次/ 乘法/ 操作/ 来说/ ,/ 根据/ 犕/ 中/ 的/ 3/ 个/ 不同/ 元素/ ,/ 将/ 4bit/ 输入/ x1/ |/ x2/ |/ x3/ |/ x4/ 转化/ 为/ 对应/ 4bit/ 输出/ y1/ |/ y2/ |/ y3/ |/ y4/ ,/ 不同/ 矩阵/ 元素/ 对应/ 输出/ 如表/ 2/ 所示/ ./ 元素/ y1y21x1x22x2x3x1/ +/ x4x13x1/ +/ x2x2/ +/ x3x1/ +/ x3/ +/ x4x1/ +/ x4/ 将式/ (/ 5/ )/ ~/ (/ 7/ )/ 代入/ 到式/ (/ 4/ )/ ,/ 每个/ 解密/ 轮/ 需/ 引入/ 544/ 个/ 变量/ 和/ 928/ 个/ ANF/ 等式/ ./ 另外/ ,/ 每轮/ 扩展/ 密钥/ 需/ 引入/ 32/ 个/ 变量/ 和/ 32/ 个/ ANF/ 等式/ ,/ 白化/ 密钥/ 需/ 引入/ 64/ 个/ 变量/ 和/ 64/ 个/ ANF/ 等式/ ./ 4.3/ 故障/ 差分/ 利用/ 与/ 表示/ 下面/ 给出/ 故障注入/ 索引/ 未知/ 条件/ 下/ 的/ 故障/ 差分/ 表示/ 方法/ ./ 以/ Piccolo/ 密码/ 代数/ 故障/ 分析/ 中/ 故障/ 差分/ 表示/ 为例/ ,/ 令/ 第/ 23/ 轮/ 的/ 正确/ 输入/ X/ 用/ x1/ |/ x2/ |/ …/ |/ x16/ 表示/ ,/ X/ 注入/ 一个/ Nibble/ 的/ 随机/ 故障/ 后/ 的/ 值用/ Y/ =/ y1/ |/ y2/ |/ …/ |/ y16/ 来/ 表示/ ,/ Z/ 表示/ 故障/ 差分/ ,/ 则/ Z/ 可/ 表示/ 为/ Z/ =/ z1/ |/ z2/ |/ …/ |/ z16/ ,/ zi/ =/ xi/ / yi/ ,/ 1/ / i/ / 16/ (/ 8/ )/ 将/ Z/ 划分/ 为/ 4/ 个/ Nibble/ ,/ 假设/ 可/ 表示/ 为/ Z1/ |/ Z2/ |/ Z3/ |/ Z4/ ,/ Zi/ =/ z4/ ×/ i/ -/ 3/ |/ z4/ ×/ i/ -/ 2/ |/ z4/ ×/ i/ -/ 1/ |/ z4/ ×/ i/ (/ 1/ / i/ / 4/ )/ ,/ 再/ 引入/ 4/ 个/ 比特/ 的/ 变量/ ui/ 来/ 表示/ Zi/ 是否/ 为/ 故障注入/ Nibble/ ,/ 则/ ui/ 可/ 表示/ 为/ ui/ =/ (/ 1/ / z4/ ×/ i/ -/ 3/ )/ |/ (/ 1/ / z4/ ×/ i/ -/ 2/ )/ |/ (/ 1/ / z4/ ×/ i/ -/ 1/ )/ |/ (/ 1/ / z4/ ×/ i/ )/ ,/ 如果/ ui/ =/ 0/ ,/ 则/ 表示/ Zi/ 为/ 故障注入/ Nibble/ ,/ 否则/ 不是/ 故障注入/ 位置/ ./ 因为/ 仅/ 有/ 1/ 个/ Nibble/ 出现/ 故障/ ,/ 则/ u1/ |/ u2/ |/ u3/ |/ u4/ 中/ 只有/ 一个/ 为/ 0/ ,/ 则/ 可/ 表示/ 为/ (/ 1/ -/ u1/ )/ ∨/ (/ 1/ -/ u2/ )/ ∨/ (/ 1/ -/ u3/ )/ ∨/ (/ 1/ -/ u4/ )/ =/ 1/ ,/ 根据/ 上面/ 方法/ ,/ 基于/ Nibble/ 的/ 故障/ 差分/ 可用/ 式/ (/ 8/ )/ ~/ (/ 10/ )/ 来/ 进行/ 表示/ ,/ 代数方程/ 十分/ 简单/ ./ 每次/ 故障注入/ 仅/ 需/ 引入/ 24/ 个/ 变量/ 和/ 47/ 个/ ANF/ 等式/ ./ 需要/ 说明/ 的/ 是/ ,/ 上述/ 公式/ 经/ 简单/ 扩展/ 后/ 可/ 适用/ 于/ 基于/ 其它/ 宽度/ 的/ 故障/ 差分/ 表示/ ,/ 如/ 字节/ 故障/ 差分/ 、/ 字/ 故障/ 差分/ 等/ ./ 4.4/ 代数方程/ 组/ 求解/ 典型/ 的/ 代数方程/ 组/ 求解/ 工具/ 有/ 很多/ ,/ 本文/ 主要/ 选取/ 基于/ 可/ 满足/ 性/ 问题/ 的/ CryptoMinisat/ 解析器/ ./ 在/ 代数方程/ 组/ 构建/ 过程/ 中/ ,/ 布尔/ 降幂/ 和/ 布尔/ 切割/ 是/ 两大/ 难题/ ./ CryptoMinisat/ 解析器/ 较/ 好/ 的/ 解决/ 了/ 布尔/ 切割/ 问题/ ,/ 对于/ x1/ +/ x2/ +/ …/ +/ xn/ 这样/ 的/ 一个/ 异或/ 操作/ ,/ 如果/ 变量/ 2/ 到/ n/ +/ 1/ 分别/ 表示/ x1/ 到/ xn/ ,/ 则/ 该/ 异或/ 操作/ 可用/ “/ x123/ …/ n/ +/ 10/ ”/ 一条/ 语句/ 表示/ ./ 攻击/ 中/ 首先/ 将/ Piccolo/ 加密/ 和/ 旁路/ 泄露/ 布尔/ 方程组/ 转化/ 为/ 符合/ CryptoMinisat/ 输入/ 格式/ 的/ 文本文件/ ,/ 然后/ 以/ 命令行/ 方式/ 调用/ 解析器/ 进行/ 求解/ ./ Page95/ 攻击/ 实验/ 5.1/ 实验/ 配置/ 本文/ 主要/ 对/ 故障/ 分析/ 进行/ 研究/ ,/ 故障注入/ 不是/ 本文/ 的/ 研究/ 重点/ ,/ 故/ 文中/ 故障/ 均/ 为/ 计算机/ 仿真/ 模拟/ 实现/ ,/ 使用/ C++/ 编程语言/ (/ Visual/ C++/ 6.0/ 环境/ )/ 通过/ 修改/ Piccolo/ 加密/ 过程/ 仿真/ 故障注入/ ./ 在/ 方程组/ 求解/ 过程/ 中/ ,/ 使用/ CryptoMinisat/ 解析器/ 进行/ 密钥/ 求解/ ,/ 解析器/ 版本/ 为/ 2.9/ ./ 4/ ,/ 运行/ 解析器/ 的/ PC机/ 配置/ 为/ Intel/ (/ R/ )/ Core/ (/ TM/ )/ I7/ -/ 2640M/ 、/ 2.80/ GHz/ 、/ 4GB/ 内存/ 、/ WindowsXP64/ 位/ 操作系统/ ./ 5.2/ Nibble/ 故障/ 模型/ 下/ Piccolo/ -/ 80/ 攻击/ 实例/ 的/ 一个/ 实例/ :/ 下面/ 给出/ Nibble/ 故障/ 模型/ 下/ 的/ 代数/ 故障/ 分析/ (/ 1/ )/ Piccolo/ 代数方程/ 组/ 构建/ 首先/ 产生/ 随机/ 明文/ P/ =/ 0X3CB19A75B8B476DC/ ,/ 密钥/ K/ =/ 0XCE076DFB5300F7EA6BF1/ ,/ 正确/ 密文/ C/ =/ 0XBC81C26238001C7C/ ./ 根据/ 4.2/ 节/ 方法/ 建立/ 对/ P/ 用/ K/ 进行/ Piccolo/ 正确/ 加密/ 的/ 完整/ 代数方程/ 组/ ,/ 全轮/ 共/ 引入/ 17129/ 个/ 变量/ 和/ 28016/ 个/ ANF/ 等式/ ,/ 每个/ 脚本/ 553K/ 大小/ ./ (/ 2/ )/ 故障注入/ 及/ 故障/ 差分/ 表示/ 通过/ 计算机软件/ 仿真/ Piccolo/ 加密/ 倒数第/ 3/ 轮/ 输入/ 注入/ 一个/ Nibble/ 的/ 故障/ ,/ 得到/ 错误/ 密文/ C/ / =/ 0XC6F545612C08C9D4/ ,/ 将/ 故障/ 样本/ 的/ 倒数/ 3/ 轮/ 加密/ 用/ 代数方程/ 表示/ ./ 在/ 此基础/ 上/ ,/ 应用/ 4.3/ 节/ 方法/ 将/ 注入/ 的/ 故障/ 差分/ 进行/ 表示/ ./ (/ 3/ )/ 基于/ 可/ 满足/ 性/ 的/ 代数方程/ 求解/ 使用/ CryptoMinisat/ 进行/ 密钥/ 求解/ ,/ 结果/ 如表/ 3/ 所示/ ./ 编号/ 2/ 至/ 81/ 依次/ 表示/ 80/ -/ bit/ 初始/ 密钥/ 比特/ ,/ 编号/ 为/ 正/ 表示/ 对应/ 密钥/ 位为/ 1/ ,/ 否则/ 为/ 0/ ./ 根据/ 表/ 3/ ,/ 编号/ 密钥/ 21221/ -/ 42062131231/ -/ 430/ -/ 630/ -/ 40/ -/ 240/ -/ 440641/ -/ 50251/ -/ 450/ -/ 65061261/ -/ 460/ -/ 66071271/ -/ 47067181281/ -/ 480681/ -/ 90291/ -/ 490/ -/ 690/ -/ 100301501701/ -/ 110/ -/ 310511/ -/ 710/ -/ 120321521721/ -/ 130331531731/ -/ 140/ -/ 340/ -/ 540741151351551751/ 编号/ 密钥/ 161/ -/ 360561761171371571771/ -/ 180/ -/ 380581/ -/ 780191/ -/ 390591/ -/ 790201401601/ -/ 800/ -/ 210411/ -/ 610811/ 求解/ 密钥/ 二进制/ 表示/ 为/ 11001110000001110110110111111011010100110000000011110111111010100110101111110001/ ,/ 转化/ 为/ 16/ 进制/ 即/ CE076DFB5300F7EA6BF1/ ,/ 同/ 真实/ 主/ 密钥/ 一致/ ,/ 攻击/ 成功/ ./ 攻击/ 中/ ,/ 随机/ 产生/ 10/ 组/ 不同/ 的/ 密钥/ 和/ 明文/ ,/ 执行/ 了/ 10/ 次/ 实验/ ./ 1/ 次/ 故障注入/ 条件/ 下/ ,/ 使用/ Crypto/ -/ Minisat/ 解析器/ 的/ 密钥/ 求解/ 时间/ 如表/ 4/ 所示/ ./ 最短/ 求解/ 时间/ 为/ 0.5/ h/ ,/ 最长/ 时间/ 为/ 10h/ ,/ 平均/ 求解/ 时间/ 约/ 为/ 5h/ ./ 相比/ Jeong/ [/ 28/ ]/ 攻击/ 需要/ 的/ 6/ 次/ 和/ 赵/ 光耀/ 等/ 人/ [/ 29/ ]/ 攻击/ 所/ 需要/ 的/ 2/ 次/ 故障注入/ ,/ 本文/ 只/ 需/ 1/ 次/ 故障注入/ ./ 表/ 4/ 基于/ CryptoMinisat/ 解析器/ 的/ 密钥/ 求解/ 时间/ 序号/ 时间/ // h/ 序号/ 样本/ 14.7/ 样本/ 20.5/ 样本/ 36.4/ 样本/ 42.3/ 样本/ 510.0/ 样本/ 105.6/ 此外/ ,/ 本文/ 还/ 在/ 注入/ 两次/ Nibble/ 故障/ 条件/ 下/ 进行/ 了/ 两类/ 攻击/ 实验/ ,/ 分别/ 执行/ 100/ 次/ 攻击/ 实验/ ./ 第/ 1/ 类/ 是/ 将/ 故障注入/ 到/ 加密/ 第/ 24/ 轮/ 输入/ ,/ 两次/ 故障注入/ 可/ 在/ 20min/ 左右/ 恢复/ 80/ 位/ 密钥/ ;/ 第/ 2/ 类/ 是/ 将/ 故障注入/ 到/ 加密/ 第/ 23/ 轮/ 输入/ ,/ 80/ 位/ 密钥/ 求解/ 可/ 在/ 700s/ 内/ 完成/ ,/ 平均/ 时间/ 为/ 200s/ ,/ 密钥/ 求解/ 时间/ 分布/ 如图/ 7/ 所示/ ./ Page105/ ./ 3/ 不同/ 故障/ 模型/ 下/ Piccolo/ -/ 80/ 攻击/ 实验/ 中/ ,/ 考虑/ 两种/ 故障/ 模型/ ,/ (/ 1/ )/ 8bit/ 和/ 16bit/ 不同/ 宽度/ 的/ 故障/ 模型/ ,/ (/ 2/ )/ 第/ 22/ 轮/ F/ 函数/ 输入/ 产生/ 一个/ Nibble/ 的/ 故障/ 模型/ (/ 故障注入/ 位置/ 可/ 在/ 第/ 22/ 轮/ F/ 函数/ 输入/ ,/ 第/ 21/ 轮/ F/ 函数/ Nibble/ 混淆/ 、/ 第/ 2/ 组/ Nibble/ 代换/ 、/ 轮/ 密钥/ 加/ 等/ 位置/ )/ ,/ 对/ Piccolo/ -/ 80/ 算法/ 分别/ 执行/ 了/ 10/ 次/ 代数/ 故障/ 攻击/ 实验/ ,/ 攻击/ 实验/ 结果/ 如表/ 5/ 所示/ ./ 第/ 23/ 轮/ 8bit/ 故障/ 模型/ 1/ 第/ 23/ 轮/ 16bit/ 故障/ 模型/ 1/ 第/ 22/ 轮/ 4bit/ 故障/ 模型/ 2/ 第/ 22/ 轮/ 8bit/ 故障/ 模型/ 2/ 可见/ 基于/ 第/ 23/ 轮/ 宽度/ 故障/ 模型/ ,/ 攻击/ 仅/ 需/ 1/ 次/ 故障注入/ 即可/ 恢复/ 密钥/ ;/ 基于/ 第/ 22/ 轮/ 深度/ 故障/ 模型/ ,/ 攻击/ 仅/ 需/ 2/ 次/ 故障注入/ 即可/ 恢复/ 密钥/ ./ 5.4/ Piccolo/ -/ 128/ 攻击/ 为/ 验证/ 攻击/ 对/ 其它/ 密钥/ 长度/ 的/ Piccolo/ 算法/ 适用性/ ,/ 本文/ 将/ 攻击/ 扩展/ 到/ Piccolo/ -/ 128/ 算法/ ,/ 基于/ 不同/ 故障/ 位置/ ,/ 执行/ 了/ 多种/ 故障/ 攻击/ 实验/ (/ 每种/ 分别/ 执行/ 10/ 次/ 攻击/ 实验/ )/ ./ 同时/ ,/ 由于/ Piccolo/ -/ 128/ 的/ 密钥/ 长度/ 更长/ ,/ 同/ Piccolo/ -/ 80/ 代数/ 故障/ 攻击/ 相比/ ,/ Piccolo/ -/ 128/ 攻击/ 所/ 需/ 故障/ 次数/ 要/ 稍微/ 多些/ ./ 根据/ Piccolo/ -/ 128/ 算法/ 设计/ ,/ 恢复/ 主/ 密钥/ 需要/ 至少/ 恢复/ 最后/ 4/ 轮/ 扩展/ 密钥/ ,/ 因此/ 需要/ 在/ 倒数第/ 2/ 或/ 3/ 轮/ 和/ 5/ 或/ 6/ 轮/ 注入/ 多次/ 故障/ 实现/ ./ 本文/ Piccolo/ -/ 128/ 代数/ 故障/ 攻击/ 模型/ 、/ 故障注入/ 次数/ 和/ 平均/ 密钥/ 求解/ 时间/ 如表/ 6/ 所示/ ./ 第/ 29/ 轮/ (/ 2/ 个/ )/ +/ 第/ 29/ 轮/ (/ 2/ 个/ )/ +/ 第/ 30/ 轮/ (/ 2/ 个/ )/ +/ 第/ 26/ 轮/ Nibble/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 27/ 轮/ Nibble/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 27/ 轮/ Nibble/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 26/ 轮/ Byte/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 27/ 轮/ Byte/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 27/ 轮/ Byte/ 故障/ (/ 1/ 个/ )/ 3/ 第/ 29/ 轮/ (/ 2/ 个/ )/ +/ 第/ 29/ 轮/ (/ 2/ 个/ )/ +/ 第/ 30/ 轮/ (/ 2/ 个/ )/ +/ 根据/ 表/ 6/ ,/ 代数/ 故障/ 攻击/ 成功/ 所/ 需/ 的/ 故障注入/ 位置/ 比较/ 灵活/ ,/ 在/ 倒数第/ 2/ 或者/ 第/ 3/ 轮/ 注入/ 2/ 次/ 故障/ 、/ 倒数第/ 5/ 或者/ 6/ 轮/ 注入/ 1/ 次/ 故障/ ,/ 共/ 3/ 次/ 故障/ 即可/ 快速/ 恢复/ 128/ 位/ 完整/ 密钥/ ./ 5.5/ 其它/ 分组/ 密码/ 攻击/ 为/ 验证/ 攻击/ 方法/ 对/ 不同/ 分组/ 密码/ 的/ 适用性/ ,/ 我们/ 还/ 将/ 攻击/ 扩展/ 到/ AES/ 、/ DES/ 、/ PRESENT/ 、/ LED/ 、/ MIBS/ 、/ GOST/ 等/ 密码/ 算法/ ,/ 执行/ 多种/ 代数/ 故障/ 分析/ 实验/ ./ 攻击者/ 仅/ 需/ 建立/ 密码/ 算法/ 和/ 故障/ 模型/ 对应/ 的/ 代数方程/ 即可/ ,/ 无需/ 对/ 故障注入/ 位置/ (/ 已知/ 故障注入/ 轮/ 的/ 某个/ 操作/ ,/ 但轮/ 中/ 具体操作/ 的/ 位置/ 未知/ )/ 、/ 故障/ 传播/ 过程/ 进行/ 繁琐/ 的/ 手工/ 分析/ ,/ 可/ 最大/ 程度/ 利用/ 计算资源/ ,/ 攻击/ 所/ 需/ 故障注入/ 次数/ 和/ 平均/ 密钥/ 求解/ 时间/ 如表/ 7/ 所示/ ./ 表/ 7/ 不同/ 轻量级/ 分组/ 密码/ 代数/ 故障/ 攻击/ 结果/ 密码/ 算法/ AES/ 倒数第/ 3/ 轮/ 字节/ 故障/ DES/ 倒数第/ 5/ 轮单/ 比特/ 、/ PRESENT/ 倒数第/ 3/ 轮/ Nibble/ 故障/ 230sMIBS/ 倒数第/ 3/ 轮/ Nibble/ 故障/ 110minLED/ [/ 13/ ]/ 倒数第/ 3/ 轮/ Nibble/ 故障/ 13minGOST/ 倒数第/ 3/ ,/ 5/ ,/ 7/ ,/ 9/ 轮/ Nibble/ 故障/ 82min/ 需要/ 说明/ 的/ 是/ ,/ 表/ 7/ 中/ 这些/ 分组/ 密码/ 代数/ 故障/ 分析/ 所/ 需/ 故障注入/ 次数/ 均/ 为/ 目前/ 最小值/ ./ 如/ 在/ DES/ 密码/ 攻击/ 中/ ,/ 如果/ 能够/ 在/ 第/ 12/ 轮/ 注入/ 单/ 比特/ 、/ 单/ Nibble/ 或/ 单字节/ 故障/ ,/ 1/ 次/ 故障注入/ 平均/ 即可/ 在/ 2min/ 内/ 恢复/ 密钥/ ,/ 相比/ Courtois/ 等/ 人/ [/ 19/ ]/ 应用/ 代数/ 故障/ 分析/ 需在/ 已知/ 24bit/ 密钥/ 前提/ 下/ 实施/ 、/ CHES2009/ 上/ Rivain/ [/ 34/ ]/ 应用/ 差分/ 故障/ 分析/ 需要/ 的/ 7/ ~/ 11/ 次/ 故障注入/ 的/ 结果/ 要/ 好/ ./ 此外/ ,/ 我们/ 还/ 可以/ 看出/ 代数/ 故障/ 分析/ 通用性/ 良好/ ,/ 分析/ 过程/ 比较简单/ ,/ 将/ 传统/ 差分/ 故障/ 分析/ 中/ 手工/ 分析/ 的/ 复杂性/ 转化/ 为/ 解析器/ 求解/ 代数方程/ 中/ 自动/ 分析/ 的/ 计算/ 复杂性/ ,/ 对于/ 代数/ 结构/ 简单/ 的/ 轻量级/ 分组/ 密码/ 算法/ 和/ 合适/ 的/ 故障/ 模型/ ,/ 密钥/ 求解/ 时间/ 较/ 短/ ,/ 如/ DES/ 、/ PRESENT/ 、/ MIBS/ 、/ LED/ 、/ GOST/ ;/ 而/ 对于/ 采用/ 了/ 大S/ 盒/ 、/ 代数/ 结构/ 较为/ 复杂/ 的/ 分组/ 密码/ 算法/ ,/ 密钥/ 求解/ 时间/ 较长/ ,/ 如/ AES/ ./ 相信/ 未来/ 随着/ 代数方程/ 求解/ 算法/ 和/ 解析器/ 的/ 改进/ ,/ 针对/ 复杂/ 代数/ 结构/ 分组/ 密码/ 算法/ 下/ 的/ 代数/ 故障/ 攻击/ 效果/ 将会/ 逐渐/ 接近/ 甚至/ 超越/ 差分/ 故障/ 分析/ ./ 6/ 代数/ 故障/ 分析/ 讨论/ 6.1/ 特点/ 分析/ 本文/ 应用/ 代数/ 故障/ 分析方法/ 对/ Piccolo/ 进行/ 改进/ 故障/ 分析/ ,/ 并/ 对/ DES/ 、/ PRESENT/ 、/ MIBS/ 、/ LED/ 、/ GOST/ 等/ 轻量级/ 分组/ 密码/ 开展/ 了/ 大量/ 的/ 扩展/ 分析/ 实/ Page11/ (/ 2/ )/ 离线/ 分析方法/ 简单/ ./ 在/ 故障/ 分析/ 过程/ 中/ ,/ 攻击者/ 只/ 需/ 建立/ 密码/ 算法/ 、/ 故障注入/ 差分/ 的/ 方程/ 应用/ 解析器/ 进行/ 密钥/ 求解/ 即可/ ,/ 无需/ 结合/ 算法/ 和/ 故障/ 模型/ 对/ 故障/ 的/ 差分/ 传播/ 特征/ 逐轮/ 进行/ 繁琐/ 的/ 差分/ 故障/ 分析/ ,/ 无需/ 对/ 故障注入/ 位置/ 进行/ 手工/ 推断/ ,/ 自动化/ 程度较高/ ./ (/ 3/ )/ 计算资源/ 利用率/ 高/ ./ 可/ 将/ 故障/ 攻击/ 下/ 的/ 密钥/ 恢复/ 转化/ 为/ 代数方程/ 组/ 求解/ 问题/ ,/ 将/ 密码/ 分析/ 质/ 的/ 困难性/ 转化/ 为量/ 的/ 复杂性/ ,/ 是/ 一种/ 脑力劳动/ 的/ 机械化/ ./ 分析/ 适用/ 于/ 计算机/ 计算/ ,/ 从而/ 可以/ 充分/ 利用计算机/ 优势/ ,/ 实现/ 金钱/ 到/ 能力/ 的/ 转化/ ./ 验/ ./ 结果表明/ ,/ 轻量级/ 分组/ 密码/ 代数/ 故障/ 分析/ 具有/ 下列/ 特性/ :/ (/ 1/ )/ 在线/ 故障注入/ 较少/ ./ 以/ Piccolo/ -/ 80/ 故障/ 分析/ 为例/ ,/ 在/ 其/ 加密/ 第/ 23/ 轮/ 注入/ 一个/ 宽度/ 为/ 4bit/ 的/ 故障/ ,/ 故障/ 数值/ 和/ 位置/ 均/ 为/ 未知/ ,/ 1/ 次/ 故障注入/ 平均/ 经/ 5h/ 离线/ 分析/ 、/ 2/ 次/ 故障注入/ 平均/ 经/ 3min/ 离线/ 分析/ 即可/ 恢复/ 80/ 位/ 完整/ 密钥/ ,/ 故障注入/ 次数/ 最少/ ./ (/ 4/ )/ 扩展性/ 通用性/ 良好/ ./ 一是/ 适用/ 故障/ 模型/ 扩展性/ 好/ ./ 针对/ Piccolo/ -/ 80/ 密码/ ,/ 分析/ 可/ 被/ 直接/ 扩展/ 到/ 8bit/ 、/ 16bit/ 等/ 宽度/ 故障/ 模型/ 以及/ 第/ 22/ 轮/ 深度/ 故障/ 模型/ ;/ 二是/ 适用/ 密码/ 算法/ 通用性/ 好/ ,/ 分析/ 可/ 被/ 扩展/ 至/ Piccolo/ -/ 128/ 密码/ ,/ 仅/ 需/ 3/ 次/ 故障注入/ 分析/ 即可/ 恢复/ 128/ 位/ 密钥/ ,/ 故障注入/ 轮/ 位置/ 可/ 有/ 多种/ 选择/ ;/ 此外/ ,/ 分析/ 还/ 可/ 适用/ 于/ DES/ 、/ PRESENT/ 、/ LED/ 、/ MIBS/ 、/ GOST/ 等/ 分组/ 密码/ 算法/ ,/ 均/ 能/ 在/ 较/ 低/ 故障注入/ 次数/ 下/ 实现/ 密钥/ 恢复/ ./ 鉴于/ 代数/ 故障/ 分析/ 的/ 以上/ 优点/ ,/ 我们/ 认为/ 其/ 未来/ 有望/ 成为/ 密码/ 算法/ 抗/ 故障/ 攻击/ 安全性/ 评估/ 的/ 一般性/ 方法/ ./ 6.2/ 公开/ 问题/ 方面/ :/ 代数/ 故障/ 分析/ 未来/ 研究/ 工作/ 主要/ 有/ 以下/ 3/ 个/ (/ 1/ )/ 代数/ 故障/ 分析/ 求解/ 速度/ 优化/ 在/ 代数方程/ 组/ 求解/ 过程/ 中/ ,/ 密码/ 算法/ 和/ 故障/ 信息/ 利用/ 不同/ 的/ 方法/ ,/ 使得/ 建立/ 的/ 代数方程/ 组/ 的/ 变量/ 个数/ 、/ ANF/ 等式/ 数量/ 都/ 有/ 很大/ 差别/ ,/ 对应/ 的/ 密钥/ 求解/ 速度/ 也/ 有/ 一定/ 的/ 差异/ ,/ 未来/ 如何/ 找到/ 影响/ 攻击/ 中/ 代数/ 求解/ 速度/ 的/ 因素/ ,/ 对于/ 优化/ 代数/ 故障/ 分析/ 、/ 扩展/ 到/ 复杂/ 的/ 密码/ 算法/ 来说/ 十分/ 重要/ ./ (/ 2/ )/ 代数/ 故障/ 分析/ 的/ 复杂度/ 评估/ 代数/ 故障/ 分析/ 可/ 在/ 宽度/ 故障/ 、/ 深度/ 故障/ 模型/ 下/ 成功/ 实施/ ,/ 此时/ 由于/ 故障/ 传播/ 特征/ 变得/ 尤为/ 复杂/ ,/ 使得/ 攻击者/ 很难/ 应用/ 传统/ 的/ 数学分析/ 方法/ 进行/ 量化/ 评估/ ,/ 因此/ 亟需/ 研究/ 新/ 的/ 、/ 通用性/ 的/ 评估/ 方法/ ,/ 以/ 实现/ 针对/ 不同/ 故障/ 模型/ 、/ 不同/ 密码/ 算法/ 的/ 代数/ 故障/ 分析/ 复杂度/ 评估/ ./ (/ 3/ )/ 抗/ 代数/ 故障/ 分析/ 分组/ 密码/ 算法/ 设计/ 本文/ 大量/ 的/ 扩展/ 实验/ 表明/ ,/ 现有/ 轻量级/ 分组/ 密码/ 抗/ 代数/ 故障/ 分析/ 能力/ 仍然/ 较差/ ./ 未来/ 如何/ 设计/ 抗/ 代数/ 故障/ 分析/ 能力/ 较/ 好/ 的/ 轻量级/ 分组/ 密码/ ,/ 尤其/ 是/ 其中/ 非线性/ S/ 盒/ 部件/ 的/ 设计/ ,/ 是/ 一个/ 尚待/ 研究/ 的/ 问题/ ./ 7/ 结束语/ 本文/ 提出/ 一种/ 改进/ 的/ 代数/ 故障/ 分析方法/ ,/ 解决/ 了/ 故障注入/ 索引/ 位置/ 未知/ 的/ 故障/ 差分/ 表示/ 问题/ ,/ 应用/ 改进/ 代数/ 故障/ 分析方法/ 对/ Piccolo/ 密码/ 抗/ 故障/ 攻击/ 安全性/ 进行/ 分析/ ,/ 并/ 在/ 不同/ 故障/ 模型/ 、/ 不同/ Piccolo/ 版本/ 、/ 不同/ 分组/ 密码/ 开展/ 了/ 代数/ 故障/ 攻击/ 实验/ ./ 结果表明/ :/ 同/ 传统/ 差分/ 故障/ 分析/ 相比/ ,/ 轻型/ 分组/ 密码/ 代数/ 故障/ 分析/ 具有/ 在线/ 故障注入/ 少/ 、/ 离线/ 分析/ 简单/ 、/ 扩展性/ 通用性/ 好/ 等/ 优点/ ,/ 可/ 将/ 密钥/ 恢复/ 转化/ 为/ 代数方程/ 求解/ 问题/ ,/ 最大/ 程度/ 利用/ 计算资源/ ./ 本文/ 研究/ 对/ 改进/ 轻型/ 分组/ 密码/ 设计/ 、/ 加强/ 实现/ 防护/ 、/ 提高/ 应用/ 安全性/ 具有/ 一定/ 借鉴/ 意义/ ./ 致谢/ 感谢/ 评审/ 专家/ 们/ 的/ 辛勤工作/ ,/ 感谢/ 国防科学技术大学/ 李瑞林/ 在/ 代数/ 故障/ 攻击/ 中/ 的/ 精彩/ 讨论/ 和/ 宝贵/ 建议/ !/ 

