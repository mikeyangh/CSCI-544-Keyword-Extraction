Page1/ 无线/ 传感器/ 网络/ 中/ top/ -/ 犽/ 连接/ 查询处理/ 莫尚丰/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 陈丁洁/ 1/ )/ ,/ 2/ )/ 陈红/ 1/ )/ ,/ 2/ )/ 李英龙/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 李翠平/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 教育部/ 数据/ 工程/ 与/ 知识/ 工程/ 重点/ 实验室/ (/ 中国人民大学/ )/ 北京/ 100872/ )/ 2/ )/ (/ 中国人民大学/ 信息/ 学院/ 北京/ 100872/ )/ 3/ )/ (/ 湖南/ 科技/ 大学/ 湖南/ 湘潭/ 411201/ )/ 摘要/ 无线/ 传感器/ 网络/ 是/ 物/ 联网/ 核心/ 组成部分/ 之一/ ,/ 数据/ 查询处理/ 是/ 无线/ 传感器/ 网络/ 中/ 很/ 重要/ 的/ 一个/ 研究/ 领域/ ./ 连接/ 查询/ 能/ 在/ 不同/ 的/ 位置/ 监视/ 相似/ 的/ 网络/ 环境/ ,/ top/ -/ k/ 连接/ 查询/ 能/ 进一步/ 得出/ 组合/ 得分/ 最大/ (/ 或/ 最小/ )/ 的/ k/ 个/ 相似/ 网络/ 环境/ ./ top/ -/ k/ 连接/ 查询/ 根据/ 得分/ 函数/ 计算/ 匹配/ 结果/ 的/ 组合/ 得分/ ,/ 并/ 报告/ 组合/ 得分/ 结果/ 最大/ (/ 或/ 最小/ )/ 的/ k/ 个/ 匹配/ 节点/ 对/ ./ 文中/ 提出/ 了/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ ./ 该/ 算法/ 首先/ 按照/ 得分/ 属性/ 值/ 从/ 大到/ 小/ 对/ 所有/ 元组/ 排序/ ,/ 然后/ 依次/ 取出/ 元组/ ,/ 产生/ 连接/ 结果/ ./ 对/ 每个/ 连接/ 结果/ 按照/ 得分/ 函数/ 计算/ 组合/ 得分/ ,/ 如果/ 满足/ 停止/ 条件/ ,/ 则/ 停止/ 取/ 元组/ ,/ 并/ 输出/ 连接/ 结果/ ./ 在/ BTJQ/ 基础/ 上/ ,/ 作者/ 提出/ 了/ 集中式/ top/ -/ k/ 连接/ 算法/ CTJQ/ 和/ 优化/ 的/ 集中式/ top/ -/ k/ 连接/ 算法/ OCTJQ/ ./ 针对/ 特定/ 应用/ 场景/ ,/ 作者/ 进一步/ 提出/ 了/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ ./ 最后/ ,/ 在/ 真实/ 数据/ 集上/ 验证/ 了/ 各/ 算法/ ./ 实验/ 结果表明/ ,/ 文中/ 算法/ 好于/ 经典/ 连接/ 算法/ SENS/ -/ Join/ ./ 关键词/ 无线/ 传感器/ 网络/ ;/ top/ -/ k/ 查询/ ;/ 连接/ 查询/ ;/ 物/ 联网/ 1/ 引言/ 物/ 联网/ (/ InternetofThings/ ,/ IoTs/ )/ 以/ 感知/ 为/ 目的/ ,/ 旨在/ 实现/ 任何时刻/ 、/ 任何/ 地点/ 、/ 任意/ 物体/ 之间/ 的/ 互联/ ,/ 实现/ 无所不在/ 的/ 网络/ 和/ 无所不在/ 的/ 计算/ ./ 传感器/ 技术/ 、/ RFID/ 技术/ 、/ 纳米技术/ 、/ 智能/ 终端/ 等/ 都/ 是/ 物/ 联网/ 的/ 重要/ 支撑/ 技术/ ./ 物/ 联网/ 广泛应用/ 于/ 安防/ 、/ 电力/ 、/ 交通/ 、/ 医疗/ 等/ 许多/ 领域/ ./ 物/ 联网/ 体系结构/ 包括/ 应用层/ 、/ 通信/ 网络层/ (/ 包括/ 2G/ 、/ 3G/ 、/ 4G/ 等/ 移动/ 通信/ 网络/ 及/ 互联网/ )/ 和/ 感知/ 层/ ./ 其中/ ,/ 感知/ 层/ 主要/ 由/ 各类/ 同构/ 或/ 异构/ 无线/ 传感器/ 网络/ (/ WirelessSensorNetworks/ ,/ WSNs/ )/ 组成/ ,/ 这些/ 传感器/ 网络/ 负责/ 各类/ 物理/ 目标/ 感知/ 、/ 监控/ 以及/ 数据传输/ ,/ 它们/ 是/ 物/ 联网/ 实现/ 物与物/ 、/ 人与物/ 等/ 互联/ 的/ 基础/ ,/ 也/ 是/ 物/ 联网/ 核心/ 组成部分/ 之一/ ./ 随着/ 微电子/ 技术/ 、/ 嵌入式/ 计算技术/ 和/ 无线通信/ 技术/ 的/ 发展/ ,/ 低功耗/ 、/ 廉价/ 的/ 传感器/ 节点/ 也/ 能/ 集成/ 信息/ 收集/ 、/ 数据处理/ 和/ 无线通信/ 等/ 多种/ 功能/ [/ 1/ ]/ ./ 无线/ 传感器/ 网络/ 是/ 由/ 大量/ 部署/ 在/ 监视/ 区域/ 的/ 传感器/ 节点/ 以自/ 组织/ 、/ 多/ 跳/ 方式/ 组成/ 的/ 网络/ ,/ 主要/ 用于/ 收集/ 并/ 处理/ 监视/ 对象/ 的/ 信息/ ./ 传感器/ 节点/ 一般/ 用/ 电池/ 供电/ ,/ 部署/ 在/ 环境恶劣/ 的/ 监视/ 区域/ 中/ ,/ 通常/ 不/ 方便/ 或/ 不/ 可能/ 去/ 更换/ 电池/ 或/ 节点/ ./ 因此/ 在/ 传感器/ 网络/ 中/ ,/ 查询处理/ 的/ 目标/ 是/ :/ 在/ 获得/ 必要/ 信息/ 的/ 前提/ 下/ ,/ 尽可能/ 节约/ 节点/ 能量消耗/ ,/ 从而/ 延长/ 网络/ 生命周期/ ./ 相对/ 于/ 节点/ 计算/ ,/ 节点/ 之间/ 的/ 通信/ 将/ 消耗/ 更/ 多/ 的/ 能量/ ./ 例如/ :/ 在/ MICA2/ 节点/ 上/ 执行/ 一条/ 指令/ 需要/ 消耗/ 大约/ 0.84/ nJ/ 能量/ ,/ 但/ 发送/ 一个/ 数据包/ 大约/ 需要/ 消耗/ 0.685/ mJ/ 能量/ [/ 2/ ]/ ./ 因此/ ,/ 节约/ 节点/ 能量消耗/ 的/ 关键/ 是/ 减少/ 数据包/ 发送量/ ./ 无线/ 传感器/ 网络/ 可以/ 被/ 看作/ 一种/ 新型/ 分布式/ 数据库系统/ ,/ 用户/ 向/ 无线/ 传感器/ 网络/ 发送/ 查询/ 消息/ ,/ 传感器/ 网络/ 返回/ 监视/ 区域/ 中/ 满足/ 查询/ 要求/ 的/ 信息/ ./ 由于/ 传感器/ 节点/ 通信/ 、/ 计算/ 和/ 存储资源/ 有限/ ,/ 因此/ ,/ 传统/ 数据库/ 查询/ 算法/ 并/ 不适/ 用于/ 无线/ 传感器/ 网络/ ./ 数据/ 查询处理/ 是/ 无线/ 传感器/ 网络/ 中/ 很/ 重要/ 的/ 一个/ 研究/ 领域/ ./ 目前/ ,/ 已/ 提出/ 了/ 很多/ 能量/ 有效/ 的/ 查询处理/ 算法/ ,/ 如/ 聚集/ 查询/ 、/ KNN/ 查询/ 、/ top/ -/ k/ 查询/ 、/ skyline/ 查询/ 、/ 连接/ (/ join/ )/ 查询/ 等/ ./ 在/ 这些/ 查询/ 技术/ 中/ ,/ 连接/ 查询/ 是/ 一种/ 重要/ 的/ 查询方法/ ,/ 该/ 查询/ 能够/ 将/ 不同/ 节点/ 或/ 位置/ 的/ 数据/ 关联/ 起来/ ./ 典型/ 的/ 连接/ 查询/ 应用/ 是/ 在/ 不同/ 位置/ 监视/ 相似/ 的/ 网络/ 环境/ ./ 在/ 实际/ 应用/ 中/ ,/ 还有/ 另一类/ 更/ 复杂/ 的/ 查询/ 需求/ ./ 在/ 无线/ 传感器/ 网络/ 中/ ,/ 每个/ 节点/ 感知/ 多种/ 属性数据/ ./ 用户/ 希望/ 连续/ 地/ 从/ 连接/ 属性/ 值/ 近似/ 相等/ 的/ 节点/ 对/ 中/ 获取/ 得分/ 函数/ 值/ 最大/ 的/ k/ 个/ 节点/ 对/ ./ 例如/ :/ 在/ 森林/ 环境监测/ 中/ ,/ 找出/ 温度/ 、/ 湿度/ 、/ 光照/ 等/ 环境/ 条件/ 近似/ 相同/ ,/ 动物/ 数量/ 总和/ 最多/ 的/ 两个/ 区域/ ,/ 供/ 动物学家/ 分析/ 这/ 两个/ 区域/ 植被/ 覆盖/ 、/ 地形/ 地貌/ 等/ 的/ 相同/ 与/ 不同/ ,/ 以/ 全面/ 研究/ 动物/ 数量/ 和/ 环境/ 的/ 关联/ 关系/ ./ 又/ 如/ ,/ 在/ 城市/ 交通流量/ 监测/ 系统/ 中/ ,/ 城市规划/ 专家/ 希望/ 找到/ 车流量/ 近似/ 相等/ 、/ 人流量/ 总和/ 最大/ 的/ 两个/ 监测/ 地点/ ,/ 分析/ 这/ 两个/ 监测/ 地点/ 车/ // 人/ 相互影响/ 关系/ 的/ 相同/ 与/ 不同/ ./ 再/ 如/ ,/ 用户/ 希望/ 连续/ 地/ 从/ 相对湿度/ (/ RelativeHumidity/ ,/ RH/ )/ 采样/ 值/ 近似/ 相等/ (/ 差值/ τ/ 小于/ 等于/ 1/ %/ )/ 的/ 节点/ 对/ 中/ 获取/ 温度/ (/ Temperature/ ,/ Temp/ )/ 采样/ 值/ 之/ 和/ 最大/ 的/ 3/ 个/ 节点/ 对/ ./ 假设/ 一个/ 采样/ 周期/ 是/ 10min/ ,/ 该/ 查询/ 可以/ 如下/ 表示/ :/ SELECTA/ ./ / ,/ B/ ./ / FROMSensorsA/ ,/ SensorsBWHERE/ |/ A/ ./ RH/ -/ B/ ./ RH/ |/ / 1/ %/ ORDERBY/ (/ A/ ./ Temp/ +/ B/ ./ Temp/ )/ STOPAFTER3/ ;/ SAMPLINGPERIOD10minutes/ 该/ 实例/ 中/ ,/ 连接/ 属性/ 是/ 相对湿度/ ,/ 得分/ 属性/ 是/ 温度/ ,/ 得分/ 函数/ 是/ f/ =/ (/ A/ ./ Temp/ +/ B/ ./ Temp/ )/ ./ 这类/ 查询/ 的/ 特点/ 是/ :/ 假设/ 每个/ 传感器/ 节点/ 能/ 感知/ 多种/ 属性数据/ ,/ 用户/ 希望/ 连续/ 地/ 从/ 连接/ 属性/ 值/ 近似/ 相等/ 的/ 节点/ 对/ 中/ 获取/ 得分/ 函数/ 值/ 最大/ 的/ k/ 个/ 节点/ 对/ ./ 我们/ 称/ 这类/ 查询/ 为/ top/ -/ k/ 连接/ 查询/ ,/ 它/ 可以/ 如下/ 表示/ :/ SELECTA/ ./ / ,/ B/ ./ / FROMSensorsA/ ,/ SensorsBWHERE/ |/ A/ ./ join/ -/ B/ ./ join/ |/ / τ/ ORDERBYf/ (/ A/ ./ score/ ;/ B/ ./ score/ )/ STOPAFTERk/ ;/ SAMPLINGPERIODpminutes/ 针对/ 如上所述/ top/ -/ k/ 连接/ 查询/ ,/ 一个/ 简单/ 方法/ 是/ 在/ 每/ 一轮/ 数据/ 采集/ 过程/ 中/ ,/ 每个/ 节点/ 发送/ 相关/ 属性/ 值/ 给/ 基站/ (/ Thesink/ 或/ Thebasestation/ )/ ./ 基站/ 首先/ 找出/ 符合/ 连接/ 条件/ 的/ 匹配/ 节点/ 对/ ,/ 然后/ 按照/ 得分/ 函数/ 计算/ 各/ 匹配/ 节点/ 对/ 的/ 组合/ 得分/ 并/ 排序/ ,/ 最后/ 获/ Page3/ 得/ top/ -/ k/ 连接/ 结果/ ./ 在/ 这个/ 过程/ 中/ ,/ 大部分/ 节点/ 都/ 不/ 属于/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 而/ 让/ 每个/ 节点/ 发送数据/ 给/ 基站/ ,/ 无疑/ 会/ 浪费/ 很多/ 能量/ ./ 本文/ 关注/ 无线/ 传感器/ 网络/ 中/ top/ -/ k/ 连接/ 查询处理/ 技术/ ,/ 针对/ 不同/ 的/ 场景/ 给出/ 了/ 不同/ 的/ top/ -/ k/ 连接/ 查询处理/ 方案/ ./ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 了/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ (/ BasicTop/ -/ kJoinQueries/ )/ ./ 该/ 算法/ 首先/ 按照/ 得分/ 属性/ 值/ score/ 从大到/ 小/ 对/ 所有/ 元组/ 排序/ ,/ 然后/ 依次/ 取出/ 元组/ ,/ 产生/ 连接/ 结果/ ./ 对/ 每个/ 连接/ 结果/ 按照/ 得分/ 函数/ 计算/ 组合/ 得分/ ,/ 如果/ top/ -/ k/ 个/ 匹配/ 元组/ 对/ 中/ 最小/ 组合/ 得分/ 大于/ 或/ 等于/ 门限/ 得/ 分值/ ,/ 则/ 停止/ 取/ 元组/ ,/ 并/ 输出/ 连接/ 结果/ ./ (/ 2/ )/ 提出/ 了/ 集中式/ top/ -/ k/ 连接/ 算法/ CTJQ/ (/ Cen/ -/ tralizedTop/ -/ kJoinQueries/ )/ ./ 根据/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ ,/ 把/ 每/ 一轮/ 时间/ T/ 分成/ M/ 个/ 时间/ 片/ ./ 各/ 节点/ 根据/ 得分/ 属性/ 值/ 大小/ ,/ 安排/ 在/ 不同/ 的/ 时间/ 片/ 发送数据/ 给/ 基站/ ./ 我们/ 还/ 提出/ 了/ 优化/ 的/ 集中式/ top/ -/ k/ 连接/ 算法/ OCTJQ/ (/ OptimizedCentralizedTop/ -/ kJoinQueries/ )/ ./ (/ 3/ )/ 提出/ 了/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ (/ Dis/ -/ tributedTop/ -/ kJoinQueries/ )/ ./ 该/ 算法/ 把/ 整个/ 网络/ 分成/ L/ 个格/ ,/ 每个/ 格有/ 一个/ 中心/ 节点/ ./ 由/ 中心/ 节点/ 计算/ 连接/ 结果/ ,/ 并/ 发送给/ 基站/ ./ (/ 4/ )/ 在/ 真实/ 数据/ 集上/ 验证/ 了/ 算法/ BTJQ/ ,/ CTJQ/ ,/ OCTJQ/ 和/ DTJQ/ ./ 实验/ 结果表明/ ,/ 这些/ 算法/ 好于/ 经典/ 连接/ 算法/ SENS/ -/ Join/ [/ 13/ ]/ ./ 本文/ 第/ 2/ 节/ 简单/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 讨论/ 无线/ 传感器/ 网络/ 设置/ ;/ 第/ 4/ 节/ 详细/ 介绍/ top/ -/ k/ 连接/ 算法/ ;/ 第/ 5/ 节/ 给出/ 各/ 算法/ 的/ 实验/ 验证/ 及/ 分析/ ;/ 最后/ 对/ 全文/ 进行/ 总结/ ./ 2/ 相关/ 工作/ 在/ 无线/ 传感器/ 网络/ 中/ ,/ 目前/ 已有/ 一些/ top/ -/ k/ 查询/ 算法/ [/ 3/ -/ 8/ ]/ 和/ 连接/ 查询/ 算法/ [/ 9/ -/ 14/ ]/ ./ 但/ 尚未/ 见到/ 本文/ 所/ 关注/ 的/ top/ -/ k/ 连接/ 查询/ 算法/ ./ (/ 1/ )/ top/ -/ k/ 查询/ 算法/ ./ 文献/ [/ 3/ ]/ 提出/ 了/ 一个/ POT/ 算法/ ,/ 该/ 算法/ 把/ 传感器/ 节点/ 分成/ 很多/ 偏序/ 树/ (/ PartialOrderedTrees/ ,/ POT/ )/ ,/ 基站/ 维护/ 了/ 一个/ 全局/ 排序/ 表/ (/ GlobalRankinglist/ ,/ GR/ )/ ./ 如果/ top/ -/ k/ 结果/ 空间/ 相关/ ,/ POT/ 算法/ 性能/ 很/ 好/ ./ 但/ 如果/ top/ -/ k/ 结果/ 没有/ 空间/ 相关性/ ,/ FILA/ [/ 4/ ]/ 算法/ 优于/ POT/ 算法/ ./ FILA/ [/ 4/ ]/ 协议/ 中/ ,/ 在/ 每/ 一轮/ 查询/ ,/ 如果/ 节点/ 采样/ 数据/ 没有/ 超出/ 过滤器/ 窗口/ ,/ 该/ 节点/ 将/ 不/ 发送数据/ 给/ 基站/ ./ 如果/ 基站/ 接收/ 到/ 某个/ 节点/ 的/ 采样/ 值/ 进入/ 了/ 其它/ 节点/ 的/ 过滤器/ 窗口/ ,/ 基站/ 将/ 发送/ 广播/ 消息/ ,/ 并/ 获取/ 所/ 需/ 数据/ ./ 因此/ ,/ 该/ 协议/ 中/ 数据/ 发送/ 是/ 离散/ 的/ ./ 在/ PRIM/ [/ 5/ ]/ 和/ PRIM/ -/ c/ [/ 6/ ]/ 协议/ 中/ ,/ 设置/ 了/ N/ 个/ 部分/ TDMA/ 帧/ 收集/ top/ -/ k/ 节点/ 数据/ ./ 不同/ 采样/ 值/ 在/ 不同/ 帧/ 中/ 传送/ ,/ 采样/ 值越/ 高/ 的/ 节点/ 数据/ 在/ 越/ 靠/ 前/ 帧/ 中/ 发送给/ 基站/ ./ 该/ 方法/ 以/ 牺牲/ 时间/ 换取/ 节约/ 系统/ 能量/ ./ 在/ XP/ [/ 7/ ]/ 协议/ 中/ ,/ 作者/ 以自/ 底向上/ 方式/ 和/ 空间/ 聚簇/ 方式/ 构建/ 了/ 一颗/ 路由/ 树/ ,/ 在/ 该/ 路由/ 树/ 基础/ 上/ 进行/ 交叉/ 剪枝/ (/ CrossPruning/ ,/ XP/ )/ ./ CRTQ/ [/ 8/ ]/ 针对/ top/ -/ k/ 查询/ 特点/ 提出/ 了/ 一种/ 新路/ 由/ 算法/ ,/ 该/ 算法/ 是/ 适合/ top/ -/ k/ 查询/ 的/ 基于/ 分簇/ 路由/ ./ (/ 2/ )/ 连接/ 查询/ 算法/ ./ REED/ [/ 9/ ]/ 和/ NEJA/ [/ 10/ ]/ 算法/ 处理/ 的/ 是/ 外部/ 连接/ 问题/ ,/ 让/ 网络/ 中/ 产生/ 的/ 元组/ 和/ 存放/ 在/ 基站/ 的/ 外部/ 表/ 进行/ 连接/ 匹配/ ./ PEJA/ [/ 11/ ]/ 算法/ 解决/ 了/ 不同/ 区域/ 连接/ 查询/ 问题/ ./ PEJA/ 算法/ 由/ 3/ 个/ 阶段/ 组成/ ,/ 包括/ 初始/ 阶段/ 、/ 递增/ 连接/ 处理/ 阶段/ 和/ 清除/ 阶段/ ./ TPSJ/ [/ 12/ ]/ 算法/ 解决/ 了/ 窗口/ 自/ 连接/ 问题/ ,/ 目的/ 是/ 探测/ 感兴趣/ 的/ 事件/ ./ SENS/ -/ Join/ [/ 13/ ]/ 处理/ 了/ 通用/ 连接/ 问题/ ./ 有/ 可能/ 符合/ 匹配/ 条件/ 的/ 节点/ 将/ 发送/ 连接/ 属性/ 值/ 给/ 基站/ ,/ 基站/ 根据/ 收集/ 到/ 的/ 连接/ 属性/ 值/ 计算/ 连接/ 结果/ ,/ 属于/ 最终/ 连接/ 结果/ 的/ 节点/ 将/ 被/ 通知/ 发送/ 完整/ 的/ 元组/ 信息/ 给/ 基站/ ./ INJECT/ [/ 14/ ]/ 算法/ 处理/ 了/ 两个/ 区域/ 连接/ 问题/ ./ INJECT/ 提出/ 了/ baseJoin/ 、/ coverJoin/ 、/ sideJoin/ 、/ partitionJoin/ 、/ synopsisJoin/ 、/ fullsynopsis/ -/ Join/ 等/ 多种/ 连接/ 实现/ 方案/ ,/ 并/ 根据/ 不同/ 的/ 应用/ 场景/ 选择/ 不同/ 的/ 连接/ 实现/ 方案/ ./ (/ 3/ )/ 在/ 传统/ 数据库/ 查询/ 算法/ 中/ ,/ 有/ 一些/ top/ -/ k/ 连接/ 查询/ 算法/ ./ 因/ 无线/ 传感器/ 网络/ 和/ 数据库/ 体系结构/ 不同/ ,/ 这些/ top/ -/ k/ 连接/ 查询/ 算法/ [/ 15/ -/ 16/ ]/ 不能/ 直接/ 应用/ 于/ 无线/ 传感器/ 网络/ ./ HRJN/ [/ 15/ ]/ 是/ 一种/ 经典/ 的/ top/ -/ k/ 连接/ 查询/ 算法/ ./ 该/ 算法/ 在/ 连接/ 操作过程/ 中/ 递归/ 地/ 获取/ top/ -/ k/ 结果/ ./ 在/ 传统/ 数据库/ 的/ 多个/ 表中/ ,/ 从/ 每个/ 表/ 获取/ 前面/ 数量/ 不/ 等/ 的/ 元组/ ./ 然后/ 计算/ 这些/ 已获/ 元组/ 的/ 门/ 限值/ ./ 如果/ top/ -/ k/ 连接/ 结果/ 中/ 第/ k/ 个/ 结果/ 得/ 分值/ 大于/ 或/ 等于/ 门/ 限值/ ,/ 则/ 算法/ 结束/ ./ PBRJ/ [/ 16/ ]/ 发现/ HRJN/ 没有/ 尽可能/ 早地/ 停止/ 读取/ 表中/ 输入/ 元组/ ./ 因此/ ,/ PBRJ/ 提出/ 了/ 更/ 严格/ 的/ 边界条件/ ,/ 在/ 保证/ 能/ 获取/ top/ -/ k/ 连接/ 查询/ 结果/ 的/ 前提/ 下/ 尽早/ 地/ 停止/ 读取/ 表中/ 输入/ 元组/ ./ (/ 4/ )/ TJA/ 算法/ ./ TJA/ [/ 17/ ]/ 算法/ 是/ 查找/ 满足用户/ 定义/ 函数/ 的/ k/ 个/ 最高/ 排名/ 结果/ ,/ 例如/ :/ 查找/ 过去/ 3/ 个/ 月/ 内/ k/ 个/ 最高/ 平均温度/ 的/ 时间段/ ./ 因此/ ,/ TJA/ 算法/ 解/ Page4/ 决/ 的/ 问题/ 和/ 我们/ 算法/ 解决/ 的/ 问题/ 不/ 相同/ ./ TJA/ 算法/ 分为/ 3/ 个/ 部分/ ./ (/ 1/ )/ 求/ 下界/ 阶段/ (/ LowerBoundPhase/ )/ ./ 每个/ 节点/ 将/ 本地/ k/ 个/ 得分/ 最高/ 对象/ 发给/ 基站/ ,/ 中间/ 节点/ 合并/ 孩子/ 和/ 自己/ 本地/ top/ -/ k/ 对象/ ,/ 在/ 基站/ 上/ 形成/ 一个/ 过滤/ 对象/ 集/ τ/ ./ (/ 2/ )/ 分层/ 加入/ 阶段/ (/ HierarchicalJoinPhase/ )/ ./ 每个/ 节点/ 将/ 大于/ 过滤/ 对象/ 集/ τ/ 的/ 对象/ 发给/ 基站/ ./ (/ 3/ )/ 清理/ 阶段/ (/ Clean/ -/ UpPhase/ )/ ./ 对/ 第/ 2/ 阶段/ 中/ 不/ 完整/ 对象/ 补齐/ ./ 3/ 系统/ 设置/ N/ 个/ 传感器/ 节点/ 被/ 随机/ 部署/ 在/ 监视/ 区域/ 中/ ,/ 这些/ 节点/ 以自/ 组织/ 方式/ 构成/ 网络/ ,/ 并/ 周期性地/ 采集/ 数据/ ,/ 每/ 一个/ 采样/ 周期/ 称为/ 一轮/ ./ 每/ 一轮/ 中/ ,/ 基站/ 将/ 获得/ top/ -/ k/ 连接/ 查询/ 结果/ ./ si/ 代表/ 第/ i/ 个/ 传感器/ 节点/ ,/ 相应/ 的/ 节点/ 集/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sn/ }/ ,/ |/ S/ |/ =/ N/ ./ 每个/ 节点/ si/ 都/ 有/ 最大/ 通信/ 半径/ R/ ./ 我们/ 做/ 如下/ 假设/ :/ (/ 1/ )/ 所有/ 传感器/ 节点/ 是/ 同构/ 的/ ,/ 都/ 有/ 相同/ 的/ 计算/ 、/ 存储/ 和/ 通信/ 能力/ ./ 部署/ 后/ 节点/ 静止不动/ ,/ 同时/ 每个/ 节点/ 有/ 自己/ 唯一/ 的/ ID/ 号/ ./ (/ 2/ )/ 网络/ 中/ 只有/ 一个/ 基站/ ,/ 该/ 基站/ 能/ 被/ 重新/ 充电/ ,/ 因此/ ,/ 不/ 考虑/ 基站/ 能量消耗/ 问题/ ./ (/ 3/ )/ 通信/ 链路/ 对称/ ./ 如果/ 节点/ si/ 能/ 和/ 节点/ sj/ 通信/ ,/ 反过来/ ,/ 节点/ sj/ 也/ 能/ 和/ 节点/ si/ 通信/ ./ (/ 4/ )/ 传感器/ 节点/ 能量/ 有限/ ,/ 并且/ 不能/ 补充/ 能量/ ./ 4Top/ -/ 犽/ 连接/ 算法/ 本节/ 将/ 提出/ 4/ 种/ top/ -/ k/ 连接/ 算法/ ,/ 包括/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 、/ 集中式/ top/ -/ k/ 连接/ 算法/ CTJQ/ 、/ 优化/ 的/ 集中式/ top/ -/ k/ 连接/ 算法/ OCTJQ/ 和/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ ./ 4.1/ 基本/ top/ -/ 犽/ 连接/ 算法/ BTJQ/ 参考/ 传统/ 数据库/ 中/ top/ -/ k/ 连接/ 算法/ HRJN/ [/ 15/ ]/ ,/ 我们/ 提出/ 了/ 适合/ 于/ 传感器/ 网络/ 的/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ (/ BasicTop/ -/ kJoinQueries/ )/ ./ HRJN/ 算法/ 涉及/ 多个/ 表/ 之间/ 元组/ 的/ 连接/ ,/ 而/ BTJQ/ 只/ 涉及/ 一个/ 表内/ 元组/ 的/ 连接/ ./ 在/ 每/ 一轮/ 中/ ,/ 每个/ 节点/ 将/ 进行/ 一次/ 数据/ 采集/ ,/ 采集/ 的/ 属性/ 值/ 封装/ 在/ 一条/ 元组/ T/ 中/ ,/ 然后/ 将/ 该/ 元组/ 发送给/ 基站/ ./ T/ =/ (/ id/ ,/ join/ ,/ score/ )/ ./ 每条/ 元组/ 由/ 节点/ id/ 号/ 、/ 连接/ 属性/ 值/ join/ 、/ 得分/ 属性/ 值/ score/ 等/ 组成/ ./ 基站/ 获得/ 所有/ 节点/ 元组/ 后/ ,/ 按照/ 得分/ 属性/ 值/ score/ 从大到/ 小/ 对/ 所有/ 元组/ 排序/ ./ T1/ 是/ 排序/ 后/ 第一条/ 元组/ ,/ T1/ ./ score/ 是/ 最大/ 得分/ 属性/ 值/ ./ Ti/ 表示/ 排序/ 后/ 第/ i/ 条/ 元组/ ./ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 涉及/ 的/ 参数/ 有/ :/ 连接/ 条件/ |/ Ti/ ./ join/ -/ Tj/ ./ join/ |/ / τ/ ,/ 单调/ 组合/ 得分/ 函数/ f/ ,/ k/ 个/ 连接/ 结果/ ./ 该/ 算法/ 报告/ 组合/ 得分/ 最高/ 的/ k/ 个/ 连接/ 结果/ ./ 得分/ 门限/ (/ threshold/ )/ 值为/ TScore/ ./ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ BTJQ/ 算法/ ./ 输入/ :/ 基站/ 所获/ 的/ 全部/ 元组/ 输出/ :/ top/ -/ k/ 连接/ 结果/ 1/ ./ 按照/ 得分/ 属性/ 值/ score/ 从大到/ 小/ 对/ 所有/ 元组/ 排序/ ./ 2/ ./ 依次/ 取出/ 一条/ 元组/ Ti/ ./ 3/ ./ if/ (/ i/ >/ 1/ )/ 4/ ./ TScore/ =/ f/ (/ T1/ ./ score/ ;/ Ti/ ./ score/ )/ ./ 5/ ./ end/ -/ if6/ ./ 产生/ 新/ 连接/ 结果/ J/ ./ 7/ ./ 根据/ 得分/ 函数/ f/ 计算/ 组合/ 得分/ J/ ./ score/ ./ 8/ ./ Lk/ 是/ 目前/ 所获/ 组合/ 得分/ 最大/ 的/ k/ 个/ 连接/ 结果/ 表/ ,/ 9/ ./ if/ (/ scorek/ / TScore/ )/ 10/ ./ break/ ./ 11/ ./ end/ -/ if12/ ./ 报告/ Lk/ 中/ 连接/ 结果/ ./ BTJQ/ 算法/ 描述/ 如下/ :/ A/ ./ 首先/ 按照/ 得分/ 属性/ 值/ score/ 从大到/ 小/ 对/ 所有/ 元组/ 排序/ ,/ 然后/ 依次/ 取出/ 一条/ 元组/ Ti/ ./ 若/ i/ >/ 1/ ,/ 计算/ 得分/ 门/ 限值/ TScore/ ,/ TScore/ =/ f/ (/ T1/ ./ score/ ;/ Ti/ ./ score/ )/ ./ (/ 1/ )/ 根据/ 连接/ 条件/ ,/ 对/ 新/ 取出/ 的/ 元组/ Ti/ 和/ 所有/ 已/ 取出/ 元组/ 进行/ 判断/ ,/ 产生/ 相应/ 的/ 连接/ 结果/ ./ (/ 2/ )/ 对于/ 每个/ 新/ 产生/ 的/ 连接/ 结果/ J/ ,/ 根据/ 得分/ 函数/ f/ 计算/ 组合/ 得分/ J/ ./ score/ ./ (/ 3/ )/ Lk/ 是/ 目前/ 所获/ 组合/ 得分/ 最大/ 的/ k/ 个/ 连接/ 结果/ 表/ ,/ scorek/ 是/ Lk/ 中/ 最小/ 组合/ 得分/ ./ 如果/ scorek/ / TScore/ ,/ 则/ 停止/ 继续执行/ 该/ 算法/ ./ B/ ./ 报告/ Lk/ 中/ 连接/ 结果/ ./ 定理/ 1/ ./ TScore/ 是/ 目前/ 未/ 取出/ 元组/ 和/ 其它/ 任何/ 元组/ 连接/ 结果/ 的/ 组合/ 得分/ 上界/ ./ 证明/ ./ 假如/ 一条/ 元组/ Tj/ 还/ 没有/ 取出/ ,/ j/ >/ i/ ./ TScore/ 一定/ 大于/ 或/ 等于/ Tj/ 和/ 其它/ 任何/ 元组/ To/ 连接/ 结果/ 的/ 组合/ 得分/ f/ (/ Tj/ ./ score/ ;/ To/ ./ score/ )/ ./ 因为/ TScore/ =/ f/ (/ T1/ ./ score/ ;/ Ti/ ./ score/ )/ ;/ T1/ ./ score/ / To/ ./ score/ ;/ Ti/ ./ score/ / Tj/ ./ score/ ./ 同时/ 组合/ 得分/ 函数/ f/ 是/ 单调/ 的/ ,/ 所以/ TScore/ / f/ (/ Tj/ ./ score/ ;/ To/ ./ score/ )/ ./ 证毕/ ./ 实例/ :/ 假设/ 基站/ 一共/ 收到/ 7/ 个/ 节点/ 的/ 元组/ ,/ 各/ 元组/ 按照/ 得分/ 排序/ 后/ 如图/ 1/ 所示/ ./ 假设/ 连接/ 条件/ 是/ 两元/ 组/ 连接/ 属性/ 值/ 相等/ ,/ 即/ Ti/ ./ join/ =/ Tj/ ./ join/ ;/ 组合/ 得/ Page5/ 分/ 函数/ 是/ 两/ 节点/ 得分/ 属性/ 值/ 之/ 和/ ,/ 即/ fij/ =/ Ti/ ./ score/ +/ Tj/ ./ score/ ;/ 基站/ 要求/ 获得/ top/ -/ 2/ 连接/ 结果/ ./ 根据/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ ,/ 依次/ 取出/ 表中/ 各条/ 元组/ ,/ 当取/ 到/ 第/ 3/ 条/ 元组/ T3/ 时/ ,/ 计算/ TScore/ =/ T1/ ./ score/ +/ T3/ ./ score/ =/ 10/ +/ 8/ =/ 18/ ./ 此时/ ,/ T1/ ./ join/ =/ T3/ ./ join/ =/ 1/ ,/ 满足/ 连接/ 条件/ ,/ 计算/ 组合/ 得分/ f13/ =/ T1/ ./ score/ +/ T3/ ./ score/ =/ 10/ +/ 8/ =/ 18/ ,/ 然后/ 把/ 该/ 连接/ 结果/ 加入/ 到/ 结果/ 表/ L2/ 中/ ./ 此时/ 表/ L2/ 中/ 只有/ 一个/ 连接/ 结果/ ,/ 不/ 满足/ 结束/ 条件/ ,/ 继续/ 往下取/ 元组/ ./ 当取/ 到/ 第/ 5/ 条/ 元组/ T5/ 时/ ,/ 计算/ TScore/ =/ T1/ ./ score/ +/ T5/ ./ score/ =/ 10/ +/ 6/ =/ 16/ ./ 此时/ ,/ T2/ ./ join/ =/ T5/ ./ join/ =/ 3/ ,/ 满足/ 连接/ 条件/ ,/ 计算/ 组合/ 得分/ f25/ =/ T2/ ./ score/ +/ T5/ ./ score/ =/ 9/ +/ 6/ =/ 15/ ,/ 然后/ 将/ 该/ 连接/ 结果/ 加入/ 到/ 结果/ 表/ L2/ 中/ ./ 此时/ 表/ L2/ 中有/ 2/ 个/ 连接/ 结果/ ,/ 最小/ 组合/ 得分/ score2/ =/ f25/ =/ 15/ ./ 因为/ score2/ </ TScore/ ,/ 因此/ 该/ 算法/ 继续执行/ ,/ 取/ 第/ 6/ 条/ 元组/ ,/ 此时/ ,/ TScore/ =/ T1/ ./ score/ +/ T6/ ./ score/ =/ 10/ +/ 5/ =/ 15/ ./ 第/ 6/ 条/ 元组/ 并/ 不能/ 和/ 其它/ 元组/ 匹配/ ,/ L2/ 中/ 依然/ 只有/ 2/ 个/ 连接/ 结果/ ,/ 但/ score2/ / TScore/ ,/ 此时/ 停止/ 继续执行/ 该/ 算法/ ,/ 并/ 报告/ L2/ 中/ top/ -/ 2/ 连接/ 结果/ ./ 4.2/ 集中式/ top/ -/ 犽/ 连接/ 算法/ CTJQ/ 在/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 中/ ,/ 基站/ 需要/ 收集/ 所有/ 节点/ 的/ 元组/ ,/ 将/ 产生/ 大量/ 能量消耗/ ,/ 若/ 部分/ 节点/ 发送数据/ 给/ 基站/ ,/ 基站/ 也/ 能/ 获得/ 正确/ 的/ top/ -/ k/ 连接/ 结果/ ,/ 将/ 节约/ 很多/ 能量/ ./ 据此/ ,/ 我们/ 提出/ 了/ 集中式/ top/ -/ k/ 连接/ 查询/ 算法/ CTJQ/ (/ CentralizedTop/ -/ kJoinQueries/ )/ ./ CTJQ/ 算法/ 如/ 算法/ 2/ 所示/ ./ 首先/ ,/ 基站/ 根据/ 搜集/ 到/ 的/ 历史数据/ ,/ 获得/ 各/ 节点/ 元组/ 中/ 得分/ 属性/ 值/ Ti/ ./ score/ 的/ 分布/ ,/ 并/ 据此/ 分布/ 把/ 得分/ 属性/ 分割/ 成/ M/ 个子/ 范围/ ,/ [/ Sm/ ./ LowerBound/ ,/ Sm/ ./ UpperBound/ )/ (/ 1/ / m/ / M/ )/ ,/ 使/ 每个/ 子/ 范围/ 内/ 元组/ 数/ 近似/ 相等/ ./ 然后/ ,/ 基站/ 把/ 这/ M/ 个子/ 范围/ 边界值/ 广播/ 给/ 网内/ 所有/ 节点/ ./ 设/ 每/ 一轮/ 时间/ 长度/ 为/ T/ ,/ 把/ 每/ 一轮/ 时间/ T/ 分成/ M/ 个/ 时间/ 片/ TS/ (/ TimeSlice/ )/ ,/ 时间/ 片/ M/ 数目/ 和/ 得分/ 属性/ 值/ 划分/ 子/ 范围/ 个数/ M/ 相同/ ,/ 每个/ 时间/ 片/ TS/ =/ T/ // M/ ./ 各/ 节点/ 根据/ 得分/ 属性/ 值/ 大小/ ,/ 安排/ 在/ 不同/ 的/ 时间/ 片/ 发送数据/ 给/ 基站/ ./ 得分/ 属性/ 值越/ 大/ ,/ 就/ 安排/ 在/ 越/ 靠/ 前/ 的/ 时间/ 片内/ 发送数据/ 给/ 基站/ ./ 在/ 每/ 一个/ 时间/ 片/ TS/ 内/ ,/ 当/ 基站/ 收集/ 到/ 数据/ 后/ ,/ 将/ 按照/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 判断/ 是否/ 满足/ 停止/ 条件/ ./ 如果/ 满足/ ,/ 基站/ 将/ 广播/ 停止/ 消息/ 给/ 所有/ 节点/ ,/ 通知/ 其/ 停止/ 发送数据/ ./ 否则/ ,/ 继续/ 进行/ 下/ 一个/ 时间/ 片内/ 数据传输/ ./ 算法/ 2/ ./ CTJQ/ 算法/ ./ 输入/ :/ 基站/ 所获/ 的/ 部分/ 元组/ 输出/ :/ top/ -/ k/ 连接/ 结果/ 1/ ./ for/ 每个/ TSmdo2/ ./ for/ 每个/ 普通/ 节点/ sjdo3/ ./ if/ (/ Tj/ ./ score/ ∈/ [/ Sm/ ./ LowerBound/ ,/ Sm/ ./ Upper/ -/ 4/ ./ 发送/ 元组/ Tj/ 给/ 基站/ ./ 5/ ./ end/ -/ if6/ ./ end/ -/ for7/ ./ 基站/ 调用/ BTJQ/ 算法/ ./ 8/ ./ if/ 满足/ 停止/ 条件/ 9/ ./ 基站/ 广播/ 停止/ 消息/ 给/ 所有/ 节点/ ./ 10/ ./ end/ -/ if11/ ./ if/ 普通/ 节点/ sj/ 收到/ 停止/ 消息/ ,/ 退出/ ./ end/ -/ if12/ ./ end/ -/ forCTJQ/ 算法/ 的/ 得分/ 门/ 限值/ TScore/ 计算方法/ 和/ BTJQ/ 算法/ 稍/ 有/ 不同/ ./ TScore/ =/ f/ (/ T1/ ./ score/ ;/ Ti/ ./ score/ )/ ./ CTJQ/ 算法/ 中/ ,/ Ti/ ./ score/ 是/ 当前/ 时间/ 片/ 对应/ 的/ 子/ 范围/ 下/ 边界/ ./ 例如/ ,/ 如图/ 2/ 所示/ ,/ 基站/ 根据/ 搜集/ 到/ 的/ 历史数据/ ,/ 把/ 得分/ 属性/ 分割/ 成/ 6/ 个子/ 范围/ ,/ 即/ 得分/ [/ 9/ ,/ 10/ )/ 为/ 第/ 1/ 个子/ 范围/ ;/ 得分/ [/ 7/ ,/ 9/ )/ 为/ 第/ 2/ 个子/ 范围/ ;/ …/ ;/ 依此类推/ ./ 每个/ 子/ 范围/ 内/ 元组/ 数/ 近似/ 相等/ ./ 相应/ 地/ ,/ 每/ 一轮/ 时间/ T/ 分成/ 6/ 个/ 时间/ 片/ ./ 如果/ 节点/ 的/ 得分/ 属性/ 值/ Ti/ ./ score/ ∈/ [/ 9/ ,/ 10/ )/ ,/ 该/ 元组/ 将会/ 在/ 时间/ 片/ |/ 0/ -/ t/ |/ 内/ 发送给/ 基站/ ./ 当/ 基站/ 在/ 时间/ 片/ |/ 0/ -/ t/ |/ 内/ 收集/ 完/ 数据/ 后/ ,/ 将/ 按照/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 判断/ 是否/ 满足/ 停止/ 条件/ ./ 此时/ ,/ 得分/ 门/ 限值/ TScore/ 中/ Ti/ ./ score/ =/ 9/ ,/ 即/ 第/ 1/ 个子/ 范围/ 下/ 边界/ ./ 如果/ 不/ 满足/ 停止/ 条件/ ,/ 继续/ 等待/ 接收数据/ ./ 如果/ 节点/ 的/ 得分/ 属性/ 值/ Ti/ ./ score/ ∈/ [/ 7/ ,/ 9/ )/ ,/ 该/ 元组/ 将会/ 在/ 时间/ 片/ |/ t/ -/ 2t/ |/ 内/ 发送给/ 基站/ ./ 当/ 基站/ 在/ 时间/ 片/ |/ t/ -/ 2t/ |/ 内/ 收集/ 完新/ 数据/ 后/ ,/ 将/ 按照/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 判断/ 是否/ 满足/ 停止/ 条件/ ./ 此时/ ,/ 得分/ 门/ 限值/ TScore/ 中/ Ti/ ./ score/ =/ 7/ ,/ 即/ 第/ 2/ 个子/ 范围/ 下/ 边界/ ./ 如果/ 满足/ 停止/ 条件/ ,/ 基站/ 将/ 广播/ 停止/ 消息/ 给/ 所有/ 节点/ ,/ 通知/ 其/ 停止/ 发送数据/ ./ 这样/ ,/ 得分/ 属性/ 值/ Ti/ ./ score/ ∈/ [/ 0/ ,/ 7/ )/ 的/ 元组/ 将/ 不会/ 传送/ 给/ 基站/ ./ Page64/ ./ 3/ 优化/ 的/ 集中式/ top/ -/ 犽/ 连接/ 算法/ OCTJQ/ 在/ 一些/ 特殊/ 情况/ 下/ ,/ 少量/ 节点/ 的/ 得分/ 属性/ 值会/ 非常/ 高/ ,/ 例如/ 在/ 如前所述/ 森林/ 环境监测/ 实例/ 中/ ,/ 如果/ 遇到/ 下雨/ 等/ 恶劣/ 天气/ 时/ ,/ 动物/ 可能/ 大量/ 聚集/ 在/ 某个/ 区域/ 避雨/ ,/ 造成/ 某个/ 区域/ 动物/ 数量/ 异常/ 多/ ;/ 非洲/ 大/ 草原/ 上/ ,/ 大量/ 动物/ 长途/ 迁徙/ ,/ 也/ 会/ 造成/ 局部/ 区域/ 动物/ 数量/ 非常/ 多/ ;/ 若/ 传感器/ 节点/ 读数/ 异常/ ,/ 会/ 造成/ 某个/ 节点/ 得分/ 属性/ 值/ 非常/ 高/ ./ 这时/ ,/ CTJQ/ 算法/ 会/ 出现/ 不能/ 满足/ 停止/ 条件/ 而/ 需要/ 取出/ 全部/ 元组/ 的/ 问题/ ./ 如图/ 3/ 所示/ ,/ 节点/ 1/ 的/ 得分/ 属性/ 值/ T1/ ./ score/ =/ 100/ ,/ 其余/ 节点/ 的/ 得分/ 属性/ 值/ 都/ 少于/ 10/ ./ 设/ 组合/ 得分/ 函数/ 是/ 两/ 节点/ 得分/ 属性/ 值/ 之/ 和/ ,/ 即/ fij/ =/ Ti/ ./ score/ +/ Tj/ ./ score/ ./ 在/ 集中式/ top/ -/ k/ 连接/ 查询/ 算法/ CTJQ/ 中/ ,/ 得分/ 门/ 限值/ TScore/ =/ T1/ ./ score/ +/ Ti/ ./ score/ >/ 100/ ./ 而/ 若/ i/ >/ 2/ ,/ j/ >/ 2/ ,/ 组合/ 得分/ 函数/ fij/ 将/ 小于/ 20/ ,/ 并且/ 也/ 小于/ TScore/ ./ 这样/ fij/ 将/ 很/ 难/ 满足/ 停止/ 条件/ ,/ 而/ 需要/ 取出/ 全部/ 元组/ ,/ 导致/ 消耗/ 很多/ 能量/ ./ 针对/ 如上所述/ 少数/ 节点/ 得分/ 属性/ 值/ 非常/ 高/ ,/ 而/ 大部分/ 节点/ 得分/ 属性/ 值/ 都/ 属于/ 正常/ 分布/ 的/ 情形/ ,/ 我们/ 提出/ 了/ 优化/ 的/ 集中式/ top/ -/ k/ 连接/ 算法/ OCTJQ/ (/ OptimizedCentralizedTop/ -/ kJoinQueries/ )/ ./ OCTJQ/ 算法/ 如/ 算法/ 3/ 所示/ ./ 算法/ 3/ ./ OCTJQ/ 算法/ ./ 输入/ :/ 基站/ 所获/ 的/ 部分/ 元组/ 输出/ :/ top/ -/ k/ 连接/ 结果/ 1/ ./ for/ 每个/ 普通/ 节点/ sjdo2/ ./ if/ (/ Tj/ ./ score/ >/ =/ MaxThresholdScore/ )/ 3/ ./ 发送/ 元组/ Tj/ 给/ 基站/ ./ 4/ ./ end/ -/ if5/ ./ end/ -/ for6/ ./ 基站/ 广播/ Tj/ ./ join/ 给/ 所有/ 节点/ ./ 7/ ./ for/ 每个/ 普通/ 节点/ skdo8/ ./ ifTk/ ./ join/ 和/ Tj/ ./ join/ 满足/ 连接/ 条件/ 9/ ./ 发送/ 元组/ Tk/ 给/ 基站/ ./ 10/ ./ end/ -/ if11/ ./ end/ -/ for12/ ./ Lk/ 是/ 目前/ 所获/ 组合/ 得分/ 最大/ 的/ k/ 个/ 连接/ 结果/ 表/ ,/ 13/ ./ if/ (/ scorek/ / f/ (/ MaxThresholdScore/ ;/ min/ (/ NDS/ )/ )/ )/ 退出/ 14/ ./ else/ 调用/ CTJQ/ 算法/ ./ 15/ ./ end/ -/ ifOCTJQ/ 算法/ 描述/ 如下/ :/ 参数/ MaxThresholdScore/ 表示/ 最大/ 门限/ 得分/ 属性/ 值/ ,/ 该值/ 是/ 查询/ 区域/ 中/ 比/ 正常/ 分布/ 值/ 大得多/ 的/ 得分/ 属性/ 值/ ./ 该值/ 应/ 满足/ 如下/ 式/ (/ 1/ )/ 条件/ :/ f/ (/ MaxThresholdScore/ ;/ min/ (/ NDS/ )/ )/ / NDS/ (/ NormalDistributionofScorevalues/ )/ 表示/ 正常/ 分布/ 的/ 所有/ 得分/ 属性/ 值/ ./ min/ (/ NDS/ )/ 表示/ 正常/ 分布/ 得分/ 属性/ 值中/ 最小值/ ;/ max/ (/ NDS/ )/ 表示/ 正常/ 分布/ 得分/ 属性/ 值中/ 最大值/ ./ max/ (/ NDS/ )/ 和/ min/ (/ NDS/ )/ 通常/ 根据/ 历史/ 经验/ 数据/ 获得/ ./ 在/ OCTJQ/ 算法/ 中/ ,/ 首先/ ,/ 各/ 节点/ 判断/ 得分/ 属性/ 值/ Tj/ ./ score/ 是否/ 大于/ 等于/ MaxThresholdScore/ ;/ 如果/ 得分/ 属性/ 值/ 大于/ 等于/ MaxThresholdScore/ ,/ 该/ 元组/ 将会/ 被/ 传输/ 给/ 基站/ ./ 基站/ 接收/ 到/ 高/ 得分/ 属性/ 值/ 元组/ 后/ ,/ 提取/ 出/ 元组/ 的/ 连接/ 属性/ 值/ Tj/ ./ join/ ,/ 并/ 向/ 网络/ 中/ 所有/ 节点/ 广播/ 该值/ ./ 节点/ sk/ 收到/ 该/ 消息/ 后/ ,/ 将/ 其/ 感知/ 的/ 连接/ 属性/ 值/ Tk/ ./ join/ 与/ 基站/ 广播/ 的/ 连接/ 属性/ 值/ Tj/ ./ join/ 进行/ 比较/ ,/ 若/ 满足/ 连接/ 条件/ ,/ 则/ 向/ 基站/ 发送/ 元组/ Tk/ ./ 基站/ 收集/ 到/ 元组/ 后/ ,/ 产生/ 相应/ 连接/ 结果/ ,/ 并/ 加入/ Lk/ 连接/ 结果/ 表/ ./ scorek/ 是/ Lk/ 中/ 最小/ 组合/ 得分/ ./ 如果/ scorek/ / f/ (/ MaxThresholdScore/ ;/ min/ (/ NDS/ )/ )/ ,/ 此时/ ,/ 基站/ 能/ 获得/ 正确/ 的/ top/ -/ k/ 连接/ 结果/ ,/ 并/ 停止/ 执行/ 该/ 算法/ ./ 否则/ ,/ 继续执行/ 集中式/ top/ -/ k/ 连接/ 查询/ 算法/ CTJQ/ ,/ 以/ 获得/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 对于/ 图/ 3/ 所示/ 各/ 节点/ 的/ 元组/ 分布/ ,/ 我们/ 设/ MaxThresholdScore/ =/ 100/ ./ 首先/ ,/ 节点/ 1/ 的/ 得分/ 属性/ 值/ 大于/ 等于/ MaxThresholdScore/ ,/ 该/ 元组/ 将会/ 被/ 传输/ 给/ 基站/ ,/ 基站/ 提取/ 出/ 节点/ 1/ 元组/ 连接/ 属性/ 值/ T1/ ./ join/ (/ T1/ ./ join/ =/ 1/ )/ ,/ 并/ 广播/ 该/ 连接/ 属性/ 值/ T1/ ./ join/ 给/ 整个/ 网络/ ./ 节点/ 3/ 和/ 7/ 收到/ 广播/ 消息/ 后/ ,/ 发现/ 连接/ Page7/ 属性/ 值/ T3/ ./ join/ ,/ T7/ ./ join/ 和/ T1/ ./ join/ 满足/ 连接/ 条件/ ,/ 因此/ 将/ 元组/ T3/ 和/ T7/ 发送给/ 基站/ ./ 基站/ 收到/ 元组/ T3/ 和/ T7/ 后/ ,/ 产生/ 相应/ 连接/ 结果/ ,/ 并/ 加入/ Lk/ 连接/ 结果/ 表/ ./ 然后/ 判断/ 是否/ 满足/ 停止/ 条件/ ,/ 若/ 不/ 满足/ ,/ 继续执行/ 集中式/ top/ -/ k/ 连接/ 查询/ 算法/ CTJQ/ ,/ 以/ 获得/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 4.4/ 分布式/ top/ -/ 犽/ 连接/ 算法/ DTJQ/ 如果/ 查询/ 区域/ 为/ 网络/ 中/ 一个/ 子/ 区域/ ,/ 该子/ 区域/ 离/ 基站/ 很/ 远/ (/ 如图/ 4/ 所示/ )/ ,/ 集中式/ top/ -/ k/ 连接/ 算法/ 图/ 4DTJQ/ 算法/ 实例/ 在/ 图/ 4/ 和/ 图/ 5/ 所示/ 实例/ 中/ ,/ 假设/ 连接/ 条件/ 是/ 两元/ 组/ 连接/ 属性/ 值/ 相等/ ,/ 即/ Ti/ ./ join/ =/ Tj/ ./ join/ ;/ 组合/ 得分/ 函数/ 是/ 两/ 节点/ 得分/ 属性/ 值/ 之/ 和/ ,/ 即/ fij/ =/ Ti/ ./ score/ +/ Tj/ ./ score/ ;/ 基站/ 要求/ 获得/ top/ -/ 2/ 连接/ 结果/ ./ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ 基本/ 思想/ 如下/ :/ 假设/ 某/ 节点/ 能/ 获得/ 查询/ 区域/ 内/ 最大/ 得分/ 属性/ 值/ GMaxScore/ 和/ 其它/ 部分/ 元组/ ./ 根据/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ ,/ Lk/ 是/ 目前/ 根据/ 部分/ 元组/ 获得/ 的/ 组合/ 得分/ 最大/ 的/ k/ 个/ 连接/ 结果/ 表/ ,/ scorek/ 是/ Lk/ 中/ 最小/ 组合/ 得分/ ./ 组合/ 得分/ 函数/ f/ 是/ 单调/ 的/ ./ 如果/ 某/ 元组/ Ti/ 得分/ 属性/ 值/ Ti/ ./ score/ 和/ 最大/ 得分/ 属性/ 值/ GMaxScore/ 的/ 组合/ 得分/ 满足/ f/ (/ GMaxScore/ ;/ Ti/ ./ score/ )/ / scorek/ ,/ 则/ 该/ 元组/ Ti/ 不/ 属于/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 如图/ 5/ 所示/ ,/ GMaxScore/ =/ 10/ ./ Lk/ =/ {/ 18/ ,/ 15/ }/ ;/ scorek/ =/ 15/ ./ CTJQ/ 可能/ 导致/ 离/ 基站/ 近/ 的/ 节点/ 中继/ 数据包/ 数量/ 很大/ ,/ 消耗/ 能量/ 过多/ ,/ 节点/ 过早/ 死亡/ ./ 如果/ 在/ 查询/ 区域/ 中心/ 选择/ 一个/ 节点/ 收集/ 数据/ 并/ 计算/ top/ -/ k/ 连接/ 结果/ ,/ 该/ 节点/ 需要/ 很大/ 的/ 存储空间/ ./ 由于/ 查询/ 区域/ 中心/ 节点/ 也/ 是/ 普通/ 节点/ ,/ 存储空间/ 有限/ ,/ 因此/ 该/ 方案/ 不/ 可行/ ./ 为此/ 我们/ 提出/ 了/ 一种/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ (/ DistributedTop/ -/ kJoinQueries/ )/ ,/ 以便/ 在/ 查询/ 区域/ 为/ 网络/ 中子/ 区域/ ,/ 该子/ 区域/ 离/ 基站/ 很远/ 的/ 场合/ 下/ 获得/ top/ -/ k/ 连接/ 查询/ 结果/ ./ f/ (/ GMaxScore/ ;/ Ti/ ./ score/ )/ =/ (/ GMaxScore/ +/ Ti/ ./ score/ )/ / scorek/ ./ 即/ Ti/ ./ score/ / scorek/ -/ GMaxScore/ =/ 15/ -/ 10/ =/ 5/ ./ 这样/ ,/ 元组/ (/ 6/ ,/ 7/ ,/ 5/ )/ 和/ (/ 7/ ,/ 1/ ,/ 4/ )/ 将/ 不/ 属于/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 因此/ ,/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ 可以/ 利用/ 已获/ 的/ 局部/ top/ -/ k/ 连接/ 结果/ 抑制/ 不/ 属于/ 最终/ top/ -/ k/ 连接/ 结果/ 的/ 元组/ ./ DTJQ/ 中/ 涉及/ 的/ 重要/ 符号/ 描述/ 如表/ 1/ 所示/ ./ DTJQ/ 算法/ 如/ 算法/ 4/ 所示/ ./ 符号/ CNi/ 第/ i/ 格/ 中心/ 节点/ g/ 中心/ 节点/ CNi/ 第/ g/ 个子/ 范围/ 表/ L/ _/ SubCNiNLCNik/ 中心/ 节点/ CNi/ 新/ 产生/ 的/ top/ -/ k/ 连接/ 结果/ PLCNgCNikLCNik/ 中心/ 节点/ CNi/ 目前/ 所获/ 的/ top/ -/ k/ 连接/ 结果/ 表/ 算法/ 4/ ./ DTJQ/ 算法/ ./ 输入/ :/ 各/ 中心/ 节点/ 所获/ 的/ 部分/ 元组/ 输出/ :/ top/ -/ k/ 连接/ 结果/ 1/ ./ for/ 每个/ TSmdo2/ ./ for/ 每个/ 普通/ 节点/ sjdo3/ ./ if/ (/ sj/ ./ score/ ∈/ [/ Sm/ ./ LowerBound/ ,/ Sm/ ./ UpperBound/ )/ )/ 4/ ./ 选取/ 最近/ 的/ CNi/ 并/ 发送/ 元组/ 给/ CNi/ ./ Page85/ ./ end/ -/ if6/ ./ end/ -/ for7/ ./ for/ 每个/ CNido8/ ./ 接收/ 元组/ 并/ 加入/ 到/ L/ _/ SubCNi9/ ./ 按照/ score/ 从大到/ 小/ 对/ L/ _/ SubCNi10/ ./ 计算/ LCNik/ 并/ 识别/ 被/ 抑制/ 元组/ ./ 11/ ./ for/ 每个/ L/ _/ SubCNi12/ ./ 发送/ 正常值/ 数据包/ 给/ CNg/ ./ 13/ ./ end/ -/ for14/ ./ 接收/ 其它/ 中心/ 节点/ 发送给/ CNi/ 的/ 正常值/ 数据包/ ./ 15/ ./ 发送/ 边界值/ 数据包/ 给/ CN/ (/ i/ +/ 1/ )/ ./ 16/ ./ 接收/ 边界值/ 数据包/ ./ 17/ ./ 计算/ LCNik/ 并/ 识别/ 被/ 抑制/ 元组/ ./ 18/ ./ if/ 满足/ 停止/ 条件/ 19/ ./ 发送/ 停止/ 消息/ 包/ 给/ 其它/ 中心/ 节点/ ./ 20/ ./ end/ -/ if21/ ./ if/ 收到/ 其它/ 中心/ 节点/ CNg/ (/ i/ ≠/ g/ )/ 发送/ 的/ 停止/ 消/ 22/ ./ 计算/ LCNik/ ./ 23/ ./ end/ -/ if24/ ./ if/ 满足/ 停止/ 条件/ 或/ 收到/ 停止/ 消息/ 包/ 25/ ./ 发送/ 匹配/ 元组/ 给/ 基站/ 并/ 退出/ ./ 26/ ./ end/ -/ if27/ ./ end/ -/ for28/ ./ end/ -/ forDTJQ/ 详细描述/ 如下/ :/ 和/ 集中式/ top/ -/ k/ 连接/ 算法/ CTJQ/ 一样/ ,/ 基站/ 根据/ 搜集/ 到/ 的/ 历史数据/ ,/ 把/ 得分/ 属性/ 分割/ 成/ M/ 个子/ 范围/ ,/ [/ Sm/ ./ LowerBound/ ,/ Sm/ ./ UpperBound/ )/ (/ 1/ / m/ / M/ )/ ,/ 使/ 每个/ 子/ 范围/ 内/ 元组/ 数/ 近似/ 相等/ ./ 然后/ ,/ 基站/ 向/ 网络/ 内/ 所有/ 节点/ 广播/ M/ 个子/ 范围/ 边界值/ ./ 设/ 每/ 一轮/ 时间/ 长度/ 为/ T/ ,/ 每/ 一轮/ 时间/ T/ 分成/ M/ 个/ 时间/ 片/ TS/ (/ TimeSlice/ )/ ,/ 时间/ 片/ M/ 数目/ 和/ 得分/ 属性/ 值/ 划分/ 子/ 范围/ 数目/ M/ 相同/ ,/ 每个/ 时间/ 片/ TS/ =/ T/ // M/ ./ 普通/ 节点/ 得分/ 属性/ 值越/ 大/ ,/ 越/ 安排/ 在/ 靠/ 前/ 时间/ 片内/ 发送数据/ 给/ 最近/ 的/ 中心/ 节点/ ./ 4.4/ ./ 1/ 网络/ 预/ 划分/ 基站/ 综合/ 考虑/ 查询/ 区域/ 大小/ 和/ 普通/ 节点/ 存储空间/ 及/ 计算能力/ ,/ 把/ 整个/ 查询/ 区域/ 分成/ L/ 格/ ,/ 每个/ 格由/ 基站/ 计算/ 出格/ 中心/ 节点/ 位置/ 并/ 选择/ 离/ 中心/ 节点/ 位置/ 最近/ 的/ 普通/ 节点/ 成为/ 中心/ 节点/ CN/ (/ CentralNode/ )/ ./ 基站/ 根据/ 搜集/ 到/ 的/ 历史数据/ ,/ 将/ 获得/ 各/ 节点/ 元组/ 中/ 连接/ 属性/ 值/ Ti/ ./ join/ 的/ 分布/ ,/ 并/ 据此/ 分布/ 把/ 连接/ 属性/ 分割/ 成/ L/ 个子/ 范围/ [/ LowerBound/ ,/ UpperBound/ )/ ,/ 子/ 范围/ 数目/ 和/ 查询/ 区域/ 中/ 划分/ 格/ 数目/ 相等/ ,/ 并/ 使/ 每个/ 子/ 范围/ 内/ 元组/ 数/ 近似/ 相等/ ./ 每个/ 中心/ 节点/ CNi/ 处理/ 一个/ 子/ 范围/ [/ CNi/ ./ LowerBound/ ,/ CNi/ ./ UpperBound/ )/ 内/ 元组/ 的/ 连接/ 结果/ ./ 然后/ ,/ 基站/ 向/ 查询/ 区域/ 内/ 所有/ 节点/ 下发/ 中心/ 节点/ CNi/ ./ ID/ 及其/ 位置/ 信息/ (/ CNi/ ./ x/ ,/ CNi/ ./ y/ )/ 、/ 中心/ 节点/ 处理/ 连接/ 结果/ 的/ 子/ 范围/ [/ CNi/ ./ LowerBound/ ,/ CNi/ ./ UpperBound/ )/ ./ 如图/ 4/ 所示/ ,/ 查询/ 区域/ 被/ 划分/ 成/ 4/ 个格/ ,/ 中心/ 节点/ CN1/ ~/ CN4/ 分别/ 处理/ 子/ 范围/ [/ 0/ ,/ 10/ )/ ,/ [/ 10/ ,/ 20/ )/ ,/ [/ 20/ ,/ 30/ )/ ,/ [/ 30/ ,/ 40/ )/ 内/ 元组/ 连接/ 结果/ ./ 例如/ [/ CN1/ ./ LowerBound/ ,/ CN1/ ./ UpperBound/ )/ =/ [/ 0/ ,/ 10/ )/ ./ 4.4/ ./ 2/ 本地/ 数据/ 存储/ 在/ 每/ 一轮/ 第/ m/ (/ 1/ / m/ / M/ )/ 个/ 时间/ 片/ TSm/ 内/ ,/ 普通/ 节点/ sj/ 判断/ 得分/ 属性/ 值/ sj/ ./ score/ 是否/ 属于/ [/ Sm/ ./ LowerBound/ ,/ Sm/ ./ UpperBound/ )/ 范围/ ./ 如果/ 属于/ 该/ 范围/ ,/ 普通/ 节点/ sj/ 选取/ 离/ 自己/ 最近/ 的/ 中心/ 节点/ CNi/ 作为/ 目标/ 节点/ D/ ,/ 并/ 采用/ 基于/ 地理/ 路由/ 协议/ ,/ 如/ GPSR/ [/ 18/ ]/ ,/ 把/ 采集/ 的/ 属性/ 值/ 封装/ 在/ 元组/ T/ 中/ ,/ 并/ 传输/ 给/ 目标/ 节点/ D/ ./ 此时/ ,/ 采用/ (/ T/ ,/ D/ )/ 消息/ 格式/ ,/ T/ 代表/ 元组/ ,/ T/ =/ (/ sj/ ./ id/ ,/ join/ ,/ score/ )/ ;/ D/ 代表/ 目的地/ 中心/ 节点/ CNi/ 的/ 位置/ 信息/ ,/ D/ =/ (/ CNi/ ./ x/ ,/ CNi/ ./ y/ )/ ./ 各/ 中心/ 节点/ 收到/ 本格/ 内/ 各/ 普通/ 节点/ 发送/ 的/ 元组/ Tj/ 后/ ,/ 按照/ 连接/ 属性/ 值/ Tj/ ./ join/ 属于/ 哪个/ 子/ 范围/ ,/ 把/ 该/ 元组/ 归入/ 到/ 相应/ 的/ 子/ 范围/ 表/ L/ _/ SubCNi/ 中/ ./ 子/ 范围/ 表/ L/ _/ SubCNi/ 组/ ./ 如图/ 4/ 所示/ ,/ 每个/ 中心/ 节点/ 有/ 4/ 个子/ 范围/ 表/ ,/ L/ _/ SubCNi1/ ,/ L/ _/ SubCNi2/ ,/ L/ _/ SubCNi3/ ,/ L/ _/ SubCNi4/ ;/ 分别/ 对应/ 4/ 个子/ 范围/ :/ [/ 0/ ,/ 10/ )/ ,/ [/ 10/ ,/ 20/ )/ ,/ [/ 20/ ,/ 30/ )/ ,/ [/ 30/ ,/ 40/ )/ ./ 如果/ 中心/ 节点/ CN1/ 有/ 一条/ 元组/ Tj/ ./ join/ =/ 1/ ,/ Tj/ ./ join/ ∈/ [/ 0/ ,/ 10/ )/ ,/ 该/ 元组/ Tj/ 将/ 归入/ 到子/ 范围/ 表/ L/ _/ SubCN11/ 中/ ./ 各/ 中心/ 节点/ CNi/ 对/ 每个/ 本地/ 子/ 范围/ 表/ L/ _/ SubCNi/ 中/ 元组/ 按照/ 得分/ 属性/ 值/ (/ score/ )/ 从大到/ 小/ 排序/ ./ 4.4/ ./ 3/ 中心/ 节点/ 计算/ top/ -/ k/ 连接/ 结果/ (/ 1/ )/ 本地/ 局部/ top/ -/ k/ 连接/ 结果/ 计算/ ./ 在/ 当前/ 时间/ 片/ TSm/ 内/ ,/ 各/ 中心/ 节点/ CNi/ 计算/ 连接/ 属性/ 值/ (/ join/ )/ 落入/ 自己/ 子/ 范围/ [/ CNi/ ./ Lower/ -/ Bound/ ,/ CNi/ ./ UpperBound/ )/ 内新/ 产生/ 的/ top/ -/ k/ 连接/ 结果/ NLCNik/ ,/ 将/ 其/ 归并到/ LCNik/ 中/ ,/ 并/ 识别/ 被/ 抑制/ 元组/ (/ 算法/ 4/ 第/ 10/ 行/ )/ ./ LCNik/ =/ (/ LCNik/ ∪/ NLCNik/ )/ top/ -/ k/ ./ 如图/ 4/ ,/ 中心/ 节点/ CN1/ 在/ 当前/ 时间/ 片/ TS1/ 内/ 计算/ 自己/ 子/ 范围/ [/ 0/ ,/ 10/ )/ 内/ 的/ 局部/ top/ -/ 2/ 连接/ 结果/ ,/ 获得/ top/ -/ 1/ 和/ top/ -/ 2/ 组合/ 得分/ 分别/ 是/ 18/ 和/ 15/ ./ NLCNik/ =/ NLCN12/ =/ {/ 18/ ,/ 15/ }/ ./ (/ 2/ )/ 正常值/ 数据包/ 构建/ 、/ 发送/ 和/ 接收/ ./ 中心/ 节点/ CNi/ 把子/ 范围/ 表/ L/ _/ SubCNi/ 的/ 元组/ 封装/ 成/ 正常值/ 数据包/ 发送到/ 中心/ 节点/ CNg/ ./ Page9/ 如图/ 4/ ,/ 中心/ 节点/ CN1/ 需要/ 把子/ 范围/ 表/ L/ _/ SubCN12/ ,/ L/ _/ SubCN13/ 和/ L/ _/ SubCN14/ 中/ 需要/ 发送/ 的/ 元组/ 分别/ 封装/ 成/ 数据包/ 发送给/ 相应/ 的/ 中心/ 节点/ CN2/ ,/ CN3/ 和/ CN4/ ./ 消息/ 包/ 格式/ 如图/ 6/ 左边/ 所示/ ./ LMaxScore/ 表示/ 中心/ 节点/ CNi/ 的/ 局部/ 最大/ 得/ 分值/ ,/ LMaxScore/ 只/ 在/ 第/ 1/ 个/ 时间/ 片/ TS1/ 且/ 第/ 1/ 个/ 数据包/ 内/ 传输/ 给/ 其它/ 中心/ 节点/ CNg/ (/ i/ ≠/ g/ )/ ;/ tuple/ 表示/ 需要/ 发送给/ 其它/ 中心/ 节点/ CNg/ 的/ 元组/ ;/ LTopk/ 表示/ 中心/ 节点/ CNi/ 能/ 封装/ 进/ 一个/ 数据包/ 的/ 局部/ top/ -/ k/ 连接/ 结果/ 个数/ ;/ LTop1Score/ 到/ LTopkScore/ 表示/ 各个/ 局部/ top/ -/ k/ 组合/ 得分/ ./ 图/ 6/ 右边/ 所示/ 为/ 中心/ 节点/ CN1/ 第一个/ 消息/ 包/ ./ 假设/ 中心/ 节点/ CN1/ 的/ 局部/ 最大/ 得/ 分值/ 是/ 11/ ;/ 中心/ 节点/ CN1/ 有/ 2/ 个/ 局部/ top/ -/ k/ 结果/ ,/ 其/ 组合/ 得分/ 分别/ 是/ 18/ 和/ 15/ ;/ tuple/ 表示/ 中心/ 节点/ CN1/ 需要/ 发送给/ 其它/ 中心/ 节点/ 的/ 元组/ ./ 局部/ top/ -/ k/ 连接/ 结果/ 以/ “/ 捎带/ ”/ 传输方式/ 进行/ 传输/ ./ “/ 捎带/ ”/ 传输方式/ 是/ 指/ :/ 如果/ 正常/ 传输/ 的/ 数据/ 不能/ 完全/ 填充/ 一个/ 数据包/ ,/ 该/ 数据包/ 剩余/ 的/ 空间/ 可以/ 传输/ 局部/ top/ -/ k/ 连接/ 结果/ ./ 之所以/ 使用/ “/ 捎带/ ”/ 传输方式/ ,/ 是因为/ 每次/ 把/ 完整/ 的/ 局部/ top/ -/ k/ 连接/ 结果/ 传输/ 给/ 其它/ 中心/ 节点/ ,/ 将/ 耗费/ 很多/ 能量/ 和/ 带宽/ ,/ 而/ 这些/ 局部/ top/ -/ k/ 连接/ 结果/ 不/ 一定/ 属于/ 最终/ 的/ 全局/ top/ -/ k/ 连接/ 结果/ ./ 该/ 阶段/ 结束/ 时/ ,/ 中心/ 节点/ CNi/ 将/ 收到/ 其它/ 中心/ 节点/ CNg/ (/ i/ ≠/ g/ )/ 发送/ 的/ 属于/ 中心/ 节点/ CNi/ 处理/ 子/ 范围/ [/ CNi/ ./ LowerBound/ ,/ CNi/ ./ UpperBound/ )/ 内/ 的/ 数据包/ ./ 如图/ 4/ 所示/ ,/ 中心/ 节点/ CN1/ 将/ 收到/ 中心/ 节点/ CN2/ ,/ CN3/ 和/ CN4/ 发送/ 的/ 属于/ 中心/ 节点/ CN1/ 处理/ 子/ 范围/ [/ 0/ ,/ 10/ )/ 内/ 的/ 数据包/ ./ (/ 3/ )/ 边界值/ 数据包/ 构建/ 、/ 发送/ 和/ 接收/ ./ 在/ 连接/ 条件/ 中/ ,/ |/ Ti/ ./ join/ -/ Tj/ ./ join/ |/ / τ/ ./ 这样/ ,/ 属于/ 子/ 范围/ 表/ L/ _/ SubCNii/ 中/ 的/ 元组/ 也/ 可能/ 和子/ 范围/ 表/ (/ i/ +/ 1/ )/ 中/ 的/ 元组/ 满足/ 连接/ 条件/ ./ 如图/ 4/ ,/ 如果/ 连接/ L/ _/ SubCN/ (/ i/ +/ 1/ )/ 条件/ 为/ |/ Ti/ ./ join/ -/ Tj/ ./ join/ |/ / 1/ ,/ 而/ 中心/ 节点/ CN2/ 某/ 元组/ Ti/ 的/ 连接/ 属性/ 值/ Ti/ ./ join/ =/ 19.5/ ,/ 该/ 元组/ 属于/ 子/ 范围/ 表/ L/ _/ SubCN22/ ;/ 中心/ 节点/ CN3/ 某/ 元组/ Tj/ 的/ 连接/ 属性/ 值/ Tj/ ./ join/ =/ 20.1/ ,/ 该/ 元组/ 属于/ 子/ 范围/ 表/ L/ _/ SubCN33/ ./ |/ Ti/ ./ join/ -/ Tj/ ./ join/ |/ =/ |/ 19.5/ -/ 20.1/ |/ =/ 0.6/ / 1/ ./ 因此/ ,/ 这/ 2/ 条/ 元组/ 满足/ 连接/ 条件/ ./ 要/ 保证/ 结果/ 正确/ ,/ 中心/ 节点/ CNi/ 需要/ 把子/ 范围/ 表/ L/ _/ SubCNii/ 中/ 连接/ 属性/ 值/ ∈/ [/ CNi/ ./ UpperBound/ -/ τ/ ,/ CNi/ ./ Upper/ -/ Bound/ )/ 的/ 元组/ 封装/ 成/ 数据包/ 发送给/ 中心/ 节点/ CN/ (/ i/ +/ 1/ )/ (/ 算法/ 4/ 第/ 15/ 行/ )/ ./ 如果/ 中心/ 节点/ CNi/ 有/ 两条/ 元组/ 的/ 连接/ 属性/ 值/ 都/ 属于/ [/ CNi/ ./ UpperBound/ -/ τ/ ,/ CNi/ ./ UpperBound/ )/ ,/ 那么/ 这/ 两条/ 元组/ 的/ 连接/ 结果/ 只/ 在/ 中心/ 节点/ CNi/ 中/ 统计/ ,/ 不/ 在/ 中心/ 节点/ CN/ (/ i/ +/ 1/ )/ 中/ 统计/ ,/ 避免/ 重复/ 计算/ ./ 如图/ 4/ ,/ 中心/ 节点/ CN2/ 需要/ 把子/ 范围/ 表/ L/ _/ SubCN22/ 中/ 连接/ 属性/ 值/ ∈/ [/ 20/ -/ τ/ ,/ 20/ )/ 的/ 元组/ 发送给/ 中心/ 节点/ CN3/ ./ 如果/ Ti/ ./ join/ =/ 19.9/ ;/ Tj/ ./ join/ =/ 19.8/ ,/ 这/ 两条/ 元组/ 都/ 会/ 被/ 送往/ 中心/ 节点/ CN3/ ,/ 但/ 连接/ 结果/ 只/ 在/ 中心/ 节点/ CN2/ 中/ 统计/ ,/ 不/ 在/ 中心/ 节点/ CN3/ 中/ 统计/ ,/ 避免/ 重复/ 计算/ ./ (/ 4/ )/ 局部/ top/ -/ k/ 连接/ 结果/ 合并/ 和/ 过滤/ ./ 中心/ 节点/ CNi/ 收齐/ 其它/ 中心/ 节点/ CNg/ 发送/ 的/ 正常值/ 数据包/ 和/ 边界值/ 数据包/ 后/ ,/ 解析/ 数据包/ ,/ 并/ 保存/ 对应/ 数据/ ./ 这样/ ,/ 每个/ 中心/ 节点/ CNi/ 都/ 将/ 收到/ 其它/ 中心/ 节点/ CNg/ 的/ 局部/ 最大/ 得/ 分值/ ,/ 就/ 能/ 得出/ 整个/ 查询/ 区域/ 内/ 全局/ 的/ 最大/ 得/ 分值/ GMaxScore/ ./ 如图/ 4/ 所示/ ,/ 设/ GMaxScore/ =/ 11/ ./ 中心/ 节点/ CNi/ 将/ 自己/ 新/ 产生/ 的/ top/ -/ k/ 连接/ 结果/ NLCNik/ 和/ 其它/ 中心/ 节点/ “/ 捎带/ ”/ 传输/ 的/ 部分/ top/ -/ k/ 组合/ 得分/ PLCNgCNik/ 归并到/ LCNik/ 中/ ,/ 然后/ 对/ LCNik/ 按照/ 组合/ 得分/ 排序/ ,/ 并取/ top/ -/ k/ 最大/ 组合/ 得分/ 连接/ 结果/ ,/ 即/ LCNik/ =/ (/ LCNik/ ∪/ NLCNik/ ∪/ PLCN1CNik/ ∪/ …/ ∪/ PLCNgCNik/ )/ top/ -/ k/ ./ scoreCNik/ 是/ LCNik/ 中/ 最小/ 组合/ 得分/ ,/ 即/ 第/ k/ 个/ 组合/ 得/ 分值/ ./ 如图/ 4/ 所示/ 中心/ 节点/ CN2/ ,/ 设/ NLCNik/ =/ NLCN22/ =/ {/ 16/ }/ ;/ PLCNgCNik/ =/ PLCN1CN22/ =/ {/ 18/ ,/ 15/ }/ ./ LCN22/ =/ (/ LCN22/ ∪/ NLCN22/ ∪/ PLCN1CN22/ ∪/ PLCN3CN22/ ∪/ PLCN4CN22/ )/ top/ -/ 2/ =/ {/ 16/ ,/ 18/ ,/ 15/ }/ top/ -/ 2/ =/ {/ 18/ ,/ 16/ }/ ./ scoreCN22/ 是/ 16/ ./ 如果/ 某/ 元组/ Ti/ 的/ 得分/ 属性/ 值/ Ti/ ./ score/ 和/ 最大/ 得分/ 属性/ 值/ GMaxScore/ 的/ 组合/ 得分/ f/ (/ GMaxScore/ ;/ Ti/ ./ score/ )/ / scoreCNik/ ,/ 则/ 该/ 元组/ Ti/ 将/ 不/ 属于/ 最终/ top/ -/ k/ 连接/ 结果/ ./ 如图/ 4/ 所示/ 中心/ 节点/ CN2/ ,/ f/ (/ GMaxScore/ ;/ Ti/ ./ score/ )/ =/ (/ GMaxScore/ +/ Ti/ ./ score/ )/ / scoreCNik/ ./ 即/ Ti/ ./ score/ / scoreCNik/ -/ GMaxScore/ =/ 16/ -/ 11/ =/ 5/ ./ 在/ 下/ 一个/ 时间/ 片/ TSm/ +/ 1/ 内/ ,/ 得分/ 属性/ 值/ (/ score/ )/ 小于/ 等于/ 5/ 的/ 元组/ 都/ 不/ 属于/ 最终/ top/ -/ k/ 结果/ ,/ 都/ 不用/ 发送给/ 其它/ 中心/ 节点/ ,/ 都/ 能/ 被/ 抑制/ 掉/ ./ 所以/ ,/ 中心/ 节点/ CN2/ 的/ 元组/ (/ 7/ ,/ 1/ ,/ 4/ )/ 能/ 被/ 抑制/ ./ (/ 5/ )/ 算法/ 终止/ 条件/ ./ 中心/ 节点/ CNi/ 根据/ 目前/ 所/ 获得/ 的/ top/ -/ k/ 连接/ Page10/ 结果/ LCNik/ ,/ 按照/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 判断/ 是否/ 满足/ 停止/ 条件/ ./ 如果/ 满足/ ,/ 中心/ 节点/ CNi/ 发送/ 停止/ (/ terminate/ )/ 消息/ 给/ 其它/ 中心/ 节点/ CNg/ (/ i/ ≠/ g/ )/ ./ 中心/ 节点/ CNi/ 把/ TerminateFlag/ 标志/ 位/ 和/ LCNik/ 中/ 没有/ 发送给/ 中心/ 节点/ CNg/ 的/ 属于/ CNi/ 产生/ 的/ 最大/ 的/ 能/ 封装/ 进/ 一个/ 消息/ 包/ 的/ top/ -/ k/ 连接/ 结果/ 封装/ 成/ 一个/ 停止/ 消息/ 包/ 发送给/ 中心/ 节点/ CNg/ ./ 中心/ 节点/ CNg/ 接收/ 到/ 停止/ 消息/ 包后/ ,/ 解析/ 消息/ 包并/ 重新/ 计算/ top/ -/ k/ 连接/ 结果/ LCNgk/ ./ 如果/ 中心/ 节点/ CNi/ 发送/ 或/ 接收/ 了/ 停止/ 消息/ 包/ ,/ CNi/ 把/ 自己/ 子/ 范围/ [/ CNi/ ./ LowerBound/ ,/ CNi/ ./ Upper/ -/ Bound/ )/ 内/ 计算/ 获得/ 的/ 、/ 属于/ LCNik/ 的/ 匹配/ 元组/ 发送给/ 基站/ ,/ 然后/ 退出/ ./ 否则/ ,/ 继续/ 进行/ 下/ 一个/ 时间/ 片内/ 数据传输/ ./ 优化/ 方法/ :/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ 中/ ,/ 中心/ 节点/ CNi/ 需要/ 把/ 边界值/ 数据包/ 传送/ 给/ 中心/ 节点/ CNi/ +/ 1/ ./ 在/ 基站/ 让/ 每个/ 中心/ 节点/ 对应/ 一个/ 子/ 范围/ 时/ ,/ 可以/ 让/ 相邻/ 子/ 范围/ 的/ 中心/ 节点/ 也/ 相邻/ ,/ 以/ 减少/ 数据传输/ 距离/ ./ 定理/ 2/ ./ 每个/ 中心/ 节点/ 只/ 获得/ 部分/ top/ -/ k/ 连接/ 结果/ LCNik/ ,/ 但/ 基站/ 能/ 获得/ 正确/ 的/ 全部/ top/ -/ k/ 连接/ 结果/ ./ 证明/ ./ 中心/ 节点/ CNi/ 的/ top/ -/ k/ 连接/ 结果/ LCNik/ 包括/ 自己/ 子/ 范围/ [/ CNi/ ./ LowerBound/ ,/ CNi/ ./ Upper/ -/ Bound/ )/ 内/ 产生/ 的/ 全部/ top/ -/ k/ 连接/ 结果/ ,/ 还/ 包括/ 其它/ 中心/ 节点/ 发送给/ CNi/ 的/ 部分/ top/ -/ k/ 连接/ 结果/ ./ scoreCNik/ 是/ LCNik/ 中/ 最小/ 组合/ 得分/ ./ Lk/ 表示/ 基站/ 所获/ 的/ 查询/ 区域/ 内/ top/ -/ k/ 连接/ 结果/ ,/ scorek/ 是/ Lk/ 中/ 最小/ 组合/ 得分/ ./ Lk/ =/ (/ LCN1k/ ∪/ …/ ∪/ LCNLk/ )/ top/ -/ k/ ./ 因此/ ,/ scoreCNik/ / scorek/ ./ 根据/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ ,/ 若/ scoreCNik/ / TScore/ ,/ 满足/ 停止/ 条件/ ,/ 中心/ 节点/ CNi/ 发送/ 停止/ 消息/ 给/ 其它/ 中心/ 节点/ ,/ 并/ 发送/ top/ -/ k/ 连接/ 结果/ 给/ 基站/ ./ 此时/ ,/ 必然/ scorek/ / TScore/ ,/ 也/ 满足/ 停止/ 条件/ ./ 因此/ ,/ 基站/ 能/ 获得/ 正确/ 的/ 全部/ top/ -/ k/ 连接/ 结果/ ./ 证毕/ ./ 5/ 实验/ 为了/ 分析/ 和/ 验证/ 各/ 算法/ 的/ 性能/ ,/ 我们/ 在/ omnetpp/ -/ 4.1/ 平台/ 上/ 实现/ 了/ 本文/ 提出/ 的/ 各个/ 算法/ ,/ 并/ 和/ SENS/ -/ Join/ [/ 13/ ]/ 进行/ 了/ 比较/ ./ 我们/ 的/ 实验/ 使用/ 了/ 真实/ 数据/ 集/ LUCE/ ①/ ./ 该/ 数据/ 集/ 包含/ 各/ 节点/ 的/ 位置/ 信息/ ,/ 因/ 节点/ 分布/ 不/ 均匀/ ,/ 破坏/ 了/ 网络/ 连通性/ ,/ 我们/ 修改/ 了/ 个别/ 节点/ 的/ 位置/ ./ 该/ 数据/ 集/ 还/ 包含/ 多个/ 属性/ ,/ 如/ 环境温度/ (/ AmbientTemperature/ )/ 、/ 相对湿度/ (/ RelativeHumidity/ )/ 、/ 土壤水分/ (/ SoilMoisture/ )/ 等等/ ./ 我们/ 取/ 环境温度/ (/ AmbientTemperature/ )/ 属性/ 作为/ 得分/ 属性/ 值/ ,/ 相对湿度/ (/ RelativeHumidity/ )/ 属性/ 作为/ 连接/ 属性/ 值/ ./ 在/ 该/ 数据/ 集中/ ,/ 取/ 88/ 个/ 有效/ 节点/ 构成/ 网络/ ,/ 并/ 从/ 该/ 数据/ 集中/ 为/ 每个/ 节点/ 获取/ 连续/ 1000/ 条/ 记录/ ./ 我们/ 定义/ 一个/ 采样/ 周期/ 为/ 一轮/ ,/ 这/ 意味着/ 每个/ 节点/ 采集/ 1000/ 轮/ 数据/ ./ 消息/ 包/ 大小/ 为/ 30Bytes/ ,/ 连接/ 属性/ 值/ 和/ 得分/ 属性/ 值/ 分别/ 占/ 4Bytes/ ,/ 节点/ ID/ 占/ 2Bytes/ ./ 如前所述/ ,/ 相对/ 于/ 节点/ 计算/ ,/ 节点/ 之间/ 通信/ 将/ 消耗/ 更/ 多/ 的/ 能量/ ./ 因此/ ,/ 我们/ 使用/ 网络通信/ 代价/ 作为/ 衡量/ 网络/ 性能/ 的/ 指标/ ,/ 该/ 指标/ 包括/ 平均/ 发包/ 数/ 和/ 网络/ 生命周期/ ./ 平均/ 发包/ 数为/ 平均/ 每轮/ 每个/ 节点/ 发包/ 数/ ./ 网络/ 生命周期/ 是/ 指/ 从/ 网络/ 开始运行/ 到/ 有/ 传感器/ 节点/ 失效/ 时/ 的/ 轮数/ ./ 从/ 网络/ 可用性/ 角度看/ ,/ 网络/ 生命周期/ 是/ 比/ 平均/ 能量消耗/ 更/ 有用/ 的/ 指标/ ./ 节点/ 发包/ 数越/ 多/ ,/ 消耗/ 能量/ 越/ 多/ ,/ 越/ 容易/ 提前/ 死亡/ ,/ 网络/ 生命周期/ 越短/ ./ 所以/ ,/ 我们/ 以/ 最大/ 发包/ 数/ 衡量/ 网络/ 生命周期/ ,/ 最大/ 发包/ 数是/ 指/ 网络/ 内/ 所有/ 节点/ 中/ 平均/ 每轮/ 发包/ 数/ 最大/ 的/ 那个/ 节点/ 发包/ 数/ ./ 在/ 我们/ 的/ 方案/ 中/ ,/ 网络层/ 基于/ TAG/ [/ 19/ ]/ 路由/ ,/ 假设/ 通信/ 链路/ 没有/ 错误/ ,/ MAC/ 层/ 是/ 理想/ 的/ ./ 基站/ 通信/ 范围/ 通常/ 远大于/ 普通/ 节点/ 的/ 通信/ 范围/ ,/ 因此/ ,/ 假设/ 基站/ 通信/ 范围/ 能/ 覆盖/ 监测/ 区域/ ./ 除非/ 特别/ 说明/ ,/ 实验/ 中/ 使用/ 如下/ 默认/ 参数/ :/ 得分/ 函数/ f/ =/ (/ A/ ./ Temp/ +/ B/ ./ Temp/ )/ ;/ 连接/ 条件/ |/ A/ ./ RH/ -/ B/ ./ RH/ |/ / 1/ %/ ;/ 需要/ 获取/ top/ -/ 3/ 连接/ 结果/ ;/ 每/ 一轮/ 时间/ T/ 分成/ 10/ (/ M/ =/ 10/ )/ 个/ 时间/ 片/ ;/ 基站/ 位于/ 网络/ 区域/ 中心/ ./ 实验/ 测试/ ,/ 并/ 分析/ 了/ 各/ 算法/ 的/ 性能/ ./ 5.1/ 实验/ 场景/ 1/ 各/ 算法/ 性能/ 分析/ 场景/ (/ Scenario/ )/ 1/ 中/ 88/ 个/ 节点/ 根据/ 数据/ 集/ LUCE/ 中/ 位置/ 信息/ 构成/ 网络/ ,/ 基站/ 位于/ 网络/ 区域/ 的/ 中心/ ./ 图/ 7/ 中/ ,/ DTJQ/ -/ 3/ 表示/ 网络/ 中/ 均匀/ 地/ 选择/ 3/ 个/ 中心/ 节点/ 的/ DTJQ/ 算法/ ./ 因为/ 数据/ 集中/ 没有/ 超出/ 最大/ 门限/ 得分/ 属性/ 值/ MaxThresholdScore/ 的/ 数据/ ,/ 所以/ CTJQ/ 和/ OCTJQ/ 性能/ 一样/ ./ 如图/ 7/ (/ a/ )/ 和/ (/ b/ )/ 所示/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ 随着/ 时间/ 片/ M/ 数目/ 增大/ ,/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算/ 我们/ 将/ 所有/ 算法/ 在/ 3/ 个/ 不同/ 应用/ 场景/ 下/ 进行/ 了/ ①/ http/ :/ // // sensorscope/ ./ epfl/ ./ ch/ // index/ ./ php/ // Environmental/ _/ DataPage11/ 法/ 最大/ 和/ 平均/ 发包/ 数都/ 变小/ ./ 这/ 是因为/ 时间/ 片/ M/ 数目/ 越大/ ,/ 越能/ 在/ 较/ 前/ 时间/ 片内/ 满足/ 停止/ 条件/ ,/ 从而/ 发包/ 数越/ 少/ ./ 但是/ 当/ M/ 增大/ 到/ 一定/ 值时/ ,/ 最大/ 和/ 平均/ 发包/ 数/ 基本/ 稳定/ ./ 这/ 是因为/ 当/ 时间/ 片/ M/ 数目/ 图/ 7/ 实验/ 场景/ 1/ 各/ 算法/ 性能/ 比较/ 如图/ 7/ (/ c/ )/ 和/ (/ d/ )/ 所示/ ,/ 当/ 连接/ 条件/ 是/ 要求/ 两元/ 组/ 连接/ 属性/ 值/ 完全/ 相等/ 时/ ,/ τ/ =/ 0/ ,/ 即/ |/ A/ ./ RH/ -/ B/ ./ RH/ |/ / 0/ ,/ 将/ 导致/ 满足/ 连接/ 条件/ 元组/ 数目/ 非常少/ ./ 此时/ ,/ 在/ SENS/ -/ Join/ 算法/ 中/ ,/ 第/ 1/ 次/ 收集/ 的/ 连接/ 属性/ 值中/ 满足/ 连接/ 条件/ 的/ 节点/ 数目/ 非常少/ ,/ 导致/ 第/ 2/ 次/ 收集/ 得分/ 属性/ 值/ 数据/ 时/ ,/ 只有/ 少量/ 节点/ 需要/ 发送数据/ ./ 而/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 中/ ,/ 因为/ 满足/ 连接/ 条件/ 的/ 元组/ 数目/ 非常少/ ,/ 在/ 前面/ 数个/ 时间/ 片内/ 发送/ 的/ 数据/ 不能/ 满足/ 停止/ 条件/ ,/ 一般/ 需要/ 等/ 全部/ M/ 个/ 时间/ 片内/ 数据/ 收齐/ 后/ ,/ 才/ 满足/ 停止/ 条件/ ,/ 导致/ 自己/ 没有/ 数据/ 发送/ 但/ 需要/ 中继/ 其它/ 节点/ 数据/ 的/ 中继/ 节点/ 数/ 非常/ 多/ ,/ 额外/ 发送/ 了/ 大量/ 数据包/ ./ 所以/ 当/ 连接/ 条件/ 是/ 要求/ 两元/ 组/ 连接/ 属性/ 值/ 完全/ 相等/ 时/ ,/ 即/ τ/ =/ 0/ ,/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 不如/ SENS/ -/ Join/ 算法/ ./ 但是/ 随着/ 相对湿度/ 差/ τ/ 越来越/ 大/ ,/ 连接/ 条件/ 越来越/ 宽松/ ,/ 满足/ 连接/ 条件/ 的/ 元组/ 越来越/ 多/ ,/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 越来越/ 能/ 让/ 前面/ 数个/ 时间/ 片内/ 发送/ 的/ 数据/ 满足/ 停止/ 条件/ ,/ 从而/ 最大/ 和/ 平均/ 发包/ 数/ 越来越少/ ./ 而/ SENS/ -/ Join/ 算法/ 中/ ,/ 随着/ 相对湿度/ 差/ τ/ 越来越/ 大/ ,/ 连接/ 条件/ 越来越/ 宽松/ ,/ 第/ 1/ 次/ 收集/ 的/ 连接/ 属性/ 值中/ 满足/ 连接/ 条件/ 的/ 节点/ 数/ 增多/ ,/ 导致/ 第/ 2/ 次/ 收集/ 得分/ 属性/ 值/ 数据/ 时/ ,/ 有/ 大量/ 节点/ 需要/ 发送数据/ ,/ 从而/ 最大/ 和/ 平均/ 发包/ 数/ 增多/ ./ 如图/ 7/ (/ e/ )/ 和/ (/ f/ )/ 所示/ ,/ 随着/ top/ -/ k/ 增加/ ,/ 用户/ 所/ 很大/ 时/ ,/ 每个/ 时间/ 片内/ 需要/ 发送数据/ 的/ 节点/ 数/ 减少/ ,/ 但/ 自己/ 无/ 数据/ 发送/ 而/ 需要/ 中继/ 转发/ 其它/ 节点/ 数据/ 的/ 节点/ 增多/ ,/ 导致/ 最大/ 和/ 平均/ 发包/ 数/ 趋于/ 平缓/ ./ 需/ 连接/ 结果/ 也/ 越/ 多/ ,/ 若/ 要求/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 满足/ 停止/ 条件/ ,/ 需要/ 时间/ 片数/ 也/ 越/ 大/ ,/ 导致/ 最大/ 和/ 平均/ 发包/ 数/ 增多/ ./ 但是/ ,/ 一般/ 情况/ 下/ ,/ CTJQ/ 、/ OCTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 明显/ 好于/ SENS/ -/ Join/ 算法/ ./ 总之/ ,/ 在/ 4/ 个/ 对比/ 算法/ 中/ ,/ 随着/ 各/ 参数/ 变化/ ,/ 一般/ CTJQ/ 和/ OCTJQ/ 算法/ 最大/ 和/ 平均/ 发包/ 数/ 最少/ ,/ DTJQ/ -/ 3/ 算法/ 次之/ ,/ SENS/ -/ Join/ 算法/ 最大/ 和/ 平均/ 发包/ 数最多/ ./ 5.2/ 实验/ 场景/ 2/ 各/ 算法/ 性能/ 分析/ 场景/ (/ Scenario/ )/ 2/ 中/ 88/ 个/ 节点/ 根据/ 数据/ 集/ LUCE/ 中/ 位置/ 信息/ 构成/ 网络/ ,/ 基站/ 位于/ 网络/ 区域/ 的/ 中心/ ./ 假设/ 最大/ 门限/ 得分/ 属性/ 值/ MaxThresholdScore/ =/ 100/ (/ 该值/ 满足/ 选择/ 门限/ 得分/ 属性/ 值/ MaxThresholdScore/ 式/ (/ 1/ )/ 条件/ )/ ,/ 并且/ 在/ 真实/ 数据/ 集/ LUCE/ 中/ 设定/ 有/ 1/ %/ 节点/ 的/ 环境温度/ (/ 得分/ 属性/ )/ 值/ 大于/ 等于/ MaxThresholdScore/ ./ 如图/ 8/ (/ a/ )/ 和/ (/ b/ )/ 所示/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ 随着/ 时间/ 片/ M/ 变化/ ,/ OCTJQ/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ SENS/ -/ Join/ 、/ CTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 少/ ./ 如图/ 8/ (/ c/ )/ 和/ (/ d/ )/ 所示/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ 随着/ 连接/ 条件/ 相对湿度/ 差/ τ/ 增大/ ,/ 开始/ 时/ ,/ OCTJQ/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ CTJQ/ 算法/ 少/ ./ 随着/ 相对湿度/ 差/ τ/ 变得/ 很大/ ,/ OCTJQ/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数/ 反而/ 可/ Page12/ 能比/ CTJQ/ 算法/ 多/ ./ 这/ 是因为/ 相对湿度/ 差/ τ/ 变得/ 很大/ 时/ ,/ 意味着/ 连接/ 条件/ 变得/ 很/ 宽松/ ,/ 满足/ 连接/ 条件/ 的/ 节点/ 数/ 也/ 很多/ ./ 而/ OCTJQ/ 算法/ 中/ ,/ 基站/ 收到/ 大于/ 等于/ 最大/ 得分/ 属性/ 值/ MaxThresholdScore/ 的/ 元组/ 后/ ,/ 将/ 其/ 对应/ 连接/ 属性/ 值下/ 发给/ 网络/ ,/ 因/ 连接/ 条件/ 变得/ 很/ 宽松/ ,/ 匹配/ 元组/ 数/ 非常/ 多/ ,/ 导致/ 需要/ 上报/ 的/ 节点/ 数图/ 8/ 实验/ 场景/ 2/ 各/ 算法/ 性能/ 比较/ 5.3/ 实验/ 场景/ 3/ 各/ 算法/ 性能/ 分析/ 场景/ (/ Scenario/ )/ 3/ 如图/ 9/ 所示/ ,/ 88/ 个/ 节点/ 根据/ 数据/ 集/ LUCE/ 中/ 的/ 位置/ 信息/ 构成/ 一个/ 子/ 网络/ ,/ 由/ 4/ 个子/ 网络/ 等/ 比例/ 无缝/ 拼接/ 成/ 一个/ 大/ 网络/ ./ 基站/ 位于/ 大/ 网络/ 左上方/ 起始/ 点/ 位置/ ,/ 即/ location/ (/ x/ ,/ y/ )/ =/ (/ 0/ ,/ 0/ )/ ./ 只有/ 右下方/ 子/ 网络/ 4/ 采集/ 数据/ ,/ 基站/ 要求/ 获得/ 子/ 网络/ 4/ 内/ top/ -/ k/ 的/ 连接/ 结果/ ./ 子/ 网络/ 1/ ,/ 2/ 和/ 3/ 虽然/ 不/ 采集/ 数据/ ,/ 但/ 能/ 中继/ 传输/ 子/ 网络/ 4/ 中/ 节点/ 的/ 数据/ 给/ 基站/ ./ DTJQ/ -/ 3/ 表示/ 网络/ 中/ 均匀/ 地/ 选择/ 3/ 个/ 中心/ 节点/ 的/ DTJQ/ 算法/ ./ 因为/ 数据/ 集中/ 没有/ 超出/ 最大/ 门限/ 得分/ 属性/ 值/ MaxThresholdScore/ 的/ 数据/ ,/ 所以/ CTJQ/ 和/ OCTJQ/ 性能/ 一样/ ./ 也/ 很多/ ./ 所以/ ,/ 在/ 这种/ 情况/ 下/ ,/ 有/ 大量/ 节点/ 上报/ ,/ OCTJQ/ 算法/ 反而/ 可能/ 不如/ CTJQ/ 算法/ ./ 如图/ 8/ (/ e/ )/ 和/ (/ f/ )/ 所示/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ 随着/ top/ -/ k/ 变化/ ,/ OCTJQ/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ SENS/ -/ Join/ 、/ CTJQ/ 和/ DTJQ/ -/ 3/ 算法/ 少/ ./ 如图/ 10/ (/ a/ )/ 和/ (/ b/ )/ 所示/ ./ 在/ 默认/ 参数/ 情况/ 下/ ,/ 随着/ 时间/ 片/ M/ 的/ 变化/ ,/ DTJQ/ -/ 3/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ SENS/ -/ Join/ 、/ CTJQ/ 和/ OCTJQ/ 算法/ 少/ ./ 如图/ 10/ (/ c/ )/ 和/ (/ d/ )/ 所示/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ 开始/ 时/ ,/ 连接/ 条件/ 相对湿度/ 差/ τ/ 很小/ ,/ DTJQ/ -/ 3/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ SENS/ -/ Join/ 、/ CTJQ/ 和/ OCTJQ/ 算法/ 少/ ./ 即使/ 当/ 相对湿度/ 差/ τ/ =/ 0/ 时/ ,/ DTJQ/ -/ 3/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数/ 也/ 比/ SENS/ -/ Join/ 少/ ,/ 这/ 是因为/ DTJQ/ -/ 3/ 算法/ 计算/ top/ -/ k/ 连接/ 结果/ 是/ 在/ 查询/ 区域/ 内/ 进行/ ,/ 即使/ 连接/ 条件/ 很/ 紧/ ,/ 符合/ 连接/ 结果/ 的/ 匹配/ 元组/ 对/ 很少/ ,/ DTJQ/ -/ 3/ 算法/ 各/ 中心/ 节点/ 之间/ 交换/ 元组/ 数/ 也/ 有限/ ,/ 不会/ 出现/ 大量/ 元组/ 交换/ ./ 随着/ 相对湿度/ 差/ τ/ 变/ 大/ ,/ DTJQ/ -/ 3/ 算法/ 中/ 最大/ 和/ 平均/ 发包/ 数/ 趋于/ 平缓/ ./ 当/ 相对湿度/ 差/ τ/ 变得/ 很大/ 时/ ,/ 意味着/ 连接/ 条件/ 变得/ 很/ 宽松/ ,/ 满足/ 连接/ 条件/ 的/ 节点/ 数/ 也/ 变得/ 很多/ ,/ 这时/ CTJQ/ 算法/ 能/ 在/ 靠/ 前/ 时间/ 片内/ 获得/ 正确/ 的/ 连接/ 结果/ ./ 所以/ ,/ DTJQ/ -/ 3/ 算法/ 最大/ 发包/ 数/ 可能/ 多于/ CTJQ/ 算法/ ,/ 而/ 平均/ 发包/ 数/ DTJQ/ -/ 3/ 算法/ 依然/ 少于/ CTJQ/ 算法/ ./ 如图/ 10/ (/ e/ )/ 和/ (/ f/ )/ 所示/ ./ 随着/ top/ -/ k/ 变化/ ,/ DTJQ/ -/ 3/ 算法/ 最大/ 和/ 平均/ 发包/ 数都/ 比/ SENS/ -/ Join/ 、/ CTJQ/ 和/ OCTJQ/ 算法/ 少/ ./ Page13/ 图/ 10/ 实验/ 场景/ 3/ 各/ 算法/ 性能/ 比较/ 总之/ ,/ 在/ 默认/ 参数/ 情况/ 下/ ,/ DTJQ/ -/ 3/ 算法/ 平均/ 发包/ 数比/ CTJQ/ 算法/ 少/ 35/ %/ 左右/ ./ 实验/ 结果表明/ ,/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ 更/ 适用/ 于/ 查询/ 区域/ 为/ 网络/ 中子/ 区域/ ,/ 该子/ 区域/ 离/ 基站/ 很远/ 的/ 场合/ ./ 在/ 连接/ 条件/ 很紧/ 的/ 情况/ 下/ ,/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ 性能/ 更好/ ./ 6/ 总结/ 在/ 无线/ 传感器/ 网络/ 中/ ,/ 为了/ 找到/ 组合/ 得分/ 最大/ (/ 或/ 最小/ )/ 的/ k/ 个/ 相似/ 网络/ 环境/ ,/ 我们/ 提出/ 了/ 基本/ top/ -/ k/ 连接/ 算法/ BTJQ/ 、/ 集中式/ top/ -/ k/ 连接/ 算法/ CTJQ/ 、/ 优化/ 的/ 集中式/ top/ -/ k/ 连接/ 算法/ OCTJQ/ 和/ 分布式/ top/ -/ k/ 连接/ 算法/ DTJQ/ ./ 这些/ 算法/ 的/ 目标/ 是/ 减少/ 数据包/ 发送量/ ,/ 减少/ 节点/ 能量消耗/ ,/ 延长/ 网络/ 生命周期/ ./ 实验/ 结果表明/ ,/ 本文/ 所提/ 算法/ 好于/ 经典/ 连接/ 算法/ SENS/ -/ Join/ ./ 下/ 一步/ ,/ 我们/ 计划/ 在/ 复合/ 连接/ 条件/ 下/ 实现/ top/ -/ k/ 连接/ ,/ 并/ 进一步/ 减少/ 数据包/ 发送量/ ./ 

