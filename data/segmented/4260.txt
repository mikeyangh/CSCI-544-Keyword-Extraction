Page1/ 对/ 全轮/ 3D/ 分组/ 密码/ 算法/ 的/ Biclique/ 攻击/ 陈少/ 真/ 1/ )/ ,/ 2/ )/ 刘佳/ 1/ )/ 1/ )/ (/ 解放军信息工程大学/ 郑州/ 450002/ )/ 2/ )/ (/ 数学/ 工程/ 与/ 先进/ 计算/ 国家/ 重点/ 实验室/ 郑州/ 450002/ )/ 摘要/ 3D/ 算法/ 是/ CANS2008/ 会议/ 上/ 提出/ 的/ 一种/ 代替/ -/ 置换/ 网络/ 型/ 分组/ 密码/ 算法/ ./ 该文/ 通过/ 构造/ 3D/ 算法/ 的/ Biclique/ 结构/ ,/ 提出/ 了/ 对/ 全轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ ./ 该/ 攻击/ 可以/ 扩展/ 为/ 对/ r/ 轮/ 3D/ 算法/ 的/ 一般化/ Biclique/ 攻击/ (/ r/ / 10/ )/ ./ 结果表明/ ,/ Biclique/ 攻击/ 数据/ 复杂度/ 为/ 232/ 个/ 选择/ 密文/ ,/ 在/ 时间/ 复杂度/ 上/ 优于/ 穷举/ ./ 关键词/ 分组/ 密码/ ;/ Biclique/ 攻击/ ;/ 3D/ 算法/ ;/ 密码学/ ;/ 网络安全/ ;/ 信息安全/ 1/ 引言/ 3D/ 算法/ [/ 1/ ]/ 是/ Nakahara/ 在/ CANS2008/ 会议/ 上/ 提出/ 的/ 一种/ 新/ 的/ SPN/ 型/ 分组/ 密码/ 算法/ ,/ 其/ 分组/ 和/ 密钥/ 长度/ 均/ 为/ 512/ 比特/ ,/ 建议/ 轮数/ 为/ 22/ 轮/ ./ 这种/ 分组/ 长度/ 不仅/ 适合/ 大/ 数据量/ 加密/ ,/ 也/ 非常适合/ 用于/ 一些/ hash/ 函数/ 、/ 序列密码/ 及/ 伪/ 随机数/ 生成器/ 的/ 组件/ ,/ 因为/ 它们/ 的/ 安全性/ 依赖于/ 内部/ 状态/ 的/ 长度/ ./ 因此/ ,/ 3D/ 算法/ 的/ 安全性/ 值得/ 重点/ 关注/ ./ Biclique/ 攻击/ 是/ Bogdanov/ 等/ 人/ [/ 2/ -/ 5/ ]/ 在/ ASIA/ -/ CRYPT2011/ 上/ 提出/ 的/ 一种/ 新/ 的/ 分析方法/ ,/ 目前/ 它/ Page2/ 攻击/ 方法/ 轮数/ 数据/ 时间/ 文献/ Multiset529CP219/ ./ 5/ [/ 1/ ]/ Multiset62129CP2139/ [/ 1/ ]/ 积分/ 攻击/ 积分/ 攻击/ 积分/ 攻击/ 积分/ 攻击/ 不/ 可能/ 差分/ 6236CP265/ ./ 5/ [/ 1/ ]/ 不/ 可能/ 差分/ 62120.5/ CP2104/ ./ 5/ [/ 7/ ]/ 不/ 可能/ 差分/ 72126CP252/ [/ 7/ ]/ 不/ 可能/ 差分/ 82317CP2345/ [/ 7/ ]/ 不/ 可能/ 差分/ 92445CP2473/ [/ 7/ ]/ 不/ 可能/ 差分/ 102501CP2401/ [/ 8/ ]/ 中间/ 相遇/ 102128CP2331/ ./ 1/ [/ 9/ ]/ 截断/ 差分/ 112251CP2288/ [/ 10/ ]/ 截断/ 差分/ 132469CP2308/ [/ 10/ ]/ Polynomial/ -/ Advantagel2512Biclique22232CC2511/ ./ 5/ 本文/ Bicliquer/ (/ r/ / 10/ )/ 232CC2512/ +/ lg21/ -/ 485Biclique10232CC2510/ ./ 7/ 本文/ 注/ :/ Polynomial/ -/ Advantage/ 攻击/ 成功/ 概率/ 为/ 0.63/ ./ 23D/ 算法/ [/ 1/ ]/ 3D/ 算法/ 面向/ 字节/ ,/ 分组/ 长度/ 和/ 密钥/ 长度/ 均/ 为/ 512/ 比特/ ,/ 其/ 状态/ 表示/ 为/ 3/ 维/ 立方体/ 形式/ ,/ 如图/ 1/ 所示/ ./ 其/ 矩阵/ 表示/ 如下/ :/ S/ =/ r/ 轮/ 3D/ 算法/ 中/ ,/ 第/ i/ 轮/ (/ 0/ / i/ / r/ -/ 2/ )/ 的/ 轮/ 变换/ 为/ 最后/ 一轮/ 的/ 轮/ 变换/ 中/ π/ 由/ κ/ r/ 代替/ ,/ 表示/ 为/ η/ r/ -/ 1/ (/ X/ )/ =/ κ/ r/ / θ/ (/ r/ -/ 1/ )/ mod2/ +/ 1/ / γ/ / κ/ r/ -/ 1/ (/ X/ )/ ./ κ/ i/ :/ 轮/ 密钥/ 与/ 第/ i/ 轮/ 状态/ 进行/ 异或/ 运算/ ./ 轮/ 密钥/ 由密钥/ 扩展/ 算法/ 得到/ ./ γ/ :/ 非线性/ 变换/ ,/ 将/ AES/ [/ 12/ ]/ 的/ S/ 盒/ 应用/ 于/ 状态/ 的/ 每个/ 字节/ ./ θ/ 1/ ,/ θ/ 2/ :/ 行/ 移位/ 变换/ ,/ 在/ 轮/ 变换/ 中/ 交替/ 使用/ ./ θ/ 1/ 将/ 状态/ S/ 变换/ 为/ S1/ ,/ θ/ 2/ 将/ 状态/ S/ 变换/ 为/ S2/ ,/ 其中/ S1/ ,/ S2/ 表示/ 如下/ :/ S1/ =/ S2/ =/ π/ :/ 列/ 混合/ 变换/ ./ 将/ Anubis/ 算法/ [/ 13/ ]/ 中/ 4/ ×/ 4/ 的/ MDS/ 对合/ 矩阵/ 应用/ 于/ 各层/ 中/ 的/ 各列/ ./ 该/ 矩阵/ 的/ 分支/ 数为/ 5/ ./ π/ 与/ θ/ 1/ ,/ θ/ 2/ 结合/ ,/ 构成/ 3D/ 算法/ 的/ 扩散/ 层/ ,/ 用/ 3/ 轮/ 实现/ 完全/ 扩散/ ./ 设/ 输入/ 为/ (/ a0/ ,/ a1/ ,/ …/ ,/ a15/ )/ ,/ 输出/ 为/ (/ b0/ ,/ b1/ ,/ …/ ,/ b15/ )/ ,/ 对/ 一层/ 进行/ π/ 变换/ 的/ 例子/ 是/ 01x02x04x06x/ 烄/ 02x01x06x04x04x06x01x02x06x04x02x01/ 烆/ r/ 轮/ 3D/ 算法/ ,/ 需要/ r/ +/ 1/ 个/ 轮/ 密钥/ ,/ 每个/ 轮/ 密钥/ 为/ 512/ 比特/ ./ 设/ 512/ 比特/ 的/ 主/ 密钥/ 为/ K/ =/ (/ k0/ ,/ k1/ ,/ …/ ,/ k63/ )/ ,/ ki/ (/ 0/ / i/ / 63/ )/ 为/ 字节/ ./ 其/ 密钥/ 扩展/ 算法/ 为/ Page3Ki/ =/ π/ / θ/ imod2/ +/ 1/ / γ/ / κ/ / (/ Ki/ -/ 1/ )/ ,/ i/ / 1/ ./ 部分/ 字节/ ./ κ/ / :/ 上/ 一个/ 轮/ 密钥/ 与/ 4/ ×/ 4/ ×/ 4/ 的/ 常数/ 矩阵/ 进行/ 异或/ 运算/ ./ 该/ 常数/ 矩阵/ 由/ 总/ 轮数/ r/ 决定/ ./ γ/ :/ 非线性/ 变换/ ,/ 将/ AES/ 的/ S/ 盒/ 应用/ 于/ 状态/ 的/ S/ [/ a0/ ]/ a4a8a12/ 烄/ S/ [/ a1/ ]/ a5a9a13S/ [/ a2/ ]/ a6a10a14S/ [/ a3/ ]/ a7a11a15/ 烆/ a32a36S/ [/ a40/ ]/ a44a33a37S/ [/ a41/ ]/ a45a34a38S/ [/ a42/ ]/ a46a35a39S/ [/ a43/ ]/ a47/ θ/ 1/ ,/ θ/ 2/ ,/ π/ 与/ 轮/ 变换/ 中/ 相同/ ./ 3Biclique/ 攻击/ [/ 2/ ]/ 3.1/ Biclique/ 结构/ 设/ 常数/ d/ >/ 0/ ,/ f/ 在/ 密钥/ K/ 的/ 作用/ 下/ 将/ 中间状态/ S/ 映射/ 为/ 密文/ C/ =/ fK/ (/ S/ )/ ./ 若/ 2d/ 个/ 中间状态/ {/ Sj/ }/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ 、/ 2d/ 个/ 密文/ {/ Ci/ }/ i/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ 与/ 22d/ 个/ 密钥/ {/ K/ [/ i/ ,/ j/ ]/ }/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ 满足/ :/ 则/ 称/ {/ {/ Ci/ }/ ,/ {/ Sj/ }/ ,/ {/ K/ [/ i/ ,/ j/ ]/ }/ }/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ 是/ 1/ 个/ d/ 维/ Biclique/ 结构/ ./ 如图/ 2/ 所示/ ./ / i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ :/ Ci/ =/ fK/ [/ i/ ,/ j/ ]/ (/ Sj/ )/ ,/ 3.2/ Independent/ -/ Biclique/ 结构/ 的/ 构造/ 构造/ 1/ 个/ d/ 维/ Biclique/ 结构/ 的/ 直接/ 方法/ 是/ :/ 固定/ 2d/ 个/ 中间状态/ 和/ 2d/ 个/ 密文/ ,/ 然后/ 再/ 任选/ 22d/ 个/ 密钥/ 来/ 验证/ 是否/ 能/ 构成/ Biclique/ 结构/ ./ 该/ 方法/ 至少/ 需要/ 22d/ 次/ f/ 运算/ ./ 文献/ [/ 2/ ]/ 提出/ 了/ 一种/ 利用/ 相关/ 密钥/ 差分/ 构造/ Biclique/ 结构/ 的/ 方法/ ,/ 计算/ 量/ 不/ 超过/ 2d/ +/ 1/ 次/ f/ 运算/ ./ (/ 1/ )/ 基础/ 计算/ :/ 设/ f/ 在/ 密钥/ K/ [/ 0/ ,/ 0/ ]/ 作用/ 下/ 将/ S0/ 映射/ 为/ C0/ :/ (/ 2/ )/ 利用/ 2d/ 个/ “/ Δ/ i/ -/ 差分/ ”/ 与/ 2d/ 个/ “/ / j/ -/ 差分/ ”/ 构造/ 22d/ 个/ “/ (/ Δ/ i/ ,/ / j/ )/ -/ 差分/ ”/ ./ Δ/ i/ -/ 差分/ :/ 该/ 差分/ 路径/ ,/ 使得/ 输入/ 0/ 差分/ 在/ 密钥/ 差分/ Δ/ Ki/ 作用/ 下/ 得到/ 输出/ 差分/ Δ/ i/ ./ 0/ Δ/ K/ / j/ -/ 差分/ :/ 该/ 差分/ 路径/ ,/ 使得/ 输入/ / j/ 差分/ 在/ 密钥/ j/ 作用/ 下/ 得到/ 输出/ 0/ 差分/ ./ 差分/ / K/ / j/ 当/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 没有/ 共用/ 的/ “/ 活动/ 非线性/ 部件/ ”/ 时/ ,/ 用/ 直接/ “/ 异或/ ”/ 的/ 方式/ 组合/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 构成/ “/ (/ Δ/ i/ ,/ / j/ )/ -/ 差分/ ”/ :/ / i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ :/ / j/ (/ 3/ )/ 结合/ S0/ ,/ C0/ ,/ K/ [/ 0/ ,/ 0/ ]/ 与/ (/ Δ/ i/ ,/ / j/ )/ -/ 差分/ 构造/ Biclique/ 结构/ :/ 令若/ 对/ 所有/ 的/ i/ +/ j/ >/ 0/ ,/ 都/ 有/ Δ/ KK/ [/ i/ ,/ j/ ]/ 互不/ 相同/ ./ 这样/ 就/ 得到/ 1/ 个/ d/ 维/ Biclique/ 结构/ ./ 这样/ ,/ 构造/ 1/ 个/ d/ 维/ Biclique/ 结构/ 就/ 简化/ 为/ 计算/ 2d/ 个/ Δ/ i/ 和/ 2d/ 个/ / j/ ,/ 总共/ 不/ 超过/ 2/ ·/ 2d/ 次/ f/ 运算/ ./ 我们/ 称由该/ 方法/ 构造/ 的/ Biclique/ 结构/ 为/ Independent/ -/ Biclique/ 结构/ ./ 注/ :/ 文献/ [/ 2/ ]/ 指出/ ,/ 在/ 构造/ Independent/ -/ Biclique/ 结构/ 时/ ,/ 必须/ 要求/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 没有/ 共用/ 的/ “/ 活动/ 非线性/ 部件/ ”/ ,/ 才能/ 以/ 直接/ “/ 异或/ ”/ 的/ 方式/ 组成/ “/ (/ Δ/ i/ ,/ / j/ )/ -/ 差分/ ”/ ./ 体现/ 在/ 差分/ 路径/ 上/ 就是/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 中/ “/ 活动/ 部件/ ”/ 的/ 位置/ 完全/ 不/ 重合/ ./ 当/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 有/ 共用/ 的/ “/ 活动/ 非线性/ 部件/ ”/ 时/ ,/ 如何/ 构造/ 其它/ 类型/ 的/ Biclique/ 结构/ 并/ 进行/ 攻击/ ,/ 可以/ 参考文献/ [/ 2/ ]/ ./ 3.3/ Independent/ -/ Biclique/ 攻击/ 将/ 分组/ 密码/ 算法/ 记为/ e/ =/ f/ / g/ ,/ 主/ 密钥/ 为/ K/ ,/ 长度/ 记/ 为/ |/ K/ |/ ,/ 则/ 其/ 密钥/ 空间/ 中共/ 有/ 2/ |/ K/ |/ 个/ 密钥/ ./ 选择/ 参数/ d/ :/ 由/ 3.2/ 节/ 可知/ ,/ 构造/ 1/ 个/ d/ 维/ Independent/ -/ Biclique/ 结构/ ,/ 需要/ 先/ 固定/ 22d/ 个/ 具有/ 特定/ 差分/ 模式/ Δ/ Ki/ / / KPage4/ 而定/ ,/ 并且/ 要/ 使得/ 由此/ 构造/ 的/ Δ/ i/ -/ 差分/ 与/ / j/ -/ 差分/ 没有/ 共用/ 的/ “/ 活动/ 非线性/ 部件/ ”/ ./ 因此/ ,/ 根据/ 这种/ 差分/ 模式/ ,/ 将/ 全部/ 2/ |/ K/ |/ 个/ 密钥/ 划分/ 成/ 2/ |/ K/ |/ -/ 2d/ 组/ ,/ 划分/ 时/ 保证/ :/ 每组/ 中/ 的/ 22d/ 个/ 密钥/ 符合/ 这种/ 给定/ 的/ 差分/ 模式/ ,/ 任意/ 两组/ 之间/ 不/ 包含/ 相同/ 的/ 密钥/ ./ (/ 1/ )/ 构造/ d/ 维/ Independent/ -/ Biclique/ 结构/ :/ 对/ 每个/ 密钥/ 组/ {/ K/ [/ i/ ,/ j/ ]/ }/ ,/ 选择/ 2d/ 个/ Sj/ 和/ 2d/ 个/ Ci/ ,/ 满足/ :/ / i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ :/ Sj/ 这样/ 就/ 构成/ 了/ 2/ |/ K/ |/ -/ 2d/ 个/ d/ 维/ Biclique/ 结构/ ./ (/ 2/ )/ 对于/ 每个/ Biclique/ 结构/ ,/ 调用/ Oracle/ 使用/ 秘密/ 密钥/ Ksecret/ 对/ 2d/ 个/ Ci/ 解密/ 得到/ 相应/ 的/ 2d/ 个/ 明文/ Pi/ :/ (/ 3/ )/ 若/ K/ [/ i/ ,/ j/ ]/ 是/ Ksecret/ ,/ 会/ 将/ Sj/ 映射/ 到/ Pi/ ./ 因此/ ,/ 若/ 满足/ 下/ 式/ ,/ 则/ 将/ K/ [/ i/ ,/ j/ ]/ 作为/ 候选/ 密钥/ :/ / i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 2d/ -/ 1/ }/ :/ Pi4/ 对/ 全轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ 本节/ 将/ 针对/ 3D/ 算法/ 的/ 结构/ 特点/ ,/ 构造/ 3D/ 算法/ 的/ Independent/ -/ Biclique/ 结构/ ,/ 提出/ 对/ 全轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ ./ 4.1/ 攻击/ 过程/ 准备/ 工作/ :/ 在/ 22/ 轮/ 3D/ 算法/ 中/ (/ 轮数/ 标号/ 为/ 从/ 0/ ~/ 21/ )/ ,/ 将/ 第/ 0/ 轮/ γ/ 变换/ 前/ 状态/ 标记/ 为/ #/ 1/ ,/ π/ 变换/ 后/ 状态/ 标记/ 为/ #/ 2/ ,/ 第/ 0/ 轮/ 的/ 轮/ 密钥/ 标记/ 为/ $/ 0/ ,/ 依此类推/ ,/ 第/ 21/ 轮/ γ/ 变换/ 前/ 的/ 状态/ 标记/ 为/ #/ 43/ ,/ θ/ 2/ 变换/ 后/ 的/ 状态/ 标记/ 为/ #/ 44/ (/ 最后/ 1/ 轮/ 的/ π/ 由/ κ/ 22/ 代替/ )/ ,/ 第/ 21/ 轮/ 的/ 第/ 1/ 个/ 轮/ 密钥/ 标记/ 为/ $/ 21/ ,/ 第/ 2/ 个/ 轮/ 密钥/ 标记/ 为/ $/ 22/ ./ 将/ 算法/ 分解/ 如下/ :/ 0/ ~/ 15/ 轮/ 16/ ~/ 19/ 轮/ 20/ ~/ 21/ 轮/ 第/ 1/ 步/ ./ 划分/ 密钥/ 空间/ ./ 由于/ $/ 21/ 与/ 主/ 密钥/ 是/ 一一对应/ 的/ 关系/ ,/ 因此/ 划分/ $/ 21/ 的/ 密钥/ 空间/ 等价/ 于/ 划分/ 主/ 密钥/ 的/ 密钥/ 空间/ ./ 对/ $/ 21/ 的/ 密钥/ 空间/ 进行/ 划分/ 的/ 方法/ 如下/ :/ 在/ 密钥/ 空间/ 中任取/ 216/ 个/ 满足/ 如下/ 条件/ (/ 1/ )/ (/ 2/ )/ 的/ 密钥/ {/ K/ [/ i/ ,/ j/ ]/ }/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 216/ -/ 1/ }/ :/ (/ 1/ )/ “/ 基础/ 密钥/ ”/ K/ [/ 0/ ,/ 0/ ]/ 在/ 第/ 44/ 、/ 56/ 字节/ 固定/ 取/ 0/ ,/ 其它/ 位置/ 任意/ 取值/ ./ (/ 2/ )/ K/ [/ i/ ,/ j/ ]/ 与/ K/ [/ 0/ ,/ 0/ ]/ 在/ 第/ 44/ 、/ 56/ 字节/ 的/ 差分/ 分别/ 为/ i/ 和/ j/ ,/ 其它/ 位置/ 差/ 分为/ 0.2496/ 组/ ,/ 每组/ 216/ 个/ 密钥/ ./ 根据/ K/ [/ 0/ ,/ 0/ ]/ 的/ 取值/ ,/ 全部/ 2512/ 个/ 密钥/ 被/ 划分/ 成/ 第/ 2/ 步/ ./ 对/ 每个/ 密钥/ 组/ {/ K/ [/ i/ ,/ j/ ]/ }/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 216/ -/ 1/ }/ ,/ 固定/ C0/ =/ 0/ 并/ 计算/ S0/ =/ f/ -/ 1/ 构造/ 相应/ 的/ Independent/ -/ Biclique/ 结构/ ./ 密钥/ 差分/ Δ/ K/ 由于/ 任意/ 一个/ Δ/ i/ -/ 差分/ 与/ 任意/ 一个/ / j/ -/ 差分/ 在/ 差分/ 路径/ 中/ 都/ 没有/ 共用/ 的/ 活动/ 非线性/ 部件/ 且/ Δ/ K/ 因此/ {/ {/ Ci/ }/ ,/ {/ Sj/ }/ ,/ {/ K/ [/ i/ ,/ j/ ]/ }/ }/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ 构成/ 了/ 2/ 轮/ 8/ 维/ Independent/ -/ Biclique/ 结构/ ./ 如图/ 3/ 所示/ ./ 由于/ Δ/ i/ -/ 差分/ 只/ 影响/ 密文/ 4/ 个/ 字节/ ,/ 因此/ 数据/ 复杂度/ 为/ (/ 28/ )/ 4/ =/ 232/ 个/ 选择/ 密文/ ./ 第/ 3/ 步/ ./ 将/ Biclique/ 结构/ 置于/ 最后/ 2/ 轮/ ,/ 与/ 前/ 20/ 轮/ 进行/ 匹配/ 计算/ ,/ 筛选/ 出/ 可以/ 将/ Pi/ 映射/ 为/ Sj/ 的/ 密钥/ K/ [/ i/ ,/ j/ ]/ ./ 这里/ 采用/ 中间/ 相遇/ 的/ 思想/ 筛选/ 密钥/ ,/ 同时/ 利用/ 预计/ 算/ 减少/ 中间/ 相遇/ 攻击/ 的/ 计算/ 量/ ./ 如图/ 4/ 和/ 图/ 5/ 所示/ ./ (/ 1/ )/ 预计/ 算/ ./ 对/ i/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 明文/ Pi/ 在/ 密钥/ K/ [/ i/ ,/ 0/ ]/ 作用/ 下/ 得到/ 状态/ #/ 32/ 的/ 第/ 4/ 字节/ 珗/ vi/ ,/ 共/ 28/ 次/ g1/ 运算/ ./ 对/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 中间状态/ Sj/ 在/ 密钥/ K/ [/ 0/ ,/ j/ ]/ 作用/ 下/ 得到/ 状态/ #/ 32/ 的/ 第/ 4/ 字节/ 珖/ vj/ ,/ 共/ 28/ 次/ g/ -/ 12/ 运算/ ./ 存储/ 运算/ 时/ 的/ 中间/ 数据/ ./ 珖/ vj/ (/ 2/ )/ 反向/ 计算/ ./ 对/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 中间状态/ Sj/ 在/ 密钥/ K/ [/ i/ ,/ j/ ]/ 作用/ 下/ 计算/ 状态/ #/ 32/ 的/ 第/ 4/ 字节/ 珖/ vi/ ,/ j/ ./ 图/ 4/ 中/ 的/ 非/ 空白/ 字节/ 反映/ 了珖/ vi/ ,/ j/ 与/ 预计/ 算珖/ vjPage5/ 于/ 受到/ K/ [/ i/ ,/ j/ ]/ 与/ K/ [/ 0/ ,/ j/ ]/ 之间/ 的/ 密钥/ 差分/ Δ/ K/ 响/ 而/ 产生/ 的/ ./ 为/ 计算/ 珖/ vi/ ,/ j/ ,/ 需要/ 从/ Sj/ 开始/ 反向/ 计算/ 与珖/ vi/ ,/ j/ 有关/ 的/ 字节/ ./ 在/ 这些/ 字节/ 中/ ,/ 部分/ 与/ 预计/ 算中/ 的/ 值/ 相同/ ./ 但/ 对于/ 与/ 预计/ 算中/ 的/ 值/ 不同/ 的/ 部分/ (/ 图/ 4/ 中用/ 阴影/ 表示/ )/ ,/ 需要/ 重新/ 计算/ ./ 在/ 需要/ 重新/ 计算/ 的/ 字节/ 中/ ,/ 一部分/ 由/ 线性变换/ 得到/ ,/ 另/ 一部分/ 需要/ 通过/ 计算/ S/ 盒/ 得到/ (/ 图/ 4/ 中用/ 加粗/ 黑框/ 表示/ )/ ./ 密钥/ 扩展/ 中/ 需要/ 计算/ 13/ 个/ S/ 盒/ ,/ 轮/ 变换/ 中/ 需要/ 计算/ 37/ 个/ S/ 盒/ ,/ 共/ 50/ 个/ ./ (/ 3/ )/ 正向/ 计算/ ./ 对/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 明文/ Pi/ 在/ 密钥/ K/ [/ i/ ,/ j/ ]/ 作用/ 下/ 计算/ 状态/ #/ 32/ 的/ 第/ 4/ 字节/ 珗/ vi/ ,/ j/ ./ 类似/ 地/ ,/ 图/ 5/ 中/ 的/ 非/ 空白/ 字节/ 反映/ 了/ Pi/ 珗/ vi/ ,/ j/ 与/ Pi/ 受到/ K/ [/ i/ ,/ j/ ]/ 和/ K/ [/ i/ ,/ 0/ ]/ 之间/ 的/ 密钥/ 差分/ / K/ 而/ 产生/ 的/ ./ 为/ 计算/ 珗/ vi/ ,/ j/ ,/ 需要/ 从/ Pi/ 开始/ 正向/ 计算/ 与/ 珗/ vi/ ,/ j/ 有关/ 在/ 这些/ 字节/ 中/ ,/ 需要/ 重新/ 计算/ 与/ 预计/ 算中/ 的/ 值/ 的/ 字节/ ./ 不同/ 的/ 部分/ (/ 图/ 5/ 中用/ 阴影/ 表示/ )/ ./ 在/ 需要/ 重新/ 计算/ 的/ 字节/ 中/ ,/ 一部分/ 由/ 线性变换/ 得到/ ,/ 另/ 一部分/ 需要/ 通过/ 计算/ S/ 盒/ 得到/ (/ 图/ 5/ 中用/ 加粗/ 黑框/ 表示/ )/ ./ 在/ 密钥/ 扩展/ 中/ ,/ 由/ 已知/ 的/ $/ 21/ 开始/ ,/ 计算/ $/ 20/ 需要/ 1/ 个/ S/ 盒/ ,/ $/ 19/ 需要/ 4/ 个/ S/ 盒/ ,/ $/ 18/ 到/ $/ 0/ 各/ 需要/ 16/ 个/ S/ 盒/ ,/ 共/ 1/ +/ 4/ +/ 16/ ·/ 19/ =/ 309/ 个/ S/ 盒/ ;/ 在/ 轮/ 变换/ 中/ ,/ 从/ #/ 1/ 开始/ 正向/ 计算/ #/ 32/ 的/ 第/ 4/ 字节/ ,/ 第/ 0/ 轮到/ 第/ 13/ 轮/ 各/ 需要/ 64/ 个/ S/ 盒/ ,/ 第/ 14/ 轮/ 需要/ 16/ 个/ S/ 盒/ ,/ 第/ 15/ 轮/ 需要/ 4/ 个/ S/ 盒/ ,/ 共/ 64/ ·/ 14/ +/ 16/ +/ 4/ =/ 916/ 个/ S/ 盒/ ./ 正向/ 计算/ 共需/ 计算/ 1225/ 个/ S/ 盒/ ./ (/ 4/ )/ 若/ 珗/ vi/ ,/ j/ =/ 珖/ vi/ ,/ j/ ,/ 则/ 将/ K/ [/ i/ ,/ j/ ]/ 作为/ 候选/ 密钥/ ./ 第/ 4/ 步/ :/ 穷举/ 剩余/ 的/ 候选/ 密钥/ ,/ 得到/ 真正/ 的/ 密钥/ 1/ 个/ Biclique/ 结构/ 中有/ 216/ -/ 8/ =/ 28/ 个/ 候选/ 密钥/ ./ Ksecret/ ./ 4.2/ 时间/ 复杂度/ 攻击/ 共/ 需要/ 构造/ 2496/ 个/ Independent/ -/ Biclique/ 结构/ ./ 对/ 每个/ Independent/ -/ Biclique/ 结构/ ,/ 密钥/ 筛选/ Page6/ 过程/ 由/ 预计/ 算/ 和/ 匹配/ 计算/ 组成/ ./ 构造/ 1/ 个/ Independent/ -/ Biclique/ 结构/ 需要/ 不/ 超过/ 2/ ·/ 28/ =/ 29/ 次/ 的/ f/ 运算/ ,/ 相当于/ 29/ ·/ 2/ // 22/ ≈/ 26/ 次/ 22/ 轮/ 3D/ 加密/ ;/ 预计/ 算/ 需要/ 28/ 次/ g1/ 运算/ 和/ 28/ 次/ g/ -/ 12/ 运算/ ,/ 即/ 28/ 次/ g/ 运算/ ,/ 相当于/ 28/ ·/ 20/ // 22/ ≈/ 28/ 次/ 22/ 轮/ 3D/ 加密/ ;/ 反向/ 与/ 正向/ 计算/ 中/ ,/ 由于/ S/ 盒/ 的/ 计算/ 占/ 主要/ 开销/ ,/ 因此/ 只/ 需/ 考虑/ 需要/ 计算/ 的/ S/ 盒/ 的/ 个数/ ./ 反向/ 与/ 正向/ 计算/ 中共/ 需/ 计算/ 216/ ·/ 1275/ 个/ S/ 盒/ ,/ 相当于/ 216/ ·/ 1275/ // 1760/ =/ 215.5/ 次/ 22/ 轮/ 3D/ 加密/ ;/ 匹配/ 计算/ 后/ 筛选/ 出/ 28/ 个/ 候选/ 密钥/ ,/ 需/ 进一步/ 穷/ 因此/ 时间/ 复杂度/ 为举/ 验证/ ./ 2496/ (/ 26/ +/ 28/ +/ 215.5/ +/ 28/ )/ =/ 2511.5/ 次/ 22/ 轮/ 3D/ 加密/ ./ 5/ 攻击/ 的/ 扩展/ 在/ 本文/ 对/ 全轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ 基础/ 上/ ,/ 本节/ 将/ 攻击/ 一般化/ ,/ 扩展/ 到/ 对/ r/ (/ r/ / 10/ )/ 轮/ 3D/ 算法/ 的/ 攻击/ ./ 5.1/ 攻击/ 过程/ 所示/ ./ 设/ 总/ 轮数/ r/ / 10/ 且/ 为/ 偶数/ ./ 攻击/ 示意图/ 如图/ 6/ (/ 1/ )/ 将/ 第/ 4/ 节/ 构造/ 的/ Independent/ -/ Biclique/ 结构/ 应用/ 于/ r/ 轮/ 3D/ 算法/ 的/ 最后/ 2/ 轮/ ,/ 如图/ 3/ 所示/ (/ 状态/ 标记/ 使用/ 括号/ 中/ 的/ 标记/ )/ ./ 由/ 第/ 4/ 节/ 的/ 分析/ 过程/ 知/ ,/ 时间/ 复杂度/ 由/ 反向/ 和/ 正向/ 计算/ 中/ 需要/ 经过/ 的/ S/ 盒/ 的/ 个数/ 决定/ ./ (/ 2/ )/ 反向/ 计算/ ./ 对/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 中间状态/ Sj/ 在/ 密钥/ K/ [/ i/ ,/ j/ ]/ 作用/ 下/ 计算/ 状态/ #/ 2r/ -/ 12/ 的/ 第/ 4/ 字节/ 珖/ vi/ ,/ j/ ./ 如图/ 4/ 所示/ (/ 状态/ 标记/ 使用/ 括号/ 中/ 的/ 标记/ )/ ./ 在/ 密钥/ 扩展/ 中/ ,/ 由/ 已知/ 的/ $/ r/ -/ 1/ 计算/ $/ r/ -/ 2/ ,/ $/ r/ -/ 3/ ,/ $/ r/ -/ 4/ ,/ $/ r/ -/ 5/ ,/ $/ r/ -/ 6/ ,/ 需要/ 计算/ 13/ 个/ S/ 盒/ ;/ 在/ 轮/ 变换/ 中/ ,/ 从/ #/ 2r/ -/ 3/ 开始/ 反向/ 计算/ #/ 2r/ -/ 12/ 的/ 第/ 4/ 个/ 字节/ ,/ 需要/ 计算/ 37/ 个/ S/ 盒/ ./ 反向/ 计算/ 共需/ 计算/ 50/ 个/ S/ 盒/ ./ (/ 3/ )/ 正向/ 计算/ ./ 对/ i/ ,/ j/ ∈/ {/ 0/ ,/ 1/ ,/ …/ ,/ 28/ -/ 1/ }/ ,/ 由/ 明文/ Pi/ 在/ 密钥/ K/ [/ i/ ,/ j/ ]/ 作用/ 下/ 计算/ 状态/ #/ 2r/ -/ 12/ 的/ 第/ 4/ 字节/ 珗/ vi/ ,/ j/ ./ 如图/ 5/ 所示/ (/ 状态/ 标记/ 使用/ 括号/ 中/ 的/ 标记/ )/ ./ 在/ 密钥/ 扩展/ 中/ ,/ 由/ 已知/ 的/ $/ r/ -/ 1/ 开始/ ,/ 计算/ $/ (/ r/ -/ 2/ )/ 需要/ 1/ 个/ S/ 盒/ ,/ $/ (/ r/ -/ 3/ )/ 需要/ 4/ 个/ S/ 盒/ ,/ $/ (/ r/ -/ 4/ )/ 到/ $/ 0/ 各/ 需要/ 16/ 个/ S/ 盒/ ,/ 共/ 1/ +/ 4/ +/ 16/ (/ r/ -/ 4/ +/ 1/ )/ =/ 16r/ -/ 43/ 个/ S/ 盒/ ;/ 在/ 轮/ 变换/ 中/ ,/ 从/ #/ 1/ 开始/ 正向/ 计算/ #/ 2r/ -/ 12/ 的/ 第/ 4/ 字节/ ,/ 第/ 0/ 轮到/ 第/ r/ -/ 9/ 轮/ 各/ 需要/ 64/ 个/ ,/ 第/ r/ -/ 8/ 轮/ 需要/ 16/ 个/ ,/ 第/ r/ -/ 7/ 轮/ 需要/ 4/ 个/ ,/ 共/ 64/ (/ r/ -/ 9/ +/ 1/ )/ +/ 16/ +/ 4/ =/ 64r/ -/ 492/ 个/ S/ 盒/ ./ 正向/ 计算/ 共需/ 计算/ 80r/ -/ 535/ 个/ S/ 盒/ ./ 5.2/ 攻击/ 复杂度/ 1/ 个/ Biclique/ 结构/ 需要/ 进行/ 216/ 次/ 匹配/ 计算/ ,/ 2496/ 个/ 密钥/ 组/ 构成/ 的/ 2496/ 个/ Independent/ -/ Biclique/ 结构/ ,/ 共/ 需要/ 进行/ 2496/ ·/ 216/ 次/ 匹配/ 计算/ ./ 在/ 1/ 次/ 匹配/ 计算/ 中/ (/ 包括/ 1/ 次/ 反向/ 计算/ 和/ 1/ 次/ 正向/ 计算/ )/ 共需/ 经过/ 50/ +/ (/ 80r/ -/ 535/ )/ =/ 80r/ -/ 485/ 个/ S/ 盒/ ./ 由于/ 3D/ 算法/ 正常/ 加密/ 1/ 轮/ 需要/ 计算/ 80/ 个/ SPage7/ 盒/ ,/ 因此/ ,/ 对/ r/ 轮/ 3D/ 算法/ 的/ Independent/ -/ Biclique/ 攻击/ 的/ 时间/ 复杂度/ 为/ 时间/ 复杂度/ 为/ 2510.7/ ./ 该值/ 随/ r/ 的/ 增加/ 而/ 增加/ ,/ 趋近/ 但/ 始终/ 小于/ 2512/ ,/ 因此/ 会略/ 优于/ 穷举/ ./ 当/ r/ =/ 22/ 时/ ,/ 时间/ 复杂度/ 为/ 2511.5/ ;/ 当/ r/ =/ 10/ 时/ ,/ 数据/ 复杂度/ 由/ Independent/ -/ Biclique/ 结构/ 决定/ ,/ 当/ r/ 为/ 奇数/ 时/ ,/ Independent/ -/ Biclique/ 结构/ 及攻/ 为/ 232/ 个/ 选择/ 密文/ ./ 击/ 过程/ 与/ r/ 为/ 偶数/ 时/ 类似/ ,/ 结论/ 不变/ ./ 6/ 总结/ 本文/ 通过/ 构造/ Independent/ -/ Biclique/ 结构/ ,/ 提出/ 了/ 对/ 全轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ ,/ 时间/ 复杂度/ 略/ 优于/ 穷举/ ;/ 进一步/ ,/ 将/ 攻击/ 一般化/ ,/ 提出/ 对/ r/ (/ r/ / 10/ )/ 轮/ 3D/ 算法/ 的/ Biclique/ 攻击/ ,/ 并/ 给出/ 时间/ 复杂度/ 的/ 公式/ 表示/ ./ 这/ 不仅/ 将/ 对/ 3D/ 算法/ 攻击/ 的/ 轮数/ 扩展/ 到/ 10/ 轮/ 以上/ ,/ 也/ 将/ 是/ 首个/ 对/ 全轮/ 3D/ 算法/ 的/ 理论/ 攻击/ ./ 目前/ 的/ 结果/ 只是/ 理论/ 上/ 的/ 分析/ ,/ 暂/ 不会/ 对/ 3D/ 算法/ 的/ 实际/ 应用/ 产生/ 威胁/ ./ 3D/ 算法/ 具有/ 复杂/ 的/ 密钥/ 扩展/ 算法/ ,/ 这/ 使得/ 很难/ 构造/ 更/ 多/ 轮数/ 的/ Independent/ -/ Biclique/ 结构/ ./ 因此/ 如何/ 构造/ 其它/ 类型/ 的/ Biclique/ 结构/ 改进/ 现有/ 结果/ 以及/ 寻找/ 更/ 有效/ 的/ 方法/ 是/ 今后/ 需要/ 关注/ 的/ 问题/ ./ 

