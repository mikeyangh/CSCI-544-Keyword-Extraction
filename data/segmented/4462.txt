Page1RFID/ 系统/ 密钥/ 无线/ 生成/ 鲁力/ (/ 电子科技/ 大学/ 计算机科学/ 与/ 工程学院/ 成都/ 611731/ )/ 摘要/ 随着/ 无线/ 射频/ 识别/ (/ RadioFrequencyIdentification/ ,/ RFID/ )/ 系统/ 发展/ ,/ 众多/ 安全/ 和/ 隐私/ 的/ 相关/ 应用/ 对/ 隐私/ 保护/ 认证/ (/ Privacy/ -/ PreservingAuthentication/ ,/ PPA/ )/ 技术/ 提出/ 了/ 强烈/ 需求/ ./ 而/ PPA/ 应用/ 的/ 先决条件/ 是/ 合法/ 读写器/ 和/ 标签/ 之间/ 存在/ 共享/ 密钥/ ./ 但/ 由于/ 无线/ 信道/ 的/ 开放性/ ,/ 读写器/ 直接/ 向/ 标签/ 写入/ 的/ 密钥/ 会/ 被/ 敌手/ 轻易/ 窃听/ ;/ 此外/ ,/ RFID/ 标签/ 的/ 计算/ 、/ 存储/ 和/ 通信/ 能力/ 极其/ 有限/ ,/ 导致/ 现有/ 的/ 密钥/ 协商/ 协议/ 不能/ 应用/ 于/ RFID/ 系统/ ;/ 再者/ ,/ 标签/ 生产商/ 在/ 标签/ 出厂/ 时/ 写入/ 的/ 密钥/ 会/ 带来/ 密钥/ 托管/ 问题/ 并且/ 用户/ 不能/ 自定义/ 密钥/ ./ 上述/ 原因/ 导致/ RFID/ 系统/ 中/ 密钥/ 安全/ 生成/ 问题/ 极具/ 挑战性/ ./ 该文/ 创新性/ 地/ 利用/ RFID/ 系统/ 中/ 信道/ 不对称性/ ,/ 提出/ 了/ 一种/ RFID/ 系统/ 密钥/ 无线/ 生成/ 方法/ WiKey/ ./ WiKey/ 是/ 一种/ 轻量级/ 协议/ 可/ 在/ 现有/ 的/ RFID/ 系统/ 中/ 实现/ ./ 通过/ 全面/ 的/ 安全性/ 分析/ ,/ 我们/ 展示/ 了/ WiKey/ 能为/ PPA/ 协议/ 提供/ 强有力/ 的/ 保护/ ;/ 在/ WISP/ 标签/ 上/ 的/ 原型/ 实现/ 以及/ 实际/ 测试表明/ WiKey/ 在/ 现有/ RFID/ 系统/ 中/ 实现/ 的/ 可行性/ 和/ 高效性/ ./ 关键词/ 无线/ 射频/ 识别/ ;/ 密钥/ 生成/ ;/ 隐私/ 保护/ 认证/ ;/ RFID/ ;/ 物/ 联网/ ;/ 密码学/ 1/ 引言/ 由于/ 具有/ 低成本/ 、/ 易/ 部署/ 的/ 特点/ ,/ 无线/ 射频/ 识别/ (/ RadioFrequencyIdentification/ ,/ RFID/ )/ 技术/ 已/ 被/ 广泛应用/ 于/ 物流/ [/ 1/ -/ 2/ ]/ 、/ 仓库/ 管理/ [/ 3/ -/ 4/ ]/ 、/ 访问控制/ [/ 5/ -/ 6/ ]/ 和/ 供应链/ 管理系统/ [/ 7/ -/ 8/ ]/ 等/ 方面/ ./ 最/ 常用/ 的/ 标签/ 为/ 无源/ 被动式/ 标签/ ,/ 只能/ 从/ 读写器/ 信号/ 获得/ 极少/ 能量/ ,/ 并且/ 其/ 计算/ 和/ 存储资源/ 极其/ 有限/ ./ 同时/ ,/ 标签/ 在/ 获得/ 能量/ 后/ 通过/ 反向/ 散射/ 读写器/ 载波/ 以/ 传输/ 信息/ ,/ 因此/ 标签/ 会/ 自动/ 响应/ 所有/ 提供/ 能量/ 的/ 读写器/ 访问/ ./ 这种/ 反向/ 散射/ 模式/ 会/ 暴露/ 标签/ 所/ 储存/ 的/ 信息/ 甚至/ 会/ 暴露/ 读写器/ 敏感/ 的/ 隐私/ 信息/ ./ 为了/ 保护/ 标签/ 隐私/ ,/ 隐私/ 保护/ 认证/ (/ Privacy/ -/ PreservingAuthentication/ ,/ PPA/ )/ 成为/ 目前/ 常用/ 的/ 保护/ 读写器/ 和/ 标签/ 之间/ 交互/ 的/ 安全/ 机制/ ./ PPA/ 的/ 基本/ 思想/ 是/ 在/ 读写器/ 和/ 标签/ 之间/ 利用/ 共享/ 密钥/ 进行/ 认证/ 和/ 识别/ ./ 然而/ ,/ PPA/ 依赖于/ 一个/ 强/ 假设/ :/ 读写器/ 和/ 标签/ 内/ 存在/ 共享/ 密钥/ 用于/ 保护/ 所/ 传输/ 的/ 信息/ ./ 然而/ 在/ RFID/ 标签/ 上/ 安全/ 生成/ 密钥/ 非常/ 具有/ 挑战性/ ./ 首先/ ,/ 如果/ 制造商/ 预置/ 密钥/ 于/ 标签/ 中/ 会/ 造成/ 密钥/ 托管/ 问题/ ①/ ,/ 而/ 用户/ 也/ 不能/ 生成/ 自己/ 信任/ 的/ 密钥/ ;/ 第二/ ,/ 现有/ 被动式/ 无源/ 标签/ 没有/ 物理/ 接口/ (/ 如/ USB/ 等/ )/ 与/ 其它/ 设备/ 连接/ ,/ 因而/ 通过/ 物理/ 连接/ 生成/ 密钥/ 的/ 方法/ 不/ 可行/ ;/ 第三/ ,/ 如果/ 读写器/ 以/ 无线/ 方式/ 直接/ 将/ 密钥/ 写入/ 标签/ ,/ 由于/ 读写器/ 的/ 发射功率/ 较大/ ,/ 使得/ 攻击者/ 可以/ 在/ 远距离/ 通过/ 窃听/ 获得/ 密钥/ ;/ 最后/ ,/ 标签/ 的/ 计算能力/ 非常/ 有限/ ,/ 不能/ 进行/ 复杂/ 的/ 密码学/ 运算/ ,/ 因此/ 现有/ 基于/ 密码学/ 的/ 密钥/ 协商/ 方法/ 均/ 不能/ 在/ 标签/ 上/ 使用/ ./ 本文/ 创新性/ 地/ 提出/ 在/ RFID/ 标签/ 上/ 进行/ 密钥/ 安全/ 无线/ 生成/ 的/ 方法/ (/ WirelessKeyGeneration/ ,/ WiKey/ )/ ./ WiKey/ 的/ 基本/ 思想/ 是/ 利用/ RFID/ 系统/ 前/ 、/ 后/ 向/ 信道/ (/ ForwardChannel/ 和/ BackwardChannel/ [/ 9/ ]/ )/ 的/ 非/ 对称性/ ./ 前向/ 信道/ 指从/ 读写器/ 到/ 标签/ 的/ 信道/ ,/ 而后/ 向/ 信道/ 是从/ 标签/ 到/ 读写器/ 的/ 信道/ ./ 由于/ 读写器/ 的/ 发射功率/ 较大/ ,/ 所以/ 其/ 通信/ 半径/ 较大/ ,/ 敌手/ 可以/ 很/ 容易/ 的/ 监听/ 该/ 信道/ 上/ 的/ 内容/ ./ 而后/ 向/ 信道/ 中/ ,/ 标签/ 采用/ 反向/ 散射/ 方式/ 向/ 读写器/ 发送/ 消息/ ,/ 标签/ 由于/ 自身/ 缺乏/ 电源/ ,/ 不能/ 主动/ 向/ 读写器/ 发送/ 信号/ ,/ 只能/ 反射/ 读写器/ 发出/ 的/ 载波/ ,/ 并/ 通过/ 幅移键控/ (/ AmplitudeShiftKeying/ ,/ ASK/ )/ 调制/ 加载/ 数据/ ./ 而/ 反射/ 信号/ 与/ 读写器/ 发出/ 的/ 载波/ 相比/ 非常/ 微弱/ ,/ 故其/ 通信/ 距离/ 也/ 较/ 短/ ,/ 使得/ 敌手/ 的/ 窃听/ 非常/ 困难/ ./ 我们/ 在/ 第/ 3/ 节中/ 通过/ 理论/ 分析/ 和/ 实验/ 验证/ 了/ 后/ 向/ 信道/ 不可/ 窃听/ 的/ 特点/ ./ WiKey/ 的/ 基本/ 思想/ 是/ 让/ 没有/ 初始/ 密钥/ 的/ 标签/ 向/ 读写器/ 发送/ 密钥/ 碎片/ ,/ 当/ 接收/ 到/ 读写器/ 生成/ 的/ 另/ 一/ 密钥/ 碎片/ 时/ ,/ 标签/ 通过/ 混合/ 这些/ 密钥/ 碎片/ 即可/ 生成/ 共享/ 密钥/ ./ 由于/ 后/ 向/ 信道/ 不可/ 窃听/ ,/ 敌手/ 不能/ 获取/ 标签/ 生成/ 的/ 密钥/ 碎片/ ,/ 即使/ 听到/ 读写器/ 生成/ 的/ 密钥/ 碎片/ 也/ 不能/ 恢复/ 共享/ 密钥/ ,/ 这/ 就/ 实现/ 了/ 读写器/ 和/ 标签/ 间/ 密钥/ 的/ 无线/ 生成/ ./ WiKey/ 针对/ 两种/ 不同/ 需求/ 设计/ 了/ 密钥/ 生成/ 方案/ :/ (/ 1/ )/ 读写器/ 对/ 单个/ 给定/ 标签/ 生成/ 一个/ 唯一/ 的/ 个体/ 密钥/ ;/ (/ 2/ )/ 读写器/ 对/ 一组/ 标签/ 生成/ 一个/ 群组/ 密钥/ ./ 对于/ 个体/ 密钥/ 生成/ ,/ WiKey/ 使用/ 读写器/ 获取/ 给定/ 标签/ 的/ 随机数/ 并/ 与/ 读写器/ 的/ 随机数/ 混合/ ,/ 在/ 标签/ 和/ 读写器/ 上/ 产生/ 共享/ 密钥/ ./ 基于/ 个体/ 密钥/ 生成/ 方案/ ,/ WiKey/ 提出/ 了/ 在/ 一组/ 标签/ 上/ 生成/ 共享/ 群组/ 密钥/ 的/ 方法/ ./ 简单/ 来说/ ,/ 由于/ RFID/ 标签/ 只能/ 与/ 读写器/ 通信/ ,/ WiKey/ 使用/ 读写器/ 作为/ 群组/ 控制者/ 收集/ 组内/ 所有/ 标签/ 产生/ 的/ 密钥/ 碎片/ ,/ 加以/ 混合/ 后/ 对/ 每个/ 标签/ 的/ 密钥/ 碎片/ 产生/ 对应/ 的/ 密钥/ 生成/ 因子/ ,/ 并/ 发送给/ 对应/ 的/ 标签/ ,/ 使之能/ 产生/ 正确/ 的/ 共享/ 密钥/ ./ WiKey/ 具有/ 以下/ 4/ 项/ 优点/ :/ (/ 1/ )/ 密钥/ 无线/ 生成/ ,/ 无需/ 物理/ 接口/ ;/ (/ 2/ )/ 轻量级/ 协议/ ,/ 适用/ 于/ 资源/ 受限/ 的/ RFID/ 标签/ ;/ (/ 3/ )/ 安全/ 的/ 密钥/ 生成/ ,/ 能/ 抵抗/ 主动/ 和/ 被动/ 攻击/ ;/ (/ 4/ )/ 密钥/ 生成/ 可/ 由/ 终端/ 非专业/ 用户/ 执行/ ./ 本文/ 对/ WiKey/ 的/ 安全性/ 进行/ 了/ 分析/ ,/ 并且/ 在/ 实际/ RFID/ 系统/ 中/ 进行/ 了/ 实验/ 以/ 验证/ 其/ 可行性/ ./ 性能/ 评价/ 和/ 理论/ 分析表明/ ,/ WiKey/ 可/ 在/ RFID/ 系统/ 中/ 高效/ 、/ 安全/ 地/ 实现/ 密钥/ 无线/ 生成/ ./ 本文/ 第/ 2/ 节/ 介绍/ 无线/ 系统/ 中/ 密钥/ 生成/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 详细/ 介绍/ RFID/ 系统/ 中/ 信道/ 特点/ 并/ 论证/ 后/ 向/ 信道/ 不可/ 窃听/ 的/ 特性/ ;/ 第/ 4/ 节/ 定义/ RFID/ 系统/ 及/ 针对/ 密钥/ 无线/ 生成/ 的/ 敌手/ 模型/ ;/ 第/ 5/ 节/ 详细描述/ WiKey/ 的/ 具体/ 设计/ ;/ 第/ 6/ 节/ 讨论/ WiKey/ 在/ 实际/ 应用/ 中/ 可能/ 遇到/ 的/ 问题/ ;/ 第/ 7/ 节对/ WiKey/ 的/ 安全性/ 进行/ 详细分析/ ;/ 第/ 8/ 节/ 介绍/ 在/ 实际/ RFID/ 系统/ 上/ 的/ 原型/ 实现/ ;/ 第/ 9/ 节对/ 原型/ 进行/ 系统地/ 评价/ ;/ 第/ 10/ 节/ 总结/ 全文/ ./ 2/ 相关/ 工作/ 前/ 无线/ 设备/ 中/ 进行/ 密钥/ 生成/ 的/ 方法/ 可/ 分为/ 以下/ 两类/ :/ 基于/ 密码学/ 和/ 非/ 密码学/ 方法/ ./ 密码学/ 方法/ :/ 该类/ 方法/ 基于/ 公钥/ 密钥/ 学/ 的/ 密钥/ ①/ KeyEscrow/ ./ http/ :/ // // en/ ./ wikipedia/ ./ org/ // wiki/ // keyescrowPage3/ 协商/ 方法/ ,/ 如/ Diffie/ -/ Hellman/ 密钥/ 协商/ 协议/ [/ 11/ ]/ ./ 虽然/ 该类/ 方法/ 可/ 解决/ 密钥/ 生成/ 问题/ ,/ 但/ 需要/ 进行/ 复杂/ 的/ 计算/ (/ 如/ 大数/ 操作/ )/ ,/ 因而/ 并/ 不适/ 用于/ 资源/ 严重/ 受限/ 的/ RFID/ 标签/ ./ 非/ 密码学/ 方法/ :/ 该类/ 方法/ 不/ 使用/ 密码/ 技术/ ,/ 而是/ 采用/ 物理/ 方法/ 或者/ 基于/ 通信/ 信道/ 的/ 特征/ 来/ 生成/ 密钥/ ,/ 详细描述/ 如下/ ./ 物理/ 方法/ :/ 该/ 方法/ 主要/ 包含/ 两种/ 方法/ :/ 物理/ 隔离/ 和/ 有线/ 连接/ 写入/ ./ 物理/ 隔离/ 利用/ 法拉第/ 笼/ [/ 11/ ]/ 来/ 保护/ 无线/ 设备/ 之间/ 的/ 通信/ 信道/ 不/ 被/ 窃听/ ./ 法拉第/ 笼是/ 一个/ 由/ 金属网/ 构成/ 的/ 用于/ 屏蔽/ 无线/ 信号/ 的/ 容器/ ,/ 笼内/ 的/ 无线/ 信号/ 被/ 法拉第/ 笼/ 屏蔽/ ,/ 因此/ ,/ 法拉第/ 笼内/ 的/ 两个/ 无线/ 设备/ 能以/ 明文/ 进行/ 通信/ ./ 该/ 方法/ 受限于/ 法拉第/ 笼/ 的/ 空间/ ,/ 使得/ 该类/ 方法/ 很难/ 运用/ 于/ RFID/ 的/ 实际/ 应用/ 中/ ./ 例如/ ,/ 法拉第/ 笼/ 无法/ 容纳/ 嵌入/ 在/ 如/ 汽车/ 、/ 集装箱/ 等/ 大型/ 物体/ 里/ 的/ RFID/ 标签/ ./ 另外/ ,/ 终端用户/ 可能/ 不愿/ 在/ 使用/ RFID/ 标签/ 之前/ 建造/ 一个/ 巨大/ 的/ 法拉第/ 笼/ ./ 有线/ 连接/ 写入/ 方法/ [/ 12/ ]/ 中/ ,/ 两个/ 设备/ 需要/ 硬件/ 接口/ 来/ 建立/ 物理/ 电信号/ 连接/ ./ 在/ 该/ 连接/ 中/ ,/ 可/ 进行/ 密钥/ 生成/ 或/ 交换/ ./ 但是/ 由于/ RFID/ 标签/ 没有/ 物理/ 接口/ 来/ 支持/ 这种/ 电路/ 连接/ ,/ 使得/ 这种/ 方法/ 也/ 不适/ 用于/ RFID/ 设备/ ./ 基于/ 信道/ 特征/ :/ 方案/ [/ 13/ ]/ 通过/ 一个/ 匿名信/ 道/ 在/ 两个/ CPU/ 资源/ 受限/ 的/ 无线/ 设备/ 之间/ 建立/ 共享/ 密钥/ ./ 简单/ 而言/ ,/ ID/ 为/ A/ 的/ 设备/ 通过/ 广播/ 一个/ 带有/ 源字/ 段/ 为/ A/ 的/ 随机/ 数据包/ ,/ 以/ 代表/ 发送/ 比特/ 1/ 给/ ID/ 为/ B/ 的/ 设备/ ./ 类似/ 地/ ,/ A/ 通过/ 广播/ 一个/ 带有/ 源字/ 段/ 为/ B/ 的/ 随机/ 包/ ,/ 代表/ 发送/ 秘密/ 比特/ 0/ ./ 由于/ 只有/ B/ 可以/ 识别/ 包/ 真实/ 源头/ 恢复/ 秘密/ 比特/ (/ 若源/ 字/ 段/ 为/ A/ ,/ 则/ 为/ 1/ ;/ 否则/ 为/ 0/ )/ ./ 若/ 数据包/ 的/ 源/ 字/ 段/ 中/ 包含/ A/ 和/ B/ 的/ 概率/ 相同/ ,/ 则/ 窃听/ 者/ 无法/ 确定/ 包是/ 由/ A/ 或/ B/ 发出/ ,/ 从而/ 无法/ 获取/ 秘密/ 比特/ ./ 该/ 方法/ 虽然/ 计算/ 开销/ 较/ 低/ ,/ 但是/ 需要/ 为/ 每/ 一/ 秘密/ 比特/ 产生/ 一个/ 数据包/ ,/ 通信/ 开销/ 较大/ ./ 而且/ ,/ 目前/ 被动式/ 无源/ RFID/ 标签/ 只能/ 反射/ 读写器/ 的/ 信号/ 作为/ 应答/ ,/ 不能/ 产生/ 随机/ 数据包/ ./ 因此/ 读写器/ 方法/ 不适/ 用于/ RFID/ 系统/ ./ 方案/ [/ 14/ -/ 16/ ]/ 通过/ 测量/ 无线/ 信道/ 中/ 的/ 随机变量/ 来/ 产生/ 密钥/ ./ 具体/ 而言/ ,/ 当/ 设备/ A/ 向/ 设备/ B/ 发送/ 数据包/ 时/ ,/ 信号/ 将/ 通过/ 不同/ 的/ 路径/ 被/ 发送/ ,/ 因此/ 信号/ 具有/ 不同/ 的/ 延迟/ 衰减/ ,/ 使得/ B/ 接收/ 到/ 的/ 信号/ 是/ 多路径/ 信号/ 的/ 综合/ ./ 同样/ ,/ B/ 向/ A/ 发送/ 的/ 数据包/ 将/ 沿/ 同样/ 的/ 路径/ 到达/ A/ ./ 由于/ 信道/ 的/ 唯一性/ ,/ 窃听/ 者/ 无法/ 从/ 他/ 所在/ 的/ 位置/ 推断出/ 信道/ 的/ 特征/ 变量/ ./ 因此/ ,/ 这种/ 方法/ 可/ 用于/ 在/ 两个/ 无线/ 设备/ 中/ 生成/ 具有/ 较/ 高/ 熵/ 值/ 的/ 密钥/ ./ 但是/ ,/ 该/ 方法/ 需/ 无线/ 设备/ 自主/ 测量/ 信道/ 随机变量/ (/ 如/ 信号强度/ )/ ,/ 而/ RFID/ 标签/ 并/ 不/ 具备/ 该/ 能力/ ./ 鉴于/ 现有/ 方法/ 的/ 缺点/ ,/ 本文/ 针对/ RFID/ 系统/ 提出/ 了/ 密钥/ 无线/ 生成/ 方法/ WiKey/ ,/ 与/ 现有/ 工作/ 相比/ ,/ WiKey/ 无需/ 额外/ 的/ 硬件/ 接口/ 和/ 复杂/ 的/ 密码/ 算法/ ;/ 同时/ WiKey/ 以/ 无线/ 方式/ 生成/ 密钥/ ./ 由于/ 其/ 轻量级/ 的/ 特点/ ,/ WiKey/ 能/ 在/ 实际/ RFID/ 系统/ 中/ 实现/ ./ 3RFID/ 信道/ 非/ 对称性/ 大多数/ 常用/ 的/ RFID/ 标签/ 为/ 被动式/ 标签/ ,/ 即/ 不能/ 主动/ 向/ 读写器/ 发送/ 电磁波/ ,/ 而/ 只能/ 通过/ 反向/ 散射/ 方式/ 反射/ 来自/ 读写器/ 的/ 电磁波/ 作为/ 应答/ ./ 考虑/ 到/ 电磁波/ 的/ 传播/ 衰减/ 和/ 标签/ 天线/ 的/ 反射系数/ 等/ 原因/ ,/ 标签/ 的/ 反射/ 信号强度/ (/ 后/ 向/ 信道/ )/ 相比/ 读写器/ 发射/ 信号/ 的/ 强度/ (/ 前向/ 信道/ )/ 极为/ 微弱/ ./ 这/ 意味着/ 后/ 向/ 信道/ 的/ 通信/ 距离/ 相比/ 前向/ 信道/ 其/ 通信/ 距离/ 极其/ 有限/ ./ 本节/ 我们/ 将/ 研究/ 前/ 、/ 后/ 向/ 信道/ 的/ 链路/ 预算/ (/ 即/ 计算/ 信号/ 在/ 信道/ 中/ 传播/ 所/ 遇到/ 的/ 所有/ 衰减/ 和/ 增益/ )/ 以/ 揭示/ 这一/ 现象/ 并/ 提出/ 后/ 向/ 信道/ 信息/ 不可/ 窃听/ 的/ 事实/ 观察/ ./ 3.1/ 前向/ 信道/ 链路/ 预算/ 电磁波/ 时/ ,/ 标签/ 天线/ 上/ 所/ 接收/ 到/ 的/ 信号强度/ ./ 设/ PTX/ ,/ reader/ 、/ PRX/ ,/ tag/ 、/ Greader/ 、/ Gtag/ 和/ dfor/ 分别/ 表示/ 读写器/ 发射功率/ 、/ 标签/ 天线/ 接收/ 信号/ 功率/ 、/ 读写器/ 天线/ 增益/ 、/ 标签/ 天线/ 增益/ 和/ 前/ 向/ 信道/ 中/ 标签/ 天线/ 到/ 读写器/ 的/ 距离/ ./ 同时/ ,/ 设/ λ/ 为/ RFID/ 系统/ 中/ 信号/ 的/ 波长/ (/ 目前/ 北美/ 和/ 亚洲地区/ 信号/ 频段/ 为/ 902/ ~/ 928MHz/ )/ ./ 由于/ 读写器/ 和/ 标签/ 在/ 应用/ 中常/ 处于/ 相互间/ 目视/ 范围/ 内/ ,/ 因此/ 电磁波/ 传播/ 服从/ 自由空间/ 模型/ [/ 18/ ]/ ,/ 则/ 有/ 前/ 向/ 信道/ 链路/ 预算/ 即当/ 读写器/ 以/ 固定/ 频率/ 发射/ 3.2/ 后/ 向/ 信道/ 链路/ 预算/ 后/ 向/ 信道/ 链路/ 预算/ 是/ 指/ 接收/ 方/ (/ 如/ 窃听/ 者/ )/ 天线/ 上/ 所能/ 接收/ 到/ 标签/ 反射/ 信号/ 的/ 功率/ 或/ 信号强度/ ./ 在/ 理想/ 环境/ 中/ (/ 理想/ 环境/ 是/ 指/ 在/ 标签/ 和/ 接收者/ 之间/ 不/ 存在/ 与/ 波长/ 在/ 尺寸/ 上/ 可比/ 的/ 障碍物/ )/ ,/ 除了/ 标签/ 的/ 反射系数/ 外/ ,/ 后/ 向/ 信道/ 链路/ 预算/ 与/ 前/ 向/ 信道/ 链路/ 预算/ 相似/ ./ 理论/ 上/ 来说/ 标签/ 反射/ 能量/ 可以/ 达到/ 吸收/ 能量/ 的/ 4/ 倍/ ,/ 但/ 此时/ 标签/ 芯片/ 不能/ 获得/ 足够/ 多/ 的/ 能量/ 用以/ 启动/ 标签/ ./ 因此/ ,/ 标签/ 需要/ 反射/ 一部分/ 入射/ 能量/ 并/ 保留/ 其余/ 能量/ 以/ 启动/ 标签/ 芯片/ ,/ 反射/ 能量/ 占/ 入射/ 总/ 能量/ 的/ 比值/ 即/ 为/ 反射系数/ ./ 在/ 实际/ 被动式/ 标签/ 中/ ,/ 不同/ 的/ 设计/ 导致/ 不同/ 的/ 反射系数/ ,/ 因此/ 反射系数/ 没有/ Page4/ 一个/ 确定/ 值/ ,/ 但是/ 我们/ 可以/ 给出/ 一个/ 近似/ 的/ 估计/ ,/ 即/ 反射/ 信号/ 能量/ 占/ 吸收/ 能量/ 的/ 1/ // 3/ (/ -/ 5dB/ )/ [/ 18/ ]/ ./ 在/ 本文/ 中/ ,/ 记/ 反射系数/ 为/ Tr/ ,/ 则/ 标签/ 反射/ 信号/ 能量/ 为/ PTX/ ,/ tag/ =/ PRX/ ,/ tagTr/ ./ 基于/ 自由空间/ 传播/ 模型/ ,/ 后/ 向/ 信道/ 中/ 链路/ 预算/ 为/ 这里/ PRX/ ,/ adv/ 、/ Gadv/ 和/ dback/ 分别/ 表示/ 窃听/ 者/ 天线/ 所/ 接收/ 的/ 信号强度/ 、/ 窃听/ 者/ 天线/ 增益/ 和/ 窃听/ 者/ 到/ 标签/ 天线/ 的/ 距离/ ./ 在/ 密钥/ 无线/ 生成/ 的/ 场景/ 中/ ,/ 用户/ 可/ 在/ 室内/ 执行/ 密钥/ 生成/ ,/ 因此/ 房间/ 的/ 混凝土/ 墙/ 和/ 地板/ 会/ 进一步/ 衰减/ 窃听/ 者/ 的/ 接收/ 信号强度/ ./ 通常/ ,/ 混凝土/ 墙/ 对/ 900MHz/ 频段/ 电磁波/ 每分/ 米/ 会/ 带来/ 15/ ~/ 20dB/ 衰减/ [/ 19/ ]/ ./ 我们/ 记该/ 衰减/ 为/ χ/ ,/ 则/ 我们/ 可以/ 得到/ 敌手/ 在/ 后/ 向/ 信道/ 上/ 的/ 链路/ 预算/ 如下/ 综合/ 式/ (/ 1/ )/ 、/ (/ 2/ )/ 和/ (/ 3/ )/ ,/ 得到/ 窃听/ 者/ 的/ 接收/ 信号强度/ 为/ PRX/ ,/ advPTX/ ,/ tag/ =/ χ/ TrGreaderGadvG2tag/ λ/ 将式/ (/ 4/ )/ 写为/ dBm/ 形式/ ,/ 可得/ PRX/ ,/ advdBm/ =/ PTX/ ,/ readerdBm/ +/ 10lg/ χ/ +/ 10lgTr/ +/ 由于/ 被动式/ 标签/ 采用/ 偶极/ 天线/ ,/ 故/ 不能/ 确保/ 天线/ 主/ 波束/ 对准/ 读写器/ ,/ 故/ Gtag/ ≈/ 1/ ./ 若/ Gadv/ =/ Greader/ =/ 6dBi/ ,/ 10lg/ χ/ =/ 20dB/ ,/ 10lgTr/ ≈/ -/ 5dB/ ,/ 可将式/ (/ 5/ )/ 简化/ 为/ PRX/ ,/ advdBm/ ≈/ PTX/ ,/ readerdBm/ -/ 20lg/ (/ dfordback/ )/ -/ 72.76/ 式/ (/ 6/ )/ 表明/ 窃听/ 者/ 所/ 接收/ 到/ 的/ 信号强度/ 由/ 3/ 个/ 因子/ 决定/ :/ PTX/ ,/ reader/ 、/ dfor/ 和/ dback/ ./ 举例来说/ ,/ 如果/ 将/ 合法/ 读写器/ 和/ 标签/ 放/ 于/ 一个/ 4m/ ×/ 4m/ 的/ 房间/ 中/ ,/ 标签/ 置于/ 读写器/ 天线/ 2m/ 处/ ,/ 设定/ 读写器/ 发射功率/ PTX/ ,/ reader/ ≈/ 0dBm/ ,/ 则/ 标签/ 反射/ 的/ 电磁波/ 由于/ 传播/ 衰减/ 和/ 反射系数/ 影响/ ,/ 其/ 功率/ 减至/ -/ 35dBm/ ./ 若/ 窃听/ 者/ 距/ 标签/ 为/ 3m/ ,/ 且/ 混凝土/ 墙/ 存在/ 其间/ ,/ 则/ 窃听/ 者/ 所/ 收到/ 的/ 标签/ 反射/ 信号/ 功率/ 约/ 为/ -/ 86dBm/ ,/ 低于/ 目前/ RFID/ 商用/ 读写器/ -/ 75dBm/ 的/ 最高/ 接收灵敏度/ [/ 18/ ]/ ./ 此外/ ,/ 上述/ 计算/ 仅/ 关注/ 了/ 链路/ 预算/ ,/ 即/ 接收/ 信号强度/ ,/ 在/ 实际/ 环境/ 中/ ,/ 窃听/ 者/ 若想/ 获得/ 后/ 向/ 信道/ 中/ 信息/ ,/ 还/ 需/ 对/ 信号/ 进行/ 解调/ 和/ 解码/ ,/ 但/ 由于/ RFID/ 系统/ 采用/ 幅移键控/ (/ AmplitudeShiftKeying/ ,/ ASK/ )/ 调制/ ,/ 极易/ 受到/ 噪声/ 、/ 多路径/ 效应/ 以及/ 干扰/ 的/ 影响/ ,/ 导致/ 解调/ 和/ 解码/ 的/ 误码率/ 急速/ 增大/ ,/ 导致/ 窃听/ 者/ 的/ 窃听/ 能力/ 进一步/ 受限/ ./ 由于/ 篇幅/ 原因/ ,/ 我们/ 在/ 此/ 不/ 进行/ 详细/ 讨论/ ,/ 读者/ 可/ 参考文献/ [/ 20/ ]/ ./ 3.3/ 实验/ 验证/ 我们/ 采用/ 频谱仪/ 测量/ 了/ 当/ 读写器/ 发射功率/ 为/ 30dBm/ 以及/ 频谱仪/ 接收/ 天线/ 增益/ 为/ 8dBi/ ,/ 到/ 天线/ 不同/ 距离/ 时/ 的/ 标签/ 反射/ 信号强度/ ,/ 如图/ 1/ 所示/ ./ 从图/ 1/ 中/ 可以/ 看出/ 即使/ 读写器/ 发射功率/ 达到/ 30dBm/ ,/ 但/ 距/ 标签/ 6m/ 处/ 的/ 反射/ 信号强度/ 小于/ -/ 80dBm/ ,/ 超出/ 了/ 现有/ RFID/ 读写器/ 的/ 接收灵敏度/ ,/ 使得/ 后/ 向/ 信道/ 窃听/ 极为/ 困难/ ./ 需要/ 说明/ 的/ 是/ ,/ 由于/ WISP/ 能耗/ 约/ 为/ 普通/ 标签/ 的/ 100/ 倍/ ,/ 所以/ 读写器/ 发射功率/ 需要/ 超过/ 23dBm/ 以上/ 才能/ 使/ 其/ 获得/ 足够/ 能量/ ,/ 因此/ 设定/ 读写器/ 发射功率/ 为/ 30dBm/ ,/ 但/ 在/ WiKey/ 实际/ 应用/ 时/ ,/ 可/ 降低/ 读写器/ 发射功率/ 以/ 进一步/ 缩短/ 敌手/ 可/ 窃听/ 距离/ ./ 4/ 系统/ 模型/ 和/ 设计/ 目标/ 在/ 本节/ ,/ 我们/ 首先/ 简要/ 介绍/ RFID/ 系统/ ,/ 再/ 详细描述/ RFID/ 信道/ 的/ 非/ 对称性/ ,/ 并/ 据此/ 定义/ 针对/ 密钥/ 无线/ 生成/ 的/ 敌手/ 能力/ ,/ 最后/ 描述/ WiKey/ 设计/ 目标/ ./ 4.1/ RFID/ 系统/ 典型/ 的/ RFID/ 系统/ 主要/ 由/ 通过/ 特定/ 协议/ 交互/ 的/ 两方/ 组成/ :/ 读写器/ ./ 读写器/ 与/ 后台/ 数据库/ 通过/ 安全/ 信道/ 连接/ ,/ 因此/ 我们/ 将/ 两者/ 看作/ 一个/ 整体/ ,/ 称为/ 合法/ 读写器/ 或/ 简称/ 读写器/ ./ 读写器/ 可/ 向/ 标签/ 发送/ 指令/ 以/ 获得/ 标签/ 中/ 的/ 数据/ ./ 标签/ ./ 标签/ 响应/ 来自/ 读写器/ 的/ 指令/ ./ 对于/ 被动式/ 标签/ ,/ 由于/ 没有/ 电源/ ,/ 标签/ 不能/ 主动/ 向/ 读写器/ 发射/ 电磁波/ ,/ 所以/ 采用/ 反向/ 散射/ 模式/ 通过/ 幅度/ 调制/ 反射/ 读写器/ 载波/ 来/ 传输数据/ ./ 在/ 反向/ 散射/ 通信/ 中/ ,/ 发射/ 信号/ 极其/ 微弱/ ,/ 即使/ 读写器/ 信号/ 能/ 在/ 远/ 至/ 百米/ 的/ 范围/ 内/ Page5/ 被/ 接收/ ,/ 标签/ 的/ 反射/ 信号/ 也/ 仅/ 能/ 在/ 有限/ 的/ 距离/ 内/ 被/ 正确/ 接收/ 及/ 解码/ ./ 协议/ ./ 读写器/ 和/ 标签/ 通过/ 特定/ 协议/ 通信/ ./ 现有/ 的/ 工业/ 标准协议/ 为/ EPCClass1Generation2/ (/ EPCC1G2/ )/ ①/ ,/ 如图/ 2/ 所示/ ./ 该/ 标准协议/ 由/ 两/ 部分/ 组成/ :/ “/ 读取/ 产品/ 码/ ”/ (/ ElectronicProductCode/ ,/ EPC/ )/ 和/ “/ 读/ // 写/ 用户区/ ”/ 操作/ ./ 在/ “/ 读/ EPC/ 操作/ ”/ (/ 或/ 称为/ “/ 盘存/ 操作/ ”/ )/ 中/ ,/ 标签/ 收到/ 查询/ 指令/ 后/ 将/ 返回/ 一个/ 16bits/ 的/ 随机数/ (/ 记为/ RN16/ )/ ./ 读写器/ 收到/ RN16/ 后/ ,/ 将/ 该/ 随机数/ 作为/ 应答/ 返回/ 给/ 标签/ ./ 若/ 标签/ 验证/ RN16/ 与/ 之前/ 所/ 发送/ 的/ 一致/ ,/ 则/ 向/ 读写器/ 发送/ 其/ EPC/ 或/ TID/ (/ TagID/ ,/ 即/ 标签/ ID/ )/ ./ 在/ “/ 读/ // 写/ 用户区/ ”/ 操作/ 中/ ,/ 读写器/ 收到/ 标签/ 的/ ID/ 后/ 向/ 标签/ 发送/ 指令/ 以/ 请求/ 一个/ 新/ 的/ RN16/ 作为/ 读/ // 写/ 操作/ 的/ 会/ 话/ 句柄/ ./ 在/ 用/ 此/ 句柄/ 进行/ 握手/ 之后/ ,/ 读写器/ 向/ 标签/ 发送/ 读/ 或/ 写/ 指令/ 以/ 对/ 标签/ 用户/ 存储/ 区/ 读取/ 或/ 写入/ 16bits/ 的/ 数据/ ,/ 另外/ ,/ 读/ // 写/ 用户区/ 的/ 地址/ 也/ 包含/ 在/ 指令/ 中/ ./ 4.2/ 敌手/ 模型/ 和/ 设计/ 目标/ 在/ RFID/ 标签/ 密钥/ 无线/ 生成/ 过程/ 中/ ,/ 由于/ 最终用户/ 需要/ 操作/ 读写器/ 向/ 标签/ 生成/ 密钥/ ,/ 所以/ 用户/ 处于/ 读写器/ 和/ 标签/ 的/ 通信/ 区域/ ./ 如/ 4.1/ 节/ 所述/ ,/ 标签/ 到/ 读写器/ 的/ 后/ 向/ 信道/ 通信/ 距离/ 较/ 短/ ,/ 所以/ 用户/ 可以/ 目视/ 发现/ 进入/ 该/ 区域/ 的/ 敌手/ 或/ 敌手/ 放置/ 的/ 设备/ ./ 因此/ ,/ 敌手/ 不能/ 在/ 密钥/ 生成/ 过程/ 中/ 在/ 读写器/ 和/ 标签/ 通信/ 区域/ 内/ 置入/ 伪造/ 的/ 标签/ ;/ 另外/ ,/ 用户/ 不会/ 故意/ 向/ 读写器/ 和/ 标签/ 的/ 信道/ 中/ 注入/ 错误/ 数据/ 或/ 经常/ 中断/ 通信/ ./ 如/ 3.2/ 节中/ 分析/ ,/ 由于/ 后/ 向/ 信道/ 中/ 信号/ 很/ 弱/ ,/ 且/ 敌手/ 会/ 在/ 用户/ 目视/ 范围/ 之外/ 进行/ 窃听/ ,/ 导致/ 敌手/ 距离/ 标签/ 较/ 远/ ,/ 则/ 敌手/ 对后/ 向/ 信道/ 窃听/ 极为/ 困难/ ./ 此外/ ,/ 若/ 密钥/ 生成/ 过程/ 在/ 室内/ 进行/ ,/ 而/ 敌手/ 只能/ 在/ 屋外/ 窃听/ ,/ 问题/ 中/ 敌手/ 模型/ 如下/ :/ 则/ 房屋/ 的/ 阻隔/ 会/ 进一步/ 衰减/ 标签/ 信号/ 15/ ~/ 20dB/ [/ 19/ ]/ ,/ 这/ 也/ 增加/ 了/ 敌手/ 窃听/ 的/ 难度/ ./ 综上所述/ ,/ 我们/ 定义/ RFID/ 系统/ 密钥/ 无线/ 生成/ (/ 1/ )/ 敌手/ 不能/ 窃听/ 后/ 向/ 信道/ ;/ (/ 2/ )/ 敌手/ 可/ 窃听/ 前向/ 信道/ 或者/ 向前/ 向/ 信道/ 中注/ (/ 3/ )/ 敌手/ 可向/ 后/ 向/ 信道/ 注入/ 错误信息/ ,/ 即向合/ (/ 4/ )/ 敌手/ 不能/ 在/ 密钥/ 生成/ 过程/ 中/ 在/ 读写器/ 和/ 标入/ 错误信息/ ,/ 即/ 向/ 读写器/ 发送/ 伪造/ 信息/ ;/ 法/ 标签/ 发送/ 伪造/ 信息/ ;/ 签/ 通信/ 区域/ 内/ 置入/ 伪造/ 标签/ ./ 能力/ ,/ 定义/ WiKey/ 设计/ 目标/ 如下/ ./ 结合/ RFID/ 系统/ 密钥/ 无线/ 生成/ 的/ 需求/ 以及/ 敌手/ 密钥/ 机密性/ ./ 敌手/ 获取/ 共享/ 密钥/ 的/ 概率/ 可/ 忽略/ ;/ 密钥/ 可靠性/ ./ 标签/ 能/ 接收/ 到/ 读写器/ 试图/ 让/ 其/ 接收/ 到/ 的/ 密钥/ ;/ 群组/ 密钥/ 生成/ ./ 一个/ 单独/ 的/ 读写器/ 可/ 同时/ 为/ 一组/ 标签/ 分配/ 密钥/ ./ 5WiKey/ 设计/ 本/ 节/ 针对/ 密钥/ 生成/ 的/ 两种/ 场景/ 描述/ WiKey/ 的/ 设计/ :/ (/ 1/ )/ 读写器/ 为/ 单个/ 标签/ 生成/ 密钥/ ./ 其中/ 包括/ 读写器/ 为/ 一个/ 标签/ 生成/ 一个/ 共享/ 密钥/ 和/ 为/ 一批/ 标签/ 分别/ 生成/ 不同/ 的/ 共享/ 密钥/ ;/ (/ 2/ )/ 读写器/ 为/ 一组/ 标签/ 生成/ 一个/ 共同/ 的/ 组/ 密钥/ ./ 5.1/ 概述/ WiKey/ 分为/ 3/ 个/ 阶段/ :/ 标签/ 识别/ 、/ 密钥/ 生成/ 和/ 隐私/ 保护/ 认证/ ./ (/ 1/ )/ 标签/ 识别/ ./ 在/ 该/ 阶段/ ,/ 若/ 标签/ 中/ 不/ 存在/ 初始/ 密钥/ ,/ 则/ 读写器/ R/ 对/ 通信/ 范围/ 内/ 的/ 标签/ 进行/ 盘存/ 操作/ ,/ 以/ 识别/ 每个/ 需要/ 生成/ 密钥/ 的/ 标签/ Ti/ ./ 本/ 阶段/ 用于/ 发现/ 标签/ ,/ 同时/ ,/ 在/ 密钥/ 生成/ 之后/ 于/ 后台/ 数据库/ 记录/ 标签/ 的/ ID/ ./ 由于/ 标签/ 识别/ 过程/ 在/ EPCGen2/ 空中/ 接口标准/ 中/ 已/ 定义/ ,/ 本文/ 将/ 不予/ 详细/ 阐述/ ./ 若/ 标签/ 中/ 存在/ 初始/ 密钥/ ,/ 则/ 读写器/ 和/ 标签/ 可用/ 此/ 密钥/ 进行/ 双向/ 隐私/ 保护/ 认证/ ,/ 认证/ 成功/ 后/ 可/ 执行/ 密钥/ 生成/ ./ (/ 2/ )/ 密钥/ 生成/ ./ 在/ 该/ 阶段/ ,/ 读写器/ R/ 与/ 标签/ 执行/ WiKey/ 协议/ 生成/ 密钥/ ./ 在/ 本节/ 剩余/ 部分/ ,/ 我们/ 将/ 详细描述/ WiKey/ 在/ 3/ 种/ 不同/ 场景/ 下/ 的/ 协议/ :/ 生成/ 单个/ ①/ EPCGlobalInc/ ./ EPCradio/ -/ frequencyidentityprotocolstionsat860MHz/ ~/ 960MHz/ ./ http/ :/ // // www/ ./ gs1/ ./ org/ // gsmp/ // Page6/ 标签/ 的/ 个体/ 密钥/ 生成/ 、/ 批量/ 标签/ 个体/ 密钥/ 生成/ 以及/ 群组/ 标签/ 的/ 组/ 密钥/ 生成/ ./ (/ 3/ )/ 隐私/ 保护/ 认证/ ./ 在/ 密钥/ 生成/ 之后/ ,/ 读写器/ 与/ 标签/ 执行/ 某个/ PPA/ 协议/ 进行/ 双向/ 隐私/ 保护/ 认证/ ,/ 以/ 验证/ 所/ 生成/ 的/ 密钥/ 在/ 读写器/ 和/ 标签/ 端/ 是否/ 一致/ ;/ 如果/ 不/ 一致/ ,/ 则/ 再次/ 执行/ 密钥/ 生成/ 阶段/ ./ 由于/ 目前/ 隐私/ 保护/ 认证/ 协议/ 已经/ 存在/ 大量/ 工作/ ,/ 所以/ 本文/ 将/ 不/ 对/ WiKey/ 所/ 使用/ 的/ 隐私/ 保护/ 认证/ 协议/ 进行/ 描述/ ,/ 可/ 参考/ 的/ 协议/ 如/ HashLock/ [/ 21/ ]/ 和/ LAST/ [/ 22/ ]/ ./ 5.2/ 个体/ 密钥/ 生成/ 生成/ 个体/ 密钥/ 时/ 存在/ 两种/ 情况/ :/ (/ 1/ )/ 为/ 单个/ 标签/ 生成/ 密钥/ ;/ (/ 2/ )/ 为/ 一批/ 标签/ 同时/ 分别/ 生成/ 个体/ 密钥/ ./ (/ 1/ )/ 单个/ 标签/ 密钥/ 生成/ ./ 此时/ WiKey/ 协议/ 由/ 两轮/ 组成/ ,/ 如图/ 3/ (/ a/ )/ 所示/ ./ 读写器/ R/ 首先/ 生成/ 一个/ 随机数/ rR/ ∈/ R/ {/ 0/ ,/ 1/ }/ l/ ,/ 之后/ 将/ 该/ 随机数/ 发送给/ 标签/ Ti/ ,/ 其中/ l/ 是/ 预定/ 义/ 的/ 密钥/ 长度/ ./ 当/ 标签/ Ti/ 收到/ rR/ 之后/ ,/ 首先/ 生成/ 另/ 一个/ 随机数/ rTi/ ∈/ R/ {/ 0/ ,/ 1/ }/ l/ ,/ 之后/ 计算/ 共享/ 密钥/ kTi/ =/ rR/ / rTi/ ./ 之后/ 标签/ Ti/ 将/ rTi/ 返回/ 给/ 读写器/ 作为/ 应答/ ./ 最后/ ,/ 读写器/ R/ 计算所/ 生成/ 的/ 共享/ 密钥/ ./ 该/ 协议/ 为/ WiKey/ 基本/ 协议/ ,/ 其/ 安全性/ 依赖于/ 如/ 第/ 2/ 节/ 所述/ ,/ 敌手/ 不能/ 窃听/ 后/ 向/ 信道/ ./ 由于/ 不能/ 获得/ rTi/ ,/ 即使/ 敌手/ 窃听/ 读写器/ 生成/ 随机数/ rR/ 也/ 无法/ 正确/ 地/ 恢复/ 所/ 生成/ 的/ 共享/ 密钥/ kTi/ ./ (/ 2/ )/ 批量/ 密钥/ 生成/ ./ 作为/ 单独/ 标签/ 密钥/ 生成/ 协议/ 的/ 扩展/ ,/ 批量/ 密钥/ 生成/ 使得/ RFID/ 读写器/ 可以/ 为/ 大量/ 不同/ 标签/ 同时/ 独立/ 地/ 生成/ 个体/ 密钥/ ./ 该/ 协议/ 可/ 用于/ 大规模/ RFID/ 系统/ ./ 与/ 单个/ 标签/ 密钥/ 生成/ 相比/ ,/ 在/ 批量/ 密钥/ 生成/ 协议/ 的/ 第/ 2/ 轮/ (/ 见图/ 3/ (/ b/ )/ )/ ,/ 每个/ 标签/ Ti/ 回复/ 中/ 增加/ 了/ 标签/ Ti/ 的/ 身份/ IDTi/ ./ 标签/ 计算/ 生成/ 的/ 共享/ 密钥/ kTi/ =/ rR/ / rTi/ ./ 一旦/ 读写器/ R/ 接收/ 到/ (/ IDTi/ ,/ rTi/ )/ ,/ 读写器/ 为/ 每个/ 标签/ Ti/ 计算/ 共享/ 密钥/ kTi/ =/ rR/ / rTi/ 并/ 将/ 其/ 记录/ 在/ 后台/ 数据库/ 中/ ./ 5.3/ 群组/ 密钥/ 生成/ 群组/ 密钥/ 生成/ 需在/ 读写器/ R/ 和/ 一组/ 标签/ T1/ ,/ …/ ,/ Tn/ 之间/ 生成/ 一个/ 唯一/ 的/ 共享/ 密钥/ k/ ,/ 这里/ n/ 为/ 群组/ 中/ 标签/ 的/ 个数/ ./ 图/ 4/ 所示/ 为/ 群组/ 密钥/ 生成/ 协议/ ./ 具体/ 而言/ ,/ 在/ 个体/ 密钥/ 生成/ 协议/ 中/ ,/ 共享/ 的/ 密钥/ 由/ 读写器/ 和/ 标签/ 分别/ 生成/ 的/ 随机数/ 共同/ 计算/ 生成/ ;/ 而/ 在/ 群组/ 密钥/ 生成/ 协议/ 中/ ,/ 共享/ 密钥/ 则/ 由/ 同组/ 中/ 的/ 不同/ 标签/ 选取/ 的/ 不同/ 密钥/ 碎片/ (/ 随机数/ )/ 共同/ 生成/ ,/ 该/ 协议/ 由/ 3/ 轮/ 组成/ ./ 读写器/ R/ 首先/ 向/ 全组/ 标签/ T1/ ,/ …/ ,/ Tn/ 广播/ 一个/ “/ 密钥/ 生成/ 请求/ ”/ 以/ 通知/ 所有/ 标签/ 开始/ 进行/ 群组/ 密钥/ 生成/ ./ 一旦/ 组内/ 标签/ Ti/ 收到/ 该/ “/ 请求/ ”/ ,/ Ti/ 独立/ 选取/ 一个/ 随机数/ rTi/ ∈/ R/ {/ 0/ ,/ 1/ }/ l/ 并/ 将/ (/ IDTi/ ,/ rTi/ )/ 发送给/ 读写器/ ,/ IDTi/ 为/ 标签/ Ti/ 的/ ID/ ./ 收到/ 所有/ 标签/ 的/ 回复/ 之后/ ,/ R/ 将/ 接收/ 到/ 的/ 标签/ 响应/ 中/ 所有/ 标签/ IDT1/ ,/ …/ ,/ IDTi/ ,/ …/ ,/ IDTn/ 与/ 标签/ 识别/ 阶段/ 所/ 发现/ 的/ 标签/ ID/ 进行/ 对比/ 并/ 判断/ 其/ 是否/ 一致/ ,/ 如果/ 不/ 一致/ 则/ 表明/ 存在/ 未/ 应答/ 标签/ (/ 或/ 称为/ “/ 静默/ ”/ 标签/ )/ (/ 详细/ 讨论/ 请见/ 第/ 6/ 节/ )/ ,/ 则/ R/ 重新/ 发送/ “/ 请求/ ”/ 以/ 重启/ 密钥/ 生成/ ./ 若/ 所有/ 标签/ 均/ 已/ 应答/ ,/ 可/ 进行/ 密钥/ 生成/ ./ 此时/ ,/ R/ 计算/ 一个/ 共享/ 群组/ 密钥/ k/ =/ / n/ 钥/ 生成/ 因子/ kTi/ =/ k/ / rTi/ ,/ 并/ 广播/ IDTi/ ,/ kT/ (/ )/ i/ ./ 当/ 标签/ Ti/ 收到/ (/ IDTi/ ,/ kTi/ )/ 之后/ ,/ Ti/ 比较/ 该/ 消息/ 中/ IDTi/ 是否/ 与/ 自身/ ID/ 一致/ ,/ 如/ 不/ 一致/ ,/ Ti/ 丢弃/ 该/ 消息/ ,/ 否则/ 计算/ 共享/ 组/ 密钥/ kTi/ =/ k/ / rTi/ ./ 6/ 讨论/ 问题/ ./ 本节/ 讨论/ WiKey/ 在/ 实际/ 应用/ 中/ 可能/ 会/ 遇到/ 的/ (/ 1/ )/ 标签/ 存储/ 限制/ ./ RFID/ 标签/ 通常/ 只有/ 很小/ 的/ 用户/ 存储/ 区/ 用于/ 存储用户/ 信息/ 和/ 密钥/ ./ 因此/ 在/ 设计/ WiKey/ 时/ 必须/ 考虑/ 标签/ 存储/ 效率/ ./ 在/ WiKey/ 中/ ,/ 标签/ 需要/ 暂存/ 标签/ 和/ 读写器/ 生成/ 的/ 随机数/ 以及/ 最后/ 生成/ 的/ 密钥/ ./ 对于/ 目前/ 的/ RFID/ 应用/ ,/ 64bits/ 密钥/ 已经/ 足以/ 使用/ ,/ 因此/ 标签/ 上/ 存储/ 区须/ 大于/ 128bits/ ,/ 而/ 目前/ 市场/ 上/ 超过/ 90/ %/ 的/ 标签/ (/ 由/ 3/ 家/ 公司/ 生产/ :/ NXP/ 、/ ALIEN/ 和/ ImpinJ/ )/ 的/ 用户/ 存储/ 区均/ 超过/ 512bits/ ./ (/ 2/ )/ 标签/ 计算能力/ ./ 由于/ 计算能力/ 有限/ ,/ 现在/ 的/ 普/ Page7/ 通/ 标签/ ,/ 如/ 被动式/ 标签/ ,/ 还/ 不能/ 执行/ WiKey/ 中/ 的/ 所/ 需/ 操作/ ./ 但是/ 在/ 现有/ 标签/ 上/ 进行/ 少量/ 的/ 修改/ 以/ 运行/ WiKey/ 是/ 可行/ 的/ ./ 详细/ 来说/ ,/ WiKey/ 中/ 的/ 主要/ 操作/ 是/ 按/ 比/ 特异/ 或/ 以及/ 随机数/ 生成/ ,/ 均/ 可用/ 较少/ 的/ 门电路/ 实现/ ①/ ./ 另外/ ,/ 现有/ 的/ 普通/ 被动式/ 标签/ 也/ 集成/ 了/ 16bits/ 的/ 随机数/ 发生器/ ./ 在/ 第/ 8/ 节/ ,/ 我们/ 使用/ 了/ 一种/ 具有/ 一定/ 计算能力/ 的/ 标签/ (/ WirelessIdentificationandSensingPlatform/ ,/ WISP/ ②/ )/ 实现/ 了/ WiKey/ 原型/ ./ (/ 3/ )/ 静默/ 标签/ ./ 在/ 实际/ 使用/ 中/ ,/ 执行/ WiKey/ 的/ 标签/ 可能/ 被/ 损坏/ 或/ 无应答/ (/ 静默/ 标签/ )/ 导致/ WiKey/ 无法/ 执行/ ./ 在/ 个体/ 密钥/ 生成/ 时/ 读写器/ 通过/ 等待/ 标签/ 应答/ 很/ 容易/ 发现/ 静默/ 标签/ ./ 但/ 当/ WiKey/ 进行/ 群组/ 密钥/ 生成/ 时/ ,/ 读写器/ 会/ 一直/ 等待/ 静默/ 标签/ 的/ 应答/ ,/ 这/ 将/ 导致/ WiKey/ 无法/ 继续执行/ ./ 为/ 解决/ 这一/ 问题/ ,/ 读写器/ 在/ 执行/ WiKey/ 之前/ 可/ 初始化/ 一个/ 定时器/ ,/ 如果/ 在/ 定时器/ 超时/ 后/ 还/ 未/ 收到/ 某些/ 标签/ 的/ 应答/ ,/ 则/ 读写器/ 将/ 这些/ 标签/ 标记/ 为/ 静默/ 标签/ 并/ 从/ 群组/ 中/ 移除/ ,/ 再/ 重新/ 执行/ WiKey/ ./ (/ 4/ )/ 多/ 群组/ 标签/ ./ 在/ 一些/ 应用/ 中/ ,/ 一个/ 标签/ 可能/ 会/ 被/ 多个/ 群组/ 所/ 包含/ ,/ 可/ 通过/ WiKey/ 为/ 标签/ 生成/ 多个/ 群组/ 密钥/ ./ 但/ 在/ 使用/ 这些/ 多/ 群组/ 标签/ 时/ ,/ 读写器/ 需要/ 通知/ 标签/ 使用/ 哪个/ 密钥/ ./ 在/ 考虑/ 隐私/ 保护/ 的/ 情况/ 下/ ,/ 读写器/ 可以/ 用/ 需要/ 的/ 群组/ 密钥/ 与/ 标签/ 进行/ 一次/ 隐私/ 保护/ 认证/ (/ 如/ HashLock/ [/ 21/ ]/ 和/ LAST/ [/ 22/ ]/ )/ ,/ 以/ 通知/ 标签/ 应/ 使用/ 的/ 密钥/ ./ 由于/ 篇幅/ 限制/ ,/ 本文/ 不/ 对/ 隐私/ 保护/ 认证/ 进行/ 详细/ 阐述/ ./ (/ 5/ )/ 用户/ 错误/ ./ 非专业/ 用户/ 在/ 使用/ WiKey/ 时/ 可能/ 会/ 出现/ 错误/ 导致/ 标签/ 产生/ 错误/ 密钥/ ,/ 但/ WiKey/ 的/ 设计/ 可/ 检测/ 用户/ 错误/ ./ 如/ 5.1/ 节/ 所述/ ,/ 在/ WiKey/ 生成/ 密钥/ 之后/ ,/ 隐私/ 保护/ 认证/ 阶段/ 将/ 检查/ 读写器/ 和/ 标签/ 中/ 密钥/ 的/ 一致性/ ,/ 若/ 因为/ 用户/ 错误/ 导致/ 密钥/ 不/ 一致/ ,/ 则/ 读写器/ 不能/ 通过/ 密钥/ 验证/ 过程/ ,/ 此时/ 用户/ 可/ 发现错误/ 并/ 重新/ 执行/ WiKey/ ./ 7/ 安全性/ 本/ 节/ 首先/ 介绍/ 了/ WiKey/ 的/ 安全/ 目标/ ,/ 之后/ 再/ 给出/ 安全/ 分析/ ./ 7.1/ 安全/ 目标/ (/ 1/ )/ 抗/ 被动/ 攻击/ ./ 在/ 密钥/ 植入/ 之前/ ,/ 由于/ 没有/ 可信/ 密钥/ 来/ 保护/ 标签/ 和/ 读写器/ 之间/ 的/ 消息/ ,/ 所以/ WiKey/ 需/ 抵抗/ 敌手/ 窃听/ ,/ 使得/ 敌手/ 不能/ 通过/ 窃听/ 来/ 推断/ 所/ 生成/ 的/ 密钥/ ./ 如/ 第/ 3.2/ 节/ 所述/ ,/ 敌手/ 不能/ 窃听/ 标签/ 到/ 读写器/ 的/ 后/ 向/ 信道/ ,/ 则/ 当/ 敌手/ 仅能/ 窃听/ 前向/ 信道/ 时/ ,/ WiKey/ 应使/ 敌手/ 不能/ 推断/ 所/ 生成/ 的/ 密钥/ ./ (/ 2/ )/ 抗/ 主动攻击/ ./ 敌手/ 可以/ 向前/ 向/ 和/ 后/ 向/ 信道/ 注入/ 虚假/ 信息/ ./ 由于/ 前向/ 信道/ 的/ 通信/ 范围/ 较大/ ,/ 敌手/ 可/ 对/ 前/ 向/ 信道/ 较/ 容易/ 的/ 注入/ 或/ 修改/ 信息/ ,/ 其/ 对应/ 的/ 攻击/ 为/ 读写器/ 假冒/ ./ 后/ 向/ 信道/ 虽然/ 不能/ 被/ 窃听/ ,/ 但/ 敌手/ 可以/ 向/ 后/ 向/ 信道/ 注入/ 信息/ ,/ 假冒/ 标签/ 以/ 欺骗/ 读写器/ 获得/ 生成/ 的/ 密钥/ ./ 因此/ WiKey/ 能够/ 抵抗/ 读写器/ 和/ 标签/ 假冒/ ./ 7.2/ 安全性/ 分析/ 7.2/ ./ 1/ 被动/ 攻击/ WiKey/ 抗/ 被动/ 攻击/ 的/ 能力/ 依赖于/ 标签/ 和/ 读写器/ 生成/ 随机数/ 的/ 性质/ ./ 若/ 标签/ 和/ 读写器/ 所/ 生成/ 的/ 随机数/ 中/ 每/ 比特/ 为/ 0/ 或/ 1/ 的/ 概率/ 相等/ ,/ 则/ WiKey/ 能/ 抵抗/ 被动/ 攻击/ ,/ 而/ EPCGen2/ 空中/ 接口标准/ 中/ 已经/ 定义/ 了/ 嵌入/ 在/ RFID/ 标签/ 中/ 的/ 16bits/ 伪/ 随机数/ 生成器/ 满足/ 该/ 性质/ ./ WiKey/ 中/ 所用/ 的/ 随机数/ 一般/ 可/ 大于/ 64bits/ ,/ 仅/ 需要/ 对/ 现有/ 标签/ 中/ 的/ 随机数/ 生成器/ 作/ 简单/ 并联/ 即可/ 获得/ ./ 为了/ 获取/ 所/ 生成/ 的/ 共享/ 密钥/ ,/ 敌手/ 可/ 窃听/ 读写器/ 和/ 标签/ 之间/ 通信/ ,/ 但/ 如/ 3.2/ 节/ 所述/ ,/ 敌手/ 不能/ 窃听/ 到/ 从/ 标签/ 到/ 读写器/ 的/ 后/ 向/ 信道/ 上/ 的/ 消息/ ,/ 因此/ 敌手/ 仅能/ 获得/ 前向/ 信道/ 上/ 读写器/ 向/ 标签/ 发送/ 的/ 消息/ ,/ 即/ 随机数/ 或/ 密钥/ 生成/ 因子/ (/ 见/ 5.3/ 节/ 群组/ 密钥/ 生成/ )/ ./ 但/ 由于/ 生成/ 的/ 密钥/ 由/ 读写器/ 的/ 随机数/ 以及/ 标签/ 生成/ 的/ 随机数/ 共同/ 计算/ 得到/ ,/ 缺少/ 后/ 向/ 信道/ 上/ 标签/ 生成/ 的/ 随机数/ ,/ 敌手/ 不能/ 恢复/ 出所/ 生成/ 的/ 密钥/ ./ 另外/ ,/ 若/ 敌手/ 采用/ 暴力/ 攻击/ 的/ 方式/ 猜测/ 密钥/ ,/ 只/ 需/ 设置/ 合适/ 的/ 密钥/ 长度/ ,/ 即可/ 增加/ 敌手/ 猜测/ 的/ 困难/ ./ 具体/ 而言/ ,/ 若/ 采用/ n/ 比特/ 长度/ 的/ 随机数/ ,/ 则/ 可/ 产生/ n/ 比特/ 的/ 密钥/ ,/ 则/ 敌手/ 猜测/ 密钥/ 的/ 复杂度/ 为/ 2n/ ,/ 综合/ 考虑/ RFID/ 系统/ 需求/ 和/ 标签/ 能力/ ,/ 采用/ 64bits/ 长度/ 的/ 密钥/ 即可/ 有效/ 抵抗/ 暴力/ 攻击/ ./ 7.2/ ./ 2/ 主动攻击/ 敌手/ 可以/ 向前/ 向/ 信道/ 和/ 后/ 向/ 信道/ 中/ 注入/ 错误信息/ ,/ 以/ 欺骗/ 读写器/ 和/ 标签/ 使得/ 它们/ 生成/ 错误/ 的/ 密钥/ ,/ 因此/ 我们/ 对/ 该种/ 攻击/ 进行/ 详细分析/ ./ (/ 1/ )/ 前向/ 信道/ 消息/ 注入/ ./ 敌手/ 在/ 合法/ 读写器/ 与/ 标签/ 执行/ WiKey/ 之前/ 、/ 之时/ 和/ 之后/ 均/ 可/ 向前/ 向/ 信道/ 注入/ 信息/ ,/ 从/ 效果/ 上/ 可以/ 看作/ 敌手/ 假冒/ 合法/ 读写器/ ①/ ②/ Page8/ 与/ 标签/ 执行/ WiKey/ 协议/ ./ 当/ 攻击/ 发生/ 于/ WiKey/ 执行/ 之后/ ,/ 此时/ 标签/ 已经/ 与/ 合法/ 读写器/ 生成/ 密钥/ ,/ 如/ 5.1/ 节/ 所述/ ,/ 标签/ 会/ 使用/ 所/ 生成/ 的/ 密钥/ 对/ 读写器/ 进行/ 隐私/ 保护/ 认证/ ,/ 由于/ 敌手/ 不能/ 获得/ 该/ 密钥/ ,/ 则/ 攻击/ 失败/ ./ 当/ 攻击/ 发生/ 于/ WiKey/ 执行/ 之/ 时/ ,/ 此时/ 合法/ 读写器/ 正/ 和/ 标签/ 进行/ 密钥/ 生成/ ,/ 由于/ 没有/ 初始/ 共享/ 密钥/ 存在/ ,/ 标签/ 不能/ 分辨/ 前向/ 信道/ 中/ 消息来源/ ./ 若/ 敌手/ 注入/ 了/ 错误/ 数据/ ,/ 会/ 导致/ 标签/ 计算/ 出/ 与/ 合法/ 读写器/ 端/ 不/ 一致/ 的/ 错误/ 密钥/ ./ 而/ WiKey/ 在/ 密钥/ 生成/ 之后/ 合法/ 读写器/ 会/ 通过/ 生成/ 的/ 密钥/ 进行/ 隐私/ 保护/ 认证/ 以/ 检测/ 密钥/ 一致性/ (/ 如/ 5.1/ 节/ 所述/ )/ ,/ 此时/ 合法/ 读写器/ 会/ 发现/ 标签/ 被/ 敌手/ 攻击/ ./ 当/ 攻击/ 发生/ 于/ WiKey/ 执行/ 之前/ ,/ 敌手/ 向/ 标签/ 发送/ 随机数/ 使得/ 标签/ 生成/ 密钥/ ,/ 即使/ 敌手/ 不能/ 获得/ 后/ 向/ 信道/ 中/ 标签/ 所/ 产生/ 的/ 随机数/ 从而/ 不能/ 计算/ 出/ 标签/ 中/ 所/ 生成/ 的/ 密钥/ ,/ 但/ 敌手/ 依然/ 可以/ 让/ 标签/ 中/ 产生/ 错误/ 密钥/ ./ 由于/ 该/ 错误/ 密钥/ 的/ 存在/ ,/ 导致/ 合法/ 读写器/ 与/ 标签/ 在/ 执行/ WiKey/ 时/ 标签/ 不能/ 再/ 重新/ 产生/ 合法/ 密钥/ ./ 但是/ ,/ 合法/ 读写器/ 在/ 执行/ 密钥/ 生成/ 之前/ 能/ 发现/ 该/ 攻击/ ,/ 从而/ 可/ 对/ 标签/ 再次/ 初始化/ ./ 综上所述/ ,/ 当/ 敌手/ 假冒/ 合法/ 读写器/ 向前/ 向/ 信道/ 注入/ 消息/ 时/ ,/ 即使/ 能/ 让/ WiKey/ 不能/ 生成/ 合法/ 密钥/ ,/ 也/ 会/ 被/ 合法/ 读写器/ 发现/ ./ (/ 2/ )/ 后/ 向/ 信道/ 消息/ 注入/ ./ 在/ 该/ 攻击/ 中/ ,/ 敌手/ 虽然/ 不能/ 窃听/ 到/ 后/ 向/ 信道/ 中/ 的/ 标签/ 消息/ ,/ 但/ 可以/ 主动/ 向/ 合法/ 读写器/ 发送/ 消息/ ,/ 以/ 破坏/ 密钥/ 生成/ 过程/ 或/ 获取/ 读写器/ 与/ 标签/ 所/ 生成/ 的/ 密钥/ ./ 从/ 攻击/ 效果/ 而言/ ,/ 等价/ 于/ 敌手/ 假冒/ 合法/ 标签/ 与/ 读写器/ 执行/ WiKey/ 生成/ 密钥/ ./ 由于/ 在/ 执行/ WiKey/ 之前/ 不/ 存在/ 共享/ 密钥/ ,/ 合法/ 的/ 读写器/ 无法/ 区分/ 合法/ 标签/ 和/ 敌手/ 假冒/ 标签/ 发送/ 的/ 消息/ ./ 我们/ 对/ 该/ 攻击/ 分为/ 两类/ :/ 针对/ 个体/ 密钥/ 生成/ 和/ 群组/ 密钥/ 生成/ ./ 攻击/ 个体/ 密钥/ 生成/ 时/ ,/ 敌手/ 与/ 合法/ 读写器/ 执行/ WiKey/ 可/ 生成/ 一个/ 与/ 读写器/ 共享/ 密钥/ ,/ 但/ 无法/ 获得/ 其它/ 合法/ 标签/ 与/ 读写器/ 生成/ 的/ 共享/ 密钥/ ,/ 因此/ 合法/ 标签/ 中/ 所/ 生成/ 的/ 密钥/ 不会/ 泄露/ ./ 攻击/ 群组/ 密钥/ 生成/ 时/ ,/ 敌手/ 通过/ 在/ 合法/ 标签/ 群组/ 中/ 置入/ 伪造/ 标签/ ,/ 敌手/ 可/ 在/ WiKey/ 执行/ 之后/ 生成/ 获取/ 该/ 目标/ 群组/ 的/ 共享/ 组/ 密钥/ ./ 但是/ ,/ 如/ 3.2/ 节/ 所述/ ,/ 由于/ 现实/ 中/ 密钥/ 生成/ 可/ 处于/ 一个/ 私密/ 空间/ ,/ 故/ 敌手/ 难以/ 将/ 伪造/ 标签/ 置入/ 合法/ 标签/ 群组/ 中/ ./ 进一步/ 来说/ ,/ 假设/ 敌手/ 不/ 放置/ 伪造/ 标签/ 而是/ 在/ 远距离/ 与/ 读写器/ 交换/ 信息/ ,/ 敌手/ 也/ 能/ 生成/ 群组/ 密钥/ ./ 但/ 这种/ 攻击/ 会/ 造成/ 群组/ 中/ 增加/ 不/ 存在/ 的/ 标签/ ,/ 而/ WiKey/ 在/ 进行/ 密钥/ 生成/ 之前/ 需要/ 先对/ 标签/ 进行/ 识别/ ,/ 从而/ 合法/ 读写器/ 和/ 用户/ 可以/ 知道/ 群组/ 中/ 标签/ 数量/ ./ 这样/ ,/ 若/ 群组/ 中/ 实际/ 标签/ 数/ 少于/ WiKey/ 执行/ 时所/ 发现/ 的/ 标签/ 数/ ,/ 则/ 用户/ 可/ 判断/ 攻击/ 发生/ ./ 8/ 原型/ 实现/ 由于/ 现有/ 的/ 商用/ 被动式/ 标签/ 不/ 具备/ WiKey/ 所/ 需/ 的/ 计算能力/ ,/ 并且/ 不能/ 编程/ ,/ 所以/ 我们/ 使用/ ImpinJSpeedwayRevolution/ 读写器/ 和/ 10/ 个/ WISP/ 标签/ 来/ 实现/ WiKey/ 系统/ 原型/ ,/ 如图/ 5/ 所示/ ./ WISP/ 是/ 一种/ 兼容/ EPCC1G2/ 的/ 超高频/ RFID/ 被动式/ 标签/ ,/ 相比/ 于/ 普通/ 被动式/ 商用/ 标签/ ,/ WISP/ 可编程/ 且/ 具有/ 一定/ 的/ 计算能力/ ./ 在/ 原型/ 实现/ 中/ ,/ 通过/ 对/ 固件/ 的/ 重/ 编程/ 实现/ 对/ WISP/ 的/ “/ 读/ // 写/ 用户区/ ”/ 操作/ ./ 同时/ ,/ 选择/ 64bits/ 作为/ 生产/ 的/ 密钥/ 和/ 随机数/ 长度/ ./ 根据/ EPCC1G2/ 标准/ ,/ 读写器/ 仅能/ 通过/ “/ 读/ 用户区/ ”/ 操作/ 来/ 获取/ 标签/ 的/ 非/ ID/ 数据/ ,/ 也/ 只能/ 通过/ “/ 写/ 用户区/ ”/ 操作/ 向/ 标签/ 发送数据/ ,/ 因此/ 原型/ 系统/ 采用/ “/ 读/ // 写/ 用户区/ ”/ 指令/ 实现/ WiKey/ 所/ 需/ 的/ 读写器/ 和/ 标签/ 消息/ 交互/ ./ 使用/ WISP/ 实现/ WiKey/ 的/ 最大/ 挑战/ 是/ 解决/ 标签/ 能量/ 限制/ ./ 对于/ 被动式/ 标签/ ,/ 其/ 计算/ 和/ 通信/ 的/ 能量/ 来自/ 于/ 读写器/ 向/ 标签/ 发送/ 查询/ 指令/ 和/ 连续/ 载波/ 信号/ (/ 见图/ 2/ )/ ./ 标签/ 能量/ 由/ 两个/ 主要/ 因素/ 决定/ :/ 第/ 1/ 个/ 因素/ 是/ 标签/ 和/ 读写器/ 之间/ 的/ 通信/ 距离/ ,/ 越长/ 的/ 距离/ 将/ 导致/ 在/ 标签/ 天线/ 上/ 越弱/ 的/ 信号强度/ ;/ 第/ 2/ 个/ 因素/ 是/ 读写器/ 同时/ 操作/ 的/ 标签/ 个数/ 或/ 群组/ 中/ 的/ 标签/ 个数/ ./ 由于/ 读写器/ 在/ 操作/ 标签/ 时/ 采用/ 时分复用/ 的/ 方式/ ,/ 所以/ 读写器/ 只能/ 以/ 顺序/ 方式/ 访问/ 标签/ ,/ 因此/ ,/ 在/ 读写器/ 读取/ 范围/ 内/ 存在/ 大量/ 标签/ 将/ 导致/ 每个/ 标签/ 的/ 平均/ 等/ Page9/ 待/ 时间/ 延长/ ./ 进一步/ 而言/ ,/ 当/ 读写器/ 在/ 向/ 某个/ 标签/ 执行/ 读/ // 写/ 操作/ 时/ ,/ 其它/ 标签/ 只能/ 等待/ 并/ 监听/ 读写器/ 信号/ ,/ 直到/ 收到/ RN16/ 应答/ 或/ 新/ 的/ 读/ // 写/ 操作/ 指令/ ,/ 而/ 长时间/ 等待/ 会/ 使得/ 标签/ 掉电/ 从而/ 不能/ 响应/ 读写器/ 指令/ ./ 因此/ ,/ 读写器/ 可/ 操作/ 的/ 标签/ 数量/ 是/ 受限/ 的/ ,/ 特别/ 是/ 当/ 读写器/ 对/ 标签/ 执行/ 高能耗/ 的/ 写/ 操作/ 时/ ./ 为/ 克服/ 能量/ 限制/ ,/ WiKey/ 采用/ 了/ 一种/ 称为/ “/ 多次/ 盘存/ ”/ 的/ 机制/ ,/ 即当/ 读写器/ 需要/ 向/ 标签/ 写入/ 大量/ 数据/ (/ 如/ 64bits/ 随机数/ )/ 时/ ,/ 该/ 数据/ 将/ 被/ 分为/ 数个/ 单元/ ,/ 每个/ 单元/ 包含/ 16bits/ 数据/ ,/ 对于/ 每个/ 数据/ 单元/ ,/ 读写器/ 发起/ 一次/ 新/ 的/ 盘存/ 操作/ 发送/ 查询/ 指令/ 和/ 连续/ 载波/ 以/ 对/ 标签/ 充电/ ./ 通过/ 该/ 方式/ ,/ 读写器/ 可以/ 同时/ 操作/ 更/ 多/ 标签/ ,/ 即/ 扩展/ WiKey/ 中/ 批量/ 或/ 群组/ 密钥/ 生成/ 所/ 支持/ 的/ 标签/ 数量/ ./ 9/ 性能/ 评价/ 我们/ 基于/ 原型/ 系统对/ WiKey/ 性能/ 进行/ 了/ 评价/ ./ 从/ 原型/ 实现/ 的/ 过程/ 中/ 我们/ 发现/ ,/ WiKey/ 性能/ 主要/ 由/ 两个/ 因素/ 决定/ :/ (/ 1/ )/ 读写器/ 和/ 标签/ 执行/ WiKey/ 时/ 的/ 操作/ 距离/ ;/ (/ 2/ )/ 批量/ 或/ 群组/ 密钥/ 生成/ 时/ WiKey/ 所/ 支持/ 的/ 标签/ 数量/ ./ 所以/ 我们/ 分别/ 测试/ 了/ WiKey/ 在/ 这/ 两种/ 指标/ 下/ 的/ 性能/ ./ 9.1/ 操作/ 距离/ 在/ 本/ 实验/ 中/ ,/ 我们/ 测试/ 了/ WiKey/ 操作/ 距离/ 和/ 操作/ 时间/ 的/ 关系/ ,/ 该/ 实验/ 包括/ 3/ 个/ 部分/ :/ (/ 1/ )/ 读写器/ 与/ 一个/ 标签/ 生成/ 个体/ 密钥/ ;/ (/ 2/ )/ 读写器/ 不/ 采用/ “/ 多次/ 盘存/ ”/ 方法/ (/ 见/ 第/ 7/ 节/ )/ 时/ 与/ 多个/ 标签/ 生成/ 密钥/ ;/ (/ 3/ )/ 读写器/ 采用/ “/ 多次/ 盘存/ ”/ 时/ 与/ 多个/ 标签/ 生成/ 密钥/ ./ 需注意/ 的/ 是/ 由于/ 批量/ 个体/ 密钥/ 生成/ 和/ 群组/ 密钥/ 生成/ 所/ 需/ 的/ 运算/ 和/ 协议/ 过程/ 类似/ ,/ 其/ 性能/ 也/ 类似/ ,/ 因此/ 在/ 第/ 2/ 和/ 第/ 3/ 个/ 实验/ 中/ ,/ 我们/ 将/ 两种/ 密钥/ 生成/ 方法/ 统一/ 测试/ ./ 在/ 测试/ 个体/ 密钥/ 生成/ 时/ ,/ 我们/ 在/ 0/ ~/ 1m/ 范围/ 内/ 调整/ WISP/ 标签/ 到/ 读写器/ 天线/ 的/ 距离/ ,/ 在/ 每个/ 距离/ 上/ ,/ 我们/ 执行/ WiKey/ 协议/ 生成/ 密钥/ 并/ 测量/ 密钥/ 生成/ 所/ 需/ 的/ 时间/ ,/ 每次/ 测试/ 重复/ 10/ 次/ ,/ 取/ 均值/ 为/ 最终/ 测试/ 结果/ ./ 图/ 6/ 描述/ 了/ 读写器/ 和/ 1/ 个/ 标签/ 运行/ WiKey/ 时其/ 操作/ 时间/ 和/ 距离/ 关系/ ./ 从图/ 6/ 可以/ 看出/ ,/ 随着/ 距离/ 增加/ ,/ 操作/ 时间/ 先/ 在/ 80cm/ 以内/ 递减/ ,/ 之后/ 开始/ 持续增长/ ./ 其/ 原因/ 如下/ :/ 超高频/ RFID/ 系统/ 工作频率/ 为/ 915MHz/ ,/ 其/ 波长/ λ/ 约/ 为/ 33.3/ cm/ ,/ 在/ 小于/ λ/ // 2/ π/ (/ 约/ 5.2/ cm/ )/ 的/ 近场/ 范围/ 内/ 电磁波/ 主要/ 以/ 磁场/ 形式/ 存在/ ①/ ,/ 由于/ 标签/ 只能/ 接收/ 电场/ 能量/ ,/ 所以/ 标签/ 需要/ 较长时间/ 充电/ ,/ 导致/ 在/ 10cm/ 以内/ 其/ 操作/ 时间/ 较长/ ;/ 随着/ 操作/ 距离/ 增加/ ,/ 电场/ 能量/ 逐渐/ 增强/ ,/ 标签/ 可/ 更/ 有效/ 地/ 获得/ 能量/ ,/ 所以/ 其/ 操作/ 时间/ 相应/ 减小/ ;/ 而/ 超过/ 80cm/ 之后/ ,/ 电磁波/ 衰减/ 效应/ 导致/ 标签/ 在/ 单位/ 时间/ 内/ 获得/ 能量/ 开始/ 减少/ ,/ 所以/ 其/ 操作/ 时间/ 开始/ 增长/ ./ 另外/ ,/ 从图/ 中/ 可以/ 看出/ 操作/ 时间/ 大于/ 640ms/ ,/ 超过/ 了/ 商用/ 被动式/ 标签/ 的/ 响应/ 时间/ ,/ 这是/ 由于/ WISP/ 标签/ 所/ 需/ 能量/ 约/ 为/ 商用/ 标签/ 的/ 100/ 倍/ ,/ 其/ 能量/ 采集/ 时间/ 更长/ ,/ 若/ 对/ WISP/ 进行/ 一些/ 修改/ ,/ 采用/ 更加/ 高效/ 的/ 能量/ 采集/ 电路/ ,/ 将会/ 有效/ 缩短/ WiKey/ 操作/ 时间/ ./ 图/ 7/ 和/ 图/ 8/ 描述/ 了/ 当/ 读写器/ 与/ 多个/ 标签/ 运行/ WiKey/ 时其/ 操作/ 时间/ 和/ 操作/ 距离/ 的/ 关系/ ./ 图/ 7/ 为/ 不/ 采用/ “/ 多次/ 盘存/ ”/ 机制/ 的/ 结果/ ;/ 图/ 8/ 为/ 采用/ “/ 多次/ 盘存/ ”/ 后/ 的/ 结果/ ./ 从/ 两图/ 中/ 可以/ 看出/ ,/ WiKey/ 操作/ 时间/ 随/ 操作/ 距离/ 和/ 标签/ 数目/ 增长/ 而/ 增长/ ,/ 其/ 原因/ 是/ 更/ 多/ 标签/ 和/ 信号/ 传播/ 衰减/ 导致/ 标签/ 需要/ 更/ 多/ 时间/ 获取/ 足够/ 能量/ ./ 另外/ ,/ 相比/ 单个/ 标签/ 密钥/ 生成/ ,/ 在/ 多/ 标签/ 运行/ WiKey/ 时/ ,/ 操作/ 时间/ 增长/ 显著/ ,/ 这是/ 由于/ 目前/ 的/ RFID/ 空中/ 接口标准/ 规定/ 读写器/ 采用/ 时分复用/ 方式/ 顺序/ 访问/ 标签/ ,/ 标签/ 数量/ 增长/ 会/ 导致/ 操作/ 时间/ 相应/ 增加/ ./ ①/ InductiveCoupling/ ./ http/ :/ // // en/ ./ wikipedia/ ./ org/ // wiki/ // induc/ -/ tivecoupling/ ./ Page109/ ./ 2/ 标签/ 数量/ 对比/ 图/ 7/ 和/ 图/ 8/ ,/ 可以/ 看出/ WiKey/ 操作/ 时间/ 与/ 标签/ 数量/ 呈/ 正比/ ./ 对于/ 图/ 7/ ,/ 由于/ 未/ 采用/ “/ 多次/ 盘存/ ”/ 机制/ ,/ 多个/ 标签/ 在/ 等待/ 读写器/ 访问/ 时间/ 过长/ 导致/ 掉电/ ,/ 使得/ 标签/ 不能/ 响应/ 读写器/ 指令/ ,/ 因此/ WiKey/ 所能/ 支持/ 的/ 标签/ 数量/ 受到限制/ ,/ 从图/ 7/ 可以/ 看出/ ,/ 此时/ WiKey/ 所能/ 支持/ 的/ 标签/ 数量/ 在/ 4/ 个/ 以内/ ./ 而/ 采用/ 了/ “/ 多次/ 盘存/ ”/ 机制/ 之后/ (/ 如图/ 8/ 所示/ )/ ,/ 虽然/ 操作/ 时间/ 相比/ 图/ 7/ 增大/ (/ 10/ 个/ 标签/ 时约/ 14/ ~/ 18s/ )/ ,/ 但是/ 能/ 支持/ 的/ 标签/ 数量/ 显著/ 增加/ ./ 而/ 密钥/ 生成/ 是/ 一次性/ 工作/ ,/ 18s/ 以内/ 的/ 操作/ 时间/ 可以/ 接受/ ./ 另外/ ,/ 由于/ 我们/ 手中/ 只有/ 10/ 个/ WISP/ 标签/ ,/ 所以/ 未能/ 测试/ 更/ 多/ 标签/ 时/ 的/ WiKey/ 性能/ ./ 10/ 总结/ 本文/ 提出/ 了/ 一种/ RFID/ 系统/ 密钥/ 无线/ 生成/ 方法/ (/ 称为/ WiKey/ )/ 以/ 支持/ RFID/ 系统/ 的/ 安全/ 应用/ ./ WiKey/ 针对/ 标签/ 个体/ 密钥/ 设计/ 了/ 基本/ 密钥/ 生成/ 方法/ ,/ 并/ 据此/ 设计/ 了/ 群组/ 密钥/ 生成/ 机制/ ./ 我们/ 讨论/ 并/ 分析/ 了/ WiKey/ 在/ 实际/ 使用/ 中/ 可能/ 遇到/ 的/ 问题/ 并/ 提出/ 了/ 相应/ 的/ 解决/ 方法/ ./ 安全/ 分析表明/ WiKey/ 能/ 抵抗/ 被动/ 窃听/ 和/ 主动/ 信道/ 消息/ 注入/ ./ 同时/ 我们/ 在/ WISP/ 和/ 商用/ 读写器/ 上/ 实现/ 了/ WiKey/ 并/ 对/ 性能/ 进行/ 了/ 评价/ ,/ 结果显示/ WiKey/ 能/ 在/ RFID/ 标签/ 和/ 读写器/ 上/ 高效/ 的/ 生成/ 密钥/ ,/ 适用/ 于/ RFID/ 的/ 安全/ 应用/ ./ 

