Page1/ 高阶差分/ 视角/ 下/ 的/ 积分/ 攻击/ 董乐/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 吴文玲/ 1/ )/ ,/ 2/ )/ 吴双/ 1/ )/ 邹剑/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 1/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 2/ )/ (/ 中国科学院/ 软件/ 研究所/ 北京/ 100190/ )/ 3/ )/ (/ 中国科学院/ 研究生院/ 北京/ 100149/ )/ 摘要/ 积分/ 攻击/ 和/ 高阶差分/ 攻击/ 是/ 分组/ 密码/ 的/ 两种/ 重要/ 分析/ 技术/ ./ 尽管/ 两者/ 的/ 理论/ 基础/ 并不相同/ ,/ 但是/ 它们/ 的/ 攻击/ 过程/ 却/ 十分相似/ ./ 该文/ 从/ 高阶差分/ 分析/ 的/ 视角/ 来/ 解释/ AES/ 和/ Rijndael/ -/ 256/ 的/ 积分/ 区分/ 器/ ,/ 证明/ 高阶差分/ 分析/ 对/ 此类/ 算法/ 同样/ 有/ 很/ 强/ 的/ 分析/ 能力/ ./ 此外/ ,/ 改进/ 了/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 区分/ 器/ 的/ 数据/ 复杂度/ ./ 最后/ ,/ 给出/ 了/ SPON/ -/ GENT/ 杂凑/ 函数/ 中间/ 置换/ 的/ 14/ 轮/ 零/ 和/ 区分/ 器/ ./ 关键词/ 积分/ 攻击/ ;/ 高阶差分/ 攻击/ ;/ AES/ ;/ Rijndael/ -/ 256/ ;/ SPONGENT1/ 引言/ 自/ 20/ 世纪末/ ,/ 积分/ 攻击/ [/ 1/ -/ 2/ ]/ 一直/ 是/ 分组/ 密码/ 的/ 一种/ 重要/ 分析/ 手段/ ./ 它/ 最早/ 的/ 分析/ 对象/ 是/ 一个/ 名为/ Square/ [/ 3/ ]/ 的/ 分组/ 密码/ 算法/ ,/ 所以/ 开始/ 被/ 称为/ Square/ 攻击/ ,/ 后来/ 在/ 对/ AES/ [/ 1/ ]/ (/ AdvancedEncryptionStandard/ )/ 的/ 分析/ 中/ 扮演/ 重要/ 角色/ ./ 2002/ 年/ ,/ Knudsen/ 等/ 人/ [/ 2/ ]/ 将/ 这/ 一类/ 分析方法/ 命名/ 为/ 积分/ 攻击/ ,/ 意/ 为/ 一个/ 与/ 差分/ 攻击/ 相对/ 应/ 的/ 分析方法/ ./ 这种/ 分析方法/ ,/ 尤其/ 适用/ 于/ 基于/ 一些/ 双射/ 模块/ 构造/ 的/ 算法/ ./ 高阶差分/ 攻击/ 源于/ 1994/ 年/ Lai/ [/ 4/ ]/ 提出/ 的/ 离散/ 函数/ 的/ 高阶微分/ 的/ 概念/ ./ 1995/ 年/ ,/ Knudsen/ 系统地/ 提出/ 了/ 高阶差分/ 的/ 概念/ ,/ 并/ 将/ 其/ 应用/ 于/ Feistel/ 类/ 密码/ [/ 5/ ]/ ./ 虽然/ 这/ 两种/ 分析方法/ 的/ 理论/ 基础/ 不同/ ,/ 但是/ 它们/ 都/ 是/ 利用/ 一组/ 选择/ 明文/ 来/ 构造/ 区分/ 器/ ,/ 使得/ 在/ 区分/ 器/ 的/ 末端/ 得到/ 的/ 密文/ 的/ 异或/ 和/ 为/ 零/ (/ 或者/ 在/ 某些/ 比特/ 为/ 零/ )/ ,/ 我们/ 称为/ 平衡/ 状态/ 或者/ 局部/ 平衡/ 状态/ ./ 更/ 具体地说/ ,/ 都/ Page2/ 是/ 首先/ 找到/ 一些/ 字节/ 或者/ 比特/ ,/ 习惯/ 地/ 称为/ 活跃/ 字节/ 或者/ 活跃/ 比特/ ,/ 取遍/ 这些/ 字节/ 或者/ 比特/ 的/ 所有/ 能取/ 的/ 值/ ,/ 同时/ 其它/ 比特/ 的/ 值/ 取定/ 不变/ ,/ 来/ 构造/ 一个/ 明文/ 结构/ ,/ 使得/ 这些/ 明文/ 所有/ 对应/ 的/ 密文/ 的/ 异或/ 和/ ,/ 或者/ 某些/ 比特/ 的/ 异或/ 和/ 为/ 零/ ./ 积分/ 攻击/ 是/ 对/ AES/ 算法/ 的/ 最好/ 的/ 分析方法/ 之一/ ,/ 并且/ 对/ AES/ 类/ 算法/ 的/ 积分/ 攻击/ 是/ 此/ 攻击/ 最具/ 代表性/ 的/ 工作/ 之一/ ./ 依靠/ 对/ 若干个/ 明文/ 字节/ 的/ 值/ 的/ 遍历/ (/ 其它/ 字节/ 取定值/ )/ ,/ 在/ 3/ 轮/ 和/ 4/ 轮/ 核心/ 积分/ 区分/ 器/ 的/ 基础/ 上/ ,/ 对/ AES/ 和/ Rijndael/ -/ 256/ 分别/ 可以/ 构造/ 4/ 轮/ 和/ 6/ 轮/ 的/ 积分/ 区分/ 器/ [/ 1/ ,/ 6/ ]/ ./ 另一方面/ ,/ 如果/ 想/ 对/ 算法/ 低/ 轮数/ 的/ 版本/ 进行/ 分析/ ,/ 可以/ 以/ 比特/ 为/ 单位/ 选择/ 活跃/ 单元/ ./ 2008/ 年/ ,/ Z/ ’/ aba/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 比特/ 积分/ 的/ 思想/ ,/ 首次/ 将/ 积分/ 攻击/ 用于/ 分析/ PRESENT/ 这种/ 基于/ 比特/ 设计/ 的/ 分组/ 密码/ ./ 2011/ 年/ ,/ Wei/ 等/ 人/ 选择/ 明文/ 中/ 5/ 个/ 字节/ 的/ 最低/ 位/ 比特/ 作为/ 活跃/ 比特/ ,/ 以/ 25/ 的/ 数据/ 复杂度/ 构造/ 了/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 积分/ 区分/ 器/ [/ 8/ ]/ ./ 但是/ ,/ 对于/ 此类/ 区分/ 器此/ 数据/ 复杂度/ 是否/ 最小/ 还/ 不明朗/ ./ 本文/ 通过/ 对/ AES/ 类/ 算法/ 的/ 积分/ 攻击/ 的/ 分析/ ,/ 给出/ AES/ 积分/ 攻击/ 中/ 的/ 经典/ 的/ 3/ 轮/ 区分/ 器/ 和/ Rijndael/ -/ 256/ 的/ 积分/ 攻击/ 中/ 经典/ 的/ 4/ 轮/ 区分/ 器/ 的/ 高阶差分/ 解释/ ,/ 并且/ 确定/ 了/ 通过/ 对/ 活跃/ 字节/ 位置/ 的/ 适当/ 选取/ ,/ 可以/ 得到/ Rijndael/ -/ 256/ 的/ 4/ 轮/ ,/ 最后/ 状态/ 为/ 全/ 平衡/ 的/ 高阶差分/ 区分/ 器/ ./ 此外/ ,/ 我们/ 对/ Rijndael/ -/ 256/ 的/ 3/ 轮低/ 数据/ 复杂度/ 的/ 积分/ 区分/ 器/ ,/ 给出/ 了/ 高阶差分/ 解释/ ,/ 并且/ 利用/ 代数/ 次数/ 的/ 增加/ 规律/ 进一步/ 改进/ 了/ 数据/ 复杂度/ ./ 最后/ ,/ 我们/ 还/ 对/ 基于/ 比特/ 设计/ 的/ 杂凑/ 函数/ SPONGENT/ [/ 9/ ]/ 其中/ 一个/ 版本/ 的/ 置换/ ,/ 进行/ 了/ 分析/ ./ 通过/ 对/ 其/ 代数/ 次数/ 增加/ 情况/ 的/ 计算/ ,/ 给出/ 了/ 这/ 一/ 置换/ 的/ 14/ 轮/ 零/ 和/ 区分/ 器/ ./ 本文/ 第/ 2/ 节/ 介绍/ 积分/ 攻击/ 与/ 差分/ 攻击/ 等/ 相关/ 工作/ ;/ 第/ 3/ 节对/ 本文/ 涉及/ 的/ 算法/ AES/ 、/ Rijndael/ -/ 256/ 和/ SPONGENT/ 进行/ 简要/ 的/ 介绍/ ;/ 第/ 4/ 节/ 给出/ 后面/ 章节/ 所用/ 到/ 的/ 两个/ 定理/ ;/ 我们/ 在/ 第/ 5/ 节用/ 高阶差分/ 解释/ AES/ 和/ Rijndael/ -/ 256/ 的/ 积分/ 区分/ 器/ ;/ 第/ 6/ 节/ 解释/ 并/ 改进/ Rijndael/ -/ 256/ 的/ 比/ 特级/ 积分/ 区分/ 器/ ;/ 第/ 7/ 节/ 利用/ 高阶差分/ 构造/ SPONGENT/ 内部/ 置换/ 的/ 零/ 和/ 区分/ 器/ ;/ 第/ 8/ 节/ 总结/ 并/ 给出/ 下/ 一步/ 的/ 研究/ 方向/ ./ 2/ 相关/ 工作/ 2.1/ 积分/ 攻击/ 积分/ 攻击/ [/ 1/ -/ 2/ ,/ 6/ ]/ 源于/ 对/ AES/ 的/ 前身/ Square/ 分组/ 密码/ 算法/ 的/ 一种/ 攻击/ ./ 攻击/ 过程/ 中/ ,/ 一些/ 明文/ 字节/ 被/ 选定/ 为/ 常数/ ,/ 记为/ C/ ,/ 其它/ 字节/ ,/ 一般/ 称为/ 活跃/ 字节/ ,/ 取遍/ 所有/ 的/ 256/ 个值/ ,/ 这些/ 字节/ 记为/ A/ ./ 如果/ 在/ 若干/ 轮/ 之后/ 得到/ 一个/ 平衡/ 状态/ ,/ 即/ 异或/ 和/ 为/ 零/ 的/ 状态/ ,/ 则/ 我们/ 说/ 构造/ 了/ 一个/ 积分/ 区分/ 器/ ./ 最后/ 利用/ 猜测/ 密钥/ 进行/ 部分/ 解密/ 来/ 恢复/ 密钥/ ./ 2.2/ 高阶差分/ 攻击/ 高阶差分/ 攻击/ 的/ 理论/ 基础/ 为/ 密码/ 函数/ 的/ 高阶微分/ 的/ 定义/ 及/ 性质/ ./ 1994/ 年/ ,/ Lai/ [/ 4/ ]/ 给出/ 了/ 密码/ 函数/ 微分/ 的/ 定义/ ./ 定义/ 1/ ./ 设/ P/ 为/ 一个/ Fn/ 的/ a/ ∈/ Fn/ 而/ P/ 在/ 点/ a1/ ,/ a2/ ,/ …/ ,/ ai/ 处/ 的/ i/ 阶/ 微分/ 定义/ 为/ Da1/ ,/ a2/ ,/ …/ ,/ aiP/ (/ x/ )/ =/ Dai/ (/ Dai/ -/ 1/ (/ …/ Da1P/ (/ x/ )/ )/ )/ 一个/ 函数/ 的/ 一阶/ 微分/ 的/ 代数/ 次数/ 有/ 性质/ deg/ (/ DaP/ (/ x/ )/ )/ / degP/ (/ x/ )/ -/ 1/ ./ 所以/ ,/ 对于/ 任意/ 的/ (/ degP/ +/ 1/ )/ 维的子/ 空间/ V/ ,/ 或者/ 是/ 任意/ 的/ (/ degP/ +/ 1/ )/ 个点/ a1/ ,/ a2/ ,/ …/ ,/ adegP/ +/ 1/ ,/ 置换/ P/ 的/ (/ degP/ +/ 1/ )/ 阶/ 微分/ 为/ 零/ ./ 高阶差分/ 攻击/ 就是/ 利用/ 这些/ 性质/ ,/ 首先/ 计算所/ 攻击/ 函数/ 的/ 代数/ 次数/ 的/ 上界/ d/ ,/ 然后/ 选择/ d/ +/ 1/ 个/ 比特/ 作为/ 活跃/ 比特/ ,/ 取定/ 其它/ 比特/ 的/ 值/ ,/ 遍历/ 这些/ 活跃/ 比特/ 的/ 所有/ 值/ ,/ 则/ 可以/ 在/ 函数/ 输出/ 端/ 得到/ 平衡/ 状态/ ,/ 即/ 构造/ 了/ 一个/ 高阶差分/ 区分/ 器/ ./ 2009/ 年/ ,/ Aumasson/ 等/ 人/ 利用/ 高阶差分/ 的/ 思想/ ,/ 构造/ 了/ 杂凑/ 函数/ KEC/ -/ CAK/ 、/ Luffa/ 和/ Hamsi/ 的/ “/ 零/ 和/ 区分/ 器/ ”/ ./ 这种/ 区分/ 器/ 从/ 中间/ 起始/ 向/ 两边/ 构造/ 高阶差分/ 路径/ ,/ 最后/ 在/ 两端/ 得到/ 平衡/ 状态/ ./ 本文/ 中/ 积分/ 攻击/ 和/ 高阶差分/ 攻击/ 中/ 的/ 平衡/ 状态/ 指/ 的/ 都/ 是/ “/ 异或/ 和/ 为/ 零/ ”/ 的/ 状态/ ;/ 活跃/ 字节/ 和/ 活跃/ 比特/ 都/ 是/ 指/ 攻击/ 的/ 时候/ 需要/ 遍历/ 的/ 字节/ 和/ 比特/ ./ 3/ 算法/ 简述/ 3.1/ AES/ 和/ Rijndael/ -/ 256/ 算法/ 简述/ AES/ 分组/ 密码/ 算法/ 是/ 美国/ 于/ 2001/ 年/ 颁布/ 的/ 高级/ 加密/ 标准/ ,/ 分组/ 长度/ 为/ 128/ 比特/ ,/ 密钥/ 长度/ 分别/ 为/ 128/ 、/ 192/ 和/ 256/ 比特/ ,/ 对应/ 这/ 3/ 种/ 长度/ 的/ 密钥/ ,/ 加密/ 过程/ 分别/ 有/ 10/ 、/ 12/ 和/ 14/ 轮/ ./ AES/ 的/ 状态/ 基于/ 字节/ 可以/ 写成/ 一个/ 4/ ×/ 4/ 的/ 矩阵/ Page3/ 其中/ 下标/ 对/ 应该/ 字节/ 所在/ 的/ 行和列/ 的/ 位置/ ./ 下文/ 我/ i/ ,/ k/ 来/ 表示/ 第/ j/ 轮/ 的/ 输入/ 状态/ 中/ 第/ i/ +/ 1/ 行第们/ 用/ a/ (/ j/ )/ k/ +/ 1/ 列/ 的/ 字节/ ,/ 此外/ ,/ 我们/ 用/ b/ (/ j/ )/ 输出/ 状态/ 中/ 第/ i/ +/ 1/ 行第/ k/ +/ 1/ 列/ 的/ 字节/ ./ AES/ 的/ 轮/ 函数/ 有/ 4/ 个/ 运算/ :/ (/ 1/ )/ 字节/ 代换/ (/ SubBytes/ )/ :/ 状态/ 中/ 的/ 每/ 一个/ 字节/ 通过/ 同一个/ 8/ ×/ 8/ 的/ S/ 盒层/ ,/ 图中/ 简记/ 为/ SB/ ./ (/ 2/ )/ 行/ 移位/ (/ ShiftRows/ )/ :/ 第/ i/ 行以/ 字节/ 为/ 单位/ ,/ 向/ 左/ 循环/ 移动/ i/ -/ 1/ 个/ 位置/ ,/ 图中/ 简记/ 为/ SR/ ./ (/ 3/ )/ 列/ 混淆/ (/ MixColumns/ )/ :/ 状态/ 的/ 每/ 一列/ 乘/ 上/ 一个/ MDS/ (/ MaximumDistanceSeparable/ )/ 矩阵/ ,/ 图中/ 简记/ 为/ MC/ ./ (/ 4/ )/ 轮/ 密钥/ 加/ (/ AddRoundKey/ )/ :/ 中间状态/ 和/ 轮子/ 密钥/ 进行/ 异或/ ,/ 图中/ 简记/ 为/ AK/ ./ 此外/ ,/ 在/ 第/ 1/ 轮/ 加密/ 之前/ ,/ 有/ 一个/ 轮/ 密钥/ 加层/ ;/ 最后/ 一轮/ 没有/ 列/ 混淆/ 层/ ./ Rijndael/ -/ 256/ [/ 10/ ]/ 是/ AES/ 的/ 前身/ Rijndael/ 分组/ 密码/ 算法/ 的/ 一个/ 版本/ ,/ 它/ 的/ 分组/ 长度/ 为/ 256/ 比特/ ,/ 密钥/ 长度/ 也/ 是/ 256/ 比特/ ,/ 轮数/ 为/ 14/ 轮/ ./ 基于/ 字节/ 其/ 状态/ 可以/ 记/ 为/ 一个/ 4/ ×/ 8/ 的/ 矩阵/ a0/ ,/ 0a0/ ,/ 1a0/ ,/ 2a0/ ,/ 3a0/ ,/ 4a0/ ,/ 5a0/ ,/ 6a0/ ,/ 7/ 烄/ a1/ ,/ 0a1/ ,/ 1a1/ ,/ 2a1/ ,/ 3a1/ ,/ 4a1/ ,/ 5a1/ ,/ 6a1/ ,/ 7a2/ ,/ 0a2/ ,/ 1a2/ ,/ 2a2/ ,/ 3a2/ ,/ 4a2/ ,/ 5a2/ ,/ 6a2/ ,/ 7a3/ ,/ 0a3/ ,/ 1a3/ ,/ 2a3/ ,/ 3a3/ ,/ 4a3/ ,/ 5a3/ ,/ 6a3/ ,/ 烆/ Rijndael/ -/ 256/ 的/ 轮/ 函数/ 与/ AES/ 类似/ ,/ 需要/ 说明/ 的/ 是/ ,/ 行/ 移位/ 运算/ 为/ ,/ 以/ 字节/ 为/ 单位/ ,/ 第/ 1/ 、/ 2/ 、/ 3/ 、/ 4/ 行/ 分别/ 向/ 左/ 循环/ 移动/ 0/ 、/ 1/ 、/ 3/ 、/ 4/ 个/ 位置/ ./ 下文/ 表示/ 中间状态/ 的/ 时候/ ,/ 我们/ 用/ 矩形/ 表示/ 代替/ 矩阵/ 表示/ ,/ 字节/ 的/ 表示/ 方法/ 不变/ ./ 本文/ 没有/ 涉及/ AES/ 和/ Rijndael/ -/ 256/ 的/ 密钥/ 生成/ 算法/ ,/ 详细描述/ 请/ 参考文献/ [/ 1/ ,/ 10/ ]/ ./ 3.2/ SPONGENT/ -/ 88/ // 80/ // 8/ 算法/ 简述/ SPONGENT/ 是/ 在/ CHES2011/ 会议/ 上/ 提出/ 的/ 一个/ 新/ 的/ 轻量级/ 杂凑/ 函数/ ./ 它/ 采用/ 了/ 海绵/ 结构/ ,/ 其中/ 中间/ 置换/ 又/ 应用/ 了/ PRESENT/ [/ 11/ ]/ 类型/ 的/ 置换/ ./ 海绵/ 结构/ 是/ 一种/ 由/ 固定/ 置换/ 构建/ 杂凑/ 函数/ 的/ 新/ 选择/ ,/ 它/ 分为/ “/ 吸收/ ”/ 和/ “/ 榨取/ ”/ 两个/ 部分/ ./ 吸收/ 部分/ 每次/ 将/ r/ 比特/ 消息/ 块/ 异或/ 在/ 状态/ 前/ r/ 比特/ 上/ ,/ 然后/ 进入/ 一个/ 大小/ 为/ b/ 比特/ 固定/ 置换/ ,/ 直到/ 处理/ 完/ 所有/ 的/ 消息/ ./ 接着/ 便/ 进入/ 榨取/ 部分/ ,/ 每次/ 在/ 将/ 状态/ 的/ 前/ r/ 比特/ 输出/ 之后/ ,/ 再/ 进入/ 同样/ 的/ 固定/ 置换/ ,/ 直到/ 输出/ 比特/ 的/ 长度/ 达到/ 摘要/ 的/ 长度/ n/ ./ SPONGENT/ 使用/ 一种/ 类似/ 轻量级/ 分组/ 密码/ PRESENT/ 的/ 函数/ 作为/ 中间/ 置换/ ,/ 此/ 置换/ 应用/ 于/ b/ 比特/ 的/ 中间状态/ ./ 轮/ 函数/ 包含/ 3/ 个/ 运算/ :/ (/ 1/ )/ S/ 盒层/ (/ sBoxLayer/ )/ :/ 每/ 4/ 个/ 比特/ 进入/ 同样/ 的/ 4/ ×/ 4/ 的/ S/ 盒/ ./ (/ 2/ )/ 比特/ 置换/ 层/ (/ pLayer/ )/ :/ 相当于/ PRESENT/ 的/ 比特/ 置换/ 的/ 逆向/ 扩展/ ,/ 它/ 将/ 状态/ 的/ 第/ j/ 比特/ 移动/ 到/ 第/ Pb/ (/ j/ )/ 比特/ ,/ 其中/ Pb/ (/ j/ )/ =/ j/ ×/ b/ // 4mod/ (/ b/ -/ 1/ )/ ,/ j/ ∈/ {/ 0/ ,/ …/ ,/ b/ -/ 2/ }/ (/ 3/ )/ 轮/ 常数/ 加层/ (/ lCounter/ )/ :/ 状态/ 的/ 某些/ 比/ 特异/ 或/ 上/ 轮/ 常数/ ./ SPONGENT/ -/ 88/ // 80/ // 8/ 是/ SPONGENT/ 杂凑/ 函数/ 的/ 一个/ 版本/ ,/ 它/ 每次/ 吸收/ 或者/ 榨取/ 的/ 比特/ 数为/ 8/ ,/ 置换/ 的/ 大小/ 为/ 80/ +/ 8/ =/ 88/ 比特/ ,/ 置换/ 所/ 含/ 轮数/ 为/ 45/ ,/ 摘要/ 长度/ 也/ 是/ 88/ 比特/ ./ 有关/ 此/ 算法/ 的/ 更/ 多/ 信息/ 请/ 参考文献/ [/ 9/ ]/ ./ 4/ 基础知识/ 为了/ 更好/ 地/ 将/ 积分/ 攻击/ 和/ 高阶差分/ 攻击/ 联系/ 起来/ ,/ 本/ 节/ 我们/ 讨论/ 一些/ 常见/ 函数/ 的/ 代数/ 次数/ 具备/ 的/ 性质/ ./ 我们/ 记/ n/ 元/ 布尔/ 函数/ f/ (/ x/ )/ 为/ Fn/ 函数/ ,/ 其中/ x/ 为/ n/ 元/ 自变量/ x/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ ./ 使得/ f/ (/ x/ )/ =/ 1/ 的/ x/ 的/ 个数/ 称为/ f/ (/ x/ )/ 的/ 汉明/ 重量/ ,/ 记为/ WH/ (/ f/ )/ ./ 特别/ 地/ ,/ 如果/ WH/ (/ f/ )/ =/ 2n/ -/ 1/ ,/ 我们/ 称/ f/ (/ x/ )/ 为/ 平衡/ 布尔/ 函数/ ./ 布尔/ 函数/ 有/ 多种/ 表示/ 方式/ ,/ 其中/ 常用/ 的/ 一种/ 为/ 多项式/ 表示/ ./ 我们/ 常常/ 将/ 变元/ 升幂/ 并且/ 下标/ 按/ 字典/ 序/ 写出/ 的/ 多项式/ 表达式/ f/ (/ x/ )/ =/ a0/ +/ a1x1/ +/ a2x2/ +/ …/ +/ anxn/ +/ a12x1x2/ +/ …/ +/ 称为/ f/ (/ x/ )/ 的/ 代数/ 正规/ 型/ ./ 布尔/ 函数/ f/ (/ x/ )/ 的/ 代数/ 次数/ 定义/ 为/ 其/ 代数/ 正规/ 型/ 中/ 具有/ 非零/ 系数/ 的/ 乘积/ 项中/ 的/ 最大/ 次数/ ,/ 而/ 一个/ 乘积/ 项/ 的/ 次数/ 定义/ 为/ 此项/ 所含/ 的/ 变元/ 的/ 个数/ ./ 不/ 影响/ 理解/ 的/ 情况/ 下/ ,/ 代数/ 次数/ 有时/ 简称/ 为/ 次数/ ./ 我们/ 称/ Fn/ 布尔/ 函数/ ,/ 其中/ x/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ ∈/ Fn/ (/ f1/ (/ x/ )/ ,/ f2/ (/ x/ )/ ,/ …/ ,/ fm/ (/ x/ )/ )/ =/ (/ y1/ ,/ y2/ ,/ …/ ,/ ym/ )/ ∈/ Fm/ 向量/ 布尔/ 函数/ 的/ 每/ 一个/ 分量/ fi/ (/ x/ )/ 都/ 是/ 一个/ 布尔/ 函数/ ./ 若/ 向量/ 布尔/ 函数/ 像/ 集中/ 的/ 每/ 一个/ 元素/ 的/ 原像/ 个数/ 都/ 相同/ ,/ 则/ 称/ 其/ 为/ 平衡/ 向量/ 布尔/ 函数/ ./ 首先/ 我们/ 给出/ 一个/ 已知/ 的/ 结论/ ./ 数/ ,/ 若/ 它/ 的/ 汉明/ 重量/ WH/ (/ f/ )/ 为/ 偶数/ ,/ 则/ 其/ 代数/ 正规/ 型/ 无/ 最高/ 次项/ ./ 特别/ 地/ ,/ 平衡/ 布尔/ 函数/ 没有/ 最高/ 次项/ ./ 引理/ 1/ [/ 12/ ]/ ./ 设/ f/ (/ x/ )/ 为/ FnPage4/ 证明/ ./ 易知/ f/ (/ x/ )/ 代数/ 正规/ 型/ 的/ 最高/ 次项/ 系数/ a12/ …/ n/ =/ ∑/ x/ ∈/ Fn/ 这里/ 求和/ 为/ 实数/ 求和/ ,/ 则/ a12/ …/ n/ =/ 0/ 当且/ 仅/ 当/ WH/ (/ f/ )/ 为/ 偶数/ ,/ 即/ 最高/ 次项/ 不/ 出现/ ./ 引理/ 1/ 的/ 详细/ 说明/ 请/ 参看/ 文献/ [/ 12/ ]/ ./ 我们/ 将/ 此/ 结果/ 扩展/ 至/ 向量/ 布尔/ 函数/ 的/ 情况/ ./ 定理/ 1/ ./ 设/ F/ 为/ Fn/ 数/ ,/ 其中/ n/ / m/ ,/ 则/ F/ 的/ 每个/ 分量/ fi/ (/ x/ )/ 的/ 代数/ 次数/ 至多/ 为/ n/ -/ 1/ ./ 证明/ ./ 由/ F/ 为/ 平衡/ 向量/ 布尔/ 函数/ 知/ ,/ F/ 的/ 像/ 2/ 中/ 的/ 每/ 一个/ 元素/ 均/ 有/ 2n/ -/ m/ 个/ 原像/ ./ 考虑/ 其中/ 集/ Fm/ 任/ 一个/ 分量/ fi/ (/ x/ )/ ,/ Fm1/ ,/ 所以/ 使得/ fi/ (/ x/ )/ =/ 1/ 的/ x/ 的/ 个数/ 为/ 2n/ -/ m/ ×/ 2m/ -/ 1/ =/ 2n/ -/ 1/ ,/ 即/ fi/ (/ x/ )/ 为/ 平衡/ 布尔/ 函数/ ./ 由/ 引理/ 1/ ,/ 其/ 次数/ 至多/ 为/ n/ -/ 1/ ./ 利用/ 定理/ 1/ 我们/ 可以/ 对/ 一些/ 向量/ 布尔/ 函数/ 进行/ 分析/ ./ 有时/ 从/ 一个/ 函数/ 的/ 局部/ 入手/ ,/ 反推/ 至/ 整个/ 函数/ ,/ 可以/ 得到/ 更好/ 的/ 结果/ ./ 我们/ 考虑/ F/ 为/ Fn/ 向量/ 布尔/ 函数/ ./ 对/ 其/ n/ 元/ 自变量/ x/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ 中/ 的/ 某/ n/ -/ t/ 个/ 变元取/ 常值/ ,/ 剩下/ 的/ t/ 个/ 变元/ 仍/ 为/ 变量/ ,/ 新/ 的/ t/ 元/ 自变量/ 记为/ 珟/ x/ ./ 并/ 考察/ 其像/ (/ f1/ (/ 珟/ x/ )/ ,/ f2/ (/ 珟/ x/ )/ ,/ …/ ,/ fm/ (/ 珟/ x/ )/ )/ 中/ 的/ t/ 个/ 分量/ ,/ 则/ 每个/ 分量/ 都/ 变成/ 一个/ t/ 元/ 布尔/ 函数/ ,/ 将/ 它们/ 仍/ 按照/ 原来/ 的/ 顺序/ 写成/ 向量/ 的/ 形式/ (/ f1/ (/ 珟/ x/ )/ ,/ f2/ (/ 珟/ x/ )/ ,/ …/ ,/ ft/ (/ 珟/ x/ )/ )/ ,/ 便/ 构成/ 了/ 一个/ Ft/ 部/ 向量/ 布尔/ 函数/ ,/ 记为/ F/ ./ 我们/ 从/ 其/ 局部/ 的/ 向量/ 布尔/ 函数/ F/ 入手/ 进行/ 分析/ ,/ 再/ 进行/ 变量/ 扩充/ ,/ 可以/ 得到/ 下面/ 的/ 结果/ ./ 果/ 对于/ 选定/ 的/ n/ -/ t/ 个/ 变元取/ 任意/ 常值/ ,/ 并/ 考察/ 其像/ 的/ 特定/ 的/ t/ 个/ 分量/ ,/ 所得/ 的/ Ft/ 函数/ F/ 均/ 是/ 平衡/ 的/ ,/ 则/ 定理/ 2/ ./ 设/ F/ 为/ Fn/ (/ 1/ )/ 其/ 每个/ 分量/ 的/ 代数/ 次数/ 至多是/ t/ -/ 1/ ./ (/ 2/ )/ 将/ 其它/ 任意/ s/ -/ t/ 个/ 常值/ 比特/ 重新/ 取为/ 变量/ ,/ 将/ 其/ 扩充/ 为/ 一个/ Fs/ 每个/ 分量/ 的/ 代数/ 次数/ 至多/ 为/ s/ -/ 1/ ./ 证明/ ./ F/ 为/ 平衡/ 向量/ 布尔/ 函数/ ,/ 由/ 定理/ 1/ 可知/ 其/ 每个/ 分量/ 的/ 代数/ 次数/ 至多/ 为/ t/ -/ 1/ ./ 若/ 其/ 扩充/ 的/ 函数/ F/ 中/ 某个/ 分量/ 的/ 代数/ 次数/ 达到/ s/ ,/ 即/ 其/ 代数/ 正规/ 型/ 中/ 最高/ 次/ s/ 次项/ 的/ 系数/ 为/ 1/ ,/ 将/ 重新/ 取为/ 变量/ 的/ s/ -/ t/ 个/ 比特/ 全部/ 取/ 1/ ,/ 则/ 可得/ 一个/ 新/ 的/ 对于/ 选定/ 的/ n/ -/ t/ 个/ 变元取/ 常值/ ,/ 并/ 考察/ 其像/ 的/ 特定/ 的/ t/ 个/ 分量/ 的/ Ft/ 数/ ,/ 并且/ 此/ 函数/ 有/ 一个/ 分量/ 存在/ 最高/ 次/ s/ 次项/ ,/ 则/ 其/ 不是/ 平衡/ 的/ ,/ 与/ 已知/ 矛盾/ ./ 故/ 扩充/ 函数/ 每个/ 分量/ 的/ 代数/ 次数/ 至多/ 为/ s/ -/ 1/ ./ 一般/ 的/ 分组/ 密码/ 和/ 杂凑/ 函数/ 都/ 是/ 基于/ 置换/ 构造/ ,/ 并且/ 都/ 是/ 相似/ 置换/ 的/ 迭代/ 组成/ ./ 但是/ ,/ 对于/ 局部/ 进行/ 分析/ ,/ 并非/ 都/ 是/ 置换/ ,/ 所以/ 关键/ 之/ 处/ 在于/ 找到/ 局部/ 到/ 局部/ 的/ 置换/ ,/ 或者/ 是/ 平衡/ 函数/ ./ 根据/ 这个/ 定理/ 2/ ,/ 如果/ 我们/ 可以/ 证明/ 状态/ 的/ 局部/ (/ 例如/ 一个/ 字节/ )/ 到/ 后面/ 某/ 状态/ 的/ 局部/ 是/ 一个/ 平衡/ 函数/ 或者/ 是/ 双射/ 的话/ ,/ 那么/ 令/ “/ 始/ 状态/ ”/ 的/ 这个/ 局部/ 的/ 所有/ 比特/ 为/ 变量/ ,/ 状态/ 的/ 其它/ 比特/ 为/ 常数/ ,/ “/ 末/ 状态/ ”/ 的/ 这个/ 局部/ 的/ 代数/ 次数/ ,/ 一定/ 小于/ “/ 始/ 状态/ ”/ 的/ 这个/ 局部/ 的/ 比特/ 数/ ./ 5/ 用/ 高阶差分/ 解释/ 已有/ 的/ 积分/ 区分/ 器本节/ 我们/ 利用/ 代数/ 次数/ 的/ 变化规律/ 解释/ 一些/ 经典/ 的/ 积分/ 区分/ 器/ ,/ 分别/ 对/ AES/ 的/ 3/ 轮/ 积分/ 区分/ 器/ 、/ Rijndael/ -/ 256/ 的/ 4/ 轮/ 积分/ 区分/ 器/ 给出/ 高阶差分/ 解释/ ./ 5.1/ 解释/ AES/ 的/ 3/ 轮/ 积分/ 区分/ 器/ Daemen/ 和/ Rijmen/ 在/ 提交/ 他们/ 设计/ 的/ AES/ 候选/ 算法/ 时/ ,/ 给出/ 了/ 所/ 提交/ 算法/ 的/ Square/ 攻击/ 过程/ ,/ 此/ 攻击/ 也/ 可/ 看做/ 是/ AES/ 的/ 积分/ 攻击/ ./ AES/ 的/ 3/ 轮/ 积分/ 区分/ 器如图/ 1/ 所示/ ./ 在/ 明文/ 状态/ 取遍/ 一个/ 字节/ 的/ 256/ 个值/ ,/ 其它/ 字节/ 取/ 常数/ ,/ 到/ 第/ 3/ 轮/ 结尾/ 得到/ 一个/ 平衡/ 状态/ ,/ 路径/ 的/ 推导/ 细节/ 请/ 参看/ 文献/ [/ 10/ ]/ ./ 而/ 我们/ 也/ 可以/ 从/ 高阶差分/ 的/ 角度/ ,/ 利用/ 对/ 代数/ 次数/ 的/ 分析/ ,/ 得到/ 这个/ “/ 0/ -/ 和/ ”/ 路径/ ,/ 如图/ 2/ 所示/ ,/ 方框/ 中/ 数字/ 代表/ 此/ 字节/ 中/ 所有/ 比特/ 的/ 代数/ 次数/ 上/ 界/ ,/ 空白/ 方框/ 代表/ 每个/ 比特/ 代数/ 次数/ 均/ 为/ 零/ 的/ 字节/ ./ Page5/ 现在/ 我们/ 给出/ AES/ 的/ 3/ 轮/ 积分/ 区分/ 器/ 的/ 高阶差分/ 路径/ :/ (/ 1/ )/ 起始/ 状态/ ./ 取/ a/ (/ 1/ )/ x1/ ,/ x2/ ,/ …/ ,/ x8/ ,/ 其它/ 字节/ 任取/ 为/ 常数/ ./ 起始/ 状态/ 中此/ 字节/ 的/ 每个/ 比特/ 代数/ 次数/ 为/ 1/ ,/ 其它/ 常数/ 比特/ 的/ 代数/ 次数/ 为/ 0/ ./ (/ 2/ )/ 第/ 1/ 轮/ ./ 经过/ 第/ 1/ 轮/ S/ 盒/ 以后/ ,/ b/ (/ 1/ )/ 特/ 代数/ 次数/ 为/ 7/ ,/ 其它/ 仍为/ 0/ ./ 经过/ 行/ 移位/ 不变/ ./ 经过/ 列/ 混淆/ 后/ 第/ 1/ 列/ 的/ 32/ 个/ 比特/ 的/ 代数/ 次数/ 都/ 变为/ 7/ ./ 加上/ 轮/ 密钥/ 后/ 保持/ 不变/ ./ (/ 3/ )/ 第/ 2/ 轮/ ./ a/ (/ 1/ )/ 0/ ,/ 0/ ,/ b/ (/ 2/ )/ 节/ b/ (/ 2/ )/ 0/ ,/ 0/ 处/ 引入/ 任何/ 一个/ 非零/ 差分/ ,/ 则/ 其/ 可以/ 扩散/ 到/ 第/ 1a/ (/ 1/ )/ 轮/ 输出/ 状态/ 第/ 1/ 列/ 的/ 每个/ 字节/ ,/ 所以/ ,/ b/ (/ 2/ )/ 必然/ 不为/ 零/ ,/ 即/ a/ (/ 1/ )/ 取值/ ,/ 逆向/ 计算/ 都/ 有/ 一个/ a/ (/ 1/ )/ 0/ ,/ 0/ 也/ 是/ 一个/ 满射/ ,/ 所以/ 为/ 双射/ ,/ 即/ 置换/ ./ 由/ 定理/ 1/ 到/ b/ (/ 2/ )/ 可知/ ,/ 第/ 2/ 轮/ S/ 盒层/ 输出/ 状态/ 第/ 1/ 列/ 的/ 每/ 一个/ 字节/ ,/ 所/ 含/ 比特/ 的/ 代数/ 次数/ 上界/ 仍/ 为/ 7/ ./ 经过/ 后面/ 的/ 3/ 个/ 线性/ 运算/ ,/ 可得/ 第/ 2/ 轮/ 输出/ 状态/ 的/ 每/ 一个/ 比特/ 的/ 代数/ 次数/ 也/ 都/ 不/ 高于/ 7/ ./ (/ 4/ )/ 第/ 3/ 轮/ ./ 同样/ ,/ 我们/ 可以/ 用/ 相似/ 的/ 证明/ 过程/ 证明/ a/ (/ 1/ )/ 0/ ,/ 0/ 到/ 第/ 3/ 轮/ 的/ S/ 盒层/ 输出/ 状态/ 的/ 每/ 一个/ 字节/ 也/ 都/ 是/ 置换/ ./ 则/ 此/ 状态/ 的/ 每个/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 7/ ./ 由此/ 推/ 得/ ,/ 第/ 3/ 轮/ 结束/ 时/ 每个/ 比特/ 的/ 代数/ 次数/ 都/ 至多/ 为/ 7/ ./ 这样/ ,/ 取定/ 起始/ 状态/ 中/ a/ (/ 1/ )/ 0/ ,/ 0/ 所有/ 值/ ,/ 会/ 在/ 第/ 3/ 轮/ 结尾/ 得到/ 平衡/ 状态/ ./ a/ (/ 1/ )/ 5.2/ 解释/ Rijndael/ -/ 256/ 的/ 4/ 轮/ 积分/ 区分/ 器/ 在/ 2008/ 年/ 的/ 非密/ 会上/ ,/ Galice/ 和/ Minier/ 给出/ 了/ Rijndael/ -/ 256/ 的/ 4/ 轮/ 积分/ 区分/ 器/ [/ 6/ ]/ ,/ 如图/ 3/ 所示/ ,/ 图/ 4Rijndael/ -/ 256/ 的/ 4/ 轮/ 单字节/ 起始/ 代数/ 次数/ 增加/ 情况/ 利用/ 此/ 区分/ 器/ ,/ 最/ 多/ 可以/ 攻击/ 9/ 轮/ 的/ Rijndael/ -/ 256/ 算法/ ./ Rijndael/ -/ 256/ 的/ 4/ 轮/ 积分/ 区分/ 器/ 应用/ 3/ 阶/ 积分/ ,/ 即/ 在/ 起始/ 状态/ 选择/ 3/ 个/ 字节/ ,/ 取遍/ 这/ 3/ 个/ 字节/ 的/ 所有/ 224/ 个值/ ,/ 其它/ 字节/ 任取/ 为/ 定值/ ./ 可以/ 推得/ 第/ 4/ 轮/ 的/ 输出/ 状态/ 的/ 第/ 3/ 列/ 和/ 第/ 7/ 列共/ 8/ 个/ 字节/ 是/ 平衡/ 的/ ./ 路径/ 的/ 推导/ 细节/ 请/ 参看/ 文献/ [/ 6/ ]/ ./ 同样/ ,/ 我们/ 可以/ 用/ 高阶差分/ 的/ 视角/ 来/ 解释/ 这/ 条/ 路径/ ./ 我们/ 首先/ 对/ 单字节/ 8/ 个/ 比特/ 变量/ 代数/ 次数/ 增加/ 情况/ 进行/ 分析/ ,/ 然后/ 利用/ 单字节/ 代数/ 次数/ 的/ 增加/ 性质/ ,/ 推导/ 出/ 3/ 个/ 字节/ 24/ 个/ 比特/ 作为/ 变量/ ,/ 在/ 4/ 轮/ 结束/ 时/ ,/ 状态/ 中/ 所有/ 字节/ 的/ 代数/ 次数/ 的/ 上界/ ./ 图/ 4/ 为/ 选择/ 字节/ a/ (/ 1/ )/ 情况/ ./ 方框/ 中/ 数字/ 代表/ 此/ 字节/ 中/ 所有/ 比特/ 的/ 代数/ 次/ Page6/ 数上界/ ,/ 空白/ 方框/ 代表/ 每个/ 比特/ 代数/ 次数/ 均/ 为/ 零/ 的/ 字节/ ./ 差分/ 路径/ :/ 首先/ 我们/ 给出/ 单字节/ 8/ 个/ 比特/ 变量/ 的/ 4/ 轮/ 高阶/ (/ 1/ )/ 起始/ 状态/ ./ 取/ a/ (/ 1/ )/ (/ 3/ )/ 第/ 3/ 轮/ ./ 类似/ 地/ ,/ 我们/ 可以/ 推知/ a/ (/ 1/ )/ 字节/ 任取/ 为/ 常数/ ./ 起始/ 状态/ 中此/ 字节/ 的/ 每个/ 比特/ 代数/ 次数/ 为/ 1/ ,/ 其它/ 常数/ 比特/ 的/ 代数/ 次数/ 为/ 0/ ./ (/ 2/ )/ 第/ 1/ 轮/ 和/ 第/ 2/ 轮/ ./ 前/ 两轮/ 的/ 分析/ 和/ AES/ 类/ 0/ ,/ 0/ 的/ 8/ 个/ 比特/ 变量/ 在/ 第/ 2/ 轮/ 结束/ 时/ ,/ 使得/ 状态/ 似/ ./ a/ (/ 1/ )/ 的/ 第/ 1/ 、/ 5/ 、/ 6/ 、/ 8/ 列/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 7/ ,/ 而/ 其它/ 字节/ 的/ 所有/ 比特/ 均/ 为/ 常值/ ./ 轮/ S/ 盒层/ 的/ 输出/ 状态/ 的/ 第/ 1/ 、/ 5/ 、/ 6/ 、/ 8/ 列/ 的/ 每个/ 字节/ 都/ 是/ 置换/ ./ 由/ 定理/ 1/ ,/ 这些/ 字节/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 7/ ./ 我们/ 注意/ 到/ ,/ 在/ 第/ 3/ 轮/ 的/ 列/ 混淆/ 层/ 输入/ 中/ ,/ 第/ 3/ 列/ 和/ 第/ 7/ 列/ 都/ 只有/ 一个/ 字节/ 含有/ 变量/ ,/ 所以/ a/ (/ 1/ )/ 到/ 第/ 3/ 轮/ 输出/ 状态/ 的/ 第/ 3/ 列/ 和/ 第/ 7/ 列中/ 每个/ 字节/ 都/ 是/ 置换/ ,/ 这个/ 性质/ 可以/ 延伸/ 到/ 第/ 4/ 轮/ 的/ S/ 盒层/ 之后/ ./ (/ 4/ )/ 第/ 4/ 轮/ ./ 由/ 上面/ 第/ 3/ 轮/ 的/ 推导/ 可以/ 得出/ ,/ a/ (/ 1/ )/ 到/ 第/ 4/ 轮中/ S/ 盒层/ 输出/ 状态/ 的/ 第/ 3/ 列/ 和/ 第/ 7/ 列/ 的/ 每个/ 字节/ 都/ 是/ 置换/ ,/ 所以/ 这/ 8/ 个/ 字节/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 7/ ,/ 而/ 其余/ 的/ 字节/ 所/ 含/ 比特/ 没有/ 此/ 性质/ ,/ 但是/ 由于/ 只有/ 8/ 个/ 变量/ ,/ 所以/ 其余/ 字节/ 所/ 含/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 8/ ./ 由图/ 4/ 我们/ 可以/ 看到/ ,/ 从/ 一个/ 活跃/ 字节/ 出发/ ,/ 无法/ 得出/ 第/ 4/ 轮/ 输出/ 状态/ 的/ 某些/ 图/ 5Rijndael/ -/ 256/ 的/ 4/ 轮/ 区分/ 器/ 的/ 最后/ 3/ 个/ 运算/ 根据上述/ 结论/ ,/ 我们/ 可以/ 同时/ 选择/ 4/ 个/ 字节/ ,/ 使得/ 第/ 4/ 轮/ 输出/ 状态/ 全部/ 比特/ 的/ 代数/ 次数/ 都/ 达/ 不到/ 最大/ 的/ 32/ ./ 这样/ 我们/ 可以/ 以/ 232/ 的/ 复杂度/ 得到/ 4/ 轮/ 的/ “/ 完全/ ”/ 平衡/ 状态/ ,/ 而/ 不是/ 只有/ 两列/ 平衡/ ./ 事实上/ ,/ 我们/ 选择/ a/ (/ 1/ )/ 即可/ ./ 6/ 用/ 高阶差分/ 改进/ 积分/ 区分/ 器/ 2011/ 年/ ,/ Wei/ 等/ 人/ 利用/ 比/ 特级/ 积分/ 改进/ 了/ Rijndael/ -/ 256/ 基于/ 字节/ 的/ 积分/ 区分/ 器/ [/ 8/ ]/ ,/ 将/ 其/ 3/ 轮/ 积分/ 区分/ 器/ 的/ 数据/ 复杂度/ 从/ 28/ 降至/ 25/ ./ 此/ 区分/ 器/ 首先/ 选择/ a/ (/ 1/ )/ 比特/ ,/ 取定/ 其它/ 比特/ 的/ 值/ ,/ 遍历/ 这/ 5/ 个/ 比特/ 的/ 所有/ 0/ ,/ 0/ ,/ a/ (/ 1/ )/ 字节/ 平衡/ ,/ 但是/ 我们/ 得到/ 第/ 4/ 轮/ 的/ S/ 盒层/ 之后/ ,/ 有/ 两列/ 所/ 含/ 比特/ 的/ 代数/ 次数/ 都/ 没有/ 达到/ 最大/ 的/ 8/ 次/ ./ 由/ 上面/ 给出/ 的/ 单字节/ 4/ 轮/ 高阶差分/ 路径/ ,/ 如果/ 我们/ 选/ 起始/ 状态/ 中/ a/ (/ 1/ )/ 个/ 3.25/ 轮/ 的/ 区分/ 器/ ./ 利用/ 此/ 性质/ 我们/ 来/ 构造/ 3/ 个/ 字节/ 24/ 个/ 比特/ 变量/ 的/ 4/ 轮/ 高阶差分/ 路径/ :/ (/ 1/ )/ 与/ 上述/ 单字节/ 路径/ 类似/ ,/ 如果/ 在/ 起始/ 状态/ 中/ 选择/ a/ (/ 1/ )/ 轮/ S/ 盒层/ 之后/ 得到/ 第/ 4/ 列/ 和/ 第/ 8/ 列/ ,/ 或者/ 第/ 2/ 列/ 和/ 第/ 6/ 列/ 所有/ 比特/ 的/ 代数/ 次数/ 达/ 不到/ 最大/ 的/ 8/ 次/ ./ (/ 2/ )/ 如果/ 我们/ 同时/ 选择/ 这/ 3/ 个/ 字节/ 所含/ 的/ 24/ 个/ 比特/ 为/ 变量/ ,/ 对于/ 图/ 4/ 所示/ 的/ 单字节/ 起始/ 路径/ 来说/ ,/ 相当于/ 将/ a/ (/ 1/ )/ 变量/ ./ 由/ 定理/ 2/ 可得/ ,/ 第/ 4/ 轮中/ S/ 盒层/ 输出/ 状态/ 的/ 第/ 3/ 列/ 和/ 第/ 7/ 列/ ,/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不会/ 超过/ 23/ ./ 分别/ 由/ a/ (/ 1/ )/ 用/ 相似/ 的/ 过程/ 得到/ 此/ 状态/ 的/ 第/ 2/ 、/ 4/ 、/ 6/ 、/ 8/ 列/ 所有/ 比特/ 的/ 代数/ 次数/ 也/ 至多/ 为/ 23/ ./ (/ 3/ )/ 容易/ 知道/ ,/ 经过/ 第/ 4/ 轮/ 的/ 行/ 移位/ 、/ 列/ 混淆/ 和/ 轮/ 密钥/ 加/ 运算/ ,/ 可得/ 第/ 4/ 轮/ 的/ 输出/ 状态/ 的/ 第/ 3/ 列/ 和/ 第/ 7/ 列/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 23/ ./ 如图/ 5/ 所示/ ./ 的/ 值/ ,/ 并/ 遍历/ 这/ 3/ 个/ 字节/ 的/ 所有/ 值/ ,/ 会/ 在/ 第/ 4/ 轮/ 结尾/ 得到/ 平衡/ 状态/ ./ 这样/ ,/ 取定/ 起始/ 状态/ 中/ a/ (/ 1/ )/ 1/ ,/ 0/ ,/ a/ (/ 1/ )/ 32/ 个值/ ,/ 则/ 可以/ 在/ 3/ 轮/ 之后/ 得到/ 一个/ 全/ 平衡/ 状态/ ./ 6.1/ 解释/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 比特/ 积分/ 区分/ 器/ 我们/ 可以/ 在/ 高阶差分/ 的/ 视角/ 下/ ,/ 利用/ 代数/ 次数/ 的/ 增加/ 情况/ 来/ 解释/ 这/ 条/ 路径/ ./ 如图/ 6/ 所示/ ,/ 设/ 字节/ 0/ ,/ 0/ ,/ a/ (/ 1/ )/ a/ (/ 1/ )/ x3/ ,/ x4/ ,/ x5/ ,/ 它们/ 在/ 区分/ 器中/ 是/ 要/ 遍历/ 的/ 活跃/ 比特/ ,/ 所以/ 在/ 研究/ 代数/ 次数/ 的/ 时候/ 以/ 变量/ 形式/ 出现/ ./ 图中/ 数字/ 代表/ 该/ 字节/ 所有/ 比特/ 代数/ 次数/ 上/ 界/ ,/ 下标/ 代表/ 该/ 字节/ 所有/ 比特/ 的/ 代数/ 正规/ 型/ 中/ 至多/ 包含/ 的/ 变量/ ./ 例如/ 1145/ 表示/ 该/ 字节/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 至多/ 为/ 1/ ,/ 并且/ 代数/ 正规/ 型/ 中/ 至多/ 可能/ 出现/ x1/ ,/ x4/ ,/ x5/ ,/ 换句话说/ ,/ 一定/ 不会/ 出现/ x2/ ,/ x3/ ./ 此外/ ,/ 为了/ 记法/ 的/ 方便/ ,/ 我们/ 采用/ 带/ 负号/ 的/ 下标/ ,/ 例如/ 1/ -/ 5/ 表示/ ,/ 代数/ 正规/ 型/ 中/ 一定/ 不会/ 出现/ x5/ ./ Page7/ 图/ 6Rijndael/ -/ 256/ 的/ 3/ 轮/ 5/ 阶/ 高阶差分/ 路径/ 我们/ 下面/ 给出/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 比特/ 起始/ 区分/ 器/ 的/ 代数/ 次数/ 增加/ 情况/ 说明/ :/ (/ 1/ )/ 第/ 1/ 轮/ ./ 起始/ 状态/ 中/ 含有/ 变量/ 的/ 字节/ 都/ 只有/ 一个/ 变量/ ,/ 这样/ 第/ 1/ 轮/ 的/ S/ 盒/ 实际上/ 可以/ 看作/ 是/ 一个/ 线性/ 运算/ ,/ 也就是说/ ,/ 在/ 第/ 1/ 轮/ S/ 盒/ 的/ 输出/ 状态/ 中/ ,/ 这/ 5/ 个/ 字节/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 至多是/ 1/ ./ 经过/ 后面/ 的/ 几个/ 线性/ 扩散/ 运算/ ,/ 在/ 第/ 1/ 轮/ 的/ 末端/ ,/ 有/ 5/ 列/ 都/ 含有/ 变量/ ,/ 但是/ 显然/ 代数/ 次数/ 仍然/ 至多/ 为/ 1/ ,/ 并且/ 含/ 变量/ 的/ 字节/ 仍然/ 只/ 含有/ 一个/ 变量/ ./ (/ 2/ )/ 第/ 2/ 轮/ ./ 由/ 上面/ 的/ 分析/ ,/ 第/ 2/ 轮/ 的/ 输入/ 状态/ 中/ 含有/ 变量/ 的/ 字节/ 都/ 只有/ 一个/ 变量/ 参与/ 运算/ ,/ 这样/ 其/ 输出/ 状态/ 中/ 的/ 代数/ 次数/ 仍然/ 至多/ 为/ 1/ ./ 经过/ 后面/ 的/ 线性/ 扩散/ 运算/ ,/ 会/ 使得/ 状态/ 的/ 每个/ 比特/ 都/ 可能/ 含有/ 变量/ ,/ 代数/ 次数/ 的/ 上界/ 仍然/ 为/ 1/ ,/ 但是/ ,/ 有些/ 比特/ 的/ 代数/ 正规/ 型/ 中/ ,/ 可能/ 会/ 含有/ 多个/ 变量/ ,/ 例如/ 第/ 1/ 列中/ 的/ 某些/ 比特/ 可能/ 会/ 同时/ 含有/ x1/ ,/ x4/ ,/ x5/ ./ 图/ 7Rijndael/ -/ 256/ 的/ 3/ 轮/ 3/ 阶/ 高阶差分/ 路径/ (/ 1/ )/ 起始/ 状态/ ./ 我们/ 在/ a/ (/ 1/ )/ 我们/ 下面/ 给出/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 3/ 阶/ 高阶差分/ 路径/ 的/ 说明/ :/ 中/ 分别/ 任取/ 一个/ 比特/ 作为/ 活跃/ 比特/ ,/ 记为/ x1/ ,/ x2/ ,/ x3/ ,/ 其它/ 比特/ 取为/ 定值/ ./ (/ 2/ )/ 第/ 1/ 轮/ ./ 起始/ 状态/ 中/ 含有/ 变量/ 的/ 字节/ 都/ 只/ 这样/ ,/ 在/ 其它/ 比特/ 取定值/ ,/ a/ (/ 1/ )/ (/ 3/ )/ 第/ 3/ 轮/ ./ 我们/ 知道/ ,/ 含有/ 多个/ 变量/ 的/ 字节/ ,/ 经过/ S/ 盒层/ 之后/ ,/ 代数/ 次数/ 一定/ 不/ 可能/ 大于/ 其所含/ 变量/ 的/ 个数/ ./ 而/ 第/ 3/ 轮/ 的/ 输入/ 中/ ,/ 每个/ 字节/ 至多/ 可能/ 含有/ 4/ 个/ 变量/ ,/ 这样/ 在/ 第/ 3/ 轮/ 的/ S/ 盒层/ 的/ 输出/ 状态/ 中/ ,/ 所有/ 比特/ 的/ 代数/ 次数/ 不/ 可能/ 大于/ 4/ ,/ 而/ 后面/ 都/ 是/ 线性/ 运算/ ,/ 所以/ ,/ 在/ 第/ 3/ 轮/ 的/ 末端/ ,/ 状态/ 中/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不会/ 超过/ 4/ 次/ ./ 0/ ,/ 1/ 的/ 最低/ 位/ 比特/ 取遍/ 所有/ 32/ 个值/ ,/ 可以/ 在/ 3/ 轮/ 之/ a/ (/ 1/ )/ 后/ 得到/ 平衡/ 状态/ ./ 6.2/ 改进/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 比特/ 积分/ 区分/ 器/ 我们/ 利用/ 代数/ 次数/ 的/ 增加/ ,/ 解释/ 了/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 比特/ 积分/ 区分/ 器/ ./ 但是/ 事实上/ ,/ 此/ 区分/ 器/ 并/ 没有/ 将/ 数据/ 复杂度/ 降低/ 到/ 最小/ ,/ 如果/ 利用/ 代数/ 次数/ 进行/ 分析/ ,/ 可以/ 找到/ 涉及/ 更/ 少/ 明文/ 的/ “/ 零/ 和/ ”/ 区分/ 器/ ./ 图/ 7/ 为/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 3/ 阶/ 高阶差分/ 区分/ 器/ ,/ 图中/ 符号/ 代表/ 的/ 意义/ 与/ 图/ 6/ 相同/ ./ 有/ 一个/ 变量/ ,/ 所以/ 在/ 第/ 1/ 轮/ S/ 盒/ 的/ 输出/ 状态/ 中/ ,/ 这/ 3/ 个/ 字节/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 至多是/ 1/ ./ 经过/ 后面/ 的/ 几个/ 线性/ 扩散/ 运算/ ,/ 在/ 第/ 1/ 轮/ 的/ 末端/ 有/ 3/ 列含/ 变量/ ,/ 而且/ 代数/ 次数/ 仍然/ 至多/ 为/ 1/ ,/ 含/ 变量/ 的/ 字节/ 仍然/ 只/ 含有/ 一个/ 变量/ ./ (/ 3/ )/ 第/ 2/ 轮/ ./ 第/ 2/ 轮/ 的/ 输入/ 状态/ 中/ 含有/ 变量/ 的/ Page8/ 字节/ 同样/ 只有/ 一个/ 变量/ ,/ 这样/ 其/ 输出/ 状态/ 中/ 相关/ 比特/ 的/ 代数/ 次数/ 仍然/ 至多/ 为/ 1/ ./ 经过/ 后面/ 的/ 线性/ 扩散/ 运算/ ,/ 除/ 第/ 2/ 列外/ ,/ 状态/ 的/ 每个/ 比特/ 都/ 可能/ 含有/ 变量/ ,/ 其中/ 第/ 1/ 列/ 和/ 第/ 3/ 列/ 比特/ 至多/ 含有/ 一个/ 变量/ ,/ 其余/ 5/ 列/ 至多/ 含有/ 两个/ 变量/ ,/ 代数/ 次数/ 的/ 上界/ 仍然/ 为/ 1/ ./ (/ 4/ )/ 第/ 3/ 轮/ ./ 由/ 上/ 一轮/ 的/ 分析/ ,/ 我们/ 得到/ 所有/ 的/ 字节/ 所含/ 的/ 变量/ 数都/ 不/ 大于/ 2/ ,/ 这样/ 在/ 第/ 3/ 轮/ 的/ S/ 图/ 8Rijndael/ -/ 256/ 的/ 3/ 轮/ 2/ 阶/ 高阶差分/ 路径/ 我们/ 在/ a/ (/ 1/ )/ 作为/ 活跃/ 比特/ ,/ 记为/ x1/ ,/ x2/ ,/ 其它/ 比特/ 取为/ 定值/ ./ 则/ 可以/ 在/ 第/ 1/ 轮后/ 得到/ 代数/ 次数/ 至多/ 为/ 1/ ,/ 且/ 每个/ 字节/ 至多/ 含/ 一个/ 变量/ 的/ 两列/ ,/ 其它/ 列为/ 常数/ ./ 同样/ ,/ 第/ 2/ 轮/ 之后/ 每个/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 1/ ,/ 并且/ 我们/ 得到/ 两个/ 常数/ 列/ ,/ 此外/ 有/ 第/ 1/ 、/ 4/ 、/ 6/ 、/ 7/ 列中/ 每个/ 字节/ 只/ 含有/ 1/ 个/ 变量/ ,/ 只有/ 第/ 5/ 列/ 和/ 第/ 8/ 列中/ 字节/ 可能/ 含有/ 两个/ 变量/ ./ 这样/ 在/ 第/ 3/ 轮/ 的/ S/ 盒层/ 之后/ 除/ 第/ 5/ 列/ 和/ 第/ 8/ 列外/ 的/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不/ 超过/ 1/ ./ 再/ 经过/ 行/ 移位/ 、/ 列/ 混淆/ 和/ 轮/ 常数/ 加/ 运算/ ,/ 我们/ 发现/ 第/ 3/ 列/ 和/ 第/ 6/ 列中/ 所有/ 比特/ 代数/ 次数/ 都/ 不/ 超过/ 1/ ./ 这样/ ,/ 在/ 其它/ 比特/ 取定值/ ,/ 选定/ 的/ 两个/ 比特/ 取遍/ 所有/ 4/ 个值/ ,/ 可以/ 在/ 3/ 轮/ 之后/ 得到/ 局部/ 平衡/ 状态/ ./ 7/ 构造/ SPONGENT/ 的/ 零/ 和/ 区分/ 器/ 2009/ 年/ ,/ Aumasson/ 等/ 人/ 利用/ 高阶差分/ 的/ 思想/ ,/ 提出/ 了/ “/ 零/ 和/ 区分/ 器/ ”/ 的/ 概念/ ./ 本节/ 我们/ 利用/ SPON/ -/ GENT/ 函数/ 代数/ 次数/ 的/ 增加/ 情况/ ,/ 对/ 其/ 最轻量级/ 版本/ SPONGENT/ -/ 88/ // 80/ // 8/ 的/ 内部/ 置换/ 构造/ 零/ 和/ 区分/ 器/ ./ SPONGENT/ 的/ 内部/ 置换/ 采用/ 的/ 是/ PRESENT/ 类/ 的/ 置换/ 类型/ ,/ 对于/ 高阶差分/ 分析/ 来说/ ,/ 其/ S/ 盒层/ 不但/ 提供/ 代数/ 次数/ 的/ 增加/ ,/ 而且/ 提供/ 各个/ 比特/ 变量/ 的/ 混淆/ ./ 但是/ ,/ 由于/ 其轮/ 函数/ 中/ 比特/ 置换/ 层/ 的/ 对称性/ ,/ 加上/ 其/ 4/ 比特/ S/ 盒/ 中/ 有/ 一个/ 比特/ 的/ 代数/ 次数/ 没有/ 达盒/ 层/ 的/ 输出/ 状态/ 中/ ,/ 所有/ 比特/ 的/ 代数/ 次数/ 不/ 可能/ 大于/ 2/ ,/ 而/ 后面/ 都/ 是/ 线性/ 运算/ ,/ 所以/ ,/ 在/ 第/ 3/ 轮/ 的/ 末端/ ,/ 状态/ 中/ 所有/ 比特/ 的/ 代数/ 次数/ 都/ 不会/ 超过/ 2/ 次/ ./ 这样/ ,/ 在/ 其它/ 比特/ 取定值/ ,/ 选定/ 的/ 3/ 个/ 比特/ 取遍/ 所有/ 8/ 个值/ ,/ 可以/ 在/ 3/ 轮/ 之后/ 得到/ 平衡/ 状态/ ./ 如果/ 我们/ 放弃/ 最后/ 状态/ 所有/ 比特/ 都/ 要/ 平衡/ 的/ 要求/ ,/ 我们/ 还/ 可以/ 以/ 更/ 少/ 的/ 明文/ 个数/ 得到/ 3/ 轮/ 部分/ 平衡/ 的/ 高阶差分/ 区分/ 器/ ,/ 如图/ 8/ 所示/ ./ SPONGENT/ 采用/ 的/ 4/ ×/ 4/ 的/ S/ 盒/ 可以/ 记为/ 到/ 最高/ 的/ 3/ 次/ ,/ 导致/ 其轮/ 函数/ 迭代/ 对应/ 的/ 代数/ 次数/ 增加/ 比/ 期望/ 的/ 要/ 慢/ ./ 我们/ 便/ 由/ 其/ S/ 盒中/ 每个/ 比特/ 的/ 代数/ 次数/ 出发/ ,/ 来/ 研究/ 轮/ 函数/ 的/ 代数/ 次数/ 增加/ 情况/ ,/ 进而/ 构造/ 零/ 和/ 区分/ 器/ ./ S/ [/ 16/ ]/ =/ {/ E/ ,/ D/ ,/ B/ ,/ 0/ ,/ 2/ ,/ 1/ ,/ 4/ ,/ F/ ,/ 7/ ,/ A/ ,/ 8/ ,/ 5/ ,/ 9/ ,/ C/ ,/ 3/ ,/ 6/ }/ ./ 如果/ 将/ 其/ 4/ 比特/ 输入/ ,/ 由/ 高位/ 向/ 低位/ 依次/ 记为/ a1/ ,/ a2/ ,/ a3/ ,/ a4/ ,/ 4/ 比特/ 输出/ 由/ 高位/ 向/ 低位/ 依次/ 记为/ b1/ ,/ b2/ ,/ b3/ ,/ b4/ ,/ 则/ 其/ 代数/ 正规/ 型/ 可以/ 写为/ b1/ =/ a1a2a4/ +/ a1a3a4/ +/ a1a3/ +/ a1a4/ +/ a3a4/ +/ a1/ +/ a2/ +/ 1/ ,/ b2/ =/ a1a2a3/ +/ a1a4/ +/ a2/ +/ a3/ +/ 1/ ,/ b3/ =/ a1a2a3/ +/ a1a2/ +/ a1a3/ +/ a1a4/ +/ a2a3/ +/ a4/ +/ 1/ ,/ b4/ =/ a2a3/ +/ a1/ +/ a3/ +/ a4/ ./ 这样/ ,/ 即使/ S/ 盒/ 的/ 4/ 个/ 输入/ 比特/ 都/ 取为/ 变量/ ,/ 其/ 输出/ 的/ 4/ 个/ 比特/ 中/ 也/ 会/ 有/ 一个/ 为/ 2/ 次/ ,/ 其它/ 的/ 为/ 3/ 次/ ./ 此外/ ,/ 我们/ 还/ 将/ 用到/ 此/ S/ 盒/ 的/ 逆/ 的/ 代数/ 正规/ 型/ ./ 将/ S/ 盒/ 的/ 逆/ 的/ 4/ 比特/ 输入/ ,/ 由/ 高位/ 向/ 低位/ 依次/ 记为/ a1/ ,/ a2/ ,/ a3/ ,/ a4/ ,/ 4/ 比特/ 输出/ 由/ 高位/ 向/ 低位/ 依次/ 记为/ b1/ ,/ b2/ ,/ b3/ ,/ b4/ ,/ 则/ 其/ 代数/ 正规/ 型/ 可以/ 写为/ b1/ =/ a2a3/ +/ a2a4/ +/ a3a4/ +/ a1/ ,/ b2/ =/ a2a3a4/ +/ a1a3/ +/ a2a3/ +/ a3a4/ +/ a2/ +/ a3/ +/ a4/ ,/ b3/ =/ a2a3a4/ +/ a1a2/ +/ a2a3/ +/ a2a4/ +/ a3/ +/ a4/ +/ 1/ ,/ b4/ =/ a1a2a4/ +/ a1a3a4/ +/ a2a4/ +/ a1/ +/ a2/ +/ a3/ +/ 1/ ./ 其/ 输出/ 的/ 4/ 个/ 比特/ 中/ 也/ 会/ 有/ 一个/ 为/ 2/ 次/ ,/ 其它/ 的/ 为/ 3/ 次/ ./ 我们/ 根据/ 此/ S/ 盒/ 代数/ 次数/ 的/ 性质/ ,/ 加上/ 比特/ 置/ Page9/ 换层/ 的/ 对称性/ ,/ 给出/ SPONGENT/ -/ 88/ // 80/ // 8/ 函数/ 置换/ 的/ 14/ 轮/ 零/ 和/ 区分/ 器/ ./ SPONGENT/ -/ 88/ // 80/ // 8/ 的/ 置换/ 函数/ 状态/ 大小/ 为/ 88/ 比特/ ,/ 采用/ 4/ ×/ 4/ 的/ S/ 盒/ ,/ 所以/ 每轮/ 含有/ 22/ 个/ 并行/ 的/ S/ 盒/ 作为/ S/ 盒层/ ,/ 我们/ 从/ 左/ 至/ 右/ 记为/ 第/ 1/ ,/ 2/ ,/ …/ ,/ 22/ 个/ S/ 盒/ ./ S/ 盒层/ 的/ 输出/ 通过/ 一个/ 比特/ 置换/ 层/ 交换/ 比特/ 的/ 位置/ ./ 而轮/ 常数/ 加/ 运算/ 因为/ 不会/ 给/ 代数/ 次数/ 上/ 界/ 带来/ 影响/ ,/ 在/ 我们/ 的/ 分析/ 中将/ 其/ 忽略/ ./ 我们/ 所/ 给/ 的/ 14/ 轮/ 零/ 和/ 区分/ 器/ 包含/ 两个/ 部分/ ,/ 8/ 轮/ 的/ 正向/ 部分/ ,/ 我们/ 记为/ 第/ 7/ ~/ 14/ 轮/ ;/ 6/ 轮/ 的/ 逆向/ 部分/ ,/ 我们/ 记为/ 第/ 1/ ~/ 6/ 轮/ ./ 而/ 起始/ 的/ 中间状态/ ,/ 为/ 第/ 6/ 轮/ 的/ 输出/ 状态/ ,/ 选择/ 了/ 21/ 个/ S/ 盒/ 的/ 84/ 个/ 比特/ 作为/ 活跃/ 比特/ ./ 7.1/ 区分/ 器/ 的/ 第/ 9/ ~/ 14/ 轮/ 高阶差分/ 路径/ 首先/ 我们/ 给出/ 正向/ 部分/ 中/ 第/ 9/ ~/ 14/ 轮/ 的/ 高阶差分/ 路径/ ./ (/ 1/ )/ 起始/ 状态/ ./ 第/ 9/ 轮/ 的/ 输入/ 状态/ 有/ 4/ 个/ S/ 盒/ 作为/ 活跃/ S/ 盒/ ,/ 即/ 包含/ 16/ 个/ 活跃/ 比特/ ,/ 这/ 4/ 个/ 活跃/ S/ 盒/ 分别/ 为/ 第/ 1/ ,/ 8/ ,/ 15/ ,/ 19/ 个/ S/ 盒/ ./ 由于/ 轮/ 函数/ 中/ 的/ S/ 盒/ 是/ 一个/ 置换/ ,/ 所以/ 第/ 9/ 轮/ S/ 盒层/ 中/ 上述/ 4/ 个/ S/ 盒/ 输出/ 的/ 16/ 个/ 比特/ 仍然/ 是/ 活跃/ 且/ 独立/ 的/ ./ 我们/ 从/ 第/ 9/ 轮/ S/ 盒层/ 的/ 输出/ 状态/ 出发/ ,/ 将/ 活跃/ 的/ 16/ 个/ 比特/ 记/ 为/ 变量/ x1/ ,/ x2/ ,/ …/ ,/ x16/ ,/ 其它/ 比特/ 为/ 常数/ ,/ 计算/ 第/ 9/ ~/ 14/ 轮/ 的/ 每个/ 比特/ 的/ 代数/ 次数/ 的/ 上界/ ./ (/ 2/ )/ 第/ 9/ 轮/ ./ 16/ 个/ 活跃/ 比特/ 通过/ 比特/ 置换/ 层后/ ,/ 位置/ 发生/ 了/ 变化/ ,/ 使得/ 第/ 10/ 轮/ 的/ S/ 盒/ 输入/ 中/ ,/ 至多/ 有/ 一个/ 变量/ 进入/ 同一个/ S/ 盒/ ,/ 还有/ 6/ 个/ S/ 盒/ 没有/ 变量/ 进入/ ./ 表/ 1/ 的/ 第/ 2/ 行/ ,/ 给出/ 了/ 第/ 9/ 轮/ 输出/ 状态/ 中/ 每个/ 比特/ 的/ 代数/ 次数/ 的/ 上界/ ,/ 同一个/ 小括号/ 中/ 的/ 数字/ ,/ 代表/ 要/ 进入/ 下/ 一轮/ 同一个/ S/ 盒/ 的/ 4/ 个/ 比特/ 的/ 代数/ 次数/ 的/ 上界/ ./ (/ 3/ )/ 第/ 10/ 轮/ ./ 我们/ 知道/ ,/ 一个/ 变量/ 比特/ 进入/ S/ 盒/ 之后/ ,/ S/ 盒/ 的/ 所有/ 输出/ 比特/ 都/ 可能/ 和/ 这个/ 变量/ 相关/ ,/ 则/ 它们/ 的/ 代数/ 次数/ 都/ 可能/ 会/ 从/ 0/ 变为/ 1/ ./ 所以/ ,/ 16/ 个/ 变量/ 通过/ 第/ 10/ 轮/ 的/ S/ 盒层/ 后/ ,/ 会/ 使得/ 输出/ 状态/ 中/ ,/ 与/ 它们/ 相关/ 的/ 64/ 个/ 比特/ 的/ 代数/ 次数/ 上/ 界/ 变为/ 1/ ./ 但是/ 仍然/ 有/ 22/ -/ 16/ =/ 6/ 个/ S/ 盒中/ 没有/ 变量/ 参与/ 运算/ ,/ 即/ S/ 盒层/ 输出/ 比特/ 中有/ 24/ 个/ ,/ 代数/ 次数/ 仍为/ 0/ ./ 经过/ 比特/ 置换/ 交换/ 位置/ ,/ 此轮/ 输出/ 状态/ 的/ 所有/ 比特/ 代数/ 次数/ 上界/ 见表/ 1/ 第/ 3/ 行/ ./ (/ 4/ )/ 第/ 11/ 轮/ ./ 从/ 第/ 11/ 轮/ 开始/ ,/ 代数/ 次数/ 的/ 计算/ 开始/ 利用/ S/ 盒/ 的/ 代数/ 正规/ 型/ ,/ 我们/ 由/ S/ 盒/ 4/ 个/ 输入/ 比特/ 的/ 代数/ 次数/ ,/ 来/ 估计/ 可能/ 产生/ 的/ 最高/ 次项/ 的/ 次数/ ./ 以/ 第/ 11/ 轮/ 的/ 第/ 1/ 个/ S/ 盒为例/ ,/ 由/ 第/ 10/ 轮/ 的/ 输出/ 我们/ 知道/ ,/ 此/ S/ 盒/ 的/ 4/ 个/ 输入/ 比特/ 代数/ 次数/ 上界/ 为/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ 又/ 其/ 输出/ 的/ 第/ 1/ 个/ 比特/ 含有/ 3/ 次项/ a1a2a4/ ,/ 由/ 输入/ 比特/ 的/ 代数/ 次数/ 上/ 界/ 知道/ a1/ ,/ a2/ ,/ a4/ 都/ 可能/ 含有/ 变量/ ,/ 所以/ 这一/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 3/ ./ 此/ S/ 盒/ 的/ 第/ 2/ 个/ 输出/ 比特/ 中/ 含有/ 3/ 次项/ a1a2a3/ ,/ 而/ a3/ 代数/ 次数/ 为/ 0/ ,/ 即/ 为/ 常值/ 不/ 含/ 变量/ ,/ 所以/ 此/ 3/ 次项/ 的/ 代数/ 次数/ 至多/ 为/ 2/ ,/ 则/ 这个/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 2/ ./ 同样/ 可以/ 推知/ ,/ 第/ 3/ 个/ 和/ 第/ 4/ 个/ 输出/ 比特/ 的/ 代数/ 次数/ 上/ 界/ 分别/ 为/ 2/ 和/ 1/ ./ 利用/ 这一/ 方法/ ,/ 可以/ 推得/ 第/ 11/ 轮/ S/ 盒层/ 输出/ 的/ 所有/ 比特/ 代数/ 次数/ 的/ 上界/ ,/ 再/ 由/ 比特/ 换位/ 运算/ 得出/ 第/ 11/ 轮/ 输出/ 状态/ 的/ 所有/ 比特/ 代数/ 次数/ 上/ 界/ ,/ 见表/ 1/ 第/ 4/ 行/ ./ 轮数/ 9111210/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 1/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 1/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 1/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 1/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 0/ ,/ 0/ )/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 0/ ,/ 1/ ,/ 0/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ ,/ (/ 1/ ,/ 0/ ,/ 1/ ,/ 1/ )/ (/ 3/ ,/ 3/ ,/ 2/ ,/ 3/ )/ ,/ (/ 2/ ,/ 3/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 3/ ,/ 3/ )/ ,/ (/ 3/ ,/ 2/ ,/ 3/ ,/ 2/ )/ ,/ (/ 3/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 3/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 3/ )/ ,/ (/ 2/ ,/ 1/ ,/ 3/ ,/ 3/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 3/ ,/ 2/ )/ ,/ (/ 1/ ,/ 3/ ,/ 3/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 3/ ,/ 2/ ,/ 1/ )/ ,/ (/ 3/ ,/ 3/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 3/ ,/ 2/ ,/ 1/ ,/ 3/ )/ ,/ (/ 3/ ,/ 2/ ,/ 1/ ,/ 1/ )/ ,/ (/ 2/ ,/ 1/ ,/ 1/ ,/ 2/ )/ ,/ (/ 2/ ,/ 1/ ,/ 2/ ,/ 2/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 2/ )/ ,/ (/ 1/ ,/ 1/ ,/ 2/ ,/ 2/ )/ ,/ (/ 1/ ,/ 2/ ,/ 2/ ,/ 1/ )/ (/ 9/ ,/ 7/ ,/ 8/ ,/ 8/ )/ ,/ (/ 7/ ,/ 7/ ,/ 7/ ,/ 8/ )/ ,/ (/ 6/ ,/ 7/ ,/ 6/ ,/ 6/ )/ ,/ (/ 6/ ,/ 8/ ,/ 6/ ,/ 8/ )/ ,/ (/ 6/ ,/ 5/ ,/ 6/ ,/ 4/ )/ ,/ (/ 5/ ,/ 4/ ,/ 8/ ,/ 7/ )/ ,/ (/ 7/ ,/ 8/ ,/ 7/ ,/ 7/ )/ ,/ (/ 6/ ,/ 6/ ,/ 6/ ,/ 7/ )/ ,/ (/ 7/ ,/ 6/ ,/ 7/ ,/ 8/ )/ ,/ (/ 6/ ,/ 6/ ,/ 6/ ,/ 4/ )/ ,/ (/ 5/ ,/ 3/ ,/ 4/ ,/ 5/ )/ ,/ (/ 8/ ,/ 7/ ,/ 7/ ,/ 8/ )/ ,/ (/ 7/ ,/ 7/ ,/ 6/ ,/ 6/ )/ ,/ (/ 6/ ,/ 7/ ,/ 7/ ,/ 6/ )/ ,/ (/ 7/ ,/ 8/ ,/ 6/ ,/ 6/ )/ ,/ (/ 6/ ,/ 4/ ,/ 5/ ,/ 3/ )/ ,/ (/ 4/ ,/ 5/ ,/ 5/ ,/ 5/ )/ ,/ (/ 5/ ,/ 5/ ,/ 4/ ,/ 5/ )/ ,/ (/ 4/ ,/ 4/ ,/ 4/ ,/ 5/ )/ ,/ (/ 6/ ,/ 4/ ,/ 5/ ,/ 5/ )/ ,/ (/ 4/ ,/ 3/ ,/ 3/ ,/ 2/ )/ ,/ (/ 3/ ,/ 2/ ,/ 3/ ,/ 4/ )/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 14/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 14/ )/ ,/ (/ 14/ ,/ 15/ ,/ 13/ ,/ 16/ )/ ,/ (/ 9/ ,/ 10/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 15/ ,/ 14/ ,/ 14/ )/ ,/ (/ 12/ ,/ 15/ ,/ 10/ ,/ 8/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 12/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 15/ )/ ,/ (/ 14/ ,/ 14/ ,/ 12/ ,/ 15/ )/ ,/ (/ 10/ ,/ 8/ ,/ 15/ ,/ 14/ )/ ,/ (/ 13/ ,/ 14/ ,/ 11/ ,/ 12/ )/ ,/ (/ 15/ ,/ 12/ ,/ 13/ ,/ 12/ )/ ,/ (/ 7/ ,/ 14/ ,/ 13/ ,/ 14/ )/ ,/ (/ 14/ ,/ 9/ ,/ 10/ ,/ 9/ )/ ,/ (/ 8/ ,/ 9/ ,/ 6/ ,/ 5/ )/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 16/ ,/ 16/ ,/ 16/ ,/ 15/ )/ (/ 5/ )/ 第/ 12/ 轮/ 和/ 第/ 13/ 轮/ ./ 按照/ 同样/ 的/ 方法/ ,/ 我们/ 可以/ 向/ 后/ 再/ 推/ 两轮/ ,/ 在/ 第/ 13/ 轮/ 的/ 输出/ 状态/ 中/ ,/ 得到/ 所有/ 比特/ 的/ 代数/ 次数/ 上/ 界/ ,/ 值得注意/ 的/ 是/ 进入/ 第/ 14/ 轮/ 的/ 最后/ 一个/ S/ 盒/ 的/ 4/ 个/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ (/ 8/ ,/ 9/ ,/ 6/ ,/ 5/ )/ ./ (/ 6/ )/ 第/ 14/ 轮/ ./ 由于/ 共有/ 16/ 个/ 变量/ 参与/ 运算/ ,/ 故/ 1314Page10/ 所有/ 比特/ 的/ 代数/ 次数/ 至多/ 为/ 16/ ./ 但是/ ,/ 我们/ 发现/ 此轮/ 的/ 最后/ 一个/ S/ 盒/ 的/ 最后/ 一个/ 比特/ 的/ 代数/ 次数/ 至多/ 为/ 15/ ./ 这/ 是因为/ ,/ 最后/ 一个/ 比特/ 的/ 4/ 个项/ a2a3/ 、/ a1/ 、/ a3/ 、/ a4/ 的/ 代数/ 次数/ 上/ 界/ 分别/ 为/ 15/ 、/ 8/ 、/ 6/ 、/ 5/ ,/ 所以/ 此/ 比特/ 代数/ 次数/ 不/ 超过/ 15/ ./ 这样/ ,/ 在/ 第/ 9/ 轮/ 的/ S/ 盒层/ 输出/ 状态/ 中/ ,/ 选定/ 的/ 16/ 个/ 活跃/ 比特/ 取遍/ 所有/ 216/ 个值/ ,/ 其它/ 比特/ 取定值/ ,/ 可以/ 在/ 第/ 14/ 轮/ 之后/ 使得/ 状态/ 的/ 最后/ 一个/ 比特/ 平衡/ ./ 7.2/ 区分/ 器/ 的/ 第/ 1/ ~/ 4/ 轮/ 高阶差分/ 路径/ 下面/ 我们/ 给出/ 逆向/ 部分/ 第/ 1/ ~/ 4/ 轮/ 的/ 高阶差分/ 路径/ ,/ 我们/ 按照/ 代数/ 次数/ 增加/ 的/ 顺序/ ,/ 将/ 第/ 4/ 轮/ 的/ 输出/ 状态/ 定为/ 起始/ 状态/ ,/ 逆向/ 至/ 第/ 1/ 轮/ 进行/ 代数/ 次数/ 上界/ 的/ 计算/ ./ (/ 1/ )/ 起始/ 状态/ ./ 第/ 4/ 轮/ 的/ 输出/ 状态/ 的/ 前/ 16/ 个/ 比特/ 作为/ 活跃/ 比特/ ./ 我们/ 从此/ 状态/ 出发/ ,/ 将/ 活跃/ 的/ 16/ 个/ 比特/ 记/ 为/ 变量/ x1/ ,/ x2/ ,/ …/ ,/ x16/ ,/ 其它/ 比特/ 为/ 常数/ ,/ 计算/ 第/ 4/ ~/ 1/ 轮/ 的/ 每个/ 比特/ 的/ 代数/ 次数/ 的/ 上界/ ./ (/ 2/ )/ 第/ 4/ 轮/ ./ 由于/ 第/ 4/ 轮/ 的/ 输出/ 状态/ 中前/ 16/ 个/ 比特/ 为/ 变量/ ,/ 逆向/ 计算/ 先/ 通过/ 比特/ 置换/ 运算/ ,/ 16/ 个/ 变量/ 进入/ 16/ 个/ 逆/ S/ 盒/ ,/ 分别/ 为/ 它们/ 的/ 最高/ 位/ 比特/ ,/ 最后/ 的/ 6/ 个/ S/ 盒/ 没有/ 变量/ 进入/ ./ 在/ 逆/ S/ 盒/ 的/ 输出/ 状态/ (/ 正向/ 看为/ 第/ 4/ 轮/ 的/ 输入/ 状态/ )/ 中前/ 16/ 个/ 有/ 变量/ 进入/ 的/ 逆/ S/ 盒/ 的/ 所有/ 64/ 个/ 比特/ 位置/ 都/ 有/ 可能/ 含有/ 变量/ ,/ 但是/ 由于/ 每个/ 逆/ S/ 盒/ 只有/ 一个/ 变量/ 进入/ ,/ 所以/ 此/ 状态/ 中前/ 64/ 个/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 1/ ;/ 由于/ 后/ 6/ 个/ 逆/ S/ 盒/ 没有/ 变量/ 进入/ ,/ 所以/ 此/ 状态/ 中后/ 24/ 个/ 比特/ 的/ 代数/ 次数/ 为/ 0/ ./ 见表/ 2/ 第/ 2/ 行/ ./ (/ 3/ )/ 第/ 3/ 轮/ ./ 第/ 4/ 轮/ 的/ 输入/ 状态/ 逆向/ 计算/ 通过/ 比特/ 置换/ 层后/ ,/ 使得/ 第/ 3/ 轮逆/ S/ 盒层/ 的/ 输入/ 状态/ 中/ ,/ 前/ 20/ 个/ S/ 盒/ 的/ 输入/ 代数/ 次数/ 模式/ 都/ 是/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ ,/ 即前/ 3/ 个/ 输入/ 比特/ 的/ 代数/ 次数/ 上界/ 都/ 是/ 1/ ,/ 最后/ 一个/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 0/ ./ 它们/ 的/ 输出/ 比特/ 的/ 代数/ 次数/ 上/ 界/ 需要/ 根据/ S/ 盒/ 的/ 逆/ 的/ 代数/ 正规/ 型/ 来/ 计算/ ./ 首先/ 计算/ 逆/ S/ 盒/ 的/ 第/ 1/ 个/ 输出/ 比特/ ,/ 根据/ 代数/ 正规/ 型/ ,/ 此/ 比特/ 的/ 最高/ 次项/ 为/ 2/ 次/ ,/ 并且/ 里面/ 有/ 一项/ 为/ a2a3/ ,/ 而/ 其/ 输入/ 中/ a2/ ,/ a3/ 两个/ 比特/ 的/ 代数/ 次数/ 都/ 可能/ 为/ 1/ ,/ 所以/ 第/ 1/ 个/ 输出/ 比特/ 的/ 代数/ 次数/ 上界/ 为/ 2/ ./ 第/ 2/ 个/ 和/ 第/ 3/ 个/ 输出/ 比特/ 中/ 都/ 只有/ 3/ 次项/ a2a3a4/ ,/ 而/ 我们/ 知道/ a4/ 的/ 代数/ 次数/ 为/ 0/ ,/ 所以/ 这/ 两个/ 比特/ 的/ 代数/ 次数/ 上界/ 也/ 为/ 2/ ./ 同样/ ,/ 第/ 4/ 个/ 比特/ 的/ 两个/ 3/ 次项/ 中/ 都/ 含有/ a4/ ,/ 则/ 它/ 的/ 代数/ 次数/ 上界/ 也/ 为/ 2/ ./ 所以/ ,/ 逆/ S/ 盒/ 的/ 输入/ 代数/ 次数/ 模式/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 0/ )/ 的/ 输出/ 代数/ 次数/ 模式/ 为/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ./ 而/ 第/ 3/ 轮逆/ S/ 盒层/ 的/ 输入/ 状态/ 中/ ,/ 后/ 2/ 个/ S/ 盒/ 的/ 输入/ 代数/ 次数/ 模式/ 为/ (/ 1/ ,/ 1/ ,/ 0/ ,/ 0/ )/ ,/ 可以/ 计算/ 它/ 的/ 输出/ 代数/ 次数/ 模式/ 为/ (/ 1/ ,/ 1/ ,/ 2/ ,/ 2/ )/ ./ 见表/ 2/ 第/ 3/ 行/ ./ (/ 4/ )/ 第/ 2/ 轮/ 和/ 第/ 1/ 轮/ ./ 按照/ 同样/ 的/ 方法/ ,/ 我们/ 可以/ 向前/ 再/ 推/ 两轮/ ,/ 在/ 第/ 1/ 轮/ 的/ 输入/ 状态/ 中/ ,/ 得到/ 所有/ 88/ 个/ 比特/ 的/ 代数/ 次数/ 上/ 界/ ,/ 其中/ 的/ 40/ 个/ 比特/ 的/ 代数/ 次数/ 不能/ 达到/ 最大/ 的/ 16/ ./ 轮数/ 3214/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 1/ ,/ 1/ ,/ 1/ ,/ 1/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ ,/ (/ 0/ ,/ 0/ ,/ 0/ ,/ 0/ )/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 2/ ,/ 2/ ,/ 2/ ,/ 2/ )/ ,/ (/ 1/ ,/ 1/ ,/ 2/ ,/ 2/ )/ ,/ (/ 1/ ,/ 1/ ,/ 2/ ,/ 2/ )/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 5/ ,/ 5/ ,/ 5/ )/ ,/ (/ 4/ ,/ 5/ ,/ 5/ ,/ 5/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 5/ ,/ 5/ ,/ 5/ )/ ,/ (/ 4/ ,/ 5/ ,/ 5/ ,/ 5/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ ,/ (/ 4/ ,/ 6/ ,/ 6/ ,/ 6/ )/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 10/ ,/ 14/ ,/ 14/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 10/ ,/ 14/ ,/ 14/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 11/ ,/ 15/ ,/ 15/ ,/ 15/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 10/ ,/ 14/ ,/ 14/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 11/ ,/ 15/ ,/ 15/ ,/ 15/ )/ ,/ (/ 11/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 9/ ,/ 13/ ,/ 13/ ,/ 15/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 9/ ,/ 13/ ,/ 13/ ,/ 15/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ ,/ (/ 12/ ,/ 16/ ,/ 16/ ,/ 16/ )/ 这样/ ,/ 在/ 第/ 4/ 轮/ 的/ 输出/ 状态/ 中/ ,/ 选定/ 的/ 16/ 个/ 活跃/ 比特/ 取遍/ 所有/ 216/ 个值/ ,/ 其它/ 比特/ 取定值/ ,/ 可以/ 在/ 第/ 1/ 轮/ 的/ 输入/ 处/ 得到/ 平衡/ 状态/ ./ 7.3/ 区分/ 器/ 的/ 第/ 5/ ~/ 8/ 轮/ 高阶差分/ 路径/ 本/ 小节/ 我们/ 将/ 上/ 两个/ 小节/ 的/ 高阶差分/ 路径/ 进行/ 组合/ ,/ 构造/ 一个/ 14/ 轮/ 高阶差分/ 路径/ ,/ 从而/ 得到/ 一个/ 14/ 轮/ 的/ 零/ 和/ 区分/ 器/ ./ 我们/ 知道/ 在/ 积分/ 攻击/ 中/ ,/ 对于/ 一条/ 积分/ 路径/ 来说/ ,/ 如果/ 可以/ 找到/ 一个/ 状态/ ,/ 在/ 经过/ 一轮/ 计算/ 以后/ ,/ 得到/ 的/ 活跃/ 且/ 独立/ 的/ 字节/ ,/ 包含/ 原/ 积分/ 路径/ 起始/ 状态/ 中/ 的/ 所有/ 活跃/ 字节/ ,/ 则/ 可以/ 将/ 这/ 一轮/ 加在/ 原/ 积分/ 路径/ 的/ 前面/ ,/ 这样/ 就/ 构造/ 了/ 一个/ 比/ 原来/ 多/ 一轮/ 的/ 积分/ 路径/ ./ 如果/ 原/ 积分/ 路径/ 最后/ 得到/ 平衡/ 状态/ ,/ 则/ 新/ 的/ 多/ 一轮/ 的/ 路径/ 也/ 可以/ 得到/ 平衡/ 状态/ ./ 我们/ 在/ 此/ 也/ 利用/ 这一/ 技术/ ,/ 进行/ 两条/ 子/ 高阶差分/ 路径/ 的/ 组合/ ./ 如图/ 9/ 所示/ ,/ 从/ 第/ 9/ 轮/ 的/ S/ 盒层/ 逆向/ 计算/ 可以/ 得出/ ,/ 若/ 使得/ 第/ 9/ 轮/ 的/ 第/ 1/ 、/ 8/ 、/ 15/ 、/ 19/ 个/ S/ 盒/ 的/ 16/ 个/ 比特/ 活跃/ 且/ 独立/ ,/ 需要/ 第/ 8/ 轮/ 的/ S/ 盒层/ 的/ 第/ 1/ 、/ 2/ 、/ 3/ 、/ 4/ 、/ 7/ 、/ 8/ 、/ 9/ 、/ 10/ 、/ 13/ 、/ 14/ 、/ 15/ 、/ 16/ 个/ S/ 盒/ 的/ 输出/ 比特/ 活跃/ 且/ 独立/ ,/ 而/ 使得/ 第/ 8/ 轮/ 的/ 这些/ S/ 盒/ 活跃/ 且/ 独立/ ,/ 需要/ 第/ 7/ 轮/ 的/ 前面/ 20/ 个/ S/ 盒/ 的/ 输出/ 比特/ 活跃/ 且/ 独立/ ;/ 另/ Page11/ 外/ 一个/ 方向/ ,/ 若/ 使得/ 第/ 5/ 轮/ 的/ 第/ 1/ 、/ 2/ 、/ 3/ 、/ 4/ 个/ S/ 盒/ 的/ 16/ 个/ 输入/ 比特/ 活跃/ 且/ 独立/ ,/ 需要/ 第/ 6/ 轮/ 的/ S/ 盒层/ 的/ 第/ 1/ 、/ 6/ 、/ 7/ 、/ 12/ 、/ 17/ 、/ 18/ 个/ S/ 盒/ 的/ 输出/ 比特/ 活跃/ 且/ 独立/ ,/ 而/ 使得/ 第/ 6/ 轮/ 的/ 这些/ S/ 盒/ 活跃/ 且/ 独立/ ,/ 需要/ 第/ 7/ 轮/ 的/ 第/ 1/ 、/ 2/ 、/ 3/ 、/ 5/ 、/ 6/ 、/ 7/ 、/ 8/ 、/ 9/ 、/ 10/ 、/ 12/ 、/ 13/ 、/ 14/ 、/ 16/ 、/ 17/ 、/ 18/ 、/ 图/ 9SPONGENT/ 零/ 和/ 区分/ 器/ 的/ 4/ ~/ 9/ 轮/ 这样/ ,/ 我们/ 用/ 了/ 284/ 的/ 数据/ 复杂度/ ,/ 得到/ 了/ SPONGENT/ -/ 88/ // 80/ // 8/ 中间/ 置换/ 的/ 14/ 轮/ 零/ 和/ 区分/ 器/ ./ 此/ 区分/ 器/ 从/ 第/ 7/ 轮/ 的/ 输入/ 出发/ ,/ 选择/ 前/ 21/ 个/ S/ 盒/ 的/ 84/ 个/ 输入/ 比特/ 作为/ 活跃/ 比特/ ,/ 分别/ 进行/ 正向/ 和/ 逆向/ 的/ 攻击/ ,/ 可以/ 在/ 第/ 1/ 轮/ 的/ 输入/ 处/ 得到/ 284/ 个/ 整个/ 14/ 轮/ 置换/ 的/ 输入/ 值/ ,/ 使得/ 它们/ 的/ 异或/ 和/ 为/ 零/ ,/ 并且/ 它们/ 对应/ 的/ 输出/ 的/ 异或/ 和/ 也/ 为/ 零/ ./ 8/ 结束语/ 本文/ 在/ 高阶差分/ 的/ 视角/ 下/ 解释/ 了/ 具有/ 代表性/ 的/ AES/ 和/ Rijndael/ -/ 256/ 的/ 积分/ 攻击/ ./ 并且/ 改进/ 了/ Rijndael/ -/ 256/ 的/ 3/ 轮/ 积分/ 区分/ 器/ 的/ 数据/ 复杂度/ ./ 此/ 19/ 、/ 20/ 、/ 21/ 个/ S/ 盒/ 的/ 输出/ 比特/ 活跃/ 且/ 独立/ ./ 综合/ 这/ 两个/ 方向/ ,/ 取/ 它们/ 的/ 并/ 才能/ 满足/ 所有/ 的/ 条件/ ./ 所以/ ,/ 若/ 要/ 使得/ 正向/ 和/ 逆向/ 的/ 起始/ 状态/ 中/ 活跃/ S/ 盒/ 的/ 个数/ 达到/ 前面/ 的/ 要求/ ,/ 必须/ 选择/ 第/ 7/ 轮/ 的/ 输入/ 状态/ 的/ 前/ 21/ 个/ S/ 盒/ 的/ 84/ 个/ 比特/ 活跃/ ./ 外/ ,/ 还/ 利用/ 代数/ 次数/ 的/ 增加/ 性质/ ,/ 对/ 一个/ 新/ 的/ 轻量级/ 杂凑/ 函数/ SPONGENT/ 的/ 内部/ 置换/ ,/ 构造/ 了/ 14/ 轮/ 的/ 零/ 和/ 区分/ 器/ ./ 下/ 一步/ 的/ 研究/ 方向/ 是从/ 积分/ 攻击/ 和/ 高阶差分/ 分析/ 的/ 理论/ 基础/ 出发/ ,/ 进一步/ 更/ 深层次/ 地/ 发现/ 这/ 两种/ 攻击/ 的/ 联系/ ./ 此外/ ,/ 进一步/ 改进/ SPONGENT/ 置换/ 的/ 零/ 和/ 区分/ 器/ ,/ 并/ 尝试/ 用于/ 此/ 函数/ 的/ 其它/ 版本/ 中去/ ./ 

