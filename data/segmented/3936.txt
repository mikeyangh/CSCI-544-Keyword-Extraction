Page1/ 基于/ 安全/ 规则/ 变异/ 的/ WebServices/ 安全性/ 测试方法/ 陈锦富/ 1/ )/ ,/ 3/ )/ 李青/ 1/ )/ 毛澄映/ 2/ )/ ,/ 3/ )/ 詹永照/ 1/ )/ 黄如兵/ 4/ )/ 陈加梅/ 1/ )/ 1/ )/ (/ 江苏/ 大学/ 计算机科学/ 与/ 通信/ 工程学院/ 江苏/ 镇江/ 212013/ )/ 2/ )/ (/ 江西财经大学/ 软件/ 与/ 通信/ 工程学院/ 南昌/ 330013/ )/ 3/ )/ (/ 斯文/ 本/ 科技/ 大学/ 信息/ 和/ 通信/ 技术/ 学院/ 墨尔本/ VIC3122/ 澳大利亚/ )/ 4/ )/ (/ 华中科技大学/ 计算机科学/ 与/ 技术/ 学院/ 武汉/ 430074/ )/ 摘要/ 针对/ 已有/ 变异/ 测试/ 研究/ 中仅/ 考虑/ 对/ SOAP/ (/ SimpleObjectAccessProtocol/ )/ 消息/ 输入/ 参数/ 的/ 变异/ 处理/ ,/ 而/ 缺乏/ 对/ SOAP/ 消息/ 安全/ 规则/ 变异/ 的/ 研究/ ,/ 文中/ 从/ 消息/ 机密性/ 、/ 完整性/ 及/ 身份/ 认证/ 等/ 方面/ 对/ 安全/ 规则/ 进行/ 归类/ ,/ 提出/ 了/ 一种/ 基于/ 安全/ 规则/ 变异/ 的/ WebServices/ 安全性/ 测试方法/ ./ 首先/ 给出/ 一种/ 安全/ 规则/ 变异/ 测试/ 框架/ ,/ 研究/ 变异/ 点/ 判定/ 规则/ 库/ ,/ 设计/ 出/ 相应/ 的/ 变异/ 操作/ 算子/ 、/ 漏洞/ 判定/ 准则/ 以及/ 基于/ 优先级/ 与/ 权重/ 策略/ 的/ 变异/ 算子/ 选择/ 方法/ ./ 然后/ 提出/ 一种/ 基于/ 安全/ 规则/ 变异/ 的/ 测试用例/ 生成/ 算法/ ,/ 依照/ 算法/ 生成/ 违背/ 安全/ 规则/ 的/ SOAP/ 消息/ ,/ 从而/ 揭露/ WebServices/ 的/ 安全类/ 故障/ ./ 最后/ 实现/ 了/ 一个/ WebServices/ 安全性/ 测试工具/ WSSTT/ (/ WebServicesSecurityTestingTool/ )/ ,/ 在/ 工具/ 的/ 基础/ 上/ 进行/ 实验/ 和/ 对比/ 分析/ ,/ 验证/ 了/ 文中/ 提出/ 的/ 基于/ 安全/ 规则/ 变异/ 的/ WebServices/ 安全/ 测试方法/ 的/ 可行性/ 和/ 有效性/ ./ 关键词/ WebServices/ ;/ SOAP/ 消息/ ;/ 安全/ 规则/ 变异/ ;/ 变异/ 测试/ ;/ 变异/ 算子/ ;/ 原型/ 工具/ 1/ 引言/ 随着/ 计算机技术/ 的/ 飞速发展/ ,/ WebServices/ 作为/ 实现/ SOA/ (/ Services/ -/ OrientedArchitecture/ )/ 系统/ 的/ 重要/ 方式/ 之一/ ,/ 已经/ 得到/ 产业界/ 和/ 学术界/ 的/ 广泛/ 关注/ 和/ 高度重视/ [/ 1/ ]/ ./ 在/ WebServices/ 得到/ 广泛应用/ 和/ 实践/ 的/ 同时/ ,/ WebServices/ 的/ 安全/ 问题/ 显得/ 越来越/ 重要/ ./ 由于/ WebServices/ 包含/ 了/ 诸多/ 企业/ 关键/ 业务/ ,/ 若/ 其/ 安全/ 出现/ 问题/ 将/ 造成/ 重大损失/ 与/ 严重危害/ ./ WebServices/ 测试/ 是/ 保证/ 其/ 质量/ 的/ 一种/ 重要/ 技术手段/ [/ 2/ ]/ ./ 由于/ WebServices/ 一般/ 位于/ 服务提供者/ 的/ 远程/ 站点/ ,/ 其/ 内部结构/ 和/ 代码/ 对/ 请求者/ 来讲/ 是/ 透明/ 的/ ./ 常用/ 的/ WebServices/ 功能性/ 测试方法/ 是/ 基于/ WSDL/ (/ WebServicesDescriptionLanguage/ )/ 规范/ 和/ XML/ (/ ExtensibleMarkupLanguage/ )/ 文档/ 的/ 测试方法/ ,/ 而/ 较/ 有效/ 的/ 安全性/ 测试方法/ 是/ 对/ WebServices/ 进行/ 变异/ 测试/ ./ 相关/ 研究/ 方法/ 通过/ 分析/ WSDL/ 描述/ 文件/ 对/ 输入/ 参数/ 进行/ 变异/ ,/ 该类/ 方法/ 在/ 考虑/ 数据通信/ 上下文/ 环境/ 方面/ 存在/ 欠缺/ ,/ 对/ 安全类/ 故障/ 暴露/ 能力/ 较弱/ ./ 通常/ WebServices/ 在/ 传送/ 或/ 接受/ 远程/ 服务/ 单元/ 的/ 数据/ 时/ ,/ 该/ 数据/ 以/ SOAP/ (/ SimpleObjectAccessProtocol/ )/ 协议/ 格式/ 进行/ 封装/ ./ 一个/ SOAP/ 消息/ 交互/ 元素/ 可以/ 抽象/ 表示/ 为/ 输入/ 参数/ 和/ 安全控制/ 规则/ 两/ 部分/ ./ 在/ 现有/ 的/ 变异/ 测试/ 研究/ 中/ ,/ 主要/ 考虑/ 的/ 是/ 针对/ 输入/ 参数/ 的/ 变异/ 处理/ ,/ 尚未/ 见到/ 有效/ 的/ 对/ SOAP/ 消息/ 安全/ 规则/ 变异/ 的/ 测试方法/ ./ 本文/ 针对/ 安全/ 规则/ 这一/ 特有/ 的/ 消息/ 成份/ ,/ 从/ 消息/ 机密性/ 、/ 完整性/ 及/ 身份/ 认证/ 等/ 方面/ 进行/ 归类/ ,/ 研究/ 变异/ 点/ 判定/ 规则/ 库/ ,/ 设计/ 相应/ 的/ 变异/ 操作/ 算子/ 和/ 漏洞/ 判定/ 准则/ ,/ 并/ 提出/ 一种/ 基于/ 安全/ 规则/ 变异/ 的/ 测试用例/ 生成/ 算法/ ,/ 最终/ 生成/ 违背/ 安全/ 规则/ 的/ SOAP/ 消息/ ,/ 进而/ 揭露/ WebServices/ 的/ 安全类/ 缺陷/ ./ 2/ 相关/ 工作/ 目前/ 国内外/ 针对/ WebServices/ 功能测试/ 的/ 研究/ 较/ 多/ ,/ 主要/ 集中/ 在/ 基于/ WSDL/ 规范/ 和/ XML/ 文档/ 的/ WebServices/ 测试/ 方面/ ,/ 也/ 有/ 学者/ 研究/ 了/ WebServices/ 可靠性/ 和/ 鲁棒性/ 测试方法/ ./ Martin/ 等/ 人/ [/ 3/ ]/ 从/ 扩展/ WSDL/ 的/ 定义/ 来/ 增强/ 其/ 描述/ 能力/ 的/ 角度/ 展开/ 研究/ ,/ 开发/ 了/ 一个/ Web/ 服务/ 测试工具/ ,/ 该/ 工具/ 能够/ 依据/ WSDL/ 文档/ 产生/ Java/ 客户端/ 测试代码/ ,/ 并/ 将/ 生成/ 代码/ 中/ 的/ 封装/ 类转/ 送到/ Java/ 测试数据/ 生成/ 工具/ 中/ ,/ 最终/ 生成/ Web/ 服务/ 测试数据/ ;/ Sneed/ 等/ 人/ 提出/ 通过/ 扩展/ WSDL/ 文档/ ,/ 增加/ WSDL/ 的/ 描述/ 能力/ ,/ 然后/ 结合/ WSDL/ 树/ 结点/ 并用/ 扩展/ 的/ 刻面/ 约束/ 和/ 前置条件/ 来/ 生成/ 相应/ 的/ 测试数据/ [/ 4/ ]/ ;/ Jiang/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 一种/ 基于/ 合约/ 变异/ 技术/ 的/ 测试数据/ 生成/ 方法/ ,/ 该/ 方法/ 能/ 产生/ int/ 、/ float/ 和/ double/ 的/ 3/ 种/ 变量/ 变异/ 测试数据/ ;/ Bai/ 等/ 人/ [/ 6/ ]/ 提出/ 了/ 基于/ WSDL/ 自动/ 生成/ 测试用例/ 的/ 方法/ ,/ 将/ WSDL/ 文件/ 解析/ 成/ 结构化/ 的/ DOM/ (/ DocumentObjectModel/ )/ 树/ ,/ 从/ 测试数据/ 和/ 测试/ 操作/ 两个/ 角度/ 来/ 产生/ 测试用例/ ;/ Hanna/ 等/ 人/ [/ 7/ ]/ 通过/ WSDL/ 建立/ 数据类型/ 的/ 抽象/ 模型/ ,/ 根据/ WSDL/ 的/ 定义/ 利用/ 随机/ 法/ 和/ 边界值/ 法/ 生成/ 基本/ 数据类型/ 的/ 测试数据/ ,/ 但/ 该/ 方法/ 没有/ 考虑/ 复杂/ 数据类型/ 的/ 结构/ ,/ 无法/ 将/ 简单/ 数据/ 有效/ 地/ 组合成/ 复杂/ 数据/ ./ 在/ 基于/ XML/ 建模/ 的/ Web/ 服务/ 测试/ 研究/ 领域/ ,/ Offutt/ 工作组/ 在/ SOAP/ 消息/ 形式化/ 描述/ 的/ 基础/ 上/ 扩展/ 出/ 基于/ RTG/ (/ RegularTreeGrammar/ )/ 的/ 一套/ 模型/ [/ 8/ ]/ ,/ 并/ 针对/ XMLSchema/ 提出/ 一套/ RPC/ (/ RemoteProcedureCall/ )/ 干扰/ 算子/ 用于/ Web/ 服务/ 测试/ ;/ 此后/ 他们/ 接着/ 提出/ 一套/ 扩展/ 的/ 干扰/ 算子/ ,/ 基本/ 可/ 分为/ insert/ 、/ delete/ 、/ change/ 三大类/ [/ 9/ ]/ ./ deAlmeida/ 等/ 人/ [/ 10/ ]/ 基于/ 相关/ 研究/ 又/ 增添/ 了/ 一些/ SOAP/ 变异/ 算子/ ,/ 并且/ 直接/ 应用/ 于/ SOAP/ 消息/ 生成/ 测试用例/ ./ 这种/ 方法/ 不/ 依赖/ XML/ 模式/ ,/ 并且/ 能/ 直接/ 修改/ SOAP/ 消息/ ,/ 减少/ 运行/ 时间/ ./ 基于/ RTG/ 模型/ ,/ deMeloAna/ 等/ 人/ [/ 11/ ]/ 提出/ 了/ 扩展/ 数据/ 值/ 干扰/ (/ 添加/ 无效/ 值/ )/ 和/ 数据通信/ 干扰/ (/ 关系/ 策略/ )/ 算子/ ,/ 在/ 数据通信/ 干扰/ 中/ 扩展/ 了/ 变异/ 算子/ (/ 增加/ 了/ minoccus/ 、/ allandchoice/ )/ 并且/ 扩大/ 了/ 其/ 使用/ 范围/ ,/ 同时/ 适用/ 于/ RPC/ 和/ DocumentPage3/ 两种/ 通信/ 类型/ ./ 此外/ ,/ 针对/ WebServices/ 测试/ 中/ Oracle/ 不能/ 确定/ 的/ 场景/ ,/ Sun/ 等/ 人/ [/ 12/ -/ 14/ ]/ 提出/ 了/ 基于/ 自/ 适应/ 测试/ 和/ 蜕变/ 测试/ 技术/ 的/ WebServices/ 测试方法/ ,/ 并/ 通过/ 实例/ 验证/ 了/ 其/ 在/ Oracle/ 未知/ 的/ 情况/ 下/ 具有/ 一定/ 的/ 测试/ 效果/ ./ Hanna/ 等/ 人/ [/ 15/ ]/ 提出/ 了/ 一个/ 用于/ WebServices/ 服务质量/ 的/ 鲁棒性/ 测试/ 框架/ ,/ 该/ 框架/ 建立/ 在/ 测试用例/ 生成/ 规则/ 的/ 基础/ 之上/ ,/ 对/ 特定/ 领域/ 的/ WebServices/ 具有/ 一定/ 的/ 测试/ 效果/ ./ Bozkurt/ 等/ 人/ [/ 16/ ]/ 调研/ 了/ 以往/ 关于/ WebServices/ 测试/ 方面/ 的/ 相关/ 知识/ ,/ 分析/ 了/ 当前/ WebServices/ 测试/ 的/ 优劣/ 和/ 劣势/ ,/ 并/ 依据/ 应用/ 错误/ 的/ 级别/ 将/ 基于/ 错误/ 的/ WebServices/ 测试/ 分为/ XML/ (/ SOAP/ )/ 消息/ 扰动/ 、/ 网络层/ 错误/ 注入/ 和/ WebServices/ 规格/ 说明/ 变异/ 3/ 类/ ./ Laranjeiro/ 等/ 人/ [/ 17/ ]/ 指出/ 了/ 在/ SOA/ 环境/ 下/ 的/ WebServices/ 鲁棒性/ 验证/ 存在/ 的/ 主要/ 问题/ ,/ 并/ 提出/ 了/ 一种/ 基于/ 相关/ 鲁棒性/ 测试/ 的/ 方法/ ,/ 能/ 对/ SOA/ 框架/ 下/ 的/ 简单/ WebServices/ 进行/ 鲁棒性/ 验证/ ./ 现有/ 的/ 研究/ 主要/ 是/ 针对/ WebServices/ 整体/ 架构/ 提出/ 的/ 功能性/ 测试方法/ ,/ 虽/ 已有/ 部分/ 对/ 安全/ 属性/ 测试/ 的/ 研究/ ,/ 但/ 也/ 仅/ 是/ 将/ 传统/ 的/ Web/ 应用程序/ 的/ 脆弱性/ 和/ 攻击/ 类型/ 映射/ 到/ WebServices/ 中/ 的/ 相应/ 方面/ ,/ 并未/ 考虑/ 到/ WebServices/ 的/ 特殊/ 架构/ 下/ 的/ 安全性/ ,/ 测试/ 不够/ 完整/ 和/ 规范/ ./ 因此/ ,/ 本文/ 基于/ SOAP/ 消息/ 的/ 安全/ 规则/ 研究/ WebServices/ 的/ 安全性/ 测试方法/ 具有/ 重要/ 的/ 理论/ 价值/ ./ 3/ 安全/ 规则/ 变异/ 测试/ 框架/ 针对/ 安全/ 规则/ 这一/ 特有/ 的/ SOAP/ 消息/ 组成/ 部图/ 1/ 安全/ 规则/ 变异/ 测试/ 框架/ 当/ 给定/ 安全/ 规则/ 及/ 定义/ 一套/ 变异/ 算子/ ,/ 在/ 给定/ 一个/ 消息/ 请求/ 集/ 的/ 情况/ 下/ ,/ 基于/ 原始/ 的/ 和/ 变异/ 后/ 的/ 安全/ 规则/ 评估/ 每个/ 请求/ ,/ 相应/ 请求/ 的/ 评估/ 将/ 产生/ 两分/ ,/ 从/ 消息/ 机密性/ 、/ 完整性/ 及/ 身份/ 认证/ 等/ 方面/ 进行/ SOAP/ 安全/ 属性/ 归类/ ,/ 首先/ 给出/ 一种/ 安全/ 规则/ 变异/ 测试/ 框架/ ,/ 然后/ 基于/ 该/ 测试/ 框架/ 研究/ 变异/ 点/ 判定/ 规则/ 库/ ,/ 并/ 设计/ 相关/ 的/ 安全/ 规则/ 变异/ 操作/ 算子/ 及/ 漏洞/ 判定/ 准则/ ,/ 最后/ 给出/ 一种/ 基于/ 优先级/ 和/ 权重/ 策略/ 的/ 变异/ 算子/ 选择/ 方法/ ./ 3.1/ 变异/ 测试/ 框架/ 变异/ 测试/ 框架/ 主要/ 用来/ 指导/ WebServices/ 安全性/ 测试/ 过程/ ,/ 进一步提高/ 测试/ 活动/ 的/ 规范性/ ,/ 并/ 减少/ 测试/ 活动/ 的/ 盲目性/ ,/ 增加/ 测试/ 效能/ ./ 安全/ 规则/ 变异/ 测试/ 框架/ 如图/ 1/ 所示/ ./ 核心/ 模块/ 及/ 流程/ 如下/ :/ (/ 1/ )/ Mutator/ (/ 变异/ 体/ 生成器/ )/ 在/ SOAP/ 请求/ 消息/ 安全/ 规则/ 上/ 分别/ 应用/ 变异/ 算子/ ,/ 产生/ 出/ 大量/ 的/ 变异/ 体/ ./ 此处/ 每个/ 变异/ 算子/ 对/ 原始/ 的/ 安全/ 规则/ 只/ 做/ 较/ 小/ 的/ 语法/ 或/ 语义/ 的/ 改动/ ,/ 并且/ 保证/ 生成/ 的/ 变异/ 体在/ 语法/ 上/ 的/ 正确性/ 和/ 一致性/ ./ (/ 2/ )/ Analyzer/ (/ 变异/ 体/ 检测/ 分析器/ )/ 这个/ 变异/ 体/ 检测/ 分析器/ 能够/ 对比/ 和/ 分析/ 在/ 原始/ SOAP/ 请求/ 响应/ 消息/ 安全/ 规则/ 和/ 变异/ 体/ SOAP/ 消息/ 安全/ 规则/ 上/ 运行/ 的/ 同一个/ 测试用例/ 产生/ 的/ 测试/ 结果/ ,/ 并/ 依据/ 漏洞/ 判定/ 准则/ 进行/ 安全性/ 分析/ ,/ 判定/ 是否/ 存在/ 漏洞/ 以及/ 为/ 何种/ 漏洞/ ./ 如果/ 测试/ 结果/ 不同/ ,/ 则/ 变异/ 体/ 被/ 杀死/ ;/ 否则/ ,/ 需要/ 通过/ 可视化/ 的/ 对比/ 分析/ ,/ 人工/ 判断/ 和/ 区分/ 是否/ 为/ 等价/ 变异/ 体/ ./ 充分性/ 评估/ 报告/ 器/ )/ (/ 3/ )/ TestAdequacyEvaluation/ &/ Report/ (/ 测试/ 全部/ 测试用例/ 执行/ 之后/ ,/ 由/ 测试/ 充分性/ 评估/ 报告/ 器/ 负责/ 收集/ 测试/ 结果/ 进行/ 分析/ ,/ 并/ 得出/ 测试/ 充分性/ 评估/ 的/ 结论/ ,/ 最终/ 评价/ WebServices/ 的/ 安全性/ ./ 种/ 响应/ 结果/ ./ 如果/ 这/ 两种/ 响应/ 结果/ 是/ 不同/ 的/ ,/ 我们/ 就/ 说/ 这个/ 安全/ 规则/ 变异/ 体/ 被/ 杀死/ ,/ 否则/ 没有/ 被/ 杀死/ ./ 最后/ 依据/ 漏洞/ 判定/ 准则/ 进行/ 安全性/ 分析/ ,/ 判定/ 是否/ 存/ Page4/ 在/ 漏洞/ 以及/ 为/ 何种/ 漏洞/ ./ 3.2/ 变异/ 规则/ 库及/ 变异/ 算子/ 设计/ 3.2/ ./ 1/ 变异/ 点/ 判定/ 规则/ 定义/ 1/ ./ 安全/ 规则/ 变异/ 点/ 是/ 指/ 该处/ 由于/ 某种原因/ 可能/ 存在/ 不/ 安全性/ 因素/ 、/ 很/ 容易/ 引起/ 非/ 预期/ 的/ 安全/ 问题/ 的/ 位置/ ./ 定义/ 2/ ./ ST/ -/ UnT/ (/ SecurityToken/ -/ Username/ -/ Token/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 用户名/ 令牌/ 认证/ 机制/ 时/ ,/ 则/ 该/ 令牌/ 即/ 为/ 变异/ 点/ ./ 定义/ 3/ ./ ST/ -/ KeT/ (/ SecurityToken/ -/ Kerberos/ -/ Token/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ Kerberos/ 票据/ 认证/ 机制/ ,/ 则/ 该/ 票据/ 即/ 为/ 变异/ 点/ ./ 定义/ 4/ ./ ST/ -/ XT/ (/ SecurityToken/ -/ X/ ./ 509Token/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ X/ ./ 509/ 证书/ 认证/ 机制/ 时/ ,/ 则/ 该/ 证书/ 即/ 为/ 变异/ 点/ ./ 定义/ 5/ ./ TS/ (/ Timestamp/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 时间/ 戳/ 技术/ 时/ ,/ 则/ 该/ 时间/ 戳/ 元素/ 即/ 为/ 变异/ 点/ ./ 定义/ 6/ ./ Ent/ (/ Encrypted/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 加密技术/ 时/ ,/ 则/ 该/ 加密/ 元素/ 即为/ 变表/ 1/ 安全/ 规则/ 变异/ 点/ 判定/ 规则/ 库/ 编号/ 判定/ 规则/ 1ST/ -/ UnT/ 安全/ 令牌/ 变异/ 点当/ WebServices/ 使用/ 用户名/ 令牌/ 认证/ 机制/ 时/ ,/ 则/ 该/ 令牌/ 成为/ 变异/ 点/ 2ST/ -/ KeT/ 安全/ 令牌/ 变异/ 点当/ WebServices/ 使用/ Kerberos/ 票据/ 认证/ 机制/ ,/ 则/ 该/ 票据/ 成为/ 变异/ 点/ 3ST/ -/ XT/ 安全/ 令牌/ 变异/ 点当/ WebServices/ 使用/ X/ ./ 509/ 证书/ 认证/ 机制/ 时/ ,/ 则/ 该/ 证书/ 成为/ 变异/ 点/ 4TS5Ent6Sin7U/ -/ Role/ 用户/ 类型/ 变异/ 点当/ WebServices/ 使用/ 用户/ 角色/ 技术/ 时/ ,/ 则/ 该/ 角色/ 成为/ 变异/ 点/ 8U/ -/ Att/ 用户/ 属性/ 变异/ 点当/ WebServices/ 使用/ 用户/ 属性/ 技术/ 时/ ,/ 则/ 该/ 属性/ 成为/ 变异/ 点/ 9PrP/ 隐私/ 策略/ 变异/ 点当/ WebServices/ 使用/ 隐私/ 策略/ 技术/ 时/ ,/ 则/ 该/ 策略/ 成为/ 变异/ 点/ 10SHSecurity/ 报头/ 块/ 变异/ 点当/ WebServices/ 中/ 使用/ WS/ -/ Security/ 安全/ 规范/ 时/ ,/ 则/ 该/ Security/ 报头/ 块/ 成为/ 变异/ 点/ 时间/ 戳/ 变异/ 点当/ WebServices/ 使用/ 时间/ 戳/ 技术/ 时/ ,/ 则/ 该/ 时间/ 戳/ 成为/ 变异/ 点/ 3.2/ ./ 2/ 变异/ 算子/ 设计/ 定义/ 12/ ./ 安全/ 规则/ 变异/ 算子/ τ/ 是/ 指/ 针对/ 变异/ 点/ 生成/ 测试用例/ 的/ 规则/ ./ 对/ 任意/ 变异/ 点/ Ω/ ,/ 都/ 可以/ 选用/ 适当/ 的/ 安全/ 规则/ 变异/ 算子/ τ/ i/ ,/ 生成/ 测试用例/ 集/ {/ e1/ ,/ e2/ ,/ e3/ ,/ …/ ,/ en/ }/ ./ 定义/ 13/ ./ 安全/ 规则/ 变异/ 算子/ 可以/ 进行/ 复合/ 运算/ ,/ 记/ 为/ π/ ./ 设/ τ/ 1/ 和/ τ/ 2/ 是/ 两个/ 安全/ 规则/ 变异/ 算子/ ,/ 变异/ 算子/ τ/ 1/ 和/ τ/ 2/ 的/ 复合/ 运算/ 记/ 作/ τ/ 1/ π/ τ/ 2/ ,/ 表示/ τ/ 1/ 处理/ 后/ 的/ 结果/ 再/ 由/ τ/ 2/ 进行/ 处理/ ,/ 由此/ 生成/ 新/ 的/ 测试用例/ ./ 设计/ 安全/ 规则/ 变异/ 算子/ 的/ 关键在于/ 根据/ 变异/ 点/ 的/ 特性/ 来/ 构造/ 最/ 有效/ 的/ 测试用例/ ,/ 使/ 其/ 能够/ 尽可能/ 多地/ 引发/ WebServices/ 的/ 安全漏洞/ ./ 安全/ 规则/ 变异/ 算子/ 生成/ 的/ 测试用例/ 主要/ 是/ 非正常/ 的/ 数据/ ,/ 但/ 也/ 可能/ 异点/ ./ 定义/ 7/ ./ Sin/ (/ Signature/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 签名/ 技术/ 时/ ,/ 则/ 该/ 签名/ 元素/ 即/ 为/ 变异/ 点/ ./ 定义/ 8/ ./ U/ -/ Role/ (/ User/ -/ Role/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 用户/ 角色/ 技术/ 时/ ,/ 则/ 该/ 角色/ 即/ 为/ 变异/ 点/ ./ 定义/ 9/ ./ U/ -/ Att/ (/ User/ -/ Attribute/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 用户/ 属性/ 技术/ 时/ ,/ 则/ 该/ 属性/ 即/ 为/ 变异/ 点/ ./ 定义/ 10/ ./ PrP/ (/ PrivacyPolicy/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 使用/ 隐私/ 策略/ 技术/ 时/ ,/ 则/ 该/ 策略/ 元素/ 即/ 为/ 变异/ 点/ ./ 定义/ 11/ ./ SH/ (/ SecurityHeader/ )/ 变异/ 点/ 是/ 指当/ WebServices/ 中/ 使用/ WS/ -/ Security/ 安全/ 规范/ 时/ ,/ 则/ 该/ Security/ 报头/ 块/ 即/ 为/ 变异/ 点/ ./ 通过/ 对/ WebServices/ 运行/ 特点/ 和/ 各类/ SOAP/ 消息/ 安全/ 类型/ 漏洞/ 的/ 分析/ ,/ 可以/ 总结/ 归纳/ 出/ WebServices/ 中/ 可能/ 存在/ 的/ 各种/ 安全/ 问题/ 的/ 编码/ 模式/ ,/ 从而/ 归纳/ 出/ 变异/ 点/ 判定/ 规则/ ,/ 形成/ 安全/ 规则/ 变异/ 点/ 判定/ 规则/ 库/ (/ 表/ 1/ )/ ./ 包含/ 一些/ 非正常/ 的/ 操作/ ./ 经过/ 对/ 各种/ WebServices/ 的/ 安全漏洞/ 特点/ 的/ 仔细分析/ 以及/ 深入研究/ 攻击者/ 利用/ 漏洞/ 入侵/ Web/ 服务/ 系统/ 的/ 各种/ 手段/ ,/ 可以/ 归纳/ 出/ 有效/ 的/ 安全/ 规则/ 变异/ 算子/ ,/ 并/ 利用/ 算子/ 的/ 复合/ 运算/ 来/ 表示/ 一些/ 复杂/ 的/ 测试用例/ 生成/ 规则/ ./ 安全/ 规则/ 变异/ 算子/ 如表/ 2/ 所示/ ./ 随着/ 对/ WebServices/ 技术/ 的/ 不断更新/ ,/ 可以/ 设计/ 新/ 的/ 算子/ 加入/ 到/ 变异/ 算子/ 表中/ ./ 运用/ 表/ 2/ 中/ 的/ 安全/ 规则/ 变异/ 算子/ ,/ 可以/ 针对/ 不同/ 的/ 变异/ 点来/ 构造/ 错误/ 注入/ 测试用例/ 集/ ./ 通常/ 对/ 一个/ 变异/ 点要/ 根据/ 其/ 特性/ 综合/ 运用/ 不同/ 的/ 变异/ 算子/ 来/ 生成/ 测试用例/ 集/ ,/ 以/ 保障/ 测试/ 的/ 充分性/ ./ 表/ 3/ 还/ 给出/ 了/ 对/ 一个/ 变异/ 点/ 进行/ 测试/ 时/ ,/ 对/ 其/ 结果/ 进行/ 分析/ 以/ 判定/ 是否/ 存在/ 安全漏洞/ 的/ 准则/ ./ Page5/ 表/ 2/ 安全/ 规则/ 变异/ 算子/ 编号/ 1CUT/ (/ ChangeUsernameToken/ )/ 改变/ 用户名/ 令牌/ 修改/ 用户名/ 令牌/ 使/ 其/ 无效/ 2CKT/ (/ ChangeKerberosTicket/ )/ 篡改/ Kerberos/ 票据/ 篡改/ Kerberos/ 票据/ 的/ 某些/ 值/ ,/ 产生/ 错误/ 的/ Kerberos/ 票据/ 等/ 3CXT/ (/ ChangeX/ ./ 509Expires/ )/ 改变/ X/ ./ 509/ 证书/ 的/ 有效期/ 改变/ 有效期/ ,/ 使/ 其/ 过期/ 等/ 4MEE/ (/ ModifyEncryptedElement/ )/ 5MEEH/ (/ ModifyEncrypted6CEA/ (/ ChangeEncryptedAlgorithm/ )/ 修改/ 加密/ 的/ 算法/ 尝试/ 使用/ 不同/ 的/ 加密算法/ 7MSE/ (/ ModifySignatureElement/ )/ 修改/ 签名/ 元素/ 增加/ 签名/ 元素/ 的/ 个数/ (/ 例如/ 过载/ 签名/ )/ 、/ 减少/ 签名/ 元素/ 的/ 个/ 89CSA/ (/ ChangeSignatureAlgorithm/ )/ 修改/ 签名/ 的/ 算法/ 尝试/ 使用/ 不同/ 的/ 签名/ 算法/ 10CHS/ (/ ChangeHeaderSecurity/ )/ 改变/ Security/ 报头/ 块/ 的/ 个数/ 增加/ 、/ 减少/ Security/ 的/ 个数/ ,/ 以/ 跳/ 过/ 安全性/ 验证/ 11CT/ (/ ChangeTimestamp/ )/ 12CUR/ (/ ChangeUserRole/ )/ 13CUA/ (/ ChangeUserAttribute/ )/ 14CPP/ (/ ChangePrivacyPolicy/ )/ 表/ 3/ 漏洞/ 判定/ 准则/ 判定/ 规则/ ST/ -/ UnTST/ -/ KeTST/ -/ XTTSEntMEE/ 、/ MEEH/ 、/ CEA/ 如果/ 接受/ 了/ 错误/ 的/ 加密/ 元素/ ,/ 则/ 存在/ 漏洞/ ./ SinMSE/ 、/ MSH/ 、/ CSA/ 如果/ 接受/ 了/ 错误/ 的/ 签名/ 元素/ ,/ 则/ 存在/ 漏洞/ ./ U/ -/ RoleU/ -/ AttPrPSHCHS/ 、/ CHS/ π/ CT/ 、/ CHS/ π/ MSE/ 如果/ 不能/ 识别/ 错误/ 的/ Security/ 块/ ,/ 未/ 进行/ 限制/ 或/ 对/ 错误/ 做出/ 反馈/ 而/ 泄露/ 重要/ 信息/ ,/ 则/ 存在/ 漏洞/ ./ 因/ 篇幅/ 有限/ ,/ 下面/ 仅/ 给出/ 几种/ 常用/ 变异/ 算子/ 的/ 变异/ 方法/ 和/ 过程/ (/ 仅/ 列出/ SOAP/ 消息/ 的/ 主要/ 编码/ 部分/ )/ ./ 如果/ 用户/ 访问/ 内容/ 超出/ 了/ 自己/ 的/ 访问/ 权限/ ,/ 则/ 存在/ 漏洞/ ./ 如果/ 用户/ 访问/ 内容/ 超出/ 了/ 自己/ 的/ 访问/ 权限/ ,/ 则/ 存在/ 漏洞/ ./ 如果/ 用户/ 访问/ 内容/ 超出/ 了/ 自己/ 的/ 访问/ 权限/ ,/ 则/ 存在/ 漏洞/ ./ 例/ 1/ ./ CUT/ 变异/ ./ 用户名/ 令牌/ 用/ 〈/ wsse/ :/ UsernameToken/ 〉/ 表示/ ,/ 作为/ 验证/ 用户名/ 和/ 可选/ 密码/ 信息/ 的/ 方式/ ,/ WebServices/ 某种/ 情况/ 下/ 部分/ SOAP/ 消息/ 变异/ 前及/ 变异/ 后/ 结果/ 如下/ ./ CUT/ 变异/ 前/ :/ 01/ 〈/ wsse/ :/ UsernameToken/ 〉/ 02/ 〈/ wsse/ :/ Username/ 〉/ Lq/ 〈/ // wsse/ :/ Username/ 〉/ 03/ 〈/ wsse/ :/ Password/ 〉/ liq0045/ 〈/ // wsse/ :/ Password/ 〉/ 04/ 〈/ // wsse/ :/ UsernameToken/ 〉/ CUT/ 变异/ 后/ :/ 01/ 〈/ wsse/ :/ UsernameToken/ 〉/ 02/ 〈/ wsse/ :/ Username/ 〉/ LQ/ 〈/ // wsse/ :/ Username/ 〉/ 03/ 〈/ wsse/ :/ Password/ 〉/ liqing0045/ 〈/ // wsse/ :/ Password/ 〉/ 04/ 〈/ // wsse/ :/ UsernameToken/ 〉/ 个数/ 、/ 改变/ 加密/ 元素/ 的/ 上下文/ 位置/ 等数/ 、/ 改变/ 签名/ 元素/ 的/ 上下文/ 位置/ 等/ 修改/ 时间/ 戳/ 元素/ 的/ 有效期/ 使/ 其/ 过期/ 、/ 结合/ soap/ :/ role/ 属性/ 跳过/ 时间/ 戳/ 限制/ 例/ 2/ ./ MSE/ 变异/ ./ WebServices/ 某种/ 情况/ 下/ 部分/ SOAP/ 消息/ 变异/ 前及/ 变异/ 后/ 结果/ 如下/ ./ MSE/ 变异/ 前/ :/ 01/ 〈/ wsse/ :/ Security/ 〉/ 02/ …/ 03/ 〈/ ds/ :/ ReferenceURI/ =/ "/ #/ CreditCard/ "/ 〉/ 04/ …/ 05/ 〈/ // ds/ :/ Reference/ 〉/ 06/ …/ 07/ 〈/ soap/ :/ Bodywsu/ :/ Id/ =/ "/ CreditCard/ "/ 〉/ 08/ …/ 09/ 〈/ // soap/ :/ Body/ 〉/ 10/ …/ MSE/ 变异/ 后/ :/ 01/ 〈/ wsse/ :/ Security/ 〉/ 02/ …/ Page603/ 〈/ ds/ :/ ReferenceURI/ =/ "/ #/ CreditCard/ "/ 〉/ 04/ …/ 05/ 〈/ // ds/ :/ Reference/ 〉/ 06/ …/ 07/ 〈/ wrapper/ 〉/ 08/ 〈/ soap/ :/ Bodywsu/ :/ Id/ =/ "/ CreditCard/ "/ 〉/ 09/ …/ 10/ 〈/ // soap/ :/ Body/ 〉/ 11/ 〈/ // wrapper/ 〉/ 12/ 〈/ // soap/ :/ Header/ 〉/ 13/ 〈/ soap/ :/ Bodywsu/ :/ Id/ =/ "/ ChangedBody/ "/ 〉/ 14/ …/ 15/ 〈/ // soap/ :/ Body/ 〉/ 16/ …/ 例/ 3/ ./ MEE/ 变异/ ./ WebServices/ 某种/ 情况/ 下/ 部分/ SOAP/ 消息/ 变异/ 前及/ 变异/ 后/ 结果/ 如下/ ./ MEE/ 变异/ 前/ :/ 01/ …/ 02/ 〈/ xenc/ :/ EncrytedDataxmlns/ :/ xenc/ =/ "/ http/ :/ // // www/ ./ 03/ 〈/ xenc/ :/ CipherData/ 〉/ 04/ 〈/ xenc/ :/ CipherValue/ 〉/ …/ 〈/ // xenc/ :/ CipherValue/ 〉/ 05/ 〈/ // xenc/ :/ CipherData/ 〉/ 06/ 〈/ // xenc/ :/ EncrytedData/ 〉/ 07/ …/ MEE/ 变异/ 后/ :/ 01/ …/ 02/ 〈/ xenc/ :/ EncrytedDataxmlns/ :/ xenc/ =/ "/ http/ :/ // // www/ ./ 03/ 〈/ xenc/ :/ CipherData/ 〉/ 04/ 〈/ xenc/ :/ CipherValue/ 〉/ …/ 〈/ // xenc/ :/ CipherValue/ 〉/ 05/ 〈/ // xenc/ :/ CipherData/ 〉/ 06/ 〈/ // xenc/ :/ EncrytedData/ 〉/ 07/ 〈/ xenc/ :/ EncrytedDataxmlns/ :/ xenc/ =/ "/ http/ :/ // // www/ ./ 08/ 〈/ xenc/ :/ CipherData/ 〉/ 09/ 〈/ xenc/ :/ CipherValue/ 〉/ …/ 〈/ // xenc/ :/ CipherValue/ 〉/ 10/ 〈/ // xenc/ :/ CipherData/ 〉/ 11/ 〈/ // xenc/ :/ EncrytedData/ 〉/ 12/ …/ 3.2/ ./ 3/ 变异/ 算子/ 选择/ 方法/ 严重性/ 和/ 优先级/ 是/ Web/ 服务/ 测试/ 缺陷/ 的/ 两个/ 重要/ 因素/ ,/ 一般/ 地/ 严重性/ 程度/ 高/ 的/ Web/ 服务/ 缺陷/ 应/ 赋予/ 较/ 高/ 优先级/ ,/ 并/ 需要/ 及时处理/ ;/ 而/ 严重性/ 程度/ 低/ 的/ Web/ 服务/ 缺陷/ 应该/ 赋予/ 较/ 低优先级/ ,/ 可以/ 稍后/ 再/ 做/ 处理/ ./ 对于/ WebServices/ 安全性/ 测试/ 而言/ ,/ 本文/ 使用/ 优先级/ 及/ 权重/ 策略/ 作为/ 选择/ 何种/ 变异/ 算子/ 的/ 依据/ ./ 每种/ 变异/ 类型/ 对应/ 着/ 相应/ 的/ 变异/ 操作/ 算子/ ,/ 确定/ 了/ 变异/ 类型/ 的/ 优先级/ 后/ ,/ 即可/ 确定/ 相应/ 的/ 变异/ 算子/ 的/ 优先级/ ./ 根据/ Web/ 服务/ 系统安全/ 需求/ ,/ 定义/ 了/ 如下/ 几条/ 确定/ 各种/ 变异/ 类型/ 优先级/ 的/ 准则/ ./ 准则/ 1/ ./ 根据/ 待测/ WebServices/ 强调/ 的/ 安全/ 需求/ ,/ 确定/ 相应/ 属性/ 的/ 变异/ 类型/ 为/ 最高/ 优先级/ ,/ 定制/ 用户/ 需求/ 优先级/ 高于/ 一般/ 用户/ 需求/ 优先级/ ./ 的/ 安全/ 需求/ 优先级/ ./ 准则/ 2/ ./ 确定/ 的/ 安全/ 需求/ 优先级/ 高于/ 不/ 确定/ 准则/ 3/ ./ 导致/ Web/ 服务/ 系统/ 主要/ 功能/ 错误/ 或者/ 造成/ 服务/ 崩溃/ 、/ 数据/ 丢失/ 的/ 变异/ 类型/ 为/ 最高/ 优先级/ ./ 为/ 较/ 高/ 优先级/ ./ 低/ 的/ 变异/ 类型/ 为/ 较/ 高/ 优先级/ ./ 准则/ 4/ ./ 影响/ Web/ 服务/ 安全/ 性能/ 的/ 变异/ 类型/ 准则/ 5/ ./ Web/ 服务/ 测试/ 响应/ 时间/ 快/ 、/ 资源/ 消耗/ 准则/ 6/ ./ 导致/ Web/ 服务/ 功能/ 和/ 性能/ 一般/ 缺陷/ 准则/ 7/ ./ 对/ Web/ 服务/ 安全/ 影响/ 非常/ 轻微/ 或出/ 的/ 变异/ 类型/ 为/ 一般/ 优先级/ ./ 现/ 几率/ 很/ 低/ 的/ 变异/ 类型/ 为/ 低优先级/ ./ 其中/ 准则/ 1/ 和/ 准则/ 2/ 根据/ Web/ 服务/ 安全/ 需求/ 便/ 可以/ 确定/ 选择/ 的/ 变异/ 类型/ 和/ 变异/ 算子/ ./ 而/ 准则/ 3/ 到/ 准则/ 7/ 则/ 是/ 基于/ 历史/ Web/ 服务/ 测试/ 结果/ 作为/ 选择/ 变异/ 类型/ 及其/ 变异/ 算子/ 优先级/ 的/ 根据/ ./ 此外/ ,/ 对于/ WebServices/ 的/ 安全性/ 测试/ ,/ 判断/ 是否/ 进行/ 了/ 充分/ 的/ 测试/ 取决于/ 测试用例/ 集/ 的/ 选择/ ./ 综合/ 考虑/ 所/ 需/ 时间/ 和/ 费用/ 的/ 问题/ ,/ 通常/ 无法/ 执行/ 全部/ 测试用例/ ,/ 这/ 就/ 需要/ 构造/ 一个/ 子集/ 来/ 进行/ 测试/ ./ 评价/ 子集/ 的/ 测试/ 充分性/ ,/ 或者说/ 其/ 揭示/ 漏洞/ 的/ 能力/ ,/ 需要/ 考虑/ 该/ 子集/ 包含/ 测试用例/ 的/ 数量/ ,/ 同时/ 还/ 需要/ 评价/ 各类/ 测试用例/ 的/ 重要性/ 和/ 其/ 在/ 测试用例/ 子/ 集中/ 的/ 分布/ 情况/ ./ 设待测/ WebServices/ 集合/ 为/ WS/ =/ {/ WS1/ ,/ WS2/ ,/ …/ ,/ WSn/ }/ ,/ 变异/ 类型/ 的/ 向量/ 犕/ 犜/ =/ (/ MT1/ ,/ MT2/ ,/ …/ ,/ MTk/ )/ ,/ MTi/ 表示/ 待测/ WebServices/ 的/ 第/ i/ 种/ 变异/ 类型/ ,/ 对于/ 任意/ WebServicesWSi/ =/ {/ WSi1/ ,/ WSi2/ ,/ …/ ,/ WSik/ }/ ,/ 其中/ 1/ / i/ / n/ ,/ WSij/ 表示/ WebServicesWSi/ 第/ j/ 种/ 变异/ 类型/ 的/ 值/ ,/ 用/ Wi/ 来/ 代表/ 变异/ 类型/ MTi/ 的/ 权值/ ,/ 表示/ 该/ 变异/ 类型/ 对/ 发现/ 该/ WebServices/ 的/ 安全漏洞/ 的/ 重要/ 程度/ ,/ 称为/ 该/ 变异/ 类型/ 的/ 权重/ ,/ 权重/ 向量/ 为/ 犠/ =/ (/ W1/ ,/ W2/ ,/ …/ ,/ Wk/ )/ ./ 定义/ 14/ ./ Gst/ (/ 1/ / s/ / m/ ,/ 1/ / t/ / k/ )/ 是/ 第/ s/ 个测/ Page7/ 试/ 用户/ 根据/ 个人/ 的/ 经验/ 为/ 变异/ 类型/ MTt/ 所/ 指定/ 的/ 等级/ (/ 等级/ 从/ 1/ 开始/ ,/ 等级/ 用/ 连续/ 正整数/ 来/ 表示/ ,/ 1/ 表示/ 最高/ 等级/ ,/ 数值/ 越大/ ,/ 等级/ 越低/ )/ ,/ Gt/ 表示/ 第/ t/ 种/ 变异/ 类型/ 的/ 统一/ 等级/ ,/ 采用/ 均值/ 法/ 计算/ 出/ 每种/ 变异/ 类型/ 的/ 最终/ 统一/ 等级/ ./ 其中/ ,/ Gi/ 表示/ 第/ i/ (/ 1/ / i/ / k/ )/ 种/ 变异/ 类型/ 的/ 最终/ 统一/ 等级/ ,/ m/ 表示/ 测试/ 用户/ 的/ 个数/ ./ 定义/ 15/ ./ 若/ 变异/ 类型/ 对应/ 的/ 变异/ 算子/ 发现/ 的/ 错误/ 数越/ 多/ ,/ 即/ 有效率/ 越高/ ,/ 则/ 该/ 变异/ 类型/ 对/ 发现/ WebServices/ 安全性/ 漏洞/ 越/ 有效/ ./ 客观/ 上/ 采用/ 随机/ 统计法/ (/ 多次/ 随机/ 选取/ 一定/ 数目/ 的/ WebServices/ )/ 计算/ 每/ 一种/ 变异/ 类型/ 变异/ 算子/ 的/ 有效率/ ,/ 作为/ 客观/ 描述/ 变异/ 类型/ 对于/ 发现/ 当前/ WebServices/ 安全漏洞/ 的/ 重要性/ ./ Cij/ (/ 1/ / j/ / k/ )/ 表示/ 第/ i/ 次第/ j/ 种/ 变异/ 类型/ 的/ 变异/ 算子/ 发现错误/ 的/ 数目/ ,/ Cj/ 表示/ 第/ j/ 种/ 变异/ 类型/ 的/ 最终/ 发现错误/ 的/ 数目/ ,/ 使用/ 均值/ 法/ 计算/ 出/ 每种/ 变异/ 类型/ 最终/ 发现错误/ 的/ 个数/ ./ 其中/ ,/ Cj/ 表示/ 第/ j/ (/ 1/ / j/ / k/ )/ 种/ 变异/ 类型/ 最终/ 发现错误/ 的/ 个数/ ,/ m/ 表示/ 选取/ 的/ 次数/ ./ 根据/ 式/ (/ 1/ )/ 得到/ 的/ 主观/ 等级/ 向量/ 犌/ =/ (/ G1/ ,/ G2/ ,/ …/ ,/ Gk/ )/ 和/ 式/ (/ 2/ )/ 得到/ 的/ 客观/ 变异/ 类型/ 发现/ 的/ 错误/ 数/ 向量/ 犆/ =/ (/ C1/ ,/ C2/ ,/ …/ ,/ Ck/ )/ ,/ 最终/ 得到/ 计算/ 变异/ 类型/ 的/ 权重/ 向量/ 犠/ =/ (/ W1/ ,/ W2/ ,/ …/ ,/ Wk/ )/ ./ 此处/ 0/ </ Wi/ / 1/ ./ 证明/ 如下/ :/ 式/ (/ a/ )/ +/ 式/ (/ b/ )/ ,/ 得到/ 同时/ 除以/ 2/ 得到/ 0/ </ 4/ 安全/ 规则/ 变异/ 测试/ 算法/ 通常/ WebServices/ 以/ SOAP/ 协议/ 格式/ 传送/ 或/ 接受/ 远程/ 服务/ 单元/ 的/ 数据/ ,/ 而/ 一个/ SOAP/ 消息/ 可以/ 抽象/ 表示/ 为/ 输入/ 参数/ 和/ 安全控制/ 规则/ 两/ 部分/ ./ 在/ 原有/ 的/ 变异/ 测试/ 研究/ 中/ ,/ 主要/ 考虑/ 的/ 是/ 针对/ 输入/ 参数/ 的/ 变异/ 处理/ ,/ 尚未/ 见到/ 对/ SOAP/ 消息/ 安全控制/ 规则/ 变异/ 的/ 研究/ ,/ 并且/ 有效/ 的/ WebServices/ 安全性/ 测试方法/ 和/ 技术/ 也/ 不多见/ ./ 本节/ 基于/ 变异/ 测试/ 框架/ 及/ 相应/ 的/ 安全/ 变异/ 规则/ 集/ ,/ 给出/ 一种/ 自动/ 生成/ 安全性/ 测试用例/ 的/ 算法/ TCSRM/ (/ TestCasesgenerationbasedonSecurityRulesMutation/ )/ ./ 4.1/ TCSRM/ 算法/ 框架/ TCSRM/ 算法/ 主要/ 分为/ 以下/ 两个/ 阶段/ ./ 阶段/ 1/ ./ 首先/ 动态/ 解析/ WSDL/ 文件/ 得到/ 普通/ SOAP/ 消息/ ,/ 并/ 将/ 待测/ WebServices/ 的/ 安全/ 类型/ 分解/ 为/ 一系列/ 原子/ 安全/ 类型/ ./ 然后/ 依据/ 实际/ 服务/ 要求/ 确定/ 调用/ 安全策略/ 处理/ 的/ 顺序/ ,/ 最终/ 生成/ 符合/ 待测/ WebServices/ 安全策略/ 需求/ 的/ 正确/ 的/ SOAP/ 请求/ 消息/ ,/ 并发/ 往/ 服务端/ ./ 此/ 阶段/ 对应/ 着/ ASTC/ (/ AdaptiveSecurityTestCases/ )/ 子/ 算法/ ./ 阶段/ 2/ ./ 首先/ 根据/ 变异/ 优先/ 准则/ 和/ 权重/ 大小/ 策略/ 确定/ 变异/ 类型/ 、/ 变异/ 顺序/ 及/ 生成/ 测试用例/ 的/ 数目/ ,/ 然后/ 将/ 安全/ 规则/ 变异/ 运用/ 到/ 第一阶段/ 生成/ 的/ 正确/ 的/ SOAP/ 请求/ 消息/ ,/ 最后/ 生成/ 变异/ 后/ 的/ 安全性/ 测试用例/ ./ 此/ 阶段/ 对应/ SRMTC/ (/ SecurityRulesMutationTestCases/ )/ 子/ 算法/ ./ 图/ 2/ 给出/ 了/ TCSRM/ 算法/ 的/ 步骤/ 图/ ./ 4.2/ TCSRM/ 生成/ 测试用例/ 算法/ TCSRM/ 主/ 算法/ 、/ ASTC/ 子/ 算法/ 和/ SRMTC/ 子/ 算法/ 的/ 具体/ 描述/ 分别/ 如/ 算法/ 1/ 、/ 算法/ 2/ 及/ 算法/ 3/ 所示/ ./ 约定/ 1/ ./ 记/ WebServices/ 安全策略/ 的/ 集合/ 为/ WSSeP/ ,/ 加密/ 策略/ 为/ EnP/ ,/ 签名/ 策略/ 为/ SiP/ ,/ 安全/ 令牌/ 策略/ 为/ StP/ ,/ 时间/ 戳/ 策略/ 为/ TsP/ ,/ 角色/ 策略/ 为/ RlP/ ,/ 属性/ 策略/ 为/ AtP/ ,/ 隐私/ 策略/ 为/ PrP/ ,/ 则/ WSSeP/ =/ {/ EnP/ ,/ SiP/ ,/ StP/ ,/ TsP/ ,/ RlP/ ,/ AtP/ ,/ PrP/ }/ ,/ 任/ 一种/ 安全策略/ 记为/ p/ ∈/ P/ ,/ 则/ 有/ / p/ ∈/ WSSep/ ./ 普通/ 原始/ 的/ SOAP/ 消息/ 记为/ OriginalMessage/ ,/ 生成/ 的/ 符合/ 待测/ WebServices/ 安全策略/ 需求/ 的/ 正确/ 的/ SOAP/ 请求/ 消息/ 记为/ TempMessage/ ./ Page8/ 图/ 2TCSRM/ 算法/ 步骤/ 图/ onSecurityRulesMutation/ )/ ./ 算法/ 1/ ./ TCSRM/ (/ TestCasesgenerationbased/ 输入/ :/ OriginalMessage/ 输出/ :/ SecuritytestcasessetS/ =/ {/ e1/ ,/ e2/ ,/ …/ ,/ en/ }/ 1/ ./ TempMessage/ =/ OriginalMessage/ ;/ 2/ ./ if/ (/ TempMessagedon/ ’/ tsatisfysecurityrequirement/ )/ 3/ ./ callASTCalgorithm/ ;/ 4/ ./ callSRMTCalgorithm/ ;/ 5/ ./ outputthetestcasessetS/ =/ {/ e1/ ,/ e2/ ,/ …/ ,/ en/ }/ ./ 算法/ 2/ ./ ASTC/ (/ AdaptiveSecurityTestCases/ )/ ./ 输入/ :/ OriginalMessage/ ,/ P/ =/ {/ p1/ ,/ p2/ ,/ …/ ,/ pj/ ,/ …/ ,/ pk/ }/ ,/ 输出/ :/ TempMessage1/ ./ foreachpifromp1topkdo2/ ./ {/ if/ (/ piisEnP/ )/ then3/ ./ {/ callEncryptalgorithm/ ;/ 4/ ./ TempMessage/ =/ TempMessage/ +/ encryptedmessage/ ;/ }/ 5/ ./ if/ (/ piisSiP/ )/ then6/ ./ {/ callSignalgorithm/ ;/ Page97/ ./ TempMessage/ =/ TempMessage/ +/ signmessage/ ;/ }/ 8/ ./ if/ (/ piisStP/ )/ then9/ ./ {/ callAddTokenalgorithm/ ;/ 10/ ./ TempMessage/ =/ TempMessage/ +/ addtokensmessage/ ;/ }/ 11/ ./ if/ (/ piisTsP/ )/ then12/ ./ {/ callAddTimestampalgorithm/ ;/ 13/ ./ TempMessage/ =/ 14/ ./ if/ (/ piisRlP/ )/ then15/ ./ {/ callAddRolealgorithm/ ;/ 16/ ./ TempMessage/ =/ TempMessage/ +/ addrolemessage/ ;/ }/ 17/ ./ if/ (/ piisAtP/ )/ then18/ ./ {/ callAddAttributealgorithm/ ;/ 19/ ./ TempMessage/ =/ 20/ ./ if/ (/ piisPrP/ )/ then21/ ./ {/ callAddPrivacyPolicyalgorithm/ ;/ 22/ ./ TempMessage/ =/ 23/ ./ }/ 24/ ./ returnTempMessage/ ./ ASTC/ 算法/ 中/ 涉及/ 7/ 个子/ 过程/ ,/ 其中/ Encrypt/ 为/ 消息/ 加密/ 过程/ ,/ Sign/ 为/ 消息/ 签名/ 过程/ ,/ AddToken/ 为/ 添加/ 安全/ 令牌/ 过程/ ,/ AddTimestamp/ 为/ 添加/ 时间/ 戳/ 过程/ ,/ AddRole/ 为/ 添加/ 角色/ 过程/ ,/ AddAttribute/ 为/ 添加/ 属性/ 过程/ ,/ AddPrivacyPolicy/ 为/ 添加/ 隐私/ 策略/ 过程/ ./ 这些/ 子/ 过程/ 中/ 的/ 参数/ 可以/ 为/ 整个/ 消息/ ,/ 也/ 可以/ 为/ 消息/ 中/ 的/ 某些/ 元素/ ./ 这些/ 过程/ 均/ 采用/ 符合/ WebServicesSecurity/ 语法/ 规范/ 的/ 常用/ 安全/ 操作/ 的/ 处理/ 方法/ ./ 其中/ ,/ 消息/ 加密/ 过程/ Encrypt/ 及/ 消息/ 签名/ 过程/ Sign/ 采用/ 的/ 是/ 经典/ 的/ 加密/ 和/ 签名/ 算法/ ,/ 目的/ 是/ 为了/ 保证/ 处理/ 后/ 的/ SOAP/ 消息/ 符合/ 常用/ 的/ 安全/ 规范/ ./ 其它/ 的/ 如/ AddToken/ 过程/ 、/ AddTimestamp/ 过程/ 、/ AddRole/ 过程/ 、/ AddAttribute/ 过程/ 及/ AddPrivacy/ -/ Policy/ 过程/ 均/ 参照/ WebServices/ 安全/ 规范/ 增加/ 相应/ 的/ 安全/ 属性/ ,/ 为/ 后面/ 的/ SOAP/ 消息/ 安全/ 规则/ 变异/ 做/ 准备/ ./ SRMTC/ 算法/ 对/ ASTC/ 算法/ 生成/ 的/ 符合/ 安全/ 规范/ 的/ SOAP/ 请求/ 消息/ 进行/ 安全/ 规则/ 变异/ ,/ 生成/ 变异/ 后/ 的/ 安全性/ 测试用例/ ./ 为了/ 方便/ 描述/ SRMTC/ 算法/ 给出/ 以下/ 约定/ 和/ 符号/ 说明/ ./ 约定/ 2/ ./ 记/ 安全/ 令牌/ 变异/ 操作/ 为/ StM/ ,/ 加密/ 变异/ 操作/ 为/ EeM/ ,/ 签名/ 变异/ 操作/ SiM/ ,/ 时间/ 戳/ 变异/ 操作/ 为/ TsM/ ,/ 角色/ 变异/ 操作/ 为/ RoM/ ,/ 属性/ 变异/ 操作/ 为/ AtM/ ,/ 隐私/ 策略/ 变异/ 操作/ 为/ PpM/ ,/ Security/ 报头/ 块/ 变异/ 操作/ 为/ SeM/ ,/ 变异/ 操作/ 类型/ WSMT/ =/ {/ StM/ ,/ EeM/ ,/ SiM/ ,/ TsM/ ,/ RoM/ ,/ AtM/ ,/ PpM/ ,/ SeM/ }/ ,/ 则/ 当前/ 待测/ WebServices/ 中/ 含有/ 的/ 变异/ 类型/ 集合/ 为/ M/ =/ {/ m1/ ,/ m2/ ,/ …/ ,/ mj/ ,/ …/ ,/ mk/ }/ ,/ 1/ / j/ / k/ / 8/ ,/ 则/ 有/ M/ / WSMT/ ./ 依据/ 3.2/ ./ 3/ 小节/ 描述/ 的/ 原则/ 确定/ 待测/ WebServices/ 中/ 变异/ 类型/ 的/ 优先级/ 序列/ 为/ pm/ =/ {/ pm1/ ,/ pm2/ ,/ …/ ,/ pmj/ ,/ …/ ,/ pmk/ }/ ,/ 1/ / j/ / k/ / 8/ ,/ 其中/ pmj/ 表示/ 变异/ 类型/ mj/ 对应/ 的/ 优先级/ ./ 则/ 有/ P/ / WSSep/ ,/ 变异/ 类型/ 的/ 权重/ 为/ wm/ [/ ]/ =/ {/ wm1/ ,/ wm2/ ,/ …/ ,/ wmj/ ,/ …/ ,/ wmk/ }/ ,/ 1/ / j/ / k/ / 8/ ,/ 其中/ wmj/ 表示/ 变异/ 类型/ mj/ 对应/ 的/ 权重/ ,/ 一种/ 变异/ 类型/ 对应/ 一个/ 优先级/ ,/ 也/ 对应/ 着/ 一个/ 权重/ 值/ ./ 算法/ 3/ 中/ StS/ =/ {/ CUT/ ,/ CKT/ ,/ CXT/ }/ ,/ EnS/ =/ {/ MEE/ ,/ MEEH/ ,/ CEA/ }/ ,/ SiS/ =/ {/ MSE/ ,/ MSH/ ,/ CSA/ }/ ,/ TsS/ =/ {/ CT/ }/ ,/ RoS/ =/ {/ CUR/ }/ ,/ AtS/ =/ {/ CUA/ }/ ,/ PpS/ =/ {/ CPP/ }/ ,/ SeS/ =/ {/ CHS/ }/ ./ 算法/ 3/ ./ SRMTC/ (/ SecurityRulesMutationTestCases/ )/ ./ 输入/ :/ TempMessage/ ,/ mi/ ,/ wm/ [/ ]/ ,/ 输出/ :/ TestcasessetS/ =/ {/ e1/ ,/ e2/ ,/ …/ ,/ en/ }/ 1/ ./ determinemutationpointsbelongtowhatkindof2/ ./ while/ (/ pm/ ≠/ / )/ do3/ ./ {/ mi/ =/ Max/ (/ pm/ )/ ;/ // // 返回/ pm/ 中/ 具有/ 最大/ 优先/ 4/ ./ if/ (/ miisStM/ )/ then5/ ./ {/ invokeStS/ ;/ // // 调用/ 安全/ 令牌/ 算/ 子集/ 6/ ./ togeneratetestcasesaccordingtowmi/ ;/ }/ 7/ ./ if/ (/ miisEeM/ )/ then8/ ./ {/ invokeEnS/ ;/ // // 调用/ 加密/ 算/ 子集/ 9/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 10/ ./ if/ (/ miisSiM/ )/ then11/ ./ {/ invokeSiS/ ;/ // // 调用/ 签名/ 算/ 子集/ 12/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 13/ ./ if/ (/ miisTsM/ )/ then14/ ./ {/ invokeTsS/ ;/ // // 调用/ 时间/ 戳/ 算/ 子集/ 15/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 16/ ./ if/ (/ miisRoM/ )/ then17/ ./ {/ invokeRoS/ ;/ // // 调用/ 角色/ 处理/ 算/ 子集/ 18/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 19/ ./ if/ (/ miisAtM/ )/ then20/ ./ {/ invokeAtS/ ;/ // // 调用/ 属性/ 处理/ 算/ 子集/ 21/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 22/ ./ if/ (/ miisPpM/ )/ then23/ ./ {/ invokePpS/ ;/ // // 调用/ 隐私/ 策略/ 处理/ 算/ 子集/ Page1024/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 25/ ./ if/ (/ miisSeM/ )/ then26/ ./ {/ invokeSeS/ ;/ // // 调用/ security/ 报头/ 块/ 算/ 子集/ 27/ ./ togeneratetestcasesaccordingtothewmi/ ;/ }/ 28/ ./ DeleteMax/ (/ pm/ )/ ;/ // // 从/ 队列/ 中/ 删除/ 具有/ 最大/ 优/ 29/ ./ }/ 30/ ./ returnthesetoftestcasesS/ =/ {/ e1/ ,/ e2/ ,/ …/ ,/ en/ }/ ./ 框架/ 的/ 分析/ 执行器/ 执行/ 算法/ 生成/ 安全/ 测试用例/ ,/ 并/ 根据/ 漏洞/ 判定/ 准则/ 分析/ 检测/ WebServices/ 安全漏洞/ ./ 为/ 方便/ 在/ 理论/ 上/ 分析/ 算法/ TCSRM/ 的/ 复杂性/ ,/ 假定/ 待测/ WebServices/ 中/ 含有/ 安全策略/ 的/ 种类/ 数为/ s/ ,/ 方法/ 有/ m/ 个/ ,/ 每个/ 方法/ 平均/ 有/ p/ 个/ 参数/ ,/ 消息/ 的/ 长度/ 为/ n/ ,/ 变异/ 点/ 的/ 个数/ 为/ q/ ,/ 每次/ 生成/ 的/ 测试用例/ 的/ 个数/ 为/ t/ ./ TCSRM/ 算法/ 的/ 复杂性/ 主要/ 由/ 两个/ 算法/ 决定/ :/ (/ 1/ )/ ASTC/ 子/ 算法/ ./ 时间/ 主要/ 消耗/ 在/ 加密/ 和/ 签名/ 算法/ 上/ ./ 而/ 在/ 执行/ 效率/ 方面/ ,/ 典型/ 的/ 对称/ 加密算法/ DES/ 的/ 时间/ 复杂性/ 为/ O/ (/ n/ )/ ,/ 签名/ 算法/ MD5/ 的/ 时间/ 复杂性/ 为/ O/ (/ n/ )/ ,/ 所以/ 时间/ 复杂性/ 为/ O/ (/ 2/ ×/ m/ ×/ p/ ×/ s/ ×/ n/ )/ =/ O/ (/ m/ ×/ p/ ×/ s/ ×/ n/ )/ ;/ (/ 2/ )/ SRMTC/ 子/ 算法/ ./ 其/ 时间/ 复杂性/ 为/ O/ (/ q/ ×/ t/ )/ ./ 故/ 基于/ 以上/ 分析/ 可/ 得出/ TCSRM/ 算法/ 的/ 时间/ 复杂性/ 为/ O/ (/ m/ ×/ p/ ×/ s/ ×/ n/ )/ +/ O/ (/ q/ ×/ t/ )/ ./ 5/ 实验/ 分析/ 5.1/ 实验/ 环境/ 为了/ 验证/ 本文/ 提出/ 的/ 安全/ 规则/ 变异/ 测试方法/ 的/ 可行性/ 以及/ TCSRM/ 算法/ 的/ 有效性/ ,/ 设计/ 并/ 实现/ 了/ 一个/ 基于/ SOAP/ 消息/ 安全/ 规则/ 变异/ 的/ WebServices/ 安全性/ 测试工具/ WSSTT/ (/ WebServicesSecurityTestingTool/ )/ ./ 实验/ 环境/ 是/ :/ 内存/ 4GB/ 、/ CPUIntel/ ?/ Core/ (/ TM/ )/ i3/ -/ 2120/ @/ 3.30/ GHz/ 、/ 硬盘/ 500GB/ 的/ 兼容机/ 、/ Windows7/ 操作系统/ ,/ 开发工具/ 及/ 技术/ 采用/ MicrosoftVisualStudio2008/ 、/ ./ NETFramework/ 及/ WCF/ (/ WindowsCommunicationFoundation/ )/ ./ WSSTT/ 整体/ 的/ 工作/ 流程/ 如下/ :/ (/ 1/ )/ 扫描/ 服务/ 描述/ WSDL/ 文件/ ,/ 并/ 动态/ 解析/ WSDL/ 文件/ 生成/ 普通/ SOAP/ 消息/ ;/ (/ 2/ )/ 根据/ 安全/ 规格/ 说明书/ ,/ 配置/ 密钥/ 与/ 加密算法/ ,/ 对/ SOAP/ 消息/ 进行/ 安全/ 令牌/ 处理/ 、/ 加密/ 处理/ 、/ 签名/ 处理/ 等/ 操作/ ,/ 生成/ 符合/ 待测/ WebServices/ 安全/ 需求/ 的/ 加密/ SOAP/ 消息/ 、/ 签名/ SOAP/ 消息/ 、/ SAML/ (/ SecurityAssertionMarkupLanguage/ )/ 断言/ 消息/ 、/ 包含/ 安全/ 令牌/ 的/ SOAP/ 消息/ 或/ 具有/ 多种/ 安全/ 需求/ 的/ 组合/ 消息/ ;/ (/ 3/ )/ 对/ 已/ 生成/ 的/ 符合/ 待测/ WebServices/ 安全/ 需求/ 的/ 正确/ 的/ SOAP/ 请求/ 消息/ ,/ 通过/ 安全/ 规则/ 变异/ ,/ 调用/ 相应/ 的/ 测试用例/ 生成/ 算法/ 产生/ 测试用例/ ;/ (/ 4/ )/ 将/ 这些/ 消息/ 发送到/ 待测/ WebServices/ ,/ 观察/ 其/ 响应/ 结果/ ;/ (/ 5/ )/ 根据/ 漏洞/ 判定/ 准则/ 对/ WebServices/ 进行/ 安全性/ 分析/ 与/ 评价/ ,/ 最后/ 给出/ 测试报告/ ./ 整个/ 测试/ 流程/ 如图/ 3/ 所示/ ./ 5.2/ 实验/ 评价/ 方法/ 对于/ 变异/ 测试/ 充分性/ 的/ 评价/ ,/ 因/ 变异/ 测试/ 也/ 属于/ 错误/ 注入/ 测试/ 的/ 一种/ ,/ 故/ 借鉴/ 一般/ 的/ 错误/ 注入/ 方法/ 进行/ 评价/ ./ 一般/ 的/ 错误/ 注入/ 测试/ 评价/ 是/ 通过/ 注入/ 错误/ 总数/ 和/ 覆盖/ 的/ 错误/ 注入/ 点/ 数量/ 来/ 衡量/ ./ 本文/ 在/ 此基础/ 上/ 分别/ 定义/ 有效率/ 、/ 注入/ 率/ 和/ 单元/ 开销/ 3/ 个/ 指标/ 来/ 进行/ 综合/ 评价/ ./ 定义/ 16/ ./ 设/ 注入/ 错误/ 的/ 总数/ 为/ m/ ,/ 注入/ 后/ WebServices/ 产生/ 安全/ 问题/ 的/ 错误/ 数为/ n/ ,/ n/ // m/ 称为/ 有效率/ ,/ 记/ 作/ θ/ =/ n/ // m/ ./ 定义/ 17/ ./ 设/ 被/ 测试/ WebServices/ 中/ 错误/ 注入/ 点/ 的/ 总数/ 为/ m/ ,/ 已经/ 注入/ 错误/ 的/ 注入/ 点/ 的/ 数量/ 为/ n/ ,/ n/ // m/ 称为/ 注入/ 率/ ,/ 记/ 作/ η/ =/ n/ // m/ ./ 定义/ 18/ ./ 设由/ 定义/ 16/ 得到/ 的/ 有效率/ 为/ θ/ ,/ 所/ 花费/ 的/ 时间/ 为/ t/ ,/ 则/ θ/ t/ 称为/ 单元/ 开销/ ,/ 记作/ c/ =/ θ/ t/ ./ 那么/ 当/ 有效率/ 的/ 数值/ 越大时/ ,/ 可以/ 认为/ 变异/ 算子/ 越/ 有效/ ,/ WebServices/ 越/ 不/ 安全/ ;/ 当/ 注入/ 率越/ 大时/ ,/ 测试/ 结果/ 越/ 可靠/ ./ 综合/ 这/ 两个/ 指标/ ,/ 在/ 注入/ 率/ 满足/ 对/ 测试/ 可靠性/ 要求/ 的/ 前提/ 下/ ,/ 在/ 制定/ 测试计划/ 时/ 根据/ 实际/ 情况/ 可以/ 设定/ 当/ 注入/ 率/ 达到/ 一定/ 值时/ ,/ 停止/ 测试/ ./ 此时/ 可以/ 计算/ 变异/ 算子/ 的/ 有效率/ ,/ 评价/ 该/ WebServices/ 的/ 安全性/ ./ 最后/ 通过/ 计算/ c/ 来/ 描述/ 有/ Page11/ 效率/ 达到/ 一定/ 值时/ 所/ 需要/ 的/ 测试/ 时间/ 开销/ ,/ 评价/ 算法/ 的/ 性能/ ./ 5.3/ 实验/ 结果/ 分析/ 由于/ 目前/ 支持/ WS/ -/ Security/ 规范/ 的/ 公共/ 可/ 访问/ WebServices/ 比较/ 少/ ,/ 因此/ 我们/ 设计/ 开发/ (/ 含/ 二次开发/ )/ 了/ 20/ 个/ 支持/ WS/ -/ Security/ 规范/ 的/ WebServices/ 用于/ 实验/ 分析/ ./ 20/ 个/ 待/ 测试/ WebServices/ 的/ 信息/ 如表/ 4/ 所示/ ./ 表/ 4/ 待/ 测试/ 的/ WebServices/ 信息/ 编号/ WS1WS2WeatherforecastWS3WS4BookfindingWS5DomainfindingWS6PetinformationWS7WS8WS9QQcheckonlineWS10QueryresultsWS11ProducedorderWS12WS13MaxdivisorWS14WS15ReversestringWS16StringcopyWS17StringlengthWS18WS19WS20Echoinformation/ 为了/ 便于/ 实验/ 分析/ 统计/ ,/ 在/ 实验/ 过程/ 中/ 进行/ 如下/ 处理/ :/ (/ 1/ )/ 对于/ 同一个/ WebServices/ 使用/ 不同/ 的/ 变异/ 算子/ 可能/ 会/ 发现/ 同一个/ 漏洞/ ,/ 在/ 此/ 只/ 计算/ 一次/ ;/ (/ 2/ )/ 对于/ 同一个/ 变异/ 算子/ 产生/ 的/ 不同/ 的/ 测试用例/ 也/ 可能/ 发现/ 同一/ 漏洞/ ,/ 在/ 此/ 也/ 只/ 计算/ 一次/ ./ 表/ 5/ 给出/ 所表/ 5/ 所有/ 服务/ 变异/ 算子/ 产生/ 测试用例/ 的/ 个数/ 测试/ 用数/ 个数/ WSWS13005320002222223WS20030007322200019WS30081615471166325487WS40400005322200018WS55008620003225437WS60304420002200017WS70063430002300021WS80308846644300046WS94003335434336445WS106001310314725334575WS110407748656550057WS12600171570006533264WS133008740004423338WS140507730004420032WS150035420002200018WS164000006522232127WS170305520003200020WS186004430002256436WS190045534433300034WS200309940004300032/ 合计/ 372524127116556249296857323629746/ 有/ 被/ 测/ WebServices/ 通过/ 每/ 一种/ 变异/ 算子/ 产生/ 的/ 测试用例/ 的/ 数量/ ,/ 表/ 6/ 给出/ 测试/ 后/ 每种/ 变异/ 算子/ 发现/ 漏洞/ 的/ 数量/ 及/ WebServices/ 实验/ 平均/ 注入/ 的/ 安全/ 缺陷/ 总数/ ./ Page12/ 表/ 6Web/ 服务/ 变异/ 算子/ 发现/ 漏洞/ 数/ 漏洞/ 数/ CUTCKTCXTMEEMEEHCEAMSEMSHCSACHSCTCURCUACPP/ 合计/ WSWS110010000010011512WS200100020010000412WS3002331220211222160WS40000001101100049WS5200430000100121329WS60101100000000038WS700201000001000412WS801010010010000415WS900001011000111616WS10200321200101111431WS11000110211211001022WS12100321000220111345WS130000100001000026WS1401012000011000621WS150000100001000025WS1640000011000111930WS1701011100000000413WS1820011000010022941WS1900111011100000619WS2001022000021000825/ 合计/ 125623234137218851011147431/ 为了/ 计算/ 变异/ 算子/ 的/ 有效性/ 问题/ ,/ 定义/ 了/ 公式/ OE/ =/ EF/ // TC/ ,/ 其中/ EF/ 表示/ 发现/ 的/ 漏洞/ 数/ ;/ TC/ 表示/ 变异/ 算子/ 产生/ 的/ 测试用例/ 的/ 总数/ ./ 图/ 4/ 给出/ 了/ 各/ 变异/ 算子/ 的/ 有效性/ ./ 图/ 5/ 给出/ 了/ 20/ 个/ 被/ 测试/ WebServices/ 测试/ 效果/ ./ 图/ 4/ 可以/ 看出/ 大部分/ 变异/ 算子/ 可以/ 较/ 好/ 地/ 发现/ WebServices/ 存在/ 的/ 安全漏洞/ ,/ CPP/ 算子/ 效果/ 最好/ 为/ 0.379/ ,/ 但/ 某些/ 变异/ 算子/ 如/ CSA/ 仅为/ 0.069/ ,/ 说明/ 其仅/ 针对/ 某种/ 特定/ 服务类型/ 才/ 会/ 有/ 更好/ 的/ 效用/ ./ 图/ 5/ 中/ OEw/ 为/ EFw/ // TCw/ ,/ 表示/ 每个/ Web/ 服务/ 测试/ 的/ 有效率/ ,/ 其中/ EFw/ 表示/ 每个/ Web/ 服务/ 被/ 发现/ 的/ 漏洞/ 数/ ,/ TCw/ 表示/ 每个/ Web/ 服务/ 被/ 注入/ 的/ 安全/ 缺陷/ 总数/ ./ 其中/ WS11/ 的/ OEw/ 为/ 0.455/ ,/ 测试/ 效果/ 最好/ ,/ 所有/ 被/ 测试/ WebServices/ 的/ 平均/ 测试/ 效果/ 为/ 0.341/ ./ 5.4/ 对比/ 分析/ 目前/ 国内外/ 有效/ 可行/ 的/ WebServices/ 安全性/ 测试/ 技术/ 研究/ 甚/ 少/ ,/ 对于/ WebServices/ 安全性/ 全面/ 系统性/ 的/ 测试方法/ 研究/ 并/ 不多见/ ./ 本文/ 主要/ 对/ Web/ 服务/ 脆弱性/ 测试工具/ WSVTT/ 工具/ [/ 18/ ]/ 、/ 基于/ SOAP/ 消息/ 的/ Web/ 服务/ 测试工具/ SOAPUI/ ①/ 和/ 本文/ 设计/ 的/ WSSTT/ 工具/ 分别/ 从/ 测试工具/ 的/ 测试/ 效率/ (/ 有效率/ )/ θ/ 及/ 测试工具/ 的/ 性能/ 几个/ 方面/ 进行/ 对比/ 分析/ ./ 其中/ ,/ WSVTT/ 是/ 一种/ 基于/ SOAP/ 消息/ 数据/ 变异/ 的/ Web/ 服务/ 脆弱性/ 测试工具/ ./ SOAPUI/ 是/ 一种/ 公开/ 访问/ 的/ Web/ 服务/ 功能性/ 测试工具/ ,/ 通过/ 修改/ WebServicesSOAP/ 消息/ 参数/ 来/ 测试/ WebServices/ 实现/ 的/ 功能/ 是否/ 正确/ ./ 实验/ 对比/ 1/ ./ SOAPUI/ 、/ WSVTT/ 和/ WSSTT3/ 种/ 工具/ 的/ 测试/ 效率/ θ/ 对比/ ./ 为了/ 全面/ 分析/ 3/ 种/ 工具/ 的/ 错误/ 检测/ 能力/ ,/ 被/ 测试/ Web/ 服务/ 事先/ 随机/ 植入/ 了/ 一些/ 功能性/ 错误/ 及/ 安全性/ 缺陷/ ./ 测试/ 过程/ 中/ ,/ 在/ 注入/ 率/ 满足/ 对/ 测试/ 可靠性/ 要求/ 的/ 前提/ 下/ ,/ 我们/ 设定/ 当/ 注入/ 率/ 达到/ 95/ %/ 时/ 停止/ 测试/ ./ 3/ 种/ 工具/ 的/ 测试/ 效率/ 对/ 比如/ 图/ 6/ 所示/ ./ ①/ SOAPUI/ ,/ SmartBearSoftware/ ,/ availableathttp/ :/ // // www/ ./ Page13/ 图/ 6SOAPUI/ 、/ WSVTT/ 和/ WSSTT3/ 种/ 工具/ 的/ 测试/ 效率/ 对比/ 从图/ 6/ 可以/ 看出/ 这/ 3/ 种/ 工具/ 的/ 测试/ 效率/ 均/ 随着/ 测试用例/ 数目/ 的/ 增加/ 而/ 增加/ ,/ 而/ WSVTT/ 优于/ SOAPUI/ 工具/ ,/ WSSTT/ 优于/ WSVTT/ ,/ 能/ 发现/ 较/ 多/ 的/ 功能性/ 错误/ 及/ 安全/ 缺陷/ ./ 由于/ 目前/ 支持/ WS/ -/ Security/ 规范/ 的/ 公共/ 可/ 访问/ WebServices/ 比较/ 少/ ,/ 论文/ 中待/ 测试/ WebServices/ 都/ 是/ 我们/ 自己/ 设计/ 开发/ 的/ ,/ 故/ 实验/ 数据/ 很大/ 一部分/ 取决于/ WebServices/ 的/ 选取/ 及/ 植入/ 的/ 错误/ ./ 由于/ WebServices/ 不同/ ,/ 变异/ 算子/ 不同/ ,/ 所以/ 发现/ 的/ 缺陷/ 数/ 也/ 不同/ ,/ 但/ 从/ 图/ 6/ 可以/ 看出/ 本文/ 提出/ 的/ 变异/ 算子/ 和/ 安全/ 规则/ 变异/ 方法/ 比/ WSVTT/ 工具/ 和/ SOAPUI/ 工具/ 在/ 检测/ WebServices/ 特定/ 安全/ 问题/ 时/ 更/ 有/ 成效/ ./ 实验/ 对比/ 2/ ./ SOAPUI/ 和/ WSSTT/ 时间/ 性能/ 对比/ ./ 由于/ WebServices/ 安全性/ 测试/ 的/ 大部分/ 时间/ 消耗/ 在/ 生成/ 加密/ 与/ 签名/ 的/ 测试用例/ 方面/ ./ 因此/ 在/ 实验/ 中/ ,/ 我们/ 针对/ 典型/ 操作/ 如/ 签名/ 、/ 加密/ 、/ 签名/ 和/ 加密/ 组合/ 等/ 不同/ 的/ 安全/ 部署/ 进行/ 了/ 实验/ ./ 实验/ 中/ 由于/ WSVTT/ 处理/ 签名/ 、/ 加密/ 及其/ 组合/ 运算/ 的/ SOAP/ 消息/ 时/ 耗时/ 较大/ ,/ 且/ 时间/ 消耗/ 不/ 稳定/ ,/ 故/ 没有/ 和/ WSVTT/ 进行/ 时间/ 性能/ 对比/ 分析/ ,/ 只/ 给出/ 了/ SOAPUI/ 和/ WSSTT/ 的/ 时间/ 性能/ 对比/ 分析/ 结果/ ./ 定义/ 19/ ./ 设待测/ WebServices/ 在/ 使用/ 特定/ 的/ 安全/ 部署/ 之后/ 生成/ 测试用例/ 的/ 时间/ 为/ LWSSDeployment/ ,/ 例如/ LWSSSignature/ 表示/ 在/ 执行/ 签名/ 操作/ 时/ 生成/ 测试用例/ 的/ 时间/ ;/ 不/ 执行/ 任何/ 安全/ 部署/ 时/ 的/ 生成/ 测试用例/ 的/ 时间/ 为/ LNoWSS/ ,/ 则/ 生成/ 测试用例/ 时间/ 增长率/ 为/ LIP/ =/ (/ LWSSDeployment/ -/ LNoWSS/ )/ // LNoWSS/ ×/ 100/ %/ ./ 本文/ 以/ 学生/ 成绩/ 查询/ 服务/ Queryresults/ 为例/ 比较/ WSSTT/ 工具/ 与/ SOAPUI/ 工具/ 在/ 时间/ 性能/ 方面/ 的/ 差异/ ./ 该/ 服务/ 要求/ 采用/ 用户名/ 令牌/ 认证/ 并/ 签名/ 加密/ 消息/ ,/ 并且/ 能够/ 提供/ SOAP/ 消息/ 请求/ 和/ 响应/ ,/ 并/ 支持/ WS/ -/ Security/ 规范/ 中/ 的/ SOAP/ 消息/ 签名/ 和/ 加密/ 处理/ ./ 基本/ 的/ 服务/ 流程/ 是/ :/ 由/ 客户端/ 向/ 服务器发送/ 查询/ 学生/ 成绩/ 的/ SOAP/ 请求/ ,/ 服务器/ 将/ 经过/ 加密/ 或/ 签名/ 后/ 的/ 消息/ 返回/ 给/ 客户端/ ./ 图/ 7/ 至图/ 9/ 分别/ 为/ 两种/ 工具/ 实施/ 加密/ 、/ 签名/ 、/ 加密/ 和/ 签名/ 组合/ 安全/ 操作/ 后/ 的/ LIP/ 对比/ 图/ ./ 图/ 8/ 签名/ 时/ 的/ 测试用例/ 生成/ 时间/ 增长率/ 对比/ 图图/ 9/ 加密/ 和/ 签名/ 时/ 的/ 测试用例/ 生成/ 时间/ 增长率/ 对比/ 图/ 根据/ 图/ 7/ 至图/ 9/ 所示/ 的/ 对比曲线/ 可以/ 看出/ :/ (/ 1/ )/ 实施/ 安全/ 操作/ 后/ ,/ 生成/ 测试用例/ 的/ 时间/ 都/ 显著/ 增长/ ,/ 而且/ 在/ 签名/ 验证/ 上/ 花费/ 的/ 时间/ 要/ 比/ 在/ 加密/ 解密/ 上/ 多/ ./ 这/ 是因为/ 在/ 执行/ 加密/ 操作/ 时/ ,/ 仅/ 加密/ SOAP/ 消息/ 的/ body/ 内/ 信息/ ,/ 而/ 签名/ 除/ 对/ body/ 内/ 信息/ 进行/ 操作/ 外/ ,/ 还/ 需要/ 对/ header/ 内部/ 的/ 时间/ 戳/ 以及/ 路由/ 等/ 信息/ 进行/ 签名/ ;/ (/ 2/ )/ 当/ 测试用例/ 个数/ 增加/ 时/ ,/ WSSTT/ 工具/ 和/ SOAPUI/ 工具/ 生成/ 测试用例/ 的/ 时间/ 都/ 随着/ 增加/ ,/ 但是/ WSSTT/ 工具/ 没有/ SOAPUI/ 工具/ 增长/ 的/ 幅度/ 大/ ,/ 从而/ 说明/ WSSTT/ 工具/ 有/ 较/ 好/ 的/ 性能/ ./ 需要/ 说明/ 的/ 是/ ,/ 实验/ 中图/ 7/ 、/ 图/ 8/ 、/ 图/ 9/ 反映/ 出/ WSSTT/ 工具/ 和/ SOAPUI/ 工具/ 中/ 的/ LIP/ 变化趋势/ 比较/ 相似/ ./ 为了/ 进一步/ 分析/ LIP/ 受/ 不同/ 被测/ Web/ 服务/ 的/ 影响/ ,/ 我们/ 测试/ 了/ 一些/ 典型/ 的/ 符合/ 安全/ 规范/ Page14/ (/ 具有/ 签名/ 、/ 加密/ 及其/ 组合/ 操作/ )/ 的/ Web/ 服务/ ,/ 实验/ 结果表明/ WSSTT/ 工具/ 和/ SOAPUI/ 工具/ 中/ 的/ LIP/ 变化趋势/ 均/ 较/ 相似/ ,/ 表明/ 针对/ 不同/ 的/ 被/ 测试/ Web/ 服务/ LIP/ 无/ 显著性/ 差异/ ./ 6/ 总结/ 通过/ 对/ WebServices/ 运行/ 特点/ 和/ 各类/ SOAP/ 消息/ 安全/ 类型/ 漏洞/ 的/ 分析/ ,/ 提出/ 了/ 一种/ 安全/ 规则/ 变异/ 的/ 测试/ 框架/ ,/ 归纳/ 出/ 安全/ 规则/ 变异/ 点/ 判定/ 规则/ 库/ ,/ 并/ 设计/ 了/ 相应/ 的/ 安全/ 规则/ 变异/ 算子/ 和/ 漏洞/ 判定/ 准则/ ./ 通过/ 安全性/ 测试用例/ 生成/ 算法/ TCSRM/ 生成/ 变异/ 测试用例/ 对/ WebServices/ 进行/ 安全性/ 测试/ ,/ 实验/ 结果表明/ 提出/ 的/ 方法/ 对/ WebServices/ 一般/ 的/ 安全类/ 缺陷/ 具有/ 一定/ 的/ 检测/ 效果/ ./ WebServices/ 安全性/ 测试/ 是/ 一个/ 复杂/ 而/ 重要/ 的/ 研究课题/ ,/ 有待/ 今后/ 进一步/ 的/ 研究/ 完善/ ./ 未来/ 我们/ 主要/ 的/ 研究/ 工作/ 有/ :/ (/ 1/ )/ 安全/ 规则/ 变异/ 算子/ 的/ 完备/ 性/ 还/ 有待于/ 进一步/ 的/ 扩充/ 和/ 论证/ ;/ (/ 2/ )/ 进一步/ 对/ 访问/ 权限/ 、/ 地址/ 绑定/ 及/ 编码方式/ 等/ 几个/ 安全/ 属性/ 进行/ 归类/ 与/ 研究/ ,/ 并/ 设计/ 出/ 相对/ 应/ 的/ 安全/ 规则/ 变异/ 操作/ 算子/ ;/ (/ 3/ )/ 加大/ 实验/ 力度/ ,/ 设计/ 并/ 收集/ 更/ 多/ 的/ WebServices/ ,/ 特别/ 是/ 收集/ 一些/ 第三方/ 的/ 满足/ WS/ -/ Security/ 规范/ 的/ 公共/ 可/ 访问/ Web/ 服务/ ./ 此外/ ,/ 随着/ WebServices/ 迅速/ 的/ 发展/ ,/ 一些/ 新/ 的/ 安全/ 技术规范/ 势必会/ 陆续/ 的/ 发布/ 并/ 应用/ ,/ 我们/ 将/ 继续/ 对/ 新/ 技术/ 保持/ 关注/ ,/ 并/ 运用/ 新/ 的/ 技术/ 及时/ 对/ 提出/ 的/ 方法/ 进行/ 优化/ 和/ 完善/ ./ 致谢/ 感谢/ 课题组/ 的/ 王/ 环环/ 、/ 苏晨/ 飞及/ 赵小磊/ 等/ 同学/ 在/ 实验/ 系统/ 实现/ 和/ Web/ 服务/ 测试/ 上/ 所/ 做/ 的/ 工作/ ./ 感谢/ 江苏/ 大学/ 周从华/ 等/ 老师/ 们/ 的/ 有/ 价值/ 的/ 建议/ 和/ 讨论/ ./ 同时/ 也/ 要/ 感谢/ 审稿/ 专家/ 们/ 所/ 提出/ 的/ 宝贵意见/ ,/ 促使/ 论文/ 质量/ 得到/ 进一步/ 提升/ !/ 

