Page1/ 提升/ 小/ 波/ 变换/ 的/ 数据/ 并行计算/ 方法/ 研究/ 钟升/ 1/ )/ ,/ 2/ )/ 沈绪/ 榜/ 1/ )/ 郑/ 江滨/ 2/ )/ 王艳玲/ 1/ )/ 1/ )/ (/ 西安/ 微电子/ 技术/ 研究所/ 西安/ 710065/ )/ 2/ )/ (/ 西北工业大学/ 计算机/ 学院/ 西安/ 710072/ )/ 摘要/ 研究/ 了/ 基于/ SIMDPE/ 阵列/ 对/ G/ 级/ 像素/ 帧/ 进行/ 9/ // 7/ 提升/ 小/ 波/ 变换/ 的/ 数据/ 并行计算/ 实现/ 方法/ ./ 首先/ ,/ 在/ 分析/ 9/ // 7/ 提升/ 小/ 波/ 变换/ 运算/ 公式/ 的/ 局部/ 计算/ 特点/ 的/ 基础/ 上/ ,/ 提出/ 了/ PE/ 状态/ 标识/ 法/ 和/ 基于/ PE/ 标识/ 的/ 条件/ 计算方法/ ;/ 其次/ ,/ 提出/ 了/ SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 方法/ ./ 研究/ 表明/ ,/ 该/ 方法/ 提高/ 了/ 计算/ 的/ 并行度/ 和/ 规则性/ ,/ 并行度/ 仅/ 受限于/ 阵列/ 的/ 规模/ 且/ 具备/ 可/ 裁减/ 性/ 和/ 通用性/ ,/ 很/ 适合/ 于/ MPP/ 系统/ 芯片/ 实现/ ./ 关键词/ 数据/ 并行/ ;/ 提升/ 小/ 波/ 变换/ ;/ SIMDPE/ 阵列/ 1/ 引言/ 1998/ 年/ ,/ Daubechies/ 和/ Sweldens/ 提出/ 了/ 一种/ 新/ 的/ 基于/ 提升/ 算法/ 的/ 小波/ 变换/ ,/ 又/ 叫做/ 快速/ 提升/ 小/ 波/ 变换/ (/ FastLiftingWaveletTransform/ ,/ FLWT/ )/ [/ 1/ -/ 2/ ]/ ./ 目前/ ,/ 该/ 算法/ 已/ 用于/ JPEG2000/ 标准/ 中/ [/ 3/ ]/ ./ 针对/ 图像/ 预处理/ 的/ 实时性/ 需求/ ,/ 小/ 波/ 变换/ 的/ 数据/ 并行/ 实现/ 方/ Page29/ // 7/ 提升/ 小/ 波/ 变换/ 在/ PE/ 阵列/ 上/ 的/ 实现/ 方法/ ,/ 该/ 方法/ 具备/ 一定/ 的/ 通用性/ ,/ 可/ 有效/ 地/ 应用/ 于/ 其它/ 变换处理/ ,/ 如/ DCT/ 变换/ 等/ ,/ 具体/ 参考文献/ [/ 7/ ]/ ./ 提升/ (/ Lifting/ )/ 小/ 波/ 变换/ 是/ 在/ 空域/ 中/ 构建/ 的/ ./ 给定/ 一个/ 信号/ x/ =/ (/ xi/ )/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ )/ ,/ 假设/ N/ 是/ 2/ 的/ 幂/ 次方/ ./ 首先/ 将/ 其/ 分裂/ 成/ 两个/ 不/ 相交/ 的/ 集合/ :/ 偶/ 信号/ 集合/ xe/ =/ (/ x2n/ )/ 与/ 奇/ 信号/ 集合/ xo/ =/ (/ x2n/ -/ 1/ )/ ,/ 1/ / n/ / N/ // 2/ ./ 给定/ 一个/ 预测器/ P/ (/ Predictor/ )/ ,/ 并/ 求解/ 一个/ 细节/ 值/ (/ detail/ )/ ,/ 最/ 简单/ 的/ 预测器/ P/ 就是/ 其/ 两个/ 相邻/ 奇/ 信号/ 值/ 的/ 平均/ ,/ 其/ 细节/ 值/ 就是/ :/ d2n/ =/ x2n/ -/ (/ x2n/ +/ 1/ +/ x2n/ -/ 1/ )/ // 2/ ,/ 1/ / n/ / N/ // 2/ ,/ s2n/ -/ 1/ =/ x2n/ -/ 1/ +/ U/ (/ d2n/ )/ ,/ 1/ / n/ / N/ // 2/ ,/ 计算/ 与/ 记录/ 一个/ 细节/ 值/ 的/ 操作/ 叫做/ 一个/ 提升/ 步/ (/ Liftingstep/ )/ ./ 使用/ 更新/ 器/ U/ (/ Updateoperator/ )/ 对/ 细节/ 值/ 进行/ 操作/ ,/ 并/ 通过/ x2n/ -/ 1/ +/ U/ (/ d2n/ )/ 来/ 获得/ 平滑/ 值/ s/ (/ smoothedvalue/ )/ ,/ 而后/ 用/ 该值/ 去/ 取代/ x2n/ -/ 1/ ./ 不管/ 预测/ P/ 与/ 更新/ U/ 是/ 如何/ 选择/ 的/ ,/ 此/ 方案/ 总是/ 可逆/ 的/ ./ 从/ 应用/ 上/ 说/ ,/ 9/ // 7/ 提升/ 小/ 波/ 变换/ 有/ 分解/ 变换/ 与/ 重构/ 变换/ ./ 我们/ 假定/ 被/ 处理/ 的/ 对象/ 是/ 大小/ 为/ N/ ×/ N/ 的/ 图像/ Pixel/ [/ i/ ]/ [/ j/ ]/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ )/ ./ 小波/ 变换/ 可以/ 是/ 多层/ 的/ ,/ 先是/ 分解/ 变换/ ,/ 然后/ 依/ 应用/ 需求/ 进行/ 滤波/ ,/ 最后/ 是/ 重构/ 变换/ ./ 为了/ 使/ 讨论/ 具体/ 起/ 见/ ,/ 这里/ 只/ 讨论/ 3/ 层/ 的/ 情况/ ,/ 分解/ 变换/ 产生/ 的/ 结果/ 顺表/ 19/ // 7/ 提升/ 小/ 波/ 变换/ 分解/ 计算公式/ 第/ 1/ 步/ ./ 分裂/ (/ split/ )/ 第/ 2/ 步/ ./ 预测/ 1/ (/ predict1/ )/ 第/ 3/ 步/ ./ 更新/ 1/ (/ update1/ )/ 第/ 4/ 步/ ./ 预测/ 2/ (/ predict2/ )/ 第/ 5/ 步/ ./ 更新/ 2/ (/ update2/ )/ 第/ 6/ 步/ ./ 尺度/ 变换/ (/ scalingtransform/ )/ 由于/ 真实/ 图像/ 是/ 具有/ 边界/ 的/ ,/ 边界/ 处理/ 将会/ 影响/ 重构/ 图像/ 的/ 质量/ ,/ 小/ 波/ 变换/ 时/ 必须/ 考虑/ 边界/ 效应/ ./ 边界/ 的/ 处理/ 仅/ 需/ 对表/ 1/ 中/ 的/ 计算公式/ 稍作/ 修改/ 即可/ ,/ 读者/ 可/ 自行/ 推导/ ./ t/ =/ -/ (/ Wk/ -/ 1/ )/ // 2/ ∑/ (/ Wk/ -/ 1/ )/ // 2/ 其中/ ,/ k/ 为/ 处理/ 层数/ ,/ 本文/ 中/ k/ =/ 1/ ,/ 2/ ,/ 3/ ,/ σ/ ε/ 为/ 高斯/ 白/ 噪声/ 方差/ 的/ 先验/ 统计/ 值/ [/ 9/ -/ 12/ ]/ ./ 计算/ 窗口/ 的/ 形状/ 及大序/ 是/ Pixel/ →/ (/ L/ 、/ H/ )/ →/ (/ LL1/ 、/ HL1/ 与/ LH1/ 、/ HH1/ )/ →/ (/ LL2/ 、/ HL2/ 与/ LH2/ 、/ HH2/ )/ →/ (/ LL3/ 、/ HL3/ 与/ LH3/ 、/ HH3/ )/ ,/ 而/ 重构/ 变换/ 的/ 要/ 处理/ 的/ 数据/ 顺序/ 为/ (/ LL3/ 、/ HL3/ 与/ LH3/ 、/ HH3/ )/ →/ (/ LL2/ 、/ HL2/ 与/ LH2/ 、/ HH2/ )/ →/ (/ LL1/ 、/ HL1/ 与/ LH1/ 、/ HH1/ )/ →/ Pixel/ ./ 在/ 讨论/ 提升/ 小/ 波/ 变换/ 计算方法/ 之后/ ,/ 第/ 2/ 节/ 讨论/ 小/ 波/ 变换/ 的/ 过程/ 与/ 计算公式/ ;/ 第/ 3/ 节/ 讨论/ 小/ 波/ 变换/ 的/ 数据/ 并行/ 实现/ 方法/ ;/ 第/ 4/ 节是/ SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 方法/ ;/ 第/ 5/ 节是/ 结束语/ ./ 2/ 小波/ 变换/ 的/ 过程/ 与/ 计算公式/ 9/ // 7/ 提升/ 小/ 波/ 变换/ 的/ 分解/ 变换/ 是/ 由/ 4/ 个/ 提升/ 步/ (/ Predict1/ 、/ Update1/ 、/ Predict2/ 、/ Update2/ )/ 和/ 2/ 个/ 尺度/ 变换/ (/ ScalingTransform/ )/ 步/ 组成/ 的/ [/ 8/ ]/ ,/ 各层/ 的/ 分解/ 变换/ 是/ 先行/ 变换/ ,/ 然后/ 对行/ 变换/ 后/ 的/ 结果/ 进行/ 列/ 变换/ ,/ 行列/ 分解/ 变换/ 的/ 公式/ 是/ 相同/ 的/ ;/ 后面/ 层/ 的/ 变换/ 仅/ 是/ 对/ 前面/ 层/ 变换/ 的/ 结果/ LLi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ )/ 进行/ 的/ ,/ 因此/ ,/ 每层/ 的/ 提升/ 变换/ 之前/ ,/ 需要/ 有/ 一个/ 分裂/ (/ split/ )/ 步/ ./ 但是/ 由于/ 在/ 本文/ 中/ 采用/ 了/ 状态/ 位/ 的/ 表示/ 方法/ ,/ 所以/ 只/ 需要/ 对/ 每层/ 的/ 输入/ 数据/ 进行/ 一次/ 分裂/ 计算/ ,/ 具体/ 计算公式/ 如表/ 1/ 所示/ ./ 公式/ 中/ 的/ 系数/ 取值/ [/ 8/ ]/ 为/ α/ =/ -/ 1.58613432/ ,/ β/ =/ -/ 0.05298011854/ ,/ γ/ =/ 0.8829110762/ ,/ δ/ =/ 0.443506822/ ,/ / =/ 1.149604398/ [/ 2/ -/ 3/ ]/ ./ 为了/ 描述/ 方便/ ,/ 用/ s0/ 表示/ odd/ 集合/ 中/ 的/ 原始/ 像素/ 值/ ,/ d0/ 表示/ even/ 集合/ 中/ 的/ 原始/ 像素/ 值/ ./ 小波子/ 带/ 系数/ 处理/ ,/ 以/ 基于/ 方向/ 窗口/ 的/ Wiener/ 滤波/ [/ 9/ -/ 12/ ]/ 为例/ ,/ 小波子/ 带/ 系数/ 处理/ 具有/ 较/ 高/ 的/ 处理/ 精度/ ./ 文献/ [/ 13/ ]/ 给出/ 一种/ 易于/ 并行/ 化/ 的/ 滤波/ 窗/ ,/ 该/ 算法/ 在/ PE/ 阵列/ 中/ 的/ 实现/ 公式/ 为/ s/ =/ -/ (/ Wk/ -/ 1/ )/ // 2/ 小/ 的/ 选择/ ,/ 对/ 处理/ 精度/ 是/ 有/ 影响/ 的/ [/ 14/ ]/ ,/ 其/ 大小/ 及/ 形状/ 因/ 分解/ 层/ 的/ 不同/ 而/ 不同/ ,/ 但/ 实现/ 上/ 的/ 差异/ 只是/ 编/ Page3/ 程/ 的/ 不同/ 而已/ ./ 提升/ 小波/ 的/ 重构/ 变换/ 又/ 叫做/ 逆/ 提升/ 小/ 波/ 变换/ (/ InverseLiftingWaveletTransform/ ,/ ILWT/ )/ ,/ 计算/ 表/ 29/ // 7/ 提升/ 小波/ 的/ 重构/ 变换/ 计算公式/ 第/ 1/ 步/ ./ 尺度/ 逆变换/ (/ InverseScalingTransform/ )/ for/ [/ -/ 1/ / n/ / (/ N/ // 2/ )/ +/ 2/ ]/ do/ :/ {/ d2/ (/ 2n/ )/ =/ / H/ (/ 2n/ )/ ;/ s2/ (/ 2n/ +/ 1/ )/ =/ (/ 1/ // / )/ L/ (/ 2n/ +/ 1/ )/ }/ ;/ 第/ 2/ 步/ ./ 逆/ 更新/ 2/ (/ IinverseUpdate2/ )/ 第/ 3/ 步/ ./ 逆/ 预测/ 2/ (/ InversePredict2/ )/ 第/ 4/ 步/ ./ 逆/ 更新/ 1/ (/ InverseUpdate1/ )/ 第/ 5/ 步/ ./ 逆/ 预测/ 1/ (/ InversePredict1/ )/ 重构/ 变换/ 从/ 分解/ 变换/ 的/ 最后/ 一层/ 开始/ ,/ 首先/ 对/ 所有/ 的/ 列/ 进行/ ,/ 其/ 结果/ 作为/ 行/ 重构/ 变换/ 要/ 处理/ 的/ 数据/ ./ 行/ 重构/ 变换/ 后/ 即/ 完成/ 本层/ 的/ 重构/ ,/ 其/ 结果/ 作为/ 下/ 一层/ 重构/ 变换/ 的/ 要/ 处理/ 的/ 数据/ ,/ 各层/ 的/ 重构/ 过程/ 是/ 相同/ 的/ ,/ 此处/ 不再/ 赘述/ ./ 3/ 提升/ 小/ 波/ 变换/ 的/ 数据/ 并行/ 实现/ 方法/ 第/ 1/ 层/ 分解/ 变换/ 是/ 对/ 一幅/ 图像/ 的/ 所有/ 像素/ 值/ Pixel/ [/ i/ ]/ [/ j/ ]/ 进行/ 的/ ,/ 如图/ 1/ (/ a/ )/ 所示/ ,/ 变换/ 后/ 的/ 结果/ 如图/ 1/ (/ b/ )/ 所示/ ./ 第/ 2/ 层/ 变换/ 是/ 仅/ 对/ 第/ 1/ 层/ 分解/ 后/ 的/ 1/ // 4/ 的/ 数据/ LL1/ 进行/ 的/ ,/ 变换/ 后/ 的/ 结果/ 如图/ 1/ (/ c/ )/ 所示/ ./ 第/ 3/ 层/ 变换/ 是/ 仅/ 对/ 第/ 2/ 层/ 分解/ 后/ 的/ 1/ // 4/ 的/ 数据/ LL2/ 进行/ 的/ ,/ 变换/ 后/ 的/ 结果/ 如图/ 1/ (/ d/ )/ 所示/ ./ 3.1/ 分解/ 变换/ 的/ 数据/ 并行/ 实现/ 方法/ 为了/ 讨论/ 方便/ 起/ 见/ ,/ 下面/ 将/ 先/ 讨论/ 分解/ 变换/ 后/ 的/ 数据/ 在/ PE/ 阵列/ 中/ 位置/ 的/ 表示/ 方法/ ,/ 然后/ 再/ 讨论/ 分解/ 变换/ 的/ 数据/ 并行/ 实现/ 方法/ ./ 由于/ SIMDPE/ 阵列/ 的/ 规模/ 可/ 依据/ 应用/ 需求/ 进行/ 裁减/ ./ 为/ 具体/ 起/ 见/ ,/ 我们/ 假定/ SIMDPE/ 阵列/ 的/ 大/ 公式/ 如表/ 2/ 中/ 所示/ ./ 重构/ 变换/ 中/ 的/ 边界/ 处理/ 与/ 分解/ 变换/ 的/ 边界/ 处理/ 是/ 类似/ 的/ ,/ 仅/ 需/ 对表/ 2/ 中/ 的/ 计算公式/ 稍作/ 修改/ 即可/ ,/ 读者/ 可/ 自行/ 推导/ ./ 小/ 与/ 图像/ 帧/ 的/ 大小/ 一致/ (/ 以/ 16/ ×/ 16/ 为例/ )/ ,/ 图像/ 帧/ 中/ 的/ 像素/ Pixel/ [/ i/ ]/ [/ j/ ]/ 是/ 放在/ PE/ 阵列/ 的/ 处理/ 元/ PE/ [/ i/ ]/ [/ j/ ]/ 中/ ,/ i/ ,/ j/ 表示/ 像素/ 在/ 图像/ 帧/ 中/ 的/ 位置/ ,/ 也/ 是/ 在/ PE/ 阵列/ 中/ 的/ 位置/ ./ 阵列/ 中/ 各/ PE/ 之间/ 的/ 互连/ 关系/ ,/ 是/ 按/ 东西南北/ 4/ 个/ 方向/ 进行/ 互连/ (/ DW/ / DE/ 和/ DN/ / DS/ )/ 的/ ,/ 如图/ 2/ 所示/ ,/ PE/ 之间/ 只有/ 相邻/ 的/ 局部/ 通信/ ./ 该/ 阵列/ 中/ ,/ 处理/ 元/ PE/ 由/ 数据处理/ 部件/ 以及/ 相应/ 的/ 路由器/ 与/ 缓冲器/ 三者/ 组成/ ,/ 路由器/ 和/ 缓冲器/ 构是/ 通信/ 的/ 功能/ 部件/ ,/ 此处/ 限于/ 篇幅/ 不/ 做/ 深入/ 讨论/ ./ 在/ SIMDPE/ 阵列/ 上/ 对/ 一幅/ 二维/ 图像/ 进行/ 提升/ 小/ 波/ 变换/ ,/ 就是/ 对/ 存放/ 像素/ 值/ 的/ 所有/ PE/ 单元/ ,/ 先/ 按行/ 方向/ 进行/ 数据/ 并行计算/ 处理/ ,/ 计算/ 后/ 的/ 结果/ 放入/ 对应/ 的/ PE/ 单元/ 中/ ,/ 然后/ 按列/ 方向/ 再/ 进行/ 数据/ 并行计算/ 处理/ ,/ 计算/ 后/ 的/ 结果/ (/ 即子/ 带/ 系数/ )/ 就/ 存放/ 于/ PE/ 阵列/ 中/ ./ 3.1/ ./ 1/ 分解/ 变换/ 后/ 的/ 数据/ 在/ PE/ 阵列/ 位置/ 的/ 状态/ 提升/ 小/ 波/ 变换/ 的/ 数据/ 在/ 处理/ 元/ 中/ 的/ 位置/ 可以/ 按/ 处理/ 元/ 的/ 位置/ 坐标/ 事先/ 确定/ ,/ 即/ 分裂/ 步是/ 可以/ 事先/ 完成/ ,/ 并用/ 状态/ 位/ 标识/ 的/ ./ 对于/ 分裂/ 步/ ,/ 就是/ 用/ 状态/ 位/ b0/ =/ 1/ 与/ b0/ =/ 0/ 分别/ 表示/ 奇数/ 列/ 与/ 偶数/ 列/ ;/ b1/ =/ 1/ 与/ b1/ =/ 0/ 分别/ 表示/ 奇数/ 行/ 与/ 偶数/ 行/ ./ 其它/ 各层/ 的/ 状态/ 位/ 也/ 是/ 在/ 这个/ 分裂/ 步上求/ 出来/ 的/ ./ 第/ 1/ 层/ 分解/ 变换/ 是/ 对/ 图像/ 帧/ 的/ 所有/ 像素/ 值/ 进行/ 的/ ./ 先对/ 所有/ 的/ 行/ 按表/ 1/ 的/ 公式/ 进行/ 数据/ 并行计算/ ,/ 计算结果/ 为子/ 带/ 系数/ L1/ 和子/ 带/ 系数/ H1/ ,/ 如图/ 3/ (/ a/ )/ 8/ ×/ 8/ 的/ PE/ 阵列/ 中/ 所示/ ./ PE/ 阵列/ 的/ 每个/ 奇数/ 列上/ 均/ 为/ L1/ ,/ 每个/ 偶数/ 列上/ 均/ 为/ H1/ ,/ 将/ 第/ 1/ 层行/ 分解/ 变换/ 后/ 的/ 所有/ 的/ 奇数/ 列/ 构成/ 的/ 集合/ 统称/ 为/ odd1c/ 列/ 集合/ ;/ 所有/ 偶数/ 列/ 构成/ 的/ 集合/ 统称/ 为/ even1c/ 列/ 集合/ ,/ 分别/ 在/ 状态/ 位/ b0/ =/ 1/ 与/ b0/ =/ 0/ 的/ PE/ 单元/ 中/ ;/ 然后/ 针对/ 行/ 处理/ 后/ 的/ 结果/ ,/ 即子/ 带/ 系数/ L1/ 和/ H1/ ,/ 同时/ 对/ 所有/ 的/ 列/ 按表/ 1/ 的/ 公/ Page4/ 图/ 2SIMDPE/ 阵列/ 体系结构/ (/ LS/ -/ MPP/ )/ 图/ 3/ 第/ 1/ 层/ 变换/ 后/ 的/ 子/ 带/ 系数/ 位置/ 的/ 分布/ 情况/ 举例/ 式/ 进行/ 数据/ 并行计算/ ./ 变换/ 后/ 的/ 结果/ 为子/ 带/ 系数/ LL1/ 、/ LH1/ 与/ HL1/ 、/ HH1/ ,/ 如图/ 3/ (/ b/ )/ 所示/ ./ PE/ 阵列/ 的/ 每个/ 奇数/ 行上/ 均/ 为/ LL1/ 与/ LH1/ ,/ 每个/ 偶数/ 行上/ 均/ 为/ HL1/ 与/ HH1/ ,/ 将/ 第/ 1/ 层列/ 分解/ 变换/ 后/ 所有/ 的/ 奇数/ 行/ 构成/ 的/ 集合/ 统称/ 为/ odd1r/ 行/ 集合/ ;/ 所有/ 的/ 偶数/ 行/ 构成/ 的/ 集合/ 统称/ 为/ even1r/ 行/ 集合/ ,/ 分别/ 在/ 状态/ 位/ b1/ =/ 1/ 与/ b1/ =/ 0/ 的/ PE/ 单元/ 中/ ./ 第/ 2/ 层/ 分解/ 变换/ 是/ 仅/ 对/ 第/ 1/ 层/ 分解/ 后/ 的/ 子/ 带/ 系数/ LL1/ (/ 即/ 第/ 1/ 层/ 变换/ 后/ 的/ 四分之一/ )/ 的/ 数据/ 进行/ 的/ ,/ 如图/ 1/ (/ b/ )/ 所示/ ./ 在/ SIMDPE/ 阵列/ 上/ ,/ 子带/ 系数/ LL1/ 是/ 分布/ 在/ i/ =/ 2n/ -/ 1/ 和/ j/ =/ 2n/ -/ 1/ (/ 1/ / n/ / N/ // 2/ )/ 的/ 位置/ 上/ 的/ ./ LL1/ 所在/ 单元/ 是/ 用/ 状态/ 位/ b2/ =/ 1/ 表示/ 图/ 4/ 第/ 2/ 层/ 变换/ 后/ 的/ 子/ 带/ 系数/ 位置/ 的/ 分布/ 情况/ 举例/ 第/ 3/ 层/ 分解/ 变换/ 是/ 仅/ 对/ 第/ 2/ 层/ 分解/ 后/ 的/ 子/ 带/ 系数/ LL2/ ,/ 即/ 第/ 2/ 层/ 变换/ 后/ 的/ 四分之一/ 的/ 数据/ ,/ 如图/ 1/ (/ c/ )/ 所示/ ,/ 进行/ 分解/ 变换/ 的/ ./ 在/ SIMDPE/ 阵列/ 上/ ,/ 子带/ 系数/ LL2/ 是/ 分布/ 在/ i/ =/ 4n/ -/ 3/ 和/ j/ =/ 4n/ -/ 3/ (/ 1/ / n/ / 的/ ,/ 非/ LL1/ 所在/ 单元/ 是/ 用/ b2/ =/ 0/ 表示/ ./ LL1/ 的/ 位置/ 坐标/ 为/ i/ =/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 与/ j/ =/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ ,/ 如图/ 3/ (/ b/ )/ 所示/ ./ 由于/ 对/ LL1/ 进行/ 的/ 变换/ 也/ 是/ 要/ 奇偶/ 分裂/ ,/ 所以/ 重新/ 设置/ 这些/ 位置/ 坐标/ 为/ i/ =/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ …/ ,/ N/ 与/ j/ =/ 1/ ,/ 2/ ,/ 3/ ,/ 4/ ,/ …/ ,/ N/ ,/ 如图/ 4/ (/ a/ )/ 中/ 所示/ ./ 第/ 2/ 层行/ 分解/ 变换/ 后/ 的/ 结果/ 为子/ 带/ 系数/ L2/ 与/ H2/ ,/ 与/ 第/ 1/ 层/ 变换/ 类似/ ,/ 分别/ 在/ b2b3/ =/ 11/ 与/ b2b3/ =/ 10/ 的/ PE/ 单元/ 中/ ;/ 然后/ 对/ 它们/ 按表/ 1/ 的/ 公式/ 进行/ 数据/ 并行计算/ ./ 计算/ 后/ 的/ 结果/ 为子/ 带/ 系数/ LL2/ 、/ LH2/ 与/ HL2/ 、/ HH2/ ,/ 如图/ 4/ (/ b/ )/ 所示/ ,/ 它们/ 分别/ 在/ b2b4/ =/ 11/ 与/ b2b4/ =/ 10/ 的/ PE/ 单元/ 中/ ./ 对于/ b2/ =/ 0/ 的/ 单元/ ,/ 它们/ 的/ b3/ 、/ b4/ 均/ 为/ 不管/ (/ don/ ’/ tcare/ )/ 位/ ./ N/ // 4/ )/ 的/ 位置/ 上/ 的/ ,/ 如图/ 4/ (/ b/ )/ 所示/ ,/ LL2/ 所在/ 单元/ 是/ 用/ 状态/ 位/ b5/ =/ 1/ 表示/ 的/ ,/ 非/ LL2/ 所在/ 单元/ 是/ 用/ b5/ =/ 0/ 表示/ 的/ ./ 由于/ 对/ LL2/ 进行/ 的/ 变换/ 也/ 是/ 要/ 奇偶/ 分裂/ 的/ ,/ 所以/ 重新/ 设置/ 这些/ 位置/ 的/ 坐标/ 为/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ NPage5/ 与/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ ,/ 如图/ 5/ (/ a/ )/ 8/ ×/ 8/ 的/ PE/ 阵列/ 中/ 所示/ ./ 第/ 3/ 层行/ 分解/ 变换/ 后/ 的/ 结果/ 是子/ 带/ 系数/ L3/ 与/ H3/ ,/ 将/ 所有/ 奇数/ 列/ 构成/ 的/ 集合/ 统称/ 为/ odd3c/ 列/ 集合/ ,/ 将/ 所有/ 偶数/ 列/ 构成/ 的/ 集合/ 统称/ 为/ even3c/ 列/ 集合/ ,/ 分别/ 在/ b5b6/ =/ 11/ 与/ b5b6/ =/ 10/ 的/ PE/ 单元/ 中/ ;/ 然后/ 对行/ 变换/ 后/ 的/ 子/ 带/ 系数/ L3/ 和/ H3/ ,/ 同时/ 对/ 所有/ 的/ 图/ 5/ 第/ 3/ 层/ 变换/ 后/ 的/ 子/ 带/ 系数/ 的/ 位置/ 的/ 分布/ 情况/ 举例/ 各层/ 的/ 状态/ 位/ 表示/ 如表/ 3/ 中/ 所示/ ./ 读者/ 不难/ 推出/ 更/ 多层/ 分解/ 变换/ 的/ 状态/ 位/ 表示/ 情况/ ./ 表/ 3/ 犘/ 犈/ [/ 犻/ ]/ [/ 犼/ ]/ 状态/ 寄存器/ PSR/ 的/ 设置/ 情况表/ 输入/ 状态/ 位/ 第/ 1/ 层/ 无/ 第/ 2/ 层/ b2/ =/ 1/ 第三层/ b5/ =/ 13.1/ ./ 2/ 分解/ 变换/ 的/ 数据/ 并行程序/ 实现/ 方法/ 在/ SIMDPE/ 阵列/ 中/ ,/ 不是/ 每条/ 指令/ 都/ 在/ 每个/ PE/ 上能/ 同时/ 执行/ 的/ ,/ 就/ 存在/ 所谓/ 的/ 自治/ (/ automations/ )/ 问题/ ,/ 也/ 就是/ 条件/ 计算/ 问题/ ./ 在/ 分解/ 变换/ 中/ ,/ 程序/ 是/ 以/ 状态/ 位为/ 条件/ ,/ 采用/ 条件/ 传送/ 语句/ 与/ 条件/ 算术/ 语句/ 等/ 描述/ 的/ [/ 15/ ]/ ./ 因为/ 条件/ 语句/ 是/ 在/ 条件/ 成立/ 时才/ 执行/ 相应/ 的/ 操作/ ,/ 条件/ 不/ 成立/ 时/ 执行/ NOP/ 操作/ 的/ ./ 这样/ ,/ 对应/ 于/ 各层/ 的/ 分解/ 变换/ 就/ 可以/ 对/ 整个/ N/ ×/ N/ 的/ 阵列/ 进行/ ,/ 第/ 1/ 层/ 分解/ 变换/ 是/ 先/ 完成/ 分裂/ 步/ ,/ 求出/ 各层/ 所用/ 的/ 状态/ 位/ ./ 第/ 2/ 层及/ 以后/ 的/ 分解/ 变换/ 均/ 没有/ 分裂/ 步/ ,/ 而是/ 从/ 预测/ 1/ 开始/ 的/ ./ 本文/ 约定/ 原始/ 像素/ 值/ 存储/ 在/ PE/ [/ i/ ]/ [/ j/ ]/ 的/ 寄存器/ r0/ 中/ ,/ 表/ 1/ 中/ 计算公式/ 的/ 提升/ 系数/ 作为/ 立即/ 数/ 处理/ ,/ 状态/ 位/ 的/ 值/ 是/ 存放/ 在/ 状态/ 寄存器/ 中/ 的/ ,/ 不/ 占用/ 单独/ 的/ 单元/ ,/ 在/ 第/ 1/ 层/ 提升/ 小波行/ 分解/ 变换/ 中/ ,/ 对/ 所有/ 列/ 进行/ 分解/ 变换/ ,/ 分解/ 变换/ 后/ 的/ 子/ 带/ 系数/ 为/ LL3/ 、/ LH3/ 与/ HL3/ 、/ HH3/ ,/ 如图/ 5/ (/ b/ )/ 所示/ ,/ 将/ 所有/ 奇数/ 行/ 构成/ 的/ 集合/ 统称/ 为/ odd3r/ 行/ 集合/ ,/ 将/ 所有/ 偶数/ 行/ 构成/ 的/ 集合/ 统称/ 为/ even3r/ 行/ 集合/ ,/ 分别/ 在/ b5b7/ =/ 11/ 与/ b5b7/ =/ 10/ 的/ PE/ 单元/ 中/ ./ 对于/ b5/ =/ 0/ 的/ 单元/ ,/ 它们/ 的/ b6/ 、/ b7/ 均/ 为/ 不管/ (/ don/ ’/ tcare/ )/ 位/ ./ 的/ 行/ 进行/ 处理/ 的/ 程序段/ 如表/ 4/ 所示/ ./ 计算/ 步骤/ 序号/ 及/ 名称/ 预测/ 1/ 的/ 程序实现/ 更新/ 1/ 的/ 程序实现/ 预测/ 2/ 的/ 程序实现/ 更新/ 2/ 的/ 程序实现/ 尺度/ 变换/ ifr0/ =/ (/ b0/ =/ =/ 0/ )/ ?/ {/ (/ 1/ // / )/ ×/ r0/ }/ :/ NOP/ ;/ 根据/ 表/ 1/ 的/ 计算公式/ ,/ 预测/ 1/ 的/ 程序实现/ 方法/ ,/ 如表/ 4/ 所示/ ./ 第/ 1/ 条/ 语句/ 将/ 状态/ 位/ b0/ =/ 1/ 的/ 所有/ PE/ 单元/ 的/ 寄存器/ r0/ 的/ 值/ 乘以/ 系数/ α/ ,/ 得到/ 的/ 结果/ 放入/ r1/ 中/ ;/ 第/ 2/ 条/ 语句/ 将/ b0/ =/ 1/ 的/ PE/ 单元/ 的/ r1/ 的/ 值/ 送入/ 其右/ 邻/ 的/ PE/ 单元/ 的/ r2/ 中/ ,/ 第/ 3/ 条/ 语句/ 将/ b0/ =/ 1/ 的/ PE/ 单元/ 的/ r1/ 的/ 值/ 送入/ 其/ 左邻/ 的/ PE/ 单元/ 的/ r3/ 中/ ;/ 第/ 4/ 条/ 语句/ 将/ b0/ =/ 0/ 的/ PE/ 单元/ 的/ r2/ 和/ r3/ 的/ 值/ 相加/ ,/ 结果/ 放入/ r4/ 中/ ;/ 第/ 5/ 条/ 语句/ 将/ b0/ =/ 0/ 的/ PE/ 单元/ 的/ r4/ 的/ 值/ 与/ r0/ 的/ 值/ 相加/ ,/ 便/ 得到/ 预测/ 1/ 的/ Page6/ 细节/ 值/ d1/ ,/ 放入/ r0/ 中/ ./ 更新/ 1/ 的/ 程序实现/ 方法/ ,/ 第/ 1/ 条/ 语句/ 将/ 状态/ 位/ b0/ =/ 0/ 的/ 所有/ PE/ 单元/ 的/ 寄存器/ r0/ 的/ 值/ 乘以/ 系数/ β/ ,/ 得到/ 的/ 结果/ 放入/ r1/ 中/ ;/ 第/ 2/ 条/ 语句/ 将/ b0/ =/ 0/ 的/ PE/ 单元/ 的/ r1/ 的/ 值/ 送入/ 其右/ 邻/ 的/ PE/ 单元/ 的/ r2/ 中/ ,/ 第/ 3/ 条/ 语句/ 将/ b0/ =/ 0/ 的/ PE/ 单元/ 的/ r1/ 的/ 值/ 送入/ 其/ 左邻/ 的/ PE/ 单元/ 的/ r3/ 中/ ;/ 第/ 4/ 条/ 语句/ 将/ b0/ =/ 1/ 的/ PE/ 单元/ 的/ r2/ 和/ r3/ 的/ 值/ 相加/ ,/ 结果/ 放入/ r4/ 中/ ;/ 第/ 5/ 条/ 语句/ 将/ b0/ =/ 1/ 的/ PE/ 单元/ 的/ r4/ 的/ 值/ 与/ r0/ 的/ 值/ 相加/ ,/ 得到/ 第一步/ 更新/ 后/ 的/ 平滑/ 值/ s1/ ,/ 放入/ r0/ 中/ ./ 预测/ 2/ 和/ 更新/ 2/ 的/ 程序实现/ 方法/ ,/ 是/ 分别/ 与/ 预测/ 1/ 和/ 更新/ 1/ 类似/ 的/ ,/ 只是/ 用到/ 系数/ 分别/ 为/ γ/ 和/ δ/ 最后/ 是/ 尺度/ 变换/ ,/ 第/ 1/ 条/ 语句/ 将/ b0/ =/ 0/ 的/ 单元/ r0/ 的/ 值/ 乘以/ 系数/ 1/ // / ,/ 结果/ 为子/ 带/ 系数/ H1/ ;/ 第/ 2/ 条/ 语句/ 将/ b0/ =/ 1/ 的/ 单元/ r0/ 的/ 值/ 乘以/ 系数/ / ,/ 结果/ 为子/ 带/ 系数/ L1/ ./ L1/ 与/ H1/ 在/ 是/ 分别/ 存放/ 在/ 状态/ 位/ b0/ =/ 0/ 与/ b0/ =/ 1/ 的/ 单元/ 中/ 的/ ./ 第/ 1/ 层列/ 分解/ 变换/ ,/ 与行/ 分解/ 变换/ 类似/ ,/ 仅/ 需在表/ 4/ 中/ ,/ 用/ i/ 代替/ j/ ,/ 用/ b1/ 代替/ b0/ 即可/ ./ 第/ 2/ 层/ 分解/ 变换/ 与/ 第/ 1/ 层/ 是/ 类似/ 的/ ,/ 只是/ 所用/ 到/ 的/ 状态/ 位/ 不同/ ./ 在/ 对行/ 的/ 分解/ 变换/ 中/ ,/ 用/ b2b3/ =/ =/ 11/ 代替/ b0/ =/ =/ 1/ ,/ b2b3/ =/ =/ 10/ 代替/ b0/ =/ =/ 0/ ,/ i/ 代替/ i/ ,/ j/ 代替/ j/ ;/ 在/ 对/ 列/ 的/ 分解/ 变换/ 中/ ,/ 用/ b2b4/ =/ =/ 11/ 代替/ b1/ =/ =/ 1/ ,/ b2b4/ =/ =/ 10/ 代替/ b1/ =/ =/ 0/ ,/ 用/ i/ 代替/ j/ ,/ j/ 代替/ i/ ./ 依此/ 读者/ 不难/ 推出/ 第/ 3/ 层/ 以及/ 更/ 多层/ 分解/ 变换/ 的/ 数据/ 并行程序/ 实现/ 方法/ ./ 3.2/ Wiener/ 滤波/ 的/ 数据/ 并行计算/ 方法/ 基/ 于小波/ 变换/ 的/ Wiener/ 滤波/ 图像去噪/ ,/ 在/ 各个/ 分解/ 层上/ ,/ 是/ 仅/ 对/ LH/ 、/ HL/ 和/ HH/ 这/ 3/ 个子/ 带/ 系数/ 进行/ 的/ ./ 本节/ 仅/ 以/ 第/ 3/ 分解/ 层/ 的/ 处理/ 为例/ ,/ 讨论/ 在/ 3/ ×/ 3/ 的/ 方形/ 窗口/ 中/ 对/ 相邻/ 的/ 9/ 个子/ 带/ 系数/ :/ HL3/ 、/ LH3/ 和/ HH3/ 进行/ 滤波/ 的/ 数据/ 并行/ 实现/ 方法/ ./ 现以子/ 带/ 系数/ HH3/ 为例/ ,/ 说明/ 去/ 噪/ 公式/ (/ 1/ )/ 和/ (/ 2/ )/ 的/ 并行计算/ 过程/ ./ 公式/ (/ 1/ )/ 是/ 一种/ 局部/ 运算/ ,/ 对于/ 所有/ 的/ 初始/ HH3/ ,/ 首先/ 进行/ 求/ 平方/ ,/ 求/ 平方/ 后/ 得到/ 的/ 每个/ HH3/ 都/ 与其/ 相邻/ 的/ 8/ 个求/ 平方/ 后/ 的/ HH3/ 求和/ ,/ 并/ 除以/ 9/ 求/ 均值/ 以及/ 求/ 均值/ 与/ σ/ 2/ 与/ 0/ 的/ 最大值/ ,/ 便/ 得到/ 公式/ (/ 1/ )/ 的/ 结果/ PE/ [/ i/ ]/ [/ j/ ]/ ./ 公式/ (/ 2/ )/ 是/ 一种/ 点/ 运算/ ,/ 首先/ 求/ PE/ [/ i/ ]/ [/ j/ ]/ 与/ σ/ 2/ 和/ ,/ 然后/ 用/ 这个/ 和/ 除/ PE/ [/ i/ ]/ [/ j/ ]/ ,/ 最后/ 与/ HH3/ 相乘/ ,/ 便/ 得到/ 公式/ (/ 2/ )/ 的/ 结果/ PE/ [/ i/ ]/ [/ j/ ]/ ./ 子带/ 系数/ HL3/ 、/ LH3/ 的/ 处理/ 与/ 此/ 类似/ ./ 第/ 1/ 、/ 2/ 分解/ 层/ 的/ 处理/ 与/ 第/ 3/ 分解/ 层/ 也/ 是/ 类似/ 的/ ,/ 不再/ 赘述/ ./ 不难看出/ ,/ 公式/ (/ 1/ )/ 和/ (/ 2/ )/ 的/ 编程/ 与/ 分解/ 变换/ 的/ 编程/ 类似/ ,/ 由/ 第/ 3/ 节/ 内容/ 可知/ ,/ 对/ 各个/ 子带/ 系数/ 处理/ 均/ 可/ 采用/ 基于/ PSR/ 状态/ 标识/ 位/ 的/ 条件/ 执行/ 语句/ 来/ 实现/ ./ 在/ 完成/ 了/ 所有/ 3/ 层/ 的/ 子/ 带/ 系数/ 去/ 噪/ 处理/ 后/ ,/ 将/ 进行/ 下节/ 中/ 讨论/ 的/ 重构/ 变换/ ,/ 便/ 可/ 获得/ 去/ 噪后/ 的/ 图像/ ./ 其它/ 去/ 噪/ 方法/ 与/ 此/ 类似/ ,/ 具体/ 参见/ 文献/ [/ 16/ ]/ ./ 3.3/ 重构/ 变换/ 的/ 数据/ 并行计算/ 方法/ 与/ 分解/ 变换/ 一致/ ,/ 重构/ 变换/ 也/ 只/ 讨论/ 3/ 层/ 的/ 情况/ ./ 在/ 各个/ 分解/ 层上/ ,/ 对/ LL/ 、/ HL/ 与/ LH/ 、/ HH4/ 个子/ 带/ 系数/ 进行/ ,/ 是/ 先/ 对/ 所有/ 的/ 列/ ,/ 然后/ 对/ 所有/ 的/ 行/ 按表/ 2/ 的/ 公式/ 进行/ 数据/ 并行计算/ ./ 第/ 3/ 层/ 重构/ 变换/ 的/ 数据/ 位置/ 分布/ ,/ 也/ 是/ 用/ PE/ 单元/ 的/ PSR/ 状态/ 位/ 表示/ 的/ ,/ 即/ b5b7/ =/ 10/ 与/ b5b7/ =/ 11/ 表示/ 细节/ 值/ d2/ 与/ 平滑/ 值/ S2/ 的/ 位置/ ;/ b5b6/ =/ 10/ 与/ b5b6/ =/ 11/ 表示/ 细节/ 值/ d1/ 与/ 平滑/ 值/ S1/ 的/ 位置/ ./ 重构/ 变换/ 后/ 的/ 结果/ 为子/ 带/ 系数/ LL2/ ,/ 若/ 无/ 误差/ 即为/ LL2/ ,/ 位置/ 分布/ 情况/ 如图/ 4/ (/ b/ )/ 中/ 所示/ ./ 依此类推/ ,/ 第/ 2/ 层/ 与/ 第/ 1/ 层/ 的/ 重构/ 变换/ 都/ 是/ 与/ 第/ 3/ 层/ 类似/ 的/ ,/ 不再/ 赘述/ ./ 4SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 利用/ 现在/ 的/ 深亚/ 微米/ 技术/ ,/ 很难/ 实现/ 与/ G/ 级/ 像素/ 帧/ 同样/ 大小/ 的/ SIMDPE/ 阵列/ ,/ 特别/ 是/ 在/ 嵌入式应用/ 中/ ,/ 实际/ 的/ 物理/ 阵列/ 是/ 远/ 小于/ G/ 级/ 像素/ 帧/ 的/ 大小/ 的/ ,/ 上节/ 的/ 讨论/ 是/ 建立/ 在/ SIMDPE/ 阵列/ 的/ 虚拟化/ 设计/ 基础/ 上/ 的/ ./ SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 可以/ 有/ 许多/ 方案/ ,/ 这里/ 分别/ 对/ 不同/ 物理/ 阵列/ 规模/ 的/ 3/ 种/ 情况/ 进行/ 分别/ 讨论/ ,/ 并/ 在/ 最后/ 给出/ 基于/ 1024/ ×/ 1024/ 处理/ 元/ 情况/ 下/ 的/ 性能/ 分析/ 与/ 仿真/ 结果/ ./ 4.1/ 一个/ 处理/ 元/ 的/ 虚拟/ PE/ 阵列/ 的/ 单/ 处理/ 元/ 的/ 虚拟/ 就是/ 在/ PC机/ 上/ 验证/ 本文/ 的/ 数据/ 并行/ 方法/ ,/ 虚拟/ 方法/ 是/ 设定/ 图像/ 帧/ 的/ 每个/ 像素/ 单元/ 是/ 由/ 像素/ 值/ 与/ 状态字/ 组成/ 的/ ./ 每条/ 数据/ 并行/ 语句/ 用/ 一个/ 子程序/ 实现/ ,/ 用户/ 只/ 需/ 编写/ 表/ 4/ 所示/ 的/ 程序段/ 即可/ ./ PC机/ 的/ 一个/ 处理器/ ,/ 对/ 整个/ 像素/ 帧/ 的/ 计算/ ,/ 实际上/ 是从/ 第一个/ 像素/ 开始/ ,/ 根据/ 其/ 状态/ 位值/ 的/ 判断/ ,/ 来/ 决定/ 对/ 该/ 像素/ 单元/ 进行/ 相应/ 的/ 计算/ 或空/ 操作/ ,/ 依次/ 对/ 每个/ 像素/ 进行/ 计算/ ,/ 直至/ 整帧/ 图像处理/ 完毕/ ./ 小波/ 变换/ 的/ 行/ 变换/ 和/ 列/ 变换/ 的/ 差别/ 在于/ ,/ 相邻/ 像素/ 的/ 地址/ 间隔/ 不同/ ,/ 读者/ 不难/ 从/ 第/ 2/ 节/ 的/ 讨论/ 中/ 推导/ ./ 4.2/ 一行/ 处理/ 元/ 的/ 虚拟/ 对/ N/ ×/ N/ 的/ 图像/ 帧/ 来说/ ,/ 就是/ 假定/ 有/ 一行/ 处理/ 元/ 在/ 像素/ 帧/ 的/ 单元/ 中/ ,/ 仍然/ 假定/ 每个/ 单元/ 是/ 像素/ 值/ Page7/ 与/ 状态字/ 两者/ 组成/ 的/ ./ 阵列/ 的/ 大小/ 用户/ 可以/ 通过/ 参数/ 设定/ ,/ 对/ 整个/ 像素/ 帧/ 的/ 仿真/ ,/ 行/ 处理/ 元/ 从/ 起始/ 位置/ 开始/ 移动/ ,/ 计算/ 完/ 一行/ 后/ ,/ 转向/ 下/ 一行/ ,/ 直至/ 整帧/ 图像处理/ 完毕/ ./ 与/ 单/ 处理/ 元/ 不同/ 的/ 是/ ,/ 每次/ 操作/ 可/ 完成/ 对/ 与/ 行/ 处理/ 元/ 个数/ 相等/ 的/ 像素/ 的/ 处理/ ./ 换句话说/ ,/ 在/ 进行/ 行/ 变换/ 时/ ,/ 系统/ 可/ 一次/ 处理/ 一行/ 中/ 与/ 处理/ 元/ 个数/ 相等/ 的/ 像素/ 值/ ,/ 在/ 进行/ 列/ 变换/ 时/ ,/ 则/ 是/ 对/ 各个/ 列中/ 的/ 对应/ 的/ 像素/ 单元/ 同时/ 进行/ 处理/ ,/ 这样/ 可/ 大大提高/ 数据处理/ 的/ 并行度/ ./ 行/ 处理/ 元中/ ,/ 行/ 变换/ 和/ 列/ 变换/ 的/ 相邻/ 像素/ 的/ 地址/ 间隔/ 相同/ ./ 4.3/ 阵列/ 处理/ 的/ 虚拟/ 及/ 性能/ 分析/ 本文/ 主要/ 讨论/ 了/ 基于/ SIMDPE/ 阵列/ 的/ 9/ // 7/ 提升/ 小/ 波/ 变换/ 数据/ 并行计算/ 方法/ ,/ 并/ 给出/ 了/ 基/ 于小波/ 分解/ 的/ Wiener/ 滤波/ 在/ SIMDPE/ 阵列/ 上/ 的/ 数据/ 并行计算/ 方法/ ./ 表/ 5/ 针对/ 5/ 层/ 提升/ 小/ 波/ 分解/ 变换/ ,/ 给出/ 了/ 各层/ 变换/ 所/ 需/ 的/ 计算/ 量/ 和/ PE/ 间/ 的/ 通信/ 次数/ ./ 表/ 5/ 和表/ 6/ 针对/ 各个/ 分解/ 层/ ,/ 分别/ 给出/ 了/ 各层/ 的/ 小波/ 变换/ 和/ Wiener/ 滤波/ 所/ 需/ 的/ 计算/ 量/ 和/ PE/ 间/ 的/ 通信/ 次数/ ./ 由于/ 重构/ 变换/ 在/ 计算/ 量/ 和/ 通信量/ 方面/ 与/ 分解/ 变换/ 是/ 一致/ 的/ ,/ 在/ 此/ 不再/ 赘述/ ./ 在/ 阵列/ 大小/ 与/ 图像/ 帧/ 的/ 大小/ 一致/ 的/ 情况/ 下/ ,/ 该/ 统计/ 值/ 与/ 图像/ 的/ 规模/ 无关/ ,/ 适用/ 于/ 各种/ 大小/ 的/ 图像/ 帧/ ,/ 也就是说/ ,/ 当/ 阵列/ 规模/ 足够/ 大时/ ,/ 是/ 适合/ 于/ G/ 级/ 像素/ 帧/ 的/ ./ 表/ 5/ 提升/ 小/ 波/ 分解/ 变换/ 的/ 计算/ 量/ 及/ 通信/ 次数/ 分解/ 层数/ 12345/ 分解/ 层数/ 1142103104656/ 由于/ 当前/ 的/ IC/ 设计/ 在/ 工艺/ 、/ 集成度/ 以及/ 指令/ 周期/ 长度/ 的/ 设置/ 等/ 方面/ ,/ 均/ 存在/ 很大/ 的/ 差异/ ,/ 难以/ 针对/ 同一/ 算法/ 从/ 运行/ 时间/ 上/ 进行/ 比较/ ./ 因此/ ,/ 本文/ 针对/ 当前/ 工艺/ ,/ 基于/ 一些/ 合理/ 的/ 假设/ ,/ 采用/ 最小/ 指令/ 周期/ 数/ 的/ 准则/ ,/ 相较/ 于/ 常规/ 串行/ 处理/ 方式/ ,/ 在/ 不同/ 规模/ 像素/ 帧/ 处理/ 的/ 情况/ 下/ ,/ 对本/ 方案/ 所/ 能/ 获得/ 的/ 加速/ 比/ 进行/ 评析/ ./ 其中/ ,/ 加速/ 比/ Sp/ 的/ 定义/ 为/ Sp/ =/ T1/ // Tp/ ,/ T1/ 与/ Tp/ 分别/ 为/ 采用/ 单/ 处理器/ 的/ 执行/ 时间/ 和/ 采用/ p/ 个/ 处理/ 元/ 的/ 并行执行/ 时间/ ,/ 一次/ 乘/ 累加/ 运算/ 或/ 单次/ 相邻/ PE/ 单元/ 间通信/ 均/ 为/ 最小/ 指令/ 周期/ ,/ 且取/ 最小/ 指令/ 周期/ 为/ 时间/ 单位/ ./ 表/ 7/ 给出/ 了/ 各/ 分解/ 层/ 相对/ 于/ 常规/ 串行/ 处理/ 的/ 加速/ 比/ ./ 图/ 6/ 给出/ 了/ 加速/ 比/ -/ 像素/ 帧/ 规模/ 的/ 变换/ 曲线/ ./ 其中/ ,/ 横坐标/ 为/ 像素/ 帧/ 的/ 规模/ ,/ 纵坐标/ 为/ 规格化/ 的/ 加速/ 比/ ./ 由此/ 不难看出/ ,/ 随/ 像素/ 帧/ 规模/ 的/ 增大/ ,/ 其/ 加速/ 比/ 迅速/ 增大/ ,/ 且/ 其/ 效率/ 值渐/ 线性/ 或亚/ 线性/ ,/ 说明/ 该/ 并行/ 实现/ 方法/ 是/ 可/ 扩放/ 的/ [/ 15/ ]/ ./ 当/ 图像/ 的/ 规模/ 达到/ G/ 级/ 时/ ,/ 其/ 加速/ 比/ 可观/ ,/ 满足/ 大多数/ 大/ 图像/ 帧/ 处理/ 的/ 实时处理/ 的/ 要求/ ./ 帧/ 规模/ 64/ ×/ 6435265.7310/ ./ 76128/ ×/ 1281408262.9243/ ./ 04256/ ×/ 25656321051.68172/ ./ 18512/ ×/ 512225284206.70688/ ./ 701024/ ×/ 10249011216826.82754/ ./ 834.4/ 阵列/ 处理/ 的/ 仿真/ 验证/ 本文/ 采用/ 的/ 验证/ 平台/ 为/ IntelPentium4/ (/ 2.8/ GHz/ )/ 处理器/ ,/ 内存/ :/ 1GB/ ,/ L1dataCache/ :/ 8KB/ ,/ L1UnifiedCache/ :/ 1024KB/ ,/ 采用/ 的/ 仿真/ 软件/ 为/ Parallaxis/ -/ Ⅲ/ ./ 其中/ ,/ 对/ PE/ 的/ 阵列/ 的/ 规模/ 和/ 互联/ 结构/ 是/ 使用/ Parallaxis/ -/ Ⅲ/ 中/ 的/ (/ CONFIGURATION/ )/ 和/ (/ CONNECTION/ )/ 命令/ 来/ 定义/ 的/ ./ PE/ 间/ 的/ 数据/ 交互/ ,/ 是/ 使用/ 系统/ 函数/ MOVE/ 进行/ 模拟/ 仿真/ 的/ ./ 对/ 分辨率/ 为/ 1024/ ×/ 1024/ 的/ 灰度/ 图像/ (/ 灰度级/ 为/ 256/ )/ 进行/ 了/ 5/ 层/ 分解/ ,/ 各/ 分解/ 层/ 的/ 窗口/ 大小/ (/ 按/ 层数/ 由/ 低/ 到/ 高/ 的/ 顺序/ )/ 分别/ 设定/ 为/ (/ 27/ ×/ 27/ )/ 、/ (/ 9/ ×/ 9/ )/ 、/ (/ 9/ ×/ 9/ )/ 、/ (/ 3/ ×/ 3/ )/ 、/ (/ 3/ ×/ 3/ )/ ./ 采用/ Daubechies/ 小波/ 进行/ 了/ 基于/ 本/ 实现/ 方案/ 下/ 的/ 小波/ 变换/ 及/ Wiener/ 滤波/ 仿真/ 验证/ ,/ 其/ 输出/ PSNR/ 约/ 为/ 26.98/ ./ 图/ 7/ (/ a/ )/ 给出/ 了/ 1024/ ×/ 1024/ 像素/ 50dB/ 的/ 含噪/ 图像/ ,/ 图/ (/ b/ )/ 给出/ 了/ 去/ 噪后/ 的/ 图像/ ./ 通过/ 上述/ 的/ 仿真/ ,/ 验证/ 了/ 实现/ 方法/ 的/ 正确性/ ./ Page8/ 图/ 7/ 图像去噪/ 效果/ 5/ 结束语/ 本文/ 针对/ G/ 级/ 像素/ 图像/ 帧/ 实时处理/ ,/ 研究/ 了/ 提升/ 小波/ 的/ 分解/ 变换/ 、/ Wiener/ 滤波/ 与/ 重构/ 变换/ 在/ SIMDPE/ 阵列/ 上/ 的/ 数据/ 并行计算/ 的/ 实现/ 方法/ 以及/ SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 方法/ ./ 小波/ 变换/ 的/ 数据/ 并行/ 实现/ 方法/ 的/ 好处/ ,/ 从/ 软件/ 上/ 讲/ ,/ 并行度/ 不/ 受/ 算法/ 限制/ ,/ 采用/ 状态/ 位/ 表示法/ 以及/ 条件/ 语句/ ,/ 不仅/ 省去/ 了/ 下标/ 表示法/ 的/ 计算/ 量/ ,/ 而且/ 使得/ 分裂/ 步/ 的/ 计算/ 为/ 零/ 时间/ ;/ 其余/ 各/ 计算/ 步/ 的/ 处理程序/ ,/ 如/ 文中/ 所示/ ,/ 不但/ 简短/ ,/ 而且/ 所用/ 到/ 的/ 语句/ 都/ 仅仅/ 是/ 计算/ 与/ 传送/ 语句/ ;/ 数据/ 并行算法/ 的/ 数据处理/ 方式/ 非常/ 规则/ ,/ 可/ 理解/ 性好/ ,/ 通用性/ 强/ ./ 从/ 硬件/ 上/ 讲/ ,/ 并行度/ 仅受/ PE/ 阵列/ 大小/ 的/ 限制/ ,/ 并行性/ 是/ 随/ SIMDPE/ 阵列/ 的/ 大小/ 而/ 变化/ 的/ ./ 由于/ SIMDPE/ 阵列/ 具有/ 可/ 剪裁/ 性/ ,/ 因此/ ,/ 阵列/ 的/ 大小/ 是/ 容易/ 随/ 应用/ 的/ 并行性/ 要求/ 而/ 变化/ 的/ ;/ 特别/ 是/ ,/ 随着/ 芯片/ 集成度/ 的/ 提高/ ,/ 不仅/ 阵列/ 可以/ 扩大/ ,/ 还/ 可以/ 小型化/ ,/ 符合/ 微电子/ 技术/ 发展/ 方向/ ./ 本文/ 提出/ 用/ 状态/ 位来/ 标识/ 所/ 要/ 处理/ 的/ PE/ 单元/ ,/ 而/ 状态/ 位/ 的/ 值/ 是/ 预先/ 可以/ 确定/ 的/ ,/ 这样/ 可以/ 避免/ 每/ 一次/ 处理/ 时/ 进行/ 的/ 分裂/ 计算/ ,/ 大大提高/ 了/ 系统/ 运行/ 效率/ ,/ 该/ 方法/ 还/ 可/ 有效/ 地/ 应用/ 于/ 其它/ 具备/ 一定/ 并行度/ 的/ 变换处理/ ,/ 如/ DCT/ 变换/ 等/ ./ 本文/ 提出/ 的/ 3/ 种/ SIMDPE/ 阵列/ 的/ 虚拟化/ 实现/ 方法/ ,/ 前者/ 是/ 在/ 普通/ 的/ PC机/ 上/ 实现/ 的/ ,/ 适合/ 于/ 不同/ 大小/ 的/ 图像/ 帧/ ,/ 通用性/ 强/ ;/ 向/ 用户/ 提供/ 的/ 指令集/ ,/ 操作/ 简单/ 且/ 容易/ 理解/ ,/ 同时/ 能够/ 验证/ 各条/ 指令/ 设置/ 的/ 合理性/ 以及/ 应用/ 方法/ 的/ 正确性/ ./ 后者/ 在/ 一行/ 和/ 阵列/ 处理/ 元上/ 实现/ ,/ 提高/ 了/ 数据处理/ 的/ 并行度/ ,/ 能够/ 在/ 执行/ 效率/ 等/ 方面/ 体现/ 出/ 并行算法/ 的/ 优势/ ,/ 同时/ 也/ 可以/ 验证/ 子程序/ 的/ 合理性/ 与/ 正确性/ ./ 

