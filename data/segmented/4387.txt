Page1PN2MSVL/ :/ 工作/ 流网/ 到/ MSVL/ 的/ 转换/ 师亚/ 段振华/ 田聪/ (/ 西安电子科技大学/ 计算/ 理论/ 与/ 技术/ 研究所/ 西安/ 710071/ )/ (/ 西安电子科技大学/ ISN/ 国家/ 重点/ 实验室/ 西安/ 710071/ )/ 摘要/ 现有/ 的/ 工作/ 流网/ 到/ 程序设计/ 语言/ 的/ 转换/ 所/ 生成/ 的/ 程序/ 不仅/ 可读性/ 较差/ 而且/ 难以/ 进行/ 验证/ ./ 针对/ 这一/ 情况/ ,/ 该文/ 给出/ 了/ 一个/ 工作/ 流网/ 到/ 建模/ 、/ 仿真/ 和/ 验证/ 语言/ (/ MSVL/ )/ 的/ 结构化/ 转换/ 工具/ PN2MSVL/ ./ 该文/ 首先/ 定义/ 了/ 注释/ 工作/ 流网/ ,/ 然后/ 以/ 注释/ 工作/ 流网/ 为/ 中间/ 模型/ ,/ 利用/ 一组/ 转换规则/ 不断/ 地/ 压缩/ 注释/ 工作/ 流网/ 中/ 的/ 正规/ 结构/ ,/ 最终/ 得到/ MSVL/ 程序/ ./ PN2MSVL/ 生成/ 的/ MSVL/ 程序/ 不仅/ 具备/ 更好/ 的/ 可读性/ ,/ 而且/ 可以/ 利用/ MSVL/ 的/ 支持/ 工具/ MSV/ 进行/ 建模/ 、/ 仿真/ 和/ 验证/ ./ 另外/ ,/ 该文/ 通过/ 一个/ 应用/ 实例/ 详细/ 地/ 展示/ 了/ PN2MSVL/ 的/ 执行/ 过程/ ,/ 并/ 通过/ 大量/ 的/ 实验/ 分析/ 了/ PN2MSVL/ 的/ 可用性/ ./ 关键词/ 工作/ 流网/ ;/ 建模/ ;/ 仿真/ ;/ 验证/ ;/ 转换/ ;/ Petri/ 网/ 1/ 引言/ 作为/ Petri/ 网/ [/ 1/ ]/ 的/ 一个/ 子集/ ,/ 工作/ 流网/ [/ 2/ ]/ 适用/ 于/ Page2/ 证/ [/ 1/ ,/ 3/ ]/ ./ 目前/ 存在/ 一些/ 工具/ (/ 例如/ CPN/ [/ 4/ ]/ )/ 支持/ 工作/ 流网/ 的/ 仿真/ 和/ 验证/ ./ 为了/ 提高/ 软件系统/ 的/ 可靠性/ ,/ 在/ 开发/ 过程/ 中/ 可以/ 首先/ 使用/ 工作/ 流网/ 建立/ 直观/ 模型/ ,/ 并且/ 验证/ 该/ 模型/ 是否/ 满足/ 一些/ 关键/ 属性/ ,/ 如果/ 不/ 满足/ 则/ 修改/ 该/ 模型/ 直至/ 其/ 满足/ 这些/ 关键/ 属性/ ./ 然后/ 利用/ 人工/ 编程/ 或者/ 自动/ 转换/ 工具/ 从/ 工作/ 流网/ 模型/ 获得/ 原型/ 系统/ ./ 最后/ 对/ 原型/ 系统/ 进行/ 细化/ 从而/ 得到/ 最终/ 的/ 系统/ ./ 因为/ 人工/ 编程/ 存在/ 一些/ 固有/ 的/ 缺点/ ,/ 例如/ 繁重/ 的/ 工作量/ 和/ 极大/ 的/ 出错/ 风险/ ,/ 另外/ 自动/ 转换/ 工具/ 能/ 更好/ 地应/ 对模型/ 变更/ ,/ 所以/ 人们/ 不断/ 研究/ 工作/ 流网/ 到/ 程序设计/ 语言/ 的/ 自动/ 转换/ ./ 考虑/ 到/ 生成/ 的/ 程序/ 的/ 可读性/ 、/ 可扩展性/ 和/ 执行/ 效率/ ,/ 结构化/ 转换方法/ [/ 5/ -/ 13/ ]/ 受到/ 青睐/ ./ 结构化/ 转换方法/ 基于/ 一组/ 转换规则/ ,/ 可以/ 将/ 行为/ 结构/ ,/ 例如/ 顺序/ 、/ 选择/ 、/ 循环/ 和/ 并发/ 结构/ ,/ 转换成/ 程序设计/ 语言/ 中/ 对应/ 的/ 结构化/ 语句/ ./ 现有/ 结构化/ 转换方法/ 的/ 缺点/ 是/ 对/ 复杂/ 结构/ 缺乏/ 理想/ 的/ 转换规则/ ./ 目前/ 对/ 复杂/ 结构/ 的/ 转换/ 大致/ 分为/ 3/ 种/ 方式/ :/ 方式/ 1/ ,/ 利用/ 某些/ 程序设计/ 语言/ 的/ 特殊/ 语句/ 直接/ 转换/ 部分/ 复杂/ 结构/ ./ 例如/ ,/ 在/ 工作/ 流网/ 到/ 业务流程/ 执行/ 语言/ (/ BusinessProcessExecu/ -/ tionLanguage/ ,/ BPEL/ )/ 的/ 转换/ 中/ [/ 5/ -/ 6/ ]/ ,/ 因为/ BPEL/ 的/ flow/ 语句/ 可以/ 利用/ 控制/ 链/ 描述/ 结构/ 中/ 变迁/ 的/ 发生/ 顺序/ ,/ 所以/ 一些/ 不/ 含/ 循环/ 的/ 复杂/ 结构/ 被/ 转换成/ flow/ 语句/ ./ 但是/ 这种/ 转换/ 很难/ 扩展/ 到/ 一般/ 的/ 程序设计/ 语言/ ,/ 而且/ 生成/ 的/ 程序/ 的/ 可读性/ 较差/ ./ 方式/ 2/ ,/ 引入/ 人工/ 转换/ 数据库/ [/ 5/ ]/ ,/ 即/ 对/ 复杂/ 结构/ 采用/ 人工/ 转换/ 的/ 方式/ 来/ 处理/ ,/ 并/ 将/ 该/ 结构/ 和/ 人工/ 转换/ 得到/ 的/ 程序/ 储存/ 在/ 数据库/ 中/ 以备/ 下次/ 重用/ ./ 但是/ 这种/ 转换/ 违背/ 了/ 自动化/ 转换/ 这一/ 初衷/ ,/ 而且/ 效率/ 较/ 低/ ./ 方式/ 3/ ,/ 在/ 转换/ 前/ 预先/ 对/ 复杂/ 结构/ 进行/ 结构化/ 处理/ [/ 6/ ,/ 10/ -/ 13/ ]/ ./ 例如/ ,/ 对/ 含/ 循环/ 的/ 复杂/ 结构/ 文献/ [/ 6/ ]/ ,/ 先/ 将/ 其/ 展开/ 成无/ 循环/ 的/ 简单/ 结构/ 然后/ 再/ 进行/ 转换/ ./ 虽然/ 结构化/ 的/ 工作/ 流网/ 到/ 程序设计/ 语言/ 的/ 转换/ 很/ 简单/ ,/ 但是/ 经过/ 结构化/ 处理/ 的/ 工作/ 流网/ 的/ 规模/ 会/ 增大/ ,/ 这/ 导致/ 最终/ 生成/ 的/ 程序/ 规模/ 庞大/ 且/ 可读性/ 差/ ./ 另外/ ,/ 有些/ 工作/ 流网/ 没有/ 等价/ 的/ 结构化/ 模型/ [/ 12/ ]/ ./ 由此可见/ ,/ 工作/ 流网/ 到/ 程序设计/ 语言/ 的/ 结构化/ 转换/ 仍然/ 存在/ 很多/ 困难/ ./ 除此之外/ ,/ 因为/ 现有/ 的/ 结构化/ 转换方法/ 大都/ 以非/ 形式化/ 程序设计/ 语言/ 为/ 目标语言/ ,/ 所以/ 难以/ 对/ 生成/ 的/ 程序/ 进行/ 验证/ ,/ 无法/ 确保/ 其/ 是否/ 满足/ 一些/ 关键/ 属性/ ./ MSVL/ [/ 14/ ]/ 是/ 投影/ 时序/ 逻辑/ [/ 15/ ]/ 的/ 一个/ 可/ 执行/ 子集/ ,/ 包含/ 赋值/ 、/ 顺序/ 、/ 条件/ 、/ 循环/ 、/ 等待/ 、/ 并行/ 和/ 投影/ 等/ 语句/ ./ 作为/ 形式化/ 程序设计/ 语言/ ,/ MSVL/ 既/ 可以/ 像/ 一般/ 程序设计/ 语言/ 一样/ 执行/ ,/ 又/ 可以/ 像/ PROMELA/ 一样/ 为/ 并发/ 系统/ 建模/ ,/ 还/ 可以/ 使用/ 模型/ 检测/ 技术/ 和/ 定理/ 证明/ 技术/ [/ 16/ ]/ 验证/ 程序/ 的/ 一些/ 关键/ 属性/ ./ 现有/ 的/ 工具/ MSV/ [/ 14/ ]/ 支持/ MSVL/ 的/ 统一/ 模型/ 检测/ [/ 14/ ]/ 、/ 符号/ 模型/ 检测/ [/ 17/ ]/ 和/ 限界/ 模型/ 检测/ [/ 18/ ]/ ./ 本文/ 研究/ 了/ 工作/ 流网/ 到/ MSVL/ 的/ 结构化/ 转换/ [/ 19/ ]/ ,/ 并/ 开发/ 了/ 自动/ 转换/ 工具/ PN2MSVL/ ./ 在/ 系统/ 开发/ 过程/ 中/ 可以/ 利用/ PN2MSVL/ 从/ 经过/ 验证/ 的/ 工作/ 流网/ 模型/ 自动/ 生成/ 与其/ 对应/ 的/ MSVL/ 程序/ (/ 原型/ 系统/ )/ ,/ 随后/ 对/ 该/ 程序/ 进行/ 细化/ 和/ 验证/ 从而/ 得到/ 满足/ 关键/ 属性/ 的/ 系统/ ./ PN2MSVL/ 首先/ 为/ 工作/ 流网/ 添加/ 条件/ 注释/ 和/ 语句/ 注释/ ,/ 从而/ 得到/ 注释/ 工作/ 流网/ ;/ 然后/ 使用/ 一组/ 转换规则/ 不断/ 地/ 压缩/ 注释/ 工作/ 流网/ 中/ 的/ 正规/ 结构/ ,/ 直到/ 注释/ 工作/ 流网/ 中/ 只/ 包含/ 一个/ 变迁/ ;/ 最后/ 为/ 该/ 变迁/ 的/ 语句/ 注释/ 添加/ 初始化/ 、/ 区间/ 框架/ 和/ 过程/ 定义/ 语句/ ,/ 从而/ 生成/ 最终/ 的/ MSVL/ 程序/ ./ 该/ 工具/ 的/ 优点/ 在于/ :/ (/ 1/ )/ 不但/ 引入/ 了/ 删除/ 冗余/ 库所/ 的/ 化简/ 规则/ ,/ 而且/ 扩展/ 了/ 现有/ 转换规则/ 使得/ 它们/ 可以/ 适用/ 于/ 更/ 多/ 结构/ ./ 特别/ 是/ 针对/ 复杂/ 循环/ 结构/ 、/ 复杂/ 选择/ 结构/ 、/ 并发/ 结构/ 和/ 不规则/ 结构/ ,/ 提出/ 了/ 新/ 的/ 转换规则/ ./ 这些/ 丰富/ 的/ 转换规则/ 保证/ 生成/ 的/ MSVL/ 程序/ 具备/ 较/ 高/ 的/ 可读性/ ;/ (/ 2/ )/ 对/ 生成/ 的/ MSVL/ 程序/ 可以/ 利用/ 工具/ MSV/ 进行/ 仿真/ 、/ 建模/ 和/ 验证/ ;/ (/ 3/ )/ 该/ 工具/ 使用/ 的/ MSVL/ 语句/ 大都/ 是/ 常用/ 的/ 程序设计/ 语句/ ,/ 容易/ 扩展/ 到/ 其他/ 程序设计/ 语言/ ./ 本文/ 以/ 一个/ 投诉/ 管理系统/ [/ 20/ ]/ 的/ 工作/ 流网/ 为例/ 详细/ 地/ 展示/ 了/ PN2MSVL/ 的/ 执行/ 过程/ ./ 然后/ 使用/ MSV/ 对/ 生成/ 的/ MSVL/ 程序/ 进行/ 仿真/ 、/ 建模/ ,/ 并/ 验证/ 由/ 命题/ 投影/ 时序/ 逻辑/ [/ 14/ ]/ 公式/ 描述/ 的/ 属性/ ./ 另外/ ,/ 通过/ 大量/ 的/ 实验/ 分析/ 了/ PN2MSVL/ 中/ 每个/ 转换规则/ 的/ 使用/ 频率/ 和/ 对/ MSVL/ 程序/ 可读性/ 的/ 影响/ ./ 最后/ ,/ 对/ PN2MSVL/ 的/ 转换规则/ 和/ 现有/ 结构化/ 转换方法/ 的/ 转换规则/ 做/ 了/ 详细/ 对比/ ./ 本文/ 第/ 2/ 节/ 介绍/ 工作/ 流网/ 和/ MSVL/ ;/ 第/ 3/ 节/ 简要/ 介绍/ 工作/ 流网/ 到/ MSVL/ 的/ 转换方法/ ;/ 第/ 4/ 节/ 展示/ 工具/ PN2MSVL/ 的/ 一个/ 应用/ 实例/ ;/ 第/ 5/ 节/ 给出/ 实验/ 和/ 分析/ 结果/ ;/ 第/ 6/ 节/ 讨论/ 相关/ 工作/ ;/ 最后/ 一节/ 总结/ 全文/ 并/ 展望/ 下/ 一步/ 工作/ ./ 2/ 基础/ 概念/ 本/ 节/ 简单/ 介绍/ 工作/ 流网/ 和/ MSVL/ ./ 定义/ 1/ ./ Petri/ 网/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 工作/ 流网/ 2.1/ 工作/ 流网/ (/ WorkFlowNet/ ,/ WFN/ )/ [/ 2/ ]/ 当且/ 仅/ 当/ :/ Page3/ (/ 1/ )/ 存在/ 一个/ 源库/ 所/ i/ ∈/ P/ 满足/ ·/ i/ =/ / ;/ (/ 2/ )/ 存在/ 一个/ 漏库/ 所/ o/ ∈/ P/ 满足/ o/ ·/ =/ / ;/ (/ 3/ )/ 每个/ 节点/ x/ ∈/ P/ ∪/ T/ 在/ 一条/ 从/ i/ 到/ o/ 的/ 路径/ 上/ ./ 工作/ 流网/ 系统/ 是/ 一个/ 四元组/ Σ/ =/ (/ P/ ,/ T/ ,/ F/ ,/ M0/ )/ ,/ 其中/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 工作/ 流网/ ,/ M0/ 是/ 初始/ 标识/ ./ 通常/ ,/ M0/ 只/ 在/ 源库/ 所/ i/ 中/ 放置/ 一个/ 托肯/ ,/ 即/ M0/ =/ {/ i/ }/ ./ 工作/ 流网/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 合理/ 的/ (/ sound/ )/ [/ 21/ ]/ 当/ (/ 1/ )/ / M/ ,/ (/ {/ i/ }/ [/ / >/ M/ )/ / (/ M/ [/ / >/ {/ o/ }/ )/ ;/ (/ 2/ )/ / M/ ,/ (/ {/ i/ }/ [/ / >/ M/ ∧/ M/ / {/ o/ }/ )/ / (/ M/ =/ {/ o/ }/ )/ ;/ (/ 3/ )/ / t/ ∈/ T/ ,/ / M/ ,/ M/ ,/ {/ i/ }/ [/ / >/ M/ [/ t/ >/ M/ ./ Petri/ 网/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 自由选择/ 网/ (/ freechoicenet/ )/ [/ 22/ ]/ 当且/ 仅/ 当/ / t1/ ,/ t2/ ∈/ T/ ,/ ·/ t1/ ∩/ ·/ t2/ ≠/ / / ·/ t1/ =/ ·/ t2/ ./ 在实践中/ 通常/ 只会/ 将/ 经过/ 验证/ 的/ 工作/ 流网/ 转换成/ 可/ 执行/ 的/ 程序/ ./ 合理性/ 是/ 设计/ 良好/ 的/ 工作/ 流网/ 所/ 具备/ 的/ 基本/ 属性/ ./ 另外/ ,/ 作为/ Petri/ 网/ 的/ 一个/ 重要/ 子集/ ,/ 自由选择/ 网/ 很/ 好/ 地/ 平衡/ 了/ 可/ 分析/ 性/ 和/ 表达能力/ ,/ 具备/ 良好/ 的/ 理论/ 结果/ 和/ 高效/ 的/ 分析/ 技术/ [/ 22/ ]/ ./ 因此/ 本文/ 只/ 讨论/ 转换/ 合理/ 的/ 自由选择/ 工作/ 流网/ ./ 2.2/ MSVL/ 集/ ,/ 它/ 的/ 表达式/ 定义/ 如下/ :/ MSVL/ [/ 14/ ]/ 是/ 投影/ 时序/ 逻辑/ [/ 15/ ]/ 的/ 一个/ 可/ 执行/ 子且/ 仅/ 当/ :/ e/ ·/ ·/ ·/ ·/ =/ nsxb/ ·/ ·/ ·/ ·/ =/ true/ |/ falsee0/ =/ e1/ / bb0/ ∧/ b1/ 其中/ n/ 是/ 整数/ ,/ s/ 是/ 字符串/ ,/ x/ 是/ 变量/ ./ MSVL/ 的/ 语句/ 定义/ 如表/ 1/ 所示/ ,/ 其中/ e/ 是/ 表达式/ ,/ 每个/ bi/ 是/ 布尔/ 表达式/ ,/ 每个/ pi/ 代表/ MSVL/ 的/ 语句/ ,/ i/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ m/ }/ ,/ 每个/ xj/ 是/ 变量/ ,/ j/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ n/ }/ ./ x1/ / e/ 表示/ 在/ 当前/ 状态/ ,/ x1/ 的/ 值/ 等于/ e/ 的/ 值/ ,/ 同时/ 将/ 与/ x1/ 绑定/ 的/ 命题/ px1/ 设为/ true/ ;/ x1/ ·/ ·/ =/ e/ 表示/ 在/ 下/ 一/ 状态/ ,/ x1/ 的/ 值/ 等于/ e/ 的/ 当前/ 值/ ,/ 同时/ 将/ 与/ x1/ 绑定/ 的/ 命题/ px1/ 设为/ true/ ;/ 顺序/ 语句/ 、/ 条件/ 语句/ 和/ 循环/ 语句/ 与/ 传统/ 的/ 命令式/ 语言/ 相同/ ;/ (/ p1/ )/ or/ (/ p2/ )/ 表示/ 执行/ p1/ 和/ p2/ 中/ 的/ 一个/ ;/ (/ b1/ →/ p1/ )/ [/ ]/ …/ [/ ]/ (/ bm/ →/ pm/ )/ 表示/ 如果/ 所有/ 条件/ 都/ 为/ 假/ ,/ 那么/ 程序/ 中止/ ,/ 否则/ 随机/ 选择/ 条件/ bi/ 为/ 真的/ pi/ 执行/ ;/ (/ p1/ )/ ‖/ (/ p2/ )/ 表示/ p1/ 和/ p2/ 并行执行/ ,/ 而且/ 同时/ 开始/ 并/ 可以/ 异步/ 结束/ ;/ frame/ (/ x1/ ,/ …/ ,/ xn/ )/ 表示/ 如果/ 没有/ 碰到/ xj/ 的/ 赋值/ 语句/ ,/ 那么/ xj/ 的/ 值/ 保持/ 不变/ ;/ await/ (/ b1/ )/ 表示/ 该/ 进程/ 直到/ 条件/ b1/ 为/ 真/ ,/ 该/ 语句/ 不/ 改变/ 任何/ 变量/ 的/ 值/ ;/ skip/ 表示/ 区间/ 上/ 的/ 一个/ 单位/ 时间/ ./ 我们/ 已经/ 开发/ 了/ MSVL/ 的/ 支持/ 工具/ MSV/ ./ 该/ 工具/ 有/ 3/ 种/ 工作/ 模式/ :/ 仿真/ 模式/ 、/ 建模/ 模式/ 和/ 验证/ 模式/ ./ 在/ 仿真/ 模式/ 下/ 执行/ MSVL/ 程序/ ;/ 在/ 建模/ 模式/ 下/ 通过/ 建立/ 范式/ 图/ [/ 23/ ]/ 来/ 表现/ MSVL/ 程序/ 的/ 所有/ 状态/ ;/ 在/ 验证/ 模式/ 下/ 验证/ MSVL/ 程序/ 是否/ 满足/ 用/ 命题/ 投影/ 时序/ 逻辑/ 公式/ 描述/ 的/ 属性/ ./ 3/ 工作/ 流网/ 到/ MSVL/ 的/ 转换/ 本/ 节/ 简要/ 介绍/ 工作/ 流网/ 到/ MSVL/ 的/ 转换/ [/ 19/ ]/ ,/ 并/ 证明/ 转换规则/ 的/ 完备/ 性/ ./ 首先/ 介绍/ 一些/ 与/ 转换/ 相关/ 的/ 基本概念/ ./ 令/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ Petri/ 网/ ,/ X/ / P/ ∪/ T/ 是/ N/ 的/ 节点/ 子集/ ./ N/ 是/ 标准/ 的/ 当且/ 仅/ 当/ 存在/ 两个/ 节点/ stN/ 和/ endN/ 使得/ N/ 的/ 每个/ 节点/ 都/ 出现/ 在/ 一条/ 从/ stN/ 到/ endN/ 的/ 路径/ 上/ ./ N/ 到/ X/ 的/ 投影/ 是/ N/ 的/ 子网/ ,/ 记作/ N/ |/ X/ =/ (/ P/ |/ X/ ,/ T/ |/ X/ ,/ F/ |/ X/ )/ ,/ 其中/ P/ |/ X/ =/ P/ ∩/ X/ ,/ T/ |/ X/ =/ T/ ∩/ X/ ,/ F/ |/ X/ =/ F/ ∩/ (/ X/ ×/ X/ )/ ./ 对于/ 每个/ x/ ∈/ X/ ,/ 令/ ·/ x/ |/ X/ =/ ·/ x/ ∩/ X/ ,/ x/ ·/ |/ X/ =/ x/ ·/ ∩/ X/ ./ N/ |/ X/ 是/ 自治/ 的/ 当且/ 仅/ 当/ N/ |/ X/ 是/ 标准/ 的/ ,/ (/ ·/ stN/ |/ X/ ∪/ endN/ |/ XX/ ,/ 其中/ X/ =/ X/ \/ {/ stN/ |/ X/ ,/ endN/ |/ X/ }/ ./ 定义/ 2/ ./ 注释/ 工作/ 流网/ (/ AnnotatedWFN/ ,/ AWFN/ )/ 是/ 一个多元/ 组/ AN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ ,/ 其中/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 工作/ 流网/ ;/ G/ 和/ L/ 分别/ 是/ 变迁/ 的/ 条件/ 注释/ 和/ 语句/ 注释/ ./ 对于/ 每个/ 变迁/ t/ ∈/ T/ ,/ G/ (/ t/ )/ 是/ MSVL/ 布尔/ 表达式/ ,/ L/ (/ t/ )/ 是/ MSVL/ 语句/ ./ 注释/ 工作/ 流网/ 被/ 用作/ 工作/ 流网/ 到/ MSVL/ 转换/ 的/ 中间/ 模型/ ./ 令/ N/ =/ (/ P/ ,/ T/ ,/ F/ )/ 是/ 合理/ 的/ 自由选择/ 工作/ 流网/ ./ 为了/ 将/ N/ 最终/ 转换成/ MSVL/ 程序/ ,/ 首先/ 将/ N/ 转换成/ 注释/ 工作/ 流网/ AN/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ ,/ 满足/ / t/ ∈/ T/ ,/ G/ (/ t/ )/ =/ true/ ,/ L/ (/ t/ )/ =/ t/ (/ )/ ,/ 其中/ t/ (/ )/ 在/ 最终/ 生成/ 的/ MSVL/ 程序/ 中/ 被/ 定义/ 为/ definet/ (/ )/ {/ p1/ ·/ ·/ =/ 0and/ …/ andpm/ ·/ ·/ =/ 0and/ 其中/ ·/ t/ \/ t/ ·/ =/ {/ p1/ ,/ …/ ,/ pm/ }/ ,/ t/ ·/ =/ {/ q1/ ,/ …/ ,/ qn/ }/ ./ 对于/ 每个/ 库所/ p/ ∈/ ·/ t/ ∪/ t/ ·/ 存在/ 一个/ 变量/ p/ ,/ 该/ 变量/ 用于/ 记录/ 库/ Page4/ 所/ p/ 中托肯/ 的/ 数量/ ;/ 变迁/ t/ 的/ 语句/ 注释/ L/ (/ t/ )/ 描述/ t/ 执行/ 时/ 对/ 其/ 输入/ 库所/ 和/ 输出/ 库所/ 产生/ 的/ 影响/ ./ 为了/ 将/ AN/ 转换成/ MSVL/ 程序/ ,/ 我们/ 在/ 文献/ [/ 19/ ]/ 中/ 定义/ 了/ 一组/ 转换规则/ ./ 这些/ 规则/ 包括/ :/ 删除/ 冗余/ 库所/ (/ RemovalofRedundantPlace/ ,/ RRP/ )/ 、/ 合并/ 顺序/ 结构/ (/ FoldingSequenceStructure/ ,/ FSS/ )/ 、/ 合并/ 显示/ 选择/ 结构/ (/ FoldingExplicitChoiceStructure/ ,/ FECS/ )/ 、/ 合并/ 简单/ 循环/ 结构/ (/ FoldingSimpleloopStructure/ ,/ FSLS/ )/ 、/ 合并/ 复杂/ 循环/ 结构/ (/ FoldingComplexLoopStructure/ ,/ FCLS/ )/ 、/ 合并/ 复杂/ 选择/ 结构/ (/ FoldingComplexChoiceStructure/ ,/ FCCS/ )/ 、/ 合并/ 并发/ 结构/ (/ FoldingConcurrentStructure/ ,/ FCoS/ )/ 以及/ 合并/ 不规则/ 结构/ (/ FoldingIrregularStructure/ ,/ FIS/ )/ ./ 每个/ 转换规则/ 可以/ 转换/ AN/ 中/ 的/ 一种/ 正规/ 结构/ [/ 19/ ]/ ./ 直观/ 地/ 讲/ ,/ RRP/ 可以/ 删除/ 冗余/ 库所/ ,/ 并且/ 不/ 改变/ 模型/ 的/ 行为/ ./ 其他/ 每个/ 转换规则/ 可以/ 将/ 一种/ 正规/ 结构/ 压缩成/ 一个/ 新/ 的/ 变迁/ ,/ 并且/ 根据/ 该/ 结构/ 的/ 行为/ 构造/ 一个/ 布尔/ 表达式/ 和/ 一条/ 语句/ ,/ 分别/ 作为/ 新/ 变迁/ 的/ 条件/ 注释/ 和/ 语句/ 注释/ ./ 很/ 显然/ ,/ 对于/ 越/ 复杂/ 的/ 正规/ 结构/ ,/ 用于/ 描述/ 其/ 行为/ 的/ MSVL/ 语句/ 就/ 越/ 复杂/ ./ 当/ 注释/ 工作/ 流网/ 中/ 存在/ 多个/ 正规/ 结构/ 时/ ,/ 为了/ 确保/ 生成/ 的/ 程序/ 具有/ 较/ 高/ 的/ 可读性/ ,/ 总会/ 优先/ 转换/ 最/ 简单/ 的/ 正规/ 结构/ ./ 因此/ ,/ 这些/ 转换规则/ 按照/ 使用/ 优先级/ 从/ 高/ 到底/ 排列/ 依次/ 为/ RRP/ 、/ FSS/ 、/ FECS/ 、/ FSLS/ 、/ FCLS/ 、/ FCCS/ 、/ FCoS/ 、/ FIS/ ./ 通过/ 反复/ 地/ 应用/ 这些/ 规则/ 可以/ 将/ AN/ 压缩/ 到/ 只/ 含/ 一个/ 变迁/ d/ ./ L/ (/ d/ )/ 描述/ 了/ 原/ 工作/ 流网/ N/ 的/ 所有/ 行为/ ./ 最终/ 为/ L/ (/ d/ )/ 添加/ 初始化/ 、/ 区间/ 框架/ 和/ 过程/ 定义/ 语句/ ,/ 得到/ 如下/ 程序/ :/ frame/ (/ p1/ ,/ …/ ,/ pa/ ,/ v1/ ,/ …/ ,/ vb/ )/ andp1/ / 1andp2/ / 0and/ …/ andpa/ / 0andv1i/ / 0and/ …/ andvji/ / 0andv1s/ / “/ NULL/ ”/ and/ …/ andvks/ / “/ NULL/ ”/ and/ (/ definet/ (/ )/ {/ p1t/ ·/ ·/ =/ 0and/ …/ andpmt/ ·/ ·/ =/ 0andq1t/ ·/ ·/ =/ 1and/ …/ andqnt/ ·/ ·/ =/ 1/ }/ ;/ …/ L/ (/ d/ )/ )/ 其中/ 对于/ 每个/ 库所/ p/ ∈/ P/ =/ {/ p1/ ,/ …/ ,/ pa/ }/ 都/ 存在/ 一个/ 变量/ p/ ./ p1/ 是/ 源库/ 所/ ,/ 所以/ 变量/ p1/ 的/ 初值/ 为/ 1/ ./ v1i/ ,/ …/ ,/ vji/ (/ v1s/ ,/ …/ ,/ vks/ )/ 是/ 整个/ 转换/ 过程/ 中/ 添加/ 的/ 整型/ (/ 字符串/ 型/ )/ 辅助/ 变量/ ,/ 且/ 初值/ 为/ 0/ (/ “/ NULL/ ”/ )/ ./ 对于/ 每个/ 变迁/ t/ ∈/ T/ 存在/ 一个/ 过程/ 定义/ 语句/ ,/ 其中/ ·/ t/ \/ t/ ·/ =/ {/ p1t/ ,/ …/ ,/ pmt/ }/ ,/ t/ ·/ =/ {/ q1t/ ,/ …/ ,/ qnt/ }/ ,/ L/ (/ d/ )/ 会/ 调用/ 这些/ 过程/ ./ 本节/ 最后/ 证明/ 转换规则/ 的/ 完备/ 性/ ,/ 首先/ 介绍/ 两个/ 引理/ ./ 引理/ 1/ ./ 对/ 一个/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ 只能/ 应用/ 有限/ 多次/ FSLS/ ./ 证明/ ./ 令/ N/ 是/ 一个/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ ,/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ 是/ 对/ N/ 应用/ 有限/ 多次/ 转换规则/ 得到/ 的/ 注释/ 网/ ,/ N/ |/ X/ 是/ N/ 的/ 一个/ 简单/ 循环/ 结构/ ,/ 其中/ T/ |/ X/ =/ {/ d/ }/ ./ d/ 可能/ 是/ N/ 的/ 变迁/ ,/ 也/ 可能/ 是/ 由/ 转换规则/ 添加/ 的/ 变迁/ ./ 由/ 简单/ 循环/ 结构/ 的/ 定义/ 可/ 得/ ,/ / p/ ∈/ P/ |/ X/ ,/ ·/ p/ \/ X/ ≠/ / ,/ p/ ·/ \/ X/ ≠/ / ,/ ·/ p/ |/ X/ ≠/ / ,/ p/ ·/ |/ X/ ≠/ / ./ 因此/ / p/ ∈/ P/ |/ X/ ,/ |/ ·/ p/ |/ >/ 1/ ,/ |/ p/ ·/ |/ >/ 1/ ./ 因为/ N/ 中/ 满足/ |/ ·/ p/ |/ >/ 1/ 和/ |/ p/ ·/ |/ >/ 1/ 的/ 库/ 所/ p/ 是/ 有限/ 多/ 的/ ,/ 所有/ 转换规则/ 都/ 不/ 添加/ 这种/ 库所/ ,/ 而且/ FSLS/ 会/ 删除/ 被/ 处理/ 结构/ 中/ 的/ 这种/ 库所/ ,/ 所以/ 对/ N/ 只能/ 应用/ 有限/ 多次/ FSLS/ ./ 引理/ 2/ ./ 如果/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ N/ 含有/ 多个/ 变迁/ ,/ 那么/ 对/ N/ 总/ 可以/ 应用/ 转换规则/ ./ 证明/ ./ 令/ N/ 是/ 一个/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ 而且/ 含有/ 多个/ 变迁/ ./ 因为/ N/ 是/ 工作/ 流网/ ,/ 所以/ N/ 是/ 自治/ 的/ ./ 如果/ N/ 含有/ 比/ N/ 小/ 的/ 正规/ 结构/ N/ |/ X/ ,/ 那么/ 可以/ 对/ N/ |/ X/ 应用/ 对应/ 的/ 转换规则/ ./ 否则/ ,/ 如果/ N/ 是/ 除/ 不规则/ 结构/ 之外/ 的/ 正规/ 结构/ ,/ 那么/ 可以/ 直接/ 对/ N/ 应用/ 对应/ 的/ 转换规则/ ./ 否则/ ,/ 因为/ N/ 是/ 自治/ 的/ ,/ 含有/ 多个/ 变迁/ ,/ 而且/ 不含/ 除/ 不规则/ 结构/ 之外/ 的/ 正规/ 结构/ ,/ 所以/ N/ 是/ 不规则/ 结构/ ./ 又/ 因为/ N/ 不含/ 比/ N/ 小/ 的/ 正规/ 结构/ ,/ 所以/ N/ 是/ 最小/ 不规则/ 结构/ ./ 那么/ 可以/ 直接/ 对/ 整个/ N/ 应用/ FIS/ ./ 因此/ 对/ N/ 总/ 可以/ 应用/ 转换规则/ ./ 定理/ 1/ ./ RRP/ 、/ FSS/ 、/ FECS/ 、/ FSLS/ 、/ FCLS/ 、/ FCCS/ 、/ FCoS/ 和/ FIS/ 是/ 完备/ 的/ ,/ 即/ 反复/ 应用/ 这些/ 转换规则/ 可以/ 将/ 一个/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ 压缩/ 到/ 只有/ 一个/ 变迁/ ./ 证明/ ./ 令/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ 是/ 一个/ 合理/ 的/ 自由选择/ 注释/ 工作/ 流网/ ,/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ 是/ 由/ 转换规则/ 处理/ 正规/ 结构/ N/ |/ X/ 得到/ 的/ 注释/ 网/ ./ 由/ 这些/ 转换规则/ 的/ 定义/ 可/ 得/ ,/ 如果/ N/ |/ X/ 是/ 除/ 简单/ 循环/ 结构/ 之外/ 的/ 正规/ 结构/ ,/ 那么/ |/ P/ ∪/ T/ |/ </ |/ P/ ∪/ T/ |/ ,/ 否则/ |/ P/ ∪/ T/ |/ >/ |/ P/ ∪/ T/ |/ ./ 由/ 引理/ 1/ 可得/ ,/ 对/ N/ 只能/ 应用/ 有限/ 多次/ FSLS/ ,/ 所以/ 在/ 对/ N/ 的/ 转换/ 过程/ 中当/ 不能/ 再/ 应用/ FSLS/ 时/ ,/ N/ 的/ 节点/ 是/ 有限/ 多/ 的/ ,/ 之后/ 应用/ 的/ 转换规则/ 总会/ 减少/ N/ 的/ 节点/ ./ 由/ 引理/ 2/ 可得/ ,/ 如果/ N/ 有/ 多个/ 变迁/ ,/ 那么/ 对/ N/ 总/ 可以/ 应用/ 转换规则/ ./ 因此/ 反复/ 应用/ 所有/ 规则/ 可以/ 将/ N/ 压缩/ 到/ 只有/ 一个/ 变迁/ ./ 证毕/ ./ 4/ 应用/ 实例/ 本/ 节/ 通过/ 一个/ 应用/ 实例/ 详细/ 地/ 展示/ PN2MSVL/ 如何/ 将/ 工作/ 流网/ 转换成/ MSVL/ 程序/ ,/ 以及/ 如何/ 使用/ Page5/ 工具/ MSV/ 对/ 生成/ 的/ MSVL/ 程序/ 进行/ 仿真/ 、/ 建模/ 和/ 验证/ ./ 4.1/ 工作/ 流网/ 到/ MSVL/ 的/ 转换/ 实例/ 图/ 1/ 中/ 的/ 工作/ 流网/ 描述/ 的/ 是/ 一个/ 投诉/ 管理系统/ 的/ 工作/ 流程/ [/ 20/ ]/ :/ 对/ 收到/ 的/ 每个/ 投诉/ ,/ 首先/ 进行/ 注册/ t0/ ,/ 然后/ 进行/ 分类/ t1/ ./ 若/ 是/ 无理/ 投诉/ ,/ 则/ 自动/ 忽略/ 该/ 投诉/ t2/ ;/ 若/ 是/ 简单/ 投诉/ ,/ 则/ 自动/ 匹配/ 处理/ 方案/ t3/ ,/ 然后/ 告知/ 管理/ 部门/ t5/ ;/ 若/ 是/ 复杂/ 投诉/ ,/ 则/ 首先/ 告知/ 被/ 投诉/ 的/ 部门/ t4/ ,/ 然后/ 同时/ 联系/ 用户/ t6/ 和/ 管理/ 部门/ t7/ ,/ 通过/ 协商/ 得出/ 处理/ 方案/ t8/ ./ 在/ 整个/ 处理过程/ 中/ ,/ 投诉者/ 随时/ 可以/ 通过/ 该/ 系统/ 查询/ 投诉/ 的/ 处理/ 进度/ t9/ 或者/ 撤销/ 投诉/ t10/ ./ 最后/ 对/ 投诉/ 进行/ 归档/ t11/ ./ 显然/ ,/ 该/ 工作/ 流网/ 是/ 一个/ 合理/ 的/ 自由选择/ 工作/ 流网/ ,/ 所以/ 可以/ 使用/ PN2MSVL/ 将/ 它/ 转换成/ MSVL/ 程序/ ./ 首先/ 使用/ 工具/ Workcraft/ 建立/ 该/ 工作/ 流网/ ,/ 并/ 保存/ 为/ 文件/ complaint/ ./ g/ ,/ 然后/ 使用/ PN2MSVL/ 转换/ 该/ 工作/ 流网/ ,/ 如图/ 2/ 所示/ ./ 所示/ ./ 中/ 对于/ 每个/ 变迁/ t/ ,/ G/ (/ t/ )/ =/ true/ ,/ L/ (/ t/ )/ =/ t/ (/ )/ ./ 流网/ 直到/ 其/ 只/ 包含/ 一个/ 变迁/ ,/ 如图/ 2/ 下方/ 所示/ ./ PN2MSVL/ 中/ 工作/ 流网/ 的/ 具体/ 的/ 转换/ 过程/ 如下/ 步骤/ 1/ ./ 将/ 该/ 工作/ 流网/ 转换成/ 注释/ 工作/ 流网/ ,/ 其/ 步骤/ 2/ ./ 反复/ 地/ 应用/ 转换规则/ 压缩/ 该/ 注释/ 工作/ 步骤/ 2/ 中/ 每个/ 转换规则/ 的/ 执行/ 细节/ 如下/ 所示/ ./ PN2MSVL/ 应用/ FSS/ 压缩/ 图/ 1/ 中/ 的/ 顺序/ 结构/ R1/ ,/ 得到/ 图/ 3/ 中/ 的/ 变迁/ d1/ ,/ 其中/ PN2MSVL/ 首先/ 应用/ FECS/ 转换/ 图/ 3/ 中/ 的/ 显示/ 选择/ 结构/ R2/ ,/ 然后/ 应用/ FSLS/ 转换/ 图/ 3/ 中/ 的/ 简单/ 循环/ 结构/ R3/ ,/ 分别/ 得到/ 图/ 4/ 中/ 的/ d2/ 和/ d3/ ,/ 其中/ G/ (/ d2/ )/ =/ G/ (/ t2/ )/ orG/ (/ d1/ )/ ,/ L/ (/ d2/ )/ =/ (/ G/ (/ t2/ )/ →/ L/ (/ t2/ )/ )/ [/ ]/ (/ G/ (/ d1/ )/ →/ L/ (/ d1/ )/ )/ ,/ G/ (/ d3/ )/ =/ true/ ,/ L/ (/ d3/ )/ =/ over3/ ·/ ·/ =/ 0/ ;/ PN2MSVL/ 首先/ 应用/ FSS/ 转换/ 图/ 4/ 中/ 的/ 顺序/ 结构/ R4/ ,/ 然后/ 应用/ FCoS/ 转换/ 图/ 4/ 中/ 的/ 并发/ 结构/ R5/ ,/ 分别/ 得到/ 图/ 5/ 中/ 的/ d4/ 和/ d5/ ,/ 其中/ PN2MSVL/ 首先/ 应用/ 两次/ FSS/ 转换/ 图/ 5/ 中/ 的/ 顺序/ 结构/ R6/ ,/ 然后/ 应用/ FECS/ 转换/ 图/ 5/ 中/ 的/ 显示/ 选择/ 结构/ R7/ ,/ 最终/ 得到/ 图/ 6/ 中/ 的/ d8/ ,/ 其中/ G/ (/ d8/ )/ =/ G/ (/ d2/ )/ orG/ (/ t4/ )/ ,/ L/ (/ d8/ )/ =/ (/ G/ (/ d2/ )/ →/ L/ (/ d2/ )/ )/ [/ ]/ Page6PN2MSVL/ 首先/ 应用/ FSS/ 转换/ 图/ 6/ 中/ 的/ 顺序/ 结构/ R8/ ,/ 然后/ 应用/ FCoS/ 转换/ 图/ 6/ 中/ 的/ 并发/ 结构/ R9/ ,/ 最终/ 得到/ 图/ 7/ 中/ 的/ d10/ ,/ 其中/ G/ (/ d10/ )/ =/ true/ ,/ L/ (/ d10/ )/ =/ (/ L/ (/ t1/ )/ ;/ L/ (/ d8/ )/ )/ ‖/ (/ L/ (/ d4/ )/ )/ ./ PN2MSVL/ 应用/ 两次/ FSS/ 转换/ 图/ 7/ ,/ 最终/ 得到/ 图/ 8/ 中/ 的/ d12/ ,/ 其中/ 步骤/ 3/ :/ PN2MSVL/ 为/ L/ (/ d12/ )/ 添加/ 初始化/ 、/ 区间/ 框架/ 和/ 过程/ 定义/ 语句/ 得到/ 最终/ 的/ MSVL/ 程序/ ,/ 如图/ 9/ 所示/ ./ 由于/ 原/ 工作/ 流网/ 的/ 结构/ 比较简单/ ,/ 所以/ 在/ 转换/ 过程/ 中/ 并未/ 使用/ 到/ 复杂/ 的/ 转换规则/ ,/ 例如/ FCLS/ 、/ FCCS/ 和/ FIS/ 等/ ,/ 使得/ 生成/ 的/ MSVL/ 程序/ 具有/ 很/ 高/ 的/ 可读性/ ./ 4.2/ 对/ MSVL/ 程序/ 进行/ 仿真/ 、/ 建模/ 和/ 验证/ 本/ 小节/ 使用/ 工具/ MSV/ 对/ 生成/ 的/ MSVL/ 程序/ 进行/ 仿真/ 、/ 建模/ 和/ 验证/ ./ MSV/ 在/ 仿真/ 模式/ 下/ 执行/ 该/ MSVL/ 程序/ ,/ 如图/ 10/ 所示/ ,/ 本次/ 执行/ 路径/ 共有/ 7/ 个/ 状态/ ./ 由/ state6/ 可知/ 本次/ 执行/ 终止/ 时/ p11/ =/ 1/ ,/ 其余/ 库所/ 对应/ 的/ 变量/ 的/ 值/ 都/ 为/ 0/ ./ 原/ 工作/ 流网/ 的/ 每次/ 完整/ 执行/ 都/ 终止/ 在/ 状态/ {/ p11/ }/ ,/ 这/ 两者/ 是/ 一致/ 的/ ./ MSV/ 在/ 建模/ 模式/ 下/ 生成/ 该/ MSVL/ 程序/ 的/ 范式/ 图/ [/ 23/ ]/ ,/ 如图/ 11/ 所示/ ./ 范式/ 图/ 使用/ 边来/ 表示/ 程序/ 的/ 状态/ ./ 图/ 12/ 展示/ 的/ 是/ 该/ 范式/ 图/ 部分/ 边/ 的/ 信息/ ./ 由图/ 11/ 可知/ 该/ MSVL/ 程序/ 的/ 每次/ 执行/ 都/ 终止/ 于边/ Edge6/ ./ 由图/ 12/ 可知/ 在/ Edge6/ 上/ p11/ =/ 1/ ,/ 其余/ 库所/ 对应/ 的/ 变量/ 的/ 值/ 都/ 为/ 0/ ./ 这/ 与/ 原/ 工作/ 流网/ 每次/ 完整/ 执行/ 都/ 终止/ 于/ 状态/ {/ p11/ }/ 也/ 是/ 一致/ 的/ ./ 图/ 11/ 建模/ 模式/ 下/ 生成/ 的/ MSVL/ 程序/ 的/ 范式/ 图足/ 两个/ 用/ 命题/ 投影/ 时序/ 逻辑/ 公式/ 描述/ 的/ 属性/ ./ MSV/ 在/ 验证/ 模式/ 下/ 验证/ 该/ MSVL/ 程序/ 是否/ 满/ 属性/ 1/ :/ 其中/ Q/ 、/ S/ 和/ U/ 分别/ 是/ p2/ =/ 1/ 、/ p3/ =/ 1/ 和/ p4/ =/ 1/ ./ 该/ 属性/ 的/ 直观/ 含义/ 是/ p2/ =/ 1/ 终将/ 会/ 成立/ ,/ 而且/ p3/ =/ 1/ 也/ 终将/ 会/ 成立/ ,/ 这/ 两者/ 都/ 成立/ 之后/ p4/ =/ 1/ 终将/ 会/ 成立/ ./ Page7/ 验证/ 结果/ 如图/ 13/ 左侧/ 所示/ ./ 属性/ 2/ :/ 其中/ V/ 和/ W/ 分别/ 是/ p5/ =/ 1/ 和/ p8/ =/ 1/ ./ 该/ 属性/ 的/ 直观/ 含义/ 是/ p5/ =/ 1/ 终将/ 会/ 成立/ ,/ 而且/ p8/ =/ 1/ 也/ 终将/ 会/ 成立/ ./ 验证/ 结果/ 如图/ 13/ 右侧/ 所示/ ./ 图/ 13/ 验证/ 模式/ 下/ 的/ 两种/ 不同/ 属性/ 的/ 验证/ 结果/ 5/ 实验/ 与/ 分析/ 本/ 节/ 通过/ 实验/ 分析/ PN2MSVL/ 中/ 每个/ 规则/ 的/ 使用/ 频率/ 和/ 对/ MSVL/ 程序/ 可读性/ 的/ 影响/ ./ 首先/ 让/ 不/ 了解/ PN2MSVL/ 的/ 学生/ 构造/ 了/ 100/ 个/ 合理/ 的/ 自由选择/ 工作/ 流网/ ,/ 然后/ 使用/ PN2MSVL/ 依次/ 转换/ 这些/ 模型/ ./ 为了/ 分析/ 每个/ 规则/ 的/ 使用/ 频率/ ,/ 只/ 需/ 统计/ 转换/ 过程/ 中/ 每个/ 规则/ 的/ 总/ 使用/ 次数/ ./ 为了/ 分析/ 每个/ 规则/ 对/ MSVL/ 程序/ 可读性/ 的/ 影响/ ,/ 首先/ 要/ 量化/ 可读性/ 这一/ 概念/ ./ PN2MSVL/ 生成/ 的/ MSVL/ 程序/ 中/ 含有/ 两类/ 变量/ :/ 一类/ 是/ 为/ 每个/ 库所/ p/ 添加/ 的/ 变量/ p/ ,/ 该/ 变量/ 只/ 由/ 其/ 输入/ 和/ 输出/ 变迁/ t/ ∈/ ·/ p/ ∪/ p/ ·/ 对应/ 的/ 过程/ t/ (/ )/ 进行/ 操作/ ;/ 另一类/ 是/ 由/ 转换规则/ 添加/ 的/ 辅助/ 变量/ ,/ 这/ 类/ 变量/ 用于/ 控制程序/ 的/ 执行/ ./ 观察/ PN2MSVL/ 生成/ 的/ MSVL/ 程序/ 容易/ 发现/ 辅助/ 变量/ 越/ 多/ ,/ 程序/ 的/ 可读性/ 通常/ 就/ 越/ 低/ ,/ 因此/ 可以/ 通过/ 统计/ 每个/ 规则/ 添加/ 的/ 辅助/ 变量/ 的/ 总数/ 来/ 分析/ 它/ 对/ MS/ -/ VL/ 程序/ 可读性/ 的/ 影响/ ./ 图/ 14/ 展示/ 了/ 转换/ 这/ 100/ 个/ 模型/ 的/ 过程/ 中/ 每个/ 转换规则/ 的/ 总/ 使用/ 次数/ 和/ 每个/ 转换规则/ 添加/ 的/ 辅助/ 变量/ 的/ 总数/ ./ 由/ 转换规则/ 的/ 定义/ 可知/ ,/ 删除/ 冗余/ 库所/ 规则/ 、/ 合并/ 顺序/ 结构/ 规则/ 和/ 合并/ 显示/ 选择/ 结构/ 规则/ 都/ 不/ 添加/ 辅助/ 变量/ ./ 合并/ 简单/ 循环/ 结构/ 规则/ 每次/ 添加/ 一个/ 辅助/ 变量/ ./ 合并/ 复杂/ 循环/ 结构/ 规则/ 和/ 合并/ 复杂/ 选择/ 结构/ 规则/ 每次/ 添加/ 两个/ 辅助/ 变量/ ./ 合并/ 并发/ 结构/ 规则/ 和/ 合并/ 不规则/ 结构/ 规则/ 每次/ 添加/ 的/ 辅助/ 变量/ 的/ 个数/ 由/ 被/ 处理/ 结构/ 的/ 复杂/ 情况/ 而定/ ./ 图/ 14/ 中/ 所示/ 的/ 实验/ 结果/ 与/ 上述/ 分析/ 完全一致/ ./ 除此之外/ ,/ 由图/ 14/ 可见/ 使用/ 频率/ 最高/ 的/ 规则/ 是/ 合并/ 顺序/ 结构/ 规则/ ,/ 该/ 规则/ 的/ 使用/ 次数/ 占/ 到/ 所有/ 规则/ 的/ 使用/ 次数/ 的/ 55.0/ %/ ./ 添加/ 辅助/ 变量/ 最多/ 的/ 规则/ 是/ 合并/ 不规则/ 结构/ 规则/ ,/ 由/ 其/ 添加/ 的/ 辅助/ 变量/ 占/ 所有/ 辅助/ 变量/ 的/ 64.3/ %/ ,/ 因此/ 该/ 规则/ 对/ MSVL/ 程序/ 可读性/ 的/ 影响/ 最/ 严重/ ./ 幸运/ 的/ 是/ 该/ 规则/ 的/ 使用/ 频率/ 较/ 低/ ,/ 占/ 到/ 所有/ 规则/ 的/ 使用/ 次数/ 的/ 5.8/ %/ ./ 由此可知/ ,/ 为了/ 提高/ MSVL/ 程序/ 的/ 可读性/ ,/ 应该/ 提出/ 添加/ 更/ 少/ 辅助/ 变量/ 的/ 转换规则/ ,/ 从而/ 降低/ 合并/ 不规则/ 结构/ 规则/ 的/ 使用/ 频率/ 并且/ 减少/ 添加/ 辅助/ 变量/ 的/ 个数/ ./ 另外/ 由图/ 14/ 可见/ 合并/ 复杂/ 循环/ 结构/ 规则/ 的/ 总/ 使用/ 次数/ 明显/ 高于/ 合并/ 复杂/ 选择/ 结构/ 规则/ 的/ 总/ 使用/ 次数/ ./ 这/ 是因为/ 合并/ 复杂/ 循环/ 结构/ 规则/ 的/ 优先级/ 比/ 合并/ 复杂/ 选择/ 结构/ 规则/ 的/ 优先级/ 高/ ,/ 而且/ 有时/ 合并/ 复杂/ 循环/ 结构/ 规则/ 会/ 间接/ 地/ 消除/ 掉/ 一些/ 复杂/ 选择/ 结构/ ./ 例如/ ,/ 在/ 图/ 15/ 所示/ 的/ 注释/ 工作/ 流网/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ 中/ ,/ 虚线/ 矩形/ R1/ 中有/ 一个/ 复杂/ 循环/ 结构/ ,/ 虚线/ 矩形/ R2/ 中有/ 一个/ 复杂/ 选择/ 结构/ ./ PN2MSVL/ 优先/ 应用/ 合并/ 复杂/ 循环/ 结构/ 规则/ 处理/ R1/ 中/ 的/ 循环/ 结构/ ,/ 得到/ 如图/ 16/ 所示/ 的/ 注释/ 网/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ ,/ 其中/ L/ (/ t0/ )/ =/ L/ (/ t0/ )/ ;/ LPNext1/ ·/ ·/ =/ “/ p0/ ”/ ,/ G/ (/ t5/ )/ =/ G/ (/ t5/ )/ andLPOut1/ =/ “/ p2/ ”/ ,/ L/ (/ t5/ )/ =/ LPOut1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t5/ )/ ,/ G/ (/ t4/ )/ =/ G/ (/ t4/ )/ andLPOut1/ =/ “/ p1/ ”/ ,/ L/ (/ t4/ )/ =/ LPOut1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t4/ )/ ,/ G/ (/ d1/ )/ =/ true/ ,/ L/ (/ d1/ )/ =/ while/ (/ / (/ LPNext1/ =/ “/ NULL/ ”/ )/ )/ {/ if/ (/ LPNext1/ =/ “/ p0/ ”/ )/ then/ {/ LPNext1/ ·/ ·/ =/ “/ p0/ ”/ ;/ L/ (/ t1/ )/ ;/ (/ G/ (/ t4/ )/ →/ {/ LPNext1/ ·/ ·/ =/ “/ NULL/ ”/ andLPOut1/ ·/ ·/ =/ “/ p1/ ”/ }/ )/ [/ ]/ (/ G/ (/ t2/ )/ →/ {/ L/ (/ t2/ )/ ;/ (/ G/ (/ t5/ )/ →/ LPNext1/ ·/ ·/ =/ “/ NULL/ ”/ andLPOut1/ ·/ ·/ =/ “/ p2/ ”/ )/ [/ ]/ (/ G/ (/ t3/ )/ →/ L/ (/ t3/ )/ )/ }/ )/ }/ }/ Page8/ 对比/ 图/ 15/ 和/ 图/ 16/ 可见/ ,/ 合并/ 复杂/ 循环/ 结构/ 规则/ 间接/ 地/ 消除/ 了/ 图/ 15/ 中/ 的/ 复杂/ 选择/ 结构/ ,/ 并/ 在/ 图/ 16/ 中/ 的/ 虚线/ 矩形/ R3/ 中/ 添加/ 了/ 一个/ 显示/ 选择/ 结构/ ./ 另外/ ,/ 合并/ 复杂/ 选择/ 结构/ 规则/ 有时/ 会/ 引入/ “/ 虚假/ ”/ 复杂/ 循环/ 结构/ ./ 例如/ ,/ 在/ 图/ 17/ 所示/ 的/ 注释/ 工作/ 流网/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ 中/ ,/ 虚线/ 矩形/ R1/ 中有/ 一个/ 复杂/ 选择/ 结构/ ./ PN2MSVL/ 应用/ 合并/ 复杂/ 选择/ 结构/ 规则/ 转换/ 该/ 结构/ ,/ 得到/ 如图/ 18/ 所示/ 的/ 注释/ 网/ N/ =/ (/ P/ ,/ T/ ,/ F/ ,/ G/ ,/ L/ )/ ,/ 其中/ L/ (/ t0/ )/ =/ L/ (/ t0/ )/ ;/ CCNext1/ ·/ ·/ =/ “/ p0/ ”/ ,/ G/ (/ t5/ )/ =/ G/ (/ t5/ )/ andCCOut1/ =/ “/ p2/ ”/ ,/ L/ (/ t5/ )/ =/ CCOut1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t5/ )/ ;/ CCNext1/ ·/ ·/ =/ “/ p1/ ”/ ,/ G/ (/ t6/ )/ =/ G/ (/ t6/ )/ andCCOut1/ =/ “/ p3/ ”/ ,/ L/ (/ t6/ )/ =/ CCOut1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t6/ )/ ,/ G/ (/ d1/ )/ =/ true/ ,/ L/ (/ d1/ )/ =/ (/ CCNext1/ =/ “/ p0/ ”/ andG/ (/ t1/ )/ orCCNext1/ =/ “/ p1/ ”/ →/ {/ if/ (/ CCNext1/ =/ “/ p0/ ”/ )/ then/ {/ CCNext1/ ·/ ·/ =/ “/ p1/ ”/ ;/ L/ (/ t1/ )/ }/ if/ (/ CCNext1/ =/ “/ p1/ ”/ )/ then/ {/ CCNext1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t2/ )/ ;/ CCNext1/ ·/ ·/ =/ “/ NULL/ ”/ andCCOut1/ ·/ ·/ =/ “/ p3/ ”/ }/ }/ )/ [/ ]/ (/ CCNext1/ =/ “/ p0/ ”/ andG/ (/ t3/ )/ →/ {/ if/ (/ CCNext1/ =/ “/ p0/ ”/ )/ then/ {/ CCNext1/ ·/ ·/ =/ “/ NULL/ ”/ ;/ L/ (/ t3/ )/ ;/ (/ G/ (/ t5/ )/ →/ {/ CCNext1/ ·/ ·/ =/ “/ NULL/ ”/ andCCOut1/ ·/ ·/ =/ “/ p2/ ”/ }/ )/ [/ ]/ (/ G/ (/ t4/ )/ →/ {/ L/ (/ t4/ )/ ;/ CCNext1/ ·/ ·/ =/ “/ NULL/ ”/ andCCOut1/ ·/ ·/ =/ “/ p3/ ”/ }/ )/ }/ }/ )/ 对比/ 图/ 17/ 和/ 图/ 18/ 可见/ ,/ 合并/ 复杂/ 选择/ 结构/ 规则/ 在/ 图/ 18/ 中/ 的/ 虚线/ 矩形/ R2/ 中/ 添加/ 了/ 一个/ 复杂/ 循环/ 结构/ ./ 该/ 结构/ 最终/ 会/ 被/ 合并/ 复杂/ 循环/ 结构/ 规则/ 转换/ ,/ 并且/ 在/ 生成/ 的/ MSVL/ 程序/ 中会/ 有/ 一个/ 对应/ 的/ 循环/ 语句/ ,/ 但是/ 该/ 循环/ 语句/ 不会/ 真正/ 地/ 循环/ 执行/ ./ 6/ 相关/ 工作/ 本节/ 对/ PN2MSVL/ 的/ 转换规则/ 和/ 现有/ 结构化/ 转换方法/ 的/ 转换规则/ 做/ 详细/ 对比/ ./ 这是/ 第一次/ 将/ 删除/ 冗余/ 库所/ 规则/ 应用/ 到/ 工作/ 流网/ 到/ 程序设计/ 语言/ 的/ 结构化/ 转换/ 中/ ./ 该/ 规则/ 在/ 不/ 影响/ 模型/ 控制流/ 的/ 前提/ 下/ 通过/ 删除/ 冗余/ 库所/ 对模型/ 的/ 结构/ 进行/ 简化/ ./ 通常/ 模型/ 的/ 结构/ 越/ 简单/ ,/ 生成/ 的/ MSVL/ 程序/ 的/ 可读性/ 就/ 越/ 高/ ./ 例如/ ,/ 图/ 19/ 中/ 存在/ 一个/ 冗余/ 库所/ 结构/ N/ |/ X/ ,/ 其中/ P/ |/ X/ =/ {/ p2/ ,/ p3/ }/ ./ 如果/ 应用/ 删除/ 冗余/ 库所/ 规则/ ,/ 那么/ 会/ 得到/ 图/ 20/ 所示/ 的/ 模型/ ,/ 显然/ 该/ 模型/ 的/ 结构/ 更/ 简单/ ./ 进一步/ 应用/ 合并/ 复杂/ 循环/ 结构/ 规则/ 转换/ 图/ 20/ 中/ 的/ 复杂/ 循环/ 结构/ ,/ 最终/ 生成/ 的/ MSVL/ 程序/ 中/ 只有/ 2/ 个/ 辅助/ 变量/ ./ 如果/ 没有/ 删除/ 冗余/ 库所/ 规则/ ,/ 那么/ 就/ 只能/ 应用/ 合并/ 不规则/ 结构/ 规则/ 处理/ 虚线/ 矩形/ R1/ 中/ 的/ 不规则/ 结构/ ,/ 最终/ 生成/ 的/ MSVL/ 程序/ 中有/ 4/ 个/ 辅助/ 变量/ ./ 合并/ 顺序/ 结构/ 规则/ 是/ 最/ 普遍/ 的/ 转换规则/ ,/ PN2MSVL/ 定义/ 的/ 顺序/ 结构/ 由/ 两个/ 变迁/ 和/ 一个/ 库所/ 构成/ ./ 虽然/ 现有/ 结构化/ 转换方法/ 定义/ 的/ 顺序/ 结构/ 一般/ 可以/ 包含/ 更/ 多/ 的/ 变迁/ ,/ 但是/ PN2MSVL/ 可以/ 通过/ Page9/ 多次/ 执行/ 合并/ 顺序/ 结构/ 规则/ 从而/ 达到/ 相同/ 的/ 效果/ ./ 而且/ PN2MSVL/ 的/ 合并/ 顺序/ 结构/ 规则/ 更/ 容易/ 实现/ ./ 合并/ 显示/ 选择/ 结构/ 规则/ 和/ 合并/ 简单/ 循环/ 结构/ 规则/ 也/ 是/ 较为/ 普遍/ 的/ 转换规则/ ./ PN2MSVL/ 尽可能/ 地/ 放松/ 了/ 这/ 两个/ 转换规则/ 的/ 应用/ 条件/ ./ 现有/ 的/ 结构化/ 转换方法/ 中/ 的/ 类似/ 转换规则/ 通常/ 有/ 一些/ 不必要/ 的/ 限制/ ./ 例如/ vanderAalst/ 等/ 人/ [/ 5/ ]/ 和/ Lassen/ 等/ 人/ [/ 8/ ]/ 都/ 要求/ 选择/ 结构/ 中/ 的/ 所有/ 变迁/ 和/ 循环/ 结构/ 中/ 循环/ 执行/ 的/ 变迁/ 都/ 只能/ 有/ 一个/ 输入/ 库所/ 和/ 一个/ 输出/ 库所/ ./ 他们/ 的/ 方法/ 无法/ 转换/ 图/ 21/ 中/ 的/ 显示/ 选择/ 结构/ 和/ 图/ 22/ 中/ 的/ 简单/ 循环/ 结构/ ./ 由此可见/ PN2MSVL/ 的/ 这/ 两个/ 规则/ 有/ 更/ 广/ 的/ 应用/ 范围/ ./ 这/ 可以/ 降低/ 合并/ 不规则/ 结构/ 规则/ 的/ 使用/ 频率/ ,/ 提高/ 生成/ 的/ MSVL/ 程序/ 的/ 可读性/ ./ 合并/ 复杂/ 循环/ 结构/ 规则/ 和/ 合并/ 复杂/ 选择/ 结构/ 规则/ 都/ 将/ 被/ 处理/ 的/ 结构/ 直接/ 合并/ 成/ 一个/ 新/ 变迁/ ./ 但是/ 对于/ 复杂/ 循环/ 结构/ 和/ 复杂/ 选择/ 结构/ ,/ 现有/ 结构化/ 转换方法/ 很难/ 如此/ 处理/ ./ 例如/ 对于/ 复杂/ 循环/ 结构/ Kleine/ 等/ 人/ [/ 9/ ]/ 会先/ 将/ 其/ 展开/ 成不含/ 循环/ 的/ 结构/ 然后/ 再/ 进行/ 处理/ ./ 这种/ 操作/ 会/ 引入/ 更/ 多/ 新/ 变迁/ ,/ 而且/ 在/ 这些/ 新/ 变迁/ 上/ 有/ 很多/ 重复/ 的/ 语句/ 注释/ ,/ 从而/ 使得/ 最终/ 生成/ 的/ 程序/ 不仅/ 规模/ 庞大/ 而且/ 可读性/ 差/ ./ 现有/ 结构化/ 转换方法/ 中/ 转换/ 并发/ 结构/ 和/ 不规则/ 结构/ 的/ 规则/ 都/ 很/ 难/ 扩展/ 到/ 其他/ 程序设计/ 语言/ ./ 例如/ vanderAalst/ 等/ 人/ [/ 5/ ]/ 和/ Kleine/ 等/ 人/ [/ 9/ ]/ 在/ 将/ 工作/ 流网/ 转换/ 到/ BPEL/ 时/ 直接/ 使用/ flow/ 语句/ 来/ 转换/ 并发/ 结构/ 和/ 一些/ 不/ 含/ 循环/ 的/ 不规则/ 结构/ ./ Lassen/ 等/ 人/ [/ 8/ ]/ 在/ 将/ 有色/ 控制/ 流网/ 转换/ 到/ Java/ 时/ 使用/ 了/ 很多/ Java/ 现有/ 的/ 方法/ (/ 例如/ getState/ 和/ join/ 等/ )/ 来/ 转换/ 并发/ 结构/ ./ 而/ PN2MSVL/ 在/ 转换/ 这/ 两类/ 结构/ 时/ 使用/ 的/ 大都/ 是/ 常用/ 的/ 程序设计/ 语句/ ./ 另外/ PN2MSVL/ 的/ 合并/ 不规则/ 结构/ 规则/ 可以/ 处理/ 合理/ 的/ 自由选择/ 工作/ 流网/ 中/ 所有/ 的/ 最小/ 不规则/ 结构/ ,/ 然而/ vanderAalst/ 等/ 人/ [/ 5/ ]/ 和/ Lassen/ 等/ 人/ [/ 8/ ]/ 有时/ 需要/ 引入/ 人工/ 转换/ ./ 7/ 结论/ 和/ 展望/ 本文/ 介绍/ 了/ 一个/ 工作/ 流网/ 到/ MSVL/ 的/ 结构化/ 转换方法/ 和/ 支持/ 工具/ PN2MSVL/ ./ 相比/ 现有/ 的/ 结构化/ 转换方法/ ,/ PN2MSVL/ 生成/ 的/ MSVL/ 程序/ 不仅/ 具有/ 更/ 高/ 的/ 可读性/ ,/ 而且/ 可以/ 进行/ 仿真/ 、/ 建模/ 和/ 验证/ ./ 在/ 今后/ 的/ 工作/ 中/ ,/ 我们/ 将会/ 提出/ 引入/ 更/ 少/ 辅助/ 变量/ 的/ 转换规则/ ,/ 从而/ 进一步提高/ 生成/ 的/ MSVL/ 程序/ 的/ 可读性/ ./ 

