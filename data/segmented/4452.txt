Page1/ 基于/ 串/ 空间/ 的/ 可信计算/ 协议/ 分析/ 1/ )/ (/ 中国科学院/ 软件/ 研究所/ 可信计算/ 与/ 信息/ 保障/ 实验室/ 北京/ 100190/ )/ 冯伟/ 1/ )/ ,/ 2/ )/ 冯登国/ 1/ )/ 2/ )/ (/ 中国科学院/ 大学/ 北京/ 100190/ )/ 摘要/ 可信计算/ 技术/ 能为/ 终端/ 、/ 网络/ 以及/ 云/ 计算/ 平台/ 等/ 环境/ 提供/ 安全/ 支撑/ ,/ 其/ 本身/ 的/ 安全/ 机制/ 或者/ 协议/ 应该/ 得到/ 严格/ 的/ 形式化/ 证明/ ./ 该文/ 基于/ 串/ 空间/ 模型/ 对/ 其/ 远程/ 证明/ 协议/ 进行/ 了/ 分析/ ./ 首先/ ,/ 扩展/ 了/ 串/ 空间/ 的/ 消息/ 代数和/ 攻击者/ 串/ ,/ 使/ 其能/ 表达/ 可信计算/ 相关/ 的/ 密码学/ 操作/ ,/ 并/ 对/ 衍生/ 的/ 定理/ 进行/ 了/ 证明/ ;/ 并且/ 提出/ 了/ 4/ 个/ 新/ 的/ 认证/ 测试/ 准则/ ,/ 能/ 对/ 协议/ 中/ 的/ 加密/ 、/ 签名/ 、/ 身份/ 生成/ 和/ 哈希/ 等/ 组件/ 进行/ 推理/ ./ 其次/ ,/ 基于/ 扩展/ 的/ 串/ 空间/ 模型/ 对/ 远程/ 证明/ 协议/ 的/ 安全/ 属性/ (/ 隐私/ 性/ 、/ 机密性/ 和/ 认证/ 性/ )/ 进行/ 了/ 抽象/ 和/ 分析/ ./ 最后/ ,/ 给出/ 了/ 对/ 发现/ 攻击/ 的/ 消息/ 流程/ ,/ 并/ 基于/ ARM/ 开发板/ 对/ 其中/ 的/ 布谷鸟/ 攻击/ 进行/ 了/ 实现/ ,/ 验证/ 了/ 串/ 空间/ 的/ 分析/ 结果/ ./ 关键词/ 可信计算/ ;/ 远程/ 证明/ ;/ 串/ 空间/ ;/ 认证/ 测试/ ;/ 形式化/ 验证/ 1/ 引言/ 随着/ 信息化/ 技术/ 的/ 发展/ ,/ 网络/ 变成/ 了/ 人们/ 生活/ Page2/ 据/ 的/ 分发/ 与/ 共享/ (/ 如/ ftp/ 资源/ )/ ;/ 云/ 计算环境/ 通过/ 网络/ 能为/ 用户/ 提供/ 各种/ 安全/ 服务/ ,/ 如云/ 存储/ 和/ 云/ 租用/ 平台/ 等/ ./ 这些/ 安全/ 操作/ 通常/ 涉及/ 对/ 敏感数据/ 的/ 处理/ ,/ 如/ 用户/ 的/ 支付/ 账号/ 和/ 密码/ ,/ 公司/ 的/ 机密/ 文档/ 和/ 云/ 隐私/ 数据/ 等/ ./ 但是/ ,/ 由于/ 网络/ 环境/ 的/ 开放性/ 和/ 复杂性/ ,/ 使得/ 其/ 容易/ 变成/ 攻击者/ 的/ 目标/ :/ 通过/ 远程/ 注入/ 恶意软件/ ,/ 攻击者/ 可以/ 在/ 网上交易/ 时/ 截获/ 用户/ 的/ 支付/ 账号/ 和/ 密码/ ;/ 恶意/ 的/ 终端/ 可能/ 连接/ 公司/ 内部/ 网络/ ,/ 获取/ 机密信息/ ;/ 客户/ 存储/ 在/ 云中/ 的/ 数据/ 可能/ 面临/ 机密性/ 和/ 完整性/ 等/ 威胁/ ./ 如果/ 在/ 安全/ 操作/ 执行/ 之前/ ,/ 网络/ 中/ 的/ 各个/ 实体/ 能/ 相互/ 验证/ 平台/ 身份/ 和/ 平台/ 软件/ 配置/ 等/ 信息/ ,/ 能/ 有效/ 防止/ 攻击/ 的/ 发生/ ./ 可信计算/ 技术/ 提出/ 的/ 可信/ 平台/ 模块/ TPM/ (/ TrustedPlatformModule/ )/ [/ 1/ ]/ 和/ 远程/ 证明/ 协议/ ①/ ,/ 能为/ 网络/ 实体/ 提供/ 基于/ 硬件/ 的/ 可信/ 证据/ ,/ 保证/ 只有/ 拥有/ 合法/ 身份/ 并/ 运行/ 着/ 预期/ 软件/ 的/ 实体/ 才能/ 通过/ 验证/ ./ 因此/ ,/ 远程/ 证明/ 协议/ 可以/ 用于/ 构建/ 安全/ 支付/ 、/ 可信/ 网络/ 接入/ [/ 2/ ]/ 和/ 可信/ 云/ 服务/ [/ 3/ ]/ 等/ 安全/ 系统/ ,/ 防止/ 机密信息/ 和/ 数据/ 的/ 泄露/ ./ 安全/ 支付/ 中/ ,/ 远程/ 证明/ 协议/ 可以/ 向/ 金融机构/ 证明/ 用户/ 终端/ 的/ 软件/ 配置/ ,/ 防止/ 恶意软件/ 截获/ 支付/ 信息/ ;/ 可信/ 网络/ 接入/ [/ 2/ ]/ 系统/ 通过/ 远程/ 证明/ 协议/ 验证/ 接入/ 的/ 终端设备/ ,/ 只/ 允许/ 合法/ 的/ 终端/ 连接/ 网络/ ,/ 可以/ 有效/ 保护/ 内部/ 网络资源/ ;/ 在/ 可信/ 云/ 服务/ [/ 3/ ]/ 系统/ 中/ ,/ 客户/ 在/ 上传/ 数据/ 之前/ ,/ 先/ 使用/ 远程/ 证明/ 协议/ 验证/ 云/ 节点/ 的/ 身份/ 和/ 完整性/ 状态/ ,/ 可以/ 保证数据/ 只/ 存储/ 在/ 可信/ 的/ 云/ 节点/ 中/ ./ 由此可见/ ,/ 远程/ 证明/ 协议/ 的/ 应用/ 很/ 广泛/ ,/ 并/ 对/ 很多/ 系统/ 的/ 安全性/ 起/ 关键作用/ ./ 但是/ ,/ 目前/ 远程/ 证明/ 协议/ 并/ 没有/ 得到/ 严格/ 的/ 形式化/ 证明/ ./ 如果/ 协议/ 本身/ 存在/ 安全隐患/ ,/ 将会/ 严重威胁/ 依赖/ 该/ 协议/ 的/ 安全/ 系统/ ./ Coker/ 在/ 文献/ [/ 4/ ]/ 中/ 指出/ 了/ 远程/ 证明/ 协议/ 在/ 灵活性/ 方面/ 的/ 不足/ ,/ 提出/ 了/ 5/ 条/ 认证/ 准则/ ,/ 并/ 依此/ 设计/ 了/ 一个/ 灵活/ 的/ 认证/ 体系/ ;/ 在/ 文献/ [/ 5/ ]/ 中/ 进一步/ 基于/ 提出/ 的/ 认证/ 体系/ 设计/ 了/ 一个/ 新/ 的/ 远程/ 证明/ 协议/ ,/ 称为/ CAVES/ 协议/ ./ 文献/ [/ 6/ ]/ 对/ CAVES/ 协议/ 进行/ 了/ 形式化/ 分析/ ,/ 基于/ 串/ 空间/ CPSA/ 自动化/ 工具/ [/ 7/ -/ 8/ ]/ 证明/ 了/ 协议/ 的/ 安全性/ ./ 但是/ ,/ CAVES/ 协议/ 及其/ 分析/ 存在/ 如下/ 几个/ 问题/ :/ (/ 1/ )/ 没有/ 考虑/ 远程/ 证明/ 协议/ 的/ 平台/ 身份/ 密钥建立/ 过程/ 以及/ 可信/ 平台/ 证书/ 的/ 关联性/ ,/ 遗漏/ 了/ 对/ 隐私/ 性/ 的/ 分析/ ;/ (/ 2/ )/ 没有/ 将/ 安全/ 芯片/ TPM/ 独立/ 成/ 一个/ 角色/ 进行/ 分析/ ,/ 容易/ 忽视/ 针对/ TPM/ 本身/ 的/ 攻击/ ;/ (/ 3/ )/ CPSA/ 工具/ 无法/ 对/ 远程/ 证明/ 协议/ 依赖/ 的/ 一些/ TPM/ 命令/ 进行/ 分析/ ,/ 如/ TPM/ _/ Makeidentity/ 身份/ 密钥/ 生成/ 、/ TPM/ _/ Extend/ 完整性/ 扩展/ 和/ TPM/ _/ Quote/ 引证/ 等/ 操作/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 对/ 安全/ 芯片/ 和/ 证明/ 者/ 进行/ 了/ 区分/ ,/ 总结/ 了/ 一个/ 完整/ 的/ 远程/ 证明/ 协议/ ,/ 包含/ 平台/ 身份/ 密钥建立/ 和/ 平台/ 证明/ 两个/ 过程/ ;/ 并/ 对/ 串/ 空间/ 理论/ 和/ 认证/ 测试方法/ 进行/ 了/ 扩展/ ,/ 使得/ 其能/ 描述/ 安全/ 芯片/ 及其/ 命令/ ./ 本文/ 的/ 具体/ 贡献/ 如下/ :/ (/ 1/ )/ 根据/ 可信计算/ 规范/ ,/ 本文/ 对/ 远程/ 证明/ 协议/ 进行/ 了/ 完整/ 的/ 总结/ ,/ 通过/ 消息/ 流/ 的/ 形式/ 给出/ 了/ 协议/ 交互/ 流程/ ,/ 方便/ 对/ 协议/ 进行/ 分析/ ;/ 并/ 根据/ 对/ TPM/ 命令/ 接口/ [/ 1/ ]/ 的/ 理解/ ,/ 用/ 密码/ 原语/ 对/ 协议/ 中/ 的/ TPM/ 命令/ 进行/ 了/ 抽象/ 描述/ ./ (/ 2/ )/ 对串/ 空间/ 的/ 消息/ 代数和/ 攻击者/ 能力/ 进行/ 了/ 扩展/ ,/ 证明/ 了/ 扩展/ 模型/ 范式/ 引理/ 的/ 正确性/ ,/ 并/ 基于/ 扩展/ 模型/ 给出/ 了/ 远程/ 证明/ 协议/ 的/ 串/ 空间/ 定义/ ;/ 提出/ 了/ 4/ 个/ 认证/ 测试/ 准则/ ,/ 能/ 对/ 远程/ 证明/ 协议/ 中/ 的/ 加密/ 、/ 签名/ 、/ 身份/ 生成/ 和/ 哈希/ 等/ 组件/ 进行/ 推理/ 分析/ ./ (/ 3/ )/ 根据/ 串/ 空间/ 扩展/ 模型/ 对/ 远程/ 证明/ 协议/ 的/ 安全/ 属性/ 进行/ 了/ 定义/ ,/ 并/ 基于/ 认证/ 测试/ 准则/ 逐一/ 分析/ 了/ 这些/ 安全/ 属性/ ;/ 通过/ 分析/ 发现/ 了/ 一些/ 攻击/ ,/ 并/ 针对/ 攻击/ 提出/ 了/ 改进/ 方法/ ;/ 最后/ 基于/ 扩展/ 模型/ 给出/ 了/ 对/ 改进/ 方法/ 的/ 正确性/ 说明/ ./ (/ 4/ )/ 对/ 发现/ 的/ 攻击/ 进行/ 了/ 详细/ 的/ 描述/ ,/ 并/ 基于/ ARM/ 开发板/ 对/ 其中/ 的/ 布谷鸟/ 攻击/ 进行/ 了/ 实现/ ,/ 从/ 实验/ 上/ 验证/ 了/ 串/ 空间/ 的/ 分析/ 结果/ ./ 本文/ 第/ 2/ 节/ 给出/ 可信计算/ 和/ 串/ 空间/ 方面/ 的/ 背景/ 知识/ 以及/ 相关/ 研究成果/ ;/ 第/ 3/ 节对/ 远程/ 证明/ 协议/ 进行/ 总结/ ,/ 抽象/ 协议/ 交互/ 流程/ ,/ 并/ 提炼/ 安全/ 目标/ ;/ 第/ 4/ 节/ 针对/ 远程/ 证明/ 协议/ ,/ 给出/ 扩展/ 的/ 串/ 空间/ 理论/ 和/ 新/ 的/ 认证/ 测试方法/ ,/ 使得/ 串/ 空间/ 模型/ 能/ 描述/ 安全/ 芯片/ 的/ 密码学/ 操作/ ;/ 第/ 5/ 节/ 基于/ 扩展/ 的/ 串/ 空间/ 模型/ 对/ 远程/ 证明/ 协议/ 进行/ 分析/ ;/ 第/ 6/ 节/ 详细描述/ 发现/ 的/ 攻击/ ,/ 并/ 给出/ 攻击/ 实验/ ./ 2/ 背景/ 和/ 相关/ 工作/ 2.1/ 可信计算/ 可信计算/ 技术/ [/ 9/ ]/ 通过/ 在/ 计算/ 平台/ 引入/ 硬件安全/ 芯片/ 来/ 保证/ 计算机/ 甚至/ 网络/ 环境/ 的/ 可信/ ./ 这种/ 可信/ 是/ 指/ 计算机/ 平台/ 拥有/ 合法/ 的/ 身份/ ,/ 并/ 按照/ 预期/ 的/ 软件/ 配置/ 执行/ ./ 国际/ 上/ ,/ 安全/ 芯片/ 以/ 满足/ TCG/ (/ TrustedComputingGroup/ )/ 规范/ 的/ 可信/ 平台/ 模块/ TPM/ [/ 1/ ]/ 为/ ①/ TCGspecificationarchitectureoverview/ ,/ revision1/ ./ 4/ ,/ Page3/ 主/ ,/ 目前/ 该/ 规范/ 已经/ 升级/ 到/ TPM2/ ./ 0/ ①/ ./ 国内安全/ 芯片/ 以/ 满足/ 国家/ 密码/ 管理局/ 规范/ 的/ 可信/ 密码/ 模块/ TCM/ ②/ (/ TrustedCryptographyModule/ )/ 为主/ ,/ 其/ 采用/ 我国/ 自主/ 知识产权/ 的/ 密码/ 算法/ (/ 如/ SM2/ 、/ SM3/ 、/ SMS4/ 等/ )/ ,/ 并/ 使用/ 兼容/ 我国/ 公钥/ 基础设施/ 的/ 双/ 证书/ 体系/ ./ 远程/ 证明/ 协议/ 是/ 可信计算/ 的/ 核心技术/ 之一/ ,/ 其/ 主要/ 作用/ 是/ 允许/ 计算机/ 平台/ 创建/ 关于/ 其/ 身份/ 和/ 完整性/ 状态/ 的/ 报告/ ,/ 该/ 报告/ 基于/ 安全/ 芯片/ 生成/ ,/ 能/ 被/ 远程/ 方所/ 信赖/ ./ 平台/ 身份/ 由/ 安全/ 芯片/ 保护/ 的/ 密钥/ 提供/ ,/ 而/ 完整性/ 状态/ 指对/ 所有/ 可执行程序/ 或者/ 软件/ 进行/ 密码/ 操作/ 后/ 的/ 度量/ 值/ ./ 远程/ 证明/ 协议/ 又/ 称为/ 完整性/ 报告/ (/ IntegrityReporting/ )/ 协议/ ,/ TCG/ 规则/ 中/ 流程/ 主要/ 侧重/ 平台/ 完整性/ 的/ 报告/ ,/ 而/ 忽视/ 了/ 平台/ 身份/ 密钥/ AIK/ (/ AttestationIdentityKey/ )/ 的/ 生成/ ./ 不过/ ,/ 文献/ [/ 10/ ]/ 的/ 图/ 2/ 和/ 文献/ [/ 11/ ]/ 的/ 图/ 5/ 分别/ 给出/ 了/ 平台/ 身份/ 密钥/ AIK/ 的/ 创建/ 流程/ 和/ 具体/ TPM/ 命令/ 调用/ 情况/ ./ 本文/ 依据/ 这些/ 文献/ ,/ 对/ 远程/ 证明/ 协议/ 的/ 完整/ 流程/ 和/ 密码/ 细节/ 进行/ 了/ 总结/ ./ 可信计算/ 的/ 形式化/ 分析/ 是/ 一种/ 重要/ 技术/ ./ 一般/ 形式化/ 方法/ 由于/ 缺少/ 对/ TPM/ 相关/ 命令/ 的/ 描述/ 而/ 难以/ 用于/ 分析/ 可信计算/ 的/ 协议/ ./ 文献/ [/ 5/ -/ 6/ ]/ 使用/ 串/ 空间/ CPSA/ 分析/ 工具/ 对/ 远程/ 证明/ 协议/ 进行/ 了/ 研究/ ,/ 设计/ 并/ 证明/ 了/ 一个/ 新/ 的/ CAVES/ 协议/ ./ 不过/ 该/ 研究/ 缺少/ 对/ 平台/ 身份/ 密钥建立/ 的/ 分析/ ,/ 也/ 没有/ 对/ 安全/ 芯片/ 单独/ 进行/ 建模/ ;/ 因此/ ,/ 其/ 分析/ 结果/ 不能/ 全面/ 阐述/ 远程/ 证明/ 协议/ 的/ 安全性/ ./ 本文/ 通过/ 扩展/ CPSA/ 工具/ 依赖/ 的/ 串/ 空间/ 理论/ 和/ 认证/ 测试/ 准则/ ,/ 对/ 可信计算/ 远程/ 证明/ 协议/ 进行/ 了/ 全面/ 的/ 分析/ ./ 文献/ [/ 12/ ]/ 提出/ 了/ 一个/ 形式化/ 基础/ 和/ 框架/ ,/ 能/ 对/ 可信/ 平台/ 进行/ 模型/ 检测/ 分析/ ,/ 发现/ 了/ 可信/ 平台/ 的/ 一些/ 逻辑/ 缺陷/ ./ Chen/ 等/ 人/ [/ 13/ ]/ 为/ TPM2/ ./ 0/ 设计/ 并/ 实现/ 了/ 新/ 的/ 数字签名/ 方法/ ,/ 并/ 在/ SDH/ 假设/ 和/ 随机/ 预言/ 机/ 模型/ 下/ 证明/ 了/ TPM/ 签名/ 原语/ 的/ 安全性/ ./ Kremer/ 和/ Kunnemann/ [/ 14/ ]/ 提出/ 了/ 新/ 的/ 形式化/ 分析/ 工具/ ,/ 能/ 处理/ 协议/ 中/ 的/ 非/ 单调/ 全局/ 状态/ ,/ 适合/ 对/ TPM/ 的/ API/ 和/ PCR/ 寄存器/ 进行/ 分析/ ./ 文献/ [/ 15/ ]/ 首次/ 提出/ 了/ 可以/ 处理/ Diffie/ -/ Hellman/ 幂/ 运算/ 、/ 双线性/ 映射/ 和/ AC/ -/ 运算符/ 的/ 符号分析/ 算法/ ,/ 并/ 基于/ tamarin/ 进行/ 了/ 实现/ ,/ 该/ 方法/ 有助于/ 分析/ 可信计算/ 的/ 直接/ 匿名/ 认证/ 协议/ ./ 2.2/ 串/ 空间/ 串/ 空间/ 模型/ 建立/ 在/ Dolev/ -/ Yao/ 基础/ [/ 16/ ]/ 之上/ ,/ 该/ 模型/ 假定/ 密码/ 系统/ 本身/ 是/ 完好/ 的/ ,/ 攻击者/ 无法/ 进行/ 密码/ 分析/ ,/ 不过/ 攻击者/ 可以/ 完全/ 控制/ 网络/ ,/ 甚至/ 能/ 使用/ 自己/ 的/ 身份/ 参与/ 到/ 协议/ 会话/ 中/ ./ 串/ 空间/ 的/ 发展/ 大致/ 经历/ 了/ 3/ 个/ 阶段/ :/ 串/ 空间/ 理论/ [/ 17/ ]/ 、/ 认证/ 测试方法/ [/ 18/ -/ 20/ ]/ 和/ 自动化/ 分析/ 工具/ CPSA/ [/ 7/ -/ 8/ ]/ ./ 串/ 空间/ 理论/ 是/ 纯手工/ 推理/ ,/ 对于/ 一个/ 简单/ 协议/ (/ 如/ NS/ 协议/ )/ 的/ 分析/ ,/ 其/ 推理/ 和/ 证明/ 过程/ 都/ 比较复杂/ ,/ 容易/ 出错/ ;/ 认证/ 测试方法/ 提炼出/ 了/ 一些/ 高级/ 测试/ 准则/ ,/ 能/ 直接/ 针对/ 协议/ 的/ 消息/ 组件/ 推理/ 认证/ 属性/ ,/ 并且/ 对/ 所有/ 协议/ 是/ 通用/ 的/ ,/ 简化/ 了/ 手工/ 推理/ 的/ 复杂性/ ,/ 降低/ 了/ 分析/ 的/ 难度/ ;/ CPSA/ 工具/ 进一步/ 基于/ 认证/ 测试方法/ 给出/ 了/ 对/ 协议/ 的/ 自动/ 推理/ ,/ 能/ 以图/ 的/ 方式/ 输出/ 协议/ 所有/ 可能/ 的/ 执行/ 流程/ ,/ 安全/ 属性/ 需要/ 根据/ 所有/ 输出/ 的/ 图/ 进行/ 分析判断/ ,/ 因此/ ,/ CPSA/ 实际上/ 是/ 一个/ 半自动化/ 工具/ ,/ 不过/ 其/ 避开/ 了/ 复杂/ 的/ 串/ 空间/ 理论/ ,/ 分析/ 者/ 容易/ 上/ 手/ ,/ 而且/ 也/ 提高/ 了/ 协议/ 分析/ 的/ 效率/ ./ 串/ 空间/ 通过/ 图/ 的/ 方式/ ,/ 能/ 比较/ 直观/ 的/ 描述/ 协议/ 的/ 执行/ 或者/ 攻击/ 流程/ ,/ 已经/ 被/ 成功/ 用于/ 分析/ CAVES/ 认证/ 协议/ [/ 5/ -/ 6/ ]/ 、/ TLS/ 安全/ 通道/ [/ 21/ -/ 23/ ]/ 和/ IKE/ 密钥/ 交换/ [/ 24/ ]/ 等/ ./ 文献/ [/ 21/ ]/ 中/ Kamil/ 为了/ 分析/ TLS/ 协议/ 对串/ 空间/ 进行/ 了/ 扩展/ ,/ 其/ 扩展/ 方法/ 为/ 本文/ 的/ 扩展/ 研究/ 提供/ 了/ 参考/ 思路/ ./ 由于/ 串/ 空间/ 的/ 消息/ 代数/ 、/ 攻击者/ 串/ 和/ 认证/ 测试方法/ 描述/ 能力/ 有限/ ,/ 在/ 分析/ 一些/ 复杂/ 协议/ 时/ 可能/ 遇到/ 障碍/ ,/ 文献/ [/ 21/ ]/ 和/ 本文/ 的/ 方法/ 提供/ 了/ 一种/ 通用/ 的/ 扩展/ 思路/ ,/ 能/ 增强/ 串/ 空间/ 的/ 描述/ 能力/ ,/ 使/ 其能/ 用于/ 对/ 更/ 多/ 协议/ 进行/ 形式化/ 分析/ ./ Guttman/ [/ 25/ ]/ 对串/ 空间/ 模型/ 进行/ 了/ 扩展/ ,/ 使得/ 其能/ 分析/ 公平/ 交换/ 协议/ ./ Ramsdell/ [/ 26/ ]/ 在/ CPSA/ 工具/ 的/ 基础/ 上/ 提出/ 了/ 形状/ 分析/ 语句/ ,/ 能够/ 提取/ 一阶/ 逻辑/ 中/ 的/ 语句/ 来/ 描绘/ CPSA/ 的/ 运行/ ,/ 并/ 通过/ 逻辑推理/ 的/ 方式/ 来/ 确定/ 协议/ 的/ 安全/ 目标/ ./ 串/ 空间/ 的/ 协议/ 主体/ 维护/ 的/ 本地/ 状态/ 在/ 各个/ 协议/ 会话/ 中/ 是/ 独立/ 的/ ,/ 在/ 处理/ 跨会/ 话/ 的/ 状态/ 时会/ 遇到困难/ ,/ 于是/ Ramsdell/ 等/ 人/ [/ 27/ ]/ 提出/ 了/ 一种/ 混合/ 分析方法/ ,/ 使用/ 定理/ 证明/ 来/ 推理/ 基于/ 状态/ 的/ 计算/ ,/ 并/ 使用/ CPSA/ 来/ 处理/ 消息传递/ 部分/ ./ 基于/ 该/ 混合/ 分析方法/ ,/ Ramsdell/ 对/ 使用/ TPMAPI/ 访问/ PCR/ 寄存器/ 的/ 情况/ 进行/ 了/ 建模/ 分析/ ./ Guttman/ 在/ 文献/ [/ 28/ ]/ 中/ 基于/ 串/ 空间/ 理论/ 提出/ 了/ 新/ 的/ 标号/ 转换/ 系统分析/ 方法/ ./ 3/ 可信计算/ 远程/ 证明/ 协议/ 简介/ 完整/ 的/ 远程/ 证明/ 协议/ RA/ (/ RemoteAttestation/ )/ ①/ library/ _/ specification/ ②/ Page4/ 分为/ 两个/ 阶段/ :/ 平台/ 身份/ 密钥建立/ [/ 10/ -/ 11/ ]/ 和/ 平台/ 证明/ 过程/ [/ 1/ ,/ 5/ ]/ ./ 前者/ 基于/ PrivacyCA/ [/ 10/ ]/ 产生/ 一个/ 平台/ 身份/ 密钥/ ,/ 在/ 认证/ 平台/ 身份/ 的/ 同时/ 保护/ 用户/ 的/ 隐私/ ;/ 后者/ 基于/ 平台/ 身份/ 密钥/ 向/ 远程/ 方/ 证明/ 平台/ 的/ 软件/ 状态/ ./ 本节/ 首先/ 对/ 这/ 两个/ 阶段/ 进行/ 总结/ ,/ 最后/ 给出/ 协议/ 的/ 安全/ 目标/ ./ 3.1/ 平台/ 身份/ 密钥建立/ 安全/ 芯片/ TPM/ [/ 1/ ]/ 使用/ 背书/ 密钥/ EK/ (/ Endorse/ -/ mentKey/ )/ 作为/ 其/ 唯一/ 标识/ ,/ 其/ 私钥/ 长期/ 保存/ 在/ TPM/ 芯片/ 内部/ (/ 不会/ 泄露/ )/ ,/ 公钥/ 由/ 芯片/ 厂商/ 签名/ 生成/ EK/ 证书/ ./ 由于/ EK/ 可以/ 唯一/ 标识/ 一个/ TPM/ 及其/ 所在/ 的/ 硬件平台/ ,/ 通常/ 无法/ 作为/ 平台/ 身份/ 使用/ ;/ 否则/ ,/ 会/ 泄露/ 平台/ 隐私/ ./ 因此/ ,/ TCG/ 使用/ 安全/ 芯片/ 生成/ 的/ 身份/ 密钥/ AIK/ 代替/ EK/ 作为/ 平台/ 身份/ ./ 为了/ 证明/ AIK/ 属于/ 一个/ 合法/ 的/ TPM/ 芯片/ ,/ 同时/ 不/ 泄露/ 具体/ 是/ 哪个/ TPM/ ,/ TCG/ 规定/ 采用/ 可信/ 第/ 3/ 方/ Privacy/ -/ CA/ 来/ 认证/ AIK/ 并/ 生成/ AIK/ 证书/ ./ 通过/ AIK/ 证书/ ,/ 只有/ PrivacyCA/ 能/ 确定/ TPM/ 所在/ 的/ 硬件平台/ ,/ 而/ 其他/ 验证/ 者/ 无法/ 追踪/ 到/ 该/ 平台/ ,/ 因此/ 平台/ 隐私/ 得到/ 保护/ ./ 平台/ 身份/ 密钥/ AIK/ 的/ 建立/ 过程/ 见/ 消息/ 1/ ~/ 6/ ./ 具体/ 包含/ 3/ 个/ 主要/ 的/ 角色/ :/ 安全/ 芯片/ TPM/ // TCM/ (/ T/ )/ ,/ 用户/ 进程/ (/ U/ )/ 和/ 可信/ 第/ 3/ 方/ PrivacyCA/ (/ PCA/ )/ :/ 消息/ 1/ ./ U/ →/ T/ :/ L/ ,/ PCA/ 消息/ 2/ ./ T/ →/ U/ :/ AIK/ ,/ I/ 消息/ 3/ ./ U/ →/ PCA/ :/ Cert/ _/ EK/ ,/ AIK/ ,/ L/ ,/ PCA/ ,/ I/ 消息/ 4/ ./ PCA/ →/ U/ :/ {/ Cert/ _/ AIK/ }/ EK/ 消息/ 5/ ./ U/ →/ T/ :/ {/ Cert/ _/ AIK/ }/ EK/ 消息/ 6/ ./ T/ →/ U/ :/ Cert/ _/ AIK/ 消息/ 1/ 和/ 2/ :/ 用户/ 选取/ 1/ 个/ 身份/ 标签/ L/ 和/ 指定/ 可信/ 第/ 3/ 方/ PCA/ ,/ 通过/ 调用/ TPM/ _/ MakeIdentity/ 命令/ [/ 24/ ]/ ,/ 由/ TPM/ 芯片/ 生成/ 1/ 个/ 新鲜/ 的/ AIK/ 密钥/ 对/ ,/ 将/ 私钥/ AIK/ -/ 1/ 加密/ 保存/ 在/ TPM/ 内部/ ,/ 而/ 将/ 公钥/ AIK/ 和/ TPM/ 生成/ 的/ 身份/ 内容/ I/ 返回/ 给/ 用户/ ./ 注意/ ,/ L/ 只是/ 1/ 个/ 标签/ ,/ 由/ 用户/ 自由/ 选取/ ,/ 可以/ 用于/ 查找/ AIK/ 证书/ ,/ 而/ 无法/ 作为/ 安全/ 芯片/ 或者/ 用户/ 的/ 唯一/ 标识/ 名称/ 使用/ ./ 我们/ 使用/ 如下/ 函数/ 来/ 表示/ 身份/ 内容/ I/ 的/ 生成/ :/ 该/ 函数/ 通过/ 安全/ 芯片/ T/ 的/ AIK/ -/ 1/ 对/ AIK/ ,/ L/ 和/ PCA/ 进行/ 签名/ ,/ 表示/ 这些/ 数据/ 与/ 该/ 安全/ 芯片/ T/ 关联/ (/ 这里/ SK/ (/ T/ )/ =/ AIK/ -/ 1/ )/ ./ 消息/ 3/ 和/ 4/ :/ 用户/ 进程/ 将/ 公钥/ AIK/ 以及/ 签名/ 的/ 身份/ 内容/ I/ ,/ 连同/ EK/ 证书/ 一起/ 发送给/ 可信/ 第/ 3/ 方/ PCA/ ./ PCA/ 验证/ EK/ 证书/ 的/ 有效性/ 后/ ,/ 用/ 其/ 私钥/ SK/ (/ PCA/ )/ 对/ AIK/ 公钥/ 进行/ 签名/ 生成/ AIK/ 证书/ ./ PCA/ 使用/ EK/ 加密/ 保护/ AIK/ 证书/ ,/ 将/ 加密/ 包/ 返回/ 给/ 用户/ ./ 规范/ 中/ ,/ PCA/ 会/ 生成/ 一个/ 临时/ 对称/ 密钥/ K/ 来/ 加密/ 保护/ AIK/ 证书/ ,/ 而/ 使用/ EK/ 加密/ K/ ,/ 从/ 安全/ 角度/ 而言/ ,/ 与/ 直接/ 使用/ EK/ 加密/ AIK/ 证书/ 一样/ ./ 为了/ 方便/ 分析/ ,/ 本文/ 省去/ K/ ,/ 采取/ 简化/ 的/ 形式/ ./ 我们/ 使用/ [/ p/ ,/ PK/ (/ p/ )/ ,/ v/ ]/ SK/ (/ v/ )/ 来/ 表示/ 一个/ 证书/ ,/ p/ 是/ 证书/ 拥有者/ ,/ PK/ (/ p/ )/ 是/ p/ 的/ 公钥/ ,/ v/ 是/ 签发/ 者/ ,/ SK/ (/ v/ )/ 是/ v/ 的/ 私钥/ ./ 因此/ ,/ EK/ 证书/ 和/ AIK/ 证书/ 可以/ 分别/ 表示/ 如下/ (/ MF/ 表示/ 生产/ 安全/ 芯片/ T/ 的/ 厂商/ )/ :/ 如果/ 攻击者/ 拥有/ 相应/ 的/ 私钥/ ,/ 也/ 可以/ 产生/ 伪造/ 的/ 证书/ ,/ 因此/ 具体分析/ 时/ ,/ 采用/ 如下/ 形式/ 来/ 描述/ 证书/ :/ 基于/ 一些/ 假设/ (/ 如/ v/ 可信/ 且/ k/ =/ SK/ (/ v/ )/ 是/ 安全/ 密钥/ )/ ,/ 需要/ 证明/ kp/ =/ PK/ (/ p/ )/ ./ 消息/ 5/ 和/ 6/ :/ 用户/ 进程/ 将/ EK/ 生成/ 的/ 加密/ 包/ 发送给/ 安全/ 芯片/ T/ ,/ 并/ 通过/ TPM/ _/ ActivateIdentity/ 命令/ 来/ 激活/ T/ 内部/ 的/ 新/ 身份/ 密钥/ AIK/ ,/ 同时/ 使用/ T/ 内部/ 的/ EK/ 私钥/ 解密/ 获得/ 相应/ 的/ AIK/ 证书/ ./ 3.2/ 平台/ 证明/ 过程/ 平台/ 证明/ 过程/ 主要/ 是/ 向/ 远程/ 方/ 证明/ 本地/ 平台/ 的/ 身份/ 和/ 完整性/ 状态/ ./ 身份/ 由/ AIK/ 表示/ ,/ 完整性/ 状态/ 由/ 安全/ 芯片/ 的/ 平台/ 配置/ 寄存器/ PCR/ (/ PlatformCon/ -/ figurationRegister/ )/ 保证/ ./ 通过/ TPM/ _/ Quote/ 命令/ [/ 1/ ]/ ,/ AIK/ 可以/ 对/ PCR/ 进行/ 签名/ ,/ 签名/ 的/ 结果/ 可以/ 作为/ 远程/ 方/ 依赖/ 的/ 证据/ ./ 平台/ 证明/ 过程/ 包含/ 3/ 个/ 主要/ 角色/ :/ 安全/ 芯片/ TPM/ // TCM/ (/ T/ )/ ,/ 用户/ 进程/ Attester/ (/ U/ )/ 和/ 远程/ 验证/ 者/ Verifier/ (/ V/ )/ ./ 具体/ 协议/ 流程/ 如下/ :/ 消息/ 7/ ./ V/ →/ U/ :/ NV/ 消息/ 8/ ./ U/ →/ T/ :/ NV/ 消息/ 9/ ./ T/ →/ U/ :/ Q/ 消息/ 10/ ./ U/ →/ V/ :/ Q/ ,/ ML/ ,/ Cert/ _/ AIK/ 首先/ ,/ 远程/ 验证/ 方/ V/ 产生/ 一个/ 新鲜/ 的/ 随机/ 挑战/ 值/ NV/ ,/ 向/ 本地/ 证明/ 者/ U/ 请求/ 可信/ 证据/ (/ 消息/ 7/ )/ ./ U/ 将/ 随机/ 值/ 转发给/ 安全/ 芯片/ T/ (/ 消息/ 8/ )/ ./ 然后/ T/ 使用/ TPM/ _/ Quote/ 命令/ 对/ PCR/ 值/ 和/ NV/ 进行/ 签名/ ,/ 并/ 将/ 签名/ 结果/ Q/ 返回/ 给/ 用户/ 进程/ U/ (/ 消息/ 9/ )/ ./ 最后/ U/ 将/ Q/ 、/ AIK/ 证书/ 和/ 度量/ 日志/ ML/ 一起/ 发送给/ V/ (/ 消息/ 10/ )/ ./ V/ 通过/ 验证/ 这些/ 值/ ,/ 可以/ 确定/ U/ 所在/ 平台/ 的/ 可信/ 状态/ :/ AIK/ 确定/ 平台/ 是否/ 拥有/ 合法/ 的/ 安全/ 芯片/ ;/ 度量/ 日志/ ML/ 确定/ 平台/ 是否/ 运行/ 预期/ 的/ 软件/ ;/ Q/ 关/ Page5/ 联/ AIK/ 和/ ML/ ,/ 并/ 保证/ ML/ 的/ 完整性/ ./ 度量/ 日志/ ML/ 记录/ 了/ 用户/ 计算/ 平台/ 的/ 所有/ 可执行程序/ 及其/ 度量/ 值/ (/ 程序/ 二进制/ 代码/ 的/ 哈希/ 值/ )/ ./ PCR/ 是/ 这些/ 度量/ 值/ 的/ 一个/ 哈希/ 聚集/ 值/ ,/ 采用/ 哈希/ 链/ (/ HashChain/ )/ 的/ 方式/ 生成/ ,/ 即/ m/ 是/ 一个/ 新/ 的/ 度量/ 值/ ,/ PCR/ _/ Old/ 是/ 旧/ 的/ PCR/ 值/ ,/ 而/ PCR/ _/ New/ 是/ 扩展/ (/ 通过/ TPM/ _/ Extend/ 命令/ )/ m/ 后/ 的/ 新/ PCR/ 值/ ./ PCR/ 的/ 主要/ 目的/ 是/ 保证/ ML/ 的/ 完整性/ ./ 我们/ 采用/ 如下/ 两个/ 函数/ 来/ 表示/ Q/ 的/ 生成/ :/ HashChain/ 是/ 度量/ 日志/ ML/ 的/ 一个/ 完整性/ 标识/ ,/ 拥有/ 密码/ 哈希/ 函数/ 的/ 属性/ ,/ 为了/ 简化/ ,/ 具体分析/ 时/ 将/ HashChain/ 作为/ 一个/ 哈希/ 函数/ 处理/ ./ Q/ 是/ 一个/ 基于/ T/ 内部/ AIK/ 私钥/ 的/ 数字签名/ ./ 3.3/ 安全/ 目标/ 根据/ 远程/ 证明/ 协议/ 的/ 相关/ 工作/ [/ 4/ -/ 5/ ,/ 10/ ]/ 以及/ 其/ 在/ 安全/ 系统/ (/ 安全/ 支付/ 、/ 可信/ 网络/ 接入/ 和/ 可信/ 云/ 服务/ 等/ )/ 中/ 的/ 应用/ ,/ 本文/ 总结/ 了/ 如下/ 5/ 个/ 安全/ 目标/ :/ (/ 1/ )/ 隐私/ 性/ ./ 平台/ 证明/ 过程/ 中/ ,/ 验证/ 者/ 可以/ 确定/ 一个/ 合法/ 的/ TPM/ 芯片/ ,/ 但是/ 无法/ 确定/ 具体/ 是/ 哪个/ TPM/ 芯片/ ./ 简单/ 的/ 说/ ,/ Cert/ _/ EK/ 只能/ 提供/ 给/ 可信/ 第/ 3/ 方/ PrivacyCA/ ,/ 而/ 其他/ 方/ 需要/ 的/ 身份/ 认证/ 性由/ Cert/ _/ AIK/ 提供/ ;/ Cert/ _/ EK/ 会/ 泄露/ 具体/ 的/ TPM/ 芯片/ ,/ 而/ Cert/ _/ AIK/ 不会/ ./ (/ 2/ )/ PrivacyCA/ 认证/ 性/ ./ 作为/ 可信/ 第/ 3/ 方/ 的/ PrivacyCA/ 能够/ 验证/ 具体/ TPM/ 芯片/ 的/ 身份/ 合法性/ (/ 基于/ Cert/ _/ EK/ )/ ,/ 只有/ 确定/ 其/ 合法/ 后/ 才/ 会/ 给/ 其/ 签发/ AIK/ 证书/ (/ Cert/ _/ AIK/ )/ ./ (/ 3/ )/ Verifier/ 认证/ 性/ ./ 平台/ 证明/ 过程/ 中/ ,/ 验证/ 者/ Verifier/ 能/ 确定/ 一个/ 合法/ 的/ 证明/ 者/ 平台/ (/ 包含/ 安全/ 芯片/ T/ 以及/ 用户/ 进程/ U/ )/ ,/ 能/ 同时/ 验证/ 平台/ 的/ 完整性/ 状态/ ./ (/ 4/ )/ ML/ 的/ 机密性/ ./ 度量/ 日志/ ML/ 记录/ 了/ 证明/ 者/ 平台/ 的/ 所有/ 软件/ 配置/ ,/ 通常/ 会/ 包含/ 该/ 平台/ 的/ 一些/ 敏感/ 信息/ ,/ 不能/ 泄露/ ./ (/ 5/ )/ 用户/ 的/ 认证/ 性/ ./ 用户/ 能/ 确保/ 其/ 与/ 一个/ 合法/ 的/ 验证/ 者/ Verifier/ 交互/ ,/ 而/ 不是/ 在/ 与/ 一些/ 恶意/ 方/ 交互/ ,/ 防止/ 平台/ 的/ 可信/ 数据/ 被/ 恶意/ 攻击者/ 获取/ ./ 4/ 串/ 空间/ 扩展/ 模型/ 本/ 节/ 主要/ 给出/ 串/ 空间/ 理论/ [/ 17/ ]/ 以及/ 我们/ 为了/ 描述/ 远程/ 证明/ 协议/ 所作/ 的/ 一些/ 扩展/ ./ 同时/ ,/ 对/ 扩展/ 模型/ 中/ 衍生/ 的/ 一些/ 定理/ 和/ 准则/ 进行/ 了/ 证明/ ./ 4.1/ 串/ 空间/ 基础/ 4.1/ ./ 1/ 消息/ 代数/ 设/ A/ 是/ 协议/ 执行/ 中/ 所有/ 消息/ 的/ 集合/ ,/ A/ 中/ 的/ 元素/ 称为/ 消息/ 项/ (/ term/ )/ ./ 原始/ 串/ 空间/ 理论/ [/ 17/ ]/ 定义/ 了/ 两类/ 原子/ 消息/ 项/ :/ 一类/ 是/ 明文/ 消息/ 项/ (/ 如/ 参与者/ 标识/ 、/ 随机数/ 等/ )/ ,/ 构成/ 集合/ M/ ;/ 另一类/ 是/ 密钥/ 消息/ 项/ (/ 如/ 对称/ 密钥/ 、/ 加密/ 密钥/ 等/ )/ ,/ 构成/ 集合/ K/ ./ 为了/ 描述/ 远程/ 证明/ 协议/ 的/ 安全/ 芯片/ ,/ 我们/ 增加/ 了/ 一个/ 集合/ X/ ,/ 表示/ 所有/ 安全/ 芯片/ 的/ 集合/ ./ 原始/ 串/ 空间/ [/ 17/ ]/ 在/ 消息/ 集/ A/ 上/ 定义/ 了/ 两个/ 二元/ 运算/ (/ 加密/ 运算/ encr/ 与/ 级联/ 运算/ join/ )/ 、/ 一个/ 一元/ 运算/ (/ 密钥/ 求逆/ inv/ )/ ./ 可信计算/ 安全/ 芯片/ 对/ 密钥/ 有/ 严格/ 的/ 分类/ ,/ 如/ EK/ 只能/ 用于/ 加密/ ,/ 而/ AIK/ 只能/ 用于/ 签名/ ./ 因此/ ,/ 我们/ 将/ K/ 划分/ 为/ 3/ 个/ 不/ 相交/ 子集/ :/ 加密/ 密钥/ Kenc/ 、/ 签名/ 密钥/ Ksig/ 和/ 对称/ 密钥/ Ksym/ ./ 为了/ 描述/ 普通/ 签名/ 消息/ ,/ 增加/ 了/ 一个二元/ 运算/ sig/ ./ 为了/ 描述/ 身份/ 消息/ ,/ 增加/ 了/ 一个二元/ 运算/ mid/ ./ 为了/ 描述/ PCR/ 值/ ,/ 增加/ 一个/ hash/ 运算/ ./ 扩展/ 的/ 消息/ 集合/ 和/ 运算/ 定义/ 如下/ ./ 定义/ 1/ ./ 消息/ 集合/ A/ 中/ 的/ 原子/ 消息/ 项是/ M/ ,/ K/ 和/ X/ 中/ 的/ 元素/ (/ 其中/ M/ ,/ K/ 和/ X/ 两/ 两/ 互斥/ )/ ;/ 复合/ 消息/ 项由/ 如下/ 运算/ 生成/ :/ 加密/ encr/ :/ Kenc/ ×/ A/ →/ A/ ;/ 签名/ sig/ :/ Ksig/ ×/ A/ →/ A/ ;/ 级联/ join/ :/ A/ ×/ A/ →/ A/ ;/ 身份/ 生成/ mid/ :/ X/ ×/ A/ →/ A/ ;/ 哈希/ hash/ :/ H/ ×/ A/ →/ A/ (/ 其中/ H/ 是/ 所有/ 哈希/ 函数/ 的/ 集合/ )/ ./ 根据/ 习惯/ ,/ 记/ encr/ (/ k/ ,/ m/ )/ 为/ {/ m/ }/ k/ ,/ 记/ sig/ (/ k/ ,/ m/ )/ 为/ [/ m/ ]/ k/ ,/ 记/ join/ (/ a/ ,/ b/ )/ 为/ a/ ‖/ b/ ,/ 记/ mid/ (/ T/ ,/ m/ )/ 为/ [/ m/ ]/ T/ ,/ 记/ hash/ (/ h/ ,/ m/ )/ 为/ h/ (/ m/ )/ ./ 密钥/ 的/ 逆/ 由/ inv/ :/ K/ →/ K/ 进行/ 定义/ ,/ 记/ inv/ (/ k/ )/ =/ k/ -/ 1/ ./ 如果/ k/ ∈/ Ksym/ ,/ 则/ k/ =/ k/ -/ 1/ ./ 对于/ 主体/ 名称/ a/ ∈/ M/ ,/ PK/ (/ a/ )/ 和/ SK/ (/ a/ )/ 分别/ 表示/ 主体/ a/ 的/ 公钥/ 和/ 私钥/ ./ 如果/ 一个/ 非对称/ 加密/ 密钥/ k/ ∈/ K/ 由/ 安全/ 芯片/ T/ ∈/ X/ 生成/ ,/ 则/ 私钥/ 记为/ k/ =/ SKenc/ (/ T/ )/ ,/ 公钥/ 记为/ k/ -/ 1/ =/ PKenc/ (/ T/ )/ ./ 同理/ T/ 中有/ 非对称/ 签名/ 密钥/ SKsig/ (/ T/ )/ 和/ 验证/ 密钥/ PKsig/ (/ T/ )/ ./ SKenc/ (/ T/ )/ 和/ SKsig/ (/ T/ )/ 处于/ 安全/ 芯片/ T/ 的/ 硬件/ 保护/ ,/ 永不/ 泄露/ ,/ 统一/ 记为/ SK/ (/ T/ )/ ./ 注意/ ,/ 一般/ 主体/ a/ 并/ 不/ 区分/ 签名/ 密钥/ 和/ 加密/ 密钥/ ,/ 而/ 安全/ 芯片/ T/ 对/ 密钥/ 类型/ 有/ 严格/ 的/ 限制/ ./ 本文/ 针对/ 远程/ 证明/ 协议/ 的/ 变量/ 约定/ 如下/ :/ T/ ∈/ X/ ;/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ ML/ ,/ NV/ ∈/ M/ ;/ AIK/ ,/ AIK/ -/ 1/ ∈/ Ksig/ ;/ EK/ ,/ EK/ -/ 1/ ∈/ Kenc/ ./ 如果/ AIK/ 和/ EK/ 属于/ 某个/ 安全/ 芯片/ T/ ,/ 则/ AIK/ =/ PKsig/ (/ T/ )/ ,/ AIK/ -/ 1/ =/ SKsig/ (/ T/ )/ ,/ Page6EK/ =/ PKenc/ (/ T/ )/ ,/ EK/ -/ 1/ =/ SKenc/ (/ T/ )/ ./ 消息/ 项/ 之间/ 存在/ 子项/ 关系/ (/ / )/ ,/ 定义/ 如下/ ./ 定义/ 2/ ./ 子项/ 关系/ / 递归/ 定义/ 如下/ :/ a/ / a/ ;/ 若/ a/ / b/ ,/ 则/ a/ / {/ b/ }/ k/ ,/ a/ / [/ b/ ]/ k/ ,/ a/ / [/ b/ ]/ T/ ;/ 若/ a/ / b/ 或者/ a/ / c/ ,/ 则/ a/ / b/ ‖/ c/ ./ 这里/ a/ ,/ b/ ,/ c/ ∈/ A/ ,/ k/ ∈/ K/ ,/ T/ ∈/ X/ ./ 如果/ a/ / b/ 且/ a/ ≠/ b/ ,/ 则/ 称/ a/ 为/ b/ 的/ 真/ 子项/ ./ 注意/ ,/ 子项/ 关系/ 的/ 意义/ 为/ :/ 给定/ 一些/ 密钥/ 和/ 安全/ 芯片/ 的/ 知识/ 集合/ ,/ 消息/ 项/ m/ 的/ 子项/ 可以/ 很/ 容易/ 从/ m/ 中/ 提取/ 出来/ ./ 显然/ ,/ h/ (/ a/ )/ 中/ 的/ a/ 以及/ {/ b/ }/ k/ ,/ [/ b/ ]/ k/ ,/ [/ b/ ]/ T/ 中/ 的/ k/ 和/ T/ 并/ 不/ 属于/ 子项/ ,/ 这/ 是/ 由/ 完美/ 密码/ 系统/ (/ Dolev/ -/ Yao/ 假设/ )/ 的/ 安全/ 性质/ 决定/ 的/ ,/ 如/ 哈希/ 是/ 不/ 可逆/ 的/ ,/ 密文/ 不会/ 泄露/ 密钥/ 信息/ 等/ ./ 定义/ 3/ ./ 如果/ a/ / b/ ,/ 且/ a/ 不是/ 一个/ 级联/ 项/ (/ g/ ‖/ h/ 的/ 形式/ )/ ,/ 那么/ 称/ a/ 为/ b/ 的/ 一个/ 组件/ ,/ b/ 由/ a/ 与/ 任意/ 的/ 消息/ 项/ 级联/ 而成/ ./ 因此/ ,/ 组件/ 可以/ 是/ 一个/ 原子/ 项/ ,/ 加密/ 项/ ,/ 哈希/ 项/ ,/ 签名/ 项/ 或者/ 身份/ 项/ ./ 组件/ 可以/ 将/ 一个/ 非/ 级联/ 形式/ 的/ 消息/ 项/ 与/ 协议/ 的/ 某个/ 执行/ 主体/ 进行/ 关联/ ./ 如/ 只有/ 拥有/ 签名/ 私钥/ 的/ 主体/ 才能/ 产生/ 某个/ 签名/ 项/ ,/ 只有/ 拥有/ 加密/ 私钥/ 的/ 主体/ 才能/ 解密/ 某个/ 加密/ 项/ 等/ ./ 组件/ 是/ 串/ 空间/ 认证/ 测试方法/ [/ 18/ -/ 20/ ]/ 提出/ 的/ 一个/ 非常/ 重要/ 的/ 概念/ ./ 4.1/ ./ 2/ 串/ 、/ 串/ 空间/ 和/ 丛/ 协议/ 参与者/ 可以/ 发送/ 消息/ 项/ ,/ 也/ 可以/ 接受/ 消息/ 项/ ./ 在/ 串/ 空间/ 中/ ,/ 使用/ 正/ 号/ 表示/ 发送/ ,/ 负号/ 表示/ 接受/ ./ 串/ (/ strand/ )/ 是/ 指/ 协议/ 参与者/ 发送/ 和/ 接受/ 消息/ 项/ 的/ 一个/ 序列/ ./ 串/ 空间/ (/ strandspace/ )/ 是/ 所有/ 串/ 的/ 集合/ ./ 定义/ 4/ ./ 〈/ σ/ ,/ a/ 〉/ 是/ 一个/ 带符号/ 项/ ,/ 其中/ σ/ ∈/ {/ +/ ,/ -/ }/ ,/ a/ ∈/ A/ ./ 一个/ 带符号/ 项记/ 为/ +/ a/ 或者/ -/ a/ ./ (/ ±/ A/ )/ / 是/ 所有/ 带符号/ 项/ 的/ 有限/ 序列/ 集合/ ,/ 其/ 一个/ 典型/ 的/ 元素/ 可以/ 记/ 为/ 〈/ 〈/ σ/ 1/ ,/ a1/ 〉/ ,/ …/ ,/ 〈/ σ/ n/ ,/ an/ 〉/ 〉/ ./ A/ 上/ 的/ 一个/ 串/ 空间/ 是/ 一个/ 集合/ Σ/ ,/ 该/ 集合/ 具有/ 一个/ 轨迹/ 映射/ tr/ :/ Σ/ →/ (/ ±/ A/ )/ / ./ 对/ 一个/ 固定/ 的/ 串/ 空间/ Σ/ ,/ 满足/ 如下/ 性质/ :/ (/ 1/ )/ 节点/ (/ node/ )/ n/ 是/ 〈/ s/ ,/ i/ 〉/ ,/ 其中/ s/ ∈/ Σ/ ,/ i/ 是/ 一个/ 整数/ ,/ 满足/ 1/ / i/ / length/ (/ tr/ (/ s/ )/ )/ ./ 节点/ 的/ 集合/ 为/ N/ ,/ 每个/ 节点/ n/ =/ 〈/ s/ ,/ i/ 〉/ 属于/ 唯一/ 一个/ 串/ s/ ./ (/ 2/ )/ 如果/ 节点/ n/ =/ 〈/ s/ ,/ i/ 〉/ ∈/ N/ ,/ 那么/ index/ (/ n/ )/ =/ i/ ,/ strand/ (/ n/ )/ =/ s/ ,/ term/ (/ n/ )/ =/ (/ tr/ (/ s/ )/ )/ i/ ,/ 即串/ s/ 中/ 的/ 第/ i/ 个/ 带符号/ 消息/ 项/ ./ (/ 3/ )/ 如果/ n1/ ,/ n2/ ∈/ N/ ,/ 则/ n1/ →/ n2/ 表示/ term/ (/ n1/ )/ =/ +/ a/ ,/ term/ (/ n2/ )/ =/ -/ a/ ,/ 即/ n1/ 发送/ 一个/ 消息/ a/ 到/ n2/ ,/ 给出/ 了/ 串/ 的/ 因果关系/ ./ (/ 4/ )/ 如果/ n1/ ,/ n2/ ∈/ N/ ,/ 则/ n1/ / n2/ 表示/ n1/ 和/ n2/ 出现/ 在/ 同一个/ 串中/ ,/ 且/ index/ (/ n2/ )/ =/ index/ (/ n1/ )/ +/ 1/ ,/ 即/ n2/ 是/ n1/ 的/ 直接/ 后继/ ,/ n1/ 是/ n2/ 的/ 直接/ 前驱/ ./ n1/ / +/ n2/ 表示/ n1/ 是/ n2/ 的/ 前驱/ (/ 不/ 一定/ 是/ 直接/ 前驱/ )/ ,/ 可以/ 经过/ 一个/ 或者/ 多个/ / 边/ 到达/ n2/ ./ (/ 5/ )/ 一个/ 无/ 符号/ 项/ t/ 发生/ 在/ n/ ∈/ N/ 中/ ,/ 当且/ 仅/ 当/ t/ / term/ (/ n/ )/ ,/ 即/ t/ 是/ 节点/ n/ 的/ 消息/ 项/ 的/ 子项/ ./ (/ 6/ )/ 设/ I/ 是/ 无/ 符号/ 项/ 的/ 集合/ ,/ 节点/ n1/ ∈/ N/ 是/ I/ 的/ 入口/ 点/ ,/ 当且/ 仅/ 当/ 对于/ 某个/ t/ ∈/ I/ ,/ term/ (/ n1/ )/ =/ +/ t/ 并且/ 对于/ 任意/ n2/ / +/ n1/ ,/ term/ (/ n2/ )/ / I/ ./ (/ 7/ )/ 一个/ 无/ 符号/ 项/ t/ 源于/ 一个/ 节点/ n/ ,/ 当且/ 仅/ 当/ n/ 是/ 集合/ I/ =/ {/ t0/ |/ t/ / t0/ }/ 的/ 入口/ 点/ ./ (/ 8/ )/ 一个/ 无/ 符号/ 项/ t/ 唯一/ 源于/ 一个/ 节点/ 集合/ S/ / N/ ,/ 当且/ 仅/ 当/ 存在/ 唯一/ 的/ 节点/ n/ ∈/ S/ 满足/ t/ 源于/ n/ ./ 通常/ 一个/ 唯一/ 源于/ 节点/ 的/ 消息/ 项/ 可以/ 表示/ 一个/ 随机数/ nonce/ 或者/ 会话/ 密钥/ ./ (/ 9/ )/ 一个/ 无/ 符号/ 项/ t/ 非/ 源于/ 一个/ 节点/ 集合/ S/ / N/ ,/ 当且/ 仅/ 当/ 不/ 存在/ 节点/ n/ ∈/ S/ 满足/ t/ 源于/ n/ ./ 通常/ 长期/ 安全/ 密钥/ 都/ 是非/ 源于/ 的/ ./ (/ 10/ )/ 如果/ 消息/ 项/ t/ 是/ term/ (/ n/ )/ 的/ 一个/ 组件/ ,/ 并且/ 对于/ 每个/ n0/ / +/ n/ ,/ t/ 不是/ term/ (/ n0/ )/ 的/ 组件/ ,/ 那么/ 称/ t/ 是/ 节点/ n/ 的/ 一个/ 新/ 组件/ ./ 基于/ 串/ 和/ 串/ 空间/ 的/ 概念/ ,/ 下面/ 给出/ 远程/ 证明/ 协议/ 正规/ 参与者/ 串/ 的/ 定义/ ./ 基于/ 第/ 2/ 节/ 的/ 描述/ ,/ 协议/ 主要/ 有/ 4/ 个/ 参与者/ 角色/ T/ ,/ U/ ,/ V/ 和/ PCA/ ,/ 同时/ 增加/ 1/ 个/ 厂商/ 角色/ MF/ 来/ 生成/ EK/ 证书/ ./ 记/ EK/ 证书/ 为/ cert/ (/ EK/ )/ =/ [/ T/ ‖/ EK/ ‖/ MF/ ]/ SK/ (/ MF/ )/ ,/ AIK/ 证书/ 为/ cert/ (/ AIK/ )/ =/ [/ L/ ‖/ AIK/ ‖/ PCA/ ]/ SK/ (/ PCA/ )/ ,/ 安全/ 芯片/ T/ 生成/ 的/ 身份/ 为/ I/ =/ [/ AIK/ ‖/ L/ ‖/ PCA/ ]/ T/ ,/ 安全/ 芯片/ 生成/ 的/ Quote/ 签名/ 为/ Q/ =/ [/ h/ (/ ML/ )/ ‖/ NV/ ]/ inv/ (/ AIK/ )/ ./ 注意/ ,/ 这里/ I/ 和/ Q/ 的/ 表示/ 不/ 一致/ ,/ 因为/ I/ 的/ 生成/ 需要/ 安全/ 芯片/ 内部/ EK/ 的/ 参与/ ,/ 只能/ 由/ 安全/ 芯片/ T/ 进行/ ;/ 而/ Q/ 的/ 签名/ 可能/ 由/ 软件/ 生成/ (/ 基于/ 伪造/ 的/ 密钥/ )/ ,/ 不/ 一定/ 在/ T/ 内部/ 进行/ ./ 定义/ 5/ ./ 设/ TPM/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ ML/ ,/ NV/ ]/ 是/ 安全/ 芯片/ 串/ 的/ 集合/ ,/ 其/ 轨迹/ (/ trace/ )/ 为/ 〈/ -/ L/ ‖/ PCA/ ,/ +/ AIK/ ‖/ I/ ,/ -/ {/ cert/ (/ AIK/ )/ }/ EK/ ,/ +/ cert/ (/ AIK/ )/ ,/ -/ NV/ ,/ +/ Q/ 〉/ ./ 定义/ 6/ ./ 设/ User/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ ML/ ,/ NV/ ]/ 是/ 用户/ 进程/ 串/ 的/ 集合/ ,/ 其/ 轨迹/ (/ trace/ )/ 为/ 〈/ +/ L/ ‖/ PCA/ ,/ -/ AIK/ ‖/ I/ ,/ +/ L/ ‖/ PCA/ ‖/ AIK/ ‖/ I/ ‖/ cert/ (/ EK/ )/ ,/ -/ {/ cert/ (/ AIK/ )/ }/ EK/ ,/ +/ {/ cert/ (/ AIK/ )/ }/ EK/ ,/ -/ cert/ (/ AIK/ )/ ,/ -/ NV/ ,/ +/ NV/ ,/ -/ Q/ ,/ +/ ML/ ‖/ cert/ (/ AIK/ )/ ‖/ Q/ 〉/ ./ 定义/ 7/ ./ 设/ Verifier/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ L/ ,/ AIK/ ,/ ML/ ,/ NV/ ]/ 是/ 远程/ 验证/ 者/ 串/ 的/ 集合/ ,/ 其/ 轨迹/ 为/ 〈/ +/ NV/ ,/ -/ ML/ ‖/ cert/ (/ AIK/ )/ ‖/ Q/ 〉/ ./ 定义/ 8/ ./ 设/ PrivacyCA/ [/ T/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ Page7EK/ ]/ 是/ 隐私/ 证书/ 权威/ 串/ 的/ 集合/ ,/ 其/ 轨迹/ 为/ 〈/ -/ L/ ‖/ PCA/ ‖/ AIK/ ‖/ I/ ‖/ cert/ (/ EK/ )/ ,/ +/ {/ cert/ (/ AIK/ )/ }/ EK/ 〉/ ./ 定义/ 9/ ./ 设/ Manufacturer/ [/ MF/ ,/ T/ ,/ EK/ ]/ 是/ 安全/ 芯片/ 厂商/ 串/ 的/ 集合/ ,/ 其/ 轨迹/ 为/ 〈/ +/ cert/ (/ EK/ )/ 〉/ ./ 为了/ 简化/ 分析/ 过程/ ,/ 假定/ 在/ 远程/ 证明/ 协议/ 之前/ ,/ 厂商/ 颁发/ 的/ EK/ 证书/ 已经/ 被/ 用户/ 进程/ 和/ PrivacyCA/ 得到/ ./ 同时/ ,/ 使用/ 星号/ (/ / )/ 作为/ 串/ 参数/ 的/ 通配符/ ,/ 如/ TPM/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ / ,/ / ,/ NV/ ]/ 表示/ EK/ 和/ ML/ 可以/ 取/ 任意/ 值/ ./ 结点/ 集合/ N/ 和/ 边/ n1/ →/ n2/ 及/ n1/ / n2/ 的/ 集合/ 构成/ 一个/ 有向图/ 〈/ N/ ,/ (/ →/ ∪/ / )/ 〉/ ./ 一个/ 丛/ (/ bundle/ )/ 通常/ 定义/ 为/ 〈/ N/ ,/ (/ →/ ∪/ / )/ 〉/ 的/ 一个/ 子图/ ,/ 丛/ 表示/ 协议/ 的/ 一个/ 可能/ 执行/ ,/ 其边/ 解释/ 了/ 节点/ 之间/ 消息/ 项/ 的/ 因果关系/ ./ 下面/ 根据/ 原始/ 串/ 空间/ 的/ 描述/ 给出/ 关于/ 丛/ 的/ 定义/ 和/ 定理/ ,/ 定理/ 的/ 正确性/ 可以/ 参考/ Thayer/ [/ 17/ ]/ ./ 定义/ 10.1/ 个丛/ C/ =/ 〈/ NC/ ,/ (/ →/ C/ ∪/ / C/ )/ 〉/ 是/ 〈/ N/ ,/ (/ →/ ∪/ / )/ 〉/ 的/ 子/ 图/ ,/ 其中/ →/ C/ / →/ ,/ / C/ / / ./ 丛/ C/ 满足/ 下列/ 性质/ :/ (/ 1/ )/ C/ 是/ 一个/ 非空/ 的/ 有限/ 无环图/ ;/ (/ 2/ )/ 如果/ n1/ ∈/ NC/ ,/ 且/ term/ (/ n1/ )/ 是/ 负号/ ,/ 则/ 存在/ 唯一/ 的/ n2/ 满足/ n2/ →/ n1/ 是/ C/ 中/ 一条/ 边/ ;/ (/ 3/ )/ 如果/ n1/ ∈/ NC/ ,/ n2/ / n1/ ,/ 则/ n2/ / Cn1/ ./ 例如/ ,/ 图/ 1/ 给出/ 了/ 可信计算/ 远程/ 证明/ 协议/ 正常/ 执行/ 一次/ 的/ 丛/ ./ 定义/ 11.1/ 个/ 节点/ n/ ∈/ NC/ ,/ 那么/ 称该/ 节点/ 在/ 丛/ C/ =/ 〈/ NC/ ,/ (/ →/ C/ ∪/ / C/ )/ 〉/ 中/ ,/ 记为/ n/ ∈/ C/ ./ 对于/ 1/ 个/ 串/ s/ ,/ 满足/ 〈/ s/ ,/ i/ 〉/ ∈/ C/ 的/ 最大/ 正整数/ i/ 称为/ 串/ s/ 在/ C/ 的/ 丛高/ (/ C/ -/ height/ )/ ./ 定义/ 12/ ./ 如果/ C/ 是/ 一个/ 丛/ ,/ 定义/ 关系/ / C/ =/ (/ →/ C/ ∪/ / C/ )/ / ,/ 其/ 表示/ 节点/ 之间/ 的/ 因果关系/ ./ 定理/ 1/ ./ 对于/ 一个/ 丛/ C/ ,/ 关系/ / C/ 是/ 一个/ 偏序/ 关系/ ,/ 即/ 满足/ 自/ 反/ 、/ 反对/ 称/ 和/ 传递/ 性质/ ./ 丛/ C/ 中/ 节点/ 的/ 每个/ 非/ 空子/ 集都/ 存在/ / C/ -/ 最小/ 元/ ./ 4.1/ ./ 3/ 攻击者/ 能力/ 串/ 空间/ 基于/ Dolev/ -/ Yao/ 模型/ [/ 16/ ]/ ,/ 攻击者/ 能力/ 由/ 其/ 初始/ 知识/ (/ 初始/ 密钥/ 集合/ KP/ 以及/ 其他/ 初始/ 原子/ 消息/ 集合/ MP/ )/ ,/ 和/ 攻击者/ 能/ 执行/ 的/ 动作/ (/ 称为/ 攻击者/ 串/ )/ 来/ 决定/ ./ 本文/ 对串/ 空间/ 的/ 消息/ 代数/ 进行/ 了/ 扩展/ ,/ 对/ 攻击者/ 能力/ 也/ 进行/ 了/ 相应/ 的/ 扩展/ ./ 主要/ 增加/ 了/ 与/ 签名/ 、/ 身份/ 生成/ 和/ 哈希/ 相关/ 的/ 攻击者/ 串/ ,/ 即/ 定义/ 13/ 的/ SI/ ,/ VE/ ,/ MI/ 和/ H/ 串/ ./ 定义/ 13/ ./ 攻击者/ 串/ 的/ 轨迹/ 可以/ 是/ 如下/ 的/ 形式/ 之一/ :/ (/ 1/ )/ M/ ./ 散发/ 明文/ 消息/ :/ 〈/ +/ m/ 〉/ ,/ m/ ∈/ MP/ ./ (/ 2/ )/ K/ ./ 散发/ 密钥/ :/ 〈/ +/ k/ 〉/ ,/ k/ ∈/ KP/ ./ (/ 3/ )/ C/ ./ 级联/ 消息/ :/ 〈/ -/ g/ ,/ -/ m/ ,/ +/ g/ ‖/ m/ 〉/ ./ (/ 4/ )/ S/ ./ 拆分/ 消息/ :/ 〈/ -/ g/ ‖/ m/ ,/ +/ g/ ,/ +/ m/ 〉/ ./ (/ 5/ )/ E/ ./ 加密/ 消息/ :/ 〈/ -/ k/ ,/ -/ m/ ,/ +/ {/ m/ }/ k/ 〉/ ,/ k/ ∈/ Kenc/ ./ (/ 6/ )/ D/ ./ 解密/ 消息/ :/ 〈/ -/ k/ -/ 1/ ,/ -/ {/ m/ }/ k/ ,/ +/ m/ 〉/ ,/ k/ ∈/ Kenc/ ./ (/ 7/ )/ SI/ ./ 签名/ 消息/ :/ 〈/ -/ k/ ,/ -/ m/ ,/ +/ [/ m/ ]/ k/ 〉/ ,/ k/ ∈/ Ksig/ ./ (/ 8/ )/ VE/ ./ 验证/ 消息/ :/ 〈/ -/ k/ -/ 1/ ,/ -/ [/ m/ ]/ k/ ,/ +/ m/ 〉/ ,/ (/ 9/ )/ MI/ ./ 身份/ 生成/ :/ 〈/ -/ T/ ,/ -/ m/ ,/ +/ [/ m/ ]/ T/ 〉/ ,/ T/ ∈/ X/ ./ (/ 10/ )/ H/ ./ 哈希/ :/ 〈/ -/ m/ ,/ +/ h/ (/ m/ )/ 〉/ ,/ h/ ∈/ H/ ./ 我们/ 假定/ 只有/ 安全/ 芯片/ 才能/ 生成/ 平台/ 身份/ 信息/ ,/ 不过/ ,/ 任何/ 攻击者/ 只要/ 能/ 控制/ 一个/ 安全/ 芯片/ ,/ 其/ 也/ 能/ 生成/ 平台/ 身份/ 信息/ ,/ 因此/ 增加/ 了/ 攻击者/ MI/ 串/ ./ 读取/ 安全/ 芯片/ PCR/ 值/ 不/ 需要/ 任何/ 授权/ ,/ Quote/ 签名/ 只要/ 拥有/ 私钥/ 就/ 可以/ 进行/ ,/ 因此/ 增加/ 了/ SI/ 串/ 描述/ 攻击者/ 伪造/ 签名/ 或者/ 证书/ 的/ 能力/ ./ 只要/ 能/ 获取/ 平台/ 度量/ 日志/ ML/ ,/ 攻击者/ 也/ 能/ 生成/ 其/ 完整性/ 标识/ h/ (/ ML/ )/ ,/ 因此/ 增加/ 了/ 攻击者/ H/ 串/ ./ 如果/ 1/ 个/ 节点/ 位于/ 攻击者/ 串/ ,/ 则/ 称/ 其/ 为/ 攻击者/ 节点/ ;/ 否则/ ,/ 称为/ 正规/ 节点/ ./ 通常/ 一个/ 渗透/ 的/ 串/ 空间/ 既/ 包含/ 正规/ 串/ (/ 所有/ 合法/ 参与者/ 的/ 串/ )/ ,/ 也/ 包含/ 这里/ 定义/ 的/ 攻击者/ 串/ ./ 4.2/ 范式/ 引理/ 攻击者/ 行为/ 可以/ 通过/ 攻击者/ 串/ 的/ 任意/ 组合/ 来/ 实现/ ./ 不过/ ,/ 这会/ 导致/ 很多/ 冗余/ 的/ 丛/ ,/ 使得/ 协议/ 的/ 分析/ 变得复杂/ ./ 在/ 认证/ 测试方法/ 中/ ,/ Guttman/ 等/ 人/ [/ 18/ -/ 19/ ]/ 提出/ 了/ 丛/ 等价/ 和/ 范式/ 引理/ 来/ 限制/ 攻击者/ 串/ 的/ 组合/ 顺序/ ,/ 可以/ 在/ 不消/ 弱/ 攻击者/ 能力/ 的/ 情况/ 下/ ,/ 删除/ 攻击者/ 的/ 一些/ 冗余/ 行为/ ./ 由于/ 我们/ 对/ 攻击者/ 串/ 进行/ 了/ 扩展/ ,/ k/ ∈/ Ksig/ ./ Page8/ 引入/ 了/ 新/ 的/ 冗余/ 情况/ ,/ 本/ 节/ 主要/ 给出/ 冗余/ 消除/ 方法/ 以及/ 证明/ 扩展/ 后/ 的/ 范式/ 引理/ 依然/ 成立/ ./ 定义/ 14/ ./ 串/ 空间/ Σ/ 中/ 的/ 两个/ 丛/ C1/ 和/ C2/ 等价/ ,/ 当且/ 仅/ 当/ 它们/ 拥有/ 相同/ 的/ 正规/ 节点/ ./ 定义/ 15/ ./ 丛中/ 包含/ 4/ 种/ 类型/ 的/ 冗余/ :/ E/ -/ D/ 冗余/ 和/ C/ -/ S/ 冗余/ (/ 参考/ 认证/ 测试/ [/ 18/ -/ 19/ ]/ )/ ;/ SI/ -/ VE/ 冗余/ 和/ MI/ -/ VE/ 冗余/ (/ 如图/ 2/ 所示/ )/ ./ 定理/ 2/ ./ 每个/ 丛/ C1/ 都/ 存在/ 一个/ 没有/ 任何/ 冗余/ 的/ 等价/ 丛/ C2/ ./ 证明/ ./ 关于/ E/ -/ D/ 冗余/ 和/ C/ -/ S/ 冗余/ 的/ 消除/ 方法/ 见/ 参考文献/ [/ 19/ ]/ ./ 而/ 关于/ SI/ -/ VE/ 冗余/ 和/ MI/ -/ VE/ 冗余/ 的/ 消除/ 如图/ 3/ 所示/ ./ 通过/ 删除/ 冗余/ 中/ 的/ 攻击者/ 串/ VE/ ,/ 并/ 增加/ 相应/ 的/ 边/ (/ 虚线/ 箭头/ 表示/ )/ ,/ 删除/ 冗余/ 后/ ,/ 正规/ 节点/ 没有/ 变化/ ,/ 而且/ 新/ 生成/ 的/ 图/ 满足/ 丛/ 的/ 定义/ (/ 定义/ 10/ )/ ./ 因此/ ,/ 根据/ 定义/ 14/ ,/ 删除/ 冗余/ 生成/ 的/ 丛/ 与/ 原始/ 丛/ 等价/ ./ 攻击者/ 的/ 行为/ 在/ 认证/ 测试/ 中/ 通过/ 一条/ 路径/ (/ path/ )/ 来/ 描述/ ./ 一条/ 攻击者/ 路径/ 中/ ,/ 除了/ 首尾/ 节点/ ,/ 所有/ 其他/ 节点/ 都/ 是/ 攻击者/ 节点/ ./ 为了/ 限制/ 攻击者/ 路径/ 的/ 形式/ ,/ 使用/ 构造/ 边/ (/ constructiveedge/ )/ 和析/ 构边/ (/ destructiveedge/ )/ 的/ 概念/ 来/ 对/ 攻击者/ 串/ 进行/ 分类/ ./ 由于/ 引入/ 了/ 新/ 的/ 攻击者/ 串/ ,/ 我们/ 对/ 构造/ 边和析/ 构边/ 进行/ 了/ 重新/ 定义/ ./ 定义/ 16/ ./ 如果/ 一个/ / +/ 边/ 是/ E/ ,/ C/ ,/ SI/ ,/ MI/ 或者/ H/ 串/ 的/ 一部分/ ,/ 称其为/ 构造/ 边/ ;/ 如果/ 其是/ D/ ,/ S/ 或者/ VE/ 串/ 的/ 一部分/ ,/ 称其/ 为析/ 构边/ ./ 如果/ 1/ 个/ 攻击者/ 节点/ 是/ K/ 或者/ M/ 节点/ ,/ 称该/ 节点/ 为/ 初始/ 节点/ (/ initial/ )/ ./ 定义/ 17/ ./ 如果/ 对于/ 丛/ C/ 中/ 的/ 每条/ 攻击者/ 路径/ ,/ 每个/ 析/ 构边/ 都/ 领先/ 于/ (/ precede/ )/ 每个/ 构造/ 边/ ,/ 则/ 称/ 该/ 丛/ 是/ 正常/ 丛/ (/ normalbundle/ )/ ./ 定理/ 3/ ./ 攻击者/ 范式/ 引理/ ./ 每个/ 丛/ C1/ 都/ 存在/ 1/ 个/ 等价/ 的/ 正常/ 丛/ C2/ ./ 证明/ ./ 没有/ SI/ ,/ MI/ ,/ VE/ 和/ H/ 串/ 的/ 范式/ 引理/ 在/ 文献/ [/ 19/ ]/ 中/ 已经/ 得到/ 证明/ ./ 我们/ 主要/ 考虑/ 扩展/ 的/ 攻击者/ 串/ 的/ 影响/ ./ 由于/ 哈希/ 函数/ 的/ 不/ 可逆/ 特性/ ,/ H/ 串/ 的/ 输出/ 无法/ 传给/ 一个/ 析/ 构边/ ./ 而/ 对于/ SI/ 串/ ,/ 其/ 输出/ 只能/ 传给/ D/ 串/ 或者/ VE/ 串/ ,/ 但是/ 由于/ Ksig/ 和/ Kenc/ 是/ 不/ 相交/ 的/ ,/ D/ 串/ 无法/ 处理/ 签名/ 的/ 形式/ ,/ 故/ SI/ 串/ 的/ 输出/ 只能/ 传给/ VE/ 串/ ./ MI/ 串中/ ,/ SKsig/ (/ T/ )/ 是/ 签名/ 密钥/ ,/ 故其/ 输出/ 也/ 只能/ 传给/ VE/ 串/ ./ 而/ 对于/ VE/ 串/ ,/ 其/ 只/ 接受/ 签名/ 类型/ 的/ 密钥/ 和/ 消息/ ,/ 故其/ 输入/ 无法/ 由/ E/ ,/ C/ 和/ H/ 串/ 提供/ ./ 因此/ ,/ 新/ 增加/ 的/ 攻击者/ 串/ 除了/ 4/ 个/ 冗余/ 外/ ,/ 没有/ 引入/ 新/ 的/ 构造/ 边/ 立即/ 领先/ 于析/ 构边/ 的/ 情形/ ./ 而/ 根据/ 定理/ 2/ ,/ 4/ 个/ 冗余/ 消除/ 后/ 可/ 产生/ 等价/ 丛/ ./ 证毕/ ./ 4.3/ 认证/ 测试方法/ 本/ 节/ 介绍/ 的/ 技术/ 可以/ 用于/ 证明/ 协议/ 的/ 机密性/ 和/ 认证/ 性/ ./ 首先/ 定义/ 安全/ 消息/ ,/ 然后/ 提出/ 4/ 个/ 认证/ 测试/ 准则/ ./ 由于/ 对串/ 空间/ 模型/ 进行/ 了/ 扩展/ ,/ 本节/ 的/ 定义/ 和/ 准则/ 与/ 原始/ 串/ 空间/ 不同/ ./ 4.3/ ./ 1/ 安全/ 消息/ 在/ 扩展/ 的/ 串/ 空间/ 模型/ 中/ ,/ 1/ 个/ 密钥/ 是/ 安全/ 的/ 应该/ 至少/ 满足/ 如下/ 3/ 点/ :/ 首先/ ,/ 该/ 密钥/ 不能/ 在/ 攻击者/ 的/ 初始/ 知识/ 集合/ 中/ ;/ 其次/ ,/ 协议/ 消息/ 交互/ 时/ 只会/ 出现/ 在/ 加密/ 的/ 形式/ 或者/ 哈希/ 的/ 形式/ 中/ ;/ 最后/ ,/ 如果/ 其/ 存储/ 在/ 安全/ 芯片/ 中/ ,/ 且/ 不会/ 在/ 安全/ 芯片/ 外部/ 使用/ ,/ 那么/ 该/ 密钥/ 是/ 安全/ 的/ ./ 下面/ 采用/ 递归/ 的/ 方式/ 定义/ 安全/ 密钥/ ./ 定义/ 18/ ./ 安全/ 密钥/ ./ 设/ S0/ 是/ 满足/ 如下/ 条件/ 的/ 密钥/ k/ 的/ 集合/ :/ (/ 1/ )/ k/ / KP/ ∪/ MP/ 或者/ k/ ∈/ {/ SK/ (/ T/ )/ |/ T/ ∈/ X/ }/ ;/ (/ 2/ )/ 不/ 存在/ 正/ 号/ 正规/ 节点/ n/ ∈/ Σ/ 和/ 消息/ 项/ t/ ,/ 满足/ t/ 是/ n/ 的/ 一个/ 新/ 组件/ 且/ k/ / t/ ./ 设/ Si/ +/ 1/ 是/ 满足/ 如下/ 条件/ 密钥/ k/ 的/ 集合/ :/ (/ 1/ )/ k/ / KP/ ∪/ MP/ 或者/ k/ ∈/ {/ SK/ (/ T/ )/ |/ T/ ∈/ X/ }/ ;/ (/ 2/ )/ 对于/ 每个/ 正/ 号/ 正规/ 节点/ n/ ∈/ Σ/ 及其/ 新/ 组件/ t/ ,/ k/ 在/ t/ 中/ 的/ 发生/ 只能/ 是/ 在/ 加密/ (/ {/ …/ k/ …/ }/ k0/ ,/ k0/ -/ 1/ ∈/ Si/ )/ 或者/ 哈希/ (/ h/ (/ …/ k/ …/ )/ )/ 的/ 保护/ 形式/ 中/ ./ 设/ S/ =/ ∪/ iSi/ ,/ 如果/ k/ ∈/ S/ ,/ 那么/ k/ 在/ 串/ 空间/ Σ/ 中是/ 安全/ 密钥/ ./ 定义/ 19/ ./ 首先/ 安全/ 密钥/ 是/ 安全/ 消息/ ;/ 其次/ 如果/ 消息/ m/ 在/ 串/ 空间/ Σ/ 中/ 只/ 发生/ 在/ 安全/ 密钥/ 加密/ 保护/ 的/ 消息/ 项/ 或者/ 哈希/ 项/ h/ (/ m/ )/ 中/ ,/ 则/ m/ 也/ 为/ 安全/ 消息/ ./ 定理/ 4/ ./ 设/ C0/ 是/ 一个/ 丛/ ,/ r/ 是/ 一个/ 原子/ 项/ ,/ 且/ 满足/ r/ 是/ 一个/ 安全/ 密钥/ 或者/ 安全/ 消息/ ,/ 那么/ 对于/ 所有/ 的/ 等价/ 丛/ C1/ ,/ 不/ 存在/ 满足/ term/ (/ n/ )/ =/ r/ 的/ 节点/ n/ ./ 定理/ 4/ 的/ 证明/ 在/ 文献/ [/ 21/ ]/ 中/ 已经/ 给出/ ,/ 只/ 需要/ 增加/ 一点/ ,/ 即/ 如果/ 安全/ 密钥/ 或者/ 安全/ 消息/ r/ 长期/ 存/ Page9/ 储在/ 安全/ 芯片/ T/ 中/ ,/ 则/ 显然/ 消息/ 项中/ 不会/ 出现/ r/ ./ 通常/ 协议/ 的/ 机密性/ 可以/ 通过/ 证明/ 相关/ 密钥/ 在/ Si/ 中来/ 获得/ ,/ 对于/ 大部分/ 协议/ ,/ i/ =/ 0/ 或者/ 1/ ;/ 或者/ 通过/ 证明/ 相关/ 消息/ 是/ 安全/ 消息/ (/ 如/ 后面/ 度量/ 日志/ ML/ 的/ 机密性/ 分析/ )/ ./ 4.3/ ./ 2/ 认证/ 测试/ 认证/ 测试/ 是/ 基于/ 串/ 空间/ 理论/ 提炼/ 出来/ 的/ 高级/ 推理/ 准则/ ,/ 该/ 准则/ 使得/ 安全/ 协议/ 的/ 认证/ 性/ 分析/ 变得/ 简单/ ./ 认证/ 测试/ [/ 18/ -/ 20/ ]/ 阐述/ 了/ 丛中/ 推理/ 正规/ 节点/ 和/ 正规/ 串/ 的/ 条件/ ,/ 主要/ 包含/ 传出/ 测试/ (/ outgoingtest/ )/ 和/ 传入/ 测试/ (/ incomingtest/ )/ ./ 安全/ 协议/ 通常/ 通过/ 挑战/ // 响应/ 的/ 方式/ 来/ 获得/ 认证/ 性/ ,/ 认证/ 测试/ 是/ 基于/ 该/ 事实/ 建立/ 的/ ./ 本节/ 给出/ 并/ 证明/ 扩展/ 的/ 串/ 空间/ 模型/ 的/ 认证/ 测试方法/ ./ 加密/ 测试/ ./ 设/ n0/ 和/ n1/ (/ n0/ / +/ n1/ )/ 是/ 丛/ C/ 的/ 两个/ 节点/ ,/ a/ 唯一/ 源于/ 节点/ n0/ ,/ 且/ a/ 在/ n0/ 处/ 只/ 发生/ 在/ 其/ 组件/ t0/ =/ {/ h/ }/ k/ ,/ k/ -/ 1/ ∈/ Kenc/ ∩/ S/ 中/ ,/ 同时/ a/ 在/ n1/ 处/ 只/ 发生/ 在/ 其/ 一个/ 新/ 组件/ t1/ 中/ ./ 那么/ ,/ 一定/ 存在/ 一个/ 正/ 号/ 正规/ 节点/ m1/ 满足/ t1/ 源于/ m1/ ;/ 而且/ 存在/ 一个/ 节点/ m0/ 满足/ a/ / term/ (/ m0/ )/ ,/ 且/ n0/ / Cm0/ / +/ m1/ / Cn1/ ./ 该/ 加密/ 测试/ 与/ 传出/ 测试/ 一致/ ,/ 证明/ 过程/ 已经/ 在/ 文献/ [/ 9/ ]/ 中/ 给出/ ./ 该/ 测试/ 主要/ 说明/ 只有/ 拥有/ 安全/ 私钥/ 的/ 正规/ 串/ 才能/ 解密/ a/ ,/ 并/ 生成/ a/ 的/ 一个/ 新/ 组件/ ./ 签名/ 测试/ ./ 设/ n/ 是/ 丛/ C/ 的/ 一个/ 负号/ 节点/ ,/ t/ =/ [/ h/ ]/ k/ / term/ (/ n/ )/ 是/ n/ 的/ 一个/ 新/ 组件/ 且/ 满足/ k/ ∈/ Ksig/ ∩/ S/ ./ 那么/ ,/ 一定/ 存在/ 一个/ 正规/ 节点/ m/ / Cn/ 满足/ t/ 源于/ m/ ./ 证明/ ./ 设/ 集合/ D/ =/ {/ n0/ ∈/ C/ |/ t/ / term/ (/ n0/ )/ }/ ./ 显然/ D/ 是/ 一个/ 非/ 空集合/ ,/ 因为/ n/ ∈/ D/ ,/ 由/ 定理/ 1/ 可知/ ,/ D/ 存在/ / C/ -/ 最小/ 元/ ,/ 记为/ m/ ./ 下面/ 采用/ 反证法/ ,/ 假设/ m/ 是/ 一个/ 攻击者/ 节点/ ,/ 由/ t/ / term/ (/ m/ )/ 可以/ 推出/ m/ 只能/ 是/ SI/ 串上/ 的/ 正/ 号/ 节点/ ,/ 其/ 密钥/ 边为/ k/ ,/ 这/ 显然/ 与/ k/ ∈/ S/ 矛盾/ ./ 因此/ ,/ m/ 只能/ 是/ 一个/ 正规/ 节点/ ./ 而且/ m/ 是/ D/ 的/ 最小/ 元/ ,/ 由/ 定义/ 4/ 可知/ t/ 源于/ m/ ./ 证毕/ ./ 身份/ 测试/ ./ 设/ n/ 是/ 丛/ C/ 的/ 一个/ 负号/ 节点/ ,/ g/ =/ [/ h/ ]/ T/ / term/ (/ n/ )/ 是/ n/ 的/ 一个/ 新/ 组件/ 且/ 满足/ T/ ∈/ X/ ,/ SKsig/ (/ T/ )/ ∈/ Ksig/ ∩/ S/ ./ 那么/ ,/ 一定/ 存在/ 一个/ 正规/ 节点/ m/ / Cn/ 满足/ g/ 源于/ m/ ./ 证明/ ./ 身份/ 测试/ 类似/ 签名/ 测试/ ,/ 其/ 证明/ 过程/ 与/ 签名/ 测试/ 类似/ ./ 不过/ 身份/ 测试/ 主要/ 用来/ 确认/ 一个/ 合法/ 安全/ 芯片/ T/ 的/ 存在/ ./ 哈希/ 测试/ ./ 设/ n/ 是/ 丛/ C/ 的/ 一个/ 节点/ ,/ t/ =/ h/ (/ g/ )/ ∈/ term/ (/ n/ )/ 是/ 其/ 一个/ 新/ 组件/ ,/ 且/ g/ 是/ 安全/ 消息/ ./ 则/ 一定/ 存在/ 1/ 个/ 正规/ 节点/ m/ / Cn/ 满足/ t/ 源于/ m/ ./ 证明/ ./ 设/ 集合/ D/ =/ {/ n0/ ∈/ C/ |/ t/ / term/ (/ n0/ )/ }/ ./ 显然/ D/ 是/ 一个/ 非/ 空集合/ ,/ 因为/ n/ ∈/ D/ ,/ 由/ 定理/ 1/ 可知/ ,/ D/ 存在/ / C/ -/ 最小/ 元/ ,/ 记为/ m/ ./ 如果/ m/ 是/ 一个/ 攻击者/ 节点/ ,/ 则/ 只/ 可能/ 发生/ 在/ H/ 串中/ ,/ 而/ m/ 是/ 安全/ 消息/ ,/ 攻击者/ 无法/ 生成/ h/ (/ m/ )/ ,/ 否则/ 违背/ 了/ 哈希/ 函数/ 的/ 抗/ 碰撞/ 攻击/ 特性/ ./ 因此/ ,/ m/ 只能/ 是/ 一个/ 正规/ 节点/ ./ 证毕/ ./ 4.3/ ./ 3/ 机密性/ 和/ 认证/ 性/ 分析/ 一个/ 正规/ 串/ 表示/ 协议/ 执行/ 中/ 一个/ 合法/ 参与者/ 的/ 本地/ 视图/ ,/ 即该/ 参与者/ 发送/ 和/ 接受/ 消息/ 的/ 所有/ 行为/ ./ 串/ 空间/ 分析/ 的/ 思路/ 是从/ 一个/ 合法/ 参与者/ 的/ 角度/ 出发/ ,/ 推断/ 其他/ 参与者/ 串/ 和/ 可能/ 的/ 攻击者/ 行为/ ./ 认证/ 性是/ 推断/ 其他/ 合法/ 参与者/ 已经/ 执行/ 的/ 行为/ ./ 推断/ 过程/ 依赖/ 4/ 个/ 方面/ 的/ 元素/ [/ 19/ ]/ :/ 该/ 合法/ 参与者/ 对应/ 的/ 正规/ 串/ 、/ 协议/ 的/ 规范/ 描述/ (/ 即/ 所有/ 定义/ 的/ 正规/ 串/ )/ 、/ 攻击者/ 能力/ 和/ 一些/ 源/ 假设/ (/ 如/ 唯一/ 源于/ 的/ 随机数/ 和/ 非/ 源于/ 的/ 安全/ 密钥/ 等/ )/ ./ 丛中/ 定义/ 的/ 因果关系/ 可以/ 用来/ 推理/ 其他/ 串/ 的/ 轨迹/ ./ 一个/ 典型/ 的/ 认证/ 性/ 定义/ 如下/ ./ 定义/ 20/ ./ 认证/ 性/ ./ 对于/ 所有/ 的/ 丛/ C/ 和/ 串/ s0/ ,/ 如果/ s0/ 在/ C/ 中/ 的/ 丛高为/ i/ ,/ 并且/ 一些/ 源/ 假设/ 成立/ ,/ 那么/ 丛/ C/ 中/ 存在/ 一个/ 丛高为/ j/ 的/ 正规/ 串/ s1/ ./ 机密性/ 是/ 推断/ 攻击者/ 不/ 可能/ 执行/ 的/ 行为/ (/ 如/ 无法/ 获取/ 某个/ 值/ )/ ,/ 一个/ 典型/ 的/ 机密性/ 定义/ 如下/ ./ 定义/ 21/ ./ 机密性/ ./ 对于/ 所有/ 的/ 丛/ C/ 和/ 所有/ 正规/ 串/ s/ ,/ 如果/ s/ 丛高为/ i/ ,/ 并且/ 一些/ 源/ 假设/ 成立/ ,/ 那么/ 不/ 存在/ 任何/ 节点/ n/ ∈/ C/ 使得/ term/ (/ n/ )/ =/ t/ ./ 认证/ 性是/ 丛/ 等价/ 下/ 的/ 不/ 变量/ ,/ 因为/ 其/ 只/ 断言/ 一些/ 正规/ 串/ 的/ 存在/ ./ 如果/ 机密性/ 在/ 所有/ C/ 的/ 等价/ 丛中/ 成立/ ,/ 那么/ t/ 值/ 的/ 机密性/ 就/ 成立/ ./ 根据/ 定理/ 4/ ,/ t/ 值/ 的/ 机密性/ 主要/ 依赖于/ 证明/ t/ ∈/ Si/ ./ 5/ 远程/ 证明/ 协议/ 分析/ 本节/ 的/ 分析/ 在/ 远程/ 证明/ RA/ 串/ 空间/ 中/ 进行/ ./ RA/ 串/ 空间/ 包含/ 定义/ 5/ 到/ 定义/ 9/ 给出/ 的/ 正规/ 串/ 以及/ 定义/ 13/ 给出/ 的/ 攻击者/ 串/ ./ 首先/ 给出/ 可信计算/ 远程/ 证明/ 协议/ 安全/ 目标/ 的/ 形式化/ 定义/ (/ 基于/ 定义/ 20/ 和/ 21/ )/ ;/ 其次/ ,/ 分析/ 远程/ 证明/ 协议/ 依赖/ 的/ 公钥/ 基础设施/ 的/ 正确性/ ;/ 最后/ ,/ 分别/ 从/ 证明/ 者/ (/ 本地/ 平台/ 的/ 安全/ 芯片/ 与/ 用户/ 进程/ )/ 和/ 验证/ 者/ 的/ 角度/ 对/ 远程/ 证明/ 协议/ 进行/ 分析/ ./ 5.1/ 安全/ 属性/ 本/ 节/ 基于/ 扩展/ 的/ 串/ 空间/ 模型/ 对/ 3.3/ 节/ 描述/ 的/ 远程/ 证明/ 协议/ 安全/ 目标/ 进行/ 了/ 形式化/ 定义/ ,/ 如下/ 所示/ (/ 目标/ 1/ ~/ 目标/ 5/ )/ :/ 目标/ 1/ (/ 隐私/ 性/ )/ ./ 设/ C/ 是/ RA/ 串/ 空间/ Σ/ 中/ 的/ 一个/ Page10/ 丛/ ,/ 且/ su/ ∈/ User/ [/ T/ ,/ U/ ,/ / ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ / ,/ / ]/ 是/ 一个/ 正规/ 用户/ 进程/ 串/ ,/ 满足/ SK/ (/ PCA/ )/ / KP/ ./ 那么/ :/ (/ 1/ )/ 丛中/ 不/ 存在/ 节点/ n/ 满足/ term/ (/ n/ )/ =/ EK/ ‖/ AIK/ ;/ (/ 2/ )/ 如果/ 丛中/ 存在/ 节点/ m/ 满足/ term/ (/ m/ )/ =/ {/ …/ EK/ …/ }/ k/ ,/ 则/ k/ =/ PK/ (/ PCA/ )/ ./ 目标/ 2/ (/ PrivacyCA/ 认证/ 性/ )/ ./ 设/ C/ 是/ RA/ 串/ 空间/ Σ/ 中/ 的/ 一个/ 丛/ ,/ sp/ ∈/ PrivacyCA/ [/ T/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ]/ 是/ 一个/ 丛高/ 至少/ 为/ 1/ 的/ 正规/ 隐私/ 证书/ 权威/ 串/ ,/ 且/ AIK/ -/ 1/ ∈/ {/ SKsig/ (/ T/ )/ |/ T/ ∈/ X/ }/ ./ 那么/ 必定/ 存在/ 唯一/ 的/ 丛高/ 至少/ 为/ 2/ 的/ 正规/ 安全/ 芯片/ 串/ st/ ∈/ TPM/ [/ T/ ,/ / ,/ / ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ / ,/ / ]/ ./ 目标/ 3/ (/ Verifier/ 认证/ 性/ )/ ./ 设/ C/ 是/ RA/ 串/ 空间/ Σ/ 中/ 的/ 一个/ 丛/ ,/ 且/ sv/ ∈/ Verifier/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ L/ ,/ AIK/ ,/ ML/ ,/ NV/ ]/ 是/ 一个/ 丛高/ 至少/ 为/ 2/ 的/ 远程/ 验证/ 者/ 串/ ,/ NV/ 唯一/ 源于/ 〈/ sv/ ,/ 1/ 〉/ 且/ SK/ (/ PCA/ )/ / KP/ ,/ AIK/ -/ 1/ ∈/ {/ SKsig/ (/ T/ )/ |/ T/ ∈/ X/ }/ ./ 那么/ 必定/ 存在/ 唯一/ 的/ 丛高/ 至少/ 为/ 6/ 的/ 正规/ 安全/ 芯片/ 串/ st/ ∈/ TPM/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ / ,/ L/ ,/ AIK/ ,/ / ,/ ML/ ,/ NV/ ]/ 和/ 一个/ 丛高/ 至少/ 为/ 10/ 的/ 正规/ 用户/ 进程/ 串/ su/ ∈/ User/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ / ,/ L/ ,/ AIK/ ,/ / ,/ ML/ ,/ NV/ ]/ ./ 目标/ 4/ (/ ML/ 的/ 机密性/ )/ ./ 设/ C/ 是/ RA/ 串/ 空间/ Σ/ 中/ 的/ 一个/ 丛/ ,/ 且/ su/ ∈/ User/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ ML/ ,/ NV/ ]/ 是/ 一个/ 正规/ 用户/ 进程/ 串/ ,/ 满足/ SK/ (/ V/ )/ / KP/ ./ 那么/ ,/ 丛中/ 不/ 存在/ 节点/ n/ 满足/ term/ (/ n/ )/ =/ ML/ ./ 目标/ 5/ (/ 用户/ 的/ 认证/ 性/ )/ ./ 设/ C/ 是/ RA/ 串/ 空间/ Σ/ 中/ 的/ 一个/ 丛/ ,/ 且/ su/ ∈/ User/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ MF/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ ML/ ,/ NV/ ]/ 是/ 一个/ 丛/ 高大/ 于/ 0/ 的/ 正规/ 用户/ 进程/ 串/ ,/ 满足/ SK/ (/ V/ )/ / KP/ ./ 那么/ ,/ 丛中/ 必定/ 存在/ 丛/ 高大/ 于/ 0/ 的/ 正规/ 远程/ 验证/ 者/ 串/ sv/ ∈/ Verifier/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ L/ ,/ AIK/ ,/ ML/ ,/ NV/ ]/ ./ 下面/ 将/ 分别/ 针对/ 这些/ 目标/ ,/ 对/ 可信计算/ 远程/ 证明/ 协议/ 进行/ 分析/ ./ 5.2/ 证书/ 分析/ 基于/ PKI/ 证书/ ,/ 可以/ 建立/ 协议/ 参与/ 主体/ 与其/ 公钥/ 的/ 关联性/ ./ EK/ 证书/ 可以/ 将/ EK/ 公钥/ 与/ 一个/ 唯一/ 的/ 安全/ 芯片/ T/ 进行/ 关联/ ,/ 在/ 扩展/ 的/ 串/ 空间/ 模型/ 中/ ,/ 可以/ 使用/ 如下/ 定理/ 来/ 描述/ 一个/ EK/ 证书/ :/ 定理/ 5/ ./ 设/ C/ 是/ Σ/ 中/ 的/ 一个/ 丛/ ./ 对于/ 每个/ 节点/ n/ ∈/ C/ 和/ 每个/ EK/ 证书/ [/ a/ ‖/ pk/ ‖/ b/ ]/ sk/ / term/ (/ n/ )/ ,/ a/ ∈/ X/ ,/ b/ ∈/ M/ ,/ 那么/ 或者/ pk/ =/ PKenc/ (/ a/ )/ ,/ sk/ =/ SK/ (/ b/ )/ 或者/ sk/ ∈/ KP/ 成立/ ./ 证明/ ./ 一个/ EK/ 证书/ [/ a/ ‖/ pk/ ‖/ b/ ]/ sk/ 可以/ 源于/ 如下/ 两个/ 串/ :/ (/ 1/ )/ 一个/ 正规/ 厂商/ 串/ Manufacturer/ [/ b/ ,/ a/ ,/ pk/ ]/ ./ 正规/ 厂商/ 串/ 表示/ 一个/ 合法/ 的/ 厂商/ 角色/ ,/ 其/ 私钥/ 不会/ 泄露/ ,/ 即/ sk/ =/ SK/ (/ b/ )/ / KP/ ,/ 同时/ 厂商/ 可以/ 担保/ pk/ 和/ a/ 的/ 关联性/ ,/ 即/ pk/ =/ PKenc/ (/ a/ )/ ./ (/ 2/ )/ 一个/ 攻击者/ SI/ 串/ ./ SI/ 串/ 需要/ 攻击者/ 拥有/ 相应/ 的/ 签名/ 私钥/ ,/ 即/ sk/ ∈/ KP/ ./ AIK/ 证书/ 可以/ 保证/ AIK/ 公钥/ 来自/ 一个/ 合法/ 的/ 安全/ 芯片/ ,/ 但/ 无法/ 关联/ 具体/ 的/ 安全/ 芯片/ ./ 通过/ 如下/ 定理/ 来/ 描述/ 一个/ AIK/ 证书/ :/ 定理/ 6/ ./ 设/ C/ 是/ Σ/ 中/ 的/ 一个/ 丛/ ./ 对于/ 每个/ 节点/ n/ ∈/ C/ 和/ 每个/ AIK/ 证书/ [/ a/ ‖/ pk/ ‖/ b/ ]/ sk/ / term/ (/ n/ )/ ,/ a/ ,/ b/ ∈/ M/ ,/ 那么/ 或者/ 存在/ 一个/ t/ ∈/ X/ 满足/ pk/ =/ PKsig/ (/ t/ )/ ,/ sk/ =/ SK/ (/ b/ )/ 或者/ sk/ ∈/ KP/ 成立/ ./ 证明/ ./ 一个/ AIK/ 证书/ [/ a/ ‖/ pk/ ‖/ b/ ]/ sk/ 可以/ 源于/ 如下/ 两个/ 串/ :/ (/ 1/ )/ 一个/ 正规/ PrivacyCA/ 串/ PrivacyCA/ [/ / ,/ b/ ,/ / ,/ a/ ,/ pk/ ,/ / ]/ ./ Privacy/ 作为/ 一个/ 可信/ 方/ ,/ 可以/ 担保/ pk/ 来自/ 一个/ 合法/ 的/ 安全/ 芯片/ ,/ 即/ 存在/ 一个/ t/ ∈/ X/ 满足/ pk/ =/ PKsig/ (/ t/ )/ ./ (/ 2/ )/ 一个/ 攻击者/ SI/ 串/ ./ SI/ 串/ 需要/ 攻击者/ 拥有/ 相应/ 的/ 签名/ 私钥/ ,/ 即/ sk/ ∈/ KP/ ./ 下面/ 从/ PrivacyCA/ 的/ 角度/ 分析/ 其/ 认证/ 性/ ,/ 即/ 目标/ 2/ 描述/ 的/ 安全/ 属性/ ./ 目标/ 2/ 分析/ (/ PrivacyCA/ 认证/ 性/ )/ ./ 设/ 节点/ n/ =/ 〈/ sp/ ,/ 1/ 〉/ ./ 由/ AIK/ -/ 1/ ∈/ {/ SKsig/ (/ T/ )/ |/ T/ ∈/ X/ }/ ,/ 可知/ 存在/ 安全/ 芯片/ T0/ 满足/ AIK/ -/ 1/ =/ SKsig/ (/ T0/ )/ ,/ I/ =/ [/ AIK/ ‖/ L/ ‖/ PCA/ ]/ T0/ ./ 显然/ I/ 是/ 节点/ n/ 的/ 一个/ 新/ 组件/ ,/ 根据/ “/ 身份/ 测试/ ”/ 准则/ ,/ 一定/ 存在/ 一个/ 正规/ 节点/ m/ / Cn/ 满足/ I/ 源于/ m/ ./ 正规/ 节点/ m/ 一定/ 位于/ 定义/ 5/ 到/ 定义/ 9/ 规定/ 的/ 正规/ 串中/ ,/ 显然/ m/ 是/ 某个/ 正规/ 安全/ 芯片/ 串/ 的/ 第/ 2/ 个/ 节点/ ,/ 即/ 存在/ 丛高/ 至少/ 为/ 2/ 的/ 串/ st/ ∈/ TPM/ [/ T0/ ,/ / ,/ / ,/ PCA/ ,/ MF0/ ,/ L/ ,/ AIK/ ,/ EK0/ ,/ / ,/ / ]/ ./ 由于/ AIK/ 由/ 安全/ 芯片/ 唯一/ 生成/ ,/ 即/ AIK/ 唯一/ 源于/ 安全/ 芯片/ 串/ ,/ 故串/ st/ 是/ 唯一/ 的/ ./ 另外/ ,/ cert/ (/ EK/ )/ =/ [/ T/ ‖/ EK/ ‖/ MF/ ]/ SK/ (/ MF/ )/ / n/ ,/ 安全/ 芯片/ 厂商/ MF/ 是/ 可信/ 方/ ,/ 故/ SK/ (/ MF/ )/ / KP/ ./ 由/ 定理/ 5/ 可知/ ,/ EK/ =/ PKenc/ (/ T/ )/ ,/ PrivacyCA/ 可以/ 确定/ EK/ 是/ 厂商/ MF/ 为/ 安全/ 芯片/ T/ 签发/ 的/ 身份/ ./ 但是/ ,/ 我们/ 无法/ 确定/ T/ =/ T0/ 是否/ 成立/ ,/ 这样/ 可能/ 会/ 出现/ 攻击者/ 使用/ 其他/ 芯片/ 的/ EK/ 证书/ 来/ 欺骗/ PrivacyCA/ ./ 改进/ 方法/ :/ 使用/ I/ =/ [/ EK/ ‖/ AIK/ ‖/ L/ ‖/ PCA/ ]/ T/ 作为/ 安全/ 芯片/ 生成/ 的/ 身份/ 信息/ ,/ 将/ EK/ 和/ AIK/ 进行/ 捆绑/ 认证/ ./ 改进/ 方法/ 证明/ :/ 通过/ I/ 可以/ 确定/ 丛高/ 至少/ 为/ 2/ 的/ 串/ st/ ∈/ TPM/ [/ T0/ ,/ / ,/ / ,/ PCA/ ,/ MF0/ ,/ L/ ,/ AIK/ ,/ EK/ ,/ Page11/ / ,/ / ]/ 的/ 存在/ (/ 根据/ 身份/ 测试/ 准则/ )/ ,/ 即/ EK/ =/ EK0/ ;/ 而/ 通过/ cert/ (/ EK/ )/ ,/ 可以/ 进一步/ 确定/ T/ =/ T0/ 和/ MF/ =/ MF0/ ,/ 这样/ 目标/ 2/ 成立/ ./ 5.3/ 从/ 证明/ 者/ 的/ 角度/ 分析/ 从/ 证明/ 者/ 的/ 角度/ ,/ 其/ 主要/ 关心/ 隐私/ 性/ 、/ ML/ 的/ 机密性/ 和/ 用户/ 的/ 认证/ 性/ ./ 下面/ 依次/ 分析/ 这/ 3/ 个/ 属性/ ./ 目标/ 1/ 分析/ (/ 隐私/ 性/ )/ ./ 根据/ 定理/ 4/ ,/ 我们/ 只/ 需要/ 证明/ EK/ ∈/ Si/ 或者/ AIK/ ∈/ Si/ 在/ 串/ 空间/ Σ/ 中/ 成立/ ,/ 就/ 可以/ 证明/ 丛/ C/ 不/ 存在/ 满足/ term/ (/ n/ )/ =/ EK/ ‖/ AIK/ 的/ 节点/ n/ ./ 首先/ ,/ EK/ 是/ 公钥/ ,/ 不/ 满足/ EK/ ∈/ S0/ ;/ 其次/ EK/ / [/ T/ ‖/ EK/ ‖/ MF/ ]/ SK/ (/ MF/ )/ 发生/ 在/ 节点/ 〈/ su/ ,/ 3/ 〉/ 中/ ,/ 没有/ 加密/ 或者/ 哈希/ 的/ 保护/ 形式/ ,/ 不/ 符合/ Si/ 的/ 递归/ 定义/ (/ 定义/ 18/ )/ ./ 同理/ AIK/ ∈/ Si/ 也/ 不/ 成立/ ./ 因此/ ,/ 隐私/ 性/ 并/ 不/ 成立/ ./ 改进/ 方法/ :/ 在/ 节点/ 〈/ su/ ,/ 3/ 〉/ 中/ 发送/ cert/ (/ EK/ )/ 时/ ,/ 改进/ 方法/ 证明/ ./ 只要/ K/ ∈/ S/ ,/ 或者/ SK/ (/ V/ )/ ∈/ S/ 成立/ ,/ 根据/ 定义/ 19/ 和/ 定理/ 4/ ,/ 可以/ 确定/ 对于/ C/ 的/ 所有/ 等价/ 丛/ C1/ ,/ ML/ 只/ 出现/ 在/ 安全/ 密钥/ 的/ 加密/ 形式/ 中/ ,/ 不/ 存在/ 满足/ term/ (/ n/ )/ =/ ML/ 的/ 节点/ n/ ./ 这样/ ML/ 的/ 机密性/ 成立/ ./ 目标/ 5/ 分析/ (/ 用户/ 的/ 认证/ 性/ )/ ./ 协议/ 中/ 用户/ 进程/ 串/ su/ 接收/ 到/ 的/ 唯一/ 与/ V/ 相关/ 的/ 组件/ 为/ NV/ ,/ 该/ 组件/ 无法/ 使用/ 任何/ 认证/ 测试/ 准则/ ,/ 即/ 无法/ 确认/ 一个/ 正规/ 远程/ 验证/ 者/ 串/ sv/ 的/ 存在/ ./ 改进/ 方法/ :/ 基于/ “/ 加密/ 测试/ ”/ 或者/ “/ 签名/ 测试/ ”/ 准/ 使用/ 公钥/ PK/ (/ PCA/ )/ 来/ 加密/ 保护/ cert/ (/ EK/ )/ ./ 改进/ 方法/ 证明/ ./ 首先/ 丛中/ 不/ 存在/ 节点/ n/ 满足/ term/ (/ n/ )/ =/ EK/ ;/ 其次/ ,/ EK/ 只/ 出现/ 在/ 消息/ {/ cert/ (/ EK/ )/ }/ PK/ (/ PCA/ )/ 中/ ,/ 由于/ SK/ (/ PCA/ )/ ∈/ S0/ ,/ 根据/ 定义/ 18/ ,/ 故/ EK/ ∈/ S1/ ./ 这样/ 隐私/ 性才/ 成立/ ./ 即便/ EK/ 证书/ 本身/ 是/ 公开/ 的/ ,/ 但/ 攻击者/ 无法/ 将/ 其/ 与/ 一个/ 特定/ 的/ AIK/ 关联/ ,/ 也/ 就/ 无法/ 破坏/ 隐私/ 性/ ./ 目标/ 4/ 分析/ (/ ML/ 的/ 机密性/ )/ ./ 根据/ 定义/ 18/ 和/ 定理/ 4/ ,/ 类似/ 隐私/ 性/ 的/ 分析/ ,/ 很/ 容易/ 确定/ ML/ 的/ 机密性/ 不/ 成立/ ./ 如果/ 在/ 丛/ C/ 中/ 增加/ 一个/ 攻击者/ s/ 串/ 〈/ -/ Q/ ‖/ ML/ ‖/ cert/ (/ AIK/ )/ ,/ +/ Q/ ,/ +/ ML/ ,/ +/ cert/ (/ AIK/ )/ 〉/ ,/ 并/ 增加/ 一个/ 攻击者/ c/ 串/ 〈/ -/ Q/ ,/ -/ ML/ ,/ -/ cert/ (/ AIK/ )/ ,/ +/ Q/ ‖/ ML/ ‖/ cert/ (/ AIK/ )/ 〉/ ,/ 且/ 没有/ 影响/ 到/ 任何/ 正规/ 节点/ ,/ 显然/ 得到/ 丛/ C/ 的/ 等价/ 正常/ 丛/ (/ 定义/ 14/ 和/ 定义/ 17/ )/ ,/ 这样/ term/ (/ 〈/ s/ ,/ 3/ 〉/ )/ =/ ML/ ,/ 破坏/ 了/ ML/ 的/ 机密性/ ./ 改进/ 方法/ :/ 在/ 用户/ 进程/ U/ 和/ 远程/ 验证/ 者/ V/ 之间/ 协商/ 一个/ 会话/ 密钥/ K/ 来/ 加密/ 传送/ ML/ ,/ 或者/ 直接/ 使用/ V/ 的/ 公钥来/ 加密/ 传送/ ML/ ./ 则/ ,/ 可以/ 设计/ 一个/ 满足用户/ 认证/ 性/ 的/ 消息/ 交互/ 流程/ ./ 将/ 如图/ 4/ 所示/ 的/ 加密/ 测试/ 或者/ 签名/ 测试/ 加入/ 远程/ 证明/ 协议/ 流程/ 中/ ,/ 可以/ 达到/ U/ 认证/ V/ 的/ 目的/ ./ 需要/ 假设/ NU/ 唯一/ 的/ 源于/ U/ 且/ SK/ (/ V/ )/ / KP/ ./ 改进/ 方法/ 证明/ ./ 基于/ 图/ 4/ (/ a/ )/ ,/ 测试/ 组件/ 为/ {/ Nu/ }/ PK/ (/ V/ )/ ,/ 使用/ “/ 加密/ 测试/ ”/ 准则/ ,/ 可以/ 确定/ (/ v/ ,/ 1/ )/ 的/ 存在/ ;/ 基于/ 图/ 4/ (/ b/ )/ ,/ 测试/ 组件/ 为/ [/ Nu/ ,/ V/ ]/ SK/ (/ V/ )/ ,/ 使用/ “/ 签名/ 测试/ ”/ 准则/ ,/ 也/ 可以/ 确定/ 节点/ (/ v/ ,/ 1/ )/ 的/ 存在/ ./ 另外/ 基于/ NU/ 的/ 唯一性/ ,/ 可以/ 确定/ V/ 串/ 的/ 唯一性/ ./ 完毕/ ./ 5.4/ 从/ 验证/ 者/ 的/ 角度/ 分析/ 验证/ 者/ 主要/ 关心/ 其/ 认证/ 性/ ,/ 下面/ 对/ 其/ 进行/ 分析/ ./ 目标/ 3/ 分析/ (/ Verifier/ 认证/ 性/ )/ ./ 设/ 节点/ n/ =/ 〈/ sv/ ,/ 2/ 〉/ ,/ 根据/ 定义/ 7/ ,/ 节点/ n/ 存在/ 3/ 个/ 新/ 组件/ :/ Q/ ,/ cert/ (/ AIK/ )/ 和/ h/ (/ ML/ )/ ./ 前/ 两个/ 组件/ 可以/ 使用/ “/ 签名/ 测试/ ”/ 进行/ 分析/ ,/ 最后/ 一个/ 组件/ 可以/ 使用/ “/ 哈希/ 测试/ ”/ 进行/ 分析/ ./ 由/ AIK/ -/ 1/ ∈/ {/ SKsig/ (/ T/ )/ |/ T/ ∈/ X/ }/ ,/ 即/ 存在/ 某个/ 安全/ 芯片/ T0/ 满足/ AIK/ -/ 1/ =/ SKsig/ (/ T0/ )/ ,/ 由/ 定义/ 18/ 知/ AIK/ -/ 1/ ∈/ S0/ ./ 对于/ 新/ 组件/ Q/ =/ [/ h/ (/ ML/ )/ ‖/ NV/ ]/ inv/ (/ AIK/ )/ / term/ (/ n/ )/ ,/ 根据/ “/ 签名/ 测试/ ”/ ,/ 一定/ 存在/ 一个/ 正规/ 节点/ m/ / Cn/ 满足/ Q/ 源于/ m/ ,/ 显然/ m/ 是/ 某个/ 安全/ 芯片/ 串/ 的/ 第/ 6/ 个/ 节点/ ,/ 即/ 存在/ 丛高/ 至少/ 为/ 6/ 的/ 串/ st/ ∈/ TPM/ [/ T0/ ,/ U0/ ,/ V/ ,/ PCA0/ ,/ / ,/ L0/ ,/ AIK/ ,/ / ,/ ML/ ,/ NV/ ]/ ./ 由于/ AIK/ 唯一/ 的/ 源于/ 安全/ 芯片/ T0/ ,/ 故串/ st/ 是/ 唯一/ 的/ ./ 对于/ 新/ 组件/ cert/ (/ AIK/ )/ =/ [/ L/ ‖/ AIK/ ‖/ PCA/ ]/ SK/ (/ PCA/ )/ ,/ 由于/ SK/ (/ PCA/ )/ / KP/ ,/ 根据/ “/ 签名/ 测试/ ”/ 可以/ 知道/ 该/ 组件/ 源于/ PrivacyCA/ 串/ ,/ 同时/ 根据/ 定理/ 6/ ,/ 存在/ 一个/ 安全/ 芯片/ T1/ ∈/ X/ 满足/ AIK/ =/ PKsig/ (/ T1/ )/ ./ 由于/ AIK/ ∈/ st/ ,/ 可以/ 确定/ T1/ =/ T0/ ./ 同时/ 根据/ cert/ (/ AIK/ )/ 组件/ ,/ 可以/ 确定/ L/ =/ L0/ ,/ PCA/ =/ PCA0/ ./ 对于/ 新/ 组件/ h/ (/ ML/ )/ ,/ 由于/ ML/ 的/ 机密性/ 不/ 成立/ (/ 见/ 目标/ 4/ 分析/ )/ ,/ “/ 哈希/ 测试/ ”/ 无法/ 保证/ 其/ 来自/ 于/ 一个/ 正规/ 串/ ,/ 攻击者/ H/ 串/ 可以/ 根据/ ML/ 伪造/ h/ (/ ML/ )/ ./ 目前/ 可以/ 确定/ 串/ st/ ∈/ TPM/ [/ T0/ ,/ U0/ ,/ V/ ,/ PCA/ ,/ / ,/ L/ ,/ AIK/ ,/ / ,/ ML/ ,/ NV/ ]/ ,/ 但是/ 无法/ 确定/ T/ =/ T0/ 和/ U/ =/ U0/ 是否/ 成立/ ,/ 而且/ 也/ 无法/ 确定/ 正规/ 用户/ 进程/ 串/ su/ ∈/ User/ [/ T/ ,/ U/ ,/ V/ ,/ PCA/ ,/ / ,/ L/ ,/ AIK/ ,/ / ,/ ML/ ,/ NV/ ]/ 的/ 存在/ ./ 这样/ 可能/ 导致/ 两类/ 攻击/ 的/ 存在/ :/ (/ 1/ )/ 一个/ 没有/ 安全/ 芯片/ 的/ 攻击者/ 平台/ 可以/ 利用/ 可信/ 平台/ 的/ 安全/ 芯/ Page12/ 片/ T/ 来/ 欺骗/ 验证/ 者/ V/ (/ 攻击/ 丛如图/ 5/ 所示/ )/ ;/ (/ 2/ )/ 如果/ 攻击者/ 平台/ 也/ 拥有/ 一个/ 安全/ 芯片/ T1/ ,/ 攻击者/ 根据/ ML/ 度量/ 日志/ 先/ 扩展/ T1/ 的/ PCR/ 后/ 生成/ h/ (/ ML/ )/ ,/ 这样/ 可以/ 代替/ 其他/ 任意/ 平台/ 完成/ 远程/ 证明/ (/ 称为/ 布谷鸟/ 攻击/ [/ 29/ ]/ ,/ 其/ 攻击/ 丛如图/ 6/ 所示/ )/ ./ 改进/ 方法/ :/ 为了/ 预防/ 攻击/ (/ 1/ )/ ,/ 可以/ 向/ 远程/ 验证/ 者/ 证明/ T/ 和/ U/ 的/ 绑定/ 关系/ ,/ 保证/ 只有/ U/ 才能/ 使用/ T/ ,/ 通常/ 可信/ 芯片/ 通过/ 授权/ 会话/ 协议/ 来/ 建立/ 这种/ 关系/ ./ 而/ 为了/ 避免/ 攻击/ (/ 2/ )/ ,/ 我们/ 需要/ 向/ 远程/ 方/ V/ 证明/ 具体/ 的/ 安全/ 芯片/ T/ (/ 如/ 使用/ EK/ 证书/ )/ ,/ 但是/ 这样/ 会/ 破坏/ 隐私/ 性/ ,/ 文献/ [/ 29/ ]/ 中/ 的/ 解决/ 方法/ 是/ 直接/ 在/ T/ 和/ V/ 之间/ 建立/ 安全/ 通道/ ,/ 需要/ 在/ 可信/ 芯片/ T/ 上/ 增加/ 一个/ 特殊/ 安全/ 接口/ ,/ 但/ 从/ 厂商/ 角度/ 而言/ 这种/ 方法/ 比较/ 不切实际/ ./ 因此/ ,/ 目前/ 还/ 没有/ 有效/ 的/ 方法/ 在/ 保护/ 隐私/ 性/ 的/ 同时/ 防止/ 布谷鸟/ 攻击/ ./ 改进/ 方法/ 说明/ :/ 针对/ 攻击/ (/ 1/ )/ 的/ 改进/ 方法/ 依赖/ 可信计算/ 的/ 授权/ 会话/ 协议/ ,/ 其/ 分析/ 需要/ 先/ 证明/ 授权/ 会话/ 协议/ 的/ 安全性/ ,/ 是/ 我们/ 下/ 一步/ 的/ 工作/ 目标/ ./ 针对/ 攻击/ (/ 2/ )/ 的/ 改进/ 方法/ 需要/ 在/ T/ 和/ V/ 之间/ 直接/ 建立/ 安全/ 通道/ ./ 如果/ 是/ 密码/ 安全/ 通道/ ,/ 可以/ 采用/ 串/ 空间/ 先/ 分析/ 该/ 通道/ 的/ 安全性/ ;/ 如果/ 是/ 硬件安全/ 通道/ ,/ 则/ 需要/ 对串/ 空间/ 进行/ 进一步/ 扩展/ ./ 如何/ 建立/ 安全/ 通道/ 以及/ 证明/ 安全/ 通道/ 的/ 安全性/ 在/ 本文/ 的/ 分析/ 范围/ 之外/ ./ 完毕/ ./ 6/ 攻击/ 6.1/ 攻击/ 描述/ 本/ 节/ 根据/ 对/ 每个/ 安全/ 属性/ 的/ 分析/ 结果/ ,/ 给出/ 对应/ 攻击/ 的/ 简单/ 描述/ ./ 这些/ 攻击/ 可以/ 破坏/ 对应/ 的/ 安全/ 属性/ ./ 在/ 下面/ 消息/ 交互/ 过程/ 中/ ,/ 以/ 角色/ P/ 表示/ 攻击者/ ./ 构建/ 一个/ 可信/ 平台/ ,/ 平台/ 身份/ 密钥建立/ 过程/ (/ 消息/ 1/ ~/ 6/ )/ 可以/ 执行/ 多次/ ,/ 生成/ 多个/ AIK/ ;/ 平台/ 证明/ 过程/ (/ 消息/ 7/ ~/ 10/ )/ 可以/ 基于/ 不同/ AIK/ ,/ 与/ 不同/ 的/ 验证/ 者/ 建立/ 可信/ 关系/ ./ 攻击/ 1/ (/ 破坏/ 隐私/ 性/ )/ ./ 攻击者/ 只要/ 截获/ 消息/ 3/ 和/ 消息/ 10/ 就/ 可以/ 破坏/ 隐私/ 性/ ./ 对于/ 每个/ 平台/ 的/ AIK/ 建立/ 过程/ ,/ 攻击者/ 截获/ 消息/ 3/ ,/ 并/ 存储/ (/ Cert/ _/ EK/ ,/ AIK/ )/ 的/ 二元/ 组/ ;/ 当/ 一个/ 平台/ 在/ 消息/ 10/ 进行/ 平台/ 证明/ 时/ ,/ 攻击者/ 截获/ Cert/ _/ AIK/ ,/ 可以/ 查询/ 存储/ 的/ 二元/ 组/ 找到/ 对应/ 的/ Cert/ _/ EK/ ,/ 进而/ 确定/ 具体/ 的/ 安全/ 芯片/ T/ ./ 而且/ ,/ 基于/ 存储/ 的/ (/ Cert/ _/ EK/ ,/ AIK/ )/ 二元/ 组/ ,/ 攻击者/ 可以/ 将/ 同一个/ 平台/ 的/ 所有/ AIK/ 进行/ 关联/ ,/ 进一步/ 破坏/ 其/ 隐私/ 性/ ./ 文献/ [/ 5/ ]/ 中/ 协议/ 只/ 分析/ 平台/ 证明/ 过程/ ,/ 忽略/ 了/ 平台/ 密钥建立/ 过程/ ,/ 因此/ 遗漏/ 了/ 该/ 攻击/ ./ 攻击/ 2/ (/ 破坏/ PrivacyCA/ 认证/ 性/ )/ ./ 攻击者/ 截获/ 消息/ 3/ 的/ Cert/ _/ EK/ ,/ 并/ 随机/ 生成/ 一个/ AIK/ 可以/ 欺骗/ PrivacyCA/ ,/ 如对/ 消息/ 3/ 进行/ 修改/ :/ 消息/ 2.3/ ./ a/ ./ U/ →/ P/ (/ PCA/ )/ :/ Cert/ _/ EK/ ,/ AIK/ ,/ L/ ,/ PCA/ ,/ I/ 消息/ 2.3/ ./ b/ ./ P/ (/ U/ )/ →/ PCA/ :/ Cert/ _/ EK/ ,/ AIKP/ ,/ LP/ ,/ PCA/ ,/ IP/ 消息/ 2.4/ ./ PCA/ →/ U/ :/ {/ Cert/ _/ AIKP/ }/ EK/ 该/ 攻击/ 主要/ 是/ 理论/ 上/ 存在/ 风险/ ,/ 实际/ 中/ 就算/ PrivacyCA/ 生成/ Cert/ _/ AIKP/ ,/ 攻击者/ 也/ 无法/ 解密/ ,/ 因为/ 其/ 没有/ EK/ 私钥/ ./ 不过/ 该/ 攻击/ 在/ 实际/ 中/ 可以/ 用于/ 对/ PrivacyCA/ 进行/ DoS/ 攻击/ ,/ 让/ 其/ 不断/ 生成/ AIK/ 证书/ ,/ 消耗/ 其/ 资源/ ./ 攻击/ 3/ (/ 欺骗/ 攻击/ ,/ 破坏/ Verifier/ 认证/ 性/ )/ ./ 一个/ 没有/ 安全/ 芯片/ T/ 的/ 攻击者/ 平台/ 利用/ 一个/ 可信/ 平台/ 的/ 消息/ 流/ 来/ 欺骗/ 验证/ 者/ V/ ,/ 从而/ 获得/ V/ 的/ 验证/ ,/ 攻击/ 流/ 如下/ :/ 信息/ 3.7/ ./ a/ ./ P/ (/ V/ )/ →/ U/ :/ NP/ 消息/ 3.10/ ./ a/ ./ U/ →/ P/ (/ V/ )/ :/ ML/ ,/ Cert/ _/ AIKPage13/ 消息/ 3.7/ ./ b/ ./ V/ →/ P/ (/ U/ )/ :/ NV/ 消息/ 3.8/ ./ P/ (/ U/ )/ →/ T/ :/ NV/ 消息/ 3.9/ ./ T/ →/ P/ (/ U/ )/ :/ Q/ 消息/ 3.10/ ./ b/ ./ P/ (/ U/ )/ →/ V/ :/ Q/ ,/ ML/ ,/ Cert/ _/ AIK/ 该/ 攻击/ 过程/ 中/ ,/ 攻击者/ 首先/ 冒充/ V/ 与/ 一个/ 合法/ 的/ U/ 交互/ ,/ 获取/ 其/ 完整性/ 度量/ 日志/ ML/ 和/ AIK/ 证书/ Cert/ _/ AIK/ (/ 消息/ 3.7/ ./ a/ ~/ 3.10/ ./ a/ )/ ;/ 然后/ ,/ 当/ 远程/ 验证/ 者/ V/ 向/ 攻击者/ 平台/ 请求/ 验证/ 数据/ 时/ ,/ 攻击者/ 冒充/ U/ 从/ 安全/ 芯片/ T/ 获得/ 签名/ 数据/ Q/ (/ 消息/ 3.7/ ./ b/ ~/ 3.9/ )/ ;/ 最后/ ,/ 攻击者/ 组合/ 消息/ 骗取/ V/ 的/ 验证/ (/ 消息/ 3.10/ ./ b/ )/ ./ 攻击/ 4/ (/ 布谷鸟/ 攻击/ ,/ 破坏/ Verifier/ 认证/ 性/ )/ ./ 攻击者/ 购买/ 一个/ TPM/ 芯片/ ,/ 能/ 代替/ 其他/ 任何/ 恶意/ 平台/ 完成/ 远程/ 证明/ 过程/ ,/ 假设/ 攻击者/ 的/ 安全/ 芯片/ 为/ TP/ ,/ 攻击/ 流程/ 如下/ :/ PCA/ ,/ IP/ 消息/ 4.1/ ./ P/ →/ TP/ :/ LP/ ,/ PCA/ 消息/ 4.2/ ./ TP/ →/ P/ :/ AIKP/ ,/ IP/ 消息/ 4.3/ ./ P/ →/ PCA/ :/ Cert/ _/ EKP/ ,/ AIKP/ ,/ LP/ ,/ 消息/ 4.4/ ./ PCA/ →/ P/ :/ {/ Cert/ _/ AIKP/ }/ EK/ 消息/ 4.5/ ./ P/ →/ TP/ :/ {/ Cert/ _/ AIKP/ }/ EK/ 消息/ 4.6/ ./ TP/ →/ P/ :/ Cert/ _/ AIKP/ 消息/ 4.7/ ./ a/ ./ P/ (/ V/ )/ →/ U/ :/ NP/ 消息/ 4.10/ ./ a/ ./ U/ →/ P/ (/ V/ )/ :/ ML/ 消息/ 4.7/ ./ b/ ./ V/ →/ P/ (/ UP/ )/ :/ NV/ 消息/ 4.8/ ./ P/ (/ UP/ )/ →/ TP/ :/ NV/ 消息/ 4.9/ ./ TP/ →/ P/ (/ UP/ )/ :/ QP/ 消息/ 4.10/ ./ b/ ./ P/ (/ UP/ )/ →/ V/ :/ QP/ ,/ ML/ ,/ Cert/ _/ AIKP/ 该/ 攻击/ 过程/ 中/ ,/ 攻击者/ 首先/ 使用/ 安全/ 芯片/ TP/ 向/ PrivacyCA/ 申请/ 一个/ 合法/ 的/ 身份/ Cert/ _/ AIKP/ (/ 消息/ 4.1/ ~/ 4.6/ )/ ;/ 然后/ ,/ 攻击者/ 冒充/ V/ 向/ 一个/ 合法/ 的/ 用户/ 平台/ U/ 发起/ 挑战/ ,/ 获取/ 其/ 合法/ 度量/ 日志/ ML/ (/ 消息/ 4.7/ ./ a/ ~/ 4.10/ ./ a/ )/ ;/ 基于/ ML/ ,/ 攻击者/ 可以/ 在/ TP/ 平台/ 上/ 通过/ TPM/ _/ Extend/ 命令/ 扩展/ 出/ 预期/ 的/ PCR/ 值/ ;/ 最后/ ,/ 当/ 攻击者/ 控制/ 的/ 任意/ 恶意/ 平台/ UP/ 想要/ 获取/ V/ 的/ 验证/ 时/ ,/ 可以/ 使用/ TP/ 所在/ 的/ 攻击者/ 平台/ 代替/ UP/ 完成/ 平台/ 证明/ 过程/ (/ 消息/ 4.7/ ./ b/ ~/ 4.10/ ./ b/ )/ ./ 因为/ Cert/ _/ AIKP/ 是/ 合法/ 的/ 身份/ ,/ QP/ 是/ 对/ 合法/ 完整性/ 状态/ PCR/ 值/ 的/ 签名/ ,/ 因此/ 可以/ 通过/ V/ 的/ 验证/ ./ 该/ 攻击/ 体现/ 了/ TPM/ 安全/ 芯片/ 本身/ 也/ 是/ 一把/ 双刃剑/ ,/ 能/ 被/ 攻击者/ 利用/ ./ 文献/ [/ 5/ ]/ 中/ 由于/ 没有/ 区分/ 安全/ 芯片/ T/ 和/ 用户/ 进程/ U/ 两个/ 角色/ ,/ 因此/ 没有/ 发现/ 此/ 攻击/ ./ 由于/ 该/ 攻击/ 与/ CMU/ 学者/ [/ 29/ ]/ 发现/ 的/ 布谷鸟/ 攻击/ 一致/ ,/ 因此/ 采用/ 这种/ 攻击/ 称谓/ ./ 攻击/ 5/ (/ 破坏/ ML/ 的/ 机密性/ )/ ./ 由于/ 远程/ 证明/ 协议/ 设计/ 时/ 只/ 考虑/ 了/ 认证/ 性/ ,/ 使用/ 了/ 基于/ AIK/ 的/ 签名/ ,/ 而/ 没有/ 考虑/ 机密性/ ,/ 并且/ ML/ 是/ 明文/ 传送/ 的/ ,/ 任何/ 攻击者/ 都/ 可以/ 获得/ ML/ ,/ 则/ ML/ 的/ 机密性/ 缺失/ 可能/ 被/ 攻击/ 用来/ 破坏/ 其他/ 安全/ 属性/ ,/ 如/ 攻击/ 4/ 中/ 攻击者/ 使用/ 获取/ 的/ ML/ 伪造/ 合法/ 的/ 完整性/ 状态/ ,/ 破坏/ 了/ Verifier/ 的/ 认证/ 性/ ./ 攻击/ 6/ (/ 破坏/ 用户/ 的/ 认证/ 性/ )/ ./ 远程/ 证明/ 协议/ 本身/ 是/ 一个/ 单向/ 认证/ 协议/ ,/ 即/ 只有/ 验证/ 者/ V/ 来/ 检查/ 证明/ 者/ 平台/ 的/ 身份/ 和/ 完整性/ 状态/ ,/ 而/ 证明/ 者/ 平台/ 并/ 没有/ 获得/ 远程/ 验证/ 者/ V/ 的/ 任何/ 认证/ 信息/ ./ 因此/ ,/ 任意/ 攻击者/ 都/ 可以/ 随意/ 地向/ 证明/ 者/ 平台/ 发起/ 认证/ 挑战/ ,/ 平台/ 会/ 不断/ 调用/ TPM/ _/ Quote/ 命令/ 进行/ 应答/ ./ 一方面/ 消耗/ TPM/ 的/ 计算资源/ ,/ 进行/ DoS/ 攻击/ ;/ 另一方面/ ,/ 截取/ 可信/ 平台/ 的/ 数据/ ,/ 进行/ 其他/ 攻击/ (/ 如/ 攻击/ 3/ 和/ 攻击/ 4/ 中/ 都/ 有/ 利用/ 这/ 一点/ ,/ 攻击者/ P/ 冒充/ V/ 与/ U/ 交互/ )/ ./ 6.2/ 攻击/ 实验/ 本节/ 对/ 以上/ 攻击/ 中/ 的/ 布谷鸟/ 攻击/ (/ 攻击/ 4/ )/ 进行/ 了/ 模拟/ 实现/ ./ 在/ 文献/ [/ 30/ ]/ 中/ ,/ 我们/ 提出/ 的/ 可信/ 平台/ 模块/ TEEM/ ,/ 通过/ 修改/ 安全/ 芯片/ 的/ 驱动/ ,/ 使得/ 计算/ 平台/ 的/ 可信/ 功能/ 通过/ USB/ 发送给/ TEEM/ 完成/ ./ TEEM/ (/ 相当于/ TP/ )/ 可以/ 作为/ 代替/ 平台/ 上/ 原有/ TPM/ // TCM/ 使用/ 的/ 布谷鸟/ 攻击/ 实例/ ./ 攻击者/ 获得/ TEEM/ 后/ ,/ 将/ TEEM/ 的/ PCR/ 和/ ML/ 固定/ 为/ V/ 信任/ 的/ 值/ ,/ 通过/ USB/ 连接/ 任何/ 计算/ 平台/ ,/ 即可/ 代替/ 该/ 平台/ 完成/ 证明/ ,/ 并/ 获得/ V/ 的/ 信任/ ./ 具体/ 攻击/ 实现/ 如图/ 7/ 所示/ ,/ 包含/ 如下/ 两个/ 过程/ :/ (/ 1/ )/ 模拟/ 一个/ 安全/ 芯片/ 基于/ ARM/ 开发板/ ,/ 我们/ 模拟/ 了/ 一个/ 安全/ 芯片/ ,/ 称为/ TEEM/ ./ TEEM/ [/ 30/ ]/ 使用/ ARMTrustZone/ 安全/ 扩展/ 技术/ 提供/ 隔离/ 执行/ 环境/ ,/ 使用/ 开源/ 的/ 软件/ TPMEmulator/ ①/ 提供/ 可信/ 功能/ (/ 包括/ 密钥/ 管理/ ,/ 身份/ 生成/ ,/ 引证/ ,/ 签名/ 等/ )/ ./ TPM/ 安全/ 芯片/ 一般/ 通过/ LPC/ 总线/ 固定/ 在/ 主板/ 上/ ,/ 而/ TEEM/ 通过/ USB/ 线/ 与/ 计算机/ ①/ http/ :/ // // tpm/ -/ emulator/ ./ berlios/ ./ dePage14/ (/ 如/ 证明/ 者/ U/ 所在/ 平台/ )/ 连接/ ,/ TEEM/ 位于/ ARM/ 嵌入式/ 环境/ ,/ 通过/ Linuxgadget/ 驱动/ 将/ ARM/ 开发板/ 模拟/ 为/ 一个/ USB/ 外设/ ,/ 证明/ 者/ 平台/ 的/ USB/ 驱动/ 可以/ 识别/ 该/ 外设/ ./ 具体/ 实现/ 时/ ,/ ARM/ 端/ 内核/ 配置/ gadgetserial/ 驱动/ ,/ 计算机主机/ 安装/ CDC/ // ACM/ ①/ 驱动/ 可/ 识别/ TEEM/ 所在/ 的/ ARM/ 开发板/ ./ 通过/ USB/ 线/ 连接/ TEEM/ 所在/ 的/ ARM/ 开发板/ 和/ 证明/ 者/ 主机/ 平台/ ,/ 主机/ 上/ 所有/ 通过/ 该/ USB/ 驱动/ 请求/ 的/ 数据/ 都/ 会/ 转发给/ TEEM/ 进行/ 处理/ ,/ 因此/ ,/ TEEM/ 所在/ 的/ ARM/ 开发板/ 可以/ 作为/ 一个/ 模拟/ 的/ 安全/ 芯片/ 使用/ ./ (/ 2/ )/ 使用/ 模拟/ 安全/ 芯片/ 实施/ 布谷鸟/ 攻击/ 根据/ 可信计算/ 标准规范/ [/ 1/ ]/ ,/ 可信/ 应用/ 通过/ 可信/ 软件/ 栈/ 调用/ 可信计算/ 的/ 功能/ ;/ 而/ 可信/ 软件/ 栈/ 通过/ 可信/ 设备/ 驱动/ 库/ TPMTDDL/ (/ TrustedDeviceDriverLibrary/ )/ 将/ 可信计算/ 功能/ 的/ 命令/ 请求/ 交给/ TPM/ 驱动/ ,/ 进而/ 交给/ TPM/ 安全/ 芯片/ 处理/ (/ 如图/ 7/ 所示/ )/ ./ 类似/ 地/ ,/ 我们/ 实现/ 了/ USBTDDL/ 设备/ 驱动/ 库/ ,/ 该库/ 通过/ USB/ 驱动/ 直接/ 与/ TEEM/ 通信/ ./ USBTDDL/ 主要/ 包含/ 3/ 个/ 基本/ 接口/ :/ TDDL/ _/ Open/ (/ )/ 、/ TDDL/ _/ Close/ (/ )/ 、/ TDDL/ _/ TransmitData/ (/ )/ ./ 这/ 3/ 个/ 接口/ 通过/ 访问/ USB/ 驱动/ 完成/ ./ 图/ 8/ 通过/ 可信/ 软件/ 栈/ libtpm/ 访问/ TEEM/ 的/ 响应/ 结果/ 在/ 主机/ 平台/ 上/ 通过/ 使用/ USBTDDL/ 库/ 替换/ TPMTDDL/ 库/ ,/ 并/ 通过/ USB/ 线/ 连接/ TEEM/ ./ 这样/ 可信/ 软件/ 栈/ 的/ 所有/ 可信/ 功能/ 请求/ 将会/ 交给/ 模拟/ 安全/ 芯片/ TEEM/ 处理/ ,/ 而/ 不是/ 实际/ 的/ TPM/ 安全/ 芯片/ ./ 图/ 8/ 显示/ 了/ 在/ Windows/ 平台/ 上/ 替换/ TDDL/ 库后/ 通过/ 可信/ 软件/ 栈/ libtpm/ ②/ 访问/ TPM/ 的/ 功能/ 时/ 的/ 响应/ 结果/ ,/ 不过/ 其/ 显示/ 出来/ 的/ TPM/ 信息/ 实际上/ 是/ 来自/ ARM/ 开发板/ 的/ TEEM/ 模拟/ 芯片/ ./ 通过/ 篡改/ 证明/ 者/ 平台/ TDDL/ 库/ 和/ 设备/ 驱动/ ,/ 当/ 用户/ 进程/ 与/ PCA/ 建立/ 平台/ 身份/ 密钥/ ,/ 以及/ 和/ 远程/ 验证/ 者/ V/ 进行/ 平台/ 证明/ 时/ ,/ 实际/ 都/ 是/ 使用/ TEEM/ 模拟/ 的/ 可信/ 功能/ ./ 可信计算/ 命令/ 在/ TEEM/ 中/ 的/ 执行/ 性能/ (/ 包含/ 主机/ 与/ TEEM/ 之间/ USB/ 通信/ 的/ 时间/ )/ 在/ 文献/ [/ 30/ ]/ 中/ 也/ 进行/ 了/ 详细/ 的/ 评估/ ./ 通过/ 在/ Windows/ 平台/ 上/ 的/ 实验/ ,/ 对于/ 基于/ TEEM/ 的/ 远程/ 证明/ 协议/ ,/ 身份/ 生成/ 命令/ TPM/ _/ MakeIdentity/ 需要/ 3.593/ s/ ,/ AIK/ 证书/ 激活/ 命令/ TPM/ _/ ActivateIdentity/ 需要/ 421ms/ ,/ 引证/ 命令/ TPM/ _/ Quote/ 需要/ 359ms/ ,/ 一个/ PCR/ 扩展/ 需要/ 62.5/ ms/ ,/ 读取/ PCR/ 值/ 也/ 需要/ 62.5/ ms/ ./ 显然/ ,/ 该/ 攻击/ 需要/ TEEM/ 拥有/ 一个/ 合法/ 的/ EK/ 证书/ ./ 只要/ 攻击者/ 控制/ 一个/ 安全/ 芯片/ ,/ 其/ 就/ 拥有/ 一个/ 有效/ 的/ EK/ 证书/ ./ 另外/ ,/ 随着/ 可信/ 芯片/ 的/ 发展/ ,/ 支持/ USB/ 接口/ 的/ 便携式/ 可信/ 芯片/ 是/ 一个/ 趋势/ ./ 这样/ ,/ 只要/ 攻击者/ 拥有/ 一个/ 合法/ 的/ 便携式/ 可信/ 芯片/ ,/ 其/ 可以/ 在/ 任何/ 主机/ 上/ 完成/ 远程/ 证明/ 协议/ 来/ 进行/ 布谷鸟/ 攻击/ ./ 因此/ ,/ 在/ 发展/ 可信/ 安全/ 芯片/ 时/ ,/ 需要/ 提出/ 相应/ 的/ 机制/ 来/ 防止/ 攻击/ 的/ 发生/ ,/ 本文/ 基于/ 串/ 空间/ 的/ 分析方法/ 可以/ 提供/ 参考/ ./ 7/ 结束语/ 本文/ 对串/ 空间/ 模型/ 进行/ 了/ 扩展/ ,/ 使得/ 其能/ 分析/ 可信计算/ 远程/ 证明/ 协议/ ,/ 并/ 证明/ 了/ 扩展/ 后/ 范式/ 引理/ 的/ 正确性/ ./ 通过/ 扩展/ 的/ 模型/ 对/ 远程/ 证明/ 协议/ 及其/ 安全/ 属性/ 进行/ 了/ 形式化/ 定义/ ./ 同时/ ,/ 本文/ 提出/ 了/ 4/ 个/ 认证/ 测试/ 准则/ ,/ 并/ 使用/ 这些/ 准则/ 对/ 远程/ 证明/ 协议/ 进行/ 了/ 分析/ ./ 经过/ 分析/ 发现/ ,/ 期望/ 的/ 安全/ 属性/ 只有/ 部分/ 成立/ ,/ 不/ 成立/ 的/ 部分/ 容易/ 导致/ 攻击/ (/ 如/ 布谷鸟/ 攻击/ 等/ )/ ./ 针对/ 攻击/ ,/ 本文/ 提出/ 了/ 相应/ 的/ 改进/ 方法/ ./ 同时/ 为了/ 验证/ 串/ 空间/ 的/ 分析/ 结果/ ,/ 本文/ 基于/ ARM/ 开发板/ 对/ 发现/ 的/ 布谷鸟/ 攻击/ 进行/ 了/ 模拟/ 实现/ ./ 本文/ 的/ 工作/ 弥补/ 了/ 可信计算/ 理论/ 研究/ 的/ 不足/ ,/ 为/ 其/ 在/ 实际/ 中/ 的/ 使用/ 提供/ 信心/ 保障/ ./ 本文/ 的/ 串/ 空间/ 扩展/ 方法/ 针对/ 可信/ 安全/ 芯片/ 进行/ ,/ 同样/ 也/ 适合/ 分析/ 拥有/ 类似/ 功能/ 的/ 密码/ 硬件/ ./ 下/ 一步/ 工作/ 主要/ 包含/ 4/ 个/ 方面/ :/ 基于/ 本文/ 提出/ 的/ 改进/ 方法/ ,/ 设计/ 并/ 分析/ 新/ 的/ 远程/ 证明/ 协议/ ,/ 促进/ 可信计算/ 的/ 发展/ ;/ 进一步/ 分析/ 可信计算/ 的/ 授权/ 会话/ 协议/ (/ 如/ TPM2/ ./ 0/ 中新/ 的/ 授权/ 协议/ 等/ )/ ,/ 明确/ 安全/ 芯片/ 和/ 计算/ 平台/ 的/ 绑定/ 认证/ 性/ ;/ 扩展/ 开源/ CPSA/ [/ 8/ ]/ 工具/ 实现/ 对/ 本文/ 方法/ 的/ 自动化/ 验证/ ./ 

