Page1/ 一种/ 基于/ 攻击/ 图/ 的/ 安全/ 威胁/ 识别/ 和/ 分析方法/ 吴迪/ 1/ )/ ,/ 2/ )/ ,/ 4/ )/ 连/ 一峰/ 1/ )/ ,/ 3/ )/ 陈恺/ 1/ )/ 刘玉岭/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 中国科学院/ 软件/ 研究所/ 北京/ 100190/ )/ 2/ )/ (/ 中国科学院/ 研究生院/ 北京/ 100049/ )/ 3/ )/ (/ 信息安全/ 共性/ 技术/ 国家/ 工程/ 研究/ 中心/ 北京/ 100190/ )/ 4/ )/ (/ 信息/ 网络安全/ 公安部/ 重点/ 实验室/ (/ 公安部/ 第三/ 研究所/ )/ 上海/ 201204/ )/ 摘要/ 业务/ 系统安全/ 管理/ 需要/ 网络攻击/ 图来/ 评估/ 系统/ 整体/ 安全性/ 或/ 态势/ ,/ 同时/ 又/ 需要/ 对/ 那些/ 可能/ 严重危害/ 系统安全/ 的/ 脆弱性/ 利用/ 威胁/ 进行/ 重点/ 分析/ 和/ 优先/ 处置/ ./ 现有/ 安全/ 威胁/ 识别/ 和/ 分析方法/ 无法/ 兼顾/ 这/ 两个/ 方面/ ,/ 也/ 无法/ 处理/ 脆弱性/ 利用/ 威胁/ 分析/ 过程/ 中/ 的/ 不确定性/ 问题/ ./ 作者/ 提出/ 了/ 一种/ 安全/ 威胁/ 识别/ 和/ 分析方法/ ./ 利用/ 颜色/ Petri/ 网/ (/ CPN/ )/ 定义/ 网络攻击/ 图/ ,/ 并/ 给出/ 了/ 网络攻击/ 图/ 生成/ NAGG/ 算法/ ,/ 根据/ 攻击/ 模型/ 分析/ 结果/ 生成/ 网络攻击/ 图/ ;/ 给出/ 了/ 基于/ CPN/ 仿真/ 的/ 网络攻击/ 图/ 分解/ NAGD/ 算法/ ,/ 可/ 一次性/ 分解/ 出/ 各/ 脆弱性/ 利用/ 威胁/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 所述/ 子/ 攻击/ 图/ 不/ 存在/ 循环/ 路径/ 且/ 最长/ 攻击/ 路径/ 不/ 超过/ 预设值/ ./ 并/ 给出/ 了/ 一种/ 脆弱性/ 利用/ 威胁/ 度/ 评估/ VETE/ 算法/ ,/ 将子/ 攻击/ 图/ 转换/ 为/ 不确定性/ 推理/ 规则/ 集/ ,/ 采用/ D/ -/ S/ 证据/ 推理/ 计算/ 各子/ 攻击/ 图所/ 对应/ 安全/ 威胁/ 的/ 威胁/ 度/ ,/ 以/ 确定/ 安全/ 威胁/ 处置/ 优先级/ ./ 最后/ 以/ 一个/ 典型/ Web/ 应用/ 系统/ 为例/ ,/ 验证/ 了/ 所述/ 安全/ 威胁/ 识别/ 和/ 分析方法/ 的/ 有效性/ ./ 关键词/ 攻击/ 模型/ ;/ 网络攻击/ 图/ ;/ 子/ 攻击/ 图/ ;/ 颜色/ Petri/ 网/ ;/ 不确定性/ 推理/ ;/ D/ -/ S/ 证据/ 理论/ 1/ 引言/ 业务/ 系统/ 不可避免/ 地/ 存在/ 脆弱性/ ,/ 因而/ 使/ 其/ 面临/ 各种/ 脆弱性/ 利用/ 威胁/ ./ 从/ 脆弱性/ 利用/ 角度/ 剖析/ 业务/ 系统/ 面临/ 的/ 安全/ 威胁/ 是/ 一种/ 有效/ 的/ 业务/ 系统安全/ 分析/ 途径/ ./ 攻击/ 图是/ 一种/ 广泛应用/ 的/ 脆弱性/ 利用/ 分析方法/ ./ 它/ 从/ 攻击者/ 角度/ 出发/ ,/ 基于/ 系统/ 网络/ 配置/ 和/ 脆弱性/ 信息/ ,/ 分析/ 脆弱性/ 利用/ 之间/ 的/ 依赖/ 关系/ ,/ 找出/ 所有/ 可能/ 的/ 攻击/ 路径/ [/ 1/ -/ 3/ ]/ ,/ 以便/ 管理员/ 采取/ 必要措施/ 抵御/ 安全/ 威胁/ ,/ 以/ 降低/ 安全/ 风险/ ./ 因此/ ,/ 攻击/ 图可为/ 信息系统/ 安全/ 风险/ 评估/ 和/ 绩效/ 分析/ 提供/ 重要依据/ [/ 4/ -/ 5/ ]/ ./ 按/ 攻击/ 图中/ 节点/ 和/ 边/ 表示/ 的/ 含义/ 不同/ ,/ 本文/ 将/ 攻击/ 图/ 分为/ 状态/ 攻击/ 图/ 和/ 因果关系/ 图/ ./ 状态/ 攻击/ 图/ [/ 1/ ,/ 6/ ]/ 中/ 的/ 节点/ 表示/ 目标/ 网络/ 和/ 攻击者/ 的/ 全局/ 状态/ ,/ 有/ 向/ 边/ 表示/ 单一/ 攻击行为/ 引起/ 的/ 状态/ 转换/ ./ 状态/ 攻击/ 图/ 由于/ 存在/ 状态/ 空间/ 爆炸/ 问题/ ,/ 不适/ 用于/ 大规模/ 系统/ 的/ 安全性/ 分析/ ;/ 因果关系/ 图/ [/ 7/ -/ 9/ ]/ 中/ ,/ 节点/ 表示/ 系统/ 条件/ (/ 属性/ )/ 和/ 原子/ 攻击/ ,/ 有/ 向/ 边/ 表示/ 节点/ 间/ 的/ 因果关系/ ./ 因果关系/ 图/ 克服/ 了/ 状态/ 攻击/ 图/ 的/ 状态/ 组合/ 爆炸/ 问题/ ,/ 具有/ 更好/ 的/ 可扩展性/ ,/ 能/ 用于/ 大规模/ 网络/ 安全性/ 分析/ ./ 目前/ 的/ 攻击/ 图/ [/ 7/ -/ 10/ ]/ 大都/ 属于/ 因果关系/ 图/ ./ 依据/ 攻击/ 图中/ 攻击/ 路径/ 覆盖范围/ ,/ 本文/ 将/ 攻击/ 图/ 分为/ 网络攻击/ 图和子/ 攻击/ 图/ ./ 网络攻击/ 图/ 展示/ 业务/ 系统/ 中/ 所有/ 可能/ 攻击/ 路径/ ,/ 子/ 攻击/ 图/ 只/ 展示/ 与/ 特定/ 安全/ 威胁/ 相关/ 的/ 攻击/ 路径/ ./ 网络攻击/ 图/ 适用/ 于/ 识别系统/ 中/ 各种/ 可能/ 影响/ 到/ 业务/ 系统安全/ 属性/ 的/ 脆弱性/ 利用/ 威胁/ ,/ 有助于/ 评估/ 业务/ 系统/ 整体/ 安全性/ 或/ 态势/ ,/ 但/ 网络攻击/ 图/ [/ 7/ ,/ 9/ ]/ 往往/ 非常/ 庞大/ ,/ 不/ 适合/ 对/ 某/ 一/ 特定/ 脆弱性/ 利用/ 威胁/ 的/ 分析/ ;/ 子/ 攻击/ 图/ [/ 1/ ,/ 10/ ]/ 适于/ 对/ 特定/ 脆弱性/ 利用/ 威胁/ 进行/ 有/ 针对性/ 的/ 分析/ 和/ 处置/ ./ 在/ 具体/ 安全/ 分析/ 场景/ 中/ ,/ 鉴于/ 系统/ 业务/ 重要性/ 的/ 不同/ 及/ 资源/ 有限/ 和/ 成本/ 等/ 因素/ 影响/ ,/ 往往/ 需要/ 进一步/ 分析/ 所/ 识别/ 出/ 的/ 各种/ 脆弱性/ 利用/ 威胁/ ,/ 生成/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 确定/ 脆弱性/ 利用/ 威胁/ 的/ 优先/ 处置/ 顺序/ ,/ 以/ 合理/ 分配/ 安全/ 资源/ ./ 以往/ 攻击/ 图/ 生成/ 算法/ 只能/ 生成/ 网络攻击/ 图/ [/ 7/ ,/ 9/ ]/ 或者/ 子/ 攻击/ 图/ [/ 1/ ,/ 10/ ]/ ./ 但/ 在/ 实际/ 的/ 脆弱性/ 利用/ 威胁/ 识别/ 和/ 分析/ 过程/ 中/ ,/ 通常/ 需要/ 基于/ 网络攻击/ 图/ 和/ 安全/ 属性/ 识别/ 出/ 所有/ 影响/ 业务/ 系统/ 安全性/ 的/ 脆弱性/ 利用/ 威胁/ ,/ 再/ 基于/ 子/ 攻击/ 图/ 对/ 所/ 识别/ 出/ 的/ 各/ 脆弱性/ 利用/ 威胁/ 进行/ 深入分析/ ./ 近年来/ 攻击/ 图/ 的/ 研究/ 工作/ 主要/ 集中/ 在/ 攻击/ 图/ 可视化/ [/ 11/ ]/ 和/ 基于/ 攻击/ 图/ 的/ 安全/ 分析/ [/ 4/ ,/ 12/ -/ 14/ ]/ 上/ ./ 文献/ [/ 11/ ]/ 利用/ 数据/ 归约/ 和/ 攻击/ 组合/ 方法/ 改善/ 攻击/ 图/ 可视化/ 方法/ ,/ 更/ 关注/ 攻击/ 图/ 呈现/ 问题/ ,/ 不是/ 完备/ 的/ 攻击/ 图/ 分析方法/ ./ 文献/ [/ 10/ ]/ 尝试/ 基于/ 网络攻击/ 图/ 裁剪/ 出/ 特定/ 安全/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图时/ ,/ 发现/ 了/ 网络攻击/ 图中/ 的/ 循环/ 攻击/ 路径/ 问题/ ,/ 但/ 并未/ 给出/ 有效/ 去除/ 循环/ 攻击/ 路径/ 的/ 方法/ ./ 文献/ [/ 12/ ]/ 给出/ 从/ 网络攻击/ 图/ 求取/ 所有/ n/ -/ 有效/ 路径/ 的/ 后/ 向/ 迭代/ 算法/ ,/ 一次/ 只能/ 生成/ 一个/ 与/ 特定/ 安全/ 威胁/ 相关/ 的/ 子/ 攻击/ 图/ ./ 文献/ [/ 15/ -/ 16/ ]/ 给出/ 了/ 基于/ Petri/ 网/ 的/ 组合/ 攻击/ 模型/ ,/ 但/ 并未/ 给出/ 创建/ Petri/ 网/ 攻击/ 模型/ 的/ 方法/ ./ 文献/ [/ 17/ ]/ 应用/ 贝叶斯/ 网络/ 评估/ 网络/ 脆弱性/ ,/ 提出/ 了/ 量化/ 评估/ 计算方法/ ,/ 但/ 无法/ 克服/ 贝叶斯/ 网/ 计算/ 过程/ 中/ 大量/ 先验概率/ 的/ 获取/ 问题/ ./ 文献/ [/ 4/ ]/ 考虑/ 攻击/ 图中/ 各个/ 节点/ 由于/ 在/ 攻击/ 路径/ 中所处/ 位置/ 不同/ 而/ 具有/ 不同/ 的/ 重要性/ ,/ 基于/ PageRank/ 思想/ 将/ 状态/ 攻击/ 图/ 转换/ 为/ Markov/ 链/ ,/ 来/ 计算/ 攻击/ 图中/ 各个/ 节点/ 的/ 重要/ 度/ ,/ 但/ 仍/ 未/ 解决/ 状态/ 攻击/ 图/ 组合/ 爆炸/ 问题/ ./ 在/ 基于/ 子/ 攻击/ 图/ 分析/ 特定/ 脆弱性/ 利用/ 威胁/ 的/ 过程/ 中/ ,/ 往往/ 需要/ 处理/ 大量/ 的/ 不确定性/ 信息/ ,/ 这些/ 不确定性/ 主要/ 表现/ 在/ 模糊性/ 和/ 不一致性/ ./ 传统/ 基于/ 概率/ 的/ 信息系统/ 安全/ 分析方法/ 无法/ 有效/ 解决/ 模糊性/ 问题/ [/ 4/ ,/ 17/ -/ 18/ ]/ ./ 基于/ D/ -/ S/ 证据/ 理论/ 的/ 脆弱性/ 利用/ 威胁/ 分析方法/ 可以/ 有效/ 处理/ 信息安全/ 分析/ 过程/ 中/ 的/ 不确定性/ ./ 文献/ [/ 19/ ]/ 使用/ D/ -/ S/ 证据/ 理论/ 来/ 处理/ 网络/ 风险/ 评估/ 中/ 的/ 不确定性/ ,/ 利用/ D/ -/ S/ 组合/ 方法/ 对/ 风险/ 评估/ 指标/ 相关/ 的/ 安全/ 因子/ 进行/ 融合/ ./ D/ -/ S/ 证据/ 理论/ 因其/ 在/ 不/ 确定/ 信息/ 表达/ 和/ 合成/ 方面/ 的/ 明显/ 优势/ ,/ 近年来/ 广泛应用/ 于/ 数据/ 融合/ [/ 14/ ,/ 19/ ]/ ,/ 但/ 在/ 脆弱性/ 利用/ 威胁/ 分析/ Page3/ 方面/ 的/ 应用/ 尚/ 处于/ 探索/ 阶段/ ./ 本文/ 旨在/ 基于/ 网络攻击/ 图/ 识别/ 业务/ 系统/ 中/ 各/ 脆弱性/ 利用/ 威胁/ ,/ 并/ 通过/ 对/ 网络攻击/ 图/ 进行/ 分解/ 以/ 得到/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 并/ 评估/ 各/ 脆弱性/ 利用/ 威胁/ 度/ ,/ 以便/ 对/ 各/ 脆弱性/ 利用/ 威胁/ 进行/ 优先级/ 排序/ 和/ 处置/ ./ 本文/ 采用/ 文献/ [/ 20/ ]/ 中/ 的/ 攻击/ 模型/ 建模/ 方法/ 构建/ 业务/ 系统/ 攻击/ 模型/ ,/ 并/ 基于/ 攻击/ 模型/ 分析/ 结果/ 构建/ 基于/ 颜色/ Petri/ 网/ (/ CPN/ )/ 的/ 网络攻击/ 图/ ,/ 然后/ 将/ 网络攻击/ 图/ 进行/ 分解/ ,/ 可/ 一次性/ 得到/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 并/ 采用/ 不确定性/ D/ -/ S/ 证据/ 推理方法/ ,/ 将/ 安全/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ 转换/ 为/ 不确定性/ D/ -/ S/ 推理/ 规则/ 集/ ,/ 采用/ D/ -/ S/ 推理/ 引擎/ 计算/ 各/ 脆弱性/ 利用/ 威胁/ 的/ 威胁/ 度/ ./ 最后/ 以/ 一个/ 典型/ Web/ 系统/ 为例/ ,/ 验证/ 了/ 本文/ 所述/ 安全/ 威胁/ 识别/ 和/ 分析方法/ 的/ 有效性/ ./ 2/ 安全/ 威胁/ 识别/ 2.1/ 网络攻击/ 图/ 定义/ 和/ 生成/ 算法/ 为/ 叙述/ 方便/ ,/ 本文/ 称/ 单次/ 脆弱性/ 利用/ 攻击/ 为/ 原子/ 攻击/ ./ 如图/ 1/ 所示/ ,/ 原子/ 攻击/ 包括/ 三类/ 要素/ ,/ 即/ 原子/ 攻击/ 成功/ 实施/ 所/ 依赖/ 的/ 前提条件/ 、/ 原子/ 攻击/ 动作/ 本身/ 以及/ 攻击/ 后果/ ./ 其中/ ,/ 原子/ 攻击/ 前提条件/ 包括/ 攻击者/ 权限/ 、/ 攻击/ 可达性/ 、/ 服务/ 活跃性/ 和/ 脆弱性/ 存在/ 性/ ./ 攻击者/ 权限/ 指/ 攻击者/ 在/ 源/ 主机/ 和/ 目标/ 主机/ 上/ 获得/ 的/ 权限/ 级别/ ,/ 包括/ None/ 、/ User/ 和/ Root/ 权限/ ;/ 攻击/ 可达性/ 指/ 攻击者/ 从源/ 主机/ 发起/ 的/ 原子/ 攻击/ 能否/ 抵达/ 目标/ 主机/ ;/ 服务/ 活跃性/ 指/ 原子/ 攻击/ 成功/ 实施/ 所/ 依赖/ 的/ 服务/ 是否/ 在/ 目标/ 主机/ 上/ 运行/ ;/ 脆弱性/ 存在/ 性指/ 攻击/ 所/ 利用/ 的/ 脆弱性/ 在/ 目标/ 主机/ 的/ 服务/ 中/ 是否/ 存在/ ./ 在/ 实际/ 攻击/ 中/ ,/ 只有/ 满足/ 这些/ 前提条件/ 的/ 原子/ 攻击/ 才/ 可能/ 成功/ 实施/ ./ 原子/ 攻击/ 成功/ 实施/ 的/ 结果/ 主要/ 表现/ 为/ 攻击者/ 能力/ 的/ 提升/ ,/ 比如/ 攻击者/ 获得/ 了/ 目标/ 主机/ 上/ 的/ user/ 或/ root/ 权限/ ./ 图/ 1/ 所述/ 原子/ 攻击/ 其实/ 是/ 一个/ CPN/ 网/ 结构/ ,/ 其中/ ,/ 用来/ 表示/ 原子/ 攻击/ 前提条件/ 和/ 后果/ 的/ 椭圆形/ 节点/ 等同于/ CPN/ 网/ 结构/ 中/ 的/ 库/ 所/ ;/ 用来/ 表示/ 原子/ 攻击/ 动作/ 本身/ 的/ 矩形/ 节点/ 等同于/ CPN/ 网/ 结构/ 中/ 的/ 变迁/ ./ 下面/ 基于/ CPN/ 给出/ 原子/ 攻击/ 形式化/ 定义/ ./ 定义/ 1/ ./ 原子/ 攻击/ AAG/ 是/ 一个/ CPN/ 网/ 结构/ ,/ 记为/ AAG/ =/ 〈/ PAo/ ,/ t/ ,/ PAd/ 〉/ ,/ 其中/ ,/ PAo/ 为/ 所/ 定义/ 原子/ 攻击/ 的/ 输入/ 库所/ 集合/ ,/ 每个/ 库所/ 代表/ 一个/ 攻击/ 前提条件/ ,/ 它/ 可定义/ 为/ 攻击者/ 在/ 源/ 主机/ 或/ 目标/ 主机/ 上/ 的/ 初始/ 权限/ 、/ 源/ 主机/ 到/ 目标/ 主机/ 的/ 攻击/ 可达性/ 、/ 脆弱性/ 所/ 依赖/ 服务/ 的/ 可用性/ 及/ 脆弱性/ 存在/ 性/ ;/ t/ 为/ 变迁/ ,/ 它/ 表示/ 原子/ 攻击/ 的/ 一个/ 脆弱性/ 利用/ 行为/ ;/ PAd/ 为/ 原子/ 攻击/ 的/ 影响/ 库所/ 集合/ ,/ 其中/ 每个/ 库所/ 记录/ 该/ 原子/ 攻击/ 成功/ 实施/ 后/ 的/ 效果/ ./ 图/ 2/ 为/ 一个/ 具体/ 的/ 原子/ 攻击/ 实例/ ,/ 假设/ 攻击者/ 要/ 从/ 其/ 所/ 控制/ 的/ 主机/ 1/ 利用/ 主机/ 2/ 上/ 的/ IISWeb/ 服务/ 中/ 的/ 一个/ 缓冲区/ 溢出/ 漏洞/ (/ CVE/ -/ 2002/ -/ 0364/ )/ ,/ 则/ 必须/ 满足/ 以下/ 4/ 个/ 条件/ :/ (/ 1/ )/ 攻击者/ 在/ 源/ 主机/ H1/ 的/ 权限/ 至少/ 为/ User/ (/ 记/ 为/ 椭圆/ U/ _/ h1/ )/ ;/ (/ 2/ )/ 主机/ 1/ 可以/ 访问/ 主机/ 2/ 的/ HTTP/ 服务/ (/ 记/ 为/ 椭圆/ http/ _/ h1/ _/ h2/ )/ ;/ (/ 3/ )/ 主机/ 2/ 上/ 的/ IIS5/ ./ 0Web/ 服务/ 正在/ 运行/ (/ 记/ 为/ 椭圆/ IIS/ _/ h2/ )/ ;/ (/ 4/ )/ 主机/ 2/ 上/ 的/ IIS5/ ./ 0/ 服务/ 存在/ 一个/ 编号/ 为/ CVE/ -/ 2002/ -/ 0364/ 的/ 缓冲区/ 溢出/ 漏洞/ (/ 记/ 为/ 椭圆/ v364/ _/ h2/ )/ ./ 只有/ 当/ 以上/ 4/ 个/ 条件/ 都/ 满足/ 时/ ,/ 攻击者/ 才/ 可能/ 成功/ 的/ 从/ H1/ 上/ 发起/ 对/ H2/ 上/ IISWeb/ 服务/ 的/ 攻击/ (/ 记/ 为/ 矩形/ v364/ _/ h1/ _/ h2/ )/ ,/ 攻击/ 结果/ 是/ ,/ 攻击者/ 可能/ 获得/ 了/ H2/ 上/ 的/ Root/ 权限/ (/ 记/ 为/ 椭圆/ R/ _/ h2/ )/ ./ 本文/ 采用/ 文献/ [/ 20/ ]/ 中/ 的/ 攻击/ 建模/ 方法/ 构建/ 攻击/ 模型/ ,/ 所/ 创建/ 的/ 攻击/ 模型/ 为/ 一个/ CPN/ 系统/ ./ 所述/ 攻击/ 模型/ 基于/ 攻击能力/ 增长/ 假设/ ./ 定理/ 证明/ :/ 该/ 攻击/ 模型/ 所/ 对应/ CPN/ 系统/ 在/ 有限/ 步/ 仿真/ 后/ 一定/ 进入/ 死/ 状态/ ,/ 并且/ 有且/ 仅/ 有/ 一个/ 死/ 状态/ ,/ 且/ 在/ CPN/ 系统/ 进入/ 死/ 状态/ 时/ ,/ SuccessExploitList/ 库所/ 包含/ 了/ 攻击者/ 成/ Page4/ 功/ 执行/ 的/ 所有/ 脆弱性/ 利用/ 动作/ ./ 由于/ 可以/ 采用/ CPN/ 仿真/ 方法/ 代替/ 复杂度/ 较/ 高/ 的/ 可达图/ 分析方法/ ,/ 因此/ ,/ 所述/ 攻击/ 模型/ 分析方法/ 具有/ 较/ 好/ 扩展性/ ,/ 非常适合/ 大规模/ 网络/ 的/ 攻击/ 建模/ ./ CPN/ 攻击/ 模型/ 仿真/ 结束/ 后/ ,/ 融合/ 库所/ Success/ -/ ExploitList/ 中/ 保存/ 有/ 本次/ 攻击/ 过程/ 中/ 所有/ 可能/ 成功/ 执行/ 的/ 脆弱性/ 利用/ 攻击/ 动作/ ./ 根据/ 定义/ 1/ 可知/ ,/ 每个/ 脆弱性/ 利用/ 动作/ 可用/ 原子/ 攻击/ CPN/ 模型表示/ ./ 当/ 各/ 原子/ 攻击/ 建模/ 结束/ 后/ ,/ 可以/ 根据/ 各/ 原子/ 攻击/ 之间/ 依赖/ 关系/ 构建/ 网络攻击/ 图/ ./ 下面/ 给出/ 网络攻击/ 图/ 的/ 定义/ ./ 定义/ 2/ ./ 网络攻击/ 图/ AG/ 是/ 一个/ CPN/ 网/ 结构/ ,/ 记为/ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ ,/ 其中/ ,/ 初始/ 库所/ 集合/ P0/ 中/ 每个/ 库所/ 代表/ 网络/ 和/ 攻击者/ 的/ 初始状态/ ,/ 表示/ 原子/ 攻击/ 成功/ 实施/ 的/ 前提条件/ ;/ 可达库/ 所/ 集合/ Pd/ 中/ 每个/ 库所/ 代表/ 网络/ 和/ 攻击者/ 的/ 可达/ 状态/ ,/ 它/ 记录/ 原子/ 攻击/ 成功/ 实施/ 后/ 的/ 效果/ ;/ T0/ 为/ 独立型/ 变迁/ 集合/ ,/ 对于/ T0/ 中/ 各/ 变迁/ ,/ 其/ 输入/ 库所/ 包含/ 在/ 初始/ 库所/ 集合/ P0/ 中/ ,/ 因此/ ,/ T0/ 中/ 各/ 变迁/ 所/ 代表/ 的/ 原子/ 攻击/ 的/ 实施/ 不/ 依赖于/ 其它/ 原子/ 攻击/ ;/ Td/ 为/ 依赖型/ 变迁/ 集合/ ,/ 对于/ Td/ 中/ 各/ 变迁/ ,/ 其/ 输入/ 库所/ 集合/ 中/ 至少/ 有/ 一个/ 库所/ 属于/ 可达库/ 所/ 集合/ Pd/ ,/ 因此/ ,/ 成功/ 实施/ Td/ 中/ 各/ 变迁/ 所/ 代表/ 的/ 原子/ 攻击/ 必须/ 依赖于/ 其它/ 原子/ 攻击/ ;/ E/ 为/ 连接/ CPN/ 攻击/ 图中库/ 所/ 和/ 变迁/ 的/ 有/ 向/ 弧/ ./ 网络攻击/ 图/ AG/ 满足/ 如下/ 约束/ :/ ①/ 攻击/ 图/ AG/ 中/ 的/ 有/ 向/ 弧/ 只能/ 连接/ 库所/ 和/ 变迁/ ,/ 或者/ 连接/ 变迁/ 和/ 库/ 所/ ,/ 即/ E/ / (/ (/ P0/ ∪/ Pd/ )/ ×/ (/ T0/ ∪/ Td/ )/ )/ ∪/ (/ (/ T0/ ∪/ Td/ )/ ×/ (/ P0/ ∪/ Pd/ )/ )/ ;/ ②/ 对于/ 独立型/ 变迁/ 集合/ T0/ 中/ 任一/ 元素/ t/ ,/ pre/ (/ t/ )/ 表示/ 该/ 变迁/ 的/ 输入/ 库所/ 集合/ ,/ post/ (/ t/ )/ 表示/ 该/ 变迁/ 的/ 输出/ 库所/ 集合/ ,/ 则/ (/ pre/ (/ t/ )/ / P0/ )/ ∧/ (/ post/ (/ t/ )/ / Pd/ )/ ;/ ③/ 对于/ 依赖型/ 变迁/ 集合/ Td/ 中/ 任一/ 元素/ t/ ,/ pre/ (/ t/ )/ 表示/ 该/ 变迁/ 的/ 输入/ 库所/ 集合/ ,/ post/ (/ t/ )/ 表示/ 该/ 变迁/ 的/ 输出/ 库所/ 集合/ ,/ 则/ (/ / p/ ∈/ pre/ (/ t/ )/ :/ p/ ∈/ Pd/ )/ ∧/ (/ post/ (/ t/ )/ / Pd/ )/ ./ 算法/ 1/ ./ 网络攻击/ 图/ 生成/ 算法/ (/ NAGG/ )/ ./ 输入/ :/ CPN/ 攻击/ 模型/ 中/ 记录/ 着/ 所有/ 成功/ 的/ 脆弱性/ 利用/ 输出/ :/ 网络攻击/ 图/ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ 1/ ./ P0/ =/ {/ Markeplace/ (/ root/ (/ host0/ )/ )/ }/ ,/ Pd/ =/ / ,/ T0/ =/ / ,/ 2/ ./ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ 3/ ./ foreachselinSuccessExploitList4/ ./ begin5/ ./ sel/ (/ sn/ ,/ dn/ ,/ vid/ )/ =/ split/ (/ sel/ )/ ;/ 6/ ./ cveentry/ (/ vid/ ,/ st/ ,/ snm/ ,/ mt/ ,/ vt/ ,/ or/ ,/ dr/ ,/ rr/ )/ =/ 7/ ./ atomic/ _/ model/ =/ 8/ ./ AG/ =/ 9/ ./ end10/ ./ returnAG/ ./ 算法/ 1/ 给出/ 了/ 基于/ CPN/ 攻击/ 模型/ 中/ 融合/ 库所/ SuccessExploitListtoken/ 值/ 的/ 网络攻击/ 图/ 生成/ (/ NAGG/ )/ 算法/ ./ 算法/ 第/ 1/ 行/ 和/ 第/ 2/ 行将/ 初始/ 攻击/ 图/ AG/ 置/ 为/ 空/ ,/ 调用/ Makeplace/ 过程/ 创建/ 一个/ 表示/ 攻击者/ 拥有/ h0/ 主机/ 上/ root/ 权限/ 的/ 库/ 所/ ,/ 并/ 加入/ 到/ 初始/ 攻击/ 图/ AG/ 中/ ./ 第/ 3/ 行到/ 第/ 9/ 行为/ 一个/ 循环/ ,/ 它/ 为/ SuccessExploitList/ 中/ 记录/ 的/ 每个/ 脆弱性/ 利用/ 动作/ sel/ 构造/ 原子/ 攻击/ CPN/ 网/ 结构/ ,/ 然后/ 追加/ 到/ 当前/ 攻击/ 图/ AG/ 中/ ./ 其中/ ,/ 第/ 5/ 行对/ sel/ 进行/ 分解/ ;/ 第/ 6/ 行/ 根据/ 脆弱性/ 利用/ 漏洞/ 编号/ 检索/ CVEDB/ 数据库/ ,/ 得到/ 该/ 脆弱性/ 对应/ CVE/ 条目/ cveentry/ ;/ 第/ 7/ 行/ 利用/ sel/ 和/ cveentry/ 输入/ 数据/ ,/ 根据/ 原子/ 攻击/ 的/ CPN/ 网/ 结构/ (/ 如图/ 5/ 所示/ )/ 构造/ 相应/ 的/ CPN/ 模块/ ;/ 第/ 8/ 行将/ 构造/ 的/ 原子/ 攻击/ CPN/ 模块/ 追加/ 到/ 当前/ 攻击/ 图/ AG/ 中/ ;/ 第/ 10/ 行/ 返回/ 生成/ 的/ 网络攻击/ 图/ AG/ ./ 为/ 确保/ 网络攻击/ 图/ AG/ 中/ 脆弱性/ 利用/ 的/ 前提条件/ 和/ 后果/ 所/ 对应/ 库所及/ 原子/ 攻击/ 所/ 对应/ 变迁/ 的/ 唯一性/ ,/ NAGG/ 算法/ 对/ 脆弱性/ 利用/ 相关/ 库所/ 和/ 变迁/ 进行/ 规范/ 命名/ ./ NAGG/ 算法/ 采用/ 如下/ 规范/ 命名/ 规则/ 来/ 命名/ 各库/ 所/ 和/ 变迁/ :/ (/ 1/ )/ 前提条件/ “/ 攻击者/ 权限/ ”/ (/ 包括/ 攻击者/ 在/ 源/ 主机/ 和/ 目标/ 主机/ 上/ 具有/ 的/ 权限/ )/ ,/ 表示/ 为/ “/ 权限/ 级别/ (/ 主机/ 编号/ )/ ”/ ,/ 其/ 对应/ 库所/ 命名/ 为/ “/ 权限/ 级别/ _/ 主机/ ”/ ./ 如/ ,/ 在/ 构造/ 攻击/ 图时/ ,/ 攻击者/ 在/ h1/ 上/ 具有/ 的/ 权限/ User/ (/ h1/ )/ 所/ 对应/ 的/ 库/ 所/ 名为/ U/ _/ h1/ ./ (/ 2/ )/ 前提条件/ “/ 攻击/ 可达性/ ”/ ,/ 表示/ 为/ “/ 协议/ (/ 源/ 主机/ ,/ 目标/ 主机/ )/ ”/ ,/ 此/ 前提条件/ 对应/ 库所/ 命名/ 为/ “/ 协议/ _/ 源/ 主机/ _/ 目标/ 主机/ ”/ ./ 如/ ,/ 在/ 构造/ 攻击/ 图时/ ,/ 主机/ h1/ 和/ h2/ 之间/ http/ 协议/ 的/ 可达性/ http/ (/ h1/ ,/ h2/ )/ 对应/ 库所/ 名为/ http/ _/ h1/ _/ h2/ ./ (/ 3/ )/ 前提条件/ “/ 服务/ 活跃性/ ”/ ,/ 表示/ 为/ “/ 服务/ 名/ (/ 主机名/ )/ ”/ ,/ 对应/ 库所/ 命名/ 为/ “/ 服务/ 名/ _/ 主机名/ ”/ ./ 如/ ,/ 在/ 构造/ 攻击/ 图时/ ,/ 主机/ h1/ 上/ 的/ IIS/ 服务/ IIS50/ (/ h1/ )/ 所/ 对应/ 的/ 库/ 所/ 名为/ IIS50/ _/ h1/ ./ (/ 4/ )/ 前提条件/ “/ 漏洞/ 存在/ 性/ ”/ ,/ 表示/ 为/ “/ 漏洞/ 编号/ (/ 主机名/ )/ ”/ ,/ 相应/ 库所/ 命名/ 为/ “/ 漏洞/ 编号/ _/ 主机名/ ”/ ./ (/ 5/ )/ 对于/ 脆弱性/ 利用/ 后果/ ,/ 本文/ 仅指/ 攻击者/ 获得/ 的/ 权限/ ,/ 因此/ ,/ 其/ 命名/ 方法/ 和/ 对应/ 库所/ 命名/ 方法/ 与/ Page5/ 前提条件/ “/ 攻击者/ 权限/ ”/ 相同/ ./ (/ 6/ )/ 某一/ 脆弱性/ 利用/ 动作/ 表示/ 为/ “/ 漏洞/ 编号/ (/ 源/ 主机/ ,/ 目标/ 主机/ )/ ”/ ,/ 其/ 相应/ 变迁/ 命名/ 为/ “/ 漏洞/ 编号/ _/ 源/ 主机/ _/ 目标/ 主机/ ”/ ./ 如/ 在/ 构造/ 攻击/ 图时/ ,/ 脆弱性/ 利用/ 动作/ CVE364/ (/ h1/ ,/ h2/ )/ 对应/ 的/ 变迁/ 名称/ 为/ v364/ _/ h1/ _/ h2/ ./ 3/ 网络攻击/ 图/ 分解/ 算法/ 算法/ 1/ 所示/ 网络攻击/ 图/ 生成/ NAGG/ 算法/ 所/ 构造/ 的/ 网络攻击/ 图/ AG/ 包含/ 了/ 系统/ 所有/ 可能/ 的/ 攻击/ 路径/ ,/ 以及/ 攻击者/ 所有/ 可能/ 获得/ 的/ 攻击/ 权限/ ./ 为了/ 对/ 特定/ 脆弱性/ 利用/ 威胁/ 进行/ 重点/ 分析/ 和/ 优先/ 处置/ ,/ 需要/ 基于/ 各/ 脆弱性/ 利用/ 威胁/ ,/ 对/ 网络攻击/ 图/ 进行/ 分解/ ,/ 以/ 获得/ 各/ 安全/ 威胁/ 对应/ 的/ 子/ 攻击/ 图/ ./ 子/ 攻击/ 图/ 包含/ 了/ 攻击者/ 从/ 初始/ 节点/ 出发/ 抵达/ 指定/ 威胁/ 目标/ 的/ 所有/ 可能/ 攻击/ 路径/ ./ 这里/ 给出/ 一个/ 基于/ CPN/ 的/ 网络攻击/ 图/ 分解/ 算法/ ,/ 可/ 一次性/ 分解/ 出/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 所述/ 子/ 攻击/ 图/ 不/ 存在/ 循环/ 路径/ 且/ 最长/ 攻击/ 路径/ 不/ 超过/ 预设值/ ./ 攻击/ 图/ 相关/ 定义/ 和/ 网络攻击/ 图/ 分解/ 算法/ 如下/ ./ 3.1/ 网络攻击/ 图/ 分解/ 算法/ 和/ 相关/ 定义/ 定义/ 3/ ./ 攻击/ 路径/ ./ 设/ Path/ =/ t1/ →/ t2/ →/ …/ →/ tn/ 是/ 给定/ 网络攻击/ 图/ AG/ 中/ 的/ 一个/ 变迁/ 序列/ ,/ 其中/ ti/ (/ 1/ / i/ / n/ )/ 为/ 变迁/ ,/ 它/ 代表/ 一个/ 原子/ 攻击/ ,/ 则/ 称/ 满足/ 下面/ 约束条件/ 的/ 变迁/ 序列/ 为/ 攻击/ 路径/ :/ ①/ 变迁/ t1/ 为/ 独立型/ 变迁/ ;/ ②/ 变迁/ tn/ 的/ 输出/ 库所/ 集合/ Potst/ (/ tn/ )/ 与/ 关键/ 节点/ 集合/ P/ 的/ 交集/ 不为/ 空/ ;/ ③/ 变迁/ 序列/ 中/ 前驱/ 变迁/ 的/ 输出/ 库所为/ 后继/ 变迁/ 的/ 输入/ 库所/ ./ 攻击/ 路径/ 长度/ 为/ 攻击/ 路径/ 所/ 对应/ 的/ 变迁/ 序列/ 长度/ ./ 定义/ 4/ ./ 脆弱性/ 利用/ 威胁/ 定义/ 为/ SRi/ =/ 〈/ Pi/ 其中/ Pi/ 务/ 系统安全/ 的/ 权限/ 集合/ ,/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ 只/ 包含/ 了/ 从/ 初始/ 节点/ 出发/ 抵达/ 集合/ Pi/ 各/ 元素/ 所示/ 权限/ 的/ 攻击/ 路径/ ./ 本文/ 所指/ 威胁/ 除/ 特别/ 说明/ 外/ ,/ 均/ 为/ 脆弱性/ 利用/ 威胁/ ./ 网络攻击/ 图/ 分解/ 需要/ 解决/ 两个/ 问题/ :/ (/ 1/ )/ 循环/ 攻击/ 路径/ 问题/ ;/ (/ 2/ )/ 超长/ 攻击/ 路径/ 问题/ ./ 根据/ 攻击者/ 能力/ 单调/ 增长/ 特性/ 可知/ ,/ 实际/ 攻击/ 过程/ 中/ 攻击者/ 没有/ 必要/ 重复/ 获取/ 已/ 获得/ 的/ 攻击能力/ ,/ 因此/ 循环/ 攻击/ 路径/ 没有/ 实际意义/ ,/ 并且/ 循环/ 攻击/ 路径/ 的/ 存在/ 会/ 增加/ 子/ 攻击/ 图/ 分析/ 复杂度/ ./ 根据/ 以往/ 对/ 黑客攻击/ 事件/ 的/ 研究/ 显示/ ,/ 实际/ 网络攻击/ 场景/ 中/ ,/ 并/ 不/ 存在/ 超长/ 的/ 攻击/ 路径/ [/ 12/ ]/ ./ 这里/ 首先/ 给出/ 子/ 攻击/ 图/ 定义/ ,/ 然后/ 给出/ 一个/ 可以/ 消除/ 循环/ 攻击/ 路径/ 和/ 限制/ 攻击/ 路径/ 长度/ 的/ 网络攻击/ 图/ 分解/ (/ NAGD/ )/ 算法/ ./ 定义/ 5/ ./ 子/ 攻击/ 图/ ./ 某/ 脆弱性/ 利用/ 威胁/ SR/ =/ 〈/ PC/ 〉/ 所/ 对应/ 的/ 子/ 攻击/ 图为/ 满足/ 下述/ 条件/ 的/ 网络攻击/ 图/ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ ,/ 记/ AG/ 的/ 所有/ 攻击/ 路径/ 集合/ 为/ PATHAG/ :/ (/ 1/ )/ 不/ 存在/ 循环/ 路径/ ,/ 即/ 对/ / p/ (/ t1/ ,/ t2/ ,/ …/ ,/ tl/ )/ ∈/ PATHAG/ ,/ 有/ Post/ (/ ti/ )/ ∩/ (/ ∪/ i/ -/ 1/ / ,/ 2/ / i/ / lk/ ;/ (/ 2/ )/ 任意/ 攻击/ 路径/ 长度/ 不/ 超过/ 指定/ 常数/ N/ (/ N/ / 1/ )/ ,/ 即/ / p/ (/ t1/ ,/ t2/ ,/ …/ ,/ tl/ )/ ∈/ PATHAG/ ,/ Len/ (/ p/ )/ / N/ ;/ (/ 3/ )/ 任一/ 攻击/ 路径/ 抵达/ 的/ 目标/ 必然/ 为/ 脆弱性/ 利用/ 威胁/ SR/ 中/ 的/ 节点/ ,/ 即/ / p/ (/ t1/ ,/ t2/ ,/ …/ ,/ tl/ )/ ∈/ PATHAG/ ,/ Len/ (/ p/ )/ / N/ ,/ Post/ (/ tl/ )/ ∩/ PC/ ≠/ / ./ 算法/ 2/ 为/ NAGD/ 算法/ ,/ 其中/ ,/ 代码/ 第/ 1/ 到/ 第/ 7/ 行将/ 网络攻击/ 图所/ 对应/ 的/ CPN/ 网/ 结构/ 转换/ 为/ 可/ 仿真/ CPN/ 系统/ ;/ 代码/ 第/ 8/ 行对/ 转换/ 后/ 的/ CPN/ 系统/ 进行/ 仿真/ ,/ 仿真/ 必然/ 在/ 有限/ 步/ 停止/ ;/ 代码/ 第/ 9/ 到/ 15/ 行/ 根据/ 仿真/ 结束/ 后/ 各/ 脆弱性/ 利用/ 威胁/ 相关/ 库所/ 记录/ 的/ 攻击/ 路径/ 列表/ 对/ 网络攻击/ 图/ 进行/ 分解/ ,/ 得到/ 各/ 威胁/ 对应/ 的/ 子/ 攻击/ 图/ ./ NAGD/ 算法/ 可/ 在/ 只/ 执行/ 一次/ 网络攻击/ 图/ 转换/ 和/ CPN/ 系统/ 仿真/ 前提/ 下/ ,/ 一次性/ 得到/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ./ 算法/ 2/ ./ 网络攻击/ 图/ 分解/ 算法/ (/ NAGD/ )/ ./ 输入/ :/ 需/ 分解/ 的/ CPN/ 网络攻击/ 图/ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ 输出/ :/ 〈/ Pic/ 〉/ 中/ 各/ 威胁/ 相关/ 子/ 攻击/ 图/ AGSi/ =/ 〈/ P0/ ∪/ Pd/ ,/ 1/ ./ P0/ =/ / ,/ Pd/ =/ / ,/ T0/ =/ / ,/ Td/ =/ / ,/ E/ =/ / ;/ 2/ ./ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ ;/ 3/ ./ foreachtinT0/ ∪/ Tddobegin4/ ./ AAG/ =/ ObtainAAG/ (/ t/ )/ ;/ 5/ ./ AAG/ =/ AAGtoCPN/ (/ AAG/ ,/ N/ )/ ;/ 6/ ./ AG/ =/ AppendCPNModel/ (/ AAG/ ,/ AG/ )/ ;/ 7/ ./ end8/ ./ CPNSimulate/ (/ AG/ )/ ;/ 9/ ./ fori/ =/ 1tondobegin10/ ./ ValidTransSet/ =/ 11/ ./ AGSi/ =/ AG/ ;/ 12/ ./ foreachtinT0/ ∪/ Tddobegin13/ ./ If/ (/ t/ / ValidTransSet/ )/ 14/ ./ end15/ ./ end16/ ./ return/ {/ AGSi/ }/ i/ =/ 1/ ../ n/ ./ 在/ 算法/ 2/ 所示/ 的/ NAGD/ 算法/ 中/ ,/ 函数/ AAG/ -/ toCPN/ 将/ 原子/ 攻击/ AAG/ =/ 〈/ PA0/ ,/ t/ ,/ PAd/ 〉/ 转换/ 为/ 可/ 仿真/ CPN/ 子/ 模块/ AAG/ ,/ 它/ 是/ NAGD/ 算法/ 实现/ 的/ 关/ Page6/ 键/ 步骤/ ./ 该/ 函数/ 所用/ 到/ 的/ 颜色/ 类型定义/ 见表/ 1/ ./ 函数/ AAGtoCPN/ 伪/ 代码/ 如/ 算法/ 3/ 所示/ ,/ 其中/ ,/ 代码/ 1/ ~/ 4/ 行为/ PA0/ 中/ 各/ 输入/ 库所/ 指定/ 颜色/ 类型/ APT/ ,/ 并/ 为/ 属于/ 初始/ 库所/ 集合/ P0/ 的/ 各/ 输入/ 库所/ 建立/ 一个/ 攻击/ 路径/ 和/ 攻击者/ 能力/ 列表/ 都/ 为/ 空/ 的/ token/ ;/ 代码/ 第/ 5/ 行为/ 输出/ 库所/ PAd/ 中/ 各库/ 所/ 指定/ 颜色/ 类型/ APT/ ;/ 代码/ 6/ ~/ 8/ 行将/ (/ PA0/ ×/ t/ )/ 中/ 各/ 输入/ 弧/ 改为/ 双向/ 弧/ ,/ 以/ 避免/ 变迁/ t/ 与/ 其它/ 变迁/ 在/ 输入/ 库所/ 代表/ 的/ 攻击/ 条件/ 上/ 形成/ 竞争/ ;/ 同时/ 为/ 双向/ 弧/ 附上/ 可/ 将/ APT/ 类型/ token/ 分表/ 1/ 函数/ AAGtoCPN/ 中/ 用到/ 的/ 颜色/ 类型定义/ 说明/ 列表/ 序号/ 颜色/ 类型/ 名称/ 1234/ 算法/ 3/ ./ AAGtoCPN/ 函数/ 伪/ 代码/ ./ 输入/ :/ 网络攻击/ 图/ AG/ =/ 〈/ P0/ ∪/ Pd/ ,/ T0/ ∪/ Td/ ,/ E/ 〉/ ;/ 需转/ 输出/ :/ AAG/ 相应/ 的/ 被/ 转化/ 的/ CPN/ 子/ 模块/ AAG1/ ./ ForeachpinPAodo2/ ./ AttachColorType/ (/ p/ ,/ APT/ )/ ;/ 3/ ./ ifp/ ∈/ P0thenAttachEmptyToken/ (/ p/ )/ 4/ ./ Endfor5/ ./ ForeachpinPaddoAttachColorT/ (/ p/ ,/ APT/ )/ ;/ 6/ ./ Foreacheiin/ (/ PA0/ ×/ t/ )/ do7/ ./ ei/ =/ MakeDuralArc/ (/ ei/ )/ ,/ AttachSplitAPTExpr/ (/ ei/ )/ 8/ ./ Endfor9/ ./ Foreacheiin/ (/ t/ ×/ PAd/ )/ (/ t/ ×/ PAd/ )/ do10/ ./ AttachArcExpression/ (/ ei/ ,/ MkExpr/ (/ Pre/ (/ ei/ )/ ,/ 11/ ./ Endfor12/ ./ Ph/ =/ MakeHistoryPlace/ (/ APT/ )/ ;/ 13/ ./ AttachGurad/ (/ t/ )/ ;/ 14/ ./ returnAAG/ ./ 图/ 3/ 为/ 一个/ 利用/ AAGtoCPN/ 函数/ 将/ 与/ 变迁/ v2/ _/ 0/ _/ 3/ 相关/ 的/ 原子/ 攻击/ 网/ 结构/ 转换/ 为/ 可/ 执行/ CPN/ 子/ 模块/ 实例/ ./ 其中/ ,/ 设置/ 输入/ 库所/ R/ _/ 0/ ,/ dns/ _/ 0/ _/ 3/ ,/ bnd/ _/ h3/ 和/ v2/ _/ h3/ 的/ 颜色/ 类型/ 为/ APT/ ;/ 设置/ 输出/ 库所/ R/ _/ 3/ 的/ 颜色/ 类型/ 为/ APT/ ;/ 分别/ 为/ 4/ 个/ 输入/ 库所/ R/ _/ 0/ ,/ dns/ _/ 0/ _/ 3/ ,/ bnd/ _/ h3/ 和/ v2/ _/ h3/ 附加/ 初始/ token/ 值/ “/ (/ [/ ]/ ,/ [/ ]/ )/ ”/ ;/ 将/ 从/ 输入/ 库所到/ 变迁/ v2/ _/ 0/ _/ 3/ 的/ 4/ 个/ 输入/ 弧/ 设置/ 为/ 双向/ 弧/ ,/ 并/ 定义/ 弧/ 表达式/ 为/ (/ pi/ ,/ ti/ )/ ;/ 以/ 表达式/ “/ (/ p1/ / / [/ “/ v2/ _/ 0/ _/ 3/ ”/ ]/ ,/ t1/ / / [/ “/ R/ _/ 3/ ”/ ]/ )/ ”/ 标识/ 从/ 变迁/ v2/ _/ 0/ _/ 3/ 到库/ 所/ R/ _/ 3/ 的/ 输出/ 弧/ (/ 表达式/ 中/ 的/ / / 为/ CPN/ 语言/ 中/ list/ 元素/ 追加/ 运算符/ )/ ,/ 从而/ 将/ 变迁/ 解为/ 攻击/ 路径/ 和/ 攻击能力/ 列表/ 的/ 脚本/ 表达式/ ;/ 代码/ 第/ 9/ ~/ 11/ 行为/ (/ t/ ×/ PAd/ )/ 中/ 各/ 输出/ 弧/ 附上/ 可/ 将/ 变迁/ t/ 所/ 代表/ 的/ 脆弱性/ 利用/ 行为/ 追加/ 到/ 当前/ 攻击/ 路径/ 中/ ,/ 以及/ 将/ 变迁/ T/ 输出/ 结果/ 所/ 代表/ 的/ 攻击者/ 能力/ 追加/ 到/ 当前/ 攻击者/ 能力/ 列表/ 中/ 的/ 弧/ 表达式/ ;/ 代码/ 第/ 12/ 行/ 创建/ 颜色/ 类型/ 为/ APL/ 的/ 库/ 所/ Ph/ ,/ 它/ 记录/ 了/ 所有/ 经过/ 变迁/ t/ 的/ 攻击/ 路径/ 的/ 列表/ ,/ 以/ 防止/ 仿真/ 过程/ 中/ 变迁/ t/ 的/ 同一/ 绑定/ 被/ 重复/ 触发/ ;/ 代码/ 第/ 14/ 行为/ 变迁/ t/ 添加/ guard/ 函数/ ,/ 以/ 去除/ 攻击/ 图中/ 的/ 循环/ 路径/ 和/ 超长/ 路径/ ./ v2/ _/ 0/ _/ 3/ 所/ 代表/ 的/ 脆弱性/ 利用/ 行为/ 追加/ 到/ 当前/ 攻击/ 路径/ 中/ ,/ 同时/ 将/ 变迁/ v2/ _/ 0/ _/ 3/ 成功/ 执行/ 后/ 所/ 获得/ 的/ 攻击/ 权限/ (/ 获得/ 了/ host3/ 上/ 的/ root/ 权限/ )/ 追加/ 到/ 当前/ 攻击者/ 能力/ 列表/ 中/ ;/ 创建/ 一个/ 颜色/ 类型/ 为/ APL/ 的/ 历史/ 库所/ PH/ ,/ 分别/ 创建/ 从/ PH/ 到/ v2/ _/ 0/ _/ 3/ 和/ 从/ v2/ _/ 0/ _/ 3/ 到/ PH/ 的/ 有/ 向/ 弧/ ,/ 并/ 分别/ 附加/ 弧/ 表达式/ “/ pl/ ”/ 和/ “/ pl/ / / [/ p1/ ]/ ”/ ,/ 以/ 记录/ 经过/ 变迁/ T/ 的/ 所有/ 攻击/ 路径/ 的/ 列表/ ./ 图/ 3/ 利用/ AAGtoCPN/ 函数/ 转换/ 原子/ 攻击/ 例子/ 图/ 3/ 中/ ,/ 为/ 变迁/ v2/ _/ 0/ _/ 3/ 设置/ guard/ 函数/ “/ gd/ (/ “/ R/ _/ 3/ ”/ ,/ p1/ ,/ t1/ ,/ pl/ )/ ”/ ,/ 以/ 限定/ 变迁/ v2/ _/ 0/ _/ 3/ 所/ 代表/ 原子/ 攻击/ 的/ 执行/ 条件/ ,/ 限定/ 条件/ 为/ 3/ 个/ 条件/ 的/ 与/ :/ ①/ 该/ 变迁/ 的/ 执行/ 不会/ 导致/ 循环/ 攻击/ 路径/ ;/ ②/ 该/ 变迁/ Page7/ 的/ 执行/ 不会/ 获取/ 到/ 重复/ 的/ 攻击/ 权限/ ;/ ③/ 该/ 变迁/ 所在/ 攻击/ 路径/ 长度/ 不/ 超过/ 指定/ 值/ ./ 3.2/ NAGD/ 算法/ 复杂度/ 分析/ NAGD/ 算法/ 包括/ 转换/ 、/ 仿真/ 和/ 裁剪/ 3/ 个/ 步骤/ ,/ 其/ 算法/ 复杂度/ 主要/ 由/ 第/ 8/ 行/ 的/ CPN/ 系统/ 仿真/ 复杂度/ 决定/ ,/ 因此/ ,/ 这里/ 只/ 分析/ CPN/ 系统/ 的/ 仿真/ 复杂度/ ./ 为/ 说明/ NAGD/ 算法/ 的/ 正确性/ 和/ 有效性/ ,/ 这里/ 给出/ 两个/ 定理/ ./ 定理/ 1/ ./ NAGD/ 算法/ 中/ ,/ 由/ 网络攻击/ 图/ 转换/ 而来/ 的/ CPN/ 系统/ 仿真/ 复杂度/ 为/ O/ (/ m/ (/ ktoutkpout/ )/ N/ )/ ,/ 其中/ ,/ m/ 为/ 网络攻击/ 图中/ 的/ 独立型/ 变迁/ 数量/ ;/ kpout/ 为库/ 所/ 最大/ 输出/ 度/ ;/ ktout/ 为/ 变迁/ 最大/ 输出/ 度/ ;/ N/ 为子/ 攻击/ 图中/ 允许/ 的/ 攻击/ 路径/ 最大/ 长度/ ./ 证明/ ./ 采用/ 数学/ 归纳法/ 证明/ ./ 假设/ 网络攻击/ 图所/ 对应/ 的/ CPN/ 网/ 结构/ 中/ ,/ 各库/ 所/ ai/ 输出/ 度/ 最大/ 为/ kpout/ ;/ 各/ 变迁/ Ti/ 输出/ 度/ 最大/ 为/ ktout/ ;/ 网络攻击/ 图中/ 存在/ m/ 个/ 独立型/ 变迁/ ./ 假设/ 子/ 攻击/ 图中/ 允许/ 出现/ 的/ 最大/ 攻击/ 路径/ 长度/ 为/ 1/ ,/ 则/ 只有/ m/ 个/ 独立型/ 变迁/ 能/ 被/ 触发/ ,/ 因此/ ,/ CPN/ 系统/ 在/ m/ 步/ 仿真/ 后/ 停止/ ,/ 这/ m/ 个/ 独立型/ 变迁/ 将/ 最/ 多/ 向/ mktout/ 个库/ 所/ 输出/ token/ ;/ 假设/ 子/ 攻击/ 图中/ 允许/ 出现/ 的/ 最大/ 攻击/ 路径/ 长度/ 为/ 2/ ,/ 则/ 由/ 第/ 1/ 步/ 攻击/ 所/ 得到/ 的/ 最/ 多/ mktout/ 个/ token/ 将/ 可能/ 触发/ 最多/ mktoutkpout/ 个/ 变迁/ ,/ 这些/ 变迁/ 将/ 向/ 最/ 多/ toutkpout/ 个库/ 所/ 输出/ token/ ;/ 假设/ 子/ 攻击/ 图中/ 允许/ mk2/ 出现/ 的/ 最大/ 攻击/ 路径/ 长度/ 为/ 3/ ,/ 则/ 第/ 3/ 步/ 可能/ 触发/ 的/ 变迁/ 数最多/ 为/ mk2/ 子/ 攻击/ 图中/ 允许/ 出现/ 的/ 最大/ 攻击/ 路径/ 长度/ 为/ N/ 的/ 情况/ 下/ ,/ 第/ N/ 步/ 攻击/ 可能/ 触发/ 的/ 变迁/ 数最多/ 为/ mkN/ -/ 1/ 仿真/ 所/ 触发/ 的/ 变迁/ 数最多/ 为/ (/ m/ +/ mktoutkpout/ +/ mk2/ (/ ktoutkpout/ -/ 1/ )/ ./ 因此/ ,/ 由/ 网络攻击/ 图/ 转换/ 而来/ 的/ CPN/ 系统/ 仿真/ 复杂度/ 为/ O/ (/ m/ (/ ktoutkpout/ )/ N/ )/ ./ 证毕/ ./ 在/ 网络攻击/ 图中/ ,/ 独立型/ 变迁/ 数/ m/ 一般/ 为/ 较/ 小值/ ,/ 变迁/ 最大/ 输出/ 度/ ktout/ 和/ 库/ 所/ 最大/ 输出/ 度/ kpout/ 为/ 较/ 小/ 常数/ ;/ 最大/ 攻击/ 路径/ N/ 一般/ 长度/ 为/ 3/ 或/ 4/ ./ 综上所述/ ,/ 算法/ 2/ 所示/ 的/ 网络攻击/ 图/ 分解/ NAGD/ 算法/ 计算/ 复杂度/ 与/ 文献/ [/ 12/ ]/ 中/ 求取/ N/ -/ 有效/ 攻击/ 路径/ 计算方法/ 相比/ 复杂度/ 更/ 小/ ,/ 且/ 本文/ 所述/ NAGD/ 算法/ 可/ 一次性/ 求出/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ,/ 比/ 文献/ [/ 12/ ]/ 中/ 所述/ 一次/ 只能/ 求取/ 一个/ 关键/ 节点/ 集合/ 的/ N/ -/ 有效/ 攻击/ 路径/ 灵活性/ 更好/ ./ 定理/ 2/ ./ NAGD/ 算法/ 中/ ,/ 由/ 网络攻击/ 图所/ 对应/ 的/ CPN/ 网/ 结构/ 转换/ 而来/ 的/ CPN/ 系统/ 在/ 有限/ 步/ 仿真/ 后/ 一定/ 进入/ 死/ 状态/ ,/ 且/ 有/ 且/ 仅/ 有/ 一个/ 死/ 状态/ ;/ 在/ 死/ 状/ pout/ +/ …/ +/ mkN/ -/ 1toutkN/ -/ 1toutk2/ 态时/ ,/ 各/ 威胁/ 节点/ 对应/ 库所/ token/ 值/ 包含/ 了/ 攻击者/ 抵达/ 脆弱性/ 利用/ 威胁/ 节点/ 的/ 所有/ 无环/ 和/ 最大/ 长度/ 不/ 超过/ N/ 的/ 攻击/ 路径/ 集合/ ./ 定理/ 2/ 证明/ 与/ 文献/ [/ 20/ ]/ 中/ 的/ 定理/ 1/ 证明/ 类似/ ,/ 首先/ 证明/ 可/ 采用/ CPN/ 系统/ 仿真/ 代替/ CPN/ 可达图/ 分析法/ ,/ 然后/ 基于/ 本文/ 定理/ 1/ 可得/ 定理/ 2/ 结论/ ./ 由于/ 篇幅/ 所/ 限/ ,/ 定理/ 2/ 证明/ 过程/ 从略/ ./ 4/ 脆弱性/ 利用/ 威胁/ 度/ 评估/ 本文/ 采用/ D/ -/ S/ 证据/ 不确定性/ 推理方法/ 评估/ 各/ 脆弱性/ 利用/ 威胁/ 的/ 威胁/ 度/ ./ 这里/ 首先/ 给出/ 脆弱性/ 利用/ 威胁/ 度/ 和/ D/ -/ S/ 证据/ 推理/ 相关/ 定义/ ,/ 然后/ 给出/ 脆弱性/ 利用/ 威胁/ 度/ 评估/ VETE/ 算法/ ./ 定义/ 6/ ./ 脆弱性/ 利用/ 威胁/ 度为/ 从/ 指定/ 脆弱性/ 利用/ 威胁/ 的/ 子/ 攻击/ 图/ AAG/ 到/ 区间/ [/ 0/ ,/ 1/ ]/ 的/ 映射/ f/ :/ AAG/ →/ [/ 0/ ,/ 1/ ]/ ,/ 用来/ 综合/ 评估/ 攻击者/ 达到/ 脆弱性/ 利用/ 目标/ 的/ 成功率/ ,/ 攻击者/ 达到/ 脆弱性/ 利用/ 目标/ 成功率/ 越大/ ,/ 脆弱性/ 利用/ 威胁/ 度越/ 大/ ,/ 反之/ 越小/ ./ 定义/ 7/ ./ 具有/ 不确定性/ 的/ 推理/ 规则/ 可/ 表示/ 为/ IFEthenH/ ,/ CF/ ;/ 其中/ H/ 为/ 假设/ ,/ 表示/ 为/ H/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ am/ }/ ,/ ai/ ∈/ Ω/ ;/ E/ 为/ 支持/ H/ 成立/ 的/ 假设/ 集/ ,/ 它们/ 是/ 命题/ 的/ 逻辑/ 组合/ ,/ CF/ 为/ 可信度/ 因子/ ,/ CF/ =/ {/ c1/ ,/ c2/ ,/ …/ ,/ cm/ }/ ,/ ci/ 用来/ 描述/ 前提/ E/ 成立/ 时/ ai/ 的/ 可信度/ ,/ 且/ ci/ 满足/ 如下/ 条件/ :/ (/ 1/ )/ ci/ / 0/ ,/ 1/ / i/ / m/ ;/ (/ 2/ )/ ∑/ mci/ / 1/ ./ i/ =/ 1/ 定义/ 8/ ./ 不确定性/ 传递/ ./ 对于/ 不确定性/ 规则/ IFEthenH/ ,/ CF/ ,/ 定义/ m/ (/ {/ ai/ }/ )/ =/ f/ (/ E/ )/ ci/ (/ ai/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ )/ ,/ 并/ 规定/ :/ ①/ m/ (/ Ω/ )/ =/ 1/ -/ ∑/ m/ 于/ Ω/ 的/ 所有/ 其它/ 子集/ H/ ,/ 均/ 有/ m/ (/ H/ )/ =/ 0/ ./ 定义/ 9/ ./ 不确定性/ 组合/ ./ 当/ 规则/ 的/ 前提/ (/ 证据/ )/ E/ 是/ 多个/ 命题/ 的/ 合取/ 或/ 析取/ 时/ ,/ 定义/ :/ f/ (/ E1/ ∧/ E2/ ∧/ …/ ∧/ En/ )/ =/ min/ (/ f/ (/ E1/ )/ ,/ f/ (/ E2/ )/ ,/ …/ ,/ f/ (/ En/ )/ )/ ,/ f/ (/ E1/ ∨/ E2/ ∨/ …/ ∨/ En/ )/ =/ max/ (/ f/ (/ E1/ )/ ,/ f/ (/ E2/ )/ ,/ …/ ,/ f/ (/ En/ )/ )/ ./ 当有/ n/ 条/ 规则/ 支持/ 同一/ 结论/ 时/ ,/ 即/ 如果/ H/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ am/ }/ ,/ 则/ IFEithenH/ ,/ CFi/ (/ CFi/ =/ {/ Ci1/ ,/ Ci2/ ,/ …/ ,/ Cim/ }/ )/ ,/ 如果/ 这些/ 规则/ 相互/ 独立/ 的/ 支持/ 结论/ H/ 成立/ ,/ 则/ 可以/ 先/ 计算/ mi/ (/ {/ a1/ }/ ,/ {/ a2/ }/ ,/ …/ ,/ {/ am/ }/ )/ =/ mi/ (/ {/ a1/ }/ ,/ {/ a2/ }/ ,/ …/ ,/ {/ am/ }/ )/ =/ (/ f/ (/ Ei/ )/ Ci1/ ,/ f/ (/ Ei/ )/ Ci2/ ,/ …/ ,/ f/ (/ Ei/ )/ Cim/ )/ ,/ 1/ / i/ / n/ ,/ Page8/ (/ f/ (/ Ei/ )/ ·/ Ci1/ ,/ f/ (/ Ei/ )/ ·/ Ci2/ ,/ …/ ,/ f/ (/ Ei/ )/ ·/ Cim/ )/ ,/ 1/ / i/ / n/ ./ 然后/ 根据/ 证据/ 合成/ 法则/ 对/ mi/ 进行/ 证据/ 合成/ ,/ 得到/ 所有/ 规则/ 对/ 结论/ H/ 的/ 支持/ ./ 算法/ 4/ 给出/ 基于/ D/ -/ S/ 证据/ 推理/ 的/ VETE/ 算法/ ,/ 它/ 包括/ 3/ 组/ 步骤/ :/ (/ 1/ )/ 第/ 1/ 行至/ 第/ 6/ 行将/ 子/ 攻击/ 图/ 转换/ 为/ 如/ 定义/ 7/ 所示/ 的/ IF/ -/ then/ 规则/ 集/ ,/ 其中/ ,/ 对于/ 子/ 攻击/ 图中/ 每个/ 变迁/ ,/ 算法/ 第/ 3/ 行/ 抽取/ 该/ 变迁/ 所/ 对应/ 的/ 原子/ 攻击/ ,/ 第/ 4/ 行将/ 原子/ 攻击/ 分解/ 为/ 原子/ 攻击/ 前提条件/ 、/ 原子/ 攻击/ 动作/ 和/ 原子/ 攻击/ 后果/ ,/ 算法/ 第/ 5/ 行/ 根据/ 原子/ 攻击/ 分解/ 结果/ 生成/ IF/ -/ then/ 规则/ ;/ (/ 2/ )/ 第/ 7/ 行至/ 第/ 10/ 行/ 根据/ CVSS/ 发布/ 的/ 脆弱性/ 利用/ 难易/ 程度/ 评估/ 经验值/ 和/ 初始/ 证据/ 可信度/ 等/ 知识/ ,/ 将/ IF/ -/ then/ 规则/ 转换/ 为/ D/ -/ S/ 证据/ 推理/ 规则/ ;/ (/ 3/ )/ 第/ 11/ 行/ 利用/ D/ -/ S/ 证据/ 理论/ 推理/ 引擎/ 对/ 所/ 生成/ 的/ D/ -/ S/ 证据/ 推理/ 规则/ 集/ 进行/ 不确定性/ 推理/ ,/ 最终/ 得到/ 脆弱性/ 利用/ 威胁/ 度/ ./ 算法/ 4/ ./ VETE/ 算法/ ./ 输入/ :/ 脆弱性/ 利用/ 威胁/ 相关/ 子/ 攻击/ 图/ SAG/ =/ 〈/ P0/ ∪/ Pd/ ,/ 输出/ :/ 子/ 攻击/ 图/ 相关/ 脆弱性/ 利用/ 威胁/ 的/ 威胁/ 度/ VEI1/ ./ ForeachtinT0/ ∪/ Tddo2/ ./ Begin3/ ./ aag/ =/ ObtainAAG/ (/ t/ )/ ;/ 图/ 4Web/ 系统/ 拓扑/ 图表/ 2Web/ 业务/ 系统软件/ 配置/ 及/ 脆弱性/ 信息/ 无/ 主机/ 所在/ 网段/ H0/ 外网/ H2DMZApache2/ ./ 0/ (/ HTTP/ )/ CVE/ -/ 2011/ -/ 3607/ (/ 1/ )/ (/ remote/ ,/ 1/ ,/ 0/ )/ H3DMZH4/ 内网/ OpenSSHD/ (/ SSH/ )/ H5/ 内网/ IE7/ ./ 0/ (/ HTTP/ )/ CVE/ -/ 2002/ -/ 0004/ (/ 4/ )/ 4/ ./ 〈/ PAo/ ,/ t/ ,/ PAd/ 〉/ =/ DecomposeAAG/ (/ aag/ )/ ;/ 5/ ./ Ri/ =/ Convert2IF/ -/ Then/ -/ Rule/ (/ PAo/ ,/ t/ ,/ PAd/ )/ ;/ 6/ ./ End7/ ./ Foreachrin/ {/ Ri/ }/ do8/ ./ Begin9/ ./ Ri/ =/ Convert2DSRule/ (/ r/ ,/ DSVE/ )/ ;/ 10/ ./ end11/ ./ VEI/ =/ DSReasoning/ (/ {/ Ri/ }/ )/ ;/ 12/ ./ return/ (/ VEI/ )/ ./ 5/ 实验/ 分析/ 本文/ 建立/ 了/ 一个/ 典型/ Web/ 应用/ 业务/ 系统/ 实验/ 环境/ ,/ 用于/ 验证/ 基于/ 攻击/ 图/ 的/ 安全/ 威胁/ 识别/ 和/ 分析方法/ 的/ 有效性/ ./ 实验/ 系统/ 拓扑/ 结构/ 如图/ 4/ 所示/ ,/ 部署/ 在/ 网络/ 信任/ 域/ 边界/ 处/ 的/ 防火墙/ 将/ 系统/ 网络/ 分成/ 内/ 网/ 、/ DMZ/ 区/ 和/ 可/ 访问/ 互联网/ 的/ 外网/ 3/ 个/ 安全/ 域/ ,/ 各/ 安全/ 域/ 之间/ 的/ 安全策略/ 如下/ :/ (/ 1/ )/ 外/ 网/ 用户/ 只/ 允许/ 访问/ DMZ/ 区/ H2/ 上/ 的/ ApacheWeb/ 服务/ 和/ H3/ 上/ 的/ DNS/ 域名服务/ ;/ (/ 2/ )/ DMZ/ 区/ 的/ H2/ 允许/ 访问/ H3/ 上/ 的/ Sendmail/ 服务/ 和/ 内网/ H4/ 上/ 的/ PostgreSQL/ 服务/ ;/ (/ 3/ )/ 禁止/ H2/ 和/ H3/ 直接/ 访问/ 内网/ 中/ 其它/ 主机/ ;/ (/ 4/ )/ 内网/ 中/ 的/ 管理/ 主机/ H5/ 允许/ 直接/ 访问/ DMZ/ 的/ H2/ 和/ H3/ 及/ 内网/ 的/ H4/ ./ 各/ 应用/ 终端/ 的/ 软件/ 配置/ 和/ 脆弱性/ 信息/ 见表/ 2/ ./ Page9/ 应用/ 文献/ [/ 20/ ]/ 中/ 给出/ 的/ 攻击/ 建模/ 方法/ 为此/ Web/ 业务/ 系统/ 建立/ 攻击/ 模型/ ,/ 然后/ 利用/ 标准/ 工具/ CPNTools/ [/ 19/ ]/ 对/ 该/ CPN/ 攻击/ 模型/ 进行/ 仿真/ ./ 仿真/ 结束/ 后/ ,/ 融合/ 库所/ SuccessExploitList/ 的/ token/ 数据/ 为/ 1/ [/ (/ H0/ ,/ H2/ ,/ 1/ )/ ,/ (/ H0/ ,/ H3/ ,/ 2/ )/ ,/ (/ H2/ ,/ H3/ ,/ 2/ )/ ,/ (/ H2/ ,/ H3/ ,/ 5/ )/ ,/ (/ H2/ ,/ H5/ ,/ 6/ )/ ,/ (/ H2/ ,/ H4/ ,/ 7/ )/ ,/ (/ H3/ ,/ H5/ ,/ 3/ )/ ,/ (/ H5/ ,/ H4/ ,/ 7/ )/ ,/ (/ H4/ ,/ H4/ ,/ 4/ )/ ,/ (/ H4/ ,/ H3/ ,/ 2/ )/ ,/ (/ H3/ ,/ H2/ ,/ 1/ )/ ,/ (/ H4/ ,/ H3/ ,/ 5/ )/ ,/ (/ H5/ ,/ H2/ ,/ 1/ )/ ,/ (/ H5/ ,/ H3/ ,/ 2/ )/ ,/ (/ H5/ ,/ H3/ ,/ 5/ )/ ,/ (/ H4/ ,/ H2/ ,/ 1/ )/ ]/ ./ 应用/ 2.1/ 节/ 给出/ 的/ NAGG/ 算法/ 构造/ 图/ 5/ 由/ CPN/ 攻击/ 模型/ 结果/ 生成/ 的/ 网络攻击/ 图/ 基于/ Web/ 业务/ 系统安全/ 属性/ 对图/ 5/ 所示/ 的/ 网络攻击/ 图/ 进行/ 分析/ ,/ 可/ 识别/ 影响/ Web/ 业务/ 系统/ 安全性/ 的/ 各种/ 脆弱性/ 利用/ 安全/ 威胁/ ,/ 即/ 攻击者/ 可能/ 获得/ 的/ 影响/ 业务/ 系统/ 网络/ 节点/ 安全/ 属性/ 的/ 攻击/ 权限/ ./ 根据/ Web/ 系统/ 业务/ 流/ 和/ 安全/ 属性/ 分析/ 可知/ ,/ 影响/ 到/ 本/ 业务/ 系统安全/ 的/ 关键/ 节点/ 为/ H2/ ,/ H3/ 和/ H4/ ./ 容易/ 从/ 网络攻击/ 图中/ 识别/ 出/ 它们/ 可能/ 面临/ 的/ 脆弱性/ 利用/ 威胁/ 分别/ 为/ {/ R/ _/ 2/ }/ 、/ {/ R/ _/ 3/ }/ 、/ {/ U/ _/ 4/ ,/ R/ _/ 4/ }/ 和/ {/ U/ _/ 5/ ,/ R/ _/ 5/ }/ ./ 下面/ 利用/ NAGD/ 算法/ 从/ 网络攻击/ 图/ 分解/ 出/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ./ 这里/ 假设/ 在子/ 攻击/ 图中/ 允许/ 出现/ 的/ 最长/ 攻击/ 路径/ 为/ 3/ ./ NAGD/ 算法/ 第/ 1/ 阶段/ 将/ 图/ 5/ 所示/ 的/ 网络攻击/ 图/ 转换/ 为/ 可/ 仿真/ CPN/ 系统/ ;/ 第/ 2/ 阶段/ 利用/ CPNTools/ 工具/ [/ 21/ ]/ 对/ 转/ 基于/ CPN/ 的/ 网络攻击/ 图如图/ 5/ 所示/ ./ 从图/ 5/ 可以/ 看出/ ,/ 攻击者/ 在/ 初始状态/ 拥有/ 主机/ H0/ 上/ 的/ Root/ 权限/ (/ 用库/ 所/ R/ _/ h0/ 表示/ )/ ,/ 它/ 可以/ 利用/ 主机/ H3/ 上/ 编号/ 为/ 2/ (/ CVE/ -/ 2001/ -/ 0010/ )/ 的/ 脆弱性/ ,/ 从而/ 获得/ H3/ 上/ 的/ Root/ 权限/ ,/ 它/ 由/ 图/ 5/ 中/ 名为/ v2/ _/ 0/ _/ 3/ 的/ 原子/ 攻击/ 表示/ ;/ 攻击者/ 也/ 可以/ 利用/ 主机/ H2/ 上/ 编号/ 为/ 1/ (/ CVE/ -/ 2011/ -/ 3607/ )/ 的/ 脆弱性/ ,/ 从而/ 获得/ H2/ 上/ 的/ Root/ 权限/ ,/ 它/ 由/ 图/ 5/ 中/ 名为/ v1/ _/ 0/ _/ 2/ 的/ 原子/ 攻击/ 表示/ ./ 换后/ 的/ CPN/ 系统/ 进行/ 仿真/ ,/ 仿真/ 在/ 有限/ 步内/ 结束/ 后/ ,/ 各/ 脆弱性/ 利用/ 威胁/ 相关/ 库所中/ 包含/ 了/ 攻击者/ 从/ 初始/ 节点/ 出发/ 抵达/ 目标/ 节点/ 所有/ 可能/ 的/ 步长/ 不/ 超过/ 3/ 的/ 脆弱性/ 利用/ 攻击/ 路径/ ,/ 因此/ ,/ 可以/ 基于/ 这些/ 攻击/ 路径/ 信息/ 对/ 网络攻击/ 图/ 进行/ 分解/ ,/ 一次性/ 得到/ 各种/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ./ 这里/ 以/ 节点/ H4/ 和/ H5/ 面临/ 的/ 脆弱性/ 利用/ 威胁/ {/ U/ _/ 4/ ,/ R/ _/ 4/ }/ 和/ {/ U/ _/ 5/ ,/ R/ _/ 5/ }/ 为例/ ,/ 给出/ 相应/ 的/ 子/ 攻击/ 图/ ./ 网络攻击/ 图/ 仿真/ 结束/ 后/ ,/ 库所/ U/ _/ 4/ 的/ token/ 值为/ 1/ (/ [/ v1/ _/ 0/ _/ 2/ ,/ v7/ _/ 2/ _/ 4/ ]/ ,/ [/ R/ _/ 2/ ,/ U/ _/ 4/ ]/ )/ ++/ 1/ (/ [/ v2/ _/ 0/ _/ 3/ ,/ v1/ _/ 3/ _/ 2/ ,/ v7/ _/ 2/ _/ 4/ ]/ ,/ [/ R/ _/ 3/ ,/ R/ _/ 2/ ,/ U/ _/ 4/ ]/ )/ ,/ 表明/ 存在/ 两条/ 长度/ 不/ 超过/ 3/ 的/ 攻击/ 路径/ ,/ 使/ 攻击者/ 可以/ 获得/ 节点/ H4/ 上/ 的/ User/ 权限/ ;/ 库所/ R/ _/ 4/ 的/ token/ 值为/ Page101/ (/ [/ v1/ _/ 0/ _/ 2/ ,/ v7/ _/ 2/ _/ 4/ ,/ v4/ _/ 4/ _/ 4/ ]/ ,/ [/ R/ _/ 2/ ,/ U/ _/ 4/ ,/ R/ _/ 4/ ]/ )/ ,/ 这/ 表明/ 存在/ 一条/ 长度/ 不/ 超过/ 3/ 的/ 攻击/ 路径/ ,/ 使得/ 攻击者/ 可以/ 获得/ 节点/ H4/ 上/ 的/ Root/ 权限/ ./ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ 所/ 对应/ 的/ 子/ 攻击/ 图如图/ 6/ (/ a/ )/ 所示/ ./ 类似/ 地/ ,/ 对于/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 5/ ,/ U/ _/ 5/ }/ ,/ 库所/ R/ _/ 5/ 的/ token/ 值为/ 1/ (/ [/ v1/ _/ 0/ _/ 2/ ,/ v5/ _/ 2/ _/ 3/ ,/ v3/ _/ 3/ _/ 5/ ]/ ,/ [/ R/ _/ 2/ ,/ U/ _/ 3/ ,/ R/ _/ 5/ ]/ )/ ,/ 库所/ U/ _/ 5/ 的/ token/ 值为/ 1/ (/ [/ v1/ _/ 0/ _/ 2/ ,/ v6/ _/ 2/ _/ 5/ ]/ ,/ [/ R/ _/ 2/ ,/ U/ _/ 5/ ]/ )/ ++/ 1/ (/ [/ v2/ _/ 0/ _/ 3/ ,/ v1/ _/ 3/ _/ 2/ ,/ v6/ _/ 2/ _/ 5/ ]/ ,/ [/ R/ _/ 3/ ,/ R/ _/ 2/ ,/ U/ _/ 5/ ]/ )/ ,/ 最后/ 得到/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 5/ ,/ U/ _/ 5/ }/ 对应/ 的/ 子/ 攻击/ 图如图/ 6/ (/ b/ )/ 所示/ ./ 由于/ 篇幅/ 问题/ ,/ 其余/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ 说明/ 从略/ ./ 图/ 6/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ 实例/ 图/ 7/ 由图/ 6/ (/ a/ )/ 转换/ 而来/ 的/ 不确定性/ 推理/ 规则/ 集在/ 得到/ 指定/ 节点/ 面临/ 的/ 各种/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 子/ 攻击/ 图后/ ,/ 下面/ 根据/ VETE/ 算法/ 计算/ 各/ 脆弱性/ 利用/ 威胁/ 度/ ./ 由于/ 篇幅/ 问题/ ,/ 这里/ 只/ 给出/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ 的/ 脆弱性/ 利用/ 威胁/ 度/ 计算/ 过程/ ./ 首先/ ,/ 将/ 图/ 6/ (/ a/ )/ 所示/ 的/ 子/ 攻击/ 图/ 转换/ 为/ 如图/ 7/ 所示/ 的/ 不确定性/ 推理/ 规则/ 集/ ;/ 然后/ ,/ 根据/ 初始/ 证据/ 可信度/ 和/ 脆弱性/ 利用/ 成功率/ 经验值/ 将/ 不/ 确定/ 推理/ 规则/ 集/ 转换/ 为/ D/ -/ S/ 不确定性/ 推理/ 规则/ 集/ ./ 这里/ 假设/ 各/ 初始/ 证据/ 可信度/ 为/ 1/ (/ 即/ 初始条件/ 总/ 成立/ )/ ,/ D/ -/ S/ 证据/ 样本空间/ 大小/ Ω/ =/ 6/ ,/ 基于/ CVSS/ 知识库/ 确定/ 子/ 攻击/ 图中/ 各/ 脆弱性/ 利用/ 成功率/ 和/ 失败率/ (/ 参见/ 表/ 2/ 中/ 利用/ 成功率/ 栏/ )/ ,/ 从而/ 确定/ 对应/ 推理/ 规则/ 的/ CF/ 因子/ ./ 求出/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ 的/ 威胁/ 度/ ./ 最后/ ,/ 根据/ D/ -/ S/ 证据/ 理论/ 的/ 不确定性/ 推理/ 算法/ (/ 1/ )/ 根据/ r1/ 求/ R/ _/ 3/ 的/ 确定性/ f/ (/ R/ _/ 0/ / dns/ _/ 0/ _/ 3/ / bnd/ _/ h3/ / v2/ _/ h3/ )/ =/ min/ (/ 1.0/ ,/ 1.0/ ,/ 1.0/ ,/ 1.0/ )/ =/ 1.0/ ,/ m1/ (/ {/ R/ _/ 3/ }/ )/ =/ (/ 1.0/ ×/ 0.4/ )/ =/ (/ 0.4/ )/ ,/ Bel/ (/ R/ _/ 3/ )/ =/ m1/ (/ {/ R/ _/ 3/ }/ )/ =/ 0.4/ ,/ Pl/ (/ R/ _/ 3/ )/ =/ 1/ -/ Bel/ (/ / R/ _/ 3/ )/ =/ 1/ -/ 0/ =/ 1/ ,/ f/ (/ R/ _/ 3/ )/ =/ Bel/ (/ R/ _/ 3/ )/ +/ (/ {/ R/ _/ 3/ }/ // Ω/ )/ ×/ Page11/ (/ 2/ )/ 求/ R/ _/ 2/ 确定性/ 根据/ 规则/ r2/ 和/ r3/ ,/ 有/ f/ (/ R/ _/ 3/ / htp/ _/ 3/ _/ 2/ / iis/ _/ h2/ / v1/ _/ h2/ )/ =/ min/ (/ 0.5/ ,/ 1.0/ ,/ 1.0/ ,/ 1.0/ )/ =/ 0.5/ ,/ m2/ (/ {/ R/ _/ 2/ }/ )/ =/ (/ 0.5/ ×/ 0.5/ )/ =/ (/ 0.25/ )/ ,/ f/ (/ R/ _/ 0/ / htp/ _/ 0/ _/ 2/ / iis/ _/ h2/ / v1/ _/ h2/ )/ =/ min/ (/ 1.0/ ,/ 1.0/ ,/ 1.0/ ,/ 1.0/ )/ =/ 1.0/ ,/ m3/ (/ {/ R/ _/ 2/ }/ )/ =/ (/ 1.0/ ×/ 0.5/ )/ =/ (/ 0.5/ )/ ,/ m2/ (/ Ω/ )/ =/ 1/ -/ 0.25/ =/ 0.75/ ,/ m3/ (/ Ω/ )/ =/ 1/ -/ 0.5/ =/ 0.5/ ./ 由/ D/ -/ S/ 证据/ 组合/ 公式/ 得到/ K/ =/ ∑/ x/ ∩/ y/ ≠/ / 则/ 有/ m23/ (/ {/ R/ _/ 2/ }/ )/ =/ (/ m2/ (/ Ω/ )/ m3/ (/ {/ R/ _/ 2/ }/ )/ +/ m2/ (/ {/ R/ _/ 2/ }/ )/ m3/ (/ Ω/ )/ +/ m2/ (/ {/ R/ _/ 2/ }/ )/ m3/ (/ R/ _/ 2/ )/ )/ // K/ =/ (/ 0.75/ ×/ 0.5/ +/ 0.25/ ×/ 0.5/ +/ 0.25/ ×/ 0.5/ )/ // 1.0/ =/ 0.625/ ,/ Bel/ (/ R/ _/ 2/ )/ =/ m23/ (/ {/ R/ _/ 2/ }/ )/ =/ 0.625/ ,/ Pl/ (/ R/ _/ 2/ )/ =/ 1/ -/ Bel/ (/ / R/ _/ 2/ )/ =/ 1/ -/ 0/ =/ 1/ ,/ f/ (/ R/ _/ 2/ )/ =/ Bel/ (/ R/ _/ 2/ )/ +/ (/ {/ R/ _/ 2/ }/ // Ω/ )/ ×/ (/ 3/ )/ 求/ U/ _/ 4/ 确定性/ f/ (/ R/ _/ 2/ / sql/ _/ 2/ _/ 4/ / mql/ _/ h4/ / v7/ _/ h4/ )/ =/ min/ (/ 0.688/ ,/ 1.0/ ,/ 1.0/ ,/ 1.0/ )/ =/ 0.688/ ,/ m4/ (/ {/ U/ _/ 4/ }/ )/ =/ (/ 0.688/ ×/ 0.5/ )/ =/ (/ 0.344/ )/ ,/ Bel/ (/ U/ _/ 4/ )/ =/ m4/ (/ {/ U/ _/ 4/ }/ )/ =/ 0.344/ =/ 0.344/ ,/ Pl/ (/ U/ _/ 4/ )/ =/ 1/ -/ Bel/ (/ / U/ _/ 4/ )/ =/ 1/ -/ 0/ =/ 1/ ,/ f/ (/ U/ _/ 4/ )/ =/ Bel/ (/ U/ _/ 4/ )/ +/ (/ {/ U/ _/ 4/ }/ // Ω/ )/ ×/ (/ 4/ )/ 求/ R/ _/ 4/ 确定性/ f/ (/ U/ _/ 4/ / cli/ _/ 4/ _/ 4/ / atc/ _/ h4/ / v4/ _/ h4/ )/ =/ min/ (/ 0.453/ ,/ 1.0/ ,/ 1.0/ ,/ 1.0/ )/ =/ 0.453/ ,/ m5/ (/ {/ R/ _/ 4/ }/ )/ =/ (/ 0.453/ ×/ 0.4/ )/ =/ (/ 0.181/ )/ ,/ Bel/ (/ R/ _/ 4/ )/ =/ m5/ (/ {/ R/ _/ 4/ }/ )/ =/ 0.181/ ,/ Pl/ (/ R/ _/ 4/ )/ =/ 1/ -/ Bel/ (/ / R/ _/ 4/ )/ =/ 1/ -/ 0/ =/ 1/ ,/ f/ (/ R/ _/ 4/ )/ =/ Bel/ (/ R/ _/ 4/ )/ +/ (/ {/ R/ _/ 4/ }/ // Ω/ )/ ×/ 通过/ D/ -/ S/ 不确定性/ 推理/ 可知/ ,/ 在/ 限定/ 最长/ 攻击/ 路径/ 为/ 3/ 的/ 情形/ 下/ ,/ 节点/ H4/ 面临/ 的/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ 的/ 威胁/ 度为/ 0.317/ ./ 按照/ 类似/ 方法/ ,/ 可以/ 求得/ 其它/ 节点/ 面临/ 的/ 脆弱性/ 利用/ 威胁/ 度/ ,/ 分别/ 为/ {/ R/ _/ 2/ }/ =/ 0.665/ ,/ {/ R/ _/ 3/ }/ =/ 0.413/ ,/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ =/ 0.317/ ,/ {/ R/ _/ 5/ ,/ U/ _/ 5/ }/ =/ 0.215/ ./ 最后/ ,/ 按照/ 威胁/ 度/ 大小/ 对/ 各/ 脆弱性/ 利用/ 威胁/ 排序/ ,/ 得到/ 影响/ Web/ 业务/ 系统/ 安全性/ 的/ 各/ 脆弱性/ 利用/ 威胁/ 优先级/ 排序/ :/ {/ R/ _/ 2/ }/ ,/ {/ R/ _/ 3/ }/ ,/ {/ R/ _/ 4/ ,/ U/ _/ 4/ }/ ,/ {/ R/ _/ 5/ ,/ U/ _/ 5/ }/ ,/ 结果表明/ ,/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 2/ }/ 发生/ 的/ 可能性/ 最大/ ,/ 脆弱性/ 利用/ 威胁/ {/ R/ _/ 3/ }/ 次之/ ./ 6/ 结论/ 和/ 进一步/ 工作/ 本文/ 提出/ 了/ 一种/ 基于/ 攻击/ 图/ 的/ 安全/ 威胁/ 识别/ 和/ 分析方法/ ,/ 以/ 分析/ 和/ 处置/ 业务/ 系统/ 面临/ 的/ 各种/ 脆弱性/ 利用/ 安全/ 威胁/ ;/ 所述/ 方法/ 基于/ CPN/ 攻击/ 模型/ 仿真/ 分析/ 结果/ 构建/ 基于/ CPN/ 的/ 网络攻击/ 图/ ,/ 以/ 分析/ 业务/ 系统/ 整体/ 安全性/ ;/ 与/ 现有/ 网络攻击/ 图/ 生成/ 算法/ 相比/ ,/ 本文/ 所述/ 方法/ 可/ 基于/ 标准/ CPN/ 分析/ 工具/ 实现/ ,/ 便于/ 利用/ 成熟/ CPN/ 分析/ 工具/ ,/ 且/ 所/ 构建/ 的/ 网络攻击/ 图为/ 一个/ CPN/ 网/ 结构/ ,/ 易于/ 进一步/ 分析/ ./ 本文/ 给出/ 了/ 一个/ 可/ 实现/ 网络攻击/ 图/ 分解/ 的/ NAGD/ 算法/ ,/ 以/ 获取/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ;/ 与/ 现有/ 子/ 攻击/ 图/ 生成/ 算法/ 相比/ ,/ 本文/ 所述/ 算法/ 在/ 不/ 增加/ 算法/ 复杂度/ 情况/ 下/ ,/ 可/ 一次性/ 得到/ 各/ 脆弱性/ 利用/ 威胁/ 所/ 对应/ 的/ 子/ 攻击/ 图/ ./ 最后/ ,/ 本文/ 给出/ 了/ 一种/ 实现/ 脆弱性/ 利用/ 威胁/ 度/ 评估/ 的/ VETE/ 算法/ ,/ 将子/ 攻击/ 图/ 转换/ 为/ 不确定性/ D/ -/ S/ 证据/ 推理/ 规则/ ,/ 利用/ D/ -/ S/ 证据/ 推理/ 引擎/ 计算/ 脆弱性/ 利用/ 威胁/ 度/ ;/ 与/ 传统/ 脆弱性/ 利用/ 分析方法/ 相比/ ,/ 本/ 方法/ 选择/ D/ -/ S/ 证据/ 来/ 描述/ 系统/ 中/ 的/ 不确定性/ ,/ 因而/ 更/ 具有/ 合理性/ ./ 本文/ 最后/ 以/ 典型/ Web/ 业务/ 系统/ 为例/ ,/ 验证/ 了/ 本文/ 所述/ 安全/ 威胁/ 和/ 识别方法/ 有效性/ ./ 进一步/ 研究/ 工作/ 包括/ :/ (/ 1/ )/ 考虑/ 在/ 基于/ CPN/ 的/ 网络攻击/ 图和子/ 攻击/ 图上/ 实现/ 更/ 多/ 的/ 攻击/ 图/ 分析方法/ ,/ 包括/ 基于/ 子/ 攻击/ 图/ 的/ 攻击/ 预测/ 等/ ;/ (/ 2/ )/ 寻找/ 一种/ 更/ 合理/ 的/ D/ -/ S/ 初始/ 证据/ 的/ 可信度/ 赋值/ 方法/ ./ 

