Page1/ 耦合/ 几何/ 特征/ 的/ 高精度/ 流体/ 动画/ 建模/ 方法/ 刘弘/ 1/ )/ ,/ 2/ )/ 1/ )/ (/ 山东师范大学/ 信息科学/ 与/ 工程学院/ 济南/ 250014/ )/ 2/ )/ (/ 山东省/ 分布式/ 计算机软件/ 新/ 技术/ 重点/ 实验室/ 济南/ 250014/ )/ 3/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 摘要/ 动漫/ 制作/ 中/ 涉及/ 到/ 大量/ 的/ 流体/ 动画/ 特效/ ,/ 视觉/ 逼真性/ 是/ 它们/ 的/ 基本/ 追求/ ./ 然而/ ,/ 传统/ 的/ 物理/ 模型/ 计算/ 代价/ 高/ 、/ 效率/ 低且/ 流体/ 细节/ 易/ 丢失/ ./ 针对/ 这些/ 问题/ ,/ 文中/ 提出/ 一种/ 耦合/ 几何/ 特征/ 的/ 高精度/ 流体/ 动画/ 生成/ 方法/ ,/ 通过/ 利用/ 不同/ 流体/ 细节/ (/ 如/ 水面/ 和/ 水花/ )/ 之间/ 的/ 相关性/ 提高/ 计算/ 效率/ 和/ 计算精度/ ./ 该/ 方法/ 首先/ 建立/ 几何/ 模型/ ,/ 对/ 流体/ 表面/ 易于/ 产生/ 流体/ 细节/ 的/ 区域/ 即/ 细节/ 敏感区域/ 进行/ 定位/ 、/ 量化/ 和/ 跟踪/ ./ 然后/ 将/ 几何/ 模型/ 与/ 高精度/ 流体/ 动画/ 物理/ 模型/ 相/ 耦合/ ,/ 通过/ 将/ 几何/ 模型/ 中/ 的/ 定位/ 量化/ 函数/ 映射/ 为/ 粒子/ 密度/ 函数/ ,/ 以此/ 调整/ 物理/ 模型/ 中/ 的/ 粒子/ 集/ ,/ 从而/ 更/ 有效/ 地/ 产生/ 高精度/ 的/ 流体/ 水面/ 和/ 水花/ 等/ 细节/ 效果/ ./ 实验/ 结果表明/ ,/ 文中/ 方法/ 能够/ 提高/ 流体/ 动画/ 计算/ 的/ 效率/ 和/ 精度/ ,/ 高效/ 地/ 生成/ 更/ 具有/ 视觉/ 真实感/ 的/ 流体/ 动画/ ./ 关键词/ 几何/ 特征/ ;/ 高精度/ 流体/ 动画/ ;/ 粒子/ 分布/ ;/ 粒子/ 水平/ 集/ ;/ 光滑/ 粒子/ 流体/ 动力学/ ;/ 纳维/ -/ 斯托克斯/ 方程/ 1/ 引言/ 近年来/ ,/ 动漫/ 制作/ 产业/ 已经/ 成为/ 我国/ 重要/ 的/ 产业/ 之一/ ./ 动漫/ 制作/ 中/ 涉及/ 到/ 大量/ 的/ 流体/ 动画/ 特效/ 如水/ 、/ 烟/ 、/ 火等/ ./ 在/ 这些/ 流体/ 动画/ 中/ ,/ 视觉/ 逼真性/ 是/ 基本/ 的/ 追求/ ./ 然而/ 流体/ 运动/ 极其/ 复杂/ ,/ 如何/ 自动/ 计算/ 并/ 渲染/ 生成/ 具有/ 丰富/ 细节/ 的/ 高精度/ 流体/ 动画/ 是/ 一项/ 很/ 有/ 挑战性/ 的/ 课题/ ./ 目前/ ,/ 为了/ 生成/ 视觉/ 逼真/ 的/ 流体/ 动画/ ,/ 研究者/ 通常/ 使用/ 流体/ 物理/ 模型/ 计算/ 动态变化/ 的/ 速度/ 场/ ,/ 并/ 对/ 流体/ 介质/ 进行/ 建模/ 和/ 渲染/ 来/ 完成/ [/ 1/ ]/ ./ 但/ 流体/ 物理/ 模型/ 的/ 数值/ 求解/ 产生/ 的/ 耗散/ 问题/ 会/ 使/ 尖锐/ 和/ 突变/ 的/ 几何/ 特征/ 平滑/ 化/ ,/ 导致/ 流体/ 细节/ 缺失/ ,/ 影响/ 流体/ 动画/ 的/ 效果/ [/ 2/ ]/ ./ 为此/ ,/ 研究/ 人员/ 使用/ 多/ 物理/ 模型/ 方法/ 克服/ 上述/ 问题/ ./ 该/ 方法/ 通过/ 在/ 流体/ 运动/ 模型/ 的/ 基础/ 上/ ,/ 耦合/ 其他/ 物理/ 模型/ (/ 如/ 高精度/ 表面/ 跟踪/ 模型/ [/ 3/ ]/ 、/ 波浪/ 模型/ [/ 4/ ]/ 、/ 水花/ 模型/ [/ 5/ ]/ 、/ 气泡/ 模型/ [/ 6/ ]/ 等/ )/ 从而/ 产生/ 流体/ 高精度/ 细节/ ./ 由于/ 需要/ 求解/ 多个/ 物理/ 模型/ ,/ 此/ 方法/ 存在/ 运算/ 复杂/ 、/ 计算/ 代价/ 高/ 的/ 问题/ ./ 另外/ 一种/ 常用/ 方法/ 就是/ 自/ 适应/ 方法/ [/ 7/ -/ 8/ ]/ ./ 该/ 方法/ 在/ 细节/ 丰富/ 区域/ 或/ 用户/ 感兴趣/ 区域/ 使用/ 高精度/ 计算/ ,/ 而/ 在/ 其他/ 区域/ 使用/ 低/ 精度/ 计算/ 的/ 方式/ ,/ 以/ 缓解/ 计算/ 消耗/ 大/ 的/ 问题/ ./ 然而/ 目前/ 的/ 自/ 适应/ 技术/ (/ 如/ 空间/ 网格/ 的/ 自/ 适应/ [/ 7/ ]/ 、/ 拉格朗/ 日/ 粒子/ 集/ 的/ 自/ 适应/ [/ 8/ ]/ 等/ )/ 基本上/ 在/ 单一/ 物理/ 模型/ 上/ 展开/ ,/ 难以/ 同时/ 表达/ 流体/ 运动/ 的/ 多/ 尺度/ 细节/ ./ 事实上/ ,/ 高精度/ 流体/ 动画/ 包含/ 了/ 丰富/ 的/ 几何/ 信息/ ,/ 如/ 拓扑/ 多变/ 的/ 水面/ 、/ 飞溅/ 的/ 水花/ 等/ ./ 这些/ 信息/ 是/ 流体/ 运动/ 行为/ 的/ 外/ 在/ 表现/ ,/ 是/ 在/ 有限/ 计算资源/ 条件/ 下/ 增强/ 流体/ 动画/ 视觉效果/ 的/ 有效途径/ ./ 本文/ 将/ 高精度/ 流体/ 运动/ 的/ 几何/ 信息/ 体现/ 的/ 特点/ 归为/ 两个/ :/ (/ 1/ )/ 不同/ 流体/ 细节/ 之间/ 存在/ 密切相关/ 性/ ./ 例如/ ,/ 只有/ 在/ 水面/ 产生/ 大/ 的/ 几何/ 变形/ 或/ 具有/ 尖锐/ 几何/ 特征/ 时/ ,/ 才/ 会/ 产生/ 丰富/ 的/ 水花/ 效果/ ./ 当前/ 方法/ 中/ 没有/ 考虑/ 到/ 流体/ 不同/ 细节/ 之间/ 的/ 相关性/ ,/ 并未/ 据此/ 实现/ 对/ 计算资源/ 的/ 优化/ 配置/ ./ (/ 2/ )/ 同/ 一种/ 细节/ 在/ 不同/ 区域/ 存在/ 差异性/ ./ 例如/ ,/ 水面/ 上/ 有些/ 区域/ 相对/ 平坦/ 细节/ 较/ 少/ 、/ 而/ 有些/ 区域/ 相对/ 湍急/ 细节/ 较/ 多/ ./ 当前/ 的/ 自/ 适应/ 的/ 方法/ 特别/ 是/ 网格/ 自/ 适应/ 技术/ 往往/ 对/ 靠近/ 流体/ 表面/ 所有/ 区域/ 使用/ 相同/ 的/ 计算精度/ ,/ 没有/ 考虑/ 表面/ 细节/ 的/ 差异性/ ./ 针对/ 以上/ 分析/ ,/ 本文/ 挖掘/ 并/ 利用/ 流体/ 动画/ 中/ 不同/ 细节/ 效果/ 之间/ 的/ 相关性/ ,/ 同时/ 考虑/ 同一/ 细节/ 在/ 不同/ 区域/ 的/ 差异性/ ,/ 提出/ 了/ 一种/ 耦合/ 几何/ 特征/ 的/ 高精度/ 流体/ 动画/ 建模/ 方法/ ./ 该/ 方法/ 通过/ 几何/ 模型/ 定位/ 和/ 跟踪/ 流体/ 表面/ 上/ 易于/ 丢失/ 细节/ 的/ 局部/ 区域/ ,/ 并/ 对/ 细节/ 缺失/ 程度/ 进行/ 量化/ ,/ 以此/ 控制/ 物理/ 模型/ 并/ 最终/ 产生/ 高精度/ 流体/ 细节/ ./ 同时/ ,/ 本文/ 方法/ 还/ 能/ 有效/ 利用/ 细节/ 之间/ 的/ 相关性/ 以及/ 表面/ 不同/ 区域/ 的/ 差异性/ 进行/ 合理/ 的/ 资源/ 分布/ ./ 本文/ 方法/ 只/ 对/ 粒子/ 集/ 进行/ 控制/ ,/ 使用/ 的/ 是/ 结构化/ 网格/ ,/ 因此/ 具备/ 计算/ 简单/ 、/ 高效/ 的/ 特性/ ./ 控制/ 后/ 的/ 物理/ 模型/ 不仅/ 能/ 提高/ 水面/ 模拟/ 的/ 精度/ ,/ 而且/ 能够/ 生成/ 丰富/ 的/ 水花/ 细节/ ./ 2/ 相关/ 工作/ 流体/ 动画/ 作为/ 自然/ 现象/ 模拟/ 的/ 重要/ 分支/ ,/ 是/ 计算机/ 动画/ 的/ 研究/ 热点/ 之一/ ./ 在/ 过去/ 的/ 十几年/ 里/ ,/ 该/ 领域/ 一直/ 致力于/ 研究/ 如何/ 生成/ 具有/ 真实感/ 的/ 流体/ 运动/ ./ 它/ 涉及/ 两项/ 关键技术/ :/ 一是/ 计算/ 动态变化/ 的/ 流体/ 速度/ 场/ ;/ 二是/ 对/ 流体/ 介质/ 的/ 建模/ 与/ 渲染/ ./ 在/ 实时/ 游戏/ 中/ ,/ 流体/ 效果/ 的/ 产生/ 通常/ 是/ 将/ 上述/ 两项/ 关键技术/ 合并/ 在/ 一起/ 处理/ ./ 常见/ 的/ 方法/ 有/ [/ 9/ -/ 10/ ]/ :/ 快速/ 傅里叶/ 变换/ 、/ 表面/ 法向/ 扰动/ 、/ 过程/ 纹理/ 等/ ./ 它们/ 主要/ 应用/ 于/ 模拟/ 理想/ 天气/ 下/ 的/ 流体/ 运动/ 如/ 风平浪静/ 的/ 效果/ 或/ 简单/ 的/ 水花/ ,/ 很难/ 表达/ 物理/ 上/ 真实/ 的/ 运动/ 如流固/ 耦合/ 等/ ./ 此外/ ,/ 该/ 方法/ 的/ 视觉效果/ 主要/ 来自/ 美工/ 的/ 手动/ 调试/ 或者/ 程序员/ 的/ 设计/ ,/ 场景/ 依赖性/ 强/ ,/ 重复/ 利用率/ 不高/ ./ 为了/ 有效/ 获得/ 动态变化/ 的/ 流体/ 速度/ 场/ ,/ 一些/ 研究者/ 开始/ 关注/ 并/ 使用/ 纳维/ -/ 斯托克斯/ (/ Navier/ -/ Stokes/ ,/ NS/ )/ 方程/ ,/ 奠定/ 了/ 在/ 流体/ 动画/ 领域/ 使用/ 物理/ 模型/ 的/ 里程碑/ [/ 1/ ]/ ./ 此后/ ,/ 基于/ 物理/ 的/ 流体/ 动画/ 方法/ 基本上/ 分为/ 两大类/ :/ 一类/ 是/ 欧拉/ 法/ [/ 1/ ,/ 7/ ]/ ,/ 通过/ 在/ 计算/ 域/ 网格/ 中/ 求解/ NS/ 方程/ 获得/ 流体/ 速度/ 场/ ./ 另一类/ 是/ 拉格朗/ 日法/ [/ 8/ ,/ 11/ ]/ ,/ 利用/ 粒子/ 携带/ 质量/ 、/ 速度/ 等/ 属性/ 计算/ 流体/ 速度/ 场/ ./ 在/ 拉格朗/ 日/ 方法/ 中/ ,/ 光滑/ 粒子/ 流体/ 动力学/ (/ SmoothParticleHydrodynamics/ ,/ SPH/ )/ 模型/ 最具/ 代表性/ [/ 8/ ,/ 11/ -/ 13/ ]/ ./ 基于/ 物理/ 的/ 方法/ 可以/ 获得/ 任意/ 初始条件/ 和/ 边界条件/ 下/ 的/ 流体/ 速度/ 场/ ,/ 能够/ 有效/ 模拟/ 流体/ 的/ 复杂/ 运动/ ./ 速度/ 场/ 的/ 获得/ 还/ 为/ 驱动/ 流体/ 介质/ 运动/ 、/ 获得/ 具有/ 视觉/ 真实感/ 的/ 流体/ 动画/ 奠定/ 了/ 基础/ ./ 视觉/ 逼真/ 的/ 流体/ 动画/ 离不开/ 对/ 流体/ 介质/ 的/ 建模/ 和/ 渲染/ ./ 对此/ ,/ 拉格朗/ 日法/ 和/ 欧拉/ 法/ 分别/ 使用/ 不同/ 的/ 方式/ ./ 拉格朗/ 日法/ 使用/ 粒子/ 模拟/ 流体/ 运动/ ,/ 液体/ 表面/ 的/ 获取/ 需要/ 对/ 粒子/ 集/ 使用/ 插值/ 方法/ [/ 14/ -/ 15/ ]/ 以/ 生成/ 多边形/ 网格/ ,/ 此类/ 方法/ 很难/ 获得/ 光滑/ 表面/ ./ 而/ 在/ 欧拉/ 法中/ ,/ 研究者/ 最初/ 提出/ 使用/ 隐式/ 表面/ 对/ 液体/ 表面/ 进/ Page3/ 行/ 建模/ 和/ 表达/ ./ 典型/ 的/ 方法/ 有/ 水平/ 集/ (/ LevelSet/ ,/ LS/ )/ [/ 16/ ]/ 和/ 粒子/ 水平/ 集/ (/ ParticleLevelSet/ ,/ PLS/ )/ [/ 1/ ]/ 等/ ./ 隐式/ 曲面/ 方法/ 使用/ 符号/ 距离/ 场/ 函数/ 表达/ 液体/ 表面/ ,/ 通过/ 求解/ LS/ 方程/ 获得/ 每个/ 时刻/ 运动/ 后/ 的/ 表面/ ./ 该/ 方法/ 能够/ 很/ 自然/ 的/ 处理/ 液体/ 表面/ 的/ 复杂/ 运动/ 导致/ 的/ 拓扑/ 变化/ 问题/ ,/ 可/ 生成/ 光滑/ 的/ 流体/ 表面/ ,/ 因此/ 在/ 流体/ 动画/ 领域/ 得到/ 了/ 广泛/ 的/ 应用/ ./ 然而/ ,/ 上述/ 方法/ 需要/ 求解/ NS/ 和/ LS/ 两组/ 偏/ 微分方程/ ,/ 由于/ 使用/ 有限/ 差分/ 方法/ 逼近/ 偏/ 微分方程/ ,/ 两者之间/ 的/ 误差/ 会/ 产生/ 数值/ 耗散/ 问题/ ./ 数值/ 耗散/ 相当于/ 对流/ 场/ 添加/ 人工/ 粘性/ ,/ 使/ 尖锐/ 和/ 突变/ 的/ 几何/ 特征/ 被/ 平滑/ 化/ ,/ 分辨率/ 降低/ ,/ 从而/ 导致/ 流体/ 细节/ 缺失/ ./ 故/ 此类/ 方法/ 的/ 计算精度/ 严重/ 依赖于/ 网格/ 分辨率/ ,/ 在/ 粗糙/ 网格/ 下/ ,/ 容易/ 产生/ 流体/ 细节/ 丢失/ [/ 2/ ]/ ./ 为了/ 提高/ 液体/ 表面/ 建模/ 和/ 渲染/ 的/ 精度/ ,/ 研究者/ 还/ 提出/ 使用/ 显式/ 表面/ 的/ 方法/ 解决/ 隐式/ 表面/ 精度/ 不高/ 的/ 问题/ [/ 3/ ,/ 17/ -/ 18/ ]/ ./ 其/ 基本原理/ 是/ 在/ 低/ 精度/ 计算/ 网格/ 中/ 嵌入/ 高精度/ 的/ 表面/ 跟踪/ 方法/ ./ 该/ 方法/ 使用/ 显式/ 多边形/ 网格/ 表达/ 液体/ 表面/ ,/ 因此/ ,/ 液体/ 表面/ 的/ 精度/ 不再/ 依赖于/ 底层/ 的/ 计算/ 网格/ ,/ 能/ 较/ 好/ 地/ 保持/ 流体/ 表面/ 的/ 细节/ ./ 然而/ ,/ 显式/ 表面/ 的/ 方法/ 需要/ 设计/ 有效/ 算法/ 处理/ 拓扑/ 变化/ 时/ 的/ 多边形/ 表面/ ./ 此外/ ,/ 高精度/ 的/ 显式/ 表面/ 和/ 低/ 精度/ 物理/ 模型/ 耦合/ 时/ ,/ 计算/ 网格/ 中/ 不能/ 捕捉到/ 的/ 高精度/ 细节/ 会/ 产生/ 细节/ 残留/ ,/ 导致/ 物理/ 上/ 不/ 正确/ 的/ 结果/ 和/ 视觉/ 错误/ [/ 19/ -/ 20/ ]/ ./ 上述/ 分析表明/ ,/ 相对/ 于/ 显式/ 曲面/ 方法/ ,/ 隐式/ 曲面/ 能/ 更/ 自然/ 地/ 处理/ 拓扑/ 变化/ ,/ 非常适合/ 表示/ 动态/ 液体/ 表面/ ./ 因此/ ,/ 本文/ 使用/ 隐式/ 曲面/ 的/ 方法/ —/ —/ —/ PLS/ 方法/ 跟踪/ 流体/ 表面/ ./ 然而/ ,/ 如前所述/ ,/ 隐式/ 曲面/ 方法/ 在/ 粗糙/ 网格/ 中/ 易于/ 产生/ 细节/ 缺失/ 问题/ ./ 因此/ ,/ 研究者/ 提出/ 诸多/ 方法/ 解决/ 该/ 问题/ ./ 目前/ ,/ 最/ 典型/ 的/ 方法/ 有/ 两类/ :/ 一类/ 是/ 多/ 物理/ 模型/ 的/ 方法/ ,/ 另一类/ 是/ 自/ 适应/ 方法/ ./ 多/ 物理/ 模型/ 通过/ 耦合/ 多个/ 不同/ 物理/ 模型/ 的/ 方法/ 产生/ 复杂/ 水面/ 、/ 水花/ 等/ 细节/ [/ 4/ ,/ 21/ -/ 22/ ]/ ./ 例如/ ,/ Losasso/ 等/ 人/ [/ 4/ ]/ 首先/ 使用/ 二维/ NS/ 方程/ 预计/ 算/ 海浪/ 形状/ ;/ 然后/ 使用/ 三维/ NS/ 方程/ ,/ 同时/ 耦合/ PLS/ 模型/ 和/ SPH/ 模型/ ,/ 捕捉/ 波浪/ 、/ 水花/ 细节/ ./ Chentanez/ 等/ 人/ [/ 21/ ]/ 使用/ 了/ 包括/ 高度/ 场/ 模型/ 和/ 粒子/ 模型/ 在内/ 的/ 两个/ 物理/ 模型/ ,/ 同时/ 通过/ 处理/ 复杂/ 的/ 边界条件/ 模拟/ 河流/ 表面/ 及/ 水花/ ./ Kim/ 等/ 人/ [/ 22/ ]/ 使用/ 最近/ 点/ 方法/ 在/ 三维/ 流体/ 表面/ 上/ 计算/ 二维/ 波动/ 方程/ 以/ 增加/ 流体/ 表面/ 的/ 细节/ ./ 此外/ ,/ 研究者/ 还/ 在/ 流体/ 动力学/ 模型/ 及/ 流体/ 表面/ 跟踪/ 模型/ 的/ 基础/ 上/ ,/ 通过/ 耦合/ 水花/ 模型/ [/ 5/ ]/ 、/ 气泡/ 模型/ [/ 6/ ]/ 等/ ,/ 产生/ 丰富/ 的/ 流体/ 动画/ 效果/ ./ 上述/ 方法/ 集中/ 在/ 选择/ 什么/ 物理/ 模型/ 以及/ 如何/ 耦合/ 这些/ 物理/ 模型/ 方面/ ,/ 其/ 模型/ 计算/ 代价/ 高/ ./ 自/ 适应/ 方法/ 可以/ 有效/ 缓解/ 模型/ 计算/ 量/ 大/ 的/ 问题/ [/ 23/ -/ 25/ ]/ ./ 该/ 方法/ 中/ 最具/ 代表性/ 的/ 工作/ 就是/ 空间/ 网格/ 的/ 自/ 适应/ 细分/ ,/ 如八叉树/ 的/ 方法/ [/ 26/ ]/ 、/ 非/ 结构化/ 的/ 四面体/ 网格法/ 等/ [/ 27/ -/ 29/ ]/ 、/ 有限元/ 四面体/ 网格法/ 等/ [/ 30/ -/ 31/ ]/ ./ 此类/ 方法/ 中/ 网格/ 大小/ 可/ 随/ 需求/ 光滑/ 变化/ ,/ 其/ 形状/ 也/ 很/ 容易/ 达到/ 与/ 复杂/ 边界/ 对齐/ 的/ 目标/ ,/ 所以/ 能够/ 捕捉到/ 高精度/ 流体/ 细节/ ./ 然而/ ,/ 四面体/ 网格法/ 的/ 计算精度/ 依赖于/ 网格/ 生成/ 的/ 质量/ ,/ 而/ 高质量/ 的/ 、/ 与/ 复杂/ 边界/ 对齐/ 的/ 网格/ 生成/ 往往/ 需要/ 花费/ 大量/ 的/ 计算/ 时间/ ,/ 成为/ 此类/ 方法/ 的/ 瓶颈/ 问题/ [/ 32/ ]/ ./ 为了/ 避免/ 处理/ 四面体/ 网格/ ,/ English/ 等/ 人/ [/ 33/ ]/ 通过/ 使用/ 多种不同/ 精度/ 的/ 规则/ 网格/ 实现/ 自/ 适应/ 计算/ ./ 此外/ ,/ Irving/ 等/ 人/ [/ 34/ ]/ 及/ Chentanez/ 等/ 人/ [/ 7/ ]/ 只是/ 在/ 计算/ 域/ 的/ 垂直/ 方向/ 进行/ 自/ 适应/ 处理/ ,/ 通过/ 在/ 距离/ 表面/ 较远/ 的/ 位置/ 使用/ 细长/ 网格/ 以/ 节省/ 计算资源/ ./ 尽管/ 空间/ 网格/ 的/ 自/ 适应/ 细分/ 能够/ 根据/ 需求/ 计算/ 高精度/ 细节/ ,/ 但/ 其/ 产生/ 的/ 非/ 结构化/ 或/ 半/ 结构化/ 的/ 网格/ 会/ 导致/ 计算/ 复杂性/ 增加/ [/ 35/ ]/ ,/ 制约/ 了/ 其/ 可用性/ ./ 除了/ 对/ 网格/ 的/ 自/ 适应/ 划分/ ,/ 研究者/ 还/ 将/ 自/ 适应/ 思想/ 引入/ 到/ 拉格朗/ 日/ 方法/ 中/ ./ 例如/ ,/ Ando/ 等/ 人/ [/ 32/ ]/ 利用/ 粒子/ 在/ 空间/ 上/ 的/ 自/ 适应/ 分布/ ,/ 模拟/ 流体/ 的/ 细长/ 面片/ ./ 在/ SPH/ 方法/ 中/ ,/ 空间/ 自/ 适应/ 方法/ [/ 15/ ]/ 和/ 双/ 尺度/ 方法/ [/ 8/ ]/ 也/ 被/ 相继/ 提出/ 和/ 应用/ ./ 拉格朗/ 日法/ 中/ 的/ 自/ 适应/ 技术/ 无需/ 生成/ 复杂/ 的/ 四面体/ 网格/ ,/ 因此/ 计算/ 简单/ 、/ 高效/ ./ 然而/ ,/ 针对/ 拉格朗/ 日/ 粒子/ 集/ 设计/ 的/ 自/ 适应/ 方法/ 很难/ 直接/ 应用/ 于/ 欧拉/ 法中/ ./ 因此/ ,/ 目前/ 的/ 自/ 适应/ 方法/ 不能/ 充分利用/ 拉格朗/ 日法/ 和/ 欧拉/ 法/ 两类/ 方法/ 的/ 优势/ 表现/ 流体/ 运动/ 的/ 多种/ 细节/ ./ 与/ 已有/ 方法/ 不同/ ,/ 本文/ 方法/ 可以/ 应用/ 于/ 欧拉/ 法/ 和/ 拉格朗/ 日/ 法相/ 结合/ 的/ 流体/ 模型/ 中/ ,/ 能够/ 同时/ 表达/ 流体/ 动画/ 中/ 的/ 多种/ 细节/ ,/ 如/ 光滑/ 水面/ 、/ 飞溅/ 的/ 水花/ 等/ ./ 为/ 达成/ 上述/ 目标/ ,/ 本文/ 挖掘/ 并/ 利用/ 流体/ 动画/ 中/ 细节/ 效果/ 之间/ 的/ 相关性/ ,/ 通过/ 欧拉/ 法/ 获取/ 流体/ 表面/ 数据/ 并/ 建立/ 几何/ 模型/ 计算/ 细节/ 敏感区域/ ./ 然后/ 将/ 获取/ 的/ 几何/ 特征/ 与/ 物理/ 模型/ 相/ 耦合/ ,/ 指导/ 粒子/ 集/ 的/ 自/ 适应/ 分布/ ,/ 以/ 有效/ 利用/ 细节/ 之间/ 的/ 相关性/ 以及/ 表面/ 不同/ 区域/ 之间/ 的/ 差异性/ 等/ 几何/ 特征/ ./ 实验/ 结果表明/ ,/ 本文/ 方法/ 能够/ 高效/ 生成/ 流体/ 的/ 多种/ 细节/ ./ 此外/ ,/ 由于/ 我们/ 使用/ 的/ 是/ 结构化/ 网格/ ,/ 因此/ 具备/ 计算/ 简单/ 、/ 高效/ 的/ 特性/ ./ Page43/ 算法/ 综述/ 本文/ 方法/ 包括/ 几何/ 模型/ 、/ 物理/ 模型/ 以及/ 耦合/ 模型/ 3/ 个/ 部分/ ./ 其中/ ,/ 物理/ 模型/ 是/ 基础/ ,/ 它/ 能够/ 精确/ 刻画/ 流体/ 的/ 运动/ 特征/ ;/ 几何/ 模型/ 是/ 关键/ ,/ 该/ 模型/ 能够/ 高效/ 光滑/ 地/ 定位/ 、/ 量化/ 和/ 跟踪/ 流体/ 细节/ 敏感区域/ ;/ 耦合/ 模型/ 是/ 接口/ ,/ 它/ 使用/ 几何/ 模型/ 控制/ 物理/ 模型/ ,/ 提高/ 流体/ 表面/ 计算/ 的/ 精度/ 和/ 刻画/ 水花/ 细节/ ./ 本文/ 方法/ 的/ 输入/ 是/ 流体/ 动画/ 的/ 初始条件/ 和/ 边界条件/ ./ 其中/ ,/ 初始条件/ 包括/ 初始化/ 的/ 液体/ 表面/ 和/ 流体/ 速度/ 场/ 、/ 粒子/ 集等/ ./ 边界条件/ 是/ 将/ 流体/ 运动/ 所在/ 的/ 环境/ 模型/ 利用/ 体素化/ 方法/ 转化/ 为/ 方程/ 计算/ 时/ 可/ 识别/ 的/ 边界/ [/ 36/ ]/ ./ 它/ 包含/ 两个/ 部分/ :/ 固体/ 与/ 液体/ 边界/ 和/ 空气/ 图/ 1/ 本文/ 方法/ 的/ 框架/ 4/ 基于/ 物理/ 模型/ 的/ 参数/ 获取/ 物理/ 模型/ 中/ 的/ 参数/ 获取/ 有/ 两个/ 方面/ 的/ 作用/ :/ 一是/ 获取/ 的/ 参数/ 用于/ 几何/ 特征/ 的/ 计算/ ;/ 二是/ 获取/ 参数/ 用于/ 真实感/ 渲染/ ,/ 生成/ 动画/ 效果/ ./ 为了/ 完成/ 上述/ 两个/ 方面/ 的/ 需求/ ,/ 本文/ 需要/ 获取/ 以下/ 参数/ :/ (/ 1/ )/ 符号/ 距离/ 场/ 函数/ ./ 几何/ 特征/ 的/ 计算/ 利用/ 了/ 流体/ 细节/ 之间/ 的/ 相关性/ ./ 只有/ 在/ 水面/ 产生/ 大/ 的/ 几何/ 变形/ 或/ 具有/ 尖锐/ 几何/ 特征/ 时/ ,/ 才/ 会/ 产生/ 丰富/ 的/ 水花/ 效果/ ./ 因此/ 需要/ 获取/ 水面/ 参数/ ,/ 即/ 符号/ 距离/ 场/ 函数/ ;/ (/ 2/ )/ 流体/ 动态/ 速度/ 场/ ./ 由于/ 几何/ 特征/ 是/ 随/ 时间/ 变化/ 的/ ,/ 因此/ 还/ 需要/ 计算/ 动态变化/ 的/ 流体/ 速度/ 场/ ;/ (/ 3/ )/ 三角形/ 网格/ 表面/ ./ 流体/ 动画/ 的/ 真实感/ 渲染/ 需要/ 流体/ 表面/ 和/ 水花/ 粒子/ 形成/ 的/ 三角形/ 网格/ 表面/ ./ 令/ Ω/ 表示/ 计算/ 域/ ,/ 计算/ 域/ 网格/ 记为/ G/ ./ 令/ 符号/ 距离/ 场/ 函数/ / (/ 狓/ ,/ t/ )/ 表示/ 液体/ 表面/ ,/ 其/ 函数/ 值为/ t/ 时刻/ 网格/ 中心/ 狓/ 到/ 液体/ 表面/ 的/ 符号/ 距离/ [/ 1/ ]/ ./ 显然/ ,/ 在/ 液体/ 表面/ 上/ ,/ 满足/ / (/ 狓/ ,/ t/ )/ =/ 0/ ,/ 记/ 为/ / Ω/ ;/ 液体/ 内部/ 满足/ / (/ 狓/ ,/ t/ )/ </ 0/ ,/ 记/ 为/ Ω/ -/ ;/ 在/ 液体/ 外部/ 满足/ / (/ 狓/ ,/ t/ )/ >/ 0/ ,/ 记/ 为/ Ω/ +./ 4.1/ 流体/ 动态/ 速度/ 场/ 的/ 获取/ 设/ 当前/ 时间/ 步为/ n/ ,/ 计算/ 域/ 网格/ G/ 中/ 的/ 流体/ 速/ 与/ 液体/ 边界/ ./ 如图/ 1/ 所示/ ,/ 给定/ 输入/ 后/ ,/ 本文/ 方法/ 的/ 主要/ 步骤/ 有/ 3/ 个/ ,/ 即/ 基于/ 物理/ 模型/ 的/ 参数/ 获取/ 、/ 几何/ 模型/ 的/ 建立/ 、/ 几何/ 模型/ 与/ 物理/ 模型/ 的/ 耦合/ ./ 首先/ 在/ 初始条件/ 和/ 边界条件/ 的/ 基础/ 上/ 计算/ 物理/ 模型/ ,/ 获取/ 几何/ 计算所/ 需/ 的/ 参数/ ,/ 如/ 窄带/ 上/ 的/ 符号/ 距离/ 场/ 函数/ 、/ 速度/ 场/ ./ 其次/ ,/ 根据上述/ 参数/ 计算/ 几何/ 特征/ ./ 本文/ 定义/ 并/ 计算/ 细节/ 敏感区域/ 的/ 动态/ 定位/ 量化/ 函数/ ,/ 实现/ 对大/ 曲率/ 、/ 细长/ 、/ 边界/ 等/ 细节/ 敏感区域/ 的/ 光滑/ 定位/ 、/ 量化/ 和/ 跟踪/ ./ 第三/ ,/ 根据/ 动态/ 定位/ 量化/ 函数/ ,/ 更新/ 物理/ 模型/ 中/ 的/ 粒子/ 集/ ,/ 实现/ 几何/ 模型/ 与/ 物理/ 模型/ 的/ 耦合/ ./ 最后/ ,/ 从/ 数值/ 计算结果/ 中/ 提取/ 流体/ 表面/ 和/ 流体/ 水花/ 的/ 几何/ 表示/ ,/ 结合/ 真实感/ 渲染/ 技术/ 即可/ 获得/ 每帧/ 的/ 流体/ 动画/ [/ 1/ ]/ ./ 我们/ 将/ 在/ 下面/ 的/ 几个/ 小节/ 中/ 介绍/ 本文/ 方法/ 的/ 细节/ ./ 度场/ 为/ 狌/ n/ ,/ SPH/ 粒子/ 集/ Ps/ 中/ 的/ 粒子/ 速度/ 为/ 狌/ n/ 计算/ n/ +/ 1/ 时刻/ 动态/ 流体/ 速度/ 场/ 狌/ n/ +/ 1/ ,/ 需要/ 求解/ 流体/ 运动/ 的/ NS/ 方程/ 其中/ ,/ d/ ρ/ // dt/ =/ / ρ/ // / t/ +/ 狌/ ·/ / ρ/ ,/ ρ/ 为/ 密度/ ,/ 狌/ 为/ 流体/ 速度/ ,/ p/ 为/ 压强/ ,/ t/ 为/ 时间/ ,/ 犳/ 为/ 外力/ ,/ / ·/ 为/ 散度/ ,/ / 为/ 梯度/ ./ 求解/ 步骤/ 如下/ :/ (/ 1/ )/ 计算/ 流体/ 中间/ 速度/ 场/ 狌/ / 对于/ Ω/ -/ ∪/ / Ω/ 区域/ 上/ 的/ 每个/ 网格/ 单元/ ,/ 已知/ 当前/ 时刻/ 流体/ 速度/ 场/ 狌/ n/ ,/ 可/ 通过/ 执行/ 对流/ 和/ 添加/ 外力/ 两个/ 步骤/ 得到/ 中间/ 速度/ 场/ 狌/ / ./ 其中/ ,/ 对流/ 步骤/ 可以/ 使用/ 半/ 拉格朗/ 日法/ [/ 37/ ]/ 求解/ / 狌/ // / t/ =/ -/ (/ 狌/ ·/ / )/ 狌/ ./ 添加/ 外力/ 步骤/ 可/ 表示/ 为/ 狌/ / =/ 狌/ (/ 狓/ )/ +/ Δ/ t/ 犳/ (/ 狓/ ,/ t/ )/ ,/ Δ/ t/ 为/ 时间/ 步长/ ./ 对于/ Ω/ +/ 区域/ ,/ 需/ 计算/ Ps/ 粒子/ 集/ 所在/ 的/ 每个/ 网格/ 单元/ 中/ 的/ 狌/ / ./ 为此/ ,/ 我们/ 首先/ 添加/ 外力/ 得/ 狌/ / 狌/ p/ +/ Δ/ t/ 犳/ ,/ 然后/ 再/ 将/ 其/ 投影/ 到/ 网格/ G/ 中/ ,/ 得/ 网格/ 点/ 狓/ 处/ 的/ 中间/ 速度/ 狌/ / (/ 狓/ )/ =/ ∑/ 狌/ / 粒子/ 的/ 贡献/ 大小/ ω/ p/ (/ 狓/ )/ =/ Page5c/ 为/ 控制/ 常数/ ,/ 狓/ p/ 为/ Ps/ 粒子/ 的/ 位置/ ,/ rp/ 为/ 粒子/ 半径/ ./ (/ 2/ )/ 根据/ 狌/ / ,/ 计算/ 流体/ 速度/ 场/ 狌/ n/ +/ 1/ 获得/ 狌/ / 后/ ,/ 方程/ (/ 2/ )/ 右侧/ 只/ 剩下/ -/ 1/ // ρ/ / p/ ,/ 利用/ 有限/ 差分/ 展开/ 两侧/ 同时/ 取散度/ ,/ 得/ 压强/ 泊松/ 方程/ 在/ 式/ (/ 4/ )/ 中/ ,/ / ·/ 狌/ n/ +/ 1/ 在/ 计算/ 域/ 的/ 不同/ 位置/ 取值/ 不同/ ./ Ω/ -/ ∪/ / Ω/ 区域/ 属于/ 液体/ 内部/ ,/ 具有/ 严格/ 的/ 不/ 可压缩性/ ,/ 故/ / ·/ 狌/ n/ +/ 1/ =/ 0/ ./ 而/ 在/ Ω/ +/ 区域/ ,/ 液态/ 粒子/ 与/ 空气/ 混合/ ,/ 具有/ 一定/ 可压缩性/ ,/ / ·/ 狌/ n/ +/ 1/ ≠/ 0/ ,/ 其值/ 可以/ 根据/ 网格/ 单元/ 中/ Ps/ 粒子/ 个数/ 与/ 目标/ 粒子/ 数/ 估计/ [/ 4/ ]/ ./ 这样/ ,/ 方程/ (/ 4/ )/ 右侧/ 为/ 已知/ ,/ 方程/ (/ 4/ )/ 即可/ 转化/ 为/ 关于/ 压强/ p/ 的/ 线性方程组/ ,/ 然后/ 再/ 利用/ 预/ 条件/ 共轭/ 梯度/ 法/ 高效/ 求解/ ./ 最后/ 将/ p/ 代入/ 式/ (/ 3/ )/ ,/ 可/ 得/ 流体/ 区域/ 中新/ 的/ 速度/ 场/ ./ 最后/ 用/ 速度/ 外/ 推/ 方法/ [/ 1/ ]/ 将/ 流体/ 区域/ 中/ 的/ 速度/ 外/ 推到/ 空气/ 网格/ 中/ 获取/ 背景/ 网格/ G/ 中/ 的/ 速度/ 场/ 狌/ n/ +/ 1/ ./ 该/ 速度/ 场/ 用于/ 动态/ 跟踪/ 几何/ 特征/ 的/ 变化/ ./ 4.2/ 水面/ 参数/ 的/ 获取/ 几何/ 特征/ 的/ 计算/ 还/ 需要/ 获取/ 符号/ 距离/ 场/ 函数/ / (/ 狓/ ,/ t/ )/ ./ 给定/ 当前/ 时间/ 步/ n/ ,/ 对应/ 的/ 符号/ 距离/ 场/ 函数/ 为/ / n/ ,/ 我们/ 需要/ 计算/ 更新/ 后/ 的/ 符号/ 距离/ 场/ 函数/ / n/ +/ 1/ ,/ 为此/ ,/ 利用/ 半/ 拉格朗/ 日法/ [/ 37/ ]/ 求解/ LS/ 方程/ 得/ 未/ 校正/ 的/ 符号/ 距离/ 场/ 函数/ / n/ +/ 1/ 更新/ 后/ 的/ 流体/ 速度/ 场/ ./ 为了/ 避免/ 使用/ 半/ 拉格朗/ 日法/ 进行/ 对流/ 所/ 产生/ 的/ 过/ 大/ 误差/ ,/ 还/ 需要/ 使用/ 检测/ 校正/ 粒子/ 集/ Pn/ 终/ 获得/ 更新/ 后/ 的/ 符号/ 距离/ 场/ 函数/ / n/ +/ 1/ ./ 流体/ 动画/ 的/ 真实感/ 渲染/ 还/ 需要/ 获取/ 流体/ 表面/ 和/ 水花/ 粒子/ 形成/ 的/ 三角形/ 网格/ 表面/ ./ 为此/ ,/ 我们/ 使用/ 移动/ 立方体/ 算法/ 提取/ / =/ 0/ 的/ 液体/ 表面/ 所/ 对应/ 的/ 三角形/ 网格/ [/ 1/ ]/ ./ 对于/ 流体/ 水花/ 而言/ ,/ 在/ 更新/ Ps/ 中/ 所有/ 粒子/ 的/ 位置/ 狓/ n/ +/ 1/ 表示/ 水花/ 的/ 高精度/ 三角形/ 网格/ ./ 对/ 上述/ 水面/ 、/ 水花/ 的/ 三角形/ 网格/ 进行/ 真实感/ 渲染/ 后/ 即可/ 获得/ 每帧/ 的/ 流体/ 动画/ ./ 5/ 几何/ 模型/ 流体/ 动画/ 中/ 的/ 几何/ 信息/ 是/ 流体/ 运动/ 行为/ 的/ 外/ 在/ 表现/ ,/ 也/ 是/ 在/ 有限/ 资源/ 下/ 增强/ 真实感/ 的/ 有效途径/ ./ 本文/ 利用/ 已/ 获取/ 的/ 参数/ 进行/ 几何/ 特征/ 的/ 计算/ ,/ 其/ 目的/ 是/ 充分利用/ 细节/ 之间/ 的/ 相关性/ 以及/ 表面/ 不同/ 区域/ 之间/ 的/ 差异性/ 进行/ 合理/ 的/ 资源/ 分布/ ./ 几何/ 特征/ 的/ 计算/ 主要/ 包括/ 两个/ 部分/ :/ 一是/ 对/ 细节/ 敏感区域/ 的/ 定位/ 和/ 量化/ ;/ 二是/ 对/ 该/ 区域/ 的/ 动态/ 跟踪/ ./ 5.1/ 细节/ 敏感区域/ 的/ 定位/ 和/ 量化/ 细节/ 敏感区域/ 位于/ 流体/ 表面/ 易于/ 产生/ 流体/ 细节/ 的/ 位置/ ,/ 这些/ 位置/ 也/ 往往/ 是/ 细节/ 丢失/ 最为/ 严重/ 的/ 区域/ ,/ 如大/ 曲率/ 、/ 细长/ 区域/ 和/ 界面/ 边界/ 等/ 区域/ [/ 2/ ,/ 15/ ,/ 22/ ]/ ./ 我们/ 将/ 所/ 获取/ 的/ 水面/ 参数/ 作为/ 输入/ ,/ 通过/ 计算/ 定位/ 和/ 量化/ 函数/ ,/ 实现/ 对大/ 曲率/ 、/ 细长/ 、/ 边界/ 等/ 细节/ 敏感区域/ 的/ 光滑/ 定位/ 和/ 量化/ ./ 该/ 函数/ 可/ 确定/ 整个/ 计算/ 域/ 中/ 细节/ 所在/ 的/ 区域/ 以及/ 细节/ 的/ 多少/ ./ 5.1/ ./ 1/ 定位/ 和/ 量化/ 函数/ 的/ 定义/ 本文/ 定义/ 了/ 定位/ 量化/ 函数/ (/ LocationandQuanti/ -/ zationFunction/ ,/ LF/ )/ ,/ 其/ 定义域/ 为/ 液体/ 表面/ 及其/ 周围/ 的/ 窄带/ Ω/ b/ =/ Ω/ +/ 外侧/ 三层/ 网格/ 区域/ ,/ Ω/ -/ 区域/ ./ 给定/ 计算/ 域/ 上/ 的/ 一个/ 封闭/ 流形/ (/ 由/ 封闭/ 流体/ 界面/ 或者/ 非/ 封闭/ 的/ 流体/ 界面/ 与/ 计算/ 域/ 边界/ 形成/ )/ ,/ 定义/ 局部/ 中轴/ (/ LocalMedialAxis/ ,/ LMA/ )/ 为/ 该/ 封闭/ 流形/ 位于/ 窄带/ Ω/ b/ 上/ 的/ 内接/ 圆圆/ 心/ 的/ 轨迹/ ./ LMA/ 为/ 一个点/ 集/ ,/ 由于/ 该点/ 集是/ 封闭/ 流形/ 在/ Ω/ b/ 区域/ 上/ 的/ 内接/ 圆圆/ 心/ ,/ 因此/ ,/ LMA/ 上/ 的/ 每个/ 点/ 狆/ M/ 到/ 流体/ 表面/ 的/ 最近/ 点/ 至少/ 有/ 两个/ ./ 显然/ ,/ LMA/ 是/ 位于/ 窄带/ Ω/ b/ 上/ 的/ 中轴/ (/ MedialAxis/ ,/ MA/ )/ [/ 38/ ]/ ,/ 是/ MA/ 的/ 子集/ ./ 令/ 狓/ 为/ 计算/ 域/ 上/ 的/ 任意/ 一点/ ,/ 则/ 函数/ LF/ 定义/ 为/ LF/ (/ 狓/ )/ =/ 其中/ ,/ k/ 为/ 控制参数/ ,/ 控制/ 界面/ 内/ LF/ 的/ 值/ 随/ 距离/ 变化/ 的/ 剧烈/ 程度/ ,/ 本文/ 实验/ 中取/ k/ =/ 2/ ./ 狔/ 为/ 界面/ / Ω/ 上/ 距离/ 狓/ 的/ 最近/ 点/ ,/ L/ (/ 狓/ ,/ LMA/ )/ 表示/ 界面/ 上/ 的/ 点/ 狓/ 到/ LMA/ 的/ 距离/ ,/ 可/ 表示/ 为/ 由于/ 本文/ LMA/ 是/ MA/ 的/ 子集/ ,/ 因此/ ,/ 式/ (/ 6/ )/ 中/ 基于/ LMA/ 的/ LF/ 函数/ 很难/ 完整/ 的/ 表达/ 整个/ 几何/ 形状/ 的/ 厚度/ ./ 例如/ 在/ 图/ 2/ 中/ ,/ 边界/ 上/ 的/ 点/ 狓/ 1/ 和/ 狓/ 2/ 到/ LMA/ 的/ 距离/ 存在/ L/ (/ 狓/ 1/ ,/ LMA/ )/ </ L/ (/ 狓/ 2/ ,/ LMA/ )/ 的/ 关系/ ./ 两点/ 所在/ 的/ 形状/ 的/ 厚度/ 分别/ 为/ 它们/ 到/ MA/ 的/ 距/ Page6/ 离/ ,/ 即/ d1/ 和/ d2/ ./ 从图/ 中/ 可以/ 看出/ d1/ >/ d2/ ,/ 这/ 与/ 上述/ L/ 函数/ 的/ 计算结果/ L/ (/ 狓/ 1/ ,/ LMA/ )/ </ L/ (/ 狓/ 2/ ,/ LMA/ )/ 恰好相反/ ./ 事实上/ ,/ 在/ 实际/ 应用/ 中/ ,/ 尽管/ 点/ 狓/ 1/ 和/ 狓/ 2/ 处/ 的/ 厚度/ 有/ 区别/ ,/ 但/ 这种/ 区别/ 已经/ 不会/ 影响/ 我们/ 对/ 细节/ 最/ 敏感部位/ 如/ 狓/ 所在区域/ 的/ 定位/ ./ 因此/ ,/ 为/ 防止出现/ 上述/ 问题/ ,/ 对于/ 式/ (/ 7/ )/ 中/ 的/ L/ 函数/ ,/ 我们/ 约定/ ,/ 如果/ L/ (/ 狓/ ,/ LMA/ )/ / λ/ ,/ 则/ 令/ L/ (/ 狓/ ,/ LMA/ )/ =/ λ/ ,/ 即/ L/ (/ 狓/ ,/ LMA/ )/ =/ min/ (/ inf/ 其中/ ,/ inf/ 为/ 下界/ 值/ ./ 在/ 本文/ 实验/ 中/ ,/ 取/ λ/ =/ 10/ Δ/ h/ ,/ Δ/ h/ 为/ 空间/ 步长/ ,/ 一般/ 定义/ 为/ 网格/ 单元/ 的/ 大小/ ./ 在/ 式/ (/ 6/ )/ 中/ ,/ 在/ 窄带/ 外部/ ,/ LF/ 的/ 值/ 定义/ 为/ 一个/ 大/ 常数/ ./ 对于/ 流体/ 边界/ 上/ 的/ 点/ ,/ 其/ LF/ 值为/ 该点/ 到/ LMA/ 距离/ 的/ 下界/ 值/ ;/ 对于/ 其他/ 窄带/ 域/ 上/ 的/ 点/ ,/ 其/ LF/ 值为/ 该点/ 到/ 边界/ 的/ 距离/ 加上/ 边界/ 到/ LMA/ 距离/ 的/ 下界/ 值/ ./ 因此/ ,/ 式/ (/ 6/ )/ 表明/ ,/ 流体/ 表面/ 边界/ 上/ 的/ 点/ 具有/ 最小/ 的/ LF/ 值/ ;/ 在/ 高/ 曲率/ 区域/ 和/ 细长/ 区域/ ,/ LMA/ 与/ 界面/ 的/ 距离/ 较近/ ,/ 因此/ 都/ 具有/ 较/ 小/ 的/ LF/ 值/ ,/ 而/ 其图/ 3/ 散度/ 判断/ 法/ 计算/ LMA/ 他/ 区域/ LF/ 函数/ 值大/ ./ 所以/ ,/ LF/ 函数/ 能够/ 定位/ 和/ 量化/ 高/ 曲率/ 、/ 细长/ 区域/ 以及/ 界面/ 边界/ 等/ 细节/ 敏感区域/ ./ 利用/ 文献/ [/ 38/ ]/ 的/ 方法/ ,/ 可以/ 证明/ 本文/ 定义/ 的/ LF/ 在/ 窄带/ 域/ 上/ 是/ k/ -/ Lipschitz/ 连续/ 的/ ,/ 满足/ 光滑性/ 特征/ ./ 5.1/ ./ 2/ 定位/ 和/ 量化/ 函数/ 的/ 计算/ LF/ 的/ 计算/ 步骤/ 是/ :/ 首先/ 根据/ 上节/ 所/ 获取/ 的/ 表面/ 参数/ ,/ 即/ 符号/ 距离/ 场/ 函数/ / =/ / n/ +/ 1/ 计算/ LMA/ ;/ 然后/ 再/ 计算/ 流体/ 表面/ / Ω/ 上/ 网格/ 点/ 的/ LF/ ;/ 最后/ 计算/ 窄带/ 域/ 上/ 其他/ 网格/ 点/ 的/ LF/ 值/ ./ 下面/ 详细/ 介绍/ ./ (/ 1/ )/ 计算/ LMA/ 本文/ 使用/ 散度值/ 判断/ 法/ 计算/ 窄带/ 上/ 的/ 中轴/ LMA/ ./ 由于/ LMA/ 上/ 的/ 点/ 是/ 流体/ 内部/ 的/ 中心点/ ,/ 符号/ 距离/ 场/ 函数/ / 在/ 该/ 点/ 处/ 具有/ 最小值/ ./ 因此/ ,/ 在/ LMA/ 两侧/ ,/ / 的/ 梯度/ 正好/ 相反/ ./ 而/ 在/ 同/ 一侧/ ,/ / 的/ 梯度方向/ 基本相同/ ,/ 如图/ 3/ (/ a/ )/ 所示/ ./ 根据/ 以上/ 分析/ ,/ 我们/ 可以/ 通过/ 计算/ 窄带/ 域/ 上/ 每个/ 网格/ 单元/ 中/ / 的/ 梯度/ 的/ 散度值/ 即/ / 2/ / 判断/ 该/ 网格/ 单元/ 是否/ 包含/ LMA/ 上/ 的/ 点/ ./ 对于/ 包含/ LMA/ 的/ 网格/ 单元/ ,/ 其/ 边界/ 位于/ LMA/ 的/ 两侧/ ,/ 故/ 边界/ 上/ 的/ 梯度方向/ 相反/ ,/ 其散度/ 值/ 大于/ 零/ ./ 而/ 在/ 其他/ 网格/ 单元/ 上/ ,/ 由于/ / 的/ 连续性/ ,/ 其/ 梯度/ 的/ 散度/ 值接/ 近于零/ ./ 例如/ ,/ 在/ 图/ 3/ (/ b/ )/ 中/ ,/ 网格/ 单元/ C0/ 包含/ LMA/ 上/ 的/ 点/ ,/ 该/ 网格/ 单元/ 的/ 上/ 侧面/ 和/ 下/ 侧面/ 的/ 梯度方向/ 都/ 是/ 指向/ 外侧/ 较大/ 函数/ 值/ 的/ 方向/ ,/ 故其/ 散度值/ 为/ 非/ 零/ ./ 而/ 在/ 网格/ 单元/ C1/ 上/ ,/ 由于/ / 的/ 连续性/ ,/ 其/ 梯度/ 的/ 散度/ 值接/ 近于零/ ./ Page7/ 符号/ 距离/ 场/ 函数/ 的/ 梯度/ 的/ 散度/ 表示/ 为/ D/ =/ / ·/ (/ / / )/ =/ 如果/ 绝对值/ fabs/ (/ D/ )/ >/ / 一定/ 阈值/ (/ 本文/ 实验/ 中/ ,/ 取含/ LMA/ 点/ ./ 然后/ 用该/ 网格/ 点/ 狓/ 近似/ LMA/ 上/ 的/ 点/ 狆/ M/ ,/ 并入/ 到/ 已有/ 的/ LMA/ 点/ 集中/ ,/ 即/ LMA/ =/ LMA/ ∪/ 狓/ ./ 图/ 3/ (/ c/ )/ 、/ (/ d/ )/ 分别/ 给出/ 一个/ 2D/ 形状/ 的/ 符号/ 距离/ 场/ 函数/ 的/ 梯度/ 的/ 散度值/ 和/ LMA/ 点集/ 示例/ ./ 图中/ 显示/ ,/ 形状/ 内部/ 中心/ 区域/ 的/ 网格/ 散度值/ 大/ ,/ 而/ 窄带/ 上/ 其他/ 区域/ 的/ 散度值/ 接近/ 0/ ,/ 因此/ 散度/ 判断/ 法/ 逼近/ LMA/ 上/ 的/ 点集/ 是/ 一种/ 行之有效/ 的/ 方法/ ./ 由于/ 使用/ 网格/ 中心点/ 代替/ LMA/ 点/ 集中/ 的/ 点/ ,/ 因此/ ,/ 本文/ 散度/ 判断/ 法求/ LMA/ 的/ 误差/ 为/ O/ (/ Δ/ h/ )/ ./ 流体/ 动画/ 中/ 需要/ 设置/ 很小/ 的/ Δ/ h/ 以/ 保持/ 计算/ 稳定性/ 和/ 计算精度/ ,/ 故散度/ 判断/ 法/ 的/ 误差/ 非常/ 小/ ./ (/ 2/ )/ 计算/ 流体/ 表面/ / Ω/ 上/ 网格/ 点/ 的/ LF/ 值/ 在/ 获取/ LMA/ 之后/ ,/ 我们/ 计算/ 流体/ 表面/ / Ω/ 上/ 网格/ 点/ 的/ LF/ 值/ ./ 根据/ 式/ (/ 6/ )/ ~/ (/ 8/ )/ ,/ 需要/ 从/ LMA/ 中/ 搜索/ 出/ 离/ 网格/ 点/ 狓/ ∈/ / Ω/ 最近/ 的/ 点/ 狆/ M/ ./ 为/ 提高/ 搜索/ 效率/ ,/ 本文/ 构建/ kd/ (/ k/ -/ dimensional/ )/ 树/ 存储/ LMA/ 点集/ ./ LMA/ 的/ kd/ 树/ 构建/ 使用/ LMA/ 点/ 集中/ 具有/ 最大/ 跨度/ 值/ 的/ 维度/ 作为/ 切分/ 维度/ 、/ 用该/ 维度/ 上/ 的/ 均值/ 作为/ 切/ 分值/ ./ 由于/ kd/ 树是/ 一种/ 基于/ 统计/ 优化/ 的/ 数据结构/ ,/ kd/ 树/ 搜索/ 的/ 平均/ 计算/ 复杂度/ 为/ O/ (/ NllogNl/ )/ ,/ 这里/ Nl/ 为/ LMA/ 集合/ 大小/ ./ 因此/ 本文/ 方法/ 可以/ 快速/ 从/ LMA/ 点/ 集中/ 获取/ 距离/ 狓/ 最近/ 的/ 点/ 狆/ M/ ./ 最后/ ,/ 根据/ 式/ (/ 8/ )/ 计算/ 表面/ / Ω/ 上/ 网格/ 点/ 狓/ 的/ LF/ 值/ ./ (/ 3/ )/ 计算/ Ω/ b/ -/ / Ω/ 上/ 网格/ 点/ 的/ LF/ 值/ 对于/ 窄带/ 域/ 上/ 的/ 非/ 表面/ 网格/ 点/ 狓/ ,/ 其/ LF/ 值为/ 该点/ 到/ 界面/ 的/ 距离/ 与/ 界面/ 上/ 相应/ 点/ LF/ 值/ 叠加/ 后/ 的/ 下界/ ./ 本文/ 利用/ 法向外/ 推/ 方法/ ,/ 将/ 已知/ 的/ LF/ 值/ 在/ 界面/ 上/ (/ 向/ 内/ 或/ 向/ 外/ )/ 外/ 推/ ./ 故/ 窄带/ 中/ 的/ 任意/ 网格/ 点/ ,/ 都/ 可以/ 根据/ 外/ 推来/ 的/ LF/ 值/ ,/ 计算/ 自己/ 的/ LF/ 函数/ 值/ ./ 为此/ ,/ 本文/ 将/ / Ω/ 上/ 的/ LF/ 值分/ 两个/ 阶段/ 、/ 分别/ 外/ 推到/ Ω/ +/ 我们/ 以/ Ω/ -/ 算法/ 1/ ./ Ω/ -/ 输入/ :/ / Ω/ 上/ 的/ LF/ 值/ ,/ Ω/ -/ 输出/ :/ Ω/ -/ 1/ ./ 初始化/ 网格/ 点/ 集合/ ./ 建立/ 3/ 个/ 集合/ Far/ ,/ Close/ 和/ Accepted/ ;/ 将/ / Ω/ 所在/ 的/ 网格/ 点/ 置入/ Accepted/ 中/ ,/ 并/ 将/ 这些/ 网格/ 点/ 的/ 位于/ Ω/ -/ 剩余/ 的/ 网格/ 点/ 置入/ Far/ 中/ ;/ 2/ ./ 初始化/ LF/ 值/ :/ Accepted/ 中/ 所有/ 网格/ 点/ 的/ LF/ 值为/ 算法/ 的/ 输入/ ,/ 即/ / Ω/ 上/ 的/ LF/ 值/ ;/ Close/ 集合/ 和/ Far/ 集合/ 中/ 所有/ 网格/ 点/ 的/ LF/ 值/ 初始化/ 为/ 一个/ 大/ 常数/ ,/ 即/ LF/ =/ ;/ 3/ ./ 建立/ 以/ LF/ 值为/ 指标/ 的/ 最小/ 堆/ ,/ 用于/ 保存/ Close/ 集合/ ;/ 4/ ./ 更新/ Close/ 集合/ 中/ 所有/ 网格/ 点/ 狓/ 的/ LF/ 值/ :/ 令/ Z/ =/ {/ 狕/ }/ 为/ 狓/ 在/ Accepted/ 集合/ 中/ 的/ 邻居/ 网格/ 点/ 集合/ ,/ 则/ 狓/ 的/ LF/ 值/ 更新/ 为/ 5/ ./ 根据上述/ 重新/ 计算/ 的/ LF/ 值/ 更新/ 保存/ Close/ 集/ 的/ 最小/ 堆/ ;/ 6/ ./ 选择/ 最小/ 堆顶/ 元素/ Trial/ (/ 即/ Close/ 集合/ 中/ 具有/ 最小/ LF/ 值/ 的/ 网格/ 点/ )/ ,/ 将/ 其/ 置入/ Accepted/ 集合/ ;/ 将/ Trail/ 中/ 的/ 所有/ 位于/ Far/ 集合/ 中/ 的/ 邻居/ 点/ 转移/ 到/ Close/ 集合/ 中/ ;/ 7/ ./ 转到/ 步/ 4/ ,/ 迭代/ 运行/ 直到/ 最小/ 堆为/ 空/ ,/ 终止/ ./ 算法/ 结束/ 时/ ,/ Accepted/ 集合/ 中/ 所有/ Ω/ -/ 格点/ 的/ LF/ 值/ 即/ 为/ 所求/ ./ 将/ 算法/ 1/ 中/ 的/ Ω/ -/ b/ ,/ 可以/ 获得/ Ω/ +/ Ω/ +/ 以上/ 方法/ 获取/ Ω/ b/ -/ / Ω/ 上/ 所有/ 网格/ 点/ 的/ LF/ 值时/ ,/ 其/ 时间/ 复杂度/ 为/ O/ (/ NblogNb/ )/ ,/ 这里/ ,/ Nb/ 为/ Ω/ b/ -/ / Ω/ 上/ 的/ 所有/ 网格/ 点/ 的/ 个数/ ./ 与/ 已有/ 的/ 计算/ 几何/ 特征/ 的/ 函数/ [/ 38/ ]/ 相比/ ,/ 本文/ 定义/ 的/ LF/ 函数/ 不仅/ 能够/ 正确/ 反映/ 水面/ 几何/ 形状/ 的/ 复杂程度/ ,/ 而且/ 有效/ 提升/ 了/ 计算/ 效率/ ./ 效率/ 的/ 提高/ 主要/ 得益于/ 以下/ 两个/ 方面/ :/ 首先/ ,/ 由于/ 窄带/ 域/ 上/ 的/ LMA/ 是/ MA/ 的/ 子集/ ,/ 缩小/ 了/ 在/ 流体/ 表面/ 上/ 求解/ LF/ 函数/ 时/ 的/ 搜索/ 空间/ ./ 其次/ ,/ LF/ 值/ 的/ 计算/ 只/ 需要/ 在/ 窄带/ 域/ 上/ 进行/ ,/ 计算/ 空间/ 由/ 原来/ 的/ 整个/ 计算/ 域/ 变为/ 在/ 流体/ 表面/ 周围/ ,/ 大大降低/ 了/ 计算/ 网格/ 的/ 个数/ ./ 其/ 计算/ 复杂度/ 由/ O/ (/ N/ )/ 降低/ 到/ O/ (/ N2/ // 3/ )/ ,/ 其中/ N/ 为/ 计算/ 域/ 内/ 网格/ 单元/ 总数/ ./ 在/ 第/ 7/ 节/ 实验/ 部分/ ,/ 我们/ 给出/ 了/ 具体/ 的/ 示例/ 分析/ ./ 5.2/ 细节/ 敏感区域/ 的/ 动态/ 跟踪/ 定位/ 量化/ 函数/ LF/ 是/ 对/ 流体/ 表面/ 几何/ 特征/ 的/ 表达/ ,/ 由于/ 流体/ 是/ 不断/ 运动/ 的/ ,/ 因此/ 该/ 函数/ 也/ 具有/ 动态性/ ./ 为此/ ,/ 本文/ 提出/ LF/ 函数/ 的/ 动态/ 跟踪/ 算法/ ,/ 实现/ 对/ 细节/ 敏感区域/ 的/ 有效/ 的/ 动态/ 跟踪/ ./ LF/ 函数/ 的/ 动态/ 跟踪/ 的/ 基本/ 步骤/ 是/ :/ 首先/ 需要/ 计算/ 一段时间/ 内/ 的/ 流体/ 表面/ 变形/ 程度/ ,/ 如果/ 变形/ 程度/ 小于/ 一定/ 阈值/ ,/ 则/ 需要/ 对/ LF/ 函数/ 进行/ 对流/ 更新/ ;/ 否则/ 需要/ 对/ LF/ 函数/ 进行/ 重新/ 初始化/ ./ 流体/ 表面/ 变形/ 函数/ S/ 定义/ 为/ 一段时间/ 流体/ 表面/ 所/ 包围/ 的/ 流体/ 体积/ 的/ 变化率/ Page8S/ (/ ti/ ,/ ti/ -/ 1/ )/ =/ ∑/ 其中/ ,/ ti/ -/ 1/ 和/ ti/ 分别/ 上次/ 重/ 采样/ 时刻/ 和/ 当前/ 时刻/ ,/ Δ/ t/ 为/ 时间/ 步长/ ,/ A/ (/ t/ )/ 为/ t/ 时刻/ 被/ 流体/ 界面/ 包围/ 的/ 流体/ 体积/ ,/ 表示/ 为/ 其中/ ,/ δ/ 为/ Smeared/ -/ outHeaviside/ 函数/ 的/ 导数/ δ/ (/ / )/ =/ 这里/ ,/ ε/ =/ 1.5/ Δ/ h/ ./ 在/ 计算/ 中/ ,/ 式/ (/ 9/ )/ 可/ 转化/ 为/ A/ (/ t/ )/ =/ ∑/ (/ i/ ,/ j/ ,/ k/ )/ ∈/ Ω/ b/ 其中/ (/ i/ ,/ j/ ,/ k/ )/ 为/ Ω/ b/ 上/ 的/ 网格/ 点/ ./ 这样/ ,/ 根据/ 第/ 4/ 节/ 获取/ 的/ 参数/ ,/ 我们/ 就/ 可以/ 计算/ 出/ 表面/ 变形/ 程度/ S/ ./ 然后/ ,/ 根据/ 表面/ 变形/ 程度/ S/ 的/ 值/ 确定/ 更新/ LF/ 函数/ 的/ 方式/ ./ 如果/ S/ 的/ 值/ 小于/ 阈值/ / ,/ 说明/ 表面/ 变形/ 不/ 大/ ,/ 无需/ 对/ 几何/ 特征/ 进行/ 重新/ 计算/ ./ 只/ 需像/ 流体/ 表面/ 一样/ ,/ 对/ 其/ 进行/ 对流/ 更新/ 即可/ ./ 如果/ 变形/ 程度/ 大于/ 阈值/ / ,/ 说明/ 表面/ 发生/ 了/ 大/ 的/ 形变/ ,/ 需要/ 对/ LF/ 函数/ 进行/ 重新/ 初始化/ ./ 因此/ ,/ 需要/ 重新/ 初始化/ 的/ 时间/ 步为/ 本文/ 实验/ 中取/ / =/ 10/ %/ ,/ 在/ 时间/ 步/ ti/ (/ ti/ ∈/ TF/ )/ 上/ 按照/ 5.1/ 节/ 的/ 方法/ 重新/ 计算/ LF/ 的/ 值/ ./ 而/ 在/ 其他/ 时间/ 步上/ ,/ LF/ 的/ 更新/ 表示/ 为/ 其中/ ,/ F/ =/ LF/ (/ 狓/ ,/ t/ )/ ,/ 狌/ =/ 狌/ n/ +/ 1/ 为/ 当前/ 时刻/ 已/ 获取/ 的/ 网格/ G/ 中/ 的/ 流体/ 速度/ 场/ ./ 这样/ 根据/ 当前/ 时刻/ 的/ LF/ 值即/ LFn/ 和/ 更新/ 后/ 的/ G/ 中/ 速度/ 场/ 狌/ n/ +/ 1/ ,/ 利用/ 半/ 拉格朗/ 日法/ [/ 37/ ]/ 求解/ 式/ (/ 10/ )/ ,/ 即可/ 获得/ 更新/ 后/ 的/ LF/ 值/ LFn/ +/ 1/ ./ 上述/ LF/ 函数/ 对/ 细节/ 敏感区域/ 的/ 定位/ 、/ 量化/ 和/ 动态/ 跟踪/ ,/ 充分利用/ 了/ 流体/ 的/ 多种/ 细节/ 之间/ 存在/ 密切相关/ 性/ 这/ 一/ 特点/ ./ 我们/ 通过/ 提取/ 流体/ 表面/ 的/ 几何/ 特征/ ,/ 为/ 其他/ 细节/ 的/ 产生/ 提供/ 支持/ ./ 此外/ ,/ 本文/ 的/ 几何/ 特征/ 在/ 流体/ 表面/ 及其/ 周围/ 的/ 窄带/ 区域/ 具有/ 非/ 均匀/ 特征/ ,/ 高效/ 且/ 正确/ 地/ 反映/ 了/ 流体/ 运动/ 的/ 特点/ ,/ 为/ 提高/ 计算精度/ 和/ 效率/ 奠定/ 了/ 基础/ ./ 6/ 几何/ 模型/ 与/ 物理/ 模型/ 的/ 耦合/ 由于/ 流体/ 水面/ 和/ 水花/ 细节/ 的/ 产生/ 密切相关/ ,/ 本文/ 将/ 几何/ 模型/ 计算/ 的/ 动态/ LF/ 函数/ 应用/ 于/ 物理/ 模型/ 粒子/ 集/ 的/ 控制/ 中/ ,/ 以/ 提高/ 水面/ 模拟/ 的/ 精度/ ,/ 同时/ 生成/ 丰富/ 的/ 水花/ 细节/ ./ 几何/ 模型/ 与/ 物理/ 模型/ 耦合/ 的/ 基本思路/ 是/ ,/ 将/ 几何/ 特征/ 计算/ 获得/ 的/ 定位/ 量化/ 函数/ 映射/ 成/ 物理/ 模型/ 中/ 的/ 粒子/ 密度/ ./ 然后/ ,/ 通过/ 粒子/ 密度/ 调整/ 物理/ 模型/ 中/ 的/ 粒子/ 集/ Pc/ 和/ Ps/ ,/ 从而/ 在/ 细节/ 敏感区域/ 分布/ 更/ 多/ 的/ 粒子/ ./ 调整/ 后/ 的/ 粒子/ 集将/ 完成/ 两个/ 目标/ :/ 一是/ 提高/ 细节/ 敏感区域/ 的/ 表面/ 的/ 精度/ ,/ 生成/ 具有/ 丰富/ 细节/ 的/ 流体/ 水面/ ;/ 二是/ 为/ 粒子/ 水花/ 提供/ 更/ 合理/ 的/ 源/ ,/ 更/ 高效/ 地/ 产生/ 水花/ 飞溅/ 的/ 效果/ ./ 算法/ 2/ ./ 几何/ 与/ 物理/ 模型/ 的/ 耦合/ 算法/ ./ 输入/ :/ 狌/ n/ +/ 1/ ,/ 狌/ / ,/ / n/ +/ 1/ 输出/ :/ Pn/ +/ 11/ ./ 将/ LF/ 函数/ 值/ LFn/ 映射/ 为/ 粒子/ 的/ 分布/ 密度/ Pn/ (/ 狓/ )/ ;/ 2/ ./ 根据/ Pn/ (/ 狓/ )/ 计算/ 需要/ 增/ // 删/ 的/ 粒子/ 数/ Nn3/ ./ 在/ 网格/ 单元/ 狓/ 中/ 增加/ 或/ 删除/ Nn4/ ./ 对/ Pnew5/ ./ 利用/ 狌/ n/ +/ 1/ 更新/ Pnew6/ ./ 利用/ 狌/ n/ +/ 17/ ./ 利用/ Pn/ +/ 18/ ./ 对/ Pnew9/ ./ 利用/ 狌/ n/ +/ 1/ 和/ 狌/ / 更新/ Pnew10/ ./ 利用/ 狌/ n/ +/ 1/ 算法/ 2/ 给出/ 了/ 本文/ 几何/ 与/ 物理/ 模型/ 耦合/ 的/ 基本/ 步骤/ ./ 下面/ 我们/ 详细/ 介绍/ 这些/ 步骤/ 中/ 的/ 操作/ ./ (/ 1/ )/ 首先/ 将/ LF/ 函数/ 映射/ 为/ 粒子/ 分布/ 密度/ Pn/ (/ 狓/ )/ ./ 由于/ LF/ 在/ 大/ 曲率/ 、/ 细长/ 区域/ 以及/ 边界/ 区域/ 的/ 函数/ 值较/ 小/ ,/ 而/ 这些/ 区域/ 所/ 需/ 的/ 粒子/ 反而/ 较/ 多/ ,/ 因此/ ,/ 先对/ LF/ 进行/ 变换/ Pn/ (/ 狓/ )/ =/ 1.0/ -/ 这样/ ,/ LF/ 值较/ 小/ 的/ 网格/ (/ 即大/ 曲率/ 、/ 细长/ 区域/ 和/ 界面/ 边界/ 等/ )/ Pn/ (/ 狓/ )/ 值/ 较大/ ,/ 从而/ 满足/ 在/ 这些/ 区域/ 分布/ 更/ 多/ 粒子/ 的/ 需求/ ./ 然后/ 将/ Pn/ (/ 狓/ )/ 归一化/ ,/ 获取/ 粒子/ 的/ 分布/ 密度/ (/ 2/ )/ 在/ 每个/ 网格/ 中/ 需要/ 删除/ 或/ 增加/ 的/ 粒子/ 个数/ 为/ NnPage9/ 其中/ ,/ Nn/ 为/ 计算/ 域/ 中/ 粒子/ 总/ 个数/ ,/ κ/ 为/ 控制参数/ ,/ 控制/ 粒子/ 个数/ 变化/ 的/ 剧烈/ 程度/ ./ (/ 3/ )/ 在/ 每个/ 网格/ 单元/ 狓/ 中/ ,/ 如果/ Nn/ 在/ 网格/ 内/ 随机/ 删除/ Nndel/ (/ 狓/ )/ 个/ 粒子/ ,/ 粒子/ 位置/ 在/ 网格/ 单元/ 狓/ 内部/ 随机/ 产/ Nn/ 生/ ,/ 速度/ 初始化/ 为/ 零/ ./ 新/ 粒子/ 生成/ 后/ 还/ 需/ 判断/ 分类/ 并/ 分别/ 置入/ Pn/ 子/ pnew/ ,/ 令其/ 位置/ 为/ 狓/ pnew/ 粒子/ 位于/ Ω/ -/ 则/ ,/ 则/ 该/ 粒子/ 位于/ Ω/ +/ 的/ ω/ 层/ (/ ω/ =/ 3/ )/ 网格/ 内/ ,/ 即/ 0/ </ / n/ +/ 1/ 则/ 该/ 粒子/ 属于/ Pn/ Δ/ h/ ,/ 则/ 粒子/ 属于/ Pn/ (/ 4/ )/ 对/ Pnew/ 次/ 线性插值/ 的/ 方法/ 从/ G/ 中/ 速度/ 场/ 狌/ n/ +/ 1/ 获取/ ./ 即/ c/ =/ Lerp/ (/ 狌/ n/ +/ 1/ ,/ 狓/ n/ 狌/ n/ +/ 1/ 以/ 狌/ n/ +/ 1c/ 作为/ 输入/ ,/ 通过/ 求解/ 方程/ d/ 狓/ // dt/ =/ 狌/ n/ +/ 1c/ 中/ 移除/ ,/ 添加/ 到/ Pnew/ 获得/ 更新/ 后/ 的/ 粒子/ 位置/ 狓/ n/ +/ 1/ 逃逸/ 到/ 液体/ 表面/ 三层/ 网格/ 之外/ 的/ 空气/ 网格/ 中/ ,/ 则/ 将/ 其/ 从/ Pnew/ 度/ 和/ 位置/ 更新/ 后/ ,/ 即可/ 得/ 新/ 的/ 粒子/ 集/ Pn/ +/ 1/ 集可/ 用于/ 对/ 符号/ 距离/ 场/ 函数/ 的/ 检测/ 和/ 校正/ ./ 在/ 4.2/ 节中/ ,/ 通过/ 使用/ 半/ 拉格朗/ 日法/ [/ 37/ ]/ 求解/ LS/ 方程/ (/ 式/ (/ 5/ )/ )/ 可以/ 获得/ 对流/ 后/ 的/ 符号/ 距离/ 场/ 函数/ / n/ +/ 1/ 免/ 粗糙/ 网格/ 引起/ 的/ 计算误差/ ,/ 研究者/ 使用/ 粒子/ 检测/ 和/ 校正/ / n/ +/ 1c/ 的/ 分布/ 是/ 根据/ 几何/ 特征/ 计算/ 所得/ 的/ ,/ 因此/ 它/ 对/ Pn/ +/ 1/ / n/ +/ 1m/ 中/ 的/ 误差/ 可以/ 进行/ 更/ 精确/ 的/ 检测/ 和/ 更/ 准确/ 的/ 校正/ ,/ 提高/ 流体/ 表面/ 的/ 精度/ ./ 具体/ 的/ ,/ 令/ sp/ 为/ 粒子/ 符号/ ,/ 如果/ 存在/ 则/ 说明/ 粒子/ 逃逸/ ,/ 即/ 检测/ 到/ 流体/ 表面/ 计算/ 存在/ 误差/ ./ 此时/ ,/ 需要/ 利用/ 逃逸/ 粒子/ 定义/ 局部/ LS/ 函数/ / p/ (/ 狓/ )/ =/ sp/ (/ rp/ -/ 狓/ -/ 狓/ n/ +/ 1/ 点/ 位置/ ./ 校正/ 时/ ,/ 需要/ 首先/ 计算/ 逃逸/ 正负/ 粒子/ 集/ E/ +/ 和/ E/ -/ 在/ 所有/ 网格/ 点上/ 的/ 局部/ LS/ 的/ 最大值/ 和/ 最小值/ :/ / +/ =/ max/ 逃逸/ 粒子/ 集/ 所在/ 网格/ 点/ 狓/ 中将/ 两个/ 距离/ 场/ 进行/ 融合/ ./ 如果/ / +/ (/ 狓/ )/ / / -/ (/ 狓/ )/ ,/ 则/ / c/ (/ 狓/ )/ =/ / +/ (/ 狓/ )/ ,/ 否则/ / c/ (/ 狓/ )/ =/ / -/ (/ 狓/ )/ ./ 将/ 所得/ / c/ (/ 狓/ )/ 值/ 替换/ 狓/ 位置/ 处/ 的/ 距离/ 场/ 函数/ 值/ / n/ +/ 1/ 表面/ / n/ +/ 1/ ./ (/ 5/ )/ SPH/ 粒子/ 集/ Pnew/ 是/ 产生/ 水花/ 细节/ ,/ 因此/ 需要/ 求解/ 方程/ (/ 1/ )/ 、/ (/ 2/ )/ 对/ 粒子/ 速度/ 进行/ 更新/ ./ 在/ 4.1/ 节中/ ,/ 我们/ 已经/ 获取/ 到/ 网格/ G/ 中/ 速度/ 场/ 狌/ n/ +/ 1/ ./ 由于/ 狌/ n/ +/ 1/ 的/ 计算结果/ 是/ 将/ 粒子/ 速度/ 投影/ 到/ 网格/ 中/ 并/ 求解/ 网格/ 和/ 粒子/ 耦合/ 的/ 压强/ 方程/ 获取/ 的/ ./ 因此/ ,/ 只/ 需/ 将/ 狌/ n/ +/ 1/ 反投影/ 到/ 粒子/ 上/ 即可/ 获得/ 新/ 的/ 粒子/ 速度/ ./ 具体/ 的/ ,/ 我们/ 首先/ 把/ 中间/ 速度/ 场/ 狌/ / 到/ 狌/ n/ +/ 1/ 的/ 增量/ 反投影/ 到/ 粒子/ 上/ ,/ 即/ Δ/ 狌/ p/ =/ ∑/ (/ 狌/ n/ +/ 1/ -/ 狌/ / )/ ω/ p/ (/ 狓/ )/ ,/ 则/ 更新/ 后/ 的/ 粒子/ 速度/ 为/ 狌/ n/ +/ 1/ 示/ 粒子/ 速度/ 受/ 压强/ 的/ 影响/ 程度/ ./ 根据/ 狌/ n/ +/ 1d/ 狓/ // dt/ =/ 狌/ n/ +/ 1/ 子/ 运动/ 到/ 流体/ 表面/ 以内/ ,/ 即/ / n/ +/ 1/ (/ 狓/ n/ +/ 1Pnews/ 中/ 移除/ 该/ 粒子/ ./ Pnew/ 即/ 得/ 新/ 的/ 粒子/ 集/ Pn/ +/ 1/ 从/ 耦合/ 模型/ 中/ 计算/ 出新/ 的/ 符号/ 距离/ 场/ 函数/ / n/ +/ 1/ 和/ SPH/ 粒子/ 集/ Pn/ +/ 1/ 提取/ 流体/ 水面/ 和/ 水花/ 的/ 多边形/ 网格/ ,/ 最后/ 进行/ 真实感/ 渲染/ 生成/ 流体/ 动画/ ./ 7/ 实验/ 与/ 分析/ 本文/ 实验/ 采用/ 的/ 机器配置/ 为酷/ 睿/ 2/ 双核/ 处理器/ ,/ 主频/ 为/ 3.30/ GHz/ ,/ 2GB/ 内存/ ./ 实验/ 结果/ 由/ 3/ 个/ 部分/ 组成/ :/ 第/ 1/ 部分/ 测试/ 几何/ 模型/ 的/ 有效性/ ;/ 第/ 2/ 部分/ 测试/ 几何/ 与/ 物理/ 耦合/ 模型/ 在/ 数值/ 计算精度/ 和/ 效率/ 方面/ 的/ 性能/ ;/ 第/ 3/ 部分/ 为/ 流体/ 动画/ 的/ 实例/ ./ 7.1/ 犔/ 犉/ 函数/ 本文/ 分别/ 选择/ 2D/ 和/ 3D/ 模型/ 测试/ LF/ 函数/ 的/ 有效性/ ./ 图/ 4/ 给出/ 了/ 2DZalesak/ ’/ sDisk/ 测试函数/ [/ 39/ ]/ 对应/ 的/ 结果/ ./ 图/ 4/ (/ a/ )/ 表示/ 整个/ 计算/ 域/ 上/ 的/ 中轴/ ,/ 图/ 4/ 图/ 4/ 测试函数/ 的/ 中轴/ ,/ 局部/ 特征/ 尺寸/ 函数/ ,/ LMA/ 和/ LFPage10/ (/ b/ )/ 给出/ 对应/ 的/ 局部/ 特征/ 尺寸/ 函数/ 值/ (/ LocalFeatureSize/ ,/ LFS/ )/ [/ 38/ ]/ ,/ 其中/ 深色/ 代表/ 数值/ 较/ 小/ ,/ 浅色/ 代表/ 数值/ 较大/ ./ 图/ 4/ (/ c/ )/ 中/ 的/ 符号/ 距离/ 场/ 函数/ 只/ 在/ 窄带/ 上/ 定义/ ,/ 内部/ 线条/ 即/ 是/ 由/ 本文/ 算法/ 得到/ 的/ LMA/ ,/ 显然/ ,/ LMA/ 是/ MA/ 的/ 子集/ ./ 中间/ 缺失/ 的/ 部分/ 表明/ 其中/ 轴点/ 已/ 位于/ 窄带/ 之外/ ./ 尽管如此/ ,/ 在/ 图/ 4/ (/ d/ )/ 中/ ,/ 基于/ LMA/ 计算/ 的/ LF/ 仍然/ 能够/ 很/ 好/ 的/ 定位/ Zalesak/ ’/ sDisk/ 中/ 的/ 大/ 曲率/ 、/ 细长/ 和/ 边界/ 区域/ ./ 在/ 图/ 5/ 中/ ,/ 本文/ 计算/ 了/ 3/ 组/ 3D/ 模型/ 对应/ 的/ LF/ 值/ ./ 如图/ 5/ (/ a/ )/ 、/ (/ b/ )/ 中/ ,/ 3D/ 球/ 由于/ 流场/ 拉伸/ 的/ 作用/ 产生/ 了/ 细薄/ 区域/ ,/ 在/ 这些/ 细薄/ 区域/ LF/ 值较/ 小/ ,/ 而/ 在/ 其他/ 区域/ LF/ 值/ 较大/ ,/ 说明/ 本文/ 定义/ 的/ LF/ 函数/ 能够/ 很/ 好/ 地/ 体现/ 模型/ 的/ 几何/ 性质/ ./ 图/ 5/ (/ c/ )/ 、/ (/ d/ )/ 给出/ 了/ 一个/ 3D/ 人物/ 模型/ 对应/ 的/ LMA/ 和/ LF/ 值/ ./ LMA/ 上/ 的/ 图/ 62DDeformationfield/ 测试函数/ 的/ 测试/ 结果/ 点/ 基本上/ 分布/ 在/ 具有/ 较/ 多/ 细节/ 的/ 区域/ ,/ 如/ 人物/ 模型/ 的/ 耳朵/ 、/ 鼻子/ 、/ 眼睛/ 、/ 嘴巴/ 和/ 脚/ 等/ 位置/ ,/ 由此/ 计算/ 的/ LF/ 值/ 能够/ 对/ 这些/ 区域/ 进行/ 精确/ 的/ 定位/ 和/ 量化/ ./ 第/ 5.1/ 节/ 分析/ 指出/ ,/ LF/ 的/ 定义/ 还/ 极大地提高/ 了/ 计算/ 效率/ ./ 表/ 1/ 给出/ 了/ 本文/ 算法/ 与/ LFS/ 的/ 计算/ 效率/ 对比/ ./ 从表中/ 可以/ 看出/ ,/ LF/ 求解/ 比/ LFS/ 求解/ 效率高/ 得/ 多/ ,/ 例如/ 在/ 3D/ 人/ 模型/ 示例/ 中/ ,/ 求解/ 效率/ 提高/ 了/ 近/ 100/ 倍/ ./ 2DZalesak/ ’/ sDisk/ 图/ 3/ (/ a/ )/ 3Dmodel3Dhuman7/ ./ 2/ 几何/ 模型/ 与/ 物理/ 模型/ 耦合/ 的/ 数值/ 分析/ 本文/ 以/ 2D/ 变形/ 场/ 测试/ 基准/ 函数/ [/ 38/ ]/ 为例/ 进行/ 分析/ ,/ 测试/ 几何/ 与/ 物理/ 耦合/ 模型/ 在/ 界面/ 跟踪/ 的/ 精度/ 和/ 效率/ 方面/ 性能/ ./ 其中/ ,/ 2D/ 变形/ 场/ 测试/ 的/ 是/ 将/ 一个/ 圆/ 置入/ 由/ 16/ 个/ 漩涡/ 组成/ 的/ 变形/ 场中/ ,/ 该/ 测试函数/ 可以/ 测试/ 数值/ 格式/ 的/ 大/ 变形/ 适应能力/ ./ 测试/ 所用/ 网格/ 规模/ 为/ 200/ ×/ 200/ ./ 图/ 6/ 展示/ 了/ 本文/ 方法/ 在/ 流体/ 表面/ 计算精度/ 和/ 效率/ 方面/ 的/ 提高/ ./ 该图/ 描述/ 了/ 粒子/ 总数/ N/ =/ 80k/ (/ 1k/ =/ 1000/ )/ ,/ 800/ 帧/ 内/ 的/ 耗散/ 率/ 和/ 效率/ ./ 其中/ 耗散/ 率/ 表示/ 流体/ 体积/ 缺少/ 的/ 程度/ ,/ 耗散/ 率越/ 大/ 、/ 体积/ 缺失/ 越/ 多/ ,/ 计算/ 越/ 不/ 精确/ ./ 图/ 6/ 中/ 效率/ 的/ 波动/ 是/ 由于/ PLS/ 算法/ [/ 1/ ,/ 39/ ]/ 中/ 的/ 粒子/ 重/ 采样/ 产生/ 的/ ./ 从图/ 6/ (/ b/ )/ 中/ 可以/ 看出/ ,/ 本文/ 算法/ 在/ 粒子/ 数/ 80k/ 的/ 耗散/ 率/ 与/ PLS/ 算法/ 粒子/ 数/ 320k/ 的/ 耗散/ 率/ 相当/ ,/ 但/ 效率/ 提高/ 了/ 43.9/ %/ ./ 相同/ 粒子/ 规模/ N/ =/ 80k/ 时/ ,/ 本文/ 精度/ 提高/ 了/ 16.6/ %/ ./ 表/ 2/ 列出/ 了/ 不同/ 粒子/ 数下/ 的/ 平均/ 耗散/ 率/ 和/ 平均/ 效率/ ,/ 结果表明/ 本文/ 方法/ 无论/ 在/ 计算精度/ 还是/ 在/ 计算/ 效率/ 方面/ ,/ 都/ 有/ 很大/ 提高/ ./ Page11/ 表/ 22DDeformationField/ 平均/ 耗散/ 率/ 与/ 平均/ 效率/ N/ =/ 80k/ ,/ PLSN/ =/ 160k/ ,/ PLSN/ =/ 320k/ ,/ PLSN/ =/ 80k/ ,/ Ours7/ ./ 3/ 流体/ 动画/ 应用/ 本/ 实验/ 所有/ 流体/ 动画/ 示例/ 中/ ,/ 初始条件/ 设置/ 为/ 在/ 每侧/ ω/ =/ 3/ 层/ 网格/ 的/ 每个/ 单元/ 分布/ 32/ 个/ 粒子/ ,/ 初始化/ SPH/ 粒子/ 集为/ 空/ ,/ 如果/ 在/ Ω/ +/ 子/ ,/ 则/ 将/ 其/ 加入/ 到/ SPH/ 粒子/ 集中/ ./ 图/ 7/ 给出/ 了/ 相同/ 初始条件/ 下/ 本文/ 方法/ 与/ 文献/ [/ 1/ ]/ 的/ 对比/ ./ 在/ 该/ 示例/ 中/ ,/ 计算/ 域/ 的/ 长为/ 0.6/ m/ ,/ 宽为/ 0.65/ m/ ,/ 高为/ 1.0/ m/ ./ 在/ 果盘/ 上/ 初始化/ 水/ 球半径/ 为/ 0.15/ m/ ,/ 速度/ 为/ (/ 0.0/ ,/ -/ 1.0/ ,/ 0.0/ )/ m/ // s/ ./ 计算/ 域/ 分辨率/ 为/ 120/ ×/ 130/ ×/ 200/ ./ 图/ 7/ (/ a/ )/ 是/ 由/ 文献/ [/ 1/ ]/ 的/ 方法/ 产生/ 的/ 效果/ ,/ 图/ 7/ (/ b/ )/ 是/ 本文/ 方法/ 产生/ 的/ 效果/ ./ 相对/ 于/ 文献/ [/ 1/ ]/ 的/ 方法/ ,/ 本文/ 的/ 方法/ 不仅/ 能够/ 生成/ 拓扑/ 多变/ 的/ 流体/ 表面/ ,/ 而且/ 能够/ 生成/ 水花/ 飞溅/ 效果/ ,/ 因此/ 所/ 表现/ 出来/ 的/ 流体/ 细节/ 更/ 丰富/ ./ 该/ 示例/ 也/ 表明/ ,/ 本文/ 的/ 方法/ 能够/ 有效/ 生成/ 流体/ 细节/ ,/ 提高/ 流体/ 动画/ 的/ 真实感/ ./ 图/ 8/ 给出/ 了/ 相同/ 粒子/ 数下/ 本文/ 方法/ 与/ 文献/ [/ 4/ ]/ 的/ 对比/ ./ 在/ 该/ 示例/ 中/ ,/ 计算/ 域/ 为/ 长/ 和/ 宽/ 均/ 为/ 1m/ ,/ 高为/ 0.4/ m/ 的/ 水潭/ ,/ 潭/ 内/ 共有/ 25/ 个/ 柱子/ ,/ 其/ 半径/ 为/ 0.05/ m/ ,/ 高/ 0.1/ m/ ./ 注水/ 水柱/ 位置/ 为/ (/ 0.1/ ,/ 0.175/ ,/ 0.5/ )/ ,/ 水柱/ 高度/ 为/ 0.15/ m/ ,/ 半径/ 为/ 0.035/ m/ ,/ 水源/ 流速/ 为/ (/ -/ 2.4/ ,/ -/ 2.0/ ,/ 0/ )/ m/ // s/ ,/ 计算/ 域/ 网格/ 分辨率/ 为/ 200/ ×/ 80/ ×/ 200/ ./ 图/ 8/ (/ a/ )/ 是/ 由/ 文献/ [/ 4/ ]/ 的/ 方法/ 产生/ 的/ 效果/ ,/ 图/ 8/ (/ b/ )/ 是/ 本文/ 方法/ 产生/ 的/ 效果/ ./ 从图/ 中/ 可以/ 看出/ ,/ 本文/ 的/ 方法/ 水花/ 飞溅/ 细节/ 更/ 多/ ,/ 在/ 撞击/ 圆柱/ 时/ 更/ 明显/ ./ 图/ 8/ (/ b/ )/ 右上方/ 墙壁/ 处/ 产生/ 的/ 表面/ 弯曲/ 则/ 更/ 直观/ 地/ 反映/ 了/ 粒子/ 的/ 优化/ 分布/ 对于/ 提高/ 表面/ 精度/ 的/ 作用/ ./ 该/ 示例/ 表明/ 本文/ 方法/ 不仅/ 能够/ 生成/ 丰富/ 的/ 水花/ 飞溅/ 等/ 细节/ 效果/ ,/ 还/ 可以/ 产生/ 高精度/ 的/ 流体/ 表面/ 效果/ ./ 图/ 8/ 本文/ 方法/ 与/ 文献/ [/ 4/ ]/ 中/ 的/ 方法/ 效果/ 对比/ 除了/ 在/ 流体/ 精度/ 方面/ 的/ 提高/ ,/ 本文/ 通过/ 几何/ 特征/ 的/ 优化/ 方法/ 还/ 进一步提高/ 了/ 动画/ 生成/ 的/ 效率/ ./ 以/ 上述/ 示例/ 为例/ ,/ 本文/ 方法/ 的/ 计算/ 效率/ 提高/ 了/ 25/ %/ 以上/ ./ 表/ 3/ 给出/ 图/ 8/ 示例/ 1000/ 帧/ 的/ 平均/ 性能/ 与/ 传统/ 物理/ 模型/ [/ 4/ ]/ 的/ 对比/ ./ 在/ 相同/ 计算精度/ 情况/ 下/ ,/ 本文/ 算法/ 的/ 效率/ 高于/ 物理/ 模型/ 的/ 效率/ ./ 从表/ 3/ 中/ 可以/ 看出/ ,/ 粒子/ 计算/ (/ 包括/ 流体/ 水面/ 的/ 校正/ 和/ 水花/ 模拟/ )/ 在/ 整个/ 流体/ 计算/ 中/ 都/ 占有/ 相当/ 大/ 的/ 比例/ ./ 而/ 几何/ 特征/ 的/ 方法/ 通过/ 在/ 细节/ 敏感区域/ 更加/ 合理/ 地/ 分布/ 粒子/ ,/ 有效/ 利用/ 计算资源/ ./ 整个/ 计算/ 中/ ,/ 粒子/ 计算所/ 占/ 比例/ 降低/ 15.59/ %/ ,/ 而/ 流体/ 计算/ 效率/ 提高/ 了/ 25.46/ %/ ./ 文献/ [/ 4/ ]/ 结果/ 本文/ 结果/ 提高/ 在/ 基于/ 隐式/ 曲面/ 的/ 流体/ 动画/ 方法/ 中/ ,/ 流体/ 表面/ 的/ 多边形/ 网格/ 是从/ 底层/ 网格/ 的/ 隐式/ 曲面/ 函数/ 获取/ 的/ ./ 因此/ 在/ 粗糙/ 网格/ 的/ 情况/ 下/ ,/ 流体/ 动画/ 中/ 的/ 很多/ 细节/ 往往/ 难以/ 在/ 单个/ 网格/ 中/ 表达/ 从而/ 导致/ 表面/ 体积/ 缺失/ ,/ 影响/ 真实感/ ,/ 如图/ 9/ (/ a/ )/ 所示/ ./ 本文/ 基于/ 表面/ 几何/ 特征/ 的/ 方法/ 分布/ 粒子/ ,/ 能够/ 在/ 表面/ 细节/ 敏感/ 的/ 区域/ 提高/ 流体/ 细节/ 的/ 表达能力/ ./ 如图/ 9/ (/ b/ )/ 所示/ ,/ 在/ 表面/ 破碎/ 和/ 表面/ 逐渐/ 消失/ 时/ 转化/ 为/ 具有/ 亚/ 网格/ 精度/ 的/ 粒子/ 表示/ ,/ 有助于/ 表面/ 细节/ 的/ 保留/ ./ 本文/ 的/ 耦合/ 几何/ 特征/ 的/ 方法/ ,/ 能够/ 在/ 细长/ 区域/ 、/ 大/ 曲率/ 位置/ 以及/ 边界/ 区/ Page12/ 图/ 10/ 流体/ 动画/ 序列/ 8/ 结论/ 与/ 下/ 一步/ 研究/ 本文/ 提出/ 了/ 一种/ 耦合/ 几何/ 特征/ 的/ 高精度/ 流体/ 动画/ 建模/ 方法/ ./ 该/ 方法/ 挖掘/ 并/ 利用/ 流体/ 动画/ 中/ 细节/ 效果/ 之间/ 的/ 相关性/ ,/ 利用/ 几何/ 模型/ 在/ 流体/ 表面/ 上/ 定位/ 易于/ 丢失/ 细节/ 的/ 局部/ 区域/ ,/ 并/ 对/ 细节/ 缺失/ 程度/ 进行/ 量化/ 和/ 动态/ 跟踪/ ./ 通过/ 动态/ 的/ 定位/ 量化/ 函数/ 控制/ 物域/ 等/ 细节/ 敏感区域/ 分布/ 更/ 多/ 的/ 计算资源/ ,/ 有效/ 弥补/ 此类/ 区域/ 的/ 表面/ 体积/ 的/ 缺失/ 问题/ ./ 因此/ ,/ 本文/ 耦合/ 几何/ 特征/ 的/ 方法/ 能够/ 有效/ 解决/ 隐式/ 曲面/ 方法/ 中/ 表面/ 体积/ 缺失/ 导致/ 的/ 失真/ 现象/ ./ 为了/ 验证/ 算法/ 适用性/ ,/ 图/ 10/ 展示/ 了/ 3/ 组/ 本文/ 方法/ 生成/ 的/ 高精度/ 流体/ 动画/ 序列/ ./ 其中/ 图/ 10/ (/ a/ )/ 和/ (/ b/ )/ 分别/ 为/ 水潭/ 注水/ 及/ 果盘/ 落水/ 的/ 示例/ ,/ 算法/ 的/ 输入/ 与/ 初始条件/ 如前所述/ ./ 图/ 10/ (/ c/ )/ 给出/ 了/ 一个/ 水马/ 落水/ 示例/ ,/ 在/ 该/ 例子/ 中/ ,/ 计算/ 域/ 分辨率/ 为/ 53/ ×/ 150/ ×/ 212/ ,/ 水马/ 下落/ 的/ 初始/ 速度/ 为/ (/ 0.0/ ,/ -/ 1.0/ ,/ 0.0/ )/ m/ // s/ ,/ 重力/ 加速度/ 为/ 9.8/ m/ // s2/ ./ 从图/ 中/ 看出/ ,/ 本文/ 方法/ 能够/ 很/ 好/ 的/ 展示/ 流体/ 动画/ 中/ 的/ 流体/ 表面/ 细节/ 和/ 小/ 尺度/ 水花/ 飞溅/ 的/ 效果/ ./ 由于/ 粒子/ 的/ 分布/ 与/ 流体/ 表面/ 的/ 几何/ 特征/ 密切相关/ ,/ 而/ 流体/ 运动/ 的/ 很多/ 细节/ 都/ 是/ 在/ 流体/ 表面/ 变化/ 程度/ 较大/ 位置/ 产生/ 的/ ./ 该/ 实验/ 也/ 说明/ ,/ 本文/ 方法/ 非常适合/ 在/ 水面/ 变化/ 较为/ 剧烈/ 的/ 应用/ 中/ 生成/ 高精度/ 水面/ 和/ 水花/ 效果/ ./ 理/ 模型/ ,/ 从而/ 在/ 这些/ 敏感区域/ 提高/ 水面/ 模拟/ 的/ 精度/ 并/ 生成/ 丰富/ 的/ 水花/ 细节/ ./ 本文/ 的/ 方法/ 可以/ 方便/ 的/ 嵌入/ 到/ 传统/ 的/ 基于/ 物理/ 的/ 流体/ 动画/ 模型/ 中/ ,/ 获得/ 比/ 传统/ 方法/ 更好/ 的/ 精度/ 和/ 更/ 高/ 的/ 效率/ ./ 在/ 实验/ 中/ 我们/ 也/ 发现/ ,/ 本文/ 方法/ 更/ 适合/ 于/ 流体/ 表面/ 变形/ 程度/ 较大/ 的/ 应用/ ,/ 对于/ 变形/ 程度/ 较/ 小/ 的/ 场景/ 其/ 效果/ 并/ 不/ 明显/ ./ 另外/ ,/ 耦合/ 几何/ 特征/ 的/ 高精度/ 流体/ 动画/ 的/ 在/ 大规模/ 流体/ 模拟/ 中/ 的/ 刻画/ 能力/ 仍然/ 是/ 有/ Page13/ 限/ 的/ ./ 目前/ 我们/ 方法/ 的/ 改进/ 方向/ 主要/ 有/ 3/ 个/ :/ (/ 1/ )/ 设计/ 算法/ 检测/ 水面/ 运动/ 的/ 剧烈/ 程度/ ,/ 当/ 水面/ 较为/ 平静/ 时/ 无需/ 再/ 进行/ 几何/ 特征/ 的/ 计算/ 及/ 与/ 物理/ 模型/ 的/ 耦合/ ./ 一个/ 可行/ 的/ 方案/ 就是/ 获取/ 水面/ 平均/ 曲率/ 的/ 统计数据/ ,/ 如/ 均值/ 和/ 方差/ 等/ ,/ 以此/ 判断/ 水面/ 是否/ 足够/ 平静/ ;/ (/ 2/ )/ 将/ 本文/ 方法/ 扩展/ 到/ 大/ 尺度空间/ 的/ 流体/ 动画/ (/ 如/ 海浪/ )/ 的/ 应用/ 中/ ;/ (/ 3/ )/ 进一步/ 拓展/ 本文/ 方法/ 的/ 应用/ 范围/ ,/ 例如/ 将/ 该/ 方法/ 应用/ 到/ 流体/ 动画/ 的/ 控制/ 中/ [/ 40/ -/ 42/ ]/ ,/ 为/ 在/ 流体/ 角色/ 动画/ 保持/ 角色/ 形状/ 的/ 同时/ 生成/ 丰富/ 的/ 流体/ 细节/ 提供/ 帮助/ ./ 我们/ 下/ 一步/ 工作/ 的/ 重点/ 将/ 是/ 解决/ 上述/ 问题/ ,/ 我们/ 现在/ 也/ 在/ 考虑/ 如何/ 结合/ 类似/ 文献/ [/ 22/ ]/ 的/ 方法/ 生成/ 多/ 尺度/ 细节/ 来/ 降低/ 流体/ 动画/ 技术/ 对/ 计算资源/ 的/ 依赖/ ./ 

