Page1/ 一种/ 基于/ 无/ 干扰/ 模型/ 的/ 信任/ 链/ 传递/ 分析方法/ 张兴/ 1/ )/ ,/ 2/ )/ 黄强/ 3/ )/ 沈昌祥/ 1/ )/ ,/ 3/ )/ 1/ )/ (/ 信息工程/ 大学/ 电子/ 技术/ 学院/ 郑州/ 450004/ )/ 2/ )/ (/ 北京工业大学/ 计算机/ 学院/ 北京/ 100022/ )/ 3/ )/ (/ 海军/ 计算技术/ 研究所/ 北京/ 100036/ )/ 摘要/ 基于/ 可信计算/ 组织/ (/ TCG/ )/ 的/ 完整性/ 度量/ 只能/ 保证/ 组件/ 没有/ 被/ 篡改/ ,/ 但/ 不/ 一定/ 能/ 保证系统/ 运行/ 可信性/ ./ 其/ 问题/ 在于/ ,/ 当/ 组件/ 运行/ 时/ ,/ 受/ 其它/ 组件/ 的/ 干扰/ ,/ 出现/ 非/ 预期/ 的/ 信息流/ ,/ 破坏/ 了/ 信任/ 链/ 传递/ 的/ 有效性/ ./ 文章/ 在/ 分析/ 可信计算/ 平台/ 的/ 信任/ 模型/ 基础/ 上/ ,/ 基于/ 无/ 干扰理论/ 模型/ ,/ 提出/ 了/ 一种/ 分析/ 和/ 判定/ 可信计算/ 平台/ 信任/ 链/ 传递/ 的/ 方法/ ,/ 用/ 形式化/ 的/ 方法/ 证明/ 了/ 当/ 符合/ 非/ 传递/ 无/ 干扰/ 安全策略/ 时/ ,/ 组件/ 之间/ 的/ 信息流/ 受到/ 安全策略/ 的/ 限制/ ,/ 隔离/ 了/ 组件/ 之间/ 的/ 干扰/ ,/ 这样/ 用/ 完整性/ 度量/ 方法/ 所/ 建立/ 的/ 信任/ 链才/ 是/ 有效/ 的/ ./ 关键词/ 可信计算/ ;/ 信任/ 链/ ;/ 无/ 干扰/ 模型/ ;/ 安全策略/ 1/ 引言/ 信任/ 链/ 的/ 建立/ 和/ 传递/ 是/ 可信计算/ 平台/ 的/ 关键/ ./ 文献/ [/ 1/ ]/ 将/ 可信计算/ 的/ 思想/ 总结/ 为/ :/ 首先/ 构建/ 一个/ 信任/ 根/ ,/ 再/ 建立/ 一条/ 信任/ 链/ ,/ 从/ 信任/ 根/ 开始/ 到/ 硬件平台/ 、/ 到/ 操作系统/ 、/ 再/ 到/ 应用/ ,/ 一级/ 认证/ 一级/ ,/ 一级/ 信任/ 一级/ ./ 从而/ 把/ 这种/ 信任/ 扩展/ 到/ 整个/ 计算机系统/ ,/ 从而/ 确保/ 整个/ 计算机系统/ 的/ 可信/ ./ 可信计算/ 组织/ TCG/ (/ TrustedComputingGroup/ )/ Page2/ 在/ 其/ 系列/ 规范/ 中/ ①/ ②/ ③/ ④/ ⑤/ 描述/ 了/ 可信/ 的/ 定义/ 以及/ 信任/ 的/ 度量/ 、/ 信任/ 传递/ 和/ 系统/ 控制权/ ,/ TCG/ 用/ 实体/ 行为/ 的/ 预期/ 性来/ 定义/ 可信/ :/ 一个/ 实体/ 是/ 可信/ 的/ ,/ 如果/ 它/ 的/ 行为/ 总是/ 以/ 预期/ 的/ 方式/ ,/ 达到/ 预期/ 的/ 目标/ ①/ ./ 该/ 定义/ 突出/ 了/ 可信/ 是/ “/ 实体/ ”/ 的/ 可信/ ,/ 实体/ 的/ 行为/ 按/ “/ 预期/ ”/ ,/ 其/ 输出/ 结果/ 就是/ 可信/ ./ 换句话说/ ,/ 某一/ 实体/ 按照/ 预期/ 方式/ 运行/ ,/ 就是/ 可信/ 的/ ./ 所以/ 信任/ 总是/ 与/ “/ 预期/ ”/ 联系/ 在/ 一起/ ,/ 即/ “/ 输出/ ”/ 或/ “/ 结果/ ”/ 与/ “/ 预期/ ”/ 的/ 一致性/ ./ 这个/ 定义/ 抓住/ 了/ 实体/ 的/ 行为/ 特征/ ,/ 得到/ 了/ 广泛/ 的/ 认同/ ,/ 但/ TCG/ 规范/ 所/ 规定/ 的/ 基于/ 装载/ 前/ 度量/ 的/ 可信/ 传递/ 方式/ [/ 1/ ]/ 并/ 不能/ 保证系统/ 运行/ 时/ 处于/ 可信/ 状态/ ./ Ahmad/ -/ Reza/ 团队/ 对/ 那些/ 符合/ TCG/ 规范/ 的/ 产品/ 进行/ 测试/ ,/ 结果表明/ 这些/ 可信计算/ 平台/ 并未/ 达到/ 可信/ 的/ 目标/ [/ 2/ ]/ ./ 笔者/ 所在/ 实验室/ 对/ 目前/ 嵌/ 有/ TPM/ 的/ 几种/ 计算机/ 产品/ 进行/ 了/ 验证/ 性/ 的/ 测试/ ,/ 测试/ 产品/ 包括/ IBM/ -/ T60/ 、/ HP/ -/ NC4200/ 等/ ,/ 这些/ 产品/ 均/ 声称/ 符合/ TPM/ -/ 1.2/ 规范/ ./ 而/ 测试/ 结果表明/ :/ 虽然/ 进行/ 了/ 完整性/ 度量/ ,/ 也/ 符合规范/ 所/ 规定/ 的/ 信任/ 链/ 建立/ 过程/ ,/ 但/ 这样/ 的/ 信任/ 链/ 并/ 没有/ 达到/ 系统/ 运行/ 可信/ 的/ 效果/ ,/ 不能/ 防止/ 运行/ 时/ 出现/ 的/ 内存/ 溢出/ ,/ 也/ 不能/ 防止/ 通过/ 隐/ 通道/ 等/ 方式/ 造成/ 的/ 信息/ 泄漏/ ./ 其/ 原因/ 是/ 操作系统/ 基于/ 多任务/ 实现/ ,/ 系统/ 组件/ 间/ 依赖性/ 强/ ,/ 存在/ 很多/ 交互/ 通道/ ,/ 隔离/ 性差/ ./ 当/ 程序运行/ 时/ ,/ 组件/ 之间/ 出现/ 非/ 预期/ 的/ 信息流/ ,/ 对/ 组件/ 的/ 行为/ 形成/ 干扰/ ,/ 这些/ 干扰/ 现象/ 导致系统/ 组件/ 之间/ 的/ 信任/ 关系/ 难以/ 建立/ ,/ 而且/ 使/ 已经/ 建立/ 的/ 可信/ 链/ 容易/ 受到破坏/ ./ 本文/ 围绕/ 系统/ 满足/ 什么/ 条件/ 时/ ,/ 信任/ 链/ 的/ 建立/ 和/ 传递/ 才/ 是/ 有效/ 的/ 这/ 一/ 问题/ 展开/ 研究/ ,/ 这一/ 问题/ 的/ 解决/ 将/ 有助于/ 可信计算/ 平台/ 的/ 设计/ 和/ 验证/ ./ 本文/ 第/ 2/ 节/ 介绍/ 可信计算/ 平台/ 中/ 的/ 信任/ 链/ 传递/ 的/ 相关/ 研究/ ,/ 同时/ 介绍/ 了/ 非/ 传递/ 无/ 干扰/ 模型/ ;/ 第/ 3/ 节/ 进一步/ 分析/ TCG/ 信任/ 链/ 传递/ 存在/ 问题/ 的/ 原因/ ,/ 指出/ 实体/ 间/ 干扰/ 的/ 存在/ 导致/ 了/ 系统/ 运行/ 可信/ ,/ 提出/ 了/ 可信计算/ 平台/ 的/ 信任/ 链/ 传递/ 模型/ ;/ 第/ 4/ 节/ 分析/ 了/ 非/ 传递/ 无/ 干扰/ 模型/ 与/ 信任/ 链/ 传递/ 的/ 关系/ ,/ 提出/ 了/ 具有/ 干扰/ 关系/ 的/ 可信计算/ 平台/ 的/ 信任/ 链/ 传递/ 模型/ ,/ 分析/ 了/ 组件/ 干扰/ 与/ 平台/ 信任/ 传递/ 的/ 关系/ ,/ 指出/ 系统/ 域间/ 无/ 干扰/ 也/ 就/ 意味着/ 系统/ 输出/ 的/ 确定性/ 和/ 可/ 预期/ 性/ ,/ 依据/ 无/ 干扰理论/ 给出/ 了/ 一种/ 判定/ 可信计算/ 平台/ 信任/ 链/ 传递/ 关系/ 的/ 有效/ 方法/ ;/ 第/ 5/ 节/ 基于/ 虚拟机/ 实现/ 了/ 一个/ 非/ 传递/ 无/ 干扰/ 原型/ 系统/ ,/ 对/ 信任/ 链/ 在/ 可信计算/ 平台/ 上/ 的/ 传递/ 进行/ 了/ 初步/ 验证/ ;/ 第/ 6/ 节/ 给出/ 结论/ 和/ 下/ 一步/ 研究/ 重点/ ./ 2/ 相关/ 研究/ 2.1/ TCG/ 可信计算/ 平台/ 的/ 信任/ 模型/ TCG/ 采用/ 装载/ 前/ 度量/ 的/ 方案/ ,/ 给出/ 了/ 信任/ 链/ 传递/ 和/ 控制权/ 转移/ 的/ 过程/ (/ 如图/ 1/ 所示/ )/ ①/ :/ 从/ 可信度/ 量根/ 核心/ CRTM/ (/ CoreofRootTrustedMeasure/ -/ ment/ )/ 开始/ ,/ 依次/ 对/ 各/ 模块/ 进行/ 完整性/ 度量/ ,/ 先对/ BIOS/ 进行/ 杂凑/ 运算/ ,/ 如果/ 与/ 参考值/ 匹配/ ,/ 则/ 度量/ 通过/ ,/ 将/ 控制权/ 转移/ 给/ BIOS/ ,/ 信任/ 链/ 也/ 向前/ 扩展/ 了/ 一步/ ,/ 再/ 度量/ 操作系统/ 加载/ 代码/ ,/ 这样/ 逐步/ 建立/ 信任/ 链/ ./ 所以/ 信任/ 链/ (/ ChainofTrust/ )/ 就/ 是从/ 底部/ CRTM/ 开始/ 到/ 用户/ 应用程序/ 的/ 链/ ./ 从/ 这个/ 过程/ 看/ ,/ 虽然/ 信任/ 链/ 建立/ 了/ ,/ 但/ 不能/ 保证系统/ 运行/ 时/ 处于/ 可信/ 状态/ ./ 因为/ ,/ 如果/ 系统/ 运行/ 时/ 没有/ 适当/ 的/ 安全策略/ 对/ 各/ 模块/ 、/ 各层/ 之间/ 的/ 信息流/ 进行/ 限制/ ,/ 那么/ 各/ 模块/ 、/ 各层/ 之间/ 可能/ 出现/ 干扰/ ,/ 导致系统/ 运行/ 时/ 可信/ 状态/ 难以/ 传递/ 和/ 保持/ ./ Trent/ 在/ 文献/ [/ 3/ ]/ 中/ 指出/ 了/ 这种/ “/ 装载/ 前/ 度量/ ”/ 完整性检查/ 模式/ 的/ 局限/ :/ 即/ 装载/ 时刻/ 的/ 可信/ 不/ 等于/ 运行/ 时/ 可信/ ,/ 因为/ 运行/ 后/ 可能/ 被/ 恶意代码/ 篡改/ ,/ 或者/ 代码/ 插入/ 破坏/ 其/ 运行/ 方式/ ./ Trent/ 提出/ 了/ PRIMA/ ①/ ②/ ③/ ④/ ⑤/ Page3/ 方案/ ,/ 在/ 减少/ 度量/ 对象/ 基础/ 上/ ,/ 实现/ 动态/ 运行/ 时/ 的/ 可信/ ,/ 其/ 关键/ 之/ 处/ 在于/ ,/ 作者/ 从/ 信息流/ 观点/ ,/ 基于/ Clark/ -/ Wilson/ 完整性/ 模型/ 提出/ CW/ -/ Lite/ 安全策略/ 模型/ ,/ 利用/ 这一/ 策略/ 模型/ 限制/ 实体/ 之间/ 的/ 信息/ 流动/ ./ 这一/ 方案/ 说明/ 了/ 可信/ 平台/ 的/ 信任/ 链/ 应该/ 建立/ 在/ 某/ 一/ 安全策略/ 之上/ ,/ 如果/ 系统/ 不/ 加/ 限制/ ,/ 不/ 满足/ 安全策略/ ,/ 那么/ 很难/ 做到/ 动态/ 运行/ 时/ 的/ 可信/ ,/ 信任/ 链/ 的/ 传递/ 也/ 会/ 失效/ ./ 另外/ 一个/ 有/ 意义/ 的/ 工作/ 是/ 在/ TCG/ 之前/ ,/ IBMWatson/ 实验室/ 开发/ 的/ 安全/ 协处理器/ IBM4758/ ①/ ,/ 给出/ 一种/ 逐层/ 验证/ 的/ 可信计算/ 平台/ 体系结构/ ,/ 将/ 平台/ 的/ 代码/ 分为/ 不同/ 信任/ 级别/ 的/ 层/ ,/ 利用/ 棘齿/ 锁/ (/ RatchetLock/ )/ 思想/ ,/ 控制程序/ 控制权/ 在/ 不同/ 信任/ 层面/ 、/ 不同/ 的/ 特权/ 要求/ 的/ 代码/ 块/ 之间/ 进行/ 转移/ ,/ 棘齿/ 锁/ 是/ 单向/ 的/ ,/ 即/ 安全级别/ 低/ 的/ 不能/ 再/ 访问/ 安全级别/ 高/ 的/ ,/ 用/ 这种/ 方法/ 保证/ 了/ 完整性/ 级别/ 的/ 用户/ 层/ 不能/ 进行/ 篡改/ 完整性/ 级别/ 的/ 系统/ 操作/ ./ 文献/ [/ 4/ ]/ 基于/ 无/ 干扰理论/ ,/ 提出/ 了/ 基于/ 进程/ 的/ 无/ 干扰/ 可信/ 模型/ (/ Non/ -/ interferenceTrustedModel/ ,/ NITM/ )/ ,/ 利用/ 进程/ 间/ 的/ 干扰/ 性来/ 研究/ 进程/ 运行/ 过程/ 的/ 可信/ ,/ 并/ 基于/ 进程/ 可信/ 构建/ 系统/ 可信/ 模型/ ./ 同/ TCG/ 静态/ 可信/ 相比/ ,/ 体现/ 了/ 系统/ 动态/ 运行/ 可信/ 的/ 思想/ ,/ 同时/ 也/ 是/ 对/ 信任/ 链/ 的/ 传递/ 的/ 一种/ 有益/ 探索/ ./ 进一步/ 分析/ 文献/ [/ 3/ -/ 4/ ]/ 和/ IBM/ 实验室/ ①/ 的/ 研究成果/ 则/ 可以/ 得到/ 下面/ 的/ 结论/ ,/ 简单/ 地/ 讨论/ 信任/ 链/ 的/ 传递/ 是否/ 有效/ 没有/ 意义/ ,/ 只有/ 当/ 系统/ 本身/ 满足/ 一定/ 的/ 安全策略/ 时/ ,/ 组成/ 系统/ 的/ 各/ 安全/ 域/ 之间/ 的/ 信息/ 流动/ 受到/ 一定/ 安全策略/ 限制/ ,/ 使得/ 组件/ 的/ 运行/ 不/ 受/ 干扰/ ,/ 达到/ 可信/ 目标/ ,/ 这样/ ,/ 用/ 完整性/ 度量/ 方法/ 所/ 建立/ 的/ 信任/ 链才/ 是/ 有效/ 的/ ./ 本文/ 借鉴/ 文献/ [/ 3/ -/ 4/ ]/ 和/ IBM/ 研究/ 结论/ ①/ 得出/ :/ 只有/ 满足/ 了/ 无/ 干扰/ 安全策略/ ,/ 信任/ 链/ 才能/ 有效/ 传递/ 下去/ ,/ 即/ 达到/ 系统/ 运行/ 可信/ ,/ 否则/ 安全/ 域/ 之间/ 可能/ 会/ 产生/ 非/ 预期/ 的/ 信息/ 流动/ ,/ 即使/ 通过/ 了/ 信任/ 链/ 的/ 度量/ ,/ 也/ 不能/ 达到/ 系统/ 运行/ 可信/ 的/ 目标/ ./ 由于/ 以非/ 传递/ 的/ 无/ 干扰/ 模型/ 为/ 基础/ ,/ 为了/ 描述/ 方便/ ,/ 先/ 将/ 文献/ [/ 5/ ]/ 所/ 提出/ 的/ 模型/ 进行/ 提炼/ 和/ 整理/ ./ 2.2/ 对/ 无/ 干扰/ 模型/ 的/ 研究/ 信息流/ 的/ 无/ 干扰/ 思想/ 最早/ 由/ Goguen/ 和/ Meseguer/ 提出/ [/ 6/ ]/ ,/ 随后/ 出现/ 了/ 多种/ 无/ 干扰/ 安全/ 模型/ ,/ 直到/ 1992/ 年/ ,/ Rushby/ 对/ Goguen/ 和/ Meseguer/ 的/ 无/ 干扰/ 模型/ 进行/ 了/ 改进/ [/ 5/ ]/ ,/ 修正/ 了/ 其中/ 几处/ 错误/ ,/ 使/ 其/ 更/ 合理/ 并/ 容易/ 理解/ ,/ 无/ 干扰/ 模型/ 也/ 趋于/ 成熟/ ./ Rushby/ 的/ 模型/ [/ 5/ ]/ 采用/ 状态机/ 的/ 方式/ 来/ 描述/ 系统/ ,/ 给出/ 了/ 系统/ 关于/ 传递/ 和/ 非/ 传递/ 无/ 干扰/ 策略/ 安全/ 的/ 定义/ ./ Rushby/ 的/ 无/ 干扰/ 模型/ 可以/ 理解/ 为/ :/ 一个/ 安全/ 域/ u/ 对/ 安全/ 域/ v/ 是/ 无/ 干扰/ 的/ ,/ 如果/ 域/ u/ 发出/ 的/ 动作/ 不/ 影响/ 域/ v/ 的/ 输出/ ./ Rushby/ 无/ 干扰/ 策略/ 模型/ 被/ 成功/ 地/ 运行/ 到/ BLP/ 、/ BIBA/ 模型/ 的/ 解释/ 和/ 多级/ 安全/ 系统/ 的/ 安全策略/ 的/ 验证/ 等/ ./ 定义/ 1/ ./ 系统/ M/ 由/ (/ S/ ,/ O/ ,/ D/ ,/ A/ )/ 4/ 个/ 要素/ 及/ 一组/ 函数/ 组成/ ,/ 其中/ :/ S/ 为/ 系统/ 状态/ 集合/ ,/ 初始状态/ s0/ ∈/ S/ ./ O/ 为/ 系统/ 输出/ 集合/ ./ A/ 为/ 系统/ 操作/ 动作/ 集合/ ,/ 指/ 系统/ 自身/ 发出/ 的/ 控制/ 动作/ 以及/ 输入/ 性质/ 的/ 动作/ ./ D/ 为/ 系统/ 隔离/ 域/ 集合/ ,/ 隔离/ 域/ 中/ 的/ 主体/ 向/ 系统/ 发出/ 操作/ 动作/ 与/ 系统/ 进行/ 交互/ ,/ 并且/ 能够/ 观察/ 到/ 相应/ 的/ 结果/ ./ 隔离/ 域/ 的/ 划分/ 可以/ 限制/ 系统/ 中/ 的/ 信息/ 流动/ ./ 单步/ 状态/ 转换/ 函数/ step/ :/ S/ ×/ A/ →/ S/ ,/ step/ (/ s/ ,/ a/ )/ 输出/ 函数/ output/ :/ S/ ×/ A/ →/ O/ ,/ 表示/ 从/ 某个/ 系统/ 状态/ 发生/ 操作/ a/ 带来/ 的/ 结果/ ./ 系统/ 运行/ 函数/ run/ :/ S/ ×/ A/ / →/ S/ (/ A/ / 表示/ A/ 的/ 闭包/ )/ ,/ run/ (/ s/ ,/ α/ )/ 表示/ 系统/ 从/ 状态/ s/ 经过/ 操作/ 序列/ α/ 后/ 获得/ 的/ 状态/ ./ 该/ 函数/ 满足/ run/ (/ s/ ,/ / )/ =/ s/ 且/ run/ (/ s/ ,/ a/ / α/ )/ =/ run/ (/ step/ (/ s/ ,/ a/ )/ ,/ α/ )/ ./ 系统/ 操作/ 与域/ 关系/ 函数/ dom/ :/ A/ →/ D/ ,/ 表示/ 系统/ 每个/ 执行/ 操作/ 所属/ 的/ 隔离/ 域/ ./ 定义/ 2/ ./ 用/ 二元关系/ 符号/ ~/ >/ 表示/ 两个/ 域间/ 存在/ 信息流/ 的/ 干扰/ 关系/ ,/ 称为/ 干扰/ 关系/ ./ 用/ ~/ // >/ 表示/ 关系/ ~/ >/ 的/ 补集/ ,/ 称为/ 无/ 干扰/ 关系/ :/ ~/ // >/ =/ (/ D/ ×/ D/ )/ \/ ~/ >/ ./ 定义/ 辅助/ 函数/ sources/ :/ A/ / ×/ D/ →/ P/ (/ D/ )/ ,/ 其中/ P/ (/ D/ )/ 表示/ D/ 的/ 幂集/ ,/ 它/ 满足/ sources/ (/ / ,/ u/ )/ =/ {/ u/ }/ ,/ sources/ (/ a/ / α/ ,/ u/ )/ =/ 表示/ 系统/ 发生/ 了/ 内部/ 操作/ a/ 之后/ 的/ 状态/ ./ 其中/ ,/ v/ ∈/ sources/ (/ α/ ,/ u/ )/ 表示/ v/ =/ u/ 或者/ 操作/ 序列/ α/ 具有/ 一个/ 子/ 序列/ ,/ 该子/ 序列/ 包含/ 域/ w1/ ,/ w2/ ,/ …/ ,/ wn/ 发出/ 的/ 动作/ ,/ 满足/ w1/ ~/ >/ w2/ ~/ >/ …/ ~/ >/ wn/ ,/ 且/ v/ =/ w1/ ,/ u/ =/ wn/ ./ 该/ 函数/ 表明/ :/ 一个/ 在/ 动作/ 序列/ α/ 发生/ 前/ 产生/ 的/ 动作/ a/ 是否/ 影响/ 了/ u/ ,/ 决定/ 于/ 是否/ 存在/ v/ ∈/ sources/ (/ α/ ,/ u/ )/ ①/ IBMCoprocessorFirsttoEarnHighestSecurityValidation/ ./ Page4/ {/ 并且/ 满足/ dom/ (/ a/ )/ ~/ >/ v/ ./ 在/ 此基础/ 上/ ,/ 定义/ “/ 清除/ ”/ 函数/ ./ 定义/ 3/ ./ 函数/ purge/ :/ A/ / ×/ D/ →/ A/ / ,/ 满足/ purge/ (/ a/ / α/ ,/ u/ )/ =/ a/ / purge/ (/ α/ ,/ u/ )/ ,/ dom/ (/ a/ )/ ∈/ sources/ (/ a/ / α/ ,/ u/ )/ purge/ (/ α/ ,/ u/ )/ ,/ 该/ 函数/ 从/ 动作/ 序列/ 中/ 清除/ 了/ 那些/ 不/ 干扰/ 域/ u/ 的/ 操作/ ,/ 剩下/ 那些/ 对域/ u/ 直接/ 或/ 间接/ 造成/ 干扰/ 的/ 操作/ 动作/ ./ 定义/ 4/ ./ 系统/ 满足/ 无/ 干扰/ 关系/ 的/ 形式化/ 定义/ / α/ ∈/ A/ / ,/ / a/ ∈/ A/ ,/ / d/ =/ dom/ (/ a/ )/ ∈/ D/ ,/ 满足/ output/ (/ run/ (/ s0/ ,/ purge/ (/ α/ ,/ dom/ (/ a/ )/ )/ )/ ,/ a/ )/ ./ 定义/ 5/ ./ 若/ 对于/ 系统/ 中/ 任意/ 的/ 域/ u/ ∈/ D/ ,/ 状态/ 集合/ S/ 中/ 存在/ 一个/ 等价关系/ ~/ u/ ,/ 该/ 等价关系/ 满足/ 如下/ 公式/ :/ output/ (/ run/ (/ s0/ ,/ α/ )/ ,/ a/ )/ =/ s/ ~/ dom/ (/ a/ )/ t/ →/ output/ (/ s/ ,/ a/ )/ =/ output/ (/ t/ ,/ a/ )/ ,/ 则/ 称/ M/ 具有/ 输出/ 一致性/ ,/ 即/ 两个/ 状态/ 等价/ 则/ 输出/ 相等/ ./ 而/ 系统/ 状态/ 总/ 可以/ 用/ 一组/ 客体/ 对象/ 及其/ 取值/ 来/ 表示/ ,/ Rushby/ 用/ 以下/ 集合/ 和/ 函数/ 表示/ 状态/ :/ s/ 下/ 可以/ 写/ 的/ 客体/ 对象/ 集合/ ./ 对象/ 在/ 系统/ 状态/ 为/ s/ 时/ 的/ 取值/ ./ 态/ s/ 下/ 可以/ 读/ 的/ 客体/ 对象/ 集合/ ./ N/ 表示/ 一组/ 可数/ 的/ 名称/ 集合/ ./ V/ 表示/ 一组/ 可数/ 的/ 取值/ 集合/ ./ 函数/ contents/ :/ S/ ×/ N/ →/ V/ 表示/ 名字/ 为/ n/ 的/ 客体/ 函数/ alter/ :/ D/ ×/ S/ →/ P/ (/ N/ )/ 表示/ 域/ u/ 在/ 系统/ 状态/ 函数/ observe/ :/ D/ ×/ S/ →/ P/ (/ N/ )/ 表示/ 域/ u/ 在/ 系统/ 状/ 定义/ 6/ ./ 一个/ 域/ 在/ 某/ 系统/ 状态/ 下/ 所有/ 观察/ 到/ 的/ 对象/ 集合/ 即/ 是/ 它/ 的/ 系统/ 视图/ ,/ 可以/ 用/ 如下/ 函数/ 表示/ :/ domview/ (/ u/ ,/ s/ )/ =/ 〈/ val1/ …/ vali/ …/ val/ |/ N/ |/ 〉/ ,/ vali/ =/ contents/ (/ s/ ,/ ni/ )/ ,/ ni/ ∈/ observe/ (/ u/ ,/ s/ )/ 一个/ 域/ 的/ 系统/ 视图/ 指它/ 能够/ 观察/ 到/ 的/ 系统/ 状态/ 的/ 组成部分/ ./ 用/ 系统/ 视图/ 的/ 概念/ ,/ 输出/ 一致性/ 还/ 可以/ 表示/ 成/ :/ 系统/ 的/ 一个/ 内部/ 操作/ 动作/ 造成/ 的/ 输出/ 影响/ 只/ 依赖于/ 发出/ 动作/ 的/ 域/ 的/ 系统/ 视图/ ./ 部/ 干扰/ 性/ (/ locallyrespects/ ~/ >/ )/ :/ 定义/ 7/ ./ 如果/ 下/ 式/ 成立/ 则/ 称为/ 系统/ M/ 具有/ 局/ 局部/ 干扰/ 性/ 表明/ ,/ 一个/ 域/ u/ 对/ 另/ 一个/ 域/ v/ 无/ 干扰/ 关系/ 的话/ ,/ 则/ u/ 发出/ 的/ 操作/ 对域/ v/ 来说/ 也/ 是/ 不/ 可见/ 的/ ./ 局部/ 干扰/ 性/ 保证/ 一个/ 域/ 的/ 系统/ 视图/ 不/ 受/ 那些/ 与其/ 无/ 干扰/ 关系/ 域/ 的/ 动作/ 的/ 影响/ ./ 定义/ 8/ ./ 如果/ 下/ 式/ 成立/ 则/ 称为/ 系统/ M/ 具有/ 弱/ 单步/ 一致性/ (/ weaklystepconsistent/ )/ :/ s/ ~/ ut/ ∧/ s/ ~/ dom/ (/ a/ )/ t/ →/ step/ (/ s/ ,/ a/ )/ ~/ ustep/ (/ t/ ,/ a/ )/ ./ 弱/ 单步/ 一致性/ 表明/ ,/ 当/ 一个/ 操作/ 动作/ 发生/ 后/ ,/ 一个/ 域/ 可见/ 的/ 系统/ 状态/ 的/ 变化/ 只/ 依赖/ 其前/ 一/ 状态/ 和/ 发出/ 该/ 动作/ 的/ 域/ 在/ 发出/ 动作/ 之前/ 状态/ 的/ 系统/ 视图/ ./ 基于/ 上述/ 定义/ ,/ 文献/ [/ 5/ ]/ 给出/ 了/ 下面/ 的/ 展开/ 定理/ (/ unwinding/ )/ ./ 定理/ 1/ ./ 系统/ 满足/ 非/ 传递性/ 无/ 干扰/ 策略/ 的/ 判定/ 定理/ ./ 设/ M/ 是/ 一个/ 视图/ 隔离/ 的/ 系统/ ,/ 有/ 一个/ 具有/ 非/ 传递性/ 的/ ~/ >/ 策略/ ,/ 并且/ M/ 满足/ :/ 输出/ 一致性/ 、/ 弱/ 单步/ 一致性/ 和/ 局部/ 干扰/ 性/ ,/ 则/ M/ 满足/ 非/ 传递性/ 无/ 干扰/ 策略/ ./ 在/ 无/ 干扰/ 模型/ 中/ ,/ 干扰/ 关系/ 分为/ 传递性/ 和/ 非/ 传递性/ ./ 传递/ 的/ 无/ 干扰/ 模型/ 给出/ 了/ 系统/ M/ 对/ 由/ 关系/ ~/ >/ 表达/ 的/ 信息流/ 策略/ 安全/ 的/ 条件/ ,/ 一般/ 表示/ 为/ ,/ 如果/ u/ ~/ >/ v/ ,/ v/ ~/ >/ w/ ,/ 则/ u/ ~/ >/ w/ ./ 传递性/ 无/ 干扰/ 模型/ 可以/ 用来/ 描述/ 基于/ 格/ 的/ 安全/ 模型/ (/ 例如/ BLP/ 模型/ )/ ./ 非/ 传递/ 的/ 无/ 干扰/ 模型/ 给出/ 了/ 系统/ M/ 对/ 由/ 关系/ ~/ >/ 表达/ 的/ 信息流/ 策略/ 安全/ 的/ 条件/ ,/ 一般/ 表示/ 为/ ,/ 如果/ u/ ~/ >/ v/ ,/ v/ ~/ >/ w/ ,/ 但/ u/ ~/ // >/ w/ ./ 非/ 传递性/ 无/ 干扰/ 模型/ 描述/ 非格/ 的/ 结构/ ./ 3/ 可信计算/ 平台/ 的/ 信任/ 链/ 传递/ 模型/ 3.1/ TCG/ 可信计算/ 平台/ 的/ 局限性/ 由/ 可信/ 的/ 定义/ 可以/ 看出/ ,/ 可信/ 的/ 核心内容/ 在于/ 组件/ 行为/ 的/ 可预测性/ ./ 组件/ 行为/ 各有不同/ :/ 对/ 应用程序/ 来说/ ,/ 它/ 的/ 行为/ 包括/ 输出/ 屏幕/ 信息/ 、/ 显示/ 图片/ 、/ 发出声音/ 、/ 创建/ 网络连接/ 等等/ ;/ 对/ 内核/ 来说/ ,/ 它/ 的/ 行为/ 包括/ 产生/ 进程/ 、/ 管理/ 内存/ 、/ 访问控制/ 等等/ ./ 这些/ 不同/ 的/ 行为/ 都/ 符合/ 有限/ 状态/ 自动机/ 模型/ 的/ 抽象/ 描述/ :/ 一个/ 状态/ 确定/ 的/ 系统/ ,/ 其/ 行为/ 是/ 可以/ 预测/ 的/ ,/ 即/ 一个/ 固定/ 的/ 输入/ 队列/ 可以/ 有/ 一个/ 固定/ 的/ 输出/ 队列/ ,/ 也/ 就是/ 这些/ 行为/ 都/ 可以/ 通过/ 信息系统/ 的/ 状态/ 和/ 输出/ 来/ 表现/ ./ 而且/ ,/ 从/ 组件/ 外部/ 来看/ ,/ 它们/ 只能/ 通过/ 输出/ 来/ 表现/ ./ 因此/ 根据/ 可信/ 的/ 定义/ ,/ 一个/ 初始状态/ 确定/ 、/ 输入/ 确定/ 的/ 有限/ 状态/ 自动机/ 系统/ 是/ 一个/ 可信/ 系统/ ./ 但/ 在/ 现实/ 系统/ 中/ ,/ 组件/ 的/ 状态/ 除了/ 取决于/ 自身/ (/ 通常/ 是/ 代码/ 、/ 堆栈/ 、/ 数据/ )/ ,/ 还/ 受/ 其/ 所处/ 环境/ 的/ 影响/ (/ 包括/ 硬件/ Page5/ 平台/ 、/ 操作系统/ 、/ 系统/ 中/ 其它/ 的/ 组件/ 的/ 影响/ )/ ,/ 也就是说/ 组件/ 不是/ 一个/ 状态/ 孤立/ 的/ 有限/ 状态/ 自动机/ ,/ 而是/ 一个/ 部分/ 状态/ 受/ 其它/ 关联/ 组件/ 控制/ 的/ 状态机/ ./ 系统/ 是否/ 可信/ 由/ 其/ 组件/ 和/ 组件/ 之间/ 的/ 交互/ 所/ 决定/ ./ 这里/ 的/ 组件/ 可以/ 是/ 一个/ 硬件/ 模块/ 、/ 软件/ 模块/ 、/ 应用程序/ 等/ ./ 组件/ 的/ 可信性/ 可以/ 由图/ 2/ 的/ 模型表示/ ,/ 模型/ 包括/ 4/ 个/ 元素/ :/ 组件/ 、/ 输入/ 、/ 输出/ 和/ 组件/ 间/ 的/ 干扰/ ./ 组件/ 运行/ 是否/ 可信/ ,/ 用/ 组件/ 输出/ 是否/ 符合/ 预期/ 来/ 表示/ ,/ 因此/ 一个/ 组件/ 运行/ 可信/ 取决于/ 3/ 个/ 因素/ :/ (/ 1/ )/ 完整性/ 因素/ ./ 即/ 组件/ 本身/ 没有/ 被/ 篡改/ 过/ ;/ (/ 2/ )/ 输入/ 因素/ ./ 组件/ 的/ 输入/ 在/ 允许/ 范围/ 内/ ;/ (/ 3/ )/ 干扰/ 因素/ ./ 其它/ 组件/ 对/ 其/ 状态/ 没有/ 干扰/ ./ 下面/ 结合/ 无/ 干扰/ 模型/ ,/ 给出/ 可信计算/ 平台/ 的/ 信/ 可见/ :/ 如果/ 组件/ 本身/ 没有/ 被/ 篡改/ ,/ 并且/ 组件/ 间/ 不/ 存在/ 干扰/ ,/ 则/ 组件/ 的/ 输出/ 符合/ 预期/ ,/ 系统/ 中/ 组件/ 的/ 运行/ 是/ 可信/ 的/ ./ 所以/ ,/ 如果/ 要/ 使/ 信任/ 链/ 传递/ 有效/ ,/ 必须/ 消除/ 组件/ 之间/ 的/ 干扰/ ./ 3.2/ 可信计算/ 平台/ 的/ 信任/ 链/ 传递/ 形式化/ 描述/ 任链/ 的/ 形式化/ 描述/ ./ 可信计算/ 平台/ 用/ S/ 表示/ ,/ 平台/ 由/ 各个/ 组件/ 组成/ ,/ 一个/ 组件/ 可能/ 由/ 更/ 小/ 的/ 组件/ 组成/ ,/ 最小/ 规模/ 的/ 组件/ 可以/ 是/ 一个/ 进程/ ,/ 用/ a1/ ,/ a2/ ,/ …/ ,/ an/ 表示/ ,/ 即/ S/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ an/ }/ ./ D/ 表示/ 无/ 干扰/ 模型/ 中/ 的/ 安全/ 域/ ,/ 可以/ 映射/ 到/ 可信计算/ 平台/ 的/ 组件/ ./ D/ 为/ S/ 的/ 真/ 子集/ ./ 信任/ 关系/ 可以/ 用/ 一个/ 二元关系/ 表示/ :/ →/ ∈/ D/ ×/ D/ ,/ A/ →/ B/ 表示/ 系统/ S/ 中/ 组件/ A/ 对/ B/ 进行/ 了/ 完整性/ 度量/ ,/ 并且/ 度量/ 成功/ ,/ 组件/ A/ 信任/ 组件/ B/ ./ 易见/ ,/ 这样/ 的/ 信任/ 关系/ 具有/ 传递性/ 、/ 自反性/ ./ 因此/ ,/ 系统/ 中/ 信任/ 链/ 可以/ 用/ 下面/ 的/ 式子/ 表示/ :/ 其中/ a0/ 表示/ 可信度/ 量根/ 核心/ CRTM/ ,/ 表示/ 信任/ 链/ 由/ CRTM/ 开始/ ,/ 注意/ Ai/ ∩/ Ak/ 不/ 一定/ 为空/ ,/ 这/ 是/ 由/ 计算/ 平台/ 组件/ 之间/ 复杂/ 的/ 依赖/ 关系/ 所/ 决定/ 的/ ./ 基于/ 可信计算/ 技术/ 的/ 装载/ 前/ 度量/ 技术/ 实现/ 的/ 可信/ 链/ 可以/ 这样/ 形式化/ 地/ 描述/ :/ digest/ (/ Ai/ ,/ Ak/ )/ =/ expect/ (/ Ak/ )/ / Ai/ →/ Ak/ ./ 如果/ 由/ 组件/ Ai/ 通过/ 摘要/ 运算/ 获得/ 的/ Ak/ 摘要/ 值/ 与/ 预期/ 值/ expect/ (/ Ak/ )/ 相等/ ,/ 则/ 组件/ Ai/ 信任/ 组件/ Ak/ ,/ 信任/ 关系/ 将/ 由/ Ai/ 传递/ 至/ Ak/ ,/ 系统/ 控制权/ 也/ 转移/ 到/ Ak/ ./ 其中/ digest/ (/ A/ ,/ B/ )/ 表示/ 组件/ A/ 对/ 组件/ B/ 进行/ 摘要/ 运算/ 的/ 结果/ ,/ expect/ (/ A/ )/ 表示/ 组件/ A/ 的/ 完整性/ 预期/ 值/ ./ 下面/ 论述/ / a/ ,/ b/ ,/ c/ ∈/ S/ ,/ 如果/ 干扰/ 关系/ ~/ >/ 是/ 传递性/ 的/ ,/ 则/ 信任/ 链/ 不/ 成立/ ./ 若/ Ai/ →/ Ak/ ,/ a/ ,/ b/ ∈/ Ai/ ,/ 且/ c/ ∈/ Ak/ ,/ 则/ 由/ a/ ~/ >/ b/ ∪/ b/ ~/ >/ c/ / a/ ~/ >/ c/ ./ (/ 1/ )/ 由于/ a/ ,/ b/ ∈/ Ai/ ,/ a/ ~/ >/ b/ 属于/ 组件/ Ai/ 内部/ 程序/ 之间/ 干扰/ 关系/ ,/ 不/ 影响/ 组件/ 之间/ 的/ 信任/ ./ (/ 2/ )/ 对于/ b/ 和/ c/ 的/ 关系/ ,/ 如果/ b/ ~/ >/ c/ ,/ 即/ 允许/ 信息流/ 由/ b/ ~/ >/ c/ 实现/ ,/ 这种/ 干扰/ 关系/ 不/ 破坏/ 信任/ 关系/ ./ (/ 3/ )/ a/ ~/ >/ c/ 属于/ 非/ 预期/ 干扰/ ,/ 由/ a/ ~/ >/ c/ ,/ 意味着/ 有/ 非/ 预期/ 的/ 信息/ 从/ Ai/ 流向/ Ak/ ,/ 组件/ Ak/ 的/ 输出/ 必然/ 受到/ 影响/ ,/ 原有/ Ai/ →/ Ak/ 关系/ 被/ 破坏/ ./ 这时/ 尽管/ 有/ digest/ (/ Ai/ ,/ Ak/ )/ =/ expect/ (/ Ak/ )/ ,/ 非/ 预期/ 干扰/ 将/ 导致/ Ai/ / Ak/ ./ 若/ 组件/ 间/ 的/ 干扰/ 关系/ 具有/ 传递性/ ,/ 各域/ 间/ 通过/ 传递性/ 就/ 可能/ 产生/ 非/ 预期/ 干扰/ ,/ 那么/ ,/ 即使/ 通过/ 了/ TCG/ 规范/ 规定/ 的/ 完整性/ 度量/ ,/ 输出/ 也/ 不/ 一定/ 符合/ 预期/ ,/ 系统/ 组件/ 的/ 运行/ 是/ 不可/ 信/ 的/ ,/ 系统/ 运行/ 就/ 不可/ 信/ ./ 因此/ ,/ 非/ 预期/ 干扰/ 能够/ 破坏/ 组件/ 之间/ 的/ 信任/ 关系/ ,/ 导致/ 信任/ 链/ 失效/ ./ / A/ ,/ B/ / D/ ;/ a/ ,/ b/ ∈/ A/ ∪/ c/ ∈/ B/ ;/ a/ ~/ >/ b/ ∪/ b/ ~/ >/ c/ / a/ ~/ // >/ c/ ,/ 则/ 系统/ 将/ 不/ 存在/ 非/ 预期/ 的/ 干扰/ ,/ 称/ 满足/ 以上/ 关系/ 的/ D/ ×/ D/ 上/ 二元关系/ 为/ 非/ 传递/ 无/ 干扰/ 关系/ ,/ 记作/ A/ →/ / / INB/ ./ 非/ 传递/ 无/ 干扰/ 关系/ 描述/ 的/ 是/ 一种/ 隔离/ 性/ 要求/ 比较/ 严格/ 的/ 通道/ 控制/ 安全策略/ ,/ 具有/ 非/ 传递/ 无/ 干扰/ 关系/ 的/ 系统/ 组件/ 之间/ 只有/ 直接/ 干扰/ 关系/ ,/ 不/ 存在/ 间接/ 造成/ 的/ 干扰/ 关系/ ./ 4/ 无/ 干扰/ 信任/ 传递/ 判定/ 定理/ 4.1/ 非/ 传递/ 无/ 干扰/ 模型/ 与/ 信任/ 链/ 传递/ 的/ 关系/ 基于/ 以上/ 分析/ 可知/ ,/ 单纯/ 的/ 通过/ 完整性/ 验证/ 实现/ 的/ 信任/ 链/ 传递/ 是否/ 有效/ 无法/ 进行/ 验证/ ./ 只有/ 当/ 系统/ 具有/ 特定/ 的/ 安全/ 机制/ ,/ 满足/ 一定/ 的/ 安全策略/ ,/ 组成/ 系统/ 的/ 各/ 安全/ 域/ 之间/ 的/ 信息/ 流动/ 受到/ 一定/ 安全策略/ 限制/ ,/ 使得/ 组件/ 的/ 运行/ 不/ 受/ 干扰/ ,/ 这时/ ,/ 用/ 完整性/ 度量/ 方法/ 所/ 建立/ 的/ 信任/ 链才/ 是/ 有效/ 的/ ./ 由/ 以上/ 推导/ 过程/ 可知/ ,/ 若/ Page6/ 进一步/ 用图/ 3/ 表示/ 非/ 传递/ 无/ 干扰/ 关系/ ,/ 其中/ 粗/ 箭头/ 连线/ 表示/ 信任/ 传递/ 关系/ ,/ 细/ 箭头/ 连线/ 表示/ 干扰/ 关系/ ./ 可以/ 看出/ ,/ 信任/ 链有/ 两条/ ,/ 分别/ 是/ a0/ →/ A1/ →/ A2/ →/ A3/ ;/ a0/ →/ A1/ →/ A2/ →/ A4/ ./ 由/ a3/ ~/ >/ a4/ ∪/ a4/ ~/ >/ a5/ / a3/ ~/ >/ a5/ / A2/ / A3/ ;/ 由/ a7/ ~/ >/ a2/ ∪/ a2/ ~/ >/ a1/ / a7/ ~/ >/ a1/ / A1/ / A4/ ./ 因此/ ,/ 系统/ 中/ 存在/ 的/ 两条/ 信任/ 链均/ 不/ 成立/ ./ 因此/ ,/ 可/ 得出/ TCG/ 的/ 信任/ 链/ 传递/ 存在/ 问题/ ,/ 即/ digest/ (/ Ai/ ,/ Ak/ )/ =/ expect/ (/ Ak/ )/ / Ai/ →/ Ak/ ./ 于是/ 得到/ 下面/ 的/ 具有/ 条件/ 约束/ 的/ 信任/ 链/ 传递/ 模型/ :/ Ai/ →/ / / INAk/ ∪/ digest/ (/ Ai/ ,/ Ak/ )/ =/ expect/ (/ Ak/ )/ / Ai/ →/ Ak/ 模型表示/ ,/ 可信计算/ 平台/ 的/ 组成/ 组件/ 在/ 系统/ 运行/ 时若/ 满足/ 非/ 传递/ 无/ 干扰/ 关系/ ,/ 则/ 信任/ 链/ 能够/ 建立/ ,/ 信任/ 关系/ 能够/ 传递/ ,/ 达到/ 平台/ 可信/ 目标/ ./ 4.2/ 无/ 干扰/ 信任/ 传递/ 判定/ 定理/ 上述/ 信任/ 链/ 传递/ 模型/ 关键/ 之处/ 是/ 验证/ 系统/ 中/ 是否/ 满足/ 非/ 传递/ 无/ 干扰/ 关系/ ,/ 但/ 从/ 非/ 传递/ 无/ 干扰/ 关系/ 的/ 定义/ 出发/ 很难/ 进行/ 验证/ ,/ 于是/ ,/ 基于/ 定理/ 1/ ,/ 本文/ 给出/ 无/ 干扰/ 信任/ 传递/ 判定/ 定理/ ,/ 用于/ 判定/ 可/ 观测/ 的/ 系统/ 状态/ 和/ 输出/ 在/ 满足/ 什么/ 条件/ 时/ ,/ 信任/ 链/ 的/ 建立/ 和/ 传递/ 才/ 是/ 有效/ 的/ ./ 定理/ :/ 定理/ 2/ ./ 系统/ 满足/ 非/ 传递/ 无/ 干扰/ 关系/ 的/ 判定/ (/ 1/ )/ 系统/ 的/ 域/ 满足/ 输出/ 一致性/ ./ 即/ 一个/ 内部/ 操作/ 动作/ 造成/ 的/ 输出/ 影响/ 只/ 依赖于/ 发出/ 动作/ 域/ 的/ 系统/ 视图/ ./ (/ 2/ )/ 系统/ 中/ 发生/ 的/ 一个/ 动作/ 造成/ 的/ 对系统/ 状态/ 影响/ 只/ 与/ 发出/ 该/ 动作/ 的/ 域/ 的/ 上/ 一/ 状态/ 系统/ 视图/ 相关联/ ./ 即/ s/ ~/ dom/ (/ a/ )/ t/ ∧/ (/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ ≠/ contents/ (/ s/ ,/ n/ )/ ∨/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ≠/ contents/ (/ t/ ,/ n/ )/ )/ →/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ./ (/ 3/ )/ 系统/ 中/ ,/ 如果/ 一个/ 动作/ 改变/ 了/ 一个/ 客体/ 对象/ 的/ 值/ ,/ 则/ 发出/ 该/ 动作/ 的/ 域/ 一定/ 可以/ 写访问/ 该/ 客体/ 对象/ ./ 即/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ ≠/ (/ 4/ )/ 系统/ 任意/ 两个/ 域间/ 满足/ 如下/ 关系/ :/ / n/ ∈/ N/ ,/ n/ ∈/ alter/ (/ u/ ,/ s/ )/ ∧/ n/ ∈/ observe/ (/ v/ ,/ s/ )/ →/ u/ ~/ >/ v/ ./ 证明/ ./ 根据/ 定理/ 1/ ,/ 只要/ 证明/ M/ 满足/ 输出/ 一致性/ ,/ 弱/ 单步/ 一致性/ 和/ 局部/ 干扰/ 性/ 即可/ ./ 输出/ 一致性/ 直接/ 由/ 判定/ 条件/ (/ 1/ )/ 得到/ ./ 下面/ 证明/ 弱/ 单步/ 一致性/ ,/ 即/ 证明/ s/ ~/ ut/ ∧/ s/ ~/ dom/ (/ a/ )/ t/ →/ step/ (/ s/ ,/ a/ )/ ~/ ustep/ (/ t/ ,/ a/ )/ ./ 上式/ 可以/ 写成/ :/ 对/ / n/ ∈/ domview/ (/ u/ ,/ s/ )/ ,/ 有/ 下式/ 成立/ s/ ~/ ut/ ∧/ s/ ~/ dom/ (/ a/ )/ t/ →/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ./ 对/ n/ 分/ 3/ 种/ 情况/ 讨论/ :/ (/ 1/ )/ 若/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ ≠/ contents/ (/ s/ ,/ n/ )/ ,/ 则/ 由/ M/ 满足/ 判定/ 条件/ 2/ ,/ 可得/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ./ (/ 2/ )/ 若/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ≠/ contents/ (/ t/ ,/ n/ )/ ,/ 类似/ 的/ ,/ 由/ M/ 满足/ 判定/ 条件/ 2/ ,/ 可得/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ./ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ s/ ,/ n/ )/ ∧/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ t/ ,/ n/ )/ ./ 又/ 由/ s/ ~/ ut/ →/ contents/ (/ s/ ,/ n/ )/ =/ contents/ (/ t/ ,/ n/ )/ ,/ 可得/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ =/ contents/ (/ step/ (/ t/ ,/ a/ )/ ,/ n/ )/ ./ 因此/ 弱/ 单步/ 一致性/ 得证/ ./ 以下/ 证明/ 局部/ 干扰/ 性/ ,/ 即/ 证明/ dom/ (/ a/ )/ ~/ // >/ u/ →/ (/ 3/ )/ 若非/ (/ 1/ )/ 、/ (/ 2/ )/ 两种/ 情况/ ,/ 则/ 必有/ s/ ~/ ustep/ (/ s/ ,/ a/ )/ ,/ 等价/ 于/ 证明/ 其/ 逆否命题/ :/ / n/ ∈/ domview/ (/ u/ ,/ s/ )/ ,/ contents/ (/ s/ ,/ n/ )/ ≠/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ →/ dom/ (/ a/ )/ ~/ >/ u/ ./ 由/ 判定/ 条件/ (/ 3/ )/ 可得/ contents/ (/ step/ (/ s/ ,/ a/ )/ ,/ n/ )/ ≠/ 又/ 由/ n/ ∈/ domview/ (/ u/ ,/ s/ )/ ,/ 根据/ 定理/ 中/ 判定/ 条件/ (/ 4/ )/ ,/ 立即/ 可得/ dom/ (/ a/ )/ ~/ >/ u/ 成立/ ./ 证毕/ ./ 若/ 组件/ 间/ 的/ 干扰/ 关系/ 具有/ 传递性/ ,/ 各域/ 间/ 通过/ 传递性/ 就/ 可能/ 产生/ 非/ 预期/ 干扰/ ,/ 那么/ ,/ 即使/ 通过/ 了/ TCG/ 规范/ 规定/ 的/ 完整性/ 度量/ ,/ 也/ 难以达到/ 系统/ 运行/ 可信/ 的/ 目标/ ./ 定理/ 2/ 给出/ 了/ 一个/ 计算机系统/ 满足/ 非/ 传递性/ 无/ 干扰/ 关系/ 的/ 形式化/ 规范/ ,/ 也/ 给出/ 了/ 一种/ 判定/ 可信计算/ 平台/ 信任/ 链/ 传递/ 关系/ 的/ 有效/ 方法/ ./ 如上所述/ ,/ 系统/ 域间/ 非/ 传递/ 无/ 干扰/ 也/ 就/ 意味着/ 系统/ 输出/ Page7/ 的/ 确定性/ 和/ 可/ 预期/ 性/ ,/ 能够/ 确保/ 信任/ 链/ 的/ 建立/ 不/ 受/ 系统/ 中/ 组件/ 间/ 干扰/ 行为/ 的/ 影响/ ./ 5/ 原型/ 实现/ 与/ 验证/ 我们/ 基于/ 开源/ 的/ 虚拟机/ 监视器/ (/ VMM/ )/ 系统/ Xen/ [/ 4/ ,/ 7/ ]/ ,/ 利用/ 虚拟/ 隔离/ 实现/ 了/ 一个/ 满足/ 非/ 传递/ 无/ 干扰/ 的/ 系统/ ./ 它/ 将/ 应用/ 完全/ 隔离/ ,/ 各/ 应用/ 之间/ 不能/ 直接/ 共享/ 信息/ ,/ 所有/ 隔离/ 域/ 之间/ 的/ 信息/ 交换/ 均/ 通过/ 虚拟机/ 监视器/ 进行/ ./ 如图/ 4/ 所示/ ,/ VMM/ 系统/ 上/ 的/ 设备/ 驱动/ 模型/ 由/ 运行/ 于/ 虚拟机/ 上/ 的/ 前端/ 驱动/ (/ 虚拟/ 设备/ )/ 和/ 运行/ 于/ 虚拟机/ 监视器/ 上/ 的/ 后/ 端/ 驱动/ (/ 实际/ 驱动程序/ )/ 组成/ ,/ 实现/ 对/ 硬件/ 设备/ 的/ 共享/ 使用/ ./ 虚拟机/ 间/ 的/ 信息流/ 只能/ 通过/ 可信/ 通道/ B/ 完成/ ./ 系统/ 中/ 由/ 不同/ 的/ 虚拟机/ 运行/ 不同/ 安全等级/ 的/ 应用/ 系统/ ,/ VMM/ 系统/ 上/ 的/ 信任/ 链由图/ 左侧/ 的/ ①/ 和/ ②/ 两步/ 建立/ (/ 先由/ 硬件平台/ 验证/ 基础/ 软件/ 层/ VMM/ ,/ 再/ 由/ VMM/ 对/ 虚拟机/ 整体/ 进行/ 验证/ )/ ./ 但/ 若/ 使/ 信任/ 链/ 有效/ ,/ 必须/ 确保/ 系统/ 中/ 不/ 存在/ 非/ 预期/ 的/ 干扰/ ,/ 即/ VMM/ 系统/ 中/ 运行/ 于/ VMM/ 之上/ 的/ 虚拟机/ 可以/ 对应/ 于/ 无/ 干扰/ 模型/ 的/ 安全/ 域/ ,/ 各个/ 域/ 之间/ 的/ 交互/ 只/ 通过/ I/ // O/ 设备/ 进行/ ,/ 因此/ ,/ 只要/ 验证/ 了/ 各/ 虚拟机/ 间/ 通过/ I/ // O/ 设备/ 的/ 交互/ 满足/ 非/ 传递/ 无/ 干扰/ 关系/ ,/ 则/ 通过/ 启动/ 阶段/ 针对/ 各/ 虚拟机/ 整体/ 作为/ 文件/ 的/ 完整性/ 验证/ 后/ ,/ VMM/ 系统/ 建立/ 的/ 信任/ 链是/ 有效/ 的/ ./ 序需/ 满足/ 如下/ 要求/ :/ 依据/ 定理/ 2/ ,/ 该/ VMM/ 系统/ 的/ I/ // O/ 设备/ 驱动/ 程/ (/ 1/ )/ 由/ 输出/ 一致性/ 的/ 定义/ 可知/ ,/ VMM/ 维护/ 的/ 虚拟/ 资源/ 必须/ 具有/ 其/ 属于/ 哪个/ 虚拟机/ 的/ 属性/ 标识/ ./ (/ 2/ )/ 由/ 局部/ 干扰/ 性/ 定义/ 可知/ ,/ VMM/ 系统/ 中/ ,/ 虚拟/ I/ // O/ 设备/ 除/ 其/ 所在/ 的/ 虚拟机/ 外/ 其它/ 虚拟机/ 不能/ 改变/ 它/ 的/ 运行/ 状态/ ,/ I/ // O/ 设备/ 驱动/ 与/ 虚拟/ 设备/ 间/ 所/ 传输/ 的/ 数据/ 对/ 其它/ 虚拟机/ 是/ 不/ 可见/ 和/ 不可/ 修改/ 的/ ./ 该/ VMM/ 系统/ 的/ 隔离/ 机制/ 确保/ 虚拟机/ 必须/ 采用/ 虚拟/ 设备/ 接口/ 访问/ 后/ 端/ 驱动程序/ ./ 每个/ 虚拟机/ 能够/ 访问/ 的/ I/ // O/ 寄存器/ 被/ 限制/ ,/ 能够/ 禁止/ 未/ 授权/ 的/ 访问/ ./ (/ 3/ )/ 由弱/ 单步/ 一致性/ 定义/ 可知/ ,/ 对于/ 若干/ 虚拟机/ 共享/ 的/ 客体/ 对象/ ,/ VMM/ 系统/ 必须/ 具有/ 同步/ 保护/ 机制/ 以/ 防止/ 不同/ 虚拟机/ 对/ 该/ 资源/ 的/ 竞争/ ./ 该/ 系统/ 依据/ 非/ 传递/ 无/ 干扰/ 策略/ 模型/ 对/ 传统/ VMM/ 的/ 虚拟/ I/ // O/ 设备/ 体系/ 进行/ 了/ 改造/ ,/ 只要/ 根据/ 应用程序/ 需求/ ,/ 合理/ 划分/ 安全/ 域/ ,/ 各/ 应用/ 安全/ 域/ 的/ 运行/ 不/ 受/ 其它/ 应用程序/ 干扰/ ,/ 依据/ 式/ (/ 1/ )/ 描述/ 的/ 信任/ 传递/ 模型/ ,/ 经过/ 完整性/ 验证/ ,/ 系统/ 运行/ 能够/ 达到/ 可信/ 目标/ ./ 6/ 结论/ 本文/ 从/ 可信/ 的/ 定义/ 入手/ ,/ 分析/ 了/ TCG/ 信任/ 链/ 的/ 局限性/ ,/ 指出/ 可信计算/ 平台/ 系统/ 中/ 加载/ 前/ 的/ 完整性/ 度量/ 并/ 不能/ 保证系统/ 运行/ 可信/ ,/ 如果/ 系统/ 没有/ 安全策略/ 限制/ ,/ 讨论/ 信任/ 链/ 传递/ 是/ 没有/ 意义/ 的/ ./ 然后/ 借鉴/ Trent/ 的/ PRIMA/ 方案/ ,/ 基于/ 无/ 干扰/ 模型/ ,/ 用/ 形式化/ 的/ 方法/ 论述/ 了/ 当/ 系统/ 满足/ 非/ 传递/ 无/ 干扰/ 的/ 安全策略/ 时/ ,/ 信任/ 链/ 的/ 建立/ 不/ 受/ 系统/ 中/ 其它/ 安全/ 无关/ 组件/ 与/ 行为/ 的/ 干扰/ ,/ 信任/ 才能/ 有效/ 地/ 传递/ 下去/ ,/ 系统/ 能够/ 建立/ 完整/ 的/ 信任/ 链/ ,/ 实现/ 可信/ 目标/ ./ 并/ 据此/ 提出/ 了/ 无/ 干扰/ 信任/ 传递/ 判定/ 定理/ ./ 但是/ ,/ 满足/ 非/ 传递/ 无/ 干扰/ 这一/ 条件/ 对系统/ 限制/ 可能/ 很/ 严格/ ,/ 下/ 一步/ 的/ 研究/ 方向/ 是/ 研究/ 更为/ 实用化/ 和/ 灵活/ 的/ 信任/ 传递/ 模型/ ./ 

