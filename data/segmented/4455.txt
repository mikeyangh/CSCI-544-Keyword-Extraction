Page1/ 一种/ 改进/ 的/ 网络安全/ 态势/ 量化/ 评估/ 方法/ 席荣荣/ 云晓春/ 张永铮/ 郝志宇/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 摘要/ 在/ 基于/ 隐/ 马尔可夫/ 模型/ 的/ 网络安全/ 态势/ 评估/ 中/ ,/ 观测/ 序列/ 的/ 获取/ 和/ 状态/ 转移/ 矩阵/ 的/ 确立/ 是/ 影响/ 评估/ 准确性/ 的/ 关键/ ./ 目前/ 观测/ 序列/ 多以/ 随机/ 方式/ 获取/ ,/ 不能/ 有效/ 表征/ 网络/ 的/ 安全性/ ;/ 而/ 状态/ 转移/ 矩阵/ 往往/ 依据/ 经验/ 给出/ ,/ 具有/ 很强/ 的/ 主观性/ ./ 该文/ 提出/ 改进/ 方法/ :/ 首先/ ,/ 基于/ 警报/ 的/ 统计/ 特性/ 提出/ 警报/ 质量/ 的/ 概念/ ,/ 依据/ 警报/ 质量/ 获取/ 的/ 观测/ 序列/ ,/ 可/ 改进/ 数据源/ 的/ 有效性/ ;/ 其次/ ,/ 基于/ 安全事件/ 和/ 防护/ 措施/ 的/ 博弈/ 过程/ ,/ 提出/ 确定/ 状态/ 转移/ 矩阵/ 的/ 方法/ ,/ 并/ 结合/ 攻击/ 成功/ 的/ 概率/ 对/ 其/ 进行/ 修正/ ,/ 提高/ 状态/ 转移/ 矩阵/ 的/ 有效性/ ./ 对比/ 实验/ 证明/ ,/ 基于/ 改进/ 算法/ 生成/ 的/ 风险/ 值/ 对/ 网络安全/ 态势/ 的/ 量化/ 更加/ 合理/ ./ 关键词/ 观测/ 序列/ ;/ 状态/ 转移/ 矩阵/ ;/ 警报/ 质量/ ;/ 博弈/ 矩阵/ ;/ 攻击/ 成功/ 的/ 概率/ 1/ 引言/ 面对/ 当前/ 日益/ 复杂/ 的/ 网络安全/ 问题/ ,/ 传统/ 的/ 安全/ 检测/ 和/ 防护/ 措施/ 为/ 网络/ 管理者/ 提供/ 了/ 海量/ 多源/ 数据/ ,/ 但/ 由于/ 大量/ 误报/ 或/ 不/ 相关/ 信息/ 的/ 存在/ ,/ 使得/ 数据/ 信息/ 具有/ 不确定性/ ./ 基于/ 不/ 确定/ 信息/ 评估/ 网络/ 的/ 安全/ 态势/ ,/ 准确性/ 受到/ 严重/ 影响/ ./ 为/ 解决/ 警报/ 信息/ 的/ 不/ Page2/ 确定性/ 问题/ ,/ ?/ rnes/ 等/ 人/ [/ 1/ ]/ 提出/ 采用/ 隐/ 马尔可夫/ 模型/ (/ HiddenMarkovModel/ ,/ HMM/ )/ 对/ 网络安全/ 状态/ 建模/ ,/ 基于/ 统计/ 模型/ 特性/ 解决/ 警报/ 信息/ 的/ 不确定性/ 问题/ ./ 但/ 模型/ 中/ 的/ 观测/ 序列/ 随机/ 获取/ ,/ 无法/ 保证/ 数据源/ 的/ 有效性/ ;/ 状态/ 转移/ 矩阵/ 根据/ 经验值/ 设定/ ,/ 不能/ 客观/ 反映/ 网络安全/ 状态/ 的/ 变化/ 过程/ ./ 后续/ 研究/ 不断/ 对/ 该/ 方法/ 进行/ 改进/ ,/ 但/ 仍/ 存在/ 局限性/ ./ 如/ Haslum/ 等/ 人/ [/ 2/ ]/ 基于/ 安全/ 状态/ 的/ 持续时间/ 确定/ 状态/ 转移/ 矩阵/ ,/ 但/ 由于/ 网络攻击/ 行为/ 的/ 随机性/ ,/ 使得/ 安全/ 状态/ 的/ 持续时间/ 难以确定/ ./ 李伟明/ 等/ 人/ [/ 3/ ]/ 利用/ 遗传算法/ 自动/ 求解/ 状态/ 转移/ 矩阵/ 和/ 观测/ 向量/ 分布/ 矩阵/ ,/ 该/ 方法/ 可/ 量化/ 评估/ 网络/ 的/ 安全/ 态势/ ./ 但/ 方法/ 中/ 风险/ 描述/ 规则/ 是/ 针对/ 特定/ 攻击/ 和/ 风险/ 的/ 形式化/ 描述/ ,/ 面对/ 网络攻击/ 行为/ 的/ 灵活性/ 和/ 多样性/ ,/ 构造/ 通用/ 的/ 风险/ 描述/ 规则/ 库存/ 在/ 很大/ 难度/ ./ 针对/ 观测/ 序列/ 的/ 获取/ 和/ 状态/ 转移/ 矩阵/ 的/ 确定/ ,/ 本文/ 提出/ 改进/ 方法/ ,/ 主要/ 工作/ 包括/ 两点/ :/ 第一/ ,/ 基于/ 警报/ 统计/ 特性/ 提出/ 警报/ 质量/ 的/ 概念/ ,/ 并/ 依据/ 警报/ 质量/ 获取/ 观测/ 序列/ ,/ 提高/ 数据源/ 的/ 有效性/ ;/ 第二/ ,/ 基于/ 安全事件/ 和/ 防护/ 措施/ 的/ 博弈/ 过程/ ,/ 提出/ 确定/ 状态/ 转移/ 矩阵/ 的/ 方法/ ,/ 并/ 结合/ 攻击/ 成功/ 的/ 概率/ 对/ 其/ 进行/ 修正/ ,/ 提高/ 状态/ 转移/ 矩阵/ 的/ 有效性/ ./ 2/ 基于/ HMM/ 的/ 网络安全/ 态势/ 评估/ 方法/ 在/ 实际/ 网络/ 中/ ,/ 网络安全/ 状态/ 是/ 不/ 可见/ 的/ ,/ 但/ 安全/ 状态/ 产生/ 的/ 警报/ 信息/ 是/ 可见/ 的/ ,/ 而且/ 各/ 安全/ 状态/ 与/ 可能/ 产生/ 的/ 警报/ 信息/ 之间/ 存在/ 特定/ 的/ 概率函数/ ,/ 警报/ 序列/ 能够/ 揭露/ 安全/ 状态/ 的/ 变化/ 信息/ ,/ 这/ 与/ 隐/ 马尔可夫/ 模型/ 的/ 核心思想/ 是/ 一致/ 的/ [/ 4/ ]/ ./ 因此/ 本文/ 采用/ 隐/ 马尔可夫/ 模型/ 刻画/ 网络安全/ 状态/ 的/ 变化/ 过程/ ./ 隐/ 马尔可夫/ 模型/ 由/ 五元/ 组/ 构成/ λ/ =/ {/ 犛/ ,/ 犞/ ,/ 犘/ ,/ 犙/ ,/ π/ }/ [/ 5/ ]/ ,/ 为了/ 将/ 其/ 应用/ 于/ 网络安全/ 态势/ 评估/ ,/ 首先/ 对/ 五元/ 组/ 进行/ 说明/ :/ (/ 1/ )/ 犛为/ 状态/ 集合/ 空间/ ,/ 犛/ =/ {/ S1/ ,/ S2/ ,/ …/ ,/ SN/ }/ ,/ 其中/ Si/ 表示/ 一个/ 独立/ 的/ 状态/ ,/ N/ 表示/ 状态/ 的/ 数目/ ./ 不同/ 的/ 安全事件/ 导致/ 网络/ 进入/ 不同/ 的/ 安全/ 状态/ ,/ 依据/ 安全事件/ 的/ 划分/ ,/ 将/ 网络/ 的/ 安全/ 状态/ 划分/ 为/ 安全/ 状态/ G/ 、/ 探测/ 状态/ R/ 、/ 入侵/ 状态/ B/ 和/ 攻陷/ 状态/ C/ ,/ 即/ 犛/ =/ {/ G/ ,/ R/ ,/ B/ ,/ C/ }/ ./ 安全/ 状态/ G/ (/ Good/ )/ 表示/ 网络/ 中/ 不/ 存在/ 任何/ 攻击行为/ ,/ 处于/ 安全/ 状态/ ;/ 探测/ 状态/ R/ (/ Reconnaissance/ )/ 表示/ 网络/ 中/ 存在/ 扫描/ 类/ 的/ 行为/ ,/ 攻击者/ 采集/ 信息/ 阶段/ ;/ 统/ 权限/ 的/ 行为/ ,/ 攻击者/ 入侵/ 网络/ 阶段/ ;/ 入侵/ 状态/ B/ (/ Break/ -/ in/ )/ 表示/ 网络/ 中/ 存在/ 破坏/ 系/ 攻陷/ 阶段/ C/ (/ Compromised/ )/ 表示/ 网络/ 已/ 被/ 攻陷/ ,/ 攻击者/ 获得/ 系统/ 权限/ ./ (/ 2/ )/ 犞/ 是/ 观测/ 向量/ 集合/ 空间/ ,/ 犞/ =/ {/ 狏/ 1/ ,/ 狏/ 2/ ,/ …/ ,/ 狏/ M/ }/ ,/ 其中/ 狏/ i/ 表示/ 观测/ 向量/ ,/ M/ 表示/ 各/ 状态/ 观测/ 向/ 量值/ 的/ 数目/ ./ 网络安全/ 状态/ 是/ 不/ 可见/ 的/ ,/ 可/ 直接/ 观测/ 到/ 的/ 只有/ 安全/ 防护/ 设备/ 产生/ 的/ 警报/ 信息/ ./ 若/ 直接/ 将/ 海量/ 警报/ 种类/ 应用/ 于/ HMM/ 模型/ ,/ 会/ 导致/ 模型/ 规模/ 过大/ ,/ 严重/ 影响/ 运算/ 效率/ ./ 为/ 解决/ 上述/ 问题/ ,/ 将/ 原始/ 警报/ 进行/ 分类/ ./ 根据/ 警报/ 所/ 代表/ 的/ 安全事件/ ,/ 将/ 警报/ 分为/ 4/ 类/ 犞/ =/ {/ g/ ,/ r/ ,/ b/ ,/ c/ }/ ./ g/ 表示/ 在/ 采样/ 周期/ 内/ ,/ 没有/ 采集/ 到/ 任何/ 警报/ 信息/ ;/ r/ 表示/ 扫描/ 类/ 的/ 警报/ 信息/ ,/ 如/ ICMPping/ ,/ ICMPdestinationunreachable/ 等/ ;/ b/ 表示/ 入侵/ 类/ 的/ 警报/ 信息/ ,/ 如/ webcgiredirectaccess/ ,/ badtrafficloopback/ 等/ ;/ c/ 表示/ 获取/ root/ 权限/ 的/ 警报/ 信息/ ,/ 如/ servicesrshroot/ 等/ ./ (/ 3/ )/ 犘/ 为/ 状态/ 转移/ 矩阵/ ,/ 表示/ 从/ 一个/ 状态/ 转移/ 到/ 另/ 一个/ 状态/ 的/ 概率分布/ ,/ 犘/ =/ {/ pij/ }/ ,/ 其中/ pij/ =/ P/ (/ qt/ +/ 1/ =/ Sj/ |/ qt/ =/ Si/ )/ ,/ 1/ / i/ ,/ j/ / N/ ,/ 表示/ 在/ T/ 时刻/ 网络/ 处于/ Si/ 状态/ ,/ 在/ T/ +/ 1/ 时刻/ 处于/ Sj/ 状态/ 的/ 概率/ ./ 本文/ 采用/ 的/ 状态/ 转移/ 矩阵/ 如图/ 1/ 所示/ ./ (/ 4/ )/ 犙/ 为/ 观测/ 向量/ 概率分布/ 矩阵/ 犙/ =/ {/ qi/ (/ vk/ )/ }/ ,/ 其中/ qi/ (/ vk/ )/ =/ p/ (/ o/ =/ vkqt/ =/ Si/ )/ ,/ 1/ / i/ / N/ ,/ 1/ / k/ / M/ ,/ 表示/ T/ 时刻/ ,/ 网络/ 处于/ 状态/ Si/ 且/ 观测/ 到/ 的/ 警报/ 信息/ 为/ vk/ 的/ 概率/ ./ (/ 5/ )/ π/ 为/ 初始状态/ 概率分布/ 矩阵/ ,/ π/ =/ {/ π/ i/ }/ ,/ 其中/ π/ i/ =/ p/ (/ q1/ =/ Si/ )/ ,/ 1/ / i/ / N/ ,/ 表示/ 在/ 最初/ 时刻/ ,/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ ./ 确定/ HMM/ 五元/ 组/ 之后/ ,/ 根据/ 每个/ 采样/ 周期/ 获取/ 的/ 观测/ 向量/ 可/ 实时/ 更新/ 网络/ T/ 时刻/ 处于/ 状态/ SiPage3/ 的/ 概率/ λ/ t/ (/ i/ )/ ,/ 再/ 引入/ 一个/ 风险/ 损失/ 向量/ 犆/ (/ i/ )/ ,/ 可/ 求解/ 任意/ T/ 时刻/ 网络/ 总/ 风险/ 犚/ T/ 其中/ :/ λ/ t/ (/ i/ )/ 表示/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ ,/ 犆/ (/ i/ )/ 表示/ 状态/ Si/ 相应/ 的/ 风险/ 损失/ ,/ N/ 表示/ 状态/ 数目/ ./ 在/ 安全/ 态势/ 评估/ 过程/ 中/ ,/ 观测/ 序列/ 的/ 获取/ 和/ 状态/ 转移/ 矩阵/ 的/ 确立/ 是/ 影响/ 评估/ 准确性/ 的/ 关键/ ./ 目前/ 观测/ 向量/ 多以/ 随机/ 方式/ 获取/ ,/ 不/ 具有/ 代表性/ ,/ 不能/ 表征/ 网络/ 的/ 安全/ 特性/ ./ 本文/ 通过/ 选取/ 质量/ 最高/ 的/ 警报/ 作为/ HMM/ 观测/ 向量/ ,/ 可/ 提高/ 警报/ 数据源/ 的/ 有效性/ ./ 对于/ 状态/ 转移/ 矩阵/ 的/ 确立/ ,/ 往往/ 根据/ 专家/ 经验/ 设置/ ,/ 但/ 手工/ 设置/ 主观性/ 强/ ,/ 准确性/ 不高/ ,/ 效果/ 的/ 好坏/ 往往/ 依赖于/ 专家/ 水平/ 的/ 高低/ ./ 为/ 解决/ 上述/ 问题/ ,/ 基于/ 安全事件/ 和/ 防护/ 措施/ 的/ 博弈/ 过程/ ,/ 提出/ 确定/ 状态/ 转移/ 矩阵/ 的/ 方法/ ,/ 并/ 结合/ 攻击/ 成功/ 的/ 概率/ 对/ 其/ 进行/ 修正/ ,/ 提高/ 状态/ 转移/ 矩阵/ 的/ 有效性/ ./ 3/ 算法/ 改进/ 3.1/ 获取/ 观测/ 序列/ 入侵/ 检测/ 系统/ 通常/ 会/ 产生/ 海量/ 警报/ 信息/ ,/ 其中/ 很大/ 比例/ 为/ 误报/ 或者/ 不/ 相关/ 警报/ ./ 报警/ 量/ 大/ 、/ 不/ 相关/ 警报/ 多/ ,/ 使得/ HMM/ 观测/ 向量/ 的/ 获取/ 存在/ 很大/ 难度/ ./ 为了/ 更加/ 明确/ 地/ 定义/ 警报/ 表征/ 网络安全/ 特性/ 的/ 有效/ 程度/ ,/ 参考/ 质量/ 因子/ [/ 7/ ]/ 的/ 思想/ ,/ 本文/ 引入/ 一个/ 新/ 的/ 概念/ —/ —/ —/ 警报/ 质量/ ./ 定义/ 1/ ./ 警报/ 质量/ QoA/ (/ QualityofAlert/ )/ ,/ 指/ 警报/ 表征/ 网络安全/ 特性/ 的/ 有效/ 程度/ ./ 警报/ 的/ 质量/ 越高/ ,/ 越能/ 有效/ 表征/ 网络/ 的/ 安全/ 特性/ [/ 8/ ]/ ./ 为了/ 量化/ 警报/ 质量/ ,/ 首先/ 将/ 警报/ 模型/ 化为/ 笛卡尔/ 积/ 的/ 形式/ :/ 其中/ (/ A1/ ,/ A2/ ,/ …/ ,/ An/ )/ 表示/ 警报/ 的/ 属性/ [/ 9/ ]/ ,/ DAi/ 表示/ 属性/ Ai/ 的/ 取值/ 范围/ ./ 警报/ 的/ 属性/ Ai/ 既/ 包括/ 警报/ 的/ 基本/ 属性/ ,/ 如/ 警报/ 的/ 源/ IP/ ,/ 目的/ IP/ ,/ 类型/ 以及/ 产生/ 时间/ 等/ ,/ 也/ 包括/ 警报/ 的/ 统计/ 特性/ [/ 10/ -/ 13/ ]/ ,/ 如/ 警报/ 出现/ 频次/ AlF/ (/ AlertFrequency/ )/ ,/ 警报/ 关键/ 程度/ AlC/ (/ AlertCriticality/ )/ 以及/ 警报/ 严重/ 程度/ AlS/ (/ AlertSeverity/ )/ 等/ ./ 基本/ 属性/ 用于/ 描述/ 警报/ 的/ 内在/ 属性/ ,/ 与/ 网络安全/ 特性/ 无关/ ,/ 因此/ 不/ 属于/ 讨论/ 范畴/ ,/ 主要/ 讨论/ 警报/ 的/ 统计/ 属性/ :/ AlF/ 为/ 警报/ 出现/ 频次/ ,/ 表示/ 单位/ 时间/ 内/ 警报/ 出现/ 的/ 相对/ 次数/ ./ 安全设备/ 的/ 特性/ 决定/ 针对/ 某一/ 攻击行为/ ,/ 在/ 短时间/ 内会/ 产生/ 大量/ 同/ 类型/ 的/ 警报/ 信息/ ,/ 即/ 出现/ 频次/ 越高/ 的/ 警报/ 信息/ 越能/ 刻画/ 当前/ 的/ 网络攻击/ 行为/ ./ 因此/ 将/ 警报/ 出现/ 频次/ 作为/ 警报/ 质量/ 的/ 一个/ 统计/ 特征/ ,/ 定义/ 为/ AlC/ 为/ 警报/ 关键/ 程度/ ,/ 指/ 警报/ 表征/ 网络安全/ 状态/ 发生/ 转变/ 的/ 强弱/ 程度/ ./ 警报/ 的/ 关键/ 程度/ 越高/ 表示/ 网络安全/ 状态/ 发生/ 转变/ 的/ 可能性/ 越大/ ./ 监测/ 过程/ 中/ ,/ 若/ 出现/ 新/ 的/ 警报/ ,/ 表明/ 网络/ 中/ 存在/ 新/ 的/ 攻击行为/ ,/ 网络安全/ 状态/ 发生/ 转变/ 的/ 可能性/ 增加/ ./ 因此/ 将/ 警报/ 的/ 出现/ 节点/ 作为/ 警报/ 关键/ 程度/ 的/ 指征/ ./ 根据/ 警报/ 的/ 出现/ 情况/ ,/ 将/ 其/ 分为/ 3/ 类/ :/ 本/ 采样/ 周期/ 内/ 已/ 出现/ 过/ 的/ 警报/ ;/ 在/ 之前/ 的/ N/ 个/ 周期/ 内/ 出现/ 过/ 的/ 警报/ ;/ 在/ 之前/ 的/ N/ 个/ 周期/ 内未/ 出现/ 过/ 的/ 警报/ ./ 其/ 相应/ 的/ 优先/ 级别/ 分别/ 设为/ 1/ ,/ 2/ ,/ 3/ ./ 其中/ 周期/ N/ 的/ 选择/ 不仅/ 与/ 周期/ 间隔/ 有关/ ,/ 而且/ 与/ 周期/ 的/ 持续时间/ 相关/ ./ 根据/ 文献/ [/ 14/ ]/ 提出/ 的/ 攻击/ 事件/ 持续时间/ 的/ 阈值/ 及/ 本文/ 的/ 采样/ 周期/ ,/ 将/ 周期/ N/ 设置/ 为/ 3/ ./ AlS/ 为/ 警报/ 严重/ 程度/ ,/ 表示/ 警报/ 产生/ 的/ 影响/ ./ 严重/ 程度/ 越高/ 表明/ 其/ 对/ 安全/ 状态/ 的/ 影响/ 越大/ ./ 参考/ Snort/ 用户手册/ 定义/ 的/ 攻击/ 类别/ ,/ 将/ 警报/ 严重/ 程度/ 划分/ 为/ 高/ 、/ 中/ 、/ 低/ 3/ 个/ 等级/ ,/ 分别/ 设置/ 为/ 1/ ,/ 2/ ,/ 3/ ./ 上述/ 分析表明/ ,/ 警报/ 出现/ 频次/ 、/ 关键/ 程度/ 和/ 严重/ 程度/ 是/ 决定/ 警报/ 质量/ 的/ 关键因素/ ,/ 结合/ 3/ 个/ 关键因素/ ,/ 给出/ 警报/ 质量/ 的/ 量化/ 模型/ 如图/ 2/ 所示/ ./ 模型/ 将/ 各/ 属性/ 值/ 作为/ 警报/ 质量/ 的/ 量化/ 因子/ ,/ 将/ 警报/ 质量/ 定义/ 为/ 各/ 属性/ 值/ 连线/ 所/ 包围/ 的/ 面积/ 之/ 和/ :/ Page4/ 其中/ :/ AlC/ ,/ AlS/ 分别/ 表示/ 警报/ 关键/ 程度/ 和/ 严重/ 程度/ 的/ 属性/ 值/ ;/ AlF/ / 表示/ 警报/ 出现/ 频次/ AlF/ 的/ 标准化/ 值/ ./ 因为/ AlF/ ∈/ [/ 0/ ,/ 1/ ]/ ,/ 与/ 其他/ 属性/ 的/ 取值/ 范围/ 不同/ ,/ 为/ 均衡/ 各/ 属性/ 对/ 警报/ 质量/ 的/ 影响/ ,/ 应/ 保证/ 各/ 属性/ 具有/ 相同/ 的/ 值域/ ./ 因此/ 采用/ 离差/ 标准化/ 的/ 反函数/ 将/ 警报/ 出现/ 频次/ AlF/ 标准化/ 为/ AlF/ / :/ AlF/ / =/ AlF/ (/ Max/ -/ Min/ )/ +/ Min/ =/ 2AlF/ +/ 1/ (/ 5/ )/ 标准化/ 值/ AlF/ / ∈/ [/ 1/ ,/ 3/ ]/ ,/ 与/ 其他/ 属性/ 具有/ 相同/ 的/ 值域/ ./ 当/ 警报/ 的/ 出现/ 频次/ 、/ 关键/ 程度/ 和/ 严重/ 程度/ 的/ 属性/ 值/ 确定/ 时/ ,/ 可/ 根据/ 式/ (/ 4/ )/ 求解/ 警报/ 质量/ ./ 如图/ 2/ 所示/ ,/ 当/ AlF/ =/ 0.4/ ,/ AlC/ =/ 1/ ,/ AlS/ =/ 2/ 时/ ,/ AlF/ / =/ 1.8/ ,/ QoA/ =/ (/ 1.8/ ,/ 1/ ,/ 2/ )/ =/ 3.7/ ./ 在/ 每个/ 采样/ 周期/ ,/ 通过/ 选取/ 质量/ 最高/ 的/ 警报/ ,/ 获取/ HMM/ 的/ 观测/ 向量/ ./ 依据/ 警报/ 质量/ 获取/ 的/ 观测/ 向量/ 可/ 有效/ 改进/ 数据源/ ,/ 提高/ 评估/ 准确性/ ./ 3.2/ 确定/ 状态/ 转移/ 矩阵/ 状态/ 转移/ 矩阵/ 是/ 影响/ 安全/ 态势/ 评估/ 准确性/ 的/ 关键/ ./ 传统/ 的/ 状态/ 转移/ 矩阵/ 往往/ 依据/ 经验/ 给出/ ,/ 具有/ 很强/ 的/ 主观性/ ./ 本文/ 将/ 基于/ 网络安全/ 状态/ 转移/ 过程/ 确定/ 状态/ 转移/ 矩阵/ ./ 事件驱动/ 的/ 网络安全/ 状态/ 转移/ 过程/ 将/ 网络/ 视作/ 一个/ 状态机/ [/ 15/ ]/ ,/ 安全事件/ 则/ 是/ 网络/ 状态/ 转移/ 的/ 依据/ ./ 事件驱动/ 的/ 网络/ 状态/ 转移/ 模型/ 如图/ 3/ 所示/ ./ 其中/ G/ ,/ R/ ,/ B/ ,/ C/ 表示/ 网络/ 状态/ ;/ Ei/ 表示/ 安全事件/ ;/ Di/ 表示/ 防护/ 措施/ ./ 若/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ ,/ 在/ 此/ 状态/ 下/ ,/ 发现异常/ 情况/ 形成/ 安全事件/ Ej/ ,/ 或者/ 执行/ 了/ 安全/ 防护/ 措施/ Dj/ ,/ 则/ 导致/ 网络/ T/ +/ 1/ 时刻/ 进入状态/ Sj/ ./ 该/ 过程/ 表示/ 为/ Si/ 上述/ 分析表明/ 网络/ 状态/ 转移/ 的/ 实质/ 为/ 安全事件/ 与/ 防护/ 措施/ 的/ 博弈/ ./ 因此/ 基于/ 博弈/ 过程/ 提出/ 了/ 确定/ 状态/ 转移/ 矩阵/ 的/ 方法/ ,/ 该/ 方法/ 根据/ 博弈/ 过程/ 确定/ 状态/ 转移/ 矩阵/ ,/ 并/ 结合/ 攻击/ 成功/ 的/ 概率/ 对/ 其/ 进行/ 修正/ ./ (/ 1/ )/ 确定/ 状态/ 转移/ 矩阵/ 基于/ 安全事件/ 与/ 防护/ 措施/ 的/ 博弈/ ,/ 网络安全/ 状态/ 的/ 转移/ 可/ 描述/ 为/ 犈/ ×/ 犇/ 矩阵/ ,/ 如表/ 1/ ./ 表/ 1/ 安全事件/ 与/ 防护/ 措施/ 的/ 犈/ ×/ 犇/ 矩阵/ E1/ …/ En/ 犈/ 为/ 安全事件/ ,/ 网络/ 中/ 存在/ 多种/ 安全事件/ ,/ 为/ 简化/ 分析/ ,/ 定义/ 4/ 种/ 安全事件/ :/ 无/ 安全事件/ / 、/ 扫描/ 类/ 安全事件/ ER/ 、/ 入侵/ 类/ 安全事件/ EB/ 、/ 获取/ 系统/ 权限/ 类/ 安全事件/ EC/ ;/ 定义/ 犈/ =/ {/ / ,/ ER/ ,/ EB/ ,/ EC/ }/ ./ 犇/ 为/ 网络/ 中/ 的/ 防护/ 措施/ ,/ 将/ 网络/ 中/ 的/ 防护/ 措施/ 简化/ 为/ :/ 无/ 任何/ 防护/ 措施/ / ,/ 监测/ 类/ 防护/ 措施/ DS/ ,/ 阻止/ 类/ 防护/ 措施/ DF/ ,/ 修复/ 类/ 防护/ 措施/ DR/ ;/ 定义/ 犇/ =/ {/ / ,/ DS/ ,/ DF/ ,/ DR/ }/ ./ 犈/ ×/ 犇/ 矩阵/ 直观/ 给出/ 了/ 安全/ 状态/ 转移/ 的/ 分布/ 情况/ ./ 由/ 矩阵/ 可知/ ,/ 状态/ Si/ 转移/ 到/ Sj/ 的/ 概率/ pij/ =/ NSj/ ∑/ i/ ∈/ {/ G/ ,/ R/ ,/ B/ ,/ C/ }/ Nsi/ 率/ ,/ 即/ 从/ Si/ 转移/ 到/ Sj/ 的/ 状态/ 数目/ 占/ 从/ Si/ 转出/ 的/ 所有/ 可能/ 状态/ 数目/ 的/ 比重/ ./ Nsj/ 表示/ 从/ 状态/ Si/ 转移/ 到/ 状态/ Sj/ 的/ 数目/ ,/ ∑/ i/ ∈/ {/ G/ ,/ R/ ,/ B/ ,/ C/ }/ Nsi/ 表示/ 从/ 状态/ Si/ 转出/ 的/ 所有/ 可能/ 状态/ 数目/ 之/ 和/ ./ 根据/ 各/ 状态/ 的/ 概率分布/ ,/ 可/ 确定/ 状态/ 转移/ 矩阵/ ./ 例如/ 当/ 网络/ 处于/ 安全/ 状态/ G/ 时/ ,/ 安全事件/ 与/ 防护/ 措施/ 的/ 博弈/ 过程/ [/ 16/ ]/ 如下/ :/ 当/ 网络/ 中/ 无/ 安全事件/ 时/ ,/ 则/ 无论/ 采取/ 何种/ 防护/ 措施/ ,/ 网络/ 均/ 处于/ 安全/ 状态/ ./ 当/ 网络/ 中/ 发生/ 扫描/ 类/ 安全事件/ 时/ ,/ 若/ 网络/ 中/ 无/ 任何/ 防护/ 措施/ ,/ 则/ 网络/ 转移/ 到/ 探测/ 状态/ R/ ;/ 若/ 网络/ 中/ 存在/ 监测/ 类/ 防护/ 措施/ ,/ 表明/ 网络/ 可/ 检测/ 到/ 扫描/ 行为/ ,/ 但/ 并/ 不/ 阻止/ ,/ 则/ 网络/ 转移/ 到/ 探测/ 状态/ R/ ;/ 若/ 网络/ 中/ 存在/ 阻止/ 类/ 或者/ 修复/ 类/ 防护/ 措施/ ,/ 则/ 网络/ 保持/ 在/ 安全/ 状态/ G/ ./ 当/ 网络/ 中/ 发生/ 入侵/ 类/ 安全事件/ 时/ ,/ 若/ 网络/ 中/ 无/ 任何/ 防护/ 措施/ ,/ 则/ 网络/ 转移/ 到/ 入侵/ 状态/ B/ ;/ 若/ 网络/ 中/ 存在/ 监测/ 类/ 防护/ 措施/ ,/ 则/ 网络安全/ 状态/ 的/ 转移/ 取决于/ 管理人员/ 采取/ 的/ 策略/ ./ 本文/ 对/ 50/ 名/ 网络安全/ 管理人员/ 进行/ 了/ 调查/ ,/ 发现/ 其中/ 27/ 名/ 安全/ 管理人员/ 实时处理/ 安全事件/ ,/ 另外/ 23/ 名/ 安全/ 管理人员/ 周期性/ 对系统/ 进行/ 维护/ ./ 根据/ 不同/ 的/ 管理策略/ ,/ 将/ 网络/ 保持/ 在/ 安/ Page5/ 全/ 状态/ G/ 和/ 转移/ 到/ 入侵/ 状态/ B/ 的/ 概率/ 均/ 设为/ 1/ // 2/ ./ 若/ 网络/ 具有/ 阻止/ 类/ 或者/ 修复/ 类/ 防护/ 措施/ ,/ 则/ 网络/ 保持/ 在/ 安全/ 状态/ G/ ./ 当/ 网络/ 中/ 存在/ 攻陷/ 类/ 安全事件/ 时/ ,/ 分析/ 同/ 入侵/ 依据/ 上述/ 分析/ ,/ 构建/ 安全/ 状态/ G/ 的/ 犈/ ×/ 类/ 安全事件/ ./ 犇/ 矩阵/ 如表/ 2/ ./ 安全事件/ / GGGGERRRGGEBB1/ // 2G/ ,/ 1/ // 2BGGECC1/ // 2G/ ,/ 1/ // 2CGG/ 根据/ 状态/ G/ 的/ 犈/ ×/ 犇/ 矩阵/ ,/ 求解/ 状态/ G/ 转移/ 到/ 其他/ 状态/ 的/ 概率/ 分别/ 为/ pGG/ =/ 转移/ 到/ 状态/ G/ 的/ 状态/ 数/ pGR/ =/ 转移/ 到/ 状态/ R/ 的/ 状态/ 数/ pGB/ =/ 转移/ 到/ 状态/ B/ 的/ 状态/ 数/ pGC/ =/ 转移/ 到/ 状态/ C/ 的/ 状态/ 数/ 分别/ 构建/ 状态/ R/ ,/ B/ ,/ C/ 的/ 犈/ ×/ 犇/ 矩阵/ ,/ 则/ 可/ 初步/ 确定/ 状态/ 转移/ 矩阵/ 如下/ 所示/ :/ 上述/ 分析/ 中/ 存在/ 一个/ 假设/ ,/ 即/ 若/ 安全事件/ 发生/ ,/ 则/ 攻击行为/ 肯定/ 成功/ ./ 但/ 我们/ 已知/ ,/ 真实/ 网络/ 中/ 并非/ 所有/ 的/ 攻击行为/ 都/ 会/ 成功/ [/ 17/ ]/ ./ 为了/ 使得/ 状态/ 转移/ 矩阵/ 更加/ 合理/ ,/ 对/ 攻击行为/ 成功/ 的/ 概率/ 进行/ 分析/ ,/ 修正/ 状态/ 转移/ 矩阵/ ./ (/ 2/ )/ 修正/ 状态/ 转移/ 矩阵/ 通过/ 进一步/ 分析/ 攻击行为/ ,/ 发现/ 攻击/ 成功/ 的/ 概率/ 与/ 攻击者/ 的/ 类型/ ,/ 攻击者/ 的/ 能力/ ,/ 攻击/ 所/ 需/ 的/ 资源/ 及/ 网络/ 的/ 防护/ 措施/ 相关/ ,/ 因此/ 定义/ 状态/ 转移/ 矩阵/ 的/ 修正/ 函数/ 为/ AM/ 为/ 攻击者/ 的/ 类型/ ,/ 网络/ 中/ 的/ 攻击行为/ 大部分/ 由/ 初始/ 攻击者/ 发起/ ,/ 少部分/ 由/ 熟练/ 攻击者/ 发起/ ,/ 只有/ 极少/ 部分/ 由/ 专业/ 人员/ 发起/ ,/ 但/ 由/ 极少数/ 专业/ 人员/ 发起/ 的/ 攻击/ 却/ 对/ 网络安全/ 状态/ 的/ 变化/ 起/ 决定/ 作用/ ,/ 这/ 与/ 帕累托/ 分析法/ [/ 16/ ]/ 的/ 思想/ 是/ 一致/ 的/ ./ 因此/ 运用/ 帕累托/ 法则/ ,/ 将/ 攻击者/ 为/ 专业/ 人员/ ,/ 熟练/ 攻击者/ 和/ 初始/ 攻击者/ 的/ 概率/ 分别/ 设定/ 为/ 1/ // 25/ 、/ 4/ // 25/ 和/ 4/ // 5/ ./ AC/ 为/ 攻击者/ 的/ 能力/ ,/ 攻击者/ 的/ 能力/ 越强/ ,/ 攻击/ 成功/ 的/ 概率/ 越高/ ./ 按照/ 能力/ 的/ 不同/ 将/ 攻击者/ 划分/ 为/ 专业/ 人员/ 、/ 熟练/ 攻击者/ 和/ 初始/ 攻击者/ 3/ 个/ 等级/ ,/ 其/ 能力/ 分别/ 设定/ 为/ 100/ 、/ 10/ 、/ 1/ ./ AR/ 为/ 完成/ 攻击/ 所/ 需要/ 的/ 资源/ ,/ 攻击/ 需要/ 的/ 资源/ 越/ 多/ ,/ 攻击/ 成功/ 的/ 概率/ 越低/ ./ 按照/ 安全事件/ 对/ 资源/ 需求/ 的/ 不同/ ,/ 将/ 其/ 划分/ 为/ 需要/ 大量/ 资源/ 、/ 需要/ 部分/ 资源/ 和/ 不/ 需要/ 资源/ 3/ 个/ 等级/ ,/ 分别/ 设定/ 为/ 100/ 、/ 10/ 、/ 1/ ./ 与/ 攻击者/ 的/ 能力/ 相比/ ,/ 攻击/ 对/ 资源/ 的/ 需求/ 对/ 攻击/ 成功/ 概率/ 的/ 影响/ 要弱/ 一些/ ,/ 为了/ 提高/ 函数/ 的/ 合理性/ ,/ 采用/ 系数/ 10/ 进行/ 调整/ ./ D/ 为/ 网络/ 中/ 的/ 防护/ 措施/ ,/ 防护/ 措施/ 级别/ 越高/ ,/ 攻击/ 成功/ 的/ 概率/ 越低/ ./ 根据/ 定义/ 的/ 4/ 种/ 防护/ 措施/ ,/ 将/ 无/ 任何/ 防护/ 措施/ / ,/ 监测/ 类/ 的/ 防护/ 措施/ DS/ ,/ 阻止/ 类/ 的/ 防护/ 措施/ DF/ 和/ 修复/ 类/ 的/ 防护/ 措施/ DR/ 分别/ 量化/ 为/ 0/ 、/ 1/ 、/ 2/ 、/ 3/ ./ 与/ 完成/ 攻击/ 所/ 需/ 的/ 资源/ 相比/ ,/ 防护/ 措施/ 对于/ 攻击/ 成功/ 的/ 影响/ 更大/ 一些/ ,/ 因此/ 采用/ 指数/ 形式/ 表征/ 防护/ 措施/ ./ i/ ,/ j/ ,/ k/ 的/ 取值/ 由/ 划分/ 面/ 决定/ ./ 划分/ 面是/ 指/ 进入/ 某种/ 网络安全/ 状态/ 所/ 必须/ 的/ 条件/ 组合/ ./ 例如/ 网络/ 若要/ 从/ 安全/ 状态/ G/ 进入/ 探测/ 状态/ R/ ,/ 划分/ 面如图/ 4/ 所示/ ./ 任何/ 能力/ 的/ 攻击者/ 都/ 可以/ 实现/ ,/ AC/ ∈/ {/ 1/ ,/ 10/ ,/ 100/ }/ ;/ 且/ 相应/ 的/ AM/ ∈/ {/ 4/ // 5/ ,/ 4/ // 25/ ,/ 1/ // 25/ }/ ;/ 不/ 需要/ 任何/ 资源/ ,/ AR/ ∈/ {/ 1/ }/ ;/ 网络/ 中/ 不/ 存在/ 阻止/ 类及/ 更/ 高级/ 的/ 防护/ 措施/ ,/ D/ ∈/ {/ 0/ ,/ 1/ }/ ;/ 得到/ 的/ 修正/ 函数/ p/ 如下/ :/ p/ =/ ∑/ 100Page6/ 采用/ 修正/ 函数/ p/ 更新/ 状态/ G/ 转移/ 到/ 状态/ R/ 的/ 概率/ PGR/ :/ 同理/ 可/ 分别/ 求得/ 状态/ B/ ,/ C/ 的/ 修正/ 函数/ ,/ 利用/ 修正/ 函数/ 更新/ 状态/ 转移/ 矩阵/ ,/ 修正/ 结果/ 如下/ :/ PGR/ =/ PGR/ ×/ p/ =/ 0.13/ ×/ 0.9/ =/ 0.117/ 犘/ =/ 3.3/ 网络/ 状态/ 更新/ 算法/ 确定/ 观测/ 序列/ Ot/ 和/ 模型/ 参数/ λ/ =/ {/ 犛/ ,/ 犞/ ,/ 犘/ ,/ 犙/ ,/ π/ }/ 之后/ ,/ 采用/ 与/ 文献/ [/ 1/ ]/ 相同/ 的/ 前/ 向/ 算法/ 更新/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ λ/ t/ =/ {/ λ/ t/ (/ i/ )/ }/ ./ 算法/ 的/ 复杂度/ 为/ O/ (/ N2/ )/ ,/ 算法/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 网络/ 状态/ 概率/ 更新/ 算法/ ./ 输入/ :/ T/ 时刻/ 的/ 观测/ 向量/ 犗/ t/ ,/ HMM/ 的/ 模型/ 参数/ λ/ 输出/ :/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ λ/ t/ (/ i/ )/ 1/ ./ IfT/ =/ 1then2/ ./ fori/ =/ 1toNdo3/ ./ α/ 1/ (/ i/ )/ =/ π/ iqi/ (/ O1/ )/ 4/ ./ λ/ 1/ (/ i/ )/ =/ α/ 1/ (/ i/ )/ 表/ 3LLDOS1/ ./ 0/ 的/ 攻击/ 说明/ 1/ 获得/ 活动/ 主机/ 列表/ ;/ 2/ 找到/ 薄弱/ soliar/ 主机/ ;/ 3/ 由/ sadmind/ 缓冲区/ 溢出/ 漏洞/ 侵入/ 系统/ ;/ 10/ :/ 33/ :/ 1010/ :/ 35/ :/ 01225354/ 在/ 控制/ 主/ 机上安装/ DDOS/ 攻击/ 木马/ ;/ 5/ 由/ 控制/ 主机/ 攻击/ 远程/ 服务器/ ;/ 总计/ LLDOS1/ ./ 0/ 所有/ 数据流/ 设定/ 采样/ 周期/ Δ/ t/ 为/ 5min/ ,/ 在/ 每个/ 采样/ 周期/ 内/ ,/ 从/ snort/ 产生/ 的/ 警报/ 流中/ 选取/ 质量/ 最高/ 的/ 警报/ 作为/ 观测/ 向量/ ./ 获取/ 的/ 观测/ 序列/ 如/ 附表/ 1/ 所示/ ./ LLDOS1/ ./ 0/ 作为/ 一个/ 网络流量/ 的/ 基准/ 评测/ 数据/ 集/ ,/ 并/ 不/ 提供/ 网络/ 防护/ 措施/ 的/ 说明/ ,/ 依据/ 对/ 安全事件/ 及/ 警报/ 信息/ 的/ 分析/ [/ 19/ ]/ ,/ 分别/ 构建/ 各/ 状态/ 的/ 犈/ ×/ 犇/ 矩阵/ ,/ 其中/ 安全/ 状态/ G/ 的/ 犈/ ×/ 犇/ 矩阵/ 如表/ 4/ ./ 安全事件/ / EREBEC5/ ./ Endfor6/ ./ Else7/ ./ Fori/ =/ 1toNdo8/ ./ α/ t/ (/ i/ )/ =/ qi/ (/ Ot/ )/ ∑/ N9/ ./ λ/ t/ (/ i/ )/ =/ α/ t/ (/ i/ )/ 10/ ./ Endfor/ 利用/ 该/ 算法/ 可/ 实时/ 更新/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ λ/ t/ (/ i/ )/ ,/ 结合/ 风险/ 损失/ 向量/ 犆/ (/ i/ )/ ,/ 即可/ 求解/ 网络安全/ 风险/ 值/ RT4/ 实验/ 验证/ 为了/ 验证/ 方法/ 的/ 有效性/ ,/ 采用/ 林肯/ 实验室/ 提供/ 的/ 经典/ 数据源/ LLDOS1/ ./ 0/ ①/ 进行/ 验证/ ./ LLDOS1/ ./ 0/ 是/ 一个/ DDOS/ 攻击/ 场景/ 测试/ 集/ ,/ 提供/ 了/ DDOS/ 攻击/ 的/ 网络流量/ ./ 攻击/ 场景/ 分为/ 5/ 个/ 阶段/ ,/ 每个/ 阶段/ 的/ 安全事件/ 导致/ 网络/ 处于/ 不同/ 的/ 安全/ 状态/ ./ 根据/ 说明/ 文档/ ,/ 各/ 阶段/ 的/ 信息/ 如表/ 3/ 所示/ ./ 为了/ 再现/ 攻击/ 场景/ ,/ 采用/ 流量/ 重/ 放/ 技术/ ,/ 将/ 原始/ 流量/ 导向/ snort/ ,/ 由/ 其/ 充当/ 采集器/ 对/ 数据/ 进行/ 分析/ ./ 采集/ 信息/ 见表/ 3/ 最/ 右侧/ ,/ 相对/ 于/ 攻击/ 说明/ 文档/ ,/ 各/ 阶段/ 的/ 警报/ 数目/ 略有/ 差别/ ,/ 主要/ 是/ 由于/ 不同/ 的/ snort/ 规则/ 集/ 导致/ 的/ ,/ 但/ 警报/ 数目/ 总体/ 趋势/ 是/ 一致/ 的/ ,/ 且/ 所有/ 算法/ 均/ 采用/ 相同/ 数据/ 集/ ,/ 并/ 不/ 影响/ 实验/ 结果/ ./ 根据/ 犈/ ×/ 犇/ 矩阵/ 求解/ 状态/ 转移/ 的/ 概率分布/ ,/ 确定/ 状态/ 转移/ 矩阵/ 如下/ :/ 犘/ =/ ①/ LincolnLaboratory/ ./ Lincolnlaboratoryscenario/ (/ DDoS/ )/ Page7/ 修正/ 后/ 的/ 状态/ 转移/ 矩阵/ :/ 犘/ =/ 为了/ 保证/ 与/ ?/ rnes/ 方法/ 的/ 可比性/ ,/ 采用/ 与/ ?/ rnes/ 方法/ 相同/ 的/ 观测/ 向量/ 概率分布/ 矩阵/ 犙/ ,/ 初始状态/ 概率分布/ 矩阵/ π/ 及/ 风险/ 损失/ 向量/ 犆/ (/ i/ )/ ./ 犙/ =/ =/ π/ =/ π/ G/ π/ R/ π/ B/ π/ C/ =/ 1000/ 犮/ =/ cGcRcBcC/ =/ 02550100/ 确定/ 观测/ 序列/ Ot/ 和/ 模型/ 参数/ λ/ =/ {/ S/ ,/ V/ ,/ P/ ,/ Q/ ,/ π/ }/ 图/ 5/ 各/ 算法/ 状态/ 概率分布/ 图/ 之后/ ,/ 采用/ 算法/ 1/ 实时/ 更新/ 网络/ 在/ T/ 时刻/ 处于/ 状态/ Si/ 的/ 概率/ λ/ t/ (/ i/ )/ ,/ 实验/ 结果/ 如图/ 5/ 所示/ ./ 图/ 5/ (/ a/ )/ 改进/ 算法/ 生成/ 的/ 状态/ 概率/ 表明/ 在/ 1200s/ 之前/ 及/ 9600s/ 之后/ ,/ 网络/ 处于/ 安全/ 状态/ ;/ 在/ 1200s/ ~/ 4200s/ 之间/ 网络/ 处于/ 探测/ 状态/ ;/ 4200s/ ~/ 9600s/ 之间/ 网络/ 处于/ 入侵/ 状态/ ./ 图/ 5/ (/ b/ )/ ?/ rnes/ 算法/ 生成/ 的/ 状态/ 概率/ 表明/ 在/ 900s/ 之前/ ,/ 网络/ 处于/ 安全/ 状态/ ,/ 其余/ 时段/ 网络/ 处于/ 探测/ 状态/ ./ 图/ 5/ (/ c/ )/ Haslum/ 算法/ 生成/ 的/ 状态/ 概率/ 表明/ 网络/ 交替/ 处于/ 探测/ 状态/ 和/ 安全/ 状态/ ./ 图/ 5/ (/ d/ )/ 遗传算法/ 生成/ 的/ 状态/ 概率/ 值/ 具有/ 均衡/ 趋势/ ,/ 无/ 明显/ 优势/ 状态/ ./ 上述/ 分析表明/ ,/ 改进/ 算法/ 生成/ 的/ 状态/ 概率/ 与/ 攻击/ 场景/ 的/ 描述/ 基本一致/ ./ 为/ 量化/ 评估/ 网络/ 的/ 安全/ 态势/ ,/ 结合/ 风险/ 损失/ 向量/ 犆/ (/ i/ )/ ,/ 可/ 求解/ T/ 时刻/ 各/ 算法/ 生成/ 的/ 网络/ 风险/ 值/ RT/ ,/ 结果/ 如图/ 6/ 所示/ ./ 图/ 6/ 表明/ 改进/ 算法/ 在/ 攻击/ 入侵/ 阶段/ 生成/ 的/ 网络/ 风险/ 值/ 明显/ 高于/ 探测/ 阶段/ 的/ 风险/ 值/ ,/ 且/ 在/ 5400s/ 出现/ 小/ 波峰/ ,/ 表明/ 攻击行为/ 异常/ ;/ ?/ rnes/ 算法/ 由于/ 一直/ 处于/ 探测/ 状态/ ,/ 其/ 产生/ 的/ 网络/ 风险/ 值/ 维持/ 在/ 50/ 左右/ ;/ Haslum/ 算法/ 由于/ 交替/ 处于/ 探测/ 状态/ 和/ 安全/ 状态/ ,/ 其/ 产生/ 的/ 网络/ 风险/ 值/ 亦/ 处于/ 波动/ 状态/ ;/ 遗传算法/ 生成/ 的/ 网络/ 风险/ 值/ 无/ 明显/ 变化趋势/ ./ 上述/ 分析表明/ ,/ 基于/ 改进/ 算法/ 生成/ 的/ 风险/ 值/ 对/ 网络安全/ 态势/ 的/ 量化/ 更加/ 合理/ ./ Page85/ 讨论/ (/ 1/ )/ 改进/ 算法/ 对于/ 网络安全/ 状态/ 变化趋势/ 的/ 判定/ 与/ 攻击/ 场景/ 的/ 描述/ 基本一致/ ,/ 表明/ 改进/ 算法/ 可以/ 较/ 准确/ 地/ 评估/ 网络安全/ 状态/ 的/ 变化趋势/ ./ (/ 2/ )/ ?/ rnes/ 算法/ 可/ 准确/ 判定/ 网络/ 的/ 探测/ 状态/ ,/ 但/ 同时/ 将/ 入侵/ 行为/ 判定/ 为/ 探测/ 状态/ ,/ 这/ 主要/ 是因为/ ?/ rnes/ 算法/ 的/ 观测/ 序列/ Ot/ 是/ 随机/ 采样/ 获取/ ,/ Ot/ 不能/ 有效/ 表征/ 网络/ 的/ 真实/ 状况/ ,/ 影响/ 算法/ 准确性/ ./ (/ 3/ )/ Haslum/ 算法/ 采用/ 的/ 状态/ 转移/ 矩阵/ 中/ 56/ %/ 的/ 转移/ 概率/ 值为/ 零值/ ,/ 而且/ 非零值/ 中/ 采用/ 互补/ 方式/ 描述/ 反向/ 的/ 状态/ 转移/ ,/ 即/ 整个/ 状态/ 转移/ 矩阵/ 仅/ 有/ 3/ 个/ 有效值/ ,/ 使得/ 生成/ 的/ 状态/ 概率/ 值/ 存在/ 误差/ ./ 不合理/ 的/ 状态/ 转移/ 矩阵/ 影响/ Haslum/ 算法/ 的/ 准确性/ ./ (/ 4/ )/ 遗传算法/ 根据/ 警报/ 的/ 严重/ 程度/ ,/ 将/ 警报/ 划分/ 为/ 10/ 个/ 等级/ ,/ 即/ 算法/ 中/ 观测/ 向/ 量值/ 为/ 10/ ./ 细化/ 的/ 观测/ 向量/ 使得/ 算法/ 过于/ 敏感/ ,/ 导致/ 生成/ 的/ 状态/ 概率/ 值/ 波动/ 频繁/ ,/ 无法/ 判定/ 网络/ 的/ 变化趋势/ ./ (/ 5/ )/ 根据/ 攻击/ 场景/ 描述/ ,/ 5400s/ 时/ ,/ 攻击者/ 获得/ 了/ 控制/ 主机/ 上/ 的/ 系统/ 权限/ ,/ 网络/ 应/ 处于/ 被/ 攻陷/ 状态/ ./ 但图/ 5/ 中/ 各/ 算法/ 对于/ 攻陷/ 状态/ 的/ 表征/ 均/ 不/ 明显/ ./ 各/ 算法/ 生成/ 的/ 攻陷/ 状态/ 概率/ 值/ 的/ 分布/ 情况/ 如图/ 7/ 所示/ ./ 图/ 7/ 表明/ 改进/ 算法/ 生成/ 的/ 攻陷/ 状态/ 概率/ 值/ 一直/ 处于/ 0.001/ 的/ 极小值/ ,/ 但是/ 在/ 5400s/ 时/ ,/ 出现/ 了/ 小幅/ 波动/ ,/ 达到/ 了/ 0.14/ ./ ?/ rnes/ 算法/ 生成/ 的/ 攻陷/ 状态/ 概率/ 值/ 一直/ 维持/ 在/ 0.003/ ./ Haslum/ 算法/ 在/ 6300s/ ,/ 7500s/ 以及/ 11100s/ 出现/ 了/ 0.8/ 的/ 高/ 概率/ 值/ ./ 遗传算法/ 在/ 多点/ 出现/ 了/ 0.5/ 左右/ 的/ 高/ 概率/ 值/ ,/ 但/ 根据/ 攻击/ 场景/ 描述/ ,/ 这些/ 点/ 并/ 没有/ 出现/ 高/ 危险/ 级别/ 安全事件/ ./ 分析表明/ ,/ 改进/ 算法/ 体现/ 了/ 攻陷/ 状态/ 的/ 变化/ ,/ 但/ 不/ 明显/ ./ 5400s/ 时/ ,/ 各/ 算法/ 生成/ 的/ 状态/ 概率/ 值如图/ 8/ 所示/ ./ 图/ 8/ 表明/ 5400s/ 时/ ,/ 虽然/ 改进/ 算法/ 攻陷/ 状态/ 的/ 概率/ 值/ 提升/ 到/ 0.14/ ,/ 但/ 入侵/ 状态/ 的/ 概率/ 值为/ 0.82/ ,/ 远高于/ 攻陷/ 状态/ 的/ 概率/ 值/ ,/ 所以/ 网络/ 处于/ 入侵/ 状态/ ,/ 与/ 攻击/ 场景/ 描述/ 的/ 网络/ 处于/ 攻陷/ 状态/ 出现/ 不/ 一致/ ./ 因为/ T/ 时刻/ 网络/ 处于/ 状态/ Si/ 的/ 概率/ 是/ 由/ 所有/ 可能/ 到达/ 该/ 状态/ 的/ 路径/ 之/ 和/ 表示/ ,/ 它/ 不仅/ 与/ T/ 时刻/ 的/ 观测/ 向量/ 有关/ ,/ 还/ 与/ 隐含/ 了/ T/ -/ 1/ 时刻/ 之前/ 观测/ 序列/ 信息/ 的/ 部分/ 概率/ α/ t/ -/ 1/ (/ i/ )/ 相关/ ./ 在/ 5400s/ 之前/ ,/ 网络/ 中/ 没有/ 出现/ 过/ 攻陷/ 警报/ ,/ 当/ 第一次/ 出现/ 攻陷/ 警报/ 时/ ,/ 算法/ 对/ 攻陷/ 状态/ 的/ 概率/ 值/ 有所/ 提升/ ,/ 但/ 由于/ 累积/ 效应/ ,/ 并/ 不是/ 最大/ 的/ 状态/ 概率/ 值/ ./ 所以/ 改进/ 算法/ 体现/ 了/ 攻陷/ 状态/ 的/ 变化/ ,/ 但/ 不/ 明显/ ./ 6/ 结束语/ 本文/ 对/ ?/ rnes/ 提出/ 的/ 基于/ 隐/ 马尔可夫/ 过程/ 的/ 网络安全/ 态势/ 评估/ 模型/ 进行/ 了/ 改进/ ,/ 主要/ 工作/ 有/ 两点/ :/ 第一/ ,/ 基于/ 警报/ 统计/ 特性/ 提出/ 警报/ 质量/ 的/ 概念/ ,/ 依据/ 警报/ 质量/ 获取/ 的/ 观测/ 向量/ ,/ 可/ 改进/ 数据源/ 的/ 有效性/ ;/ 第二/ ,/ 基于/ 安全事件/ 和/ 防护/ 措施/ 的/ 博弈/ 过程/ ,/ 提出/ 确定/ 状态/ 转移/ 矩阵/ 的/ 方法/ ,/ 并/ 结合/ 攻击/ 成功/ 的/ 概率/ 对/ 其/ 进行/ 修正/ ,/ 提高/ 转移/ 矩阵/ 的/ 有效性/ ./ 对比/ 实验/ 证明/ ,/ 基于/ 改进/ 算法/ 生成/ 的/ 风险/ 值/ 对/ 网络安全/ 态势/ 的/ 量化/ 更加/ 合理/ ./ 但/ 该/ 方法/ 还/ 存在/ 局限性/ ,/ 例如/ 现在/ 的/ 数据源/ 主要/ 是/ 基于/ 入侵/ 检测/ 系统/ 产生/ 的/ 警报/ 信/ Page9/ 息/ ,/ 如果/ 可以/ 采集/ 更/ 多/ 的/ 信息/ 完善/ 观测/ 序列/ ,/ 则/ 可/ 进一步提高/ 方法/ 的/ 准确性/ ;/ 另外/ 目前/ 算法/ 求解/ 的/ 只是/ 下/ 一个/ 采样/ 周期/ 各/ 安全/ 状态/ 的/ 概率/ ,/ 如果/ 可/ 实现/ 对/ 未来/ 多个/ 采样/ 周期/ 内/ 安全/ 状态/ 出现/ 概率/ 的/ 求解/ ,/ 则/ 可以/ 实现/ 对/ 网络安全/ 状态/ 的/ 预测/ ,/ 为/ 网络管理员/ 提供/ 决策依据/ ./ 因此/ 下/ 一步/ 工作/ 主要/ 集中/ 在/ 这/ 两个/ 方向/ ./ 

