Page1/ 基于/ 特征/ 学习/ 的/ 广告/ 点击率/ 预估/ 技术/ 研究/ 张志强/ 周永谢晓芹/ 潘海为/ (/ 哈尔滨工程大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 摘要/ 搜索/ 广告/ 中/ 的/ 点击率/ 预估/ 问题/ 在/ 信息检索/ 和/ 机器/ 学习/ 等/ 领域/ 一直/ 是/ 研究/ 的/ 热点/ ./ 目前/ 通过/ 设计/ 特征提取/ 方案/ 获得/ 特征/ 和/ 针对/ 用户/ 点击/ 行为/ 建模/ 等/ 方法/ ,/ 并/ 没有/ 充分考虑/ 广告/ 数据/ 具有/ 的/ 高维/ 稀疏/ 性/ 、/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ 的/ 特点/ ,/ 致使/ 信息/ 利用/ 不/ 充分/ ./ 为了/ 降低/ 数据/ 稀疏/ 性/ 和/ 充分/ 挖掘/ 广告/ 数据/ 中/ 隐藏/ 的/ 规律/ ,/ 该文/ 提出/ 了/ 面向/ 广告/ 数据/ 的/ 稀疏/ 特征/ 学习/ 方法/ ./ 该/ 方法/ 基于/ 张量/ 分解/ 实现/ 特征/ 降维/ ,/ 并/ 充分利用/ 深度/ 学习/ 技术/ 刻画/ 数据/ 中/ 的/ 非线性/ 关联/ ,/ 以/ 解决/ 高维/ 稀疏/ 广告/ 数据/ 的/ 特征/ 学习/ 问题/ ,/ 实验/ 结果/ 验证/ 了/ 文中/ 提出/ 的/ 方法/ 能够/ 有效/ 地/ 提升/ 广告/ 点击率/ 的/ 预估/ 精度/ ,/ 达到/ 了/ 预期/ 效果/ ./ 关键词/ 搜索/ 广告/ ;/ 点击率/ ;/ 张量/ 分解/ ;/ 深度/ 学习/ ;/ 社交/ 网络/ ;/ 社会/ 媒体/ ;/ 计算/ 广告学/ 1/ 引言/ 搜索/ 广告/ 又称/ 赞助商/ 搜索/ (/ SponsoredSearch/ )/ ,/ Page2/ 费/ ./ 点击率/ (/ ClickThroughRate/ ,/ CTR/ )/ 是/ 指/ 用户/ 点击/ 广告/ 的/ 概率/ ,/ 点击率/ 预估/ 是/ 根据/ 给定/ 的/ 〈/ 查询/ ,/ 广告/ 〉/ 信息/ 以及/ 上下文/ 环境/ 信息/ 等/ ,/ 预估/ 用户/ 点击/ 广告/ 的/ 概率/ ./ 随着/ 在线/ 推广/ 技术/ 的/ 发展/ ,/ 广告/ 由/ 过去/ “/ 粗放式/ ”/ 投放/ 正在/ 向/ “/ 精准/ 化/ ”/ 投放/ 转变/ ,/ 以/ 数据/ 驱动/ 的/ 广告/ 精准/ 投放/ 已/ 成为/ 在线/ 推广/ 的/ 主流/ 趋势/ ./ 在/ 广告/ 需求方/ 平台/ (/ DemandSidePlatform/ ,/ DSP/ )/ 的/ 程序化/ 购买/ 和/ 搜索/ 广告投放/ 的/ 过程/ 中/ ,/ 都/ 需要/ 评估/ 用户/ 对/ 广告/ 的/ 偏好/ 程度/ ,/ 而/ 衡量/ 这一/ 偏好/ 程度/ 的/ 重要/ 指标/ 就是/ 广告/ 的/ 点击率/ [/ 1/ -/ 2/ ]/ ./ 搜索/ 广告/ 展现/ 过程/ 与/ 网页/ 搜索/ 结果/ 展现/ 过程/ 十分/ 类似/ ,/ 包括/ 查询/ 分析/ ,/ 广告/ 检索/ ,/ 广告/ 排序/ 等/ 阶段/ ./ 其中/ 在/ 广告/ 排序/ 阶段/ ,/ 目前/ 相对/ 成熟/ 的/ 搜索/ 广告/ 系统/ 采用/ 的/ 排序/ 规则/ 是/ 按照/ 广告/ 预期/ 收益/ 进行/ 排序/ ,/ 预期/ 收益/ 等于/ 广告/ 质量/ 度/ 与/ 广告/ 竞价/ 的/ 乘积/ ,/ 其中/ ,/ 广告/ 点击率/ 是/ 广告/ 质量/ 度/ 最/ 重要/ 的/ 衡量/ 指标/ ./ 广告/ 预期/ 收益/ [/ 3/ ]/ 可以/ 简写/ 为式/ (/ 1/ )/ 形式/ :/ Pad/ (/ click/ )/ 指/ 广告/ 的/ 预估/ 点击率/ ,/ CPCad/ 表示/ 发生/ 一次/ 点击/ 行为/ 时/ ,/ 搜索引擎/ 的/ 收益/ ./ 也就是说/ ,/ 点击率/ 预估/ 是/ 广告/ 排序/ 阶段/ 的/ 核心技术/ ,/ 直接/ 影响/ 搜索引擎/ 的/ 收益/ 和/ 用户/ 体验/ ,/ 并且/ 预估/ 点击率/ 对/ 广告/ 的/ 后续/ 投放/ 具有/ 非常/ 重要/ 的/ 指导意义/ ./ 本文/ 的/ 主要/ 贡献/ 在于/ ,/ 针对/ 广告/ 数据/ 呈现/ 的/ 高维/ 稀疏/ 性/ 和/ 特征/ 之间/ 存在/ 着/ 高度/ 非线性/ 关联/ 的/ 特点/ ,/ 从/ 特征/ 学习/ 的/ 角度/ 出发/ 提出/ 了/ 面向/ 广告/ 数据/ 的/ 稀疏/ 特征/ 学习/ 方法/ ;/ 在/ 数据/ 降/ 维和/ 特征/ 之间/ 非线性/ 关联/ 深度/ 学习/ 方面/ 进行/ 了/ 有/ 意义/ 的/ 探索/ ;/ 同时/ ,/ 通过/ 大量/ 的/ 实验/ 与/ 相/ 类似/ 方法/ 进行/ 了/ 详细/ 的/ 比较/ 分析/ ,/ 证明/ 了/ 本文/ 方法/ 的/ 有效性/ ./ 本文/ 第/ 1/ 节/ 介绍/ 研究/ 问题/ 的/ 背景/ ;/ 第/ 2/ 节/ 简要/ 概括/ 搜索/ 广告/ 点击率/ 预估/ 的/ 相关/ 工作/ 以及/ 存在/ 的/ 问题/ ;/ 第/ 3/ 节是/ 本文/ 的/ 核心内容/ ,/ 根据/ 当前/ 研究/ 工作/ 存在/ 的/ 问题/ 和/ 广告/ 数据/ 自身/ 的/ 特点/ ,/ 提出/ 面向/ 广告/ 数据/ 的/ 稀疏/ 特征/ 学习/ 方法/ ,/ 并/ 描述/ 算法/ 思想/ 和/ 具体/ 过程/ ;/ 第/ 4/ 节/ 给出/ 实验/ 方案设计/ ,/ 通过/ 对比/ 实验/ 验证/ 本文/ 提出/ 方法/ 的/ 预估/ 效果/ ;/ 第/ 5/ 节/ 总结/ 全文/ 工作/ ,/ 并/ 指出/ 存在/ 的/ 不足之处/ ,/ 对/ 将来/ 的/ 工作/ 方向/ 进行/ 讨论/ ./ 2/ 广告/ 点击率/ 预估/ 点击率/ 预估/ 一直/ 是/ 信息检索/ 和/ 机器/ 学习/ 等/ 领域/ 的/ 热点问题/ ./ 最初/ 的/ 研究/ 是/ 用来/ 预估/ 查询/ 关键词/ 与/ 文档/ 之间/ 的/ 真实/ 相关性/ [/ 4/ -/ 5/ ]/ ,/ 建立/ 预估/ 模型/ 消除/ 点击/ 数据/ 中/ 的/ 各种/ 偏倚/ 因素/ ,/ 如/ 页面/ 上下文/ 环境/ 偏倚/ 、/ 广告/ 位置/ 偏倚/ 、/ 用户/ 信息/ 偏倚/ 等/ ,/ 以/ 获得/ 查询/ 与/ 文档/ 的/ 真实/ 相关性/ ./ 后来/ 将/ 该/ 研究/ 应用/ 在/ 排序/ 结果/ 的/ 优化/ 和/ 点击/ 预估/ 等/ 方面/ ./ 在/ 排序/ 结果/ 优化/ 方面/ ,/ 通常/ 将/ 从/ 点击/ 预估/ 模型/ 中/ 得到/ 的/ 真实/ 相关性/ 作为/ 新/ 特征/ 加入/ 到/ 排序/ 算法/ 中/ ,/ 之后/ 借助/ A/ // Btest/ 方法/ 来/ 检验/ 新/ 特征/ 对/ 算法/ 排序/ 能力/ 的/ 影响/ 效果/ [/ 6/ ]/ ./ 例如/ Dupret/ 等/ 人/ [/ 7/ ]/ 使用/ 这种/ 方式/ 训练/ 模型/ ,/ 实验/ 表明/ 该/ 方法/ 能/ 有效/ 提升/ 结果/ 排序/ 的/ 质量/ ./ 在/ 点击/ 预估/ 方面/ ,/ 点击/ 模型/ 通常/ 用来/ 预估/ 一个/ 查询/ 会话/ 中/ 各个/ 文档/ 的/ 点击/ 概率/ 或/ 一次/ 会话/ 中/ 点击/ 序列/ 的/ 概率/ ./ 通过/ 模型/ 预估/ 返回/ 列表/ 中/ 各个/ 文档/ 的/ 点击/ 概率/ ,/ 有助于/ 排序/ 算法/ 调整/ 返回/ 的/ 文档/ 顺序/ ,/ 使/ 用户/ 点击/ 文档/ 的/ 概率/ 最大化/ ./ 这方面/ 已有/ 许多/ 研究成果/ ,/ 如/ 点击/ 链/ 模型/ [/ 8/ ]/ 和/ 动态/ 贝叶斯/ 网络/ 模型/ [/ 9/ ]/ 等/ ./ 2.1/ 相关/ 工作/ 本文/ 的/ 核心/ 为/ 点击率/ 预估/ 模型/ ,/ 因此/ 我们/ 将/ 从/ 特征/ 学习/ 、/ 用户/ 行为/ 和/ 数据/ 特点/ 等/ 3/ 个/ 角度/ 来/ 分别/ 介绍/ 点击率/ 预估/ 方面/ 的/ 相关/ 研究/ 工作/ ./ (/ 1/ )/ 特征/ 学习/ ./ 影响/ 点击率/ 的/ 特征/ 很多/ ,/ 并/ 不是/ 考虑/ 的/ 特征/ 越/ 多/ ,/ 效果/ 就/ 会/ 越/ 好/ ./ 在/ 实际/ 中/ 往往/ 要/ 在/ 精度/ 与/ 效益/ 方面/ 进行/ 权衡/ ./ 因此/ ,/ 需要/ 尽可能/ 获取/ 与/ 点击率/ 高度/ 相关/ 的/ 特征/ ,/ 以/ 提高/ 点击率/ 预估/ 的/ 准确率/ ./ 当前/ 影响/ CTR/ 预估/ 最/ 主要/ 的/ 特征/ 是/ 位置/ 和/ 相关性/ ./ 位置/ 决定/ 了/ 广告/ 的/ 曝光/ 程度/ ,/ Zhang/ 和/ Jones/ [/ 10/ ]/ 考察/ 了/ 原始/ 查询/ 和/ 重写/ 后/ 的/ 查询/ 之间/ 的/ 相关性/ 与/ 广告/ 点击率/ 之间/ 的/ 关系/ ,/ 目的/ 是/ 提升/ 查询/ 重写/ 的/ 质量/ ,/ 从而/ 提高/ 广告/ 的/ 点击率/ ./ 虽然/ 其/ 实际/ 工作/ 重点/ 没有/ 放到/ 广告/ 点击率/ 预估/ 上面/ ,/ 但是/ 该/ 工作/ 考察/ 了/ 一些/ 特征/ 对/ 广告/ 点击率/ 的/ 影响/ ,/ 如/ 次序/ (/ Rank/ )/ 、/ 长度/ 差异/ (/ LengthDifference/ )/ 、/ 编辑/ 距离/ (/ EditDistance/ )/ 等/ ./ 文献/ [/ 3/ ,/ 8/ ]/ 将/ 位置/ 因素/ 和/ 广告/ 查询/ 相关性/ 作为/ 特征/ ,/ 同时/ 考虑/ 了/ 根据/ 相同/ 或/ 相似/ 项/ (/ Term/ )/ 的/ 已知/ 广告/ 来/ 解决/ 稀疏/ 广告/ 或/ 新/ 广告/ 的/ 点击率/ 预估/ 问题/ ./ 文献/ [/ 11/ ]/ 综合/ 了/ 协同/ 过滤/ ,/ 贝叶斯/ 网络/ 和/ 特征/ 工程/ 等/ 模型/ 来/ 预测/ 点击率/ ./ 该/ 工作/ 本质/ 上/ 是/ 一种/ 对/ 多种/ 模型/ 的/ 组合式/ 运用/ ,/ 而/ 非/ 单一/ 的/ 预估/ 模型/ ./ 鉴于/ 实际/ 中/ “/ 查询/ -/ 文档/ ”/ 相关性/ 模型/ 并非/ 对/ 所有/ 用户/ 都/ 是/ 一致/ 的/ ,/ 有/ 很多/ 被/ 不同/ 用户/ 提交/ 的/ 相似/ 查询/ 往往/ 导致/ 不同/ 的/ 信息/ 需求/ ,/ 因此/ 文献/ [/ 12/ ]/ 考虑/ 了/ 用户/ 个性化/ 信息/ ,/ 提出/ 了/ 基于/ 协同/ 过滤/ 和/ 张量/ 分解/ 来/ 提取/ 个性化/ 特征/ ./ Hu/ 等/ 人/ [/ 13/ ]/ 结合/ 用户/ 查询/ 意图/ ,/ 认为/ 影响/ 点击/ Page3/ 率/ 预估/ 的/ 因素/ 不仅/ 受到/ 位置/ 和/ 文档/ 因素/ 的/ 影响/ ,/ 还/ 受到/ 用户/ 查询/ 的/ 真正/ 意图/ 与/ 实际/ 查询/ 语句/ 之间/ 偏差/ 的/ 影响/ ,/ 作者/ 利用/ 贝叶斯/ 方法/ 基于/ 意图/ 假设/ 进行/ 建模/ ./ 另外/ 一些/ 研究/ 人员/ 通过/ 构造/ 同一/ 页面/ 广告/ 之间/ 的/ 相关性/ 特征/ 、/ 广告/ 与/ 自然/ 结果/ 的/ 相关性/ 特征/ 并/ 融入/ 点击/ 预估/ 模型/ ,/ 来/ 提高/ 点击率/ 预估/ 的/ 准确率/ ./ (/ 2/ )/ 用户/ 行为/ 建模/ ./ 通过/ 假设检验/ ,/ 借助/ 贝叶斯/ 网络/ 刻画/ 用户/ 浏览/ 场景/ ,/ 进而/ 估计/ 出/ 用户/ 点击/ 广告/ 的/ 概率/ ./ 对/ 用户/ 行为/ 建模/ 通常/ 是/ 基于/ 一个/ 前提/ 假设/ ,/ 即/ 搜索/ 结果/ 返回/ 列表/ 中/ 的/ 任意/ 一个/ 文档/ ,/ 只有/ 先/ 被/ 查阅/ 到/ ,/ 用户/ 才/ 有/ 可能/ 发生/ 点击/ 行为/ ,/ 如果/ 文档/ 没有/ 被/ 查阅/ 到/ ,/ 则/ 一定/ 不会/ 被/ 点击/ ./ Taylor/ 等/ 人/ [/ 14/ ]/ 基于/ 这种/ 最/ 简单/ 的/ 浏览/ 行为/ 假设/ 提出/ 级联/ 模型/ ./ 进一步/ 考虑/ ,/ 如果/ 用户/ 点击/ 一个/ 文档/ 后/ ,/ 该/ 文档/ 不能/ 满足用户/ 的/ 查询/ 需求/ ,/ 则/ 用户/ 可能/ 仍会/ 向/ 后/ 检视/ 搜索/ 结果/ 并/ 有/ 可能/ 发生/ 点击/ 行为/ ,/ 因此/ Guo/ 等/ 人/ [/ 15/ ]/ 对/ 级联/ 模型/ 的/ 假设/ 做/ 了/ 扩展/ ,/ 扩展/ 至/ 多次/ 点击/ ./ 多次/ 点击/ 是/ 指/ 用户/ 点击/ 一个/ 文档/ 后/ ,/ 仍/ 可能/ 浏览/ 后续/ 文档/ 并/ 计算/ 下/ 一个/ 位置/ 文档/ 点击/ 发生/ 的/ 概率/ ./ 点击/ 链/ 模型/ [/ 7/ ]/ 是/ 针对/ 用户/ 与/ 搜索/ 结果/ 交互/ 行为/ 而/ 建模/ 的/ 生成/ 模型/ ,/ 被/ 点击/ 文档/ di/ 的/ 相关性/ 影响/ 继续/ 浏览/ 的/ 可能性/ ,/ 被/ 点击/ 文档/ di/ 的/ 相关性/ 越大/ ,/ 则/ 继续/ 浏览/ 下/ 一/ 文档/ di/ +/ 1/ 的/ 可能性/ 就/ 越/ 小/ ,/ 这/ 说明/ 相关性/ 越大/ 的/ 文档/ 越能/ 满足用户/ 的/ 查询/ 意图/ ./ 动态/ 贝叶斯/ 网络/ 模型/ [/ 8/ ]/ 的/ 建模/ 过程/ 中/ ,/ 引入/ 了/ 两个/ 文档/ 相关性/ 变量/ ,/ 即/ 观察/ 相关性/ (/ perceivedrelevance/ )/ 和/ 实际/ 相关性/ (/ actualrelevance/ )/ ./ 观察/ 相关性/ 用来/ 衡量/ 用户/ 点击/ 广告/ 链接/ (/ URL/ )/ 的/ 概率/ ;/ 实际/ 相关性/ 用来/ 衡量/ 用户/ 进入/ 广告/ 链接/ 后/ ,/ 该/ 搜索/ 结果/ 的/ 真实/ 满意度/ ./ 用户/ 浏览/ 模型/ [/ 4/ ]/ 认为/ 用户/ 点击/ 下/ 一个/ 位置/ 文档/ 的/ 概率/ 跟/ 上次/ 点击/ 位置/ 的/ 距离/ 有关/ ,/ 同时/ 也/ 与/ 当前/ 文档/ 的/ 位置/ 有关/ ,/ 引入/ 距离/ 变量/ 是因为/ 当/ 用户/ 浏览/ 了/ 一系列/ 不/ 相关/ 文档/ 后/ ,/ 则/ 倾向/ 于/ 放弃/ 此次/ 搜索/ 结果/ ./ (/ 3/ )/ 数据/ 稀疏/ 性/ 特点/ ./ 从/ 广告/ 数据/ 稀疏/ 性/ 特点/ 出发/ ,/ 研究/ 广告/ 点击率/ 预估/ 问题/ ./ Richardson/ 等/ 人/ [/ 10/ ]/ 利用/ 包含/ 稀疏/ 广告/ 相同/ 或/ 相似/ 项/ 的/ 已知/ 广告/ 来/ 预估/ 其/ 点击率/ ./ CTR/ 预估/ 中/ 最大/ 的/ 挑战/ 之一/ 就是/ 信息/ 的/ 缺失/ ,/ 尤其/ 对于/ 新/ 广告/ 而言/ ,/ 历史/ 展示/ 数据/ 信息/ 过少/ ,/ 无法/ 给/ 点击/ 预估/ 模型/ 提供/ 预估/ 基准/ ./ 因此/ ,/ 针对/ 广告/ 数据/ 的/ 特点/ ,/ Rain/ 等/ 人/ [/ 16/ ]/ 基于/ “/ 竞拍/ 词/ -/ 广告主/ ”/ 矩阵/ ,/ 提出/ 了/ 层次/ 聚类/ 的/ 方法/ 解决/ 历史数据/ 不/ 充分/ 的/ 广告/ CTR/ 预估/ 问题/ ./ Agarwal/ 等/ 人/ [/ 17/ ]/ 从/ 建模/ 的/ 角度/ 设计/ 适应/ 稀疏/ 广告/ 或/ 新/ 广告/ 的/ 点击/ 预估/ 模型/ ,/ 分别/ 提出/ 了/ 基于/ 层级/ 结构/ 的/ 预估/ 模型/ 和/ 基于/ Time/ -/ Spatial/ 的/ 预估/ 模型/ [/ 18/ ]/ ./ 文献/ [/ 19/ ]/ 提出/ 的/ 基于/ 经验/ 贝叶斯/ 的/ 自然/ 数据/ 分层/ 和/ 基于/ 数据/ 一致性/ 的/ 两种/ 平滑/ 计算方法/ 对/ 层级/ 模型/ 做/ 了/ 改进/ ./ 由于/ 不同/ 模型/ 之间/ 的/ 兼容性问题/ ,/ 实际/ 可/ 计算/ 问题/ 和/ 问题/ 自身/ 的/ 复杂性/ ,/ 目前/ 还/ 没有/ 出现/ 一个/ 大一统/ 的/ 模型/ ,/ 能够/ 覆盖/ 所有/ 方面/ ,/ 绝大部分/ 工作/ 都/ 是/ 通过/ 不同/ 角度/ 来/ 考察/ 单一/ 模型/ 的/ 预估/ 效果/ ,/ 本文/ 工作/ 亦/ 属/ 此类/ ./ 文献/ [/ 11/ ]/ 做出/ 了/ 一种/ 有/ 意义/ 的/ 尝试/ ,/ 它/ 通过/ 综合/ 运用/ 多种/ 模型/ 来/ 预测/ 点击率/ ,/ 试图/ 利用/ 不同/ 模型/ 和/ 方法/ 的/ 互补性/ 来/ 实现/ 更/ 高精度/ 的/ 预估/ 结果/ ./ 虽然/ 结果显示/ 这种/ 组合式/ 方法/ 比/ 单一/ 模型/ 好/ ,/ 但/ 该/ 工作/ 只是/ 单纯/ 的/ 从/ 预估/ 效果/ 角度/ 来/ 做/ 调整/ ,/ 并/ 没有/ 对/ 如何/ 组合/ 运用/ 现有/ 模型/ 给出/ 清晰/ 合理/ 的/ 解释/ ,/ 相关/ 做法/ 难于/ 理解/ ./ 该/ 工作/ 只/ 说明/ 了/ 这种/ 方式/ 有效/ ,/ 至于/ 为什么/ 有效/ 及/ 如何/ 更/ 有效/ 没有/ 给出/ 具体/ 理论/ 指导意义/ 的/ 结论/ ./ 对于/ 各种/ 不同/ 模型/ 之间/ 关联/ 问题/ 的/ 研究/ 是/ 个/ 挑战/ ,/ 而/ 该项/ 工作/ 正是/ 我们/ 后续/ 的/ 一个/ 研究课题/ ./ 2.2/ 存在/ 的/ 问题/ 尽管/ 点击率/ 预估/ 方法/ 已经/ 得到/ 了/ 广泛/ 研究/ ,/ 但是/ 仍然/ 存在/ 一些/ 问题/ ./ 目前/ ,/ 通过/ 人工/ 构造/ 特征/ 的/ 方法/ ,/ 存在/ 效率/ 低/ 、/ 可扩展性/ 和/ 性能/ 提升/ 困难/ 的/ 问题/ ./ 而/ 贝叶斯/ 网络/ 刻画/ 用户/ 浏览/ 行为/ ,/ 存在/ 信息/ 利用/ 不/ 充分/ ,/ 并且/ 没有/ 考虑/ 到/ 广告/ 数据/ 具有/ 高度/ 稀疏/ 性/ 、/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ 的/ 本质/ 特点/ ./ 已有/ 的/ 从/ 广告/ 数据/ 特点/ 出发/ 进行/ 点击率/ 预估/ 问题/ 的/ 研究/ 中/ ,/ 仅仅/ 考虑/ 了/ 稀疏/ 广告/ (/ 即/ 展示/ 不/ 充分/ 、/ 统计/ 量/ 不足/ 的/ 广告/ )/ 点击率/ 预估/ 问题/ ,/ 实际上/ 并未/ 从/ 整体/ 角度/ 考虑/ 广告/ 数据/ 的/ 本质/ 特点/ ./ 广告/ 数据/ 具有/ 高维/ 稀疏/ 性/ 特征/ ,/ 高维/ 特征/ 中/ 有效/ 信息/ (/ 非/ 0/ 值/ )/ 的/ 维度/ 很/ 低/ ,/ 其中/ 包含/ 的/ 噪声/ 会/ 对/ 真实/ 信息/ 干扰/ 很大/ ./ 已有/ 的/ 研究成果/ 很少/ 从/ 广告/ 数据/ 的/ 特点/ 考虑/ ,/ 使得/ 大多数/ CTR/ 预估/ 方法/ 无法/ 高效/ 地/ 在/ 高维/ 、/ 高/ 稀疏/ 的/ 广告/ 数据/ 上/ 准确/ 地/ 预估/ 点击率/ ./ 如何/ 解决/ 高维/ 稀疏/ 数据/ 给/ CTR/ 预估/ 准确率/ 带来/ 的/ 影响/ ,/ 是/ 一个/ 值得/ 研究/ 的/ 问题/ ./ 广告/ 数据/ 另/ 一个/ 特点/ 是/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ 关系/ ,/ 复杂度/ 高/ ./ 传统/ 方法/ 采用/ 人工/ 构造/ 组合/ 特征/ (/ 又称/ “/ 人工/ 特征/ 工程/ ”/ )/ 的/ 方式/ ,/ 挖掘/ 特征/ 之间/ 的/ 关联/ ,/ 但是/ 该/ 方式/ 存在/ 效率/ 低/ 、/ 领域/ 知识/ 无法/ 迁移/ 等/ 诸多/ 问题/ ./ 因此/ ,/ 如何/ 在/ 减少/ 人工干预/ 的/ 情况/ 下/ ,/ 通过/ 算法/ 自动/ 挖掘/ 特征/ 之间/ 的/ 关联/ 是/ 文中/ 要/ 研究/ 的/ 重点/ ./ Page43/ 基于/ 特征/ 学习/ 的/ CTR/ 预估/ 方法/ 特征/ 是/ 数据/ 的/ 抽象/ 表示/ 形式/ ,/ 是/ 用于/ 表达/ 数据/ 中/ 隐藏/ 的/ 、/ 且/ 对/ 具体任务/ 有/ 帮助/ 的/ 标签/ 系统/ ./ 从/ 原始/ 广告/ 数据/ 中/ 挖掘/ 与/ 预估/ 任务/ 高度/ 关联/ 的/ 特征/ 是/ 点击率/ 预估/ 系统/ 的/ 关键步骤/ 之一/ ./ 然而/ ,/ 广告/ 数据/ 呈现/ 的/ 高维/ 稀疏/ 性且/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ 的/ 特点/ ,/ 使得/ 已有/ 方法/ 无法/ 高效/ 地/ 进行/ CTR/ 预估/ ./ 因此/ ,/ 本文/ 从/ 如何/ 降低/ 特征/ 的/ 高维/ 稀疏/ 性/ 以及/ 如何/ 刻画/ 特征/ 之间/ 的/ 非线性/ 关联/ 的/ 角度/ 出发/ ,/ 提出/ 了/ 面向/ 广告/ 数据/ 的/ 稀疏/ 特征/ 学习/ 方法/ (/ AdvertisingData/ -/ orientedSparseFeatureLearningMethod/ ,/ ADoSFLM/ )/ ,/ 以/ 解决/ 高维/ 稀疏/ 广告/ 数据/ 的/ 特征/ 学习/ 问题/ ./ 3.1/ 问题/ 描述/ 本文/ 研究/ 的/ 广告/ 点击率/ 预估/ 问题/ 可以/ 描述/ 为/ :/ 给定/ 一个/ 用户/ 查询/ 和/ 其他/ 信息/ (/ 如/ 性别/ 、/ 年龄/ 、/ 地域/ 、/ 兴趣爱好/ 等/ )/ ,/ 经过/ 查询/ 分析/ 、/ 广告/ 检索/ 步骤/ 后/ ,/ 得到/ 一个/ 与/ 查询/ 相关/ 的/ 广告/ 候选/ 集/ ./ 点击率/ 预估/ 系统/ 需要/ 计算/ 用户/ 点击/ 广告/ 候选/ 集中/ 每/ 一则/ 广告/ 的/ 概率/ ,/ 即/ 广告/ 的/ 预估/ 点击率/ ./ 图/ 1/ 中/ 的/ 灰色/ 模块/ 描述/ 了/ 一个/ 广告/ 点击率/ 预估/ 系统/ 的/ 工作/ 流程/ ./ 搜索/ 广告/ 中/ ,/ 广告主/ 通过/ 购买/ 竞拍/ 词/ 的/ 方式/ 设定/ 了/ 广告/ 被/ 触发/ 的/ 场景/ ,/ 广告投放/ 系统/ 根据/ 用户/ 的/ 查询/ 关键词/ ,/ 匹配/ 相应/ 的/ 广告/ ,/ 对/ 广告/ 排序/ 后/ 与/ 自然/ 搜索/ 结果/ 一起/ 返回/ 给/ 用户/ ./ 3.2/ 算法/ 基本/ 思想/ 本文/ 针对/ 广告/ 数据/ 的/ 特点/ 提出/ ADoSFLM/ 方法/ 用于/ 挖掘/ 特征/ 之间/ 的/ 内在/ 关联/ ,/ 获取/ 对/ 数据/ 有/ 更/ 强/ 表达能力/ 的/ 特征/ 集合/ ,/ 进而/ 得到/ 更加/ 精确/ 的/ 点击率/ 预估/ 模型/ ./ 该/ 方法/ 主要/ 包含/ 以下/ 3/ 个/ 环节/ :/ (/ 1/ )/ 数据/ 降维/ ./ 数据/ 降维是/ 解决/ 数据/ 稀疏/ 性/ 的/ 一个/ 有效/ 手段/ ./ 针对/ 广告/ 数据/ 中/ 相同/ 类型/ 对象/ 内部/ 之间/ 存在/ 相似性/ 关系/ ,/ 首先/ 对/ 相似/ 对象/ 进行/ 聚类/ ,/ 获得/ 初始/ 的/ 聚合/ 数据/ ;/ 然后/ ,/ 对于/ 不同/ 类型/ 对象/ 之间/ 存在/ 的/ 复杂/ 关联/ 关系/ ,/ 采用/ 张量/ 结构/ 对/ 其/ 建模/ ,/ 并/ 运用/ 张量/ 分解/ 法/ 得到/ 近似/ 张量/ ./ (/ 2/ )/ 复杂/ 特征/ 学习/ ./ 广告/ 数据/ 的/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ 的/ 特点/ ,/ 而/ 高阶/ 多项式/ 函数/ 可以/ 有效/ 地/ 刻画/ 高度/ 关联/ 关系/ ./ 本文/ 研究/ 并/ 利用/ 深度/ 学习/ 模型/ —/ —/ —/ 栈式/ 自/ 编码/ 神经网络/ 算法/ —/ —/ —/ 利用/ 其/ 多层/ 网络结构/ 逐层/ 学习/ 特征/ 之间/ 的/ 非线性/ 关联/ ,/ 将/ 学习/ 到/ 的/ 组合/ 特征/ 集合/ 用于/ 描述/ 广告/ 数据/ 中/ 隐藏/ 的/ 内在/ 规律/ ./ (/ 3/ )/ CTR/ 预估/ 模型/ ./ 利用/ 学到/ 的/ 特征/ 集合/ 训练/ 预估/ 模型/ ,/ 得到/ 点击/ 预估/ 模型/ ./ 这样/ ,/ 给定/ 一个/ 新/ 的/ 样本/ ,/ 经过/ 降/ 维和/ 特征/ 学习/ 的/ 变换/ 后/ ,/ 点击/ 模型/ 可以/ 预估/ 广告/ 的/ 点击率/ ./ 3.3/ 数据/ 降维/ 方法/ 降维是/ 为/ 高维/ 数据/ 获取/ 一个/ 能/ 反映/ 原始数据/ 内在/ 结构/ 特性/ 的/ 低维/ 表示/ ,/ 同时/ 达到/ 降噪/ 、/ 降低/ 稀疏/ 性/ 的/ 目的/ ./ 点击/ 日志/ 数据/ 中/ 包含/ 了/ 用户/ 、/ 查询/ 、/ 广告/ 等/ 多种类型/ 的/ 对象/ ,/ 这些/ 对象/ 之间/ 的/ 关系/ 很/ 复杂/ ./ 相同/ 对象/ 内部/ 之间/ 存在/ 关系/ ,/ 如/ 广告/ 对象/ 内部/ 之间/ 存在/ 相似性/ 关系/ ./ 同时/ ,/ 不同/ 类型/ 对象/ 之间/ 也/ 存在/ 着/ 复杂/ 的/ 关系/ ,/ 如/ 给定/ 一个/ 特定/ 用户/ 和/ 该/ 用户/ 提交/ 的/ 查询/ ,/ 需要/ 预估/ 用户/ 是否/ 会/ 点击/ 广告/ ,/ 以及/ 点击/ 广告/ 的/ 概率/ 大小/ ,/ 用户/ 、/ 查询/ 和/ 广告/ 3/ 个/ 对象/ 之间/ 存在/ 复杂/ 的/ 隐含/ 关系/ ./ 本文/ 结合/ 点击/ 日志/ 数据/ 的/ 特点/ ,/ 分别/ 从/ 相同/ 对象/ 内部/ 之间/ 存在/ 相似性/ 关系/ 和/ 不同/ 对象/ 之间/ 存在/ 关联/ 关系/ 这/ 两个/ 角度/ 出发/ 进行/ 降维/ ./ 3.3/ ./ 1/ 相同/ 对象/ 聚类/ 表示/ 点击/ 日志/ 数据/ 中/ ,/ 用户/ 之间/ 、/ 查询/ 之间/ 以及/ 广告/ 之间/ 都/ 存在/ 相似性/ ,/ 例如/ 用户/ 输入/ 的/ 同一个/ 查询/ 所/ 返回/ 的/ 广告/ 之间/ 具有/ 相似性/ ,/ 触发/ 同一个/ 广告/ 的/ 不同/ 查询/ 之间/ 同样/ 存在/ 相似性/ ./ 同样/ 的/ ,/ 输入/ 相似/ 查询/ 的/ 不同/ 用户/ 由于/ 查询/ 意图/ 近似/ 也/ 具有/ 相似性/ ./ 因此/ ,/ 首先/ 从/ 相似性/ 的/ 角度/ 对/ 用户/ 、/ 查询/ 和/ 广告/ 3/ 个/ 维度/ 进行/ 降维/ ./ 本文/ 采用/ 基于/ 距离/ 划分/ 的/ K/ -/ means/ 聚类/ 算法/ [/ 20/ ]/ 对/ 查询/ 、/ 广告/ 和/ 用户/ 进行/ 聚类/ ./ 目的/ 是/ 通过/ 聚类/ 使得/ 相似/ 对象/ 聚合/ 到/ 同一/ 簇中/ ,/ 同一/ 簇中/ 的/ 对象/ 相似/ 度/ 尽可能/ 的/ 高/ ,/ 获得/ 初始/ 的/ 聚合/ 数据/ ./ 直接/ 利用/ 传统/ IR/ 领域/ 的/ 文本/ 相似性/ 技术/ 实现/ 对/ 查询/ 甚至/ 广告/ 的/ 聚类/ ,/ 虽然/ 可以/ 完成/ 聚类/ 任务/ ,/ 但是/ 这种/ 做法/ 没有/ 考虑/ 到/ 实际/ 数据/ 中/ 蕴含/ 的/ 广告/ 与/ 查询/ 之间/ 的/ 关联/ 关系/ ,/ 得到/ 的/ 聚类/ 结果/ 对/ 点击率/ 预估/ 没有/ 任何/ 参考/ Page5/ 意义/ ./ 因此/ 为了/ 能够/ 更好/ 的/ 挖掘/ 和/ 利用/ 广告/ 与/ 查询/ 之间/ 的/ 关联/ 关系/ ,/ 本文/ 提出/ 了/ 新/ 的/ 方法/ ,/ 用/ 实验/ 数据/ 中/ 提供/ 的/ 广告/ 展示/ 次数/ 作为/ 广告/ Ai/ 与/ 查询/ Qj/ 的/ 权重/ ,/ 来/ 建立/ 广告/ -/ 查询/ 矩阵/ 犠/ Na/ ×/ N/ 数/ ,/ Nq/ 表示/ 查询/ 数/ ,/ wij/ 表示/ 〈/ Ai/ ,/ Qj/ 〉/ 之间/ 的/ 权重/ ./ 对/ 该/ 广告/ -/ 查询/ 矩阵/ 采用/ K/ -/ means/ 算法/ 进行/ 聚类/ ,/ 得到/ 一个/ 相对/ 密集/ 的/ 数据/ 集合/ ./ 以/ 广告/ 聚类/ 为例/ ,/ 图/ 2/ 介绍/ 了/ 聚类/ 算法/ 的/ 流程/ ,/ 对/ 查询/ 的/ 聚类/ 采取/ 同样/ 处理/ 方式/ ./ 输入/ :/ 广告/ -/ 查询/ 矩阵/ 犠/ M/ ×/ N/ ,/ 聚类/ 簇数/ K/ 输出/ :/ K/ 个/ 广告/ 簇/ 集合/ 1/ ./ 对/ 广告/ -/ 查询/ 矩阵/ 犠/ M/ ×/ N/ 扫描/ ,/ 得到/ 所有/ 的/ M/ 个/ 广告/ 和/ N/ 个/ 查询/ ,/ 分别/ 记/ 作/ 犃/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ aM/ }/ 和/ 犙/ =/ {/ q1/ ,/ q2/ ,/ …/ ,/ qN/ }/ ;/ 2/ ./ 从/ M/ 个/ 广告/ 中/ 随机/ 抽取/ K/ 个/ 作为/ 最初/ 的/ 聚类/ 中心点/ ,/ 记/ 作/ 犜/ =/ {/ t1/ ,/ t2/ ,/ …/ ,/ tk/ }/ ;/ 3/ ./ 初始化/ K/ 个/ 聚类/ 集合/ {/ 犘/ 1/ ,/ 犘/ 2/ ,/ …/ ,/ 犘/ K/ }/ 为/ 空集/ ;/ 4/ ./ 计算/ 每个/ 广告/ ai/ 与/ 各个/ 聚类/ 中心点/ tj/ 之间/ 的/ 距离/ ,/ 计算公式/ 如下/ :/ (/ 其中/ Gij/ 表示/ 广告/ ai/ 与/ 作为/ 聚类/ 中心/ 的/ 广告/ tj/ 共同/ 展现/ 的/ 查询/ 集合/ ,/ WaDis/ (/ ai/ ,/ tj/ )/ 表示/ ai/ 与/ tj/ 的/ 距离/ )/ ;/ 5/ ./ 若/ Dis/ (/ ai/ ,/ tj/ )/ =/ max/ {/ D/ (/ ai/ ,/ t1/ )/ ,/ D/ (/ ai/ ,/ t2/ )/ ,/ …/ ,/ D/ (/ ai/ ,/ tk/ )/ }/ ,/ 则/ 广告/ ai/ 属于/ 簇/ 犘/ j/ ;/ 6/ ./ 计算/ 同一/ 聚类/ 集合/ 中/ 所有/ 广告/ 的/ 平均/ 权重/ 值/ ,/ 重新/ 生成/ 聚类/ 中心/ ;/ 7/ ./ 如果/ 聚类/ 中心/ 的/ 偏差/ 达到/ 了/ 设定/ 的/ 阈值/ ,/ 则/ 聚类/ 完成/ ;/ 否则/ 转到/ 步/ 4/ 重新/ 计算/ ./ 基于/ 广告/ -/ 查询/ 矩阵/ 犠/ Na/ ×/ N/ 聚类/ 算法/ 完成/ 对/ 广告/ // 查询/ 的/ 聚类/ ,/ 使得/ 同一/ 簇中/ 的/ 广告/ // 查询/ 相似/ 度/ 尽可能/ 的/ 高/ ./ 本文/ 具体/ 作法/ 是/ 基于/ 同一个/ 广告/ -/ 查询/ 矩阵/ 分别/ 对/ 广告/ 和/ 查询/ 作聚类/ ,/ 两次/ 聚类/ 相互/ 独立/ ,/ 聚类/ 顺序/ 不/ 影响/ 后续/ 的/ 计算/ ./ 对于/ 用户/ 维度/ 的/ 聚类/ ,/ 考虑/ 到/ 具有/ 相似/ 查询/ 需求/ 的/ 用户/ 具有/ 相似性/ ,/ 本文/ 直接/ 根据/ 前面/ 得到/ 的/ 查询/ 聚类/ 结果/ ,/ 将/ 同一/ 簇中/ 的/ 查询/ 所/ 对应/ 的/ 用户/ 聚在一起/ 组成/ 一个/ 用户/ 簇/ ./ 初始/ 数据/ 中/ 的/ 用户数/ 、/ 查询/ 数/ 和/ 广告/ 数/ 分别/ 用/ Nu/ ,/ Nq/ 和/ Na/ 表示/ ,/ 相同/ 类型/ 对象/ 内部/ 聚类/ 后/ ,/ 属于/ 同一个/ 簇中/ 的/ 对象/ 用/ 同一个/ ID/ 表示/ ,/ 将/ 聚类/ 后/ 的/ 用户/ 、/ 查询/ 和/ 广告/ 的/ 簇数/ 分别/ 用/ Ku/ ,/ Kq/ ,/ Ka/ 表示/ ./ 这样/ ,/ 初始/ 数据/ 集中/ 的/ 用户数/ 、/ 查询/ 数/ 和/ 广告/ 数由/ 原来/ 的/ Nu/ ,/ Nq/ 和/ Na/ 分别/ 降维到/ Ku/ ,/ Kq/ 和/ Ka/ ./ 假设/ Tq/ 和/ Ta/ 分别/ 表示/ 对/ 查询/ 和/ 广告/ 调用/ 聚类/ 算法/ 完成/ 聚类/ 任务/ 而/ 需要/ 执行/ 的/ 迭代/ 次数/ ,/ K/ 表示/ 聚类/ 的/ 个数/ ,/ 则/ 完成/ 对/ 查询/ 聚类/ 的/ 时间/ 复杂性/ 为/ O/ (/ KTqNq/ )/ ,/ 而/ 对/ 广告/ 进行/ 聚类/ 的/ 时间/ 复杂性/ 为/ O/ (/ KTaNa/ )/ ./ 由于/ 用户/ 的/ 聚类/ 没有/ 调用/ 图/ 2/ 的/ 算法/ ,/ 而是/ 根据/ 查询/ 的/ 聚类/ 结果/ 直接/ 得到/ 的/ ,/ 其/ 复杂性/ 为/ O/ (/ Nq/ +/ Nu/ )/ ,/ 令/ T/ =/ max/ {/ Tq/ ,/ Ta/ }/ ,/ N/ =/ max/ {/ Nu/ ,/ Nq/ ,/ Na/ }/ ,/ 则/ 聚类/ 环节/ 的/ 复杂性/ 表示/ 为/ O/ (/ KTqNq/ )/ +/ O/ (/ KTaNa/ )/ +/ O/ (/ Nq/ +/ Nu/ )/ =/ O/ (/ KTN/ )/ ./ 3.3/ ./ 2/ 不同/ 对象/ 复杂/ 关联/ 关系/ 求精/ 点击/ 日志/ 数据/ 中/ 的/ 用户/ -/ 查询/ -/ 广告/ 之间/ 存在/ 三元/ 关系/ ./ 传统/ 的/ 降维/ 方法/ (/ 如/ PCA/ 等/ )/ 不仅/ 破坏/ 了/ 三者/ 之间/ 的/ 内在/ 关系/ ,/ 当/ 数据/ 维度/ 数/ 很大/ 时/ ,/ 容易/ 导致/ 维数/ 灾难/ ./ 为此/ ,/ 本文/ 用/ 三维/ 张量/ 结构/ 模型表示/ 用户/ 、/ 查询/ 和/ 广告/ 三维/ 数据/ ,/ 然后/ 利用/ 张量/ 分解/ 法/ 进行/ 降维/ ./ 张量/ 模式/ 降维/ 充分/ 保留/ 了/ 用户/ 、/ 查询/ 和/ 广告/ 之间/ 的/ 结构/ 信息/ 和/ 内在/ 关联/ ,/ 由于/ 参数/ 更/ 少/ ,/ 对于/ 高维/ 数据/ 来说/ ,/ 张量/ 模式/ 的/ 降维要/ 比/ 向量/ 模式/ 有/ 更好/ 的/ 约简/ 效果/ ./ 定义/ 1/ ./ 张量/ (/ Tensor/ )/ [/ 21/ ]/ ./ 张量/ 是/ 一个/ 定义/ 在/ 向量/ 空间/ 和/ 对偶空间/ 笛卡尔/ 积上/ 的/ 多/ 线性/ 函数/ ./ 在/ n/ 维空间/ 内/ ,/ 有/ nr/ 个/ 分量/ (/ r/ 是/ 张量/ 的/ 秩/ 或/ 阶/ )/ ,/ 其中/ 每个/ 分量/ 都/ 是/ 坐标/ 的/ 函数/ ,/ 在/ 进行/ 坐标/ 变换/ 时/ ,/ 这些/ 分量/ 同样/ 根据/ 相应/ 规则/ 做/ 线性变换/ ./ 其中/ 一阶/ 张量/ (/ r/ =/ 1/ )/ 称为/ 向量/ ,/ 二阶/ 张量/ (/ r/ =/ 2/ )/ 称为/ 矩阵/ ,/ 矩阵/ 分解/ 是/ 张量/ 分解/ 的/ 特殊/ 形式/ ./ 基于/ 聚类/ 后/ 的/ 数据/ ,/ 建立/ “/ 用户/ -/ 查询/ -/ 广告/ -/ 权重/ ”/ 四元/ 关系/ 〈/ ui/ ,/ qj/ ,/ ak/ ,/ wi/ ,/ j/ ,/ k/ 〉/ ,/ 关于/ 权重/ 的/ 计算/ 有/ 很/ 多种/ 方式/ ,/ 本文/ 结合/ 实验/ 用/ 的/ 数据/ ,/ 利用/ 聚类/ 后/ 广告/ 簇中/ 广告/ 的/ 展示/ 数/ 之/ 和/ 作为/ 三维空间/ 中/ 元素/ 的/ 权重/ 来/ 构建/ 三维/ 张量/ 模型/ ,/ 用/ 犎/ ∈/ RKu/ ×/ K/ 型/ 如图/ 3/ 所示/ ,/ 三个/ 维度/ 的/ 维度/ 数/ 分别/ 是/ Ku/ ,/ Kq/ ,/ Ka/ ./ 构建/ 三维/ 张量/ 犎/ ∈/ RKu/ ×/ K/ 分解/ 法/ (/ TuckerFactorization/ )/ [/ 22/ ]/ ,/ 分解/ 张量/ 犎/ ,/ 公式/ 表示/ 如下/ :/ 犎/ =/ 犆/ ×/ u/ 犝/ ×/ q/ 犙/ ×/ a/ 犃/ =/ ∑/ =/ 犆/ ;/ 犝/ ,/ 犙/ ,/ 式/ (/ 2/ )/ 中/ 的/ 犆/ 表示/ 张量/ 犎/ 的/ 核心/ 张量/ (/ CoreTensor/ )/ ,/ 类似/ 于/ 奇异/ 值/ 分解/ 的/ 对角/ 矩阵/ ,/ 本文/ 用/ 犝/ ,/ 犙/ ,/ 犃/ 表示/ 张量/ 犎/ 在/ 维度/ Ku/ ,/ Kq/ ,/ Ka/ 上/ 对应/ 的/ 特征/ 矩阵/ ,/ 是/ 张量/ 犎/ 在/ 对应/ 3/ 个/ 维度/ 上/ 的/ 主/ 成分/ ./ Tucker/ 分解/ 原理/ 示意图/ ,/ 如图/ 3/ 所示/ ./ Tucker/ 分解/ 的/ 目的/ 是/ 找到/ 一个/ 与/ 原始/ 张量/ 犎/ 的/ 近似/ 张量/ ,/ 并且/ 最大/ 程度/ 保留/ 原始/ 的/ 张量/ 信息/ 和/ 结构/ 信息/ [/ 23/ ]/ ./ Tucker/ 分解/ 计算/ 可以/ 得到/ 一个/ 与/ 原始/ 张量/ 相近/ 的/ 张量/ 表示/ 犎/ ^/ ,/ 如/ 最小化/ 公式/ (/ 3/ )/ 所示/ :/ Page6/ 式/ (/ 3/ )/ 表示/ 原始/ 张量/ 与/ 近似/ 张量/ 的/ 近似/ 程度/ ,/ 是/ 优化/ 的/ 目标/ 函数/ ./ 根据/ 式/ (/ 3/ )/ 可以/ 得到/ 核心/ 张量/ 的/ 表达式/ :/ 目标/ 函数/ 可以/ 写成/ 平方/ 形式/ ,/ 即/ 犎/ -/ 犆/ ;/ 犝/ ,/ 犙/ ,/ =/ 犎/ 2/ -/ 2/ 〈/ 犎/ ×/ u/ 犝/ T/ ×/ q/ 犙/ T/ ×/ a/ 犃/ T/ ,/ 犆/ 〉/ +/ 犆/ 2/ =/ 犎/ 2/ -/ 2/ 〈/ 犆/ ,/ 犆/ 〉/ +/ 犆/ 2/ =/ 犎/ 2/ -/ 犆/ 2/ =/ 犃/ 2/ -/ 犎/ ×/ u/ 犝/ T/ ×/ q/ 犙/ T/ ×/ a/ 犃/ T2/ 犎/ 2/ 是/ 一个/ 常数/ ,/ 由/ 原来/ 的/ 张量/ 犎/ ∈/ RKu/ ×/ K/ 确定/ ./ 因此/ ,/ 目标/ 函数/ 转化/ 为式/ (/ 3/ )/ 中/ 右边/ 的/ 最大化/ 问题/ 的/ 最优/ 解/ ,/ 即式/ (/ 6/ )/ 中/ 的/ 目标/ 可以/ 写成/ 如下/ 形式/ :/ 在/ 求/ 最优/ 解/ 的/ 过程/ 中/ ,/ 需要/ 固定/ 其他/ 维度/ 的/ 特征/ 矩阵/ ,/ 即/ 变量/ 犠/ ,/ 依次/ 求解/ 犝/ T/ ,/ 犙/ T/ ,/ 犃/ T/ ,/ 然后/ 对/ 犝/ T/ ,/ 犙/ T/ ,/ 犃/ T/ 进行/ SVD/ 分解/ ./ 对/ 犝/ T/ ,/ 犙/ T/ ,/ 犃/ T/ 进行/ SVD/ 分解/ 时/ ,/ 首先/ 展开/ 张量/ 犎/ ,/ 在/ 用户/ 、/ 查询/ 、/ 广告/ 维度/ 展开/ 张量/ 犎/ 成为/ 矩阵/ ,/ 分别/ 记作/ 犎/ 1/ ,/ 犎/ 2/ ,/ 犎/ 3/ ,/ 然后/ 在/ 这/ 3/ 个/ 矩阵/ 犎/ 1/ ,/ 犎/ 2/ ,/ 犎/ 3/ 上/ 应用/ 奇异/ 值/ 分解/ ,/ 可/ 得到/ 对于/ 矩阵/ 犎/ 1/ ,/ 犎/ 2/ ,/ 犎/ 3/ ,/ 需要/ 确定/ 3/ 个维数/ 的/ 参数/ ,/ 分别/ 是/ 左/ 奇异/ 值/ 矩阵/ 犝/ ,/ 犙/ ,/ 犃/ 中/ 的/ 维/ 数/ c1/ ,/ c2/ ,/ c3/ ./ 这/ 3/ 个/ 参数/ 决定/ 张量/ 犎/ 的/ 核心/ 张量/ 犆/ 的/ 维/ 数/ ./ 3/ 个/ 对角/ 的/ 奇异/ 值/ 矩阵/ 犆/ 1/ ,/ 犆/ 2/ 和/ 犆/ 3/ 是/ 通过/ 对/ 张量/ 犎/ 的/ 展开/ 矩阵/ 犎/ 1/ ,/ 犎/ 2/ ,/ 犎/ 3/ 进行/ 奇异/ 值/ 分解/ 得到/ 的/ ,/ 而/ 核心/ 张量/ 犆/ 的/ 计算/ 则/ 是/ 通过/ 3/ 个/ 对角/ 奇异/ 值/ 矩阵/ 犆/ 1/ ,/ 犆/ 2/ 和/ 犆/ 3/ 求得/ ./ 维数/ c1/ ,/ c2/ ,/ c3/ 的/ 计算/ 则/ 通过/ 对/ 犆/ 1/ ,/ 犆/ 2/ 和/ 犆/ 3/ 的/ 对角/ 奇异/ 值/ 从/ 大到/ 小/ 按照/ 比例/ 计算/ 而/ 得/ ./ 保留/ 大/ 的/ 奇异/ 值/ ,/ 按照/ 比例/ 删减/ 小/ 的/ 奇异/ 值/ ,/ 从而/ 达到/ 维数/ 的/ 归约/ ,/ 对/ 原始/ 张量/ 降维/ 的/ 目的/ ./ 本文/ 在/ 降维/ 的/ 过程中将/ 删减/ 奇异/ 值/ 的/ 比例/ 分别/ 设置/ 为/ 50/ %/ ./ 这样/ ,/ 降维后/ 新/ 的/ 核心/ 张量/ 犆/ 计算公式/ 如下/ :/ 确定/ 新/ 核心/ 张量/ 犆/ 以及/ 新/ 的/ 特征/ 矩阵/ 犝/ r1/ 犙/ r2/ ,/ 犃/ r3/ 初始/ 张量/ 犎/ 的/ 3/ 个/ 维度/ 数/ 分别/ 是/ Ku/ ,/ Kq/ ,/ Ka/ ,/ 经过/ 降维后/ 的/ 近似/ 张量/ 犎/ 的/ 3/ 个/ 维度/ 数/ 分别/ 用/ Iu/ ,/ Iq/ ,/ Ia/ 表示/ ./ Tucker/ 分解/ 算法/ 的/ 时间/ 复杂性/ 与/ 张量/ 的/ 各个/ 维度/ 成正比/ ,/ 可以/ 表示/ 为/ O/ (/ KuKqKa/ )/ ./ 由于/ 我们/ 之前/ 利用/ 聚类/ 方法/ 已经/ 实现/ 了/ 对/ 原始/ 矩阵/ 的/ 降维/ ,/ 使得/ 此处/ 的/ Tucker/ 分解/ 开销/ 大大降低/ ,/ 效率/ 和/ 精度/ 都/ 有/ 显著/ 提高/ ./ 3.4/ 复杂/ 特征/ 学习/ 方法/ 机器/ 学习/ 领域/ 的/ 研究/ 表明/ ,/ 深度/ 或/ 层次结构/ 的/ 模型/ 对于/ 刻画/ 数据/ 中/ 的/ 非线性/ 关系/ 和/ 复杂/ 模式/ 更/ 有效/ [/ 24/ ]/ ./ 受到/ 这项/ 研究/ 的/ 启发/ ,/ 本文/ 利用/ 一种/ 能够/ 刻画/ 特征/ 之间/ 高度/ 非线性/ 关联/ 的/ 方法/ —/ —/ —/ 栈式/ 自/ 编码/ 网络/ 算法/ (/ StackedAutoEncoderNetwork/ ,/ SAEN/ )/ [/ 25/ ]/ 用于/ 学习/ 广告/ 数据/ 中/ 的/ 结构/ 信息/ ,/ 使用/ 该/ 算法/ 自动/ 学习/ 数据/ 中/ 的/ 模式/ 特征/ ,/ 并/ 将/ 学到/ 的/ 特征/ 融入/ 到/ 建模/ (/ 如/ 分类/ 、/ 预测/ )/ 的/ 过程/ 中/ ,/ 从而/ 克服/ 人工/ 特征/ 工程/ 的/ 不/ 完备/ 性/ 缺陷/ ./ 3.4/ ./ 1/ 输入/ 层/ 特征/ 构成/ 分析/ 广告/ 数据/ 中/ 的/ 特征/ 之间/ 存在/ 高度/ 非线性/ 关联/ ,/ 虽然/ 通过/ Tucker/ 分解/ 获得/ 原始/ 张量/ 降维后/ 的/ 近似/ 张量/ ,/ 但/ 仅仅/ 反映/ User/ ,/ Query/ ,/ Ad/ 三个/ 特征/ 维度/ 之间/ 的/ 信息/ ,/ 数据/ 中/ 其他/ 对/ 点击率/ 预估/ 有用/ 的/ 信息/ 没有/ 充分利用/ ,/ 如/ 广告/ 在/ 返回/ 页面/ 的/ 位置/ 、/ 广告/ 数量/ 以及/ 用户/ 年龄/ 、/ 性别/ 等/ 信息/ ./ 本文/ 结合/ 张量/ 降维后/ 的/ 〈/ User/ ,/ Query/ ,/ Ad/ 〉/ 特征/ 以及/ 日志/ 数据/ 中/ 其他/ 有效/ 信息/ 作为/ 特征/ 学习/ 的/ 对象/ ,/ 输入/ 层/ 特征/ 的/ 构成/ 总结/ 如下/ :/ (/ 1/ )/ ID/ 类/ 特征/ ./ ID/ 类/ 特征/ 可以/ 唯一/ 标识/ 某类/ 实体/ ,/ 在/ 实际/ 的/ 点击/ 日志/ 中/ ,/ 通常/ 使用/ 一组/ 数字/ 字符串/ 来/ 表示/ 此类/ 变量/ ,/ 如/ ‘/ 10010/ ’/ 可/ 标识/ 唯一/ 一个/ 用户/ 群体/ ./ 文中/ 用到/ 的/ ID/ 类/ 特征/ 有/ 用户/ ID/ (/ UserID/ )/ ,/ 查询/ ID/ (/ QueryID/ )/ ,/ 广告/ ID/ (/ AdID/ )/ ,/ 广告/ 位置/ Position/ 以及/ 返回/ 页/ 上/ 的/ 广告/ 数/ Depth/ ./ 值得注意/ 的/ 是/ ,/ 这里/ 的/ UserID/ ,/ QueryID/ 和/ AdID/ 是/ 经过/ K/ -/ means/ 聚类/ 和/ 张量/ 降维后/ 得到/ 的/ “/ 虚拟/ ”/ Page7ID/ 类/ 集合/ ./ 最初/ 的/ 用户数/ 、/ 查询/ 数/ 和/ 广告/ 数/ 分别/ 是/ Nu/ ,/ Nq/ ,/ Na/ ,/ 经过/ K/ -/ means/ 聚类/ 后/ 的/ 数量/ 分别/ 是/ Ku/ ,/ Kq/ ,/ Ka/ ,/ 再/ 经过/ 张量/ 降维后/ 的/ 用户数/ 、/ 查询/ 数/ 和/ 广告/ 数/ 分别/ 是/ Iu/ ,/ Iq/ ,/ Ia/ ./ (/ 2/ )/ 属性/ 类/ 特征/ ./ ID/ 类/ 特征/ 仅仅/ 是/ 一个/ 标识/ ,/ 此类/ 特征/ 无法/ 从/ 新/ 出现/ 的/ 实体/ 数据/ 中/ 获得/ ,/ 泛化/ 能力/ 比较/ 弱/ ./ 而/ 属性/ 类/ 特征/ 可以/ 用于/ 描述/ 某类/ 用户/ 集合/ 、/ 广告/ 集合/ 等/ ,/ 有/ 较/ 好/ 的/ 泛化/ 能力/ ,/ 该类/ 特征/ 可/ 命中/ 多个/ 实例/ ./ 例如/ ,/ 通过/ IP/ 属性/ 类/ 特征/ 可以/ 知道/ 用户/ 的/ 地理位置/ 信息/ ,/ 那么/ 对/ 地域/ 有/ 要求/ 的/ 广告/ ,/ 如/ 肯德基/ 等/ 餐饮/ 类/ 广告/ ,/ IP/ 能够/ 提供/ 较大/ 的/ 信息量/ ./ 因此/ ,/ 有/ 必要/ 将/ 属性/ 类/ 特征/ 作为/ 深度/ 学习/ 的/ 输入/ 层/ 特征/ ./ 常用/ 的/ 属性/ 类/ 特征/ 有/ :/ 用户/ 所在/ 网址/ IP/ ,/ 广告/ 被/ 触发/ 的/ 时间/ Time/ ,/ 用户/ 性别/ Gender/ ,/ 用户/ 年龄/ Age/ ,/ 查询/ 关键词/ Keywords/ 等/ ./ Time/ 类/ 特征/ 是/ 一种/ 对/ 用户/ 行为/ 影响/ 比较/ 强/ 的/ 特征/ ,/ 用于/ 记录/ 用户/ 行为/ 发生/ 的/ 时段/ ./ Keywords/ 是/ 图/ 4/ 输入/ 层/ 特征/ 构成/ 情况/ 3.4/ ./ 2/ 自/ 编码器/ 自/ 编码器/ (/ AutoEncoder/ )/ [/ 26/ ]/ 是/ 一个/ 尽可能/ 复现/ 初始/ 特征/ 的/ 深度/ 学习/ 算法/ ,/ 通常/ 被/ 用来/ 学习/ 原始数据/ 更好/ 的/ 特征/ 表示/ ,/ 由/ 3/ 层/ 网络结构/ 组成/ :/ 底层/ 是/ 输入/ 层/ I/ 、/ 中间/ 为/ 隐藏/ 层/ H/ (/ 新/ 的/ 数据/ 表示层/ )/ 以及/ 输出/ 层/ O/ ./ 自/ 编码/ 网络/ 如图/ 5/ 所示/ ./ 输入/ 数据/ 经过/ 隐藏/ 层/ ,/ 在/ 输出/ 层/ 重构/ ,/ 通过/ 最小化/ 输入/ 和/ 输出/ 的/ 重构/ 误差/ 来/ 校准/ 网络/ 权重/ ,/ 学习/ 输入/ 数据/ 的/ 潜在/ 特征/ 或/ 数据/ 的/ 压缩/ 表示/ ./ 本文/ 用/ ins/ 和/ hids/ 分别/ 表示/ 输入/ 层/ 单元/ 的/ 个数/ 和/ 隐藏/ 层/ 单元/ 个数/ ,/ 给定/ 一个/ 训练/ 数据/ 集合/ 犡/ =/ {/ 狓/ (/ 1/ )/ ,/ 狓/ (/ 2/ )/ ,/ …/ ,/ 狓/ (/ M/ )/ }/ ,/ 其中/ 狓/ (/ i/ )/ 中/ 狔/ ∈/ 犚/ hids/ )/ ,/ 映射/ 的/ 过程/ 就是/ 一个/ 编码/ 的/ 过程/ ,/ 用/ (/ i/ )/ 由/ 查询/ 字符串/ 去除/ 停/ 用词/ 后切/ 词/ 得到/ 的/ ./ (/ 3/ )/ 统计/ 类/ 特征/ ./ 统计/ 类/ 特征/ 尝试/ 使用/ 历史数据/ 的/ 统计/ 信息/ 给/ 点击/ 预估/ 模型/ 提供/ 预估/ 基准/ ,/ 例如/ ,/ 在/ 某/ 一/ 广告位/ 上/ 所有/ 展现/ 的/ 广告/ 平均/ CTR/ 值/ ./ 文中/ 的/ 统计/ 类/ 特征/ 有/ 广告/ 历史/ 展现/ 次数/ Shows/ ,/ 广告/ 历史/ 点击/ 次数/ Clicks/ 以及/ 广告/ 位置/ 归一化/ 后/ 的/ 点击率/ COEC/ ./ 关于/ COEC/ 的/ 计算/ ,/ 文献/ [/ 9/ ]/ 根据/ 式/ (/ 11/ )/ 计算/ 得到/ 去除/ 位置/ 偏倚/ 后/ 的/ 历史/ 点击率/ ,/ COEC/ 计算公式/ 为/ 其中/ ,/ 式/ (/ 11/ )/ 的/ 分子/ 表示/ 广告/ a/ 在/ 所有/ 位置/ 上/ 的/ 点击/ 次数/ 之/ 和/ ,/ 分母/ 表示/ 广告/ a/ 在/ 各个/ 位置/ 上/ 的/ 期望/ 点击/ 次数/ 之/ 和/ ./ 综上所述/ ,/ 在/ 本文/ 的/ 实验/ 中/ ,/ SAEN/ 算法/ 的/ 输入/ 层/ 特征/ 构成/ 情况/ 如图/ 4/ 所示/ ./ Sigmoid/ 函数/ 作为/ 连接/ 函数/ 完成/ 编码/ 过程/ ,/ 表示/ 如下/ :/ 参数/ 犠/ (/ 1/ )/ 向量/ 犫/ (/ 1/ )/ 犚/ ins/ ,/ 是/ 重构/ 输入/ 向量/ 的/ 过程/ ,/ 也/ 是/ 一个/ 解码/ 过程/ ,/ 目的/ 是/ 尽可能/ 重构/ 输入/ 向量/ 狓/ (/ i/ )/ ,/ 由/ 狔/ 一个/ 线性/ 映射/ 表示/ 如下/ :/ 这里/ 犠/ (/ 2/ )/ 过程/ 的/ 权重/ 矩阵/ 和/ 偏置/ 向量/ ./ 从/ 学习/ 的/ 角度/ ,/ 自/ 编码/ 算法/ 旨在/ 最小化/ 输入/ 狓/ (/ i/ )/ 与/ 输出/ 狕/ (/ i/ )/ 之间/ 的/ 重构/ 误差/ ,/ 得到/ 编码/ 和/ 解码/ 过程/ 的/ 参数/ 集合/ ./ 这里/ 犣/ =/ {/ 狕/ (/ 1/ )/ ,/ 狕/ (/ 2/ )/ ,/ …/ ,/ 狕/ (/ N/ )/ }/ ,/ 用/ J/ (/ 犡/ ,/ 犣/ )/ 表示/ 重构/ 误差/ :/ 图/ 6/ 描述/ 了/ 自/ 编码器/ 算法/ 的/ 学习/ 流程/ ./ 虽然/ 自/ 编码器/ 可以/ 通过/ 最小化/ 输入输出/ 的/ 重构/ 误差/ 获得/ 输入/ 数据/ 的/ 隐藏/ 表示/ ,/ 但是/ 它/ 只有/ 一个/ 隐层/ ,/ 属于/ 浅层/ 结构/ 模型/ ,/ 限制/ 了/ 对/ 数据/ 的/ 表示/ 能力/ ,/ 无法/ 刻画/ 广告/ 数据/ 中/ 特征/ 之间/ 的/ 高度/ 非线性/ 关联/ ./ 因此/ ,/ 本文/ 利用/ 含有/ 多个/ 隐藏/ 层/ 的/ 栈式/ 自/ 编码/ 网络/ 算法/ 学习/ 特征/ 之间/ 非线性/ 的/ 关联/ ,/ 本质/ 上/ 是/ 学习/ 单/ Page8/ 输入/ :/ 犡/ =/ {/ 数据/ 集合/ }/ ,/ ε/ =/ 随机/ 梯度/ 下降/ 算法/ 的/ 学习/ 率/ ,/ iters/ =/ 参数/ 迭代/ 次数/ ,/ num/ _/ i/ =/ 输入/ 层/ 节点/ 数/ ,/ num/ _/ h/ =/ 隐藏/ 层/ 节点/ 数/ 输出/ :/ 隐层/ 结果/ Result/ ,/ 网络连接/ 权重/ 矩阵/ 犠/ (/ 1/ )/ ,/ 输入/ 层/ 偏置/ 向量/ 犫/ 1/ ./ 初始化/ 网络连接/ 权重/ 矩阵/ 犠/ ,/ 矩阵/ 大小/ 为/ num/ _/ h/ ×/ num/ _/ i/ ,/ 输入/ 层/ 偏置/ 向量/ 犫/ ,/ 隐藏/ 层/ 偏置/ 向量/ 犮/ ;/ 2/ ./ 利用/ 式/ (/ 12/ )/ 连接/ 函数/ 求出/ 隐层/ 犢/ (/ 犡/ ,/ 犠/ (/ 1/ )/ ,/ 犫/ )/ ,/ 利用/ 式/ (/ 14/ )/ 求/ 出/ 重构/ 层/ Z/ (/ 犢/ ,/ 犠/ (/ 2/ )/ ,/ 犮/ )/ ./ 其中/ 犠/ (/ 2/ )/ 是/ 犠/ (/ 1/ )/ 的/ 转置/ 矩阵/ ;/ 3/ ./ 根据/ 重构/ 层/ 犣/ 和/ 输入/ 层/ 犡/ ,/ 构造/ 重构/ 误差/ J/ (/ 犡/ ,/ 犣/ )/ ./ 即/ 损失/ 函数/ ;/ 4/ ./ 分别/ 对/ 损失/ 函数/ 求/ 参数/ 犠/ (/ 1/ )/ ,/ 犫/ ,/ 犮/ 的/ 偏导/ ,/ 分别/ 用/ 表示/ ;/ 5/ ./ Forifrom1toitersdo6/ ./ 犠/ (/ 1/ )/ ←/ 犠/ (/ 1/ )/ +/ ε/ ×/ / J/ (/ 犡/ ,/ 犣/ )/ // / W/ (/ 1/ )/ 7/ ./ 犫/ ←/ 犫/ +/ ε/ ×/ / J/ (/ 犡/ ,/ 犣/ )/ // / 犫/ 8/ ./ 犮/ ←/ 犮/ +/ ε/ ×/ / J/ (/ 犡/ ,/ 犣/ )/ // / 犮/ 9/ ./ End/ -/ For10/ ./ 计算/ 隐藏/ 层/ 潜在/ 表示/ Result/ =/ f/ (/ 犠/ ×/ 犡/ +/ 犫/ )/ 11/ ./ 返回/ Result/ ,/ 犠/ ,/ 犫/ ./ 图/ 7/ 特征/ 学习/ 过程/ 与/ LR/ 预估/ 模型/ 训练/ 示意图/ (/ 2/ )/ 将/ 低阶/ 组合/ 特征/ 作为/ 新/ 的/ 学习/ 的/ 对象/ ,/ 再次/ 经过/ 非线性/ 变换/ 得到/ 相对/ 高阶/ 的/ 组合/ 特征/ ,/ 此/ 过程/ 重复/ 下去/ ,/ 直到/ 达到/ 设定/ 的/ 隐藏/ 层数/ 为止/ ./ 其中/ ,/ 多层/ 网络/ 中/ 不同/ 的/ 隐藏/ 层/ 是/ 对/ 输入/ 层/ 的/ 不同/ 潜在/ 表示/ ,/ 高层/ 的/ 特征/ 是/ 低层/ 特征/ 的/ 组合/ ,/ 从/ 低层/ 到/ 高层/ 的/ 特征/ 表达/ 越/ 抽象/ 和/ 概念化/ ,/ 也/ 就/ 越/ 能/ 挖掘/ 数据/ 中/ 蕴藏/ 的/ 有/ 价值/ 信息/ ./ 为了/ 更好/ 的/ 学习/ 网络/ 权重/ 参数/ ,/ 本文/ 采用/ 文献/ [/ 27/ ]/ 中/ 提出/ 的/ 基于/ 逐层/ 贪婪/ 训练/ 的/ 无/ 监督/ 学习/ 算法/ ./ 逐层/ 贪婪/ 学习/ 的/ 关键/ 是/ 逐层/ 训练/ 网络/ 权重/ 参数/ ,/ 每次/ 只/ 学习/ 相邻/ 两层/ 节点/ 的/ 连接/ 权重/ ,/ 通过/ 逐层/ 学习/ 以/ 获得/ 全局/ 的/ SAEN/ 模型/ 参数/ ./ 逐层/ 贪婪/ 方法学/ 特征/ 之间/ 的/ 组合/ 特征/ 形式/ ,/ 构造/ 最佳/ 的/ (/ 组合/ )/ 特征/ 集合/ 用以/ 提高/ 模型/ 预估/ CTR/ 的/ 准确率/ ./ 3.4/ ./ 3/ 基于/ SAEN/ 的/ 特征/ 学习/ 方法/ SAEN/ 算法/ 是/ 由/ 多个/ 自/ 编码器/ 组成/ 的/ 多层/ 深度/ 网络结构/ ,/ 其/ 特点/ 是/ 每/ 一个/ 隐藏/ 层/ 都/ 是/ 对/ 上/ 一层/ 的/ 输出/ 进行/ 非线性/ 变换/ 得到/ 的/ ./ SAEN/ 特征/ 学习/ 示意图/ ,/ 如图/ 7/ 粗/ 矩形框/ 部分/ 所示/ ./ SAEN/ 算法/ 的/ 一个/ 很/ 重要/ 的/ 特点/ 是从/ 输入/ 层/ 特征/ (/ 原始/ 特征/ )/ 中/ 学习/ 或/ 发现/ 高度/ 非线性/ 或/ 复杂/ 的/ 模式/ ,/ 直接/ 从/ 数据/ 中/ 自动/ 学习/ 潜在/ 特征/ 表示/ ./ 本文/ 利用/ SAEN/ 算法/ 学习/ 广告/ 数据/ 中/ 的/ 高阶/ 组合/ 特征/ 过程/ ,/ 描述/ 如下/ :/ (/ 1/ )/ 将/ 3.4/ ./ 1/ 节中/ 提取/ 的/ 初始/ 特征/ 作为/ 模型/ 的/ 输入/ ,/ 对/ 初始/ 特征/ 做/ 特征/ 非线性/ 变换/ 得到/ 第/ 1/ 隐藏/ 层/ ,/ 即/ 低阶/ 组合/ 特征/ ,/ 如图/ 7/ 所示/ ./ 习/ SAEN/ 权重/ 参数/ 的/ 过程/ 如下/ :/ (/ 1/ )/ 由/ 输入/ 层到/ 第/ 1/ 个/ 隐藏/ 层/ ,/ 通过/ 最小化/ 输入输出/ 的/ 重构/ 误差/ ,/ 利用/ 反向/ 传播/ 算法/ 训练/ 参数/ ,/ 得到/ 输入/ 数据/ 的/ 第/ 1/ 个/ 潜在/ 表示/ (/ 即/ 第/ 1/ 隐藏/ 层/ )/ ./ (/ 2/ )/ 将/ 上/ 一层/ 特征向量/ 作为/ 训练/ 下/ 一层/ 的/ 输入/ ,/ 采用/ 同样/ 的/ 方法/ 训练/ 权重/ 参数/ ,/ 得到/ 数据/ 的/ 另/ 一个/ 潜在/ 表示/ (/ 即/ 第/ 2/ 隐藏/ 层/ )/ ,/ 依次/ 类推/ ./ 也就是说/ ,/ 第/ i/ 隐藏/ 层/ 的/ 特征/ 作为/ 训练/ 第/ i/ +/ 1/ 层/ 的/ 输入/ ,/ 逐层/ 贪婪/ 的/ 学习/ 过程/ 是/ 把/ SAEN/ 网络/ 进行/ 分层/ ,/ 对/ 每/ 一层/ 进行/ 无/ 监督/ 学习/ ,/ 又/ 称为/ 预/ 训练/ 过程/ ./ 图/ 8/ 描述/ 了/ 基于/ 逐层/ 贪婪/ 学习/ 的/ 训练/ 过程/ ./ Page9/ 输入/ :/ 稀疏/ 训练样本/ 集合/ 犡/ =/ {/ 狓/ (/ i/ )/ ,/ 1/ / i/ / M/ ,/ 狓/ (/ i/ )/ ∈/ 犚/ D/ (/ I/ )/ }/ ,/ 隐藏/ 层数/ k/ 输出/ :/ 网络连接/ 权重/ 参数/ 矩阵/ 集合/ {/ 犠/ h/ ,/ 1/ / h/ / k/ }/ ,/ 偏置/ 向量/ 集合/ {/ 犫/ h/ ,/ 1/ / h/ / k/ }/ 第/ k/ 隐藏/ 层/ 输出/ 结果/ 犢/ (/ k/ )/ 1/ ./ 初始化/ :/ 犢/ (/ 0/ )/ =/ 犡/ ;/ 2/ ./ 用/ 原始/ 训练样本/ 作为/ 输入/ ,/ 通过/ 图/ 5/ 训练/ 出/ 第/ 1/ 个/ 隐层/ 结构/ 的/ 网络/ 参数/ W1/ ,/ 利用/ 式/ (/ 12/ )/ ,/ 将/ 训练/ 好/ 的/ 参数/ 算法/ 第/ 1/ 个/ 隐层/ 的/ 输出/ ,/ 得到/ 犢/ (/ 1/ )/ ;/ 3/ ./ 把/ 上/ 一步/ 的/ 输出/ 犢/ (/ 1/ )/ 作为/ 下/ 一个/ 自/ 编码/ 的/ 输入/ ,/ 同样/ 用图/ 5/ 训练/ 下/ 一个/ 隐层/ 网络/ 的/ 参数/ W2/ ,/ 并/ 根据/ 式/ (/ 12/ )/ 计算/ 下/ 一个/ 隐层/ 的/ 输出/ ,/ 得到/ 犢/ (/ 2/ )/ ;/ 4/ ./ 重复/ 步/ 3/ ,/ 直至/ 第/ k/ 个/ 隐层/ ,/ 并/ 根据/ 式/ (/ 12/ )/ 计算/ 出/ 第/ k/ 个/ 隐层/ 的/ 输出/ 犢/ (/ k/ )/ ;/ 5/ ./ 返回/ SAEN/ 网络连接/ 权重/ 矩阵/ 集合/ ,/ 偏置/ 向量/ 集合/ 以及/ 第/ k/ 层/ 的/ 隐层/ 犢/ (/ k/ )/ ./ 上述/ 算法/ 复杂性/ 与/ 自/ 编码器/ 的/ 网络结构/ 密切相关/ ,/ 假设/ k/ 为/ 网络/ 隐藏/ 层/ 的/ 数目/ ,/ 则/ 本文/ 采用/ 的/ 逐层/ 贪婪/ 训练/ 学习/ 算法/ 的/ 复杂性/ 可以/ 表示/ 为/ O/ (/ insk/ ·/ hids/ )/ ,/ 其中/ ins/ 和/ hids/ 分别/ 表示/ 输入/ 层/ 单元/ 的/ 个数/ 和/ 隐藏/ 层/ 单元/ 的/ 个数/ ,/ k/ 表示/ 网络/ 隐藏/ 层数/ ./ 3.5/ 点击率/ 预估/ 模型/ 上/ 一/ 小节/ 中/ ,/ 通过/ SAEN/ 算法/ 学习/ 得到/ 单/ 特征/ 之间/ 的/ 关联/ 特征/ ,/ 新/ 特征/ 有/ 更/ 强/ 的/ 表达能力/ ,/ 对/ 原始数据/ 有着/ 更/ 本质/ 的/ 刻画/ ./ 因此/ 本/ 小节/ 使用/ 新/ 特征/ 作为/ 点击/ 预估/ 模型/ 的/ 训练/ 对象/ ./ 点击率/ 预估/ 问题/ 实质/ 上/ 是/ 一个/ 基于/ 概率/ 的/ 二/ 分类/ 问题/ ,/ 本文/ 使用/ 逻辑/ 回归/ 作为/ 点击/ 预估/ 模型/ ,/ 逻辑/ 回归/ (/ LogisticRegression/ ,/ LR/ )/ 模型/ [/ 28/ ]/ 是/ 机器/ 学习/ 中/ 十分/ 常用/ 的/ 一种/ 广义/ 线性/ 分类/ 模型/ ,/ 通常/ 用来/ 描述/ 事件/ 发生/ 的/ 概率/ ,/ 在/ 互联网/ 领域/ 得到/ 广泛应用/ ./ 除了/ 广告/ 系统/ 的/ CTR/ 预估/ 外/ ,/ 推荐/ 系统/ 中/ 预估/ 转化率/ 、/ 反垃圾/ 系统/ 中/ 垃圾/ 识别/ 等/ 也/ 广泛/ 使用/ 该/ 模型/ ./ LR/ 预估/ 模型/ 训练/ 过程/ 示意图/ ,/ 如图/ 7/ 中/ 黑色/ 框/ 部分/ 所示/ ./ 定义/ 2/ ./ 正负/ 样本/ ./ 第/ i/ 个/ 样本/ 用/ (/ 犡/ (/ i/ )/ ,/ y/ 个/ 样本/ 的/ 组合/ 特征向量/ 描述/ ,/ y/ 击/ ,/ 取值/ 为/ 0/ 或/ 1/ ,/ y/ (/ i/ )/ 的/ 值/ 为/ 0/ 表示/ 该/ 则/ 广告/ 未/ 被/ 点击/ ./ 本文/ 把/ yy/ 值为/ 1/ 的/ 样本/ 定义/ 为/ 正/ 样本/ ,/ y/ 义为/ 负/ 样本/ ./ 给定/ M/ 条/ 训练样本/ {/ (/ 犡/ (/ i/ )/ ,/ yN/ 表示/ 特征/ 数/ ./ 对于/ 第/ i/ 个/ 样本/ 中/ 对应/ 的/ 广告/ ,/ 用户/ 点击/ 广告/ 的/ 概率/ 表示/ 为/ Py/ 其中/ θ/ 是/ 要求/ 解/ 的/ 参数/ ./ 等式/ 右侧/ 的/ 函数/ 称为/ Sigmoid/ 函数/ ,/ 其/ 值域/ 在/ (/ 0/ ,/ 1/ )/ 之间/ ./ 点击/ 变量/ y/ 分布/ ,/ 拟合/ 二项分布/ 通常/ 用/ 极大/ 似然/ 估计/ 法/ ,/ 假设/ 样本/ 之间/ 独立/ ,/ 所以/ 它们/ 的/ 联合/ 分布/ 可/ 表示/ 为/ 各/ 边缘/ 分布/ 的/ 乘积/ ,/ 即/ 通过/ 对式/ (/ 16/ )/ 进行/ 极大/ 似然/ 估计/ ,/ 即可/ 求得/ 参数/ ./ 本文/ 使用/ L/ -/ BFGS/ 优化/ 算法/ [/ 29/ ]/ 求解/ 参数/ ,/ 该/ 方法/ 收敛/ 更/ 快且/ 节省/ 内存/ ./ 该/ 算法/ 的/ 复杂性/ 为/ O/ (/ iters/ ·/ L3/ )/ ,/ 其中/ iters/ 表示/ 迭代/ 次数/ ,/ L/ =/ |/ 犢/ (/ k/ )/ 算法/ 最后/ 第/ k/ 隐藏/ 层/ 输出/ 的/ 结果/ 向量/ ,/ 即/ 学习/ 得到/ 的/ 新/ 特征/ ./ 3.6/ 算法/ 复杂性/ 分析/ 本文/ 算法/ 的/ 整体/ 复杂性/ 为/ 上述/ 各个环节/ 的/ 累加/ ,/ 即/ 聚类/ 、/ 张量/ 分解/ 、/ 深度/ 学习/ 和/ 点击率/ 预估/ ,/ 最后/ 算法/ 的/ 复杂性/ 可以/ 如下/ 描述/ :/ O/ (/ KTN/ )/ +/ O/ (/ KuKqKa/ )/ +/ O/ (/ insk/ ·/ hids/ )/ +/ O/ (/ iters/ ·/ L3/ )/ ,/ 其中/ K/ 表示/ 聚类/ 的/ 个数/ ,/ T/ =/ max/ {/ Tq/ ,/ Ta/ }/ ,/ Tq/ 和/ Ta/ 分别/ 表示/ 对/ 查询/ 和/ 广告/ 调用/ 聚类/ 算法/ 完成/ 聚类/ 任务/ 而/ 需要/ 执行/ 的/ 迭代/ 次数/ ,/ N/ =/ max/ {/ Nu/ ,/ Nq/ ,/ Na/ }/ ;/ Ku/ ,/ Kq/ 和/ Ka/ 分别/ 为/ 张量/ 犎/ 的/ 3/ 个/ 维度/ 数/ ;/ ins/ 和/ hids/ 分别/ 表示/ 输入/ 层/ 单元/ 的/ 个数/ 和/ 隐藏/ 层/ 单元/ 个数/ ,/ k/ 表示/ 网络/ 隐藏/ 层数/ ;/ iters/ 表示/ 迭代/ 次数/ ,/ L/ =/ |/ 犢/ (/ k/ )/ |/ ,/ 犢/ (/ k/ )/ 为/ SAEN/ 算法/ 最后/ 第/ k/ 隐藏/ 层/ 输出/ 的/ 结果/ 向量/ ./ 由于/ 实际/ 中/ T/ 的/ 取值/ 远/ 小于/ N/ ,/ 且/ K/ / N/ ;/ Ku/ ,/ Kq/ ,/ Ka/ </ N/ ,/ L/ / ins/ =/ O/ (/ Ku/ +/ Kq/ +/ Ka/ )/ ,/ 深度/ 学习/ 网络/ 确定/ 后/ ,/ 可/ 将/ hids/ ,/ iters/ 看作/ 常数/ ,/ 令/ P/ =/ max/ {/ k/ ,/ 3/ }/ ,/ 则/ 算法/ 的/ 复杂性/ 可以/ 简化/ 为/ O/ (/ NP/ )/ ,/ 其中/ P/ / 3.4/ 实验/ 与/ 结果/ 分析/ 实验/ 的/ 目的/ 是/ 想/ 通过/ 实验/ 验证/ 本文/ 提出/ 的/ 稀疏/ 特征/ 学习/ 方法/ ,/ 并/ 进一步/ 验证/ 与/ 已有/ 方法/ 相比/ 本文/ 方法/ 在/ 模型/ 运行/ 时间/ 上/ 是否/ 高效/ ,/ 预估/ 效果/ 是否/ 更/ 有效/ ,/ 以及/ 观察/ 不同/ 数据/ 规模/ 对/ 点击率/ 预估/ 结果/ 的/ 影响/ 趋势/ ./ 4.1/ 实验/ 环境/ 硬件/ 环境/ :/ 中科/ 曙光/ 服务器/ 1/ 台/ ,/ Intel/ (/ R/ )/ Xeon/ (/ R/ )/ E5/ -/ 2670/ @/ 2.60/ GHz32/ 核/ CPU/ ,/ 32GB/ 内存/ ./ 软件/ 环境/ :/ CentOS6/ ./ 2/ 操作系统/ ,/ Python2/ ./ 7.6/ Page10/ 开发/ 环境/ 以及/ pyTensor/ ,/ scikit/ -/ tensor/ ,/ scikit/ -/ learn/ ,/ theano/ 相关/ 工具包/ ./ 4.2/ 实验/ 数据/ 本文/ 的/ 实验/ 数据/ 来自/ SIGKDDCup2012track2/ ①/ ,/ 由/ 腾讯/ 公司/ 旗下/ 的/ 搜索引擎/ 搜/ 搜/ (/ 2013/ 年/ 9/ 月/ 并入/ 搜狗/ )/ 提供/ 的/ 广告/ 点击/ 日志/ 数据/ ./ KDD2012CUPtrack2/ 对应/ 的/ 研究/ 问题/ 是/ 根据/ 给出/ 的/ 真实/ 点击/ 数据/ 信息/ ,/ 包括/ 用户/ 查询/ ,/ 返回/ 广告/ 信息/ ,/ 返回/ 页/ 信息/ 等/ ,/ 来/ 预测/ 该/ 广告/ 的/ 点击率/ ./ 比赛/ 提供/ 的/ 训练/ 数据/ 集/ 共有/ 149639105/ 条/ 记录/ ,/ 9.87/ GB/ 大小/ ./ 测试数据/ 集中/ 除了/ 没有/ 点击数/ 和/ 展示/ 数/ 之外/ ,/ 其他/ 信息/ 与/ 训练/ 集/ 一致/ ,/ 共有/ 20257594/ 条/ 记录/ ,/ 1.26/ GB/ 大小/ ./ 数据/ 集中/ 一条/ 记录/ 表示/ 用户/ 的/ 一次/ 检索/ 行为/ 所/ 展示/ 的/ k/ 条/ 广告/ 中/ 一条/ 广告/ 包含/ 的/ 所有/ 信息/ ,/ 又/ 称为/ 一个/ 实例/ ./ 4.3/ 实验设计/ 过程/ (/ 1/ )/ 实验/ 数据/ 划分/ 本文/ 经过/ 对/ 无效/ 数据/ 清洗/ ,/ 以及/ 数据/ 预处理/ 后/ ,/ 从/ 候选/ 数据/ 集中/ 随机/ 抽取/ 330/ 万条/ 样本/ 用于/ 实验/ ,/ 最终/ 实验/ 所用/ 数据/ 统计/ ,/ 如表/ 1/ 所示/ ./ 总/ 数据/ 训练/ 数据测试/ 数据/ 实验/ 过程/ 中/ ,/ 本文/ 通过/ 划分/ 训练/ 数据/ 分别/ 在/ 7/ 个/ 不同/ 规模/ 的/ 数据/ 集上/ 训练/ 模型/ ,/ 并且/ 在/ 同一/ 测试/ 集上/ 验证/ 不同/ 方法/ 的/ 预估/ 性能/ ./ 训练/ 数据/ 集/ 划分/ 情况/ ,/ 如表/ 1/ 所示/ ./ 以上/ 训练/ 和/ 测试数据/ 的/ 划分/ 以及/ 训练/ 数据/ 的/ 分组/ 均/ 采用/ 随机/ 划分/ ./ 7/ 种/ 不同/ 规模/ 数据/ 集/ 的/ 每组/ 样本数/ 分别/ 为/ 15/ 万/ 、/ 20/ 万/ 、/ 30/ 万/ 、/ 50/ 万/ 、/ 60/ 万/ 、/ 75/ 万/ 和/ 100/ 万/ ./ 每种/ 规模/ 的/ 数据/ 都/ 至少/ 选取/ 3/ 组/ 以上/ 完全/ 不同/ 的/ 数据/ ,/ 最终/ 的/ 结果/ 取/ 所有/ 组/ 实验/ 结果/ 的/ 平均值/ ,/ 以此/ 来/ 保证/ 实验/ 结果/ 的/ 可靠性/ ./ (/ 2/ )/ 对比/ 方法/ 在/ 进行/ 对比/ 实验/ 时/ ,/ 为了/ 更/ 有/ 针对性/ 和/ 公平性/ ,/ 我们/ 按照/ 如下/ 标准/ 选择/ 对比/ 方法/ :/ ①/ 最新/ 的/ 点击率/ 预估/ 模型/ ;/ ②/ 针对/ 广告/ 数据/ 的/ 点击率/ 预估/ (/ 在/ 广告/ 数据/ 上/ 有/ 过/ 实验/ 的/ 工作/ )/ ;/ ③/ 单一/ 点击率/ 预估/ 模型/ ,/ 而/ 非/ 综合/ 多种/ 模型/ 的/ 组合式/ 模型/ ./ 由于/ 本文/ 工作/ 的/ 核心/ 是/ 预估/ 模型/ ,/ 因此/ 第/ 1/ 个/ 原则/ 保证/ 我们/ 与/ 最新/ 的/ 预估/ 模型/ 进行/ 对比/ ./ 由于/ 点击率/ 预估/ 方面/ 的/ 工作/ 目前/ 主要/ 分为/ 两类/ ,/ Web/ 搜索/ 文档/ 和/ 广告/ ,/ 第/ 2/ 个/ 原则/ 是/ 为了/ 选择/ 真正/ 在/ 广告/ 数据/ 上/ 有/ 过/ 测试/ 的/ 模型/ ;/ 第/ 3/ 个/ 原则/ 是/ 要求/ 选择/ 那些/ 单一/ 模型/ 进行/ 对比/ ,/ 可以/ 更好/ 的/ 分析/ 不同/ 模型/ 之间/ 的/ 异同/ ,/ 当然/ 本文/ 的/ 方法/ 可以/ 很/ 容易/ 的/ 集成/ 到/ 文献/ [/ 11/ ]/ 的/ 框架/ 中/ ./ 本文/ 预估/ 模型/ 最大/ 特点/ 有/ 两个/ 方面/ :/ ①/ 降维/ 方法/ 在/ 保证/ 降低/ 维数/ 的/ 前提/ 下/ ,/ 并/ 没有/ 丢失/ 关键/ 信息/ ;/ ②/ 在/ 特征/ 关联/ 的/ 深度/ 学习/ 方面/ ,/ 通过/ 自动/ 学习/ 挖掘/ 关键/ 特征/ 和/ 关联/ ./ 其/ 属于/ 基于/ 特征/ 学习/ 的/ 点击率/ 预估/ 方法/ ./ 因此/ 根据上述/ 原则/ 和/ 本文/ 方法/ 的/ 特点/ ,/ 选取/ 了/ 与/ 本文/ 方法/ 相近/ 的/ 两个/ 代表性/ 工作/ 进行/ 对比/ ./ 文献/ [/ 3/ ]/ 与/ 本文/ 提出/ 的/ ADoSFLM/ 方法/ 都/ 使用/ LR/ 作为/ 预估/ 模型/ ,/ 从/ 数据/ 中/ 抽取/ 与/ 点击率/ 预估/ 相关/ 的/ 特征/ ,/ 是/ 通过/ 人工/ 设定/ 特征提取/ 方案/ 后/ 得到/ 的/ ,/ 如/ 通过/ 数据/ 中/ 的/ 信息/ 得到/ 广告/ 质量/ 特征/ ,/ 相似/ 广告/ CTR/ 值/ 等/ ./ 而/ 本文/ 提出/ 的/ 方法/ 是/ 利用/ 深度/ 学习/ 算法/ ,/ 通过/ 挖掘/ 特征/ 之间/ 的/ 关联/ 自动/ 获得/ 特征/ ./ 文献/ [/ 12/ ]/ 使用/ 矩阵/ 分解/ 获得/ 查询/ -/ 广告/ 内在/ 关联/ 以及/ 通过/ 张量/ 分解/ 获得/ 用户/ -/ 查询/ -/ 广告/ 之间/ 的/ 关联/ 信息/ ,/ 然后/ 集合/ 广告/ 位置/ 和/ 广告/ 与/ 查询/ 相关性/ 信息/ ,/ 利用/ 贝叶斯/ 网络/ 建模/ ,/ 得到/ 的/ 概率模型/ 用/ EM/ 算法/ 求解/ 结果/ ./ 该文/ 使用/ 张量/ 分解/ 法是/ 为了/ 获得/ 用户/ 个性化/ 信息/ ,/ 最后/ 得到/ 的/ 是/ 基于/ 个性化/ 点击率/ 预估/ 模型/ ./ 通过/ 对/ 用户/ 行为/ 建模/ ,/ 考虑/ 到/ 了/ 用户/ 信息/ ,/ 通过/ 对比/ 实验/ ,/ 验证/ 该/ 方法/ 好于/ 其他/ 已有/ 的/ 概率/ 图/ 模型/ 方法/ ./ 然而/ ,/ 与/ 本文/ 方法/ 相比/ ,/ 两者/ 最大/ 的/ 差异/ 是/ 对/ 信息/ 的/ 利用/ 方式/ 不同/ ./ 本文/ 最大/ 特点/ 是/ 使用/ 深度/ 学习/ 算法/ 挖掘/ 特征/ 之间/ 的/ 内在/ 关联/ ,/ 获得/ 的/ 是/ 组合/ 特征/ 集合/ ,/ 而/ 非/ 简单/ 的/ 对/ 用户/ 行为/ 进行/ 建模/ ./ 通过/ 与/ 文献/ [/ 3/ ,/ 12/ ]/ 中/ 的/ 方法/ 进行/ 比较/ ,/ 可以/ 验证/ 本文/ 通过/ 深度/ 学习/ 获得/ 的/ 特征/ 与/ 人工/ 方式/ 获得/ 特征/ 相比/ 是否/ 更/ 高效/ ./ 同时/ ,/ 也/ 可以/ 验证/ 经过/ 张量/ 分解/ 后/ 得到/ 的/ 低维/ 核心/ 张量/ 是否/ 仍然/ 具有/ 足够/ 的/ 信息量/ 用于/ 深度/ 学习/ 点击率/ 预估/ 的/ 关键/ 特征/ ./ 表/ 2/ 简要/ 的/ 介绍/ 了/ 本文/ 进行/ 对比/ 的/ 几种/ 方法/ ./ 方法/ Human/ _/ LRHPCMADoSFLM/ (/ 3/ )/ 实验/ 评估/ 方法/ 本文/ 采用/ ROC/ 曲线/ 下/ 面积/ AUC/ [/ 30/ ]/ (/ AreaUnder/ ①/ SIGKDD12Cup/ ./ http/ :/ // // www/ ./ kddcup2012/ ./ org/ // c/ // kdd/ -/ Page11theReceiverOperatingCharacteristic/ )/ 作为/ 模型/ 预估/ 性能/ 评价/ 标准/ ./ ROC/ 曲线/ 基于/ 混淆/ 矩阵/ ,/ 它/ 主要/ 用于/ 比较/ 预估/ 结果/ 和/ 真实/ 结果/ ./ 矩阵/ 中/ 的/ 行/ 表示/ 实例/ 的/ 预测/ 结果/ ,/ 列/ 表示/ 实例/ 的/ 真实/ 结果/ ./ 在/ ROC/ 空间/ 中/ ,/ 每个/ 点/ 的/ 纵坐标/ 是/ 真正/ 率/ ,/ 横坐标/ 是/ 假/ 正率/ ,/ 描绘/ 了/ 分类器/ 在/ TP/ 和/ FP/ 之间/ 的/ 权衡/ ./ 对于/ 本文/ 的/ 二值/ 分类/ 问题/ 来说/ ,/ 实例/ 值/ 往往/ 是/ 连续/ 值/ ,/ 需要/ 设定/ 一个/ 阈值/ ,/ 将/ 实例/ 分类/ 到/ 正类/ 或/ 负类/ ./ 曲线/ 下/ 面积/ (/ AUC/ )/ 就是/ ROC/ 曲线/ 下方/ 的/ 那/ 部分/ 面积/ 大小/ ,/ 该值/ 通常/ 介于/ [/ 0.5/ ,/ 1/ )/ 之间/ ,/ AUC/ 越大/ ,/ 代表/ 点击/ 预估/ 模型/ 性能/ 越/ 好/ [/ 30/ ]/ ./ 4.4/ 实验/ 结果/ 分析/ 主要/ 包括/ 3/ 个/ 部分/ :/ (/ 1/ )/ 参数/ 对模型/ 预估/ 效果/ 的/ 影响/ ;/ (/ 2/ )/ 模型/ 运行/ 时间/ 比较/ ;/ (/ 3/ )/ 预估/ 效果/ 的/ 比较/ 与/ 分析/ ./ 4.4/ ./ 1/ 参数/ 对模型/ 预估/ 效果/ 的/ 影响/ 本文/ 提出/ 的/ ADoSFLM/ 方法/ 涉及/ 到/ 很多/ 参数/ ,/ 最/ 关键/ 的/ 参数/ 如/ 深度/ 学习/ 阶段/ 中/ 网络层/ 数/ k/ 和/ 模型/ 训练/ 阶段/ 中/ 迭代/ 次数/ iters/ ./ 这些/ 参数/ 对于/ 模型/ 最后/ 的/ 预估/ 结果/ 产生/ 直接/ 的/ 影响/ ,/ 因此/ 本文/ 首先/ 针对/ 参数/ 进行/ 了/ 实验/ ,/ 以/ 选出/ 最佳/ 的/ 参数/ 组合/ ./ 本文/ 使用/ 数据/ 规模/ 为/ 500000/ 样本/ 的/ 一组/ 抽样/ 数据/ 训练/ 模型/ ,/ 在/ 测试/ 集上/ 测试/ ,/ 用于/ 选取/ 最佳/ 参数/ ./ 固定/ SAEN/ 算法/ 的/ 网络层/ 数/ (/ k/ =/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ )/ 时/ ,/ 分析/ 不同/ iters/ 对模型/ 性能/ 的/ 影响/ ,/ 所得/ 结果/ 如表/ 3/ 所示/ ./ 表/ 3/ 不同/ 网络层/ 数/ 与/ LR/ 模型/ 训练/ 迭代/ 次数/ 之间/ 的/ 关系/ 迭代/ 次数/ iters/ =/ 100.66340/ ./ 65770.66840/ ./ 66440.6639/ iters/ =/ 200.67570/ ./ 65910.68420/ ./ 67310.6693/ iters/ =/ 300.67930/ ./ 66850.69540/ ./ 67390.6802/ iters/ =/ 500.69890/ ./ 69320.70970/ ./ 69830.6937/ iters/ =/ 700.71690/ ./ 71490.72240/ ./ 71210.7139/ iters/ =/ 900.72460/ ./ 72650.73470/ ./ 72380.7354/ iters/ =/ 1000.72830/ ./ 72940.73840/ ./ 73770.7335/ iters/ =/ 1100.73050/ ./ 73080.74090/ ./ 73940.7390/ iters/ =/ 1300.73110/ ./ 73210.74080/ ./ 74110.7368/ iters/ =/ 1500.73240/ ./ 73200.74040/ ./ 73850.7382/ 根据/ 表/ 3/ 生成/ 曲线图/ ,/ 如图/ 9/ 所示/ ,/ 图/ 9/ 反映/ 了/ 不同/ 的/ 网络/ 隐/ 层数/ k/ 值/ 与/ LR/ 模型/ 迭代/ 次数/ iters/ 所/ 对应/ 的/ AUC/ 变化/ 情况/ ,/ 从图/ 9/ 中/ 不难看出/ ,/ 当/ 迭代/ 次数/ 为/ 100/ ~/ 120/ 次时/ ,/ 几条/ 曲线/ 的/ AUC/ 值/ 已经/ 变化/ 不/ 大/ ,/ 趋于稳定/ ./ 因此/ 在/ 下面/ 的/ 对比/ 实验/ 中/ ,/ 本文/ 选择/ 110/ 作为/ 训练/ 预估/ 模型/ 的/ 迭代/ 数/ ./ 值得注意/ 的/ 是/ ,/ SAEN/ 算法/ 的/ 复杂度/ 与/ 参数/ k/ 直图/ 9LR/ 模型/ 的/ AUC/ 值/ 随/ 不同/ 迭代/ 次数/ 变化/ 情况/ 接/ 相关/ ,/ k/ 表示/ 隐/ 层数/ ,/ 其值/ 越大/ ,/ SAEN/ 算法/ 的/ 计算/ 开销/ 越大/ ./ 通过/ 图/ 9/ 可知/ ,/ 达到/ 收敛/ 时/ ,/ k/ =/ 2/ ,/ 3/ ,/ 4/ ,/ 5/ ,/ 6/ 对应/ 的/ AUC/ 值/ 分别/ 是/ 0.7324/ ,/ 0.732/ ,/ 0.7404/ ,/ 0.7385/ 和/ 0.7382/ ./ 从/ 曲线/ 上/ 看/ ,/ 随着/ 迭代/ 次数/ 的/ 变化/ ,/ 各条/ 曲线/ 波动/ 较大/ ,/ 其中/ k/ =/ 4/ 时/ 相对/ 稳定/ ,/ 并且/ 当/ 迭代/ 数/ 达到/ 一定/ 值时/ ,/ AUC/ 值/ 趋于/ 收敛/ ./ 因此/ ,/ 就/ 本/ 实验/ 所用/ 的/ 数据/ 集/ 、/ 数据/ 规模/ 以及/ 计算/ 开销/ 而言/ ,/ 综合/ 考虑/ k/ =/ 4/ (/ 即隐/ 层数/ 为/ 4/ )/ 是/ 一个/ 合理/ 的/ 选择/ ./ 4.4/ ./ 2/ 模型/ 运行/ 时间/ 比较/ 本文/ 记录/ 了/ 3/ 种/ 方法/ 在/ 不同/ 数据/ 规模/ 下/ 的/ 运行/ 时间/ ,/ 表/ 4/ 给出/ 了/ 分别/ 在/ 15/ 万/ 、/ 30/ 万/ 、/ 50/ 万/ 、/ 75/ 万/ 和/ 100/ 万/ 数据/ 规模/ 下/ 的/ 平均/ 运行/ 时间/ ./ 平均/ 时间/ // s/ 对比/ 方法/ Human/ _/ LRHPCMADoSFLM/ 从表/ 4/ 可知/ ,/ 3/ 种/ 方法/ 在/ 模型/ 运行/ 时间/ 上/ 相差/ 很大/ ./ Human/ _/ LR/ 运行/ 时间/ 只有/ 预估/ 模型/ 训练/ 阶段/ ,/ 特征/ 抽取/ 过程/ 依赖/ 领域/ 知识/ ,/ 特征/ 数/ 相对/ 较/ 少/ ,/ 模型/ 运行/ 时间/ 相对/ 也/ 较/ 小/ ./ 而/ HPCM/ 和/ ADoSFLM/ 模型/ 涉及/ 到/ 张量/ 分解/ 的/ 复杂/ 运算/ 以及/ EM/ 算法/ 和/ 深度/ 学习/ 阶段/ 算法/ 的/ 计算/ 开销/ 也/ 很大/ ,/ 并且/ 涉及/ 到/ 的/ 特征/ 数较/ 多/ ./ 因此/ ,/ HPCM/ 和/ ADoSFLM/ 方法/ 运行/ 时间/ 相对/ 较长/ ./ 虽然/ 本文/ 提出/ 的/ ADoSFLM/ 方法/ 在/ 运行/ 时间/ 方面/ 并/ 没有/ 特别/ 优势/ ./ 但是/ ,/ 最/ 耗时/ 的/ 广告/ 点击率/ 预估/ 模型/ 是/ 基于/ 海量/ 数据/ 训练/ 得到/ 的/ ,/ 其/ 计算/ 过程/ 是/ 在/ 离线/ 环境/ 下/ 进行/ 的/ ./ 因此/ ,/ 运行/ 时间/ 对/ 在线/ 预估/ CTR/ 值/ 并/ 没有/ 影响/ ./ 4.4/ ./ 3/ 预估/ 效果/ 的/ 比较/ 与/ 分析/ 本文/ 分别/ 在/ 7/ 个/ 不同/ 规模/ 的/ 数据/ 集上/ 训练/ 模型/ ,/ 在/ 同一/ 测试/ 集上/ 评估/ 预估/ 效果/ ./ 分别/ 考察/ 不同/ 方法/ 之间/ 的/ 预估/ 效果/ ,/ 以及/ 数据/ 规模/ 对/ 预估/ 质量/ 的/ 影/ Page12/ 响/ ./ 表/ 5/ 描述/ 了/ 不同/ 方法/ 在/ 不同/ 数据/ 规模/ 下/ 的/ 预估/ 结果/ ./ 表/ 53/ 种/ 方法/ 在/ 不同/ 数据/ 规模/ 下/ 的/ 平均/ 预估/ 效果/ 数据/ 规模/ // 万/ 152030506075100/ 从表/ 5/ 可以/ 看到/ 3/ 种/ 方法/ 在/ 不同/ 规模/ 数据/ 集下/ 的/ 预估/ 结果/ ,/ ADoSFLM/ 模型/ 相对/ 于/ Human/ _/ LR/ 的/ 预估/ 效果/ 随着/ 数据/ 规模/ 的/ 加大/ 提升/ 效果/ 越发/ 明显/ ,/ 以/ 数据/ 规模/ 100/ 万为例/ ,/ 预估/ 性能/ 提升/ 了/ 8.35/ %/ ./ ADoSFLM/ 之所以/ 预估/ 性能/ 更好/ ,/ 主要/ 有/ 3/ 个/ 原因/ :/ (/ 1/ )/ 原始数据/ 中/ 存在/ 很多/ 长尾/ 数据/ 和/ 无效/ 数据/ ,/ 本文/ 经过/ 数据/ 清洗/ 后/ ,/ 通过/ 对/ 原始数据/ 进行/ K/ -/ means/ 聚类/ 和/ 张量/ 分解/ 两次/ 降维/ ,/ 降低/ 了/ 数据/ 中/ 的/ 噪声/ 对/ 真实/ 信息/ 的/ 干扰/ ,/ 同时/ 也/ 降低/ 了/ 数据/ 的/ 稀疏/ 性/ ,/ 这/ 对于/ 提高/ 预估/ 准确率/ 是/ 有利/ 的/ ;/ (/ 2/ )/ ADoSFLM/ 方法/ 采用/ 了/ 深度/ SAEN/ 算法/ 学习/ 特征/ 之间/ 的/ 高度/ 非线性/ 关联/ ,/ 多层/ 结构/ 的/ 特征/ 学习/ 模型/ 对于/ 挖掘/ 特征/ 之间/ 深层次/ 的/ 规律/ 是/ 有效/ 的/ ;/ (/ 3/ )/ 实验/ 过程/ 中/ ,/ 利用/ ADoSFLM/ 方法/ 学到/ 的/ 特征/ 数/ 大于/ Human/ _/ LR/ 方法/ 中/ 人工/ 抽取/ 的/ 特征/ ,/ ADoSFLM/ 方法/ 学到/ 的/ 特征/ 对/ 数据/ 有/ 更/ 强/ 的/ 表达能力/ ./ 通过/ 人工/ 方式/ 提取/ 出对/ 点击率/ 预估/ 高度/ 关联/ 的/ 特征/ 越/ 来/ 困难/ ,/ 而/ SAEN/ 算法/ 通过/ 对/ 广告/ 数据/ 进行/ 深度/ 学习/ ,/ 得到/ 更/ 多/ 的/ 对/ 点击率/ 预估/ 有/ 意义/ 的/ 特征/ ,/ 这/ 对于/ 提高/ 模型/ 预估/ 准确率/ 是/ 有/ 帮助/ 的/ ./ 从表/ 5/ 还/ 可知/ ,/ 采用/ ADoSFLM/ 方法/ 的/ 点击率/ 预估/ 效果/ 也/ 要/ 好/ 于/ HPCM/ ./ 主要/ 原因/ 有/ :/ 就/ 模型/ 而言/ ,/ 两种/ 方法/ 都/ 使用/ 张量/ 分解/ ,/ 获得/ 近似/ 张量/ 用于/ 点击/ 预估/ 模型/ ,/ ADoSFLM/ 方法/ 使用/ LR/ 模型/ 预估/ 点击率/ ,/ 后者/ 使用/ 概率模型/ 预估/ 点击率/ ,/ 其中/ 最大/ 的/ 区别/ 是/ 本文/ 提出/ 的/ 方法/ 含有/ 深度/ 特征/ 学习/ 的/ 阶段/ ./ ADoSFLM/ 中/ 的/ 深度/ 学习/ 方法/ ,/ 充分/ 学习/ 了/ 张量/ 分解/ 后/ 的/ 近似/ 张量/ 和/ 数据/ 中/ 其他/ 属性/ 特征/ 之间/ 的/ 非线性/ 关系/ ,/ SAEN/ 算法/ 刻画/ 特征/ 之间/ 的/ 高度/ 非线性/ 关联/ ,/ 最大/ 限度/ 的/ 挖掘/ 隐藏/ 在/ 特征/ 之间/ 的/ 规律/ ,/ 这是/ HPCM/ 模型/ 中/ 没有/ 的/ ./ 因此/ ,/ 从/ 预估/ 质量/ 上/ 来看/ ,/ 本文/ 使用/ 深度/ 结构/ 模型/ 学习/ 特征/ 之间/ 的/ 高度/ 非线性/ 关联/ ,/ 对于/ 提高/ 点击率/ 预估/ 的/ 准确性/ 是/ 可行/ 的/ ,/ 预估/ 质量/ 也/ 有所/ 提升/ ./ 为了/ 能/ 清晰/ 的/ 看出/ 3/ 种/ 方法/ 的/ 预估/ 质量/ 在/ 不同/ 规模/ 数据/ 下/ 的/ 变化趋势/ ,/ 本文/ 根据/ 表/ 7/ 得到/ 相应/ 的/ 平均/ 预估/ AUC/ 值/ 折线图/ ,/ 如图/ 10/ 所示/ ./ 图/ 10/ 不同/ 数据/ 规模/ 下/ 3/ 种/ 方法/ 的/ 预估/ 效果/ 比较/ 从图/ 10/ 可以/ 看出/ ,/ 3/ 种/ 方法/ 随着/ 数据/ 规模/ (/ 即/ 训练样本/ 数/ )/ 的/ 增加/ ,/ 在/ 同一/ 测试/ 集上/ 的/ 预估/ 质量/ 都/ 有所/ 提升/ ./ 这/ 主要/ 是因为/ ,/ 最初/ 的/ 训练样本/ 数/ 比较/ 少/ ,/ 对于/ 3/ 种/ 方法/ 来说/ ,/ 模型/ 都/ 处于/ 过/ 拟合/ 状态/ ,/ 随着/ 数据/ 规模/ 的/ 增加/ ,/ 训练/ 得到/ 的/ 参数/ 稳定性/ 和/ 健壮性/ 都/ 有所/ 增强/ ./ 值得注意/ 的/ 是/ ,/ 随着/ 数据/ 规模/ 的/ 增长/ ,/ 3/ 条/ 曲线/ 的/ 变化趋势/ 并不相同/ ,/ 即/ 模型/ 预估/ 效果/ 的/ 收敛/ 程度/ 不同/ ./ 开始/ 时/ ,/ 3/ 种/ 方法/ 预估/ 结果/ 基本/ 无/ 差异/ ,/ 随着/ 数据/ 规模/ 的/ 增长/ ,/ 本文/ 提出/ 的/ ADoSFLM/ 方法/ 与/ Human/ _/ LR/ 和/ HPCM/ 方法/ 相比/ ,/ 预估/ 效果/ 增长/ 明显/ 加快/ ./ 在/ 相同/ 数据/ 规模/ 下/ ,/ 增长幅度/ 也/ 大于/ 其他/ 两个/ 方法/ ./ Human/ _/ LR/ 方法/ 在/ 数据/ 规模/ 为/ 600000/ 时/ ,/ 已/ 基本/ 趋于/ 收敛/ ,/ 这/ 说明/ 人工/ 抽取/ 特征/ 方法/ ,/ 在/ 较/ 小规模/ 数据/ 集上/ 表现/ 良好/ ./ 当/ 数据/ 规模较/ 小时/ ,/ 数据/ 中/ 隐藏/ 的/ 结构/ 和/ 规律/ 不/ 明显/ ,/ 人工/ 抽取/ 的/ 特征/ 可以/ 很/ 好/ 的/ 表示/ 数据/ ./ HPCM/ 方法/ 中/ 用到/ 的/ 张量/ 分解/ ,/ 一方面/ 是/ 为了/ 获得/ 数据/ 的/ 降维/ 、/ 降噪/ 表示/ ,/ 另一方面/ 也/ 是/ 为了/ 挖掘/ 广告/ 日志/ 数据/ 中/ 隐藏/ 的/ 用户/ 个性化/ 信息/ ,/ 从图/ 10/ 可以/ 看出/ ,/ 随着/ 数据/ 规模/ 的/ 增加/ ,/ 预估/ 效果/ 也/ 在/ 提升/ ./ 本文/ 提出/ 的/ ADoSFLM/ 方法/ ,/ 随着/ 数据/ 规模/ 的/ 增长/ ,/ 预估/ 结果/ 好于/ HPCM/ ./ 这/ 主要/ 是因为/ ADoSFLM/ 方法/ 中/ 包括/ 特征/ 学习/ 阶段/ ,/ 借助/ SAEN/ 算法/ 的/ 多层/ 网络结构/ ,/ 学习/ 特征/ 之间/ 的/ 高度/ 非线性/ 关联/ 关系/ ./ 当/ 数据/ 规模/ 很/ 小时/ ,/ 数据/ 无法/ 体现/ 特征/ 之间/ 复杂/ 的/ 内在/ 关联/ ,/ 此时/ SAEN/ 也/ 不能/ 很/ 好/ 的/ 刻画/ 这种/ 关联/ ./ 随着/ 数据/ 规模/ 的/ 增加/ ,/ SAEN/ 算法/ 可以/ 更好/ 的/ 学习/ Page13/ 数据/ 中/ 隐藏/ 的/ 规律/ ,/ 也就是说/ ,/ 本文/ 使用/ 深度/ 学习/ 算法/ 来/ 学习/ 广告/ 数据/ 单/ 特征/ 之间/ 的/ 组合/ 特征/ (/ 即/ 特征/ 之间/ 的/ 关联/ )/ ./ 从/ 理论/ 上/ 来说/ ,/ 训练/ 数据/ 越/ 多/ ,/ 该/ 算法/ 学到/ 的/ 特征/ 对/ 数据/ 的/ 表达能力/ 就/ 越强/ ,/ 广告/ CTR/ 预估/ 的/ 准确率/ 也/ 就/ 越/ 高/ ./ 虽然/ 受到/ 当前/ 实验/ 所用/ 硬件/ 设备/ 的/ 限制/ ,/ 实验/ 过程/ 中/ 没有/ 使用/ 更/ 大规模/ 的/ 数据/ 来/ 训练/ 模型/ ,/ 但是/ 上述/ 结果/ 也/ 证明/ 本文/ 提出/ 的/ 方法/ 比/ 其他/ 方法/ 更/ 适合/ 于/ 大/ 数据量/ 情况/ 下/ 的/ 应用/ ./ 5/ 结论/ 与/ 展望/ 本文/ 基于/ 最/ 基本/ 的/ 搜索/ 广告/ 点击/ 数据/ ,/ 从/ 特征/ 学习/ 的/ 角度/ ,/ 提出/ 了/ 面向/ 广告/ 数据/ 的/ 稀疏/ 特征/ 学习/ 方法/ ./ 考虑/ 到/ 广告/ 数据/ 的/ 高/ 维和/ 高/ 稀疏/ 性/ 特点/ ,/ 本文/ 利用/ 降维/ 的/ 方法/ ,/ 首先/ 基于/ 相似/ 度/ 分别/ 对/ 相似/ 的/ 广告/ 、/ 查询/ 和/ 用户/ 进行/ 聚类/ ,/ 使/ 数据/ 具有/ 初始/ 聚合/ 性/ ;/ 其次/ 对/ 降维后/ 的/ 三元组/ 建立/ 三维/ 张量/ 模型/ ,/ 利用/ Tucker/ 分解/ 获得/ 低阶/ 近似/ 张量/ ./ 针对/ 特征/ 之间/ 存在/ 的/ 高度/ 非线性/ 关联/ 关系/ ,/ 文中/ 研究/ 了/ 基于/ 深度/ 学习/ 的/ 特征/ 学习/ 方法/ ,/ 首先/ 分析/ 了/ 输入/ 层/ 特征/ 构成/ ,/ 结合/ 栈式/ 自/ 编码/ 网络/ 算法/ 学习/ 特征/ 之间/ 的/ 高阶/ 组合/ 特征/ ,/ 作为/ 点击/ 预估/ 模型/ 的/ 训练/ 对象/ ./ 实际/ 中/ 如果/ 还/ 可以/ 获得/ 其他/ 类型/ 的/ 数据/ ,/ 如/ 不同/ 用户/ 群体/ 的/ 偏好/ ,/ 不同/ 类型/ 广告/ 的/ 投放/ 规律/ 等/ ,/ 则/ 可以/ 结合/ 使用/ 不同/ 类型/ 的/ 方法/ ,/ 以此/ 获得/ 更/ 高/ 的/ 预估/ 准确率/ ,/ 因为/ 不同/ 类型/ 的/ 方法/ 可以/ 覆盖/ 问题/ 的/ 不同/ 方面/ ./ 尽管/ 本/ 研究/ 从/ 特征/ 学习/ 的/ 角度/ 研究/ 点击率/ 预估/ 问题/ 取得/ 了/ 较/ 好/ 的/ 效果/ ,/ 但/ 仍/ 存在/ 一些/ 不足之处/ ./ 因此/ ,/ 在/ 后续/ 的/ 工作/ 中/ ,/ 可/ 在/ 本文/ 基础/ 上/ ,/ 从/ 以下/ 几个/ 角度/ 进一步/ 研究/ :/ (/ 1/ )/ 文中/ 基于/ 深度/ 学习/ 算法/ 的/ 时间/ 复杂度/ 比较/ 高/ ,/ 计算/ 开销/ 较大/ ,/ 该/ 算法/ 复杂度/ 与/ 每/ 一层/ 的/ 单元/ 数/ 和/ 网络层/ 数/ 有关/ ,/ 同时/ 也/ 与/ 连接/ 函数/ 有关/ ./ 在/ 保证/ 特征/ 学习效果/ 的/ 前提/ 下/ ,/ 如何/ 改进/ 连接/ 函数/ 、/ 调节/ 每/ 一层/ 单元/ 数/ 和/ 网络层/ 数/ ,/ 以/ 降低/ 时间/ 开销/ 的/ 问题/ 有待/ 解决/ ;/ (/ 2/ )/ 文中/ 提出/ 的/ 特征/ 学习/ 方法/ 预估/ 广告/ 点击率/ ,/ 仅/ 考虑/ 了/ 展示/ 充分/ 的/ 广告/ 数据/ ,/ 未/ 考虑/ 展示/ 不/ 充分/ 的/ 广告/ (/ 稀疏/ 广告/ )/ ./ 接下来/ 的/ 工作/ 中/ ,/ 如何/ 从/ 特征/ 学习/ 的/ 角度/ ,/ 预估/ 稀疏/ 广告/ 的/ 点击率/ ,/ 是/ 一个/ 值得/ 研究/ 的/ 问题/ ,/ 也/ 是/ 实际/ 中/ 目前/ 亟需/ 解决/ 的/ 一个/ 问题/ ;/ (/ 3/ )/ 不同/ 预估/ 模型/ 之间/ 的/ 深入分析/ 与/ 对比/ ,/ 开展/ 不同/ 模型/ 融合/ 方面/ 的/ 机/ 理性/ 研究/ ./ 

