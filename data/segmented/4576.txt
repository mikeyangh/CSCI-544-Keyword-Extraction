Page1/ 基于/ 局部/ 方差/ 与/ 残差/ 复杂性/ 的/ 医学/ 图像/ 配准/ 卢振泰/ 张娟/ 冯/ 前进/ 陈武凡/ (/ 南方/ 医科大学/ 生物医学/ 工程学院/ 广州/ 510515/ )/ 摘要/ 文中/ 提出/ 了/ 一种/ 新/ 的/ 基于/ 局部/ 方差/ 与/ 残差/ 复杂性/ 的/ 相似性/ 测度/ ./ 传统/ 的/ 基于/ 灰度/ 的/ 相似性/ 测度/ 易受/ 噪声/ 、/ 灰度/ 偏移/ 场/ 和/ 造影剂/ 的/ 影响/ 造成/ 误配/ ./ 残差/ 复杂性/ 在/ 一定/ 程度/ 上/ 可以/ 克服/ 这一/ 难点/ ,/ 但/ 该/ 测度/ 对/ 初始/ 参数/ 非常/ 敏感/ ,/ 参数设置/ 不/ 正确/ 往往/ 达/ 不到/ 好/ 的/ 配准/ 效果/ ./ 文中/ 利用/ 图像/ 的/ 局部/ 方差/ 信息/ 构造/ 权重/ 函数/ ,/ 在/ 图像/ 残差/ 比较/ 大/ 的/ 地方/ 给予/ 小/ 的/ 权重/ 约束/ ,/ 在/ 残差/ 比较/ 小/ 的/ 地方/ 给予/ 大/ 的/ 约束/ ,/ 计算/ 约束/ 后/ 残差/ 图像/ 的/ 残差/ 复杂性/ 作为/ 新/ 的/ 相似性/ 测度/ ./ 新/ 测度/ 更/ 平滑/ 、/ 鲁棒性/ 更好/ ,/ 不/ 容易/ 陷入/ 局部/ 极值/ ./ 对/ 模拟/ 数据/ 和/ 真实/ 数据/ 的/ 实验/ 表明/ 新/ 测度/ 对/ 噪声/ 、/ 灰度/ 偏移/ 场/ 、/ 造影剂/ 和/ 初始/ 参数/ 具有/ 更/ 高/ 的/ 鲁棒性/ ,/ 更加/ 适合/ 于/ 医学/ 图像/ 配准/ ./ 关键词/ 局部/ 方差/ ;/ 指数函数/ ;/ 残差/ 复杂性/ ;/ 鲁棒/ 估计/ ;/ 图像/ 配准/ 1/ 引言/ 医学/ 图像/ 配准/ 是/ 指/ 对/ 一幅/ 医学/ 图像/ 寻求/ 一种/ 空投/ 稿/ 日期/ :/ 2014/ -/ 12/ -/ 18/ ;/ 最终/ 修改稿/ 收到/ 日期/ :/ 2015/ -/ 03/ -/ 10/ ./ 本/ 课题/ 得到/ 国家自然科学基金/ (/ 31000450/ )/ 、/ 广东省/ 自然科学/ 基金/ (/ 2014A030313316/ )/ 和/ 广州市/ 珠江/ 科技/ 新星/ 专项基金/ 项目/ (/ 2012J2200041/ )/ 资助/ ./ 卢振泰/ ,/ 男/ ,/ 1981/ 年生/ ,/ 博士/ ,/ 副教授/ ,/ 主要/ 研究/ 方向/ 为/ 医学/ 图像/ 配准/ 与/ 融合/ 、/ 图像/ 检索/ 及/ 模式识别/ ./ E/ -/ mail/ :/ xylzj123/ @/ 126/ ./ com/ ./ 张娟/ ,/ 女/ ,/ 1986/ 年生/ ,/ 博士/ ,/ 主要/ 研究/ 方向/ 为/ 医学/ 图像/ 配准/ ./ 冯/ 前进/ (/ 通信/ 作者/ )/ ,/ 男/ ,/ 1974/ 年生/ ,/ 博士/ ,/ 教授/ ,/ 博士生/ 导师/ ,/ 主要/ 研究/ 领域/ 为/ 医学/ 图像处理/ 、/ 模式识别/ ./ E/ -/ mail/ :/ qianjinfeng/ @/ gmail/ ./ com/ ./ 陈武凡/ ,/ 男/ ,/ 1949/ 年生/ ,/ 教授/ ,/ 博士生/ 导师/ ,/ 主要/ 研究/ 领域/ 为/ 图像处理/ 、/ 模式识别/ 、/ 广义/ 模糊/ 随/ 机场/ 模型/ ./ 间/ 变换/ ,/ 使得/ 该/ 图像/ 与/ 另/ 一幅/ 医学/ 图像/ 上/ 的/ 对应点/ 在/ 解剖/ 结构/ 和/ 空间/ 位置/ 上/ 达到/ 一致/ ./ 当/ 两幅/ 图像/ 配准/ 后/ ,/ 我们/ 可以/ 对/ 它们/ 进行/ 比较/ 和/ 分析/ ./ 医学/ 图像/ 往往/ 是/ 在/ 不同/ 时间/ 同一/ 成像/ 设备/ 或者/ 不同/ 时间/ 不同/ 成/ Page2/ 像/ 设备/ 上/ 获取/ 的/ ,/ 临床/ 上/ 常常/ 需要/ 将/ 病人/ 的/ 图像/ 信息/ 融合/ 起来/ ,/ 便于/ 医生/ 更/ 准确/ 地/ 诊断/ 和/ 治疗/ 疾病/ ,/ 而/ 图像/ 配准/ 是/ 图像/ 融合/ 的/ 前提/ 和/ 关键步骤/ [/ 1/ ]/ ./ 在/ 计算机辅助/ 手术/ 中/ ,/ 外科医生/ 根据/ 配准/ 结果/ 来/ 精确定位/ 病灶/ ,/ 以便/ 进行/ 手术/ 跟踪/ [/ 2/ ]/ ./ 另外/ ,/ 图像/ 配准/ 在/ 乳腺/ 及/ 肝部/ 疾病/ 的/ 发现/ 和/ 治疗/ 、/ 心脏/ 运动/ 估计/ [/ 3/ ]/ 、/ 医学/ 图谱/ 的/ 制作/ 等/ 方面/ 也/ 有/ 重要/ 意义/ ./ 在/ 医学/ 图像/ 配准/ 中/ ,/ 相似性/ 测度/ 是/ 其中/ 的/ 一个/ 重要/ 组成部分/ ./ 常用/ 的/ 基于/ 灰度/ 的/ 相似性/ 测度/ 有/ 平方差/ (/ SumofSquaredDifferences/ ,/ SSD/ )/ 、/ 绝对/ 差/ (/ SumofAbsoluteDifferences/ ,/ SAD/ )/ 、/ 相关系数/ (/ CorrelationCoefficient/ ,/ CC/ )/ 、/ 互/ 信息量/ (/ MutualInformation/ ,/ MI/ )/ ./ 基于/ 灰度/ 的/ 相似性/ 测度/ 只/ 定义/ 了/ 对应/ 像素/ 的/ 灰度/ 关系/ ,/ 没有/ 考虑/ 像素/ 之间/ 的/ 空间/ 依赖性/ ,/ 对于/ 增强/ 前后/ 的/ 图像/ 或/ 含有/ 灰度/ 偏移/ 场/ 和/ 噪声/ 的/ 图像/ ,/ 这/ 类/ 相似性/ 测度/ 鲁棒性/ 差/ ,/ 往往/ 不能/ 产生/ 满意/ 的/ 配准/ 结果/ ./ Ardekani/ 等/ 人/ [/ 4/ ]/ 提出/ 在/ 以/ 每个/ 像素/ 为/ 中心/ 的/ 小/ 窗口/ 内/ ,/ 用/ 局部/ 相关系数/ 作为/ 相似性/ 测度/ ./ Hermosillo/ 等/ 人/ [/ 5/ ]/ 通过/ 局部/ 化/ 相关/ 比/ 和/ MI/ ,/ 提出/ 一个/ 局部/ 相似性/ 测度/ 的/ 框架/ ./ Zhao/ 和/ Soatto/ [/ 6/ ]/ 考虑/ 到/ 局部/ 归一化/ 互信息/ 对/ 明暗/ 不/ 均匀/ 不/ 敏感/ ,/ 全局/ 归一化/ 互信息/ 不/ 容易/ 陷入/ 局部/ 极值/ 的/ 特点/ ,/ 从而/ 将/ 两者/ 结合/ 起来/ ./ 这类/ 基于/ 局部/ 相似性/ 测度/ 的/ 方法/ 认为/ 在/ 小/ 邻域/ 范围/ 内/ ,/ 可/ 将/ 图像/ 视为/ 明暗/ 均匀/ 的/ ./ 虽能/ 对/ 明暗/ 不/ 均匀/ 的/ 图像/ 产生/ 较/ 好/ 的/ 配准/ 结果/ ,/ 但/ 由于/ 在/ 小/ 窗口/ 内/ 进行/ 统计/ ,/ 将会/ 使/ 目标/ 函数/ 产生/ 更/ 多/ 的/ 局部/ 极值/ ,/ 且/ 此类/ 方法/ 对/ 噪声/ 和/ 出格/ 点/ 比较/ 敏感/ ./ El/ -/ Baz/ 等/ 人/ [/ 7/ ]/ 提出/ 使用/ Markov/ -/ Gibbs/ 随/ 机场/ 学习/ 一幅/ 图像/ 的/ 先验/ 表观/ 模型/ ,/ 再/ 对/ 第二幅/ 图像/ 进行/ 变换/ 使/ 其/ 概率/ 最大/ ./ Wyatt/ 和/ Noble/ [/ 8/ ]/ 提出/ 使用/ Markov/ 随/ 机场/ 模型/ 迭代/ 地/ 分割/ 和/ 配准/ 图像/ 的/ 类/ 标签/ ./ Zheng/ 和/ [/ 9/ ]/ 提出/ 基于/ 灰度/ 相似性/ 测度/ 的/ 最大/ 后验/ 概率/ -/ Zhang/ 马尔可夫/ 随/ 机场/ 框架/ ./ 这些/ 基于/ MRF/ 的/ 方法/ 严重/ 依赖于/ 局部/ 灰度/ 的/ 关系/ 和/ 初始/ 参数/ 的/ 选择/ ./ Friston/ 等/ 人/ [/ 10/ ]/ 提出/ 使用/ 非线性/ 灰度变换/ 和/ 卷积/ 滤波/ 对/ 图像/ 进行/ 灰度/ 校正/ ,/ 再/ 使用/ SSD/ 测度/ 进行/ 图像/ 配准/ ,/ 但/ 针对/ 不同/ 的/ 问题/ ,/ 必须/ 手动/ 选择/ 不同/ 的/ 卷积/ 滤波/ ./ Ashburner/ 和/ Friston/ [/ 11/ ]/ 提出/ 关于/ 联合/ 配准/ 、/ 灰度/ 归一化/ 和/ 分割/ 的/ 概率/ 框架/ ,/ 这/ 类/ 方法/ 虽然/ 可以/ 产生/ 较/ 准确/ 的/ 配准/ 结果/ ,/ 但/ 需要/ 手动/ 选择/ 参数/ 且/ 计算/ 量/ 大/ ./ Myronenko/ 等/ 人/ [/ 12/ ]/ 提出/ 基于/ 残差/ 复杂性/ (/ ResidualComplexity/ ,/ RC/ )/ 的/ 相似性/ 测度/ ,/ 通过/ 解析/ 方法/ 求取/ 灰度/ 偏移/ 场/ 并/ 推导/ 出/ RC/ ./ 与/ 前述/ 方法/ 的/ 不同之处/ 在于/ ,/ RC/ 的/ 表达式/ 中不含/ 灰度/ 偏移/ 场/ ,/ 从而/ 自/ 适应/ 地/ 约束/ 了/ 灰度/ 偏移/ 场/ ,/ 保证/ 了/ 需要/ 配准/ 的/ 两幅/ 图/ 在/ 灰度/ 空间/ 上/ 的/ 一致/ ./ 但/ 该/ 方法/ 对/ 参数/ 较/ 敏感/ 、/ 抗噪/ 能力/ 较弱/ 、/ 鲁棒性/ 较差/ ./ 这/ 是因为/ 传统/ RC/ 对/ 残差/ 图像/ 中/ 出格/ 点/ 、/ 噪声/ 点/ 和/ 其它/ 点/ 的/ 约束/ 相同/ ,/ 即/ 没有/ 考虑/ 残差/ 图像/ 自身/ 的/ 特征/ ,/ 因而/ 产生/ 误配/ ./ 鲁棒/ 估计/ 是/ 基于/ 鲁棒/ 统计学/ 提出/ 的/ ,/ 主要/ 研究/ 能够/ 容忍/ 一定量/ 离群/ 数据/ 的/ 估计/ 问题/ ./ 为了/ 减少/ 出格/ 点/ 或/ 噪声/ 点/ 对/ 目标/ 函数/ 的/ 影响/ ,/ 受鲁棒/ 估计/ [/ 13/ ]/ 的/ 启发/ ,/ 本文/ 利用/ 参考/ 图像/ 的/ 局部/ 方差/ 构造/ 权重/ 函数/ ,/ 在/ 残差/ 图像/ 灰度/ 值/ 比较/ 大/ 的/ 地方/ ,/ 分配/ 小/ 的/ 权值/ ,/ 而/ 在/ 残差/ 图像/ 灰度/ 值/ 比较/ 小/ 的/ 地方/ 分配/ 大/ 的/ 权值/ ./ 将/ 加权/ 后/ 残差/ 图像/ 的/ 残差/ 复杂性/ 作为/ 新/ 的/ 相似性/ 测度/ ./ 2/ 残差/ 复杂性/ 假设/ 待/ 配准/ 图像/ 犐/ 和/ 犑/ 存在/ 如下/ 关系/ :/ 其中/ :/ S/ 是/ 灰度/ 偏移/ 场/ ,/ η/ 是/ 均值/ 为/ 零/ 的/ 高斯/ 噪声/ ,/ τ/ 为/ 变形/ 场/ ./ 通过/ 最大化/ 后验/ 概率/ 的/ 方法/ 估计/ S/ 和/ τ/ ./ P/ (/ τ/ ,/ S/ 犐/ ,/ 犑/ )/ ∝/ P/ (/ 犐/ ,/ 犑/ τ/ ,/ S/ )/ P/ (/ τ/ )/ P/ (/ S/ )/ (/ 2/ )/ 假设/ S/ 和/ τ/ 独立/ ,/ P/ (/ 犐/ ,/ 犑/ |/ τ/ ,/ S/ )/ 是/ 似然/ 项/ ,/ P/ (/ τ/ )/ 是/ 变形/ 场/ τ/ 的/ 先验/ ,/ P/ (/ S/ )/ 是/ 灰度/ 偏移/ 场/ S/ 的/ 先验/ ,/ 一般/ 可用/ P/ (/ S/ )/ ∝/ e/ -/ β/ 犘/ 犛/ E/ (/ 犛/ ,/ τ/ )/ =/ 犐/ -/ 犑/ (/ τ/ )/ -/ 犛/ 2/ +/ β/ 犘/ 犛/ 2/ (/ 3/ )/ 其中/ ,/ 犐/ ,/ 犑/ ,/ 犛/ 分别/ 为/ 参考/ 图像/ 、/ 浮动/ 图像/ 、/ 灰度/ 偏移/ 场/ 的/ 矢量/ 表示/ ./ 计算/ 式/ (/ 3/ )/ 关于/ 犛的/ 导数/ 并置/ 为/ 0/ ,/ 可以/ 求取/ 灰度/ 偏移/ 场/ 犛/ ,/ 并/ 将/ 犛/ 代入/ 式/ (/ 3/ )/ ,/ 得/ 其中/ 犐/ 犱/ 为/ 单位矩阵/ ,/ 狉/ =/ 犐/ -/ 犑/ (/ τ/ )/ 为/ 残差/ 图像/ ./ 由于/ 方阵/ 犘/ 犘/ T/ 对称/ 且/ 半/ 正定/ ,/ 所以/ 可以/ 进行/ 谱/ 分解/ 犘/ T/ 犘/ =/ 犙/ Λ/ 犙/ T/ ,/ Λ/ =/ d/ [/ λ/ 1/ ,/ …/ ,/ λ/ N/ ]/ ,/ λ/ i/ / 0/ ,/ 则/ 其中/ :/ d/ (/ )/ 表示/ 对角/ 矩阵/ ,/ 犃/ =/ 犙/ 犔/ 犙/ T/ ,/ 犔/ =/ d/ (/ l1/ ,/ …/ ,/ lN/ )/ =/ d/ (/ β/ λ/ i/ // 1/ +/ β/ λ/ i/ )/ ,/ 1/ / li/ / 0/ ./ 算子/ 犘/ 犘/ T/ 有/ 相同/ 的/ 特征向量/ 基/ 犙/ 、/ 不同/ 的/ 特征值/ ./ 我们/ 使用/ DCT/ 作为/ 特征向量/ 的/ 基/ ./ 因为/ 犔/ 是/ λ/ 的/ 函数/ ,/ 由此/ 当/ 犔/ 为/ 单位矩阵/ 时/ ,/ E/ (/ 犔/ ,/ τ/ )/ =/ 狉/ 2/ 即为/ SSD/ 测度/ ,/ 这/ 等价/ 于/ 对/ 灰度/ 偏移/ 场/ 犛不/ 施加/ 任何/ 约束/ ./ 当/ 犔/ 为/ 零/ 矩阵/ 时/ ,/ 目标/ 函数/ E/ 获得/ 了/ 我们/ 并/ 不感兴趣/ 的/ 最小值/ ./ 为了/ 避免/ 上述情况/ 的/ 发生/ ,/ 对/ 犔/ 施加/ 约束/ Page3/ 其中/ R/ (/ 犔/ )/ =/ -/ ∑/ i/ [/ 狇/ 1/ ,/ …/ ,/ 狇/ N/ ]/ ,/ 狇/ i/ 为/ 特征向量/ ./ 对/ 目标/ 函数/ (/ 7/ )/ 求取/ 关于/ 犔/ 的/ 导数/ ,/ 并置/ 为/ 0/ ,/ 可以/ 得到/ 犔/ 的/ 表达式/ ,/ 将/ 其/ 代入/ 式/ (/ 6/ )/ ,/ 可/ 得/ 基于/ RC/ 的/ 相似性/ 测度/ 的/ 表达式/ :/ E/ (/ τ/ )/ =/ -/ ∑/ 3/ 基于/ 局部/ 方差/ 与/ 残差/ 复杂性/ 的/ 图像/ 配准/ 3.1/ 局部/ 方差/ 图像/ 的/ 局部/ 方差/ [/ 14/ ]/ ,/ 可以/ 表示/ 图像/ 局部/ 区域/ 中/ 各个/ 像素/ 之间/ 的/ 关系/ ,/ 体现/ 了/ 图像/ 的/ 结构/ 信息/ ./ 图像/ 犐/ 的/ 局部/ 方差/ 可以/ 表示/ 为/ V/ (/ x/ ,/ y/ ,/ z/ )/ =/ R/ 为/ 计算/ 局部/ 方差/ 的/ 邻域/ 半径/ ,/ N/ =/ (/ 2R/ +/ 1/ )/ ×/ (/ 2R/ +/ 1/ )/ ×/ (/ 2R/ +/ 1/ )/ 为/ 邻域/ 大小/ ,/ 图/ 1/ 显示/ 了/ 一幅/ 脑部/ MR/ 图像/ 在/ 邻域/ 大小/ 为/ N/ =/ 3/ ×/ 3/ 、/ N/ =/ 5/ ×/ 5/ 、/ N/ =/ 7/ ×/ 7/ 下/ 的/ 局部/ 方差/ 图/ ./ 图/ 1/ 脑部/ MR/ 图/ 在/ 不同/ 邻域/ 大小/ 下/ 的/ 局部/ 方差/ 图匀/ 质/ 区域/ 内/ 局部/ 方差/ 小/ ,/ 非匀/ 质/ 区域/ 处/ 的/ 局部/ 方差/ 大/ ./ N/ 较/ 小时/ ,/ 局部/ 方差/ 图/ 包含/ 的/ 图像/ 信息/ 更/ 清楚/ 、/ 更/ 丰富/ ;/ N/ 较大/ 时/ ,/ 局部/ 方差/ 图/ 包含/ 的/ 图像/ 信息/ 相对/ 模糊/ ./ N/ 会/ 影响/ 局部/ 方差/ 图/ 的/ 平滑/ 性/ ./ 3.2/ 基于/ 局部/ 方差/ 与/ 残差/ 复杂性/ 的/ 相似性/ 测度/ 统计学/ 中/ ,/ 出格/ 点/ 被/ 认为/ 是/ 一组/ 数据/ 中/ 的/ 离群/ 点/ ,/ 容易/ 对/ 统计/ 产生/ 负面影响/ ,/ 使得/ 统计/ 结果/ 受到/ 严重/ 挑战/ ./ 鲁棒/ 估计/ 最初/ 源于/ 鲁棒/ 统计学/ ,/ 主要/ 研究/ 能够/ 容忍/ 一定量/ 离群/ 数据/ 的/ 方法/ ,/ 即当/ 观测/ 数据/ 中/ ,/ 部分/ 样本/ 不/ 符合/ 统计/ 模型/ 假设/ 时/ ,/ 如何/ 保证/ 参数估计/ 和/ 统计/ 推断/ 的/ 准确性/ ./ 传统/ 的/ 鲁棒/ 估计/ 有/ M/ -/ 估计/ 、/ LMedS/ 估计/ 、/ LTS/ 估计/ 、/ MCD/ 估计/ 等/ ./ 其中/ ,/ M/ -/ 估计/ 在/ 运动/ 估计/ 中/ 应用/ 的/ 基本/ 思想/ 是/ 通过/ 选择/ 不同/ 的/ 损失/ 函数/ 实现/ 加权/ 最小/ 二乘/ 估计/ ,/ 抑制/ 离群/ 数据/ 的/ 影响/ ,/ 从而/ 实现/ 鲁棒/ 估计/ ./ 图/ 2/ (/ a/ )/ 、/ (/ b/ )/ 为/ 待/ 配准/ 的/ 两幅/ 乳腺/ 图像/ ,/ 图/ 2/ (/ c/ )/ 为/ 图/ (/ a/ )/ 与/ 图/ (/ b/ )/ 的/ 残差/ 图像/ ./ 对照/ 图/ 2/ 右侧/ 的/ 灰度/ 条/ 可知/ :/ 在/ 残差/ 图像/ 中/ ,/ 像素/ 的/ 亮度/ 越亮/ (/ 越/ 接近/ 灰度/ 条中/ 200/ )/ 或/ 越暗/ (/ 越/ 接近/ 灰度/ 条中/ -/ 200/ )/ 表示/ 残差/ 值越/ 大/ ,/ 像素/ 的/ 亮度/ 越灰/ (/ 越/ 接近/ 灰度/ 条中/ 0/ )/ 表示/ 残差/ 值越/ 小/ ./ 观察/ 图/ (/ c/ )/ ,/ 不难/ 发现/ :/ 在/ 残差/ 图像/ 中/ ,/ 未/ 配准/ 区域/ 的/ 残差/ 值/ 较大/ ./ 残差/ 图像/ 中/ 残差/ 值/ 较大/ 的/ 像素点/ 通常/ 可以/ 视为/ 出格/ 点/ 或者/ 噪声/ 点/ ./ 为了/ 抑制/ 出格/ 点/ 或/ 噪声/ 的/ 影响/ ,/ 受/ M/ 估计/ 的/ 启发/ ,/ 我们/ 需要/ 设计/ 一个/ 权重/ 函数/ ,/ 该/ 函数/ 可以/ 容忍/ 大/ 的/ 残差/ 值/ ,/ 可以/ 使用/ 不同/ 的/ 函数/ 值来/ 加权/ 不同/ 像素/ 的/ 残差/ 值/ ./ 当/ 残差/ 值/ 较大/ 时/ ,/ 权重/ 函数/ 值较/ 小/ ,/ 当/ 残差/ 值/ 误差/ 较/ 小时/ ,/ 权重/ 函数/ 的/ 值/ 相对/ 较大/ ./ 也就是说/ ,/ 对于/ 出格/ 点/ 或者/ 噪声/ 点/ ,/ 权重/ 函数/ 给予/ 较/ 小/ 的/ 惩/ Page4/ 罚/ 约束/ ,/ 对于/ 其余/ 点则/ 给予/ 相对/ 大/ 的/ 惩罚/ 约束/ ./ 另外/ ,/ 我们/ 发现/ 未/ 配准/ 区域/ 的/ 残差/ 值/ 比较/ 大/ ,/ 对应/ 着/ 局部/ 方差/ 比较/ 大/ 的/ 区域/ ./ 由于/ 图像/ 的/ 局部/ 方差/ ,/ 可以/ 表示/ 图像/ 局部/ 区域/ 中/ 各个/ 像素/ 之间/ 的/ 关系/ ,/ 体现/ 了/ 图像/ 的/ 结构/ 信息/ ./ 因而/ ,/ 我们/ 可以/ 充分利用/ 图像/ 自身/ 的/ 信息/ 构造/ 权重/ 函数/ ,/ 以此/ 来自/ 适应/ 地/ 加权/ 残差/ 图像/ 中/ 的/ 像素/ 灰度/ 值/ ./ 为了/ 满足/ 上述/ 的/ 自/ 适应/ 的/ 加权/ 法则/ ,/ 我们/ 引入/ 局部/ 方差/ ,/ 利用/ 指数函数/ 构造/ 权重/ 函数/ :/ V/ (/ x/ ,/ y/ ,/ z/ )/ / 0/ ,/ 显然/ ,/ 0/ </ ω/ (/ x/ ,/ y/ ,/ z/ )/ / 1/ ,/ m/ ×/ n/ ×/ s/ 为/ 图像/ 体素/ 的/ 数量/ ./ 用/ p/ =/ V/ (/ x/ ,/ y/ ,/ z/ )/ ∑/ V/ (/ x/ ,/ y/ ,/ z/ )/ 来/ 表示/ 归一化/ 的/ 局部/ 方差/ ./ 由于/ 归一化/ 的/ 局部/ 方差/ p/ 的/ 取值/ 普遍/ 偏小/ ,/ 使得/ ω/ 的/ 取值/ 过于/ 集中/ ,/ 将/ 导致/ 残差/ 图像/ 中/ 不同/ 灰度/ 值/ 的/ 加权/ 值/ 非常/ 相近/ ,/ 这/ 与/ 实际/ 情况/ 相/ 违背/ ./ 因而/ ,/ 我们/ 加入/ 系数/ ε/ 来/ 调节/ 权重/ ω/ 范围/ 的/ 参数/ ./ 则/ 实验/ 中取/ 经验值/ ω/ =/ 0.01/ ,/ 使得/ 归一化/ 后/ ω/ 的/ 最小值/ 接近/ 于/ 0/ ,/ 而/ 最大值/ 接近/ 于/ 1/ ./ 由此/ ,/ 将式/ (/ 12/ )/ 代入/ 式/ (/ 8/ )/ 中/ ,/ 得到/ 新/ 的/ 相似性/ 测度/ (/ LVRC/ )/ 可以/ 表示/ 为/ E/ (/ τ/ )/ =/ -/ ∑/ 其中/ ,/ ω/ 为/ 权重/ 矩阵/ ,/ ω/ (/ x/ ,/ y/ ,/ z/ )/ 是/ ω/ 的/ 元素/ ./ 比较/ 式/ (/ 8/ )/ 与/ 式/ (/ 13/ )/ ,/ 不难/ 发现/ ,/ 式/ (/ 8/ )/ 没有/ 使用/ 加权/ 函数/ ω/ 来/ 加权/ 残差/ 图像/ ,/ 即/ 残差/ 图像/ 所有/ 体素/ 的/ 灰度/ 值图/ 4/ 不同/ 相似性/ 测度/ 的/ 曲线/ 的/ 权值/ 均/ 为/ ω/ =/ 1/ ./ 如果/ 对/ 残差/ 图像/ 中/ 出格/ 点/ 或者/ 噪声/ 点/ 分配/ 的/ 权值/ 等同于/ 对/ 残差/ 图像/ 中/ 其它/ 体素/ 分配/ 的/ 权值/ ,/ 则/ 会/ 扩大/ 出格/ 点/ 或/ 噪声/ 点/ 对/ 目标/ 函数/ 的/ 影响/ ./ 因此/ ,/ 本文/ 引入/ 一个/ 由/ 局部/ 方差/ 构造/ 的/ 加权/ 项来/ 有效/ 地/ 解决/ 上述/ 问题/ ./ 为了/ 减少/ 出格/ 点/ 或/ 噪声/ 点/ 对/ 目标/ 函数/ 的/ 影响/ ,/ 当/ 残差/ 图像/ 中体素/ 的/ 灰度/ 值/ 较大/ 时/ ,/ 加权/ 函数/ 分配/ 其较/ 小/ 的/ 权值/ ,/ 反之/ ,/ 残差/ 图像/ 中体素/ 的/ 灰度/ 值较/ 小时/ ,/ 加权/ 函数/ 给予/ 其/ 较大/ 的/ 权值/ ./ 下面/ 是/ 一组/ 明暗/ 不/ 均匀/ 的/ 灰度/ 带/ 图像/ ,/ 分别/ 使用/ SAD/ 、/ MI/ 、/ RC/ 以及/ LVRC/ 测度/ 进行/ 图像/ 配准/ 的/ 对比/ 实验/ ./ 该/ 实验/ 旨在/ 说明/ 相似性/ 测度/ 的/ 特性/ ./ 图/ 3/ (/ a/ )/ 为/ 参考/ 图像/ ,/ 对图/ 3/ (/ a/ )/ 对称/ 裁剪/ ,/ 并/ 施加/ 灰度/ 不/ 均匀/ 场/ 得到/ 图/ 3/ (/ b/ )/ ,/ 定义/ 其为/ 浮动/ 图像/ ./ 先/ 将/ 浮动/ 图像/ 图/ 沿着/ x/ 轴/ 平移/ -/ 50/ ~/ 50/ 像素/ ,/ 再/ 计算/ 相似性/ 测度/ ./ 显然/ ,/ 当/ 浮动/ 图像/ 平移/ 0/ 个/ 像素/ 时/ ,/ 两幅/ 图像/ 达到/ 完全/ 配准/ ./ SAD/ 、/ RC/ 、/ LVRC/ 值/ 达到/ 最小/ ,/ MI/ 值/ 达到/ 最大/ ./ 图/ 4/ 描绘/ 了/ 使用/ 不同/ 相似性/ 测度/ 的/ 曲线图/ ,/ 显/ Page5/ 然/ SAD/ 和/ MI/ 均/ 不能/ 在/ 两幅/ 图像/ 正确/ 配/ 准时/ 达到/ 最值/ ;/ RC/ 值/ 和/ LVRC/ 值/ 在/ 浮动/ 图像/ 平移/ 的/ 像素/ 为/ 零时/ ,/ 曲线/ 值均/ 达到/ 最小/ ,/ 但/ RC/ 不够/ 平滑/ ,/ 且/ 多处/ 出现/ 局部/ 极小值/ ,/ 而/ LVRC/ 曲线/ 平滑/ 性好/ ,/ 无/ 局部/ 极小值/ ./ 3.3/ 基于/ 局部/ 方差/ 与/ 残差/ 复杂性/ 图像/ 配准/ 本文/ 使用/ 自由/ 形变/ 模型/ (/ Free/ -/ FormDeforma/ -/ tion/ ,/ FFD/ )/ 建模/ 变形/ 场/ T/ [/ 15/ ]/ ,/ FFD/ 是/ 一种/ 空间/ 变换/ 模型/ ,/ 通过/ 先/ 求取/ 网格/ 控制点/ 处/ 的/ 位移/ 量/ ,/ 再/ 使用/ B/ 样条/ 插值/ 求得/ 图像/ 中/ 每个/ 像素点/ 的/ 位移/ 量/ 而/ 获取/ 变换/ 后/ 的/ 浮动/ 图像/ ./ 浮动/ 图像/ 犑/ 中/ 任意/ 一个/ 体素点/ (/ x/ ,/ y/ ,/ z/ )/ 的/ 形变/ 可以/ 通过/ B/ 样条/ 加权/ 相邻/ 的/ 4/ ×/ 4/ ×/ 4/ 控制点/ 的/ 位置/ 来/ 表示/ :/ l/ =/ 0/ ∑/ τ/ (/ 狓/ )/ =/ ∑/ φ/ 为/ 控制点/ 的/ 位置/ ,/ 网格/ 大小/ 为/ nx/ ×/ ny/ ×/ nz/ ./ Bl/ 是/ B/ 样条/ 的/ 的/ 第/ l/ 个基/ 函数/ ./ i/ =/ x/ // nx/ -/ 1/ ,/ j/ =/ y/ // ny/ -/ 1/ ,/ k/ =/ z/ // nz/ -/ 1/ ,/ u/ =/ x/ // nx/ -/ x/ // nx/ ,/ v/ =/ y/ // ny/ -/ y/ // ny/ ,/ w/ =/ z/ // nz/ -/ z/ // nz/ ./ 本文/ 选用/ 梯度/ 下降/ 法/ 迭代/ 地/ 优化/ 目标/ 函数/ ,/ 进而/ 更新/ 变形/ 场/ ./ 我们/ 提出/ 的/ LVRC/ 的/ 导数/ 表达式/ 如下/ :/ / E/ =/ -/ 狇/ -/ 12/ 狇/ (/ 狉/ ω/ )/ // α/ 其中/ :/ 狇/ 和/ 狇/ -/ 1/ 分别/ 表示/ 正向/ 和/ 逆向/ 的/ 离散/ 余弦/ 换/ ;/ / 犑/ 为/ 浮动/ 图像/ 的/ 梯度/ ;/ θ/ 表示/ 变换/ 参数/ ;/ α/ 为/ 约束/ 犔/ 的/ 权重/ ,/ 见式/ (/ 7/ )/ ./ 本文/ 提出/ 的/ 基于/ LVRC/ 的/ 算法/ 的/ 流程/ 如图/ 5/ 所示/ ./ 首先/ ,/ 计算/ 参考/ 图像/ 的/ 局部/ 方差/ 图/ ,/ 利用/ 该/ 局部/ 方差/ 图/ 构造/ 指数函数/ 形式/ 的/ 加权/ 函数/ ./ 再/ 计算/ 参考/ 图像/ 和/ 浮动/ 图像/ 之间/ 的/ 残差/ 图像/ ./ 使用/ 加权/ 函数/ 自/ 适应/ 地/ 加权/ 参考/ 图像/ 和/ 浮动/ 图像/ 之间/ 的/ 残差/ 图像/ ,/ 从而/ 得到/ 本文/ 提出/ 的/ 相似性/ 测度/ LVRC/ ./ 本文/ 利用/ 梯度/ 下降/ 法/ 迭代/ 地/ 更新/ 变形/ 场/ ,/ 再/ 使用/ FFD/ 变换/ 更新/ 浮动/ 图像/ ./ 如此/ 循环/ ,/ 直到/ 得到/ 最优/ 的/ 变形/ 场/ ,/ 最终/ 输出/ 变形/ 后/ 的/ 浮动/ 图像/ ./ 为/ 提高/ 计算/ 效率/ ,/ 避免/ 陷入/ 局部/ 极值/ ,/ 采用/ 多/ 分辨率/ 技术/ 优化/ 配准/ 过程/ ./ 在/ 当前/ 水平/ 获得/ 的/ 变形/ 参数值/ 将/ 作为/ 下/ 一/ 水平/ 参数/ 的/ 初始值/ ./ 由于/ 在/ 一个/ 分辨率/ 水平/ 下/ ,/ 参考/ 图像/ 不变/ ,/ 所以/ 参考/ 图像/ 的/ 局部/ 方差/ 图/ 只/ 需/ 计算/ 一次/ ./ 图/ 5/ 的/ 虚/ 线框/ 表示/ 每次/ 迭代/ 所/ 包含/ 的/ 步骤/ ./ 4/ 实验/ 结果/ 和/ 分析/ 为了/ 验证/ LVRC/ 具有/ 对/ 参数值/ 不/ 敏感/ 、/ 抗噪/ 能力/ 强/ 、/ 鲁棒性/ 好/ 等/ 特点/ ,/ 我们/ 用/ Matlab7/ ./ 12.0/ 在/ PC机/ (/ IntelCore2QuadCPU2/ ./ 33GHz/ ,/ 8GB/ 内存/ )/ 上/ 进行/ 实验/ ,/ 并/ 与/ MI/ 和/ RC/ 进行/ 了/ 比较/ ./ 定义/ 绝对/ 残差/ 图像/ 为/ 配准/ 后/ 两幅/ 图像/ 相减/ 后/ 的/ 绝对值/ ./ 为了/ 评估/ 配准/ 效果/ ,/ 我们/ 以配/ 准后/ 两副/ 图像/ 的/ 互信息/ MI/ 、/ 绝对/ 残差/ 图像/ 的/ 均值/ μ/ 和/ 方差/ σ/ 作为/ 评价/ 标准/ ./ 为了/ 避免/ 混淆/ ,/ 用/ MIsim/ 表示/ 配准/ 后/ 两幅/ 图像/ 的/ 互信息/ ./ μ/ 、/ σ/ 的/ 值/ 越/ 小/ ,/ 表明/ 配准/ 的/ 精确度/ 越高/ ,/ 反之/ ,/ 配准/ 效果/ 越差/ ./ 若/ MIsim/ 的/ 值/ 越/ 大/ ,/ 则/ 参考/ 图像/ 和/ 最终/ 变换/ 后/ 的/ 浮动/ 图像/ 间/ 的/ 相似/ 程度/ 越大/ ,/ 即/ 配准/ 效果/ 越/ 好/ ,/ 反之亦然/ ./ 实验/ 1/ ./ 噪声/ 和/ 灰度/ 偏移/ 场/ 对/ 配准/ 的/ 影响/ ./ 实验/ 选用/ 源于/ BrainWeb/ ①/ 的/ 脑部/ MR/ 数据/ ./ 我们/ 对/ 其/ 进行/ 人工/ 形变/ 并/ 施加/ 灰度/ 不/ 均匀/ 场/ 和/ 不同/ 程度/ 的/ 高斯/ 噪声/ ./ 图/ 6/ 显示/ 了/ 待/ 配准/ 的/ 两组/ 图像/ ./ 图/ 6/ ①/ http/ :/ // // mouldy/ ./ bic/ ./ mni/ ./ mcgill/ ./ ca/ // brainweb/ // Page6/ (/ a/ )/ 、/ (/ b/ )/ 为/ 第/ 1/ 组待/ 配准/ 的/ 两幅/ 图像/ ,/ 其中/ 图/ 6/ (/ a/ )/ 是/ 加入/ 均值/ 为/ 0/ 、/ 方差/ 为/ 0.01/ 的/ 高斯/ 噪声/ 后/ 的/ 脑部/ 图像/ ,/ 图/ 6/ (/ b/ )/ 是/ 加入/ 均值/ 为/ 0/ 、/ 方差/ 为/ 0.001/ 的/ 高斯/ 噪声/ 后/ 的/ 非/ 均匀/ 脑部/ 图像/ ./ 图像/ 6/ (/ c/ )/ 、/ (/ d/ )/ 为/ 第/ 2/ 组待/ 配准/ 的/ 两幅/ 图像/ ,/ 均/ 是/ 加入/ 均值/ 为/ 0/ 、/ 方差/ 为/ 0.001/ 的/ 高斯/ 噪声/ 后/ 的/ 明暗/ 不/ 均匀/ 的/ 脑部/ 图像/ ./ 我们/ 将/ 图/ 6/ (/ a/ )/ 、/ (/ c/ )/ 作为/ 参考/ 图像/ ,/ 图/ 6/ (/ c/ )/ 、/ (/ d/ )/ 作为/ 浮动/ 图像/ ./ 分别/ 使用/ MI/ 、/ RC/ 、/ LVRC/ 这/ 3/ 种/ 测度/ 进行/ 配准/ 对比/ 实验/ ./ 第/ 1/ 组/ 实验/ 的/ 参数/ 取值/ 为/ α/ =/ 0.8/ ,/ 网格/ 间距/ δ/ =/ 8/ ,/ 第/ 2/ 组/ 实验/ 的/ 参数/ 取值/ 为/ α/ =/ 0.6/ ,/ δ/ =/ 7/ ./ 图/ 7/ 的/ 两列/ 分别/ 对应/ 两组/ 实验/ 的/ 结果/ ,/ 3/ 行/ 分别/ 对应/ 使用/ MI/ 、/ RC/ 、/ LVRC/ 方法/ 配准/ 后/ 的/ 结果/ 图/ ,/ 包括/ 变换/ 后/ (/ 配准/ 后/ )/ 的/ 浮动/ 图像/ 和/ 形变/ 网格/ ./ 观察/ 第/ 1/ 组/ 实验/ 结果/ 发现/ :/ 使用/ MI/ 测度/ 后/ 的/ 浮动/ 图像/ 在/ 脑部/ 多处/ 均/ 未/ 配准/ ,/ 且/ 形变/ 网格/ 出现/ 大/ 的/ 折叠/ 现象/ ;/ 使用/ 图/ 73/ 种/ 方法/ 配准/ 后/ 的/ 浮动/ 图像/ 和/ 形变/ 网格/ 实验/ 2/ ./ 局部/ 方差/ 邻域/ 尺度/ 对/ 配准/ 的/ 影响/ ./ 本/ 实验/ 旨在/ 验证/ 局部/ 方差/ 的/ 邻域/ 尺度/ N/ 是否/ 会/ 对/ 局部/ 方差/ 产生/ 影响/ ./ 图/ 8/ 为/ 两组/ 真实/ 的/ 乳腺/ 动态/ 增强/ 磁共振/ 图像/ (/ DCE/ -/ MRI/ )/ ./ 图/ 8/ (/ a/ )/ 、/ (/ b/ )/ 分别/ 对应/ 病人/ 1/ 在/ 增强/ 后/ 不同/ 时间/ 的/ 乳腺/ 图像/ ,/ 图/ 8/ (/ c/ )/ 、/ RC/ 的/ 只/ 在/ 脑桥/ 处/ 没有/ 配准/ ,/ 且/ 形变/ 网格/ 在/ 小/ 范围/ 内/ 出现/ 折叠/ 现象/ ,/ 而/ 使用/ LVRC/ 的/ 在/ 脑部/ 各处/ 均配/ 准且/ 形变/ 网格/ 光滑/ ,/ 并未/ 出现/ 折叠/ 现象/ ./ 观察/ 第/ 2/ 组/ 的/ 实验/ 结果/ 发现/ :/ 使用/ MI/ 后/ 的/ 浮动/ 图像/ 完全/ 误配/ ,/ 且/ 形变/ 网格/ 出现/ 大规模/ 的/ 折叠/ 现象/ ;/ 使用/ RC/ 后/ 的/ 在/ 直回/ 、/ 眶/ 回/ 、/ 眶/ 内/ 眼球/ 和/ 脑壳/ 处/ 没有/ 配准/ ,/ 形变/ 网格/ 在/ 小/ 范围/ 内/ 出现/ 折叠/ 现象/ ;/ 而/ 使用/ LVRC/ 的/ 方法/ 在/ 脑部/ 各处/ 均配/ 准且/ 形变/ 网格/ 光滑/ ,/ 未/ 出现/ 折叠/ 现象/ ./ 这是/ 由于/ MI/ 对/ 噪声/ 敏感/ ,/ 易受/ 明暗/ 不/ 均匀/ 性/ 的/ 影响/ ;/ RC/ 可以/ 自/ 适应/ 地/ 约束/ 灰度/ 偏移/ 场/ ,/ 所以/ 配准/ 结果/ 比/ MI/ 有所提高/ ,/ 但/ 该/ 方法/ 的/ 鲁棒性/ 差/ ,/ 如图/ 7/ 中/ 的/ 第/ 2/ 行/ ,/ 形变/ 网格/ 出现/ 折叠/ 现象/ ./ 而/ 本文/ 算法/ 利用/ 参考/ 图像/ 的/ 局部/ 方差/ 信息/ ,/ 针对/ 残差/ 图像/ 自身/ 的/ 特征/ 赋予/ 不同/ 的/ 权重/ ,/ 使得/ 配准/ 效果/ 明显/ 提升/ ./ 可见/ MI/ 不/ 适合/ 处理/ 明暗/ 不/ 均匀/ 图像/ ,/ 而/ LVRC/ 优于/ RC/ 配准/ ./ (/ d/ )/ 分别/ 对应/ 病人/ 2/ 在/ 增强/ 后/ 不同/ 时间/ 的/ 乳腺/ 图像/ ./ 由于/ 增强/ 后/ ,/ 造影剂/ 会/ 逐渐/ 地被/ 人体/ 代谢/ ,/ 因此/ 可/ 将/ 增强/ 后/ 不同/ 时间/ 的/ 图像/ 视为/ 明暗/ 不/ 均匀/ 的/ 图像/ ./ 定义/ 图/ 8/ (/ a/ )/ 、/ (/ c/ )/ 为/ 参考/ 图像/ ,/ 图/ 8/ (/ b/ )/ 、/ (/ d/ )/ 为/ 浮动/ 图像/ ./ 该/ 实验/ 使用/ LVRC/ 在/ N/ =/ 3/ ×/ 3/ ,/ N/ =/ 5/ ×/ 5/ ,/ N/ =/ Page77/ ×/ 7/ 下/ ,/ 对/ 这/ 两组/ 乳腺/ DCE/ -/ MRI/ 进行/ 配准/ ./ 图/ 9/ 两组/ 实验/ 在/ 不同/ 邻域/ 尺度/ 下/ 配准/ 结果/ 图/ 10/ 不同/ 邻域/ 尺度/ 下/ 的/ 局部/ 方差/ 的/ 配准/ 结果/ 本/ 实验/ 中/ ,/ 图/ 9/ 显示/ 了/ 3/ 个/ 不同/ 的/ 邻域/ 尺度/ 下/ ,/ 使用/ LVRC/ 配准/ 前后/ 的/ 绝对/ 残差/ 图/ ./ 第/ 1/ 行为/ 使用/ 病人/ 1/ 的/ 图像/ 进行/ 实验/ 的/ 结果/ 图/ ,/ 第/ 2/ 行为/ 使用/ 病人/ 2/ 的/ 图像/ 进行/ 实验/ 的/ 结果/ 图/ ./ 显然/ ,/ 使用/ LVRC/ 配准/ 可以/ 提高/ 配准/ 精确度/ ./ 然而/ ,/ 计算/ 局部/ 方差/ 选用/ 的/ 邻域/ 尺度/ 对/ 配准/ 结果/ 并/ 无太大/ 影响/ ./ 为了/ 更/ 准确/ 地/ 分析/ 邻域/ 尺度/ 是否/ 对/ 配准/ 结果/ 有/ 影响/ ,/ 我们/ 对/ 两组/ 实验/ 结果/ 进行/ 了/ 关于/ μ/ 和/ MIsim/ 的/ 定量分析/ ./ 图/ 10/ (/ a/ )/ 中/ 病人/ 1/ 、/ 病人/ 2/ 分别/ 对应/ 上述/ 两组/ 实验/ ,/ 柱状图/ 中/ ,/ 纹理/ “/ \/ ”/ 表示/ 配准/ 前/ 的/ μ/ ,/ 纹理/ “/ -/ ”/ 、/ “/ ×/ ”/ 、/ “/ ·/ ”/ 分别/ 对应/ 3/ 个/ 邻域/ 尺度/ 下/ 的/ μ/ ./ 显然/ 使用/ LVRC/ 后/ 的/ 配准/ 结果/ 比配/ 准前/ 有/ 很大/ 提高/ ./ 另外/ ,/ 当/ 邻域/ 尺度/ N/ 改变/ 时/ ,/ μ/ 和/ MIsim/ 数值/ 变化/ 的/ 数量级/ 范围/ 在/ [/ 10/ -/ 2/ ,/ 10/ -/ 3/ ]/ ,/ 即/ 取值/ 非常/ 接近/ ,/ 因而/ 在/ 实际/ 中/ 可以/ 忽略不计/ ./ 由此/ 可以/ 看出/ ,/ 无论/ 从/ 定性/ 还是/ 定量/ 上/ 分析/ ,/ 局部/ 方差/ 的/ 邻域/ 尺度/ 对/ 图像/ 配准/ 的/ 结果/ 并/ 无太大/ 影响/ ./ Page8/ 实验/ 3/ ./ 网格/ 间距/ 对/ 配准/ 结果/ 的/ 影响/ ./ 本/ 实验/ 采用/ 乳腺/ DCE/ -/ MRI/ ,/ 如图/ 11/ (/ a/ )/ ,/ 定义/ 其为/ 参考/ 图像/ ./ 对/ 该/ 图像/ 进行/ 人工/ 变形/ 并/ 施加/ 少量/ 不/ 均匀/ 性/ ,/ 将/ 此/ 图像/ 定义/ 为/ 浮动/ 图像/ ,/ 见图/ 11/ (/ b/ )/ ./ 分别/ 使用/ RC/ 和/ LVRC/ 在/ δ/ =/ 6/ 和/ δ/ =/ 10/ 时/ 进行/ 图像/ 配准/ ,/ 采用/ N/ =/ 3/ ×/ 3/ ./ 本/ 部分/ 的/ 所有/ 实验/ 均/ 使用/ 相同/ 的/ 参数/ α/ =/ 0.05/ ./ 图/ 12/ 的/ 第/ 1/ 行/ 、/ 第/ 2/ 行/ 分别/ 显示/ 了/ δ/ =/ 6/ ,/ δ/ =/ 10/ 的/ 配准/ 结果/ ./ 图/ 12/ (/ a/ )/ 、/ (/ c/ )/ 分别/ 为/ 使用/ RC/ 配准/ 后/ 输出/ 的/ 浮动/ 图像/ 和/ 形变/ 网格/ ,/ 图/ 12/ (/ b/ )/ 、/ (/ d/ )/ 分别/ 为/ 使用/ LVRC/ 配准/ 后/ 输出/ 的/ 浮动/ 图像/ 和/ 形变/ 网格/ ./ 当/ 网格/ 间距/ δ/ =/ 6/ ,/ 使用/ RC/ 配准/ 后/ 的/ 浮动/ 图像/ 在/ 多处/ 未/ 配准/ ,/ 且/ 最终/ 的/ 形变/ 网格/ 也/ 出现/ 不同/ 程度/ 的/ 折图/ 12/ 不同/ 网格/ 大小/ 的/ 配准/ 结果/ 我们/ 在/ 不同/ 网格/ 间距/ 下/ ,/ 分别/ 使用/ RC/ 和/ LVRC/ 对/ 配准/ 结果/ 进行/ 统计/ ./ 包括/ μ/ ,/ σ/ ,/ MIsim/ ./ 由表/ 1/ 发现/ :/ 当/ 网格/ 间距/ 一定/ 时/ ,/ 使用/ LVRC/ 测度/ 配准/ 后/ 的/ μ/ ,/ σ/ 总是/ 要/ 比/ 使用/ RC/ 测度/ 配准/ 后/ 的/ 小/ ;/ 且/ 使用/ LVRC/ 测度/ 配准/ 后/ 的/ MIsim/ 总是/ 比/ 使用/ RC/ 测度/ 配准/ 后/ 的/ 大/ ./ 这/ 说明/ 在/ 处理/ 明暗/ 不/ 均匀/ 图像/ 时/ ,/ LVRC/ 测度/ 比/ RC/ 测度/ 更/ 有效/ ./ δ/ =/ 10/ δ/ =/ 6/ 实验/ 4/ ./ 人工/ 变形/ 的/ 2D/ 数据/ ./ 叠/ 现象/ ./ 当/ 网格/ 间距/ δ/ =/ 10/ 时/ ,/ 使用/ RC/ 测度/ 产生/ 了/ 完全/ 错误/ 的/ 配准/ ,/ 且/ 最终/ 的/ 形变/ 网格/ 也/ 出现/ 大/ 范围/ 的/ 折叠/ 现象/ ,/ 如图/ 12/ 所示/ ./ 而/ 利用/ LVRC/ 进行/ 配准/ ,/ 得到/ 的/ 形变/ 网格/ 光滑/ 、/ 无/ 折叠/ 现象/ ./ 取/ 来自/ 不同/ 病人/ 的/ 4/ 幅/ 真实/ 乳腺/ DCE/ -/ MRI/ ,/ 见图/ 13/ 的/ 首行/ (/ a/ )/ ~/ (/ d/ )/ ,/ 定义/ 其均/ 为/ 参考/ 图像/ ./ 对/ 每/ 一幅/ 图像/ 进行/ 人工/ 形变/ ,/ 并/ 施加/ 少量/ 灰度/ 不/ 均匀/ 性/ 得到/ 4/ 幅/ 形变/ 图像/ ,/ 定义/ 其均/ 为/ 浮动/ 图像/ ,/ 见图/ 13/ 末行/ (/ e/ )/ ~/ (/ h/ )/ ./ 本/ 实验/ 中/ ,/ 分别/ 使用/ MI/ 、/ RC/ 和/ LVRC/ 对/ 这/ 4/ 组/ 图像/ 进行/ 配准/ ,/ 并/ 对/ 配准/ 结果/ 作/ 了/ 定性/ 和/ 定量分析/ ./ 本/ 实验/ 中/ ,/ 配准/ 前/ 两组/ 图像/ 时/ α/ =/ 0.05/ ,/ δ/ =/ 6/ ,/ 配准/ 第/ 3/ 组/ 图像/ 和/ 第/ 4/ 组/ 图像/ 的/ 参数/ 分别/ 为/ α/ =/ 0.9/ ,/ δ/ =/ 8/ 和/ α/ =/ 0.5/ ,/ δ/ =/ 6/ ./ 图/ 14/ 中/ 每/ 一/ 列为/ 使用/ 3/ 种/ 测度/ 配准/ 一组/ 图像/ 后/ 的/ 实验/ 结果/ ;/ 每/ 一行/ 代表/ 使用/ 一种/ 相似性/ 测度/ 配准/ 后/ 产生/ 的/ 残差/ 图像/ ,/ 从/ 第/ 1/ 行到/ 第/ 3/ 行/ 依次/ 为/ MI/ 、/ RC/ 、/ LVRC/ ./ 由/ 右边/ 的/ 颜色/ 条知/ ,/ 如果/ 两幅/ 图像/ 成功/ 配准/ ,/ 残差/ 图像/ 的/ 灰度/ 值为/ 0/ ,/ Page9/ 否则/ 残差/ 值/ 的/ 绝对值/ 较大/ ,/ 在/ 视觉/ 上/ 表现/ 为/ 过亮/ 或/ 过/ 暗/ 的/ 像素点/ ./ 当/ 使用/ 我们/ 提出/ 的/ LVRC/ 测度/ 时/ ,/ 残差/ 图中/ 很少/ 出现/ 过量/ 或者/ 过暗/ 的/ 像素点/ ,/ 见图/ 14/ 的/ 最后/ 一行/ (/ i/ )/ ~/ (/ l/ )/ ./ 当/ 使用/ RC/ 测度/ 时/ ,/ 残差/ 图中/ 出现/ 少量/ 的/ 过亮/ 或者/ 过暗/ 的/ 像素点/ ,/ 见图/ 14/ 的/ 中间/ 一行/ (/ e/ )/ ~/ (/ h/ )/ ./ 当/ 使用/ MI/ 测度/ 时/ ,/ 残差/ 图中/ 出现/ 大量/ 的/ 过亮/ 或者/ 过暗/ 的/ 像素点/ ,/ 见图/ 14/ 的/ 第/ 1/ 行/ (/ a/ )/ ~/ (/ d/ )/ ./ 显而易见/ ,/ LVRC/ 是/ 一种/ 比/ MI/ 或/ RC/ 更/ 有效/ 的/ 相似性/ 测度/ ./ 使用/ RC/ 比/ 使用/ MI/ 配准/ 后/ 的/ 效果图/ 134/ 个/ 不同/ 病人/ 的/ 真实/ 数据/ 以及/ 人工/ 变形/ 的/ 数据/ 图/ 14/ 使用/ MI/ 、/ RC/ 、/ LVRC/ 对/ 4/ 组/ 病人/ 数据/ 配准/ 后/ 的/ 残差/ 图像/ 有所/ 提升/ ./ 另外/ ,/ 乳腺/ 图像/ 中/ 通常/ 含有/ 大量/ 的/ 噪声/ ,/ 从图/ 中/ 可以/ 明显/ 地/ 观察/ 到/ LVRC/ 对/ 噪声/ 的/ 鲁棒性/ 好/ ./ 为了/ 更/ 准确/ 地/ 反映/ 配准/ 结果/ ,/ 图/ 15/ 绘制/ 了/ 使用/ 3/ 种/ 方法/ 配准/ 后/ 的/ 绝对/ 残差/ 图/ 的/ μ/ 和/ MIsim/ ./ 显然/ ,/ 使用/ MI/ 配准/ 后/ 产生/ 的/ μ/ 最大/ ,/ 其次/ 是/ RC/ ,/ 本文/ 提出/ 的/ 测度/ 最小/ ;/ 而/ 使用/ 本文/ 测度/ 配准/ 后/ 产生/ 的/ MIsim/ 最大/ ,/ 其次/ 为/ RC/ ,/ 最后/ 为/ MI/ ;/ 这是/ 由于/ LVRC/ 考虑/ 了/ 局部/ 方差/ 信息/ ,/ 自/ 适应/ 地/ 赋予/ 残差/ 图像/ 权重/ ,/ 使得/ 配准/ 效果/ 明显/ 有所/ 提升/ ./ Page10/ 图/ 153/ 种/ 配准/ 方法/ 的/ 配准/ 结果/ 实验/ 5/ ./ 真实/ 数据/ ./ 为了/ 有效/ 地/ 帮助/ 医生/ 更多地/ 获取信息/ 来/ 准确/ 地/ 诊断/ 肝脏/ 疾病/ ,/ 常常/ 需要/ 配准/ 平扫/ 图像/ 和/ 增强/ 图像/ ./ 该/ 实验/ 取/ 3D/ 肝部/ 增强/ 数据/ 对/ LVRC/ 测度/ 进行/ 验证/ ./ 文中/ 采用/ 的/ 增强/ 前后/ 的/ 3D/ 肝脏/ 数据/ 由/ 天津医科大学/ 总医院/ 提供/ ,/ 由/ 飞利浦/ 64/ 排/ CT/ 在/ 注入/ 造影剂/ 后/ 的/ 动脉/ 期/ 和/ 静脉/ 期/ 扫描/ 获得/ ./ 图像/ 大小/ 均/ 为/ 512/ ×/ 512/ ×/ 397/ ,/ 体素/ 大小/ 为/ 0.68/ mm/ ×/ 0.68/ mm/ ×/ 0.50/ mm/ ./ 分别/ 使用/ RC/ 和/ LVRC/ 进行/ 比/ 对/ 实验/ ,/ 并/ 对/ 配准/ 结果/ 做/ 了/ 定性/ 和/ 定量分析/ ./ 分别/ 将/ 增强/ 后/ 的/ 图像/ (/ 图/ 16/ (/ a/ )/ )/ 、/ 增强/ 前/ 的/ 图像/ (/ 图/ 16/ (/ b/ )/ )/ 定义/ 为/ 参考/ 图像/ 和/ 浮动/ 图像/ ./ 该/ 实验/ 取/ 参数/ α/ =/ 0.0001/ ,/ δ/ =/ 5/ ,/ 为了/ 便于/ 观察/ ,/ 图/ 17/ 显示/ 了/ 配准/ 前后/ 的/ 三视图/ ,/ 第/ 1/ 列到/ 第/ 3/ 列图/ 173D/ 数据/ 配准/ 前后/ 的/ 绝对/ 残差/ 色图/ 分别/ 为/ 配准/ 前/ 、/ 使用/ RC/ 和/ LVRC/ 配准/ 后/ 的/ 绝对/ 残差/ 色图/ ./ 首行/ (/ 图/ 17/ (/ a/ )/ ~/ (/ c/ )/ )/ 分别/ 为/ 横断面/ 第/ 90/ 层/ 的/ 绝对/ 残差/ 色图/ ,/ 中间/ 行/ (/ 图/ 17/ (/ d/ )/ ~/ (/ f/ )/ )/ 为/ 冠状/ 面/ 的/ 第/ 64/ 层/ 绝对/ 残差/ 色图/ ,/ 末行/ (/ 图/ 17/ (/ g/ )/ ~/ (/ i/ )/ )/ 为/ 矢/ 状面/ 第/ 83/ 层/ 的/ 绝对/ 残差/ 色图/ ./ 虽然/ 使用/ RC/ 配准/ Page11/ 的/ 结果/ 比配/ 准前/ 有所提高/ ,/ 但/ 并/ 没有/ 使得/ 增强/ 前后/ 的/ 图像/ 完全/ 配准/ ,/ 具体/ 可见/ 各器官/ 的/ 边缘/ 处/ ./ LVRC/ 结合/ 参考/ 图像/ 的/ 局部/ 方差/ 信息/ ,/ 以/ 指数函数/ 的/ 形式/ 有/ 针对性/ 地/ 自动/ 约束/ 残差/ 图像/ ./ 当/ 残差/ 值/ 小时/ ,/ 赋予/ 残差/ 图像/ 大/ 的/ 权重/ ;/ 当/ 残差/ 值大时/ ,/ 赋予/ 残差/ 图像/ 小/ 的/ 权重/ ./ 从而/ 保证/ 了/ 目标/ 函数/ 的/ 鲁棒性/ ./ 同样/ 地/ ,/ 即使/ 两幅/ 图像/ 完全/ 配/ 准时/ ,/ 绝对/ 残差/ 色/ 图像/ 某些/ 区域/ 的/ 残差/ 值/ 仍然/ 不小/ ,/ 这是/ 由于/ 注入/ 造影剂/ 引起/ 的/ ./ 同样/ 地/ ,/ 我们/ 对/ 使用/ RC/ 测度/ 和/ LVRC/ 测度/ 的/ 配准/ 结果/ 进行/ 定量分析/ ,/ 包括/ 均值/ μ/ 、/ 方差/ σ/ 、/ 相似性/ MIsim/ ./ 表/ 2/ 列出/ 了/ 配准/ 前后/ 的/ 统计/ 结果/ ./ 不难/ 发现/ ,/ 使用/ RC/ 测度/ 和/ LVRC/ 测度/ 配准/ 后/ 的/ 结果/ 均/ 比配/ 准前/ 的/ 结果/ 有所提高/ ./ 在/ 数值/ 上/ 表现/ 为/ μ/ 、/ σ/ 减小/ 、/ MIsim/ 增大/ ./ 这/ 进一步/ 说明/ :/ 对于/ 明暗/ 不/ 均匀/ 图像/ 的/ 配准/ ,/ LVRC/ 是/ 一种/ 比/ RC/ 更/ 有效/ 的/ 相似性/ 测度/ ./ 配准/ 前/ RCLVRC5/ 结论/ 图像/ 的/ 局部/ 方差/ 信息/ 描述/ 了/ 局部/ 区域/ 中/ 各/ 像素/ 之间/ 的/ 关系/ ,/ 反映/ 图像/ 信息/ 的/ 丰富/ 程度/ ./ 受鲁棒/ 估计/ 的/ 启发/ ,/ 我们/ 利用/ 局部/ 方差/ 构造/ 权重/ 函数/ ,/ 在/ 图像/ 残差/ 比较/ 大/ 的/ 地方/ ,/ 给予/ 小/ 的/ 权重/ 约束/ ,/ 而/ 在/ 图像/ 残差/ 比较/ 小/ 的/ 地方/ ,/ 给予/ 大/ 的/ 权重/ 约束/ 从而/ 得到/ 新/ 的/ 相似性/ 测度/ ,/ 减少/ 了/ 出格/ 点/ 和/ 噪声/ 点/ 对/ 目标/ 函数/ 的/ 影响/ ./ 我们/ 使用/ 5/ 组/ 对比/ 实验/ 来/ 验证/ 该/ 算法/ 的/ 可行性/ ./ 结果表明/ :/ MI/ 不/ 适合/ 处理/ 非/ 均匀/ 图像/ ,/ 而/ LVRC/ 算法/ 具有/ 对/ 参数值/ 不/ 敏感/ 、/ 抗噪/ 能力/ 强/ 、/ 鲁棒性/ 好/ 等/ 特点/ ,/ 比/ RC/ 更/ 适用/ 于/ 非/ 均匀/ 医学/ 图像/ 的/ 配准/ ./ 然而/ ,/ 我们/ 对/ LVRC/ 的/ 计算/ 是/ 以/ 参考/ 图像/ 与/ 浮动/ 图像/ 之间/ 的/ 残差/ 图像/ 为/ 基础/ 的/ ./ 因而/ 本文/ 提出/ 的/ 相似性/ 测度/ 有/ 一定/ 的/ 局限性/ :/ 只/ 适用/ 于单/ 模态/ 图像/ 配准/ ./ 后续/ 工作/ 可以/ 考虑/ 将/ 该/ 方法/ 扩展/ 到/ 多/ 模态/ 图像/ 配准/ 中/ ./ 

