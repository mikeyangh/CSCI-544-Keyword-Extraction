Page1/ 一种/ 基于/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ 1/ )/ (/ 南京航空航天大学/ 计算机科学/ 与/ 技术/ 学院/ 南京/ 210016/ )/ 2/ )/ (/ 南京大学/ 计算机科学/ 与/ 技术/ 系/ 南京/ 210093/ )/ 摘要/ 错误/ 定位/ 技术/ 是/ 当前/ 的/ 研究/ 热点/ ./ 在/ 各种/ 错误/ 定位/ 方法/ 中/ ,/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ (/ NN/ 方法/ )/ [/ 1/ ]/ 从/ 成功/ 测试/ 执行/ 中/ ,/ 选择/ 与/ 已/ 发现/ 失败/ 执行/ 最/ 接近/ 的/ 一个/ ,/ 和/ 失败/ 执行/ 进行/ 比较/ ,/ 从而/ 定位/ 错误/ ./ NN/ 方法/ 是/ 一种/ 非常/ 重要/ 的/ 方法/ ,/ 然而/ ,/ 实验/ 中/ 却/ 发现/ ,/ 对于/ 一些/ 程序/ ,/ 选择/ 最/ 接近/ 的/ 成功/ 执行/ 与/ 失败/ 执行/ 进行/ 比较/ ,/ 并/ 不能/ 取得/ 好/ 的/ 错误/ 定位/ 效果/ ./ 为/ 探明/ 原因/ ,/ 文中/ 首先/ 对/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 进行/ 了/ 研究/ ,/ 指出/ 了/ NN/ 方法/ 存在/ 上述/ 问题/ 的/ 根本原因/ 是/ 在/ 选择/ 成功/ 执行/ 时/ 只/ 考虑/ 了/ 其/ 与/ 失败/ 执行/ 的/ 差异/ 数量/ ,/ 而/ 忽略/ 了/ 差异/ 与/ 错误/ 的/ 距离/ 这一/ 因素/ ./ 据此/ ,/ 提出/ 了/ 一种/ 基于/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ ,/ 其/ 主要/ 思想/ 是/ 在/ 适当/ 控制/ 差异/ 数量/ 的/ 同时/ ,/ 选择/ 与/ 失败/ 执行/ 差异/ 最/ 分散/ 的/ 成功/ 执行/ ,/ 来/ 进行/ 错误/ 定位/ ./ 利用/ 分散化/ 使得/ 部分/ 差异/ 能够/ 接近/ 错误/ ./ 实验/ 表明/ ,/ 该/ 方法/ 错误/ 定位/ 效果/ 优于/ NN/ 方法/ ,/ 性能/ 更佳/ ./ 关键词/ 错误/ 定位/ ;/ 定位/ 模型/ ;/ 分散化/ ;/ 覆盖度/ ;/ 软件测试/ 1/ 引言/ 质量/ 是/ 软件/ 的/ 生命/ ,/ 保证/ 软件/ 质量/ 是/ 一项/ 长期/ 而/ 艰巨/ 的/ 任务/ ./ 在/ 保证/ 软件/ 质量/ 的/ 过程/ 中/ ,/ 大量/ 的/ 资源/ 都/ 花费/ 在/ 调试/ 上/ [/ 2/ ]/ ./ 调试/ 包括/ 定位/ 错误/ 、/ 修正/ 错误/ 、/ 验证/ 修复/ 等/ 多个/ 步骤/ ,/ 其中/ 又/ 以/ 错误/ 定位/ 最/ 困难/ 、/ 最耗/ 资源/ [/ 3/ ]/ ./ 近年来/ ,/ 人们/ 对/ 错误/ 定位/ 技术/ 进行/ 了/ 广泛/ 研究/ ,/ 提出/ 了/ 许多/ 有/ 价值/ 的/ 方法/ ,/ 包括/ 基于/ 程序/ 切片/ 的/ 方法/ [/ 4/ ]/ 、/ 基于/ 模型/ 诊断/ 的/ 方法/ [/ 5/ ]/ 、/ 基于/ 测试/ 的/ 方法/ [/ 1/ ,/ 6/ -/ 15/ ]/ 等/ ./ 基于/ 测试/ 的/ 错误/ 定位/ 方法/ 效果/ 更佳/ ,/ 因而是/ 当前/ 的/ 研究/ 热点/ ./ 该类/ 方法/ 中/ 又/ 包括/ 基于/ 多个/ 执行/ 覆盖/ 统计/ 的/ 方法/ [/ 6/ -/ 8/ ]/ 、/ 基于/ 多个/ 执行/ 谓词/ 统计/ 的/ 方法/ [/ 9/ -/ 11/ ]/ 、/ 因果/ 链/ 调试/ 法/ [/ 12/ -/ 13/ ]/ 、/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ [/ 1/ ,/ 14/ -/ 15/ ]/ 等/ ./ 其中/ ,/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ [/ 1/ ]/ (/ NN/ 方法/ )/ 是/ 一种/ 有效/ 且/ 非常/ 重要/ 的/ 错误/ 定位/ 方法/ ./ 该/ 方法/ 的/ 主要/ 思想/ 是从/ 成功/ 测试/ 执行/ 中/ ,/ 选择/ 与/ 已/ 发现/ 失败/ 执行/ 最/ 接近/ 的/ 一个/ ,/ 和/ 失败/ 执行/ 进行/ 比较/ ,/ 从而/ 定位/ 错误/ ./ 由于/ 最终/ 只作/ 两个/ 执行/ 间/ 的/ 比较/ ,/ 这种/ 方法/ 不仅/ 能够/ 自动/ 定位/ 出/ 可疑/ 错误/ 语句/ ,/ 而且/ 也/ 便于/ 用户/ 在/ 所得/ 结果/ 上作/ 进一步/ 分析/ ,/ 如/ 程序/ 状态/ 比较/ 等/ (/ 与/ 之/ 相比/ ,/ 多/ 执行/ 统计/ 的/ 方法/ 所得/ 结果/ 涉及/ 一大批/ 执行/ ,/ 反而/ 不/ 便于/ 用户/ 在/ 其/ 上/ 进行/ 后续/ 的/ 人工/ 分析/ )/ ./ 另外/ ,/ 由于/ 最终/ 只/ 需要/ 一个/ 成功/ 执行/ ,/ 这种/ 方法/ 也/ 便于/ 在/ 没有/ 成功/ 测试/ 的/ 情况/ 下/ ,/ 利用/ 测试用例/ 生成/ 技术/ 或/ 程序/ 状态/ 改变/ 技术/ ,/ 生成/ 成功/ 执行/ 来/ 进行/ 错误/ 定位/ ./ 文献/ [/ 16/ -/ 21/ ]/ 即/ 研究/ 了/ 针对/ 错误/ 定位/ 的/ 成功/ 执行/ 生成/ 问题/ ,/ 这些/ 研究/ 中/ 大多/ 生成/ 与/ 失败/ 执行/ 最/ 接近/ 或/ 非常/ 接近/ 的/ 成功/ 执行/ 来/ 定位/ 错误/ ./ 尽管/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ 有着/ 非常/ 重要/ 的/ 价值/ ,/ 但/ 该/ 方法/ 中/ 还/ 存在/ 一些/ 疑点/ ./ 首先/ ,/ 选择/ 与/ 失败/ 执行/ 轨迹/ 相同/ (/ 绝对/ 最/ 接近/ )/ 的/ 成功/ 执行/ 进行/ 比较/ 时/ ,/ 由于/ 程序/ 频谱/ (/ 程序执行/ 信息/ 的/ 抽象/ ,/ 如/ 语句/ 覆盖/ 、/ 数据流/ 覆盖/ 等/ )/ 完全相同/ ,/ NN/ 方法/ 无法/ 推断/ 任何/ bug/ 信息/ ,/ 所得/ 结果/ 对/ 错误/ 定位/ 毫无/ 帮助/ ./ 其次/ ,/ 在/ 选择/ 非常/ 接近/ 的/ 成功/ 执行/ 进行/ 错误/ 定位/ 时/ ,/ 尽管/ 频谱/ 差异/ 可能/ 非常/ 小/ ,/ 但/ 从/ 这些/ 差异/ 去/ 追踪/ bug/ ,/ 有时/ 代价/ 却/ 非常/ 高/ ,/ 需要/ 分析/ 大量/ 程序代码/ ./ 上述/ 现象/ 表明/ ,/ 最/ 接近/ 的/ 执行/ 、/ 最小/ 的/ 差异/ ,/ 并/ 不/ 总能/ 保证/ 取得/ 最好/ 的/ 错误/ 定位/ 效果/ ./ 到底/ 什么样/ 的/ 成功/ 执行/ ,/ 对/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 最为/ 有利/ ?/ 现有/ 文献/ [/ 1/ ,/ 14/ ]/ 等/ 给出/ 了/ 直觉性/ 的/ 回答/ ,/ 但/ 却/ 缺少/ 理论性/ 的/ 分析/ ./ 为/ 回答/ 上述/ 问题/ ,/ 本文/ 首先/ 对/ 基于/ 成功/ —/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 进行/ 了/ 理论/ 研究/ ,/ 总结/ 了/ 在/ 该/ 模型/ 下/ ,/ 影响/ 定位/ 效果/ 的/ 两个/ 关键因素/ :/ 成功/ 与/ 失败/ 执行/ 的/ 差异/ 量/ 和/ 差异/ 与/ bug/ 的/ 距离/ ./ 指出/ NN/ 方法/ 之所以/ 具有/ 上述/ 缺陷/ 是因为/ 只/ 考虑/ 了/ 错误/ 定位/ 模型/ 中/ 的/ 差异/ 量/ 因素/ ,/ 而/ 没有/ 考虑/ 差异/ 与/ bug/ 的/ 距离/ 这一/ 因素/ ./ 仅/ 一味/ 追求/ 执行/ 最/ 接近/ 、/ 差异/ 量/ 最少/ ,/ 是/ 不/ 全面/ 的/ ,/ 很/ 容易/ 出现/ 差异/ 量少/ 却/ 定位/ 效果/ 不佳/ 的/ 情况/ ./ 根据/ 对/ 错误/ 定位/ 模型/ 的/ 分析/ ,/ 我们/ 认为/ 要/ 获得/ 好/ 的/ 错误/ 定位/ 效果/ ,/ 不宜/ 过分/ 追求/ 执行/ 最/ 接近/ ,/ 而应/ 选择/ 成功/ 执行/ ,/ 使/ 其/ 与/ 失败/ 执行/ 的/ 差异/ 尽可能/ 接近/ bug/ ,/ 且/ 差异/ 量/ 适当/ ./ 过大/ 的/ 差异/ 量/ 将/ 增加/ 逐个/ 分析/ 的/ 代价/ ,/ 而/ 过/ 小/ 的/ 差异/ 量/ 有/ 可能/ 得到/ 的/ 所有/ 差异/ 都/ 偏离/ bug/ 很远/ ,/ 同样/ 将/ 增加/ 错误/ 定位/ 代价/ ./ 基于/ 上述/ 理解/ ,/ 我们/ 提出/ 了/ 一种/ 新/ 的/ 错误/ 定位/ 方法/ ,/ 主要/ 思想/ 是/ 同时/ 兼顾/ 影响/ 错误/ 定位/ 效果/ 的/ 两个/ 因素/ ,/ 利用/ 差异/ 分散化/ 使得/ 部分/ 差异/ 更/ 容易/ 接近/ bug/ ,/ 利用/ 覆盖度/ 控制/ 差异/ 量/ ,/ 使得/ 差异/ 点数/ 不至于/ 过多/ 或者/ 过少/ ./ 结合/ 分散度/ 和/ 覆盖度/ 选择/ 具有/ 适当/ 差异/ 数量/ 、/ 差异/ 较/ 分散/ 的/ 成功/ 测试/ 执行/ ,/ 与/ 失败/ 测试/ 执行/ 进行/ 频谱/ 比较/ ,/ 获得/ 差异/ 报告/ ,/ 从而/ 定位/ 错误/ ./ 分散化/ 的/ 思想/ 与/ 自/ 适应/ 随机/ 测试/ (/ ART/ )/ [/ 22/ ]/ 类似/ ,/ ART/ 用/ 分散化/ 的/ 方法/ 使得/ 部分/ 测试用例/ 更/ 容易/ 覆盖/ 到/ bug/ ,/ 本文/ 用/ 分散/ 的/ 方法/ 使得/ 部分/ 差异/ 能够/ 较/ 接近/ bug/ ./ 为/ 检验所/ 提出/ 方法/ 的/ 有效性/ ,/ 本文/ 实现/ 了/ 基于/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ (/ DD/ 方法/ )/ ,/ 并/ 将/ 其/ 与/ NN/ 方法/ 进行/ 了/ 实验/ 比较/ ./ 结果表明/ ,/ 采用/ DD/ 方法/ ,/ 能够/ 成功/ 进行/ 错误/ 定位/ 的/ 程序/ 版本/ 更/ 多/ ,/ 在/ DD/ 和/ NN/ 方法/ 均/ 能/ 定位/ 的/ 程序/ 版本/ 中/ ,/ 约/ 60/ %/ 的/ 版本/ 可以/ 获得/ 比/ NN/ 方法/ 更好/ 的/ 错误/ 定位/ 效果/ ,/ 即/ 定位/ 错误/ 时/ 需要/ 检查/ 的/ 代码/ 更/ 少/ ;/ DD/ 方法/ 对/ 所有/ 程序/ 的/ 平均/ 定位/ 效果/ 也好/ 于/ NN/ 方法/ ;/ 在/ 定位/ 效率/ 方面/ ,/ DD/ 方法/ 由于/ 不/ 需要/ 复杂/ 的/ 距离/ 计算/ 而/ 更加/ 高效/ ./ 相对/ NN/ 方法/ ,/ 平均/ 只/ 需要/ 2/ %/ ~/ 20/ %/ 左右/ 的/ 时间/ ,/ 即可/ 获得/ 错误/ 定位/ 报告/ ./ 总体而言/ ,/ 差异/ 分散化/ 方法/ 无论是/ 定位/ 效果/ 还是/ 定位/ 效率/ 都/ 优于/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ ,/ 该/ 方法/ 是/ 有效/ 的/ ./ 本文/ 第/ 2/ 节/ 介绍/ 研究/ 背景/ 和/ 动机/ ;/ 第/ 3/ 节对/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 进行/ 分析/ ;/ 第/ 4/ 节/ 详细/ 介绍/ 本文/ 所/ 提出/ 的/ 差异/ 分散化/ 错误/ 定位/ 方/ Page3/ 法/ ;/ 第/ 5/ 节/ 给出/ 实验/ 研究/ ;/ 最后/ ,/ 文章/ 分析/ 相关/ 工作/ 并/ 进行/ 总结/ ./ 2/ 背景/ 与/ 动机/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ 在/ 大量/ 的/ 测试/ 执行/ 中/ ,/ 选择/ 与/ 失败/ 测试/ 执行/ 最/ 接近/ 的/ 成功/ 执行/ (/ 差异/ 最小/ )/ ,/ 与/ 已/ 发现/ 的/ 失败/ 执行/ 进行/ 频谱/ 比较/ ,/ 得到/ 差异/ 报告/ ,/ 然后/ 以此/ 报告/ 为/ 起点/ 来/ 分析/ 定位/ 错误/ ./ 其中/ ,/ 最/ 接近/ 执行/ 的/ 选择/ 主要/ 通过/ 评估/ 两个/ 执行/ 所/ 对应/ 频谱/ 之间/ 的/ 相似/ 距离/ 实现/ ./ 差异/ 报告/ 一般/ 包括/ 成功/ 和/ 失败/ 执行/ 的/ 频谱/ 中/ 一系列/ 造成/ 不同/ 的/ 语句/ ./ 从/ 差异/ 报告/ 出发/ ,/ 可/ 通过/ 追踪/ 程序/ 语句/ 间/ 的/ 依赖/ 关系/ ,/ 定位/ 到/ 错误/ [/ 1/ ]/ ./ 具体/ 过程/ 如图/ 1/ 所示/ ,/ 该图/ 中/ ,/ F/ 表示/ 失败/ 的/ 测试/ 执行/ ,/ Si/ 表示/ 成功/ 的/ 测试/ 执行/ ./ 图/ 1/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ 示意图/ 尽管/ NN/ 方法/ 是/ 一种/ 重要/ 且/ 应用/ 广泛/ 的/ 错误/ 定位/ 方法/ ,/ 但/ 该/ 方法/ 仍/ 存在/ 两个/ 疑点/ :/ (/ 1/ )/ 在/ 选择/ 与/ 失败/ 执行/ 轨迹/ 完全/ 一样/ (/ 最/ 相似/ )/ 的/ 成功/ 测试/ 执行/ 进行/ 错误/ 定位/ 时/ ,/ 由于/ 执行/ 比较/ 所得/ 的/ 频谱/ 差异/ 集为/ 空/ ,/ 将/ 得到/ 空/ 的/ 错误/ 定位/ 报告/ ,/ 这些/ 报告/ 无法/ 用来/ 帮助/ 错误/ 定位/ ,/ 即/ 极端/ 最/ 接近/ 的/ 执行/ 对/ 错误/ 定位/ 完全/ 无用/ ./ Renieris/ 和/ Reiss/ [/ 1/ ]/ 的/ 论文/ 中/ 发现/ 了/ 大量/ 的/ 这种/ 情况/ ,/ 但/ 作者/ 并未/ 对此/ 进行/ 深入/ 讨论/ ,/ 而是/ 在/ 实验/ 中/ 直接/ 将/ 它们/ 排除/ 了/ ./ 但/ 我们/ 认为/ 这种/ 排除/ 缺乏/ 依据/ ,/ 极端/ 情况/ 下/ 的/ 失效/ 往往/ 表明/ 某个/ 方法/ 存在/ 问题/ ./ (/ 2/ )/ 对/ 一些/ 失败/ 的/ 测试/ 执行/ ,/ 用/ NN/ 方法/ 可以/ 找到/ 一个/ 与/ 它/ 差异/ 非常/ 小/ 的/ 成功/ 执行/ ,/ 然而/ ,/ 比较/ 这/ 两个/ 执行/ 的/ 频谱/ 差异/ 去/ 定位/ 错误/ 可能/ 效果/ 非常/ 差/ ,/ 需要/ 检查/ 大量/ 的/ 代码/ 才能/ 找到/ 错误/ ./ 例如/ ,/ 对/ Siemens/ 基准/ 程序库/ [/ 23/ ]/ 中/ replace/ _/ v14/ 程序/ 利用/ NN/ 方法/ 定位/ 错误/ 时/ ,/ 找到/ 的/ 最/ 接近/ 的/ 成功/ 执行/ 与/ 失败/ 执行/ 差异/ 非常/ 小/ ,/ 只有/ 一行/ 代码/ 的/ 差别/ (/ 第/ 112/ 行/ )/ ,/ 如图/ 2/ 所示/ ./ 然而/ ,/ 从/ 该行/ 开始/ ,/ 根据/ 程序/ 语句/ 间/ 的/ 依赖/ 关系/ 去/ 定位/ 错误/ 时/ ,/ 却/ 发现/ 需要/ 检查/ 整个/ 程序/ 约/ 85/ %/ 的/ 代码/ 才能/ 找到/ 错误/ (/ bug/ 在/ 第/ 370/ 行/ )/ ./ 源程序/ bug/ 行/ :/ 369caseNCCL/ :/ 370if/ (/ (/ lin/ [/ / i/ ]/ !/ =/ NEWLINE/ )/ )/ 371advance/ =/ 1/ ;/ 372break/ ;/ 最/ 接近/ 执行/ 比较法/ (/ NN/ 方法/ )/ 差异/ 行/ :/ 112junk/ =/ addstr/ (/ src/ [/ / i/ ]/ ,/ dest/ ,/ j/ ,/ maxset/ )/ ;/ 上述情况/ 表明/ ,/ 差异/ 大小/ 可能/ 并/ 不是/ 影响/ 错误/ 定位/ 效果/ 的/ 唯一/ 因素/ ,/ 最/ 接近/ 执行/ 是否是/ 错误/ 定位/ 的/ 最佳/ 选择/ 仍/ 有待/ 进一步/ 的/ 讨论/ ./ 本文/ 将试/ 着/ 分析/ NN/ 方法/ 出现/ 上述/ 问题/ 的/ 原因/ ,/ 探索/ 什么样/ 的/ 成功/ 执行/ 是/ 调试/ 的/ 最佳/ 选择/ ,/ 并/ 在/ 此基础/ 上/ 尝试/ 对/ 现有/ 的/ 错误/ 定位/ 方法/ 进行/ 改进/ ./ 3/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 为/ 解释/ NN/ 方法/ 的/ 两个/ 疑点/ ,/ 本节/ 对/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 进行/ 了/ 研究/ ,/ 并/ 深入分析/ 了/ 影响/ 错误/ 定位/ 效果/ 的/ 关键因素/ ./ 3.1/ 基本/ 模型/ 对于/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ ,/ 首先/ ,/ 我们/ 认为/ 定位/ 错误/ 是/ 一个/ 从/ 成功/ 、/ 失败/ 执行/ 的/ 差异/ 现象/ 追踪/ 到/ 错误/ 的/ 过程/ ./ 即/ 从/ 差异/ 现象/ 出发/ ,/ 沿着/ 程序/ 的/ 控制流/ 关系/ 、/ 依赖/ 关系/ [/ 4/ ]/ 甚至/ 因果/ 链/ [/ 12/ ]/ ,/ 追踪/ 程序执行/ ,/ 直到/ 发现/ bug/ 语句/ 的/ 过程/ ./ 实际/ 调试/ 中/ ,/ 差异/ 现象/ 可能/ 是/ 程序/ 输出/ 、/ 程序/ 崩溃点/ 、/ 断言/ 检查/ 失败/ 点/ 等/ ,/ 人们/ 也/ 正是/ 从/ 这些/ 差异/ 出发/ ,/ 阅读程序/ ,/ 分析/ 执行/ (/ 潜在地/ 追踪/ 控制流/ 或/ 依赖/ 关系/ 等/ )/ 去/ 定位/ 错误/ ./ 自动/ 错误/ 定位/ 中/ ,/ 差异/ 现象/ 可能/ 是/ 程序执行/ 中/ 的/ 控制/ 差异/ (/ 如/ 语句/ 覆盖/ 差异/ )/ ,/ 或/ 数据/ 差异/ (/ 如/ 程序/ 状态/ 差异/ )/ ./ 例如/ ,/ Zeller/ [/ 12/ ]/ 的/ 方法/ 根据/ 状态/ 差异/ 去/ 定位/ 错误/ ,/ 而/ NN/ 方法/ 则/ 是/ 根据/ 控制流/ 差异/ 去/ 进行/ 定位/ ./ 在/ 没有/ 依赖图/ 时/ ,/ 可以/ 追踪/ 控制流/ 图/ 进行/ 错误/ 定位/ ,/ 而/ 有/ 程序/ 依赖图/ 时/ ,/ 可/ 利用/ 依赖图/ [/ 4/ ]/ 进行/ 更/ 高效/ 的/ 定位/ ,/ 若有/ 因果/ 链/ [/ 12/ ]/ 等/ ,/ 从/ 现象/ 追踪/ bug/ 的/ 过程/ 还/ 可以/ 更加/ 高效/ ./ 具体/ 错误/ 定位/ 过程/ 如图/ 3/ (/ a/ )/ 所示/ ./ 3.2/ 影响/ 错误/ 定位/ 效果/ 的/ 关键因素/ 本文/ 不/ 讨论/ 从/ 差异/ 现象/ 到/ bug/ 的/ 追踪/ 过程/ 改进/ 对/ 错误/ 定位/ 的/ 影响/ ./ 这种/ 情况/ 下/ ,/ 对于/ 只有/ 一个/ 差异/ 现象/ 的/ 情况/ ,/ 影响/ 错误/ 定位/ 效果/ 的/ 关键/ 是/ 差异/ 现象/ 与/ bug/ 之间/ 的/ 距离/ ./ 如图/ 3/ (/ b/ )/ 所示/ ,/ 如果/ 差异/ 点/ Page4/ 距离/ bug/ 点/ 非常/ 远/ (/ 从/ 控制流/ 、/ 依赖图/ 等/ 上/ 看/ )/ ,/ 那么/ 从/ 这样/ 的/ 差异/ 去/ 定位/ bug/ 时/ ,/ 需要/ 的/ 追踪/ 分析/ 量/ 将/ 非常/ 大/ ,/ 定位/ 效果/ 较差/ ./ 反之/ ,/ 如果/ 差异/ 点/ 距离/ bug/ 很/ 接近/ ,/ 那么/ 从/ 差异/ 现象/ 出发/ ,/ 只/ 需要/ 很少/ 的/ 分析/ ,/ 就/ 可以/ 定位/ 到/ bug/ ./ 当/ 差异/ 现象/ 本身/ 就/ 发生/ 在/ bug/ 点上/ 时/ ,/ 比如/ 在/ bug/ 点上/ 崩溃/ ,/ 那么/ 从/ 差异/ 现象/ 可/ 立即/ 定位/ 到/ bug/ ./ 图/ 3/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 模型/ 对于/ 存在/ 多个/ 差异/ 的/ 情况/ (/ 如图/ 3/ (/ c/ )/ 所示/ )/ ,/ 我们/ 认为/ ,/ 如果/ 按照/ Renieris/ 和/ Reiss/ [/ 1/ ]/ 给出/ 的/ 沿着/ 程序/ 依赖图/ 进行/ 广度/ 优先/ 遍历/ ,/ 从/ 差异/ 现象/ 追踪/ bug/ 点/ 的/ 方法/ ,/ 那么/ 定位/ 效果/ 至少/ 与/ 两个/ 因素/ 有关/ :/ 差异/ 现象/ 与/ bug/ 点/ 的/ 接近/ 程度/ 以及/ 差异/ 现象/ 的/ 数目/ ./ 要/ 取得/ 好/ 的/ 定位/ 效果/ ,/ 差异/ 现象/ 应/ 尽量/ 接近/ bug/ ,/ 同时/ 数目/ 适当/ ./ 如果/ 每个/ 差异/ 都/ 离/ bug/ 很远/ ,/ 那么/ 追踪/ 到/ 错误/ 的/ 代价/ 一定/ 很大/ ;/ 如果/ 差异/ 现象/ 数目/ 过多/ ,/ 会/ 直接/ 导致/ 分析/ 代价/ 过大/ ,/ 而/ 如果/ 差异/ 现象/ 过少/ ,/ 则/ 所有/ 差异/ 都/ 离/ bug/ 很远/ 的/ 风险/ 很大/ ,/ 也/ 容易/ 造成/ 错误/ 定位/ 效果/ 不佳/ ./ 3.3/ NN/ 方法/ 可/ 疑点/ 的/ 解释/ 在/ NN/ 方法/ 中/ ,/ 对于/ 成功/ -/ 失败/ 执行/ 的/ 比较/ ,/ 有/ 价值/ 的/ 只有/ 控制/ 差异/ ,/ 而/ 没有/ 数据/ 差异/ ./ 由于/ 不同/ 测试用例/ 之间/ 并/ 没有/ 建立/ 输入/ 数据/ 上/ 的/ 关联/ ,/ 输入/ 数据/ 可能/ 差别/ 很大/ ./ 这时/ ,/ 比较/ 两个/ 执行/ 的/ 数据/ 差异/ 并/ 没有/ 意义/ ,/ 所得/ 差异/ 更多地/ 只是/ 反映/ 输入/ 的/ 差别/ ,/ 而/ 不能/ 反应/ bug/ 的/ 影响/ [/ 24/ ]/ ./ 与/ 数据/ 差异/ 类似/ ,/ NN/ 方法/ 中/ 控制/ 差异/ 尽管/ 对/ 错误/ 定位/ 有/ 一定/ 的/ 价值/ ,/ 但/ 也/ 不能/ 完全/ 反映/ bug/ 的/ 影响/ ./ 由于/ 不同/ 测试/ 的/ 输入/ 并/ 不/ 存在/ 相关性/ ,/ 控制/ 差异/ 点/ 并/ 不/ 天然/ 地/ 接近/ bug/ ./ 比如/ ,/ 假设/ bug/ 发生/ 在/ 程序/ 头/ ,/ 而/ 程序/ 尾处/ ,/ 由于/ 输入/ 的/ 某个/ 变化/ ,/ 使得/ 某一/ 分支/ 语句/ 发生/ 了/ 转向/ ,/ 执行/ 反而/ 正确/ 了/ ./ 这时/ 差异/ 发生/ 在/ 程序/ 尾/ ,/ 与/ bug/ 距离/ 就/ 很/ 远/ ,/ 而/ 这种/ 较远/ 的/ 距离/ 是/ 由/ 输入/ 差异/ 造成/ 的/ ./ NN/ 方法/ 中/ ,/ 只能/ 根据/ 控制/ 差异/ 去/ 定位/ 错误/ ,/ 而/ 这些/ 差异/ 点/ 本身/ 并/ 不/ 天然/ 地/ 接近/ bug/ ./ 在/ 此/ 特点/ 下/ ,/ 由本节/ 的/ 模型/ 分析/ 可知/ ,/ NN/ 方法/ 造成/ 第/ 2/ 节/ 所述/ 问题/ 的/ 主要/ 原因/ 是/ 只/ 考虑/ 了/ 差异/ 现象/ 的/ 数量/ ,/ 而/ 没有/ 考虑/ 差异/ 与/ bug/ 之间/ 的/ 距离/ ./ 对于/ 执行/ 轨迹/ 相同/ 的/ 情况/ ,/ 差异/ 量/ 达到/ 最小/ (/ 0/ )/ ,/ 这时/ 差异/ 与/ bug/ 之间/ 的/ 距离/ 为/ 无穷远/ ,/ 因此/ ,/ 显然/ 错误/ 定位/ 效果/ 极差/ ./ 对于/ 差异/ 量/ 极小/ 的/ 情况/ ,/ 存在/ 一种/ 风险/ ,/ 即/ 少量/ 的/ 几个/ 差异/ 现象/ 都/ 离/ bug/ 非常/ 远/ ,/ 如图/ 3/ (/ d/ )/ 所示/ ./ 在/ 这种/ 情况/ 下/ ,/ 从/ 这些/ 差异/ 去/ 定位/ 错误/ 需要/ 检查/ 大量/ 的/ 程序代码/ ,/ 错误/ 定位/ 效果/ 无疑/ 也/ 很/ 差/ ./ 4/ 基于/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ 以上/ 对/ 错误/ 定位/ 模型/ 的/ 分析表明/ ,/ 在/ 不/ 考虑/ 输入/ 的/ 情况/ 下/ ,/ 选择/ 成功/ 执行/ 进行/ 错误/ 定位/ ,/ 不宜/ 过分/ 地/ 追求/ 差异/ 点少/ ,/ 还应/ 兼顾/ 差异/ 点/ 与/ bug/ 之间/ 的/ 距离/ ./ 两者/ 达到/ 一定/ 的/ 平衡/ 时/ ,/ 才/ 可能/ 取得/ 最佳/ 的/ 错误/ 定位/ 效果/ ./ 为此/ ,/ 本文/ 借鉴/ ART/ 测试/ [/ 22/ ]/ 的/ 思想/ ,/ 提出/ 了/ 一种/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ (/ DD/ 方法/ )/ ./ 其/ 特点/ 是/ 在/ 适当/ 控制/ 差异/ 数量/ 的/ 情况/ 下/ ,/ 利用/ 差异/ 点/ 分散化/ ,/ 使得/ 部分/ 差异/ 能够/ 比较/ 接近/ bug/ ,/ 从而/ 提高/ 错误/ 定位/ 的/ 效果/ ./ 差异/ 分散化/ 的/ 主要/ 目标/ 是/ 规避/ 差异/ 点/ 距离/ bug/ 太远/ 的/ 风险/ ./ 基本/ 思想/ 是/ 通过/ 控制/ 成功/ 测试/ 执行/ 的/ 选择/ ,/ 使得/ 成功/ 执行/ 与/ 失败/ 执行/ 的/ 差异/ 尽可能/ 分散/ ./ 分散度/ 越高/ ,/ 差异/ 在/ 整个/ 程序/ 中/ 分布/ 越/ 均匀/ ./ 对于/ 处在/ 程序/ 中/ 某/ 一/ 固定/ 位置/ 的/ bug/ 而言/ ,/ 越/ 容易/ 被/ 部分/ 差异/ 点/ 逼近/ (/ 如图/ 3/ (/ c/ )/ 所示/ )/ ,/ 从而/ 更/ 有利于/ bug/ 的/ 追踪/ 定位/ ./ 分散化/ 可以/ 避免/ 差异/ 点/ 过于/ 集中/ ,/ 从而/ 造成/ 集体/ 失效/ 的/ 情况/ ./ 这/ 一点/ 与/ ART/ 测试/ 非常/ 接近/ ,/ ART/ 测试通过/ 分散化/ 测试用例/ ,/ 避免/ 所有/ 测试用例/ Page5/ 都/ 集中/ 在/ 同一个/ 功能/ 上/ 反复/ 测试/ ,/ 从而/ 提高/ 测试/ 效率/ ./ 我们/ 通过/ 分散化/ 差异/ 点/ ,/ 使得/ 各个/ 差异/ 尽可能/ 有/ 不同/ 贡献/ ,/ 从而/ 提高/ 错误/ 定位/ 效果/ ./ 图/ 4/ 差异/ 分散化/ 方法/ 的/ 基本/ 步骤/ 第/ 1/ 步/ (/ 图/ 4/ 过程/ ①/ )/ ,/ 在/ 含/ bug/ 程序/ 上/ 运行/ 测试用例/ ,/ 判断/ 执行/ 是否/ 成功/ ,/ 并/ 收集/ 执行/ 频谱/ ./ 图/ 4/ 中/ ,/ “/ 成功/ ”/ 、/ “/ 失败/ ”/ 框/ 分别/ 表示/ 成功/ 和/ 失败/ 执行/ 的/ 频谱/ ./ 第/ 2/ 步/ (/ 图/ 4/ 过程/ ②/ )/ ,/ 比较/ 失败/ 执行/ 和/ 每个/ 成功/ 执行/ 的/ 频谱/ ,/ 得到/ 它们/ 的/ 差异/ 报告/ (/ F/ -/ S/ )/ ,/ 每个/ 报告/ 中/ 包含/ 一组/ 差异/ 点/ ;/ 为/ 这些/ 差异/ 报告/ 分析/ 差异/ 量/ ,/ 计算/ 覆盖度/ ;/ 然后/ 从/ 各个/ 差异/ 报告/ 中/ 筛选/ 覆盖度/ 在/ 一定/ 范围/ 内/ 的/ 报告/ ,/ 以供/ 后续/ 处理/ ./ 第/ 3/ 步/ (/ 图/ 4/ 过程/ ③/ )/ ,/ 为/ 上/ 一步/ 所得/ 的/ 差异/ 报告/ 计算/ 分散度/ ,/ 差异/ 点越/ 分散/ ,/ 越/ 容易/ 使/ 部分/ 差异/ 接近/ bug/ ;/ 根据/ 分散度/ 属性/ ,/ 选择/ 分散度/ 最高/ 的/ 差异/ 报告/ ,/ 将/ 其中/ 的/ 差异/ 点/ 映射/ 回/ 源代码/ ,/ 得到/ 可疑/ 出错/ 语句/ ./ 可疑/ 出错/ 语句/ 将/ 作为/ 本/ 方法/ 最终/ 所得/ 的/ 错误/ 定位/ 结果/ ,/ 提供/ 给/ 用户/ ,/ 以便/ 于/ 后续/ 的/ 人工/ 分析/ ./ 4.2/ 差异/ 分散度/ 评估/ 类似/ NN/ 方法/ ,/ 在/ DD/ 方法/ 中/ ,/ 我们/ 用/ 基本块/ 覆盖/ 作为/ 程序/ 的/ 执行/ 频谱/ ,/ 两个/ 频谱/ 之间/ 的/ 差异/ 是/ 一组/ 基本块/ 的/ 集合/ ./ 差异/ 基本块/ 按/ 其/ 在/ 程序/ 中/ 出现/ 的/ 先后顺序/ 散布/ 在/ 源代码/ 中/ ,/ 计算/ 相邻/ 两个/ 差异/ 基本块/ 之间/ 间隔/ 距离/ 的/ 方差/ ,/ 即可/ 评估/ 差异/ 分散度/ ./ 方差/ 越大/ ,/ 表明/ 基本块/ 散布/ 越/ 不/ 均匀/ ,/ 分散度/ 越低/ ./ 反之/ ,/ 方差/ 越小/ ,/ 散布/ 越/ 均匀/ ,/ 分散度/ 越高/ ./ 为/ 计算/ 相邻/ 两个/ 差异/ 基本块/ 之间/ 的/ 间隔/ 距离/ ,/ 我们/ 首先/ 将/ 基本块/ 映射/ 回/ 源代码/ ,/ 获得/ 基本块/ 的/ 行号/ 信息/ ,/ 然后/ 利用/ 行号/ 差值/ 进行/ 距离/ 计算/ ./ 每个/ 基本块/ 对应/ 一个/ 行号/ 范围/ ,/ 为/ 计算/ 距离/ 的/ 方便/ ,/ 我们/ 取其/ 中心/ 行号/ ,/ 即/ 基本块/ 首/ 行/ 行号/ 加上/ 尾行/ 行号/ 除以/ 2/ 的/ 整数/ 结果/ ,/ 作为/ 基本块/ 本身/ 的/ 行号/ (/ 也/ 可取/ 首行/ 或/ 尾行/ 行号/ ,/ 但/ 中心/ 行号/ 更/ 有/ 代表性/ ,/ 能/ 更/ 准确/ 地/ 表达/ 基本块/ 位置/ )/ ./ 如此/ ,/ 每个/ 差异/ 基本块/ 将/ 对应/ 唯一/ 的/ 一个/ 行号/ ./ 图/ 5/ 给出/ 了/ 一组/ 差异/ 基本块/ 及其/ 行号/ 的/ 示例/ ./ 其中/ ,/ B1/ ,/ B2/ ,/ …/ ,/ Bn/ 表示/ 一组/ 在/ 源代码/ 中/ 顺序/ 4.1/ 差异/ 分散化/ 方法/ 的/ 基本/ 步骤/ 本文/ 的/ 差异/ 分散化/ 方法/ 主要/ 包括/ 3/ 个/ 步骤/ ,/ 如图/ 4/ 所示/ ./ 排布/ 的/ 差异/ 基本块/ ,/ B0/ 和/ Bn/ +/ 1/ 是/ 虚拟/ 基本块/ ,/ 分别/ 对应/ 程序/ 的/ 起始/ 和/ 结束/ ./ 引入/ B0/ 和/ Bn/ +/ 1/ 是/ 为了/ 计算/ 差异/ 分散度/ 的/ 方便/ ,/ 它们/ 可用/ 来/ 计算/ 第一个/ 差异/ 基本块/ 和/ 最后/ 一个/ 差异/ 基本块/ 到/ 程序/ 开头/ 和/ 结束/ 的/ 距离/ ./ 图/ 5/ 中/ ,/ L1/ ,/ L2/ ,/ …/ ,/ Ln/ 是/ 每个/ 基本块/ 的/ 中心/ 行号/ ./ L0/ 对应/ 程序/ 的/ 起始/ 行号/ ,/ Ln/ +/ 1/ 对应/ 程序/ 的/ 结束/ 行号/ ./ 根据/ 行号/ ,/ 可/ 计算/ 差异/ 基本块/ 之间/ 的/ 间隔/ 距离/ ,/ 即/ 间隔/ 行数/ ./ 图/ 5/ 中/ d1/ ,/ d2/ ,/ …/ ,/ dn/ ,/ dn/ +/ 1/ 分别/ 表示/ 各/ 相邻/ 差异/ 基本块/ 之间/ 的/ 间隔/ 距离/ ./ di/ 的/ 计算公式/ 如下/ :/ 为/ 避免/ 空行/ 对于/ 分散度/ 评估/ 的/ 影响/ ,/ 在/ 距离/ 计算/ 前/ ,/ 我们/ 先对/ 程序/ 做/ 一个/ 简单/ 的/ 处理/ ,/ 去除/ 所有/ 空行/ 和/ 注释/ 行/ ,/ 如此/ 每个/ 距离/ 即/ 对应/ 了/ 各个/ 差异/ 基本块/ 中心/ 之间/ 相隔/ 的/ 有效/ 代码/ 行数/ ./ 此外/ ,/ 若/ 程序/ 存在/ 多个/ 文件/ ,/ 则/ 这些/ 文件/ 将/ 被/ 逐个/ 拼接/ 起来/ 当作/ 单个/ 文件/ 进行/ 分析/ ./ 利用/ 差异/ 基本块/ 间/ 的/ 间隔/ 距离/ 即可/ 计算/ 各/ 差异/ 点/ 之间/ 的/ 分散度/ ./ 本文/ 用/ d1/ ,/ d2/ ,/ …/ ,/ dn/ ,/ dn/ +/ 1/ 这组/ 距离/ 之间/ 的/ 方差/ 的/ 逆/ 作为/ 差异/ 分散度/ 的/ 评估/ ./ 方差/ 越小/ ,/ 分散度/ 值越/ 高/ ./ 记/ Even/ (/ F/ -/ S/ )/ 表示/ 失败/ 执行/ F/ 和/ 成功/ 执行/ S/ 频谱/ 差异/ 的/ 差异/ 分散度/ ,/ 则/ 其/ 具体/ 的/ 评估/ 公式/ 如下/ :/ Even/ (/ F/ -/ S/ )/ =/ (/ d1/ -/ 珚/ d/ )/ 2/ +/ (/ d2/ -/ 珚/ d/ )/ 2/ +/ …/ +/ (/ dn/ -/ 珚/ d/ )/ 2/ +/ (/ dn/ +/ 1/ -/ 珚/ d/ )/ 2Page6/ 其中/ ,/ 珚/ d/ 为/ d1/ ,/ d2/ ,/ …/ ,/ dn/ ,/ dn/ +/ 1/ 距离/ 的/ 平均值/ ,/ Even/ (/ F/ -/ S/ )/ 值越/ 大/ ,/ 差异/ 分散度/ 越高/ ./ 4.3/ 基于/ 覆盖度/ 和/ 分散度/ 的/ 错误/ 定位/ 报告/ 生成/ 错误/ 定位/ 过程/ 中/ ,/ 选择/ 不同/ 的/ 成功/ 执行/ 与/ 已/ 发现/ 的/ 失败/ 执行/ 进行/ 比较/ ,/ 所得/ 的/ 差异/ 数量/ 可能/ 并不相同/ ./ 有些/ 成功/ 执行/ 对应/ 的/ 差异/ 数大/ ,/ 有些/ 差异/ 数小/ ./ 根据/ 第/ 3/ 节/ 的/ 分析/ ,/ 我们/ 认为/ 选择/ 具有/ 适当/ 差异/ 数目/ 的/ 成功/ 执行/ ,/ 进行/ 执行/ 比较/ ,/ 是/ 取得/ 较/ 好/ 错误/ 定位/ 效果/ 的/ 一个/ 关键/ ./ 为/ 控制/ 差异/ 数目/ ,/ 本文/ 定义/ 了/ 差异/ 覆盖度/ 这一/ 指标/ ./ 利用/ 覆盖度/ 可以/ 很/ 方便/ 地/ 进行/ 成功/ 执行/ 的/ 选择/ ./ 差异/ 覆盖度/ 定义/ 为/ 成功/ 和/ 失败/ 执行/ 的/ 差异/ 基本块/ 占/ 整个/ 程序/ 基本块/ 数目/ 的/ 比例/ ,/ 具体/ 计算公式/ 如下/ :/ 其中/ ,/ ND/ 表示/ 差异/ 中/ 基本块/ 的/ 个数/ ,/ NP/ 表示/ 整个/ 程序/ 中/ 所有/ 基本块/ 的/ 个数/ ./ 为/ 避免/ 选择/ 具有/ 过多/ 或/ 过少/ 差异/ 数目/ 的/ 成功/ 执行/ ,/ 从而/ 直接/ 增大/ 错误/ 定位/ 代价/ ,/ 或/ 通过/ 差异/ 到/ bug/ 的/ 距离/ 这一/ 因素/ 间接/ 增加/ 错误/ 定位/ 代价/ ,/ 本文/ 在/ 差异/ 覆盖度/ 上/ 定义/ 了/ 一个/ 上/ 下界/ 范围/ ,/ 以/ 约束/ 成功/ 执行/ 的/ 选择/ ./ 差异/ 覆盖度/ 范围/ 用/ [/ L/ ,/ H/ ]/ 表示/ ,/ L/ 是/ 所/ 允许/ 的/ 覆盖度/ 下界/ ,/ H/ 是/ 所/ 允许/ 的/ 覆盖度/ 上界/ ./ 上下/ 边界/ 主要/ 根据/ 经验/ 确定/ ,/ 可/ 对/ 所有/ 程序/ 设置/ 同一个/ 上下/ 边界/ ,/ 也/ 可/ 根据/ 程序/ 类型/ 进行/ 边界/ 设置/ ./ 有/ 了/ 差异/ 的/ 覆盖度/ 和/ 分散度/ 这/ 两个/ 属性/ ,/ 具体/ 的/ 从/ 成功/ 执行/ 中/ 选择/ 某个/ 执行/ 生成/ 差异/ 报告/ 的/ 过程/ 如/ 算法/ 1/ 所示/ ./ 在/ 该/ 算法/ 中/ ,/ 首先/ 利用/ Cover/ 函数/ 控制/ 差异/ 量/ ,/ 从/ 成功/ 测试/ 执行/ 集/ Φ/ S/ 中/ 过滤/ 掉/ 部分/ 差异/ 覆盖度/ 不/ 在/ [/ L/ ,/ H/ ]/ 范围/ 内/ 的/ 执行/ ,/ 然后/ 利用/ Even/ 函数/ 选择/ 差异/ 最/ 分散/ 的/ 一个/ 成功/ 执行/ ,/ 与/ 失败/ 执行/ 进行/ 对比/ ,/ 获得/ 错误/ 定位/ 结果/ ./ 算法/ 1/ ./ 差异/ 报告/ (/ 错误/ 定位/ 报告/ )/ 生成/ 算法/ ./ 输入/ :/ 失败/ 测试/ 执行/ F/ 、/ 成功/ 测试/ 执行/ 集/ Φ/ S/ ,/ 输出/ :/ 作为/ 错误/ 定位/ 结果/ 的/ 差异/ 报告/ Report/ 过程/ :/ 1/ ./ Evenmax2/ ./ Report/ ·/ ·/ =/ / 3/ ./ FOREACHS/ ∈/ Φ/ SDO4/ ./ IFCover/ (/ F/ -/ S/ )/ ∈/ [/ L/ ,/ H/ ]/ THEN5/ ./ e/ ·/ ·/ =/ Even/ (/ F/ -/ S/ )/ 6/ ./ IFe/ >/ EvenmaxTHEN7/ ./ Evenmax8/ ./ Report/ ·/ ·/ =/ F/ -/ S9/ ./ ENDIF10/ ./ ENDIF11/ ./ ENDFOR/ 利用/ 算法/ 1/ ,/ 可/ 得到/ 一个/ 作为/ 错误/ 定位/ 结果/ 的/ 频谱/ 差异/ 报告/ ,/ 该/ 差异/ 报告/ 包含/ 了/ 一组/ 差异/ 基本块/ ,/ 将/ 这些/ 基本块/ 映射/ 回/ 源代码/ ,/ 可/ 得到/ 可疑/ 的/ 出错/ 语句/ ./ 用户/ 可以/ 根据/ 该/ 可疑/ 出错/ 语句/ 集/ 的/ 指引/ ,/ 沿着/ 程序/ 流图/ 或/ 程序/ 依赖图/ 去/ 追踪/ 程序执行/ ,/ 从而/ 锁定/ 最终/ 的/ 出错/ 代码/ ./ 通过/ 分散度/ 的/ 控制/ ,/ 有/ 更/ 大/ 的/ 几率/ 使得/ 部分/ 差异/ 离/ bug/ 比较/ 接近/ ,/ 这/ 将/ 给/ 错误/ 定位/ 带来/ 方便/ ./ 5/ 实验/ 分析/ 为/ 检验/ 本文/ 所/ 提出/ 方法/ 的/ 有效性/ ,/ 我们/ 实现/ 了/ 一个/ 错误/ 定位/ 及其/ 效果/ 评估/ 工具/ ,/ 并/ 在/ 错误/ 定位/ 领域/ 通用/ 的/ Siemens/ 基准/ 程序库/ 和/ space/ 程序/ [/ 23/ ]/ 上/ 进行/ 了/ 详细/ 的/ 实验/ 分析/ ,/ 以/ 确定/ 差异/ 分散化/ 过程/ 中/ 相关/ 参数/ 的/ 设置/ ,/ 同时/ 与/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ (/ NN/ 方法/ )/ 进行/ 错误/ 定位/ 效果/ 和/ 效率/ 比较/ ./ 本/ 实验/ 拟/ 回答/ 以下/ 3/ 个/ 基本/ 问题/ :/ (/ 1/ )/ 差异/ 覆盖度/ 范围/ 如何/ 确定/ ?/ 即/ 覆盖度/ 区间/ [/ L/ ,/ H/ ]/ 如何/ 设定/ 有利于/ 获得最佳/ 错误/ 定位/ 效果/ ./ (/ 2/ )/ 与/ NN/ 方法/ 相比/ ,/ DD/ 方法/ 的/ 错误/ 定位/ 效果/ 如何/ ?/ 即/ DD/ 方法/ 是否/ 定位/ 更为/ 准确/ ,/ 能够/ 更多地/ 排除/ 那些/ 原本/ 需要/ 检查/ 的/ 代码/ ./ (/ 3/ )/ 与/ NN/ 方法/ 相比/ ,/ DD/ 方法/ 的/ 错误/ 定位/ 效率/ 如何/ ?/ 即/ DD/ 方法/ 时间/ 性能/ 如何/ ,/ 获得/ 错误/ 定位/ 报告/ 所/ 花费/ 的/ 时间/ 比/ NN/ 方法/ 更/ 多/ ,/ 还是/ 更/ 少/ ?/ 5.1/ 实验设计/ 为/ 确定/ 何种/ 差异/ 覆盖度/ 范围/ 对/ 错误/ 定位/ 最为/ 有利/ ,/ 本文/ 首先/ 采样/ 一批/ 覆盖度/ 点/ C1/ ,/ C2/ ,/ …/ ,/ Cn/ ,/ 然后/ 在/ 每个/ 覆盖度/ 点上/ ,/ 计算/ 采用/ 差异/ 分散化/ 方法/ 进行/ 错误/ 定位/ 能够/ 达到/ 的/ 定位/ 效果/ 评分/ Score1/ ,/ Score2/ ,/ …/ ,/ Scoren/ (/ 定位/ 效果/ 的/ 量化/ 评估/ 将/ 在/ 下/ 一段落/ 介绍/ )/ ,/ 从而/ 得到/ 错误/ 定位/ 效果/ 随/ 覆盖度/ 变化/ 的/ 趋势/ 图/ ./ 在/ 该/ 趋势/ 图上/ ,/ 找出/ 最大/ 定位/ 效果/ 对应/ 的/ 覆盖度/ 范围/ ,/ 即可/ 确定/ 覆盖度/ 区间/ [/ L/ ,/ H/ ]/ ./ 为/ 获得/ 一个/ 覆盖度/ Ci/ 上/ 的/ 错误/ 定位/ 效果/ 评估/ ,/ 对于/ 单个/ 程序/ 版本/ 的/ 单个/ 失败/ 执行/ ,/ 本文/ 在/ 差异/ 覆盖度/ 固定/ 为/ Ci/ 的/ 层次/ 上/ ,/ 筛选/ 对应/ 差异/ 分散度/ 最大/ 的/ 成功/ 执行/ ,/ 来/ 获得/ 相应/ 的/ 定位/ 效果/ 评估/ 值/ ./ 一个/ 程序/ 版本/ 可能/ 有/ 多个/ 失败/ 执行/ ,/ 该/ 程序/ 版本/ 上/ 的/ 错误/ 定位/ 效果/ 评估/ 值/ ,/ 是/ 其/ 所有/ 失败/ 执行/ 上/ 相应/ 评估/ 值/ Page7/ 的/ 平均/ ./ 一个/ 程序/ 又/ 可能/ 有/ 若干/ 子/ 版本/ ,/ 该/ 程序/ 上/ 的/ 错误/ 定位/ 效果/ 评估/ 值/ 是/ 其/ 所有/ 子程序/ 版本/ 上/ 相应/ 评估/ 值/ 的/ 平均/ ./ 总体而言/ ,/ 差异/ 覆盖度/ Ci/ 上/ 的/ 错误/ 定位/ 效果/ 评估/ 值/ Scorei/ 是/ 各/ 程序/ 在/ 覆盖度/ Ci/ 上/ 的/ 错误/ 定位/ 效果/ 评估/ 值/ 的/ 平均/ ./ 经过/ 上述/ 处理/ 后/ ,/ 以/ 差异/ 覆盖度/ 为/ X/ 轴/ ,/ 错误/ 定位/ 效果/ 评估/ 值为/ Y/ 轴/ ,/ 可/ 得到/ 差异/ 分散化/ 方法/ 中/ 的/ 错误/ 定位/ 效果/ 随/ 差异/ 覆盖度/ 变化/ 的/ 趋势/ 图/ ./ 利用/ 该图/ 即可/ 确定/ 覆盖度/ 区间/ [/ L/ ,/ H/ ]/ ./ 为了/ 评估/ DD/ 方法/ 的/ 错误/ 定位/ 效果/ ,/ 与/ NN/ 方法/ 一样/ ,/ 本文/ 采用/ 基于/ 依赖图/ 的/ 评分/ 机制/ [/ 1/ ]/ 来/ 为/ 每个/ 错误/ 定位/ 报告/ 进行/ 打分/ ./ 评分/ 公式/ 如下/ :/ 其中/ ,/ |/ PDG/ |/ 表示/ 含/ bug/ 程序/ 的/ 整个/ 依赖图/ 中/ 的/ 节点/ 总数/ ,/ 令/ DS/ (/ n/ )/ 表示/ 在/ 依赖图/ 中/ ,/ 可/ 从/ 错误/ 定位/ 报告/ 中/ 的/ 节点/ 出发/ ,/ 最多经/ n/ 条有/ 向/ 边/ 到达/ 的/ 那些/ 节点/ ,/ 则/ DS/ / 表示/ 使/ DS/ (/ n/ )/ 中/ 包含/ 错误/ 语句/ 的/ 最小/ 的/ n/ 对应/ 的/ 可达集/ (/ 如/ 有/ 多条/ 错误/ 语句/ ,/ 只/ 需/ 包含/ 其中/ 一条/ 即可/ )/ [/ 1/ ]/ ./ 式/ (/ 4/ )/ 中/ 的/ 评分/ 表示/ 从/ 所得/ 错误/ 定位/ 报告/ 出发/ ,/ 采用/ 广度/ 优先/ 搜索/ 技术/ ,/ 沿着/ 依赖图/ 定位/ bug/ 时/ ,/ 可/ 忽略/ 检查/ 的/ 代码/ 占/ 整个/ 程序/ 的/ 比例/ ./ 显然/ ,/ 评分/ 越高/ 错误/ 定位/ 效果/ 越好/ ./ 上述/ 评分/ 机制/ 只/ 针对/ 一个/ 程序/ 版本/ 的/ 一个/ 失败/ 执行/ ./ 对于/ 具有/ 多个/ 失败/ 执行/ 的/ 某/ 一/ 程序/ 版本/ v/ ,/ 假定/ 它/ 有/ m/ 个/ 失败/ 执行/ ,/ 分别/ 得到/ m/ 个/ 错误/ 定位/ 报告/ ,/ 第/ i/ 个/ 报告/ 的/ 定位/ 效果/ 评分/ 为/ Scorei/ ,/ 则/ 程序/ 版本/ v/ 上/ 的/ 错误/ 定位/ 效果/ 评分/ Sv/ 为/ m/ 个/ 报告/ 评分/ 的/ 平均/ ,/ 即/ 类似/ 地/ ,/ 对于/ 具有/ 多个/ 版本/ 的/ 某个/ 程序/ P/ ,/ 假定/ 它/ 有/ n/ 个/ 版本/ ,/ 第/ i/ 个/ 版本/ 评分/ 为/ Sv/ 误/ 定位/ 效果/ 评分/ SP/ 是/ n/ 个/ 版本/ 定位/ 效果/ 评分/ 的/ 平均/ ,/ 即/ 最终/ ,/ 对于/ 所有/ 的/ k/ 个/ 程序/ 而言/ ,/ 设其/ 第/ i/ 个/ 程序/ 的/ 定位/ 效果/ 评分/ 为/ SP/ 果/ 的/ 平均/ 评分/ 是/ 各个/ 程序/ 定位/ 效果/ 评分/ 的/ 平均/ ,/ 即/ 依据/ 这组/ 不同/ 粒度/ 的/ 错误/ 定位/ 效果/ 评分/ 机制/ ,/ 可以/ 对/ 不同/ 错误/ 定位/ 方法/ 的/ 定位/ 效果/ 进行/ 全面/ 评估/ ,/ 来/ 考察/ 一个/ 方法/ 对/ 不同/ 程序/ 的/ 效果/ 差异/ ,/ 以及/ 对/ 所有/ 程序/ 的/ 总体/ 效果/ ./ 为/ 比较/ 差异/ 分散化/ 方法/ 和/ NN/ 方法/ 的/ 错误/ 定位/ 效率/ ,/ 本文/ 还/ 收集/ 了/ 两种/ 方法/ 为/ 各个/ 程序/ 获得/ 错误/ 定位/ 报告/ 的/ 平均/ 时间/ ,/ 从而/ 评判/ 两种/ 方法/ 的/ 性能/ ./ 在/ 平均/ 时间/ 的/ 计算/ 中/ ,/ 对/ 一个/ 程序/ P/ ,/ 假定/ 它/ 有/ n/ 个/ 版本/ ,/ 第/ i/ 个/ 版本/ 得到/ 所有/ 错误/ 定位/ 报告/ 所/ 需/ 的/ 时间/ i/ ,/ 则/ 该/ 程序/ 上/ 各/ 版本/ 得到/ 错误/ 定位/ 报告/ 所/ 需/ 的/ 为/ Tv/ 平均/ 时间/ TP/ 为/ TP/ 越大/ 表明/ 定位/ 错误/ 花费/ 的/ 时间/ 越/ 多/ ,/ 定位/ 的/ 效率/ 越低/ ,/ 反之/ 则/ 定位/ 效率/ 越高/ ./ 5.2/ 实验/ 实现/ 为/ 进行/ 实验/ 分析/ ,/ 本文/ 基于/ LLVM/ 编译/ 平台/ ①/ 实现/ 了/ 一个/ 错误/ 定位/ 原型/ 工具/ ./ 利用/ LLVM/ 插桩/ 目标程序/ ,/ 从而/ 获得/ 其/ 执行/ 频谱/ ./ LLVM/ 还/ 提供/ 了/ 从/ 基本块/ 到/ 源代码/ 的/ 映射/ ,/ 而/ 源代码/ 中/ 的/ 行号/ 信息/ 将/ 被/ 用来/ 计算/ 差异/ 分散度/ ./ 利用/ 所得/ 错误/ 定位/ 工具/ ,/ 我们/ 在/ Siemens/ 基准/ 库/ 的/ 7/ 个/ 程序/ 和/ 更/ 大规模/ 的/ space/ 程序/ 上/ 进行/ 了/ 实验/ 分析/ ,/ 并/ 将/ 本文/ 所/ 提出/ 的/ 方法/ 与/ NN/ 方法/ 进行/ 了/ 对比/ ./ 表/ 1/ 列出/ 了/ 本文/ 的/ 实验/ 对象/ ,/ 每个/ 实验/ 程序/ 有/ 若干/ 版本/ ,/ 共计/ 170/ 个/ 程序/ 版本/ ,/ 每个/ 版本/ 都/ 含有/ 一些/ 人工/ 植入/ 的/ 错误/ ,/ 如/ 代码/ 删除/ 、/ 代码/ 增加/ 或/ 操作/ 更改/ 等/ ./ 对于/ 上述/ 实验/ 对象/ ,/ 我们/ 在/ 分析/ 时/ 排除/ 了/ 那些/ NN/ 和/ DD/ 方法/ 均/ 无法/ 进行/ 错误/ 定位/ 的/ 失败/ 执行/ 和/ 程序/ 版本/ ,/ 这些/ 执行/ 和/ 版本/ 中/ 成功/ 执行/ 的/ 频谱/ 与/ 失败/ 执行/ 相同/ ,/ 无法/ 进行/ 基于/ 频谱/ 比较/ 的/ 错误/ 定位/ ./ 此外/ ,/ 极少量/ 程序/ 版本/ 在/ 运行/ 时/ 发生/ 崩溃/ ,/ 这些/ 版本/ 的/ 处理/ 较为/ 复杂/ ,/ 在/ 本/ 实验/ 中/ 也/ 将/ 它们/ 排除/ 了/ ./ 由于/ 崩溃/ 型/ 失效/ 现象/ 明确/ ,/ 本身/ 比较/ 容易/ 调试/ ,/ 且/ 产生/ 崩溃/ 的/ 版本/ 极少/ ,/ 因此/ ,/ 我们/ 认为/ 去除/ 它们/ 对于/ 实验/ 结论/ 影响/ 不大/ ./ 经过/ 以上/ 选择/ ,/ 本/ 实验/ 中/ 最后/ 实际/ 处理/ 的/ 目标程序/ 共/ 155/ 个/ 程序/ 版本/ ./ 程序/ print/ _/ tokensprint/ _/ tokens2replacescheduleschedule2tcastot/ _/ infospace/ ①/ TheLLVMCompilerInfrastructure/ ./ http/ :/ // // llvm/ ./ org/ // Page85/ ./ 3/ 实验/ 结果/ 5.3/ ./ 1/ 覆盖度/ 范围/ 的/ 选择/ 为/ 确定/ 覆盖度/ 范围/ ,/ 根据/ 5.1/ 节/ 的/ 实验设计/ ,/ 我们/ 对/ space/ 以外/ 的/ 实验/ 对象/ ,/ 进行/ 了/ 差异/ 覆盖度/ 采样/ 分析/ ,/ 得到/ 了/ 各个/ 实验/ 对象/ 上/ 错误/ 定位/ 效果/ 评分/ 图/ 6/ 错误/ 定位/ 效果/ 评分/ 随/ 覆盖度/ 变化/ 的/ 趋势/ 图随/ 覆盖度/ 变化/ 的/ 趋势/ 图/ ,/ 如图/ 6/ (/ a/ )/ ~/ (/ g/ )/ 所示/ ./ 在/ 各/ 程序/ 错误/ 定位/ 效果/ 随/ 时间/ 变化趋势/ 信息/ 的/ 基础/ 上/ ,/ 利用/ 5.1/ 节/ 给出/ 的/ 平均化/ 方法/ ,/ 可/ 得到/ 对于/ 上述/ 实验/ 对象/ 整体而言/ ,/ 错误/ 定位/ 效果/ 评分/ 的/ 变化规律/ ,/ 如图/ 6/ (/ h/ )/ 所示/ ./ Page9/ 由图/ 6/ (/ a/ )/ ~/ (/ g/ )/ 可见/ ,/ 错误/ 定位/ 效果/ 的/ 一般/ 变化趋势/ 是/ :/ 首先/ ,/ 在/ 覆盖度/ 较/ 低时/ 逐步/ 上升/ ,/ 在/ 中间/ 某个/ 较/ 低/ 的/ 差异/ 覆盖度/ 上/ ,/ 错误/ 定位/ 效果/ 达到最佳/ ,/ 然后/ 当/ 覆盖度/ 再/ 增大/ 时/ ,/ 逐渐/ 下降/ ./ 即/ 覆盖度/ 太高/ 错误/ 定位/ 效果/ 固然/ 不好/ ,/ 但/ 也/ 并非/ 覆盖度/ 越低/ ,/ 定位/ 效果/ 越好/ ./ 一味/ 追求/ 差异/ 少/ ,/ 未必/ 能/ 取得/ 最佳/ 的/ 错误/ 定位/ 效果/ ./ 根据/ 图/ 6/ (/ a/ )/ ~/ (/ g/ )/ 各子/ 图/ 的/ 变化趋势/ 以及/ 图/ 6/ (/ h/ )/ 的/ 综合/ 趋势/ 可见/ ,/ 差异/ 覆盖度/ 在/ 6/ %/ ~/ 8/ %/ 的/ 范围/ 内时/ ,/ 大部分/ 程序/ 版本/ 都/ 有/ 最佳/ 或/ 较佳/ 的/ 错误/ 定位/ 效果/ ,/ 整体/ 的/ 错误/ 定位/ 效果/ 评分/ 也/ 处在/ 峰值/ 附近/ ./ 我们/ 认为/ 在/ 该/ 覆盖度/ 范围/ 内/ 进行/ 差异/ 分散化/ 错误/ 定位/ 可以/ 取得/ 较/ 好/ 的/ 定位/ 效果/ ./ 因此/ ,/ 本文/ 取/ 差异/ 覆盖度/ 下界/ L/ =/ 6/ %/ ,/ 上界/ H/ =/ 8/ %/ ,/ 将/ 在/ 6/ %/ ~/ 8/ %/ 的/ 覆盖度/ 范围/ 内/ ,/ 选择/ 差异/ 最/ 分散/ 的/ 成功/ 执行/ ,/ 进行/ 对比/ ,/ 从而/ 定位/ 可疑/ 出错/ 语句/ ./ 图/ 7/ 所有/ 程序/ 版本/ 上/ 的/ 错误/ 定位/ 评分/ 情况/ 图/ 8/ 在/ 图/ 7/ 的/ 基础/ 上/ 统计/ 了/ 各个/ 评分/ 差值/ 级别/ 上/ 的/ 程序/ 版本/ 数/ 分布/ (/ 只/ 统计/ DD/ 和/ NN/ 方法/ 均/ 有效/ 的/ 版本/ )/ ./ 该图/ 中/ 横轴/ “/ 评分/ 差值/ ”/ 表示/ 对于/ 一个/ 程序/ 版本/ ,/ 用/ DD/ 方法/ 的/ 错误/ 定位/ 效果/ 评分/ 减去/ NN/ 方法/ 的/ 错误/ 定位/ 效果/ 评分/ 所得/ 的/ 结果/ ,/ 即/ 两种/ 方法/ 的/ 评分/ 差值/ ./ 差值/ 以/ 0.1/ 为/ 步长/ ,/ 划分/ 为/ [/ -/ 0.5/ ,/ -/ 0.4/ )/ ,/ …/ ,/ [/ -/ 0.1/ ,/ 0/ )/ ,/ [/ 0/ ,/ 0.1/ )/ ,/ …/ ,/ [/ 0.4/ ,/ 0.5/ )/ 等/ 多个/ 级别/ ./ 纵轴/ 为/ 评分/ 差值/ 处于/ 某一/ 级别/ 内/ 的/ 程序/ 版本/ 的/ 个数/ ./ 由图/ 8/ 可知/ ,/ 77/ %/ 的/ 程序/ 版本/ 上/ ,/ DD/ 方法/ 要么/ 表现/ 更好/ ,/ 要么/ 和/ NN/ 方法/ 评分/ 相差/ 在/ 0.1/ 分/ 以内/ ,/ 即/ 需要/ 多/ 检查/ 的/ 代码/ 不/ 超过/ 10/ %/ ;/ 只有/ 23/ %/ 的/ 程序/ 版本/ 上/ ,/ DD/ 方法/ 错误/ 定位/ 效果/ 比/ NN/ 方法/ 弱/ 很多/ ./ 31/ %/ 的/ 程序/ 版本/ 上/ ,/ 采用/ DD/ 方法/ 可/ 获得/ 0.1/ 分/ 以上/ 的/ 提高/ ,/ 即/ 可以/ 少/ 检查/ 10/ %/ 以上/ 的/ 代码/ ./ 另外/ ,/ 共/ 155/ 个/ 版本/ 中/ ,/ 有/ 11.6/ %/ 的/ 版本/ 采用/ 5.3/ ./ 2/ 错误/ 定位/ 效果/ 比较/ 在/ 5.1/ 节所/ 给出/ 的/ 评分/ 方法/ 的/ 基础/ 上/ ,/ 本/ 节/ 结合/ 所得/ 的/ 具体/ 数据/ ,/ 绘制/ 了/ 3/ 个/ 图表/ 以/ 比较/ NN/ 方法/ 和/ 差异/ 分散化/ 方法/ 的/ 错误/ 定位/ 效果/ ./ 图/ 7/ 展示/ 了/ 所有/ 程序/ 版本/ 上/ 的/ 错误/ 定位/ 效果/ 评分/ 情况/ ./ 其中/ ,/ 横坐标/ 列出/ 了/ 所有/ 程序/ 版本/ ,/ 纵坐标/ 给出/ 了/ 各/ 程序/ 版本/ 上/ 的/ 错误/ 定位/ 评分/ ./ 空心/ 柱/ 表示/ DD/ 方法/ 的/ 评分/ ,/ 实心/ 柱/ 表示/ NN/ 方法/ 的/ 评分/ ./ 所有/ 程序/ 版本/ 按照/ DD/ 方法/ 评分/ 与/ NN/ 方法/ 评分/ 差值/ 的/ 高低/ 进行/ 排序/ ,/ 左边/ 的/ 版本/ DD/ 方法/ 效果/ 更好/ ,/ 右边/ 的/ 版本/ NN/ 方法/ 效果/ 更好/ ./ 在/ 图/ 中/ ,/ 对于/ 最/ 左边/ 的/ 18/ 个/ 程序/ 版本/ ,/ NN/ 方法/ 得到/ 的/ 差异/ 报告/ 为空/ ,/ 无法/ 定位/ 错误/ ,/ 而/ DD/ 方法/ 可以/ 正常/ 定位/ 错误/ ./ 除去/ 这些/ 版本/ ,/ 约/ 60/ %/ 的/ 程序/ 版本/ 采用/ DD/ 方法/ 效果/ 更好/ ./ 即/ 对于/ 多数/ 程序/ 版本/ ,/ 采用/ 差异/ 分散化/ 方法/ 的/ 错误/ 定位/ 效果/ 好于/ 采用/ NN/ 方法/ ./ 图/ 8/ 评分/ 差异/ 与/ 相应/ 程序/ 版本/ 个数/ 的/ 分布图/ NN/ 方法/ 无法/ 定位/ 错误/ ,/ 而/ 采用/ DD/ 方法/ 可以/ ./ 总体/ 来看/ ,/ 对于/ 更/ 多/ 的/ 程序/ 版本/ ,/ 选择/ 差异/ 分散化/ 方法/ 对/ 获得/ 好/ 的/ 错误/ 定位/ 效果/ 更为/ 有利/ ./ 图/ 9/ 以/ 柱状图/ 的/ 方式/ 给出/ 了/ 采用/ NN/ 方法/ 和/ Page10DD/ 方法/ 对/ 各个/ 实验/ 对象/ 进行/ 错误/ 定位/ 所得/ 的/ 平均/ 评分/ ./ 由图/ 可见/ ,/ 对于/ 实验/ 对象/ print/ _/ tokens2/ 、/ replace/ 、/ schedule/ 以及/ tot/ _/ info/ ,/ DD/ 方法/ 的/ 定位/ 效果/ 评分/ 明显/ 好于/ NN/ 方法/ ;/ 对于/ 实验/ 对象/ print/ _/ tokens/ 和/ space/ ,/ DD/ 方法/ 的/ 评分/ 略/ 高/ ;/ 而/ 对于/ 实验/ 对象/ schedule2/ 和/ tcas/ ,/ DD/ 方法/ 的/ 评分/ 则/ 不如/ NN/ 方法/ ./ 总体/ 来看/ ,/ 采用/ DD/ 方法/ ,/ 大部分/ 程序/ 的/ 错误/ 定位/ 效果/ 都/ 比/ NN/ 方法/ 好/ ,/ 只有/ 少数/ 程序/ 定位/ 效果/ 比/ NN/ 方法/ 差/ ./ 其中/ ,/ 对于/ space/ 程序/ ,/ 在/ 可以/ 进行/ 错误/ 定位/ 的/ 37/ 个/ 版本/ 中/ ,/ DD/ 方法/ 和/ NN/ 方法/ 各自/ 具有/ 优势/ 的/ 版本/ 大约/ 各/ 占/ 一半/ ,/ 平均/ 评分/ DD/ 方法/ 比/ NN/ 方法/ 高/ 0.2/ %/ ,/ 尽管/ 优势/ 不是/ 非常明显/ ,/ 但/ 考虑/ 到/ DD/ 方法/ 具有/ 更佳/ 的/ 性能/ (/ 如表/ 2/ 所示/ )/ ,/ 该/ 方法/ 仍/ 值得/ 采用/ ./ 对于/ 部分/ 程序/ ,/ 差异/ 分散化/ 方法/ 定位/ 效果/ 不如/ NN/ 方法/ 的/ 主要/ 原因/ 是/ ,/ NN/ 方法/ 所得/ 的/ 差异/ 点/ 比较/ 幸运地/ 离/ bug/ 很近/ ,/ 而/ 该/ 方法/ 所得/ 的/ 差异/ 点/ 一般/ 情况/ 下/ 更少/ ,/ 因此/ 相应/ 的/ 评分/ 也/ 就/ 更/ 高/ ./ 另外/ ,/ 一些/ 情况/ 下/ ,/ 差异/ 比较/ 固定/ ,/ 这/ 也/ 削弱/ 了/ 筛选/ 的/ 作用/ ./ 事实上/ ,/ DD/ 方法/ 只是/ 尽可能/ 地/ 规避/ 了/ 差异/ 离/ bug/ 很远/ 的/ 风险/ ,/ 因此/ 并/ 不/ 总能/ 保证/ 差异/ 点/ 一定/ 比/ NN/ 方法/ 离/ bug/ 更近/ ./ 总体/ 来看/ ,/ 多数/ 情况/ 下/ ,/ DD/ 方法/ 可以/ 体现/ 其/ 减少/ 差异/ 点/ 与/ bug/ 距离/ 的/ 作用/ ,/ 只有/ 少数/ 情况/ 下/ 作用/ 较弱/ ./ 我们/ 也/ 统计/ 了/ 对于/ 所有/ 程序/ 的/ 定位/ 效果/ 平均/ 评分/ ./ 结果显示/ ,/ NN/ 方法/ 的/ 平均/ 评分/ 约/ 65/ %/ ,/ DD/ 方法/ 的/ 平均/ 评分/ 约/ 68/ %/ ./ 即/ 就/ 所有/ 程序/ 的/ 平均/ 情况/ 而言/ ,/ 基于/ 差异/ 分散化/ 的/ 错误/ 定位/ 需要/ 检查/ 的/ 代码/ 更/ 少/ ,/ 定位/ 效果/ 更好/ ./ 图/ 7/ ~/ 图/ 9/ 综合/ 表明/ ,/ 较之/ NN/ 方法/ ,/ 差异/ 分散化/ 方法/ 能够/ 成功/ 进行/ 错误/ 定位/ 的/ 程序/ 版本/ 更/ 多/ ,/ 不仅/ 能/ 在/ 更/ 多/ 的/ 程序/ 版本/ 上/ 取得/ 更好/ 的/ 错误/ 定位/ 效果/ ,/ 而且/ 总体/ 的/ 平均/ 错误/ 定位/ 效果/ 也/ 更佳/ ./ 5.3/ ./ 3/ 定位/ 效率/ 比较/ 为/ 评估/ 错误/ 定位/ 效率/ ,/ 本文/ 在/ WindowsServer2008R2/ 操作系统/ ,/ IntelCorei5760CPU/ ,/ 16GBRAM/ 的/ 机器/ 上/ 收集/ 了/ DD/ 方法/ 和/ NN/ 方法/ 为/ 每个/ 实验/ 程序/ 各/ 版本/ 获得/ 错误/ 定位/ 报告/ 所/ 需/ 的/ 平均/ 时间/ ./ 表/ 2/ 给出/ 了/ 具体/ 的/ 时间/ 数据/ ,/ 其中/ 的/ 值/ 依据/ 5.1/ 节/ 给出/ 的/ 方法/ 获得/ ./ 表/ 2/ 各/ 程序/ 在/ 两种/ 方法/ 下/ 获得/ 错误/ 定位/ 报告/ 的/ 平均/ 时间/ print/ _/ tokensprint/ _/ tokens2replacescheduleschedule2tcastot/ _/ infospace/ 由表/ 2/ 可见/ ,/ DD/ 方法/ 进行/ 错误/ 定位/ 所/ 需/ 的/ 时间/ 大约/ 只有/ NN/ 方法/ (/ 基于/ Ulam/ 距离/ )/ 的/ 2/ %/ ~/ 20/ %/ 左右/ ,/ 特别/ 是/ 对于/ space/ 这样/ 的/ 大型/ 程序/ ,/ 优势/ 更是/ 显著/ ./ 显然/ ,/ 差异/ 分散化/ 方法/ 的/ 错误/ 定位/ 效率/ 比/ NN/ 方法/ 更高/ ./ 造成/ 上述/ 现象/ 的/ 一个/ 重要/ 原因/ 是/ 差异/ 分散化/ 方法/ 只/ 需要/ 进行/ 简单/ 的/ 方差/ 计算/ ,/ 而/ 不/ 需要/ 做/ 复杂/ 的/ 编辑/ 距离/ 运算/ ./ 5.4/ 威胁/ 实验/ 有效性/ 的/ 因素/ 本/ 实验/ 中有/ 一些/ 因素/ 可能/ 威胁/ 实验/ 的/ 有效性/ ./ 首先/ ,/ 尽管/ 我们/ 的/ 实验/ 代码/ 已经/ 仔细检查/ 测试/ ,/ 但/ 仍/ 不/ 排除/ 存在/ 错误/ 的/ 可能性/ ./ 代码/ 中/ 不当/ 的/ 误差/ 传播/ ,/ 也/ 可能/ 对/ 实验/ 数据/ 有/ 一些/ 影响/ ./ 另外/ ,/ 本文/ 虽然/ 重新/ 实现/ 了/ 文献/ [/ 1/ ]/ 中/ 描述/ 的/ NN/ 方法/ ,/ 但/ 由于/ 相关/ 实现/ 细节/ 并/ 不/ 完全/ 清楚/ ,/ 因此/ ,/ 也/ 不/ 排除/ 不同/ 实验/ 设置/ 影响/ 数据/ 和/ 实验/ 结论/ 的/ 可能性/ ./ 实验/ 对象/ 中/ ,/ 有/ 极少数/ 程序/ 版本/ 运行/ 时/ 发生/ 崩溃/ ,/ 本文/ 排除/ 了/ 它们/ ,/ 这些/ 版本/ 也/ 有/ 可能/ 影响/ 实验/ 结论/ ./ 再者/ ,/ 实验/ 中/ ,/ 我们/ 取/ 6/ %/ ~/ 8/ %/ 作为/ 差异/ 覆盖度/ 范围/ ,/ 该/ 范围/ 只是/ 一个/ 指导性/ 的/ 范围/ ,/ 其它/ 范围/ 也/ 有/ 可能/ 取得/ 更好/ 的/ 结论/ ,/ 不同/ 类型/ 的/ 软件/ 也/ 可能/ 需要/ 不同/ 的/ 范围/ ./ 最后/ ,/ 本文/ 只/ 在/ Siemens/ 程序/ 集/ 和/ space/ 程序/ 上/ 进行/ 了/ 实验/ 验证/ ,/ 相关/ 结论/ 是否/ 可以/ 推广/ 到/ 其它/ 程序/ 上/ ,/ 还有/ 待/ 更/ 多/ 的/ 研究/ ./ 6/ 相关/ 工作/ 已有/ 的/ 基于/ 测试/ 的/ 错误/ 定位/ 方法/ 主要/ 包括/ 基于/ 多个/ 执行/ 覆盖/ 统计/ 的/ 方法/ [/ 6/ -/ 8/ ]/ 、/ 基于/ 多个/ 执行/ 谓词/ 统/ Page11/ 计/ 的/ 方法/ [/ 9/ -/ 11/ ]/ 、/ 因果/ 链/ 调试/ 法/ [/ 12/ -/ 13/ ]/ 、/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ [/ 1/ ,/ 14/ -/ 15/ ]/ 等/ ./ 不同/ 类型/ 的/ 方法/ 各有特点/ ./ 其中/ ,/ 基于/ 多个/ 执行/ 覆盖/ 统计/ 的/ 方法/ 收集/ 成功/ 或/ 失败/ 执行/ 的/ 代码/ 覆盖/ ,/ 据此/ 对/ 语句/ 进行/ 出错/ 可疑/ 度/ 排序/ ,/ 来/ 定位/ 错误/ ./ Jones/ 等/ 人/ [/ 6/ ]/ 首先/ 根据/ 语句/ 在/ 成功/ 和/ 失败/ 执行/ 中/ 的/ 出现/ 次数/ 来/ 推定/ 可疑/ 度/ ./ Wong/ 等/ 人/ [/ 7/ ]/ 考虑/ 了/ 不同/ 测试用例/ 的/ 权重/ ,/ 改进/ 了/ 定位/ 效果/ ./ Naish/ 等/ 人/ [/ 8/ ]/ 研究/ 了/ 不同/ 可疑/ 度/ 计算公式/ 下/ 的/ 错误/ 定位/ 情况/ ,/ 为/ 公式/ 选择/ 提供/ 了/ 指南/ ./ 与/ 基于/ 覆盖/ 的/ 错误/ 定位/ 不同/ ,/ 基于/ 多个/ 执行/ 谓词/ 统计/ 的/ 方法/ 收集/ 谓词/ 的/ 取值/ ,/ 而/ 不是/ 代码/ 覆盖/ ,/ 来/ 统计/ 定位/ 错误/ ,/ 其/ 定位/ 结果/ 主要/ 是/ 与/ 失效/ 高度/ 相关/ 的/ 谓词/ ./ Liblit/ 等/ 人/ [/ 9/ ]/ 通过/ 对/ 谓词/ 和/ 失效/ 进行/ 相关性/ 分析/ 来/ 定位/ 错误/ ./ Liu/ 等/ 人/ [/ 10/ ]/ 对/ 谓词/ 的/ 取值/ 规律/ 进行/ 分析/ ,/ 并/ 将/ 那些/ 在/ 失败/ 执行/ 中/ 和/ 成功/ 执行/ 中/ 取值/ 规律/ 明显/ 不同/ 的/ 谓词/ 汇报/ 作为/ 可疑/ 错误/ ./ Nainar/ 等/ 人/ [/ 11/ ]/ 改进/ 了/ 谓词/ 取值/ 的/ 监控/ 方法/ ,/ 提高/ 了/ 基于/ 谓词/ 统计/ 的/ 错误/ 定位/ 方法/ 的/ 效率/ ./ 上述/ 方法/ 在/ 排序/ 可疑/ bug/ 语句/ 方面/ ,/ 可以/ 取得/ 很/ 好/ 的/ 定位/ 效果/ ,/ 但/ 它们/ 要/ 取得/ 好/ 的/ 结果/ 往往/ 需要/ 多于/ 一个/ 的/ 失败/ 执行/ ,/ 而且/ 这些/ 方法/ 与/ 太/ 多/ 的/ 执行/ 相关/ ,/ 所得/ 的/ 结果/ 并/ 不/ 便于/ 后续/ 的/ 人工/ 分析/ ./ 与/ 之/ 相比/ ,/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ 只/ 需要/ 一个/ 失败/ 执行/ ,/ 所得/ 的/ 结果/ 线索/ 清晰/ ,/ 可用/ 来/ 和/ 一对/ 成功/ -/ 失败/ 执行/ 一起/ 进行/ 对照/ 分析/ ,/ 因此/ 对于/ 后续/ 进一步/ 的/ 人工/ 错误诊断/ 和/ 修复/ 更为/ 有利/ ./ 我们/ 认为/ ,/ 任何/ 一个/ 错误/ 定位/ 方法/ 都/ 不/ 可能/ 完美/ ,/ 后续/ 的/ 人工/ 分析/ 是/ 必须/ 的/ ,/ 选择/ 一个/ 对/ 后续/ 分析/ 更/ 有利/ 的/ 错误/ 定位/ 方法/ ,/ 在/ 许多/ 情况/ 下/ 有/ 很大/ 价值/ ./ 因此/ ,/ 基于/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ 仍/ 值得/ 进一步/ 研究/ ./ 这类/ 方法/ 中/ ,/ 目前/ 并/ 没有/ 对/ 可疑/ bug/ 语句/ 进行/ 排序/ ,/ 未来/ 也/ 可/ 类似/ [/ 6/ -/ 11/ ]/ ,/ 结合/ 一个/ 排序/ 机制/ 来/ 进一步提高/ 错误/ 定位/ 的/ 精度/ ./ Zeller/ 等/ 人/ [/ 12/ -/ 13/ ]/ 的/ 基于/ 因果/ 链/ 的/ 调试/ 方法/ 采用/ DeltaDebugging/ 技术/ [/ 12/ ]/ ,/ 修改/ 程序/ 状态/ 来/ 获得成功/ 执行/ ,/ 与/ 失败/ 执行/ 进行/ 比较/ ,/ 从而/ 定位/ 导致/ 失效/ 的/ 程序/ 状态/ [/ 12/ ]/ 及其/ 传递/ 过程/ [/ 13/ ]/ ./ 它们/ 的/ 方法/ 与/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ 类似/ ,/ 都/ 是/ 比较/ 一对/ 执行/ 来/ 定位/ 错误/ ,/ 前者/ 比较/ 程序/ 状态/ ,/ 后者/ 比较/ 执行/ 的/ 代码/ ./ 相比/ 于/ 基于/ 状态/ 比较/ 的/ 方法/ ,/ 基于/ 执行/ 代码/ 比较/ 的/ 方法/ 更/ 易于/ 实现/ ,/ 更/ 轻量级/ ./ 我们/ 认为/ ,/ 这/ 两种/ 方法/ 并不矛盾/ ,/ 未来/ 可/ 考虑/ 将/ 程序/ 状态/ 比较/ 和/ 执行/ 代码/ 比较/ 结合/ 起来/ ,/ 以/ 获得/ 更佳/ 的/ 错误/ 定位/ 效果/ ./ 在/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方面/ ,/ Renieris/ 和/ Reiss/ [/ 1/ ]/ 的/ 工作/ 之后/ ,/ Guo/ 等/ 人/ [/ 14/ ]/ 对/ 文献/ [/ 1/ ]/ 中/ 的/ 方法/ 进行/ 了/ 改进/ ,/ 给出/ 了/ 另/ 一种/ 执行/ 间/ 距离/ 的/ 度量/ 方法/ ,/ 新/ 方法/ 考虑/ 了/ 程序/ 中/ 语句/ 的/ 执行/ 顺序/ ,/ 而/ 不仅仅/ 是/ 覆盖/ 情况/ ./ 另外/ ,/ Guo/ 等/ 人/ 以/ 造成/ 差异/ 的/ 分支/ 语句/ 作为/ 最终/ 的/ 错误/ 定位/ 报告/ ./ 尽管/ 有所改进/ ,/ 但/ 文献/ [/ 14/ ]/ 的/ 方法/ 和/ NN/ 方法/ 本质/ 是/ 一样/ 的/ ,/ 都/ 以/ 差异/ 量/ 最小/ 作为/ 选择/ 成功/ 执行/ 进行/ 错误/ 定位/ 的/ 依据/ ./ 该/ 方法/ 还/ 存在/ 另外/ 一个/ 问题/ ,/ 即/ 需要/ 收集/ 完整/ 的/ 程序执行/ 轨迹/ ,/ 并且/ 对/ 之/ 进行/ 复杂/ 的/ 对齐/ 处理/ ,/ 这/ 对于/ 大型/ 程序/ 无疑/ 代价/ 庞大/ ./ 因/ 实现/ 困难/ ,/ 我们/ 没有/ 与/ Guo/ 等/ 人/ 的/ 方法/ 进行/ 实验/ 对比/ ./ 由于/ 本文/ 的/ 方法/ 只/ 需要/ 收集/ 简单/ 的/ 基本块/ 覆盖/ 信息/ ,/ 而/ 不用/ 采集/ 程序执行/ 轨迹/ ,/ 因此/ 可以/ 肯定/ 的/ 是/ ,/ 我们/ 的/ 方法/ 比/ 他们/ 的/ 方法/ 更加/ 高效/ ./ Guo/ 等/ 人用/ 分支/ 语句/ 作为/ 错误/ 定位/ 报告/ ,/ NN/ 方法/ 和/ 本文/ 给出/ 的/ 方法/ 也/ 可以/ 类似/ 地/ 进行/ 改进/ ./ 如此/ ,/ 将/ 可以/ 得到/ 更好/ 的/ 错误/ 定位/ 效果/ ./ 除了/ 直接/ 给出/ 错误/ 定位/ 报告/ 之外/ ,/ Zhang/ 等/ 人/ [/ 15/ ]/ 还/ 结合/ 基于/ 最/ 接近/ 执行/ 的/ 错误/ 定位/ 技术/ 、/ 动态/ 程序/ 切片/ 、/ 程序/ 状态/ 比较/ 等/ ,/ 给出/ 了/ 一种/ 断点/ 设置/ 方法/ ,/ 通过/ 自动/ 设置/ 断点/ ,/ 可/ 指导/ 用户/ 更/ 高效/ 地/ 进行/ 调试/ ./ 尽管/ 比较/ 失败/ 执行/ 和/ 与/ 之/ 接近/ 的/ 成功/ 执行/ 来/ 定位/ 错误/ 的/ 方法/ 非常/ 有效/ ,/ 但/ 有时/ 现场/ 并/ 没有/ 成功/ 执行/ 可用/ ./ 为此/ ,/ 文献/ [/ 16/ -/ 19/ ]/ 提出/ 了/ 基于/ 谓词/ 替换/ 和/ 值/ 替换/ 的/ 错误/ 定位/ 方法/ ,/ 基本/ 思想/ 是/ 通过/ 改变/ 少量/ 程序/ 状态/ 来/ 获得/ 与/ 失败/ 执行/ 较/ 接近/ 的/ 成功/ 执行/ ,/ 以/ 进行/ 比较/ ./ 除此以外/ ,/ Qi/ 等/ 人/ [/ 20/ ]/ 借鉴/ 了/ 最近/ 执行/ 的/ 思想/ 来/ 定位/ 演化/ 程序/ 中/ 的/ 错误/ ,/ 该/ 工作/ 采用/ 了/ 符号执行/ 技术/ 来/ 产生/ 最/ 接近/ 的/ 执行/ ./ Artzi/ 等/ 人/ [/ 21/ ]/ 采用/ 了/ 基于/ 多个/ 执行/ 统计分析/ 的/ 方法/ 来/ 进行/ 错误/ 定位/ ,/ 但/ 该/ 工作/ 中/ 也/ 借鉴/ 了/ 最近/ 执行/ 的/ 思想/ ,/ 利用/ 符号执行/ 技术/ 来/ 生成/ 与/ 失败/ 执行/ 相/ 接近/ 的/ 测试用例/ 集/ ,/ 以便/ 于/ 利用/ 优化/ 的/ 测试/ 集/ 更/ 高效/ 地/ 定位/ 错误/ ./ 7/ 总结/ 与/ 未来/ 工作/ 本文/ 从/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 错误/ 定位/ 方法/ 入手/ ,/ 分析/ 了/ 基于/ 成功/ -/ 失败/ 执行/ 比较/ 的/ 错误/ 定位/ 的/ 基本/ 模型/ ,/ 总结/ 了/ 该/ 模型/ 下/ 影响/ 错误/ 定位/ 效果/ 的/ 两个/ 关键因素/ :/ 差异/ 量/ 和/ 差异/ 与/ 错误/ 的/ 距离/ ./ 并/ 根据/ 该/ 模型/ ,/ 提出/ 了/ 一种/ 差异/ 分散化/ 的/ 错误/ 定位/ 方法/ ./ 核心思想/ 是/ 在/ 适当/ 控制/ 差异/ 数量/ 的/ 基础/ 上/ ,/ 通过/ 差异/ 分散化/ ,/ 使得/ 部分/ 差异/ 能够/ 更/ 有/ 机会/ 接近/ 错误/ ,/ 从而/ 减小/ 错误/ 定位/ 代价/ ./ 我们/ 对/ 所/ 提出/ 的/ 方法/ 进行/ 了/ 实验/ 分析/ ,/ 结果表明/ ,/ 差异/ 分散化/ 方法/ 较之/ 基于/ 最/ 接近/ 执行/ 比较/ 的/ 方法/ ,/ 具有/ 更好/ 的/ 错误/ 定位/ 效果/ ,/ 同时/ 定位/ 错/ Page12/ 误/ 花费/ 的/ 时间/ 更/ 少/ ,/ 定位/ 效率/ 更高/ ./ 在/ 未来/ 工作/ 中/ ,/ 拟/ 首先/ 进一步/ 改进/ 本文/ 的/ 方法/ ,/ 研究/ 更/ 精致/ 的/ 差异/ 与/ bug/ 距离/ 、/ 差异/ 量/ 控制/ 的/ 方法/ ,/ 使/ 之/ 能够/ 更/ 准确/ 地/ 定位/ 到/ 程序/ 错误/ ./ 另外/ ,/ 拟/ 对/ 包含/ 数据/ 差异/ 的/ 错误/ 定位/ 模型/ 进行/ 更/ 深入分析/ ,/ 使得/ 错误/ 定位/ 方法/ 能够/ 更/ 全面/ 地/ 利用/ 测试/ 信息/ ./ 致谢/ 感谢/ 匿名/ 审稿人/ 的/ 意见/ ,/ 它们/ 使/ 本文/ 的/ 质量/ 有/ 了/ 进一步提高/ !/ 

