Page1/ 前向/ 隐私/ 安全/ 的/ 低成本/ RFID/ 认证/ 协议/ 马昌社/ (/ 华南/ 师范大学/ 计算机/ 学院/ 广州/ 510631/ )/ 摘要/ 标签/ 成本/ 和/ 隐私/ 安全/ 是/ 制约/ RFID/ 技术/ 在/ 物/ 联网/ 中/ 得到/ 广泛应用/ 的/ 主要/ 因素/ ./ 因此/ ,/ 设计/ 隐私/ 安全/ 且/ 标签/ 生产/ 成本低/ 的/ RFID/ 认证/ 协议/ 是/ 学术界/ 和/ 工业界/ 共同/ 追求/ 的/ 目标/ ./ 针对/ 这一/ 目标/ ,/ 利用/ 只/ 需要/ 实现/ 伪/ 随机数/ 发生器/ 的/ 标签/ 构造/ 了/ 简单/ 的/ RFID/ 认证/ 协议/ SFP/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ SFP/ 协议/ 具有/ 前向/ 隐私/ 安全性/ ./ 为了/ 说明/ 在/ 保证/ 前向/ 隐私/ 的/ 条件/ 下/ SFP/ 协议/ 的/ 标签/ 生产/ 成本低/ ,/ 证明/ 了/ 标签/ 具有/ 产生/ 伪/ 随机数/ 的/ 能力/ 是/ 保证/ RFID/ 前向/ 隐私/ 的/ 必要条件/ ./ 因此/ ,/ 与/ 现有/ RFID/ 协议/ 相/ 比较/ ,/ SFP/ 协议/ 不但/ 计算/ 和/ 通信/ 效率高/ ,/ 而且/ 同时/ 保证/ 了/ 前/ 向/ 隐私/ 安全/ 和/ 低/ 标签/ 生产成本/ ,/ 实现/ 了/ RFID/ 技术/ 低/ 标签/ 成本/ 和/ 高/ 隐私/ 安全/ 的/ 结合/ ./ 关键词/ RFID/ ;/ 认证/ 协议/ ;/ 前向/ 隐私/ 性/ ;/ 可/ 证明/ 隐私/ ;/ 伪/ 随机数/ 发生器/ ;/ 物/ 联网/ 1/ 引言/ 知层/ 的/ 关键技术/ 之一/ ,/ 它/ 为/ 物体/ 和/ 对象/ 提供/ 非/ 接触式/ 、/ 即时/ 识别/ 的/ 功能/ [/ 2/ -/ 3/ ]/ ./ 尽管/ 物/ 联网/ 的/ 潜在/ 商业/ 应用/ 前景/ 美好/ [/ 4/ ]/ ,/ 但是/ 成本/ 和/ 隐私/ 安全/ 始终/ 制约/ 着物/ 联网/ 应用/ 的/ 广泛开展/ ,/ 该/ 问题/ 主要/ 涉及/ RFID/ 技术/ 的/ 低成本/ 与/ 高/ 隐私/ 安全/ 结合/ 的/ 问题/ [/ 5/ -/ 6/ ]/ ./ 工业界/ 从/ 低/ 标签/ 成本/ 要求/ 出发/ 设计/ 出来/ 的/ RFID/ 技术/ 不能/ 保证/ Page2/ 隐私/ 安全性/ [/ 7/ ]/ ;/ 而/ 学术界/ 从/ 隐私/ 安全/ 角度/ 出发/ 设计/ 的/ RFID/ 技术/ 不能/ 满足/ 人们/ 对/ 低/ 标签/ 成本/ 的/ 要求/ ./ 因此/ ,/ 一个/ 亟待解决/ 的/ 问题/ 是/ :/ 能否/ 设计/ 出/ 同时/ 具有/ 低/ 标签/ 成本/ 和/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ ?/ 因为/ 标签/ 的/ 成本/ 主要/ 取决于/ 其/ 计算能力/ ①/ ,/ 因此/ 换/ 一句/ 话/ 说/ ,/ 能否/ 设计/ 出/ 标签/ 计算能力/ 要求/ 低且/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ ?/ 对/ 这个/ 问题/ 的/ 回答/ ,/ 有助于/ 工业界/ 和/ 学术界/ 的/ 结合/ ,/ 以较/ 低/ 的/ 代价/ 获得/ RFID/ 隐私/ 安全/ ,/ 为物/ 联网/ 的/ 应用/ 和/ 发展/ 奠定/ 理论/ 基础/ ./ 为了/ 得到/ 同时/ 具有/ 隐私/ 安全/ 和/ 低/ 标签/ 生产成本/ 的/ RFID/ 认证/ 协议/ ,/ 本文/ 专门/ 研究/ 前向/ 隐私/ 安全/ [/ 6/ ]/ 的/ RFID/ 认证/ 协议/ 的/ 构造/ 和/ RFID/ 前向/ 隐私/ 安全/ 对/ 标签/ 计算能力/ 的/ 要求/ ./ 首先/ ,/ 利用/ 只/ 需要/ 实现/ 伪/ 随机数/ 的/ 标签/ 构造/ 了/ 一个/ 简单/ 的/ RFID/ 认证/ 协议/ SFP/ (/ SimpleandForwardPrivate/ )/ ,/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ SFP/ 协议/ 具有/ 前向/ 隐私/ 安全/ ./ 其次/ ,/ 为了/ 说明/ 在/ 保证/ 前向/ 隐私/ 安全/ 的/ 条件/ 下/ SFP/ 协议/ 的/ 标签/ 生产/ 成本低/ ,/ 证明/ 了/ 标签/ 具有/ 产生/ 伪/ 随机数/ 的/ 能力/ 是/ 保证/ 前向/ 隐私/ 的/ 必要条件/ ②/ ./ 从/ 这点/ 来看/ ,/ SFP/ 协议/ 的/ 标签/ 恰好/ 满足/ 前向/ 隐私/ 对/ 标签/ 计算能力/ 的/ 最低/ 要求/ ,/ 这/ 意味着/ SFP/ 协议/ 的/ 标签/ 具有/ 更/ 低/ 的/ 生产成本/ ./ 因此/ ,/ 与/ 现有/ 可/ 证明/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ 相/ 比较/ ,/ SFP/ 协议/ 不但/ 计算/ 和/ 通信/ 效率高/ ,/ 而且/ 能够/ 同时/ 保证/ 前向/ 隐私/ 和/ 低/ 标签/ 生产成本/ ./ 本文/ 工作/ 不但/ 实现/ 了/ RFID/ 前向/ 隐私/ 安全/ 和/ 低/ 标签/ 生产成本/ 的/ 结合/ ,/ 而且/ 为/ RFID/ 隐私/ 安全/ 协议/ 的/ 设计/ 提供/ 了/ 蓝本/ ./ 本文/ 第/ 2/ 节/ 回顾/ RFID/ 隐私/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节/ 介绍/ 描述/ SFP/ 协议/ 和/ 分析/ 其/ 安全性/ 需要/ 的/ 数学/ 符号/ 和/ 安全/ 模型/ ;/ 第/ 4/ 节/ 提出/ 前向/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ SFP/ ,/ 并/ 对/ 其/ 进行/ 安全/ 和/ 成本/ 分析/ ;/ 第/ 5/ 节对/ 新/ 协议/ SFP/ 和/ 现有/ 协议/ 进行/ 效率/ 比较/ ;/ 最后/ ,/ 第/ 6/ 节/ 总结/ 全文/ ./ 2RFID/ 隐私/ 相关/ 研究/ 目前/ ,/ 业界/ 对/ RFID/ 隐私/ 的/ 研究/ 主要/ 从/ 两个/ 方面/ 进行/ ./ 一方面/ ,/ 设计/ 轻量级/ 的/ RFID/ 认证/ 协议/ ,/ 提出/ 了/ 若干/ 兼容/ EPCC1G2/ 标准/ 的/ RFID/ 隐私/ 安全/ 解决方案/ 和/ 协议/ [/ 8/ -/ 10/ ]/ ,/ 但是/ 它们/ 都/ 不/ 具有/ 完善/ 的/ 隐私/ 安全性/ ./ 另一方面/ ,/ 研究/ RFID/ 隐私/ 安全/ 模型/ ,/ 目前/ 已/ 提出/ 了/ 分别/ 基于/ 不可/ 区分/ 性/ 和/ 不/ 可预测性/ 的/ 安全/ 模型/ [/ 5/ ]/ ./ 在/ 轻量级/ RFID/ 协议/ 设计/ 方面/ ,/ 采用/ 简单/ 操作/ (/ 比如/ :/ 比/ 特异/ 或/ 、/ 比特/ 内积/ 、/ 16bits/ 的/ 随机数/ 发生器/ 等/ )/ ,/ 文献/ [/ 9/ -/ 10/ ]/ 分别/ 设计/ 了/ 简单/ 的/ RFID/ 双向/ 认证/ 协议/ ./ 然而/ ,/ 这/ 两个/ 协议/ 都/ 容易/ 遭到/ 隐私/ 攻击/ [/ 11/ ]/ ./ 采用/ 对称/ 密码/ 技术/ ,/ 文献/ [/ 12/ ]/ 首次/ 提出/ 了/ 一个/ 基于/ 树/ 的/ RFID/ 认证/ 系统/ ,/ 然而/ 该/ 系统/ 不能/ 抵抗/ 主动攻击/ ./ 实际上/ ,/ 在/ 基于/ 树/ 的/ RFID/ 系统/ 中/ ,/ 所有/ 标签/ 之间/ 需要/ 或多或少/ 地/ 共享/ 某些/ 秘密/ 信息/ ,/ 读取/ 某一/ 标签/ 的/ 内部/ 状态/ 后/ ,/ 可以/ 利用/ 它/ 攻击/ 其它/ 标签/ 的/ 隐私/ 性/ ,/ 因此/ 基于/ 树/ 的/ RFID/ 系统/ [/ 13/ ]/ 都/ 不能/ 抵抗/ 主动/ 跟踪/ 攻击/ ./ 基于/ Hash/ 函数/ ,/ 文献/ [/ 14/ ]/ 设计/ 了/ 一个/ 具有/ 前向/ 隐私/ 安全/ 的/ RFID/ 系统/ (/ OSK/ 协议/ )/ ,/ 但是/ 该/ 系统/ 的/ 可扩展性/ 不好/ ,/ 因为/ 阅读器/ 端/ 识别/ 标签/ 所/ 需要/ 的/ 计算/ 量/ 与/ RFID/ 系统/ 中/ 标签/ 的/ 数目/ 成/ 线性关系/ ./ Avoine/ 和/ Oechslin/ [/ 15/ ]/ 利用/ 时间/ 存储/ 权衡/ 技术/ 对/ OSK/ 协议/ 进行/ 了/ 优化/ ./ 然而/ ,/ 优化/ 后/ 的/ 协议/ 仍然/ 不/ 具有/ 良好/ 的/ 可扩展性/ ,/ 同时/ 易于/ 遭受/ 身份/ 假冒/ 攻击/ [/ 16/ -/ 17/ ]/ ./ 此后/ ,/ 研究者/ 们/ 采用/ 状态/ 同步/ 技术/ 并/ 结合/ Hash/ 链/ 提出/ 了/ 各种各样/ 的/ RFID/ 认证/ 协议/ ,/ 比如/ :/ Tsudik/ 提出/ 了/ 基于/ 时间/ 同步/ 的/ YATRAP/ 协议/ [/ 18/ ]/ ,/ 分析表明/ YATRAP/ 协议/ 易于/ 遭受/ 异步/ 攻击/ ;/ 随后/ ,/ Burmester/ 等/ 人/ [/ 19/ ]/ 提出/ 了/ YATRAP/ +/ 协议/ 和/ OTRAP/ 协议/ ,/ 这/ 两个/ 协议/ 克服/ 了/ 异步/ 攻击/ ./ 然而/ ,/ 文献/ [/ 7/ ]/ 指出/ 了/ 现有/ RFID/ 协议/ 中/ 的/ 大部分/ 仍/ 不/ 具有/ 隐私/ 安全性/ ./ 另外/ ,/ 文献/ [/ 20/ ]/ 设计/ 了/ 基于/ LPN/ 问题/ 的/ RFID/ 认证/ 方案/ ,/ 与/ 所有/ 基于/ LPN/ 问题/ 的/ RFID/ 认证/ 协议/ 一样/ ,/ 该/ 方案/ 只/ 提供/ 认证/ 性/ ,/ 不/ 具有/ 隐私/ 安全性/ ./ 因此/ ,/ 如何/ 设计/ 高效/ 且/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ 仍/ 需/ 进一步/ 研究/ ./ 在/ RFID/ 安全/ 模型/ 方面/ ,/ 早/ 在/ 2006/ 年/ ,/ 周永彬/ 和/ 冯登国/ [/ 21/ ]/ 对/ RFID/ 协议/ 的/ 认证/ 安全性/ 进行/ 了/ 分析/ ,/ 提出/ 了/ RFID/ 协议/ 的/ 认证/ 模型/ ./ Avoine/ [/ 22/ ]/ 对/ RFID/ 协议/ 的/ 隐私/ 性/ 进行/ 了/ 抽象/ 并/ 提出/ 相应/ 的/ 隐私/ 安全/ 模型/ (/ 简称/ Avoine/ 模型/ )/ ,/ 然而/ 该/ 模型/ 没有/ 考虑/ 主动攻击/ ./ 后来/ ,/ 在/ Avoine/ 模型/ 的/ 基础/ 上/ ,/ Juels/ 等/ 人/ [/ 23/ ]/ 提出/ 了/ 基于/ 不可/ 区分/ 性/ 的/ RFID/ 隐私/ 模型/ (/ 简称/ Ind/ -/ privacy/ )/ ;/ Vaudenay/ [/ 24/ ]/ 考虑/ 了/ 边/ 信道/ 攻击/ ,/ 提出/ 了/ 8/ 种/ RFID/ 隐私/ 安全/ 模型/ ;/ Ng/ 等/ 人/ [/ 25/ ]/ 把/ 这/ 8/ 种/ ①/ ②/ Page3/ 安全/ 模型简化/ 到/ 了/ 4/ 种/ 安全/ 模型/ ;/ 而/ Ha/ 等/ 人/ [/ 26/ ]/ 提出/ 了/ 基于/ 不/ 可预测性/ (/ Unpredictability/ )/ 的/ RFID/ 隐私/ 安全/ 模型/ (/ 简称/ unp/ -/ privacy/ )/ ./ 在/ ACMCCS/ ’/ 09/ 上/ ,/ Ma/ 等/ 人/ [/ 5/ ]/ 研究/ 了/ ind/ -/ privacy/ 和/ unp/ -/ privacy/ 之间/ 的/ 关系/ ./ 最近/ ,/ 在/ ACNS/ ’/ 10/ 上/ ,/ Lai/ 等/ 人/ [/ 27/ ]/ 对/ unp/ -/ privacy/ 模型/ 进行/ 了/ 修正/ ,/ 并/ 提出/ 了/ 一个/ 具有/ unp/ -/ privacy/ 的/ 双向/ RFID/ 认证/ 协议/ ./ 在/ ESORICS/ ’/ 10/ 上/ ,/ Deng/ 等/ 人/ [/ 28/ ]/ 提出/ 了/ 基于/ 零/ 知识/ 的/ RFID/ 隐私/ 安全/ 模型/ zk/ -/ privacy/ ,/ 并/ 设计/ 了/ 一个/ 满足/ 该/ 模型/ 的/ 双向/ 认证/ 协议/ ./ 张帆/ 等/ 人/ 在/ 文献/ [/ 29/ ]/ 中/ 提出/ 了/ 通用/ 可/ 组合/ 的/ RFID/ 隐私/ 认证/ 模型/ 并/ 设计/ 了/ 相应/ 的/ 认证/ 方案/ ./ 3/ 预备/ 知识/ 假设/ S/ 表示/ 一个/ 集合/ ,/ s/ ∈/ RS/ 表示/ 从/ 集合/ S/ 中/ 随机/ 选取/ 一个/ 元素/ s/ ;/ {/ 0/ ,/ 1/ }/ l/ 表示/ 所有/ 比特/ 长度/ 为/ l/ 的/ 二进制/ 比特/ 串/ 的/ 集合/ ;/ 如果/ x1/ ,/ x2/ ,/ …/ 表示/ 比特/ 串/ ,/ 那么/ x1/ ‖/ x2/ ‖/ …/ 表示/ 这些/ 串/ 按/ 比特/ 的/ 链接/ ;/ |/ x1/ |/ 表示/ 比特/ 串/ x1/ 的/ 比特/ 长度/ ;/ 符号/ y/ ←/ AO1/ ,/ …/ ,/ On/ (/ x1/ ,/ …/ ,/ xn/ )/ 表示/ 算法/ A/ 的/ 输入/ 是/ x1/ ,/ …/ ,/ xn/ ,/ 并且/ 算法/ A/ 可以/ 查询语言/ 机/ O1/ ,/ …/ ,/ On/ ,/ 其/ 输出/ 赋值/ 给/ y/ ;/ Pr/ [/ E/ ]/ 表示/ 事件/ E/ 发生/ 的/ 概率/ ;/ 假设/ F/ :/ D/ →/ D/ 是/ 一个/ 函数/ ,/ 那么/ Fn/ (/ x/ )/ 表示/ 对/ 函数/ F/ 的/ 复合/ ,/ 也就是说/ 定义/ 1/ ./ 称/ 函数/ ε/ :/ {/ 0/ ,/ 1/ }/ n/ →/ R/ 是/ 可以/ 忽略不计/ 的/ ,/ 如果/ 它/ 满足/ :/ 对/ 任意/ 一个/ 多项式/ p/ (/ n/ )/ ,/ 当/ n/ 充分/ 大时/ 有/ ε/ (/ n/ )/ </ 1/ // p/ (/ n/ )/ ./ 3.1/ RFID/ 系统/ 不失/ 一般性/ ,/ 假设/ RFID/ 系统/ 中共/ 有/ n/ 个/ 标签/ ,/ 它们/ 是/ T/ =/ {/ T1/ ,/ …/ ,/ Tn/ }/ ,/ 只有/ 一个/ 阅读器/ R/ 和/ 一个/ 后/ 端/ 数据库系统/ DB/ ./ 每/ 一个/ 标签/ 由/ 一个/ 唯一/ 的/ ID/ 所/ 标识/ ,/ 阅读器/ 有/ 一个/ 或者/ 多个/ 射频/ 收发器/ ,/ 后/ 端/ 数据库系统/ DB/ 维护/ 认证/ 标签/ 所/ 需要/ 的/ 所有/ 数据/ ,/ 比如/ 标签/ 的/ 密钥/ 、/ ID/ 、/ 状态/ 信息/ 等/ ./ 这里/ 假设/ 阅读器/ 和/ 后/ 端/ 数据库/ 之间/ 的/ 通信/ 是/ 安全/ 的/ ,/ 并且/ 后/ 端/ 数据库/ 属于/ 安全/ 数据库/ ./ 由于/ 现有/ 大部分/ RFID/ 协议/ 只有/ 两轮/ 或者/ 三轮/ 通信/ ,/ 因此/ 本文/ 仅/ 考虑/ 不/ 超过/ 三轮/ 通信/ 的/ RFID/ 协议/ ,/ 如图/ 1/ 所示/ ./ 每/ 一个/ 标签/ 中/ 存储状态/ 信息/ sT/ (/ 包含/ 标签/ 的/ 密钥/ )/ ,/ 并/ 赋有/ 一个/ 计算/ 函数/ FT/ :/ {/ 0/ ,/ 1/ }/ lS/ ×/ {/ 0/ ,/ 1/ }/ l1/ ×/ {/ 0/ ,/ 1/ }/ lC/ →/ {/ 0/ ,/ 1/ }/ lS/ ×/ {/ 0/ ,/ 1/ }/ l2/ ,/ 这里/ lS/ 和/ lC/ 分别/ 表示/ 状态/ 信息/ 和/ 标签/ 内部/ 抛币/ 消息/ 的/ 比特/ 长度/ ;/ l1/ 和/ l2/ 分别/ 表示/ 协议/ 第/ 1/ 轮/ 和/ 第/ 2/ 轮/ 消息/ 的/ 比特/ 长度/ ./ 当/ 标签/ 收到/ 协议/ 的/ 挑战/ 消息/ m1/ ∈/ {/ 0/ ,/ 1/ }/ l1/ 之后/ ,/ 它/ 利用/ 函数/ FT/ (/ 以/ m1/ 和/ sT/ 为/ 输入/ 参数/ )/ 计算/ 出/ 一个/ 应答/ 消息/ m2/ ∈/ {/ 0/ ,/ 1/ }/ l2/ 和/ 一个/ 状态/ 更新/ 消息/ sT/ (/ 可能/ 为/ 空串/ ,/ 意味着/ 状态/ 不/ 更新/ )/ ,/ 也/ 就是/ (/ m2/ ,/ sT/ )/ ←/ FT/ (/ sT/ ,/ m1/ ,/ cnT/ )/ ,/ 这里/ cnT/ 是/ 标签/ 的/ 内部/ 抛币/ (/ 它/ 可能/ 为/ 空串/ )/ ./ 此外/ ,/ 一个/ RFID/ 系统/ RS/ =/ {/ T/ ,/ R/ ,/ DB/ }/ 还/ 包含/ 以下/ 算法/ 和/ 协议/ ./ Initialize/ (/ κ/ )/ :/ 它/ 为/ 系统/ 中/ 每/ 一个/ 标签/ Ti/ 产生/ 密钥/ ki/ 并/ 设置/ 其/ 初始状态/ (/ 这里/ κ/ 是/ 一个/ 安全/ 参数/ )/ ,/ 同时/ ,/ 它/ 把/ 该/ 标签/ 的/ ID/ 和/ 相应/ 的/ 认证/ 数据/ 保存/ 在/ 后/ 端/ 数据库/ DB/ 中/ ;/ ReaderStart/ (/ )/ :/ 调用/ 阅读器/ 产生/ 一个/ 会话/ 标识/ sid/ 和/ 该会/ 话/ 的/ 第/ 1/ 轮/ 协议/ 消息/ m1/ ;/ TagCompute/ (/ sid/ ,/ m1/ ,/ Ti/ )/ :/ 以/ 消息/ m1/ 作为/ 输入/ 调用/ 标签/ Ti/ 产生/ 协议/ 第/ 2/ 轮/ 消息/ m2/ ;/ ReaderCompute/ (/ sid/ ,/ m2/ )/ :/ 调用/ 阅读器/ ,/ 其/ 输入/ 是/ 消息/ m2/ 和/ 会/ 话/ 标识/ sid/ ,/ 阅读器/ 根据/ sid/ 找到/ 其/ 对应/ 的/ 第/ 1/ 轮/ 协议/ 消息/ m1/ ,/ 然后/ 计算/ 出/ 协议/ 第/ 3/ 轮/ 消息/ m3/ ,/ 最后/ 输出/ m3/ ;/ π/ (/ R/ ,/ Ti/ )/ :/ 调用/ R/ 和/ Ti/ 执行/ 一次/ 完整/ 的/ 认证/ 协议/ (/ 如图/ 1/ 所示/ )/ ,/ 返回/ 协议/ 消息/ (/ m1/ ,/ m2/ ,/ m3/ )/ ./ 3.2/ RFID/ 安全/ 定义/ 由于/ 低成本/ 的/ RFID/ 标签/ 不/ 具有/ 任何/ 防/ 篡改/ 的/ 能力/ ,/ 因此/ 攻击者/ 可以/ 很/ 容易/ 地/ 通过/ 破解/ 标签/ 来/ 获得/ 标签/ 的/ 内部/ 状态/ ,/ 并/ 利用/ 获得/ 的/ 内部/ 状态/ 信息/ 来/ 攻击/ 标签/ 在/ 被/ 破解/ 之前/ 的/ 通信/ 隐私/ 性/ (/ 比如/ :/ 跟踪/ 标签/ 、/ 获取/ 标签/ 身份/ 信息/ 等/ )/ ./ 前向/ 隐私/ 正是/ 为了/ 保证/ RFID/ 系统/ 在/ 上述情况/ 下/ 的/ 隐私/ 安全性/ ./ 简单/ 地说/ ,/ 在/ 一个/ RFID/ 系统/ 中/ ,/ 攻击者/ 可以/ 窃听/ 、/ 篡改/ 、/ 伪造/ 、/ 阻断/ 协议/ 消息/ ,/ 它/ 甚至/ 可以/ 破解/ 任何/ 一个/ 标签/ 从而/ 获得/ 该/ 标签/ 当前/ 的/ 内部/ 状态/ 信息/ (/ 这些/ 攻击能力/ 在/ 以下/ 的/ 隐私/ 游戏/ 中/ 用/ 预言/ 机来/ 模拟/ )/ ,/ 但是/ 攻击者/ 仍然/ 不能/ 跟踪/ (/ 或者/ 识别/ )/ 标签/ 在/ 没有/ 被/ 破解/ 之前/ 的/ 通信/ (/ 或者/ 身份/ )/ ,/ 这/ 就是/ 前向/ 隐私/ ,/ 它/ 指/ 的/ 是/ 即使/ 攻击者/ 破解/ 了/ 某/ 一个/ 标签/ ,/ 但是/ 该/ 标签/ 在/ 被/ 破解/ 之前/ 的/ 所有/ 通信/ 隐私/ 安全性/ 仍能/ 得到/ 保证/ ./ 准确/ 地说/ ,/ 前向/ 隐私/ 由/ 下面/ 的/ 隐私/ 游戏/ GameFPA/ (/ 见图/ 2/ )/ 来/ 定义/ ,/ 这/ Page4/ 里/ FP/ (/ ForwardPrivacy/ )/ 表示/ 前向/ 隐私/ ,/ A/ 表示/ 攻击者/ ,/ 符号/ GameFPA/ 表示/ 有/ 攻击者/ A/ 参与/ 的/ 前/ 向/ 隐私/ 游戏/ ./ 本文/ 定义/ 结合/ 了/ 文献/ [/ 5/ -/ 6/ ]/ 中/ 定义/ 隐私/ 安全/ 的/ 方法/ ./ 定义/ 前向/ 隐私/ 的/ 方法/ 如下/ :/ 首先/ 利用/ 隐私/ 游戏/ GameFPA/ 模拟/ 现实/ 的/ RFID/ 攻击/ 环境/ ;/ 然后/ 利用/ 对/ 两个/ 标签/ 行为/ 的/ 不可/ 区分/ 性/ 定义/ 隐私/ 安全/ ./ 隐私/ 游戏/ GameFPA/ 包含/ 一个/ 攻击者/ 和/ 一个/ RFID/ 系统/ ./ GameFPA/ (/ κ/ ,/ n/ ,/ q/ )/ 1/ ./ 建立/ 一个/ 阅读器/ R/ 和/ n/ 个/ 标签/ T/ =/ (/ T1/ ,/ …/ ,/ Tn/ )/ ;/ 2/ ./ (/ T0/ ,/ T1/ ,/ st/ )/ ←/ AO1/ ,/ O2/ ,/ O3/ ,/ O43/ ./ β/ ∈/ R/ {/ 0/ ,/ 1/ }/ ,/ T/ =/ T/ -/ {/ T0/ ,/ T1/ }/ 4/ ./ β/ ←/ AO1/ ,/ O2/ ,/ O3/ ,/ O4/ 攻击者/ ./ 这里/ 假设/ 任何/ 一个/ 攻击者/ 都/ 是/ 一个/ 概率/ 多项式/ 时间/ (/ PPT/ )/ 算法/ ,/ 它/ 可以/ 完全/ 控制/ 阅读器/ 和/ 标签/ 之间/ 的/ 通信/ ./ 此外/ ,/ 攻击者/ A/ 还/ 可以/ 和/ 协议/ 参与方/ 之间/ 进行/ 交互/ ,/ 这些/ 交互/ 用/ 以下/ 预言/ 机来/ 刻画/ ./ Launch/ (/ R/ )/ :/ 触发/ 阅读器/ 产生/ 一个/ 新/ 的/ 协议/ 会话/ ,/ 输出/ 会话/ 标识/ sid/ 和/ 协议/ 的/ 第/ 1/ 轮/ 消息/ m1/ ,/ 它/ 模拟/ 搭线/ 窃听/ 获取/ 协议/ 第/ 1/ 轮/ 消息/ ;/ SendTag/ (/ sid/ ,/ m1/ ,/ Ti/ )/ :/ 模拟/ 篡改/ 协议/ 消息/ 、/ 搭线/ 窃听/ 和/ 标签/ 的/ 计算/ TagCompute/ (/ sid/ ,/ m1/ ,/ Ti/ )/ ,/ 输出/ 协议/ 的/ 第/ 2/ 轮/ 消息/ m2/ ;/ SendReader/ (/ sid/ ,/ m2/ )/ :/ 模拟/ 篡改/ 协议/ 消息/ 、/ 搭线/ 窃听/ 和/ 阅读器/ 的/ 计算/ ReaderCompute/ (/ sid/ ,/ m2/ )/ ,/ 输出/ 协议/ 的/ 第/ 3/ 轮/ 消息/ m3/ ;/ Reveal/ (/ Ti/ )/ :/ 模拟/ 对/ 标签/ 的/ 破解/ 攻击/ ,/ 输出/ 标签/ Ti/ 的/ 内部/ 状态/ 包括/ 其/ 密钥/ 和/ 状态/ 信息/ ./ 假设/ O1/ ,/ O2/ ,/ O3/ ,/ O4/ 分别/ 表示/ 以上/ 4/ 个/ 预言/ 机/ ,/ 本文/ 假设/ 攻击者/ 对/ 这/ 4/ 个/ 预言/ 机/ 的/ 查询/ 次数/ 总共/ 不/ 超过/ q/ 次/ ./ 前向/ 隐私/ ./ 简单/ 地/ 讲/ ,/ 在/ RFID/ 系统/ 中/ 尽管/ 攻击者/ 可以/ 对/ RFID/ 协议/ 进行/ 窃听/ 、/ 篡改/ 、/ 阻断/ ,/ 甚至/ 可以/ 破解/ 标签/ 获得/ 其/ 内部/ 状态/ ,/ 但/ 攻击者/ 仍/ 不能/ 对/ 两个/ 标签/ 的/ 行为/ 加以/ 区分/ ,/ 这/ 就是/ 前向/ 隐私/ ./ 实际上/ ,/ RFID/ 前向/ 隐私/ 由/ 隐私/ 游戏/ GameFPA/ (/ 见图/ 2/ )/ 所/ 定义/ ,/ 在/ 该游戏/ 中/ ,/ 攻击者/ A/ 由/ 算法/ A1/ 和/ A2/ 组成/ ,/ A/ 对/ RFID/ 系统/ 的/ 隐私/ 攻击/ 分两/ 阶段/ 实施/ ./ 在/ 第/ 1/ 阶段/ (/ 也/ 就是/ 学习/ 阶段/ )/ ,/ 攻击者/ A1/ 初始化/ 一个/ RFID/ 系统/ RS/ ,/ 并/ 可以/ 随意/ 调用/ 预言/ 机/ O1/ ,/ O2/ ,/ O3/ ,/ O4/ ./ 在/ 这/ 一/ 阶段/ 末/ ,/ A1/ 输出/ 两个/ 没有/ 被/ 调用/ 过/ Reveal/ 预言/ 机/ 的/ 标签/ T0/ 、/ T1/ 和/ 状态/ 信息/ st/ ,/ 并/ 把/ T0/ 和/ T1/ 递交/ 给/ 游戏/ GameFPA/ 作为/ 自己/ 的/ 候选/ 挑战/ 标签/ ./ 在/ 第/ 2/ 阶段/ (/ 也/ 就是/ 挑战/ 阶段/ )/ ,/ 游戏/ 首先/ 选择/ 一个/ 随机/ 比特/ β/ ,/ 把/ T/ β/ 交个/ 攻击者/ 作为/ 挑战/ 标签/ ,/ 接下来/ 攻击者/ 实施/ 第/ 2/ 阶段/ 的/ 攻击/ ./ 在/ 这/ 一/ 阶段/ ,/ A2/ 仍然/ 可以/ 对/ T/ β/ 随意/ 调用/ 预言/ 机/ O1/ ,/ O2/ ,/ O3/ ,/ O4/ 进行/ 查询/ ./ 最后/ ,/ 要求/ 攻击者/ A2/ 猜测/ 游戏/ 选择/ 的/ 随机数/ β/ ,/ 假设/ A2/ 的/ 输出/ 是/ β/ ./ 如果/ β/ =/ β/ ,/ 则/ 称/ 攻击者/ A/ 攻击/ RFID/ 系统/ 的/ 前/ 向/ 隐私/ 性/ 成功/ ./ 定义/ 2/ ./ 在/ 以上/ 的/ 前/ 向/ 隐私/ 游戏/ 中/ ,/ 攻击者/ A/ 的/ 优势/ 定义/ 为/ 定义/ 3/ (/ 前向/ 隐私/ 性/ )/ ./ 前向/ 隐私/ 性是/ 指/ 在/ 游戏/ GameFPA/ 中/ ,/ 不/ 存在/ 一个/ 多项式/ 时间/ 攻击者/ A/ ,/ 其/ 优势/ 至少/ 是/ ε/ (/ 不可/ 忽略不计/ )/ ,/ 且/ 攻击/ 时间/ 不/ 超过/ t/ (/ 多项式/ 时间/ )/ ./ 或者/ 称该/ RFID/ 系统/ 是/ (/ ε/ ,/ t/ ,/ q/ )/ -/ 前向/ 隐私/ 安全/ 的/ ./ 认证/ 性/ 游戏/ [/ 5/ ]/ ./ A/ 是/ 一个/ 概率/ 多项式/ 时间/ 攻击者/ ,/ 它/ 可以/ 对/ RFID/ 系统/ 进行/ 预言/ 机/ O1/ ,/ O2/ ,/ O3/ ,/ O4/ 的/ 查询/ ,/ 最后/ A/ 输出/ 协议/ 消息/ (/ m1/ ,/ m2/ ,/ m3/ )/ 和/ 标签/ Tc/ ./ 如果/ 标签/ Tc/ 没有/ 被/ 查询/ 过/ Reveal/ 预言/ 机/ ,/ 且/ (/ m1/ ,/ m2/ ,/ m3/ )/ 不是/ 标签/ Tc/ 和/ 阅读器/ R/ 之间/ 的/ 协议/ 输出/ ,/ 即/ 不/ 存在/ 会话/ 标识/ sid/ 满足/ (/ m1/ ,/ m2/ ,/ m3/ )/ ←/ π/ (/ R/ ,/ Tc/ ,/ sid/ )/ ,/ 则/ 称/ A/ 成功/ ./ 定义/ 4/ (/ 认证/ 性/ )/ ./ 认证/ 性是/ 指/ 对/ 任何/ 一个/ 多项式/ 时间/ 攻击者/ A/ ,/ 其/ 在/ 以上/ 描述/ 的/ 认证/ 性/ 游戏/ 中/ 成功/ 的/ 概率/ 是/ 可以/ 忽略不计/ 的/ ./ 或者/ 称该/ RFID/ 协议/ 具有/ 认证/ 性/ ./ 4/ 前向/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ 本/ 节/ 首先/ 利用/ 具有/ 少量/ 存储空间/ 、/ 能够/ 计算/ 伪/ 随机数/ 发生器/ 和/ 比/ 特异/ 或/ 的/ 标签/ 来/ 构造/ 一个/ 具有/ 前向/ 隐私/ 的/ RFID/ 认证/ 协议/ SFP/ ./ 然后/ 扩充/ SFP/ 协议/ 为/ 双向/ 认证/ 协议/ MSFP/ ,/ 最后/ 证明/ 协议/ SFP/ 具有/ 前向/ 隐私/ 性/ 和/ 认证/ 性/ 并/ 说明/ 其/ 标签/ 生产/ 成本低/ ./ 定义/ 5/ [/ 30/ ]/ ./ 称/ 函数/ g/ :/ {/ 0/ ,/ 1/ }/ n/ →/ {/ 0/ ,/ 1/ }/ l/ 是/ 一个/ (/ 1/ )/ l/ >/ n/ ,/ 并且/ 对/ 每/ 一个/ x/ ∈/ {/ 0/ ,/ 1/ }/ n/ ,/ 存在/ 多项式/ 时间/ 算法/ 计算/ g/ (/ x/ )/ ;/ (/ 2/ )/ 对/ 任意/ 一个/ 多项式/ 时间/ 算法/ A/ 和/ 测试/ 值/ y/ ,/ 概率/ |/ Pr/ [/ A/ (/ y/ )/ =/ 1/ |/ y/ =/ g/ (/ s/ )/ ]/ -/ Pr/ [/ A/ (/ y/ )/ =/ 1/ |/ y/ =/ r/ ]/ |/ 是/ 可以/ 忽略不计/ 的/ ,/ 这里/ s/ ∈/ R/ {/ 0/ ,/ 1/ }/ n/ 且/ r/ ∈/ R/ {/ 0/ ,/ 1/ }/ l/ ./ 伪/ 随机数/ 发生器/ ,/ 如果/ 它/ 满足/ 以下/ 条件/ :/ Page54/ ./ 1RFID/ 认证/ 协议/ SFP/ 系统/ 初始化/ ./ 根据/ 安全/ 参数/ κ/ ,/ 首先/ 选择/ 一个/ 伪/ 随机数/ 发生器/ g/ :/ {/ 0/ ,/ 1/ }/ κ/ →/ {/ 0/ ,/ 1/ }/ 2/ κ/ 和/ 一个/ 阈值/ w/ ,/ 假设/ g/ =/ (/ g1/ ,/ g2/ )/ ,/ 这里/ g1/ (/ s/ )/ 和/ g2/ (/ s/ )/ 分别/ 表示/ g/ (/ s/ )/ 的/ 左半/ 部分/ 和/ 右半/ 部分/ ,/ 即/ g/ (/ s/ )/ =/ g1/ (/ s/ )/ ‖/ g2/ (/ s/ )/ 且/ |/ g1/ (/ s/ )/ |/ =/ |/ g2/ (/ s/ )/ |/ =/ κ/ ,/ 设置/ 每/ 一个/ 标签/ 使/ 之/ 具有/ 计算/ 伪/ 随机数/ 发生器/ g/ 的/ 能力/ ,/ 然后/ 为/ 每/ 一个/ 标签/ Ti/ 选择/ 其伪/ 随机数/ 发生器/ 的/ 初始/ 种子/ si/ 和/ 一个/ 身份/ IDi/ ,/ 最后/ 把/ si/ 存储/ 在/ 标签/ Ti/ 中/ 做/ 为/ 它/ 的/ 状态/ 信息/ st/ ,/ 同时/ 把/ (/ si/ ,/ IDi/ )/ 存储/ 在/ 后/ 端/ 数据库/ 中/ 以便/ 在/ 未来/ 的/ 通信/ 中/ 对/ 标签/ Ti/ 做出/ 认证/ ./ 阅读器/ 和/ 标签/ 间/ 的/ 认证/ 协议/ π/ (/ 犚/ ,/ 犜/ 犻/ )/ (/ 如图/ 3/ 所示/ ,/ 标签/ Ti/ 的/ 内部/ 状态/ 处于/ 已经/ 被/ 认证/ 了/ u/ 次/ 之后/ 的/ 状态/ ,/ 接下来/ 进行/ 第/ u/ +/ 1/ 次/ 认证/ )/ (/ 1/ )/ ReaderStart/ (/ )/ :/ 阅读器/ 随机/ 选择/ 一个/ 挑战/ 消息/ c/ ∈/ {/ 0/ ,/ 1/ }/ l1/ ,/ 然后/ 把/ c/ 发送给/ 标签/ Ti/ ;/ (/ 2/ )/ TagCompute/ (/ sid/ ,/ c/ ,/ Ti/ )/ :/ 假设/ 标签/ Ti/ 的/ 当前/ 内部/ 状态/ 信息/ st/ =/ gu2/ (/ s/ )/ ,/ 即伪/ 随机数/ 发生器/ 的/ 当前/ 种子/ 为/ st/ ./ 标签/ Ti/ 收到/ 挑战/ 消息/ c/ 后/ ,/ 按/ 如下/ 计算/ 产生/ 应答/ 消息/ 并/ 更新/ 其/ 内部/ 状态/ 信息/ :/ 首先/ 计算/ g/ (/ st/ )/ =/ g1/ (/ st/ )/ ‖/ g2/ (/ st/ )/ =/ g1/ (/ gu2/ (/ s/ )/ )/ ‖/ g2/ (/ gu2/ (/ s/ )/ )/ ,/ 令/ k/ =/ g1/ (/ gu2/ (/ si/ )/ )/ ,/ 然后/ 计算/ r/ =/ g1/ (/ c/ / k/ )/ ,/ 并/ 更新/ 状态/ 信息/ st/ =/ g2/ (/ gu2/ (/ si/ )/ )/ ;/ 最后/ 发送/ r/ 给/ 阅读器/ R/ ./ (/ 3/ )/ ReaderCompute/ (/ sid/ ,/ r/ )/ :/ 阅读器/ 收到/ 应答/ 消息/ r/ 之后/ ,/ 对/ 每/ 一个/ (/ si/ ,/ IDi/ )/ 计算/ r/ =/ g1/ (/ c/ / g1/ (/ si/ )/ )/ ,/ 如果/ r/ =/ r/ 则/ 对/ 标签/ Ti/ 做出/ 认证/ 并/ 更新/ si/ =/ g2/ (/ si/ )/ ./ 否则/ ,/ 从/ j/ =/ 2/ 到/ w/ ,/ 依次/ 对/ 每/ 一个/ (/ si/ ,/ IDi/ )/ 计算/ r/ =/ g1/ (/ c/ / gj1/ (/ si/ )/ )/ ,/ 如果/ r/ =/ r/ 则/ 对/ 标签/ Ti/ 做出/ 认证/ 并/ 更新/ si/ =/ gj2/ (/ si/ )/ ./ 最后/ ,/ 如果/ j/ >/ w/ ,/ 则/ 认证/ 失败/ ①/ ./ 效率/ 的/ 改进/ ./ 为了/ 方便/ 安全/ 分析/ ,/ 上面/ 仅/ 给出/ 了/ 基于/ 伪/ 随机数/ 发生器/ 构造/ 的/ RFID/ 认证/ 协议/ SFP/ 的/ 基本/ 框架/ ./ 为了/ 进一步提高/ 协议/ 认证/ 的/ 效率/ ,/ SFP/ 协议/ 可以/ 按/ 如下/ 方式/ 进行/ 扩充/ :/ 选取/ 伪/ 随机/ 函数/ g/ =/ (/ g1/ ,/ g2/ ,/ g3/ )/ :/ {/ 0/ ,/ 1/ }/ κ/ →/ {/ 0/ ,/ 1/ }/ 3/ κ/ ,/ 然后/ 用/ g1/ 来/ 生成/ 对/ 挑战/ 消息/ 的/ 应答/ 消息/ r/ ,/ 用/ g2/ 来/ 更新/ 标签/ 内部/ 状态/ 信息/ ,/ 用/ g3/ 来/ 生成/ 一个/ 索引/ 信息/ I/ =/ g3/ (/ st/ )/ ,/ 后/ 端/ 数据库/ 中/ 存储/ 信息/ (/ I/ ,/ si/ ,/ IDi/ )/ ./ 认证/ 时/ ,/ 标签/ 返回/ (/ I/ ,/ r/ )/ 给/ 阅读器/ ,/ 后/ 端/ 数据库/ 利用/ I/ 进行/ 检索/ 找到/ 相应/ 元组/ (/ I/ ,/ si/ ,/ IDi/ )/ ,/ 判断/ r/ =/ g1/ (/ c/ / g1/ (/ si/ )/ )/ ?/ 因此/ ,/ 仅/ 需/ 计算/ 一次/ 伪/ 随机数/ 发生器/ 就/ 可以/ 实现/ 对/ 标签/ 的/ 认证/ ./ 从而/ 使/ 协议/ 具有/ 良好/ 的/ 可扩展性/ ,/ 以便/ 适用/ 于/ 大规模/ 的/ RFID/ 应用/ 场合/ ./ 4.2/ 双向/ 认证/ 协议/ MSFPSFP/ 仅/ 提供/ 对/ 标签/ 进行/ 认证/ 的/ 功能/ ,/ 考虑/ 到/ 某些/ RFID/ 应用/ 场合/ 同时/ 需要/ 对/ 阅读器/ 进行/ 认证/ ,/ 因此/ 这里/ 把/ SFP/ 扩充/ 为/ 双向/ 认证/ 协议/ MSFP/ (/ MutualSFP/ )/ ./ 在/ MSFP/ 中/ ,/ 选取/ 伪/ 随机数/ 发生器/ g/ =/ (/ g1/ ,/ g2/ ,/ g3/ )/ :/ {/ 0/ ,/ 1/ }/ κ/ →/ {/ 0/ ,/ 1/ }/ 3/ κ/ ,/ MSFP/ 由/ 三轮/ 协议/ 消息/ 组成/ ,/ 其/ 第/ 1/ 轮/ 和/ 第/ 2/ 轮/ 协议/ 消息/ 与/ SFP/ 完全/ 一样/ ,/ 其/ 第/ 3/ 轮/ 协议/ 消息/ 的/ 产生/ 和/ 标签/ 对/ 阅读器/ 的/ 认证/ 按/ 如下/ 方式/ 进行/ :/ 在/ 第/ 2/ 轮/ 通信/ 中/ 如果/ 阅读器/ 端/ 对/ 标签/ 认证/ 成功/ ,/ 那么/ 它/ 计算/ 然后/ 更新/ si/ =/ g2/ (/ si/ )/ 并/ 发送/ f/ 给/ 标签/ ./ 那么/ 它/ 计算/ 在/ 第/ 2/ 轮/ 通信/ 中/ 如果/ 阅读器/ 对/ 标签/ 认证/ 失败/ ,/ 然后/ 发送/ f/ 给/ 标签/ ./ 最后/ ,/ 标签/ Ti/ 收到/ 消息/ f/ 后/ ,/ 验证/ 如果/ 上述/ 等式/ 成立/ ,/ 则/ 接受/ 阅读器/ ;/ 否则/ ,/ 拒绝/ 阅读器/ ./ 4.3/ 安全/ 证明/ 这里/ 仅/ 对/ RFID/ 协议/ SFP/ 的/ 安全性/ 进行/ 证明/ ,/ 协议/ MSFP/ 的/ 安全性/ 证明/ 以此类推/ ./ 协议/ SFP/ 的/ 安全性/ 由/ 以下/ 定理/ 1/ 和/ 2/ 所/ 保证/ ./ 定理/ 1/ (/ SFP/ 协议/ 的/ 认证/ 性/ )/ ./ 假设/ g/ 是/ 一个/ 伪/ 随机数/ 发生器/ 且/ 标签/ 能够/ 存储/ 并/ 更新/ g/ 的/ 种子/ ,/ 那么/ 协议/ SFP/ 具有/ 认证/ 性/ ./ 证明/ ./ 见/ 附录/ A/ ./ 定理/ 2/ (/ SFP/ 协议/ 的/ 前/ 向/ 隐私/ 安全/ )/ ./ 假设/ g/ 是/ 一个/ 伪/ 随机数/ 发生器/ 且/ 标签/ 能够/ 存储/ 并/ 更新/ g/ 的/ 种子/ ,/ 那么/ 协议/ SFP/ 具有/ 前向/ 隐私/ 安全性/ ./ ①/ 保证/ 标签/ 能够/ 被/ 正确/ 识别/ ,/ 协议/ SFP/ 假设/ 标签/ 和/ 阅读器/ 之间/ Page6/ 证明/ ./ 见/ 附录/ A/ ./ 4.4/ SFP/ 协议/ 标签/ 成本低/ 特性/ 因为/ 标签/ 的/ 主要/ 生产成本/ 取决于/ 其/ 计算能力/ 的/ 高低/ ,/ 因此/ 要/ 说明/ SFP/ 协议/ 的/ 标签/ 生产/ 成本低/ ,/ 只/ 需要/ 说明/ 在/ 保证/ RFID/ 前向/ 隐私/ 安全/ 的/ 条件/ 下/ 标签/ 的/ 计算能力/ 需求/ 低/ 即可/ ./ 为此/ ,/ 本节/ 特/ 证明/ 标签/ 具有/ 计算/ 伪/ 随机数/ 发生器/ 的/ 能力/ 是/ 保证/ RFID/ 认证/ 协议/ 前向/ 隐私/ 的/ 必要条件/ ./ 这里/ 假设/ 标签/ 只有/ 非常/ 有限/ 的/ 存储空间/ ./ 定理/ 3/ (/ 前向/ 隐私/ 的/ 必要条件/ )/ ./ 假设/ RFID/ 认证/ 协议/ π/ 具有/ 认证/ 性和前/ 向/ 隐私/ 性/ ,/ 那么/ RFID/ 系统/ 中/ 每/ 一个/ 标签/ 的/ 计算能力/ 可以/ 用来/ 计算/ 一个/ 伪/ 随机数/ 发生器/ ./ 证明/ ./ 见/ 附录/ B/ ./ 必要条件/ 的/ 含意/ 如下/ :/ (/ 1/ )/ 能够/ 产生/ 伪/ 随机数/ 是/ RFID/ 协议/ 前向/ 隐私/ 安全/ 对/ 标签/ 计算能力/ 的/ 最低/ 要求/ ,/ 而/ 协议/ SFP/ 仅/ 要求/ 标签/ 产生/ 伪/ 随机数/ ./ 协议/ SFP/ 采用/ 保证/ RFID/ 前向/ 隐私/ 的/ 最低/ 标签/ 计算能力/ 设计/ ,/ 生产/ 成本低/ ./ (/ 2/ )/ 必要条件/ 只是/ 表明/ 标签/ 的/ 计算能力/ 等价/ 于/ 计算/ 伪/ 随机数/ 发生器/ 的/ 能力/ ,/ 这/ 并/ 不/ 意味着/ 标签/ 内部/ 一定/ 实现/ 了/ 伪/ 随机数/ 发生器/ ./ 实际上/ ,/ 标签/ 内部/ 可以/ 采用/ 比伪/ 随机数/ 发生器/ 计算能力/ 更/ 高/ 的/ 函数/ (/ 比如/ :/ 对称/ 加密/ 函数/ 等/ )/ 来/ 计算/ RFID/ 协议/ 消息/ ,/ 但是/ 这/ 意味着/ 增加/ 了/ 标签/ 的/ 生产成本/ ./ (/ 3/ )/ 定理/ 3/ 一方面/ 解释/ 了/ 为什么/ 现有/ RFID/ 系统/ 中/ 采用/ 简单/ 操作/ (/ 比/ 特异/ 或/ 等/ ,/ 这些/ 操作/ 的/ 计算能力/ 都/ 低于/ 伪/ 随机数/ 发生器/ 的/ 计算能力/ )/ 设计/ 的/ 协议/ 不/ 具有/ 隐私/ 安全性/ ;/ 另一方面/ 为/ 设计/ 具有/ 前向/ 隐私/ 性/ 的/ RFID/ 认证/ 协议/ 提供/ 了/ 参考/ 依据/ ,/ 可以/ 避免/ 通过/ 盲目/ 地/ 降低/ 标签/ 计算能力/ 来/ 设计/ 具有/ 隐私/ 安全/ 的/ 轻量级/ RFID/ 认证/ 协议/ ./ 作为/ 本文/ 研究/ 的/ 派生/ ,/ 结合/ 定理/ 2/ 和/ 3/ ,/ 可以/ 得出/ 如下/ 关于/ RFID/ 前向/ 隐私/ 和/ 标签/ 计算能力/ 之间/ 的/ 关系/ ./ 定理/ 4/ (/ 前向/ 隐私/ 的/ 充要条件/ )/ ./ 如果/ RFID/ 认证/ 协议/ π/ 具有/ 认证/ 性且/ 标签/ 具有/ 存储/ 并/ 更新/ 伪/ 随机数/ 发生器/ 种子/ 的/ 能力/ ,/ 那么/ π/ 具有/ 前向/ 隐私/ 性/ 的/ 充分/ 必要条件/ 是/ :/ 标签/ 的/ 计算能力/ 能够/ 用来/ 计算/ 伪/ 随机数/ 发生器/ ./ 成立/ ./ 证明/ ./ 从/ 定理/ 2/ 和/ 定理/ 3/ 可以/ 直接/ 看出/ 定理/ 4/ 充要条件/ 的/ 含意/ 如下/ :/ (/ 1/ )/ 在/ 设计/ 具有/ 前向/ 隐私/ 安全/ 的/ RFID/ 协议/ 时/ ,/ 仅/ 需要/ 标签/ 能够/ 产生/ 伪/ 随机数/ 即可/ ,/ 而/ 不/ 需要/ 标签/ 具有/ 其它/ 计算/ 功能/ (/ 比如/ Hash/ 函数/ 、/ 对称/ 加密/ 、/ 公钥/ 加密/ 等/ )/ ./ 但/ 这/ 并/ 不/ 意味着/ 每/ 一个/ 能够/ 产生/ 伪/ 随机数/ 的/ 标签/ 都/ 具有/ 前向/ 隐私/ 性/ ./ 在/ 标签/ 能够/ 产生/ 伪/ 随机数/ 的/ 前提条件/ 下/ ,/ 仍/ 需/ 合理/ 地/ 设计/ 标签/ 和/ 阅读器/ 之间/ 的/ 认证/ 协议/ ,/ 才能/ 得到/ 具有/ 可/ 证明/ 前向/ 隐私/ 的/ RFID/ 认证/ 协议/ ./ (/ 2/ )/ 伪/ 随机数/ 是/ 安全/ 技术/ 的/ 基础/ ,/ 现有/ 的/ 密码/ 构件/ 中/ 大部分/ 含有/ 伪/ 随机数/ 发生器/ ./ 因此/ ,/ 定理/ 4/ 保证/ 了/ 人们/ 可以/ 从/ 现有/ 密码/ 技术/ 和/ 设备/ 出发/ 很/ 容易/ 地/ 获得/ 具有/ 前向/ 隐私/ 安全/ 的/ RFID/ 应用/ 系统/ ./ 5/ 效率/ 分析/ 和/ 比较/ 前面/ 设计/ 了/ 简单/ 的/ 认证/ 协议/ SFP/ 并/ 在/ 标准/ 模型/ 下/ 证明/ 了/ 其/ 安全性/ ,/ 这里/ 讨论/ 该/ 协议/ 参数/ 的/ 选取/ 和/ 效率/ 比较/ 分析/ ./ 5.1/ 协议/ SFP/ 的/ 参数/ 选择/ 主要/ 是/ 关于/ 伪/ 随机数/ 发生器/ 的/ 选择/ ,/ 最近/ 欧盟/ 的/ eStream/ 项目/ 为/ 我们/ 提供/ 了/ 多种/ 选择/ ./ 该/ 项目/ 中/ 的/ 流/ 密码/ 算法/ Grain/ 和/ Trivium/ 都/ 可以/ 做/ 为/ 协议/ SFP/ 中伪/ 随机数/ 发生器/ 的/ 候选/ 算法/ ./ 根据/ 文献/ [/ 31/ ]/ ,/ Grain/ 和/ Trivium/ 的/ 硬件/ 实现/ 分别/ 只/ 需要/ 3360/ 和/ 3090/ 个/ GE/ (/ GateEquivalents/ )/ ,/ 就/ 可以/ 达到/ 80bits/ 的/ 安全/ 水平/ ./ 实际上/ ,/ 它们/ 的/ 硬件/ 实现/ 中/ 都/ 包含/ 初始/ 向量/ 的/ 存储/ ,/ 而/ 协议/ SFP/ 中/ 的/ 伪/ 随机数/ 发生器/ 不/ 需要/ 初始/ 向量/ ,/ 因此/ ,/ 它们/ 在/ 协议/ SFP/ 中/ 的/ 实现/ 会/ 更/ 简单/ ,/ 可以/ 减少/ 到/ 1294/ 个/ GE/ [/ 6/ ]/ ./ Grain/ 和/ Trivium/ 的/ 密钥/ 长度/ 为/ 64/ ~/ 128bits/ ,/ 这/ 意味着/ 协议/ SFP/ 中/ 的/ 伪/ 随机数/ 发生器/ 的/ 种子/ 可以/ 选择/ 64/ ~/ 128bits/ ./ 5.2/ 效率/ 比较/ 在/ RFID/ 系统/ 中/ ,/ 标签/ 容易/ 成为/ 系统/ 的/ 效率/ 瓶颈/ ./ 因此/ ,/ 这里/ 主要/ 比较/ 标签/ 的/ 计算/ 和/ 通信/ 开销/ 以及/ 标签/ 完成/ 计算所/ 需/ 的/ 门电路/ 复杂性/ ./ SFP/ 协议/ 和/ 其它/ 协议/ (/ 学术界/ 具/ 代表性/ 的/ 4/ 个/ 协议/ :/ OSK/ [/ 14/ ]/ 、/ OTRAP/ [/ 19/ ]/ 、/ MLDL/ [/ 5/ ]/ 和/ PFP/ [/ 6/ ]/ )/ 的/ 比较/ 结果/ 见表/ 1/ ./ 表中/ 的/ 数据/ 由/ 下面/ 的/ 计算/ 得出/ ./ 协议/ 计算/ 时钟/ OSK/ [/ 14/ ]/ 254816240240/ 是/ OTRAP/ [/ 19/ ]/ 20643400160/ 是/ MLDL/ [/ 5/ ]/ 20643400240/ 否/ PFP/ [/ 6/ ]/ 2645578160/ 是/ SFP2081294160/ 是/ Page7/ 关于/ 标签/ 的/ 计算/ 开销/ ,/ 因为/ 它/ 主要/ 由/ 对称/ 密码/ 操作/ 的/ 计算/ 开销/ 所/ 决定/ ,/ 因此/ 我们/ 以/ 协议/ 中/ 对称/ 密码/ 操作/ 所/ 需要/ 的/ 时钟/ 周期/ (/ ClockCycle/ ,/ CC/ )/ 数目/ 来/ 衡量/ 协议/ 的/ 计算/ 复杂性/ ,/ 忽略/ 简单/ 操作/ (/ 比如/ :/ 比特/ 内积/ 、/ 比/ 特异/ 或/ 等/ )/ ./ 根据/ 文献/ [/ 31/ -/ 32/ ]/ 中/ 的/ 结果/ 可知/ :/ Hash/ 操作/ (/ SHA/ -/ 1/ )/ 的/ 时钟/ 周期/ 数目/ 为/ 1274/ [/ 32/ ]/ ,/ 伪/ 随机/ 函数/ (/ 用/ 对称/ 加密/ AES/ -/ 128/ 来/ 实现/ )/ 的/ 时钟/ 周期/ 数目/ 为/ 1032/ [/ 32/ ]/ ,/ 伪/ 随机数/ 发生器/ (/ 用流/ 密码/ Grain/ 来/ 实现/ )/ 的/ 时钟/ 周期/ 为/ 104/ [/ 31/ ]/ ./ 根据/ 文献/ [/ 6/ ]/ (/ 详见/ 文献/ [/ 6/ ]/ 的/ 6.2/ 节/ )/ ,/ 基于/ m/ ×/ l/ 阶/ Toeplitz/ 矩阵/ 实现/ 的/ UinversalHash/ 的/ 时钟/ 周期/ 数目/ 是/ m/ ./ 协议/ OSK/ 中/ 的/ 标签/ 需要/ 计算/ 两个/ Hash/ 函数/ ,/ 因此/ 它/ 的/ 计算/ 开销/ 是/ 1274/ ×/ 2/ =/ 2548/ 个/ 时钟/ 周期/ ;/ 协议/ OTRAP/ 和/ MLDL/ 中/ 的/ 标签/ 都/ 需要/ 计算/ 两个/ 伪/ 随机/ 函数/ ,/ 因此/ 它们/ 的/ 计算/ 开销/ 均/ 为/ 1032/ ×/ 2/ =/ 2064/ 个/ 时钟/ 周期/ ;/ 协议/ PFP/ 中/ 的/ 标签/ 需要/ 计算/ 一次/ 伪/ 随机数/ 发生器/ 和/ 一次/ UniversalHash/ 函数/ ,/ 因此/ 它/ 的/ 计算/ 开销/ 是/ m/ +/ 104/ ,/ 要/ 达到/ 80bits/ 的/ 安全/ ,/ m/ 至少/ 为/ 160/ ,/ 因此/ 协议/ SFP/ 的/ 计算/ 开销/ 是/ 264/ 个/ 时钟/ 周期/ ;/ 协议/ SFP/ 中/ 的/ 标签/ 需要/ 计算/ 两个/ 伪/ 随机数/ 发生器/ ,/ 因此/ 它/ 的/ 计算/ 开销/ 是/ 104/ ×/ 2/ =/ 208/ 个/ 时钟/ 周期/ ./ 关于/ 通信/ 开销/ ,/ 我们/ 考虑/ 整个/ 协议/ 通信/ 的/ 比特/ 数目/ ./ 如果/ 选取/ 安全/ 水平/ 为/ 80bits/ ,/ 那么/ 根据/ 密码学/ 常识/ 易知/ :/ 协议/ SFP/ 中/ 的/ 安全/ 参数/ κ/ / 80/ ;/ 各个/ 协议/ 中/ 的/ 挑战/ 消息/ 、/ 对称/ 加密/ 的/ 输出/ 、/ 伪/ 随机/ 函数/ 的/ 输出/ 以及/ 伪/ 随机数/ 发生器/ 的/ 种子/ 均/ 至少/ 为/ 80bits/ ;/ 而/ Hash/ 函数/ 的/ 输出/ 至少/ 为/ 160bits/ ./ 协议/ OSK/ 和/ PFP/ 的/ 消息/ 都/ 包括/ 一个/ 挑战/ 消息/ 和/ 一个/ Hash/ 函数/ 的/ 输出/ ,/ 因此/ 它们/ 通信/ 开销/ 均/ 为/ 80/ +/ 160/ =/ 240bits/ ;/ 协议/ OTRAP/ 的/ 消息/ 包含/ 一个/ 挑战/ 消息/ 和/ 一个/ 伪/ 随机/ 函数/ 的/ 输出/ ,/ 因此/ 其/ 通信/ 开销/ 是/ 80/ +/ 80/ =/ 160bits/ ;/ 协议/ MLDL/ 的/ 消息/ 包括/ 一个/ 挑战/ 消息/ 和/ 两个/ 伪/ 随机/ 函数/ 的/ 输出/ ,/ 所以/ 通信/ 开销/ 为/ 80/ +/ 160/ =/ 240bits/ ;/ 协议/ SFP/ 的/ 消息/ 包括/ 一个/ 挑战/ 消息/ 和/ 半个/ 伪/ 随机数/ 发生器/ 的/ 输出/ ,/ 因此/ 其/ 比特/ 长度/ 为/ |/ c/ |/ +/ κ/ =/ 160/ ./ 关于/ 标签/ 门电路/ 复杂性/ ,/ 这里/ 仅/ 考虑/ 密码/ 操作/ 所/ 需要/ 的/ 门电路/ (/ GE/ )/ 数目/ ,/ 而/ 忽略/ 简单/ 计算所/ 需/ 门电路/ 数目/ ./ 根据/ 文献/ [/ 32/ ]/ ,/ 计算/ Hash/ 函数/ (/ SHA/ -/ 1/ )/ 的/ 门电路/ 数目/ CH/ =/ 8120/ 个/ GE/ ;/ 计算/ 伪/ 随机/ 函数/ (/ 用/ 对称/ 加密/ AES/ -/ 128/ 来/ 实现/ )/ 的/ 门电路/ 数目/ 为/ CPRF/ =/ 3400/ 个/ GE/ ./ 根据/ 文献/ [/ 6/ ]/ (/ 详见/ 文献/ [/ 6/ ]/ 的/ 6.1/ 和/ 6.2/ 节/ )/ ,/ 计算/ 伪/ 随机数/ 发生器/ (/ 用流/ 密码/ Grainv1/ 来/ 实现/ )/ 的/ 门电路/ 数目/ 为/ CPRG/ =/ 1294/ 个/ GE/ ;/ 计算/ 基于/ m/ ×/ l/ 阶/ Toeplitz/ 矩阵/ 实现/ 的/ UniversalHash/ 的/ 门电路/ 数目/ 为个/ GE/ (/ 根据/ 80bits/ 安全/ 需求/ 选择/ m/ =/ 160/ ,/ l/ =/ 38/ )/ ./ OSK/ 协议/ 中/ 的/ 标签/ 需要/ 计算/ 两个/ 不同/ 的/ Hash/ 函数/ ,/ 因此/ 其/ 复杂度/ 为/ 2CH/ =/ 16240/ ;/ OTRAP/ 协议/ 和/ MLDL/ 协议/ 中/ 的/ 标签/ 需要/ 计算/ 伪/ 随机/ 函数/ ,/ 因此/ 它们/ 的/ 复杂度/ 均/ 为/ CPRF/ =/ 3400/ ;/ PFP/ 协议/ 中/ 的/ 标签/ 需要/ 计算/ 伪/ 随机数/ 发生器/ 和/ UniversalHash/ 函数/ ,/ 因此/ 其/ 复杂度/ 为/ CPNG/ +/ CUH/ =/ 5578/ ;/ 而/ SFP/ 协议/ 中/ 的/ 标签/ 仅/ 需要/ 计算/ 伪/ 随机数/ 发生器/ ,/ 因此/ 其/ 复杂度/ 为/ CPNG/ =/ 1294/ ./ 通过/ 表/ 1/ 可以/ 看出/ :/ 协议/ SFP/ 不但/ 在/ 计算/ 方面/ 比/ 协议/ OSK/ 、/ OTRAP/ 、/ MLDL/ 以及/ PFP/ 要/ 高效/ ,/ 而且/ 标签/ 的/ 门电路/ 复杂度/ 要远/ 小于/ 其它/ 4/ 个/ 协议/ ;/ 在/ 通信/ 开销/ 方面/ ,/ 协议/ SFP/ 和/ 协议/ OTRAP/ 以及/ PFP/ 保持一致/ ,/ 但是/ 它/ 比/ 协议/ OSK/ 和/ MLDL/ 要/ 高效/ ./ 总之/ ,/ 本文/ 协议/ SFP/ 在/ 保持/ 高效/ 的/ 同时/ ,/ 降低/ 了/ 对/ 标签/ 的/ 计算/ 要求/ ,/ 从而/ 简化/ 了/ 标签/ 的/ 电路/ 复杂性/ ,/ 降低/ 了/ 标签/ 的/ 生产成本/ ./ 6/ 结束语/ 安全/ 和/ 低成本/ 是/ 工业界/ 对/ RFID/ 技术/ 的/ 两个/ 基本/ 要求/ ,/ 但/ 又/ 是/ 两个/ 互相冲突/ 的/ 要求/ ./ 低成本/ 的/ RFID/ 不能/ 保证/ 安全性/ ,/ 满足/ 一定/ 安全/ 要求/ 的/ RFID/ 标签/ 成本/ 较/ 高/ ./ 能否/ 设计/ 出/ 既/ 具有/ 隐私/ 安全/ 又/ 具有/ 低/ 标签/ 成本/ 的/ RFID/ 认证/ 协议/ 呢/ ?/ 这是/ 人们/ 急需解决/ 的/ 问题/ ./ 本文/ 针对/ 这个/ 问题/ 研究/ 了/ 前/ 向/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ 的/ 设计/ 和/ 标签/ 计算/ 复杂度/ ./ 设计/ 了/ 一个/ 优化/ 的/ RFID/ 认证/ 协议/ SFP/ ./ 与/ 其它/ 协议/ 相/ 比较/ ,/ SFP/ 协议/ 不但/ 简单/ 、/ 高效/ 、/ 具有/ 标准/ 模型/ 下/ 的/ 可/ 证明/ 前向/ 隐私/ 安全/ ,/ 而且/ 对/ 标签/ 的/ 计算/ 要求/ 低/ ,/ 从而/ 协议/ SFP/ 中/ 的/ 标签/ 具有/ 较/ 低/ 的/ 生产成本/ ./ 同时/ ,/ 归纳/ 出/ 了/ 保证/ RFID/ 系统/ 前向/ 隐私/ 的/ 充分/ 必要条件/ ,/ 解决/ 了/ 前/ 向/ 隐私/ 和/ 标签/ 计算能力/ (/ 也/ 就是/ 生产成本/ )/ 之间/ 的/ 关系/ 问题/ ./ 本文/ 研究/ 丰富/ 了/ RFID/ 隐私/ 安全/ 理论/ ,/ 为/ 工业界/ 生产/ 具有/ 前向/ 隐私/ 安全/ 的/ RFID/ 系统/ 提供/ 了/ 指导/ ./ 本文/ 结论/ 表明/ :/ 保证/ RFID/ 前向/ 隐私/ 的/ 充分/ 必要条件/ 是/ 标签/ 具有/ 计算/ 伪/ 随机数/ 发生器/ 的/ 能力/ ./ 而/ EPCC1G2/ 标准/ 中/ 的/ 标签/ 具有/ 16bits/ 的/ 伪/ 随机数/ 发生器/ ,/ 如何/ 根据/ 这种/ 输出/ 短/ 的/ 伪/ 随机数/ 发生器/ 来/ 构造/ 满足/ 一定/ 安全/ 强度/ 的/ 前/ 向/ 隐私/ 的/ RFID/ 认证/ 协议/ ,/ 也就是说/ 如何/ 构造/ 兼容/ EPCC1G2/ 标准/ 的/ 前/ 向/ Page8/ 隐私/ 安全/ 的/ RFID/ 认证/ 协议/ 仍/ 是/ 一个/ 值得/ 进一步/ 研究/ 的/ 问题/ ./ 另/ 一个/ 值得/ 研究/ 的/ 问题/ 是/ :/ 保证/ RFID/ 协议/ 一般/ ind/ -/ 隐私/ 性/ 的/ 充分/ 必要条件/ 是/ 什么/ ?/ 我们/ 将/ 进一步/ 对/ 这/ 两个/ 问题/ 进行/ 研究/ ./ 致谢/ 本文/ 作者/ 衷心感谢/ 编辑部/ 和/ 审稿人/ 提出/ 的/ 宝贵意见/ ,/ 帮助/ 我们/ 改正/ 了/ 本文/ 的/ 不足之处/ ./ 

