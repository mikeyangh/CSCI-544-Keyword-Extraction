Page1/ 云/ 存储/ 中/ 的/ 数据完整性/ 证明/ 研究/ 及/ 进展/ 谭霜/ 贾焰/ 韩伟红/ (/ 国防科学技术大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 摘要/ 随着/ 云/ 存储/ 模式/ 的/ 出现/ ,/ 越来越/ 多/ 的/ 用户/ 选择/ 将/ 应用/ 和/ 数据/ 移植/ 到/ 云中/ ,/ 但/ 他们/ 在/ 本地/ 可能/ 并/ 没有/ 保存/ 任何/ 数据/ 副本/ ,/ 无法/ 确保/ 存储/ 在/ 云中/ 的/ 数据/ 是/ 完整/ 的/ ./ 如何/ 确保/ 云/ 存储/ 环境/ 下/ 用户/ 数据/ 的/ 完整性/ ,/ 成为/ 近来/ 学术界/ 研究/ 的/ 一个/ 热点/ ./ 数据完整性/ 证明/ (/ ProvableDataIntegrity/ ,/ PDI/ )/ 被/ 认为/ 是/ 解决/ 这一/ 问题/ 的/ 重要/ 手段/ ,/ 该文/ 对此/ 进行/ 了/ 综述/ ./ 首先/ ,/ 给出/ 了/ 数据完整性/ 证明/ 机制/ 的/ 协议/ 框架/ ,/ 分析/ 了/ 云/ 存储/ 环境/ 下/ 数据完整性/ 证明/ 所/ 具备/ 的/ 特征/ ;/ 其次/ ,/ 对/ 各种/ 数据完整性/ 证明/ 机制/ 加以/ 分类/ ,/ 在/ 此/ 分类/ 基础/ 上/ ,/ 介绍/ 了/ 各种/ 典型/ 的/ 数据完整性/ 验证/ 机制/ 并/ 进行/ 了/ 对比/ ;/ 最后/ ,/ 指出/ 了/ 云/ 存储/ 中/ 数据完整性/ 验证/ 面临/ 的/ 挑战/ 及/ 发展趋势/ ./ 关键词/ 云/ 存储/ ;/ 数据完整性/ 证明/ ;/ 数据/ 持有/ 性/ 证明/ ;/ 数据/ 可/ 恢复性/ 证明/ ;/ 大/ 数据/ ;/ 云/ 计算/ 1/ 引言/ 云/ 计算/ 是/ 继对/ 等/ 计算/ 、/ 网格/ 计算/ 、/ 效用/ 计算/ 、/ 分布式计算/ 后/ 又/ 一/ 新型/ 的/ 计算/ 模式/ ,/ 其一/ 出现/ 便/ 成为/ Page2/ 上/ ./ 另外/ ,/ 强大/ 的/ 计算/ 和/ 存储/ 能力/ 也/ 使得/ 用户/ 更/ 愿意/ 依托/ 云来/ 处理/ 各种/ 复杂/ 的/ 任务/ ./ 当/ 用户/ 选择/ 将/ 大量/ 应用/ 和/ 数据/ 部署/ 到/ 云/ 计算/ 平台/ 中/ 时/ ,/ 云/ 计算/ 系统/ 也/ 相应/ 地/ 变为/ 云/ 存储系统/ ./ 云/ 存储系统/ 可以/ 使/ 用户/ 以较/ 低廉/ 的/ 价格/ 获得/ 海量/ 的/ 存储/ 能力/ ,/ 但/ 高度集中/ 的/ 计算资源/ 使云/ 存储/ 面临/ 着/ 严竣/ 的/ 安全/ 挑战/ ./ 据/ Gartner2009/ 年/ 的/ 调查/ 结果显示/ ,/ 因/ 担心/ 云/ 数据/ 隐私/ 被/ 侵犯/ ,/ 70/ %/ 受访/ 企业/ 的/ CEO/ 拒绝/ 大规模/ 的/ 采用/ 云/ 计算/ 的/ 计算/ 模式/ ①/ ./ 而/ 在/ 最近/ 几年/ 里/ ,/ 各大云/ 运营商/ 各自/ 暴漏/ 的/ 安全/ 存储/ 问题/ ,/ 引起/ 了/ 人们/ 的/ 广大/ 关注/ 与/ 担忧/ ./ 如/ 2011/ 年/ 3/ 月/ ,/ 谷歌/ Gmail/ 邮箱/ 出现/ 故障/ ,/ 而/ 这/ 一/ 故障/ 造成/ 大约/ 15/ 万/ 用户/ 的/ 数据/ 丢失/ ②/ ./ 2012/ 年/ 8/ 月/ ,/ 国内/ 云/ 提供商/ 盛大/ 云因/ 机房/ 一台/ 物理/ 服务器/ 磁盘/ 发生/ 故障/ ,/ 导致/ 客户/ 的/ 部分/ 数据/ 丢失/ ③/ ./ 由此可见/ ,/ 云中/ 的/ 数据安全/ 存储/ 已经/ 阻碍/ 了/ 云/ 计算/ 在/ IT/ 领域/ 得到/ 大规模/ 的/ 使用/ [/ 3/ -/ 4/ ]/ ./ 当/ 用户/ 采用/ 云/ 存储/ 模式/ 后/ ,/ 其/ 存储/ 在/ 云中/ 的/ 数据/ 可能/ 遭到/ 其他/ 用户/ 或云/ 计算/ 提供商/ 的/ 窥视/ 、/ 修改/ 或/ 损坏/ ./ 通常/ ,/ 数据/ 的/ 机密性/ 可/ 通过/ 数据/ 加密/ 、/ 匿名/ 机制/ 等/ 机制/ 来/ 确保/ [/ 5/ -/ 7/ ]/ ./ 但/ 当/ 采用/ 云/ 存储/ 后/ ,/ 用户/ 可能/ 并/ 没有/ 在/ 本地/ 保存/ 任何/ 数据/ 副本/ ,/ 从而/ 无法/ 保证/ 云中/ 的/ 数据/ 是/ 完整/ 的/ ./ 用户/ 将/ 数据/ 存储/ 到/ 云中/ 时/ ,/ 可能/ 面临/ 以下/ 三种/ 损坏/ 数据/ 的/ 行为/ :/ (/ 1/ )/ 软件/ 失效/ 或硬件/ 损坏/ 导致/ 数据/ 丢失/ ,/ 这种/ 失效/ 属于/ 概率/ 性/ 事件/ ;/ (/ 2/ )/ 存储/ 在/ 云中/ 的/ 数据/ 可能/ 遭到/ 其他/ 用户/ 的/ 恶意/ 损坏/ ,/ 文献/ [/ 8/ ]/ 以/ AmazonEC2/ 存储/ 服务/ 为例/ ,/ 指出/ 恶意/ 的/ 用户/ 可以/ 对/ 云中/ 同一/ 宿主机/ 上/ 的/ 其他/ 虚拟机/ 发起/ 攻击/ ,/ 损坏/ 其他/ 用户/ 的/ 数据/ ;/ (/ 3/ )/ 云/ 服务提供商/ 可能/ 并/ 没有/ 遵守/ 服务/ 等级/ 协议/ (/ SLAs/ )/ ,/ 其/ 为了/ 经济/ 利益/ ,/ 擅自/ 删除/ 一些/ 用户/ 不/ 常/ 访问/ 的/ 数据/ ,/ 或/ 采取/ 离线/ 存储/ 方式/ ./ 总而言之/ ,/ 在/ 现有/ 的/ 云/ 体系/ 框架/ 下/ ,/ 云中/ 数据/ 的/ 完整性/ 无法/ 得到/ 有效/ 的/ 确保/ [/ 9/ ]/ ./ 数据完整性/ 证明/ 机制/ 能/ 及时/ 地/ 识别/ 云中/ 损坏/ 数据/ 的/ 行为/ [/ 10/ ]/ ./ 本文/ 通过/ 对/ 现有/ 的/ 多种/ 数据完整性/ 检测/ 机制/ 进行/ 归类/ 分析/ ,/ 探讨/ 了/ 适合/ 云/ 存储/ 的/ 完整性/ 验证/ 机制/ ,/ 并/ 对/ 云/ 存储/ 领域/ 的/ 数据完整性/ 验证/ 机制/ 的/ 发展趋势/ 进行/ 了/ 展望/ ./ 2/ 云/ 存储/ 环境/ 下/ 数据完整性/ 证明/ 本节/ 将/ 对/ 云/ 存储/ 环境/ 下/ 的/ 数据模型/ 和/ 数据完整性/ 验证/ 机制/ 的/ 基本/ 框架/ 进行/ 简单/ 介绍/ ./ 2.1/ 数据/ 存储/ 模型/ 云/ 存储/ 环境/ 下/ 数据完整性/ 证明/ 所/ 采用/ 数据/ 存储/ 模型/ 如图/ 1/ 所示/ ,/ 由/ 用户/ (/ Customer/ )/ 、/ 云/ 服务提供商/ (/ CloudServerProvider/ ,/ CSP/ )/ 及/ 可信/ 第三方/ 审计/ (/ TrustedPartyAuditor/ ,/ TPA/ )/ 组成/ [/ 9/ ]/ ./ 其中/ ,/ 用户/ (/ Customer/ )/ 可以/ 自定义/ 地/ 定制/ 云/ 存储/ 服务/ ;/ 云/ 服务提供商/ (/ CloudServerProvider/ ,/ CSP/ )/ 为/ 用户/ 提供/ 存储/ 或/ 计算/ 服务/ ,/ 具有/ 强/ 的/ 计算能力/ 和/ 存储/ 能力/ ;/ 第三方/ 审计/ (/ ThirdPartyAuditor/ ,/ TPA/ )/ ,/ 具有/ 用户/ 所/ 没有/ 的/ 审计/ 经验/ 和/ 能力/ ,/ 可以/ 替代/ 用户/ 对/ 云中/ 存储/ 的/ 数据/ 执行/ 审计/ 任务/ ,/ 减轻/ 用户/ 在/ 验证/ 阶段/ 的/ 计算/ 负担/ ./ 由于/ 接入/ 云/ 的/ 设备/ 受/ 计算资源/ 的/ 限制/ ,/ 用户/ 不/ 可能/ 将/ 大量/ 的/ 时间/ 和/ 精力/ 花费/ 在/ 对/ 远程/ 节点/ 的/ 数据完整性/ 检测/ 上/ ./ 通常/ ,/ 云/ 用户/ 将/ 完整性/ 验证/ 任务/ 移交/ 给/ 经验丰富/ 的/ 第三方/ 来/ 完成/ ./ 采用/ 第三方/ 验证/ 时/ ,/ 验证/ 方只/ 需要/ 掌握/ 少量/ 的/ 公开/ 信息/ 即可/ 完成/ 完整性/ 验证/ 任务/ ./ 2.2/ 构建/ 框架/ 定义/ 1/ ./ 数据完整性/ 证明/ 机制/ 由/ Setup/ 和/ Challenge/ 两个/ 阶段/ 组成/ ,/ 通过/ 采用/ 抽样/ 的/ 策略/ 对/ 存储/ 在/ 云中/ 的/ 数据文件/ 发起/ 完整性/ 验证/ ./ 具体/ 实现/ 由/ 6/ 个/ 多项式/ 时间/ 内/ 算法/ 组成/ ,/ 如下/ 所示/ ./ (/ 1/ )/ 密钥/ 生成/ 算法/ :/ KeyGen/ (/ 1k/ )/ →/ (/ pk/ ,/ sk/ )/ ./ 由/ 用户/ 在/ 本地/ 执行/ ./ k/ 为/ 安全/ 参数/ ,/ 返回/ 一个/ 匹配/ 的/ 公钥/ 、/ 私钥/ 对/ (/ pk/ ,/ sk/ )/ ./ (/ 2/ )/ 数据/ 块/ 标签/ 生成/ 算法/ :/ TagBlock/ (/ sk/ ,/ F/ )/ →/ Φ/ ./ TagBlock/ (/ ·/ )/ 算法/ 由/ 用户/ 执行/ ,/ 为/ 每个/ 文件/ 生成/ 同态/ 签名/ 标签/ 集合/ Φ/ ,/ 作为/ 认证/ 的/ 元/ 数据/ ./ 该/ 算法/ 输/ ①/ ②/ ③/ Page3/ 入/ 参数/ 包括/ 私钥/ sk/ 和/ 数据文件/ F/ ,/ 返回/ 认证/ 的/ 元/ 数据/ Φ/ ./ (/ 3/ )/ 证据/ 生成/ 算法/ :/ GenProof/ (/ pk/ ,/ F/ ,/ Φ/ ,/ chal/ )/ →/ P/ ./ 该/ 算法/ 由/ 服务器/ 运行/ ,/ 生成/ 完整性/ 证据/ P/ ./ 输入/ 参数/ 包括/ 公钥/ pk/ 、/ 文件/ F/ 、/ 挑战/ 请求/ chal/ 和/ 认证/ 元/ 数据/ 集合/ Φ/ ./ 返回/ 该次/ 请求/ 的/ 完整性/ 证据/ P/ ./ (/ 4/ )/ 证据/ 检测/ 算法/ :/ CheckProof/ (/ pk/ ,/ chal/ ,/ P/ )/ →/ (/ “/ true/ ”/ ,/ “/ false/ ”/ )/ ./ 由/ 用户/ 或/ 可信/ 第三方/ TPA/ 运行/ ,/ 对/ 服务器返回/ 的/ 证据/ P/ 进行/ 判断/ ./ 输入/ 参数/ 为/ 公钥/ pk/ ,/ 挑战/ 请求/ chal/ 及/ P/ 返回/ 验证/ 成功/ 或/ 失败/ ./ 当/ 存储/ 在/ 云中/ 文件/ 需要/ 支持/ 动态/ 操作/ 时/ ,/ 还/ 需要/ 以下/ 两个/ 算法/ 支持/ :/ (/ 5/ )/ 更新/ 执行/ 算法/ :/ ExecUpdate/ (/ F/ ,/ Φ/ ,/ Update/ )/ →/ (/ F/ ,/ Φ/ ,/ Vupdate/ )/ ./ 算法/ 由/ 服务器/ 运行/ ,/ 将/ 文件/ F/ 作为/ 输入/ ,/ 相应/ 标签/ Φ/ 及/ 数据/ 请求/ 操作/ Update/ ,/ 输出/ 一个/ 更新/ 文件/ F/ 和/ 更新/ 标签/ 集合/ Φ/ ,/ 及/ 相对/ 应地/ 更新/ 证据/ Vupdate/ ./ (/ 6/ )/ 更新/ 验证/ 算法/ :/ VerifyUpdate/ (/ pk/ ,/ Update/ ,/ Pupdate/ )/ →/ (/ “/ true/ ”/ ,/ “/ false/ ”/ )/ ./ 该/ 算法/ 由/ 用户/ 执行/ ,/ 返回/ 更新/ 操作/ 成功/ 或/ 失败/ ./ 数据完整性/ 验证/ 机制/ 在/ 具体实施/ 过程/ 中/ 可以/ 分为/ 两个/ 阶段/ 组成/ :/ Setup/ 阶段/ 和/ Challenge/ 阶段/ :/ Setup/ 阶段/ :/ 初始化/ 阶段/ ./ 首先/ ,/ 用户/ 运行/ Key/ -/ Gen/ (/ ·/ )/ 生成/ 密钥/ 对/ (/ pk/ ,/ sk/ )/ ;/ 然后/ ,/ 对/ 存储/ 的/ 文件/ 进行/ 分块/ F/ =/ (/ m1/ ,/ m2/ ,/ …/ ,/ mn/ )/ ;/ 之后/ ,/ 运行/ TagBlock/ (/ ·/ )/ 为/ 文件/ 中/ 每/ 一个/ 数据/ 块/ 生成/ 同态/ 标签/ 集合/ Φ/ =/ {/ σ/ i/ }/ 1/ / i/ / n/ ;/ 最后/ ,/ 将/ 数据文件/ F/ 和/ 签名/ 集合/ Φ/ 同时/ 存入/ 云中/ ,/ 删除/ 的/ 本地/ {/ F/ ,/ Φ/ }/ ./ Challenge/ 阶段/ :/ 验证/ 请求/ 阶段/ ./ 用户/ 或/ TPA/ 作为/ 验证/ 者/ ,/ 周期性/ 的/ 发起/ 完整性/ 验证/ ./ 从文件/ F/ 分块/ 索引/ 集合/ [/ 1/ ,/ n/ ]/ 中/ 随机/ 挑取/ c/ 个块/ 索引/ {/ s1/ ,/ s2/ ,/ …/ ,/ sc/ }/ ,/ 并且/ 为/ 每/ 一个/ 索引/ si/ 选取/ 一个/ 随机数/ vi/ ,/ 将/ 两者/ 组合/ 一起/ 生成/ 挑战/ 请求/ chal/ =/ {/ i/ ,/ vi/ }/ s1/ / i/ / sc/ 发送给/ 服务器/ ./ 图/ 2/ 数据完整性/ 证明/ 机制/ 框架/ 分类/ 数据/ 持有/ 性/ 证明/ PDP/ 机制/ 最先/ 运用/ 于/ 网格/ 计算/ 和/ P2P/ 网络/ 中/ ./ 用户/ 为了/ 获取/ 更强/ 存储/ 能力/ ,/ 选择/ 将/ 数据备份/ 到/ 远程/ 节点/ 上/ ./ Deswarte/ 等/ 人/ [/ 11/ ]/ 最先/ 服务器/ 作为/ 证明/ 者/ ,/ 根据/ 存储/ 在/ 其/ 服务器/ 上/ 的/ 数据文件/ {/ F/ ,/ Φ/ }/ ,/ 调用/ GenProof/ (/ ·/ )/ 生成/ 完整性/ 证据/ P/ ,/ 返回/ 给/ 验证/ 者/ ./ 验证/ 者/ 接受/ 证据/ 后/ ,/ 执行/ CheckProof/ (/ ·/ )/ 验证/ 证据/ 是否/ 正确/ ./ 2.3/ 云/ 存储/ 环境/ 下/ 数据完整性/ 证明/ 所/ 具有/ 的/ 特性/ 与/ P2P/ 网络/ 、/ 网格/ 计算/ 等/ 分布式/ 网络/ 相比/ ,/ 云/ 存储/ 环境/ 下/ 数据完整性/ 验证/ 机制/ 具有/ 以下/ 几个/ 显著特点/ :/ (/ 1/ )/ 支持/ 动态/ 操作/ ./ 为了/ 满足/ 云中/ 的/ 应用/ ,/ 需要/ 完整性/ 验证/ 机制/ 支持/ 动态/ 操作/ ,/ 而/ 传统/ 的/ 数据完整性/ 证明/ 机制/ 已/ 预先/ 为/ 每/ 一个/ 数据文件/ 生成/ 不可/ 伪造/ 的/ 数据/ 签名/ 标签/ 集合/ ,/ 当/ 数据/ 进行/ 更新/ 时/ 需要/ 重新/ 生成/ 大部分/ 签名/ 标签/ ,/ 使得/ 计算/ 代价/ 和/ 通信/ 开销/ 较大/ ;/ (/ 2/ )/ 公开/ 认证/ ,/ 为了/ 缓解/ 用户/ 在/ 存储/ 和/ 计算/ 上/ 的/ 压力/ ,/ 云/ 环境/ 下/ 的/ 数据完整性/ 验证/ 机制/ 最好/ 能/ 支持/ 公开/ 认证/ ,/ 允许/ 任意/ 的/ 第三方/ 来/ 替代/ 用户/ 来/ 完成/ 数据完整性/ 验证/ ;/ (/ 3/ )/ 本地/ 无/ 备份/ 认证/ ,/ 用户/ 在/ 本地/ 并不需要/ 存储/ 数据/ 副本/ ;/ (/ 4/ )/ 无/ 状态/ 认证/ ,/ 验证/ 过程/ 无需/ 保存/ 任何/ 验证/ 状态/ ;/ (/ 5/ )/ 确保/ 用户/ 隐私/ ,/ 用户/ 采用/ 公开/ 验证/ 应/ 能/ 确保/ 用户/ 的/ 数据/ 隐私/ ./ 3/ 数据完整性/ 证明/ 验证/ 机制/ 框架/ 分类/ 数据完整性/ 验证/ 机制/ 根据/ 是否/ 对/ 数据文件/ 采用/ 了/ 容错/ 预处理/ 分为/ 数据/ 持有/ 性/ 证明/ PDP/ 机制/ (/ ProvableDataPossession/ ,/ PDP/ )/ 和/ 数据/ 可/ 恢复/ 证明/ POR/ 机制/ (/ ProofsofRetrievability/ ,/ POR/ )/ ./ 如图/ 2/ 所示/ ,/ 本文/ 按/ 不同/ 的/ 关注点/ 进行/ 了/ 分类/ ,/ PDP/ 机制/ 能/ 快速/ 判断/ 远程/ 节点/ 上/ 数据/ 是否/ 损坏/ ,/ 更/ 多/ 的/ 注重/ 效率/ ./ POR/ 机制/ 不仅/ 能/ 识别/ 数据/ 是否/ 已损坏/ ,/ 且/ 能/ 恢复/ 已损坏/ 的/ 数据/ ./ 两种/ 机制/ 有着/ 不同/ 的/ 应用/ 需求/ ,/ PDP/ 机制/ 主要/ 用于/ 检测/ 大/ 数据文件/ 的/ 完整性/ ,/ 而/ POR/ 机制/ 则/ 用于/ 重要/ 数据/ 的/ 完整性/ 确保/ ,/ 如/ 压缩文件/ 的/ 压缩/ 表等/ ./ 对于/ 这/ 类/ 应用/ ,/ 尽管/ 只/ 损坏/ 很小/ 一部分/ 数据/ ,/ 但/ 却/ 造成/ 了/ 整个/ 数据文件/ 失效/ ./ 考虑/ 利用/ HMAC/ 哈希/ 函数/ 来/ 实现/ 远程/ 数据/ 的/ 完整性/ 验证/ ,/ 数据/ 存储/ 到/ 远程/ 节点/ 之前/ ,/ 预先/ 计算/ 数据/ 的/ MAC/ 值/ ,/ 并/ 将/ 其/ 保存/ 在/ 本地/ ./ 验证/ 时/ ,/ 用户/ 从/ 远程/ Page4/ 节点/ 上/ 取回/ 数据/ ,/ 并/ 计算/ 此时/ 的/ MAC/ 值/ ,/ 比/ 对/ 验证/ 者/ 手中/ 的/ MAC/ 值来/ 判断/ 远程/ 节点/ 上/ 的/ 数据/ 是否是/ 完整性/ 的/ ./ 由于/ 需要/ 取回/ 整个/ 数据文件/ ,/ 该/ 机制/ 需要/ 较大/ 计算/ 代价/ 和/ 通信/ 开销/ ,/ 无法/ 满足/ 大规模/ 的/ 应用/ ./ 为了/ 支持/ 任意/ 次/ 的/ 完整性/ 检测/ ,/ Deswarte/ 等/ 人/ 后来/ 考虑/ 利用/ RSA/ 签名/ 的/ 同态/ 特性/ 来/ 构造/ PDP/ 机制/ ,/ 但/ 该/ 机制/ 需要/ 将/ 整个/ 文件/ 用/ 一个/ 大数/ 表示/ ,/ 导致/ 高昂/ 的/ 计算/ 代价/ ./ 之后/ ,/ Seb/ é/ 等/ 人/ [/ 12/ ]/ 对/ 该/ 算法/ 进行/ 了/ 改进/ ,/ 提出/ 了/ 利用/ 分块/ 的/ 方法/ 来/ 减轻/ 计算/ 代价/ ,/ 但/ 采用/ 确定性/ 的/ 验证/ 策略/ ,/ 同样/ 无法/ 验证/ 大/ 的/ 数据文件/ ./ 随后/ ,/ Ateniese/ 等/ 人/ [/ 10/ ]/ 提出/ 了/ 采用/ 概率/ 性/ 的/ 策略/ 来/ 完成/ 完整性/ 验证/ ,/ 且/ 利用/ RSA/ 签名/ 机制/ 的/ 同态/ 特性/ ,/ 将/ 证据/ 聚集/ 成/ 一个/ 小/ 的/ 值/ ,/ 大大降低/ 了/ 协议/ 的/ 通信/ 开销/ ./ 随后/ ,/ Curtmola/ 等/ 人/ [/ 13/ ]/ 考虑/ 了/ 多/ 副本/ 情况/ 下/ 数据完整性/ 的/ 验证/ ,/ 实现/ 了/ 一种/ 满足/ 分布式/ 存储/ 环境/ 的/ MR/ -/ PDP/ 机制/ ,/ 但/ 不能/ 支持/ 动态/ 的/ 数据/ 操作/ ./ 随着/ 云/ 存储/ 模式/ 的/ 出现/ ,/ Erway/ 等/ 人/ [/ 14/ ]/ 发现/ ,/ 用户/ 可能/ 需要/ 对/ 存储/ 在/ 远程/ 节点/ 上/ 的/ 数据文件/ 进行/ 动态/ 操作/ ,/ 如/ 插入/ ,/ 修改/ ,/ 删除/ 等/ ,/ 而/ 传统/ 的/ PDP/ 机制/ 已/ 不能/ 满足/ 这一/ 要求/ ,/ 他们/ 考虑/ 引入/ 动态/ 数据结构/ 来/ 组织/ 数据/ 块/ 集合/ ,/ 实现/ 了/ 支持/ 块级/ 全/ 动态/ 操作/ ./ 之后/ ,/ Wang/ 等/ 人/ [/ 9/ ]/ 实现/ 了/ 另外/ 一种/ 支持/ 全/ 动态/ 操作/ 的/ PDP/ 机制/ ,/ 该/ 机制/ 考虑/ 采用/ Merkle/ 哈希/ 树来/ 确保/ 数据/ 块/ 在/ 位置/ 上/ 的/ 正确性/ ,/ 而/ 数据/ 块值/ 则/ 通过/ BLS/ 签名/ 机制/ 来/ 确保/ ./ 为了/ 减轻/ 用户/ 的/ 负担/ ,/ 该/ 机制/ 还/ 考虑/ 引入/ 独立/ 的/ 第三方/ TPA/ 来/ 代替/ 用户/ 验证/ 云中/ 数据/ 的/ 完整性/ ./ 但/ 采用/ 这种/ 方式/ 存在/ 泄漏/ 隐私/ 的/ 风险/ ./ 针对/ 这一/ 缺陷/ ,/ Wang/ 等/ 人/ [/ 15/ ]/ 提出/ 了/ 另/ 一种/ 保护/ 隐私/ 的/ 数据完整性/ 验证/ 机制/ ,/ 该/ 机制/ 通过/ 随机/ 掩码/ 技术/ ,/ 有效/ 地/ 隐藏/ 了/ 云/ 服务器返回/ 证据/ 中/ 的/ 数据/ 信息/ ,/ 使得/ TPA/ 无法/ 探知/ 数据/ 内容/ ./ 尽管/ PDP/ 机制/ 能/ 识别/ 远程/ 节点/ 上/ 的/ 数据/ 是否/ 已损坏/ ,/ 但/ 却/ 无法/ 保证数据/ 是否是/ 可用/ 的/ ./ Juels/ 等/ 人/ [/ 16/ ]/ 最先/ 考虑/ 如何/ 恢复/ 已损坏/ 的/ 数据/ ,/ 提出/ 了/ 一种/ 基于/ 哨兵/ (/ sentinel/ )/ 的/ POR/ 机制/ ,/ 该/ 机制/ 不仅/ 能/ 判断/ 远程/ 节点/ 上/ 的/ 数据/ 是否/ 已损坏/ ,/ 并且/ 可以/ 恢复/ 一定/ 程度/ 的/ 数据/ 失效/ ./ 但/ 该/ 机制/ 不/ 支持/ 公开/ 验证/ ,/ 且/ 只能/ 进行/ 有限/ 次/ 验证/ ./ 之后/ ,/ Shacham/ 等/ 人/ [/ 17/ ]/ 吸收/ Ateniese/ 等/ 人/ 关于/ 同态/ 验证/ 标签/ (/ HomomorphicVerifiableTags/ ,/ HVTs/ )/ 的/ 思想/ ,/ 考虑/ 运用/ BLS/ 短消息/ 签名/ 机制/ 来/ 构造/ 同态/ 验证/ 标签/ ,/ 减少/ 了/ 验证/ 阶段/ 的/ 通信/ 开销/ ./ 该/ 方法/ 被/ 证明/ 在/ 任何/ 强/ 威胁/ 模型/ 中是/ 安全/ 的/ ./ 由于/ 在/ 初始化/ 阶段/ 引入/ 数据/ 容错/ 预处理/ ,/ 使得/ 动态/ 块级/ 操作/ 在/ POR/ 机制/ 中/ 变得/ 难以实现/ ./ Wang/ 等/ 人/ [/ 18/ ]/ 提出/ 利用/ 纠错码/ 的/ 线性/ 特征/ 来/ 支持/ 部分/ 动态/ 操作/ ,/ 但/ 无法/ 支持/ 插入/ 操作/ ./ Chen/ 等/ 人/ [/ 19/ ]/ 对/ Wang/ 的/ 机制/ 进行/ 优化/ ,/ 考虑/ 采用/ CauchyReed/ -/ Solomon/ 线性/ 编码/ 来/ 进行/ 数据/ 预处理/ ,/ 该/ 方法/ 有效/ 地/ 提高/ 了/ 恢复/ 错误/ 的/ 效率/ ,/ 但/ 更新/ 操作/ 需要/ 云/ 服务器/ 重新/ 生成/ 所有/ 的/ 辅助/ 容错/ 信息/ ,/ 导致/ 计算/ 代价/ 较/ 高/ ./ 综上所述/ ,/ 设计/ 支持/ 全/ 动态/ 操作/ 的/ POR/ 机制/ 仍/ 是/ 一个/ 开放性/ 的/ 问题/ ./ 4/ 数据完整性/ 证明/ 验证/ 机制/ 根据/ 是否/ 对原/ 数据/ 采用/ 容错/ 预处理/ 技术/ ,/ 数据完整性/ 证明/ 机制/ 可以/ 分为/ 数据/ 持有/ 性/ 证明/ PDP/ 机制/ 和/ 数据/ 可/ 恢复/ 证明/ POR/ 机制/ ,/ 下面/ 将/ 对/ 这/ 两类/ 验证/ 机制/ 进行/ 分析/ 对比/ ./ 4.1/ 数据/ 持有/ 性/ 证明/ 犘犇/ 犘/ 机制/ 现有/ 的/ PDP/ 机制/ 包括/ :/ 基于/ MAC/ 认证码/ 的/ PDP/ 机制/ 、/ 基于/ RSA/ 签名/ 的/ PDP/ 机制/ 、/ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ 、/ 支持/ 动态/ 操作/ 的/ PDP/ 机制/ 、/ 支持/ 多/ 副本/ 的/ PDP/ 机制/ 及/ 保护/ 隐私/ 的/ PDP/ 机制/ 等/ ./ 4.1/ ./ 1/ 基于/ MAC/ 认证码/ 的/ PDP/ 机制/ 基于/ MAC/ (/ MessageAuthenticationCode/ ,/ MAC/ )/ 认证码/ 的/ PDP/ 机制/ (/ MAC/ -/ PDPI/ )/ ,/ 利用/ 消息/ 认证码/ MAC/ 值/ 作为/ 验证/ 元/ 数据/ ,/ 对/ 远程/ 服务器/ 上/ 存储/ 的/ 数据/ 进行/ 完整性/ 验证/ [/ 11/ ]/ ./ 最为/ 简单/ 的/ 一种/ 方式/ 是/ ,/ 用户/ 首先/ 利用/ 调用函数/ MACsk/ (/ ·/ )/ 为/ 数据文件/ F/ 生成/ 验证/ 元/ 数据/ 集合/ MAC/ =/ {/ maci/ }/ 1/ / i/ / n/ ,/ 然后/ 将/ 其/ 和/ 文件/ 一起/ 存储/ 到/ 远程/ 节点/ 上/ ,/ 最后/ 将/ 密钥/ 信息/ sk/ 和/ 文件/ 信息/ (/ 包括/ 文件/ 名字/ 等/ )/ 发送给/ 验证/ 者/ (/ TPA/ )/ ;/ 验证/ 时/ ,/ TPA/ 将/ 需要/ 验证/ 的/ 数据/ 块/ 的/ 块/ 索引/ 发送给/ 远程/ 服务器/ ,/ 远程/ 服务器返回/ 指定/ 的/ 数据/ 块/ 和/ 与其/ 相对/ 应/ 的/ MAC/ 值/ 作为/ 响应/ ./ TPA/ 利用/ 私钥/ 计算/ 数据/ 块/ 的/ MAC/ 值/ ,/ 通过/ 比/ 对/ 返回/ 证据/ 中/ 的/ MAC/ 值/ 判断/ 文件/ F/ 是否/ 完整/ ./ 每次/ 验证/ 请求/ 时/ ,/ 该/ 方法/ 需要/ 远程/ 服务器返回/ F/ 中/ 的/ 部分/ 数据/ 内容/ ,/ 不但/ 造成/ 了/ 数据文件/ 的/ 隐私/ 泄露/ ,/ 而且/ 需要/ 大/ 的/ 通信/ 开销/ 和/ 计算/ 代价/ ./ 针对/ 这一/ 问题/ ,/ Shah/ 等/ 人/ [/ 20/ ]/ 提出/ 了/ 另/ 一种/ 基于/ MAC/ 值/ 的/ 完整性/ 检测/ 机制/ (/ MAC/ -/ PDPII/ )/ ./ 在/ 用户/ 外/ 包/ 数据/ 之前/ ,/ 用户/ 选取/ s/ 个/ 随机/ 消息/ 认证码/ 密钥/ {/ ski/ }/ 1/ / i/ / s/ ,/ 然后/ 用户/ 对/ 整个/ 文件/ 调用函数/ MACski/ (/ F/ )/ 求出/ s/ 个/ MAC/ 值/ ,/ 并/ 将/ 验证/ 元/ 数据/ {/ ski/ ,/ MACi/ }/ 1/ / i/ / s/ 发送给/ TPA/ ;/ 验证/ 时/ ,/ TPA/ 向/ 服务器/ 发出/ 一个/ 挑战/ 请求/ {/ ski/ }/ i/ ←/ R/ [/ 1/ ,/ s/ ]/ ,/ 远程/ 服务器/ 计算/ 文件/ 的/ Page5MAC/ 值/ ,/ 并/ 将/ 其/ 返回/ 给/ TPA/ ./ TPA/ 比/ 对/ 存储/ 在/ 本地/ 的/ MAC/ 值后/ ,/ 判断/ 数据文件/ 是否是/ 完整/ 的/ ./ 基于/ MAC/ 认证码/ 可行/ 的/ PDP/ 机制/ 存在/ 以下/ 固有/ 缺陷/ :/ (/ 1/ )/ 只能/ 进行/ 有限/ 次/ 验证/ ;/ (/ 2/ )/ 验证/ 者/ 必须/ 保存/ 大量/ 辅助/ 验证/ 信息/ ,/ 如/ 密钥/ 信息/ 、/ 验证/ 元/ 数据/ 等/ ;/ (/ 3/ )/ 无法/ 支持/ 动态/ 更新/ 操作/ ,/ 只能/ 用于/ 静态/ 的/ 数据完整性/ 验证/ ./ 4.1/ ./ 2/ 基于/ RSA/ 签名/ 的/ PDP/ 机制/ 针对/ 基于/ MAC/ 认证码/ 的/ PDP/ 机制/ 存在/ 的/ 缺陷/ ,/ Deswarte/ 等/ 人/ [/ 11/ ]/ 考虑/ 利用/ RSA/ 签名/ 机制/ 的/ 同态/ 特性/ (/ am/ )/ r/ =/ arm/ =/ (/ ar/ )/ m/ (/ modN/ )/ 来/ 构造/ 完整性/ 检测/ 机制/ ,/ 这里/ m/ 为/ 待/ 验证/ 的/ 数据文件/ ,/ a/ 为/ 用户/ 选择/ 的/ 随机数/ ,/ r/ 为/ 每次/ 请求/ 生成/ 的/ 随机数/ (/ RSA/ -/ PDPI/ )/ ./ 很/ 明显/ ,/ 该/ 机制/ 能/ 进行/ 无限/ 多次/ 完整性/ 验证/ ,/ 同时/ 有效/ 地/ 确保/ 了/ 数据/ 的/ 内容/ 不/ 被/ 验证/ 者/ 察知/ ,/ 但/ 协议/ 需要/ 将/ 整个/ 数据文件/ F/ 用/ 一个/ 整数/ d/ 来/ 表示/ ,/ 用于/ 之后/ 的/ 运算/ ./ 因此/ ,/ 对/ 较大/ 的/ 数据文件/ 来说/ ,/ 计算/ 代价/ 过高/ ./ 该/ 算法/ 的/ 具体/ 实现/ 如图/ 3/ 所示/ ./ Setup/ 阶段/ :/ (/ 1/ )/ 选择/ 两个/ 长度/ 为/ 1024/ 位/ 的/ 素数/ p/ 和/ q/ ,/ 计算/ RSA/ 模数/ N/ =/ p/ ·/ q/ (/ 2/ )/ 将/ 文件/ F/ 用/ 整数/ d/ 表示/ ,/ 计算/ 验证/ 元/ 数据/ :/ M/ =/ admodN/ ,/ a/ ←/ RZN/ (/ 3/ )/ 将/ F/ 存储/ 到/ 远程/ 服务器/ 上/ Challenge/ 阶段/ :/ (/ 1/ )/ 验证/ 者/ 随机/ 选择/ r/ ←/ RZN/ ,/ 生成/ 验证/ 请求/ A/ =/ armodN/ ,/ 并发/ (/ 2/ )/ 证明/ 者/ 计算/ 证据/ B/ =/ AdmodN/ ,/ 发送/ 响应/ 集合/ B/ 给/ 证明/ 者/ ./ (/ 3/ )/ 证明/ 者/ 计算/ C/ =/ MrmodN/ ,/ 并/ 判断/ C/ =/ ?/ B/ ./ 送/ A/ 给/ 远程/ 服务器/ ./ 图/ 3Deswarte/ 等/ 人/ 的/ 基于/ RSA/ 签名/ PDP/ 机制/ Filho/ 等/ 人/ [/ 21/ ]/ 对/ Deswarte/ 等/ 人/ 提出/ 的/ 协议/ 进行/ 了/ 修改/ ,/ 利用/ 欧拉/ 函数/ / (/ N/ )/ 的/ 性质/ 来/ 优化/ 验证/ 元/ 数据/ 的/ 生成/ 过程/ (/ RSA/ -/ PDPII/ )/ ./ 定义/ 一个/ 哈希/ 函数/ h/ (/ d/ )/ =/ dmod/ / (/ N/ )/ ,/ 利用/ 该/ 哈希/ 函数/ 将/ 大/ 的/ 数据文件/ 压缩成/ 小/ 的/ 哈希/ 值后/ ,/ 再/ 用于/ 运算/ ,/ 减轻/ 了/ 计算/ 代价/ ./ 为了/ 辅助/ 完成/ 完整性/ 验证/ ,/ 还/ 需/ 定义/ 另/ 一个/ 函数/ H/ :/ H/ (/ d/ )/ =/ rdmodN/ ,/ 该/ 函数/ 具有/ 同态/ 特性/ ,/ 即/ H/ (/ d/ +/ d/ )/ =/ H/ (/ d/ )/ H/ (/ d/ )/ ./ 由于/ / (/ N/ )/ 是/ 群/ (/ Z/ // nZ/ )/ / 的/ 阶/ ,/ 据此/ 可以/ 构建/ 函数/ h/ 与/ 函数/ H/ 的/ 对应/ 关系/ ,/ 即/ H/ :/ H/ (/ d/ )/ =/ rdmodN/ =/ rdmod/ / (/ N/ )/ =/ rh/ (/ d/ )/ modN/ ./ 利用/ 这一/ 性质/ 可以/ 设计/ 基于/ RSA/ 签名/ 的/ PDP/ 机制/ ,/ 具体/ 实现/ 如图/ 4/ 所示/ ./ 相比/ 前/ 一/ 机制/ 而言/ ,/ 该/ PDP/ 机制/ 的/ 有效/ 地/ 减少/ 了/ 验证/ 元/ 数据/ 的/ 存储/ 代价/ 和/ 通信/ 开销/ ./ 但/ 该/ 机制/ 同样/ 不/ 适合/ 大规模/ 的/ 数据/ 存储/ ./ 为了/ 减少/ 认证/ 元/ 数据/ 的/ 大小/ ,/ Seb/ é/ 等/ 人/ [/ 12/ ]/ 用/ 分块/ 的/ 思想/ 改进/ Filho/ 的/ 工作/ ,/ 从/ 一定/ 程度/ 上/ 减轻/ 了/ p/ ·/ q/ 元/ 数据/ 集/ 的/ 大小/ ./ Setup/ 阶段/ :/ (/ 1/ )/ 选择/ 两个/ 长度/ 为/ 1024/ 位/ 的/ 素数/ p/ 和/ q/ ,/ 计算/ RSA/ 模数/ N/ =/ (/ 2/ )/ 计算/ 欧拉/ 函数/ / (/ N/ )/ =/ (/ p/ -/ 1/ )/ (/ q/ -/ 1/ )/ (/ 3/ )/ 将/ 文件/ F/ 用/ 整数/ d/ 表示/ ,/ 计算/ 验证/ 元/ 数据/ h/ (/ d/ )/ =/ dmod/ / (/ N/ )/ (/ 4/ )/ 将/ F/ 存储/ 到/ 远程/ 服务器/ 上/ Challenge/ 阶段/ :/ (/ 1/ )/ 验证/ 者/ 选择/ r/ ←/ RZN/ ,/ 并/ 发送/ r/ 给/ 证明/ 者/ (/ 2/ )/ 证明/ 者/ 计算/ 证据/ R/ =/ rdmodN/ ,/ 并/ 将/ 其/ 返回/ 给/ 验证/ 者/ (/ 3/ )/ 证明/ 者/ 计算/ R/ =/ rh/ (/ d/ )/ modN/ ,/ 并/ 判断/ R/ =/ ?/ RAteniese/ 等/ 人/ [/ 10/ ,/ 22/ ]/ 最先/ 对/ 数据/ 持有/ 性/ 证明/ PDP/ 机制/ 进行/ 了/ 形式化/ 建模/ ,/ 并/ 考虑/ 采用/ 抽样/ 的/ 策略/ 完成/ 完整性/ 验证/ ,/ 有效/ 地/ 减少/ 了/ 计算/ 代价/ 和/ 通信/ 开销/ (/ S/ -/ PDPIII/ ,/ E/ -/ PDPIII/ )/ ./ 该/ 机制/ 的/ 创新性/ 主要/ 在于/ 以下/ 3/ 点/ :/ (/ 1/ )/ 考虑/ 先对/ 文件/ F/ 进行/ 分块/ ,/ 然后/ 对/ 每个/ 数据/ 块/ 分别/ 计算/ 元/ 认证/ 数据/ ,/ 降低/ 了/ 生成/ 验证/ 元/ 数据/ 的/ 计算/ 代价/ ;/ (/ 2/ )/ 提出/ 了/ 同态/ 认证/ 标签/ 的/ 概念/ ,/ 降低/ 了/ 通信/ 开销/ ./ 同态/ 认证/ 标签/ (/ Homomor/ -/ phicVerifiableTags/ ,/ HVTs/ )/ 是/ 一种/ 无法/ 伪造/ 的/ 认证/ 元/ 数据/ ,/ 并且/ 可以/ 将/ 多个/ 数据/ 块/ 的/ 元/ 数据/ 聚集/ 成/ 一个/ 值/ ,/ 解决/ 了/ 基于/ RSA/ 签名/ PDP/ 机制/ 中/ 的/ 证据/ 大小/ 与/ 数据/ 块/ 的/ 数目/ 呈/ 线性/ 增长/ 的/ 问题/ ;/ (/ 3/ )/ 提出/ 了/ 采用/ 抽样/ 的/ 策略/ 对/ 远程/ 节点/ 进行/ 完整性/ 检测/ ./ 对于/ 存储/ 在/ 远程/ 节点/ 上/ 的/ 数据/ ,/ 若/ 想得到/ 95/ %/ 以上/ 的/ 损坏/ 识别率/ ,/ 验证/ 者/ 只/ 需/ 从/ 数据/ 分块/ 集合/ 中/ 随机/ 抽取/ 300/ 个/ 以上/ 的/ 数据/ 块/ 用于/ 验证/ [/ 23/ ]/ ./ 如图/ 5/ 所示/ ,/ Ateniese/ 实例/ 化/ 了/ 两种/ 基于/ RSA/ 签名/ 的/ PDP/ 机制/ ,/ S/ -/ PDP/ 机制/ 和/ E/ -/ PDP/ 机制/ ./ S/ -/ PDP/ 机制/ 在/ 指数/ 知识/ 假定/ (/ KEA/ -/ r/ )/ 下/ 是/ 安全/ 的/ ./ E/ -/ PDP/ 机制/ 是/ 一种/ 弱化/ 的/ 数据/ 持有/ 性/ 证明/ 机制/ ./ 但/ 随后/ 的/ 研究/ 表明/ ,/ E/ -/ PDP/ 机制/ 并/ 不是/ 安全/ 的/ [/ 17/ ]/ ./ 从/ 上/ 可知/ ,/ Ateniese/ 等/ 人/ 的/ 研究/ 有效/ 地/ 减轻/ 了/ 用户/ 和/ 服务器端/ 的/ 计算/ 代价/ ,/ 其/ 提出/ 的/ PDP/ 形式化/ 框架/ 能/ 运用/ 于云/ 存储/ 环境/ 下/ 的/ 数据完整性/ 检测/ ./ 但是/ ,/ 为了/ 支持/ 外/ 包/ 数据/ 的/ 完整性/ 检测/ ,/ 基于/ RSA/ 的/ PDP/ 机制/ 需要/ 为/ 文件/ 的/ 每个/ 分块/ 都/ 生成/ 一个/ 认证/ 元/ 数据/ (/ 其/ 大小/ 为/ 128B/ )/ ,/ 计算/ 代价/ 和/ 通信/ 开销/ 仍然/ 较大/ ./ 另外/ ,/ 该/ 机制/ 专门/ 针对/ 静态数据/ 存储/ ,/ 并/ 不/ 支持/ 动态数据/ 块/ 更新/ ,/ 无法/ 满足/ 动态/ 的/ 环境/ ./ 4.1/ ./ 3/ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ BLS/ 签名/ 机制/ 是/ 由/ Boneh/ 等/ 人/ [/ 24/ ]/ 提出/ 的/ 一种/ 短消息/ 签名/ 机制/ ,/ 相比/ 目前/ 最/ 常用/ 的/ 两种/ 签名/ 机制/ RSA/ 和/ DSA/ 而言/ ,/ 在/ 同等/ 安全/ 条件/ 下/ (/ 模数/ 的/ 位数/ 为/ 1024bits/ )/ ,/ BLS/ 签名/ 机制/ 具有/ 更/ 短/ 的/ 签名/ 位数/ ,/ Page6p/ ·/ qS/ -/ PDP/ 验证/ 机制/ 选取/ 公共/ 参数/ :/ f/ 是/ 伪/ 随机/ 函数/ ,/ π/ 是/ 伪/ 随机/ 置换/ 函数/ ,/ H/ 为/ 密码学/ 哈希/ 函数/ Setup/ 阶段/ :/ (/ 1/ )/ 选择/ 两个/ 长度/ 为/ 1024/ 位/ 的/ 素数/ p/ 和/ q/ ,/ 计算/ RSA/ 模数/ N/ =/ (/ 2/ )/ 选取/ g/ 作为/ QRN/ 生成元/ ,/ QRN/ 是模/ N/ 的/ 二次/ 剩余/ 集/ (/ 3/ )/ 生成/ 公私/ 密钥/ 对/ pk/ =/ (/ N/ ,/ g/ ,/ e/ )/ ,/ sk/ =/ (/ d/ ,/ v/ )/ ,/ 满足/ 以下/ 关系/ :/ e/ ·/ d/ ≡/ 1mod/ (/ p/ -/ 1/ )/ (/ q/ -/ 1/ )/ (/ 4/ )/ 选取/ 唯一/ 的/ 文件/ 标识/ v/ ←/ R/ {/ 0/ ,/ 1/ }/ κ/ ,/ 对/ 文件/ F/ 进行/ 分块/ :/ F/ =/ {/ b1/ ,/ …/ ,/ bn/ }/ ,/ 生成/ 认证/ 元/ 数据/ 集合/ :/ Φ/ =/ {/ σ/ i/ }/ 1/ / i/ / n/ ,/ 这里/ σ/ i/ =/ (/ h/ (/ v/ ‖/ i/ )/ ·/ gmi/ )/ d/ (/ 5/ )/ 将/ F/ 和/ 认证/ 元/ 数据/ Φ/ 存入/ 远程/ 服务器/ Challenge/ 阶段/ :/ (/ 1/ )/ 验证/ 者/ 对/ c/ 个/ 数据/ 块/ 发出/ 挑战/ 请求/ chal/ :/ 随机/ 选择/ 2/ 个/ 密钥/ k1/ ←/ R/ {/ 0/ ,/ 1/ }/ κ/ ,/ k2/ ←/ R/ {/ 0/ ,/ 1/ }/ κ/ ,/ 选取/ 随机数/ s/ ←/ R/ (/ Z/ // NZ/ )/ / ,/ 计算/ gs/ =/ gsmodN/ ./ 令/ chal/ =/ (/ c/ ,/ k1/ ,/ k2/ ,/ gs/ )/ ,/ 并/ 将/ 其/ 发送给/ 证明/ 者/ ./ (/ 2/ )/ 证明/ 者/ 接收/ 到/ 请求/ chal/ 后/ ,/ 首先/ 计算/ ij/ =/ π/ k1/ (/ j/ )/ ,/ aj/ =/ fk2/ (/ j/ ,/ 1/ / j/ / c/ )/ ;/ 之后/ ,/ 计算/ 证据/ T/ =/ ∏/ gajmj/ ;/ 最后/ ,/ 计算/ 证据/ ρ/ =/ H/ (/ ga1mi1/ 送给/ 证明/ 者/ ./ (/ 3/ )/ 验证/ 者/ 接收/ 到/ 证据/ {/ T/ ,/ ρ/ }/ 后/ ,/ 首先/ 计算/ τ/ =/ Te/ ;/ 然后/ ,/ 对于/ 1/ / j/ / c/ ,/ 计算/ ij/ =/ π/ k1/ (/ j/ )/ ,/ aj/ =/ fk2/ (/ j/ )/ ,/ τ/ =/ τ/ 算/ ρ/ =/ H/ (/ τ/ s/ )/ modN/ ,/ 判断/ ρ/ =/ ρ/ E/ -/ PDP/ 机制/ :/ 在/ Challenge/ 阶段/ 做/ 以下/ 替换/ :/ 第/ 2/ 步/ 证据/ 生成/ 部分/ 替换/ 为/ T/ =/ ∏/ H/ (/ gmi1/ 第/ 3/ 步/ τ/ =/ τ/ 图/ 5Ateniese/ 等/ 人/ 的/ 基于/ RSA/ 签名/ PDP/ 机制/ 大约/ 为/ 160bits/ (/ RSA/ 签名/ 为/ 1024bits/ ,/ DSA/ 签名/ 为/ 320bits/ )/ ./ 另外/ ,/ BLS/ 签名/ 机制/ 具有/ 同态/ 特性/ ,/ 可以/ 将/ 多个/ 签名/ 聚集/ 成/ 一个/ 签名/ ./ 这两点/ 好/ 的/ 特性/ 使得/ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ 可以/ 获得/ 更少/ 的/ 存储/ 代价/ 和/ 更/ 低/ 通信/ 开销/ 来/ 实现/ ./ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ 是/ 一种/ 公开/ 验证/ 机制/ ,/ 用户/ 可以/ 将/ 繁琐/ 的/ 数据/ 审计/ 任务/ 交由/ 第三方/ TPA/ 来/ 完成/ ,/ 满足/ 了/ 云/ 存储/ 的/ 轻量级/ 设计/ 要求/ ,/ 具体/ 实现/ 如图/ 6/ 所示/ ./ 另外/ ,/ 相比/ 其他/ 机制/ 而言/ ,/ 该/ 机制/ 具有/ 更/ 小/ 的/ 存储/ 开销/ 和/ 通信/ 开销/ ./ 4.1/ ./ 4/ 支持/ 动态/ 操作/ 的/ PDP/ 机制/ 对于/ 存储/ 在/ 云中/ 的/ 数据/ ,/ 用户/ 可能/ 随时/ 需要/ 更新/ ,/ 而/ 之前/ 提到/ 的/ PDP/ 机制/ 已/ 无法/ 满足/ 这种/ 需求/ ./ 因为/ 在/ 计算/ 数据/ 块/ 的/ 验证/ 元/ 数据/ 时/ ,/ 数据/ 块/ 的/ 索引/ 作为/ 一部分/ 信息/ 加入/ 了/ 计算/ ,/ 如/ σ/ i/ =/ (/ H/ (/ v/ |/ i/ )/ umi/ )/ sk/ ,/ 倘若/ 插入/ 一个/ 新/ 的/ 数据/ 块/ ,/ 将/ 导致/ 该/ 数据/ 块/ 后/ 的/ 其他/ 数据/ 块/ 的/ 验证/ 元/ 数据/ 都/ 需/ 重新/ 生成/ ,/ 导致/ 计算/ 代价/ 过高/ 而/ 无法/ 实现/ ./ 为了/ 解决/ 这一/ 问题/ ,/ Wang/ 等/ 人/ [/ 10/ ]/ 、/ Erway/ 等/ 人/ [/ 14/ ]/ 考虑/ 采用/ 动态/ 数据结构/ 确保/ 选取/ 公共/ 参数/ :/ e/ :/ G/ ×/ G/ →/ GT/ 为/ 双线性/ 映射/ ,/ g/ 为/ G/ 的/ 生成元/ ,/ H/ :/ {/ 0/ ,/ 1/ }/ / →/ G/ 为/ BLS/ 哈希/ 函数/ Setup/ 阶段/ :/ (/ 1/ )/ 随机/ 选取/ 私钥/ α/ ←/ Zp/ ,/ 计算/ 相对/ 应地/ 公私/ v/ =/ g/ α/ ./ 私密/ 为/ sk/ =/ (/ α/ )/ 公钥/ 为/ pk/ =/ (/ v/ )/ (/ 2/ )/ 选取/ 唯一/ 的/ 文件/ 标识/ v/ ←/ R/ {/ 0/ ,/ 1/ }/ κ/ ,/ 随机/ 选取/ 辅助/ 变量/ u/ ←/ RG/ ,/ 对/ 文件/ F/ 进行/ 分块/ :/ F/ =/ {/ b1/ ,/ …/ ,/ bn/ }/ ,/ 生成/ 认证/ 元/ 数据/ 集合/ Φ/ =/ {/ σ/ i/ }/ 1/ / i/ / n/ ,/ 这里/ σ/ i/ =/ (/ h/ (/ v/ ‖/ i/ )/ ·/ umi/ )/ α/ (/ 3/ )/ 将/ F/ 和/ 认证/ 元/ 数据/ Φ/ 存入/ 远程/ 服务器/ Challenge/ 阶段/ :/ (/ 1/ )/ 验证/ 者/ 从/ 块/ 索引/ [/ 1/ ,/ n/ ]/ 中/ 随机/ 选取/ c/ 个块/ 索引/ ,/ 并/ 对/ 每个/ 块/ 索引/ i/ 选取/ 一个/ 相应/ 地/ 随机数/ vi/ ←/ RZp/ // 2/ 组成/ 挑战/ 请求/ chal/ =/ {/ i/ ,/ vi/ }/ s1/ / i/ / sc/ ,/ 并/ 将/ 其/ 发送给/ 证明/ 者/ ./ (/ 2/ )/ 证明/ 者/ 接收/ 到/ 请求/ chal/ 后/ ,/ 首先/ 计算/ σ/ =/ ∏/ i/ )/ viuvimi/ ;/ 之后/ ,/ 计算/ μ/ =/ ∑/ {/ σ/ ,/ μ/ }/ 作为/ 证据/ 返还/ 给/ 证明/ 者/ ./ (/ 3/ )/ 验证/ 者/ 接收/ 到/ 证据/ {/ σ/ ,/ μ/ }/ 后/ ,/ 根据/ 以下/ 等式/ 判断/ 外/ 包/ 数据/ 是否/ 完整/ :/ e/ (/ σ/ ,/ g/ )/ =/ ?/ (/ e/ ∏/ 数据/ 块/ 在/ 位置/ 上/ 的/ 正确性/ ,/ 而/ 数据/ 块/ 标签/ 确保/ 数据/ 块/ 在/ 数值/ 上/ 是/ 正确/ 的/ ./ 前/ 3/ 节已/ 对/ 如何/ 确保/ 数据/ 块值/ 的/ 完整性/ 进行/ 了/ 描述/ ,/ 因此/ 在/ 本/ 小节/ 中/ ,/ 将/ 更/ 多/ 的/ 关注/ 如何/ 支持/ 动态/ 操作/ ./ 4.1/ ./ 4.1/ 支持/ 部分/ 动态/ 的/ PDP/ 机制/ Ateniese/ 等/ 人/ [/ 25/ ]/ 最先/ 考虑/ 如何/ 支持/ 动态/ 操作/ ,/ 通过/ 对/ 文献/ [/ 10/ ]/ 提出/ 的/ PDP/ 机制/ 做/ 简单/ 的/ 修改/ ,/ 使/ 其/ 支持/ 了/ 部分/ 动态数据/ 操作/ (/ DPDP/ )/ ./ 但/ 该/ 机制/ 仅能/ 支持/ 数据/ 更新/ 、/ 数据/ 删除/ 和/ 数据/ 追加/ 等/ 操作/ ,/ 而/ 无法/ 支持/ 数据/ 插入/ ./ 另外/ ,/ 执行/ 删除/ 操作/ 时/ 采用/ 标记/ Dblock/ 来/ 替代/ 之前/ 的/ 数据/ 块/ 位置/ ,/ 造成/ 了/ 一定/ 程度/ 的/ 存储空间/ 浪费/ ./ 4.1/ ./ 4.2/ 基于/ 跳表/ 的/ PDP/ 机制/ 为了/ 解决/ 不能/ 支持/ 插入/ 操作/ 这一/ 问题/ ,/ Erway/ 等/ 人/ [/ 14/ ]/ 考虑/ 引入/ 动态/ 数据结构/ 来/ 支持/ 全/ 动态/ 操作/ (/ S/ -/ DPDP/ )/ ./ 在/ 初始化/ 阶段/ ,/ 该/ 机制/ 首先/ 对/ 数据文件/ F/ 分块/ ,/ F/ =/ {/ m1/ ,/ …/ ,/ mn/ }/ ;/ 然后/ 为/ 每个/ 数据/ 块/ mi/ 生成/ 数据/ 块/ 标签/ ,/ τ/ i/ =/ gmimodN/ ;/ 之后/ ,/ 利用/ 数据/ 块/ 标签/ 生成/ 根/ 节点/ 的/ 哈希/ 值/ Mc/ ,/ 并/ 将/ 其/ 保存/ 在/ 验证/ 者/ 手中/ ./ 在/ 挑战/ 请求/ 阶段/ ,/ 验证/ 者/ 随机/ 生成/ 挑战/ 请求/ chal/ =/ {/ i/ ,/ vi/ }/ s1/ / i/ / sc/ ,/ 并/ 将/ 其/ 发送给/ 服务器/ ./ 服务器/ 接收/ 到/ 挑战/ 请求/ 后/ ,/ 首先/ 计算/ M/ =/ ∑/ sc/ 指定/ 数据/ 块/ 的/ 认证/ 路径/ {/ Π/ (/ i/ )/ }/ s1/ / i/ / sc/ ;/ 最后/ ,/ 将/ {/ M/ ,/ {/ Π/ i/ ,/ τ/ i/ }/ s1/ / i/ / sc/ }/ 作为/ 证据/ 返回/ 给/ 验证/ 者/ ./ 验证/ 者/ 先利/ Page7/ 用/ 公式/ 计算/ T/ =/ ∏/ sc/ 是否/ 相等/ ,/ 若/ 相等/ ,/ 表示/ 数据/ 内容/ 是否是/ 完整/ 的/ ,/ 否则/ ,/ 认为/ 数据文件/ 已/ 被/ 修改/ ;/ 之后/ ,/ 验证/ 者/ 根据/ 返回/ 认证/ 路径/ {/ Π/ (/ i/ )/ }/ s1/ / i/ / sc/ 、/ 标签/ 信息/ {/ τ/ i/ }/ s1/ / i/ / sc/ 及/ 存储/ 在/ 本地/ 认证/ 元/ 数据/ Mc/ 判断/ 数据/ 块/ 在/ 位置/ 上/ 是/ 正确/ 的/ ./ 这种/ 机制/ 是/ 唯一/ 一种/ 不/ 需要/ 生成/ 私钥/ 的/ PDP/ 机制/ ,/ 且/ 数据/ 块/ 标签/ 可以/ 在/ 挑战/ 阶段/ 由/ 服务器/ 临时/ 生成/ ./ 举例说明/ :/ 假定/ 认证/ 跳表/ 数据结构/ 如图/ 7/ 所示/ ,/ 节点/ 中/ 的/ 数值/ 为/ 节点/ 的/ rank/ 值/ ,/ 左上角/ 的/ 节点/ 为/ 跳表/ 的/ 起始/ 节点/ w7/ ,/ 当前/ 节点/ 用/ v/ 表示/ ,/ 目标/ 节点/ 为/ v3/ ,/ w/ 表示/ 当前/ 节点/ 的/ 右边/ 节点/ ,/ z/ 表示/ 当前/ 节点/ 的/ 图/ 7/ 基于/ 跳表/ 的/ 认证/ 数据结构/ 图/ 8/ 计算/ 经过/ 当前/ 节点/ v/ 可/ 访问/ 底层/ 节点/ 的/ 范围/ (/ 其中/ ,/ w/ 表示/ 当前/ 节点/ v/ 右边/ 的/ 节点/ ,/ z/ 代表/ 当前/ 节点/ v/ 之下/ 的/ 节点/ )/ 动态/ 更新/ 操作/ 时/ ,/ 用户/ 首先/ 发出/ 更新/ 请求/ chal/ =/ {/ update/ ,/ mi/ ,/ τ/ i/ }/ ,/ 服务器/ 更新过程/ 分/ 两个/ 阶段/ 进行/ :/ 第/ 1/ 阶段/ ,/ 解析/ 请求/ 中/ 的/ 更新/ 操作/ update/ 倘若/ 是/ 删除/ 操作/ (/ D/ )/ ,/ 则/ 直接/ 删除/ 所在/ 的/ 数据/ 块/ ,/ 倘若/ 是/ 修改/ 操作/ (/ M/ )/ ,/ 则/ 更新/ 指定/ 的/ 数据/ 块/ 内容/ 和/ 块/ 签名/ 标签/ ,/ 倘若/ 是/ 插入/ 操作/ (/ I/ )/ ,/ 则/ 在/ 指定/ 的/ 位置/ 插入/ 数据/ 块/ 和/ 块/ 标签/ ;/ 第/ 2/ 阶段/ 是/ ,/ 辅助/ 用户/ 更新/ 跳表/ 的/ 根/ 哈希/ 值/ ,/ 服务器返回/ 每个/ 指定/ 节点/ 的/ 认证/ 路径/ ,/ 用户/ 利用/ 认证/ 路径/ 更新/ 根/ 节点/ 的/ 哈希/ 值/ ./ 基于/ 跳表/ 的/ 全/ 动态/ PDP/ 机制/ ,/ 是/ 第/ 1/ 种/ 完全/ 支持/ 动态/ 操作/ 的/ PDP/ 机制/ ,/ 但/ 其/ 存在/ 认证/ 路径/ 过长/ ,/ 每次/ 认证/ 过程/ 中/ 需要/ 大量/ 的/ 辅助/ 信息/ 支持/ ,/ 计算/ 代价/ 和/ 通信/ 开销/ 较大/ 等/ 问题/ ./ 4.1/ ./ 4.3/ 基于/ MerkleTree/ 的/ PDP/ 机制/ Wang/ 等/ 人/ [/ 10/ ]/ 提出/ 了/ 另/ 一种/ 支持/ 动态/ 操作/ 的/ 下方/ 节点/ ./ 根据/ 节点/ 上/ 的/ rank/ 值/ ,/ 可以/ 为/ 每个/ 节点/ 界定/ 一个/ 经过/ 该/ 节点/ 可/ 访问/ 底层/ 节点/ 的/ 范围/ [/ low/ (/ v/ )/ ,/ high/ (/ v/ )/ ]/ ./ 例如/ 根/ 节点/ w7/ 的/ low/ (/ w7/ )/ 和/ high/ (/ w7/ )/ 的/ 值/ 分别/ 为/ 1/ ,/ 12/ ./ 根据/ 当前/ 节点/ 的/ 访问/ 范围/ ,/ 可以/ 计算/ 两个/ 后继/ 节点/ w/ ,/ z/ 的/ 访问/ 范围/ ,/ 即/ [/ low/ (/ w/ )/ ,/ high/ (/ w/ )/ ]/ ,/ [/ low/ (/ z/ )/ ,/ high/ (/ z/ )/ ]/ ,/ 计算方法/ 如图/ 8/ 所示/ ./ 如果/ 指定/ 节点/ 的/ 块/ 索引/ i/ ∈/ [/ low/ (/ w/ )/ ,/ high/ (/ w/ )/ ]/ ,/ 跟随/ rgt/ (/ w/ )/ ,/ 并设/ v/ =/ w/ ,/ 否则/ 跟随/ dwn/ (/ w/ )/ ,/ 即/ v/ =/ z/ ,/ 直到/ 找到/ 目标/ 节点/ i/ ./ 将/ 寻找/ 节点/ 的/ 路径/ 称为/ 访问/ 路径/ ,/ 而/ 与其/ 相反/ 的/ 路径/ 称之为/ 认证/ 路径/ ./ 在/ 图/ 7/ 中/ ,/ 目标/ 节点/ 的/ 查找/ 路径/ 是/ (/ w7/ ,/ w6/ ,/ w5/ ,/ w3/ ,/ v5/ ,/ v4/ ,/ v3/ )/ ,/ 认证/ 路径/ 为/ (/ v3/ ,/ v4/ ,/ v5/ ,/ w3/ ,/ w4/ ,/ w5/ ,/ w6/ ,/ w7/ )/ ./ PDP/ 机制/ ,/ 即/ 基于/ Merkle/ -/ Tree/ 的/ PDP/ 机制/ ,/ 该/ 机制/ 通过/ Merkle/ -/ tree/ 结构/ 来/ 确保/ 数据/ 块/ 在/ 位置/ 上/ 的/ 正确性/ ,/ 利用/ 基于/ BLS/ -/ 签名/ 的/ PDP/ 机制/ 来/ 确保/ 数据/ 块/ 内容/ 上/ 的/ 完整性/ (/ M/ -/ DPDP/ )/ ./ 与/ Eeway/ 等/ 人/ 提出/ 的/ 基于/ 跳表/ 的/ PDP/ 机制/ 不同/ 的/ 是/ ,/ 数据/ 块/ 标签/ 并/ 没有/ 参与/ 动态/ 结构/ 中根/ 节点/ 哈希/ 值/ 的/ 计算/ ./ 初始化/ 阶段/ 分为/ 两步/ 进行/ :/ 第/ 1/ 步/ 与/ 图/ 6/ 中/ 的/ 初始化/ 步骤/ 大致相同/ ,/ 除了/ 块/ 标签/ 计算/ ,/ 为了/ 支持/ 动态/ 操作/ ,/ 需要/ 用/ σ/ i/ =/ (/ H/ (/ mi/ )/ umi/ )/ α/ 替换/ σ/ i/ =/ (/ H/ (/ name/ ‖/ i/ )/ umi/ )/ α/ ;/ 第/ 2/ 步/ ,/ 构造/ Merkle/ 认证/ 哈希/ 树/ ,/ 并/ 计算/ 根/ 哈希/ 值/ ,/ 并/ 将/ 其/ 存储/ 到/ TPA/ 中/ 作为/ 验证/ 元/ 数据/ ./ 验证/ 过程/ 与/ 图/ 6/ 的/ 验证/ 过程/ 相比/ ,/ 需要/ 做/ 以下/ 修改/ :/ (/ 1/ )/ 在/ 返回/ 证据/ {/ μ/ ,/ σ/ }/ 的/ 同时/ ,/ 需要/ 返回/ 挑战/ 请求/ 中块/ 索引/ 所/ 对应/ 的/ 辅助/ 认证/ 路径/ 信息/ {/ H/ (/ mi/ )/ ,/ Ω/ i/ }/ s1/ / i/ / sc/ ;/ (/ 2/ )/ 验证/ 证据/ 时/ ,/ 利用/ 辅助/ 认证/ 路径/ 信息/ 计算/ 根/ 节点/ 的/ 哈希/ 值/ ./ 只有/ 根/ 节点/ 相同/ 时才/ 进行/ 后续/ 步骤/ ;/ (/ 3/ )/ 验证/ 公式/ 需要/ 更/ 改为/ e/ (/ σ/ ,/ g/ )/ =/ ?/ (/ e/ ∏/ scH/ (/ mi/ )/ vi/ ·/ u/ μ/ ,/ )/ v/ ./ Merkle/ 认证/ 哈希/ 树/ 的/ 数据结构/ 如图/ 9/ 所示/ ,/ i/ =/ s1Page8Me/ 叶/ 节点/ 值为/ 数据/ 块/ 的/ 哈希/ 值/ ,/ 对叶/ 节点/ 的/ 访问/ 采用/ 深度/ 优先/ 的/ 方式/ 进行/ ,/ 如图/ 中/ 黑/ 虚线/ 所示/ ./ 云/ 服务器/ 为了/ 证明/ 用户/ 的/ 数据/ 是/ 完整/ 的/ ,/ 首先/ 需要/ 构造/ 一条/ 认证/ 路径/ (/ 如图/ 中/ 虚线/ 所示/ )/ ,/ 及其/ 辅助/ 认证/ 信息/ (/ AuxiliaryAuthenticationInformation/ ,/ AAI/ )/ 组成/ 证据/ ,/ 返回/ 给/ TPA/ ./ TPA/ 根据/ 认证/ 路径/ 和/ 辅助/ 认证/ 信息/ 重新/ 计算/ 根/ 节点/ 的/ 哈希/ 值/ ,/ 比/ 对/ 本地/ 存储/ 的/ 根/ 节点/ 哈希/ 值来/ 判断/ 数据/ 在/ 位置/ 上/ 是否是/ 完整/ 的/ ./ 例如/ ,/ 倘若/ TPA/ 发出/ 的/ 挑战/ 请求/ 中/ 选取/ 块/ 索引/ 为/ 图/ 9Merkle/ 哈希/ 树结构/ 很/ 明显/ ,/ 采用/ Merkle/ 认证/ 哈希/ 树/ 可以/ 确保/ 数据/ 节点/ 在/ 位置/ 上/ 的/ 完整性/ ./ 动态/ 更新/ 操作/ 时/ ,/ 在/ 更新/ 节点/ 的/ 同时/ ,/ 需/ 返回/ 辅助/ 认证/ 信息/ 给/ 用户/ ,/ 用户/ 重新/ 生成/ 根/ 节点/ 的/ 哈希/ 值/ ./ 之后/ ,/ 更新/ 存储/ 在/ TPA/ 中/ 的/ 根/ 哈希/ 值/ ./ 相比/ 跳表/ 数据结构/ ,/ Merkle/ 认证/ 哈希/ 树/ 具有/ 更/ 简单/ 的/ 数据结构/ ./ 4.1/ ./ 5/ 保护/ 数据/ 隐私/ 的/ PDP/ 机制/ 采用/ 第三方/ 对/ 存储/ 在/ 云中/ 的/ 数据/ 进行/ 完整性/ 验证/ 时/ ,/ 有/ 可能/ 泄露/ 用户/ 的/ 数据/ 隐私/ 信息/ ./ 通过/ n/ 次/ 挑战/ 请求/ 后/ ,/ 不怀好意/ 的/ 第三方/ 有/ 可能/ 获取/ 用户/ 存储/ 在/ 云中/ 的/ 文件/ 内容/ 和/ 元/ 验证/ 数据/ 信息/ ./ 例如/ ,/ 假定/ 用户/ 委托/ 第三方/ 对/ 其/ 存储/ 在/ 云中/ 的/ 文件/ F/ 进行/ 完整性/ 检测/ ,/ 第三方/ 重复/ 地/ 对/ {/ ii/ ,/ …/ ,/ ic/ }/ 位置/ 上/ 的/ 数据/ 进行/ 完整性/ 检测/ ,/ 每次/ 挑战/ 请求/ 为/ 发送/ chalj/ =/ {/ i/ ,/ vji/ }/ ,/ s1/ / i/ / sc/ ,/ 1/ / j/ / c/ 给/ 云/ 服务器/ ,/ 经过/ c/ 次/ 挑战/ 请求/ 后/ ,/ 可以/ 得到/ 以下/ 方程组/ :/ 只要/ 上述/ 方程组/ 中/ 的/ 系数/ 行列式/ 不为/ 0/ ,/ 则/ 可/ 通过/ 高斯/ 消去法/ 计算/ 求得/ (/ mi1/ ,/ …/ ,/ mic/ )/ 的/ 值/ ./ 同理/ ,/ 第三方/ 也/ 可以/ 获得/ 块/ 索引/ 相对/ 应/ 的/ 签名/ 标签/ (/ σ/ i1/ ,/ …/ ,/ σ/ ic/ )/ ./ 目前/ 大部分/ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ 采用/ 公开/ 验证/ 时/ ,/ 将/ 有/ 泄露/ 用户/ 数据/ 隐私/ 的/ 风险/ ./ Wang/ 等/ 人/ [/ 15/ ,/ 26/ ]/ 建议/ 用/ 随机/ 掩码/ 技术/ 来/ 解决/ 这一/ 问题/ (/ PP/ -/ {/ 2/ ,/ 7/ }/ ,/ 云/ 服务器/ 需在/ 返回/ 证据/ {/ μ/ ,/ σ/ }/ 的/ 同时/ ,/ 返回/ x2/ 认证/ 路径/ {/ h/ (/ x2/ )/ ,/ hc/ ,/ ha/ }/ 、/ 辅助/ 认证/ 路径/ Ω/ =/ {/ h/ (/ x1/ )/ ,/ hd/ }/ 和/ x7/ 的/ 认证/ 路径/ {/ x7/ ,/ hf/ ,/ hb/ }/ 、/ 辅助/ 认证/ 路径/ Ω/ =/ {/ h/ (/ x8/ )/ ,/ he/ }/ 给/ TPA/ ,/ TPA/ 重新/ 计算/ Merkle/ 哈希/ 树/ 的/ 根/ 节点/ 哈希/ 值/ ,/ 即/ 根据/ hc/ =/ h/ (/ h/ (/ x1/ )/ ‖/ h/ (/ x2/ )/ )/ ,/ ha/ =/ h/ (/ hc/ ‖/ hd/ )/ ,/ hf/ =/ h/ (/ h/ (/ x7/ )/ ‖/ h/ (/ x8/ )/ )/ ,/ hb/ =/ h/ (/ he/ ‖/ hf/ )/ ,/ 最后/ 计算/ 出根/ 节点/ 哈希/ 值/ hR/ =/ h/ (/ ha/ ‖/ hb/ )/ ,/ 对比/ 存储/ 在/ 本地/ 的/ 根/ 哈希/ 值来/ 判断/ 数据文件/ 是否是/ 完整/ 的/ ./ PDP/ )/ ./ 该/ 方法/ 的/ 核心思想/ 是/ ,/ 基于/ BLS/ 签名/ 的/ PDP/ 证据/ 生成/ 过程/ 中/ ,/ 使用/ 到/ 了/ 线性组合/ μ/ =/ ∑/ sc/ 计算/ 证据/ 参数/ μ/ ,/ 从而/ 导致/ 了/ 数据/ 隐私/ 的/ 泄露/ ./ 因此/ ,/ 通过/ 引入/ 两个/ 参数/ r/ ,/ γ/ 来/ 隐藏/ μ/ 值/ ,/ 其中/ r/ ←/ RZp/ ,/ γ/ =/ h/ (/ R/ )/ γ/ ,/ R/ =/ e/ (/ u/ ,/ v/ )/ r/ 为/ 该次/ 审计/ 特征/ ./ 计算/ μ/ 的/ 公式/ 变为/ μ/ =/ γ/ ∑/ scS/ -/ PDP/ 验证/ 机制/ 选取/ 公共/ 参数/ :/ e/ :/ G/ ×/ G/ →/ GT/ 为/ 双线性/ 映射/ ,/ g/ 为/ G/ 的/ 生成元/ ,/ H/ :/ {/ 0/ ,/ 1/ }/ / →/ G/ 为/ BLS/ 哈希/ 函数/ ,/ h/ :/ GT/ →/ Zp/ 将/ GT/ 中/ 的/ 元素/ 均匀/ 的/ 映射/ 到/ Zp/ ./ Setup/ 阶段/ :/ 与/ 图/ 6/ 中/ Setup/ 阶段/ 一致/ Challenge/ 阶段/ :/ 做/ 以下/ 替换/ :/ 第/ 2/ 步/ 证据/ 参数/ 的/ 计算/ 替换/ 为/ μ/ =/ r/ +/ γ/ ∑/ 第/ 3/ 步/ 证据/ 检测/ 替换/ 为/ 验证/ 者/ 计算/ R/ =/ h/ (/ R/ )/ ,/ 判断/ 下/ 式/ 是否/ 成立/ Wang/ 等/ 人/ 的/ 保护/ 隐私/ 的/ PDP/ 机制/ 能/ 防止/ 云/ 存储/ 中/ 采用/ 第三方/ 在/ 审计/ 时/ 泄露/ 隐私/ 的/ 风险/ ,/ 减轻/ 了/ 用户/ 的/ 审计/ 负担/ ./ Page94/ ./ 1.6/ 支持/ 多/ 副本/ 的/ PDP/ 机制/ 采用/ 冗余/ 备份/ 的/ 方式/ 来/ 存储/ 重要/ 的/ 大/ 文件/ 数据/ ,/ 可以/ 提高/ 数据文件/ 的/ 可靠性/ (/ MR/ -/ PDP/ )/ [/ 13/ ,/ 27/ ]/ ./ 采用/ 冗余/ 备份/ 的/ 方式/ 存储/ 数据文件/ 时/ ,/ 远程/ 服务器/ 可能/ 并/ 没有/ 按照/ 用户/ 要求/ 的/ 备份/ 数来/ 存储/ 数据/ ./ 由于/ 存储/ 在/ 远程/ 服务器/ 中/ 数据/ 副本/ 完全一致/ ,/ 存储/ 服务提供商/ 可能/ 只/ 存储/ 一份/ 或/ 几份/ 数据/ 原文件/ ,/ 而/ 对外/ 宣称/ 按/ 用户/ 要求/ 存储/ 了/ 多/ 份文件/ ./ 因此/ ,/ 如何/ 确保/ 云中/ 多个/ 数据/ 副本/ 的/ 完整性/ 成为/ 了/ 另/ 一/ 研究/ 方向/ ./ 最/ 简单/ 的/ 方式/ 是/ ,/ 在/ 数据/ 存储/ 到/ 云中/ 之前/ ,/ 采用/ 多个/ 密钥/ 分别/ 对/ 每/ 一副/ 本/ 进行/ 加密/ ,/ 然后/ 存储/ 到/ 云/ 服务器/ 上/ ./ 进行/ 数据完整性/ 验证/ 时/ ,/ 每/ 一个/ 副本/ 文件/ 都/ 作为/ 独立/ 的/ 数据文件/ 进行/ 数据完整性/ 验证/ ./ 该/ 方法/ 可以/ 确保/ 存放/ 在/ 远程/ 云/ 服务器/ 上/ 的/ 数据/ 是/ 完整/ 的/ ,/ 但/ 也/ 增加/ 了/ 大量/ 的/ 重复/ 计算/ 和/ 通信/ 开销/ ,/ 多个/ 内容/ 完全一致/ 的/ 数据文件/ 需要/ 多次/ 验证/ 才能/ 确保/ 其/ 完整性/ ./ 为了/ 解决/ 这一/ 问题/ ,/ Curtmola/ 等/ 人/ [/ 23/ ]/ 设计/ 实现/ 了/ 针对/ 多/ 副本/ 的/ MR/ -/ PDP/ 机制/ ,/ 该/ 机制/ 能/ 对/ 所有/ 副本/ 数据/ 的/ 副本/ 进行/ 完整性/ 认证/ ,/ 而/ 每次/ 验证/ 所/ 带来/ 的/ 开销/ 与/ 对/ 单个/ 文件/ 的/ 进行/ 数据完整性/ 验证/ 所/ 带来/ 的/ 开销/ 大致相同/ ./ MR/ -/ PDP/ 机制/ 是/ 在/ Ateniese/ 等/ 人/ 设计/ 的/ 基于/ RSA/ 签名/ 的/ PDP/ 机制/ 上/ 修改/ 而来/ 的/ ,/ 该/ 机制/ 的/ 具体/ 组成/ 如图/ 11/ 所示/ ./ MR/ -/ PDP/ 机制/ 包含/ 有/ 5/ 个/ 算法/ :/ KeyGen/ (/ ·/ )/ 、/ ReplicaGen/ (/ ·/ )/ 、/ TagBlock/ (/ ·/ )/ 、/ GenProof/ (/ ·/ )/ 、/ CheckProof/ (/ ·/ )/ ./ 其中/ ,/ KeyGen/ (/ ·/ )/ 和/ ReplicaGen/ (/ ·/ )/ 由/ 用户/ 执行/ ,/ 分别/ 生成/ 需要/ 的/ 密钥/ 对/ 和/ t/ 个/ 数据/ 副本/ ;/ TagBlock/ (/ ·/ )/ 算法/ 为/ 每个/ 数据/ 副本/ 生成元/ 认证/ 数据/ 集合/ ;/ GenProof/ (/ ·/ )/ 图/ 11/ 多/ 副本/ 数据/ 持有/ 性/ 验证/ 机制/ (/ Si/ 为/ 远程/ 服务器/ )/ 由/ 服务器/ 执行/ ,/ 生成/ 完整性/ 证据/ ;/ CheckProof/ (/ ·/ )/ 由/ 用户/ 或者/ TPA/ 执行/ ,/ 通过/ 服务器返回/ 的/ 证据/ ,/ 验证/ 数据/ 副本/ 的/ 完整性/ ./ MR/ -/ PDP/ 机制/ 同样/ 由/ 两个/ 阶段/ 组成/ :/ 初始化/ 阶段/ 和/ 挑战/ 阶段/ ./ 初始化/ 阶段/ ,/ 用户/ 调用/ KeyGen/ (/ ·/ )/ 生成/ 密钥/ ,/ 利用/ 私钥/ 为/ 数据文件/ F/ 生成/ 块/ 签名/ 集合/ Φ/ =/ {/ σ/ i/ }/ 1/ / i/ / n/ ./ 之后/ ,/ 调用/ ReplicaGen/ (/ ·/ )/ 算法/ 生成/ m/ 个/ 数据/ 副本/ ,/ 每个/ 数据/ 副本/ 利用/ 随机/ 掩码/ 技术/ 加以/ 区分/ ./ 最后/ 将/ t/ 个/ 数据/ 副本/ 和/ 块/ 签名/ 集合/ Φ/ 存储/ 到/ 远程/ 服务器/ 中/ ./ 在/ 挑战/ 请求/ 阶段/ ,/ 验证/ 者/ 随机/ 的/ 从/ m/ 个/ 副本/ 中/ 抽取/ 一个/ 数据/ 副本/ Fu/ ,/ 决定/ 对/ 其/ 发起/ 完整性/ 验证/ ./ 用户/ 生成/ 挑战/ 请求/ 的/ 过程/ 和/ Ateneise/ 等/ 人/ [/ 9/ ]/ 设计/ 的/ E/ -/ PDP/ 一致/ ,/ 但/ 服务器/ 生成/ 证据/ 参数/ ρ/ 的/ 过程/ 存在/ 一些/ 差异/ ./ 当/ 服务器/ 接到/ 验证/ 请求/ 后/ ,/ 服务器/ 从/ 数据/ 副本/ Fu/ 中/ 抽取/ 指定/ 数据/ 块/ {/ bi/ +/ ru/ ,/ i/ }/ s1/ / i/ / sn/ ,/ 然后/ 做/ 计算/ ρ/ =/ g/ ∑/ s1/ / i/ / sc/ 一致/ ./ 在/ 检验/ 证据/ 的/ 过程/ 中/ ,/ 由于/ 每个/ 副本/ 引入/ 了/ 随机数/ ,/ 因此/ 需/ 修改/ 图/ 5/ 中/ 挑战/ 阶段/ 的/ 第/ 3/ 步/ ,/ 烄/ Te/ ∏/ scH/ (/ v/ ‖/ i/ 烆/ i/ =/ s1MR/ -/ PDP/ 机制/ 能/ 有效/ 地/ 验证/ 多个/ 副本/ 文件/ 在/ 远程/ 服务器/ 上/ 的/ 完整性/ ,/ 该/ 机制/ 并/ 不是/ 针对/ 云/ 存储/ 的/ 多/ 副本/ 备份/ ./ 4.1/ ./ 7/ 其他/ 的/ PDP/ 机制/ Wang/ 等/ 人/ [/ 28/ -/ 29/ ]/ 利用/ 双线性/ 函数/ 的/ 性质/ ,/ 设计/ 实现/ 了/ 支持/ 批处理/ 的/ PDP/ 机制/ ,/ 该/ 机制/ 能/ 让/ TPA/ 同时/ 处理/ 多个/ 审计/ 任务/ ,/ 优化/ 了/ 审计/ 性能/ ./ Wang/ 等/ 人/ [/ 30/ ]/ 针对/ 云/ 存储/ 中/ 的/ 共享/ 数据/ ,/ 利用/ 群/ 签名/ 机制/ 实现/ 了/ 用于/ 验证/ 多用户/ 共享/ 数据/ 的/ PDP/ 验证/ 机制/ ,/ 该/ 机制/ 能/ 保护/ 用户/ 数据/ 和/ 身份/ 的/ 双重/ 隐私/ ./ 4.1/ ./ 8PDP/ 机制/ 小结/ 要/ 从/ 以下/ 两/ 方面/ 考虑/ :/ 本/ 结对/ 上述/ 的/ 多种/ PDP/ 机制/ 进行/ 简单/ 对比/ ,/ 主/ (/ 1/ )/ 计算/ 复杂度/ :/ 包括/ 在/ 用户/ 预处理/ 文件/ 的/ 计算/ 代价/ 、/ 在/ 服务器/ 生成/ 证据/ 的/ 计算/ 代价/ 及/ 第三方/ 验证/ 证据/ 的/ 计算/ 代价/ ;/ (/ 2/ )/ 通信/ 复杂度/ :/ 进行/ 完整性/ 时/ 的/ 通信/ 开销/ ./ 另外/ ,/ 还/ 考虑/ 了/ PDP/ 机制/ 的/ 其他/ 一些/ 属性/ 包括/ :/ 是否/ 支持/ 动态/ 操作/ 、/ 安全/ 模型/ 及/ 文件/ 损坏/ 识别率/ 等/ ./ 4.2/ 数据/ 可/ 恢复/ 证明/ POR/ 机制/ 相比/ PDP/ 机制/ 而言/ ,/ 数据/ 可/ 恢复/ 证明/ POR/ 机/ Page10/ 制在/ 有效/ 识别/ 文件/ 是否/ 损坏/ 的/ 同时/ ,/ 能/ 通过/ 容错/ 技术/ 恢复/ 外/ 包/ 数据文件/ 中/ 已/ 出现/ 的/ 错误/ ,/ 确保/ 文件/ 是/ 可用/ 的/ ./ 以下/ 将/ 介绍/ 几种/ 经典/ 的/ POR/ 验证/ 机制/ ./ 4.2/ ./ 1/ 基于/ 岗哨/ 的/ POR/ 机制/ Juels/ 等/ 人/ [/ 16/ ]/ 最先/ 对/ 数据/ 可/ 恢复/ 证明/ 问题/ 进行/ 建模/ ,/ 提出/ 了/ 基于/ 岗哨/ (/ sentinel/ )/ 的/ POR/ 验证/ 机制/ (/ SPOR/ )/ ,/ 该/ 机制/ 主要/ 解决/ 以下/ 两个/ 问题/ :/ (/ 1/ )/ 更/ 有效/ 地/ 识别/ 外/ 包/ 文件/ 中/ 出现/ 的/ 损坏/ ;/ (/ 2/ )/ 能/ 恢复/ 已损坏/ 的/ 数据文件/ ./ 针对/ 第一个/ 问题/ ,/ Juels/ 等/ 人/ 通过/ 在外/ 包/ 的/ 文件/ 中/ 预先/ 植入/ 一些/ 称之为/ “/ 岗哨/ 位/ ”/ 的/ 检验/ 数据/ 块/ ,/ 并/ 在/ 本地/ 存储/ 好/ 这些/ 检验/ 数据/ 块/ ./ 对于/ 远程/ 服务器/ 而言/ ,/ 这些/ 岗哨/ 数据/ 块/ 与/ 数据/ 块/ 是/ 无法/ 区分/ 的/ ./ 倘若/ 服务器/ 损坏/ 了/ 数据文件/ 中/ 部分/ 内容/ ,/ 会/ 相应/ 地/ 损坏/ 到/ 岗哨/ 文件/ 块/ ./ 对比/ 存储/ 在/ 本地/ 的/ 检验/ 数据/ ,/ 能/ 判断/ 远程/ 节点/ 上/ 的/ 数据/ 是否是/ 完整/ 的/ ./ 另外/ ,/ 通过/ 岗哨/ 块/ 损坏/ 的/ 数目/ 可以/ 评估/ 文件/ 中/ 出错/ 的/ 部分/ 在/ 整个/ 文件/ 中所/ 占/ 的/ 概率/ ./ 针对/ 第二个/ 问题/ ,/ Juels/ 等/ 人/ 利用/ Reed/ -/ Solomon/ 纠错码/ 对/ 文件/ 进行/ 容错/ 预处理/ ,/ 使得/ 验证/ 机制/ 可以/ 恢复/ 一部分/ 损坏/ 的/ 数据/ ./ 文献/ [/ 16/ ]/ 表明/ ,/ 若/ 采用/ (/ 223/ ,/ 32/ )/ -/ Reed/ -/ Solomon/ 纠错码/ 对/ 文件/ 进行/ 分组/ 编码/ ,/ 文件/ 的/ 大小/ 将/ 增加/ 14/ %/ ./ 若/ 文件/ 损坏/ 识别率/ 高于/ 95/ %/ ,/ 文件/ 添加/ 岗哨/ 块/ 后/ ,/ 大小/ 将/ 增加/ 15/ ./ 基于/ 岗哨/ 的/ POR/ 验证/ 机制/ 存在/ 以下/ 缺点/ :/ (/ 1/ )/ 验证/ 次数/ 是/ 有限/ 的/ ,/ 取决于/ 岗哨/ 块/ 的/ 数目/ 及/ 每次/ 认证/ 所/ 消耗/ 的/ 数目/ ;/ (/ 2/ )/ 验证/ 机制/ 须/ 在/ 本地/ 存储/ 一定/ 数目/ 的/ 岗哨/ 块/ 数据/ ,/ 并/ 不是/ 一种/ 轻量级/ 的/ 验证/ 机制/ ./ 表/ 1/ 多种/ PDP/ 机制/ 对比/ SchemeServerComp/ ./ ClientComp/ ./ TPAComp/ ./ Comm/ ./ Dyn/ ./ ModelProbabilityofdetectionO/ (/ 1/ )/ O/ (/ 1/ )/ O/ (/ 1/ )/ NO/ (/ 1/ )/ O/ (/ 1/ )/ O/ (/ 1/ )/ NMAC/ -/ PDPI/ [/ 11/ ]/ O/ (/ 1/ )/ MAC/ -/ PDPII/ [/ 20/ ]/ O/ (/ 1/ )/ RSA/ -/ PDPI/ [/ 11/ ]/ O/ (/ 1/ )/ RSA/ -/ PDPII/ [/ 21/ ]/ O/ (/ 1/ )/ S/ -/ PDP/ [/ 10/ ]/ O/ (/ c/ )/ E/ -/ PDP/ [/ 10/ ]/ O/ (/ c/ )/ BLS/ -/ PDPO/ (/ c/ )/ DPDP/ [/ 25/ ]/ MR/ -/ PDP/ [/ 13/ ]/ O/ (/ c/ )/ M/ -/ DPDP/ [/ 9/ ]/ O/ (/ c/ )/ +/ O/ (/ logn/ )/ O/ (/ n/ )/ +/ O/ (/ logn/ )/ O/ (/ c/ )/ O/ (/ logn/ )/ YRO1/ -/ (/ 1/ -/ f/ )/ cPP/ -/ PDP/ [/ 15/ ,/ 26/ ]/ O/ (/ c/ )/ S/ -/ DPDP/ [/ 14/ ]/ O/ (/ c/ )/ +/ O/ (/ logn/ )/ O/ (/ n/ )/ +/ O/ (/ logn/ )/ O/ (/ c/ )/ O/ (/ logn/ )/ Ystandard1/ -/ (/ 1/ -/ f/ )/ c/ 注/ :/ c/ :/ 随机/ 抽取/ 的/ 数据/ 块/ 数目/ ;/ n/ :/ 文件/ 分块/ 数/ ;/ ServerComp/ ./ :/ 服务器/ 计算/ 复杂度/ ;/ ClientComp/ ./ :/ 用户/ 计算/ 复杂度/ ;/ Comm/ ./ :/ 通信/ 复杂度/ ;/ Dyn/ :/ 是否/ 支持/ 动态/ 操作/ ;/ “/ / ”/ 表示/ 部分/ 支持/ ;/ Model/ :/ 证明/ 安全/ 模型/ ;/ Probabilityofdetection/ :/ 识别/ 概率/ ;/ f/ :/ 数据/ 块/ 损坏/ 的/ 比例/ ./ 4.2/ ./ 2/ 紧缩/ 的/ POR/ 机制/ 为了/ 解决/ Juels/ 等/ 人/ 的/ 不足/ ,/ Shacham/ 等/ 人/ [/ 17/ ,/ 31/ ]/ 分别/ 提出/ 了/ 针对/ 私有/ 验证/ (/ PrivateVerifiability/ )/ 和/ 公开/ 验证/ (/ PublicVerifiability/ )/ 的/ 数据/ 可/ 恢复/ POR/ 机制/ (/ CPOR/ )/ ./ 这/ 两种/ POR/ 机制/ 都/ 具有/ 以下/ 优点/ :/ (/ 1/ )/ 无/ 状态/ 的/ 验证/ ,/ 验证/ 者/ 不/ 需要/ 保存/ 验证/ 过程/ 中/ 的/ 验证/ 状态/ ;/ (/ 2/ )/ 任意/ 次/ 验证/ ,/ 验证/ 者/ 可以/ 对/ 存储/ 在/ 远程/ 节点/ 上/ 的/ 数据/ 发起/ 任意/ 次/ 验证/ ;/ (/ 3/ )/ 通信/ 开销/ 小/ ,/ 通过/ 借鉴/ Ateniese/ 等/ 人/ 同态/ 验证/ 标签/ 的/ 思想/ ,/ 有效/ 地/ 将/ 证据/ 缩减/ 为/ 一个/ 较/ 小/ 的/ 值/ ./ 无/ 状态/ 和/ 任意/ 次/ 验证/ 需要/ POR/ 机制/ 支持/ 公开/ 验证/ ,/ 通过/ 公开/ 验证/ ,/ 用户/ 可以/ 将/ 数据/ 审计/ 任务/ 交由/ 第三方/ 来/ 进行/ ,/ 减轻/ 了/ 用户/ 的/ 验证/ 负担/ ./ 支持/ 私有/ 验证/ 的/ POR/ 机制/ 主要/ 用于/ 企业/ 内部/ 数据完整性/ 验证/ ,/ 如/ 私有/ 云/ 数据/ 审计/ ./ 过程/ 如下/ :/ 初始化/ 阶段/ ,/ 用户/ 先用/ Reed/ -/ Solomon/ 纠错码/ 对/ 整个/ 数据文件/ 进行/ 编码/ ;/ 之后/ ,/ 用户/ 选择/ 一个/ 随机数/ α/ ←/ RZp/ 作为/ 用户/ 的/ 私钥/ ;/ 然后/ ,/ 采用/ 公式/ σ/ i/ =/ fk/ (/ i/ )/ +/ α/ mi/ ∈/ Zp/ 为/ 每个/ 数据/ 块/ 的/ 生成/ 认证/ 元/ 数据/ 集合/ {/ σ/ i/ }/ 1/ / i/ / n/ ;/ 最后/ 将/ 数据文件/ F/ 和/ 元/ 数据/ 存入/ 远程/ 服务器/ 上/ ./ 挑战/ 阶段/ 与/ 图/ 6/ 中/ 的/ 挑战/ 阶段/ 大致相同/ ,/ 需要/ 修改/ 第/ 3/ 步/ ,/ 用/ σ/ =/ ?/ α/ μ/ +/ ∑/ sc/ 公开/ 验证/ 的/ POR/ 机制/ 可以/ 让/ 任意/ 的/ 第三方/ 替代/ 用户/ 来/ 发起/ 对/ 远程/ 节点/ 上/ 数据/ 的/ 完整性/ 检测/ ,/ 当/ 发现/ 数据/ 的/ 损坏/ 程度/ 小于/ 某一/ 阈值/ ε/ 时/ ,/ 通过/ 容错/ 机制/ 恢复/ 错误/ ,/ 大于/ ε/ 则/ 返回/ 给/ 用户/ 数据/ 失效/ 的/ 结论/ ./ 相比/ 图/ 6/ 中/ 的/ 基于/ BLS/ 签名/ 的/ PDP/ 机制/ 而言/ ,/ 在/ 进行/ 初始化/ 阶段/ 之前/ ,/ 需要/ 增加/ 冗余/ 编码数据/ 预处理/ 过程/ ,/ 使/ 数据文件/ 具有/ 容错/ 能力/ ,/ 即将/ F/ 分成/ n/ 个块/ ,/ 然后/ 对/ n/ 个块/ 进行/ 分组/ ,/ 每个/ 组为/ k/ 个块/ ;/ 之后/ ,/ 对/ 每组/ 数据/ 块/ 利用/ Reed/ -/ Solomon/ 纠错码/ 进行/ 容错/ 编码/ ,/ 形成/ 新/ 的/ 数据文件/ 珟/ F/ ./ 而/ 挑战/ 阶段/ 与/ 图/ 6/ 中/ 给出/ 的/ 协议/ 完全一致/ ./ Page11/ 文献/ [/ 17/ ]/ 得出/ 以下/ 结论/ :/ 对/ POR/ 机制/ 而言/ ,/ 假定/ ε/ 是/ 在/ 允许/ 的/ 错误/ 范围/ 内/ (/ 比如说/ ,/ 1000000/ 中/ 出现/ 1/ 次/ 错误/ ,/ 但/ 通过/ 了/ POR/ 验证/ )/ ,/ 定义/ ω/ =/ 1/ // #/ B/ +/ (/ ρ/ n/ )/ c/ // (/ n/ -/ c/ +/ 1/ )/ c/ ,/ 只要/ ε/ -/ ω/ 是/ 正/ 的/ 可/ 忽略/ 的/ 值/ ,/ 在/ O/ (/ n2s/ +/ (/ 1/ +/ ε/ n2/ )/ (/ n/ )/ // (/ ε/ -/ w/ )/ )/ 时间/ 范围/ 内/ ,/ 通过/ O/ (/ n/ // (/ ε/ -/ w/ )/ )/ 次/ 交互/ ,/ POR/ 机制/ 的/ 抽取/ 操作/ 能/ 恢复/ 损坏率/ 为/ ρ/ 的/ 数据文件/ ,/ 这里/ B/ 为/ 挑战/ 请求/ 时/ 随机数/ vi/ 选取/ 空间/ ,/ ρ/ 为/ 编码/ 率/ ,/ c/ 为/ 随机/ 抽取/ 的/ 数据/ 块/ 数目/ ./ 举例/ :/ 假定/ POR/ 机制/ 参数/ 选定/ 如下/ ,/ ρ/ =/ 1/ // 2/ ,/ ε/ =/ 1/ // 1000000/ ,/ B/ =/ {/ 0/ ,/ 1/ }/ 22/ ,/ c/ =/ 22/ ,/ 则/ POR/ 机制/ 能/ 恢复/ 损坏率/ 不/ 超过/ 1/ // 2/ 的/ 数据文件/ ./ 由此可见/ ,/ 相比/ PDP/ 机制/ 而言/ ,/ POR/ 机制/ 增加/ 了/ 初始化/ 时间/ ,/ 但/ 也/ 降低/ 了/ 验证/ 代价/ 和/ 通信/ 开销/ ./ 另外/ ,/ 执行/ 抽取/ 恢复/ 操作/ 的/ 人/ 必须/ 是/ 可信/ 的/ ,/ 因为/ 通过/ 一定/ 次数/ 的/ 验证/ 请求/ 后/ 其/ 将/ 获取/ 部分/ 文件/ 知识/ ./ 4.2/ ./ 3/ 支持/ 动态/ 操作/ 的/ POR/ 机制/ 由于/ POR/ 机制/ 在/ 初始化/ 过程/ 中/ ,/ 由于/ 数据/ 块/ 参与/ 了/ 容错/ 编码/ ,/ 更新/ 数据/ 块/ 的/ 同时/ 必须/ 更新/ 相应/ 地/ 冗余/ 信息/ ,/ 导致/ 计算/ 代价/ 较/ 高/ ./ Wang/ 等/ 人/ [/ 18/ ]/ 设计/ 实现/ 了/ 第/ 1/ 种/ 面向/ 云/ 存储/ 的/ ,/ 支持/ 部分/ 动态/ 操作/ 的/ POR/ 机制/ ,/ 该/ 机制/ 可以/ 检测/ 出云/ 存储/ 中/ 已/ 出现/ 的/ 错误/ ,/ 并/ 获取/ 在/ 云/ 服务器/ 上/ 发生/ 错误/ 的/ 位置/ (/ DPORI/ )/ ./ 支持/ 的/ 动态/ 操作/ 包括/ :/ 修改/ 、/ 删除/ 和/ 追加/ 等/ 3/ 种/ 操作/ ./ 具体/ 实现/ 如图/ 12/ 所示/ ,/ 该/ 机制/ 预先/ 利用/ Reed/ -/ Solomon/ 纠错码/ 的/ 生成/ 验证/ 元/ 数据/ ,/ 并/ 将/ 其/ 存储/ 在/ 本地/ ./ 验证/ 请求/ 时/ ,/ 服务器/ 利用/ 纠错码/ 的/ 线性/ 特性/ 将/ 多个/ 响应/ 聚集/ 成较/ 小/ 的/ 集合/ ./ 验证/ 者/ 通过/ 返回/ 的/ 证据/ 重新/ 生成/ 验证/ 元/ 数据/ ,/ 比/ 对/ 本地/ 存储/ 的/ 验证/ 元/ 数据/ ,/ 判断/ 文件/ 是否/ 正确/ ,/ 不/ 正确/ 时/ 将/ 获得/ 数据/ 出错/ 的/ 服务器/ ./ 很/ 明显/ ,/ 该/ 机制/ 是/ 一种/ 私有/ 验证/ 的/ POR/ 机制/ ,/ 且/ 只能/ 进行/ 有限/ 次/ 的/ 数据完整性/ 检测/ ./ Chen/ 等/ 人/ [/ 19/ ]/ 考虑/ 采用/ Cauchy/ -/ Reed/ -/ Solomon/ 纠错码/ 来/ 替表/ 2/ 多种/ POR/ 机制/ 对比/ SchemeServerComp/ ./ ClientComp/ ./ TPAComp/ ./ Comm/ ./ Dyn/ ./ ModelProbabilityofdetectionSPOR/ [/ 16/ ]/ CPOR/ [/ 17/ ,/ 30/ ]/ O/ (/ 1/ )/ O/ (/ n2/ )/ O/ (/ c/ )/ O/ (/ 1/ )/ NROPcm/ ·/ (/ 1/ -/ PcDPORI/ [/ 18/ ]/ DPORII/ [/ 19/ ]/ O/ (/ 1/ )/ O/ (/ n2/ )/ 注/ :/ Pcm/ :/ 选定/ 的/ 行/ 命中/ 损坏/ 数据/ 概率/ ;/ Pc5/ 未来/ 的/ 研究/ 趋势/ 结合实际/ 应用/ 需求/ 和/ 数据完整性/ 证明/ 机制/ 的/ 研究/ 现状/ ,/ 我们/ 认为/ 未来/ 云/ 存储/ 环境/ 下/ 数据完整性/ 证明/ 机制/ 的/ 研究/ 趋势/ 主要/ 集中/ 以下几点/ :/ 换/ DPORI/ 中/ 的/ Reed/ -/ Solomon/ 纠错码/ ,/ 提高/ 抽取/ 阶段/ 的/ 执行/ 效率/ ./ f/ 为/ 随机/ 函数/ ,/ / 为/ 随机/ 置换/ 函数/ Setup/ 阶段/ :/ (/ 1/ )/ 随机/ 选取/ 一个/ 范/ 德蒙/ 矩阵/ 犃/ 作为/ 散布/ 矩阵/ ,/ 经过/ 一些/ 列/ 初等/ 变化/ 后/ ,/ 犃/ =/ [/ I/ |/ P/ ]/ ./ 生成/ 挑战/ 密钥/ kchal/ 和/ 置换/ 密钥/ KPRP/ (/ 2/ )/ 生成/ 编码/ 文件/ :/ G/ =/ F/ ·/ A/ =/ {/ G1/ ,/ …/ ,/ Gm/ ,/ Gm/ +/ 1/ ,/ …/ ,/ Gn/ }/ ,/ 其中/ Gj/ =/ (/ gjGn/ }/ 为/ 冗余/ 信息/ 个/ 验证/ 元/ 数据/ ,/ 每个/ 标签/ i/ 由下式/ 计算/ 得来/ :/ (/ 3/ )/ 生成/ 验证/ 元/ 数据/ :/ 为/ 每个/ 服务器/ j/ ∈/ [/ 1/ ,/ …/ ,/ n/ ]/ ,/ 预先/ 生成/ t/ 其中/ ,/ α/ i/ =/ fkchal/ (/ i/ )/ ,/ kiprp/ ←/ KPRP/ (/ 4/ )/ 屏蔽/ 冗余/ 信息/ {/ Gm/ +/ 1/ ,/ …/ ,/ Gn/ }/ :/ gj/ (/ 5/ )/ 将/ G/ 存入/ 云中/ 服务器/ ,/ 本地/ 保存/ 和/ 认证/ 元/ 数据/ {/ vjChallenge/ 阶段/ :/ (/ 1/ )/ 验证/ 者/ 重新/ 生成/ α/ i/ =/ fkchal/ (/ i/ )/ ,/ kin/ ,/ 1/ / i/ / t/ 和/ P/ 云/ 服务器/ (/ 2/ )/ 服务器/ 计算/ 响应/ 集合/ :/ {/ Rjn/ }/ ,/ 并/ 将/ 其/ 返回/ 给/ 验证/ 者/ (/ 3/ )/ 接收/ 到/ 响应/ 集合/ 后/ ,/ 去除/ 冗余/ 信息/ 的/ 屏蔽/ 值/ Rj/ ←/ Rj/ -/ ∑/ rq/ =/ 1/ 下式/ 是否/ 成立/ :/ 已损坏/ (/ 4/ )/ 不/ 成立/ ,/ 继续/ 比较/ :/ Rj/ 动态/ 更新/ 操作/ :/ F/ =/ (/ Δ/ F1/ ,/ Δ/ F2/ ,/ …/ ,/ Δ/ Fm/ )/ ,/ 用/ Δ/ Fi/ 表示/ 数据/ 内容/ 发生变化/ 的/ 块/ ,/ 当/ 数据/ 没有/ 改变/ 时/ ,/ Δ/ Fi/ =/ 0/ ./ 根据/ 初始化/ 阶段/ 的/ 第/ 2/ ~/ 4/ 步/ ,/ 重新/ 生成/ 已/ 发生变化/ 验证/ 元/ 数据/ Δ/ vj/ 对于/ 删除/ 操作/ ,/ 令/ Δ/ Fi/ =/ -/ Fi/ ./ 该/ 机制/ 不能/ 支持/ 插入/ 操作/ ./ 4.2/ ./ 4POR/ 机制/ 小结/ 表/ 2/ 对/ 4.2/ 节中/ 的/ 4/ 种/ POR/ 机制/ 进行/ 了/ 对比/ ,/ 从表中/ 可/ 看出/ ,/ 支持/ 全/ 动态/ 操作/ 仍/ 是/ POR/ 机制/ 所/ 面临/ 的/ 最大/ 挑战/ ./ (/ 1/ )/ 采用/ 多/ 分支/ 路径/ 的/ 方法/ 确保/ 数据完整性/ 云/ 存储/ 环境/ 下/ 具体/ 应用/ 不再/ 只/ 局限于/ 数据/ 存储/ 和/ 数据备份/ ,/ 更/ 多/ 的/ 是/ 面向/ 动态/ 的/ 服务/ 部署/ ,/ 如何/ 有效/ 地/ 确保/ 动态/ 环境/ 下/ 数据完整性/ ,/ 将/ 直接/ 影响/ 用户/ 对云/ 存储/ 的/ 体验/ 和/ 云/ 服务提供商/ 的/ 信用/ ./ 文献/ [/ 24/ ]/ 考虑/ 直接/ 在/ 文献/ [/ 9/ ]/ 提出/ 的/ 静态/ 数据完整性/ 证明/ 机/ Page12/ 制上/ 做/ 一定/ 程度/ 的/ 修改/ ,/ 使/ 其/ 支持/ 动态数据/ 的/ 完整性/ 证明/ ,/ 但/ 不能/ 支持/ 全部/ 的/ 动态/ 操作/ ,/ 如/ 数据/ 插入/ 等/ ./ 之后/ ,/ 文献/ [/ 10/ ,/ 14/ ]/ 采用/ 树形/ 的/ 数据结构/ 来/ 重新/ 组织/ 数据/ ,/ 通过/ 增加/ 访存/ 复杂度/ 来/ 获取/ 全/ 动态/ 的/ 支持/ ,/ 但/ 存在/ 认证/ 路径/ 过程/ 和/ 认证/ 路径/ 所/ 需/ 的/ 辅助/ 信息/ 过多/ 等/ 缺陷/ ./ 如图/ 13/ 所示/ ,/ 可以/ 采用/ 多/ 分支/ 路径/ 代替/ 二叉树/ ,/ 减少/ 节点/ 的/ 认证/ 路径/ ;/ 同时/ ,/ 采用/ 认证/ 路径/ 所/ 特有/ 的/ 信息/ 作为/ 认证/ 路径/ ,/ 减少/ 认证/ 路径/ 的/ 辅助/ 信息/ ,/ 提高/ 了/ 认证/ 效率/ 并/ 减少/ 了/ 通信/ 开销/ [/ 32/ ]/ ./ (/ 2/ )/ 保护/ 用户/ 数据/ 隐私/ 的/ 数据完整性/ 验证/ 机制/ 云/ 存储/ 环境/ 下/ 的/ 数据完整性/ 验证/ 更/ 多/ 的/ 是/ 采用/ 轻量级/ 的/ 数据完整性/ 验证/ 机制/ ,/ 用来/ 支持/ 泛/ 在/ 接入/ 和/ 移动/ 计算/ ./ 轻量级/ 的/ 数据完整性/ 验证/ 机制/ 更/ 多/ 的/ 是/ 采用/ 公开/ 的/ 数据完整性/ 证明/ ,/ 用户/ 将/ 数据完整性/ 的/ 验证/ 任务/ 移交/ 给/ 第三方/ 审计/ 方来/ 完成/ ,/ 从而/ 大大的/ 减轻/ 了/ 用户/ 在/ 存储/ 和/ 计算/ 上/ 所/ 需要/ 的/ 开销/ ./ 采用/ 文献/ [/ 15/ ]/ 的/ 方法/ 虽/ 可以/ 确保/ 数据/ 的/ 隐私/ ,/ 但/ 对于/ POR/ 机制/ 而言/ ,/ 采用/ 这种/ 方法/ 将/ 使得/ 验证/ 者/ 无法/ 再/ 通过/ 抽取/ 器去/ 恢复/ 损坏/ 的/ 原文件/ ./ 如何/ 设计/ 一种/ 既/ 能/ 保护/ 用户/ 数据/ 隐私/ 又/ 能/ 支持/ 抽取/ 器/ 工作/ 的/ 数据完整性/ 证明/ 机制/ 将/ 成为/ 一个/ 有/ 意义/ 的/ 研究/ 方向/ ./ (/ 3/ )/ 适合/ 云/ 存储/ 更/ 高效/ 的/ 数据/ 可/ 恢复/ 证明/ 机制/ 云/ 平台/ 存储/ 的/ 数据/ 通常/ 是/ 大规模/ 数据/ ,/ 为/ 其/ 设计/ 的/ 数据完整性/ 验证/ 机制/ 都/ 是/ 基于/ 抽样/ 的/ 策略/ ,/ 当/ 数据/ 发生/ 位/ 偏转/ 时/ ,/ 用户/ 或/ 可信/ 第三方/ 可能/ 无法/ 及时/ 的/ 发现/ 该/ 小/ 概率/ 事件/ ,/ 如何/ 有效/ 地/ 确保/ 云/ 环境/ 下/ 数据/ 的/ 可/ 恢复性/ 将/ 需要/ 我们/ 需要/ 深入/ 的/ 研究/ ./ 文献/ [/ 16/ -/ 17/ ]/ 提到/ 的/ 采用/ 经典/ (/ n/ ,/ k/ ,/ d/ )/ Reed/ -/ Solomon/ 纠错码/ 技术/ [/ 33/ ]/ 在/ 大规模/ 的/ 数据/ 集下/ 并/ 不/ 可行/ ,/ 需要/ 设计/ 更加/ 高效/ 、/ 合理/ 的/ 适合/ 云/ 存储/ 的/ 数据完整性/ 证明/ 机制/ ,/ 而/ 目前/ 在/ 这方面/ 的/ 研究/ 还/ 相对/ 较少/ ./ (/ 4/ )/ 多/ 副本/ 动态/ 数据完整性/ 验证/ 机制/ 由于/ 云/ 存储/ 可以/ 为/ 用户/ 提供/ 廉价/ 的/ 存储空间/ ,/ 更/ 多/ 的/ 用户/ 喜欢/ 采用/ 多/ 副本/ 方式/ 存储/ 数据/ ./ 如何/ 确保/ 云/ 服务提供商/ 确实/ 按/ 用户/ 所/ 要求/ 的/ 副本/ 数目/ 对原/ 数据/ 进行/ 备份/ ,/ 将/ 是/ 未来/ 需要/ 考虑/ 的/ 一个/ 问题/ ,/ 存储/ 在/ 云中/ 的/ 多个/ 数据/ 副本/ 信息/ 完全/ 一样/ ,/ 采用/ 原有/ 的/ 数据完整性/ 验证/ 机制/ 将/ 无法/ 区分/ 各个/ 副本/ ,/ 目前/ 最为/ 常用/ 的/ 方法/ ,/ 是/ 采用/ 文献/ [/ 13/ ]/ 所/ 提到/ 的/ 方法/ ,/ 用户/ 在外/ 包/ 数据/ 之前/ ,/ 预先/ 生成/ 所/ 需要/ 的/ 数据/ 副本/ ,/ 然后/ 为/ 每个/ 数据/ 副本/ 引入/ 随机数/ 加以/ 区分/ 存入/ 云中/ ,/ 但/ 该/ 方法/ 只能/ 确认/ 云/ 服务提供商/ 自身/ 所/ 提供/ 的/ 存储/ 服务/ 确实/ 符合/ SLAs/ 协议/ ./ 另外/ ,/ 在/ 确保/ 数据完整性/ 的/ 情况/ 下/ ,/ 如何/ 同时/ 对/ 多个/ 数据/ 副本/ 进行/ 动态/ 操作/ 也/ 将/ 是/ 值得/ 研究/ 的/ 问题/ ./ (/ 5/ )/ 跨云/ 动态/ 数据完整性/ 证明/ 机制/ 用户/ 可能/ 为了/ 提高/ 数据/ 的/ 可用性/ 和/ 可靠性/ ,/ 从而/ 选择/ 多个/ 云/ 服务提供商/ 来/ 存储/ 数据/ 或/ 部署/ 应用/ ,/ 如何/ 确保/ 多个/ 云/ 服务提供商/ 所/ 存储/ 的/ 数据/ 是/ 完整/ 的/ ,/ 也/ 将/ 是/ 值得/ 深入研究/ 的/ 问题/ ./ 文献/ [/ 34/ -/ 36/ ]/ 对/ 跨云/ 数据完整性/ 证明/ 机制/ 进行/ 建模/ ,/ 但/ 并/ 没有/ 详细/ 的/ 实现/ 步骤/ ,/ 仅仅只是/ 定义/ 了/ 模型/ ,/ 需要/ 设计/ 一种/ 可/ 部署/ 到/ 具体/ 实际/ 应用/ 中/ 的/ 跨云/ 数据完整性/ 证明/ 机制/ ,/ 该/ 机制/ 可以/ 很/ 好/ 地/ 支持/ 数据/ 动态/ 操作/ ,/ 以/ 满足/ 更/ 多/ 的/ 应用/ ./ 6/ 结束语/ 云/ 存储/ 环境/ 下/ 数据完整性/ 验证/ 问题/ 的/ 研究/ 是/ 一个/ 非常/ 活跃/ 的/ 方向/ ./ 从/ 整体/ 上/ 讲/ ,/ 目前/ 云/ 存储/ 数据完整性/ 验证/ 方面/ 的/ 研究/ 还/ 不/ 成熟/ ,/ 尚未/ 建立/ 起/ 一套/ 完整/ 的/ 理论体系/ ,/ 而且/ 从/ 技术/ 理论/ 的/ 完善/ 到/ 算法/ 的/ 具体/ 应用/ 还有/ 很大/ 的/ 差距/ ./ 本文/ 首先/ 回顾/ 了/ 近年来/ 学术界/ 在/ 数据完整性/ 证明/ 研究/ 领域/ 的/ 主要/ 成果/ ,/ 对/ 其/ 进行/ 详细/ 的/ 分类/ 归纳/ ,/ 之后/ ,/ 详细/ 介绍/ 了/ 各种/ 面向/ 不同/ 应用/ 的/ 验证/ 机制/ 的/ 实现/ 原理/ 并/ 加以/ 对比/ ,/ 最后/ 通过/ 分析/ 现有/ 研究/ 指明/ 了/ 未来/ 研究/ 的/ 趋势/ ./ 致谢/ 在/ 此/ ,/ 我们/ 向/ 对/ 本文/ 的/ 工作/ 给予/ 支持/ 和/ 建议/ 的/ 同行/ ,/ 尤其/ 是/ 国防科技大学/ 计算机/ 学院/ 软件/ 所/ 681/ 教研室/ 的/ 老师/ 和/ 同学/ 表示感谢/ !/ Page13/ 

