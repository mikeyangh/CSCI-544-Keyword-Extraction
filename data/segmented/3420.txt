Page1/ 安全/ 协议/ 逻辑程序/ 不/ 停机/ 性/ 快速/ 预测/ 的/ 动态/ 方法/ 周倜/ 1/ )/ ,/ 2/ )/ 李梦君/ 1/ )/ 李舟军/ 3/ )/ 1/ )/ (/ 国防科学技术大学/ 计算机/ 学院/ 长沙/ 410073/ )/ 2/ )/ (/ 北京航天/ 飞行/ 控制中心/ 软件/ 室/ 北京/ 100094/ )/ 3/ )/ (/ 北京航空航天大学/ 计算机/ 学院/ 北京/ 100083/ )/ 摘要/ 基于/ 一般/ 逻辑程序/ 停机/ 性/ 刻画/ 的/ 动态/ 方法/ ,/ 研究/ 了解/ 形式/ 不动点/ 不/ 停机/ 的/ 一种/ 动态/ 刻画/ 方法/ ,/ 给出/ 了/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 不/ 停机/ 性/ 的/ 一个/ 充分条件/ ./ 基于/ 这个/ 充分条件/ 给出/ 了/ 一种/ 不动点/ 计算/ 不/ 终止/ 的/ 预测/ 方法/ ,/ 该/ 方法/ 能够/ 根据/ 新/ 产生/ 的/ 解/ 形式逻辑/ 规则/ ,/ 预测/ 不动点/ 计算/ 的/ 不/ 终止/ 性/ ,/ 同时/ 定位/ 模型/ 中/ 导致/ 解/ 形式/ 不动点/ 无穷/ 计算/ 的/ 解/ 形式逻辑/ 规则/ ./ 解/ 形式/ 不动点/ 不/ 停机/ 性/ 的/ 预测/ 结果/ 将/ 作为/ 选择/ 精确/ 验证/ 方法/ 或者/ 抽象/ 验证/ 方法/ 验证/ 安全/ 协议/ 的/ 基本/ 依据/ ./ 相关/ 实验/ 结果表明/ 文中/ 给出/ 的/ 预测/ 算法/ 是/ 高效/ 的/ ./ 关键词/ 安全/ 协议/ ;/ 验证/ ;/ 不动点/ 计算/ ;/ 不/ 停机/ 性/ ;/ 预测/ 1/ 引言/ 基于/ 逻辑程序/ 的/ 安全/ 协议/ 验证/ 方法/ [/ 1/ -/ 5/ ]/ 能够/ 高/ Page2/ 方法/ 不/ 保证/ 验证/ 过程/ 的/ 停机/ 性/ ./ 例如/ ,/ 对于/ Need/ -/ ham/ -/ Schroeder/ 共享/ 密钥/ 协议/ 、/ Woo/ -/ Lam/ 共享/ 密钥/ 单向/ 认证/ 协议/ 的/ 版本/ II3/ 等/ ,/ 基于/ 逻辑程序/ 的/ 安全/ 协议/ 验证/ 方法/ 的/ 验证/ 过程/ 都/ 不/ 停机/ [/ 5/ ]/ ./ 抽象/ 解释/ 理论/ [/ 7/ -/ 10/ ]/ 是/ Cousot/ 等/ 人于/ 1977/ 年/ 提出/ 的/ 构造/ 和/ 逼近/ 程序/ 不动点/ 语义/ 的/ 理论/ ,/ 它/ 为/ 计算机科学/ 中/ 的/ 不可判定/ 问题/ 和/ 复杂/ 问题/ 的/ 逼近/ 求解/ 提供/ 了/ 系统性/ 的/ 构造方法/ 和/ 有效/ 算法/ ./ 抽象/ 解释/ 本质/ 上/ 是/ 在/ 计算/ 效率/ 和/ 计算精度/ 之间/ 取得/ 均衡/ ,/ 以/ 损失/ 计算精度/ 求得/ 计算/ 可行性/ ,/ 再/ 通过/ 迭代/ 计算/ 增强/ 计算精度/ 的/ 一种/ 逼近/ 方法/ ./ 基于/ 抽象/ 解释/ 理论/ ,/ 文献/ [/ 11/ ]/ 提出/ 了/ 一个/ 停机/ 的/ 安全/ 协议/ 抽象/ 验证/ 过程/ ,/ 该/ 抽象/ 验证/ 过程/ 基于/ 变种/ depth/ (/ k/ )/ 抽象/ 域/ [/ 12/ ]/ 对/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 进行/ 可靠/ 的/ 抽象/ 逼近/ (/ 抽象/ 不动点/ 是/ 解/ 形式/ 不动点/ 的/ 上界/ 逼近/ )/ ./ 基于/ 逻辑程序/ 的/ 安全/ 协议/ 验证/ 方法/ 和/ 抽象/ 验证/ 方法/ 各有利弊/ ,/ 一方面/ ,/ 基于/ 逻辑程序/ 的/ 安全/ 协议/ 验证/ 方法/ 不能/ 保证/ 验证/ 过程/ 停机/ ,/ 但是/ 该/ 方法/ 对于/ 多数/ 安全/ 协议/ 是/ 停机/ 的/ ,/ 验证/ 过程/ 不/ 需要/ 迭代/ 精化/ 计算/ ;/ 另一方面/ ,/ 抽象/ 验证/ 方法/ 保证/ 验证/ 过程/ 停机/ ,/ 但是/ 它/ 基于/ 抽象/ 和/ 精化/ 的/ 迭代/ 验证/ 过程/ ,/ 在/ 多次/ 迭代/ 计算/ 后/ 才/ 能够/ 验证/ 安全/ 协议/ 正确/ 或者/ 构造/ 出/ 反例/ ,/ 对于/ 解/ 形式/ 不动点/ 停机/ 的/ 安全/ 协议/ ,/ 它们/ 的/ 抽象/ 验证/ 过程/ 也/ 是/ 基于/ 抽象/ 和/ 精化/ 的/ 迭代/ 验证/ 过程/ ,/ 而且/ 为了/ 构造/ 出/ 反例/ ,/ 必须/ 用/ 未/ 被/ 抽象/ 的/ 规则/ 再/ 验证/ 一次/ 安全/ 性质/ ./ 为了/ 充分发挥/ 两种/ 验证/ 方法/ 的/ 优势/ 并/ 克服/ 它们/ 各自/ 的/ 不足/ ,/ 在/ 实际/ 验证/ 过程/ 中/ 可以/ 综合/ 两种/ 验证/ 方法/ 以/ 提高/ 验证/ 效率/ ,/ 即/ 对于/ 解/ 形式/ 不动点/ 停机/ 的/ 安全/ 协议/ 使用/ 基于/ 逻辑程序/ 的/ 协议/ 验证/ 方法/ ,/ 对于/ 解/ 形式/ 不动点/ 计算/ 过程/ 不/ 停机/ 的/ 安全/ 协议/ 使用/ 抽象/ 验证/ 方法/ ,/ 解/ 形式/ 不动点/ 计算/ 过程/ 的/ 停机/ 性是/ 选择/ 验证/ 方法/ 的/ 基本/ 依据/ ./ 因而/ ,/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 的/ 停机/ 性/ 预测/ 是/ 一项/ 重要/ 的/ 研究/ 工作/ ./ 本文/ 借鉴/ 了/ 一般/ 逻辑程序/ 停机/ 性/ 刻画/ 的/ 动态/ 方法/ [/ 13/ ]/ ,/ 给出/ 了/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ [/ 14/ -/ 15/ ]/ 解/ 形式/ 不动点/ 计算/ 不/ 终止/ 的/ 一个/ 充分条件/ ,/ 根据/ 这个/ 条件/ 给出/ 了/ 不/ 停机/ 性/ 判定/ 的/ 一个/ 简单/ 有效/ 的/ 预测/ 算法/ ./ 一般/ 逻辑程序/ 停机/ 性/ 刻画/ 的/ 静态方法/ 借助于/ 逻辑/ 规则/ 原子公式/ 中项/ 的/ 大小/ 以及/ 其它/ 的/ 一些/ 静态/ 信息/ 刻画/ 停机/ 性/ ,/ 而/ 动态/ 方法/ 借助于/ 逻辑/ 推导/ 树结构/ 中/ 的/ 相关/ 动态/ 信息/ 刻画/ 停机/ 性/ [/ 13/ ]/ ./ 文献/ [/ 13/ ]/ 中/ 目标/ 关于/ 一般/ 逻辑程序/ 的/ 推导/ 问题/ 采用/ 了/ SLDNF/ -/ 推理方法/ ,/ 基于/ 广义/ 的/ SLDNF/ -/ 树/ 给出/ 了/ 一个/ 目标/ 关于/ 一般/ 逻辑程序/ 的/ 推导/ 过程/ 停机/ 性/ 刻画/ 的/ 动态/ 方法/ ./ 本文/ 基于/ 解/ 形式/ 不动点/ 计算/ 过程/ 的/ 特点/ ,/ 给出/ 了解/ 形式/ 不动点/ 停机/ 性/ 的/ 预测/ 算法/ ./ 与/ 文献/ [/ 13/ ]/ 中/ 的/ 停机/ 性/ 刻画/ 方法/ 相/ 比较/ ,/ 本文/ 的/ 方法/ 能够/ 定位/ 模型/ 中/ 导致/ 解/ 形式/ 不动点/ 无穷/ 计算/ 的/ 逻辑/ 规则/ ,/ 并且/ 使得/ 本文/ 的/ 停机/ 性/ 预测/ 算法/ 更加/ 精确/ ,/ 也/ 具有/ 更/ 高/ 的/ 计算/ 效率/ ./ 文献/ [/ 13/ ]/ 中/ 的/ 停机/ 性/ 刻画/ 的/ 动态/ 方法/ 用于/ 判定/ 一个/ 目标/ 关于/ 一般/ 逻辑程序/ 推导/ 过程/ 的/ 停机/ 性/ ,/ 本文/ 停机/ 性/ 预测/ 方法/ 用于/ 判定/ 解/ 形式/ 不动点/ 的/ 停机/ 性/ ,/ 解/ 形式/ 不动点/ 停机/ 性/ 的/ 预测/ 结果/ 将/ 作为/ 选择/ 安全/ 协议/ 验证/ 方法/ 的/ 基本/ 依据/ ./ 为了/ 解决/ 文献/ [/ 16/ ]/ 中/ 的/ 一些/ 可/ 导致/ 不动点/ 计算/ 不/ 停机/ 的/ 协议/ 的/ 验证/ 问题/ ,/ 文献/ [/ 17/ ]/ 给出/ 了/ 通过/ 静态/ 语法/ 检查/ 给/ 存在/ 形/ 如/ “/ …/ P/ (/ f/ (/ x/ )/ )/ …/ →/ P/ (/ f/ (/ g/ (/ x/ )/ )/ )/ ”/ 的/ 规则/ 前后/ 件/ 原子公式/ 加/ 标记/ 的/ 方法/ 防止/ 不/ 停机/ 情况/ 的/ 出现/ ./ 这种/ 方法/ 依赖于/ 人/ 的/ 主观/ 认识/ ,/ 并且/ 如果/ 模型/ 中/ 没有/ 这样/ 的/ 结构/ ,/ 则/ 文献/ [/ 17/ ]/ 不会/ 做/ 保证/ 计算/ 终止/ 的/ 处理/ ./ 同时/ ,/ 由于/ 在/ 安全/ 协议/ 逻辑/ 模型/ 中/ 存在/ 以/ P/ (/ f/ (/ x/ )/ )/ 的/ 实例/ 为/ 逻辑/ 后件/ 的/ 规则/ ,/ 该/ 规则/ 表示/ 协议/ 运行/ 时有/ 某个/ 主体/ 发出/ 了/ P/ (/ f/ (/ x/ )/ )/ θ/ 的/ 实例/ 所/ 描述/ 的/ 动作/ ,/ 由该/ 规则/ 与/ 形如/ “/ …/ P/ (/ f/ (/ x/ )/ )/ …/ →/ P/ (/ f/ (/ g/ (/ x/ )/ )/ )/ ”/ 的/ 规则/ 进行/ 消解/ ,/ 得到/ 以/ P/ (/ f/ (/ g/ (/ x/ )/ )/ 的/ 实例/ 为/ 逻辑/ 后件/ 的/ 规则/ ,/ 新/ 规则/ 又/ 可/ 与/ 形如/ “/ …/ P/ (/ f/ (/ x/ )/ )/ …/ →/ P/ (/ f/ (/ g/ (/ x/ )/ )/ )/ ”/ 的/ 规则/ 进行/ 消解/ ,/ …/ …/ 这样/ 的/ 行为/ 循环往复/ ,/ 从而/ 造成/ 不动点/ 计算/ 不/ 终止/ 的/ 情况/ ./ 而/ 正则/ 逻辑程序/ 中/ 产生/ 的/ 规则/ 不/ 一定/ 会/ 存在/ 此种/ 形式/ ,/ 所以/ 该/ 方法/ 只/ 针对/ 安全/ 协议/ 的/ 逻辑程序/ ,/ 对/ 一般/ 逻辑程序/ 则/ 难于/ 用此/ 方法/ 消除/ 不/ 停机/ 性/ ./ 本文/ 通过/ 研究/ 安全/ 协议/ 不/ 停机/ 的/ 动态/ 特性/ ,/ 给出/ 了/ 一种/ 动态/ 刻画/ 方法/ ./ 根据/ 逻辑程序/ 本身/ 存在/ 的/ 不/ 停机/ 特征/ ,/ 该/ 方法/ 在/ 协议/ 验证/ 过程/ 中/ 给出/ 协议/ 验证/ 的/ 不/ 停机/ 预测/ ./ 动态/ 预测/ 算法/ 独立/ 于/ 人/ 的/ 主观/ 意识/ ,/ 在/ 验证/ 过程/ 中/ 动态/ 的/ 检测/ 新/ 生成/ 的/ 规则/ ,/ 对/ 不动点/ 计算/ 是否/ 停机/ 做出/ 一定/ 的/ 预测/ ./ 事实上/ ,/ 文献/ [/ 17/ ]/ 用/ 静态/ 语法/ 检查/ 发现/ 的/ 不/ 停机/ 性/ 只是/ 一种/ 特殊/ 情况/ ,/ 而/ 本文/ 给出/ 的/ 预测/ 方法/ 完全/ 包含/ 了/ 这种/ 特例/ ./ 同时/ ,/ 由于/ 本文/ 给出/ 的/ 动态/ 预测/ 算法/ 是/ 独立/ 于/ 安全/ 协议/ 模型/ 、/ 根据/ 不动点/ 计算/ 出/ 的/ 规则/ 特征/ 而/ 进行/ 不/ 终止/ 预测/ 的/ ,/ 因此/ 该/ 预测/ 方法/ 不仅/ 适用/ 安全/ 协议/ 逻辑程序/ 的/ 不/ 停机/ 预测/ ,/ 也/ 可/ 用于/ 正则/ 逻辑程序/ 的/ 不/ 停机/ 预测/ ,/ 为/ 是否/ 选择/ 抽象/ 验证/ 以及/ 如何/ 进行/ 局部/ 抽象/ 验证/ 提供/ 理论依据/ ./ 首先/ 可/ 采用/ 文献/ [/ 14/ -/ 15/ ]/ 提出/ 的/ 协议/ 验证/ 方法/ 进行/ 不动点/ 计算/ ,/ 每次/ 迭代/ 计算/ 结束/ 时/ 采用/ 本文/ 给出/ 不/ 停机/ 性/ 预测/ 算法/ 进行/ 不/ 停机/ 性/ Page3/ 预测/ ./ 如果/ 预测/ 不动点/ 计算/ 不/ 终止/ ,/ 则/ 启动/ 文献/ [/ 11/ ]/ 中/ 的/ 抽象/ 验证/ 算法/ ,/ 否则/ 继续/ 进行/ 迭代/ 计算/ 与/ 预测/ 过程/ ,/ 直到/ 得到/ 验证/ 结果/ 或/ 发现/ 计算/ 不/ 终止/ 的/ 证据/ 为止/ ./ 由于/ 本文/ 给出/ 的/ 预测/ 算法/ 还/ 能/ 精确定位/ 导致/ 不/ 终止/ 计算/ 的/ 规则/ ,/ 因此/ 还/ 可以/ 进行/ 局部/ 抽象/ 验证/ [/ 18/ ]/ ,/ 即/ 只/ 对/ 逻辑程序/ 中/ 导致/ 不动点/ 计算/ 不/ 终止/ 的/ 规则/ 进行/ 抽象/ ,/ 而/ 其它/ 规则/ 仍然/ 按/ 精确/ 验证/ 的/ 方法/ 进行/ 消解/ ./ 局部/ 抽象/ 验证/ 可以/ 有效/ 地/ 减少/ 抽象/ -/ 精化/ 迭代/ 的/ 次数/ ,/ 节省/ 总/ 的/ 验证/ 时间/ ./ 本文/ 第/ 2/ 节/ 描述/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ;/ 第/ 3/ 节/ 描述/ 安全/ 性质/ 的/ 验证/ 方法/ ,/ 它们/ 是/ 基于/ 逻辑程序/ 的/ 安全/ 协议/ 验证/ 方法/ 中/ 协议/ 模型/ 以及/ 验证/ 方法/ 的/ 变型/ ;/ 第/ 4/ 节/ 研究/ 协议/ 验证/ 过程/ 的/ 动态/ 特性/ ,/ 并/ 给出/ 解/ 形式/ 不动点/ 不/ 停机/ 性/ 的/ 预测/ 算法/ ;/ 第/ 5/ 节/ 采用/ 不/ 停机/ 性/ 预测/ 算法/ ,/ 对/ 典型/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 的/ 停机/ 性/ 进行/ 预测/ ,/ 实验/ 结果表明/ 预测/ 算法/ 的/ 有效性/ ;/ 第/ 6/ 节对/ 本文/ 内容/ 进行/ 小结/ ,/ 阐述/ 进一步/ 的/ 研究/ 工作/ ./ 2/ 安全/ 协议/ 基于/ Horn/ 逻辑/ 的/ 扩展/ 模型/ 安全/ 协议/ 基于/ Horn/ 逻辑/ 扩展/ 模型/ 的/ 语法/ 描述/ 如表/ 1/ 所示/ ./ 在/ Horn/ 逻辑/ 扩展/ 模型/ 语法/ 中/ ,/ 如果/ 原子公式/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 、/ begin/ (/ M/ ,/ M/ )/ 、/ end/ (/ M/ ,/ M/ )/ 中/ 的/ 项/ M/ 中/ 没有/ 变量/ ,/ 则/ 称/ 它们/ 为闭/ 原子公式/ ./ 原子公式/ begin/ (/ M/ ,/ M/ )/ 和/ end/ (/ M/ ,/ M/ )/ 是/ 对应性/ 断言/ 序偶/ ,/ 用于/ 描述/ 认证/ 性/ ,/ 其中/ M/ 是/ 对应性/ 断言/ 标识符/ ./ 严格/ 按照/ 协议/ 描述/ 进行/ 消息/ 交换/ 和/ 消息/ 处理/ 的/ 角色/ 称为/ 诚实/ 角色/ ,/ 除了/ 安全/ 协议/ 攻击者/ 之外/ 的/ 所有/ 角色/ 都/ 是/ 诚实/ 角色/ ;/ 安全/ 协议/ 攻击者/ 在/ 安全/ 协议/ 形式化/ 分析/ 中/ 扮演/ 两种/ 角色/ :/ 其一/ 是/ 诚实/ 角色/ ,/ 其二/ 是/ 攻击者/ 角色/ ,/ 扮演/ 攻击者/ 角色/ 表达式/ tag/ ∷/ =/ 0/ ,/ 1/ ,/ 2/ ,/ …/ M/ ,/ N/ ,/ U/ ,/ V/ ,/ S/ ,/ T/ ∷/ =/ x/ ,/ y/ ,/ za/ [/ M1/ ,/ …/ ,/ Mn/ ]/ f/ (/ M1/ ,/ …/ ,/ Mn/ )/ F/ ,/ C/ ,/ A/ ∷/ =/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ attacker/ 谓词/ begin/ (/ M/ ,/ M/ )/ End/ (/ M/ ,/ M/ )/ R/ ,/ R/ ∷/ =/ F1/ ∧/ …/ ∧/ Fn/ →/ F/ 时/ 进行/ 消息/ 处理/ 和/ 消息/ 交换/ 的/ 行为/ 由/ Dolev/ -/ Yao/ 模型/ 刻画/ ./ 2.1/ 安全/ 协议/ 诚实/ 角色/ 模型/ 对应/ 于/ 安全/ 协议/ 描述/ 中/ 每/ 一个/ 诚实/ 角色/ A/ 的/ 每/ 一个/ 消息/ 发送/ 动作/ ,/ 假设/ 发送/ 的/ 消息/ 为/ M/ ,/ 则/ 生成/ 一条/ 逻辑/ 规则/ :/ attacker/ (/ role/ (/ 〈/ M1/ ,/ A/ ,/ k/ 〉/ ,/ M1/ )/ )/ ∧/ …/ ∧/ attacker/ (/ role/ (/ 〈/ Mn/ ,/ A/ ,/ k/ 〉/ ,/ Mn/ )/ )/ →/ attacker/ (/ role/ (/ 〈/ A/ ,/ N/ ,/ k/ 〉/ ,/ M/ )/ )/ ;/ 其中/ ,/ 根据/ 安全/ 协议/ 描述/ 的/ 上下文/ ,/ A/ 认为/ 消息/ M/ 的/ 接收者/ 为/ N/ (/ 理想/ 接收者/ )/ ,/ M1/ ,/ …/ ,/ Mn/ 是/ A/ 在/ 发送/ 消息/ M/ 之前/ 应该/ 依次/ 接收/ 到/ 的/ 消息/ 序列/ ,/ 并且/ 根据/ 安全/ 协议/ 描述/ 的/ 上下文/ ,/ A/ 认为/ 消息/ Mi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 的/ 发送者/ (/ 理想/ 发送者/ )/ 为/ Mi/ ./ 安全/ 协议/ 描述/ 中/ A/ 生成/ 的/ 每/ 一个/ 新鲜/ 值/ (/ nonce/ )/ 和/ 新鲜/ 加密/ 密钥/ (/ freshencryptionkey/ )/ 都/ 被/ Skolem/ 化为/ 一个/ 同名/ 的/ Skolem/ 函数/ ,/ Skolem/ 函数/ 的/ 参数/ 包括/ :/ 一个/ 会话/ 标识符/ 变量/ ,/ A/ 生成/ 新鲜/ 值/ 或/ 新鲜/ 加密/ 密钥/ 之前/ 应该/ 依次/ 接收/ 到/ 的/ 消息/ 序列/ ,/ k/ 表示/ 该/ 规则/ 是/ 加入/ 到/ 诚实/ 角色/ 模型/ 中/ 的/ 第/ k/ 条/ 规则/ ./ 在/ 诚实/ 角色/ 模型/ 中/ ,/ 逻辑/ 规则/ 前件/ 中形/ 如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 的/ 原子公式/ 中/ tag/ 的/ 取值/ 均/ 为/ 大于/ 0/ 的/ 整数/ ,/ 以/ 方便/ 定位/ 基于/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 导致/ 解/ 形式/ 不动点/ 计算/ 过程/ 出现/ 无穷/ 计算/ 的/ 逻辑/ 规则/ ./ 2.2/ 安全/ 协议/ 攻击者/ 模型/ 攻击者/ 进行/ 消息/ 处理/ 和/ 消息/ 交换/ 的/ 行为/ 由/ Dolev/ -/ Yao/ 模型/ 刻画/ ,/ 描述/ 为/ 以下/ 的/ 一组/ 逻辑/ 规则/ :/ (/ 1/ )/ 设/ S/ 表示/ 安全/ 协议/ 的/ 公共/ 知识/ 集合/ ,/ 对/ 每/ 一个/ M/ ∈/ S/ ,/ 生成/ 如下/ 的/ 一条/ 逻辑/ 规则/ :/ →/ attacker/ (/ role/ (/ 〈/ host/ (/ kI/ [/ ]/ )/ ,/ host/ (/ v/ )/ ,/ n/ 〉/ ,/ M/ )/ )/ ;/ 它/ 表示/ 的/ 含义/ 是/ :/ 攻击者/ 能够/ 向/ 任何/ 参与者/ 发送/ 属于/ 公共/ 知识/ 集合/ 的/ 消息/ M/ ./ (/ 2/ )/ 攻击者/ 具有/ 生成/ 新鲜/ 值/ 的/ 能力/ ,/ 用/ 下面/ 的/ 一条/ 逻辑/ 规则/ 刻画/ :/ →/ attacker/ (/ role/ (/ 〈/ host/ (/ kI/ [/ ]/ )/ ,/ host/ (/ v/ )/ ,/ n/ 〉/ ,/ NI/ [/ i/ ]/ )/ )/ ;/ 攻击者/ 生成/ 的/ 新鲜/ 值/ 被/ Skolem/ 化为/ Skolem/ 函数/ NI/ [/ i/ ]/ ,/ 其中/ i/ 是/ 自然数/ 集合/ 上/ 的/ 变量/ ,/ 上述/ 逻辑/ 规则/ 的/ 含义/ 是/ :/ 攻击者/ 能够/ 生成/ 无穷/ 多个/ 新鲜/ 值/ ,/ 并/ 能/ 向/ 任何/ 参与者/ 发送/ 生成/ 的/ 新鲜/ 值/ ./ (/ 3/ )/ 对于/ 安全/ 协议/ 中/ 的/ 每/ 一个/ 构造/ 算子/ f/ ,/ 攻击者/ 具有/ 使用/ f/ 构造/ 新/ 消息/ 的/ 能力/ ,/ 用/ 下面/ 的/ 逻辑/ 规则/ 刻画/ :/ attacker/ (/ role/ (/ 〈/ host/ (/ v1/ )/ ,/ host/ (/ kI/ [/ ]/ )/ ,/ n/ 〉/ ,/ x1/ )/ )/ ∧/ …/ ∧/ attacker/ (/ role/ (/ 〈/ host/ (/ vn/ )/ ,/ host/ (/ kI/ [/ ]/ )/ ,/ n/ 〉/ ,/ xn/ )/ )/ →/ attacker/ (/ role/ (/ 〈/ host/ (/ kI/ [/ ]/ )/ ,/ host/ (/ v/ )/ ,/ n/ 〉/ ,/ f/ (/ x1/ ,/ …/ ,/ Page4xn/ )/ )/ )/ ;/ 构造/ 算子/ 包括/ 消息/ 组合/ 算子/ 和/ 加密/ 算子/ 等/ ./ 上述/ 逻辑/ 规则/ 的/ 含义/ 是/ :/ 攻击者/ 能够/ 利用/ 接收/ 到/ 的/ 消息/ 构造/ 新/ 的/ 消息/ ,/ 并/ 能够/ 向/ 任何/ 参与者/ 发送/ 构造/ 的/ 新/ 消息/ ./ (/ 4/ )/ 对于/ 安全/ 协议/ 中/ 的/ 每/ 一个/ 析构/ 算子/ g/ 和/ g/ 的/ 每/ 一个/ 消减/ 式/ g/ (/ M1/ ,/ …/ ,/ Mn/ )/ =/ M/ ,/ 攻击者/ 具有/ 使用/ g/ 析构/ 消息/ 的/ 能力/ ,/ 用/ 下面/ 的/ 一条/ 逻辑/ 规则/ 刻画/ :/ attacker/ (/ role/ (/ 〈/ host/ (/ v1/ )/ ,/ host/ (/ kI/ [/ ]/ )/ ,/ n/ 〉/ ,/ M1/ )/ )/ ∧/ …/ ∧/ attacker/ (/ role/ (/ 〈/ host/ (/ vn/ )/ ,/ host/ (/ kI/ [/ ]/ )/ ,/ n/ 〉/ ,/ Mn/ )/ )/ →/ attacker/ (/ role/ (/ 〈/ host/ (/ kI/ [/ ]/ )/ ,/ host/ (/ v/ )/ ,/ n/ 〉/ ,/ M/ )/ )/ ;/ 析构/ 算子/ 包括/ 消息/ 分解/ 算子/ 和/ 解密/ 算子/ 等/ ./ 上述/ 逻辑/ 规则/ 的/ 含义/ 是/ :/ 攻击者/ 能够/ 析构/ 接收/ 到/ 的/ 消息/ ,/ 得到/ 新/ 消息/ ,/ 并/ 能够/ 向/ 任何/ 参与者/ 发送/ 析构/ 得到/ 的/ 新/ 消息/ ./ 在/ 攻击者/ 模型/ 中/ ,/ tag/ 取值/ 为/ n/ 表示/ 逻辑/ 规则/ 是/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 的/ 第/ n/ 条/ 逻辑/ 规则/ ./ 描述/ 保密性/ 时/ ,/ 扩展/ 模型/ 中/ 不/ 出现/ 原子公式/ begin/ (/ M/ ,/ M/ )/ 和/ end/ (/ M/ ,/ M/ )/ ;/ 描述/ 认证/ 性时/ ,/ begin/ (/ M/ ,/ M/ )/ 只/ 出现/ 在/ 逻辑/ 规则/ 的/ 逻辑/ 前件/ 中/ ,/ end/ (/ M/ ,/ M/ )/ 只/ 出现/ 在/ 逻辑/ 规则/ 的/ 逻辑/ 后件/ 中/ ./ 2.3/ 安全/ 性质/ 描述/ 和/ R2/ =/ H2attacker/ (/ role/ (/ 〈/ M1/ ,/ N1/ ,/ tag1/ 〉/ ,/ M1/ )/ )/ ,/ C2/ =/ attacker/ (/ role/ (/ 〈/ M2/ ,/ N2/ ,/ tag2/ 〉/ ,/ M2/ )/ )/ ,/ 或者/ C1/ =/ end/ (/ M/ ,/ M1/ )/ ,/ C2/ =/ end/ (/ M/ ,/ M2/ )/ ,/ 则/ R1/ 逻辑/ 蕴涵/ R2/ ,/ 记作/ R1/ / R2/ ,/ 当且/ 仅/ 当/ :/ 存在/ 置换/ θ/ 使得/ M1/ θ/ =/ M2/ ,/ 并且/ 对/ 每/ 一个/ H11/ ,/ …/ ,/ H1m/ }/ ,/ 存在/ H2/ {/ H1j/ 〉/ ,/ Mj/ )/ )/ ∈/ {/ H21/ ,/ …/ ,/ H2n/ }/ ,/ 对/ 每/ 一个/ H1tag2Mi/ )/ ∈/ {/ M11/ ,/ …/ ,/ H2n/ }/ ,/ 使得/ Mi/ θ/ =/ Mj/ ./ {/ H2/ 定义/ 2/ (/ 逻辑/ 可/ 推导/ )/ ./ 设/ F/ 是/ 一个/ 闭/ 原子公式/ ,/ B/ 是/ 一组/ 逻辑/ 规则/ ,/ F/ 关于/ B/ 逻辑/ 可/ 推导/ 当且/ 仅/ 当/ 存在/ 满足/ 以下/ 条件/ 的/ 一棵/ 有限/ 树/ :/ (/ 1/ )/ 除了/ 根/ 结点/ 外/ ,/ 每/ 一个/ 结点/ 均/ 用/ B/ 中/ 的/ 一条/ 逻辑/ 规则/ 标记/ ,/ 并且/ 每/ 一条/ 边均/ 用/ 一个/ 闭/ 原子公式/ 标记/ ;/ 定义/ 1/ (/ 逻辑/ 蕴涵/ )/ ./ 设/ R1/ =/ H1/ (/ 2/ )/ 若树/ 中/ 的/ 一个/ 结点/ 用/ R/ 标记/ ,/ 结点/ 的/ 入边/ 用闭/ 原子公式/ F0/ 标记/ ,/ n/ 条出/ 边/ 分别/ 用闭/ 原子公式/ F1/ ,/ …/ ,/ Fn/ 标记/ ,/ 则/ R/ / F1/ ∧/ …/ ∧/ Fn/ →/ F0/ ;/ (/ 3/ )/ 根/ 结点/ 有/ 唯一/ 一条/ 出边/ 并且/ 用闭/ 原子公式/ F/ 标记/ ;/ 满足/ 上述/ 条件/ 的/ 有限/ 树/ 称为/ F/ 关于/ B/ 的/ 逻辑/ 可/ 推导/ 树/ ./ 定义/ 3/ (/ 保密性/ )/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ F/ =/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 是/ 一个/ 闭/ 原子公式/ ,/ 如果/ F/ 关于/ P/ 逻辑/ 不可/ 推导/ ,/ 则/ 称/ 安全/ 协议/ 关于/ M/ 满足/ 保密性/ ./ 认证/ 性用/ 对应性/ 断言/ begin/ (/ M/ ,/ M/ )/ 和/ end/ (/ M/ ,/ M/ )/ 刻画/ ,/ 令/ Bb/ =/ {/ →/ begin/ (/ M1/ ,/ M1/ )/ ,/ …/ ,/ →/ begin/ (/ Mn/ ,/ Mn/ )/ }/ ./ 定义/ 4/ (/ 认证/ 性/ )/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ begin/ (/ M/ ,/ M/ )/ 和/ end/ (/ M/ ,/ M/ )/ 是/ 刻画/ 认证/ 性/ 的/ 对应性/ 断言/ 序偶/ ,/ end/ (/ M/ ,/ M/ )/ 是/ 一个/ 闭/ 原子公式/ ,/ 如果/ end/ (/ M/ ,/ M/ )/ 关于/ P/ ∪/ Bb/ 逻辑/ 可/ 推导/ ,/ 那么/ begin/ (/ M/ ,/ M/ )/ ∈/ Bb/ ,/ 称/ 安全/ 协议/ 关于/ begin/ (/ M/ ,/ M/ )/ 和/ end/ (/ M/ ,/ M/ )/ 满足/ 认证/ 性/ ./ 3/ 安全/ 协议/ 验证/ 方法/ 定义/ 5/ (/ 消解/ )/ ./ 设/ R/ =/ H/ →/ F/ 和/ R/ =/ H/ →/ F/ 是/ 两条/ 逻辑/ 规则/ ,/ 如果/ F/ =/ attacker/ (/ role/ (/ 〈/ M1/ ,/ N1/ ,/ tag1/ 〉/ ,/ M1/ )/ )/ (/ 或/ F/ =/ end/ (/ M1/ ,/ M1/ )/ )/ ,/ 并且/ H/ 中/ 存在/ 原子公式/ F0/ =/ attacker/ (/ role/ (/ 〈/ M2/ ,/ N2/ ,/ tag2/ 〉/ ,/ M2/ )/ )/ (/ 或/ F0/ =/ end/ (/ M1/ ,/ M2/ )/ )/ ,/ 使得/ M1/ 能够/ 与/ M2/ 进行/ 合一/ 化/ ,/ 则/ R/ 与/ R/ 的/ 消解/ 记作/ R/ ·/ R/ ,/ 定义/ 为/ (/ H/ ∧/ (/ H/ -/ F0/ )/ )/ θ/ →/ F/ θ/ ,/ 其中/ θ/ =/ mgu/ (/ M1/ ,/ M2/ )/ 是/ M1/ 和/ M2/ 的/ 最/ 一般/ 合一/ 化/ 算子/ ./ 定义/ 6/ (/ 目标/ )/ ./ 逻辑/ 规则/ 前件/ 中形/ 如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ x/ )/ )/ (/ x/ 是/ 任意/ 一个/ 变量/ )/ 和/ begin/ (/ M/ ,/ M/ )/ 的/ 原子公式/ 称为/ 假/ 目标/ ,/ 形如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ (/ M/ 不是/ 变量/ )/ 和/ end/ (/ M/ ,/ M/ )/ 的/ 原子公式/ 称为/ 目标/ ./ 定义/ 7/ (/ 解/ 形式逻辑/ 规则/ )/ ./ 设/ H/ →/ C/ 是/ 一个/ 逻辑/ 规则/ ,/ 如果/ H/ 中/ 的/ 原子公式/ 都/ 是/ 假/ 目标/ ,/ 则/ 称/ H/ →/ C/ 是/ 解/ 形式逻辑/ 规则/ ./ 用/ SolvedForm/ 表示/ 解/ 形式逻辑/ 规则/ 集合/ ,/ 用/ UnSolvedForm/ 表示/ 非解/ 形式逻辑/ 规则/ 集合/ ./ 定义/ 8/ (/ X/ -/ 消解/ )/ ./ 设/ R/ =/ H/ →/ F/ 和/ R/ =/ H/ →/ F/ 是/ 两条/ 逻辑/ 规则/ ,/ R/ ∈/ SolvedForm/ ,/ R/ ∈/ UnSolvedForm/ ,/ F/ =/ attacker/ (/ role/ (/ 〈/ M1/ ,/ N1/ ,/ tag1/ 〉/ ,/ M1/ )/ )/ ,/ F0/ =/ attacker/ (/ role/ (/ 〈/ M2/ ,/ N2/ ,/ tag2/ 〉/ ,/ M2/ )/ )/ 是/ H/ 中/ 满足/ M1/ 能够/ 与/ M2/ 进行/ 合一/ 化/ 的/ 目标/ ,/ 则/ R/ 与/ R/ 的/ X/ -/ 消解/ 记作/ R/ / R/ ,/ 定义/ 为/ (/ H/ ∧/ (/ H/ -/ F0/ )/ )/ θ/ →/ F/ θ/ ,/ 其中/ θ/ =/ mgu/ (/ M1/ ,/ M2/ )/ ./ Page5/ 设/ R/ 表示/ 一个/ 逻辑/ 规则/ ,/ B/ 表示/ 一个/ 逻辑/ 规则/ Rule0/ (/ P/ )/ ∩/ UnSolvedForm/ ;/ R/ ∈/ T0/ (/ P/ )/ ,/ R/ ∈/ C0/ (/ P/ )/ }/ ;/ Rulen/ (/ P/ )/ )/ ;/ 集合/ ,/ 定义/ addRule/ (/ R/ ,/ B/ )/ 如下/ :/ If/ / R/ ∈/ B/ ,/ R/ / R/ ,/ thenaddRule/ (/ R/ ,/ B/ )/ =/ B/ ;/ elseaddRule/ (/ R/ ,/ B/ )/ =/ {/ R/ }/ ∪/ {/ R/ |/ R/ ∈/ B/ ,/ R/ // / R/ }/ ∪/ {/ marked/ (/ R/ )/ |/ R/ ∈/ B/ ,/ R/ / R/ }/ 并且/ 定义/ addRule/ (/ {/ R1/ ,/ …/ ,/ Rn/ }/ ,/ B/ )/ =/ addRule/ (/ {/ R2/ ,/ …/ ,/ Rn/ }/ ,/ addRule/ (/ R1/ ,/ B/ )/ )/ ./ 上述/ 定义/ 中/ ,/ marked/ (/ R/ )/ 表示/ 逻辑/ 规则/ R/ 不再/ 参与/ X/ -/ 消解/ 计算/ ,/ 本文/ 用/ Marked/ 表示/ 不再/ 参与/ X/ -/ 消解/ 计算/ 的/ 逻辑/ 规则/ 的/ 集合/ ,/ UnMarked/ 表示/ 不/ 属于/ Marked/ 的/ 逻辑/ 规则/ 的/ 集合/ ./ 设/ R/ =/ F1/ ∧/ …/ ∧/ Fn/ →/ C/ ,/ Fi/ =/ attacker/ (/ role/ (/ 〈/ Mi/ ,/ Ni/ ,/ tagi/ 〉/ ,/ Mi/ )/ )/ (/ i/ =/ 1/ ,/ …/ ,/ n/ )/ ,/ 定义/ elimdup/ (/ R/ )/ 为/ 满足/ 以下/ 条件/ 的/ 逻辑/ 规则/ R/ :/ (/ 1/ )/ 如果/ 对/ 任意/ 的/ j/ </ i/ ,/ Mj/ ≠/ Mi/ ,/ 则/ Fi/ 是/ R/ 逻辑/ 前件/ 中/ 的/ 一个/ 原子公式/ ;/ (/ 2/ )/ C/ 是/ R/ 的/ 逻辑/ 后件/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ 归纳定义/ :/ Rule0/ (/ P/ )/ =/ {/ elimdup/ (/ R/ )/ |/ R/ ∈/ P/ }/ ;/ T0/ (/ P/ )/ =/ Rule0/ (/ P/ )/ ∩/ SolvedFormC0/ (/ P/ )/ =/ X/ _/ Resolution1/ (/ P/ )/ =/ {/ elimdup/ (/ R/ )/ |/ R/ =/ R/ / R/ ,/ Rulen/ +/ 1/ (/ P/ )/ =/ addRule/ (/ X/ _/ Resolutionn/ +/ 1/ (/ P/ )/ ,/ Tn/ +/ 1/ (/ P/ )/ =/ Rulen/ +/ 1/ (/ P/ )/ ∩/ SolvedForm/ ;/ Cn/ +/ 1/ (/ P/ )/ =/ Rulen/ +/ 1/ (/ P/ )/ ∩/ UnSolvedForm/ ;/ X/ _/ Resolutionn/ +/ 1/ (/ P/ )/ =/ {/ elimdup/ (/ R/ )/ |/ R/ =/ R/ / R/ ,/ R/ ∈/ Tn/ (/ P/ )/ ,/ R/ ∈/ Cn/ (/ P/ )/ }/ ./ 定义/ 9/ (/ 解/ 形式/ 不动点/ )/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ 定义/ fixpoint/ (/ P/ )/ =/ ∪/ {/ Tn/ (/ P/ )/ |/ n/ / 0/ }/ ∩/ UnMarked/ ,/ fixpoint/ (/ P/ )/ 称为/ P/ 的/ 解/ 形式/ 不动点/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ R/ 是/ 一个/ 逻辑/ 规则/ ,/ B/ 是/ 一个/ 逻辑/ 规则/ 集合/ ,/ 对于/ 保密性/ ,/ 定义/ derivablerec/ (/ R/ ,/ B/ ,/ P/ )/ 如下/ :/ if/ / R/ ∈/ B/ ,/ R/ / R/ ,/ thenderivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ / elseifR/ =/ →/ C/ ,/ thenderivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ {/ →/ C/ }/ elsederivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ {/ derivablerec/ (/ elim/ -/ dup/ (/ R/ ·/ R/ )/ ,/ {/ R/ }/ ∪/ B/ ,/ P/ )/ |/ R/ ∈/ fixpoint/ (/ P/ )/ }/ ./ 对于/ 认证/ 性/ ,/ 定义/ derivablerec/ (/ R/ ,/ B/ ,/ P/ )/ 如下/ :/ if/ / R/ ∈/ B/ ,/ R/ / R/ ,/ thenderivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ / elseifR/ =/ begin/ (/ M1/ ,/ M1/ )/ ∧/ …/ ∧/ begin/ (/ Mn/ ,/ Mn/ )/ →/ end/ (/ M/ ,/ M/ )/ ,/ thenderivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ {/ R/ }/ elsederivablerec/ (/ R/ ,/ B/ ,/ P/ )/ =/ ∪/ {/ derivablerec/ (/ elim/ -/ dup/ (/ R/ ·/ R/ )/ ,/ {/ R/ }/ ∪/ B/ ,/ P/ )/ |/ R/ ∈/ fixpoint/ (/ P/ )/ }/ ./ 对于/ 形如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 和/ end/ (/ M/ ,/ M/ )/ 的/ 闭/ 原子公式/ F/ ,/ 定义/ derivable/ (/ F/ ,/ P/ )/ =/ derivablerec/ (/ F/ →/ F/ ,/ / ,/ P/ )/ ./ 定理/ 1/ [/ 15/ ]/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ F/ 是/ 一个/ 闭/ 原子公式/ ,/ 则/ derivable/ (/ F/ ,/ P/ )/ 的/ 计算/ 过程/ 停机/ ./ 定理/ 2/ [/ 15/ ]/ ./ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ 则/ ①/ 保密性/ :/ 若/ F/ 是/ 形如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 的/ 闭/ 原子公式/ ,/ 则/ F/ 关于/ fixpoint/ (/ P/ )/ 逻辑/ 可/ 推导/ 当且/ 仅/ 当/ →/ F/ ∈/ derivable/ (/ F/ ,/ P/ )/ ./ ②/ 认证/ 性/ :/ 设/ F/ 是/ 形如/ end/ (/ M/ ,/ M/ )/ 的/ 闭/ 原子公式/ ,/ F/ 关于/ fixpoint/ (/ P/ )/ ∪/ Bb/ 逻辑/ 可/ 推导/ ,/ begin/ (/ M/ ,/ M/ )/ ∈/ Bb/ 当且/ 仅/ 当/ :/ 存在/ H1/ ∧/ …/ ∧/ Hn/ →/ F/ ∈/ deriv/ -/ able/ (/ F/ ,/ P/ )/ ,/ 其中/ Hi/ ∈/ Bb/ 均/ 为/ 形如/ begin/ (/ Mi/ ,/ Mi/ )/ 的/ 原子公式/ ,/ 并且/ begin/ (/ M/ ,/ M/ )/ ∈/ {/ H1/ ,/ …/ ,/ Hn/ }/ ./ 4/ 不/ 停机/ 性/ 的/ 动态/ 预测/ 设/ P/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ ,/ 由/ 定理/ 1/ 可知/ ,/ 只要/ P/ 的/ 解/ 形式/ 不动点/ 的/ 计算/ 过程/ 停机/ ,/ 则/ 安全/ 协议/ 的/ 验证/ 过程/ 一定/ 停机/ ,/ 下面/ 将/ 给出/ 安全/ 协议/ 逻辑/ 模型/ 中解/ 形式/ 不动点/ 计算/ 过程/ 的/ 不/ 停机/ 性/ 预测/ 方法/ ./ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 的/ 逻辑/ 规则/ 数目/ 是/ 有/ 穷/ 的/ ,/ 解/ 形式/ 不动点/ 计算/ 不/ 停机/ 的/ 原因/ 在于/ 安全/ 协议/ 逻辑程序/ 模型/ 中/ 的/ 一些/ 逻辑/ 规则/ 被/ 无穷/ 次地/ 应用/ 于/ 计算/ X/ -/ 消解/ ./ 设/ A/ 和/ B/ 是/ 两个/ 原子公式/ ,/ 如果/ 删除/ A/ 中/ 增加/ 的/ 函数/ 符号/ 、/ 名/ 和/ 变量/ ,/ 原子公式/ A/ 就是/ 原子公式/ B/ 或/ B/ 的/ 变量/ 换名/ ,/ 则/ 称/ A/ 是/ B/ 的/ 递归/ 增加/ ./ 一条/ 逻辑/ 规则/ 被/ 无穷/ 次地/ 应用/ 于/ 计算/ X/ -/ 消解/ ,/ 由/ 最/ 一般/ 合一/ 化/ 算法/ 可知/ ,/ 将/ 表现/ 为/ 逻辑/ 规则/ 中/ 一些/ 原子公式/ 的/ 变量/ 换名/ 在/ 解/ 形式/ 不动点/ 中/ 无穷/ 次地/ 出现/ ,/ 或者/ 一些/ 原子公式/ 在/ 解/ 形式/ 不动点/ 中/ 无穷/ 次地/ 递归/ 增加/ [/ 13/ ]/ ./ 解/ 形式/ 不动点/ 中/ 的/ 规则/ 都/ 是/ 解/ 形式逻辑/ 规则/ ,/ 解/ 形式逻辑/ 规则/ 逻辑/ 前件/ 中/ 的/ 原子公式/ 都/ 是/ 形如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ x/ )/ )/ (/ x/ 是/ 任意/ 一个/ 变量/ )/ 和/ begin/ (/ M/ ,/ M/ )/ 的/ 简单/ 原子公式/ ,/ 因而/ 解/ 形式/ 不动点/ 不/ 停机/ 将/ 表现/ 为/ :/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 的/ 一些/ 逻辑/ 规则/ 的/ 逻辑/ 后件/ 的/ 变量/ 换名/ 在/ 解/ 形式/ 不动点/ 中/ 无穷/ 次地/ 出现/ ,/ 或者/ 这些/ 逻辑/ 规则/ 的/ 逻辑/ 后件/ 在/ 解/ 形式/ 不动点/ 中/ 无穷/ 次地/ 递归/ 增加/ ./ Page6/ 定义/ 10/ (/ 符号/ 字符串/ )/ ./ 设/ T/ 是/ 一个/ 项/ (/ 或是/ 形如/ attacker/ (/ role/ (/ 〈/ M/ ,/ N/ ,/ tag/ 〉/ ,/ M/ )/ )/ 的/ 原子公式/ )/ ,/ 则/ T/ 的/ 字符串/ S/ 是/ T/ (/ 或/ M/ )/ 中/ 的/ 函数/ 符号/ 、/ 名/ 、/ 变量/ 按照/ 从左到右/ 的/ 顺序/ 连接/ 在/ 一起/ 构成/ 的/ 字符串/ ,/ T/ 的/ 符号/ 字符串/ ST/ 是/ 将/ S/ 中/ 的/ 所有/ 变量/ 全部/ 用/ 新/ 符号/ χ/ 替换/ 后/ 得到/ 的/ 字符串/ ./ 符号/ 字符串/ 按照/ 从左到右/ 的/ 顺序/ 依次/ 抽取/ 出/ 原子公式/ 中/ 的/ 函数/ 符号/ 、/ 名/ 和/ 变量/ ,/ 并/ 将/ 变量/ 用/ 新/ 符号/ χ/ 替换/ ./ 例如/ ,/ 对于/ 原子公式/ attacker/ (/ role/ (/ 〈/ host/ (/ kSS/ [/ ]/ )/ ,/ host/ (/ kBS/ [/ ]/ )/ ,/ n/ 〉/ ,/ encrypt/ (/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ v6/ )/ )/ )/ ,/ kBS/ [/ ]/ )/ )/ )/ ,/ 它/ 的/ 符号/ 字符串/ 为/ encrypt/ ·/ 2tuple/ ·/ host/ ·/ kAS/ ·/ 2tuple/ ·/ host/ ·/ kAS/ ·/ 2tuple/ ·/ host/ ·/ kAS/ ·/ χ/ ·/ kBS/ ,/ 其中/ “/ ·/ ”/ 表示/ 字符串/ 的/ 连接/ ./ 定义/ 11/ (/ 投影/ )/ ./ 设/ ST1/ 和/ ST2/ 是/ 两个/ 符号/ 字符串/ ,/ 如果/ ST1/ 是/ 将/ 字符串/ ST2/ 中/ 的/ 0/ 个/ 或/ 多个/ 符号/ 删除/ 得到/ 的/ 字符串/ ,/ 则/ 称/ ST1/ 是/ ST2/ 的/ 投影/ ,/ 记作/ ST1/ / projST2/ ./ 投影/ 关系/ 用于/ 刻画/ 一个/ 原子公式/ A/ 是/ 原子公式/ B/ 的/ 变量/ 换名/ ,/ 或者/ 原子公式/ A/ 是/ 原子公式/ B/ 的/ 递归/ 增加/ ./ 例如/ ,/ 原子公式/ attacker/ (/ role/ (/ 〈/ host/ (/ kSS/ [/ ]/ )/ ,/ host/ (/ kBS/ [/ ]/ )/ ,/ 13/ 〉/ ,/ encrypt/ (/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ v6/ )/ )/ ,/ kBS/ [/ ]/ )/ )/ )/ 的/ 符号/ 字符串/ 是/ attacker/ (/ role/ (/ 〈/ host/ (/ kSS/ [/ ]/ )/ ,/ host/ (/ kBS/ [/ ]/ )/ ,/ 13/ 〉/ ,/ encrypt/ (/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ 2tuple/ (/ host/ (/ kAS/ [/ ]/ )/ ,/ v6/ )/ )/ )/ ,/ kBS/ [/ ]/ )/ )/ )/ )/ 的/ 符号/ 字符串/ 的/ 投影/ ./ 定义/ 12/ (/ 循环/ 到/ )/ ./ 设/ A1/ =/ attacker/ (/ role/ (/ 〈/ M1/ ,/ N1/ ,/ tag1/ 〉/ ,/ M1/ )/ )/ 和/ A2/ =/ attacker/ (/ role/ (/ 〈/ M2/ ,/ N2/ ,/ tag2/ 〉/ ,/ M2/ )/ )/ 是/ 两个/ 原子公式/ ,/ 如果/ SA1/ / projSA2/ 并且/ tag1/ =/ tag2/ ,/ 则/ 称/ A1/ 循环/ 到/ A2/ ,/ 记作/ A1/ / loopA2/ ./ 与/ 文献/ [/ 13/ ]/ 中/ 的/ 定义/ 不同/ ,/ 本文/ 中/ 循环/ 到/ 的/ 定义/ 增加/ 了/ 约束条件/ tag1/ =/ tag2/ ,/ tag1/ =/ tag2/ 约束/ 原子公式/ A1/ 和/ A2/ 必须/ 是/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 同一个/ 逻辑/ 规则/ 的/ 逻辑/ 后件/ 的/ 不同/ 实例/ ./ 定义/ 13/ (/ 规则/ 的/ 长幼/ 关系/ )/ ./ 若/ 规则/ Ri/ =/ Hi/ →/ Fi/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 满足/ R3/ =/ R1/ / R2/ ,/ 则/ R1/ ,/ R2/ 与/ R3/ 之间/ 具有/ 长幼/ 关系/ R1/ / R3/ ,/ R2/ / R3/ ,/ 在/ 不/ 引起/ 歧义/ 时/ 可/ 写作/ F1/ / F3/ ,/ F2/ / F3/ ./ 用/ / c/ 表示/ / 的/ 传递/ 闭包/ ./ 定义/ 14/ (/ 循环/ 目标/ )/ ./ 设/ Hj/ →/ Aj/ ,/ Hi/ →/ Ai/ 均/ 为/ 解/ 形式/ 规则/ ,/ 如果/ Ai/ / cAj/ 且/ Ai/ / loopAj/ ,/ 则/ 称/ Aj/ 是/ Ai/ 的/ 循环/ 目标/ ./ 引理/ 1/ [/ 13/ ]/ ./ 设/ {/ Ai/ }/ i/ =/ 1/ 是/ 有/ 穷/ 字母表/ ∑/ 上/ 字符串/ 的/ 一个/ 无穷/ 序列/ ,/ 则/ 存在/ 一个/ 无穷的/ 递增/ 整数/ 序列/ {/ ni/ }/ i/ =/ 1/ ,/ 使得/ 对于/ 任意/ 的/ i/ ,/ 均/ 有/ Ani/ / projAni/ +/ 1/ ./ 定理/ 3/ ./ / n/ ∈/ N/ ,/ Rulen/ (/ P/ )/ 为/ 有限/ 集/ ./ 证明/ ./ 用/ 归纳法/ 证明/ ./ (/ 1/ )/ 当/ n/ =/ 0/ 时/ ,/ 因为/ 安全/ 协议/ 的/ 逻辑程序/ 模型/ P/ 是/ 有限/ 集/ ,/ 所以/ Rule0/ (/ P/ )/ =/ {/ elimdup/ (/ R/ )/ |/ R/ ∈/ P/ }/ 是/ 有限/ 集/ ,/ 所以/ 当/ n/ =/ 0/ 时/ ,/ 结论/ 成立/ ./ (/ 2/ )/ 假设/ 当/ n/ =/ k/ 时/ 结论/ 成立/ ./ 当/ n/ =/ k/ +/ 1/ 时/ ,/ 由/ 归纳/ 假设/ ,/ Rulek/ (/ P/ )/ 是/ 有限/ 集/ ,/ 所以/ 其/ 子集/ Tk/ (/ P/ )/ ,/ Ck/ (/ P/ )/ 均/ 为/ 有限/ 集/ ,/ 则/ 由/ 两个/ 有限/ 集/ 进行/ X/ -/ 消解/ 得到/ 的/ 新/ 规则/ 集/ X/ _/ Resolutionk/ +/ 1/ (/ P/ )/ =/ {/ elimdup/ (/ R/ )/ |/ R/ =/ R/ / R/ ,/ R/ ∈/ Tk/ (/ P/ )/ ,/ R/ ∈/ Ck/ (/ P/ )/ }/ 为/ 有限/ 集/ ,/ 所以/ Rulek/ +/ 1/ (/ P/ )/ =/ addRule/ (/ X/ _/ Resolutionk/ +/ 1/ (/ P/ )/ ,/ Rulek/ (/ P/ )/ )/ 为/ 有限/ 集/ ./ 综上所述/ ,/ / n/ ∈/ N/ ,/ Rulen/ (/ P/ )/ 为/ 有限/ 集/ ./ 证毕/ ./ 定理/ 4/ ./ 设/ P/ 是/ 一个/ 安全/ 协议/ 的/ 逻辑程序/ 模型/ ,/ 如果/ 存在/ 无穷/ 解/ 形式逻辑/ 规则/ 序列/ H1/ →/ A1/ ,/ …/ ,/ Hg1/ →/ Ag1/ ,/ …/ ,/ Hg2/ →/ Ag2/ ,/ …/ ,/ Hgi/ →/ Agi/ ,/ …/ ,/ Hgi/ +/ 1/ →/ Agi/ +/ 1/ ,/ …/ ,/ 其中/ Agi/ +/ 1/ 是/ Agi/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ )/ 的/ 循环/ 目标/ ,/ 则/ P/ 的/ 解/ 形式/ 不动点/ 计算/ 不/ 终止/ ./ 证明/ ./ 假设/ P/ 的/ 解/ 形式/ 不动点/ 计算/ 终止/ ,/ 则/ / m/ ∈/ N/ ,/ 使得/ Tm/ (/ P/ )/ =/ Tm/ +/ 1/ (/ P/ )/ ,/ Cm/ (/ P/ )/ =/ Cm/ +/ 1/ (/ P/ )/ ./ 则/ / n/ ∈/ N/ 且/ n/ >/ m/ ,/ Rulen/ (/ P/ )/ =/ Rulem/ (/ P/ )/ ./ 又/ 由/ 定理/ 3/ 知/ ,/ Rulen/ 为/ 有限/ 集/ ./ 所以/ ∪/ {/ Rulen/ (/ P/ )/ |/ n/ / 0/ }/ =/ ∪/ m/ 与题/ 设中/ 存在/ 无穷/ 解/ 形式逻辑/ 规则/ 序列/ 矛盾/ ./ 所以/ 假设/ 不/ 成立/ ,/ 即/ 必有/ P/ 的/ 解/ 形式/ 不动点/ 计算/ 不/ 终止/ ./ 定理/ 4/ 给出/ 了/ 不动点/ 计算/ 不/ 终止/ 的/ 一个/ 充分条件/ ,/ 该/ 条件/ 表明/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 计算/ 过程/ 的/ 不/ 停机/ 性/ 可以/ 刻画/ 为/ :/ 存在/ 无穷/ 选择/ 序列/ A1/ ,/ …/ ,/ Ag1/ ,/ …/ ,/ Ag2/ ,/ …/ ,/ Agi/ ,/ …/ ,/ Agi/ +/ 1/ ,/ …/ ,/ 使得/ 对于/ 任意/ 的/ i/ / 1/ ,/ Agi/ +/ 1/ 是/ Agi/ 的/ 循环/ 目标/ ./ 检测/ 满足/ 上述/ 条件/ 的/ 无穷/ 选择/ 序列/ 是/ 不/ 现实/ 的/ ,/ 为了/ 可/ 在/ 计算机/ 中/ 实现/ ,/ 可以/ 采用/ 近似/ 的/ 思想/ :/ 选定/ 一个/ 正整数/ k/ 作为/ 阈值/ ,/ 检测/ 安全/ 协议/ 逻辑程序/ 解/ 形式/ 不动点/ 的/ 计算/ 过程/ 中/ 是否/ 存在/ 选择/ 序列/ A1/ ,/ …/ ,/ Ag1/ ,/ …/ ,/ Ag2/ ,/ …/ ,/ Agk/ ,/ 使得/ 对于/ 任意/ 的/ i/ (/ 1/ / i/ / k/ )/ ,/ Agi/ +/ 1/ 是/ Agi/ 的/ 循环/ 目标/ ./ 将/ 满足/ 上述/ 条件/ 的/ 选择/ 序列/ 称为/ 不/ 停机/ 条件/ ./ 如果/ 满足/ 不/ 停机/ 条件/ ,/ 则/ 预测/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 的/ 计算/ 过程/ 不/ 停机/ ,/ 否则/ 预测/ 解/ 形式/ 不动点/ 的/ 计算/ 过程/ 停机/ ./ 显然/ ,/ k/ 值越/ 大/ ,/ 预测/ 的/ 准确度/ 越高/ ,/ 需要/ 的/ 时空/ 代价/ 越高/ ;/ 反之/ ,/ 预测/ 速度/ 越/ 快/ ,/ 预测/ 的/ 准确度/ 越低/ ./ 如果/ 满足/ 上述/ 条件/ Page7/ 的/ 选择/ 序列/ 中/ 原子公式/ 的/ tag/ 项/ 的/ 取值/ 均/ 为/ n0/ ,/ 则/ 预测/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 中/ 第/ n0/ 条/ 逻辑/ 规则/ 是/ 导致/ 解/ 形式/ 不动点/ 无穷/ 计算/ 的/ 逻辑/ 规则/ ./ 此时/ 也/ 可/ 针对/ 标号/ 为/ n0/ 的/ 规则/ 进行/ 局部/ 抽象/ 验证/ ,/ 这样/ 可以/ 更加/ 逼近/ 精确/ 模型/ ,/ 减少/ 抽象/ -/ 精化/ 迭代/ 的/ 次数/ ,/ 从而/ 降低/ 验证/ 一个/ 协议/ 所/ 需/ 花费/ 的/ 总/ 的/ 时间/ 开销/ ./ 5/ 实验/ 采用/ 本文/ 提出/ 的/ 不/ 停机/ 性/ 预测/ 算法/ ,/ 选取/ 阈值/ Needham/ -/ Schroeder/ 共享/ 密钥/ 协议/ 表/ 2/ 协议/ 验证/ 的/ 预测/ 结果/ 不/ 停机/ 表/ 2/ 中/ 的/ 总/ 时间/ 是/ 指解/ 形式/ 不动点/ 计算/ 、/ 安全/ 性质/ 检测/ 、/ 反例/ 构造/ 等/ 阶段/ 的/ 全部/ 时间/ 开销/ ./ 需要/ 说明/ 的/ 是/ ,/ 公钥/ Kerberos/ 协议/ 认证/ 服务/ 阶段/ 的/ 验证/ 过程/ 是/ 终止/ 的/ ,/ 但是/ 在/ 构造/ 反例/ 时/ ,/ 由于/ derivable/ 函数/ 的/ 可选择性/ 多/ ,/ 造成/ 了/ 组合/ 爆炸/ ,/ 完成/ 反例/ 构造/ 需要/ 的/ 时间/ 过长/ ,/ 因此/ 表中/ 不能/ 给出/ 总/ 时间/ ./ Needham/ -/ Schroeder/ 共享/ 密钥/ 协议/ 、/ Woo/ -/ Lam/ 认证/ 协议/ 版本/ II3/ 以及/ AndrewsecureRPC/ 协议/ 的/ 解/ 形式/ 不动点/ 被/ 预测/ 为/ 不/ 停机/ ,/ 实验/ 中/ 预测/ 计算/ 花费/ 的/ 时间/ 非常少/ ,/ 以至于/ 计算机/ 近似/ 认为/ 时间/ 为/ 0s/ ./ 其它/ 安全/ 协议/ 的/ 解/ 形式/ 不动点/ 被/ 预测/ 为/ 停机/ ,/ 由于/ 停机/ 的/ 协议/ 在/ 达到/ 不动点/ 时才/ 停止/ 预测/ ,/ 因此/ 预测/ 所/ 检测/ 的/ 规则/ 数比/ 不/ 停机/ 的/ 协议/ 要/ 多得多/ ,/ 所以/ SPVT/ 能/ 计算/ 出/ 预测/ 时间/ ./ 从表中/ 可以/ 看出/ ,/ 验证/ 一个/ 协议/ 的/ 总/ 时间/ 开销/ 比/ 预测/ 时间/ 多得多/ ,/ 所有/ 协议/ 的/ 停机/ 性/ 预测/ 花费/ 的/ 时间/ 基本上/ 可以/ 忽略不计/ ./ 上述/ 实验/ 结果表明/ :/ 安全/ 协议/ 的/ 逻辑/ 模型/ 的/ 解/ 形式/ 不动点/ 计算/ 过程/ 的/ 停机/ 性/ 在/ 选取/ 阈值/ k/ =/ 3/ 时/ ,/ 使用/ 本文/ 的/ 不/ 停机/ 性/ 预测/ 算法/ 得到/ 的/ 判定/ 结果/ 都/ 是/ 正确/ 的/ ,/ 从而/ 表明/ 停机/ 性/ 预测/ 算法/ 的/ 实用性/ ./ 下面/ 以/ Needham/ -/ Schroeder/ 共享/ 密钥/ 协议/ (/ 简称/ 为/ NS/ 协议/ )/ 为例/ ,/ 说明/ 不/ 停机/ 性/ 预测/ 算法/ 的/ 具体/ 应用/ ./ NS/ 协议/ 的/ 形式化/ 描述/ 如下/ :/ k/ =/ 3/ ,/ 基于/ 安全/ 协议/ 验证/ 工具/ SPVT/ ,/ 在/ Intel/ (/ R/ )/ Pentium/ (/ R/ )/ D2/ ./ 66GHzCPU/ 和/ 1GB/ 内存/ 的/ PC机/ 上/ ,/ 对/ 典型/ 安全/ 协议/ 的/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 的/ 停机/ 性/ 进行/ 了/ 预测/ ./ 实验/ 过程/ 在/ 计算/ 安全/ 协议/ 逻辑程序/ 解/ 形式/ 不动点/ 的/ 同时/ 检测/ 不/ 停机/ 条件/ 是否/ 满足/ ,/ 如果/ 不/ 停机/ 条件/ 得到/ 满足/ ,/ 则/ 预测/ 解/ 形式/ 不动点/ 不/ 停机/ ,/ 如果/ 不/ 停机/ 条件/ 不/ 满足/ ,/ 则/ 继续/ 迭代/ 计算/ 解/ 形式/ 不动点/ ,/ 直到/ 完全/ 计算/ 出解/ 形式/ 不动点/ ,/ 或者/ 预测/ 解/ 形式/ 不动点/ 不/ 停机/ ./ 表/ 2/ 列出/ 了/ 采用/ 预测/ 算法/ 帮助/ 协议/ 验证/ 的/ 实验/ 结果/ ./ 不/ 停机/ 不/ 停机/ (/ 1/ )/ A/ →/ S/ :/ A/ ,/ B/ ,/ Na/ ;/ (/ 2/ )/ S/ →/ A/ :/ {/ Na/ ,/ B/ ,/ Kab/ ,/ {/ Kab/ ,/ A/ }/ Kbs/ }/ Kas/ ;/ (/ 3/ )/ A/ →/ B/ :/ {/ Kab/ ,/ A/ }/ Kbs/ ;/ (/ 4/ )/ B/ →/ A/ :/ {/ Nb/ }/ Kab/ ;/ (/ 5/ )/ A/ →/ B/ :/ {/ Nb/ -/ 1/ }/ Kab/ ./ 由于/ 消息/ (/ 4/ )/ 、/ (/ 5/ )/ 会/ 导致/ 消解/ 过程/ 中/ 不断/ 出现/ 形/ 如/ {/ Nb/ -/ 1/ -/ …/ -/ 1/ }/ Kab/ 的/ 消息/ ,/ 从而/ 造成/ 不动点/ 计算/ 不/ 终止/ ./ 在/ NS/ 协议/ 的/ 逻辑程序/ 的/ 不动点/ 计算/ 过程/ 中/ ,/ SPVT/ 产生/ 了/ 如下/ 逻辑程序/ 规则/ :/ 规则/ 4/ ./ 〈/ Ready/ 〉/ :/ Begin/ (/ Aparam/ [/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ s1/ )/ ]/ )/ ∧/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kss/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ (/ Na/ (/ s1/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ x4/ ,/ YM/ )/ ,/ key/ (/ kas/ (/ )/ )/ )/ )/ )/ ∧/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ x3/ ,/ x4/ )/ )/ )/ →/ Attacker/ (/ LK/ -/ erb/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ minus/ (/ x3/ )/ ,/ x4/ )/ )/ )/ ./ 规则/ 37/ ./ 〈/ Ready/ 〉/ :/ Begin/ (/ Aparam/ [/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ z16/ )/ ]/ )/ ∧/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ z7/ ,/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ )/ )/ )/ →/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ minus/ (/ z7/ )/ ,/ Akey/ (/ (/ hostPage8/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ )/ )/ )/ ./ 规则/ 43/ ./ 〈/ Solved/ 〉/ :/ Begin/ (/ Aparam/ [/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ z16/ )/ ]/ )/ →/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ minus/ (/ Nb/ (/ encrypt/ (/ (/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ )/ ,/ key/ (/ kbs/ (/ )/ )/ )/ ,/ z6/ )/ )/ ,/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ )/ )/ )/ ./ 规则/ 45/ ./ 〈/ Solved/ 〉/ :/ Begin/ (/ Aparam/ [/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ z16/ )/ ]/ )/ →/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ minus/ (/ minus/ (/ Nb/ (/ encrypt/ (/ (/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ )/ ,/ key/ (/ kbs/ (/ )/ )/ )/ ,/ z6/ )/ )/ )/ ,/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ )/ )/ )/ ./ 规则/ 46/ ./ 〈/ Solved/ 〉/ :/ Begin/ (/ Aparam/ ,/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ z16/ )/ )/ →/ Attacker/ (/ LKerb/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ “/ 4/ ”/ ,/ encrypt/ (/ minus/ (/ minus/ (/ minus/ (/ Nb/ (/ encrypt/ (/ (/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ ,/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ )/ key/ (/ kbs/ (/ )/ )/ )/ ,/ z6/ )/ )/ )/ )/ ,/ Akey/ (/ (/ host/ (/ key/ (/ kas/ (/ )/ )/ )/ ,/ host/ (/ key/ (/ kbs/ (/ )/ )/ )/ ,/ Na/ (/ z16/ )/ )/ ,/ z2/ )/ )/ )/ )/ ./ 规则/ 4/ 是/ 安全/ 协议/ 模型/ 中/ 的/ 初始/ 规则/ ,/ 描述/ 的/ 是/ 协议/ 中/ 的/ 第/ (/ 5/ )/ 条/ 消息/ ,/ 即/ Alice/ 将/ 收到/ 的/ Nb/ -/ 1/ 再/ 发给/ Bob/ ./ 随着/ 不动点/ 计算/ 的/ 进行/ ,/ 规则/ 4/ 逐步/ 消除/ 前件/ 中/ 的/ 目标/ 而/ 变成/ 规则/ 37/ ./ 非解/ 形式/ 规则/ 37/ 与/ 解/ 形式/ 规则/ 43/ 进行/ X/ -/ 消解/ 得到/ 解/ 形式逻辑/ 规则/ 45/ ,/ 规则/ 45/ 继续/ 与/ 规则/ 37/ 进行/ X/ -/ 消解/ 得到/ 解/ 形式/ 规则/ 46/ ./ 而/ 规则/ 46/ 的/ 逻辑/ 后件/ 是/ 规则/ 45/ 的/ 逻辑/ 后件/ 的/ 循环/ 目标/ ,/ 规则/ 45/ 的/ 逻辑/ 后件/ 是/ 规则/ 43/ 的/ 逻辑/ 后件/ 的/ 循环/ 目标/ ./ 事实上/ ,/ 规则/ 37/ 还/ 能/ 继续/ 和/ 规则/ 46/ 进行/ X/ -/ 消解/ 生成/ 新/ 的/ 解/ 形式逻辑/ 规则/ ,/ 且/ 新/ 规则/ 的/ 逻辑/ 后件/ 是/ 规则/ 46/ 的/ 逻辑/ 后件/ 的/ 循环/ 目标/ ./ 这个/ 过程/ 会/ 一直/ 进行/ 下去/ 而/ 不断/ 地/ 生成/ 新/ 的/ 解/ 形式/ 规则/ ./ 事实上/ ,/ 这些/ 规则/ 的/ 逻辑/ 后件/ 都/ 是/ 规则/ 4/ 的/ 逻辑/ 后件/ 的/ 具体/ 实例/ ./ 根据/ 本文/ 的/ 预测/ 算法/ ,/ NS/ 协议/ 的/ 解/ 形式/ 不动点/ 的/ 计算/ 过程/ 不/ 停机/ ,/ 并且/ 标记/ 为/ 4/ 的/ 第/ 4/ 条/ 逻辑/ 规则/ 是/ 模型/ 中/ 导致/ 解/ 形式/ 不动点/ 计算/ 过程/ 不/ 停机/ 的/ 逻辑/ 规则/ ./ 6/ 结束语/ 借鉴/ 文献/ [/ 13/ ]/ 中/ 一般/ 逻辑程序/ 停机/ 性/ 刻画/ 的/ 动态/ 方法/ ,/ 本文/ 给出/ 了/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 计算/ 不/ 停机/ 性/ 的/ 预测/ 算法/ ,/ 该/ 算法/ 为/ 验证/ 工具/ 自动/ 选择/ 精确/ 验证/ 或/ 抽象/ 验证/ 提供/ 了/ 依据/ ./ 停机/ 性/ 算法/ 同时/ 能/ 定位/ 模型/ 中/ 导致/ 解/ 形式/ 不动点/ 无穷/ 计算/ 的/ 逻辑/ 规则/ ,/ 在/ 这种/ 精确定位/ 的/ 帮助/ 下/ ,/ 可/ 对/ 协议/ 进行/ 局部/ 抽象/ 验证/ ,/ 即/ 只/ 对/ 造成/ 不/ 停机/ 原因/ 的/ 规则/ 进行/ 抽象/ ,/ 而/ 其他/ 规则/ 不/ 进行/ 抽象/ ./ 局部/ 抽象/ 验证/ 模型/ 更/ 接近/ 精确/ 模型/ ,/ 因而/ 可以/ 有效/ 地/ 减少/ 抽象/ -/ 精化/ 迭代/ 的/ 次数/ ./ 相关/ 实验/ 结果表明/ 了/ 本文/ 提出/ 的/ 预测/ 算法/ 是/ 实用/ 、/ 高效/ 的/ ./ 进一步/ 的/ 研究/ 工作/ 包括/ :/ 继续/ 深入研究/ 安全/ 协议/ Horn/ 逻辑/ 扩展/ 模型/ 解/ 形式/ 不动点/ 停机/ 性/ 的/ 动态/ 刻画/ 方法/ ,/ 最终/ 给出/ 不动点/ 计算/ 不/ 终止/ 的/ 充要条件/ ;/ 研究/ 反例/ 构造/ 的/ 启发式/ 算法/ ,/ 尽量减少/ 组合/ 爆炸/ ;/ 对/ 实用/ 安全/ 协议/ (/ 如/ Kerberos/ 协议/ 等/ )/ 进行/ 验证/ ./ 

