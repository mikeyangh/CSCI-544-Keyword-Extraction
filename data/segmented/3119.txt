Page1Camellia/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 研究/ 赵新杰/ 王韬/ 郑媛媛/ (/ 军械/ 工程学院/ 计算机/ 工程系/ 石家庄/ 050003/ )/ 摘要/ Camellia/ 是/ NESSIE/ 计划/ 中/ 128/ 位/ 分组/ 密码/ 的/ 最终/ 获胜者/ ./ 现有/ 的/ 针对/ Camellia/ 的/ Cache/ 计时/ 攻击/ 大多/ 基于/ 时序/ 驱动/ 模型/ ,/ 需/ 百万计/ 的/ 样本/ 在/ 几十分钟/ 内/ 完成/ ./ 文中/ 研究/ 表明/ ,/ 由于/ 频繁/ 的/ 查找/ 表/ 操作/ ,/ Camellia/ 对/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 也/ 是/ 脆弱/ 的/ ,/ 攻击/ 所/ 需/ 样本量/ 比/ 时序/ 驱动/ 要/ 小/ ./ 首先/ ,/ 基于/ 访问/ 驱动/ 方式/ ,/ 给出/ 了/ 一种/ 通用/ 的/ 针对/ 对称/ 密码/ S/ 盒/ 的/ 分析模型/ ,/ 指出/ Camellia/ 加密/ 过程/ 中/ 的/ 轮/ 函数/ 易/ 泄露/ 初始/ 密钥/ 和/ 轮/ 密钥/ 的/ 异或/ 结果/ 值/ ,/ 密钥/ 扩展/ 中/ 的/ 左移/ 函数/ 使得/ Camellia/ 安全性/ 大大降低/ ./ 然后/ ,/ 给出/ 了/ 多例/ 针对/ Camellia/ -/ 128/ // 192/ // 256/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ,/ 实验/ 结果表明/ :/ 500/ 和/ 900/ 个/ 随机/ 明文/ 样本/ 可/ 恢复/ Camellia/ -/ 128/ 、/ Camellia/ -/ 192/ // 256/ 密钥/ ,/ 文中/ 的/ 攻击/ 可/ 被/ 扩展/ 到/ 针对/ 已知/ 密文/ 条件/ 下/ 的/ 解密/ 过程/ 或/ 远程/ 环境/ 中/ 进行/ 实施/ ,/ 3000/ 个/ 随机/ 明文/ 可/ 在/ 局域网/ 和/ 校园网/ 环境/ 下/ 恢复/ Camellia/ -/ 128/ // 192/ // 256/ 密钥/ ./ 最后/ ,/ 分析/ 了/ Camellia/ 易/ 遭受/ Cache/ 计时/ 攻击/ 的/ 原因/ ,/ 并/ 为/ 密码/ 设计者/ 提出/ 了/ 防御/ 该/ 攻击/ 的/ 一些/ 有效/ 措施/ ./ 关键词/ Camellia/ -/ 128/ // 192/ // 256/ ;/ 分组/ 密码/ ;/ 访问/ 驱动/ ;/ Cache/ 计时/ 攻击/ ;/ 旁路/ 攻击/ ;/ 远程/ 攻击/ ;/ F/ 函数/ ;/ 查找/ S/ 盒/ ;/ 左/ 1/ 引言/ 1.1/ 相关/ 工作/ 近来/ ,/ 随着/ 旁路/ 攻击/ 的/ 引入/ ,/ 各类/ 密码/ 算法/ 均/ 面临/ 严峻/ 威胁/ ./ 传统/ 来说/ ,/ 密码/ 算法/ 的/ 安全性/ 取决于/ 数学/ 函数/ EK/ [/ P/ ]/ →/ C/ ,/ 攻击者/ 试图/ 根据/ 明文/ 或/ 密文/ 信息/ ,/ 利用/ 线性/ 和/ 差分/ 数学分析/ 方法/ 去/ 推测/ 密钥/ K/ ./ 随着/ 密钥/ 长度/ 和/ 设计/ 复杂度/ 的/ 增加/ ,/ 密码/ 算法/ 的/ 安全性/ 得到/ 了/ 很大/ 提升/ ,/ 传统/ 的/ 数学分析/ 已/ 远远/ 不能/ 在/ 有效/ 时间/ 和/ 空间/ 复杂度/ 内/ 完成/ 攻击/ ./ 然而/ ,/ 最近/ 的/ 研究/ 表明/ 在/ 密码/ 算法/ 的/ 执行/ 过程/ 中/ ,/ 可能/ 会/ 泄露/ 出/ 执行/ 时间/ 、/ 能量消耗/ 、/ 电磁/ 泄露/ 、/ 故障/ 输出/ 等/ 物理/ 效应/ 信息/ ,/ 通常/ 称之为/ 旁路/ 信息/ ./ 实际上/ ,/ 确切/ 的/ 密码/ 算法/ 实现/ 函数/ 应该/ 为/ EK/ [/ P/ ]/ →/ (/ C/ ,/ L/ )/ ,/ 旁路/ 信息/ L/ 和/ 加解密/ 密钥/ K/ 紧密/ 相关/ ,/ 通过/ 一定/ 的/ 分析方法/ ,/ 结合/ 明文/ 或/ 密文/ ,/ 攻击者/ 可/ 快速/ 推测/ 出/ 密钥/ K/ ./ 本文/ 所/ 描述/ 攻击/ 用到/ 的/ 是/ 通过/ 数据/ Cache/ 部件/ 单元/ 泄露/ 出来/ 的/ 时间/ 旁路/ 信息/ ./ Cache/ 计时/ 攻击/ 是/ 一种/ 新/ 的/ 旁路/ 攻击/ 方法/ ,/ 其/ 可行性/ 首先/ 由/ Kocher/ [/ 1/ ]/ 和/ Kelsey/ 等/ [/ 2/ ]/ 在/ 1996/ 年/ 提出/ ,/ 其/ 假定/ 攻击者/ 可以/ 通过/ 一个/ 合法/ 的/ 用户/ 来/ 测量/ 时间/ 信息/ 进而/ 预测/ Cache/ 访问信息/ ,/ 而/ 这些/ 条件/ 在/ 现实/ 中/ 往往/ 是/ 可行/ 的/ ./ Page/ [/ 3/ ]/ 等/ 在/ 2002/ 年/ 仿真/ 实现/ 了/ 针对/ DES/ 的/ Cache/ 计时/ 攻击/ ;/ 随后/ ,/ Tsunoo/ 等/ [/ 4/ -/ 5/ ]/ 等/ 提出/ 了/ 首例/ 实际/ 的/ 针对/ DES/ 和/ Camellia/ 的/ Cache/ 攻击/ ;/ 2004/ 年/ Yoshitaka/ [/ 6/ ]/ 等/ 对/ Tsunoo/ 攻击/ 进行/ 了/ 改进/ ;/ 2005/ 年/ Bernstein/ [/ 7/ ]/ 与/ Osvik/ ,/ Shamir/ 和/ Tromer/ [/ 8/ -/ 9/ ]/ 两个/ 小组/ 在/ 各自/ 的/ 研究/ 中/ 发现/ ,/ AES/ 也/ 易/ 遭受/ Cache/ 计时/ 攻击/ ,/ 这/ 极大/ 地/ 引发/ 了/ 密码界/ 对/ Cache/ 计时/ 攻击/ 研究/ 的/ 热情/ ,/ 后续/ 的/ 研究/ 有/ 对/ 前人/ 攻击/ 验证/ [/ 10/ -/ 11/ ]/ 、/ 攻击/ 改进/ [/ 12/ -/ 15/ ]/ 、/ 攻击/ 防御/ [/ 16/ -/ 18/ ]/ ./ 目前/ 的/ Cache/ 计时/ 攻击/ 主要/ 针对/ DES/ 和/ AES/ ,/ 防御/ 方法/ 也/ 主要/ 定位/ 在/ 密码/ 算法/ 实现/ 过程/ 中/ ,/ 只有/ Tsunoo/ [/ 5/ ]/ 和/ Yoshitaka/ [/ 6/ ]/ 对/ Camellia/ -/ 128/ 进行/ 了/ Cache/ 计时/ 攻击/ 研究/ ./ 在/ Tsunoo/ 攻击/ 中/ ,/ 从/ 228/ 个/ 随机/ 明文/ 中/ 挑选出/ 218/ 个/ 加密/ 时间/ 较/ 短/ 的/ 样本/ ,/ 经/ 35/ 分钟/ 左右/ 分析/ 后/ 恢复/ Camellia/ -/ 128/ 密钥/ ./ Yoshitaka/ 在/ Tsunoo/ 攻击/ 基础/ 上/ ,/ 使用/ 221.4/ 个/ 明文/ 22/ 分钟/ 左右/ 成功/ 恢复/ Camellia/ -/ 128/ 密钥/ ,/ 上述/ 两例/ 攻击/ 都/ 是/ 通过/ 测量/ 整个/ 加密/ 时间/ 并/ 分析/ 密码/ 某次/ 查/ S/ 盒/ 运算/ 中/ Cache/ 访问/ 碰撞/ 带来/ 的/ 时间/ 关系/ 推断/ 密钥/ ,/ 攻击/ 属于/ 时序/ 驱动/ 方式/ ,/ 一般/ 需/ 百万计/ 的/ 样本/ 恢复/ 密钥/ ,/ 而且/ 在/ 远程/ 攻击/ 条件/ 下/ ,/ 即使/ 是/ 传输/ 时延/ 的/ 抖动/ 时间/ 都/ 要/ 远大于/ 整个/ 加密/ 时间/ ,/ 所以/ 他们/ 的/ 攻击/ 在/ 真正/ 远程/ 环境/ 中/ 很/ 难/ 实现/ ./ 本文/ 提出/ 了/ 多例/ 针对/ Camellia/ -/ 128/ // 192/ // 256/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ,/ 使用/ 了/ 一个/ 间谍/ 程序/ 来/ 采集/ Camellia/ 加密/ 中/ 访问/ 的/ Cache/ 组/ 集合/ 信息/ ,/ 经/ 一定/ 的/ 分析/ 来/ 预测/ 密钥/ ,/ 实验/ 结果表明/ ,/ 无论是/ 已知/ 明文/ 、/ 已知/ 密文/ 、/ 本地/ 和/ 远程/ 条件/ 下/ ,/ 针对/ Camellia/ -/ 128/ // 192/ // 256/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 都/ 可/ 在/ 3000/ 样本量/ 以内/ 经/ 1/ 秒钟/ 的/ 分析/ 完成/ ,/ 攻击/ 对象/ 为/ 2009/ 年/ 7/ 月/ 最新/ 发布/ 的/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta3/ 中/ 的/ Camellia/ 算法/ 实现/ ./ 1.2/ 本文/ 的/ 贡献/ 本文/ 研究/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 给出/ 了/ 一种/ 通用/ 的/ 针对/ 使用/ S/ 盒/ 的/ 对称/ 密码/ 的/ 访问/ 驱动/ Cache/ 计时/ 分析模型/ ./ 该/ 模型/ 可/ 被/ 应用/ 到/ AES/ 、/ SMS4/ 、/ Camellia/ 、/ ARIA/ 、/ HC/ -/ 128/ 、/ HC/ -/ 256/ 等/ 使用/ S/ 盒/ 的/ 对称/ 密码/ 攻击/ 中/ ,/ 并且/ 可/ 用于/ 对/ 这些/ 算法/ 抗/ Cache/ 计时/ 攻击能力/ 进行/ 评估/ 测试/ ./ (/ 2/ )/ 指出/ Camellia/ 的/ F/ 轮/ 函数/ 可能/ 会/ 泄露/ 密钥/ 相关/ 信息/ ./ Camellia/ 的/ F/ 函数/ 中/ 进行/ 了/ 多次/ 查表/ 操作/ ,/ 查表/ 索引/ 值/ 和/ 初始/ 密钥/ 、/ 扩展/ 密钥/ 紧密/ 相关/ ,/ 经/ 访问/ 驱动/ Cache/ 计时/ 分析/ 可/ 获取/ 这些/ 相关/ 密钥/ 信息/ ,/ 具体来说/ ,/ 加密/ 中/ 的/ F/ 函数/ 可/ 泄露/ 初始/ 密钥/ 和/ 扩展/ 密钥/ 的/ 异或/ 结果/ 值/ ,/ 而/ 密钥/ 扩展/ 中/ 的/ F/ 轮/ 函数/ 则/ 可/ 直接/ 泄露/ 初始/ 密钥/ 或/ 扩展/ 密钥/ 值/ ./ (/ 3/ )/ Camellia/ 密钥/ 扩展/ 中/ 使用/ 的/ 左移/ 函数/ 使得/ Camellia/ 安全性/ 大大降低/ ./ 攻击者/ 如果/ 找到/ 对/ 同一/ 密钥/ 相关/ 变量/ 左移/ 前/ 和/ 左移/ 后/ 的/ 一个/ 异或/ 碰撞/ ,/ 就/ 很/ 容易/ 恢复/ 该/ 变量值/ ,/ 然后/ 结合/ 算法/ 设计/ 快速/ 破解/ 密钥/ ./ 本文/ 实验/ 结果表明/ 仅仅/ 通过/ 分析/ Camellia/ -/ 128/ 密钥/ 扩展/ 中/ 一个/ 初始/ 密钥/ 相关/ 的/ 左移/ 15/ 位/ 函数/ 就/ 可/ 将/ 其/ 搜索/ 空间/ 由/ 2128/ 降低/ 到/ 2/ ./ Camellia/ -/ 192/ // 256/ 的/ 密钥/ 扩展/ 设计/ 也/ 存在/ 缺陷/ ,/ 其/ 第/ 3/ 、/ 4/ 轮/ 和/ 第/ 5/ 、/ 6/ 轮/ 扩展/ 密钥/ 分别/ 根据/ 对/ KA/ 和/ KR/ 左移/ 15/ 位/ 生成/ ,/ 通过/ 对/ Camellia/ 加密/ Page3/ 前/ 6/ 轮/ 进行/ Cache/ 计时/ 攻击/ ,/ 可/ 直接/ 获取/ 密钥/ 扩展/ 第/ 5/ 个/ F/ 函数/ 的/ 输入/ 值/ KA/ / KR/ ,/ 然后/ 得到/ 密钥/ 扩展/ 第/ 6/ 个/ F/ 函数/ 的/ 输出/ 值/ KB/ ,/ 经/ 进一步/ 分析/ ,/ 可/ 直接/ 获取/ Camellia/ -/ 192/ // 256/ 初始/ 密钥/ ./ (/ 4/ )/ 提出/ 并/ 实现/ 了/ 多例/ 针对/ Camellia/ -/ 128/ // 192/ // 256/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ./ 本文/ 设计/ 实现/ 了/ 多例/ 针对/ Camellia/ -/ 128/ // 192/ // 表/ 1/ 针对/ Camellia/ 的/ Cache/ 计时/ 攻击/ 结果/ 比较/ 文献/ [/ 5/ ]/ 给出/ 的/ 攻击/ 文献/ [/ 6/ ]/ 给出/ 的/ 攻击/ 第/ 4/ 节/ 给出/ 的/ 攻击/ 第/ 6/ 节/ 给出/ 的/ 攻击/ 第/ 7/ 节/ 给出/ 的/ 攻击/ 第/ 5/ 节/ 给出/ 的/ 攻击/ 第/ 6/ 节/ 给出/ 的/ 攻击/ 第/ 7/ 节/ 给出/ 的/ 攻击/ (/ 5/ )/ 探讨/ 了/ 针对/ Camellia/ 的/ 访问/ 驱动/ Cache/ 计/ 66444666/ 时/ 攻击/ 原因/ 并/ 给出/ 了/ 可能/ 的/ 防御/ 措施/ ./ 针对/ Camellia/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 根本原因/ 在于/ Camellia/ 算法/ 自身/ ,/ 其/ F/ 函数/ 和/ 密钥/ 设计/ 存在/ Cache/ 计时/ 信息/ 泄露/ 安全/ 缺陷/ ,/ 并/ 可/ 用于/ 快速/ 恢复/ 密钥/ ./ 因此/ ,/ 本文/ 在/ 第/ 8/ 节/ 探讨/ 了/ 密码/ 设计者/ 如何/ 提高/ Camellia/ 抗/ Cache/ 计时/ 攻击/ 的/ 能力/ ./ 1.3/ 结构/ 组织/ 本文/ 第/ 2/ 节/ 给出/ 了/ 针对/ Camellia/ 的/ Cache/ 计时/ 攻击/ 相关/ 背景/ 知识/ ;/ 第/ 3/ 节/ 提出/ 了/ 基本/ 的/ 攻击/ 模型/ ,/ 并/ 阐述/ 了/ 如何/ 将/ 该/ 模型/ 应用/ 到/ Camellia/ 的/ F/ 函数/ 分析/ 中/ ;/ 第/ 4/ 小节/ 和/ 第/ 5/ 小节/ 分别/ 给出/ 了/ 针对/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 的/ 已知/ 明文/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ;/ 第/ 6/ 和/ 第/ 7/ 小节/ 分别/ 给出/ 了/ 已知/ 密文/ 和/ 远程/ 条件/ 下/ 的/ Camellia/ 攻击/ ;/ 第/ 8/ 小节/ 对/ 针对/ Camellia/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 进行/ 了/ 讨论/ 分析/ ,/ 并/ 向/ 密码/ 设计者/ 提出/ 了/ 防御/ 该类/ 攻击/ 的/ 一些/ 可能/ 防护/ 措施/ ;/ 第/ 9/ 节为/ 结束语/ ./ 2/ 相关/ 知识/ 2.1/ 符号/ 标记/ / :/ 异或/ 操作/ ./ ‖/ :/ 两个/ 变量/ 的/ 连接/ ./ </ </ </ n/ :/ 左移/ n/ 位/ ./ S1/ ,/ S2/ ,/ S3/ ,/ S4/ :/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta3/ 中/ Camellia/ 实现/ 中/ 的/ 4/ 个/ S/ 盒/ ,/ 分别/ 对应/ 其中/ 的/ SBOX1/ _/ 1110/ ,/ SBOX2/ _/ 0222/ ,/ SBOX3/ _/ 3033/ ,/ SBOX4/ _/ 4404.256/ 的/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ,/ 实验/ 结果表明/ ,/ 即使/ 是/ 使用/ 了/ 混淆/ 层/ 函数/ FL/ // FL/ -/ 1/ 的/ Camellia/ 算法/ ,/ 实现/ 也/ 易/ 遭受/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ,/ 攻击/ 可/ 被/ 扩展/ 至/ 已知/ 密文/ 甚至/ 是/ 远程/ 环境/ 条件/ 下/ ,/ 3000/ 个/ 样本/ 左右/ 可/ 在/ 局域网/ 或/ 校园网/ 环境/ 下/ 快速/ 恢复/ Camelia/ -/ 128/ // 192/ // 256/ 密钥/ ./ 表/ 1/ 给出/ 了/ 本文/ 攻击/ 结果/ 同/ 前人/ 攻击/ 比较/ ./ XL/ ,/ XR/ :/ 128/ 位/ 变量/ X/ 的/ 左半/ 部分/ 和/ 右半/ 部分/ 数据/ ./ K/ ,/ KE/ :/ Camellia/ 加解密/ 初始/ 密钥/ 和/ 扩展/ 密钥/ ./ sri/ :/ 第/ r/ 轮/ F/ 函数/ 的/ 第/ i/ 个/ 32/ 位/ 输入/ ./ δ/ :/ 一个/ Cache/ 块/ 中/ 的/ Cache/ 元素/ 数量/ ./ 2.2/ Cache/ 计时/ 攻击/ Cache/ 计时/ 攻击/ 主要/ 利用/ 从/ Cache/ 中/ 加载/ 数据/ 到/ CPU/ 寄存器/ 要/ 比/ 从/ RAM/ 中要/ 快/ 的/ 特性/ 进行/ 密码/ 分析/ ./ 通过/ 测量/ 密码/ 算法/ 实现/ 过程/ 中/ 由于/ Cache/ 访问/ 带来/ 的/ 时间/ 差异/ 信息/ ,/ 攻击者/ 可以/ 推测/ 密码/ 算法/ 实现/ 的/ 内部/ 状态/ 信息/ ./ 下面/ ,/ 我们/ 将/ 阐述/ Cache/ 成为/ 计时/ 旁路/ 攻击/ 隐/ 通道/ 的/ 原理/ ./ Cache/ 工作/ 机制/ 现代/ 微处理器/ 大都/ 使用/ 高速缓存/ Cache/ 来/ 解决/ CPU/ 与/ 主存/ 之间/ 速度/ 不/ 匹配/ 问题/ ./ 假设/ 整个/ Cache/ 包括/ S/ 个/ Cache/ 组/ ,/ 每个/ 组有/ W/ 个/ Cache/ 行/ ,/ 每个/ 行有/ δ/ 个/ 元素/ (/ B/ 字节/ )/ ,/ 则/ 整个/ Cache/ 大小/ 为/ S/ ×/ W/ ×/ B/ 字节/ ./ 主存/ 地址/ 和/ Cache/ 之间/ 的/ 映射/ 关系/ 如下/ :/ 特征/ 1/ ./ CPU/ 读取/ 主存/ 中/ 一个/ 字/ A/ 时/ ,/ 首先/ 将/ A/ 地址/ 放入/ 主存/ 地址/ 寄存器/ ,/ Cache/ 控制/ 逻辑/ 依据/ 地址/ 判断/ A/ 当前/ 是否/ 在/ Cache/ 中/ ,/ 如果/ 是/ 则/ 地址变换/ 成功/ ,/ 发生/ “/ Cache/ 命中/ ”/ ;/ 否则/ 发生/ “/ Cache/ 失效/ ”/ ,/ 把/ 包括/ A/ 在内/ 的/ 一整块/ 数据/ 都/ 从/ 主存/ 中/ 读出来/ ,/ 装载/ 到/ Cache/ 中去/ ./ 特征/ 2/ ./ 在/ 组/ 相连/ Cache/ 中/ ,/ 每/ 一个/ 主存/ 块/ 只能/ 被/ 映射/ 到/ 固定/ 的/ Cache/ 组中/ ,/ 具体来说/ ,/ Cache/ 地址/ 为/ a/ 的/ 内存/ 块/ 只能/ 被/ 映射/ 到/ Cache/ 组/ [/ a/ // B/ ]/ mod/ // S/ 中/ ./ Page4/ 由/ 特征/ 1/ 可知/ 同样/ 一条/ 访问/ 存储器/ 的/ 指令/ 在/ 目标/ 数据/ 不/ 在/ Cache/ 内需/ 访问/ 主存/ 时/ 就/ 可能/ 产生/ 延迟/ ,/ 而/ 这种/ 延迟/ 的/ 表现/ 就是/ 程序/ 较长/ 的/ 运行/ 时间/ 或/ 较大/ 的/ 能量消耗/ ,/ 就/ 典型/ 处理器/ 来说/ ,/ “/ Cache/ 命中/ ”/ 时/ 直接/ 访问/ Cache/ 需要/ 2/ ~/ 4/ 个/ 时钟/ 周期/ ,/ 而/ “/ Cache/ 失效/ ”/ 时/ 访问/ 主存/ 则/ 需要/ 12/ ~/ 100/ 时钟/ 周期/ ,/ 因此/ Cache/ 为/ 密码/ 实现/ 提供/ 了/ 时间/ 信息/ 泄露/ 源/ ./ 由/ 特征/ 2/ 可知/ ,/ 不同/ 进程/ 在/ 对/ 自身/ 数据/ 进行/ 内存/ 访问/ 时/ ,/ 这些/ 数据/ 可以/ 被/ 映射/ 到/ 同一/ Cache/ 组中/ 进而/ 共享/ Cache/ 存储空间/ ,/ 恶意/ 进程/ 可以/ 通过/ 对/ 自身/ 数据/ Cache/ 访问/ 时间/ 或者/ 能量消耗/ 差异/ 来/ 监测/ 其它/ 进程/ 的/ Cache/ 组/ 访问/ 特征/ ,/ 故/ Cache/ 也/ 为/ 密码/ 实现/ 提供/ 了/ 时间/ 信息/ 泄露/ 隐/ 通道/ ./ 据/ 上/ 可知/ ,/ 攻击者/ 可能/ 获取/ 到/ 密码/ 算法/ 实现/ 过程/ 中/ 访问/ 的/ Cache/ 组/ 集合/ 信息/ ,/ 在/ 本地/ 攻击/ 中/ ,/ 这些/ 采样/ 信息/ 噪声/ 比较/ 小/ ,/ 而/ 在/ 远程/ 攻击/ 中/ ,/ 由于/ 网络/ 发包/ 拆包/ 本身/ 要/ 对/ Cache/ 进行/ 大量/ 的/ 访问/ ,/ 带来/ 的/ 系统/ 噪声/ 比较/ 大/ ,/ 但/ 通过/ 多次/ 采集/ 或/ 增加/ 样本/ 数量/ ,/ 仍/ 可/ 获取/ 有效/ 的/ Cache/ 采样/ 信息/ ./ 需要/ 注意/ 的/ 是/ ,/ 虽然/ Cache/ 内容/ 受/ 存储器/ 保护/ ,/ 攻击者/ 无法/ 直接/ 获取/ ,/ 但/ 其元/ 数据/ 会/ 泄露/ Cache/ 访问/ 地址/ 信息/ ,/ 而/ 这些/ 地址/ 信息/ 和/ 分组/ 密码/ 查找/ S/ 盒/ 索引/ 有/ 密切关系/ ,/ 可/ 被/ 攻击者/ 用来/ 进行/ 密码/ 分析攻击/ 分类/ 及/ 可行性/ 分析/ 根据/ 计时/ 攻击/ 部件/ 不同/ ,/ 可/ 将/ Cache/ 计时/ 攻击/ 分为/ 针对/ 数据/ Cache/ 、/ 指令/ Cache/ 两种/ ./ 由于/ 现代/ 分组/ 密码/ 大多/ 使用/ S/ 盒/ 查找/ 表/ 访问/ 数据/ Cache/ ,/ 所以/ 目前/ 利用/ 数据/ Cache/ 进行/ 攻击/ 的/ 对象/ 主要/ 为/ 分组/ 密码/ ;/ 同样/ ,/ 现代/ 公钥/ 加密/ 系统/ 大都/ 使用/ 了/ 大量/ 的/ 指令/ 访问/ 操作/ ,/ 其/ 加解密/ 过程/ 中/ 由于/ 密钥/ 位值/ 不同/ 所/ 要/ 进行/ 的/ 指令/ 访问/ 操作/ 数目/ 有/ 很大/ 的/ 区别/ ,/ 此时/ 会/ 导致/ 对/ 指令/ Cache/ 访问/ 次数/ 及/ 时间/ 存在/ 很大/ 区别/ ,/ 所以/ 目前/ 利用/ 指令/ Cache/ 的/ 攻击/ 对象/ 主要/ 是/ 公钥/ 加密/ 系统/ ./ 根据/ 所/ 采集/ 的/ 时间/ 信息/ 不同/ ,/ 又/ 可/ 将/ Cache/ 计时/ 攻击/ 分为/ 时序/ 驱动/ 、/ 访问/ 驱动/ 、/ 踪迹/ 驱动/ 3/ 种/ 方式/ ./ 时序/ 驱动/ 攻击/ 采集/ 的/ 是/ 密码/ 进程/ 整个/ 加解密/ 时间/ ,/ 采集/ 方法/ 简单/ ,/ 平台/ 适用性/ 强/ ,/ 但/ 所/ 需/ 样本量/ 大/ ,/ 一般/ 都/ 要/ 百万计/ ,/ 离线/ 分析方法/ 比较复杂/ ./ 更/ 重要/ 的/ 是/ ,/ 在/ 远程/ 环境/ 中/ ,/ 网络/ 传输/ 时延/ 甚至/ 是/ 抖动/ 时延/ 都/ 要/ 远大于/ 加密/ 时间/ ,/ 采集/ 到/ 精确/ 的/ 加密/ 时间/ 显得/ 极为/ 困难/ ,/ 远程/ 攻击/ 适用性/ 不强/ ./ 访问/ 驱动/ 攻击/ 主要/ 利用/ 间谍/ 进程/ 采集/ 密码/ 进程/ 加解密/ 中/ 访问/ 的/ Cache/ 组/ 集合/ 信息/ ,/ 采集/ 方法/ 比/ 时序/ 驱动/ 稍显/ 复杂/ ,/ 但/ 分析方法/ 比较简单/ ,/ 在/ 木马/ 植入/ 技术/ 日趋/ 成熟/ 的/ 今天/ ,/ 攻击/ 本地/ 和/ 远程/ 实现/ 可行性/ 比较/ 强/ ./ 踪迹/ 驱动/ 攻击/ 比/ 访问/ 驱动/ 攻击/ 信息/ 采集/ 精度/ 更高/ ,/ 攻击/ 方需/ 精确/ 采集/ 密码/ 进程/ 一次/ 加解密/ 过程/ 中/ 每次/ 查表/ Cache/ 访问/ 的/ 命中/ 和/ 失效/ 信息/ ,/ 通过/ 计时/ 手段/ 很难/ 实现/ ,/ 一般/ 都/ 通过/ 功耗/ 检测/ 手段/ 进行/ ,/ 需/ 物理/ 接触/ 密码/ 设备/ ,/ 因此/ 攻击/ 不论/ 在/ 本地/ 还是/ 远程/ 通过/ 计时/ 实现/ 可行性/ 都/ 不强/ ./ 基于/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 的/ 可行性/ :/ 我们/ 选择/ 访问/ 驱动/ 作为/ 攻击/ 模型/ ,/ Camellia/ 分组/ 密码/ 作为/ 攻击/ 对象/ ,/ 显然/ ,/ 攻击/ 属于/ 数据/ Cache/ 计时/ 攻击/ ./ 2.3/ Camellia/ 算法/ Camellia/ [/ 19/ ]/ 是/ 由/ NTT/ 和/ Mitsubishi/ 电子/ 公司/ 在/ 2000/ 年/ 联合/ 提交/ 的/ 一个/ 分组/ 密码/ ,/ 在/ 2003/ 年/ 被/ 选择/ 成为/ 欧洲/ NESSIE/ 计划/ 的/ 获胜者/ ,/ 2009/ 年/ 3/ 月/ ,/ Camellia/ 被/ 集成/ 到/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta1/ [/ 20/ ]/ 密码/ 库中/ ,/ 对/ Camellia/ 算法/ 的/ 完整/ 介绍/ 可/ 参考文献/ [/ 19/ ,/ 21/ ]/ ,/ 下面/ 仅/ 对/ 本文/ 中/ 用到/ 的/ Camellia/ 特性/ 进行/ 描述/ ./ 加密/ 过程/ ./ Camellia/ 是/ 一个/ 迭代/ 型/ 分组/ 密码/ ,/ 分组/ 长度/ 为/ 128/ 比特/ ,/ 支持/ 128/ 、/ 192/ 和/ 256/ 比特/ 3/ 种/ 规模/ 的/ 密钥/ 长度/ ,/ 采用/ Feistel/ 整体/ 结构/ ./ 为/ 提高/ 安全性/ ,/ 在/ 第/ 1/ 轮前/ 和/ 最后/ 一轮/ 后/ 分别/ 做/ 前期/ 和/ 后期/ 白化/ ,/ 即子/ 密钥/ 加/ ,/ 同时/ 每隔/ 6/ 轮/ 增加/ 一个/ 不规则/ 轮/ ,/ 即/ FL/ // FL/ -/ 1/ 混淆/ 函数/ 层/ ./ 设/ Lr/ 和/ Rr/ 为/ 第/ r/ 轮/ 的/ 输入/ ,/ 则/ 轮/ 变换/ 可/ 表示/ 为/ 其中/ kr/ 为/ 第/ r/ 轮/ 的/ 子/ 密钥/ ,/ F/ =/ P/ ·/ S/ 为/ 轮/ 函数/ ,/ S/ 和/ P/ 定义/ 如下/ :/ S/ :/ F642/ →/ F64l1/ (/ 8/ )/ ‖/ l2/ (/ 8/ )/ ‖/ l3/ (/ 8/ )/ ‖/ l4/ (/ 8/ )/ ‖/ l5/ (/ 8/ )/ ‖/ l6/ (/ 8/ )/ ‖/ l7/ (/ 8/ )/ ‖/ l8/ (/ 8/ )/ →/ l1/ (/ 8/ )/ ‖/ l2/ (/ 8/ )/ ‖/ l3/ (/ 8/ )/ ‖/ l4/ (/ 8/ )/ ‖/ l5/ (/ 8/ )/ ‖/ l6/ (/ 8/ )/ ‖/ l7/ (/ 8/ )/ ‖/ l8/ (/ 8/ )/ l1/ =/ s1/ (/ l1/ )/ ,/ l2/ =/ s2/ (/ l2/ )/ ,/ l3/ =/ s3/ (/ l3/ )/ ,/ l4/ =/ s4/ (/ l4/ )/ ,/ l5/ =/ s2/ (/ l5/ )/ ,/ l6/ =/ s3/ (/ l6/ )/ ,/ l7/ =/ s4/ (/ l7/ )/ ,/ l8/ =/ s1/ (/ l8/ )/ ./ 2/ →/ F64P/ :/ F64z1/ (/ 8/ )/ ‖/ z2/ (/ 8/ )/ ‖/ z3/ (/ 8/ )/ ‖/ z4/ (/ 8/ )/ ‖/ z5/ (/ 8/ )/ ‖/ z6/ (/ 8/ )/ ‖/ z7/ (/ 8/ )/ ‖/ z8/ (/ 8/ )/ →/ z1/ (/ 8/ )/ ‖/ z2/ (/ 8/ )/ ‖/ z3/ (/ 8/ )/ ‖/ z4/ (/ 8/ )/ ‖/ z5/ (/ 8/ )/ ‖/ z6/ (/ 8/ )/ ‖/ z7/ (/ 8/ )/ ‖/ z8/ (/ 8/ )/ z1/ =/ z1/ / z3/ / z4/ / z6/ / z7/ / z8/ ,/ z2/ =/ z1/ / z2/ / z4/ / z5/ / z7/ / z8/ ,/ z3/ =/ z1/ / z2/ / z3/ / z5/ / z6/ / z8/ ,/ z4/ =/ z2/ / z3/ / z4/ / z5/ / z6/ / z7/ ,/ z5/ =/ z1/ / z2/ / z6/ / z7/ / z8/ ,/ Page5z6/ =/ z2/ / z3/ / z5/ / z7/ / z8/ ,/ z7/ =/ z3/ / z4/ / z5/ / z6/ / z8/ ,/ z8/ =/ z1/ / z4/ / z5/ / z6/ / z7/ ./ 密钥/ 扩展/ 算法/ ./ 首先/ 由/ 初始/ 种子/ 密钥/ 和/ 64/ 位/ 常量/ Σ/ i/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ 6/ )/ 经过/ 几个/ 轮/ 函数/ F/ 生成/ 4/ 个/ 128/ 位/ 变量/ KL/ 、/ KR/ 、/ KA/ 和/ KB/ ,/ 白化/ 层子/ 密钥/ kwi/ (/ 64/ )/ 、/ 普通/ 轮/ 密钥/ ki/ (/ 64/ )/ 、/ FL/ // FL/ -/ 1/ 函数/ 层子/ 密钥/ kli/ (/ 64/ )/ 均/ 由/ KL/ 、/ KR/ 、/ KA/ 和/ KB/ 循环/ 移位/ 而成/ ,/ 详见/ 文献/ [/ 19/ ]/ ./ 3/ 攻击/ 模型/ 3.1/ 通用/ 攻击/ 模型/ 现在/ 软件/ 实现/ 的/ 分组/ 密码/ 大都/ 使用/ 许多/ S/ 盒/ 查表/ 访问/ Cache/ 来/ 提高效率/ ,/ 在/ S/ 盒/ 查表/ 过程/ 中/ ,/ 常/ 满足/ 其中/ ,/ α/ 表示/ 明文/ 、/ 密文/ 或/ 中间状态/ 的/ 一部分/ ,/ 常为/ 1/ 个/ 字节/ ;/ β/ 表示/ 同/ 密钥/ 和/ 扩展/ 密钥/ 相关/ 的/ 密码/ 参量/ ;/ γ/ 表示/ 查表/ 结果/ 或/ 索引/ 值/ ;/ ⊙/ 表示/ 加密/ 查表/ α/ 和/ β/ 之间/ 的/ 逻辑/ 操作/ ,/ 常为/ 异或/ 操作/ ./ 式/ (/ 1/ )/ 可/ 转换/ 为/ 由/ 2.2/ 节/ 可知/ ,/ 攻击者/ 通过/ 访问/ 驱动/ 方式/ 采集/ Cache/ 计时/ 信息/ ,/ 可/ 获取/ 到/ 密码/ 算法/ 实现/ 过程/ 中/ 访问/ 过/ 和/ 未/ 访问/ 过/ 的/ Cache/ 组/ 集合/ ,/ 并/ 转换/ 为/ 查表/ 索引/ 或/ 结果/ γ/ ,/ 由于/ α/ 通常/ 已知/ ,/ 根据/ 式/ (/ 2/ )/ ,/ 不难/ 预测/ β/ 候选/ 值/ ,/ 进而/ 计算/ 出/ 密钥/ K/ ,/ 分析/ 过程/ 通常/ 采用/ 下列/ 策略/ ./ 策略/ 1/ ./ 分析/ 查表/ 中未/ 访问/ 过/ 的/ Cache/ 组/ 集合/ ./ 通过/ 分析/ Cache/ 组/ 集合/ 和/ S/ 盒/ 索引/ 值/ 的/ 映射/ 关系/ ,/ 未/ 访问/ 过/ 的/ Cache/ 组/ 集合/ 可/ 转化/ 为/ 不/ 可能/ 的/ 查表/ 索引/ 或/ 结果/ γ/ ,/ 结合/ α/ 和/ 式/ (/ 2/ )/ ,/ 可/ 得到/ 一组/ β/ 的/ 不/ 可能/ 候选/ 值/ ,/ 多个/ 样本/ 排除/ 分析/ 后/ 可/ 获取/ 正确/ 的/ β/ 值/ ,/ 然后/ 推断出/ 密钥/ K/ ./ 策略/ 2/ ./ 分析/ 查表/ 中/ 可能/ 访问/ 的/ Cache/ 组/ 集合/ ./ 首先/ 为/ 每个/ β/ 候选/ 值/ 设置/ 一个/ 计数器/ ,/ 然后/ 固定/ α/ 值/ ,/ 产生/ 一些/ 随机样本/ P/ 进行/ 加密/ ,/ 得到/ 加密/ 访问/ 的/ 共同/ Cache/ 组/ 信息/ ,/ 转化/ 为/ 多个/ 可能/ 的/ γ/ 候选/ 值/ ,/ 根据/ 式/ (/ 2/ )/ 得到/ β/ 的/ 多个/ 候选/ 值/ ,/ 并/ 为/ 每个/ β/ 候选/ 值/ 对应/ 计数器/ 加/ 1/ ,/ 由于/ 加密/ 密钥/ 是/ 唯一/ 的/ ,/ 正确/ 的/ β/ 值/ 每次/ 都/ 被/ 预测/ 到/ ,/ 多次/ 预测/ 后/ ,/ 出现/ 频率/ 最高/ 的/ β/ 值/ 即/ 为/ 正确/ 的/ β/ 值/ ,/ 然后/ 经/ 进一步/ 分析/ 推断出/ 密钥/ K/ ./ 由于/ 每/ 一个/ 加密/ 没有/ 访问/ 的/ Cache/ 组/ 关联/ δ/ 个/ (/ 通常/ δ/ 等于/ 16/ )/ 查表/ 索引/ 和/ 结果/ 值/ ,/ 使用/ 策略/ 1/ 时/ 每/ 一个/ 加密/ 没有/ 访问/ 的/ Cache/ 组可/ 排除/ δ/ 个/ β/ 候选/ 值/ ,/ 同/ 策略/ 2/ 相比/ ,/ 分析/ 效率/ 要/ 比较/ 高/ ,/ 故/ 下文/ 中/ 我们/ 主要/ 采用/ 策略/ 1/ 对/ Camellia/ 进行/ Cache/ 计时/ 分析/ ./ 3.2/ 针对/ CamelliaF/ 函数/ 的/ 攻击/ 模型/ 根据/ 2.3/ 节/ ,/ Camellia/ 每个/ F/ 函数/ 执行/ 8/ 次/ 查找/ 表/ 操作/ ,/ 对/ 4/ 种/ S/ 盒/ 分别/ 进行/ 2/ 次/ 查表/ 操作/ ./ 图/ 1/ 给出/ 了/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta3/ 中/ CamelliaF/ 函数/ 的/ C语言/ 实现/ 代码/ .#/ defineCamellia/ _/ Feistel/ (/ _/ s0/ ,/ _/ s1/ ,/ _/ s2/ ,/ _/ s3/ ,/ _/ key/ )/ do/ {/ \/ 1registeru32/ _/ t0/ ,/ _/ t1/ ,/ _/ t2/ ,/ _/ t3/ ;/ \/ 2/ \/ 3/ _/ t0/ =/ _/ s0/ / (/ _/ key/ )/ [/ 0/ ]/ ;/ \/ 4/ _/ t3/ =/ S4/ [/ _/ t0/ &/ 0xff/ ]/ ;/ \/ 5/ _/ t1/ =/ _/ s1/ / (/ _/ key/ )/ [/ 1/ ]/ ;/ \/ 6/ _/ t3/ / =/ S3/ [/ (/ _/ t0/ / 8/ )/ &/ 0xff/ ]/ ;/ \/ 7/ _/ t2/ =/ S1/ [/ _/ t1/ &/ 0xff/ ]/ ;/ \/ 8/ _/ t3/ / =/ S2/ [/ (/ _/ t0/ / 16/ )/ &/ 0xff/ ]/ ;/ \/ 9/ _/ t2/ / =/ S4/ [/ (/ _/ t1/ / 8/ )/ &/ 0xff/ ]/ ;/ \/ 10/ _/ t3/ / =/ S1/ [/ (/ _/ t0/ / 24/ )/ ]/ ;/ \/ 11/ _/ t2/ / =/ _/ t3/ ;/ \/ 12/ _/ t3/ =/ RightRotate/ (/ _/ t3/ ,/ 8/ )/ ;/ \/ 13/ _/ t2/ / =/ S3/ [/ (/ _/ t1/ / 16/ )/ &/ 0xff/ ]/ ;/ \/ 14/ _/ s3/ / =/ _/ t3/ ;/ \/ 15/ _/ t2/ / =/ S2/ [/ (/ _/ t1/ / 24/ )/ ]/ ;/ \/ 16/ _/ s2/ / =/ _/ t2/ ;/ \/ 17/ _/ s3/ / =/ _/ t2/ ;/ \/ }/ while/ (/ 0/ )/ 图/ 1OPENSSL/ -/ 1.0/ ./ 0/ -/ beta3/ 中/ CamelliaF/ 函数/ C语言/ 代码/ 假定/ 输入/ 值/ _/ s0/ ,/ _/ s1/ ,/ _/ s2/ ,/ _/ s3/ 可/ 表示/ 为/ 其中/ ,/ _/ s/ 表示/ _/ s0/ ,/ _/ s1/ ,/ _/ s2/ 或/ _/ s3/ ;/ α/ 表示/ 明文/ 或/ 已知/ 中间/ 状态变量/ ;/ β/ 1/ 和/ β/ 2/ 分别/ 表示/ 初始/ 密钥/ K/ 和/ 扩展/ 密钥/ KE/ 的/ 一个/ 字节/ ./ 根据/ 代码/ 第/ 4/ ,/ 6/ ,/ 7/ ,/ 8/ ,/ 9/ ,/ 10/ ,/ 13/ ,/ 15/ 行/ ,/ 可知/ 查找/ Sn/ 表/ 的/ 索引/ 值为/ 其中/ ,/ φ/ 函数/ 表示/ 返回/ 32/ 位值/ 的/ 第/ n/ 个/ 字节/ 值/ ./ 由于/ γ/ 的/ 不/ 可能/ 候选/ 值/ 可/ 通过/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 采集/ 阶段/ 获取/ 到/ ,/ α/ 和/ n/ 已知/ ,/ 则/ β/ 1/ / β/ 2/ 的/ 不/ 可能/ 候选/ 值/ 可以/ 被/ 预测/ 并排/ 除掉/ ,/ 使用/ 更/ 多/ 的/ 样本/ 进行/ 分析/ ,/ 正确/ 的/ β/ 1/ / β/ 2/ 可/ 被/ 获取/ 到/ ./ 4Camellia/ -/ 128/ 攻击/ 4.1/ 前/ 4/ 轮/ 攻击/ 假定/ X/ 为/ 明文/ P/ 和/ 128/ 位/ 加密/ 密钥/ K/ (/ 也/ 可表/ Page6/ 示为/ KE0/ ,/ KE1/ ,/ KE2/ ,/ KE3/ )/ 的/ 异或/ 结果/ ,/ 在/ Camellia/ 加密/ 第/ 1/ 轮/ 的/ F/ 函数/ 中/ ,/ 式/ (/ 3/ )/ 和/ (/ 4/ )/ 中/ 的/ β/ 1/ 可/ 表示/ 为/ KE0/ ,/ KE1/ ,/ 则/ 可/ 得到/ 第/ 1/ 轮/ 8/ 次/ 查表/ 索引/ γ/ 1/ =/ P0/ / KE0/ ,/ 0/ / KE4/ ,/ 0/ ,/ γ/ 1/ =/ P7/ / KE1/ ,/ 3/ / KE5/ ,/ 3/ ,/ γ/ 2/ =/ P1/ / KE0/ ,/ 1/ / KE4/ ,/ 1/ ,/ γ/ 2/ =/ P4/ / KE1/ ,/ 0/ / KE5/ ,/ 0/ ,/ γ/ 3/ =/ P2/ / KE0/ ,/ 2/ / KE4/ ,/ 2/ ,/ γ/ 3/ =/ P5/ / KE1/ ,/ 1/ / KE5/ ,/ 1/ ,/ γ/ 4/ =/ P3/ / KE0/ ,/ 3/ / KE4/ ,/ 3/ ,/ γ/ 4/ =/ P6/ / KE1/ ,/ 2/ / KE5/ ,/ 2/ 其中/ ,/ γ/ n/ 表示/ 查找/ Sn/ 的/ 查表/ 索引/ 值/ ,/ 其/ 不/ 可能/ 候选/ 值/ 可/ 通过/ 攻击/ 信息/ 采集/ 阶段/ 获取/ 到/ ,/ 由于/ 明文/ P/ 已知/ ,/ 根据/ 式/ (/ 5/ )/ 可/ 得到/ KE0/ / KE4/ 和/ KE1/ / KE5/ 的/ 不/ 可能/ 候选/ 值/ ,/ 多次/ 分析/ 得到/ 正确/ 的/ KE0/ / KE4/ 和/ KE1/ / KE5/ ,/ 并/ 恢复/ 第/ 1/ 轮/ F/ 函数/ 的/ 8/ 次/ 查找/ S/ 盒/ 的/ 输入/ 索引/ 值/ 和/ 结果/ 值/ ./ 则/ 第/ 1/ 轮/ 右半/ 部分/ 的/ 输出/ 2/ ,/ s13/ 可/ 表示/ 为/ 其/ 输入/ 值同/ 多个/ 查表/ 结果/ 值/ 的/ 异值/ s1/ 或/ 结果/ ,/ 如式/ (/ 6/ )/ 所示/ ,/ 并/ 可/ 用于/ 第/ 2/ 轮/ 分析/ ./ s12/ =/ 2/ / S2/ [/ P4/ / KE1/ ,/ 0/ / KE5/ ,/ 0/ ]/ / S3/ [/ P5/ / KE1/ ,/ 1/ / KE5/ ,/ 1/ ]/ / s1S4/ [/ P6/ / KE1/ ,/ 2/ / KE5/ ,/ 2/ ]/ / S1/ [/ P7/ / KE1/ ,/ 3/ / KE5/ ,/ 3/ ]/ / S1/ [/ P0/ / KE0/ ,/ 0/ / KE4/ ,/ 0/ ]/ / S2/ [/ P1/ / KE0/ ,/ 1/ / KE4/ ,/ 1/ ]/ / S3/ [/ P2/ / KE0/ ,/ 2/ / KE4/ ,/ 2/ ]/ / S4/ [/ P3/ / KE0/ ,/ 3/ / KE4/ ,/ 3/ ]/ ,/ s13/ =/ s13/ / S2/ [/ P4/ / KE1/ ,/ 0/ / KE5/ ,/ 0/ ]/ / S3/ [/ P5/ / KE1/ ,/ 1/ / KE5/ ,/ 1/ ]/ / S4/ [/ P6/ / KE1/ ,/ 2/ / KE5/ ,/ 2/ ]/ / S1/ [/ P7/ / KE1/ ,/ 3/ / KE5/ ,/ 3/ ]/ / S1/ [/ P0/ / KE0/ ,/ 0/ / KE4/ ,/ 0/ ]/ / S2/ [/ P1/ / KE0/ ,/ 1/ / KE4/ ,/ 1/ ]/ / S3/ [/ P2/ / KE0/ ,/ 2/ / KE4/ ,/ 2/ ]/ / S4/ [/ P3/ / KE0/ ,/ 3/ / KE4/ ,/ 3/ ]/ / RightRotate/ (/ S1/ [/ P0/ / KE0/ ,/ 0/ / KE4/ ,/ 0/ ]/ / S2/ [/ P1/ / KE0/ ,/ 1/ / KE4/ ,/ 1/ ]/ / S3/ [/ P2/ / KE0/ ,/ 2/ / KE4/ ,/ 2/ ]/ / S4/ [/ P3/ / KE0/ ,/ 3/ / KE4/ ,/ 3/ ]/ ,/ 8/ )/ 同样/ ,/ 根据/ Camellia/ 加密/ 第/ 2/ 轮/ F/ 函数/ ,/ 可/ 得到/ 其中/ 第/ 2/ 轮/ 8/ 次/ 查表/ 索引/ γ/ 1/ =/ P8/ / KE2/ ,/ 0/ / KE6/ ,/ 0/ ,/ γ/ 1/ =/ P15/ / KE3/ ,/ 3/ / KE7/ ,/ 3/ γ/ 2/ =/ P9/ / KE2/ ,/ 1/ / KE6/ ,/ 1/ ,/ γ/ 2/ =/ P12/ / KE3/ ,/ 0/ / KE7/ ,/ 0/ γ/ 3/ =/ P10/ / KE2/ ,/ 2/ / KE6/ ,/ 2/ ,/ γ/ 3/ =/ P13/ / KE3/ ,/ 1/ / KE7/ ,/ 1/ γ/ 4/ =/ P11/ / KE2/ ,/ 3/ / KE6/ ,/ 3/ ,/ γ/ 4/ =/ P14/ / KE3/ ,/ 2/ / KE7/ ,/ 2/ 应用/ 3.2/ 节/ F/ 函数/ 分析模型/ ,/ 正确/ 的/ KE2/ / KE6/ 和/ KE3/ / KE7/ 可/ 被/ 预测出/ ,/ 第/ 2/ 轮/ 的/ 右半/ 部分/ 输出/ 同样/ 可/ 表示/ 为/ 第/ 2/ 轮/ 的/ 右半/ 部分/ 输入/ 同/ 多个/ 查表/ 结果/ 值/ 的/ 异或/ 结果/ s22/ =/ s22/ / S2/ [/ P12/ / KE3/ ,/ 0/ / KE7/ ,/ 0/ ]/ / S3/ [/ P13/ / KE3/ ,/ 1/ / KE7/ ,/ 1/ ]/ / S4/ [/ P14/ / KE3/ ,/ 2/ / KE7/ ,/ 2/ ]/ / S1/ [/ P15/ / KE3/ ,/ 3/ / KE7/ ,/ 3/ ]/ / S1/ [/ P8/ / KE2/ ,/ 0/ / KE6/ ,/ 0/ ]/ / S2/ [/ P9/ / KE2/ ,/ 1/ / KE6/ ,/ 1/ ]/ / S3/ [/ P10/ / KE2/ ,/ 2/ / KE5/ ,/ 2/ ]/ / S4/ [/ P11/ / KE2/ ,/ 3/ / KE6/ ,/ 3/ ]/ ,/ s23/ =/ s23/ / S2/ [/ P12/ / KE3/ ,/ 0/ / KE7/ ,/ 0/ ]/ / S3/ [/ P13/ / KE3/ ,/ 1/ / KE7/ ,/ 1/ ]/ / S4/ [/ P14/ / KE3/ ,/ 2/ / KE7/ ,/ 2/ ]/ / S1/ [/ P15/ / KE3/ ,/ 3/ / KE7/ ,/ 3/ ]/ / S1/ [/ P8/ / KE2/ ,/ 0/ / KE6/ ,/ 0/ ]/ / S2/ [/ P9/ / KE2/ ,/ 1/ / KE6/ ,/ 1/ ]/ / S3/ [/ P10/ / KE2/ ,/ 2/ / KE5/ ,/ 2/ ]/ / S4/ [/ P11/ / KE2/ ,/ 3/ / KE6/ ,/ 3/ ]/ / RightRotate/ (/ S1/ [/ P8/ / KE2/ ,/ 0/ / KE6/ ,/ 0/ ]/ / S2/ [/ P9/ / KE2/ ,/ 1/ / KE6/ ,/ 1/ ]/ / S3/ [/ P10/ / KE2/ ,/ 2/ / KE5/ ,/ 2/ ]/ / S4/ [/ P11/ / KE2/ ,/ 3/ / KE6/ ,/ 3/ ]/ ,/ 8/ )/ 成功/ 分析/ 密钥/ KL/ 值/ 需/ 对/ Camellia/ -/ 128/ 进行/ 至少/ 4/ 轮/ 攻击/ ,/ 应用/ 3.2/ 节/ 攻击/ 模型/ ,/ 结合/ 前/ 两轮/ 攻击/ 结果/ ,/ 可/ 进一步/ 得到/ 第/ 3/ 、/ 4/ 轮/ 的/ 攻击/ 结果/ ,/ 这样/ 前/ 4/ 轮/ 攻击/ 结果/ 如表/ 2/ 所示/ ./ 加密/ 轮/ 1KE0/ / KE4/ ‖/ KE1/ / KE5/ (/ (/ KL/ </ </ </ 0/ )/ L/ / (/ KA/ </ </ </ 0/ )/ L/ )/ 2KE2/ / KE6/ ‖/ KE3/ / KE7/ (/ (/ KL/ </ </ </ 0/ )/ R/ / (/ KA/ </ </ </ 0/ )/ R/ )/ 3KE0/ / KE8/ ‖/ KE1/ / KE9/ (/ (/ KL/ </ </ </ 0/ )/ L/ / (/ KL/ </ </ </ 15/ )/ L/ )/ 4KE2/ / KE10/ ‖/ KE3/ / KE11/ (/ (/ KL/ </ </ </ 0/ )/ R/ / (/ KL/ </ </ </ 15/ )/ R/ )/ 4.2/ 密钥/ 扩展/ 分析/ 在/ 对/ Camellia/ -/ 128/ 进行/ 4/ 轮/ 攻击/ 后/ ,/ 可/ 获取/ 到/ 128/ 位/ 变量/ C/ =/ (/ KL/ </ </ </ 0/ )/ / (/ KL/ </ </ </ 15/ )/ ,/ 经/ 下面/ 算法/ 分析/ 可/ 获取/ KL/ 值/ :/ KL/ 搜索算法/ ./ SearchingKL/ (/ SK/ ,/ C/ )/ ./ unsignedcharKP/ [/ 128/ ]/ ,/ cTempSK/ ←/ / Foreachifrom0x00to0x01/ {/ KP/ [/ 0/ ]/ ←/ iForeachjfrom0to127/ {/ }/ }/ 应用/ 上面/ 算法/ ,/ 最多/ 可/ 得到/ 2/ 个/ KL/ 候选/ 值/ ,/ 在/ 某些/ 情况/ 下/ 甚至/ 可/ 直接/ 得到/ 唯一/ 的/ KL/ 值/ ./ Page74/ ./ 3/ 攻击/ 实验/ 我们/ 在/ 64/ 位/ AMD/ 处理器/ 上/ 对/ OPENSSL/ -/ 1.0/ ./ 0/ -/ beta3/ 中/ 的/ Camellia/ 实现/ 进行/ 了/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 实验/ ,/ 其中/ 计时/ 功能/ 是/ 通过/ 调用/ RDTSC/ 指令/ 获取/ 系统/ 自上/ 电/ 以来/ 的/ 时间/ 戳值/ 实现/ 的/ ,/ 加密/ 功能/ 是/ 通过/ 黑盒/ 方式/ 调用/ OPENSSL/ 库中/ 函数/ 来/ 进行/ 的/ ,/ 图/ 2/ 给出/ 了/ 一个/ KE0/ / KE4/ 密码/ 字节/ 密钥/ 搜索/ 空间/ 和/ 样本量/ 的/ 关系/ ,/ 可见/ 400/ 个/ 样本/ 左右/ 即可/ 恢复/ 一个/ KE0/ / KE4/ 密码/ 字节/ ./ 图/ 2KE0/ / KE4/ 每个/ 字节/ 密钥/ 搜索/ 空间/ 和/ 样本量/ (/ N/ )/ 的/ 关系/ 通过/ 对/ Camellia/ 前/ 4/ 轮/ 进行/ 攻击/ ,/ 利用/ 4.2/ 节/ 方法/ 对/ 密钥/ 扩展/ 进行/ 分析/ ,/ 可/ 进一步/ 得到/ 128/ 位/ 初始/ 密钥/ ,/ 实验/ 结果/ 表示/ 大约/ 500/ 个/ 样本/ 即可/ 快速/ 恢复/ 完整/ 的/ Camellia/ -/ 128/ 密钥/ ./ 5Camellia/ -/ 192/ // 256/ 攻击/ Camellia/ -/ 192/ // 256/ 加密/ 过程/ 同/ Camellia/ -/ 128/ 基本/ 相似/ ,/ 不同/ 的/ 就是/ 比/ Camellia/ -/ 128/ 多/ 调用/ 了/ 6/ 次轮/ 函数/ 和/ 1/ 次/ FL/ // FL/ -/ 1/ 函数/ ./ Camellia/ -/ 192/ // 256/ 的/ 密钥/ 扩展/ 算法/ 比/ Camellia/ -/ 128/ 要/ 复杂/ ,/ 对/ Camellia/ -/ 128/ 密钥/ 扩展/ 的/ 密钥/ 分析方法/ 并/ 不适/ 用于/ Camellia/ -/ 192/ // 256/ ,/ 但/ 这/ 并/ 不/ 意味着/ Camellia/ -/ 192/ // 256/ 要/ 比/ Camellia/ -/ 128/ 安全/ ./ 下面/ 给出/ 针对/ Camellia/ -/ 192/ // 256/ 的/ 分析/ 和/ 实验/ 过程/ ./ 5.1/ 前/ 6/ 轮/ 攻击/ 应用/ 3.2/ 节/ CamelliaF/ 函数/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 模型/ ,/ Camellia/ -/ 192/ // 256/ 前/ 6/ 轮/ 攻击/ 结果/ 如表/ 3/ 所示/ ./ 加密/ 轮/ 1KE0/ / KE4/ ‖/ KE1/ / KE5/ (/ (/ KL/ </ </ </ 0/ )/ L/ / (/ KB/ </ </ </ 0/ )/ L/ )/ 2KE2/ / KE6/ ‖/ KE3/ / KE7/ (/ (/ KL/ </ </ </ 0/ )/ R/ / (/ KB/ </ </ </ 0/ )/ R/ )/ 3KE0/ / KE8/ ‖/ KE1/ / KE9/ (/ (/ KL/ </ </ </ 0/ )/ L/ / (/ KR/ </ </ </ 15/ )/ L/ )/ 4KE2/ / KE10/ ‖/ KE3/ / KE11/ (/ (/ KL/ </ </ </ 0/ )/ R/ / (/ KR/ </ </ </ 15/ )/ R/ )/ 5KE0/ / KE12/ ‖/ KE1/ / KE13/ (/ (/ KL/ </ </ </ 0/ )/ L/ / (/ KA/ </ </ </ 15/ )/ L/ )/ 6KE2/ / KE14/ ‖/ KE3/ / KE15/ (/ (/ KL/ </ </ </ 0/ )/ R/ / (/ KA/ </ </ </ 15/ )/ R/ )/ 5.2/ 密钥/ 扩展/ 分析/ 通过/ 对/ Camellia/ -/ 192/ // 256/ 前/ 6/ 轮/ 攻击/ ,/ 分析/ 第/ 3/ 、/ 4/ 、/ 5/ 、/ 6/ 轮/ 攻击/ 结果/ ,/ 可/ 获取/ 密钥/ 扩展/ 中/ 第/ 5/ 轮/ 输入/ 状态值/ (/ KA/ </ </ </ 15/ )/ / (/ KR/ </ </ </ 15/ )/ ,/ 由于/ Σ/ 5/ 为/ 已知/ 常量/ ,/ 根据/ 密钥/ 扩展/ 算法/ ,/ 第/ 6/ 个/ F/ 函数/ 的/ 输出/ 值即/ KB/ (/ KE4/ ,/ KE5/ ,/ KE6/ ,/ KE7/ )/ 可/ 得到/ ,/ 根据/ 表/ 3/ ,/ KL/ 和/ KR/ 可/ 被/ 恢复/ 出来/ ,/ 最终/ 得到/ Camellia/ -/ 192/ // 256/ 完整/ 密钥/ ./ 5.3/ 攻击/ 实验/ 图/ 3/ 给出/ 了/ Camellia/ -/ 192/ // 256/ 一个/ KE0/ / KE4/ 字节/ 密钥/ 搜索/ 空间/ 同/ 样本量/ 的/ 关系/ ,/ 可见/ 600/ 个/ 样本/ 可/ 分析/ 获取/ KE0/ / KE4/ 密钥/ 字节/ ,/ 比/ Camellia/ -/ 128/ 所/ 需/ 的/ 400/ 个/ 样本/ 要大些/ ,/ 这/ 主要/ 是/ 由于/ Camellia/ -/ 192/ // 256/ 查表/ 所用/ 的/ 192/ 次要/ 大于/ Camellia/ -/ 128/ 的/ 144/ 次/ ,/ 攻击/ 采集/ 到/ 的/ 加密/ 没有/ 访问/ 到/ 的/ Cache/ 组/ 数量/ 要少些/ 造成/ 的/ ./ 图/ 3Camellia128and192/ // 256/ 中/ KE0/ / KE4/ 每个/ 字节/ 通过/ 对/ Camellia/ 前/ 6/ 轮/ 进行/ 攻击/ ,/ 利用/ 5.2/ 节/ 方法/ 对/ 密钥/ 扩展/ 进行/ 分析/ ,/ 实验/ 结果/ 表示/ 大约/ 800/ ~/ 900/ 个/ 样本/ 即可/ 快速/ 恢复/ 完整/ Camellia/ -/ 192/ // 256/ 初始/ 密钥/ ./ 6/ 已知/ 密文/ 攻击/ 第/ 4/ 、/ 5/ 节/ 给出/ 了/ 针对/ Camellia/ 加密/ 过程/ 的/ 已知/ 明文/ Cache/ 计时/ 攻击/ ,/ 根据/ Camellia/ 的/ 对称/ 密码/ 特性/ ,/ 攻击者/ 也/ 可/ 针对/ Camellia/ 解密/ 过程/ 进行/ 已知/ 密文/ Cache/ 计时/ 攻击/ ./ 6.1/ Camellia/ -/ 128/ 攻击/ 攻击者/ 首先/ 采集/ 到/ Camellia/ -/ 128/ 解密/ 过程/ 中/ 的/ Cache/ 组/ 集合/ 信息/ ,/ 根据/ 式/ (/ 4/ )/ ,/ 通过/ 对前/ 4/ 轮/ 解密/ 过程/ 攻击/ ,/ 恢复/ 相关/ 密钥/ 结果/ 如表/ 4/ 所示/ ./ 通过/ 分析/ 第/ 3/ 轮/ 和/ 第/ 4/ 轮/ 攻击/ 结果/ (/ KA/ </ </ </ 111/ )/ / (/ KA/ </ </ </ 94/ )/ ,/ 参考/ 4.2/ 节/ 密钥/ 恢复/ 方法/ ,/ 可/ 恢复/ 1/ ~/ 2/ 个/ KA/ 候选/ 值/ ,/ 然后/ 进一步/ 得到/ 初始/ 密钥/ KL/ ./ Page8/ 解密/ 轮/ 1KE48/ / KE44/ ‖/ KE49/ / KE45/ (/ (/ KA/ </ </ </ 111/ )/ L/ / 2KE50/ / KE46/ ‖/ KE51/ / KE47/ (/ (/ KA/ </ </ </ 111/ )/ R/ / 3KE48/ / KE40/ ‖/ KE49/ / KE41/ (/ (/ KA/ </ </ </ 111/ )/ L/ / 4KE50/ / KE42/ ‖/ KE51/ / KE43/ (/ (/ KA/ </ </ </ 111/ )/ R/ / 6.2/ Camellia/ -/ 192/ // 256/ 攻击/ 攻击者/ 首先/ 采集/ 到/ Camellia/ -/ 192/ // 256/ 解密/ 过程/ 中/ 的/ Cache/ 组/ 集合/ 信息/ ,/ 根据/ 式/ (/ 4/ )/ ,/ 通过/ 对前/ 6/ 轮/ 解密/ 过程/ 攻击/ ,/ 恢复/ 相关/ 密钥/ 结果/ 如表/ 5/ 所示/ ./ 通过/ 分析/ 第/ 3/ 、/ 4/ 、/ 5/ 、/ 6/ 轮/ 攻击/ 结果/ ,/ 可/ 恢复/ KA/ / KR/ 值/ ,/ 参考/ 5.2/ 节/ 密钥/ 恢复/ 方法/ 得到/ KB/ ,/ KL/ ,/ KR/ ,/ 进而/ 得到/ 初始/ 密钥/ K/ ./ 表/ 5Camellia/ -/ 192/ // 256/ 前/ 6/ 轮/ 解密/ 攻击/ 结果/ 解密/ 轮/ 1KE64/ / KE60/ ‖/ KE65/ / KE61/ (/ (/ KB/ </ </ </ 111/ )/ L/ / 2KE66/ / KE62/ ‖/ KE67/ / KE63/ (/ (/ KB/ </ </ </ 111/ )/ R/ / 3KE64/ / KE56/ ‖/ KE65/ / KE57/ (/ (/ KB/ </ </ </ 111/ )/ L/ / 4KE66/ / KE58/ ‖/ KE67/ / KE59/ (/ (/ KB/ </ </ </ 111/ )/ R/ / 5KE64/ / KE52/ |/ KE65/ / KE53/ (/ (/ KB/ </ </ </ 111/ )/ L/ / 6KE66/ / KE54/ ‖/ KE67/ / KE55/ (/ (/ KB/ </ </ </ 111/ )/ L/ / 6.3/ 攻击/ 实验/ 在/ 4.3/ 节/ 环境/ 下/ ,/ 我们/ 对/ Camellia/ -/ 128/ // 192/ // 256/ 进行/ 了/ Cache/ 计时/ 攻击/ 实验/ ,/ 使用/ 6.1/ 节/ 和/ 6.2/ 节/ 分析方法/ ,/ 500/ 和/ 900/ 个/ 左右/ 样本/ 1s/ 左右/ 可/ 分别/ 恢复/ Camellia/ -/ 128/ 和/ Camellia/ -/ 192/ // 256/ 密钥/ ./ 图/ 4/ 本地/ 攻击/ 中/ 一个/ 样本/ Cache/ 组/ 访问/ 时钟/ 周期/ 图图/ 5/ 远程/ 攻击/ 中/ 一个/ 样本/ Cache/ 组/ 访问/ 时钟/ 周期/ 图/ 7/ 远程/ 攻击/ 在/ 本地/ 攻击/ 实验/ 中/ ,/ 我们/ 在/ 程序/ 中/ 通过/ 黑盒/ 方式/ 调用/ OPENSSL/ 密码/ 库来/ 进行/ 攻击/ 实验/ ,/ 攻击/ 程序/ 和/ 加密/ 服务/ 之间/ 并/ 没有/ 直接/ 进行/ 交互/ ./ 为了/ 表明/ 本文/ 攻击/ 对/ 远程/ 环境/ 下/ 的/ 适应性/ ,/ 我们/ 将/ 攻击/ 程序/ 和/ 解密/ 程序/ 分开/ ,/ 在/ 局域网/ 和/ 校园网/ 环境/ 下/ 进行/ 了/ 远程/ 攻击/ 实验/ ,/ 实验/ 结果/ 良好/ ./ 远程/ 攻击/ 实验/ 使用/ 了/ 3/ 个/ 程序/ ,/ 攻击/ 程序/ (/ AP/ )/ 、/ Camellia/ 服务程序/ (/ CSP/ )/ 、/ 间谍/ 程序/ (/ SP/ )/ ./ SP/ 和/ CSP/ 被/ 部署/ 在/ 同一/ 电脑/ 上/ ,/ SP/ 通过/ 观测/ 访问/ 自身/ 数据/ 命中/ 、/ 失效/ 信息/ 采集/ 访问/ 驱动/ Cache/ 计时/ 信息/ ,/ 攻击/ 步骤/ 如下/ :/ 1/ ./ AP/ 通知/ SP/ 清空/ CSP/ 所在/ 电脑/ 数据/ Cache/ ,/ 初始化/ Cache/ 为/ 一个/ 固定/ 状态/ ;/ 2/ ./ AP/ 向/ CSP/ 发送/ 加密/ 请求/ ,/ CSP/ 加密/ 后/ 将/ 密文/ 反馈/ 给/ AP/ ;/ 3/ ./ AP/ 收到/ 密文/ 后/ ,/ 通知/ SP/ 再次/ 访问/ Cache/ ,/ 根据/ 命中/ 失效/ 信息/ 采集/ CSP/ 加密/ 过程/ 中/ 访问/ 过/ 和/ 没有/ 访问/ 过/ 的/ Cache/ 组/ 集合/ 信息/ ./ 之后/ ,/ SP/ 将/ 所/ 采集/ 信息/ 发送给/ AP/ ./ 计时/ 信息/ 对/ 密钥/ K/ 进行/ 离线/ 分析/ ./ 4/ ./ 利用/ 相应/ 的/ 分析方法/ ,/ AP/ 对/ 采集/ 的/ 访问/ 驱动/ Cache/ 远程/ 攻击/ 实验/ 中/ 我们/ 发现/ ,/ 和/ 本地/ 攻击/ 相比/ ,/ 远程/ 攻击/ 由于/ 信息/ 采集/ 过程/ 中/ 网络/ 发包/ 拆包/ 需/ 多次/ 访问/ Cache/ ,/ 带来/ 一定/ 的/ 噪声/ ,/ 攻击/ 样本量/ 比/ 本地/ 大/ ./ 本地/ 和/ 局域网/ 环境/ 下/ AES/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 一个/ 样本/ 中/ 间谍/ 程序/ 对/ 所有/ Cache/ 组/ 采样/ 分别/ 如图/ 4/ 、/ 图/ 5/ 所示/ ,/ 其中/ 横坐标/ 表示/ Cache/ 组/ 序号/ ,/ 纵坐标/ 表示/ Cache/ 组/ 访问/ 时钟/ 周期/ ,/ 易/ 见/ ,/ Camellia/ 的/ 4/ 个/ S/ 盒/ 分别/ 对应/ 的/ 起始/ Cache/ 组为/ 261/ ,/ 277/ ,/ 293/ ,/ 309/ ,/ 本地/ 攻击/ 中/ 由/ 系统/ 进程/ 和/ 其它/ 用户/ 进程/ 对/ Page9Cache/ 访问/ 带来/ 的/ 噪声/ 比较/ 小/ ,/ 对/ 攻击/ 影响/ 不/ 大/ ,/ 而/ 远程/ 攻击/ 中/ 网络/ 发包/ 拆包/ 确实/ 给/ 攻击/ 带来/ 很大/ 影响/ ,/ 但/ AES/ 加密/ 过程/ 中/ 查找/ 多个/ 表/ 访问/ Cache/ 组/ 信息/ (/ 方框/ 选择/ 区域/ 中/ 访问/ 时钟/ 周期/ 较/ 小/ 的/ Cache/ 组/ )/ 仍/ 可/ 被/ 采集/ 到/ ,/ 攻击/ 仍/ 可/ 成功/ 实现/ ,/ 只是/ 需要/ 更/ 多/ 的/ 样本量/ 而已/ ./ 实验/ 结果表明/ 3000/ 个/ 样本/ 左右/ 可/ 恢复/ Camellia128/ // 192/ // 256/ 完整/ 密钥/ ./ 8/ 攻击/ 分析/ 与/ 防护/ 措施/ 8.1/ 攻击/ 分析/ 8.1/ ./ 1/ 和/ 其它/ 分组/ 密码/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 我们/ 对/ 典型/ 的/ 几个/ 分组/ 密码/ 进行/ 了/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 实验/ ,/ 如/ AES/ 、/ SMS4/ 、/ Camellia/ ,/ 实验/ 结果/ 良好/ ,/ 证明/ 文中/ 3.1/ 节/ 攻击/ 模型/ 十分/ 有效/ ./ (/ 1/ )/ AES/ [/ 22/ ]/ ./ 对/ AES/ 进行/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 只/ 需/ 获取/ 任何/ 一轮/ 扩展/ 密钥/ 即可/ ./ 在/ AES/ 加密/ 第/ 1/ 轮中/ ,/ 根据/ 采集/ 的/ 加密/ 访问/ Cache/ 组/ 集合/ 信息/ 及其/ 转化/ 的/ 查表/ 索引/ 值/ ,/ 结合/ 明文/ 经/ 分析/ 可/ 直接/ 获取/ 初始/ 密钥/ ;/ 在/ AES/ 最后/ 一轮/ 中/ ,/ 根据/ 加密/ 访问/ 的/ Cache/ 组/ 集合/ 信息/ 及其/ 转化/ 的/ 查表/ 结果/ 值/ ,/ 结合/ 密文/ 分析/ 可/ 恢复/ 第/ 10/ 轮/ 扩展/ 密钥/ ,/ 根据/ AES/ 可逆/ 的/ 密钥/ 扩展/ 结构/ ,/ 可/ 直接/ 恢复/ 初始/ 密钥/ ./ (/ 2/ )/ SMS4/ [/ 23/ ]/ ./ 对/ SMS4/ 进行/ 攻击/ 需要/ 获取/ 前/ 4/ 轮/ 或/ 最后/ 4/ 轮/ 的/ 扩展/ 密钥/ ./ 在/ SMS4/ 第/ 1/ 轮/ 攻击/ 中/ ,/ 查表/ 索引/ 值/ 等于/ 3/ 个/ 32/ 位明/ 文字/ 和/ 第/ 1/ 轮/ 扩展/ 密钥/ rk0/ 异或/ 值/ ,/ 根据/ 加密/ 访问/ 的/ Cache/ 组/ 集合/ 信息/ 及其/ 转化/ 的/ 查表/ 索引/ 值/ ,/ 结合/ 明文/ 可/ 恢复/ rk0/ ,/ 进一步/ 可/ 计算/ 出/ 第/ 2/ 轮/ 的/ 输入/ 值/ ./ 用/ 同样/ 方法/ 恢复/ 第/ 2/ 、/ 3/ 、/ 4/ 轮/ 扩展/ 密钥/ rk1/ ,/ rk2/ ,/ rk3/ ,/ 结合/ 密钥/ 扩展/ 算法/ 恢复/ 128/ 位/ SMS4/ 初始/ 密钥/ ./ 同样/ ,/ 通过/ 对/ SMS4/ 最后/ 4/ 轮/ 进行/ 分析/ ,/ 可/ 恢复/ rk28/ ,/ rk29/ ,/ rk30/ ,/ rk31/ ,/ 结合/ 密钥/ 扩展/ 算法/ 恢复/ 128/ 位/ SMS4/ 初始/ 密钥/ ./ (/ 3/ )/ Camellia/ ./ 对/ Camellia/ 进行/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 要/ 比/ AES/ 和/ SMS4/ 复杂/ 一些/ ,/ 因为/ Camellia/ 查表/ 索引/ 值/ 并/ 不是/ 简单/ 的/ 和/ 初始/ 密钥/ 相关/ ,/ 而是/ 同/ 初始/ 密钥/ 和/ 轮/ 密钥/ 的/ 异或/ 结果/ 值/ 相关/ ,/ 并且/ Camellia/ 的/ 密钥/ 扩展/ 过程/ 也/ 要/ 比/ AES/ 和/ SMS4/ 复杂/ ,/ 但是/ 由于/ 其/ 密钥/ 扩展/ 过程/ 中/ 使用/ 了/ 大量/ 的/ 左移/ 函数/ ,/ 为/ Camellia/ 密钥/ 分析/ 提供/ 了/ 极大/ 的/ 便利/ ./ 8.1/ ./ 2/ 攻击/ 成功/ 原因/ 分析/ Camellia/ 的/ F/ 函数/ 可/ 泄露/ 加解密/ 密钥/ 和/ 扩展/ 密钥/ 异或/ 结果/ ,/ CamelliaS/ 盒/ 在/ Cache/ 中/ 的/ 不/ 对齐/ 分布/ 特性/ 极大/ 地/ 加速/ 了/ 初始/ 密钥/ 和/ 扩展/ 密钥/ 异或/ 结果/ 值/ 的/ 恢复/ ,/ Camellia/ 密钥/ 扩展/ 中/ 的/ 左移/ 函数/ 严重/ 影响/ 了/ 其/ 安全性/ ./ (/ 1/ )/ CamelliaS/ 盒/ 在/ Cache/ 中/ 的/ 不/ 对齐/ 特征/ 假设/ O/ 代表/ Camellia/ 第一个/ 查找/ 表/ 第一个/ 字节/ 在/ Cache/ 组中/ 的/ 起始/ 位置/ (/ 0/ ~/ 15/ )/ ,/ 根据/ O/ =/ 0/ 和/ O/ ≠/ 0/ 两种/ 情况/ 进行/ 如下/ 分析/ :/ ①/ Ol/ =/ 0/ 如果/ 查找/ 表/ 第一个/ 字节/ 在/ Cache/ 组中/ 是/ 对齐/ 的/ ,/ 即/ 其/ 恰好/ 对应/ Cache/ 组/ 的/ 第一个/ 字节/ ,/ 那么/ 利用/ 所/ 采集/ 的/ 样本/ 加密/ 没有/ 访问/ 的/ 每个/ Cache/ 组将/ 对应/ 着/ 16/ 个/ 高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ 的/ 索引/ 字节/ ,/ 每次/ 将/ 排除/ 掉/ 16/ 个/ 高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ 的/ 密钥/ 字节/ 不/ 可能/ 值/ ,/ 而/ 正确/ 的/ 密钥/ 字节/ 值/ 不/ 可能/ 被/ 排除/ ;/ 同样/ ,/ 同/ 正确/ 的/ 密钥/ 字节/ 高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 不同/ 的/ 另外/ 15/ 个/ 密钥/ 字节/ 也/ 是/ 不/ 可能/ 被/ 排除/ 掉/ 的/ ,/ 这种/ 情况/ 下/ 每个/ 相关/ 密钥/ 字节/ 候选/ 值/ 最/ 多/ 可/ 从/ 256/ 降低/ 到/ 16/ ./ ②/ Ol/ ≠/ 0/ 那么/ 如果/ 查找/ 表/ 第一个/ 字节/ 在/ Cache/ 组中/ 不是/ 对齐/ 的/ ,/ 那么/ 加密/ 没有/ 访问/ 的/ 每个/ Cache/ 组将/ 对应/ 着/ 两个/ 查表/ 行/ ,/ 第/ 1/ 个/ 查表/ 行/ 对应/ 16/ -/ O/ 个/ 索引/ ,/ 其高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ ,/ 第/ 2/ 个/ 查表/ 行/ 对应/ O/ 个/ 索引/ ,/ 其高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ ./ 这样/ 每次/ 排除/ 的/ 16/ 个/ 密钥/ 和/ 索引/ 一样/ ,/ 均/ 对应/ 两个/ 密钥/ 行/ ,/ 第/ 1/ 个行/ 对应/ 16/ -/ O/ 个值/ ,/ 高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ ;/ 第/ 2/ 个行/ 对应/ O/ 个值/ ,/ 高/ 4/ 位/ 相同/ 、/ 低/ 4/ 位/ 连续/ ,/ 易/ 见/ ,/ 这/ 两个/ 行/ 的/ 数量/ 越/ 接近/ ,/ 即/ O/ =/ 7/ 、/ 8/ 时/ ,/ 排除/ 效果/ 越/ 好/ ,/ 攻击/ 所/ 需/ 样本量/ 也/ 小/ ./ 以上/ 可知/ ,/ 当/ Ol/ =/ 0/ 时/ ,/ 很难/ 直接/ 恢复/ Camellia/ 初始/ 密钥/ 和/ 扩展/ 密钥/ 的/ 异或/ 结果/ 值/ ,/ 但是/ 大部分/ 情况/ 下/ ,/ Camellia/ 查找/ 表在/ Cache/ 中是/ 不/ 对齐/ 的/ ,/ 该/ 特征/ 极大/ 地/ 加速/ 了/ Camellia/ 的/ 密钥/ 恢复/ 效率/ ./ (/ 2/ )/ 密钥/ 扩展/ 设计/ 问题/ 很多/ 分组/ 密码/ 在/ 密钥/ 扩展/ 中/ 使用/ 了/ 左移/ 和/ 右移/ 函数/ 来/ 产生/ 扩展/ 密钥/ ,/ 如/ Camellia/ 、/ ARIA/ [/ 24/ ]/ ./ ①/ Camellia/ ./ Camellia/ -/ 128/ 的/ 扩展/ 密钥/ 通过/ 左移/ KL/ 和/ KA/ 产生/ ,/ 而/ Camellia/ -/ 192/ // 256/ 的/ 扩展/ 密钥/ 则/ 通过/ 左移/ KL/ ,/ KR/ ,/ KA/ 和/ KB/ 产生/ ./ 我们/ 称/ 获取/ 到/ 某/ 一个/ 128/ 位/ 密钥/ 相关/ 状态值/ 和/ 其/ 移位/ 后/ 的/ 状态/ 的/ 异或/ 结果/ 为/ 一个/ 碰撞/ ,/ 那么/ 一旦/ 攻击者/ 找到/ 这样/ 一个/ 碰撞/ ,/ 应用/ 4.2/ 节/ 分析方法/ ,/ 可/ 快速/ 恢复/ 该/ 128/ 位/ 密钥/ 相关/ 状态值/ ./ 对于/ Camellia/ -/ 128/ 来说/ ,/ 第/ 3/ 、/ 4/ 轮/ 攻击/ 结果/ 可/ 找到/ KL/ 的/ 一个/ 碰撞/ ,/ 初始/ 密钥/ KL/ 密钥/ Page10/ 搜索/ 空间/ 可/ 由/ 2128/ 降低/ 到/ 2/ ;/ 而/ 对于/ Camellia/ -/ 192/ // 256/ 来说/ ,/ 通过/ 对/ 第/ 3/ 、/ 4/ 轮/ 分析/ 可/ 得到/ (/ KL/ </ </ </ 0/ )/ / (/ KR/ </ </ </ 15/ )/ ,/ 第/ 5/ 、/ 6/ 轮/ 分析/ 可/ 得到/ (/ KL/ </ </ </ 0/ )/ / (/ KA/ </ </ </ 15/ )/ ,/ 进一步/ 分析/ 可/ 直接/ 得到/ KA/ / KR/ ,/ 凑巧/ 的/ 是/ KA/ / KR/ 也/ 是/ Camellia/ -/ 192/ // 256/ 第/ 5/ 个/ F/ 函数/ 的/ 输入/ 值/ ,/ 进而/ 可/ 快速/ 恢复/ KB/ 、/ KL/ 和/ KR/ ./ ②/ ARIA/ ./ ARIA/ 算法/ 是/ 韩国/ 国家/ 分组/ 密码/ 加密/ 标准/ ,/ 常/ 被/ 应用/ 到/ 轻量级/ 的/ 密码/ 设备/ 中/ ,/ 分组/ 长度/ 为/ 128/ 位/ ,/ 支持/ 128/ 、/ 192/ 、/ 256/ 位/ 3/ 种/ 密钥/ 长度/ ./ 在/ 其/ 加密/ 过程/ 中/ ,/ 查表/ 索引/ 值/ 等于/ 一个/ 已知/ 的/ 中间/ 状态值/ 和/ 轮/ 密钥/ rkr/ 的/ 异或/ 结果/ ,/ 通过/ 访问/ 驱动/ Cache/ 计时/ 攻击/ ,/ 可/ 获取/ ARIA/ 每轮/ 的/ 扩展/ 密钥/ rkr/ ,/ 并/ 不能/ 直接/ 获取/ 初始/ 密钥/ K/ ./ 但/ 在/ ARIA/ 密钥/ 扩展/ 中/ ,/ 13/ 轮/ 扩展/ 密钥/ 均/ 通过/ 对/ 4/ 个/ 128/ 位/ 变量/ W0/ ,/ W1/ ,/ W2/ ,/ W3/ 的/ 经/ 简单/ 移位/ 操作/ 而/ 得/ ,/ 通过/ 分析/ 前/ 4/ 轮/ 的/ 攻击/ 结果/ ,/ 攻击者/ 可/ 找到/ W0/ 的/ 一个/ 碰撞/ ,/ 然后/ 直接/ 获取/ 初始/ 密钥/ W0/ ./ 因此/ ,/ 密钥/ 设计者/ 在/ 密钥/ 扩展/ 设计/ 中/ 使用/ 移位/ 函数/ 时/ 一定/ 要/ 谨慎/ ./ 8.1/ ./ 3/ 同/ 前人/ 远程/ Cache/ 计时/ 攻击/ 比较/ 在/ 远程/ 攻击/ 方面/ ,/ 目前/ 国内外/ 已/ 公布/ 针对/ AES/ 的/ Cache/ 远程/ 计时/ 攻击/ 只有/ Bernstein/ [/ 7/ ]/ 和/ Acimez/ [/ 14/ ]/ 两例/ ,/ 攻击/ 均/ 属/ 时序/ 驱动/ Cache/ 计时/ 攻击/ ./ (/ 1/ )/ Bernstein/ 远程/ 攻击/ ./ 攻击/ 端/ 和/ 加密/ 服务端/ 虽/ 部署/ 在/ 不同/ 的/ PC机/ 上/ ,/ 但/ 负责/ 采集/ 从/ 加密/ 开始/ 到/ 完成/ 时间/ 信息/ 并/ 回/ 传给/ 攻击/ 端的/ 却是/ 远程/ 加密/ 端/ ,/ 绝对/ 消除/ 了/ 网络/ 传输/ 时延/ ,/ 使用/ 227.5/ 个/ 样本/ 恢复/ 出/ 128/ 位/ AES/ 密钥/ ,/ 这/ 在/ 实际/ 攻击/ 中是/ 不/ 现实/ 的/ ,/ 攻击/ 实际上/ 仍属/ 本地/ 计时/ 攻击/ ./ (/ 2/ )/ Acimez/ 远程/ 攻击/ ./ 攻击/ 端/ 和/ 加密/ 服务端/ 部署/ 在/ 同一/ 台/ PC机/ 上/ ,/ 攻击/ 端/ 负责/ 采集/ 从/ 加密/ 开始/ 到/ 加密/ 完成/ 时间/ ,/ 也/ 是/ 在/ 消除/ 了/ 网络/ 传输/ 时延/ 的/ 条件/ 下/ ,/ 使用/ 226.66/ 个/ 样本/ 才/ 恢复/ 出/ 完整/ 密钥/ ,/ 验证/ 了/ 理想/ 条件/ 下/ 进行/ 时序/ 驱动/ 远程/ 计时/ 攻击/ 的/ 可行性/ ./ 在/ 真实/ 远程/ 条件/ 下/ ,/ 网络/ 传输/ 时延/ 本身/ 甚至/ 其/ 抖动/ 时延/ 一般/ 远大于/ 加密/ 时间/ ,/ 时序/ 驱动/ Cache/ 远程/ 计时/ 攻击/ 信息/ 的/ 精确/ 采集/ 十分困难/ ./ 本文/ 实现/ 的/ 访问/ 驱动/ Cache/ 远程/ 计时/ 攻击/ ,/ 在/ 很大/ 程度/ 上/ 避开/ 了/ 时序/ 驱动/ 远程/ 计时/ 攻击/ 中/ 网络/ 传输/ 时延/ 干扰/ 比较/ 大/ 的/ 问题/ ,/ 在/ 局域网/ 甚至/ 不同/ 教学楼/ 之间/ 的/ 远程/ 环境/ 下/ 将/ 攻击/ 端/ 和/ 加密/ 服务端/ 分别/ 部署/ 在/ 不同/ 的/ PC机/ 上/ ,/ 同时/ 将/ 间谍/ 程序/ 植入/ 到/ 加密/ 服务器/ 上/ ,/ 受/ 远程/ 攻击/ 端/ 操控/ 执行/ 正常/ 的/ 数据/ 访问/ 操作/ 采集/ Camellia/ 加密/ 过程/ 中/ 的/ Cache/ 旁路/ 信息/ ,/ 结合/ 明文/ // 密文/ 对/ 信息/ 开展/ 密钥/ 分析/ ,/ 在/ 有限/ 样本/ 下/ 快速/ 恢复/ 完整/ Camellia/ 密钥/ ,/ 攻击/ 样本量/ 和/ 所/ 需/ 时间/ 相对/ 比较/ 小/ ./ 8.2/ 防护/ 措施/ 本节/ 只/ 讨论/ 从/ 算法/ 设计/ 角度/ 对/ Camellia/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 的/ 防护/ 措施/ ./ (/ 1/ )/ 使用/ 多个/ 密钥/ 相关/ 变量/ (/ 至少/ 3/ 个/ )/ 作为/ 查找/ S/ 盒/ 的/ 输入/ 索引/ 值/ ./ 对于/ AES/ 和/ SMS4/ 分组/ 密码/ ,/ 查表/ 操作/ 仅仅/ 使用/ 了/ 一种/ 密钥/ 相关/ 变量/ (/ 初始/ 密钥/ 或/ 扩展/ 密钥/ )/ ,/ 经过/ 访问/ 驱动/ Cache/ 计时/ 分析/ ,/ 攻击者/ 可/ 直接/ 恢复/ 初始/ 密钥/ 或/ 扩展/ 密钥/ ./ 但/ Camellia/ 查找/ 表/ 使用/ 了/ 两个/ 密钥/ 相关/ 变量/ (/ 初始/ 密钥/ 和/ 扩展/ 密钥/ )/ ,/ 如果/ 不/ 对/ Camellia/ 密钥/ 扩展/ 进行/ 分析/ ,/ 将/ 不能/ 直接/ 获取/ 初始/ 密钥/ ,/ 如果/ 在/ Camellia/ 加密/ 查找/ S/ 盒时/ ,/ 输入/ 索引/ 和/ 3/ 个/ 以上/ 密钥/ 变量/ 相关/ ,/ 则/ 会/ 大大增加/ 攻击者/ 分析/ 的/ 复杂度/ ./ (/ 2/ )/ 在/ 相邻/ 的/ 两个/ 或/ 多个/ F/ 函数/ 之间/ 插入/ FL/ // FL/ -/ 1/ 混淆/ 层/ ./ 在/ Camellia/ 原有/ 设计/ 中/ ,/ 通过/ 在/ 每/ 6/ 轮/ 插入/ 由/ 与/ 、/ 或/ 、/ 异或/ 简单/ 逻辑/ 操作/ 组成/ 的/ FL/ // FL/ -/ 1/ 混淆/ 层/ 可/ 大幅度提高/ 非线性/ 度/ 和/ 算法/ 安全性/ ./ 值得/ 提出/ 的/ 是/ ,/ 由于/ Camellia/ 中/ 函数/ FL/ // FL/ -/ 1/ 混淆/ 层/ 存在/ ,/ 攻击者/ 很难/ 对/ 第/ 6/ 轮后/ 的/ 其它/ 轮/ 进行/ 成功/ 攻击/ ,/ 但/ 不幸/ 的/ 是/ 攻击/ 前/ 6/ 轮/ 便/ 足以/ 恢复/ Camellia/ -/ 128/ // 192/ // 256/ 完整/ 密钥/ ./ 如果/ 攻击者/ 增加/ FL/ // FL/ -/ 1/ 混淆/ 层/ 的/ 使用/ 频率/ ,/ 如/ 每隔/ 两轮/ 就/ 插入/ FL/ // FL/ -/ 1/ 混淆/ 层/ ,/ 则/ 会/ 大大增加/ 攻击/ 复杂度/ ./ (/ 3/ )/ 在/ 扩展/ 密钥/ 生成/ 过程/ 中/ 除了/ 移位/ 操作/ 以外/ 使用/ 更/ 多/ 的/ 其它/ 线性/ 逻辑/ 操作/ ,/ 如/ 异或/ 、/ 列/ 混淆/ 等/ ./ 通过/ 移位/ 操作/ 来/ 产生/ 轮/ 密钥/ 实现/ 效率/ 较/ 高/ ,/ 但/ 安全隐患/ 比较/ 大/ ,/ 一旦/ 攻击者/ 找到/ 了/ 对/ 同一个/ 密钥/ 变量/ 的/ 一个/ 异或/ 碰撞/ ,/ 将/ 很/ 容易/ 获取/ 该/ 密钥/ 变量/ ,/ 经/ 进一步/ 分析/ 获取/ 初始/ 密钥/ ./ 在/ 目前/ 的/ Camellia/ 实现/ 中/ ,/ 仅/ 使用/ 了/ 移位/ 一种/ 操作/ 来/ 生成/ 扩展/ 密钥/ ,/ 如果/ 能/ 在/ 扩展/ 密钥/ 生成/ 过程/ 中/ 增加/ 更/ 多/ 的/ 简单/ 逻辑/ 操作/ 如/ 与/ 、/ 或/ 、/ 异或/ 等/ 操作/ ,/ 也/ 会/ 在/ 某种/ 程序/ 上/ 大大增加/ 攻击/ 复杂度/ ./ 另外/ ,/ 在/ Camellia/ -/ 192/ // 256/ 密钥/ 扩展/ 算法/ 设计/ 中/ ,/ 我们/ 也/ 建议/ 其/ 在/ 对/ KA/ 和/ KR/ 进行/ 的/ 移位/ 操作/ 位数/ 不要/ 相同/ ./ 9/ 结束语/ 本文/ 就/ 当前/ 最/ 安全/ 的/ Camellia/ 分组/ 密码/ 算法/ Page11/ 访问/ 驱动/ Cache/ 计时/ 攻击/ 进行/ 了/ 一些/ 相关/ 研究/ ,/ 研究/ 结果表明/ 此类/ 针对/ Camellia/ 的/ 计时/ 攻击/ 手段/ 对/ 信息安全/ 将/ 带来/ 突出/ 威胁/ :/ 首先/ ,/ Camellia/ 是/ 目前/ 欧洲/ 和/ 日本/ 占/ 主导地位/ 的/ 128/ 位/ 分组/ 加密算法/ ,/ 因此/ ,/ 攻击/ 产生/ 的/ 影响/ 将/ 是/ 广泛/ 而/ 深远/ 的/ ;/ 其次/ ,/ 实施/ 攻击/ 并不需要/ 物理/ 地/ 获得/ 密码/ 执行/ 部件/ 以/ 测量/ 泄漏/ 信息/ ,/ 在/ 网络/ 环境/ 下/ 也/ 可/ 成功/ 获取/ 远程/ 加密/ 服务器/ 密钥/ ;/ 还有/ ,/ 此类/ 攻击/ 能够/ 作用/ 于/ 一切/ 实现/ 于/ “/ Cache/ -/ Memory/ ”/ 层次/ 存储/ 结构/ 计算机设备/ 上/ 软件/ 形式/ 的/ AES/ 算法/ ,/ 从而/ 危害/ 到/ 服务器/ 、/ 桌面/ 以及/ 嵌入式/ 等/ 各种/ 主流/ 的/ 计算机系统/ ./ 因此/ ,/ 应对/ 这/ 类/ 攻击/ 予以/ 充分/ 的/ 关注/ ./ 致谢/ 感谢/ 评审/ 老师/ 们/ 的/ 辛勤工作/ 、/ 郑/ 天明/ 硕士/ 在/ Camellia/ 密钥/ 扩展/ 分析/ 中/ 的/ 精彩/ 讨论/ 、/ 国家/ 现代/ 通信/ 实验室/ 罗岚/ 副研究员/ 对/ 本文/ 提出/ 的/ 宝贵/ 建议/ 以及/ 美国麻省理工学院/ 计算机科学/ 与/ 人工智能/ 实验室/ 的/ TromerEran/ 博士/ 对/ 攻击/ 分析/ 和/ 远程/ 实验/ 的/ 建议/ !/ 

