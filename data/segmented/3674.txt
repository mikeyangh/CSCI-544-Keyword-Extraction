Page1/ 一种/ 时间/ 敏感/ 的/ SSD/ 和/ HDD/ 高效/ 混合/ 存储/ 模型/ 杨/ 濮源/ 金培权/ 岳丽华/ (/ 中国/ 科学技术/ 大学/ 计算机科学/ 与/ 技术/ 学院/ 合肥/ 230027/ )/ 摘要/ 基于/ 闪存/ 的/ 固态/ 硬盘/ (/ SolidStateDriver/ ,/ SSD/ )/ 已/ 成为/ 目前/ 广泛/ 使用/ 的/ 一种/ 持久/ 存储设备/ ./ 但是/ 由于/ 闪存/ 不/ 对称/ 的/ I/ // O/ 特性/ 以及/ 价格/ 因素/ ,/ SSD/ 还/ 不能/ 完全/ 取代/ 传统/ 硬盘/ (/ HardDiskDriver/ ,/ HDD/ )/ ./ 因此/ ,/ 由/ SSD/ 和/ HDD/ 组成/ 的/ 混合/ 存储系统/ 逐步/ 成为/ 目前/ 研究/ 的/ 重点/ ./ 文中/ 针对/ SSD/ 和/ HDD/ 混合/ 存储/ 问题/ ,/ 提出/ 了/ 一个/ 时间/ 敏感/ 的/ 混合/ 存储/ 模型/ 用来/ 有效/ 地/ 利用/ SSD/ ./ 该/ 模型/ 把/ SSD/ 和/ HDD/ 作为/ 同级/ 的/ 存储设备/ ,/ 结合/ 数据/ 页/ 的/ 访问/ 次数/ 以及/ 访问/ 热度/ 实现/ 对/ 页面/ 的/ 准确/ 分类/ 和/ 分配/ ,/ 即将/ 读/ 倾向/ 负载/ 的/ hot/ 页面/ 分配/ 到/ SSD/ 存储/ ,/ 写/ 倾向/ 负载/ 的/ 页面/ 或者/ cold/ 页面/ 分配/ 到/ HDD/ 存储/ ,/ 从而/ 利用/ SSD/ 和/ HDD/ 不/ 对称/ 的/ I/ // O/ 特性/ 来/ 降低/ 系统/ 总/ 的/ I/ // O/ 延迟/ ./ 作者/ 分别/ 在/ 基于/ 高端/ SSD/ 和/ 中端/ SSD/ 的/ 混合/ 存储系统/ 上/ 实现/ 了/ 提出/ 的/ 混合/ 存储/ 模型/ ,/ 并/ 进行/ 了/ 性能/ 评测/ ./ 实验/ 结果显示/ ,/ 作者/ 提出/ 的/ 模型/ 可以/ 实现/ 对/ 数据/ 页/ 更/ 准确/ 的/ 分类/ ,/ 可以/ 有效/ 地/ 降低/ 页面/ 迁移/ 代价/ ,/ 在/ 较/ 少/ 的/ SSD/ 存储/ 条件/ 下/ 取得/ 了/ 显著/ 的/ 性能/ 提升/ ./ 关键词/ 混合/ 存储系统/ ;/ 闪存/ ;/ 固态/ 硬盘/ ;/ 时间/ 敏感/ ;/ 性价比/ 1/ 引言/ 近年来/ 固态/ 硬盘/ (/ SSD/ )/ 已经/ 成为/ 固态/ 技术/ 中/ 的/ 领先/ 技术/ ,/ 最/ 常见/ 的/ SSD/ 都/ 是/ 基于/ NANDFlash/ 芯片/ 设计/ 的/ ./ 虽然/ SSD/ 具有/ 抗震/ 无/ 机械/ 延迟/ 等/ 特点/ ,/ 但是/ 由于/ 闪存/ 介质/ 的/ 物理/ 特性/ ,/ SSD/ 的/ I/ // O/ 性能/ 具有/ 不对称性/ ,/ 一般/ 地/ ,/ SSD/ 具有/ 较/ 高/ 的/ 读/ 性能/ 和/ 较差/ 的/ 随机/ 写/ 性能/ ,/ 所以/ 随机/ 写/ 性能/ 是/ SSD/ 性能/ 的/ 瓶颈/ ./ 此外/ ,/ NAND/ 型/ 闪存/ 具有/ 写前/ 擦除/ 的/ 特点/ ,/ 即/ 闪存/ 芯片/ 不能/ 原位/ 更新/ ,/ 由于/ 每块/ 闪存/ 芯片/ 的/ 擦除/ 次数/ 是/ 有限/ 的/ ,/ 所以/ 擦除/ 次数/ 决定/ 了/ 闪存/ 的/ 寿命/ ./ 也就是说/ ,/ 发生/ 在/ SSD/ 上/ 的/ 写/ 操作/ 不仅/ 影响/ 系统/ 性能/ 而且/ 影响/ SSD/ 的/ 使用寿命/ ./ 因此/ 过多/ 的/ 更新/ 必然/ 会/ 带来/ 频繁/ 的/ 擦除/ 操作/ ,/ 从而/ 会/ 明显/ 地加/ 大S/ SD/ 的/ 写/ 延迟/ 和/ 降低/ SSD/ 的/ 使用寿命/ ./ 相反/ 地/ ,/ 传统/ 磁盘/ (/ HDD/ )/ 具有/ 对称/ 的/ I/ // O/ 性能/ ,/ 写/ 操作/ 也/ 没有/ 如上所述/ 的/ 限制/ ./ 虽然/ 已有/ 许多/ 针对/ SSD/ 磨损/ 均衡/ 的/ 研究/ 工作/ [/ 1/ -/ 3/ ]/ ,/ 但是/ 引入/ HDD/ 来/ 弥补/ SSD/ 的/ 写/ 性能/ 缺陷/ 仍/ 是/ 颇具/ 吸引力/ 的/ ./ 另一方面/ ,/ 尽管/ HDD/ 的/ 读/ 性能比/ SSD/ 差/ 不少/ ,/ 但是/ 它/ 在/ 价格/ 上/ 具有/ 明显/ 的/ 优势/ [/ 4/ ]/ ,/ 所以/ 目前/ 主流/ 的/ 存储系统/ 仍然/ 是/ 以/ 基于/ HDD/ 的/ 为主/ ./ 尽管如此/ ,/ 引入/ 少量/ 的/ SSD/ 到/ 现有/ 的/ 存储系统/ 中是/ 十分/ 有/ 价值/ 的/ ,/ 这/ 不仅/ 能/ 获得/ 明显/ 的/ 系统/ 性能/ 提升/ ,/ 而且/ 在/ 价格/ 成本/ 上/ 也/ 是/ 很/ 有/ 吸引力/ 的/ ./ 综上/ ,/ 利用/ SSD/ 和/ HDD/ 各自/ 优点/ 来/ 设计/ 混合/ 存储系统/ 是/ 存储系统/ 未来/ 的/ 研究/ 热点/ ./ 在/ 混合/ 存储系统/ 中/ ,/ 页面/ 分类/ 算法/ 和/ 迁移/ 策略/ 是/ 非常/ 重要/ 的/ 部分/ ./ 目前/ 已有/ 一些/ 研究者/ 对/ 该/ 问题/ 进行/ 了/ 研究/ [/ 5/ -/ 6/ ]/ ./ 特别/ 地/ ,/ 文献/ [/ 7/ ]/ 基于/ 页面/ 的/ I/ // O/ 统计/ 信息/ 提出/ 了/ 一种/ 迁移/ 模型/ ,/ 该/ 模型/ 根据/ 页面/ 的/ I/ // O/ 统计数据/ 分别/ 计算/ 该/ 页面/ 在/ SSD/ 和/ HDD/ 上/ 的/ I/ // O/ 代价/ ,/ 通过/ 计算结果/ 的/ 分析/ 来/ 对/ 页面/ 进行/ 分类/ ,/ 读/ 倾向/ 的/ 页面/ 会/ 被/ 分配/ 到/ SSD/ 上/ 存储/ ,/ 写/ 倾向/ 的/ 页面/ 则/ 保留/ 在/ HDD/ 上/ 存储/ ./ 很/ 明显/ ,/ 该/ 模型/ 既/ 能/ 利用/ SSD/ 优秀/ 的/ 读/ 性能/ ,/ 又/ 能/ 借助/ HDD/ 来/ 减少/ SSD/ 上/ 的/ 写/ // 擦除/ 操作/ ./ 但是/ ,/ 该/ 模型/ 中/ 的/ I/ // O/ 统计/ 涵盖/ 了/ 该/ 页面/ 自/ 生成/ 以来/ 的/ 所有/ 访问/ 请求/ ,/ 这/ 带来/ 的/ 累积/ 效应/ 将会/ 使/ 该/ 模型/ 在/ 访问/ 负载/ 变化/ 时/ 不能/ 快速反应/ ./ 另一方面/ ,/ 因为/ 闪存/ 不/ 对称/ 的/ I/ // O/ 特性/ ,/ hot/ // cold/ 的/ 概念/ 很/ 早就/ 被/ 研究者/ 引入/ 到/ 关于/ 闪存/ 的/ 研究/ 中/ [/ 8/ -/ 10/ ]/ ./ 一般/ 地/ ,/ 被/ 频繁/ 访问/ 的/ 页面/ 我们/ 认为/ 是/ hot/ 页面/ ,/ 非/ 频繁/ 访问/ 的/ 页面/ 被/ 认为/ 是/ cold/ 页面/ ./ 基本/ 的/ 研究/ 思想/ 是/ 对/ 存储/ 在/ 闪存/ 上/ 的/ 频繁/ 更新/ 的/ hot/ 页面/ 进行/ 缓冲/ 以/ 实现/ 批量/ 更新/ ,/ 从而/ 减少/ 闪存/ 上/ 的/ 物理/ 写/ ./ 已有/ 大量/ 的/ 研究/ 工作/ 基于/ 该/ 思想/ 来/ 对/ 闪存/ 存储/ 进行/ 改进/ ./ 近年来/ ,/ 已有/ 一些/ 研究者/ 尝试/ 将/ 该/ 思想/ 应用/ 到/ 混合/ 存储/ 领域/ [/ 11/ -/ 12/ ]/ ,/ 他们/ 的/ 研究/ 工作/ 显示/ hot/ // cold/ 的/ 方法/ 是/ 值得/ 考虑/ 的/ ./ 由于/ hot/ 页面/ 有/ 更/ 高/ 访问/ 概率/ ,/ 那么/ 当/ 这些/ 页面/ 存储/ 在/ SSD/ 上时/ ,/ 因为/ SSD/ 优秀/ 的/ 读/ 性能/ ,/ 这/ 就/ 能/ 带来/ 明显/ 的/ 性能/ 提升/ ./ 已有/ 的/ 研究/ 工作/ 表明/ ,/ 混合/ 存储系统/ 一定/ 会/ 带来/ 额外/ 的/ 迁移/ 代价/ [/ 13/ ]/ ./ 当/ SSD/ 和/ HDD/ 之间/ 的/ 迁移/ 操作/ 增加/ 时/ ,/ 缓冲/ 中/ 的/ 一些/ 干净/ 页面/ 会/ 发生/ 迁移/ ,/ 这些/ 迁移/ 会/ 带来/ 额外/ 的/ 写/ 操作/ ,/ 从而/ 增大/ 整个/ 系统/ 的/ I/ // O/ 延迟/ ,/ 所以/ 研究/ 中/ 迁移/ 代价/ 是/ 必须/ 考虑/ 的/ 因素/ ,/ 同时/ 对/ 页面/ 准确/ 分类/ 也/ 能/ 有效/ 减少/ 迁移/ 操作/ ./ 另外/ ,/ 因为/ SSD/ 高昂/ 的/ 价格/ ,/ 混合/ 存储系统/ 的/ 性价比/ 也/ 是/ 我们/ 必须/ 考察/ 的/ 因素/ ./ 基于/ 一种/ 改进/ 的/ I/ // O/ 代价/ 计算/ 模型/ 和/ hot/ // cold/ 概念/ ,/ 本文/ 提出/ 了/ 一种/ 混合/ 存储/ 模型/ ,/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 页面/ 热度/ 状态/ 转换/ ./ 为了/ 准确/ 地区/ 分/ 页面/ 热度/ ,/ 我们/ 在/ 传统/ 的/ hot/ // cold/ 概念/ 中/ 引入/ 了/ “/ warm/ ”/ 状态/ ./ 基本/ 的/ 方法/ 是/ 设置/ 一个/ 时间/ 阈值/ t/ ,/ 一个/ 页面/ 的/ 两次/ 连续/ 的/ 物理/ 访问/ 之间/ 的/ 时间/ 间隔/ 如果/ 大于/ 该/ 阈值/ ,/ 则/ 该/ 页面/ 会/ 由/ hot/ 变为/ warm/ 或者/ 由/ warm/ 变为/ cold/ ;/ 相反/ 时间/ 间隔/ 如果/ 小于/ 该/ 阈值/ ,/ 则/ 页面/ 会/ 由/ cold/ 变为/ warm/ 或者/ 有/ warm/ 变为/ hot/ ./ 页面/ 的/ 热度/ 状态/ 转换/ 如图/ 1/ 所示/ ,/ 该/ 机制/ 能够/ 有效/ 识别/ 出/ 偶尔/ 变热/ 的/ cold/ 页面/ 从而/ 减少/ 不必要/ 的/ 迁移/ 操作/ ./ (/ 2/ )/ 时间/ 衰减/ 因子/ ./ 基于/ 前/ 文/ 提到/ 的/ 迁移/ 模型/ [/ 7/ ]/ ,/ 我们/ 在/ I/ // O/ 统计/ 和/ I/ // O/ 代价/ 计算方法/ 中/ 引入/ 了/ 衰减/ 因子/ ./ 如果/ 一个/ 页面/ 的/ 热度/ 状态/ 在/ hot/ // cold/ 之间/ 转换/ 或者/ 物理/ 访问/ 之间/ 的/ 时间/ 间隔/ 过长/ ,/ 那么/ 我们/ 将会/ 根据/ 该/ 衰减/ 因子/ 降低/ I/ // O/ 代价/ 计算/ 的/ 值/ 对/ 页面/ 分类/ 的/ 影响/ 并且/ 重置/ I/ // O/ 统计/ 值/ ./ 因此/ ,/ 在/ 本文/ 的/ 方法/ 中/ ,/ 当/ 一个/ 页面/ 访问/ 稀疏/ 时/ ,/ 它/ 的/ I/ // O/ 统计/ 对/ 页面/ 当前/ 的/ 分类/ 判断/ 影响/ 很/ 微弱/ ,/ 这/ 就/ 避免/ 了/ 统计/ 的/ 累积/ 效应/ 对/ 当前/ 负载/ 分析/ 的/ 不利/ 影响/ ./ (/ 3/ )/ 性价比/ 分析/ ./ 因为/ SSD/ 高昂/ 的/ 价格/ ,/ 我们/ 的/ 目标/ 是/ 只/ 将/ 有限/ 的/ SSD/ 引入/ 基于/ 磁盘/ 的/ 存储体系/ 来/ 使/ 存储系统/ 获得/ 明显/ 的/ 性能/ 提升/ ./ 为了/ 充分利用/ 有限/ 的/ SSD/ ,/ 对/ 页面/ 的/ 分类/ 就/ 必须/ 准确/ ./ 在/ 局部/ 时间/ Page3/ 内/ ,/ 我们/ 选择/ 读/ 倾向/ 的/ 页面/ 存储/ 在/ SSD/ 上/ ,/ 写/ 倾向/ 的/ 页面/ 存储/ 在/ HDD/ 上/ ./ 另一方面/ ,/ 由于/ SSD/ 的/ 存储空间/ 有限/ ,/ 我们/ 需要/ 考虑/ SSD/ 上/ 的/ 置换/ 操作/ ,/ 因为/ 闪存/ 的/ 擦除/ 操作/ 是/ 以/ 一个/ block/ 为/ 单位/ ,/ 所以/ 我们/ 设计/ 一个/ block/ 级/ 的/ LRU/ 队列/ 来/ 管理/ SSD/ 上/ 的/ 页面/ ,/ 当/ SSD/ 达到/ 存储/ 上限/ 时/ ,/ LRU/ 队列/ 尾部/ 的/ block/ 将会/ 被/ 置换/ 出/ 迁移/ 到/ HDD/ 上/ ./ 为了/ 衡量/ 系统/ 的/ 性价比/ ,/ 我们/ 列出/ 如下/ 公式/ ratio/ =/ Improvement/ -/ of/ -/ Hybrid/ -/ Storage/ 在/ 第/ 3/ 节/ ,/ 我们/ 会/ 将/ SSD/ 和/ HDD/ 以/ 各种/ 容量/ 比例/ 进行/ 组合/ 并且/ 分析/ 各个/ 组合/ 的/ 性价比/ ,/ 从而/ 获得/ 混合/ 存储系统/ 合适/ 的/ 组合/ 方式/ ./ 本文/ 第/ 2/ 节/ 给出/ 混合/ 存储/ 模型/ ,/ 并/ 详细/ 讨论/ 其中/ 的/ 迁移/ 模型/ 和/ 页面/ 分类/ 方法/ ;/ 第/ 3/ 节/ 给出/ 该/ 混合/ 模型/ 的/ 实现/ 和/ 相关/ 的/ 实验/ 结果/ ;/ 最后/ 第/ 4/ 节对/ 本文/ 的/ 工作/ 进行/ 总结/ ./ 2SSD/ -/ HDD/ 混合/ 存储/ 模型/ 2.1/ 混合/ 存储/ 的/ 体系结构/ 本文/ 提出/ 的/ 混合/ 存储/ 模型/ 架构/ 如图/ 2/ 所示/ ,/ 图中/ 箭头/ 表示/ 数据/ 页面/ 的/ 流向/ ,/ 最小/ 的/ 正方形/ 代表/ 页面/ ,/ 较大/ 的/ 长方形/ 表示/ 数据/ 块/ (/ block/ )/ ,/ 根据/ 闪存/ 的/ 物理/ 结构/ ,/ 我们/ 将/ 64/ 个/ 数据/ 页面/ 组成/ 一个/ block/ ./ 在/ 缓冲区/ 中/ ,/ 页面/ 以/ 一个/ LRU/ 列表/ 进行/ 管理/ ,/ 刚/ 进入/ 缓冲区/ 的/ 页面/ 置于/ LRU/ 的/ 队头/ ,/ 置换/ 页面/ 则/ 从队/ 尾/ 选择/ ./ 当/ 一个/ 页面/ 被/ 读取/ 到/ 缓冲区/ 中/ 时/ ,/ 页面/ 首先/ 会/ 被/ 热度/ 状态/ 转换/ 模块/ 更新/ 热度/ 状态/ 和/ 访问/ 时间/ 信息/ ,/ 这部分/ 将/ 在/ 2.2/ 节/ 论述/ ./ 当/ 一个/ 页面/ 从/ 缓冲区/ 置换/ 出来/ 时/ ,/ 页面/ 分类/ 模块/ (/ placementtrendcalcula/ -/ tionanddecay/ )/ 会/ 计算/ 根据/ 该/ 页面/ 的/ I/ // O/ 统计/ 信息/ 和/ 热度/ 状态/ 计算/ 它/ 的/ 存储/ 倾向/ ,/ 这部分/ 将/ 在/ 2.3/ 节/ 论述/ ./ 页面/ 分类/ 模块/ 是/ 以/ 热度/ 状态/ 转换/ 模块/ 为/ 基础/ 的/ ./ 另外/ ,/ 本文/ 为/ SSD/ 和/ HDD/ 分别/ 设计/ 了/ 存储管理/ 模块/ ,/ 它们/ 的/ 地址/ 空间/ 也/ 是/ 分别独立/ 的/ ,/ 任何/ 时候/ ,/ 一个/ 数据/ 页面/ 只能/ 存在/ 于/ 其中/ 一个/ 设备/ 上/ ./ 比如/ ,/ 如果/ 一个/ 页面/ 分配/ 在/ HDD/ 上/ 存储/ ,/ 那么/ 它/ 只有/ 一个/ HDD/ 上/ 的/ 地址/ ,/ 当/ 它/ 迁移/ 到/ SSD/ 上时/ ,/ 它/ 将/ 被/ 分配/ 一个/ SSD/ 上/ 的/ 地址/ ,/ 同时/ HDD/ 上/ 的/ 地址/ 将/ 被/ 回收/ ./ 因为/ SSD/ 上/ 的/ 存储空间/ 有限/ ,/ SSD/ 的/ 地址/ 空间/ 可能/ 将会/ 用尽/ ./ 由于/ SSD/ 上/ 的/ 页面/ 是/ 以/ block/ 为/ 单位/ 以/ LRU/ 列表/ 管理/ ,/ 所以/ 当/ SSD/ “/ 满/ ”/ 时/ ,/ LRU/ 列表/ 尾部/ 的/ block/ 将会/ 被/ 迁移/ 到/ HDD/ ./ 为了/ 方便/ 快速/ 查询/ ,/ 我们/ 需要/ 记录/ 页面/ 的/ 存储/ 位置/ 并/ 分别/ 为/ SSD/ 和/ HDD/ 上/ 的/ 页面/ 建立/ 索引/ ,/ 这/ 将/ 在/ 3.1/ 节/ 论述/ ./ 当/ 查询/ 一个/ 页面/ 时/ ,/ 总是/ 优先/ 在/ SSD/ 的/ 索引/ 上/ 查找/ ,/ 因为/ 该/ 索引/ 较/ 小/ 并且/ SSD/ 的/ 读/ 速度/ 较快/ ./ 如果/ 该/ 页面/ 在/ SSD/ 索引/ 上/ 未找到/ ,/ 再/ 到/ HDD/ 索引/ 上/ 查找/ ./ 基于/ 上述/ 的/ 存储管理/ 模块/ ,/ 迁移/ 操作/ 不仅/ 将/ 改变/ 页面/ 的/ 存储/ 位置/ ,/ 而且/ 将/ 更新/ SSD/ 和/ HDD/ 的/ 索引/ 信息/ ,/ 因此/ 我们/ 的/ 迁移/ 操作/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 迁移/ 操作/ ./ migratePage/ (/ Pagepg/ )/ 1/ ./ ifpg/ ./ placement/ =/ SSDthen2/ ./ pg/ ./ placement/ ←/ HDD/ ;/ 3/ ./ RemovepgfromSSDindexandinsertintoHDD4/ ./ elseifpg/ ./ placement/ =/ HDDthen5/ ./ pg/ ./ placement/ ←/ SSD/ ;/ 6/ ./ removepgfromHDDindexandinsertintoSSD7/ ./ endif8/ ./ setpgisdirty/ ./ 2.2/ 热度/ 状态/ 转换/ 模块/ 已有/ 的/ 关于/ 闪存/ 存储/ 的/ 研究/ 工作/ 常常/ 利用/ hot/ // cold/ 的/ 概念/ 来/ 对/ 页面/ 进行/ 分类/ ./ 将/ 传统/ 的/ hot/ // cold/ 概念/ 引入/ 混合/ 存储系统/ 中/ ,/ 因为/ SSD/ 随机/ 写/ 的/ 延迟/ 较大/ ,/ SSD/ 和/ HDD/ 之间/ 的/ 迁移/ 代价/ 是/ 必须/ 考虑/ 的/ 问题/ ./ 比如/ ,/ 假设/ 一个/ 页面/ 一直/ 是/ cold/ 状态/ ,/ 某/ 次访问/ 是/ 一次/ 热/ 访问/ (/ 即/ 访问/ 的/ 时间/ 间隔/ 很小/ )/ ,/ 这次/ 访问/ 使/ 系统/ 误判/ 它/ 为/ hot/ 页面/ ,/ 从而/ 带来/ 一次/ 迁移/ 操作/ ./ 但是/ 紧接着/ 该/ 页面/ 又/ 回到/ cold/ 状态/ ,/ 这/ 可能/ 又/ 会/ 带来/ 一次/ 迁移/ 操作/ ,/ 所以/ 不/ 准确/ 的/ 页面/ 分类/ 会/ 使/ 迁移/ 操作/ 大大增加/ ./ 为/ 避免/ 这种/ 情况/ ,/ 我们/ 提出/ Page4/ 了/ “/ warm/ ”/ 的/ 概念/ 来/ 补充/ 传统/ 的/ hot/ // cold/ 思想/ ,/ 这样/ 页面/ 就/ 无法/ 在/ hot/ 和/ cold/ 状态/ 之间/ 直接/ 转换/ ,/ 引入/ “/ warm/ ”/ 状态/ 对/ 混合/ 模型/ 的/ 作用/ 将/ 在/ 3.6/ 节/ 实验/ 讨论/ ./ 本文/ 的/ 热度/ 转换/ 模块/ 是/ 基于/ 页面/ 的/ 物理/ 访问/ 时间/ 的/ ./ 每个/ 页面/ 的/ 物理/ 访问/ 时间/ 都/ 会/ 被/ 系统/ 记录/ ,/ 参数/ t2/ 表示/ 页面/ 的/ 当前/ 物理/ 访问/ 时间/ ,/ 参数/ t1/ 表示/ 页面/ 的/ 上/ 一次/ 物理/ 访问/ 时间/ ./ 如果/ 两次/ 连续/ 的/ 物理/ 访问/ 间隔/ 大于/ 阈值/ t/ ,/ 则/ 当前/ 访问/ 为/ cold/ 访问/ ,/ 相反/ 则/ 为/ hot/ 访问/ ./ 本文/ 中/ 的/ 访问/ 时间/ 都/ 是/ 以/ 页面/ 的/ 访问/ 计数/ 表示/ ,/ 例如/ 从/ 系统启动/ 到/ 当前/ 为止/ 有/ N/ 次/ 页面/ 访问/ 请求/ ,/ 那么/ 当前/ 时间/ 为/ N/ ./ 对于/ 页面/ 的/ hot/ // cold/ 状态/ ,/ 参数/ cold1/ 和/ cold2/ 分别/ 记录/ 上次/ cold/ 访问/ 时间/ 和/ 当前/ cold/ 访问/ 时间/ ,/ 参数/ hot1/ 和/ hot2/ 类似/ ./ 系统/ 中/ SSD/ 和/ HDD/ 的/ 容量/ 以/ 可以/ 存储/ 的/ 页面/ 数目/ 衡量/ ,/ 参数/ ssdSize/ 表示/ SSD/ 的/ 存储容量/ ,/ 参数/ hddSize/ 表示/ HDD/ 的/ 存储容量/ ./ 每当/ 页面/ 发生/ 物理/ 访问/ 时/ ,/ 它/ 的/ 访问/ 时间/ 都/ 会/ 被/ 更新/ ,/ 如表/ 1/ 所示/ ./ 如果/ hot2/ >/ hot1/ ,/ 那么/ 该/ 页面/ 处在/ hot/ 状态/ ,/ 并且/ hot1/ 是/ 该/ 当前/ hot/ 状态/ 的/ 第/ 1/ 次访问/ 时间/ ./ cold/ 状态/ 的/ 时间/ 记录/ 与/ 之/ 类似/ ./ hot2/ =/ currenttimecold1/ =/ currenttimecold2/ =/ currenttime/ 物理/ 访问/ 时间/ 更新/ 之后/ ,/ 页面/ 的/ 热度/ 状态/ 会/ 根据/ 它/ 的/ 访问/ 时间/ 进行/ 更新/ ./ 图/ 1/ 所示/ 的/ 状态/ 转换/ 将/ 根据/ 表/ 2/ 所示/ 的/ 实现/ ./ 综合/ 考虑/ 表/ 1/ 和表/ 2/ ,/ 我们/ 可以/ 发现/ 页面/ 能够/ 在/ hot/ 和/ cold/ 状态/ 停留/ ,/ 但是/ 不能/ 保持/ 在/ warm/ 状态/ ./ 一个/ cold/ (/ hot/ )/ 页面/ 只有/ 经过/ 两次/ 连续/ 的/ hot/ 访问/ 才能/ 转换/ 为/ hot/ (/ cold/ )/ 页面/ ,/ 因此/ 偶尔/ 的/ 一次/ 访问/ 负载/ 变化/ 不会/ 带来/ 热度/ 状态/ 的/ 变化/ ,/ 这样/ 就/ 能/ 避免/ 一些/ 不必要/ 的/ 迁移/ 操作/ ./ 下/ 所示/ ./ hot2/ >/ hot1cold2/ >/ cold1/ 结合/ 表/ 1/ 和表/ 2/ ,/ 我们/ 提出/ 了/ 热度/ 转换/ 算法/ ,/ 如/ 算法/ 2/ ./ 热度/ 转换/ ./ updateState/ (/ Pagepg/ )/ 1/ ./ pg/ ./ t1/ ←/ pg/ ./ t2/ ;/ 2/ ./ pg/ ./ t2/ ←/ currenttime/ ;/ 3/ ./ interval/ ←/ pg/ ./ t2/ -/ pg/ ./ t1/ ;/ 4/ ./ // // updatepageaccesstime5/ ./ ifinterval/ / ssdSizethen6/ ./ pg/ ./ hot2/ ←/ currenttime/ ;/ 7/ ./ pg/ ./ cold1/ ←/ currenttime/ ;/ 8/ ./ elseifinterval/ >/ ssdSizethen9/ ./ pg/ ./ hot1/ ←/ currenttime/ ;/ 10/ ./ pg/ ./ cold2/ ←/ currenttime/ ;/ 11/ ./ endif12/ ./ // // updatepagestate/ ;/ 13/ ./ pg/ ./ changeFlag/ ←/ false14/ ./ ifpg/ ./ hot2/ >/ pg/ ./ hot1then15/ ./ ifpg/ ./ state/ =/ coldthen16/ ./ pg/ ./ state/ ←/ warm/ ;/ 17/ ./ elseifpg/ ./ state/ =/ warmthen18/ ./ pg/ ./ state/ ←/ warm/ ;/ 19/ ./ pg/ ./ changeFlag/ ←/ true/ ;/ 20/ ./ endif21/ ./ elseifpg/ ./ hot2/ </ pg/ ./ hot1then22/ ./ ifpg/ ./ state/ =/ hotthen23/ ./ pg/ ./ state/ ←/ warm/ ;/ 24/ ./ elseifpg/ ./ state/ =/ warmthen25/ ./ pg/ ./ state/ ←/ cold/ ;/ 26/ ./ pg/ ./ changeFlag/ ←/ true/ ;/ 27/ ./ endif28/ ./ endif/ 在/ 算法/ 2/ 中/ ,/ 参数/ changeFlag/ 是/ 状态/ 转换/ 的/ 标志/ ,/ 它/ 的/ 默认值/ 是/ false/ ,/ 当/ 页面/ 状态/ 由/ warm/ 变为/ cold/ 或者/ hot/ 时/ ,/ 该/ 参数/ 的/ 值/ 变为/ true/ ,/ 这个/ 参数/ 是/ 为/ 后/ 文中/ I/ // O/ 统计/ 重置/ 的/ 标志/ ./ 1/ ~/ 11/ 行/ 描述/ 了/ 页面/ 访问/ 时间/ 的/ 更新/ ,/ 14/ ~/ 28/ 行/ 描述/ 了/ 热度/ 状态/ 的/ 更新/ ,/ 实现/ 了/ 图/ 1/ 所示/ 的/ 状态/ 转移/ ./ 基于/ 本节/ 的/ 热度/ 转移/ 模块/ ,/ 本文/ 接下来/ 将/ 讨论/ 页面/ 的/ 定位/ 倾向/ (/ SSD/ 或/ HDD/ )/ ./ 这/ 一节/ 主要/ 从/ 时间/ 角度/ 讨论/ 了/ 页面/ 的/ 负载/ ,/ 下/ 一节/ 将/ 从/ 空间/ 角度/ 讨论/ 该/ 问题/ ./ 2.3/ 页面/ 定位/ 倾向/ 和/ 衰减/ 因为/ 闪存/ 不/ 对称/ 的/ I/ // O/ 特性/ ,/ 不仅/ 页面/ 的/ 访问/ 热度/ 而且/ 页面/ 的/ I/ // O/ 负载/ 也/ 会/ 影响/ 页面/ 的/ 定位/ ./ 在/ 此/ 我们/ 引入/ 一个/ 概念/ :/ “/ 页面/ 定位/ 倾向/ ”/ ,/ 它/ 表示/ 页面/ 存储/ 在/ SSD/ 或者/ HDD/ 上/ 的/ 倾向性/ ./ 根据/ 页面/ 的/ I/ // O/ 统计/ ,/ 通过/ 计算/ 对比/ 页面/ 在/ SSD/ 和/ HDD/ 上/ I/ // O/ 代价/ ,/ 我们/ 可以/ 得到/ 页面/ 定位/ 倾向/ 的/ 计算/ 值/ 从而/ 确定/ 页面/ 的/ 存储/ 位置/ ./ 类似/ 于/ 文献/ [/ 7/ ,/ 13/ ]/ 所/ 讨论/ 的/ ,/ 页面/ 定位/ 倾向/ 是/ 根据/ 页面/ 负载/ 的/ I/ // O/ 代价/ 来/ 计算/ 的/ ./ 文献/ [/ 7/ ]/ 提出/ Page5/ 的/ 迁移/ 模型/ 基于/ 页面/ 的/ 访问/ 统计/ ,/ 有效/ 地/ 计算/ 出/ 了/ 页面/ 的/ I/ // O/ 代价/ 和/ 读写/ 倾向/ ./ 但是/ 因为/ 该/ 模型/ 中/ 的/ 计算/ 是/ 基于/ 页面/ 分配/ 以来/ 的/ I/ // O/ 统计/ 的/ ,/ 所以/ 它/ 具有/ 明显/ 的/ 累积/ 效应/ ./ 这/ 意味着/ 以前/ 长时间/ 的/ 访问/ 负载/ 和/ 当前/ 的/ 访问/ 负载/ 对/ 当前/ 的/ 页面/ 定位/ 有着/ 相同/ 的/ 影响/ ./ 由于/ 累积/ 效应/ ,/ 页面/ 以前/ 的/ 访问/ 负载/ 积累/ 的/ I/ // O/ 统计/ 值/ 将/ 会/ 很大/ ,/ 从而/ 使该/ 模型/ 对/ 当前/ 的/ 访问/ 负载/ 变化/ 不够/ 敏感/ ,/ 这/ 将/ 会/ 导致/ 不/ 准确/ 的/ 页面/ 定位/ ,/ 特别/ 是/ 当/ SSD/ 容量/ 有限/ 时/ ,/ 会/ 造成/ SSD/ 存储空间/ 的/ 浪费/ ./ 因为/ SSD/ 高昂/ 的/ 价格/ ,/ 本文/ 假设/ 设计/ 环境/ 是/ 基于/ 有限/ 容量/ 的/ SSD/ 的/ ./ 因此/ 我们/ 需要/ 构建/ 一个/ 准确/ 的/ 、/ 敏感/ 的/ 页面/ 定位/ 倾向/ 计算/ 模型/ ./ 以/ 文献/ [/ 7/ ]/ 的/ 模型/ 为/ 基础/ ,/ 本文/ 引入/ 时间/ 衰减/ 因子/ 来/ 改进/ 方案/ ./ 首先/ 本文/ 引入/ 了/ 页面/ I/ // O/ 代价/ 计算方法/ ./ 对于/ 一个/ 数据/ 页面/ ,/ 它/ 的/ 物理/ 访问/ 和/ 逻辑/ 访问/ 都/ 被/ 列入/ 统计/ ,/ 并且/ 一个/ 物理/ 访问/ 操作/ 对/ I/ // O/ 代价/ 的/ 计算/ 比/ 逻辑/ 访问/ 操作/ 有/ 更/ 大/ 的/ 影响/ ./ 如/ 算法/ 3/ 所示/ ,/ ssdCost/ 和/ hdd/ -/ Cost/ 分别/ 表示/ 页面/ 在/ SSD/ 和/ HDD/ 上/ 访问/ 的/ I/ // O/ 代价/ ./ 对于/ 一个/ 页面/ ,/ 假定/ 一个/ 逻辑/ 访问/ 操作/ 有/ 一定/ 概率/ 变为/ 物理/ 访问/ ./ 为了/ 得到/ 更/ 准确/ 的/ 结果/ ,/ 这个/ 概率/ 和/ 文献/ [/ 7/ ]/ 模型/ 中所提/ 的/ 概率/ 并/ 不/ 一样/ ./ 文献/ [/ 7/ ]/ 中/ 的/ 概率/ 是/ 一个/ 常量/ ,/ 它/ 的/ 计算/ 式/ 为/ 1/ -/ b/ // n/ ,/ b/ 表示/ 缓冲区/ 的/ 容量/ ,/ n/ 表示/ 页面/ 的/ 总/ 数目/ ,/ 文献/ [/ 7/ ]/ 利用/ 该/ 常量/ 作为/ 逻辑/ 操作/ 转变/ 为/ 物理/ 操作/ 的/ 概率/ ./ 对应/ 地/ ,/ 本文/ 所提/ 的/ 概率/ 并/ 不是/ 一个/ 常量/ ,/ 由/ 算法/ 3/ 的/ 第/ 2/ 行/ 所示/ ,/ 每个/ 页面/ 的/ 概率/ 都/ 以/ 公式/ 1/ -/ l/ // N/ 来/ 计算/ ,/ l/ 表示/ 单个/ 页面/ 的/ 逻辑/ 访问/ 操作/ 计数/ ,/ N/ 表示/ 页面/ 所有/ 访问/ 操作/ 的/ 计数/ ./ 所以/ 不同/ 的/ 页面/ 拥有/ 不同/ 的/ 概率/ 值/ ,/ 这/ 也/ 反映/ 了/ 不同/ 页面/ 各自/ 的/ 访问/ 负载/ ./ 如/ 算法/ 3/ 所示/ ,/ 本文/ 利用/ 这个/ 概率/ 值来/ 衡量/ 逻辑/ 访问/ 操作/ 对/ I/ // O/ 代价/ 计算/ 的/ 影响/ ./ 算法/ 3/ ./ 倾向/ 计算/ ./ trendCalculate/ (/ Pagepg/ )/ 1/ ./ flag/ ←/ true/ // // theflagofwhethertrendisreduced/ ;/ 2/ ./ q/ ←/ 1/ -/ (/ pg/ ./ lr/ +/ pg/ ./ lw/ )/ // pg/ ./ totalaccess/ ;/ 3/ ./ // // calculatetheI/ // OcostonSSDandHDD4/ ./ ssdcost/ ←/ pg/ ./ lr/ ·/ q/ +/ pg/ ./ p5/ ./ pg/ ./ lw/ ·/ q/ +/ pg/ ./ p6/ ./ hddcost/ ←/ pg/ ./ lr/ ·/ q/ +/ pg/ ./ p7/ ./ pg/ ./ lw/ ·/ q/ +/ pg/ ./ p8/ ./ // // calculatethetrendanditsreduce9/ ./ ifpg/ ./ state/ =/ hotthen10/ ./ ifpg/ ./ changeFlag/ =/ truethen11/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 12/ ./ pg/ ./ pretrend/ ;/ 13/ ./ pg/ ./ pretrend/ ←/ pg/ ./ trend/ ·/ β/ ;/ 14/ ./ pg/ ./ changeFlag/ ←/ false/ ;/ flag/ ←/ true/ ;/ 15/ ./ else16/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 17.18/ ./ flag/ ←/ false/ ;/ 19/ ./ endif20/ ./ elseifpg/ ./ state/ =/ warmthen21/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 22/ ./ pg/ ./ pretrend/ ;/ 23/ ./ flag/ ←/ false/ ;/ 24/ ./ elseifpg/ ./ state/ =/ coldthen25/ ./ ifpg/ ./ changeFlag/ =/ truethen26/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 27.28/ ./ pg/ ./ pretrend/ ←/ pg/ ./ trend/ ·/ β/ ;/ 29/ ./ pg/ ./ changeFlag/ ←/ false/ ;/ flag/ ←/ true/ ;/ 30/ ./ else31/ ./ interval/ ←/ pg/ ./ cold2/ -/ pg/ ./ cold1/ ;/ 32/ ./ ifinterval/ // ssdSize/ </ hddSize/ // ssdSizethen33/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 34.35/ ./ flag/ ←/ false/ ;/ 36/ ./ else37/ ./ pg/ ./ pretrend/ ←/ pg/ ./ trend/ ·/ β/ ·/ 38/ ./ (/ ssdSize/ // interval/ )/ ;/ 39/ ./ pg/ ./ trend/ ←/ ssdcost/ -/ (/ 40/ ./ flag/ ←/ true41/ ./ endif42/ ./ endif43/ ./ endif44/ ./ // // resetthecounter45/ ./ ifflag/ =/ truethen46/ ./ pg/ ./ lr/ ←/ 0/ ;/ pg/ ./ lw/ ←/ 0/ ;/ pg/ ./ pr/ ←/ 0/ ;/ pg/ ./ pw/ ←/ 0/ ;/ 47/ ./ endif48/ ./ ifpg/ ./ trend/ >/ ws/ +/ whandpg/ ./ trend/ </ 0then49/ ./ returnSSD/ -/ trend/ ;/ 50/ ./ elseifpg/ ./ trend/ >/ ws/ +/ whandpg/ ./ trend/ >/ 051/ ./ returnHDD/ -/ trend/ ;/ 52/ ./ else53/ ./ returnpg/ ./ placement/ ;/ 54/ ./ endif/ 每当/ 页面/ 被/ 访问/ ,/ 它/ 的/ 访问/ 计数/ 就/ 会/ 被/ 更新/ ./ 对于/ 每个/ 迁移/ 的/ 页面/ ,/ 我们/ 假定/ 它/ 还/ 会/ 迁移/ 回来/ ./ 比如/ ,/ 当/ HDD/ 上/ 的/ 一个/ 页面/ 被/ 迁移/ 到/ SSD/ 上/ ,/ 这会/ 有/ 一次/ SSD/ 上/ 的/ 写/ 代价/ ,/ 然后/ 该/ 页面/ 可能/ 会/ 被/ 迁移/ 回来/ ,/ 这/ 又/ 会/ 带来/ 一次/ HDD/ 上/ 的/ 写/ 代价/ ./ 所以/ 一个/ 页面/ 迁移/ 代价/ 是/ SSD/ 和/ HDD/ 上/ 写/ 代价/ 的/ 和/ ./ 如/ 算法/ 3/ 的/ 48/ 和/ 50/ 行/ 所示/ ,/ trend/ </ 0/ 表示/ 页面/ 存储/ 在/ Page6SSD/ 上/ I/ // O/ 代价/ 较/ 小/ ,/ trend/ >/ 0/ 表示/ 页面/ 存储/ 在/ HDD/ 上/ I/ // O/ 代价/ 较/ 小/ ./ 参数/ trend/ 表示/ 迁移/ 操作/ 带来/ 的/ 收益/ ./ 所以/ 迁移/ 操作/ 只能/ 在/ 收益/ trend/ 超过/ 迁移/ 代价/ 时/ 发生/ ./ 如/ 算法/ 3/ 所示/ ,/ 本文/ 的/ 模型/ 为/ 每个/ 页面/ 维护/ 了/ 5/ 个/ 计数器/ :/ lr/ 和/ lw/ 统计/ 页面/ 的/ 逻辑/ 读写操作/ ;/ pr/ 和/ pw/ 统计/ 页面/ 的/ 物理/ 读写操作/ ;/ totalaccess/ 统计/ 所有/ 的/ 访问/ 操作/ ;/ rs/ ,/ rh/ 分别/ 表示/ SSD/ 和/ HDD/ 上/ 的/ 物理/ 读/ 代价/ ;/ ws/ ,/ wh/ 分别/ 表示/ SSD/ 和/ HDD/ 上/ 的/ 物理/ 写/ 代价/ ./ 两个/ 基本/ 的/ 参数/ ssdcost/ 和/ hddcost/ 分别/ 表示/ 页面/ 在/ SSD/ 和/ HDD/ 上/ 访问/ 的/ I/ // O/ 代价/ ,/ 参数/ trend/ 表示/ 页面/ 的/ 定位/ 倾向/ ,/ 每当/ 页面/ 从/ 缓冲区/ 置换/ 时该/ 参数/ 被/ 更新/ ./ trend/ </ 0/ 表示/ ssdcost/ 比/ hdd/ -/ cost/ 小/ ,/ 这/ 意味着/ 页面/ 应该/ 存储/ 在/ SSD/ 上/ ,/ 反之/ ,/ 页面/ 就/ 应该/ 存储/ 在/ HDD/ 上/ ./ 当/ 考虑/ 到/ 迁移/ 代价/ 时/ ,/ 实际/ 的/ 定位/ 倾向/ 判断/ 会/ 更/ 复杂/ 一些/ ,/ 正如/ 算法/ 5/ 所示/ ./ 另/ 一/ 参数/ pretrend/ 存储/ 了/ 衰减/ 后/ 的/ 定位/ 倾向/ 值/ ,/ 当/ pretrend/ 被/ 更新/ 时/ ,/ 访问/ 计数/ 会/ 被/ 重置/ ./ 参数/ β/ 表示/ 衰减/ 因子/ ,/ 它/ 是/ 一个/ 小于/ 1/ 的/ 常量/ (/ 实验/ 中/ 设置/ 为/ 0.1/ )/ ,/ 页面/ 定位/ 倾向/ 在/ 3/ 种/ 状态/ 下/ 的/ 计算/ 由/ 算法/ 3/ 中/ 8/ ~/ 43/ 行/ 所示/ ,/ 在/ 两种/ 情况/ 下/ ,/ trend/ 会/ 按/ 因子/ β/ 减小/ ./ (/ 1/ )/ 当/ 页面/ 热度/ 状态/ 从/ warm/ 变为/ hot/ 或者/ cold/ 时/ ,/ 这/ 暗示着/ 页面/ 的/ 当前/ 访问/ 负载/ 可能/ 发生变化/ ,/ 读写/ 倾向性/ 发生/ 改变/ ,/ 所以/ 该/ 页面/ 先前/ 的/ 定位/ 倾向/ 和/ 访问/ 统计/ 对/ 当前/ 的/ 计算/ 不/ 应该/ 有太大/ 的/ 影响/ ./ 定位/ 倾向/ 参数/ trend/ 按/ 因子/ β/ 减小/ ,/ 并且/ 访问/ 统计/ 重置/ ./ (/ 2/ )/ HDD/ 的/ 容量/ 大小/ 设为/ hddSize/ ,/ 假定/ 每个/ 页面/ 在/ hddSize/ 次/ 的/ 访问/ 中/ 至少/ 会/ 被/ 访问/ 一次/ ,/ 那么/ 如果/ 页面/ 的/ 两次/ 相邻/ 访问/ 的/ 间隔/ 超过/ hddSize/ ,/ 该/ 页面/ 被/ 认为/ toocold/ ,/ 并且/ 它/ 的/ 定位/ 倾向/ 发生/ 衰减/ ,/ 如/ 算法/ 3/ 中/ 36/ ~/ 41/ 行/ 所示/ ./ 在/ 这种/ 情况/ 下/ ,/ 衰减/ 因子/ β/ 的/ 影响/ 会/ 增大/ ,/ 它/ 的/ 值会/ 被/ 减小/ ssdSize/ // interval/ 倍/ ,/ 这/ 就/ 使/ 之前/ 的/ 负载/ 对/ 定位/ 倾向/ 的/ 影响/ 减小/ 至/ 几乎/ 0/ ./ 如果/ 页面/ 一直/ 保持/ 在/ cold/ 或者/ hot/ 的/ 状态/ ,/ 页面/ 的/ 定位/ 倾向/ 就/ 会/ 正常/ 更新/ ,/ 如/ 算法/ 3/ 中/ 所示/ ./ 基于/ 上述/ 讨论/ ,/ 我们/ 将/ 在/ 下/ 一/ 小节/ 提出/ 本文/ 的/ 整个/ 模型/ ./ 2.4/ 混合/ 存储/ 模型/ 这/ 一节/ 我们/ 将/ 讨论/ 整个/ 的/ 混合/ 存储/ 模型/ (/ 算法/ 4/ 、/ 5/ )/ ./ 如/ 算法/ 5/ 中/ 所示/ ,/ 页面/ 必须/ 在/ 热度/ 状态/ 为/ warm/ 或者/ hot/ ,/ 并且/ 定位/ 倾向/ 为/ SSD/ -/ trend/ 时/ ,/ 该/ 页面/ 才能/ 被/ 迁移/ 到/ SSD/ 上/ 存储/ ./ 而/ 从/ SSD/ 到/ HDD/ 的/ 迁移/ 触发/ 条件/ 则/ 不/ 相同/ ,/ 如/ 算法/ 5/ 的/ 8/ ~/ 14/ 行/ 所示/ ,/ 一旦/ SSD/ 页面/ 的/ 定位/ 倾向/ 为/ HDD/ -/ trend/ ,/ 则/ 该/ 页面/ 被/ 迁移/ 到/ HDD/ ,/ 此外/ 对/ 某些/ 写/ 操作/ 性能/ 不输于/ 读/ 操作/ 的/ 高端/ SSD/ 而言/ ,/ 热度/ 状态/ 的/ 变化/ 也/ 是/ 迁移/ 操作/ 的/ 触发/ 条件/ ,/ 当/ 页面/ 变为/ cold/ 时/ 迁移/ 发生/ ./ 也就是说/ ,/ 本文/ 的/ 系统/ 是/ 兼容/ 高端/ SSD/ 和/ 中端/ SSD/ 的/ ,/ 在/ 第/ 4/ 节/ 的/ 实验/ 部分/ 有/ 更/ 详细/ 的/ 讨论/ ./ 算法/ 4/ ./ 混合/ 存储/ 算法/ ./ accessPage/ (/ Pagepg/ )/ 1/ ./ pg/ ./ totalaccess/ ++/ ;/ 2/ ./ ifpgisfoundinbufferthen3/ ./ movepgtotheheadofbufferLRU/ ;/ 4/ ./ ifaccessisreadquestthen5/ ./ pg/ ./ lr/ ++/ ;/ 6/ ./ elseifaccessiswritequestthen7/ ./ pg/ ./ lw/ ++/ ;/ 8/ ./ endif9/ ./ else10/ ./ ifbufferisfullthen11/ ./ evictPage/ (/ )/ ;/ 12/ ./ endif13/ ./ fetchpgfromdisk/ ;/ 14/ ./ updateState/ (/ pg/ )/ ;/ 15/ ./ addpgtotheheadofbufferLRU/ ;/ 16/ ./ ifaccessisreadquestthen17/ ./ pg/ ./ pr/ ++/ ;/ 18/ ./ elseaccessiswritequestthen19/ ./ pg/ ./ pw/ ++/ ;/ 20/ ./ endif21/ ./ endif/ 算法/ 5/ ./ evictPage/ (/ )/ ./ 1/ ./ Pagepg/ ;/ 2/ ./ pg/ ←/ tailofLRU/ ;/ 3/ ./ place/ ←/ trendCalculate/ (/ pg/ )/ ;/ 4/ ./ ifpgisonHDDthen5/ ./ ifpg/ ./ stateishotorwarmandplace/ =/ SSD/ -/ trend6/ ./ migratePage/ (/ pg/ )/ ;/ 7/ ./ endif8/ ./ elseifpgisonSSDthen9/ ./ ifplace/ =/ SSD/ -/ trendthen10/ ./ migratePage/ (/ pg/ )/ ;/ 11/ ./ elseifpgiscoldandSSDwriteperformanceis12/ ./ migratePage/ (/ pg/ )/ ;/ 13/ ./ endif14/ ./ endif15/ ./ ifpgisdirtythen16/ ./ writepgtodiskofpg/ ./ plcaement/ ;/ 17/ ./ endif/ 如/ 算法/ 4/ 、/ 5/ 所示/ ,/ 当/ 页面/ 被/ 读/ 到/ 缓冲区/ 中/ 时/ ,/ 该/ 页面/ 的/ 访问/ 时间/ 信息/ 和/ 热度/ 状态/ 都/ 会/ 被/ 更新/ ./ 页面/ Page7/ 从/ 缓冲区/ 置换/ 时/ ,/ 算法/ 3/ 被/ 调用/ 更新/ 页面/ 的/ 定位/ 倾向/ 值/ ,/ 从而/ 确定/ 页面/ 的/ 存储/ 位置/ ./ 算法/ 5/ 中/ 的/ 第/ 6/ ,/ 10/ ,/ 12/ 行/ 所示/ ,/ 迁移/ 将会/ 被/ 触发/ ,/ 页面/ 的/ 相关/ 信息/ 也/ 会/ 被/ 更新/ ,/ 同时/ 页面/ 被/ 置/ 为/ dirty/ 以/ 写入/ 对应/ 地/ 硬盘/ ./ 3/ 实验/ 本文/ 分别/ 在/ TPC/ -/ C/ 和/ OLTP/ 数据/ 集上/ 实现/ 本文/ 的/ 模型/ ,/ 并/ 与/ 文献/ [/ 7/ ]/ 提出/ 的/ 混合/ 模型/ 进行/ 对比/ ./ 3.1/ 混合/ 存储/ 模型/ 实验/ 系统/ 可/ 分为/ 存储管理/ 器/ 、/ 缓冲/ 管理器/ 和/ 混合/ 迁移/ 模型/ 3/ 部分/ ,/ 并/ 利用/ 第/ 2.1/ 节中/ 提到/ 的/ B/ +/ -/ 树/ 完成/ 对/ 存储/ 数据/ 的/ 索引/ ./ 存储管理/ 器/ 包括/ 空闲/ 空间/ 管理器/ 和/ 非/ 空闲/ 空间/ 管理器/ ./ 实验/ 代码/ 使用/ C++/ 实现/ ,/ 并/ 运行/ 在/ DebianGNU/ // Linux2/ ./ 6.21/ 操作系统/ 上/ ,/ 页面/ 大小/ 为/ 4KB/ ./ 缓冲区/ 大小/ 设定/ 4MB/ ,/ 并/ 带有/ LRU/ 管理器/ ./ 实验/ 运行/ 在/ 硬盘/ 仿真/ 系统/ 上/ ,/ 仿真/ 实现/ 包括/ 常规/ HDD/ (/ RU/ -/ HDD/ )/ 、/ 中端/ SSD/ (/ SAM/ -/ SUNG/ -/ 32GSSD/ )/ 和/ 高端/ SSD/ (/ IntelX25ESSD/ )/ 在内/ 的/ 3/ 种/ 存储设备/ ①/ ,/ 并/ 使用/ 工具软件/ uFlip/ [/ 14/ ]/ 来/ 测量/ 硬盘/ 仿真/ 系统/ 的/ I/ // O/ 性能参数/ ./ 本文/ 实现/ 了/ 第/ 2/ 节中/ 提出/ 的/ 方法/ 和/ 文献/ [/ 7/ ]/ 提出/ 的/ 混合/ 模型/ ,/ 并/ 分别/ 运行/ 在/ 两种/ 不同/ 类型/ 的/ 混合/ 存储设备/ 上/ ,/ 包括/ RU/ -/ HDD/ 与/ SAMSUNG/ -/ 32GSSD/ 的/ 混合/ 存储/ 以及/ RU/ -/ HDD/ 与/ IntelX25ESSD/ 的/ 混合/ 存储/ ,/ 最后/ 对比/ 分析/ 本文/ 的/ 模型/ 和/ 以前/ 的/ 混合/ 模型/ 的/ 实验/ 结果/ ./ 存储设备/ 性能/ :/ 表/ 3/ 描述/ 了/ 3/ 种/ 存储设备/ RU/ -/ HDD/ 、/ SAMSUNG/ -/ 32GSSD/ 和/ IntelX25ESSD/ 的/ 实际/ 读写/ 延迟时间/ 和/ 价格/ 参数/ ./ 表/ 4/ 分别/ 给出/ 了/ RU/ -/ HDD/ 与/ SAMSUNG/ -/ 32GSSD/ 以及/ RU/ -/ HDD/ 与/ IntelX25ESSD/ 的/ 读写/ 代价/ 性能/ 对比/ ,/ 并/ 以/ 最小/ 代价/ 的/ 倍/ 数值/ 进行/ 归一化/ 描述/ ./ 其中/ ,/ 读写/ 延迟时间/ 越大/ ,/ 读写/ 速度/ 越慢/ ,/ 读写/ 代/ 价值/ 越大/ ./ 例如/ ,/ SAM/ -/ SUNG/ -/ 32GSSD/ 读/ 页面/ 的/ 速度/ 是/ RU/ -/ HDD/ 的/ 107/ 倍/ ,/ 而/ RU/ -/ HDD/ 写/ 页面/ 的/ 速度/ 大约/ 是/ SAMSUNG/ -/ 32GSSD/ 的/ 两倍/ ;/ IntelX25ESSD/ 写/ 页面/ 速度/ 比读/ 页面/ 速度/ 大约/ 快/ 3/ 倍/ ,/ 且/ 其/ 写/ 页面/ 速度/ 是/ RU/ -/ HDD/ 读/ 页面/ 速度/ 的/ 108/ 倍/ ,/ 是/ RU/ -/ HDD/ 写/ 页面/ 速度/ 的/ 297/ 倍/ ./ 设备/ 类型/ 读/ 延迟/ // μ/ s/ 写/ 延迟/ // μ/ s/ 价格/ // (/ $/ ·/ GB/ -/ 1/ )/ RU/ -/ HDD1991772570/ ./ 125SAMSUNG/ -/ 32G187961916/ ./ 000IntelX25E199/ 设备/ 类型/ RU/ -/ HDDSAMSUN/ -/ 32GRU/ -/ HDDIntelX25E/ 因此/ ,/ 第/ 2.3/ 节中/ 提到/ 的/ I/ // O/ 代价/ 参数/ 可/ 使用/ 表/ 4/ 中/ 的/ 倍/ 数值/ 描述/ ,/ 例如/ 对/ RU/ -/ HDD/ 与/ SAM/ -/ SUNGSSD/ 的/ 混合/ 存储/ 类型/ 有/ :/ rs/ =/ 1/ ,/ rh/ =/ 107/ ,/ ws/ =/ 51/ ,/ wh/ =/ 39/ ./ 实验/ 记录/ 了/ 硬盘/ 仿真/ 系统/ 中/ 的/ 读写操作/ 数目/ ,/ 并/ 结合/ 表/ 3/ 中/ 的/ 读写/ 延迟时间/ 来/ 仿真/ 计算/ 总/ 的/ 运行/ 时间/ ./ 数据/ 集/ 的/ 类型/ :/ 本文/ 使用/ 两种/ 类型/ 的/ 数据/ 集/ :/ TPC/ -/ C/ 和/ OLTP/ ./ TPC/ -/ C/ 数据/ 集/ 通过/ 修改/ 开源/ 数据库/ PostgreSQL7/ ./ 4.29/ 获得/ ,/ 在/ 其/ 缓冲区/ 管理器/ 中/ 增加/ 操作/ 记录/ 模块/ ,/ 每当/ 缓冲区/ 管理器/ 接到/ 操作/ 请求/ 时/ ,/ 数据库/ 便/ 记录/ 该/ 操作/ 请求/ 和/ 页面/ 号/ ,/ 并/ 提供/ 输出/ 操作/ 记录/ 至/ 文件/ 的/ 函数/ ./ 在/ PostgreSQL/ 数据库/ 中/ 使用/ BenchmarkSQL/ 软件/ 模拟/ 运行/ TPC/ -/ C/ 测试/ ,/ 数据量/ 设定/ 为/ 1GB/ ,/ 并/ 调用函数/ 输出/ TPC/ -/ C/ 操作/ 记录/ 文件/ ./ OLTP/ 数据/ 集则/ 是/ 由/ GerhardWeikum/ 提供/ 的/ 真实/ 的/ 银行/ 系统/ 交易/ 处理/ 数据/ 集/ ./ 表/ 5/ 分别/ 描述/ 了/ TPC/ -/ C/ 和/ OLTP/ 数据/ 集中/ 的/ 不同/ 操作/ 类型/ 的/ 统计/ 数值/ ./ 可以/ 看到/ ,/ 两个/ 数据/ 集/ 的/ 读写操作/ 数都/ 分别/ 约/ 占/ 总/ 操作数/ 的/ 77/ %/ 和/ 23/ %/ ./ 下面/ 分别/ 介绍/ 本文/ 的/ 模型/ 在/ 这/ 两种/ 数据/ 集上/ 运行/ 的/ 性能/ 情况/ 分析/ ./ 表/ 5TPC/ -/ C/ 和/ OLTP/ 数据/ 集/ 的/ 读写操作/ 数及/ 页面/ 数目/ 统计/ 值/ 数据/ 集/ 类型/ 读/ 操作/ 次数/ 写/ 操作/ 次数/ 总/ 操作/ 次数/ 页面/ 数目/ TPC/ -/ C1351144OLTP4706783/ ./ 2/ 实验/ 性能/ 分析/ 实验/ 中/ ,/ 首先/ 在/ 单独/ 的/ HDD/ 设备/ 或/ SSD/ 设备/ 上/ 分别/ 运行/ 两个/ 数据/ 集/ ,/ 获得/ 单个/ 设备/ 的/ 运行/ 性能/ ./ 然后/ 在/ 混合/ 存储设备/ 上/ 实现/ 本文/ 的/ 模型/ 和/ 文献/ [/ 7/ ]/ 提出/ 的/ 混合/ 模型/ ,/ 并/ 分别/ 运行/ 两个/ 数据/ 集/ ./ 为了/ 方便/ 描述/ ,/ 后文/ 使用/ PreviousHybrid/ 代指/ 文献/ [/ 7/ ]/ 提出/ 的/ 混合/ 模型/ ./ 图/ 3/ 描述/ 了/ TPC/ -/ C/ 和/ OLTP/ 数据/ 集在/ 单个/ HDD/ 设备/ 或/ SSD/ 设备/ 上/ 的/ 总/ 运行/ 时间/ ./ 可以/ 看到/ ,/ RU/ -/ HDD/ 上/ 运行/ 性能/ 最差/ ,/ IntelX25E/ 性能/ 最好/ ,/ SAMSUNG/ -/ 32G/ 其次/ ,/ 它们/ 之间/ 的/ 性能/ 差距/ 是/ 由/ ①/ http/ :/ // // uflip/ ./ inria/ ./ fr/ // uFLIP/ // results/ // Page8SSD/ 相对/ 于/ HDD/ 的/ 优点/ 带来/ 的/ ./ 正如/ 前文/ 所/ 提到/ 的/ ,/ 中端/ SSD/ (/ SAMSUNG/ -/ 32GSSD/ )/ 与/ 高端/ SSD/ (/ IntelX25ESSD/ )/ 的/ 性能/ 差距/ 较大/ ,/ 因此/ 需要/ 分别/ 在/ RU/ -/ HDD/ 与/ SAMSUNG/ -/ 32GSSD/ 混合/ 存储设备/ 、/ RU/ -/ HDD/ 与/ IntelX25ESSD/ 混合/ 存储设备/ 上/ 测试/ 本文/ 模型/ ./ 为了/ 分析/ 混合/ 存储设备/ 中/ HDD/ 与/ SSD/ 所/ 占/ 的/ 空间/ 比值/ (/ HDDsize/ // SSDsize/ )/ 不同/ 对/ 实验/ 性能/ 的/ 影响/ ,/ 我们/ 为/ 混合/ 存储设备/ 设定/ 了/ 11/ 种/ 不同/ 的/ HDDsize/ // SSDsize/ 比值/ ./ 其中/ ,/ HDD/ 大小/ 取值/ 与/ 数据/ 集/ 大小/ 相同/ ,/ 即为/ 1GB/ ,/ SSD/ 大小/ 由/ 不同/ 的/ HDDsize/ // SSDsize/ 比值/ 决定/ ./ 图/ 4/ (/ a/ )/ 描述/ 了/ 在/ RU/ -/ HDD/ 与/ SAMSUNG/ -/ 32GSSD/ 混合/ 存储设备/ 上/ 分别/ 实现/ 本文/ 模型/ 和/ PreviousHybrid/ 模型/ ,/ 运行/ OLTP/ 数据/ 集/ 的/ 总/ 运行/ 时间/ ;/ 图/ 4/ (/ b/ )/ 描述/ 了/ 运行/ TPC/ -/ C/ 数据/ 集/ 的/ 总/ 运行/ 时间/ ./ 图/ 4/ (/ a/ )/ 和/ 图/ 4/ (/ b/ )/ 中前/ 11/ 组/ 实验/ 结果/ 分别/ 对应/ 11/ 种/ 不同/ HDDsize/ // SSDsize/ 比值/ 大小/ 的/ 混合/ 存储设备/ ,/ 而/ 最后/ 一组/ 深色/ 条形/ 则/ 表示/ 数据/ 集在/ 单个/ HDD/ 设备/ 上/ 的/ 总/ 运行/ 时间/ ./ 对比/ 发现/ ,/ 除/ OLTP/ 数据/ 集在/ 基于/ PreviousHybrid/ 模型/ 的/ 部分/ 混合/ 存储设备/ 上/ 运行/ 时间/ 较长/ 以外/ ,/ SSD/ 和/ HDD/ 混合/ 存储设备/ 上/ 的/ 运行/ 性能/ 总是/ 优于/ 单个/ HDD/ 设备/ 的/ ./ 其次/ ,/ 不论/ 哪/ 种/ 数据/ 集/ ,/ 随着/ SSD/ 大小/ 的/ 降低/ ,/ 实验/ 性能/ 逐渐/ 变差/ ,/ 这/ 进一步/ 说明/ SSD/ 的/ 引入/ 可以/ 带来/ 更/ 高/ 的/ 性能/ ./ 此外/ ,/ 只有/ 当/ SSD/ 大小/ 接近/ HDD/ 大/ 小时/ ,/ PreviousHybrid/ 模型/ 的/ 性能/ 略/ 优于/ 我们/ 的/ 模型/ ,/ 随着/ SSD/ 大小/ 的/ 降低/ ,/ 本文/ 模型/ 的/ 性能/ 逐渐/ 优于/ Pre/ -/ viousHybrid/ ,/ 且/ 性能/ 差距/ 逐渐/ 增大/ ./ 这/ 充分说明/ 本文/ 模型/ 能够/ 更/ 有效/ 地/ 利用/ 有效/ 的/ SSD/ 存储空间/ ,/ 其/ 利用/ 更/ 小/ 的/ SSD/ 存储空间/ 获得/ 更/ 多/ 的/ 性能/ 提升/ ./ 图/ 5/ (/ a/ )/ 和/ 图/ 5/ (/ b/ )/ 分别/ 描述/ 了/ OLTP/ 和/ TPC/ -/ C/ 数据/ 集在/ RU/ -/ HDD/ 与/ 高端/ SSD/ (/ IntelX25ESSD/ )/ 混合/ 存储设备/ 上/ 的/ 运行/ 结果/ ./ 第/ 2.4/ 节中/ 描述/ 的/ 模型/ 的/ 特殊/ 设计/ 部分/ 在/ 该处/ 实验/ 中/ 完成/ 了/ 从/ SSD/ 到/ HDD/ 的/ 迁移/ ./ 图/ 5/ 中/ 的/ 实验/ 结果/ 与/ 图/ 4/ 类似/ ./ OLTP/ 数据/ 集在/ 本文/ 模型/ 上/ 相对/ 于/ PreviousHybrid/ 上/ 有/ 明显/ 的/ 改进/ ;/ 对于/ TPC/ -/ C/ 数据/ 集/ ,/ 当/ HDDsize/ // SSDsize/ 比值/ 小于/ 401/ 时/ ,/ 本文/ 模型/ 仍/ 优于/ PreviousHybrid/ ,/ 但是/ 随着/ SSD/ 大小/ 的/ 增加/ ,/ 本文/ 模型/ 性能/ 提升/ 微弱/ ,/ 且/ 不如/ PreviousHybrid/ 模型/ 的/ 性能/ 提升/ 来得快/ ./ 这/ 是因为/ IntelX25ESSD/ 的/ 写/ 性能/ 大大/ 优于/ 读/ 性能/ ,/ 而且/ TPC/ -/ C/ 数据/ 集/ 相对/ 于/ OLTP/ 数据/ Page9/ 集/ 来说/ 有/ 大量/ 的/ 随机/ 访问/ 操作/ ,/ 从而/ 导致/ 由/ 访问/ 热度/ 引起/ 的/ 迁移/ 操作/ 较/ 少/ ,/ 而/ 大部分/ 迁移/ 操作/ 都/ 是/ 由/ 本文/ 模型/ 和/ PreviousHybrid/ 模型/ 共同/ 具备/ 的/ 页面/ 定位/ 倾向/ 模块/ 所/ 触发/ 引起/ ,/ 因此/ 本文/ 模型/ 的/ 优势/ 在/ TPC/ -/ C/ 数据/ 集中体现/ 不/ 明显/ ./ 综合/ 分析/ 图/ 4/ 和/ 图/ 5/ 可知/ ,/ 混合/ 存储/ 性能/ 优于/ 单个/ HDD/ 设备/ ,/ 且/ 本文/ 模型/ 相对/ 于/ PreviousHybrid/ 模型/ 在/ SSD/ 存储空间/ 更/ 小/ 的/ 情况/ 下/ 能够/ 带来/ 更大/ 的/ 性能/ 提升/ ./ 3.3/ 页面/ 分类/ 和/ 物理/ 读写/ 分布/ 在/ 试验/ 中/ ,/ 存储设备/ 的/ 存储容量/ 以/ 页面/ 数目/ 来/ 衡量/ ./ 如/ 3.2/ 节/ 所述/ ,/ HDD/ 的/ 存储容量/ 设置/ 为/ 1GB/ 即/ 262144/ 个/ 页面/ ,/ SSD/ 的/ 存储容量/ 随着/ 我们/ 设定/ 的/ 比例/ 变化/ ./ 我们/ 对/ 本文/ 提出/ 的/ 混合/ 存储/ 模型/ 和/ PreviousHybrid/ 模型/ 的/ 页面/ 分类/ 进行/ 了/ 对比/ ./ 图/ 6/ 显示/ 了/ 分别/ 在/ OLTP/ 和/ TPC/ -/ C/ 的/ trace/ 中/ 混合/ 存储系统/ 的/ 页面/ 分类/ 结果/ ./ 在/ (/ a/ )/ ~/ (/ d/ )/ 4/ 个/ 图/ 中/ ,/ 每/ 一个/ 纵坐标/ 值/ 对应/ 两个/ 柱状/ ,/ 其中/ 上面/ 的/ 柱状/ 表示/ 在/ 该/ 比例/ 情况/ 下/ PreviousHybrid/ 的/ 页面/ 分类/ 结果/ ,/ 下面/ 的/ 一个/ 柱状/ 表示/ 本文/ 混合系统/ 的/ 页面/ 分类/ 结果/ ./ 从/ 4/ 个/ 图/ 中/ 可以/ 明显/ 看出/ ,/ 尽管/ trace/ 不同/ ,/ 图/ 6/ 混合系统/ 上/ 的/ 页面/ 分配/ SSD/ 设备/ 也/ 不同/ ,/ 但是/ 随着/ HDD/ 和/ SSD/ 的/ 比例/ 变化/ ,/ 两个/ 混合/ 存储/ 模型/ 的/ 页面/ 分类/ 结果/ 有着/ 相似/ 的/ 变化趋势/ ./ 二者/ 明显/ 的/ 区别/ 体现/ 在/ 当/ HDD/ 和/ SSD/ 的/ 比例/ 接近/ 时/ ,/ 特别/ 是/ 在/ 11/ 的/ 情况/ 下/ ,/ Previoushybrid/ 将/ 几乎/ 所有/ 页面/ 都/ 分配/ 到/ 了/ SSD/ ,/ 这种/ 情况/ 下/ trace/ 中/ 的/ 所有/ 写/ 操作/ 也/ 将/ 发生/ 在/ SSD/ 上/ ,/ 这/ 显然/ 是/ 不/ 合适/ 的/ ,/ 这样/ 的/ 结果/ 和/ 前文/ 我们/ 关于/ 统计/ 的/ 积累/ 效应/ 的/ 分析/ 是/ 一致/ 的/ ;/ 本文/ 的/ 模型/ 则/ 只是/ 将/ 大部分/ 页面/ 分配/ 到/ SSD/ ,/ 这/ 是因为/ 衰减/ 因子/ 和/ 热度/ 计算/ 的/ 限制/ ,/ 从而/ 避免/ 了/ 所有/ 页面/ 分配/ 到/ SSD/ ./ 当/ HDD/ 和/ SSD/ 的/ 比例/ 变大时/ ,/ 因为/ SSD/ 的/ 存储容量/ 有限/ ,/ 所以/ SSD/ 很/ 容易/ 被/ “/ 填满/ ”/ ,/ 一旦/ “/ 填满/ ”/ SSD/ 就/ 会/ 发生/ “/ 溢出/ ”/ 必须/ 进行/ 迁移/ ./ 在/ 实验/ 结果/ 中/ 两个/ 混合/ 存储/ 模型/ 分配/ 到/ SSD/ 的/ 页面/ 数目/ 逼近/ SSD/ 的/ 存储容量/ ,/ 表明/ 受/ SSD/ 容量/ 限制/ ,/ 两个/ 模型/ 的/ 页面/ 分配/ 比较/ 接近/ ./ 结合/ HDD/ 和/ SSD/ 的/ 11/ 比例/ 时/ 的/ 实验/ 结果/ ,/ 我们/ 可以/ 预测/ 当/ 比例/ 较大/ 时/ ,/ 在/ 实验/ 运行/ 中/ PreviousHybrid/ 的/ SSD/ 上/ 因/ “/ 填满/ ”/ 发生/ 的/ 迁移/ 将/ 大大/ 多于/ 本文/ 的/ 模型/ ./ 关于/ 迁移/ 代价/ 将/ 在/ 下/ 一节/ 讨论/ ./ 混合/ 存储系统/ 中/ 页面/ 的/ 分类/ 和/ 读写访问/ 的/ 分布/ Page10/ 是/ 相关/ 的/ ,/ 设计/ 有效/ 页面/ 分配/ 方法/ 是/ 为了/ 实现/ 合理/ 的/ 物理/ 读写访问/ 分布/ ./ 因为/ 在/ 混合/ 存储系统/ 中/ SSD/ 的/ 物理/ 读写/ 分布/ 情况/ 是/ 决定/ 系统/ 性能/ 的/ 关键/ ,/ 所以/ 我们/ 在/ TPC/ -/ C/ 的/ trace/ 上/ 分别/ 统计/ 了/ 两个/ 混合/ 存储/ 模型/ 中/ SSD/ 的/ 物理/ 读写访问/ 次数/ ,/ 计算/ SSD/ 的/ 物理/ 读写/ 次数/ 在/ 系统/ 总/ 物理/ 读写/ 次数/ 中/ 的/ 比例/ ./ 我们/ 以/ Samsung32G/ 的/ SSD/ 在/ TPC/ -/ C/ 的/ trace/ 上/ 的/ 实验/ 来/ 分析/ ,/ 结果/ 如图/ 7/ 所示/ ./ 图/ 7/ 显示/ ,/ 随着/ SSD/ 的/ 容量/ 减少/ ,/ SSD/ 上/ 分配/ 的/ 页面/ 数目/ 降低/ ,/ 两个/ 模型/ 中/ 的/ SSD/ 物理/ 读/ 比例/ 都/ 在/ 下降/ ./ 两个/ 模型/ 相/ 比较/ ,/ 本文/ 的/ 模型/ 虽然/ 物理/ 读/ 的/ 比例/ 较/ 低些/ ,/ 但是/ 物理/ 写/ 的/ 比例/ 一直/ 维持/ 在/ 一个/ 较/ 低/ 的/ 水平/ ;/ 而/ PreviousHybrid/ 则/ 在/ 获得/ 较/ 高/ 的/ 物理/ 读/ 比例/ 的/ 同时/ 也/ 带来/ 了/ 高达/ 50/ %/ 左右/ 的/ 物理/ 写/ 比例/ ,/ 这样/ 的/ 结果/ 对/ 读写/ 不/ 对称/ ,/ 写/ 代价/ 较大/ 的/ SSD/ 来说/ 是/ 不利/ 的/ ,/ 这/ 也/ 不利于/ 系统/ 的/ 整体/ 性能/ ,/ 同时/ 这样/ 的/ 结果/ 说明/ 了/ 本文/ 模型/ 的/ 页面/ 分配/ 所/ 产生/ 的/ 读写/ 分布/ 更为/ 合理/ ./ 综合/ 本节/ 的/ 实验/ 结果/ ,/ 与/ PreviousHybrid/ 相比/ 本文/ 的/ 混合/ 存储/ 模型/ 在/ 页面/ 分配/ 方面/ 准确性/ 更强/ ,/ 带来/ 的/ 访问/ 分布/ 更加/ 合理/ ./ 3.4/ 迁移/ 代价/ 在/ 整个/ 混合/ 存储系统/ 中/ ,/ 所有/ 的/ 物理/ 写/ 操作/ 由/ 2/ 类/ 操作/ 组成/ :/ (/ 1/ )/ 缓冲区/ 脏页/ 的/ 置换/ ;/ (/ 2/ )/ 页面/ 在/ SSD/ 和/ HDD/ 之间/ 的/ 迁移/ ./ 对于/ 特定/ 的/ 缓冲区/ 大小/ 和/ 特定/ 的/ trace/ 文件/ ,/ 第/ 1/ 类写/ 操作/ 的/ 数目/ 是/ 固定/ 的/ ,/ 随着/ SSD/ 容量/ 的/ 变化/ ,/ 第/ 2/ 类/ 操作/ 的/ 数目/ 将会/ 发生/ 改变/ ,/ 即/ 混合/ 存储系统/ 的/ 总/ 的/ 物理/ 写/ 数目/ 将会/ 变化/ ./ 在/ 本文/ 的/ 实验/ 环境/ 下/ ,/ 我们/ 先/ 在/ 单个/ 硬盘/ 上/ 运行/ trace/ 文件/ ,/ 记录/ 下/ 物理/ 写/ 的/ 数目/ N/ ,/ 该值/ 就是/ 这个/ trace/ 文件/ 运行/ 中/ 的/ 缓冲区/ 脏页/ 置换/ 次数/ ,/ 再/ 在/ 混合/ 存储/ 模型/ 中以/ 相同/ 的/ 缓冲区/ 配置/ 运行/ 该/ trace/ 文件/ ,/ 此时/ 运行/ 中/ 的/ 物理/ 写/ 数目/ M/ 与/ N/ 的/ 差值/ 即/ 是/ 迁移/ 带来/ 的/ 物理/ 写/ 操作/ ,/ 也/ 就是/ 迁移/ 代价/ ./ 以/ SAMSUNG/ -/ 32G/ 在/ OLTP/ 的/ trace/ 上/ 的/ 运行/ 来/ 进行/ 实验/ ,/ 对/ 不同/ 的/ HDD/ 和/ SSD/ 比例/ 下/ 混合/ 存储/ 模型/ 的/ 物理/ 写/ 数目/ 和/ 单个/ 硬盘/ 的/ 物理/ 写/ 数目/ 的/ 差值/ 进行/ 记录/ ,/ 结果/ 如图/ 8/ 所示/ ./ 在/ 图/ 8/ 中/ ,/ PreviousHybrid/ 的/ 迁移/ 代价/ 明显/ 高于/ 本文/ 的/ 存储/ 模型/ ,/ 这/ 主要/ 是/ 由于/ 3.3/ 节所/ 分析/ 的/ PreviousHybrid/ 较/ 不/ 准确/ 的/ 页面/ 分类/ 引起/ 的/ ./ 在/ HDD/ 和/ SSD/ 比例/ 为/ 11/ 时/ ,/ 二者/ 的/ 迁移/ 代价/ 非常/ 接近/ ,/ 这/ 是因为/ 在/ 此/ 比例/ 下/ ,/ SSD/ 的/ 存储容量/ 超过/ 了/ OLTP/ 的/ trace/ 中/ 的/ 页面/ 数目/ ,/ 不会/ 发生/ SSD/ “/ 填满/ ”/ 的/ 情况/ ,/ 从而/ 迁移/ 不会/ 发生/ ./ 随着/ SSD/ 容量/ 降低/ ,/ “/ 填满/ ”/ 引起/ 的/ 迁移/ 显著/ 增加/ ,/ 本文/ 的/ 存储/ 模型/ 的/ 准确性/ 就/ 体现/ 了/ 出来/ ./ 注意/ 在/ 比例/ 超过/ 801/ 后/ ,/ 本文/ 模型/ 的/ 迁移/ 代价/ 又/ 在/ 缓慢/ 下降/ ,/ 这/ 是因为/ 本文/ 模型/ 中/ 的/ 热度/ 计算/ 是/ 和/ SSD/ 容量/ 大小/ 联系/ 起来/ 的/ ,/ 当/ SSD/ 容量/ 过/ 小时/ ,/ 只有/ 很少/ 的/ 页面/ 能/ 进入/ hot/ 状态/ 从而/ 迁移/ 到/ SSD/ ,/ 这/ 就/ 使/ 页面/ 从/ HDD/ 到/ SSD/ 的/ 迁移/ 减少/ ,/ 这会/ 导致/ SSD/ “/ 填满/ ”/ 的/ 情况/ 也/ 减少/ ,/ 从而/ SSD/ 到/ HDD/ 的/ 迁移/ 也/ 因此/ 减少/ 了/ ,/ 所以/ 整个/ 系统/ 的/ 迁移/ 都/ 减少/ 了/ ./ 结合/ 3.3/ 节/ 和/ 3.4/ 节/ ,/ 本文/ 的/ 混合/ 存储/ 模型/ 对/ 页面/ 的/ 分类/ 更为/ 精确/ ,/ 对/ SSD/ 的/ 利用/ 更加/ 有效/ 合理/ ./ 3.5/ 系统/ 性价比/ 分析/ 除了/ 实验/ 性能/ 优劣/ 的/ 比较/ 外/ ,/ 由于/ 本文/ 的/ 目标/ 致力于/ 在/ 更/ 小/ 的/ SSD/ 存储空间/ 中/ 获得/ 更/ 高/ 的/ 性能/ 提升/ ,/ 我们/ 更加/ 关心/ 混合/ 存储设备/ 的/ 性能/ 价格比/ ratio/ ./ 利用/ OLTP/ 测试数据/ 集在/ 基于/ 本文/ 模型/ 的/ 混合/ 存储设备/ 上/ 的/ 运行/ 性能/ 以及/ 表/ 3/ 中/ 给出/ 的/ 设备/ 价格/ ,/ 定义/ 混合/ 存储设备/ 的/ 性能/ 价格比/ 如下/ 式/ 所示/ ratio/ =/ hddTime/ -/ (/ 其中/ ,/ hddTime/ 参数/ 表示/ OLTP/ 数据/ 集在/ 单个/ HDD/ 设备/ 上/ 的/ 运行/ 时间/ ,/ hsTime/ 参数/ 表示/ OLTPPage11/ 数据/ 集在/ 混合/ 存储设备/ 上/ 的/ 运行/ 时间/ ./ 故/ 公式/ 中/ 分子/ 表示/ 混合/ 存储/ 相对/ 于/ 单个/ 设备/ 的/ 性能/ 提升/ 比例/ ,/ 分母/ 表示/ SSD/ 的/ 价格/ 且/ 由/ 混合/ 存储设备/ 的/ 空间/ 比值/ HDDsize/ // SSDsize/ 大小/ 决定/ ./ 图/ 9/ 分别/ 描述/ 了/ 基于/ 本文/ 模型/ 的/ 两种/ 混合/ 存储设备/ 在/ 不同/ 空间/ 比值/ HDDsize/ // SSDsize/ 情况/ 下/ 的/ 性能/ 价格比/ ratio/ 值/ 分布/ 情况/ ./ 其中/ 中/ 虚线/ 代表/ RU/ -/ HDD/ 与/ IntelX25ESSD/ 混合/ 存储设备/ ;/ 实线/ 代表/ RU/ -/ HDD/ 与/ SamSung/ -/ 32GSSD/ 混合/ 存储设备/ ./ RU/ -/ HDD/ 与/ IntelX25ESSD/ 混合/ 存储设备/ 的/ ratio/ 值/ 明显/ 高于/ RU/ -/ HDD/ 与/ SAMSUNG/ -/ 32GSSD/ 混合/ 存储设备/ ./ 当/ 混合/ 存储设备/ 空间/ 比值/ HDDsize/ // SSDsize/ 接近/ 1/ 时/ ,/ 即/ SSD/ 大小/ 与/ HDD/ 大小/ 相等/ 时/ ,/ 两种/ 混合/ 存储设备/ 的/ 性能/ 价格比/ 非常/ 接近/ ./ 这/ 说明/ 当/ SSD/ 大小/ 与/ HDD/ 大小/ 相等/ ,/ 此时/ 若/ 基于/ 本文/ 模型/ 实现/ 混合/ 存储系统/ ,/ 选择/ 中端/ SSD/ 或/ 高端/ SSD/ 性能/ 价格比/ 是/ 接近/ 的/ ./ 考虑/ 相同/ 大小/ 的/ 中/ 、/ 高端/ SSD/ 价格/ 相差/ 较大/ ,/ 应当/ 选择/ 中端/ SSD/ 完成/ 设计/ ./ 此外/ ,/ 随着/ 空间/ 比值/ HDDsize/ // SSDsize/ 从/ 11/ 增加/ 到/ 501/ ,/ 两种/ 类型/ 的/ 混合/ 存储设备/ 的/ 性能/ 价格比/ 均/ 有/ 快速/ 提升/ ,/ 表明/ 该/ 空间/ 比值/ 范围/ 适合/ 基于/ 本文/ 模型/ 的/ 混合/ 存储系统/ 实现/ ;/ 随着/ 空间/ 比值/ HDDsize/ // SSDsize/ 从/ 501/ 增加/ 到/ 801/ ,/ 两种/ 类型/ 的/ 混合/ 存储设备/ 的/ 性能/ 价格比/ 均/ 增长/ 缓慢/ ,/ 表明/ 该/ 空间/ 比值/ 范围/ 不/ 适合/ 基于/ 本文/ 模型/ 的/ 混合/ 存储系统/ 实现/ ./ 故/ 基于/ 本文/ 模型/ 的/ 混合/ 存储系统/ 实现/ 时/ 最佳/ 空间/ 比值/ 为/ 11/ 到/ 501.3/ ./ 6/ “/ warm/ ”/ 对/ 混合/ 模型/ 的/ 作用/ 本文/ 在/ 页面/ 状态/ 中/ 引入/ 了/ “/ warm/ ”/ 状态/ ,/ 以/ 避免/ cold/ 页面/ 骤然/ 地/ 转变/ 为/ hot/ 状态/ ,/ 从而/ 减少/ 不必要/ 的/ 迁移/ 操作/ ./ 所以/ 带有/ “/ warm/ ”/ 状态/ 的/ 混合/ 模型/ 和/ 没有/ “/ warm/ ”/ 状态/ 的/ 相比/ ,/ 迁移/ 代价/ 应该/ 较/ 小/ ,/ 运行/ 时间/ 较/ 短/ ./ 根据/ 3.4/ 节/ 的/ 讨论/ ,/ 迁移/ 代价/ 以/ 模型/ 运行/ 中/ 的/ 物理/ 写/ 数目/ 衡量/ ,/ 所以/ 通过/ 比较/ 有/ “/ warm/ ”/ 的/ 模型/ 和/ 无/ “/ warm/ ”/ 模型/ 的/ 运行/ 时间/ 、/ 物理/ 写/ 数目/ 就/ 可以/ 衡量/ “/ warm/ ”/ 对/ 混合/ 模型/ 的/ 作用/ ./ 本文/ 以/ HDD/ 和/ SAMSUNG/ -/ 32GSSD/ 组成/ 的/ 混合/ 存储系统/ 作为/ 实验/ 对象/ ,/ 以/ TPC/ -/ Ctrace/ 作为/ 实验/ 数据/ ,/ 在/ 本文/ 的/ 混合/ 模型/ 有/ “/ warm/ ”/ 和/ 无/ “/ warm/ ”/ 的/ 情况/ 下/ ,/ 分别/ 在/ 混合系统/ 中/ HDD/ 和/ SSD/ 的/ 比例/ 为/ 101/ ,/ 301/ ,/ 501/ 时/ 进行/ 实验/ ,/ 实验/ 的/ 结果/ 如图/ 10/ 所示/ ./ 图/ 10/ 显示/ ,/ 在/ 无/ “/ warm/ ”/ 的/ 混合/ 模型/ 中/ ,/ 物理/ 写/ 的/ 数目/ 更/ 多/ ,/ 这/ 表示/ 迁移/ 代价/ 更大/ ./ 这些/ 额外/ 的/ 物理/ 写/ 是/ 由/ 2.2/ 节/ 第/ 1/ 段/ 所/ 分析/ 的/ 情况/ 带来/ 的/ ,/ 实验/ 结果/ 证实/ 了/ 直接/ 的/ cold/ // hot/ 状态/ 转换/ 会/ 引起/ 不/ 准确/ 的/ 迁移/ ./ 较大/ 的/ 迁移/ 代价/ 会/ 降低/ 模型/ 的/ 性能/ ,/ 这个/ 结果/ 在/ 图/ 10/ (/ a/ )/ 中/ 也/ 表现/ 了/ 出来/ ./ 通过/ 图/ 10/ 的/ 对比/ ,/ “/ warm/ ”/ 状态/ 的/ 引入/ 对/ 混合/ 模型/ 是/ 有着/ 积极意义/ 的/ ./ 4/ 总结/ 本文/ 提出/ 了/ 一个/ 高性价比/ 的/ SSD/ -/ HDD/ 混合/ 存储/ 模型/ ,/ 该/ 模型/ 将/ 有限/ 容量/ 的/ SSD/ 引入/ 磁盘/ 存储体系/ 从而/ 获得/ 明显/ 的/ 性能/ 提升/ ./ 我们/ 通过/ 引入/ warm/ 的/ 概念/ 改进/ 了/ 传统/ 的/ hot/ // cold/ 思想/ 并/ 用于/ 混合/ 存储系统/ 的/ 设计/ ,/ 并且/ 利用/ 衰减/ 因子/ 修改/ I/ // O/ 统计/ 值来/ 实现/ 较为/ 准确/ 的/ 迁移/ 判断/ ./ 最后/ 本文/ 对/ 混合/ 存储系统/ 的/ 性价比/ 问题/ 展开/ 了/ 讨论/ ,/ 这/ 对于/ 探讨/ SSD/ -/ HDD/ 的/ 最佳/ 组合/ 方式/ 是/ 有益/ 的/ 尝试/ ./ 未来/ ,/ 我们/ 将/ 对/ 其它/ 的/ 混合/ 存储/ 架构/ 展开/ 研究/ ./ 热度/ 状态/ 迁移/ 的/ 思想/ 将会/ 得到/ 更/ 多/ 的/ 关注/ ./ 混合/ 存储/ 的/ 性能/ 价格比/ 在/ 以前/ 的/ 相关/ 研究/ 中/ 没有/ 提及/ ,/ 该/ 方向/ 具有/ 一定/ 的/ 现实意义/ ,/ 我们/ 将/ 对/ 其/ 展开/ 进一步/ 的/ 研究/ ./ Page12/ 

