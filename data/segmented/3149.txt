Page1/ 云/ 计算环境/ 下面/ 向/ 数据/ 密集型/ 应用/ 的/ 数据/ 布局/ 策略/ 与/ 方法/ 郑湃/ 崔立/ 真王/ 海洋/ 徐猛/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 摘要/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 已/ 被/ 广泛应用/ 于/ 多个/ 领域/ ./ 面对/ 多/ 数据中心/ 的/ 云/ 计算环境/ ,/ 这/ 类/ 应用/ 在/ 数据/ 布局/ 方面/ 遇到/ 了/ 新/ 的/ 挑战/ ,/ 主要/ 表现/ 在/ 如何/ 减少/ 跨/ 数据中心/ 的/ 数据传输/ 、/ 如何/ 保持数据/ 间/ 的/ 依赖性/ 以及/ 如何/ 在/ 提高效率/ 的/ 同时/ 兼顾/ 全局/ 的/ 负载/ 均衡/ 等/ ./ 针对/ 这些/ 挑战/ ,/ 文中/ 提出/ 一种/ 三/ 阶段/ 数据/ 布局/ 策略/ ,/ 分别/ 针对/ 跨/ 数据中心/ 数据传输/ 、/ 数据/ 依赖/ 关系/ 和/ 全局/ 负载/ 均衡/ 三个/ 目标/ 对/ 数据/ 布局/ 方案/ 进行/ 求解/ 和/ 优化/ ./ 实验/ 显示/ ,/ 文中/ 提出/ 的/ 数据/ 布局/ 策略/ 具有/ 良好/ 的/ 综合性/ 能/ ,/ 特别/ 是/ 在/ 降低/ 流程/ 执行/ 过程/ 中/ 由/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ 方面/ ,/ 效果/ 尤为/ 明显/ ./ 关键词/ 云/ 计算/ ;/ 流程/ ;/ 数据/ 密集/ ;/ 数据/ 布局/ ;/ 数据/ 依赖/ 1/ 引言/ 随着/ 信息技术/ 的/ 发展/ 和/ 普及/ ,/ 互联网/ 逐渐/ 成为/ 一种/ 计算/ 平台/ ./ 云/ 计算/ 是/ 一种/ 典型/ 的/ 网络/ 计算/ 模式/ ,/ 强调/ 在/ 虚拟/ 计算环境/ 下/ 运行/ 大规模/ 应用/ 的/ 可伸缩性/ 和/ 可用性/ ./ 基于/ 云/ 计算/ 的/ 大型/ 网络应用/ 呈现出/ 分布/ 、/ 异构/ 的/ 特点/ 和/ 数据/ 密集/ 的/ 趋势/ ,/ 如/ 科学/ 工作/ 流/ 系统/ ,/ 这/ 类/ 应用/ 被/ 称为/ 数据/ 密集型/ 应用/ [/ 1/ ]/ ./ 目前/ 数据/ 密集型/ 应用/ 已/ 被/ 广泛应用/ 于/ 天文学/ [/ 2/ ]/ 、/ 高能物理/ 学/ [/ 3/ ]/ 以及/ 生物/ 信息学/ [/ 4/ ]/ 等/ 领域/ ./ 这类/ 应用/ 的/ 数据/ 密集/ 性/ 主要/ 体现/ 在/ 其/ 处理/ 的/ 数据/ 大小/ 通常/ 达/ TB/ 甚至/ PB/ 级/ ,/ Page2/ 其中/ 既有/ 已/ 存在/ 的/ 输入/ 数据源/ ,/ 也/ 有/ 在/ 对/ 数据/ 进行/ 分析/ 和/ 处理/ 的/ 过程/ 中/ 产生/ 的/ 中间/ 数据/ 和/ 最终/ 结果/ 数据/ ,/ 而/ 通过/ 使用/ 流程/ 管理/ 技术/ ,/ 可以/ 实现/ 这/ 类/ 数据/ 密集型/ 应用/ 的/ 自动化/ 执行/ ./ 数据/ 密集型/ 应用/ ,/ 尤其/ 是/ 那些/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ ,/ 在/ 利用/ 云/ 计算环境/ 的/ 过程/ 中/ 遇到/ 了/ 一些/ 新/ 的/ 挑战/ ,/ 特别/ 是/ 在/ 数据/ 布局/ 方面/ 尤为/ 突出/ ./ 在/ 云/ 计算环境/ 下/ 部署/ 并/ 执行/ 数据/ 密集型/ 应用/ ,/ 需要/ 多/ 数据中心/ 的/ 协作/ ,/ 因此/ 在/ 多/ 数据中心/ 环境/ 下/ 如何/ 为/ 大量/ 数据/ 选择/ 合适/ 的/ 存放/ 位置/ 变得/ 至关重要/ ,/ 具体表现/ 为/ :/ (/ 1/ )/ 面对/ 云/ 环境/ 下/ 的/ 多/ 数据中心/ ,/ 这些/ 应用/ 在/ 其/ 执行/ 过程/ 中/ 不可避免/ 地/ 需要/ 进行/ 跨/ 数据中心/ 的/ 数据传输/ ./ 一方面/ 数据/ 规模/ 巨大/ 而/ 数据中心/ 间/ 网络带宽/ 有限/ ,/ 另一方面/ 存在/ 一些/ 数据/ 只能/ 被/ 存放/ 于/ 指定/ 的/ 数据中心/ 而/ 不能/ 被/ 移动/ ,/ 故/ 数据中心/ 间/ 的/ 数据传输/ 成为/ 一个/ 挑战/ ./ (/ 2/ )/ 这/ 类/ 应用/ 的/ 流程/ 特性/ 决定/ 了/ 其/ 数据/ 之间/ 存在/ 数据/ 依赖/ 关系/ ./ 在/ 多/ 数据中心/ 环境/ 下/ ,/ 合理/ 的/ 数据/ 布局/ 方案/ 应/ 力求/ 保持/ 这种/ 数据/ 间/ 的/ 依赖/ 关系/ ,/ 这/ 将/ 利于/ 降低/ 流程/ 执行/ 过程/ 中/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ,/ 进而/ 提升/ 执行/ 效率/ ./ (/ 3/ )/ 合理/ 的/ 数据/ 布局/ 方案/ ,/ 应/ 在/ 对/ 应用/ 执行/ 效率/ 进行/ 优化/ 的/ 基础/ 上/ ,/ 兼顾/ 多/ 数据中心/ 间/ 的/ 全局/ 负载/ 均衡/ ./ 本文/ 通过/ 分析/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 的/ 特点/ ,/ 在/ 全面/ 考虑/ 数据传输/ 次数/ 、/ 数据/ 集/ 大小/ 以及/ 数据中心/ 间/ 网络带宽/ 等/ 因素/ 的/ 基础/ 上/ ,/ 提出/ 云/ 计算环境/ 下面/ 向/ 数据/ 密集型/ 应用/ 的/ 三/ 阶段/ 数据/ 布局/ 策略/ ,/ 该/ 策略/ 的/ 3/ 个/ 阶段/ 分别/ 针对/ 跨/ 数据中心/ 数据传输/ 、/ 数据/ 间/ 依赖/ 关系/ 和/ 多/ 数据中心/ 间/ 负载/ 均衡/ 三个/ 目标/ 对/ 数据/ 布局/ 方案/ 进行/ 求解/ 和/ 优化/ ./ 该/ 策略/ 一方面/ 解决/ 了/ 多/ 数据中心/ 环境/ 下/ 大规模/ 数据/ 的/ 布局/ 问题/ ,/ 降低/ 了/ 应用/ 执行/ 过程/ 中/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ;/ 另一方面/ ,/ 对/ 数据/ 集间/ 的/ 数据/ 依赖/ 关系/ 进行/ 建模/ 并/ 依此/ 对/ 不同/ 数据/ 布局/ 方案/ 进行/ 评价/ 和/ 调整/ ,/ 以/ 使/ 数据/ 布局/ 方案/ 尽可能/ 符合/ 数据/ 集间/ 的/ 依赖/ 关系/ ;/ 此外/ ,/ 对/ 不同/ 的/ 数据/ 布局/ 方案/ 所/ 对应/ 的/ 负载/ 均衡/ 状况/ 进行/ 量化/ 分析/ 并/ 依此/ 对/ 数据/ 布局/ 方案/ 进行/ 筛选/ ,/ 从而/ 在/ 保证/ 执行/ 效率/ 的/ 基础/ 上/ 兼顾/ 全局/ 的/ 负载/ 均衡/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ,/ 并/ 在/ 此基础/ 上/ 进一步/ 阐明/ 本文/ 与/ 相关/ 工作/ 的/ 差异/ 与/ 研究/ 意义/ ;/ 第/ 3/ 节/ 介绍/ 云/ 环境/ 下/ 数据/ 密集型/ 流程/ 应用/ 的/ 数据/ 布局/ 问题/ ,/ 并/ 对/ 相关/ 概念/ 进行/ 建模/ ;/ 第/ 4/ 节/ 介绍/ 本文/ 所提/ 的/ 三/ 阶段/ 数据/ 布局/ 管理策略/ 以及/ 数据/ 布局/ 方案/ 的/ 求解/ 与/ 优化/ 过程/ ;/ 第/ 5/ 节/ 通过/ 仿真/ 实验/ 将/ 本文/ 数据/ 布局/ 策略/ 与/ 其它/ 同类/ 策略/ 进行/ 对比/ ,/ 并/ 对/ 结果/ 进行/ 分析/ ;/ 最后/ 一节/ ,/ 将/ 对/ 本文/ 工作/ 进行/ 总结/ 并/ 对/ 后续/ 研究/ 进行/ 展望/ ./ 2/ 相关/ 工作/ 本/ 节/ 首先/ 简要/ 介绍/ 当前/ 云/ 计算环境/ 下/ 的/ 数据/ 管理系统/ ;/ 然后/ 阐述/ 几种/ 数据/ 密集型/ 应用/ 系统/ 的/ 数据管理/ 策略/ ;/ 之后/ 介绍/ 目前/ 关于/ 数据/ 依赖性/ 的/ 研究/ ;/ 最后/ ,/ 介绍/ 当前/ 针对/ 云/ 计算环境/ 下/ 数据/ 密集型/ 应用/ 的/ 数据/ 布局/ 问题/ 的/ 相关/ 研究/ ,/ 并/ 指出/ 其/ 局限性/ ./ 随着/ 云/ 计算/ 日益/ 受到重视/ ,/ 目前/ 出现/ 了/ 一些/ 云/ 计算环境/ 下/ 的/ 数据/ 管理系统/ ,/ 例如/ GoogleFileSystem/ [/ 5/ ]/ 和/ Hadoop/ ①/ ,/ 二者/ 均/ 对/ 用户/ 隐藏/ 了/ 用于/ 存储/ 应用/ 数据/ 的/ 基础设施/ ./ GoogleFileSystem/ 主要/ 针对/ Web/ 搜索/ 应用/ ,/ 而/ 非云/ 计算环境/ 下/ 的/ 流程/ 应用/ ./ Hadoop/ 则/ 是/ 一个/ 更为/ 通用/ 的/ 分布式文件系统/ ,/ 包括/ Amazon/ 和/ Facebook/ 在内/ 的/ 许多/ 公司/ 使用/ 该/ 系统/ ./ 当/ Hadoop/ 文件系统/ 接收/ 到/ 一个/ 文件/ 时/ ,/ 系统/ 会/ 自动/ 将/ 该/ 文件/ 分为/ 若干块/ ,/ 并/ 将/ 每个/ 块/ 随机/ 放置/ 于/ 某个/ 集群/ 中/ ./ 此外/ ,/ Cumulus/ 项目/ [/ 6/ ]/ 提出/ 了/ 一个/ 单/ 数据中心/ 环境/ 的/ 云/ 架构/ ./ 然而/ ,/ 上述/ 云/ 数据/ 管理系统/ 并未/ 针对/ 云/ 环境/ 下/ 数据/ 密集型/ 流程/ 应用/ 的/ 数据/ 布局/ 问题/ 进行/ 相关/ 研究/ ./ 常见/ 的/ 数据/ 密集型/ 流程/ 应用/ 系统/ 都/ 有/ 其/ 各自/ 的/ 数据管理/ 策略/ ./ 在/ 流程/ 的/ 构建/ 阶段/ ,/ 这/ 类/ 策略/ 主要/ 针对/ 数据/ 的/ 建模/ ,/ 例如/ Kepler/ [/ 3/ ]/ 使用/ 了/ 一种/ 面向/ 角色/ 的/ 数据/ 建模/ 方法/ ,/ 用于/ 网格/ 环境/ 下/ 的/ 大规模/ 数据/ 建模/ ;/ Taverna/ [/ 4/ ]/ 和/ ASKALON/ [/ 7/ ]/ 则/ 分别/ 采用/ 了/ 各自/ 的/ 流程/ 定义语言/ 来/ 表示/ 其/ 数据流/ ./ 在/ 流程/ 的/ 执行/ 阶段/ ,/ 大部分/ 系统/ 采用/ 某种/ 数据/ 网格/ 来/ 对/ 数据/ 进行/ 管理/ ,/ 例如/ Kepler/ 使用/ 了/ SRB/ [/ 8/ ]/ 系统/ ,/ Pegasus/ [/ 2/ ]/ 和/ Triana/ [/ 9/ ]/ 采用/ 了/ RLS/ 系统/ [/ 10/ ]/ ./ 数据/ 网格/ 的/ 主要/ 作用/ 是/ 为/ 分布式/ 环境/ 下/ 的/ 数据/ 密集型/ 应用/ 提供/ 基础设施/ 与/ 服务/ ,/ 以/ 实现/ 对/ 分布/ 存储资源/ 中/ 海量/ 数据/ 集/ 的/ 访问/ 、/ 移动/ 和/ 修改/ [/ 11/ ]/ ./ 然而/ ,/ 无论/ 在/ 流程/ 的/ 构建/ 阶段/ 还是/ 执行/ 阶段/ ,/ 这些/ 系统/ 的/ 数据管理/ 策略/ 都/ 没有/ 关注/ 数据/ 的/ 存放/ 布局/ ,/ 既/ 没有/ 考虑/ 数据/ 间/ 的/ 依赖性/ ,/ 也/ 无法/ 减少/ 跨/ 数据中心/ 的/ 数据/ 移动/ ./ 当前/ 已有/ 一些/ 研究/ 注意/ 到/ 数据/ 密集型/ 流程/ 应用/ 中/ 的/ 数据/ 依赖性/ 问题/ ./ Filecules/ 项目/ [/ 12/ ]/ 基于/ 依赖/ 关系/ 对/ 文件/ 进行/ 分组/ ,/ 实验/ 数据/ 显示/ 了/ 其/ 分组/ 策略/ 的/ 可用性/ 和/ 有效性/ ./ BitDew/ [/ 13/ ]/ 将/ 数据/ 的/ 依赖性/ 定义/ 为/ 数据/ 的/ 一个/ 属性/ ,/ 该/ 属性/ 由/ 用户/ 进行/ 预定/ 义/ ./ 然而/ ,/ ①/ Hadoop/ :/ http/ :/ // // hadoop/ ./ apache/ ./ orgPage3/ 云/ 计算环境/ 中/ 的/ 所有/ 数据/ 均/ 位于/ 各/ 数据中心/ ,/ 因此/ 由/ 用户/ 来/ 定义数据/ 间/ 的/ 依赖/ 关系/ ,/ 对云/ 计算环境/ 下/ 的/ 数据/ 密集型/ 应用/ 而言/ 是/ 不/ 现实/ 的/ ./ 此外/ ,/ 这些/ 研究/ 虽然/ 关注/ 数据/ 间/ 的/ 依赖性/ ,/ 但/ 并未/ 基于/ 此来/ 解决/ 数据/ 布局/ 问题/ ,/ 也/ 没有/ 考虑/ 跨/ 数据中心/ 数据传输/ 的/ 代价/ 问题/ ./ 针对/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 的/ 数据/ 布局/ 管理/ 问题/ ,/ 文献/ [/ 14/ ]/ 提出/ 了/ 一种/ 基于/ 聚类/ 矩阵/ 的/ 数据/ 布局/ 策略/ ,/ 用于/ 多/ 数据中心/ 环境/ 下/ 数据/ 布局/ 方案/ 的/ 求解/ 和/ 优化/ ./ 该/ 方法/ 首先/ 将/ 流程/ 应用/ 的/ 所有/ 输入/ 数据/ 构建/ 为/ 依赖/ 矩阵/ ,/ 再/ 利用/ BEA/ [/ 15/ ]/ 算法/ 对/ 依赖/ 矩阵/ 进行/ 聚类/ 变换/ 从而/ 得到/ 聚类/ 矩阵/ ,/ 然后/ 基于/ 聚类/ 矩阵/ 对/ 所有/ 数据/ 集/ 组成/ 的/ 集合/ 进行/ 划分/ ,/ 并/ 分别/ 为/ 所得/ 每个/ 划分/ 分配/ 存放/ 位置/ ./ 实验/ 证明/ 该/ 策略/ 能够/ 减少/ 云/ 计算环境/ 下/ 流程/ 应用/ 执行/ 过程/ 中/ 的/ 跨/ 数据中心/ 数据传输/ 的/ 总/ 次数/ ./ 然而/ ,/ 数据传输/ 总/ 次数/ 的/ 减少/ 并不一定/ 意味着/ 执行/ 效率/ 的/ 提高/ ,/ 因为/ 每次/ 所/ 传输数据/ 量/ 的/ 大小/ 并不一定/ 相同/ ,/ 且/ 遍布/ Internet/ 的/ 各/ 数据中心/ 两/ 两/ 之间/ 的/ 网络带宽/ 也/ 不/ 一定/ 相同/ ,/ 即/ 执行/ 过程/ 中/ 跨/ 数据中心/ 数据传输/ 总/ 次数/ 的/ 减少/ ,/ 并/ 不能/ 等同于/ 数据传输/ 所/ 导致/ 时间/ 开销/ 的/ 减少/ ./ 综上所述/ ,/ 虽然/ 针对/ 云/ 数据管理/ 和/ 流程/ 密集型/ 应用/ 数据管理/ 的/ 研究/ 较/ 多/ ,/ 但/ 关于/ 云/ 计算环境/ 下/ 数据/ 密集型/ 流程/ 应用/ 的/ 数据/ 布局/ 问题/ 的/ 研究/ 较/ 少/ ,/ 当前/ 少数/ 针对/ 该/ 问题/ 的/ 研究/ 也/ 存在/ 一定/ 的/ 局限性/ ,/ 即/ 只/ 关注/ 跨/ 数据中心/ 数据传输/ 的/ 次数/ ,/ 而/ 忽视/ 了/ 所/ 传输数据/ 量/ 大小/ 、/ 各/ 数据中心/ 间/ 的/ 网络带宽/ 差异/ 等/ 因素/ ,/ 因此/ 难以/ 对/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ 进行/ 有/ 针对性/ 的/ 优化/ 并/ 进而/ 提高/ 流程/ 应用/ 的/ 执行/ 效率/ ./ 3/ 问题/ 描述/ 与/ 建模/ 本节/ 将/ 对/ 云/ 计算环境/ 下/ 数据/ 密集型/ 流程/ 应用/ 的/ 数据/ 布局/ 问题/ 的/ 相关/ 概念/ 进行/ 建模/ ,/ 具体/ 包括/ 云/ 计算环境/ 、/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ 、/ 单次/ 数据传输/ 时间/ 开销/ 和/ 全局/ 数据传输/ 时间/ 开销/ ./ 3.1/ 云/ 计算环境/ 云/ 计算环境/ 由/ 多个/ 分布/ 的/ 数据中心/ 组成/ ./ 由于/ 本文/ 研究/ 重点/ 为云/ 计算环境/ 下/ 的/ 数据/ 布局/ 问题/ ,/ 故/ 本文/ 仅/ 关注/ 其/ 存储资源/ 和/ 网络带宽/ ./ 据/ 中心/ 组成/ 的/ 集合/ DC/ =/ ∪/ i/ =/ 1/ ,/ 2/ …/ ,/ |/ DC/ |/ 示/ 编号/ 为/ i/ 的/ 数据中心/ ,/ csi/ 表示/ 数据中心/ dci/ 的/ 可用/ 定义/ 1/ ./ 将/ 云/ 计算环境/ 表示/ 为/ 多个/ 分布式/ 数/ 存储空间/ ./ DC/ 中/ 各/ 数据中心/ 间/ 网络带宽/ 矩阵/ 表示/ 为/ 对/ / i/ ,/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DC/ |/ 且/ i/ ≠/ j/ ,/ B/ 中/ 元素/ bij/ 表示/ 数据中心/ dci/ 和/ dcj/ 之间/ 的/ 网络带宽/ 值/ ./ 本文/ 假设/ 各/ 数据中心/ 间/ 网络带宽/ 值/ 可知/ 并/ 忽略/ 其实/ 时/ 波动/ ./ 3.2/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ 定义/ 2/ ./ 将/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ 定义/ 为/ 三元组/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ ./ 其中/ T/ 是/ P/ 中/ 所有/ 任务/ 的/ 集合/ ;/ C/ 是/ 各/ 任务/ 间/ 的/ 控制流/ 的/ 集合/ ;/ DS/ 是/ P/ 中/ 所有/ 数据/ 集/ 的/ 集合/ ./ 对/ 流程/ 应用/ 中/ 的/ 单个/ 任务/ ,/ 本文/ 只/ 关注/ 其/ 输入/ 数据/ 集/ 与/ 输出/ 数据/ 集/ ,/ 定义/ 如下/ ./ 定义/ 3/ ./ 将/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 中/ 的/ 单个/ 任务/ 定义/ 为/ 二元/ 组/ ti/ =/ 〈/ IDSi/ ,/ ODSi/ 〉/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ T/ |/ ./ 其中/ IDSi/ 是/ 任务/ ti/ 的/ 输入/ 数据/ 集/ 组成/ 的/ 集合/ ;/ ODSi/ 是/ 任务/ ti/ 的/ 输出/ 数据/ 集/ 组成/ 的/ 集合/ ./ 有些/ 数据/ 集只/ 允许/ 被/ 存放/ 在/ 指定/ 的/ 数据中心/ ,/ 本文/ 将/ 其/ 称为/ 固定/ 位置/ 数据/ 集/ ,/ 并/ 将/ DS/ 中/ 所有/ 固定/ 位置/ 数据/ 集/ 组成/ 的/ 集合/ 记为/ DSfix/ ,/ 对/ / di/ ∈/ DSfix/ ,/ 记/ di/ 的/ 指定/ 存放/ 位置/ 的/ 数据中心/ 编号/ 为/ fix/ (/ di/ )/ ;/ 而/ 允许/ 被/ 存放/ 于/ 任意/ 数据中心/ 的/ 数据/ 集则/ 被/ 称为/ 可变/ 位置/ 数据/ 集/ ,/ 记/ DS/ 中/ 所有/ 可变/ 位置/ 数据/ 集/ 组成/ 的/ 集合/ 为/ DSflex/ ./ 按/ 数据/ 集/ 的/ 产生/ 时间/ ,/ 又/ 可/ 将/ 数据/ 集/ 分为/ 初始/ 数据/ 集/ 和/ 生成/ 数据/ 集/ ./ 作为/ 流程/ 应用/ 的/ 初始/ 输入/ 数据/ 而/ 在/ 流程/ 执行/ 前/ 已/ 存在/ 的/ 数据/ 集/ ,/ 本文/ 将/ 其/ 称为/ 初始/ 数据/ 集/ ,/ 并/ 将/ DS/ 中/ 所有/ 初始/ 数据/ 集/ 组成/ 的/ 集合/ 记为/ DSini/ ;/ 而/ 在/ 执行/ 过程/ 中/ 产生/ 的/ 数据/ 集则/ 被/ 称为/ 生成/ 数据/ 集/ ,/ DS/ 中/ 所有/ 生成/ 数据/ 集/ 组成/ 的/ 集合/ 被/ 记为/ DSgen/ ./ 对/ DS/ 中/ 的/ 单个/ 数据/ 集/ ,/ 本文/ 只/ 关注/ 其/ 大小/ 、/ 固定/ 存放/ 位置/ 和/ 来源/ ,/ 定义/ 如下/ ./ 定义/ 4/ ./ 将/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 中/ 的/ 单个/ 数据/ 集/ 定义/ 为/ 三元组/ di/ =/ 〈/ dsi/ ,/ lci/ ,/ gti/ 〉/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DS/ |/ ./ 其中/ dsi/ 是/ 数据/ 集/ di/ 的/ 大小/ ;/ lci/ 和/ gti/ 的/ 取值/ 如下/ :/ lci/ =/ 0/ ,/ di/ ∈/ DSflex/ 烅/ 烄/ fix/ (/ di/ )/ ,/ di/ ∈/ DSf/ 烆/ 结合/ 图/ 1/ 中/ 的/ 两个/ 简单/ 示例/ 说明/ 本文/ 对/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ 的/ 建模/ ./ 在/ 图/ 1/ (/ a/ )/ 中/ :/ T/ =/ Page4/ {/ t1/ ,/ t2/ ,/ t3/ ,/ t4/ }/ ,/ 以/ 其中/ t3/ 为例/ ,/ t3/ =/ 〈/ {/ d3/ ,/ d4/ }/ ,/ {/ d5/ }/ 〉/ ;/ DS/ =/ {/ d1/ ,/ d2/ ,/ d3/ ,/ d4/ ,/ d5/ ,/ d6/ ,/ d7/ }/ ,/ 以/ 其中/ d6/ 为例/ ,/ 不妨/ 设/ d6/ 是/ 固定/ 位置/ 数据/ 集/ 必须/ 被/ 放置/ 于/ 2/ 号/ 数据中心/ 且/ d6/ 大小/ 为/ 2000GB/ ,/ 则/ d6/ =/ 〈/ 2000/ ,/ 2/ ,/ 0/ 〉/ ./ 在/ 图/ 1/ (/ b/ )/ 中/ :/ T/ =/ {/ t1/ ,/ t2/ ,/ t3/ ,/ t4/ ,/ t5/ ,/ t6/ }/ ,/ 以/ 其中/ 任务/ t3/ 为例/ ,/ t3/ =/ 〈/ {/ d3/ ,/ d7/ }/ ,/ {/ d6/ }/ 〉/ ;/ DS/ =/ {/ d1/ ,/ d2/ ,/ d3/ ,/ d4/ ,/ d5/ ,/ d6/ ,/ d7/ ,/ d8/ ,/ d9/ ,/ d10/ }/ ,/ 以/ 其中/ 数据/ 集/ d8/ 为例/ ,/ 不妨/ 设/ d8/ 是/ 可变/ 位置/ 数据/ 集且/ 大小/ 为/ 500GB/ ,/ 则/ d8/ =/ 〈/ 500/ ,/ 0/ ,/ 1/ 〉/ ./ 3.3/ 单次/ 数据传输/ 时间/ 开销/ 云/ 计算环境/ 下/ ,/ 流程/ 中/ 每个/ 任务/ 要/ 开始/ 执行/ 须/ 至少/ 满足/ 两个/ 条件/ :/ (/ 1/ )/ 该/ 任务/ 被/ 调度/ 至/ 某个/ 数据中心/ ;/ (/ 2/ )/ 该/ 任务/ 的/ 所有/ 输入/ 数据/ 集均/ 位于/ 本地/ ./ 因此/ 若/ 一个/ 任务/ 的/ 多个/ 输入/ 数据/ 集/ 位于/ 不同/ 的/ 数据中心/ ,/ 则/ 须/ 在/ 任务/ 开始/ 执行/ 前/ 进行/ 跨/ 数据中心/ 的/ 数据传输/ ./ 关于/ 任务调度/ 策略/ 已有/ 许多/ 相关/ 研究/ 且/ 并非/ 本文/ 重点/ ,/ 故/ 本文/ 基于/ 将/ 任务调度/ 至/ 数据中心/ 比/ 进行/ 跨/ 数据中心/ 数据传输/ 所/ 造成/ 时间/ 开销/ 更/ 小/ 的/ 假设/ ,/ 将/ 任务调度/ 策略/ 简化/ 为/ :/ 将/ 任务调度/ 至/ 那个/ 使/ 执行/ 该/ 任务/ 所/ 需/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 时间/ 开销/ 最小/ 的/ 数据中心/ ./ 考虑/ 单个/ 数据/ 集单次/ 跨/ 数据中心/ 传输/ 的/ 情况/ ./ 设源/ 数据中心/ 、/ 目标/ 数据中心/ 和/ 目标/ 数据/ 集/ 分别/ 为/ dci/ 、/ dcj/ 和/ dk/ ,/ 则/ 该次/ 数据传输/ 的/ 时间/ 开销/ 可/ 表示/ 为式/ (/ 1/ )/ 中/ dk/ ,/ dci/ ,/ dcj3/ 个/ 参数/ 依次/ 表示/ 目标/ 数据/ 集/ 、/ 源/ 数据中心/ 和/ 目标/ 数据中心/ ./ dsk/ 表示/ 数据/ 集/ dk/ 的/ 大小/ ;/ bij/ 表示/ 数据中心/ dci/ 和/ dcj/ 间/ 的/ 网络带宽/ ./ 此外/ ,/ 在/ 跨/ 数据中心/ 的/ 数据传输/ 过程/ 中/ 存在/ 着/ 请求/ 、/ 响应/ 、/ 建立/ 连接/ 、/ 断开连接/ 等/ 步骤/ ,/ 也/ 会/ 造成/ 一部分/ 时间/ 开销/ ,/ 将/ 其/ 记为/ Cij/ ./ 考虑/ 到/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 的/ 数据/ 规模/ 巨大/ ,/ 而/ Cij/ 相对/ 较/ 小/ ,/ 故/ 本文/ 忽略/ Cij/ 所/ 代表/ 的/ 那/ 部分/ 与/ 被/ 传输数据/ 集/ 大小/ 无关/ 的/ 时间/ 开销/ ./ 因此/ ,/ 使用/ 下面/ 式/ (/ 2/ )/ 可/ 近似计算/ 单个/ 数据/ 集单次/ 跨/ 数据中心/ 传输/ 所/ 造成/ 的/ 时间/ 开销/ 3.4/ 全局/ 数据传输/ 时间/ 开销/ 定义/ 5/ ./ 在/ 数据中心/ 集合/ DC/ =/ ∪/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DC/ |/ 已知/ 的/ 云/ 计算环境/ 中/ ,/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 的/ 一个/ 数据/ 布局/ 方案/ ,/ 是从/ 集合/ DS/ 到/ 集合/ DC/ 的/ 映射/ ,/ 使/ 对/ / di/ ∈/ DS/ ,/ 存在/ 唯一/ dcj/ ∈/ DC/ 与/ 之/ 对应/ ./ 记/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 的/ 一个/ 数据/ 布局/ 方案/ 为/ s/ ,/ 则/ 有/ s/ =/ ∪/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DS/ |/ DC/ ./ 对/ / di/ ∈/ DS/ ,/ 记/ s/ (/ di/ )/ 为/ 在/ 给定/ 数据/ 布局/ 方案/ s/ 中/ 数据/ 集/ di/ 所/ 对应/ 存放/ 位置/ 的/ 数据中心/ 编号/ ./ 定义/ 6/ ./ 在/ 数据中心/ 集合/ DC/ =/ ∪/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DC/ |/ 已知/ 的/ 云/ 计算环境/ 中/ ,/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 的/ 一个/ 数据/ 布局/ 方案/ s/ 的/ 全局/ 跨/ 数据中心/ 数据传输/ 时间/ 开销/ ,/ 是/ 指/ 在/ DS/ 中/ 所有/ 数据/ 集/ 按/ s/ 进行/ 布局/ 的/ 情况/ 下/ ,/ P/ 的/ 执行/ 过程/ 中/ 由/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ./ 若/ 已知/ 数据中心/ 集合/ DC/ 、/ 流程/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 和/ 数据/ 布局/ 方案/ s/ ,/ 则/ 可/ 通过/ 模拟/ 流程/ 应用/ 的/ 执行/ 过程/ 来/ 近似计算/ 数据/ 布局/ 方案/ s/ 的/ 全局/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ./ 求解/ 给定/ 布局/ 方案/ 的/ 全局/ 跨/ 数据中心/ 数据传输/ 时间/ 开销/ 的/ 近似计算/ 算法/ 将/ 在/ 4.1/ ./ 3/ 节中/ 给出/ ./ 4/ 数据/ 布局/ 策略/ 与/ 求解/ 方法/ 如图/ 2/ 所示/ ,/ 本文/ 提出/ 的/ 数据/ 布局/ 求解/ 方法/ 的/ 过程/ 可/ 分为/ 3/ 个/ 阶段/ :/ 第/ 1/ 阶段/ ,/ 基于/ 遗传算法/ 求得/ 一组/ 跨/ 数据中心/ 数据传输/ 代价/ 较/ 小/ 的/ 数据/ 布局/ 方案/ ;/ 第/ 2/ 阶段/ ,/ 计算/ 第/ 1/ 阶段/ 所得/ 方案/ 集合/ 中/ 各/ 方案/ 的/ 数据/ 依赖/ 关系/ 破坏/ 度/ ,/ 并/ 依此/ 对/ 方案/ 集/ 进行/ 调整/ ;/ 第/ 3/ 阶段/ ,/ 对/ 第/ 2/ 阶段/ 所得/ 方案/ 集中/ 的/ 各/ 方案/ 的/ 数据中心/ 负载/ 均衡/ 状况/ 进行/ 定量分析/ ,/ 并/ 依此/ 确定/ 最终/ 的/ 数据/ 布局/ 方案/ ./ Page5/ 图/ 2/ 本文/ 数据/ 布局/ 求解/ 全过程/ 流程图/ 4.1/ 数据/ 布局/ 求解/ 第/ 1/ 阶段/ 在/ 数据/ 布局/ 求解/ 的/ 第/ 1/ 阶段/ ,/ 基于/ 遗传算法/ 求解/ 一组/ 跨/ 数据中心/ 数据传输/ 代价/ 较/ 小/ 的/ 数据/ 布局/ 方案/ ./ 下面/ 针对/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 的/ 数据/ 布局/ 问题/ ,/ 分别/ 从/ 编码/ 规则/ 、/ 解/ 的/ 有效性/ 保证/ 和解/ 的/ 评价/ 函数/ 3/ 个/ 方面/ 对/ 数据/ 布局/ 方案/ 求解/ 过程/ 的/ 第/ 1/ 阶段/ 进行/ 介绍/ ,/ 并/ 给出/ 第/ 1/ 阶段/ 求解/ 算法/ ./ 4.1/ ./ 1/ 编码/ 规则/ 对云/ 计算环境/ 下/ 的/ 数据中心/ 集合/ DC/ ,/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ ,/ 数据/ 布局/ 方案/ 求解/ 第/ 1/ 阶段/ 中解/ 的/ 编码/ 规则/ 如下/ :/ 对/ / dci/ ∈/ DC/ ,/ 用/ log/ |/ DC/ |/ 体/ 的/ ,/ 对/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DC/ |/ -/ 1/ ,/ dci/ 的/ 编码/ 为/ i/ 的/ 2/ 位/ 二进制/ 数/ ;/ 而/ 编号/ 为/ |/ DC/ |/ 的/ 数据中心/ 所/ log/ |/ DC/ |/ 对应/ 的/ 编码/ 为/ log/ |/ DC/ |/ 如下/ 关系/ :/ 数据中心/ dc1dc2/ …/ dc9dc10/ 编码/ 00010010/ …/ 10010000/ 对/ DS/ 中/ 的/ 每个/ 数据/ 集/ di/ ∈/ DS/ ,/ 用/ 一个/ 长度/ 为/ 2/ 的/ 数据中心/ 编码表示/ 其/ 存放/ 位置/ ./ 对/ 每个/ log/ |/ DC/ |/ 数据/ 布局/ 方案/ ,/ 用/ |/ DS/ |/ ×/ log/ |/ DC/ |/ 示/ :/ 对/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ |/ DS/ |/ ,/ 染色体/ 左侧/ 第/ i/ 个/ 长度/ 为/ 2/ 的/ 基因/ 片段/ 表示/ 数据/ 集/ di/ 存放/ 位置/ 的/ 数据/ log/ |/ DC/ |/ 中心/ 编号/ ./ 例如/ ,/ 当/ |/ DC/ |/ =/ |/ DS/ |/ =/ 10/ 时/ ,/ “/ 将/ 数据/ 集/ di/ 存放/ 于/ 数据中心/ dci/ ”/ 这一/ 数据/ 布局/ 方案/ 所/ 对应/ 的/ 编码/ 为/ 然而/ 并非/ 每个/ 长度/ 为/ |/ DS/ |/ ×/ log/ |/ DC/ |/ 0001001000110100010101100111100010010000/ ./ 制数/ 都/ 一定/ 能/ 表示/ 一个/ 数据/ 布局/ 方案/ 的/ 有效/ 解/ ./ 4.1/ ./ 2/ 节/ 中将/ 讨论/ 解/ 的/ 有效性/ 问题/ 与/ 解/ 的/ 有效性/ 保证/ 机制/ ./ 4.1/ ./ 2/ 解/ 的/ 有效性/ 保证/ 根据/ 不同/ 的/ 失效/ 原因/ 可/ 将/ 无效/ 解/ 分为/ 3/ 类/ ,/ 下面/ 分别/ 说明/ ,/ 并/ 给出/ 对应/ 的/ 有效性/ 保证/ 机制/ ./ 第/ 1/ 类/ 无效/ 解/ ./ 若解/ s/ 的/ 染色体/ 中/ 存在/ 至少/ 一个/ 基因/ 片段/ 不能/ 代表/ DC/ 中/ 的/ 数据中心/ ,/ 则/ 解/ s/ 为/ 第/ 1/ 类/ 无效/ 解/ ./ 根据/ 4.1/ ./ 1/ 节中/ 的/ 编码/ 规则/ ,/ 当/ |/ DC/ |/ 满足/ log/ |/ DC/ |/ 1/ 共/ 2log/ |/ DC/ |/ 数据中心/ ,/ 记/ 这些/ 二进制/ 数/ 的/ 集合/ 为/ FS/ |/ DC/ |/ ,/ 记解/ s/ 的/ 染色体/ 中/ 所有/ |/ DS/ |/ 个/ 基因/ 片段/ 所/ 对应/ 的/ 二进制/ 数/ 的/ 集合/ 为/ PSs/ ,/ 则/ 有/ 在/ 初始/ 布局/ 方案/ 的/ 生成/ 阶段/ 、/ 遗传/ 过程/ 中/ 的/ 交叉/ 、/ 变异/ 阶段/ ,/ 用式/ (/ 3/ )/ 对/ 每个/ 新/ 产生/ 的/ 解/ 进行/ 判断/ ,/ 若式/ (/ 3/ )/ 成立/ 则/ 淘汰/ 该解/ ./ 第/ 2/ 类/ 无效/ 解/ ./ 若解/ s/ 所/ 表示/ 的/ 数据/ 布局/ 方案/ 使/ 至少/ 一个/ 数据中心/ 在/ 流程/ 开始/ 执行/ 前/ 已/ 处于/ 超负荷/ 状态/ ,/ 则/ 解/ s/ 为/ 第/ 2/ 类/ 无效/ 解/ ./ 为/ 保证/ 数据中心/ 的/ 正常/ 运转/ ,/ 通常/ 为/ 数据中心/ 设置/ 一个/ 经验/ 参数/ λ/ ,/ 若/ 数据中心/ 的/ 使用率/ 不/ 小于/ λ/ ,/ 则/ 认为/ 该/ 数据中心/ 处于/ 超负荷/ 状态/ ./ 如/ 3.4/ 节/ 所述/ ,/ s/ (/ di/ )/ 表示/ 在/ 解/ s/ 所/ 代表/ 的/ 数据/ 布局/ 方案/ 中/ 数据/ 集/ di/ 存放/ 位置/ 的/ 数据/ Page6/ 中心/ 编号/ ,/ 则/ 有/ / / dci/ ∈/ DC/ ,/ 使/ ∑/ s/ (/ dj/ )/ =/ i/ 在/ 初始/ 布局/ 方案/ 的/ 生成/ 阶段/ 、/ 遗传/ 过程/ 中/ 的/ 交叉/ 、/ 变异/ 阶段/ ,/ 用式/ (/ 4/ )/ 对/ 每个/ 新/ 产生/ 的/ 解/ 进行/ 判断/ ,/ 若式/ (/ 4/ )/ 成立/ 则/ 淘汰/ 该解/ ./ 第/ 3/ 类/ 无效/ 解/ ./ 若/ 在/ 解/ s/ 所/ 表示/ 的/ 数据/ 布局/ 方案/ 中/ ,/ 至少/ 存在/ 一个/ 固定/ 位置/ 数据/ 集/ 的/ 存放/ 位置/ 与其/ 指定/ 位置/ 不同/ ,/ 则/ 解/ s/ 为/ 第/ 3/ 类/ 无效/ 解/ ./ / / di/ ∈/ DSfix/ ,/ 使/ lci/ ≠/ 0/ 且/ lci/ ≠/ s/ (/ di/ )/ ,/ 则/ s/ 无效/ 本文/ 对/ 第/ 3/ 类/ 无效/ 解/ 处理/ 策略/ 如下/ :/ 设/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 满足/ DSfix/ ≠/ / ,/ 则/ 在/ 生成/ 初始/ 解/ 空间/ 的/ 过程/ 中/ ,/ 将/ 每个/ 解/ 的/ 染色体/ 中/ 所有/ 代表/ di/ ∈/ DSfix/ 存放/ 位置/ 的/ 基因/ 片段/ 按/ di/ 的/ 下标/ 升序/ 依次/ 与/ 染色体/ 左侧/ 第一个/ 代表/ di/ ∈/ DSflex/ 存放/ 位置/ 的/ 基因/ 片段/ 交换/ 位置/ ,/ 于是/ 所有/ 代表/ 固定/ 位置/ 数据/ 集/ 位置/ 的/ 基因/ 片段/ 将/ 按/ 其/ 下标/ 升序/ 依次/ 分布/ 于/ 染色体/ 左侧/ ,/ 而/ 染色体/ 的/ 其余部分/ 则/ 表示/ 所有/ 可变/ 位置/ 数据/ 集/ 的/ 存放/ 位置/ ./ 通过/ 对/ 染色体/ 进行/ 上述/ 基因/ 片段/ 的/ 位置/ 变换/ 操作/ ,/ 可/ 保证/ 在/ 交叉/ 和/ 变异/ 阶段/ 不/ 产生/ 第/ 3/ 类/ 无效/ 解/ ./ 记对/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 的/ 数据/ 布局/ 方案/ 的/ 解所/ 进行/ 的/ 上述/ 基因/ 片段/ 位置/ 变换/ 为/ Swap/ (/ P/ )/ ;/ 记/ Swap/ (/ P/ )/ 的/ 逆变换/ 为/ Swap/ -/ 1/ (/ P/ )/ ./ 4.1/ ./ 3/ 数据/ 布局/ 方案/ 的/ 评价/ 算法/ 本文/ 所提/ 的/ 数据/ 布局/ 策略/ 的/ 根本/ 目的/ 在于/ 降低/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 在/ 其/ 执行/ 过程/ 中/ 由/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ,/ 故/ 本文/ 以/ 每个/ 数据/ 布局/ 方案/ 所/ 对应/ 的/ 全局/ 数据传输/ 代价/ 的/ 近似值/ 作为/ 布局/ 方案/ 的/ 评价/ 函数/ ,/ 记/ 数据/ 布局/ 方案/ 的/ 评价/ 函数/ g/ (/ s/ )/ =/ TimeCosttotal/ (/ DC/ ,/ P/ ,/ s/ )/ ./ 对/ 给定/ 的/ 数据中心/ 集合/ DC/ 、/ 流程/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 和/ 数据/ 布局/ 方案/ s/ ,/ 可/ 通过/ 算法/ 1/ 求得/ s/ 对应/ 的/ 数据传输/ 时间/ 开销/ 的/ 近似值/ ,/ 即/ g/ (/ s/ )/ 值/ ./ 算法/ 1/ ./ 数据/ 布局/ 方案/ 的/ 时间/ 开销/ 近似算法/ ./ 输入/ :/ DC/ ,/ B/ ,/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ ,/ 数据/ 布局/ 方案/ s/ 输出/ :/ s/ 的/ 时间/ 开销/ 近似值/ TimeCosttotal/ (/ DC/ ,/ P/ ,/ s/ )/ 主要/ 步骤/ :/ 1/ ./ 初始化/ :/ 令/ cost/ =/ 0/ ,/ TASK/ 为/ P/ 中/ 所有/ 任务/ 的/ 集合/ ;/ 2/ ./ 对/ s/ 进行/ 4.1/ ./ 2/ 节/ 所述/ 的/ Swap/ -/ 1/ (/ P/ )/ 变换/ ;/ 3/ ./ 令/ t/ 为/ P/ 的/ 第一个/ 任务/ ,/ 并/ 将/ 其/ 从/ TASK/ 中/ 除去/ ;/ 4/ ./ while/ (/ TASK/ ≠/ / )/ 5/ ./ if/ (/ t/ 是/ 分支/ 任务/ )/ 6/ ./ for/ (/ 每个/ 分支/ )/ 7/ ./ 记第/ i/ 个/ 分支/ 对应/ 的/ 子/ 流程/ 为/ Pi/ ;/ 8/ ./ 递归计算/ TimeCosttotal/ (/ DC/ ,/ Pi/ ,/ s/ )/ ,/ 结果/ 记为/ 9/ ./ cost/ =/ cost/ +/ max/ {/ costi/ }/ ;/ 10/ ./ 令/ t/ 为/ t/ 对应/ 的/ 合并/ 任务/ ,/ 将/ t/ 以及/ t/ 与/ t/ 间/ 所/ 11/ ./ else12/ ./ 按/ 3.3/ 节/ 所述/ 任务调度/ 策略/ 为/ t/ 选择/ 执行/ 位/ 13/ ./ for/ (/ t/ 的/ IDS/ 中/ 每个/ 满足/ s/ (/ dj/ )/ ≠/ i/ 的/ 数据/ 集/ dj/ )/ 14/ ./ cost/ =/ cost/ +/ dsj/ // b/ (/ s/ (/ dj/ )/ ,/ i/ )/ ;/ 15/ ./ 令/ t/ 为/ t/ 在/ C/ 中/ 的/ 后继/ 任务/ ;/ 16/ ./ Return/ (/ cost/ )/ ;/ 算法/ 1/ 以/ “/ 将/ 任务调度/ 至/ 使/ 执行/ 该/ 任务/ 所/ 需/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 时间/ 开销/ 最小/ 的/ 数据中心/ ”/ 为/ 任务调度/ 策略/ ./ 若/ 使用/ 其它/ 任务调度/ 策略/ ,/ 只/ 需/ 对/ 算法/ 1/ 稍作/ 修改/ ./ 算法/ 1/ 虽然/ 只能/ 近似计算/ 给定/ 数据/ 布局/ 方案/ 的/ 数据传输/ 时间/ 开销/ ,/ 但/ 其/ 结果/ 能够/ 反映/ 不同/ 数据/ 布局/ 方案/ 所/ 对应/ 跨/ 数据中心/ 数据传输/ 时间/ 开销/ 的/ 差异/ 与/ 变化趋势/ ,/ 因此/ 算法/ 1/ 结果/ 的/ 不精确性/ 并/ 不/ 影响/ 利用/ 其/ 对/ 不同/ 的/ 数据/ 布局/ 方案/ 进行/ 评价/ 和/ 比较/ ./ 4.1/ ./ 4/ 数据/ 布局/ 求解/ 第/ 1/ 阶段/ 算法/ 算法/ 2/ ./ 数据/ 布局/ 方案/ 求解/ 第/ 1/ 阶段/ 算法/ ./ 输入/ :/ DC/ ,/ B/ ,/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ ,/ 数据/ 布局/ 方案/ s/ 输出/ :/ 时间/ 开销/ 较优/ 的/ 数据/ 布局/ 方案/ 集合/ (/ CH/ )/ 主要/ 步骤/ :/ 1/ ./ 初始化/ :/ 定义/ 变量/ popSize/ ,/ genSize/ ,/ maxGen/ ;/ 2/ ./ 令/ i/ =/ 1/ ;/ 3/ ./ while/ (/ i/ </ =/ popSize/ )/ 4/ ./ 生成/ 随机/ 布局/ 方案/ s/ ;/ 5/ ./ if/ (/ s/ 有效/ 且/ 不/ 在/ CH/ 中/ )/ // // 用式/ (/ 3/ )/ ~/ (/ 5/ )/ 进行/ 判断/ 6/ ./ 用/ 算法/ 1/ 近似计算/ s/ 的/ 时间/ 开销/ ;/ 7/ ./ 对/ s/ 进行/ 4.1/ ./ 2/ 节/ 所述/ 的/ Swap/ (/ P/ )/ 变换/ ;/ 8/ ./ 将/ s/ 加入/ CH/ ,/ i/ ++/ ;/ 9/ ./ 令/ curGen/ =/ 0/ ;/ 10/ ./ while/ (/ curGen/ </ maxGen/ )/ 11/ ./ for/ (/ CH/ 中/ 的/ 每个/ 解/ s/ )/ 12/ ./ if/ (/ random/ (/ 0/ ,/ 1/ )/ </ 变异/ 率/ mr/ )/ 13/ ./ 在/ s/ 中/ 对应/ DSflex/ 的/ 部分/ 随机/ 选择/ 变异/ 位置/ p/ ;/ 14/ ./ 在/ 位置/ p/ 对/ s/ 进行/ 变异/ ,/ 记/ 所得/ 为/ s/ ;/ 15/ ./ 对解/ s/ 进行/ Swap/ -/ 1/ (/ P/ )/ 变换/ ,/ 记/ 所得/ 为/ s/ ;/ 16/ ./ if/ (/ s/ 无效/ 或/ s/ 在/ CH/ 中/ )/ 17/ ./ goto13/ ;/ 18/ ./ 用/ s/ 替换/ s/ ,/ 并用/ 算法/ 1/ 重新/ 计算/ s/ 的/ 时间/ 开销/ ;/ 19/ ./ 计算/ CH/ 中/ 每个/ 解/ 的/ 被/ 选中/ 概率/ ;/ Page720/ ./ 令/ j/ =/ 0/ ;/ 21/ ./ while/ (/ true/ )/ 22/ ./ 依各解/ 的/ 被/ 选中/ 概率/ 从/ CH/ 中选/ 两个/ 不同/ 解/ 23/ ./ if/ (/ random/ (/ 0/ ,/ 1/ )/ </ 交叉/ 率/ cr/ )/ 24/ ./ 在/ s/ 中/ 对应/ DSflex/ 的/ 部分/ 随机/ 选择/ 交叉/ 位置/ q/ ;/ 25/ ./ 在/ 位置/ q/ 对/ s1/ 与/ s2/ 进行/ 交叉/ ,/ 记/ 所得/ 为/ s1/ ,/ s2/ ;/ 26/ ./ for/ (/ ns/ =/ s1/ ,/ s2/ )/ 27/ ./ 对/ ns/ 进行/ Swap/ -/ 1/ (/ P/ )/ 变换/ ,/ 记/ 所得/ 为/ ns/ ;/ 28/ ./ if/ (/ ns/ 有效/ 且/ ns/ 不/ 在/ CH/ 中/ )/ 29/ ./ 将/ ns/ 加入/ CH/ ,/ 并用/ 算法/ 1/ 计算/ 其/ 时间/ 开销/ ;/ 30/ ./ j/ ++/ ;/ 31/ ./ if/ (/ j/ =/ =/ genSize/ )/ goto32/ ;/ 32/ ./ 将/ CH/ 按/ 各解/ 对应/ 时间/ 开销/ 的/ 升序/ 排序/ ;/ 33/ ./ 从/ CH/ 中/ 除去/ 后面/ genSize/ 个解/ ,/ curGen/ ++/ ;/ 34/ ./ 对/ CH/ 中/ 每个/ 解/ 进行/ Swap/ -/ 1/ (/ P/ )/ 变换/ ;/ 35/ ./ Return/ (/ CH/ )/ ;/ 算法/ 2/ 返回/ 的/ 结果/ 是/ 一组/ 跨/ 数据中心/ 数据传输/ 时间/ 开销/ 较优/ 的/ 数据/ 布局/ 方案/ 的/ 集合/ ,/ 该/ 集合/ 中/ 各/ 方案/ 按/ 其/ 所/ 对应/ 时间/ 开销/ 的/ 升序/ 排列/ ./ 算法/ 2/ 所得/ 即/ 为/ 本文/ 数据/ 布局/ 方案/ 求解/ 方法/ 第/ 1/ 阶段/ 的/ 结果/ ,/ 记为/ S/ (/ 1/ )/ ./ 4.2/ 数据/ 布局/ 求解/ 第/ 2/ 阶段/ 本文/ 数据/ 布局/ 方案/ 求解/ 方法/ 的/ 第/ 2/ 阶段/ ,/ 将/ 基于/ 数据/ 集/ 之间/ 的/ 依赖/ 关系/ 对/ S/ (/ 1/ )/ 中/ 的/ 各/ 方案/ 进行/ 评价/ 和/ 调整/ ./ 下面/ 给出/ 数据/ 集间/ 的/ 依赖度/ 与/ 数据/ 布局/ 方案/ 的/ 依赖/ 关系/ 破坏/ 度/ 的/ 定义/ ./ 定义/ 7/ ./ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ ,/ 对/ / di/ ∈/ DS/ ,/ 记/ Ti/ 为/ T/ 中/ 所有/ 以/ di/ 作为/ 输入/ 数据/ 集/ 的/ 任务/ 的/ 集合/ ;/ 对/ / di/ ,/ dj/ ∈/ DS/ ,/ 将/ di/ 和/ dj/ 之间/ 的/ 数据/ 依赖度/ 记为/ denp/ (/ i/ ,/ j/ )/ ,/ 则/ 对/ / i/ ≠/ j/ 有/ denp/ (/ i/ ,/ j/ )/ =/ |/ Ti/ ∩/ Tj/ |/ ×/ min/ {/ dsi/ ,/ dsj/ }/ ,/ di/ ,/ dj/ / DSfix/ 烄/ |/ Ti/ ∩/ Tj/ |/ ×/ dsi/ ,/ di/ / DSfix/ 且/ dj/ ∈/ DSfix/ 烅/ |/ Ti/ ∩/ Tj/ |/ ×/ dsj/ ,/ di/ ∈/ DSfix/ 且/ dj/ / DSfix0/ ,/ 烆/ 定义/ 8/ ./ s/ 是/ 面向/ 流程/ 的/ 数据/ 密集型/ 应用/ P/ =/ 〈/ T/ ,/ C/ ,/ DS/ 〉/ 的/ 一个/ 数据/ 布局/ 方案/ ,/ s/ 的/ 数据/ 依赖/ 破坏/ 度记/ 为/ denp/ _/ damage/ (/ s/ )/ ,/ 则/ 有/ denp/ _/ damage/ (/ s/ )/ =/ ∑/ / di/ ,/ dj/ ∈/ DS/ 其中/ dist/ (/ i/ ,/ j/ )/ =/ 0/ ,/ 若/ s/ (/ i/ )/ =/ s/ (/ j/ )/ 骤/ 如下/ :/ 本文/ 数据/ 布局/ 方案/ 求解/ 方法/ 第/ 2/ 阶段/ 的/ 具体/ 步/ (/ 1/ )/ 记/ S/ (/ 1/ )/ 中/ 各/ 数据/ 布局/ 方案/ 的/ 全局/ 数据传输/ 时间/ 开销/ 最小值/ 为/ timeCostmin/ ,/ 在/ S/ (/ 1/ )/ 中/ 选择/ 所有/ 数据传输/ 时间/ 开销/ 值/ 小于/ timeCostmin/ ×/ (/ 1/ +/ λ/ d/ )/ 的/ 方案/ ,/ 记/ 这些/ 方案/ 组成/ 的/ 集合/ 为/ S/ / (/ 1/ )/ ./ 这里/ 的/ λ/ d/ 是/ 一个/ 百分比/ 参数/ ,/ 可/ 根据/ 具体/ 需求/ 调整/ ,/ 本文/ 实验/ 中取/ λ/ d/ =/ 0.5/ %/ ./ (/ 2/ )/ 使用/ 式/ (/ 6/ )/ 与/ 式/ (/ 7/ )/ 计算/ S/ / (/ 1/ )/ 中/ 的/ 每个/ 方案/ 的/ 数据/ 依赖/ 破坏/ 度值/ ,/ 并/ 按/ 其/ 升序/ 对/ S/ / (/ 1/ )/ 中/ 所有/ 数据/ 布局/ 方案/ 进行/ 排序/ ,/ 所得/ 结果/ 即/ 为/ 本文/ 数据/ 布局/ 方案/ 求解/ 方法/ 第/ 2/ 阶段/ 的/ 结果/ ,/ 记为/ S/ (/ 2/ )/ ./ 4.3/ 数据/ 布局/ 求解/ 第/ 3/ 阶段/ 在/ 本文/ 数据/ 布局/ 方案/ 求解/ 方法/ 的/ 第/ 3/ 阶段/ ,/ 将/ 分别/ 计算/ S/ (/ 2/ )/ 中/ 各/ 方案/ 的/ 负载/ 均衡/ 性能/ ,/ 并/ 依此/ 对/ 各/ 布局/ 方案/ 进行/ 评价/ 和/ 筛选/ ./ (/ 1/ )/ 记/ S/ (/ 2/ )/ 中/ 各/ 数据/ 布局/ 方案/ 数据/ 依赖/ 破坏/ 度/ 最小值/ 为/ damagemin/ ,/ 在/ S/ (/ 2/ )/ 中/ 选择/ 所有/ 数据/ 依赖/ 破坏/ 度值/ 小于/ damagemin/ ×/ (/ 1/ +/ λ/ l/ )/ 的/ 方案/ ,/ 记/ 这些/ 方案/ 所/ 组成/ 的/ 集合/ 为/ S/ / (/ 2/ )/ ./ 这里/ 的/ λ/ l/ 是/ 一个/ 百分比/ 参数/ ,/ 可/ 根据/ 具体/ 需求/ 调整/ ,/ 本文/ 实验/ 中取/ λ/ l/ =/ 1/ %/ ./ (/ 2/ )/ 对/ S/ / (/ 2/ )/ 中/ 的/ 每个/ 方案/ ,/ 分别/ 计算/ 其所/ 对应/ 的/ 各/ 数据中心/ 使用率/ 的/ 标准差/ ,/ 其中/ 标准差/ 最小/ 的/ 方案/ 即/ 为/ 本文/ 数据/ 布局/ 方案/ 求解/ 的/ 最终/ 结果/ ./ 5/ 仿真/ 实验/ 5.1/ 实验/ 设置/ 与/ 环境/ 本节/ 将/ 对/ 本文/ 提出/ 的/ 三/ 阶段/ 数据/ 布局/ 策略/ (/ 下文/ 简称/ 本文/ 策略/ )/ 与/ 文献/ [/ 14/ ]/ 提出/ 的/ 聚类/ 数据/ 布局/ 策略/ (/ 下文/ 简称/ 聚类/ 策略/ )/ 进行/ 对比/ 实验/ ./ 对/ 每个/ 随机/ 生成/ 的/ 测试/ 流程/ ,/ 分别/ 使用/ 本文/ 策略/ 与/ 聚类/ 策略/ 求得/ 各自/ 的/ 数据/ 布局/ 方案/ ,/ 然后/ 基于/ 两个/ 方案/ 对/ 流程/ 进行/ 仿真/ 执行/ ,/ 并/ 记录/ 该/ 过程/ 中/ 的/ 跨/ 数据中心/ 数据传输/ 次数/ 和/ 时间/ 开销/ ./ 5.2/ 节图/ 中/ 所/ 标注/ 的/ 数据/ ,/ 均/ 为/ 运行/ 1000/ 个/ 参数/ 相同/ 的/ 随机/ 生成/ 测试/ 流程/ 所得/ 结果/ 的/ 平均值/ ;/ 图/ 3/ 与/ 图/ 5/ 中所/ 标注/ 的/ 时间/ 开销/ 单位/ 为/ 模拟/ 时间/ 单位/ ./ 实验/ 环境/ 为/ Inter/ (/ R/ )/ Core/ (/ TM/ )/ 2Duo2/ ./ 93GHz/ ,/ RAM3GB/ ,/ 硬盘/ 320GB/ ,/ 100MB/ 网络带宽/ ./ 5.2/ 实验/ 结果/ 和/ 分析/ 如图/ 3/ 所示/ ,/ 随着/ 输入/ 数据/ 集/ 个数/ 的/ 增加/ ,/ 两种/ 数据/ 布局/ 策略/ 所/ 对应/ 的/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ 都/ 呈/ 明显/ 上升/ 趋势/ ;/ 本文/ 策略/ 对应/ 的/ 时间/ 开销/ 明显/ 低于/ 聚类/ 策略/ ,/ 且/ 增速/ 较缓/ ./ Page8/ 如图/ 4/ 所示/ ,/ 随着/ 输入/ 数据/ 集/ 个数/ 的/ 增加/ ,/ 两种/ 数据/ 布局/ 策略/ 所/ 对应/ 的/ 跨/ 数据中心/ 数据传输/ 次数/ 都/ 呈/ 明显/ 上升/ 趋势/ ;/ 与/ 聚类/ 策略/ 相比/ ,/ 本文/ 策略/ 所/ 对应/ 的/ 数据传输/ 次数/ 略/ 多/ ,/ 但/ 二者/ 差别/ 非常/ 小/ ./ 如图/ 5/ 所示/ ,/ 随着/ 数据中心/ 个数/ 的/ 增加/ ,/ 两种/ 数据/ 布局/ 策略/ 所/ 对应/ 的/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ 都/ 呈/ 缓慢/ 上升/ 趋势/ ;/ 本文/ 策略/ 对应/ 的/ 时间/ 开销/ 明显/ 低于/ 聚类/ 策略/ ./ 如图/ 6/ 所示/ ,/ 随着/ 数据中心/ 个数/ 的/ 增加/ ,/ 两种/ 数据/ 布局/ 策略/ 所/ 对应/ 的/ 跨/ 数据中心/ 数据传输/ 次数/ 都/ 呈上升/ 趋势/ ;/ 与/ 聚类/ 策略/ 相比/ ,/ 本文/ 策略/ 所/ 对应/ 的/ 数据传输/ 次数/ 略/ 多/ ,/ 但/ 二者/ 差别/ 非常/ 小/ ./ 综上所述/ ,/ 对于/ 流程/ 应用/ 执行/ 过程/ 中/ 跨/ 数据中心/ 数据传输/ 的/ 次数/ ,/ 特别/ 是/ 在/ 数据/ 集数/ 较/ 多/ 以及/ 数据中心/ 数较/ 多/ 的/ 情况/ 下/ ,/ 聚类/ 策略/ 所/ 对应/ 的/ 传输/ 次数/ 较/ 本文/ 策略/ 略少/ ,/ 但/ 二者/ 差距/ 较/ 小/ ;/ 而/ 对于/ 流程/ 应用/ 执行/ 过程/ 中/ 跨/ 数据中心/ 数据传输/ 所/ 导致/ 的/ 时间/ 开销/ ,/ 本文/ 策略/ 明显/ 优于/ 聚类/ 策略/ ,/ 且/ 随着/ 数据/ 集/ 数量/ 的/ 增加/ ,/ 本文/ 策略/ 的/ 优势/ 有/ 逐渐/ 扩大/ 的/ 趋势/ ./ 6/ 结论/ 与/ 未来/ 工作/ 本文/ 首先/ 指出/ ,/ 当前/ 云/ 计算环境/ 下面/ 向/ 流程/ 的/ 数据/ 密集型/ 应用/ 在/ 数据/ 布局/ 管理/ 方面/ 所/ 遇到/ 的/ 挑战/ ,/ 特别/ 是/ 跨/ 数据中心/ 数据传输/ 所/ 造成/ 的/ 不可/ 忽视/ 的/ 时间/ 开销/ ;/ 然后/ 通过/ 对/ 该/ 问题/ 进行/ 分析/ 、/ 建模/ ,/ 并/ 在/ 充分考虑/ 数据/ 移动/ 次数/ 、/ 数据/ 集/ 大小/ 以及/ 网络带宽/ 等/ 因素/ 的/ 基础/ 上/ 提出/ 了/ 兼顾/ 时间/ 开销/ 、/ 数据/ 依赖性/ 和/ 负载/ 均衡/ 三/ 方面/ 指标/ 的/ 数据/ 布局/ 策略/ 与/ 方法/ ;/ 之后/ ,/ 通过/ 与/ 其它/ 数据/ 布局/ 策略/ 的/ 对比/ 实验/ ,/ 说明/ 本文/ 的/ 数据/ 布局/ 策略/ 具有/ 较/ 好/ 的/ 性能/ ,/ 尤其/ 是/ 在/ 降低/ 跨/ 数据中心/ 数据传输/ 导致/ 的/ 时间/ 开销/ 方面/ ,/ 本文/ 策略/ 的/ 优势/ 十分/ 明显/ ./ 未来/ 我们/ 计划/ 在/ 以下/ 方面/ 进行/ 进一步/ 的/ 研究/ :/ 首先/ ,/ 计划/ 对/ 本文/ 数据/ 布局/ 方案/ 求解/ 过程/ 第/ 1/ 阶段/ 中/ 初始/ 布局/ 方案/ 生成/ 的/ 环节/ 进行/ 优化/ ,/ 即/ 基于/ 一定/ 的/ 约束条件/ 生成/ 较优/ 的/ 初始/ 方案/ ,/ 以/ 提高/ 求解/ 效率/ ./ 此外/ ,/ 本文/ 目前/ 主要/ 针对/ 云/ 环境/ 下/ 单个/ 流程/ 应用/ 的/ 数据/ 布局/ 问题/ 进行/ 研究/ ,/ 未来/ 计划/ 研究/ 云/ 计算环境/ 下/ 多个/ 数据/ 密集型/ 流程/ 应用/ 的/ 数据/ 布局/ 管理策略/ ./ Page9/ 

