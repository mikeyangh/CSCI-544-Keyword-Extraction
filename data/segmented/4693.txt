Page1/ 面向/ 内部/ 威胁/ 检测/ 的/ 用户/ 跨域/ 行为/ 模式/ 挖掘/ 文雨/ 王伟平/ 孟丹/ (/ 中国科学院/ 信息工程/ 研究所/ 北京/ 100093/ )/ 摘要/ 内部/ 用户/ 行为/ 分析/ 是/ 系统安全/ 领域/ 中/ 一个/ 重要/ 的/ 研究/ 问题/ ./ 近期/ 的/ 工作/ 主要/ 集中/ 在/ 用户/ 单域/ 行为/ 的/ 单一/ 模式分析/ 技术/ ,/ 同时/ 依赖于/ 领域/ 知识/ 和/ 用户/ 背景/ ,/ 不适/ 用于/ 多/ 检测/ 域/ 场景/ ./ 文中/ 提出/ 一种/ 新/ 的/ 用户/ 跨域/ 行为/ 模式分析/ 方法/ ./ 该/ 方法/ 能够/ 分析/ 用户/ 行为/ 的/ 多元/ 模式/ ./ 此外/ ,/ 该/ 方法/ 是/ 完全/ 数据/ 驱动/ 的/ 方法/ ,/ 不/ 需要/ 依赖/ 相关/ 领域/ 知识/ 和/ 用户/ 背景/ 属性/ ./ 最后/ 作者/ 基于/ 文中/ 的/ 用户/ 行为/ 模式分析/ 方法/ 设计/ 了/ 一种/ 面向/ 内部/ 攻击/ 的/ 检测/ 方法/ ./ 在/ 实验/ 中/ ,/ 作者/ 使用/ 文中/ 方法/ 分析/ 了/ 真实/ 场景/ 中/ 的/ 5/ 种/ 用户/ 审计/ 日志/ ,/ 实验/ 结果/ 验证/ 了/ 文中/ 分析方法/ 在/ 多/ 检测/ 域/ 场景/ 中/ 分析/ 用户/ 行为/ 多元/ 模式/ 的/ 有效性/ ,/ 同时/ 文中/ 检测/ 方法/ 优于/ 两种/ 已有/ 方法/ :/ 单域/ 检测/ 方法/ 和/ 基于/ 单一/ 行为/ 模式/ 的/ 检测/ 方法/ ./ 关键词/ 内部/ 威胁/ ;/ 多/ 检测/ 域/ ;/ 用户/ 跨域/ 行为/ 分析/ ;/ 非负/ 矩阵/ 分解/ ;/ 高斯/ 混合/ 模型/ ;/ 机器/ 学习/ 1/ 引言/ 内部/ 用户/ 行为/ 分析/ 是/ 系统安全/ 领域/ 中/ 一个/ 重要/ Page2/ 者/ 公共服务/ 的/ 使用者/ ,/ 如/ 数字/ 图书馆/ 的/ 用户/ 等/ ./ 而/ 用户/ 或/ 用户/ 进程/ 在/ 计算机系统/ 中/ 的/ 各种/ 活动/ 记录/ (/ 又/ 称为/ 用户/ 审计/ 日志/ )/ 是/ 分析/ 用户/ 行为/ 的/ 重要依据/ ,/ 如/ 用户/ 的/ 命令/ 执行/ 记录/ [/ 2/ ]/ 、/ 文件/ 搜索/ 记录/ [/ 3/ ]/ 、/ 数据库/ 访问/ 记录/ [/ 1/ ,/ 4/ ]/ 、/ 鼠标/ 操作/ [/ 5/ ]/ 等/ ./ 本文/ 将/ 各种/ 用于/ 用户/ 行为/ 检测/ 的/ 审计/ 日志/ 产生/ 环境/ 统一/ 称为/ 检测/ “/ 域/ ”/ ,/ 如/ 用户/ 命令/ 域/ 、/ 数据库/ 域/ 、/ 文件系统/ 域/ 等/ ./ 此外/ ,/ 随着/ 各界/ 对/ 计算机系统/ 可/ 问责性/ 的/ 重视/ [/ 6/ -/ 7/ ]/ ,/ 系统/ 中/ 检测/ 域/ 的/ 种类/ 呈现出/ 越来越/ 多样化/ 的/ 趋势/ ./ 已有/ 许多/ 工作/ 提出/ 面向/ 内部/ 威胁/ 检测/ 的/ 用户/ 行为/ 分析方法/ ,/ 如/ 文献/ [/ 2/ ,/ 4/ -/ 5/ ,/ 8/ ]/ ./ 这些/ 方法/ 通常/ 使用/ 审计/ 日志/ 来/ 分析/ 用户/ 在/ 某个/ 检测/ 域/ 的/ 域/ 内/ 行为/ 模式/ ,/ 然后/ 基于/ 这些/ 被/ 识别/ 的/ 用户/ 行为/ 模式/ 检测/ 用户/ 的/ 异常/ 行为/ ./ 因此/ 这些/ 工作/ 主要/ 关注/ 用户/ 单域/ 行为/ 分析/ ./ 对于/ 有/ 技巧/ 的/ 攻击者/ ,/ 他们/ 能够/ 将/ 攻击行为/ 巧妙/ 的/ 分解/ 为/ 多个/ 步骤/ ,/ 而且/ 每步/ 都/ 被/ 伪装成/ 正常/ 行为/ [/ 9/ ]/ ./ 这类/ 攻击/ 通常/ 被/ 称为/ 复合/ 攻击/ (/ Multi/ -/ stepAttack/ )/ ./ 因此/ 当/ 恶意/ 用户/ 的/ 攻击行为/ 在/ 不同/ 检测/ 域/ 被/ 独立/ 分析/ 时/ ,/ 极大/ 可能/ 被/ 分别/ 识别/ 为/ 无害/ 的/ 正常/ 行为/ ./ 例如/ ,/ 某个/ 用户/ 作为/ 系统/ 开发人员/ ,/ 需要/ 每天/ 登录/ 一台/ 计算机/ 编写/ 多个/ 源代码/ 文件/ ./ 同时/ 他/ 还/ 作为/ 系统管理员/ ,/ 需要/ 每天/ 登录/ 多台计算机/ 进行/ 系统文件/ 查看/ 和/ 配置/ ./ 因此/ 对于/ 系统/ 登录/ 域/ ,/ 该/ 用户/ 每天/ 登录/ 一台/ 还是/ 多台计算机/ 都/ 不算/ 异常/ 行为/ ;/ 而/ 对于/ 文件系统/ 域/ ,/ 该/ 用户/ 读写/ 源代码/ 或/ 系统文件/ 也/ 不算/ 异常/ 行为/ ./ 因此/ ,/ 当该/ 用户/ 每天/ 登录/ 多台计算机/ 并/ 隐蔽/ 的/ 收集/ 敏感数据/ 时/ ,/ 各域/ 独立/ 检测/ 将/ 不易/ 发现/ 其/ 异常/ 行为/ ./ 因此/ ,/ 检测/ 系统/ 需要/ 具有/ 集成/ 不同/ 检测/ 域/ 和/ 分析/ 用户/ 跨域/ 行为/ 的/ 能力/ ./ 然而/ ,/ 在/ 复合/ 攻击/ 研究/ 方面/ ,/ 大部分/ 工作/ 主要/ 集中/ 在/ 基于/ 主机/ 和/ 网络安全/ 缺陷/ 分析/ 进行/ 复合/ 攻击/ 路径/ 计算/ [/ 10/ -/ 11/ ]/ ,/ 没有/ 考虑/ 用户/ 行为/ 分析/ 和/ 检测/ ./ 最近/ ,/ 相关/ 研究/ 人员/ 发现/ 复合/ 攻击/ 具有/ 一定/ 的/ 动态性/ ,/ 如/ 攻击者/ 可以/ 利用/ 窃取/ 的/ 信息/ 和/ 合法/ 权限/ 对/ 无/ 安全/ 缺陷/ 的/ 主机/ 和/ 网络/ 实施/ 进一步/ 的/ 攻击/ ./ 但是/ ,/ 这方面/ 工作/ 主要/ 侧重于/ 攻击/ 路径/ 的/ 动态性/ 分析/ ,/ 需要/ 与/ 用户/ 行为/ 检测/ 技术/ 结合/ 起来/ 实现/ 攻击/ 路径/ 推断/ ,/ 如/ Chen/ 等/ 人/ [/ 9/ ]/ 提出/ 的/ 基于/ 概率/ 攻击/ 图/ 的/ 内部/ 攻击/ 意图/ 推断/ 方法/ ./ 在/ 面向/ 多域/ 的/ 内部/ 攻击/ 检测/ 工作/ 方面/ ,/ Maloof/ 等/ 人/ [/ 12/ ]/ 提出/ 一种/ 通过/ 融合/ 用户/ 各/ 单域/ 行为/ 检测/ 结果/ 进行/ 内部/ 攻击/ 检测/ 的/ 方法/ ./ 实际上/ ,/ 该/ 工作/ 仍然/ 采用/ 用户/ 各/ 单域/ 行为/ 分析/ 的/ 方式/ ,/ 同样/ 没有/ 考虑/ 进行/ 用户/ 多域/ 行为/ 分析/ ./ 本文/ 关注/ 面向/ 内部/ 威胁/ 检测/ 的/ 用户/ 跨域/ 行为/ 模式分析/ 问题/ ./ 用户/ 跨域/ 行为/ 模式/ 包括/ 用户/ 域/ 内/ 行为/ 模式/ 以及/ 用户/ 各域域/ 间/ 行为/ 的/ 关联/ 模式/ ./ 用户/ 跨域/ 行为/ 模式分析/ 通过/ 用户/ 多域/ 行为/ 联合/ 分析/ 实现/ ./ 用户/ 跨域/ 行为/ 模式/ 可/ 用于/ 识别/ 和/ 发现/ 单域/ 场景/ 不能/ 发现/ 的/ 用户/ 异常/ 行为/ ./ 用户/ 的/ 行为/ 模式/ 通常/ 由/ 自身/ 个性/ 和/ 习惯/ 、/ 所任/ 职位/ 、/ 承担/ 角色/ 、/ 所在/ 部门/ 、/ 所/ 从事/ 的/ 项目/ 等/ 众多/ 因素/ 所/ 决定/ ./ 同时/ ,/ 对于/ 每个/ 检测/ 域/ ,/ 主导/ 用户/ 行为/ 差异/ 的/ 主要/ 因素/ 可能/ 不尽相同/ ./ 例如/ ,/ 有些/ 域/ 可能/ 由/ 用户/ 个性化/ 特点/ 或/ 习惯/ 所/ 决定/ ,/ 因此/ 不同/ 用户/ 具有/ 不同/ 的/ 行为/ 模式/ ;/ 而/ 有些/ 域/ 可能/ 由/ 用户/ 工作/ 职责/ 所/ 决定/ ,/ 相同/ 工作/ 角色/ 的/ 人/ 通常/ 具有/ 相同/ 的/ 行为/ 模式/ ./ 因此/ ,/ 用户/ 跨域/ 行为/ 模式/ 不会/ 由/ 单一/ 的/ 系统/ 条件/ 或/ 用户/ 背景/ 属性/ 所/ 决定/ ./ 此外/ ,/ 由于/ 职位/ 变动/ 、/ 角色/ 变更/ 、/ 部门/ 调动/ 、/ 项目/ 变化/ 等/ 原因/ ,/ 用户/ 行为/ 模式/ 也/ 可能/ 发生/ 必要/ 的/ 演变/ ./ 因此/ ,/ 用户/ 跨域/ 行为/ 模式/ 应该/ 是/ 多元/ 的/ ./ 然而/ ,/ 现有/ 方法/ 主要/ 面向用户/ 单域/ 行为/ 分析/ ,/ 通常/ 基于/ 领域/ 知识/ [/ 12/ ]/ 或/ 用户/ 背景/ 属性/ ,/ 如/ 用户/ 标示/ [/ 2/ ,/ 4/ -/ 5/ ,/ 8/ ]/ 或/ 用户/ 角色/ [/ 1/ ,/ 4/ ,/ 13/ ]/ 等/ ,/ 采用/ 数据分析/ 技术/ 构建/ 用户/ 单一/ 行为/ 模式/ ,/ 如/ 用户/ 分类/ 、/ 典型/ 行为/ 等/ ./ 显然/ 这些/ 方法/ 不适/ 用于/ 用户/ 多域/ 行为/ 联合/ 分析/ 的/ 应用/ 场景/ ./ 本文/ 提出/ 一种/ 新/ 的/ 用户/ 跨域/ 行为/ 模式分析/ 方法/ ./ 我们/ 首先/ 分别/ 为/ 各个/ 检测/ 域/ 构建/ 归一化/ 的/ 用户/ 单域/ 行为/ 描述/ ,/ 并/ 基于/ 时间/ 窗口/ 通过/ 集成/ 各域域/ 内/ 行为/ 特征/ 构建/ 用户/ 多域/ 行为/ 描述/ ./ 然后/ 通过/ 从/ 用户/ 多域/ 行为/ 描述/ 中/ 提取/ 基/ 模式/ ,/ 生成/ 用户/ 行为/ 特征/ ./ 基/ 模式/ 是/ 那些/ 未知/ 的/ 用户/ 行为/ 主导/ 因素/ 对/ 用户/ 各域/ 行为/ 影响/ 的/ 量化/ 形式/ ,/ 而/ 用户/ 行为/ 特征/ 则/ 量化/ 了/ 这些/ 未知/ 主导/ 因素/ 对/ 每个/ 用户/ 行为/ 的/ 影响/ ./ 最后/ ,/ 我们/ 使用/ 非/ 监督/ 学习/ 技术/ 挖掘/ 多元/ 的/ 用户/ 行为/ 模式/ ./ 在/ 应用/ 方面/ ,/ 我们/ 设计/ 一种/ 基于/ 用户/ 跨域/ 行为/ 模式分析/ 的/ 内部/ 攻击/ 检测/ 方法/ ./ 该/ 方法/ 通过/ 检测/ 用户/ 异常/ 行为/ 模式/ 以及/ 对/ 用户/ 正常/ 行为/ 模式/ 产生/ 负面影响/ 的/ 用户/ 异常/ 行为/ ,/ 来/ 发现/ 可能/ 的/ 内部/ 攻击行为/ ./ 本文/ 的/ 主要/ 贡献/ 有/ :/ (/ 1/ )/ 基于/ 多域/ 异质/ 审计/ 日志/ 融合/ 的/ 用户/ 多域/ 行为/ 描述/ 构建/ 方法/ ./ 我们/ 在/ 审计/ 日志/ 特征/ 层面/ ,/ 通过/ 用户/ 单域/ 行为/ 描述/ (/ 即/ 单域/ 日志/ 特征/ )/ 生成/ 和/ 集成/ ,/ 来/ 刻画/ 用户/ 多域/ 行为/ ./ (/ 2/ )/ 结构化/ 的/ 用户/ 行为/ 特征/ 生成/ 方法/ ./ 基/ 模式/ 使得/ 用户/ 行为/ 潜在/ 结构/ 变得/ 清晰/ ,/ 并/ 使/ 用户/ 行为/ 描述/ 得到/ 一定/ 程度/ 的/ 约简/ ,/ 因此/ 使得/ 用户/ 行为/ 特征/ 对/ 用户/ 行为/ 的/ 解释/ 变得/ 方便/ ./ 同时/ ,/ 结构化/ 的/ 生成/ 方式/ Page3/ 使得/ 用户/ 行为/ 特征/ 粒度/ 和/ 表达/ 倾向/ 可以/ 根据/ 分析/ 需要/ 通过观察/ 和/ 计算/ 进行/ 调整/ ./ (/ 3/ )/ 完全/ 基于/ 数据/ 驱动/ 的/ 用户/ 行为/ 多元/ 模式分析/ ./ 不/ 依赖/ 任何/ 领域/ 知识/ 和/ 用户/ 背景/ ,/ 完全/ 以/ 数据/ 驱动/ 的/ 方式/ 挖掘/ 多元/ 的/ 用户/ 行为/ 模式/ ./ (/ 4/ )/ 基于/ 本文/ 用户/ 行为/ 模式分析/ 的/ 内部/ 攻击/ 检测/ 方法/ ./ 该/ 方法/ 能够/ 利用/ 多元/ 的/ 用户/ 跨域/ 行为/ 模式/ 进行/ 内部/ 攻击/ 检测/ ./ 本文/ 第/ 2/ 节是/ 问题/ 描述/ ;/ 第/ 3/ 节/ 介绍/ 本文/ 方法/ 主要/ 思路/ 和/ 设计/ ;/ 第/ 4/ 节是/ 本文/ 方法/ 的/ 实验/ 部分/ ;/ 第/ 5/ 节是/ 本文/ 方法/ 在/ 内部/ 威胁/ 检测/ 方面/ 的/ 应用/ ;/ 第/ 6/ 节是/ 相关/ 工作/ 介绍/ ;/ 最后/ 是/ 本文/ 的/ 结论/ 部分/ ./ 2/ 问题/ 描述/ 本文/ 的/ 目标/ 是/ 提出/ 一种/ 面向/ 多/ 检测/ 域/ 场景/ 的/ 用户/ 跨域/ 行为/ 模式/ 挖掘/ 方法/ ./ 用户/ 跨域/ 行为/ 模式/ 包含/ 了/ 用户/ 域/ 内/ 行为/ 模式/ 以及/ 各域/ 内/ 行为/ 模式/ 之间/ 的/ 关联/ 模式/ ./ 本文/ 方法/ 应该/ 能够/ :/ 图/ 1/ 本文/ 的/ 用户/ 跨域/ 行为/ 模式/ 挖掘/ 过程/ 我们/ 首先/ 构建/ 用户/ 多域/ 行为/ 描述/ ./ 最/ 直观/ 的/ 构建/ 方法/ 是/ 先/ 将/ 各域/ 用户/ 审计/ 日志/ 进行/ 融合/ ,/ 然后/ 通过/ 数据/ 特征提取/ 生成/ 用户/ 多域/ 行为/ 描述/ ./ 然而/ ,/ 由于/ 各域/ 审计/ 日志/ 之间/ 的/ 异质性/ ,/ 直接/ 融合/ 多域/ 审计/ 日志/ 并/ 不/ 现实/ ./ 因此/ ,/ 我们/ 选择/ 在/ 审计/ 日志/ 的/ 特征/ 层面/ 构建/ 用户/ 多域/ 行为/ 描述/ ./ 首先/ 分别/ 从/ 各域/ 审计/ 日志/ 中/ 提取/ 归一化/ 的/ 用户/ 单域/ 行为/ 描述/ ,/ 然后/ 再/ 基于/ 一个/ 选定/ 的/ 时间/ 窗口/ 将/ 这些/ 单域/ 行为/ 进行/ 集成/ 来/ 构建/ 用户/ 多域/ 行为/ 描述/ ./ 如有/ 必要/ 这里/ 可以/ 通过/ 相关性/ 分析/ 进行/ 日志/ 特征/ 筛选/ ,/ 如/ Pearson/ 相关系数/ ./ 这方面/ 的/ 工作/ 较/ 多/ ,/ 本文/ 不/ 做/ 赘述/ ./ 然后/ ,/ 我们/ 设计/ 了/ 一种/ 结构化/ 的/ 用户/ 行为/ 特征/ 生成/ 方法/ ./ 该/ 方法/ 将/ 用户/ 多域/ 行为/ 描述/ 结构化/ 为/ 一组/ 基/ 模式/ 和/ 用户/ 行为/ 特征/ 两个/ 部分/ ./ 基/ 模式/ 是/ 一种/ 用户/ 行为/ 的/ 底层/ 抽象/ ,/ 也/ 是/ 刻画/ 用户/ 行为/ 的/ 基本/ 单元/ ./ 用户/ 行为/ 特征/ 则/ 刻画/ 了/ 用户/ 行为/ 关于/ 基/ 模式/ 的/ 线性/ 组成/ 结构/ ./ 实际上/ ,/ 每个/ 基/ 模式/ 可/ 看作/ 某种/ 未知/ 的/ 用户/ 行为/ 主导/ 因素/ 对/ 用户/ 各域/ 行为/ 影响/ 的/ 一种/ 量化/ 形式/ ,/ 而/ 用户/ 行为/ 特征/ 则/ 量化/ 了/ 这些/ 未知/ 主导/ 因素/ 对/ 用户/ 行为/ 的/ 影响/ ./ 由于/ 用户/ 多域/ 行为/ 描述/ 、/ 基/ 模式/ 和/ 用户/ 行为/ 特征/ 均/ 为/ 非负/ 向量/ ,/ 本文/ 使用/ 非/ 负矩/ (/ 1/ )/ 构建/ 用户/ 多域/ 行为/ 描述/ ./ 由于/ 各域/ 用户/ 审计/ 日志/ 相对/ 独立/ 的/ 产生/ ,/ 它们/ 通常/ 在/ 频率/ 、/ 数据/ 均匀/ 性/ 等/ 方面/ 具有/ 一定/ 差异/ ./ 因此/ ,/ 分析方法/ 应该/ 能够/ 融合/ 异质/ 的/ 多域/ 审计/ 日志/ ,/ 并/ 刻画/ 用户/ 多域/ 行为/ ./ (/ 2/ )/ 分析/ 用户/ 行为/ 多元/ 模式/ ./ 由于/ 用户/ 各域域/ 内/ 行为/ 受到/ 不同/ 因素/ 的/ 影响/ ,/ 用户/ 多域/ 行为/ 不会/ 由/ 个别/ 系统/ 条件/ 或/ 用户/ 属性/ 所/ 主导/ ./ 相对/ 于/ 单域/ 场景/ ,/ 用户/ 多域/ 行为/ 可能/ 具有/ 多种/ 行为/ 模式/ ./ 因此/ ,/ 分析方法/ 应该/ 能够/ 不/ 依赖/ 任何/ 已知/ 的/ 因素/ 或/ 领域/ 知识/ ,/ 挖掘/ 用户/ 行为/ 的/ 多元/ 模式/ ./ 3/ 用户/ 跨域/ 行为/ 模式分析/ 本/ 节/ 主要/ 介绍/ 本文/ 用户/ 跨域/ 行为/ 模式分析/ 方法/ 的/ 设计/ 思路/ ./ 3.1/ 方法/ 概述/ 本文/ 方法/ 包括/ 3/ 个/ 主要/ 步骤/ (/ 如图/ 1/ 所示/ )/ :/ (/ 1/ )/ 构建/ 用户/ 多域/ 行为/ 描述/ ;/ (/ 2/ )/ 生成/ 用户/ 行为/ 特征/ ;/ (/ 3/ )/ 分析/ 用户/ 行为/ 多元/ 模式/ ./ 阵/ 分解/ (/ 简称/ NMF/ )/ 方法/ 计算/ 基/ 模式/ 和/ 用户/ 行为/ 特征/ ./ 最后/ ,/ 我们/ 基于/ 非/ 监督/ 学习/ 技术/ 进行/ 用户/ 行为/ 多元/ 模式分析/ ./ 正常/ 情况/ 下/ ,/ 当/ 系统/ 中/ 用户/ 行为/ 主导/ 因素/ 稳定/ 时/ ,/ 用户/ 行为/ 也/ 相应/ 地/ 趋于稳定/ ./ 从/ 统计学/ 角度/ ,/ 我们/ 假设/ 用户/ 行为/ 特征/ 符合/ 多维/ 正态分布/ ,/ 并/ 在/ 实验/ 中/ 验证/ 了/ 该/ 假设/ ./ 此外/ ,/ 由于/ 存在/ 用户/ 行为/ 主导/ 因素/ 发生变化/ 而/ 带来/ 的/ 用户/ 行为/ 合理/ 变化/ 的/ 情况/ ,/ 用户/ 行为/ 特征/ 应该/ 符合/ 多个/ 正态分布/ ./ 因此/ ,/ 本文/ 使用/ 高斯/ 混/ 和/ 模型/ (/ 简称/ GMM/ )/ 分析/ 了/ 用户/ 行为/ 的/ 多元/ 模式/ ./ GMM/ 模型/ 能够/ 从/ 用户/ 行为/ 特征/ 中/ 构建/ 多个/ 高斯分布/ ,/ 其中/ 每个/ 高斯分布/ 可/ 作为/ 一种/ 用户/ 行为/ 模式/ ./ 3.2/ 构建/ 用户/ 多域/ 行为/ 描述/ 我们/ 首先/ 分别/ 为/ 各域/ 用户/ 审计/ 日志/ 提取/ 归一化/ 的/ 数据/ 特征/ ,/ 即/ 用户/ 单域/ 行为/ 描述/ ./ 用户/ 审计/ 日志/ 各项/ 属性/ 的/ 数据类型/ 通常/ 包括/ 标签/ 类型/ 、/ 数值/ 类型/ 和/ 文本/ 类型/ ./ 标签/ 类型/ 属性/ 记录/ 了/ 名称/ 、/ 事件/ 、/ 操作/ 等/ 信息/ ,/ 如/ 计算机/ 名/ 、/ 用户/ 登录/ 事件/ 、/ 用户/ 文件/ 写/ 操作/ 等/ ./ 这类/ 属性/ 的/ 取值/ 之间/ 没有/ 任何/ 顺序/ 、/ 大小/ 等/ 相关性/ ./ 对于/ 这/ 类/ 属性/ ,/ 我们/ 采用/ 二进制/ 向量/ 表示/ 它们/ 的/ Page4/ 特征值/ ./ 每个/ 可能/ 取值/ 对应/ 特征向量/ 的/ 一个/ 元素/ ,/ 当/ 日志/ 中该/ 属性/ 的/ 此值/ 出现/ 时/ ,/ 相应/ 的/ 向量/ 元素/ 为/ “/ 1/ ”/ ,/ 否则/ 为/ “/ 0/ ”/ ./ 例如/ ,/ 假设/ 用户/ 文件/ 操作/ 属性/ 包括/ 读/ 、/ 写/ 、/ 新建/ 、/ 拷贝/ 、/ 删除/ 5/ 种/ 操作/ ,/ 则/ 它/ 的/ 特征/ 可/ 表示/ 为/ “/ 10000/ ”/ (/ 读/ )/ 、/ “/ 01000/ ”/ (/ 写/ )/ 、/ “/ 00100/ ”/ (/ 新建/ )/ 、/ “/ 00010/ ”/ (/ 拷贝/ )/ 、/ “/ 00001/ ”/ (/ 删除/ )/ 5/ 种/ 向量/ ./ 用户/ 审计/ 日志/ 中/ 的/ 绝大多数/ 属性/ 属于/ 标签/ 类/ 数据类型/ ./ 数值/ 类型/ 的/ 属性/ 由/ 实数/ 表示/ ,/ 如/ 资源/ 使用率/ 、/ 网络流量/ 等/ ./ 显然/ 这种/ 数值/ 型/ 属性/ 的/ 取值/ 与/ 标签/ 型/ 属性/ 的/ 二进制/ 特征值/ 在/ 尺度/ 上/ 可能/ 有/ 很大/ 差异/ ./ 为了/ 避免/ 这种/ 差异/ 和/ 统一/ 特征/ 形式/ ,/ 对于/ 数值/ 类型/ ,/ 我们/ 依然/ 采用/ 二进制/ 特征向量/ 的/ 表示/ 方法/ ./ 我们/ 将/ 数值/ 型/ 属性/ 的/ 取值/ 范围/ 划分/ 成/ 若干个/ 长度/ 相等/ 的/ 分段/ ,/ 每个/ 分段/ 对应/ 特征向量/ 的/ 一个/ 元素/ ./ 当/ 属性/ 取值/ 落入/ 某个/ 分段/ 时/ ,/ 则/ 相应/ 的/ 向量/ 元素/ 为/ “/ 1/ ”/ ,/ 而/ 其他/ 元素/ 为/ “/ 0/ ”/ ./ 例如/ 某个/ 属性/ 的/ 取值/ 区间/ 为/ [/ 0.0/ ,/ 10.0/ )/ ,/ 我们/ 可/ 将/ 其/ 分为/ 5/ 个/ 等/ 长/ 分段/ ,/ 当/ 属性/ 取值/ 为/ “/ 6.5/ ”/ 时/ ,/ 落入/ 第/ 4/ 分段/ ,/ 则/ 属性/ 特征/ 表示/ 为/ “/ 00010/ ”/ ./ 文本/ 类型/ 如/ 邮件/ 和/ 文件/ 内容/ ,/ 主要/ 由/ 词串/ 组成/ ./ 在/ 某些/ 场景/ 中/ ,/ 由于/ 有/ 保护/ 用户/ 隐私/ 和/ 防止/ 敏感/ 信息/ 泄露/ 的/ 要求/ ,/ 这些/ 内容/ 不宜/ 被/ 用于/ 分析/ ,/ 因此/ 本文/ 对/ 文本/ 类型/ 不/ 作/ 考虑/ ./ 在/ 得到/ 用户/ 的/ 单域/ 行为/ 特征/ 后/ ,/ 我们/ 基于/ 一个/ 时间/ 窗口/ ,/ 统计/ 合并/ 同一时间/ 窗口/ 的/ 用户/ 所有/ 单域/ 行为/ 描述/ ,/ 构建/ 成/ 用户/ 多域/ 行为/ 描述/ ./ 本文/ 选择/ 以天/ 为/ 单位/ 的/ 时间/ 窗口/ ./ 这里/ 可以/ 根据/ 研究/ 需要/ 选择/ 不同/ 时间/ 粒度/ 的/ 时间/ 窗口/ ,/ 如/ 以/ 小时/ 、/ 周等/ 为/ 时间/ 单位/ ./ 3.3/ 用户/ 行为/ 特征/ 生成/ 这里/ 需要/ 首先/ 介绍/ 基/ 模式/ 的/ 概念/ ./ 基/ 模式/ 是/ 一种/ 用户/ 行为/ 的/ 底层/ 抽象/ ,/ 也/ 是/ 刻画/ 用户/ 行为/ 的/ 基本/ 构成/ 单元/ ./ 每个/ 基/ 模式/ 可/ 看作/ 某种/ 未知/ 的/ 用户/ 行为/ 主导/ 因素/ 对/ 用户/ 各域/ 行为/ 影响/ 的/ 一种/ 量化/ 形式/ ./ 而/ 用户/ 行为/ 特征/ 则/ 刻画/ 了/ 用户/ 行为/ 关于/ 基/ 模式/ 的/ 线性/ 组成/ 结构/ ,/ 它/ 量化/ 了/ 基/ 模式/ 代表/ 的/ 未知/ 主导/ 因素/ 对/ 用户/ 行为/ 的/ 影响/ ./ 我们/ 假设/ 用户/ 行为/ 有/ k/ 种基/ 模式/ ,/ 则/ 用户/ 多域/ 行为/ 关于/ 基/ 模式/ 线性组合/ 可写/ 为/ ua/ (/ i/ )/ =/ wa/ ,/ 0/ (/ i/ )/ 犺/ 0/ +/ wa/ ,/ 1/ (/ i/ )/ 犺/ 1/ +/ …/ +/ wa/ ,/ k/ (/ i/ )/ 犺/ k/ (/ 1/ )/ 其中/ ua/ (/ i/ )/ 表示/ 用户/ a/ 的/ 第/ i/ 个/ 时间/ 窗口/ 的/ 行为/ 描述/ ./ 犺/ j/ 是/ 第/ j/ 个基/ 模式/ 向量/ ./ wa/ ,/ j/ (/ i/ )/ 表示/ 相应/ 基/ 模式/ 犺/ j/ 的/ 系数/ (/ 权重/ )/ ./ 相应/ 的/ ,/ 用户/ a/ 的/ 第/ i/ 个/ 时间/ 窗口/ 的/ 行为/ 特征/ 可/ 表示/ 为/ 犳/ a/ (/ i/ )/ =/ (/ wa/ ,/ 0/ (/ i/ )/ ,/ wa/ ,/ 1/ (/ i/ )/ ,/ …/ ,/ wa/ ,/ k/ (/ i/ )/ )/ ./ 这里/ 犳/ a/ (/ i/ )/ 表示/ 用户/ a/ 在/ 第/ i/ 个/ 时间/ 窗口/ 的/ 行为/ 特征/ ./ 需要/ 说明/ 的/ 是/ ,/ 基/ 模式/ 数量/ k/ 的/ 选取/ 对/ 用户/ 行为/ 分析/ 具有/ 一定/ 的/ 影响/ ./ k/ 值较/ 小时/ ,/ 基/ 模式/ 数量/ 相对/ 较/ 少/ ,/ 意味着/ 考虑/ 的/ 用户/ 行为/ 主导/ 因素/ 较少/ ./ 因此/ 用户/ 行为/ 特征/ 对/ 用户/ 行为/ 的/ 描述/ 更/ 宏观/ ,/ 利于/ 不同/ 用户/ 之间/ 的/ 行为/ 差异/ 比较/ ./ 而/ k/ 值/ 较大/ 时/ ,/ 基/ 模式/ 数量/ 相对/ 较/ 多/ ,/ 意味着/ 考虑/ 的/ 用户/ 行为/ 主导/ 因素/ 较/ 多/ ./ 而/ 此时/ 用户/ 行为/ 特征/ 对/ 用户/ 行为/ 的/ 描述/ 更/ 细致/ ,/ 利于/ 用户/ 行为/ 个体/ 变化/ 的/ 分析/ ./ 基/ 模式/ 规模/ 可/ 通过/ 基/ 模式/ 的/ 相关性/ 分析/ 来/ 确定/ ,/ 如/ Pearson/ 相关系数/ ./ 我们/ 首先/ 设定/ 一个/ 相关性/ 阈值/ ./ 如果/ 系统/ 倾向/ 于/ 分析/ 不同/ 用户/ 的/ 行为/ 差异/ ,/ 则/ 基/ 模式/ 相关系数/ 应/ 小于/ 该/ 阈值/ ./ 如果/ 系统/ 倾向/ 于/ 分析/ 用户/ 个体/ 行为/ 的/ 变化/ ,/ 则/ 基/ 模式/ 相关系数/ 应/ 大于/ 该/ 阈值/ ./ 因此/ 我们/ 的/ 方法/ 可/ 根据/ 具体分析/ 需要/ ,/ 通过观察/ 和/ 计算/ 来/ 确定/ 基/ 模式/ 数量/ ,/ 并/ 生成/ 不同/ 粒度/ 和/ 不同/ 表达/ 倾向/ 的/ 用户/ 行为/ 特征/ ./ 接下来/ 我们/ 根据/ 已知/ 的/ 用户/ 多域/ 行为/ ,/ 求解/ 基/ 模式/ 犺/ 0/ ,/ 犺/ 1/ ,/ …/ ,/ 犺/ k/ 以及/ 用户/ a/ 的/ 行为/ 特征/ 犳/ a/ ./ 首先/ 我们/ 构建/ 所有/ 用户/ 的/ 多域/ 行为/ 模型/ 为/ 其中/ 犝/ n/ ×/ m/ 是/ 所有/ 用户/ 的/ 多域/ 行为/ 描述/ 矩阵/ ,/ 每行/ 代表/ 一个/ 用户/ 多域/ 行为/ 描述/ 向量/ ,/ n/ 是/ 用户/ 行为/ 特征向量/ 集/ 的/ 规模/ ,/ m/ 是/ 用户/ 多域/ 行为/ 描述/ 长度/ ./ 犠/ n/ ×/ k/ 是/ 包含/ 所有/ 用户/ 的/ 用户/ 行为/ 特征/ 矩阵/ ,/ 每行/ 代表/ 一个/ 用户/ 在/ 某个/ 时间/ 窗口/ 的/ 行为/ 特征/ ,/ k/ 表示/ 基/ 模式/ 集合/ 的/ 规模/ ./ 犎/ k/ ×/ m/ 则/ 是/ 基/ 模式/ 矩阵/ ,/ 每行/ 代表/ 一个/ 基/ 模式/ 向量/ ./ 基/ 模式/ 计算/ 可/ 通过/ 求解/ 优化/ 问题/ 实现/ ./ 当/ 给定/ 基/ 模式/ 规模/ k/ ,/ 计算/ 可/ 被/ 表示/ 为/ 如下/ 优化/ 问题/ :/ 这里/ ‖/ ·/ ‖/ 表示/ Frobenius/ -/ 范数/ ./ 该/ 目标/ 函数/ 意义/ 是/ 求解/ 最优/ 的/ 用户/ 行为/ 特征/ 矩阵/ 犠/ 和/ 基/ 模式/ 矩阵/ 犎/ ,/ 它们/ 的/ 乘积/ 与/ 用户/ 行为矩阵/ 犉/ 的/ 绝对误差/ 最小/ ./ 因为/ 矩阵/ 犞/ 是非/ 负/ 的/ ,/ 而且/ 对于/ 用户/ 行为/ 来说/ ,/ 纯加性/ (/ 非/ 负性/ )/ 的/ 矩阵/ 犠/ 和/ 矩阵/ 犎/ 才/ 有/ 意义/ ,/ 则/ 以上/ 优化/ 问题/ 的/ 求解/ 实际上/ 是/ 经典/ 的/ 非负/ 矩阵/ 分解/ 问题/ ./ 非负/ 矩阵/ 分解/ (/ 简称/ NMF/ )/ [/ 14/ ]/ 是/ 一种/ 十分/ 有效/ 的/ 数据处理/ 方法/ ,/ 被/ 广泛应用/ 于/ 文本/ 挖掘/ 、/ 图像/ 分析/ 、/ 推荐/ 系统/ 等/ 领域/ ./ 该/ 方法/ 将/ 一个/ 非负/ 矩阵/ 犝/ n/ ×/ m/ 分解/ 为/ 两个/ 低阶/ 的/ 非负/ 矩阵/ 犠/ n/ ×/ k/ 和/ 犎/ k/ ×/ m/ 的/ 乘积/ ,/ Page5/ 其中/ 阶数/ k/ 的/ 选值/ 远/ 小于/ m/ 和/ n/ 的/ 最小值/ ./ 虽然/ 对于/ 带有/ 约束条件/ 犠/ ,/ 犎/ / 0/ 的/ 式/ (/ 3/ )/ ,/ 同时/ 求解/ 矩阵/ 犠/ 和/ 矩阵/ 犎/ 是/ 一个/ 非凸/ 问题/ ,/ 但是/ 通过/ 分别/ 求解/ 矩阵/ 犠/ (/ 设/ 犎/ 固定/ )/ 和/ 矩阵/ 犎/ (/ 设/ 犠/ 固定/ )/ ,/ 可/ 将/ 该/ 问题/ 转化/ 为/ 凸/ 问题/ ./ 本文/ 采用/ 交替/ 最小/ 二/ 乘法/ (/ 简称/ ALS/ )/ [/ 15/ ]/ 计算/ 上面/ 的/ 基/ 模式/ 矩阵/ 和/ 用户/ 行为/ 特征/ 矩阵/ ./ ALS/ 方法/ 具有/ 简单/ 和/ 实用/ 的/ 优点/ ./ 我们/ 首先/ 使用/ 文献/ [/ 16/ ]/ 提出/ 的/ 方法/ 初始化/ 基/ 模式/ 矩阵/ 犠/ ./ 该/ 初始化/ 方法/ 通过/ k/ 次/ 随机/ 选取/ 矩阵/ 犞/ 的/ 若干列/ 向量/ 并/ 计算/ 它们/ 的/ 均值/ ,/ 来/ 初始化/ 矩阵/ 犠/ ./ 假设/ 犠/ 不变/ ,/ 使用/ 式/ (/ 4/ )/ 求解/ 矩阵/ 犎/ ,/ 然后/ 将/ 矩阵/ 犎/ 的/ 所有/ 负值/ 置/ 为/ 0/ ./ 然后/ ,/ 假设/ 矩阵/ 犎/ 不变/ ,/ 使用/ 式/ (/ 5/ )/ 求解/ 矩阵/ 犠/ ,/ 同样/ 将/ 矩阵/ 犠/ 中/ 所有/ 负值/ 置/ 为/ 0/ ./ 循环/ 以上/ 步骤/ 直到/ 计算/ 收敛/ 条件/ 被/ 满足/ 为止/ ,/ 如/ 矩阵/ 误差/ 小于/ 某个/ 阈值/ 或/ 分解/ 计算/ 达到/ 一定/ 的/ 迭代/ 阈值/ ./ 最后/ ,/ 分别/ 对/ 矩阵/ 犠/ 和/ 矩阵/ 犎/ 执行/ 标准化/ 转换/ ./ 首先/ 对/ 矩阵/ 犠/ 进行/ 标准化/ 转换/ ,/ 使得/ 它/ 的/ 每个/ 行向量/ 模为/ 1/ ./ 然后/ 根据/ 矩阵/ 犠/ 中/ 标准化/ 的/ 行向量/ ,/ 调整/ 矩阵/ 犎/ 中/ 对应/ 的/ 列/ 向量/ ./ 3.4/ 用户/ 行为/ 多元/ 模式分析/ 我们/ 基于/ 非/ 监督/ 学习/ 技术/ 进行/ 用户/ 行为/ 多元/ 模式分析/ ./ 本文/ 中/ ,/ 非/ 监督/ 学习/ 算法/ 得到/ 的/ 用户/ 行为/ 特征/ 聚簇/ 即/ 为/ 用户/ 行为/ 模式/ ./ 非/ 监督/ 学习/ 技术/ 通常/ 利用/ 用户/ 行为/ 特征/ 的/ 相似/ 度/ 、/ 聚集/ 密度/ 或者/ 概率分布/ ,/ 对/ 用户/ 行为/ 进行/ 聚类分析/ ./ 特征/ 的/ 相似/ 度/ 通常/ 采用/ 距离/ 指标/ 进行/ 度量/ ,/ 而/ 聚集/ 密度/ 通常/ 使用/ 邻近/ 特征/ 规模/ 进行/ 刻画/ ./ 然而/ ,/ 从/ 用户/ 行为/ 模式分析/ 的/ 角度/ ,/ 同/ 模式/ 用户/ 行为/ 特征/ 应该/ 具有/ 一定/ 的/ 统计/ 意义/ ./ 而/ 基于/ 用户/ 行为/ 相似/ 度/ 和/ 聚集/ 密度/ 的/ 分析方法/ ,/ 并/ 不能/ 保证/ 得到/ 的/ 用户/ 行为/ 模式/ 具有/ 统计/ 意义/ ./ 此外/ ,/ 系统/ 中/ 主导/ 用户/ 行为/ 的/ 各项/ 因素/ 稳定/ 时/ ,/ 用户/ 行为/ 也/ 应该/ 趋于稳定/ ./ 因此/ ,/ 本文/ 从/ 统计学/ 角度/ ,/ 假设/ 同/ 模式/ 的/ 用户/ 行为/ 特征/ 符合/ 正态分布/ ./ 在/ 第/ 4.4/ 节/ ,/ 我们/ 进行/ 了/ 该/ 分布/ 假设/ 的/ 检验/ 实验/ ,/ 实验/ 结果/ 验证/ 了/ 用户/ 行为/ 特征/ 符合/ 正态分布/ ./ 由于/ 用户/ 行为/ 具有/ 多元/ 模式/ ,/ 用户/ 行为/ 特征/ 符合/ 多个/ 不同/ 的/ 正态分布/ ./ 因此/ ,/ 本文/ 基于/ 高斯/ 混合/ 模型/ (/ 简称/ GMM/ )/ [/ 17/ ]/ 分析/ 用户/ 行为/ 的/ 多元/ 模式/ ./ GMM/ 模型/ 将/ 用户/ 行为/ 特征/ 的/ 分布/ 表示/ 为/ 多个/ 高斯分布/ 的/ 线性组合/ ./ 其中/ ,/ 每个/ 高斯分布/ 代表/ 一类/ 用户/ 行为/ 特征/ ,/ 即/ 一种/ 用户/ 行为/ 模式/ ./ 同/ 分布/ 的/ 用户/ 行为/ 特征/ 的/ 高斯分布/ 函数/ 可/ 表示/ 为/ g/ (/ 狓/ )/ =/ 其中/ ,/ Σ/ 为/ 协方差/ 矩阵/ ,/ 狏/ 为/ 均值/ 向量/ ,/ 狓/ 为/ 同/ 分布/ 的/ 用户/ 行为/ 特征向量/ ,/ d/ 表示/ 用户/ 行为/ 特征向量/ 长度/ ./ 全体/ 用户/ 行为/ 特征/ 的/ 分布/ 密度/ 表示/ 为/ 不同/ 的/ 高斯分布/ 函数/ 的/ 加权/ 线性组合/ :/ 其中/ ,/ x/ 表示/ 任意/ 的/ 用户/ 行为/ 特征/ ,/ g/ (/ ·/ )/ 为/ 高斯分布/ 函数/ ,/ ρ/ 布/ 的/ 数量/ ./ 实验/ 中/ ,/ 我们/ 采用/ 交叉/ 验证/ 的/ 方法/ 来/ 确定/ 最佳/ 的/ 高斯分布/ 数量/ ./ GMM/ 模型/ 的/ 参数/ 集/ Θ/ 通常/ 使用/ 期望/ 最大/ (/ EM/ )/ 算法/ [/ 17/ ]/ 估计/ 得到/ ./ EM/ 算法/ 基本思路/ 是/ 利用/ 已知/ 的/ 用户/ 行为/ 特征/ 犡/ =/ (/ 犳/ a/ (/ 0/ )/ ,/ 犳/ a/ (/ 1/ )/ ,/ …/ ,/ 犳/ b/ (/ 0/ )/ ,/ 犳/ b/ (/ 1/ )/ ,/ …/ )/ ,/ 从/ 模型/ 参数/ 集/ 的/ 初始值/ Θ/ 0/ 开始/ ,/ 估计/ 一个/ 新/ 的/ 参数/ 集/ Θ/ ,/ 使得/ 在/ 新/ 的/ 模型/ 参数/ 下/ 样本/ 的/ 似然/ 概率/ P/ (/ 犡/ |/ Θ/ )/ / P/ (/ 犡/ |/ Θ/ 0/ )/ ./ 新/ 的/ 模型/ 参数/ 再/ 作为/ 当前/ 参数/ 进行/ 训练/ ,/ 依次/ 迭代/ 运算/ 直到/ 模型/ 收敛/ 为止/ ./ 4/ 用户/ 行为/ 模式分析/ 实验/ 本文/ 的/ 用户/ 行为/ 模式分析/ 平台/ 是/ 一台/ 有/ 4/ 颗/ 6/ 核/ 1GHzAMDOpteron/ 处理器/ ,/ 64GB/ 内存/ ,/ 1TB/ 磁盘/ 和/ 10Gb/ 以太网卡/ 的/ 服务器/ ./ 服务器/ 运行/ 的/ 软件/ 包括/ RedHatEnterpriseLinux6/ ./ 2/ 操作系统/ (/ 2.6/ ./ 32/ -/ 220/ ./ el6/ ./ x8664SMP/ 内核/ )/ ,/ Python2/ ./ 7/ 运行/ 时/ 环境/ ./ 4.1/ 数据/ 集/ 本文/ 实验/ 中/ ,/ 我们/ 历时/ 3/ 个/ 月/ 收集/ 了/ 21/ 名/ 用户/ (/ 编号/ U1/ ~/ U21/ )/ 的/ 5/ 类/ 审计/ 日志/ ,/ 包括/ 计算机/ 登录/ 、/ 文件/ 访问/ 、/ USB/ 设备/ 操作/ 、/ CD/ // DVD/ 介质/ 访问/ 和/ 打印机/ 操作/ (/ 见表/ 1/ )/ ./ 系统/ 登录/ 日志/ 记录/ 了/ 用户/ 登入/ 办公/ 计算机/ 的/ 时间/ 、/ 计算机/ 名/ (/ 或/ 地址/ )/ 、/ 用户名/ 等/ 信息/ ./ 文件/ 访问/ 日志/ 记录/ 了/ 用户/ 的/ 新建/ 、/ 打开/ 、/ 修改/ 、/ 删除/ 文件/ 等/ 操作/ ./ CD/ // DVD/ 介质/ 访问/ 日志/ 记录/ 了/ 用户/ 的/ CD/ 和/ DVD/ 介质/ 使用/ 信息/ ./ USB/ 设备/ 操作/ 日志/ 记录/ 了/ USB/ 设备/ 信息/ 、/ 用户/ 插拔/ USB/ 设备/ 以及/ 读写/ 设备/ 内容/ 等/ 操作/ ./ 打印机/ 日志/ 记录/ 了/ 打印机/ 相关/ 信息/ 以及/ 用户/ 的/ 文件/ 打印/ 等/ 操作/ ./ Page6/ 编号/ 12345/ 根据/ 5/ 类/ 审计/ 日志/ ,/ 我们/ 生成/ 5/ 种/ 用户/ 域/ 内/ 行为/ 特征/ (/ 见表/ 2/ )/ ./ 计算机/ 登录/ 特征/ 包括/ 用户/ 登录/ 操作/ 和/ 登出/ 操作/ ,/ 向量/ 长度/ 为/ 2/ ./ 文件/ 访问/ 特征/ 包括/ 文件类型/ (/ 共/ 5/ 类/ )/ 、/ 新建/ 操作/ 、/ 打开/ 操作/ 、/ 修改/ 操作/ 、/ 拷贝/ 操作/ 、/ 删除/ 操作/ ,/ 向量/ 长度/ 为/ 10/ ./ 介质/ 访问/ 特征/ 包括/ 介质/ 类型/ (/ 共/ 2/ 类/ )/ 、/ 介质/ 读/ 、/ 介质/ 写/ ,/ 向量/ 长度/ 为/ 4/ ./ 设备/ 操作/ 特征/ 包括/ 设备/ 类型/ 、/ 设备/ 插入/ 、/ 设备/ 拔/ 下/ 、/ 设备/ 读/ 、/ 设备/ 写/ ,/ 向量/ 长度/ 为/ 5/ ./ 打印机/ 操作/ 特征/ 包括/ 文件类型/ (/ 共/ 5/ 类/ )/ ,/ 向量/ 长度/ 为/ 5/ ./ 然后/ ,/ 我们/ 以天/ 为/ 时间/ 窗口/ ,/ 通过/ 统计/ 和/ 合并/ 5/ 类域/ 内/ 行为/ 特征/ ,/ 为/ 每个/ 用户/ 生成/ 跨域/ 行为/ 特征/ ,/ 特征向量/ 长度/ 为/ 26/ ./ 编号/ 1234USB/ 设备/ 操作/ 5/ 我们/ 使用/ Pearson/ 系数/ 对/ 30/ 个/ 特征/ 的/ 相关性/ 进行/ 分析/ ./ 图/ 2/ 的/ 计算结果/ 显示/ 绝大多数/ 特征/ 的/ 相关系数/ 集中/ 在/ 0.1/ ~/ 0.3/ 区间/ ,/ 说明/ 它们/ 的/ 相关性/ 较/ 小/ ./ 只有/ 少量/ 特征/ 的/ 相关系数/ 达到/ 了/ 0.9/ ,/ 如/ 计算机/ 登录/ 域/ 的/ 用户/ 登录/ 操作/ 和/ 登出/ 操作/ ,/ 以及/ USB/ 设备/ 域/ 的/ 设备/ 插入/ 操作/ 和/ 拔出/ 操作/ ./ 最后/ 我们/ 删除/ 了/ 系统/ 登录/ 域/ 的/ 用户/ 登出/ 操作/ 和/ USB/ 设备/ 域/ 的/ 设备/ 拔出/ 操作/ ,/ 保留/ 其他/ 28/ 个/ 特征/ ./ 4.2/ 用户/ 行为/ 基/ 模式/ 和/ 用户/ 行为/ 特征/ 计算/ 在/ 生成/ 用户/ 行为/ 特征/ 过程/ 中/ ,/ 关键/ 是/ 选取/ 合适/ 的/ 基/ 模式/ 数量/ 参数/ k/ ./ 第/ 3.4/ 节/ 我们/ 提到/ ,/ k/ 取值/ 较/ 小时/ ,/ 对/ 用户/ 行为/ 的/ 描述/ 更/ 宏观/ ,/ 利于/ 不同/ 用户/ 之间/ 的/ 行为/ 差异/ 比较/ ./ 而/ k/ 取值/ 较大/ 时/ ,/ 对/ 用户/ 行为/ 的/ 描述/ 更/ 细致/ ,/ 利于/ 用户/ 个体/ 行为/ 变化/ 的/ 分析/ ./ 因此/ ,/ 我们/ 对比/ 了/ 3/ 种/ 规模/ (/ 即/ k/ 分别/ 取值/ 为/ 2/ 、/ 3/ 和/ 4/ )/ 时/ 的/ 基/ 模式/ 计算结果/ ./ 图/ 3/ 显示/ 了/ 不同/ 基/ 模式/ 数量/ 的/ 实验/ 结果/ ./ 可以/ 看出/ ,/ k/ =/ 2/ 和/ k/ =/ 3/ 时/ ,/ 基/ 模式/ 之间/ 具有/ 十分/ 明显/ 的/ 差异/ ./ 而/ k/ =/ 4/ 时/ ,/ 模式/ 1/ 与/ 模式/ 3/ 相似/ 的/ 特征/ 较/ 多/ ./ 同时/ 考虑/ 到/ 基/ 模式/ 数量/ 较多时/ ,/ 便于/ 用户/ 个体/ 行为/ 变化/ 的/ 分析/ ,/ 最后/ 我们/ 在/ 实验/ 中/ 选择/ k/ =/ 3/ 的/ 基/ 模式/ 计算结果/ ./ 从图/ 3/ 中/ 还/ 可/ 看出/ ,/ 基/ 模式/ 能够/ 很/ 好/ 地/ 表达/ 用户/ 域/ 内和域/ 间/ 行为/ 的/ 不同/ 关系/ ./ 在/ 我们/ 选择/ 的/ 基/ 模式/ 中/ ,/ 基/ 模式/ 0/ 突出/ 了/ 文件/ 域/ 中/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 、/ 文件/ 读/ 操作/ 、/ 文件/ 读取/ 权限/ 和/ 设备/ 域/ 中/ 设备/ 插入/ 操作/ 等/ 特征/ 的/ 关系/ ;/ 基/ 模式/ 1/ 突出/ 了/ 文件/ 域/ 的/ 第/ 2/ 种/ 文件类型/ 、/ 文件/ 写入/ 权限/ 、/ 介质/ 域/ 的/ 介质/ 写/ 操作/ 等/ 特征/ 的/ 关系/ ;/ 而基/ 模式/ 2/ 突出/ 了/ 文件/ 域/ 的/ 第/ 4/ 种/ 文件类型/ 、/ 文件/ 拷贝/ 操作/ 、/ 文件/ 修改/ 权限/ 和/ 介质/ 域/ 的/ 介质/ 类型/ 等/ 特征/ 的/ 关系/ ./ 图/ 3/ 基/ 模式/ 规模/ 系数/ k/ 分别/ 为/ 2/ 、/ 3/ 、/ 4/ 时/ 的/ 基/ 模式/ 计算/ 我们/ 进一步/ 考察/ 了/ 用户/ 行为/ 特征/ 的/ 计算结果/ ./ 图/ 4/ 是/ 所有/ 用户/ 行为/ 特征/ 计算结果/ ./ 可以/ 看出/ ,/ 多数/ 用户/ 之间/ 的/ 行为/ 差异/ 较/ 明显/ ./ 其次/ ,/ 大部分/ 用户/ 行为/ 具有/ 较/ 明显/ 的/ 阶段性/ 变化/ ,/ 如/ 用户/ U2/ 行为/ 在/ 第/ 54/ 天/ 前后/ 有/ 较/ 显著/ 的/ 不同/ ,/ 用户/ U7/ 行为/ 从/ 第/ 36/ 天有/ 明显/ 的/ 变化/ ,/ 用户/ U20/ 行为/ 在/ 第/ 28/ 天/ 前后/ 也/ 有/ 显著/ 差异/ 等/ ./ 因此/ ,/ 基于/ 基/ 模式/ 的/ 用户/ 行为/ 特征/ ,/ 不仅/ 能够/ 表现/ 不同/ 用户/ 之间/ 行为/ 的/ 异同/ ,/ 同时/ 能够/ 较/ 好/ 地/ 展现/ 每个/ 用户/ 个体/ 行为/ 的/ 变化/ ./ 由/ 以上/ 观察/ ,/ 我们/ 知道/ 用户/ 行为/ 具有/ 明显/ 的/ 多元/ 模式/ ./ 不可避免/ 的/ ,/ 这种/ 情况/ 会/ 给/ 用户/ 单一/ 行为/ 模/ Page7/ 图/ 4/ 用户/ 行为/ 特征/ 计算结果/ ./ 基于/ 基/ 模式/ 的/ 用户/ 行为/ 特征/ 不仅/ 能够/ 表现/ 不同/ 用户/ 之间/ 行为/ 的/ 异同/ ,/ 同时/ 能够/ 较/ 好/ 地/ 展现/ 每个/ 用户/ 个体/ 行为/ 的/ 变化/ 式/ 分析/ 带来/ 困难/ ./ 因为/ 单一/ 行为/ 模式分析/ 方法/ 很大/ 可能/ 仅能/ 识别/ 其中/ 一种/ 较强/ 的/ 行为/ 模式/ ,/ 且/ 得到/ 的/ 模式/ 对于/ 用户/ 行为/ 特点/ 描述/ 也/ 较/ 笼统/ ./ 而/ 用户/ 正常/ 行为/ 模式/ 对于/ 绝大多数/ 攻击行为/ 检测/ 方法/ 至关重要/ ./ 因此/ ,/ 单一/ 行为/ 模式分析/ 会/ 严重/ 影响/ 攻击/ 检测/ 方法/ 的/ 检测/ 性能/ ,/ 这/ 给/ 识别/ 出/ 真正/ 的/ 攻击行为/ 带来/ 难度/ ./ 根据/ 以上/ 分析/ ,/ 本文/ 强调/ 用户/ 行为/ 的/ 多元/ 模式分析/ ./ 多元/ 模式分析/ 方法/ 能够/ 尽量/ 全面/ 刻画/ 用户/ 行为/ 特点/ ./ 当/ 应用/ 于/ 攻击/ 检测/ 时/ ,/ 相对/ 于/ 单一/ 行为/ 模式/ ,/ 能够/ 较/ 容易/ 地/ 发现/ 用户/ 异常/ 行为/ ./ 4.3/ 用户/ 行为/ 多元/ 模式分析/ 应用/ GMM/ 模型/ 分析/ 用户/ 行为/ 模式/ ,/ 需要/ 考虑/ 选择/ 合适/ 的/ 协方差/ 约束/ 方式/ 和/ 高斯分布/ 数量/ ./ 实验/ 中/ ,/ 我们/ 采用/ 交叉/ 验证/ 的/ 方法/ 寻找/ 最佳/ 的/ GMM/ 模型/ ./ 我们/ 使用/ 常见/ 的/ 贝叶斯/ 信息/ 准则/ (/ BIC/ )/ [/ 18/ ]/ 作为/ 模型/ 选择/ 指标/ ./ 我们/ 比较/ 了/ 分别/ 采用/ 4/ 种/ 协方差/ 矩阵/ (/ spherical/ 、/ diagonal/ 、/ full/ 和/ tied/ )/ 和/ 分别/ 具有/ 1/ ~/ 20/ 个/ 高斯分布/ 的/ GMM/ 模型/ 的/ BIC/ 指标/ ./ 通常/ 情况/ 下/ ,/ 模型/ 的/ BIC/ 指标/ 越小/ 说明/ 模型/ 的/ 效果/ 越好/ ./ 图/ 5/ 是/ 不同/ 模型/ BIC/ 指标/ 的/ 对比/ ./ 其中/ 使用/ 图/ 5/ 不同/ 高斯分布/ 规模/ 和/ 协方差/ 的/ 高斯/ 混合/ 模型/ (/ GMM/ )/ 的/ 贝叶斯/ 信息/ 准则/ (/ BIC/ )/ 指标/ 比较/ diagonal/ 协方差/ 矩阵/ 和/ 具有/ 15/ 个/ 高斯分布/ 的/ GMM/ 模型/ 的/ BIC/ 指标/ 最小/ ,/ 故/ 我们/ 选择/ 此/ 模型/ 进行/ 用户/ 行为/ 模式分析/ ./ 图/ 6/ 是/ 基于/ GMM/ 模型/ 的/ 用户/ 行为/ 模式分析/ 结果/ 的/ 可视化/ 效果/ ./ 其中/ ,/ 每个/ GMM/ 簇/ 代表/ 一种/ 用户/ 行为/ 模式/ ,/ 共有/ 15/ 个/ 模式/ ./ 图/ 6/ 基于/ 高斯/ 混合/ 模型/ (/ GMM/ )/ 的/ 用户/ 行为/ 多元/ 模式分析/ 结果/ 为了/ 进一步/ 了解/ 这些/ 用户/ 行为/ 模式/ 的/ 基本/ 含义/ ,/ 我们/ 求得/ 每个/ 模式/ 中/ 所有/ 用户/ 行为/ 特征/ 的/ 平均值/ ,/ 并/ 作为/ 该/ 模式/ 的/ 典型/ 行为/ 特征/ ,/ 如图/ 7/ 所示/ ./ 基于/ 前面/ 的/ 基/ 模式/ 类型/ ,/ 我们/ 可以/ 知道/ 模式/ 0/ 包含/ 了/ 大量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 同/ Page8/ 时/ 包含/ 了/ 较/ 多/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 1/ 包含/ 了/ 大量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ,/ 而/ 其他/ 操作/ 几乎/ 没有/ ./ 模式/ 2/ 包含/ 了/ 大量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 有/ 少量/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 3/ 包含/ 了/ 大量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 还有/ 少量/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 4/ 包含/ 了/ 大量/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 还有/ 少量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 5/ 包含/ 了/ 大量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 有/ 少量/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 6/ 包含/ 了/ 少量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ,/ 而/ 其他/ 操作/ 较少/ ./ 模式/ 7/ 包含/ 了/ 大量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 包含/ 了/ 少量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 8/ 包含/ 了/ 极少/ 的/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 几乎/ 没有/ 其他/ 操作/ ./ 模式/ 9/ 包含/ 了/ 大量/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 还有/ 极少/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 10/ 包含/ 了/ 少量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ 和/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 11/ 包含/ 了/ 大量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 包含/ 了/ 较/ 多/ 的/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ,/ 和/ 少量/ 的/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 12/ 包含/ 了/ 较/ 多/ 的/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 还有/ 少量/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 13/ 包含/ 了/ 少量/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ 和/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ ./ 模式/ 14/ 包含/ 了/ 较/ 多/ 的/ 从/ 不同/ 介质/ 拷贝/ 第/ 4/ 种/ 文件类型/ 的/ 操作/ ,/ 同时/ 包含/ 了/ 少量/ 的/ 向/ 介质/ 写/ 第/ 2/ 种/ 文件类型/ 的/ 操作/ 和/ 从/ 设备/ 中/ 读取/ 第/ 1/ 、/ 3/ 种/ 文件类型/ 的/ 操作/ ./ 为了/ 进一步/ 验证/ 用户/ 行为/ 的/ 多元/ 模式/ ,/ 我们/ 分析/ 了/ 每个/ 用户/ 涉及/ 的/ 行为/ 模式/ 及其/ 比重/ ./ 图/ 8/ 是/ 每个/ 用户/ 关于/ 已/ 识别/ 的/ 15/ 种/ 模式/ 的/ 行为/ 构成/ 分析/ ./ 该图/ 显示/ ,/ 所有/ 用户/ 的/ 行为/ 具有/ 多元/ 模式/ 的/ 特点/ ./ 图/ 9/ 是/ 所有/ 用户/ 的/ 模式/ 占/ 比/ 分析/ 结果/ ./ 其中/ ,/ 约/ 71.4/ %/ 用户/ 的/ 模式/ 占/ 比/ 标准差/ 小于/ 20/ %/ ,/ 其余/ 用户/ 的/ 模式/ 占/ 比/ 标准差/ 也/ 在/ 60/ %/ 左右/ ./ 结果/ 说明/ ,/ 绝大多数/ 用户/ 行为/ 不仅/ 具有/ 多元/ 模式/ 的/ 特点/ ,/ 而且/ 同时/ 受/ 多种/ 模式/ 主导/ ./ 因此/ 单一/ 模式/ 不足以/ 刻画/ 用户/ 的/ 跨域/ 行为/ 特点/ ./ 图/ 8/ 用户/ 行为/ 关于/ 已知/ 行为/ 模式/ 的/ 构成/ 成分/ 分析/ 4.4/ 用户/ 行为/ 特征/ 分布/ 假设检验/ 实验/ 中/ ,/ 我们/ 对/ 用户/ 行为/ 特征/ 的/ 高斯分布/ 假设/ 进行/ 了/ 假设检验/ ./ 对于/ 上/ 节/ 实验/ 得到/ 的/ 用户/ 行为/ 模式/ ,/ 我们/ 采用/ 正态/ 概率/ 图/ 给出/ 直观/ 的/ 检验/ 结果/ ,/ 同时/ 采用/ Shapiro/ -/ Wilk/ 检验法/ 进行/ 了/ 拟合/ 性/ 检验/ ./ 正态/ 概率/ 图/ 描述/ 了/ 同/ 模式/ 的/ 用户/ 行为/ 特征/ 与/ 标准/ 正态分布/ 的/ 函数/ 关系/ ./ 如果/ 这些/ 用户/ 行为/ 特征/ 符合标准/ 的/ 正态分布/ ,/ 则/ 它们/ 的/ 正态/ 概率/ 图/ 将/ 是/ 一条/ 直线/ ./ 而/ 采用/ 基于/ 频率/ 统计/ 的/ Shapiro/ -/ Wilk/ 检验法/ ,/ 我们/ 可以/ 量化/ 的/ 检验/ 同/ 模式/ 用户/ 行为/ 特征/ 分布/ 的/ 正态性/ ./ 该/ 检验法/ 给出/ 称为/ p/ -/ value/ 的/ 正态性/ 检验/ 指标/ ./ 当该/ 指标/ 高于/ 某个/ 阈值/ 时/ (/ 通常/ 为/ 0.05/ )/ ,/ 则/ 认为/ 同/ 模式/ 用户/ 行为/ 特征/ 的/ 分布/ 符合/ 正态分布/ ./ 图/ 10/ 是/ 假设检验/ 结果/ ,/ 包括/ 了/ 每类/ 模式/ 中/ 用户/ 行为/ 特征/ 的/ 正态/ 概率/ 图/ 以及/ 相应/ 的/ p/ -/ value/ 检验/ 指标/ ./ 不难看出/ ,/ 各/ 模式/ 的/ 正态/ 概率/ 图/ 基本上/ 构成/ 了/ 一条/ 直线/ ./ 同时/ ,/ 各/ 模式/ 的/ p/ -/ value/ 指标/ 均/ 高于/ 0.05/ ./ 实验/ 说明/ 用户/ 行为/ 模式/ 符合/ 高斯分布/ 假设/ ./ Page9/ 图/ 10/ 用户/ 行为/ 模式/ 的/ 高斯分布/ 假设检验/ 结果/ 5/ 基于/ 用户/ 行为/ 模式/ 的/ 内部/ 攻击/ 检测/ 基于/ 以上/ 的/ 用户/ 行为/ 模式分析/ 结果/ ,/ 本文/ 主要/ 针对/ 被/ 较/ 多/ 关注/ 的/ 伪装/ 攻击/ ,/ 设计/ 了/ 一种/ 攻击/ 检测/ 方法/ ./ 伪装/ 攻击/ 是/ 指/ 恶意/ 的/ 内部/ 用户/ 通过/ 某种/ 手段/ (/ 如/ 猜/ 密码/ 、/ 种/ 木马/ 、/ 漏洞/ 扫描/ 等/ )/ 非法/ 窃取/ 其他/ 合法/ 用户/ 的/ 账户/ 和/ 口令/ ,/ 并/ 利用/ 这些/ 账户/ 伪装成/ 合法/ 用户/ 对/ 系统实施/ 的/ 攻击/ ./ 5.1/ 伪装/ 攻击/ 检测/ 伪装/ 攻击/ 的/ 检测/ 基础/ 是/ ,/ 恶意/ 用户/ 的/ 行为/ 与/ 被/ 利用/ 的/ 伪装/ 对象/ 的/ 行为/ 存在/ 一定/ 的/ 差异/ ./ 首先/ ,/ 恶意/ 用户/ 与/ 被/ 利用/ 对象/ 存在/ 天然/ 的/ 个体/ 和/ 背景/ 差异/ ./ 其次/ ,/ 恶意/ 用户/ 的/ 目的/ 是/ 系统/ 攻击/ ,/ 而/ 被/ 利用/ 对象/ 的/ 行为/ 则/ 主要/ 围绕/ 日常/ 的/ 系统/ 使用/ ./ 因此/ 二者/ 使用/ 系统/ 的/ 方式/ 和/ 习惯/ 会/ 存在/ 一定/ 程度/ 的/ 不同/ ./ Page10/ 基于/ 以上/ 思想/ ,/ 我们/ 利用/ 前面/ 介绍/ 的/ 用户/ 行为/ 模式分析/ 方法/ 设计/ 了/ 一种/ 新/ 的/ 面向/ 多/ 检测/ 域/ 的/ 伪装/ 攻击/ 检测/ 方法/ ./ 从/ 用户/ 行为/ 模式/ 的/ 角度看/ ,/ 攻击行为/ 可能/ 带来/ 两种/ 结果/ ,/ 与/ 用户/ 正常/ 行为/ 差异/ 较大/ ,/ 直接/ 产生/ 异常/ 行为/ 模式/ ,/ 或者/ 与/ 用户/ 正常/ 行为/ 差异/ 较/ 小/ ,/ 间接/ 对/ 正常/ 模式/ 产生/ 负面影响/ ./ 因此/ ,/ 对/ 伪装/ 攻击/ 的/ 检测/ 主要/ 包括/ 两个/ 方面/ :/ 异常/ 行为/ 模式/ 检测/ 和/ 正常/ 行为/ 模式/ 的/ 干扰/ 检测/ ./ 通常/ 攻击行为/ 的/ 频度/ 远/ 小于/ 正常/ 行为/ ,/ 因此/ 异常/ 模式/ 是/ 一些/ 小/ 的/ 行为/ 模式/ ./ 在/ GMM/ 模型/ 中/ ,/ 则/ 是/ 一些/ 稀疏/ 且/ 规模较/ 小/ 的/ 簇/ ./ 在/ 检测/ 过程/ 中/ ,/ 我们/ 通过/ 设定/ 一个/ 异常/ 行为/ 模式/ 阈值/ ,/ 用以/ 区分/ 用户/ 的/ 正常/ 行为/ 模式/ 和/ 异常/ 行为/ 模式/ ./ 在/ GMM/ 模型/ 中/ ,/ 该/ 阈值/ 是/ 簇/ 规模/ 的/ 下限/ ,/ 低于/ 该/ 阈值/ 的/ 簇则/ 是/ 异常/ 行为/ 模式/ ./ 异常/ 模式/ 所/ 包含/ 的/ 用户/ 行为/ 则/ 被/ 认为/ 是/ 攻击行为/ ./ 在/ 行为/ 模式/ 干扰/ 检测/ 方面/ ,/ 我们/ 通过/ 检验/ 每个/ 行为/ 特征向量/ 对/ 其/ 所属/ 模式/ 高斯分布/ 的/ 影响/ 是否/ 有利/ ./ 同样/ 的/ ,/ 因为/ 攻击行为/ 的/ 频度/ 远/ 小于/ 正常/ 行为/ ,/ 因此/ 相对/ 于/ 正常/ 行为/ 更/ 符合/ 模式/ 的/ 高斯分布/ ,/ 而/ 攻击行为/ 则/ 会/ 减弱/ 模式/ 的/ 高斯分布/ 符合/ 性/ ./ 基于/ 第/ 4.4/ 节/ 介绍/ 的/ p/ -/ value/ 指标/ ,/ 我们/ 设计/ 了/ 一个/ 关于/ 行为/ 特征向量/ 的/ 模式/ 支持/ 度/ 指标/ ,/ 用于/ 计算/ 每个/ 行为/ 特征向量/ 对/ 模式/ 的/ 高斯分布/ 的/ 支持/ 程度/ :/ sc/ ,/ i/ =/ pc/ ,/ i/ -/ pc/ ,/ i/ ./ 其中/ sc/ ,/ i/ 表示/ 编号/ 为/ i/ 的/ 行为/ 特征向量/ 对/ 模式/ c/ 的/ 高斯分布/ 支持/ 度/ ./ pc/ ,/ i/ 表示/ 模式/ c/ 包含/ 了/ 行为/ 特征向量/ i/ 的/ 高斯分布/ 假设检验/ p/ -/ value/ 指标/ ,/ 而/ pc/ ,/ i/ 表示/ 没有/ 包含/ 行为/ 特征向量/ i/ 的/ p/ -/ value/ 指标/ ./ 由于/ p/ -/ value/ 实际/ 是/ 一种/ 概率/ 指标/ ,/ sc/ ,/ i/ 的/ 计算结果/ 处于/ [/ -/ 1/ ,/ 1/ ]/ 区间/ ./ 如果/ sc/ ,/ i/ 指标/ 越高/ ,/ 则/ 行为/ 特征向量/ i/ 对/ 模式/ c/ 的/ 高斯分布/ 支持/ 的/ 越/ 好/ ,/ 表示/ 该/ 行为/ 越/ 更/ 大/ 可能/ 是/ 正常/ 行为/ ,/ 反之/ 则/ 越/ 差/ ,/ 表示/ 该/ 行为/ 更大/ 可能/ 是/ 攻击行为/ ./ 通过/ 设定/ 一个/ 模式/ 支持/ 度/ 阈值/ ,/ 我们/ 可以/ 区分/ 用户/ 正常/ 行为/ 和/ 攻击行为/ ./ 模式/ 支持/ 度/ 指标/ 高于/ 该/ 阈值/ 的/ 行为/ 被/ 认为/ 是/ 正常/ 行为/ ,/ 而/ 低于/ 该/ 阈值/ 的/ 行为/ 则/ 被/ 认为/ 是/ 攻击行为/ ./ 检测/ 算法/ 如/ 算法/ 1/ 所示/ ./ 首先/ 将/ 一个/ 用户/ 异常/ 行为/ 集/ A/ 初始化/ 为/ 空集/ (/ 第/ 1/ 行/ )/ ./ 接着/ 使用/ GMM/ 模型/ 分析/ 用户/ 行为/ 多元/ 模式/ ,/ 并/ 得到/ 模式/ 集合/ C/ (/ 第/ 2/ 行/ )/ ./ 然后/ 分别/ 对/ 模式/ 集/ C/ 中/ 各/ 模式/ c/ 进行/ 攻击/ 检测/ 分析/ (/ 第/ 3/ ~/ 15/ 行/ )/ ./ 首先/ 进行/ 异常/ 模式/ 检测/ (/ 第/ 4/ ~/ 6/ 行/ )/ ./ 如果/ 模式/ c/ 的/ 规模/ 低于/ 异常/ 模式/ 阈值/ Tc/ ,/ 则/ 将/ 该/ 模式识别/ 为/ 异常/ 模式/ ,/ 并/ 将/ 该/ 模式/ 编号/ 和/ 其中/ 所有/ 行为/ 特征向量/ 编号/ 记入/ 异常/ 行为/ 集/ A/ 中/ ,/ 然后/ 转入/ 对下/ 一个/ 模式/ 的/ 检测/ 分析/ ./ 如果/ 模式/ c/ 规模/ 高于/ 异常/ 模式/ 阈值/ Tc/ ,/ 则/ 为/ 正常/ 模式/ ,/ 需要/ 继续/ 进行/ 模式/ 干扰/ 检测/ 分析/ (/ 第/ 8/ ~/ 15/ 行/ )/ ./ 首先/ 计算/ 模式/ 中/ 每个/ 行为/ 特征向量/ 的/ 模式/ 支持/ 度/ 指标/ ./ 如果/ 该/ 指标/ 低于/ 模式/ 支持/ 度/ 阈值/ Ts/ ,/ 则/ 该/ 特征向量/ 被/ 识别/ 为/ 异常/ 行为/ ,/ 并/ 记入/ 异常/ 行为/ 集/ A/ 中/ ./ 否则/ 为/ 正常/ 行为/ ,/ 继续/ 下/ 一个/ 行为/ 特征向量/ 检测/ ./ 最后/ 返回/ 异常/ 行为/ 集/ A/ (/ 第/ 16/ 行/ )/ ./ 算法/ 1/ ./ 伪装/ 攻击/ 检测/ 算法/ ./ 输入/ :/ 数据/ 集/ D/ ,/ 异常/ 模式/ 阈值/ Tc/ ,/ 模式/ 支持/ 度/ 阈值/ Ts/ 输出/ :/ 用户/ 异常/ 行为/ 集/ A1/ ./ A/ </ -/ {/ }/ 2/ ./ C/ </ -/ GMM/ (/ D/ )/ 3/ ./ FORcINC/ :/ 4/ ./ IFc/ ./ points/ ./ size/ </ Tc/ :/ 5/ ./ FORiINrange/ (/ c/ ./ points/ ./ size/ )/ :/ 6/ ./ A/ ./ append/ (/ [/ c/ ./ name/ ,/ i/ ]/ )/ 7/ ./ CONTINUE8/ ./ FORiINrange/ (/ c/ ./ points/ ./ size/ )/ :/ 9/ ./ points/ </ -/ c/ ./ points10/ ./ points/ ./ delete/ (/ i/ )/ 11/ ./ p/ </ -/ p/ -/ value/ (/ c/ ./ model/ ,/ c/ ./ points/ )/ 12/ ./ p/ </ -/ p/ -/ value/ (/ c/ ./ model/ ,/ points/ )/ 13/ ./ s/ </ -/ p/ -/ p14/ ./ IFs/ </ TS/ :/ 15/ ./ A/ ./ append/ (/ [/ c/ ./ name/ ,/ i/ ]/ )/ 16/ ./ RETURNA6/ 内部/ 攻击/ 检测/ 实验/ 6.1/ 数据/ 集在/ 伪装/ 攻击/ 模拟/ 方面/ ,/ 我们/ 借鉴/ 了/ Schonlau/ 等/ 人/ [/ 19/ ]/ 在/ 用户/ 日志/ 中/ 注入/ 攻击/ 数据/ 的/ 方法/ ./ 该/ 方法/ 随机/ 将/ 用户/ 分为/ 被/ 攻击/ 对象/ 和/ 攻击者/ ,/ 然后/ 将/ 攻击者/ 的/ 部分/ 日志/ 作为/ 攻击行为/ 插入/ 到/ 被/ 攻击/ 用户/ 的/ 正常/ 日志/ 中/ ./ 实验/ 中/ ,/ 我们/ 随机/ 选取/ 了/ 6/ 名/ 用户/ 作为/ 攻击者/ (/ U5/ // U8/ // U11/ // U16/ // U17/ // U18/ )/ ,/ 并/ 随机/ 抽取/ 每个/ 攻击者/ 5/ 天/ 的/ 日志/ 作为/ 攻击/ 数据/ (/ T1/ ~/ T5/ )/ ./ 然后/ 将/ 其余/ 15/ 名/ 用户/ 作为/ 被/ 攻击/ 对象/ ,/ 并/ 将/ 攻击/ 数据/ 随机/ 、/ 平均/ 的/ 插入/ 到/ 被/ 攻击/ 用户/ 的/ 日志/ 数据/ 中/ ./ 生成/ 的/ 攻击/ 数据/ 集见表/ 3/ 描述/ ./ Page11/ 目标/ 用户/ U1U2U3U4U6U7U9U10U12U13U14U15U19U20U216/ ./ 2/ 实验/ 结果/ 我们/ 对比/ 了/ 两种/ 攻击/ 检测/ 方法/ 与/ 本文/ 方法/ 的/ 实验/ 结果/ ./ 第/ 1/ 种/ 方法/ 是/ 基于/ 用户/ 单域/ 行为/ 多元/ 模式/ 的/ 检测/ 方法/ ,/ 称为/ SDMP/ -/ GMM/ 方法/ ./ 基于/ 第/ 5.1/ 节/ 介绍/ 的/ 检测/ 方法/ ,/ SDMP/ -/ GMM/ 方法/ 分别/ 针对/ 每个/ 用户/ 的/ 各/ 单域/ 行为/ 进行/ 攻击/ 检测/ ,/ 包括/ 表/ 1/ 中/ 的/ 5/ 类/ 检测/ 域/ ./ 该/ 方法/ 使用/ 第/ 3.2/ 节/ 介绍/ 的/ 用户/ 单域/ 行为/ 描述/ 作为/ 用户/ 单域/ 行为/ 特征/ ./ 第/ 2/ 种/ 方法/ 是/ 基于/ 用户/ 跨域/ 行为/ 单一/ 模式/ 的/ 检测/ 方法/ ,/ 称为/ CDSP/ -/ SVM/ 方法/ ./ 该/ 方法/ 类似/ 于/ Kamra/ 等/ 人/ [/ 4/ ]/ 和/ Zheng/ 等/ 人/ [/ 5/ ]/ 提出/ 的/ 基于/ 用户/ 单一/ 行为/ 模式/ 的/ 攻击行为/ 检测/ 方法/ ./ CDSP/ -/ SVM/ 方法/ 使用/ 第/ 3.3/ 节/ 介绍/ 的/ 用户/ 跨域/ 行为/ 特征/ ,/ 通过/ 标准/ 的/ SVM/ 分类器/ 挖掘/ 每个/ 用户/ 的/ 单一/ 行为/ 模式/ ,/ 并/ 使用/ 这个/ 分类器/ 判断/ 用户/ 待检/ 行为/ 是否/ 异常/ ./ 实验/ 中/ ,/ SVM/ 分类器/ 采用/ 了/ 多阶/ 的/ 多项式/ 核/ ,/ 并/ 通过/ 交叉/ 验证/ 的/ 方式/ 评价/ 检测/ 效果/ ./ SVM/ 分类器/ 的/ 训练/ 数据/ 由/ 被/ 攻击/ 用户/ 和/ 其他/ 用户/ 的/ 部分/ 日志/ 数据/ 构成/ ,/ 而/ 测试数据/ 包括/ 被/ 攻击/ 用户/ 图/ 11/ 用户/ 跨域/ 行为/ 检测/ (/ CDMP/ -/ GMM/ )/ 与/ 用户/ 单域/ 行为/ 检测/ (/ SDMP/ -/ GMM/ )/ 的/ 实验/ 结果/ 对比/ 的/ 其余/ 日志/ 数据/ 和/ 攻击者/ 的/ 日志/ 数据/ ./ 最后/ ,/ 为了/ 方便/ 对比/ ,/ 本文/ 方法/ 称为/ CDMP/ -/ GMM/ 方法/ ./ 实验/ 中/ ,/ CDMP/ -/ GMM/ 方法/ 分别/ 对/ 每个/ 用户/ 的/ 跨域/ 行为/ 进行/ 了/ 攻击/ 检测/ ./ 在/ 检测/ 结果/ 评价/ 方面/ ,/ 我们/ 采用/ 了/ 多种/ 评价/ 指标/ ,/ 除了/ 基本/ 的/ 查全率/ TP/ (/ TruePositive/ )/ 指标/ 和/ 错/ 检率/ FP/ (/ FalsePositive/ )/ 指标/ ,/ 还/ 包括/ 常见/ 的/ ROC/ 曲线/ 及其/ AUC/ 面积/ ./ TP/ 指标/ 是/ 被/ 检测/ 出/ 的/ 攻击行为/ 与/ 攻击行为/ 总量/ 的/ 比例/ ,/ 而/ FP/ 指标/ 是/ 被/ 误断/ 的/ 用户/ 正常/ 行为/ 与/ 用户/ 正常/ 行为/ 总量/ 的/ 比例/ ./ AUC/ 指标/ 能够/ 综合/ 反映/ 检测/ 效果/ 的/ FP/ 指标/ 和/ TP/ 指标/ ./ 检测/ 方法/ 的/ AUC/ 值越/ 趋近/ 于/ 1/ ,/ 则/ 检测/ 效果/ 越好/ ./ 对于/ SDMP/ -/ GMM/ 方法/ 和/ CDMP/ -/ GMM/ 方法/ ,/ 可以/ 通过/ 同时/ 对/ 所有/ 用户/ 统一/ 调节/ 异常/ 模式/ 阈值/ 和/ 模式/ 支持/ 度/ 阈值/ 来/ 得到/ 两种/ 方法/ 的/ 所有/ 实验/ 结果/ ,/ 因此/ 我们/ 可以/ 使用/ AUC/ 指标/ 对/ 它们/ 的/ 实验/ 结果/ 进行/ 对比/ ./ 而/ CDSP/ -/ SVM/ 方法/ 的/ 检测/ 效果/ 依赖于/ 训练/ 数据/ 的/ 选取/ ,/ 因此/ 我们/ 使用/ FP/ 指标/ 和/ TP/ 指标/ 对/ 该/ 方法/ 多次/ 实验/ 后/ 最/ 理想/ 的/ 检测/ 结果/ 进行/ 评价/ ./ 同时/ ,/ 与/ SDMP/ -/ GMM/ 方法/ 进行/ 对比/ 时/ 不同/ ,/ CDMP/ -/ GMM/ 方法/ 分别/ 调整/ 对/ 每个/ 用户/ 的/ 异常/ 模式/ 阈值/ 和/ 模式/ 支持/ 度/ 阈值/ ./ 图/ 11/ 对比/ 了/ 用户/ 跨域/ 行为/ 检测/ (/ CDMP/ -/ GMM/ 方法/ )/ 和/ 单域/ 行为/ 检测/ (/ SDMP/ -/ GMM/ 方法/ )/ 的/ 实验/ 结果/ ./ 可以/ 看出/ ,/ 在/ AUC/ 指标/ 方面/ CDMP/ -/ GMM/ 方法/ (/ 0.95/ )/ 优于/ SDMP/ -/ GMM/ 方法/ 分别/ 在/ 计算机/ 登录/ 域/ 、/ 文件/ 域/ 、/ USB/ 设备/ 域/ 、/ 介质/ 域/ 和/ 打印机/ 域/ 的/ 检测/ 效果/ (/ 分别/ 为/ 0.78/ 、/ 0.86/ 、/ 0.81/ 、/ 0.71/ 和/ 0.68/ )/ ./ 实验/ 说明/ ,/ 相比/ 单域/ 行为/ 模式/ ,/ 用户/ 跨域/ 行为/ 模式/ 更/ 有助于/ 内部/ 攻击/ 检测/ 分析/ ./ Page12/ 图/ 12/ 对比/ 了/ 基于/ 用户/ 行为/ 多元/ 模式/ 的/ 检测/ (/ CDMP/ -/ GMM/ 方法/ )/ 与/ 典型/ 的/ 基于/ 用户/ 行为/ 单一/ 模式/ 的/ 检测/ (/ CDSP/ -/ SVM/ 方法/ )/ 分别/ 对/ 各/ 用户/ 的/ 实验/ 结果/ ./ 在/ TP/ 指标/ 方面/ ,/ CDSP/ -/ SVM/ 方法/ 仅/ 检出/ 用户/ U1/ 、/ U12/ 、/ U15/ 、/ U19/ 和/ U20/ 的/ 所有/ 攻击行为/ ,/ 其余/ 10/ 名/ 用户/ 仅/ 检出/ 50/ %/ 的/ 攻击行为/ (/ TP/ =/ 50/ %/ )/ ,/ 图/ 12/ 基于/ 用户/ 行为/ 多元/ 模式/ 的/ 检测/ (/ CDMP/ -/ GMM/ 方法/ )/ 与/ 典型/ 的/ 基于/ 用户/ 行为/ 而/ CDMP/ -/ GMM/ 方法/ 能够/ 检出/ 所有/ 用户/ 的/ 所有/ 攻击行为/ (/ TP/ =/ 100/ %/ )/ ./ 在/ FP/ 指标/ 方面/ ,/ CDSP/ -/ SVM/ 方法/ 对/ 用户/ U3/ 、/ U9/ 、/ U10/ 、/ U13/ 和/ U21/ 的/ 检测/ 结果/ 在/ 20/ %/ 之内/ ,/ 对/ 用户/ U7/ 的/ 检测/ 结果/ 在/ 30/ %/ 之内/ ,/ 对/ 用户/ U1/ 、/ U4/ 、/ U6/ 、/ U12/ 、/ U19/ 和/ U20/ 的/ 检测/ 结果/ 在/ 40/ %/ 以内/ ,/ 对/ 用户/ U2/ 的/ 检测/ 结果/ 在/ 50/ %/ 以内/ ,/ Page13/ 对/ 用户/ U14/ 和/ U15/ 的/ 检测/ 结果/ 超过/ 50/ %/ ./ 而/ CDMP/ -/ GMM/ 方法/ 仅/ 对/ 用户/ U1/ 、/ U9/ 、/ U10/ 、/ U14/ 、/ U15/ 和/ U20/ 的/ 检测/ FP/ 指标/ 在/ 20/ %/ 以内/ ,/ 对/ 其余/ 9/ 名/ 用户/ 的/ 检测/ 结果/ 均/ 在/ 10/ %/ 以内/ ./ 需要/ 注意/ 的/ 是/ ,/ 对于/ 用户/ U9/ 的/ 检测/ ,/ 虽然/ CDSP/ -/ SVM/ 方法/ 的/ FP/ 指标/ (/ 14.3/ %/ )/ 优于/ CDMP/ -/ GMM/ 方法/ (/ 16.1/ %/ )/ ,/ 但是/ 后者/ 的/ TP/ 指标/ (/ 100/ %/ )/ 却/ 显著/ 优于/ 前者/ (/ 50/ %/ )/ ./ 对于/ 用户/ U10/ ,/ 尽管/ 两种/ 的/ FP/ 指标/ 比较/ 接近/ ,/ 但是/ 在/ TP/ 指标/ 上/ ,/ CDMP/ -/ GMM/ 方法/ (/ 100/ %/ )/ 却/ 显著/ 优于/ CDSP/ -/ SVM/ 方法/ (/ 50/ %/ )/ ./ 由此可知/ ,/ 基于/ 用户/ 行为/ 多元/ 模式/ 的/ 检测/ 方法/ 优于/ 基于/ 单一/ 模式/ 的/ 检测/ 方法/ ./ 7/ 相关/ 工作/ 7.1/ 用户/ 单域/ 行为/ 分析/ 用于/ 异常/ 行为/ 检测/ 的/ 用户/ 单域/ 行为/ 模式分析/ 方法/ 通常/ 依赖于/ 某个/ 用户/ 属性/ 来/ 构建/ 用户/ 在/ 某个/ 检测/ 域/ 的/ 域/ 内/ 正常/ 行为/ 模式/ ,/ 如/ 用户/ 标示/ 、/ 用户/ 角色/ 等/ ./ Kamra/ 等/ 人/ [/ 4/ ]/ 提出/ 分别/ 基于/ 监督/ 式/ 学习/ 和/ 非/ 监督/ 式/ 学习/ 的/ 用户/ 数据库/ 访问/ 模式分析/ 方法/ ./ 基于/ 监督/ 式/ 学习/ 的/ 方法/ 根据/ 用户/ 角色/ ,/ 使用/ 朴素/ 贝叶斯/ 模型/ 为/ 每类/ 角色/ 构建/ 正常/ 的/ 数据库/ 访问/ 模式/ ./ 而/ 基于/ 非/ 监督/ 式/ 学习/ 的/ 方法/ 在/ 用户/ 角色/ 未知/ 的/ 情况/ 下/ ,/ 根据/ 用户/ 标识/ ,/ 使用/ 标准/ 的/ 聚类/ 技术/ 分别/ 为/ 每个/ 用户/ 构建/ 典型/ 的/ 数据库/ 访问/ 行为/ ,/ 例如/ 将/ 规模/ 最大/ 的/ 聚类/ 作为/ 用户/ 的/ 正常/ 行为/ 模式/ ./ Mathew/ 等/ 人/ [/ 1/ ]/ 和/ Islam/ 等/ 人/ [/ 13/ ]/ 同样/ 基于/ 用户/ 角色/ ,/ 分别/ 使用/ k/ -/ means/ 聚类/ 技术/ 和/ 隐/ 马尔可夫/ 模型/ 构建/ 用户/ 数据库/ 查询/ 行为/ 模式/ ./ 而/ Maxion/ 等/ 人/ [/ 2/ ]/ 和/ Kholidy/ 等/ 人/ [/ 8/ ]/ 根据/ 用户/ 标示/ ,/ 分别/ 使用/ 朴素/ 贝叶斯/ 文本/ 分类/ 方法/ 和/ 半/ 全局/ 排列/ 算法/ 构建/ 用户/ 个性化/ 的/ 命令/ 执行/ 序列/ 模式/ ./ Zheng/ 等/ 人/ [/ 5/ ]/ 根据/ 用户/ 标示/ ,/ 使用/ 支持/ 向量/ 机/ 分类器/ 构建/ 用户/ 特征/ 的/ 鼠标/ 移动/ 模式/ ./ 与/ 以上/ 工作/ 不同/ ,/ 本文/ 方法/ 不/ 依赖于/ 任何/ 领域/ 知识/ 和/ 用户/ 背景/ ,/ 完全/ 基于/ 数据/ 驱动/ 方式/ 实现/ 用户/ 多域/ 行为/ 模式分析/ ./ 其次/ ,/ 本文/ 考虑/ 用户/ 多域/ 行为/ 的/ 多元/ 模式分析/ ,/ 而/ 以上/ 方法/ 通常/ 只是/ 分析/ 用户/ 单一/ 的/ 正常/ 行为/ 模式/ ./ 7.2/ 基于/ 多域/ 的/ 系统/ 威胁/ 检测/ 技术/ 基于/ 多域/ 的/ 系统/ 威胁/ 检测/ 工作/ 主要/ 集中/ 在/ 各域/ 检测/ 结果/ 的/ 融合/ 技术/ ./ Maloof/ 等/ 人/ [/ 12/ ]/ 提出/ 一种/ 通过/ 融合/ 多域/ 用户/ 行为/ 检测/ 结果/ 的/ 内网/ 威胁/ 检测/ 方法/ ./ 该/ 方法/ 针对/ 的/ 内部/ 恶意/ 用户/ ,/ 能够/ 利用自身/ 和/ 他人/ 的/ 合法/ 权限/ ,/ 从/ 系统/ 的/ 多个/ 方面/ 实施/ 攻击/ ./ 该/ 工作/ 在内/ 网中/ 收集/ 了/ 用户/ 在/ 多种/ 检测/ 域/ 中/ 的/ 行为/ 事件/ ,/ 包括/ 文件共享/ 、/ http/ 访问/ 、/ 邮件/ 和/ 文件传输/ 等/ 多种/ 用户/ 日志/ ./ 然后/ 基于/ 领域/ 知识/ 分别/ 为/ 每类/ 事件/ 的/ 每个/ 属性/ 设计/ 一个/ 检测器/ ./ 最后/ ,/ 设计/ 了/ 一个/ 贝叶斯/ 推理/ 网络/ 模型/ ,/ 用于/ 综合/ 所有/ 检测器/ 的/ 报警/ 信息/ 来/ 给/ 用户/ 行为/ 评分/ ./ 虽然/ 该/ 方法/ 涉及/ 多个/ 检测/ 域/ ,/ 但是/ 它/ 需要/ 分别/ 检测/ 用户/ 事件/ 各个/ 属性/ ,/ 因此/ 在/ 用户/ 行为/ 检测/ 方面/ 仍然/ 采用/ 各域/ 分离/ 的/ 用户/ 行为/ 分析/ 方式/ ./ 其次/ ,/ 该/ 方法/ 需要/ 依赖/ 一定/ 领域/ 知识/ 和/ 已知/ 异常/ 模式/ 来/ 辅助设计/ 各个/ 检测器/ ,/ 因此/ 不能/ 检测/ 未知/ 的/ 用户/ 异常/ 行为/ ./ Maggi/ 等/ 人/ [/ 20/ ]/ 提出/ 一种/ 面向/ 网络/ 入侵/ 检测/ 的/ 多域/ 报警/ 关联/ 技术/ ./ 该/ 工作/ 设计/ 了/ 一个/ 将/ 报警/ 事件/ 流/ 和/ 时间/ 戳/ 刻画/ 为/ 随机变量/ 的/ 报警/ 产生/ 统计/ 模型/ ,/ 并/ 使用/ 统计/ 测试方法/ 构建/ 了/ 用于/ 区分/ 相关/ 报警/ 和/ 无关/ 报警/ 的/ 准则/ ./ 虽然/ 该/ 方法/ 不/ 依赖/ 领域/ 知识/ 和/ 已知/ 异常/ 模式/ ,/ 但是/ 仍然/ 需要/ 基于/ 各域/ 独立/ 的/ 报警/ 结果/ 来/ 检测/ 网络/ 异常/ ./ 与/ 以上/ 工作/ 不同/ ,/ 本文/ 方法/ 在/ 用户/ 行为/ 特征/ 层面/ 融合/ 用户/ 多域/ 行为/ ,/ 能够/ 集中/ 分析/ 用户/ 多域/ 行为/ ,/ 并且/ 不/ 依赖于/ 领域/ 知识/ 和/ 已知/ 模式/ ,/ 完全/ 采用/ 数据/ 驱动/ 的/ 方式/ 进行/ 用户/ 行为/ 模式分析/ ./ 8/ 结论/ 内部/ 用户/ 行为/ 分析/ 是/ 系统安全/ 领域/ 中/ 一个/ 重要/ 的/ 研究/ 问题/ ./ 近期/ 的/ 工作/ 主要/ 集中/ 在/ 用户/ 单域/ 行为/ 分析/ 技术/ ,/ 不适/ 用于/ 多/ 检测/ 域/ 场景/ ./ 本文/ 提出/ 一种/ 新/ 的/ 用户/ 跨域/ 行为/ 模式分析/ 方法/ ./ 首先/ 基于/ 多域/ 异质/ 审计/ 日志/ 融合/ 构建/ 了/ 用户/ 多域/ 行为/ 描述/ ,/ 然后/ 设计/ 了/ 一种/ 结构化/ 的/ 用户/ 行为/ 特征提取/ 方法/ ,/ 最后/ 完全/ 基于/ 数据/ 驱动/ 的/ 方式/ 分析/ 用户/ 行为/ 多元/ 模式/ ./ 应用/ 方面/ ,/ 我们/ 设计/ 了/ 一个/ 基于/ 本文/ 用户/ 行为/ 模式分析/ 的/ 内部/ 攻击/ 检测/ 方法/ ./ 在/ 实验/ 中/ ,/ 我们/ 使用/ 本文/ 方法/ 分析/ 了/ 真实/ 场景/ 中/ 的/ 5/ 种/ 用户/ 审计/ 日志/ ,/ 实验/ 结果/ 验证/ 了/ 本文/ 分析方法/ 在/ 多/ 检测/ 域/ 场景/ 分析/ 用户/ 行为/ 多元/ 模式/ 的/ 有效性/ ,/ 本文/ 检测/ 方法/ 优于/ 单域/ 检测/ 方法/ 和/ 典型/ 的/ 基于/ 单一/ 用户/ 行为/ 模式/ 的/ 检测/ 方法/ ./ 

