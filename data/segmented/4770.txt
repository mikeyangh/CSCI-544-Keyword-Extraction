Page1/ 分布式/ 大/ 数据/ 多/ 函数/ 依赖/ 冲突检测/ 李卫榜/ 李战怀/ 姜涛/ (/ 西北工业大学/ 计算机/ 学院/ 西安/ 710072/ )/ 摘要/ 关系数据库/ 数据/ 质量/ 的/ 一个/ 主要/ 问题/ 是/ 存在/ 数据/ 不/ 一致/ 现象/ ./ 为/ 找出/ 不/ 一致/ 数据/ ,/ 需要/ 进行/ 函数/ 依赖/ 冲突检测/ ./ 集中式/ 数据库/ 中/ 可以/ 通过/ SQL/ 技术/ 检测/ 不/ 一致/ 情况/ ,/ 而/ 分布式/ 环境/ 下/ 的/ 函数/ 依赖/ 冲突检测/ 更/ 富有/ 挑战性/ ,/ 特别/ 是/ 大/ 数据/ 背景/ 下/ ,/ 这个/ 问题/ 尤为/ 突出/ ./ 分布式/ 环境/ 下/ 的/ 函数/ 依赖/ 冲突检测/ 通常/ 需要/ 进行/ 数据/ 迁移/ ,/ 而且/ 不同/ 的/ 数据/ 迁移/ 方法/ 会/ 对/ 检测/ 效率/ 产生/ 一定/ 的/ 影响/ ./ 该文/ 提出/ 了/ 一种/ 基于/ 等价/ 类/ 的/ 分布式/ 环境/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 方法/ ,/ 给出/ 了/ 冲突检测/ 的/ 响应/ 时间/ 代价/ 模型/ ./ 由于/ 分布式/ 环境/ 函数/ 依赖/ 冲突检测/ 问题/ 的/ 任务分配/ 问题/ 为/ NP/ -/ 难/ 问题/ ,/ 多项式/ 时间/ 内/ 难以/ 得到/ 最优/ 解/ ,/ 该文/ 将/ 不一致性/ 检测/ 响应/ 时间/ 最小化/ 问题/ 转化/ 为/ 整数/ 规划/ 问题/ ,/ 并/ 给出/ 了/ 近似/ 最优/ 解/ ./ 针对/ 集群/ 规模/ 和/ 函数/ 依赖/ 个数/ 大小/ 不同/ 的/ 情况/ ,/ 分别/ 给出/ 了/ 不同/ 的/ 任务分配/ 策略/ ,/ 并/ 在/ 检测/ 过程/ 中/ 实现/ 了/ 动态/ 负载/ 均衡/ ,/ 有效/ 提高/ 了/ 负载/ 均衡/ 度/ 和/ 检测/ 效率/ ./ 在/ 真实/ 和/ 人工/ 数据/ 集上/ 的/ 实验/ 表明/ ,/ 相对/ 于/ 集中式/ 检测/ 方法/ 以及/ 基于/ Hadoop/ 的/ nave/ 方法/ ,/ 该文/ 提出/ 的/ 多/ 函数/ 依赖/ 冲突检测/ 方法/ 检测/ 效率/ 有/ 明显/ 的/ 提升/ ,/ 且/ 在/ 数据/ 规模/ 、/ 节点/ 个数/ 和/ 函数/ 依赖/ 个数/ 等/ 方面/ 扩展/ 性能/ 良好/ ./ 关键词/ 函数/ 依赖/ ;/ 冲突检测/ ;/ 不一致性/ ;/ 分布式/ 数据/ ;/ 大/ 数据/ 1/ 引言/ 数据管理/ 最/ 重要/ 的/ 问题/ 之一/ 是/ 数据/ 质量/ 问题/ [/ 1/ ]/ ,/ 其中/ 不一致性/ 检测/ 是/ 数据/ 质量/ 的/ 一个/ 重要/ 内容/ ./ 对于/ 完整性/ 约束/ 函数/ 依赖/ 来说/ ,/ 由于/ 数据管理/ 不/ 规范/ 等/ 问题/ ,/ 违反/ 函数/ 依赖/ 的/ 情况/ 十分/ 普遍/ ,/ 而且/ 在/ 数据/ 融合/ 等/ 场合/ ,/ 也/ 经常/ 会/ 遇到/ 违反/ 函数/ 依赖/ 的/ 情况/ ./ 数据/ 特别/ 是/ 重要/ 数据/ 对/ 其/ 质量/ 有着/ 极高/ 的/ 要求/ ,/ 违反/ 函数/ 依赖/ 的/ 数据/ 如果/ 不/ 进行/ 处理/ ,/ 可能/ 会/ 付出/ 很大/ 的/ 代价/ ./ 表/ 1EMP/ 的/ 一个/ 实例/ 犇/ 0IDENOENAMETITLESALPNO1E1M/ ./ SmithSyst/ ./ Anal/ ./ 3500P1DatabaseDevelopManager362E1M/ ./ SmithElec/ ./ Eng/ ./ 2600P23E2J/ ./ JonesProgrammer2500P24E2J/ ./ JonesAnalyst3300P3Instrumentation5E2J/ ./ DavisMech/ ./ Eng/ ./ 2700P1DatabaseDevelopEngineer246E3F/ ./ LeeProgrammer2800P3InstrumentationProgrammer187E3F/ ./ LeeAnalyst3800P28E4F/ ./ LeeMech/ ./ Eng/ ./ 2500P1DatabaseDevelopEngineer369E5B/ ./ CaseyAnalyst3300P1DatabaseDevelopManager2410E5D/ ./ CaseyProgrammer2800P3InstrumentationProgrammer12/ 为了/ 检测/ 不一致性/ ,/ 在/ 关系/ 表/ EMP/ 上/ 定义/ 了/ 如下/ 几个/ 函数/ 依赖/ (/ FunctionalDependency/ ,/ FD/ )/ 作为/ 数据/ 质量/ 规则/ :/ φ/ 1/ :/ ENO/ →/ ENAME/ φ/ 2/ :/ PNO/ →/ PNAME/ φ/ 3/ :/ TITLE/ →/ SAL/ φ/ 4/ :/ TITLE/ →/ RESP/ φ/ 5/ :/ ENO/ ,/ PNO/ →/ DUR/ 这里/ φ/ 1/ 声明/ 了/ 工号/ 唯一/ 决定/ 员工/ 姓名/ ,/ φ/ 2/ 声明/ 了/ 项目编号/ 唯一/ 决定/ 项目名称/ ,/ φ/ 3/ 表示/ 头衔/ 唯一/ 确定/ 薪水/ ,/ φ/ 4/ 表示/ 头衔/ 唯一/ 确定/ 职责/ ,/ φ/ 5/ 表示/ 工号/ 和/ 项目编号/ 联合/ 确定/ 持续/ 时长/ ./ 为/ 找出/ 表/ 1/ 中/ 存在/ 的/ 不/ 一致/ 数据/ ,/ 需要/ 找出/ 其中/ 违反/ 函数/ 依赖/ 集合/ {/ φ/ 1/ ,/ φ/ 2/ ,/ φ/ 3/ ,/ φ/ 4/ ,/ φ/ 5/ }/ 的/ 元组/ ./ D0/ 中/ id/ 为/ i/ 的/ 元组/ 用/ ti/ 表示/ ,/ 则/ 在/ D0/ 中有/ 如下/ 元组/ 存在/ 冲突/ :/ t3/ ,/ t4/ ,/ t5/ ,/ t6/ ,/ t7/ ,/ t8/ ,/ t9/ ,/ t10/ ./ 其中/ 元组/ t3/ ,/ t4/ 和/ 为/ 提高/ 数据/ 质量/ ,/ 通常/ 需要/ 对/ 数据/ 进行/ 不一致性/ 检测/ ./ 不一致性/ 检测/ 对于/ 集中式/ 数据/ 来说/ 较为/ 容易/ ,/ 如/ 函数/ 依赖/ 冲突检测/ 可以/ 使用/ 一种/ 基于/ SQL/ 技术/ 的/ 检测/ 方法/ [/ 2/ ]/ ./ 然而/ 现实/ 中/ 的/ 数据/ 并/ 不/ 都/ 是/ 集中式/ 分布/ 的/ ,/ 可能/ 被/ 切分/ 并/ 分布/ 在/ 不同/ 的/ 机器/ 上/ [/ 3/ ]/ ./ 例/ 1/ ./ 考虑/ 如下/ 一个/ 关系/ 表/ EMP/ (/ ID/ ,/ ENO/ ,/ ENAME/ ,/ TITLE/ ,/ SAL/ ,/ PNO/ ,/ PNAME/ ,/ RESP/ ,/ DUR/ )/ ,/ 每/ 一个/ 员工/ 元组/ 包含/ 了/ ID/ 、/ 工号/ 、/ 姓名/ 、/ 头衔/ 、/ 薪水/ 、/ 项目编号/ 、/ 项目名称/ 、/ 职责/ 、/ 持续/ 时长/ 等/ 内容/ ./ 这里/ ID/ 是/ 关系/ 表/ EMP/ 的/ 主键/ ,/ EMP/ 的/ 一个/ 实例/ D0/ 如表/ 1/ 所示/ ./ t5/ 违反/ 函数/ 依赖/ φ/ 1/ :/ 元组/ t3/ ,/ t4/ 和/ t5/ 工号/ 相同/ ,/ 员工/ 姓名/ 不同/ ./ 同理/ ,/ 元组/ t9/ 和/ t10/ 违反/ 函数/ 依赖/ φ/ 1/ ./ 元组/ t3/ 和/ t6/ 违反/ 函数/ 依赖/ φ/ 3/ :/ 元组/ t3/ 和/ t6/ 头衔/ 相同/ ,/ 薪水/ 不同/ ./ 同理/ ,/ 元组/ t4/ 和/ t7/ 违反/ 函数/ 依赖/ φ/ 3/ ,/ 元组/ t5/ 和/ t8/ 违反/ 函数/ 依赖/ φ/ 3/ ;/ 元组/ t4/ ,/ t7/ 和/ t9/ 违反/ 函数/ 依赖/ φ/ 4/ ./ 在/ 集中式/ 环境/ ,/ 数据分布/ 在/ 一个/ 机器/ 上/ ,/ 在/ 进行/ 函数/ 依赖/ 冲突检测/ 时/ ,/ 可以/ 使用/ 已有/ 的/ 基于/ SQL/ 的/ 方法/ 进行/ 检测/ [/ 1/ ]/ ./ 在/ 数据/ 规模/ 较大/ 或者/ 待/ 检测/ 函数/ 依赖/ 个数/ 较/ 多/ 的/ 情况/ 下/ ,/ 传统/ 的/ 集中式/ 函数/ 依赖/ 冲突检测/ 方法/ 还/ 存在/ 检测/ 效率/ 低下/ 的/ 问题/ ./ 如果/ 数据/ 不是/ 集中/ 分布/ ,/ 而是/ 分布/ 在/ 不同/ 的/ 节点/ ,/ 则/ 传统/ 的/ 检测/ 方法/ 无法/ 直接/ 使用/ ./ 一种/ nave/ 的/ 方法/ 是/ 将/ 所有/ 待/ 检测/ 数据/ 迁移/ 到/ 一个/ 节点/ ,/ 在/ 该/ 节点/ 使用/ 集中式/ 方法/ 进行/ 检测/ ./ 这种/ 方法/ 存在/ 如下/ 几个/ 方面/ 的/ 问题/ :/ 一是/ 需要/ 数据/ 的/ 迁移/ ,/ 在/ 数据/ 规模/ 很/ Page3/ 大/ 的/ 情况/ 下/ ,/ 数据/ 迁移/ 耗时/ 也/ 比较/ 可观/ ;/ 二是/ 传统/ 的/ 方法/ 每/ 检测/ 一个/ 函数/ 依赖/ ,/ 都/ 需要/ 将/ 所有/ 数据/ 遍历/ 一次/ ,/ 在/ 函数/ 依赖/ 个数/ 比较/ 多/ 的/ 情况/ 下/ ,/ 效率/ 比较/ 低下/ ;/ 三是/ 所有/ 的/ 检测/ 任务/ 都/ 在/ 一个/ 节点/ 进行/ ,/ 负载/ 严重/ 的/ 不/ 均衡/ ,/ 效率/ 较/ 低/ ./ 以表/ 1/ 中/ 的/ 数据/ 实例/ D0/ 为例/ ,/ 其/ 数据/ 被/ 水平/ 切/ 分成/ 3/ 个/ 部分/ ,/ 分别/ 如表/ 2/ 、/ 表/ 3/ 和表/ 4/ 所示/ ,/ 其中/ 分片/ DH1/ 、/ DH2/ 和/ DH3/ 分别/ 分布/ 在/ 站点/ S1/ 、/ S2/ 和/ S3/ 上/ ./ 为/ 检测/ 违反/ 函数/ 依赖/ φ/ 1/ 的/ 元组/ ,/ 需要/ 进行/ 数据/ 迁移/ ,/ 数据/ 迁移/ 的/ 原则/ 是/ 函数/ 依赖/ 左端/ 属性/ 值/ 相同/ 的/ 元组/ 迁移/ 到/ 同一个/ 节点/ ./ 迁移/ 的/ 方案/ 有/ 多种/ :/ (/ 1/ )/ 从/ 站点/ S2/ 迁移/ 元组/ t7/ 到/ S1/ ,/ 从/ 站点/ S3/ 迁移/ 元组/ 表/ 2/ 犇/ 0/ 的/ 一个/ 水平/ 划分/ 的/ 片段/ 犇/ 犎/ 1IDENOENAMETITLESALPNO1E1M/ ./ SmithSyst/ ./ Anal/ ./ 3500P1DatabaseDevelopManager365E2J/ ./ DavisMech/ ./ Eng/ ./ 2700P1DatabaseDevelopEngineer248E4F/ ./ LeeMech/ ./ Eng/ ./ 2500P1DatabaseDevelopEngineer369E5B/ ./ CaseyAnalyst3300P1DatabaseDevelopManager24/ 表/ 3/ 犇/ 0/ 的/ 一个/ 水平/ 划分/ 的/ 片段/ 犇/ 犎/ 2IDENOENAMETITLESALPNO2E1M/ ./ SmithElec/ ./ Eng/ ./ 2600P23E2J/ ./ JonesProgrammer2500P27E3F/ ./ LeeAnalyst3800P2/ 表/ 4/ 犇/ 0/ 的/ 一个/ 水平/ 划分/ 的/ 片段/ 犇/ 犎/ 3IDENOENAMETITLESALPNO4E2J/ ./ JonesAnalyst3300P3Instrumentation6E3F/ ./ LeeProgrammer2800P3InstrumentationProgrammer1810E5D/ ./ CaseyProgrammer2800P3InstrumentationProgrammer12/ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 了/ 分布式/ 环境/ 下/ 多个/ 函数/ 依赖/ 不一致性/ 检测/ 响应/ 时间/ 代价/ 模型/ ./ 由于/ 分布式/ 环境/ 不一致性/ 检测/ 最小化/ 响应/ 时间/ 问题/ 为/ NP/ -/ 难/ 问题/ ,/ 无法/ 在/ 多项式/ 时间/ 得到/ 最优/ 解/ ,/ 本文/ 基于/ 该/ 模型/ 给出/ 了/ 近似/ 最优/ 并行/ 检测/ 方法/ ./ (/ 2/ )/ 将/ 等价/ 类/ 引入/ 到/ 函数/ 依赖/ 的/ 冲突检测/ ,/ 给出/ 了/ 基于/ 等价/ 类/ 的/ 冲突检测/ 的/ 优化/ 策略/ ,/ 有效/ 提高/ 检测/ 效率/ ./ (/ 3/ )/ 为/ 避免/ 检测/ 过程/ 中负载/ 不/ 均衡/ 的/ 情况/ ,/ 在/ 检测/ 过程/ 中/ 动态/ 均衡/ 负载/ ,/ 为/ 减少/ 负载/ 迁移/ 量/ ,/ 将/ 该/ 问题/ 划归/ 为/ 二次/ 规划/ 问题/ ,/ 并/ 采用/ 拉格朗/ 日/ 算子/ 法/ 得到/ 最优/ 解/ ./ (/ 4/ )/ 对/ 本文/ 提出/ 的/ 方法/ 基于/ 真实/ 和/ 人工/ 数据/ 集/ 进行/ 了/ 对比/ 实验/ 验证/ ./ 实验/ 结果表明/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 数据/ 扩展性/ 、/ 集群/ 节点/ 扩展性/ 以及/ 函数/ 依赖/ 规/ t3/ 到/ S1/ ,/ 从/ 站点/ S1/ 迁移/ 元组/ t9/ 到/ S3/ ;/ (/ 2/ )/ 从/ 站点/ S1/ 迁移/ 元组/ t5/ 到/ S2/ ,/ 从/ 站点/ S3/ 迁移/ 元组/ t4/ 到/ S2/ ,/ 从/ 站点/ S1/ 迁移/ 元组/ t9/ 到/ S3/ ;/ (/ 3/ )/ 从/ 站点/ S1/ 迁移/ 元组/ t5/ 到/ S3/ ,/ 从/ 站点/ S2/ 迁移/ 元组/ t7/ 到/ S3/ ,/ 从/ 站点/ S3/ 迁移/ 元组/ t10/ 到/ S1/ ;/ 等等/ ./ 从/ 这个/ 例子/ 可以/ 看出/ ,/ 与/ 集中式/ 环境/ 不同/ ,/ 在/ 分布式/ 环境/ 下/ ,/ 不/ 一致/ 数据/ 冲突检测/ 通常/ 需要/ 数据/ 的/ 迁移/ ,/ 因此/ 集中式/ 环境/ 下/ 的/ 检测/ 方法/ 不适/ 用于/ 分布式/ 环境/ 下/ 的/ 不一致性/ 检测/ ./ 针对/ 分布式/ 环境/ 大/ 数据/ 背景/ 下/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 问题/ ,/ 本文/ 提出/ 了/ 算法/ MultiFDsDetDS/ ,/ 基于/ Hadoop/ 和/ Hama/ 平台/ ,/ 实现/ 分布式/ 环境/ 大/ 数据/ 多个/ 函数/ 依赖/ 的/ 并行/ 冲突检测/ ,/ 有效/ 提高/ 检测/ 的/ 效率/ ./ 模/ 扩展性/ 方面/ 均/ 表现/ 良好/ ./ 2/ 相关/ 工作/ 函数/ 依赖/ 作为/ 关系数据库/ 中/ 的/ 一种/ 完整性/ 约束/ ,/ 反映/ 了/ 不同/ 属性/ 之间/ 的/ 一种/ 制约/ 关系/ ,/ 其/ 概念/ 最早/ 由/ Armstrong/ 提出/ [/ 1/ ]/ ./ 函数/ 依赖/ 冲突/ 在/ 现实/ 世界/ 中/ 十分/ 常见/ ,/ 特别/ 是/ 在/ Web/ 数据/ 抽取/ 、/ 数据/ 融合/ 等/ 场合/ 更为/ 常见/ ./ 当前/ 针对/ 分布式/ 环境/ 违反/ 完整性/ 约束/ 进行/ 检测/ 的/ 相关/ 文献/ 还/ 比较/ 少/ ,/ Fan/ 等/ 人/ 针对/ 条件/ 函数/ 依赖/ (/ CFD/ )/ 在/ 分布式/ 数据/ 上/ 的/ 不一致性/ 问题/ 进行/ 了/ 研究/ [/ 4/ ]/ ,/ 给出/ 了/ 几种/ 不一致性/ 检测/ 算法/ ,/ 并/ 利用/ 条件/ 函数/ 依赖/ 的/ 结构/ 特点/ 减少/ 数据/ 迁移/ 或/ 响应/ 时间/ ./ 条件/ 函数/ 依赖/ 是/ 对/ 传统/ 函数/ 依赖/ 的/ 一种/ 扩展/ [/ 5/ ]/ ,/ 对/ 函数/ 依赖/ 的/ 左部/ (/ LHS/ )/ 加以/ 条件/ 限制/ ,/ 然后/ 在/ 一定/ 条件/ 的/ 基础/ 上/ 使用/ 传统/ 的/ 函数/ 依赖/ ./ 然而/ 条件/ 函/ Page4/ 数/ 依赖/ 和/ 传统/ 的/ 函数/ 依赖/ 有着/ 很大/ 的/ 不同/ ,/ 没有/ 条件/ 函数/ 依赖/ 的/ 模式/ 表/ (/ patterntable/ )/ ,/ 因此/ 无法/ 使用/ 针对/ CFD/ 的/ 分布式/ 数据/ 不一致性/ 检测/ 方法/ 检测/ 传统/ 函数/ 依赖/ 的/ 冲突/ ./ Fan/ 还/ 提出/ 一种/ 分布式/ 环境/ CFD/ 不一致性/ 增量/ 检测/ 方法/ ,/ 针对/ 数据/ 规模/ 动态变化/ 的/ 情况/ ,/ 检测/ CFD/ 的/ 不一致性/ [/ 6/ ]/ ./ 文献/ [/ 7/ -/ 8/ ]/ 对/ 分布式/ 数据库/ 中/ 完整性/ 约束/ 的/ 检测/ 问题/ 进行/ 了/ 相关/ 的/ 研究/ ./ 文献/ [/ 7/ ]/ 研究/ 了/ 在/ 仅/ 访问/ 局部/ 关系/ 的/ 情况/ 下/ 对/ 基本/ 关系/ 更新/ 时/ 全局/ 不一致性/ 检测/ 的/ 问题/ ./ 文献/ [/ 9/ ]/ 中/ 给出/ 了/ 完整性/ 约束/ 检测/ 的/ 本地/ 条件/ ,/ 认为/ 如果/ 本地/ 数据/ 满足/ 这些/ 条件/ ,/ 则/ 全局/ 数据/ 也/ 同样/ 满足/ ,/ 因此/ 无需/ 进行/ 数据/ 的/ 迁移/ ,/ 这样/ 可以/ 有效/ 减少/ 通信/ 代价/ ./ 文献/ [/ 10/ ]/ 对/ 数据/ 融合/ 中/ 数据/ 冲突/ 的/ 解析/ 展开/ 了/ 相关/ 研究/ ,/ 主要/ 针对/ 的/ 是/ 集中式/ 环境/ 下/ 的/ 冲突/ 问题/ ./ 文献/ [/ 11/ -/ 12/ ]/ 对/ 分布式/ 数据源/ 的/ 异常/ 检测/ 问题/ 进行/ 了/ 研究/ ./ 文献/ [/ 11/ ]/ 提出/ 了/ 一种/ 针对/ 包含/ 混合/ 属性数据/ 集/ 的/ 快速/ 分布式/ 异常/ 检测/ 策略/ ./ 这些/ 方法/ 主要/ 针对/ 的/ 是/ 异常/ 检测/ ,/ 主要/ 目标/ 是从/ 给定/ 的/ 数据源/ 中/ 找到/ 异常情况/ ./ 与/ 之/ 不同/ ,/ 函数/ 依赖/ 冲突检测/ 主要/ 是/ 检测/ 函数/ 依赖/ 约束/ 的/ 违反/ 情况/ ./ 文献/ [/ 13/ -/ 14/ ]/ 对/ 函数/ 依赖/ 冲突/ 的/ 修复/ 进行/ 了/ 相关/ 研究/ ./ 为了/ 对/ 存在/ 违反/ 函数/ 依赖/ 情况/ 的/ 不/ 一致/ 数据/ 进行/ 修复/ ,/ 通常/ 采用/ 对/ 属性/ 值/ 进行/ 修改/ 的/ 方法/ ./ 与/ 本文/ 工作/ 不同/ ,/ 这些/ 文献/ 主要/ 关注/ 的/ 是/ 函数/ 依赖/ 冲突/ 的/ 修复/ 问题/ ./ 文献/ [/ 15/ -/ 16/ ]/ 研究/ 了/ 函数/ 依赖/ 发现/ 的/ 问题/ ,/ 主要/ 是/ 研究/ 给定/ 一个/ 模式/ ,/ 如何/ 发现/ 隐含/ 的/ 约束/ 关系/ ./ 3/ 预备/ 知识/ 3.1/ 函数/ 依赖/ 定义/ 1/ ./ 给定/ 关系/ R/ ,/ Attrs/ (/ R/ )/ 为/ R/ 上/ 所有/ 属性/ 的/ 集合/ ,/ X/ ,/ Y/ / Attrs/ (/ R/ )/ ./ 函数/ 依赖/ (/ FunctionalDependency/ ,/ FD/ )/ 是/ 定义/ 在/ R/ 上/ 的/ 一个/ 约束/ ,/ 用/ X/ →/ Y/ 表示/ ./ 函数/ 依赖/ X/ →/ Y/ 成立/ 当且/ 仅/ 当/ 对/ / ti/ ,/ tj/ ∈/ R/ ,/ 如果/ ti/ [/ X/ ]/ =/ tj/ [/ X/ ]/ ,/ 则/ 必然/ 有/ ti/ [/ Y/ ]/ =/ tj/ [/ Y/ ]/ ./ 对于/ 函数/ 依赖/ X/ →/ Y/ ,/ 我们/ 称/ X/ 为/ 其/ 左部/ (/ LeftHandSide/ ,/ LHS/ )/ ,/ 相应/ 的/ Y/ 为/ 其右部/ (/ RightHandSide/ ,/ RHS/ )/ ./ 如果/ 函数/ 依赖/ 的/ LHS/ 与/ RHS/ 交集/ 为空/ ,/ 称该/ 函数/ 依赖/ 为/ 非/ 平凡/ 函数/ 依赖/ ./ 本文/ 中仅/ 考虑/ 非/ 平凡/ 多个/ 函数/ 依赖/ 的/ 冲突检测/ 问题/ ./ 3.2/ 等价/ 类/ 定义/ 2/ ./ 等价/ 类/ (/ EquivalenceClass/ ,/ EC/ )/ ./ 假定/ X/ / Attr/ (/ R/ )/ 为/ 关系/ R/ 上/ 的/ 一个/ 属性/ 集合/ ,/ 其中/ Attr/ (/ R/ )/ 为/ 关系/ R/ 的/ 所有/ 属性/ 集合/ ,/ 我们/ 称/ 元组/ t/ ∈/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 等价/ 类为/ [/ t/ ]/ X/ =/ {/ p/ ∈/ R/ |/ 对/ 所有/ A/ ∈/ X/ ,/ 有/ p/ [/ A/ ]/ =/ t/ [/ A/ ]/ }/ ,/ 这里/ t/ [/ A/ ]/ 为/ 元组/ t/ 在/ 属性/ A/ 上/ 的/ 值/ ./ 例/ 2/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ D0/ 为例/ ,/ 属性/ ENO/ 在/ 元组/ 1/ 和/ 2/ 上/ 有着/ 相同/ 的/ 属性/ 值/ E1/ ,/ 因此/ 元组/ 1/ 和/ 2/ 构成/ 等价/ 类/ {/ 1/ ,/ 2/ }/ ,/ 这里/ 我们/ 用/ 元组/ 的/ ID/ 值/ 代表/ 元组/ ./ 同理/ ,/ 元组/ 3/ 、/ 4/ 和/ 5/ 在/ ENO/ 上/ 有着/ 相同/ 的/ 属性/ 值/ E2/ ,/ 因此/ 构成/ 等价/ 类/ {/ 3/ ,/ 4/ ,/ 5/ }/ ./ 定义/ 3/ ./ 局部/ 等价/ 类/ (/ LocalEquivalenceClass/ ,/ LEC/ )/ ./ 假定/ X/ / Attr/ (/ R/ )/ 为/ 关系/ R/ 上/ 的/ 一个/ 属性/ 集合/ ,/ 其中/ Attr/ (/ R/ )/ 为/ 关系/ R/ 的/ 所有/ 属性/ 集合/ ,/ 关系/ R/ 的/ 实例/ D/ 被/ 横向/ 切/ 分为/ n/ 块/ ,/ D/ =/ D1/ ∪/ …/ ∪/ Dn/ ,/ 我们/ 称/ 元组/ t/ ∈/ Di/ 在/ 属性/ 集合/ X/ 上/ 的/ 等价/ 类为/ 局部/ 等价/ 类/ ,/ 表示/ 为/ [/ t/ ]/ Xi/ =/ {/ p/ ∈/ Di/ |/ 对/ 所有/ A/ ∈/ X/ ,/ 有/ p/ [/ A/ ]/ =/ t/ [/ A/ ]/ }/ ,/ 这里/ t/ [/ A/ ]/ 为/ 元组/ t/ 在/ 属性/ A/ 上/ 的/ 值/ ./ 定义/ 4/ ./ 划分/ (/ Partition/ )/ ./ 假定/ X/ / Attr/ (/ R/ )/ 为/ 关系/ R/ 上/ 的/ 一个/ 属性/ 集合/ ,/ 定义/ Π/ X/ =/ {/ [/ t/ ]/ X/ |/ t/ ∈/ R/ }/ 为/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 一个/ 划分/ ./ 根据/ 等价/ 类/ 和/ 划分/ 的/ 定义/ 可以/ 看出/ ,/ 划分/ Π/ X/ 由/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 不/ 相交/ 的/ 等价/ 类/ 组成/ ,/ 每/ 一个/ 等价/ 类内/ 的/ 元组/ 在/ 属性/ 集合/ X/ 上/ 有着/ 相同/ 的/ 属性/ 值/ ,/ 不同/ 的/ 等价/ 类/ 在/ X/ 上/ 的/ 属性/ 值/ 不同/ ,/ 而/ 等价/ 类/ 的/ 并/ 集/ 与/ 关系/ R/ 等价/ ./ 例/ 3/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ D0/ 为例/ ,/ 关系/ EMP/ 在/ 属性/ ENO/ 上/ 的/ 划分/ 为/ {/ {/ 1/ ,/ 2/ }/ ,/ {/ 3/ ,/ 4/ ,/ 5/ }/ ,/ {/ 6/ ,/ 7/ }/ ,/ {/ 8/ }/ ,/ {/ 9/ ,/ 10/ }/ }/ ,/ 关系/ EMP/ 在/ 属性/ 集合/ {/ ENO/ ,/ ENAME/ }/ 的/ 划分/ 为/ {/ {/ 1/ ,/ 2/ }/ ,/ {/ 3/ ,/ 4/ }/ ,/ {/ 5/ }/ ,/ {/ 6/ ,/ 7/ }/ ,/ {/ 8/ }/ ,/ {/ 9/ }/ ,/ {/ 10/ }/ }/ ./ 引理/ 1/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ Π/ X/ 为/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 一个/ 划分/ ,/ 则/ 有/ Π/ X/ 中/ 所有/ 等价/ 类/ 包含/ 的/ 元组/ 个数/ 之/ 和/ 等于/ 关系/ R/ 包含/ 的/ 总/ 的/ 元组/ 个数/ ,/ 即/ Σ/ |/ [/ t/ ]/ X/ |/ =/ |/ R/ |/ ,/ 其中/ [/ t/ ]/ X/ ∈/ Π/ X/ ./ 证明/ ./ 假设/ Σ/ |/ [/ t/ ]/ X/ |/ ≠/ |/ R/ |/ ,/ 则/ 有/ Σ/ |/ [/ t/ ]/ X/ |/ >/ |/ R/ |/ 或者/ Σ/ |/ [/ t/ ]/ X/ |/ </ |/ R/ |/ ./ 根据/ 定义/ 2/ ,/ [/ t/ ]/ X/ 中/ 元组/ 均/ 为/ R/ 中/ 的/ 元组/ ,/ 且/ 不同/ 等价/ 类/ 之间/ 不/ 存在/ 交集/ ,/ 因此/ ,/ Σ/ |/ [/ t/ ]/ X/ |/ / |/ R/ |/ ,/ 故/ Σ/ |/ [/ t/ ]/ X/ |/ >/ |/ R/ |/ 不/ 成立/ ./ 又/ 根据/ 定义/ 4/ ,/ 划分/ Π/ X/ 中/ 包含/ 了/ 所有/ 的/ 等价/ 类/ [/ t/ ]/ X/ ,/ 而/ 等价/ 类/ 又/ 是/ 在/ R/ 的/ 所有/ 元组/ 上/ 进行/ 定义/ 的/ ,/ 因此/ 所有/ 等价/ 类中/ 元组/ 个数/ 之/ 和/ 不少/ 于/ R/ 中/ 元组/ 个数/ ,/ 因此/ 有/ Page5/ Σ/ |/ [/ t/ ]/ X/ |/ / |/ R/ |/ ,/ 故/ Σ/ |/ [/ t/ ]/ X/ |/ </ |/ R/ |/ 不/ 成立/ ./ 综上/ ,/ 假设/ Σ/ |/ [/ t/ ]/ X/ |/ ≠/ |/ R/ |/ 不/ 成立/ ,/ Σ/ |/ [/ t/ ]/ X/ |/ =/ |/ R/ |/ 成立/ ./ 证毕/ ./ 定义/ 5/ ./ 局部/ 划分/ (/ LocalPartition/ )/ ./ 假定/ X/ / Attr/ (/ R/ )/ 为/ 关系/ R/ 上/ 的/ 一个/ 属性/ 集合/ ,/ 关系/ R/ 的/ 实例/ D/ 被/ 横向/ 切/ 分为/ n/ 块/ ,/ D/ =/ D1/ ∪/ …/ ∪/ Dn/ ,/ 定义/ Π/ Xi/ =/ {/ [/ t/ ]/ X/ |/ t/ ∈/ Di/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ }/ 为/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 一个/ 局部/ 划分/ ./ 例/ 4/ ./ 以表/ 2/ 中/ EMP/ 的/ 一个/ 实例/ DH1/ 为例/ ,/ 关系/ EMP/ 在/ 属性/ RESP/ 上/ 的/ 划分/ 对于/ 关系/ EMP/ 来说/ 是/ 一个/ 局部/ 划分/ ,/ 为/ {/ {/ 1/ ,/ 9/ }/ ,/ {/ 5/ ,/ 8/ }/ }/ ./ 定义/ 6/ ./ 剥离/ 划分/ (/ StrippedPartition/ )/ ./ 假定/ X/ / Attr/ (/ R/ )/ 为/ 关系/ R/ 上/ 的/ 一个/ 属性/ 集合/ ,/ 定义/ Π/ X/ =/ {/ [/ t/ ]/ X/ |/ t/ ∈/ R/ ,/ |/ [/ t/ ]/ X/ |/ >/ 1/ }/ 为/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 一个/ 剥离/ 划分/ ./ 例/ 5/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ D0/ 为例/ ,/ 根据/ 定义/ 4/ ,/ 关系/ EMP/ 在/ 属性/ 集合/ {/ ENO/ ,/ ENAME/ }/ 的/ 剥离/ 划分/ 为/ 去除/ 仅/ 包含/ 一个/ 元组/ 的/ 等价/ 类后/ 的/ 等价/ 类/ 集合/ ,/ 即/ 为/ {/ {/ 1/ ,/ 2/ }/ ,/ {/ 3/ ,/ 4/ }/ ,/ {/ 6/ ,/ 7/ }/ }/ ./ 3.3/ 函数/ 依赖/ 冲突/ 函数/ 依赖/ 作为/ 完整性/ 约束/ 的/ 一种/ ,/ 其/ 冲突/ 意味着/ 违反/ 了/ 完整性/ 约束/ ./ 函数/ 依赖/ 冲突/ 在/ 现实/ 中/ 十分/ 常见/ ,/ 特别/ 是/ 在/ 数据/ 集成/ 、/ 数据/ 融合/ 以及/ Web/ 数据/ 抽取/ 应用/ 中/ ./ 定义/ 7/ ./ 函数/ 依赖/ 冲突/ ./ 给定/ 关系/ R/ 的/ 一个/ 实例/ D/ ,/ 函数/ 依赖/ φ/ :/ A/ →/ B/ ,/ 对于/ D/ 中/ 的/ 每/ 一个/ 元组/ t/ ,/ 如果/ 存在/ 一个/ 元组/ t/ 满足/ t/ (/ A/ )/ =/ t/ (/ A/ )/ 且/ t/ (/ B/ )/ ≠/ t/ (/ B/ )/ ,/ 说明/ 元组/ t/ 和/ t/ 违反/ 了/ 函数/ 依赖/ φ/ ./ 将/ D/ 上/ 违反/ φ/ 的/ 冲突/ 表示/ 为/ Viot/ (/ φ/ ,/ D/ )/ ,/ 因此/ 有/ t/ ∈/ Viot/ (/ φ/ ,/ D/ )/ ./ 假定/ Σ/ 为/ 定义/ 在/ D/ 上/ 的/ 函数/ 依赖/ 的/ 集合/ ,/ 则/ Viot/ (/ Σ/ ,/ D/ )/ 表示/ D/ 上/ 的/ 所有/ 违反/ Σ/ 中/ 函数/ 依赖/ 的/ 冲突/ ./ 用/ 符号/ Viot/ Π/ (/ φ/ ,/ D/ )/ 表示/ Π/ AViot/ (/ φ/ ,/ D/ )/ ,/ 这里/ Π/ AViot/ (/ φ/ ,/ D/ )/ 是/ Viot/ (/ φ/ ,/ D/ )/ 在/ 属性/ A/ 上/ 的/ 投影/ ,/ R/ 中/ 其他/ 属性/ 值用/ 空值/ null/ 表示/ ./ 与/ Viot/ (/ φ/ ,/ D/ )/ 相比/ ,/ Viot/ Π/ (/ φ/ ,/ D/ )/ 包含/ 数据/ 更少/ ./ 前面/ 提到/ ,/ 一个/ 关系/ R/ 的/ 任一/ 水平/ 分片/ 与/ R/ 有着/ 相同/ 的/ 模式/ ,/ 因此/ ,/ 如果/ 函数/ 依赖/ φ/ 是/ 定义/ 在/ R/ 的/ 实例/ D/ 上面/ 的/ ,/ 则/ φ/ 同样/ 也/ 是/ 定义/ 在/ D/ 的/ 各个/ 分片/ 上/ 的/ ./ 这里/ 将/ D/ 的/ 任一/ 水平/ 切片/ Di/ 上/ 违反/ 函数/ 依赖/ φ/ 的/ 冲突/ 定义/ 为/ Viot/ (/ φ/ ,/ Di/ )/ ./ 引理/ 2/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ [/ t/ ]/ X/ 为/ 在/ 属性/ 集合/ X/ 上/ 的/ 等价/ 类/ ,/ [/ t/ ]/ X/ ∪/ Y/ ,/ [/ t/ ]/ X/ ∪/ Y/ 为/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 等价/ 类/ ,/ 对/ 任意/ 两个/ 元组/ ti/ 和/ tj/ ,/ 如果/ 满足/ ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ ,/ ti/ ∈/ [/ t/ ]/ X/ ∪/ Y/ ,/ tj/ ∈/ [/ t/ ]/ X/ ∪/ Y/ ,/ 且/ [/ t/ ]/ X/ ∪/ Y/ ≠/ [/ t/ ]/ X/ ∪/ Y/ ,/ 则/ 元组/ ti/ 和/ tj/ 为/ 违反/ 函数/ 依赖/ φ/ 的/ 冲突/ 元组/ ./ 证明/ ./ 由/ ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ ,/ 可知/ 元组/ ti/ 和/ tj/ 属于/ X/ 属性/ 集合/ 上/ 的/ 同一个/ 等价/ 类/ ,/ 根据/ 等价/ 类/ 的/ 定义/ 2/ ,/ 可以/ 得到/ ti/ [/ X/ ]/ =/ tj/ [/ X/ ]/ ./ 同理/ ,/ 由/ ti/ ∈/ [/ t/ ]/ X/ ∪/ Y/ ,/ tj/ ∈/ [/ t/ ]/ X/ ∪/ Y/ ,/ 且/ [/ t/ ]/ X/ ∪/ Y/ ≠/ [/ t/ ]/ X/ ∪/ Y/ ,/ 根据/ 定义/ 2/ ,/ 可以/ 得到/ ti/ [/ X/ ∪/ Y/ ]/ ≠/ tj/ [/ X/ ∪/ Y/ ]/ ,/ 即/ 元组/ ti/ 和/ tj/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 值/ 不同/ ./ 而/ 元组/ ti/ 和/ tj/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 值/ 包含/ 了/ 在/ 属性/ 集合/ X/ 上/ 的/ 值/ ,/ 且/ 由/ 前面/ 可知/ 元组/ ti/ 和/ tj/ 在/ 属性/ 集合/ X/ 上/ 的/ 值/ 相同/ ,/ ti/ [/ X/ ∪/ Y/ ]/ 和/ tj/ [/ X/ ∪/ Y/ ]/ 去掉/ 相同/ 的/ 属性/ 值/ ti/ [/ X/ ]/ 和/ tj/ [/ X/ ]/ ,/ 剩余/ 部分/ 为/ ti/ [/ Y/ ]/ 和/ tj/ [/ Y/ ]/ ,/ 这里/ 必然/ 有/ ti/ [/ Y/ ]/ ≠/ tj/ [/ Y/ ]/ ,/ 否则/ 假定/ ti/ [/ Y/ ]/ =/ tj/ [/ Y/ ]/ ,/ 而/ 前面/ 已知/ ti/ [/ X/ ]/ =/ tj/ [/ X/ ]/ ,/ 则/ 必然/ 有/ ti/ [/ X/ ∪/ Y/ ]/ =/ ti/ [/ X/ ]/ ∪/ ti/ [/ Y/ ]/ =/ tj/ [/ X/ ∪/ Y/ ]/ ,/ 与/ 已知/ 矛盾/ ,/ 假设/ 不/ 成立/ ,/ 故/ ti/ [/ Y/ ]/ ≠/ tj/ [/ Y/ ]/ 成立/ ./ 由/ 定义/ 7/ 中/ 函数/ 依赖/ 冲突/ 的/ 界定/ ,/ 可以/ 得到/ 元组/ ti/ 和/ tj/ 为/ 违反/ 函数/ 依赖/ φ/ 的/ 冲突/ 元组/ ./ 例/ 6/ ./ 以表/ 1/ 中/ EMP/ 的/ 实例/ D0/ 为例/ ,/ 对于/ 函数/ 依赖/ φ/ 1/ :/ ENO/ →/ ENAME/ ,/ ENO/ 属性/ 值为/ “/ E2/ ”/ 的/ 等价/ 类为/ {/ 3/ ,/ 4/ ,/ 5/ }/ ,/ 对应/ 的/ 基于/ 属性/ 集合/ {/ ENO/ ,/ ENAME/ }/ 的/ 等价/ 类为/ {/ 3/ ,/ 4/ }/ 和/ {/ 5/ }/ ./ 不难看出/ ,/ 元组/ t3/ ,/ t4/ 和/ t5/ 属于/ 等价/ 类/ [/ t/ ]/ ENO/ =/ {/ 3/ ,/ 4/ ,/ 5/ }/ ,/ 而/ t3/ ,/ t4/ ∈/ [/ t/ ]/ ENO/ ∪/ ENAME/ =/ {/ 3/ ,/ 4/ }/ ,/ t5/ ∈/ [/ t/ ]/ ENO/ ∪/ ENAME/ =/ {/ 5/ }/ ,/ 根据/ 引理/ 2/ ,/ 元组/ t3/ ,/ t4/ 和/ t5/ 为/ 函数/ 依赖/ φ/ 1/ 的/ 冲突/ 元组/ ./ 3.4/ 函数/ 依赖/ 冲突检测/ 假定/ D/ 为/ R/ 的/ 实例/ ,/ D/ 被切/ 分为/ n/ 份/ ,/ 每/ 一个/ 切分/ Di/ 分布/ 在/ 不同/ 的/ 节点/ ./ 函数/ 依赖/ φ/ 是/ 定义/ 在/ R/ 上/ 的/ 一个/ 函数/ 依赖/ ,/ φ/ 的/ 冲突检测/ 问题/ 是/ 查找/ Viot/ Π/ (/ φ/ ,/ D/ )/ ./ 给定/ 函数/ 依赖/ φ/ ,/ φ/ 可以/ 在/ 本地/ 检测/ 当且/ 仅/ 当/ 满足/ Viot/ Π/ (/ φ/ ,/ D/ )/ =/ ∪/ i/ ∈/ [/ 1/ ,/ n/ ]/ Viot/ Π/ (/ φ/ ,/ Di/ )/ ./ 具有/ 最小/ 响应/ 时间/ 的/ 函数/ 依赖/ 不一致性/ 检测/ 问题/ ,/ 其/ 输入/ 是/ 一个/ 函数/ 依赖/ 的/ 集合/ Σ/ 和/ 水平/ 切分/ 的/ 关系/ R/ 的/ 实例/ D/ ,/ 响应/ 时间/ 满足/ 以下/ 条件/ :/ (/ 1/ )/ 集合/ Σ/ 中/ 的/ 函数/ 依赖/ 冲突/ 在/ 数据/ 迁移/ U/ 之后/ 可以/ 本地/ 检测/ ;/ (/ 2/ )/ 响应/ 时间/ RT/ 是/ 最小/ 的/ ./ 然而/ 找到/ 一个/ 最小/ 响应/ 时间/ 的/ 函数/ 依赖/ 检测/ 算法/ 是/ 不/ 现实/ 的/ ,/ 在/ 水平/ 切分/ 情况/ 下/ ,/ 具有/ 最小/ 响应/ 时间/ 的/ 函数/ 依赖/ 不一致性/ 检测/ 问题/ 是/ 一个/ NP/ -/ 难/ 问题/ [/ 4/ ]/ ./ 4/ 分布式/ 大/ 数据/ 多/ 函数/ 依赖/ 冲突检测/ 函数/ 依赖/ 冲突检测/ 是/ 不一致性/ 检测/ 的/ 重要/ 内容/ ./ 在/ 集中式/ 环境/ 下/ ,/ 函数/ 依赖/ 冲突检测/ 主要/ 取决于/ Page6/ 数据/ 规模/ 和/ 函数/ 依赖/ 的/ 个数/ ./ 在/ 分布式/ 大/ 数据/ 环境/ 下/ ,/ 不仅/ 需要/ 进行/ 数据/ 的/ 迁移/ ,/ 而且/ 要/ 考虑/ 如何/ 提高/ 冲突检测/ 的/ 效率/ ./ 根据/ 文献/ [/ 4/ ]/ ,/ 分布式/ 环境/ 下/ 单个/ 函数/ 依赖/ 的/ 冲突检测/ 问题/ 已经/ 是非/ 平凡/ 的/ ,/ 为/ NP/ -/ 难/ 问题/ ,/ 由此可见/ ,/ 分布式/ 环境/ 下/ 多个/ 函数/ 依赖/ 的/ 冲突检测/ 问题/ 同样/ 为/ NP/ -/ 难/ 问题/ ./ 4.1/ 方法/ CenDet/ 方法/ CenDet/ 在/ 检测/ 多个/ 函数/ 依赖/ 冲突/ 时/ ,/ 首先/ 将/ 分布式/ 数据/ 迁移/ 到/ 一个/ 节点/ ,/ 然后/ 利用/ 集中式/ 函数/ 依赖/ 冲突检测/ 方法/ 对/ 多个/ 函数/ 依赖/ 分别/ 进行/ 冲突检测/ ,/ 最终/ 得到/ 违反/ 多个/ 函数/ 依赖/ 的/ 冲突/ 元组/ ./ 在/ 具体/ 的/ 检测/ 过程/ 中/ ,/ 采用/ 流水线/ 方式/ ,/ 在/ 完成/ 一个/ 函数/ 依赖/ 冲突检测/ 后/ ,/ 进行/ 下/ 一个/ 函数/ 依赖/ 的/ 冲突检测/ ,/ 直到/ 所有/ 函数/ 依赖/ 冲突/ 全部/ 检测/ 完毕/ 为止/ ./ 方法/ CenDet/ 在/ 进行/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 时候/ ,/ 响应/ 时间/ 会/ 比较/ 长/ :/ 由于/ 检测/ 每/ 一个/ 函数/ 依赖/ 冲突/ 的/ 时候/ 都/ 需要/ 扫描/ 一遍/ 全部/ 数据/ ,/ 而/ 这种/ 扫描/ 是/ 十分/ 耗时/ 的/ ,/ 在/ 大/ 数据/ 背景/ 下/ ,/ 方法/ CenDet/ 的/ 检测/ 效率/ 较/ 低/ ,/ 响应/ 时间/ 较长/ ./ 由于/ 所有/ 检测/ 任务/ 均/ 在/ 一个/ 节点/ 进行/ ,/ 因此/ 方法/ CenDet/ 的/ 负载/ 严重/ 的/ 不/ 均衡/ ./ 函数/ 依赖/ 冲突检测/ 耗时/ 很大/ 程度/ 上/ 取决于/ 数据/ 的/ 规模/ ,/ 在/ 数据/ 规模/ 特别/ 大/ 的/ 情况/ 下/ ,/ 对/ 数据/ 的/ 每次/ 扫描时间/ 开销/ 都/ 很大/ ,/ 如果/ 能够/ 一次/ 扫描/ 全部/ 数据/ 而/ 实现/ 对/ 多个/ 函数/ 依赖/ 的/ 冲突检测/ ,/ 则/ 可以/ 大大提高/ 函数/ 依赖/ 的/ 冲突检测/ 效率/ ./ 4.2/ 方法/ MultiFDsDetDS/ 方法/ MultiFDsDetDS/ 进行/ 分布式/ 大/ 数据/ 多/ 函数/ 依赖/ 冲突检测/ 时/ ,/ 包括/ 以下/ 几个/ 步骤/ :/ (/ 1/ )/ 数据/ 预处理/ (/ 生成/ 局部/ 等价/ 类/ )/ ;/ (/ 2/ )/ 任务分配/ ;/ (/ 3/ )/ 数据/ 迁移/ ;/ (/ 4/ )/ 合并/ 得到/ 全局/ 等价/ 类/ ;/ (/ 5/ )/ 冲突检测/ ./ 给定/ 关系/ R/ 的/ 实例/ D/ ,/ 待/ 检测/ 函数/ 依赖/ 集合/ Σ/ =/ {/ φ/ 1/ ,/ φ/ 2/ ,/ …/ ,/ φ/ m/ }/ ,/ 假定/ D/ 被/ 水平/ 切/ 分为/ n/ 份/ ,/ 分别/ 为/ D1/ ,/ …/ ,/ Dn/ ,/ 不同/ 的/ 分片/ 分布/ 在/ 不同/ 的/ 节点/ ,/ 对/ / i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 分片/ Di/ 分布/ 在/ 节点/ Si/ 上/ ./ 为/ 检测/ 函数/ 依赖/ 集合/ Σ/ 中/ 函数/ 依赖/ 的/ 冲突/ 情况/ ,/ 在/ 任一/ 节点/ Si/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 方法/ MultiFDsDetDS/ 首先/ 进行/ 数据/ 的/ 预处理/ ,/ 假定/ 在/ 节点/ Si/ 数据/ 预处理/ 时间/ 为/ PreDeal/ (/ Di/ )/ ./ 数据/ 预处理/ 后/ ,/ 在/ 各个/ 节点/ 得到/ 各个/ 待/ 检测/ 函数/ 依赖/ 的/ 局部/ 等价/ 类/ ./ 完成/ 数据/ 预处理/ 后/ ,/ 方法/ MultiFDsDetDS/ 对/ 函数/ 依赖/ 的/ 冲突检测/ 任务/ 进行/ 分配/ ,/ 对/ 任一/ 函数/ 依赖/ φ/ j/ ,/ j/ ∈/ [/ 1/ ,/ m/ ]/ ,/ 执行/ 其/ 冲突检测/ 的/ 节点/ 为/ 该/ 函数/ 依赖/ 的/ 执行/ 节点/ ./ 然后/ 根据/ 任务分配/ 的/ 结果/ 进行/ 数据/ 迁移/ ,/ 将/ 与/ 每/ 一个/ 函数/ 依赖/ 相关/ 的/ 局部/ 等价/ 类/ 数据/ 迁移/ 到/ 该/ 执行/ 节点/ 上/ ./ 假定/ 任一/ 节点/ Si/ 迁出/ 的/ 数据/ 为/ Di/ -/ out/ ,/ 迁入/ 的/ 数据/ 为/ Δ/ Di/ -/ in/ ,/ 则/ 总/ 的/ 数据/ 迁移/ 量/ 为/ Δ/ D/ =/ ∑/ i/ ∈/ [/ 1/ ,/ n/ ]/ Δ/ Di/ -/ out/ =/ ∑/ i/ ∈/ [/ 1/ ,/ n/ ]/ Δ/ Di/ -/ in/ ./ 所有/ 节点/ 数据/ 迁移/ 完成/ 后/ ,/ 算法/ 根据/ 任务分配/ 情况/ 在/ 各个/ 节点/ 进行/ 局部/ 等价/ 类/ 的/ 合并/ ,/ 进而/ 得到/ 全局/ 等价/ 类/ ./ 假定/ 节点/ Si/ 局部/ 等价/ 类/ 合并/ 耗时/ 为/ merge/ (/ ECi/ )/ ,/ ECi/ 为/ 分配/ 给/ 节点/ Si/ 的/ 待/ 检测/ 函数/ 依赖/ 的/ 局部/ 等价/ 类/ 集合/ ./ 得到/ 全局/ 等价/ 类后/ ,/ 根据/ 冲突检测/ 任务分配/ 的/ 结果/ ,/ 算法/ 在/ 各个/ 节点/ 并行/ 进行/ 函数/ 依赖/ 冲突检测/ ,/ 假定/ 数据/ 迁移/ 及/ 局部/ 等价/ 类/ 合并/ 后/ 节点/ Si/ 的/ 待/ 检测/ 数据/ 为/ Di/ ,/ 冲突检测/ 耗时/ 为/ check/ (/ Di/ )/ ./ 假定/ 函数/ 依赖/ 集合/ Σ/ 冲突检测/ 总/ 的/ 响应/ 时间/ 代价/ 模型/ 为/ costRT/ (/ Σ/ )/ ,/ 这里/ 定义/ 多/ 函数/ 依赖/ 冲突检测/ 响应/ 时间/ 代价/ 模型/ 如下/ :/ costRT/ (/ Σ/ )/ =/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ PreDeal/ (/ Di/ )/ +/ 1/ 式/ 中/ PreDeal/ (/ Di/ )/ 为/ 各/ 节点/ 数据/ 预处理/ (/ 生成/ 局部/ 等价/ 类/ )/ 耗时/ ,/ n/ 为/ 节点/ 个数/ ,/ Σ/ 为/ 待/ 检测/ 函数/ 依赖/ 集合/ ,/ bw/ 为/ 网络带宽/ ,/ merge/ (/ ECi/ )/ 为/ 各/ 节点/ 局部/ 等价/ 类/ 合并/ 得到/ 全局/ 等价/ 类/ 的/ 耗时/ ,/ check/ (/ Di/ )/ 为/ 各/ 节点/ 函数/ 依赖/ 冲突检测/ 耗时/ ./ 依据/ 多/ 函数/ 依赖/ 冲突检测/ 响应/ 时间/ 代价/ 模型/ ,/ 方法/ MultiFDsDetDS/ 检测/ 多个/ 函数/ 依赖/ 冲突/ 的/ 响应/ 时间/ 取决于/ 四/ 部分/ :/ 各/ 节点/ 数据/ 预处理/ 耗时/ 即/ 生成/ 局部/ 等价/ 类/ 的/ 耗时/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ PreDeal/ (/ Di/ )/ ,/ 数据/ 迁移/ 耗时/ 1bw/ ∑/ i/ ∈/ [/ 1/ ,/ n/ ]/ Δ/ Di/ -/ in/ ,/ 各/ 节点/ 合并/ 局部/ 等价/ 类/ 得到/ 全局/ 等价/ 类/ 的/ 耗时/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ merge/ (/ ECi/ )/ ,/ 各/ 节点/ 执行/ 函数/ 依赖/ 冲突检测/ 的/ 耗时/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ check/ (/ Di/ )/ ./ 为/ 减少/ 分布式/ 环境/ 多/ 函数/ 依赖/ 冲突检测/ 的/ 响应/ 时间/ ,/ 有/ 必要/ 在/ 以上/ 各个/ 阶段/ 考虑/ 对/ 其/ 响应/ 时间/ 进行/ 优化/ ./ 第/ 1/ 步是/ 数据/ 预处理/ ,/ 在/ 各个/ 节点/ 生成/ 局部/ 等价/ 类/ ./ 假定/ 待/ 检测/ 函数/ 依赖/ 集合/ 为/ Σ/ ,/ 对/ Σ/ 中/ 每个/ 函数/ 依赖/ φ/ i/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 分别/ 基于/ 属性/ 集合/ LHS/ 和/ (/ LHS/ +/ RHS/ )/ 在/ 各个/ 节点/ 的/ 数据/ 上/ 并行计算/ 局部/ 等价/ 类/ [/ t/ ]/ LHS/ 和/ [/ t/ ]/ LHS/ ∪/ RHS/ ,/ 得到/ 形/ 如/ 〈/ key/ ,/ value/ 〉/ 的/ 键值/ 对/ ,/ 其中/ key/ 为/ 元组/ 在/ 属性/ 集合/ 上/ 的/ 属性/ 值/ 组合/ ,/ value/ 为/ 有着/ 相同/ 属性/ 值/ 组合/ 的/ 局部/ 等价/ 类/ ./ 例/ 7/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ DH1/ 为例/ ,/ Page7/ 对/ 函数/ 依赖/ φ/ 3/ :/ TITLE/ →/ SAL/ ,/ LHS/ 部分/ 为/ 属性/ 集/ {/ TITLE/ }/ ,/ (/ LHS/ +/ RHS/ )/ 部分/ 属性/ 集合/ 为/ {/ TITLE/ ,/ SAL/ }/ ./ 在/ 数据/ 预处理/ 阶段/ ,/ 在/ 节点/ S1/ 上/ 基于/ 属性/ 集合/ {/ TITLE/ }/ 得到/ 键值/ 对/ 〈/ “/ Syst/ ./ Anal/ ./ ”/ ,/ {/ 1/ }/ 〉/ ,/ 〈/ “/ Mech/ ./ Eng/ ./ ”/ ,/ {/ 5/ ,/ 8/ }/ 〉/ ,/ 〈/ “/ Analyst/ ”/ ,/ {/ 9/ }/ 〉/ ,/ 基于/ 属性/ 集合/ {/ TITLE/ ,/ SAL/ }/ 得到/ 键值/ 对/ 〈/ “/ Syst/ ./ Anal/ ._/ 3500/ ”/ ,/ {/ 1/ }/ 〉/ ,/ 〈/ “/ Mech/ ./ Eng/ ._/ 2700/ ”/ ,/ {/ 5/ }/ 〉/ ,/ 〈/ “/ Mech/ ./ Eng/ ._/ 2500/ ”/ ,/ {/ 8/ }/ 〉/ ,/ 〈/ “/ Analyst/ _/ 3300/ ”/ ,/ {/ 9/ }/ 〉/ ./ 同理/ ,/ 在/ 节点/ S2/ 及/ S3/ 上/ 进行/ 数据/ 的/ 预处理/ ./ 在/ 各/ 节点/ 并行/ 预处理/ 得到/ 各个/ 函数/ 依赖/ 的/ 局部/ 等价/ 类后/ ,/ 接下来/ 对/ 局部/ 等价/ 类/ 数据/ 进行/ 迁移/ ,/ 使得/ 相同/ 函数/ 依赖/ 的/ 所有/ 局部/ 等价/ 类/ 数据/ 迁移/ 到/ 同一/ 节点/ ,/ 如图/ 1/ 所示/ ./ 算法/ 1/ 为/ 数据/ 预处理/ 算法/ ./ 算法/ 1/ ./ PreDeal/ ./ 输入/ :/ 函数/ 依赖/ 集合/ Σ/ =/ {/ φ/ 1/ ,/ …/ ,/ φ/ m/ }/ ,/ D/ =/ (/ D1/ ,/ …/ ,/ Dn/ )/ 输出/ :/ [/ tX1/ ]/ LHS/ ,/ [/ tX1/ ∪/ Y1/ ]/ LHS/ ∪/ RHS/ ,/ …/ ,/ [/ tXm/ ]/ LHS/ ,/ 1/ ./ Map/ (/ kL/ ,/ vL/ )/ ML/ ←/ null/ ,/ Map/ (/ kL/ ∪/ R/ ,/ vL/ ∪/ R/ )/ ML/ ∪/ R/ ←/ 2/ ./ FOREACH/ φ/ j/ ∈/ Σ/ DO3/ ./ Map/ (/ kL/ ,/ vL/ )/ mL/ ←/ null/ ,/ Map/ (/ kL/ ∪/ R/ ,/ vL/ ∪/ R/ )/ mL/ ∪/ R/ ←/ 4/ ./ FOREACHt/ ∈/ DiDO/ // // 生成/ 局部/ 键值/ 对/ 5/ ./ IF/ !/ mL/ ./ containsKey/ (/ t/ (/ Xj/ )/ )/ 6/ ./ vL/ ./ add/ (/ t/ (/ ID/ )/ )/ ;/ 7/ ./ mL/ ./ put/ (/ t/ (/ Xj/ )/ ,/ vL/ )/ ;/ 8/ ./ ELSEIF/ !/ mL/ ./ get/ (/ t/ (/ Xi/ )/ )/ ./ containsKey/ (/ t/ (/ ID/ )/ )/ 9/ ./ mL/ ./ get/ (/ t/ (/ Xj/ )/ )/ ./ add/ (/ t/ (/ ID/ )/ )/ ;/ 10/ ./ IF/ !/ mL/ ∪/ R/ ./ containsKey/ (/ t/ (/ Xj/ )/ )/ 11/ ./ vL/ ∪/ R/ ./ add/ (/ t/ (/ ID/ )/ )/ ;/ 12/ ./ mL/ ∪/ R/ ./ put/ (/ t/ (/ Xj/ )/ ,/ vL/ ∪/ R/ )/ ;/ 13/ ./ ELSEIF/ !/ mL/ ∪/ R/ ./ get/ (/ t/ (/ Xj/ )/ )/ ./ containsKey/ (/ t/ (/ ID/ )/ )/ 14/ ./ mL/ ∪/ R/ ./ get/ (/ t/ (/ Xj/ )/ )/ ./ add/ (/ t/ (/ ID/ )/ )/ ;/ 15/ ./ ENDFOR/ ;/ 16/ ./ IFML/ ./ containsKey/ (/ mL/ ./ getKey/ (/ )/ )/ // // 局部/ 键值/ 对/ 合并/ 17/ ./ ML/ ./ get/ (/ mL/ ./ getKey/ (/ )/ )/ ./ add/ (/ mL/ ./ getValue/ (/ )/ )/ ;/ 18/ ./ ELSEML/ ./ put/ (/ mL/ ./ getKey/ (/ )/ ,/ mL/ ./ getValue/ (/ )/ )/ ;/ 19/ ./ IFML/ ∪/ R/ ./ containsKey/ (/ mL/ ∪/ R/ ./ getKey/ (/ )/ )/ 20/ ./ ML/ ∪/ R/ ./ get/ (/ mL/ ∪/ R/ ./ getKey/ (/ )/ )/ ./ add/ (/ mL/ ∪/ R/ ./ getValue/ (/ )/ )/ ;/ 21/ ./ ELSEML/ ∪/ R/ ./ put/ (/ mL/ ∪/ R/ ./ getKey/ (/ )/ ,/ mL/ ∪/ R/ ./ getValue/ (/ )/ )/ ;/ 22/ ./ [/ tXj/ ]/ LHS/ ←/ ML/ ;/ 23/ ./ [/ tXj/ ∪/ Yj/ ]/ LHS/ ∪/ RHS/ ←/ ML/ ∪/ R/ ;/ 24/ ./ ENDFOR/ ;/ 25/ ./ RETURN/ [/ tX1/ ]/ LHS/ ,/ [/ tX1/ ∪/ Y1/ ]/ LHS/ ∪/ RHS/ ,/ …/ ,/ [/ tXm/ ]/ LHS/ ,/ 算法/ 1/ 的/ 输入/ 为/ 待/ 检测/ 分布式/ 数据/ (/ D1/ ,/ …/ ,/ Dn/ )/ 及/ 函数/ 依赖/ 集合/ Σ/ ,/ 输出/ 为/ 每个/ 待/ 检测/ 函数/ 依赖/ 关于/ LHS/ 和/ (/ LHS/ +/ RHS/ )/ 的/ 局部/ 等价/ 类/ ./ 算法/ 首先/ 对/ 每个/ 待/ 检测/ 函数/ 依赖/ 的/ LHS/ 和/ (/ LHS/ +/ RHS/ )/ 按照/ 元组/ 分别/ 生成/ 局部/ 键值/ 对/ ,/ 然后/ 对/ 有着/ 相同/ key/ 值/ 的/ 局部/ 键值/ 对/ 进行/ 合并/ ,/ 最后/ 得到/ 待/ 检测/ 函数/ 依赖/ 的/ LHS/ 和/ (/ LHS/ +/ RHS/ )/ 局部/ 等价/ 类/ ./ 例/ 8/ ./ 表/ 1/ 中/ EMP/ 的/ 实例/ D0/ 被切/ 分为/ DH1/ ,/ DH2/ ,/ DH3/ ,/ 对/ 函数/ 依赖/ φ/ 3/ :/ TITLE/ →/ SAL/ ,/ 由例/ 7/ 中/ 的/ 局部/ 等价/ 类/ ,/ 根据/ 图/ 1/ 中/ 的/ 合并/ 规则/ ,/ 可以/ 得到/ φ/ 3/ 基于/ 属性/ 集合/ {/ TITLE/ }/ 的/ 划分/ Π/ TITLE/ =/ {/ {/ 1/ }/ ,/ {/ 2/ }/ ,/ {/ 3/ ,/ 6/ ,/ 10/ }/ ,/ {/ 4/ ,/ 7/ ,/ 9/ }/ ,/ {/ 5/ ,/ 8/ }/ }/ 以及/ 基于/ 属性/ 集合/ {/ TITLE/ ,/ SAL/ }/ 的/ 划分/ Π/ TITLE/ _/ SAL/ =/ {/ {/ 1/ }/ ,/ {/ 2/ }/ ,/ {/ 3/ }/ ,/ {/ 6/ ,/ 10/ }/ ,/ {/ 4/ ,/ 9/ }/ ,/ {/ 7/ }/ ,/ {/ 5/ }/ ,/ {/ 8/ }/ }/ ./ 本文/ 中/ 需要/ 检测/ 的/ 函数/ 依赖/ 个数/ 为/ m/ ,/ 节点/ 个数/ 为/ n/ ,/ 对/ 每个/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ m/ 和/ 每个/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ,/ 第/ i/ 个/ 函数/ 依赖/ 在/ 第/ j/ 个/ 节点/ 上/ 检测/ 耗时/ 为/ tcij/ ,/ 第/ i/ 个/ 函数/ 依赖/ 在/ 第/ j/ 个/ 节点/ 上/ 局部/ 等价/ 类/ 数据/ 合并/ 耗时/ 为/ tmij/ ,/ 依据/ 多/ 函数/ 依赖/ 冲突检测/ 响应/ 时间/ 代价/ 模型/ costRT/ (/ Σ/ )/ ,/ 要/ 想/ 减少/ 总/ 的/ 响应/ 时间/ ,/ 应当/ 最小化/ 数据/ 迁移/ 耗时/ 1/ 耗时/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ merge/ (/ ECi/ )/ 、/ 函数/ 依赖/ 冲突检测/ 耗时/ maxi/ ∈/ [/ 1/ ,/ n/ ]/ check/ (/ Di/ )/ ,/ 也/ 就是/ 对待/ 检测/ 函数/ 依赖/ 进行/ 任务分配/ 后/ ,/ 数据/ 迁移/ 耗时/ 、/ 局部/ 等价/ 类/ 合并/ 耗时/ 以及/ 冲突检测/ 耗时/ 之/ 和/ 最小/ ./ 这里/ 定义/ xij/ 为/ 第/ j/ 个/ 节点/ 上/ 处理/ 第/ i/ 个/ 函数/ 依赖/ ,/ 则/ 当/ 第/ i/ 个/ 函数/ 依赖/ 分配/ Page8/ 给/ 第/ j/ 个/ 节点/ 时/ ,/ xij/ =/ 1/ ,/ 否则/ xij/ =/ 0/ ./ 该/ 问题/ 可以/ 转化/ 为/ 如下/ 的/ 整数/ 规划/ 问题/ ./ 目标/ 函数/ :/ mintm/ +/ tc/ +/ 1/ 约束条件/ :/ / j/ ∈/ [/ 1/ ,/ n/ ]/ ,/ tc/ / ∑/ m/ / j/ ∈/ [/ 1/ ,/ n/ ]/ ,/ Δ/ Dj/ -/ in/ =/ ∑/ m/ (/ |/ Π/ Xi/ _/ Yi/ |/ -/ |/ Π/ jXi/ _/ Yi/ |/ )/ ]/ ;/ ∑/ n/ 上述/ 整数/ 规划/ 中/ ,/ tm/ 为/ 所有/ 节点/ 局部/ 等价/ 类/ 合并/ 耗时/ ,/ tc/ 为/ 所有/ 节点/ 函数/ 依赖/ 冲突检测/ 耗时/ ,/ tmij/ 为/ 第/ i/ 个/ 函数/ 依赖/ 在/ 第/ j/ 个/ 节点/ 上/ 局部/ 等价/ 类/ 合并/ 耗时/ ,/ tcij/ 为/ 第/ i/ 个/ 函数/ 依赖/ 在/ 第/ j/ 个/ 节点/ 上/ 冲突检测/ 耗时/ ,/ |/ Π/ Xi/ |/ 为/ 第/ i/ 个/ 函数/ 依赖/ LHS/ 部分/ 在/ 全局/ 数据/ 上/ 的/ 划分/ ,/ |/ Π/ Xi/ _/ Yi/ |/ 为/ 第/ i/ 个/ 函数/ 依赖/ LHS/ ∪/ RHS/ 部分/ 在/ 全局/ 数据/ 上/ 的/ 划分/ ,/ |/ Π/ jXi/ |/ 为/ 第/ i/ 个/ 函数/ 依赖/ LHS/ 部分/ 在/ 第/ j/ 个/ 节点/ 数据/ 上/ 的/ 局部/ 划分/ ,/ |/ Π/ jXi/ _/ Yi/ |/ 为/ 第/ i/ 个/ 函数/ 依赖/ LHS/ ∪/ RHS/ 部分/ 在/ 第/ j/ 个/ 节点/ 数据/ 上/ 的/ 局部/ 划分/ ./ 上述/ 函数/ 依赖/ 任务分配/ 问题/ 为/ 多处理机/ 任务分配/ 问题/ ,/ 该/ 问题/ 为/ NP/ -/ 完全/ 问题/ [/ 4/ ]/ ,/ 难以/ 在/ 多项式/ 时间/ 内/ 得到/ 问题/ 的/ 精确/ 解/ ,/ 本文/ 给出/ 一种/ 多/ 函数/ 依赖/ 冲突检测/ 任务分配/ 的/ 近似/ 最优/ 算法/ ,/ 如/ 算法/ 2/ 所示/ ./ 算法/ 2/ ./ LoadAllocateByFD/ ./ 输入/ :/ 机器/ 集合/ M/ =/ {/ Mi/ }/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 任务/ 集合/ L/ =/ 输出/ :/ L/ (/ 1/ )/ ,/ L/ (/ 2/ )/ ,/ …/ ,/ L/ (/ n/ )/ 1/ ./ FOREACHi/ ∈/ [/ 1/ ,/ n/ ]/ DO2/ ./ Li/ ←/ {/ }/ ;/ 3/ ./ ENDFOR/ ;/ 4/ ./ Desc/ (/ |/ Π/ Xj/ |/ )/ ;/ // // 依据/ L/ 中/ 等价/ 类/ 集合/ Π/ X/ 的/ 势/ 的/ 大/ 5/ ./ 假定/ |/ Π/ X1/ |/ / |/ Π/ X2/ |/ / …/ / |/ Π/ Xm/ |/ ;/ 6/ ./ FOREACHj/ ∈/ [/ 1/ ,/ m/ ]/ DO7/ ./ IF/ 分配/ 给/ 机器/ Mi/ 的/ 任务/ 包含/ 等价/ 类/ 个数/ 最少/ 8/ ./ L/ (/ i/ )/ ←/ L/ (/ i/ )/ ∪/ {/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ }/ ;/ 9/ ./ ENDIF/ ;/ 10/ ./ ENDFOR/ ./ 算法/ 2/ 的/ 输入/ 为/ 处理机/ 集合/ M/ 以及/ 待/ 分配任务/ 集合/ L/ ,/ 输出/ 为/ 任务分配/ 结果/ ./ 算法/ 首先/ 依据/ 任务/ 集合/ 中/ 等价/ 类/ Π/ X/ 势/ 的/ 大小/ 对/ L/ 中/ 任务/ 降序/ 排列/ ,/ 在/ 得到/ 降序/ 排列/ 结果/ 后/ ,/ 开始/ 进行/ 任务分配/ ./ 任务分配/ 过程/ 中/ ,/ 对/ 当前/ 要/ 分配/ 的/ 任务/ ,/ 找出/ 目前/ 被/ 分配/ 的/ 任务/ 包含/ 等价/ 类/ 个数/ 最少/ 的/ 机器/ ,/ 将/ 当前任务/ 分配/ 给/ 该/ 机器/ ,/ 直到/ 所有/ 任务/ 都/ 分配/ 完成/ ./ 算法/ 将/ 一个/ 待/ 检测/ 函数/ 依赖/ 基于/ LHS/ 的/ 划分/ Π/ Xj/ 及/ 基于/ LHS/ ∪/ RHS/ 的/ 划分/ Π/ Xj/ _/ Yj/ 作为/ 一个/ 整体/ 的/ 任务/ 进行/ 分配/ ,/ 根据/ 等价/ 类/ 集合/ Π/ X/ 的/ 势/ (/ 等价/ 类/ 集合/ Π/ X/ 中/ 包含/ 元素/ 的/ 个数/ )/ 的/ 大小/ 将/ 多个/ 划分/ 的/ 集合/ 进行/ 降序/ 排列/ ,/ 然后/ 从/ 排序/ 后/ 的/ 任务/ 集合/ 中/ 依次/ 取出/ 任务/ 集合/ 进行/ 分配/ ,/ 每次/ 分配/ 时/ 选择/ 当前任务/ 负载/ 最小/ 的/ 节点/ 进行/ 分配/ ,/ 在/ 函数/ 依赖/ 个数/ m/ 超过/ 节点/ 个数/ n/ 的/ 情况/ 下/ ,/ 使用/ 贪心/ 算法/ 进行/ 任务分配/ 的/ 时候/ ,/ 通常/ 很难/ 得到/ 最优/ 解/ ,/ 而/ 算法/ LoadAllocateByFD/ 可以/ 得到/ 近似/ 最优/ 解/ ./ 引理/ 3/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ Π/ X/ 为/ 在/ 属性/ 集合/ X/ 上/ 的/ 划分/ ,/ Π/ XY/ 为/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 划分/ ,/ 则/ 有/ |/ Π/ X/ |/ / |/ Π/ XY/ |/ ./ 证明/ ./ 假定/ |/ Π/ X/ |/ >/ |/ Π/ XY/ |/ ,/ 对/ 每/ 一个/ [/ t/ ]/ X/ ∈/ Π/ X/ ,/ 如果/ / [/ t/ ]/ Y/ ∈/ Π/ Y/ ,/ 使得/ [/ t/ ]/ X/ =/ [/ t/ ]/ Y/ ,/ 则/ 据/ 定义/ 2/ ,/ 有/ [/ t/ ]/ X/ =/ [/ t/ ]/ Y/ =/ [/ t/ ]/ XY/ ,/ 由/ 定义/ 4/ ,/ 有/ Π/ X/ =/ Π/ XY/ ,/ 因此/ |/ Π/ X/ |/ =/ |/ Π/ XY/ |/ ,/ 与/ 假设/ 矛盾/ ./ 否则/ ,/ 对/ 每/ 一个/ [/ t/ ]/ X/ ∈/ Π/ X/ ,/ 如果/ / [/ t/ ]/ Y/ ∈/ Π/ Y/ ,/ 使得/ [/ t/ ]/ X/ =/ [/ t/ ]/ Y/ ,/ 则/ 由/ 定义/ 2/ ,/ 有/ [/ t/ ]/ X/ ≠/ [/ t/ ]/ XY/ ,/ 根据/ 定义/ 4/ ,/ 必然/ / [/ t/ ]/ Y/ ,/ [/ t/ ]/ Y/ ∈/ Π/ Y/ ,/ 使得/ [/ t/ ]/ X/ =/ [/ t/ ]/ Y/ ∪/ [/ t/ ]/ Y/ ./ 同理/ 存在/ / [/ t/ ]/ XY/ ,/ [/ t/ ]/ XY/ ∈/ Π/ XY/ ,/ 使得/ [/ t/ ]/ X/ =/ [/ t/ ]/ XY/ ∪/ [/ t/ ]/ XY/ ./ 又/ 根据/ 引理/ 1/ ,/ Σ/ |/ [/ t/ ]/ X/ |/ =/ Σ/ |/ [/ t/ ]/ XY/ |/ =/ |/ R/ |/ ,/ 所以/ Π/ X/ 中/ 等价/ 类/ 个数/ 少于/ Π/ XY/ 中/ 等价/ 类/ 个数/ ,/ 即/ |/ Π/ X/ |/ </ |/ Π/ XY/ |/ ,/ 与/ 假设/ 矛盾/ ./ 综上/ ,/ 假设/ 不/ 成立/ ,/ |/ Π/ X/ |/ / |/ Π/ XY/ |/ 成立/ ./ 证毕/ ./ 由/ 引理/ 3/ ,/ 对于/ 待/ 检测/ 函数/ 依赖/ φ/ :/ X/ →/ Y/ ,/ 满足/ |/ Π/ X/ |/ / |/ Π/ XY/ |/ ,/ 即/ 基于/ LHS/ 属性/ 集合/ 的/ 划分/ 所/ 包含/ 的/ 等价/ 类/ 个数/ 不/ 超过/ 基于/ LHS/ ∪/ RHS/ 属性/ 集合/ 的/ 划分/ 所/ 包含/ 的/ 等价/ 类/ 个数/ ,/ 因此/ 在/ 对/ φ/ 进行/ 冲突检测/ 时/ ,/ 可以/ 从/ |/ Π/ X/ |/ 中/ 等价/ 类/ 出发/ ,/ 在/ |/ Π/ XY/ |/ 中/ 寻找/ 相应/ 的/ 冲突/ 等价/ 类/ ./ 基于/ 等价/ 类/ 的/ 函数/ 依赖/ 冲突检测/ 问题/ 可以/ 视为/ 多叉树/ 生成/ 问题/ ,/ 该/ 多叉树/ 包含/ 3/ 层/ ,/ 第/ 0/ 层为/ 包含/ 所有/ 元组/ 的/ 根/ 节点/ ,/ 第/ 1/ 层为/ 包含/ 所有/ 基于/ LHS/ 属性/ 集合/ 的/ 等价/ 类/ 的/ 中间/ 节点/ ,/ 第/ 2/ 层为/ 包含/ 所有/ 基于/ LHS/ ∪/ RHS/ 属性/ 集合/ 的/ 等价/ 类/ 的/ 叶子/ 节点/ ./ 图/ 2/ 为/ 函数/ 依赖/ 等价/ 类/ 生成/ 树/ 的/ 一个/ 示例/ ./ 其中/ 节点/ [/ t1/ ]/ X/ 为/ 关系/ R/ 在/ 函数/ 依赖/ φ/ :/ X/ →/ Y/ 左端/ 即/ 属性/ 集合/ {/ X/ }/ 上/ 的/ 一个/ 等价/ 类/ ,/ 而/ 等价/ 类/ [/ t1/ -/ 1/ ]/ XY/ ,/ [/ t1/ -/ 2/ ]/ XY/ ,/ …/ ,/ [/ t1/ -/ k/ ]/ XY/ 为/ 节点/ [/ t1/ ]/ X/ 的/ 子/ 节点/ ,/ 同时/ 也/ 是/ 等价/ 类/ 生成/ 树/ 的/ 叶子/ 节点/ ./ 函数/ 依赖/ 等价/ 类/ 生成/ 树/ 有着/ 如下/ 的/ 性质/ ./ Page9/ 性质/ 3/ ./ 在/ 函数/ 依赖/ 等价/ 类/ 生成/ 树中/ ,/ 所有/ 中间/ 节点/ 所/ 包含/ 元组/ 的/ 并/ 集/ 等于/ 关系/ R/ 中/ 所有/ 元组/ 集合/ ./ 性质/ 4/ ./ 在/ 函数/ 依赖/ 等价/ 类/ 生成/ 树中/ ,/ 对/ 任一/ 中间/ 节点/ ,/ 如果/ 其所/ 包含/ 的/ 子/ 节点/ 个数/ 大于/ 1/ ,/ 则/ 该/ 中间/ 节点/ 包含/ 冲突/ 元组/ ,/ 且/ 其/ 不同/ 子/ 节点/ 中/ 所/ 包含/ 的/ 元组/ 互为/ 冲突/ 元组/ ./ 根据/ 上面/ 的/ 分析/ 可以/ 看出/ ,/ 基于/ 等价/ 类/ 的/ 函数/ 依赖/ 冲突检测/ 本质/ 上/ 就是/ 得到/ 等价/ 类/ 生成/ 树/ ./ 而/ 通常/ 情况/ 下/ ,/ 等价/ 类/ 生成/ 树中会/ 包含/ 不/ 存在/ 冲突/ 的/ 中间/ 节点/ 和/ 叶子/ 节点/ ,/ 有/ 必要/ 对/ 这些/ 节点/ 进行/ 剪枝/ ,/ 通过/ 剪去/ 不/ 存在/ 冲突/ 的/ 中间/ 节点/ 和/ 叶子/ 节点/ ,/ 从而/ 提高/ 检测/ 效率/ ./ 性质/ 1/ ./ 在/ 函数/ 依赖/ 等价/ 类/ 生成/ 树中/ ,/ 任一/ 中间/ 节点/ 所/ 包含/ 元组/ 在/ 函数/ 依赖/ LHS/ 上/ 的/ 属性/ 值/ 与/ 所有/ 其子/ 节点/ 在/ 函数/ 依赖/ LHS/ 上/ 的/ 属性/ 值/ 相同/ ./ 性质/ 2/ ./ 在/ 函数/ 依赖/ 等价/ 类/ 生成/ 树中/ ,/ 中间/ 节点/ 所/ 包含/ 元组/ 的/ 集合/ 为/ 其/ 所有/ 子/ 节点/ 所/ 包含/ 元组/ 集合/ 的/ 并/ 集/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ [/ t/ ]/ X/ 为/ 在/ 属性/ 集合/ X/ 上/ 的/ 等价/ 类/ ,/ [/ t/ ]/ X/ ∪/ Y/ 为/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 等价/ 类/ ,/ 如果/ 满足/ [/ t/ ]/ X/ =/ [/ t/ ]/ X/ ∪/ Y/ ,/ 则/ [/ t/ ]/ X/ 或/ [/ t/ ]/ X/ ∪/ Y/ 中/ 的/ 元组/ 关于/ 函数/ 依赖/ φ/ 不/ 存在/ 冲突/ ./ 对/ / ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ ,/ ti/ ≠/ tj/ ,/ 由/ [/ t/ ]/ X/ =/ [/ t/ ]/ X/ ∪/ Y/ 可知/ ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ ∪/ Y/ ./ 根据/ 定义/ 2/ ,/ 由/ ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ ∪/ Y/ 可知/ ti/ [/ XY/ ]/ =/ tj/ [/ XY/ ]/ ,/ 由/ ti/ ,/ tj/ ∈/ [/ t/ ]/ X/ 可知/ ti/ [/ X/ ]/ =/ tj/ [/ X/ ]/ ./ 由/ ti/ [/ XY/ ]/ =/ tj/ [/ XY/ ]/ 和/ ti/ [/ X/ ]/ =/ tj/ [/ X/ ]/ ,/ 将/ 等式/ ti/ [/ XY/ ]/ =/ tj/ [/ XY/ ]/ 左右两端/ 去掉/ 相同/ 部分/ ti/ [/ X/ ]/ 和/ tj/ [/ X/ ]/ 可以/ 得到/ ti/ [/ Y/ ]/ =/ tj/ [/ Y/ ]/ ,/ 根据/ 函数/ 依赖/ 冲突/ 的/ 定义/ 7/ ,/ 元组/ ti/ ,/ tj/ 关于/ 函数/ 依赖/ φ/ 不/ 存在/ 冲突/ ./ 可以/ 看出/ ,/ 如果/ 函数/ 依赖/ 等价/ 类/ 生成/ 树中/ 中间/ 节点/ 仅/ 包含/ 一个/ 子/ 节点/ ,/ 则/ 该/ 中间/ 节点/ 对应/ 的/ 等价/ 类中/ 不/ 包含/ 冲突/ 元组/ ./ 剪枝/ 策略/ 1/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ Π/ X/ 为/ 关系/ R/ 在/ 属性/ 集合/ X/ 上/ 的/ 一个/ 划分/ ,/ 在/ 检测/ 函数/ 依赖/ φ/ 的/ 冲突/ 时/ ,/ 首先/ 去除/ Π/ X/ 中/ 包含/ 单个/ 元素/ 的/ 等价/ 类/ ,/ 得到/ Π/ X/ 的/ 剥离/ 划分/ Π/ X/ ,/ 然后/ 去除/ Π/ XY/ 中所/ 包含/ 的/ 同时/ 在/ Π/ X/ 和/ Π/ XY/ 中为/ 单个/ 元素/ 的/ 等价/ 类/ ,/ 得到/ Π/ XY/ =/ Π/ XY/ \/ (/ Π/ X/ \/ Π/ X/ )/ ,/ 基于/ Π/ X/ 和/ Π/ XY/ 进行/ 冲突检测/ ./ 剪枝/ 策略/ 2/ ./ 对/ 剪枝/ 后/ 得到/ 的/ Π/ X/ 和/ Π/ XY/ ,/ 去除/ 其中/ 包含/ 的/ 公共/ 的/ 等价/ 类/ ,/ 得到/ Π/ X/ =/ Π/ X/ \/ (/ Π/ X/ ∩/ Π/ XY/ )/ 和/ Π/ / XY/ =/ Π/ XY/ \/ (/ Π/ X/ ∩/ Π/ XY/ )/ ,/ 基于/ Π/ X/ 和/ Π/ / XY/ 进行/ 冲突/ 2/ 检测/ ./ 经过/ 剪枝/ 策略/ 1/ 和/ 2/ 剪枝/ 后/ ,/ 可以/ 得到/ 仅/ 包含/ 冲突/ 元组/ 的/ 等价/ 类/ ,/ 基于/ 该/ 等价/ 类/ 进行/ 函数/ 依赖/ 冲突检测/ ,/ 可以/ 有效/ 减少/ 冲突检测/ 的/ 比/ 对/ 空间/ ,/ 提高/ 检测/ 效率/ ./ 例/ 9/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ D0/ 为例/ ,/ 对/ 函数/ 依赖/ φ/ 1/ :/ ENO/ →/ ENAME/ ,/ D0/ 在/ 属性/ 集合/ {/ ENO/ }/ 上/ 的/ 划分/ 为/ Π/ ENO/ =/ {/ {/ 1/ ,/ 2/ }/ ,/ {/ 3/ ,/ 4/ ,/ 5/ }/ ,/ {/ 6/ ,/ 7/ }/ ,/ {/ 8/ }/ ,/ {/ 9/ ,/ 10/ }/ }/ ,/ 在/ {/ ENO/ ,/ ENAME/ }/ 上/ 的/ 划分/ 为/ Π/ ENO/ _/ ENAME/ =/ {/ {/ 1/ ,/ 2/ }/ ,/ {/ 3/ ,/ 4/ }/ ,/ {/ 5/ }/ ,/ {/ 6/ ,/ 7/ }/ ,/ {/ 8/ }/ ,/ {/ 9/ }/ ,/ {/ 10/ }/ }/ ./ 图/ 3/ 是/ 等价/ 类/ Π/ ENO/ 和/ Π/ ENO/ _/ ENAME/ 生成/ 树/ 剪枝/ 过程/ 示意图/ ./ 第/ 1/ 次/ 剪枝/ ,/ 分别/ 从/ Π/ ENO/ 和/ Π/ ENO/ _/ ENAME/ 中/ 剪/ 去/ 了/ 包含/ 单个/ 元组/ 的/ 等价/ 类/ {/ 8/ }/ ,/ 得到/ 如图/ 3/ 中间/ 的/ 等价/ 类/ 生成/ 树/ ./ 第/ 2/ 次/ 剪枝/ ,/ 分别/ 从/ Π/ ENO/ 和/ Π/ ENO/ _/ ENAME/ 中/ 剪/ 去/ 了/ 包含/ 单个/ 元组/ 的/ 等价/ 类/ {/ 1/ ,/ 2/ }/ 和/ {/ 6/ ,/ 7/ }/ ,/ 得到/ 如图/ 3/ 下部/ 的/ 等价/ 类/ 生成/ 树/ ./ 从图/ 3/ 不难看出/ ,/ 经过/ 两次/ 剪枝/ 后/ 得到/ 的/ 等价/ 类/ 生成/ 树为/ 一棵/ 仅/ 包含/ 冲突/ 元组/ 的/ 等价/ 类/ 生成/ 树/ ,/ 也/ 就是/ 一棵/ 冲突/ 等价/ 类/ 生成/ 树/ ./ Page10/ 经过/ 上述/ 剪枝/ 策略/ 剪枝/ 后/ 得到/ 包含/ 冲突/ 元组/ 的/ 等价/ 类/ ,/ 为/ 进一步/ 确定/ 图/ 2/ 中/ 第/ 1/ 层/ 每/ 一个/ 冲突/ 等价/ 类/ 的/ 子集合/ ,/ 也/ 就是/ 构造/ 冲突/ 等价/ 类/ 生成/ 树/ ,/ 需要/ 将/ 剪枝/ 后/ 第/ 1/ 层中/ 的/ 任一/ 节点/ 与/ 第/ 2/ 层中/ 的/ 叶子/ 节点/ 进行/ 匹配/ ,/ 以/ 确定/ 是否/ 为/ 父子关系/ ./ nave/ 的/ 匹配/ 方法/ 是/ 对/ 第/ 1/ 层中/ 的/ 任一/ 节点/ ,/ 取/ 第/ 2/ 层中/ 所有/ 未/ 匹配/ 上/ 的/ 叶子/ 节点/ 进行/ 匹配/ ,/ 这种/ 匹配/ 方法/ 由于/ 要/ 与/ 第/ 2/ 层中/ 所有/ 未/ 匹配/ 上/ 的/ 叶子/ 节点/ 进行/ 匹配/ ,/ 因此/ 效率/ 不高/ ./ 为/ 提升/ 匹配/ 效率/ ,/ 首先/ 对/ 两次/ 剪枝/ 后/ 得到/ 的/ 第/ 1/ 层/ 的/ 等价/ 类/ 集合/ Π/ X/ =/ Π/ X/ \/ (/ Π/ X/ ∩/ Π/ XY/ )/ 中/ 的/ 所有/ 等价/ 类/ 根据/ 其势/ 的/ 大小/ 从小到大/ 进行/ 排序/ ,/ 得到/ 一个/ 升序/ 的/ 等价/ 类/ 集合/ Π/ X/ ↑/ ./ 然后/ 从/ 等价/ 类势/ 最小/ 的/ 一端/ 逐个/ 选取/ 等价/ 类/ 进行/ 匹配/ ,/ 在/ 匹配/ 时/ ,/ 先对/ Π/ / XY/ =/ Π/ XY/ \/ (/ Π/ X/ ∩/ Π/ XY/ )/ 中/ 的/ 等价/ 类/ 进行/ 剪枝/ ./ 给定/ 关系/ R/ ,/ φ/ :/ X/ →/ Y/ 为/ 关系/ R/ 上/ 的/ 函数/ 依赖/ ,/ Π/ X/ 为/ 在/ 属性/ 集合/ X/ 上/ 的/ 划分/ ,/ Π/ XY/ 为/ 在/ 属性/ 集合/ X/ ∪/ Y/ 上/ 的/ 划分/ ,/ [/ t/ ]/ X/ 为/ 在/ 属性/ 集合/ X/ 上/ 的/ 等价/ 类/ ,/ 如果/ [/ t/ ]/ X/ 中/ 存在/ 冲突/ 元组/ ,/ 则/ 对/ / [/ t/ ]/ X/ ∪/ Y/ ∈/ Π/ XY/ ,/ 如果/ [/ t/ ]/ X/ ∪/ Y/ / [/ t/ ]/ X/ ,/ 即/ [/ t/ ]/ X/ ∪/ Y/ 为/ [/ t/ ]/ X/ 的/ 子集合/ ,/ 则/ |/ [/ t/ ]/ X/ |/ >/ |/ [/ t/ ]/ X/ ∪/ Y/ |/ ./ 等价/ 类/ 集合/ Π/ X/ ↑/ 中/ 的/ 所有/ 等价/ 类/ ,/ 其子/ 集合/ 的/ 势均/ 小于/ 等价/ 类/ 自身/ 的/ 势/ ,/ 因此/ 对/ Π/ / XY/ =/ Π/ XY/ \/ (/ Π/ X/ ∩/ Π/ XY/ )/ 中/ 的/ 等价/ 类/ 进行/ 剪枝/ 时/ ,/ 对/ / [/ t/ ]/ X/ ∈/ Π/ X/ ↑/ ,/ 如果/ [/ t/ ]/ X/ ∪/ Y/ ∈/ Π/ / XY/ 且/ |/ [/ t/ ]/ X/ ∪/ Y/ |/ / |/ [/ t/ ]/ X/ |/ ,/ 则/ 可以/ 将/ [/ t/ ]/ X/ ∪/ Y/ 从/ Π/ / XY/ 中/ 移除/ ./ 例/ 10/ ./ 以图/ 3/ 中/ 2/ 次/ 剪枝/ 后/ 得到/ 的/ 等价/ 类为例/ ,/ 其中/ Π/ ENO/ =/ {/ {/ 3/ ,/ 4/ ,/ 5/ }/ ,/ {/ 9/ ,/ 10/ }/ }/ ,/ Π/ / ENO/ ∪/ ENAME/ =/ {/ {/ 3/ ,/ 4/ }/ ,/ {/ 5/ }/ ,/ {/ 9/ }/ ,/ {/ 10/ }/ }/ ./ 首先/ 对/ Π/ ENO/ 中/ 的/ 等价/ 类/ 根据/ 其势/ 的/ 大小/ 从小到大/ 排序/ ,/ 得到/ Π/ ENO/ ↑/ =/ {/ {/ 9/ ,/ 10/ }/ ,/ {/ 3/ ,/ 4/ ,/ 5/ }/ }/ ./ 然后/ 选取/ Π/ ENO/ ↑/ 中/ 的/ 第/ 1/ 个/ 等价/ 类/ {/ 9/ ,/ 10/ }/ ,/ 在/ 从/ Π/ / ENO/ ∪/ ENAME/ 中/ 寻找/ 等价/ 类/ {/ 9/ ,/ 10/ }/ 的/ 子集合/ 时/ ,/ 存在/ 冲突/ 的/ 等价/ 类/ {/ 9/ ,/ 10/ }/ 的/ 子集合/ 的/ 势/ 必然/ 小于/ {/ 9/ ,/ 10/ }/ 的/ 势/ ,/ 即/ 小于/ 2/ ./ 因此/ 可以/ 从/ Π/ / ENO/ ∪/ ENAME/ 中/ 移除/ 势/ 不/ 小于/ 2/ 的/ 等价/ 类/ ,/ 这里/ 满足/ 移除/ 条件/ 的/ 等价/ 类为/ {/ 3/ ,/ 4/ }/ ,/ 因此/ 可以/ 将/ 其/ 移除/ ,/ 而/ 不/ 影响/ 匹配/ 的/ 结果/ ./ 表/ 5/ 对/ Π/ ENO/ 中/ 等价/ 类/ 排序/ 前后/ 最坏/ 情况/ 下/ 的/ 匹配/ 及/ 判断/ 次数/ 进行/ 了/ 比较/ ./ 表/ 5/ 等价/ 类/ 排序/ 前后/ 最坏/ 匹配/ 及/ 判断/ 次数/ 比较/ 排序/ 前/ {/ 3/ ,/ 4/ ,/ 5/ }/ 4/ 排序/ 后/ {/ 3/ ,/ 4/ ,/ 5/ }/ 2/ 从表/ 5/ 可以/ 看出/ ,/ 在/ 最坏/ 情况/ 下/ ,/ 对/ Π/ ENO/ 中/ 等价/ 类/ 进行/ 排序/ 后/ 总/ 的/ 匹配/ 次数/ 为/ 5/ 次/ ,/ 判断/ 次数/ 为/ 12/ 次/ ,/ 而/ 不/ 对/ Π/ ENO/ 中/ 等价/ 类/ 进行/ 排序/ 直接/ 进行/ 匹配/ 和/ 判断/ ,/ 则/ 需要/ 6/ 次/ 匹配/ 和/ 16/ 次/ 判断/ ,/ 相/ 比较而言/ ,/ 对/ Π/ ENO/ 中/ 的/ 等价/ 类/ 根据/ 其势/ 的/ 大小/ 从小到大/ 排序/ 可以/ 明显/ 减少/ 匹配/ 和/ 判断/ 的/ 次数/ ,/ 提高/ 检测/ 效率/ ./ 在/ 多个/ 函数/ 依赖/ 不一致性/ 检测/ 时/ ,/ 假定/ 待/ 检测/ 函数/ 依赖/ 个数/ 为/ m/ ,/ 待/ 检测/ 数据分布/ 在/ n/ 个/ 节点/ ,/ 根据/ 函数/ 依赖/ 个数/ 及/ 节点/ 个数/ 的/ 大小/ 情况/ 不同/ 采用/ 不同/ 的/ 负载/ 分配/ 策略/ ./ (/ 1/ )/ m/ / n/ ,/ 即/ 函数/ 依赖/ 个数/ 大于/ 等于/ 节点/ 个数/ ,/ 以/ 函数/ 依赖/ 为/ 最小/ 单位/ 进行/ 检测/ 任务/ 的/ 分配/ ,/ 可以/ 保证/ 所有/ 节点均/ 有/ 负载/ ;/ (/ 2/ )/ m/ </ n/ ,/ 即/ 函数/ 依赖/ 个数/ 小于/ 节点/ 个数/ ,/ 此种/ 情况/ 将/ 函数/ 依赖/ 的/ 冲突/ 等价/ 类/ 依据/ 节点/ 个数/ 进行/ 分组/ ,/ 将/ 不同/ 的/ 等价/ 类/ 分组/ 分配/ 到/ 不同/ 的/ 节点/ 进行/ 处理/ ,/ 保证/ 所有/ 节点/ 都/ 有/ 负载/ ,/ 而且/ 使得/ 各/ 节点/ 间/ 的/ 负载/ 尽可能/ 的/ 均衡/ ./ 对于/ 函数/ 依赖/ 个数/ 大于/ 等于/ 节点/ 个数/ 的/ 情况/ ,/ 可以/ 利用/ 算法/ 2/ 中/ 给出/ 的/ 任务分配/ 策略/ 进行/ 任务分配/ ,/ 使得/ 检测/ 任务/ 的/ 分配/ 尽可能/ 的/ 均衡/ ./ 对于/ 函数/ 依赖/ 个数/ 小于/ 节点/ 个数/ 的/ 情况/ ,/ 以/ 函数/ 依赖/ 为/ 单位/ 进行/ 任务/ 的/ 分配/ 会/ 出现/ 有些/ 节点/ 负载/ 为空/ 的/ 情况/ ,/ 检测/ 效率/ 不高/ ,/ 本文/ 给出/ 一种/ 函数/ 依赖/ 个数/ 小于/ 节点/ 个数/ 情况/ 下多/ 函数/ 依赖/ 冲突检测/ 任务分配/ 的/ 近似/ 最优/ 算法/ ,/ 具体/ 见/ 算法/ 3/ ./ 算法/ 3/ ./ LoadAllocateByEC/ ./ 输入/ :/ 机器/ 集合/ M/ =/ {/ Mi/ }/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 函数/ 依赖/ 集合/ Σ/ =/ 输出/ :/ FL/ (/ 1/ )/ ,/ FL/ (/ 2/ )/ ,/ …/ ,/ FL/ (/ m/ )/ 1/ ./ FOREACHi/ ∈/ [/ 1/ ,/ m/ ]/ DO2/ ./ FL/ (/ i/ )/ ←/ {/ }/ ;/ 3/ ./ ENDFOR/ ;/ 4/ ./ FOREACHi/ ∈/ [/ 1/ ,/ m/ ]/ DO5/ ./ FOREACHj/ ∈/ [/ 1/ ,/ n/ ]/ DO6/ ./ IF/ |/ FL/ (/ i/ )/ |/ </ n/ // m/ &&/ i/ </ m7/ ./ FL/ (/ i/ )/ ←/ FL/ (/ i/ )/ ∪/ Mj/ ;/ 8/ ./ M/ ←/ M/ \/ Mj/ ;/ 9/ ./ ELSEIFi/ =/ =/ m/ // // 最后/ 剩余/ 的/ 节点/ 分配/ 给/ 最后/ 10/ ./ FL/ (/ i/ )/ ←/ M/ ;/ 11/ ./ ENDFOR/ ;/ 12/ ./ ENDFOR/ ./ 算法/ 3/ 的/ 输入/ 为/ 处理机/ 集合/ M/ 以及/ 待/ 分配/ 函数/ 依赖/ 集合/ Σ/ ,/ 输出/ 为/ 任务分配/ 结果/ ./ 为/ 使得/ 待/ 检测/ Page11/ 函数/ 依赖/ 所/ 分配/ 的/ 执行/ 节点/ 个数/ 尽可能/ 的/ 均衡/ ,/ 对前/ m/ -/ 1/ 个/ 待/ 检测/ FD/ ,/ 算法/ 首先/ 将/ 执行/ 节点/ 个数/ 根据/ 待/ 检测/ FD/ 个数/ 进行/ 均分/ ,/ 每个/ 待/ 检测/ FD/ 分配/ n/ // m/ 个/ 执行/ 节点/ ,/ 其中/ m/ 为/ 待/ 检测/ 函数/ 依赖/ 总数/ ,/ n/ 为/ 节点/ 总数/ ,/ 最后/ 得到/ 的/ 第/ m/ 个/ 待/ 检测/ FD/ 所/ 分配/ 的/ 执行/ 节点/ 个数/ 为/ 前面/ m/ -/ 1/ 个/ 待/ 检测/ FD/ 分配/ 后/ 剩余/ 的/ 节点/ 个数/ ./ 基于/ 以上/ 的/ 分配/ 策略/ ,/ 算法/ LoadAllocateByEC/ 可以/ 得到/ 近似/ 最优/ 解/ ./ 对于/ 待/ 检测/ 的/ 函数/ 依赖/ ,/ 假定/ 其/ 检测/ 任务/ 需要/ 分配/ 到/ 不同/ 节点/ 并行/ 进行/ 不一致性/ 检测/ ./ 在/ 各个/ 节点/ 并行计算/ 局部/ 等价/ 类/ [/ t/ ]/ LHS/ 和/ [/ t/ ]/ LHS/ ∪/ RHS/ 得到/ 形/ 如/ 〈/ key/ ,/ value/ 〉/ 的/ 键值/ 对后/ ,/ 根据/ t/ [/ LHS/ ]/ 值/ 对/ 得到/ 的/ 键值/ 对/ 进行/ 分组/ ,/ 分组/ 基于/ 散列/ 函数/ 进行/ ,/ 输入/ 即/ 散列/ 函数/ 的/ 关键字/ 为/ t/ [/ LHS/ ]/ 值/ ,/ 散列/ 函数/ 的/ 输出/ 由/ 负载/ 该/ 函数/ 依赖/ 的/ 节点/ 个数/ 确定/ ./ 对于/ 各/ 节点/ 数据/ 预处理/ 得到/ 的/ 键值/ 对/ ,/ 根据/ 散列/ 函数/ 值/ 的/ 分布/ 情况/ 将/ 有着/ 相同/ 散列值/ 的/ 键值/ 对/ 散列/ 到/ 同一/ 执行/ 节点/ ,/ 不同/ 执行/ 节点/ 上/ 的/ 键值/ 对/ 有着/ 不同/ 的/ 散列值/ ./ 这样/ 可以/ 实现/ 有着/ 相同/ 散列值/ 的/ 键值/ 对/ 在/ 同一个/ 执行/ 节点/ 处理/ ./ 键值/ 对/ 散列/ 的/ 示意图/ 如图/ 4/ 所示/ ./ 图/ 4/ 函数/ 依赖/ 局部/ 等价/ 类/ 〈/ 键/ ,/ 值/ 〉/ 对/ 散列/ 示意图/ 图/ 4/ 中/ ti/ [/ X/ ]/ 为/ Di/ 中/ 元组/ 在/ 属性/ 集合/ X/ 上/ 的/ 属性/ 值/ ,/ [/ ti/ ]/ X/ _/ L/ 为/ Di/ 中/ 元组/ 在/ 属性/ 值/ ti/ [/ X/ ]/ 上/ 的/ 局部/ 等价/ 类/ ,/ 〈/ tm/ _/ j/ [/ X/ ]/ ,/ [/ tm/ _/ j/ ]/ X/ _/ L/ 〉/ 为/ Dj/ 中/ 键值/ 对/ 集合/ 根据/ 哈希/ 函数/ 散列后/ 散列值/ 为/ m/ -/ 1/ 的/ 键值/ 对/ 集合/ ,/ 所有/ 散列值/ 为/ m/ -/ 1/ 的/ 键值/ 对/ 被/ 分配/ 到/ 数据/ 分块/ Pm/ 上/ ./ 这种/ 散列/ 策略/ 使得/ 有着/ 相同/ ti/ [/ X/ ]/ 的/ 键值/ 对/ 散列/ 到/ 相同/ 的/ 执行/ 节点/ ./ 根据/ 引理/ 2/ ,/ 只有/ ti/ [/ X/ ]/ 相同/ 的/ 等价/ 类中/ 元组/ 才/ 可能/ 存在/ 冲突/ ,/ 因此/ 图/ 4/ 中/ 的/ 局部/ 等价/ 类/ 分配/ 策略/ 使得/ 所有/ 存在/ 潜在/ 冲突/ 的/ 元组/ 分配/ 到/ 相同/ 的/ 节点/ ,/ 保证/ 了/ 冲突检测/ 的/ 准确性/ ./ 基于/ Hadoop/ 平台/ 进行/ 数据处理/ 时/ ,/ 由于/ 数据/ 的/ 特点/ 及/ 分布/ 情况/ 不同/ ,/ 可能/ 会/ 出现/ 默认/ 的/ 分区/ 函数/ Partitioner/ (/ )/ 得到/ 的/ 数据/ 分块/ 大小/ 差异/ 较大/ 的/ 情况/ ,/ 这会/ 导致/ 在/ Reduce/ 阶段/ 负载/ 分配/ 的/ 不/ 均衡/ ,/ 一些/ Reducer/ 节点/ 负载/ 过大/ ,/ 总/ 耗时/ 取决于/ 耗时/ 最长/ 通常/ 也/ 是/ 负载/ 最大/ 节点/ 的/ 耗时/ ,/ 因此/ 处理/ 效率/ 不高/ ./ 本文/ 针对/ Hadoop/ 内核/ 进行/ 修改/ ,/ 在/ Map/ 阶段/ ,/ 根据/ partition/ 函数/ 将/ 待/ 检测/ 数据/ 划分/ 成/ 数量/ 多于/ reducer/ 个数/ 的/ partition/ ,/ 采用/ 改进/ 的/ 负载/ 均衡/ 贪心/ 算法/ 对/ 得到/ 的/ partition/ 进行/ 合并/ ,/ 合并/ 后/ 的/ 数据/ 分块/ 数量/ 与/ 执行/ 节点/ 个数/ 即/ Reducer/ 个数/ 相同/ ,/ 将/ 合并/ 后/ 的/ 数据/ 分块/ 分配/ 到/ Reducer/ 上/ ,/ 保证/ 每个/ Reducer/ 处理/ 一个/ 合并/ 后/ 的/ 数据/ 分块/ ,/ 具体/ 算法/ 如/ 算法/ 4/ 所示/ ./ 算法/ 4/ ./ PartitionAllocate/ ./ 输入/ :/ 节点/ 集合/ M/ =/ {/ Mi/ }/ ,/ i/ ∈/ [/ 1/ ,/ n/ ]/ ,/ 数据/ 分块/ 集合/ P/ =/ 输出/ :/ A/ (/ 1/ )/ ,/ A/ (/ 2/ )/ ,/ …/ ,/ A/ (/ n/ )/ 1/ ./ FOREACHi/ ∈/ [/ 1/ ,/ n/ ]/ DO2/ ./ A/ (/ i/ )/ ←/ {/ }/ ;/ 3/ ./ ENDFOR/ ;/ 4/ ./ Desc/ (/ |/ Pj/ |/ )/ ;/ // // 依据/ P/ 中/ 数据/ 分块/ 的/ 大小/ 对/ 数据/ 5/ ./ 假定/ |/ P1/ |/ / |/ P2/ |/ / …/ / |/ Pm/ |/ ;/ 6/ ./ FOREACHj/ ∈/ [/ 1/ ,/ m/ ]/ DO7/ ./ IFMi/ 是/ 达到/ 最小值/ min/ |/ A/ (/ i/ )/ |/ 的/ 节点/ 8/ ./ A/ (/ i/ )/ ←/ A/ (/ i/ )/ ∪/ Pj/ ;/ 9/ ./ ENDIF/ ;/ 10/ ./ ENDFOR/ ./ 算法/ 4/ 的/ 输入/ 为/ 节点/ 集合/ M/ 和/ 待/ 分配/ 的/ 数据/ 分块/ 集合/ P/ ,/ 输出/ 为/ 数据/ 分块/ 的/ 分配/ 结果/ ,/ A/ (/ i/ )/ 表示/ 分配/ 给/ 节点/ Mi/ 的/ 数据/ 分块/ 集合/ ./ 算法/ 根据/ 待/ 分配/ 数据/ 分块/ 集合/ 中/ 数据/ 块/ 大小/ 对/ 所有/ 数据/ 分块/ 降序/ 排列/ ,/ 然后/ 对/ 排序/ 后/ 的/ 数据/ 分块/ ,/ 找出/ 当前/ 分配/ 的/ 数据/ 规模/ 最小/ 的/ 节点/ ,/ 将/ 当前/ 数据/ 分块/ 分配/ 给/ 该/ 节点/ ,/ 直到/ 所有/ 数据/ 块/ 都/ 分配/ 完成/ ./ 假定/ 对于/ 函数/ 依赖/ φ/ :/ X/ →/ Y/ ,/ 执行/ 节点/ 个数/ 为/ k/ ,/ 根据/ 算法/ 4/ 中/ 的/ 任务分配/ 策略/ ,/ 每个/ 执行/ 节点/ 可以/ 得到/ 部分/ 冲突/ 元组/ ,/ 所有/ k/ 个/ 执行/ 节点/ 所/ 得到/ 的/ 关于/ φ/ 的/ 部分/ 冲突/ 元组/ 的/ 并/ 集即/ 为/ φ/ 在/ 全局/ 数据/ 上/ 的/ 冲突/ 元组/ 集合/ ,/ 具体/ 如图/ 5/ 所示/ ./ 根据/ 函数/ 依赖/ 检测/ 任务分配/ 策略/ ,/ 如果/ 函数/ 依赖/ 个数/ 少于/ 节点/ 个数/ ,/ 对/ 每/ 一个/ 待/ 检测/ 函数/ 依赖/ ,/ 有着/ 相同/ LHS/ 属性/ 值/ 的/ 键值/ 对/ 被/ 散列/ 到/ 相同/ 节点/ ,/ 而/ 根据/ 引理/ 2/ ,/ 潜在/ 冲突/ 的/ 元组/ 其散/ 列值/ 相同/ ,/ 因此/ Page12/ 图/ 5/ 各/ 执行/ 节点/ 部分/ 冲突/ 元组/ 得到/ 全部/ 冲突/ 元组/ 被/ 散列/ 到/ 同一个/ 节点/ ./ 对/ 函数/ 依赖/ φ/ :/ X/ →/ Y/ ,/ 在/ 各个/ 执行/ 节点/ ,/ 对/ 散列/ 到/ 该/ 节点/ 的/ 所有/ 键值/ 对/ ,/ 根据/ 键中/ 包含/ 的/ LHS/ 部分/ (/ 这里/ 为/ X/ )/ 属性/ 值/ 是否/ 相同/ ,/ 对/ 所有/ 键值/ 对/ 进行/ 划分/ ,/ 将/ 有着/ 相同/ LHS/ 属性/ 值/ 的/ 键值/ 对/ 划分/ 到/ 同一个/ 组/ ,/ 得到/ 该/ LHS/ 部分/ 属性/ 值/ 的/ 等价/ 类/ ./ 然后/ 根据/ RHS/ 部分/ 属性/ 值/ 是否/ 相同/ ,/ 将/ 有着/ 相同/ RHS/ 部分/ 属性/ 值/ 的/ 键值/ 对/ 划分/ 到/ 同一个/ 组/ ,/ 得到/ 关于/ RHS/ 部分/ 属性/ 值/ 的/ 等价/ 类/ ./ 根据/ 引理/ 2/ ,/ 对/ 每/ 一个/ 基于/ LHS/ 部分/ 属性/ 值/ 的/ 等价/ 类/ ,/ 如果/ 其/ 对应/ 的/ LHS/ ∪/ RHS/ 属性/ 值/ 等价/ 类/ 个数/ 大于/ 1/ ,/ 则/ 说明/ 其/ 对应/ 的/ 不同/ LHS/ ∪/ RHS/ 属性/ 值/ 等价/ 类/ 之间/ 违反/ 函数/ 依赖/ φ/ ./ 例/ 11/ ./ 以表/ 1/ 中/ EMP/ 的/ 一个/ 实例/ D0/ 为例/ ,/ 对/ 函数/ 依赖/ φ/ 1/ :/ ENO/ →/ ENAME/ ,/ 假定/ 节点/ 个数/ 为/ 2/ ,/ 分别/ 为/ S1/ 和/ S2/ ,/ 在/ 散列/ 后/ 分配/ 到/ 节点/ S1/ 上/ 的/ 在/ 属性/ 集合/ {/ ENO/ }/ 的/ 键值/ 对/ 合并/ 后/ 为/ 〈/ “/ E1/ ”/ ,/ {/ 1/ ,/ 2/ }/ 〉/ ,/ 〈/ “/ E2/ ”/ ,/ {/ 3/ ,/ 4/ ,/ 5/ }/ 〉/ ,/ 在/ 属性/ 集合/ {/ ENO/ ,/ ENAME/ }/ 的/ 键值/ 对/ 合并/ 后/ 为/ 〈/ “/ E1/ _/ M/ ./ Smith/ ”/ ,/ {/ 1/ ,/ 2/ }/ 〉/ ,/ 〈/ “/ E2/ _/ J/ ./ Jones/ ”/ ,/ {/ 3/ ,/ 4/ }/ 〉/ ,/ 〈/ “/ E2/ _/ J/ ./ Davis/ ”/ ,/ {/ 5/ }/ 〉/ ./ 键值/ 对/ 〈/ “/ E2/ _/ J/ ./ Jones/ ”/ ,/ {/ 3/ ,/ 4/ }/ 〉/ ,/ 〈/ “/ E2/ _/ J/ ./ Davis/ ”/ ,/ {/ 5/ }/ 〉/ 的/ LHS/ 属性/ 值/ 相同/ ,/ RHS/ 属性/ 值/ 不同/ ,/ 根据/ 引理/ 2/ ,/ 等价/ 类/ {/ 3/ ,/ 4/ }/ 和/ {/ 5/ }/ 为/ 冲突/ 等价/ 类/ ./ 在/ 节点/ S2/ ,/ 同理/ ./ 对于/ 不/ 存在/ 冲突/ 元组/ ,/ 该/ 等价/ 类/ 可以/ 被/ 剪枝/ 掉/ ./ 冲突/ 等价/ 类子/ 树/ 合并/ 后/ 可以/ 构建/ 出/ 冲突/ 等价/ 类/ 生成/ 树/ ,/ 具体/ 生成/ 过程/ 如图/ 6/ 所示/ ./ 在/ 函数/ 依赖/ 冲突检测/ 过程/ 中/ ,/ 由于/ 不同/ 节点/ 任务分配/ 情况/ 以及/ 存在/ 冲突/ 情况/ 的/ 不同/ ,/ 可能/ 导致/ 检测/ 过程/ 中负载/ 不/ 均衡/ 情况/ 的/ 出现/ ./ 为/ 提高/ 检测/ 效率/ ,/ 本文/ 考虑/ 在/ 检测/ 过程/ 中/ 进行/ 动态/ 负载/ 均衡/ ./ 可以/ 将/ 动态/ 负载/ 均衡/ 时/ 节点/ 间/ 负载/ 迁移/ 情况/ 用/ 有向图/ G/ (/ V/ ,/ E/ )/ 的/ 形式/ 表示/ ,/ V/ 为/ 图/ 的/ 顶点/ 集合/ ,/ 每个/ 顶点/ 代表/ 一个/ 节点/ ,/ E/ 为/ 有/ 向/ 边/ 的/ 集合/ ,/ 每条/ 边/ 代表/ 节点/ 间/ 负载/ 的/ 迁移/ 关系/ ./ 假定/ 节点/ 个数/ 为/ m/ 个/ ,/ 节点/ Si/ 的/ 当前/ 负载/ 用/ li/ 表示/ ,/ 当前/ 所有/ 节点/ 的/ 平均/ 负载/ 为/ l/ -/ =/ ∑/ mli/ // m/ ,/ 则/ li/ -/ l/ -/ 为/ 节点/ Si/ 需要/ 迁移/ 的/ 负载量/ ,/ i/ =/ 1/ 图/ 6D0/ 中/ 函数/ 依赖/ 冲突/ 等价/ 类/ 生成/ 树/ 生成/ 过程/ 该值/ >/ 0/ ,/ 说明/ 负载/ 超出/ 平均/ 负载/ ,/ 反之/ 说明/ 负载/ 低于/ 平均/ 负载/ ./ 边/ eij/ 的/ 权重/ 表示/ 从/ 节点/ Si/ 到/ Sj/ 的/ 负载/ 迁移/ 量/ ,/ 用/ ε/ ij/ 表示/ ./ 对/ / i/ ∈/ [/ 1/ ,/ m/ ]/ 有/ ∑/ {/ jeij/ ∈/ E/ }/ ε/ ij/ =/ li/ -/ l/ -/ [/ 2/ ]/ ,/ 可/ 得/ 如下/ 线性方程组/ :/ 由于/ 负载/ 总/ 迁入/ 量/ 和/ 总/ 迁出/ 量/ 相同/ ,/ 在/ 式/ (/ 1/ )/ 的/ m/ 个/ 等式/ 中/ ,/ 如果/ 其中/ 任意/ m/ -/ 1/ 个/ 成立/ ,/ 则/ 剩余/ 的/ 那个/ 等式/ 必然/ 成立/ ./ 假定/ 式/ (/ 1/ )/ 中/ 线性方程组/ 的/ 系数/ 矩阵/ 为/ 犃/ ,/ 则/ r/ (/ 犃/ )/ / m/ -/ 1/ ,/ 根据/ 线性方程组/ 解/ 的/ 性质/ 可知/ 该/ 线性方程组/ 有/ 无穷/ 多解/ ./ 为/ 减少/ 总/ 的/ 负载/ 迁移/ 量/ ,/ 有/ 必要/ 找出/ 负载/ 迁移/ 量/ 最小/ 的/ 解/ ./ 假定/ 狓/ 为/ 式/ (/ 1/ )/ 中等/ 式/ 左端/ 关于/ ε/ ij/ 的/ 向量/ ,/ 犫/ 为/ 等式/ 右/ 端的/ 列/ 向量/ ,/ 则/ 可/ 将/ 最小化/ 负载/ 迁移/ 量/ 问题/ 归结为/ 如下/ 的/ 二次/ 规划/ 问题/ [/ 17/ ]/ :/ 其中/ :/ 狓/ T/ 为/ 向量/ 狓/ 的/ 转置/ ,/ 犃/ 为/ |/ V/ |/ ×/ |/ E/ |/ 的/ 矩阵/ ,/ |/ V/ |/ 为/ 图/ G/ 中/ 顶点/ 个数/ ,/ |/ E/ |/ 为边/ 个数/ ./ 犃/ |/ V/ |/ ×/ |/ E/ |/ =/ Page13/ [/ aij/ ]/ |/ V/ |/ ×/ |/ E/ |/ ,/ aij/ =/ 上述/ 优化/ 问题/ 为/ 有/ 等式/ 约束/ 的/ 二次/ 规划/ 问题/ ,/ 可/ 采用/ 拉格朗/ 日/ 乘子法/ 求解/ ./ 可/ 构造/ 拉格朗/ 日/ 函数/ 如下/ / (/ 狓/ ,/ λ/ )/ =/ 1/ 令/ / x/ / (/ 狓/ ,/ λ/ )/ =/ 0/ ,/ 得到/ 狓/ -/ 犃/ T/ λ/ =/ 0/ ,/ 即/ 狓/ =/ 犃/ T/ λ/ ./ 将/ x/ 值/ 代入/ 式/ (/ 2/ )/ 中/ ,/ 得/ 犃/ 犃/ T/ λ/ =/ 犫/ ./ 令/ 犔/ =/ 犃/ 犃/ T/ ,/ 可/ 得/ 上述/ 最小化/ 负载/ 迁移/ 量/ 问题/ 转化/ 为式/ (/ 3/ )/ 的/ 线性方程组/ 求解/ 问题/ ,/ 求解/ 式/ (/ 3/ )/ 得到/ 任一/ 顶点/ Si/ 的/ 拉格朗/ 日/ 乘子/ λ/ i/ ,/ 则/ λ/ i/ -/ λ/ j/ 为/ 从/ 节点/ Si/ 到/ Sj/ 的/ 负载/ 迁移/ 量/ ./ 分布式/ 环境/ 多/ 函数/ 依赖/ 冲突检测/ 方法/ Multi/ -/ FDsDetDS/ 如/ 算法/ 5/ 所示/ ./ 算法/ 5/ ./ MultiFDsDetDS/ ./ 输入/ :/ 函数/ 依赖/ 集合/ Σ/ =/ {/ φ/ 1/ ,/ …/ ,/ φ/ m/ }/ ,/ D/ =/ (/ D1/ ,/ …/ ,/ 输出/ :/ Viot/ Π/ (/ φ/ 1/ ,/ D/ )/ ,/ Viot/ Π/ (/ φ/ 2/ ,/ D/ )/ ,/ …/ ,/ Viot/ Π/ (/ φ/ m/ ,/ D/ )/ 1/ ./ L/ ←/ PreDeal/ (/ Σ/ ,/ D/ )/ ;/ // // 数据/ 预处理/ 2/ ./ IFm/ / n/ // // 函数/ 依赖/ 个数/ 大于/ 等于/ 节点/ 个数/ 3/ ./ LoadAllocateByFD/ (/ M/ ,/ L/ )/ ;/ 4/ ./ FOREACHi/ ∈/ [/ 1/ ,/ n/ ]/ DO5/ ./ FOREACH/ {/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ }/ ∈/ L/ (/ i/ )/ DO6/ ./ {/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ }/ ←/ prune/ (/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ )/ ;/ 7/ ./ Viot/ Π/ (/ φ/ j/ ,/ D/ )/ ←/ check/ (/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ )/ ;/ 8/ ./ ENDFOR/ ;/ 9/ ./ ENDFOR/ ;/ 10/ ./ ELSE/ // // 函数/ 依赖/ 个数/ 小于/ 节点/ 个数/ 11/ ./ LoadAllocateByEC/ (/ M/ ,/ Σ/ )/ ;/ 12/ ./ FOREACHj/ ∈/ [/ 1/ ,/ m/ ]/ DO13/ ./ FOREACHSk/ ∈/ L/ (/ j/ )/ DO14/ ./ 散列/ {/ Π/ Xj/ ,/ Π/ Xj/ _/ Yj/ }/ 对应/ 键值/ 对/ 到/ Sk/ ;/ 15/ ./ Dk/ ←/ prune/ (/ Dk/ )/ ;/ 16/ ./ Viot/ Π/ (/ φ/ j/ ,/ D/ )/ ←/ check/ (/ Dk/ )/ ;/ 17/ ./ ENDFOR/ ;/ 18/ ./ ENDFOR/ ;/ 19/ ./ RETURNViot/ Π/ (/ φ/ 1/ ,/ D/ )/ ,/ …/ ,/ Viot/ Π/ (/ φ/ m/ ,/ D/ )/ ./ 算法/ 5/ 的/ 输入/ 为/ 待/ 检测/ 函数/ 依赖/ 集合/ Σ/ 、/ 分布式/ 数据/ D/ 以及/ 处理机/ 集合/ M/ ,/ 输出/ 为/ 违反/ 函数/ 依赖/ 的/ 元组/ 集合/ ./ 算法/ 首先/ 在/ 各个/ 节点/ 对/ 局部/ 数据/ 进行/ 预处理/ ,/ 然后/ 根据/ 函数/ 依赖/ 个数/ 与/ 节点/ 个数/ 的/ 大小/ 情况/ 分别/ 处理/ ./ 如果/ 函数/ 依赖/ 个数/ 大于/ 等于/ 节点/ 个数/ ,/ 则/ 调用/ LoadAllocateByFD/ (/ )/ 进行/ 任务分配/ ,/ 然后/ 在/ 每个/ 处理机/ 上/ 根据/ 当前/ 处理机/ 任务分配/ 的/ 情况/ 对待/ 检测/ 函数/ 依赖/ 的/ 等价/ 类/ 生成/ 树/ 进行/ 剪枝/ ,/ 剪枝/ 后/ 检测/ 冲突/ 元组/ ,/ 最终/ 得到/ 所有/ 违反/ 函数/ 依赖/ 的/ 元组/ ;/ 否则/ 调用/ LoadAllocateByEC/ (/ )/ 进行/ 任务分配/ ,/ 然后/ 对/ 每个/ 函数/ 依赖/ ,/ 散列/ 所有/ 局部/ 划分/ 对应/ 键值/ 对/ 到/ 执行/ 节点/ ,/ 在/ 执行/ 节点/ 对散/ 列后/ 的/ 键值/ 对/ 合并/ ,/ 进一步/ 对/ 等价/ 类/ 生成/ 树/ 剪枝/ ,/ 最后/ 进行/ 不一致性/ 检测/ ,/ 得到/ 违反/ 函数/ 依赖/ 的/ 元组/ 集合/ ./ 5/ 实验/ 结果/ 与/ 分析/ 本文/ 使用/ 真实/ 数据/ 集/ 和/ 人工/ 生成/ 的/ 数据/ 集对/ 本文/ 提出/ 的/ 算法/ 进行/ 了/ 实验/ 验证/ ,/ 测试/ 了/ 算法/ 基于/ 节点/ 规模/ 、/ 数据/ 规模/ 和/ 待/ 检测/ 函数/ 依赖/ 规模/ 的/ 扩展性/ ./ 5.1/ 实验/ 设置/ (/ 1/ )/ 实验/ 环境/ 本/ 实验/ 中/ 使用/ 了/ 通过/ 局域网/ 连接/ 构成/ 的/ 由/ 10/ 台/ 服务器/ 组成/ 的/ 集群/ ,/ 每/ 一台/ 服务器/ 配置/ 如下/ :/ CPU/ 为/ 英特尔/ Xeon2/ ,/ 16GB/ 内存/ ,/ Ubuntu10/ ./ 4/ 操作系统/ ./ 算法/ 由/ Java/ 编写/ ,/ 运行/ 于/ Hadoop/ 及/ Hama/ 并行/ 平台/ ./ (/ 2/ )/ 实验/ 数据/ 实验/ 过程/ 中/ 使用/ 两种/ 数据/ 集/ ,/ 其中/ 一个/ 为/ BureauofTransportationStatistics/ 提供/ 的/ 数据/ 集/ ①/ ,/ 是/ 一个/ 关于/ 航班信息/ 的/ 真实/ 数据/ 集/ ,/ 简称/ “/ AOTS/ ”/ ,/ 包含/ 了/ 64/ 个/ 属性/ ,/ 如/ FlightDate/ 、/ Carrier/ 、/ AirlineID/ 、/ Flight/ -/ Num/ 、/ OriginCityName/ 、/ DestCityName/ 、/ TailNum/ 等/ ./ 数据/ 集/ 包含/ 了/ 15/ 亿条/ 元组/ ,/ 大小/ 为/ 30GB/ ./ 本文/ 使用/ 该/ 数据/ 集/ 生成/ 一个/ 包含/ 8000/ 万条/ 元组/ 的/ 数据库/ 实例/ aots8/ ,/ 一个/ 包含/ 1.2/ 亿条/ 元组/ 的/ 数据库/ 实例/ aots12/ ./ 另外/ 一种/ 数据/ 集是/ 一个/ 人工/ 生成/ 的/ 文中/ 前面/ 提到/ 的/ EMP/ 表/ 的/ 数据/ 集/ ,/ 简称/ “/ EMP/ ”/ ,/ 包含/ 了/ 2/ 亿条/ 元组/ ./ 利用/ 数据/ 集/ EMP/ 生成/ 一个/ 包含/ 8000/ 万条/ 元组/ 的/ 数据库/ 实例/ emp8/ ,/ 一个/ 包含/ 1.2/ 亿条/ 元组/ 的/ 数据库/ 实例/ emp12/ ./ (/ 3/ )/ 函数/ 依赖/ 对于/ 真实/ 数据/ 集/ AOTS/ ,/ 找出/ 一组/ 反映/ 真实/ 约束/ 关系/ 的/ 函数/ 依赖/ ,/ 函数/ 依赖/ 个数/ 为/ 10/ 个/ ,/ 每个/ 包含/ 了/ 2/ ~/ 6/ 个/ 属性/ ,/ 为/ 验证/ 算法/ 的/ 效果/ ,/ 对/ 部分/ 数据/ 人为/ 加入/ 了/ 噪声/ ./ 对于/ 数据/ 集/ EMP/ ,/ 定义/ 了/ 10/ 个/ 函数/ 依赖/ ,/ 为了/ 验证/ 实验/ 效果/ ,/ 在/ 生成/ 数据/ 集时/ 增加/ 了/ 部分/ 噪声/ ./ ①/ BureauofTransportationStatistics/ ./ http/ :/ // // apps/ ./ bts/ ./ gov/ // Page145/ ./ 2/ 实验/ 结果/ 与/ 分析/ 本文/ 设计/ 了/ 3/ 组/ 实验/ 分别/ 对/ 集中式/ 函数/ 依赖/ 冲突检测/ 方法/ CenDet/ 、/ 基于/ Hadoop/ 的/ nave/ 方法/ MultiFDsDetHadoop/ 以及/ 本文/ 提出/ 的/ 多个/ 函数/ 依赖/ 冲突检测/ 方法/ MultiFDsDetDS/ 进行/ 验证/ ./ 为/ 验证/ 方法/ 的/ 节点/ 规模/ 扩展性/ 、/ 数据/ 规模/ 扩展性/ 以及/ 函数/ 依赖/ 规模/ 扩展性/ ,/ 对/ 节点/ 规模/ (/ |/ S/ |/ )/ 、/ 数据/ 集/ 规模/ (/ |/ D/ |/ )/ 以及/ 函数/ 依赖/ 规模/ (/ |/ Σ/ |/ )/ 在/ 不同/ 情况/ 下/ 进行/ 验证/ ./ 首先/ 评估/ 以上/ 3/ 种/ 检测/ 方法/ 基于/ 节点/ 的/ 扩展性/ ,/ 对/ 每/ 一个/ 数据/ 集/ 选取/ 4/ 个/ 函数/ 依赖/ 进行/ 检测/ ./ 实验/ 1/ ./ 改变/ 数据/ 的/ 分片/ 个数/ ./ 为/ 验证/ 算法/ 节点/ 规模/ 的/ 扩展性/ ,/ 在/ 数据/ 集/ 规模/ 不变/ 的/ 情况/ 下/ 逐渐/ 增加/ 集群/ 节点/ 规模/ ,/ 基于/ 数据/ 集/ aots8/ 和/ emp8/ ,/ 对/ 方法/ 的/ 响应/ 时间/ 进行/ 测试/ ./ 图/ 7/ (/ a/ )/ 和/ 图/ 7/ (/ b/ )/ 反映/ 了/ 方法/ CenDet/ 、/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 在/ 不同/ 节点/ 个数/ 下/ 响应/ 时间/ 情况/ ./ 不难看出/ ,/ 在/ 数据/ 规模/ 固定/ 的/ 情况/ 下/ ,/ 随着/ 节点/ 规模/ 的/ 增加/ ,/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 响应/ 时间/ 逐渐/ 减少/ ./ 而/ 集中式/ 方法/ CetDet/ 的/ 响应/ 时间/ 则/ 呈/ 增加/ 的/ 趋势/ ,/ 原因/ 是/ 数据/ 规模/ 的/ 增加/ 导致/ 数据/ 迁移/ 量/ 增大/ ,/ 数据/ 迁移/ 耗时/ 增加/ 导致/ 总/ 的/ 响应/ 时间/ 增大/ ./ 而/ 在/ 同等条件/ 下/ ,/ 方法/ MultiFDsDetDS/ 的/ 响应/ 时间/ 明显/ 小于/ MultiFDsDetHadoop/ ,/ 说明/ 与/ MultiFDsDetHadoop/ 相比/ ,/ 方法/ MultiFDsDetDS/ 的/ 节点/ 扩展性/ 更好/ ,/ 检测/ 效率/ 更高/ ./ 其次/ 评估/ 3/ 种/ 检测/ 方法/ 基于/ 数据/ 的/ 扩展性/ ,/ 对/ 每/ 一个/ 数据/ 集/ 选取/ 4/ 个/ 函数/ 依赖/ 进行/ 检测/ ./ 实验/ 2/ ./ 改变/ 数据/ 的/ 规模/ ./ 为/ 评价/ 方法/ 的/ 数据/ 规模/ 扩展性/ ,/ 在/ 保持/ 节点/ 规模/ (/ 8/ 个/ )/ 固定/ 的/ 情况/ 下/ 对/ 数据/ 规模/ 进行/ 扩展/ ,/ 从/ 2000/ 万条/ 元组/ 开始/ ,/ 每次/ 增加/ 2000/ 万条/ ,/ 直到/ 12000/ 万条/ ,/ 基于/ aots12/ 和/ emp12/ 数据/ 集/ 分别/ 进行/ 验证/ ./ 图/ 8/ (/ a/ )/ 和/ 图/ 8/ (/ b/ )/ 反映/ 了/ 方法/ CenDet/ 、/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 在/ 数据/ 规模/ 扩展/ 时/ 响应/ 时间/ 的/ 变化/ ./ 从/ 实验/ 结果/ 不难看出/ ,/ 随着/ 数据/ 规模/ 的/ 扩大/ ,/ 各/ 方法/ 的/ 响应/ 时间/ 呈/ 增加/ 趋势/ ,/ 而/ 分布式/ 方法/ MultiFDsDetHadoop/ 和/ Page15MultiFDsDetDS/ 比/ 集中式/ 方法/ CenDet/ 的/ 响应/ 时间/ 少/ 很多/ ,/ 说明/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDs/ -/ DetDS/ 的/ 检测/ 效率/ 明显/ 高于/ 集中式/ 方法/ CenDet/ ./ 而且/ 从图/ 8/ (/ a/ )/ 和/ 图/ 8/ (/ b/ )/ 可以/ 看出/ ,/ 在/ 不同/ 数据/ 集/ 的/ 情况/ 下/ ,/ 随着/ 数据/ 规模/ 的/ 不断/ 增大/ ,/ 分布式/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 与/ CetDet/ 相比/ ,/ 在/ 响应/ 时间/ 方面/ 优势/ 更为/ 明显/ ./ 而/ 方法/ Multi/ -/ FDsDetDS/ 与/ MultiFDsDetHadoop/ 相比/ ,/ 在/ 检测/ 效率/ 方面/ 有着/ 明显/ 的/ 提升/ ,/ 而且/ 随着/ 数据/ 规模/ 的/ 增加/ ,/ 这种/ 优势/ 也/ 更加/ 突出/ ,/ 由此可见/ ,/ 本文/ 提出/ 的/ MultiFDs/ -/ DetDS/ 方法/ 在/ 数据/ 扩展性/ 方面/ 明显/ 优于/ 分布式/ 方法/ MultiFDsDetHadoop/ 和/ 集中式/ 方法/ CenDet/ ./ 最后/ 评估/ 3/ 种/ 检测/ 方法/ 基于/ 函数/ 依赖/ 个数/ 的/ 扩展性/ ,/ 集群/ 的/ 节点/ 个数/ |/ S/ |/ 为/ 8/ ./ 实验/ 3/ ./ 改变/ 待/ 检测/ 函数/ 依赖/ 的/ 个数/ ./ 为/ 评价/ 方法/ 在/ 不同/ 数据/ 规模/ 情况/ 下/ 的/ 扩展性/ ,/ 本文/ 在/ 数据/ 规模/ 固定/ 的/ 情况/ 下/ ,/ 增加/ 待/ 检测/ 函数/ 依赖/ 个数/ |/ Σ/ |/ 从/ 1/ 个/ 到/ 8/ 个/ ,/ 分别/ 基于/ 数据/ 集/ aots12/ 和/ emp12/ ,/ 对/ 方法/ 的/ 响应/ 时间/ 进行/ 测试/ ./ 图/ 9/ (/ a/ )/ 和/ 图/ 9/ (/ b/ )/ 反映/ 了/ 方法/ CenDet/ 、/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 在/ 函数/ 依赖/ 规模/ 扩展/ 时/ 的/ 响应/ 时间/ 情况/ ./ 从图/ 9/ (/ a/ )/ 和/ 图/ 9/ (/ b/ )/ 不难看出/ ,/ 随着/ 函数/ 依赖/ 规模/ 的/ 扩展/ ,/ 各/ 方法/ 的/ 响应/ 时间/ 呈/ 增加/ 趋势/ ./ 在/ 函数/ 依赖/ 个数/ 相同/ 的/ 情况/ 下/ ,/ 分布式/ 并行/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 比/ 集中式/ 方法/ CenDet/ 的/ 检测/ 耗时/ 少/ 很多/ ,/ 说明/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDs/ -/ DetDS/ 在/ 同等条件/ 下/ 的/ 检测/ 效率/ 明显/ 高于/ 集中式/ 方法/ CenDet/ ./ 在/ 不同/ 数据/ 集/ 的/ 情况/ 下/ ,/ 随着/ 函数/ 依赖/ 个数/ 的/ 不断/ 增大/ ,/ 分布式/ 方法/ MultiFDsDetHadoop/ 和/ MultiFDsDetDS/ 与/ CetDet/ 相比/ ,/ 在/ 响应/ 时间/ 方面/ 优势/ 更为/ 明显/ ./ 而/ 方法/ MultiFDsDetDS/ 与/ MultiFDs/ -/ DetHadoop/ 相比/ ,/ 检测/ 效率/ 更高/ ,/ 而且/ 随着/ 函数/ 依赖/ 个数/ 的/ 增加/ ,/ 这种/ 优势/ 也/ 更加/ 明显/ ./ 从/ 本组/ 实验/ 可以/ 看出/ ,/ 本文/ 提出/ 的/ MultiFDsDetDS/ 方法/ 在/ 函数/ 依赖/ 规模/ 扩展性/ 方面/ 明显/ 优于/ 分布式/ 方法/ MultiFDsDetHadoop/ 和/ 集中式/ 方法/ CenDet/ ./ 前面/ 对/ 本文/ 提出/ 的/ 方法/ 在/ 效率/ 方面/ 基于/ 真实/ 和/ 人工/ 数据/ 集/ 进行/ 了/ 验证/ ./ 由于/ 本文/ 提出/ 的/ 方法/ 在/ 算法/ 设计/ 时/ 保证/ 所有/ 可能/ 存在/ 相互/ 冲突/ 的/ 元组/ 都/ 被/ 重/ 分布/ 到/ 同一个/ 执行/ 节点/ 进行/ 检测/ ,/ 而且/ 本文/ 基于/ 等价/ 类/ 进行/ 函数/ 依赖/ 冲突检测/ ,/ 论文/ 前面/ 部分/ 通过/ 关于/ 等价/ 类/ 的/ 相关/ 证明/ 以及/ 函数/ 依赖/ 冲突/ 等价/ 类/ 生成/ 树/ 的/ 构建/ 使得/ 函数/ 依赖/ 存在/ 不一致性/ 的/ 元组/ 可以/ 全部/ 被/ 检测/ 出来/ ,/ 因此/ 在/ 实验/ 部分/ 没有/ 必要/ 也/ 不再/ 对/ 本文/ 提出/ 的/ 方法/ 的/ 正确性/ 进行/ 验证/ ./ 6/ 结论/ 本文/ 研究/ 了/ 分布式/ 大/ 数据/ 背景/ 下/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 问题/ ./ 针对/ 分布式/ 环境/ 多/ 函数/ 依赖/ 冲突检测/ 存在/ 的/ 问题/ ,/ 提出/ 了/ 一种/ 基于/ 等价/ 类/ 的/ 分布式/ 并行/ 多/ 函数/ 依赖/ 冲突检测/ 算法/ ./ 论文/ 主要/ 关注/ 的/ 是/ 分布式/ 大/ 数据/ 背景/ 下/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 响应/ 时间/ ,/ 给出/ 了/ 分布式/ 大/ 数据/ 背景/ 下/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 响应/ 时间/ 代价/ 模型/ ,/ 分析/ 了/ 影响/ 多个/ 函数/ 依赖/ 冲突检测/ 响应/ 时间/ 的/ 因素/ ./ 为/ 提高/ 分布式/ 环境/ 多个/ 函数/ 依赖/ 冲突检测/ 的/ 并行度/ 和/ 检测/ 效率/ ,/ 将/ 检测/ 任务分配/ 问题/ 划归/ 为/ 整数/ 规划/ 问题/ ,/ 并/ 给出/ 了/ 多/ 函数/ 依赖/ 冲突检测/ 任务分配/ 的/ 近似/ 最优/ 算法/ ./ 针对/ 集群/ 规模/ 和/ 待/ 检测/ 函数/ 依赖/ 个数/ 的/ 不同/ 情况/ ,/ 给出/ 两种/ 检测/ 任务分配/ 策略/ ./ 为/ 避免/ 检测/ 过程/ 中负载/ 不/ 均衡/ 的/ 情况/ ,/ 在/ 检测/ 过程/ 中/ 动态/ 均衡/ 负载/ ,/ 为/ 减少/ 负载/ 迁移/ 量/ ,/ 将/ 该/ 问题/ 划归/ 为/ 二次/ 规划/ 问题/ ,/ 并/ 采用/ 拉/ Page16/ 格朗日/ 算子/ 法/ 得到/ 最优/ 解/ ./ 基于/ 真实/ 数据/ 集/ 和/ 人工/ 数据/ 集对/ 论文/ 提出/ 的/ 多/ 函数/ 依赖/ 冲突检测/ 算法/ 进行/ 了/ 验证/ ,/ 实验/ 结果表明/ 算法/ 在/ 数据/ 规模/ 、/ 节点/ 个数/ 以及/ 函数/ 依赖/ 个数/ 方面/ 扩展性/ 良好/ ,/ 而且/ 在/ 提高/ 检测/ 效率/ 方面/ 优势/ 明显/ ./ 本文/ 主要/ 研究/ 的/ 是/ 水平/ 切分/ 的/ 数据/ 分布式/ 环境/ 下多/ 函数/ 依赖/ 冲突检测/ 问题/ ,/ 下/ 一步/ 考虑/ 数据/ 垂直/ 切分/ 的/ 情况/ 以及/ 其他/ 完整性/ 约束/ 在/ 分布式/ 环境/ 下/ 的/ 不一致性/ 检测/ 问题/ ./ 

