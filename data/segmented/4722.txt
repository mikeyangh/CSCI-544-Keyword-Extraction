Page1/ 免/ 预设/ 间隔/ 约束/ 的/ 对比/ 序列/ 模式/ 高效/ 挖掘/ 1/ )/ (/ 四川大学/ 计算机/ 学院/ 成都/ 610065/ )/ 2/ )/ (/ 四川大学/ 华西/ 公共卫生/ 学院/ 成都/ 610041/ )/ 3/ )/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430072/ )/ 摘要/ 对比/ 序列/ 模式/ 在/ 识别/ 不同/ 类别/ 序列/ 样本/ 集合/ 的/ 特征/ 上/ 有着/ 重要/ 的/ 作用/ ./ 已有/ 对比/ 序列/ 模式/ 挖掘/ 算法/ 需要/ 用户/ 预设/ 间隔/ 约束/ ./ 在/ 不/ 具备/ 充分/ 先验/ 知识/ 情况/ 下/ ,/ 用户/ 不易/ 准确/ 地/ 预设/ 恰当/ 的/ 间隔/ 约束/ ,/ 进而/ 导致/ 不能/ 发现/ 有用/ 的/ 模式/ ./ 对此/ ,/ 文中/ 设计/ 了/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 挖掘/ 算法/ ,/ 实现/ 免/ 预设/ 间隔/ 约束/ ,/ 并/ 对/ 候选/ 模式/ 自动/ 计算/ 最/ 适合/ 的/ 间隔/ 约束/ ./ 此外/ ,/ 设计/ 了/ 3/ 种/ 剪枝/ 策略/ 来/ 提高/ 算法/ 的/ 执行/ 效率/ ./ 通过/ 蛋白质/ 序列/ 、/ DNA/ 序列/ 、/ 行为/ 序列/ 数据/ 集/ 验证/ 了/ 提出/ 的/ 算法/ 的/ 有效性/ 和/ 高效率/ ./ 关键词/ 对比/ 序列/ 模式/ ;/ 间隔/ 约束/ ;/ 序列/ 数据挖掘/ 1/ 引言/ 序列/ 模式/ 挖掘/ 作为/ 数据挖掘/ 的/ 一项/ 重要/ 任务/ ,/ 有着/ 广泛/ 的/ 应用/ ./ 例如/ :/ 广电/ 服务商/ 分析/ 用户/ 的/ 收视/ 纪录/ ,/ 发现/ 用户/ 的/ 收视/ 喜好/ ,/ 可/ 为/ 节目/ 编排/ 提供/ 决策/ 支持/ ./ 再/ 如/ :/ 分析/ 传染病/ 传播/ 的/ 时空/ 监测数据/ ,/ 可望/ 发现/ 传染病/ 时空/ 聚集/ 性/ 暴发/ 规律/ ,/ 进而/ 为/ 防控/ 工作/ 提供/ 参考/ ./ 与此同时/ ,/ 序列/ 模式/ 挖掘/ 也/ 受到/ 了/ 众多/ 研究者/ 的/ 关注/ ,/ 不同/ 类型/ 的/ 序列/ 模式/ 被/ 陆续/ 提出/ ,/ 如/ 频繁/ 序列/ 模式/ [/ 1/ -/ 2/ ]/ 、/ 闭合/ 序列/ 模式/ [/ 3/ ]/ 、/ 对比/ 序列/ 模式/ [/ 4/ ]/ 、/ 周期/ 模式/ [/ 5/ ]/ 和/ 偏序/ 模式/ [/ 6/ ]/ 等/ ./ 给定/ 正类/ 序列/ 样本/ 集合/ 和/ 负类/ 序列/ 样本/ 集合/ ,/ 对比/ 序列/ 模式/ 描述/ 在/ 正类/ 序列/ 样本/ 集合/ 中/ 频繁/ (/ 模式/ 的/ 支持/ 度/ 大于/ 指定/ 阈值/ α/ )/ 、/ 且/ 在/ 负类/ 序列/ 样本/ 集合/ 中/ 不/ 频繁/ (/ 模式/ 的/ 支持/ 度/ 小于/ 指定/ 阈值/ β/ )/ 的/ 项集/ ./ 对比/ 序列/ 模式/ 能/ 识别/ 不同/ 类别/ 序列/ 样本/ 集合/ 间/ 的/ 差异/ ,/ 并/ 描述/ 各类/ 别/ 样本/ 集合/ 的/ 特征/ ,/ 因此/ 适用/ 于/ 多个/ 领域/ 的/ 序列/ 数据分析/ ./ 例如/ :/ 在/ 医学/ 领域/ ,/ 分析/ 阳性/ 肿瘤/ 和/ 阴性/ 肿瘤/ 的/ DNA/ 序列/ ,/ 识别/ 对比/ 序列/ 模式/ ,/ 能够/ 提高/ 临床/ 诊断/ 的/ 精度/ ;/ 在/ 商业/ 领域/ ,/ 对比/ 不同/ 年龄段/ 顾客/ 的/ 购物/ 行为/ ,/ 发现/ 各/ 年龄段/ 顾客/ 的/ 购物/ 模式/ ,/ 可以/ 提高/ 商品/ 促销/ 活动/ 的/ 针对性/ ./ 模式/ 的/ 支持/ 度/ 反映/ 了/ 序列/ 集合/ 中有/ 多/ 大/ 比例/ 的/ 样本/ 能够/ 与/ 之/ 匹配/ ./ 简而言之/ ,/ 匹配/ 即/ 模式/ 在/ 序列/ 中/ 出现/ ./ 例如/ :/ 模式/ P/ =/ aed/ 与/ 序列/ S/ =/ aedcbfdc/ 匹配/ ./ 为了/ 提高/ 模式/ 的/ 适用性/ ,/ 允许/ 模式/ 元素/ 间/ 出现/ 通配符/ ①/ ,/ 即/ 允许/ 模式/ 元素/ 不/ 相邻/ 地/ 出现/ 在/ 序列/ 中/ ./ 例如/ :/ P/ =/ a/ $/ $/ c/ $/ f/ 与/ 序列/ S/ =/ aedcbfdc/ 匹配/ ./ 元素/ 之间/ 的/ 连续/ 的/ 通配符/ 个数/ 称为/ 间隔/ ;/ 为/ 提高/ 序列/ 模式匹配/ 的/ 适用性/ 并且/ 方便/ 表达/ ,/ 采用/ 区间/ 来/ 表达/ 序列/ 模式/ 元素/ 两/ 两间/ 通配符/ 个数/ 的/ 最小值/ 和/ 最大值/ ,/ 我们/ 称/ 这个/ 区间/ 为/ 间隔/ 约束/ ./ 例如/ :/ 给定/ 模式/ P/ =/ ac/ ,/ 设/ 间隔/ 约束/ 为/ [/ 1/ ,/ 2/ ]/ ,/ 若/ P/ 与/ 序列/ S/ 匹配/ ,/ 意味着/ 在/ S/ 中/ 元素/ a/ 和/ 元素/ c/ 间/ 最少/ 出现/ 1/ 个/ 元素/ ,/ 最/ 多/ 出现/ 2/ 个/ 元素/ ./ 在/ 已有/ 对比/ 序列/ 模式/ 挖掘/ 的/ 研究/ [/ 4/ ,/ 7/ -/ 8/ ]/ 中/ ,/ 间隔/ 约束/ 作为/ 挖掘/ 参数/ 与/ 支持/ 度/ 阈值/ 一同/ 需要/ 用户/ 设定/ ./ 实践/ 表明/ ,/ 在/ 没有/ 足够/ 先验/ 知识/ 时/ ,/ 用户/ 很难/ 设定/ 恰当/ 的/ 间隔/ 约束/ ,/ 失当/ 的/ 间隔/ 约束/ ,/ 会/ 使/ 发现/ 的/ 模式/ 偏离/ 预期/ 的/ 结果/ ,/ 如例/ 1/ 所示/ ./ 例/ 1/ ./ 给定/ 表/ 1/ 描述/ 的/ 正类/ 序列/ 样本/ 集合/ pos/ 和/ 负类/ 序列/ 样本/ 集合/ neg/ ,/ 挖掘/ 与/ 所有/ 正类/ 序列/ 样本/ 匹配/ 、/ 但/ 不/ 与/ 任何/ 负类/ 序列/ 样本/ 匹配/ 的/ 模式/ ./ 结果表明/ :/ 当/ 间隔/ 约束/ 为/ [/ 1/ ,/ 1/ ]/ 时/ ,/ 模式/ ad/ 和/ cf/ 满足条件/ ;/ 当/ 间隔/ 约束/ 为/ [/ 2/ ,/ 2/ ]/ 时/ ,/ 模式/ df/ 满足条件/ ;/ 当/ 间隔/ 约束/ 为/ [/ 2/ ,/ 3/ ]/ 时/ ,/ 模式/ acc/ 满足条件/ ;/ 当/ 间隔/ 约束/ 为/ [/ 0/ ,/ 3/ ]/ 时/ ,/ 模式/ ab/ 满足条件/ ./ 例/ 1/ 表明/ ,/ 设置/ 不/ 恰当/ 的/ 间隔/ 约束/ 可能/ 导致/ 无法/ 发现/ 有用/ 的/ 对比/ 序列/ 模式/ ./ 逐个/ 预设/ 所有/ 可能/ 的/ 间隔/ 约束/ 显然/ 效率/ 低下/ ,/ 而且/ 不/ 可行/ ./ 能否/ 自动/ 计算/ 最合适/ 的/ 间隔/ 约束/ ,/ 使/ 用户/ 能/ 更/ 简便/ 、/ 高效/ 地/ 获得/ 对比/ 序列/ 模式/ 挖掘/ 结果/ 呢/ ?/ 据/ 我们/ 所知/ ,/ 目前/ 还/ 没有/ 对比/ 序列/ 模式/ 挖掘/ 研究/ 工作/ 考虑/ 了/ 在/ 挖掘/ 过程/ 中/ 自动/ 计算/ 合适/ 的/ 间隔/ 约束/ ./ 本文/ 为/ 响应/ 这一/ 需求/ ,/ 作/ 了/ 下列/ 主要/ 工作/ :/ (/ 1/ )/ 分析/ 了/ 间隔/ 约束/ 设置/ 对/ 对比/ 序列/ 模式/ 挖掘/ 的/ 影响/ ;/ (/ 2/ )/ 提出/ 了/ 免/ 预设/ 间隔/ 约束/ 的/ 对比/ 序列/ 模式/ 挖掘/ 问题/ ,/ 避免/ 了/ 用户/ 预设/ 参数/ ,/ 有助于/ 推动/ 数据挖掘/ 的/ 实践/ ;/ (/ 3/ )/ 设计/ 了/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 挖掘/ 算法/ ,/ 并/ 通过/ 翔实/ 的/ 实验/ 验证/ 了/ 算法/ 的/ 有效性/ 和/ 执行/ 效率/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 工作/ ;/ 第/ 3/ 节/ 定义/ 本文/ 的/ 研究/ 问题/ ;/ 第/ 4/ 节/ 讲述/ 本文/ 设计/ 的/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 挖掘/ 算法/ ,/ 该/ 算法/ 不/ 需要/ 预设/ 间隔/ 约束/ ;/ 第/ 5/ 节在/ 真实世界/ 的/ DNA/ 序列/ 数据/ 集/ 、/ 蛋白质/ 序列/ 数据/ 集/ 和/ 用户/ 行为/ 序列/ 数据/ 集上/ 验证/ 本文/ 提出/ 算法/ 的/ 有效性/ 和/ 执行/ 效率/ ;/ 第/ 6/ 节/ 总结/ 本文/ 工作/ ,/ 并/ 对/ 下/ 一步/ 工作/ 进行/ 展望/ ./ 2/ 相关/ 工作/ 分析/ 序列/ 数据/ 并/ 提取/ 有用/ 的/ 模式/ ,/ 例如/ :/ 频繁/ 序列/ 模式/ [/ 1/ -/ 2/ ]/ 、/ 闭合/ 序列/ 模式/ [/ 3/ ]/ 、/ 对比/ 序列/ 模式/ [/ 4/ ]/ 、/ 周期/ 模式/ [/ 5/ ]/ 及/ 偏序/ 模式/ [/ 6/ ]/ 等/ ,/ 能够/ 提高/ 人们/ 对/ 数据/ 蕴含/ 知识/ 的/ 发现/ 能力/ ,/ 因而/ 受到/ 研究者/ 的/ 持续/ 关注/ ./ 由于/ 篇幅/ 有限/ ,/ 更/ 多/ 序列/ 数据挖掘/ 的/ 研究/ 及其/ 应用/ 请参阅/ 文献/ [/ 9/ -/ 11/ ]/ ./ 在/ 序列/ 模式/ 中/ 考虑/ 间隔/ 约束/ ,/ 能够/ 允许/ 序列/ 模/ ①/ 通配符/ 可/ 与/ 任意/ 符号/ 匹配/ ,/ 本文/ 用/ ‘/ $/ ’/ 指代/ ./ Page3/ 式/ 与/ 序列/ 样本/ 进行/ 匹配/ 时/ ,/ 序列/ 模式/ 元素/ 间/ 间隔/ 一定/ 数量/ 的/ 任意/ 元素/ ./ 这样/ ,/ 可以/ 提高/ 序列/ 模式/ 的/ 适用性/ ,/ 因而/ 间隔/ 约束/ 被/ 普遍/ 地/ 应用/ 于/ 序列/ 模式/ 挖掘/ 中/ ./ 文献/ [/ 12/ ]/ 在/ PrefixSpan/ 算法/ [/ 13/ ]/ 基础/ 上/ 设计/ 了/ 带/ 间隔/ 约束/ 的/ 序列/ 模式/ 挖掘/ 算法/ ./ 文献/ [/ 14/ ]/ 研究/ 了/ 从/ 给定/ DNA/ 序列/ 中/ 挖掘/ 满足/ 支持/ 度/ 阈值/ 和/ 间隔/ 约束/ 的/ 频繁/ 序列/ 模式/ 的/ 算法/ ./ 文献/ [/ 15/ ]/ 设计/ 了/ Gap/ -/ BIDE/ 算法/ 挖掘/ 带/ 间隔/ 约束/ 的/ 闭合/ 序列/ 模式/ ./ 文献/ [/ 5/ ]/ 针对/ 单条/ 序列/ 样本/ ,/ 研究/ 了/ 满足/ 给定/ 间隔/ 约束/ 的/ 频繁/ 周期/ 模式/ ./ 文献/ [/ 16/ ]/ 设计/ 了/ 利用/ 带/ 间隔/ 约束/ 的/ 序列/ 模式/ 发现/ 软件缺陷/ 特征/ 的/ 方法/ ./ 请/ 注意/ ,/ 在/ 这些/ 研究/ 工作/ 中/ ,/ 间隔/ 约束/ 均/ 作为/ 算法/ 运行/ 参数/ 之一/ ,/ 由/ 用户/ 预先指定/ ./ 对比/ 序列/ 模式/ 挖掘/ [/ 4/ ,/ 7/ -/ 8/ ]/ 旨在/ 从/ 两类/ 序列/ 样本/ 中/ ,/ 发现/ 在/ 一类/ 样本/ 中/ 频繁/ 出现/ ,/ 但/ 在/ 另一类/ 中/ 不/ 频繁/ 出现/ 的/ 序列/ 模式/ ./ 文献/ [/ 4/ ]/ 定义/ 了/ 对比/ 序列/ 模式/ 问题/ 并/ 设计/ 了/ 挖掘/ 算法/ ConSGapMiner/ ./ 文献/ [/ 7/ ]/ 应用/ 对比/ 序列/ 模式/ 于/ 蛋白质/ 序列/ 实现/ 多肽/ 折叠/ 分类/ 的/ 预测/ ./ 文献/ [/ 8/ ]/ 在/ 考虑/ 支持/ 度/ 计算/ 过程/ 中/ 引入/ 了/ 模式/ 出现/ 密度/ 的/ 概念/ ./ 值得一提的是/ ,/ 文献/ [/ 4/ ,/ 7/ -/ 8/ ]/ 中/ 对比/ 序列/ 模式/ 间隔/ 约束/ 的/ 范围/ 需要/ 用户/ 预先指定/ ,/ 而/ 本文/ 设计/ 了/ 根据/ 对比/ 序列/ 模式/ 自动/ 计算/ 间隔/ 约束/ 的/ 方法/ ./ 在/ 生物/ 序列/ 分析/ 中/ 常用/ motif/ [/ 17/ ]/ 来/ 描述/ 在/ 序列/ 样本/ 特定/ 位置/ 频繁/ 出现/ 的/ 模式/ ./ 但是/ ,/ motif/ 挖掘/ 与/ 本文/ 工作/ 有/ 以下/ 本质区别/ ./ 首先/ ,/ motif/ 挖掘/ 只/ 考虑/ 单一/ 类别/ 的/ 序列/ 样本/ 集合/ ,/ 而/ 对比/ 序列/ 模式/ 挖掘/ 分析/ 对象/ 为/ 两类/ 序列/ 样本/ 集合/ ;/ 其次/ ,/ 对比/ 序列/ 模式/ 不/ 要求/ 模式/ 中/ 各/ 元素/ 必须/ 在/ 序列/ 中/ 某/ 特定/ 位置/ 出现/ ;/ 最后/ ,/ 对比/ 序列/ 模式/ 中/ 各/ 元素/ 间/ 的/ 间隔/ 是/ 相对/ 位置/ ,/ 并非/ motif/ 中/ 元素/ 在/ 序列/ 中/ 的/ 特定/ 位置/ ./ 因此/ ,/ motif/ 挖掘/ 算法/ 并/ 不能/ 直接/ 适用/ 于/ 本文/ 研究/ 内容/ ./ 尽管/ 间隔/ 约束/ 能够/ 提高/ 序列/ 模式/ 的/ 适用性/ ,/ 但/ 需要/ 注意/ 的/ 是/ 在/ 不/ 具备/ 先验/ 知识/ 的/ 前提/ 下/ ,/ 用户/ 很难/ 恰当/ 地/ 设定/ 间隔/ 约束/ ./ 而/ 不/ 恰当/ 的/ 间隔/ 约束/ 必然/ 导致/ 不能/ 发现/ 或者/ 遗漏/ 序列/ 模式/ ./ 对此/ ,/ 本文/ 研究/ 了/ 免/ 预设/ 间隔/ 约束/ 的/ 对比/ 序列/ 模式/ 挖掘/ 问题/ ./ 文献/ [/ 18/ ]/ 研究/ 了/ 生物/ 序列/ 数据/ 中/ 序列/ 模式/ 发现/ 的/ 问题/ ,/ 并且/ 根据/ 模式/ 出现/ 的/ 位置/ 自动/ 计算/ 间隔/ 约束/ ./ 虽然/ 文献/ [/ 18/ ]/ 自动/ 计算/ 间隔/ 约束/ ,/ 但/ 与/ 本文/ 工作/ 相比/ 仍然/ 有/ 以下/ 本质区别/ :/ 首先/ ,/ 文献/ [/ 18/ ]/ 是/ 针对/ 一条/ 长/ 序列/ 进行/ 挖掘/ ,/ 其/ 设计/ 的/ 基于/ Apriori/ 产生/ 候选/ 模式/ 的/ 算法/ 框架/ 不适/ 用于/ 对比/ 序列/ 模式/ 挖掘/ ./ 其次/ ,/ 文献/ [/ 18/ ]/ 的/ 挖掘/ 对象/ 没有/ 类别/ ,/ 而/ 本文/ 的/ 挖掘/ 对象/ 则/ 是/ 两个/ 属于/ 不同/ 类/ 的/ 序列/ 样本/ 集合/ ./ 第三/ ,/ 文献/ [/ 18/ ]/ 基于/ 模式/ 出现/ 位置/ 没有/ 重叠/ 的/ 前提/ 计算/ 间隔/ 约束/ ./ 相/ 比较而言/ ,/ 本文/ 提出/ 的/ 计算方法/ (/ 本文/ 第/ 4/ 节/ )/ 没有/ 此/ 限定/ ,/ 因而/ 更加/ 灵活/ 、/ 通用/ ./ 据/ 我们/ 所知/ ,/ 目前/ 还/ 没有/ 对比/ 序列/ 模式/ 挖掘/ 研究/ 工作/ 考虑/ 了/ 在/ 挖掘/ 过程/ 中/ 自动/ 计算/ 间隔/ 约束/ ./ 3/ 问题/ 定义/ 记/ Σ/ 为/ 序列/ 元素/ 的/ 集合/ ./ 例如/ :/ 对于/ DNA/ 序列/ ,/ Σ/ =/ {/ G/ ,/ C/ ,/ A/ ,/ T/ }/ ;/ 对于/ 蛋白质/ 序列/ ,/ Σ/ 包含/ 20/ 种/ 基本/ 氨基酸/ 的/ 编码/ ./ 给定/ Σ/ ,/ 任一/ 序列/ S/ 可/ 形式化/ 地/ 描述/ 为/ S/ =/ e1e2/ …/ en/ ,/ 其中/ ek/ ∈/ Σ/ 称为/ S/ 的/ 一个/ 元素/ ,/ k/ 是/ 区间/ [/ 1/ ,/ n/ ]/ 中/ 的/ 正整数/ ,/ 称为/ S/ 元素/ 的/ 下标/ ./ 为/ 便于/ 表述/ ,/ 用/ S/ [/ k/ ]/ 指代/ 序列/ S/ 中/ 的/ 第/ k/ 个/ 元素/ ,/ 用/ |/ S/ |/ 指代/ 序列/ S/ 的/ 长度/ ,/ 即/ S/ 包含/ 的/ 元素/ 的/ 个数/ ./ 例如/ :/ S/ =/ aedcbfdc/ ,/ 则/ S/ [/ 4/ ]/ =/ c/ ,/ |/ S/ |/ =/ 8/ ./ 对于/ 序列/ S/ ,/ 若/ 存在/ 正整数/ 序列/ 〈/ k1/ ,/ …/ ,/ km/ 〉/ ,/ 满足/ 1/ / k1/ </ …/ </ km/ / |/ S/ |/ ,/ 且/ S/ =/ S/ [/ k1/ 称/ 序列/ S/ 是/ S/ 的/ 子/ 序列/ (/ S/ 包含/ S/ )/ ,/ 记为/ S/ / S/ ./ 为/ 便于/ 描述/ ,/ 在/ 给定/ S/ 的/ 前提/ 下/ ,/ 我们/ 用/ S/ 各个/ 元素/ 在/ S/ 中/ 的/ 下标/ (/ 〈/ k1/ ,/ …/ ,/ km/ 〉/ )/ 指代/ S/ ,/ 并称/ 〈/ k1/ ,/ …/ ,/ km/ 〉/ 是/ S/ 在/ S/ 中/ 出现/ 的/ 一个/ 实例/ ./ 例如/ :/ 对于/ S/ =/ aedcbfdc/ ,/ 用/ 〈/ 2/ ,/ 4/ ,/ 7/ 〉/ 指代/ 子/ 序列/ S/ =/ ecd/ ./ 对/ 序列/ S/ 中/ 任意/ 的/ 两个/ 元素/ S/ [/ i/ ]/ 和/ S/ [/ j/ ]/ (/ 1/ / i/ </ j/ / |/ S/ |/ )/ ,/ 出现/ 在/ S/ [/ i/ ]/ 和/ S/ [/ j/ ]/ 之间/ 的/ 元素/ 个数/ 称为/ S/ [/ i/ ]/ 和/ S/ [/ j/ ]/ 的/ 间隔/ ,/ 记为/ Gap/ (/ S/ ,/ i/ ,/ j/ )/ ./ 容易/ 看出/ ,/ Gap/ (/ S/ ,/ i/ ,/ j/ )/ =/ j/ -/ i/ -/ 1/ ./ 例如/ :/ 在/ S/ =/ aedcbfdc/ 中/ 元素/ e/ (/ S/ [/ 2/ ]/ )/ 和/ 元素/ b/ (/ S/ [/ 5/ ]/ )/ 之间/ 的/ 间隔/ Gap/ (/ S/ ,/ 2/ ,/ 5/ )/ =/ 2/ ./ 定义/ 1/ (/ 间隔/ 约束/ )/ ./ 间隔/ 约束/ γ/ 为/ 一个/ 整数/ 域/ 区间/ ,/ 记/ 作/ γ/ =/ [/ γ/ ./ min/ ,/ γ/ ./ max/ ]/ ,/ 其中/ γ/ ./ min/ ,/ γ/ ./ max/ ∈/ Ζ/ +/ γ/ ./ max/ 为/ γ/ 的/ 上界/ ,/ γ/ ./ max/ -/ γ/ ./ min/ 为/ γ/ 的/ 宽度/ ./ 设/ 〈/ k1/ ,/ …/ ,/ km/ 〉/ 为/ 序列/ S/ 的/ 一个/ 子/ 序列/ ,/ 若/ γ/ ./ min/ / kl/ +/ 1/ -/ kl/ -/ 1/ / γ/ ./ max/ (/ 1/ / l/ </ m/ )/ ,/ 则/ 称子/ 序列/ 〈/ k1/ ,/ …/ ,/ km/ 〉/ 满足/ 间隔/ 约束/ γ/ ./ 定义/ 2/ (/ γ/ -/ 匹配/ )/ ./ 给定/ 间隔/ 约束/ γ/ ,/ 序列/ P/ 和/ 序列/ S/ ./ 若/ S/ 有子/ 序列/ 〈/ k1/ ,/ …/ ,/ k/ |/ P/ |/ 〉/ 满足/ γ/ ,/ 且/ P/ =/ S/ [/ k1/ ]/ …/ S/ [/ k/ 例/ 2/ ./ 令/ 序列/ P/ =/ ef/ ,/ 序列/ S/ =/ aedcbfdc/ ./ 若/ γ/ =/ [/ 2/ ,/ 3/ ]/ ,/ 那么/ 由于/ P/ =/ S/ [/ 2/ ]/ S/ [/ 6/ ]/ ,/ 且/ γ/ ./ min/ / Gap/ (/ S/ ,/ 2/ ,/ 6/ )/ / γ/ ./ max/ ,/ P/ ,/ S/ 满足/ γ/ -/ 匹配/ ;/ 若/ γ/ =/ [/ 1/ ,/ 2/ ]/ ,/ 那么/ Gap/ (/ S/ ,/ 2/ ,/ 6/ )/ / [/ 1/ ,/ 2/ ]/ ,/ P/ 不/ 匹配/ S/ ./ Page4/ 对于/ 任一/ 序列/ S/ 以及/ S/ 的/ 子/ 序列/ P/ 和/ P/ ,/ 且/ P/ / P/ ,/ 若/ P/ ,/ S/ 满足/ γ/ -/ 匹配/ ,/ 则/ P/ ,/ S/ 不/ 一定/ 满足/ γ/ -/ 匹配/ ,/ 如例/ 3/ 所示/ ./ 例/ 3/ ./ 给定/ 序列/ S/ =/ aedcbfdc/ ,/ 令/ 序列/ P/ =/ adc/ ,/ 序列/ P/ =/ ac/ ./ 容易/ 看出/ P/ / P/ ./ 令/ 间隔/ 约束/ γ/ =/ [/ 0/ ,/ 1/ ]/ ,/ 由于/ P/ =/ S/ [/ 1/ ]/ S/ [/ 3/ ]/ S/ [/ 4/ ]/ ,/ 且/ γ/ ./ min/ / Gap/ (/ S/ ,/ 1/ ,/ 3/ )/ / γ/ ./ max/ ,/ γ/ ./ min/ / Gap/ (/ S/ ,/ 3/ ,/ 4/ )/ / γ/ ./ max/ ,/ P/ ,/ S/ 满足/ γ/ -/ 匹配/ ;/ 而/ P/ =/ S/ [/ 1/ ]/ S/ [/ 4/ ]/ ,/ Gap/ (/ S/ ,/ 1/ ,/ 4/ )/ / [/ 0/ ,/ 1/ ]/ ,/ 因此/ P/ 不/ 匹配/ S/ ./ 给定/ 间隔/ 约束/ γ/ ,/ 序列/ 集合/ D/ ,/ 序列/ P/ 在/ D/ 中/ 的/ 支持/ 度/ (/ 记为/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ )/ 为/ D/ 中/ 与/ P/ 满足/ γ/ -/ 匹配/ 的/ 序列/ 的/ 比例/ ,/ 即/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ =/ 序列/ 模式/ 表达/ 了/ 元素/ 在/ 序列/ 中/ 出现/ 的/ 先后顺序/ ./ 在/ 序列/ 模式匹配/ 中/ 考虑/ 间隔/ 约束/ ,/ 能/ 避免/ 因为/ 序列/ 中/ 噪声/ 元素/ 影响/ 而/ 不能/ 匹配/ 的/ 情况/ ,/ 从而/ 提高/ 模式/ 的/ 适用性/ ./ 但是/ ,/ 间隔/ 约束/ 的/ 宽度/ 过/ 大会/ 降低/ 序列/ 模式/ 本身/ 表达/ 含义/ 的/ 精度/ ./ 因此/ ,/ 本文/ 在/ 满足/ 支持/ 度/ 阈值/ 的/ 相同/ 前提/ 下/ ,/ 选择/ 宽度/ 小/ 的/ 间隔/ 约束/ 作为/ 挖掘/ 结果/ ./ 对/ 宽度/ 相同/ 的/ 间隔/ 约束/ ,/ 则/ 优先选择/ 下界/ 小/ 的/ 作为/ 结果/ ./ 为/ 提高/ 序列/ 模式/ 的/ 实用性/ 以及/ 计算/ 效率/ ,/ 序列/ 模式/ 挖掘/ 通常/ 以/ 发现/ 满足/ 特定条件/ 的/ “/ 最小/ ”/ 序列/ 模式/ 为/ 目标/ [/ 4/ ,/ 8/ ,/ 19/ ]/ ,/ 即/ 包含/ “/ 最小/ ”/ 序列/ 模式/ 的/ 序列/ 不/ 作为/ 挖掘/ 结果/ 输出/ ./ 例如/ ,/ 给定/ 序列/ P/ 和/ P/ ,/ 且/ P/ / P/ ,/ 若/ P/ 和/ P/ 均/ 满足/ 支持/ 度/ 阈值/ 要求/ ,/ 则/ 只/ 将/ P/ 作为/ 挖掘/ 结果/ 输出/ ./ 不失/ 一般性/ ,/ 我们/ 沿用/ 此/ 约束/ ,/ 挖掘/ 最小/ 对比/ 序列/ 模式/ ./ 定义/ 3/ 给出/ 了/ 本文/ 提出/ 的/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 的/ 定义/ ./ 定义/ 3/ (/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ )/ ./ 给定/ 两个/ 序列/ 集合/ pos/ (/ 正类/ 样本/ 集合/ )/ 和/ neg/ (/ 负类/ 样本/ 集合/ )/ ,/ 设/ α/ 和/ β/ 为/ 支持/ 度/ 阈值/ ,/ 如果/ 存在/ 间隔/ 约束/ γ/ ,/ 使得/ 序列/ P/ 满足/ 如下/ 条件/ (/ i/ )/ ~/ (/ iv/ )/ ,/ 那么/ 称/ 〈/ P/ ,/ γ/ 〉/ 为/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ (/ i/ )/ 在/ 序列/ 集合/ pos/ 中/ 频繁/ :/ suppos/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / α/ ;/ (/ ii/ )/ 在/ 序列/ 集合/ neg/ 中/ 不/ 频繁/ :/ supneg/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / β/ ;/ (/ iii/ )/ 模式/ 最小化/ :/ 不/ 存在/ 序列/ P/ 和/ 间隔/ 约束/ γ/ ,/ 满足/ P/ / P/ ,/ P/ ≠/ P/ ,/ 使得/ 对/ P/ 和/ γ/ ,/ 条件/ (/ i/ )/ 、/ (/ ii/ )/ 成立/ ;/ (/ iv/ )/ 间隔/ 约束/ 最/ 紧凑/ :/ 对于/ P/ ,/ 不/ 存在/ 符合/ 如下/ 任一/ 条件/ 的/ 间隔/ 约束/ γ/ ,/ 使得/ 条件/ (/ i/ )/ 、/ (/ ii/ )/ 成立/ ;/ (/ a/ )/ 间隔/ 约束/ 宽度/ 最小/ :/ (/ γ/ ./ max/ -/ γ/ ./ min/ )/ </ (/ γ/ ./ max/ -/ γ/ ./ min/ )/ ;/ (/ b/ )/ 宽度/ 相等/ 时/ 下界/ 最小/ :/ (/ γ/ ./ max/ -/ γ/ ./ min/ )/ =/ (/ γ/ ./ max/ -/ γ/ ./ min/ )/ 且/ γ/ ./ min/ </ γ/ ./ min/ ./ 请/ 注意/ ,/ 定义/ 3/ 中/ 模式/ 最小化/ 条件/ 只是/ 限定/ 模式/ 之间/ 的/ 包含/ 关系/ ,/ 并/ 不/ 限定/ 模式/ 的/ 长度/ ./ 本文/ 第/ 5/ 节/ 的/ 实验/ 结果表明/ ,/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 的/ 长度/ 可以/ 为/ 任意/ 值/ ./ 对比/ 文献/ [/ 4/ ]/ 中/ 最小/ 对比/ 序列/ 模式/ 的/ 定义/ ,/ 本文/ 提出/ 的/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 是/ 由/ 序列/ P/ 和/ 间隔/ 约束/ γ/ 组成/ 的/ 二元/ 组/ 〈/ P/ ,/ γ/ 〉/ ./ 这样/ ,/ 既/ 保留/ 了/ 对比/ 序列/ 模式/ 能/ 有效/ 识别/ 不同/ 类别/ 序列/ 样本/ 集合/ 间/ 差异/ 的/ 性质/ (/ 条件/ (/ i/ )/ 和/ (/ ii/ )/ )/ 和/ 最小化/ (/ 条件/ (/ iii/ )/ )/ ,/ 并且/ γ/ 作为/ 计算结果/ 不/ 需要/ 在/ 挖掘/ 前/ 预设/ ./ 因此/ ,/ 本文/ 提出/ 的/ 模式/ 表达/ 更加/ 灵活/ ,/ 同时/ 在实践中/ 算法/ 运行/ 参数设置/ 更/ 简单/ ,/ 更/ 容易/ 为/ 用户/ 使用/ ,/ 具有/ 更强/ 的/ 实用性/ ./ 简而言之/ ,/ 本文/ 研究/ 的/ 免/ 预设/ 间隔/ 约束/ 的/ 对比/ 序列/ 模式/ 挖掘/ 问题/ 为/ :/ 在/ 仅/ 指定/ 支持/ 度/ 阈值/ α/ 和/ β/ 的/ 情况/ 下/ ,/ 从/ 序列/ 集合/ pos/ 和/ neg/ 中/ 挖掘出/ 所有/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ,/ 即/ {/ 〈/ P/ ,/ γ/ 〉/ |/ P/ ,/ γ/ 满足/ 定义/ 3/ 中/ 的/ 条件/ (/ i/ )/ ~/ (/ iv/ )/ }/ ./ 例/ 4/ ./ 根据/ 表/ 1/ 所示/ 正类/ 序列/ 样本/ 集合/ pos/ 和/ 负类/ 序列/ 样本/ 集合/ neg/ ,/ 令/ α/ =/ 1.0/ ,/ β/ =/ 0.0/ ,/ 则/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 如表/ 2/ 所示/ ./ 表/ 2/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 实例/ 观察/ 表/ 2/ 可/ 看出/ ,/ 不同/ 的/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 其/ 序列/ 长度/ 、/ 间隔/ 约束/ 并不相同/ ./ 4/ 算法/ 设计/ 为/ 解决/ 因为/ 用户/ 设置/ 不/ 恰当/ 间隔/ 约束/ 导致/ 不能/ 或/ 部分/ 发现/ 对比/ 序列/ 模式/ 的/ 问题/ ./ 我们/ 提出/ 了/ 免/ 用户/ 预设/ 间隔/ 约束/ 的/ 算法/ ./ 算法/ 要点/ :/ (/ 1/ )/ 紧凑/ 间隔/ 约束/ ;/ (/ 2/ )/ 最小/ 对比/ 序列/ 模式/ ,/ 称为/ AlgorithmforMinimalDistinguishingSequentialPatternswithCompactGapConstraints/ ,/ 简称/ MDSP/ -/ CGC/ ./ MDSP/ -/ CGC/ 的/ 主要/ 步骤/ 包括/ :/ (/ 1/ )/ 产生/ 候选/ 序列/ 模式/ ;/ (/ 2/ )/ 对/ 每/ 一个/ 候选/ 序列/ 模式/ 挖掘/ 能/ 满足/ 支/ Page5/ 持度/ 阈值条件/ 的/ 紧凑/ 间隔/ 约束/ ./ 4.1/ 算法/ 框架/ MDSP/ -/ CGC/ 算法/ 通过/ 枚举/ 所有/ 可能/ 的/ 候选/ 序列/ 模式/ 来/ 保证/ 挖掘/ 的/ 无/ 遗漏/ ,/ 即/ 挖出/ 所有/ 支持/ 度/ 阈值条件/ 的/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ MDSP/ -/ CGC/ 采用/ 在/ 序列/ 数据挖掘/ 中/ 广泛应用/ 的/ 集合/ 枚举/ 树/ 方法/ [/ 20/ ]/ 产生/ 候选/ 序列/ 模式/ ./ 对/ 给定/ 集合/ ,/ 如/ 序列/ 元素/ 集合/ Σ/ ,/ 集合/ 枚举/ 树/ 依照/ 集合/ 元素/ 的/ 全序/ ,/ 枚举/ 集合/ 元素/ 的/ 所有/ 可能/ 组合/ ./ 图/ 1/ 示例/ 了/ 对/ Σ/ =/ {/ a/ ,/ b/ ,/ c/ }/ ,/ 用/ 集合/ 枚举/ 树/ 枚举/ 所有/ 候选/ 序列/ 模式/ ./ MDSP/ -/ CGC/ 算法/ 按/ 深度/ 优先/ 的/ 方式/ 遍历/ 集合/ 枚举/ 树/ ./ 令/ P/ 为/ 当前/ 访问/ 的/ 结点/ 表达/ 的/ 序列/ 模式/ ,/ 若/ 存在/ 间隔/ 约束/ γ/ ,/ 使得/ 〈/ P/ ,/ γ/ 〉/ 满足/ 定义/ 3/ 中/ 的/ 条件/ ,/ 那么/ 〈/ P/ ,/ γ/ 〉/ 是/ 一个/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 同时/ ,/ 根据/ 模式/ 最小化/ 性质/ ,/ 所有/ 包含/ P/ 的/ 序列/ 模式/ ,/ 都/ 不/ 可能/ 成为/ 最终/ 解/ ./ 因此/ ,/ 我们/ 得到/ 候选/ 序列/ 模式/ 枚举/ 剪枝/ 条件/ 1/ ./ 剪枝/ 条件/ 1/ (/ 最小/ 模式/ 剪枝/ )/ ./ 给定/ 序列/ 模式/ P/ 和/ 间隔/ 约束/ γ/ ,/ 若/ 〈/ P/ ,/ γ/ 〉/ 是/ 一个/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ,/ 那么/ 剪去/ P/ 在/ 集合/ 枚举/ 树中/ 的/ 所有/ 子孙/ 结点/ ./ 例/ 5/ ./ 在/ 例/ 1/ 中/ ,/ 当/ 得到/ 〈/ ab/ ,/ [/ 0/ ,/ 3/ ]/ 〉/ 满足条件/ ,/ 那么/ ,/ 在/ 集合/ 枚举/ 树上/ ab/ 的/ 所有/ 子孙/ 结点/ 都/ 被/ 剪/ 去/ ./ 即/ ,/ 以/ ab/ 开头/ 的/ 所有/ 序列/ 都/ 不再/ 作为/ 候选/ 模式/ ./ 性质/ 1/ ./ 给定/ 序列/ 集合/ D/ ,/ 设/ P/ 是/ 序列/ 模式/ P/ 的/ 子/ 序列/ ,/ Γ/ 为/ 候选/ 间隔/ 约束/ 集合/ ,/ 那么/ MAX/ {/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ / MAX/ {/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ 成立/ ./ 证明/ ./ 我们/ 用/ 反证法/ 证明/ ./ 假设/ 存在/ 一个/ γ/ ∈/ Γ/ ,/ 使得/ MAX/ {/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ </ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ 成立/ ./ 那么/ ,/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / MAX/ {/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ </ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ 根据/ 式/ (/ 1/ )/ 可得/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ =/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ =/ P/ / P/ 足/ γ/ -/ 匹配/ ,/ 反之/ 不/ 一定/ 成立/ ./ 矛盾/ ./ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ 成立/ ./ 性质/ 1/ 蕴含/ 了/ 下列/ 候选/ 序列/ 模式/ 剪枝/ 条件/ ./ 剪枝/ 条件/ 2/ (/ α/ 剪枝/ )/ ./ 给定/ 正类/ 序列/ 样本/ 集合/ pos/ ,/ 序列/ 模式/ P/ 和/ 候选/ 间隔/ 约束/ 集合/ Γ/ ,/ 若/ MAX/ {/ suppos/ (/ 〈/ P/ ,/ γ/ 〉/ )/ |/ γ/ ∈/ Γ/ }/ </ α/ ,/ 那么/ 剪去/ P/ 在/ 集合/ 枚举/ 树中/ 的/ 所有/ 子孙/ 结点/ ./ 算法/ 1/ 描述/ 了/ MDSP/ -/ CGC/ 算法/ 框架/ ./ 算法/ 1/ ./ MDSP/ -/ CGC/ 框架/ ./ 输入/ :/ 正类/ 序列/ 样本/ 集合/ pos/ ,/ 负类/ 序列/ 样本/ 集合/ neg/ ,/ 输出/ :/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 集合/ MC1/ ./ FOR/ 深度/ 优先/ 遍历/ 集合/ 枚举/ 树/ ,/ 产生/ 候选/ 模式/ P2/ ./ 计算/ P/ 的/ 候选/ 间隔/ 约束/ 集合/ Γ/ ;/ 3/ ./ IF/ / γ/ ∈/ Γ/ 使得/ 〈/ P/ ,/ γ/ 〉/ 满足/ 定义/ 3/ 条件/ (/ i/ )/ ,/ (/ ii/ )/ ,/ 4/ ./ 移除/ MC/ 中/ 包含/ P/ 的/ 模式/ ;/ // // 定义/ 3/ 条件/ (/ iii/ )/ 5/ ./ MC/ ←/ MC/ ∪/ {/ 〈/ P/ ,/ γ/ 〉/ }/ ;/ 6/ ./ 剪去/ P/ 的/ 所有/ 子孙/ 结点/ ;/ // // 剪枝/ 条件/ 17/ ./ ENDIF8/ ./ IF/ 剪枝/ 条件/ 2/ 成立/ THEN9/ ./ 剪去/ P/ 的/ 所有/ 子孙/ 结点/ ;/ // // 剪枝/ 条件/ 210/ ./ ENDIF11/ ./ ENDFOR12/ ./ RETURNMC/ ;/ 算法/ 1/ 步/ 3/ 、/ 步/ 4/ 保证/ 挖掘/ 结果/ 符合/ 定义/ 3/ 中/ 的/ 各项/ 条件/ ./ 接下来/ ,/ 我们/ 将/ 介绍/ 步/ 2/ 、/ 步/ 3/ 的/ 详细/ 实现/ 过程/ ./ 4.2/ 间隔/ 约束/ 挖掘/ 朴素/ 算法/ 给定/ 序列/ 模式/ P/ ,/ MDSP/ -/ CGC/ 首先/ 产生/ P/ 的/ 所有/ 候选/ 间隔/ 约束/ (/ 算法/ 1/ 步/ 2/ )/ ./ 易知/ ,/ 若/ 序列/ 样本/ 的/ 最大/ 长度/ 为/ l/ ,/ 则/ 候选/ 间隔/ 约束/ 下界/ 的/ 最小值/ 为/ 0/ ,/ 上界/ 的/ 最大值/ 为/ l/ -/ 2/ ./ 例/ 6/ ./ 在/ 例/ 1/ 中/ ,/ 序列/ 样本/ 的/ 最大/ 长度/ 为/ 8/ ./ 那么/ 任意/ 候选/ 间隔/ 约束/ γ/ 满足/ :/ 0/ / γ/ ./ min/ / γ/ ./ max/ / 6/ ./ 这样/ ,/ 根据/ 序列/ 样本/ 最大/ 长度/ l/ ,/ 可以/ 得到/ Γ/ =/ {/ γ/ |/ 0/ / γ/ ./ min/ / γ/ ./ max/ / (/ l/ -/ 2/ )/ }/ ,/ 作为/ 候选/ 间隔/ 约束/ 集合/ ./ 算法/ 2/ 给出/ 了/ 实现/ 该/ 过程/ 的/ 伪/ 代码/ ./ Page6/ 算法/ 2/ 的/ 复杂度/ 为/ O/ (/ l2/ )/ ./ 对/ 算法/ 2/ 中/ 产生/ 的/ 所有/ 候选/ 间隔/ 约束/ ,/ 根据/ 宽度/ 和/ 下界/ 按/ 升序/ 排列/ ,/ 然后/ 依次/ 取出/ Γ/ 中/ 的/ 间隔/ 约束/ γ/ ∈/ Γ/ ,/ 测试/ 〈/ P/ ,/ γ/ 〉/ 是否/ 满足/ 支持/ 度/ 阈值/ (/ 算法/ 1/ 步/ 2/ )/ ./ 可以/ 看出/ ,/ 算法/ 2/ 对/ 所有/ 候选/ 序列/ 模式/ 产生/ 相同/ 的/ 候选/ 间隔/ 约束/ 集合/ ,/ 这/ 导致/ 算法/ 2/ 的/ 执行/ 结果/ 包含/ 冗余/ ,/ 即/ 不/ 可能/ 成为/ 最终/ 解/ 的/ 间隔/ 约束/ ./ 为/ 避免/ 这个/ 情况/ ,/ 本文/ 设计/ 基于/ 序列/ 模式/ 实例/ 的/ 间隔/ 约束/ 产生/ 算法/ ./ 算法/ 2/ ./ 间隔/ 约束/ 挖掘/ 朴素/ 算法/ ./ 输入/ :/ 序列/ 样本/ 最大/ 长度/ l/ 输出/ :/ 候选/ 间隔/ 约束/ 集合/ Γ/ 1/ ./ Γ/ ←/ / ;/ 2/ ./ FORi/ ←/ 0TO/ (/ l/ -/ 2/ )/ DO3/ ./ FORj/ ←/ iTO/ (/ l/ -/ 2/ )/ DO4/ ./ Γ/ ←/ Γ/ ∪/ {/ [/ i/ ,/ j/ ]/ }/ ;/ 5/ ./ ENDFOR6/ ./ ENDFOR7/ ./ RETURN/ Γ/ ;/ 4.3/ 基于/ 序列/ 模式/ 实例/ 的/ 间隔/ 约束/ 挖掘/ 首先/ ,/ 我们/ 定义/ 间隔/ 约束/ 的/ 合并/ 运算/ 如下/ ./ 定义/ 4/ (/ 间隔/ 约束/ 的/ 合并/ )/ ./ 给定/ 间隔/ 约束/ γ/ 1/ 和/ γ/ 2/ ,/ 构造/ 间隔/ 约束/ γ/ 使得/ γ/ 的/ 下界/ 为/ γ/ 1/ 和/ γ/ 2/ 下界/ 的/ 最小值/ ,/ γ/ 的/ 上界/ 为/ γ/ 1/ 和/ γ/ 2/ 上界/ 的/ 最大值/ ,/ 称/ γ/ 为/ γ/ 1/ 和/ γ/ 2/ 的/ 合并/ ,/ 记/ 为/ γ/ =/ γ/ 1/ ∪/ / γ/ 2/ ./ 即/ γ/ =/ γ/ 1/ ∪/ / γ/ 2/ =/ [/ MIN/ {/ γ/ 1/ ./ min/ ,/ γ/ 2/ ./ min/ }/ ,/ MAX/ {/ γ/ 1/ ./ max/ ,/ γ/ 2/ ./ max/ }/ ]/ ./ 例如/ ,/ [/ 2/ ,/ 3/ ]/ ∪/ / [/ 4/ ,/ 6/ ]/ =/ [/ MIN/ {/ 2/ ,/ 4/ }/ ,/ MAX/ {/ 3/ ,/ 6/ }/ ]/ =/ [/ 2/ ,/ 6/ ]/ ./ 给定/ 间隔/ 约束/ γ/ 1/ 和/ γ/ 2/ ,/ 若/ 满足/ γ/ 1/ ./ min/ / γ/ 2/ ./ min/ ,/ γ/ 1/ ./ max/ / γ/ 2/ ./ max/ ,/ 则/ 称/ 间隔/ 约束/ γ/ 1/ 覆盖/ γ/ 2/ ./ 例/ 7/ ./ 给定/ 间隔/ 约束/ γ/ 1/ =/ [/ 0/ ,/ 4/ ]/ ,/ γ/ 2/ =/ [/ 1/ ,/ 2/ ]/ ,/ 0/ </ 1/ ,/ 4/ >/ 2/ 可知/ γ/ 1/ 覆盖/ γ/ 2/ ./ 回忆/ 一下/ 第/ 3/ 节/ 定义/ 的/ 序列/ 包含/ 关系/ ./ 给定/ 序列/ P/ ,/ 若/ 序列/ S/ 中/ 存在/ 一组/ 正整数/ 序列/ 〈/ k1/ ,/ …/ ,/ k/ |/ P/ |/ 〉/ ,/ 满足/ S/ [/ k1P/ [/ |/ P/ |/ ]/ ./ 〈/ k1/ ,/ …/ ,/ k/ |/ P/ |/ 〉/ 称为/ P/ 在/ S/ 中/ 的/ 一个/ 实例/ ./ 给定/ 实例/ 〈/ k1/ ,/ …/ ,/ k/ |/ P/ |/ 〉/ ,/ 我们/ 按/ 规则/ 1/ 产生/ 区间/ γ/ ,/ 称/ γ/ 为/ P/ 在/ S/ 上/ 的/ 一个/ 间隔/ 约束/ 实例/ ./ 规则/ 1/ ./ γ/ ./ min/ =/ MIN/ {/ Gap/ (/ S/ ,/ ki/ ,/ ki/ +/ 1/ )/ |/ 1/ / i/ </ |/ P/ |/ }/ γ/ ./ max/ =/ MAX/ {/ Gap/ (/ S/ ,/ ki/ ,/ ki/ +/ 1/ )/ |/ 1/ / i/ </ |/ P/ |/ }/ 例/ 8/ ./ 设/ S/ =/ aedcbfdc/ ,/ P/ =/ acc/ ./ 那么/ ,/ 〈/ 1/ ,/ 4/ ,/ 8/ 〉/ 是/ P/ 在/ S/ 中/ 的/ 一个/ 实例/ ,/ 且/ [/ 2/ ,/ 3/ ]/ 为/ 一个/ 间隔/ 约束/ 实例/ ./ 序列/ P/ 在/ 序列/ S/ 中有/ 多个/ 实例/ ,/ 将/ 得到/ 多个/ 间隔/ 约束/ 实例/ ./ 例如/ ,/ S/ =/ aedcbfdc/ ,/ P/ =/ ac/ ./ 那么/ ,/ 可以/ 得到/ 间隔/ 约束/ 实例/ [/ 2/ ,/ 2/ ]/ 和/ [/ 6/ ,/ 6/ ]/ ./ 给定/ 序列/ 模式/ P/ ,/ 序列/ 样本/ 集合/ D/ ,/ 记在/ D/ 中/ 所有/ 序列/ 上/ 产生/ 的/ 间隔/ 约束/ 实例/ ,/ 即/ {/ γ/ |/ / S/ ∈/ D/ ,/ γ/ 为/ P/ 在/ S/ 上/ 的/ 一个/ 间隔/ 约束/ 实例/ }/ ./ 例/ 9/ ./ 考虑/ 表/ 1/ 中/ 的/ 正类/ 序列/ 样本/ 集合/ (/ pos/ )/ ,/ 序列/ 模式/ P/ =/ acc/ ./ 那么/ ,/ 可/ 得到/ P/ 在/ S1/ 的/ 实例/ 为/ 〈/ 1/ ,/ 4/ ,/ 8/ 〉/ ,/ 在/ S2/ 的/ 实例/ 为/ 〈/ 1/ ,/ 4/ ,/ 5/ 〉/ ,/ 〈/ 1/ ,/ 4/ ,/ 8/ 〉/ 和/ 〈/ 1/ ,/ 5/ ,/ 8/ 〉/ ,/ 在/ S3/ 的/ 实例/ 为/ 〈/ 2/ ,/ 5/ ,/ 8/ 〉/ ./ 根据/ 规则/ 1/ ,/ [/ 2/ ,/ 2/ ]/ ,/ [/ 2/ ,/ 3/ ]/ }/ ./ 观察/ 1/ ./ 给定/ 序列/ 模式/ P/ 和/ 间隔/ 约束/ γ/ ,/ 假设/ 〈/ P/ ,/ γ/ 〉/ 是/ 一个/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ,/ 那么/ (/ 1/ )/ γ/ 至少/ 覆盖/ 一个/ 间隔/ 约束/ 实例/ (/ 〈/ P/ ,/ γ/ 〉/ 才/ 可能/ 满足/ 支持/ 度/ 阈值/ )/ ./ (/ 2/ )/ γ/ 或者/ 等于/ 一个/ 间隔/ 约束/ 实例/ ,/ 或者/ 等于/ 多个/ 间隔/ 约束/ 实例/ 的/ 合并/ (/ γ/ 满足/ 紧凑/ 条件/ )/ ./ 根据/ 观察/ 1/ ,/ 得到/ P/ 的/ 候选/ 间隔/ 约束/ 集合/ Γ/ ./ 性质/ 2/ ./ 给定/ 序列/ 集合/ D/ ,/ 序列/ 模式/ P/ ,/ 间隔/ 约束/ γ/ 和/ γ/ ,/ 若/ γ/ / γ/ ,/ 则/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ ./ 证明/ ./ 根据/ 定义/ 2/ ,/ {/ S/ ∈/ D/ |/ P/ ,/ S/ 满足/ γ/ -/ 匹配/ }/ / {/ S/ ∈/ D/ |/ P/ ,/ S/ 满足/ γ/ -/ 匹配/ }/ ,/ 由式/ (/ 1/ )/ 可得/ supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / supD/ (/ 〈/ P/ ,/ γ/ 〉/ )/ ./ 由/ 性质/ 2/ ,/ 可/ 得到/ 候选/ 间隔/ 约束/ 剪枝/ 条件/ 3/ ./ 剪枝/ 条件/ 3/ (/ β/ 剪枝/ )/ ./ 给定/ 负类/ 序列/ 样本/ 集合/ neg/ ,/ 序列/ 模式/ P/ ,/ 和/ 候选/ 间隔/ 约束/ 集合/ Γ/ ./ 令/ γ/ ∈/ Γ/ ,/ 若/ supneg/ (/ 〈/ P/ ,/ γ/ 〉/ )/ >/ β/ ,/ 那么/ 将/ Γ/ 中/ 所有/ 覆盖/ γ/ 的/ 间隔/ 约束/ 移除/ ./ 给定/ 间隔/ 约束/ γ/ ∈/ Γ/ ,/ 若/ 〈/ P/ ,/ γ/ 〉/ 满足/ 支持/ 度/ 阈值/ 且/ γ/ 最/ 紧凑/ ,/ 那么/ 算法/ 1/ 步/ 3/ 为/ 真/ ./ 若/ γ/ 满足/ 剪枝/ 条件/ 3/ ,/ 则/ 移除/ Γ/ 中/ 冗余/ 的/ 元素/ ./ 接下来/ 介绍/ ,/ 如何/ 从/ Γ/ 中/ 选择/ 当前/ 最/ 紧凑/ 的/ 候选/ 间隔/ 约束/ ./ 我们/ 借鉴/ 了/ 归并/ 排序/ [/ 21/ ]/ 的/ 思想/ ./ 首先/ ,/ 求/ 出界/ 值/ ,/ 记/ 为/ (/ P/ )/ }/ ./ / 然后/ ,/ 对/ / v/ ∈/ / 的/ 间隔/ 约束/ 实例/ ,/ 通过/ 合并/ 运算/ 产生/ 所有/ 以/ v/ 为/ 下界/ 的/ 候选/ 间隔/ 约束/ 的/ 上界/ ,/ 记为/ U/ (/ v/ )/ ./ Page7s/ ./ t/ ./ v/ =/ γ/ ./ min/ ,/ v/ / γ/ ./ min/ ,/ γ/ ./ max/ / γ/ ./ max/ }/ (/ 4/ )/ 显然/ ,/ 按/ 升序/ 排序/ U/ (/ v/ )/ 中/ 的/ 元素/ ./ 那么/ ,/ 当前/ 最/ 紧凑/ 间隔/ 约束/ 一定/ 在/ {/ [/ v/ ,/ w/ ]/ |/ v/ ∈/ / 的/ 第一个/ 元素/ }/ ./ 设/ [/ v/ ,/ w/ ]/ 为/ 当前/ 选择/ 的/ 候选/ 间隔/ 约束/ ,/ 若/ 〈/ P/ ,/ [/ v/ ,/ w/ ]/ 〉/ 满足要求/ ,/ 返回/ [/ v/ ,/ w/ ]/ ./ 否则/ ,/ 从/ U/ (/ v/ )/ 中/ 移除/ 第一个/ 元素/ (/ w/ )/ ./ 重复/ 在/ {/ [/ v/ ,/ w/ ]/ |/ v/ ∈/ / 是/ U/ (/ v/ )/ 的/ 第一个/ 元素/ }/ 中/ 选择/ 最/ 紧凑/ 的/ 候选/ 间隔/ 约束/ ,/ 直至/ 找到/ 满足条件/ 的/ 间隔/ 约束/ ,/ 或/ 测试/ 完全/ 部/ 候选/ 间隔/ 约束/ ./ 例/ 10/ ./ 以/ (/ P/ )/ ./ min/ =/ {/ 0/ ,/ 1/ ,/ 2/ }/ ,/ 根据/ 式/ (/ 4/ )/ ,/ 可知/ U/ (/ 0/ )/ =/ 例/ ./ / {/ 2/ ,/ 3/ }/ ;/ U/ (/ 1/ )/ =/ {/ 2/ ,/ 3/ }/ ;/ U/ (/ 2/ )/ =/ {/ 3/ }/ ./ 因此/ 得到/ 如下/ 所示/ 的/ 候选/ 间隔/ 约束/ 下界/ 及/ 相应/ 的/ 候选/ 上/ 界/ 集合/ ./ 首先/ ,/ 从/ {/ [/ 0/ ,/ 2/ ]/ ,/ [/ 1/ ,/ 2/ ]/ ,/ [/ 2/ ,/ 3/ ]/ }/ 中/ 选择/ 最/ 紧凑/ 的/ [/ 1/ ,/ 2/ ]/ 作为/ 候选/ 间隔/ 约束/ ./ 若/ [/ 1/ ,/ 2/ ]/ 不/ 满足/ ,/ 则/ 继续/ 从/ {/ [/ 0/ ,/ 2/ ]/ ,/ [/ 1/ ,/ 3/ ]/ ,/ [/ 2/ ,/ 3/ ]/ }/ 中/ 选择/ 最/ 紧凑/ 的/ 间隔/ 约束/ 作为/ 候选/ ,/ 以此类推/ ,/ 直至/ 找到/ 满足条件/ 的/ 间隔/ 约束/ ,/ 或/ 考察/ 完全/ 部/ 候选/ 间隔/ 约束/ ./ 算法/ 3/ 描述/ 了/ 本/ 小节/ 讨论/ 的/ 基于/ 序列/ 模式/ 实例/ 的/ 间隔/ 约束/ 挖掘/ 算法/ ./ 分析/ 算法/ 3/ 最坏/ 情况/ 下/ 的/ 时间/ 复杂度/ ,/ 通过/ 扫描/ 序列/ 模式/ P/ 中/ 各个/ 元素/ 在/ pos/ 每条/ 序列/ 中/ 出现/ 的/ 位置/ ,/ 可以/ 得到/ 此/ ,/ 算法/ 3/ 步/ 1/ 和步/ 2/ 需要/ O/ (/ |/ pos/ |/ ×/ lpos/ ×/ lpos/ )/ 时间/ ,/ 其中/ ,/ |/ pos/ |/ 表示/ 正类/ 序列/ 样本/ 的/ 个数/ ,/ lpos/ 表示/ 正类/ 序列/ 样本/ 的/ 最大/ 长度/ ./ 步/ 3/ ~/ 步/ 5/ 计算/ 所有/ 的/ U/ (/ v/ )/ 需要/ O/ (/ |/ / 对/ 〈/ P/ ,/ γ/ 〉/ 进行/ 支持/ 度/ 检测/ ,/ 需要/ O/ (/ |/ / (/ |/ pos/ |/ ×/ lpos/ +/ |/ neg/ |/ ×/ lneg/ )/ )/ 时间/ ,/ 其中/ lneg/ 表示/ 负类/ 序列/ 样本/ 的/ 最大/ 长度/ ./ 因此/ ,/ 算法/ 3/ 的/ 时间/ 复杂度/ 为/ O/ (/ |/ pos/ |/ ×/ lpos/ ×/ lpos/ +/ |/ / |/ / O/ (/ |/ / (/ P/ )/ ./ min/ |/ ×/ lpos/ ×/ (/ |/ pos/ |/ ×/ lpos/ +/ |/ neg/ |/ ×/ lneg/ )/ )/ =/ (/ P/ )/ ./ min/ |/ ×/ lpos/ ×/ (/ |/ pos/ |/ ×/ lpos/ +/ |/ neg/ |/ ×/ lneg/ )/ )/ ./ 相比/ 于/ 间隔/ 约束/ 挖掘/ 朴素/ 算法/ (/ 算法/ 2/ )/ ,/ 算法/ 3/ 显著/ 地/ 减小/ 了/ 候选/ 间隔/ 约束/ 集合/ 的/ 规模/ ./ 同时/ ,/ 通过/ 对/ 候选/ 间隔/ 约束/ 排序/ ,/ 避免/ 了/ 产生/ 冗余/ 结果/ (/ 非/ 最/ 紧凑/ 间隔/ 约束/ )/ ,/ 提高/ 了/ 效率/ ./ 下/ 一节/ ,/ 我们/ 将/ 通过/ 实验/ 验证/ 算法/ 3/ 的/ 执行/ 效率/ ./ 算法/ 3/ ./ 基于/ 序列/ 模式/ 实例/ 的/ 间隔/ 约束/ 挖掘/ ./ 输入/ :/ 正类/ 序列/ 样本/ 集合/ pos/ ,/ 负类/ 序列/ 样本/ 集合/ neg/ ,/ 输出/ :/ 间隔/ 约束/ γ/ 1/ ./ 根据/ pos/ 产生/ 2/ ./ / 3/ ./ FOREACHv/ ∈/ / 4/ ./ 计算/ U/ (/ v/ )/ 并/ 按/ 升序/ 排列/ ;/ 5/ ./ ENDFOR6/ ./ REPEAT7/ ./ γ/ ←/ {/ [/ v/ ,/ w/ ]/ |/ v/ ∈/ / 8/ ./ U/ (/ v/ )/ ←/ U/ (/ v/ )/ \/ {/ w/ }/ ;/ 9/ ./ IFsuppos/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / α/ ∧/ supneg/ (/ 〈/ P/ ,/ γ/ 〉/ )/ / β/ THEN10/ ./ RETURN/ γ/ ;/ // // 〈/ P/ ,/ γ/ 〉/ 满足/ 定义/ 3/ 条件/ (/ i/ )/ ,/ 11/ ./ ENDIF12/ ./ IFsupneg/ (/ 〈/ P/ ,/ γ/ 〉/ )/ >/ β/ THEN/ // // 剪枝/ 条件/ 313/ ./ 移除/ 包含/ γ/ 的/ 候选/ 间隔/ 约束/ ;/ 14/ ./ ENDIF15/ ./ UNTIL/ γ/ =/ / ;/ 16/ ./ RETURN/ / ;/ 若/ 由/ 算法/ 3/ 得到/ 间隔/ 约束/ γ/ 为/ 非空/ ,/ 则/ 〈/ P/ ,/ γ/ 〉/ 为/ 带/ 紧凑/ 间隔/ 约束/ 的/ 候选/ 最小/ 对比/ 序列/ 模式/ ./ 在/ 两种/ 情况/ 下/ ,/ 候选/ 序列/ 模式/ P/ 找/ 不到/ 最合适/ 的/ 间隔/ 约束/ (/ 算法/ 3/ 输出/ 结果/ 为/ / )/ :/ 第一/ ,/ 在/ 正类/ 序列/ 样本/ 集合/ 中/ 不/ 存在/ 间隔/ 约束/ 使得/ P/ 的/ 支持/ 度/ 大于/ 等于/ 阈值/ α/ ;/ 第二/ ,/ 在/ 负类/ 序列/ 样本/ 集合/ 中/ 不/ 存在/ 间隔/ 约束/ 使得/ P/ 的/ 支持/ 度/ 小于/ 等于/ 阈值/ β/ ./ 在/ 这/ 两种/ 情况/ 下/ ,/ P/ 将/ 不/ 作为/ 结果/ 输出/ ./ 根据/ 剪枝/ 策略/ 和/ 算法/ 3/ 的/ 设计/ ,/ 容易/ 看出/ MDSP/ -/ CGC/ 算法/ 的/ 挖掘/ 结果/ 一定/ 满足/ 定义/ 3/ 的/ 条件/ ./ 同时/ ,/ 定理/ 1/ 保证/ 了/ MDSP/ -/ CGC/ 算法/ 的/ 完备/ 性/ ./ 定理/ 1/ ./ 给定/ 候选/ 序列/ 模式/ P/ ,/ 间隔/ 约束/ γ/ ,/ 若/ 〈/ P/ ,/ γ/ 〉/ 为/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ,/ 则/ 〈/ P/ ,/ γ/ 〉/ 一定/ 在/ MDSP/ -/ CGC/ 算法/ 的/ 结果/ 中/ ./ 证明/ ./ 我们/ 用/ 反证法/ 证明/ ./ 假设/ 存在/ 一个/ γ/ ∈/ Γ/ ,/ 使得/ 〈/ P/ ,/ γ/ 〉/ 为/ 满足/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 成立/ ,/ 但/ 不/ 在/ MDSP/ -/ CGC/ 算法/ 的/ 挖掘/ 结果/ 中/ ,/ 那么/ 有/ 以下/ 情况/ :/ (/ 1/ )/ 〈/ P/ ,/ γ/ 〉/ 被/ 剪枝/ 条件/ 1/ 移除/ ;/ Page8/ (/ 2/ )/ 〈/ P/ ,/ γ/ 〉/ 被/ 剪枝/ 条件/ 2/ 移除/ ;/ (/ 3/ )/ 〈/ P/ ,/ γ/ 〉/ 被/ 剪枝/ 条件/ 3/ 移除/ ;/ 综上/ ,/ 〈/ P/ ,/ γ/ 〉/ 为/ 满足/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 不/ 成立/ ,/ 与/ 原/ 假设/ 矛盾/ ./ 5/ 实验/ 5.1/ 实验/ 环境/ 实验/ 采用/ UCI/ 机器/ 学习/ 数据/ 集/ ①/ 提供/ 的/ E/ ./ coli/ 基因/ 序列/ 数据/ 集/ 和/ 用户/ 行为/ 序列/ 数据/ 集/ ActivitiesofDailyLiving/ (/ ADLs/ )/ ,/ 以及/ pfam/ 数据库/ (/ http/ :/ // // pfam/ ./ sanger/ ./ ac/ ./ uk/ // )/ 提供/ 的/ 蛋白质/ 序列/ 数据/ 集/ CbiA/ // X/ 和/ TatD/ // C/ 来/ 验证/ 本文/ 提出/ 的/ MDSP/ -/ CGC/ 算法/ 的/ 有效性/ 和/ 执行/ 效率/ ./ E/ ./ coli/ 中/ 的/ 基因/ 序列/ 包含/ G/ 、/ C/ 、/ A/ 、/ T4/ 种/ 编码/ ,/ CbiA/ // X/ 和/ TatD/ // C/ 中/ 的/ 序列/ 包含/ 41/ 种/ 编码/ ,/ ADLs/ 记录/ 了/ A/ 、/ B/ 两个/ 用户/ 的/ 日常行为/ 序列/ (/ 10/ 种/ 类型/ )/ ./ 表/ 3/ 列出/ 了/ 实验/ 数据/ 集/ 的/ 特征/ ./ 正类/ 序列/ 集合/ E/ ./ coli/ +/ CbiATatDADLs/ -/ A/ 所有/ 算法/ 采用/ Java/ 语言/ 实现/ ./ 为/ 区别/ 4.2/ 节/ 和/ 4.3/ 节/ 给出/ 的/ 两种/ 不同/ 的/ 候选/ 间隔/ 约束/ 产生/ 方式/ ,/ 将/ 基于/ 序列/ 模式/ 实例/ 产生/ 候选/ 间隔/ 约束/ (/ 算法/ 3/ )/ 的/ 版本/ 记为/ MDSP/ -/ CGC/ ,/ 将/ 采用/ 间隔/ 约束/ 挖掘/ 朴素/ 算法/ (/ 4.2/ 节/ 算法/ 2/ )/ 产生/ 候选/ 间隔/ 约束/ 的/ 版本/ 记为/ Baseline/ ./ 同时/ ,/ 为/ 验证/ MDSP/ -/ CGC/ 算法/ 的/ 实用性/ ,/ 我们/ 实现/ 了/ 与/ 本文/ 工作/ 最/ 相关/ 的/ 文献/ [/ 4/ ]/ 中/ 提出/ 的/ ConSGapMiner/ 算法/ (/ 为/ 方便/ 表达/ ,/ 用/ CSM/ 指代/ ConSGapMiner/ )/ ./ 请/ 注意/ ,/ CSM/ 算法/ 必须/ 预先/ 给定/ 间隔/ 约束/ ,/ 并且/ 间隔/ 约束/ 下界/ 的/ 取值/ 固定/ 为/ 0/ ./ 为/ 进行/ 对比/ ,/ 我们/ 用/ Java/ 语言/ 重新/ 编写/ CSM/ 算法/ 以/ 支持/ 间隔/ 约束/ γ/ 下界/ 为/ 任一/ 非负/ 整数/ 值/ ./ 在/ 本文/ 所有/ 实验/ 中/ ,/ 默认/ 正类/ 样本/ 集/ 的/ 相对/ 支持/ 度/ 阈值/ (/ α/ )/ 设置/ 为/ 0.6/ ,/ 负类/ 样本/ 数据/ 集/ 的/ 相对/ 支持/ 度/ 阈值/ (/ β/ )/ 设置/ 为/ 0.4/ ./ 所有/ 实验/ 都/ 在/ 配置/ 为/ IntelCorei7/ -/ 37703.90/ GHzCPU/ ,/ 8GB/ 内存/ ,/ Windows7/ 操作系统/ 的/ PC/ 上/ 完成/ ./ 5.2/ MDSP/ -/ CGC/ 算法/ 有效性/ 验证/ 为/ 验证/ MDSP/ -/ CGC/ 算法/ 的/ 有效性/ ,/ 我们/ 在/ E/ ./ coli/ 、/ CbiA/ // X/ 、/ TatD/ // C/ 、/ ADLs/ 上/ 分别/ 运行/ MDSP/ -/ CGC/ 算法/ ,/ 挖掘/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 图/ 2/ 给出/ 了/ 在/ 4/ 个/ 数据/ 集上/ 挖掘/ 的/ 序列/ 模式/ 最/ 紧凑/ 间隔/ 约束/ 宽度/ 的/ 分布/ 情况/ ./ 可以/ 看出/ ,/ 序列/ 模式/ 集合/ 在/ 各个/ 间隔/ 约束/ 宽度/ 上均/ 分布/ 有/ 一定/ 数量/ 的/ 序列/ 模式/ ./ 请/ 注意/ MDSP/ -/ CGC/ 在/ E/ ./ coli/ 、/ CbiA/ // X/ 、/ TatD/ // C/ 、/ ADLs/ 数据/ 集上/ 挖掘/ 得到/ 的/ 大部分/ (/ >/ 66.7/ %/ )/ 结果/ 的/ 间隔/ 约束/ 的/ 宽度/ 不/ 超过/ 4/ ./ 我们/ 分析/ 这/ 是因为/ MDSP/ -/ CGC/ 优先选择/ 满足/ 支持/ 度/ 阈值/ 的/ 紧凑/ (/ 宽度/ 小/ )/ 间隔/ 约束/ ./ 表/ 4/ ~/ 表/ 7/ 列出/ 了/ 在/ 4/ 个/ 数据/ 集上/ ,/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 的/ 平均/ 长度/ 和/ 序列/ 模式/ α/ ×/ |/ E/ ./ coli/ +/ |/ α/ ×/ |/ CbiA/ |/ α/ ×/ |/ TatD/ |/ α/ ×/ |/ ADLs/ -/ A/ |/ ①/ http/ :/ // // archive/ ./ ics/ ./ uci/ ./ edu/ // mlPage9/ 图/ 2/ 带/ 紧凑/ 间隔/ 约束/ 的/ 对比/ 序列/ 模式/ 数量/ 的/ 分布/ (/ β/ =/ 0.4/ )/ 的/ 个数/ ./ 由表/ 4/ 可知/ ,/ 当/ 负类/ 样本/ 支持/ 度/ 阈值/ 固定/ ,/ 随着/ 正类/ 样本/ 支持/ 度/ 阈值/ 增大/ ,/ E/ ./ coli/ 数据/ 集/ (/ DNA/ 序列/ )/ 上/ 发现/ 的/ 对比/ 序列/ 模式/ 的/ 平均/ 长度/ 呈/ 递增/ 趋势/ ./ 由于/ 基因/ 序列/ 中/ 只有/ G/ ,/ C/ ,/ A/ ,/ T/ 这/ 4/ 种/ 编码/ ,/ 较/ 短/ 的/ 序列/ 模式/ 难以/ 满足/ 支持/ 度/ 阈值条件/ ./ 随着/ 正类/ 样本/ 支持/ 度/ 阈值/ 的/ 增大/ ,/ 集合/ 枚举/ 树/ 向下/ 搜索/ 的/ 深度/ 相应/ 增加/ ./ 因此/ ,/ 结果/ 集/ 序列/ 模式/ 的/ 平均/ 长度/ 会/ 增加/ ./ 表/ 5/ 、/ 表/ 6/ 、/ 表/ 7/ 分别/ 列出/ 了/ MDSP/ -/ CGC/ 算法/ 在/ 蛋白质/ 序列/ 数据/ 集/ CbiA/ // X/ 、/ TatD/ // C/ 和/ 用户/ 行为/ 序列/ 数据/ 集/ ADLs/ 上/ 所/ 发现/ 的/ 对比/ 序列/ 模式/ 的/ 平均/ 长度/ 和/ 个数/ ./ 与表/ 4/ 不同/ ,/ 在/ 蛋白质/ 序列/ 数据/ 集中/ MDSP/ -/ CGC/ 算法/ 发现/ 的/ 序列/ 模式/ 的/ 平均/ 长度/ 和/ 模式/ 的/ 个数/ 没有/ 随着/ 正类/ 样本/ 支持/ 度/ 阈值/ 的/ 增大/ 而/ 变化/ ./ 我们/ 分析/ 其/ 原因/ 为/ :/ 在/ 蛋白质/ 序列/ 数据/ 集中/ 存在/ 满足条件/ 且/ 长度/ 较/ 短/ 的/ 对比/ 序列/ 模式/ ,/ 根据/ 剪枝/ 条件/ 1/ ,/ 所以/ 由/ 集合/ 枚举/ 树/ 生成/ 的/ 候选/ 模式/ 集合/ 规模/ 相对/ 固定/ ./ 值得一提的是/ ,/ 表/ 5/ 中/ 序列/ 模式/ 的/ 平均/ 长度/ 为/ 1.997/ ,/ 是因为/ 在/ CbiA/ // X/ 数据/ 集中/ 单/ 元素/ 模式/ “/ X/ ”/ 在/ CbiA/ 类中/ 出现/ 了/ 773/ 次/ ,/ 而/ 在/ CbiX/ 类中/ 出现/ 次数/ 为/ 0/ ./ 因此/ ,/ 模式/ “/ X/ ”/ 满足/ 支持/ 度/ 阈值条件/ ,/ 出现/ 在/ 结果/ 中/ (/ 请/ 注意/ 定义/ 3/ 关于/ 对比/ 序列/ 模式/ 的/ 条件/ 并/ 不/ 限定/ 模式/ 长度/ 必须/ 大于/ 1/ )/ ./ 图/ 2/ 和表/ 4/ ~/ 表/ 7/ 说明/ ,/ 如果/ 只/ 考虑/ 某一/ 宽度/ 的/ 间隔/ 约束/ ,/ 将/ 不能/ 发现/ 满足/ 其他/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 为/ 进一步/ 说明/ 此/ 问题/ ,/ 我们/ 利用/ 与/ 本文/ 工作/ 最/ 相关/ 的/ 文献/ [/ 4/ ]/ 中/ 提出/ 的/ CSM/ 算法/ 来/ 挖掘/ 指定/ 间隔/ 约束/ 下/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 表/ 8/ 列出/ 了/ 在/ 支持/ 度/ 阈值/ α/ =/ 0.6/ 和/ β/ =/ 0.4/ 时/ ,/ CSM/ 算法/ (/ 需要/ 预先指定/ 间隔/ 约束/ )/ 发现/ 的/ 最小/ 对比/ 序列/ 模式/ 个数/ ,/ 以及/ MDSP/ -/ CGC/ 算法/ 挖掘/ 的/ 最小/ 对比/ 序列/ 模式/ 个数/ (/ MDSP/ -/ CGC/ 算法/ 不/ 需要/ 预先/ 设定/ 间隔/ 约束/ )/ ./ 从表/ 8/ 可以/ 看出/ 一般/ 情况/ 下/ ,/ MDSP/ -/ CGC/ 算法/ 能够/ 发现/ 更/ 多/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 但/ 值得注意/ ,/ 在/ E/ ./ coli/ 数据/ 集中/ CSM/ 算法/ 得到/ 的/ 序列/ 模式/ 个数/ 更/ 多/ ./ 这/ 是因为/ MDSP/ -/ CGC/ 算法/ 挖掘/ 满足/ 支持/ 度/ 阈值/ 的/ 最小/ 对比/ 序列/ 模式/ ,/ 根据/ 最小/ 模式/ 剪枝/ ,/ CSM/ 得到/ 的/ 部分/ 结果/ 在/ MDSP/ -/ CGC/ 算法/ 结果/ 中/ 不是/ 最小/ ,/ 因此/ 不会/ 出现/ 在/ MDSP/ -/ CGC/ 的/ 挖掘/ 结果/ 中/ ./ 因此/ ,/ 在/ 不/ 具备/ 设定/ 间隔/ 约束/ 先验/ 知识/ 的/ 前提/ 下/ ,/ 本文/ 提出/ 表/ 8MDSP/ -/ CGC/ 与/ CSM/ 挖掘/ 模式/ 个数/ (/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ )/ 数据/ 集/ E/ ./ coliCbiA/ // XTatD/ // CADLsPage10/ 的/ MDSP/ -/ CGC/ 算法/ 能/ 更/ 灵活/ 、/ 有效/ 地/ 发现/ 对比/ 序列/ 模式/ ./ 由于/ 篇幅/ 有限/ ,/ 我们/ 仅/ 在/ 表/ 9/ 中/ 列出/ 当/ 设定/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ 时/ ,/ MDSP/ -/ CGC/ 算法/ 在/ E/ ./ coli/ 数据/ 集上/ 的/ 挖掘/ 结果/ ./ 观察/ 表/ 9/ 可知/ ,/ 各个/ 模式/ 的/ 间隔/ 约束/ 范围/ 并/ 不/ 统一/ ./ 例如/ ,/ 设定/ 间隔/ 约束/ 为/ [/ 1/ ,/ 3/ ]/ ,/ 只能/ 发现/ 部分/ 结果/ ./ 表/ 10/ 中/ 列出/ 当/ 设定/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ 时/ ,/ MDSP/ -/ CGC/ 算法/ 在/ ADLs/ 数据/ 集上/ 间隔/ 约束/ 宽度/ 为/ 2/ 的/ 的/ 挖掘/ 结果/ ./ 由表/ 10/ 可知/ ,/ 得到/ 的/ 序列/ 模式/ 的/ 间隔/ 约束/ 在/ 各个/ 区间/ 上/ 均/ 有/ 分布/ ./ 若/ 先验/ 地/ 给出/ 间隔/ 约束/ ,/ 则/ 可能/ 丢失/ 序列/ 模式/ ./ 例如/ :/ 若/ 指定/ 间/ 图/ 3MDSP/ -/ CGC/ 算法/ 与/ Baseline/ 算法/ 运行/ 时间/ 比较/ (/ β/ =/ 0.4/ )/ 由此可见/ ,/ 相较/ 于/ CSM/ 需要/ 预先指定/ 间隔/ 约束/ ,/ MDSP/ -/ CGC/ 算法/ 能/ 自动/ 挖掘/ 对比/ 序列/ 模式/ 并/ 计算/ 最合适/ 的/ 间隔/ 约束则/ 更加/ 实用/ ./ 5.3/ MDSP/ -/ CGC/ 算法/ 执行/ 效率/ 验证/ 为/ 验证/ MDSP/ -/ CGC/ 算法/ 的/ 执行/ 效率/ ,/ 我们/ 记录/ 了/ MDSP/ -/ CGC/ 算法/ 在/ 不同/ 正类/ 样本/ 绝对/ 支持/ 度/ 阈值/ (/ α/ ×/ |/ pos/ |/ )/ 下/ 的/ 运行/ 时间/ ./ 据/ 我们/ 所知/ ,/ 目前/ 还/ 没有/ 与/ MDSP/ -/ CGC/ 挖掘/ 任务/ 完全一致/ 的/ 相关/ 工作/ ,/ 我们/ 将/ MDSP/ -/ CGC/ 与/ Baseline/ 算法/ 的/ 运行/ 时间/ 进行/ 对比/ ;/ 容易/ 看出/ ,/ MDSP/ -/ CGC/ 算法/ 明显/ 快于/ Baseline/ 算法/ ./ 特别/ 地/ ,/ 随着/ 数据/ 集/ 规模/ 增大/ ,/ 序列/ 平均/ 长度/ 增长/ ,/ MDSP/ -/ CGC/ 算法/ 相比/ 于/ Baseline/ 算法/ 效率/ 提升/ 更/ 显著/ ./ 需要/ 注意/ 的/ 是/ ,/ 随着/ 正类/ 样本/ 支持/ 度/ 阈值/ 的/ 增大/ ,/ MDSP/ -/ CGC/ 算法/ 耗费/ 的/ 时间/ 逐渐/ 增加/ ./ 这是/ 因隔/ 约束/ 为/ [/ 1/ ,/ 3/ ]/ ,/ 则/ 会/ 丢失/ 间隔/ 约束/ [/ 3/ ,/ 5/ ]/ 、/ [/ 4/ ,/ 6/ ]/ 、/ [/ 9/ ,/ 11/ ]/ 和/ [/ 12/ ,/ 14/ ]/ 所/ 相关/ 的/ 4/ 个/ 对比/ 序列/ 模式/ ./ 表/ 9MDSP/ -/ CGC/ 在/ 犈/ ./ 犮/ 狅/ 犾/ 犻/ 的/ 挖掘/ 结果/ (/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ )/ 表/ 10MDSP/ -/ CGC/ 在/ ADLs/ 的/ 挖掘/ 结果/ (/ α/ =/ 0.6/ ,/ 〈/ SnackGrooming/ ,/ [/ 1/ ,/ 3/ ]/ 〉/ 〈/ BreakfastLeaving/ ,/ [/ 4/ ,/ 6/ ]/ 〉/ 〈/ ToiletingLeaving/ ,/ [/ 9/ ,/ 11/ ]/ 〉/ 〈/ SleepingToileting/ ,/ [/ 12/ ,/ 14/ ]/ 〉/ 为/ ,/ 随着/ 正类/ 样本/ 绝对/ 支持/ 度/ 阈值/ 增大/ ,/ 大量/ 候选/ 序列/ 模式/ 都/ 不适/ 用于/ 剪枝/ 条件/ 1/ ,/ 导致/ 集合/ 枚举/ 树上/ 搜索/ 的/ 深度/ 增加/ ,/ 产生/ 更/ 多/ 的/ 候选/ 序列/ 模式/ ,/ 增加/ 算法/ 运行/ 时间/ ./ 但/ MDSP/ -/ CGC/ 算法/ 的/ 执行/ 时间/ 明显/ 少于/ Baseline/ 算法/ ./ 表/ 11/ 记录/ 了/ 在/ 设置/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ 时/ ,/ MDSP/ -/ CGC/ 算法/ 在/ 不同/ 数据/ 集上/ 经过/ β/ 剪枝/ 后/ 的/ 候选/ 间隔/ 约束/ (/ 即/ 算法/ 3/ 步/ 9/ 中/ 考察/ 的/ 候选/ 间隔/ 约束/ )/ 的/ 宽度/ 分布/ 情况/ ./ 表/ 11MDSP/ -/ CGC/ 候选/ 间隔/ 约束/ 的/ 宽度/ 分布/ (/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ )/ 数据/ 集/ E/ ./ coliCbiA/ // XTatD/ // CADLsPage11/ 根据/ 表/ 11/ 所/ 涉及/ 的/ 候选/ 间隔/ 约束/ ,/ 图/ 4/ 示例/ 了/ 在/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ 时/ ,/ CSM/ 算法/ 在/ 选取/ 不同/ 间隔/ 约束/ 宽度/ 的/ 情况/ 下/ ,/ 考察/ 同等/ 规模/ 的/ 候选/ 间隔/ 约束/ 所/ 需/ 的/ 执行/ 时间/ ./ 为/ 便于/ 对比/ ,/ 图/ 4/ 也/ 示例/ 了/ MDSP/ -/ CGC/ 在/ 同样/ 支持/ 度/ 阈值/ 下/ ,/ 挖掘/ 带/ 紧凑/ 间隔/ 约束/ 的/ 运行/ 时间/ ./ 由于/ 执行/ CSM/ 算法/ 需要/ 预先指定/ 间隔/ 约束/ ,/ 因此/ ,/ 我们/ 计算/ CSM/ 执行/ 所有/ 给定/ 间隔/ 约束/ 的/ 运行/ 时间/ 之/ 和/ ./ 例如/ ,/ 图/ 4/ 中/ ,/ CSM/ -/ 3/ 表示/ 根据/ 表/ 11/ 所/ 涉及/ 的/ 候选/ 间隔/ 约束/ ,/ 选择/ 所有/ 宽度/ 不/ 超过/ 3/ 的/ 候选/ 间隔/ 约束/ 来/ 执行/ CSM/ 算法/ ./ 可以/ 看出/ ,/ 随着/ 候选/ 间隔/ 约束/ 宽度/ 的/ 增长/ ,/ 利用/ CSM/ 算法/ 发现/ 图/ 4MDSP/ -/ CGC/ 算法/ 与/ CSM/ 算法/ 运行/ 时间/ 比较/ (/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ )/ 图/ 5MDSP/ -/ CGC/ 算法/ 伸缩性/ 分析/ (/ α/ =/ 0.6/ ,/ β/ =/ 0.4/ )/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 需要/ 更/ 多/ 的/ 运行/ 时间/ ./ 值得注意/ 的/ 是/ ,/ 在/ 图/ 4/ (/ b/ )/ 和/ 图/ 4/ (/ c/ )/ 中/ ,/ 虽然/ CSM/ 算法/ 在/ 间隔/ 约束/ 宽度/ 规模/ 小于/ 等于/ 4/ 时/ 执行/ 时间/ 比/ MDSP/ -/ CGC/ 算法/ 少/ ,/ 但是/ CSM/ 算法/ 在/ 间隔/ 约束/ 宽度/ 规模/ 小于/ 等于/ 4/ 时/ 不能/ 找到/ 所有/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ ./ 最后/ ,/ 我们/ 验证/ 了/ MDSP/ -/ CGC/ 算法/ 的/ 伸缩性/ ,/ 考虑/ 了/ MDSP/ -/ CGC/ 算法/ 执行/ 时间/ 与/ 数据/ 集/ 的/ 选择/ 相关/ ./ 我们/ 通过/ 复制/ 的/ 方法/ ,/ 将/ 实验/ 数据/ 集/ 规模/ 依次/ 增大/ k/ 倍/ ./ 这样/ ,/ 在/ 保持/ 支持/ 度/ 阈值/ 相同/ 情况/ 下/ ,/ 算法/ 挖掘/ 结果/ 保持/ 不变/ ./ 图/ 5/ 示例/ 了/ MDSP/ -/ CGC/ 算法/ Page12/ 在/ 实验/ 数据/ 集/ E/ ./ coli/ 、/ CbiA/ // X/ 、/ TatD/ // C/ 、/ ADLs/ 规模/ 增大/ k/ 倍/ ,/ 正类/ 样本/ 数据/ 集/ 的/ 相对/ 支持/ 度为/ 0.6/ ,/ 负类/ 样本/ 数据/ 集/ 的/ 相对/ 支持/ 度为/ 0.4/ 的/ 条件/ 下/ ,/ 执行/ 时间/ 的/ 变化/ 情况/ ./ 观察/ 图/ 5/ 可以/ 看出/ ,/ MDSP/ -/ CGC/ 执行/ 时间/ 随着/ 数据/ 集/ 规模/ 增大/ 而/ 线性/ 增长/ ./ 可见/ MDSP/ -/ CGC/ 算法/ 具有/ 较/ 好/ 的/ 伸缩性/ ./ 6/ 结论/ 对比/ 序列/ 模式/ 在/ 识别/ 不同/ 类别/ 序列/ 样本/ 集合/ 的/ 特征/ 上/ 有着/ 重要/ 的/ 作用/ ./ 已有/ 对比/ 序列/ 模式/ 挖掘/ 算法/ 需要/ 用户/ 预设/ 间隔/ 约束/ ./ 在/ 不/ 具备/ 充分/ 先验/ 知识/ 的/ 情况/ 下/ ,/ 用户/ 不易/ 准确/ 地/ 预设/ 恰当/ 的/ 间隔/ 约束/ ,/ 进而/ 导致/ 不能/ 发现/ 有用/ 的/ 模式/ ./ 针对/ 这个/ 问题/ ,/ 本文/ 设计/ 了/ 带/ 紧凑/ 间隔/ 约束/ 的/ 最小/ 对比/ 序列/ 模式/ 挖掘/ MDSP/ -/ CGC/ 算法/ ,/ 实现/ 免/ 用户/ 设置/ 间隔/ 约束/ ,/ 并/ 对/ 候选/ 模式/ 自动/ 计算/ 最/ 适合/ 的/ 间隔/ 约束/ ,/ 避免/ 了/ 用户/ 在/ 不/ 具备/ 先验/ 知识/ 的/ 情况/ 下/ 因为/ 设置/ 参数/ 不/ 恰当/ 而/ 丢失/ 结果/ 的/ 情况/ ,/ 因此/ 对/ 推动/ 对比/ 序列/ 模式/ 挖掘/ 的/ 实际/ 应用/ 有/ 积极/ 作用/ ./ 我们/ 设计/ 了/ 3/ 种/ 剪枝/ 策略/ 和/ 相应/ 的/ 数据结构/ ,/ 来/ 保证/ 算法/ MDSP/ -/ CGC/ 具有/ 较/ 高/ 的/ 执行/ 效率/ ./ 在/ 蛋白质/ 序列/ 、/ DNA/ 序列/ 以及/ 行为/ 序列/ 数据/ 集上/ 的/ 实验/ 验证/ 了/ MDSP/ -/ CGC/ 算法/ 的/ 有效性/ 和/ 执行/ 效率/ ./ 下/ 一步/ ,/ 我们/ 将/ 把/ 免/ 间隔/ 约束/ 对比/ 序列/ 模式/ 挖掘/ 的/ 思想/ 应用/ 于/ 其他/ 类型/ 的/ 序列/ 模式/ 挖掘/ ./ 此外/ ,/ 我们/ 将/ 设计/ MDSP/ -/ CGC/ 算法/ 的/ 分布式/ 实现/ 版本/ ,/ 以及/ 基于/ 免/ 间隔/ 约束/ 对比/ 序列/ 模式/ 的/ 分类器/ 训练/ ,/ 并/ 尝试/ 将/ 其/ 应用/ 于/ 金融/ 、/ 医学/ 等/ 领域/ 的/ 数据分析/ ./ 

