Page1/ 一个/ 有效/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 赵秀凤/ 1/ )/ ,/ 2/ )/ 徐秋亮/ 2/ )/ 1/ )/ (/ 信息工程/ 大学/ 电子/ 技术/ 学院/ 郑州/ 450004/ )/ 2/ )/ (/ 山东大学/ 计算机科学/ 与/ 技术/ 学院/ 济南/ 250101/ )/ 摘要/ 多/ PKG/ 环境/ 下/ 的/ 签密/ 机制/ 是域/ 间/ 实体/ 认证/ 和/ 保密/ 通信/ 的/ 有效/ 手段/ ./ 文中/ 提出/ 了/ 一个/ 新/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 的/ 签密/ 方案/ ,/ 方案/ 使用/ 了/ Waters/ 基于/ 身份/ 加密/ 体制/ 及/ 现有/ 的/ 基于/ 身份/ 签密/ 体制/ 的/ 构造/ 思想/ ,/ 并/ 利用/ “/ / ”/ 运算/ 和/ 抗/ 碰撞/ Hash/ 函数/ 消除/ 了/ 签密/ 密文/ 与/ 明文/ 之间/ 的/ 对应/ 关系/ ,/ 从而/ 保证/ 了/ 方案/ 的/ 语义/ 安全/ ./ 文中/ 的/ 方案/ 实现/ 了/ 标准/ 模型/ 下/ 的/ 可/ 证明/ CCA/ 安全/ 和/ 存在/ 不可/ 伪造/ 性/ ;/ 且/ 当/ 新/ 方案/ 退化/ 为/ 单个/ PKG/ 环境/ 时/ ,/ 与/ 其它/ 标准/ 模型/ 下/ 的/ 安全/ 方案/ 相比/ ,/ 该/ 方案/ 仍/ 有/ 稍/ 高/ 的/ 效率/ ./ 关键词/ 基于/ 身份/ 签密/ ;/ 多/ PKG/ ;/ 双线性/ 对/ ;/ 可/ 证明/ 安全/ ;/ 标准/ 模型/ 1/ 引言/ 随着/ 新型/ 网络/ 计算/ 背景/ 的/ 出现/ ,/ 跨域/ 认证/ 和/ 保密/ 通信/ 技术/ 成为/ 一个/ 关键/ 和/ 迫切需要/ 解决/ 的/ 问题/ ./ 签密/ 能够/ 在/ 一个/ 合理/ 的/ 逻辑/ 步骤/ 内/ 同时/ 完成/ 数字签名/ 和/ 公钥/ 加密/ 两项/ 功能/ ,/ 而/ 其/ 所/ 花费/ 的/ 代价/ ,/ 要/ 远远/ 低于/ 传统/ 的/ 先/ 签名/ 后/ 加密/ 的/ 方法/ ,/ 因此/ 它/ 是/ 实现/ 既/ Page2/ 人/ [/ 9/ ]/ 分别/ 指出/ 该/ 方案/ 不/ 满足/ 密文/ 不可/ 区分/ 性/ 和/ 密文/ 不可/ 伪造/ 性/ 并/ 给出/ 了/ 改进/ 的/ 方案/ ./ 但是/ 我们/ 发现/ ,/ Zhang/ 改进/ 的/ 方案/ 依然/ 不/ 满足/ 密文/ 不可/ 区分/ 性/ ,/ 原因/ 是/ 敌手/ 获得/ 挑战/ 密文/ 后/ ,/ 通过/ 解/ 签密/ 的/ 验证/ 等式/ 可以/ 验证/ 签密/ 密文/ 与/ 明文/ 消息/ 的/ 对应/ 关系/ ,/ 从而/ 可以/ 进行/ 密文/ 区分/ ./ 最近/ ,/ Li/ 等/ 人/ [/ 10/ ]/ 也/ 指出/ Zhang/ [/ 8/ ]/ 给出/ 的/ 改进/ 方案/ 不/ 满足/ CCA/ 安全/ ,/ 同时/ 指出/ Jin/ 等/ 人/ [/ 9/ ]/ 的/ 改进/ 方案/ 不/ 满足/ 不可/ 伪造/ 性/ ,/ 并/ 基于/ Kiltz/ 和/ Vahlis/ 的/ IBE/ 方案/ 及/ Paterson/ 和/ Schuldt/ 的/ IBS/ 方案/ 给出/ 了/ 一个/ 新/ 的/ 在/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 身份/ 基签/ 密/ 方案/ ./ 2010/ 年/ ,/ 张波/ 等/ 人/ [/ 11/ ]/ 给出/ 了/ 一个/ 高效/ 的/ 基于/ 身份/ 多/ 签密/ 方案/ ,/ 但是/ 在/ 签密者/ 对/ 消息/ 签密/ 的/ 过程/ 中/ ,/ 不仅/ 需要/ 解签/ 密者/ 的/ 身份/ 信息/ ,/ 还/ 需要/ 解签/ 密者/ 的/ 公钥/ 参与/ 运算/ ,/ 因此/ 该/ 方案/ 涉及/ 到/ 公钥/ 认证/ 问题/ ./ 上述/ 签密/ 方案/ 要求/ 所有/ 的/ 通信/ 实体/ 都/ 必须/ 处在/ 一个/ 相同/ 的/ PKG/ (/ privatekeygenerator/ )/ 的/ 管理/ 之下/ ,/ 极大/ 地/ 限制/ 了/ 方案/ 的/ 适用范围/ ./ 2007/ 年/ ,/ Li/ 等/ 人/ [/ 12/ ]/ 提出/ 了/ 可/ 用于/ 多域/ 的/ 基于/ 身份/ 签密/ 方案/ ,/ 很/ 好/ 地/ 实现/ 了域/ 间/ 秘密/ 信息/ 既/ 保密/ 又/ 认证/ 的/ 安全/ 传输/ ./ 该/ 方案/ 中域/ 间通信/ 的/ 不同/ PKG/ 共享/ 相同/ 的/ 公共/ 参数/ ./ 随后/ ,/ Li/ 等/ 人/ [/ 13/ ]/ 对/ 上述/ 方案/ 进行/ 了/ 优化/ ,/ 提高/ 了/ 计算/ 效率/ ,/ 而且/ 可以/ 扩展/ 到/ 多个/ PKG/ 拥有/ 不同/ 的/ 系统/ 参数/ ./ 但是/ ,/ Zhang/ 等/ 人/ [/ 14/ ]/ 指出/ Li/ 等/ 人/ 的/ 两个/ 方案/ 在/ 选择/ 密文/ 攻击/ 下/ 是/ 不/ 安全/ 的/ ./ 与此同时/ ,/ 闻英友/ 等/ 人/ [/ 15/ ]/ 也/ 给出/ 了/ 一个/ 可/ 用于/ 多域/ 的/ 可/ 证明/ 安全/ 的/ 签密/ 方案/ ,/ 并且/ 多个/ PKG/ 拥有/ 不同/ 的/ 系统/ 参数/ 和/ 各自/ 的/ 公私/ 钥/ ./ 但是/ 上述/ 签密/ 方案/ 的/ 安全性/ 都/ 依赖于/ 随机/ 预言/ 模型/ ./ 借助于/ Waters/ 的/ IBE/ 体制/ [/ 16/ ]/ 及/ 基于/ 身份/ 签密/ 方案/ [/ 8/ -/ 11/ ]/ ,/ 本文/ 提出/ 了/ 一个/ 有效/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 对/ 方案/ 的/ CCA2/ 安全/ 和/ 存在/ 性/ 不可/ 伪造/ 性/ 进行/ 了/ 证明/ ,/ 这是/ 第一个/ 在/ 标准/ 模型/ 下可证/ 安全/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ ,/ 同时/ 也/ 适用/ 于/ 单个/ PKG/ 环境/ ./ 2/ 背景/ 知识/ 2.1/ 双线性/ 对设/ G/ 和/ GT/ 为/ 两个/ 素数/ p/ 阶/ 的/ 循环群/ ,/ g/ 是/ 群/ G/ 的/ 生成元/ ,/ 双线性/ 对/ e/ 是/ 一个/ 双线性/ 映射/ e/ :/ G/ ×/ G/ →/ GT/ ,/ 满足/ 下面/ 的/ 特性/ :/ (/ 1/ )/ 双线性/ ./ 对/ 所有/ 的/ u/ ,/ v/ ∈/ G/ ,/ a/ ,/ b/ ∈/ Z/ ,/ 有/ e/ (/ ua/ ,/ vb/ )/ =/ e/ (/ u/ ,/ v/ )/ ab/ ;/ (/ 2/ )/ 非/ 退化/ 性/ ./ e/ (/ g/ ,/ g/ )/ 不是/ GT/ 的/ 生成元/ ;/ (/ 3/ )/ 可计算性/ ./ 对于/ 任何/ P/ ,/ Q/ ∈/ G/ ,/ 存在/ 有效/ 的/ 算法/ 计算/ e/ (/ P/ ,/ Q/ )/ ./ 2.2/ DBDH/ 假设/ 判定/ 双线性/ Diffie/ -/ Hellman/ (/ DBDH/ )/ 问题/ ./ 挑战者/ 随机/ 选择/ a/ ,/ b/ ,/ c/ ,/ z/ ∈/ Z/ / 如果/ γ/ =/ 1/ ,/ 则/ 输出/ 元组/ (/ g/ ,/ A/ =/ ga/ ,/ B/ =/ gb/ ,/ C/ =/ gc/ ,/ Z/ =/ e/ (/ g/ ,/ g/ )/ abc/ )/ ,/ 否则/ 输出/ (/ g/ ,/ A/ =/ ga/ ,/ B/ =/ gb/ ,/ C/ =/ gc/ ,/ Z/ =/ e/ (/ g/ ,/ g/ )/ z/ )/ ,/ 其中/ g/ 为群/ G/ 的/ 生成元/ ,/ 攻击者/ 输出/ 对/ γ/ 的/ 猜测/ γ/ ./ 对于/ 多项式/ 时间/ 的/ 概率/ 算法/ / ,/ 如果/ 有/ |/ Pr/ [/ / (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ e/ (/ g/ ,/ g/ )/ abc/ )/ =/ 1/ ]/ -/ 则/ 称/ / 至少/ 以/ 优势/ ε/ 解决/ 群/ G/ 上/ 的/ DBDH/ 问题/ ./ DBDH/ 假设/ ./ 对于/ 所有/ 的/ 概率/ 多项式/ 时间/ 算法/ / ,/ 优势/ ε/ 是/ 可以/ 忽略/ 的/ ./ 2.3/ CDH/ 假设/ 计算/ 性/ Diffie/ -/ Hellman/ (/ CDH/ )/ 问题/ ./ 群/ G/ 中/ 的/ CDH/ 问题/ 是/ 指/ 对于/ 给定/ 的/ 随机/ 的/ 元组/ (/ g/ ,/ ga/ ,/ gb/ )/ 计算/ 出/ gab/ ,/ 其中/ g/ 为群/ G/ 的/ 生成元/ ,/ a/ ,/ b/ 从/ Z/ / 选取/ ./ 一个/ 多项式/ 时间/ 内/ 的/ 概率/ 算法/ / 成功/ 解决/ 群/ G/ 上/ 的/ CDH/ 问题/ 的/ 概率/ 定义/ 为/ AdvCDHCDH/ 假设/ ./ 对于/ 所有/ 的/ 概率/ 多项式/ 时间/ 算法/ / ,/ AdvCDH3/ 多/ PKG/ 基于/ 身份/ 签密/ 的/ 形式化/ 模型/ 3.1/ 概念模型/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 的/ 签密/ 方案/ 由/ 以下/ 5/ 个/ 算法/ 构成/ :/ 全局/ 建立/ G/ -/ Setup/ ,/ 域/ 建立/ D/ -/ Setup/ ,/ 私钥/ 提取/ Extract/ ,/ 签密/ Signcrypt/ ,/ 解/ 签密/ Unsign/ -/ crypt/ ./ 全局/ 建立/ G/ -/ Setup/ ./ 输入/ 安全/ 参数/ ,/ 输出/ 全局/ 公开/ 的/ 系统/ 参数/ params/ ./ 域/ 建立/ D/ -/ Setup/ ./ 输入/ 全局/ 公开/ 的/ 系统/ 参数/ params/ ,/ 每个/ 域/ PKGx/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ 输出/ 一个/ 主/ 密钥/ sx/ 和/ 相应/ 的/ 域/ 公钥/ Px/ (/ 我们/ 假设/ 有/ l/ 个域/ )/ ,/ 公开/ 域公钥/ Px/ ,/ 保存/ 主/ 密钥/ sx/ ./ 私钥/ 提取/ Extract/ ./ 输入/ 域/ PKGx/ 中/ 的/ 身份/ ID/ ,/ PKGx/ 计算/ 相应/ 的/ 私钥/ SID/ 并/ 通过/ 安全/ 信道/ 发送给/ 用户/ ID/ ./ 签密/ Signcrypt/ ./ 假设/ 签密者/ 为/ PKG1/ 中/ 的/ 用户/ A/ ,/ 解签/ 密者/ 为/ PKG2/ 中/ 的/ 用户/ B/ ./ 输入/ 全局/ 公开/ 的/ Page3/ 系统/ 参数/ params/ 、/ 域公钥/ P1/ 和/ P2/ 、/ 签密者/ 的/ 私钥/ SIDA/ 、/ 待/ 签密/ 明文/ 消息/ m/ 以及/ 解签/ 密者/ 身份/ 信息/ IDB/ ,/ 输出/ 签密者/ 对/ 消息/ m/ 的/ 签密/ 密文/ σ/ ,/ 该/ 算法/ 由/ 签密者/ 运行/ ./ 解/ 签密/ Unsigncrypt/ ./ 输入/ 全局/ 公开/ 的/ 系统/ 参数/ params/ 、/ 域公钥/ P1/ 和/ P2/ 、/ 签密者/ 身份/ IDA/ 、/ 解签/ 密者/ 私钥/ SIDB/ 和/ 签名/ σ/ ,/ 输出/ 明文/ 消息/ m/ 或者/ 表示/ 解/ 签密/ 失败/ 的/ 符号/ ⊥/ ./ 3.2/ 安全性/ 定义/ Li/ 等/ 人/ [/ 12/ -/ 13/ ]/ 给出/ 了/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 的/ 安全性/ 定义/ ,/ 包括/ 自/ 适应/ 选择/ 密文/ 攻击/ 下/ 的/ 密文/ 不可/ 区分/ 性/ 和/ 自/ 适应/ 选择/ 消息/ 攻击/ 下/ 的/ 密文/ 存在/ 性/ 不可/ 伪造/ 性/ ./ 定义/ 1/ (/ 机密性/ )/ ./ 如果/ 不/ 存在/ 多项式/ 时间/ 的/ 敌手/ 可以/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 下面/ 的/ 游戏/ ,/ 则/ 称/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 的/ 签密/ 方案/ (/ MPIDSC/ )/ 在/ 自/ 适应/ 选择/ 密文/ 攻击/ 下/ 具有/ 密文/ 不可/ 区分/ 性/ (/ IND/ -/ MPIDSC/ -/ CCA2/ )/ ./ 游戏/ 参与者/ 包括/ 挑战者/ / 和/ 敌手/ / ,/ 游戏/ 过程/ 如下/ ./ 建立/ ./ 挑战者/ / 选定/ 安全/ 参数/ k/ ,/ 执行/ 建立/ G/ -/ Setup/ 算法/ 和/ D/ -/ Setup/ 算法/ ,/ 并/ 将/ 全局/ 系统/ 参数/ params/ 和域/ 公钥/ Px/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ 发送给/ 敌手/ / ,/ 秘密/ 的/ 持有/ 主/ 密钥/ sx/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ ./ 第一阶段/ 敌手/ 执行/ 多项式/ 次数/ 的/ 询问/ ,/ 这些/ 询问/ 可以/ 是/ 自/ 适应/ 选择/ 的/ ,/ 也就是说/ ,/ 每个/ 询问/ 都/ 可以/ 在/ 前/ 一个/ 询问/ 基础/ 上/ 进行/ ./ 敌手/ 可以/ 进行/ 的/ 询问/ 包括/ :/ 私钥/ 提取/ 询问/ ./ 敌手/ 可以/ 发起/ 对/ 任意/ 域/ PKGx/ 中/ 任意/ 身份/ ID/ 的/ 询问/ 并/ 获得/ 与/ 该/ 身份/ 信息/ 相关/ 的/ 私钥/ SID/ =/ Extract/ (/ ID/ )/ ./ 签密/ 询问/ ./ 敌手/ 可以/ 发起/ 对/ 签密者/ 身份/ IDA/ 、/ 接收者/ 身份/ IDB/ 和/ 消息/ m/ 的/ 签密/ 询问/ ./ / 计算/ SIDA/ =/ Extract/ (/ IDA/ )/ 和/ σ/ =/ Signcrypt/ (/ m/ ,/ SIDA/ ,/ IDB/ )/ ,/ 并/ 将/ 签密/ 密文/ σ/ 发送给/ 敌手/ ./ 解/ 签密/ 询问/ ./ 敌手/ 可以/ 产生/ 对/ 签密者/ 身份/ 信息/ IDA/ 、/ 接收者/ 身份/ IDB/ 和/ 签密/ 密文/ σ/ 的/ 解/ 签密/ 询问/ ./ / 计算/ SIDA/ =/ Extract/ (/ IDA/ )/ ,/ 并/ 将/ 解/ 签密/ 结果/ Unsigncrypt/ (/ σ/ ,/ IDA/ ,/ SIDB/ )/ 发送给/ 敌手/ ,/ 这个/ 结果/ 可能/ 是/ 合法/ 的/ 明文/ 消息/ m/ 或/ 在/ σ/ 为/ 不/ 合法/ 密文/ 情况/ 下/ 的/ 符号/ ⊥/ ./ 挑战/ ./ 敌手/ 选择/ 两个/ 明文/ 消息/ m0/ 和/ m1/ 以及/ 他/ 想/ 挑战/ 的/ 签密者/ 身份/ ID/ / A/ 和/ 接收者/ 身份/ ID/ / B/ ./ 注意/ 到/ :/ 他/ 不/ 能够/ 在/ 第一阶段/ 中/ 询问/ 过/ 与/ 身份/ 信息/ ID/ / B/ 相关/ 的/ 私钥/ ./ / 选择/ 随机/ 比特/ γ/ ,/ 计算/ 签密/ 密文/ σ/ / =/ Signcrypt/ (/ m/ γ/ ,/ SID/ / 第二阶段/ 敌手/ 可以/ 进行/ 和/ 第一阶段/ 相同/ 的/ 多项式/ 次数/ 询问/ ,/ 但是/ ,/ 他/ 不/ 能够/ 发起/ 对/ 身份/ 信息/ ID/ / B/ 的/ 私钥/ 提取/ 询问/ 以及/ 对/ 签密/ 密文/ σ/ / 在/ 接收者/ 身份/ 为/ ID/ / B/ 的/ 解/ 签密/ 询问/ ./ 猜测/ ./ 最后/ ,/ 敌手/ 输出/ 对/ γ/ 的/ 猜测/ 值/ γ/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 如果/ γ/ =/ γ/ ,/ 则/ 称/ 敌手/ 成功/ ./ 上述/ 敌手/ 被/ 称为/ IND/ -/ MPIDSC/ -/ CCA2/ 攻击者/ ,/ 敌手/ 成功/ 的/ 概率/ 优势/ 定义/ 为/ AdvIND/ -/ MPIDSC/ -/ CCA2/ =/ |/ Pr/ [/ γ/ =/ γ/ ]/ -/ 1/ // 2/ |/ ./ 定义/ 2/ (/ 不可/ 为/ 造性/ )/ ./ 如果/ 不/ 存在/ 多项式/ 时间/ 的/ 敌手/ 可以/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 下面/ 的/ 游戏/ ,/ 则/ 称/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 在/ 自/ 适应/ 选择/ 消息/ 攻击/ 下/ 具有/ 密文/ 的/ 存在/ 性/ 不可/ 伪造/ 性/ (/ EUF/ -/ MPIDSC/ -/ CMA/ )/ ./ 游戏/ 过程/ 如下/ :/ ./ 建立/ ./ 挑战者/ / 选定/ 安全/ 参数/ k/ ,/ 执行/ 建立/ G/ -/ Setup/ 算法/ 和/ D/ -/ Setup/ 算法/ ,/ 并/ 将/ 全局/ 系统/ 参数/ params/ 和域/ 公钥/ Px/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ 发送给/ 敌手/ / ,/ 秘密/ 的/ 持有/ 主/ 密钥/ sx/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ ./ 询问/ ./ 如同/ 定义/ 2/ 中/ 一样/ ,/ 敌手/ 可以/ 自/ 适应/ 地/ 发起/ 多项式/ 次数/ 的/ 询问/ ./ 伪造/ ./ 敌手/ 产生/ 新/ 的/ 元组/ (/ σ/ ,/ IDA/ ,/ SIDB/ )/ (/ 即/ 不是/ 由/ 签密/ 询问/ 得到/ 的/ 元组/ )/ ,/ 如果/ 解/ 签密/ 的/ 结果/ Unsigncrypt/ (/ σ/ ,/ IDA/ ,/ SIDB/ )/ 不是/ 符号/ ⊥/ ,/ 则/ 称/ 敌手/ 成功/ ,/ 即/ 敌手/ 产生/ 了/ 合法/ 的/ 签密/ 密文/ ./ 4/ 具体/ 方案/ 4.1/ 方案/ 描述/ 在/ 下面/ 的/ 描述/ 中/ ,/ 不妨/ 设/ 所有/ 的/ 身份/ 信息/ 都/ 由/ 具有/ 固定/ 长度/ nu/ 的/ 字符串/ 表示/ ./ 为/ 保证/ 方案/ 的/ 通用性/ ,/ 可以/ 使用/ 抗/ 碰撞/ 的/ Hash/ 函数/ 完成/ 对/ 任意/ 长度/ 身份/ 信息/ 的/ 处理/ ./ 具体/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 包括/ 如下/ 算法/ ./ G/ -/ Setup/ ./ 选择/ 素数/ p/ 阶群/ G/ 和/ GT/ ,/ e/ :/ G/ ×/ G/ →/ GT/ 为/ 双线性/ 对/ ,/ g/ 为群/ G/ 的/ 生成元/ ./ 选定/ 随机/ 元素/ g2/ ←/ RG/ ,/ 另外/ ,/ 选择/ 群/ G/ 中/ 元素/ u/ ,/ m/ ←/ RG/ 和/ 长度/ 分别/ 为/ nu/ 和/ nm/ 的/ 向量/ Λ/ U/ =/ (/ ui/ )/ ,/ Λ/ M/ =/ (/ mi/ )/ ,/ 向量/ 中/ 的/ 元素/ 为群/ G/ 中/ 的/ 随机/ 元素/ ./ H/ 和/ Hm/ 为/ 密码学/ 意义/ 上/ 的/ Hash/ 函数/ ,/ H/ :/ GT/ →/ 0/ ,/ {/ }/ 1lt/ ,/ 其中/ lt/ 表示/ 明文/ 消息/ 长度/ ./ Hm/ :/ 0/ ,/ {/ }/ 1lt/ ×/ GT/ →/ 0/ ,/ {/ }/ 1nm/ 全局/ 系统/ 参数/ 为/ params/ =/ {/ G/ ,/ GT/ ,/ e/ ,/ g/ ,/ g2/ ,/ u/ ,/ Λ/ U/ ,/ m/ ,/ Λ/ M/ ,/ Page4H/ ,/ Hm/ }/ ./ D/ -/ Setup/ ./ 每个/ PKGx/ (/ x/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ )/ 选择/ 一个/ 随机/ 元素/ α/ x/ ∈/ Zp/ 并/ 计算/ 域公钥/ Px/ =/ g/ α/ x/ 和/ 相应/ 的/ 主/ 密钥/ sx/ =/ g/ α/ xExtract/ ./ 令/ u/ 为/ 具有/ 长度/ nu/ 的/ 表示/ 身份/ 的/ 字符串/ ,/ u/ [/ i/ ]/ 为/ u/ 的/ 第/ i/ 比特/ ,/ 定义/ / / {/ 1/ ,/ 2/ ,/ …/ ,/ nu/ }/ 为/ u/ [/ i/ ]/ =/ 1/ 的/ 位/ i/ 的/ 集合/ ./ 为/ 构造/ 与/ 身份/ 信息/ u/ 相关/ 的/ 私钥/ du/ ,/ 随机/ 选择/ ru/ ←/ Zp/ ,/ 并/ 计算/ du/ =/ (/ du1/ ,/ du2/ )/ =/ (/ sx/ (/ u/ ∏/ i/ ∈/ / 这里/ 不妨/ 设签/ 密者/ Alice/ 为域/ PKG1/ 注册/ 的/ 用户/ ,/ 身份/ 信息/ 为/ uA/ ,/ 解签/ 密者/ Bob/ 为域/ PKG2/ 注册/ 的/ 用户/ ,/ 身份/ 信息/ 为/ uB/ ./ 他们/ 的/ 私钥/ 分别/ 由/ PKG1/ 和/ PKG2/ 生成/ :/ 和/ dA/ =/ (/ dA1/ ,/ dA2/ )/ =/ g/ α/ 12u/ ∏/ j/ ∈/ / AdB/ =/ (/ dB1/ ,/ dB2/ )/ =/ g/ α/ 2/ 的/ 域/ 公钥/ ,/ 计算/ σ/ 1/ =/ m/ / H/ (/ R/ )/ ;/ 其中/ / / {/ 1/ ,/ 2/ ,/ …/ ,/ nm/ }/ 为/ M/ [/ i/ ]/ =/ 1/ 的/ 位/ i/ 的/ 集合/ ;/ Signcrypt/ ./ 令/ m/ 为/ 待/ 签密/ 消息/ ,/ 为/ 发送/ 消息/ m/ 给/ 接收者/ Bob/ ,/ 签密者/ Alice/ 选择/ 随机数/ rm/ ∈/ Zp/ 并/ 执行/ 以下/ 步骤/ :/ (/ 1/ )/ 计算/ R/ =/ e/ (/ P2/ ,/ g2/ )/ rm/ ,/ 其中/ P2/ =/ g/ α/ 2/ 为/ PKG2/ (/ 2/ )/ 计算/ σ/ 2/ =/ grm/ ;/ (/ 3/ )/ 计算/ σ/ 3/ =/ u/ ∏/ j/ ∈/ / B/ (/ 4/ )/ 计算/ M/ =/ Hm/ (/ m/ ‖/ R/ )/ 和/ σ/ 4/ =/ dA1/ ·/ m/ ∏/ j/ ∈/ / (/ 5/ )/ σ/ 5/ =/ dA2/ ./ 最终/ 的/ 签密/ 密文/ 为/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ ,/ σ/ 4/ ,/ σ/ 5/ )/ ./ Unsigncrypt/ ./ 接收/ 到/ 签密/ 密文/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ ,/ σ/ 4/ ,/ σ/ 5/ )/ 后/ ,/ Bob/ 执行/ 以下/ 步骤/ 进行/ 解/ 签密/ :/ (/ 1/ )/ 计算/ R/ =/ e/ (/ dB1/ ,/ σ/ 2/ )/ e/ (/ dB2/ ,/ σ/ 3/ )/ -/ 1/ ;/ (/ 2/ )/ 计算/ m/ =/ σ/ 1/ / H/ (/ R/ )/ ;/ (/ 3/ )/ 计算/ M/ =/ Hm/ (/ m/ ‖/ R/ )/ ./ 当且/ 仅/ 当/ 等式/ e/ (/ σ/ 4/ ,/ g/ )/ =/ e/ (/ P2/ ,/ g2/ )/ eu/ ∏/ j/ ∈/ / A/ 成立/ 时/ Bob/ 接受/ 该/ 签密/ 密文/ ./ 4.2/ 正确性/ e/ (/ dB1/ ,/ σ/ 2/ )/ e/ (/ dB2/ ,/ σ/ 3/ )/ -/ 1/ 方案/ 的/ 正确性/ 可以/ 由/ 下面/ 的/ 等式/ 验证/ =/ eg/ α/ 22/ ,/ gr/ )/ eu/ ∏/ j/ ∈/ / B2/ ,/ grm/ )/ =/ e/ (/ g/ α/ 2/ ,/ g2/ )/ rm/ =/ e/ (/ P2/ ,/ g2/ )/ rm/ =/ R/ ,/ =/ e/ (/ g/ α/ 2/ =/ e/ (/ g/ α/ 2e/ (/ σ/ 4/ ,/ g/ )/ =/ edA1/ ·/ m/ ∏/ j/ ∈/ / (/ =/ eg/ α/ 1/ =/ e/ (/ g/ α/ 1/ =/ e/ (/ g/ α/ 1/ ,/ g2/ )/ eu/ ∏/ j/ ∈/ / A/ =/ e/ (/ P2/ ,/ g2/ )/ eu/ ∏/ j/ ∈/ / A4/ ./ 3/ 安全性/ 定理/ 1/ ./ 假设/ 存在/ 定义/ 1/ 中/ 的/ IND/ -/ MPIDSC/ -/ CCA2/ 敌手/ ,/ 经过/ 至多/ qE/ 次/ 私钥/ 提取/ 询问/ 、/ qS/ 次/ 签密/ 询问/ 以及/ qU/ 次解/ 签密/ 询问/ ,/ 可以/ 以/ 优势/ ε/ 区分/ 两个/ 合法/ 密文/ ,/ 则/ 存在/ 一个/ 区分/ 者/ / ,/ 可以/ 以/ 的/ 优势/ 解决/ 判定/ 双线性/ Diffie/ -/ Hellman/ 问题/ ./ 证明/ ./ 假设/ 区分/ 器/ / 获得/ 随机/ 双线性/ 判定/ Diffie/ -/ Hellman/ 问题/ 实例/ (/ g/ ,/ ga/ ,/ gb/ ,/ gc/ ,/ Z/ ∈/ GT/ )/ ,/ 他/ 的/ 目标/ 是/ 判断/ 等式/ Z/ =/ e/ (/ g/ ,/ g/ )/ abc/ 是否/ 成立/ ./ 区分/ 器/ / 将/ 把/ 定义/ 1/ 中/ 的/ IND/ -/ MPIDSC/ -/ CCA2/ 敌手/ 作为/ 子/ 过程/ 同时/ 充当/ 游戏/ 中/ 的/ 挑战者/ ,/ 具体/ 的/ 模拟/ 过程/ 如下/ ./ 随机/ 选择/ 建立/ ./ 该/ 过程/ 包括/ G/ -/ Setup/ 和/ D/ -/ Setup/ ./ G/ -/ Setup/ ./ 令/ lu/ =/ 2/ (/ qE/ +/ qS/ +/ qU/ )/ 和/ lm/ =/ 2qS/ ,/ / (/ 1/ )/ 两个/ 整数/ ku/ 和/ km/ (/ 0/ / ku/ / nu/ ,/ 0/ / km/ / nm/ )/ ;/ (/ 2/ )/ 整数/ x/ ∈/ Zlu/ ,/ 一个/ nu/ 维/ 向量/ 犡/ =/ (/ xi/ )/ ,/ xi/ ∈/ Zlu/ ;/ (/ 3/ )/ 整数/ z/ ∈/ Zlm/ ,/ 一个/ nm/ 维/ 向量/ 犣/ =/ (/ zj/ )/ ,/ zj/ ∈/ Zlm/ ;/ (/ 4/ )/ 两个/ 整数/ y/ ,/ w/ ∈/ Zp/ ,/ 一个/ nu/ 长度/ 的/ 向量/ 犢/ =/ (/ yi/ )/ (/ yi/ ∈/ Zp/ )/ 和/ 一个/ nm/ 长度/ 的/ 向量/ 犠/ =/ (/ wj/ )/ (/ wj/ ∈/ Zp/ )/ ./ 为/ 方便/ 分析/ ,/ 对/ 身份/ u/ 和/ 消息/ m/ 分别/ 定义/ 函数/ :/ F/ (/ u/ )/ =/ -/ luku/ +/ x/ +/ ∑/ i/ ∈/ / K/ (/ m/ )/ =/ -/ lmkm/ +/ z/ +/ ∑/ j/ ∈/ / / 设定/ 全局/ 系统/ 参数/ :/ g2/ =/ gb/ ,/ u/ =/ g/ -/ nuku/ +/ xPage5m/ =/ g/ -/ nmkm/ +/ z/ 因此/ 对/ 任意/ 身份/ 信息/ u/ 和/ 明文/ 消息/ m/ ,/ 有/ u/ ∏/ i/ ∈/ / D/ -/ Setup/ ./ / 随机/ 选择/ i/ / ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ l/ }/ ,/ 设定/ 域/ PKGi/ / 的/ 公钥/ 为/ Pi/ / =/ ga/ ,/ 并/ 诚实/ 地/ 计算/ 其他/ 每个/ 域/ PKGx/ 的/ 公钥/ g/ α/ x/ 和/ 主/ 密钥/ sx/ =/ g/ α/ x/ 素/ α/ x/ ∈/ Zp/ ./ 第一阶段/ 敌手/ 执行/ 多项式/ 次数/ 的/ 询问/ ,/ / 应答/ ./ 私钥/ 提取/ 询问/ ./ 当/ 敌手/ 对/ 选择/ 的/ 身份/ 信息/ u/ 做/ 私钥/ 提取/ 询问/ 时/ ,/ / 挑战者/ 首先/ 检查/ u/ 所属/ 的/ 域/ ,/ (/ 1/ )/ 如果/ u/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ ,/ 则/ 随机/ 选择/ ru/ ←/ Zp/ ,/ 并/ 计算/ du/ =/ (/ du1/ ,/ du2/ )/ =/ g/ α/ x/ (/ 2/ )/ 如果/ u/ 是域/ PKGi/ / 的/ 用户/ ,/ 则/ 检查/ F/ (/ u/ )/ =/ 0modlu/ 是否/ 成立/ ,/ 如果/ 成立/ ,/ 则/ 停止/ 游戏/ ,/ 如果/ 不/ 成立/ ,/ 挑战者/ 选择/ 随机数/ ru/ ←/ Zp/ ,/ 计算/ du/ =/ (/ du1/ ,/ du2/ )/ =/ P/ -/ J/ (/ u/ )/ 并/ 将/ 其/ 返回/ 给/ 敌手/ ./ 当/ F/ (/ u/ )/ ≠/ 0modlu/ 时/ 挑战者/ 可以/ 产生/ du/ ,/ 这个/ 模拟/ 是/ 完美/ 的/ ,/ 即/ du/ 是/ 身份/ 信息/ u/ 对应/ 的/ 合法/ 私钥/ ,/ 这/ 是因为/ 令/ r/ ^/ u/ =/ ru/ -/ adu1/ =/ P/ -/ J/ (/ u/ )/ =/ g/ -/ a/ ·/ J/ (/ u/ )/ =/ ga/ =/ ga/ =/ gadu2/ =/ P/ -/ 1/ 和/ 如果/ F/ (/ u/ )/ =/ 0modp/ ,/ 上面/ 的/ 计算/ 是/ 无法/ 进行/ 的/ ,/ 挑战者/ / 将/ 退出/ 游戏/ ./ 为/ 使/ 分析/ 更加/ 简单/ ,/ 不妨/ 设/ lu/ (/ nu/ +/ 1/ )/ </ p/ 即/ 0/ </ lunu/ </ p/ ,/ 容易/ 得到/ -/ p/ </ F/ (/ u/ )/ =/ -/ luku/ +/ x/ +/ ∑/ i/ ∈/ / F/ (/ u/ )/ =/ 0modp/ / F/ (/ u/ )/ =/ 0modlu/ ./ 因此/ F/ (/ u/ )/ ≠/ 0modlu/ 蕴含/ F/ (/ u/ )/ ≠/ 0modp/ ,/ 这样/ 条件/ F/ (/ u/ )/ ≠/ 0modlu/ 就/ 足以/ 保证/ / 不会/ 在/ 私钥/ 提取/ 询问/ 过程/ 中/ 退出/ ./ 签密/ 询问/ ./ 在/ 任意/ 时刻/ ,/ 敌手/ 可以/ 发起/ 对/ 明文/ 信息/ m/ 和/ 身份/ 信息/ uA/ 与/ uB/ 的/ 签密/ 询问/ ./ 如果/ uA/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ uA/ )/ =/ 0modlu/ ,/ 则/ / 停止/ 游戏/ ;/ 否则/ / 首先/ 调用/ 私钥/ 提取/ 询问/ 产生/ uA/ 对应/ 的/ 私钥/ ,/ 然后/ 执行/ 算法/ Signcrypt/ (/ m/ ,/ dA/ ,/ IDB/ )/ 应答/ 敌手/ 的/ 询问/ ./ 解/ 签密/ 询问/ ./ 在/ 任意/ 时刻/ ,/ 敌手/ 可以/ 发起/ 对/ 签密/ 密文/ σ/ 和/ 身份/ 信息/ uA/ 与/ uB/ 的/ 解/ 签密/ 询问/ ./ 如果/ uB/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ uB/ )/ =/ 0modlu/ ,/ 则/ / 停止/ 游戏/ ;/ 否则/ ,/ / 首先/ 调用/ 私钥/ 提取/ 询问/ 产生/ uB/ 对应/ 的/ 私钥/ ,/ 然后/ 执行/ 算法/ Unsigncrypt/ (/ σ/ ,/ dB/ ,/ uA/ )/ 应答/ 敌手/ 的/ 询问/ ./ 挑战/ ./ 经过/ 多项式/ 轮数/ 的/ 询问/ 后/ ,/ 敌手/ 选择/ 他/ 想/ 挑战/ 的/ 身份/ 信息/ u/ / A/ 和/ u/ / B/ ,/ 注意/ 到/ :/ 敌手/ 在/ 第一阶段/ 不能/ 对/ u/ / A/ 和/ u/ / B/ 进行/ 私钥/ 提取/ 询问/ ./ 接着/ 敌手/ 选择/ 两条/ 等长/ 的/ 明文/ 消息/ m0/ 和/ m1/ ,/ 将/ 其/ 发送给/ 挑战者/ / ./ (/ 1/ )/ 如果/ u/ / A/ 不是/ 域/ PKGi/ / 的/ 用户/ ,/ / 停止/ 游戏/ ;/ (/ 2/ )/ 如果/ u/ / A/ 是域/ PKGi/ / 的/ 用户/ ,/ 但是/ F/ (/ u/ / B/ )/ =/ 0modlu/ ,/ / 停止/ 游戏/ ;/ (/ 3/ )/ 如果/ u/ / A/ 是域/ PKGi/ / 的/ 用户/ 且/ 满足/ F/ (/ u/ / B/ )/ =/ 0modlu/ ,/ / 选择/ 随机/ 比特/ γ/ 和/ 随机数/ r/ ∈/ Zp/ ,/ 按/ 下列/ 方式/ 构造/ m/ γ/ 对应/ 的/ 签密/ 密文/ :/ / 计算/ M/ =/ Hm/ (/ m/ γ/ ‖/ Z/ )/ ,/ 令/ / / {/ 1/ ,/ 2/ ,/ …/ ,/ nm/ }/ 为/ M/ [/ i/ ]/ =/ 1/ 的/ 位/ i/ 的/ 集合/ ./ 如果/ K/ (/ M/ )/ ≠/ 0modnm/ ,/ 则/ 停止/ 游戏/ ./ 否则/ 设定/ 签密/ 密文/ 为/ σ/ / =/ (/ m/ γ/ / H/ (/ Z/ )/ ,/ C/ ,/ CJ/ (/ u/ / P/ -/ 当/ Z/ =/ e/ (/ g/ ,/ g/ )/ abc/ ,/ C/ =/ gc/ 时/ ,/ 这个/ 模拟/ 是/ 完美/ 的/ ,/ 这/ 是因为/ Z/ =/ e/ (/ g/ ,/ g/ )/ abc/ =/ e/ (/ ga/ ,/ gb/ )/ c/ =/ e/ (/ Pi/ / ,/ g2/ )/ c/ ,/ CJ/ (/ u/ / P/ -/ J/ (/ u/ / A/ )/ i/ / (/ gF/ (/ u/ / F/ (/ u/ / B/ )/ =/ P/ -/ J/ (/ u/ / A/ )/ =/ g/ -/ a/ ·/ J/ (/ u/ / A/ )/ =/ ga/ 第二阶段/ 敌手/ 可以/ 进行/ 和/ 第一阶段/ 相同/ 的/ 多项式/ 次数/ 询问/ ,/ 注意/ 敌手/ 不能/ 发起/ 对/ 身份/ 信息/ u/ / B/ 的/ 私钥/ 提取/ 询问/ 和/ 对/ 挑战/ 密文/ 的/ 解/ 签密/ 询问/ ./ Page6/ 猜测/ ./ 在/ 模拟/ 的/ 末尾/ ,/ 敌手/ 输出/ 对/ γ/ 的/ 猜测/ 值/ γ/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 如果/ γ/ =/ γ/ ,/ / 返回/ 1/ 表示/ Z/ =/ e/ (/ g/ ,/ g/ )/ abc/ ;/ 否则/ / 返回/ 0/ ,/ 作为/ DBDH/ 问题/ 的/ 解/ ./ 成功/ 的/ 概率/ ./ 现在/ 来/ 计算/ / 成功/ 的/ 概率/ ,/ 为/ 保证/ 模拟/ 顺利进行/ ,/ 在/ 模拟/ 过程/ 中/ 必须/ 保证/ 如下/ 条件/ :/ (/ 1/ )/ 对/ 身份/ 信息/ u/ 的/ 私钥/ 提取/ 询问/ ,/ 必须/ 满足/ u/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ u/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ u/ )/ ≠/ 0modlu/ ;/ (/ 2/ )/ 对/ 消息/ m/ 的/ 发起/ 签密/ 询问/ ,/ 签密者/ 的/ 身份/ 信息/ uA/ ,/ 必须/ 满足/ uA/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ uA/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ uA/ )/ ≠/ 0modlu/ ;/ (/ 3/ )/ 对/ 密文/ σ/ 的/ 解/ 签密/ 询问/ ,/ 解签/ 密者/ 的/ 身份/ 信息/ 为/ uB/ ,/ 必须/ 满足/ uB/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ uB/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ uB/ )/ ≠/ 0modlu/ ;/ (/ 4/ )/ 在/ 挑战/ 阶段/ ,/ 必须/ 满足/ u/ / A/ 是域/ PKGi/ / 的/ 用户/ 且/ 满足/ F/ (/ u/ / A/ )/ ≠/ 0modp/ ,/ 另外/ K/ (/ M/ γ/ )/ =/ 0modp/ ,/ 其中/ M/ γ/ =/ Hm/ (/ m/ γ/ ‖/ Z/ )/ ./ 令/ u1/ ,/ …/ ,/ uqI/ 为/ 所有/ 出现/ 私钥/ 提取/ 询问/ 中/ 的/ 身份/ 信息/ ,/ 易得/ qI/ / qE/ +/ qS/ +/ qU/ ./ 定义/ 事件/ 如下/ :/ Ai/ 为/ F/ (/ ui/ )/ ≠/ 0modlu/ ;/ A/ 为/ F/ (/ u/ / B/ )/ ≠/ 0modp/ ;/ B/ / 为/ K/ (/ M/ γ/ )/ =/ 0modp/ ;/ C/ 为/ u/ 是域/ PKGi/ / 中/ 的/ 用户/ ./ 这样/ ,/ / 不会/ 放弃/ 模拟/ 的/ 概率/ 可以/ 表示/ 为/ Pr/ [/ abort/ ]/ / Pr/ [/ ∧/ qI/ 首先/ ,/ 根据/ 概率/ 事件/ 的/ 分配率/ 有/ (/ C/ ∧/ Ai/ )/ ∨/ 珚/ C/ =/ (/ C/ ∨/ 珚/ C/ )/ ∧/ (/ Ai/ ∨/ 珚/ C/ )/ =/ (/ Ai/ ∨/ 珚/ C/ )/ ,/ 因此/ ,/ Pr/ [/ ∧/ qI/ 因为/ i/ / 是/ 独立/ 选择/ 的/ ,/ 因此/ ,/ 事件/ ∧/ qIC/ 是/ 相互/ 独立/ 的/ ,/ 因此/ ,/ 我们/ 有/ 因为/ 函数/ F/ 和/ K/ 是/ 独立/ 选择/ 的/ ,/ 因此/ ,/ 事件/ ∧/ qIA/ 和/ B/ / 是/ 相互/ 独立/ 的/ ,/ 因为/ ku/ 、/ x/ 和/ X/ 的/ 随机性/ ,/ 有/ Pr/ [/ A/ ]/ =/ Pr/ [/ F/ (/ u/ / )/ =/ 0modp/ ]/ 同理/ ,/ Pr/ [/ B/ / ]/ =/ 1/ 另一方面/ ,/ 对/ 任意/ i/ ,/ 事件/ Ai/ 和/ A/ 均/ 为/ 独立/ 的/ ,/ 因此/ 有/ Pr/ [/ ∧/ qI/ 最后/ ,/ 可以/ 得到/ 挑战者/ 不/ 放弃/ 模拟/ 的/ 概率/ 为/ Pr/ [/ abort/ ]/ / Pr/ [/ ∧/ qI/ 这样/ ,/ 如果/ 模拟/ 没有/ 被/ 放弃/ ,/ 敌手/ 可以/ 以/ ε/ 的/ 概率/ 赢得/ 定义/ 3/ 中/ 的/ 游戏/ ,/ 那么/ 挑战者/ 可以/ 解决/ DBDH/ 问题/ 实例/ 的/ 概率/ 就/ 至少/ 为/ 因此/ ,/ 提出/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 在/ 自/ 适应/ 选择/ 密文/ 攻击/ 下/ 满足/ 密文/ 不可/ 区分/ 性/ ./ 定理/ 1/ 得证/ ./ 定理/ 2/ ./ 在/ CDH/ 困难/ 问题/ 假设/ 下/ ,/ 提出/ 的/ 多/ PKG/ 基于/ 身份/ 签密/ 方案/ 在/ 自/ 适应/ 选择/ 消息/ 攻击/ 下/ 具有/ 密文/ 的/ 存在/ 性/ 不可/ 伪造/ 性/ ./ 假设/ 存在/ 定义/ 2/ 中/ 的/ 敌手/ ,/ 在/ 经过/ 至多/ qE/ 次/ 私钥/ 提取/ 询问/ ,/ qS/ 次/ 签密/ 询问/ 以及/ qU/ 次解/ 签密/ 询问/ ,/ 可以/ 以/ 概率/ ε/ 伪造/ 密文/ ,/ 则/ 存在/ 一个/ 挑战者/ ,/ 可以/ 以/ Page72qS/ (/ nm/ +/ 1/ )/ +/ 2/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ -/ 18lqS/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ (/ nm/ +/ 1/ )/ ε/ 的/ 优势/ 解决/ 计算/ 性/ Diffie/ -/ Hellman/ 问题/ ./ 证明/ ./ 假设/ 存在/ 成功/ 的/ EUF/ -/ MPIDSC/ -/ CMA/ 敌手/ ,/ 则/ 可以/ 构造/ 挑战者/ / ,/ 将/ 敌手/ 作为/ 子程序/ 解决/ CDH/ 困难/ 问题/ 的/ 实例/ ./ 给定/ 一个/ CDH/ 困难/ 问题/ 实例/ :/ 群/ G/ ,/ 生成元/ g/ ,/ 元素/ ga/ 和/ gb/ ,/ / 的/ 目标/ 是/ 输出/ gab/ ./ / 首先/ 如/ 定理/ 1/ 中/ 所示/ 设定/ 全局/ 系统/ 参数/ 及域/ 主/ 密钥/ 和域/ 公钥/ ,/ 其中/ g2/ =/ gb/ ,/ PKGi/ / 的/ 域/ 公钥/ 为/ ga/ ./ 在/ / 定义/ 函数/ F/ (/ u/ )/ ,/ J/ (/ u/ )/ ,/ K/ (/ m/ )/ 和/ L/ (/ m/ )/ 后/ 有/ u/ ∏/ i/ ∈/ / 敌手/ 可以/ 发起/ 多项式/ 次数/ 的/ 询问/ ,/ 包括/ 私钥/ 提取/ 询问/ 、/ 签密/ 询问/ 和解/ 签密/ 询问/ ,/ 挑战者/ / 如/ 定理/ 1/ 中/ 方法/ 回答/ 询问/ ./ 如果/ / 没有/ 放弃/ 模拟/ ,/ 敌手/ 返回/ 一个/ 对/ 消息/ m/ / 的/ 签密/ 密文/ σ/ / ,/ 其中/ 敌手/ 对/ 元组/ (/ m/ / ,/ u/ / A/ ,/ u/ / B/ )/ 没有/ 询问/ 过/ ./ / 可以/ 解/ 签密/ σ/ / 得到/ 消息/ (/ m/ / ,/ R/ / )/ ,/ 计算/ M/ / =/ Hm/ (/ m/ / ‖/ R/ / )/ ,/ 如果/ 不/ 同时/ 满足/ 下面/ 的/ 条件/ ,/ / 放弃/ 模拟/ :/ (/ 1/ )/ u/ / A/ 是域/ PKGi/ / 中/ 的/ 用户/ ;/ (/ 2/ )/ F/ (/ u/ / A/ )/ =/ 0modp/ 或者/ K/ (/ M/ / )/ =/ 0modp/ ./ 否则/ / 计算/ 并/ 返回/ (/ σ/ / 5/ )/ J/ (/ u/ / =/ =/ Pi/ / =/ gab/ 作为/ CDH/ 问题/ 的/ 解/ ./ 成功/ 的/ 概率/ ./ 现在/ 来/ 计算/ / 成功/ 的/ 概率/ ,/ 为/ 保证/ 模拟/ 顺利进行/ ,/ 在/ 模拟/ 过程/ 中/ 必须/ 保证/ 如下/ 条件/ :/ (/ 1/ )/ 对/ 身份/ 信息/ u/ 的/ 私钥/ 提取/ 询问/ ,/ 必须/ 满足/ u/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ u/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ u/ )/ ≠/ 0modlu/ ;/ (/ 2/ )/ 对/ 消息/ m/ 的/ 发起/ 签密/ 询问/ ,/ 签密者/ 的/ 身份/ 信息/ u/ ,/ 必须/ 满足/ u/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ u/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ u/ )/ ≠/ 0modlu/ ;/ (/ 3/ )/ 对/ 密文/ σ/ 的/ 解/ 签密/ 询问/ ,/ 解签/ 密者/ 的/ 身份/ 信息/ 为/ uB/ ,/ 必须/ 满足/ uB/ 是域/ PKGx/ (/ x/ ≠/ i/ / )/ 的/ 用户/ 或者/ uB/ 是域/ PKGi/ / 的/ 用户/ 且/ F/ (/ uB/ )/ ≠/ 0modlu/ ;/ (/ 4/ )/ 在/ 伪造/ 阶段/ ,/ 必须/ 满足/ u/ / A/ 是域/ PKGi/ / 的/ 用户/ ,/ F/ (/ u/ / A/ )/ =/ 0modp/ 或者/ K/ (/ M/ / )/ =/ 0modp/ ,/ 其中/ M/ / =/ Hm/ (/ m/ / ‖/ R/ / )/ ./ 令/ u1/ ,/ …/ ,/ uqI/ 为/ 所有/ 出现/ 私钥/ 提取/ 询问/ 中/ 的/ 身份/ 信息/ ,/ 易得/ qI/ / qE/ +/ qS/ +/ qU/ ./ 定义/ 与/ 定理/ 1/ 中/ 相同/ 的/ 事件/ Ai/ ,/ A/ ,/ B/ / 及/ C/ ,/ 这样/ ,/ / 不会/ 放弃/ 模拟/ 的/ 概率/ 可以/ 表示/ 为/ Pr/ [/ abort/ ]/ / Pr/ [/ ∧/ qI/ =/ Pr/ [/ ∧/ qIi/ =/ 1/ (/ Ai/ ∨/ 珚/ C/ )/ ∧/ C/ ∧/ (/ A/ ∨/ B/ / )/ ]/ =/ Pr/ [/ ∧/ qIi/ =/ 1Ai/ ∧/ C/ ∧/ (/ A/ ∨/ B/ / )/ ]/ =/ Pr/ [/ ∧/ qIi/ =/ 1Ai/ ∧/ C/ ∧/ A/ ]/ +/ Pr/ [/ ∧/ qIPr/ [/ ∧/ qIi/ =/ 1Ai/ ∧/ C/ ∧/ A/ ∧/ B/ / ]/ ./ 根据/ 定理/ 1/ 中/ 的/ 分析/ ,/ 我们/ 有/ i/ =/ 1Ai/ ∧/ C/ ∧/ A/ ]/ =/ 1/ -/ qIl/ (/ )/ uPr/ [/ ∧/ qIi/ =/ 1Ai/ ∧/ C/ ∧/ B/ / ]/ =/ 1/ -/ qIl/ (/ )/ uPr/ [/ ∧/ qIi/ =/ 1Ai/ ∧/ C/ ∧/ A/ ∧/ B/ / ]/ =/ 1/ -/ qIl/ (/ )/ uPr/ [/ ∧/ qInu/ +/ 1/ ·/ 11/ 从而/ ,/ Pr/ [/ abort/ ]/ / Pr/ [/ ∧/ qIPr/ [/ ∧/ qI/ =/ 1/ -/ qIl/ (/ )/ u1/ -/ qIl/ (/ )/ u1/ -/ qIl/ (/ )/ u/ =/ 1/ -/ qIl/ (/ )/ u/ (/ / 1/ -/ qE/ +/ qS/ +/ qU2/ (/ qE/ +/ qS/ +/ qU2qS/ (/ nm/ +/ 1/ )/ +/ 2/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ -/ 1/ =/ 2qS/ (/ nm/ +/ 1/ )/ +/ 2/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ -/ 1/ 这样/ ,/ 如果/ 模拟/ 没有/ 被/ 放弃/ ,/ 敌手/ 可以/ 以/ ε/ 的/ 概率/ 赢得/ 定义/ 3/ 中/ 的/ 游戏/ ,/ 那么/ 挑战者/ 可以/ 解决/ CDH/ 问题/ 实例/ 的/ 概率/ 就/ 至少/ 为/ 2qS/ (/ nm/ +/ 1/ )/ +/ 2/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ -/ 18lqS/ (/ qE/ +/ qS/ +/ qU/ )/ (/ nu/ +/ 1/ )/ (/ nm/ +/ 1/ )/ ε/ ./ 因此/ ,/ 提出/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 在/ 自/ 适应/ 选择/ 消息/ 攻击/ 下/ 具有/ 密文/ 的/ 存在/ 性/ 不可/ 伪造/ 性/ ,/ 定理/ 2/ 得证/ ./ Page84/ ./ 4/ 性能/ 比较/ 本/ 节/ 我们/ 将/ 新/ 方案/ 与/ 已有/ 的/ 签密/ 方案/ 进行/ 性能/ 比较/ ,/ 注意/ :/ 我们/ 仅/ 比较/ 需要/ 在线/ 计算/ 的/ 运算/ 个数/ ,/ 可以/ 预先/ 计算/ 的/ 运算/ 不予/ 统计/ ./ 首先/ ,/ 我们/ 将/ 新/ 构造/ 的/ 多/ PKG/ 环境/ 下签/ 密/ 方案/ 与/ 已有/ 的/ RO/ 模型/ 下/ 的/ 方案/ [/ 12/ -/ 13/ ,/ 15/ ]/ 进行/ 性能/ 比较/ ,/ 见表/ 1/ ./ 从表/ 1/ 中/ 可以/ 看到/ ,/ 我们/ 的/ 方案/ 在/ 增加/ 计算/ 代价/ 的/ 基础/ 上/ ,/ 实现/ 了/ 标准/ 模型/ 下/ 的/ 可/ 证明/ 安全/ ./ 因此/ ,/ 新/ 方案/ 在/ 安全性/ 方面/ 具有/ 一定/ 的/ 优势/ ./ 表/ 1/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 的/ 性能/ 比较/ 文献/ Li/ 方案/ [/ 12/ ]/ 323NoRO/ 模型/ Li/ 方案/ [/ 13/ ]/ 314NoRO/ 模型/ 闻/ 方案/ [/ 15/ ]/ 323YesRO/ 模型/ 本文/ 方案/ 542nm/ +/ 4Yes/ 标准/ 模型/ 表/ 2/ 中/ 我们/ 对/ 方案/ 退化/ 为/ 单个/ PKG/ 环境/ 时/ 与/ 其他/ 标准/ 模型/ 下/ 基于/ 身份/ 的/ 签密/ 方案/ 进行/ 了/ 比较/ ,/ 从中/ 我们/ 可以/ 看到/ 新/ 方案/ 实现/ 了/ CCA/ 安全/ 和/ 存在/ 不可/ 伪造/ 性/ ,/ 在/ 计算/ 效率/ 方面/ 稍/ 有/ 优势/ ./ 表/ 2/ 单个/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ 的/ 性能/ 比较/ 文献/ Yu/ 方案/ [/ 8/ ]/ 542nm/ +/ 6NoNoJin/ 方案/ [/ 9/ ]/ 542nm/ +/ 6NoNo/ 张/ 方案/ [/ 10/ ]/ 582nm/ +/ 8NoYesLi/ 方案/ [/ 12/ ]/ 572nm/ +/ 9YesYes/ 本文/ 方案/ 542nm/ +/ 4YesYes5/ 结束语/ 本文/ 提出/ 了/ 一个/ 有效/ 的/ 多/ PKG/ 环境/ 下/ 基于/ 身份/ 签密/ 方案/ ,/ 并/ 在/ 标准/ 模型/ 下/ 对/ 方案/ 的/ CCA2/ 安全/ 和/ 存在/ 性/ 不可/ 伪造/ 性/ 进行/ 了/ 证明/ ./ 特别/ 的/ ,/ 当/ 环境退化/ 为/ 单个/ PKG/ 时/ ,/ 我们/ 的/ 方案/ 也/ 是/ 安全/ 有效/ 的/ ./ 下/ 一步/ 的/ 工作/ 是/ 对/ 各个/ PKG/ 拥有/ 不同/ 系统/ 参数/ 签密/ 方案/ 进行/ 深入研究/ ./ 

