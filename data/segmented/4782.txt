Page1/ 云外/ 包/ 计算/ 中/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ 陈振华/ 1/ )/ ,/ 2/ )/ 李顺东/ 3/ )/ 黄琼/ 4/ )/ 丁勇/ 5/ )/ 孙/ ?/ 1/ )/ 1/ )/ (/ 西安/ 科技/ 大学/ 计算机科学/ 与/ 技术/ 学院/ 西安/ 710054/ )/ 2/ )/ (/ 中国科学院/ 信息工程/ 研究所/ 信息安全/ 国家/ 重点/ 实验室/ 北京/ 100093/ )/ 3/ )/ (/ 陕西/ 师范大学/ 计算机科学/ 学院/ 西安/ 710062/ )/ 4/ )/ (/ 华南农业大学/ 数学/ 与/ 信息/ 学院/ 广州/ 510642/ )/ 5/ )/ (/ 桂林/ 电子科技/ 大学/ 广西/ 密码学/ 与/ 信息安全/ 重点/ 实验室/ 广西/ 桂林/ 541004/ )/ 摘要/ 目前/ 安全/ 多方/ 几何/ 计算/ 问题/ 都/ 是/ 在/ 传统模式/ 下/ 依靠/ 参与方/ 交互/ 完成/ ,/ 文中/ 首次/ 将/ 安全/ 多方/ 几何/ 计算/ 问题/ 转移/ 到/ 云/ 计算/ 平台/ 下/ 借助/ 不可/ 信/ 第三方/ 云/ 服务器/ 参与/ 完成/ ,/ 这为/ 安全/ 多方/ 计算/ 提供/ 了/ 一个/ 新/ 的/ 研究/ 方向/ ./ 传统模式/ 下/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ 已存/ 方案/ ,/ 大多/ 是/ 把/ 原/ 问题/ 转化/ 为/ 距离/ 问题/ 或/ 数据/ 对应/ 成/ 比例/ 问题/ ,/ 造成/ 了/ 用户/ 计算成本/ 过大/ ,/ 或能/ 判断/ 的/ 位置/ 关系/ 有限/ ,/ 而且/ 这些/ 方法/ 只能/ 由/ 参与方/ 相互/ 交互/ 完成/ ,/ 因此/ 在/ 云/ 计算/ 平台/ 下/ 并/ 不/ 适用/ ./ 针对/ 这些/ 问题/ ,/ 文中/ 首先/ 将/ 原/ 问题/ 转化/ 为/ 夹角/ 问题/ ,/ 接着/ 设计/ 了/ 适用/ 于云外/ 包/ 计算/ 的/ 内积/ 协议/ ,/ 然后/ 基于/ 此/ 内积/ 协议/ 在/ 云/ 平台/ 下/ 解决/ 了/ 点线/ 、/ 线线/ 、/ 点面/ 、/ 线面/ 、/ 面/ 面/ 五种/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ ,/ 并用/ 模拟/ 范例/ 证明/ 了/ 协议/ 的/ 安全性/ ./ 最后/ 的/ 分析/ 和/ 比较/ 显示/ ,/ 文中/ 不但/ 首次/ 设计/ 了/ 云/ 计算/ 平台/ 下/ 空间/ 位置/ 关系/ 的/ 保密/ 判断/ 协议/ ,/ 并且/ 设计/ 的/ 方案/ 能/ 判断/ 的/ 位置/ 关系/ 更加/ 广泛/ ,/ 也/ 为/ 用户/ 节省/ 了/ 更/ 多/ 的/ 计算成本/ ./ 此外/ ,/ 我们/ 设计/ 的/ 内积/ 协议/ 可以/ 作为/ 一种/ 新/ 的/ 云/ 计算技术/ 的/ 基础/ 协议/ ,/ 可以/ 被/ 其他/ 协议/ 调用/ ./ 关键词/ 安全/ 多方/ 计算/ ;/ 位置/ 关系/ ;/ 空间/ 几何/ ;/ 内积/ 协议/ ;/ 云/ 计算/ 1/ 引言/ 安全/ 多方/ 计算/ 最早/ 由/ Yao/ [/ 1/ ]/ 提出/ ,/ 是/ 指/ 在/ 不/ 泄漏/ 各方/ 的/ 输入/ 数据/ (/ 隐私/ 性/ )/ 的/ 条件/ 下/ ,/ 能/ 正确/ 合作/ 完成/ 输入/ 数据/ 的/ 函数/ 计算/ (/ 正确性/ )/ ./ 现实/ 问题/ 中/ 涉及/ 到/ 保护/ 隐私/ 的/ 合作/ 计算/ 都/ 可以/ 归结到/ 安全/ 多方/ 计算/ 的/ 研究/ 范围/ ./ 因此/ 它/ 在/ 保护/ 隐私/ 的/ 质量/ 评估/ [/ 2/ ]/ 、/ 定位/ 查找/ [/ 3/ -/ 4/ ]/ 、/ 数据挖掘/ [/ 5/ ]/ 、/ 数据/ 查询/ [/ 6/ -/ 7/ ]/ 、/ 外/ 包/ 计算/ [/ 8/ ]/ 等/ 方面/ 有着/ 广泛/ 的/ 应用/ ./ 安全/ 计算/ 几何/ 问题/ 属于/ 安全/ 多方/ 计算/ 中/ 的/ 一个/ 分支/ ,/ 是/ 指/ 各/ 参与者/ 都/ 处在/ 几何图形/ 中/ ,/ 各自/ 拥有/ 几何图形/ 中/ 的/ 一些/ 参量/ ,/ 在/ 不/ 泄露/ 各/ 参与方/ 数据/ 隐私/ 的/ 条件/ 下/ ,/ 合作/ 计算/ 一些/ 几何/ 问题/ ./ 无论是/ 在/ 理论/ 还是/ 实际/ 中/ ,/ 安全/ 计算/ 几何/ 问题/ 是/ 经常/ 会/ 碰到/ 的/ 问题/ ./ 针对/ 于/ 此/ ,/ Yang/ 等/ 人/ [/ 9/ ]/ 研究/ 了/ 平面/ 上线/ 和/ 圆/ 、/ 圆/ 和/ 圆/ 的/ 位置/ 关系/ ./ Liu/ 等/ 人/ [/ 10/ ]/ 研究/ 了/ 更/ 普遍意义/ 上/ 的/ 点/ 和/ 一般/ 曲线/ 的/ 位置/ 关系/ ./ Qin/ 等/ 人/ [/ 11/ ]/ 研究/ 了/ 平面曲线/ 相交/ 问题/ ./ Liu/ 等/ 人/ [/ 12/ ]/ 研究/ 了/ 平面/ 上/ 三角形/ 面积/ 的/ 计算/ 问题/ ./ He/ 等/ 人/ [/ 13/ ]/ 研究/ 了/ 平面/ 上线/ 和/ 圆/ 、/ 线/ 和/ 双曲线/ 的/ 位置/ 关系/ ./ 但是/ 这些/ 问题/ 都/ 集中/ 在/ 平面几何/ 上/ ,/ 而/ 空间/ 几何/ 问题/ 很少/ 有人/ 涉及/ ./ 由于/ 空间/ 几何/ 比/ 平面几何/ 更能/ 形象/ 的/ 刻画/ 现实/ 世界/ ,/ 因此/ 研究/ 立体几何/ ,/ 意义/ 更加/ 重大/ ./ 例如/ 以下/ 的/ 场景/ :/ A/ 国/ 准备/ 向/ C/ 国/ 发射/ 航空/ 导弹/ ,/ 但/ C/ 国/ 的/ 领空/ 上/ 有/ A/ 国/ 的/ 盟国/ B/ 国/ 的/ 一部分/ 秘密/ 基地/ (/ 如/ 太空站/ )/ ,/ 因此/ A/ 国/ 不能/ 伤害/ 自己/ 的/ 盟国/ ,/ 即/ A/ 国/ 的/ 航空/ 导弹/ 不能/ 穿过/ B/ 国/ 的/ 秘密/ 基地/ ./ 但是/ 为了/ 军事机密/ ,/ A/ 国/ 不能/ 向/ B/ 国/ 透露/ 自己/ 的/ 航空/ 导弹/ 轨道/ ,/ 而/ B/ 国/ 也/ 不能/ 向/ A/ 国/ 透露/ 自己/ 太空站/ 的/ 具体位置/ ./ 那么/ 双方/ 如何/ 在/ 不/ 暴露/ 自己/ 隐私/ 的/ 情况/ 下/ ,/ 解决/ 这个/ 问题/ 呢/ ?/ 以上/ 场景/ 属于/ 保密/ 军事/ 问题/ ,/ 转化成/ 数学模型/ 就是/ 保密/ 判定/ 空间/ 中/ 一个点/ 是否/ 在/ 空间/ 一条/ 直线/ 上/ ,/ 属于/ 立体几何/ 中/ 空间/ 位置/ 关系/ 的/ 安全/ 多方/ 计算/ 问题/ ./ 但/ 目前/ 关于/ 这方面/ 的/ 研究/ 文献/ 并不多/ ./ 由于/ 现实/ 中/ 很多/ 问题/ 都/ 可以/ 归结为/ 此类/ 问题/ ,/ 因此/ 研究/ 其/ 理论意义/ 对/ 现实/ 问题/ 有着/ 重要/ 的/ 应用/ 价值/ ./ 1.1/ 相关/ 工作/ 针对/ 立体几何/ 中/ 点/ 、/ 线/ 、/ 面等/ 空间/ 位置/ 关系/ 的/ 安全/ 多方/ 计算/ 问题/ ,/ 以往/ 的/ 学者/ 们/ 提出/ 了/ 一些/ 解决方案/ ./ 2006/ 年/ ,/ 罗永龙/ 等/ 人/ [/ 14/ ]/ 利用/ 法/ 向量/ 与/ 方向/ 向量/ ,/ 将/ 原/ 问题/ 转化成/ 数据/ 对应/ 成/ 比例/ 的/ 问题/ ,/ 从而/ 解决/ 了/ 线线/ 、/ 线面/ 、/ 面/ 面/ 位置/ 关系/ 的/ 判定/ ./ 由于/ 该/ 方案/ 调用/ 了/ 多种/ 基本/ 协议/ :/ 百万富翁/ 协议/ 、/ 点积/ 协议/ ,/ 数据/ 对应/ 成/ 比例/ 协议/ ./ 其中/ 的/ 数据/ 对应/ 成/ 比例/ 协议/ 的/ 复杂性/ ,/ 使得/ 方案/ 的/ 计算成本/ 和/ 通信/ 成本/ 极高/ ,/ 成为/ 了/ 制约/ 效率/ 的/ 瓶颈/ (/ 后文表/ 4/ 有/ 分析/ )/ ./ 2014/ 年/ ,/ Li/ 等/ 人/ [/ 15/ ]/ 利用/ 四面体/ 的/ 体积/ ,/ 将/ 原/ 问题/ 转化/ 为/ 距离/ 来/ 判定/ 点面/ 、/ 线面/ 、/ 面面/ 的/ 位置/ 关系/ ./ 此/ 方法/ 非常简单/ 巧妙/ 而且/ 效率/ 较/ 高/ ,/ 但是/ 由于/ 该/ 方法/ 要/ 利用/ 四面体/ 的/ 体积/ ,/ 再/ 通过/ 距离/ 解决/ 空间/ 位置/ 关系/ ./ 而点/ 和/ 直线/ 、/ 直线/ 和/ 直线/ ,/ 无法/ 组成/ 四面体/ ,/ 因此/ 该/ 方法/ 要/ 判断/ 点/ 与/ 线/ 、/ 线/ 与/ 线/ 的/ 位置/ ,/ 并/ 不/ 适用/ ./ 即/ ,/ 该/ 方法/ 能/ 解决/ 的/ Page3/ 问题/ 比较/ 局限/ ,/ 能/ 判断/ 出/ 的/ 位置/ 关系/ 也/ 比较/ 单一/ (/ 后文表/ 5/ 有/ 分析/ )/ ./ 由于/ 以上/ 方案/ 都/ 是/ 在/ 传统模式/ 下/ 解决/ ,/ 并且/ 由于/ 使用/ 的/ 转化/ 方法/ ,/ 使得/ 用户/ 的/ 计算/ 开销/ 过大/ (/ 罗永龙/ 等/ 人/ [/ 14/ ]/ 的/ 方法/ )/ ,/ 或者/ 解决/ 的/ 问题/ 比较/ 局限/ 、/ 能/ 判断/ 出/ 的/ 位置/ 关系/ 也/ 比较/ 单一/ (/ Li/ 等/ 人/ [/ 15/ ]/ 的/ 方法/ )/ ./ 传统/ 的/ 安全/ 多方/ 计算/ 中/ 不/ 存在/ 可信/ 的/ 第三方/ ,/ 都/ 是/ 由/ 参与方/ 相互/ 交互/ 合作/ 完成/ 计算/ 任务/ ./ 因此/ 计算能力/ 仅仅/ 依靠/ 用户/ 本身/ ,/ 这/ 在/ 解决/ 复杂/ 问题/ 时/ 往往/ 效率/ 较/ 低/ ./ 云/ 计算/ 是/ 一种/ 新/ 的/ 服务/ 交付/ 和/ 计算/ 模式/ ,/ 具有/ 强大/ 的/ 计算能力/ ,/ 因此/ 人们/ 想到/ 可以/ 将/ 安全/ 多方/ 计算/ 中/ 的/ 复杂/ 计算/ 任务/ 以/ 按/ 需/ 付费/ 的/ 形式/ 外包/ 给/ 云/ ,/ 从而/ 为/ 用户/ 节省/ 大量/ 的/ 计算成本/ ./ 但/ 由于/ 云/ 计算/ 服务器/ (/ 第三方/ )/ 是/ 不可/ 信/ 的/ ,/ 因此/ 将/ 传统/ 的/ 安全/ 多方/ 计算/ 模式/ 转移/ 到/ 云/ 计算/ 平台/ 下时/ ,/ 就/ 有/ 较大/ 的/ 区别/ ,/ 所用/ 到/ 的/ 技术手段/ 也/ 有/ 不同/ ./ 若/ 把/ 本文/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ 问题/ 转移/ 到/ 云/ 计算/ 平台/ 下/ 进行/ 研究/ ,/ 以往/ 的/ 协议/ [/ 14/ -/ 15/ ]/ 由于/ 都/ 是/ 依靠/ 参与方/ 本身/ 交互/ 完成/ ,/ 并/ 不适/ 用于/ 云/ 计算/ 平台/ ./ 那么/ 如何/ 在/ 不可/ 信/ 第三方/ 存在/ 的/ 云/ 平台/ 下/ 解决/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ 正是/ 本文/ 要/ 解决/ 的/ 问题/ ./ 1.2/ 本文/ 贡献/ 本文/ 首次/ 将/ 传统/ 的/ 安全/ 计算/ 几何/ 问题/ 转移/ 到/ 云/ 计算/ 平台/ 下/ ,/ 并/ 利用/ 内积/ 解决/ 了/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ ./ 具体/ 贡献/ 如下/ :/ (/ 1/ )/ 提供/ 了/ 一种/ 新/ 的/ 转化/ 方法/ ./ 本文/ 将/ 空间/ 位置/ 关系/ 的/ 判定/ 问题/ 转化/ 为/ 夹角/ 问题/ ./ 避免/ 了/ 前人/ 多次/ 求/ 距离/ 或/ 数据/ 对应/ 成/ 比例/ 的/ 方法/ ./ 使得/ 能/ 判断/ 的/ 位置/ 关系/ 多样化/ 、/ 解决/ 的/ 问题/ 更加/ 广泛/ ./ (/ 2/ )/ 提供/ 了/ 新/ 技术/ ./ 本文/ 设计/ 的/ 适用/ 于云/ 计算/ 外包/ 的/ 内积/ 协议/ ,/ 可/ 单独/ 作为/ 一种/ 新/ 的/ 云/ 计算技术/ ./ (/ 3/ )/ 提供/ 了/ 新/ 的/ 研究/ 方向/ ./ ①/ 将/ 传统/ 的/ 无/ 可信/ 第三方/ 的/ 安全/ 多方/ 计算/ 转移/ 到/ 有/ 不可/ 信/ 第三方/ 存在/ 的/ 云/ 计算/ 平台/ 下/ 进行/ 研究/ ./ ②/ 借助/ 云/ 计算/ 的/ 能力/ 为/ 安全/ 多方/ 计算/ 中/ 的/ 用户/ 节省/ 了/ 计算成本/ ./ 2/ 预备/ 知识/ 2.1/ 安全/ 多方/ 计算/ 的/ 安全性/ 定义/ 由于/ 本文/ 所/ 涉及/ 的/ 参与方/ 和/ 云/ 服务器/ 都/ 是/ 半/ 诚实/ 模型/ ,/ 恶意/ 模型/ 下/ 的/ 协议/ 可以/ 根据/ Goldreich/ 等/ 人/ [/ 16/ -/ 17/ ]/ 的/ 通用/ 转化/ 方法/ 直接/ 由半/ 诚实/ 模型/ 下/ 的/ 协议/ 转化/ 得到/ ./ 因此/ 这里/ 只/ 给出/ 半/ 诚实/ 模型/ 下/ 的/ 协议/ 和/ 相应/ 的/ 安全性/ 模拟/ 范例/ ./ (/ 1/ )/ 半/ 诚实/ 参与者/ 安全/ 多方/ 计算/ 的/ 协议/ 运行/ 环境/ 分为/ 半/ 诚实/ 参与者/ 模型/ 和/ 恶意/ 参与者/ 模型/ [/ 16/ -/ 17/ ]/ ,/ 半/ 诚实/ 参与者/ 指/ 协议/ 方将/ 诚实/ 地/ 执行/ 协议/ ,/ 不会/ 篡改/ 输入/ 和/ 输出/ 信息/ ,/ 但/ 可能/ 会/ 保留/ 计算/ 的/ 中间/ 结果/ ,/ 试图/ 推导/ 出/ 协议/ 之外/ 的/ 信息/ 或者/ 他人/ 的/ 信息/ ./ (/ 2/ )/ 半/ 诚实/ 模型/ 下/ 的/ 安全性/ 定义/ 云/ 计算/ 平台/ 下/ 的/ 安全/ 两方/ 计算/ ,/ 由于/ 不可/ 信/ 第三方/ (/ 云/ 服务器/ )/ 参与/ 了/ 计算/ ,/ 因此/ 和/ 传统模式/ 下/ 安全/ 两方/ 计算/ 的/ 安全性/ 模拟/ 范例/ 略有不同/ ./ 设/ Alice/ 拥有/ x/ ,/ Bob/ 拥有/ y/ ,/ Server/ 是/ 云/ 服务器/ ,/ f/ (/ x/ ,/ y/ )/ 为/ 概率/ 多项式/ 函数/ ,/ π/ 是/ 计算/ f/ 的/ 协议/ ./ 三方/ 要/ 在/ 不/ 暴露/ x/ ,/ y/ 的/ 前提/ 下/ ,/ 合作/ 计算/ 函数/ f/ (/ x/ ,/ y/ )/ =/ (/ f1/ (/ x/ ,/ y/ )/ ,/ f2/ (/ x/ ,/ y/ )/ )/ ./ 计算/ 的/ 目的/ 是/ 为了/ 让/ Alice/ 和/ Bob/ 分别/ 得到/ 函数/ f/ 的/ 两个/ 分量/ f1/ (/ x/ ,/ y/ )/ ,/ f2/ (/ x/ ,/ y/ )/ ./ 在/ 整个/ 计算/ 过程/ 中/ ,/ 要/ 保证/ Alice/ (/ Bob/ )/ 没有/ 得到/ 对方/ 的/ 隐私/ 输入/ ;/ Server/ 也/ 没有/ 得到/ Alice/ 和/ Bob/ 的/ 隐私/ 输入/ ;/ 并且/ 即使/ Server/ 和/ 其中/ 一方/ 合谋/ ,/ 也/ 不能/ 得到/ 另一方/ 的/ 隐私/ ./ 将/ Alice/ 在/ 执行/ 协议/ π/ 的/ 过程/ 中/ 得到/ 的/ 视图/ 记为/ view1/ (/ x/ ,/ y/ )/ ;/ Bob/ 的/ 视图/ 记为/ view2/ (/ x/ ,/ y/ )/ ;/ Server/ 的/ 视图/ 记为/ view3/ (/ x/ ,/ y/ )/ ;/ Sever/ 和/ Alice/ 合谋/ 的/ 视图/ 记为/ view4/ (/ x/ ,/ y/ )/ =/ (/ view1/ (/ x/ ,/ y/ )/ ,/ view3/ (/ x/ ,/ y/ )/ )/ ;/ Sever/ 和/ Bob/ 合谋/ 的/ 视图/ 记为/ view5/ (/ x/ ,/ y/ )/ =/ (/ view2/ (/ x/ ,/ y/ )/ ,/ view3/ (/ x/ ,/ y/ )/ )/ ./ E/ (/ x/ )/ ,/ E/ (/ y/ )/ 分别/ 表示/ Alice/ 和/ Bob/ 发送给/ Server/ 的/ 数据/ (/ 即/ Server/ 获得/ 的/ 输入/ )/ ,/ E/ (/ x/ ,/ y/ )/ 表示/ Server/ 的/ 最后/ 计算结果/ (/ 即/ Server/ 获得/ 的/ 输出/ )/ ,/ c/ 表示/ 计算/ 上/ 可/ 区分/ ./ 定义/ 1/ ./ 在/ 云/ 计算环境/ 下/ ,/ 我们/ 说/ 协议/ π/ 保密/ 地/ 计算/ 了/ f/ (/ x/ ,/ y/ )/ ,/ 如果/ 存在/ 概率/ 多项式/ 时间/ 的/ 模拟器/ S1/ 、/ S2/ 、/ S3/ 、/ S4/ 、/ S5/ 使得/ 表/ 1/ 中/ 的/ 5/ 个/ 式子/ 同时/ 成立/ ./ 表/ 1/ 中/ 的/ 5/ 个/ 式子/ 同时/ 成立/ ,/ 说明/ 了/ 参与者/ 视图/ 中/ 的/ 信息/ 视图/ 中/ 不/ 包含/ 额外/ 的/ 信息/ ,/ 这样/ 就/ 保证/ 了/ 在/ 协议/ 执行/ 过程/ 中/ ,/ 无论/ 合谋/ 与否/ ,/ 都/ 得不到/ 其他/ 方/ 的/ 私有/ 信息/ ./ 因此/ ,/ 要/ 证明/ 一个/ 云/ 计算环境/ 下/ 两方/ 计算/ 协议/ 是/ 保密/ 的/ ,/ 就/ 必须/ 构造/ 使得/ 表/ 1/ 中/ 的/ (/ 1/ )/ (/ 2/ )/ (/ 3/ )/ (/ 4/ )/ (/ 5/ )/ 式/ 同时/ 成立/ 的/ 模拟器/ S1/ 、/ S2/ 、/ S3/ 、/ S4/ 、/ S5/ ./ Page4/ 类型/ 表/ 1/ 云/ 计算/ 平台/ 下/ 两方/ 计算/ 的/ 安全性/ 不/ 合谋/ 合谋/ Bob/ 的/ 隐私/ 性/ (/ 相对/ 于/ Server/ 和/ Alice/ 合谋/ )/ S4/ (/ x/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ f1/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview4/ (/ x/ ,/ y/ )/ (/ 4/ )/ 2.2/ 双线性/ 对/ G1/ ,/ G/ 为/ 两个/ 同/ 为/ 素数/ 阶/ q/ 的/ 乘法/ 群/ ,/ e/ 为/ 一个/ 线性/ 映射/ ,/ e/ :/ G1/ ×/ G1/ →/ G/ ,/ g/ 为/ G1/ 的/ 一个/ 生成元/ ,/ 若/ e/ 满足/ 以下/ 性质/ :/ (/ 1/ )/ 双线性/ 性/ ./ 对于/ 任意/ 的/ a/ ,/ b/ ∈/ Z/ ,/ 有/ 等式/ e/ (/ ga/ ,/ gb/ )/ =/ e/ (/ g/ ,/ g/ )/ ab/ ;/ (/ 2/ )/ 非/ 退化/ 性/ ./ e/ (/ g/ ,/ g/ )/ ≠/ 1/ ;/ (/ 3/ )/ 可计算性/ ./ 对于/ 任意/ 的/ P/ ,/ Q/ ∈/ G1/ ,/ e/ (/ P/ ,/ Q/ )/ 可/ 有效/ 计算/ ./ 则/ e/ 为群/ G1/ ,/ G/ 上/ 的/ 双线性/ 对/ ./ 2.3/ Boneh/ 的/ 2/ -/ DNF/ 同态/ 加密算法/ [/ 18/ ]/ 设/ E/ 是/ 一个/ 加密算法/ ,/ C1/ =/ E/ (/ m1/ ,/ r1/ )/ 是/ 对/ m1/ 的/ 加密/ ,/ C2/ =/ E/ (/ m2/ ,/ r2/ )/ 是/ 对/ m2/ 的/ 加密/ ,/ 其中/ r1/ ,/ r2/ 是/ 两个/ 随机数/ ./ 若/ 对于/ 某个/ 随机数/ r/ ,/ 有/ C1C2/ =/ E/ (/ m1m2/ ,/ r/ )/ ,/ 则/ 称/ E/ 是/ 一个/ 乘法/ 同态/ 加密算法/ ;/ 若有/ C1C2/ =/ E/ (/ m1/ +/ m2/ ,/ r/ )/ ,/ 则/ 称/ E/ 是/ 一个/ 加法/ 同态/ 加密算法/ ./ Boneh/ 在/ 文献/ [/ 18/ ]/ 中/ 提出/ 了/ 一种/ 加密/ 方案/ 如下/ (/ 图/ 1/ )/ ./ 系统/ 建立/ :/ 解密/ 者/ 选取/ N/ =/ pq/ ,/ 其中/ p/ ,/ q/ 为/ 两个/ 素数/ ,/ 双线/ 加密/ 过程/ :/ 明文/ m/ </ p/ ,/ 任取/ 随机数/ r/ ∈/ ZN/ ,/ 密文/ c/ =/ gmhr/ ./ 解密/ 过程/ :/ 密文/ c/ </ N/ ,/ 明文/ m/ =/ cq/ ,/ 若/ m/ =/ 1/ ,/ 则/ 明文/ m/ =/ 0/ ;/ 在/ 以下/ 公式/ 中/ ,/ 令/ e/ (/ g/ ,/ g/ )/ =/ g1/ ,/ e/ (/ g/ ,/ h/ )/ =/ h1/ ,/ r1/ +/ r2/ =/ r/ ,/ m2r1/ +/ m1r2/ +/ α/ pr1r2/ =/ r/ ./ 由于/ h/ =/ up/ ,/ 因此/ h/ =/ g/ α/ p/ ,/ α/ 为/ 一个/ 为/ 未知/ 的/ 整数/ ./ 则/ 有/ 下式/ :/ e/ (/ c1/ ,/ c2/ )/ =/ e/ (/ gm1hr1/ ,/ gm2hr2/ )/ 即/ S3/ (/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview3/ (/ x/ ,/ y/ )/ 备注/ 1/ ./ 对于/ 式/ (/ 2/ )/ 中/ 的/ 乘法/ 同态/ ,/ 由于/ gm1m2/ 因此/ Boneh/ 加密/ 方案/ 具有/ 多次/ 加法/ 同态/ 和/ 一次/ 乘法/ 同态/ 性质/ ./ modN/ ∈/ G/ ,/ 但/ / G1/ ,/ 不能/ 再/ 进行/ 双线性/ 对/ 运算/ ,/ 即/ 只能/ 进行/ 一次/ 乘法/ 同态/ 运算/ ./ 3/ 问题/ 的/ 描述/ 和/ 转化/ 3.1/ 本文/ 研究/ 的/ 问题/ 问题/ 1/ ./ 安全/ 计算/ 空间/ 点/ 与/ 空间/ 直线/ 的/ 位置/ 关系/ ./ Alice/ 有/ 一个/ 秘密/ 的/ 空间/ 点/ p0/ (/ x0/ ,/ y0/ ,/ z0/ )/ ,/ Bob/ 有/ 一条/ 秘密/ 的/ 空间/ 直线/ Alice/ 和/ Bob/ 想/ 在/ 不/ 泄露/ 对方/ 信息/ 的/ 条件/ 下/ ,/ 判定/ 点/ p0/ 和/ 直线/ L/ 的/ 位置/ 关系/ (/ 属于/ 或/ 不/ 属于/ )/ ./ 问题/ 2/ ./ 安全/ 计算/ 空间/ 点/ 与/ 空间/ 平面/ 的/ 位置/ 关系/ ./ Alice/ 有/ 一个/ 秘密/ 的/ 空间/ 点/ p0/ (/ x0/ ,/ y0/ ,/ z0/ )/ ,/ Bob/ 有/ 一个/ 秘密/ 的/ 空间/ 平面/ Π/ :/ Ax/ +/ By/ +/ Cz/ +/ D/ =/ 0/ ./ Alice/ 和/ Bob/ 想/ 在/ 不/ 泄露/ 对方/ 信息/ 的/ 条件/ 下/ ,/ 判定/ 点/ p0/ 和/ 平面/ Π/ 的/ 位置/ 关系/ (/ 属于/ 或/ 不/ 属于/ )/ ./ Alice/ 有/ 一条/ 秘密/ 的/ 空间/ 直线/ 问题/ 3/ ./ 安全/ 计算/ 空间/ 两/ 直线/ 的/ 位置/ 关系/ ./ Bob/ 有/ 一条/ 秘密/ 的/ 空间/ 直线/ Alice/ 和/ Bob/ 想/ 在/ 不/ 泄露/ 对方/ 信息/ 的/ 条件/ 下/ ,/ 判定/ 直线/ L1/ 与/ 直线/ L2/ 的/ 位置/ 关系/ (/ 垂直/ 、/ 平行/ 、/ 重合/ 或/ 相交/ )/ ./ 问题/ 4/ ./ 安全/ 计算/ 空间/ 直线/ 与/ 空间/ 平面/ 的/ 位置/ 关系/ ./ Alice/ 有/ 一条/ 秘密/ 的/ 空间/ 直线/ Bob/ 有/ 一个/ 秘密/ 的/ 空间/ 平面/ Π/ :/ A3x/ +/ B3y/ +/ C3z/ +/ Page5D3/ =/ 0/ ./ Alice/ 和/ Bob/ 想/ 在/ 不/ 泄露/ 对方/ 信息/ 的/ 条件/ 下/ ,/ 判定/ 直线/ L/ 与/ 平面/ Π/ 的/ 位置/ 关系/ (/ 垂直/ 、/ 平行/ 、/ 重合/ 或/ 相交/ )/ ./ 问题/ 5/ ./ 安全/ 计算/ 空间/ 平面/ 与/ 空间/ 平面/ 的/ 位置/ 关系/ ./ Alice/ 有/ 一个/ 秘密/ 的/ 空间/ 平面/ Π/ 1/ :/ A1x/ +/ B1y/ +/ C1z/ +/ D1/ =/ 0/ ,/ Bob/ 有/ 一个/ 秘密/ 的/ 空间/ 平面/ Π/ 2/ :/ A2x/ +/ B2y/ +/ C2z/ +/ D2/ =/ 0/ ./ Alice/ 和/ Bob/ 想/ 在/ 不/ 泄露/ 对方/ 信息/ 的/ 条件/ 下/ ,/ 判定/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 的/ 位置/ 关系/ (/ 垂直/ 、/ 平行/ 、/ 重合/ 或/ 相交/ )/ ./ 3.2/ 问题/ 的/ 转化/ 本文/ 中点/ 与/ 线/ 、/ 点/ 与/ 面/ 的/ 位置/ 关系/ 可以/ 转化/ 为/ 一个点/ 是否/ 为/ 一个/ 方程/ 的/ 解/ ;/ 而线/ 与/ 线/ 、/ 线/ 与/ 面/ 、/ 面与面/ 的/ 位置/ 关系/ 可以/ 转化/ 为/ 方向/ 向量/ 和/ 法/ 向量/ 的/ 夹角/ ,/ 最后/ 利用/ 保密/ 内积/ 协议/ 解决/ ./ 例如/ ,/ 要/ 解决/ 本文/ 的/ 问题/ 4/ :/ 判断/ 一条/ 直线/ L/ 和/ 一个/ 平面/ Π/ 的/ 位置/ 关系/ (/ 图/ 2/ )/ ./ 等价/ 于/ 已知/ 直线/ L/ 的/ 方向/ 向量/ 犲/ ,/ 平面/ Π/ 的/ 法/ 向量/ 犱/ ,/ 那么/ 两者之间/ 的/ 夹角/ 为/ cos/ θ/ =/ 〈/ 犲/ ,/ 犱/ 〉/ 3/ 种/ :/ (/ 1/ )/ 若/ cos/ θ/ =/ 0/ ,/ 则/ 直线/ 和/ 平面/ 平行/ 或/ 重合/ ;/ (/ 2/ )/ 若/ cos/ θ/ =/ ±/ 1/ ,/ 则/ 直线/ 和/ 平面/ 垂直/ ;/ (/ 3/ )/ 其他/ 则/ 为/ 相交/ ./ 因此/ 要/ 判断/ 直线/ 和/ 平面/ 的/ 位置/ 关系/ ,/ 只/ 需/ 保密/ 判断/ cos/ θ/ 是否/ 为/ 0/ 、/ ±/ 1/ 或/ 其他/ 即可/ ,/ 而/ 要求/ 夹角/ ,/ 可/ 借助/ 内积/ 协议/ 求/ 出/ 〈/ 犲/ ,/ 犱/ 〉/ ./ 3.3/ 云/ 计算/ 外包/ 下/ 的/ 内积/ 协议/ 根据/ 3.2/ 节/ 的/ 转化/ 方法/ ,/ 原/ 问题/ 转化/ 为/ 夹角/ 问题/ 后/ ,/ 需要/ 借助/ 内积/ 协议/ ./ 但/ 目前/ 大多/ 内积/ 协议/ 多/ 是/ 基于/ 同态/ 加密/ 的/ 方法/ [/ 19/ -/ 20/ ]/ ,/ 不可避免/ 的/ 要/ 计算/ 多个/ 模幂/ 运算/ ,/ 若/ 处理/ 的/ 内积/ 问题/ 很大/ 的话/ ,/ 会/ 给/ 用户/ 带来/ 较大/ 的/ 计算/ 开销/ ./ 借助/ 云/ 计算/ 的/ 能力/ ,/ 将/ 内积/ 协议/ 中/ 大多数/ 的/ 计算/ 任务/ 外包/ 给/ 云/ ,/ 用户/ 只要/ 付出/ 少量/ 费用/ ,/ 就/ 可以/ 让/ 云/ 完成/ 用户/ 所/ 需/ 的/ 计算/ ./ 但/ 传统模式/ 下/ 的/ 内积/ 计算/ 并/ 不/ 存在/ 第三方/ ,/ 都/ 是/ 由/ 参与方/ 相互/ 交互/ 完成/ ./ 而云/ 计算/ 平台/ 下/ 的/ 内积/ 计算/ 需要/ 不可/ 信/ 第三方/ (/ 云/ 服务器/ )/ 参与/ 计算/ 过程/ ./ 这种/ 情况/ 下/ ,/ 不可/ 信/ 第三方/ (/ 云/ 服务器/ )/ 可能/ 会/ 将/ 用户/ 的/ 数据/ 信息/ 泄露/ ./ 因此/ 用户/ 需要/ 在/ 对/ 云/ 服务器/ 保持/ 输入/ 和/ 输出/ 隐私/ 的/ 情况/ 下/ 完成/ 所/ 需要/ 的/ 计算/ 任务/ ./ 综上/ 分析/ ,/ 由于/ 云/ 计算/ 平台/ 下/ 的/ 内积/ 计算/ 并/ 不同于/ 传统模式/ 下/ 的/ 内积/ 计算/ ,/ 此时/ 传统/ 的/ 内积/ 协议/ [/ 19/ -/ 20/ ]/ 都/ 已经/ 失效/ ./ 因此/ 基于/ Boneh/ 的/ 2/ -/ DNF/ 同态/ 加密算法/ [/ 18/ ]/ ,/ 本文/ 重新/ 设计/ 了/ 一种/ 适用/ 于云外/ 包/ 计算/ 下/ 保密/ 计算/ 内积/ 的/ 协议/ ./ 在/ 本文/ 场景/ 中/ ,/ 假设/ 所有/ 的/ 参与方/ 和/ 云/ 服务器/ 都/ 是/ 半/ 诚实/ 模型/ ,/ 网络/ 之间/ 传输/ 都/ 是/ 公开信/ 道/ ./ 3.3/ ./ 1/ 具体/ 内积/ 协议/ 协议/ 1/ ./ 云/ 计算/ 外包/ 下/ 的/ 内积/ 协议/ ./ 输入/ :/ Alice/ 保密/ 输入/ 犡/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ ,/ Bob/ 保密/ 输/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 〈/ 犡/ ,/ 犢/ 〉/ 的/ 值/ ,/ 但云/ 服务器/ 不/ 1/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ 的/ 参数/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ./ 计算/ a1/ =/ E/ (/ x1/ )/ ,/ a2/ =/ E/ (/ x2/ )/ ,/ …/ ,/ an/ =/ E/ (/ xn/ )/ ,/ 发送给/ 云/ 服务器/ ./ 2/ ./ Bob/ 选择/ 随机数/ r/ (/ r/ ≠/ 0/ ,/ 1/ )/ ,/ 用/ 同样/ 的/ Boneh/ 加密算法/ 计算/ b1/ =/ E/ (/ y1/ +/ r/ )/ ,/ b2/ =/ E/ (/ y2/ +/ r/ )/ ,/ …/ ,/ bn/ =/ E/ (/ yn/ +/ r/ )/ ,/ 并/ 发送给/ 云/ 服务器/ ./ 3/ ./ 云/ 服务器/ 收到/ Alice/ 和/ Bob/ 发来/ 的/ 密文/ 后/ ,/ 利用/ Boneh/ 加密算法/ 的/ 同态/ 性/ 计算/ 2/ -/ DNF/ 的/ 多项式/ ,/ 计算/ 以下/ 两/ 式/ :/ c/ =/ e/ (/ a1/ ,/ b1/ )/ …/ e/ (/ an/ ,/ bn/ )/ c1/ =/ E/ (/ x1/ )/ …/ E/ (/ xn/ )/ 云/ 服务器/ 将/ c/ ,/ c1/ 发送给/ Bob/ ./ 4/ ./ Bob/ 收到/ 密文/ c/ ,/ c1/ 后/ ,/ 利用/ Boneh/ 加密算法/ 的/ 加法/ 同态/ 性/ 计算/ 下/ 式/ :/ 并/ 计算/ c3/ =/ c5/ ./ Alice/ 解密/ c3/ ,/ 得到/ 内积/ 〈/ 犡/ ,/ 犢/ 〉/ ,/ 并/ 将/ 结果/ 告诉/ Bob/ ./ 分析/ :/ 在/ 协议/ 1/ 中/ ,/ 从/ 直觉/ 上/ 可以/ 看出/ ,/ Alice/ 利用/ 加密算法/ 保护/ 了/ 持有/ 的/ 向量/ 犡/ 的/ 隐私/ 性/ ./ Bob/ 利用/ 同样/ 的/ 加密算法/ 保护/ 了/ 持有/ 的/ 向量/ 犢/ 的/ 隐私/ 性/ ./ 但/ 由于/ 云/ 服务器/ 可以/ 和/ 任何一方/ 合谋/ ,/ 而/ Alice/ 具有/ 解密/ 密钥/ ,/ 若云/ 服务器/ 收到/ Bob/ 发来/ 的/ 密文/ 后/ 和/ Alice/ 合谋/ 解密/ ,/ 这样/ Bob/ 的/ 隐私/ 性/ 就/ 得到/ 了/ 破坏/ ./ 为了/ 抵抗/ 合谋/ ,/ 在/ Bob/ 的/ 明文/ 中/ 加入/ 随机数/ r/ ,/ 使得/ 云/ 服务器/ 收到/ 的/ 密文/ 即使/ 交给/ Alice/ 解密/ ,/ 也/ 有/ n/ +/ 1/ 个/ 未知数/ ,/ 却/ 只有/ n/ 个/ 方程/ ,/ 仍然/ 无法/ 获得/ Bob/ 的/ 信息/ ,/ 因此/ 保护/ 了/ Bob/ 的/ 隐私/ ./ 下面/ 给出/ 模/ Page6/ 拟/ 范例/ 的/ 形式化/ 安全性/ 证明/ ./ 3.3/ ./ 2/ 安全性/ 证明/ 犢/ 的/ 内积/ 〈/ 犡/ ,/ 犢/ 〉/ ./ 定理/ 1/ ./ 协议/ 1/ 保密/ 地/ 计算/ 了/ 向量/ 犡/ 和/ 向量/ 证明/ ./ 根据/ 2.1/ 节中/ 的/ 表/ 1/ ,/ 需要/ 构造/ 5/ 个/ 模拟器/ S1/ ,/ S2/ ,/ S3/ ,/ S4/ ,/ S5/ ./ 由于/ 模拟器/ S1/ ,/ S2/ 的/ 构造方法/ 类似/ ;/ S4/ ,/ S5/ 的/ 构造/ 情况/ 类似/ ./ 为了/ 节省/ 篇幅/ ,/ 只/ 给出/ 模拟器/ S1/ ,/ S3/ ,/ S4/ 的/ 构造方法/ ,/ 其余/ 的/ 构造/ 过程/ 省略/ ./ 因此/ 分为/ 以下/ 3/ 种/ 情况/ 进行/ 证明/ ./ (/ 1/ )/ 构造/ 模拟器/ S1/ 在/ 本/ 协议/ 中/ 或者/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f2/ (/ 犡/ ,/ 犢/ )/ ≠/ 〈/ 犡/ ,/ 犢/ 〉/ ./ 假设/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f2/ (/ 犡/ ,/ 犢/ )/ =/ 〈/ 犡/ ,/ 犢/ 〉/ ,/ 构造/ 模拟器/ S1/ ./ S1/ 接受/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ 作为/ 输入/ ,/ 按/ 如下/ 方式/ 工作/ :/ 第/ 1/ 步/ ./ S1/ 接受/ 输入/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ 后/ ,/ 先/ 随机/ 选取/ 一个/ 向量/ 犢/ =/ (/ y1/ ,/ y2/ ,/ …/ ,/ ym/ )/ ,/ 使得/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f1/ (/ 犡/ ,/ 犢/ )/ ./ 然后/ 用/ (/ 犡/ ,/ 犢/ )/ 进行/ 模拟/ ./ 按照/ 协议/ 1/ ,/ 将/ 向量/ 犡/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ 加密/ ,/ 得到/ 下/ 式/ ,/ 记作/ A/ ./ {/ a1/ =/ E/ (/ x1/ )/ ,/ a2/ =/ E/ (/ x2/ )/ ,/ …/ ,/ an/ =/ E/ (/ xn/ )/ }/ ./ 第/ 2/ 步/ ./ S1/ 选取/ 较大/ 随机数/ r/ (/ r/ ≠/ 0/ ,/ 1/ )/ ,/ 加密/ 向量/ 犢/ ,/ 得到/ 下/ 式/ ,/ 记作/ B/ ./ 第/ 3/ 步/ ./ S1/ 得到/ A/ 和/ B/ 后/ ,/ 计算/ 第/ 4/ 步/ ./ S1/ 得到/ 犮/ 后/ ,/ 计算/ E/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ ,/ 并/ 利用/ Boneh/ 加密算法/ 的/ 同态/ 性/ 计算/ :/ 然后/ 计算/ 犮/ 第/ 5/ 步/ ./ S1/ 解密/ c2/ 得到/ 内积/ C/ ./ 于是/ 得到/ view1/ (/ 犡/ ,/ 犢/ )/ =/ {/ 犡/ ,/ A/ ,/ E/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ ,/ c2/ ,/ C/ }/ ,/ S1/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ =/ {/ 犡/ ,/ A/ ,/ E/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ ,/ c2/ ,/ C/ }/ ./ 由于/ C/ =/ f1/ (/ 犡/ ,/ 犢/ )/ =/ 〈/ 犡/ ,/ 犢/ 〉/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f1/ (/ 犡/ ,/ 犢/ )/ ,/ 而/ C/ =/ f1/ (/ 犡/ ,/ 犢/ )/ =/ 〈/ 犡/ ,/ 犢/ 〉/ ,/ 因此/ ,/ C/ =/ C/ ./ c1/ =/ E/ (/ 〈/ 犡/ ,/ 犢/ 〉/ +/ r/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ )/ c2/ =/ 犮/ c1/ =/ E/ (/ 〈/ 犡/ ,/ 犢/ 〉/ +/ r/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ )/ 而/ c2/ =/ c/ 由于/ 〈/ 犡/ ,/ 犢/ 〉/ =/ 〈/ 犡/ ,/ 犢/ 〉/ ,/ rcr/ ,/ 因此/ ,/ c2cc2/ ./ 所以/ :/ 同理/ ,/ 用/ 类似/ 的/ 方法/ 可/ 构造/ 模拟器/ S2/ 使得/ (/ 2/ )/ 构造/ 模拟器/ S3/ 在/ 本/ 协议/ 中/ Server/ 的/ 输入/ 为/ Alice/ 和/ Bob/ 发送/ 的/ 数据/ :/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ ;/ Server/ 的/ 输出/ 为/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ 的/ 计算结果/ :/ E/ (/ 犡/ ,/ 犢/ )/ ./ S3/ 接受/ (/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ ,/ E/ (/ 犡/ ,/ 犢/ )/ )/ 作为/ 输入/ ,/ 按/ 如下/ 方式/ 工作/ :/ 第/ 1/ 步/ ./ S3/ 接受/ 输入/ (/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ ,/ E/ (/ 犡/ ,/ 犢/ )/ )/ 后/ ,/ 首先/ 随机/ 选取/ 两个/ 向量/ 犡/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xm/ )/ ,/ 犢/ =/ (/ y1/ ,/ y2/ ,/ …/ ,/ ym/ )/ ,/ 使得/ E/ (/ 犡/ ,/ 犢/ )/ =/ E/ (/ 犡/ ,/ 犢/ )/ ./ 然后/ 用/ (/ 犡/ ,/ 犢/ )/ 进行/ 模拟/ ./ 按照/ 协议/ 1/ ,/ 将/ 向量/ 犡/ =/ (/ x1/ ,/ x2/ ,/ …/ ,/ xm/ )/ 加密/ ,/ 得到/ 下/ 式/ ,/ 记作/ A/ ./ {/ a1/ =/ E/ (/ x1/ )/ ,/ a2/ =/ E/ (/ x2/ )/ ,/ …/ ,/ an/ =/ E/ (/ xn/ )/ }/ ./ 第/ 2/ 步/ ./ S3/ 选取/ 较大/ 随机数/ r/ (/ r/ ≠/ 0/ ,/ 1/ )/ ,/ 加密/ 向量/ 犢/ ,/ 得到/ 下/ 式/ ,/ 记作/ B/ ./ 第/ 3/ 步/ ./ S3/ 得到/ A/ 和/ B/ 后/ ,/ 利用/ Boneh/ 加密/ 方案/ 的/ 同态/ 性/ 计算/ 犮/ =/ 犲/ (/ a1/ ,/ b1/ )/ 犲/ (/ a2/ ,/ b2/ )/ …/ 犲/ (/ an/ ,/ bn/ )/ 第/ 4/ 步/ ./ S3/ 得到/ 犮/ 后/ ,/ 计算/ E/ (/ x1/ +/ x2/ +/ …/ +/ xn/ )/ ,/ 并/ 利用/ Boneh/ 加密/ 方案/ 的/ 加法/ 同态/ 性/ 计算/ 然后/ 计算/ 犮/ 第/ 5/ 步/ ./ S3/ 解密/ c2/ 得到/ 内积/ 〈/ 犡/ ,/ 犢/ 〉/ ./ 于是/ 得到/ view3/ (/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ )/ =/ {/ A/ ,/ B/ ,/ c/ }/ ,/ S3/ (/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ ,/ E/ (/ 犡/ ,/ 犢/ )/ )/ =/ {/ A/ ,/ B/ ,/ 犮/ }/ ./ 由于/ c/ =/ E/ (/ 犡/ ,/ 犢/ )/ ,/ 而/ E/ (/ 犡/ ,/ 犢/ )/ =/ E/ (/ 犡/ ,/ 犢/ )/ ,/ 犮/ =/ E/ (/ 犡/ ,/ 犢/ )/ ,/ 因此/ ,/ 犮/ =/ 犮/ ./ 由于/ A/ =/ E/ (/ 犡/ )/ ,/ B/ =/ E/ (/ 犢/ )/ ,/ 而/ A/ =/ E/ (/ 犡/ )/ ,/ B/ =/ E/ (/ 犢/ )/ ./ 因此/ ,/ AcA/ ./ BcB/ ./ 所以/ :/ S3/ (/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview3/ (/ x/ ,/ y/ )/ ./ 此/ 过程/ 证明/ 了/ 云/ 服务器/ Server/ 的/ 视图/ view3/ (/ x/ ,/ y/ )/ 只能/ 从/ 自己/ 的/ 输入/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ 和/ 输出/ 的/ 计算结果/ E/ (/ x/ ,/ y/ )/ 中/ 得到/ ./ E/ (/ x/ )/ ,/ E/ (/ y/ )/ 分别/ 为/ Alice/ 和/ Bob/ 加密/ 的/ 数据/ ,/ Server/ 无法/ 解密/ ,/ 因此/ 得不到/ x/ ,/ y/ 的/ 隐私/ ,/ 而/ Server/ 所/ 得到/ 的/ 输出/ 计算结果/ E/ (/ x/ ,/ y/ )/ ,/ 为/ 关于/ x/ ,/ y/ 的/ 加密/ 密文/ ,/ Server/ 仍然/ 无法/ 解密/ ./ 因此/ ,/ Server/ 的/ 视图/ view3/ (/ x/ ,/ y/ )/ 中/ 不/ 包含/ Alice/ 和/ BobPage7/ 的/ 任何/ 信息/ ,/ 即/ 整个/ 云/ 计算/ 过程/ 都/ 得不到/ Alice/ 和/ Bob/ 的/ 隐私/ ./ (/ 3/ )/ 构造/ 模拟器/ S4/ 在/ 本/ 协议/ 中/ ,/ Server/ 和/ Alice/ 合谋/ ,/ 此时/ 两者/ 获得/ 的/ 输入/ 为/ 犡/ ,/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ ,/ 获得/ 的/ 输出/ 为/ f1/ (/ 犡/ ,/ 犢/ )/ ,/ E/ (/ 犡/ ,/ 犢/ )/ ./ 模拟器/ S3/ 接受/ 犡/ ,/ E/ (/ 犡/ )/ ,/ E/ (/ 犢/ )/ 和/ f1/ (/ 犡/ ,/ 犢/ )/ ,/ E/ (/ 犡/ ,/ 犢/ )/ 作为/ 输入/ ,/ 综合/ (/ 1/ )/ 、/ (/ 2/ )/ 情况/ ,/ 用/ 类似/ 的/ 方法/ 进行/ 工作/ (/ 此处/ 省略/ 具体/ 构造/ 过程/ )/ ,/ 得到/ S4/ (/ x/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ f1/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview4/ (/ x/ ,/ y/ )/ ./ 同理/ ,/ 用/ 类似/ 的/ 方法/ 可/ 构造/ 模拟器/ S5/ 使得/ S5/ (/ y/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ f2/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview5/ (/ x/ ,/ y/ )/ ./ 此/ 过程/ 证明/ 了/ 即使/ 云/ 服务器/ Server/ 和/ Alice/ 合谋/ ,/ 但是/ 合谋/ 者/ 子集/ 的/ 视图/ view4/ (/ x/ ,/ y/ )/ ,/ 只能/ 从/ Server/ 和/ Alice/ 的/ 自身/ 的/ 输入/ x/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ 和/ 自身/ 所/ 获得/ 的/ 输出/ f1/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ 中/ 得到/ ,/ 并/ 不/ 包含/ Bob/ 的/ 任何/ 信息/ ;/ 对于/ view5/ (/ x/ ,/ y/ )/ 也/ 是/ 同样/ 的/ 道理/ ./ 因此/ 整个/ 过程/ ,/ 即使/ 云/ 服务器/ 和/ 一方/ 合谋/ ,/ 也/ 都/ 不得/ 另一方/ 的/ 隐私/ ./ 3.3/ ./ 3/ 效率/ 分析/ 比较/ 本文/ 设计/ 的/ 云外/ 包/ 计算/ 下/ 的/ 内积/ 协议/ (/ 协议/ 1/ )/ ,/ 将/ 同态/ 运算/ 过程/ (/ Evaluation/ )/ 的/ 计算/ 任务/ 交付给/ 了/ 云/ 服务器/ ,/ 而/ 两个/ 用户/ 只/ 进行/ 了/ 最/ 起初/ 的/ 加密/ 和/ 唯一/ 的/ 一个/ 模幂/ 运算/ 、/ 模乘/ 运算/ 和/ 最后/ 解密/ ,/ 大大减少/ 了/ 传统模式/ 下/ 内积/ 运算/ 中/ 需要/ 用户/ 自身/ 操作/ 的/ 同态/ 运算/ (/ Evaluation/ )/ ,/ 因此/ 可以/ 为/ 用户/ 节省/ 计算成本/ ./ 为了/ 显示/ 我们/ 设计/ 的/ 云/ 平台/ 下/ 内积/ 协议/ 确实/ 比/ 传统模式/ 下/ 内积/ 协议/ 为/ 用户/ 节省/ 了/ 计算成本/ ,/ 将/ 本文/ 内积/ 协议/ (/ 协议/ 1/ )/ 和/ 传统模式/ 下/ 的/ 内积/ 协议/ (/ 文献/ [/ 19/ -/ 20/ ]/ )/ 的/ 计算/ 复杂性/ 做出/ 对比/ 分析/ ./ 由于/ 文献/ [/ 19/ -/ 20/ ]/ 利用/ 的/ 都/ 是/ 同态/ 加密/ 思路/ ,/ 不过/ 利用/ 的/ 同态/ 加密算法/ 不同/ 而已/ ./ 文献/ [/ 19/ ]/ 利用/ Damgrd/ 等/ 人/ [/ 21/ ]/ 的/ 同态/ 算法/ ,/ 文献/ [/ 20/ ]/ 利用/ Paillier/ [/ 22/ ]/ 的/ 同态/ 加密算法/ ./ 文献/ [/ 19/ ]/ 只是/ 把/ 文献/ [/ 20/ ]/ 的/ 数域/ 范围/ 推广/ 到/ 负数/ 范围/ 内/ ,/ 但/ 两者/ 设计/ 的/ 方案/ 几乎/ 完全一致/ ./ 因此/ 这里/ 只/ 给出/ 本文/ 的/ 内积/ 协议/ (/ 协议/ 1/ )/ 和/ 文献/ [/ 20/ ]/ 的/ 内积/ 协议/ 比较/ ./ 为了/ 便于/ 两个/ 协议/ 比较/ ,/ 假设/ 两个/ 用户/ 各自/ 执有/ 的/ 向量/ 都/ 为/ n/ 维/ ./ 将/ 文献/ [/ 20/ ]/ 利用/ 的/ Paillier/ [/ 22/ ]/ 的/ 模乘/ 运算/ 记为/ MN1/ ,/ 模幂/ 运算/ 记为/ M/ 犲/ 1/ ;/ 本文/ 协议/ 1/ 利用/ 的/ Boneh/ [/ 18/ ]/ 的/ 模乘/ 运算/ 记为/ MN2/ ,/ 模幂/ 运算/ 记为/ M/ 犲/ 2/ ./ 每个/ 内积/ 协议/ 都/ 经历/ 3/ 个/ 阶段/ ,/ 加密/ 阶段/ (/ Encryption/ )/ ,/ 同态/ 运算/ 阶段/ (/ Evaluation/ )/ 和/ 解密/ 阶段/ (/ Decryption/ )/ ./ 因此/ 将/ 这/ 3/ 个/ 阶段/ 的/ 用户/ 操作/ 运算/ 次数/ 作为/ 衡量/ 用户/ 计算/ 复杂性/ 的/ 标准/ ,/ 得到/ 表/ 2/ ./ 表/ 2/ 本文/ 内积/ 协议/ 与/ 现有/ 内积/ 协议/ 用户/ 的/ 计算成本/ 比较/ 方案/ 文献/ [/ 20/ ]/ nM/ 犲/ 1nM/ 犲/ 11MN11M/ 犲/ 1/ 我们/ 的/ 协议/ 12nM/ 犲/ 21M/ 犲/ 21MN21M/ 犲/ 2/ 从表/ 2/ 可以/ 看出/ ,/ 在/ 同态/ 运算/ 阶段/ ,/ 由于/ 文献/ [/ 20/ ]/ 的/ 内积/ 协议/ 是/ 在/ 传统模式/ 下/ 进行/ ,/ 这个/ 阶段/ 耗时/ 最多/ 的/ 模幂/ 运算/ 都/ 是/ 依靠/ 用户/ 自身/ 完成/ ,/ 因此/ 用户/ 需要/ 操作/ n/ 次/ ;/ 而/ 我们/ 的/ 协议/ 1/ 由于/ 在/ 平/ 计算/ 平台/ 下/ 进行/ ,/ 所/ 需要/ 的/ 模幂/ 运算/ 都/ 由/ 第三方/ (/ 云/ 服务器/ )/ 完成/ ,/ 用户/ 只/ 需要/ 操作/ 1/ 次/ 即可/ ,/ 而模/ 乘/ 运算/ 次数/ 两者/ 都/ 是/ 相同/ 的/ ,/ 即/ 这个/ 阶段/ 我们/ 为/ 用户/ 减少/ 了/ n/ -/ 1/ 次模/ 幂/ 运算/ ./ 此外/ ,/ 虽然/ 从表/ 2/ 看到/ 我们/ 协议/ 1/ 在/ 加密/ 阶段/ 比/ 文献/ [/ 20/ ]/ 增加/ 了/ n/ 个模/ 幂/ 运算/ ,/ 但/ 我们/ 模幂/ 运算/ 的/ 模数/ N2/ =/ pq/ ,/ 底数/ 为/ g/ ;/ 而/ 文献/ [/ 20/ ]/ 模幂/ 运算/ 的/ 模数/ N1/ =/ (/ N2/ )/ 2/ =/ p2q2/ ,/ 底数/ 为/ gm/ ,/ 由于/ N1/ / N2/ ,/ gm/ >/ g/ ./ 即/ 我们/ 加密/ 阶段/ 增加/ 的/ n/ 个模/ 幂/ 运算/ 都/ 是/ 低/ 模数/ 低/ 指数/ 运算/ ,/ 而/ 文献/ [/ 20/ ]/ 在/ 同态/ 运算/ 阶段/ 增加/ 的/ n/ -/ 1/ 个模/ 幂/ 运算/ 却是/ 高/ 模数/ 高/ 指数/ 运算/ ,/ 其余/ 阶段/ 两者/ 都/ 是/ 相同/ 的/ ./ 因此/ 从总体上/ 说/ ,/ 利用/ 云外/ 包/ 技术/ ,/ 我们/ 的/ 内积/ 协议/ 可以/ 极大/ 的/ 减少/ 高/ 数量级/ 的/ 模幂/ 运算/ 次数/ ,/ 为/ 用户/ 节省/ 计算成本/ ./ 此外/ ,/ 我们/ 这篇/ 论文/ 旨在/ 为/ 安全/ 多方/ 计算/ 几何/ 问题/ 提供/ 新/ 的/ 研究/ 方向/ ,/ 意将/ 安全/ 多方/ 几何/ 计算/ 架构/ 在/ 云/ 平台/ 下/ ./ 文献/ [/ 20/ ]/ 是/ 利用/ Paillier/ [/ 22/ ]/ 的/ 加法/ 同态/ 性质/ 设计/ 的/ 内积/ 协议/ ,/ 而/ Paillier/ 加密/ 方案/ 并/ 不/ 具有/ 类/ 同态/ 的/ 性质/ ,/ 因此/ 并/ 不能/ 直接/ 改造/ 成为/ 云/ 计算/ 平台/ 下/ 的/ 内积/ 协议/ ./ 3.3/ ./ 4/ 实验/ 仿真/ 为了/ 进一步/ 证实/ 3.3/ ./ 3/ 节/ 的/ 理论/ 分析/ 结果/ ,/ 我们/ 又/ 给出/ 了/ 以下/ 的/ 仿真/ 实验/ ,/ 从/ 耗时/ 上/ 给/ 读者/ 一个/ 更/ 直观/ 的/ 观察/ ./ 我们/ 的/ 实验/ 平台/ 为/ PC机/ 3.0/ GHzPentium/ (/ IV/ )/ system/ ,/ 用/ VC6/ ./ 0/ 版本/ 进行/ 编译/ ,/ 用/ 标准/ 的/ // O2/ 编译器/ 优化/ ①/ ./ 分别/ 取/ 不同/ 的/ 模数/ N/ 为/ 512bits/ 、/ 1024bits/ 、/ 2048bits/ 进行/ 实验/ ,/ 得到/ 了/ 不同/ 模数/ 和/ 不同/ 指数/ 尺寸/ 下/ 运行/ 一个/ 模幂/ 运算/ 所/ 需要/ 的/ 时间/ (/ 单位/ 为/ ms/ )/ ,/ 如表/ 3/ 所示/ ./ ①/ ScottM/ ./ Multi/ -/ precisionintegerandrationalarithmeticPage8/ 模数/ N/ 的/ 尺寸/ // bits/ 指数/ 的/ 尺寸/ // bits3/ ./ 0GHzPentium/ (/ IV/ )/ // ms512102420242048/ 从表/ 3/ 可以/ 看出/ ,/ 若/ 固定/ 模幂/ 运算/ 的/ 指数/ 大小/ 不变/ ,/ 随着/ 模数/ 的/ 增大/ ,/ 模幂/ 运算/ 需要/ 的/ 时间/ (/ 单位/ 为/ ms/ )/ 也/ 在/ 增大/ ,/ 增长/ 倍数/ 约/ 为/ 3.5/ ./ 在/ 3.3/ ./ 3/ 节中/ ,/ 将/ 协议/ 1/ 在/ 加密/ 阶段/ 增加/ 的/ n/ 个模/ 幂/ 运算/ 所/ 需要/ 的/ 时间/ 记为/ T2/ =/ nM/ 犲/ 2/ ,/ 模幂/ 运算/ M/ 犲/ 2/ 的/ 模数/ 为/ N2/ ;/ 将/ 文献/ [/ 20/ ]/ 在/ 同态/ 运算/ 阶段/ 增加/ 的/ n/ -/ 1/ 个模/ 幂/ 运算/ 所/ 需要/ 的/ 时间/ 记为/ T1/ =/ (/ n/ -/ 1/ )/ M/ 犲/ 1/ ,/ 模幂/ 运算/ M/ 犲/ 1/ 的/ 模数/ 为/ N1/ =/ (/ N2/ )/ 2/ =/ p2q2/ ./ 假设/ 两个/ 模幂/ 运算/ M/ 犲/ 1/ ,/ M/ 犲/ 2/ 的/ 指数/ 大小/ 相同/ (/ 实际上/ M/ 犲/ 2/ 要/ 比/ M/ 犲/ 1/ 的/ 指数/ 尺寸/ 小/ )/ ,/ 得到/ 两个/ 阶段/ 的/ 耗时/ 差/ :/ Δ/ T/ =/ T1/ -/ T2/ ≈/ (/ n/ -/ 1/ )/ N223/ ./ 5M/ 犲/ 2/ -/ nM/ 犲/ 2/ ./ 即/ 我们/ 的/ 协议/ 1/ 比/ 文献/ [/ 20/ ]/ 在/ 耗时/ 上/ 为/ 用户/ 至少/ 节省/ 了/ Δ/ Tms/ ./ 若/ 统一/ 取/ 两种/ 模幂/ 运算/ 中/ 的/ 指数/ 大小/ 为/ 160bits/ ,/ 向量/ 维数/ n/ =/ 100/ ,/ 模数/ 大小/ 分别/ 取为/ N/ =/ N2/ =/ 512bits/ 或/ 1024bits/ 或/ 2048bits/ ./ 得到/ 不同/ 的/ 模数/ 下/ ,/ 文献/ [/ 20/ ]/ 中/ 的/ T1/ 和/ 本文/ 协议/ 1/ 中/ 的/ T2/ 的/ 耗时/ 及/ 对应/ 的/ 耗时/ 差/ Δ/ T/ (/ 时间/ 都/ 以/ ms/ 记/ )/ ,/ 如图/ 3/ 所示/ ./ 图/ 3/ 不同/ 模数/ 下/ T1/ 和/ T2/ 的/ 耗时/ 和/ 对应/ 的/ 耗时/ 差/ Δ/ T/ 从图/ 3/ 可以/ 看出/ ,/ 即使/ 两个/ 内积/ 协议/ 的/ 指数/ 大小/ 相同/ ,/ 但/ 由于/ 两个/ 内积/ 的/ 模数/ 不同/ ,/ 而/ 我们/ 的/ 协议/ 1/ (/ 黑色/ 柱状/ )/ 利用/ 了/ 云/ 计算/ 平台/ ,/ 确实/ 比/ 文献/ [/ 20/ ]/ (/ 白色/ 柱状/ )/ 为/ 用户/ 节省/ 了/ 计算/ 时间/ ,/ 并且/ 随着/ 模数/ 的/ 增大/ ,/ 节省/ 的/ 时间/ Δ/ T/ (/ 灰色/ 柱状/ )/ 更加/ 明显/ ./ 由于/ 模数/ 和/ 处理/ 的/ 明文/ 范围/ 有关/ ,/ 因此/ 我们/ 设计/ 的/ 云/ 计算/ 平台/ 下/ 的/ 内积/ 协议/ 为/ 处理/ 大/ 数据/ 的/ 问题/ 提供/ 了/ 有力/ 的/ 工具/ ./ 4/ 具体/ 协议/ 在/ 第/ 3/ 节/ 的/ 基础/ 上/ ,/ 本/ 节/ 给出/ 云外/ 包/ 计算/ 中/ 5/ 种/ 空间/ 位置/ 关系/ 的/ 保密/ 判定/ 协议/ ./ 以下/ 协议/ 假设/ 所有/ 的/ 参与者/ 和/ 云/ 服务器/ 都/ 是/ 在/ 半/ 诚实/ 模型/ 下/ ,/ 网络/ 之间/ 传输/ 都/ 是/ 公开信/ 道/ ./ 协议/ 2/ ./ 保密/ 判断/ 点/ 与/ 线/ 的/ 位置/ 关系/ ./ 输入/ :/ Alice/ 保密/ 输入/ 空间/ 点/ p0/ (/ x0/ ,/ y0/ ,/ z0/ )/ ,/ Bob/ 保密/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 点/ p0/ 是否/ 在/ 直线/ L/ 上/ 1/ ./ Alice/ 持有/ 向量/ 犪/ =/ (/ x0/ ,/ y0/ ,/ z0/ ,/ 1/ )/ ,/ Bob/ 持有/ 向量/ 犫/ =/ (/ A1/ ,/ B1/ ,/ C1/ ,/ D1/ )/ ,/ 犮/ =/ (/ A2/ ,/ B2/ ,/ C2/ ,/ D2/ )/ ./ 2/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ,/ 并/ 和/ Bob/ 借助/ 云外/ 包/ 计算/ ,/ 执行/ 两次/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 计算/ 出/ 向量/ 犪/ 与/ 向量/ 犫/ 的/ 内积/ 、/ 向量/ 犪/ 与/ 向量/ 犮/ 的/ 内积/ ./ 3/ ./ 若/ (/ 〈/ 犪/ ,/ 犫/ 〉/ =/ 0/ )/ ∧/ (/ 〈/ 犪/ ,/ 犮/ 〉/ =/ 0/ )/ ,/ 则/ 点/ p0/ 在线/ L/ 上/ ,/ 否则/ 点/ p0/ 在线/ L/ 外/ ./ 4/ ./ Alice/ 将/ 结果/ 告诉/ Bob/ ./ 协议/ 3/ ./ 保密/ 判断/ 点/ 与/ 面/ 的/ 位置/ 关系/ ./ 输入/ :/ Alice/ 保密/ 输入/ 空间/ 点/ p0/ (/ x0/ ,/ y0/ ,/ z0/ )/ ,/ Bob/ 保密/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 点/ p0/ 是否/ 在/ 平面/ Π/ 上/ 1/ ./ Alice/ 持有/ 向量/ 犪/ =/ (/ x0/ ,/ y0/ ,/ z0/ ,/ 1/ )/ ,/ Bob/ 持有/ 向量/ 犫/ =/ (/ A/ ,/ B/ ,/ C/ ,/ D/ )/ ./ 2/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ./ 并/ 和/ Bob/ 借助/ 云外/ 包/ 计算/ ,/ 执行/ 一次/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 计算/ 出/ 向量/ 犪/ 与/ 向量/ 犫/ 的/ 内积/ ./ 3/ ./ 若/ 〈/ 犪/ ,/ 犫/ 〉/ =/ 0/ ,/ 则/ 点/ p0/ 在/ 面/ Π/ 上/ ,/ 否则/ 点/ p0/ 在/ 面/ Π/ 外/ ./ 4/ ./ Alice/ 将/ 结果/ 告诉/ Bob/ ./ 协议/ 4/ ./ 保密/ 判断/ 线/ 与/ 线/ 的/ 位置/ 关系/ ./ 输入/ :/ Alice/ 保密/ 输入/ 空间/ 直线/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 直线/ L1/ 与/ 直线/ L2/ 是否/ 平行/ 、/ 1/ ./ 利用/ 叉积/ 公式/ ,/ Alice/ 可以/ 得到/ 直线/ L1/ 的/ 方向/ 向量/ 犲/ 1/ =/ (/ m1/ ,/ n1/ ,/ l1/ )/ =/ Page9/ 线/ L2/ 的/ 方向/ 向量/ 犲/ 2/ =/ (/ m2/ ,/ n2/ ,/ l2/ )/ =/ 2/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ,/ 并/ 和/ Bob/ 借助/ 云外/ 包/ 计算/ ,/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 求得/ 两者/ 内积/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ ./ 若/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ =/ 0/ 根据/ 夹角/ 公式/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ =/ 犲/ 1/ 犲/ 2cos/ θ/ ,/ 则/ cos/ θ/ =/ 0/ ,/ 此时/ 两条/ 直线/ 垂直/ ;/ 否则/ Alice/ 可以/ 得到/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ Bob/ 可以/ 得到/ 犲/ 2/ ,/ 记该/ 数为/ y/ ./ 利用/ Hash/ 函数/ 判断/ h/ (/ x/ )/ 与/ h/ (/ y/ )/ 是否/ 相等/ ./ 若/ h/ (/ x/ )/ ≠/ h/ (/ y/ )/ ,/ 则/ x/ ≠/ y/ ,/ 即/ cos/ θ/ ≠/ ±/ 1/ ,/ 则/ 两条/ 直线/ 相交/ ./ 若/ h/ (/ x/ )/ =/ h/ (/ y/ )/ ,/ 则/ x/ =/ y/ ,/ 即/ cos/ θ/ =/ ±/ 1/ ,/ 则/ 直线/ L1/ 与/ 直线/ L2/ 平行/ 或/ 重合/ ,/ 转入/ 下面/ 的/ 步骤/ ./ 3/ ./ Alice/ 在/ L1/ 上任/ 取/ 一点/ {/ x0/ ,/ y0/ ,/ z0/ }/ ,/ 得到/ 向量/ 犪/ =/ (/ x0/ ,/ y0/ ,/ z0/ ,/ 1/ )/ ./ Bob/ 持有/ 向量/ 犫/ =/ (/ A1/ ,/ B1/ ,/ C1/ ,/ D1/ )/ ,/ 犮/ =/ (/ A2/ ,/ B2/ ,/ C2/ ,/ D2/ )/ ./ Alice/ 和/ Bob/ 调用/ 两次/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 计算/ 出/ 向量/ 犪/ 与/ 向量/ 犫/ 的/ 内积/ 、/ 向量/ 犪/ 与/ 向量/ 犮/ 的/ 内积/ ./ 若/ (/ 〈/ 犪/ ,/ 犫/ 〉/ =/ 0/ )/ ∧/ (/ 〈/ 犪/ ,/ 犮/ 〉/ =/ 0/ )/ ,/ 则/ 说明/ 两/ 直线/ L1/ 与/ L2/ 重合/ ,/ 否则/ 平行/ ./ 4/ ./ Alice/ 将/ 结果/ 告诉/ Bob/ ./ 协议/ 5/ ./ 保密/ 判断/ 线/ 与/ 面/ 的/ 位置/ 关系/ ./ 输入/ :/ Alice/ 保密/ 输入/ 直线/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 直线/ L/ 与/ 平面/ Π/ 是否/ 相交/ 、/ 1/ ./ 利用/ 叉积/ 公式/ ,/ Alice/ 可以/ 得到/ 直线/ L/ 的/ 方向/ 向量/ Bob/ 持有/ 平面/ Π/ 的/ 法/ 向量/ 犱/ =/ (/ A3/ ,/ B3/ ,/ C3/ )/ ./ 2/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ,/ 并/ 和/ Bob/ 借助/ 云外/ 包/ 计算/ ,/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 求得/ 两者/ 内积/ 〈/ 犲/ ,/ 犱/ 〉/ ./ 根据/ 夹角/ 公式/ 〈/ 犲/ ,/ 犱/ 〉/ =/ 犲/ 犱/ cos/ θ/ ,/ Alice/ 可以/ 得到/ 〈/ 犲/ ,/ 犱/ 〉/ 为/ x/ ./ Bob/ 可以/ 得到/ 犱/ ,/ 记该/ 数为/ y/ ./ 利用/ Hash/ 函数/ 判断/ h/ (/ x/ )/ 与/ h/ (/ y/ )/ 是否/ 相等/ ,/ 若/ h/ (/ x/ )/ ≠/ h/ (/ y/ )/ ,/ 则/ x/ ≠/ y/ ,/ 即/ cos/ θ/ ≠/ ±/ 1/ ,/ 则/ 直线/ L/ 与/ 平面/ Π/ 相交/ ;/ 若/ h/ (/ x/ )/ =/ h/ (/ y/ )/ ,/ 则/ x/ =/ y/ ,/ 即/ cos/ θ/ =/ ±/ 1/ ,/ 即/ 直线/ L/ 与/ 平面/ Π/ 垂直/ ;/ 若/ 〈/ 犲/ ,/ 犱/ 〉/ =/ 0/ ,/ 那么/ cos/ θ/ =/ 0/ ,/ 则/ 直线/ L/ 与/ 平面/ Π/ 平行/ 或/ 重合/ ;/ 转入/ 下面/ 步骤/ ./ 3/ ./ Alice/ 在/ 直线/ L/ 上任/ 取/ 一点/ (/ x1/ ,/ y1/ ,/ z1/ )/ ,/ 得到/ 向量/ 犪/ =/ (/ x1/ ,/ y1/ ,/ z1/ ,/ 1/ )/ ,/ Bob/ 持有/ 向量/ 犫/ =/ (/ A3/ ,/ B3/ ,/ C3/ ,/ D3/ )/ ,/ 再次/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 求得/ 内积/ 〈/ 犪/ ,/ 犫/ 〉/ ,/ 若/ 〈/ 犪/ ,/ 犫/ 〉/ =/ 0/ ,/ 则/ 直线/ L/ 与/ 平面/ Π/ 重合/ ,/ 否则/ 平行/ ./ 4/ ./ Alice/ 将/ 结果/ 告诉/ Bob/ ./ 协议/ 6/ ./ 保密/ 判断/ 面与面/ 的/ 位置/ 关系/ ./ 输入/ :/ Alice/ 保密/ 输入/ 平面/ :/ Π/ 1/ :/ A1x/ +/ B1y/ +/ C1z/ +/ D1/ =/ 0/ ,/ 输出/ :/ Alice/ 和/ Bob/ 都/ 知道/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 是否/ 平行/ 、/ 1/ ./ Alice/ 得到/ 平面/ Π/ 1/ 的/ 法/ 向量/ 犱/ 1/ =/ (/ A1/ ,/ B1/ ,/ C1/ )/ ,/ Bob/ 得到/ 平面/ Π/ 2/ 的/ 法/ 向量/ 犱/ 2/ =/ (/ A2/ ,/ B2/ ,/ C2/ )/ ./ 2/ ./ Alice/ 选择/ Boneh/ 加密/ 方案/ ,/ 公布/ 公钥/ (/ 犲/ ,/ G1/ ,/ G/ ,/ n/ =/ pq/ ,/ g/ ,/ h/ )/ ,/ 保密/ 私钥/ (/ p/ ,/ q/ )/ ,/ 并/ 和/ Bob/ 借助/ 云外/ 包/ 计算/ ,/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ 求得/ 两者/ 内积/ 〈/ 犱/ 1/ ,/ 犱/ 2/ 〉/ ./ 根据/ 夹角/ 公式/ 〈/ 犱/ 1/ ,/ 犱/ 2/ 〉/ =/ 犱/ 1/ 犱/ 2cos/ θ/ ,/ Alice/ 可/ 得到/ 〈/ 犱/ 1/ ,/ 犱/ 2/ 〉/ 数为/ x/ ./ Bob/ 可以/ 得到/ 犱/ 2/ ,/ 记该/ 数为/ y/ ./ 利用/ Hash/ 函数/ 判断/ h/ (/ x/ )/ 与/ h/ (/ y/ )/ 是否/ 相等/ ,/ 若/ h/ (/ x/ )/ ≠/ h/ (/ y/ )/ ,/ 则/ x/ ≠/ y/ ,/ 即/ cos/ θ/ ≠/ ±/ 1/ ,/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 相交/ ;/ 若/ 〈/ 犱/ 1/ ,/ 犱/ 2/ 〉/ =/ 0/ ,/ 那么/ cos/ θ/ =/ 0/ ,/ 即/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 垂直/ ;/ 若/ h/ (/ x/ )/ =/ h/ (/ y/ )/ ,/ 则/ x/ =/ y/ ,/ 那么/ cos/ θ/ =/ ±/ 1/ ,/ 则/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 平行/ 或/ 重合/ ;/ 转入/ 下面/ 步骤/ ./ 3/ ./ Alice/ 在/ 平面/ Π/ 1/ 上任/ 取/ 一点/ {/ x0/ ,/ y0/ ,/ z0/ }/ ,/ 得到/ 向量/ 犪/ =/ (/ x0/ ,/ y0/ ,/ z0/ ,/ 1/ )/ ./ Bob/ 持有/ 向量/ 犫/ =/ (/ A2/ ,/ B2/ ,/ C2/ ,/ D2/ )/ ,/ 再次/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 可/ 求得/ 内积/ 〈/ 犪/ ,/ 犫/ 〉/ ./ 若/ 〈/ 犪/ ,/ 犫/ 〉/ =/ 0/ ,/ 则/ 平面/ Π/ 1/ 与/ 平面/ Π/ 2/ 重合/ ,/ 否则/ 平行/ ./ 注意/ :/ 在/ 以上/ 5/ 个/ 协议/ 中/ ,/ 由于/ 我们/ 的/ 协议/ 都/ 是/ 通过/ 夹角/ 完成/ 的/ ./ 若/ hash/ 值/ 相等/ ,/ 那么/ 一方/ 会/ 得到/ 另一方/ 向量/ 的/ 模长/ ./ 但/ 这/ 泄露/ 的/ 唯一/ 信息/ ,/ 不能/ 推出/ 向量/ 的/ 任何/ 信息/ ./ 关于/ 这/ 一点/ ,/ Du/ 等/ 人/ 在/ 文献/ [/ 23/ ]/ 中/ 专门/ 有/ 论证/ :/ 在/ 设计协议/ 时/ ,/ 如果/ 在/ 降低/ 完美/ 安全性/ 的/ 程度/ 上/ ,/ 允许/ 泄露/ 的/ 信息/ 并/ 不/ 影响/ 方案/ 的/ 有效性/ ,/ 那么/ 这/ 就是/ 可接受性/ 安全/ ./ 而/ 可接受性/ 安全/ 要/ 根据/ 具体/ 问题/ ,/ 具体/ 设定/ ./ 5/ 安全性/ 分析/ 在/ 本节/ ,/ 我们/ 应用/ 2.1/ 节/ 的/ 模拟/ 范例/ 给出/ 本文/ 5/ 个/ 协议/ 的/ 安全性/ 证明/ ./ 由于/ 协议/ 2/ 、/ 协议/ 3/ 的/ 安全性/ 依靠/ 基本/ 协议/ 1/ ,/ 因此/ 由/ 定理/ 1/ 可以/ 直接/ 得到/ 定理/ 2/ 、/ 定理/ 3/ 的/ 结论/ ./ 定理/ 2/ ./ 协议/ 2/ 保密/ 地/ 判断/ 了/ 点/ 与/ 线/ 的/ 位置/ 关系/ ./ 定理/ 3/ ./ 协议/ 3/ 保密/ 地/ 判断/ 了/ 点/ 与/ 面/ 的/ 位置/ 关系/ ./ 由于/ 协议/ 4/ ~/ 6/ 证明/ 过程/ 类似/ ./ 因此/ 为了/ 节省/ 篇幅/ ,/ 我们/ 以/ 证明/ 协议/ 4/ 安全性/ 为主/ ,/ 而/ 对于/ 其余/ 协议/ ,/ 只/ 给出/ 安全性/ 结论/ ./ 定理/ 4/ ./ 协议/ 4/ 保密/ 地/ 判断/ 了/ 线/ 与/ 线/ 的/ 位置/ 关系/ ./ 证明/ ./ 协议/ 4/ 的/ 证明/ 过程/ 类似/ 基本/ 协议/ 1/ ,/ 也/ Page10/ 需要/ 构造/ 5/ 个/ 模拟器/ S1/ ,/ S2/ ,/ S3/ ,/ S4/ ,/ S5/ ,/ 分为/ 3/ 种/ 情况/ 进行/ 证明/ ./ 由于/ 模拟器/ 的/ 构造/ 过程/ 类似/ ,/ 为了/ 节省/ 篇幅/ ,/ 只/ 给出/ 模拟器/ S1/ 的/ 构造/ 过程/ ,/ 其余/ 可以/ 参照/ 基本/ 协议/ 1/ 进行/ 构造/ ./ 在/ 本/ 协议/ 中/ 或者/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f2/ (/ 犡/ ,/ 犢/ )/ 假设/ f1/ (/ 犡/ ,/ 犢/ )/ =/ f2/ (/ 犡/ ,/ 犢/ )/ =/ (/ L1/ // // L2/ )/ ,/ 构造/ 模拟器/ S1/ ./ S1/ 接受/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ 作为/ 输入/ ,/ 按/ 如下/ 方式/ 工作/ :/ 第/ 1/ 步/ ./ S1/ 接受/ 输入/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ =/ (/ L1/ ,/ (/ L1/ // // L2/ )/ )/ 后/ ,/ 首先/ 随机/ 选取/ 一条/ 直线/ L2/ :/ 使得/ f1/ (/ L1/ ,/ L2/ )/ =/ f1/ (/ L1/ ,/ L2/ )/ ,/ 然后/ 用/ (/ L1/ ,/ L2/ )/ 进行/ 模拟/ ./ 按照/ 协议/ 4/ ,/ S1/ 分别/ 得到/ 直线/ L1/ 、/ 直线/ L2/ 的/ 方向/ 向量/ 犲/ 1/ 、/ 犲/ 2/ ./ 第/ 2/ 步/ ./ S1/ 调用/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 得到/ 内积/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ ./ 第/ 3/ 步/ ./ S1/ 计算/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ 算/ 犲/ 2/ ,/ 记该/ 数为/ y/ ./ 利用/ Hash/ 函数/ 计算/ h/ (/ x/ )/ 与/ h/ (/ y/ )/ ,/ 比较/ 两者/ 的/ 值/ 是否/ 相等/ ,/ 将/ 结果/ 记为/ H/ ./ S1/ 在/ L1/ 上任/ 取/ 一点/ {/ x0/ ,/ y0/ ,/ z0/ }/ ,/ 得到/ 向量/ 犪/ =/ (/ x0/ ,/ y0/ ,/ z0/ ,/ 1/ )/ ./ 在/ L2/ 上/ 得到/ 向量/ 犫/ =/ (/ A3/ ,/ B3/ ,/ C3/ ,/ D3/ )/ ,/ 犮/ =/ (/ A4/ ,/ B4/ ,/ C4/ ,/ D4/ )/ ,/ S1/ 调用/ 两次/ 3.3/ ./ 1/ 节/ 的/ 保密/ 内积/ 协议/ ,/ 计算/ 向量/ 犪/ 与/ 向量/ 犫/ 的/ 内积/ 〈/ 犪/ ,/ 犫/ 〉/ 、/ 向量/ 犪/ 与/ 向量/ 犮/ 的/ 内积/ 〈/ 犪/ ,/ 犮/ 〉/ ,/ 得到/ 结果/ C/ ./ 于是/ 得到/ view1/ (/ 犡/ ,/ 犢/ )/ =/ {/ L1/ ,/ 犲/ 1/ ,/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ ,/ x/ ,/ h/ (/ x/ )/ ,/ S1/ (/ 犡/ ,/ f1/ (/ 犡/ ,/ 犢/ )/ )/ =/ {/ L1/ ,/ 犲/ 1/ ,/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ ,/ x/ ,/ h/ (/ x/ )/ ,/ h/ (/ y/ )/ ,/ 由于/ C/ =/ f1/ (/ L1/ ,/ L2/ )/ =/ (/ L1/ // // L2/ )/ ,/ 而/ C/ =/ f1/ (/ L1/ ,/ L2/ )/ =/ (/ L1/ // // L2/ )/ ,/ f1/ (/ L1/ ,/ L2/ )/ =/ f1/ (/ L1/ ,/ L2/ )/ ,/ 因此/ C/ =/ C/ ./ 由于/ x/ =/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ 经/ 证明/ 内积/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ c/ 〈/ 犲/ 1/ ,/ 犲/ 2/ 〉/ ,/ 因此/ h/ (/ x/ )/ ch/ (/ x/ )/ ,/ xcx/ ./ L2/ 为/ S1/ 随机/ 取/ 的/ 一条/ 直线/ ,/ 而/ S1/ 不/ 知道/ L2/ 的/ 具体位置/ ,/ 且/ L2/ 为/ 随机/ 分布/ ./ 因此/ 犲/ 2/ 和/ 犲/ 2/ 计算/ 不可/ 区分/ ,/ 即/ 得到/ h/ (/ y/ )/ =/ h/ (/ 犲/ 2/ )/ ,/ h/ (/ y/ )/ =/ h/ (/ 犲/ 2/ )/ ,/ 因此/ h/ (/ y/ )/ ch/ (/ y/ )/ ,/ 〈/ 犪/ ,/ 犫/ 〉/ c/ 〈/ 犪/ ,/ 犫/ 〉/ ,/ 〈/ 犪/ ,/ 犮/ 〉/ c/ 〈/ 犪/ ,/ 犮/ 〉/ ,/ HcH/ ./ 又/ 因为/ output2/ (/ 犡/ ,/ 犢/ )/ =/ f2/ (/ 犡/ ,/ 犢/ )/ =/ (/ L1/ // // L2/ )/ ,/ 所以/ :/ 用/ 类似/ 的/ 构造方法/ (/ 参照/ 基本/ 协议/ 1/ )/ 可以/ 构造/ 其他/ 4/ 个/ 模拟器/ ,/ 分别/ 得到/ 下/ 式/ :/ S3/ (/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview3/ (/ x/ ,/ y/ )/ ,/ S4/ (/ x/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ f1/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview4/ (/ x/ ,/ y/ )/ ,/ S5/ (/ y/ ,/ E/ (/ x/ )/ ,/ E/ (/ y/ )/ ,/ f2/ (/ x/ ,/ y/ )/ ,/ E/ (/ x/ ,/ y/ )/ )/ cview5/ (/ x/ ,/ y/ )/ ./ 定理/ 5/ ./ 协议/ 5/ 保密/ 地/ 判断/ 了/ 线/ 与/ 面/ 的/ 位置/ 定理/ 6/ ./ 协议/ 6/ 保密/ 地/ 判断/ 了/ 面与面/ 的/ 位置/ 定理/ 5/ 、/ 定理/ 6/ 的/ 证明/ 过程/ 类似/ 定理/ 4/ ,/ 为了/ 节/ 关系/ ./ 关系/ ./ 省/ 篇幅/ ,/ 这里/ 不再/ 一一/ 赘述/ ./ 6/ 效率/ 分析/ 与/ 比较/ 本/ 节/ 给出/ 本文/ 协议/ 和/ 引言/ 中/ 的/ 相关/ 文献/ [/ 14/ -/ 15/ ]/ 在/ 效率/ 以及/ 性能/ 方面/ 的/ 分析/ 和/ 比较/ ./ 由于/ 这些/ 文献/ 涉及/ 的/ 空间/ 位置/ 问题/ 不全/ 相同/ ,/ 为了/ 便于/ 做出/ 比较/ ,/ 在/ 效率/ 方面/ ,/ 统一/ 用/ 本文/ 和/ 相关/ 文献/ [/ 14/ -/ 15/ ]/ 中/ 都/ 出现/ 的/ 面与面/ 位置/ 问题/ 保密/ 判断/ 协议/ 做出/ 对比/ ./ 模乘/ 运算/ 记为/ MN2/ ,/ 模幂/ 运算/ 记为/ M/ 犲/ 2/ ,/ 乘法/ 运算/ 记为/ M/ ./ (/ 1/ )/ 计算/ 复杂度/ 以上/ 方案/ 利用/ 的/ 基础/ 协议/ 中/ ,/ 比较复杂/ 的/ 是/ 内积/ 协议/ ,/ 而/ 内积/ 协议/ 都/ 是/ 通过/ 同态/ 加密算法/ 得到/ ./ 为了/ 便于/ 比较/ ,/ 假设/ 所有/ 方案/ 中/ 的/ 内积/ 协议/ 都/ 采用/ 本文/ 的/ Boneh/ [/ 18/ ]/ 同态/ 加密/ 方案/ ./ 在/ 整个/ 执行/ 过程/ 中/ ,/ 计算/ 开销/ 较大/ 的/ 是/ 模幂/ 运算/ 、/ 模乘/ 运算/ 、/ 乘法/ 运算/ ./ 因此/ 把/ 各个/ 方案/ 中/ 用户/ 需要/ 调用/ 的/ 内积/ 协议/ 总/ 次数/ ,/ 以及/ 用户/ 需要/ 的/ 模幂/ 运算/ 、/ 模乘/ 运算/ 、/ 乘法/ 运算/ 总/ 个数/ 作为/ 衡量/ 计算/ 复杂性/ 的/ 指标/ ,/ 其他/ 忽略不计/ ./ 文献/ [/ 14/ ]/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 4/ )/ :/ 使用/ 了/ 1/ 次/ 内积/ 协议/ 和/ 2/ 次/ 数据/ 对应/ 成/ 比例/ 协议/ ./ 而/ 数据/ 对应/ 成/ 比例/ 协议/ 每/ 调用/ 一次/ ,/ 就/ 需要/ 循环/ 语句/ 调用/ 内积/ 协议/ ,/ 因此/ 使用/ 的/ 内积/ 协议/ 总/ 次数/ 为/ 6/ 次/ ./ 按照/ 原文/ [/ 14/ ]/ 的/ 分析/ ,/ 需要/ 34m/ 个模/ 幂/ 运算/ 、/ 8m/ 个模/ 乘/ 运算/ ,/ 其中/ ,/ m/ 为/ 安全/ 参数/ ./ 因此/ 该/ 协议/ 的/ 计算/ 开销/ 为/ 8mMN2/ +/ 34mM/ 犲/ 2/ ./ 文献/ [/ 15/ ]/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 4/ )/ :/ 计算/ 了/ 3/ 次/ 内积/ ,/ 但/ 并/ 没有/ 调用/ 内积/ 协议/ ,/ 用户/ 主要/ Page11/ 使用/ 了/ 矩阵/ 运算/ ./ 进行/ 了/ 3/ 个/ 3/ 阶/ 的/ 矩阵/ 运算/ ,/ 9/ 个数/ 乘/ 运算/ ,/ 因此/ 乘法/ 运算/ 总/ 个数/ 为/ 36M/ ./ 本文/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 6/ )/ :/ 协议/ 调用/ 的/ 2/ 次/ 内积/ 协议/ 被/ 外包/ 计算/ 给/ 云/ ,/ 用户/ 本身/ 并/ 没有/ 计算/ 内积/ ./ 用户/ 只/ 计算/ 了/ 2/ 个/ 幂/ 运算/ 、/ 2/ 个模/ 乘/ 运算/ 、/ 14/ 个/ 加密/ 运算/ 、/ 2/ 个/ 解密/ 运算/ ./ 因此/ 该/ 协议/ 总/ 的/ 计算/ 开销/ 为/ 2MN2/ +/ 18M/ 犲/ 2/ ./ (/ 2/ )/ 通信/ 复杂度/ 衡量/ 通信/ 复杂度/ 的/ 指标/ 用/ 协议/ 交换/ 信息/ 的/ 比特/ 数/ ,/ 或者/ 用/ 通信/ 轮数/ ,/ 在/ 多方/ 保密/ 计算/ 研究/ 中/ 通常/ 用/ 轮数/ (/ round/ )/ ./ 文献/ [/ 14/ ]/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 4/ )/ :/ 使用/ 了/ 1/ 次/ 内积/ 协议/ 、/ 2/ 次/ 数据/ 对应/ 成/ 比例/ 、/ 1/ 次/ 比较/ 协议/ ./ 第/ 1/ 次/ 调用/ 数据/ 对应/ 成/ 比例/ 协议/ ,/ 交互/ 轮数/ 为/ 6m/ ,/ 第/ 2/ 次/ 调用/ 数据/ 对应/ 成/ 比例/ 协议/ ,/ 交互/ 轮数/ 为/ 8m/ ,/ 其中/ m/ 为/ 安全/ 参数/ ./ 总共/ 进行/ 了/ 14m/ +/ 4/ 轮/ 交互/ ./ 文献/ [/ 15/ ]/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 4/ )/ :/ 方案/ 解决/ 的/ 问题/ 点线点/ 面线/ 线/ 线面/ 面/ 面点/ 面线/ 面/ 面/ 面点/ 线点/ 面线/ 线/ 线面/ 面/ 面表/ 5/ 本文/ 方案/ 与/ 现有/ 方案/ 的/ 性能/ 比较/ 判断/ 的/ 位置/ 关系/ 云/ 计算/ 平台/ 从表/ 4/ 可以/ 看出/ ,/ 文献/ [/ 15/ ]/ 的/ 效率/ 是/ 最优/ 的/ ,/ 但/ 从表/ 5/ 可以/ 看出/ ,/ 该/ 文献/ 能/ 解决/ 的/ 问题/ 最少/ (/ 只能/ 解决/ 3/ 种/ )/ ,/ 而且/ 能/ 判断/ 的/ 位置/ 关系/ 最/ 单一/ ,/ 因此/ 该/ 文献/ 虽然/ 效率/ 较/ 高/ ,/ 但/ 性能/ 最差/ ,/ 应用/ 比较/ 受限/ ./ 若要/ 解决/ 和/ 我们/ 的/ 方案/ 以及/ 文献/ [/ 14/ ]/ 同样/ 多/ 的/ 问题/ ,/ 判断/ 更/ 多/ 的/ 位置/ 关系/ ,/ 还/ 需要/ 再/ 寻找/ 其他/ 的/ 方法/ ./ 从表/ 5/ 可以/ 看出/ ,/ 文献/ [/ 14/ ]/ 和/ 我们/ 的/ 方案/ 能/ 解决/ 的/ 问题/ 相同/ ,/ 但/ 文献/ [/ 14/ ]/ 由于/ 利用/ 了/ 复杂/ 的/ 数据/ 对应/ 成/ 比例/ 协议/ ,/ 需要/ 使用/ 循环/ 语句/ 不断/ 调用/ 内积/ 协议/ ./ 而/ 我们/ 的/ 方案/ 由于/ 云/ 计算技术/ 的/ 使用/ ,/ 将/ 内积/ 协议/ 外包/ 给/ 云/ ,/ 为/ 用户/ 节省/ 了/ 计算成本/ ,/ 因此/ 在/ 解决/ 同样/ 多/ 的/ 问题/ 下/ ,/ 从表/ 4/ 可以/ 看出/ 我们/ 的/ 效率/ 优于/ 文献/ [/ 14/ ]/ ./ 此外/ ,/ 从表/ 5/ 还/ 可以/ 看出/ ,/ 虽然/ 我们/ 的/ 方案/ 和/ 文献/ [/ 14/ ]/ 能/ 处理/ 的/ 问题/ 相同/ ,/ 但/ 能/ 判断/ 的/ 位置/ 关系/ 却/ 比/ 其他/ 已存/ 方案/ 都/ 多/ ,/ 并且/ 我们/ 的/ 方案/ 第一次/ 给出/ 了/ 云/ 计算/ 平台/ 下/ 处理/ 空间/ 立体几何/ 问题/ 的/ 解决/ 方法/ ./ 总共/ 进行/ 了/ 2/ 轮/ 交互/ ./ 本文/ 的/ 面面/ 位置/ 关系/ 保密/ 判断/ (/ 协议/ 6/ )/ :/ 使用/ 了/ 2/ 次/ 内积/ 协议/ 和/ 1/ 次/ 比较/ 协议/ ,/ 内积/ 协议/ 每/ 调用/ 一次/ 就/ 进行/ 了/ 3/ 轮/ 交互/ ./ 因此/ 两个/ 用户/ 包括/ 和/ 云/ 服务器/ ,/ 总共/ 进行/ 了/ 8/ 轮/ 交互/ ./ (/ 3/ )/ 性能/ 以/ 协议/ 判断/ 的/ 空间/ 位置/ 关系/ 多少/ 、/ 解决/ 的/ 问题/ 多少/ 、/ 是否/ 适合/ 云/ 计算/ 平台/ 作为/ 衡量/ 性能/ 的/ 指标/ ,/ 其中/ ×/ 表示/ 不/ 具有/ 此/ 性能/ ,/ √/ 表示/ 具有/ 此/ 性能/ ./ 综合/ 以上/ 分析/ ,/ 本文/ 与/ 现有/ 文献/ [/ 14/ -/ 15/ ]/ 在/ 面面/ 保密/ 判定/ 协议/ 的/ 效率/ 对/ 比如/ 表/ 4/ ./ 本文/ 与/ 现有/ 文献/ [/ 14/ -/ 15/ ]/ 方案/ 的/ 性能/ 对/ 比如/ 表/ 5/ ./ 方案/ 文献/ [/ 14/ ]/ (/ 协议/ 4/ )/ 2n/ +/ 18mMN2/ +/ 34mM/ 犲/ 2/ (/ 14m/ +/ 4/ )/ rounds/ 文献/ [/ 15/ ]/ (/ 协议/ 4/ )/ 0/ 我们/ 的/ 协议/ 602MN2/ +/ 18M/ 犲/ 28rounds/ 文献/ [/ 15/ ]/ ×/ 7/ 总结/ 和/ 开放/ 问题/ 空间/ 位置/ 关系/ 的/ 保密/ 计算/ 属于/ 安全/ 多方/ 计算/ 中/ 的/ 空间/ 几何/ 问题/ ,/ 现实/ 中/ 很多/ 问题/ 都/ 能/ 归结/ 于此/ ./ 已存/ 方案/ 由于/ 转化/ 方法/ 的/ 原因/ 使得/ 用户/ 的/ 计算/ 复杂性/ 较/ 高/ ,/ 或者/ 解决/ 的/ 问题/ 有限/ 、/ 能/ 判断/ 的/ 位置/ 关系/ 单一/ ,/ 并且/ 都/ 是/ 在/ 传统模式/ 下/ 进行/ 的/ ./ 本文/ 首次/ 探索/ 了/ 云/ 计算/ 平台/ 下/ 安全/ 多方/ 计算/ 几何/ 问题/ 的/ 解决/ 方法/ ,/ 首先/ 将/ 原/ 问题/ 转化成/ 夹角/ 问题/ ,/ 接着/ 设计/ 了/ 适用/ 于云外/ 包/ 计算/ 下/ 的/ 内积/ 协议/ ,/ 然后/ 基于/ 该/ 内积/ 协议/ ,/ 解决/ 了/ 空间/ 几何/ 中/ 5/ 种/ 位置/ 关系/ 的/ 保密/ 判断/ 问题/ ./ 由于/ 问题/ 的/ 巧妙/ 转化/ ,/ 使得/ 我们/ 的/ 方案/ 能/ 解决/ 的/ 问题/ 也/ 更/ 多/ ,/ 判断/ 的/ 位置/ 关系/ 也/ 更加/ 多样化/ ./ 并且/ 由于/ 云/ 计算技术/ 的/ 使用/ ,/ 为/ 用户/ 节省/ 了/ 大量/ 的/ 计算成本/ ./ 本文/ 的/ 协议/ 为了/ 提高效率/ ,/ 以/ 接受/ 性/ 安全/ 作为/ 牺牲/ 代价/ ,/ 有/ 一定/ 的/ 信息/ 泄露/ (/ 如/ 向量/ 的/ 模长/ )/ ,/ 虽然/ 不/ 影响/ 协议/ 的/ 执行/ 和/ 有效性/ ,/ 但/ 并未/ 取得/ 完美性/ 安/ Page12/ 全/ ./ 因此/ ,/ 可以/ 进一步/ 考虑/ 如何/ 设计/ 关于/ 此/ 问题/ 的/ 完美/ 安全性/ 下/ 的/ 高效/ 协议/ ./ 此外/ ,/ 将/ 传统/ 安全/ 多方/ 计算/ 中/ 的/ 大/ 数据/ 问题/ ,/ 借助/ 云/ 计算/ 的/ 能力/ 有效/ 解决/ ,/ 是/ 安全/ 多方/ 计算/ 的/ 一个/ 研究/ 新/ 方向/ ,/ 但/ 将/ 安全/ 多方/ 计算/ 问题/ 架构/ 在/ 云/ 平台/ 下时/ ,/ 需要/ 不同/ 以往/ 的/ 新/ 技术/ ,/ 这/ 也/ 将/ 是/ 未来/ 研究/ 的/ 工作/ 之一/ ./ 致谢/ 在/ 此/ ,/ 我们/ 向/ 对/ 本文/ 的/ 工作/ 给予/ 支持/ 和/ 建议/ 的/ 同行/ ,/ 尤其/ 是/ 陕西/ 师范大学/ 计算/ 科学/ 学院/ 614/ 实验室/ 的/ 老师/ 和/ 同学/ 表示感谢/ !/ 

