Page1/ 一种/ 基于/ 概率/ 图/ 模型/ 的/ 不确定性/ 数据/ 世系/ 表示/ 方法/ 岳昆/ 刘/ 惟一/ 朱运磊/ 张伟/ (/ 云南大学/ 信息/ 学院/ 计算机科学/ 与/ 工程系/ 昆明/ 650091/ )/ 摘要/ 不确定性/ 数据/ 的/ 世系/ 分析/ 是/ 基于/ 数据/ 产生/ 和/ 演变/ 的/ 过程/ 来/ 跟踪/ 数据/ 不确定性/ 的/ 来源/ ./ 为了/ 有效/ 地/ 描述/ 数据/ 间/ 复杂/ 的/ 相关性/ 及/ 不确定性/ ,/ 并/ 从/ 理论/ 上/ 保证/ 世系/ 分析/ 中/ 概率/ 计算/ 的/ 正确性/ ,/ 文中/ 研究/ 了/ 基于/ 贝叶斯/ 网/ 这/ 一/ 重要/ 的/ 概率/ 图/ 模型/ 的/ 不确定性/ 数据/ 世系/ 表示/ 方法/ ./ 以/ 世系/ 的/ 布尔/ 公式/ 和/ 不确定性/ 数据/ 本身/ 为/ 出发点/ ,/ 提出/ 了/ 将/ 布尔/ 公式/ 等价/ 转换/ 为/ 贝叶斯/ 网/ 的/ 方法/ ,/ 并/ 讨论/ 了/ 相应/ 的/ 条件/ 独立/ 性质/ 和/ 概率/ 语义/ ./ 案例/ 研究/ 和/ 实验/ 结果表明/ ,/ 文中/ 的/ 方法/ 为/ 世系/ 分析/ 提供/ 了/ 一种/ 有效性/ 的/ 、/ 可/ 扩展/ 的/ 数据/ 相关性/ 表示/ 和/ 概率/ 计算/ 框架/ ./ 关键词/ 不确定性/ 数据/ ;/ 世系/ 表示/ ;/ 概率/ 计算/ ;/ 概率/ 图/ 模型/ ;/ 贝叶斯/ 网/ 1/ 引言/ 式/ 多样化/ ,/ 大量/ 的/ 不确定性/ 数据/ 随之/ 产生/ ,/ 普遍存在/ 于/ 经济/ 、/ 军事/ 、/ 物流/ 、/ 金融/ 、/ 电信/ 和/ 科学计算/ 等/ 领域/ 中/ 、/ 并且/ 扮演着/ 关键/ 的/ 角色/ ./ 当前/ 数据/ 特点/ 的/ 新变/ 数据/ 规模/ 不断扩大/ 、/ 共享/ 范围/ 越来越/ 广/ 、/ 数据/ 形化/ ,/ 使得/ 不确定性/ 数据管理/ 成为/ 了/ 国内外/ 研究/ 的/ 热/ Page2/ 点/ ,/ 目前/ 仍/ 面临/ 着/ 不确定性/ 建模/ 、/ 管理/ 和/ 优化/ 等/ 方面/ 的/ 挑战/ [/ 1/ -/ 2/ ]/ ./ 不确定性/ 数据/ 世系/ 分析/ ,/ 是/ 指/ 基于/ 数据/ 产生/ 和/ 演变/ 的/ 过程/ 来/ 跟踪/ 数据/ 不确定性/ 的/ 来源/ ,/ 在/ 各类/ 不确定性/ 数据/ 的/ 查询/ 优化/ 、/ 集成/ 及/ 质量保证/ 等/ 方面/ ,/ 具有/ 广泛/ 的/ 应用/ ./ 文献/ [/ 3/ ]/ 对/ 世系/ 管理/ 研究/ 进行/ 了/ 综述/ ,/ 指出/ 了/ 不确定性/ 数据/ 世系/ 分析/ 研究/ 的/ 重要/ 意义/ 和/ 面临/ 的/ 挑战/ ./ ULDB/ (/ Uncertainty/ -/ LineageDataBase/ )/ 是/ Stanford/ 开发/ 的/ 面向/ 世系/ 分析/ 的/ 不确定性/ 数据/ EventsIDday21MondayReception0/ ./ 822TuesdayMuseum1/ ./ 023WednesdayBanquet0/ ./ 9EventRoster/ =/ π/ person/ ,/ event/ (/ Attends/ / / Events/ )/ 的/ 查询/ 结果/ EventAttendees/ =/ π/ person/ (/ EventRoster/ )/ 的/ 查询/ 结果/ 图/ 1/ 不确定性/ 数据/ 及/ 世系/ Re/ 等/ 人/ [/ 5/ ]/ 针对/ 大规模/ 世系/ ,/ 提出/ 了/ 近似/ 世系/ 及其/ 查询处理/ 技术/ ./ Sarma/ 等/ 人/ [/ 6/ ]/ 针对/ ULDB/ 查询处理/ ,/ 提出/ 了/ 基于/ 世系/ 表达式/ 来/ 计算/ 查询/ 结果/ 概率/ 的/ 方法/ 及/ 优化/ 策略/ ./ 这些/ 方法/ 将/ 世系/ 表示/ 为/ 布尔/ 公式/ ,/ 并/ 基于/ 世系/ 表达式/ 计算/ 查询/ 结果/ 的/ 概率/ ,/ 但/ 逻辑/ 形式/ 的/ 布尔/ 公式/ 并/ 不能/ 有效/ 地/ 描述/ 数据/ 间/ 复杂/ 的/ 相关性/ 及/ 数据/ 相关/ 的/ 不确定性/ ,/ 也/ 缺乏/ 保证/ 结果/ 概率/ 正确性/ 的/ 理论/ 基础/ ./ 因此/ ,/ 如何/ 针对/ 表示/ 为/ 布尔/ 公式/ 的/ 世系/ 表达式/ ,/ 描述/ 所/ 涉及/ 数据/ 的/ 相关性/ ,/ 并/ 应用/ 于/ 世系/ 表达式/ 的/ 高效/ 概率/ 计算/ ,/ 是/ 这类/ 研究/ 的/ 核心/ ,/ 即/ 需要/ 建立/ 一种/ 既/ 能/ 等价/ 表达/ 布尔/ 公式/ 信息/ 、/ 又/ 能/ 有效/ 支持/ 概率/ 计算/ 的/ 模型/ ./ 幸运/ 的/ 是/ ,/ 以/ 贝叶斯/ 网/ (/ BayesianNetwork/ ,/ BN/ )/ 为/ 典型/ 代表/ 的/ 概率/ 图/ 模型/ (/ ProbabilisticGraphicalModel/ ,/ PGM/ )/ ,/ 是/ 不确定性/ 知识/ 表示/ 和/ 推理/ 的/ 有效/ 框架/ [/ 7/ -/ 8/ ]/ ,/ 具有/ 坚实/ 的/ 概率论/ 理论/ 基础/ 和/ 广泛/ 的/ 应用/ ./ Deshpande/ 等/ 人/ [/ 9/ ]/ 指出/ 了/ PGM/ 在/ 数据库/ 研究/ 中/ 的/ 作用/ ,/ 基于/ PGM/ 可/ 有效/ 地/ 描述/ 数据/ 间/ 的/ 相关性/ 和/ 相互依赖/ ./ PGM/ 具有/ 良好/ 的/ 概率/ 语义/ 和/ 成熟/ 的/ 推理方法/ ,/ 为/ 不确定性/ 数据管理/ 中/ 概率/ 计算/ 这一/ 关键问题/ 提供/ 了/ 重要/ 的/ 工具/ ,/ 也/ 是/ 本文/ 研究/ 的/ 基础/ ./ 近年来/ ,/ 基于/ PGM/ 的/ 不确定性/ 数据管理/ 已有/ 许多/ 研究/ 工作/ ,/ 是/ 目前/ 用来/ 描述/ 不确定性/ 数据库/ 中/ 数据/ 相关性/ 的/ 重要/ 方法/ ./ Wang/ 等/ 人/ [/ 10/ ]/ 基于/ BN/ 扩展/ 了/ 概率/ 关系/ 模型/ ,/ 提出/ 了/ 直接/ 支持/ 概率/ 数据库/ 内部/ 关系/ 查询/ 和/ 概率模型/ 上/ 推理/ 计算/ 及/ 查询/ 优化/ 的/ 方库/ [/ 4/ ]/ ,/ 是/ 许多/ 不确定性/ 数据/ 世系/ 分析/ 研究/ 的/ 基础/ ./ 目前/ ,/ 世系/ 通常/ 基于/ 连接/ 查询/ 被/ 表示/ 为/ 所/ 涉及/ 元组/ 的/ 布尔/ 公式/ (/ 图/ 1/ 给出/ 了/ 一个/ 元组/ 独立/ 假设/ 下/ 不确定性/ 数据/ 世系/ 的/ 例子/ [/ 4/ ]/ )/ ./ 基于/ 表示/ 世系/ 的/ 布尔/ 公式/ 计算/ 查询/ 结果/ 的/ 概率/ (/ 如/ 计算/ λ/ (/ 31/ )/ 的/ 概率/ )/ ,/ 称为/ 世系/ 概率/ 计算/ ,/ 是/ 世系/ 分析/ 研究/ 的/ 重要/ 内容/ ,/ 有效/ 支持/ 查询处理/ 的/ 重要/ 任务/ ,/ 也/ 具有/ 较大/ 的/ 挑战/ ,/ 成为/ 了/ 目前/ 不确定性/ 数据/ 世系/ 研究/ 的/ 焦点/ [/ 4/ -/ 6/ ]/ ./ IDpersonprob41Garcia/ -/ Molina0/ ./ 8668/ λ/ (/ 41/ )/ =/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ 42Ullman0/ ./ 54/ λ/ (/ 42/ )/ =/ 13/ ∧/ 23/ 法/ ./ Sen/ 等/ 人/ [/ 11/ ]/ 用/ BN/ 表示/ 不确定性/ 数据库/ 中/ 元组/ 间/ 的/ 相关性/ ,/ 从而/ 避免/ 了/ 计算/ 查询/ 结果/ 概率/ 时/ 的/ 大量/ 概率分布/ 计算/ ,/ 也/ 为/ 高效/ 的/ 世系/ 概率/ 计算/ 奠定/ 了/ 基础/ ./ PGM/ 也/ 被/ 用于/ 世系/ 的/ 处理/ 中/ ,/ Kanagal/ 等/ 人/ [/ 12/ ]/ 基于/ 连接/ 树/ (/ Junctiontree/ )/ 及其/ 上/ 的/ 概率/ 推理/ 算法/ ,/ 提出/ 了/ 可/ 用于/ 大规模/ 世系/ 表达式/ 的/ 概率/ 计算方法/ ,/ 连接/ 树/ 就是/ PGM/ 的/ 一种/ 等价/ 表示/ ./ 这些/ 方法/ 基于/ PGM/ 表示/ 数据/ 查询/ 计划/ (/ 或/ 世系/ )/ 对应/ 的/ 布尔/ 公式/ ,/ 利用/ PGM/ 的/ 图形/ 特征/ 及其/ 中/ 的/ 条件/ 独立性/ [/ 8/ -/ 9/ ]/ ,/ 大大简化/ 概率/ 的/ 计算/ ./ 然而/ ,/ Pearl/ [/ 7/ ]/ 已/ 给出/ 重要/ 结论/ :/ 一个/ 有/ 向/ 无/ 环图/ 只有/ 满足/ 了/ 条件/ 独立性/ 、/ 具有/ 概率/ 语义/ ,/ 才能/ 视为/ PGM/ 并/ 进行/ 概率/ 推理/ ./ 但/ 以上/ 研究/ [/ 10/ -/ 12/ ]/ 并未/ 给出/ 满足条件/ 独立性/ 和/ 概率/ 语义/ 的/ PGM/ 构建/ 方法/ ,/ 也/ 未/ 讨论/ 图/ 模型/ 的/ 条件/ 独立性/ 和/ 概率/ 语义/ ,/ 从而/ 无法/ 从/ 理论/ 和/ 模型/ 基础/ 方面/ 保证/ PGM/ 与/ 布尔/ 公式/ 具有/ 等价/ 的/ 条件/ 概率/ 独立性/ ,/ 进而/ 不能/ 保证/ 结果/ 概率/ 的/ 正确性/ ./ 针对/ 同时/ 涉及/ 逻辑/ 知识/ 与/ 概率/ 知识/ 的/ 情形/ ,/ 目前/ 的/ 研究/ 通过/ 逻辑/ 知识/ 来/ 扩展/ BN/ 的/ 概率/ 推理/ 能力/ [/ 14/ ]/ ,/ 或者/ 用/ BN/ 来/ 增强/ 逻辑/ 知识/ 的/ 表达能力/ [/ 15/ ]/ ,/ 而/ 都/ 未/ 考虑/ 从/ 逻辑/ 知识/ 到/ 概率模型/ 的/ 等价/ 转换/ ,/ 进而/ 都/ 不能/ 用来/ 将/ 表示/ 世系/ 的/ 布尔/ 公式/ 等价/ 地/ 转换/ 为/ 可/ 有效/ 支持/ 概率/ 计算/ 的/ PGM/ ./ 因此/ ,/ 本文/ 主要/ 研究/ 从/ 表示/ 世系/ 的/ 布尔/ 公式/ 到/ BN/ 的/ 等价/ 转换方法/ ,/ 旨在/ 为/ 不确定性/ 数据/ 世系/ 分析/ 提供/ 一种/ 有效/ 支持/ 世系/ 表示/ 和/ 概率/ 计算/ 的/ 理论/ 基础/ 和/ 知识/ 框架/ ./ 总的来说/ ,/ Page3/ 本文/ 的/ 研究/ 主要/ 包括/ :/ (/ 1/ )/ 从/ 布尔/ 公式/ 到/ BN/ 有/ 向/ 无/ 环图/ 结构/ 的/ 等价/ 转换/ ./ BN/ 是/ 以/ 随机变量/ 为/ 结点/ 的/ 有/ 向/ 无/ 环图/ (/ DirectedAcyclicGraph/ ,/ DAG/ )/ ,/ 每个/ 结点/ 有/ 一张/ 定量/ 反映/ 变量/ 间/ 依赖/ 关系/ 的/ 概率/ 参数表/ (/ Condi/ -/ tionalProbabilityTable/ ,/ CPT/ )/ [/ 7/ -/ 8/ ]/ ,/ 构建/ 反映/ 变量/ 间/ 条件/ 概率/ 独立性/ 的/ DAG/ ,/ 是/ 构建/ BN/ 的/ 关键/ ./ 为了/ 以/ 表示/ 不确定性/ 数据/ 连接/ 查询/ 世系/ 的/ 布尔/ 公式/ 构建/ 相应/ 的/ BN/ ,/ 本文/ 首先/ 将/ 各/ 布尔/ 公式/ 等价/ 地/ 表示/ 为/ Horn/ 子句/ [/ 13/ ]/ ,/ 利用/ Horn/ 子句/ 与/ 逻辑/ 蕴含/ 式/ 之间/ 的/ 等价/ 特征/ ,/ 重点/ 研究/ 并/ 提出/ 了/ 从/ Horn/ 子句/ 到/ DAG/ 的/ 转换/ 算法/ 以及/ 多个/ Horn/ 子句/ 所/ 对应/ DAG/ 的/ 合并/ 策略/ ,/ 将/ 其/ 称为/ 世系/ 图/ (/ LineageGraph/ ,/ LG/ )/ ./ 我们/ 进一步/ 讨论/ LG/ 的/ 条件/ 独立性/ 和/ 概率/ 语义/ ,/ 证明/ LG/ 为/ 概率/ 图/ 模型/ ,/ 从而/ 保证/ 可/ 基于/ LG/ 进行/ 有效/ 的/ 概率/ 推理/ ./ LG/ 等价/ 地/ 反映/ 了/ 世系/ 表达式/ 的/ 逻辑/ 语义/ 和/ 概率/ 独立性/ ,/ 为/ 基于/ LG/ 进行/ 世系/ 概率/ 计算/ 奠定/ 了/ 模型/ 层面/ 上/ 的/ 基础/ ./ (/ 2/ )/ BN/ 概率/ 参数/ 的/ 计算/ ./ 基于/ LG/ 的/ 图形/ 特征/ 和/ 条件/ 独立/ 语义/ ,/ 针对/ LG/ 本身/ 的/ 性质/ 和/ BN/ 概率/ 推理/ 的/ 特点/ ,/ 本文/ 通过/ 为/ LG/ 中/ 各/ 结点/ 定义/ 满足/ 布尔/ 公式/ 的/ 函数/ ,/ 给出/ 了/ 从/ LG/ 和/ 不确定性/ 数据/ 计算/ 各/ 结点/ CPT/ 的/ 方法/ ,/ 从而/ 构建/ 了/ 等价/ 反映/ 世系/ 表达式/ 的/ BN/ ,/ 称为/ 世系/ 贝叶斯/ 网/ (/ LineageBayesianNetwork/ ,/ LBN/ )/ ,/ 弥补/ 了/ 现有/ 基于/ PGM/ 的/ 不确定性/ 数据管理/ 方法/ 在/ 理论/ 基础/ 和/ 模型/ 构建/ 方面/ 存在/ 的/ 不足之处/ ./ (/ 3/ )/ 案例/ 研究/ 和/ 实验/ 分析/ ./ 本文/ 进一步/ 给出/ 了/ 基于/ LBN/ 进行/ 世系/ 概率/ 计算/ 的/ 案例/ ,/ 同时/ 对/ LBN/ 的/ 构建/ 方法/ 及/ 相应/ 的/ 世系/ 概率/ 计算/ 进行/ 了/ 实验/ 测试/ ./ 案例/ 研究/ 和/ 实验/ 结果表明/ ,/ 本文/ 的/ 方法/ 为/ 世系/ 分析/ 提供/ 了/ 一种/ 有效性/ 的/ 数据/ 相关性/ 表示/ 和/ 概率/ 计算/ 框架/ ./ 本文/ 第/ 2/ 节是/ 研究/ 的/ 重点/ ,/ 给出/ 从/ 表示/ 世系/ 的/ 布尔/ 公式/ 和/ 不确定性/ 数据/ 构建/ LBN/ 的/ 方法/ ;/ 第/ 3/ 节/ 给出/ 基于/ LBN/ 进行/ 世系/ 概率/ 计算/ 的/ 案例/ 研究/ ;/ 第/ 4/ 节/ 给出/ 实验/ 结果/ ;/ 第/ 5/ 节/ 总结/ 全文/ ,/ 并/ 展望/ 将来/ 的/ 研究/ 工作/ ./ 2/ 从/ 世系/ 表达式/ 到/ 贝叶斯/ 网/ 假设/ 不确定性/ 数据库/ 中/ 元组/ 相互/ 独立/ ,/ 借鉴/ 文献/ [/ 4/ -/ 6/ ]/ 中/ 的/ 相关/ 描述/ ,/ 我们/ 基于/ x/ -/ relation/ 和/ 元组/ 级/ 不确定性/ ,/ 以/ 世系/ 表达式/ 为/ 重点/ ,/ 首先/ 定义/ 带有/ 世系/ 的/ 不确定性/ 数据库/ ,/ 作为/ 后续/ 讨论/ 的/ 基础/ ./ 定义/ 1/ ./ 带/ 世系/ 的/ 不确定性/ 数据库/ D/ 是/ 一个/ 三元组/ (/ 珚/ S/ ,/ I/ (/ 珚/ S/ )/ ,/ λ/ )/ ,/ 其中/ (/ 1/ )/ 珚/ S/ =/ S1/ ,/ S2/ ,/ …/ ,/ Sn/ 为/ 输入/ 的/ 基本/ x/ -/ relation/ 集合/ ,/ 其中/ 每个/ Si/ 是/ 包含/ 若干/ 元组/ 的/ 多/ 数据/ 集/ ./ (/ 2/ )/ D/ 中/ 每个/ 元组/ 有/ 一个/ 唯一/ 的/ 标识/ ,/ I/ (/ 珚/ S/ )/ 为/ 所有/ 标识/ 的/ 集合/ ./ (/ 3/ )/ λ/ 为/ 表示/ 为/ 布尔/ 公式/ 的/ 世系/ 函数/ ./ 设/ x/ -/ relationR/ 为/ 珚/ S/ 上/ 的/ 查询处理/ 结果/ ,/ I/ (/ R/ )/ 为/ R/ 中/ 元组/ 标识/ 的/ 集合/ ,/ 则/ t/ ∈/ I/ (/ R/ )/ ,/ λ/ (/ t/ )/ :/ I/ (/ 珚/ S/ )/ →/ I/ (/ R/ )/ 定义/ 为/ 珚/ S/ 上/ 的/ 布尔/ 公式/ ,/ λ/ (/ t/ )/ →/ t/ 称为/ 世系/ 表达式/ ./ 注意/ 到/ ,/ λ/ (/ t/ )/ →/ t/ 反映/ 了/ 得到/ 查询处理/ 结果/ t/ 的/ 过程/ ,/ λ/ (/ t/ )/ 中仅/ 包含/ I/ (/ 珚/ S/ )/ 中/ 元组/ 标识/ 的/ 布尔/ 公式/ ,/ 而/ 不/ 包含/ 查询处理/ 中间/ 结果/ 元组/ 的/ 标识/ ./ 以/ 元组/ 标识/ 作为/ 原子公式/ ,/ 取值/ 为/ 1/ (/ True/ )/ 或/ 0/ (/ False/ )/ ,/ 分别/ 表示/ 给定/ 查询/ 中/ 是否/ 包含/ 该/ 元组/ ./ 例/ 1/ ./ 针对/ 图/ 1/ 中/ 的/ 连接/ 查询/ EventRoster/ =/ π/ person/ ,/ event/ (/ Attends/ / / Events/ )/ 和/ EventAttendees/ =/ π/ person/ (/ EventRoster/ )/ ,/ 结果/ 元组/ 41/ 的/ 世系/ 表达式/ 为/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ →/ 41/ ./ 为了/ 从/ 世系/ 表达式/ λ/ (/ t/ )/ 和/ 输入/ 的/ 不确定性/ 数据/ 珚/ S/ 构建/ 等价/ 的/ BN/ ,/ 以下/ 2.1/ 节/ 和/ 2.2/ 节/ 分别/ 讨论/ BN/ 的/ 概率/ 图/ 模型/ 结构/ 构建/ 和/ 各/ 结点/ 概率/ 参数/ 的/ 计算/ ./ 2.1/ 构建/ 贝叶斯/ 网/ 的/ 有/ 向/ 无/ 环图/ 结构/ 我们/ 首先/ 从/ 世系/ 表达式/ 构建/ 反映/ 数据/ 间/ 依赖/ 关系/ 的/ DAG/ ,/ 然后/ 分别/ 讨论/ 其/ 条件/ 独立性/ 和/ 概率/ 语义/ ,/ 证明/ 该/ DAG/ 是/ 反映/ 数据/ 间/ 条件/ 独立性/ 的/ 概率模型/ ,/ 作为/ BN/ 的/ DAG/ 结构/ ./ 2.1/ ./ 1/ 基于/ 世系/ 表达式/ 构建/ 依赖/ 模型/ Horn/ 子句/ 是/ 文字/ 的/ 析取/ 式/ ,/ 其中/ 带有/ 最/ 多/ 一个/ 正/ 文字/ ,/ 基于/ Horn/ 子句/ 进行/ 逻辑推理/ 可/ 得出/ 唯一/ 的/ 结论/ ,/ 且/ Horn/ 子句/ 可以/ 方便/ 地/ 转换/ 为/ 等价/ 的/ 逻辑/ 蕴含/ 式/ [/ 14/ ]/ ./ 因此/ ,/ 我们/ 将/ λ/ (/ t/ )/ 中/ 的/ 元组/ 标识/ (/ 正/ 文字/ )/ 作为/ 原子公式/ (/ 其/ 否定/ 也/ 是/ 原子公式/ )/ ,/ 为了/ 将/ 布尔/ 公式/ 转换/ 为/ 等价/ 的/ DAG/ ,/ 首先/ 将/ λ/ (/ t/ )/ →/ t/ 等价/ 地/ 转换/ 为/ Horn/ 子句/ 的/ 合取/ 式/ ,/ Horn/ 子句/ 的/ 集合/ 记/ 为/ Σ/ ./ 例/ 2/ ./ 例/ 1/ 中/ 的/ 世系/ 表达式/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ →/ 41/ ,/ 可/ 做/ 如下/ 转换/ :/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ →/ 41/ =/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ ∨/ 41/ =/ (/ (/ 11/ ∧/ 21/ )/ ∧/ (/ 12/ ∧/ 23/ )/ )/ ∨/ 41/ =/ (/ 11/ ∨/ 21/ ∨/ 41/ )/ ∧/ (/ 12/ ∨/ 23/ ∨/ 41/ )/ ,/ 转换/ 结果/ 为/ Horn/ 子句/ (/ 11/ ∨/ 21/ ∨/ 41/ )/ 和/ (/ 12/ ∨/ 23/ ∨/ 41/ )/ 的/ 合取/ 式/ ./ Page4/ 为了/ 将/ 世系/ 表达式/ 转换/ 为/ 满足条件/ 独立/ 语义/ 的/ DAG/ 模型/ ,/ 即用/ 图/ 模型表示/ 查询处理/ 中/ 数据/ 的/ 相互依赖/ 关系/ (/ 即/ 数据/ 的/ 相关性/ )/ ,/ 我们/ 将/ 其/ 称为/ 世系/ 依赖/ 模型/ ,/ 记为/ M/ Σ/ ./ 定义/ 2/ ./ 设/ F/ 为/ Σ/ 中/ 原子公式/ 的/ 集合/ ,/ X/ 和/ Y/ 分别/ 是/ Σ/ 中/ 两个/ 不/ 相交/ 的/ 原子公式/ 集/ ,/ X/ 和/ Y/ 对/ Z/ 独立/ ,/ 记/ 为/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ,/ Z/ =/ F/ \/ (/ X/ ∪/ Y/ )/ ,/ 如果/ (/ 1/ )/ 存在/ 一个/ Horn/ 子句/ 的/ 集合/ CS/ / Σ/ ,/ 使得/ F/ 中/ 包含/ 于/ CS/ 中/ 的/ 原子公式/ 也/ 包含/ X/ 和/ Y/ ;/ (/ 2/ )/ 不/ 存在/ Σ/ 中/ 的/ 任何/ 一个/ Horn/ 子句/ Ci/ ,/ 使得/ Ci/ 包含/ X/ 和/ Y/ ./ 例/ 3/ ./ 若/ Σ/ =/ (/ C1/ =/ A/ ∨/ B/ ∨/ C/ )/ ∧/ (/ C2/ =/ A/ ∨/ D/ )/ ∧/ (/ C3/ =/ B/ ∨/ D/ )/ ,/ S/ =/ {/ A/ ,/ B/ ,/ C/ ,/ D/ }/ ,/ 则/ 存在/ CS/ =/ {/ C1/ ,/ C2/ ,/ C3/ }/ ,/ 使得/ X/ =/ C/ ,/ Y/ =/ D/ ,/ 有/ {/ A/ ,/ B/ ,/ C/ ,/ D/ }/ / X/ ∪/ Y/ ,/ 且/ 不/ 存在/ 任何/ 一个/ Ci/ (/ i/ =/ 1/ ,/ 2/ ,/ 3/ )/ 包含/ X/ ∪/ Y/ ,/ 因此/ Z/ =/ S/ \/ (/ X/ ∪/ Y/ )/ =/ A/ ∪/ B/ ,/ 有/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ,/ 即/ 〈/ C/ |/ A/ ∪/ B/ |/ D/ 〉/ M/ Σ/ ./ 由/ 世系/ 表达式/ A1A2/ …/ An/ →/ B/ ,/ 可以/ 得到/ 等价/ 的/ Horn/ 子句/ Ci/ =/ (/ A1/ ∨/ A2/ ∨/ …/ ∨/ An/ ∨/ B/ )/ ,/ 其中/ B/ 为/ 查询处理/ 结果/ 元组/ 的/ 标识/ ,/ A1/ ,/ A2/ ,/ …/ ,/ An/ 为/ 输入/ 元组/ 的/ 标识/ ,/ 是/ Ci/ 中/ 依赖/ 关系/ 的/ 基础/ ./ 直观/ 地/ ,/ Ci/ 蕴含/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ →/ Ai/ (/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ )/ 和/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ →/ B/ ./ 因此/ ,/ 我们/ 将/ Ci/ =/ (/ A1/ ∨/ A2/ ∨/ …/ ∨/ An/ ∨/ B/ )/ 等价/ 地/ 转换/ 为/ Cj/ =/ (/ A1/ ∨/ A2/ ∨/ …/ ∨/ An/ ∨/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ ∨/ B/ )/ ,/ 将/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ 称为/ Cj/ 的/ 核/ ,/ 记为/ Corej/ ./ 为了/ 表示/ 的/ 方便/ ,/ 我们/ 用/ A1A2/ …/ An/ 表示/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ ./ Cj/ 的/ 世系/ 图/ (/ LG/ )/ G/ =/ (/ V/ ,/ E/ )/ ,/ 其中/ V/ 是/ 结点/ 的/ 集合/ ,/ E/ 是/ 有/ 向/ 边/ 的/ 集合/ ./ G/ 中/ 的/ 每个/ 结点/ 对应/ Cj/ 中/ 的/ 一个/ 原子公式/ 或/ 原子公式/ 的/ 合取/ 式/ ,/ 若/ Cj/ 蕴含/ X/ →/ Y/ ,/ 那么/ G/ 中/ 就/ 有/ 一条/ 从/ X/ 指向/ Y/ 的/ 有/ 向/ 边/ ./ 根据上述/ 思想/ ,/ Cj/ 可/ 转换/ 为/ 图/ 2/ 中/ 与/ 之/ 逻辑/ 上/ 等价/ 的/ G1/ 或/ G2/ ,/ 但是/ G1/ 不/ 满足/ PGM/ 的/ 条件/ 独立性/ ,/ 由/ 后续/ 讨论/ 可知/ G1/ 不是/ 一个/ 概率模型/ ./ 因此/ ,/ 我们/ 首先/ 针对/ 各/ Ci/ 构建/ 形如/ G2/ 的/ LG/ ,/ 然后/ 再/ 将/ 构建/ 的/ LG/ 进行/ 合并/ ,/ 下面/ 给出/ 构建/ LG/ 的/ 方法/ ./ 考虑/ 不确定性/ 数据/ 查询/ 本身/ 的/ 特征/ ,/ 连接/ 查询/ 的/ 安全性/ 决定/ 了/ 是否/ 可以/ 得到/ 正确/ 的/ 查询/ 结果/ 概率/ ,/ 不/ 安全/ (/ Unsafe/ )/ 的/ 数据/ 查询/ (/ 中间/ 结果/ 不/ 独立/ )/ 处理/ 是/ #/ P/ 困难/ 的/ 问题/ [/ 17/ ]/ ./ 以/ 两个/ x/ -/ relation/ 的/ 安全/ (/ Safe/ )/ 连接/ 查询/ 为/ 代表/ ,/ 如例/ 2/ 中/ 的/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ ,/ 基于/ 上述/ 构建/ LG/ 的/ 基本/ 思想/ ,/ 核/ 结点/ 中/ 包含/ 参与/ 连接/ 的/ 每个/ x/ -/ relation/ 中/ 的/ 元组/ ,/ 对应/ 于/ 查询处理/ 的/ 中间/ 结果/ ,/ 例如/ 11/ ∧/ 12/ 和/ 12/ ∧/ 23/ ,/ 各/ LG/ 中/ 的/ 核/ 结点/ 相互/ 独立/ ./ 然而/ ,/ 对于/ 形/ 如/ (/ 11/ ∨/ 13/ )/ ∧/ 23/ →/ 51/ 的/ 不/ 安全/ 查询/ ,/ 由/ 51/ 共同/ 指向/ 的/ 两个/ 核/ 结点/ 12/ ∧/ 23/ 和/ 13/ ∧/ 23/ 并/ 不/ 独立/ ,/ 这/ 与/ 概率模型/ 的/ 条件/ 独立性/ [/ 7/ ]/ 相/ 违背/ ./ 文献/ [/ 17/ ]/ 也/ 针对/ 引起/ 不/ 安全/ 的/ 数据/ 引入/ 了/ 符号/ 变量/ 、/ 给出/ 了/ 局部/ 世系/ 的/ 概念/ ,/ 用/ And/ -/ Or/ 图/ 描述/ 独立/ 关系/ 的/ 中间/ 结果/ ./ 因此/ ,/ 借鉴/ 这一/ 思路/ ,/ 为了/ 基于/ PGM/ 给出/ 一种/ 对于/ 安全/ 和/ 不/ 安全/ 连接/ 查询/ 都/ 适用/ 的/ 统一/ 世系/ 表示/ 机制/ ,/ 且/ 保证/ 图/ 模型/ 的/ 条件/ 独立性/ ,/ 我们/ 将/ 参与/ 某个/ 连接/ 查询/ 、/ 且/ 属于/ 同一个/ 的/ x/ -/ rela/ -/ tion/ 的/ 多个/ 元组/ 的/ 析取/ 式/ 视为/ 一个/ 整体/ 来/ 考虑/ ./ 定理/ 1/ ./ 对于/ 任意/ Si/ 与/ Sj/ (/ i/ ≠/ j/ ,/ Si/ ,/ Sj/ ∈/ 珚/ S/ )/ 连接/ 查询/ 的/ 世系/ 函数/ ∨/ i/ ,/ jtjl/ )/ )/ ,/ 令/ x/ =/ ti1/ ∨/ …/ ∨/ tik/ ,/ y/ =/ tj1/ ∨/ …/ ∨/ tjk/ ,/ 则/ LG/ 中/ 对应/ 于/ ∨/ i/ ,/ j/ 证明/ ./ 由于/ x/ 和/ y/ 分别/ 是/ 对/ Si/ 和/ Sj/ (/ i/ ≠/ j/ )/ 执行/ 选择/ 操作/ 的/ 结果/ ,/ x/ ∩/ y/ =/ / ,/ 则/ 对于/ 任意/ 两个/ 核/ 结点/ x1/ ∧/ y1/ 和/ x2/ ∧/ y2/ ,/ 由于/ x1/ ∩/ y1/ =/ / 且/ x2/ ∩/ y2/ =/ / ,/ 又/ 有/ x1/ ≠/ x2/ 且/ y1/ ≠/ y2/ ,/ 则/ 核/ 结点/ x1/ ∧/ y1/ 与/ x2/ ∧/ y2/ 相互/ 独立/ ./ 因此/ ,/ 我们/ 首先/ 按照/ 定理/ 1/ 对/ λ/ (/ t/ )/ →/ t/ 的/ Horn/ 子句/ 集/ 进行/ 预处理/ ,/ 例如/ (/ 11/ ∨/ 13/ )/ ∧/ 23/ →/ 51/ 对应/ 的/ Horn/ 子句/ 为/ x/ -/ ∨/ 23/ ∨/ 51/ (/ 其中/ x/ =/ 11/ ∨/ 13/ )/ ,/ 仍/ 将/ x/ 视为/ 原子公式/ ./ 然后/ ,/ 通过/ 算法/ 1/ 构建/ 各/ Horn/ 子句/ 对应/ 的/ LG/ ./ 算法/ 1/ ./ 对/ 每个/ Ci/ 构建/ LG/ ./ 输入/ :/ 世系/ 表达式/ λ/ (/ t/ )/ →/ t/ 输出/ :/ 各/ Ci/ 对应/ 的/ LGGi/ 步骤/ :/ 1/ ./ 初始化/ :/ 1.1/ ./ 将/ λ/ (/ t/ )/ →/ t/ 等价/ 地/ 转换/ 为/ 满足/ 定理/ 1/ 的/ Horn/ 子/ 1.2/ ./ 将/ 每个/ Ci/ =/ (/ A1/ ∨/ A2/ ∨/ …/ ∨/ An/ ∨/ B/ )/ 等价/ 转换/ 为/ 2/ ./ 对/ Σ/ 中/ 的/ 每/ 一个/ Horn/ 子句/ ,/ 构建/ 相应/ 的/ LG/ :/ 2.1/ ./ 针对/ Cj/ =/ (/ A1/ ∨/ A2/ ∨/ …/ ∨/ An/ ∨/ A1/ ∧/ A2/ ∧/ …/ ∧/ An/ ∨/ Page52/ ./ 2/ ./ 针对/ Ck/ =/ (/ Ai/ ∨/ B/ )/ ,/ 构建/ 形如图/ 3/ (/ b/ )/ 中/ 的/ G2/ ./ 例/ 4/ ./ 针对/ 世系/ 表达式/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ →/ 41/ 对应/ 的/ Horn/ 子句/ (/ 11/ ∨/ 21/ ∨/ 41/ )/ 和/ (/ 12/ ∨/ 23/ ∨/ 41/ )/ ,/ 分别/ 构建/ 如图/ 4/ (/ a/ )/ 和/ 图/ 4/ (/ b/ )/ 的/ LG/ ./ 注意/ 到/ ,/ 指向/ 核/ 的/ 结点/ 包括/ 两类/ 原子公式/ 对应/ 的/ 结点/ :/ 连接/ 所/ 涉及/ x/ -/ relation/ 中/ 的/ 元组/ 标识/ 的/ 否定/ 以及/ 查询/ 结果/ 元组/ 标识/ 的/ 否定/ ./ 为了/ 计算结果/ 元组/ t/ 的/ 概率/ ,/ 需/ 考虑/ Σ/ 中/ 的/ 所有/ Horn/ 子句/ (/ 具有/ 合取/ 关系/ )/ ,/ 即/ 需/ 将/ 各/ Ci/ 对应/ 的/ LG/ 合并/ 为/ 一个/ 全局/ LG/ ./ 合并/ Gk/ 和/ Gl/ 的/ 基本/ 思想/ 如下/ :/ (/ 1/ )/ 对于/ 查询/ 结果/ 元组/ t/ ,/ 存在/ t/ -/ →/ Corei/ 和/ t/ -/ →/ Corej/ ,/ 为了/ 方便/ 计算/ t/ 的/ 概率/ ,/ 我们/ 将/ t/ -/ →/ Corei/ 和/ t/ -/ →/ Corej/ 分别/ 等价/ 转换/ 为/ Corei/ →/ t/ 和/ Corej/ →/ t/ ,/ 并/ 引入/ 结点/ ⊥/ 、/ Corei/ 和/ Corej/ ,/ ⊥/ =/ Corei/ ∧/ Corei/ ,/ ⊥/ 分别/ 指向/ Corei/ 和/ Corei/ ./ (/ 2/ )/ 将/ Gk/ 和/ Gl/ 中/ 的/ 两个/ ⊥/ 合并/ 为/ 一个/ ⊥/ ,/ 并/ 指向/ 原/ ⊥/ 所/ 指向/ 的/ 所有/ 结点/ ./ (/ 3/ )/ 将/ Gk/ 和/ Gl/ 中/ 的/ 两个/ t/ 合并/ 为/ 一个/ t/ ,/ 并/ 将/ 原来/ 指向/ t/ 的/ 所有/ 结点/ 指向/ 合并/ 后/ 的/ t/ ./ 需要/ 说明/ 的/ 是/ ,/ 对/ 任意/ Gk/ 和/ Gl/ ,/ 由/ 定理/ 1/ 可知/ ,/ 不/ 可能/ 存在/ 相同/ 的/ Ai/ 分别/ 指向/ Gk/ 和/ Gl/ 的/ 核/ 结点/ ./ 引入/ 的/ 结点/ ⊥/ =/ Corei/ ∧/ Corei/ 恒为/ False/ (/ 即/ 0/ )/ ,/ 则/ ⊥/ →/ Corei/ 和/ ⊥/ →/ Corei/ 都/ 恒为/ True/ (/ 即/ 1/ )/ ,/ 因此/ 引入/ ⊥/ 保证/ 了/ Horn/ 子句/ 逻辑/ 上/ 的/ 等价/ 性/ ./ 例/ 5/ ./ 根据上述/ 思想/ 对图/ 4/ (/ a/ )/ 和/ 图/ 4/ (/ b/ )/ 的/ LG/ 进行/ 合并/ ,/ 可以/ 得到/ 如图/ 5/ 所示/ 的/ 全局/ LG/ ./ 若/ |/ Σ/ |/ 为/ Horn/ 子句/ 的/ 个数/ ,/ 每个/ Horn/ 子句/ 至多/ 包含/ n/ 个/ 原子公式/ ,/ 则/ 算法/ 1/ 的/ 计算/ 时间/ 为/ O/ (/ |/ Σ/ |/ ·/ n/ )/ ,/ 对/ 各/ LG/ 进行/ 合并/ 的/ 计算/ 时间/ 为/ O/ (/ |/ Σ/ |/ )/ ./ 因此/ ,/ 我们/ 可以/ 在/ 多项式/ 时间/ 内/ 高效/ 地/ 构建/ LG/ ./ 如前所述/ ,/ 只有/ LG/ 反映/ 了/ Σ/ 中/ 数据/ 的/ 条件/ 独立性/ ,/ 才/ 可能/ 作为/ 拟/ 构建/ BN/ 的/ 图/ 结构/ ./ d/ -/ 分离/ [/ 7/ -/ 8/ ]/ 是/ 用/ DAG/ 模型/ 中/ 描述/ 变量/ 间/ 条件/ 独立性/ 的/ 基本概念/ ,/ 下面/ 首先/ 给出/ d/ -/ 分离/ 的/ 定义/ ,/ 进而/ 讨论/ LG/ 的/ d/ -/ 分离/ 性质/ ,/ 证明/ LG/ 即为/ 定义/ 2/ 中/ 的/ 依赖/ 模型/ M/ Σ/ ./ 定义/ 3/ [/ 7/ -/ 8/ ]/ ./ 设/ X/ ,/ Y/ 和/ Z/ 是/ DAGG/ =/ (/ V/ ,/ E/ )/ 中/ 不/ 相交/ 的/ 结点/ 集/ ,/ 称/ X/ 和/ Y/ 对于/ Z/ 是/ d/ -/ 分离/ 的/ ,/ 记/ 为/ 〈/ X/ |/ Z/ |/ Y/ 〉/ G/ ,/ 当且/ 仅/ 当/ 从/ X/ 中/ 结点/ 到/ Y/ 中/ 结点/ 的/ 路/ 都/ 不能/ 被/ Z/ 激活/ ./ DAG/ 中/ 一条/ 路/ 被/ 结点/ 集/ Z/ 激活/ ,/ 如果/ 它/ 满足/ :/ (/ 1/ )/ 路上/ 的/ 每个/ 汇聚/ 结点/ (/ 即/ 两条/ 有/ 向/ 边/ 指向/ 的/ 公共/ 结点/ )/ 都/ 在/ Z/ 中/ ,/ 或者/ 存在/ 一条/ 从/ 汇聚/ 结点/ 到/ Z/ 中/ 的/ 结点/ 有/ 向/ 路/ ;/ (/ 2/ )/ 路上/ 的/ 非/ 汇聚/ 结点/ 都/ 不/ 在/ Z/ 中/ ./ 引理/ 1/ ./ 设/ α/ 和/ β/ 是/ LG/ 中/ 的/ 两个/ 非核/ 结点/ ,/ 如果/ α/ 和/ β/ 包含/ 于/ 某个/ 含有/ α/ 的/ Horn/ 子句/ Ci/ 对应/ 的/ 子/ 图/ G/ α/ 中/ ,/ 则/ 〈/ α/ |/ V/ -/ α/ -/ β/ |/ β/ 〉/ G/ 不/ 成立/ ./ 证明/ ./ 由/ 算法/ 1/ 和/ LG/ 的/ 合并/ 策略/ 可知/ ,/ 存在/ 从/ α/ 到/ β/ 的/ 路/ 包含/ 了/ 核/ 结点/ Core/ α/ ,/ 该核/ 结点/ 在/ 带有/ 汇聚/ 边/ 的/ G/ α/ 中/ ./ 由/ 定义/ 3/ ,/ 由于/ Core/ α/ ∈/ V/ -/ α/ -/ β/ ,/ 因此/ 〈/ α/ |/ V/ -/ α/ -/ β/ |/ β/ 〉/ G/ 不/ 成立/ ./ 引理/ 2/ ./ 设/ α/ 和/ β/ 是/ LG/ 中/ 的/ 两个/ 非核/ 结点/ ,/ 如果/ α/ 和/ β/ 不/ 被/ 包含/ 于/ 某个/ 含有/ α/ 的/ Horn/ 子句/ Ci/ 对应/ 的/ 子/ 图/ G/ α/ 中/ ,/ 则/ 〈/ α/ |/ V/ -/ α/ -/ β/ |/ β/ 〉/ G/ 成立/ ./ 证明/ ./ 由/ 算法/ 1/ 和/ LG/ 的/ 合并/ 策略/ 可知/ ,/ α/ 和/ β/ 之间/ 任意/ 一条/ 路/ ri/ 必/ 包含/ 子图/ G/ α/ 和/ G/ β/ 的/ 核/ 结点/ Core/ α/ 和/ Core/ β/ ./ (/ 1/ )/ 若/ ri/ 包含/ ⊥/ ,/ 注意/ 到/ ⊥/ 是非/ 汇聚/ 结点/ 且/ ⊥/ ∈/ V/ -/ α/ -/ β/ ,/ 由/ 定义/ 3/ ,/ ri/ 不能/ 被/ V/ -/ α/ -/ β/ 激活/ ./ (/ 2/ )/ 若/ ri/ 包含/ Core/ α/ 和/ Core/ β/ ,/ 由于/ Core/ α/ 和/ Core/ β/ 不/ 相邻/ ,/ 则/ ri/ 中必/ 存在/ 非核/ 结点/ θ/ (/ θ/ ∈/ V/ -/ α/ -/ β/ )/ 为/ 非/ 汇聚/ 结点/ ,/ 由/ 定义/ 3/ ,/ ri/ 不能/ 被/ V/ -/ α/ -/ β/ 激活/ ./ 因此/ ,/ 〈/ α/ |/ V/ -/ α/ -/ β/ |/ β/ 〉/ G/ 成立/ ./ Page6/ 由/ 引理/ 1/ 和/ 引理/ 2/ ,/ 可以/ 容易/ 地/ 得出结论/ :/ LG/ 即为/ 定义/ 2/ 中/ 的/ 依赖/ 模型/ M/ Σ/ ,/ 如/ 定理/ 2/ 所述/ ./ 定理/ 2/ ./ 设/ Σ/ 为/ 世系/ 表达式/ 所/ 对应/ Horn/ 子句/ 的/ 集合/ ,/ G/ 为/ 相应/ 的/ LG/ ,/ X/ 和/ Y/ 是/ Σ/ 中/ 两个/ 不/ 相交/ 的/ 原子公式/ 集/ ,/ Z/ =/ F/ \/ X/ ∪/ Y/ ,/ F/ 为/ Σ/ 中/ 原子公式/ 的/ 集合/ ./ 设/ / ,/ / 和/ / =/ V/ -/ / -/ / 为/ G/ 中/ 与/ X/ ,/ Y/ 和/ Z/ 对应/ 的/ 结点/ 集/ ./ 若/ 〈/ / |/ / |/ / 〉/ G/ 成立/ ,/ 则/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ 成立/ ;/ 若/ 〈/ / |/ / |/ / 〉/ G/ 不/ 成立/ ,/ 则/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ 也/ 不/ 成立/ ./ 即/ 〈/ / |/ V/ -/ / -/ / |/ / 〉/ G/ / 〈/ X/ |/ F/ -/ X/ -/ Y/ |/ Y/ 〉/ M/ Σ/ ./ 2.1/ ./ 2/ 依赖/ 模型/ 的/ 概率/ 语义/ 由/ PGM/ 的/ 定义/ 可知/ ,/ 仅当/ 依赖/ 模型/ 为/ 一个/ 概率模型/ ,/ 才能/ 基于/ 该/ 模型/ 进行/ 概率/ 推理/ [/ 7/ -/ 8/ ]/ ./ 也就是说/ ,/ 只有/ 有/ 向/ 无/ 环图/ LG/ 仍为/ 一个/ 概率模型/ ,/ 才/ 可/ 基于/ LG/ 进行/ 概率/ 推理/ ,/ 进而/ 得到/ 结果/ 元组/ t/ 的/ 概率/ ./ Pearl/ [/ 7/ ]/ 已经/ 证明/ 了/ 依赖/ 模型/ 作为/ 概率模型/ 的/ 必要条件/ :/ 对称/ 律/ 、/ 分解/ 律/ 、/ 弱/ 归并/ 律/ 、/ 收缩/ 律/ 和/ 相交/ 律/ ./ 定理/ 3/ 给出/ 了/ 依赖/ 模型/ LG/ 所/ 满足/ 的/ 概率模型/ 条件/ ./ 定理/ 3/ ./ 设/ Σ/ 为/ 世系/ 表达式/ 所/ 对应/ Horn/ 子句/ 的/ 集合/ ,/ X/ ,/ Y/ 和/ Z/ 是/ Σ/ 中/ 3/ 个/ 不/ 相交/ 的/ 原子公式/ 集/ ./ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ 满足/ 如下/ 独立/ 条件/ :/ 〈/ X/ |/ Z/ |/ W/ 〉/ M/ Σ/ ;/ Y/ 〉/ M/ Σ/ ;/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ ;/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ ./ (/ 1/ )/ 对称/ 律/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ / 〈/ Y/ |/ Z/ |/ X/ 〉/ M/ Σ/ ;/ (/ 2/ )/ 分解/ 律/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ∧/ (/ 3/ )/ 弱/ 归并/ 律/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ ∪/ W/ |/ (/ 4/ )/ 收缩/ 律/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ / (/ 5/ )/ 相交/ 律/ 〈/ X/ |/ Z/ ∪/ W/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ / 证明/ ./ (/ 1/ )/ 由/ 独立/ 表达式/ 可知/ ,/ 对称/ 律/ 成立/ ./ (/ 2/ )/ 假设/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ 成立/ ,/ 由/ 定义/ 2/ 可知/ ,/ Σ/ 中/ 存在/ 3/ 个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ,/ F2/ / Y/ ∪/ Z/ ,/ F3/ / W/ ∪/ Z/ ,/ 而/ 不/ 存在/ Ci/ / x/ ,/ y/ (/ 或/ Ci/ / x/ ,/ w/ )/ ,/ 其中/ x/ ,/ y/ 和/ w/ 分别/ 为/ X/ ,/ Y/ 和/ W/ 中/ 的/ 原子公式/ ./ 根据/ 定义/ 2/ ,/ 如果/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ 且/ 〈/ X/ |/ Z/ |/ W/ 〉/ M/ Σ/ 成立/ ,/ 则/ Σ/ 中/ 存在/ F1/ / X/ ∪/ Z/ ,/ F2/ / Y/ ∪/ Z/ ,/ F3/ / W/ ∪/ Z/ ,/ 而/ 不/ 存在/ Cj/ / x/ ,/ y/ ,/ Ck/ / x/ ,/ w/ ./ 注意/ 到/ ,/ Σ/ 中/ 不/ 存在/ 这样/ 的/ Ci/ ,/ Cj/ 和/ Ck/ ,/ 因此/ F1/ =/ F1/ ,/ F2/ =/ F2/ ,/ F3/ =/ F3/ ,/ 进而/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ∧/ 〈/ X/ |/ Z/ |/ W/ 〉/ M/ Σ/ 成立/ ./ (/ 3/ )/ 由/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ 可知/ ,/ Σ/ 中/ 存在/ 3/ 个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ,/ F2/ / Z/ ∪/ Y/ ,/ F3/ / Z/ ∪/ W/ ,/ 而/ 不/ 存在/ Ci/ / x/ ,/ y/ (/ 或/ Ci/ / x/ ,/ w/ )/ ./ 根据/ 定义/ 2/ ,/ 若/ 〈/ X/ |/ Z/ ∪/ W/ |/ Y/ 〉/ M/ Σ/ 成立/ ,/ 则/ Σ/ 中/ 存在/ 两个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ∪/ W/ ,/ F2/ / Z/ ∪/ W/ ∪/ Y/ ,/ 而/ 不/ 存在/ Cj/ / x/ ,/ y/ ./ 若/ F1/ 和/ F3/ 为/ Σ/ 中/ 的/ Horn/ 子句/ 集/ ,/ 那么/ F1/ 也/ 是/ 一个/ Horn/ 子句/ 集/ ;/ 若/ F2/ 和/ F3/ 为/ Σ/ 中/ 的/ Horn/ 子句/ 集/ ,/ 那么/ F2/ 也/ 是/ 一个/ Horn/ 子句/ 集/ ./ 由于/ Ci/ 不/ 存在/ ,/ Cj/ 也/ 不/ 存在/ ./ 因此/ ,/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ ∪/ W/ |/ Y/ 〉/ M/ Σ/ 成立/ ./ (/ 4/ )/ 由/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ 可知/ ,/ Σ/ 中/ 存在/ 4/ 个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ,/ F2/ / Y/ ∪/ Z/ ,/ F3/ / X/ ∪/ Z/ ∪/ Y/ ,/ F4/ / Z/ ∪/ Y/ ∪/ W/ ,/ 而/ 不/ 存在/ Ci/ / x/ ,/ y/ ,/ Cj/ / x/ ,/ w/ ./ 根据/ 定义/ 2/ ,/ 如果/ 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ 成立/ ,/ 则/ Σ/ 中/ 存在/ 两个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ,/ F2/ / Z/ ∪/ Y/ ∪/ W/ ,/ 而/ 不/ 存在/ Ck/ / x/ ,/ y/ (/ 或/ Ck/ / x/ ,/ w/ )/ ./ 注意/ 到/ F1/ =/ F1/ ,/ F4/ =/ F2/ ,/ 由于/ Σ/ 中/ 不/ 包含/ Ci/ 和/ Cj/ ,/ 则/ Σ/ 中/ 不/ 包含/ Ck/ ./ 因此/ ,/ 〈/ X/ |/ Z/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ 成立/ ./ (/ 5/ )/ 由/ 〈/ X/ |/ Z/ ∪/ W/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ 可知/ ,/ Σ/ 中/ 存在/ 3/ 个/ Horn/ 子句/ 的/ 集合/ F1/ / X/ ∪/ Z/ ∪/ W/ ,/ F2/ / Z/ ∪/ W/ ∪/ Y/ ,/ F3/ / X/ ∪/ Z/ ∪/ Y/ ,/ 而/ 不/ 存在/ Ci/ / x/ ,/ y/ ,/ Cj/ / x/ ,/ w/ ./ 注意/ 到/ F1/ / F1/ ,/ F2/ =/ F2/ ,/ 由于/ Σ/ 中/ 不/ 包含/ Ci/ 和/ Cj/ ,/ 则/ Σ/ 中/ 不/ 包含/ Ck/ ./ 因此/ ,/ 〈/ X/ |/ Z/ ∪/ W/ |/ Y/ 〉/ M/ Σ/ ∨/ 〈/ X/ |/ Z/ ∪/ Y/ |/ W/ 〉/ M/ Σ/ / 〈/ X/ |/ Z/ |/ Y/ ∪/ W/ 〉/ M/ Σ/ 成立/ ./ 由/ 定理/ 3/ 可/ 得出结论/ :/ 依赖/ 模型/ LG/ 满足/ 概率模型/ 的/ 条件/ ,/ LG/ 既/ 等价/ 地/ 反映/ 了/ λ/ (/ t/ )/ →/ t/ 中/ 的/ 逻辑/ 语义/ ,/ 也/ 等价/ 地/ 反映/ 了/ 其中/ 蕴含/ 的/ 概率/ 独立/ 语义/ ./ 上述/ 讨论/ 从/ 理论/ 上/ 保证/ 了/ 所/ 构建/ 的/ LG/ 为/ PGM/ ,/ 我们/ 以/ LG/ 作为/ BN/ 的/ DAG/ 结构/ ./ 2.2/ 计算/ 贝叶斯/ 网/ 的/ 概率/ 参数/ 为了/ 计算/ LG/ 中/ 各/ 结点/ 的/ CPT/ ,/ 与/ 输入/ x/ -/ relation/ 中/ 相关/ 元组/ 对应/ 的/ 结点/ (/ 即/ 无/ 父亲/ 的/ 结点/ )/ ,/ 我们/ 直接/ 由/ 输入/ 的/ x/ -/ relation/ 计算/ 得到/ ,/ 例如/ :/ 基于/ 图/ 1/ 中/ 的/ 不确定性/ 数据/ ,/ 可/ 得到/ P/ (/ 11/ =/ 1/ )/ =/ 0.2/ ./ 而/ 计算/ 对应/ 于/ 查询处理/ 中间/ 结果/ 的/ 各/ 结点/ 的/ CPT/ ,/ 是/ 本节/ 讨论/ 的/ 重点/ ./ 根据/ LG/ 的/ 构建/ 及/ 合并/ 方法/ ,/ 不难看出/ ,/ LG/ 具有/ 如下/ 性质/ :/ (/ 1/ )/ 为了/ 合并/ 各/ Horn/ 子句/ 所/ 对应/ 的/ LG/ ,/ 我们/ 引入/ 了/ 保证/ 逻辑/ 上/ 等价/ 的/ ⊥/ 结点/ ,/ 而/ 这类/ 结点/ 对于/ 描述/ λ/ (/ t/ )/ 中/ 表达/ 的/ 连接/ 查询/ 、/ 计算结果/ 元组/ t/ 的/ 概率/ ,/ 并/ 不/ 产生/ 直接/ 影响/ ./ 因此/ ,/ 在/ CPT/ 计算/ 和/ 概率/ 推理/ 时/ ,/ 我们/ 将/ 忽略/ LG/ 中/ 的/ ⊥/ 结点/ ,/ 图/ 6/ 给出/ 了/ 忽略/ 图/ 5/ 中/ ⊥/ 结点/ 后/ 的/ LG/ 形式/ ./ (/ 2/ )/ 全局/ LG/ 中/ ,/ 除/ ⊥/ 结点/ 之外/ ,/ 无/ 父亲/ 的/ 结点/ 对应/ 于/ x/ -/ relation/ 中/ 的/ 输入/ 元组/ ,/ 无/ 孩子/ 的/ 结点/ 对/ Page7/ 应于/ 查询/ 结果/ 元组/ t/ ,/ 其它/ 结点/ 对应/ 于/ 查询处理/ 的/ 中间/ 结果/ 且/ 相互/ 独立/ (/ 如/ 定理/ 1/ 所述/ )/ ./ (/ 3/ )/ 对于/ 涉及/ 多个/ x/ -/ relation/ 的/ 连接/ 查询/ ,/ 多个/ 父亲/ 结点/ 与其/ 共同/ 孩子/ 结点/ 之间/ 为/ 逻辑/ “/ 或/ (/ OR/ )/ ”/ 的/ 关系/ ./ 例如/ ,/ 图/ 5/ 中/ 的/ LG/ 包含/ 如下/ “/ 或/ ”/ 关系/ :/ 11/ ∨/ 21/ →/ 11/ ∧/ 21/ 和/ (/ 11/ ∧/ 21/ )/ ∨/ (/ 12/ ∧/ 23/ )/ →/ 41/ ./ BN/ 的/ 概率/ 推理/ 基于/ DAG/ 结构/ 和/ CPT/ 、/ 通过/ 信念/ 传播/ (/ Beliefpropagation/ )/ 完成/ [/ 7/ -/ 8/ ]/ ./ 因此/ ,/ 为了/ 构图/ 7LG/ 的/ CPT/ 基于/ 世系/ 表达式/ 和/ 输入/ 的/ 不确定性/ 数据/ ,/ 2.1/ 节/ 和/ 2.2/ 节/ 分别/ 给出/ 了/ 构建/ DAG/ 概率/ 依赖/ 模型/ 、/ 计算/ 结点/ 概率/ 参数/ 的/ 方法/ ,/ 从而/ 构建/ 了/ 描述/ 世系/ 表达式/ 中/ 所/ 涉及/ 数据/ 间/ 相互依赖/ 关系/ 的/ PGM/ ,/ 我们/ 将/ 其/ 称为/ 世系/ 贝叶斯/ 网/ (/ LineageBayesianNetwork/ ,/ LBN/ )/ ,/ 为/ 世系/ 分析/ 提供/ 了/ 有效/ 的/ 概率/ 推理模型/ 基础/ ./ 3/ 案例/ 研究/ 针对/ 文献/ [/ 6/ ]/ 中/ 的/ 经典/ 案例/ ,/ 即/ 本文/ 图/ 1/ 中/ 的/ 不确定性/ 数据/ 和/ 例/ 1/ 中/ 的/ 世系/ 表达式/ (/ 11/ ∧/ 21/ )/ ∨/ 建/ 中间/ 结点/ 的/ CPT/ ,/ 体现/ 父子/ 结点/ 取值/ 之间/ 的/ “/ 或/ ”/ 关系/ ,/ 我们/ 借鉴/ 文献/ [/ 11/ ]/ 中/ “/ 因子/ (/ Factor/ )/ ”/ 参数/ 的/ 概念/ ,/ 给出/ 通过/ 父亲/ 结点/ 取值/ 来/ 导出/ 孩子/ 结点/ 取值/ 的/ 函数/ ,/ 并/ 反映/ 基于/ DAG/ 进行/ 信念/ 传播/ 的/ 思想/ ,/ 将/ 其/ 称为/ 概率/ 参数/ 函数/ ./ 定义/ 4/ ./ 设/ A/ 为/ LG/ 中/ 任意/ 存在/ 父亲/ 的/ 结点/ ,/ A/ 的/ 概率/ 参数/ 函数/ 定义/ 为/ P/ (/ A/ =/ a/ |/ 犘/ 犪/ (/ 犃/ )/ =/ (/ a1/ ,/ a2/ ,/ …/ ,/ am/ )/ )/ =/ fOR/ 其中/ :/ 犘/ 犪/ (/ 犃/ )/ =/ A1/ ,/ A2/ ,/ …/ ,/ Am/ ,/ 为/ A/ 的/ 父亲/ 结点/ 集/ ,/ a/ ,/ a1/ ,/ a2/ ,/ …/ ,/ am/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 分别/ 为/ A/ ,/ A1/ ,/ A2/ ,/ …/ ,/ Am/ 的/ 取值/ ,/ P/ (/ A/ =/ a/ |/ 犘/ 犪/ (/ 犃/ )/ =/ (/ a1/ ,/ a2/ ,/ …/ ,/ am/ )/ )/ ∈/ {/ 0/ ,/ 1/ }/ ./ 例/ 6/ ./ 对于/ 表示/ 为/ 图/ 5/ 的/ LG/ ,/ 根据/ 定义/ 4/ ,/ 我们/ 分别/ 定义/ fOR12/ ∧/ 23/ ,/ 12/ ,/ 23/ ,/ fORfOR/ 所示/ ./ (/ 12/ ∧/ 23/ )/ →/ 41/ ,/ 基于/ 本文/ 中/ 基于/ PGM/ 的/ 世系/ 表示/ 方法/ ,/ LBN/ 的/ DAG/ 和/ CPT/ 分别/ 如图/ 6/ 和/ 图/ 7/ 所示/ ,/ 本/ 节/ 给出/ 将/ 所/ 构建/ 的/ LBN/ 应用/ 于/ 世系/ 概率/ 计算/ 的/ 案例/ ./ 需要/ 计算结果/ 元组/ 41/ 的/ 概率/ ,/ 即/ 变量/ 41/ 取值/ 为/ 1/ (/ True/ )/ 时/ 的/ 边缘/ 概率分布/ P/ (/ 41/ =/ 1/ )/ ,/ 基于/ LBN/ 可以/ 得到/ 如下/ 计算公式/ (/ 由于/ 篇幅/ 的/ 限制/ ,/ 我们/ 忽略/ 了/ 值/ 为/ 0/ 的/ 所有/ 项/ )/ :/ P/ (/ 41/ =/ 1/ )/ =/ ∑/ 11/ ∑/ 21/ ∑/ 12/ ∑/ 23/ ∑/ 11/ ∧/ 21/ ∑/ 12/ ∧/ 23P/ (/ 23/ )/ ·/ P/ (/ 11/ ∧/ 21/ |/ 11/ ,/ 21/ )/ ·/ P/ (/ 12/ ∧/ 23/ |/ 12/ ,/ 23/ )/ ·/ P/ (/ 41/ =/ 1/ |/ 11/ ∧/ 21/ ,/ 12/ ∧/ 23/ )/ =/ Page80/ ./ 8/ ×/ 0.8/ ×/ 0.7/ ×/ 0.9/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.8/ ×/ 0.8/ ×/ 0.7/ ×/ 0.1/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.8/ ×/ 0.8/ ×/ 0.3/ ×/ 0.9/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.8/ ×/ 0.8/ ×/ 0.3/ ×/ 0.1/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.8/ ×/ 0.2/ ×/ 0.7/ ×/ 0.9/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.2/ ×/ 0.8/ ×/ 0.7/ ×/ 0.9/ ×/ 1/ ×/ 1/ ×/ 1/ +/ …/ +/ 0.2/ ×/ 0.2/ ×/ 0.7/ ×/ 0.9/ ×/ 1/ ×/ 1/ ×/ 1/ =/ 0.8668/ ./ 可见/ ,/ 基于/ LBN/ 的/ 世系/ 概率/ 计算结果/ 与/ 文献/ [/ 6/ ]/ 中/ 的/ 结果/ 相同/ ,/ 这/ 从/ 一定/ 程度/ 上/ 验证/ 了/ 本文/ 基于/ PGM/ 的/ 不确定性/ 数据/ 世系/ 表示/ 方法/ 是/ 正确/ 的/ 、/ 可行/ 的/ ./ 同时/ ,/ 由/ 以上/ P/ (/ 41/ =/ 1/ )/ 的/ 计算/ 过程/ 不难看出/ ,/ 相对/ 于/ 直接/ 基于/ 可能/ 世界/ 的/ 方法/ ,/ LBN/ 中/ 变量/ 间/ 的/ 条件/ 独立性/ 使得/ 边缘/ 概率/ 的/ 计算/ 得到/ 很大/ 程度/ 的/ 简化/ ,/ 大大减少/ 了/ 所/ 涉及/ 概率分布/ 的/ 数量/ ,/ 这/ 正是/ 基于/ PGM/ 进行/ 世系/ 分析/ 的/ 优势/ 所在/ ./ 4/ 实验/ 结果/ 第/ 2/ 节/ 给出/ 了/ LBN/ 构建/ 算法/ 的/ 时间/ 复杂度/ 分析/ 和/ LBN/ 作为/ PGM/ 的/ 正确性/ 证明/ ,/ 除此之外/ ,/ 为了/ 进一步/ 测试/ 本文/ 方法/ 的/ 有效性/ ,/ 我们/ 实现/ 了/ LBN/ 构建/ 以及/ 基于/ LBN/ 的/ 世系/ 概率/ 计算方法/ ,/ 测试/ 了/ LBN/ 构建/ 方法/ 的/ 效率/ 、/ 基于/ LBN/ 表示/ 世系/ 的/ 空间/ 开销/ 以及/ 基于/ LBN/ 进行/ 世系/ 概率/ 计算/ 的/ 性能/ ./ 实验/ 环境/ 如下/ :/ IntelPentium/ (/ R/ )/ Dual/ -/ Core3/ ./ 00GHz/ 处理器/ ,/ 2GB/ 内存/ ,/ WindowXPProfessional/ 操作系统/ ,/ 使用/ MySQL5/ ./ 1/ 存储/ 不确定性/ 数据/ 和/ LBN/ 的/ CPT/ ,/ 使用/ Java/ 语言/ 编写程序/ ./ 首先/ ,/ 我们/ 基于/ TPC/ -/ H/ 基准/ 数据/ 集/ [/ 18/ ]/ 中/ 的/ Orders/ 表/ 和/ Lineitems/ 表/ (/ 分别/ 简记/ 为/ O/ 和/ L/ )/ ,/ 针对/ O/ 和/ L/ 的/ 一对一/ 、/ 一对/ 多/ 和/ 多/ 对/ 多/ 连接/ 查询/ ,/ 测试/ 了/ 连接/ 所/ 涉及/ 元组/ 总数/ 增加/ 时/ 构建/ LBN/ 的/ 效率/ ,/ 如图/ 8/ 所示/ ./ 可以/ 看出/ ,/ 构建/ LBN/ 所需/ 时间/ 对/ 元组/ 总数/ 并/ 不/ 敏感/ ./ 元组/ 数量/ 相同/ 时/ ,/ 多/ 对/ 多/ 情形/ 下/ 构建/ LBN/ 耗时/ 最/ 多/ ,/ 一对一/ 情形/ 下/ 耗时/ 最少/ ,/ 因为/ 需要/ 针对/ 一对/ 多/ 和/ 多/ 对/ 多/ 的/ 情形/ 进行/ 如/ 定理/ 1/ 所/ 描述/ 的/ 预处理/ ,/ 这/ 成为/ 了/ 影响/ LBN/ 构建/ 效率/ 的/ 瓶颈/ ./ 然后/ ,/ 我们/ 测试/ 了/ 用/ LBN/ 表示/ 不确定性/ 数据/ 连接/ 查询/ 世系/ 的/ 空间/ 开销/ ,/ 并/ 与/ 直接/ 基于/ 布尔/ 公式/ 的/ 世系/ 表示/ 的/ 空间/ 开销/ 进行/ 了/ 比较/ ./ 基于/ 本文/ 第/ 2/ 节中/ 的/ 从/ Horn/ 子句/ 到/ DAG/ 的/ 转换/ 、/ DAG/ 的/ 合并/ 等/ 步骤/ ,/ 我们/ 可/ 得到/ 表示/ 给定/ 世系/ 表达式/ 的/ LBN/ ,/ 作为/ 最终/ 表示/ 世系/ 信息/ 的/ 概率/ 图/ 模型/ ./ 我们/ 将/ 表示/ 世系/ 的/ 布尔/ 公式/ 及/ 相应/ LBN/ 的/ DAG/ 结构/ 存储/ 在/ 文件/ 中/ ,/ 测试/ 了/ 连接/ 操作/ 所/ 涉及/ 元组/ 总数/ 增加/ 时/ 文件大小/ 增加/ 的/ 趋势/ ,/ 如图/ 9/ 所示/ (/ 采用/ 了/ 对数/ 刻度/ )/ ./ 可以/ 看出/ ,/ 对于/ 表示/ 同一/ 世系/ 信息/ 的/ 布尔/ 公式/ 和/ LBN/ ,/ 后者/ 所/ 耗费/ 的/ 空间/ 远远/ 高于/ 前者/ ,/ 这/ 与/ 布尔/ 公式/ 及/ LBN/ 本身/ 的/ 表示/ 机制/ 而/ 导致/ 的/ 空间/ 开销/ 差异/ 相一致/ ,/ 因为/ 后者/ 不仅/ 需要/ 描述/ 参与/ 连接/ 查询/ 的/ 输入/ 元组/ 、/ 中间/ 结果/ 和/ 结果/ 元组/ ,/ 并且/ 还要/ 以/ DAG/ 描述/ 它们/ 之间/ 的/ 相互/ 关系/ ./ 然而/ ,/ 基于/ 构建/ 得到/ 的/ LBN/ 可/ 进行/ 任意/ 正确/ 、/ 高效/ 的/ 概率/ 推理/ ,/ 而/ 不/ 需/ 在/ 每次/ 世系/ 分析/ 时/ 都/ 为/ 给定/ 的/ 布尔/ 公式/ 构建/ 支持/ 概率/ 计算/ 的/ 模型/ ,/ 因此/ ,/ LBN/ 与/ 给定/ 的/ 世系/ 表达式/ 一一对应/ ,/ LBN/ 的/ 空间/ 开销/ 保证/ 了/ 方法/ 统一/ 且/ 处理/ 高效/ 的/ 世系/ 分析/ ./ 接着/ ,/ 我们/ 分别/ 考虑/ O/ 表/ 和/ L/ 表/ 的/ 一对/ 多/ 和/ 多/ 对/ 多/ 连接/ 查询/ 且/ 查询/ 结果/ 中/ 只/ 包含/ 1/ 个/ 元组/ 的/ 情形/ ,/ 测试/ 了/ 世系/ 概率/ 计算/ (/ 记为/ LBN/ )/ 的/ 效率/ ,/ 并/ 将/ 其/ 与/ 文献/ [/ 6/ ]/ 中/ 信念/ 值/ 计算方法/ (/ 记为/ RC/ )/ 的/ 效率/ 进行/ 了/ 比较/ ,/ 如图/ 10/ 所示/ ./ 可以/ 看出/ ,/ LBN/ 和/ RC/ 的/ 效率/ 随着/ 参与/ 连接/ 的/ 元组/ 数量/ 增加/ 都/ 不/ 敏感/ ,/ 且/ 计算/ 时间/ 增加/ 的/ 趋势/ 基本一致/ ./ 然而/ ,/ 预处理/ 也/ 是/ 影响/ 基于/ LBN/ 进行/ 世系/ 概率/ 计算/ 效率/ 的/ 瓶颈/ ./ 综上/ ,/ 本/ 节/ 给出/ 的/ 实验/ 结果表明/ ,/ 本文/ 基于/ PGM/ 的/ 不确定性/ 数据/ 世系/ 表示/ 方法/ ,/ 在/ 模型/ 构建/ 、/ 空间/ 开销/ 和/ 应用/ 于/ 世系/ 概率/ 计算/ 等/ 方面/ ,/ 都/ 有/ 较/ 好/ 的/ 性能/ ,/ 从/ 一定/ 程度/ 上/ 验证/ 了/ 本文/ 所/ 提出/ 方法/ 的/ 有效性/ ./ 然而/ ,/ 针对/ 预处理/ 的/ 高效/ 算法/ 和/ 优化/ 策略/ ,/ 是/ 我们/ 将要/ 重点/ 研究/ 并/ 进行/ 测试/ 的/ 内容/ ./ Page9/ 图/ 10/ 基于/ LBN/ 的/ 世系/ 概率/ 计算/ 效率/ 5/ 总结/ 与/ 展望/ 以/ 有效/ 支持/ 不确定性/ 数据/ 世系/ 分析/ 为/ 目标/ ,/ 以/ 不确定性/ 的/ 跟踪/ 和/ 计算/ 为/ 核心/ ,/ 本文/ 基于/ 元组/ 独立/ 假设/ 提出/ 了/ 一种/ 基于/ 概率/ 图/ 模型/ 的/ 世系/ 表示/ 方法/ ,/ 给出/ 了/ 将/ 布尔/ 公式/ 等价/ 转换/ 为/ 贝叶斯/ 网/ 的/ 算法/ ,/ 适用/ 于/ 数据处理/ 结果/ 包含/ 任意/ 多个/ 元组/ 、/ 以及/ 世系/ 表达式/ 中/ 包含/ 任意/ 多个/ 布尔/ 公式/ 的/ 情形/ ./ 理论/ 分析/ 、/ 案例/ 研究/ 和/ 实验/ 结果表明/ ,/ 本文/ 的/ 方法/ 为/ 世系/ 分析/ 提供/ 了/ 一种/ 有效性/ 的/ 数据/ 相关性/ 表示/ 和/ 概率/ 计算/ 框架/ ./ 然而/ ,/ 缺乏/ 高效/ 的/ 预处理/ 策略/ ,/ 是/ 本文/ 方法/ 的/ 主要/ 不足之处/ ./ 直接/ 计算/ 不确定性/ 数据/ 查询/ 结果/ 元组/ 的/ 概率/ 往往/ 是/ #/ P/ 困难/ 的/ [/ 4/ ,/ 6/ ]/ ,/ 由/ 第/ 3/ 节中/ 的/ 案例/ 可以/ 看出/ ,/ 虽然/ 基于/ 本文/ 的/ 方法/ 可以/ 提高/ 世系/ 分析/ 的/ 效率/ ,/ 但/ 基于/ LBN/ 的/ 精确/ 概率/ 推理/ 计算/ 仍/ 具有/ 指数/ 级/ 的/ 时间/ 复杂度/ ,/ 因此/ ,/ 对/ 精确/ 概率/ 推理/ 算法/ 的/ 优化/ 或/ 进行/ 近似/ 推理/ ,/ 是/ 我们/ 正在/ 开展/ 的/ 工作/ ./ 此外/ ,/ 将/ 世系/ 表示/ 为/ LBN/ ,/ 除了/ 世系/ 概率/ 计算/ 之外/ ,/ 仍/ 可以/ 利用/ LBN/ 之上/ 的/ 后验/ 概率/ 推理/ 进行/ 任意/ 形式/ 的/ 世系/ 分析/ ,/ 进而/ 追踪/ 数据/ 来源/ 的/ 不确定性/ 、/ 数据/ 审核/ 与/ 质量/ 评估/ ;/ 针对/ 元组/ 不/ 独立/ 的/ 情形/ ,/ 讨论/ 世系/ 的/ 有效/ 表示/ 和/ 概率/ 计算方法/ ,/ 这些/ 是/ 我们/ 将要/ 开展/ 的/ 工作/ ./ 

