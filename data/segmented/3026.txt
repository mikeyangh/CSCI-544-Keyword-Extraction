Page1/ 一种/ 有效/ 识别/ 正版/ 视频/ 的/ TDIA/ 算法/ 周国瑞/ 1/ )/ 王文江/ 2/ )/ 孙世新/ 1/ )/ 1/ )/ (/ 电子科技/ 大学/ 计算机科学/ 与/ 工程学院/ 成都/ 610054/ )/ 2/ )/ (/ 龙旗/ 科技/ (/ 上海/ )/ 有限公司/ 工程部/ 上海/ 200233/ )/ 摘要/ 结合/ 视频压缩/ 标准/ 、/ 脆弱/ 数字水印/ 及/ 视频/ 通信/ 技术/ ,/ 文中/ 提出/ 一种/ 有效/ 识别/ 正版/ 视频/ 的/ TDIA/ 算法/ ./ 它/ 包括/ 嵌入/ 算法/ 和/ 识别/ 算法/ 两/ 部分/ ./ 为/ 消除/ 通信/ 干扰/ 对/ 水印/ 的/ 影响/ ,/ 将/ 迭代/ 方法/ 引入/ 识别/ 算法/ ./ 基于/ 盗版/ 操作/ 与/ 通信/ 干扰/ 的/ 本质/ 不同/ ,/ 研究/ 讨论/ 了/ 迭代/ 方法/ 的/ 性能/ ./ 最后/ ,/ 基于/ 迭代/ 结果/ ,/ 借助/ ChernoffBound/ 理论/ ,/ 分析/ 了/ TDIA/ 算法/ 的/ 识别/ 误差/ ./ 对于/ 码流/ BER/ (/ BitErrorRate/ )/ / 10/ -/ 3/ 、/ 视频/ I/ 帧/ 总数/ n/ / 360/ 的/ Mpeg2/ 编码/ 视频/ ,/ 该/ 算法/ 识别/ 误差/ 小于/ 10/ -/ 18/ ./ 关键词/ 脆弱/ 数字水印/ ;/ 正版/ 视频/ ;/ 盗版/ 视频/ ;/ 录制/ 盗版/ ;/ Mpeg2/ 编解码器/ 1/ 引言/ 保护/ 正版/ 视频/ 版权/ 关键/ 要/ 做好/ 传输/ 及/ 终端/ 消费/ 两个/ 环节/ 的/ 安全/ [/ 1/ ]/ ./ 传输/ 安全/ 包括/ 链路/ 安全/ 及/ 接入/ 安全/ ,/ 目前/ 技术/ 较为/ 成熟/ ,/ 主要/ 由/ 网络协议/ (/ 如/ SSL/ 、/ Page2/ 御/ 两种/ 措施/ ./ 主动/ 禁止/ 是/ 用/ 技术手段/ 主动/ 阻止/ 非法/ copy/ ,/ 比如/ ,/ 在/ 消费/ 电子装置/ 中/ 配置/ copy/ 保护/ ,/ 根据/ CCI/ (/ CopyControlInformation/ )/ 进行/ copy/ 控制/ [/ 3/ -/ 4/ ]/ ,/ 主动/ 禁止/ 可以/ 阻止/ 点到点/ copy/ [/ 5/ ]/ ,/ 但/ 无法/ 阻止/ 用户/ 用/ 录像机/ 等/ 外设/ 对/ 着/ 正在/ 播放/ 的/ 视频/ 屏幕/ 进行/ 视频/ 录制/ 盗版/ (/ camcorderpiracy/ )/ ,/ 见图/ 1/ (/ a/ )/ ,/ 这种/ 威胁/ 源于/ analoghole/ [/ 5/ ]/ ./ 被动/ 防御/ 旨在/ 禁止/ 对/ 非法/ 拷贝/ 的/ 使用/ 和/ 散播/ ,/ 它/ 是/ 在/ 盗版/ 发生/ 之后/ ,/ 对/ 盗版/ 视频/ 版本/ 的/ 禁播/ 、/ 追踪/ 或/ 进一步/ 对/ 肇事者/ 进行/ 的/ 追踪/ ,/ 从而/ 威慑/ 授权/ 用户/ 不要/ 进行/ 散播/ 侵权/ ./ 被动/ 防御/ 的/ 主流/ 技术/ 有/ 视频/ 指纹/ (/ videofingerprinting/ [/ 6/ -/ 7/ ]/ 或/ VideoDNA/ ①/ )/ 及抗/ 共谋/ 数字/ 指纹/ 技术/ (/ anti/ -/ collusionfingerprinting/ )/ [/ 8/ -/ 10/ ]/ ;/ 两者/ 都/ 要求/ 鲁棒性/ ,/ 即/ 只要/ 视频/ 的/ 视觉/ 内容/ 没有/ 被/ 改变/ ,/ 前者/ 认为/ 其中/ 的/ VideoDNA/ 没有/ 被/ 改变/ ,/ 后者/ 认为/ 嵌入/ 其内/ 的/ 代表/ 授权/ 用户/ 信息/ 的/ 数字水印/ (/ 数字/ 指纹/ )/ 依然/ 存在/ ;/ 因此/ ,/ 利用/ 前者/ 可以/ 进行/ 视频/ 内容/ 检索/ ,/ 利用/ 后者/ 可以/ 进行/ 肇事者/ 追踪/ ./ 而/ 两者/ 都/ 不/ 区分/ 视频/ 是/ 正版/ 还是/ 盗版/ ,/ 但/ 这种/ 区分/ 是/ 必要/ 的/ ;/ 鉴于/ 此/ ,/ 本文/ 提出/ 了/ 正版/ 视频/ 识别/ 算法/ ,/ 它/ 与/ 这/ 两种/ 技术/ 的/ 有效/ 结合/ ,/ 能/ 推动/ 被动/ 防御/ 的/ 进展/ ./ 在/ 本文/ ,/ 版权/ 所有者/ 持有/ 的/ 视频/ 版本/ 为/ 正版/ 视频/ ,/ 不妨/ 记为/ A/ ;/ 由/ A/ 仅/ 遭受/ 正常/ 通信/ 信道/ 干扰/ 后/ 形成/ 的/ 视频/ 版本/ 也/ 是/ 正版/ 视频/ ./ 盗版/ 视频/ 指/ 通过/ 基于/ analoghole/ [/ 5/ ]/ ,/ 用录/ 屏/ 方式/ 获得/ 的/ 视频/ ,/ 但/ 盗版者/ 为/ 规避/ 检测/ ,/ 可能/ 对/ 其/ 进行/ 修改/ 加工/ ./ 在/ 主动/ 禁止/ 实现/ 后/ ,/ 录屏/ 是/ 唯一/ 的/ 盗版/ 方式/ ,/ 目前/ ,/ 也/ 很/ 流行/ [/ 11/ ]/ ./ 本文/ 所提/ TDIA/ (/ Disturbance/ -/ tolerantIdentifi/ -/ cationAlgorithm/ )/ 算法/ 旨在/ 判定/ 视觉/ 内容/ 一致/ 的/ 视频/ [/ 12/ ]/ 集中/ ,/ 哪些/ 是/ 正版/ 哪些/ 是/ 盗版/ ./ 应用/ 模型/ 见图/ 1/ ,/ 图/ 1/ 给出/ 了/ 所/ 提/ 算法/ 与/ VideoDNA/ 技术/ 结合/ 实现/ 盗版/ 过滤/ 及禁播/ 功能/ 的/ 示意/ ./ 首先/ 通过/ VideoDNA/ 技术/ 提取/ 待/ 审核/ 视频/ 的/ DNA/ ,/ 并/ 到/ DNAdatabase/ 库中/ 查询/ ,/ 若/ 找到/ 与/ 之/ 相匹配/ 的/ ,/ 则/ 说明/ 待/ 审核/ 视频/ 含受/ 版权保护/ 的/ 内容/ ,/ 因此/ ,/ 需要/ 启动/ 正版/ 视别/ 程序/ 进行/ 正版/ 识别/ 并/ 根据/ 识别/ 结果/ 做出/ 相应/ 处理/ ./ 图/ 1/ (/ a/ )/ 为/ 视频/ 共享/ 网站/ (/ 如/ YouTube/ [/ 13/ ]/ 、/ 优酷/ 、/ 土豆网/ 等/ )/ 对/ Upload/ 视频/ 审查/ 过滤/ 示意图/ ./ 图/ 1/ (/ b/ )/ 为/ 网络/ 终端/ 对受/ 保护/ 视频/ 的/ 盗版/ 禁播/ 示意图/ ./ 另外/ ,/ 由于/ 当前/ 在/ IPTV/ 、/ 3G/ 视频/ 通信/ 中常/ 使用/ RTP/ // UDP/ // IP/ 传输/ 协议/ [/ 14/ ]/ ,/ 而/ UDP/ 并/ 不/ 保证/ 可靠性/ 和/ 顺序/ 性/ ,/ 所以/ 前端/ 数据/ 并/ 不能/ 保证/ 无/ 误差/ 地/ 传送/ 到/ 终端/ ,/ 终端/ 播放器/ 常/ 利用/ 差错/ 探测/ 、/ 差错控制/ 及/ 差错/ 复原/ 机制/ 来/ 屏蔽/ 所/ 接收/ 视频流/ 中/ 的/ 误码/ 及/ 丢/ 包/ ,/ 尽量/ 给人以/ 流畅/ 的/ 视频/ 感受/ ./ 在/ 这种/ 环境/ 中/ ,/ 终端/ 播放/ 的/ 视频/ 与/ 前端/ 下发/ 的/ 视频/ 常/ 存在/ 一定/ 的/ 数据/ 差异/ ,/ 并且/ 该/ 差异/ 由/ 通信/ 时/ 信道/ 状况/ 决定/ ./ 有线/ 信道/ 的/ 通信/ 干扰/ 远/ 小于/ 无线/ 信道/ ,/ 采用/ 足够/ FEC/ (/ For/ -/ wardErrorCorrection/ )/ [/ 5/ ]/ 及/ interleaving/ 技术/ 的/ 无线/ 信道/ 通信/ 干扰/ 相当于/ BER/ (/ BitErrorRate/ )/ 在/ 10/ -/ 4/ ~/ 10/ -/ 3/ 范围/ 的/ BSC/ (/ BinarySymmetricChan/ -/ nel/ )/ 信道/ [/ 15/ ]/ ./ TDIA/ 算法/ 在/ 设计/ 时/ 考虑/ 了/ 对/ 正常/ 通信/ 信道/ 干扰/ 的/ 容忍/ ./ 本文/ 第/ 2/ 节/ 介绍/ 录屏/ 盗版/ 的/ 特点/ 、/ 数字水印/ 及/ 盗版/ 视频/ 识别/ 算法/ 现状/ ;/ 第/ 3/ 节/ 给出/ 基于/ 脆弱/ 数字水印/ 技术/ ,/ 能/ 容忍/ 正常/ 通信/ 信道/ 干扰/ 的/ TDIA/ 算法/ ;/ 第/ 4/ 节对/ TDIA/ 算法/ 性能/ 进行/ 整体/ 测试/ ;/ 第/ 5/ 节/ 全文/ 小结/ ./ 2/ 相关/ 技术/ 分析/ 录屏/ 盗版/ 分为/ 外置/ 和/ 内置/ 两种/ 方式/ ./ 外置/ 指/ 用/ 摄像机/ 、/ 照相机/ 、/ 手机/ 等/ 外设/ 对/ 着/ 正在/ 播放/ 视频/ 的/ 屏幕/ 进行/ 的/ 录制/ ./ 由于/ 录制/ 时所/ 采用/ 的/ 坐标系/ [/ 16/ ]/ 、/ 颜色/ 空间/ 、/ 空间/ 和/ 时间/ 采样率/ 都/ 难以/ 保证/ 与/ 播放/ 视频/ 相同/ ,/ 因此/ 同原/ 视频/ 相比/ ,/ 录制/ 的/ 视频/ 存在/ 如下/ 变化/ :/ (/ 1/ )/ 由/ 仿射/ 变化/ 及/ 投影变换/ [/ 16/ -/ 17/ ]/ 导致/ 的/ 几何/ 型/ 变/ ,/ (/ 2/ )/ 帧/ 率/ 变化/ ,/ (/ 3/ )/ 像素/ 值/ 变化/ ./ 内置/ 指在/ 播放/ 视频/ 的/ 设备/ 上/ 安装/ 录屏/ 软件/ ,/ 使用/ 录屏/ 软件/ 录屏/ ./ 像/ CamtasiaRecorder/ 、/ Screensnap/ 等/ 计算机/ 录屏/ 软件/ 可以/ 实现/ 录制/ 时/ 的/ 坐标系/ 、/ 空间/ 及/ 时间/ 采样率/ 与/ 所/ 播放/ 的/ 视频/ 相同/ ,/ 仅/ 存在/ 由/ D/ -/ A/ 和/ A/ -/ D/ 转换/ 带来/ 的/ 像素/ 值/ 损失/ ./ 因此/ ,/ 外置/ 比/ 内置/ 录制/ 效果/ 差/ ,/ 但是/ ①/ VobileannounceslandmarkdeploymentofVideoDNA/ ?/ con/ -/ tentindentificationandmanagementsystem/ ./ http/ :/ // // www/ ./ Page3/ 目前/ 外置/ 录屏/ 效果/ 已经/ 具备/ 一定/ 的/ 观赏价值/ [/ 11/ ]/ ./ 当/ 正版/ 视频/ 与/ 这些/ 录制/ 的/ 盗版/ 视频/ 混在/ 一起/ 的/ 情况/ 下/ ,/ 如何/ 识别/ 出/ 正版/ 和/ 盗版/ 视频/ 呢/ ?/ 借助/ 文献/ [/ 4/ ]/ 的/ 思想/ ,/ 可以/ 用/ 不/ 可见/ 鲁棒/ 水印/ “/ illegalcogy/ ”/ 标识/ 盗版/ ./ 正版/ 视频/ 在/ 嵌入/ 该/ 标记/ 后/ 播放/ ,/ 这样/ ,/ 如果/ 录屏/ 盗版/ ,/ 则/ 该/ 标记/ 一并/ 被/ 录制/ 到/ 盗版/ 视频/ 中/ ./ 通过/ 识别/ “/ illegalcogy/ ”/ 标识/ ,/ 来/ 识别/ 盗版/ ./ 该/ 思想/ 存在/ 如下/ 不足/ :/ (/ 1/ )/ 播放/ 的/ 视频/ 是/ 叠加/ 了/ 鲁棒/ 水印/ 的/ 视频/ ./ 同/ 脆弱/ 数字水印/ 相比/ ,/ 鲁棒/ 水印/ 对/ 视频/ 质量/ 影响/ 较大/ ./ (/ 2/ )/ 在/ camcorderpiracy/ 等/ 录屏/ 盗版/ 下/ ,/ 鲁棒/ 水印/ 的/ 存活/ 和/ 检测/ 是/ 个/ 难题/ ;/ (/ 3/ )/ 不同/ 的/ 视频/ ,/ 叠加/ 了/ 相同/ 的/ 鲁棒/ 水印/ (/ “/ ille/ -/ TDIA/ 算法/ ,/ 基于/ 脆弱/ 数字水印/ [/ 18/ ]/ 标识/ 正版/ ,/ galcopy/ ”/ )/ ,/ 难以/ 抵制/ 移/ 去/ 攻击/ ./ 弥补/ 了/ 这些/ 不足/ ./ 3TDIA/ 算法/ TDIA/ 算法/ 分为/ 水印/ 嵌入/ 及/ 水印/ 提取/ 正版/ 识别/ 两/ 部分/ ./ 结合/ 视频/ 编码标准/ 、/ 对/ 盗版/ 操作/ 脆弱/ 、/ 视频/ 相依/ 、/ 密钥/ 级/ 安全/ 以及/ 保证/ 一定/ 的/ 水印/ 嵌入/ 量/ ,/ 设计/ 了/ 3.1/ 节/ 嵌入/ 算法/ ./ 3.2/ 节/ 分析/ 了/ 信道/ 干扰/ 对/ 水印/ 的/ 影响/ ,/ 3.3/ 节给/ 了/ 排除/ 影响/ 的/ 迭代/ 算法/ ,/ 3.4/ 节/ 给出/ 了/ 盲/ 识别/ 算法/ ./ 3.1/ 嵌入/ 算法/ 在/ Mpeg2/ 、/ H/ ./ 264/ 视频/ 编解码/ 标准/ 中/ ,/ DCT/ 变换/ 以/ 像素/ 块/ (/ Block/ )/ [/ 19/ -/ 20/ ]/ 为/ 单位/ 进行/ ,/ I/ 帧/ 亮度/ 分量/ 的/ MB/ (/ Maroblock/ )/ [/ 19/ ]/ 中/ 每/ 4/ 个/ 这样/ 的/ Block/ 组成/ 1bit/ 水印/ 承载/ 单位/ WB/ (/ WatermarkBlock/ )/ ./ 以/ 编码/ 时/ WB/ 中/ 4/ 个/ Block/ 的/ 量化/ 后/ DCT/ 系数/ [/ 19/ -/ 20/ ]/ 为/ 基础/ ,/ 嵌入/ 水印/ ,/ 并/ 压缩/ 编码/ 成/ 正版/ 视频/ ./ 水印/ 嵌入/ 算法/ 基本/ 步骤/ 如下/ :/ 1/ ./ 寻找/ 各个/ WB/ 的/ 水印/ 嵌入/ 点/ ./ 判定/ 在/ WB/ 最后/ 编码/ 的/ Block/ 中/ ,/ 按照/ zigzag/ 扫描/ 顺序/ 第/ Tembed/ (/ 阈值/ )/ 个/ 扫描/ 系数/ 之后/ 的/ 系数/ 中/ 是否/ 存在/ 非零值/ AC/ 系数/ ;/ 如果/ 有/ ,/ 则/ 选择/ 该/ 扫描/ 顺序/ 最后/ 的/ 非零值/ AC/ 系数/ (/ Aclast/ )/ 作为/ 水印/ 嵌入/ 点/ ,/ 转步/ 2/ ;/ 否则/ 在/ 这个/ WB/ 不/ 进行/ 水印/ 嵌入/ ;/ 2/ ./ 计算/ 水印/ ./ 记/ WB/ 的/ 4/ 个/ DC/ 系/ 数值/ 分别/ 为/ Dc0/ ,/ …/ ,/ Dc3/ ,/ 令/ a/ =/ (/ |/ Dc0/ |/ +/ |/ Dc1/ |/ +/ |/ Dc2/ |/ +/ |/ Dc3/ |/ )/ // 4/ ;/ 其中/ k1/ ∈/ (/ 0/ ,/ 1/ )/ 为/ 水印/ 密钥/ ,/ 显然/ x0/ ∈/ (/ 0/ ,/ 1/ )/ ./ 将/ x0/ 及/ λ/ =/ 4/ 作为/ 初值/ 和/ 参数/ ,/ 代入/ logistic/ [/ 21/ ]/ 映射/ 迭代/ 式/ (/ 2/ )/ ;/ 并/ 根据/ 密钥/ k2/ ,/ 按式/ (/ 3/ )/ 计算/ 水印/ w/ :/ 其中/ ,/ floor/ (/ ·/ )/ 为/ 向下/ 取整/ 函数/ ./ 3/ ./ 嵌入/ 水印/ ./ 当/ w/ =/ 0/ 时/ ,/ Aclast/ 需为/ 偶数/ ,/ 不/ 为/ 偶数/ 时/ 按/ 下式/ 进行/ 更改/ :/ 当/ w/ =/ 1/ ,/ Aclast/ 需为/ 奇数/ ,/ 不/ 为/ 奇数/ 时/ 按式/ (/ 4/ )/ 进行/ 更改/ ./ 水印/ 嵌入/ 时机/ 之所以/ 选择/ 量化/ 后/ DCT/ 系数/ (/ 亦/ 是/ 解码/ 时反/ 量化/ 前/ DCT/ 系数/ )/ ,/ 是/ 为了/ 减少/ 量化/ 操作/ 对/ 水印/ 的/ 改变/ 以及/ 避免/ 量化/ 步长/ 的/ 错误/ 对/ 水印/ 检测/ 的/ 影响/ ./ 考虑/ 到/ VLC/ 编码/ 规则/ ,/ 式/ (/ 4/ )/ 在/ 设计/ 上/ 尽量/ 使/ |/ Aclast/ |/ 变小/ ,/ 以便/ 水印/ 的/ 嵌入/ 不/ 增加/ 视频/ 码长/ ./ 由/ λ/ =/ 4/ 的/ logistic/ 混沌/ 序列/ 性质/ [/ 21/ ]/ ,/ 式/ (/ 3/ )/ 中/ w/ 等于/ 0/ 或/ 1/ 的/ 概率/ 各为/ 50/ %/ ,/ 对/ 整个/ 视频/ 来说/ 嵌入/ 0/ 或/ 1/ 的/ 总量/ 基本/ 相等/ ./ 使用/ k1/ 、/ k2/ 两个/ 水印/ 产生/ 密钥/ ,/ 由/ 混沌/ 映射/ 对/ 初值/ 具有/ 敏感性/ ,/ 导致/ 水印/ 难以/ 被/ 统计/ 估计/ ,/ 即使/ 在/ 嵌入/ 算法/ 公开/ 的/ 情况/ 下/ ,/ 安全系数/ 也/ 比较/ 高/ ./ 3.2/ 信道/ 误码/ 对/ 水印/ 的/ 影响/ 分析/ 传输层/ 二进制/ 视频流/ 的/ 数据结构/ 见图/ 2/ (/ a/ )/ ,/ HD/ (/ 头/ 信息/ )/ 及/ 语法/ 参数/ 数据量/ 相对/ 较/ 少/ ,/ 常/ 采用/ Reed/ -/ Solomoncode/ 等/ 容错/ 编码/ 技术/ 进行/ 保护/ ./ Videocodeddata/ 占/ 视频/ 比特流/ 的/ 98/ %/ 左右/ [/ 22/ ]/ ,/ 由于/ 数据量/ 大/ ,/ 难以/ 采用/ 保护措施/ ,/ 因此/ ,/ 是/ 信道/ 误码/ 的/ 多发/ 区域/ ./ Videocodeddata/ 是/ 用/ VLC/ 编码/ 对/ 视频/ 的/ DC/ 值/ 、/ AC/ 值/ 、/ 游程/ 长度/ 以及/ 宏块/ 地址/ 增量/ 、/ 宏块/ 类型/ 、/ 块/ 编码/ 模式/ 等/ 进行/ 的/ 二进制/ 编码/ [/ 19/ ]/ ,/ 图/ 2/ (/ b/ )/ 给出/ 了/ 其/ 数据结构/ ,/ 为/ 便于/ 说明/ 信道/ 误码/ 的/ 影响/ ,/ 将/ VLC/ 编码/ 的/ DC/ 数据表示/ 为/ DC/ ,/ Block/ 的/ 结图/ 2/ 传输/ 二进制/ 流/ 结构/ 及/ 误码/ 引起/ 的/ 块/ 合并/ 示意图/ Page4/ 束/ 表示/ 为/ EOB/ (/ EndofBlock/ )/ ./ 图/ 2/ (/ c/ )/ 是/ 图/ 2/ (/ b/ )/ 中/ 的/ EOB/ 及/ DC/ 被/ 信道/ 误码/ 干扰/ 成/ 另/ 一个/ VLC/ 码字/ 后/ ,/ 引起/ 的/ 块/ 合并/ 示意图/ ./ Videocodeddata/ 对/ 信道/ 误码/ 非常/ 敏感/ ,/ 当/ 含有/ 信道/ 误码/ 时/ ,/ 视频/ 解码器/ 在/ 解码/ 时/ 就/ 会/ 遇到/ 以下/ 情况/ :/ (/ 1/ )/ 无效/ VLC/ 码字/ ./ 通信/ 干扰/ 导致/ VLC/ 码字/ 无效/ ./ (/ 2/ )/ 越界/ ./ 通信/ 干扰/ 虽未/ 导致/ VLC/ 码字/ 无效/ ,/ 但/ 导致/ VLC/ 码字/ 分解/ 或/ 合并/ ,/ 从而/ 出现/ :/ DC/ 、/ AC/ 、/ 量化/ 因子/ 、/ 运动/ 矢量/ 、/ 宏块/ 地址/ 增量/ 等值/ 越界/ ;/ 块/ 解码/ 的/ DCT/ 系数/ 总/ 个数/ 超过/ 允许/ 的/ 最大值/ ;/ Slice/ [/ 19/ ]/ 解码/ Block/ 总数/ 不/ 等于/ 应/ 解码/ 总数/ ,/ 特别/ 非/ EOB/ 被/ 干扰/ 成/ EOB/ 时/ ,/ 块/ 被/ 分割/ ,/ EOB/ 被/ 干扰/ 成非/ EOB/ ,/ 块/ 被/ 合并/ (/ 图/ 2/ (/ c/ )/ 所示/ )/ ./ 以上/ 错误/ 统称/ 为/ 语法错误/ (/ syntaxerror/ )/ [/ 23/ ]/ ,/ 这些/ 错误/ 中/ ,/ 只有/ 当/ DC/ 、/ AC/ 值/ 越界/ 后/ ,/ 解码器/ 将/ 其/ 修改/ 为/ 默认值/ ,/ 对/ 其它/ 语法错误/ ,/ 标准/ 解码器/ 不/ 对/ 其/ 进行/ 更改/ ,/ 而是/ 直接/ 跳到/ 下/ 一个/ 同步/ 标记/ 处/ (/ Slice/ 头/ )/ 重新/ 开始/ 解码/ [/ 19/ ]/ ./ 另外/ ,/ 在/ 标准/ 解码器/ 正常/ 解码/ 的/ slice/ 中/ ,/ 仍/ 可能/ 存在/ 由/ 信道/ 干扰/ 所致/ 的/ 隐藏/ 错误/ [/ 24/ ]/ ,/ 例如/ :/ (/ 1/ )/ 某个/ 块/ 或/ 某些/ 块/ 的/ AC/ 系数/ 错误/ ;/ (/ 2/ )/ DC/ 系数/ 错误/ ,/ 由于/ DC/ 系数/ 是/ 预测/ 差/ 分值/ (/ DPCM/ )/ 编码/ ,/ 一个/ 块/ 的/ DC/ 系数/ 错误/ ,/ 可以/ 导致/ 基于/ 其/ 进行/ DPCM/ 解码/ 的/ 后继/ 块/ DC/ 系数/ 错/ ,/ 直到/ 同步/ 标志/ 处/ 为止/ ./ 因此/ ,/ 信道/ 误码/ bit/ 位/ 发生/ 位置/ 的/ 不确定性/ ,/ 导致/ 了/ DC/ 、/ AC/ 系数/ 错误率/ 的/ 不确定性/ ./ 故/ 在/ 没有/ 原始/ videocodeddata/ 的/ 情况/ 下/ ,/ 无法/ 找到/ 信道/ 误码率/ 与/ 水印/ 错误率/ 之间/ 的/ 精确/ 关系/ ./ 3.3/ 排除/ 信道/ 误码/ 对/ 水印/ 识别/ 的/ 影响/ 由/ 3.2/ 节/ 分析/ 知/ ,/ 应该/ 避免/ 对/ 信道/ 干扰/ 的/ MB/ (/ Macroblock/ )/ [/ 19/ ]/ 进行/ 水印/ 提取/ ,/ 但是/ 在/ 没有/ 原始/ 视频/ 的/ 情况/ 下/ ,/ 无/ 误差/ 地/ 找出/ 这些/ MB/ 几乎/ 是/ 不/ 可能/ 的/ ./ 目前/ ,/ 可以/ 用/ 标准/ 解码器/ 识别/ 语法错误/ ,/ 而/ 隐藏/ 错误/ 识别/ 是/ 难点/ ./ 因此/ ,/ 提出/ 了/ 如下/ 计算/ 每个/ 含水/ 印/ 错误/ I/ 帧/ 最终/ 水印/ 错误率/ ε/ 1/ 的/ 迭代/ 算法/ ,/ 以/ 消除/ 隐藏/ 错误/ 对/ 水印/ 的/ 影响/ ./ 迭代/ 算法/ 基本/ 步骤/ 为/ 1/ ./ 初始化/ 参数/ TS/ =/ TSo/ ,/ Tac/ =/ Taco/ ,/ T3/ =/ T3o/ ,/ MDb/ =/ MDbo/ ;/ d1/ =/ d1o/ ,/ d2/ =/ d2o/ ,/ d3/ =/ d3o/ ,/ d4/ =/ d4o/ ;/ 2/ ./ 赋值/ S/ =/ {/ MBi/ |/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ N/ }/ ,/ 其中/ MBi/ 为/ I/ 帧/ 中/ 被/ 标准/ 解码器/ 正常/ 解码/ 的/ 亮度/ 宏块/ ;/ N/ _/ e/ [/ 0/ ]/ =/ S/ 中/ 错误/ 水印/ 总数/ ;/ N/ _/ c/ [/ 0/ ]/ =/ S/ 中/ 水印/ 总数/ ;/ berror/ [/ 0/ ]/ =/ N/ _/ e/ [/ 0/ ]/ // N/ _/ c/ [/ 0/ ]/ ;/ j/ =/ 0/ ;/ 3/ ./ 迭代/ 排除/ While/ (/ MDb/ >/ 0Tac/ >/ 0/ )/ (/ N/ _/ e/ [/ j/ ]/ >/ 0j/ =/ j/ +/ 1/ ;/ x/ [/ j/ ]/ =/ 0/ ;/ y/ [/ j/ ]/ =/ 0/ ;/ If/ (/ N/ _/ c/ [/ j/ ]/ >/ 0/ )/ Tac/ =/ Tac/ -/ d2/ ;/ MDb/ =/ MDb/ -/ d4/ ;/ If/ (/ MDb/ / 0/ ‖/ Tac/ / 0/ )/ (/ N/ _/ e/ [/ j/ ]/ >/ 0N/ _/ c/ [/ j/ ]/ >/ }/ 4/ ./ 计算/ ε/ 1Ifj/ </ 5/ ε/ 1/ =/ min/ (/ berror/ [/ j/ ]/ )/ ;/ Else/ 判断/ MB/ 存在/ AC/ 错误/ 的/ 规则/ 为/ :/ MB/ 各/ Block/ 中若/ 一个/ Block/ 存在/ AC/ 系数/ 错误/ ,/ 则/ 该/ MB/ 存在/ AC/ 错误/ ./ 将/ 视频/ I/ 帧/ 亮度/ 分量/ VLC/ 解码/ 并/ 反/ 量化/ 到/ 反/ DCT/ 变换/ 前/ ,/ 对/ 每个/ Block/ 的/ AC/ 系数/ 进行/ 错误/ 检测/ ,/ 具体方法/ [/ 24/ ]/ :/ 记/ S/ =/ ∑/ 64/ |/ AC64/ |/ }/ ./ 若/ S/ >/ TS/ 且/ ACmax/ // S/ >/ Tac/ ,/ 则/ 此/ Block/ 存在/ AC/ 错误/ ./ Page5/ 判断/ MB/ 存在/ DC/ 错误/ 的/ 规则/ 为/ :/ 将/ I/ 帧/ 亮度/ 分量/ 解码/ 到/ 像素/ 层/ ,/ 利用/ 空域/ 平滑/ 特性/ 进行/ DC/ 错误/ 检测/ [/ 25/ ]/ ./ 如图/ 3/ 所示/ ,/ currentMB/ 、/ leftMB/ 和/ topMB/ 分别/ 表示/ 待/ 判断/ 的/ MB/ 、/ 与其/ 相邻/ 的/ 左边/ 及/ 上边/ MB/ ,/ Pini/ 、/ Pouti/ 分别/ 为/ currentMB/ 的/ 第/ i/ 个/ 及其/ 邻块/ 的/ 第/ i/ 个/ 边界/ 像素/ 值/ ./ 当/ topMB/ 存在/ 时/ ,/ currentMB/ 与/ topMB/ 的/ 边界/ 差异/ Dbt/ =/ 1/ 当/ topMB/ 不/ 存在/ 时/ ,/ Dbt/ =/ 0/ ;/ currentMB/ 与/ leftMB/ 的/ 边界/ 差异/ Dbl/ 同理/ 计算/ ;/ 令/ Db/ =/ 1Dbl/ )/ ,/ 若/ Dbt/ 与/ Dbl/ 中/ 之一/ 为/ 零/ ,/ 则/ K/ =/ 1/ ;/ 否则/ ,/ K/ =/ 2/ ./ 令/ TDb/ =/ u/ +/ MDb/ ρ/ ,/ 其中/ ,/ u/ =/ 1N/ 为/ currentMB/ 所在/ I/ 帧/ 中/ 已经/ 检测/ 过且/ 不/ 含/ 隐藏/ 错误/ 的/ MB/ 数目/ ,/ uj/ 为/ 第/ j/ 个/ 无错/ MB/ 的/ Db/ 值/ ./ 如果/ Db/ >/ max/ {/ TDb/ ,/ T3/ }/ ,/ 则/ currentMB/ 中/ 含有/ DC/ 错误/ ./ 随着/ 迭代/ 次数/ 的/ 增加/ ,/ 可/ 形成/ 集合/ {/ berror/ [/ j/ ]/ }/ ,/ berror/ [/ j/ ]/ 为/ 第/ j/ 步/ 排除/ 完成/ 后/ S/ 的/ 水印/ 错误率/ ,/ 理论/ 上/ ,/ 当/ S/ 中/ 不/ 存在/ 错误/ MB/ 或/ 迭代/ 算法/ 已经/ 没有/ 排除/ 能力/ 后/ ,/ 集合/ {/ berror/ [/ j/ ]/ }/ 表现/ 出/ 收敛/ 特性/ ,/ 即/ 对于/ 实际/ 问题/ ,/ 严格/ 相等/ 常/ 表现/ 为/ 迭代/ 差异/ 在/ 小/ 范围/ 内/ 波动/ ./ 为/ 防止/ 水印/ 过少/ ,/ 而/ 产生/ 迭代/ 结果/ 的/ 剧烈/ 波动/ ,/ 迭代/ 算法/ 要求/ N/ _/ c/ [/ j/ ]/ >/ 10/ ./ 为/ 降低/ 波动/ 的/ 影响/ ,/ ε/ 1/ 为/ 最后/ 5/ 次/ 迭代/ 所/ 产生/ 的/ 最小值/ ./ 对于/ 正版/ 视频/ ,/ ε/ 1/ ∈/ [/ 0/ ,/ δ/ 1/ ]/ ,/ 对于/ 盗版/ 视频/ ,/ ε/ 1/ ∈/ [/ λ/ -/ δ/ 1/ ,/ 1/ ]/ ,/ 其中/ δ/ 1/ 为/ 视频/ 中/ 没有/ 被/ 排除/ 的/ 错误/ MB/ 引起/ 的/ 水印/ 错误率/ ,/ λ/ 为/ 盗版/ 视频/ 水印/ 错误率/ ./ 迭代/ 算法/ 性能/ 及/ ε/ 1/ 概率密度函数/ 在/ 第/ 4.4/ 节/ 进行/ 测试/ ./ 3.4/ 识别/ 算法/ 结合/ 3.1/ 节/ 的/ 嵌入/ 算法/ 和/ 3.3/ 节/ 的/ 迭代/ 算法/ ,/ 提出/ 了/ 如下/ 识别/ 算法/ ,/ 流程图/ 见图/ 4/ ,/ 基本/ 步骤/ 为/ 1/ ./ 对/ 阈值/ T/ 、/ δ/ 进行/ 赋值/ ./ 2/ ./ 初始化/ 参数/ :/ sum/ =/ 0/ ,/ n/ =/ 0.3/ ./ 从/ videocodeddata/ 中/ 对/ I/ 帧/ 亮度/ 分量/ 进行/ VLC/ 解码/ ,/ 若/ 检测/ 到/ 语法错误/ ,/ 则/ 跳/ 到/ 下/ 一个/ 同步/ 标记/ 处/ 开始/ 重新/ 解码/ ./ 4/ ./ 计算/ I/ 帧/ 水印/ 错误率/ berror/ ,/ n/ =/ n/ +/ 1/ ./ 根据/ 第/ 3.1/ 节/ 嵌入/ 算法/ 的/ 步/ 1/ 和步/ 2/ ,/ 寻找/ 水印/ 承载/ 单位/ WB/ 和/ Aclast/ 上/ 应该/ 携带/ 的/ 水印/ w/ ./ 提取/ Aclast/ 上/ 实际/ 承载/ 的/ 水印/ w/ -/ :/ 当/ Aclast/ 为/ 偶数/ 时/ ,/ w/ -/ =/ 0/ ,/ 当/ Aclast/ 为/ 奇数/ 时/ ,/ w/ -/ =/ 1/ ./ 如果/ w/ ≠/ w/ -/ ,/ 则/ 该/ WB/ 携带/ 的/ 水印/ 错误/ ;/ 否则/ 正确/ ./ 根据/ I/ 帧/ WB/ 数目/ 及/ 水印/ 错误/ 数量/ ,/ 计算/ berror/ ,/ berror/ =/ I/ 帧/ 错误/ 水印/ 总数/ // I/ 帧/ 水印/ 总数/ ./ 5/ ./ 若/ berror/ =/ 0/ ,/ 则/ 检测/ 结束/ 标志/ ,/ 若/ 视频/ 全部/ I/ 帧/ 分析/ 完毕/ ,/ 则/ 视为/ 检测/ 到/ 结束/ 标志/ ,/ 转步/ 6/ ;/ 否则/ 转步/ 3/ ,/ 继续/ 解码/ 下/ 一个/ I/ 帧/ ./ 若/ berror/ >/ T/ ,/ 则/ 此/ 视频/ 不需/ 进一步/ 判定/ ,/ 识别/ 算法/ 终止/ ,/ 不是/ 正版/ ./ 若/ 0/ </ berror/ / T/ ,/ 判断/ 能否/ 迭代/ ,/ 若/ 不能/ 则/ sum/ =/ sum/ +/ berror/ ;/ 若能/ 则/ 根据/ 3.3/ 节/ 算法/ 迭代/ 算法/ 计算/ ε/ 1/ ,/ sum/ =/ sum/ +/ ε/ 1/ ./ 检测/ 结束/ 标志/ ,/ 若/ 检测/ 到/ 结束/ 标志/ ,/ 则/ 转步/ 6/ ;/ 否则/ 转步/ 3.6/ ./ 当/ sum/ 在/ 识别/ 算法/ 中/ ,/ 对/ δ/ 的/ 赋值/ 在/ 4.5/ 节/ 结合/ 识别/ 误差/ 讨论/ ./ 对/ T/ 可/ 采用/ 如下/ 3/ 种/ 方式/ 之一/ 赋值/ :/ Page6/ (/ 1/ )/ 令/ 其中/ ,/ α/ 为/ 二进制/ 视频/ 码流/ 所/ 面临/ 的/ 比特/ 误码率/ (/ biterrorrate/ )/ ,/ L/ 为/ 视频/ 全部/ I/ 帧/ 在/ 码流/ 中/ 的/ 比特/ 位/ 总长度/ ,/ M/ 为/ 视频/ 水印/ 总/ bit/ 数/ ,/ m/ 为/ 1/ 个/ Slice/ 中/ 包含/ 的/ Block/ 数目/ ./ 由于/ 1bit/ 错误/ 的/ 最大/ 影响/ 区间/ 为/ 1/ 个/ Slice/ [/ 19/ ]/ ,/ 因此/ ,/ T/ 为/ 在/ 信道/ 干扰/ 下/ I/ 帧/ 最大/ 平均/ 水印/ 错误率/ ./ 这样/ 赋值/ 有助于/ 提高/ 识别/ 速度/ ./ (/ 2/ )/ 令/ T/ 为/ 正版/ 视频/ 具备/ 观赏价值/ 下/ 可容忍/ 的/ 最大/ 水印/ 错误率/ ,/ 具体/ 可/ 结合/ 错误/ 恢复/ 算法/ [/ 24/ -/ 25/ ]/ 进行/ 统计/ 评估/ ./ 这样/ 赋值/ 可/ 提高/ 识别/ 速度/ ./ (/ 3/ )/ 令/ T/ =/ 1/ ./ 不/ 出现/ 不/ 需要/ 进一步/ 判断/ 的/ 情形/ ./ 4TDIA/ 算法/ 性能/ 测试/ 测试环境/ :/ (/ 1/ )/ IntelPentiumCPU/ :/ 1600MHz/ ,/ 内存/ 256MB/ ./ (/ 2/ )/ Mpeg2Codecvision1/ ./ 2/ ①/ ./ 4.1/ 嵌入/ 算法/ 性能/ 测试/ 测试/ 内容/ 为/ :/ (/ 1/ )/ 水印/ 嵌入/ 带来/ 的/ 视频/ 质量/ 下降/ ,/ 用/ 相同/ 码率/ 下/ ,/ 水印/ 嵌入/ 后/ 视频/ 各帧/ PSNR/ 下降/ 的/ 平均值/ mpsnr/ 来/ 衡量/ ./ (/ 2/ )/ 水印/ 嵌入/ 总量/ ,/ 用/ wtotal/ 表示/ ./ (/ 3/ )/ 水印/ 嵌入/ 耗时/ e/ -/ time/ ./ 令/ 嵌入/ 算法/ 参数/ k1/ =/ 0.00252/ 、/ k2/ =/ 100/ 、/ Tembed/ =/ 30/ ./ 压缩/ 参数/ 为/ :/ 每个/ 视频/ 时长/ 为/ 1s/ 、/ 帧/ 率/ 30/ 帧/ // s/ 、/ GOP/ =/ 6/ 、/ I/ // P/ 帧/ 距/ 为/ 3/ ./ 在/ 1Mbps/ 、/ 2Mbps/ 、/ 3Mbps/ 、/ 4Mbps/ 码率/ 下/ ,/ 4/ 个/ 视频/ ②/ container/ 、/ coastguard/ 、/ foreman/ 、/ hall/ _/ monitor/ 的/ 测试/ 结果/ 见表/ 1/ ./ 从表/ 1/ 中/ 数据/ 可以/ 看出/ :/ 水印/ 对/ 视频/ PSNR/ 影响/ 微乎其微/ ,/ 水印/ 嵌入/ 量/ 较/ 多/ ,/ 嵌入/ 耗时/ 不大/ ./ 一定/ 的/ 水印/ 嵌入/ 表/ 1/ 基于/ Mpeg2Codec/ ,/ 水印/ 嵌入/ 算法/ 性能/ 测试/ 结果/ 表/ 视频/ 码率/ // Mbpsmpsnrwtotale/ -/ time/ // scontainercoastguarhall/ _/ monitorforeman/ 量/ 可以/ 保证/ 识别/ 精度/ 以及/ 防止/ 3.3/ 节/ 迭代/ 结果/ 因为/ 水印/ 量/ 过少/ 而/ 出现/ 抖动/ ./ 4.2/ 水印/ 对/ 盗版/ 操作/ 的/ 脆弱性/ 测试/ 压缩/ 参数设置/ 方法/ 压缩成/ 盗版/ :/ 把/ 正版/ 视频/ 解码/ 成帧/ 序列/ ,/ 再/ 把/ 帧/ 序列/ 按/ 如下/ 盗版/ 1/ ./ 压缩/ 参数设置/ 同/ 正版/ ;/ 盗版/ 2/ ./ 除/ 码率/ 增大/ 外/ ,/ 其它/ 同/ 正版/ ;/ 盗版/ 3/ ./ 除/ 码率/ 减小/ 外/ ,/ 其它/ 同/ 正版/ ;/ 盗版/ 4/ ./ 码率/ 增大/ 、/ I/ // P/ 帧/ 距/ 减小/ ,/ 其它/ 同/ 正版/ ./ 以/ container/ 正版/ 视频/ 测试/ 这/ 4/ 种/ 盗版/ 方式/ 的/ 水印/ 错误率/ ,/ 测试/ 结果/ 见图/ 5/ (/ a/ )/ ~/ (/ d/ )/ ./ 图/ 5/ 中/ ,/ perror/ 指/ 盗版/ 视频/ 各/ I/ 帧/ 水印/ 平均/ 错误率/ ./ 图/ 5/ (/ a/ )/ 是/ 将/ 码率/ 分别/ 为/ 0.6/ Mbps/ ~/ 8Mbps/ 的/ container/ 正版/ 分别/ 按/ 盗版/ 1/ 盗版/ 的/ 测试/ 结果/ ,/ 图/ 5/ (/ b/ )/ 是/ 将/ 0.6/ Mbps/ 正版/ 按/ 盗版/ 2/ 分别/ 将/ 码率/ 增大/ 到/ 0.7/ Mbps/ ~/ 8Mbps/ 后/ 的/ 测试/ 结果/ ,/ 图/ 5/ (/ c/ )/ 是/ 将/ 8Mbps/ 正版/ 按/ 盗版/ 3/ 将/ 码率/ 逐步/ 减少/ 到/ 7.9/ Mbps/ ~/ 0.6/ Mbps/ 的/ 测试/ 结果/ ./ 图/ 5/ (/ d/ )/ 是/ 将/ 1Mbps/ 正版/ I/ // P/ 帧/ 距/ 减小/ 1/ ,/ 码率/ 增大/ 到/ 1.1/ Mbps/ ~/ 8Mbps/ 的/ 测试/ 结果/ ./ 测试/ 中/ 之所以/ 选择/ 0.6/ Mbps/ 以上/ 视频/ ,/ 是因为/ 当/ 码率/ 小于/ 0.6/ Mbps/ 时/ ,/ Mpeg2/ 标准/ 编码器/ 压缩/ 的/ 视频/ 存在/ 明显/ 的/ 马赛克/ ./ 从图/ 5/ (/ a/ )/ ~/ (/ d/ )/ 对比/ 可知/ :/ 盗版/ 视频/ 的/ perror/ >/ 0.2/ ,/ 盗版/ 1/ 方式/ 是/ 对/ 水印/ 保持/ 最好/ 的/ 方式/ ./ 由/ 测试/ 结果/ 可以/ 看出/ 水印/ 对/ 盗版/ 操作/ 脆弱/ ./ ①/ ②/ tabase/ _/ Video/ ./ htmlPage74/ ./ 3/ 通信/ 干扰/ 对/ 水印/ 影响/ 测试/ 在/ 没有/ 通信/ 干扰/ 时/ ,/ 正版/ 视频/ 各/ I/ 帧/ 水印/ 错误率/ 为/ 零/ ./ 码率/ 为/ 0.9/ Mbps/ 的/ 8scontainer/ 正版/ 视频/ ,/ 码流/ 遭受/ BER/ =/ 6/ ×/ 10/ -/ 4/ 干扰/ 后/ ,/ 各/ I/ 帧/ 水印/ 错误率/ 见图/ 6/ (/ a/ )/ ,/ 各/ I/ 帧/ 平均/ 水印/ 错误率/ perror/ =/ 0.1541/ ./ 利用/ 盗版/ 方式/ 1/ 对/ 该/ 正版/ 视频/ 进行/ 盗版/ ,/ 在/ 同样/ 信道/ 干扰/ 下/ ,/ 各/ I/ 帧/ 水印/ 错误率/ 见图/ 6/ (/ b/ )/ ./ 对比/ 图/ 6/ (/ a/ )/ 、/ (/ b/ )/ 可以/ 看出/ ,/ 通信/ 干扰/ 使得/ container/ 正版/ 、/ 盗版/ perror/ 趋同/ ./ 图/ 6/ 通信/ 干扰/ 后/ 正版/ 、/ 盗版/ 视频/ 各/ I/ 帧/ 水印/ 错误率/ 示意图/ 4.4/ 迭代/ 算法/ 效果/ 测试/ 遭受/ 信道/ 干扰/ 后/ ,/ 正版/ 视频/ 某/ I/ 帧/ (/ 见图/ 7/ (/ a/ )/ )/ 水印/ 错误率/ 为/ 0.15/ ,/ 盗版/ 视频/ 某/ I/ 帧/ (/ 见图/ 7/ (/ b/ )/ )/ 水印/ 错误率/ 也/ 为/ 0.15/ ./ 用/ 3.3/ 节/ 迭代/ 算法/ 对/ 两幅/ 图/ 进行/ 干扰/ 排除/ ,/ 图/ 7/ (/ c/ )/ 、/ (/ d/ )/ 分别/ 绘出/ 了/ 对/ 图/ 7/ (/ a/ )/ 、/ (/ b/ )/ 进行/ 迭代/ 时/ ,/ 集合/ S/ 的/ 水印/ 错误率/ 变化/ 曲线/ ,/ 横坐标/ 为/ 迭代/ 次数/ j/ ,/ 纵坐标/ 为/ berror/ [/ j/ ]/ ./ 在/ 图/ 7/ (/ c/ )/ 中/ ,/ 迭代/ 16/ 次/ ,/ 错误/ 全部/ 被/ 排除/ ,/ 在/ 图/ 7/ (/ d/ )/ 中/ ,/ 迭代/ 86/ 次后/ berror/ 收敛/ 于/ 0.25/ ./ 迭代/ 算法/ 所/ 使用/ 的/ 参数值/ 为/ TSo/ =/ 100/ ,/ Taco/ =/ 0.95/ ,/ T3o/ =/ 10/ ,/ MDbo/ =/ 5/ ;/ d1o/ =/ 10/ ;/ ,/ d2o/ =/ 0.05/ ,/ d3o/ =/ 1/ ,/ d4o/ =/ 0.1/ ./ 测试/ 第/ 3.3/ 节/ ε/ 1/ 的/ 概率密度函数/ ,/ 测试/ 样本/ 为/ 遭遇/ 干扰/ 的/ BER/ 值为/ [/ 10/ -/ 4/ ,/ 10/ -/ 3/ ]/ 的/ 正版/ 、/ 盗版/ 1/ 方式/ 盗版/ 视频/ ,/ 干扰/ 方式/ 为/ 对/ 视频/ 码流/ 随机/ 加扰/ ,/ 迭代/ 测试/ 结果/ 见图/ 8/ (/ a/ )/ 、/ (/ b/ )/ ,/ 横坐标/ 为/ ε/ 1/ ,/ 纵坐标/ 为/ 概率/ p/ (/ ε/ 1/ )/ ./ 对于/ 正版/ 视频/ I/ 帧/ ,/ ε/ 1/ 的/ 数学/ 期望/ 为/ E/ (/ ε/ 1/ )/ =/ 0.036/ ;/ 对于/ 盗版/ 视频/ I/ 帧/ ,/ E/ (/ ε/ 1/ )/ =/ 0.352/ ./ 图/ 8/ 遭遇/ 干扰/ 的/ 正版/ 、/ 盗版/ 视频/ I/ 帧/ ε/ 1/ 概率密度函数/ 图/ 进一步/ 测试表明/ ,/ 当/ BER/ 小于/ 10/ -/ 4/ 时/ ,/ 正版/ 视频/ I/ 帧/ 的/ E/ (/ ε/ 1/ )/ / 0.036/ ,/ 盗版/ 方式/ 1/ 盗版/ 视频/ I/ 帧/ 的/ E/ (/ ε/ 1/ )/ 仍为/ 0.352/ ./ 对于/ 其它/ 盗版/ 方式/ ,/ E/ (/ ε/ 1/ )/ =/ 0.5/ ./ 4.5/ TDIA/ 算法/ 误/ 识别率/ 分析/ ChernoffBound/ 定理/ [/ 26/ -/ 27/ ]/ ./ 如果/ X1/ ,/ X2/ ,/ …/ ,/ Xn/ 是/ 独立/ 且/ 0/ / Xi/ / 1/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ 的/ 随机变量/ ,/ 记/ Xi/ // (/ )/ n/ ,/ 则/ 对/ 任意/ 0/ </ δ/ </ 1/ ,/ 有/ x/ =/ E/ ∑/ n/ (/ i/ )/ 当/ δ/ </ x/ 时/ ,/ P/ ∑/ n/ (/ ii/ )/ 当/ δ/ >/ x/ 时/ ,/ P/ ∑/ n/ 其中/ ,/ D/ (/ δ/ ‖/ x/ )/ =/ δ/ log2/ δ/ i/ =/ 1/ 利用/ ChernoffBound/ 定理/ ,/ 求/ 识别/ 算法/ 的/ 漏检/ 概率/ P1/ ,/ 即/ 正版/ 视频/ 满足/ sum/ // n/ / δ/ 的/ 概率/ ./ 由于/ 正版/ 视频/ 每个/ I/ 帧/ 的/ 水印/ 错误率/ 可以/ 看作/ 一个/ 随机变量/ ,/ 这些/ 随机变量/ 独立/ 且/ 取值/ 在/ [/ 0/ ,/ 1/ ]/ ,/ 满足/ ChernoffBound/ 定理/ 条件/ ,/ 因此/ ,/ 由式/ (/ 8/ )/ ,/ P1/ =/ P/ (/ sum/ // n/ / δ/ )/ / 2/ -/ nD/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ ,/ E/ (/ ε/ 1/ )/ 为/ 正版/ 视频/ I/ 帧/ 水印/ 错误率/ 的/ 数学/ 期望/ ./ 当/ E/ (/ ε/ 1/ )/ ∈/ (/ 0/ ,/ 0.036/ ]/ 时/ ,/ D/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ 为/ E/ (/ ε/ 1/ )/ 的/ 递减/ 函数/ ,/ 因此/ ,/ 对于/ / E/ (/ ε/ 1/ )/ ∈/ (/ 0/ ,/ 0.036/ ]/ ,/ 都/ 有/ D/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ / D/ (/ δ/ ‖/ 0.036/ )/ ,/ P1/ / 2/ -/ nD/ (/ δ/ ‖/ 0.036/ )/ ./ 利用/ ChernoffBound/ 定理/ ,/ 求/ 识别/ 算法/ 的/ 误检/ 概率/ P2/ ,/ 即/ 盗版/ 视频/ 满足/ sum/ // n/ / δ/ 的/ 概率/ ,/ 由式/ (/ 7/ )/ ,/ P2/ =/ P/ (/ sum/ // n/ </ δ/ )/ / 2/ -/ nD/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ ,/ E/ (/ ε/ 1/ )/ 为/ 盗版/ 视频/ I/ 帧/ 水印/ 错误率/ 的/ 数学/ 期望/ ./ 当/ E/ (/ ε/ 1/ )/ ∈/ [/ 0.352/ ,/ 1/ )/ 时/ ,/ D/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ 为/ E/ (/ ε/ 1/ )/ 的/ 递增/ 函数/ ,/ 因此/ ,/ / E/ (/ ε/ 1/ )/ ∈/ [/ 0.352/ ,/ 1/ ]/ ,/ 都/ 有/ D/ (/ δ/ ‖/ E/ (/ ε/ 1/ )/ )/ / D/ (/ δ/ ‖/ 0.352/ )/ ,/ P2/ / 2/ -/ nD/ (/ δ/ ‖/ 0.352/ )/ ./ 既/ 不是/ 正版/ 也/ 不是/ 盗版/ 的/ 视频/ 称为/ 无关/ 视频/ ,/ Page8/ 这些/ 视频/ 的/ I/ 帧/ 仍/ 是/ 符合/ ChernoffBound/ 定理/ 的/ 随机变量/ ,/ 且/ E/ (/ ε/ 1/ )/ =/ 0.5/ ,/ 因此/ 用式/ (/ 7/ )/ 可/ 计算/ 把/ 无关/ 视频/ 识别/ 为/ 正版/ 的/ 概率/ P3/ ,/ P3/ =/ P/ (/ sum/ // n/ </ δ/ )/ / 2/ -/ nD/ (/ δ/ ‖/ 0.5/ )/ ./ 可/ 根据/ 识别/ 误差/ ,/ 对/ δ/ 进行/ 赋值/ ./ 当/ T/ =/ 1/ 、/ δ/ =/ (/ 0.352/ -/ 0.036/ )/ // 2/ =/ 0.158/ 时/ ,/ P1/ / 2/ -/ 0.1728/ n/ 、/ P2/ / 2/ -/ 0.1355/ n/ 、/ P3/ / 2/ -/ 0.3705/ n/ ./ 这/ 表明/ 当/ 信道/ 干扰/ BER/ 小于/ 等于/ 10/ -/ 3/ 时/ ,/ 算法/ 漏检/ 率及/ 误检率/ 随着/ n/ 的/ 增加/ ,/ 指数/ 级/ 下降/ ./ 当/ n/ =/ 360/ 时/ ,/ P1/ / 1.88/ e/ -/ 19/ 、/ P2/ / 7.55/ e/ -/ 18/ 、/ P3/ / 7.06/ e/ -/ 41/ ./ 通常/ 视频/ 每秒/ 不少/ 于/ 2/ 个/ I/ 帧/ ,/ n/ =/ 360/ 相当于/ 不/ 超过/ 3min/ 的/ 视频/ 时长/ ./ 5/ 结束语/ 在/ 分析/ 了/ 版权保护/ 技术/ 现状/ 的/ 基础/ 上/ ,/ 本文/ 提出/ 一种/ 有效/ 识别/ 正版/ 视频/ 的/ 算法/ :/ TDIA/ 算法/ ./ 在/ 设计/ 上/ ,/ 它/ 结合/ 了/ 视频/ 编码标准/ 、/ 脆弱/ 数字水印/ 、/ 视频/ 通信/ 技术/ ./ TDIA/ 算法/ 包含/ 两/ 部分/ :/ 嵌入/ 算法/ 及/ 识别/ 算法/ ./ 在/ 3.1/ 节/ 描述/ 了/ 嵌入/ 算法/ ,/ 在/ 其/ 设计/ 上/ 考虑/ 了/ 安全性/ 、/ 脆弱性/ 、/ 一定/ 的/ 水印/ 嵌入/ 量/ 以及/ 使/ 所/ 嵌入/ 的/ 水印/ 0/ // 1/ 各/ 占/ 50/ %/ ,/ 对/ Aclast/ 奇偶性/ 更改/ 概率/ 为/ 50/ %/ ,/ 以便/ 保证/ 无关/ 视频/ I/ 帧/ 水印/ 错误率/ 的/ 数学/ 期望/ 为/ E/ (/ ε/ 1/ )/ =/ 0.5/ ./ 基于/ 通信/ 干扰/ 与/ 盗版/ 操作/ 对/ 水印/ 影响/ 的/ 本质/ 不同/ ,/ 在/ 3.3/ 节/ 提出/ 了/ 排除/ 干扰/ 的/ 迭代/ 算法/ ,/ 4.4/ 节/ 测试/ 了/ 其/ 性能/ ./ 在/ 3.4/ 节/ 提出/ 了/ 识别/ 算法/ 并/ 在/ 4.5/ 节/ 基于/ E/ (/ ε/ 1/ )/ 、/ 有/ 界/ 随机变量/ 和/ 的/ ChernoffBound/ 定理/ ,/ 分析/ 了/ TDIA/ 算法/ 的/ 识别/ 误差/ ./ 理论/ 和/ 仿真/ 表明/ ,/ 对于/ BER/ / 10/ -/ 3/ 、/ 视频/ I/ 帧/ 总数/ n/ / 360/ 的/ Mpeg2/ 编码/ 视频/ ,/ TDIA/ 算法/ 能/ 给出/ 识别/ 误差/ 小于/ 10/ -/ 18/ 的/ 识别/ 结果/ ./ 并且/ 随着/ 视频/ 的/ 延长/ ,/ 识别/ 结果/ 指数/ 级/ 下降/ ./ 另外/ ,/ TDIA/ 算法/ 也/ 可/ 应用/ 于/ 其它/ 编码标准/ ,/ 可/ 用于/ 终端/ 在线/ 检测/ ,/ 也/ 可/ 用于/ 离线/ 检测/ ./ 它/ 是/ 一种/ 安全性/ 高/ 、/ 识别/ 准确率/ 高/ 、/ 对/ 通信/ 干扰/ 具备/ 一定/ 容忍性/ 的/ 正版/ 视频/ 识别/ 算法/ ./ 将/ TDIA/ 算法/ 与/ VideoDNA/ 技术/ 结合/ ,/ 可/ 实现/ 盗版/ 视频/ 过滤/ 、/ 禁播/ 等/ ./ 

