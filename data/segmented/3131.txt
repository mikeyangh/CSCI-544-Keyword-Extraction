Page1/ 一种/ 基于/ 粒子/ 的/ 牛顿流体/ 与/ 粘弹性/ 流体/ 统一/ 模拟/ 方法/ 常元章/ 1/ )/ 柳/ 有权/ 2/ )/ 鲍凯/ 3/ )/ 朱鉴/ 1/ )/ 吴恩华/ 1/ )/ ,/ 3/ )/ 1/ )/ (/ 澳门大学/ 科技/ 学院/ 电脑/ 与/ 资讯/ 科学系/ 澳门/ )/ 2/ )/ (/ 长安/ 大学/ 信息/ 工程学院/ 西安/ 710064/ )/ 3/ )/ (/ 中国科学院/ 软件/ 研究所/ 计算机科学/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 摘要/ 在/ 越来越/ 受到/ 人们/ 关注/ 的/ 基于/ 物理/ 流体/ 动画/ 领域/ ,/ 目前/ 分别/ 模拟/ 牛顿流体/ 或/ 粘弹性/ 流体/ 的/ 方法/ 很多/ ,/ 但/ 很少/ 有/ 统一/ 模拟/ 两者/ 的/ 方法/ ./ 文中/ 基于/ 光滑/ 粒子/ 流体/ 动力学/ 方法/ ,/ 通过/ 对/ 传统/ 纳维/ -/ 斯托克斯/ 方程/ 添加/ 弹性/ 应力/ 项/ ,/ 提出/ 了/ 一种/ 新/ 的/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 方法/ ./ 通过/ 实验/ 说明/ 该/ 方法/ 不仅/ 有效/ ,/ 易于/ 实现/ ,/ 而且/ 具有/ 良好/ 的/ 可控性/ ,/ 仅仅/ 通过/ 调节/ 参数/ 就/ 可以/ 模拟/ 不同/ 粘弹性/ 、/ 不同/ 类型/ 的/ 流体/ 现象/ ./ 关键词/ 光滑/ 粒子/ 流体/ 动力学/ ;/ 牛顿流体/ ;/ 粘弹性/ 流体/ ;/ 纳维/ -/ 斯托克斯/ 方程/ ;/ 弹性/ 应力/ 1/ 引言/ 流体/ 现象/ 广泛/ 存在/ 于/ 日常生活/ 、/ 工业生产/ 和计/ Page2/ 定律/ ,/ 即/ 剪应力/ 与/ 剪切/ 应变/ 率/ 之间/ 满足/ 线性关系/ ,/ 粘性/ 不随/ 速度/ 而变/ ,/ 称为/ 牛顿流体/ (/ Newtonianfluid/ )/ ,/ 如水/ 、/ 空气/ 等/ ;/ 而/ 把/ 不/ 满足/ 线性关系/ 的/ 流体/ 称为/ 非/ 牛顿流体/ (/ non/ -/ Newtonianfluid/ )/ ,/ 如/ 胶状物/ 、/ 牙膏/ 等/ ./ 粘弹性/ 流体/ (/ viscoelasticfluid/ )/ ,/ 属于/ 非/ 牛顿流体/ ,/ 它/ 同时/ 具有/ 固体/ 和/ 流体/ 的/ 特征/ ./ 该/ 流体/ 受到/ 应力/ 较/ 小时/ 表现/ 出/ 固体/ 的/ 特征/ ,/ 但/ 应力/ 超过/ 阈值/ 而/ 产生/ 较大/ 应变/ 时/ 又/ 体现/ 出/ 流体/ 的/ 特点/ ./ 很多/ 物质/ 具有/ 这样/ 的/ 特点/ ,/ 如/ 黏液/ 、/ 胶/ 、/ 鸡蛋/ 白/ 、/ 生/ 面团/ 、/ 尚未/ 凝固/ 的/ 混凝土/ 、/ 牙膏/ 、/ 黏土/ 、/ 洗手液/ 、/ 果冻/ 、/ 番茄酱/ 等/ ./ 在/ 计算机/ 模拟/ 流体/ 现象/ 的/ 方法/ 中/ ,/ “/ 无/ 网格/ ”/ 的/ 光滑/ 粒子/ 流体/ 动力学/ (/ SmoothedParticleHydrody/ -/ namics/ ,/ SPH/ )/ 是/ 近年来/ 一种/ 比较/ 流行/ 的/ 方法/ ./ 这种/ 方法/ 不仅/ 容易/ 体现/ 流体/ 的/ 细节/ ,/ 诸如/ 浪花/ 、/ 泡沫/ 和/ 飞溅/ 的/ 效果/ ,/ 而且/ 能/ 很/ 自然/ 地/ 处理/ 有/ 较大/ 拓扑/ 变形/ 的/ 流动/ ,/ 所以/ 得到/ 越来越/ 广泛/ 的/ 应用/ ./ 目前/ 分别/ 模拟/ 牛顿流体/ 或/ 粘弹性/ 流体/ 的/ 方法/ 很多/ ,/ 但/ 很少/ 有/ 统一/ 模拟/ 两者/ 的/ 方法/ ./ 本文/ 基于/ SPH/ 方法/ ,/ 通过/ 对/ 传统/ Navier/ -/ Stokes/ (/ NS/ )/ 方程/ 添加/ 弹性/ 应力/ 项/ ,/ 提出/ 了/ 一种/ 新/ 的/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 方法/ ./ 在/ 实验/ 中/ ,/ 从/ 不同/ 角度/ 对/ 所/ 模拟/ 流体/ 的/ 绘制/ 结果/ 和/ 速度/ 进行/ 了/ 对比/ 、/ 分析/ ,/ 充分说明/ 了/ 本/ 方法/ 的/ 有效性/ ./ 本文/ 第/ 2/ 节/ 介绍/ 图形学/ 领域/ 中/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 提出/ 模拟/ 的/ 统一/ 方法/ ;/ 第/ 4/ 节/ 说明/ 绘制/ 流体/ 场景/ 的/ 方法/ ;/ 第/ 5/ 节对/ 绘制/ 结果/ 从/ 不同/ 角度/ 进行/ 讨论/ 与/ 分析/ ;/ 最后/ 一节/ 总结/ 并/ 提出/ 未来/ 工作/ ./ 2/ 相关/ 工作/ 在/ 计算机/ 图形学/ 领域/ ,/ 基于/ 物理/ 的/ 流体/ 模拟/ 方法/ 大致/ 可以/ 分为/ 两大类/ :/ 基于/ 网格/ 的/ 欧拉/ 方法/ 和/ 基于/ 粒子/ 的/ 拉格朗/ 日/ 方法/ ./ 欧拉/ 方法/ 将/ 流体/ 所/ 占据/ 空间/ 离散/ 成/ 固定/ 的/ 网格/ ,/ 分析/ 网格/ 上/ 每/ 一/ 固定点/ 的/ 流体/ 速度/ 、/ 压强/ 和/ 密度/ 等/ 参数/ 随/ 时间/ 的/ 变化/ ./ 该/ 方法/ 很/ 容易/ 保持/ 流体/ 不可/ 压/ 却/ 不/ 容易/ 保证/ 质量守恒/ ;/ 拉格朗/ 日/ 法则/ 通过/ 研究/ 流体/ 中/ 每/ 一微团/ 的/ 相应/ 物理/ 参数/ 随/ 时间/ 的/ 运动/ 变化/ ,/ 来/ 描述/ 整个/ 流体/ 的/ 运动/ ./ 下面/ 将/ 分别/ 对/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 相关/ 工作/ 做/ 介绍/ ./ 2.1/ 牛顿流体/ 欧拉/ 法/ ./ 1996/ 年/ ,/ Foster/ 等/ 人/ [/ 1/ ]/ 首次/ 在/ 图形学/ 领域/ 通过/ 有限/ 差分/ 的/ 方法/ ,/ 在/ 规则/ 网格/ 上/ 求解/ 三维/ Navier/ -/ Stokes/ 方程/ ./ 接着/ ,/ Stam/ [/ 2/ ]/ 引入/ 了/ 半/ 拉格朗/ 日/ 机制/ 和/ 隐式/ 积分/ 求解/ 的/ 方法/ ,/ 使得/ 计算/ 能够/ 采用/ 较大/ 的/ 时间/ 步长/ ./ 为了/ 准确/ 捕捉/ 流体/ 表面/ 的/ 细节/ ,/ Foster/ 等/ 人/ [/ 3/ ]/ 引入/ 了/ levelset/ 方法/ ,/ 由于/ 该/ 方法/ 体积/ 损失/ 比较严重/ ,/ 作者/ 在/ 流体/ 内部/ 分布/ 一些/ 无/ 质量/ 的/ 粒子/ 来/ 弥补/ 该/ 缺陷/ ./ 不久/ ,/ Enright/ 等/ 人/ [/ 4/ ]/ 提出/ 了/ particlelevelset/ 方法/ ,/ 通过/ 在/ 流体/ 外部/ 同样/ 增加/ 粒子/ 来/ 改进/ levelset/ 方法/ ;/ 且/ 通过/ 将/ 速度/ 外/ 推到/ 空气/ 中来/ 正确处理/ 自由/ 表面/ 处/ 的/ 边界条件/ ,/ 从而/ 获得/ 更加/ 精确/ 的/ 界面/ 和/ 视觉效果/ ./ 粒子/ 法/ ./ SPH/ 是/ 目前/ 最为/ 常用/ 的/ 一种/ 拉格朗/ 日/ 粒子/ 法/ ,/ 该/ 方法/ 利用/ 离散/ 的/ 粒子/ 来/ 表示/ 流体/ ,/ 由于/ 每个/ 粒子/ 包含/ 着/ 各自/ 的/ 质量/ ,/ 且/ 粒子/ 数目/ 在/ 模拟/ 过程/ 中/ 保持/ 不变/ ,/ 使得/ 该/ 方法/ 容易/ 保证/ 流体/ 质量守恒/ ./ 不过/ 由于/ 通常/ 用/ 理想气体/ 状态方程/ 来/ 求解/ 压强/ ,/ 使得/ SPH/ 方法/ 存在/ 弱/ 可压/ 的/ 缺点/ ./ Desbrun/ 等/ 人/ [/ 5/ ]/ 首次/ 将/ 该/ 方法/ 引入/ 图形学/ 领域/ 来/ 计算/ 物体/ 较大/ 变形/ 时/ 的/ 受力/ ./ 接下来/ ,/ M/ ü/ ller/ 等/ 人/ [/ 6/ -/ 7/ ]/ 推广/ 了/ 该/ 方法/ ,/ 实现/ 了/ 交互/ 级/ 的/ 流体/ 模拟/ ./ Adams/ 等/ 人/ [/ 8/ ]/ 通过/ 对/ SPH/ 粒子/ 定义/ 重要/ 度为/ 依据/ 来/ 使/ 其/ 自动/ 合并/ 和/ 分裂/ ,/ 从而/ 有效/ 地/ 加快/ 了/ 模拟/ 的/ 速度/ ./ 最近/ ,/ 越来越/ 多/ 的/ 人/ 将/ 目光/ 投注/ 在/ 更加/ 复杂/ 的/ 流体/ 现象/ 上/ ,/ 例如/ :/ 流体/ 在/ 疏松/ 多孔/ 物质/ 上/ 的/ 流动/ [/ 9/ ]/ 、/ 流体/ 与/ 颗粒状/ 物质/ (/ 如/ 沙粒/ )/ 的/ 交互/ [/ 10/ -/ 11/ ]/ 、/ 多相/ 流/ 自然灾害/ 场景/ 的/ 真实/ 模拟/ [/ 12/ ]/ 等/ ./ 关于/ SPH/ 的/ 全面/ 介绍/ 可以/ 查看/ 文献/ [/ 13/ ]/ ./ 粒子/ 法里/ ,/ 还有/ 一些/ 其他/ 的/ 方法/ ,/ 如/ Premoe/ 等/ 人/ [/ 14/ ]/ 引入/ 了/ MPS/ (/ MovingParticleSemi/ -/ implicit/ )/ 方法/ ,/ 通过/ 解/ 全局/ 泊松/ 方程/ 来/ 求解/ 压强/ ,/ 从而/ 使得/ 流体/ 不可/ 压/ ./ 由于/ 各/ 方法/ 有/ 各自/ 的/ 优势/ 和/ 局限性/ ,/ 目前/ 也/ 出现/ 了/ 一些/ 混合/ 表示/ 的/ 方法/ ,/ 如/ Losasso/ 等/ [/ 15/ ]/ 提出/ 了/ 一种/ 双向/ 耦合/ 的/ 模拟/ 框架/ 来/ 同时/ 利用/ SPH/ 和/ particlelevelset/ 的/ 优点/ ./ 2.2/ 粘弹性/ 流体/ 欧拉/ 法/ ./ Carlson/ 等/ 人/ [/ 16/ ]/ 结合/ Marker/ -/ and/ -/ Cell/ (/ MAC/ )/ 方法/ 模拟/ 了/ 任意/ 粘性/ 的/ 流体/ ,/ 甚至/ 固体/ 也/ 当作/ 高/ 粘性流体/ 处理/ ,/ 其中/ 粘性/ 随/ 温度/ 、/ 水分/ 含量/ 而/ 变化/ ,/ 从而/ 实现/ 了/ 融化/ 、/ 凝固/ 和/ 流动/ 效果/ ./ 通过/ 将/ 粒子/ 分割/ 到/ 高分辨率/ 的/ 网格/ 中来/ 精确/ 抽取/ 表面/ ./ 具体/ 求解/ 中/ ,/ 为了/ 避免/ 高/ 粘性/ 带来/ 的/ 稳定性/ 问题/ ,/ 扩散/ 项/ 采用/ 隐式/ 欧拉/ 代替/ 显式/ 格式/ ,/ 并/ 采用/ 共轭/ 梯度/ 法来/ 迭代/ 计算/ ./ Goktekin/ 等/ [/ 17/ ]/ 通过/ 在/ NS/ 方程/ 中/ 加入/ 弹性/ 应力/ 项/ 成功/ 地/ 模拟/ 了/ 粘弹性/ 流动/ 现象/ ,/ 并/ 采用/ vonMises/ 判据/ 来/ 判断/ 是否/ 会/ 发生/ 塑性/ 流动/ ,/ 如果/ 应变/ 偏差/ 的/ Frobenius/ 范/ 数值/ 大于/ 屈服点/ ,/ 则/ 以/ 正比/ 于/ 超出/ 量/ 的/ 速度/ 塑性/ 流动/ [/ 18/ ]/ ./ 接着/ ,/ 文献/ [/ 19/ ]/ 通过/ 考/ Page3/ 虑/ 旋转/ 张量/ ,/ 对/ 其/ 公式/ 进行/ 了/ 改进/ ,/ 可以/ 真实/ 模拟/ 粘弹性/ 流体/ 的/ 旋转/ 效果/ ./ 粒子/ 法/ ./ Stora/ 等/ [/ 20/ ]/ 采用/ SPH/ 方法/ 逼真/ 地/ 模拟/ 了/ 火山/ 熔岩/ 粘性/ 流动/ 的/ 过程/ ./ 文献/ [/ 21/ ]/ 基于/ 拉格朗/ 日/ 粒子/ 方法/ ,/ 将/ 流体/ 与/ 物体/ 间/ 的/ 力/ 表示/ 成/ 粘附/ 矩阵/ 的/ 形式/ ,/ 同时/ 将/ 物体/ 表面/ 也/ 作/ 粒子/ 化/ 表示/ ,/ 从而/ 可以/ 很/ 方便/ 地/ 描述/ 粘性流体/ 与/ 物体/ 的/ 相互作用/ ./ Mao/ 等/ [/ 22/ ]/ 为了/ 避免/ 文献/ [/ 17/ ]/ 模拟/ 粘弹性/ 流体/ 旋转/ 时候/ 存在/ 的/ 问题/ ,/ 在/ NS/ 方程/ 弹性/ 应力/ 张量/ 项/ 加入/ 旋转/ 张量/ ,/ 并/ 使用/ SPH/ 对/ 流体/ 进行/ 模拟/ ,/ 但/ 其/ 所能/ 模拟/ 的/ 现象/ 仍然/ 很/ 有限/ ./ 接着/ ,/ 作者/ 在/ 此基础/ 上/ 真实/ 地/ 模拟/ 了/ 互不/ 溶/ 粘性流体/ 的/ 碰撞/ 及其/ 响应/ [/ 23/ ]/ ./ Paiva/ 等/ [/ 24/ ]/ 继承/ 了/ 文献/ [/ 16/ ]/ 的/ 想法/ ,/ 使用/ SPH/ 较为/ 真实/ 地/ 再现/ 了/ 物体/ 的/ 熔化/ ,/ 但/ 其/ 模拟/ 的/ 熔化/ 物体/ 和/ 现象/ 较为/ 单一/ ./ 与此同时/ ,/ 越来越/ 多/ 的/ 研究者/ 通过/ 对/ 粒子/ 间/ 增加/ 弹簧/ 来/ 达到/ 粘弹性/ 的/ 效果/ ./ Nixon/ 等/ [/ 25/ ]/ 对/ 物体/ 表面/ 采用/ 质点/ 弹簧/ 模型/ 来/ 表示/ ,/ 内部/ 利用/ NS/ 流体/ 运动/ 方程/ 求解/ 变形/ ,/ 从而/ 可以/ 模拟/ 柔性/ 物体/ 运动/ 变形/ 情况/ ./ Clavet/ [/ 26/ ]/ 通过/ 修改/ 弹簧/ 的/ 静止/ 长度/ 来/ 达到/ 不同/ 的/ 粘弹性/ 、/ 塑性/ 效果/ ./ 而/ Tamura/ [/ 27/ ]/ 则/ 通过/ 随机/ 连接/ 的/ 两种/ 不同/ 的/ 弹簧/ 来/ 模拟/ 粘弹性/ 流体/ 的/ 表面/ ./ 近年来/ ,/ 越来越/ 多/ 的/ 工作/ [/ 28/ -/ 30/ ]/ 集中/ 在/ 通过/ 有限元/ 方法/ 计算/ 应变/ 张量/ (/ straintensor/ )/ 来/ 模拟/ 粘弹性/ 流体/ ./ 其他/ 方法/ ./ Desbrun/ 等/ [/ 31/ ]/ 使用/ 隐式/ 曲面/ 来/ 模拟/ 柔性/ 物体/ 的/ 融合/ ./ Wei/ 等/ [/ 32/ ]/ 采用/ 三维/ 自动/ 格子/ 机/ (/ CellularAutomata/ )/ 的/ 方法/ ,/ 通过/ 重力/ 和/ 传播/ 两个/ 规则/ 来/ 传递/ 热量/ 和/ 流体/ ,/ 该/ 方法/ 的/ 计算/ 量/ 相对/ 于/ 完全/ 基于/ 物理/ 的/ 方法/ 要/ 小/ 很多/ ./ 3/ 统一/ 的/ 流体/ 模拟/ 方法/ 本/ 节/ 阐述/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 方法/ ./ 该/ 方法/ 是/ 通过/ 对/ NS/ 方程/ 添加/ 弹性/ 应力/ 张量/ 项来/ 实现/ 的/ ./ 本节/ 重点/ 对/ 该项/ 的/ 求解/ 进行/ 剖析/ ,/ 并/ 讨论/ 流体/ 运动/ 时/ 与/ 障碍物/ 的/ 碰撞/ 处理/ 及/ 模拟/ 流程/ ./ 3.1/ 统一/ 的/ 模拟/ 方法/ SPH/ 是/ 一种/ 完全/ 无/ 网格/ 的/ 拉格朗/ 日/ 方法/ ,/ 流体/ 运动/ 用/ 跟随/ 流动/ 的/ 粒子/ 运动/ 来/ 描述/ ./ 流动/ 的/ 粒子/ 储存/ 了/ 自己/ 的/ 质量/ 、/ 速度/ 和/ 位置/ 等/ 物理/ 信息/ ./ 空间/ 任一/ 位置/ 狉/ 处/ 的/ 属性/ A/ 可/ 通过/ 周围/ 粒子/ 插值/ 来/ 计算/ :/ 其中/ ,/ 下标/ j/ 表示/ 将/ 位置/ 狉/ 周围/ 支持/ 域/ 内/ 的/ 所有/ 粒子/ 求和/ ,/ W/ (/ 狉/ -/ 狉/ j/ ,/ h/ )/ 是/ 半径/ 为/ h/ 的/ 光滑/ 核/ 函数/ ,/ 狉/ j/ ,/ mj/ 和/ ρ/ j/ 分别/ 为/ 粒子/ j/ 的/ 位置矢量/ 、/ 质量/ 和/ 密度/ ./ 属性/ A/ 的/ 梯度/ 值/ 和/ 拉普拉斯/ 值/ 也/ 可以/ 通过/ 对/ 光滑/ 核/ 函数/ W/ (/ 狉/ -/ 狉/ j/ ,/ h/ )/ 求/ 相应/ 值来/ 得到/ :/ 与/ 传统/ 的/ 欧拉/ 方法/ 相同/ ,/ SPH/ 也/ 是/ 通过/ 求解/ 流体力学/ 方程/ 来/ 对/ 流体/ 进行/ 模拟/ 的/ ./ 对于/ 恒温/ 的/ 不可/ 压/ 流体/ ,/ 描述/ 其/ 运动/ 的/ 主要/ 方程/ 包括/ 质量守恒/ 方程/ (/ 连续性/ 方程/ )/ 和/ 动量/ 守恒/ 方程/ (/ Navier/ -/ Stokes/ 方程/ )/ :/ ρ/ D/ 狏/ Dt/ =/ -/ / p/ +/ μ/ / 2/ 狏/ +/ μ/ s/ / ·/ Selastic/ +/ ρ/ 犵/ +/ 犳/ surface/ 其中/ 狏/ ,/ p/ ,/ ρ/ ,/ 犵/ ,/ μ/ 分别/ 为/ 速度/ 矢量/ 、/ 压强/ 、/ 密度/ 、/ 重力/ 加速度/ 矢量/ 和/ 动力/ 粘度系数/ ./ μ/ s/ / ·/ Selastic/ 为/ 本文/ 为了/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 而/ 对/ 传统/ NS/ 方程/ 添加/ 的/ 弹性/ 应力/ 项/ ,/ μ/ s/ 为/ 弹性/ 应力/ 系数/ ,/ Selastic/ 为/ 弹性/ 应变/ 张量/ ,/ 其/ 求解/ 方法/ 下/ 一/ 小节/ 具体/ 介绍/ ./ 犳/ pressure/ 、/ 犳/ viscosity/ 、/ 犳/ elastic/ 和/ 犳/ surface/ 为/ 对应/ 的/ 压/ 强力/ 项/ 、/ 粘滞/ 力项/ 、/ 弹性/ 应力/ 项/ 和/ 表面张力/ 项/ ./ 由于/ SPH/ 采用/ 的/ 粒子/ 数目/ 在/ 模拟/ 过程/ 中/ 保持/ 不变/ ,/ 且/ 每个/ 粒子/ 质量/ 不变/ ,/ 因此/ SPH/ 能够/ 自动/ 保证/ 质量守恒/ ./ 的/ 方法/ :/ 犳/ pressurei/ =/ μ/ ∑/ j/ 犳/ viscosityi/ =/ -/ σ/ 狀/ i/ 犳/ surface/ 压/ 强力/ 、/ 粘滞/ 力/ 和/ 表面张力/ 的/ 计算/ 采用/ 文献/ [/ 6/ ]/ 其中/ σ/ 为/ 表面张力/ 系数/ ,/ δ/ 为/ 预定/ 义/ 的/ 阈值/ ,/ 当/ 超过/ 该/ 阈值/ 时/ 表明/ 粒子/ 位于/ 流体/ 表面/ ./ 狀/ i/ 为/ 表面/ 法向/ ,/ 计算/ 为/ 为了/ 求解/ 式/ (/ 6/ )/ 和/ (/ 7/ )/ ,/ 需要/ 首先/ 求得/ 粒子/ 的/ 密度/ 和/ 压强/ ,/ 密度/ 计算/ 如下/ :/ 接着/ ,/ 粒子/ 的/ 压强/ 可以/ 通过/ 理想气体/ 状态方程/ 得到/ [/ 5/ ]/ :/ Page4/ 公式/ 中/ k/ 为/ 与/ 流体/ 声速/ 相关/ 的/ 常数/ ,/ ρ/ 0/ 为/ 预先/ 设定/ 的/ 平衡/ 密度/ 常数/ ./ 弹性/ 应力/ 项/ 可以/ 通过/ SPH/ 插值/ 表示/ 为/ 犳/ elastic3/ ./ 2/ 弹性/ 应力/ 项/ 的/ 求解/ 本/ 部分/ 推导/ 弹性/ 应变/ 张量/ Selastic/ 的/ 计算公式/ ./ 如果/ 能够/ 获得/ 流体/ 的/ 显式/ 变形/ 函数/ ,/ 则/ 该值/ 可以/ 通过/ 变形/ 函数/ 的/ 空间/ 导数/ 求得/ ./ 然而/ ,/ 由于/ 流体/ 运动/ 变形/ 的/ 复杂性/ ,/ 几乎/ 不/ 可能/ 找到/ 一个/ 有效/ 描述/ 的/ 公式/ ./ 因此/ ,/ 我们/ 通过/ 将/ 弹性/ 应变/ 张量/ 分解/ 为/ 总/ 应变/ 张量/ 与/ 塑性/ 应变/ 张量/ 的/ 差来/ 间接/ 求解/ :/ 由于/ 后/ 两项/ 也/ 较/ 难/ 获得/ ,/ 可以/ 转化/ 为求/ 其/ 时间/ 导数/ 的/ 方式/ :/ 0/ 和/ Splastic/ 其中/ Stotal/ 量/ 与/ 塑性/ 应变/ 张量/ ,/ 本文/ 实现/ 过程中将/ 其/ 设定/ 为/ 零/ 矩阵/ ./ 上述/ 公式/ 后/ 半/ 部分/ 带有/ 积分/ 运算/ ,/ 在/ 数值/ 求解/ 过程/ 中/ 需要/ 将/ 其/ 离散/ 化/ :/ 公式/ 中/ Δ/ t/ 为/ 时间/ 步长/ ./ 下面/ 分别/ 求解/ dStotaldSplasticdt/ ./ 前者/ 即/ 为/ 应变/ 率/ 张量/ ,/ 可/ 通过/ 速度/ 的/ 梯度/ 来/ 求得/ 其中/ / 狏/ 为/ 雅/ 可比/ 矩阵/ ,/ 在/ SPH/ 计算/ 中/ 可/ 求解/ 如下/ 塑性/ 应变/ 张量/ 导数/ 的/ 求解/ 需要/ 引入/ 另外/ 一个/ 量/ ,/ 弹性/ 应变/ 偏差/ S/ ,/ 其/ 数值/ 可/ 通过/ 弹性/ 应变/ 张量/ Selastic/ 求得/ 公式/ 中/ Tr/ (/ Selastic/ )/ 为/ 张量/ 方阵/ 的/ 迹/ ,/ 犐/ 为/ 单位矩阵/ ./ 根据/ 冯/ ·/ 米/ 赛斯/ 屈服/ 准则/ (/ vonMises/ ’/ syieldcriterion/ )/ ,/ 当/ S/ 的/ Frobenius/ 范/ 数值/ 低于/ 阈值/ τ/ 时/ ,/ 没有/ 塑性/ 流动/ ./ 当/ 超过/ 该值/ 时/ ,/ 流动/ 的/ 速率/ 将会/ 正比/ 于/ 所/ 超出/ 的/ 数值/ ,/ 表达/ 为/ 其中/ λ/ 为/ 所/ 模拟/ 流体/ 的/ 弹性/ 衰减系数/ ./ Sf/ 为/ 张量/ S/ 的/ Frobenius/ 范数/ ,/ 定义/ 为/ 张量/ 矩阵/ 内部/ 各/ 元素/ 平方和/ 的/ 平方根/ :/ 这样/ ,/ 式/ (/ 16/ )/ 可以/ 变为/ dSelasticdt/ =/ (/ / 狏/ +/ (/ / 狏/ )/ T/ )/ // 2/ -/ λ/ S/ 将式/ (/ 23/ )/ 代入/ 式/ (/ 17/ )/ 就/ 可以/ 求得/ 每/ 一时间/ 步/ 的/ 弹性/ 应变/ 张量/ Selastic/ ./ 3.3/ 障碍物/ 碰撞/ 处理/ 及/ 模拟/ 流程/ 本/ 节/ 讨论/ 流体/ 粒子/ 运动/ 时/ 与/ 边界/ 固体/ 障碍物/ 的/ 碰撞/ 处理/ ,/ 采用/ 的/ 方法/ 与/ 文献/ [/ 26/ ]/ 类似/ 但/ 略有/ 改动/ ./ 为了/ 检测/ 粒子/ 与/ 边界/ 固体/ 的/ 碰撞/ ,/ 程序/ 初始化/ 之前/ 需/ 预先/ 对/ 模拟/ 场景/ 进行/ 距离/ 场/ 采样/ 并/ 保存/ 到/ 背景/ 网格/ 中/ ./ 接着/ ,/ 在/ 模拟/ 过程/ 中/ ,/ 对/ 每个/ 粒子/ 插值/ 计算/ 出/ 符号/ 距离/ 值/ d/ ,/ 并/ 判断/ 该值/ 与/ 边界/ 固体/ 碰撞/ 阈值/ T/ 的/ 大小/ ,/ 如果/ 小于/ 该/ 阈值/ 表明/ 发生/ 碰撞/ ./ 同时/ ,/ 碰撞/ 点/ 表面/ 法向狀/ o/ 可/ 通过/ 距离/ 场/ 梯度/ 求得/ ./ 当/ 检测/ 到/ 碰撞/ 且/ 粒子/ 已/ 进入/ 障碍物/ 内部/ 时/ ,/ 则/ 将/ 粒子/ 位置/ 沿着/ 表面/ 法向狀/ o/ 垂直/ 投影/ 到/ 表面/ ;/ 同时/ 修改/ 其/ 速度/ 如下/ :/ 假设/ 碰撞/ 粒子/ 相对/ 于/ 障碍物/ 的/ 速度/ 为/ 狏/ (/ 本文/ 实现/ 设定/ 障碍物/ 固定不动/ ,/ 相对速度/ 等于/ 粒子/ 自身/ 速度/ )/ ,/ 将/ 其/ 沿/ 障碍物/ 界面/ 的/ 法切/ 向/ 分解/ 为/ 碰撞/ 后/ 的/ 法向/ 和/ 切向速度/ 将/ 变为/ 其中/ ,/ α/ 为法/ 向/ 速度/ 修改/ 系数/ ,/ 实验/ 取值/ 0.05/ ,/ 碰撞/ 后法/ 向/ 速度/ 反向/ ./ β/ 为/ 表面/ 摩擦系数/ ,/ 控制/ 障碍物/ 表面/ 的/ 滑移/ 特性/ ,/ 可以/ 获得/ 自由/ 滑移/ 边界条件/ (/ β/ =/ 1/ )/ 和/ 无/ 滑移/ 边界条件/ (/ β/ =/ 0/ )/ ,/ 本文/ 取值/ 0.9/ ./ 碰撞/ 后/ 的/ 总/ 速度/ 为/ 切法/ 向/ 两/ 速度/ 之/ 和/ ./ 以上/ 各节/ 已经/ 讨论/ 了/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ SPH/ 方法/ ./ 实际/ 流程/ 主要/ 分为/ 以下/ 步骤/ :/ 1/ ./ 程序/ 初始化/ ./ 包括/ 参数/ 、/ 几何/ 场景/ 、/ 初始/ 粒子/ 分布/ 等/ Page5/ 的/ 初始化/ ./ 2/ ./ 对/ 每个/ 粒子/ 查找/ 周围/ 粒子/ 并/ 求解/ 光滑/ 核/ 函数/ W/ (/ 狉/ -/ 狉/ j/ ,/ h/ )/ 及/ 对应/ 的/ 梯度/ 和/ 拉普拉斯/ 值/ ./ 3/ ./ 对/ 每个/ 粒子/ 计算/ 密度/ 和/ 压强/ ./ 4/ ./ 计算/ 压/ 强力/ 、/ 粘滞/ 力/ 、/ 弹性/ 应力/ 和/ 表面张力/ ,/ 并/ 代入/ 式/ (/ 5/ )/ 求解/ 粒子/ 的/ 加速度/ ./ 5/ ./ 通过/ 数值积分/ 计算/ 粒子/ 的/ 速度/ 和/ 位置/ ,/ 本文/ 采用/ 显式/ 欧拉/ 积分/ ,/ 为/ 保证/ 计算/ 稳定/ ,/ 时间/ 步长/ 应/ 满足/ CFL/ 条件/ [/ 33/ ]/ ./ 6/ ./ 判断/ 粒子/ 是否/ 进入/ 固体/ 障碍物/ 内部/ ,/ 如/ 进入/ ,/ 进行/ 碰撞/ 处理/ ./ 继续/ 运行/ ,/ 转步/ 2.4/ 场景/ 绘制/ 第/ 3/ 节/ 计算/ 出/ 流体/ 粒子/ 运动/ 的/ 位置/ 、/ 速度/ 等/ 物理/ 信息/ ,/ 接下来/ 需要/ 构建/ 流体/ 表面/ ./ 我们/ 采用/ 文献/ [/ 8/ ]/ 的/ 隐式/ 表面/ 定义方法/ :/ / (/ 狉/ )/ =/ ∑/ j/ 其中/ dj/ 为/ 粒子/ j/ 到/ 表面/ 的/ 距离/ ,/ 计算方法/ 、/ 核/ 函数/ 定义/ 均/ 与/ 文献/ [/ 8/ ]/ 相同/ ./ 接着/ ,/ 我们/ 采用/ marchingcubes/ [/ 34/ ]/ 算法/ 来/ 对/ 定义/ 好/ 的/ 隐式/ 表面/ 进行/ 三角形/ 化/ ,/ 并用/ 渲染/ 引擎/ POV/ -/ Ray/ ①/ 来/ 对/ 提取/ 出/ 的/ 三角形/ 图/ 1/ 立方体/ 流体/ 块/ 降落/ 实验/ 结果/ (/ 从左到右/ 时刻/ 为/ 0s/ ,/ 0.33/ s/ ,/ 0.58/ s/ ,/ 2s/ )/ 图/ 2/ 穿山甲/ 降落/ 实验/ 结果/ (/ 从左到右/ 时刻/ 为/ 0s/ ,/ 0.25/ s/ ,/ 0.57/ s/ ,/ 2s/ )/ 网格/ 进行/ 绘制/ ./ 5/ 绘制/ 结果/ 与/ 讨论/ 为了/ 验证/ 本文/ 方法/ 的/ 有效性/ 和/ 通用性/ ,/ 我们/ 实现/ 了/ 立方体/ 流体/ 块/ 降落/ 、/ 穿山甲/ 降落/ 、/ 兔子/ 斜坡/ 滑落/ 和/ 立方体/ 流体/ 穿越/ 障碍物/ 4/ 个/ 实验/ 的/ 真实感/ 建模/ 与/ 绘制/ ./ 实验/ 平台/ 为/ IntelCore2DuoE84003/ ./ 0GHzCPU/ ,/ 3GB/ 内存/ 和/ GeForce8800GTGPU/ 的/ PC机/ ./ 实验/ 程序/ 采用/ C++/ 开发/ ./ 实验/ 中/ 采用/ 的/ 数值/ 计算/ 时间/ 步长/ 为/ 0.001/ s/ ,/ 每/ 5/ 个/ 时间/ 步/ 输出/ 一帧/ 渲染/ 数据/ ./ 5.1/ 模拟/ 现象/ 比较/ 本/ 节/ 主要/ 通过/ 4/ 组/ 实验/ 从/ 不同/ 角度/ 对比/ 模拟/ 的/ 牛顿流体/ (/ 实验/ 中为/ 水/ )/ 和/ 粘弹性/ 流体/ 的/ 异同/ ./ 式/ (/ 5/ )/ 中/ 参数/ μ/ 和/ μ/ s/ 用来/ 控制/ 模拟/ 流体/ 的/ 种类/ 和/ 粘滞/ 度/ ,/ 水/ 的/ 参数/ μ/ 和/ μ/ s/ 设定/ 为/ 8/ ×/ 104/ 和/ 0/ ,/ 粘弹性/ 流体/ 相应/ 为/ 8/ ×/ 105/ 和/ 8/ ×/ 106/ ,/ 其它/ 模拟/ 参数/ 都/ 相同/ ./ 图/ 1/ 对比/ 了/ 立方体/ 流体/ 块/ 从/ 空中/ 降落/ 到/ 地面/ 的/ 过程/ ./ 可以/ 看到/ ,/ 表面张力/ 使得/ 水块/ 在/ 降落/ 过程/ 中/ 变成/ 球体/ ,/ 但/ 该力/ 对于/ 粘弹性/ 流体/ 的/ 影响/ 较/ 小/ ./ 落到/ 地面/ 后/ ,/ 前者/ 会/ 形成/ 水花/ 飞溅/ 起来/ 并/ 最终/ 落地/ 归于/ 平静/ ;/ 而/ 后者/ 会先/ 水平/ 撑开/ 接着/ 弹性/ 回拢/ 并/ 最终/ 平衡/ 于/ 棱台/ 状/ ./ 图/ 2/ 说明/ 了/ 本文/ 提出/ 的/ 方法/ 同样/ 适用/ 于/ 复杂/ 的/ ①/ POV/ -/ Rayurl/ :/ http/ :/ // // www/ ./ povray/ ./ org/ // Page6/ 几何/ 形体/ ./ 穿山甲/ 水体/ 会/ 溅/ 起/ 更/ 多/ 的/ 水花/ ,/ 在/ 2s/ 时/ 静止/ 于方行/ 边界/ 内/ ,/ 而/ 粘弹性/ 体则/ “/ 下/ 蹲/ ”/ 并/ “/ 趴/ ”/ 在/ 地上/ ./ 图/ 3/ 与/ 图/ 4/ 用来/ 说明/ 边界/ 障碍物/ 的/ 滑移/ 特性/ ,/ 由于/ 本文/ 设定/ 式/ (/ 27/ )/ 的/ β/ 取值/ 0.9/ ,/ 即/ 边界/ 面/ 近似/ 光滑/ ,/ 本/ 特征/ 可以/ 从图/ 4/ 看到/ ./ 图/ 5/ 和/ 图/ 6/ 描述/ 了/ 流图/ 3/ 水/ 兔子/ 斜坡/ 滑落/ 实验/ 结果/ (/ 从左到右/ 时刻/ 为/ 0s/ ,/ 0.25/ s/ ,/ 0.53/ s/ ,/ 1.2/ s/ ,/ 4.09/ s/ )/ 图/ 4/ 粘弹性/ 兔子/ 斜坡/ 滑落/ 实验/ 结果/ (/ 从左到右/ 时刻/ 为/ 0s/ ,/ 0.25/ s/ ,/ 0.4/ s/ ,/ 0.55/ s/ ,/ 1.5/ s/ )/ 图/ 5/ 水/ 立方体/ 穿越/ 障碍物/ 实验/ 结果/ (/ 从左到右/ 依次/ 为/ 俯视图/ 、/ 仰视/ 0s/ ,/ 0.3/ s/ ,/ 0.5/ s/ ,/ 3.46/ s/ 时刻/ )/ 图/ 6/ 粘弹性/ 立方体/ 穿越/ 障碍物/ 实验/ 结果/ (/ 从左到右/ 依次/ 为/ 俯视图/ 、/ 仰视/ 0s/ ,/ 0.525/ s/ ,/ 1.85/ s/ ,/ 5.4/ s/ 时刻/ )/ 5.2/ 实验/ 参数/ 比较/ 实验/ 参数/ 对于/ 本文/ 实验/ 起着/ 至关重要/ 的/ 作用/ ,/ 通过/ 调整/ 参数值/ 能够/ 模拟/ 各种/ 不同/ 特性/ 的/ 流体/ ./ 其中/ ,/ 式/ (/ 5/ )/ 的/ 参数/ μ/ 、/ μ/ s/ 和/ 式/ (/ 23/ )/ 的/ τ/ 最为/ 重要/ ./ 鉴于/ 立方体/ 流体/ 块/ 降落/ 实验/ 具有/ 简单/ 、/ 效果/ 对/ 参数/ 较为/ 敏感/ 的/ 特点/ ,/ 接下来/ 将/ 通过/ 该/ 实验/ 来/ 对/ 这/ 3/ 个/ 参数/ 的/ 作用/ 作/ 对比/ 分析/ ./ 参数/ μ/ 越大/ ,/ 流体/ 粘性/ 越大/ ./ 图/ 7/ 说明/ 当/ μ/ s/ ,/ τ/ 一定/ 时/ ,/ 流体/ 粘性/ 随着/ μ/ 的/ 增大/ 而图/ 7/ 参数/ 作用/ 实验/ 1/ (/ 参数/ μ/ s/ 为/ 0/ ,/ τ/ 为/ 0.005/ ,/ μ/ 从左到右/ 依次/ 为/ 8/ ×/ 104/ ,/ 2/ ×/ 105/ 和/ 8/ ×/ 105/ ,/ 时刻/ 为/ 0.6/ s/ )/ 体/ 如何/ 经过/ 复杂/ 边界/ ,/ 从图/ 中/ 可以/ 看到/ 两种/ 流体/ 均/ 部分/ 穿越/ 井/ 字形/ 障碍/ ,/ 之后/ 水块/ 溅/ 起/ 大量/ 水花/ ,/ 并/ 最终/ 几乎/ 全部/ 落到/ 地上/ ;/ 粘弹性/ 流体/ 块/ 则/ 沿着/ 未/ 被/ 遮挡/ 的/ 空隙/ 一点点/ 断断续续/ 地/ 降落/ ,/ 5.4/ s/ 时/ 仍/ 有/ 部分/ 滞留/ 于/ 障碍物/ 上/ ./ 增大/ ,/ 同一/ 时刻/ 溅/ 起/ 的/ 水花/ 越来越少/ ./ 参数/ μ/ s/ 越大/ ,/ 流体/ 越/ 具有/ 粘弹性/ ./ 图/ 8/ 说明/ 了/ μ/ ,/ τ/ 值/ 一定/ 时/ ,/ 随着/ μ/ s/ 的/ 增大/ ,/ 流体/ 粘性/ 和/ 弹性/ 增大/ ,/ 模拟/ 平衡/ 状态/ 时/ ,/ 从左到右/ 棱台/ 的/ 形状/ 越来越/ 高瘦/ ./ 参数/ τ/ 对于/ 粘弹性/ 流体/ 较/ 重要/ ,/ 它/ 影响/ 棱台/ 的/ 形状/ ,/ 其值/ 越大/ ,/ 棱台/ 越/ 高瘦/ ,/ 流体/ 弹性/ 越大/ (/ 图/ 9/ )/ ,/ 其值/ 为/ 0.05/ 时/ ,/ 可以/ 在/ 视频/ 中/ 看到/ 立方体/ 居然/ 反复/ 地/ 弹性/ “/ 跳动/ ”/ ./ Page7/ 图/ 8/ 参数/ 作用/ 实验/ 2/ (/ 参数/ μ/ 为/ 8/ ×/ 105/ ,/ τ/ 为/ 0.005/ ,/ μ/ s/ 从左到右/ 依次/ 为/ 0/ ,/ 5/ ×/ 106/ 和/ 8/ ×/ 106/ ,/ 时刻/ 为/ 1.5/ s/ )/ 图/ 9/ 参数/ 作用/ 实验/ 3/ (/ 参数/ μ/ 为/ 8/ ×/ 105/ ,/ μ/ s/ 为/ 8/ ×/ 106/ ,/ τ/ 从左到右/ 依次/ 为/ 0/ ,/ 0.005/ 和/ 0.05/ ,/ 时刻/ 为/ 1.5/ s/ )/ 5.3/ 运行/ 速度/ 比较/ 表/ 1/ 列出/ 5.1/ 节/ 各/ 实验/ 的/ 粒子/ 数及/ 运行/ 速度/ ,/ 可以/ 看到/ ,/ 粒子/ 数越/ 多/ ,/ 运行/ 越慢/ ./ 而/ 相同/ 粒子/ 数/ 情况/ 下/ ,/ 粘弹性/ 流体/ 比/ 牛顿流体/ 的/ 计算速度/ (/ 平均/ 每秒/ 帧/ 数/ Fps/ ,/ 不/ 包含/ 渲染/ 时间/ )/ 要慢/ 15/ %/ ~/ 20/ %/ 左右/ ./ 对比/ 实验/ 1/ 与/ 实验/ 4/ ,/ 可以/ 发觉/ 障碍物/ 对于/ 计算速度/ 的/ 影响/ 较/ 小/ ./ 1/ 立方体/ 块/ 降落/ 水/ 60841.922/ 穿山甲/ 降落/ 3/ 兔子/ 斜坡/ 滑落/ 水/ 23745.034/ 立方体/ 过/ 障碍物/ 水/ 60841.906/ 结论/ 与/ 未来/ 工作/ 本文/ 基于/ SPH/ 方法/ ,/ 通过/ 对/ 传统/ Navier/ -/ Stokes/ 方程/ 添加/ 弹性/ 应力/ 项/ ,/ 提出/ 了/ 一种/ 统一/ 模拟/ 牛顿流体/ 和/ 粘弹性/ 流体/ 的/ 方法/ ./ 实验/ 从/ 不同/ 角度/ 对/ 所/ 模拟/ 流体/ 的/ 渲染/ 结果/ 和/ 速度/ 进行/ 了/ 对比/ 、/ 分析/ ,/ 充分说明/ 了/ 本/ 方法/ 的/ 有效性/ ,/ 且/ 通过/ 调整/ 参数/ 可以/ 模拟/ 不同/ 粘弹性/ 、/ 不同/ 类型/ 的/ 流体/ ./ 本文/ 方法/ 还/ 具有/ 易于/ 实现/ 的/ 特点/ ,/ 可以/ 很/ 方便/ 地/ 添加/ 到/ 其它/ 流体/ 现象/ 模拟/ 中/ ./ 今后/ ,/ 我们/ 将/ 进一步/ 拓展/ 本/ 方法/ 所/ 能/ 模拟/ 的/ 现象/ ,/ 并/ 考虑/ 采用/ GPU/ 进行/ 并行/ 加速/ ./ 

