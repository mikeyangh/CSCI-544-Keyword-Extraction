Page1/ 科学计算/ 浮点/ 数据/ 的/ 高性能/ 无损压缩/ 何克晶/ (/ 华南理工大学/ 计算机科学/ 与/ 工程学院/ 广州/ 510641/ )/ 摘要/ 科学计算/ 在/ 科学界/ 及/ 工业界/ 发挥/ 着/ 越来越/ 重要/ 的/ 作用/ ,/ 所/ 随之/ 产生/ 的/ 科学/ 数据/ 也/ 越来越/ 多/ ./ 因/ 二级/ 存储/ (/ 如/ 硬盘/ )/ 的/ 读写/ 速度/ 通常/ 较慢/ ,/ 庞大/ 的/ 数据量/ 除了/ 占据/ 存储空间/ 之外/ ,/ 还/ 影响/ 着/ 系统/ 性能/ ./ 文中/ 通过/ 系统/ 研究/ 浮点/ 数据/ 的/ 特性/ ,/ 建立/ 预测/ 精度/ 和/ 压缩比/ 之间/ 的/ 关系/ 的/ 理论体系/ ./ 通过/ 利用/ 科学/ 数据/ 之间/ 的/ 相关性/ ,/ 采用/ 多种/ 预测器/ 以及/ 高效/ 熵/ 编码方法/ ,/ 提出/ 一种/ 科学/ 数据/ 高性能/ 无损压缩/ 方法/ ./ 该/ 方法/ 既/ 不/ 需要/ 使用者/ 有/ 关于/ 原始数据/ 的/ 先验/ 知识/ ,/ 也/ 不/ 需要/ 使用者/ 自行设计/ 预测器/ ./ 通过/ 与/ 其他/ 压缩/ 方法/ 进行/ 比较/ ,/ 结果表明/ 文中/ 方法/ 的/ 压缩比/ 远高于/ 其他/ 方法/ ,/ 并/ 同时/ 具有/ 恒定/ 的/ 海量/ 压缩/ 吞吐量/ ./ 该/ 方法/ 已/ 被/ 应用/ 于/ 大规模/ 颗粒/ 动力学/ 仿真/ 系统/ 的/ 数据压缩/ ./ 关键词/ 科学计算/ ;/ 浮点/ 数据/ ;/ 无损压缩/ ;/ 高性能/ 1/ 引言/ 随着/ 科学计算/ 技术/ 在/ 科学界/ 及/ 工程界/ 的/ 广泛应用/ ,/ 所/ 随之/ 产生/ 的/ 科学/ 数据/ 也/ 越来越/ 多/ ./ 主要/ 的/ 科学/ Page2/ 查点/ 数据量/ 也/ 非常/ 大/ ./ 因/ 硬盘/ I/ // O/ 操作/ 通常/ 较慢/ ,/ 庞大/ 的/ 数据量/ 除了/ 占据/ 存储空间/ 之外/ ,/ 还/ 影响/ 着/ 系统/ 性能/ ./ 为了/ 减少/ 科学/ 数据/ 所/ 需/ 的/ 存储空间/ 大小/ ,/ 许多/ 研究者/ 都/ 借助/ 压缩工具/ 来/ 对/ 数据/ 进行/ 压缩/ ./ 目前/ 最/ 广为/ 采用/ 的/ 有/ 两种/ 方式/ :/ 第/ 1/ 种/ 方式/ 在/ 数据/ 产生/ 之后/ ,/ 再/ 借助/ 第三方/ 的/ 压缩工具/ 进行/ 压缩/ ./ 第/ 2/ 种/ 方式/ 中/ ,/ 压缩算法/ 作为/ 模拟/ 软件/ 的/ 数据/ 过滤器/ (/ filter/ )/ ,/ 数据/ 通过/ 过滤器/ 处理/ ,/ 直接/ 产生/ 压缩/ 后/ 的/ 数据/ ./ 不管/ 哪/ 种/ 方式/ ,/ 借助/ 的/ 都/ 是/ 通用/ 压缩算法/ ./ 科学/ 数据/ 与/ 通常/ 数据/ 有着/ 本质/ 的/ 不同/ ./ 在/ 模拟系统/ 中/ ,/ 科学/ 数据/ 多/ 是/ 以/ 高精度/ 浮点数/ 的/ 形式/ 存在/ ,/ 所/ 产生/ 的/ 检查点/ 数据/ 和/ 结果/ 数据/ 也/ 多/ 是/ 一维/ 或者/ 多维/ 的/ 浮点/ 数组/ ./ 通用/ 压缩算法/ 对于/ 文本/ 的/ 压缩/ 效果/ 很/ 好/ ,/ 但/ 无法/ 充分利用/ 科学/ 数据/ 本身/ 以及/ 浮点数/ 本身/ 的/ 特性/ ,/ 从而/ 导致/ 最终/ 的/ 时间/ 性能/ 和/ 空间/ 性能/ 较差/ ./ 本文/ 提出/ 一种/ 科学/ 数据/ 高性能/ 无损压缩/ 方法/ ,/ 它/ 通过/ 利用/ 科学/ 数据/ 之间/ 的/ 相关性/ 以及/ 浮点数/ 本身/ 的/ 特性/ 来/ 进行/ 预测/ 编码/ ,/ 从而/ 进行/ 快速/ 有效/ 的/ 科学/ 数据压缩/ ./ 该/ 方法/ 既/ 不/ 需要/ 使用者/ 有/ 关于/ 原始数据/ 的/ 先验/ 知识/ ,/ 也/ 不/ 需要/ 使用者/ 自行设计/ 预测器/ ./ 该/ 方法/ 既/ 可/ 作为/ 单独/ 科学/ 数据/ 压缩工具/ 的/ 内核/ 使用/ ,/ 也/ 可/ 作为/ 模拟/ 软件/ 的/ 高性能/ 数据/ 过滤器/ ./ 通过/ 与/ 常用/ 压缩工具/ 进行/ 比较/ ,/ 结果表明/ 该/ 方法/ 在/ 时间/ 性能/ 和/ 空间/ 性能/ 上均/ 优于/ 通用/ 算法/ ./ 该/ 方法/ 已/ 被/ 应用/ 于/ 大规模/ 离散/ 元/ 科学/ 仿真/ 系统/ 的/ 数据压缩/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 研究/ ;/ 第/ 3/ 节/ 给出/ 该/ 科学/ 数据/ 高性能/ 无损压缩/ 方法/ 的/ 详细/ 介绍/ ,/ 包括/ 系统/ 框架/ 和/ 该/ 方法/ 的/ 关键技术/ :/ 预测器/ 、/ 熵/ 编码/ 等/ ;/ 第/ 4/ 节对/ 该/ 方法/ 进行/ 评估/ ;/ 第/ 5/ 节/ 总结/ 全文/ ./ 2/ 相关/ 工作/ 目前/ 对/ 通用/ 科学/ 数据/ 的/ 压缩/ 较/ 多/ 采用/ 的/ 还是/ 通用/ 压缩/ 方法/ 和/ 工具/ ,/ 如/ Gzip/ 、/ Bzip2/ 等/ ./ 有/ 部分/ 研究/ 对/ 科学/ 模型/ 以及/ 网格/ (/ Mesh/ )/ 数据/ 的/ 压缩/ 进行/ 了/ 探索/ ./ 其中/ 最有/ 代表性/ 的/ 为/ 文献/ [/ 1/ -/ 2/ ]/ ./ 这些/ 研究/ 往往/ 通过/ 对/ 三维/ 网格/ 数据/ 进行/ 分析/ 处理/ ,/ 从而/ 对/ 相应/ 的/ 几何/ 数据/ 和/ 连通性/ 数据/ 进行/ 去/ 冗余/ 压缩/ ./ Isenburg/ 等/ [/ 3/ ]/ 针对/ 网格/ 数据/ 多为/ 浮点数/ 的/ 特点/ ,/ 设计/ 了/ 针对/ 浮点数/ 存储/ 格式/ 的/ 网格/ 数据压缩/ 方法/ ./ 随后/ ,/ Lindstrom/ 等/ [/ 4/ ]/ 通过/ 使用/ Lorenzo/ 预测器/ [/ 5/ ]/ ,/ 继续/ 将/ 该/ 方法/ 拓展/ 到/ 具有/ 空间/ 冗余/ 性/ 的/ 浮点/ 数据压缩/ ./ 在/ 本文/ 的/ 横向/ 比较/ 中/ ,/ 该/ 方法/ 简称/ PLMI/ ./ 该/ 方法/ 只/ 适用/ 于/ 具有/ 空间/ 冗余/ 性/ 的/ 空间数据/ ,/ 如/ 二维/ 图像/ 、/ 三维/ 速度/ 场/ 数据/ 等/ ./ 并且/ 使用/ 时/ 必须/ 显式/ 指定/ 每个/ 数据/ 维/ 的/ 大小/ ./ Engelson/ 等/ [/ 6/ ]/ 使用/ 外延/ 预测器/ 来/ 压缩/ 存储/ 模拟/ 数据/ ./ 该/ 方法/ 对/ 平滑/ 变化/ 的/ 数据/ 效果/ 较/ 好/ ,/ 对/ 通用/ 的/ 科学/ 数据压缩/ 效果/ 较差/ ./ Ratanaworabhan/ 等/ [/ 7/ ]/ 根据/ 前/ 若干个/ 数据/ ,/ 使用/ 差分/ 预测器/ 进行/ 浮点数/ 的/ 预测/ 压缩/ ,/ 能/ 达到/ 1.6/ 左右/ 的/ 几何平均/ 压缩比/ ./ Burtscher/ 等/ [/ 8/ -/ 9/ ]/ 设计/ 了/ 高通量/ 的/ 浮点/ 数据压缩/ 方法/ ,/ 能/ 达到/ 1.9/ 左右/ 的/ 几何平均/ 压缩比/ ./ 在/ 本文/ 的/ 横向/ 比较/ 中/ ,/ 该/ 方法/ 简称/ FPC/ ./ 相关/ 研究/ 均/ 没有/ 研究/ 预测/ 精度/ 和/ 压缩比/ 之间/ 的/ 关系/ ./ 本文/ 通过/ 系统分析/ ,/ 建立/ 预测/ 精度/ 和/ 压缩比/ 之间/ 的/ 解析/ 关系/ ./ 并/ 采用/ 多种/ 预测器/ 以及/ 高效/ 熵/ 编码方法/ ,/ 得到/ 远高于/ 相关/ 研究/ 的/ 压缩比/ ,/ 并/ 同时/ 具有/ 恒定/ 的/ 海量/ 压缩/ 吞吐量/ ./ 3/ 科学/ 数据/ 的/ 高性能/ 无损压缩/ 方法/ 3.1/ IEEE/ 浮点数/ 结构/ 现今/ 计算机系统/ 中/ 普遍/ 采用/ 的/ 都/ 是/ 1985/ 年/ 的/ IEEE/ 二进制/ 浮点数/ 算术/ 标准/ (/ IEEE754/ )/ [/ 10/ ]/ ./ 在/ 该/ 标准/ 中/ ,/ 定义/ 了/ 被/ 广泛/ 使用/ 的/ 32/ 位/ 二进制/ 浮点数/ (/ 单精度/ )/ 和/ 64/ 位/ 二进制/ 浮点数/ (/ 双/ 精度/ )/ 的/ 存储/ 格式/ ./ 在/ 2008/ 年/ 新/ 的/ IEEE/ 浮点数/ 算术/ 标准/ (/ IEEE754/ -/ 2008/ )/ [/ 11/ ]/ 中/ ,/ 新增/ 定义/ 了/ 128/ 位/ 二进制/ 浮点数/ 、/ 64/ 位/ 十进制/ 浮点数/ 以及/ 128/ 位/ 十进制/ 浮点数/ ,/ 5/ 种/ 基本/ 浮点数/ 格式/ 中/ 的/ 3/ 种如图/ 1/ 所示/ ./ 其中/ 两种/ 128/ 位/ 的/ 格式/ 因/ 篇幅/ 关系/ 并未/ 列出/ ./ 对于/ 二进制/ 浮点数/ 而言/ ,/ 数值/ 由下式/ 表示/ :/ 十进制/ 浮点数/ 的/ 格式/ 类似/ ,/ 只是/ 在/ 组合/ 域/ (/ combina/ -/ tionfield/ )/ 中/ ,/ 除了/ 用/ W/ 位来/ 编码/ 指数/ ,/ 其余/ 的/ 5/ 位共/ 32/ 种/ 组合/ 中/ 的/ 30/ 种/ 组合/ 用来/ 编码/ 归一化/ 后/ 的/ 十进制/ 数/ 的/ 整数/ 部分/ (/ 0/ ~/ 9/ 共/ 10/ 种/ 取值/ )/ 与/ 3/ 种/ 指数值/ ./ 剩余/ 的/ 2/ 种/ 组合/ 分别/ 表示/ 无穷大/ 与/ Page3NaN/ ./ t/ 位/ 的/ 尾数/ 部分/ 采用/ 密集/ 十进制/ (/ DenselyPackedDecimal/ ,/ DPD/ )/ 编码/ 3t/ // 10/ 位/ 十进制/ 数/ 的/ 小数/ 部分/ ./ 因/ 32/ 位/ 和/ 64/ 位/ 二进制/ 浮点数/ 最为/ 常用/ ,/ 并且/ IEEE754/ -/ 2008/ 标准/ 同时/ 定义/ 了/ 若干种/ 交换/ 格式/ 用于/ 在/ 不同/ 的/ 浮点数/ 实现/ 中/ 进行/ 数据交换/ ,/ 所以/ 本文/ 以/ 32/ 位/ 和/ 64/ 位/ 二进制/ 浮点数/ 为例/ ,/ 将/ 它们/ 统称/ 为/ 浮点数/ ./ 但/ 本文/ 的/ 方法/ 同样/ 适用/ 于/ 其它/ 的/ 浮点数/ 格式/ ,/ 甚至/ 非标准/ IEEE/ 格式/ ./ 需要/ 注意/ 的/ 是/ ,/ IEEE/ 标准/ 中/ 并/ 没有/ 定义/ 浮点数/ 在/ 机器/ 中/ 的/ 字节/ 存储/ 顺序/ ./ 有/ 的/ 采用/ 小端法/ (/ littleendian/ )/ 进行/ 存储/ ;/ 有/ 的/ 则/ 采用/ 大端法/ (/ bigendian/ )/ 进行/ 存储/ ./ 字节/ 存储/ 顺序/ 并/ 不/ 影响/ 压缩算法/ ,/ 但/ 为了/ 行文/ 方便/ ,/ 本文/ 均/ 以小端/ 法为例/ ./ 3.2/ 科学/ 数据压缩/ 原理/ 他/ 数据/ 有/ 诸多/ 本质区别/ :/ 作为/ 科学/ 数据/ 主体/ 的/ 浮点/ 数据/ 与/ 文本/ 数据/ 等/ 其/ (/ 1/ )/ 虽然/ 浮点数/ 本身/ 是/ 字节/ 对齐/ 的/ (/ byte/ -/ aligned/ )/ ,/ 但/ 各/ 组成部分/ (/ 如/ 符号/ 位/ 、/ 指数/ 部分/ 和/ 小数/ 部分/ )/ 均/ 不是/ 字节/ 对齐/ 的/ ./ 传统/ 的/ 基于/ 字节/ 的/ 压缩/ 方法/ 不顾/ 浮点/ 格式/ 的/ 物理/ 意义/ ,/ 而/ 强行/ 把/ 数据/ 分割/ 成以/ 字节/ 为/ 单位/ (/ 图/ 2/ )/ ./ 因/ 物理/ 意义/ 丢失/ ,/ 从而/ 使得/ 不管/ 是/ 字典/ 法/ 还是/ 统计法/ ,/ 效果/ 均/ 不/ 理想/ ./ 图/ 2/ 传统/ 基于/ 位/ 的/ 方法/ 不能/ 利用/ 浮点数/ 的/ 格式/ 特征/ (/ 2/ )/ 即使/ 是/ 以位/ 为/ 单位/ 的/ 预测/ 方法/ ,/ 比如/ 一些/ 基于/ 上下文/ 的/ 预测/ 压缩/ 方法/ [/ 12/ -/ 13/ ]/ ,/ 因/ 无法/ 考虑/ 到/ 浮点数/ 各个/ 位/ 的/ 意义/ 并/ 根据/ 其/ 重要性/ 进行/ 区别对待/ ,/ 从而/ 导致/ 需要/ 处理/ 的/ 上下文/ 过多/ ,/ 占用/ 大量/ 的/ 内存空间/ 和/ 压缩/ 时间/ ,/ 还/ 不能/ 得到/ 较优/ 的/ 压缩比/ ./ 为了/ 在/ 快速/ 压缩/ 的/ 同时/ 得到/ 高/ 压缩比/ ,/ 压缩/ 方法/ 需要/ 充分利用/ 浮点数/ 的/ 特征/ ./ 主要/ 的/ 特性/ 包括/ :/ (/ 1/ )/ 指数/ 部分/ 的/ 数值/ (/ E/ )/ 可以/ 基本/ 代表/ 该/ 浮点数/ 的/ 范围/ ./ 尾数/ 部分/ 对/ 数值/ 范围/ 的/ 影响/ 度/ 随着/ 与/ LSB/ 位/ 距离/ 的/ 减小/ 而/ 指数/ 降低/ ./ 所以/ ,/ 某/ 浮点数/ 的/ 大/ 范围/ 基本上/ 用/ 符号/ 位/ S/ 、/ 指数/ E/ 及/ 少数几个/ 尾数/ 位即/ 能/ 确定/ ./ 也/ 就/ 意味着/ ,/ 可以/ 用/ 最靠近/ MSB/ 的/ 若干位/ ,/ 来/ 近似/ 整个/ 浮点数/ ./ 定义/ 1/ ./ 区间/ ./ 对/ 浮点数/ F/ ,/ 定义/ (/ -/ 1/ )/ SEF/ -/ S/ 为/ 该/ 浮点数/ 所/ 位于/ 的/ 区间/ ./ 对于/ 两个/ 二进制/ 浮点数/ F1/ 、/ F2/ ,/ 如果/ 符号/ 位/ SF1/ =/ SF2/ ,/ 并且/ 指数/ 位/ EF1/ =/ EF2/ ,/ 则/ 称/ F1/ 与/ F2/ 属于/ 同一个/ 区间/ ./ 同时/ ,/ 把/ 它们/ 的/ 尾数/ 分别/ 简记/ 为/ TF1/ 与/ TF2/ ./ 若/ F1/ 、/ F2/ 位于/ 不同/ 区间/ ,/ 则/ 将/ F1/ 与/ F2/ 的/ 区间/ 之差/ 定义/ 为/ 两者之间/ 的/ 区间/ 距离/ ./ 定义/ 2/ ./ 前导/ 零数/ ./ 数值串/ N/ 中/ 第一个/ 非零/ 字符/ 前面/ 的/ 零/ 字符/ 的/ 个数/ ,/ 简记/ 为/ LZC/ (/ N/ )/ ./ 定理/ 1/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 同一个/ 区间/ ,/ 记/ 二进制/ 异或/ 运算/ 为/ / ,/ 则/ 平均/ 的/ LZC/ (/ F1/ / F2/ )/ 约等于/ W/ +/ 2/ ./ 证明/ ./ / F1/ ,/ 因/ F2/ 与其/ 位于/ 同一/ 区间/ ,/ 根据/ 定义/ 1/ ,/ 可知/ 它们/ 的/ 前/ W/ +/ 1/ 位均/ 相同/ ./ F2/ 的/ 尾数/ 部分/ 共/ t/ 位/ ,/ 共有/ 2t/ 种/ 可能性/ ./ 其中/ 有/ 1/ 种/ 可能性/ 是/ LZC/ (/ TF1/ / TF1/ )/ =/ t/ (/ F1/ =/ F2/ 时/ )/ ,/ 2t/ -/ x/ -/ 1/ 种/ 可能性/ 为/ LZC/ (/ TF1/ / TF1/ )/ =/ x/ (/ x/ =/ {/ 0/ ,/ 2/ ,/ …/ ,/ t/ -/ 1/ }/ )/ ./ 假设/ 这/ 2t/ 种/ 可能性/ 出现/ 的/ 概率/ 一样/ ,/ 则/ 平均/ 而言/ :/ LZC/ (/ TF1/ / TF2/ )/ =/ 从而/ LZC/ (/ F1/ / F2/ )/ =/ W/ +/ 1/ +/ LZC/ (/ TF1/ / TF2/ )/ ≈/ W/ +/ 2/ 引理/ 1/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 同一个/ 区间/ ,/ 且/ 尾数/ 部分/ 的/ 前/ n/ 位/ 相同/ ,/ 则/ 平均/ 的/ LZC/ (/ F1/ / F2/ )/ 等于/ W/ +/ 2/ +/ n/ -/ (/ 1/ // 2t/ -/ n/ )/ ./ 证明/ ./ 尾数/ 部分/ 共/ t/ 位/ ,/ 如前/ n/ 位/ 相同/ ,/ 则/ 变化/ 的/ 只/ 可能/ 是/ 后/ t/ -/ n/ 位/ ./ 将/ t/ -/ n/ 代入/ 定理/ (/ 1/ )/ 中/ t/ ,/ 再/ 加上/ 尾数/ 部分/ 相同/ 的/ 前/ n/ 位/ ,/ 从而/ 有/ LZC/ (/ TF1/ / TF2/ )/ =/ n/ +/ 2t/ -/ n/ -/ 1/ 故/ LZC/ (/ F1/ / F2/ )/ =/ W/ +/ 2/ +/ n/ -/ (/ 1/ // 2t/ -/ n/ )/ ./ 得证/ ./ 证毕/ ./ 定理/ 2/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 同一个/ 区间/ ,/ 且/ 尾数/ 部分/ 的/ 前/ n/ 位/ 相同/ ,/ 则/ 它们/ 之间/ 的/ 最大/ 相对误差/ 为/ 1/ // 2n/ -/ 1/ // 2t/ ./ 证明/ ./ 若/ 尾数/ 部分/ 前/ n/ 位/ 相同/ ,/ 相对误差/ 最大/ 的/ 情况/ 只能/ 出现/ 在/ 尾数/ 部分/ 前/ n/ 位均/ 为/ 0/ ,/ 且/ 其中/ 一个/ 浮点数/ (/ F1/ // F2/ )/ 的/ 后/ t/ -/ n/ 位为/ 0/ ,/ 而/ 另/ 一个/ 浮点数/ (/ F2/ // F1/ )/ 的/ 后/ t/ -/ n/ 位为/ 1/ 的/ 时候/ ./ 这时/ 两者/ 之差/ 的/ 绝对值/ 为/ 两者/ 绝对值/ 的/ 最小值/ 为/ Page4/ 式/ (/ 5/ )/ 除以/ 式/ (/ 6/ )/ 之后/ 可/ 得/ 两者之间/ 的/ 最大/ 相对误差/ 为/ 1/ // 2n/ -/ 1/ // 2t/ ./ 得证/ ./ 定理/ 3/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 不/ 位于/ 同一个/ 区间/ ,/ 但/ 它们/ 的/ 前/ n/ 位/ 相同/ ,/ 则/ 平均/ 的/ LZC/ (/ F1/ / F2/ )/ 约等于/ n/ +/ 1/ ./ 证明/ ./ 类似/ 引理/ 1/ ,/ 将/ 符号/ 位/ 、/ 指数/ 部分/ 和/ 尾数/ 部分/ 共/ W/ +/ t/ +/ 1/ 位/ 作为/ 一个/ 整体/ 考虑/ ,/ 将/ W/ +/ t/ +/ 1/ 类比/ 于/ 引理/ 1/ 中/ 的/ t/ ,/ 将/ n/ 类比/ 于/ 引理/ 1/ 中/ 的/ n/ ,/ 通过/ 类似/ 于/ 定理/ 1/ 和/ 引理/ 1/ 的/ 证明/ 可知/ :/ LZC/ (/ F1/ / F2/ )/ =/ n/ +/ 1/ -/ (/ 1/ // 2t/ +/ W/ +/ 1/ -/ n/ )/ ≈/ n/ +/ 1/ (/ 7/ )/ 定理/ 4/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 不/ 位于/ 同一个/ 区间/ ,/ 但/ 它们/ 的/ 前/ n/ 位/ 相同/ ,/ 则/ 它们/ 之间/ 的/ 最大/ 相对误差/ 为/ 22W/ -/ n/ +/ 1/ -/ 1/ ./ 证明/ ./ 因/ F1/ 、/ F2/ 之间/ 的/ 最大/ 相对误差/ 为/ min/ (/ |/ F1/ |/ ,/ |/ F2/ |/ )/ =/ 最大/ 相对误差/ 当/ 两个/ 浮点数/ 其中/ 一个/ 的/ 后/ W/ -/ n/ +/ 1/ 位/ 指数/ 位及/ 尾数/ 位全/ 为/ 0/ ,/ 且/ 另/ 一个/ 的/ 后/ W/ -/ n/ +/ 1/ 位/ 指数/ 位及/ 尾数/ 位全/ 为/ 1/ 时取/ 到/ ./ 此时/ E1/ 与/ E2/ 两者/ 分别/ 为/ 2W/ -/ 2W/ -/ n/ +/ 1/ 与/ 2W/ -/ 1/ ,/ 而/ T1/ 与/ T2/ 分别/ 为/ 0/ 与/ 2t/ -/ 1/ ./ 代入/ 式/ (/ 8/ )/ ,/ 有/ 最大/ 相对误差/ 为/ min/ (/ |/ F1/ |/ ,/ |/ F2/ |/ )/ ≈/ 2/ ×/ 22W/ -/ 1/ -/ 22W/ -/ 2W/ -/ n/ +/ 1/ 但/ 我们/ 注意/ 到/ ,/ 定理/ 2/ 及/ 定理/ 4/ 的/ 逆命题/ 均/ 不/ 成立/ ./ 即/ ,/ 根据/ 最大/ 相对误差/ ,/ 并/ 不能/ 确保/ 两个/ 浮点数/ 的/ 二进制/ 表示/ 的/ 前/ 若干位/ 相同/ ./ 为了/ 建立/ 平均/ 相对误差/ 到/ 平均/ 的/ LZC/ (/ F1/ / F2/ )/ 的/ 映射/ 关系/ ,/ 有/ 如下/ 定理/ ./ 定理/ 5/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 的/ 符号/ 位/ 相同/ ,/ 且/ 两者/ 中/ 绝对值/ 较大/ 者/ 与/ 绝对值/ 较小者/ 的/ 比值/ 为/ r/ ,/ 则/ 它们/ 的/ 区间/ 距离/ 为/ log2r/ 或/ log2r/ ./ 证明/ ./ (/ 1/ )/ 当/ log2r/ 为/ 整数/ 时/ ,/ 这时/ 因为/ r/ 为/ 2/ 的/ 整数/ 次/ 幂/ ,/ 故/ F1/ 与/ F2/ 的/ 尾数/ 部分/ 相同/ ./ 根据/ 式/ (/ 1/ )/ ,/ 知/ 此时/ 的/ 比值/ r/ 为/ 2/ |/ E1/ -/ E2/ |/ ./ 再/ 根据/ 定义/ 1/ ,/ 它们/ 的/ 区间/ 距离/ 为/ |/ EF1/ -/ EF2/ |/ ,/ 也/ 即/ log2r/ ./ 符合/ 定理/ 5/ ./ (/ 2/ )/ 当/ log2r/ 为/ 非/ 整数/ 时/ ,/ 此时/ 记/ F1/ 与/ F2/ 中/ 绝对值/ 最小/ 者/ 为/ Fmin/ ,/ 绝对值/ 较大/ 者/ 为/ Fmax/ ./ 假设/ Fmin/ 位于/ 某一/ 区间/ i/ ,/ 则/ 当/ |/ Fmin/ |/ 取/ 最小值/ 时/ ,/ 因/ |/ Fmax/ |/ >/ |/ Fmin/ |/ ×/ 2log2r/ ,/ 且/ |/ Fmax/ |/ </ |/ Fmin/ |/ ×/ 2log2r/ ,/ 故/ 此时/ Fmax/ 必/ 位于/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ ./ 当/ |/ Fmin/ |/ 取/ 最大值/ 时/ ,/ 同样/ 因/ |/ Fmax/ |/ >/ |/ Fmin/ |/ ×/ 2log2r/ ,/ 且/ |/ Fmax/ |/ </ |/ Fmin/ |/ ×/ 2log2r/ ,/ 故/ 此时/ Fmax/ 必/ 位于/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ ./ 且/ 因为/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ 与/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ 为/ 相邻/ 区间/ ,/ 故当/ Fmin/ 值/ 在/ 区间/ i/ 内/ 变化/ 时/ ,/ Fmax/ 必定/ 也/ 在/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ 与/ 区间/ i/ +/ (/ -/ 1/ )/ Slog2r/ 变化/ ./ 也/ 即/ 两者/ 的/ 区间/ 距离/ 为/ log2r/ 或/ log2r/ ./ 得证/ ./ 引理/ 2/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 的/ 符号/ 位/ 相同/ ,/ 且/ 两者/ 中/ 绝对值/ 较大/ 者/ 与/ 绝对值/ 较小者/ 的/ 比值/ 为/ r/ ,/ 记/ F1/ 与/ F2/ 中/ 绝对值/ 较小者/ 为/ Fmin/ ,/ Fmin/ 所在/ 区间/ 的/ 绝对值/ 最小值/ 的/ 浮点数/ 为/ B/ ./ 则/ 当/ Fmin/ // B/ ∈/ [/ 1/ ,/ 2log2r/ // r/ )/ 时/ ,/ F1/ 与/ F2/ 的/ 区间/ 距离/ 为/ log2r/ ,/ 当/ Fmin/ // B/ ∈/ [/ 2log2r/ // r/ ,/ 2/ )/ 时/ ,/ 两者/ 的/ 区间/ 距离/ 为/ log2r/ ./ 证明/ ./ 当/ Fmin/ // B/ ∈/ [/ 1/ ,/ 2log2r/ // r/ )/ 时/ ,/ 这时/ Fmax/ =/ Fmin/ ×/ r/ ∈/ [/ rB/ ,/ 2log2rB/ )/ ,/ 与/ B/ 所在/ 区间/ (/ 也/ 即/ Fmin/ 所在/ 区间/ )/ 区间/ 距离/ 为/ log2r/ ./ 当/ Fmin/ // B/ ∈/ [/ 2log2r/ // r/ ,/ 2/ )/ 时/ ,/ 这时/ Fmax/ =/ Fmin/ ×/ r/ ∈/ [/ 2log2rB/ ,/ 2rB/ )/ ,/ 与/ B/ 所在/ 区间/ (/ 也/ 即/ Fmin/ 所在/ 区间/ )/ 区间/ 距离/ 为/ log2r/ ./ 得证/ ./ 引理/ 3/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 的/ 符号/ 位/ 相同/ ,/ 且/ 两者/ 中/ 绝对值/ 较大/ 者/ 与/ 绝对值/ 较小者/ 的/ 比值/ 为/ r/ ,/ 则/ 两者之间/ 的/ 平均/ 区间/ 距离/ 为/ log2r/ +/ 1/ -/ 2log2r/ // r/ ./ 证明/ ./ 根据/ 引理/ 2/ ,/ F1/ 与/ F2/ 之间/ 的/ 平均/ 区间/ 距离/ 应为/ (/ 2log2r/ // r/ -/ 1/ )/ ×/ log2r/ +/ (/ 2/ -/ 2log2r/ // r/ )/ ×/ log2r/ =/ (/ 2log2r/ // r/ -/ 1/ )/ ×/ (/ log2r/ -/ 1/ )/ +/ =/ log2r/ +/ 1/ -/ 2log2r/ // r/ 注意/ ,/ 本/ 引理/ 及/ 上述/ 证明/ 对/ r/ 为/ 2/ 的/ 整数/ 次/ 幂/ 亦/ 成立/ ./ 得证/ ./ 定义/ 3/ ./ 区间/ 内/ 距离/ ./ 若/ 浮点数/ F1/ 与/ F2/ 位于/ 同一/ 区间/ ,/ 定义/ |/ TF1/ -/ TF2/ |/ 为/ 两/ 浮点数/ 之间/ 的/ 区间/ 内/ 距离/ ./ 可见/ ,/ 区间/ 内/ 距离/ 的/ 取值/ 范围/ 为/ [/ 0/ ,/ 2t/ -/ 1/ ]/ ./ 定理/ 6/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 同一/ 区间/ ,/ 且/ 区间/ 内/ 距离/ 固定/ 为/ d/ ,/ 记/ max/ (/ X/ ,/ 0/ )/ 为/ X/ #/ ,/ 则/ 它们/ 之间/ 的/ 平均/ LZC/ (/ TF1/ / TF1/ )/ 为/ ∑/ t/ (/ 2t/ -/ d/ )/ ./ 证明/ ./ 当/ 区间/ 内/ 距离/ 为/ d/ 时/ ,/ 记/ F1/ 与/ F2/ 中/ 较大/ 者/ 为/ Fmax/ ,/ 较小者/ 为/ Fmin/ ,/ 则/ 二元/ 对/ (/ Fmin/ ,/ Fmax/ )/ 共/ Page5i/ =/ 1i/ =/ 1/ 有/ 2t/ -/ d/ 种/ 不同/ 组合/ ./ 假设/ 这/ 2t/ -/ d/ 种/ 组合/ 均匀分布/ ,/ 平均/ 每种/ 出现/ 一次/ ,/ 这时/ 容易/ 验证/ 当/ t/ =/ 1/ 时/ ,/ 定理/ 6/ 成立/ ,/ 即/ 平均/ 的/ LZC/ (/ TF1/ / TF1/ )/ 为/ (/ 2/ -/ 2d/ )/ #/ // (/ 2/ -/ d/ )/ ./ 设/ 定理/ 6/ 对/ t/ =/ j/ 时/ 成立/ ,/ 则/ 这时/ 2t/ -/ d/ 种/ 组合/ 每种/ 出现/ 一次/ 时/ 总/ 的/ LZC/ (/ TF1/ / TF1/ )/ 为/ ∑/ j/ (/ 2j/ -/ 2id/ )/ #./ 那么/ 当/ t/ =/ j/ +/ 1/ 时/ ,/ 因为/ 这时/ 尾数/ Ti/ =/ 1/ 的/ 2j/ +/ 1/ 种/ 组合/ 可以/ 看成/ 是/ 在/ t/ =/ j/ 的/ 2j/ 种/ 组合/ 的/ 基础/ 上/ ,/ 前面/ 分别/ 补上/ 了/ 0/ 和/ 1/ ,/ 且/ 在/ 最/ 前面/ 补多/ 了/ 一位/ ,/ 除了/ Fmin/ 尾数/ 首位/ 为/ 0/ 且/ Fmax/ 尾数/ 首位/ 为/ 1/ 的/ d/ 种/ 组合/ 外/ ,/ 剩下/ 的/ (/ (/ 2j/ +/ 1/ -/ d/ )/ -/ d/ )/ #/ =/ (/ 2j/ +/ 1/ -/ 2d/ )/ #/ 种/ 组合/ 的/ LZC/ (/ TF1/ / TF1/ )/ 均/ 增加/ 1/ ./ 从而/ 有/ 如下/ 递推/ 关系/ :/ ∑/ (/ Fmin/ ,/ Fmax/ )/ LZC/ (/ TF1/ / TF2/ )/ |/ t/ =/ j/ +/ 1/ =/ ∑/ (/ Fmin/ ,/ Fmax/ )/ LZC/ (/ TF1/ / TF2/ )/ |/ t/ =/ j/ ×/ 2/ +/ (/ 2j/ +/ 1/ -/ 2d/ )/ #/ [/ =/ ∑/ j/ [/ =/ ∑/ j/ =/ ∑/ j/ 即当/ t/ =/ j/ +/ 1/ 时/ ,/ 2j/ +/ 1/ -/ d/ 种/ 组合/ 每种/ 出现/ 一次/ 时/ 总/ 的/ LZC/ (/ TF1/ / TF1/ )/ 为/ ∑/ j/ +/ 1LZC/ (/ TF1/ / TF1/ )/ 为/ ∑/ j/ +/ 1/ 定理/ 6/ 对/ t/ =/ j/ +/ 1/ 亦/ 成立/ ./ 由/ 归纳法/ 知/ ,/ 当/ t/ 为/ 浮点数/ 的/ 尾数/ 部分/ 位数/ 时/ ,/ 定理/ 6/ 亦/ 成立/ ./ 得证/ ./ 证毕/ ./ 3.3/ 高性能/ 无损压缩/ 方法/ 算法/ 能/ 得到/ 的/ 压缩比/ 与/ 预测/ 误差/ 直接/ 相关/ ,/ 其/ 关键在于/ 预测/ 误差/ 前导/ 零/ LZC/ (/ F1/ / F2/ )/ 的/ 平均/ 个数/ ./ 因此/ ,/ 为了/ 得到/ 高性能/ 无损压缩/ 方法/ ,/ 本文/ 继续/ 针对/ F1/ 、/ F2/ 位于/ 同一/ 区间/ 及/ 不同/ 区间/ 的/ 情况/ 下/ ,/ LZC/ (/ F1/ / F2/ )/ 的/ 平均值/ 进行/ 理论/ 分析/ ./ 间/ ,/ 且/ 区间/ 内/ 距离/ 固定/ 为/ d/ ,/ 则/ 引理/ 4/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 同一/ 区/ (/ 1/ )/ 它们/ 之间/ 的/ 平均/ LZC/ (/ TF1/ / TF1/ )/ 当/ d/ =/ 0/ 时为/ t/ ,/ 当/ d/ ≠/ 0/ 且/ d/ / 2t/ -/ 1/ 时/ 可/ 近似/ 为/ [/ (/ t/ -/ 2/ -/ log2d/ )/ 2t/ +/ 2d/ ]/ // (/ 2t/ -/ d/ )/ ,/ 当/ d/ >/ 2t/ -/ 1/ 时为/ 0/ ;/ (/ 2/ )/ 它们/ 之间/ 的/ 平均/ LZC/ (/ F1/ / F2/ )/ 当/ d/ =/ 0/ 时为/ W/ +/ 1/ +/ t/ ,/ 当/ d/ ≠/ 0/ 且/ d/ / 2t/ -/ 1/ 时/ 可/ 近似/ 为/ W/ +/ 1/ +/ [/ (/ t/ -/ 2/ -/ log2d/ )/ 2t/ +/ 2d/ ]/ // (/ 2t/ -/ d/ )/ ,/ 当/ d/ >/ 2t/ -/ 1/ 时为/ W/ +/ 1/ ./ 最坏/ 情况/ 下/ 的/ 近似/ 相对误差/ 约/ 为/ 1/ %/ ./ i/ =/ 0/ 证明/ ./ 命题/ (/ 1/ )/ ./ 容易/ 验证/ 当/ d/ =/ 0/ 时/ 平均/ LZC/ (/ TF1/ / TF1/ )/ 为/ t/ ./ 当/ d/ 为/ 2/ 的/ 整数/ 次/ 幂/ 时/ ,/ 定理/ 6/ 的/ 结果/ 等于/ [/ (/ t/ -/ 2/ -/ log2d/ )/ 2t/ +/ 2d/ ]/ // (/ 2t/ -/ d/ )/ ,/ 当/ d/ >/ 2t/ -/ 1/ 时为/ 0/ ./ 当/ d/ 不是/ 2/ 的/ 整数/ 次/ 幂/ 时/ ,/ 设/ d/ ∈/ [/ 2j/ +/ 1/ ,/ 2j/ +/ 1/ ]/ ,/ 此时/ 根据/ 定理/ 6/ 算出/ 的/ 准确/ 结果/ 为/ [/ (/ t/ -/ j/ -/ 1/ )/ 2t/ -/ 2t/ -/ jd/ +/ 2d/ ]/ // (/ 2t/ -/ d/ )/ ,/ 与/ 引理/ 4/ 的/ 近似值/ 之间/ 的/ 误差/ 为/ [/ log2d/ -/ (/ j/ -/ 1/ +/ 2/ -/ jd/ )/ ]/ 2t/ // (/ 2t/ -/ d/ )/ ./ 设/ j1/ =/ log2d/ -/ j/ ,/ 其中/ j1/ ∈/ (/ 0/ ,/ 1/ ]/ ,/ 故/ 近似/ 误差/ 又/ 可/ 表示/ 为/ (/ 1/ +/ j1/ -/ 2j1/ )/ 2t/ // (/ 2t/ -/ d/ )/ ./ 易知/ ,/ 当/ j/ =/ t/ -/ 2/ ,/ j1/ ≈/ 0.58/ 的/ 时候/ ,/ 这时/ 的/ 近似/ 误差/ 取得/ 全局/ 最大值/ (/ 最坏/ 情况/ )/ 约/ 为/ 0.136/ ./ 命题/ (/ 1/ )/ 得证/ ./ 命题/ (/ 2/ )/ ./ 因为/ 最后/ 压缩/ 的/ 时候/ ,/ 是/ 对/ 整个/ 浮点数/ 进行/ 编码/ ,/ 故/ 需要/ 考虑/ 整个/ 预测/ 误差/ 的/ 前导/ 零数/ ,/ 即/ LZC/ (/ F1/ / F2/ )/ ./ 根据/ 定义/ 1/ 和/ 定义/ 2/ ,/ 当/ F1/ 、/ F2/ 位于/ 同一/ 区间/ 时/ ,/ LZC/ (/ F1/ / F2/ )/ =/ W/ +/ 1/ +/ LZC/ (/ TF1/ / TF1/ )/ ,/ 故/ 命题/ (/ 2/ )/ 的/ 前/ 3/ 部分/ 得证/ ./ 根据/ 定理/ 6/ ,/ 对于/ 64/ 位/ 浮点数/ 而言/ ,/ 这时/ 的/ LZC/ (/ F1/ / F2/ )/ 的/ 准确/ 值为/ 14/ ./ 故/ 最坏/ 情况/ 下/ 的/ 近似/ 相对误差/ 约/ 为/ 0.136/ // 14/ ≈/ 1/ %/ ./ 得证/ ./ 引理/ 5/ ./ 如果/ 两个/ 浮点数/ F1/ 、/ F2/ 位于/ 不同/ 区间/ ,/ 且/ 它们/ 的/ 区间/ 距离/ 为/ d/ (/ d/ >/ 0/ ,/ d/ / 2W/ )/ ,/ 则/ 它们/ 之间/ 的/ 平均/ LZC/ (/ F1/ / F2/ )/ 可/ 近似/ 为/ [/ (/ W/ -/ 1/ -/ log2d/ )/ 2W/ +/ 1/ +/ 2d/ ]/ // (/ 2W/ +/ 1/ -/ d/ )/ ,/ 近似/ 的/ 平均/ 相对误差/ 约/ 为/ 1/ %/ ~/ 2/ %/ ./ 证明/ ./ 将/ 符号/ 部分/ 与/ 指数/ 部分/ 共/ W/ +/ 1/ 位/ ,/ 类比/ 于/ 引理/ 4/ 中/ 的/ 尾数/ 部分/ t/ 位/ ,/ 除/ 物理/ 意义/ 不同/ 外/ ,/ 所有/ 的/ 推算/ 不变/ ./ 根据/ 引理/ 4/ 的/ 命题/ 1/ ,/ 即得/ 引理/ 5/ 的/ 近似值/ ./ 同样/ 根据/ 引理/ 4/ 可知/ 若/ d/ ∈/ [/ 2j/ +/ 1/ ,/ 2j/ +/ 1/ ]/ ,/ 准确/ 结果/ 为/ [/ (/ W/ -/ j/ )/ 2W/ +/ 1/ -/ 2W/ +/ 1/ -/ jd/ +/ 2d/ ]/ // (/ 2W/ +/ 1/ -/ d/ )/ ,/ 近似/ 的/ 相对误差/ 为/ [/ (/ j/ -/ 1/ +/ 2/ -/ jd/ )/ -/ log2d/ ]/ 2W/ +/ 1/ // [/ (/ W/ -/ j/ )/ 2W/ +/ 1/ -/ 2W/ +/ 1/ -/ jd/ +/ 2d/ ]/ ./ 因/ 这时/ 的/ 区间/ 距离/ 为/ 指数/ 部分/ 之差/ ,/ 即使/ 实际/ 值/ 与/ 预测值/ 之间/ 差/ 1030/ 倍/ ,/ 它们/ 之间/ 的/ 区间/ 距离/ d/ 也/ 只是/ 为/ 100/ (/ 2100/ ≈/ 1030/ )/ ./ 也就是说/ ,/ d/ 的/ 取值/ 通常/ 较/ 小/ ./ 为了/ 对/ 近似/ 所/ 引起/ 的/ 误差/ 有/ 直观/ 认识/ ,/ 分别/ 取/ d/ =/ {/ 1/ ,/ 2/ ,/ …/ ,/ 100/ }/ ,/ 图/ 3/ 表述/ 了/ 准确/ 值及/ 近似值/ 随/ d/ 变化/ 的/ 关系/ ./ 当/ d/ ∈/ [/ 1/ ,/ 100/ ]/ 时/ ,/ 计算/ 可知/ 平均/ 相对误差/ 约/ 为/ 1.4/ %/ ,/ 得证/ ./ 根据/ 引理/ 2/ 可知/ ,/ 若/ 两个/ 浮点数/ F1/ 、/ F2/ 的/ 符号/ 位/ 相同/ ,/ 且/ 两者/ 中/ 绝对值/ 较大/ 者/ 与/ 绝对值/ 较小者/ 的/ 比值/ 为/ r/ (/ r/ / 1/ )/ ,/ 则/ 当/ r/ </ 2/ 时/ ,/ F1/ 与/ F2/ 有/ 可能/ 位于/ 同一/ 区间/ (/ 概率/ 为/ 2/ // r/ -/ 1/ )/ 或者/ 相邻/ 区间/ (/ 概率/ 为/ Page6/ 图/ 3LZC/ (/ F1/ / F2/ )/ 的/ 近似值/ 和/ 准确/ 值/ 之间/ 的/ 误差/ 2/ -/ 2/ // r/ )/ ;/ 当/ r/ / 2/ 时/ ,/ F1/ 与/ F2/ 则/ 不/ 可能/ 位于/ 同一/ 区间/ ./ r/ </ 2/ 的/ 情况/ ./ 此时/ ,/ 若/ F1/ 与/ F2/ 位于/ 同一/ 区间/ ,/ 设/ 所在/ 区间/ 的/ 绝对值/ 最小值/ 的/ 浮点数/ 为/ B/ ,/ 此时/ F1/ 的/ 范围/ 为/ [/ B/ ,/ 2B/ // r/ )/ ,/ 区间/ 内/ 距离/ d/ ∈/ [/ (/ r/ -/ 1/ )/ ×/ 2t/ ,/ (/ 2/ -/ 2/ // r/ )/ ×/ 2t/ )/ ./ 当/ r/ ∈/ (/ 1/ ,/ 4/ // 3/ ]/ 时/ ,/ (/ r/ -/ 1/ )/ ×/ 2t/ / 2t/ -/ 1/ 且/ (/ 2/ -/ 2/ // r/ )/ ×/ 2t/ / 2t/ -/ 1/ ;/ 当/ r/ ∈/ (/ 4/ // 3/ ,/ 3/ // 2/ ]/ 时/ ,/ (/ r/ -/ 1/ )/ ×/ 2t/ / 2t/ -/ 1/ 且/ (/ 2/ -/ 2/ // r/ )/ ×/ 2t/ >/ 2t/ -/ 1/ ;/ 当/ r/ ∈/ (/ 3/ // 2/ ,/ 2/ )/ 时/ ,/ (/ r/ -/ 1/ )/ ×/ 2t/ >/ 2t/ -/ 1/ 且/ (/ 2/ -/ 2/ // r/ )/ ×/ 2t/ >/ 2t/ -/ 1/ ./ 设/ 引理/ 4/ 中/ 的/ W/ +/ 1/ +/ [/ (/ t/ -/ 2/ -/ log2d/ )/ 2t/ +/ 2d/ ]/ // (/ 2t/ -/ d/ )/ 为/ f/ (/ d/ )/ ,/ 因为/ ∫/ f/ (/ x/ )/ dx/ =/ (/ W/ -/ 1/ )/ x/ -/ t2tln/ (/ 2t/ -/ x/ )/ +/ 其中/ Li2/ (/ / )/ 为/ 二重/ 对数/ (/ dilogarithm/ )/ 函数/ ./ 所以/ ,/ 当/ F1/ 与/ F2/ 位于/ 同一/ 区间/ ,/ LZC/ (/ F1/ / F2/ )/ 同为/ 3/ -/ r/ -/ 2/ (/ )/ r/ ×/ 2t/ ×/ ∫/ (/ 2/ -/ 2/ // r/ )/ ×/ 2t2/ -/ 2/ (/ )/ r2t/ (/ W/ +/ 1/ )/ +/ ∫/ 2t/ -/ 1/ 烄/ (/ r/ -/ 1/ )/ ×/ 2t/ 烅/ 3W/ +/ 1/ ,/ 烆/ 将/ 式/ (/ 12/ )/ 代入/ 式/ (/ 13/ )/ ,/ 并/ 进行/ 化简/ 后/ 可/ 得当/ r/ ∈/ (/ 1/ ,/ 4/ // 3/ ]/ 时/ ,/ 式/ (/ 13/ )/ 成为/ W/ -/ 1/ +/ 当/ r/ ∈/ (/ 4/ // 3/ ,/ 3/ // 2/ ]/ 时/ ,/ 式/ (/ 13/ )/ 成为/ W/ -/ 1/ +/ 再/ 根据/ 引理/ 5/ ,/ LZC/ (/ F1/ / F2/ )/ 异为/ [/ (/ W/ -/ 1/ )/ 2W/ +/ 1/ +/ 2/ ]/ // (/ 2W/ +/ 1/ -/ 1/ )/ ,/ 再/ 根据/ F1/ 与/ F2/ 有/ 2/ // r/ -/ 1/ 的/ 概率/ 同/ 区间/ ,/ 有/ 2/ -/ 2/ // r/ 的/ 概率/ 位于/ 相邻/ 区间/ ,/ 故/ LZC/ (/ F1/ / F2/ )/ =/ LZC/ (/ F1/ / F2/ )/ 同/ ×/ (/ 2/ // r/ -/ 1/ )/ +/ r/ / 2/ 的/ 情况/ ./ 此时/ ,/ 根据/ 引理/ 2/ 可知/ 有/ 2log2r/ // r/ -/ 1/ 的/ 概率/ F1/ 与/ F2/ 的/ 区间/ 距离/ 为/ log2r/ ,/ 2/ -/ 2log2r/ // r/ 的/ 概率/ 两者/ 的/ 区间/ 距离/ 为/ log2r/ ./ 此时/ 的/ 平均/ 区间/ 距离/ 可/ 近似/ 为/ log2r/ ,/ 再/ 根据/ 引理/ 5/ ,/ 可知/ 此时/ 的/ 平均/ LZC/ (/ F1/ / F2/ )/ 为设/ 原始/ 浮点数/ 及/ 预测器/ 的/ 预测值/ 分别/ 为/ F/ 与/ 珟/ F/ ,/ 当/ 两者/ 符号/ 位/ 相同/ 时/ ,/ 此时/ 的/ 最大/ 预测/ 误差/ err/ 为/ r/ -/ 1/ (/ err/ / 珟/ F/ // F/ -/ 1/ )/ ./ 而/ 因为/ F/ 与/ 珟/ F/ 共有/ LZC/ (/ F/ / 珟/ F/ )/ 个/ 前导/ 零/ ,/ 假设/ 极限/ 情况/ 时/ 冗余/ 前导/ 零/ 的/ 信息量/ 趋近/ 零/ ,/ 则/ 此时/ 的/ 压缩比/ Rc/ 为/ (/ W/ +/ 1/ +/ t/ )/ // [/ W/ +/ 1/ +/ t/ -/ LZC/ (/ F/ / 珟/ F/ )/ ]/ ./ 根据/ 式/ (/ 13/ )/ ~/ (/ 17/ )/ ,/ 图/ 4/ 描述/ 了/ 最大/ 预测/ 误差/ err/ 与/ 压缩比/ Rc/ 之间/ 的/ 关系/ ./ 此/ 关系/ 仅/ 适用/ 于/ F/ 与/ 珟/ F/ 符号/ 位/ 相同/ 的/ 情况/ ,/ 当/ 符号/ 位/ 不/ 同时/ ,/ 因此/ 时/ 的/ LZC/ (/ F/ / 珟/ F/ )/ 为/ 0/ ,/ 故/ 采用/ 其他/ 方法/ 进行/ 压缩/ (/ 见/ 第/ 3.3/ ./ 2/ 与/ 3.3/ ./ 3/ 节/ )/ ./ 从图/ 4/ 中/ 可见/ ,/ 预测/ 的/ 准确性/ 直接/ 影响/ 到/ 压缩比/ ./ 当/ 相对/ 预测/ 误差/ 小于/ 1/ 时/ ,/ 压缩比/ 以较/ 快/ 的/ 下降/ 速度/ 从/ 25/ 下降/ 到/ 1.2/ 左右/ ./ 当/ 相对/ 预测/ 误差/ 从/ 1/ 增加/ 到/ 10300/ 时/ ,/ 压缩比/ 也/ 缓慢/ 地/ 由/ 1.2/ 降低/ 到/ 1.01/ ./ 分析表明/ ,/ 为了/ 得到/ 较/ 高/ 的/ 压缩比/ ,/ 就/ 必须/ 使用/ 较准/ Page7/ 确/ 的/ 预测/ 算法/ ,/ 或者/ 混合/ 使用/ 多种/ 预测/ 算法/ ./ 进行/ 高性能/ 科学/ 数据压缩/ 的/ 关键在于/ 根据/ 浮点数/ 的/ 存储/ 格式/ ,/ 设计/ 先进/ 的/ 预测/ 算法/ ,/ 并/ 对/ 原始/ 值/ F/ 与/ 预测值/ 珟/ F/ 之间/ 的/ 差值/ 进行/ 高性能/ 编码/ ./ 本文/ 所/ 提出/ 的/ 科学/ 数据/ 高性能/ 无损压缩/ 系统/ 的/ 结构/ 如图/ 5/ 所示/ ./ 系统/ 结果/ 主要/ 分为/ 预测/ 和/ 编码/ 两/ 部分/ ,/ 将/ 在/ 以下/ 章节/ 中/ 对/ 其/ 进行/ 详细分析/ ./ 3.3/ ./ 1/ 数据/ 预测/ 根据/ 图/ 4/ ,/ 数据/ 预测/ 的/ 准确性/ 直接/ 关系/ 到/ 最终/ 的/ 压缩比/ ./ 因/ 科学/ 数据/ 的/ 不同/ ,/ 使用/ 单一/ 的/ 预测/ 算法/ 往往/ 不能/ 永远/ 得到/ 很/ 好/ 的/ 预测/ 精度/ ,/ 而/ 预测/ 精度/ 的/ 下降/ 将会/ 导致/ 压缩比/ 的/ 急剧下降/ ./ 为此/ ,/ 有/ 必要/ 使用/ 混合式/ 预测/ 算法/ ,/ 同时/ 采用/ 多种/ 预测器/ ,/ 然后/ 再/ 在/ 多个/ 预测/ 结果/ 中/ 选择/ 最/ 接近/ 真实/ 值/ 的/ 预测/ 结果/ ./ 但/ 采用/ 多种/ 预测/ 算法/ 也/ 会/ 带来/ 一定/ 的/ 负面影响/ ,/ 首先/ ,/ 会/ 增加/ 编码器/ 和/ 解码器/ 的/ 复杂性/ ./ 虽然/ 在/ 多处理器/ 系统/ 上/ 或者/ 使用/ 硬件/ 实现/ 时/ ,/ 多个/ 预测器/ 可以/ 并发/ 工作/ ,/ 但/ 对/ 多个/ 预测器/ 进行/ 同步/ 仍会/ 影响/ 到/ 系统/ 的/ 效率/ ./ 而/ 在/ 串行/ 系统/ 上/ ,/ 预测/ 部分/ 的/ 执行/ 时间/ 会/ 随着/ 预测器/ 数目/ 的/ 增多/ 而/ 线性/ 增加/ ./ 其次/ ,/ 预测/ 之后/ 需要/ 记录/ 预测器/ 的/ 编号/ 以/ 用于/ 解码/ ,/ 从而/ 会/ 增加/ 需要/ 编码/ 的/ 数据量/ ./ 为了/ 在/ 预测/ 精度/ 和/ 速度/ 之间/ 取得/ 一个/ 平衡/ ,/ 本文/ 使用/ 2/ 个/ 预测器/ ,/ 一个/ 用于/ 预测/ 比较/ 平缓/ 的/ 数据/ ,/ 另/ 一个/ 差分/ 预测器/ 用于/ 预测/ 变化/ 的/ 数据/ ./ 如图/ 5/ 所示/ ,/ 普通/ 预测器/ 以/ Fi/ 的/ 值/ 作为/ 索引/ ,/ 查找/ 预测/ 表/ ,/ 得出/ Fi/ +/ 1/ 的/ 预测值/ 珟/ Fi/ +/ 1/ ,/ 珟/ Fi/ +/ 1/ 与/ Fi/ +/ 1/ 的/ 异或/ 值/ 将/ 会/ 送给/ 选择器/ 和/ 前导/ 编码器/ 进行/ 编码/ ./ 对于/ 差分/ 预测器/ 而言/ ,/ 区别/ 在于/ 预测器/ 是/ 根据/ Fi/ -/ Fi/ -/ 1/ 来/ 得到/ Fi/ +/ 1/ -/ Fi/ 的/ 预测值/ ./ 所以/ 差分/ 预测器/ 的/ 输入/ 是/ Fi/ -/ Fi/ -/ 1/ ,/ 而/ 其/ 输出/ 与/ Fi/ 求和/ 之后/ 作为/ Fi/ +/ 1/ 的/ 预测值/ 珟/ Fi/ +/ 1/ ./ 差分/ 预测器/ 的/ 工作/ 机理/ 决定/ 了/ 差分/ 预测器/ 能/ 较/ 好/ 地/ 预测/ 线性/ 增长/ 的/ 数据/ (/ 一阶差/ )/ ./ 因/ 普通/ 浮点数/ 的/ 加减法/ 有时/ 是/ 不/ 可逆/ 的/ ,/ 因此/ 图/ 5/ 中/ 的/ 求和/ 器/ 使用/ 的/ 是/ 与/ 浮点数/ 二进制/ 相对/ 应/ 的/ 整数/ 的/ 加减法/ ./ 本文/ 采用/ 的/ 普通/ 预测器/ 为/ FCM/ [/ 14/ ]/ ,/ 采用/ 的/ 差分/ 预测器/ 为/ DFCM/ [/ 15/ ]/ ./ 实验/ 表明/ ,/ 这/ 两种/ 预测器/ 对于/ 浮点/ 数据/ 能/ 有/ 较/ 好/ 的/ 预测/ 精度/ ./ 为了/ 减少/ 预测/ 表/ 的/ 存储空间/ ,/ 本文/ 采用/ Hash/ 表/ 的/ 方式/ 来/ 存储/ 预测/ 表/ ./ 而/ 在/ 实现/ 时/ ,/ 本文/ 使用/ 前面/ 若干个/ 真实/ 值/ 的/ 组合/ 作为/ Hash/ 表/ 的/ 索引/ ,/ 来/ 得到/ 预测值/ ,/ 从而/ 增加/ 预测/ 的/ 精度/ [/ 8/ ]/ ./ 3.3/ ./ 2/ 异或/ 编码/ 和/ 前导/ 编码/ 在/ 得到/ 真实/ 值/ F/ 的/ 预测值/ 珟/ F/ 之后/ ,/ 本文/ 将/ 使用/ 熵/ 编码方法/ 来/ 编码/ F/ 与/ 珟/ F/ 的/ “/ 差值/ ”/ Δ/ F/ ./ 具体来说/ ,/ 本文/ 将/ Δ/ F/ 定义/ 为/ F/ / 珟/ F/ ,/ 并/ 将/ Δ/ F/ 分为/ 前导/ 零/ 部分/ 和/ 非/ 零/ 部分/ ./ 对于/ 前导/ 零/ 部分/ 将/ 使用/ 熵/ 编码/ 进行/ 压缩/ 传输/ ,/ 而/ 对于/ 非零/ 部分/ 将/ 进行/ 非/ 压缩/ 传输/ ./ 设/ Δ/ F/ 的/ 符号/ 位为/ S/ ,/ 设除/ 符号/ 位外/ ,/ Δ/ F/ 的/ 最后/ 非/ 零位/ 在/ 第/ k/ 位/ (/ k/ ∈/ [/ 0/ ,/ W/ +/ t/ -/ 1/ ]/ )/ ,/ 则/ 当/ Δ/ F/ 非/ 零时/ ,/ 使用/ 熵/ 编码/ 传输/ S/ 与/ k/ ,/ 再/ 无/ 压缩/ 传输/ 的/ 后/ k/ 位/ (/ 当/ k/ =/ 0/ 时/ ,/ 无需/ 传输/ 非零/ 部分/ )/ ./ 当/ Δ/ F/ 为/ 零时/ ,/ 则/ 只/ 需要/ 使用/ 熵/ 编码/ 传输/ 0/ ./ 本文/ 的/ Δ/ F/ 定义/ 与/ 文献/ [/ 7/ ]/ 的/ 定义/ 相同/ ,/ 但/ 不同于/ 文献/ [/ 7/ ]/ 直接/ 传输/ Δ/ F/ ,/ 本文/ 根据/ 浮点数/ 的/ 存储/ 结构/ ,/ 将/ Δ/ F/ 分为/ 符号/ 位/ 和/ 非/ 符号/ 位/ 分别/ 处理/ ./ 对于/ 符号/ 位/ 和/ 前导/ 零/ ,/ 使用/ 快速/ 的/ 变长/ 熵/ 编码/ 压缩/ 方式/ ,/ 从而/ 可以/ 获得/ 更/ 高/ 的/ 压缩比/ ./ 比如/ :/ 若/ F/ 与/ 珟/ F/ 分别/ 为/ -/ 0.01/ 和/ 0.011/ ,/ 这时/ 的/ Δ/ F/ 所/ 对应/ 的/ 16/ 进制/ 表示/ 为/ 8002FDCA45A25DC1/ ./ 若/ 使用/ 本文/ 的/ 方法/ ,/ 除了/ 前导/ 零熵/ 编码/ 之外/ ,/ 只/ 需要/ 存储/ 后面/ 的/ 49/ 位/ ,/ 而/ 文献/ [/ 7/ ]/ 的/ 方法/ 则/ 需要/ 存储/ 所有/ 的/ 64/ 位/ ,/ 还/ 需要/ 4/ 位来/ 定长/ 编码/ 前导/ 零/ ./ 文献/ [/ 4/ ]/ 将/ Δ/ F/ 定义/ 为/ F/ -/ 珟/ F/ ,/ 虽然/ 这种/ 定义/ 更为/ 直接/ ,/ 主要/ 的/ 缺点/ 包括/ :/ (/ 1/ )/ 因/ 直接/ 对/ 浮点数/ 的/ 减法/ 有时/ 并/ 不/ 可逆/ ,/ 即/ 使用/ F/ -/ 珟/ F/ 得到/ Δ/ F/ ,/ 但用/ 珟/ F/ +/ Δ/ F/ 并不一定/ 能/ 准确/ 无损/ 地/ 得到/ F/ ./ 特别/ 是/ 当/ 编码器/ 和/ 解码器/ 位于/ 不同/ 的/ 系统/ ,/ 使用/ 了/ 不同/ 的/ 编译/ 选项/ 时/ 更是如此/ ./ 然而/ ,/ 对于/ 现实/ 中/ 的/ 科学/ 数据压缩/ ,/ 不/ 可能/ 要求/ 编码/ 和/ 解码/ 都/ 在/ 同一/ 系统/ 上/ ,/ 使用/ 同一/ 程序/ 完成/ ./ 所以/ ,/ 在/ 对/ F/ 与/ 珟/ F/ 进行/ 减法/ 操作前/ ,/ 就/ 必须/ 将/ 它们/ 映射/ 成/ 整数/ 进行/ 操作/ ./ 若/ 采用/ 常规/ 的/ 映射/ 方法/ ,/ 则/ 最小/ 正/ 浮点数/ 将会/ 映射/ 成/ 00/ …/ 0/ ,/ 而/ 最大/ 负/ 浮点数/ 将会/ 映射/ 成/ 10/ …/ 0/ ,/ 从而/ 使得/ 两者/ 的/ 整数/ 距离/ 很大/ ./ 为/ 解决/ 这个/ 问题/ ,/ 文献/ [/ 3/ -/ 4/ ]/ 都/ 采用/ 特别/ 的/ 映射/ 方法/ ./ 这种/ 额外/ 的/ 映射/ 将会/ 增加/ 编码器/ 的/ 复杂度/ ,/ 并/ 降低/ 编解码/ 的/ 效率/ ./ (/ 2/ )/ 需要/ 记录/ Δ/ F/ 的/ 符号/ 位/ 信息/ ./ 因/ Δ/ F/ 大于/ 零及/ 小于/ 零/ 的/ 概率/ 基本/ 相等/ ,/ 所以/ 即使/ 使用/ 熵/ 编码/ ,/ 也/ 需要/ 约/ 1/ 比特/ 来/ 存储/ 符号/ 位/ 信息/ ./ Page8/ 总体而言/ ,/ 实验/ 表明/ ,/ 两种/ Δ/ F/ 定义/ 所/ 获得/ 的/ 压缩比/ 没有/ 明显/ 区别/ ,/ 但/ 本文/ 所/ 采用/ 的/ 方式/ 在/ 编解码/ 速度/ 上/ 更为/ 高效/ ./ 3.3/ ./ 3/ 高效/ 熵/ 编码/ 通过/ 图/ 5/ 所示/ 的/ “/ 选择/ 与/ 前导/ 编码器/ ”/ 之后/ ,/ 输出/ 数据/ 包括/ 预测器/ 标志/ 位/ C/ (/ 1/ 位/ )/ ,/ Δ/ F/ 的/ 符号/ 位/ S/ (/ 1/ 位/ )/ 以及/ 除/ 符号/ 位外/ ,/ Δ/ F/ 的/ 最后/ 非/ 零位/ 位置/ k/ ./ k/ 的/ 范围/ 为/ [/ 0/ ,/ W/ +/ t/ -/ 1/ ]/ ./ 本文/ 使用/ k/ =/ W/ +/ t/ 来/ 特别/ 标记/ 除/ 符号/ 位外/ ,/ Δ/ F/ 的/ 其他/ 位全/ 零/ 的/ 情况/ ./ 故/ 熵/ 编码/ 的/ 输入/ 为/ 三元组/ 〈/ C/ ,/ S/ ,/ k/ 〉/ ./ 本文/ 使用/ (/ k/ / 2/ +/ C/ / 1/ +/ S/ )/ 的/ 移位/ 运算/ 将/ 三元组/ 转换成/ 整数/ ,/ 再/ 使用/ 熵/ 编码器/ 对/ 该/ 整数/ 进行/ 编码/ ./ 本文/ 选择/ Range/ 编码/ [/ 16/ ]/ 作为/ 熵/ 编码方法/ ./ Range/ 编码/ 的/ 机理/ 与/ 算法/ 编码/ 类似/ ,/ 但/ 与/ 算术/ 编码/ 的/ 输出/ 以位/ 为/ 单位/ 不同/ ,/ Range/ 编码/ 的/ 输出/ 以/ 字节/ 为/ 单位/ ./ 所以/ ,/ 在/ 现代/ 计算机系统/ 结构/ 下/ ,/ Range/ 编码/ 的/ 速度/ 会/ 比/ 算法/ 编码/ 要/ 快/ ,/ 且/ 压缩比/ 类似/ ./ 同时/ ,/ Range/ 编码/ 不/ 受/ 专利/ 的/ 限制/ ,/ 可以/ 自由/ 使用/ 在/ 科学研究/ 系统/ 中/ ./ 本文/ 选择/ 准/ 静态/ 概率模型/ (/ QuasistaticProba/ -/ bilityModel/ )/ [/ 17/ ]/ 作为/ Range/ 编码器/ 的/ 概率模型/ ./ 准/ 静态/ 概率模型/ 并/ 不/ 在/ 编码/ 每个/ 符号/ 后/ 都/ 更新/ 概率/ 表/ ,/ 而/ 只/ 在/ 每/ 编码/ 若干个/ 符号/ 之后/ ,/ 才/ 更新/ 一次/ 概率/ 表/ ./ 通过/ 准/ 静态/ 概率模型/ 和/ Range/ 编码器/ ,/ 本/ 系统/ 的/ 熵/ 编码/ 部分/ 能/ 在/ 编码/ 效率/ 和/ 压缩比/ 之间/ 取得/ 良好/ 的/ 平衡/ ./ 熵/ 编码/ 后/ 的/ 三元组/ 与/ Δ/ F/ 的/ 后/ k/ (/ k/ 可能/ 为/ 0/ )/ 位/ 通过/ 同步/ 混合/ ,/ 从而/ 形成/ 了/ 最终/ 的/ 压缩/ 数据流/ ./ 3.3/ ./ 4/ 解码器/ 与/ 编码器/ 相对/ 应/ 的/ 解码器/ 结构/ 如图/ 6/ 所示/ ./ 普通/ 预测器/ 根据/ Fi/ 得到/ 预测值/ 珟/ Fi/ +/ 1/ ,/ 1/ ,/ 差分/ 预测器/ 根据/ Fi/ 和/ Fi/ -/ 1/ 得到/ 预测值/ 珟/ Fi/ +/ 1/ ,/ 2/ ./ 压缩/ 数据流/ 通过/ 熵/ 解码/ ,/ 得到/ 三元组/ 〈/ C/ ,/ S/ ,/ k/ 〉/ ./ 前导/ 解码器/ 根据/ S/ 和/ k/ 进行/ 前导/ 解码/ ,/ 得到/ Δ/ F/ ./ “/ 2/ 选/ 1/ ”/ 处理/ 根据/ C/ 来/ 决定/ 是/ 用/ 珟/ Fi/ +/ 1/ ,/ 1/ 还是/ 珟/ Fi/ +/ 1/ ,/ 2/ 来/ 作为/ 珟/ Fi/ +/ 1/ ./ 最后/ ,/ 通过/ 异或/ 珟/ Fi/ +/ 1/ 与/ Δ/ F/ 得到/ Fi/ +/ 1.4/ 性能/ 评估/ 及/ 推广应用/ 4.1/ 性能/ 评估/ 与/ 分析/ 下面/ 通过/ 将/ 本文/ 提出/ 的/ 科学/ 数据/ 无损压缩/ 方法/ 与/ 其他/ 的/ 压缩/ 方法/ 在/ 压缩/ 速度/ 和/ 压缩比/ 两/ 方面/ 进行/ 比较/ ,/ 从而/ 说明/ 本文/ 提出/ 的/ 科学/ 数据/ 无损压缩/ 方法/ 在/ 速度/ 和/ 效果/ 两/ 方面/ 的/ 高性能/ ./ 4.1/ ./ 1/ 评价/ 指标/ 主要/ 的/ 评价/ 指标/ 包括/ :/ (/ 1/ )/ 压缩比/ ./ 压缩/ 之前/ 数据量/ 与/ 压缩/ 之后/ 的/ 数据量/ 之间/ 的/ 比值/ ./ 为了/ 减少/ 极大值/ 的/ 影响/ ,/ 本文/ 采用/ 几何/ 平均值/ 作为/ 多个/ 数据压缩/ 比/ 的/ 平均值/ ./ (/ 2/ )/ 吞吐量/ // 速度/ ./ 单位/ 时间/ 内能/ 处理/ 的/ 数据量/ 的/ 大小/ ./ 分为/ 压缩/ 吞吐量/ 和/ 解压缩/ 吞吐量/ ,/ 以/ Mb/ // s/ 或/ MB/ // s/ 为/ 单位/ (/ 1MB/ // s/ =/ 8Mb/ // s/ )/ ./ 运算/ 吞吐量/ 与/ 运算/ 时间/ 成反比/ ,/ 若/ 压缩/ 吞吐量/ 为/ XMB/ // s/ ,/ 则/ 意味着/ 每/ 压缩/ 1MB/ 的/ 数据/ 需要/ 1/ // X/ 秒/ ./ (/ 3/ )/ 内存/ 使用量/ ./ 压缩比/ 与/ 内存/ 使用量/ 之间/ 的/ 关系/ ./ 4.1/ ./ 2/ 实验/ 环境/ 为了/ 说明/ 本/ 压缩算法/ 的/ 适用性/ ,/ 实验/ 在/ 一台/ 普通/ 的/ 笔记本电脑/ 上/ 进行/ ./ 处理器/ 为/ 1.83/ G/ 的/ 32/ 位/ Intel/ 双核/ CoreDuoT2400/ ./ 为了/ 减小/ 并行/ 双核/ 的/ 影响/ ,/ 在/ BIOS/ 中/ 禁用/ 了/ 双核/ 功能/ ./ 该/ 处理器/ 的/ L2/ 缓存/ 为/ 2MB/ ,/ 前端/ 总线/ 为/ 667MHz/ ./ 系统/ 内存/ 为/ 双通道/ DDR2667MHz2GB/ (/ 1GB/ ×/ 2/ )/ ./ 操作系统/ 为/ UbuntuLinux8/ ./ 04/ (/ Hardy/ )/ ,/ 内核/ 版本/ 为/ 2.6/ ./ 24/ -/ 24/ ./ 程序/ 采用/ gcc4/ ./ 2.4/ (/ g/ ++/ )/ 编译/ ,/ 编译/ 选项/ 只/ 简单/ 的/ 使用/ 了/ ”/ -/ O3/ ”/ 选项/ ./ 4.1/ ./ 3/ 实验设计/ 为了/ 与/ 其他/ 压缩算法/ 具有/ 对比性/ ,/ 本文/ 没有/ 刻意/ 对/ 具体/ 实现/ 进行/ 优化/ ./ 所有/ 的/ 输出/ 均/ 重定向/ 到/ 了/ // dev/ // null/ ./ 测试数据/ 集/ 采用/ 文献/ [/ 8/ ]/ 的/ 科学/ 数据/ ./ 参与/ 比较/ 的/ 压缩算法/ 和/ 软件/ 包括/ Bzip2/ 、/ FPC/ [/ 8/ -/ 9/ ]/ 、/ Gzip/ 和/ PLMI/ [/ 4/ ]/ ./ 为了/ 使/ 所有/ 的/ 输入/ 文件/ 都/ 缓存/ 到/ 内存/ ,/ 所有/ 的/ 程序/ 都/ 执行/ 了/ 5/ 遍/ ,/ 以/ 最/ 短/ 的/ 时间/ 作为/ 执行/ 时间/ ./ 所有/ 的/ 时间/ 值以/ 系统/ 的/ time/ 命令/ 所/ 得出/ 的/ 用户/ 态/ 和/ 内核/ 态/ (/ 系统/ 态/ )/ 时间/ 之/ 和/ 为准/ ./ 内存/ 使用量/ 以/ 系统/ 报告/ 的/ 为准/ ./ 4.1/ ./ 4/ 分析/ 与/ 评价/ 通过/ 对/ 各种/ 算法/ 分析/ 比较/ ,/ 得出/ 了/ 压缩比/ 比较/ 表/ ,/ 如表/ 1/ 所示/ ./ 其中/ Bzip2/ 和/ Gzip/ 均/ 采用/ 1/ ~/ 9/ 压缩/ 等级/ 中/ 最好/ 的/ 结果/ ./ FPC/ 采用/ 1/ ~/ 25/ 压缩/ 等级/ 中/ 最好/ Page9/ 的/ 结果/ ./ 各种/ 数据/ 上/ 最优/ 的/ 压缩/ 结果/ 采用/ 粗体/ 标出/ ./ msg/ _/ bt1/ ./ 1021.2881/ ./ 1301.1991/ ./ 374msg/ _/ lu1/ ./ 0211.1731/ ./ 0551.1341/ ./ 266msg/ _/ sppm6/ ./ 9335.2987/ ./ 4313.2497/ ./ 760msg/ _/ sp1/ ./ 0751.2621/ ./ 1081.1121/ ./ 360msg/ _/ sweep3d1/ ./ 2943.0891/ ./ 0921.3304/ ./ 036num/ _/ brain1/ ./ 0431.1641/ ./ 0641.2451/ ./ 244num/ _/ comet1/ ./ 1731.1571/ ./ 1621.2651/ ./ 249num/ _/ control1/ ./ 0301.0501/ ./ 0581.1241/ ./ 147num/ _/ plasma5/ ./ 78915.0481/ ./ 6081.063227/ ./ 0obs/ _/ error1/ ./ 3393.6031/ ./ 4481.3654/ ./ 421obs/ _/ info1/ ./ 2172.2731/ ./ 1541.0562/ ./ 544obs/ _/ spitzer1/ ./ 7521.0271/ ./ 2321.0751/ ./ 101obs/ _/ temp1/ ./ 0241.0191/ ./ 0361.0881/ ./ 100/ 算术平均/ 1.9842/ ./ 9581.6601/ ./ 33119.662/ 几何平均/ 1.5201/ ./ 9451.3471/ ./ 2632.702/ 由表/ 1/ 可/ 看出/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 大多数/ 数据/ 集上/ 明显/ 优于/ 其他/ 压缩算法/ ./ 因为/ “/ num/ _/ plasma/ ”/ 数据/ 的/ 重复/ 率/ 比较/ 大/ ,/ 且/ 变化/ 较/ 缓慢/ ,/ 从而/ 预测/ 精度/ 较/ 高/ ,/ 预测/ 误差/ 前导/ 零/ 的/ 个数/ 多/ ,/ 熵/ 编码/ 效率高/ ,/ 所以/ 得到/ 了/ 高达/ 227/ 的/ 压缩比/ ./ 所/ 得到/ 的/ 算术平均/ 压缩比/ 和/ 几何平均/ 压缩比/ 也/ 明显/ 高于/ 其他/ 算法/ ./ 为了/ 减少/ 极大值/ 对/ 平均值/ 的/ 影响/ ,/ 以下/ 均/ 以/ 几何/ 平均值/ 为准/ ./ 图/ 7/ 描述/ 各种/ 方法/ 及其/ 相应/ 的/ 各种/ 压缩/ 等级/ 与/ 几何平均/ 压缩比/ 之间/ 的/ 关系/ ./ 从图/ 7/ 中/ 可/ 看到/ ,/ 多数/ 压缩算法/ 的/ 平均/ 压缩比/ 只能/ 达到/ 1.5/ ,/ FPC/ 的/ 平均/ 压缩比/ 最高/ 可达/ 1.94/ (/ 压缩/ 等级/ 为/ 25/ )/ ,/ 此时/ FPC/ 算法/ 需要/ 514MB/ 的/ 内存空间/ (/ 图/ 8/ )/ ./ 而/ 本文/ 算法/ 的/ 平均/ 压缩比/ 最高/ 可达/ 2.7/ (/ 压缩/ 等级/ 为/ 25/ )/ ,/ 远高于/ 其他/ 算法/ ./ 当/ 压缩/ 等级/ 为/ 18/ 时/ 即可/ 得到/ 1.97/ 的/ 平均/ 压缩比/ (/ 图/ 7/ )/ ,/ 此时/ 本文/ 算法/ 所/ 需要/ 的/ 内存空间/ 仅为/ 7MB/ (/ 图/ 8/ )/ ./ 所以/ ,/ 不难看出/ ,/ 不管/ 是/ 在/ 最/ 重要/ 的/ 压缩比/ 上/ ,/ 还是/ 空间/ 复杂度/ 上/ ,/ 本文/ 的/ 算法/ 均/ 要/ 远/ 优于/ 其他/ 算法/ ./ 图/ 8/ 各种/ 方法/ 的/ 平均/ 压缩比/ 与/ 内存/ 使用量/ 之间/ 的/ 关系/ 图/ 9/ 描述/ 了/ 压缩比/ 与/ 系统/ 压缩/ 吞吐量/ 之间/ 的/ 关系/ ./ 当/ 使用/ ”/ catfile/ >/ // dev/ // null/ ”/ 实测/ 不/ 压缩/ 时/ (/ 压缩比/ 为/ 1/ )/ ,/ 系统/ 的/ 最大/ 吞吐量/ 为/ 12Gb/ // s/ ./ 故/ 所有/ 的/ 吞吐量/ 均/ 根据/ 系统/ 最大/ 吞吐量/ 进行/ 了/ 均/ 一化/ ./ 从图/ 中/ 可/ 看到/ ,/ 所有/ 其他/ 算法/ 的/ 吞吐量/ 都/ 随着/ 压缩比/ 的/ 增加/ 而/ 急剧/ 减少/ ,/ 而/ 本文/ 方法/ 的/ 吞吐量/ 随着/ 压缩比/ 的/ 变化/ 基本/ 保持/ 不变/ ./ FPC/ 方法/ 在/ 低/ 压缩比/ 时/ 拥有/ 较/ 高/ 的/ 吞吐量/ ./ 但/ 当/ 压缩/ 比较/ 高时/ (/ >/ 1.8/ )/ ,/ FPC/ 算法/ 的/ 吞吐量/ 与/ 本文/ 相近/ ./ 而/ 在/ 此时/ ,/ FPC/ 算法/ 需要/ 的/ 内存/ 远高于/ 本文/ 方法/ ./ 图/ 9/ 各种/ 方法/ 的/ 平均/ 压缩比/ 与/ 压缩/ 吞吐量/ 之间/ 的/ 关系/ 以上/ 的/ 实验/ 结果/ 及/ 分析表明/ :/ (/ 1/ )/ 本文/ 所/ 提出/ 的/ 科学/ 数据/ 无损压缩/ 方法/ 的/ 压缩比/ 均/ 远/ 优于/ 其他/ 算法/ ./ 本文/ 方法/ 的/ 最高/ 平均/ 压缩比/ 可高达/ 2.7/ ,/ 而/ 其他/ 算法/ 的/ 最高/ 平均/ 压缩比/ 只能/ 达到/ 1.94/ ./ (/ 2/ )/ 本文/ 方法/ 的/ 空间/ 复杂度/ (/ 内存/ 使用量/ )/ 同样/ 优于/ 其他/ 算法/ ./ 在/ 低/ 压缩比/ (/ 1/ →/ 1.7/ )/ 时/ ,/ 各种/ 算法/ 的/ 内存/ 使用量/ 相近/ ,/ 均/ 为/ 2MB/ 左右/ ./ 而/ 当中/ 等/ 压缩比/ (/ 1.7/ →/ 2/ )/ 时/ ,/ 本文/ 方法/ 的/ 内存/ 使用量/ 远/ 低于/ 其他/ 算法/ ./ 只有/ 本文/ 方法/ 能/ 达到/ 高/ 压缩比/ (/ >/ 2/ )/ ./ (/ 3/ )/ 本文/ 方法/ 的/ 压缩/ 吞吐量/ 随着/ 压缩比/ 的/ 变化/ 基本/ 保持/ 恒定/ ./ 在/ 低/ 压缩比/ 时/ ,/ 系统/ 吞吐量/ 优于/ Gzip/ ,/ 远/ 优于/ Bzip2/ ,/ 但/ 低于/ FPC/ ./ 当中/ 等/ 和/ 较/ 高压/ Page10/ 缩比时/ ,/ 吞吐量/ 与/ FPC/ 相近/ ./ 4.2/ 压缩/ 其他/ 格式/ 的/ 浮点数/ 数据/ 虽然/ 之前/ 所/ 描述/ 的/ 算法/ 以及/ 性能/ 评估/ 都/ 是/ 以/ 64/ 位/ 浮点数/ 为例/ ,/ 但本/ 科学/ 数据/ 无损压缩/ 方法/ 同样/ 适用/ 于/ 其它/ 格式/ 的/ 浮点数/ 数据/ ,/ 比如/ 32/ 位/ 的/ 浮点数/ 和/ 128/ 位/ 的/ 浮点数/ 数据压缩/ ./ 数据/ 的/ 压缩比/ 与/ 科学/ 数据/ 的/ 本身/ 精度/ 相关/ ./ 64/ 位/ 浮点数/ 能/ 表示/ 的/ 范围/ 比/ 32/ 位/ 浮点数/ 更/ 宽/ ,/ 且/ 精度/ 更高/ ./ 对于/ 同一个/ 应用/ 而言/ ,/ 相比/ 32/ 位/ 浮点数/ 而言/ ,/ 当/ 使用/ 64/ 位/ 浮点数/ 存储/ 时/ ,/ 对/ 存储/ 位/ 的/ 利用率/ 更高/ ./ 如当/ 存储/ 圆周率/ PI/ 时/ ,/ 若/ 使用/ 32/ 位/ 浮点数/ ,/ 需要/ 用到/ 1/ 个/ 符号/ 位/ 、/ 1/ 个/ 指数/ 位/ 和/ 23/ 个/ 小数位/ (/ 总体/ 利用率/ 78/ %/ )/ ;/ 而/ 若/ 使用/ 64/ 位/ 浮点数/ ,/ 需要/ 用到/ 1/ 个/ 符号/ 位/ 、/ 1/ 个/ 指数/ 位/ 和/ 52/ 个/ 小数位/ (/ 总体/ 利用率/ 84/ %/ )/ ./ 所以/ ,/ 对/ 同一个/ 应用/ ,/ 32/ 位/ 数据/ 比/ 64/ 位/ 数据/ 稍易/ 进行/ 压缩/ ./ 根据/ 式/ (/ 14/ )/ ,/ 也/ 可/ 得到/ 类似/ 的/ 结论/ ./ 当/ 预测/ 误差/ 为/ 1/ %/ (/ r/ =/ 1.01/ )/ 时/ ,/ 若/ 使用/ 的/ 是/ 32/ 位/ 浮点数/ ,/ 根据/ 式/ (/ 14/ )/ 知/ 可压缩/ 的/ 前导/ 零/ 数目/ 约/ 为/ 13.2/ ,/ 压缩比/ 约/ 为/ 1.7/ ./ 而/ 若/ 使用/ 的/ 是/ 64/ 位/ 浮点数/ ,/ 同样/ 根据/ 式/ (/ 14/ )/ 知/ 可压缩/ 的/ 前导/ 零/ 数目/ 约/ 为/ 16.2/ ,/ 压缩比/ 约/ 为/ 1.34/ ./ 4.3/ 应用/ 本文/ 方法/ 主要/ 应用/ 于/ 科学计算/ 中/ 二进制/ 原始/ 浮点/ 数据/ 的/ 无损压缩/ ./ 因/ 压缩/ 后/ 的/ 数据/ 小于/ 原始数据/ ,/ 采用/ 压缩算法/ 有利于/ 节省/ 存储空间/ 及/ 减少/ 数据传输/ 时间/ ./ 若/ 用户/ 需要/ 将/ 一个/ 1GB/ 的/ 数据/ 通过/ 网络/ 从/ 一个/ 地点/ 传输/ 到/ 另/ 一/ 地点/ ,/ 即使/ 采用/ 的/ 是/ 100Mb/ // s/ 的/ 高速/ 以太网/ (/ 实际/ 速率/ 约/ 为/ 10MB/ // s/ )/ ,/ 在/ 最/ 理想/ 情况/ 下/ 需要/ 的/ 传输/ 和/ 存储/ 时间/ 为/ 100s/ ,/ 且/ 接收者/ 需要/ 存储/ 1GB/ 的/ 数据/ ./ 为了/ 减少/ 需要/ 传输/ 和/ 存储/ 的/ 数据量/ ,/ 许多/ 科学计算/ 工作者/ 采用/ 通用/ 压缩工具/ (/ 如/ Gzip/ )/ 压缩/ 数据/ ./ 仍以/ 上述/ 分析/ 为例/ ,/ Gzip/ 使用/ 默认/ 参数/ 时/ 几何平均/ 压缩比/ 约/ 为/ 1.34/ ,/ 压缩/ 吞吐/ 率约/ 为/ 16MB/ // s/ ,/ 解压缩/ 吞吐/ 率约/ 为/ 75MB/ // s/ ./ 考虑/ 到/ 压缩/ ,/ 解压缩/ 和/ 传输/ 可/ 由/ 处理器/ 和/ 网络适配器/ 同时/ 进行/ ,/ 若/ 在/ 传输/ 的/ 同时/ 进行/ 压缩/ 和/ 解压缩/ ,/ 则/ 总/ 时间/ 只/ 由/ 系统/ 瓶颈/ 决定/ ./ 由图/ 9/ 可知/ ,/ 除/ Bzip2/ 外/ ,/ 各/ 压缩算法/ 的/ 吞吐/ 率均/ 大于/ 10MB/ // s/ ,/ 大于/ 网络/ 传输速率/ ./ 在/ 计算/ 与/ 传输/ 重叠/ 时/ ,/ 总/ 时间/ 约/ 为/ (/ 1000MB/ // 1.34/ )/ // (/ 10MB/ // s/ )/ ≈/ 74.6/ s/ ;/ 计算/ 与/ 传输/ 串行/ 时/ ,/ 总/ 时间/ 约/ 为/ 74.6/ s/ +/ 1000MB/ // (/ 16MB/ // s/ )/ +/ 1000MB/ // (/ 75MB/ // s/ )/ ≈/ 150s/ ./ 且/ 只/ 需要/ 存储/ 746MB/ 的/ 数据/ ./ 而/ 若/ 采用/ 本文/ 方法/ ,/ 当/ 几何平均/ 压缩比/ 为/ 2.7/ 时/ ,/ 压缩/ 吞吐/ 率约/ 为/ 29MB/ // s/ ,/ 解压缩/ 吞吐/ 率约/ 为/ 25MB/ // s/ ./ 在/ 计算/ 与/ 传输/ 重叠/ 时/ ,/ 总/ 时间/ 约/ 为/ (/ 1000MB/ // 2.7/ )/ // (/ 10MB/ // s/ )/ ≈/ 37s/ ;/ 计算/ 与/ 传输/ 串行/ 时/ ,/ 总/ 时间/ 约/ 为/ 37s/ +/ 1000MB/ // (/ 29MB/ // s/ )/ +/ 1000MB/ // (/ 25MB/ // s/ )/ ≈/ 111s/ ./ 且/ 只/ 需要/ 存储/ 370MB/ 的/ 数据/ ./ 由此可见/ ,/ 在/ 计算/ 与/ 传输/ 重叠/ 时/ ,/ 通过/ 压缩/ 数据/ 带来/ 的/ 性能/ 提升/ 是/ 很/ 明显/ 的/ ./ 即使/ 在/ 计算/ 与/ 传输/ 串行/ 时/ ,/ 也/ 能/ 在/ 速度/ 相近/ 的/ 情况/ 下/ ,/ 大幅度/ 减少/ 需要/ 的/ 存储空间/ ./ 而/ 实际/ 的/ 互联网/ 传输速率/ 往往/ 远/ 低于/ 100Mb/ // s/ ,/ 以/ ADSL/ 宽带/ 为例/ ,/ 最大/ 上行/ 速率/ 512kb/ // s/ ,/ 最大/ 下行/ 速率/ 8Mb/ // s/ (/ =/ 1MB/ // s/ )/ ,/ 导致/ 传输/ 时间/ 大大增加/ ,/ 从而/ 采用/ 本文/ 方法/ 的/ 效果/ 更为/ 明显/ ./ 本文/ 方法/ 已/ 被/ 应用/ 于/ 颗粒/ 材料/ 的/ 大规模/ 动力学/ 过程/ 仿真/ 中/ ./ 主要/ 包括/ 颗粒/ 材料/ 的/ 堆积/ 过程/ 模拟/ 研究/ 和/ 颗粒/ 的/ 相/ 分离/ 现象/ 模拟/ 研究/ ./ 在/ 这些/ 仿真/ 中/ ,/ 涉及/ 到/ 107/ 规模/ 的/ 颗粒/ 体在/ 真/ 三维/ 环境/ 中/ 的/ 动力学/ 过程/ ,/ 每个/ 模拟/ 步/ 产生/ 数/ GB/ 的/ 数据/ ./ 为了/ 对/ 这些/ 海量/ 数据/ 进行/ 存储/ ,/ 必须/ 使用/ 本文/ 的/ 高性能/ 无损压缩/ 方法/ ./ 这些/ 应用/ 的/ 具体/ 信息/ 请/ 参见/ 文献/ [/ 18/ -/ 21/ ]/ ./ 5/ 总结/ 及/ 未来/ 工作/ 本文/ 提出/ 了/ 高性能/ 的/ 科学/ 数据/ 无损压缩/ 算法/ ./ 通过/ 与/ 其他/ 算法/ 进行/ 比较/ ,/ 本文/ 所/ 提出/ 的/ 方法/ 的/ 压缩比/ 均/ 远/ 优于/ 其他/ 算法/ ,/ 最高/ 平均/ 压缩比/ 可高达/ 2.7/ ,/ 而/ 其他/ 算法/ 的/ 最高/ 平均/ 压缩比/ 只能/ 达到/ 1.94/ ./ 本文/ 方法/ 的/ 空间/ 复杂度/ (/ 内存/ 使用量/ )/ 同样/ 优于/ 其他/ 算法/ ./ 在/ 低/ 压缩比/ (/ 1/ →/ 1.7/ )/ 时/ ,/ 各种/ 算法/ 的/ 内存/ 使用量/ 相近/ ,/ 均/ 为/ 2MB/ 左右/ ./ 而/ 当中/ 等/ 压缩比/ (/ 1.7/ →/ 2/ )/ 时/ ,/ 本文/ 方法/ 的/ 内存/ 使用量/ 远/ 低于/ 其他/ 算法/ ./ 同时/ ,/ 本文/ 方法/ 在/ 低/ 、/ 中/ 、/ 高/ 压缩比/ 时/ ,/ 均/ 具有/ 高/ 吞吐量/ 的/ 特点/ ,/ 数据处理/ 能力/ 在/ 中/ 、/ 高/ 压缩比/ 时/ 远高于/ 通用/ 压缩算法/ ./ 本文/ 提出/ 的/ 方法/ 特别/ 适合/ 海量/ 科学/ 数据/ 的/ 高/ 压缩比/ 无损/ 传输/ 和/ 存储/ ./ 在/ 本文/ 中/ ,/ 只/ 考虑/ 了/ 前导/ 零/ 的/ 熵/ 编码/ ,/ 在/ 接下来/ 的/ 研究/ 中将/ 继续/ 考虑/ 后缀/ 零/ 的/ 影响/ ./ 同时/ ,/ 因为/ 预测/ 算法/ 和/ 预测/ 精度/ 对于/ 压缩比/ 至/ 为/ 关键/ ,/ 在/ 后续/ 研究/ 中/ 还/ 将/ 考虑/ 其他/ 多种/ 预测/ 算法/ 以及/ 基于/ 概率模型/ 的/ 预测/ 算法/ 自/ 适应/ 选择/ 和/ 混合/ ./ 在/ 应用/ 方面/ ,/ 除了/ 已/ 应用/ 了/ 本文/ 方法/ 的/ 大规模/ 颗粒/ 动力学/ 模拟/ 之外/ ,/ 还/ 将/ 根据/ 其他/ 大规模/ 实际/ 科学计算/ 和/ 工程/ 仿真/ 的/ 需求/ ,/ 对/ 本文/ 方法/ 进行/ 进一步/ 推广/ 和/ 改进/ ./ Page11/ 

