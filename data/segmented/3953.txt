Page1/ 标准/ 模型/ 下/ 增强/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ 李强/ 冯登国/ 张立武/ 高志/ 刚/ (/ 中国科学院/ 软件/ 研究所/ 可信计算/ 与/ 信息/ 保障/ 实验室/ 北京/ 100190/ )/ 摘要/ 采用/ 一种/ 简洁/ 高效/ 的/ 转化/ 方法/ 将/ Waters/ 的/ 只能/ 抵抗/ 选择/ 明文/ 攻击/ (/ Chosen/ -/ PlaintextAttack/ ,/ CPA/ )/ 的/ 基于/ 属性/ 的/ 加密/ 方案/ 转化/ 为/ 能够/ 抵抗/ 选择/ 密文/ 攻击/ (/ Chosen/ -/ CiphertextAttack/ ,/ CCA/ )/ 的/ 密钥/ 封装/ 方案/ ,/ 并/ 在/ 此基础/ 上/ 提出/ 了/ 一个/ 标准/ 模型/ 下/ 增强/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ ./ 该/ 协议/ 能够/ 在/ CK/ +/ 模型/ 下可证/ 安全/ ./ CK/ +/ 模型/ 是/ 目前/ 关于/ 认证/ 密钥/ 协商/ 协议/ 的/ 最强/ 的/ 安全性/ 定义/ ./ 本文/ 协议/ 满足/ 弱/ 的/ 完美/ 前向/ 安全性/ ,/ 并/ 能/ 抵抗/ 密钥/ 泄露/ 伪装/ 攻击/ 和/ 临时/ 密钥/ 泄露/ 攻击/ ./ 相比/ 于/ 现有/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ ,/ 本文/ 协议/ 具有/ 更/ 高/ 的/ 通信/ 效率/ 和/ 更/ 强/ 的/ 安全性/ ./ 关键词/ 认证/ ;/ 密钥/ 协商/ ;/ 基于/ 属性/ ;/ CK/ +/ 模型/ ;/ 标准/ 模型/ 1/ 引言/ 认证/ 密钥/ 协商/ 协议/ 能够/ 在/ 开放/ 的/ 网络/ 环境/ 中/ 实现/ 用户/ 的/ 相互/ 认证/ ,/ 并/ 在/ 用户/ 之间/ 建立/ 安全/ 信道/ 以/ 保护/ 用户/ 的/ 通信安全/ ,/ 因此/ 认证/ 密钥/ 协商/ 协议/ 在/ 实/ Page22005/ 年/ 以来/ ,/ 基于/ 属性/ 的/ 密码/ 体制/ 被/ 首次/ 提出/ ,/ 并/ 得到/ 了/ 广泛/ 的/ 研究/ 和/ 应用/ ,/ 其中/ 基于/ 属性/ 的/ 加密/ (/ Attribute/ -/ BasedEncryption/ ,/ ABE/ )/ 方案/ [/ 1/ -/ 4/ ]/ 主要/ 应用/ 于/ 细粒度/ 的/ 访问控制/ ;/ 基于/ 属性/ 的/ 签名/ (/ Attribute/ -/ BasedSignature/ ,/ ABS/ )/ 方案/ [/ 5/ -/ 6/ ]/ 虽然/ 能够/ 实现/ 单向/ 的/ 匿名/ 认证/ ,/ 但/ 不能/ 建立/ 安全/ 信道/ ;/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ (/ Attribute/ -/ BasedAuthenticatedKeyAgreement/ ,/ ABAKA/ )/ 协议/ [/ 7/ -/ 12/ ]/ 在/ 实现/ 双向/ 匿名/ 认证/ 的/ 同时/ 能够/ 建立/ 安全/ 信道/ ./ 在/ ABAKA/ 协议/ 中/ ,/ 若/ 协议/ 双方/ 拥有/ 的/ 属性/ 均/ 满足/ 对方/ 指定/ 的/ 认证/ 策略/ (/ 与/ 、/ 或/ 、/ 门限/ 等/ )/ ,/ 则/ 双方/ 能够/ 实现/ 相互/ 认证/ 并/ 能/ 建立/ 共同/ 的/ 会/ 话/ 密钥/ ,/ 因此/ ABAKA/ 协议/ 在/ 实现/ 灵活/ 丰富/ 的/ 认证/ 策略/ 的/ 同时/ 更好/ 地/ 保护/ 了/ 用户/ 的/ 隐私/ ,/ 更/ 适合/ 应用/ 于/ 分布式/ 的/ 云/ 环境/ 中/ ./ 2009/ 年/ Wang/ 等/ 人/ [/ 7/ -/ 9/ ]/ 第/ 1/ 次/ 提出/ 了/ 两方/ 的/ ABAKA/ 协议/ ,/ 然而/ 上述/ 协议/ 中/ 的/ 认证/ 策略/ 为/ 用户/ 必须/ 拥有/ 消息/ 中/ 所有/ 的/ 属性/ ,/ 因此/ 并/ 没有/ 实现/ 灵活/ 的/ 通用/ 认证/ 策略/ (/ 与/ 、/ 或/ 、/ 门限/ 等/ )/ ,/ 此外/ 上述/ 协议/ 都/ 是/ 在/ BR/ (/ Bellare/ -/ Rogaway/ )/ 模型/ 下/ 证明/ 的/ 安全性/ ./ 2010/ 年/ Yoneyama/ [/ 10/ ]/ 在/ Waters/ [/ 4/ ]/ 的/ 加密/ 方案/ 基础/ 上/ 提出/ 了/ 一个/ 1/ 轮/ 的/ 随机/ 预言/ 机/ (/ RandomOracle/ ,/ RO/ )/ 模型/ 下/ 支持/ 通用/ 认证/ 策略/ 的/ ABAKA/ 协议/ ,/ 该/ 协议/ 利用/ 了/ NAXOS/ 技巧/ [/ 13/ ]/ 将/ 用户/ 长期/ 私钥/ 和/ 临时/ 密钥/ 作为/ 杂凑/ 函数/ 的/ 输入/ ,/ 并/ 使用/ 其/ 计算结果/ 作为/ 密钥/ 封装/ 方案/ 的/ 随机数/ ,/ 因此/ 该/ 协议/ 能/ 在/ eCK/ (/ extendedCanetti/ -/ Krawczyk/ )/ 模型/ 下可证/ 安全/ ,/ 但/ 由于/ 使用/ 了/ 杂凑/ 函数/ ,/ 该/ 协议/ 只能/ 在/ RO/ 模型/ 下/ 证明/ 其/ 安全性/ ./ Birkett/ 等/ 人/ [/ 11/ ]/ 提出/ 了/ 第/ 1/ 个/ 标准/ 模型/ 下/ 支持/ 通用/ 认证/ 策略/ 的/ ABAKA/ 协议/ ,/ 该/ 协议/ 使用/ 了/ 基于/ 属性/ 的/ 签名/ 方案/ ,/ 若/ 所/ 使用/ 的/ 签名/ 方案/ 支持/ 通用/ 认证/ 策略/ ,/ 则/ 该/ 协议/ 也/ 支持/ 同样/ 的/ 策略/ ,/ 但/ 该/ 协议/ 需要/ 运行/ 3/ 轮且/ 安全性/ 证明/ 是/ 在/ BR/ 模型/ 中/ 进行/ 的/ ./ 2011/ 年/ Yoneyama/ [/ 12/ ]/ 在/ Waters/ [/ 4/ ]/ 的/ 加密/ 方案/ 基础/ 上/ 提出/ 了/ 一个/ 1/ 轮/ 的/ 标准/ 模型/ 下/ 的/ ABAKA/ 协议/ ,/ 该/ 协议/ 支持/ 通用/ 认证/ 策略/ ,/ 并/ 在/ CK/ (/ Canetti/ -/ Krawczyk/ )/ 模型/ 下可证/ 安全/ ./ 该/ 协议/ 采用/ 了/ Boneh/ 等/ 人/ [/ 14/ ]/ 方案/ 中/ 的/ 一次性/ 签名/ 的/ 转化/ 方法/ 将/ CPA/ 安全/ 的/ Waters/ [/ 4/ ]/ 的/ 加密/ 方案/ 转化/ 为/ CCA/ 安全/ 的/ 密钥/ 封装/ 方案/ ,/ 该/ 方法/ 将/ 一次性/ 签名/ 的/ 验证/ 密钥/ 比特/ 串/ 的/ 每/ 一位/ (/ 0/ 或/ 1/ )/ 映射/ 为/ 两个/ 冗余/ 属性/ ,/ 从而/ 导致/ 协议/ 通信量/ 和/ 系统/ 的/ 公共/ 参数/ 都/ 增加/ 了/ 2k/ 个群/ 元素/ ,/ 其中/ k/ 为/ 一次性/ 签名/ 方案/ 中/ 验证/ 密钥/ 的/ 比特/ 串/ 长度/ ,/ 因此/ 这种/ 转化/ 方法/ 增加/ 了/ 协议/ 的/ 复杂度/ ./ 2007/ 年/ LaMacchia/ 等/ 人/ [/ 13/ ]/ 在/ 前人/ 工作/ (/ BR/ 模型/ 和/ CK/ 模型/ )/ 的/ 基础/ 上/ 提出/ 了/ 扩展/ 的/ CK/ 模型/ 即/ eCK/ 模型/ ,/ 该/ 模型/ 能够/ 证明/ 认证/ 密钥/ 协商/ 协议/ 抵抗/ 密钥/ 泄露/ 伪装/ (/ KeyCompromiseImpersonation/ ,/ KCI/ )/ 攻击/ 和/ 临时/ 密钥/ 泄露/ (/ LeakageofEphemeralKey/ ,/ LEK/ )/ 攻击/ ,/ 并/ 能够/ 证明/ 协议/ 满足/ 弱/ 的/ 完美/ 前向/ 安全性/ (/ weakPerfectForwardSecrecy/ ,/ wPFS/ )/ ./ 然而/ 由于/ eCK/ 模型/ 不/ 允许/ 攻击者/ 对会话/ 内部/ 状态/ 进行/ 查询/ ,/ Cremers/ [/ 15/ -/ 16/ ]/ 证明/ 了/ eCK/ 模型/ 与/ CK/ 模型/ 不可/ 比较/ ,/ 即/ eCK/ 模型/ 并不比/ CK/ 模型/ 的/ 安全性/ 更强/ ./ 2012/ 年/ Fujioka/ 等/ 人/ [/ 17/ ]/ 将/ CK/ 模型/ 与/ eCK/ 模型/ 整合/ 提出/ 了/ CK/ +/ 模型/ ,/ 并/ 采用/ 了/ Okamoto/ [/ 18/ ]/ 的/ twisted/ -/ PRF/ 技巧/ ,/ 提出/ 了/ 一个/ 在/ CK/ +/ 模型/ 下可证/ 安全/ 的/ 通用/ 构造/ 方案/ ./ CK/ +/ 模型/ 在/ eCK/ 模型/ 的/ 基础/ 上/ 增加/ 了/ 攻击者/ 对会话/ 内部/ 状态/ 的/ 查询/ ,/ 因此/ 该/ 模型/ 是/ 目前/ 关于/ 认证/ 密钥/ 协商/ 协议/ 的/ 最强/ 的/ 安全性/ 定义/ ./ 本文/ 借鉴/ 了/ Lai/ 等/ 人/ [/ 19/ ]/ 基于/ 身份/ 的/ 加密/ 方案/ 中/ 提出/ 的/ 一个/ 简洁/ 高效/ 的/ 从/ CPA/ 到/ CCA/ 的/ 转化/ 方法/ ,/ 将/ Waters/ [/ 4/ ]/ 的/ 加密/ 方案/ 转化/ 为/ 一个/ CCA/ 安全/ 的/ 基于/ 属性/ 的/ 密钥/ 封装/ 方案/ ,/ 使得/ 该/ 方案/ 的/ 公共/ 参数/ 只/ 增加/ 了/ 3/ 个群/ 元素/ ,/ 密文/ 只/ 增加/ 了/ 两个/ 群/ 元素/ ,/ 并/ 在/ 此基础/ 上/ 采用/ twisted/ -/ PRF/ 技巧/ [/ 18/ ]/ ,/ 提出/ 了/ 一个/ 在/ 标准/ 模型/ 和/ CK/ +/ 模型/ 下可证/ 安全/ 的/ ABAKA/ 协议/ ./ Fujioka/ 等/ 人/ [/ 17/ ]/ 的/ 通用/ 构造/ 方案/ 结合/ 了/ 一个/ CCA/ 安全/ 和/ 一个/ CPA/ 安全/ 的/ 密钥/ 封装/ 方案/ ,/ 协议/ 运行/ 轮数/ 为/ 2/ 轮/ ./ 本文/ 通过/ 在/ 协议/ 中/ 增加/ 了/ 一次/ Diffie/ -/ Hellman/ 交换/ ,/ 使得/ 所提/ 协议/ 只/ 需/ 一个/ CCA/ 安全/ 的/ 基于/ 属性/ 的/ 密钥/ 封装/ 方案/ ,/ 且/ 协议/ 运行/ 轮数/ 为/ 1/ 轮/ ./ 相比/ 于/ 现有/ 的/ ABAKA/ 协议/ ,/ 本文/ 所提/ 协议/ 具有/ 更/ 高/ 的/ 通信/ 效率/ 和/ 更/ 强/ 的/ 安全性/ ./ 2/ 预备/ 知识/ 2.1/ 访问/ 结构/ 定义/ 1/ [/ 20/ ]/ ./ 令/ P/ =/ {/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ }/ 是/ 参与方/ 的/ 集合/ ,/ 一个/ 访问/ 结构/ AA/ 是/ 2P/ 的/ 一个/ 非/ 空子/ 集/ ,/ 即/ AA/ / 2P/ \/ {/ / }/ ./ 称/ AA/ 是/ 单调/ 的/ 访问/ 结构/ ,/ 则/ 对/ 任意/ 的/ / B/ ,/ C/ 集合/ ,/ 若/ B/ ∈/ AA/ 且/ B/ / C/ ,/ 则/ C/ ∈/ AA/ ./ 若/ 集合/ 在/ 访问/ 结构/ AA/ 中/ ,/ 则/ 称为/ 授权/ 集合/ ,/ 否则/ 称为/ 非/ 授权/ 集合/ ./ 2.2/ 线性/ 秘密/ 分享/ 方案/ 定义/ 2/ [/ 20/ ]/ ./ 令/ 参与方/ 集合/ 为/ P/ =/ {/ P1/ ,/ P2/ ,/ …/ ,/ Pn/ }/ ,/ (/ 犕/ ,/ ρ/ )/ 表示/ 访问/ 结构/ AA/ ,/ 其中/ 犕/ 是/ 一个/ l/ ×/ n/ 的/ 矩阵/ ,/ ρ/ 是/ 一个/ 从/ {/ 1/ ,/ 2/ ,/ …/ ,/ l/ }/ 到/ P/ 的/ 映射/ ,/ 即/ 矩阵/ 犕/ 中/ 的/ 每/ 一行/ 表示/ 一个/ 参与方/ ./ 一个/ 线性/ 秘密/ 分享/ Page3/ 方案/ (/ LinearSecretSharingSchemes/ ,/ LSSS/ )/ 包含/ 以下/ 两个/ 算法/ ./ 秘密/ 分享/ 算法/ ./ 如果/ 分享/ 秘密/ 值/ s/ ,/ 首先/ 选取/ 一个/ n/ 维/ 的/ 向量/ 狏/ =/ (/ s/ ,/ v1/ ,/ v2/ ,/ …/ ,/ vn/ -/ 1/ )/ T/ ,/ 其中/ v1/ ,/ v2/ ,/ …/ ,/ vn/ -/ 1/ ∈/ / p/ ,/ 然后/ 将/ λ/ i/ =/ 犕/ i/ ·/ 狏/ 作为/ 参与方/ ρ/ (/ i/ )/ 所/ 获得/ 的/ 秘密/ 分享/ 值/ ,/ 其中/ 犕/ i/ 为/ 矩阵/ 第/ i/ 行所/ 代表/ 的/ 向量/ ./ 秘密/ 恢复/ 算法/ ./ 如果/ 参与方/ 的/ 集合/ 为/ 授权/ 集合/ ,/ 即/ S/ ∈/ AA/ ,/ 令/ I/ =/ {/ i/ :/ ρ/ (/ i/ )/ ∈/ S/ }/ ,/ 则/ 存在/ 一个/ 算法/ 能够/ 在/ 多项式/ 时间/ 内/ 根据/ 犕/ 计算/ 出/ 一组/ 恢复系数/ {/ μ/ i/ }/ i/ ∈/ I/ ,/ 并/ 使得/ ∑/ i/ ∈/ I/ μ/ i/ ·/ 犕/ i/ =/ (/ 1/ ,/ 0/ ,/ …/ ,/ 0/ )/ ,/ 因此/ 可以/ 恢复/ 秘密/ 值/ ∑/ i/ ∈/ I/ μ/ i/ ·/ λ/ i/ =/ ∑/ i/ ∈/ I/ μ/ i/ ·/ 犕/ i/ ·/ 狏/ =/ s/ ./ 而/ 对/ 非/ 授权/ 集合/ I/ ,/ 则/ 存在/ 一个/ 算法/ 能够/ 在/ 多项式/ 时间/ 内/ 计算/ 出/ 一个/ 向量/ ω/ =/ (/ ω/ 1/ ,/ ω/ 2/ ,/ …/ ,/ ω/ n/ )/ T/ ∈/ / 且/ 对/ i/ ∈/ I/ ,/ 有/ 犕/ i/ ·/ ω/ =/ 0.2/ ./ 3/ 双线性/ 映射/ 定义/ 3/ ./ 设/ G/ ,/ GT/ 是/ 两个/ 阶均/ 为/ p/ 的/ 循环群/ (/ p/ 为/ 素数/ )/ ,/ g/ 为/ G/ 的/ 一个/ 生成元/ ,/ 双线性/ 映射/ e/ 是/ G/ ×/ G/ →/ GT/ 的/ 一个/ 映射/ ,/ 若/ e/ 满足/ 以下/ 3/ 个/ 性质/ ,/ 则/ 称/ e/ 是/ 一个/ 有效/ 的/ 从/ G/ 到/ GT/ 的/ 双线性/ 映射/ :/ (/ 1/ )/ 双线性/ ./ / a/ ,/ b/ ∈/ / p/ ,/ e/ (/ ga/ ,/ gb/ )/ =/ e/ (/ g/ ,/ g/ )/ ab/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ e/ (/ g/ ,/ g/ )/ ≠/ 1/ ./ (/ 3/ )/ 可计算性/ ./ 对/ / x/ ,/ y/ ∈/ G/ ,/ 存在/ 一个/ 有效/ 的/ 多项式/ 时间/ 算法/ 来/ 计算/ e/ (/ x/ ,/ y/ )/ ./ 2.4/ DPBDHE/ 假设/ 定义/ 4/ [/ 4/ ]/ ./ 设/ G/ ,/ GT/ 是/ 两个/ 阶均/ 为/ p/ 的/ 循环群/ (/ p/ 为/ 素数/ )/ ,/ g/ 为/ G/ 的/ 一个/ 生成元/ ,/ e/ 是/ G/ ×/ G/ →/ GT/ 的/ 一个/ 双线性/ 映射/ ,/ 随机/ 选择/ a/ ,/ s/ ,/ b1/ ,/ b2/ ,/ …/ ,/ bq/ ∈/ / p/ ,/ 并/ 给定/ 以下/ 元组/ :/ gs/ ,/ ga/ ,/ …/ ,/ gaq/ ,/ gaq/ +/ 2/ ,/ …/ ,/ ga2q/ / 1/ / j/ / qgsbj/ ,/ ga/ // bj/ ,/ …/ ,/ gaq/ // bj/ ,/ gaq/ +/ 2/ // bj/ ,/ …/ ,/ ga2q/ // bj/ / 1/ / j/ ,/ k/ / q/ ,/ j/ ≠/ kgasbk/ // bj/ ,/ …/ ,/ gaqsbk/ // bj/ 若/ 不/ 存在/ 一个/ 算法/ ,/ 能够/ 在/ 多项式/ 时间/ 内以/ 不可/ 忽略/ 的/ 概率/ 区分/ e/ (/ g/ ,/ g/ )/ saq/ +/ 1/ 和/ 群/ GT/ 中/ 的/ 随机/ 元素/ ,/ 则/ 称/ DPBDHE/ (/ DecisionalParallelBilinearDiffie/ -/ HellmanExponent/ )/ 假设/ 成立/ ./ 2.5/ 强/ 随机/ 提取/ 器/ 定义/ 5/ [/ 12/ ]/ ./ 称/ 一个/ 函数/ Ext/ :/ {/ 0/ ,/ 1/ }/ d/ ×/ {/ 0/ ,/ 1/ }/ n/ →/ {/ 0/ ,/ 1/ }/ m/ 是/ 强/ 随机/ 提取/ 器/ ,/ 若/ 对于/ 任意/ 的/ {/ 0/ ,/ 1/ }/ n/ 上且/ 最小/ 熵/ H/ (/ X/ )/ / k/ 的/ 均匀分布/ X/ ,/ Ext/ (/ s/ ,/ X/ )/ 和/ {/ 0/ ,/ 1/ }/ m/ 上/ 的/ 随机/ 串/ 统计/ 上/ 不可/ 区分/ ,/ 其中/ s/ 是/ 在/ 种子/ 空间/ {/ 0/ ,/ 1/ }/ d/ 上/ 随机/ 选择/ 的/ 种子/ ./ 2.6/ 伪/ 随机/ 函数/ 集/ 定义/ 6/ [/ 12/ ]/ ./ 称/ 一个/ 函数/ 集/ F/ =/ {/ Fs/ }/ s/ ∈/ K/ 是/ 伪/ 随机/ 的/ ,/ 若/ 不/ 存在/ 一个/ 区分/ 者/ / ,/ 能够/ 在/ 多项式/ 时间/ 内以/ 不可/ 忽略/ 的/ 概率/ 区分/ Fk/ (/ ·/ )/ 和/ RF/ (/ ·/ )/ ,/ 其中/ k/ 是/ 在/ 密钥/ 空间/ K/ 中/ 随机/ 选择/ 的/ 密钥/ ,/ RF/ 是/ 一个/ 随机/ 选择/ 的/ 真/ 随机/ 函数/ ./ 3/ 安全/ 模型/ 在/ 本文/ 中/ ,/ 我们/ 对/ 文献/ [/ 17/ ]/ 中/ 定义/ 的/ CK/ +/ 模型/ 进行/ 扩展/ ,/ 使用/ 属性/ 描述/ 协议/ 实体/ ,/ 使该/ 模型/ 能/ 适应/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ 的/ 安全性/ 分析/ ,/ 能够/ 证明/ 协议/ 满足/ wPFS/ ,/ 并/ 能/ 抵抗/ KCI/ 和/ LEK/ 攻击/ ./ 弱/ 的/ 完美/ 前向/ 安全性/ (/ weakPerfectForwardSecrecy/ ,/ wPFS/ )/ :/ 若/ 协议/ 双方/ 的/ 私钥/ 泄露/ ,/ 且/ 私钥/ 泄露/ 前/ 的/ 会/ 话/ 未/ 受到/ 攻击者/ 的/ 主动攻击/ ,/ 即/ 攻击者/ 未/ 对/ 双方/ 的/ 通信/ 消息/ 进行/ 修改/ ,/ 在/ 这种/ 情况/ 下/ ,/ 若/ 攻击者/ 无法/ 获得/ 上述/ 会话/ 的/ 会/ 话/ 密钥/ ,/ 则/ 该/ 协议/ 满足/ wPFS/ ./ 抵抗/ 密钥/ 泄露/ 伪装/ (/ KeyCompromiseImper/ -/ sonation/ ,/ KCI/ )/ 攻击/ :/ 若/ 攻击者/ 获得/ 了/ 协议/ 实体/ A/ 的/ 私钥/ ,/ 且/ 攻击者/ 不能/ 伪装成/ 其它/ 用户/ 与/ A/ 成功/ 完成/ 协议/ ,/ 则/ 该/ 协议/ 能够/ 抵抗/ KCI/ 攻击/ ./ 协议/ 实体/ ./ 协议/ 实体/ U/ 使用/ 属性/ 集/ SU/ 来/ 描述/ ,/ 且/ 可以/ 同时/ 进行/ 多个/ 会话/ ./ 若/ 一个/ 由/ A/ 发起/ 的/ 与/ B/ 之间/ 的/ 会/ 话/ 产生/ 了/ 消息/ m1/ ,/ m2/ ,/ …/ ,/ mn/ ,/ 则/ 该会/ 话/ id/ 被/ A/ 标识/ 为/ sid/ =/ (/ I/ ,/ SA/ ,/ SB/ ,/ m1/ ,/ …/ ,/ mn/ )/ ,/ 被/ B/ 标识/ 为/ sid/ =/ (/ R/ ,/ SB/ ,/ SA/ ,/ m1/ ,/ …/ ,/ mn/ )/ ./ 已/ 完成/ 会话/ 是/ 指/ 在/ 一次/ 会话/ 中/ 协议/ 双方/ 协商/ 出/ 了/ 一个/ 共同/ 的/ 会/ 话/ 密钥/ ./ 一个/ 已/ 完成/ 会话/ (/ I/ ,/ SA/ ,/ SB/ ,/ m1/ ,/ …/ ,/ mn/ )/ 的/ 匹配/ 会话/ 是/ 与其/ 具有/ 相同/ 的/ 通信/ 消息/ 且/ 标识/ id/ 为/ (/ R/ ,/ SB/ ,/ SA/ ,/ m1/ ,/ …/ ,/ mn/ )/ 的/ 会/ 话/ ;/ 反之亦然/ ./ 攻击者/ 模型/ ./ 攻击者/ / 被/ 模拟/ 为/ 一个/ 概率/ 多项式/ 时间/ 的/ 图灵机/ ,/ 且/ 可以/ 通过/ 执行/ 以下/ 询问/ 来/ 控制协议/ 实体/ 之间/ 的/ 通信/ :/ (/ 1/ )/ Send/ (/ m/ )/ ./ 攻击者/ 通过/ 发送/ 如下/ 形式/ 的/ 消息/ 激活/ 会话/ :/ (/ I/ ,/ SA/ ,/ SB/ ,/ m1/ ,/ …/ ,/ mk/ )/ 或者/ (/ R/ ,/ SB/ ,/ SA/ ,/ m1/ ,/ …/ ,/ mk/ +/ 1/ )/ ,/ 并/ 得到/ 相应/ 的/ 输出/ 消息/ ./ (/ 2/ )/ KeyReveal/ (/ sid/ )/ ./ 若会话/ sid/ 已/ 完成/ ,/ 则/ 返回/ 攻击者/ 会话/ 密钥/ ;/ 否则/ 返回/ 终止/ 符号/ ⊥/ ./ (/ 3/ )/ StateReveal/ (/ sid/ )/ ./ 若会话/ sid/ 未/ 完成/ ,/ 则/ 返回/ 攻击者/ 该会/ 话/ 的/ 内部/ 状态/ ,/ 包括/ 选取/ 的/ 随机数/ 以及/ 中间/ 的/ 计算结果/ ,/ 但是/ 不/ 包括/ 该会/ 话/ 的/ 私钥/ ;/ 若会话/ sid/ 已/ 完成/ ,/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ Page4/ (/ 4/ )/ Corrupt/ (/ U/ ,/ SU/ )/ ./ 该/ 询问/ 允许/ 攻击者/ 获取/ 实体/ U/ 的/ 属性/ 集/ SU/ 所/ 对应/ 的/ 私钥/ ,/ 并/ 能/ 完全/ 控制/ 该/ 实体/ 的/ 行为/ ./ 若/ 攻击者/ 对/ 实体/ U/ 执行/ 了/ 该/ 询问/ ,/ 则/ 称/ 实体/ U/ 为/ 不诚实/ 的/ ,/ 否则/ 称其为/ 诚实/ 的/ ./ 定义/ 7/ (/ 新鲜/ 性/ )/ ./ 令/ sid/ / =/ (/ I/ ,/ SA/ ,/ SB/ ,/ m1/ ,/ …/ ,/ mn/ )/ 或者/ (/ R/ ,/ SB/ ,/ SA/ ,/ m1/ ,/ …/ ,/ mn/ )/ 是/ 诚实/ 实体/ A/ 和/ B/ 之间/ 的/ 已/ 完成/ 会话/ ,/ 同时/ 标记/ sid/ / 为/ sid/ / 的/ 匹配/ 会话/ (/ 若/ sid/ / 存在/ )/ ./ 若/ 下面/ 的/ 条件/ 都/ 不/ 成立/ ,/ 则/ 称会话/ sid/ / 是/ 新鲜/ 的/ :/ (/ 1/ )/ 攻击者/ 执行/ 了/ 询问/ KeyReveal/ (/ sid/ / )/ ,/ 或者/ 在/ sid/ / 存在/ 的/ 情况/ 下/ 执行/ 了/ 询问/ KeyReveal/ (/ sid/ / )/ ./ (/ 2/ )/ sid/ / 存在/ ,/ 攻击者/ 执行/ 了/ StateReveal/ (/ sid/ / )/ 或者/ StateReveal/ (/ sid/ / )/ ./ (/ 3/ )/ sid/ / 不/ 存在/ ,/ 攻击者/ 执行/ 了/ StateReveal/ (/ sid/ / )/ ./ 安全性/ 游戏/ ./ 初始/ 时刻/ ,/ 攻击者/ / 得到/ 一个/ 诚实/ 协议/ 实体/ 集合/ ,/ 并/ 按照/ 任何/ 顺序/ 执行/ 上述/ 询问/ ./ 在/ 游戏/ 过程/ 中/ ,/ 攻击者/ 执行/ 以下/ 询问/ :/ Test/ (/ sid/ / )/ :/ 其中/ sid/ / 是/ 一个/ 新鲜/ 会话/ ./ 通过/ 公平/ 的/ 掷/ 币/ 协议/ 选择/ b/ ∈/ {/ 0/ ,/ 1/ }/ ,/ 若/ b/ =/ 0/ ,/ 则/ 返回/ 攻击者/ 会话/ sid/ / 的/ 会/ 话/ 密钥/ ;/ 否则/ 返回/ 一个/ 在/ 密钥/ 空间/ 里/ 随机/ 选择/ 的/ 串/ ./ 游戏/ 继续/ 进行/ ,/ 直到/ 攻击者/ / 输出/ 一个/ 对/ b/ 的/ 猜测/ b/ ,/ 若/ b/ =/ b/ 且会话/ sid/ / 仍然/ 是/ 新鲜/ 的/ ,/ 则/ 称/ 攻击者/ 赢得/ 了/ 该/ 攻击/ 游戏/ ,/ 定义/ 攻击者/ / 在/ 上述/ 游戏/ 中/ 的/ 优势/ 为/ 定义/ 8/ (/ ABCK/ +/ 安全性/ )/ ./ 一个/ ABAKA/ 协议/ Π/ 在/ ABCK/ +/ 模型/ 下/ 是/ 安全/ 的/ ,/ 是/ 指/ 下面/ 的/ 条件/ 同时/ 成立/ :/ (/ 1/ )/ 若/ 两个/ 诚实/ 的/ 协议/ 实体/ A/ 和/ B/ 完成/ 了/ 匹配/ 会话/ 且/ 双方/ 属性/ 均/ 满足/ 对方/ 指定/ 的/ 访问/ 结构/ 即/ SA/ ∈/ AAB/ 且/ SB/ ∈/ AAA/ ,/ 则/ 除了/ 一个/ 可/ 忽略/ 概率/ ,/ 协议/ 双方/ 计算/ 出/ 相同/ 的/ 会/ 话/ 密钥/ ./ (/ 2/ )/ 对/ 任何/ 一个/ 概率/ 多项式/ 时间/ 的/ 攻击者/ / ,/ Π/ (/ / )/ 在/ 下列/ 情况/ 下/ 是/ 可/ 忽略/ 的/ :/ ①/ 若/ sid/ / 不/ 存在/ 且/ 攻击者/ 获得/ sid/ / 的/ 私钥/ ./ ②/ 若/ sid/ / 不/ 存在/ 且/ 攻击者/ 获得/ sid/ / 的/ 临时/ 密钥/ ./ ③/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 和/ sid/ / 的/ ④/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 和/ sid/ / 的/ ⑤/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 的/ 私钥/ 临时/ 密钥/ ./ 和/ sid/ / 的/ 临时/ 密钥/ ./ AdvABAKA/ 私钥/ ./ ⑥/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 的/ 临时/ 密钥/ 和/ sid/ / 的/ 私钥/ ./ 其中/ ,/ 条件/ ③/ 能够/ 证明/ 协议/ 满足/ wPFS/ ,/ 条件/ ①/ 、/ ⑤/ 、/ ⑥/ 能够/ 证明/ 协议/ 抵抗/ KCI/ 攻击/ ,/ 条件/ ②/ 、/ ④/ 能够/ 证明/ 协议/ 抵抗/ LEK/ 攻击/ ./ 而/ ABAKA/ 协议/ Π/ 在/ ABCK/ +/ 模型/ 下/ 是/ 选择/ 安全/ 的/ ,/ 是/ 指/ 攻击者/ / 在/ 安全/ 游戏/ 初始/ 阶段/ 预先选择/ 要/ 挑战/ 的/ sid/ / 对应/ 的/ 访问/ 结构/ 和/ sid/ / 对应/ 的/ 访问/ 结构/ (/ 若/ sid/ / 存在/ )/ ./ 4/ 协议/ 构造/ 4.1/ 基本/ 思想/ 本文/ 协议/ 借鉴/ 了/ Lai/ 等/ 人/ [/ 19/ ]/ 的/ 简洁/ 高效/ 的/ 转化/ 方法/ 将/ Waters/ [/ 4/ ]/ 的/ CPA/ 安全/ 的/ 基于/ 属性/ 加密/ 方案/ 转化/ 为/ CCA/ 安全/ 的/ 密钥/ 封装/ 方案/ ,/ 该/ 方法/ 在/ 系统/ 公共/ 参数/ 中/ 增加/ 了/ 3/ 个群/ 元素/ δ/ 1/ 、/ δ/ 2/ 、/ δ/ 3/ ,/ 在/ 密文/ 中/ 使用/ 上述/ 群/ 元素/ 生成/ 一个/ 冗余/ 信息/ ,/ 从而/ 使得/ 模拟/ 者/ 在/ 回答/ 攻击者/ 的/ 解密/ 询问/ 时/ 能够/ 使用/ 该/ 冗余/ 信息/ 进行/ 解密/ ./ 本文/ 协议/ 采用/ 了/ Okamoto/ [/ 18/ ]/ 的/ twisted/ -/ PRF/ 技巧/ ,/ 该/ 方法/ 与/ NAXOS/ 技巧/ 相似/ ,/ 由/ 用户/ 长期/ 私钥/ 和/ 临时/ 密钥/ 共同/ 计算/ 出/ 密钥/ 封装/ 方案/ 的/ 随机数/ ,/ 然而/ 该/ 方法/ 使用/ 了/ 两个/ 伪/ 随机/ 函数/ 代替/ NAXOS/ 技巧/ 中/ 的/ 杂凑/ 函数/ ,/ 以/ 保证/ 协议/ 既/ 能/ 抵抗/ LEK/ 攻击/ ,/ 又/ 能够/ 在/ 标准/ 模型/ 下可证/ 安全/ ./ Fujioka/ 等/ 人/ [/ 17/ ]/ 的/ 通用/ 构造/ 方案/ 额外/ 使用/ 了/ 一个/ CPA/ 安全/ 的/ 密钥/ 封装/ 方案/ 以/ 保证/ 协议/ 满足/ wPFS/ ,/ 协议/ 发起方/ 计算/ 一个/ 临时/ 公钥/ ,/ 然后/ 协议/ 接收/ 方/ 使用/ 该公钥/ 计算/ 出/ 密钥/ 封装/ 方案/ 的/ 密文/ 并/ 返回/ 给/ 发起方/ ,/ 因此/ 该/ 协议/ 需要/ 运行/ 两轮/ ./ 本文/ 在/ 协议/ 中/ 增加/ 了/ 一次/ 临时/ 的/ Diffie/ -/ Hellman/ 交换/ ,/ 在/ 安全性/ 证明/ 时/ 将/ 困难/ 问题/ 嵌入/ 到/ 上述/ 交换/ 中/ ,/ 从而/ 能够/ 证明/ 协议/ 满足/ wPFS/ ,/ 且/ 该/ 协议/ 只/ 需/ 运行/ 一轮/ ./ 4.2/ 具体/ 实现/ 系统/ 建立/ ./ 选择/ 阶为/ 大/ 素数/ p/ 的/ 群/ G/ 、/ GT/ ,/ 记/ g/ 为/ G/ 的/ 一个/ 生成元/ ,/ e/ :/ G/ ×/ G/ →/ GT/ 是/ 双线性/ 映射/ ./ 系统/ 选择/ 一个/ 抗/ 碰撞/ 杂凑/ 函数/ H/ :/ {/ 0/ ,/ 1/ }/ / →/ / p/ ,/ 一个/ 强/ 随机/ 提取/ 器/ Ext/ (/ s/ ,/ ·/ )/ ,/ 其中/ s/ 是/ 在/ 种子/ 空间/ 随机/ 选择/ 的/ 种子/ ./ 同时/ 选择/ 以下/ 3/ 个/ 伪/ 随机/ 函数/ :/ 其中/ Kspace/ 是/ 伪/ 随机/ 函数/ 的/ 密钥/ 空间/ ./ 令/ 系统/ 中/ 属性/ 个数/ 为/ m/ ,/ 随机/ 选择/ α/ ,/ β/ ∈/ / p/ ,/ 令/ w/ =/ g/ β/ ./ 随机/ 选择/ h1/ ,/ …/ ,/ hm/ ,/ δ/ 1/ ,/ δ/ 2/ ,/ δ/ 3/ ∈/ G/ ,/ 则/ 系统/ 的/ 主/ 密钥/ 为/ MSK/ =/ α/ ,/ 公开/ 参数/ 为/ Page5PK/ =/ (/ e/ (/ g/ ,/ g/ )/ α/ ,/ h1/ …/ hm/ ,/ w/ ,/ δ/ 1/ ,/ δ/ 2/ ,/ δ/ 3/ )/ ./ 用户/ 私钥/ 抽取/ ./ 该/ 过程/ 为/ 属性/ 集合/ 为/ SU/ 的/ 用户/ U/ 产生/ 私钥/ ./ 系统/ 随机/ 选择/ r/ ∈/ / p/ ,/ 对/ 任意/ / x/ ∈/ SU/ ,/ 计算/ KUx/ ,/ 3/ =/ hrx/ ,/ 并/ 计算/ KU/ ,/ 1/ =/ g/ α/ g/ β/ r/ ,/ KU/ ,/ 2/ =/ gr/ ,/ 同时/ 在/ 伪/ 随机/ 函数/ 的/ 密钥/ 空间/ 中/ 随机/ 选择/ 密钥/ σ/ U/ ∈/ Kspace/ ./ 最终/ 计算/ 用户/ 私钥/ :/ SKU/ =/ (/ KU/ ,/ 1/ ,/ KU/ ,/ 2/ ,/ {/ KUx/ ,/ 3/ }/ x/ ∈/ SU/ ,/ σ/ U/ )/ ./ 密钥/ 交换/ ./ 假设/ 协议/ 的/ 参与方/ 为/ A/ 和/ B/ ,/ 其中/ A/ 的/ 属性/ 集合/ 为/ SA/ ,/ 私钥/ 为/ SKA/ ,/ B/ 的/ 属性/ 集合/ 为/ SB/ ,/ 私钥/ 为/ SKB/ ./ A/ 和/ B/ 分别/ 指定/ 访问/ 结构/ AAA/ 和/ AAB/ ,/ 并/ 分别/ 发送/ 消息/ memA/ 和/ memB/ 给/ 对方/ ,/ 若/ 双方/ 属性/ 均/ 满足/ 对方/ 指定/ 的/ 访问/ 结构/ 即/ SA/ ∈/ AAB/ ,/ SB/ ∈/ AAA/ ,/ 则/ A/ 和/ B/ 都/ 能/ 计算/ 出/ 共同/ 的/ 会/ 话/ 密钥/ KAB/ ,/ 具体/ 过程/ 如下/ :/ (/ 1/ )/ A/ 指定/ 对方/ 需要/ 满足/ 的/ 访问/ 结构/ AAA/ ,/ 其/ 对应/ 的/ 访问控制/ 矩阵/ 为/ (/ (/ 犕/ A/ )/ lA/ ×/ nA/ ,/ ρ/ A/ )/ ./ A/ 随机/ 选取/ 向量/ 狊/ A/ =/ (/ xA/ ,/ sA/ ,/ 2/ ,/ …/ ,/ sA/ ,/ nA/ )/ T/ ∈/ / 狊/ A/ =/ (/ xA/ ,/ sA/ ,/ 2/ ,/ …/ ,/ sA/ ,/ nA/ )/ T/ ,/ 其中/ xA/ =/ F/ σ/ A/ (/ xA/ )/ / FxA/ (/ σ/ A/ )/ ,/ 对/ / i/ ∈/ {/ 2/ ,/ …/ ,/ nA/ }/ 计算/ sA/ ,/ i/ =/ F/ σ/ A/ (/ sA/ ,/ i/ )/ / FsA/ ,/ i/ (/ σ/ A/ )/ ./ A/ 随机/ 选取/ dA/ ,/ yA/ ,/ tA/ ,/ 1/ ,/ tA/ ,/ 2/ ,/ …/ ,/ tA/ ,/ lA/ ∈/ / p/ ,/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ lA/ }/ 计算/ tA/ ,/ i/ =/ F/ σ/ A/ (/ tA/ ,/ i/ )/ / FtA/ ,/ i/ (/ σ/ A/ )/ ./ 然后/ A/ 计算/ 分享/ 向量/ (/ λ/ A/ ,/ 1/ ,/ λ/ A/ ,/ 2/ ,/ …/ ,/ λ/ A/ ,/ lA/ )/ T/ =/ 犕/ A/ 狊/ A/ ,/ 并/ 计算/ CA/ ,/ 1/ =/ gxA/ ,/ CA/ ,/ 2/ =/ gyA/ ,/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ lA/ }/ ,/ 计算/ CAi/ ,/ 1/ =/ g/ β/ λ/ A/ ,/ ih/ -/ tA/ ,/ igtA/ ,/ i/ ,/ 最后/ A/ 计算/ CA/ ,/ 3/ =/ (/ δ/ cA1/ δ/ dAcA/ =/ H/ (/ 犕/ A/ ,/ CA/ ,/ 1/ ,/ CA/ ,/ 2/ ,/ {/ CAi/ ,/ 1/ ,/ CAi/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ lA/ }/ )/ ./ A/ 发送给/ B/ 消息/ 为/ (/ 2/ )/ B/ 指定/ 对方/ 需要/ 满足/ 的/ 访问/ 结构/ AAB/ ,/ 其/ 对应/ 的/ 访问控制/ 矩阵/ 为/ (/ (/ 犕/ B/ )/ lB/ ×/ nB/ ,/ ρ/ B/ )/ ./ B/ 随机/ 选取/ 向量/ 狊/ B/ =/ (/ xB/ ,/ sB/ ,/ 2/ ,/ …/ ,/ sB/ ,/ nB/ )/ T/ ∈/ / 狊/ 犅/ =/ (/ xB/ ,/ sB/ ,/ 2/ ,/ …/ ,/ sB/ ,/ nB/ )/ T/ ,/ 其中/ xB/ =/ F/ σ/ B/ (/ xB/ )/ / FxB/ (/ σ/ B/ )/ ,/ 对/ / i/ ∈/ {/ 2/ ,/ …/ ,/ nB/ }/ 计算/ sB/ ,/ i/ =/ F/ σ/ B/ (/ sB/ ,/ i/ )/ / FsB/ ,/ i/ (/ σ/ B/ )/ ./ B/ 随机/ 选取/ dB/ ,/ yB/ ,/ tB/ ,/ 1/ ,/ tB/ ,/ 2/ ,/ …/ ,/ tB/ ,/ lB/ ∈/ / p/ ,/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ lB/ }/ 计算/ tB/ ,/ i/ =/ F/ σ/ B/ (/ tB/ ,/ i/ )/ / FtB/ ,/ i/ (/ σ/ B/ )/ ./ 然后/ B/ 计算/ 分享/ 向量/ (/ λ/ B/ ,/ 1/ ,/ λ/ B/ ,/ 2/ ,/ …/ ,/ λ/ B/ ,/ lB/ )/ T/ =/ 犕/ B/ 狊/ B/ ,/ 并/ 计算/ CB/ ,/ 1/ =/ gxB/ ,/ CB/ ,/ 2/ =/ gyB/ ,/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ lB/ }/ ,/ 计算/ CBi/ ,/ 1/ =/ g/ β/ λ/ B/ ,/ ih/ -/ tB/ ,/ igtB/ ,/ i/ ,/ 最后/ B/ 计算/ CB/ ,/ 3/ =/ (/ δ/ cB1/ δ/ dB2/ δ/ 3/ )/ xB/ ,/ 其中/ B/ 发送给/ A/ 消息/ 为/ cB/ =/ H/ (/ 犕/ B/ ,/ CB/ ,/ 1/ ,/ CB/ ,/ 2/ ,/ {/ CBi/ ,/ 1/ ,/ CBi/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ lB/ }/ )/ ./ (/ 3/ )/ A/ 获取/ 消息/ memB/ 后/ ,/ 假定/ A/ 的/ 属性/ 满足/ B/ 指定/ 的/ 访问/ 结构/ ,/ 即/ SA/ ∈/ AAB/ ,/ 令/ IA/ =/ {/ i/ :/ ρ/ B/ (/ i/ )/ ∈/ SA/ }/ 为/ 授权/ 的/ 属性/ 集合/ ,/ 因此/ A/ 可以/ 得到/ 恢复系数/ {/ μ/ A/ ,/ i/ ∈/ / p/ }/ i/ ∈/ IA/ 使/ ∑/ i/ ∈/ IAe/ (/ g/ ,/ CB/ ,/ 3/ )/ =/ e/ (/ CB/ ,/ 1/ ,/ δ/ cB1/ δ/ dB2/ δ/ 3/ )/ 是否/ 成立/ ,/ 其中/ cB/ =/ H/ (/ 犕/ B/ ,/ CB/ ,/ 1/ ,/ CB/ ,/ 2/ ,/ {/ CBi/ ,/ 1/ ,/ CBi/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ lB/ }/ )/ ,/ 若/ 上式/ 不/ 成立/ ,/ 则/ 返回/ ⊥/ ;/ 否则/ A/ 计算/ :/ θ/ 1/ =/ e/ (/ g/ ,/ g/ )/ α/ xA/ ,/ θ/ 2/ =/ ∏/ i/ ∈/ IA/ ,/ x/ =/ ρ/ B/ (/ i/ )/ =/ e/ (/ g/ α/ g/ β/ r/ ,/ gxB/ )/ ∏/ i/ ∈/ IA/ =/ e/ (/ g/ ,/ g/ )/ α/ xB/ ,/ θ/ 3/ =/ e/ (/ CB/ ,/ 2/ ,/ w/ )/ yA/ =/ e/ (/ g/ ,/ w/ )/ yAyB/ ./ 同理/ ,/ B/ 获取/ 消息/ memA/ 后/ ,/ 假定/ B/ 的/ 属性/ 满足/ A/ 指定/ 的/ 访问/ 结构/ 即/ SB/ ∈/ AAA/ ,/ 令/ IB/ =/ {/ i/ :/ ρ/ A/ (/ i/ )/ ∈/ SB/ }/ 为/ 授权/ 属性/ 集合/ ,/ 因此/ B/ 可以/ 得到/ 恢复系数/ {/ μ/ B/ ,/ i/ ∈/ / p/ }/ i/ ∈/ IB/ 使/ ∑/ i/ ∈/ IBe/ (/ g/ ,/ CA/ ,/ 3/ )/ =/ e/ (/ CA/ ,/ 1/ ,/ δ/ cAH/ (/ 犕/ A/ ,/ CA/ ,/ 1/ ,/ CA/ ,/ 2/ ,/ {/ CAi/ ,/ 1/ ,/ CAi/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ lA/ }/ )/ 若/ 上式/ 不/ 成立/ ,/ 则/ 返回/ ⊥/ ;/ 否则/ B/ 计算/ :/ θ/ 1/ =/ ∏/ i/ ∈/ IB/ ,/ x/ =/ ρ/ A/ (/ i/ )/ =/ e/ (/ g/ α/ g/ β/ r/ ,/ gxA/ )/ ∏/ i/ ∈/ IB/ =/ e/ (/ g/ ,/ g/ )/ α/ xA/ ,/ θ/ 2/ =/ e/ (/ g/ ,/ g/ )/ α/ xB/ ,/ θ/ 3/ =/ e/ (/ CA/ ,/ 2/ ,/ w/ )/ yB/ =/ e/ (/ g/ ,/ w/ )/ yAyB/ ./ A/ 和/ B/ 计算/ 出/ 相同/ 的/ θ/ 1/ 、/ θ/ 2/ 、/ θ/ 3/ 后/ ,/ 通过/ 随机/ 提取/ 器/ 计算/ :/ θ/ 1/ =/ Ext/ (/ s/ ,/ θ/ 1/ )/ ,/ θ/ 2/ =/ Ext/ (/ s/ ,/ θ/ 2/ )/ ,/ θ/ 3/ =/ Ext/ (/ s/ ,/ θ/ 3/ )/ 令会话/ id/ 为/ sid/ =/ (/ memA/ ,/ memB/ )/ ,/ 最后/ 双方/ 计算/ 共同/ 的/ 会/ 话/ 密钥/ 为/ KAB/ =/ G/ θ/ 1/ (/ sid/ )/ / G/ θ/ 2/ (/ sid/ )/ / G/ θ/ 3/ (/ sid/ )/ ./ 5/ 协议/ 安全性/ 与/ 性能/ 分析/ 5.1/ 安全性/ 证明/ 定理/ 1/ ./ 若/ 定义/ 4/ 中/ 的/ DPBDHE/ 假设/ 成立/ ,/ 且/ F/ ,/ F/ ,/ G/ 是/ 伪/ 随机/ 函数/ ,/ Ext/ (/ s/ ,/ ·/ )/ 是/ 一个/ 强/ 随机/ Page6/ 提取/ 器/ ,/ 则/ 上述/ 协议/ 在/ ABCK/ +/ 模型/ 中是/ 安全/ 的/ ./ 证明/ ./ 在/ ABCK/ +/ 模型/ 定义/ 的/ 安全/ 游戏/ 中/ ,/ 假设/ 攻击者/ / 至多/ 激活/ N/ 个/ 协议/ 实体/ ,/ 每个/ 实体/ 至多/ 激活/ L/ 个会话/ ,/ 令/ sid/ / 表示/ Test/ 阶段/ 攻击者/ 要/ 挑战/ 的/ 测试/ 会话/ ,/ 实体/ A/ 为/ 该会/ 话/ 的/ 拥有者/ ,/ 实体/ B/ 为/ 其/ 匹配/ 会话/ sid/ / 的/ 拥有者/ ,/ Suc/ 表示/ 攻击者/ / 赢得/ 该游戏/ ,/ 则/ 以下/ 6/ 种/ 情况/ 覆盖/ 了/ 攻击者/ 的/ 所有/ 行为/ :/ (/ 1/ )/ 情况/ E1/ :/ 若/ sid/ / 不/ 存在/ 且/ 攻击者/ 获得/ sid/ / 的/ 私钥/ ./ (/ 2/ )/ 情况/ E2/ :/ 若/ sid/ / 不/ 存在/ 且/ 攻击者/ 获得/ sid/ / 的/ 临时/ 密钥/ ./ (/ 3/ )/ 情况/ E3/ :/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 和/ sid/ / 的/ 私钥/ ./ (/ 4/ )/ 情况/ E4/ :/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 和/ sid/ / 的/ 临时/ 密钥/ ./ (/ 5/ )/ 情况/ E5/ :/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 的/ 私钥/ 和/ sid/ / 的/ 临时/ 密钥/ (/ 6/ )/ 情况/ E6/ :/ 若/ sid/ / 存在/ 且/ 攻击者/ 同时/ 获得/ sid/ / 的/ 临时/ 密钥/ 和/ sid/ / 的/ 私钥/ ./ 其中/ ,/ 情况/ (/ 3/ )/ 能够/ 证明/ 协议/ 满足/ wPFS/ ,/ (/ 1/ )/ 、/ (/ 5/ )/ 、/ (/ 6/ )/ 能够/ 证明/ 协议/ 抵抗/ KCI/ 攻击/ ,/ (/ 2/ )/ 、/ (/ 4/ )/ 能够/ 证明/ 协议/ 抵抗/ LEK/ 攻击/ ./ 以下/ 分别/ 证明/ 协议/ 在/ 各种/ 情况/ 下/ 的/ 安全性/ :/ Game0/ ./ 该游戏/ 与/ 实际/ 的/ 安全性/ 游戏/ 一致/ ,/ 因/ (/ 1/ )/ Pr/ [/ E1/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ 我们/ 使用/ 一系列/ 攻击/ 游戏/ 证明/ 攻击者/ 在/ 这种/ 情况/ 下/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 令/ AdvABAKA/ 者/ / 在/ 游戏/ k/ 中/ 的/ 攻击/ 优势/ ./ 此/ 攻击者/ / 的/ 优势/ AdvABAKA/ 际/ 协议/ 的/ 优势/ ./ Game1/ ./ 该游戏/ 与/ Game0/ 的/ 区别/ 在于/ ,/ 若/ 两个/ 不同/ 的/ 会/ 话/ 拥有/ 相同/ 的/ 会/ 话/ id/ ,/ 即/ 两个/ 不同/ 会话/ 的/ 协议/ 双方/ 以及/ 协议/ 双方/ 产生/ 的/ 消息/ 完全相同/ ,/ 则/ 游戏/ 终止/ ./ 这种/ 情况/ 发生/ 的/ 概率/ 相当于/ 随机/ 选择/ 两个/ 随机数/ 发生/ 碰撞/ 的/ 概率/ ,/ 因此/ 使用/ 下/ 式/ 表示/ 攻击者/ 在/ Game1/ 和/ Game0/ 中/ 的/ 优势/ 是/ 等价/ 的/ ,/ 即/ 两者/ 差异/ 是/ 可/ 忽略/ 的/ (/ negl/ )/ Game2/ ./ 该游戏/ 与/ Game1/ 的/ 区别/ 在于/ ,/ 游戏/ 开始/ 选择/ 协议/ 通信/ 方/ A/ ,/ 并/ 随机/ 选择/ 一个/ 整数/ i/ ∈/ [/ 1/ ,/ L/ ]/ ,/ 若/ 攻击者/ / 选择/ 的/ 测试/ 会话/ 是/ 通信/ 方/ A/ 进行/ 的/ 第/ i/ 次会/ 话/ 则/ 游戏/ 继续/ ,/ 否则/ 游戏/ 终止/ ./ 由于/ 攻击者/ 选择/ 的/ 测试/ 会话/ 满足/ 上述/ 条件/ 的/ 概率/ 为/ 1/ 因此/ AdvABAKAGame3/ ./ 在/ 该游戏/ 中/ ,/ 使用/ 一个/ 真/ 随机/ 函数/ RF/ (/ ·/ )/ 代替/ 测试/ 会话/ 中/ 的/ 伪/ 随机/ 函数/ F/ ,/ 除此以外/ ,/ Game3/ 和/ Game2/ 相同/ ./ 若/ AdvABAKA/ / (/ 2/ )/ 是/ 不可/ 忽略/ 的/ ,/ 则/ 可以/ 构造/ 一个多项/ AdvABAKA/ 式/ 时间/ 的/ 区分/ 者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 伪/ 随机/ 函数/ F/ 和/ 真/ 随机/ 函数/ RF/ ./ / 按照/ 下述/ 步骤/ 模拟/ 安全性/ 游戏/ :/ Setup/ ./ / 设置/ 系统/ 主/ 密钥/ 以及/ 所有/ 用户/ 的/ 私钥/ ./ 接下来/ ,/ / 按/ 如下/ 方式/ 生成/ 通信/ 方/ A/ 的/ 第/ i/ 次会/ 话/ 的/ 消息/ mem/ / A/ ./ 令/ A/ 指定/ 对方/ 需要/ 满足/ 的/ 访问/ 结构/ 为/ AA/ / A/ ,/ 其/ 对应/ 的/ 访问控制/ 矩阵/ 为/ (/ (/ 犕/ / A/ )/ l/ / ρ/ / A/ )/ ./ / 随机/ 选取/ 向量/ 狊/ / A/ =/ (/ x/ / A/ ,/ s/ / A/ ,/ 2/ ,/ …/ ,/ s/ / p/ ,/ 并/ 计算/ 向量/ 狊/ / A/ =/ (/ x/ / A/ ,/ s/ / A/ ,/ 2/ ,/ …/ ,/ s/ / A/ ,/ n/ / n/ / A/ 中/ x/ / A/ =/ F/ σ/ A/ (/ x/ / A/ )/ / F/ / (/ σ/ A/ )/ ,/ 对/ / i/ ∈/ {/ 2/ ,/ …/ ,/ n/ / A/ }/ 计算/ s/ / A/ ,/ i/ =/ F/ σ/ A/ (/ s/ / A/ ,/ i/ )/ / F/ / (/ σ/ A/ )/ ./ 随机/ 选取/ d/ / A/ ,/ y/ / A/ ,/ t/ / A/ ,/ 1/ ,/ t/ / A/ ,/ 2/ ,/ …/ ,/ t/ / F/ σ/ A/ (/ t/ / A/ ,/ i/ )/ / F/ / (/ σ/ A/ )/ ./ 然后/ 计算/ 分享/ 向量/ (/ λ/ / A/ ,/ 1/ ,/ λ/ / A/ ,/ 2/ ,/ …/ ,/ λ/ / A/ ,/ l/ / gy/ / C/ / Ai/ ,/ 2/ =/ gt/ / c/ / A/ =/ H/ (/ 犕/ / A/ ,/ C/ / A/ ,/ 1/ ,/ C/ / A/ ,/ 2/ ,/ {/ C/ / Ai/ ,/ 1/ ,/ C/ / Ai/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / / 输出/ A/ 发送给/ B/ 消息/ 为/ A/ ,/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / A/ }/ ,/ 计算/ C/ / Ai/ ,/ 1/ =/ g/ β/ λ/ / / Simulation/ ./ / 用/ 列表/ / 记录/ / 对会话/ 密钥/ 的/ 询问/ KeyReveal/ ,/ 然后/ 按照/ 协议/ 规范/ 和/ 安全性/ 游戏规则/ 进行/ 如下/ 模拟/ :/ ①/ Send/ (/ I/ ,/ SP/ ,/ S/ 珚/ P/ )/ :/ 若/ I/ =/ A/ ,/ 且/ 该会/ 话/ 是/ A/ 的/ 第/ i/ 次会话/ ,/ 则/ / 返回/ 在/ Setup/ 阶段/ 计算/ 的/ mem/ / A/ ,/ 否则/ / 依据/ 协议/ 规范/ 进行/ 响应/ ,/ 并/ 记录/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ )/ ./ ②/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 和/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ 出会话/ 密钥/ K/ 并/ 返回/ ,/ 将会话/ 密钥/ K/ 加入/ 列表/ / ,/ 并/ 记录/ 所有/ 的/ 会/ 话/ 状态/ ,/ 标记/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ ,/ mem/ 珚/ P/ )/ 为/ 已/ 完成/ 会话/ ./ ③/ KeyReveal/ (/ sid/ )/ :/ 若会话/ sid/ 已/ 完成/ 则/ 返回/ 其/ 在/ 列表/ / 中/ 对应/ 的/ 会/ 话/ 密钥/ K/ ,/ 若会/ 话/ 未/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ④/ StateReveal/ (/ sid/ )/ :/ 若会话/ sid/ 未/ 完成/ 则/ 返回/ 记录/ 的/ 该会/ 话/ 的/ 所有/ 内部/ 状态/ 信息/ ,/ 若会/ 话/ 已/ 完成/ Page7/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ 用户/ 私钥/ SKU/ ./ 钥/ K/ / 并/ 返回/ 给/ 攻击者/ / ./ ⑤/ Corrupt/ (/ U/ ,/ SU/ )/ :/ / 返回/ Setup/ 阶段/ 生成/ 的/ ⑥/ Test/ (/ sid/ / )/ :/ / 依据/ 协议/ 规范/ 计算/ 出会/ 话/ 密/ ⑦/ 如果/ / 输出/ 猜测/ b/ =/ 0/ ,/ 则/ / 输出/ F/ / 为/ 伪/ 随若/ F/ / =/ F/ ,/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game2/ 相同/ ;/ 若/ F/ / =/ RF/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game3/ 相同/ ./ 若/ AdvABAKA/ 的/ ,/ 则/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ 伪/ 随机/ 函数/ F/ 和/ 真/ 随机/ 函数/ RF/ ./ 因此/ 机/ 函数/ F/ ,/ 否则/ / 输出/ F/ / 为/ 真/ 随机/ 函数/ RF/ ./ Game4/ ./ 在/ 该游戏/ 中/ ,/ 随机/ 选择/ θ/ / 1/ ∈/ GT/ 代替/ 测试/ 会话/ 中/ 计算/ 的/ θ/ / 1/ =/ e/ (/ g/ ,/ g/ )/ α/ x/ / 和/ Game3/ 相同/ ./ 若/ AdvABAKA/ 是/ 不可/ 忽略/ 的/ ,/ 则/ 可以/ 构造/ 一个/ 多项式/ 时间/ 的/ 挑战者/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 解决/ 定义/ 4/ 中/ 的/ 困难/ 问题/ ./ 假定/ 测试/ 会话/ 中/ 通信/ 方/ A/ 的/ 意定/ 通信/ 伙伴/ 为/ B/ ,/ / 按照/ 下述/ 步骤/ 模拟/ 安全性/ 游戏/ :/ Init/ ./ / 运行/ 攻击者/ / ,/ / 输出/ 测试/ 会话/ 中要/ 挑战/ 的/ 访问/ 结构/ AA/ / 阵为/ (/ (/ 犕/ / A/ )/ l/ / Setup/ ./ 首先/ ,/ / 生成/ 系统/ 公开/ 参数/ ./ / 随机/ 选择/ α/ ,/ z1/ ,/ z2/ ,/ …/ ,/ zm/ ∈/ / p/ 并/ 隐含/ 设置/ 主/ 密钥/ α/ =/ α/ +/ aq/ +/ 1/ ,/ 则/ 可以/ 计算/ e/ (/ g/ ,/ g/ )/ α/ =/ e/ (/ ga/ ,/ gaq/ )/ e/ (/ g/ ,/ g/ )/ α/ ./ 令/ w/ =/ ga/ ,/ 对/ 任意/ 的/ 1/ / j/ / m/ ,/ 令/ 集合/ I/ 表示/ 所有/ ρ/ / A/ (/ i/ )/ =/ j/ 的/ 集合/ ,/ 若/ I/ =/ / ,/ 则/ 令/ hj/ =/ gzj/ ;/ 若/ I/ ≠/ / ,/ 则/ 令/ hj/ =/ gzj/ ∏/ i/ ∈/ I/ / 随机/ 选择/ d2/ ,/ d3/ ,/ e1/ ,/ e2/ ,/ e3/ ∈/ / p/ ,/ 并/ 计算/ 其它/ 公开/ 参数/ :/ / 输出/ 系统/ 的/ 公开/ 参数/ :/ δ/ 1/ =/ gaqge1/ ,/ δ/ 2/ =/ gaqd2ge2/ ,/ δ/ 3/ =/ gaqd3ge3/ ./ PK/ =/ (/ e/ (/ g/ ,/ g/ )/ α/ ,/ h1/ …/ hm/ ,/ w/ ,/ δ/ 1/ ,/ δ/ 2/ ,/ δ/ 3/ )/ ./ 接下来/ ,/ / 为/ 属性/ 集合/ 为/ SU/ 的/ 用户/ U/ 产生/ 私钥/ ./ 由/ 定义/ 7/ 中/ 新鲜/ 性/ 的/ 定义/ 知/ ,/ 攻击者/ / 不能/ 对/ 满足/ 访问/ 结构/ AA/ / U/ 的/ 属性/ 集合/ 不能/ 满足/ 访问/ 结构/ AA/ / 则/ 存在/ 一个/ 向量/ ω/ =/ (/ ω/ 1/ ,/ ω/ 2/ ,/ …/ ,/ ω/ n/ / ω/ 1/ =/ -/ 1/ ,/ 对/ ρ/ / A/ (/ i/ )/ ∈/ SU/ ,/ 有/ 犕/ / A/ (/ i/ )/ ·/ ω/ =/ 0/ ./ S/ 在/ 伪/ 随机/ 函数/ 的/ 密钥/ 空间/ 中/ 随机/ 选择/ 密钥/ σ/ U/ ∈/ Kspace/ ,/ 同时/ 随机/ 选择/ r/ ∈/ / p/ ,/ 并令/ r/ =/ r/ +/ ω/ 1aq/ +/ …/ +/ ω/ n/ / Aaq/ +/ 1/ -/ n/ / 以及/ KU/ ,/ 1/ =/ g/ α/ g/ β/ r/ =/ g/ α/ +/ aq/ +/ 1g/ 对/ 任意/ 的/ / x/ ∈/ SU/ ,/ 令/ 集合/ I/ 表示/ 所有/ ρ/ / A/ (/ i/ )/ =/ x/ 集合/ ./ 若/ I/ =/ / ,/ 则/ 可以/ 计算/ KUx/ ,/ 3/ =/ hrx/ =/ (/ KU/ ,/ 2/ )/ zx/ ,/ 若/ I/ ≠/ / ,/ 由于/ 犕/ / A/ (/ i/ )/ ·/ ω/ =/ 0/ ,/ 则/ 可以/ 计算/ :/ KUx/ ,/ 3/ =/ hrx/ =/ (/ gr/ )/ zx/ ∏/ i/ ∈/ I/ ∏/ 1/ / k/ / n/ / =/ (/ KU/ ,/ 2/ )/ zx/ ∏/ i/ ∈/ I/ ∏/ 1/ / k/ / n/ / 因此/ / 能够/ 模拟/ 用户/ 私钥/ :/ A/ 最后/ ,/ / 按/ 如下/ 方式/ 生成/ 通信/ 方/ A/ 的/ 第/ i/ 次会/ 话/ 的/ 消息/ mem/ / A/ ./ S/ 令/ C/ / A/ ,/ 1/ =/ gs/ ,/ 随机/ 选取/ sA/ ,/ 2/ ,/ sA/ ,/ 3/ ,/ …/ ,/ A/ ∈/ / p/ 并/ 隐含/ 设置/ 向量/ 狊/ / A/ =/ (/ s/ ,/ sa/ +/ sA/ ,/ 2/ ,/ …/ ,/ sA/ ,/ n/ / san/ / A/ -/ 1/ +/ sA/ ,/ n/ / 犕/ / A/ 狊/ / A/ 计算/ 分享/ 向量/ 得/ λ/ / A/ ,/ i/ =/ ∑/ 1/ / j/ / n/ / ∑/ 2/ / j/ / n/ / 犕/ / sbi/ ,/ / 计算/ :/ C/ / Ai/ ,/ 1/ =/ ga/ λ/ / =/ ∏/ 1/ / j/ / n/ / (/ ∏/ k/ ∈/ I/ ∏/ 1/ / j/ / n/ / (/ =/ ∏/ 2/ / j/ / n/ / C/ / Ai/ ,/ 2/ =/ gt/ / / 随机/ 选取/ y/ / A/ ∈/ / p/ ,/ 计算/ C/ / A/ ,/ 2/ =/ gy/ / H/ (/ 犕/ / A/ ,/ C/ / A/ ,/ 1/ ,/ C/ / A/ ,/ 2/ ,/ {/ C/ / Ai/ ,/ 1/ ,/ C/ / Ai/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / d/ / A/ =/ -/ (/ c/ / A/ +/ d3/ )/ // d2/ ,/ 从而/ / 可以/ 计算/ :/ C/ / A/ ,/ 3/ =/ (/ δ/ c/ / A/ =/ (/ (/ gaqge1/ )/ c/ / =/ (/ gs/ )/ e1c/ / mem/ / A/ =/ (/ (/ 犕/ / A/ ,/ ρ/ / A/ )/ ,/ C/ / A/ ,/ 1/ ,/ C/ / A/ ,/ 2/ ,/ C/ / A/ ,/ 3/ ,/ / 生成/ 的/ 通信/ 方/ A/ 的/ 消息/ 为/ Page8Simulation/ ./ / 用/ 列表/ / 记录/ / 对会话/ 密钥/ 的/ 询问/ KeyReveal/ ,/ 然后/ 按照/ 协议/ 规范/ 和/ 安全性/ 游戏规则/ 进行/ 如下/ 模拟/ :/ ①/ Send/ (/ I/ ,/ SP/ ,/ S/ 珚/ P/ )/ :/ 若/ I/ =/ A/ ,/ 且/ 该会/ 话/ 是/ A/ 的/ 第/ i/ 次会话/ ,/ 则/ / 返回/ 在/ Setup/ 阶段/ 计算/ 的/ mem/ / A/ ,/ 否则/ / 依据/ 协议/ 规范/ 进行/ 响应/ ,/ 并/ 记录/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ )/ ./ ②/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 和/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 将/ 获取/ 的/ 消息/ memP/ 解析/ 为/ memP/ =/ (/ (/ 犕/ P/ ,/ ρ/ P/ )/ ,/ CP/ ,/ 1/ ,/ CP/ ,/ 2/ ,/ CP/ ,/ 3/ ,/ 假定/ S/ 珚/ P/ 满足/ 访问/ 结构/ (/ 犕/ P/ ,/ ρ/ P/ )/ ,/ 计算/ cP/ =/ H/ (/ 犕/ P/ ,/ CP/ ,/ 1/ ,/ CP/ ,/ 2/ ,/ {/ CPi/ ,/ 1/ ,/ CPi/ ,/ 2/ }/ i/ ∈/ [/ 1/ ,/ …/ ,/ lP/ ]/ )/ ,/ 判断/ e/ (/ g/ ,/ CP/ ,/ 3/ )/ =/ e/ (/ CP/ ,/ 1/ ,/ δ/ cP1/ δ/ dP2/ δ/ 3/ )/ 是否/ 成立/ ,/ 若该/ 式/ 不/ 成立/ 则/ 返回/ 终止/ 符号/ ⊥/ ,/ 否则/ / 判断/ cP/ +/ dPd2/ +/ d3/ =/ 0/ 是否/ 成立/ ,/ 若/ 成立/ 则/ / 模拟/ 失败/ ,/ 否则/ / 计算/ :/ θ/ 1/ =/ e/ (/ g/ ,/ CP/ ,/ 1/ )/ α/ eCP/ ,/ 3/ =/ e/ (/ g/ ,/ g/ )/ α/ xP/ (/ egaqcP/ +/ e1cPgaqd2dP/ +/ e2dPgaqd3/ +/ e3/ (/ ga/ )/ 1/ =/ e/ (/ g/ ,/ g/ )/ (/ α/ +/ aq/ +/ 1/ )/ xP/ ./ / 依据/ 协议/ 规则/ 能够/ 计算/ 出/ θ/ 2/ 、/ θ/ 3/ ,/ 因此/ / 能够/ 计算/ 出会话/ 密钥/ K/ 并/ 返回/ ,/ 并/ 将/ 会/ 话/ 密钥/ K/ 加入/ 列表/ / ,/ 记录/ 所有/ 的/ 会/ 话/ 状态/ ,/ 标记/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ ,/ mem/ 珚/ P/ )/ 为/ 已/ 完成/ 会话/ ./ ③/ KeyReveal/ (/ sid/ )/ :/ 若会话/ sid/ 已/ 完成/ 则/ 返回/ 其/ 在/ 列表/ / 中/ 对应/ 的/ 会/ 话/ 密钥/ K/ ,/ 若会/ 话/ 未/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ④/ StateReveal/ (/ sid/ )/ :/ 若会话/ sid/ 未/ 完成/ 则/ 返回/ 记录/ 的/ 该会/ 话/ 的/ 所有/ 内部/ 状态/ 信息/ ,/ 若会/ 话/ 已/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ 户/ 私钥/ SKU/ ./ ⑤/ Corrupt/ (/ U/ ,/ SU/ )/ :/ / 返回/ Setup/ 阶段/ 生成/ 的/ 用/ ⑥/ Test/ (/ sid/ / )/ :/ / 令/ θ/ / 1/ =/ e/ (/ g/ ,/ gs/ )/ α/ e/ (/ ga/ ,/ gaq/ )/ x/ / θ/ / 2/ 、/ θ/ / 3/ 计算/ 出会话/ 密钥/ K/ / 并/ 返回/ 给/ 攻击者/ / ./ ⑦/ 如果/ / 输出/ 猜测/ b/ ,/ / 输出/ b/ ./ 首先/ 分析/ 挑战者/ / 模拟/ 失败/ 的/ 概率/ ,/ 当/ cP/ +/ dPd2/ +/ d3/ =/ 0/ 时/ / 模拟/ 失败/ ,/ 该/ 等式/ 成立/ 的/ 概率/ 至多/ 为/ 1/ // p/ ,/ 从而/ 挑战者/ / 模拟/ 失败/ 的/ 概率/ 为/ qD/ // p/ ,/ 其中/ qD/ 为/ 攻击者/ 执行/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 、/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ 查询/ 的/ 次数/ ,/ 而/ qD/ // p/ 在/ 信息论/ 中是/ 可/ 忽略/ 的/ ,/ 因此/ 挑战者/ / 模拟/ 失败/ 的/ 概率/ 是/ 可/ 忽略/ 的/ ./ 若/ / =/ e/ (/ g/ ,/ g/ )/ saq/ +/ 1/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game3/ 相同/ ,/ 若/ / 是/ 随机/ 选择/ 的/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game4/ 相同/ ./ 若/ AdvABAKA/ 可/ 忽略/ 的/ ,/ 则/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 解决/ 定义/ 4/ 中/ 定义/ 的/ DPBDHE/ 困难/ 问题/ ./ 因此/ 若/ AdvABAKAGame5/ ./ 在/ 该游戏/ 中/ ,/ 从强/ 随机/ 提取/ 器/ 的/ 值域/ 空间/ 随机/ 选择/ θ/ / 1/ 代替/ 测试/ 会话/ 中/ 计算/ 的/ θ/ / 1/ =/ Ext/ (/ s/ ,/ θ/ / 1/ )/ ,/ 除此以外/ ,/ Game5/ 和/ Game4/ 相同/ ./ 由于/ 在/ Game4/ 中/ θ/ / 1/ 是/ 随机/ 选择/ 的/ ,/ θ/ / 1/ 有/ 足够/ 的/ 最小/ 熵/ ./ 因此/ ,/ 由强/ 随机/ 提取/ 器/ 的/ 定义/ ,/ / (/ 5/ )/ -/ AdvABAKAAdvABAKAGame6/ ./ 在/ 该游戏/ 中/ ,/ 从伪/ 随机/ 函数/ 的/ 值域/ 空间/ 随机/ 选择/ γ/ ,/ 并/ 使用/ K/ / =/ γ/ / G/ θ/ / 代替/ 测试/ 会话/ K/ / =/ G/ θ/ / 3/ (/ sid/ / )/ ,/ 除此以外/ ,/ Game6/ 与/ Game5/ 相同/ ./ G/ θ/ / 的/ ,/ 则/ 可以/ 构造/ 一个/ 多项式/ 时间/ 的/ 区分/ 者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 伪/ 随机/ 函数/ G/ 和/ 一个/ 真/ 随机/ 函数/ RF/ ./ / 按照/ 下述/ 步骤/ 模拟/ 安全性/ 游戏/ :/ Setup/ ./ / 设置/ 系统/ 主/ 密钥/ 以及/ 所有/ 用户/ 的/ 私钥/ ./ Simulation/ ./ / 用/ 列表/ / 记录/ / 对会话/ 密钥/ 的/ 询问/ KeyReveal/ ,/ 然后/ 按照/ 协议/ 规范/ 和/ 安全性/ 游戏规则/ 进行/ 如下/ 模拟/ :/ ①/ Send/ (/ I/ ,/ SP/ ,/ S/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ memP/ 并/ 返回/ ,/ 同时/ 记录/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ )/ ./ ②/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 和/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ 出会话/ 密钥/ K/ 并/ 返回/ ,/ 将会话/ 密钥/ K/ 加入/ 列表/ / ,/ 并/ 记录/ 所有/ 的/ 会/ 话/ 状态/ ,/ 标记/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ ,/ mem/ 珚/ P/ )/ 为/ 已/ 完成/ 会话/ ./ ③/ KeyReveal/ (/ sid/ )/ :/ 若会话/ sid/ 已/ 完成/ 则/ 返回/ 其/ 在/ 列表/ / 中/ 对应/ 的/ 会/ 话/ 密钥/ K/ ,/ 若会/ 话/ 未/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ④/ StateReveal/ (/ sid/ )/ :/ 若会话/ sid/ 未/ 完成/ 则/ 返回/ 记录/ 的/ 该会/ 话/ 的/ 所有/ 内部/ 状态/ 信息/ ,/ 若会/ 话/ 已/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ 用户/ 私钥/ SKU/ ./ 2/ (/ sid/ / )/ / G/ θ/ / G/ θ/ / 机/ 函数/ G/ ,/ 否则/ / 输出/ F/ / 为/ 真/ 随机/ 函数/ RF/ ./ ⑤/ Corrupt/ (/ U/ ,/ SU/ )/ :/ / 返回/ Setup/ 阶段/ 生成/ 的/ ⑥/ Test/ (/ sid/ / )/ :/ / 计算/ 会话/ 密钥/ K/ / =/ F/ / (/ sid/ / )/ / ⑦/ 如果/ / 输出/ 猜测/ b/ =/ 0/ ,/ 则/ / 输出/ F/ / 为/ 伪/ 随/ Page9/ 若/ F/ / =/ G/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game5/ 相同/ ;/ 若/ F/ / =/ RF/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game6/ 相同/ ./ 若/ AdvABAKA/ 的/ ,/ 则/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ 伪/ 随机/ 函数/ G/ 和/ 真/ 随机/ 函数/ RF/ ./ 因此/ 在/ Game6/ 中/ ,/ 测试/ 会话/ 中/ 的/ 会/ 话/ 密钥/ 是/ 完全/ 随机/ 的/ ,/ 攻击者/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ,/ 即/ AdvABAKA/ 因此/ Pr/ [/ E1/ ∧/ Suc/ ]/ 可/ 忽略/ ./ / (/ 3/ )/ -/ AdvABAKA/ (/ 2/ )/ Pr/ [/ E2/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ E2/ ∧/ Suc/ 与/ E1/ ∧/ Suc/ 的/ 证明/ 基本相同/ ,/ 不同点/ 在于/ Game3/ ./ 在/ E1/ ∧/ Suc/ 中/ ,/ Game3/ 使用/ 一个/ 真/ 随机/ 函数/ RF/ (/ ·/ )/ 代替/ 测试/ 会话/ 中/ 的/ 伪/ 随机/ 函数/ F/ ./ 而/ 在/ E2/ ∧/ Suc/ 中/ ,/ Game3/ 使用/ 一个/ 真/ 随机/ 函数/ RF/ (/ ·/ )/ 代替/ 测试/ 会话/ 中/ 的/ 伪/ 随机/ 函数/ F/ ,/ 若/ AdvABAKA/ 以/ 采用/ E1/ ∧/ Suc/ 中/ 相似/ 的/ 方法/ 构造/ 一个/ 多项式/ 时间/ 的/ 区分/ 者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 伪/ 随机/ 函数/ F/ 和/ 真/ 随机/ 函数/ RF/ ./ 因此/ Pr/ [/ E2/ ∧/ Suc/ ]/ 可/ 忽略/ ./ (/ 3/ )/ Pr/ [/ E3/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ 我们/ 使用/ 一系列/ 攻击/ 游戏/ 证明/ 攻击者/ 在/ 这种/ 情况/ 下/ 的/ 优势/ 是/ 可/ 忽略/ 的/ ./ 令/ AdvABAKA/ 者/ / 在/ 游戏/ k/ 中/ 的/ 攻击/ 优势/ ./ Game0/ ./ 该游戏/ 与/ 实际/ 的/ 安全性/ 游戏/ 一致/ ,/ 因此/ 攻击者/ / 的/ 优势/ AdvABAKA/ 际/ 协议/ 的/ 优势/ ./ Game1/ ./ 该游戏/ 与/ Game0/ 的/ 区别/ 在于/ ,/ 若/ 两个/ 不同/ 的/ 会/ 话/ 拥有/ 相同/ 的/ 会/ 话/ id/ ,/ 即/ 两个/ 不同/ 会话/ 的/ 协议/ 双方/ 以及/ 协议/ 双方/ 产生/ 的/ 消息/ 完全相同/ ,/ 则/ 游戏/ 终止/ ./ 这种/ 情况/ 发生/ 的/ 概率/ 相当于/ 随机/ 选择/ 两个/ 随机数/ 发生/ 碰撞/ 的/ 概率/ ,/ 因此/ Game2/ ./ 该游戏/ 与/ Game1/ 的/ 区别/ 在于/ ,/ 游戏/ 开始/ 选择/ 协议/ 通信/ 方/ A/ 及其/ 意定/ 的/ 通信/ 伙伴/ B/ ,/ 并/ 随机/ 选择/ 一个/ 整数/ i/ ∈/ [/ 1/ ,/ L/ ]/ ,/ 若/ 攻击者/ / 选择/ 的/ 测试/ 会话/ 是/ 通信/ 方/ A/ 进行/ 的/ 第/ i/ 次会/ 话/ 且/ 其/ 通信/ 伙伴/ 为/ B/ ,/ 则/ 游戏/ 继续/ ;/ 否则/ 游戏/ 终止/ ./ 由于/ 攻击者/ 选择/ 的/ 测试/ 会话/ 满足/ 上述/ 条件/ 的/ 概率/ 为/ 1AdvABAKAGame3/ ./ 在/ 该游戏/ 中/ ,/ 随机/ 选择/ θ/ / 3/ ∈/ GT/ 代替/ 测试/ 会话/ 中/ 计算/ 的/ θ/ / 3/ =/ e/ (/ g/ ,/ w/ )/ y/ / 和/ Game2/ 相同/ ./ 若/ AdvABAKA/ 不可/ 忽略/ 的/ ,/ 则/ 可以/ 构造/ 一个/ 多项式/ 时间/ 的/ 挑战者/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 解决/ 定义/ 4/ 中/ 的/ 困难/ 问题/ ./ / 按照/ 下述/ 步骤/ 模拟/ 安全性/ 游戏/ :/ Init/ ./ / 运行/ 攻击者/ / ,/ / 输出/ 要/ 挑战/ 的/ 两个/ 访问/ 结构/ AA/ / 矩阵/ 分别/ 为/ (/ (/ 犕/ / A/ )/ l/ / Setup/ ./ / 随机/ 选择/ α/ ∈/ / p/ ,/ 同时/ 隐含/ 设置/ β/ =/ s/ ,/ 因此/ w/ =/ gs/ ./ / 随机/ 选择/ h1/ ,/ …/ ,/ hm/ ,/ δ/ 1/ ,/ δ/ 2/ ,/ δ/ 3/ ∈/ G/ ,/ 则/ 系统/ 的/ 主/ 密钥/ 为/ MSK/ =/ α/ ,/ 公开/ 参数/ 为/ PK/ =/ (/ e/ (/ g/ ,/ g/ )/ α/ ,/ h1/ …/ hm/ ,/ w/ ,/ δ/ 1/ ,/ δ/ 2/ ,/ δ/ 3/ )/ ./ / 可以/ 使用/ 主/ 密钥/ 生成/ 所有/ 用户/ 的/ 私钥/ ./ / 按照/ 如下/ 方式/ 生成/ 测试/ 会话/ 中/ 通信/ 双方/ A/ 和/ B/ 之间/ 的/ 消息/ mem/ / A/ 和/ mem/ / B/ ,/ 测试/ 会话/ 是/ A/ 进行/ 的/ 第/ i/ 次会话/ ./ / 首先/ 令/ C/ / A/ ,/ 2/ =/ ga/ ,/ C/ / B/ ,/ 2/ =/ gaq/ ,/ 其它/ 消息/ 都/ 按照/ 协议/ 规则/ 生成/ ./ 即/ / 随机/ 选取/ 向量/ 狊/ / A/ =/ (/ x/ / A/ ,/ s/ / A/ ,/ 2/ ,/ …/ ,/ s/ / s/ / A/ ,/ 2/ ,/ …/ ,/ s/ / 对/ / i/ ∈/ {/ 2/ ,/ …/ ,/ n/ / A/ }/ 计算/ s/ / A/ ,/ i/ =/ F/ σ/ A/ (/ s/ / A/ ,/ i/ )/ / Fs/ / / 随机/ 选取/ d/ / A/ ,/ t/ / A/ ,/ 1/ ,/ t/ / A/ ,/ 2/ ,/ …/ ,/ t/ / l/ / A/ }/ 计算/ t/ / A/ ,/ i/ =/ F/ σ/ A/ (/ t/ / A/ ,/ i/ )/ / Ft/ / 量/ (/ λ/ / A/ ,/ 1/ ,/ λ/ / A/ ,/ 2/ ,/ …/ ,/ λ/ / 同时/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / A/ }/ ,/ 计算/ C/ / Ai/ ,/ 1/ =/ g/ β/ λ/ / C/ / Ai/ ,/ 2/ =/ gt/ / c/ / A/ =/ H/ (/ 犕/ / A/ ,/ C/ / A/ ,/ 1/ ,/ C/ / A/ ,/ 2/ ,/ {/ C/ / Ai/ ,/ 1/ ,/ C/ / Ai/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / / 输出/ A/ 发送给/ B/ 消息/ 为/ 同理/ / 可/ 计算/ mem/ / B/ ,/ 随机/ 选取/ 向量/ 狊/ / B/ =/ (/ x/ / B/ ,/ s/ / B/ ,/ 2/ ,/ …/ ,/ s/ / B/ )/ T/ ∈/ / s/ / B/ ,/ n/ / {/ 2/ ,/ …/ ,/ n/ / B/ }/ 计算/ s/ / B/ ,/ i/ =/ F/ σ/ B/ (/ s/ / B/ ,/ i/ )/ / Fs/ / 取/ d/ / B/ ,/ t/ / B/ ,/ 1/ ,/ t/ / B/ ,/ 2/ ,/ …/ ,/ t/ / 算/ t/ / B/ ,/ i/ =/ F/ σ/ B/ (/ t/ / B/ ,/ i/ )/ / Ft/ / (/ λ/ / B/ ,/ 1/ ,/ λ/ / B/ ,/ 2/ ,/ …/ ,/ λ/ / 时/ 对/ / i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / B/ }/ ,/ 计算/ C/ / Bi/ ,/ 1/ =/ g/ β/ λ/ / C/ / Bi/ ,/ 2/ =/ gt/ / c/ / B/ =/ H/ (/ 犕/ / B/ ,/ C/ / B/ ,/ 1/ ,/ C/ / B/ ,/ 2/ ,/ {/ C/ / Bi/ ,/ 1/ ,/ C/ / Bi/ ,/ 2/ }/ i/ ∈/ {/ 1/ ,/ …/ ,/ l/ / / 输出/ B/ 发送给/ A/ 消息/ 为/ Page10Simulation/ ./ / 用/ 列表/ / 记录/ / 对会话/ 密钥/ 的/ 询问/ KeyReveal/ ,/ 然后/ 按照/ 协议/ 规范/ 和/ 安全性/ 游戏规则/ 进行/ 如下/ 模拟/ :/ ①/ Send/ (/ I/ ,/ SP/ ,/ S/ 珚/ P/ )/ :/ 若/ I/ =/ A/ ,/ 且/ 该会/ 话/ 是/ A/ 的/ 第/ i/ 次会话/ ,/ 则/ / 返回/ 在/ Setup/ 阶段/ 计算/ 的/ mem/ / A/ ,/ 否则/ / 依据/ 协议/ 规范/ 进行/ 响应/ ,/ 并/ 记录/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ )/ ./ ②/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 和/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ 出会话/ 密钥/ K/ 并/ 返回/ ,/ 将会话/ 密钥/ K/ 加入/ 列表/ / ,/ 并/ 记录/ 所有/ 的/ 会/ 话/ 状态/ ,/ 标记/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ ,/ mem/ 珚/ P/ )/ 为/ 已/ 完成/ 会话/ ./ ③/ KeyReveal/ (/ sid/ )/ :/ 若会话/ sid/ 已/ 完成/ 则/ 返回/ 其/ 在/ 列表/ / 中/ 对应/ 的/ 会/ 话/ 密钥/ K/ ,/ 若会/ 话/ 未/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ④/ StateReveal/ (/ sid/ )/ :/ 若会话/ sid/ 未/ 完成/ 则/ 返回/ 记录/ 的/ 该会/ 话/ 的/ 所有/ 内部/ 状态/ 信息/ ,/ 若会/ 话/ 已/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ 户/ 私钥/ SKU/ ./ ⑤/ Corrupt/ (/ U/ ,/ SU/ )/ :/ / 返回/ Setup/ 阶段/ 生成/ 的/ 用/ ⑥/ Test/ (/ sid/ / )/ :/ / 计算/ θ/ / 1/ =/ e/ (/ g/ ,/ g/ )/ α/ x/ / e/ (/ g/ ,/ g/ )/ α/ x/ / 密钥/ K/ / 并/ 返回/ 给/ 攻击者/ / ./ ⑦/ 如果/ / 输出/ 猜测/ b/ ,/ / 输出/ b/ ./ 若/ / =/ e/ (/ g/ ,/ g/ )/ saq/ +/ 1/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game2/ 相同/ ;/ 若/ / 是/ 随机/ 选择/ 的/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game3/ 相同/ ./ 若/ AdvABAKA/ 不可/ 忽略/ 的/ ,/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 解决/ 定义/ 4/ 中/ 的/ 困难/ 问题/ ./ 因此/ Game4/ ./ 在/ 该游戏/ 中/ ,/ 从强/ 随机/ 提取/ 器/ 的/ 值域/ 空间/ 随机/ 选择/ θ/ / 3/ 代替/ 测试/ 会话/ 中/ 计算/ 的/ θ/ / 3/ =/ Ext/ (/ s/ ,/ θ/ / 3/ )/ ,/ 除此以外/ ,/ Game4/ 和/ Game3/ 相同/ ./ 由于/ 在/ Game3/ 中/ θ/ / 3/ 是/ 随机/ 选择/ 的/ ,/ θ/ / 3/ 有/ 足够/ 的/ 最小/ 熵/ ./ 因此/ ,/ 由强/ 随机/ 提取/ 器/ 的/ 定义/ ,/ / (/ 4/ )/ -/ AdvABAKAAdvABAKAGame5/ ./ 在/ 该游戏/ 中/ ,/ 从伪/ 随机/ 函数/ 的/ 值域/ 空间/ 随机/ 选择/ γ/ ,/ 并/ 使用/ K/ / =/ G/ θ/ / γ/ 代替/ 测试/ 会话/ K/ / =/ G/ θ/ / 3/ (/ sid/ / )/ ,/ 除此以外/ ,/ Game5/ 与/ Game4/ 相同/ ./ G/ θ/ / 若/ AdvABAKA/ 的/ ,/ 则/ 可以/ 构造/ 一个/ 多项式/ 时间/ 的/ 区分/ 者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 区分/ 伪/ 随机/ 函数/ G/ 和/ 一个/ 真/ 随机/ 函数/ RF/ ./ / 按照/ 下述/ 步骤/ 模拟/ 安全性/ 游戏/ :/ Setup/ ./ / 设置/ 系统/ 主/ 密钥/ 以及/ 所有/ 用户/ 的/ 私钥/ ./ Simulation/ ./ / 用/ 列表/ / 记录/ / 对会话/ 密钥/ 的/ 询问/ KeyReveal/ ,/ 然后/ 按照/ 协议/ 规范/ 和/ 安全性/ 游戏规则/ 进行/ 如下/ 模拟/ :/ ①/ Send/ (/ I/ ,/ SP/ ,/ S/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ memP/ 并/ 返回/ ,/ 同时/ 记录/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ )/ ./ ②/ Send/ (/ R/ ,/ S/ 珚/ P/ ,/ SP/ ,/ memP/ )/ 和/ Send/ (/ I/ ,/ S/ 珚/ P/ ,/ SP/ ,/ mem/ 珚/ P/ )/ :/ / 依据/ 协议/ 规范/ 计算/ 出会话/ 密钥/ K/ 并/ 返回/ ,/ 将会话/ 密钥/ K/ 加入/ 列表/ / ,/ 并/ 记录/ 所有/ 的/ 会/ 话/ 状态/ ,/ 标记/ (/ SP/ ,/ S/ 珚/ P/ ,/ memP/ ,/ mem/ 珚/ P/ )/ 为/ 已/ 完成/ 会话/ ./ ③/ KeyReveal/ (/ sid/ )/ :/ 若会话/ sid/ 已/ 完成/ 则/ 返回/ 其/ 在/ 列表/ / 中/ 对应/ 的/ 会/ 话/ 密钥/ K/ ,/ 若会/ 话/ 未/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ④/ StateReveal/ (/ sid/ )/ :/ 若会话/ sid/ 未/ 完成/ 则/ 返回/ 记录/ 的/ 该会/ 话/ 的/ 所有/ 内部/ 状态/ 信息/ ,/ 若会/ 话/ 已/ 完成/ 则/ 返回/ 终止/ 符号/ ⊥/ ./ ⑤/ Corrupt/ (/ U/ ,/ SU/ )/ :/ / 返回/ Setup/ 阶段/ 生成/ 的/ 用户/ 私钥/ SKU/ ./ ⑥/ Test/ (/ sid/ / )/ :/ / 计算/ 会话/ 密钥/ K/ / =/ G/ θ/ / 2/ (/ sid/ / )/ / F/ / (/ sid/ / )/ 并/ 返回/ 给/ 攻击者/ / ./ G/ θ/ / ⑦/ 如果/ / 输出/ 猜测/ b/ =/ 0/ ,/ 则/ / 输出/ F/ / 为/ 伪/ 随机/ 函数/ G/ ,/ 否则/ / 输出/ F/ / 为/ 真/ 随机/ 函数/ RF/ ./ 若/ F/ / =/ G/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game4/ 相同/ ;/ 若/ F/ / =/ RF/ ,/ 则/ / 模拟/ 的/ 安全性/ 游戏/ 与/ Game5/ 相同/ ./ 若/ AdvABAKA/ 则/ / 能够/ 以/ 不可/ 忽略/ 的/ 优势/ 区分/ 伪/ 随机/ 函数/ G/ 和/ 真/ 随机/ 函数/ RF/ ./ 因此/ 在/ Game5/ 中/ ,/ 测试/ 会话/ 中/ 的/ 会/ 话/ 密钥/ 是/ 完全/ 随机/ 的/ ,/ 攻击者/ / 的/ 优势/ 是/ 可/ 忽略/ 的/ ,/ 即/ AdvABAKA/ 因此/ Pr/ [/ E3/ ∧/ Suc/ ]/ 可/ 忽略/ ./ (/ 4/ )/ Pr/ [/ E4/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ E4/ ∧/ Suc/ 与/ E2/ ∧/ Suc/ 的/ 证明/ 相同/ ,/ 在/ E2/ ∧/ Suc/ 中/ ,/ 由于/ 没有/ 匹配/ 会话/ sid/ / ,/ 攻击者/ / 能够/ 设置/ 任意/ 的/ 临时/ 密钥/ ,/ 相当于/ 在/ E4/ ∧/ Suc/ 中/ 获取/ 了/ sid/ / 的/ 临时/ 密钥/ ,/ 因此/ E4/ ∧/ Suc/ 与/ E2/ ∧/ Suc/ 证明/ 相同/ ,/ 即可/ 证明/ Pr/ [/ E4/ ∧/ Suc/ ]/ 可/ 忽略/ ./ (/ 5/ )/ Pr/ [/ E5/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ E5/ ∧/ Suc/ 与/ E1/ ∧/ Suc/ 的/ 证明/ 相同/ ,/ 在/ E1/ ∧/ Suc/ 中/ ,/ 由于/ 没有/ 匹配/ 会话/ sid/ / ,/ 攻击者/ / 能够/ 设置/ 任意/ 的/ 临时/ 密钥/ ,/ 相当于/ 在/ E5/ ∧/ Suc/ 中/ 获取/ 了/ sid/ / 的/ 临时/ 密钥/ ,/ 因此/ E5/ ∧/ Suc/ 与/ E1/ ∧/ Suc/ 证明/ 相同/ ,/ 即可/ 证明/ Pr/ [/ E5/ ∧/ Suc/ ]/ 可/ 忽略/ ./ Page11/ (/ 6/ )/ Pr/ [/ E6/ ∧/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ./ 由于/ 协议/ 中/ 通信/ 双方/ 的/ 地位/ 相同/ ,/ 因此/ E6/ ∧/ Suc/ 与/ E5/ ∧/ Suc/ 的/ 证明/ 相同/ ,/ 即可/ 证明/ Pr/ [/ E6/ ∧/ Suc/ ]/ 可/ 忽略/ ./ 综合/ 以上/ 6/ 种/ 情况/ 下/ Pr/ [/ Ei/ ∧/ Suc/ ]/ i/ =/ {/ 1/ ,/ …/ ,/ 6/ }/ 均/ 是/ 可/ 忽略/ 的/ ,/ 则/ 有/ Pr/ [/ Suc/ ]/ 是/ 可/ 忽略/ 的/ ,/ 因此/ 定理/ 1/ 得证/ ./ 5.2/ 安全性/ 与/ 通信/ 效率/ 比较/ 本节/ 将/ 本文/ 所提/ 协议/ 与/ 已有/ 的/ 支持/ 通用/ 认证/ 策略/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ 进行/ 比较/ ,/ 其中/ 文献/ [/ 11/ ]/ 中/ 的/ 协议/ 采用/ 文献/ [/ 6/ ]/ 中/ 的/ 基于/ 属性/ 的/ 签名/ 方案/ ./ 在/ 比较/ 协议/ 通信/ 效率/ 时/ ,/ l/ 和/ n/ 分别/ 表示/ 访问控制/ 矩阵/ 的/ 行数/ 和/ 列数/ ,/ sig/ 和/ vk/ 分别/ 表示/ 一次/ 表/ 1/ 安全/ 性质/ 与/ 通信/ 效率/ 比较/ 文献/ [/ 10/ ]/ 中/ 协议/ 文献/ [/ 11/ ]/ 中/ 协议/ 文献/ [/ 12/ ]/ 中/ 协议/ 6/ 结束语/ 本文/ 借鉴/ 了/ Fujioka/ 等/ 人/ [/ 17/ ]/ 的/ 思想/ ,/ 并/ 采用/ Lai/ 等/ 人/ [/ 19/ ]/ 简洁/ 高效/ 的/ 转化/ 方法/ 将/ Waters/ [/ 4/ ]/ 的/ CPA/ 安全/ 的/ 基于/ 属性/ 的/ 加密/ 方案/ 转化/ 为/ CCA/ 安全/ 的/ 密钥/ 封装/ 方案/ ,/ 在/ 此基础/ 上/ 提出/ 了/ 一个/ 在/ 标准/ 模型/ 和/ CK/ +/ 模型/ 下可证/ 安全/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ ./ 该/ 协议/ 满足/ 弱/ 的/ 完美/ 前向/ 安全性/ 并/ 能够/ 抵抗/ 密钥/ 泄露/ 伪装/ 攻击/ 和/ 临时/ 密钥/ 泄露/ 攻击/ ./ 相比/ 于/ 现有/ 的/ 基于/ 属性/ 的/ 认证/ 密钥/ 协商/ 协议/ ,/ 本文/ 协议/ 具有/ 更/ 高/ 的/ 通信/ 效率/ 和/ 更/ 强/ 的/ 安全性/ ,/ 更/ 适于/ 在/ 实际/ 的/ 系统/ 中/ 应用/ ./ 

