Page1/ 一种/ 基于/ 遗传算法/ 的/ 虚拟机/ 镜像/ 自/ 适应/ 备份/ 策略/ 1/ )/ (/ 中国科学院/ 软件/ 研究所/ 北京/ 100190/ )/ 2/ )/ (/ 计算机科学/ 国家/ 重点/ 实验室/ 北京/ 100190/ )/ 3/ )/ (/ 中国科学院/ 大学/ 北京/ 100190/ )/ 摘要/ 虚拟机/ 镜像/ 备份/ 是/ 保障/ 虚拟化/ 数据中心/ 服务/ 可靠性/ 的/ 关键技术/ ./ 同时/ ,/ 为了/ 节省/ 存储空间/ ,/ 镜像/ 备份/ 过程/ 往往/ 伴随/ 着/ 数据/ 去/ 冗余/ 操作/ ./ 然而/ ,/ 镜像/ 备份/ 和/ 数据/ 去/ 冗余/ 都/ 会/ 占用/ 大量/ 系统资源/ ,/ 会/ 对/ 在/ 数据中心/ 托管/ 的/ 应用/ 性能/ 造成/ 严重/ 干扰/ ./ 如何/ 缩短/ 备份/ 与/ 去/ 冗余/ 时间/ 以/ 降低/ 对/ 应用/ 造成/ 的/ 性能/ 干扰/ 成为/ 数据中心/ 管理/ 的/ 关键问题/ ./ 当前/ 常用/ 的/ 备份/ 策略/ 可以/ 分为/ 3/ 种/ :/ 先/ 去/ 冗余/ 再/ 备份/ 、/ 先/ 备份/ 再/ 去/ 冗余/ 和/ 边/ 去/ 冗余/ 边/ 备份/ ./ 每种/ 策略/ 都/ 有/ 不同/ 的/ 资源/ 需求/ ,/ 适用/ 于/ 不同/ 的/ 应用/ 场景/ ,/ 而/ 合理/ 的/ 组合/ 策略/ 可以/ 有效/ 缩短/ 备份/ 时间/ ./ 该文/ 提出/ 一种/ 基于/ 遗传算法/ 的/ 虚拟机/ 镜像/ 自/ 适应/ 备份/ 策略/ ./ 我们/ 首先/ 针对/ 不同/ 的/ 虚拟机/ 镜像/ 备份/ 策略/ ,/ 分别/ 建立/ 资源/ 需求/ 模型/ ,/ 然后/ 根据/ 系统/ 当前/ 资源/ 占用/ 情况/ 自/ 适应/ 的/ 进行/ 策略/ 规划/ ,/ 以/ 最小化/ 备份/ 时间/ ./ 实验/ 结果表明/ :/ 该文/ 所/ 提出/ 的/ 模型/ 可以/ 在/ 2/ %/ ~/ 10/ %/ 误差/ 范围/ 内/ 预测/ 去/ 冗余/ 备份/ 时间/ ,/ 采用/ 所/ 提出/ 的/ 组合/ 策略/ 可以/ 减少/ 20/ %/ 左右/ 的/ 备份/ 时间/ ./ 关键词/ 虚拟机/ 镜像/ ;/ 镜像/ 备份/ ;/ 数据/ 去/ 冗余/ ;/ 遗传算法/ ;/ 组合/ 策略/ ;/ 云/ 计算/ 1/ 引言/ 虚拟化/ 技术/ 已经/ 在/ 数据中心/ 广泛应用/ ,/ 而且/ 虚拟机/ 已/ 逐步/ 取代/ 物理/ 机/ 成为/ 应用服务/ 的/ 部署/ 环境/ ./ 虚拟机/ 的/ 磁盘/ 信息/ (/ 操作系统/ 、/ 应用软件/ 、/ 软件/ 配置/ 和/ 用户/ 数据/ 等/ 内容/ )/ 都/ 封装/ 在/ 虚拟机/ 镜像/ 中/ ./ 虚拟机/ 镜像/ 备份/ 是/ 保障/ 数据中心/ 可靠性/ 的/ 关键技术/ ./ 由于/ 虚拟机/ 镜像/ 具有/ 封装/ 性/ ,/ 镜像/ 在/ 存储/ 过程/ 中以/ 一个/ 整体/ 的/ 形式/ 存在/ ,/ 这/ 就/ 不可避免/ 的/ 造成/ 镜像/ 备份/ 数据/ 的/ 大量/ 冗余/ ./ 为了/ 节约/ 存储空间/ ,/ 数据中心/ 通常/ 在/ 镜像/ 备份/ 操作/ 的/ 同时/ 采用/ 内容/ 寻址/ (/ ContentAddressableStorage/ ,/ CAS/ )/ 技术/ [/ 1/ -/ 3/ ]/ 消除/ 冗余/ 数据/ ./ 内容/ 寻址/ 技术/ 首先/ 利用/ 哈希/ 函数/ (/ 如/ MD5/ ,/ SHA/ -/ 1/ )/ 计算/ 数据/ 块/ 的/ 指纹/ ,/ 并/ 将/ 该/ 指纹/ 作为/ 存储/ 数据/ 块/ 内容/ 的/ 地址/ ./ 于是/ ,/ 在/ 数据/ 存储/ 中/ 相同/ 的/ 数据/ 只/ 存储/ 一份/ ,/ 从而/ 达到/ 数据/ 去/ 冗余/ 的/ 目的/ ./ 虚拟机/ 镜像/ 备份/ 通常/ 伴随/ 着/ 数据/ 去/ 冗余/ 操作/ ,/ 我们/ 将/ 该/ 备份/ 过程/ 称为/ 虚拟机/ 镜像/ 的/ 去/ 冗余/ 备份/ ./ 由于/ 去/ 冗余/ 备份/ 过程/ 会/ 占用/ 大量/ 系统资源/ ,/ 数据中心/ 一般/ 会/ 选择/ 在/ 负载/ 较/ 低/ 的/ 时间段/ 进行/ 备份/ 操作/ ./ 研究/ 指出/ [/ 4/ ]/ ,/ 虚拟化/ 数据中心/ 每天/ 负载/ 较/ 低/ 的/ 时间段/ 极短/ ./ 如果/ 在/ 特定/ 的/ 时间/ 窗口/ 内/ 不能/ 完成/ 备份/ 操作/ ,/ 就/ 有/ 可能/ 导致/ 服务/ 违约/ 的/ 情况/ 发生/ ;/ 而/ 如果/ 放弃/ 备份/ ,/ 则/ 可能/ 导致系统/ 存在/ 可靠性/ 风险/ ./ 因此/ ,/ 加快/ 去/ 冗余/ 备份/ 速度/ ,/ 可以/ 使/ 系统/ 在/ 有限/ 时间/ 内/ 备份/ 更/ 多/ 的/ 数据/ ,/ 同时/ 避免/ 因/ 性能/ 干扰/ 而/ 导致/ 的/ 服务质量/ 违约/ 的/ 情况/ 发生/ ./ 去/ 冗余/ 备份/ 操作/ 可以/ 被/ 分解/ 为/ 一系列/ 子/ 任务/ ,/ 根据/ 子/ 任务/ 执行/ 顺序/ 和/ 执行/ 位置/ 的/ 不同/ ,/ 常见/ 的/ 备份/ 策略/ 可以/ 分为/ 先/ 备份/ 再/ 去/ 冗余/ 策略/ (/ DeduplicationAfterBackupstrategy/ ,/ DAB/ )/ [/ 5/ ]/ 、/ 先/ 去/ 冗余/ 再/ 备份/ 策略/ (/ DeduplicationBeforeBackupstrategy/ ,/ DBB/ )/ [/ 6/ ]/ 和/ 边/ 备份/ 边去/ 冗余/ 策略/ (/ DeduplicationDuringBackupstrategy/ ,/ DDB/ )/ [/ 7/ -/ 8/ ]/ 等/ 3/ 种/ ./ 不同/ 策略/ 中/ 相同/ 的/ 子/ 任务/ 对/ 资源/ 的/ 需求/ 程度/ 不尽相同/ ,/ 通过/ 合理配置/ 备份/ 策略/ ,/ 可以/ 在/ 一定/ 程度/ 上/ 避免/ 对/ 同种/ 类型/ 资源/ 的/ 竞争/ ,/ 为/ 缩短/ 虚拟机/ 镜像/ 备份/ 时间/ 提供/ 了/ 可能/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 首先/ 提出/ 了/ 一种/ 去/ 冗余/ 备份/ 时间/ 预测/ 模型/ 用于/ 预测/ 不同/ 组合/ 策略/ 下/ 的/ 虚拟机/ 镜像/ 备份/ 时间/ ./ 其次/ ,/ 根据/ 运行/ 时/ 各种/ 物理/ 资源/ 的/ 占用/ 情况/ ,/ 利用/ 遗传算法/ 以/ 模型/ 预测/ 的/ 镜像/ 备份/ 时间/ 作为/ 评价/ 因子/ ,/ 自/ 适应/ 的/ 给出/ 近似/ 最优/ 的/ 组合/ 策略/ 方法/ ./ 实验/ 结果表明/ ,/ 我们/ 的/ 方法/ 可以/ 有效/ 降低/ 虚拟机/ 镜像/ 备份/ 时间/ ./ 本文/ 第/ 2/ 节/ 介绍/ 研究/ 背景/ 和/ 研究/ 动机/ ;/ 第/ 3/ 节/ 介绍/ 虚拟机/ 镜像/ 备份/ 时间/ 预测/ 模型/ ;/ 第/ 4/ 节/ 给出/ 基于/ 遗传算法/ 的/ 组合/ 策略/ 方法/ ;/ 第/ 5/ 节/ 描述/ 实验/ 环境/ ,/ 对/ 实验/ 结果/ 进行/ 分析/ 以/ 验证/ 本文/ 所/ 提出/ 方法/ 的/ 有效性/ ;/ 第/ 6/ 节/ 分析/ 并/ 比较/ 相关/ 工作/ ;/ 第/ 7/ 节对/ 文章内容/ 进行/ 总结/ ,/ 并/ 给出/ 进一步/ 的/ 研究/ 方向/ ./ 2/ 研究/ 背景/ 与/ 动机/ 2.1/ 研究/ 背景/ 虚拟机/ 镜像/ 存储/ 涉及/ 两类/ 设备/ :/ 运行/ 主机/ 和/ 备份/ 存储/ ./ 运行/ 主机/ 用于/ 虚拟机/ 运行/ 时/ 磁盘/ 文件/ 存储/ ,/ 备份/ 存储/ 则/ 用于/ 镜像/ 备份文件/ 存储/ ./ 运行/ 主机/ 和/ 备份/ 存储/ 并非/ 一一对应/ ,/ 一个/ 备份/ 存储设备/ 可/ 用于/ 多个/ 不同/ 运行/ 主机/ 的/ 数据备份/ ./ 本文/ 中/ ,/ 我们/ 把/ 共享/ 一个/ 备份/ 存储设备/ 的/ 运行/ 主机/ 视为/ 一个/ 集群/ (/ Cluster/ )/ ./ 在/ 镜像/ 备份/ 中/ ,/ 我们/ 把/ 运行/ 主机/ 称为/ 客户端/ (/ Client/ )/ ,/ 而/ 把/ 备份/ 存储设备/ 称为/ 服务器端/ (/ Server/ )/ ./ 虚拟机/ 镜像/ 备份/ 时/ 需要/ 在/ 客户端/ 和/ 服务器端/ 创建/ 一个/ 备份/ 线程/ ,/ 该/ 线程/ 负责/ 将/ 虚拟机/ 镜像/ 从/ 客户端/ 传输/ 到/ 服务器端/ 进行/ 存储/ ./ 如图/ 1/ 所示/ ,/ 虚拟机/ 镜像/ 备份/ 去/ 冗余/ 的/ 策略/ 主要/ 包括/ DAB/ 、/ DBB/ 和/ DDB/ 等/ 3/ 类/ ./ 图/ 1/ 中/ “/ 原始/ 镜像/ ”/ 代表/ 需要/ 备份/ 的/ 虚拟机/ 镜像/ ,/ “/ 备份/ 镜像/ ”/ 代表/ 保存/ 到/ 备份/ 存储设备/ 的/ 无/ 冗余/ 虚拟机/ 镜像/ 备份/ ,/ 虚线/ 矩形框/ 代表/ 临时/ 中间/ 存储/ ./ 下面/ 我们/ 对/ 这/ 3/ 类/ 主要/ 策略/ 分别/ 进行/ 介绍/ ./ (/ 1/ )/ 先/ 备份/ 再/ 去/ 冗余/ 策略/ (/ DAB/ )/ ./ 先/ 将/ 虚拟机/ 镜像/ 通过/ 网络/ 从/ 运行/ 主机/ 传输/ 到/ 备份/ 存储设备/ ,/ 然后/ 在/ 备份/ 存储设备/ 执行/ 去/ 冗余/ 操作/ ,/ 如图/ 1/ (/ a/ )/ 所示/ ./ 由于/ 去/ 冗余/ 操作/ 在/ 备份/ 存储设备/ 中/ 执行/ ,/ 不会/ 对/ 主机/ 所/ 托管/ 应用/ 的/ 正常/ 运行/ 产生/ 性能/ 干扰/ ,/ 因此/ ,/ 我们/ 并/ 不/ 关心/ 此/ 策略/ 中/ 去/ 冗余/ 操作/ 的/ 执行/ 时间/ ./ 该/ 策略/ 适用/ 于/ 运行/ 主机/ 资源/ 相对/ 紧张/ 、/ 备份/ 存储设备/ 资源/ 相对/ 充足/ 、/ 网络/ 传输/ 代价/ 相对/ 较/ 低/ 的/ 场景/ ./ (/ 2/ )/ 先/ 去/ 冗余/ 再/ 备份/ 策略/ (/ DBB/ )/ ./ 先/ 在/ 运行/ 主机/ 进行/ 虚拟机/ 镜像/ 去/ 冗余/ ,/ 并/ 将/ 去/ 冗余/ 后/ 的/ 镜像/ 临时/ 存储/ 到/ 运行/ 主机/ 上/ ,/ 再/ 通过/ 网络/ 将/ 去/ 冗余/ 后/ 的/ 镜像/ 传输/ 到/ 备份/ 存储设备/ 进行/ 持久/ 化/ 存储/ ,/ 如图/ 1/ (/ b/ )/ 所示/ ./ 该/ 策略/ 的/ 优点/ 是/ 网络/ 传输/ 和/ 去/ 冗余/ 操作/ 可以/ 分开/ 进行/ ,/ 即/ 可以/ 充分考虑/ 网络/ 负载/ 状况/ 以/ 选择/ 合适/ Page3/ 的/ 网络/ 传输/ 时机/ ./ 因此/ ,/ 该/ 策略/ 适应/ 于/ 运行/ 主机/ 资源/ 相对/ 充足/ 、/ 备份/ 存储设备/ 资源/ 相对/ 紧张/ 、/ 网络/ 传输/ 代价/ 较/ 高/ 的/ 场景/ ./ (/ 3/ )/ 边去/ 冗余/ 边/ 备份/ 策略/ (/ DDB/ )/ ./ 虚拟机/ 镜像/ 在/ 运行/ 主机/ 进行/ 去/ 冗余/ 操作/ ,/ 并/ 将/ 处理/ 后/ 的/ 非/ 冗余/ 图/ 1/ 去/ 冗余/ 备份/ 策略/ 示例/ 2.2/ 研究/ 动机/ 我们/ 所/ 提出/ 的/ 虚拟机/ 镜像/ 备份/ 策略/ 的/ 基本/ 思想/ 是/ :/ 由于/ 不同/ 的/ 虚拟机/ 镜像/ 备份/ 策略/ 具有/ 不同/ 的/ 资源/ 需求/ ,/ 所以/ 综合/ 考虑/ 各/ 虚拟机/ 运行/ 环境/ ,/ 选择/ 特定/ 的/ 备份/ 组合/ 策略/ ,/ 可以/ 缩短/ 镜像/ 备份/ 时间/ ./ 而/ 该/ 思想/ 成立/ 的/ 前提条件/ 是/ :/ 不同/ 的/ 策略/ 适合/ 不同/ 的/ 应用/ 场景/ ,/ 策略/ 的/ 选择/ 会/ 影响/ 备份/ 时间/ ./ 这里/ ,/ 我们/ 设计/ 了/ 简单/ 的/ 实验/ 来/ 验证/ 我们/ 思想/ 的/ 合理性/ ./ 实验/ 采用/ 了/ 4/ 台/ 物理/ 机和/ 3/ 个/ 虚拟机/ 镜像/ ,/ 其中/ 3/ 台/ 物理/ 机/ (/ PM1/ ,/ PM2/ ,/ PM3/ )/ 组成/ 备份/ 客户端/ 集群/ ,/ 一台/ 物理/ 机/ (/ PM4/ )/ 作为/ 备份/ 服务器端/ ./ 每台/ 服务器/ 拥有/ 一个/ 500GBSATA/ 硬盘/ ,/ 一颗/ Intel/ (/ R/ )/ Core/ (/ TM/ )/ i7/ -/ 2600CPU/ ,/ 4GB/ 内存/ 和/ 一个/ Intel/ (/ R/ )/ 82579LM/ 网卡/ ./ 3/ 个/ 虚拟机/ 镜像/ 的/ 原始/ 大小/ 如表/ 1/ 所示/ ,/ 分别/ 放置/ 到/ PM1/ 、/ PM2/ 和/ PM3/ 上/ ,/ 实验/ 过程/ 中/ 我们/ 将/ 3/ 个/ 虚拟机/ 镜像/ 备份/ 到/ PM4/ 上/ ./ 每个/ 镜像/ 有/ 3/ 种/ 不同/ 的/ 策略/ 选择/ ,/ 因此/ ,/ 共有/ 33/ 种/ 不同/ 组合/ 策略/ ./ 为了/ 便于/ 数据/ 块/ 通过/ 网络/ 实时/ 地/ 传输/ 到/ 备份/ 存储设备/ 进行/ 存储/ ./ 与/ 先/ 去/ 冗余/ 再/ 备份/ 策略/ 相比/ ,/ 该/ 策略/ 少/ 了/ 中间/ 存储/ 的/ 环节/ ,/ 因此/ 在/ 一般/ 情况/ 下/ 处理速度/ 更/ 快/ ,/ 如图/ 1/ (/ c/ )/ 所示/ ./ 这种/ 策略/ 适用/ 于/ 运行/ 主机/ CPU/ 和/ 内存/ 资源/ 相对/ 充足/ 、/ 网络/ 传输/ 代价/ 相对/ 较/ 高/ 的/ 场景/ ./ 分析/ 问题/ ,/ 我们/ 采用/ 完全/ 内存/ 去/ 冗余/ 方法/ 以/ 避免/ 索引/ 查找/ 过程/ 中/ 可能/ 出现/ 的/ 磁盘/ 瓶颈/ 问题/ ./ VM1VM2VM3/ 我们/ 首先/ 测试/ 单纯/ 采用/ DDB/ 组合/ 策略/ 的/ 虚拟机/ 镜像/ 备份/ 时间/ ./ 在/ 此次/ 测试/ 中/ ,/ 我们/ 设置/ 了/ 两种/ 备份/ 模式/ :/ 顺序/ 模式/ 和/ 并发/ 模式/ ./ 顺序/ 模式/ 是/ 指/ 虚拟机/ 镜像/ 按/ 顺序/ 依次/ 进行/ 备份/ ,/ 在/ 上/ 一个/ 备份/ 任务/ 结束/ 时/ 再/ 进行/ 下/ 一个/ 镜像/ 的/ 备份/ ./ 并发/ 模式/ 是/ 指/ 几个/ 虚拟机/ 镜像/ 备份/ 任务/ 同时/ 开始/ ./ 图/ 2/ 所示/ 为/ 在/ 不同/ 模式/ 和/ 组合/ 策略/ 下/ 的/ 备份/ 时间/ ,/ 图中/ “/ obo/ ”/ 代表/ 顺序/ 模式/ 而/ “/ sim/ ”/ 代表/ 并发/ 模式/ ./ 在/ 顺序/ 模式/ 中/ ,/ 我们/ 先/ 备份/ VM1/ ,/ 由于/ PM1/ 磁盘/ 读写/ 速度/ 的/ 限制/ ,/ 该/ 备份/ 过程/ 的/ 瓶颈/ 在/ 数据/ 块/ 指纹/ 计算/ 方面/ ,/ 该/ 虚拟机/ 镜像/ Page4/ 备份/ 共/ 消耗/ 186s/ ;/ 之后/ 备份/ VM2/ ,/ 此时/ 备份/ 瓶颈/ 与/ VM1/ 相同/ ,/ 此/ 镜像/ 备份/ 中共/ 消耗/ 208s/ ;/ 当/ VM3/ 备份/ 时/ ,/ 由于/ 备份/ 后/ 镜像/ 大小/ 与/ 镜像/ 原始/ 大小/ 相近/ ,/ 该/ 备份/ 过程/ 的/ 瓶颈/ 在/ 网络/ 传输/ 模块/ ,/ VM3/ 备份/ 共/ 消耗/ 649s/ ./ 3/ 个/ 虚拟机/ 镜像/ 备份/ 消耗/ 总/ 时间/ 为/ 1043s/ ./ 在/ 并发/ 模式/ 下/ ,/ 我们/ 同时/ 备份/ 3/ 个/ 虚拟机/ 镜像/ ,/ 在/ 这种/ 情况/ 下/ ,/ 很难/ 确定/ 瓶颈/ 资源/ ./ 且/ 由于/ 3/ 个/ 镜像/ 同时/ 备份/ ,/ 在/ 备份/ 存储设备/ 端/ 存在/ 磁盘/ 并发/ 写/ 冲突/ ./ 在/ 这种/ 模式/ 下/ ,/ 总/ 备份/ 时间/ 为/ 926s/ ,/ 这/ 表明/ 并发/ 模式/ 可以/ 加速/ 备份/ 过程/ ./ 接下来/ ,/ 我们/ 测试/ 并发/ 模式/ 下/ 两组/ 备份/ 策略/ 组合/ ./ 组合/ 策略/ 1/ (/ 图/ 2/ 中/ 的/ mix1/ )/ :/ DDB/ 备份/ VM1/ ,/ DBB/ 备份/ VM2/ ,/ DAB/ 备份/ VM3/ ;/ 组合/ 策略/ 2/ (/ 图/ 2/ 中/ 的/ mix2/ )/ :/ DBB/ 备份/ VM1/ 和/ VM2/ ,/ DDB/ 备份/ VM3/ ./ 组合/ 策略/ 1/ 虚拟机/ 镜像/ 备份/ 消耗/ 时间/ 为/ 894s/ ./ 组合/ 策略/ 2/ 虚拟机/ 镜像/ 备份/ 消耗/ 时间/ 为/ 861s/ ./ 以上/ 实验/ 结果表明/ ,/ 虚拟机/ 镜像/ 备份/ 时间/ 随/ 组合/ 策略/ 不同/ 而/ 不同/ ,/ 因此/ ,/ 我们/ 可以/ 通过/ 组合/ 备份/ 策略/ 来/ 加速/ 镜像/ 去/ 冗余/ 备份/ 过程/ ,/ 从而/ 验证/ 了/ 本文/ 研究/ 思路/ 的/ 合理性/ 和/ 可行性/ ./ 3/ 去/ 冗余/ 备份/ 时间/ 模型/ 本文/ 工作/ 的/ 目标/ 是/ 探索/ 一种/ 有效/ 的/ 备份/ 组合/ 策略/ 方法/ ,/ 用于/ 加速/ 去/ 冗余/ 备份/ 过程/ ./ 为/ 解决/ 这个/ 问题/ ,/ 需要/ 建立/ 资源/ 和/ 任务/ 之间/ 的/ 关联/ 关系/ 模型/ ./ 我们/ 将/ 复杂/ 的/ 备份/ 过程/ 分解/ 为/ 若干/ 简单/ 子/ 任务/ ./ 不同/ 策略/ 中/ ,/ 每个/ 子/ 任务/ 的/ 资源/ 需求/ 和/ 执行/ 顺序/ 也/ 不尽相同/ ./ 我们/ 需要/ 分析/ 不同/ 策略/ 下/ 子/ 任务/ 的/ 执行/ 顺序/ ,/ 建立/ 特定/ 资源/ 约束/ 下/ 子/ 任务/ 的/ 处理/ 时间/ 模型/ ./ 之后/ 找出/ 整个/ 备份/ 过程/ 中/ 限制/ 备份/ 处理速度/ 的/ 瓶颈/ ,/ 通过/ 分析/ 瓶颈/ 可以/ 估算/ 出/ 整个/ 备份/ 过程/ 的/ 处理/ 时间/ ./ 3.1/ 任务/ 分解/ 在/ 虚拟机/ 镜像/ 备份/ 中/ ,/ 我们/ 采用/ 数据/ 块/ 级别/ 去/ 冗余/ [/ 1/ ,/ 9/ -/ 12/ ]/ 技术/ ,/ 该/ 去/ 冗余/ 备份/ 过程/ 共/ 分为/ 4/ 个/ 不同/ 的/ 子/ 任务/ :/ (/ 1/ )/ 数据/ 指纹/ 计算/ ,/ 将/ 虚拟机/ 镜像/ 划分/ 为/ 不同/ 数据/ 块/ 并/ 计算/ 数据/ 块/ 指纹/ ;/ (/ 2/ )/ 指纹/ 查找/ ,/ 在/ 指纹/ 库中/ 查找/ 数据/ 块/ 指纹/ ,/ 从而/ 判断/ 该/ 数据/ 块/ 是否/ 已/ 存在/ ;/ (/ 3/ )/ 指纹/ 存储/ ,/ 存储/ 新/ 数据/ 块/ 并/ 更新/ 指纹/ 库/ ;/ (/ 4/ )/ 网络/ 传输/ ,/ 将/ 数据/ 块/ 从/ 运行/ 主机/ 发送到/ 备份/ 存储设备/ ./ 在/ 去/ 冗余/ 备份/ 系统/ 中/ ,/ 虚拟机/ 镜像/ 数据/ 块/ 按/ 一定/ 的/ 顺序/ 执行/ 以上/ 子/ 任务/ ./ 不同/ 策略/ 下/ ,/ 数据/ 块/ 执行/ 各个/ 子/ 任务/ 的/ 顺序/ 也/ 不尽相同/ ./ 3.2/ 子/ 任务/ 时间/ 模型/ 在/ 本节/ 中/ ,/ 我们/ 将/ 分析/ 不同/ 策略/ 中子/ 任务/ 执行/ 的/ 先后顺序/ ,/ 建立/ 子/ 任务/ 处理/ 时间/ 模型/ ./ 3.2/ ./ 1/ 数据/ 指纹/ 计算/ 子/ 任务/ 数据/ 指纹/ 计算/ 子/ 任务/ 由/ 两种/ 资源/ 敏感/ 型/ 操作/ 组成/ :/ 原始/ 镜像/ 读取/ 和/ 数据/ 块/ 指纹/ 计算/ ./ 前者/ 用于/ 将/ 镜像/ 数据/ 块/ 加载/ 到/ 内存/ ,/ 该/ 操作/ 是/ I/ // O/ 敏感/ 型/ 操作/ ,/ 我们/ 用/ Sr/ 表示/ 镜像/ 最快/ 读取/ 速度/ ,/ 后者/ 用于/ 计算/ 数据/ 块/ 指纹/ ,/ 该/ 操作/ 是/ CPU/ 敏感/ 型/ 操作/ ,/ 我们/ 用/ Sc/ 表示/ 指纹/ 计算/ 的/ 最大/ 处理速度/ ./ 在/ DAB/ 策略/ 中/ ,/ 这个/ 子/ 任务/ 在/ 备份/ 服务器端/ 执行/ ,/ 而/ 在/ DBB/ 策略/ 和/ DDB/ 策略/ 中/ ,/ 这个/ 子/ 任务/ 在/ 备份/ 客户端/ 执行/ ./ 3.2/ ./ 2/ 指纹/ 查找/ 子/ 任务/ 指纹/ 查找/ 任务/ 是/ 内存/ 敏感/ 型/ 操作/ ,/ 我们/ 用/ Sm/ 表示/ 指纹/ 查找/ 子/ 任务/ 的/ 最快/ 处理速度/ ./ 在/ DAB/ 策略/ 中/ ,/ 指纹/ 查找/ 子/ 任务/ 在/ 备份/ 服务器端/ 执行/ ,/ 而/ 在/ DBB/ 策略/ 和/ DDB/ 策略/ 中/ ,/ 指纹/ 查找/ 子/ 任务/ 在/ 备份/ 客户端/ 执行/ ./ 3.2/ ./ 3/ 数据/ 块/ 存储/ 子/ 任务/ 数据/ 块/ 存储/ 子/ 任务/ 是/ I/ // O/ 敏感/ 型子/ 任务/ ,/ 该/ 任务/ 的/ 处理速度/ 主要/ 取决于/ 服务器端/ 磁盘/ 写/ 速度/ ,/ 我们/ 用/ Ss/ 表示/ 数据/ 块/ 存储/ 子/ 任务/ 的/ 最快/ 处理速度/ ./ 在/ 3/ 种/ 策略/ 中/ ,/ 数据/ 块/ 存储/ 子/ 任务/ 均/ 在/ 备份/ 服务器端/ 执行/ ./ 由于/ 在/ DBB/ 策略/ 中/ 数据/ 块/ 需要/ 在/ 备份/ 客户端/ 进行/ 临时/ 存储/ ,/ 我们/ 用/ Sw/ 表示/ 备份/ 客户端/ 最大/ 临时/ 写/ 速度/ ./ 3.2/ ./ 4/ 网络/ 传输/ 子/ 任务/ 网络/ 传输/ 子/ 任务/ 是/ 网络/ I/ // O/ 敏感/ 型/ 任务/ ,/ 用于/ 将/ 虚拟机/ 镜像/ 从/ 备份/ 客户端/ 传输/ 到/ 备份/ 服务器端/ ,/ 我们/ 用/ Sn/ 表示/ 网络/ 最大/ 传输速度/ ./ 表/ 2/ 所示/ 为/ 3/ 种/ 不同/ 策略/ 子/ 任务/ 执行/ 顺序/ 和/ 最大/ 处理速度/ ,/ 箭头/ 代表/ 子/ 任务/ 的/ 先后顺序/ ./ Page5/ 策略/ DABDBBDDB/ 当/ 多个/ 任务/ 同时/ 备份/ 时/ ,/ 不同/ 任务/ 之间/ 由于/ 资源/ 竞争/ 而/ 产生/ 性能/ 干扰/ ./ 在/ 多/ 客户端/ 备份/ 系统/ 中/ ,/ 共享资源/ 包括/ 网络/ I/ // O/ 资源/ 和/ 备份/ 服务器端/ 磁盘/ I/ // O/ 资源/ ,/ 这/ 就/ 意味着/ Sn/ 和/ Ss/ 是/ 随/ 并发/ 任务/ 数/ 变化/ 而/ 变化/ 的/ ./ 根据/ 观察/ ,/ Sn/ 随/ 任务/ 数/ 增加/ 而/ 线性/ 降低/ ,/ 而/ Ss/ 则/ 非线性/ 变化/ ./ 假设/ 备份/ 服务器端/ 有/ k/ 个/ 并发/ 写/ 任务/ ,/ 我们/ 用/ Ssk/ 务/ 同时/ 使用/ 一条/ 网络/ 通道/ ,/ 不同/ 任务/ 之间/ 根据/ 传输数据/ 量/ 不同/ 而/ 均匀/ 使用/ 网络资源/ ,/ 我们/ 用/ Sn/ 个/ 任务/ 网络/ 传输速度/ ./ DBB/ 中/ 的/ 镜像/ 读/ 操作/ 和/ 临时/ 写/ 操作/ 之间/ 会/ 存在/ 一定/ 的/ 干扰/ ,/ 由于/ 数据中心/ 存储/ 普遍/ 采用/ RAID/ 、/ Cache/ 等/ 技术/ 进行/ 读写/ 加速/ ,/ 该/ 干扰/ 基本/ 可以/ 忽略/ [/ 13/ -/ 14/ ]/ ./ 在/ 实际操作/ 中/ 两者/ 完成/ 时间/ 几乎/ 同步/ ,/ 因此/ 本文/ 模型/ 只/ 计算/ 读/ 操作/ 完成/ 时间/ ./ 以上/ 各个/ 量/ 的/ 取值/ 都/ 可以/ 通过/ 离线/ 测试/ 的/ 方法/ 获得/ ./ 另外/ ,/ k/ ,/ j/ 最大/ 取值/ 也/ 可以/ 通过/ 存储设备/ I/ // O/ 速度/ 和/ 网络/ 通道/ I/ // O/ 速度/ 确定/ ./ 由于/ DAB/ 策略/ 中/ 去/ 冗余/ 操作/ 可以/ 在/ 备份/ 服务器端/ 空闲/ 时/ 进行/ ,/ 因此/ 本文/ 模型/ 中/ 并/ 不/ 关心/ DAB/ 策略/ 中/ 的/ 去/ 冗余/ 操作/ ,/ 即/ 并/ 不/ 关心/ DAB/ 中/ 的/ Sc/ 和/ Sm/ ./ 由于/ DAB/ 策略/ 会/ 对/ 备份/ 服务器/ 负载/ 产生/ 影响/ ,/ 当/ DAB/ 实例/ 超出/ 备份/ 服务器/ 在/ 一个/ 备份/ 周期/ 内/ 的/ 处理/ 能力/ 时/ ,/ 会/ 导致/ 任务/ 无法/ 完成/ 的/ 情况/ 出现/ ./ 在/ 模型/ 中/ ,/ 我们/ 将/ 应用/ DAB/ 策略/ 实例/ 数目/ 限定/ 为/ M/ (/ M/ 取决于/ 备份/ 服务器/ 在/ 一个/ 周期/ 内/ 的/ 最大/ 处理/ 能力/ )/ ,/ 将/ 其/ 控制/ 在/ 备份/ 服务器/ 处理/ 能力/ 范围/ 之内/ ,/ 以/ 避免/ 任务/ 无法/ 完成/ 的/ 情况/ 发生/ ./ 我们/ 用/ T/ 代表/ 虚拟机/ 镜像/ 大小/ ,/ 对于/ 每个/ 虚拟机/ 集群/ C/ ,/ 所有/ 虚拟机/ 镜像/ 总/ 大小/ 为/ ∑/ i/ ∈/ CTi/ ./ 通常/ 情况/ 下/ ,/ 去/ 冗余/ 之后/ 的/ 镜像/ 大小/ 要/ 小于/ 原始/ 镜像/ 大小/ ./ 为了/ 评估/ 备份/ 操作/ 时间/ 开销/ ,/ 我们/ 首先/ 评估/ 备份/ 后/ 镜像/ 大小/ T/ ./ 我们/ 假设/ 虚拟机/ 镜像/ 冗余/ 率为/ r/ ,/ 镜像/ 备份/ 大小/ 可以/ 根据/ 式/ (/ 1/ )/ :/ 通过/ 我们/ 之前/ 工作/ 中/ 的/ 方法/ [/ 15/ ]/ ,/ 我们/ 可以/ 轻易/ 地/ 获得/ r/ 的/ 近似值/ ,/ 集群/ 中/ 所有/ 镜像/ 的/ 总/ 大小/ 为/ ∑/ i/ ∈/ CTi/ ×/ ri/ ./ 3.3/ 备份/ 时间/ 预测/ 我们/ 已经/ 建模/ 了/ 每个/ 子/ 任务/ 的/ 处理/ 数据量/ 和/ 数据处理/ 速度/ ,/ 这样/ 就/ 可以/ 计算/ 子/ 任务/ 的/ 处理/ 时间/ ./ 我们/ 用/ tr/ 代表/ 镜像/ 读取/ 时间/ ,/ tc/ 代表/ 指纹/ 计算/ 时间/ ,/ tm/ 代表/ 索引/ 查找时间/ ,/ tn/ 代表/ 网络/ 传输/ 时间/ ,/ tw/ 代表/ 临时/ 数据/ 块/ 写/ 时间/ ,/ ts/ 代表/ 备份/ 服务器端/ 数据/ 块/ 写/ 时间/ ./ 备份/ 时间/ 取决于/ 最慢/ 的/ 子/ 任务/ ./ 在/ DDB/ 策略/ 中/ ,/ 由于/ 流式/ 数据处理/ ,/ 子/ 任务/ 可以/ 同时/ 进行/ ./ 而/ 在/ DBB/ 策略/ 中/ ,/ 由于/ 非/ 冗余/ 的/ 数据/ 块/ 需要/ 在/ 备份/ 客户端/ 方面/ 进行/ 临时/ 存储/ ,/ 去/ 冗余/ 过程/ 与/ 网络/ 传输/ 过程/ 之间/ 存在/ 一定/ 的/ 时间延迟/ ./ 式/ (/ 2/ )/ 用于/ 计算/ 每种/ 策略/ 的/ 备份/ 时间/ ./ 与/ DAB/ 和/ DDB/ 不同/ ,/ DBB/ 策略/ 的/ 去/ 冗余/ 过程/ 可以/ 使用/ 存储/ 客户端/ 资源/ 而/ 不/ 干扰/ 其他/ 备份/ 任务/ ,/ 因而/ 可以/ 立即/ 开始/ ./ 在/ DAB/ 和/ DDB/ 策略/ 中/ ,/ 仅/ 有/ 部分/ 的/ 任务/ 可以/ 立即/ 开始/ ,/ 其他/ 任务/ 则/ 需要/ 等到/ 这些/ 任务/ 结束/ 时/ 开始/ ./ 表/ 3/ 列出/ 每种/ 策略/ 子/ 任务/ 的/ 处理速度/ 计算公式/ ./ 除此之外/ ,/ 由于/ 指纹/ 保存/ 在/ 备份/ 服务器端/ ,/ 在/ 进行/ 客户端/ 去/ 冗余/ 时/ ,/ 需要/ 将/ 指纹/ 传输/ 到/ 客户端/ ./ 我们/ 采用/ 聚类/ 分组/ 的/ 方式/ 进行/ 去/ 冗余/ [/ 15/ ]/ ,/ 分组/ 的/ 原则/ 是/ 分组/ 内/ 指纹/ 总量/ 不/ 超过/ 可用内存/ 大小/ ./ 在/ 系统/ 规模/ 稳定/ 的/ 情况/ 下/ ,/ 备份/ 客户端/ 镜像/ 数量/ 固定/ ,/ 指纹/ 传输/ 时间/ 可以/ 近似/ 认为/ 是/ 常数/ 时间/ C/ ./ 烄/ max/ (/ tr/ ,/ tn/ ,/ ts/ )/ ,/ 在/ DAB/ 情况/ 下/ max/ (/ tr/ ,/ tn/ ,/ tc/ ,/ tm/ ,/ ts/ )/ ,/ max/ (/ tr/ ,/ tc/ ,/ tm/ ,/ tw/ )/ +/ timedelay/ +/ max/ (/ tn/ ,/ ts/ )/ ,/ t/ =/ 烅/ 烆/ tr/ =/ tn/ =/ tc/ =/ tm/ =/ ts/ =/ tw/ =/ 4/ 基于/ 遗传算法/ 的/ 自/ 适应/ 备份/ 策略/ 通过/ 上文/ 所述/ 模型/ 我们/ 可以/ 预测/ 去/ 冗余/ 备份/ 的/ 处理/ 时间/ ./ 本章/ 将/ 介绍/ 基于/ 遗传算法/ 的/ 自/ 适应/ 备份/ 策略/ ,/ 并/ 将/ 其/ 与/ 贪心/ 算法/ 进行/ 对比/ ./ Page64/ ./ 1/ 基于/ 遗传算法/ 的/ 策略/ 选择/ 我们/ 将/ 从/ 以下/ 5/ 个/ 方面/ 介绍/ 基于/ 遗传算法/ (/ GeneticAlgorithm/ ,/ GA/ )/ 的/ 自/ 适应/ 备份/ 策略/ :/ 编码/ 、/ 交叉/ 算子/ 、/ 变异/ 算子/ 、/ 适应度/ 函数/ 和/ 选择/ 算子/ ./ 编码/ 是/ 将/ 问题/ 解用/ 方便/ 于/ 机器/ 处理/ 的/ 格式/ 进行/ 描述/ ,/ 算法/ 的/ 执行/ 过程/ 是/ 对/ 问题/ 解/ 编码/ 的/ 操作过程/ ./ 交叉/ 算子/ 和/ 变异/ 算子/ 模拟/ 了/ 生物进化/ 过程/ 中/ 的/ 杂交/ 和/ 变异/ 过程/ ,/ 用于/ 迭代/ 生成/ 新一代/ 的/ 种群/ 个体/ ./ 适应度/ 函数/ 是/ 对/ 种群/ 个体/ 优良/ 程度/ 的/ 一种/ 评估/ ,/ 即/ 对/ 问题/ 解/ 优劣/ 的/ 评估/ ./ 选择/ 算子/ 的/ 目的/ 是/ 选择/ 较为/ 优良/ 的/ 个体/ 进行/ 进一步/ 迭代/ 处理/ ./ 算法/ 在/ 每/ 一次/ 迭代/ 中/ 通过/ 以上/ 几种/ 算子/ 的/ 操作/ 生成/ 新/ 个体/ 和/ 选择/ 优秀/ 个体/ ,/ 直到/ 满足条件/ 的/ 个体/ 出现/ ./ 4.1/ ./ 1/ 面向对象/ 编码/ 遗传算法/ 是/ 一种/ 通过/ 模拟/ 自然/ 进化/ 过程/ 搜索/ 最优/ 解/ 的/ 方法/ ,/ 问题/ 解用/ “/ 染色体/ ”/ 表示/ ,/ 染色体/ 是/ 由/ “/ 基因/ ”/ 编码/ 组成/ 的/ ./ 编码/ 通常/ 是/ 由/ 字符串/ 或/ 数字/ 组成/ ./ 我们/ 的/ 问题/ 中有/ 3/ 个/ 优化/ 目标/ ,/ 这/ 3/ 个/ 目标/ 是/ 非对称/ 的/ (/ 即/ 在/ 染色体/ 中/ 一个/ 优化/ 目标/ 编码/ 是/ 唯一/ 的/ ,/ 另外/ 两个/ 优化/ 目标/ 编码/ 则/ 是/ 可/ 重复/ 的/ )/ ./ 单纯/ 的/ 字符串/ 和/ 数字编码/ 无法/ 实现/ 此/ 目标/ ./ 为/ 解决/ 这个/ 问题/ ,/ 我们/ 提出/ 了/ 面向对象/ 的/ 编码方式/ ,/ 用/ 对象/ 表示/ 一个/ 基因/ 编码/ ./ 一个/ 基因/ 编码/ 代表/ 一个/ 备份/ 任务/ 线程/ ./ 基因/ 对象/ 有/ 3/ 个/ 不同/ 属性/ ,/ 分别/ 代表/ 任务/ 顺序/ (/ sequence/ )/ 、/ 任务/ 策略/ (/ strategy/ )/ 和/ 网络/ 通道/ (/ taskQueue/ )/ ./ 其中/ sequence/ 值/ 在/ 染色体/ 中是/ 唯一/ 的/ ,/ 而/ strategy/ 和/ taskQueue/ 值则/ 可/ 重复/ ./ 图/ 3/ 为/ 染色体/ 示例/ ./ 图/ 3/ 中/ 矩形框/ 代表/ 一个/ 基因/ ,/ 矩形框/ 中/ 的/ 字符/ 代表/ 属性/ ./ 下划线/ 前/ 的/ 第一个/ 数字/ 代表/ sequence/ 属性/ ,/ 下划线/ 后/ 的/ 字母/ 代表/ strategy/ 属性/ ./ 其中/ ‘/ A/ ’/ 代表/ DAB/ 策略/ ,/ ‘/ B/ ’/ 代表/ DBB/ 策略/ ,/ ‘/ D/ ’/ 代表/ DDB/ 策略/ ./ 字母/ 后面/ 的/ 数字/ 代表/ taskQueue/ 属性/ ./ 4.1/ ./ 2/ 交叉/ 算子/ 交叉/ 算子/ 用于/ 生成/ 新/ 的/ 染色体/ ,/ 该/ 算子/ 的/ 操作数/ 是/ 一对/ 已/ 存在/ 的/ 染色体/ ./ 这对父/ 染色体/ 交换/ 各自/ 的/ 基因/ 片段/ 生成/ 子/ 染色体/ ./ 图/ 4/ 所示/ 为/ 交叉/ 算子/ 操作过程/ ,/ ‘/ P1/ ’/ 和/ ‘/ P2/ ’/ 代表/ 两个/ 父/ 染色体/ ,/ 而/ ‘/ S1/ ’/ 和/ ‘/ S2/ ’/ 代表/ 两个/ 子/ 染色体/ ./ 基因/ 片段/ 交换/ 可能/ 导致/ sequence/ 属性/ 值/ 重复/ ,/ 为/ 保障/ sequence/ 值/ 的/ 唯一性/ ./ 我们/ 需要/ 交换/ 交叉点/ 所在/ 基因/ 位点/ 的/ 重复/ 值/ 和/ 原始/ 值/ ./ 例如/ ,/ 图/ 4/ 中/ ‘/ P1/ ’/ 的/ 基因/ ‘/ 2/ _/ D1/ ’/ 与/ ‘/ P2/ ’/ 的/ 基因/ ‘/ 0/ _/ A1/ ’/ 进行/ 交换/ ,/ 其中/ ‘/ 0/ _/ A1/ ’/ 中/ 的/ 顺序/ 属性/ 值为/ ‘/ 0/ ’/ ./ 然而/ P1/ 中/ 的/ 一个/ 基因/ ‘/ 0/ _/ D3/ ’/ 的/ 顺序/ 属性/ 值/ 同样/ 为/ ‘/ 0/ ’/ ./ 因此/ ,/ 我们/ 将/ ‘/ P1/ ’/ 中/ 位点/ 的/ 顺序/ 属性/ ‘/ 2/ ’/ 与/ ‘/ 0/ ’/ 进行/ 交换/ ./ 此时/ ,/ ‘/ S1/ ’/ 中/ 基因/ 变为/ ‘/ 2/ _/ D3/ ’/ ./ 而/ 基因/ 中/ 另外/ 两个/ 属性/ 值/ 是/ 可/ 重复/ 的/ ,/ 因此/ ,/ 我们/ 在/ 基因/ 交换/ 过程/ 中/ 并/ 不/ 对/ 其/ 进行/ 干涉/ ./ 4.1/ ./ 3/ 变异/ 算子/ 变异/ 算子/ 用于/ 由/ 单个/ 父/ 染色体/ 生成/ 新/ 的/ 染色体/ ./ 首先/ ,/ 随机/ 选择/ 一个/ 基因/ 位点/ ,/ 将/ 其/ 属性/ 值/ 在/ 各自/ 取值/ 范围/ 内/ 进行/ 变异/ ./ 对于/ sequence/ 属性/ ,/ 随机/ 赋予/ 一个/ 小于/ 染色体/ 长度/ 的/ 值/ ;/ 对于/ taskQueue/ 属性/ ,/ 随机/ 赋予/ 一个/ 网络/ 通道/ 数/ 范围/ 之内/ 的/ 值/ ;/ 而/ 对于/ strategy/ 属性/ ,/ 随机/ 赋予/ ‘/ A/ ’/ ,/ ‘/ B/ ’/ ,/ ‘/ D/ ’/ 中/ 的/ 一个/ 字符/ ./ 图/ 5/ 所示/ 为/ 变异/ 算子/ 操作过程/ ./ 图/ 5/ 中/ ‘/ 7/ _/ B1/ ’/ 变异/ 为/ ‘/ 2/ _/ A1/ ’/ ./ 同/ 交叉/ 算子/ 相同/ ,/ sequence/ 属性/ 值/ 在/ 染色体/ 中为/ 唯一/ 值/ ,/ 变异/ 之后/ 同样/ 需要/ 进行/ 交换/ ./ 4.1/ ./ 4/ 适应度/ 函数/ 适应度/ 函数/ 是/ 遗传算法/ 中/ 的/ 重要/ 函数/ ,/ 用于/ 评价/ 染色体/ 所/ 代表/ 问题/ 解/ 的/ 优劣/ ./ 本文/ 中/ ,/ 我们/ 用/ 预测/ 的/ 去/ 冗余/ 备份/ 时间/ 作为/ 适应度/ 函数/ 的/ 值/ ./ 每个/ 备份/ 线程/ 的/ 备份/ 时间/ δ/ t/ 可以/ 通过/ 式/ (/ 2/ )/ 计算/ ./ 对于/ 每个/ 备份/ 任务/ ,/ 其/ 开始/ 时间/ 记为/ st/ ,/ 则/ 结束/ 时间/ 可以/ 通过/ 公式/ et/ =/ st/ +/ δ/ t/ 计算/ ./ 适应度/ 函数/ 的/ 值/ 等于/ 最后/ 一个/ 备份/ 任务/ 的/ 结束/ 时间/ et/ 与/ 第/ 1/ 个/ 线程/ 的/ 开始/ 时间/ st/ 之差/ ./ 4.1/ ./ 5/ 选择/ 算子/ 选择/ 算子/ 用于/ 从/ 种群/ 中/ 选择/ 优秀/ 个体/ ./ 算法/ 首先/ 按照/ 适应度/ 函数/ 对/ 当前/ 种群/ 中/ 的/ 染色体/ 进行/ 排序/ ./ 之后/ 选择/ 当前/ 种群/ 中/ 的/ 前/ n/ 个/ 染色体/ ,/ 并/ 将/ 其/ 保留/ 到/ 下一代/ 种群/ 中/ ,/ 当前/ 种群/ 中/ 其他/ 染色体/ 则/ 被/ Page7/ 丢弃/ ./ 算法/ 1/ 给出/ 了/ 策略/ 选择/ 算法/ 的/ 伪/ 代码/ ./ 算法/ 输入/ 包括/ 任务/ 数/ n/ ,/ 网络/ 通道/ 数/ m/ ,/ 种群/ 大小/ p/ ,/ 选择/ 、/ 交叉/ 、/ 变异/ 个体/ 的/ 比例/ 为/ α/ 、/ β/ 、/ γ/ ./ 算法/ 输出/ 为/ 染色体/ 编码/ 而成/ 的/ 近似/ 最优/ 解/ c/ ./ 算法/ 第/ 1/ 行/ 初始化/ 第一代/ 染色体/ ./ 之后/ 开始/ 算法/ 迭代/ 过程/ ./ 第/ 3/ 行中/ 的/ B/ 代表/ 当前/ 种群/ 的/ 精英/ 个体/ 集合/ ,/ S/ 代表/ 通过/ 交叉/ 算子/ 生成/ 的/ 个体/ 集合/ ,/ T/ 代表/ 通过/ 变异/ 算子/ 生成/ 的/ 个体/ 集合/ ./ 算法/ 第/ 4/ 行是/ 选择/ 算子/ 操作过程/ ./ 第/ 5/ ~/ 9/ 行是/ 交叉/ 算子/ 操作过程/ ./ 第/ 10/ ~/ 13/ 行是/ 变异/ 算子/ 操作过程/ ./ 第/ 14/ 行中/ B/ ,/ S/ ,/ T/ 集合/ 共同/ 组成/ 下一代/ 种群/ ./ 第/ 15/ 行中/ 算法/ 终止/ 条件/ 可以/ 为/ 达到/ 一定/ 的/ 迭代/ 次数/ 结束/ 或/ 种群/ 中/ 优秀/ 个体/ 的/ 适应度/ 值/ 不再/ 发生变化/ 结束/ [/ 16/ ]/ 等/ ./ 第/ 16/ 行中/ 按照/ 适应度/ 函数/ 值/ 对/ 种群/ 中/ 个体/ 进行/ 排序/ ./ 第/ 17/ ~/ 18/ 行/ 返回/ 适应度/ 最高/ 的/ 个体/ ./ 算法/ 1/ ./ 策略/ 选择/ 遗传算法/ ./ 输入/ :/ 备份/ 客户端/ 数/ n/ ,/ 任务/ 队列/ 数/ m/ ,/ 种群/ 大小/ p/ ,/ 选/ 输出/ :/ 近似/ 解/ c1/ ./ Initialize/ (/ pool/ ,/ p/ )/ 2/ ./ REPEAT3/ ./ B/ ←/ S/ ←/ T/ ←/ / 4/ ./ B/ ←/ selection/ (/ pool/ ,/ α/ )/ 5/ ./ FORi/ =/ 1TO/ β/ ×/ p/ // 2DO6/ ./ x/ ←/ rand/ (/ )/ 7/ ./ y/ ←/ rand/ (/ )/ 8/ ./ S/ ←/ S/ ∪/ crossover/ (/ best/ ,/ x/ ,/ y/ )/ 9/ ./ ENDFOR10/ ./ FORi/ =/ 1TO/ γ/ ×/ pDO11/ ./ x/ ←/ rand/ (/ )/ 12/ ./ T/ ←/ T/ ∪/ {/ mutation/ (/ best/ ,/ x/ )/ }/ 13/ ./ ENDFOR14/ ./ pool/ ←/ B/ ∪/ S/ ∪/ T15/ ./ UNTILcondition16/ ./ sort/ (/ pool/ )/ 17/ ./ c/ ←/ pool/ [/ 0/ ]/ 18/ ./ RETURNc4/ ./ 2/ 解/ 空间/ 分析/ 本节/ 中/ 我们/ 将/ 分析/ 问题/ 解/ 空间/ ,/ 并/ 给出/ 选择/ 遗传算法/ 解决问题/ 的/ 原因/ ./ 4.2/ ./ 1/ 解/ 空间/ 大小/ 如前/ 文/ 所述/ ,/ 我们/ 知道/ 对于/ 所有/ 任务/ 而言/ 有/ 3/ 种/ 不同/ 的/ 备份/ 策略/ 可/ 供选择/ ./ 每个/ 任务/ 只能/ 选择/ 唯一/ 一种/ 策略/ ,/ 假设/ 有/ n/ 个/ 不同/ 的/ 任务/ ,/ 则/ 有/ 3n/ 种/ 不同/ 的/ 选择/ ./ 如果/ 有/ m/ 条/ 不同/ 的/ 网络/ I/ // O/ 通道/ 用于/ 连接/ 客户端/ 和/ 服务器端/ ,/ 则/ 每个/ 任务/ 有/ m/ 条/ 不同/ 网络/ 通道/ 可/ 供选择/ ,/ 即/ 有/ mn/ 种/ 不同/ 的/ 选择/ ./ 除此之外/ ,/ 尽管/ 备份/ 系统/ 是/ 分布式/ 的/ ,/ 并/ 不是/ 所有/ 的/ 备份/ 任务/ 可以/ 同时/ 进行/ ./ 因此/ ,/ 我们/ 需要/ 安排/ 每个/ 任务/ 的/ 顺序/ ./ 这个/ 问题/ 类似/ 于/ 旅行/ 商/ 问题/ (/ TravellingSalesmanProblem/ ,/ TSP/ )/ ,/ 其/ 选择/ 空间/ 大小/ 为/ 节点/ 数/ 的/ 阶乘/ ./ 因此/ ,/ 策略/ 选择/ 问题/ 的/ 解/ 空间/ 的/ 大小/ 为/ (/ 3m/ )/ n/ ×/ n/ !/ ./ 4.2/ ./ 2/ 可选/ 算法/ 组合/ 优化/ 问题/ 的/ 求解/ 方法/ 可以/ 分成/ 两大类/ ,/ 即/ 精确/ 方法/ (/ 如/ 线性规划/ 、/ 动态/ 规划/ 等/ )/ 和/ 启发式/ 方法/ (/ 如/ 贪心/ 算法/ 、/ 遗传算法/ 和/ 模拟退火/ 算法/ 等/ )/ ./ 为/ 避免/ 组合/ 爆炸/ 问题/ ,/ 在/ 这种/ 时间/ 和/ 空间/ 复杂度/ 下/ ,/ 一切/ 精确/ 算法/ 都/ 显得/ 无能为力/ ./ 因此/ ,/ 在/ 本文/ 中/ 我们/ 用/ 遗传算法/ 解决/ 此/ 问题/ ./ 遗传算法/ 通过/ 模拟/ 自然选择/ 的/ 过程/ 实现/ 启发式/ 搜索/ ./ 遗传算法/ 共有/ 3/ 种/ 重要/ 算子/ :/ 选择/ 算子/ ,/ 变异/ 算子/ 和/ 交叉/ 算子/ ./ 变异/ 算子/ 和/ 交叉/ 算子/ 用于/ 生成/ 下一代/ 染色体/ ./ 选择/ 算子/ 用于/ 根据/ 适应度/ 函数/ 从/ 当前/ 种群/ 中/ 选择/ 优秀/ 个体/ ./ 所有/ 这些/ 算子/ 都/ 建立/ 在/ 问题/ 解/ 的/ 合理/ 编码/ 上/ ./ 策略/ 选择/ 问题/ 有/ 3/ 个/ 优化/ 目标/ ./ 第/ 1/ 个/ 目标/ 用于/ 决定/ 任务/ 顺序/ ;/ 第/ 2/ 个/ 目标/ 用于/ 为/ 每个/ 任务/ 选择/ 特定/ 的/ 策略/ ;/ 第/ 3/ 个/ 目标/ 用于/ 为/ 每个/ 指定/ 网络/ I/ // O/ 通道/ ./ 为/ 实现/ 这/ 几个/ 优化/ 目标/ 我们/ 在/ 解决方案/ 中/ 采用/ 面向对象/ 编码/ ./ 为了/ 与/ 遗传算法/ 进行/ 对比/ ,/ 以/ 验证/ 其/ 有效性/ ,/ 我们/ 同样/ 实现/ 了/ 解决/ 此/ 问题/ 的/ 贪心/ 算法/ ./ 贪心/ 算法/ 采用/ 与/ 遗传算法/ 相同/ 的/ 问题/ 解/ 编码/ ./ 算法/ 2/ 为/ 贪心/ 算法/ 的/ 实现/ 过程/ ./ 在/ 算法/ 每次/ 循环/ 中/ ,/ 遍历/ 所有/ 未非/ 分配/ 的/ 备份/ 客户端/ ,/ 为/ 其/ 分配/ 所有/ 可能/ 的/ 策略/ 和/ 任务/ 队列/ ,/ 找出/ 当前/ 步骤/ 中/ 最优/ 的/ 策略/ 配置/ ,/ 直到/ 所有/ 的/ 备份/ 客户端/ 都/ 分配/ 完/ ./ 算法/ 2/ ./ 策略/ 选择/ 贪心/ 算法/ ./ 输入/ :/ 备份/ 客户端/ X/ 输出/ :/ 近似/ 解/ C1/ ./ U/ ←/ X2/ ./ C/ ←/ / 3/ ./ WHILEU/ ≠/ / DO4/ ./ selectc/ (/ strategy/ ,/ taskQueue/ )/ ∈/ Uthatminimizes5/ ./ U/ ←/ U/ -/ c6/ ./ C/ ←/ C/ ∪/ {/ c/ }/ 7/ ./ ENDWHILE8/ ./ RETURNCPage85/ 实验/ 验证/ 5.1/ 实验/ 设置/ 为/ 验证/ 本文/ 工作/ 的/ 有效性/ ,/ 本文/ 中/ 实验/ 采用/ 的/ 数据/ 集选自/ 真实/ 云/ 计算环境/ OnceCloud/ ①/ 平台/ 中/ 的/ 100/ 个/ 虚拟机/ 镜像/ 备份/ ./ 这些/ 镜像/ 隶属于/ 10/ 台/ 不同/ 的/ 刀片/ 服务器/ ./ 表/ 4/ 所示/ 为/ 实验/ 采用/ 的/ 不同/ 镜像/ 的/ 种类/ 与/ 数量/ ./ 物理/ 机/ 的/ 本地/ 存储/ 存放/ 虚拟机/ 镜像/ ,/ 备份/ 存储设备/ 采用/ 磁盘阵列/ ./ 每台/ 刀片/ 服务器/ 拥有/ 两颗/ IntelXeonE5645CPU/ ,/ 32GB/ 内存/ ,/ 两块/ 300GB7200RPMSATA/ 硬盘/ 组成/ RAID0/ ./ 磁盘/ 读/ 速度/ 为/ 300MB/ // s/ ./ 磁盘阵列/ 拥有/ 12/ 块/ 3TB10000RPMSCSI/ 硬盘/ 组成/ RAID5/ ./ 共有/ 4/ 条/ 千兆/ 网络/ 通道/ 连接/ 运行/ 主机/ 和/ 备份/ 存储/ ./ 每条/ 网络/ 通道/ 速度/ 可以/ 达到/ 120MB/ // s/ ./ 每个/ 镜像/ 备份/ 大小/ 在/ 20GB/ ~/ 30GB/ 之间/ ,/ 镜像/ 总/ 大小/ 为/ 2.8/ TB/ ./ 每个/ 镜像/ 中约/ 有/ 40/ %/ ~/ 90/ %/ 的/ 数据/ 重复/ ./ 在/ 一周/ 时间/ 内/ 我们/ 每天/ 对/ 这些/ 镜像/ 进行/ 备份/ ,/ 每日/ 备份/ 数据量/ 约/ 为/ 1TB/ ./ 图/ 6/ 所示/ 为/ 实验/ 网络拓扑/ 图/ ./ 实验/ 中/ 采用/ 的/ 备份/ 周期/ 为/ 1d/ (/ 24h/ )/ ,/ DAB/ 策略/ 实例/ 数目/ 限定/ 为/ 5/ (/ 即/ M/ =/ 5/ )/ ./ 我们/ 实现/ 了/ 包括/ DAB/ ,/ DBB/ ,/ DDB/ 等/ 3/ 种/ 不同/ 备份/ 策略/ ./ 对于/ DAB/ ,/ 其去/ 冗余/ 过程/ 可以/ 在/ 系统/ 的/ 任意/ 系统/ 负载/ 较/ 低时/ 执行/ ,/ 因此/ 在/ 实验/ 中/ 我们/ 并/ 不/ 计算/ 去/ 冗余/ 过程/ 的/ 时间/ ./ 5.2/ 模型/ 准确性/ 在/ 该/ 实验/ 中/ ,/ 我们/ 验证/ 去/ 冗余/ 备份/ 模型/ 预测/ 的/ 准确性/ ./ 我们/ 用/ 模型/ 预测/ 给定/ 策略/ 下/ 虚拟机/ 镜像/ 日常/ 备份/ 操作/ 时间/ ./ 之后/ 将/ 预测/ 时间/ 和/ 真实/ 备份/ 时间/ 进行/ 对比/ ./ 每天/ 备份/ 中/ 我们/ 测试/ 两种/ 不同/ 组合/ 策略/ ./ 表/ 5/ 所示/ 为/ 策略/ 组合/ 1/ 、/ 2/ 中/ 采用/ 不同/ 策略/ 的/ 镜像/ 数目/ ./ 实验/ 结果/ 如图/ 7/ 所示/ ,/ 图中/ x/ 轴/ 代表/ 日期/ 代表/ 第/ x/ 天/ ,/ y/ 轴/ 代表/ 每日/ 备份/ 时间/ ./ 图/ 中共/ 有/ 4/ 个/ 图例/ :/ “/ 预测/ 1/ ”/ 和/ “/ 真实/ 1/ ”/ 、/ “/ 预测/ 2/ ”/ 和/ “/ 真实/ 2/ ”/ ,/ 分别/ 代表/ 第/ 1/ 种/ 组合/ 策略/ 下/ 模型/ 预测/ 时间/ 组合/ 策略/ 和/ 真实/ 备份/ 操作/ 时间/ 、/ 第/ 2/ 种/ 组合/ 策略/ 下/ 模型/ 预测/ 时间/ 组合/ 策略/ 和/ 真实/ 备份/ 操作/ 时间/ ./ 表/ 5/ 策略/ 组合/ 1/ 、/ 2/ 中/ 采用/ 不同/ 策略/ 的/ 镜像/ 数目/ 镜像/ 类型/ 从图/ 中/ 我们/ 可以/ 看出/ ,/ 模型/ 的/ 预测/ 结果/ 接近/ 真实/ 操作/ 结果/ 组合/ 策略/ ,/ 模型/ 的/ 最大/ 预测/ 误差/ 出现/ 在/ 第/ 1/ 天第/ 2/ 种/ 组合/ 策略/ 为/ 9.9/ %/ ,/ 最小/ 预测/ 误差/ 出现/ 在/ 第/ 7/ 天第/ 1/ 种/ 组合/ 策略/ 为/ 2.5/ %/ ,/ 模型/ 的/ 平均/ 预测/ 误差/ 为/ 4.5/ %/ ./ 我们/ 的/ 模型/ 适用/ 于/ 系统/ 负载/ 相对/ 稳定/ 的/ 情况/ ,/ 真实/ 系统/ 中负载/ 如果/ 发生/ 较大/ 波动/ ,/ 可能/ 对模型/ 准确性/ 预测/ 造成/ 影响/ ,/ 导致/ 误差/ 的/ 产生/ ./ ①/ Oncecloudplatform/ 是/ 中国科学院/ 软件/ 研究所/ 软件工程/ 中/ Page9/ 另外/ ,/ 模型/ 输入/ 中/ 去/ 冗余/ 后/ 数据量/ T/ 是/ 通过/ 采样/ 的/ 方式/ 进行/ 预测/ 的/ ,/ 该/ 过程/ 也/ 会/ 存在/ 一定/ 的/ 统计学/ 误差/ ,/ 对模型/ 预测/ 结果/ 产生/ 影响/ ./ 本节/ 实验/ 结果表明/ 本文/ 中/ 所/ 提出/ 的/ 去/ 冗余/ 备份/ 时间/ 模型/ 在/ 实验/ 环境/ 下/ 具有/ 较/ 高/ 的/ 准确性/ ./ 5.3/ 策略/ 选择/ 算法/ 的/ 有效性/ 本/ 节/ 实验/ 验证/ 策略/ 选择/ 算法/ 的/ 有效性/ ./ 实验/ 选取/ 5/ 种/ 不同/ 组合/ 策略/ 进行/ 对比/ ,/ 比较/ 不同/ 组合/ 策略/ 下/ 的/ 备份/ 操作/ 时间/ ./ 图/ 8/ 表现/ 了/ 不同/ 组合/ 策略/ 下/ 的/ 备份/ 预测/ 时间/ ,/ 图中带/ ☆/ 标记/ 的/ 实线/ 代表/ 单纯/ 由/ DAB/ 策略/ 构成/ 的/ 组合/ 策略/ (/ 即/ DABonly/ )/ 下/ 的/ 预测/ 时间/ ,/ 带/ ○/ 标记/ 的/ 实线/ 代表/ DBBonly/ 策略/ 下/ 的/ 预测/ 时间/ ,/ 带/ ×/ 标记/ 的/ 实线/ 代表/ DDBonly/ 策略/ 下/ 的/ 预测/ 时间/ ,/ 带/ △/ 标记/ 的/ 实线/ 代表/ 根据/ 贪心/ 算法/ 得出/ 的/ 策略/ 的/ 预测/ 时间/ ,/ 带/ □/ 标记/ 的/ 实线/ 代表/ 根据/ 遗传算法/ 得出/ 的/ 策略/ 预测/ 时间/ ./ 如图/ 8/ 所示/ ,/ 在/ 单一/ 策略/ 组合/ 策略/ 中/ ,/ DDBonly/ 策略/ 最/ 节约/ 时间/ ,/ 甚至/ 优于/ 采用/ 贪心/ 算法/ 的/ 混合策略/ ./ 而/ 在/ 混合策略/ 中/ ,/ 基于/ 遗传算法/ 得出/ 的/ 结果/ 优于/ 基于/ 贪心/ 算法/ 得出/ 的/ 结果/ ./ 以/ 第/ 1/ 天/ 结果/ 为例/ ,/ DDBonly/ 组合/ (/ DDB/ 策略/ )/ 的/ 备份/ 预测/ 时间/ 为/ 8988s/ ,/ 根据/ 遗传算法/ (/ GA/ 策略/ )/ 的/ 预测/ 时间/ 为/ 7278s/ ,/ GA/ 策略/ 与/ DDB/ 策略/ 相比/ 可/ 减少/ 23.5/ %/ 的/ 操作/ 时间/ ./ 从图/ 中/ 我们/ 可以/ 看出/ GA/ 策略/ 可以/ 缩短/ 17.3/ %/ ~/ 23.5/ %/ 的/ 备份/ 时间/ ,/ 这是/ 由于/ 在/ 同一/ 时刻/ 3/ 种/ 策略/ 的/ 瓶颈/ 资源/ 不/ 相同/ ,/ 而/ 我们/ 所/ 提出/ 的/ 策略/ 可以/ 尽可能/ 合理/ 地/ 分配任务/ 顺序/ 和/ 策略/ ,/ 从而/ 避免/ 资源/ 竞争/ ./ 值得注意/ 的/ 是/ ,/ 贪心/ 算法/ 策略/ 反而/ 不及/ DDBonly/ 策略/ ,/ 这/ 是因为/ 贪心/ 算法/ 并/ 不/ 考虑/ 潜在/ 的/ 资源/ 冲突/ ,/ 而是/ 在/ 规划/ 的/ 过程/ 中/ 仅仅/ 考虑/ 当前/ 的/ 最大/ 收益/ ./ 图/ 9/ 对比/ 了/ GA/ 组合/ 策略/ 和/ DDB/ 策略/ 下/ 预测/ 和/ 备份/ 操作/ 时间/ ./ 图/ 9/ 坐标轴/ 与/ 图/ 8/ 坐标轴/ 含义/ 相同/ ./ 带/ ○/ 标记/ 的/ 实线/ 代表/ GA/ 策略/ 真实/ 操作/ 时间/ ,/ 带/ ×/ 标记/ 的/ 实线/ 代表/ DDBonly/ 策略/ 的/ 真实/ 操作/ 时间/ ,/ 带/ ☆/ 标记/ 的/ 实线/ 代表/ GA/ 组合/ 策略/ 的/ 预测/ 时间/ ,/ 带/ □/ 标记/ 的/ 实线/ 代表/ DDBonly/ 策略/ 的/ 预测/ 时间/ ./ 由于/ DABonly/ 策略/ 和/ 贪心/ 算法/ 组合/ 策略/ 备份/ 时间/ 过长/ ,/ 我们/ 没有/ 进行/ 实验/ ./ 图中/ 我们/ 可以/ 看出/ ,/ GA/ 组合/ 策略/ 的/ 备份/ 操作/ 节省/ 了/ 18.7/ %/ ~/ 24.3/ %/ 的/ 时间/ ,/ 而/ 预测/ 时间/ 节省/ 了/ 17.3/ %/ ~/ 23.5/ %/ 的/ 时间/ ,/ 两者之间/ 存在/ 的/ 误差/ 在/ 可以/ 接受/ 的/ 范围/ 之内/ ./ 图/ 9GA/ 组合/ 策略/ 与/ DDB/ 组合/ 策略/ 预测/ 和/ 备份/ 时间/ 实验/ 结果表明/ 本文/ 提出/ 的/ 策略/ 能够/ 有效/ 地/ 减少/ 虚拟机/ 镜像/ 去/ 冗余/ 备份/ 的/ 时间/ ,/ 同时/ 在/ 组合/ 策略/ 中/ 遗传算法/ 优于/ 贪心/ 算法/ ./ 5.4/ 策略/ 选择/ 算法/ 的/ 收敛性/ 本/ 节/ 实验/ 验证/ 遗传算法/ 的/ 收敛性/ ./ 实验/ 设定/ 的/ 算法/ 终止/ 条件/ 为/ “/ 种群/ 中/ 优秀/ 个体/ 的/ 适应度/ 值/ 不再/ 发生变化/ ”/ ./ 实验/ 中/ 我们/ 记录/ 每次/ 迭代/ 后/ 染色体/ 的/ 适应度/ 函数/ 值/ ./ 图/ 10/ 所示/ 为/ 适应度/ 函数/ 值/ 分布/ ./ x/ 轴/ 坐标/ 代表/ 当前/ 种群/ 中/ 第/ x/ 个/ 个体/ ,/ y/ 轴/ 坐标/ 代表/ 个体/ 对应/ 的/ 适应度/ 函数/ 值/ ./ 3/ 个子/ 图/ 分布/ 代表/ 不同/ 种群/ 大小/ 下/ 适应度/ 函数/ 值/ 分布/ ./ 图例/ 中/ “/ n/ =/ k/ ”/ 代表/ 第/ n/ 代/ 种群/ ./ 图/ 10/ (/ a/ )/ 所示/ 为/ 种群/ 大小/ 为/ 10/ 的/ 情况/ 下/ 种群/ 中/ 个体/ 适应度/ 函数/ 值/ 分布/ ./ □/ 代表/ 第/ 1/ 代/ 种群/ 适应度/ 函数/ 值/ ,/ ×/ 代表/ 第/ 50/ 代/ 种群/ 适应度/ 函数/ 值/ ,/ +/ 代表/ 第/ 200/ 代/ 种群/ 适应度/ 函数/ 值/ ./ 在/ 种群/ 大小/ 为/ 10/ 的/ 情况/ 下/ ,/ 算法/ 可以/ 在/ 500/ 代/ 之内/ 收敛/ ./ 图/ 10/ (/ b/ )/ 所示/ 为/ 种群/ 大小/ 为/ 20/ 的/ 情况/ 下/ 种群/ 中/ 个体/ 适应度/ 函数/ 值/ 分布/ ./ 图/ 10/ (/ c/ )/ 所示/ 为/ 种群/ 大小/ 为/ 50/ 的/ 情况/ 下/ 种群/ 中/ 个体/ 适应度/ 函数/ 值/ 分布/ ./ 在/ 种群/ 大小/ 为/ 20/ 和/ 50/ 的/ 情况/ 下/ ,/ 算法/ 可以/ 在/ 100/ 代/ 之内/ 收敛/ ./ 本节/ 所示/ 实验/ 表明/ 遗传算法/ 具有/ 很/ 好/ 的/ 收敛性/ ./ 算法/ 能/ 在/ 500/ 代/ 之内/ 收敛/ ,/ 而且/ 种群/ 越大/ ,/ 收敛/ 速度/ 越快/ ./ 在/ 给定/ 的/ 实验/ 条件/ 下/ ,/ 当/ 种群/ 数量/ 为/ 20/ 时/ ,/ 继/ Page10/ 续/ 扩大/ 种群/ 数量/ 对于/ 算法/ 收敛/ 速度/ 并/ 无太大/ 影响/ ./ 图/ 10/ 不同/ 参数/ 下/ GA/ 算法/ 染色体/ 适应度/ 函数/ 值/ 分布/ 6/ 相关/ 工作/ 数据/ 去/ 冗余/ 研究/ 广泛/ 地/ 采用/ 遗传算法/ 寻找/ 指向/ 相同/ 实体/ 的/ 记录/ [/ 17/ -/ 20/ ]/ ./ 然而/ ,/ 这些/ 工作/ 是/ 将/ 遗传算法/ 应用/ 在/ 去/ 冗余/ 过程/ 中/ ,/ 其/ 目的/ 主要/ 用于/ 消除/ 数据/ 冗余/ [/ 15/ ,/ 21/ ]/ ./ 在/ 本文/ 中/ ,/ 我们/ 采用/ 遗传算法/ 选择/ 合适/ 的/ 去/ 冗余/ 备份/ 策略/ ./ 去/ 冗余/ 是/ 基于/ CAS/ 技术/ 实现/ 的/ ,/ 由于/ 备份/ 系统/ 通常/ 是/ 包括/ 备份/ 客户端/ 和/ 备份/ 服务器端/ 的/ 两层/ 架构/ ,/ 因此/ ,/ 去/ 冗余/ 备份/ 的/ 顺序/ 和/ 位置/ 是/ 需要/ 重点/ 研究/ 的/ 问题/ ./ Mandagere/ 等/ 人/ [/ 22/ ]/ 采用/ 真实/ 数据/ ,/ 通过/ 实验/ 表明/ 了/ 不同/ 的/ 去/ 冗余技术/ 可以/ 导致/ CPU/ 使用率/ 和/ 去/ 冗余/ 时间/ 的/ 差异/ ./ 该/ 工作/ 虽然/ 讨论/ 了/ 是/ 在/ 客户端/ 还是/ 在/ 服务器端/ 进行/ 去/ 冗余/ 的/ 问题/ ,/ 但是/ 并/ 没有/ 给出/ 相应/ 的/ 解决方案/ ./ 在/ 之前/ 的/ 工作/ 中/ [/ 15/ ]/ ,/ 我们/ 提出/ 了/ 先/ 备份/ 再/ 去/ 冗余/ 策略/ ,/ 先/ 去/ 冗余/ 再/ 备份/ 策略/ 和/ 边/ 去/ 冗余/ 边/ 备份/ 的/ 策略/ ./ Fu/ 等/ 人/ [/ 6/ ]/ 采用/ “/ 源/ ”/ 去/ 冗余/ (/ sourcededuplication/ )/ 方案/ 在/ 私有/ 云/ 计算环境/ 中/ 实现/ 了/ 虚拟机/ 备份/ ./ 备份/ 数据/ 先/ 在/ “/ 源/ ”/ 端/ 进行/ 聚合/ 再/ 传输/ 到/ 备份/ 端/ ./ 论文/ 中/ 的/ “/ 源/ ”/ 去/ 冗余/ 跟/ 我们/ 提出/ 的/ DBB/ 策略/ 类似/ ,/ 但/ “/ 源/ ”/ 去/ 冗余/ 需要/ 占用/ 大量/ 的/ CPU/ 资源/ 和/ 内存/ 资源/ ./ 而/ 我们/ 的/ 目标/ 之一/ 就是/ 权衡/ 资源/ 使用率/ 和/ 备份/ 效率/ ./ Park/ 等/ 人/ [/ 23/ ]/ 采用/ 排队/ 论/ 模型/ 分析/ 数据/ 达到/ 率/ 对系统/ 吞吐量/ 的/ 影响/ ,/ 论文/ 中/ 并/ 没有/ 提及/ 具体/ 采用/ 的/ 是/ 单一/ 策略/ ./ Bhagwat/ 等/ 人/ [/ 5/ ]/ 提出/ 了/ 基于/ 文件/ 相似性/ 的/ ExtremeBinning/ 方法/ 执行/ 去/ 冗余/ 操作/ ,/ 该/ 系统/ 在/ 备份/ 端/ 执行/ 去/ 冗余/ 操作/ ,/ 是/ 一种/ 典型/ 的/ DAB/ 策略/ ./ Min/ 等/ 人/ [/ 24/ ]/ 设计/ 了/ 基于/ PRUN/ [/ 7/ ]/ 的/ 原型/ 系统/ ,/ 该/ 系统/ 采用/ 的/ 是/ DDB/ 备份/ 策略/ ,/ 将/ 数据/ 切分/ 和/ 指纹/ 计算/ 模块/ 放置/ 在/ 备份/ 客户端/ ,/ 数据/ 通过/ stream/ 方式/ 发送到/ 服务器端/ 执行/ 去/ 冗余/ 操作/ ./ Xing/ 等/ 人/ [/ 25/ ]/ 通过/ 优化/ 数据/ 块/ 路由/ 算法/ 提高/ 去/ 冗余/ 的/ 性能/ ./ Jin/ 等/ 人/ [/ 26/ ]/ 将/ 去/ 冗余技术/ 引进/ 到/ 虚拟机/ 镜像/ 存储/ 中/ ,/ 通过/ 实验/ 表明/ 了/ 在/ 虚拟机/ 镜像/ 去/ 冗余/ 中变长/ 切分/ 和/ 定长/ 切分/ 效果/ 相近/ ./ Jayaram/ 等/ 人/ [/ 27/ ]/ 分析/ 了/ 虚拟机/ 镜像/ 的/ 相似性/ ,/ 指出/ 虚拟机/ 镜像/ 具有/ 小/ 范围/ 相似/ 的/ 特点/ ./ Zhang/ 等/ 人/ [/ 8/ ]/ 针对/ 大规模/ 的/ 虚拟机/ 镜像/ 去/ 冗余/ 提出/ 了/ 一种/ 低/ 开销/ 可/ 扩展/ 的/ 解决方案/ ,/ 核心思想/ 是/ 在/ 实际/ 的/ 存储/ 中/ 进行/ 重复/ 数据/ 检测/ ,/ 而/ 不/ Page11/ 是/ 内联/ 去/ 冗余/ ./ 该/ 方法/ 将/ 数据/ 索引/ 进行/ 划分/ ,/ 在/ 不同/ 虚拟机/ 之间/ 执行/ 去/ 冗余/ ,/ 本质/ 上/ 是/ 一种/ DDB/ 策略/ ./ 以上/ 工作/ 都/ 是/ 采用/ 单一/ 策略/ 进行/ 去/ 冗余/ ,/ 由于/ 不同/ 的/ 备份/ 策略/ 存在/ 不同/ 的/ 资源/ 需求/ ,/ 多个/ 主/ 存储设备/ 上/ 的/ 镜像/ 就/ 会/ 向/ 同一个/ 备份/ 发送数据/ 并/ 执行/ 去/ 冗余/ 操作/ ./ 然而/ ,/ 采用/ 单一/ 策略/ 会/ 造成/ 传输/ 带宽/ 竞争/ 和/ 并发/ 写/ 冲突/ ,/ 导致/ 去/ 冗余/ 备份/ 性能/ 降低/ ./ 本文/ 工作/ 的/ 主要/ 贡献/ 就是/ 针对/ 不同/ 策略/ 的/ 资源/ 需求/ 进行/ 优化/ ,/ 最大化/ 资源/ 利用率/ ,/ 提高/ 虚拟机/ 镜像/ 备份/ 效率/ ./ 此外/ ,/ Li/ 等/ 人/ [/ 28/ ]/ 和/ Xia/ 等/ 人/ [/ 29/ ]/ 均/ 提出/ 混合/ 不同/ 去/ 冗余/ 方法/ 提高/ 备份/ 性能/ ./ 与/ 本文/ 方法/ 的/ 不同之处/ 是/ ,/ 他们/ 都/ 是/ 先/ 采取/ 一种/ 粗粒度/ 的/ 方法/ 对/ 数据/ 进行/ 处理/ 再/ 采取/ 另外/ 一种/ 细粒度/ 的/ 方法/ 对/ 数据/ 进行/ 处理/ ,/ 这样/ 会/ 导致/ 数据/ 的/ 重复/ 处理/ ./ 本文/ 方法/ 在/ 合理/ 进行/ 资源配置/ 的/ 同时/ ,/ 还/ 可以/ 有效/ 避免/ 数据/ 重复/ 处理/ 带来/ 的/ 额外/ 开销/ ./ 7/ 总结/ 与/ 讨论/ 虚拟机/ 镜像/ 去/ 冗余/ 备份/ 是/ 数据中心/ 重要/ 技术/ ,/ 而/ 镜像/ 去/ 冗余/ 备份/ 通常/ 会/ 干扰/ 正常/ 运行/ 的/ 虚拟机/ 性能/ ,/ 而/ 缩短/ 备份/ 操作/ 时间/ 对于/ 缓解/ 这种/ 干扰/ 具有/ 重要/ 意义/ ./ 不同/ 的/ 备份/ 策略/ 资源/ 需求/ 不尽相同/ ,/ 从而/ 使得/ 不同/ 场景/ 下/ 的/ 组合/ 策略/ 进行/ 去/ 冗余/ 备份/ 来/ 减少/ 备份/ 时间/ 具有/ 合理性/ 和/ 可行性/ ./ 本文/ 中/ ,/ 我们/ 首先/ 建模/ 了/ 3/ 种/ 不同/ 策略/ 下/ 的/ 备份/ 时间/ 预测/ ./ 然后/ ,/ 采用/ 遗传算法/ 为/ 每个/ 虚拟机/ 集群/ 分配/ 不同/ 的/ 备份/ 策略/ ./ 通过/ 对/ 任务/ 顺序/ 、/ 备份/ 策略/ 等/ 的/ 合理配置/ ,/ 我们/ 尽可能/ 地/ 消除/ 资源/ 竞争/ ./ 实验/ 表明/ ,/ 我们/ 的/ 工作/ 可以/ 降低/ 17.3/ %/ ~/ 23.5/ %/ 的/ 备份/ 操作/ 时间/ ./ 本文/ 中/ 讨论/ 的/ 3/ 种/ 备份/ 策略/ 为/ 主要/ 的/ 备份/ 策略/ ,/ 除了/ 这/ 3/ 种/ 策略/ 之外/ 还有/ 其他/ 类型/ 的/ 备份/ 策略/ ,/ 例如/ DDB/ 策略/ 的/ 变种/ DDB/ -/ v/ ,/ 先/ 将/ 镜像/ 数据/ 块/ 传输/ 到/ 备份/ 存储设备/ 再/ 在/ 备份/ 存储设备/ 进行/ 实时/ 的/ 去/ 冗余/ ./ 这种/ 策略/ 相对/ 来讲/ 有/ 更/ 高/ 的/ 资源/ 需求/ ,/ 因此/ 并/ 不/ 适合/ 我们/ 的/ 处理/ 环境/ ./ 所以/ 在/ 本文/ 中/ 我们/ 只/ 考虑/ DAB/ 、/ DBB/ 和/ DDB/ 这/ 3/ 种/ 备份/ 策略/ ./ 我们/ 的/ 工作/ 也/ 存在/ 一些/ 不足/ ,/ 需要/ 进一步/ 的/ 完善/ ./ 首先/ ,/ 并发/ 线程/ 数/ 只能/ 根据/ 用户/ 经验/ 进行/ 配置/ ,/ 无法/ 做到/ 自动/ 获取/ ./ DAB/ 策略/ 中/ 数据/ 写/ 到/ 磁盘/ 上/ 的/ 单独/ 区域/ 中/ ,/ 无需/ 读/ // 写锁/ ./ 而/ 对于/ DBB/ 和/ DDB/ 由于/ 数据/ 需要/ 写/ 到/ 同一/ 存储/ 区域/ 中/ ,/ 因此/ 需要/ 读/ // 写锁来/ 规范/ 不同/ 线程/ 的/ 行为/ ./ 可行/ 的/ 解决/ 方法/ 就是/ 通过/ 大量/ 的/ 离线/ 测试/ 制定/ 相应/ 的/ 启发式/ 规则/ 来/ 决定/ 并发/ 线程/ 数/ ./ 其次/ ,/ 由于/ 存在/ 客户端/ 去/ 冗余/ ,/ 数据/ 指纹/ 库/ 需要/ 进行/ 同步/ ,/ 方法/ 中/ 并/ 没有/ 采用/ 实时/ 一致性/ 对/ 指纹/ 库/ 进行/ 更新/ ,/ 因此/ 在/ 备份/ 结束/ 时/ 需要/ 对/ 指纹/ 库/ 进行/ 一致性/ 扫描/ ,/ 找出/ 其中/ 指向/ 不同/ 存储/ 区域/ 的/ 相同/ 指纹/ ,/ 并/ 执行/ 数据/ 回收/ 操作/ ./ 

