Page1/ 基于/ 路由/ 证据/ 的/ 域间/ 路由/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 机制/ 蒋健/ 李伟罗军/ 舟陆/ 悠夏怒/ (/ 东南大学/ 计算机科学/ 与/ 工程学院/ 南京/ 211189/ )/ 摘要/ 域间/ 路由/ 系统/ 中/ ,/ 自治/ 系统/ 依据/ 路由/ 策略/ 选择/ 报文/ 转发/ 路径/ ,/ 并/ 将/ 路径/ 通告/ 给/ 邻居/ 自治/ 系统/ ./ 为了/ 追求/ 更/ 多/ 的/ 网络/ 利益/ ,/ 自治/ 系统/ 向/ 邻居/ 自治/ 系统/ 通告/ 的/ 路径/ 可能/ 并/ 不是/ 实际/ 转发/ 报文/ 的/ 路径/ ,/ 从而/ 产生/ 域间/ 路由/ 路径/ 不/ 一致/ 的/ 问题/ ./ 域间/ 路由/ 不/ 一致/ 路径/ 不仅/ 欺骗/ 正常/ 自治/ 系统/ 的/ 路由/ 选路/ 过程/ ,/ 损害/ 其/ 网络/ 利益/ ,/ 而且/ 对域/ 间/ 路由/ 的/ 稳定性/ 也/ 会/ 造成/ 严重/ 影响/ ./ 现有/ 的/ 检测/ 机制/ 主要/ 关注/ 不/ 一致/ 路径/ 的/ 检测/ ,/ 没有/ 致力于/ 发现/ 导致/ 路径/ 不/ 一致/ 的/ 恶意/ 自治/ 系统/ ,/ 无法/ 为/ 后续/ 解决/ 路径/ 不/ 一致/ 的/ 问题/ 提供/ 支撑/ ./ 该文/ 提出/ 一种/ 域间/ 路由/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 机制/ ,/ 采用/ 路由/ 证据/ 将/ 自治/ 系统/ 的/ 路由/ 行为/ 与/ 自治/ 系统/ 本身/ 相/ 绑定/ ./ 路径/ 源/ 自治/ 系统对/ 路径/ 中/ 其他/ 自治/ 系统/ 进行/ 逆序/ 比较/ 路由/ 证据/ ,/ 确定/ 可疑/ 自治/ 系统/ ,/ 然后/ 查询/ 离/ 自身/ 较近/ 的/ 可疑/ 自治/ 系统/ 的/ 直接/ 上游/ 自治/ 系统/ 的/ 路由/ 通告/ 历史记录/ ,/ 对/ 可能/ 接收/ 可疑/ 自治/ 系统/ 报文/ 的/ 自治/ 系统/ 请求/ 路由/ 证据/ ,/ 根据/ 比较/ 结果/ 最终/ 确定/ 恶意/ 自治/ 系统/ ./ 实验/ 结果表明/ ,/ 该文/ 的/ 检测/ 机制/ 在/ 查全率/ 和/ 查准率/ 两个/ 指标/ 上均/ 优于/ 现有/ 的/ 检测/ 机制/ ,/ 有效/ 提高/ 了/ 检测/ 不/ 一致/ 路径/ 中/ 恶意/ 自治/ 系统/ 的/ 准确率/ ./ 关键词/ 域间/ 路由/ ;/ 路径/ 不/ 一致/ 问题/ ;/ 恶意/ 自治/ 系统/ 检测/ 机制/ ;/ 路由/ 证据/ ;/ 互联网/ 1/ 引言/ Internet/ 中/ 的/ 自治/ 系统/ (/ AutonomousSystem/ ,/ AS/ )/ 通过/ BGP/ 协议/ (/ BorderGatewayProtocol/ )/ [/ 1/ ]/ 实现/ 域间/ 路由/ ./ 依据/ RFC4271/ [/ 1/ ]/ ,/ 域间/ 路由/ 分为/ 路由/ 控制/ 层/ 和/ 路由/ 数据/ 层/ 两个/ 层面/ :/ 在/ 路由/ 控制/ 层/ ,/ 自治/ 系统/ 从/ 邻居/ 自治/ 系统/ 获得/ BGP/ 路由/ 通告/ ,/ 依据/ 自身/ 的/ 路由/ 策略/ 选择/ 到达/ 目的/ 自治/ 系统/ 的/ 最优/ 路径/ ,/ 并/ 将/ 最优/ 路径/ 通告/ 至/ 其他/ 邻居/ 自治/ 系统/ ;/ 在/ 路由/ 数据/ 层/ ,/ 自治/ 系统/ 沿着/ 最优/ 路径/ 转发/ 数据/ 报文/ ./ 正常/ 情况/ 下/ ,/ 自治/ 系统/ 在/ 数据/ 层/ 转发/ 报文/ 的/ 最优/ 路径/ 与/ 控制/ 层/ 对外/ 通告/ 的/ 最优/ 路径/ 是/ 相同/ 的/ ./ 然而/ 由于/ 商业/ 利益驱动/ [/ 2/ ]/ 、/ 路由器/ 配置/ 错误/ [/ 3/ ]/ 等/ 原因/ ,/ 自治/ 系统/ 向/ 邻居/ 自治/ 系统/ 通告/ 的/ 路径/ 可能/ 并/ 不是/ 其/ 实际/ 转发/ 报文/ 的/ 路径/ ,/ 同时/ 产生/ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ ./ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ 在/ Internet/ 中/ 广泛/ 存在/ ./ AS/ 级别/ 的/ Traceroute/ 实验/ 显示/ Internet/ 的/ 域间/ 路由/ 中/ 至少/ 有/ 8/ %/ 的/ 路由/ 路径/ 存在/ 数据/ 层/ 与/ 控制/ 层/ 路径/ 不/ 一致/ 的/ 情况/ [/ 4/ ]/ ./ 由于/ 恶意/ 自治/ 系统/ 可以/ 躲避/ Traceroute/ 实验/ 的/ 检测/ ,/ 因此/ 域间/ 路由/ 可能/ 存在/ 更/ 多/ 的/ 不/ 一致/ 路径/ ./ 域间/ 路由/ 不/ 一致/ 路径/ 带来/ 一系列/ 问题/ ,/ 一方面/ 使得/ 自治/ 系统/ 的/ 路由/ 选路/ 过程/ 被/ 欺骗/ ,/ 路由/ 策略/ 无法/ 在/ 路由/ 路径/ 中/ 体现/ ,/ 自治/ 系统/ 利益/ 受损/ ;/ 另一方面/ ,/ 由于/ 恶意/ 自治/ 系统/ 所/ 发布/ 的/ 路由/ 通告/ 并非/ 自身/ 最优/ 路径/ ,/ 接收/ 通告/ 的/ 相邻/ 自治/ 系统/ 也/ 无法/ 保证/ 最优/ 的/ 路径/ ,/ 一定/ 范围/ 内会/ 导致/ 路由/ 路径/ 出现/ 环路/ ,/ 影响/ 域间/ 路由/ 的/ 稳定性/ [/ 5/ ]/ ./ 近年来/ ,/ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ 逐渐/ 获得/ 研究/ 人员/ 的/ 关注/ ,/ 相关/ 研究/ 工作/ 主要/ 集中/ 在/ 不/ 一致/ 路径/ 检测/ 方面/ ,/ 已/ 取得/ 了/ 许多/ 成果/ [/ 6/ -/ 8/ ]/ ./ 这些/ 检测/ 机制/ 多/ 采用/ 发送/ 探测/ 报文/ 的/ 形式/ ,/ 利用/ 探测/ 报文/ 反馈/ 的/ 结果/ 检测/ 路径/ ./ 然而/ 这些/ 检测/ 机制/ 并/ 不能/ 保证/ 探测/ 报文/ 与/ 正常/ 报文/ 的/ 无/ 差异性/ ,/ 所以/ 使得/ 检测/ 机制/ 不能/ 对/ 恶意/ 自治/ 系统/ 透明/ ,/ 影响/ 检测/ 结果/ ;/ 同时/ 由于/ 这些/ 检测/ 机制/ 主要/ 关注/ 不/ 一致/ 路径/ 的/ 检测/ ,/ 没有/ 致力于/ 发现/ 导致/ 路径/ 不/ 一致/ 的/ 恶意/ 自治/ 系统/ ,/ 所以/ 无法/ 为/ 后续/ 解决/ 路径/ 不/ 一致/ 问题/ 提供/ 支撑/ [/ 9/ ]/ ./ 鉴于/ 以上/ 原因/ ,/ 本文/ 提出/ 一种/ 域间/ 路由/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 机制/ (/ MaliciousASDetectionMechanism/ ,/ MADM/ )/ ,/ 在/ 发现/ 不/ 一致/ 路径/ 的/ 基础/ 上/ ,/ 检测/ 出/ 导致/ 路径/ 不/ 一致/ 的/ 恶意/ 自治/ 系统/ ./ 本文/ 首先/ 提出/ 路由/ 证据/ 的/ 概念/ ,/ 自治/ 系统/ 在/ 接收/ 和/ 转发/ 数据/ 报文/ 的/ 同时/ 生成/ 路由/ 证据/ ./ 路由/ 证据/ 反映/ 自治/ 系统/ 声明/ 的/ 报文/ 转发/ 路径/ ,/ 将/ 自治/ 系统/ 的/ 路由/ 行为/ 与/ 自治/ 系统/ 本身/ 相/ 绑定/ ./ 其次/ 本文/ 提出/ 基于/ 路由/ 证据/ 的/ 恶意/ 自治/ 系统/ 检测/ 方法/ ,/ 源/ 自治/ 系统/ 依据/ 证据/ 比较/ 结果/ ,/ 确定/ 路径/ 中/ 的/ 可疑/ 自治/ 系统/ ,/ 查询/ 离/ 自身/ 较近/ 的/ 可疑/ 自治/ 系统/ 的/ 直接/ 上游/ 自治/ 系统/ 的/ 路由/ 通告/ 历史记录/ ,/ 对/ 可能/ 接收/ 可疑/ 自治/ 系统/ 报文/ 的/ 自治/ 系统/ 请求/ 路由/ 证据/ ,/ 依据/ 证据/ 比较/ 结果/ 最终/ 确定/ 恶意/ 自治/ 系统/ ./ 和/ 已有/ 研究成果/ 相比/ ,/ MADM/ 具有/ 以下/ 3/ 个/ 方面/ 的/ 优势/ :/ (/ 1/ )/ MADM/ 是/ 一种/ 轻量级/ 检测/ 机制/ ./ MADM/ 对/ 路由/ 证据/ 进行/ 加密/ 以/ 保证/ 路由/ 证据/ 的/ 安全性/ ,/ 其/ 不/ 需要/ 进行/ 报文/ 级别/ 的/ 加密/ ,/ 显著/ 减少/ 了/ 网络/ 开销/ ;/ (/ 2/ )/ MADM/ 提高/ 检测/ 恶意/ 自治/ 系统/ 的/ 准确率/ ./ 在/ 路由/ 证据/ 的/ 生成/ 过程/ 中/ ,/ 路径/ 中/ 的/ 恶意/ 自治/ 系统/ 无法/ 辨别/ 证据/ 生成/ 报文/ 和/ 正常/ 报文/ ,/ 不能/ 针对/ 证据/ 生成/ 报文/ 改变/ 转发/ 路径/ ,/ 无法/ 躲避/ 检测/ ;/ (/ 3/ )/ MADM/ 避免/ 恶意/ 自治/ 系统对/ 检测/ 结果/ 的/ 影响/ ./ MADM/ 检测/ 过程/ 不/ 与/ 恶意/ 自治/ 系统/ 直接/ 交互/ 信息/ ,/ 仅/ 与/ 正常/ 自治/ 系统/ 比较/ 路由/ 证据/ 即可/ 发现/ 恶意/ 自治/ 系统/ ,/ 对/ 恶意/ 自治/ 系统/ 透明/ ./ 本文/ 第/ 2/ 节/ 介绍/ 不/ 一致/ 路径/ 检测/ 机制/ 的/ 相关/ 工作/ ;/ 第/ 3/ 节/ 形式化/ 描述/ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ ;/ 第/ 4/ 节/ 介绍/ 路由/ 证据/ 和/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 方法/ ;/ 第/ 5/ 节对/ MADM/ 进行/ 实验/ 验证/ ;/ 第/ 6/ 节/ 总结/ 全文/ 并/ 提出/ 未来/ 工作/ ./ 2/ 相关/ 工作/ 近年来/ 研究/ 人员/ 在/ 路由/ 数据/ 层/ 部署/ 测量/ 机制/ 检/ Page3/ 测/ 路由/ 路径/ ,/ 然而/ 即使/ 不/ 考虑/ 检测/ 恶意/ 自治/ 系统/ ,/ 在/ 数据/ 层/ 发现/ 完整/ 的/ 路由/ 路径/ 仍然/ 是/ 一项/ 繁重/ 的/ 工作/ ,/ 同时/ 数据/ 层/ 的/ 测量/ 机制/ 一般/ 需要/ 报文/ 级别/ 加密/ ,/ 会/ 造成/ 很大/ 的/ 网络/ 开销/ ./ 研究/ 人员/ [/ 6/ ]/ 试图/ 从/ Traceroute/ 数据/ 中/ 得到/ 完整/ 的/ 路由/ 路径/ ,/ 然而/ 由于/ 路由/ 聚集/ 和/ 路由/ 过滤/ 、/ 边界/ 路由器/ 接口/ 编号/ 混乱/ 、/ ICMP/ 报文/ 接口/ 错误/ 、/ 恶意/ 路由/ 等/ 原因/ ,/ 得到/ 的/ 结果/ 和/ 实际/ 路径/ 存在/ 很大/ 的/ 偏差/ ./ Securetraceroute/ [/ 7/ ]/ 在/ 自治/ 系统/ 之间/ 设立/ 一个/ 共享/ 的/ 密钥/ 谓词/ ,/ 自治/ 系统/ 选择/ 一些/ 报文/ 作为/ 探测/ 报文/ 并/ 检测/ 报文/ 是否/ 能够/ 正常/ 到达/ 目的/ 节点/ 的/ 元素/ ./ 它/ 要求/ 路由器/ 对/ 探测/ 报文/ 的/ 每个/ 应答/ 信息/ 计算/ 消息/ 鉴别/ 码/ (/ MessageAuthenticationCodes/ ,/ MAC/ )/ ,/ 在/ 探测/ 报文/ 数量/ 庞大/ 的/ 情况/ 下/ ,/ 路由器/ 会/ 消耗/ 巨大/ 的/ 计算资源/ ./ Icing/ 化/ 加密/ 结构/ ,/ 要求/ 报文/ 发送者/ 和/ 报文/ 接收者/ 共享/ 报文/ 转发/ 路径/ 所/ 涉及/ 的/ 路由/ 策略/ ./ 由于/ 自治/ 系统/ 的/ 高度/ 自治/ 性/ ,/ 策略/ 共享/ 在/ 实际/ 网络/ 中/ 难以实现/ ./ Zhao/ 等/ 人/ [/ 10/ ]/ 提出/ 了/ 一种/ 域间/ 路由/ 决策/ 检测/ 协议/ ,/ 允许/ 自治/ 域/ 的/ 对/ 等/ 邻居/ 检测/ 自治/ 域/ 是否/ 遵守/ 了/ 路由/ 策略/ 承诺/ ./ 除了/ 域间/ 路由/ 协议/ 公开/ 的/ 信息/ 之外/ 不/ 需要/ 暴露/ 其他/ 域/ 内/ 隐私/ ,/ 多个/ 邻居/ 自治/ 系统/ 通过/ 检测/ 公开/ 信息/ 即可/ 得出/ 检测/ 结果/ ./ 与/ 其他/ 研究/ 方法/ 相比/ ,/ Zhao/ 等/ 人/ 的/ 检测/ 机制/ 需要/ 自治/ 域/ 提前/ 向/ 邻居/ 自治/ 域/ 提供/ 路由/ 选择/ 承诺/ (/ Promise/ )/ ,/ 这种/ 假设/ 在/ 当前/ 域间/ 路由/ 系统/ 中/ 并/ 不/ 成立/ ./ 其次/ 它/ 只能/ 判断/ 自治/ 域/ 通告/ 的/ 路径/ 是否/ 违背/ 承诺/ ,/ 即/ 只/ 能够/ 验证/ 路由/ 控制/ 层/ 通告/ 路径/ 的/ 真实性/ ,/ 并/ 没有/ 关注/ 路由/ 控制/ 层/ 和/ 数据/ 层/ 的/ 路径/ 不/ 一致/ 问题/ ./ 类似/ 的/ 工作/ 有/ NetReview/ [/ 11/ ]/ ,/ 它/ 检测/ 一个/ 自治/ 域/ 是否/ 偏离/ 对/ 其他/ 域/ 的/ 路由/ 策略/ 承诺/ ./ 为了/ 实现/ 此/ 方法/ ,/ 自治/ 域/ 必须/ 公开/ 所有/ 接收/ 到/ 的/ BGP/ 更新/ 消息/ ./ 这种/ 需求/ 不能/ 保护/ 自治/ 系统/ 的/ 隐私/ ,/ 另外/ NetReview/ 和/ Zhao/ 等/ 人/ 的/ 工作/ 类似/ ,/ 只/ 关注/ 路由/ 控制/ 层/ 的/ 路由/ 行为/ 验证/ 问题/ ./ Wong/ 等/ 人/ [/ 12/ ]/ 提出/ 一种/ 轻量级/ 的/ 路由/ 路径/ 验证/ 机制/ Lightweight/ ./ 验证/ 方在/ 一些/ 数据/ 报文/ 中/ 附加/ 共享/ 密钥/ 元组/ 的/ 前半部/ 分/ 并/ 发送数据/ 报文/ 至/ 被/ 验证/ 方/ ./ 被/ 验证/ 方/ 拥有/ 共享/ 密钥/ 元组/ 的/ 后/ 半/ 部分/ ,/ 收到/ 数据/ 报文/ 后/ 发送/ 应答/ 报文/ ./ 验证/ 方/ 依据/ 应答/ 报文/ 判断/ 被/ 验证/ 方/ 的/ 上游/ 自治/ 系统/ 是否/ 沿着/ 当前/ 路径/ 转发/ 报文/ ./ 与/ 本文/ 类似/ ,/ 它/ 需要/ 多个/ 自治/ 域/ 的/ 协作/ ,/ 同时/ 必须/ 确保/ 附加/ 共享/ 密钥/ 元组/ 的/ 报文/ 与/ 常规/ 报文/ 一致/ ,/ 否则/ 恶意/ 自治/ 系统/ 将/ 探测/ 报文/ 正常/ 转发/ ,/ 而/ 将/ 正常/ 报文/ 则/ 转发/ 至/ 其他/ 路径/ ./ 虽然/ Lightweight/ 可以/ 检测/ 当前/ 路径/ 是否/ 存在/ 路径/ 不/ 一致/ 问题/ ,/ 但是/ 无法/ 准确/ 定位/ 不/ 一致/ 路径/ 中/ 的/ 恶意/ 自治/ 系统/ ,/ 不能/ 为/ 后续/ 解决/ 路径/ 不/ 一致/ 问题/ 提供/ 支撑/ ./ 3/ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ 的/ 形式化/ 描述/ 为了/ 便于/ 理解/ ,/ 本节/ 对域/ 间/ 路由/ 路径/ 不/ 一致/ 问题/ 进行/ 形式化/ 描述/ ,/ 在/ 此基础/ 上/ 给出/ 具体/ 实例/ ./ 采用/ 有向图/ G/ =/ (/ V/ ,/ E/ )/ 表示/ 网络/ 域间/ 路由/ 拓扑/ ,/ 其中/ V/ =/ {/ v0/ ,/ v1/ ,/ …/ ,/ vn/ }/ 表示/ 域间/ 自治/ 系统/ 集合/ ,/ vn/ 表示/ 一个/ 域间/ 节点/ (/ 为/ 形式化/ 表述/ 方便/ ,/ 自治/ 系统/ 在/ 本文/ 中/ 也/ 被/ 称为/ 节点/ )/ ./ E/ =/ {/ evi/ 相邻/ 自治/ 系统/ 直连边/ 的/ 集合/ ,/ 其中/ evi/ 到/ 节点/ vj/ 的/ 有/ 向/ 边/ ,/ 边/ 的/ 方向/ 表示/ 报文/ 传输/ 方向/ ./ 定义/ 1/ ./ 路由/ 路径/ ./ 路由/ 路径/ P/ 以/ 路径/ 中/ 的/ 节点/ 序列/ 表示/ ,/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ ,/ d/ )/ ,/ v0/ 为/ 路径/ P/ 的/ 源/ 节点/ ,/ d/ 为/ 路径/ 的/ 目的/ 节点/ ,/ vi/ 是/ 路径/ P/ 中/ 的/ 第/ i/ +/ 1/ 个/ 节点/ ./ 定义/ 2/ ./ 上下游/ 节点/ ./ 如果/ vi/ ∈/ P/ ,/ vj/ ∈/ P/ ,/ 且/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ ,/ …/ ,/ vj/ ,/ …/ ,/ d/ )/ ,/ i/ </ j/ ,/ 则/ vi/ 为/ vj/ 的/ 上游/ 节点/ ,/ vj/ 为/ vi/ 的/ 下游/ 节点/ ./ 如果/ vi/ 和/ vj/ 是/ 邻居/ 节点/ ,/ 则/ vi/ 为/ vj/ 的/ 直接/ 上游/ 节点/ ,/ vj/ 为/ vi/ 的/ 直接/ 下游/ 节点/ ./ 根据/ BGP/ 的/ 路由/ 选路/ 过程/ 可知/ BGP/ 路由/ 通告/ 总是/ 由/ 直接/ 下游/ 节点/ 发送给/ 直接/ 上游/ 节点/ ./ 定义/ 3/ ./ 路径/ 权值/ ./ 路径/ 权值/ 反映/ 自治/ 系统/ 的/ 路由/ 策略/ ./ 节点/ v/ 利用/ 路径/ 权值/ 函数/ Wv/ (/ P/ )/ 计算/ 路由/ 路径/ 的/ 权值/ ,/ 每条/ 路由/ 路径/ 的/ 权值/ 不同/ ,/ 权值/ 最高/ 的/ 路径/ 为/ 最优/ 路径/ ./ 一般/ 情况/ 下/ Wv/ (/ P/ )/ >/ 0/ ,/ 如果/ 节点/ 接收/ 的/ 路由/ 路径/ P/ 存在/ 环路/ ,/ 则/ Wv/ (/ P/ )/ =/ -/ ./ 基于/ 以上/ 定义/ ,/ 我们/ 给出/ 路径/ 不/ 一致/ 问题/ 和/ 恶意/ 自治/ 系统/ 的/ 定义/ ./ 定义/ 4/ ./ 路径/ 不/ 一致/ 问题/ ./ 设/ 节点/ v0/ 依据/ 路由/ 策略/ 选择/ 到达/ 目的/ 节点/ d/ 的/ 最优/ 路径/ 为/ P/ ,/ 表示/ 为/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ ,/ d/ )/ ./ 设/ 数据/ 报文/ 从/ v0/ 到/ d/ 的/ 实际/ 传输/ 路径/ 为/ P/ ,/ 表示/ 为/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vj/ ,/ d/ )/ ./ 如果/ 存在/ 节点/ vs/ 使得/ vs/ ∈/ P/ ∪/ P/ 且/ vs/ / P/ ∩/ P/ ,/ 则/ 我们/ 称/ 路径/ P/ 存在/ 不/ 一致/ 问题/ ./ 路由/ 策略/ 是/ 指/ 自治/ 系统/ 制定/ 的/ 接收/ 路由/ 、/ 选择/ 最佳/ 路由/ 以及/ 对外/ 通告/ 路由/ 的/ 策略/ ,/ 具有/ 多样性/ 和/ 自主性/ 的/ 特点/ ./ 路由/ 策略/ 的/ 多样性/ 首先/ 表现/ 在/ 决定/ 路由/ 策略/ 的/ 因素/ 多样化/ ./ 典型/ 因素/ 包括/ 自治/ 系统/ 之间/ 的/ 商业/ 关系/ 、/ 路径/ 长度/ 和/ 流量/ 负载/ 等/ ;/ 其次/ 是/ 路由/ Page4/ 策略/ 的/ 偏好/ 多样化/ ./ Gao/ -/ Rexford/ [/ 13/ ]/ 首次/ 提出/ 了/ 自治/ 系统/ 商业/ 关系/ 的/ 概念/ ,/ 将/ 自治/ 系统/ 分为/ 客户/ 自治/ 系统/ 、/ 服务/ 自治/ 系统/ 以及/ 对/ 等/ 自治/ 系统/ ./ 客户/ 自治/ 系统/ 需要/ 向/ 服务/ 自治/ 系统/ 支付/ 费用/ 以/ 获得/ 网络/ 接入/ 权限/ ./ 为了/ 追求/ 更/ 多/ 的/ 经济/ 利益/ ,/ 服务/ 自治/ 系统/ 会/ 选择/ 通过/ 客户/ 自治/ 系统/ 的/ 路径/ 发送/ 报文/ ,/ 同时/ 将/ 最优/ 路径/ 通告/ 给/ 上游/ 的/ 客户/ 自治/ 系统/ ./ 而/ 某些/ 自治/ 系统/ 则/ 考虑/ 报文/ 传输/ 的/ 实时性/ 要求/ ,/ 即使/ 付出/ 一定/ 的/ 经济损失/ ,/ 也/ 对/ 最/ 短/ 路径/ 有所/ 偏好/ ./ 路由/ 策略/ 的/ 自主性/ 表现/ 在/ 策略/ 的/ 自主/ 决策/ ,/ 其他/ 自治/ 系统/ 无法/ 决定/ 也/ 无法/ 获知/ 本/ 自治/ 系统/ 的/ 最终/ 策略/ ./ 根据/ RFC4271/ 对域/ 间/ 路由/ 的/ 描述/ ,/ 我们/ 可以/ 发现/ 域间/ 路由/ 的/ 默认/ 准则/ 即/ 自治/ 系统/ 向/ 邻居/ 自治/ 系统/ 通告/ 的/ 路径/ 必须/ 是/ 自身/ 选择/ 的/ 最优/ 路径/ ./ 虽然/ 路由/ 策略/ 具备/ 多样性/ 和/ 自主性/ ,/ 但是/ 如果/ 自治/ 系统/ 在/ 制定/ 以及/ 实施/ 路由/ 策略/ 的/ 过程/ 中/ 违反/ 了/ 此/ 准则/ ,/ 对/ 其他/ 自治/ 系统/ 利益/ 和/ 网络/ 路由/ 系统/ 造成危害/ ,/ 则/ 被/ 称为/ 恶意/ 自治/ 系统/ ,/ 定义/ 如下/ ./ 定义/ 5/ ./ 恶意/ 自治/ 系统/ ./ 设/ 节点/ v0/ 到/ 目的/ 节点/ d/ 的/ 最优/ 路径/ P/ 存在/ 路径/ 不/ 一致/ 问题/ ,/ 表示/ 为/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ ,/ d/ )/ ./ P/ [/ vr/ ]/ =/ (/ vr/ ,/ vr/ +/ 1/ ,/ …/ ,/ vi/ ,/ d/ )/ 表示/ P/ 中源/ 节点/ 为/ vr/ ,/ 目的/ 节点/ 为/ d/ 的/ 子/ 路径/ ,/ 其中/ r/ ∈/ (/ 0/ ,/ i/ ]/ ./ 设/ Pvrd/ 的/ 最优/ 路径/ ,/ 如果/ Pvr/ ≠/ P/ [/ vr/ ]/ ,/ 则/ vr/ 为/ 恶意/ 自治/ 系统/ ./ 图/ 1/ 是/ 不/ 一致/ 路径/ 的/ 实例/ ./ 节点/ a/ 的/ 3/ 条/ 路径/ abd/ 、/ ad/ 和/ abcd/ 的/ 路径/ 权值/ 关系/ 为/ Wa/ (/ abd/ )/ >/ Wa/ (/ ad/ )/ >/ Wa/ (/ abcd/ )/ ./ 相应/ 的/ ,/ b/ 的/ 路径/ 权值/ 关系/ 为/ Wb/ (/ bcd/ )/ >/ Wb/ (/ bd/ )/ ./ 图/ 的/ 左侧/ 不/ 存在/ 路径/ 不/ 一致/ 问题/ ./ 节点/ b/ 沿着/ 路径/ bcd/ 发送/ 报文/ 至/ d/ ,/ 同时/ 将/ bcd/ 通告/ 给/ 上游/ 节点/ a/ ./ 在/ a/ 的/ 路由/ 策略/ 中/ 路径/ ad/ 的/ 权值/ 高于/ abcd/ ,/ 因此/ a/ 选择/ ad/ 作为/ 最优/ 路径/ ,/ 将/ 报文/ 直接/ 发送至/ d/ 节点/ ./ 图/ 的/ 右侧/ 存在/ 路径/ 不/ 一致/ 问题/ ./ 假设/ a/ 是/ b/ 的/ 客户/ 节点/ ,/ 由于/ bcd/ 并/ 不/ 被/ a/ 选为/ 最优/ 路径/ ,/ 为了/ 吸引/ a/ 的/ 流量/ ,/ 节点/ b/ 向/ a/ 通告/ 非/ 最优/ 路径/ bd/ ./ 虽然/ bd/ 不是/ b/ 的/ 真实/ 报文/ 转发/ 路径/ ,/ 但是/ a/ 并/ 不/ 知晓/ b/ 如何/ 转发/ 报文/ ,/ 因此/ a/ 节点/ 选择/ 路径/ abd/ 发送/ 报文/ ,/ abd/ 成为/ 不/ 一致/ 路径/ ./ 4/ 域间/ 路由/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 机制/ 在/ 本节/ 我们/ 首先/ 介绍/ 路由/ 证据/ 的/ 概念/ ,/ 其次/ 设计/ 基于/ 路由/ 证据/ 的/ 恶意/ 自治/ 系统/ 检测/ 方法/ ,/ 最后/ 讨论/ MADM/ 的/ 实现/ 和/ 部署/ 方案/ ./ 4.1/ 路由/ 证据/ 路由/ 证据/ 反映/ 自治/ 系统/ 的/ 路由/ 行为/ ./ 根据/ 路由/ 证据/ 的/ 生成/ 节点/ 和/ 生成/ 方式/ ,/ 路由/ 证据/ 分为/ 3/ 类/ :/ 源/ 节点/ 报文/ 发送/ 证据/ (/ SourceSendingEvidence/ ,/ SSE/ )/ 、/ 目的/ 节点/ 报文/ 发送/ 证据/ (/ DestinationSendingEvidence/ ,/ DSE/ )/ 和/ 目的/ 节点/ 报文/ 接收/ 证据/ (/ DestinationReceivingEvidence/ ,/ DRE/ )/ ./ 自治/ 系统/ 采用/ RSA/ 密钥/ 算法/ 生成/ 本/ 自治/ 域/ 的/ 公钥/ 和/ 私钥/ ,/ 在/ 全网/ 内/ 发布/ 公钥/ 并/ 获取/ 其他/ 自治/ 系统/ 的/ 公钥/ ,/ 利用/ 密钥/ 加密/ 路由/ 证据/ 保证/ 路由/ 证据/ 的/ 鲁棒性/ ./ 在/ 生成/ 路由/ 证据/ 之前/ ,/ 源/ 自治/ 系统/ 设计/ 证据/ 生成/ 报文/ 的/ 发送/ 策略/ ./ 首先/ 制定/ 证据/ 生成/ 报文/ 的/ 发送/ 时间/ 区间/ T/ ./ T/ 的/ 起始/ 时间/ 晚于/ 源/ 自治/ 系统/ 的/ 当前/ 时间/ ./ 源/ 自治/ 系统/ 将/ T/ 平均/ 分为/ 若干个/ 小/ 区间/ ,/ 在/ 小/ 区间/ 中/ 随机/ 选择/ k/ 个/ 不/ 连续/ 小/ 区间/ 发送/ 证据/ 生成/ 报文/ ,/ 每个/ 小/ 区间/ 内/ 报文/ 发送/ 的/ 持续时间/ 也/ 不同/ ./ 例如/ 源/ 自治/ 系统/ 将/ 1000ms/ 划分/ 为/ 10/ 个/ 区间/ ,/ 每个/ 区间/ 为/ 100ms/ ,/ 选择/ 5/ 个/ 不/ 连续/ 区间/ ,/ 即/ 2/ 、/ 4/ 、/ 6/ 、/ 8/ 和/ 10/ ,/ 在/ 这/ 5/ 个/ 区间/ 内/ 发送/ 证据/ 生成/ 报文/ ;/ 其次/ 还要/ 设计/ 证据/ 生成/ 报文格式/ ./ 依据/ RFC791/ ①/ ,/ IP/ 报文/ 分为/ 头部/ 和/ 载荷/ 两个/ 部分/ ./ 载荷/ 包含/ 报文/ 的/ 主要/ 内容/ ,/ 而/ 头部/ 则/ 包含/ 一系列/ 报文/ 选项/ ,/ 例如/ 报文/ 源地址/ ,/ 报文/ 目的/ 地址/ ,/ 时间/ 戳/ 等/ ./ 为了/ 防止/ 证据/ 生成/ 报文/ 被/ 恶意/ 自治/ 系统/ 辨别/ ,/ 源/ 自治/ 系统/ 不/ 对/ 报文/ 进行/ 任何/ 加密/ 操作/ ,/ 仅/ 在/ 报文/ 的/ 时间/ 戳/ 附加/ 报文/ 的/ 发送/ 时间/ ./ 由于/ 报文/ 发送/ 的/ 时间/ 区间/ 是/ 不/ 连续/ 的/ ,/ 且/ 不同/ 区间/ 内/ 报文/ 发送/ 的/ 持续时间/ 也/ 存在/ 差异/ ,/ 因此/ 相同/ 区间/ 内/ 报文/ 的/ 附加/ 时间/ 戳/ 是/ 相近/ 的/ ./ 证据/ 生成/ 报文/ 发送/ 策略/ 制定/ 完毕/ 后/ ,/ 源/ 自治/ 系/ ①/ IP/ ,/ ftp/ :/ // // ftp/ ./ ietf/ ./ org/ // rfc/ // rfc0792/ ./ txtPage5/ 统向/ 目的/ 自治/ 系统/ 发送/ 路由/ 证据/ 请求/ 消息/ (/ RequestofRoutingEvidence/ ,/ RRE/ )/ ,/ 定义/ 如下/ ./ 定义/ 6/ ./ 路由/ 证据/ 请求/ 消息/ RRE/ ./ RRE/ =/ {/ {/ RETflag/ ,/ Times/ ,/ Timee/ ,/ k/ ,/ IPu/ }/ RKs/ 其中/ ,/ RETflag/ 是/ 证据/ 请求/ 类型/ 标志/ 位/ ./ 如果/ 源/ 自治/ 系统/ 请求/ 的/ 证据/ 类型/ 是/ DRE/ ,/ RETflag/ =/ 0/ ;/ 当源/ 自治/ 系统/ 请求/ 的/ 证据/ 类型/ 是/ DSE/ 和/ DRE/ 时/ ,/ RETflag/ =/ 1/ ./ Times/ 是/ 整个/ 报文/ 发送/ 区间/ T/ 的/ 起始/ 时间/ ,/ 结束/ 时间/ 为/ Timee/ ./ k/ 表示/ 发送/ 报文/ 的/ 小/ 区间/ 数量/ ,/ IPu/ 是/ 目的/ 自治/ 系统/ 的/ 直接/ 上游/ 自治/ 系统/ IP地址/ ./ 源/ 自治/ 系统/ 用/ 私钥/ RKs/ 加密/ 消息/ 保证/ 其/ 不/ 被/ 中途/ 恶意/ 自治/ 系统/ 篡改/ ,/ 用/ 目的/ 自治/ 系统/ 公钥/ PKd/ 加密/ 消息/ 保证/ 只有/ 目的/ 自治/ 系统/ 可以/ 获悉/ 消息/ 内容/ ./ 目的/ 自治/ 系统/ 接收/ RRE/ 后/ ,/ 确认/ 自身/ 当前/ 时间/ 早于/ Times/ ,/ 向源/ 自治/ 系统/ 返回/ 路由/ 证据/ 确认/ 消息/ (/ AcknowledgementofRequest/ ,/ AOR/ )/ ,/ 定义/ 如下/ ./ 定义/ 7/ ./ 路由/ 证据/ 确认/ 消息/ AOR/ ./ AOR/ =/ {/ {/ RETflag/ ,/ Times/ ,/ Timee/ ,/ k/ ,/ IPu/ }/ RKd/ 其中/ ,/ RETflag/ ,/ Times/ ,/ Timee/ ,/ k/ 和/ IPu/ 与/ RRE/ 消息/ 中/ 对应/ 项/ 的/ 值/ 相同/ ,/ 目的/ 自治/ 系统/ 用/ 私钥/ RKd/ 和源/ 自治/ 系统/ 公钥/ PKs/ 加密/ 消息/ ./ 源/ 自治/ 系统/ 收到/ AOR/ 后/ ,/ 确认/ 目的/ 自治/ 系统/ 收到/ RRE/ 消息/ ./ 当/ 时间/ 到达/ Times/ 时/ ,/ 源/ 自治/ 系统/ 执行/ 报文/ 发送/ 策略/ ,/ 在/ k/ 个/ 不/ 连续/ 的/ 时间/ 区间/ 内/ 发送/ 报文/ ./ 如果/ 当前/ 时间/ 晚于/ Times/ ,/ 源/ 自治/ 系统/ 需/ 重新制定/ 报文/ 发送/ 策略/ ./ 源/ 自治/ 系统/ 统计/ 每个/ 发送/ 区间/ 内/ 发送/ 的/ 报文/ 长度/ s/ ,/ 获得/ 报文/ 长度/ 集合/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sk/ }/ ,/ 对/ 集合/ 中/ 的/ 元素/ 取/ 对数/ 以/ 减少/ 异常/ 值/ 的/ 影响/ ,/ 得到/ Slog/ =/ {/ log/ (/ s1/ )/ ,/ log/ (/ s2/ )/ ,/ …/ ,/ log/ (/ sk/ )/ }/ ,/ 继而/ 生成/ 源/ 自治/ 系统/ 报文/ 发送/ 证据/ SSE/ ./ 定义/ 8/ ./ 源/ 自治/ 系统/ 报文/ 发送/ 证据/ SSE/ ./ SSE/ =/ {/ SSElabel/ ,/ Times/ ,/ Timee/ ,/ k/ ,/ IPd/ ,/ Slog/ }/ RKs/ 其中/ ,/ SSElabel/ 是/ SSE/ 标签/ ,/ Times/ 是/ T/ 的/ 起始/ 时间/ ,/ 结束/ 时间/ 为/ Timee/ ./ k/ 表示/ 发送/ 报文/ 的/ 小/ 区间/ 数目/ ,/ IPd/ 是/ 目的/ 自治/ 系统/ 的/ IP地址/ ,/ Slog/ 是/ 报文/ 长度/ 集合/ ,/ 源/ 自治/ 系统/ 用/ 私钥/ RKs/ 加密/ 证据/ 内容/ ./ 考虑/ 不同/ 自治/ 系统/ 的/ 时钟/ 可能/ 不/ 同步/ ,/ 为了/ 避免/ 时钟/ 不/ 同步/ 对/ 路由/ 证据/ 的/ 生成/ 造成/ 影响/ ,/ 目的/ 自治/ 系统/ 向源/ 自治/ 系统/ 反馈/ AOR/ 信息/ 后/ 即/ 开始/ 监听/ 边界/ 路由器/ 连接/ 直接/ 上游/ 自治/ 系统/ IPu/ 的/ 网络/ 端口/ ,/ 收集/ 源地址/ 为源/ 自治/ 系统/ IP/ 、/ 时间/ 戳/ 介于/ Times/ 和/ Timee/ 之间/ 的/ 报文/ ,/ 并/ 根据/ RRE/ 中/ RETflag/ 的/ 值/ 生成/ 相应/ 的/ 证据/ ./ 由于/ IP/ 协议/ 的/ best/ -/ efforts/ 机制/ ,/ 目的/ 自治/ 系统/ 接收/ 的/ IP/ 报文/ 可能/ 是/ 混乱/ 排列/ 的/ ./ 为了/ 生成/ 正确/ 的/ 路由/ 证据/ ,/ 它/ 必须/ 采用/ K/ -/ means/ [/ 14/ ]/ 聚类/ 算法/ 对/ 接收/ 的/ 数据/ 报文/ 进行/ 聚类/ 处理/ ./ 算法/ 以/ 报文/ 时间/ 戳/ 为/ 聚类/ 特征值/ ,/ 随机/ 选择/ k/ 个/ 对象/ 代表/ k/ 个/ 区间/ 内/ 报文/ 时间/ 戳/ 的/ 平均值/ ./ 执行/ 算法/ 得到/ 报文/ 长度/ 集合/ 为/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sk/ }/ ,/ 对/ 报文/ 长度/ 集合/ 中/ 元素/ 取/ 对数/ 可得/ Slog/ =/ {/ log/ (/ s1/ )/ ,/ log/ (/ s2/ )/ ,/ …/ ,/ log/ (/ sk/ )/ }/ ./ 目的/ 自治/ 系统/ 依据/ 报文/ 分析/ 结果/ 生成/ 报文/ 接收/ 证据/ DRE/ ./ 定义/ 9/ ./ 目的/ 自治/ 系统/ 报文/ 接收/ 证据/ DRE/ ./ DRE/ =/ {/ {/ DRElabel/ ,/ Times/ ,/ Timee/ ,/ k/ ,/ IPs/ ,/ 其中/ ,/ DRElabel/ 是/ DRE/ 标签/ ,/ Times/ 、/ Timee/ 、/ k/ 与/ SSE/ 中/ 对应/ 项/ 的/ 值/ 相同/ ./ IPs/ 是/ 源/ 自治/ 系统/ 的/ IP地址/ ,/ IPu/ 是/ 目的/ 自治/ 系统/ 的/ 直接/ 上游/ 自治/ 系统/ 的/ IP地址/ ,/ Slog/ 是/ 报文/ 长度/ 集合/ ,/ 目的/ 自治/ 系统/ 用/ 私钥/ RKd/ 和源/ 自治/ 系统/ 公钥/ PKs/ 加密/ 证据/ 内容/ ./ 根据/ DRE/ 的/ 生成/ 过程/ ,/ 可以/ 发现/ 当/ 路径/ 是/ 正常/ 路径/ 时/ DRE/ 与/ SSE/ 是/ 匹配/ 关系/ ,/ 即/ 对于/ 任意/ 的/ SSE/ ,/ 目的/ 自治/ 系统/ 接收/ 来自/ 源/ 自治/ 系统/ 的/ 证据/ 生成/ 报文/ ,/ 生成/ 唯一/ 的/ DRE/ ,/ 使得/ 证据/ 内容/ Times/ 、/ Timee/ 和/ k/ 相同/ ,/ 同时/ Slog/ =/ Slog/ ./ 实际/ 网络/ 中/ 链路/ 拥塞/ 等/ 原因/ 会/ 造成/ 网络/ 丢包/ ,/ 这种/ 情况/ 下/ Slog/ 与/ Slog/ 会/ 存在/ 一定/ 的/ 误差/ ./ 为了/ 解决/ 这个/ 问题/ ,/ 在/ 此/ 给出/ 证据/ 误差/ μ/ 的/ 计算方法/ :/ 其中/ ,/ ρ/ i/ 是/ 第/ i/ 个/ 时间/ 区间/ 内/ 发送/ 报文/ 的/ 长度/ si/ 占/ 整个/ 时间/ 区间/ 发送/ 报文/ 长度/ 的/ 比例/ :/ 设/ 网络/ 丢/ 包率/ 为/ ξ/ ,/ ξ/ 在/ 一定/ 时间/ 内会/ 有/ 波动/ ./ 如果/ 证据/ 误差/ μ/ 与/ 时间/ 区间/ T/ 内/ Max/ (/ ξ/ )/ 的/ 差值/ 小于/ 等于/ 误差/ 容忍度/ θ/ ,/ 我们/ 仍然/ 认为/ Slog/ =/ Slog/ ,/ 即/ 认为/ SSE/ 和/ DRE/ 是/ 匹配/ 的/ ./ 随着/ 网络/ 丢/ 包率/ 的/ 增加/ ,/ 我们/ 可以/ 加长/ 报文/ 发送/ 区间/ ,/ 增加/ 发送/ 报文/ 长度/ ,/ 同时/ 增大/ 误差/ 容忍度/ ,/ 保证/ 路由/ 证据/ 比较/ 结果/ 的/ 准确性/ ./ 在/ DRE/ 的/ 生成/ 过程/ 中/ ,/ 目的/ 自治/ 系统/ 需要/ 监听/ 到/ 来自/ 直接/ 上游/ 自治/ 系统/ 所有/ 的/ 证据/ 生成/ 报文/ ,/ 才/ 可以/ 生成/ 与/ SSE/ 匹配/ 的/ DRE/ ./ DSE/ 则/ 反映/ 目的/ 自治/ 系统/ 是否/ 将/ 接收/ 的/ 证据/ 生成/ 报文/ 沿着/ 当前/ 路径/ 转发/ 至/ 直接/ 下游/ 自治/ 系统/ ./ 然而/ 即使/ 恶意/ 自治/ 系统/ 将/ Page6/ 证据/ 生成/ 报文/ 转发/ 至/ 其他/ 直接/ 下游/ 自治/ 系统/ ,/ 它/ 仍然/ 可以/ 生成/ 与/ SSE/ 匹配/ 的/ DSE/ ,/ 因此/ DSE/ 反映/ 的/ 路由/ 行为/ 并/ 不/ 可靠/ ./ DSE/ 定义/ 如下/ ./ 定义/ 10/ ./ 目的/ 自治/ 系统/ 报文/ 发送/ 证据/ DSE/ ./ 其中/ ,/ DSElabel/ 是/ DSE/ 标签/ ,/ Times/ 、/ Timee/ 、/ k/ 、/ IPs/ 、/ Slog/ 与/ DRE/ 中/ 对应/ 项/ 的/ 值/ 相同/ ./ IPds/ 是/ 直接/ 下游/ 自治/ 系统/ 的/ IP地址/ ./ 目的/ 自治/ 系统/ 用/ 私钥/ RKd/ 和源/ 自治/ 系统/ 公钥/ PKs/ 加密/ 证据/ 内容/ ./ 4.2/ 基于/ 路由/ 证据/ 的/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 方法/ MADM/ 需要/ 路由/ 路径/ 中/ 多个/ 自治/ 系统/ 协同/ 合作/ 执行/ 路径/ 检测/ ./ 路由/ 路径/ 的/ 源/ 节点/ 是/ 检测/ 机制/ 的/ 发起/ 节点/ ./ 目的/ 节点/ 基本/ 是/ 网络/ 的/ 边缘/ 节点/ (/ StubAS/ )/ ,/ 并/ 不是/ 传输/ 节点/ (/ TransitAS/ )/ ,/ 不/ 存在/ 通告/ 不/ 一致/ 路径/ 的/ 动机/ ,/ 因此/ 我们/ 认为/ 源/ 节点/ 和/ 目的/ 节点/ 为/ 正常/ 节点/ ./ 与/ 相关/ 研究/ 工作/ [/ 8/ ,/ 11/ ]/ 类似/ ,/ 本文/ 只/ 考虑/ 路由/ 路径/ 中/ 存在/ 一个/ 恶意/ 节点/ 的/ 情况/ ./ 根据/ 第/ 3/ 节/ 恶意/ 自治/ 系统/ 的/ 定义/ ,/ 可知/ 如果/ 路径/ 存在/ 不/ 一致/ 问题/ ,/ 则/ 路径/ 中/ 的/ 恶意/ 节点/ 一定/ 沿着/ 其他/ 路径/ 将/ 报文/ 转发给/ 非/ 路径/ 中/ 的/ 节点/ ./ 受此/ 启发/ ,/ 本/ 检测/ 方法/ 以/ 节点/ 路由/ 证据/ 比较/ 的/ 方式/ ,/ 从/ 目的/ 节点/ 开始/ 逐个/ 验证/ 直接/ 上游/ 节点/ ,/ 判断/ 直接/ 上游/ 节点/ 是否/ 沿着/ 当前/ 路径/ 将/ 报文/ 转发/ 至/ 目的/ 节点/ ./ 检测/ 方法/ 分为/ 两个/ 部分/ :/ 第/ 1/ 部分/ 是/ 可疑/ 节点/ 检测/ 算法/ ,/ 第/ 2/ 部分/ 是/ 恶意/ 节点/ 检测/ 算法/ ./ 在/ 可疑/ 节点/ 检测/ 算法/ 中/ ,/ 源/ 节点/ 生成/ SSE/ ,/ 与/ 目的/ 节点/ 的/ 报文/ 接收/ 证据/ DRE/ 进行/ 比较/ ./ 当/ 目的/ 节点/ 的/ DRE/ 与源/ 节点/ 的/ SSE/ 匹配/ 时/ ,/ 将/ 目的/ 节点/ 的/ 直接/ 上游/ 节点/ 替换/ 为/ 目的/ 节点/ ,/ 继续/ 比较/ 证据/ ./ 如果/ 所有/ 节点/ 的/ DRE/ 均/ 与/ 源/ 节点/ 的/ SSE/ 匹配/ ,/ 表明/ 当前/ 路径/ 不/ 存在/ 不/ 一致/ 问题/ ./ 当某/ 一/ 节点/ 的/ DRE/ 与源/ 节点/ SSE/ 不/ 匹配/ 时/ ,/ 源/ 节点/ 向/ 此/ 节点/ 的/ 上游/ 节点/ 逐个/ 请求/ 路由/ 证据/ DRE/ 和/ DSE/ ,/ 依据/ 证据/ 的/ 比较/ 结果/ 确定/ 可疑/ 节点/ 范围/ 并/ 将/ 范围/ 缩小/ 至/ 两个/ 节点/ ./ 在/ 恶意/ 节点/ 检测/ 算法/ 中/ ,/ 源/ 节点/ 查询/ 离/ 自身/ 较近/ 的/ 可疑/ 节点/ 的/ 直接/ 上游/ 节点/ 的/ 路由/ 通告/ 历史记录/ ,/ 对/ 可能/ 接收/ 可疑/ 节点/ 报文/ 的/ 节点/ 请求/ 路由/ 证据/ DRE/ ,/ 依据/ SSE/ 和/ DRE/ 的/ 比较/ 结果/ 确定/ 恶意/ 节点/ ./ 4.2/ ./ 1/ 可疑/ 节点/ 检测/ 算法/ 在/ 介绍/ 检测/ 算法/ 之前/ ,/ 先/ 给出/ 证据/ 比较/ 布尔/ 函数/ F/ (/ x/ ,/ y/ )/ 的/ 定义/ ./ 定义/ 11/ ./ 证据/ 比较/ 布尔/ 函数/ F/ (/ x/ ,/ y/ )/ ./ 证据/ 比较/ 布尔/ 函数/ 表示/ 路由/ 证据/ 的/ 比较/ 结果/ :/ 其中/ ,/ x/ 代表/ 源/ 节点/ 生成/ 的/ 路由/ 证据/ SSE/ ,/ y/ 代表/ 目的/ 节点/ 生成/ 的/ 路由/ 证据/ ./ 根据/ 布尔/ 函数/ 的/ 定义/ [/ 15/ ]/ ,/ 我们/ 设定/ x/ ∈/ {/ 1/ }/ ,/ 表示/ 源/ 自治/ 系统/ 总是/ 依据/ 报文/ 发送/ 的/ 策略/ 生成/ 正确/ 的/ SSE/ ./ 设定/ y/ ∈/ {/ 0/ ,/ 1/ }/ ,/ y/ 为/ 1/ 时/ 表示/ 目的/ 自治/ 系统生成/ 与/ SSE/ 匹配/ 的/ 路由/ 证据/ ,/ 反之/ y/ 为/ 0/ ./ 相应/ 的/ ,/ F/ (/ x/ ,/ y/ )/ ∈/ {/ 0/ ,/ 1/ }/ ,/ F/ (/ x/ ,/ y/ )/ =/ 1/ 表示/ 证据/ 匹配/ ,/ F/ (/ x/ ,/ y/ )/ =/ 0/ 表示/ 证据/ 不/ 匹配/ ./ 设/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ )/ ,/ i/ >/ 0/ 是/ 源/ 节点/ 为/ v0/ ,/ 目的/ 节点/ 为/ vi/ 的/ 路由/ 路径/ ./ v0/ 生成/ SSE/ ,/ 同时/ 要求/ vi/ 生成/ DRE/ ./ 我们/ 用/ σ/ i/ 和/ τ/ i/ 分别/ 表示/ 此时/ 的/ SSE/ 和/ DRE/ ./ v0/ 与/ vi/ 比较/ 证据/ ,/ 获得/ F/ (/ σ/ i/ ,/ τ/ i/ )/ ./ 如果/ F/ (/ σ/ i/ ,/ τ/ i/ )/ =/ 1/ ,/ 表明/ vi/ 的/ 直接/ 上游/ 节点/ vi/ -/ 1/ 沿着/ 正常/ 路径/ vi/ -/ 1vi/ 转发/ 报文/ ./ 算法/ 将/ vi/ -/ 1/ 标记/ 为/ 正常/ 节点/ ,/ 将/ vi/ 替换/ 为/ vi/ -/ 1/ ,/ 继续/ 检查/ vi/ -/ 1/ 的/ 直接/ 上游/ 节点/ vi/ -/ 2/ ./ 当/ vi/ =/ v1ik/ =/ 2F/ (/ σ/ k/ ,/ τ/ k/ )/ =/ i/ -/ 1/ ,/ 表明/ 路径/ 的/ 所有/ 节点均/ 可/ 从/ 时/ ,/ ∑/ 直接/ 上游/ 节点/ 正常/ 接收/ 证据/ 生成/ 报文/ ,/ 当前/ 路径/ 不/ 存在/ 不/ 一致/ 问题/ ;/ 如果/ 存在/ 节点/ vj/ ,/ 使得/ F/ (/ σ/ j/ ,/ τ/ j/ )/ =/ 0/ ,/ 表明/ vj/ 没有/ 从/ vj/ -/ 1/ 正常/ 接收/ 证据/ 生成/ 报文/ ,/ 导致/ 其/ DRE/ 与/ v0/ 的/ SSE/ 不/ 匹配/ ./ 当/ j/ =/ 2/ 时/ ,/ F/ (/ σ/ 2/ ,/ τ/ 2/ )/ =/ 0/ ,/ 由于/ v0/ 节点/ 是/ 正常/ 节点/ ,/ 肯定/ 发送/ 证据/ 生成/ 报文/ 至/ v1/ ,/ 并且/ 算法/ 的/ 执行/ 顺序/ 与/ 节点/ 排列/ 顺序/ 相反/ ,/ 即/ v2/ 已经/ 被/ 证明/ 是/ 正常/ 节点/ ,/ 因此/ v1/ 为/ 恶意/ 节点/ ,/ 整个/ 检测/ 算法/ 结束/ ./ 当/ j/ ∈/ (/ 2/ ,/ i/ ]/ 时/ ,/ 位于/ v0/ 和/ vj/ 之间/ 的/ 节点均/ 有/ 可能/ 是/ 恶意/ 节点/ ,/ 用/ V/ 表示/ v0/ 与/ vj/ 之间/ 的/ 节点/ ,/ 得到/ V/ =/ {/ v1/ ,/ v2/ ,/ …/ ,/ vj/ -/ 1/ }/ ,/ 为/ 后续/ 可疑/ 节点/ 检测/ 提供/ 信息/ ./ v0/ 将/ RRE/ 中/ 的/ RETflag/ 设置/ 为/ 1/ ,/ 要求/ V/ 内/ 的/ 节点/ 同时/ 生成/ DRE/ 和/ DSE/ ,/ 进行/ 两类/ 证据/ 比较/ ./ 为了/ 表述/ 方便/ ,/ 在/ 证据/ 比较/ 布尔/ 函数/ 的/ 基础/ 上/ 我们/ 定义/ 证据/ 完全/ 比较/ 布尔/ 函数/ R/ (/ x/ ,/ z/ ,/ r/ )/ ./ 定义/ 12/ ./ 证据/ 完全/ 比较/ 布尔/ 函数/ R/ (/ x/ ,/ z/ ,/ r/ )/ ./ 证据/ 完全/ 比较/ 布尔/ 函数/ 表示/ 两类/ 路由/ 证据/ 的/ 比较/ 结果/ :/ 其中/ ,/ x/ 代表/ 源/ 节点/ 生成/ 的/ 路由/ 证据/ SSE/ ,/ z/ 代表/ 目的/ 节点/ 生成/ 的/ 路由/ 证据/ DRE/ ,/ r/ 代表/ 目的/ 节点/ 生成/ 的/ 路由/ 证据/ DSE/ ./ x/ 取值/ 范围/ 与/ F/ (/ x/ ,/ y/ )/ 中/ x/ 的/ 取值/ 范围/ 相同/ ,/ z/ 和/ r/ 的/ 取值/ 范围/ 与/ F/ (/ x/ ,/ y/ )/ 中/ y/ 的/ 取值/ 范围/ 相同/ ./ 据/ 布尔/ 函数/ 的/ 定义/ [/ 15/ ]/ ,/ R/ (/ x/ ,/ z/ ,/ r/ )/ ∈/ {/ 0/ ,/ 1/ }/ ./ F/ (/ x/ ,/ z/ )/ 和/ F/ (/ x/ ,/ r/ )/ 均/ 为/ 0/ 时/ R/ (/ x/ ,/ z/ ,/ r/ )/ =/ 0/ ,/ 表示/ 目的/ 节点/ 不能/ 产生/ 与源/ 节点/ SSE/ 匹配/ 的/ DREPage7/ 和/ DSE/ ./ F/ (/ x/ ,/ z/ )/ 和/ F/ (/ x/ ,/ r/ )/ 中/ 只要/ 有/ 一个/ 值为/ 1/ 时/ R/ (/ x/ ,/ z/ ,/ r/ )/ 即可/ 为/ 1/ ,/ 我们/ 在下文/ 中/ 根据/ 具体/ 场景/ 分析/ 其/ 意义/ ./ 算法/ 执行/ 顺序/ 仍然/ 与/ 节点/ 排列/ 顺序/ 相反/ ,/ v0/ 首先/ 与/ vj/ -/ 1/ 比较/ 路由/ 证据/ ./ 我们/ 用/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ 和/ δ/ j/ -/ 1/ 分别/ 表示/ 此时/ 的/ SSE/ ,/ DRE/ 和/ DSE/ ./ 依据/ R/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ 的/ 取值/ ,/ 检测/ 算法/ 分为/ 两种/ 情况/ 执行/ :/ (/ 1/ )/ R/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 1/ ,/ vj/ -/ 1/ 是/ 恶意/ 节点/ ,/ 算法/ 结束/ ./ 首先/ 假设/ R/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 1/ 时/ ,/ F/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ )/ 和/ F/ (/ σ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ 均/ 为/ 1/ ,/ 表明/ vj/ -/ 1/ 从子/ 路径/ vj/ -/ 2vj/ -/ 1/ 正常/ 接收/ 且/ 声称/ 正常/ 发送/ 证据/ 生成/ 报文/ 至/ 下游/ 节点/ vj/ ./ 根据/ 算法/ 流程/ 可知/ ,/ F/ (/ σ/ j/ ,/ τ/ j/ )/ =/ 0/ ,/ 即/ vj/ 从子/ 路径/ vj/ -/ 1vj/ 接收/ 证据/ 生成/ 报文/ 存在/ 异常/ ./ 同时/ 检测/ 结果/ 已经/ 证明/ vj/ 是/ 正常/ 节点/ ,/ 它/ 的/ 路由/ 证据/ 是/ 可信/ 的/ ./ 上文/ 提到/ DSE/ 的/ 可靠性/ 无法/ 保证/ ,/ 因此/ 判定/ vj/ -/ 1/ 没有/ 生成/ 真实/ 的/ DSE/ ,/ 是/ 恶意/ 节点/ ./ 由于/ P/ 仅/ 存在/ 一个/ 恶意/ 节点/ ,/ 整个/ 检测/ 算法/ 结束/ ./ 其次/ 假设/ F/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ )/ =/ 1/ 而/ F/ (/ σ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 0/ ,/ 表明/ vj/ -/ 1/ 从/ vj/ -/ 2/ 正常/ 接收/ 证据/ 生成/ 报文/ 但是/ 并/ 没有/ 沿着/ 子/ 路径/ vj/ -/ 1vj/ 发送/ 证据/ 生成/ 报文/ ,/ “/ 承认/ ”/ 其/ 没有/ 沿着/ 正常/ 路径/ 转发/ 报文/ ./ 依据/ 定义/ 5/ ,/ 我们/ 同样/ 认为/ vj/ -/ 1/ 是/ 恶意/ 节点/ ,/ 整个/ 检测/ 算法/ 结束/ ./ 需要/ 注意/ 的/ 是/ F/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ )/ =/ 0/ 且/ F/ (/ σ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 1/ 的/ 情况/ 没有/ 讨论/ ,/ 因为/ 根据/ 路由/ 证据/ 定义/ ,/ vj/ -/ 1/ 不/ 可能/ 在/ 没有/ 正常/ 接收/ 证据/ 生成/ 报文/ 的/ 情况/ 下/ 生成/ 与/ SSE/ 匹配/ 的/ DSE/ ./ (/ 2/ )/ R/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 0/ ,/ v0/ 继续/ 向/ vj/ -/ 1/ 的/ 直接/ 上游/ 节点/ vj/ -/ 2/ 请求/ 路由/ 证据/ DRE/ 和/ DSE/ ,/ 算法/ 继续执行/ ./ R/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 0/ 意味着/ vj/ -/ 1/ 声称/ 没有/ 从子/ 路径/ vj/ -/ 2vj/ -/ 1/ 正常/ 接收/ 和/ 发送/ 证据/ 生成/ 报文/ ,/ 此时/ 无法/ 判断/ 证据/ 真实性/ ,/ 不能/ 对/ vj/ -/ 1/ 进行/ 判定/ ,/ 只能/ 继续执行/ 检测/ 算法/ ./ 检测/ 算法/ 最终/ 在/ vj/ -/ h/ 节点/ 执行/ 完毕/ ,/ 符合/ 以下/ 两个/ 条件/ 之一/ :/ j/ -/ h/ / 1/ 且/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 1/ ,/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 0/ 且/ j/ -/ h/ =/ 1/ ./ 依据/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ 的/ 取值/ ,/ 算法/ 执行/ 结果/ 分为/ 3/ 种/ 情况/ :/ (/ 1/ )/ j/ -/ h/ / 1/ 且/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 1/ +/ 1/ =/ 1/ ,/ 可疑/ 节点/ 是/ vj/ -/ h/ 和/ vj/ -/ h/ +/ 1/ ,/ 用/ V/ 表示/ 可疑/ 节点/ 集合/ ,/ 可得/ V/ =/ {/ vj/ -/ h/ ,/ vj/ -/ h/ +/ 1/ }/ ./ 此时/ F/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ )/ 和/ F/ (/ σ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ 均/ 为/ 1/ ,/ 表明/ vj/ -/ h/ 从子/ 路径/ vj/ -/ h/ -/ 1vj/ -/ h/ 正常/ 接收/ 证据/ 生成/ 报文/ ,/ 并/ 正常/ 发送/ 报文/ 到/ vj/ -/ h/ +/ 1/ ./ 由于/ 算法/ 是/ 反序/ 进行/ ,/ 依据/ 上文/ 分析/ 可得/ R/ (/ σ/ j/ -/ h/ +/ 1/ ,/ τ/ j/ -/ h/ +/ 1/ ,/ δ/ j/ -/ h/ +/ 1/ )/ =/ 0/ ,/ 即/ vj/ -/ h/ +/ 1/ 声称/ 没有/ 从/ 直接/ 上游/ 节点/ vj/ -/ h/ 正常/ 接收/ 证据/ 生成/ 报文/ ,/ 与/ vj/ -/ h/ 的/ 路由/ 证据/ 矛盾/ ,/ 说明/ 两个/ 节点/ 中必/ 有/ 一个/ 节点/ 伪造/ 路由/ 证据/ ,/ 因此/ 两者/ 构成/ 可疑/ 节点/ 集合/ ./ (/ 2/ )/ j/ -/ h/ / 1/ 且/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 1/ +/ 0/ =/ 1/ ,/ 恶意/ 节点/ 是/ vj/ -/ h/ ./ 此时/ F/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ )/ =/ 1/ 而/ F/ (/ σ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 0/ ,/ 结合/ vj/ -/ h/ +/ 1/ 的/ 证据/ 结果/ R/ (/ σ/ j/ -/ h/ +/ 1/ ,/ τ/ j/ -/ h/ +/ 1/ ,/ δ/ j/ -/ h/ +/ 1/ )/ =/ 0/ ,/ 可得/ vj/ -/ 1/ 是/ 恶意/ 节点/ ./ (/ 3/ )/ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 0/ 且/ j/ -/ h/ =/ 1/ ,/ v1/ 是/ 恶意/ 节点/ ./ R/ (/ σ/ j/ -/ h/ ,/ τ/ j/ -/ h/ ,/ δ/ j/ -/ h/ )/ =/ 0/ 且/ j/ -/ h/ =/ 1/ ,/ 表明/ 节点/ 集合/ V/ =/ {/ v1/ ,/ v2/ ,/ …/ ,/ vj/ -/ 1/ }/ 中/ 所有/ 节点均/ 没有/ 从/ 直接/ 上游/ 节点/ 正常/ 接收/ 证据/ 生成/ 报文/ ./ 由于/ v0/ 肯定/ 发送/ 了/ 证据/ 生成/ 报文/ 且/ P/ 中/ 只/ 存在/ 一个/ 恶意/ 节点/ ,/ 因此/ 判断/ v0/ 的/ 直接/ 下游/ 节点/ v1/ 的/ 路由/ 证据/ 不/ 真实/ ,/ v1/ 是/ 恶意/ 节点/ ./ 算法/ 的/ 详细/ 流程/ 见/ 算法/ 1/ ./ 算法/ 1/ ./ 可疑/ 节点/ 检测/ 算法/ ./ 输入/ :/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ )/ ,/ i/ >/ 0/ ./ F/ (/ x/ ,/ y/ )/ ,/ R/ (/ x/ ,/ z/ ,/ r/ )/ ./ 输出/ :/ 恶意/ 节点/ vr/ 或者/ 可疑/ 节点/ 集合/ V1/ ./ FORvi/ ∈/ PDO2/ ./ IFF/ (/ σ/ i/ ,/ τ/ i/ )/ =/ 1THEN3/ ./ i/ =/ i/ -/ 1/ ;/ 4/ ./ IFvi/ =/ v1THEN5/ ./ RETURN/ ;/ 6/ ./ ELSE7/ ./ CONTINUE/ ;/ 8/ ./ ENDIF9/ ./ ELSE10/ ./ j/ =/ i/ ;/ 11/ ./ IFvj/ =/ v2THEN12/ ./ vr/ =/ v1/ ;/ 13/ ./ RETURNvr/ ;/ 14/ ./ ELSE15/ ./ V/ =/ {/ v1/ ,/ v2/ ,/ …/ ,/ vj/ -/ 1/ }/ ,/ j/ ∈/ (/ 2/ ,/ i/ ]/ ;/ 16/ ./ BREAK/ ;/ 17/ ./ ENDIF18/ ./ ENDIF19/ ./ ENDFOR20/ ./ IFR/ (/ σ/ j/ -/ 1/ ,/ τ/ j/ -/ 1/ ,/ δ/ j/ -/ 1/ )/ =/ 1THEN21/ ./ vr/ =/ vj/ -/ 1/ ;/ 22/ ./ RETURNvr/ ;/ 23/ ./ ELSE24/ ./ FORvj/ -/ 2/ ∈/ VDOPage825/ ./ IFR/ (/ σ/ j/ -/ 2/ ,/ τ/ j/ -/ 2/ ,/ δ/ j/ -/ 2/ )/ =/ 1/ +/ 1/ =/ 1THEN26/ ./ V/ =/ {/ vj/ -/ 2/ ,/ vj/ -/ 1/ }/ ;/ 27/ ./ RETURNV/ ;/ 28/ ./ ELSEIFR/ (/ σ/ j/ -/ 2/ ,/ τ/ j/ -/ 2/ ,/ δ/ j/ -/ 2/ )/ =/ 1/ +/ 0/ =/ 1THEN29/ ./ vr/ =/ vj/ -/ 2/ ;/ 30/ ./ RETURNvr/ ;/ 31/ ./ ELSEIFR/ (/ σ/ j/ -/ 2/ ,/ τ/ j/ -/ 2/ ,/ δ/ j/ -/ 2/ )/ =/ 0andj/ -/ 2/ =/ 1THEN32/ ./ vr/ =/ v1/ ;/ 33/ ./ RETURNvr/ ;/ 34/ ./ ELSE35/ ./ j/ =/ j/ -/ 1/ ;/ 36/ ./ CONTINUE/ ;/ 37/ ./ ENDIF38/ ./ ENDFOR39/ ./ ENDIF/ 以/ 一个/ 具体/ 实例/ 描述/ 算法/ 过程/ (/ 如图/ 2/ 所示/ )/ ,/ 路由/ 路径/ 为/ P/ =/ (/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ )/ ./ 源/ 节点/ 为/ a/ ,/ 目的/ 节点/ 为/ e/ ,/ 阴影/ 圆形/ 表示/ 目的/ 节点/ 的/ 直接/ 上游/ 节点/ ./ 依据/ 检测/ 算法/ ,/ 首先/ a/ 向/ e/ 请求/ 路由/ 证据/ DRE/ ,/ e/ 监听/ 并/ 分析/ 直接/ 上游/ 节点/ d/ 发送/ 的/ 报文/ ,/ 生成/ DRE/ 并/ 发送至/ a/ ./ a/ 生成/ SSE/ 并/ 比较/ SSE/ 与/ DRE/ ,/ 如果/ 证据/ 内容/ 匹配/ ,/ 则/ 确认/ d/ 沿着/ 子/ 路径/ de/ 将/ 报文/ 发送至/ e/ ,/ d/ 是/ 正常/ 节点/ ./ 然后/ a/ 将/ d/ 作为/ 目的/ 节点/ ,/ 向/ d/ 请求/ 路由/ 证据/ DRE/ ,/ 对/ c/ 进行/ 检测/ ./ 如果/ 检测/ c/ 没有/ 问题/ ,/ 算法/ 将/ c/ 作为/ 目的/ 节点/ 继续/ 检测/ b/ ./ 当/ b/ 为/ 目的/ 节点/ 时/ 表明/ 路径/ 的/ 所有/ 节点均/ 为/ 正常/ 节点/ ,/ 路径/ 不/ 存在/ 不/ 一致/ 问题/ ,/ 算法/ 结束/ ./ 如果/ e/ 不能/ 产生/ 与/ a/ 的/ SSE/ 相匹配/ 的/ DRE/ ,/ 表明/ e/ 没有/ 从子/ 路径/ de/ 获得/ 证据/ 生成/ 报文/ ,/ 但是/ 并/ 不能/ 确定/ d/ 节点/ 是/ 恶意/ 节点/ ,/ 因为/ b/ ,/ c/ 和/ d/ 均/ 可能/ 通过/ f/ 转发/ 报文/ 至/ e/ ,/ 得到/ V/ =/ {/ b/ ,/ c/ ,/ d/ }/ (/ 如图/ 3/ 所示/ )/ ./ 依据/ 检测/ 算法/ ,/ a/ 向/ d/ 请求/ 路由/ 证据/ DRE/ 和/ DSE/ ,/ 如果/ d/ 的/ 路由/ 证据/ 结果/ R/ (/ σ/ d/ ,/ τ/ d/ ,/ δ/ d/ )/ =/ 1/ ,/ a/ 确定/ d/ 是/ 恶意/ 节点/ ,/ 算法/ 结束/ ./ 如果/ R/ (/ σ/ d/ ,/ τ/ d/ ,/ δ/ d/ )/ =/ 0/ ,/ a/ 继续/ 向/ c/ 请求/ 路由/ 证据/ DRE/ 和/ DSE/ ./ 当/ R/ (/ σ/ c/ ,/ τ/ c/ ,/ δ/ c/ )/ =/ 0/ 时/ 继续/ 向/ b/ 请求/ 路由/ 证据/ ./ 当/ R/ (/ σ/ b/ ,/ τ/ b/ ,/ δ/ b/ )/ =/ 1/ 时/ ,/ 如果/ F/ (/ σ/ b/ ,/ τ/ b/ )/ 和/ F/ (/ σ/ b/ ,/ δ/ b/ )/ 均/ 为/ 1/ ,/ 则/ b/ 和/ c/ 之间/ 有/ 一个/ 节点/ 是/ 恶意/ 节点/ ,/ V/ =/ {/ b/ ,/ c/ }/ ,/ 否则/ b/ 是/ 恶意/ 节点/ ./ 当/ R/ (/ σ/ b/ ,/ τ/ b/ ,/ δ/ b/ )/ =/ 0/ 时/ ,/ b/ 仍然/ 为/ 恶意/ 节点/ ./ 4.2/ ./ 2/ 恶意/ 节点/ 检测/ 算法/ 由于/ V/ 内/ 的/ 节点均/ 可能/ 是/ 恶意/ 节点/ ,/ 它们/ 的/ 路由/ 证据/ 真实性/ 无法/ 保证/ ,/ 源/ 节点/ 无法/ 与/ 它们/ 比较/ 证据/ ,/ 因此/ 恶意/ 节点/ 检测/ 算法/ 必须/ 设计/ 新/ 的/ 检测/ 方式/ ./ 在/ 介绍/ 恶意/ 节点/ 检测/ 算法/ 之前/ ,/ 我们/ 首先/ 介绍/ 路由/ 通告/ 历史记录/ (/ RouteLog/ )/ ./ RouteLog/ 由/ 自治/ 系统维护/ ,/ 按照/ 二元/ 组/ {/ 路由/ 通告/ 的/ 发送/ 节点/ ,/ 路由/ 通告/ 的/ 目的/ 节点/ }/ 索引/ ,/ 记录/ 相邻/ 节点/ 的/ 路由/ 通告/ 历史/ 信息/ ./ Page9/ 设/ vr/ 是/ 节点/ vk/ 的/ 邻居/ 节点/ ,/ 则/ vk/ 的/ RouteLog/ ,/ d/ 表示/ vr/ 向/ vk/ 发送/ 的/ 目的/ 节点/ 为/ d/ 的/ 历史/ 路中/ Uvr/ 由/ 通告/ 集合/ ./ Uvr/ 前/ 最优/ 路径/ 子/ 路径/ 的/ 路由/ 通告/ ut/ (/ 当/ 路由/ 通告/ 中/ 的/ 路径/ 被/ vk/ 选为/ 最优/ 路径/ 时/ ,/ 我们/ 称该/ 路由/ 通告/ 包含/ vk/ 最优/ 路径/ 子/ 路径/ )/ ,/ 包含/ vk/ 上次/ 最优/ 路径/ 子/ 路径/ 的/ 路由/ 通告/ u0/ 以及/ 通告/ 时间/ 介于/ 两者之间/ 的/ 路由/ 通告/ u1/ ,/ u2/ ,/ …/ ,/ ut/ -/ 1/ ,/ 可得/ Uvr/ 随着/ 路由/ 路径/ 的/ 更新/ ,/ RouteLog/ 的/ 存储/ 信息/ 周期性/ 更新/ ./ 每当/ vk/ 收到/ 来自/ vr/ 的/ 目的地/ 为/ d/ 的/ 路由/ 通告/ 时/ ,/ 均/ 缓存/ 在/ RouteLog/ 中/ ./ 假设/ vk/ 收到/ un/ 后/ 更新/ 最优/ 路径/ ,/ 则/ 删除/ ut/ 之前/ 的/ 记录/ ,/ 添加/ un/ 至/ ,/ d/ ,/ 将/ ut/ 和/ un/ 之间/ 缓存/ 的/ 路由/ 通告/ 也/ 添加/ 至/ UvrUvr/ 周期性/ 更新/ 保证/ 了/ RouteLog/ 的/ 存储空间/ 在/ 可/ 接受/ 范围/ 内/ ,/ 以便/ 于/ 在/ 自治/ 系统/ 中/ 部署/ RouteLog/ ./ 图/ 4/ 是/ 节点/ a/ 的/ RouteLog/ 中/ Ub/ ,/ e/ 的/ 生成/ 过程/ 示意图/ ./ 当前/ a/ 到/ e/ 的/ 最优/ 路径/ 是/ abcde/ ,/ a/ 保存/ b/ 节点/ 的/ 路由/ 通告/ bcde/ ./ 上次/ a/ 到/ e/ 的/ 最优/ 路径/ 是/ abge/ ,/ a/ 保存/ b/ 节点/ 当时/ 的/ 路由/ 通告/ bge/ ./ 两次/ 通告/ 间隔/ 内/ a/ 收到/ 的/ 通告/ bfe/ 和/ bche/ 也/ 被/ 记录/ ,/ 最终/ 得到/ Ub/ ,/ e/ (/ 见表/ 1/ )/ ./ 需要/ 注意/ 的/ 是/ ,/ 如果/ u0/ 不/ 存在/ ,/ 只/ 存在/ ut/ ,/ 即/ (/ vk/ )/ ut/ 表示/ vk/ 首次/ 将/ vr/ 的/ 路由/ 通告/ 选/ 为/ 最优/ 路径/ ./ 这种/ 情况/ 下/ vk/ 需要/ 存储/ vr/ 发送/ 的/ 目的/ 节点/ 为/ d/ 的/ 所有/ 路由/ 通告/ ,/ 然而/ 由于/ 现实/ 网络/ 中/ 相邻/ 自治/ 系统/ 的/ 连接/ 关系/ 是/ 基于/ 网络/ 可达性/ 创建/ 的/ ,/ 因此/ 这种/ 情况/ 很难/ 存在/ ①/ ./ 网络/ 自治/ 系统/ 追求/ 网络/ 利益/ 的/ 最大化/ ,/ 研究成果/ [/ 16/ ]/ 表明/ :/ 产生/ 域间/ 路由/ 不/ 一致/ 路径/ 的/ 主要/ 原因/ 是/ 恶意/ 节点/ 为了/ 增加/ 网络/ 利益/ 而/ 吸引/ 正常/ 节点/ 的/ 网络流量/ ./ 同时/ 自治/ 系统/ 总是/ 尽可能/ 通过/ 通告/ 最优/ 路径/ 获得/ 最多/ 的/ 网络/ 利益/ ,/ 只有/ 通告/ 非/ 最优/ 路径/ 能够/ 获得/ 更/ 多/ 的/ 网络/ 利益/ 时才/ 会/ 通告/ 非/ 最优/ 路径/ ,/ 据此/ 我们/ 提出/ 定理/ 1/ ./ 定理/ 1/ ./ 设/ Uvr/ 表示/ 节点/ vk/ 的/ RouteLog/ 中/ 二元/ 组/ {/ vr/ ,/ d/ }/ 标记/ 的/ 历史/ 路由/ 通告/ 集合/ ./ 如果/ 当前/ 最优/ 路径/ (/ vk/ )/ ut/ 是/ 不/ 一致/ 路径/ 且/ vr/ 是/ 导致/ 路径/ 不/ 一致/ 的/ 恶意/ 节点/ ,/ 则/ vk/ 的/ 实际/ 报文/ 转发/ 路径/ 是/ (/ vk/ )/ u/ ,/ 其中/ u/ ∈/ Uvr/ 证明/ ./ (/ vk/ )/ ut/ 是/ vk/ 当前/ 最优/ 路径/ ,/ 根据/ 定义/ 3/ 可得/ Wvk/ 过程/ 可知/ ,/ vr/ 向/ vk/ 通告/ ut/ ,/ 则/ ut/ 是/ vr/ 当前/ 选择/ 的/ 最优/ 路径/ ./ 然而/ vr/ 的/ 实际/ 报文/ 转发/ 路径/ u/ 才/ 是/ vr/ 真实/ 的/ 最优/ 路径/ ,/ 可得/ Wvr/ 节点/ vr/ 没有/ 通告/ 最优/ 路径/ u/ ,/ 而/ 通告/ 了/ 非/ 最优/ 路径/ ut/ 至/ vk/ ,/ 表明/ vr/ 可能/ 获悉/ 在/ vk/ 的/ 路由/ 策略/ 中/ ut/ 的/ 权值/ 高于/ u/ 的/ 权值/ ./ 然而/ 由于/ 自治/ 系统/ 路由/ 策略/ 的/ 自主性/ ,/ 这种/ 情况/ 并/ 不/ 存在/ ,/ 因此/ vr/ 只能/ 采用/ 发送/ 多次/ 路由/ 通告/ 的/ 方式/ 试探/ vk/ ./ 依据/ BGP/ 选路/ 过程/ ,/ vr/ 首先/ 向/ vk/ 通告/ 真实/ 路径/ u/ ,/ vk/ 并/ 没有/ 选择/ (/ vk/ )/ u/ 作为/ 最优/ 路径/ ,/ vr/ 继续/ 向/ vk/ 通告/ 非/ 最优/ 路径/ ,/ 直到/ 通告/ ut/ 时才/ 获得/ vk/ 的/ 报文/ 流量/ ,/ 因此/ 可/ 得/ 真实/ 路径/ u/ 的/ 通告/ 时间/ 早于/ ut/ 且/ u/ ≠/ ut/ ./ (/ vk/ )/ u0/ 是/ 上次/ vk/ 到达/ d/ 的/ 最优/ 路径/ ,/ 而/ 当前/ 最优/ 路径/ 是/ (/ vk/ )/ ut/ ./ 一般来说/ ,/ 自治/ 系统/ 的/ 最优/ 路径/ 改变/ 有/ 3/ 种/ 原因/ ,/ 分别/ 是/ 自治/ 系统/ 的/ 路由/ 策略/ 变化/ 导致/ 最优/ 路径/ 权值/ 改变/ ;/ 自治/ 系统/ 接收/ 到/ 最优/ 路径/ 撤销/ 通告/ ;/ 自治/ 系统/ 接收/ 到/ 更/ 符合/ 其/ 路由/ 策略/ 的/ 路径/ 通告/ ./ 接下来/ 依次/ 分析/ 这/ 3/ 种/ 原因/ :/ (/ 1/ )/ 假设/ vk/ 的/ 最优/ 路径/ 变化/ 是因为/ 其/ 路由/ 策略/ 发生变化/ ./ 由于/ vr/ 不能/ 获悉/ vk/ 的/ 最新/ 路由/ 策略/ ,/ 依据/ 前文/ 的/ 分析/ ,/ vr/ 只能/ 在/ vk/ 更新/ 路由/ 策略/ 之后/ 通告/ 最优/ 路径/ u/ 进行/ 试探/ ,/ 可知/ 最优/ 路径/ u/ 的/ 通告/ 时间/ 晚于/ u0/ ,/ 但/ 也/ 可能/ 存在/ u/ =/ u0/ ./ (/ 2/ )/ 假设/ vk/ 的/ 最优/ 路径/ 变化/ 是因为/ vr/ 主动/ 撤销/ 路由/ 通告/ u0/ ./ 由于/ vr/ 是/ 恶意/ 节点/ ,/ 因此/ (/ vk/ )/ u0/ 的/ 一致性/ 无法/ 保证/ ./ 首先/ 考虑/ u0/ 不是/ vr/ 当时/ 最优/ 路径/ 的/ 情况/ ,/ 前/ 文/ 提到/ vr/ 向/ vk/ 发送/ u0/ 的/ 动机/ 是/ 吸引/ vk/ 的/ 流量/ ,/ 此时/ vr/ 已经/ 获得/ vk/ 的/ 流量/ ,/ 没有/ 撤销/ 路由/ 通告/ u0/ 的/ 动机/ ,/ 因此/ 这种/ 情况/ 不/ 成立/ ;/ 其次/ 考虑/ u0/ 是/ vr/ ①/ TheCooperativeAssociationforInternetDataAnalysisPage10/ 当时/ 最优/ 路径/ 的/ 情况/ ,/ vr/ 当前/ 的/ 最优/ 路径/ 是/ u/ ,/ 表明/ u/ 成为/ 其/ 最优/ 路径/ 的/ 时间/ 晚于/ u0/ ,/ 因此/ 通告/ u/ 的/ 时间/ 同样/ 晚于/ u0/ ,/ 但是/ 同样/ 存在/ u/ =/ u0/ 的/ 可能/ ./ (/ 3/ )/ 假设/ vk/ 的/ 最优/ 路径/ 的/ 变化/ 是因为/ 收到/ 更/ 符合/ 其/ 路由/ 策略/ 的/ 路径/ 通告/ ,/ 而/ 该/ 路径/ 通告/ 可能/ 来自/ 非/ vr/ 节点/ ./ 当该/ 路径/ 通告/ 来自/ 非/ vr/ 节点/ 时/ ,/ vk/ 取消/ 最优/ 路径/ (/ vk/ )/ u0/ ,/ vr/ 无法/ 分辨/ vk/ 的/ 路由/ 策略/ 是否/ 改变/ ,/ 情况/ 与/ (/ 1/ )/ 类似/ ,/ vr/ 只能/ 在/ vk/ 改变/ 最优/ 路径/ 后/ 通告/ 最优/ 路径/ u/ 进行/ 试探/ ,/ 可知/ 最优/ 路径/ u/ 的/ 通告/ 时间/ 晚于/ u0/ ,/ 但是/ 可能/ 存在/ u/ =/ u0/ ./ 当该/ 路径/ 通告/ 来自/ vr/ 时/ ,/ 表明/ vr/ 最优/ 路径/ 从/ u0/ 变为/ u/ ,/ 且/ u/ 不同于/ u0/ ./ 由于/ u/ 无法/ 被/ vk/ 选为/ 最优/ 路径/ ,/ vr/ 只能/ 通过/ 通告/ ut/ 获得/ vk/ 的/ 流量/ ./ 同样/ 可知/ u/ 的/ 通告/ 时间/ 晚于/ u0/ ./ 经过/ 以上/ 分析/ ,/ 我们/ 发现/ 包含/ 真实/ 报文/ 传输/ 路径/ 子/ 路径/ 的/ 路由/ 通告/ u/ 的/ 通告/ 时间/ 介于/ u0/ 和/ ut/ 之间/ ,/ u/ 与/ ut/ 不同/ 但是/ 可能/ 与/ u0/ 相同/ ./ 根据/ Uvr/ 义/ ,/ 可得/ u/ ∈/ Uvr/ 由/ 4.2/ ./ 1/ 节/ 可知/ 可疑/ 节点/ 集合/ 为/ V/ =/ {/ vj/ -/ h/ ,/ vj/ -/ h/ +/ 1/ }/ ,/ j/ -/ h/ / 1/ ./ 为了/ 在/ 两个/ 可疑/ 节点/ 中/ 发现/ 恶意/ 节点/ ,/ 源/ 节点/ 与/ 离/ 自身/ 较近/ 的/ 可疑/ 节点/ 的/ 直接/ 上游/ 节点/ vj/ -/ h/ -/ 1/ 协作/ ./ v0/ 向/ vj/ -/ h/ -/ 1/ 申请/ 查询/ RouteLog/ ,/ 得到/ vj/ -/ h/ 向/ vj/ -/ h/ -/ 1/ 发送/ 的/ 目的/ 节点/ 为/ vi/ 的/ 路由/ 通告/ 历史记录/ Uv/ 含/ 当前/ 最优/ 路径/ 子/ 路径/ 的/ 路由/ 通告/ ,/ 找出/ 剩下/ 的/ 历史/ 路由/ 通告/ 中/ vj/ -/ h/ 的/ 下/ 一/ 跳/ 节点/ (/ Nexthop/ )/ ,/ 并/ 向/ 所有/ 的/ 下/ 一/ 跳/ 节点/ 依次/ 请求/ DRE/ (/ 源/ 节点/ 可能/ 就是/ vj/ -/ h/ -/ 1/ 节点/ ,/ 此时/ vj/ -/ h/ =/ v1/ )/ ./ 根据/ 定理/ 1/ ,/ 如果/ vj/ -/ h/ 的/ 某个/ 下/ 一/ 跳/ 节点/ 反馈/ 的/ DRE/ 与/ v0/ 的/ SSE/ 匹配/ ,/ 则/ 证明/ vj/ -/ h/ 是/ 恶意/ 节点/ ,/ 反之/ vj/ -/ h/ +/ 1/ 为/ 恶意/ 节点/ (/ 具体/ 见/ 算法/ 2/ )/ ./ 算法/ 2/ ./ 恶意/ 节点/ 检测/ 算法/ ./ 输入/ :/ P/ =/ (/ v0/ ,/ v1/ ,/ …/ ,/ vi/ )/ ,/ i/ / 0/ ./ V/ =/ {/ vj/ -/ h/ ,/ vj/ -/ h/ +/ 1/ }/ ,/ 输出/ :/ 恶意/ 节点/ vr1/ ./ FOREACHu/ ∈/ Uv2/ ./ IFSSE/ =/ DRETHEN3/ ./ vr/ =/ vj/ -/ h/ ;/ 4/ ./ RETURNvr/ ;/ 5/ ./ ELSE6/ ./ CONTINUE/ ;/ 7/ ./ ENDIF8/ ./ ENDFOR9/ ./ vr/ =/ vj/ -/ h/ +/ 1/ ;/ 10/ ./ RETURNvr/ ;/ 以图/ 4/ 为例/ ,/ 假设/ b/ 和/ c/ 是/ 可疑/ 节点/ ,/ 为了/ 在/ b/ 和/ c/ 之间/ 找出/ 唯一/ 恶意/ 节点/ ,/ a/ 首先/ 得到/ b/ 的/ 路由/ 通告/ 历史记录/ bge/ ,/ bche/ ,/ bcde/ ,/ bfe/ ./ 由于/ bcde/ 是/ 当前/ 最优/ 路径/ ,/ 因此/ a/ 仅/ 选择/ bge/ ,/ bche/ ,/ bfe/ 中/ 的/ 下/ 一/ 跳/ 节点/ g/ 、/ f/ 和/ c/ 进行/ 证据/ 比较/ ./ 如果/ g/ 、/ f/ 和/ c/ 中有/ 一个/ 节点/ 产生/ 与/ a/ 的/ SSE/ 匹配/ 的/ DRE/ ,/ 则/ 证明/ b/ 是/ 恶意/ 节点/ ,/ 否则/ c/ 是/ 恶意/ 节点/ ./ 4.2/ ./ 3/ 算法/ 分析/ 分析/ 算法/ 执行/ 过程/ 可以/ 发现/ ,/ 源/ 节点/ 与/ 路径/ 中/ 的/ 节点/ 最/ 多/ 进行/ 一次/ 证据/ 交互/ ,/ 与/ 历史/ 路由/ 通告/ 中/ vj/ -/ h/ 的/ 每个/ 下/ 一/ 跳/ 节点/ 也/ 仅/ 交互/ 一次/ 证据/ 信息/ ,/ 因此/ 检测/ 算法/ 的/ 计算/ 复杂度/ 取决于/ 路径/ 节点/ 数/ 和/ 历史/ 路由/ 通告/ 中/ vj/ -/ h/ 的/ 下/ 一/ 跳/ 节点/ 数/ ./ 设/ 路径/ 总共/ 包含/ n/ 个/ 节点/ ,/ 最坏/ 的/ 情况/ 下/ ,/ 源/ 节点/ 的/ 直接/ 下游/ 节点/ 是/ 可疑/ 节点/ 且/ 最终/ 被/ 检测/ 为/ 恶意/ 节点/ ./ 源/ 节点/ 执行/ 可疑/ 节点/ 检测/ 算法/ ,/ 与/ 目的/ 节点/ 比较/ SSE/ 和/ DRE/ ,/ 生成/ V/ ./ V/ 包含/ 位于/ 源/ 节点/ 和/ 目的/ 节点/ 之间/ 的/ n/ -/ 2/ 个/ 节点/ ./ 源/ 节点/ 与/ V/ 内/ 的/ 每个/ 节点/ 分别/ 比较/ SSE/ 和/ DRE/ 、/ SSE/ 和/ DSE/ ,/ 获得/ V/ ./ 源/ 节点/ 总共/ 需要/ 进行/ 2n/ -/ 3/ 次/ 证据/ 比较/ ./ 源/ 节点/ 执行/ 恶意/ 节点/ 检测/ 算法/ ,/ 设/ Uvvj/ -/ h/ 的/ 下/ 一/ 跳/ 节点/ 数是/ m/ ,/ 最坏/ 的/ 情况/ 下/ ,/ 源/ 节点/ 必须/ 与/ 每个/ 下/ 一/ 跳/ 节点/ 比较/ SSE/ 和/ DRE/ ,/ 总共/ 进行/ m/ 次/ 证据/ 比较/ ./ 综合/ 两个/ 算法/ ,/ 可得源/ 节点/ 总共/ 进行/ 2n/ +/ m/ -/ 3/ 次/ 证据/ 比较/ 以/ 发现/ 恶意/ 节点/ ,/ 算法/ 复杂度/ 为/ O/ (/ 2n/ +/ m/ )/ ./ 通过/ 分析/ MADM/ 检测/ 算法/ 的/ 执行/ 过程/ ,/ 可知/ 源/ 节点/ 并/ 不/ 直接/ 与/ 恶意/ 节点/ 交互/ 信息/ ,/ 而是/ 与/ 恶意/ 节点/ 的/ 邻居/ 节点/ 比较/ 路由/ 证据/ ./ 这种/ 方式/ 对/ 恶意/ 节点/ 透明/ ,/ 避免/ 恶意/ 节点/ 干扰/ 检测/ 结果/ ./ 同时/ 节点/ 之间/ 的/ 交互/ 信息/ 和/ 路由/ 证据/ 均/ 用/ 密钥/ 加密/ ,/ 防止/ 中间人/ 攻击/ 影响/ 检测/ 结果/ ,/ 保证/ 检测/ 机制/ 的/ 安全性/ ./ 4.3/ MADM/ 的/ 实现/ 与/ 部署/ 随着/ 软件/ 定义/ 网络/ (/ Software/ -/ DefinedNetworking/ ,/ SDN/ )/ [/ 17/ ]/ 的/ 蓬勃发展/ ,/ 基于/ 控制器/ (/ Controller/ )/ 的/ 集中式/ 路由/ 控制/ 方案/ 也/ 愈发/ 成熟/ ./ 为了/ 实现/ MADM/ ,/ 可/ 在/ 自治/ 域/ 内/ 的/ 控制器/ 中/ 部署/ 路由/ 检测/ 模块/ (/ RoutingDetectionModel/ ,/ RDM/ )/ ,/ 集中管理/ 自治/ 域/ 的/ 密钥/ 和/ 路由/ 证据/ ,/ 并/ 维护/ 路由/ 通告/ 历史记录/ ,/ 执行/ 检测/ 机制/ ./ 图/ 5/ 是/ RDM/ 的/ 结构图/ ,/ 总共/ 包含/ 5/ 个/ 功能/ 子/ 模块/ ,/ 分别/ 是/ 密钥/ 生成/ 子/ 模块/ 、/ 密钥/ 管理/ 子/ 模块/ 、/ 路由/ 证据/ 生成/ 子/ 模块/ 、/ 路由/ 证据/ 验证/ 子/ 模块/ 和/ 路由/ 通告/ 历史记录/ 子/ 模块/ ./ 密钥/ 生成/ 子/ 模块/ 采用/ RSA/ 算法/ Page11/ 计算/ 本/ 自治/ 域/ 的/ 密钥/ 对/ ./ 我们/ 在/ 全网/ 范围/ 内/ 采用/ Chord/ 环/ [/ 18/ ]/ 连接/ 多个/ 自治/ 系统/ 的/ RDM/ ,/ 自治/ 系统/ 的/ RDM/ 通过/ Chord/ 环/ 发布/ 自身/ 的/ 公钥/ ,/ 并/ 根据/ 其他/ 自治/ 系统/ 的/ ASnumber/ 获取/ 它们/ 的/ 公钥/ ./ 密钥/ 管理/ 子/ 模块/ 存储/ 其他/ 自治/ 域/ 的/ 公钥/ 信息/ ,/ 以便/ 于/ 对/ 路由/ 证据/ 进行/ 加解密/ 操作/ ./ 路由/ 证据/ 生成/ 子/ 模块/ 的/ 主要/ 功能/ 是/ 通过/ 分析/ 证据/ 生成/ 报文/ ,/ 生成/ 相应/ 的/ 路由/ 证据/ ./ 路由/ 证据/ 验证/ 子/ 模块/ 将/ 其他/ 自治/ 系统/ 反馈/ 的/ 图/ 5RDM/ 结构图/ 分析/ MADM/ 的/ 检测/ 原理/ ,/ 我们/ 可以/ 发现/ 对于/ 一条/ 路由/ 路径/ 的/ 源/ 节点/ ,/ 它/ 并不需要/ 全网/ 自治/ 系统/ 的/ 配合/ ,/ 而仅/ 需要/ 当前/ 路径/ 中/ 的/ 其他/ 自治/ 系统/ 和/ 恶意/ 节点/ 的/ 邻居/ 节点/ 协作/ 检测/ 恶意/ 自治/ 系统/ ./ 因此/ 在/ 最初/ 阶段/ ,/ 我们/ 可以/ 选择/ 在/ 小/ 范围/ 网络/ 内/ ,/ 从/ 网络安全/ 和/ 网络/ 利益/ 两个/ 角度/ 推动/ MADM/ 在/ 自治/ 系统/ 中/ 的/ 部署/ ,/ 进而/ 实现/ 全网/ 范围/ 内/ 的/ 部署/ ./ 5/ 实验/ 与/ 分析/ 为了/ 更加/ 直观/ 地/ 阐述/ MADM/ 的/ 价值/ ,/ 本/ 节/ 通过/ 实验/ 验证/ MADM/ 对/ 恶意/ 自治/ 系统/ 的/ 检测/ 效果/ ./ 为了/ 使得/ 实验/ 结果/ 更/ 具有/ 说服力/ ,/ 我们/ 实现/ 了/ 相关/ 工作/ 中/ 介绍/ 的/ Securetraceroute/ 和/ Lightweight/ 两种/ 路径/ 检测/ 机制/ ./ Securetraceroute/ 在/ 自治/ 系统/ 之间/ 设立/ 了/ 一个/ 共享/ 的/ 密钥/ 谓词/ ,/ 自治/ 系统/ 选择/ 一些/ 报文/ 作为/ 探测/ 报文/ ,/ 通过/ 检测/ 报文/ 是否/ 能够/ 正常/ 到达/ 目的/ 节点/ 来/ 发现/ 不/ 一致/ 路径/ 和/ 恶意/ 节点/ ./ Light/ -/ weight/ 在/ 一些/ 数据/ 报文/ 中/ 附加/ 共享/ 密钥/ 元组/ 的/ 前半部/ 分/ ,/ 被/ 验证/ 方/ 拥有/ 共享/ 密钥/ 元组/ 的/ 后/ 半/ 部分/ ./ 被/ 验证/ 方/ 收到/ 验证/ 方/ 的/ 数据/ 报文/ 后/ 发送/ 应答/ 报文/ ./ 依据/ 应答/ 报文/ ,/ 验证/ 方/ 检测/ 被/ 验证/ 方/ 的/ 上游/ 自治/ 系统/ ./ 我们/ 将/ Securetraceroute/ 和/ Lightweight/ 对/ 恶意/ 自/ 路由/ 证据/ 与/ 自身/ 的/ 路由/ 证据/ 进行/ 比较/ ,/ 依据/ 比较/ 结果/ 检测/ 路径/ 和/ 自治/ 系统/ ./ 路由/ 通告/ 历史记录/ 子/ 模块/ 存储/ 相邻/ 节点/ 的/ 路由/ 通告/ 历史/ 信息/ ./ 研究/ 人员/ 通过/ 统计/ AT&T/ 的/ 骨干/ 网络/ 的/ 路由/ 更新/ 日志/ ,/ 得到/ 现有/ 自治/ 系统/ 到/ 某/ 一/ 子网/ 的/ 路由/ 平均/ 一天/ 会/ 有/ 5/ 次/ 更新/ ,/ 而/ 到/ 一些/ 包含/ 著名/ 地址/ (/ 如/ 知名/ 网站/ 等/ )/ 的/ 路由/ 平均/ 一天/ 只有/ 0.2/ 次/ 更新/ [/ 19/ ]/ ,/ 因此/ 每个/ 自治/ 域/ RDM/ 的/ RouteLog/ 更新/ 频率/ 较/ 低/ ,/ 在/ 实际/ 网络/ 中易/ 实现/ ./ 治/ 系统/ 的/ 检测/ 结果/ 与/ MADM/ 的/ 检测/ 结果/ 进行/ 比较/ ,/ 依据/ 比较/ 结果/ 分析/ MADM/ 的/ 性能/ ./ 5.1/ 实验/ 环境/ 我们/ 采用/ SSFnet/ ①/ 对/ MADM/ 、/ Securetrace/ -/ route/ 和/ Lightweight/ 进行/ 仿真/ 实验/ ./ 为了/ 模拟/ 现实/ 网络/ 中/ 的/ 拓扑/ ,/ 从/ CAIDA/ ②/ 项目组/ 下载/ 了/ 2014/ 年/ 6/ 月/ 11/ 日/ 的/ 网络拓扑/ 和/ AS/ 连接/ 关系数据/ 集/ cycle/ -/ aslinks/ ./ l7/ ./ t1/ ./ c003225/ ./ 20140607/ ,/ 在/ 数据/ 集中/ 选择/ 300/ 个/ 节点/ ,/ 其中/ 30/ 个/ 节点/ 为/ Tier/ -/ 1/ 节点/ ,/ 50/ 个/ 节点/ 为/ Tier/ -/ 2/ 节点/ ,/ 220/ 个/ 节点/ 为/ Tier/ -/ 3/ 节点/ ./ 基于/ 节点/ 之间/ 的/ 连接/ 信息/ ,/ 采用/ BRITE/ [/ 20/ ]/ 拓扑/ 生成器/ 生成/ 节点/ 的/ 仿真/ 拓扑/ ./ 我们/ 从/ RouteView/ ③/ 项目组/ 下载/ 到/ 2014/ 年/ 6/ 月/ 11/ 日/ 的/ 域间/ 路由/ 更新/ 通告/ 数据/ 集/ updates/ ./ 20140611/ 以及/ 自治/ 系统/ 路由/ 信息/ 表/ 数据/ 集/ rib/ ./ 20140611/ ,/ 在/ 数据/ 集中/ 找出/ 仿真/ 拓扑/ 中/ 节点/ 的/ 路由表/ 和/ 路由/ 通告/ 信息/ ,/ 在/ 拓扑/ 中/ 构建/ 路由/ 路径/ ./ 在/ 拓扑/ 中/ 选择/ 3/ 个/ 节点/ A/ ,/ B/ ,/ C/ 作为/ 源/ 节点/ ,/ A/ 节点/ 为/ Tier/ -/ 1/ 节点/ ,/ 连接/ 度为/ 150/ ,/ 以/ A/ 节点/ 为源节/ ①/ ②/ ③/ Page12/ 点/ 的/ 路由/ 路径/ 有/ 112/ 条/ ./ B/ 节点/ 为/ Tier/ -/ 2/ 节点/ ,/ 连接/ 度为/ 90/ ,/ 以/ B/ 节点/ 为源/ 节点/ 的/ 路由/ 路径/ 有/ 45/ 条/ ./ C/ 节点/ 为/ Tier/ -/ 3/ 节点/ ,/ 连接/ 度为/ 30/ ,/ 以/ C/ 节点/ 为源/ 节点/ 的/ 路由/ 路径/ 有/ 12/ 条/ (/ 见表/ 2/ )/ ./ 源/ 节点/ ABC/ 我们/ 将/ 网络/ 报文/ 传输速率/ 设置/ 为/ 100Mbps/ ,/ 证据/ 生成/ 报文/ 长度/ 设置/ 为/ 16bytes/ ,/ 证据/ 生成/ 报文/ 发送/ 时间/ 区间/ 设置/ 为/ 50ms/ ./ 网络/ 丢/ 包率/ 设置/ 为/ 0.5/ %/ ,/ 误差/ 容忍度/ 设置/ 为/ 1/ %/ ./ 在/ MADM/ 检测/ 过程/ 中/ ,/ 采用/ RSA/ 算法/ 为/ 每个/ 参与/ 检测/ 过程/ 的/ 节点/ 生成/ 密钥/ 对/ ./ 5.2/ 实验/ 评估/ 指标/ 本文/ 采用/ 相关/ 研究/ 中/ 广泛/ 使用/ 的/ 查全率/ 和/ 查准率/ 作为/ 实验/ 评估/ 指标/ ./ 在/ 网络/ 丢/ 包率/ 相同/ 的/ 条件/ 下/ ,/ 分别/ 测试/ MADM/ 、/ Securetraceroute/ 和/ Lightweight/ 在/ 不/ 一致/ 路径/ 比例/ 不/ 同时/ 检测/ 恶意/ 节点/ 的/ 查全率/ ./ 设/ 拓扑/ 包含/ E/ 个/ 恶意/ 节点/ ,/ 被/ 正确/ 检测/ 出/ 的/ 恶意/ 节点/ 数目/ 为/ F/ ,/ 则/ 查全率/ (/ RecallRatio/ )/ 为/ 在/ 不/ 一致/ 路径/ 比例/ 相同/ 的/ 条件/ 下/ ,/ 分别/ 测试/ MADM/ 、/ Securetraceroute/ 和/ Lightweight/ 在/ 网络/ 丢/ 包率/ 不/ 同时/ 检测/ 恶意/ 节点/ 的/ 查准率/ ./ 设/ 拓扑/ 中/ 总共/ 被/ 检测/ 为/ 恶意/ 节点/ 的/ 节点/ 数目/ 为/ H/ ,/ 则/ 查准率/ (/ PrecisionRatio/ )/ 为/ 5.3/ 实验/ 方案/ 与/ 实验/ 结果/ 实验/ 1/ ./ 验证/ 在/ 不/ 一致/ 路径/ 比例/ 不同/ 的/ 情况/ 下/ MADM/ 、/ Securetraceroute/ 和/ Lightweight/ 对/ 恶意/ 节点/ 的/ 检测/ 效果/ ./ 分别/ 在/ A/ 、/ B/ 和/ C/ 的/ 路由/ 路径/ 中/ 随机/ 选择/ 路径/ 作为/ 不/ 一致/ 路径/ ,/ 在/ 不/ 一致/ 路径/ 中/ 任意/ 选择/ 一个/ 节点/ 作为/ 恶意/ 节点/ ./ 为了/ 比较/ 不同/ 不/ 一致/ 路径/ 比例/ 下/ 的/ 实验/ 结果/ ,/ 设定/ 不/ 一致/ 路径/ 占/ 总/ 路径/ 的/ 比例/ 分别/ 为/ 5/ %/ 、/ 8/ %/ 、/ 10/ %/ 、/ 15/ %/ 和/ 18/ %/ ./ 实验/ 对比/ 分析/ 结果/ 如图/ 6/ ~/ 图/ 8/ 所示/ ,/ 图/ 6/ 是/ 节点/ A/ 的/ 路由/ 路径/ 的/ 检测/ 结果/ ./ 可以/ 发现/ ,/ 当/ 不/ 一致/ 路径/ 比例/ 为/ 5/ %/ 时/ ,/ MADM/ 对/ 其/ 路由/ 路径/ 中/ 恶意/ 节点/ 的/ 查全率/ 是/ 89/ %/ ,/ 仍然/ 有/ 大约/ 11/ %/ 的/ 恶意/ 节点/ 不能/ 被/ 检测/ ./ 分析/ 拓扑/ 发现/ 虽然/ 每条/ 不/ 一致/ 路径/ 只/ 包含/ 一个/ 恶意/ 节点/ ,/ 但是/ 一部分/ 路径/ 在/ 某些/ 节点/ 相交/ ,/ 导致/ 这部分/ 路径/ 包含/ 多个/ 恶意/ 节点/ ./ 由于/ MADM/ 的/ 检测/ 算法/ 只/ 处理/ 路由/ 路径/ 存在/ 一个/ 恶意/ 节点/ 的/ 情况/ ,/ 因此/ 不能/ 检测/ 这些/ 恶意/ 节点/ ./ Securetraceroute/ 对/ 恶意/ 节点/ 的/ 查全率/ 是/ 60/ %/ ,/ 分析/ 发现/ Securetraceroute/ 检测/ 的/ 恶意/ 节点/ 大部分/ 是/ 没有/ 分辨/ probe/ 报文/ 的/ 恶意/ 节点/ 以及/ 兄弟/ 节点/ (/ SiblingAS/ )/ ,/ 这些/ 节点/ 对/ Securetraceroute/ 发送/ 的/ probe/ 报文/ 给予/ 正面/ 回应/ ,/ 从而/ 被/ 检测/ 出/ 存在/ 问题/ ./ 而/ 剩余/ 恶意/ 节点/ 可以/ 分辨/ probe/ 报文/ ,/ 并/ 正常/ 转发/ probe/ 报文/ ,/ 因此/ 并/ 没有/ 被/ Securetraceroute/ 发现/ ./ Lightweight/ 对/ 恶意/ 节点/ 的/ 查全率/ 是/ 68/ %/ ,/ 它/ 与/ MADM/ 一样/ 均/ 可以/ 避免/ 恶意/ 节点/ 的/ 识别/ ,/ 但是/ 查全率/ 并/ 不/ 高/ ./ 分析/ 发现/ 只有/ 当/ 恶意/ 节点/ 是/ 目的/ 节点/ 的/ 直接/ 上游/ 节点/ 时/ ,/ Lightweight/ 才能/ 检测/ 出/ 恶意/ 节点/ ,/ 而/ 非/ 直接/ 上游/ 节点/ 的/ 恶意/ 节点/ 不能/ 被/ 检测/ 出/ ,/ 因此/ 影响/ 了/ 查全率/ ./ 随着/ 不/ 一致/ 路径/ 比例/ 的/ 增加/ ,/ 一条/ 不/ 一致/ 路径/ 出现/ 多个/ 恶意/ 节点/ 的/ 情况/ 增多/ ,/ MADM/ 、/ Securetraceroute/ 和/ Light/ -/ weight/ 的/ 查全率/ 缓慢/ 下降/ ./ 当/ 不/ 一致/ 路径/ 比例/ 达到/ 18/ %/ 时/ ,/ MADM/ 查全率/ 是/ 78.3/ %/ ,/ SecuretraceroutePage13/ 查全率/ 是/ 53.5/ %/ ,/ 而/ Lightweight/ 则/ 是/ 54.6/ %/ ./ 综合/ 曲线/ 可以/ 发现/ MADM/ 的/ 查全率/ 总体/ 优于/ Securetraceroute/ 和/ Lightweight/ 的/ 查全率/ ./ 图/ 7/ 显示/ 节点/ B/ 的/ 路由/ 路径/ 的/ 检测/ 结果/ ./ 相比/ 于/ 节点/ A/ ,/ 节点/ B/ 的/ 路由/ 路径/ 较/ 少/ ,/ 一条/ 路径/ 存在/ 多个/ 恶意/ 节点/ 的/ 情况/ 也/ 较/ 少/ ,/ 因此/ 当/ 不/ 一致/ 路径/ 比例/ 相同/ 时/ ,/ MADM/ 、/ Securetraceroute/ 和/ Lightweight/ 对/ 节点/ B/ 的/ 路径/ 中/ 恶意/ 节点/ 检测/ 结果/ 均/ 优于/ 对/ 节点/ A/ 的/ 路径/ 中/ 恶意/ 节点/ 的/ 检测/ 结果/ ./ 图/ 8/ 显示/ 节点/ C/ 的/ 路由/ 路径/ 的/ 检测/ 结果/ ,/ 当/ 不/ 一致/ 路径/ 比例/ 是/ 5/ %/ 时/ ,/ MADM/ 查全率/ 达到/ 95/ %/ 左右/ ,/ Securetraceroute/ 的/ 查全率/ 是/ 67/ %/ ,/ Lightweight/ 的/ 查全率/ 则/ 是/ 72/ %/ ./ 观察/ 曲线/ 走势/ 可以/ 发现/ MADM/ 的/ 查全率/ 优于/ Securetraceroute/ 和/ Lightweight/ 的/ 查全率/ ./ 现实/ 网络/ 中/ 不/ 一致/ 路径/ 比例/ 保持/ 在/ 8/ %/ 左右/ ,/ 这种/ 情况/ 下/ 的/ 实验/ 结果表明/ MADM/ 对/ 恶意/ 节点/ 取得/ 较/ 高/ 的/ 查全率/ ,/ 优于/ Securetraceroute/ 和/ Light/ -/ weight/ 的/ 检测/ 结果/ ./ 实验/ 2/ ./ 验证/ 在/ 网络/ 丢/ 包率/ 不同/ 的/ 情况/ 下/ MADM/ 、/ Securetraceroute/ 和/ Lightweight/ 对/ 恶意/ 节点/ 的/ 检测/ 效果/ ./ 选择/ A/ 作为/ 测试/ 节点/ ,/ 在/ A/ 的/ 路由/ 路径/ 中/ 随机/ 选择/ 路径/ 为/ 不/ 一致/ 路径/ ,/ 设置/ 不/ 一致/ 路径/ 占/ 总/ 路径/ 比例/ 为/ 8/ %/ ,/ 不/ 一致/ 路径/ 中/ 任意/ 选择/ 一个/ 节点/ 为/ 恶意/ 节点/ ./ 分别/ 设定/ 网络/ 丢/ 包率/ 为/ 0.5/ %/ ,/ 2.0/ %/ 和/ 5.0/ %/ ,/ 在/ 不同/ 的/ 网络/ 丢/ 包率/ 下/ 执行/ Securetraceroute/ 和/ Lightweight/ ,/ 获得/ 检测/ 结果/ ./ 在/ 网络/ 丢/ 包率/ 为/ 0.5/ %/ 时/ ,/ 设置/ 证据/ 生成/ 报文/ 发送/ 区间/ 为/ 50ms/ ,/ 证据/ 生成/ 报文/ 发送/ 长度/ 为/ 16bytes/ ,/ 误差/ 容忍度/ 为/ 1/ %/ ;/ 在/ 网络/ 丢/ 包率/ 为/ 2.0/ %/ 时/ ,/ 设置/ 证据/ 生成/ 报文/ 发送/ 区间/ 为/ 100ms/ ,/ 证据/ 生成/ 报文/ 发送/ 长度/ 为/ 32bytes/ ,/ 误差/ 容忍度/ 为/ 5/ %/ ;/ 在/ 网络/ 丢/ 包率/ 为/ 5.0/ %/ 时/ 的/ 证据/ 生成/ 报文/ 发送/ 区间/ 设置/ 为/ 150ms/ ,/ 证据/ 生成/ 报文/ 发送/ 长度/ 设置/ 为/ 64bytes/ ,/ 误差/ 容忍度/ 设置/ 为/ 10/ %/ (/ 见表/ 3/ )/ ./ 在/ 不同/ 丢/ 包率/ 下/ 执行/ MADM/ ,/ 获得/ 检测/ 结果/ ./ 网络/ 丢/ 包率/ // %/ 时间/ 区间/ // ms/ 报文/ 长度/ // bytes/ 误差/ 容忍度/ // %/ 0.52/ ./ 05.0/ 实验/ 结果/ 如图/ 9/ ~/ 图/ 11/ 所示/ ,/ 可以/ 发现/ 在/ 不同/ 的/ 网络/ 丢/ 包率/ 下/ ,/ Securetraceroute/ 和/ Lightweight/ 检测/ 恶意/ 节点/ 的/ 查准率/ 不同/ ./ 图/ 9/ 是/ 丢/ 包率/ 为/ 0.5/ %/ 的/ 情况/ ,/ Securetraceroute/ 的/ 查准率/ 尚/ 能/ 保持/ 在/ 90/ %/ 左右/ ./ 图/ 10/ 和/ 图/ 11/ 显示/ 丢/ 包率/ 上升时/ ,/ Securetraceroute/ 发送/ 的/ probe/ 报文/ 丢失/ 率/ 增加/ ,/ 节点/ 没有/ 接收/ 到/ probe/ 报文/ ,/ 不能/ 反馈/ 检测/ 结果/ ,/ 因此/ Securetraceroute/ 误判/ 率/ 上升/ ,/ 查准率/ 下降/ ./ Lightweight/ 也/ 有/ 类似/ 的/ 情况/ ,/ 当/ 丢/ 包率/ 为/ 0.5/ %/ 时/ 查准率/ 在/ 89/ %/ 左右/ ,/ 而/ 丢/ 包率/ 为/ 5.0/ %/ 时/ ,/ 查准率/ 已经/ 下降/ 到/ 49/ %/ ./ 在/ 丢/ 包率/ 为/ 0.5/ %/ 时/ ,/ MADM/ 的/ 查准率/ 保持/ 在/ 91/ %/ 左右/ ./ 当/ 丢/ 包率/ 上升/ 的/ 时候/ ,/ 由于/ 采取/ 增加/ 证据/ 生成/ 报文/ 发送/ 时间/ 、/ 增加/ 证据/ 生成/ 报文/ 长度/ 、/ 同时/ 调整/ 误差/ 容忍度/ 的/ 措施/ ,/ 图/ 10/ 和/ 图/ 11/ 显示/ MADM/ 的/ 查准率/ 仍然/ 保持/ 在/ 86/ %/ 左右/ ,/ 表明/ MADM/ 在/ 网络/ 丢/ 包率/ 较大/ 时/ 仍然/ 具有/ 较/ 好/ 的/ 查准率/ ./ 综合/ 以上/ 实验/ 结果/ 可知/ ,/ 与/ Securetraceroute/ 和/ Lightweight/ 检测/ 机制/ 相比/ ,/ MADM/ 能够/ 对/ 不/ 一致/ 路径/ 中/ 的/ 恶意/ 节点/ 进行/ 有效/ 检测/ ,/ 在/ 查全率/ 和/ 查准率/ 两个/ 指标/ 上/ 都/ 有/ 优于/ 另外/ 两个/ 机制/ 的/ 表现/ ,/ 即使/ 在/ 网络/ 丢/ 包率/ 较/ 高/ 的/ 情况/ 下/ 仍然/ 可以/ 有效/ 检测/ 恶意/ 节点/ ./ Page146/ 结束语/ 本文/ 对域/ 间/ 路由/ 路径/ 不/ 一致/ 问题/ 进行/ 了/ 深入研究/ ,/ 提出/ 了/ 一种/ 不/ 一致/ 路径/ 恶意/ 自治/ 系统/ 检测/ 机制/ MADM/ ,/ 弥补/ 了/ 已有/ 工作/ 的/ 不足/ ./ MADM/ 利用/ 路由/ 证据/ 将/ 自治/ 系统/ 的/ 路由/ 行为/ 与其/ 自身/ 相/ 绑定/ ,/ 从而/ 可以/ 追究/ 自治/ 系统/ 的/ 路由/ 行为/ ./ MADM/ 设计/ 了/ 不/ 一致/ 路径/ 恶意/ 节点/ 的/ 检测/ 方法/ ,/ 源/ 自治/ 系统/ 与/ 其他/ 自治/ 系统/ 比较/ 路由/ 证据/ ,/ 依据/ 证据/ 比较/ 结果/ 发现/ 恶意/ 节点/ ./ 仿真/ 结果表明/ ,/ MADM/ 在/ 查全率/ 和/ 查准率/ 两个/ 指标/ 上/ 的/ 表现/ 都/ 优于/ Securetraceroute/ 和/ Lightweight/ ,/ 并/ 适用/ 于/ 网络/ 丢/ 包率/ 较/ 高/ 的/ 环境/ ./ 下/ 一步/ 工作/ 中/ ,/ 我们/ 会/ 研究/ 当/ 不/ 一致/ 路径/ 包含/ 多个/ 恶意/ 节点/ 时/ ,/ 如何/ 对/ 多个/ 恶意/ 节点/ 进行/ 检测/ ./ 同时/ 本文/ 仅/ 介绍/ 了/ 不/ 一致/ 路径/ 中/ 恶意/ 节点/ 的/ 检测/ 方法/ ,/ 在/ 未来/ 工作/ 中将/ 研究/ 如何/ 对/ 恶意/ 节点/ 实施/ 路由/ 控制/ ,/ 从根本上/ 解决/ 域间/ 路由/ 路径/ 不/ 一致/ 问题/ ./ 

