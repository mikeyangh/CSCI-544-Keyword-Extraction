Page1SPQ/ :/ 数据流/ 上/ 面向/ 可/ 伸缩/ 模式/ 的/ 查询方法/ 李菲菲/ 李红燕曲/ 强苗/ 高杉/ (/ 北京大学/ 信息/ 科学技术/ 学院/ 北京/ 100871/ )/ (/ 北京大学/ 机器/ 感知/ 与/ 智能/ 教育部/ 重点/ 实验室/ 北京/ 100871/ )/ 摘要/ 数据流/ 的/ 模式/ 查询/ 具有/ 很/ 高/ 的/ 领域/ 价值/ ,/ 它/ 不仅/ 需要/ 较/ 高/ 的/ 抗噪/ 能力/ 和/ 实时性/ ,/ 而且/ 查询/ 目标/ 模式/ 还/ 具有/ 可伸缩性/ ,/ 即/ 由/ 多个/ 子模式/ 复合/ 而成/ ,/ 且/ 某些/ 子模式/ 可/ 重复/ 、/ 缺失/ 或/ 倒置/ ./ 文中/ 提出/ 一种/ 可/ 伸缩/ 模式/ 的/ 查询/ (/ SPQ/ )/ 方法/ ,/ 允许/ 用户/ 定义/ 目标/ 模式/ 并/ 设置/ 可/ 伸缩/ 条件/ ./ 然后/ 在/ 查询处理/ 中/ 通过/ 模式匹配/ 生成/ 模式/ 流/ ,/ 进而/ 完成/ 满足/ 可/ 伸缩/ 条件/ 的/ 目标/ 模式/ 查询/ ./ 在/ 真实/ 数据/ 集上/ 进行/ 的/ 实验/ 从/ 查全率/ 、/ 查准率/ 和/ 处理/ 效率/ 上/ 证明/ 了/ SPQ/ 方法/ 是/ 可行/ 和/ 灵活/ 的/ ./ 关键词/ 数据流/ ;/ 查询/ ;/ 可/ 伸缩/ 模式/ ;/ 目标/ 模式/ ;/ 查询/ 重写/ ;/ 查询处理/ 1/ 引言/ 数据流/ 的/ 应用/ 愈发/ 广泛/ 和/ 深入/ ,/ 为了/ 在/ 数据流/ 上/ 获取/ 关注/ 的/ 信息/ ,/ 用户/ 可以/ 根据/ 需求/ 设置/ 相应/ 的/ Page2/ 在/ 实际/ 应用/ 中/ ,/ 用户/ 根据/ 需求/ 设置/ 不同/ 的/ 查询/ ,/ 并/ 允许/ 查询/ 内部/ 的/ 某些/ 部分/ 重复/ 或/ 缺失/ ./ 这/ 给/ 数据流/ 上/ 的/ 查询处理/ 方法/ 带来/ 了/ 很多/ 挑战/ ./ 为了/ 满足/ 日益/ 复杂/ 的/ 查询/ 需求/ ,/ 数据流/ 上/ 的/ 查询/ 应该/ 具备/ 以下/ 特点/ :/ (/ 1/ )/ 查询/ 粒度/ 较大/ ,/ 语义/ 丰富/ ./ 多数/ 的/ 传统/ 数据库/ 查询/ 技术/ 关注/ 元组/ (/ tuples/ )/ ./ 在/ 数据流/ 领域/ 一些/ 查询/ 也/ 基于/ 元组/ ./ 这种/ 由/ 数据流/ 上/ 连续/ 数据/ 点/ 组成/ 的/ 模式/ 具有/ 更/ 丰富/ 的/ 语义/ ,/ 其/ 变化/ 可以/ 体现/ 用户/ 关心/ 的/ 变化趋势/ ./ 如/ 金融/ 数据流/ 中/ 的/ Zigzag/ 模式/ ;/ 又/ 如图/ 1/ 所示/ 的/ 医疗/ 数据流/ 监控/ 中图/ 2/ 查询/ 目标/ 模式/ 的/ 可伸缩性/ 表达/ 丰富/ 语义/ 为了/ 更加/ 灵活/ 地/ 表达/ 目标/ 模式/ 的/ 可伸缩性/ ,/ 需要/ 寻求/ 一种/ 即席/ 查询/ (/ adhocquery/ )/ 的/ 方法/ ./ (/ 3/ )/ 抵抗/ 无规律/ 噪声/ 的/ 干扰/ ./ 现实/ 环境/ 中/ 往往/ 会/ 有/ 噪声/ 的/ 干扰/ ./ 如/ 医疗/ 监测/ 中/ 病人/ 的/ 动作/ 会/ 触动/ 传感器/ 产生/ 干扰/ 数据/ ./ 又/ 如图/ 3/ 所示/ 民用/ 用电量/ 曲线/ ,/ 突然/ 的/ 跳闸/ 也/ 是/ 无法/ 预知/ 建模/ 的/ ./ 在/ 一定/ 程度/ 的/ 噪声/ 下/ ,/ 要求/ 算法/ 可以/ 较/ 好/ 地/ 执行/ ,/ 并/ 返回/ 满足/ 需求/ 的/ 查询/ 结果/ ./ (/ 4/ )/ 查询处理/ 满足/ 实时性/ 要求/ ./ 以/ 心电监护/ 仪为例/ ,/ 其/ 工作频率/ 是/ 500Hz/ ,/ 每/ 小时/ 产生/ 1800000/ 条/ 数据/ ,/ 一天/ 的/ 记录/ 数将/ 达到/ 43GB/ // 台/ ./ 巨大/ 的/ 数据量/ 使得/ 只能/ 对/ 数据流/ 进行/ 单遍/ 扫描/ ,/ 需要/ 实时/ 地/ 进行/ 查询处理/ ./ 的/ 心电图/ (/ Electrocardiograph/ ,/ ECG/ )/ :/ 一个/ 完整/ 的/ ECG/ 周期/ 由/ P/ 模式/ 、/ QRS/ 模式/ 、/ T/ 模式/ 、/ U/ 模式/ 组成/ ,/ 反映/ 了/ 心脏/ 跳动/ 周期/ 中/ 的/ 不同/ 阶段/ ./ 如/ P/ 模式/ 因/ 心脏/ 除极/ 而/ 产生/ ,/ 其/ 变化/ 决定/ 了/ 心房/ 肥大/ 的/ 状况/ ./ (/ 2/ )/ 查询/ 目标/ 模式/ 具有/ 可伸缩性/ ./ 在线/ 的/ 数据流/ 往往/ 会/ 无法/ 预知/ 地/ 重复/ 和/ 缺失/ 某些/ 部分/ ./ 因此/ 查询/ 目标/ 模式/ 应/ 具有/ 可伸缩性/ ,/ 即/ 是/ 由/ 多个/ 子模式/ 复合/ 而成/ 的/ 复杂/ 模式/ ./ 此处/ 的/ 可伸缩性/ 指在/ 保持/ 时序/ 关系/ 的/ 前提/ 下/ ,/ 允许/ 内部/ 某些/ 子模式/ 重复/ 、/ 缺失/ ,/ 抑或/ 是/ 波形/ 倒置/ ./ 以/ 医疗/ 数据流/ 监测/ 领域/ 为例/ ,/ 如图/ 2/ (/ a/ )/ 所示/ ,/ QRS/ 模式/ 和/ T/ 模式/ 周期性/ 交替/ 可能/ 预示/ 着/ 肺部/ 严重/ 感染/ 的/ 产生/ ./ 又/ 如/ P/ 模式/ 缺失/ ,/ T/ 模式/ 出现/ 多次/ 可能/ 会/ 导致/ 急性/ 肾功能/ 衰竭/ (/ 图/ 2/ (/ b/ )/ )/ ;/ 心肌/ 损害/ 常由/ U/ 模式/ 多次/ 出现/ 预示/ (/ 图/ 2/ (/ c/ )/ )/ ;/ 若/ T/ 模式/ 出现/ 波形/ 倒置/ (/ shapeinversed/ )/ ,/ 可能/ 预示/ 着/ 有/ 甲状腺/ 功能/ 减退/ 性/ 心脏病/ 的/ 危险/ (/ 图/ 2/ (/ d/ )/ )/ ./ 以上/ 是/ 数据流/ 上/ 的/ 查询/ 应/ 具备/ 的/ 一些/ 特点/ ./ 本文/ 的/ 研究/ 重点/ 是/ 为/ 用户/ 提供/ 数据流/ 上/ 灵活/ 、/ 方便/ 的/ 模式/ 查询处理/ 机制/ ,/ 提出/ 了/ 数据流/ 上/ 可/ 伸缩/ 模式/ 的/ Page3/ 查询/ (/ SPQ/ )/ 方法/ ./ SPQ/ 方法/ 允许/ 用户/ 根据/ 查询/ 需求/ 定义/ 目标/ 模式/ 并/ 设置/ 可/ 伸缩/ 条件/ ./ 为了/ 避免/ 匹配/ 二义性/ 生成/ 基/ 模式/ 覆盖/ ,/ 并/ 对/ 目标/ 模式/ 进行/ 查询/ 重写/ 形成/ SPQ/ ./ 进而/ 通过/ 模式匹配/ 形成/ 模式/ 流/ ./ 在/ 模式/ 流上/ 的/ 查询处理/ 中/ ,/ 尽可能/ 复用/ 已/ 处理结果/ 来/ 提高/ 查询/ 效率/ ./ 本文/ 第/ 2/ 节/ 简述/ 相关/ 研究/ ;/ 第/ 3/ 节/ 介绍/ 整体/ 架构/ ;/ 第/ 4/ 节/ 详述/ 可/ 伸缩/ 模式/ 查询/ 表示/ ;/ 第/ 5/ 节/ 描述/ 可/ 伸缩/ 模式/ 查询处理/ ;/ 第/ 6/ 节/ 通过/ 实验/ 来/ 分析方法/ 的/ 性能/ ;/ 第/ 7/ 节/ 总结/ 全文/ 并/ 展望/ 下/ 一步/ 的/ 方向/ ./ 2/ 相关/ 研究/ 近年来/ 有关/ 数据流/ 的/ 研究/ 受到/ 了/ 学术界/ 和/ 工业界/ 很多/ 关注/ ./ 与/ 本文/ 相关/ 的/ 工作/ 大致/ 可/ 分为/ 以下/ 两类/ ./ 2.1/ 可/ 伸缩/ 模式匹配/ 一类/ 与/ 本文/ 相关/ 的/ 研究/ 是/ 可/ 伸缩/ 模式匹配/ ./ 从技术上/ 讲/ ,/ 大致/ 分为/ 基于/ 时序/ 数据库/ 的/ 模式匹配/ 、/ 基于/ 树/ 的/ 模式匹配/ 和/ 基于/ 图/ 的/ 模式匹配/ 这/ 3/ 类/ ./ 第/ 1/ 种/ 是/ 基于/ 时序/ 数据库/ 的/ 可/ 伸缩/ 模式匹配/ 方法/ ./ 代表/ 有/ Kahveci/ 的/ 多/ 长度/ 索引/ 结构/ MR/ 方法/ [/ 1/ ]/ 和/ Kaghazian/ 等/ 人/ 提出/ 的/ RSPS/ 方法/ [/ 2/ ]/ ./ 前者/ 的/ 方法/ 提出/ MR/ 索引/ 结构/ 存储/ 不同/ 处理/ 长度/ 的/ 数据/ 信息/ ,/ 将/ 查询/ 切/ 分成/ 对应/ 于/ MR/ 的/ 多个/ 子/ 查询/ 并/ 分别/ 执行/ ./ 针对/ 每个/ 处理/ 层面/ 维护/ 一个/ 索引/ ,/ 空间/ 复杂度/ 较/ 高/ ,/ 对/ 数据库/ 中/ 的/ 全部/ 数据/ 建立/ 索引/ ,/ 时间/ 复杂度/ 为/ O/ (/ nt/ )/ ./ 将/ 这种/ 方法/ 应用/ 到/ 数据流/ 领域/ 是/ 不/ 现实/ 的/ ./ 该/ 方法/ 中/ 的/ 可/ 伸缩/ 是/ 查询/ 长度/ 可变/ ,/ 而/ 非/ 由/ 某些/ 部分/ 重复/ 或/ 缺失/ 导致/ 的/ 查询/ 模式/ 改变/ ,/ 故/ 与/ 本文/ 中/ 的/ 可/ 伸缩/ 模式/ 不同/ ./ RSPS/ 方法/ 支持/ 使用/ SQL/ 表达/ 可/ 伸缩/ 模式/ ,/ 即/ 部分/ 增加/ 或/ 缺失/ 的/ 复杂/ 模式/ ,/ 并/ 受/ KMP/ 算法/ 启发/ 计算/ shift/ (/ j/ )/ 和/ next/ (/ j/ )/ 来/ 发现/ 元素/ 间/ 的/ 内在联系/ ,/ 减少/ 对/ 相同/ 数据/ 的/ 多次/ 扫描/ ./ RSPS/ 虽然/ 减少/ 了/ 扫描/ 次数/ ,/ 但/ 计算/ 和/ 存储/ 转移/ 信息/ 消耗/ 较大/ ,/ 为/ O/ (/ m2/ )/ ./ 由于/ 数据流/ 只是/ 一遍/ 流过/ ,/ 故该/ 方法/ 并/ 不能/ 很/ 好/ 地/ 应用/ 于/ 数据流/ 领域/ ./ 第/ 2/ 种/ 是/ 基于/ 树/ 的/ 可/ 伸缩/ 模式匹配/ 方法/ ./ Mei/ 和/ Madden/ 提出/ 的/ 复合/ 事件处理/ 模型/ ZStream/ [/ 3/ ]/ 是/ 其/ 代表/ ./ 它/ 将/ 查询/ 操作/ 封装/ 为/ 事件/ 操作符/ ,/ 支持/ 可/ 伸缩/ 模式/ 的/ 查询/ ,/ 使用/ 基于/ 树/ 的/ 查询/ 计划/ 表示/ 查询/ 模式/ ,/ 利用/ 代价/ 模型/ 评估/ 最优/ 计划/ ./ 但/ ZStream/ 以/ 事件/ 为/ 粒度/ ,/ 其/ 处理/ 对象/ 是/ 由/ 数据源/ 直接/ 产生/ 的/ ,/ 不/ 支持/ 其/ 内部/ 细分/ ,/ 因此/ 无法/ 处理事件/ 间/ 的/ 包含/ 关系/ ./ 对应/ 到/ 数据流/ 的/ 可/ 伸缩/ 模式/ 处理/ ,/ 则/ 无法/ 解决/ SPQ/ 中/ 目标/ 模式/ 内部/ 各/ 子模式/ 间/ 的/ 相似性/ 包含/ 问题/ ./ 这/ 是因为/ SPQ/ 以基/ 模式/ 为/ 粒度/ ,/ 比/ 事件/ 的/ 粒度/ 要细/ ./ 基/ 模式/ 不是/ 数据源/ 直接/ 产生/ 的/ ,/ 是/ 由/ 用户/ 划分/ 、/ 后台/ 处理/ 而/ 得/ 的/ ./ 另外/ ,/ ZStream/ 的/ 树结构/ 存储/ 也/ 带来/ 额外/ 的/ 维护/ 代价/ ./ 第/ 3/ 种/ 是/ 基于/ 图/ 的/ 可/ 伸缩/ 模式匹配/ 方法/ ./ NFA/ 是/ 很/ 典型/ 的/ 方法/ ./ 由于/ 转移/ 状态/ 不/ 确定/ ,/ 匹配/ 不/ 成功/ 时会/ 产生/ 大量/ 回溯/ ,/ 因此/ 传统/ 的/ NFA/ 方法/ 是/ 离线/ 的/ ./ 为了/ 提高效率/ ,/ 改进/ 方法/ [/ 4/ -/ 7/ ]/ 逐步/ 产生/ ,/ 其中/ 一些/ 还/ 被/ 应用/ 于/ 事件/ 流/ 领域/ ,/ 支持/ 可/ 伸缩/ 模式/ 查询/ ./ 改进/ 主要/ 是/ 减少/ 回溯/ [/ 4/ -/ 6/ ]/ 和/ 引入/ 并行处理/ [/ 7/ ]/ ./ Agrawal/ 提出/ 了/ NFAb/ 的/ 方法/ [/ 5/ ]/ ,/ 引入/ singleton/ 和/ 栈/ 进行/ 可/ 伸缩/ 模式匹配/ ./ 每次/ 只/ 处理/ 一个/ 执行/ 过程/ 称之为/ sin/ -/ gleton/ ,/ 此/ 过程/ 一直/ 执行/ 直至/ singleton/ 匹配/ 成功/ 或/ 失败/ ,/ 其间/ 产生/ 的/ 其它/ 匹配/ 分支/ 点均/ 存入/ 栈中/ ./ 当/ 匹配/ 失败/ 时/ ,/ 从栈/ 中弹/ 出/ 最近/ 的/ 分支/ 点/ 作为/ 新/ 的/ sin/ -/ gleton/ 进行/ 匹配/ ./ 此/ 方法/ 也/ 是/ 以/ 直接/ 产生/ 于/ 数据源/ 的/ 事件/ 为/ 粒度/ ,/ 未/ 处理事件/ 间/ 的/ 包含/ 关系/ ./ 另外/ 当/ 模式/ 比较复杂/ 时/ ,/ 其/ 分支/ 点会/ 比较/ 多/ ,/ 使得/ 匹配/ 次数/ 增加/ ./ 另一类/ 方法/ 是/ 将/ NFA/ 转换/ 为/ 多个/ 较/ 小/ 的/ NFA/ 或者/ 对应/ 的/ DFA/ 后/ 采用/ 并行处理/ 的/ 方法/ ./ 但是/ 此/ 方法/ 会/ 随着/ 查询/ 模式/ 的/ 复杂性/ 增加/ 而/ 形成/ 大量/ 的/ NFA/ 或/ DFA/ ,/ 其/ 效率/ 很大/ 程度/ 上/ 取决于/ 查询/ 目标/ 模式/ 的/ 复杂程度/ ./ 2.2/ 数据流/ 管理系统/ (/ DSMS/ )/ 中/ 的/ 查询处理/ 很多/ 查询处理/ 技术/ 被/ 用来/ 实现/ 数据流/ 管理系统/ (/ DataStreamManagementSystem/ ,/ DSMS/ )/ ./ 比较/ 著名/ 的/ 如/ STREAM/ 系统/ [/ 8/ ]/ 、/ TelegraphCQ/ [/ 9/ ]/ 、/ Au/ -/ rora/ 系统/ [/ 10/ ]/ 、/ Cougar/ 项目/ [/ 11/ ]/ 、/ Hancock/ 项目/ [/ 12/ ]/ 等/ ./ DSMS/ 大都/ 着眼于/ 在/ 近似/ 实时/ 的/ 前提/ 下/ ,/ 完成/ 对/ 数据流/ 的/ 预定/ 义/ 查询/ ./ 但/ 其/ 查询/ 粒度/ 是/ 元组/ ,/ 不/ 支持/ 模式/ 的/ 整体/ 查询/ ./ 正如/ Papadimitriou/ 等/ 人/ 所述/ ,/ 这些/ 系统/ 的/ 共同/ 缺陷/ 在于/ 仅/ 着眼于/ 在/ 数据流/ 上/ 完成/ 传统/ 的/ 查询/ ,/ 没有/ 去/ 寻找/ 数据/ 的/ 特征/ ,/ 更/ 无法/ 完成/ 数据流/ 上/ 的/ 模式/ 查询/ [/ 13/ ]/ ./ 3/ 整体/ 架构图/ 4/ 展示/ 了/ 可/ 伸缩/ 模式/ 查询/ 的/ 整体/ 框架/ ./ 主要/ 由/ 查询/ 表示/ 和/ 查询处理/ 两/ 阶段/ 组成/ ./ 在/ 查询/ 表示/ 中/ ,/ 用户/ 通过/ 图形用户界面/ 在/ 原始数据/ 流/ 上/ 选择/ 并/ 定义/ 查询/ 目标/ 模式/ ,/ 设置/ 相应/ 的/ 可/ 伸缩/ 条件/ ;/ 根据/ 目标/ 模式/ ,/ 通过/ 基/ 模式/ 生成器/ 生成/ 基/ 模式/ 字典/ 和/ 基/ 模式/ 覆/ Page4/ 盖/ ;/ 进而/ 查询/ 重写/ 模块/ 以基/ 模式/ 为/ 粒度/ ,/ 将/ 目标/ 模式/ 转为/ 可/ 伸缩/ 模式/ ./ 在/ 查询处理/ 中/ ,/ 基于/ 基/ 模式/ 的/ 匹配/ 模块/ 将/ 不断/ 到达/ 的/ 数据/ 点/ 与/ 基/ 模式/ 并行/ 比较/ ,/ 从而/ 生成/ 模式/ 流/ ;/ 把/ 可/ 伸缩/ 模式/ 查询/ 应用/ 于/ 模式/ 流/ ,/ 通过/ 图/ 4/ 可/ 伸缩/ 模式/ 查询/ 整体/ 架构/ 4/ 可/ 伸缩/ 模式/ 查询/ 表示/ 用户/ 首先/ 根据/ 查询/ 需求/ 设定/ 模式/ 和/ 相应/ 的/ 可/ 伸缩/ 条件/ ,/ 形成/ 目标/ 模式/ ;/ 为/ 避免/ 子模式/ 间/ 的/ 相互/ 包含/ 关系/ 导致/ 的/ 匹配/ 二义性/ ,/ 引入/ 基/ 模式/ 和/ 基/ 模式/ 覆盖/ ;/ 进而/ 基于/ 基/ 模式/ 对/ 目标/ 模式/ 进行/ 查询/ 重写/ ,/ 生成/ SPQ/ ./ 4.1/ 目标/ 模式/ 本文/ 为/ 用户/ 提供/ 一种/ 即席/ 查询/ 的/ 机制/ ./ 允许/ 他们/ 结合/ 领域/ 知识/ 和/ 关注/ 重点/ ,/ 选择/ 富含/ 语义/ 的/ 子模/ 可/ 伸缩/ 模式/ 查询/ 执行器/ 完成/ 查询处理/ ;/ 将/ 结果/ 通过/ 查询/ 结果/ 展示/ 模块/ 以/ 标记/ 数据流/ 的/ 方式/ 返回/ 给/ 用户/ ./ 式/ 并/ 设置/ 相应/ 的/ 可/ 伸缩/ 条件/ ,/ 从而/ 给定/ 查询/ 目标/ 模式/ ./ 这种/ 方法/ 提高/ 了/ 模式/ 查询/ 的/ 灵活性/ ,/ 更好/ 地/ 考虑/ 了/ 用户/ 的/ 经验/ 和/ 需求/ ./ 但是/ 用户/ 直接/ 选择/ 的/ 模式/ 可能/ 会/ 出现/ 如图/ 5/ 所示/ 的/ 子模式/ 间/ 部分/ 重叠/ 的/ 情况/ ./ Page5/ 它会/ 带来/ 二义性/ ,/ 例如/ 用户/ 希望/ 查询/ 子模式/ i/ 出现/ 3/ 次/ ,/ 且/ 子模式/ j/ 不/ 出现/ 的/ 情况/ ,/ 那么/ 将/ 无法/ 判断/ 图/ 5/ 的/ 重叠/ 部分/ 究竟/ 是/ 重复/ 出现/ 3/ 次/ 还是/ 缺失/ ./ 因此/ 本文/ 涉及/ 的/ 查询/ 目标/ 模式/ 内部/ 的/ 各/ 子模式/ 间/ 不/ 允许/ 重叠/ ,/ 即/ 它们/ 是/ 不/ 重叠/ 模式/ ,/ 如/ 定义/ 2/ 所示/ ./ 定义/ 1/ ./ 数据流/ ./ 令/ S/ 代表/ 数据流/ ,/ 其中/ Xi/ 表示/ 时间/ 戳/ 为/ ti/ 时/ 的/ 数据/ 值/ ,/ 1/ / i/ / n/ ,/ 则/ S/ 可以/ 如下/ 表示/ :/ S/ =/ X1/ ,/ t/ (/ )/ 1/ ,/ X2/ ,/ t/ (/ )/ 2/ ,/ …/ ,/ Xi/ ,/ t/ (/ )/ i/ ,/ …/ ,/ Xn/ ,/ t/ (/ )/ {/ 定义/ 2/ ./ 不/ 重叠/ 模式/ ./ 令/ pi/ 表示/ 第/ i/ 个子/ 模式/ ./ 不/ 重叠/ 模式/ 具有/ 如下/ 特征/ :/ / 1/ / i/ / m/ ,/ 1/ / h/ / m/ ,/ i/ ≠/ h/ ,/ 子模式/ pi/ 和/ ph/ 满足/ tiki/ </ th1/ 或/ thkh/ </ ti1/ 条件/ ,/ 其中/ pi/ =/ Xi1/ ,/ ti/ (/ )/ 1/ ,/ Xi2/ ,/ ti/ (/ )/ 2/ ,/ …/ ,/ Xiki/ ,/ tik/ (/ )/ ph/ =/ Xh1/ ,/ th/ (/ )/ 1/ ,/ Xh2/ ,/ th/ (/ )/ 2/ ,/ …/ ,/ Xhkh/ ,/ thk/ (/ )/ 用户/ 设定/ 不/ 重叠/ 模式/ 后/ ,/ 根据/ 查询/ 需求/ 为/ 其/ 设置/ 相应/ 的/ 可/ 伸缩/ 条件/ (/ 见表/ 1/ )/ ,/ 进而/ 形成/ 目标/ 模式/ ,/ 用以/ 灵活/ 地/ 表达/ 丰富/ 的/ 查询/ 语义/ ./ 定义/ 3/ ./ 目标/ 模式/ ./ 令/ tp/ 表示/ 目标/ 模式/ ,/ c/ 表示/ 可/ 伸缩/ 条件/ ,/ 则/ 目标/ 模式/ 可以/ 表示/ 为/ tp/ =/ ∪/ mi/ =/ 1pi/ [/ ci/ ]/ ,/ 其中/ 共/ m/ 个/ 不/ 重叠/ 模式/ ,/ ci/ 为/ pi/ 对应/ 的/ 可/ 伸缩/ 条件/ ./ 由/ 定义/ 3/ 知/ 用户/ 选定/ 连续/ 的/ 区段/ ,/ 继续/ 在/ 其/ 上/ 定义/ 子/ 区段/ 作为/ 不/ 重叠/ 模式/ ,/ 并/ 设置/ 相应/ 可/ 伸缩/ 条件/ ./ 可见/ 目标/ 模式/ 是/ 由/ 若干个/ 子模式/ 复合/ 而成/ 的/ ,/ 它/ 允许/ 内部/ 某些/ 子模式/ 重复/ 、/ 缺失/ 或/ 倒置/ ,/ 表达/ 语义/ 更/ 复杂/ ./ 类型/ 符号/ 表示/ 重复/ [/ m/ ]/ 缺失/ -/ P/ 倒置/ PTP/ 模式/ 波形/ 倒置/ ,/ 180/ °/ 反转/ ;/ 或/ A/ |/ B4/ ./ 2/ 基/ 模式/ 覆盖/ 在/ 用户/ 定义/ 的/ 目标/ 模式/ 中/ ,/ 不/ 重叠/ 模式/ 仅仅/ 保证/ 了/ 物理/ 上/ 各/ 模式/ 间/ 是/ 没有/ 重叠/ 部分/ 的/ ,/ 但/ 并/ 不能/ 保证/ 彼此之间/ 逻辑/ 上/ 可以/ 很/ 好/ 地区/ 分/ ,/ 即/ 并未/ 消除/ 模式/ 间/ 可能/ 潜在/ 的/ 相互/ 包含/ 关系/ ./ 不/ 重叠/ 模式/ 间/ 的/ 潜在/ 相似性/ 包含/ 关系/ 如图/ 6/ 所示/ ,/ (/ a/ )/ 中/ 相似/ 于/ 左边/ 的/ 模式/ 整体/ 又/ 出现/ 在/ 右边/ 目标/ 模式/ 中/ ,/ (/ b/ )/ 中/ 两个/ 模式/ 都/ 包含/ 了/ 相似/ 的/ 一个/ 组成部分/ ./ 随着/ 数据流/ 源源不断/ 地/ 到达/ ,/ 匹配/ 可能/ 会/ 出现/ 二义性/ ./ 这/ 主要/ 是/ 由于/ 不/ 重叠/ 模式/ 间/ 存在/ 着/ 相似性/ 包含/ 关系/ ,/ 在/ 匹配/ 时/ 它们/ 都/ 在/ 误差/ 阈值/ 范围/ 之内/ ,/ 导致/ 多个/ 匹配/ 结果/ 的/ 出现/ ,/ 无法/ 正确/ 返回/ 查询/ 结果/ ./ 因此/ 本文/ 提出/ 的/ SPQ/ 方法/ 引入/ 了/ 基/ 模式/ (/ basepattern/ )/ 和/ 基/ 模式/ 覆盖/ (/ basepatterncover/ )/ 的/ 概念/ ,/ 如/ 定义/ 4/ 和/ 5/ 所示/ ,/ 用于/ 保证/ 不/ 重叠/ 模式/ 彼此间/ 不/ 存在/ 包含/ 关系/ ,/ 在/ 逻辑/ 上/ 是/ 彼此/ 可/ 区分/ 的/ ./ 定义/ 4/ ./ 基/ 模式/ ./ 基/ 模式/ 除了/ 具有/ 不/ 重叠/ 模式/ 的/ 特征/ 外/ ,/ 还有/ 如下/ 特征/ :/ / bpi/ ,/ bph/ ∈/ Coverb/ (/ )/ p/ ,/ i/ ≠/ h/ ,/ bpi/ =/ Xi1/ ,/ ti/ (/ )/ 1/ ,/ …/ ,/ Xij/ ,/ ti/ (/ )/ j/ ,/ …/ ,/ Xiki/ ,/ tik/ (/ )/ bph/ =/ Xh1/ ,/ th/ (/ )/ 1/ ,/ …/ ,/ Xhj/ ,/ th/ (/ )/ j/ ,/ …/ ,/ Xhkh/ ,/ thk/ (/ )/ // / th1/ / thp/ / thkh/ -/ tik/ (/ i/ -/ ti/ )/ 1/ +/ 1/ (/ 假定/ thkh/ >/ tiki/ )/ ,/ 对于/ subp/ =/ Xhp/ ,/ th/ (/ )/ p/ ,/ …/ ,/ Xhp/ +/ kh/ -/ 1/ ,/ thp/ +/ kh/ 得/ similarity/ (/ subp/ ,/ bpi/ )/ </ ε/ ,/ 其中/ ε/ 是/ 相似/ 度/ 衡量/ 误差/ 阈值/ ./ 由/ 定义/ 4/ 可知/ 基/ 模式/ 本质/ 上/ 仍/ 是/ 不/ 重叠/ 模式/ ,/ 但基/ 模式/ 彼此间/ 可/ 相互/ 区分/ ,/ 不/ 存在/ 包含/ 关系/ ./ 定义/ 5/ ./ 基/ 模式/ 覆盖/ ./ 存在/ 时间/ 戳/ 从/ tw1/ 到/ tw2/ 跨度/ 的/ 目标/ 模式/ ,/ 则/ 对于/ r/ 个基/ 模式/ ,/ 基/ 模式/ 覆盖/ 具有/ 如下/ 特征/ :/ 由/ 定义/ 5/ 可知/ ,/ 所有/ 的/ 基/ 模式/ 按/ 目标/ 模式/ 中/ 时序/ 顺序/ 首尾相连/ 能够/ 近似/ 重构/ 回/ 目标/ 模式/ 起止/ 时间/ 戳/ 所/ 跨越/ 的/ 范围/ ./ 生成/ 基/ 模式/ 及其/ 覆盖/ 算法/ 的/ 主要/ 思想/ 是/ 将/ 不/ 重叠/ 模式/ 两/ 两/ 比较/ ./ 若/ 存在/ 包含/ 关系/ ,/ 则/ 将/ 包含/ 部分/ 拆分/ 出来/ ./ 由于/ 新/ 拆分/ 出来/ 的/ 子模式/ 会/ 影响/ 当前/ 所有/ 模式/ 的/ 比较/ ,/ 本文/ 对/ 模式/ 按/ 大小/ 进行/ 排序/ ,/ 如/ 算法/ 1/ 所示/ ,/ 每次/ 判断/ 相似性/ 包含/ 关系/ 时/ ,/ 都/ 用/ 较/ 小/ 的/ 探针/ 模式/ (/ probepattern/ )/ 去/ 比较/ 或/ 拆分/ 较大/ 的/ 目标/ 模式/ Page6/ (/ targetpattern/ )/ ,/ 以/ 保证/ 任意/ 两个/ 基/ 模式/ 间/ 的/ 可/ 区分/ 性/ ;/ 同时/ 维护/ 当前/ 比较/ 记录/ 来/ 提高效率/ ./ 若/ 两/ 模式/ 尚未/ 比较/ 则/ 调用/ 算法/ 2/ 来/ 判断/ 是否/ 存在/ 包含/ 关系/ ,/ 若/ 存在/ 则/ 拆/ 分成/ 可/ 相互/ 区分/ 的/ 基/ 模式/ ,/ 其间/ 优化/ 新/ 产生/ 基/ 模式/ 的/ 插入/ 位置/ ,/ 用来/ 减少/ 比较/ 次数/ 和/ 保证/ 准确性/ ./ 算法/ 1/ ./ Basepatternsgeneration/ (/ 基/ 模式/ 生成/ )/ ./ 输入/ :/ tp/ ,/ errorboundEbp/ 输出/ :/ Dictionary/ (/ bp/ )/ ,/ Cover/ (/ bp/ )/ 中间/ 变量/ :/ probeindexi/ ,/ targetindexj/ ,/ Set/ (/ bp/ )/ ;/ 1/ ./ InitializeSet/ (/ bp/ )/ withtp/ ,/ andorderSet/ (/ bp/ )/ inas/ -/ 2/ ./ fori/ </ Set/ (/ bp/ )/ ./ sizedo/ // // comparewithotherbp3/ ./ j/ =/ i/ +/ 1/ ;/ 4/ ./ forj/ </ Set/ (/ bp/ )/ ./ sizedo5/ ./ ifbpiandbpjhavealreadybeencompared6/ ./ j/ ++/ ,/ movetonexttargetbpjofSet/ (/ bp/ )/ ;/ 7/ ./ elsebpiandbpjhaven/ ’/ tbeencompared8/ ./ i/ ,/ j/ ←/ Patternsplit/ (/ bpi/ ,/ bpj/ ,/ Set/ (/ bp/ )/ ,/ Ebp/ )/ ;/ 9/ ./ ifidoesnotchangetheni/ ++/ ;/ 10/ ./ generateDictionary/ (/ bp/ )/ andCover/ (/ bp/ )/ dueto/ 算法/ 2/ ./ Patternsplit/ (/ bpi/ ,/ bpj/ ,/ Set/ (/ bp/ )/ ,/ Ebp/ )/ 输入/ :/ bpi/ ,/ bpj/ ,/ Set/ (/ bp/ )/ ,/ Ebp/ 输出/ :/ Set/ (/ bp/ )/ ,/ probeindexi/ ,/ targetindexj/ 中间/ 变量/ :/ insertIndex/ ,/ compareResult/ ;/ 1/ ./ compareResult/ ←/ SimilarityCompare/ (/ bpi/ ,/ bpj/ ,/ Ebp/ )/ ,/ 2/ ./ ifcompareResultindicatesbpiisn/ ’/ tsimilartobpj3/ ./ j/ ++/ ;/ // // movetonextbp/ (/ basepattern/ )/ 4/ ./ elsesplitbpjwithcompareResult/ ,/ 5/ ./ replacebpjbybpnewinascendingorder/ ;/ 6/ ./ recordalltheinsertindexes/ ;/ 7/ ./ insertIndex/ ←/ findminimuminsertindex/ ;/ 8/ ./ ifinsertIndex/ >/ ithenj/ ++/ ;/ 9/ ./ elseifinsertIndex/ </ ithen/ // // disturbrecord10/ ./ i/ =/ insertIndex/ ,/ breaktostartanewpass/ ;/ 算法/ 1/ 调用/ 算法/ 2/ 作为/ 关键步骤/ ,/ 考虑/ 目标/ 基/ 模式/ 含/ k/ 个点/ ,/ 探针/ 基/ 模式/ 含/ h/ 个点/ ,/ 则/ 算法/ 2/ 的/ 关键/ 方法/ SimilarityCompare/ 决定/ 了/ 其/ 时间/ 复杂度/ 为/ O/ (/ h/ (/ k/ -/ h/ )/ )/ ./ 若/ 共有/ m/ 个/ 不/ 重叠/ 模式/ ,/ 此处/ 假设/ 平均/ 每次/ 比较/ 后/ 进行/ 一次/ 拆分/ ,/ 增加/ 一个/ 新/ 的/ 模式/ ./ 则/ 算法/ 1/ 的/ 时间/ 复杂度/ 为/ O/ (/ mh/ (/ m/ -/ 1/ )/ (/ k/ -/ h/ )/ )/ ./ 实际/ 应用/ 中/ 一般/ 不会/ 达到/ 上述/ 假设/ 情况/ ,/ 通常/ 拆分/ 的/ 次数/ 并/ 不太多/ ,/ 而且/ 算法/ 1/ 和/ 2/ 对/ 算法/ 的/ 优化/ 也/ 提高/ 了/ 效率/ ./ 此处/ 复杂度/ 虽然/ 不/ 一定/ 能/ 满足/ 线性/ 要求/ ,/ 但是/ 保证/ 了/ 生成/ 基/ 模式/ 的/ 准确性/ ;/ 并且/ 此/ 过程/ 只是/ 根据/ 目标/ 模式/ 执行/ 一次/ 即可/ ./ 所以/ 为了/ 后续/ 查询处理/ 的/ 精度/ 、/ 生成/ 准确/ 的/ 基/ 模式/ 字典/ ,/ 以/ 一定/ 时间/ 换/ 精确度/ 是/ 可以/ 接受/ 的/ ./ 4.3/ 基于/ 基/ 模式/ 的/ 查询/ 重写/ 产生/ 基/ 模式/ 后/ ,/ 可以/ 对/ 表达/ 查询/ 需求/ 的/ 目标/ 模式/ 进行/ 查询/ 重写/ ./ 这种/ 重写/ 是/ 基于/ 基/ 模式/ 粒度/ 的/ ,/ 不但/ 表达/ 灵活/ ,/ 而且/ 在/ 后续/ 查询/ 中/ 也/ 可/ 避免/ 匹配/ 二义性/ 的/ 问题/ ./ 通过/ 对/ 目标/ 模式/ 进行/ 基于/ 基/ 模式/ 的/ 查询/ 重写/ ,/ 可以/ 形成/ 可/ 伸缩/ 模式/ 查询/ (/ SPQ/ )/ ./ 定义/ 6/ ./ 令/ sp/ 表示/ 可/ 伸缩/ 模式/ ,/ mc/ 表示/ 可/ 伸缩/ 条件/ ,/ 共/ r/ 个基/ 模式/ ,/ 则/ 可/ 伸缩/ 模式/ 表示/ 如下/ :/ 其中/ bpi/ 为基/ 模式/ ,/ mci/ 为/ 其/ 对应/ 的/ 可/ 伸缩/ 条件/ ./ 可/ 伸缩/ 模式/ 查询/ 是/ 对/ 目标/ 模式/ 的/ 查询/ 重写/ ./ 它/ 基于/ 基/ 模式/ 的/ 粒度/ ./ SPQ/ 同样/ 允许/ 内部/ 的/ 某些/ 基/ 模式/ 重复/ 、/ 缺失/ 或/ 倒置/ ,/ 处理/ 粒度/ 相对/ 更细/ 一些/ ./ 而/ 这种/ 查询/ 重写/ 首先/ 要/ 将/ 可/ 伸缩/ 条件/ 从/ 目标/ 模式/ 中/ 的/ 不/ 重叠/ 模式/ 映射/ 到/ 可/ 伸缩/ 模式/ 中/ 的/ 基/ 模式/ 上/ ./ 由/ 同一个/ 不/ 重叠/ 模式/ 拆分/ 出/ 的/ 基/ 模式/ 要/ 共享/ 相同/ 的/ 可/ 伸缩/ 条件/ ,/ 且/ 这种/ 查询/ 重写/ 的/ 过程/ 对/ 用户/ 是/ 透明/ 的/ ./ 具体/ 如/ 算法/ 3/ 所示/ ./ 例如/ 目标/ 模式/ 为/ A/ [/ 1/ -/ 2/ ]/ B/ [/ 1/ ]/ (/ -/ C/ |/ C/ [/ 1/ ]/ )/ ,/ 且/ C/ 可以/ 拆/ 分为/ A/ 和/ D/ ,/ 所以/ 基/ 模式/ 为/ A/ 、/ B/ 、/ D/ ,/ 则/ SPQ/ 可以/ 表示/ 为/ A/ [/ 1/ -/ 2/ ]/ B/ [/ 1/ ]/ (/ -/ A/ -/ D/ |/ A/ [/ 1/ ]/ D/ [/ 1/ ]/ )/ ./ 算法/ 3/ ./ SPQgeneration/ (/ 可/ 伸缩/ 模式/ 查询/ 生成/ )/ ./ 输入/ :/ Dictionary/ (/ bp/ )/ ,/ Cover/ (/ bp/ )/ ,/ tp/ ;/ 输出/ :/ scalablepatternsp/ ;/ 1/ ./ foreverybpinCover/ (/ bp/ )/ 2/ ./ ifitcorrespondstopintp3/ ./ bp/ ./ constraints/ ←/ p/ ./ constraints/ ;/ 4/ ./ updatespwithbpandscalableconstaints/ ;/ 若/ 目标/ 模式/ 中有/ m/ 个/ 模式/ ,/ 通过/ 算法/ 1/ 和/ 2/ 生成/ r/ 个基/ 模式/ ,/ 一般/ 情况/ 下/ r/ 稍/ 大于/ m/ ./ 算法/ 3/ 要/ 浏览/ 一遍/ Cover/ (/ bp/ )/ ,/ 则/ 其/ 时间/ 复杂度/ 为/ O/ (/ kr/ )/ ,/ 其中/ k/ 为/ 常数/ ./ 5/ 可/ 伸缩/ 模式/ 查询处理/ 可/ 伸缩/ 模式/ 查询处理/ 可以/ 根据/ 已/ 生成/ 的/ 基/ 模式/ 字典/ 在/ 数据流/ 上/ 自动/ 执行/ ./ 首先/ 对/ 依次/ 到达/ 的/ 数据/ 点/ 并行/ 判断/ 连续/ 点/ 组成/ 的/ 轨迹/ 是否/ 满足/ 任一/ 基/ 模式/ ,/ 从而/ 完成/ 基于/ 基/ 模式/ 的/ 匹配/ ,/ 形成/ 模式/ 流/ ;/ 进而/ 对/ 模式/ 流中/ 的/ 基/ 模式/ 按/ 时序/ 顺序/ 出现/ 的/ 情况/ 进行/ 计数/ ,/ 尽可能/ 复用/ 已/ 处理/ 的/ 结果/ ,/ 实现/ 基于/ 模式/ 流/ 的/ 查询/ ./ Page75/ ./ 1/ 基于/ 基/ 模式/ 的/ 匹配/ 在/ 数据流/ 应用领域/ ,/ 数据/ 点/ 源源不断/ 地/ 到来/ ,/ 连续/ 点/ 的/ 轨迹/ 可以/ 显示/ 出/ 这些/ 点/ 的/ 大致/ 走向/ 与/ 趋势/ ./ 受此/ 启发/ ,/ 每/ 到达/ 一个/ 数据/ 点/ ,/ SPQ/ 方法/ 就/ 将/ 其/ 与/ 基/ 模式/ 字典/ 中/ 的/ 所有/ 基/ 模式/ 同步/ 比较/ ,/ 即/ 并行/ 地/ 判断/ 点/ 的/ 轨迹/ 与/ 哪个/ 基/ 模式/ 相似/ ,/ 可以/ 匹配/ 成功/ ./ 在/ 并行/ 匹配/ 过程/ 中/ ,/ 随着/ 数据/ 点/ 不断/ 地/ 到达/ ,/ 连续/ 点/ 的/ 轨迹/ 与/ 基/ 模式/ 并行/ 比较/ 会/ 形成/ 多个/ 分支/ ,/ 分支/ 停止/ 情况/ 大致/ 有/ 以下/ 3/ 种/ 关系/ :/ (/ 1/ )/ 与/ 某/ 一基/ 模式/ 的/ 比较/ 尚未/ 结束/ ,/ 但是/ 累积/ 误差/ 已经/ 超过/ 误差/ 阈值/ ,/ 及时/ 停止/ 该/ 分支/ 比较/ ;/ 如图/ 7/ (/ a/ )/ 所示/ ,/ 其中/ EB/ 为/ 误差/ 阈值/ ./ 最/ 开始/ 与/ 所有/ 基/ 模式/ 的/ 比较/ 都/ 在/ 误差/ 范围/ 内/ ,/ 随着/ 数据/ 点/ 不断/ 地图/ 7/ 基于/ 基/ 模式/ 的/ 模式匹配/ 与/ 模式/ 流/ 生成/ 在/ 基于/ 基/ 模式/ 的/ 匹配/ 中/ ,/ 匹配/ 成功/ 的/ 点/ 的/ 轨迹/ 就/ 可以/ 用/ 与其/ 相似/ 的/ 基/ 模式/ 来/ 替换/ ,/ 使用/ 与其/ 对应/ 的/ 唯一/ 标识符/ 记录/ ;/ 若/ 匹配/ 不/ 成功/ ,/ 则/ 将/ 该/ 连续/ 点/ 的/ 轨迹/ 直接/ 记录下来/ ,/ 并/ 记作/ wi/ ,/ 其中/ 可能/ 包含/ 噪声/ 数据/ ,/ 它/ 不会/ 被/ 任何/ 基/ 模式匹配/ ,/ 因此/ 具有/ 一定/ 的/ 抗/ 噪声/ 能力/ ./ 如/ 算法/ 4/ 所示/ 生成/ 相应/ 的/ 模式/ 流/ ,/ 以/ 提高/ 后续/ 查询/ 的/ 效率/ ./ 此/ 模式/ 流由/ 大量/ 的/ 基/ 模式/ 标识符/ 以及/ 一些/ 未/ 匹配/ 点/ 的/ 轨迹/ 组成/ ,/ 将/ 这些/ 点/ 的/ 轨迹/ 完整/ 地/ 记录下来/ ,/ 并/ 保存/ 在/ wi/ 中/ ./ 如图/ 7/ (/ b/ )/ 所示/ ,/ 对应/ 于/ 当前/ 数据流/ 的/ 模式/ 流是/ w1ABDDBD/ ,/ 且/ w1/ 中/ 同时/ 记录/ 了/ 此/ 匹配/ 不/ 成功/ 的/ 连续/ 点/ 的/ 轨迹/ 信息/ ./ 在/ 查询/ 不/ 匹配/ 时/ ,/ 在/ 模式/ 流/ 上/ 进行/ 回溯/ 的/ 效率/ 要/ 高于/ 在/ 数以百计/ 的/ 数据/ 点上/ 进行/ 回溯/ ./ 流/ 生成/ )/ ./ 算法/ 4/ ./ Basepatternstreamgeneration/ (/ 模式/ 输入/ :/ S/ :/ adatastream/ ,/ EB/ :/ errorthreshold/ ,/ 输出/ :/ bps/ :/ basepatternstream/ 中间/ 变量/ :/ errorArray/ [/ ]/ :/ distanceerrorsforeachbp/ ,/ 1/ ./ initializetheinteriorvariables/ ;/ 到达/ ,/ 点/ 的/ 轨迹/ 与/ 基/ 模式/ A/ 相似/ 度/ 超过/ 误差/ 阈值/ ,/ 停止/ 与/ A/ 的/ 比较/ ,/ 其它/ 分支/ 继续/ 并行/ 比较/ ;/ (/ 2/ )/ 与/ 某个/ 基/ 模式/ 比较/ 结束/ ,/ 且/ 累积/ 误差/ 满足/ 阈值/ 要求/ ,/ 连续/ 点/ 的/ 轨迹/ 很快/ 收敛/ 到/ 该/ 基/ 模式/ 的/ 波形/ ,/ 说明/ 匹配/ 成功/ ,/ 停止/ 其它/ 分支/ 比较/ :/ 如图/ 7/ (/ a/ )/ 所示/ ,/ 与/ 基/ 模式/ B/ 的/ 比较/ 已/ 完成/ ,/ 且/ 误差/ 未/ 超过/ 阈值/ ,/ 则/ 认为/ 当前/ 比较/ 的/ 连续/ 点/ 的/ 轨迹/ 与/ 基/ 模式/ B/ 匹配/ ,/ 对/ 新/ 到达/ 的/ 连续/ 数据/ 点/ 重复/ 执行/ 上述/ 过程/ ;/ (/ 3/ )/ 全部/ 基/ 模式/ 的/ 匹配/ 都/ 未/ 完成/ ,/ 但/ 所有/ 比较/ 分支/ 的/ 误差/ 均/ 已/ 超过/ 误差/ 阈值/ ,/ 此时/ 认为/ 该/ 连续/ 点/ 的/ 轨迹/ 与/ 任意/ 基/ 模式/ 均/ 不/ 匹配/ 或者/ 可能/ 是/ 噪声/ 数据/ ./ 2/ ./ foreverynewarrivingdatapointdi/ ;/ 3/ ./ forj/ </ Dictinary/ (/ bp/ )/ ./ size/ ;/ 4/ ./ errorArray/ [/ j/ ]/ +/ =/ isBelongToBP/ (/ di/ ,/ bpj/ )/ ;/ 5/ ./ iflen/ [/ j/ ]/ </ bpj/ ./ sizeanderrorArray/ [/ j/ ]/ >/ EB6/ ./ stopcomparisonforbpj/ ;/ 7/ ./ elseiflen/ [/ j/ ]/ =/ =/ bpj/ ./ sizeand8/ ./ addbpjtobps/ ;/ 9/ ./ isRecognized/ ←/ true/ ;/ 10/ ./ ifisRecognized/ =/ =/ falsethen11/ ./ jointhesedatapointsafterthebpsaswi/ ;/ 在/ 算法/ 4/ 中/ ,/ 将/ 数据流/ 的/ 大小/ 设定/ 为/ |/ S/ |/ ,/ 计算/ 当前/ 点/ 是否/ 落/ 在/ 某基/ 模式/ 上/ 的/ 开销/ 为/ O/ (/ 1/ )/ ./ 算法/ 4/ 的/ 主要/ 操作/ 为/ 计算/ 累积/ 误差/ 并/ 判断/ 分支/ 是否/ 停止/ 的/ 操作/ ,/ 而/ 对于/ 多个/ 并行/ 比较/ 的/ 分支/ ,/ 只/ 参考/ 处理/ 时间/ 最长/ 的/ 即可/ ,/ 因此/ 其/ 时间/ 复杂度/ 为/ O/ (/ |/ S/ |/ )/ ./ 5.2/ 基于/ 模式/ 流/ 的/ 查询/ 实现/ 在/ 模式/ 流/ 上/ ,/ SPQ/ 方法/ 对/ 按/ 时序/ 顺序排列/ 的/ 基/ Page8/ 模式/ 的/ 出现/ 情况/ 进行/ 计数/ ./ 如/ 4.3/ 节中/ 提到/ 的/ 可/ 伸缩/ 模式/ 查询/ A/ [/ 1/ -/ 2/ ]/ B/ [/ 1/ ]/ (/ -/ A/ -/ D/ |/ A/ [/ 1/ ]/ D/ [/ 1/ ]/ )/ ,/ 设置/ counter/ 数组/ 用来/ 记录/ 基/ 模式/ A/ 、/ B/ 、/ A/ 、/ D/ 的/ 匹配/ 次数/ ./ 进而/ 根据/ 其/ 出现/ 次数/ 与/ SPQ/ 的/ 约束/ 限制/ 判断/ 是否/ 能够/ 匹配/ 上/ ./ 若/ 不/ 匹配/ 时/ ,/ 对/ 第一个/ 模式/ 的/ 出现/ 次数/ 进行/ 判断/ ,/ 若/ 其/ 在/ SPQ/ 第一个/ 基/ 模式/ 的/ 可/ 伸缩/ 条件/ 的/ 限制/ 范围/ 内/ ,/ 且/ 与/ 该/ 模式/ 相似/ ,/ 则/ 可/ 复用/ 部分/ 已/ 处理结果/ ;/ 否则/ 在/ 以基/ 模式/ 和/ wi/ 为/ 粒度/ 的/ 模式/ 流/ 上/ 继续/ 后续/ 匹配/ ./ 可/ 伸缩/ 模式/ 查询/ 的/ 整体/ 处理/ 如/ 算法/ 5/ 所示/ :/ 首先/ 调用/ 算法/ 1Basepatternsgeneration/ 生成/ 基/ 模式/ 和/ 基/ 模式/ 覆盖/ ,/ 进而/ 调用/ 算法/ 3SPQgeneration/ 对/ 目标/ 模式/ 进行/ 基于/ 基/ 模式/ 的/ 查询/ 重写/ 形成/ SPQ/ ,/ 完成/ 可/ 伸缩/ 模式/ 查询/ 表示/ ;/ 随后/ 在/ 数据流/ 上/ 执行/ 可/ 伸缩/ 模式/ 查询处理/ ,/ 调用/ 算法/ 4Basepatternstreamgeneration/ 将/ 连续/ 点/ 的/ 轨迹/ 与/ 所有/ 基/ 模式/ 并行/ 地/ 比较/ ,/ 判断/ 其/ 是否/ 与/ 某/ 一基/ 模式/ 相似/ ,/ 生成/ 模式/ 流/ ,/ 继而/ 对/ 按/ 时序/ 排列/ 的/ 基/ 模式/ 的/ 出现/ 情况/ 进行/ 计数/ ,/ 完成/ 后续/ SPQ/ 匹配/ ./ (/ 数据流/ 上/ 的/ 可/ 伸缩/ 模式/ 查询/ )/ ./ 算法/ 5/ ./ ScalablePatternQueryoverDataStream/ 输入/ :/ S/ :/ adatastream/ ,/ EB/ :/ errorthreshold/ ,/ 输出/ :/ MR/ :/ matchingresultwithgraphicalinformation/ 中间/ 变量/ :/ Dictionary/ (/ bp/ )/ :/ thesetofallbasepatterns/ ,/ // // ScalablePatternQueryExpressionisfocusedbelow1/ ./ basepatternsgeneration/ (/ tp/ ,/ Ebp/ )/ ,/ returnDictionary/ (/ bp/ )/ andCover/ (/ bp/ )/ ;/ 2/ ./ SPQgenerationwithconstraintsmappingtoCover/ (/ bp/ )/ ;/ // // ScalablePatternQueryEvaluationisfocusedbelow3/ ./ initializetheotherinteriorvariables/ ;/ 4/ ./ basepatternstreamgenerationtogeneratebps/ ;/ 5/ ./ foreverybpinbps/ ,/ compareitwithinSPQ6/ ./ whenthetypeofthecurrentbpischange/ ,/ calcu/ -/ 7/ ./ ifitmeetsthetypeandcounteriswithintheSPQ8/ ./ locatepointertothefirstbpofthelatest9/ ./ elsebacktrackbpsatpointer/ ;/ 10/ ./ returnMR/ ;/ 对于/ 模式/ 查询/ 而言/ ,/ 主要/ 时间/ 消耗/ 在/ 生成/ 基/ 模式/ 及基/ 模式/ 覆盖/ 上/ ,/ 开销/ 为/ O/ (/ mh/ (/ m/ -/ 1/ )/ (/ k/ -/ h/ )/ )/ ,/ 正如/ 4.2/ 节中/ 提到/ 的/ ,/ 此/ 过程/ 只/ 执行/ 一次/ ,/ 以/ 一定/ 的/ 时间/ 换取/ 了/ 后续/ 匹配/ 的/ 精度/ ./ 在/ 查询处理/ 时/ ,/ 若/ 共/ 回溯/ Nbacktrack/ 次/ ,/ 则/ 时间/ 复杂度/ 为/ O/ (/ c/ |/ S/ |/ )/ ,/ 其中/ c/ =/ 1/ +/ (/ Nbacktrack/ // |/ S/ |/ )/ ./ 6/ 实验/ 结果/ 与/ 分析/ 基于/ 上述/ 思想/ ,/ 本文/ 实现/ 了/ 数据流/ 上/ 的/ 可/ 伸缩/ 模式/ 查询/ ,/ 设计/ 了/ 相关/ 实验/ 对比/ 不同/ 方法/ 在/ 查全率/ 、/ 查准率/ 和/ 处理/ 效率/ 上/ 的/ 区别/ ./ 具体/ 实验/ 环境/ 如下/ :/ OS/ 是/ MicrosoftWindowsXPProfessionalEditionServicePack3/ ,/ CPU/ 为/ IntelCore2/ ,/ 内存/ 1GHz/ ,/ 主频/ 1.66/ GHz/ ,/ 内存/ 1GB/ ./ 算法/ 开发/ 环境/ 是/ MyE/ -/ clipse7/ ./ 0EnterpriseWorkbench/ ,/ JDK1/ ./ 5.0/ ;/ 算法/ 开发/ 语言/ 是/ Java/ ./ 在/ 真实/ 的/ 医疗/ 数据流/ 和/ 用电/ 数据/ 集上/ 进行/ 实验/ ./ (/ 1/ )/ 医疗/ 数据流/ ./ 从/ PortlandStateUniversity/ 的/ BiomedicalSignalProcessingLaboratory/ 下载/ 了/ 超过/ 2/ 千万个/ 数据/ 点/ 的/ 儿科/ 重症/ 监护/ 数据/ ,/ 是/ 对/ 一位/ 儿童/ 6/ 项/ 生理/ 体征/ 进行/ 连续/ 6h/ 的/ 同步/ 测量/ 得到/ 的/ ,/ 频率/ 为/ 500Hz/ ./ 其中/ 包括/ 心电图/ 数据/ (/ ECG/ )/ 、/ 动脉/ 血压/ (/ ABP/ )/ 、/ 中心/ 静脉/ 血压/ (/ CVP/ )/ 、/ 颅内/ 压/ (/ ICP/ )/ 、/ 呼吸机/ 数据/ (/ RESP/ )/ 和/ 动脉血/ 氧/ 饱和度/ (/ PLETH/ )/ ./ 其中/ ECG/ 的/ 模式/ 种类/ 多且/ 复杂/ ,/ CVP/ 和/ ABP/ 的/ 模式/ 种类/ 少/ 而且/ 变化/ 简单/ ./ (/ 2/ )/ 民用/ 用电量/ 数据/ ./ 数据/ 来源于/ 福建/ 某/ 电力公司/ ,/ 设立/ 多个/ 观察点/ ,/ 数据/ 点/ 超过/ 12/ 万个/ ./ 每个/ 数据/ 都/ 有/ 相应/ 的/ 时间/ 戳/ 和/ 对应/ 数值/ ./ 该/ 数据/ 集/ 特点/ 是/ 包含/ 较/ 多/ 噪声/ 数据/ ,/ 如图/ 3/ 所示/ ./ 根据/ 第/ 2/ 节/ 的/ 相关/ 研究/ ,/ SPQ/ 方法/ 在/ 查询/ 表示/ 上/ 优于/ DSMS/ 中/ 基于/ 元组/ 的/ 查询/ ,/ 表达/ 灵活/ 、/ 语义/ 丰富/ ,/ 而/ 后者/ 不/ 支持/ 对/ 模式/ 的/ 查询处理/ ./ 基于/ 时序/ 数据库/ 的/ 模式匹配/ 方法/ ,/ 其/ 往往/ 对/ 数据/ 进行/ 多遍/ 扫描/ ,/ 很难/ 满足/ 数据流/ 的/ 实时处理/ 要求/ ./ 基于/ 树/ 的/ ZStream/ 方法/ 是/ 以/ 事件/ 为/ 粒度/ 的/ ,/ 它/ 是/ 由/ 数据源/ 直接/ 产生/ 的/ ,/ 不/ 支持/ 在/ 其/ 内部/ 细分/ ,/ 因此/ 无法/ 处理事件/ 间/ 的/ 包含/ 关系/ ,/ 在/ 匹配/ 中/ 可能/ 造成/ 二义性/ ./ 基于/ 图/ 的/ NFA/ 传统/ 方法/ 是/ 离线/ 的/ ,/ 近些年/ 基于/ NFA/ 的/ 方法/ 逐步/ 向/ 在线/ 处理/ 方向/ 发展/ ./ 综上所述/ ,/ 本文/ 选择/ 一种/ 典型/ 的/ 基于/ NFA/ 的/ 方法/ ,/ 即/ NFAb/ 的/ 方法/ 与/ SPQ/ 方法/ 进行/ 比较/ ./ 实验/ 主要/ 从/ 查全率/ 、/ 查准率/ 和/ 处理/ 效率/ 这/ 3/ 个/ 指标/ 来/ 衡量/ ./ Page96/ ./ 1/ 查全率/ 查全率/ 表示/ 为/ Rrecall/ =/ Nreal/ // Ndue/ ,/ 用于/ 衡量/ 算法/ 查询/ 出/ 的/ 结果/ 个数/ 是否/ 达到/ 预期/ 目标/ ./ 它/ 是/ 查询/ 出/ 的/ 相关/ 结果/ 数/ 与/ 系统/ 预期/ 的/ 相关/ 结果/ 数之比/ ./ 其中/ Nreal/ 为/ 查询/ 出/ 的/ 相关/ 结果/ 数/ ,/ Ndue/ 为/ 预期/ 的/ 相关/ 数目/ ./ Ndue/ 采用/ 人工/ 标识/ 的/ 方式/ ,/ 由/ 专业/ 用户/ 根据/ 经验/ 给定/ ,/ 从而/ 形成/ 统一/ 的/ 衡量标准/ ./ 图/ 8/ 展示/ 了/ SPQ/ 和/ NFAb/ 两种/ 方法/ 应用/ 于/ 医疗/ 数据流/ 查询/ 时/ 的/ 查全率/ ./ 对应/ 于/ 6/ 个/ 数据/ 集/ 的/ 误差/ 阈值/ 分别/ 为/ 0.07/ 、/ 0.55/ 、/ 0.02/ 、/ 0.03/ 、/ 0.6/ 、/ 0.6/ ./ 从图/ 8/ 中/ 可以/ 看出/ ,/ 当/ 模式/ 较为/ 复杂/ 时/ ,/ 在/ 查全率/ 方面/ SPQ/ 方法/ 优于/ NFAb/ 方法/ ./ 由于/ ECG/ 数据/ 点/ 间隔/ 密集/ 、/ 模式/ 复杂/ 、/ 多样性/ 较/ 高/ ,/ 导致/ 模式/ 间/ 的/ 组合/ 多/ ,/ 拆分/ 出/ 的/ 基/ 模式/ 也/ 就/ 更/ 多/ ,/ 从而/ 使得/ 基于/ 基/ 模式/ 操作/ 粒度/ 的/ SPQ/ 方法/ 能/ 较/ 准确/ 地/ 发现/ 符合要求/ 的/ 结果/ ;/ 而/ NFAb/ 基于/ 事件/ 的/ 粒度/ (/ 对应/ 于/ 本文/ 中/ 不/ 重叠/ 模式/ 的/ 粒度/ )/ ,/ 由于/ 未/ 拆分/ 包含/ 关系/ ,/ 在/ 匹配/ 中/ 可能/ 出现/ 二义性/ 的/ 情况/ ,/ 实现/ 时/ 任意/ 选择/ 一个/ 匹配/ 结果/ 以供/ 后续/ 处理/ ./ 所以/ SPQ/ 方法/ 的/ 查全率/ 优于/ NFAb/ 方法/ ,/ 最/ 主要/ 的/ 原因/ 是/ 前者/ 考虑/ 了/ 模式/ 间/ 相互/ 包含/ 的/ 关系/ ,/ 并/ 使用/ 更细/ 的/ 基/ 模式/ 粒度/ 进行/ 查询/ ./ 类似/ 的/ ,/ RESP/ 、/ ICP/ 、/ PLETH/ 等/ 数据/ 集/ 模式/ 波形/ 都/ 相对/ 较/ 复杂/ ,/ 因此/ 两种/ 方法/ 对比/ 稍/ 明显/ ,/ 而/ CVP/ 、/ ABP/ 模式/ 多样性/ 低/ ,/ 故/ 两种/ 方法/ 对比/ 相差/ 不/ 大/ ,/ 且/ 其/ 查全率/ 相对/ 于/ 其它/ 数据/ 集要/ 高些/ ./ 6.2/ 查准率/ 查准率/ 表示/ 为/ Rprecision/ =/ Nreal/ // Nout/ ,/ 用于/ 衡量/ 查询/ 结果/ 的/ 正确性/ ./ 它/ 是/ 查询/ 出/ 的/ 相关/ 结果/ 数/ 与/ 查询/ 出/ 的/ 总数/ 之比/ ./ 其中/ Nout/ 为/ 查询/ 出/ 的/ 总数/ ,/ Nreal/ 仍为/ 查询/ 出/ 的/ 相关/ 结果/ 数/ ./ 查准率/ Rprecision/ 和/ 查全率/ Rrecall/ 综合/ 起来/ 衡量/ 查询/ 结果/ 的/ 完备/ 性/ ./ 图/ 9/ 展示/ 了/ SPQ/ 和/ NFAb/ 两种/ 方法/ 应用/ 于/ 医疗/ 数据流/ 查询/ 的/ 查准率/ ./ 该/ 实验/ 的/ 误差/ 阈值/ 取值/ 与/ 查全率/ 实验/ 相同/ ./ 从图/ 9/ 中/ 可以/ 看出/ ,/ 当/ 模式/ 较为/ 复杂/ 时/ ,/ SPQ/ 方法/ 在/ 查准率/ 上/ 优于/ NFAb/ 方法/ ./ 主要/ 原因/ 与/ 查全率/ 实验/ 相似/ ,/ 仍/ 是因为/ SPQ/ 方法/ 考虑/ 了/ 模式/ 间/ 相互/ 包含/ 的/ 关系/ ,/ 并/ 使用/ 更细/ 的/ 基/ 模式/ 粒度/ 进行/ 查询/ ,/ 从而/ 保证/ 了/ 查询/ 的/ 精准度/ ./ 但/ 由/ 图/ 9/ 可以/ 看出/ ,/ 当/ 模式/ 较为/ 复杂/ 时/ ,/ 其/ 查准率/ 相对/ 更高/ 一些/ ,/ 比如/ ECG/ 、/ RESP/ 、/ PLETH/ 等/ ;/ 而/ 对于/ CVP/ 等/ 模式/ 变化/ 较少/ 的/ 数据/ 集其/ 查准率/ 则/ 相对/ 低/ 一些/ ./ 这/ 主要/ 是因为/ 某一/ 误差/ 阈值/ 设定/ 后/ ,/ 当/ 模式/ 较/ 复杂/ 时/ ,/ 相互之间/ 差别/ 也/ 较大/ ,/ 累计/ 误差/ 随之/ 增加/ ,/ 可以/ 较/ 好/ 地区/ 分/ 查询/ 结果/ ,/ 因此/ 查询/ 出/ 的/ 结果/ 多为/ 吻合/ 度/ 较/ 高/ 的/ ;/ 而/ 模式/ 简单/ 、/ 缺乏/ 变化/ 的/ ,/ 其/ 累计/ 误差/ 增加/ 缓慢/ ,/ 不/ 容易/ 超过/ 误差/ 阈值/ ,/ 所以/ 查询/ 结果/ 中/ 会/ 存在/ 一些/ 并非/ 预期/ 的/ 结果/ ,/ 它们/ 因未/ 超过/ 误差/ 阈值/ 被/ 认作/ 匹配/ 成功/ ,/ 进而/ 被/ 包含/ 进来/ ./ 因此/ 对于/ 查准率/ 而言/ ,/ SPQ/ 方法/ 在/ 模式/ 较为/ 复杂/ 的/ 数据/ 上/ 效果/ 更加/ 明显/ ./ 6.3/ 处理/ 效率/ 处理/ 效率/ 表示/ 为/ Eprocess/ 用于/ 衡量/ 算法/ 执行/ 效率/ ./ 此处/ 以/ 返回/ 单个/ 查询/ 结果/ 的/ 响应/ 时间/ (/ responsetime/ )/ 为/ 核心/ ,/ 计算/ 所有/ 响应/ 时间/ 的/ 平均值/ 来/ 衡量/ 查询/ 算法/ 的/ 处理/ 效率/ ./ 如图/ 10/ 所示/ ,/ SPQ/ 方法/ 在/ 处理/ 效率/ 上/ 优于/ NFAb/ 方法/ ,/ 且/ 模式/ 越/ 复杂/ 优势/ 越/ 明显/ ./ 这/ 主要/ 是因为/ SPQ/ 是/ 基于/ 基/ 模式/ 粒度/ 的/ ,/ 匹配/ 过程/ 中/ ,/ 在/ 模式/ 流上/ 为/ SPQ/ 中/ 每个/ 基/ 模式/ 的/ 连续/ 出现/ 次数/ 计数/ ,/ 以/ 反映/ 其/ 重复/ 或/ 缺失/ 的/ 情况/ ./ 当/ 不/ 匹配/ 时/ ,/ 对/ 第一个/ 模式/ 的/ 出现/ 次数/ 进行/ 判断/ ,/ 若/ 其/ 在/ SPQ/ 第一个/ 基/ 模式/ 可/ 伸缩/ 条件/ 的/ 限制/ 范围/ 内/ ,/ 且/ 与/ 该/ 模式/ 相似/ ,/ 则/ 可/ 复用/ 部分/ 已/ 处理结果/ ./ 而/ NFAb/ 这种/ 减少/ 回溯/ 的/ 方法/ ,/ 当/ 处理/ 的/ 模式/ 较/ 复杂/ 时/ ,/ 每个/ singleton/ 中/ 可能/ 会/ 形成/ 多个/ 分支/ 点/ ,/ 将/ 其均/ 存入/ 栈中/ ,/ 当/ 发生/ 不/ 匹配/ 时/ 逐个/ 弹/ 出/ 分支/ 点/ ,/ 按/ 其/ 位置/ 依次/ 匹配/ 下/ 一种/ 查询/ 的/ 可/ Page10/ 能性/ ./ 当/ 目标/ 模式/ 较/ 复杂/ 时/ ,/ 会/ 花费/ 较/ 多/ 的/ 时间/ 去/ 尝试/ 各种/ 可能/ ./ 由于/ ECG/ 数据/ 点/ 间隔/ 密集/ 、/ 模式/ 复杂/ 、/ 多样性/ 较/ 高/ ,/ 形成/ 的/ 基/ 模式/ 较/ 多/ ,/ 查询/ 相对/ 其它/ 来说/ 较/ 复杂/ ,/ 因此/ 返回/ 单个/ 查询/ 结果/ 的/ 时间/ 消耗/ 也/ 较长/ ./ 6.4/ 误差/ 阈值/ 设置/ 图/ 11/ 显示/ 了/ 匹配/ 误差/ 阈值/ 的/ 设置/ 对/ SPQ/ 方法/ 的/ 影响/ ,/ 该/ 实验/ 在/ 民用/ 用电/ 数据/ 集上/ 进行/ ./ 由图/ 11/ 的/ 结果显示/ 可以/ 看出/ ,/ 方法/ 较/ 好/ 地/ 适应/ 了/ 有/ 噪声/ 的/ 环境/ ./ 随着/ 误差/ 阈值/ 的/ 增大/ ,/ 查全率/ (/ 图/ 11/ 菱形/ 表示/ )/ 会/ 有/ 较/ 明显/ 的/ 增高/ ,/ 而/ 到达某/ 一值/ 后/ ,/ 后续/ 增长/ 很/ 平缓/ ,/ 这/ 主要/ 是因为/ 阈值/ 的/ 增大/ 在/ 初期/ 可以/ 使得/ 很多/ 预期/ 结果/ 被/ 查询/ 出来/ ,/ 而/ 随着/ 阈值/ 的/ 增大/ ,/ 大多数/ 的/ 预期/ 结果/ 均/ 被/ 查询/ 出来/ ,/ 所以/ 此时/ 再/ 增长/ 阈值/ ,/ 其/ 查全率/ 增长/ 并/ 不/ 明显/ ./ 而/ 查准率/ (/ 图/ 11/ 方块/ 表示/ )/ 则/ 是/ 会/ 随着/ 阈值/ 的/ 增大/ 而/ 逐步/ 减小/ ,/ 到达某/ 一值/ 后/ 减小/ 趋势/ 开始/ 明显/ ,/ 如图/ 中/ 的/ 0.08/ 之后/ ,/ 这/ 主要/ 是因为/ 随着/ 阈值/ 的/ 增大/ ,/ 查询/ 出/ 的/ 结果/ 数/ 增多/ ,/ 一些/ 并/ 不/ 十分相似/ 的/ 也/ 被/ 包含/ 进来/ ,/ 从而/ 导致/ 查准率/ 的/ 降低/ ./ 因此/ 为了/ 得到/ 全面/ 的/ 查询/ 结果/ ,/ SPQ/ 方法/ 应从/ 查全率/ 和/ 查准率/ 两/ 方面/ 综合/ 考虑/ 来/ 设定/ 阈值/ ,/ 如/ 民用/ 用电/ 数据/ 集用/ 例中/ 较/ 合理/ 的/ 阈值/ 为/ 0.08/ 左右/ ./ 7/ 总结/ 与/ 展望/ 为了/ 在/ 数据流/ 上/ 支持/ 以/ 模式/ 为/ 粒度/ 的/ 查询/ ,/ 并/ 允许/ 目标/ 模式/ 具有/ 一定/ 的/ 可伸缩性/ ,/ 本文/ 提出/ 了/ 一种/ 数据流/ 上/ 面向/ 可/ 伸缩/ 模式/ 的/ 查询/ (/ SPQ/ )/ 方法/ ./ SPQ/ 方法/ 提出/ 了/ 以基/ 模式/ 为/ 粒度/ 的/ 查询/ 重写/ 机制/ ,/ 进而/ 在/ 数据流/ 上/ 通过/ 基/ 模式匹配/ 形成/ 了/ 模式/ 流/ ./ 在/ 模式/ 流上/ 的/ 查询处理/ 中/ ,/ 尽可能/ 复用/ 已/ 处理结果/ 来/ 提高/ 查询/ 效率/ ./ 在/ 真实/ 数据/ 集上/ 的/ 实验/ 结果/ 证明/ SPQ/ 方法/ 在/ 查全率/ 、/ 查准率/ 和/ 处理/ 效率/ 方面/ 优于/ NFAb/ 的/ 方法/ ,/ 尤其/ 当/ 目标/ 模式/ 较为/ 复杂/ 时/ 效果/ 更加/ 明显/ ./ 丰富/ 的/ 语义/ ;/ 考虑/ 查询/ 结果/ 的/ 共享/ 等/ ./ 致谢/ 感谢/ 为/ 本文/ 的/ 成稿/ 提供/ 有/ 建设性/ 意见/ 的/ 各位朋友/ ,/ 是/ 你们/ 的/ 灵感/ 启发/ 和/ 无私/ 的/ 帮助/ 使得/ 作者/ 更加/ 完善/ 了/ 本文/ 的/ 核心思想/ 和/ 整体/ 方法/ ./ 同时/ 也/ 要/ 感谢/ 匿名/ 评委/ ,/ 他们/ 对/ 本文/ 的/ 评审/ 意见/ 和/ 建议/ 对/ 本文/ 的/ 改进/ 大有裨益/ !/ 今后/ 的/ 工作/ 主要/ 是/ 扩展/ 更/ 多/ 约束条件/ 以/ 支持/ 更/ 

