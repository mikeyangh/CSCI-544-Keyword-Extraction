Page1/ 基于/ 属性/ 提升/ 与/ 局部/ 采样/ 的/ 推荐/ 评分/ 预测/ 郑麟/ 朱福喜/ 姚杏/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 摘要/ 评分/ 预测/ 问题/ 是/ 推荐/ 系统/ 研究/ 的/ 一个/ 分支/ ./ 在/ 上下文/ 感知/ 推荐/ (/ Context/ -/ AwareRecommendation/ ,/ CAR/ )/ 中/ ,/ 常常/ 需要/ 考虑/ 上下文/ 因子/ (/ 或称/ 属性/ )/ 对/ 评分/ 预测/ 效果/ 的/ 影响/ ./ 现有/ 模型/ 大多/ 是/ 捕捉/ 单个/ 属性/ 的/ 特征/ 并/ 加上/ 多个/ 属性/ 间/ 的/ 相互作用/ (/ 简称/ 属性/ 交互/ )/ 实现/ 评分/ 预测/ ./ 然而/ ,/ 有些/ 算法/ 在/ 捕捉/ 属性/ 间/ 的/ 相互作用/ 时/ 没有/ 针对性/ ,/ 使/ 一些/ 属性/ 交互/ 对/ 预测/ 结果/ 没有/ 帮助/ ,/ 甚至/ 降低/ 模型/ 性能/ ;/ 而且/ ,/ 在/ 实现/ 属性/ 交互/ 时/ ,/ 很多/ 算法/ 只是/ 单纯/ 地/ 使用/ 固定/ 的/ 属性/ 值/ ,/ 没有/ 从/ 某个/ 方面/ 挖掘出/ 它们/ 的/ 潜在/ 特征/ ./ 为了/ 解决/ 这些/ 问题/ ,/ 文中/ 提出/ 了/ 属性/ 提升/ (/ AttributeBoosting/ ,/ AB/ )/ 框架/ ,/ 从/ 用户/ 、/ 物品/ 与/ 属性/ 类型/ 3/ 个/ 方面/ 分别/ 与/ 属性/ 进行/ 交互/ ./ 这种/ 更/ 精细/ 的/ 建模/ 方式/ 使/ 属性/ 能够/ 自动/ 地/ 适应/ 用户/ 偏好/ 、/ 物品/ 关联/ 与/ 类型/ 特征/ ,/ 并/ 能/ 在/ 评分/ 预测/ 中/ 充分/ 地/ 发挥作用/ ./ 在/ 此基础/ 上/ ,/ 文中/ 结合/ 概率/ 图/ 模型/ 的/ 低/ 秩/ 近似/ 能力/ 和/ 随机/ 梯度/ 下降/ (/ StochasticGradientDescent/ ,/ SGD/ )/ 的/ 快速/ 训练/ 优势/ ,/ 在/ 算法/ 性能/ 和/ 训练/ 效率/ 上/ 进行/ 权衡/ ,/ 设计/ 了/ 局部/ 采样/ (/ PartialSampling/ ,/ PS/ )/ 方法/ 学习/ 属性/ 提升/ 框架/ 的/ 参数/ ,/ 最终/ 构成/ 完整/ 的/ 属性/ 提升/ 与/ 局部/ 采样/ (/ AttributeBoostingwithPartialSampling/ ,/ ABPS/ )/ 模型/ ./ 实验/ 证明/ ,/ ABPS/ 模型/ 通过/ 有/ 针对性/ 的/ 属性/ 交互/ ,/ 能/ 有效/ 地/ 挖掘出/ 属性/ 有用/ 的/ 隐含/ 特征/ ,/ 从而/ 减少/ 盲目/ 交互/ 带来/ 的/ 消极影响/ ;/ 利用/ 局部/ 采样/ ,/ 该/ 模型/ 能/ 使用/ 更/ 低/ 的/ 特征/ 维度/ 描述/ 个性化/ 信息/ ,/ 取得/ 比/ 其他/ 模型/ 更好/ 的/ 效果/ ./ 关键词/ 推荐/ 系统/ ;/ 上下文/ 感知/ 推荐/ ;/ 评分/ 预测/ ;/ 属性/ 提升/ ;/ 局部/ 采样/ ;/ 数据挖掘/ 1/ 引言/ 推荐/ 技术/ 从/ 早期/ 的/ 协同/ 过滤/ (/ CollaborativeFiltering/ ,/ CF/ )/ 发展/ 而/ 来/ ,/ CF/ 主要/ 处理/ 的/ 是/ 评分/ 预测/ 问题/ ./ 随着/ 信息量/ 的/ 增大/ ,/ 用户/ 对/ 智能/ 推荐/ 的/ 需求/ 越来越/ 强烈/ ,/ CF/ 逐渐/ 从/ 单纯/ 的/ 利用/ 用户/ 和/ 物品/ 预测/ 评分/ 发展/ 到/ 加入/ 辅助/ 信息/ 来/ 提高/ 模型/ 的/ 性能/ ./ 这/ 导致/ 了/ 推荐/ 领域/ 的/ 另/ 一个/ 方向/ ,/ 上下文/ 感知/ 推荐/ (/ Context/ -/ AwareRecommendation/ ,/ CAR/ )/ 的/ 产生/ [/ 1/ ]/ ./ CAR/ 考虑/ 了/ 除/ 用户/ 编号/ 和/ 物品/ 编号/ 之外/ 的/ 更/ 多/ 信息/ ,/ 比如/ 用户/ 的/ 辅助/ 信息/ 、/ 物品/ 的/ 说明/ 和/ 社会/ 网络/ 等/ ,/ 这些/ 信息/ 统称/ 为/ 上下文/ 因子/ (/ contextualfactors/ )/ ./ 在/ 实际/ 应用/ 中/ ,/ 上下文/ 因子/ 主要/ 表现/ 为/ 用户/ 和/ 物品/ 的/ 各种/ 固有/ 信息/ ,/ 比如/ 用户/ 的/ 年龄/ 、/ 电影/ 的/ 类型/ 等/ ./ 一些/ 文献/ [/ 1/ ]/ 把/ 上下文/ 因子/ 称为/ 特征/ (/ feature/ )/ ,/ 为了/ 把/ 实体/ 的/ 固有/ 信息/ 和/ 隐含/ 特征/ 区分/ 开来/ ,/ 本文/ 使用/ “/ 属性/ (/ attribute/ )/ ”/ 来/ 表示/ 实体/ 的/ 固有/ 信息/ ./ 如何/ 利用/ 属性/ 与/ 属性/ 之间/ 的/ 相互作用/ 来/ 辅助/ 评分/ 预测/ 是/ CAR/ 研究/ 的/ 一个/ 分支/ ./ 一种/ 方法/ 是/ 将/ CAR/ 看成/ 在/ 传统/ 的/ CF/ 中/ 加入/ 附加/ 信息/ 协助/ 预测/ [/ 2/ ]/ ;/ 另/ 一种/ 是/ 把/ CF/ 中/ 的/ 用户/ -/ 物品/ 矩阵/ 扩展/ 为/ 高维/ 张量/ 进行/ 处理/ ,/ 得到/ 用户/ 的/ 潜在/ 特征/ [/ 3/ ]/ 或/ 用户/ 的/ 行为/ 偏好/ [/ 4/ ]/ ./ 而/ 最/ 直接/ 的/ 方法/ ,/ 是/ 将/ 用户/ 编号/ 和/ 物品/ 编号/ 也/ 看成/ 属性/ 的/ 一种/ ,/ 嵌入/ 到/ 模型/ 中/ 统一/ 进行/ 学习/ ,/ 从而/ 更好/ 地/ 反映/ 出/ 属性/ 间/ 的/ 联系/ [/ 5/ ]/ ./ 对于/ 更加/ 复杂/ 的/ 上下文/ 信息/ ,/ 学者/ 们/ 倾向/ 于用/ 集成/ 的/ 方法/ 来/ 解决/ 评分/ 预测/ 问题/ [/ 6/ ]/ ./ 无论/ 模型/ 是/ 如何/ 构建/ 的/ ,/ 属性/ 都/ 在/ 其中/ 起着/ 决定性/ 的/ 作用/ ,/ 因为/ 对/ 属性/ 的/ 处理/ 会/ 极大/ 地/ 影响/ 到/ 结果/ [/ 7/ ]/ ./ 上述/ 几种/ 模型/ 捕捉/ 的/ 是/ 全部/ 属性/ 之间/ 的/ 交互/ ,/ 但是/ 在/ 实际/ 应用/ 中/ ,/ 很多/ 交互/ 是/ 没有/ 必要/ 的/ ,/ 例如/ 用户/ 的/ 性别/ 和/ 电影/ 的/ 放映/ 时间/ 、/ 电影/ 的/ 类型/ 和/ 电影/ 的/ 发行/ 日期/ 等等/ ./ 另/ 一个/ 方面/ ,/ 参与/ 交互/ 的/ 属性/ 是/ (/ 值/ )/ 固定/ 的/ ,/ 也就是说/ ,/ 属性/ 的/ 值/ 从/ 模型/ 的/ 开始/ 训练/ 到/ 结束/ 都/ 是/ 不变/ 的/ ./ 而/ 这个/ 固定/ 的/ 值/ 显然/ 无法/ 满足/ 不同/ 用户/ 的/ 需求/ ,/ 比如/ 用户/ A/ 对/ 纯棉/ 的/ 衣服/ 比较/ 喜欢/ ,/ 而/ 用户/ B/ 却/ 对/ 纯棉/ 提不起/ 兴趣/ ,/ 这/ 说明/ “/ 纯棉/ ”/ 只是/ “/ 衣服/ 质地/ ”/ 这一/ 属性/ 的/ 客观/ 反映/ ,/ 难以/ 衡量/ 不同/ 用户/ 间/ 的/ 兴趣/ 差异/ ./ 因此/ 在/ 训练/ 过程/ 中/ 可以/ 使/ 属性/ 的/ 值/ 自/ 适应/ 于/ 用户/ 偏好/ ,/ 以/ 满足/ 不同/ 的/ 用户/ 需求/ ;/ 另一方面/ ,/ 可以/ 选择/ 对/ 评分/ 预测/ 影响/ 较大/ 的/ 几个/ 方面/ 来/ 进行/ 属性/ 交互/ ,/ 从而/ 提高/ 模型/ 性能/ ./ 本文/ 的/ 主要/ 贡献/ 如下/ :/ (/ 1/ )/ 提出/ 一种/ 在/ 上下文/ 感知/ 推荐/ 中/ 进行/ 评分/ 预测/ 的/ 方法/ ./ 该/ 方法/ 以/ 因子/ 分解/ 模型/ 为/ 基础/ ,/ 通过/ 类型/ 、/ 用户/ 和/ 物品/ 3/ 个/ 层面/ 与/ 属性/ 进行/ 交互/ ,/ 挖掘出/ 更/ 多/ 的/ 潜在/ 信息/ ,/ 并/ 提升/ 属性/ 交互/ 的/ 积极/ 影响/ ./ 这个/ 过程/ 称为/ 属性/ 提升/ (/ AttributeBoosting/ )/ ./ (/ 2/ )/ 在/ 属性/ 提升/ 框架/ 的/ 基础/ 上/ ,/ 我们/ 从/ 概率/ 图/ 的/ 角度/ 来/ 描述/ 因子/ 模型/ ./ 针对/ 不同/ 的/ 因子/ (/ 或/ 参数/ )/ ,/ 设计/ 不同/ 的/ 训练方法/ :/ 对/ 数量/ 相对/ 固定/ 的/ 因子/ 使用/ 采样/ 学习/ 法/ ,/ 而/ 对/ 数量/ 变化/ 较大/ 的/ 因子/ 使用/ 随机/ 梯度/ 下降/ 和/ 交替/ 最小/ 二/ 乘法/ 实现/ 快速/ 学习/ ./ 这种/ 混合/ 的/ 训练方法/ 称为/ 局部/ 采样/ (/ PartialSampling/ )/ ,/ 它/ 能够/ 使/ 模型/ 在/ 效率/ 和/ 性能/ 上/ 得到/ 平衡/ ./ (/ 3/ )/ 属性/ 提升/ 与/ 局部/ 采样/ (/ AttributeBoostingwithPartialSampling/ ,/ ABPS/ )/ 模型/ 能/ 使/ 算法/ 性能/ 随着/ 属性/ 增加/ 而/ 总体/ 呈/ 提升/ 趋势/ ,/ 并/ 能/ 使/ 其用/ 更/ 低/ 特征/ 维度/ 的/ 方法/ 比/ 其他/ 代表性/ 的/ 方法/ 取得/ 更好/ 的/ 效果/ ./ 本文/ 第/ 2/ 节/ 介绍/ 相关/ 的/ 研究/ 工作/ ;/ 第/ 3/ 节/ 描述/ 属性/ 提升/ 的/ 动机/ ;/ 模型/ 的/ 细节/ 和/ 算法/ 实现/ 流程/ 将/ 在/ 第/ 4/ 节/ 给出/ ;/ 第/ 5/ 节/ 实现/ 在/ 真实/ 数据/ 集上/ 的/ 实验/ 和/ 比较/ ;/ 最后/ 第/ 6/ 节是/ 对/ 本文/ 的/ 工作/ 进行/ 总结/ ./ 2/ 相关/ 工作/ 推荐/ 中/ 的/ 评分/ 预测/ 问题/ 在/ 协同/ 过滤/ (/ CF/ )/ 中得/ Page3/ 到/ 了/ 充分/ 的/ 研究/ ,/ 基于/ CF/ 的/ 评分/ 预测/ 包括/ 邻域/ (/ neighborhood/ )/ 模型/ 和/ 潜在/ 因子/ (/ latentfactor/ )/ 模型/ ./ 在/ 邻域/ 方法/ 中/ ,/ 用户/ 和/ 物品/ 的/ 联系/ 被/ 显式/ 的/ 建模/ ,/ 而/ 在/ 因子/ 模型/ 中/ ,/ 用户/ 和/ 物品/ 都/ 由/ 特征向量/ 所/ 表示/ ,/ 这些/ 特征向量/ 的/ 交互/ 反映/ 了/ 用户/ 和/ 物品/ 间/ 的/ 关系/ ./ 矩阵/ 分解/ (/ MatrixFactorization/ ,/ MF/ )/ 是/ 因子/ 模型/ 的/ 一种/ ,/ 广泛应用/ 于/ CF/ 中/ ,/ 它/ 又/ 被/ 称为/ SVD/ ,/ 是/ 早期/ 评分/ 预测/ 的/ 主要/ 方法/ ./ SVD/ ++/ [/ 8/ ]/ 是/ SVD/ 的/ 改进/ 版本/ ,/ 它/ 利用/ 了/ 邻域/ 模型/ 的/ 优势/ ,/ 将/ 其/ 融入/ 因子/ 模型/ 中/ ,/ 取得/ 比/ SVD/ 更好/ 的/ 效果/ ./ SVD/ 这类/ 模型/ 一般/ 使用/ 随机/ 梯度/ 下降/ (/ StochasticGradientDescent/ ,/ SGD/ )/ 进行/ 学习/ ,/ 其/ 适用/ 于/ 数据量/ 较大/ 时/ 进行/ 逐条/ 记录/ 的/ 学习/ ,/ 但/ 缺点/ 是/ 需要/ 调节/ 较/ 多/ 的/ 参数/ ./ 文献/ [/ 9/ ]/ 从/ 概率/ 的/ 角度/ 来/ 做/ 矩阵/ 分解/ ,/ 提出/ PMF/ 模型/ ,/ 并/ 在/ 此基础/ 上/ 通过/ 贝叶斯/ 方法/ 自动控制/ 模型/ 的/ 超/ 参数/ 和/ 参数/ ,/ 从而/ 得到/ 改进版/ 的/ BPMF/ 模型/ [/ 10/ ]/ ./ 该/ 模型/ 通过/ 马尔可夫/ 链/ 蒙特卡洛/ (/ MarkovChainMonteCarlo/ ,/ MCMC/ )/ 方法/ 进行/ 高效/ 训练/ ,/ 可以/ 得到/ 比/ PMF/ 更/ 小/ 的/ 误差/ ./ 相对/ 于/ 单纯/ 使用/ 用户/ 和/ 物品/ 特征/ 进行/ 矩阵/ 分解/ ,/ 上下文/ 感知/ 推荐/ 中/ 的/ 矩阵/ 分解/ 更多地/ 利用/ 了/ 额外/ 属性/ 来/ 做/ 评分/ 预测/ ./ 时间/ 是/ 上下文/ 信息/ (/ 属性/ )/ 的/ 一种/ ,/ 对/ 时间/ 的/ 处理/ 是/ 学者/ 们/ 在/ 上下文/ 推荐/ 中/ 研究/ 的/ 一个/ 方向/ ,/ TimeSVD/ ++/ [/ 11/ ]/ 通过/ 对/ 时间轴/ 进行/ 建模/ ,/ 捕捉/ 用户/ 偏好/ 与/ 动态/ 时序/ 间/ 的/ 关系/ ,/ 能够/ 比/ 无/ 时序/ 模型/ 取得/ 更好/ 的/ 效果/ ./ BPTF/ 模型/ [/ 12/ ]/ 是/ BPMF/ 模型/ 的/ 时间/ 扩充/ 版本/ ,/ 它/ 通过/ 加入/ 时间/ 维度/ ,/ 把/ 二维/ 的/ 用户/ 物品/ 矩阵/ 扩展/ 为/ 三维/ 的/ 张量/ 进行/ 分解/ ,/ 从而/ 把/ 时间/ 因子/ 与/ 用户/ 和/ 物品/ 因子/ 同等对待/ 进行/ 学习/ ,/ 效果/ 比/ BPMF/ 更好/ ./ 除了/ 时间/ 因素/ ,/ 地理位置/ 也/ 属于/ 上下文/ 因子/ 的/ 一种/ ,/ CACF/ -/ GA/ 模型/ [/ 13/ ]/ 通过/ 遗传算法/ 把/ 地理位置/ 信息/ 融入/ 协同/ 过滤/ 中/ ,/ 使/ 评分/ 预测/ 的/ 误差/ 相对/ 于/ 时序/ 模型/ 来说/ 更/ 小/ ./ 相对/ 于/ 时间/ 和/ 位置/ 属性/ ,/ 社会/ 网络/ 更/ 倾向/ 于/ 描绘/ 用户/ 之间/ 的/ 联系/ ,/ 在/ CF/ 中/ 融入/ 社会/ 网络/ (/ 或称/ 信任/ 网络/ )/ 信息/ ,/ 对/ 提高/ 预测/ 的/ 精度/ 是/ 有/ 很大/ 帮助/ 的/ ,/ TrustMF/ [/ 14/ ]/ 把/ 信任/ 矩阵/ (/ TrustMatrix/ )/ 嵌入/ 用户/ -/ 物品/ 矩阵/ 进行/ 分解/ ,/ 有效/ 地/ 学习/ 了/ 用户/ 之间/ 的/ 隐含/ 联系/ ,/ 从而/ 提高/ 了/ 模型/ 性能/ ./ 比/ “/ 上下文/ 信息/ 辅助/ 协同/ 过滤/ ”/ 更/ 直接/ 的/ 方法/ 是/ 将/ 所有/ 上下文/ 信息/ (/ 包括/ 用户/ 和/ 物品/ )/ 一起/ 建模/ ./ 张量/ 分解/ (/ TensorFactorization/ ,/ TF/ )/ 是/ 其中/ 一种/ 方法/ ,/ 它/ 的/ 优势/ 是/ 可以/ 直接/ 表示/ 高维/ 的/ 上下文/ 因子/ ./ 文献/ [/ 3/ ]/ 提出/ 了/ 用/ TF/ 解决/ 上下文/ 推荐/ 评分/ 预测/ 的/ 泛化/ 模型/ ,/ 对/ “/ 用户/ -/ 物品/ -/ 上下文/ 因子/ ”/ 形成/ 的/ 张量/ 进行/ 分解/ ,/ 具有/ 普适性/ ./ TF/ 对/ 嵌入/ 上下文/ 信息/ 进行/ 评分/ 预测/ 是/ 直接/ 而/ 有效/ 的/ ,/ 但是/ 它/ 的/ 训练/ 开销/ 随着/ 上下文/ 信息/ 的/ 增加/ 而/ 快速增长/ ,/ 从而/ 有/ 可能/ 导致/ “/ 维度/ 灾难/ ”/ (/ curseofdimensionality/ )/ [/ 15/ ]/ ./ 另/ 一种/ 更好/ 的/ 解决/ 方法/ 是/ 捕捉/ 属性/ 间/ 的/ 交互/ ,/ SVDFeature/ [/ 16/ ]/ 集成/ 了/ 所有/ 上下文/ 信息/ ,/ 通过/ 全局/ 分量/ 、/ 用户/ 分量/ 和/ 物品/ 分量/ 与/ 其他/ 属性/ 产生/ 交互/ ,/ 更好/ 地/ 利用/ 了/ 属性/ 的/ 特征/ ./ 合理/ 利用/ 属性/ 并/ 挖掘/ 它们/ 之间/ 关系/ 的/ 另/ 一个/ 有效/ 模型/ 是/ 因子/ 分解/ 机/ (/ FactorizationMachine/ ,/ FM/ )/ [/ 17/ ]/ ,/ 它/ 捕捉/ 了/ 属性/ 间/ 的/ 二路/ 交互/ ,/ 并/ 通过/ 交替/ 最小/ 二/ 乘法/ (/ AlternatingLeastSquare/ ,/ ALS/ )/ 进行/ 快速/ 学习/ [/ 18/ ]/ ,/ 在/ 评分/ 预测/ 上/ 效果显著/ ./ 它/ 的/ 另/ 一个/ 优点/ 是/ 其/ 通用性/ ,/ 通过/ 特征/ 变换/ ,/ 它/ 可以/ 模拟/ 其他/ 的/ 模型/ ,/ 比如/ TF/ 和/ SVDFeature/ ./ 但是/ ,/ 它/ 的/ 不足之处/ 是/ 捕获/ 了/ 一些/ 没/ 必要/ 的/ 属性/ 交互/ ,/ 而且/ 和/ 其他/ 属性/ 交互/ 模型/ 类似/ ,/ 该/ 方法/ 把/ 属性/ 当成/ 静态/ 的/ 信息/ 进行/ 学习/ ,/ 不能/ 让/ 属性/ 动态/ 地/ 适应/ 用户/ 偏好/ 和/ 属性/ 类型/ ,/ 从而/ 在/ 个性化/ 建模/ 方面/ 有/ 较大/ 的/ 扩展/ 空间/ ,/ 而/ 这/ 也/ 是/ 本文/ 的/ 研究/ 重点/ 与/ 创新/ 之处/ ./ 3/ 属性/ 提升/ 的/ 动机/ FM/ 的/ 优势/ 在于/ 捕捉/ 了/ 属性/ 间/ 的/ 点/ 对/ 交互/ ,/ 如式/ (/ 1/ )/ 所示/ ,/ y/ ^/ (/ 狓/ )/ =/ w0/ +/ ∑/ 其中/ w0/ 是/ 全局/ 偏移/ ,/ {/ w1/ ,/ …/ ,/ wp/ }/ 是/ 属性/ 集合/ 狓/ =/ {/ x1/ ,/ …/ ,/ xp/ }/ 的/ 回归/ 因子/ ./ 而/ {/ v1/ ,/ 1/ ,/ …/ ,/ vp/ ,/ k/ }/ 表示/ 的/ 是/ 属性/ 间/ 的/ 点/ 对/ 交互/ 因子/ ,/ 它们/ 的/ 值/ 由/ 属性/ 间/ 的/ 交互/ xjxj/ 得到/ ./ 对于/ 一条/ 包含/ 了/ p/ 个/ 属性/ 的/ 记录/ ,/ 如果/ 所有/ 属性/ 都/ 进行/ 两/ 两/ 交互/ ,/ 则/ 所/ 需要/ 的/ 计算/ 量/ 是/ p/ (/ p/ -/ 1/ )/ // 2/ 次/ ./ 显然/ ,/ 并/ 不是/ 所有/ 属性/ 都/ 需要/ 交互/ ,/ 如果/ 能/ 从中/ 提取/ 有用/ 的/ 交互/ ,/ 则/ 可以/ 提高/ 算法/ 效率/ ./ 用户/ 和/ 物品/ 是/ 需要/ 首先/ 考虑/ 的/ 两个/ 因素/ ,/ 因为/ 许多/ 推荐/ 方法/ 主要/ 都/ 是/ 对/ 它们/ 建模/ ,/ 而/ 在/ 上下文/ 推荐/ 中/ ,/ 需要/ 更多地/ 考虑/ 用户/ 、/ 物品/ 和/ 上下文/ 信息/ 间/ 的/ 关联/ ./ 属性/ 是/ 没有/ 偏好/ 特征/ 的/ ,/ 而/ 用户/ 与/ 物品/ 是/ 有/ 针对性/ 的/ ,/ 某个/ 用户/ 可能/ 对/ 某个/ 物品/ 表现/ 出/ 独特/ 的/ 感情/ 色彩/ ;/ 反过来/ ,/ 某个/ 物品/ 可能/ 对/ 某个/ 用户/ 有/ 特殊/ 的/ 作用/ ./ 这/ 启发/ 我们/ 可以/ 利用/ 它们/ 的/ 这种/ 针对性/ ,/ 作用/ 于/ 属性/ 上/ ,/ 也就是说/ ,/ 除了/ 传统/ 的/ 用户/ 和/ 物品/ 交互/ ,/ 可以/ 让/ 用户/ 和/ 属性/ 交互/ ,/ 让/ 物品/ 和/ 属性/ 交互/ ,/ 使/ 属性/ 对/ 不同/ 的/ 用户/ 或/ 物品/ 表现/ 出/ 不同/ 的/ 倾向性/ ,/ 这/ 就是/ Page4/ 属性/ 提升/ 的/ 主要/ 思想/ ./ 除了/ 用户/ 和/ 物品/ ,/ 属性/ 的/ 类型/ 也/ 是/ 很/ 重要/ 的/ 一个/ 方面/ ,/ 比如/ “/ 1/ 月/ ”/ 的/ 类型/ 是/ “/ 月份/ ”/ ,/ “/ 汤姆/ ·/ 克鲁斯/ ”/ 的/ 类型/ 是/ “/ 演员/ ”/ 等/ ./ 如果/ 要/ 在/ 类型/ 方面/ 对/ 属性/ 进行/ 提升/ ,/ 可以/ 通过/ 模型/ 训练/ ,/ 把/ 属性/ 的/ 固有/ 本质/ (/ 比如/ 时间/ 特性/ 、/ 位置/ 特征/ 等/ )/ 提取/ 出来/ ./ 因为/ 不同/ 类型/ 的/ 属性/ 对/ 用户/ 和/ 物品/ 的/ 影响力/ 是/ 不同/ 的/ ,/ 即/ 通过/ 属性/ 类型/ 提升/ ,/ 可以/ 更好/ 地/ 挖掘/ 属性/ 的/ 潜在/ 含义/ ,/ 下面/ 我们/ 给出/ 属性/ 提升/ 的/ 一般/ 定义/ ./ 定义/ 1/ (/ 属性/ 提升/ )/ ./ 指/ 通过/ 用户/ 、/ 物品/ 和/ 属性/ 类型/ 3/ 个/ 层面/ 对/ 属性/ 进行/ 精确/ 建模/ ,/ 来/ 提升/ 推荐/ 评分/ 预测/ 的/ 效果/ ./ 例如/ ,/ 考虑/ 标签/ 作为/ 电影/ 的/ 一种/ 属性/ ,/ 已知/ 电影/ A/ 《/ 拯救/ 大兵/ 瑞恩/ 》/ 的/ 标签/ 为/ :/ 动作/ 、/ 剧情/ 、/ 战争/ 、/ 历史/ ;/ 电影/ B/ 《/ 达/ ·/ 芬奇/ 密码/ 》/ 的/ 标签/ 是/ :/ 惊悚/ 、/ 悬疑/ 、/ 动作/ ;/ 而/ 电影/ C/ 《/ 幸福/ 终点站/ 》/ 的/ 标签/ 是/ 爱情/ ./ 我们/ 又/ 知道/ 用户/ U/ 对/ 电影/ A/ 和/ B/ 打出/ 了/ 很/ 高/ 的/ 分数/ ,/ 要/ 预测/ 其/ 对/ 电影/ C/ 的/ 评分/ ./ 普通/ 的/ 协同/ 过滤/ 算法/ 可能/ 会/ 挖掘出/ 用户/ U/ 喜欢/ 动作片/ 的/ 隐含/ 特征/ ,/ 而/ 难以预测/ 他/ 对/ 爱情片/ 的/ 态度/ ./ 基于/ 属性/ 建模/ 的/ 方法/ 会/ 充分利用/ 属性/ 来/ 提高/ 预测/ 精度/ ,/ 比如/ 这/ 3/ 部/ 电影/ 的/ 主演/ 都/ 是/ 汤姆/ ·/ 汉克斯/ ./ 然而/ 这/ 类/ 方法/ 对/ 属性/ 的/ 利用/ 方式/ 有的是/ 线性/ 回归/ ,/ 有的是/ 两/ 两/ 交互/ (/ 比如/ FM/ )/ ,/ 并/ 没有/ 从/ 某个/ 角度/ 对/ 属性/ 进行/ 针对性/ 的/ 建模/ ./ 例如/ 从/ 用户/ U/ 的/ 角度/ 来说/ ,/ 他/ 有/ 可能/ 是/ 喜欢/ 汤姆/ ·/ 汉克斯/ 从而/ 对/ 电影/ A/ 和/ 电影/ B/ 有/ 较/ 高/ 的/ 评价/ ,/ 即/ 他/ 不/ 一定/ 喜欢/ 动作片/ ./ 这/ 说明/ 从/ 用户/ 角度/ 来/ 对/ 属性/ 建模/ 能/ 更好/ 地/ 反映/ 他/ 的/ 喜好/ ;/ 同理/ ,/ 从/ 物品/ 角度/ 和/ 属性/ 类型/ 角度/ 来/ 深层次/ 地/ 刻画/ 属性/ 也/ 能/ 取得/ 更好/ 的/ 效果/ ./ 另一方面/ ,/ 如果/ 数据/ 集中/ 没有/ 用户/ U/ 对/ 爱情片/ 的/ 评分/ 记录/ ,/ 则/ 普通/ 的/ 属性/ 交互/ 会/ 失效/ ./ 更/ 抽象地/ ,/ 将/ 标签/ “/ 爱情片/ ”/ 表示/ 为/ xj/ ,/ 观察/ 式/ (/ 1/ )/ ,/ 当/ xj/ 缺失/ 时/ ,/ xj/ 和/ xjxj/ 无法/ 发挥/ 其/ 作用/ ,/ 即/ 它们/ 对应/ 的/ 因子/ wj/ 和/ vj/ ,/ fvj/ ,/ f/ 无法/ 学到/ 相应/ 的/ 特征/ ,/ 这/ 对于/ 稀疏/ 性较/ 高/ 的/ 推荐/ 数据/ 集/ 来说/ 是/ 普遍存在/ 的/ 现象/ ./ 解决/ 的/ 方法/ 是/ 可以/ 通过/ 包含/ xj/ 的/ 记录/ 间接/ 地/ 学习/ ,/ 但是/ 我们/ 希望/ 对/ 当前/ 记录/ 做/ 提升/ ,/ 因为/ 这样/ 更能/ 反映/ 当前/ 用户/ 和/ 物品/ 的/ 关系/ ./ 采用/ 的/ 方式/ 是/ 把/ xj/ 表示/ 为泛/ 函/ 的/ 形式/ ,/ 如式/ (/ 2/ )/ 所示/ ,/ x/ ^/ j/ 是/ xj/ 经过/ 函数/ F/ 变化/ 后/ 的/ 新值/ ,/ Bj/ 称为/ xj/ 的/ 提升/ 项/ ./ F/ 和/ Bj/ 可以/ 根据/ 属性/ xj/ 的/ 不同/ 而/ 有/ 多种/ 可变/ 的/ 形式/ ./ 这样/ ,/ 属性/ 在/ 学习/ 的/ 过程/ 中/ 不再/ 是/ 静态/ 的/ ,/ 而是/ 动态/ 地/ 改变/ 以/ 适应/ 不同/ 的/ 用户/ 物品/ 组合/ ./ 而且/ ,/ 当/ xj/ 缺失/ 时/ ,/ x/ ^/ j/ 仍/ 可以/ 由/ Bj/ 通过/ F/ 来/ 模拟/ ,/ 这时/ 可以/ 把/ Bj/ 看成/ xj/ 的/ 潜在/ 特征/ ,/ 所以/ ,/ 在/ 属性/ 缺失/ 状态/ 下/ ,/ 模型/ 学到/ 的/ 是/ 属性/ 的/ 潜在/ 特征/ ./ 从/ 上述/ 讨论/ 可知/ ,/ 属性/ 的/ 提升/ 方法/ 要/ 比/ 单纯/ 用/ 属性/ 值来/ 训练/ 更/ 有/ 针对性/ ,/ 也/ 可以/ 实现/ 更/ 精细/ 的/ 建模/ ./ 在/ 模型/ 的/ 构建/ 过程/ 中/ ,/ 本文/ 从/ 概率/ 的/ 观点/ 出发/ ,/ 使用/ 概率/ 图/ 模型/ 来/ 描述/ 和/ 实现/ 算法/ ,/ 并/ 采用/ 局部/ 采样/ 的/ 方法/ 使得/ F/ 和/ Bj/ 中/ 的/ 参数/ 可以/ 根据/ 训练/ 集自/ 适应/ 的/ 调节/ ,/ 提高/ 算法/ 效率/ ./ 另外/ ,/ 通过/ 有/ 针对性/ 的/ 对/ 部分/ 模型/ 参数/ 进行/ 采样/ ,/ 既/ 利用/ 了/ 采样/ 方法/ 的/ 低/ 秩/ 模拟能力/ ,/ 又/ 避免/ 了/ 其/ 效率/ 过低/ 的/ 问题/ ./ 在/ 第/ 4/ 节/ 描述/ 模型/ 的/ 细节/ 时/ ,/ 将/ 对/ 采样/ 方法/ 作/ 详细/ 的/ 讨论/ ./ 4/ 模型/ 和/ 算法/ 流程/ 本节/ 先/ 介绍/ 基于/ 属性/ 提升/ 的/ 评分/ 预测/ 框架/ ,/ 然后/ 使用/ 概率/ 图/ 模型/ 给出/ 局部/ 采样/ 方法/ 的/ 细节/ ,/ 最后/ 描述/ 算法/ 的/ 具体/ 实现/ ./ 4.1/ 属性/ 提升/ 框架/ 从/ 第/ 3/ 节/ 的/ 讨论/ 可知/ ,/ 模型/ 主要/ 从/ 用户/ 、/ 物品/ 和/ 类型/ 3/ 个/ 方面/ 来/ 进行/ 属性/ 提升/ (/ AttributeBoosting/ )/ ./ 对/ 用户/ 来说/ ,/ 每个/ 用户/ 对/ 同样/ 的/ 属性/ 有着/ 不同/ 的/ 观点/ ,/ 因此/ ,/ 正确/ 的/ 属性/ 提升/ 应该/ 客观/ 地/ 反映/ 用户/ 的/ 偏好/ ,/ 并且/ 能够/ 区分/ 不同/ 用户/ 对/ 属性/ 的/ 影响/ 程度/ ./ 定义/ pu/ 为/ 用户/ u/ 的/ 偏好/ ,/ vj/ 为/ 用户/ u/ 对/ 属性/ xj/ 的/ 影响/ 程度/ ,/ 我们/ 把/ 属性/ xj/ 的/ 提升/ 项/ Bj/ 表示/ 为/ 狏/ T/ 泛函/ 形式/ 具体化/ 为/ x/ ^/ j/ =/ xj/ +/ Bj/ ,/ 则/ 可以/ 把/ xj/ 重/ 构成/ xj/ +/ 狏/ Tjpu/ 的/ 形式/ ./ 属性/ 提升/ 函数/ x/ ^/ j/ =/ xj/ +/ Bj/ 的/ 提升/ 项/ Bj/ 与/ 常用/ 经典/ 模型/ 中/ 的/ 偏移/ (/ bias/ )/ 项/ 类似/ ,/ 区别/ 在于/ 传统/ 模型/ 中/ 的/ 偏移/ 项是/ 单个/ 变量/ ,/ 只能/ 反映/ 单方面/ 的/ 特征/ ,/ 比如/ 物品/ 偏移/ 或/ 用户/ 偏移/ ./ 而/ 这里/ 的/ 提升/ 项是/ 两个/ 向量/ 的/ 内积/ ,/ 即/ 把/ 用户/ 偏好/ 和/ 属性/ 关联/ 起来/ ,/ 从而/ 能/ 表达/ 更/ 丰富/ 的/ 信息/ ./ 本文/ 的/ 3/ 个/ 属性/ 提升/ 层面/ 都/ 将/ 采用/ 这种/ 框架/ 来/ 表示/ ,/ 下面/ 从/ 用户/ 提升/ 角度/ 举例/ 分析/ 提升/ 项/ 的/ 作用/ ./ 结合/ 第/ 3/ 节/ 定义/ 1/ 下方/ 的/ 例子/ ,/ 如果/ xj/ 表示/ 的/ 是/ “/ 动作片/ ”/ ,/ 那么/ 狏/ T/ 的/ 隐含/ 态度/ (/ 例如/ 喜欢/ 汤姆/ ·/ 汉克斯/ 演/ 的/ 电影/ )/ ./ 这样/ ,/ 固定/ 的/ 属性/ 值/ 通过/ 提升/ 项/ 被/ 动态/ 地/ 调整/ ,/ 达到/ 个性化/ 推荐/ 的/ 目的/ ./ 假设/ xj/ 表示/ 的/ 是/ “/ 爱情片/ ”/ ,/ 而且/ 数据/ 集中/ 没有/ 用户/ u/ 对/ 爱情片/ 的/ 评分/ 记录/ ,/ 我们/ 仍/ Page5/ 然/ 可以/ 用/ 狏/ T/ 汤姆/ ·/ 汉克斯/ 的/ 电影/ ,/ 得到/ 他/ 也/ 喜欢/ 汤姆/ ·/ 汉克斯/ 演/ 的/ 爱情片/ 这一/ 结论/ ./ 这和式/ (/ 2/ )/ 的/ 初衷/ 是/ 一致/ 的/ ./ 属性/ 提升/ 之后/ ,/ 我们/ 需要/ 从/ 3/ 个/ 方面/ 与/ 属性/ 做/ 交互/ ,/ 下面/ 给出/ 交互/ 的/ 具体/ 定义/ ./ 定义/ 2/ (/ 交互/ )/ ./ 指用/ 因子/ 变量/ (/ 标量/ 或/ 向量/ )/ 表示/ 用户/ 、/ 物品/ 或/ 属性/ 类型/ 3/ 个/ 方面/ ,/ 并/ 分别/ 用/ 这/ 3/ 种/ 因子/ 与/ 提升/ 后/ 的/ 属性/ (/ 向量/ )/ 做/ 乘积/ 运算/ ;/ 如果/ 因子/ 是/ 标量/ ,/ 则/ 与/ 属性/ (/ 向量/ )/ 做/ 标量/ 与/ 向量/ 的/ 乘法/ 运算/ ;/ 如果/ 因子/ 是/ 向量/ ,/ 则/ 与/ 属性/ (/ 向量/ )/ 做/ 两个/ 向量/ 的/ 内积/ 运算/ ./ 从/ 用户/ 角度/ 来看/ ,/ 不同/ 用户/ 相对/ 于/ 属性/ 有着/ 不同/ 的/ 重要/ 程度/ ,/ 把/ 这种/ 重要性/ 定义/ 为/ 用户/ u/ 的/ 权重/ ,/ 用/ 标量/ β/ u/ 来/ 表示/ ,/ 将/ 因子/ β/ u/ 与/ 所有/ 上下文/ 属性/ 进行/ 交互/ ,/ 并/ 将/ 交互/ 的/ 结果/ 相加/ ,/ 可以/ 得到/ 用户/ 角度/ 的/ 属性/ 提升/ 函数/ :/ 式/ (/ 3/ )/ 表示/ 用户/ 角度/ 的/ 评分/ 预测/ 部分/ ,/ 用户/ u/ 提升/ 除了/ 自己/ 之外/ 的/ a/ 个/ 属性/ ./ t/ (/ u/ )/ 表示/ 用户/ 类型/ ,/ 实际上/ 在/ 一条/ 评分/ 记录/ 中/ ,/ 只有/ 用户/ 自己/ 属于/ 该/ 类型/ ,/ 而/ 与/ 自己/ 交互/ 是/ 没有/ 必要/ 的/ ./ 从/ 物品/ 角度/ 来看/ ,/ 物品/ i/ 相对/ 于/ 属性/ 来说/ 也/ 是/ 具有/ 可变/ 的/ 权重/ ,/ 用/ 标量/ γ/ i/ 表示/ ./ 而/ 除了/ 物品/ 本身/ 的/ 重要性/ ,/ 它/ 对/ 属性/ 的/ 影响力/ ej/ 也/ 必须/ 考虑/ ./ 用/ qi/ 表示/ 物品/ 与/ 属性/ 的/ 关联/ 程度/ ,/ 则/ 它们/ 共同/ 决定/ 了/ 属性/ 的/ 提升/ 项/ 犲/ T/ 品/ 因子/ γ/ i/ 与/ 属性/ 的/ 交互/ 给出/ :/ 同样/ 地/ ,/ 物品/ 并/ 不/ 与/ 自己/ 进行/ 交互/ ./ 可以/ 观察/ 到/ 用户/ 和/ 物品/ 对/ 属性/ 的/ 提升/ 具有/ 相似/ 的/ 形式/ ,/ 因为/ 它们/ 是/ 评分/ 记录/ 中/ 的/ 两个/ 实体/ ,/ 而且/ 这种/ 提升/ 是/ 非对称/ 的/ ,/ 即/ 用户/ 和/ 物品/ 只是/ 简单/ 地用/ 权重/ 来/ 控制/ ,/ 而/ 属性/ 却/ 有/ 一个/ 更/ 细致/ 的/ 提升/ 项/ ./ 原因/ 是/ 本/ 算法/ 更/ 强调/ 对/ 属性/ 的/ 提升/ 效果/ ,/ 希望/ 更/ 精确/ 地/ 对/ 属性/ 进行/ 建模/ ,/ 这/ 是/ 对/ FM/ 中/ 对称/ 的/ 属性/ 交互/ 形式/ 的/ 改进/ ./ 除了/ 用户/ 和/ 物品/ ,/ 属性/ 类型/ 作为/ 另/ 一种/ 有用/ 的/ 信息/ ,/ 直接/ 反映/ 了/ 属性/ 的/ 内在/ 特征/ ./ 因此/ ,/ 在/ 评分/ 预测/ 的/ 第三/ 部分/ ,/ 我们/ 将/ 动态/ 的/ 类型/ 因子/ α/ t/ (/ j/ )/ 嵌入/ 到/ 模型/ 中/ 进行/ 学习/ ,/ 表示/ 属性/ xj/ 所属/ 的/ 类型/ ./ 和/ 用户/ 物品/ 不同/ ,/ 类型/ 在/ 提升/ 属性/ 方面/ 表现/ 为/ 全局/ 的/ 作用/ ,/ 因此/ 不/ 使用/ 个性化/ 的/ 提升/ 项/ ,/ 而是/ 用/ 一个/ 偏移量/ wj/ 来/ 表示/ 提升/ 效果/ ./ 类型/ 提升/ 的/ 评分/ 预测/ 部分/ 如式/ (/ 5/ )/ 所示/ :/ 向量/ α/ T/ 单个/ 属性/ 间/ 的/ 交互/ ,/ 它们/ 是/ 相互作用/ 的/ ./ 3/ 个/ 方面/ 的/ 属性/ 提升/ 一起/ 构成/ 了/ 评分/ 预测/ 的/ 框架/ :/ y/ ^/ (/ 狓/ )/ =/ 这里/ Z/ 是/ 3/ 个/ 部分/ 加/ 起来/ 的/ 正规化/ 项/ ,/ 用来/ 限制/ 预测值/ 的/ 范围/ ./ 因为/ y/ ^/ user/ (/ 狓/ )/ 、/ y/ ^/ item/ (/ 狓/ )/ 和/ y/ ^/ type/ (/ 狓/ )/ 这/ 3/ 个/ 预测值/ 都/ 采用/ 了/ 属性/ 连加/ 的/ 结构/ ,/ 这样/ 得到/ 的/ 预测值/ 会/ 很大/ ,/ 而/ 真实/ 值/ 通常/ 只是/ 1/ 到/ 5/ 分/ ,/ 造成/ 梯度/ 很大/ 从而/ 加大/ 训练/ 的/ 难度/ ,/ 即/ 需要/ 很小/ 的/ 学习/ 速率/ 来/ 适应/ 很大/ 的/ 梯度/ ./ 经过/ 规范化/ 后/ ,/ y/ ^/ (/ 狓/ )/ 变小/ 了/ ,/ 从而/ 对/ 学习/ 速率/ 不会/ 太/ 敏感/ ./ 在/ 实际/ 的/ 数据/ 集中/ ,/ 某条/ 用户/ 评分/ 记录/ 一般/ 不会/ 拥有/ 所有/ 属性/ (/ 稀疏/ 性/ )/ ,/ 如果/ 直接/ 将/ Z/ 设为/ a/ ,/ 会/ 导致/ y/ ^/ (/ 狓/ )/ 过/ 小/ ;/ 通过/ 实验/ 观察/ 与/ 统计/ 预测值/ ,/ 我们/ 将/ Z/ 取值/ 为/ 槡/ a/ ,/ 其中/ a/ 为/ 属性/ 个数/ ,/ 这样/ 能/ 使/ 总体/ 的/ 规范化/ 效果/ 最好/ ./ 4.2/ 小节/ 将/ 用/ 概率/ 局部/ 采样/ 、/ 随机/ 梯度/ 下降/ 和/ 交替/ 最小/ 二/ 乘法/ 相结合/ 的/ 方式/ 来/ 训练/ ABPS/ 模型/ ./ 4.2/ 局部/ 采样/ 方法/ 概率/ 图/ 模型/ 和/ 因子/ 分解/ 模型/ 相结合/ 之后/ ,/ 充分发挥/ 其/ 参数/ 自/ 适应/ 学习/ 与/ 低/ 秩/ 近似/ 的/ 优势/ ,/ 并/ 保留/ 了/ 因子/ 分解/ 的/ 优点/ ,/ 因此/ 得到/ 了/ 广泛/ 的/ 应用/ ./ 以/ BPMF/ [/ 10/ ]/ 为例/ ,/ 该类/ 方法/ 首先/ 假设/ 用户/ 对/ 物品/ 的/ 评分/ 服从/ 高斯/ (/ Gaussian/ )/ 独立/ 同/ 分布/ :/ p/ (/ R/ |/ U/ ,/ V/ ,/ α/ )/ =/ ∏/ 其中/ 用户数量/ 是/ N/ ,/ 物品/ 数量/ 为/ M/ ,/ Rij/ 表示/ 第/ i/ 个/ 用户/ Ui/ 对/ 第/ j/ 个/ 物品/ Vj/ 的/ 评分/ ,/ Iij/ 为/ 指示器/ 函数/ ,/ 如果/ Rij/ 存在/ ,/ 则/ Iij/ 值为/ 1/ ;/ 否则/ 为/ 0/ ./ 每个/ 分数/ 服从/ 均值/ 为/ 犝/ T/ 品/ 特征向量/ 的/ 先验概率/ 设/ 为/ 其中/ μ/ U/ ,/ Λ/ U/ 和/ μ/ V/ ,/ Λ/ V/ 为/ 超/ 参数/ ,/ 方差/ 矩阵/ Λ/ -/ 1V/ 服从/ 自由度/ 为/ υ/ 0/ 、/ 共/ 变异/ 矩阵/ 为/ 犠/ 0/ (/ D/ ×/ D/ 维/ )/ Λ/ -/ 1/ 的/ Wishart/ 分布/ :/ (/ Λ/ |/ 犠/ 0/ ,/ υ/ 0/ )/ =/ / p/ (/ μ/ U/ ,/ Λ/ U/ )/ 和/ p/ (/ μ/ V/ ,/ Λ/ V/ )/ 则/ 服从/ Gaussian/ -/ Wishart/ 分布/ ,/ 因此/ 在/ 已知/ 用户/ 或/ 物品/ 特征/ 的/ 情况/ 下/ ,/ 超/ 参数/ Page6/ 能/ 进行/ 自/ 适应/ 更新/ ./ 已知/ 似然/ (/ 式/ (/ 7/ )/ )/ 和/ 先验概率/ (/ 式/ (/ 8/ )/ 和/ (/ 9/ )/ )/ ,/ 通过/ 极大/ 化/ 对数/ 后验/ 概率/ (/ 等价/ 于/ 极小/ 化/ 平方/ 误差/ [/ 9/ ]/ )/ ,/ 可以/ 得到/ 用户/ 和/ 物品/ 最终/ 的/ 特征/ ./ 由/ 贝叶斯/ 推断/ ,/ 后验/ 概率/ 的/ 分布/ 可/ 由/ 先验概率/ 乘以/ 似然/ 概率/ 得到/ ,/ 因此/ 后验/ 概率/ 是/ 另/ 一个/ 高斯分布/ ,/ 以/ 用户/ 特征/ Ui/ 为例/ :/ p/ (/ Ui/ |/ R/ ,/ V/ ,/ μ/ U/ ,/ Λ/ U/ ,/ α/ )/ =/ / M/ ∏/ j/ =/ 1/ 如果/ 直接/ 推导/ 并/ 计算/ 出后验/ 概率/ 是/ 相当/ 复杂/ 的/ ,/ 根据/ MCMC/ 原理/ ,/ 可以/ 由/ 吉布斯/ 采样/ (/ GibbsSampling/ )/ 得到/ 其/ 均值/ μ/ 似地/ 模拟/ 后验/ 概率/ ,/ 最终/ 实现/ 评分/ 预测/ ./ 该/ 方法/ 在/ 超/ 参数/ 需要/ 人工/ 调节/ 时/ 优势/ 明显/ ,/ 因为/ 超/ 参数/ 可以/ 通过/ 采样/ 从/ 训练/ 集中/ 得到/ ;/ 而且/ ,/ 通过/ 近似/ 模拟/ ,/ 可以/ 用/ 比/ 其他/ 模型/ 更少/ 的/ 维度/ 来/ 表示/ 特征向量/ ./ 但是/ 当/ 模型/ 中/ 的/ 因子/ 数量/ (/ 特征向量/ 的/ 个数/ )/ 过多时/ ,/ 采样/ 会/ 变得/ 效率/ 低下/ ,/ 因为/ 吉布斯/ 采样/ 对/ 某个/ 因子/ 的/ 采样/ 过程/ 就是/ 固定/ 其他/ 因子/ 计算/ 条件/ 概率/ ./ 所有/ 因子/ 必须/ 被/ 采样/ 一次/ 才能/ 完成/ 训练/ ,/ 这/ 相对/ 于/ 随机/ 梯度/ 下降/ (/ SGD/ )/ 和/ 交替/ 最小/ 二/ 乘法/ (/ ALS/ )/ 来说/ 是/ 低效/ 的/ ./ 结合/ 属性/ 提升/ 模型/ 的/ 实际/ 情况/ ,/ 我们/ 发现/ 用户/ 对/ 属性/ 的/ 偏好/ pu/ 、/ 物品/ 与/ 属性/ 的/ 关联/ 程度/ qi/ 和/ 属性/ 类型/ α/ t/ (/ j/ )/ 的/ 数量/ 是/ 相对/ 固定/ 的/ ./ 而且/ 这/ 3/ 个/ 因子/ 的/ 数量/ 远/ 少于/ 属性/ 影响力/ vj/ 、/ ej/ 和/ 类型/ 偏移/ wj/ ,/ 因为/ 数据/ 集中/ 用户/ 和/ 物品/ 的/ 数量/ 是/ 相对/ 固定/ 的/ ,/ 而/ 属性/ 类型/ 在/ 一/ 开始/ 就是/ 确定/ 的/ ,/ 如果/ 增加/ 属性/ ,/ 类型/ 也/ 只会/ 缓慢/ 增长/ ./ 例如/ 原有/ 的/ “/ 时间/ ”/ 类型/ 包含/ “/ 年/ ”/ 和/ “/ 月/ ”/ 2/ 个/ 属性/ ,/ 如果/ 增加/ “/ 小时/ ”/ 和/ “/ 分钟/ ”/ 2/ 个/ 属性/ ,/ “/ 时间/ ”/ 这一/ 类型/ 也/ 不会/ 改变/ ;/ 又/ 如/ 在/ 记录/ 中/ 加入/ 100/ 名演员/ 进行/ 训练/ ,/ 则/ 多/ 了/ 100/ 个/ 属性/ ,/ 而/ 属性/ 类型/ 只是/ 多/ 了/ 1/ 个/ “/ 演员/ ”/ ./ 在/ 上下文/ 属性/ 较/ 多/ 的/ 情况/ 下/ ,/ pu/ 、/ qi/ 和/ α/ t/ (/ j/ )/ 的/ 数量/ 相对/ 固定/ 这种/ 现象/ 更加/ 明显/ ./ 所以/ 本文/ 设计/ 了/ 局部/ 采样/ (/ PartialSampling/ )/ 学习/ 法/ ,/ 只/ 对/ pu/ 、/ qi/ 和/ α/ t/ (/ j/ )/ 进行/ 采样/ ,/ 而/ 对/ 其他/ 因子/ 使用/ SGD/ 和/ ALS/ 来/ 训练/ ./ 这/ 3/ 个/ 因子/ 刚好/ 是/ 与/ 属性/ 交互/ 的/ 3/ 个/ 方面/ ,/ 通过/ 采样/ 可以/ 用/ 更/ 少/ 的/ 特征/ 维度/ (/ 即/ 低/ 秩/ )/ 来/ 表示/ 三/ 方面/ 的/ 特征/ ./ 其他/ 因子/ 除了/ 用户/ 权重/ β/ u/ 和/ 物品/ 权重/ γ/ i/ 外/ ,/ 都/ 是/ 对/ 属性/ 特征/ 的/ 描述/ ,/ 而/ β/ u/ 和/ γ/ i/ 不/ 需要/ 特征向量/ 来/ 表示/ ,/ 即/ 不/ 需要/ 低/ 秩/ 近似/ ./ 所以/ ,/ 可以/ 对/ 剩下/ 的/ 因子/ 使用/ SGD/ 和/ ALS/ 进行/ 更新/ 来/ 提高/ 训练/ 速率/ ,/ 与/ 采样/ 配合/ 能/ 平衡/ 算法/ 的/ 性能/ 和/ 效率/ ./ 模型/ 的/ 学习/ 过程/ 如图/ 1/ 所示/ ./ 设/ 采样/ 时/ 记录/ 评分/ 的/ 方差/ 为/ λ/ -/ 1/ ,/ 则/ 图/ 中/ 3/ 个/ 矩阵/ Λ/ p/ 、/ Λ/ q/ 和/ Λ/ α/ 由/ Wishart/ 分布/ 的/ 参数/ υ/ 0/ 和/ 犠/ 0/ 配合/ 采样/ 得到/ ./ 均值/ μ/ p/ 、/ μ/ q/ 和/ μ/ α/ 由/ 初始值/ μ/ 0/ 结合/ 采样/ 后/ 的/ 方差/ 矩阵/ 得来/ ./ 完成/ pu/ 、/ qi/ 和/ α/ t/ (/ j/ )/ 的/ 采样/ 后/ ,/ 可以/ 通过/ SGD/ 来/ 学习/ vj/ 、/ ej/ 和/ wj/ ,/ 然而/ ,/ β/ u/ 和/ γ/ i/ 的/ 梯度/ 计算/ 相对/ 其他/ 因子/ 来说/ 更/ 耗时/ ,/ 所以/ 在/ 训练/ 时/ 使用/ ALS/ ,/ 即/ 固定/ 其他/ 变量/ 对/ β/ u/ 和/ γ/ i/ 进行/ 快速/ 更新/ ./ 所有/ 参数/ 训练/ 完后/ ,/ 第/ k/ 条/ 记录/ 的/ 评分/ 预测值/ y/ ^/ (/ k/ )/ 由/ 属性/ x/ (/ k/ )/ 4.3/ 算法/ 细节/ 和/ 流程/ j/ 代入/ 3/ 个/ 评分/ 预测/ 函数/ 由式/ (/ 6/ )/ 获得/ ./ 第/ 1/ 、/ 2/ 节/ 介绍/ 了/ ABPS/ 模型/ 的/ 主要/ 思想/ ,/ 本/ 节/ 说明/ 算法/ 的/ 细节/ ./ 为/ 统一/ 讨论/ ,/ 将/ 超/ 参数/ 集合/ {/ Η/ }/ =/ {/ μ/ p/ ,/ Λ/ p/ ,/ μ/ q/ ,/ Λ/ q/ ,/ μ/ α/ ,/ Λ/ α/ }/ 的/ 初始值/ 表示/ 为/ Η/ 0/ =/ {/ λ/ ,/ μ/ 0/ ,/ υ/ 0/ ,/ 犠/ 0/ }/ ,/ 而/ 模型/ 参数/ 集合/ 记/ 为/ {/ Θ/ }/ ,/ 即/ pu/ =/ {/ p1/ ,/ p2/ ,/ …/ ,/ pj/ ,/ …/ }/ ,/ qi/ =/ {/ q1/ ,/ q2/ ,/ …/ ,/ qj/ ,/ …/ }/ 等/ 均/ 用/ Θ/ =/ {/ θ/ 1/ ,/ θ/ 2/ ,/ …/ ,/ θ/ j/ ,/ …/ }/ 表示/ ./ 由/ 前面/ 的/ 假设/ 可知/ ,/ θ/ j/ 的/ 先验概率/ 服从/ 高斯分布/ :/ 设/ 狔/ =/ {/ y/ 集合/ ,/ y/ (/ k/ )/ 对应/ 的/ 评分/ 预测/ 函数/ (/ 式/ (/ 6/ )/ )/ ,/ 其中/ 狓/ (/ k/ )/ 为/ 第/ ky/ 条/ 记录/ 的/ 属性/ 集合/ ./ 则/ n/ 条/ 记录/ 的/ 评分/ 预测/ 概率/ 为/ n/ 个/ 独立/ 的/ 高斯分布/ :/ p/ (/ 狔/ |/ {/ Θ/ }/ ,/ λ/ -/ 1/ )/ =/ ∏/ Page7/ 给定/ 参数/ 集合/ {/ Θ/ }/ 和/ 方差/ λ/ -/ 1/ ,/ 其/ 均值/ 为/ 预测/ 函数/ y/ ^/ (/ 狓/ (/ k/ )/ )/ ./ 则/ 式/ (/ 13/ )/ 为/ 参数/ 集合/ {/ Θ/ }/ 的/ 似然/ 分布/ ,/ 结合/ 式/ (/ 12/ )/ ,/ θ/ j/ 的/ 后验/ 概率/ 可/ 表示/ 为/ p/ (/ θ/ j/ |/ 狔/ ,/ {/ Θ/ }/ \/ θ/ j/ ,/ λ/ -/ 1/ )/ =/ / / 其中/ {/ Θ/ }/ \/ θ/ j/ 表示/ 除/ θ/ j/ 以外/ 的/ 其他/ 参数/ 集合/ ,/ 求解/ μ/ 的/ 关键/ 是/ 对/ y/ ^/ (/ 狓/ (/ k/ )/ )/ 与/ θ/ j/ 的/ 关系/ 作/ 分析/ ,/ 由/ 和/ Λ/ / θ/ j/ 式/ (/ 3/ )/ ~/ (/ 6/ )/ 可知/ ,/ 对/ 任意/ θ/ j/ ,/ y/ ^/ (/ 狓/ (/ k/ )/ )/ 都/ 可以/ 表示/ 成/ 以下/ 两种/ 形式/ :/ 其中/ / y/ ^/ (/ 狓/ (/ k/ )/ )/ 无关/ 的/ 项/ ,/ 即/ y/ ^/ (/ 狓/ (/ k/ )/ )/ 是/ θ/ j/ 的/ 线性/ 函数/ ,/ 结合/ 高斯/ 边缘/ 分布/ 和/ 条件/ 分布/ 的/ 关系/ [/ 15/ ]/ ,/ 可/ 得/ θ/ j/ =/ Λ/ θ/ j/ +/ λ/ ·/ ∑/ Λ/ / θ/ j/ =/ [/ Λ/ / / μ/ θ/ j/ 在/ 实现/ 时/ ,/ 可以/ 由式/ (/ 16/ )/ 和/ (/ 17/ )/ 计算/ 出/ μ/ p/ ,/ Λ/ / α/ ,/ Λ/ / / μ/ 斯/ 采样/ 求得/ ,/ 即/ θ/ j/ 的/ 特征向量/ 可/ 由/ μ/ 到/ ./ 完成/ 采样/ 之后/ 算法/ 使用/ SGD/ 和/ ALS/ 对/ 其他/ 参数/ 做/ 快速/ 更新/ ./ 在/ 进入/ 下次/ 迭代/ 前/ ,/ 需要/ 使用/ 新/ 的/ {/ Θ/ }/ 值/ 并/ 配合/ 预设值/ Η/ 0/ ,/ 通过/ Gaussian/ -/ Wishart/ 分布/ 自/ 适应/ 地/ 更新/ 超/ 参数/ 集合/ {/ H/ }/ ,/ 然后/ 进入/ 下/ 一轮/ 的/ 迭代/ ,/ 流程/ 如/ 算法/ 1/ 所示/ ./ 算法/ 1/ ./ 基于/ 局部/ 采样/ 的/ 属性/ 提升/ 评分/ 预测/ 算法/ ./ 输入/ :/ 初始值/ H0/ ,/ 超/ 参数/ {/ Η/ }/ ,/ 模型/ 参数/ {/ Θ/ }/ 输出/ :/ 狔/ 的/ 预测值/ y/ ^/ (/ 狓/ )/ 1/ ./ 统计/ 犡/ 得到/ 用户/ 个数/ N/ ,/ 物品/ 个数/ M/ ,/ 类型/ 个数/ L2/ ./ 初始化/ 模型/ 参数/ 集合/ {/ Θ/ }/ 3/ ./ FORt/ =/ 1TOT4/ ./ 自/ 适应/ 更新/ 超/ 参数/ {/ H/ }/ =/ {/ μ/ p/ ,/ Λ/ p/ ,/ μ/ q/ ,/ Λ/ q/ ,/ μ/ α/ ,/ Λ/ α/ }/ 5/ ./ FORu/ =/ 1TON6/ ./ 对/ μ/ 7/ ./ ENDFOR8/ ./ FORi/ =/ 1TOM9/ ./ 对/ μ/ 10/ ./ ENDFOR11/ ./ FORl/ =/ 1TOL12/ ./ 对/ μ/ 13/ ./ ENDFOR14/ ./ FOR/ 狓/ (/ k/ )/ IN/ 犡/ 15/ ./ su/ =/ ∑/ 16/ ./ si/ =/ ∑/ 17/ ./ y/ ^/ user/ (/ 狓/ (/ k/ )/ )/ =/ β/ u/ ·/ su/ // // 用户/ 提升/ 18/ ./ y/ ^/ item/ (/ 狓/ (/ k/ )/ )/ =/ γ/ i/ ·/ si/ // // 物品/ 提升/ 19/ ./ y/ ^/ type/ (/ 狓/ (/ k/ )/ )/ =/ ∑/ 20/ ./ y/ ^/ (/ 狓/ (/ k/ )/ )/ =/ 21/ ./ 用/ su/ 和/ si/ 对/ β/ u/ 和/ γ/ i/ 做/ ALS/ 更新/ 22/ ./ 对/ v/ ,/ e/ 和/ w/ 进行/ SGD/ 更新/ 23/ ./ ENDFOR24/ ./ ENDFOR/ 该/ 算法/ 在/ 完成/ 对/ pu/ ,/ qi/ 和/ α/ l/ 的/ 采样/ 后/ ,/ 开始/ 进行/ 评分/ 预测/ ,/ 用于/ 更新/ 其他/ 参数/ ./ 在/ 预测/ 的/ 过程/ 中/ ,/ 存储/ 临时/ 变量/ su/ 和/ si/ 来/ 对/ β/ u/ 和/ γ/ i/ 做/ 快速/ ALS/ 更新/ ,/ 因为/ su/ 和/ si/ 是/ β/ u/ 和/ γ/ i/ 的/ 梯度/ ,/ 而且/ 在/ 更新/ 时/ ,/ 其他/ 参数/ 是/ 固定/ 的/ ./ 5/ 实验/ 和/ 结果/ 5.1/ 数据/ 集/ 和/ 评价/ 标准/ 实验/ 使用/ 4/ 个/ 数据/ 集来/ 检验/ ABPS/ 模型/ ,/ 其中/ 3/ 个/ 来自/ GroupLensResearch/ 的/ 著名/ 推荐/ 评分/ 数据/ 集/ MovieLens/ (/ ML/ )/ ①/ ,/ 另/ 一个/ 是/ Yahoo/ !/ Research/ 发布/ 的/ 用于/ 上下文/ 推荐/ 研究/ 的/ 电影/ 数据/ 集/ ②/ ./ 4/ 个/ 数据/ 集/ 的/ 统计/ 信息/ 如表/ 1/ 所示/ ./ 表/ 1/ 表/ MovieLens/ 与/ Yahoo/ !/ 数据/ 集/ 的/ 统计/ 信息/ 数据/ 集/ ML/ -/ 1mML/ -/ latestYahoo/ !/ ML/ -/ 10m4/ 个/ 数据/ 集中/ 的/ 上下文/ 信息/ 表现/ 为/ 用户/ 属性/ 和/ 物品/ 属性/ ,/ 这些/ 属性/ 被/ 分为/ 不同/ 的/ 类别/ ./ 例如/ ,/ Yahoo/ !/ 数据/ 集中/ 的/ 用户/ 属性/ 包括/ “/ 编号/ ”/ 、/ “/ 出生/ 年/ ”/ 和/ “/ 性别/ ”/ 3/ 类/ ,/ 而/ 电影/ 的/ 属性/ 则/ 比/ 用户/ 更/ 多/ ./ 在/ ML/ -/ 1m/ 数据/ 集中/ ,/ 用户/ 有着/ 5/ 种/ 属性/ ,/ 但是/ 物品/ 却/ ①/ ②/ Page8/ 只有/ “/ 编号/ ”/ 和/ “/ 类别/ ”/ 两种/ 属性/ ./ 与/ 前面/ 两个/ 数据/ 集/ 不同/ ,/ ML/ -/ latest/ 数据/ 集中/ 用户/ 和/ 物品/ 的/ 属性/ 都/ 较/ 少/ ,/ 但是/ 它/ 有/ 用户/ 标注/ (/ 打/ 标签/ )/ 信息/ 作为/ 补偿/ ./ 最后/ 一个/ 数据/ 集/ ML/ -/ 10m/ 拥有/ 10000054/ 条/ 评分/ 记录/ ,/ 包含/ 71567/ 个/ 用户/ 和/ 10681/ 部/ 电影/ 上/ 的/ 95580/ 个/ 标签/ ,/ 非常/ 接近/ 实际/ 应用/ 的/ 大/ 数据量/ ,/ 所以/ 我们/ 使用/ 它/ 来/ 考察/ 模型/ 的/ 实际/ 性能/ ./ 在/ 4/ 个/ 数据/ 集中/ ,/ 上下文/ 信息/ 的/ 多样化/ 有助于/ 在/ 实验/ 时/ 进行/ 比较/ ,/ 实验/ 使用/ 的/ 主要/ 评价/ 标准/ 是/ 在/ 推荐/ 评分/ 预测/ 中/ 常用/ 的/ RMSE/ (/ RootMeanSquareError/ )/ 和/ MAE/ (/ MeanAbsoluteError/ )/ ./ 实验/ 过程/ 首先/ 研究/ 属性/ 提升/ 的/ 影响/ 和/ 局部/ 采样/ 的/ 效果/ ;/ 然后/ 进行/ 不同/ 方法/ 间/ 的/ 比较/ ;/ 最后/ 考察/ 算法/ 的/ 实际/ 表现/ ./ 我们/ 还/ 加入/ 召回/ 率/ Recall/ 来/ 测评/ 模型/ 的/ Top/ -/ N/ 推荐/ 性能/ ,/ 这/ 是/ 对/ 评分/ 预测/ 功能/ 的/ 扩展/ ,/ 3/ 种/ 评价/ 指标/ 的/ 计算/ 方式/ 由式/ (/ 18/ )/ ~/ (/ 20/ )/ 给出/ ./ 其中/ T/ 是/ 测试/ 集/ ,/ T/ 是/ 测试/ 集/ 的/ 记录/ 数/ ,/ i/ 表示/ 测试/ 集/ 的/ 第/ i/ 条/ 记录/ ,/ yi/ 是/ 其/ 真实/ 值/ ,/ y/ ^/ i/ 是/ 模型/ 对/ 该/ 记录/ 的/ 预测值/ ./ 在/ 召回/ 率中/ ,/ hit/ (/ i/ )/ 表示/ 是否/ 命中/ 第/ i/ 条/ 记录/ ,/ 如果/ 命中/ ,/ 则/ hit/ (/ i/ )/ =/ 1/ ;/ 否则/ hit/ (/ i/ )/ =/ 0/ ./ 图/ 2/ 属性/ 数量/ 与/ 属性/ 提升/ 的/ 关系/ 5.2/ 属性/ 提升/ 的/ 影响/ 第/ 3/ 节/ 讨论/ 了/ 属性/ 提升/ 的/ 目的/ ,/ 主要/ 是/ 要/ 让/ 属性/ 对/ 不同/ 的/ 用户/ 、/ 物品/ 或/ 类型/ 表现/ 出/ 不同/ 的/ 倾向性/ ,/ 以便/ 更好/ 地/ 预测/ 评分/ ./ 在实践中/ ,/ 越多/ 的/ 属性/ 并不一定/ 能/ 取得/ 越好/ 的/ 效果/ ,/ 因为/ 有些/ 对/ A/ 用户/ 来说/ 可/ 称为/ “/ 好/ ”/ 的/ 属性/ ,/ 对/ B/ 用户/ 来说/ 却/ 可能/ 是/ “/ 坏/ ”/ 属性/ ,/ 增加/ 某个/ “/ 坏/ ”/ 的/ 属性/ 可能/ 会/ 对/ 评分/ 预测/ 产生/ 负面/ 效果/ ./ 而/ ABPS/ 模型/ 因为/ 有/ 了/ 属性/ 提升/ 项/ ,/ 可以/ 充分/ 地/ 描述/ 用户/ 或/ 物品/ 的/ 个性化/ 倾向/ ,/ 当/ 增加/ 属性/ 时/ ,/ 便/ 能/ 使/ 属性/ 更好/ 地/ 发挥/ 其/ 潜在/ 作用/ ./ 本文/ 选取/ 表/ 2/ 中/ 的/ 属性/ 集合/ 来/ 调查/ 属性/ 提升/ 的/ 影响/ ./ 在/ 上下文/ 推荐/ 中/ ,/ 用户/ 编号/ 和/ 物品/ 编号/ 也/ 被/ 当成/ 属性/ ,/ 所以/ 至少/ 必须/ 取/ 这/ 两个/ 属性/ 进行/ 训练/ ./ 与/ 基本/ 的/ CF/ 算法/ 一样/ ,/ 首先/ 只取/ 用户/ 编号/ 和/ 物品/ 编号/ 进行/ 评分/ 预测/ ,/ 然后/ 逐渐/ 增加/ 属性/ 数量/ 直到/ 表/ 2/ 中/ 的/ 属性/ 全部/ 被/ 使用/ ,/ 来/ 观察/ 预测/ 的/ 效果/ ./ 实验/ 采用/ 5/ 折/ 交叉/ 验证/ ,/ 将/ ABPS/ 的/ 特征/ 维度/ 设为/ 20/ ,/ 并/ 使用/ 随机/ 梯度/ 下降/ (/ SGD/ )/ 进行/ 训练/ ./ 图/ 2/ 显示/ 了/ 在/ 3/ 个/ 数据/ 集上/ ,/ 算法/ 运行/ 30/ 次/ 迭代/ 得到/ 的/ 实验/ 结果/ ./ 数据/ 集/ ML/ -/ 1mML/ -/ latest/ {/ 用户/ 编号/ ,/ 评分/ 时间/ }/ Yahoo/ !/ Page9/ 从图/ 2/ 中/ 可以/ 看出/ ,/ 通过/ 不断/ 增加/ 属性/ 的/ 数量/ 可以/ 发现/ 属性/ 提升/ 有/ 提高/ 性能/ 的/ 效果/ ./ 在/ 只有/ 用户/ 编号/ 和/ 物品/ 编号/ (/ 即/ 属性/ 数量/ 为/ 2/ )/ 的/ 情况/ 下/ ,/ 上下文/ 推荐/ 退化/ 为/ 协同/ 过滤/ ,/ 即/ 所有/ 除/ 用户/ 和/ 物品/ 外/ 的/ 属性/ 都/ 缺失/ 了/ ./ 但是/ ,/ ABPS/ 中/ 的/ 提升/ 项/ 仍然/ 描绘/ 了/ 用户/ 和/ 物品/ 的/ 偏好/ 特征/ ,/ 所以/ 仍然/ 能/ 有/ 较/ 好/ 的/ 结果/ ./ 在/ 缺失/ 值/ 不断/ 填补/ ,/ 即/ 属性/ 数量/ 不断/ 增加/ 的/ 情况/ 下/ ,/ 效果/ 的/ 提升/ 是/ 显而易见/ 的/ ./ ML/ -/ 1m/ 虽然/ 记录/ 数很多/ ,/ 但是/ 其/ 提升/ 效果/ 并/ 没有/ Yahoo/ !/ 那么/ 显著/ ./ 原因/ 在于/ 除了/ 属性/ 数量/ ,/ 属性/ 的/ 特性/ (/ 比如/ “/ 粒度/ ”/ )/ 对/ 结果/ 也/ 是/ 有/ 影响/ 的/ ,/ 例如/ 表/ 2/ 中/ ML/ -/ 1m/ 的/ 属性/ 是/ “/ 粗粒度/ ”/ 的/ ,/ 而/ Yahoo/ !/ 中/ 的/ 属性/ 是/ “/ 细粒度/ ”/ 的/ ./ 具体/ 地/ ,/ ML/ -/ 1m/ 中/ 只有/ 7/ 个/ 年龄段/ 、/ 21/ 种/ 职业/ 和/ 18/ 种/ 电影/ 类别/ ,/ 如果/ 把/ 6040/ 个/ 用户/ 按/ 这些/ 属性/ 来分/ ,/ 得到/ 的/ 每个/ 组/ 里面/ 的/ 用户数量/ (/ “/ 粒度/ ”/ )/ 还是/ 很多/ (/ 大/ )/ 的/ ,/ 即/ 其/ 捕捉/ 单个/ 用户/ 偏好/ 的/ 潜力/ 是/ 有限/ 的/ ./ 反之/ ,/ Yahoo/ !/ 的/ 属性/ 如/ “/ 导演/ ”/ 、/ “/ 演员/ ”/ 、/ “/ 发行/ 日期/ ”/ 等/ 都/ 种类/ 繁多/ ,/ 按/ 不同/ 属性/ 区分/ 出来/ 的/ 用户组/ 中/ 的/ 用户数量/ (/ “/ 粒度/ ”/ )/ 是/ 极少/ (/ 小/ )/ 的/ ,/ 说明/ 其/ 描述/ 个性化/ 的/ 能力/ 是/ 较/ 强/ 的/ ./ 同样/ 地/ ,/ ML/ -/ latest/ 中/ ,/ “/ 电影/ 标签/ ”/ 也/ 是/ “/ 细粒度/ ”/ 的/ ,/ 可能/ 某个/ 标签/ 只/ 被/ 1/ 个/ 用户/ 打/ 过/ ,/ 所以/ 其/ 性能/ 提升/ 的/ 空间/ 也/ 比/ ML/ -/ 1m/ 大/ ./ 在/ 某些/ 情况/ 下/ ,/ 比如/ ML/ -/ 1m/ 使用/ 4/ 个/ 属性/ 、/ Yahoo/ !/ 使用/ 6/ 个/ 属性/ 时/ ,/ 效果/ 有/ 轻微/ 的/ 下降/ ,/ 但/ RMSE/ 和/ MAE/ 总体/ 呈/ 下降/ 的/ 趋势/ ./ 这/ 说明/ 属性/ 提升/ 能够/ 平衡/ 属性/ 对/ 预测/ 结果/ 的/ 影响/ ,/ 即/ 通过/ 对/ 属性/ 的/ 精细/ 建模/ 来/ 充分/ 挖掘/ 属性/ 有用/ 的/ 隐含/ 特征/ ,/ 从而/ 减少/ 盲目/ 交互/ 带来/ 的/ 消极影响/ ,/ 最终/ 使/ 预测值/ 更/ 接近/ 真实/ 值/ ./ 因此/ ,/ 随着/ 属性/ 的/ 增加/ ,/ ABPS/ 算法/ 可以/ 充分发挥/ 属性/ 对/ 评分/ 预测/ 的/ 积极/ 作用/ ,/ 使/ 整体/ 效果/ 呈上升/ 趋势/ ./ 在/ 属性/ 提升/ 的/ 基础/ 上/ ,/ 5.3/ 小节/ 将/ 讨论/ 局部/ 采样/ 的/ 效果/ ./ 5.3/ 局部/ 采样/ 的/ 效果/ 在/ 考虑/ 局部/ 采样/ 的/ 影响/ 时/ ,/ 由/ 上节/ 的/ 实验/ 结果/ 可知/ ,/ 使用/ 最多/ 的/ 属性/ 可以/ 得到/ 最佳/ 的/ 性能/ ,/ 因此/ 采用/ 表/ 2/ 中/ 的/ 全部/ 属性/ 进行/ 实验/ ./ 在/ 这个/ 过程/ 中/ ,/ 为了/ 比较/ 采样/ 对/ 结果/ 的/ 影响/ ,/ 设计/ 了/ 无/ 采样/ 属性/ 提升/ (/ AttributeBoostingwithNoSampling/ ,/ ABNS/ )/ 、/ 局部/ 采样/ 属性/ 提升/ (/ AttributeBoostingwithPartialSampling/ ,/ ABPS/ )/ 和/ 全局/ 采样/ 属性/ 提升/ (/ AttributeBoostingwithAllSampling/ ,/ ABAS/ )/ 3/ 种/ 方法/ ,/ 对/ 它们/ 在/ 性能/ 和/ 运行/ 时间/ 上/ 做/ 了/ 对比/ ./ 无/ 采样/ 指/ 的/ 是/ 在/ 模型/ 的/ 训练/ 过程/ 中/ 使用/ SGD/ 配合/ ALS/ 使/ 其/ 收敛/ ;/ 局部/ 采样/ 就是/ 对/ p/ 、/ q/ 和/ α/ 做/ Gibbs/ 采样/ ,/ 而/ 其他/ 参数/ 仍/ 使用/ SGD/ 和/ ALS/ ;/ 全局/ 采样/ 即/ 对/ 所有/ 参数/ 进行/ 采样/ ,/ 从而/ 使/ 模型/ 全部/ 通过/ 概率/ 的/ 角度/ 来/ 表达/ ./ 将/ ABNS/ 、/ ABPS/ 和/ ABAS/ 的/ 特征/ 维度/ 都/ 设置/ 为/ 20/ ,/ 采用/ 5/ 折/ 交叉/ 验证/ ,/ 运行/ 50/ 次/ 迭代/ 来/ 比较/ 3/ 种/ 方法/ 得到/ 的/ 效果/ ./ 其中/ ABNS/ 的/ 初始/ 学习/ 速率/ (/ 针对/ ABNS/ 而言/ )/ 在/ 两个/ ML/ 数据/ 集上/ 设置/ 为/ 0.018/ ,/ 在/ Yahoo/ !/ 上/ 设置/ 为/ 0.028/ ./ 在/ 训练/ 过程/ 中/ ,/ 通过考察/ 本次/ 迭代/ 与/ 上次/ 迭代/ 损失/ 函数/ 的/ 绝对值/ 变化/ ,/ 来/ 动态/ 调整/ 学习/ 速率/ ./ 如果/ 两次/ 迭代/ 的/ 损失/ 绝对值/ 很/ 接近/ ,/ 则/ 收敛/ ;/ 若/ 绝对值/ 变小/ ,/ 则/ 增大/ 学习/ 速率/ ;/ 若/ 绝对值/ 变/ 大/ ,/ 则/ 减小/ 学习/ 速率/ ./ 在/ 实验/ 中/ ,/ 由于/ 对/ 预测值/ 做/ 了/ 规范化/ 处理/ (/ 4.1/ 节/ )/ ,/ 模型/ 对/ 学习/ 速率/ 不/ 敏感/ ,/ 所以/ 3/ 个/ 数据/ 集上/ 的/ 学习/ 速率/ 波动/ 不大/ ./ 对于/ 没有/ 进行/ 采样/ 的/ 参数/ ,/ 设置/ 它们/ 的/ 规范化/ 因子/ 为/ 0.00008/ ./ 实验/ 效果/ 如图/ 3/ 所示/ ./ 在/ 3/ 个/ 数据/ 集上/ ,/ ABAS/ 均/ 取得/ 了/ 最好/ 的/ 性能/ ,/ ABPS/ 仅次于/ ABAS/ ,/ 而/ 没有/ 采样/ 的/ ABNS/ 效果/ 要/ 差于/ 采样/ 的/ 方法/ ,/ 表明/ 在/ 低/ 秩/ (/ 特征/ 维度/ 为/ 20/ )/ 近似/ 上/ 采样/ 方法/ 占有/ 较大/ 的/ 优势/ ./ 而/ SGD/ 或/ ALS/ 学习/ 法/ 通常/ 需要/ 更/ 多/ 的/ 特征/ 维度/ 来/ 表示/ 实体/ (/ 用户/ 或/ 物品/ )/ 的/ 特点/ ,/ 才能/ 达到/ 较/ 好/ 的/ 效果/ ./ 在/ 个性化/ 标注/ 信息/ 较/ 多/ 的/ ML/ -/ latest/ 和/ 属性/ 数量/ 较/ 多/ 的/ Yahoo/ !/ 数据/ 集上/ ,/ ABPS/ 的/ 表现/ 比/ ABNS/ 有/ 明显/ 的/ 提升/ ./ 这/ 说明/ 采样/ 因子/ p/ 、/ q/ 和/ α/ 能够/ 很/ 好/ 地/ 模拟/ 用户/ 偏好/ 、/ 物品/ 关联/ 和/ 类型/ 特征/ ,/ 从而/ 满足/ 评分/ 预测/ 的/ 个性化/ 需求/ ./ 因此/ 局部/ 采样/ 对模型/ 性能/ 的/ 提高/ 是/ 显著/ 的/ ./ 另一方面/ 要/ 考虑/ 的/ 是/ 模型/ 的/ 效率/ (/ 运行/ 时间/ )/ ,/ 如图/ 4/ 所示/ ./ Page10/ 图/ 4/ 不同/ 采样/ 方式/ 的/ 耗时/ 图/ 4/ 显示/ 了/ 3/ 种/ 方法/ 各/ 运行/ 30/ 次/ 迭代/ 所/ 消耗/ 的/ 时间/ ./ 可以/ 看出/ 无论/ 迭代/ 次数/ 如何/ 变化/ ,/ 无/ 采样/ 的/ ABNS/ 方法/ 都/ 会/ 有/ 较/ 快/ 的/ 速度/ ,/ 因为/ 采样/ 方法/ 在/ 更新/ 某个/ 参数/ 时/ 需要/ 固定/ 其他/ 参数/ ,/ 所以/ 会/ 比/ SGD/ 和/ ALS/ 慢/ ./ 而/ ABPS/ 由于/ 是/ 部分/ 采样/ ,/ 只/ 对/ 用户/ 偏好/ 、/ 物品/ 关联/ 和/ 类型/ 特征/ 作/ 采样/ ,/ 因此/ 运行/ 速度/ 会/ 比全/ 采样/ 的/ ABAS/ 有/ 大幅度/ 的/ 提高/ ./ 特别/ 是/ 在/ 属性/ 数量/ 相对/ 于/ 用户/ 、/ 物品/ 和/ 类型/ 个数/ 较/ 多/ 的/ Yahoo/ !/ 数据/ 集上/ ,/ ABPS/ 的/ 效率/ 接近/ 于/ ABNS/ ;/ 而/ 在/ ML/ -/ 1m/ 数据/ 集上/ ,/ 记录/ 数量/ 较/ 多/ ,/ 所以/ 也/ 让/ ABAS/ 耗时/ 更/ 多/ ;/ 在/ ML/ -/ latest/ 上/ ,/ 属性/ 数量/ 和/ 记录/ 数都/ 较/ 少/ ,/ 所以/ ABAS/ 与/ 其他/ 两个/ 方法/ 的/ 差距/ 没有/ 另外/ 两个/ 数据/ 集大/ ./ 这/ 说明/ 在/ 记录/ 数多/ 或者/ 属性/ 数量/ 多/ 的/ 情况/ 下/ ,/ 使用/ 全/ 采样/ 方法/ 都/ 面临/ 着/ 运行/ 效率/ 低下/ 的/ 问题/ ,/ 而/ 使用/ 局部/ 采用/ 的/ ABPS/ 虽然/ 没有/ ABNS/ 高效/ ,/ 但是/ 从/ 上/ 面对/ 图/ 3/ 的/ 讨论/ 可知/ ,/ 它/ 比/ ABNS/ 的/ 性能/ 要/ 好/ ./ 如果/ 在/ 模型/ 性能/ 和/ 运行/ 效率/ 上/ 做/ 权衡/ ,/ ABPS/ 更/ 适合/ 实际/ 应用/ ,/ 因此/ 在/ 下/ 一节/ 采用/ ABPS/ 与/ 其他/ 的/ 方法/ 作/ 比较/ ./ 5.4/ 方法/ 比较/ 实验/ 选择/ BPMF/ [/ 10/ ]/ 和/ FM/ [/ 17/ ]/ 来/ 与/ ABPS/ 作/ 比较/ ,/ 因为/ BPMF/ 是/ 因子/ 模型/ 结合/ 采样/ 方法/ 的/ 代表/ 模型/ ,/ FM/ 是/ 属性/ 交互/ 建模/ 的/ 典型/ 模型/ ,/ 并且/ 在实践中/ 被/ 广泛应用/ ./ 而/ ABPS/ 不仅/ 使用/ 了/ 属性/ 提升/ ,/ 从/ 新/ 的/ 角度/ 描述/ 属性/ 交互/ ,/ 又/ 采用/ 了/ 局部/ 采样/ 的/ 训练/ 方式/ ,/ 所以/ 本文/ 将/ 3/ 种/ 方法/ 放在/ 一起/ 评测/ ./ 实验/ 中/ ,/ BPMF/ 的/ 评分/ 方差/ α/ -/ 1/ 和/ ABPS/ 的/ 评分/ 方差/ λ/ -/ 1/ 在/ 两类/ 数据/ 集/ ML/ 和/ Yahoo/ !/ 上/ 的/ 值/ 分别/ 设置/ 为/ 1/ // 1.8/ 和/ 1/ // 2.5/ ./ 两个/ 模型/ 的/ Wishart/ 分布/ 的/ 自由度/ υ/ 0/ 取/ 它们/ 的/ 特征/ 维度/ 数/ 20/ ,/ 共/ 变异/ 矩阵/ 犠/ 0/ 设为/ 20/ ×/ 20/ 维/ ./ 相对/ 于/ 这/ 两个/ 模型/ ,/ FM/ 的/ 特征/ 维度/ 设置/ 为/ 32/ ,/ 该/ 模型/ 其他/ 参数/ (/ 如/ w/ 和/ v/ )/ 的/ 规范化/ 因子/ 取/ 0.0000018/ ,/ 以/ 防止/ 过度/ 拟合/ ./ 实验/ 结果/ 如图/ 5/ 所示/ ./ 在/ 标准/ 的/ 协同/ 过滤/ 数据/ 集/ ML/ -/ 1m/ 上/ ,/ BPMF/ 表现/ 良好/ ,/ 甚至/ 在/ MAE/ 上/ 超过/ 了/ FM/ ./ 无论是/ RMSE/ 还是/ MAE/ ,/ 上下文/ 推荐/ 模型/ FM/ 和/ ABPS/ 都/ 没有/ 大/ 的/ 优势/ ,/ 因为/ 该/ 数据/ 集/ 的/ 属性/ 相对来说/ 是/ 通用/ 的/ ,/ 比如/ 职业/ 、/ 年龄/ 等/ ./ 而/ ML/ -/ latest/ 则/ 不同/ ,/ 其中/ 有/ 一个/ 重要/ 的/ 属性/ 是/ 标签/ ,/ 标签/ 是/ 反映/ 个性化/ 信息/ 的/ 一个/ 属性/ 类型/ ,/ 两个/ 上下文/ 推荐/ 模型/ 在/ 该/ 数据/ 集上/ 则/ 比/ BPMF/ 有/ 了/ 更/ 多/ 的/ 提升/ ./ 对/ Yahoo/ !/ 数据/ 集/ 来说/ ,/ 多样化/ 的/ 属性/ 非常/ 有利于/ 评分/ 预测/ ,/ 因此/ FM/ 和/ ABPS/ 也/ 有/ 较大/ 的/ 优势/ ./ 这种/ 优势/ 突出表现/ 在/ RMSE/ 上/ ,/ 因为/ RMSE/ 利用/ 平方/ 来/ 衡量/ 误差/ ,/ 所以/ 离/ 真实/ 值/ 更/ 远/ 的/ 预测值/ 会/ 被/ 赋予/ 更大/ 的/ 权重/ ./ 而/ 两种/ 上下文/ 方法/ 都/ 充分利用/ 了/ 属性/ ,/ 通过/ 属性/ 优化/ 预测值/ 从而/ 显著/ 地/ 避免/ 了/ 大/ 误差/ 的/ 发生/ ,/ 最终/ 减小/ 了/ 总体/ 误差/ ./ 相对/ 地/ ,/ MAE/ 是/ 没有/ 权重/ 的/ 误差/ 估计/ ,/ 能/ 客观/ 地/ 反映/ 用户/ 的/ 绝对误差/ 平均值/ ,/ ABPS/ 因为/ 做/ 了/ 属性/ 提升/ ,/ 在/ 表达/ 用户/ 偏好/ 或/ 物品/ 特点/ 方面/ 比/ FM/ 更/ Page11/ 有/ 针对性/ ,/ 所以/ 在/ 降低/ RMSE/ 的/ 同时/ ,/ FM/ 和/ ABPS/ 也/ 在/ MAE/ 测评/ 中/ 表现/ 良好/ ./ 实验/ 结果表明/ 对/ 用户/ 、/ 物品/ 和/ 属性/ 类型/ 的/ 建模/ 可以/ 反映/ 更/ 多/ 有用/ 的/ 信息/ ,/ 这是/ 普通/ 属性/ 点/ 对/ 交互/ 所/ 不/ 具备/ 的/ ./ 而且/ ,/ ABPS/ 使用/ 的/ 特征/ 维度/ (/ 20/ )/ 比/ FM/ (/ 32/ )/ 少/ ,/ 这是/ 局部/ 采样/ 的/ 低/ 秩/ 近似/ 优势/ ,/ 可以/ 用/ 更/ 少/ 的/ 维度/ 来/ 表达/ 同样/ 的/ 信息/ ./ 虽然/ FM/ 的/ 普适性/ 较/ 好/ ,/ 可以/ 用于/ 其他/ 推荐/ 任务/ ,/ 但是/ 在/ 上下文/ 推荐/ 中/ ,/ ABPS/ 对/ 属性/ 交互/ 的/ 精细/ 建模/ 使/ 其/ 在/ 评分/ 预测/ 方面/ 更/ 有/ 优势/ ./ 5.5/ 实际/ 应用/ 在/ 实际/ 的/ 推荐/ 应用/ 中/ ,/ 往往/ 都/ 是/ 需要/ 面对/ 大量/ 数据/ ,/ 所以/ 我们/ 选取/ 拥有/ 1000/ 万条/ 记录/ 的/ ML/ -/ 10m/ 数据/ 集来/ 模拟/ 实际/ 的/ 情况/ ./ 该/ 数据/ 集/ 的/ 7/ 万多个/ 用户/ 和/ 9/ 万多种/ 标签/ 使得/ 其/ 具备/ 数据量/ 大/ 、/ 稀疏/ 性/ 的/ 特点/ ,/ 因此/ 也/ 更/ 能/ 验证/ ABPS/ 的/ 实际/ 性能/ ./ 由于/ 该/ 数据/ 集/ 的/ 上下文/ 信息/ 丰富/ ,/ 在/ 考察/ ABPS/ 时/ 我们/ 选择/ FM/ 作为/ 比较/ ,/ 因为/ 它们/ 都/ 是/ 对/ 属性/ 建模/ 的/ 上下文/ 推荐/ 模型/ ,/ 这/ 使得/ 它们/ 具有/ 可比性/ ./ 评分/ 预测/ 的/ 性能/ (/ 包括/ RMSE/ 、/ MAE/ 和/ 运行/ 时间/ )/ 是/ 首先/ 考察/ 的/ 内容/ ./ 实验/ 通过/ 改变/ 模型/ 的/ 特征/ 维度/ (/ 因子/ 数量/ )/ 来/ 观图/ 6ML/ -/ 10m/ 上/ 的/ 评分/ 预测/ 效果图/ 7ML/ -/ 10m/ 上/ 的/ 评分/ 预测/ 与/ 物品/ 推荐/ 运行/ 时间/ 察/ 它们/ 的/ 表现/ ,/ 因为/ 特征/ 维度/ 代表/ 了/ 模型/ 的/ 空间/ 复杂度/ ,/ 即/ 模型/ 需要/ 多少/ 维度/ 来/ 存储/ ,/ 这是/ 实际/ 中/ 需要/ 考虑/ 的/ 问题/ 之一/ ./ 图/ 6/ 展示/ 了/ 两个/ 模型/ 的/ 评分/ 预测/ 性能/ ,/ 无论/ 模型/ 特征/ 维度/ 如何/ 变化/ ,/ ABPS/ 在/ 两个/ 指标/ 上/ 都/ 比/ FM/ 有/ 明显/ 的/ 优势/ ./ 特别/ 是/ 在/ 低/ 秩/ (/ 维/ )/ 部分/ (/ 5/ ~/ 25/ 维/ )/ ,/ ABPS/ 的/ 优势/ 更加/ 显著/ ,/ 主要/ 是因为/ ABPS/ 从/ 用户/ 、/ 物品/ 和/ 类型/ 3/ 个/ 层面/ 对/ 属性/ 建模/ ,/ 能够/ 学习/ 到/ 属性/ 的/ 潜在/ 特征/ (/ 即式/ (/ 2/ )/ 中/ 的/ 提升/ 项/ )/ ,/ 从而/ 避免/ 了/ 因/ 属性/ (/ 这里/ 主要/ 是/ 标签/ )/ 缺失/ 而/ 造成/ 难以预测/ 的/ 问题/ ,/ 所以/ 20/ 维/ 的/ ABPS/ 在/ 性能/ 上/ 已/ 超过/ 30/ 维/ 的/ FM/ ./ 在/ 运行/ 时间/ 方面/ ,/ 实验/ 记录/ 了/ 两个/ 模型/ 在/ 评分/ 预测/ 和/ 物品/ 推荐/ 上/ 的/ 耗时/ ,/ 由于/ Top/ -/ N/ 物品/ 推荐/ 有/ 其/ 实际/ 的/ 应用/ 价值/ ,/ 所以/ 我们/ 将/ 评分/ 预测/ 的/ 结果/ 排序/ 后/ 进行/ 物品/ 推荐/ ./ 从图/ 7/ 可以/ 看出/ ,/ 如果/ 对比/ 相同/ 的/ 因子/ 数量/ ,/ FM/ 只/ 需要/ 相当于/ ABPS/ 算法/ 2/ // 3/ 的/ 时间/ ,/ 但是/ ,/ 前面/ 已/ 讨论/ 过/ ,/ 20/ 维/ 的/ ABPS/ 比/ 30/ 维/ 的/ FM/ 表现/ 更好/ ,/ 观察/ 时间轴/ (/ 纵轴/ )/ 可以/ 发现/ ,/ 20/ 维/ 的/ ABPS/ 只/ 比/ 30/ 维/ 的/ FM/ 多/ 耗时/ 一些/ ,/ 而/ 损耗/ 的/ 时间/ 从/ 性能/ 那/ Page12/ 里/ 得到/ 了/ 补偿/ ./ 物品/ 推荐/ 比/ 评分/ 预测/ 稍微/ 耗时/ 一些/ ,/ 因为/ 在/ 推荐/ 前/ 需要/ 做/ 排序/ ,/ 这/ 也/ 导致/ 了/ 时间/ 损耗/ 不像/ 评分/ 预测/ 那样/ 随着/ 维数/ 的/ 增加/ 而/ 线性/ 增长/ ,/ 即/ 有/ 图/ 8ML/ -/ 10m/ 上/ 的/ Top/ -/ 10/ 推荐/ 召回/ 率/ (/ Recall/ )/ 与/ 评分/ 预测/ 不同/ 的/ 是/ ,/ Top/ -/ 10/ 推荐/ 在/ 一/ 开始/ (/ Factor/ =/ 5/ 和/ Factor/ =/ 10/ )/ 时/ 结果/ 非常/ 接近/ ,/ ABPS/ 并/ 没有/ 表现/ 出/ 更好/ 的/ 性能/ ,/ 这/ 是因为/ 评分/ 预测/ 关注/ 的/ 是/ 显式/ 反馈/ (/ 预测/ 结果/ 是否/ 接近/ 测试/ 集中/ 物品/ 的/ 分数/ )/ ,/ 而/ 物品/ 推荐/ 关心/ 的/ 是/ 隐式/ 反馈/ (/ 推荐/ 的/ 物品/ 有没有/ 在/ 测试/ 集中/ 存在/ )/ ./ 换句话说/ ,/ 不管/ 给/ 被/ 推荐/ 的/ 物品/ 打/ 1/ 分/ 还是/ 5/ 分/ ,/ 只要/ 它/ 出现/ 在/ 测试/ 集中/ (/ 即/ 命中/ )/ ,/ Top/ -/ N/ 推荐/ 的/ 性能/ 就/ 会/ 提升/ ./ 所以/ ,/ 虽然/ ABPS/ 在/ Factor/ =/ 5/ 和/ 10/ 时/ 评分/ 预测/ 更/ 精确/ ,/ 但是/ 小幅度/ 的/ 波动/ ./ 为了/ 更好/ 地/ 评价/ Top/ -/ N/ 推荐/ ,/ 我们/ 取/ N/ =/ 10/ ,/ 即/ 推荐/ 10/ 个/ 物品/ ,/ 用/ 召回/ 率/ (/ Recall/ )/ 来/ 衡量/ 模型/ 的/ 性能/ ,/ 结果/ 如图/ 8/ 所示/ ./ 它/ 的/ 命中率/ 与/ FM/ 是/ 接近/ 的/ ./ 在/ Factor/ =/ 15/ ~/ 25/ 时/ ,/ ABPS/ 的/ 优势/ 体现/ 出来/ ,/ 而/ FM/ 的/ 提升/ 空间/ 不/ 大/ ,/ 这是/ 属性/ 提升/ 给/ 个性化/ 推荐/ 带来/ 的/ 积极/ 影响/ ./ 在/ 更/ 高/ 的/ 维度/ ,/ 比如/ Factor/ =/ 35/ 和/ 40/ 时/ ,/ ABPS/ 的/ 优势/ 主要/ 表现/ 在/ Top/ -/ 5/ 至/ Top/ -/ 10/ 部分/ ./ 总体/ 来说/ ,/ ABPS/ 的/ 长处/ 在于/ 评分/ 预测/ ,/ 而/ 在/ 物品/ 推荐/ 方面/ 也/ 表现/ 良好/ ,/ 它/ 的/ 性能/ 来源于/ 精细/ 的/ 属性/ 建模/ 与/ 更/ 耗时/ 的/ 局部/ 采样/ ,/ 这/ 也/ 决定/ 了/ 它/ 能/ 用/ 更/ 低/ 的/ 维度/ (/ 更少/ 的/ 空间/ )/ 来/ 构建/ 模型/ ,/ 这是/ 具有/ 实际意义/ 的/ ./ Page136/ 结论/ 本文/ 提出/ 的/ 属性/ 提升/ 与/ 局部/ 采样/ 方法/ (/ ABPS/ )/ ,/ 从/ 用户/ 与/ 属性/ 的/ 交互/ 、/ 物品/ 与/ 属性/ 的/ 交互/ 、/ 属性/ 与/ 自身/ 类型/ 的/ 交互/ 三/ 方面/ 有/ 针对性/ 的/ 建模/ ./ 从而/ 避免/ 盲目/ 的/ 属性/ 交互/ 带来/ 的/ 负面/ 效果/ ,/ 模型/ 的/ 框架/ 也/ 因此/ 由/ 这/ 3/ 个/ 方面/ 组成/ ./ 在/ 参数/ 训练/ 中/ ,/ 仅/ 对/ 这/ 3/ 个/ 方面/ 的/ 特征/ 因子/ 进行/ 采样/ ,/ 从而/ 使/ 模型/ 能/ 在/ 属性/ 数量/ 较大/ 或/ 记录/ 数较/ 多/ 的/ 情况/ 下/ ,/ 仍能/ 保持/ 较/ 高/ 的/ 效率/ 与/ 性能/ ./ 在/ 未来/ 的/ 研究/ 中/ ,/ 我们/ 将/ 把/ 重点/ 放在/ 与/ “/ 冷启动/ ”/ 有关/ 的/ 主题/ 上/ ,/ 即/ 用户/ 缺失/ 或/ 物品/ 缺失/ ./ 这种/ 情况/ 下/ ,/ 如果/ 用/ ABPS/ 来/ 描述/ ,/ 应/ 考虑/ 到/ 如何/ 通过/ 用户/ 关系/ 或/ 物品/ 关联/ 来/ 解决/ 评分/ 预测/ 的/ 问题/ ,/ 这/ 也/ 是/ 研究/ 小组/ 下/ 一步/ 要/ 改进/ 的/ 方向/ ./ 

