Page1/ 网络设备/ 协同/ 联动/ 模型/ 臧/ 天宁/ 1/ )/ 云晓春/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 张永铮/ 2/ )/ 门朝光/ 1/ )/ 孙建亮/ 2/ )/ 1/ )/ (/ 哈尔滨工程大学/ 计算机科学/ 与/ 技术/ 学院/ 哈尔滨/ 150001/ )/ 2/ )/ (/ 中国科学院计算技术研究所/ 北京/ 100190/ )/ 3/ )/ (/ 国家/ 计算机网络/ 应急/ 技术/ 处理/ 协调/ 中心/ 北京/ 100029/ )/ 摘要/ 在/ 开放/ 的/ 互联网/ 环境/ 下/ ,/ 大规模/ 分布式/ 网络/ 恶意/ 行为/ 日益/ 增多/ ./ 发生/ 在/ 不同/ 地理位置/ 、/ 不同/ 时间段/ 的/ 安全事件/ 可能/ 存在/ 潜在/ 的/ 隐藏/ 关系/ ./ 作者/ 基于/ 通用/ 图灵机/ 思想/ ,/ 提出/ 了/ 一个/ 处理/ 大规模/ 网络安全/ 事件/ 的/ 协同/ 联动/ 模型/ (/ CoordinativeRunningModel/ ,/ CRM/ )/ ./ 在/ 形式/ 定义/ 的/ 基础/ 上/ ,/ 从/ 人机交互/ 角度/ 分析模型/ 层次结构/ ,/ 由/ 不同/ 部件/ 构建/ 模型/ 系统结构/ ,/ 并/ 实现/ 了/ 面向/ 基础/ 网络/ 的/ 协同/ 联动/ 系统/ (/ CoordinativeRunningSystem/ ,/ CRS/ )/ ,/ 且/ 与/ 基于/ 安全/ 域/ 的/ 安全/ 操作/ 中心/ (/ SecurityOperatingSystem/ ,/ SOC/ )/ 模型/ 进行/ 了/ 对比/ 分析/ ./ 在/ 僵尸/ 网络/ 的/ 检测/ 和/ 追踪/ 、/ DDoS/ 攻击/ 事件/ 关联/ 以及/ 僵尸/ 网络/ 与/ DDoS/ 攻击/ 源/ 关系/ 分析/ 三个/ 应用/ 实例/ 中/ ,/ CRS/ 协调/ 骨干网/ 上/ 不同/ 类型/ 安全设备/ 共同/ 工作/ ./ 典型/ 数据/ 的/ 分析/ 结果表明/ ,/ CRS/ 为/ 分析/ 不同/ 时间/ 及/ 不同/ 空间/ 安全事件/ 之间/ 关系/ ,/ 挖掘/ 各/ 事件/ 关联/ 后/ 的/ 更/ 深层次/ 安全隐患/ 提供/ 了/ 有力/ 平台/ ./ 关键词/ 网络安全/ ;/ 协同/ 联动/ ;/ 图灵机/ ;/ DDoS/ ;/ 僵尸/ 网络/ 1/ 引言/ 随着/ 计算机/ 通信/ 技术/ 的/ 进步/ ,/ 大规模/ 网络/ 恶意/ 行为/ 日趋/ 复杂/ 和/ 多样/ ,/ 越来越/ 多/ 的/ 研究/ 工作/ 关注/ 多/ 网络安全/ 设备/ 的/ 融合/ 和/ 协同/ 以/ 应对/ 大规模/ 分布式/ 网络安全/ 事件/ ./ 美国加州大学/ Davis/ 分校/ 在/ 20/ 世纪/ 90/ 年代/ 就/ 研发/ 了/ DIDS/ (/ DistributedIntrusionDetectionSystem/ )/ 系统/ [/ 1/ ]/ ,/ 把/ 分散/ 部署/ 的/ 若干个/ 网络/ 监视器/ 和/ 主机/ 监视器/ 采集/ 的/ 信息/ 送到/ 中心/ 节点/ DIDSDirector/ ,/ 集中/ 分析/ 处理/ ./ 德克萨斯/ 农工/ 大学/ 提出/ 了/ 对/ 等体/ 组织/ 结构/ 的/ CSM/ (/ CooperatingSecurityManagers/ )/ [/ 2/ ]/ 系统/ ,/ 由/ 若干个/ 基于/ 主机/ 的/ 入侵/ 检测/ 和/ 响应/ 系统/ CSM/ 组成/ ,/ 设立/ 攻击/ 可疑/ 度/ 作为/ 响应/ 因素/ ./ 美国国防部/ 高级/ 研究/ 计划局/ (/ DARPA/ )/ 资助/ 的/ EMERALD/ [/ 3/ ]/ 项目/ 构建/ 了/ 一个/ 集成/ 误用/ 检测/ 和/ 异常/ 检测/ 的/ 大型/ 分布式/ 入侵/ 检测/ 与/ 分析/ 系统/ ./ 日本/ 信息化/ 推进/ 机构/ (/ InformationtechnologyPromotionAgency/ ,/ IPA/ )/ 开发/ 的/ 入侵/ 检测/ 代理/ 系统/ (/ IntrusionDetectionAgentsystem/ )/ [/ 4/ ]/ 采用/ 两层/ 架构/ ,/ 应用/ 移动/ 代理/ 技术/ 自动/ 收集/ 信息/ ./ 法国/ MIRADOR/ 项目/ 提出/ 了/ 网络/ 恶意/ 行为/ 的/ 协同/ 识别/ 模型/ (/ CooperationandRecognitionofMalevolentIntentions/ ,/ CRIM/ )/ [/ 5/ -/ 6/ ]/ ./ 这些/ 研究/ 工作/ 主要/ 是/ 针对/ 分布式/ 入侵/ 检测/ 系统/ ,/ 通过/ 告警/ 聚合/ 去除/ 冗余/ 告警/ ,/ 降低/ 虚警率/ ,/ 然后/ 进一步/ 关联/ 告警信息/ ,/ 识别/ 入侵/ 行为/ ,/ 分析/ 入侵/ 意图/ ./ Renaud/ [/ 7/ ]/ 描述/ 的/ 安全/ 操作/ 中心/ (/ SecurityOper/ -/ ationCenter/ ,/ SOC/ )/ 结构/ 模型/ ,/ 融合/ 了/ 网络管理/ 和/ 安全/ 管理/ ./ 首先/ 根据/ 大量/ 网络/ 恶意/ 行为/ 的/ 模式/ 关联/ ,/ 建立/ 入侵/ 行为/ 模板/ ,/ 存储/ 于/ 知识库/ ./ 然后/ 按照/ 时序/ 模式匹配/ 等/ 方式/ 处理/ 各种/ 网络安全/ 监测/ 设备/ 探测/ 到/ 的/ 异常/ 信息/ ,/ 监测/ 网络安全/ 事件/ ./ 并/ 根据/ 系统漏洞/ 和/ 脆弱性/ 分析/ ,/ 建立/ 系统/ 安全策略/ 模板/ ./ Fortinet/ 公司/ 提出/ 了/ 一种/ 七层/ 安全/ 技术/ ,/ 统一/ 威胁/ 管理/ (/ UnitedThreatManagement/ ,/ UTM/ )/ ./ 将/ 多种/ 安全/ 特性/ 集成/ 于/ 一个/ 硬设备/ 里/ ,/ 构成/ 统一/ 管理/ 平台/ ./ 具备/ 网络/ 防火墙/ 、/ 网络/ 入侵/ 防御/ 和/ 网关/ 防病毒/ 等/ 功能/ ./ 是/ 一种/ 部署/ 在/ 网关/ 的/ 安全设备/ ./ 以上/ 研究/ 和/ 工作/ 的/ 前提/ 是/ 在/ 互联网/ 上/ 划分/ 出/ 一个/ 域/ ,/ 在/ 这个/ 域/ 中/ 按照/ 事先/ 设置/ 的/ 固定/ 模式/ ,/ 集中管理/ 或/ 防御/ ./ 然而/ ,/ 互联网/ 本身/ 是/ 一个/ 开放/ 、/ 互通/ 的/ 网络空间/ ,/ 目前/ ,/ 以/ 建立/ 僵尸/ 网络/ 、/ 发动/ 分布式/ 拒绝服务/ (/ DistributedDenialofService/ ,/ DDoS/ )/ 攻击/ 等/ 为/ 代表/ 的/ 群体性/ 网络/ 恶意/ 行为/ 大规模/ 调用/ 分布/ 在/ 整个/ 互联网/ 的/ 资源/ [/ 8/ ]/ ,/ 他们/ 位置/ 分散/ ,/ 形式多样/ ,/ 仅/ 对/ 某个/ 安全/ 域/ 的/ 防护/ ,/ 无法/ 深入分析/ 这些/ 群体性/ 恶意/ 行为/ ./ 另外/ ,/ 发生/ 在/ 不同/ 地理位置/ 、/ 不同/ 时间段/ 的/ 安全事件/ 是否/ 由/ 同一/ 组织/ 所/ 为/ ,/ 不同/ 类别/ 的/ 安全事件/ 是否/ 存在/ 着/ 关联性/ ,/ 诸多/ 安全事件/ 信息/ 结合/ 在/ 一起/ 能否/ 挖掘出/ 更/ 深层次/ 的/ 安全隐患/ ./ 针对/ 上述/ 问题/ ,/ 本文/ 提出/ 了/ 一个/ 基于/ 通用/ 图灵机/ 的/ 网络安全/ 设备/ 协同/ 联动/ 模型/ ,/ 并/ 通过/ 该/ 模型/ 实现/ 了/ 一个/ 面向/ 国家/ 基础/ 网络/ 的/ 网络安全/ 协同/ 联动/ 系统/ ./ 为/ 追踪/ 、/ 分析/ 互联网/ 的/ 大规模/ 安全事件/ 提供/ 了/ 有力/ 平台/ ./ 本文/ 第/ 2/ 节/ 介绍/ 协同/ 联动/ 模型/ ;/ 第/ 3/ 节/ 描述/ 协同/ 联动/ 系统/ 的/ 实现/ ;/ 第/ 4/ 节/ 阐述/ 协同/ 联动/ 系统/ 的/ 应用/ 实例/ 和/ 数据分析/ ;/ 第/ 5/ 节是/ 应用/ 实例/ ;/ 第/ 6/ 节/ 总结/ 全文/ ./ 2/ 基于/ 通用/ 图灵机/ 的/ 协同/ 联动/ 模型/ 2.1/ 通用/ 图灵机/ 和/ 存储/ 程序/ 计算机/ 为了/ 解决/ 有限/ 步数/ 可/ 计算/ 问题/ ,/ 英国/ 数学家/ 阿兰/ ·/ 图灵/ 于/ 1937/ 年/ 提出/ 了/ 抽象/ 计算/ 模型/ —/ —/ —/ 图灵机/ (/ TuringMachine/ )/ [/ 9/ ]/ ./ 图灵/ 进一步/ 描述/ 了/ 一种/ 可/ 存储/ 指令/ 的/ 通用/ 图灵机/ [/ 10/ ]/ ,/ 这种/ 机器/ 能够/ 读取/ 并/ 执行/ 不同/ 的/ 程序/ ./ 在/ 某种意义/ 上/ ,/ 通用/ 图灵机/ 相当于/ 一个/ 解释程序/ ,/ 给定/ 任意/ 应用程序/ 及/ 输入/ 数据/ ,/ 利用/ 这个/ 解释程序/ 可以/ 得到/ 输出/ ./ 采用/ 通用/ 图灵机/ 模型/ 可以/ 对/ 任意/ 特定/ 的/ 图灵机/ 进行/ 仿真/ [/ 11/ ]/ ./ 图灵/ 认为/ 这样/ 的/ 一台/ 机器/ 能/ 模拟/ 人类/ 进行/ 任何/ 计算/ 过程/ ,/ 是/ 可/ 等价/ 于/ 任何/ 有限/ 逻辑/ 数学/ 过程/ 的/ 终极/ 强大/ 计算机/ 器/ ./ 因此/ ,/ 通用/ 图灵机/ 是/ 一个/ 通用/ 计算机/ 的/ 数学模型/ ,/ 其/ 抽象/ 意义/ 为/ 一种/ 数学/ 逻辑/ 机/ ,/ 是/ 一个/ 普适性/ 定义/ 的/ 理/ Page3/ 想/ 模型/ ./ 约翰/ ·/ 冯/ ·/ 诺伊曼/ 将/ 这/ 一/ 思想/ 作/ 了/ 具体/ 实现/ ,/ 提出/ 了/ 存储/ 程序/ 计算机/ (/ storedprogramcomputer/ )/ 的/ 体系/ 架构/ ,/ 把/ 需要/ 解决/ 的/ 问题/ 用/ 软件/ 编制程序/ ,/ 然后/ 将/ 程序/ 和/ 数据/ 都/ 存放/ 在/ 存储器/ 里/ ,/ 由/ 中央处理器/ (/ CPU/ )/ 根据/ 指令/ 对/ 数据/ 进行/ 操作/ ./ 这一/ 思想/ 被/ 现代/ 计算机/ 的/ 体系结构/ 所/ 继承/ ./ 2.2/ 协同/ 联动/ 模型/ 形式/ 定义/ 网络安全/ 的/ 协同/ 联动/ 工作/ 是/ 根据/ 事先/ 设定/ 的/ 工作/ 任务/ ,/ 协调/ 多种类型/ 网络设备/ 共同/ 合作/ ,/ 利用/ 这些/ 设备/ 提供/ 的/ 信息/ ,/ 挖掘/ 、/ 分析/ 各种/ 异常/ 网络/ 行为/ ./ 如果/ 把/ 需要/ 协同/ 的/ 设备/ 看作/ 外部设备/ ,/ 则/ 对/ 这些/ 设备/ 提供/ 的/ 信息/ 进行/ 协同/ 处理过程/ 可/ 认为/ 是/ 进行/ 有限/ 步数/ 的/ 计算/ ,/ 因此/ ,/ 本文/ 根据/ 图灵/ 的/ 计算/ 模型/ 和/ 存储/ 程序/ 计算机/ 的/ 体系结构/ 提出/ 了/ 一个/ 处置/ 网络安全/ 事件/ 的/ 协同/ 联动/ 模型/ (/ CoordinativeRunningModel/ ,/ CRM/ )/ ./ 定义/ 1/ ./ 协同/ 联动/ 模型/ 的/ 形式/ 定义/ ./ 一个/ 协同/ 联动/ 模型/ 是/ 一个/ 十元/ 组/ :/ C/ =/ (/ Q/ ,/ q0/ ,/ qaccept/ ,/ qreject/ ,/ Σ/ ,/ δ/ ,/ Γ/ 1/ ,/ Γ/ 2/ ,/ Γ/ 3/ ,/ Γ/ 4/ )/ ,/ 其中/ :/ Q/ 是/ 状态/ 集/ ;/ q0/ ∈/ Q/ 是/ 起始/ 状态/ ;/ qaccept/ ∈/ Q/ 是/ 接受/ 状态/ ;/ qreject/ ∈/ Q/ 是/ 拒绝/ 状态/ ,/ 且/ qreject/ ≠/ qaccept/ ;/ Σ/ 为/ 输入/ 字母表/ ,/ 不/ 包括/ 特殊/ 空白符/ B/ ;/ Γ/ 1/ 是/ 事件/ 带/ 字母表/ ,/ B/ ∈/ Γ/ 1/ 且/ Σ/ / Γ/ 1/ ;/ Γ/ 2/ 是/ 知识/ 带/ 字母表/ ,/ B/ ∈/ Γ/ 2/ 且/ Σ/ / Γ/ 2/ ;/ Γ/ 3/ 是/ 结果/ 带/ 字母表/ ,/ B/ ∈/ Γ/ 3/ 且/ Σ/ / Γ/ 3/ ;/ Γ/ 4/ 是/ 流程/ 带/ 字母表/ ,/ B/ ∈/ Γ/ 4/ 且/ Σ/ / Γ/ 4/ ./ δ/ :/ Q/ ×/ Γ/ 4/ →/ / / δ/ Q/ ×/ Γ/ 4/ ×/ {/ L/ ,/ R/ }/ 4/ 是/ 状态/ 转移/ 函数/ ./ 把/ Q/ ×/ Γ/ 4/ 中/ 的/ 某/ 一个/ 元素/ 映射/ 为/ Q/ ×/ Γ/ 4/ ×/ {/ L/ ,/ R/ }/ 4/ 中/ 的/ 一个/ 元素/ ./ 即/ 定义域/ 和/ 值域/ 分别/ 为/ Q/ ×/ Γ/ 4/ 和/ Q/ ×/ Γ/ 4/ ×/ {/ L/ ,/ R/ }/ 4/ ./ 工作/ 带/ Γ/ 1/ 和/ Γ/ 2/ 上/ 分别/ 记录/ 需要/ 处理/ 的/ 事件/ 字母表/ 和/ 知识/ 字母表/ ;/ Γ/ 3/ 记录/ 处理结果/ 字母表/ ;/ 而/ Γ/ 4/ 上/ 记录/ 着/ 由/ 不同/ 的/ 协同/ 任务/ 定制/ 的/ 工作/ 流程/ 字母表/ ./ 灵机/ ./ 定理/ 1/ ./ 协同/ 联动/ 模型/ CRM/ 等价/ 于/ 通用/ 图/ 证明/ ./ (/ 1/ )/ CRM/ 等价/ 于/ 图灵机/ ./ 定义/ 1/ 中/ ,/ 根据/ 存储/ 功能/ 的/ 不同/ ,/ 定义/ 了/ 多条/ 工作/ 带/ ,/ 显然/ ,/ CRM/ 是/ 多/ 带/ 图灵机/ ,/ 而/ 多/ 带/ 图灵机/ 与/ 图灵机/ 等价/ ,/ 因此/ ,/ CRM/ 等价/ 于/ 图灵机/ ./ (/ 2/ )/ CRM/ 等价/ 于/ 通用/ 图灵机/ ./ 设/ R1/ ,/ R2/ ,/ R3/ ,/ R4/ 分别/ 表示/ C/ 每次/ 计算/ 时/ 的/ 事件/ 字母表/ 、/ 知识/ 字母表/ 、/ 结果/ 字母表/ 和/ 流程/ 字母表/ ./ 图灵机/ M/ 被/ 定义/ 为/ 一个/ 七元/ 组/ ,/ M/ 的/ 格局/ 由/ 当前/ 状态/ 、/ 当前/ 带/ 内容/ 和/ 读写/ 头/ 的/ 位置/ 构成/ ./ 计算/ 过程/ 中/ ,/ 根据/ 转移/ 函数/ δ/ 描述/ 的/ 规则/ ,/ M/ 从/ 一个/ 格局/ 转换/ 到/ 另/ 一个/ 格局/ ,/ 因此/ ,/ 图灵机/ 的/ 本质/ 是/ 一个/ 算法/ 或/ 函数/ ,/ 给定/ 一个/ 输入/ 数据/ x/ ,/ 可/ 计算/ 出/ f/ (/ x/ )/ ./ 也就是说/ ,/ M/ 相当于/ 一个/ 专用机/ ,/ 进行/ 一种/ 特定/ 的/ 计算/ ./ 而/ 每/ 一个/ 协同/ 任务/ 就是/ 要/ CRM/ 根据/ 编制/ 的/ 流程/ 完成/ 一次/ 特定/ 的/ 计算/ ./ 通过/ 流程/ 字母表/ R4/ 编制/ 的/ 流程/ 确定/ 一个/ 算法/ Mi/ ./ 给定/ R1/ ,/ R2/ ,/ 根据/ 算法/ Mi/ 制定/ 转移/ 函数/ δ/ 的/ 规则/ ,/ C/ 从/ 一个/ 格局/ 转到/ 另/ 一个/ 格局/ ,/ 因此/ ,/ 算法/ Mi/ 实际/ 就是/ 一个/ 图灵机/ ./ 也就是说/ ,/ 每个/ 协同/ 任务/ 对应/ 一个/ 流程/ ,/ 而/ 每个/ 流程/ 对应/ 着/ 一个/ 图灵机/ ./ 因此/ ,/ 图灵机/ Mi/ 对/ 输入/ (/ R1/ ,/ R2/ )/ 的/ 计算/ 等同于/ CRM/ 对/ 数组/ (/ R1/ ,/ R2/ ,/ R4/ )/ 的/ 计算/ ./ 即/ CRM/ 输入/ 任何/ 图灵机/ Mi/ 的/ 编码/ ,/ CRM/ 都/ 可以/ 仿真/ Mi/ 的/ 计算/ ,/ CRM/ 相当于/ Mi/ 的/ 解释器/ ,/ 所以/ ,/ CRM/ 等价/ 于/ 一个/ 通用/ 图灵机/ (/ 可以/ 完成/ 任意/ 的/ 协同/ 任务/ )/ ./ 根据/ 定理/ 1/ ,/ 我们/ 构建/ 的/ 协同/ 联动/ 模型/ CRM/ 是/ 一个/ 通用/ 计算/ 模型/ ./ 为了/ 能够/ 物理/ 实现/ CRM/ ,/ 下面/ 分别/ 从/ 使用者/ (/ 包括/ 一般/ 的/ 用户/ 和/ 系统/ 开发人员/ )/ 和/ 系统结构/ 的/ 角度/ 进一步/ 阐述/ ./ 2.3/ 模型/ 层次结构/ 如图/ 1/ 划分/ 为/ 操作/ 层/ 、/ 系统/ 层/ 和/ 物理/ 设备/ 层/ ./ 从/ 使用者/ 角度/ ,/ 协同/ 联动/ 模型/ 表现/ 为/ 层次结构/ ,/ (/ 1/ )/ 操作/ 层/ ,/ 直接/ 面向/ 一般/ 的/ 操作/ 人员/ ,/ 由/ 以下/ 相关/ 概念/ 来/ 定义/ ./ 定义/ 2/ ./ 操作/ 语言/ ./ 是/ 面向/ 一般/ 操作/ 人员/ 定义/ 的/ 一组/ 语法/ 规则/ ./ 借助/ 这组/ 语法/ 规则/ ,/ 使用者/ 直接/ 操/ Page4/ 定义/ 4/ ./ 操作/ 流程/ ./ 指/ 操作/ 人员/ 根据/ 要/ 完成/ 的/ 协同/ 联动/ 任务/ ,/ 按照/ 操作/ 语言/ 的/ 语法/ 规则/ ,/ 组合/ 起来/ 的/ 一系列/ 操作/ 指令/ ./ 每/ 一条/ 指令/ 指示/ 了/ 协同/ 联动/ 系统/ 的/ 每/ 一步/ 行为/ ./ 员/ ,/ 由/ 以下/ 几个/ 概念/ 定义/ ./ (/ 2/ )/ 系统/ 层/ 主要/ 面向/ 协同/ 联动/ 系统/ 的/ 开发/ 人/ 定义/ 5/ ./ 系统/ 语言/ ./ 指/ 协同/ 联动/ 系统/ 的/ 各/ 组成/ 设备/ 可/ 直接/ 识别/ 和/ 解读/ 的/ 一组/ 语法/ 规则/ ./ 操作/ 指令系统/ 中/ 的/ 每条/ 指令/ 在/ 系统/ 语言/ 的/ 语法/ 规则/ 下/ 都/ 有/ 若干条/ 系统/ 指令/ 与/ 之/ 对应/ ./ 下/ ,/ 最/ 基本/ 指令/ 的/ 集合/ ./ 定义/ 6/ ./ 系统/ 指令集/ ./ 在/ 系统/ 语言/ 的/ 语法/ 框架/ 定义/ 7/ ./ 系统/ 流程/ ./ 在/ 系统/ 语言/ 的/ 语法/ 框架/ 下/ ,/ 按照/ 协同/ 联动/ 模型/ 要/ 完成/ 任务/ 的/ 逻辑/ 顺序/ 组合/ 起来/ ,/ 系统/ 可/ 直接/ 执行/ 的/ 系统/ 指令/ 集合/ ./ (/ 3/ )/ 物理/ 设备/ 层/ ,/ 是/ 构建/ 协同/ 联动/ 系统/ ,/ 执行/ 协作/ 协同/ 联动/ 系统/ ,/ 并/ 准确/ 完成/ 相应/ 的/ 操作/ 任务/ ./ 为/ 便于/ 操作/ 人员/ 使用/ ,/ 操作/ 语言/ 尽量/ 采用/ 简单/ 指令/ 或/ 图形界面/ 化/ 的/ 形式/ 实现/ ./ 定义/ 3/ ./ 操作/ 指令集/ ./ 在/ 操作/ 语言/ 的/ 语法/ 框架/ 下/ ,/ 定义/ 的/ 一组/ 指示/ 协同/ 联动/ 系统/ 完成/ 各种/ 基本操作/ 动作/ 的/ 指令/ ./ 多条/ 操作/ 指令/ 按/ 工作/ 流程/ 组合/ 起来/ ,/ 以/ 完成/ 一定/ 协同/ 联动/ 任务/ ./ 每条/ 指令/ 也/ 可/ 单独/ 使用/ ,/ 执行/ 指定/ 的/ 操作/ 行为/ ./ 指令/ 由/ 操作码/ 和/ 变量/ 码/ 组成/ ./ 操作码/ ,/ 指示/ 协同/ 联动/ 系统/ 进行/ 基本/ 的/ 操作/ 动作/ ;/ 变量/ 码/ ,/ 表示/ 操作/ 指令/ 的/ 执行/ 对象/ 以及/ 操作/ 对象/ 的/ 存储/ 位置/ ./ 同/ 联动/ 任务/ 的/ 各种/ 物理/ 设备/ 的/ 总称/ ./ 在/ 上述/ 模型/ 中/ ,/ 操作/ 语言/ 是/ 源语言/ ,/ 系统/ 语言/ 是/ 目标语言/ ./ 操作/ 人员/ 通过/ 操作/ 语言/ 下达/ 的/ 指令/ 和/ 编写/ 的/ 操作/ 流程/ 要/ 翻译/ 为/ 系统/ 语言/ 语法/ 框架/ 下/ 的/ 系统/ 指令/ 和/ 系统/ 流程/ ,/ 以/ 驱动/ 物理/ 设备/ 层/ 的/ 各/ 组成/ 设备/ ./ 也/ 可以/ 直接/ 用/ 系统/ 语言/ 编写/ 系统/ 流程/ 完成/ 协同/ 分析/ 任务/ ./ 2.4/ 模型/ 系统结构/ 根据/ 协同/ 联动/ 模型/ 的/ 形式/ 定义/ ,/ 构建/ 模型/ 系统结构/ ./ 如图/ 2/ 所示/ ,/ 其/ 结构/ 由/ 以下/ 各/ 系统/ 部件/ 组成/ ./ (/ 1/ )/ 接口/ 系统/ (/ InterfaceSystem/ ,/ IS/ )/ ./ 是/ 协同/ 联动/ 系统/ 与/ 外界/ 信息/ 交互/ 的/ 中转站/ ./ 需要/ 协同/ 的/ 数据/ 一般/ 来自/ 各种/ 网络安全/ 设备/ ,/ 也/ 可能/ 是/ 合作/ 组织/ 或/ 个人/ 提供/ 的/ 网络/ 事件/ 信息/ ,/ 数据/ 传输方式/ 各不相同/ ,/ 而且/ 数据格式/ 和/ 存储/ 形式各异/ ./ 接口/ 系统/ 兼容/ 多种/ 通信/ 方式/ ,/ 并/ 统一/ 不同/ 来源/ 的/ 异构/ 数据格式/ ./ 识/ ./ 比如/ 域名/ 监测/ 设备/ 提供/ 的/ DNS/ 解析/ 信息/ ./ 流程/ 单元/ ./ 存储/ 操作/ 人员/ 根据/ 要/ 完成/ 的/ 协同/ 分析/ 任务/ ,/ 通过/ 操作/ 语言/ 或/ 系统/ 语言/ 编写/ 的/ 工作/ 流程/ ./ 每个/ 流程/ 设定/ 编码/ ./ 结果/ 单元/ ./ 存储/ 协同/ 联动/ 任务/ 的/ 执行/ 结果/ ./ 可/ (/ 2/ )/ 存储/ 部件/ (/ StorageComponent/ )/ ./ 根据/ 协同/ 模型/ 形式/ 定义/ 中/ 的/ 不同/ 工作/ 带/ ,/ 存储/ 部件/ 按/ 功能/ 包括/ 事件/ 单元/ 、/ 知识/ 单元/ 、/ 流程/ 单元/ 、/ 结果/ 单元/ 等/ 几/ 部分/ ./ 每个/ 存储单元/ 的/ 功能/ 如下/ :/ 事件/ 单元/ ./ 用于/ 存储/ 外界/ 提供/ 的/ 网络安全/ 事件/ 信息/ ./ 外界/ 数据/ 通过/ 接口/ 系统/ 将/ 信息/ 标准化/ 后/ ,/ 送到/ 事件/ 单元/ 中/ ./ 协同/ 联动/ 引擎/ 可/ 直接/ 访问/ 事件/ 单元/ ,/ 按照/ 工作/ 流程/ 操作/ 事件/ 单元/ 中/ 数据/ ,/ 并/ 将/ 结果/ 存入/ 结果/ 单元/ 中/ ./ 知识/ 单元/ ./ 存储/ 协同/ 联动/ 过程/ 中所/ 需/ 的/ 专家/ 知/ 随时/ 通过/ 输出设备/ 展示/ 结果/ 单元/ 中/ 的/ 数据/ ./ (/ 3/ )/ 协同/ 联动/ 引擎/ (/ CoordinativeRunningEngine/ ,/ CRE/ )/ 是/ 协同/ 联动/ 模型/ 的/ 核心部件/ ./ 将/ 操作/ 人员/ 下达/ 的/ 指令/ 解释/ 为/ 协同/ 联动/ 系统/ 可/ 识别/ 的/ 系统/ 语言/ ,/ 并/ 按照/ 流程/ 或/ 指令/ 调度/ 、/ 协同/ 各/ 存储/ 部件/ 中/ 的/ 信息/ ./ 工作/ 过程/ 分为/ 接受/ 指令/ (/ receive/ )/ 、/ 解码/ 翻译/ (/ decode/ )/ 、/ 执行/ 流程/ (/ execute/ )/ 、/ 结果/ 存入/ (/ write/ -/ back/ )/ 4/ 个/ 阶段/ ./ 接受/ 指令/ ./ CRE/ 可/ 直接/ 接受/ 操作/ 人员/ 通过/ 输入/ 设备/ 传入/ 的/ 操作/ 指令/ ,/ 或/ 调用/ 流程/ 单元/ 中/ 的/ 操作/ 流程/ ./ 解码/ 翻译/ ./ CRE/ 接受/ 操作/ 指令/ 后/ ,/ 首先/ 按照/ 操作/ 语言/ 的/ 语法/ 规则/ 对/ 每条/ 指令/ 解码/ ,/ 解析/ 出/ 操作码/ Page5/ 和/ 变量/ 码/ ;/ 然后/ 根据/ 系统/ 语言/ 的/ 语法/ 框架/ 把/ 解码/ 后/ 的/ 指令/ 翻译成/ 系统/ 可/ 识别/ 的/ 若干条/ 系统/ 指令/ ;/ 最后/ 组合/ 系统/ 指令/ ,/ 编写/ 系统/ 流程/ 进入/ 执行/ 流程/ 阶段/ 或/ 设定/ 系统/ 流程/ 编码/ 存入/ 流程/ 单元/ ./ 执行/ 流程/ ./ 解码/ 翻译/ 后/ 的/ 系统/ 流程/ 可/ 直接/ 执行/ ,/ 或者/ 在/ 操作/ 人员/ 的/ 指令/ 下/ 按/ 编号/ 运行/ 流程/ 单元/ 中/ 的/ 系统/ 流程/ ./ 结果/ 存入/ ./ 将/ 各/ 协同/ 联动/ 任务/ 的/ 执行/ 结果/ 写入/ 结果/ 单元/ 中/ ,/ 按照/ 工作/ 流程/ 编码/ ,/ 保存/ 执行/ 结果/ ,/ 以供/ 在/ 输出设备/ 上/ 展示/ ./ (/ 4/ )/ 输入/ 设备/ (/ InputDevice/ )/ ./ 它/ 是/ 操作/ 人员/ 与/ 协同/ 联动/ 系统/ 通信/ 的/ 桥梁/ ,/ 操作/ 人员/ 通过/ 输入/ 设备/ 向/ 系统/ 输入/ 指令和数据/ ./ (/ 5/ )/ 输出设备/ (/ OutputDevice/ )/ ./ 输出/ 或/ 展示/ 操作/ 人员/ 的/ 指令/ 或/ 流程/ 的/ 执行/ 结果/ ./ 3/ 协同/ 联动/ 系统/ 基于/ 协同/ 联动/ 模型/ ,/ 我们/ 实现/ 了/ 一个/ 开放/ 、/ 通用/ 和/ 易/ 扩展/ 的/ 协同/ 联动/ 系统/ (/ CoordinativeRunningSystem/ ,/ CRS/ )/ ,/ 应用/ 于/ 基础/ 网络/ 的/ 监测/ 环境/ 中/ ./ 3.1/ 存储/ 部件/ 各种/ 数据库/ 或/ 文件系统/ 等/ 都/ 可以/ 实现/ 存储/ 部件/ ./ 针对/ 骨干网/ 的/ 海量/ 信息/ ,/ 我们/ 采用/ 了/ 具有/ 强大/ 数据处理/ 能力/ 的/ 大型/ 关系/ 数据库系统/ 作为/ 主要/ 存储/ 部件/ ,/ 各/ 存储单元/ 根据/ 不同/ 的/ 存储/ 功能/ 分别/ 由/ 不同/ 的/ 数据库/ 实现/ ./ 为/ 便于/ 寻址/ 和/ 易于/ 扩展/ ,/ 将/ 数据表/ 看作/ 可/ 操作/ 的/ 最小/ 存储/ 单位/ ,/ 定义/ 为/ 存储资源/ ,/ 并/ 通过/ 存储/ 向量/ 描述/ :/ 〈/ MNum/ ,/ Unit/ ,/ DBType/ ,/ Host/ ,/ User/ ,/ PWD/ ,/ TNS/ ,/ DBName/ ,/ Table/ 〉/ ./ 各/ 分量/ 含义/ 分别/ 为/ 存储资源/ 编号/ 、/ 存储/ 部件/ 类型/ 、/ 对应/ 数据库/ 的/ 类型/ (/ 如/ ORACLE/ 、/ DB2/ 等/ )/ 、/ 数据库/ 主机/ IP地址/ 、/ 用户名/ 、/ 用户/ 密码/ 、/ ORACLE/ 连接/ 选项/ 、/ 数据库/ 名/ 、/ 数据表/ 名/ ./ 其中/ TNS/ 是/ ORACLE/ 连接/ 时/ 使用/ 的/ 选项/ ,/ 对/ 其它/ 类型/ 数据库/ 填写/ NULL/ 即可/ ./ 为了/ 能/ 快速/ 寻址/ ,/ 高效/ 维护/ 存储资源/ ,/ 采用/ 链表/ 结构/ 组织/ 存储/ 向量/ ,/ 构成/ 存储/ 地址/ 表/ ,/ 通过/ MNum/ 快速/ 连接/ 数据库/ ,/ 定位/ 到/ 相应/ 数据表/ ./ 3.2/ 接口/ 系统/ 口/ 系统/ 采用/ 模块化/ 设计/ 结构/ ,/ 如图/ 3/ 所示/ ./ 为了/ 兼容/ 多种/ 通信协议/ 和/ 异构/ 的/ 数据格式/ ,/ 接/ CRS/ 从/ 外部设备/ 接收数据/ 时/ ,/ 协议/ 代理/ 根据/ 不同/ 通信协议/ 和/ 连接/ 方式/ (/ 主动/ 获取/ 或/ 被动/ 接收/ )/ 调用/ 相应/ 协议/ 代理/ 模块/ 建立/ 数据传输/ 信道/ ./ 接收/ 的/ 数据/ 临时/ 存入/ 数据/ 区/ ./ 格式/ 解析/ 部分/ 读取数据/ 区中/ 的/ 数据/ ,/ 根据/ 不同/ 数据格式/ ,/ 应用/ 不同/ 格式/ 解析/ 模块/ ,/ 数据/ 转换/ 为/ CRS/ 定义/ 的/ 标准/ 数据格式/ ./ 系统/ 向/ 外部/ 输出/ 数据/ 时/ 与/ 上述/ 过程/ 相反/ ./ 为了/ 对/ 外部设备/ 统一/ 管理/ ,/ 接口/ 系统/ 定义/ 了/ 外设/ 资源/ 向量/ :/ 〈/ DNum/ ,/ Protocol/ ,/ Host/ ,/ User/ ,/ PWD/ ,/ Format/ 〉/ ./ 各/ 分量/ 分别/ 表示/ 外设/ 资源/ 编号/ 、/ 外部设备/ 的/ 通信协议/ 、/ 外部设备/ IP地址/ 、/ 通信协议/ 使用/ 的/ 用户名/ 和/ 密码/ 以及/ 外部设备/ 使用/ 的/ 数据格式/ ./ 与/ 某/ 外设/ 交互/ 数据/ 时/ ,/ 通过/ 外设/ 的/ 唯一/ 标识/ DNum/ 即可/ 快速/ 与其/ 建立/ 连接/ ,/ 通过/ 向量/ 中/ 的/ Protocol/ 和/ Format/ 可/ 便捷/ 地/ 匹配/ 某/ 外部设备/ 需要/ 的/ 通信协议/ 代理/ 模块/ 和/ 数据格式/ 解析/ 模块/ ./ 所有/ 的/ 外设/ 资源/ 向量/ 构成/ 外设/ 资源/ 表/ ./ 3.3/ 协同/ 联动/ 引擎/ 协同/ 联动/ 引擎/ 是/ 系统/ 的/ 核心部件/ ,/ 解析/ 操作/ 指令/ ,/ 并/ 翻译/ 为/ 系统/ 可/ 识别/ 的/ 系统/ 语言/ ./ 为了/ 便于/ 一般/ 使用/ 人员/ 的/ 操作/ ,/ 我们/ 设计/ 了/ 一个/ 简单/ 易用/ 的/ 脚本语言/ CADL/ (/ CollaborativeAnalysisDescriptionLanguage/ )/ 作为/ 系统/ 的/ 操作/ 语言/ ./ 操作/ 指令/ 由/ 基本/ 指令/ 和/ 扩展/ 指令/ 两/ 部分/ 构成/ ./ 基本/ 指令/ 是/ 协同/ 联动/ 最/ 常用/ 指令/ ,/ 分/ 协同/ 分析/ 指令/ 、/ 数据/ 交互/ 指令/ 和/ 调度/ 指令/ 三类/ ./ 协同/ 分析/ 指令/ 通过/ 对/ 存储/ 部件/ 的/ 操作/ 完成/ 主要/ 的/ 协同/ 分析/ 工作/ ;/ 数据/ 交互/ 指令/ 负责/ 协调系统/ 与/ 外设/ 通过/ 接口/ 系统/ 的/ 数据/ 交互/ ;/ 调度/ 指令/ 协调/ 工作/ 流程/ 的/ 执行/ 情况/ ./ 当有/ 特定/ 的/ 或/ 特别/ 复杂/ 的/ 协同/ 分析/ 任务/ 时/ ,/ 需要/ 为/ 其/ 定制/ 专门/ 指令/ ,/ 也/ 就是/ 扩展/ 指令/ ./ 表/ 1/ 中/ 列出/ 了/ 典型/ 的/ 基本操作/ 指令/ ./ 以/ 操作/ 指令/ 为例/ ,/ CADL/ 的/ 文法/ 用/ 巴克斯/ 范式/ (/ BNF/ )/ 描述/ 如下/ :/ 〈/ 操作/ 指令/ 〉/ ∷/ =/ 〈/ 操作码/ 〉/ :/ 〈/ 变量/ 码/ 〉/ ;/ Page6/ 〈/ 操作码/ 〉/ ∷/ =/ 〈/ 关键字/ 〉/ ;/ 〈/ 变量/ 码/ 〉/ ∷/ =/ 字符串/ |/ 〈/ 值/ 〉/ ;/ 〈/ 关键字/ 〉/ ∷/ =/ Table/ _/ Create/ |/ Table/ _/ Remove/ |/ Index/ _/ Creat/ |/ Index/ _/ Remove/ |/ Read/ _/ Write/ |/ Redun/ _/ Rem/ |/ …/ …/ ;/ 由于/ 存储/ 部件/ 的/ 功能/ 由/ 数据库系统/ 担任/ ,/ 并考/ 〈/ 值/ 〉/ ∷/ =/ 字符串/ 或/ 数字/ ./ 表/ 1/ 典型/ 操作/ 指令/ MNum1/ :/ 需要/ 去/ 重/ 的/ 数据表/ 对应/ 的/ 存储资源/ 编号/ ./ 协同/ 分析/ 指令/ 数据/ 交互/ 指令/ 调度/ 指令/ 4/ 相关/ 工作/ 比较/ 与/ 分析/ 多/ 种类/ 安全设备/ 协同工作/ 的/ 典型/ 系统/ 有/ UTM/ 和/ SOC/ [/ 7/ ]/ 等/ ./ UTM/ 将/ 防火墙/ 、/ 入侵/ 检测/ 、/ 网关/ 防病毒/ 等/ 集成/ 在/ 一起/ ,/ 是/ 一种/ 集成型/ 网关/ 设备/ ./ 与/ 本文/ 的/ 协同/ 联动/ 模型/ 在/ 形式/ 和/ 实质/ 上/ 都/ 完全/ 不同/ ./ SOC/ 协同/ 管理/ 多种/ 安全设备/ ,/ 但/ 目前/ 业界/ 对/ SOC/ 还/ 没有/ 形成/ 统一/ 的/ 理解/ ,/ SOC/ 的/ 实现/ 方式/ 也/ 各不相同/ ./ 其/ 一般/ 模型/ 的/ 定位/ 是/ 采用/ 划分/ 安全/ 域/ 的/ 思想/ ,/ 以/ 资产/ 为/ 核心/ 的/ 一套/ 资产/ 风险/ 模型/ ./ SOC/ 与/ 本文/ 提出/ 的/ 协同/ 联动/ 系统/ 有/ 相似/ 的/ 逻辑/ 架构/ ,/ 但/ 二者/ 有/ 本质区别/ ./ 虑/ 到/ 系统/ 的/ 执行/ 效率/ ,/ 采用/ SQL/ 和/ C语言/ 作为/ 系统/ 语言/ ./ 一条/ 操作/ 指令/ 的/ 功能/ 由/ 一段/ SQL/ 和/ C语言/ 程序实现/ ,/ 并/ 封装/ 成/ 函数/ ./ 在/ 解码/ 翻译/ 阶段/ ,/ 解析/ 操作/ 指令/ ,/ 调用/ 该/ 指令/ 对应/ 的/ 系统/ 语言/ 中/ 的/ 函数/ ./ 一段/ CADL/ 编写/ 的/ 操作/ 流程/ ,/ 经/ 解码/ 后/ ,/ 翻译/ 为/ 若干段/ SQL/ 和/ C语言/ 程序/ 构成/ 的/ 系统/ 流程/ ./ SOC/ 是/ 协助/ 管理员/ 进行/ 事件/ 分析/ 、/ 风险/ 分析/ 、/ 预警/ 管理/ 和/ 应急/ 响应/ 处理/ 的/ 集中/ 安全/ 管理系统/ ./ 其/ 根本/ 模型/ 是/ PDR/ 模型/ ./ 在/ 一个/ 安全/ 域/ 内/ 针对/ 不同/ 时间/ 、/ 不同/ 位置/ 的/ 离散/ 单一/ 安全事件/ 进行/ 收集/ 、/ 汇总/ 、/ 过滤/ 和/ 关联/ 分析/ 以/ 形成/ 统一/ 的/ 安全/ 决策/ ,/ 对/ 事件/ 进行/ 响应/ 和/ 处理/ ,/ 实现/ 全域/ 的/ 资产/ 风险管理/ ./ 本文/ 提出/ 的/ 协同/ 联动/ 模型/ 是/ 一个/ 开放式/ 的/ 、/ 以/ 图灵机/ 模型/ 为/ 基础/ 的/ 抽象/ 计算/ 模型/ ,/ 在/ 互联网/ 空间/ 追踪/ 和/ 分析/ 大规模/ 网络安全/ 事件/ ./ 主要/ 是/ 协同/ 不同/ 种类/ 的/ 互联网/ 设备/ ,/ 以/ 这些/ 设备/ 提供/ 的/ 海量/ 信息/ 为/ 数据源/ ,/ 分析/ 危害/ 网络空间/ 的/ 大规模/ 网络安全/ 事件/ ./ 表/ 2/ 列出/ 了/ 二者/ 的/ 比较/ ./ Page7/ 面向对象/ 开放/ 的/ 互联网/ 空间/ 基础/ 模型/ 图灵机/ 计算/ 模型/ 数据/ 来源/ 分布/ 在/ 互联网/ 的/ 各种/ 安全/ 主要/ 目的/ 事件/ 的/ 分析/ 、/ 挖掘/ 通用性/ 可/ 根据/ 不同/ 的/ 分析/ 任务/ ,/ 编/ 操作/ 方式/ 编制工作/ 流程/ ,/ 需要/ 学习/ SOC/ 按照/ 一个/ 大/ 的/ 规则/ 库来/ 管理/ 安全/ 域/ ,/ 是/ 一套/ 专家系统/ ,/ 存储/ 了/ 大量/ 规则/ ,/ 但/ 数量/ 有限/ ,/ 有些/ 规则/ 没有/ 被/ 存储/ ,/ 这些/ 规则/ 涉及/ 到/ 的/ 安全事件/ ,/ SOC/ 无能为力/ ./ 而/ 基于/ 图灵机/ 的/ 协同/ 联动/ 模型/ 根据/ 不同/ 的/ 协同/ 任务/ 定制/ 不同/ 的/ 工作/ 流程/ ,/ 应用/ 计算/ 概念/ ,/ 是/ 一种/ 用/ 有限/ 来/ 应对/ 无限/ 的/ 方法/ ./ 此外/ ,/ 协同/ 联动/ 系统/ 完成/ 一次/ 协同/ 联动/ 任务/ 实质/ 是/ 通用/ 图灵机/ 进行/ 了/ 一次/ 计算/ ,/ 需要/ 考虑/ 图灵机/ 进入/ 停机/ 状态/ 的/ 时间/ ,/ 即/ 需要/ 多长时间/ 完成/ 协同/ 任务/ 才能/ 有/ 实际/ 应用/ 价值/ ./ 因此/ ,/ 协同/ 联动/ 系统/ 在/ 执行/ 不同/ 的/ 协同/ 任务/ 时/ ,/ 要/ 根据/ 相应/ 环境/ 和/ 不同/ 的/ 应用/ 做/ 效率/ 上/ 的/ 优化/ ./ 这/ 就/ 需要/ 我们/ 在/ 设计/ 操作/ 语言/ 和/ 系统/ 语言/ 时/ 考虑/ 执行/ 效率/ 的/ 优化/ 功能/ ./ 5/ 应用/ 实例/ 这个/ 协同/ 任务/ 要求/ 协同/ 3/ 种/ 不同/ 类型/ 的/ 设备/ ,/ 为了/ 验证/ 本文/ 基于/ 通用/ 图灵机/ 建立/ 的/ 协同/ 联动/ 模型/ CRM/ 和/ 协同/ 联动/ 系统/ CRS/ 的/ 自动/ 协同/ 联动/ 能力/ ,/ 本/ 节/ 分析/ 了/ CRS/ 在/ 国家/ 基础/ 网络/ 的/ 安全/ 应用/ 中/ 3/ 个/ 典型/ 实例/ ,/ 并/ 给出/ 每个/ 实例/ 基于/ 通用/ 图灵机/ 的/ 形式化/ 描述/ ./ 5.1/ 僵尸/ 网络/ 的/ 检测/ 和/ 追踪/ 是/ 一个多元/ 协同/ 联动/ 任务/ ./ 5.1/ ./ 1/ 任务/ 概述/ 僵尸/ 网络/ [/ 12/ ]/ 是/ 目前/ 互联网安全/ 的/ 一个/ 严重威胁/ ./ 采用/ IRC/ 和/ HTTP/ 协议/ 通信/ 的/ 集中式/ 僵尸/ 网络/ [/ 13/ ]/ 一般/ 通过/ DNS/ 实现/ 控制/ 服务器/ 与/ 受控/ 主机/ 间/ 的/ 联系/ ,/ 并/ 经常/ 通过/ 更换/ 控制/ 服务器/ 域名/ 和/ IP/ 的/ 迁移/ 机制/ [/ 14/ ]/ 来/ 躲避/ 检测/ ./ 因此/ ,/ 同一个/ 僵尸/ 网络/ 的/ 服务器/ 域名/ 和/ IP/ 在/ 不同/ 时刻/ 可能/ 会/ 不/ 相同/ ./ 另外/ ,/ 僵尸/ 网络/ 成员/ 也/ 在/ 动态变化/ [/ 15/ ]/ ,/ 一些/ 受控/ 主机/ 可能/ 摆脱/ 僵尸/ 网络/ 的/ 控制/ ,/ 或者/ 有/ 新/ 的/ 受控/ 成员/ 加入/ ./ 为了/ 更好/ 地/ 检测/ 和/ 追踪/ 集中式/ 僵尸/ 网络/ 的/ 控制/ 服务器/ 和/ 受控/ 端/ 主机/ ,/ 协同/ 了/ 以下/ 几个/ 设备/ 共同/ 分析/ 僵尸/ 网络/ 行为/ ./ (/ 1/ )/ 网络/ 报文/ 监测/ 系统/ ./ 国家/ 网络安全/ 监测/ 平台/ (/ 863/ -/ 917/ 平台/ )/ [/ 16/ ]/ ,/ 实时/ 检测/ 互联网/ 中/ 特定/ 的/ 安全事件/ ,/ 提供/ 恶意代码/ 的/ 受控/ 主机/ IP/ 、/ 服务器/ IP/ 和/ 通信/ 时间/ 等/ 信息/ ./ (/ 2/ )/ DNS/ 监测/ 系统/ ./ 记录/ 国内/ 各/ 服务器/ 的/ 域名解析/ 信息/ ./ (/ 3/ )/ 流/ 监测/ 系统/ ./ 提供/ 指定/ IP/ 与/ 互联网/ 其它/ 主机/ 通信/ 的/ 数据流/ 信息/ ./ 协同/ 过程/ 如图/ 4/ 所示/ :/ (/ 1/ )/ 报文/ 监测/ 系统/ 根据/ 僵尸/ 程序/ 特征/ 码/ 捕获/ 活跃/ 的/ 僵尸/ 程序/ 样本/ ,/ 并/ 发现/ 控制/ 端/ IP地址/ ;/ (/ 2/ )/ DNS/ 监测/ 系统/ 通过/ 监测/ 到/ 的/ IP/ 、/ 域名/ 对应/ 关系/ ,/ 根据/ IP/ 提供/ 该/ 僵尸/ 网络/ 控制/ 端/ 域名/ ;/ (/ 3/ )/ DNS/ 监测/ 系统/ 进一步/ 匹配/ 一段时间/ 内/ 与/ 控制/ 端/ 域名/ 对应/ 的/ 所有/ IP/ ,/ 给出/ 控制/ 端/ IP/ 列表/ ;/ (/ 4/ )/ 将/ 控制/ 端/ IP/ 列表/ 与/ 该/ 时间段/ 内/ 流/ 监测/ 系统日志/ 关联/ ,/ 获得/ 与/ 僵尸/ 网络/ 控制/ 端/ 通信/ 的/ 受控/ 僵尸/ 主机/ IP地址/ 列表/ ./ 定时/ 重复/ 执行/ 上述/ 过程/ ,/ 可以/ 获得/ 更/ 多/ 的/ 控制/ 服务器/ IP/ 和/ 受控/ 主机/ IP/ ,/ 追踪/ 、/ 分析/ 集中式/ 僵尸/ 网络/ 在/ 不同/ 时间/ 的/ 变化/ 状况/ ./ 5.1/ ./ 2/ 流程/ 设计/ 根据/ 这个/ 协同/ 任务/ ,/ 规划/ 操作/ 流程/ 如表/ 3/ 所示/ ./ 通过/ c/ ,/ d/ 消除/ 原始数据/ 中/ 冗余/ 信息/ ;/ 通过/ e/ ,/ f/ 建立/ 存储/ 索引/ ,/ 提高/ 对/ 存储资源/ 的/ 搜索/ 效率/ ./ 操作/ 人员/ 按照/ 表/ 3/ 中/ 各/ 步骤/ ,/ 通过/ CADL/ 语法/ 编写/ 操作/ 流程/ ,/ 存入/ 流程/ 单元/ ,/ 协同/ 联动/ 引擎/ 将/ 其/ 翻译/ 为/ 系统/ 流程/ 并/ 执行/ ./ 操作/ 人员/ 也/ 可/ 单步/ 执行/ 操作/ 流程/ 中/ 的/ 语句/ ,/ 逐步/ 完成/ 协同/ 分析/ 任务/ ./ Page8/ 表/ 3/ 僵尸/ 网络/ 协同/ 分析/ 操作/ 流程/ 步骤/ 操作码/ aInputDNum1/ ,/ MNum1/ 将/ 报文/ 监测/ 系统/ 提供/ 的/ 僵尸/ 网络/ 控制/ 端/ IP/ 信息/ 写入/ 事件/ 单元/ 的/ 存储资源/ MNum1/ 中/ ./ bInputDNum2/ ,/ MNum2/ 将/ DNS/ 监控/ 系统/ 提供/ 的/ 域名/ 、/ IP/ 对应/ 信息/ 写入/ 知识/ 单元/ 的/ 存储资源/ MNum2/ 中/ ./ cRedun/ _/ RemMNum1/ ,/ Field1/ ,/ dRedun/ _/ RemMNum2/ ,/ Field1/ ,/ eIndex/ _/ CreatMNum3/ ,/ Name/ _/ Index1/ ,/ fIndex/ _/ CreatMNum4/ ,/ Name/ _/ Index2/ ,/ gRead/ _/ WritehRead/ _/ WriteiRead/ _/ WriteMNum6/ ,/ MNum7/ ,/ jOutputMNum7/ ,/ DNum3kInputDNum3/ ,/ MNum8/ 把/ 设备/ DNum3/ (/ 数据流/ 监测/ 设备/ )/ 传过来/ 的/ 数据/ (/ 控制/ 端/ IP/ 列表/ 和/ 受控/ 端/ IP/ 列表/ )/ 写/ lIndex/ _/ CreatMNum8/ ,/ Name/ _/ Index3/ ,/ 最后/ ,/ 通过/ Schedule/ 指令/ 每隔/ 6h/ 重复/ 执行/ 这个/ 过程/ ,/ 进一步/ 追踪/ 由于/ 僵尸/ 网络/ 迁移/ 和/ 动态变化/ 产生/ 的/ 新/ 僵尸/ 网络/ 控制/ 端/ 和/ 僵尸/ 网络/ 成员/ ./ 5.1/ ./ 3/ 形式化/ 描述/ 入到/ 结果/ 单元/ 的/ MNum8/ 中/ ./ 首先/ 将/ 这个/ 任务/ 的/ 协同/ 过程/ 符号化/ ./ a/ ,/ c/ ,/ e/ 和/ b/ ,/ d/ ,/ f/ 分别/ 是/ 报文/ 监测/ 设备/ 和/ DNS/ 监控/ 系统/ 提供数据/ 的/ 写入/ 、/ 去/ 重/ 和/ 寻址/ 优化/ 3/ 个/ 步骤/ ,/ 顺序/ 不能/ 改变/ ./ g/ ,/ h/ ,/ i/ ,/ j/ ,/ k/ ,/ l/ 几个/ 步骤/ 也/ 须/ 固定/ 不变/ ./ 因此/ 这个/ 协同/ 过程/ 可以/ 译码/ 为/ 符号串/ N/ =/ (/ Kghijkl/ )/ ,/ 其中/ K/ 表示/ 分别/ 固定/ a/ ,/ c/ ,/ e/ 和/ b/ ,/ d/ ,/ f/ 两组/ 字符/ 的/ 顺序/ 后/ 的/ 6/ 个字符/ 的/ 任意/ 组合/ 构成/ 的/ 字符串/ 集合/ ./ 因此/ N/ 表示/ 了/ 这些/ 字符/ 组合/ 后/ 的/ 所有/ 字符串/ ./ 符号串/ 中/ 的/ 符号/ 取自/ 有/ 穷/ 的/ 字母表/ Σ/ ,/ 这些/ 字符串/ 就/ 构成/ 了/ 语言/ L/ ./ 所以/ ,/ 问题/ 转化/ 为/ 构造/ 一个/ 识别/ 语言/ L/ 的/ 图灵机/ M1/ ./ 最后/ 给出/ 这个/ 实例/ 中/ 图灵机/ M/ 的/ 形式/ 描述/ ./ M/ =/ (/ Q/ ,/ Σ/ ,/ Γ/ ,/ q0/ ,/ qaccept/ ,/ qreject/ ,/ δ/ )/ ,/ 其中/ :/ Q/ =/ {/ q1/ ,/ q2/ ,/ …/ ,/ q11/ ,/ qaccept/ ,/ qreject/ }/ ;/ Σ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ ,/ f/ ,/ g/ ,/ h/ ,/ i/ ,/ j/ ,/ k/ ,/ l/ }/ ;/ Γ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ ,/ f/ ,/ g/ ,/ h/ ,/ i/ ,/ j/ ,/ k/ ,/ l/ ,/ B/ }/ ;/ δ/ :/ Q/ ×/ Γ/ →/ / / δ/ Q/ ×/ Γ/ ×/ {/ L/ ,/ R/ }/ ;/ q0/ 是/ 起始/ 状态/ ;/ qaccept/ 是/ 接受/ 状态/ ;/ qreject/ 是/ 拒绝/ 状态/ ./ 开始/ 状态/ 为/ q0/ ,/ 把/ 要/ 判断/ 的/ 符号串/ 写/ 在/ 工作/ 带上/ ,/ 每格/ 写入/ 一个/ 符号/ ,/ 其余/ 空格/ 是/ 空白/ 符号/ B/ ./ 对于/ 输入/ 符号串/ N/ =/ (/ Kghijkl/ )/ ,/ 从/ 左向右/ 扫描/ ,/ 每/ 扫描/ 一个/ 符号/ 说明/ 经过/ 了/ 一次/ 协同/ 引擎/ 的/ 处理/ ,/ 解析/ 出/ 了/ 新/ 的/ 信息/ ,/ 生成/ 一个/ 新/ 的/ 状态/ qi/ ./ 状态图/ 如图/ 5/ 所示/ ./ 从/ q0/ 到/ q1/ 的/ 转移/ 记为/ a/ →/ c/ ,/ R/ ,/ 即/ 转移/ 函数/ δ/ (/ q0/ ,/ a/ )/ =/ (/ q1/ ,/ c/ ,/ R/ )/ ,/ 表示/ 当/ 状态/ 处于/ q0/ 且/ 读写/ 头读/ 符号/ a/ 时/ ,/ 机器/ 的/ 状态/ 变为/ q1/ ,/ 写下/ 符号/ c/ ,/ 并/ 向/ 右/ 移动/ 读写/ 头/ ./ 其它/ 状态/ 转移/ 与/ 此/ 类似/ ./ 为了/ 图示/ 清晰/ ,/ 图中/ 没有/ 标出/ 每个/ 状态/ 到/ 拒绝/ 状态/ 的/ 转移/ 标记/ ,/ 而且/ 单独/ 列出/ 了/ 需要/ 交叉/ 连线/ 的/ 状态/ 转移/ 标记/ ./ 5.1/ ./ 4/ 执行/ 结果/ 分析/ (/ 1/ )/ CRS/ ,/ 一个/ 时间段/ 执行/ 结果/ ./ 表/ 4/ 列出/ 了/ 某一时间/ 段/ 内/ ,/ 各/ 设备/ 提供/ 的/ 数据量/ 及/ 协同/ 联动/ 后/ 的/ 结果/ ./ CRS/ 通过/ 去/ 重/ 指令/ 有效/ 消除/ 了/ 冗余/ 信息/ ,/ DNS/ 监测/ 系统/ 的/ 数据/ 尤为/ 明显/ ,/ 消除/ 了/ 近/ 30/ %/ ./ 共/ 分析/ 出/ 10/ 万多条/ 恶意/ 主机/ IP/ ,/ 受控/ 端/ 主机/ 有近/ 6/ 千万条/ 记录/ ,/ 有效/ 地/ 分析/ 出/ 僵尸/ 网络/ 的/ 服务器/ 和/ 受控/ 主机/ 的/ 相关/ 信息/ ./ 为/ 进一步/ 验证/ 恶意/ 主机/ 信息/ 我们/ 进行/ 了/ (/ 2/ )/ 、/ (/ 3/ )/ 两步/ 观察/ 分析/ ./ Page9/ 数据/ 来源/ 863/ -/ 917/ 平台/ DNS/ 监测/ 系统/ 1829830411198870/ 恶意/ 主机/ 域名/ 恶意/ 主机/ IP/ 流/ 监控/ 返回/ 信息/ 58346396/ (/ 2/ )/ 某/ 僵尸/ 网络/ 一个/ 时间段/ 协同/ 结果/ ./ 在/ 一个/ 时间段/ 内/ ,/ 一个/ 典型/ 僵尸/ 网络/ 经过/ 协同/ 联动/ 的/ 变化/ 情况/ 如表/ 5/ 所示/ ./ CRS/ 根据/ 控制/ 端/ IP/ / ./ / ./ / ./ 46/ 发现/ 了/ 该/ 僵尸/ 网络/ 的/ 一个/ 域名/ ①/ 和/ 另/ 一个/ 控制/ 服务器/ IP/ ,/ 这/ 两个/ IP/ 都/ 与/ 12/ 万个/ 以上/ 的/ 受控/ 客户端/ 有/ 数据通信/ 行为/ ./ 控制/ 端/ IP/ 域名/ 控制/ 端/ IP/ 列表/ 受控/ 端/ IP/ 数量/ (/ 条/ )/ / ./ / ./ / ./ 46jj/ ./ / ./ / ./ su/ / ./ / ./ / ./ 71127798/ (/ 3/ )/ 某/ 僵尸/ 网络/ 多/ 时间段/ 协同/ 结果/ ./ 从表/ 6/ 中/ 看出/ ,/ 在/ 72h/ 后/ ,/ CRS/ 协同/ 出新/ 的/ 控制/ 端/ IP/ ,/ 受控/ 端/ 主机/ 的/ 数量/ 也/ 随之/ 明显增加/ ;/ 120h/ 后/ ,/ 服务器/ 的/ 域名/ 产生/ 变化/ ,/ 僵尸/ 网络/ 发生/ 了/ 迁移/ 行为/ ,/ 并且/ 受控/ 主机/ 的/ 数量/ 在/ 增加/ ;/ 在/ 240h/ 后/ ,/ 再次/ 发现/ 新/ 迁移/ 行为/ ,/ 僵尸/ 网络/ 规模/ 继续/ 扩大/ ./ 这/ 是/ 个/ 活跃/ 的/ 僵尸/ 网络/ ,/ 在/ 其/ 发展/ 过程/ 中/ ,/ 应用/ 了/ 多个/ 服务器/ IP/ ,/ 把/ 受控/ 主机/ 分成/ 多个/ 群体/ ,/ 并/ 发生/ 了/ 2/ 次/ 迁移/ ./ 一个/ 正常/ 服务器/ 不会/ 频繁/ 发生/ 更换/ 域名/ 的/ 迁移/ 行为/ ,/ 因此/ ,/ 多个/ 时间段/ 的/ 观察/ 结果/ 进一步/ 确认/ 了/ 僵尸/ 网络/ 检测/ 信息/ ./ 时间/ 控制/ 端/ IP/ 控制/ 端/ 域名/ 受控/ 端/ IP/ 数量/ (/ 条/ )/ 初始/ / ./ / ./ / ./ 78oi/ ./ / ./ / ./ net24h/ 后/ / ./ / ./ / ./ 78oi/ ./ / ./ / ./ net/ / / / / / / / / / / / / / / / / / / / / / / / 72h/ 后/ / / / / / / / / / / / / / / / / / / / / / / / 120h/ 后/ / / / / / / / / / / / / / / / / / / / / / / / 240h/ 后/ (/ 4/ )/ 效率/ 比较/ ./ CRS/ 每次/ 执行/ 这个/ 操作/ 流程/ 大约/ 需要/ 51min/ ,/ 我们/ 同时/ 比较/ 了/ 没有/ 去/ 重/ 指令/ 和/ 建/ 索引/ 指令/ 的/ 操作/ 流程/ 运行/ 时间/ ,/ 用时/ 194min/ ./ 因此/ ,/ 如/ 第/ 4/ 节/ 所述/ ,/ 只有/ 通过/ 效率/ 优化/ ,/ 考虑/ 进入/ 停机/ 状态/ 的/ 时间/ ,/ 基于/ 图灵机/ 构建/ 的/ 模型/ 才/ 有/ 实际/ 应用/ 价值/ ./ 通过/ 以上/ 4/ 个/ 方面/ 的/ 分析/ ,/ 可以/ 看出/ ,/ CRS/ 能/ 有效/ 完成/ 追踪/ 大规模/ 僵尸/ 网络/ 的/ 协同/ 联动/ 任务/ ./ 消除/ 海量/ 数据/ 的/ 冗余/ 信息/ ,/ 挖掘/ 僵尸/ 网络/ 在/ 不同/ 时间段/ 的/ 变化/ 情况/ ,/ 同时/ ,/ 也/ 为/ 确认/ 僵尸/ 网络/ 的/ 检测/ 结果/ 提供/ 了/ 有效/ 分析/ 手段/ ./ 并且/ ,/ 通过/ 高效/ 的/ 实施/ 协同/ 联动/ 任务/ ,/ 提高/ 了/ 安全事件/ 的/ 处置/ 效率/ ./ 5.2/ 大规模/ DDoS/ 攻击/ 事件/ 关联/ 个/ 网络安全/ 监测/ 设备/ 做/ 协同/ 分析/ ./ 5.2/ ./ 1/ 任务/ 概述/ 分布式/ 拒绝服务/ 攻击/ 具有/ 地理分布/ 性/ 和/ 一定/ 时间/ 延续性/ ,/ 可/ 利用/ 分布式/ 实时/ 监测/ 设备/ 检测/ DDoS/ 攻击行为/ ./ 但/ 对/ 大规模/ DDoS/ 行为/ ,/ 设备/ 上报/ 的/ 信息量/ 巨大/ ,/ 需要/ 关联/ 这些/ 信息/ ,/ 掌握/ DDoS/ 攻击/ 的/ 真实情况/ ./ 利用/ CRS/ ,/ 协同/ 分析/ 了/ 一套/ 分布式/ 网络/ 恶意/ 事件/ 这是/ 一个/ 一元/ 协同/ 任务/ ,/ 要求/ 对/ 同一/ 类型/ 的/ 几/ ①/ 通过/ Google/ 搜索/ 确认/ ,/ 该/ 域名/ 为/ 一个/ 控制/ 服务器/ 位于/ 俄罗/ Page10/ 监测/ 系统/ 上报/ 的/ DDoS/ 攻击/ ./ 这套/ 系统/ 部署/ 在/ 国内/ 几个/ 基础/ 网络/ 节点/ 和/ 国际/ 出入口/ ,/ 实时/ 上报/ 蠕虫/ 、/ 僵尸/ 网络/ 、/ 木马/ 和/ DDoS/ 等/ 各类/ 恶意/ 行为/ ./ 协同/ 步骤/ 如下/ :/ (/ 1/ )/ 提取/ 一个/ 时间段/ (/ 比如/ 24h/ )/ 的/ 各类/ 安全事件/ 原始数据/ ;/ (/ 2/ )/ 选出/ 该/ 时间段/ 内/ 的/ DDoS/ 攻击/ 事件/ 信息/ ;/ (/ 3/ )/ 时间/ 关联/ ./ 合并/ 同一/ 攻击/ 的/ 连续/ 报警/ 信息/ ,/ 表/ 7DDoS/ 去/ 重/ 分析/ 操作/ 流程/ 步骤/ 操作码/ a/ 写入/ bRead/ _/ WriteMNum9/ ,/ MNum10/ ,/ cRead/ _/ WriteMNum10/ ,/ MNum11/ ,/ dRedun/ _/ Rem/ _/ timeMNum11/ ,/ MNum12/ ,/ eRedun/ _/ Rem/ _/ spaceMNum12/ ,/ MNum13/ ,/ fRead/ _/ WriteMNum13/ ,/ MNum14MNum11/ ./ 5.2/ ./ 3/ 形式化/ 定义/ 先/ 符号化/ 这个/ 协同/ 过程/ :/ N/ =/ (/ abcdef/ )/ ,/ 符号串/ 中/ 的/ 各/ 字符/ 顺序/ 固定/ ./ 符号/ 取自/ 有/ 穷/ 的/ 字母表/ Σ/ ,/ 这个/ 字符串/ 构成/ 了/ 语言/ L/ ./ 因此/ ,/ 构造/ 一个/ 识别/ 语言/ L/ 的/ 图灵机/ M2/ ./ 开始/ 状态/ 为/ q0/ ,/ 状态图/ 如图/ 6/ 所示/ (/ 省略/ 所有/ 到/ 拒绝/ 状态/ 的/ 转移/ 标记/ )/ ./ 最后/ 给出/ 这个/ 实例/ 图灵机/ M/ 的/ 形式/ 描述/ ./ M/ =/ (/ Q/ ,/ Σ/ ,/ Γ/ ,/ q0/ ,/ qaccept/ ,/ qreject/ ,/ δ/ )/ ,/ 其中/ :/ Q/ =/ {/ q1/ ,/ q2/ ,/ q3/ ,/ q4/ ,/ qaccept/ ,/ qreject/ }/ ;/ Σ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ ,/ f/ }/ ;/ Γ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ ,/ f/ ,/ B/ }/ ;/ δ/ :/ Q/ ×/ Γ/ →/ / / δ/ Q/ ×/ Γ/ ×/ {/ L/ ,/ R/ }/ ;/ q0/ 是/ 起始/ 状态/ ;/ qaccept/ 是/ 接受/ 状态/ ;/ qreject/ 是/ 拒绝/ 状态/ ./ 5.2/ ./ 4/ 执行/ 结果/ 分析/ 为了/ 说明/ CRS/ 执行/ 这个/ 协同/ 任务/ 的/ 意义/ ,/ 我们/ 分析/ 了/ 2010/ -/ 03/ -/ 03/ 到/ 2010/ -/ 03/ -/ 108/ 天/ 的/ 运行/ 结果/ ./ 并/ 统计/ 攻击/ 的/ 数据量/ ;/ (/ 4/ )/ 空间/ 关联/ ./ 合并/ 不同/ 地点/ 的/ 监测/ 设备/ 在/ 一个/ 时间/ 间隔/ 内/ 检测/ 到/ 同一/ DDoS/ 攻击/ 信息/ ,/ 并/ 统计/ 攻击/ 的/ 总/ 数据量/ ,/ 计算/ 攻击/ 强度/ 和/ 攻击/ 规模/ ./ 5.2/ ./ 2/ 流程/ 设计/ 述/ ./ 工作/ 流程/ 如表/ 7/ 所示/ ./ 与/ 5.1/ ./ 2/ 节/ 过程/ 相似/ ,/ 限于/ 篇幅/ ,/ 本文/ 不再/ 详图/ 7/ 展示/ 了/ 关联/ 前后/ 的/ DDoS/ 攻击/ 事件/ 数量/ 的/ 变化/ 情况/ ./ 由于/ 把/ 同一/ 事件/ 的/ 信息/ 进行/ 了/ 合并/ ,/ 关联/ 后/ 明显/ 减少/ 了/ 重复/ 上报/ 的/ DDoS/ 事件/ 冗余/ 信息/ ./ 图/ 8/ 展示/ 了/ 关联/ 前后/ ,/ 每天/ 发生/ 的/ DDoS/ 攻击/ 事件/ Page11/ 中/ 最/ 大规模/ 的/ 主机/ 数量/ ./ 经过/ 关联/ ,/ 归并/ 了/ 参与/ 同/ 一次/ DDoS/ 攻击/ 事件/ 的/ 主机/ ,/ 主机/ 数量/ 显著/ 增加/ ,/ 因此/ ,/ 更/ 明确/ 了/ 一次/ DDoS/ 攻击/ 的/ 规模/ 和/ 强度/ ./ 从/ 以上/ 结果/ 可以/ 看出/ ,/ CRS/ 执行/ 的/ 这个/ 协同/ 任务/ 能/ 有效/ 地/ 从/ 不同/ 空间/ 和/ 时间/ 的/ 海量/ 安全事件/ 信息/ 中/ 关联/ 出/ 同一/ DDoS/ 攻击/ 事件/ ,/ 并/ 分析/ 出/ 攻击/ 规模/ 和/ 攻击/ 强度/ ,/ 有效/ 加强/ 了/ 大规模/ DDoS/ 攻击/ 的/ 检测/ 能力/ ,/ 为/ 掌握/ DDoS/ 攻击/ 的/ 真实情况/ 提供/ 了/ 有力/ 的/ 支持/ ./ 5.3/ 僵尸/ 网络/ 与/ DDoS/ 攻击/ 源/ 关系/ 分析/ 这个/ 任务/ 是/ 把/ 5.1/ 节/ 追踪/ 到/ 的/ 僵尸/ 网络/ 与/ 5.2/ 节/ 关联/ 出/ 的/ DDoS/ 攻击/ 源/ 主机/ 群做/ 进一步/ 关联/ 分析/ ,/ 是/ 一个二元/ 协同/ 任务/ ./ 5.3/ ./ 1/ 任务/ 概述/ DDoS/ 的/ 攻击/ 源/ 是/ 互联网/ 空间/ 内/ 的/ 大批/ 受控/ 傀儡/ 主机/ ,/ 它们/ 可能/ 隶属于/ 某一/ 僵尸/ 网络/ ./ 因此/ ,/ 有/ 必表/ 8DDoS/ 僵尸/ 网络/ 协同/ 分析/ 操作/ 流程/ 步骤/ 操作码/ aRead/ _/ WriteMNum14/ ,/ MNum15/ 读/ 结果/ 单元/ 中/ DDoS/ 事件/ 表/ MNum14/ ,/ 写入/ 知识/ 单元/ MNum15/ ./ bRead/ _/ WriteMNum8/ ,/ MNum16/ 读/ 僵尸/ 网络/ 受控/ 主机/ 表/ MNum8/ ,/ 写入/ 知识/ 单元/ MNum16/ ./ cCount/ _/ IPdCountMNum5/ ,/ MNum6/ ,/ eRead/ _/ WriteMNum7/ ,/ MNum8/ 读取/ MNum19/ ,/ 写入/ 结果/ 单元/ MNum20/ ./ C/ 类/ IP/ 段/ 的/ IP/ ,/ 写入/ MNum18/ ./ 量/ ,/ 结果/ 写入/ MNum19/ ./ 5.3/ ./ 3/ 形式化/ 定义/ 将/ 这个/ 任务/ 的/ 协同/ 过程/ 符号化/ ./ a/ ,/ b/ 两个/ 步骤/ 没有/ 先后顺序/ ./ 其余/ 步骤/ 固定/ 不变/ ./ 因此/ 这个/ 协同/ 过程/ 可以/ 译码/ 为/ 符号串/ N/ =/ (/ Kcde/ )/ ,/ 其中/ K/ 表示/ a/ ,/ b/ 或/ b/ ,/ a/ ./ 因此/ N/ 表示/ 这些/ 字符/ 组合/ 后/ 的/ 所有/ 字符串/ ./ 符号串/ 中/ 的/ 符号/ 取自/ 有/ 穷/ 的/ 字母表/ Σ/ ,/ 这些/ 字符串/ 构成/ 语言/ L/ ./ 因此/ ,/ 问题/ 转化/ 为/ 构造/ 一个/ 识别/ 语言/ L/ 的/ 图灵机/ M3/ ./ 状态图/ 如图/ 9/ 所示/ ./ 图中/ 省略/ 了/ 所有/ 到/ 拒绝/ 状态/ 的/ 转移/ 标记/ ./ 这个/ 实例/ 的/ 图灵机/ M3/ 的/ 形式/ 描述/ 为/ M/ =/ (/ Q/ ,/ Σ/ ,/ Γ/ ,/ q0/ ,/ qaccept/ ,/ qreject/ ,/ δ/ )/ ,/ 其中/ :/ Q/ =/ {/ q1/ ,/ q2/ ,/ q3/ ,/ q4/ ,/ qaccept/ ,/ qreject/ }/ ;/ Σ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ }/ ;/ 要/ 分析/ DDoS/ 攻击/ 源/ 的/ 主机/ 群/ 与/ 一个/ 已知/ 僵尸/ 网络/ 之间/ 的/ 关系/ ./ 最/ 直接/ 的/ 分析方法/ 是/ 计算/ 两批/ 主机/ 的/ IP/ 重合/ 度/ ./ 但/ 由于/ 很多/ 互联网/ 用户/ 使用/ 动态/ IP/ ,/ 直接/ 计算/ 有/ 很大/ 误差/ ,/ 而/ ISP/ 分配/ 的/ 动态/ IP/ 具有/ 一定/ 的/ 局部性/ ,/ 因此/ ,/ 我们/ 用/ C/ 类/ IP/ 段/ 代替/ 单独/ 的/ IP地址/ 来/ 计算/ IP/ 重合/ 度/ ./ 令/ ,/ 重复/ 运行/ 上述/ 工作/ 流程/ 进行/ 关联/ ./ 5.3/ ./ 2/ 流程/ 设计/ 述/ ./ 工作/ 流程/ 如表/ 8/ 所示/ ./ 与/ 5.1/ ./ 2/ 节/ 过程/ 相似/ ,/ 限于/ 篇幅/ ,/ 本文/ 不再/ 详/ 5.1/ 节/ 受控/ 僵尸/ 主机/ 列表/ ;/ 这个/ 协同/ 任务/ 按/ 如下/ 步骤/ 进行/ :/ (/ 1/ )/ 分别/ 读取/ 5.2/ 节/ DDoS/ 攻击/ 源/ 主机/ 列表/ 和/ (/ 2/ )/ 分别/ 统计/ 两个/ 列表/ 中/ C/ 类/ IP/ 段/ 的/ 数量/ ;/ (/ 3/ )/ 统计/ 两个/ 列表/ 中/ 相同/ IP/ 段/ 的/ 数量/ ./ 对/ 任意/ 两个/ 要/ 比较/ 的/ 主机/ 列表/ ,/ 可/ 通过/ 调度/ 指/ Γ/ =/ {/ a/ ,/ b/ ,/ c/ ,/ d/ ,/ e/ ,/ B/ }/ ;/ δ/ :/ Q/ ×/ Γ/ →/ / / δ/ Q/ ×/ Γ/ ×/ {/ L/ ,/ R/ }/ ;/ q0/ 是/ 起始/ 状态/ ;/ qaccept/ 是/ 接受/ 状态/ ;/ qreject/ 是/ 拒绝/ 状态/ ./ 5.3/ ./ 4/ 执行/ 结果/ 分析/ 为了/ 说明/ 执行/ 这个/ 协同/ 任务/ 的/ 意义/ ,/ 我们/ 分析/ 了/ 以下/ 3/ 种/ 典型/ 的/ 情况/ ./ (/ 1/ )/ 僵尸/ 网络/ 和/ DDoS/ 攻击/ 源/ 部分/ 重合/ ./ 表/ 9/ 列出/ 了/ 两个/ 实例/ ./ 重合/ 度越/ 高/ ,/ 说明/ DDoS/ 攻击/ 源/ 来自/ 这个/ 僵尸/ 网络/ 的/ 可能性/ 越大/ ./ 而/ DDoS/ 攻击/ 源中/ 没有/ 与/ 僵尸/ 网络/ 重合/ 的/ 主机/ ,/ 可能/ 是/ 属于/ 这个/ 僵尸/ 网络/ 而/ 没有/ 被/ 检测/ 到/ 的/ 受控/ 主机/ ./ 因此/ ,/ 这个/ 协同/ 任务/ 加强/ 了/ 我们/ 追踪/ 僵尸/ 网络/ 的/ 能力/ ,/ 有助于/ 我们/ 更/ 深入/ 了解/ 僵尸/ 网络/ 规模/ ./ 僵尸/ 主机/ 数量/ 1122355219665629.870/ ./ 05293756281880928.70/ ./ 09Page12/ (/ 2/ )/ 几次/ DDoS/ 攻击/ 事件/ 的/ 攻击/ 源/ 都/ 与/ 同一个/ 僵尸/ 网络/ 有/ 重合/ ./ 表/ 10/ 统计/ 了/ 一个/ 134465/ 台/ 受控/ 主机/ 的/ 僵尸/ 网络/ 与/ 3/ 批/ DDoS/ 攻击/ 源/ 主机/ 的/ 重合/ 情况/ ./ 每个/ DDoS/ 攻击/ 源/ 都/ 有/ 部分/ 主机/ 与/ 僵尸/ 网络/ 受控/ 主机/ 群/ 重合/ ,/ 因此/ ,/ 这/ 3/ 批/ DDoS/ 攻击/ 源/ 可能/ 都/ 来自/ 这个/ 僵尸/ 网络/ ,/ 扩大/ 了/ 该/ 僵尸/ 网络/ 规模/ ./ 表/ 10/ 一个/ 僵尸/ 网络/ 与/ 3/ 个/ DDoS/ 攻击/ 源/ 重合/ DDoS/ 攻击/ 源/ 主机/ 数量/ 相同/ 主机/ 数量/ 占/ DDoS/ 攻击/ 源/ 比率/ // %/ 111562109631655/ (/ 3/ )/ 在/ 同/ 一次/ DDoS/ 攻击/ 中/ 发现/ 攻击/ 源/ 来自/ 不同/ 的/ 僵尸/ 网络/ ./ 表/ 11/ 是/ 一个/ 有/ 2696/ 台/ 主机/ 的/ DDoS/ 攻击/ 源/ 与/ 3/ 个/ 僵尸/ 网络/ 的/ 重合/ 情况/ ./ 由于/ 每批/ 僵尸/ 主机/ 群/ 都/ 与/ 同一/ DDoS/ 攻击/ 源有/ 部分/ 重合/ ,/ 说明/ 它们/ 可能/ 是/ 同一/ 僵尸/ 网络/ 的/ 不同/ 部分/ ,/ 有助于/ 我们/ 分析/ 僵尸/ 主机/ 群/ 之间/ 的/ 关系/ ./ 表/ 11/ 一个/ DDoS/ 攻击/ 源/ 与/ 3/ 个/ 僵尸/ 网络/ 重合/ 僵尸/ 主机/ 数量/ 相同/ 主机/ 数量/ 占/ 僵尸/ 主机/ 比率/ // %/ 1105636296452324556/ 从/ 以上/ 3/ 个/ 观察/ 结果/ 可以/ 看出/ ,/ CRS/ 运行/ 的/ 这个/ 协同/ 任务/ ,/ 为/ 我们/ 掌握/ 僵尸/ 网络/ 的/ 规模/ ,/ 追踪/ 和/ 分析/ 僵尸/ 网络/ 之间/ 的/ 关系/ 都/ 提供/ 了/ 有效/ 手段/ ./ 因此/ ,/ CRS/ 可为/ 分析/ 不同/ 时间/ 、/ 不同/ 空间/ 安全事件/ 间/ 的/ 关系/ ,/ 挖掘/ 各/ 事件/ 关联/ 后/ 的/ 更/ 深层次/ 安全隐患/ ,/ 提供/ 有力/ 的/ 工作/ 平台/ ./ 6/ 结论/ 本文/ 在/ 讨论/ 分析/ 大规模/ 网络安全/ 事件/ 的/ 目的/ 和/ 意义/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一个/ 基于/ 通用/ 图灵机/ 的/ 协同/ 联动/ 模型/ ,/ 并/ 实现/ 了/ 协同/ 联动/ 系统/ ,/ 给出/ 了/ 相关/ 的/ 定义/ ,/ 系统/ 在/ 国家/ 基础/ 网/ 的/ 监测/ 环境/ 中/ 进行/ 了/ 应用/ ./ 与/ 以前/ 工作/ 相比/ ,/ 这个/ 模型/ 在/ 开放/ 的/ 网络空间/ 中/ 提供/ 了/ 网络安全/ 协同/ 联动/ 的/ 有力/ 平台/ :/ (/ 1/ )/ 能够/ 有效/ 地/ 追踪/ 大规模/ 网络安全/ 事件/ 在/ 不同/ 时间段/ 的/ 变化/ 情况/ ./ 通过/ 高效/ 地/ 实施/ 协同/ 联动/ 工作/ ,/ 提高/ 了/ 安全事件/ 的/ 处理/ 效率/ ./ (/ 2/ )/ 从/ 不同/ 空间/ 和/ 不同/ 时间/ 的/ 安全事件/ 信息/ 中/ 关联/ 出/ 同一/ 事件/ ,/ 并/ 分析/ 出/ 事件/ 的/ 规模/ 和/ 强度/ ,/ 掌握/ 事件/ 的/ 真实情况/ ./ (/ 3/ )/ 可以/ 自动/ 挖掘出/ 不同/ 安全事件/ 间/ 的/ 关系/ ,/ 有助于/ 更/ 深入分析/ 安全事件/ 的/ 本质/ ./ 致谢/ 真诚/ 感谢/ 审稿人/ 为/ 本文/ 提出/ 的/ 宝贵意见/ !/ 真诚/ 感谢/ CNERT/ // CC/ 相关/ 工作人员/ 对/ 我们/ 工作/ 的/ 支持/ !/ 

