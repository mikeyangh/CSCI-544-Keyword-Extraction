Page1/ 一种/ 具有/ 访问控制/ 的/ 云/ 平台/ 下外/ 包/ 数据流/ 动态/ 可验证/ 方法/ 孙奕/ 1/ )/ ,/ 2/ )/ ,/ 3/ )/ 陈性/ 元/ 2/ )/ 杜学绘/ 2/ )/ ,/ 3/ )/ 徐建/ 2/ )/ 1/ )/ (/ 北京/ 交通/ 大学/ 计算机/ 与/ 信息技术/ 学院/ 北京/ 100044/ )/ 2/ )/ (/ 解放军信息工程大学/ 郑州/ 450004/ )/ 3/ )/ (/ 数学/ 工程/ 与/ 先进/ 计算/ 国家/ 重点/ 实验室/ 郑州/ 450004/ )/ 摘要/ 针对/ 云/ 平台/ 下外/ 包/ 数据流/ 不可/ 信/ 、/ 验证/ 范围/ 不/ 可控/ 等/ 问题/ ,/ 该文/ 提出/ 一种/ 具有/ 访问控制/ 的/ 外包/ 数据流/ 动态/ 可验证/ 方法/ ./ 该/ 方法/ 的/ 核心思想/ 是/ 利用/ 任意/ 的/ Hash/ 函数/ 、/ 双陷门/ Hash/ 函数/ 和/ CP/ -/ ABE/ (/ CipertextPolicy/ -/ AttributeBasedEncryption/ )/ 算法/ 构成/ 一种/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ (/ AC/ -/ MTAT/ )/ ./ 该/ 可/ 认证/ 结构/ 可以/ 实现/ 对外/ 包/ 数据流/ 的/ 实时/ 增加/ 、/ 更新/ 和/ 细粒度/ 动态/ 验证/ ./ 此外/ ,/ 该/ 可/ 认证/ 数据结构/ 不仅/ 能够/ 验证/ 外/ 包/ 数据流/ 的/ 完整性/ ,/ 还/ 能够/ 验证/ 数据流/ 序列/ 的/ 正确性/ ./ 由于/ 在/ 传统/ 默克尔/ Hash/ 树/ (/ MHT/ )/ 中/ 引入/ 双陷门/ Hash/ 函数/ ,/ AC/ -/ MTAT/ 的/ 构建/ 过程/ 可以/ 分为/ 两个/ 阶段/ :/ 离线/ 阶段/ 和/ 在线/ 阶段/ ./ 这样/ 构建/ AC/ -/ MTAT/ 所/ 需/ 的/ 主要/ 代价/ 可以/ 放在/ 离线/ 阶段/ 完成/ ,/ 大大提高/ 了/ AC/ -/ MTAT/ 在线/ 实时/ 构建/ 效率/ ./ 该文/ 首先/ 给出/ AC/ -/ MTAT/ 方案/ 的/ 形式化/ 定义/ 和/ 具体/ 构建/ 算法/ ;/ 然后/ ,/ 对/ AC/ -/ MTAT/ 方案/ 的/ 安全性/ 进行/ 证明/ ,/ 证明/ 其/ 满足/ 正确性/ 、/ 可验证/ 安全性/ 和/ 访问/ 安全性/ ;/ 最后/ ,/ 分析/ 了/ 方案/ 的/ 实现/ 效率/ ,/ 并/ 通过/ 实现/ 一个/ AC/ -/ MTAT/ 原型/ 来/ 评估/ 算法/ 的/ 耗费/ 时间/ ,/ 实验/ 结果显示/ 作者/ 的/ 方案/ 对于/ 外/ 包/ 数据流/ 的/ 验证/ 是/ 高效/ 的/ 和/ 可行/ 的/ ,/ 而且/ 与/ 现有/ 方案/ 相比/ ,/ 该/ 方案/ 在/ 实时/ 增长/ 、/ 高效/ 更新/ 、/ 可控/ 验证/ 以及/ 对/ 数据流/ 的/ 适应性/ 等/ 方面/ 更/ 有/ 优势/ ./ 关键词/ 可/ 认证/ 数据结构/ ;/ 安全/ 外/ 包/ 数据流/ ;/ 访问控制/ ;/ 完整性/ ;/ 密文/ 策略/ 基于/ 属性/ 加密算法/ ;/ 云/ 计算/ 1/ 引言/ 随着/ 云/ 计算/ 、/ 大/ 数据/ 、/ 移动/ 网络/ 的/ 快速/ 发展/ ,/ 一方面/ ,/ 许多/ 应用/ (/ 如/ Web/ 访问/ 分析/ 、/ 环境/ 感知/ 、/ 实时/ 监控/ 和/ 股票交易/ 等/ )/ 产生/ 大量/ 的/ 数据流/ ./ 另一方面/ ,/ 终端/ 的/ 计算能力/ 和/ 计算资源/ 有限/ ,/ 无法/ 实时处理/ 或/ 存储/ 这些/ 大规模/ 数据/ ./ 因此/ 考虑/ 到/ 成本/ 和/ 代价/ ,/ 当/ 大量/ 的/ 数据流/ 产生/ 时/ ,/ 用户/ (/ 数据/ 拥有者/ )/ 通常/ 会/ 将/ 这些/ 数据流/ 外包/ 给/ 云/ 平台/ 进行/ 管理/ 和/ 维护/ ,/ 以便/ 其他/ 用户/ 访问/ 和/ 使用/ ./ 然而/ 云/ 平台/ 的/ 公开性/ 和/ 开放性/ 使得/ 云/ 平台/ 下/ 的/ 数据/ 变得/ 不可/ 信/ ,/ 云/ 平台/ 很/ 可能/ 会/ 向/ 数据/ 使用者/ 提供/ 伪造/ 的/ 数据/ 结果/ ./ 此外/ ,/ 对于/ 外/ 包/ 数据流/ 来说/ ,/ 随着/ 终端/ 应用/ 数据/ 的/ 不断/ 产生/ ,/ 数据/ 拥有者/ 不断/ 向云/ 平台/ 上传/ 数据/ ,/ 这样/ 云/ 平台/ 下/ 共享/ 的/ 数据/ 一直/ 处于/ 持续增长/ 和/ 动态变化/ 中/ ./ 如何/ 对/ 远程/ 不可/ 信/ 环境/ 下/ ,/ 连续/ 的/ 、/ 动态变化/ 的/ 外包/ 数据流/ 进行/ 动态/ 更新/ ,/ 实时/ 验证/ 和/ 受控/ 访问/ 就/ 成为/ 解决/ 云/ 平台/ 下/ 数据流/ 实时/ 共享/ 与/ 安全/ 交换/ 的/ 关键所在/ ./ 外包/ 数据流/ 连续/ 、/ 实时/ 、/ 海量/ 、/ 非/ 本地/ 存储/ 等/ 特性/ 使得/ 现有/ 验证/ 方案/ 应用/ 在外/ 包/ 数据流/ 时/ 存在/ 以下/ 挑战/ :/ (/ 1/ )/ 验证/ 者/ 无法/ 将/ 全部/ 数据流/ 缓存/ 后/ 再/ 进行/ 验证/ ;/ (/ 2/ )/ 传统/ 的/ 完整性/ 验证/ 方法/ 无法/ 高效/ 地/ 验证/ 流/ 序列/ 的/ 正确性/ ;/ (/ 3/ )/ 验证/ 者/ 与/ 证明/ 者/ 之间/ 是非/ 交互/ 的/ ;/ (/ 4/ )/ 更新/ 数据/ 时/ 需要/ 用户/ 存储/ 以往/ 变更/ 痕迹/ ,/ 否则/ 无法/ 验证/ 数据/ 更新/ 版本/ 的/ 正确性/ ;/ (/ 5/ )/ 验证/ 范围/ 不/ 可控/ ,/ 不能/ 实现/ 对/ 验证/ 者/ 身份/ 的/ 细粒度/ 控制/ ,/ 使得/ 被/ 验证/ 数据/ 存在/ 信息/ 泄露/ 等/ 风险/ ./ 基于/ 以上/ 分析/ ,/ 本文/ 在/ 对/ 可/ 认证/ 数据结构/ 研究/ 的/ 基础/ 上/ ,/ 引入/ 双陷门/ Hash/ 函数/ [/ 1/ -/ 3/ ]/ 和/ CP/ -/ ABE/ 算法/ [/ 4/ ]/ 对/ 典型/ 的/ 可/ 认证/ 数据结构/ —/ —/ —/ MerkleHashTree/ [/ 5/ -/ 6/ ]/ 进行/ 改进/ ,/ 提出/ 一种/ 具有/ 访问控制/ 的/ 可/ 认证/ 数据结构/ —/ —/ —/ AC/ -/ MTAT/ ,/ 并/ 在/ 此基础/ 上/ 实现/ 了/ 一种/ 新颖/ 的/ 外包/ 数据流/ 动态/ 可验证/ 方法/ ,/ 为/ 解决/ 云/ 平台/ 下/ 数据流/ 实时/ 共享/ 与/ 安全/ 交换/ 提供/ 技术/ 支撑/ ./ 2/ 相关/ 工作/ 可/ 认证/ 数据结构/ 本质/ 上/ 是/ 一种/ 新型/ 分布式计算/ 模型/ [/ 7/ ]/ ./ Tamassia/ [/ 8/ ]/ 第/ 1/ 次/ 正式/ 描述/ 了/ 可/ 认证/ 数据结构/ 模型/ ,/ 模型/ 中/ 包含/ 1/ 个/ 客体/ 的/ 结构化/ 集合/ S/ 和/ 3/ 个/ 参与者/ :/ 源/ 、/ 响应者/ 和/ 用户/ ./ 源/ 持有/ S/ 的/ 原始/ 版本/ ./ 当/ 在/ S/ 上/ 执行/ 更新/ 时/ ,/ 源/ 产生/ 结构化/ 认证/ 信息/ ,/ 其/ 包含/ 1/ 个/ 具有/ 当前/ 版本/ S/ 时间/ 戳/ 的/ 签名/ ./ 响应者/ 维持/ S/ 的/ 1/ 个/ 副本/ ./ 响应者/ 与源/ 交互/ 获得/ S/ 的/ 更新/ 及/ 相应/ 的/ 结构化/ 认证/ 信息/ ./ 响应者/ 也/ 与/ 用户/ 交互/ 回答/ 用户/ 对/ S/ 的/ 查询/ ./ 此外/ ,/ 响应者/ 返回/ 符合/ 的/ 认证/ 信息/ ,/ 该/ 信息/ 包含/ 由源/ 发布/ 的/ 最新/ 结构化/ 认证/ 信息/ 和/ 应答/ 的/ 1/ 个/ 证据/ ./ 用户/ 在/ S/ 上/ 实施/ 查询/ ,/ 但/ 不能/ 直接/ 与源/ 交互/ ,/ 只能/ 与/ 响应者/ 交互/ ./ 然而/ ,/ 用户/ 相信/ 源/ 但/ 不/ 相信/ 响应者/ ,/ 因此/ 用户/ 验证/ 来自/ 响应者/ 与/ 应答/ 相关/ 的/ 认证/ 信息/ ./ 被源/ 和/ 响应者/ 用来/ 存储/ 集合/ S/ 的/ 数据结构/ ,/ 以及/ 由/ 不同/ 参与者/ 执行/ 的/ 查询/ 、/ 更新/ 和/ 验证/ 算法/ ,/ 形成/ 可/ 认证/ 数据结构/ ./ 目前/ 实现/ 可/ 认证/ 数据结构/ 的/ 实现/ 方式/ 主要/ 有/ 认证/ 跳表/ [/ 9/ ]/ 、/ 索引/ Hash/ 链表/ [/ 10/ ]/ 、/ MHT/ (/ MerkleHashTree/ )/ 和/ MACTree/ [/ 11/ ]/ 等/ ./ 其中/ MHT/ 是/ 最早/ 的/ 可/ 认证/ 数据结构/ ./ MHT/ 是/ 一个/ 二进制/ Hash/ 树/ ,/ 叶子/ 结点/ 是/ 各个/ 数据/ 块/ 的/ Hash/ 值/ ,/ 中间/ 结点/ 是/ 所有/ 子/ 结点/ Hash/ 值/ 连接/ 后/ 的/ Hash/ 值/ ./ 进行/ 完整性/ 检验/ 时/ 只/ 需要/ 对/ 叶子/ 到/ 根/ 结点/ 的/ 一条/ 或/ 若干条/ 路径/ 进行/ 处理/ ,/ 就/ 可以/ 高效/ 地/ 证明/ 一组/ 数据/ (/ 块/ )/ 具有/ 完整性/ ,/ 未/ Page3/ 被/ 损坏/ 和/ 篡改/ ./ MHT/ 可以/ 仅/ 通过/ 一个/ 签名/ 就/ 能/ 对/ 树/ 中/ 的/ 每个/ 结点/ 值/ 进行/ 认证/ ,/ 又/ 允许/ 中间/ 结点/ 通过/ 计算/ Hash/ 路径/ 的/ 对数/ 来/ 验证/ 树中/ 结点/ 数量/ ,/ 可以/ 实现/ 对/ 指数/ 数量级/ 数据/ 的/ 验证/ ./ 这些/ 优势/ 使/ 其/ 成为/ 一种/ 被/ 广为/ 研究/ 的/ 用于/ 验证/ 远程/ 不可/ 信/ 环境/ 下/ 数据完整性/ 的/ 技术/ ./ 因此/ ,/ 本文/ 在/ MHT/ 的/ 基础/ 上/ ,/ 构建/ 具有/ 访问控制/ 的/ 云/ 平台/ 下外/ 包/ 数据流/ 动态/ 可验证/ 方案/ ./ 为了/ 同时/ 支持/ 公开/ 审计/ 和/ 全/ 动态数据/ 操作/ ,/ Wang/ 等/ 人/ [/ 16/ ]/ 引入/ MHT/ ,/ 通过/ 对/ MHT/ 树型/ 结构/ 的/ 变换/ ,/ 改变/ 现有/ 验证/ 证据/ 的/ 存储/ 模型/ ,/ 来/ 实现/ 全/ 动态数据/ 操作/ ,/ 并/ 利用/ BLS/ 算法/ 构建/ 数据/ 块/ 的/ 同态/ 认证/ 标签/ ,/ 实现/ 公开/ 审计/ ./ Hao/ 等/ 人/ [/ 17/ ]/ 和/ Yang/ 等/ 人/ [/ 18/ ]/ 也/ 对/ 可/ 公开/ 验证/ 下/ 的/ 、/ 可/ 支持/ 动态数据/ 的/ 完整性/ 验证/ 方案/ 进行/ 了/ 讨论/ ./ 为了/ 进一步提高/ 验证/ 时/ 目前/ 与/ 本文/ 研究/ 相关/ 的/ 工作/ 主要/ 涉及/ 两个/ 方面/ :/ 数据/ 持有/ 性/ 证明/ (/ ProvableDataPossession/ ,/ PDP/ )/ 和/ 数据/ 可/ 检索/ 证明/ (/ ProofofRetrievability/ ,/ POR/ )/ ./ PDP/ 是/ Ateniese/ 等/ 人/ [/ 12/ ]/ 于/ 2007/ 年/ 首先/ 提出/ 的/ ,/ 可以/ 实现/ 对外/ 包/ 数据/ 的/ 高效/ 验证/ ,/ 这是/ 第一个/ 不/ 分块/ 且/ 支持/ 公开/ 验证/ 的/ 方案/ ./ POR/ 是/ 由/ Shacham/ 等/ 人/ [/ 13/ ]/ 在/ 2008/ 年/ 提出/ 的/ ,/ 是/ 对/ PDP/ 的/ 扩展/ ,/ 不仅/ 能够/ 验证/ 远程/ 数据/ 是否/ 被/ 篡改/ ,/ 还/ 可以/ 利用/ 纠/ 删码/ 技术/ 保证数据/ 的/ 可/ 恢复性/ ./ 这/ 两种/ 验证/ 模式/ 的/ 主要/ 思想/ 是/ 利用/ 短/ 签名/ 算法/ (/ BLS/ )/ 或/ RSA/ 签名/ 算法/ 构建/ 同态/ 线性/ 验证/ 标签/ (/ homomorphiclinearauthen/ -/ ticator/ )/ ,/ 使得/ 用户/ 在/ 不/ 取回/ 数据/ 的/ 情况/ 下/ ,/ 对/ 远程/ 服务器/ (/ 如云/ )/ 中/ 数据/ 的/ 完整性/ 进行/ 验证/ ,/ 可以/ 分为/ 确定性/ 验证/ 和/ 概率/ 性/ 验证/ 两类/ ./ 为了/ 在/ 有效/ 地/ 验证/ 数据完整性/ 的/ 情况/ 下/ ,/ 同时/ 能够/ 支持/ 数据/ 的/ 动态/ 操作/ ,/ 在/ 后续/ 的/ 研究/ 方案/ 中/ 引入/ 了/ 可/ 认证/ 数据结构/ ./ Ateniese/ 等/ 人/ [/ 14/ ]/ 提出/ 了/ 一种/ 支持/ 数据/ 动态/ 存储/ 的/ SPDP/ 方案/ ./ 该/ 方案/ 可以/ 支持/ 数据/ 的/ 更新/ 和/ 删除/ ,/ 但/ 不/ 支持/ 数据/ 的/ 添加/ ./ 由于/ 该/ 方案/ 是/ 基于/ 对称/ 密钥/ 的/ ,/ 所以/ 不能/ 支持/ 公开/ 的/ 验证/ 并且/ 由于/ 每次/ 验证/ 都/ 需要/ 消耗/ 一个/ 密钥/ ,/ 其/ 能够/ 提供/ 的/ 数据/ 验证/ 的/ 次数/ 有限/ ./ 2009/ 年/ ,/ Erway/ 等/ 人/ [/ 15/ ]/ 第/ 1/ 次/ 提出/ 了/ 一种/ 能够/ 支持/ 全/ 动态/ 操作/ 的/ 可/ 证明/ 的/ 数据/ 持有/ 方案/ ./ 该/ 方案/ 为了/ 解决/ 数据/ 块/ 更新/ 后/ 造成/ 的/ 索引/ 信息/ 的/ 变更/ 问题/ ,/ 在/ 标签/ 计算/ 中/ 删除/ 了/ Ateniese/ 所/ 提出/ 的/ PDP/ 模型/ 中/ 的/ 索引/ 信息/ ,/ 利用/ 基于/ 等级/ 的/ 认证/ 跳表/ 构建/ 数据/ 块/ 的/ 标签/ 信息/ ./ 不足之处/ 是/ 执行/ 效率/ 不高/ ./ 的/ 查询/ 效率/ ,/ Li/ 等/ 人/ [/ 19/ ]/ 将/ MHT/ 概念/ 融合/ 到/ B/ +/ 树结构/ 中/ ,/ 提出/ 一种/ MB/ -/ Tree/ 树型/ 结构/ 对/ 存储/ 数据/ 进行/ 组织/ 和/ 管理/ ,/ 并/ 通过/ 树型/ 结构/ 的/ 变化/ 来/ 体现/ 对/ 数据/ 的/ 动态/ 操作/ ./ Zhu/ 等/ 人/ [/ 20/ -/ 21/ ]/ 采用/ 索引/ Hash/ 链表/ 来/ 支持/ 动态数据/ 的/ 有效/ 更新/ ,/ 并/ 利用/ 分离/ 结构/ (/ fragmentstructure/ )/ 的/ 方法/ 来/ 减小/ 可/ 公开/ 验证/ 方案/ 中所/ 需/ 的/ 存储/ 验证/ 信息/ 的/ 开销/ ./ 为了/ 解决/ 多用户/ 下/ 的/ 云端/ 共享/ 数据/ 问题/ ,/ Tate/ 等/ 人/ [/ 22/ ]/ 提出/ 一种/ 可以/ 支持/ 多用户/ 的/ ,/ 支持/ 动态数据/ 更新/ 的/ 数据完整性/ 验证/ 方案/ ./ 但/ 该/ 方案/ 需要/ 基于/ 可信/ 硬件/ (/ trustedhardware/ )/ 来/ 实现/ ./ 为了/ 支持/ 对云/ 平台/ 下大/ 数据/ 的/ 细粒度/ 更新/ 验证/ 要求/ ,/ Liu/ 等/ 人/ [/ 23/ ]/ 提出/ 一种/ 具有/ 标记/ 的/ 默克/ 哈希/ 树/ (/ RMHT/ )/ 方案/ ./ 该/ 方案/ 基于/ BLS/ 算法/ 为/ 每/ 一个/ 分块/ 数据/ 计算/ 同态/ 线性/ 验证/ 标签/ ./ 与/ 之前/ 需要/ 均分/ 数据/ 块/ 大小/ 的/ 方案/ 不同/ ,/ 该/ 方案/ 中/ 数据/ 块/ 大小/ 可以/ 是/ 任意/ 大小/ 的/ ,/ 在/ MHT/ 叶子/ 结点/ 中/ 除了/ 保存/ 数据/ 分块/ 信息/ 以外/ ,/ 增加/ 了/ 标记/ 信息/ ,/ 该/ 标记/ 信息/ 用于/ 记录/ 对/ 每个/ 数据/ 分块/ 再次/ 细分/ 后/ 的/ 数据/ 块/ 个数/ 信息/ 及/ 位置/ 信息/ ,/ 从而/ 利用/ 该/ 标记/ 实现/ 对/ 每个/ 数据/ 块/ 中/ 数据/ 的/ 细粒度/ 更新/ ,/ 而/ 无需/ 更新/ 整个/ 数据/ 块/ 信息/ ./ Liu/ 等/ 人/ [/ 24/ ]/ 、/ Feng/ 等/ 人/ [/ 25/ ]/ 和/ Tan/ 等/ 人/ [/ 26/ ]/ 也/ 对/ 现有/ 的/ 云/ 平台/ 下外/ 包/ 数据完整性/ 验证/ 技术/ 进行/ 了/ 总结/ 与/ 展望/ ,/ 但/ 均/ 未/ 涉及/ 对外/ 包/ 数据流/ 的/ 完整性/ 验证/ 问题/ ./ 综上所述/ ,/ 以上/ 方案/ 都/ 针对/ 静态/ 文件/ 的/ 动态/ 操作/ ,/ 不适/ 用于/ 对/ 数据流/ 的/ 动态/ 操作/ ./ 这些/ 方案/ 的/ 一个/ 共同点/ 是/ 需要/ 对/ 文件/ 进行/ 分块/ ,/ 然后/ 将/ 这些/ 数据/ 块/ 作为/ MHT/ 的/ 叶子/ 结点/ 来/ 构建/ Hash/ 认证/ 树/ ,/ 不同/ 方案/ 中/ 根据/ 其所/ 实现/ 的/ 功能/ 不同/ ,/ 叶子/ 结点/ 存储/ 的/ 附加/ 信息/ 不同/ ./ 在/ 动态/ 更新过程/ 中/ ,/ 通过/ 变换/ MHT/ 树型/ 结构/ (/ 如/ 更新/ 某些/ 结点/ 、/ 合并/ 某些/ 结点/ 、/ 分裂/ 某些/ 结点/ )/ 来/ 实现/ 对/ 数据/ 的/ 动态/ 操作/ ./ 以上/ 构建/ 方法/ ,/ 需要/ 用户/ 在/ 构建/ MHT/ 时/ ,/ 提前/ 确定/ 所有/ 叶子/ 结点/ 的/ 信息/ ,/ 才能/ 生成/ MHT/ ./ 然而/ ,/ 对于/ 数据流/ 来说/ ,/ 不/ 可能/ 将/ 整个/ 数据流/ 缓存/ 下来/ ,/ 分块/ 后/ 再/ 构建/ MHT/ ./ 因此/ ,/ 构建/ 面向/ 数据流/ 的/ Hash/ 认证/ 树时/ ,/ 不/ 可能/ 提前/ 确定/ 所有/ 叶子/ 结点/ 信息/ ./ 以上/ 方案/ 不适/ 用于/ 对/ 数据流/ 的/ 动态/ 操作/ 和/ 实时/ 验证/ ./ 最近/ ,/ Schroeder/ 等/ 人/ [/ 27/ -/ 28/ ]/ 从/ 另/ 一个/ 角度/ 对/ MHT/ 进行/ 改进/ ,/ 引入/ 变色龙/ Hash/ 函数/ [/ 29/ ]/ 构造/ 一个/ 变色龙/ 认证/ 树/ (/ CAT/ )/ ,/ 来/ 实现/ 对/ 数据流/ 的/ 动态/ 操作/ 和/ 实时/ 验证/ ,/ 并/ 基于/ CAT/ 构造/ 了/ 一个/ 可验证/ 数据流/ 方案/ (/ VDS/ )/ ./ 该/ 方案/ 优势/ 是/ 基于/ CAT/ 无需/ 提/ Page4/ 前/ 固定/ 叶子/ 结点/ ,/ 对于/ 掌握/ 陷门/ 信息/ 的/ 用户/ ,/ 无需/ 预先/ 计算/ 或/ 重新/ 计算/ 其他/ 叶子/ 结点/ 就/ 能/ 对/ 新元素/ 进行/ 添加/ 和/ 认证/ ,/ 而且/ 在/ 数据流/ 协议/ 的/ 设置/ 阶段/ 中/ 数据/ 可以/ 是/ 未知/ 的/ ./ 本文/ 在/ CAT/ 的/ 基础/ 上/ 进行/ 改进/ ,/ 构建/ 一种/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ (/ AC/ -/ MTAT/ )/ ./ 与/ CAT/ 不同/ ,/ 在/ CAT/ 中/ 为了/ 防止/ 攻击/ ,/ 陷门/ 碰撞/ 只能/ 使用/ 一次/ ,/ 因此/ 当/ 更新/ 数据/ 时/ 需要/ 重新/ 构建/ 整棵树/ 和/ 验证/ 公钥/ ;/ 本文/ 采用/ 双陷门/ Hash/ 函数/ ,/ 可以/ 计算/ 多次/ 碰撞/ ,/ 无需/ 更新/ 根/ 结点/ 的/ 值/ 和/ 公钥/ ,/ 提高/ 了/ 数据/ 的/ 更新/ 效率/ ,/ 而且/ 通过/ 分期/ 偿还/ 机制/ 将/ 认证/ 树/ 的/ 构建/ 分为/ 离线/ 阶段/ 和/ 在线/ 阶段/ ,/ 大大提高/ 数据/ 增长/ 时/ 可/ 认证/ 数据结构/ 的/ 构建/ 效率/ ,/ 从而/ 提高/ 对/ 实时/ 数据/ 的/ 处理/ 效率/ ./ 此外/ ,/ 本文/ 提出/ 的/ 方案/ 具有/ 基于/ 属性/ 的/ 细粒度/ 授权/ 验证/ 功能/ ,/ 既/ 不是/ 基于/ 对称/ 密钥/ 的/ 认证/ ,/ 也/ 不是/ 对/ 所有/ 用户/ 的/ 公开/ 验证/ ,/ 只有/ 满足/ 一定/ 访问/ 策略/ 的/ 用户/ 才能/ 验证/ ./ 这样/ 在/ 云/ 平台/ 下面/ 向/ 多个/ 用户/ 、/ 多个/ 可/ 认证/ 数据结构/ 时/ ,/ 可以/ 实现/ 基于/ 属性/ 的/ 细粒度/ 授权/ 验证/ ,/ 从而/ 能够/ 较/ 好/ 的/ 控制/ 共享/ 平台/ 下/ 数据/ 的/ 可验证/ 范围/ ,/ 保护/ 不同/ 数据/ 用户/ 的/ 隐私/ ,/ 同时/ 在/ 授权/ 用户/ 和/ 验证/ 范围/ 更新/ 时/ ,/ 降低/ 密钥/ 管理/ 的/ 复杂度/ ./ 3/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ 本/ 节/ 提出/ 一种/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ ,/ 并/ 给出/ 其/ 总体/ 描述/ 及/ 形式化/ 定义/ ./ 3.1/ 总体/ 描述/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ 本质/ 上/ 是/ 由/ 任意/ 的/ Hash/ 函数/ 、/ 双陷门/ Hash/ 函数/ 和/ CP/ -/ ABE/ 算法/ 所/ 组成/ 的/ 一种/ 具有/ 访问控制/ 的/ 双/ 陷门/ Hash/ 认证/ 树/ ,/ 该/ 认证/ 树/ 可以/ 实现/ 一种/ 新颖/ 的/ 认证/ 技术/ ./ 与/ 传统/ 的/ MHT/ 相比/ ,/ AC/ -/ MTAT/ 在/ Hash/ 函数/ 的/ 图/ 1AC/ -/ MTAT/ 架构/ 基础/ 上/ ,/ 引入/ 了/ 双/ 陷门/ Hash/ 函数/ (/ 利用/ 双陷门/ Hash/ 可以/ 实现/ 无/ 密钥/ 泄露/ 的/ 陷门/ Hash/ 函数/ )/ 和/ CP/ -/ ABE/ 算法/ 共同/ 构成/ 一棵/ 二进制/ 树/ ./ 图/ 1/ 展示/ 了/ 一个/ AC/ -/ MTAT/ 例子/ :/ 我们/ 用/ D/ 表示/ 树/ 的/ 深度/ ,/ 树/ 的/ 每/ 一层/ 的/ 高度/ 用/ h/ =/ 0/ ,/ …/ ,/ D/ -/ 1/ 来/ 表示/ ,/ 则/ 树/ 中/ 叶子/ 结点/ 的/ 高度/ 为/ h/ =/ 0/ ,/ 根/ 结点/ 的/ 高度/ 为/ h/ =/ D/ -/ 1/ ./ 每个/ 非/ 叶子/ 结点/ 最多/ 有/ 两个/ 孩子/ 结点/ ,/ 树/ 的/ 右/ 结点/ 是/ 通过/ 双陷门/ Hash/ 函数/ 计算/ 的/ 值/ ,/ 左/ 结点/ 由/ Hash/ 函数/ 计算/ 的/ 值/ ;/ 中间/ 结点/ 是/ 两个/ 孩子/ 结点/ Hash/ 值/ 连接/ 后/ 的/ Hash/ 值/ ,/ 根/ 结点/ 是/ CP/ -/ ABE/ 对/ 根值/ 进行/ 加密/ 的/ 值/ ,/ 记/ 作/ γ/ ,/ 只有/ 满足/ 访问/ 策略/ 的/ 用户/ 才能/ 获取/ 根/ 结点/ 的/ 值/ ./ AC/ -/ MTAT/ 的/ 主要/ 构建/ 思路/ 如下/ :/ 我们/ 用/ H/ 表示/ Hash/ 函数/ ,/ 用/ MTH/ 表示/ 双陷门/ Hash/ 函数/ ./ 首先/ 随机/ 选择/ 两个/ 叶子/ 结点/ 的/ 值/ l0/ 和/ l1/ ,/ 来/ 构建/ 初始化/ 认证/ 树/ ,/ 如图/ 2/ 所示/ ,/ 计算/ H/ (/ l0/ ‖/ l1/ )/ =/ N1/ ,/ 0/ 作为/ 结点/ N1/ ,/ 0/ 的/ 值/ ,/ 随机/ 选择/ 信息/ m/ 和/ 碰撞/ 值/ r/ ,/ 利用/ 双陷门/ Hash/ 函数/ 计算/ MTH/ (/ m/ ,/ r/ )/ =/ N1/ ,/ 1/ 作为/ 结点/ N1/ ,/ 0/ 的/ 兄弟/ 结点/ 即/ N1/ ,/ 1/ 的/ 值/ ./ 接着/ ,/ 计算/ H/ (/ N1/ ,/ 0/ ‖/ N1/ ,/ 0/ )/ =/ N2/ ,/ 0/ 作为/ 其父/ 结点/ 的/ 值/ ,/ 依次/ 类推/ 计算/ 到/ D/ -/ 1/ 层/ ./ 然后/ ,/ 利用/ 双陷门/ Hash/ 函数/ 计算/ MTH/ (/ m/ ,/ r/ ρ/ )/ =/ ρ/ ,/ 并/ 利用/ CP/ -/ ABE/ 算法/ 对/ ρ/ 进行/ 加密/ 得到/ γ/ ./ 随着/ 数据/ 的/ 增长/ ,/ 可以/ 实现/ 对/ 初始化/ 认证/ 树/ 结点/ 的/ 动态/ 增加/ ,/ 增加/ 的/ 结点/ 分为/ 两种/ 情况/ ,/ 如果/ 增加/ 的/ 是/ 右/ 结点/ 的/ 叶子/ 结点/ ,/ 则/ 只/ 需要/ 更新/ 陷门/ 碰撞/ 值/ ,/ 如/ :/ 增加/ 叶子/ 结点/ l2/ 和/ l3/ ,/ 记/ l2/ ‖/ l3/ =/ m/ ,/ 利用/ 求/ 碰撞/ 值/ 算法/ 获得/ r/ ,/ 使得/ MTH/ (/ m/ ,/ r/ )/ =/ MTH/ (/ m/ ,/ r/ )/ ,/ 更新/ N1/ ,/ 1/ 的/ 存储/ 值为/ (/ m/ ,/ r/ )/ ./ 如果/ 增加/ 的/ 是/ 左/ 节点/ 的/ 叶子/ 结点/ ,/ 则/ 计算/ 叶子/ 结点/ 的/ Hash/ 值/ ,/ 如果/ 兄弟/ 结点/ 不/ 存在/ ,/ 随机/ 选择/ 信息/ 对/ (/ mi/ ,/ ri/ )/ 计算/ 陷门/ Hash/ 值/ 作为/ 其/ 兄弟/ 节点/ ,/ 逐层/ 向上/ 计算/ ,/ 直至/ 父/ 节点/ 为/ 陷门/ Hash/ 值/ ,/ 更新/ 其上/ 存储/ 的/ 碰撞/ 值/ 即可/ ./ 按照/ 以上/ 的/ 方法/ 不断/ 增加/ 新/ 的/ 叶子/ 结点/ ,/ 直至/ 建满树/ 为止/ ./ Page53/ ./ 2/ 形式化/ 定义/ 定义/ 1/ (/ 双陷门/ Hash/ 函数/ 族/ MTH/ )/ [/ 2/ -/ 3/ ]/ ./ 一个双/ 陷门/ Hash/ 函数/ 族/ 由/ 一个/ 三元组/ (/ I/ ,/ I/ ,/ H/ )/ 所/ 组成/ :/ (/ 1/ )/ I/ 是/ 一种/ 概率/ 多项式/ 时间/ 的/ 密钥/ 生成/ 算法/ ,/ 输入/ 1k/ ,/ 输出/ 一对/ 长久/ Hash/ // 陷门/ 密钥/ 对/ (/ HK/ ,/ TK/ )/ ,/ 使得/ HK/ ,/ TK/ 的/ 长度/ 是/ k/ 的/ 多项式/ 有关/ ;/ (/ 2/ )/ I/ 是/ 一种/ 概率/ 多项式/ 时间/ 的/ 密钥/ 生成/ 算法/ ,/ 输入/ 1k/ ,/ 输出/ 一对/ 一次性/ Hash/ // 陷门/ 密钥/ 对/ (/ HK/ ,/ TK/ )/ ,/ 使得/ HK/ ,/ TK/ 的/ 长度/ 是/ k/ 的/ 多项式/ 有关/ ;/ (/ 3/ )/ MTH/ 是/ 一个/ 随机/ 的/ Hash/ 函数/ 族/ ./ 输入/ 1k/ ,/ 一对/ Hash/ // 陷门/ 密钥/ 对/ (/ HK/ ,/ TK/ )/ ,/ 一对/ (/ m/ ,/ r/ )/ ∈/ M/ ×/ R/ 和/ 一个/ 消息/ m/ ≠/ m/ ,/ 运行/ 求/ 碰撞/ 函数/ MTHColHK/ (/ TK/ ,/ m/ ,/ r/ ,/ m/ )/ 输出/ 一个/ 碰撞/ 参数/ r/ 和/ HK/ ,/ 使得/ MTHHK/ (/ m/ ,/ r/ )/ =/ MTHHK/ (/ m/ ,/ r/ )/ ./ 当/ HK/ ≠/ HK/ 时/ ,/ HK/ 与其/ 关联/ 的/ 陷门/ 密钥/ TK/ 称为/ 一次性/ 密钥/ 对/ ./ 一个双/ 陷门/ Hash/ 函数/ 应/ 满足/ 有效/ 计算/ 、/ 陷门/ 碰撞/ 、/ 抗/ 碰撞/ 、/ 抗/ 密钥/ 泄露/ 和/ 语义/ 安全/ 等/ 性质/ ,/ 详细/ 证明/ 过程/ 参见/ 文献/ [/ 2/ -/ 3/ ]/ ./ 定义/ 2/ [/ 4/ ]/ ./ 一个/ 基于/ 属性/ 加密/ 的/ 方案/ 由/ 以下/ 4/ 个/ 算法/ 组成/ :/ ABE/ ./ setup/ ,/ ABE/ ./ keygen/ ,/ ABE/ ./ encrypt/ 和/ ABE/ ./ decrypt/ ./ ABE/ ./ setup/ (/ 1k/ )/ :/ 输入/ 安全/ 参数/ 1k/ ,/ 输出/ 一对/ 主公/ // 私钥/ 对/ (/ pk/ ,/ sk/ )/ ./ ABE/ ./ keygen/ (/ sk/ ,/ A/ )/ :/ 主/ 私钥/ sk/ 和/ 属性/ A/ 生成/ 解密/ 密钥/ dkA/ ./ ABE/ ./ encrypt/ (/ m/ ,/ ω/ ,/ pk/ )/ :/ 主公/ 钥/ pk/ ,/ 消息/ m/ 和/ 访问/ 控制策略/ ω/ ,/ 生成/ 密文/ c/ ./ ABE/ ./ decrypt/ (/ c/ ,/ dk/ ,/ ω/ )/ :/ 如果/ A/ 满足/ 密文/ c/ 绑定/ 的/ 策略/ ω/ ,/ 则/ 输入/ 公钥/ pk/ ,/ 解密/ 密钥/ dkA/ 和/ 密文/ c/ ,/ 可以/ 解密/ 输出/ 消息/ m/ ./ CP/ -/ ABE/ 全/ 安全性/ 证明/ 参见/ 文献/ [/ 4/ ]/ ./ 定义/ 3/ ./ 一个/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ 是/ 一种/ 概率/ 多项式/ 时间/ (/ PPT/ )/ 算法/ AC/ -/ MTAT/ =/ (/ MtatGen/ ,/ IkeyGen/ ,/ CertIssue/ ,/ InitiRoot/ ,/ Add/ _/ Leaf/ ,/ Update/ _/ Leaf/ ,/ MtatVrfy/ )/ :/ (/ SK/ ,/ VK/ )/ ←/ MtatGen/ (/ 1k/ ,/ D/ )/ :/ AC/ -/ MTAT/ 密钥/ 生成/ 算法/ ./ 算法/ 输入/ 安全/ 参数/ 1k/ 和/ 一个/ 整数/ D/ ,/ 整数/ D/ 表示/ 树/ 的/ 深度/ ./ 算法/ 返回/ 一个/ 私钥/ SK/ 和/ 验证/ 密钥/ VK/ ,/ 然后/ 发布/ VK/ 并/ 保密/ SK/ ./ (/ skI/ ,/ pkI/ )/ ←/ IkeyGen/ (/ 1k/ )/ :/ IkeyGen/ 生成/ 算法/ ./ 算法/ 输入/ 安全/ 参数/ 1k/ ,/ 返回/ 公钥/ pkI/ 和/ 相应/ 的/ 私钥/ skI/ ,/ 然后/ 发布/ pkI/ 并/ 保密/ sk/ ./ certA/ ←/ CertIssue/ (/ skI/ ,/ pkI/ ,/ A/ )/ :/ 属性/ 证书/ 生成/ 算法/ ./ 算法/ 输入/ 一对/ 密钥/ (/ skI/ ,/ pkI/ )/ 和/ 一个/ 属性/ 集合/ A/ ./ 算法/ 输出/ 访问/ 证书/ certA/ ./ γ/ ←/ InitiRoot/ (/ pkI/ ,/ root/ ,/ ω/ )/ :/ 验证/ 树根/ 生成/ 算法/ ./ 算法/ 输入/ 公钥/ pkI/ ,/ 认证/ 树根/ 结点/ root/ 和/ 一个/ 访问控制/ 结构/ ω/ ./ 算法/ 输出/ 关于/ 树根/ root/ 和/ ω/ 的/ 公开/ 验证/ 信息/ γ/ ./ (/ SK/ ,/ i/ ,/ aProof/ )/ ←/ Add/ _/ Leaf/ (/ SK/ ,/ l/ )/ :/ 认证/ 证据/ 生成/ 算法/ ,/ 算法/ 输入/ 私钥/ SK/ 和/ 一个/ 叶子/ 结点/ l/ ∈/ L/ ./ 算法/ 输出/ 私钥/ SK/ ,/ 叶子/ 结点/ l/ 在/ 树/ 中/ 的/ 索引/ i/ ,/ 以及/ 认证/ 证据/ aProof/ ./ (/ SK/ ,/ nPath/ ,/ aPath/ )/ ←/ Update/ _/ Leaf/ (/ SK/ ,/ VK/ ,/ i/ ,/ l/ )/ :/ 叶子/ 结点/ 更新/ 算法/ ./ 算法/ 输入/ 一对/ 密钥/ (/ SK/ ,/ VK/ )/ ,/ 叶子/ 结点/ l/ ∈/ L/ 及其/ 索引/ i/ ./ 算法/ 更新/ 位于/ ith/ 处/ 的/ 叶子/ 结点/ 为/ l/ ,/ 更新/ 从/ 叶子/ 结点/ l/ 到/ 根/ 路径/ nPath/ 上/ 的/ 所有/ 结点/ ,/ 并/ 更新/ 叶子/ 结点/ l/ 认证/ 路径/ aPath/ 上/ 的/ 结点/ ./ {/ 0/ ,/ 1/ }/ ←/ MtatVrfy/ (/ VK/ ,/ i/ ,/ l/ ,/ aProof/ ,/ γ/ )/ :/ 验证/ 算法/ ./ 算法/ 输入/ 公钥/ VK/ ,/ 索引/ i/ ,/ 叶子/ 结点/ l/ ,/ 认证/ 证据/ aProof/ 和/ 验证/ 根/ γ/ ./ 如果/ l/ 确实/ 是/ 位于/ 树中/ ith/ 的/ 叶子/ 结点/ ,/ 算法/ 输出/ 1/ 否则/ 输出/ 0.4/ AC/ -/ MTAT/ 方案/ 的/ 构建/ 方法/ 定义/ 4/ ./ 设/ H/ 是/ 一个/ 抗/ 碰撞/ Hash/ 函数/ ,/ 槇/ TH/ 是/ 单向/ 抗/ 碰撞/ 陷门/ Hash/ 函数/ ,/ MTH/ 是/ 一个/ 单向/ 的/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ ,/ CP/ -/ ABE/ 是/ 一个/ 基于/ 密文/ 策略/ 的/ 属性/ 加密/ 方案/ ./ 则/ 具有/ 访问控制/ 的/ 动态/ 可/ 认证/ 数据结构/ AC/ -/ MTAT/ 由/ 以下/ 6/ 个/ 算法/ 所/ 组成/ :/ AC/ -/ MTAT/ =/ (/ MtatGen/ ,/ IkeyGen/ ,/ InitiRoot/ ,/ Add/ _/ Leaf/ ,/ Updata/ _/ Leaf/ ,/ MtatVrfy/ )/ ./ 下面/ 分别/ 对/ 这/ 6/ 种/ 算法/ 进行/ 详细描述/ ./ 4.1/ 初始化/ 参数/ MtatGen/ :/ MtatGen/ 算法/ 由/ 以下/ 密钥/ 生成/ 算法/ Page6/ 组成/ ./ ThKeyGen/ (/ 1k/ )/ :/ 陷门/ Hash/ 密钥/ 生成/ 算法/ ./ 输入/ 安全/ 参数/ 1k/ ,/ 返回/ 一对/ 陷门/ 密钥/ (/ tk/ ,/ hk/ )/ ←/ 槇/ TH/ (/ 1k/ )/ ,/ 发布/ Hash/ 密钥/ hk/ ,/ 保密/ 陷门/ 密钥/ tk/ ./ MthKeyGen/ (/ 1k/ ,/ D/ )/ :/ 双陷门/ Hash/ 密钥/ 生成/ 算法/ ,/ 输入/ 安全/ 参数/ 1k/ 和/ 表示/ 树/ 深度/ 的/ 整数/ D/ ./ 返回/ 长期/ 陷门/ // Hash/ 密钥/ 对/ (/ mtk/ ,/ mhk/ )/ ←/ MKeyGen/ (/ 1k/ )/ 和/ 一次性/ 陷门/ // Hash/ 密钥/ 对/ (/ α/ ,/ Y/ )/ ←/ MKeGen/ (/ 1k/ )/ ./ 为了/ 便于/ 描述/ ,/ 用/ (/ α/ t/ ,/ Yt/ )/ 表示/ 当前/ 一次性/ 陷门/ // Hash/ 密钥/ 对/ ,/ 则/ (/ α/ t/ -/ 1/ ,/ Yt/ -/ 1/ )/ 表示/ 上/ 一次/ 更新/ 时/ 的/ 陷门/ // Hash/ 密钥/ 对/ ,/ (/ α/ t/ +/ 1/ ,/ Yt/ +/ 1/ )/ 表示/ 下/ 一次/ 更新/ 时/ 的/ 陷门/ // Hash/ 密钥/ 对/ ,/ 当/ t/ =/ 0/ 时/ 表示/ 双陷门/ Hash/ 函数/ 的/ 长久/ 陷门/ // Hash/ 密钥/ 对/ ./ IkeyGen/ (/ 1k/ )/ :/ 输入/ 安全/ 参数/ 1k/ ,/ IkeyGen/ 算法/ 运行/ ABE/ ./ setup/ 算法/ 生成/ 一对/ 密钥/ (/ skI/ ,/ pkI/ )/ ←/ ABE/ ./ setup/ (/ 1k/ )/ ,/ 发布/ pkI/ 并/ 保密/ skI/ ./ CertIssue/ (/ skI/ ,/ pkI/ ,/ A/ )/ :/ 对于/ 任意/ 一个/ 属性/ 集合/ A/ ,/ CertIssue/ 算法/ 运行/ ABE/ ./ keygen/ 算法/ 生成/ 解密/ 密钥/ ./ 然后/ 设/ certA/ ·/ ·/ =/ dkA/ 是/ 一个/ 关于/ A/ 的/ 证书/ ./ InitiRoot/ (/ pkI/ ,/ root/ ,/ ω/ )/ :/ InitiRoot/ 算法/ 使用/ Add/ _/ Leaf/ (/ SK/ ,/ l/ )/ 算法/ 生成/ 树根/ ρ/ ,/ 然后/ 输入/ 属性/ 结构/ ω/ 利用/ 算法/ ABE/ ./ encrypt/ (/ ρ/ ,/ ω/ ,/ pkI/ )/ 生成/ γ/ ./ 因此/ 仅/ 有/ 满足/ 策略/ ω/ 的/ 用户/ 可以/ 利用/ 属性/ 证书/ 解密/ γ/ ,/ 并/ 通过/ MtatVrfy/ 算法/ 验证/ 叶子/ 结点/ ./ 4.2/ 构建/ 认证/ 树/ Add/ _/ Leaf/ (/ SK/ ,/ l/ )/ 路径/ 生成/ 算法/ 在/ 添加/ 叶子/ 结点/ 时/ 分为/ 两个/ 阶段/ ./ 第/ 1/ 阶段/ :/ 离线/ 阶段/ ,/ 发生/ 在/ 数据流/ 到达/ 之前/ ,/ 第/ 2/ 阶段/ :/ 在线/ 阶段/ ,/ 发生/ 在/ 数据流/ 到达/ 之后/ ./ 这里/ 设/ c/ 表示/ 计数器/ ,/ st/ 表示/ 状态表/ ,/ h/ 表示/ 树/ 的/ 高度/ ,/ 并置/ c/ ←/ 0/ ,/ st/ ←/ (/ c/ ,/ D/ ,/ [/ (/ x/ ,/ r/ ,/ Yt/ )/ ]/ )/ ./ 然后/ ,/ 选择/ 随机数/ r/ ,/ 计算/ (/ lc/ ,/ lc/ +/ 1/ )/ ←/ 槇/ Th/ (/ lc/ ,/ r/ )/ ./ 并设/ SK/ =/ (/ tk/ ,/ mtk/ ,/ st/ )/ ,/ VK/ =/ (/ hk/ ,/ mhk/ ,/ γ/ )/ ,/ 发布/ VK/ ,/ 保密/ SK/ ./ 第/ 1/ 阶段/ :/ 离线/ 阶段/ (/ 1/ )/ Add/ _/ Leaf/ (/ off/ -/ line/ )/ 算法/ 随机/ 选择/ 叶子/ 结点/ l/ 和/ 数值/ r/ ←/ {/ 0/ ,/ 1/ }/ k/ ,/ 计算/ l/ 和/ r/ 的/ 陷门/ Hash/ 函数/ ,/ 将/ 陷门/ Hash/ 值/ 赋予/ 叶子/ 结点/ l0/ 和/ l1/ ,/ 即/ (/ l0/ ,/ l1/ )/ ←/ 槇/ TH/ (/ l/ ,/ r/ )/ ,/ 并/ 计算/ 叶子/ 结点/ l0/ 和/ l1/ 的/ 父/ 节点/ n1/ ,/ 0/ 的/ Hash/ 值即/ n1/ ,/ 0/ =/ H/ (/ l0/ ‖/ l1/ )/ ./ 随机/ 选择/ (/ xh/ ,/ 1/ ,/ rh/ ,/ 1/ )/ ∈/ RM/ ×/ R/ (/ forh/ =/ 1/ ,/ …/ ,/ D/ -/ 2/ )/ ,/ 并/ 计算/ 陷门/ Hash/ 值/ nh/ ,/ 1/ =/ MTHmhk/ (/ xh/ ,/ 1/ ,/ rh/ ,/ 1/ )/ ,/ (/ forh/ =/ 1/ ,/ …/ ,/ D/ -/ 2/ )/ ,/ 随机/ 选择/ x/ ρ/ 和/ r/ ρ/ ,/ 计算/ ρ/ =/ MTHmhk/ (/ x/ ρ/ ,/ r/ ρ/ )/ ,/ 这里/ mhk/ 表示/ 长期/ Hash/ 密钥/ ,/ 其/ 相应/ 的/ 长期/ 陷门/ 密钥/ 是/ msk/ ./ 计算/ nh/ ,/ 0/ =/ H/ (/ nh/ -/ 1/ ,/ 0/ ‖/ nh/ -/ 1/ ,/ 1/ )/ (/ forh/ =/ 2/ ,/ …/ ,/ D/ -/ 2/ )/ 和/ x/ ρ/ ←/ (/ nD/ -/ 2/ ,/ 0/ ‖/ nD/ -/ 2/ ,/ 1/ )/ ./ 最后/ ,/ 计算/ r/ ρ/ ←/ MTHCol/ (/ α/ tx/ ρ/ ,/ r/ ρ/ ,/ x/ ρ/ ,/ α/ t/ +/ 1/ (/ 2/ )/ 运行/ 算法/ ABE/ ./ encrypt/ 生成/ 验证/ 根/ γ/ ←/ ABE/ ./ encrypt/ (/ ρ/ ,/ w/ ,/ pk/ )/ ./ (/ 3/ )/ 生成/ 算法/ MtatVrfy/ 中/ 用于/ 验证/ 叶子/ 结点/ l/ 的/ 认证/ 证据/ ,/ 计算/ 叶子/ 结点/ l/ 的/ 认证/ 证据/ 为/ aPath/ =/ (/ (/ n1/ ,/ 1/ ,/ …/ ,/ nD/ -/ 2/ ,/ 1/ )/ ,/ R/ ,/ Y/ )/ ,/ 并设/ R/ =/ (/ r/ ρ/ ,/ r/ )/ ./ (/ 4/ )/ 设置/ 计数器/ c/ ←/ 2/ 和/ 状态表/ st/ ←/ (/ c/ ,/ D/ ,/ x/ ρ/ ,/ r/ ρ/ ,/ [/ x/ ,/ r/ ,/ Yi/ ]/ ,/ l0/ ,/ l1/ )/ ./ 算法/ 返回/ 私钥/ SK/ =/ (/ tk/ ,/ mtk/ ,/ st/ )/ ,/ 索引/ 序号/ 为/ 0/ 和/ 认证/ 证据/ aProof/ ./ 第/ 2/ 阶段/ :/ 在线/ 阶段/ Add/ _/ Leaf/ (/ on/ -/ line/ )/ 算法/ 从/ 状态表/ 中/ 恢复/ 计数器/ c/ 的/ 值/ ./ 如果/ c/ / 0/ 则/ 运行/ Add/ _/ Leaf/ (/ on/ -/ line/ )/ 算法/ ,/ 添加/ 新/ 的/ 叶子/ 结点/ 及/ 认证/ 证据/ 生成/ 过程/ 如下/ ./ 算法/ 1/ ./ Add/ _/ Leaf/ (/ on/ -/ line/ )/ ./ forh/ =/ 1toD/ -/ 2doifc/ // 2hiseventhennh/ ,/ c/ // 2h/ =/ H/ (/ nh/ -/ 1/ ,/ c/ // 2h/ -/ 1/ ,/ nh/ -/ 1/ ,/ c/ // 2h/ -/ 1/ +/ 1/ )/ elseendifendififc/ // 2hisoddthenif/ (/ nh/ ,/ c/ // 2h/ )/ ∈/ stthenelseendifc/ ←/ c/ +/ 2endforR/ ./ add/ (/ r/ )/ output/ (/ sp/ ,/ c/ ,/ (/ aPath/ ,/ R/ ,/ Y/ )/ )/ Page74/ ./ 3/ 更新/ 认证/ 树/ Update/ _/ Leaf/ (/ SK/ ,/ VK/ ,/ i/ ,/ l/ )/ 叶子/ 节点/ 更新/ 算法/ ./ (/ 1/ )/ 更新/ 叶子/ 结点/ ,/ 令/ l/ ←/ l/ ,/ 并/ 计算/ (/ li/ ,/ li/ +/ 1/ )/ ←/ 槇/ Th/ (/ li/ ,/ ri/ )/ ./ 的/ 算法/ 如下/ ./ (/ 2/ )/ 更新/ 从/ 叶子/ 结点/ l/ 到/ 根/ 路径/ 上/ 的/ 所有/ 结点/ 算法/ 2/ ./ 更新/ 结点/ 算法/ ./ forh/ =/ 1toD/ -/ 2doifi/ // 2iseventhennh/ ,/ i/ // 2h/ =/ H/ (/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ ‖/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ +/ 1/ )/ x/ ρ/ ←/ nD/ -/ 2/ ,/ 0/ ‖/ nD/ -/ 2/ ,/ 1r/ ρ/ ←/ MTHCol/ (/ α/ tst/ ./ add/ (/ x/ ρ/ ,/ r/ ρ/ ,/ Yt/ +/ 1R/ ./ add/ (/ r/ ρ/ )/ Y/ ./ add/ (/ Yt/ +/ 1st/ ./ del/ (/ x/ ρ/ ,/ r/ ρ/ ,/ Ytendififi/ // 2isoddthenxh/ ,/ i/ // 2h/ =/ (/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ ‖/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ +/ 1/ )/ rh/ ,/ i/ // 2h/ ←/ MTHCol/ (/ α/ h/ ,/ i/ // 2ht/ ,/ xh/ ,/ i/ // 2h/ ,/ rh/ ,/ i/ // 2h/ ,/ xh/ ,/ i/ // 2h/ ,/ α/ h/ ,/ i/ // 2ht/ +/ 1/ )/ R/ ./ add/ (/ rh/ ,/ i/ // 2h/ )/ Y/ ./ add/ (/ Yh/ ,/ i/ // 2ht/ +/ 1/ )/ st/ ./ add/ (/ xh/ ,/ i/ // 2h/ ,/ rh/ ,/ i/ // 2h/ ,/ Yh/ ,/ i/ // 2ht/ +/ 1/ )/ st/ ./ del/ (/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ ,/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ +/ 1/ ,/ xh/ ,/ i/ // 2h/ ,/ rh/ ,/ i/ // 2h/ ,/ Yh/ ,/ i/ // 2ht/ )/ endifendfor4/ ./ 4/ 实时/ 验证/ MtatVrfy/ (/ VK/ ,/ i/ ,/ l/ ,/ aProof/ ,/ γ/ )/ 验证/ 算法/ ./ (/ 1/ )/ 验证/ 者/ 计算/ ρ/ / ←/ ABE/ ./ decrypt/ (/ certA/ ,/ pkI/ ,/ γ/ )/ ./ (/ 2/ )/ 验证/ 算法/ 计算/ (/ li/ ,/ li/ +/ 1/ )/ ←/ 槇/ Th/ (/ li/ ,/ r/ )/ ,/ 并/ 按照/ 以下/ 算法/ ,/ 从/ h/ =/ 2/ ,/ …/ ,/ D/ -/ 2/ 依次/ 计算/ 叶子/ 结点/ nh/ ,/ i/ // 2h/ ./ Ifi/ // 2h/ ≡/ 1mod2x/ ←/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ ‖/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ +/ 1nh/ ,/ i/ // 2h/ ←/ MTHY/ (/ x/ ;/ rh/ ,/ i/ // 2h/ )/ ,/ withrh/ ,/ i/ // 2h/ ∈/ RIfi/ // 2h/ ≡/ 0mod2x/ ←/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ -/ 2/ ‖/ nh/ -/ 1/ ,/ i/ // 2h/ -/ 1/ -/ 1nh/ ,/ i/ // 2h/ ←/ H/ (/ x/ )/ (/ 3/ )/ 验证/ 者/ 查询/ 索引/ i/ 并/ 获得/ 认证/ 证据/ aProof/ =/ (/ aPath/ ,/ R/ ,/ Y/ )/ ,/ 认证/ 证据/ 获得/ 过程/ 如下/ ./ forh/ =/ 1toD/ -/ 2doifi/ // 2iseventhenforh/ =/ 1toD/ -/ 2aPath/ =/ aPath/ ./ add/ (/ nh/ ,/ i/ // 2h/ +/ 1/ )/ R/ =/ R/ ./ add/ (/ Rh/ ,/ i/ // 2h/ +/ 1/ )/ Y/ =/ Y/ ./ add/ (/ Rh/ ,/ i/ // 2h/ +/ 1/ )/ endifaProof/ =/ (/ aPath/ ,/ R/ ,/ Y/ )/ endforoutput/ (/ aProof/ )/ (/ 4/ )/ 验证/ 者/ 通过/ ρ/ ←/ MTHY/ (/ nD/ -/ 2/ ,/ 0/ ‖/ nD/ -/ 2/ ,/ 1/ ;/ r/ ρ/ )/ (/ withr/ ρ/ ∈/ R/ )/ 计算/ 根/ 结点/ ρ/ ./ 如果/ ρ/ =/ ρ/ / 则/ 叶子/ 结点/ 可以/ 被/ 认证/ ,/ 否则/ 被/ 拒绝/ ./ 5AC/ -/ MTAT/ 方案/ 的/ 安全性/ 和/ 效率/ 分析/ 5.1/ 安全性/ 证明/ 5.1/ ./ 1/ 正确性/ 分析/ 定义/ 5/ ./ 如果/ 对于/ 任意/ 一个/ 可证/ 安全/ 的/ 双/ 陷门/ Hash/ 函数/ 和/ 访问/ 控制策略/ ω/ ,/ IkeyGen/ 生成/ 算法/ 生成/ 密钥/ 对/ (/ skI/ ,/ vkI/ )/ ←/ IkeyGen/ (/ 1k/ )/ ,/ 相对/ 于/ 任意/ 的/ 属性/ 集合/ A/ ,/ 属性/ 证书/ 生成/ 算法/ 生成/ 证书/ certA/ ←/ CertIssue/ (/ skI/ ,/ pkI/ ,/ A/ )/ ,/ 验证/ 树根/ 生成/ 算法/ 生成/ 验证/ 根/ γ/ ←/ InitiRoot/ (/ pkI/ ,/ root/ ,/ ω/ )/ ,/ 使得/ 对于/ 任意/ 的/ l/ ∈/ L/ 和/ 属性/ 集合/ A/ ,/ 如果/ A/ / w/ ,/ ρ/ / ←/ ABE/ ./ decrypt/ (/ certA/ ,/ pkI/ ,/ γ/ )/ ,/ ρ/ ←/ MTHY/ (/ nD/ -/ 2/ ,/ 0/ ‖/ nD/ -/ 2/ ,/ 1/ ;/ r/ ρ/ )/ ,/ 可以/ 输出/ {/ 1/ }/ ←/ MtatVrfy/ (/ VK/ ,/ i/ ,/ l/ ,/ aProof/ ,/ γ/ )/ ,/ 则/ 具有/ n/ 个/ 叶子/ 结点/ 的/ 有效/ 算法/ AC/ -/ MTAT/ =/ (/ MtatGen/ ,/ IkeyGen/ ,/ CertIssue/ ,/ InitiRoot/ ,/ Add/ _/ Leaf/ ,/ Update/ _/ Leaf/ ,/ MtatVrfy/ )/ 是/ 正确/ 的/ ./ 当/ 客户端/ 和/ 服务器/ 是/ 可信/ 的/ ,/ 方案/ 的/ 输出/ 应该/ 是/ ρ/ ←/ MTHY/ (/ nD/ -/ 2/ ,/ 0/ ‖/ nD/ -/ 2/ ,/ 1/ ;/ r/ ρ/ )/ ./ 具体地说/ ,/ 如果/ 用户/ 的/ 属性/ 集合/ A/ 满足/ 访问/ 策略/ ω/ ,/ 则/ 它/ 可以/ 通过/ 查询/ 的/ 方式/ 执行/ ρ/ / ←/ ABE/ ./ decrypt/ (/ certA/ ,/ pkw/ )/ 解密/ γ/ ./ 然后/ ,/ 比较/ ρ/ 和/ ρ/ / ,/ 如果/ ρ/ =/ ρ/ / ,/ 则/ 叶子/ 结点/ 可以/ 被/ 认证/ ,/ 否则/ 拒绝/ ./ 因此/ 方案/ 的/ 正确性/ 依赖于/ 单向/ 的/ 双/ 陷门/ Hash/ 函数/ 和/ CP/ -/ ABE/ 的/ 全/ 安全性/ ./ 5.1/ ./ 2/ 可验证/ 性/ 分析/ AC/ -/ MTAT/ 的/ 安全性/ 归约/ 为/ 未/ 使用/ CP/ -/ ABE/ 的/ 双/ 陷门/ Hash/ 认证/ 树/ (/ MTAT/ )/ 的/ 安全性/ 和/ 用于/ 加密/ 树根/ 的/ CP/ -/ ABE/ 算法/ 的/ 安全性/ ./ 在/ AC/ -/ MTAT/ 中/ ,/ 只有/ 符合/ 访问/ 控制策略/ 的/ 用户/ 才/ 能够/ 解析/ 验证/ 根/ γ/ ,/ 从中/ 得到/ ρ/ 后/ 才能/ 对/ 结点/ 数据/ 进行/ 验证/ ./ 下面/ 我们/ 将/ AC/ -/ MTAT/ 的/ 可验证/ 安全性/ 与/ 访问/ 安全性/ 分别/ Page8/ 进行/ 说明/ ./ 在/ 证明/ 可验证/ 安全性/ 时/ ,/ 我们/ 假设/ 攻击者/ 可以/ 攻破/ CP/ -/ ABE/ 的/ 安全性/ ,/ 即/ 攻击者/ 可以/ 通过/ ρ/ ←/ Decrypt/ (/ γ/ ,/ ω/ )/ 获得/ ρ/ ./ 因此/ ,/ 我们/ 定义/ AC/ -/ MTAT/ 是/ 可验证/ 安全/ 的/ ,/ 如果/ AC/ -/ MTAT/ 满足/ 以下/ 安全/ 性质/ ./ (/ 1/ )/ 攻击者/ 不/ 能够/ 改变/ MTAT/ 的/ 结构/ ./ (/ 2/ )/ 攻击者/ 不/ 能够/ 改变/ 树中/ 叶子/ 结点/ 的/ 序列/ ./ (/ 3/ )/ 攻击者/ 不能/ 替代/ 任意/ 一个/ 叶子/ 结点/ ./ (/ 4/ )/ 攻击者/ 不能/ 向/ MTAT/ 中/ 增加/ 新/ 叶子/ 结点/ ./ 攻击/ 模型/ ./ 下面/ 通过/ 定义/ 一个/ 挑战者/ / 和/ 攻击者/ / 之间/ 的/ 交互式/ 游戏/ GAC/ -/ MTAT/ 以上/ 属性/ ,/ 这里/ 1k/ 表示/ 安全/ 参数/ ./ 本节/ 定义/ 的/ 攻击/ 模型/ 建立/ 在/ 文献/ [/ 27/ ]/ 定义/ 的/ CAT/ 安全/ 模型/ 的/ 基础/ 之上/ ./ 挑战者/ 生成/ 一对/ 密钥/ (/ SK/ ,/ PK/ )/ 并/ 将/ 公钥/ PK/ 转发给/ 攻击者/ / ./ 攻击者/ / 向/ 挑战者/ 随机/ 发送/ z/ 个/ 叶子/ 结点/ 的/ 值/ l1/ ,/ …/ ,/ lz/ (/ k/ )/ ,/ 挑战者/ 向/ 攻击者/ 返回/ 叶子/ 结点/ 相应/ 认证/ 证据/ aProof1/ ,/ …/ ,/ aProofz/ (/ k/ )/ ./ 然后/ ,/ 攻击者/ / 通过/ 输出/ 一个/ 位于/ 树中/ 某个/ 特定/ 位置/ 的/ 且/ 尚未/ 增加/ 叶子/ 结点/ 处/ 的/ 叶子/ 结点/ ,/ 来/ 破坏/ MTAT/ 的/ 结构/ ./ 更加/ 形式化/ 的/ 描述/ 如下/ :/ 建立/ 阶段/ :/ 挑战者/ 运行/ 算法/ MtatGen/ (/ 1k/ ,/ D/ )/ 计算/ 出/ 私钥/ SK/ 和/ 一个/ 验证/ 公钥/ VK/ ./ 攻击者/ / 可以/ 获得/ 公钥/ VK/ ./ 插入/ 问询/ :/ 这是/ 一个/ 随机/ 过程/ ,/ 攻击者/ / 向/ 挑战者/ 发送/ 一组/ 叶子/ 结点/ l/ ∈/ L/ 进行/ 问询/ ./ 挑战者/ 随机/ 选择/ 一个/ 数值/ r/ ←/ {/ 0/ ,/ 1/ }/ k/ 并/ 计算/ x/ ←/ 槇/ Th/ (/ l/ ,/ r/ )/ ,/ 然后/ 运行/ 算法/ (/ sk/ ,/ i/ ,/ aProof/ )/ ←/ Add/ _/ Leaf/ (/ sk/ ,/ l/ )/ 并/ 返回/ 相应/ 的/ (/ i/ ,/ aProof/ )/ 给/ 攻击者/ / ./ 这里/ 用/ Q/ ·/ ·/ =/ {/ (/ l1/ ,/ 1/ ,/ aProof1/ )/ ,/ …/ ,/ (/ lz/ (/ k/ )/ ,/ z/ (/ k/ )/ ,/ aProofz/ (/ k/ )/ )/ }/ 表示/ 一串/ 问询/ -/ 应答/ 序列/ 对/ ./ 另外/ 将/ (/ l/ ,/ r/ )/ 记录/ 到表/ T/ 中/ ./ 更新/ 问询/ :/ 这是/ 一个/ 随机/ 过程/ ./ 攻击者/ / 发送/ 消息/ (/ i/ ,/ ln/ )/ (/ 1/ / n/ / z/ )/ 向/ 挑战者/ 进行/ 更新/ 问询/ ./ 攻击者/ 随机/ 选择/ 数值/ r/ ←/ {/ 0/ ,/ 1/ }/ k/ ,/ 并/ 计算/ x/ ←/ 槇/ Th/ (/ l/ ,/ r/ )/ ,/ 然后/ 运行/ 更新/ 算法/ (/ sk/ ,/ nPath/ ,/ aProof/ )/ ←/ Update/ _/ Leaf/ (/ sk/ ,/ i/ ,/ x/ )/ 这里/ aProof/ =/ (/ aPath/ ,/ R/ ,/ Y/ )/ ,/ 并/ 向/ 攻击者/ / 返回/ (/ i/ ,/ aProof/ )/ ./ 这里/ 用/ Q/ ·/ ·/ =/ {/ (/ l1/ ,/ i/ ,/ aProof1/ )/ ,/ …/ ,/ (/ lz/ (/ k/ )/ ,/ i/ ,/ aProofz/ (/ k/ )/ )/ }/ 表示/ 一串/ 问询/ -/ 应答/ 序列/ 对/ ./ 输出/ 阶段/ :/ 最后/ ,/ 如果/ 攻击者/ 能够/ 输出/ 下面/ 任意/ 一种/ 类型/ 的/ 结果/ ,/ 则/ 称/ 攻击者/ 赢得/ 游戏/ ./ 类型/ -/ 1/ :/ 攻击者/ / 输出/ x/ / i/ ,/ 并且/ x/ / i/ =/ xi/ ,/ 这里/ xi/ 表示/ 存储/ 在/ MTAT/ 中/ i/ 处/ 的/ 初始值/ ./ 类型/ -/ 2/ :/ 攻击者/ / 输出/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ ,/ 1/ / i/ / / z/ (/ k/ )/ ,/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ / Q/ ,/ 并且/ MtatVrfy/ (/ vk/ ,/ i/ / ,/ l/ / ,/ aProof/ / )/ =/ 1/ ./ 类型/ -/ 3/ :/ 攻击者/ / 输出/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ ,/ z/ (/ k/ )/ / i/ / / n/ 并且/ MtatVrfy/ (/ vk/ ,/ i/ / ,/ l/ / ,/ aProof/ / )/ =/ 1/ ./ 攻击者/ / 赢得/ 上述/ 游戏/ 的/ 概率/ 定义/ 为/ AdvAC/ -/ MTAT/ 定义/ 6/ ./ 对于/ 任意/ 的/ z/ ∈/ N/ ,/ 具有/ n/ 个/ 叶子/ 结点/ 的/ 有效/ 算法/ AC/ -/ MTAT/ =/ (/ MtatGen/ ,/ IkeyGen/ ,/ CertIssue/ ,/ InitiRoot/ ,/ Add/ _/ Leaf/ ,/ Updata/ _/ Leaf/ ,/ Mtat/ -/ Vrfy/ )/ 是/ 可验证/ 安全/ 的/ ,/ 若/ 对/ 任意/ 的/ 攻击者/ / 在/ 多项式/ 时间/ 内/ 赢得/ 上述/ 游戏/ 的/ 优势/ AdvAC/ -/ MTAT/ 略/ 的/ ./ 定理/ 1/ ./ 如果/ H/ 是/ 抗/ 碰撞/ Hash/ 函数/ ,/ 槇/ TH/ 是/ 单向/ 抗/ 碰撞/ 陷门/ Hash/ 函数/ ,/ MTH/ 是/ 一个/ 满足/ 定义/ 1/ 中/ 安全/ 属性/ 的/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ ,/ 则/ AC/ -/ MTAT/ 满足/ 可验证/ 性/ ./ 证明/ ./ 证明/ 过程/ 遵循/ 文献/ [/ 27/ ]/ 的/ 证明/ 过程/ ./ 假设/ 这里/ 存在/ 一个/ 攻击者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 以上/ 定义/ 的/ 游戏/ ,/ 则/ 攻击者/ / 至少/ 能够/ 输出/ 类型/ -/ 1/ 、/ 类型/ -/ 2/ 或/ 类型/ -/ 3/ 中/ 的/ 一种/ 结果/ ./ 类型/ -/ 1/ :/ 如果/ 攻击者/ / 能够/ 输出/ 类型/ -/ 1/ 的/ 结果/ ,/ 意味着/ 这里/ 存在/ 一个/ 关于/ 叶子/ 结点/ l/ 的/ 陷门/ 碰撞/ ,/ 也就是说/ 存在/ 槇/ TH/ (/ l/ / i/ ,/ r/ / i/ )/ =/ x/ / i/ =/ xi/ =/ 槇/ TH/ (/ li/ ,/ ri/ )/ ./ 然而/ 这/ 与/ 假设/ 槇/ TH/ 是/ 抗/ 碰撞/ 的/ 相/ 矛盾/ ./ 当/ x/ / i/ ≠/ xi/ 时/ ,/ 如果/ 攻击者/ / 能够/ 输出/ 类型/ -/ 2/ 或/ 类型/ -/ 3/ 的/ 结果/ ,/ 意味着/ 攻击/ 着/ 能够/ 伪造/ 位于/ i/ / 的/ 叶子/ 结点/ l/ / 的/ 认证/ 证据/ ./ 下面/ ,/ 我们/ 分别/ 对/ 这/ 两种/ 类型/ 的/ 伪造/ 攻击/ 进行/ 详细/ 讨论/ ./ 类型/ -/ 2/ :/ 当/ 攻击者/ / 输出/ 类型/ -/ 2/ 的/ 伪造/ ,/ 也就是说/ 攻击者/ / 能够/ 返回/ 一个/ 元组/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ 且/ 1/ / i/ / / z/ ./ 这/ 意味/ 者/ 我们/ 可以/ 构建/ 一个/ 算法/ / 要么/ 违背/ H/ 的/ 抗/ 碰撞/ 性/ ,/ 要么/ 违背/ MTH/ 的/ 抗/ 碰撞/ 性/ ./ 算法/ / 的/ 操作过程/ 如下/ ./ (/ 1/ )/ 建立/ 阶段/ 算法/ / 从/ {/ 0/ ,/ 1/ }/ k/ 中/ 随机/ 选择/ z/ 个/ 叶子/ 结点/ l1/ ,/ …/ ,/ lz/ 和/ z/ 个/ 字符串/ ,/ 并/ 保存/ 在/ 表/ T/ 中/ ./ 算法/ / 运行/ 算法/ (/ tk/ ,/ hk/ )/ ←/ THKeyGen/ (/ 1k/ )/ 生成/ 一对/ 陷门/ // Hash/ 密钥/ 并/ 计算/ 输出/ xi/ ←/ 槇/ Th/ (/ li/ ;/ ri/ )/ (/ i/ =/ 1/ ,/ …/ ,/ z/ )/ ./ 然后/ ,/ 算法/ / 随机/ 选择/ 一组/ 哑/ 结点/ ni/ ←/ {/ 0/ ,/ 1/ }/ len/ 用于/ 和/ z/ 个/ 叶子/ 结点/ 构造/ 一棵/ 深度/ 为/ D/ =/ poly/ (/ k/ )/ 的/ 树/ 并/ 从/ 底层/ 叶子/ 结点/ 到/ 顶部/ 计算/ 出/ 树根/ 值/ ρ/ ./ 此外/ 算法/ / 计算/ (/ (/ l1/ ,/ aProof1/ )/ ,/ …/ ,/ (/ lz/ ,/ aProofz/ )/ )/ 认证/ 证据/ ,/ 设置/ 公钥/ VK/ ←/ (/ th/ ,/ mhk/ ,/ ρ/ )/ 并/ 基于/ 公钥/ VK/ 运行/ 一个/ 攻击者/ / 的/ 黑盒/ 模拟器/ ./ 插入/ 问询/ :/ 每当/ 攻击者/ / 希望/ 将/ 叶子/ 结点/ l/ 添加/ 到/ 树/ 中时/ ./ 攻击者/ / 随机/ 选择/ 一个/ 新鲜/ 值/ ,/ 计算/ 并/ Page9i/ ,/ aProof/ )/ ←/ addLeaf/ (/ sk/ ,/ x/ )/ ,/ 并/ 返回/ aProof/ =/ (/ aPath/ ,/ i/ ,/ r/ )/ 给/ 攻击者/ / ,/ 并/ 将/ (/ l/ ,/ r/ )/ 记录/ 到表/ T/ 中/ ./ (/ 2/ )/ 更新/ 问询/ 每当/ 攻击者/ / 希望/ 将/ 位于/ ith/ 的/ 叶子/ 结点/ l/ 更新/ 为/ l/ 时/ ./ 算法/ / 依照/ 下面/ 方式/ 应答/ 攻击者/ / 的/ (/ i/ ,/ l/ )/ 更新/ 问询/ ./ 首先/ 算法/ / 运行/ 求/ 碰撞/ 函数/ MTHCol/ ,/ 计算/ 出/ MTH/ 的/ 一个/ 碰撞/ 值/ r/ ←/ MTHCol/ (/ α/ t/ ,/ l/ ,/ r/ ,/ l/ ,/ α/ t/ +/ 1/ )/ ,/ 接着/ 将/ 位于/ ith/ 的/ 叶子/ 结点/ l/ 更新/ 为/ l/ ,/ r/ 更新/ 为/ r/ 并/ 保存/ 一次性/ Hash/ 密钥/ Yt/ +/ 1/ ./ 然后/ ,/ 算法/ / 运行/ 认证/ 证据/ 生成/ 算法/ (/ sk/ ,/ i/ ,/ aProof/ )/ ←/ Add/ _/ Leaf/ (/ sk/ ,/ l/ )/ ,/ 更新/ 叶子/ 结点/ l/ 的/ 认证/ 路径/ aPath/ 上/ 所有/ 结点/ ,/ 并/ 运行/ 更新/ 算法/ Update/ _/ Leaf/ (/ SK/ ,/ VK/ ,/ i/ ,/ l/ )/ ,/ 更新/ 位于/ 从/ 叶子/ 结点/ l/ 到/ 根/ 路径/ nPath/ 上/ 结点/ 信息/ ./ 最后/ ,/ 算法/ / 返回/ 认证/ 证据/ aProof/ =/ (/ aPath/ ,/ i/ ,/ r/ ,/ Yt/ +/ 1/ )/ 给/ 攻击者/ / ./ (/ 3/ )/ 输出/ 阶段/ 最后/ ,/ 算法/ / 返回/ (/ x/ / ,/ i/ / ,/ aProof/ / )/ ,/ 攻击者/ 输出/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ / Q/ (/ 这里/ aProof/ / =/ (/ aPath/ / ,/ R/ / ,/ Y/ / )/ ,/ x/ / ←/ 槇/ Th/ (/ l/ / ;/ r/ / )/ )/ 后/ 停止/ 运行/ ./ 由于/ 攻击者/ / 运行/ 在/ 多项式/ 时间/ 内/ ,/ 所以/ 算法/ / 是/ 有效/ 的/ ./ 基于/ 文献/ [/ 27/ ]/ 的/ 描述/ ,/ 这/ 意味着/ 存在/ 一个/ Hash/ 碰撞/ H/ (/ aPathi/ ‖/ nPathi/ )/ =/ H/ (/ aPath/ / i/ ‖/ nPath/ / i/ )/ ,/ 或者/ 一个/ 陷门/ Hash/ 碰撞/ MTH/ (/ aPathinPathi/ )/ =/ MTH/ (/ aPath/ / i/ ‖/ nPath/ / i/ )/ ,/ 这里/ nPath/ / =/ (/ v/ / D/ -/ 2/ ,/ i/ // 2D/ -/ 2/ )/ ./ 这/ 与/ MTH/ 或/ H/ 是/ 抗/ 碰撞/ 的/ 相/ 矛盾/ ./ V/ / 类型/ -/ 3/ :/ 当/ 攻击者/ / 输出/ 类型/ -/ 3/ 的/ 伪造/ ,/ 也就是说/ 攻击者/ / 能够/ 返回/ 一个/ 元组/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ 且/ z/ +/ 1/ / i/ / / 2D/ ./ 这/ 意味着/ 我们/ 可以/ 构建/ 一个/ 算法/ / 要么/ 破坏/ MTH/ 的/ 抗/ 一次/ 碰撞/ 性/ ,/ 要么/ 破坏/ MTH/ 的/ 单向性/ ./ 观察/ 攻击者/ / 输出/ 的/ 响应/ 认证/ 路径/ ,/ 该/ 路径/ 上/ 必然/ 包含/ 了/ 一个/ 这样/ 的/ 结点/ ,/ 该/ 结点/ 是/ lz/ 结点/ 的/ 认证/ 路径/ 上/ 的/ 结点/ ,/ 且/ 该/ 结点/ 必然/ 是/ 由/ 双/ 陷门/ Hash/ 函数/ 计算/ 出/ 的/ 结点/ ./ 而且/ 更新/ 问询/ 并/ 不能/ 改变/ 结点/ 上/ 原有/ 的/ 陷门/ Hash/ 值/ ./ 这样/ 我们/ 可以/ 构建/ 一个/ 算法/ / 要么/ 破坏/ MTH/ 的/ 单向性/ ,/ 要么/ 破坏/ MTH/ 的/ 抗/ 碰撞/ 性/ 或/ 无/ 密钥/ 泄露/ 性/ ./ 下面/ 描述/ 如何/ 构建/ 算法/ / 的/ 推导/ 过程/ ./ (/ 1/ )/ 建立/ 阶段/ 算法/ / 运行/ 一个/ 黑盒/ 模拟器/ 并/ 返回/ z/ 个/ 叶子/ 结点/ l1/ ,/ …/ ,/ lz/ 给/ 攻击者/ / ./ 攻击者/ / 选择/ 由双/ 陷门/ Hash/ 函数/ n/ / Hash/ 结点/ ./ 然后/ 算法/ / 使用/ z/ 个/ 叶子/ 结点/ 和/ t/ 个/ 陷门/ Hash/ 结点/ n1/ ,/ …/ ,/ n/ / poly/ (/ k/ )/ 的/ 树/ 并/ 从/ 底层/ 叶子/ 结点/ 到/ 顶部/ 计算/ 出/ 树根/ 值/ ρ/ ./ (/ 2/ )/ 插入/ 问询/ 每当/ 攻击者/ / 希望/ 将/ 叶子/ 结点/ l/ 添加/ 到/ 树/ 中时/ ./ 算法/ / 从表/ T/ 中/ 恢复/ 一对/ 值/ (/ xi/ ,/ ri/ )/ ,/ 并/ 计算/ 陷门/ 碰撞/ 值/ r/ ←/ MTHCol/ (/ mtk/ ,/ l/ ,/ r/ ,/ l/ ,/ Yt/ )/ ./ 算法/ / 返回/ aProof/ =/ (/ aPath/ ,/ i/ ,/ r/ )/ 给/ 攻击者/ / ./ 每当/ 攻击者/ / 希望/ 将/ 位于/ ith/ 的/ 叶子/ 结点/ l/ 更新/ 为/ l/ 时/ ./ 算法/ / 依照/ 下面/ 方式/ 应答/ 攻击者/ / 的/ (/ i/ ,/ l/ )/ 更新/ 问询/ ./ 首先/ 算法/ / 运行/ 求/ 碰撞/ 函数/ Col/ ,/ 计算/ 出/ MTH/ 的/ 一个/ 碰撞/ 值/ r/ ←/ MTHCol/ (/ α/ t/ ,/ l/ ,/ r/ ,/ l/ ,/ α/ t/ +/ 1/ )/ ,/ 接着/ 将/ 位于/ ith/ 的/ 叶子/ 结点/ l/ 更新/ 为/ l/ ,/ r/ 更新/ 为/ r/ 并/ 保存/ 一次性/ Hash/ 密钥/ Yt/ +/ 1/ ./ 然后/ ,/ 算法/ / 运行/ 认证/ 证据/ 生成/ 算法/ (/ sk/ ,/ i/ ,/ aProof/ )/ ←/ Add/ _/ Leaf/ (/ sk/ ,/ l/ )/ ,/ 更新/ 叶子/ 结点/ l/ 的/ 认证/ 路径/ aPath/ 上/ 所有/ 结点/ ,/ 并/ 运行/ 更新/ 算法/ 更新/ 位于/ 从/ 叶子/ 结点/ l/ 到/ 根/ 路径/ nPath/ 上/ 结点/ 信息/ ./ 最后/ ,/ 算法/ / 返回/ 认证/ 证据/ aProof/ =/ (/ aPath/ ,/ i/ ,/ r/ ,/ Yt/ +/ 1/ )/ 给/ 攻击者/ / ./ (/ 3/ )/ 更新/ 问询/ 当/ 攻击者/ / 向/ 挑战者/ 发送/ (/ i/ ,/ l/ )/ 希望/ 更新/ ith/ 处/ 的/ 叶子/ 结点/ 为/ l/ ./ 算法/ / 从表/ T/ 中/ 恢复/ 一组/ 值/ (/ xi/ ,/ ri/ ,/ Yt/ )/ 并/ 计算/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ 的/ 一个/ 碰撞/ 值/ r/ ←/ Col/ (/ Yt/ ,/ l/ ,/ r/ ,/ l/ ,/ Yt/ +/ 1/ )/ ./ 然后/ ,/ 算法/ / 运行/ (/ sk/ ,/ i/ ,/ aProof/ )/ ←/ Add/ _/ Leaf/ (/ sk/ ,/ l/ )/ ,/ 更新/ 叶子/ 结点/ l/ 的/ 认证/ 路径/ aPath/ 上/ 所有/ 结点/ ,/ 并/ 将/ 一次性/ Hash/ 密钥/ Yt/ ←/ Yt/ +/ 1/ 保存/ 在/ 表/ T/ 中/ ./ 最后/ 将/ 认证/ 证据/ aProof/ =/ (/ aPath/ ,/ i/ ,/ r/ ,/ Yt/ )/ 返回/ 给/ 攻击者/ / ./ (/ 4/ )/ 输出/ 阶段/ 最后/ 攻击者/ 输出/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ / Q/ (/ 这里/ aProof/ / =/ (/ aPath/ / ,/ R/ / ,/ Y/ / )/ ,/ x/ / ←/ 槇/ Th/ (/ l/ / ;/ r/ / )/ )/ ,/ z/ +/ 1/ / i/ / / 2D/ 且/ MtatVrfy/ (/ PK/ ,/ i/ / ,/ l/ / ,/ aProof/ / )/ =/ 1/ 后/ 停止/ 运行/ ./ 我们/ 观察/ 攻击者/ / 的/ 输出/ 元组/ (/ l/ / ,/ i/ / ,/ aProof/ / )/ ,/ 这里/ aProof/ / =/ (/ aPath/ / ,/ i/ / ,/ R/ / ,/ Y/ / )/ ./ 设/ nPath/ / =/ (/ v/ / 1/ ,/ i/ // 2/ ,/ …/ ,/ v/ / 的/ 路径/ ./ 因为/ z/ +/ 1/ / i/ / / 2D/ ,/ 则/ 结点/ n1/ ,/ …/ ,/ n/ / nt/ 中/ 至少/ 存在/ 一个/ 结点/ 位于/ l/ / 的/ 认证/ 路径/ 上/ ./ 由于/ t/ 是/ 一个/ 多项式/ ,/ 因此/ 算法/ / 能够/ 以/ 不/ 可以/ 忽略/ 的/ 概率/ 猜测出/ 树中/ 的/ 索引/ 序列/ ./ 假设/ 算法/ 猜测/ 的/ 索引/ 序列/ 是/ 正确/ 的/ ,/ 则/ 这里/ 存在/ 一个/ 索引/ j/ 使得/ nj/ =/ n/ / 意味着/ 算法/ / 能够/ 利用/ n/ / 对值/ (/ x/ / Page10j/ ,/ r/ / j/ )/ =/ (/ xj/ ,/ rj/ )/ ,/ 则/ 算法/ / 破坏/ 了/ MTH/ 的/ 单向性/ ,/ 如/ r/ / 果/ (/ x/ / 撞性/ 或/ 无/ 密钥/ 泄露/ 性/ ./ 更进一步/ 讲/ ,/ 假设/ 攻击者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ ε/ (/ k/ )/ 赢得/ 游戏/ ,/ 则/ 算法/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ ε/ (/ k/ )/ // t/ 获得成功/ ./ 证毕/ ./ 5.1/ ./ 3/ 访问/ 安全性/ 分析/ 在/ AC/ -/ MTAT/ 方案/ 的/ 证明/ 中/ ,/ 仅/ 满足/ 访问/ 策略/ 的/ 用户/ 能够/ 检测/ 和/ 验证/ 数据流/ ./ 在/ 认证/ 树/ 的/ 构造/ 过程/ 中/ ,/ 用户/ 只有/ 解密/ γ/ 并/ 获得/ 证据/ 后/ 才/ 能够/ 验证/ 外/ 包/ 数据流/ ./ 我们/ 假设/ 从/ AC/ -/ MTAT/ 获得/ 的/ 认证/ 证据/ 是/ 正确/ 的/ ,/ 则/ 意味着/ 当且/ 仅/ 当/ 用户/ 获得/ ρ/ 后/ ,/ 才/ 能够/ 检测/ 和/ 验证/ 外/ 包/ 数据流/ ./ 因此/ 通过/ 在/ 挑战者/ 和/ 攻击者/ / 之间/ 建立/ 一个/ 交互式/ 游戏/ GAccess/ 以上/ 过程/ ./ 形式化/ 描述/ 过程/ 如下/ :/ 系统/ 建立/ :/ 挑战者/ 运行/ 算法/ IskeyGen/ (/ 1k/ )/ 生成/ 私钥/ skI/ 和/ 一个/ 验证/ 密钥/ pkI/ ./ 将/ pkI/ 发送给/ 攻击者/ / ,/ 计算/ γ/ ←/ Initialization/ (/ k/ ,/ pkI/ ,/ ρ/ ,/ ω/ )/ ./ 查询/ 阶段/ :/ 这是/ 一个/ 随机/ 过程/ ,/ 攻击者/ / 随机/ 发送/ 一系列/ 询问/ ω/ 1/ ,/ ω/ 2/ ,/ …/ ,/ ω/ q/ 给/ 挑战者/ ,/ 挑战者/ 返回/ 相应/ 认证/ 密钥/ cert/ ω/ 1/ ,/ …/ ,/ cert/ ω/ q/ ./ 挑战者/ 计算/ ρ/ i/ ←/ Decrypt/ (/ cert/ ω/ i/ ,/ γ/ )/ 并/ 将/ ρ/ i/ 返回/ 给/ 攻击者/ / ./ 将/ 一组/ 有序/ 询问/ -/ 应答/ 对/ 记作/ Ce/ ·/ ·/ =/ {/ (/ cert/ ω/ 1/ ,/ ρ/ 1/ )/ ,/ …/ ,/ (/ cert/ ω/ q/ ,/ ρ/ q/ )/ }/ ./ 输出/ :/ 最后/ 攻击者/ / 输出/ 一对/ (/ cert/ ,/ ρ/ )/ 和/ MTAT/ ./ Verify/ (/ auth/ ,/ i/ ,/ l/ ,/ pk/ ,/ ρ/ )/ =/ 1/ 后/ 停止/ ,/ 则/ 攻击者/ 赢得/ 游戏/ ./ 我们/ 定义/ 攻击者/ / 赢得/ 游戏/ 的/ 概率/ 优势/ 为/ A/ ./ 定义/ 7/ ./ 如果/ 对于/ 任意/ 的/ 多项式/ 时间/ 攻击者/ / advAccess/ 赢得/ 游戏/ 的/ 概率/ advAccess/ 是/ 访问/ 安全/ 的/ ./ 定理/ 2/ ./ 如果/ AC/ -/ MTAT/ 方案/ 是/ 可验证/ 安全/ 的/ 并且/ CP/ -/ ABE/ 方案/ 是/ 全/ 安全/ 的/ ,/ 则/ AC/ -/ MTAT/ 满足/ 访问/ 安全性/ ./ 证明/ ./ 如果/ 这里/ 存在/ 一个/ 攻击者/ / 能够/ 赢得/ A/ (/ 1k/ )/ ,/ 则/ 这里/ 要么/ 存在/ 一个/ 攻击者/ 能够/ 以/ 游戏/ GAccess/ 不可/ 忽略/ 的/ 概率/ 破坏/ AC/ -/ MTAT/ 的/ 可验证/ 安全性/ ,/ 要么/ 存在/ 一个/ 攻击者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 破坏/ CP/ -/ ABE/ 的/ 安全性/ ./ 定理/ 1/ 证明/ 了/ AC/ -/ MTAT/ 满足/ 可验证/ 安全性/ ./ 基于/ 定理/ 1/ 的/ 证明/ ,/ 如果/ CP/ -/ ABE/ 是/ 全/ 安全/ 的/ ,/ 则/ AC/ -/ MTAT/ 满足/ 访问/ 安全性/ ./ 这里/ 存在/ 一个/ 攻击者/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 游/ A/ 则/ 存在/ 一个/ 算法/ / 能够/ 破坏/ CP/ -/ ABE/ 的/ 全戏/ GAccess/ 安全性/ ./ 系统/ 建立/ :/ 算法/ / 获得/ CP/ -/ ABE/ 的/ 公钥/ pkI/ ./ 则/ 算法/ / 通过/ 运行/ Initialization/ (/ k/ ,/ pkI/ ,/ ρ/ ,/ ω/ )/ 和/ 属性/ 集合/ ω/ 生成/ γ/ ,/ 这里/ ρ/ =/ DecryptABE/ (/ certA/ ,/ γ/ )/ ,/ 并/ 发送/ (/ pkI/ ,/ γ/ )/ 给/ 攻击者/ / ./ 查询/ 阶段/ :/ 当/ 攻击者/ / 为/ 属性/ Ai/ 生成/ 问询/ ,/ 这里/ Ai/ 不/ 满足/ ω/ ,/ 算法/ / 使用/ 自己/ 的/ 随机/ 预言/ 机/ 应答/ / 的/ 问询/ ./ 算法/ / 选择/ 一个/ 随机/ 值/ t/ ,/ 并/ 发送/ (/ t/ ,/ ρ/ )/ 给/ 挑战者/ ./ 收到/ 应答/ C/ 后/ ,/ / 设置/ C/ 为/ 应答/ 值/ ./ 输出/ :/ 最后/ ,/ 如果/ / 的/ 输出/ 是/ ρ/ 和/ MTAT/ ./ Verify/ (/ aProof/ ,/ i/ ,/ l/ ,/ pk/ ,/ ρ/ )/ =/ 1/ ,/ 则/ / 输出/ “/ 1/ ”/ ,/ 否则/ / 输出/ “/ 0/ ”/ ./ 由于/ 方案/ 所/ 基于/ 的/ CP/ -/ ABE/ 是/ 全/ 安全/ 的/ ,/ 因此/ 这里/ 不/ 存在/ 一个/ 攻击者/ / 能够/ 以/ 不可/ 忽略/ 的/ 概率/ 输出/ ρ/ ./ 对于/ 任意/ 一个/ 攻击者/ / ,/ 我们/ 可以/ 得到/ Pr/ [/ GAccessA/ =/ 1/ ]/ / negli/ (/ k/ )/ ,/ 这里/ negli/ (/ )/ 表示/ 可/ 忽略/ 的/ 函数/ ./ 5.2/ 效率/ 分析/ 本/ 方案/ 的/ 效率/ 主要/ 体现/ 在/ Hash/ 函数/ 、/ 双陷门/ Hash/ 函数/ 以及/ 计算/ 碰撞/ 所/ 需/ 的/ 时间/ 和/ 计算资源/ ./ 基于/ 属性/ 的/ 加密/ CP/ -/ ABE/ 在/ 方案/ 中以/ 黑盒/ 形式/ 出现/ ,/ 其/ 效率/ 取决于/ 具体/ 方案/ 的/ 使用/ ,/ 因此/ 我们/ 主要/ 以/ Hash/ 函数/ 、/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ 和/ 计算/ 碰撞/ 的/ 计算/ 开销/ 为/ 衡量/ 指标/ 来/ 分析/ 本/ 方案/ 的/ 效率/ ,/ 设/ Exp/ (/ H/ )/ 表示/ 计算/ Hash/ 函数/ 所/ 需/ 时间/ ,/ Exp/ (/ MTH/ )/ 表示/ 计算/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ 所/ 需/ 时间/ ,/ Exp/ (/ Col/ )/ 表示/ 计算/ 碰撞/ 所/ 需/ 时间/ ./ 我们/ 的/ 方案/ 可以/ 用/ 任意/ 一个双/ 陷门/ Hash/ 函数/ 来/ 初始化/ ,/ 但是/ 为了/ 便于/ 分析/ 比较/ ,/ 本/ 方案/ 采用/ 一种/ 基于/ 离散/ 对数/ 假设/ 安全/ 的/ 、/ 无/ 密钥/ 泄露/ 的/ 双/ 陷门/ Hash/ 函数/ [/ 2/ ]/ 对本/ 方案/ 进行/ 实例/ 化/ ./ 与/ CAT/ 中/ KR/ 变色龙/ Hash/ 函数/ 一样/ ,/ 双陷门/ Hash/ 函数/ 同样/ 支持/ Bellare/ 等/ 人/ [/ 30/ ]/ 提出/ 的/ 批/ 验证/ 技术/ ./ 首先/ 从/ 理论/ 上/ 分析/ 算法/ 在/ 动态/ 增加/ 、/ 更新/ 和/ 验证/ 时/ 的/ 效率/ ./ 具体分析/ 如下/ :/ (/ 1/ )/ 数据流/ 动态/ 增加/ 效率/ 分析/ 由于/ 可以/ 在/ 相同/ 根下/ 对/ 陷门/ Hash/ 函数/ 多次/ 更新/ 也/ 是/ 安全/ 的/ ,/ 不/ 存在/ 密钥/ 泄露/ 的/ 问题/ ,/ 由此/ ,/ 我们/ 可以/ 基于/ 分期/ 偿还/ 机制/ 在/ 离线/ 阶段/ 构建/ 一棵/ 初始化/ 认证/ 树/ ,/ 初始化/ 认证/ 树/ 构建/ 的/ 过程/ 中/ ,/ 包含/ 了/ 构建/ 认证/ 树时/ 最坏/ 的/ 情况/ ,/ 即/ 向/ 空树/ 增加/ 第/ 1/ 个/ 结点/ 时/ 所/ 需/ 时间/ 是/ 最长/ 的/ ./ 因此/ ,/ 在/ 在线/ 阶段/ 本/ 方案/ 的/ 效率/ 是/ 高于/ CAT/ 方案/ 的/ ./ 根据/ 本/ 方案/ 的/ 算法/ ,/ 当/ 增加/ 叶子/ 结点/ 时/ ,/ 分为/ 两种/ 情况/ ./ 如果/ 插入/ 左/ 叶子/ 结点/ ,/ 所/ 消耗/ 时间/ 不/ 大于/ (/ D/ -/ 3/ )/ Exp/ (/ H/ )/ +/ (/ D/ -/ 2/ )/ Exp/ (/ MTH/ )/ +/ Page11Exp/ (/ Col/ )/ ;/ 如果/ 插入/ 右/ 叶子/ 结点/ ,/ 所/ 消耗/ 时间/ 不/ 大于/ Exp/ (/ MTH/ )/ +/ Exp/ (/ Col/ )/ ./ (/ 2/ )/ 数据流/ 更新/ 效率/ 分析/ 同理/ ,/ 对于/ 叶子/ 结点/ 的/ 更新/ 也/ 分为/ 两种/ 情况/ ./ 如果/ 更新/ 左/ 叶子/ 结点/ ,/ 所/ 消耗/ 时间/ 不/ 大于/ (/ D/ -/ 3/ )/ Exp/ (/ H/ )/ +/ Exp/ (/ Col/ )/ ;/ 如果/ 更新/ 右/ 叶子/ 结点/ ,/ 所/ 消耗/ 时间/ 为/ Exp/ (/ Col/ )/ ./ CAT/ 方案/ 在/ 数据/ 更新/ 时/ 需要/ 重新/ 构建/ 认证/ 树/ 和/ 生成/ 公钥/ ,/ 显然/ 代价/ 较/ 高/ ./ (/ 3/ )/ 数据流/ 验证/ 效率/ 分析/ 验证/ 过程/ 中/ 在/ 不/ 考虑/ 访问控制/ 的/ 情况/ 下/ ,/ 本/ 方案/ 与/ CAT/ 方案/ 的/ 验证/ 效率/ 相同/ ./ 在/ 最坏/ 情况/ 下/ ,/ 验证/ 者/ 需要/ 计算/ D/ 次/ 陷门/ Hash/ 函数/ ,/ 即/ 所/ 消耗/ 时间/ 为/ D/ (/ Exp/ (/ MTH/ )/ )/ ./ 文献/ [/ 2/ ]/ 中/ 的/ 无/ 密钥/ 泄露/ 的/ 陷门/ Hash/ 函数/ 同样/ 支持/ Bellare/ 等/ 人/ [/ 30/ ]/ 提出/ 的/ 批/ 验证/ 技术/ ,/ 从而/ 大大降低/ 计算/ 的/ 复杂度/ ./ 接着/ ,/ 在/ 以上/ 分析/ 的/ 基础/ 上/ ,/ 我们/ 实现/ 了/ AC/ -/ MTAT/ 的/ 一些/ 主要/ 算法/ 来/ 模拟/ AC/ -/ MTAT/ 的/ 工作/ 过程/ ./ 采用/ 的/ 硬件/ 设备/ 配置/ 是/ IntelCorei5/ 、/ 内存/ 4GB1600MHzDDR3RAM/ ./ 代码/ 采用/ JAVA1/ ./ 6/ 版本/ 编写/ 并/ 基于/ Java/ 安全/ 数据包/ 实现/ 密码/ 操作/ ./ 我们/ 通过/ 实现/ 双陷门/ Hash/ 函数/ [/ 2/ ]/ 和/ MD5Hash/ 函数/ 来/ 实现/ 认证/ 树/ ./ 如表/ 1/ 所示/ ,/ 我们/ 进行/ 了/ 4/ 组/ 实验/ ,/ 每组/ 实验/ 分别/ 对/ 高度/ 为/ 10/ 层/ 、/ 20/ 层/ 、/ 40/ 层/ 和/ 80/ 层/ 的/ 认证/ 树/ 算法/ 进行/ 评估/ ,/ 每组/ 实验/ 的/ 算法/ 执行/ 500/ 次取/ 平均值/ ./ 第/ 1/ 组/ 实验/ 评估/ 初始化/ 认证/ 树所/ 耗费/ 的/ 平均/ 时间/ ,/ 第/ 2/ 组/ 实验/ 分别/ 评估/ 在/ 最好/ 情况/ 下/ 和/ 最坏/ 情况/ 下/ 动态/ 添加/ 数据/ 所/ 需要/ 的/ 平均/ 时间/ ,/ 第/ 3/ 组/ 实验/ 分别/ 评估/ 在/ 最好/ 情况/ 下/ 和/ 最坏/ 情况/ 下/ 实时/ 更新/ 数据/ 所/ 需要/ 的/ 平均/ 时间/ ,/ 第/ 4/ 组/ 实验/ 分别/ 评估/ 在/ 最好/ 情况/ 下/ 和/ 最坏/ 情况/ 下/ 验证/ 数据/ 所/ 需要/ 的/ 平均/ 时间/ ./ 评估/ 结果/ 如表/ 1/ 所示/ ,/ 说明/ 我们/ 的/ 方案/ 是/ 有效/ 的/ 和/ 可行/ 的/ ./ 建树/ 层数/ (/ level/ )/ 10307/ ~/ 137/ ~/ 2122/ ~/ 2620537/ ~/ 217/ ~/ 2931/ ~/ 32401018/ ~/ 387/ ~/ 4549/ ~/ 53801948/ ~/ 727/ ~/ 8682/ ~/ 83/ 最后/ ,/ 我们/ 对/ 算法/ 在/ 处理/ 大规模/ 结点/ 时/ 的/ 效率/ 问题/ 进一步/ 分析/ 和/ 测试/ ./ 分别/ 测试/ 了/ 初始化/ 认证/ 算法/ 、/ 增加/ 算法/ 、/ 更新/ 算法/ 和/ 验证/ 算法/ 在/ 不同/ 建树/ 层次/ 下/ 处理/ 大规模/ 数据/ 的/ 效率/ ./ 如图/ 3/ (/ a/ )/ 所示/ ,/ 在/ 系统/ 初始化/ 阶段/ ,/ 需要/ 构建/ 初始化/ 认证/ 树/ ,/ 其/ 计算/ 开销/ 只/ 与/ 建树/ 层次/ 有关/ ,/ 随着/ 建树/ 层次/ 的/ 增加/ ,/ 初始化/ 认证/ 树/ 的/ 时间/ 随之/ 线性/ 增加/ ./ 在/ 新/ 结点/ 加入/ 时/ ,/ 图/ 3/ (/ b/ )/ 描述/ 了/ 不同/ 建树/ 层次/ 下/ ,/ 新增/ 结点/ 数量/ 对/ 增加/ 算法/ 平均/ 消耗/ 时间/ 的/ 影响/ ,/ 实验/ 数据/ 表明/ 随着/ 建树/ 层次/ 的/ 增加/ ,/ 增加/ 算法/ 的/ 平均/ 消耗/ 时间/ 略微/ 增加/ ,/ 但是/ 在/ 同/ 一层/ 数下/ ,/ 增加/ 结点/ 的/ 规模/ 对/ 增加/ 算法/ 的/ 平均/ 消耗/ 时间/ 影响/ 较/ 小/ ,/ 一直/ 保持/ 相对/ 稳定/ ,/ 说明/ 增加/ 算法/ 具有/ 良好/ 的/ 稳定性/ ./ 当/ 更新/ 结点/ 时/ ,/ 图/ 3/ (/ c/ )/ 描述/ 了/ 建树/ 层数/ 与/ 更新/ 结点/ 数量/ 对/ 更新/ 算法/ 平均/ 消耗/ 时间/ 的/ 影响/ ,/ 随着/ 建树/ 层次/ 的/ 增加/ ,/ 更新/ 结点/ 的/ 平均/ 时间/ 增加量/ 相当/ 微小/ ,/ 表现/ 出对/ 建树/ 层次/ 良好/ 的/ 适应性/ ./ 随着/ 更新/ 结点/ 数/ 的/ 增加/ ,/ 更新/ 时间/ 几乎/ 保持/ 不变/ ,/ 表明/ 更新/ 算法/ 在/ 处理/ 大规模/ 数据/ 更新/ 时/ 依然/ 具有/ 良好/ 的/ 性能/ ./ 当对/ 结点/ 进行/ 验证/ 时/ ,/ 假设/ 已/ 通过/ 属性/ 证书/ 获得/ 验证/ 根/ ,/ 图/ 3/ (/ d/ )/ 描述/ 了/ 建树/ 层数/ 与/ 验证/ 结点/ 数量/ 对/ 验证/ 算法/ 平均/ 消耗/ 时间/ 的/ 影响/ ,/ 在/ 验证/ 过程/ 中/ ,/ 建树/ 层次/ 决定/ 了/ 验证/ 路径/ 的/ 长度/ ,/ 随着/ 验证/ 路径/ 长度/ 的/ 增加/ ,/ 相应/ 结点/ 的/ 验证/ 时间/ 也/ 会/ 随之/ 线性/ 增加/ ./ 当/ 认证/ 树/ 层数/ 相同/ 时/ ,/ 实验/ 结果表明/ 随着/ 验证/ 结点/ 数量/ 的/ 增加/ ,/ 相应/ 结点/ 的/ 平均/ 验证/ 时间/ 也/ 会/ 线性/ 增加/ ,/ 但/ 增加/ 的/ 趋势/ 越来越/ 小/ ,/ 反应/ 出/ 验证/ 算法/ 在/ 验证/ 大规模/ 数据/ 时/ 的/ 优越性/ ./ 5.3/ 方案/ 比较/ 与/ 现有/ 典型/ 方案/ 相比/ ,/ 如表/ 2/ 所示/ ,/ 本/ 方案/ 在/ 验证/ 者/ 的/ 存储/ 负荷/ 、/ 验证/ 者/ 的/ 计算/ 负荷/ 、/ 服务器/ 的/ 计算/ 复杂度/ 以及/ 通信/ 代价/ 方面/ 的/ 复杂度/ 均/ 为/ O/ (/ logn/ )/ ./ 此外/ ,/ 在/ 同一/ 共享/ 群中本/ 方案/ 可以/ 实现/ 基于/ 属性/ 的/ 授权/ 验证/ ,/ 既/ 可/ 避免/ 私有/ 验证/ 带来/ 的/ 私钥/ 泄露/ 问题/ ,/ 又/ 能/ 防止/ 公开/ 验证/ 带来/ 的/ 范围/ 过大/ 问题/ ./ 通过/ 引入/ 双陷门/ Hash/ 函数/ ,/ 实现/ 了/ 离线/ 初始/ 构建/ 与/ 在线/ 实时/ 更新/ 相结合/ 的/ 动态/ 可验证/ 树/ ,/ 在/ 未/ 获得/ 叶子/ 节点/ 时/ 仍/ 能/ 构建/ 初始/ 可验证/ 树/ ,/ 通过/ 更新/ 碰撞/ 值/ 无需/ 重新/ 计算/ 全部/ 节点/ 信息/ 即可/ 完成/ 可验证/ 树/ 的/ 在线/ 实时/ 更新/ ,/ 在/ 数据/ 持续增长/ 的/ 同时/ 叶子/ 结点/ 动态/ 增加/ 、/ 验证/ 路径/ 动态/ 生成/ 、/ 验证/ 证据/ 实时/ 构建/ ,/ 实现/ 了/ 动态数据/ 边读/ 边/ 写边/ 验证/ ./ 本/ 方案/ 支持/ 对/ 大批量/ 数据流/ 的/ 高效/ 动态/ 更新/ ./ 大批量/ 数据流/ 传输/ 时/ 必然/ 会/ 存在/ 出错/ 重传/ 问题/ ./ 现有/ 方案/ 中/ 一旦/ 出现/ 被/ 检验/ 数据/ 有/ 错误/ 的/ 情形/ ,/ 则/ 数据/ 拥有者/ 必须/ 重传/ 整个/ 数据/ ,/ 而云/ 计算/ 服务提供商/ 必须/ 重新/ 构建/ 整棵/ 验证/ 树/ ./ 本/ 方案/ 只/ 需重/ 传出/ 错/ 数据/ 块/ 并/ 更新/ 该/ 数据/ 块/ 从/ 叶子/ 节点/ 到/ 根/ 节点/ 路径/ 上/ 的/ 节点/ 信息/ ,/ 动态/ 更新/ 的/ 代价/ 由/ O/ (/ 2n/ -/ 1/ )/ 降低/ 为/ O/ (/ logn/ -/ 1/ )/ ./ Page12/ 图/ 3/ 平均/ 消耗/ 时间/ 的/ 比较/ 表/ 2/ 方案/ 的/ 特性/ 比较/ (/ 狀/ 代表/ 叶子/ 节点/ 个数/ )/ 方案/ CAT/ 基于/ 属性/ 的/ 授权/ 验证/ ×/ ×/ ×/ ×/ √/ 流/ √/ ×/ ×/ ×/ √/ 实时/ 验证/ √/ ×/ ×/ ×/ √/ 离线/ 预处理/ ×/ ×/ ×/ ×/ √/ 动态/ 更新/ 的/ 代价/ O/ (/ 2n/ -/ 1/ )/ O/ (/ 2n/ -/ 1/ )/ O/ (/ 2n/ -/ 1/ )/ O/ (/ 2n/ -/ 1/ )/ O/ (/ logn/ -/ 1/ )/ 验证/ 者/ 的/ 存储/ 负荷/ O/ (/ 1/ )/ O/ (/ 1/ )/ O/ (/ 1/ )/ O/ (/ 1/ )/ O/ (/ 1/ )/ 验证/ 者/ 的/ 计算/ 负荷/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ 服务器/ 的/ 计算/ 复杂度/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ n/ )/ O/ (/ logn/ )/ 通信/ 代价/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ O/ (/ logn/ )/ 6/ 结束语/ 本文/ 构建/ 了/ 一种/ 新颖/ 的/ 具有/ 访问控制/ 的/ 外包/ 数据流/ 动态/ 可验证/ 方法/ ,/ 设计/ 了/ 离线/ 初始/ 构建/ 与/ 在线/ 实时/ 更新/ 相结合/ 的/ 动态/ 可验证/ 树/ ,/ 分别/ 利用/ Hash/ 函数/ 、/ 双陷门/ Hash/ 函数/ 和/ CP/ -/ ABE/ 算法/ 构建/ 可验证/ 树/ 的/ 静态/ 节点/ 、/ 动态/ 节点/ 与/ 根/ 节点/ ,/ 在/ 未/ 获得/ 叶子/ 节点/ 时/ 仍/ 能/ 构建/ 初始/ 可验证/ 树/ ,/ 通过/ 更新/ 碰撞/ 值/ 无需/ 重新/ 计算/ 全部/ 节点/ 信息/ 即可/ 完成/ 可验证/ 树/ 的/ 在线/ 实时/ 更新/ ,/ 在/ 数据/ 持续增长/ 的/ 同时/ 叶子/ 结点/ 动态/ 增加/ 、/ 验证/ 路径/ 动态/ 生成/ 、/ 验证/ 证据/ 实时/ 构建/ ,/ 实现/ 了/ 动态数据/ 边读/ 边/ 写边/ 验证/ ,/ 解决/ 了/ 云/ 平台/ 下外/ 包/ 数据流/ 高效/ 实时/ 验证/ 问题/ ./ 

