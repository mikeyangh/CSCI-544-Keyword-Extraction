Page1/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 无/ 证书/ 签密/ 方案/ 于/ 刚/ 韩文/ 报/ (/ 解放军信息工程大学/ 信息/ 工程学院/ 郑州/ 450002/ )/ 摘要/ 首先/ ,/ 提出/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 签密/ 概念/ ./ 此/ 模型/ 中/ ,/ 原始/ 解签/ 密者/ 把/ 消息/ 分为/ 不同/ 的/ 主题/ ,/ 按照/ 主题/ 把/ 解密/ 权力/ 授予/ 不同/ 的/ 代理人/ ;/ 代理人/ 可以/ 代替/ 原始/ 解签/ 密者/ 解密/ 其/ 授权/ 主题/ 下/ 的/ 密文/ ./ 其次/ ,/ 给出/ 安全/ 模型/ 并/ 基于/ 无/ 证书/ 公钥/ 密码/ 体制/ 提出/ 一个/ 具体/ 方案/ ./ 最后/ ,/ 基于/ Weak/ -/ BDH/ 难题/ 证明/ 该/ 方案/ 的/ 安全性/ ./ 关键词/ 无/ 证书/ 公钥/ 密码/ 体制/ ;/ 签密/ ;/ 可证/ 安全/ ;/ 代/ 理解/ 签密/ 1/ 引言/ 2003/ 年/ ,/ Al/ -/ Riyami/ 和/ Paterson/ [/ 1/ ]/ 提出/ 无/ 证书/ 公钥/ 密码/ 系统/ (/ CL/ -/ PKC/ )/ ./ CL/ -/ PKC/ 是/ 传统/ 公钥/ 密码/ 系统/ 和/ 基于/ 身份/ 密码/ 系统/ 的/ 折中/ ./ 在/ CL/ -/ PKC/ 中/ ,/ 密钥/ 生成/ 中心/ (/ KGC/ )/ 根据/ 系统/ 主/ 密钥/ 和/ 用户/ 的/ 身份/ 生成/ 用户/ 部分/ 私钥/ ,/ 而/ 用户/ 选择/ 秘密/ 值/ ,/ 利用/ 秘密/ 值/ 与/ KGC/ 分发/ 的/ 部分/ 私钥/ 一起/ 生成/ 完全/ 私钥/ ,/ 完全/ 私钥/ 作为/ 用户/ 密钥/ 进行/ 签名/ 或者/ 解密/ ./ CL/ -/ PKC/ 既/ 避免/ 了/ 传统/ 公钥/ 密码/ 系统/ 中/ PKI/ 证书/ 管理负担/ (/ 包括/ 证书/ 的/ 颁发/ 、/ 传输/ 、/ 存储/ 、/ 验证/ 及/ 撤销/ 等/ )/ ,/ 又/ 解决/ 了/ 基于/ 身份/ 公钥/ 密码/ 系统/ 的/ 密钥/ 托管/ 问题/ —/ —/ —/ 私钥/ 生成/ 中心/ PKG/ 为/ 每/ 一个/ 用户/ 生成/ 私钥/ ,/ 恶意/ PKG/ 可以/ 伪造/ 任意/ 用户/ 的/ 私钥/ ./ 使/ 消息/ 既/ 保密/ 又/ 认证/ 地/ 传输/ 是/ 信息安全/ 研究/ 的/ 重要/ 目标/ 之一/ ./ 实现/ 这一/ 目标/ 的/ 传统/ 方法/ 是/ “/ 先/ 签名/ 后/ 加密/ ”/ ./ 具体做法/ 是/ 先/ 将/ 消息/ 签名/ ,/ 然后/ 将/ 消息/ 及/ 签名/ 一起/ 加密/ 生成/ 密文/ ,/ 其/ 代价/ 是/ 签名/ 代价/ 与/ 加密/ 代价/ 之/ 和/ ,/ 因此/ 效率/ 较/ 低/ ./ 为了/ 提高效率/ ,/ 1997/ 年/ ,/ Zheng/ [/ 2/ ]/ 提出/ 签密/ 的/ 概念/ ./ 签密/ 能够/ 在/ 同一个/ 逻辑/ 步骤/ 内/ 同时/ 完成/ 签名/ 和/ 加密/ 两项/ 功能/ ,/ 是/ 实现/ 既/ 保密/ 又/ 认证/ 消息/ 传输/ 的/ 理想/ 方法/ ./ 2008/ 年/ ,/ Barbosa/ 与/ Farshim/ [/ 3/ ]/ 首次/ 将/ 签密/ 思想/ 引入/ 到/ 无/ 证书/ 公钥/ 密码/ 体制/ ,/ 提出/ 基于/ 无/ 证书/ 公钥/ 密码/ 体制/ 的/ 签密/ 概念/ ,/ 并/ 给出/ 一个/ 有效/ 的/ 方案/ ./ 此后/ ,/ 许多/ 无/ 证书/ 签密/ 方案/ 被/ Page2/ 提出/ ,/ 例如/ 文献/ [/ 4/ -/ 6/ ]/ 等/ ./ 代理/ 密码/ 体制/ 的/ 概念/ 由/ Mambo/ 等/ 人/ [/ 7/ ]/ 在/ 1996/ 年/ 提出/ ,/ 主要/ 指/ 的/ 是/ 签名/ 权力/ 授权/ 与/ 代理/ ./ 随着/ 信息化/ 的/ 迅速/ 发展/ ,/ 代理/ 业务/ 需求/ 越来越/ 大/ ,/ 相应/ 的/ 许多/ 拓展/ 概念/ 及/ 方案/ 被/ 提出/ ,/ 如/ 门限/ 代理/ 签名/ [/ 8/ ]/ 、/ 代理/ 解密/ [/ 9/ ]/ 、/ 代理/ 签密/ [/ 10/ ]/ 、/ 多/ 代理/ 多/ 签密/ [/ 11/ ]/ 、/ 无/ 证书/ 多/ 代理/ 签密/ [/ 12/ ]/ 等/ ./ 本文/ 从解/ 签密/ 角度/ 出发/ ,/ 基于/ 无/ 证书/ 公钥/ 密码/ 体制/ 提出/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 签密/ 概念/ ./ 不妨/ 考虑/ 以下/ 场景/ :/ 假设/ Bob/ 是/ 一个/ 业务/ 繁忙/ 的/ 公司/ 经理/ ,/ 他/ 需要/ 经常/ 出差/ ./ 而/ 每天/ 他/ 又/ 需要/ 处理/ 一大堆/ 经过/ 签密/ 的/ 密文/ 文件/ ./ 为了/ 把/ 他/ 自己/ 从/ 繁忙/ 的/ 工作/ 中/ 解放出来/ 也/ 为了/ 避免/ 因其/ 不/ 在/ 公司/ 而/ 导致/ 重要/ 业务/ 流失/ ,/ 他/ 把/ 消息/ 分成/ 几类/ ,/ 像/ E/ -/ mail/ 的/ 主题/ 一样/ 为/ 每/ 一类/ 消息/ 命名/ 一个/ 主题/ ./ 然后/ ,/ 他/ 就/ 可以/ 安排/ 不同/ 的/ 助理/ 代替/ 自己/ 处理/ 不同/ 主题/ 下/ 的/ 业务/ ./ 正是/ 基于/ 此类/ 需求/ ,/ 本文/ 提出/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 无/ 证书/ 签密/ ,/ 原始/ 解签/ 密者/ 把/ 消息/ 划分/ 为/ 不同/ 主题/ ,/ 并/ 把/ 解/ 签密/ 的/ 权力/ 按照/ 主题/ 分别/ 授权/ 给/ 不同/ 代/ 理解/ 签密者/ ./ 代/ 理解/ 签密者/ 能/ 解密/ 其/ 授权/ 主题/ 下/ 的/ 签密/ 密文/ ./ 此外/ ,/ 基于/ 公告牌/ 提出/ 一个/ 拓展/ 方案/ ,/ 实现/ 了/ 原始/ 解签/ 密者/ 通过/ 公告牌/ 随时/ 终止/ 某/ 主题/ 下/ 代/ 理解/ 签密者/ 解/ 签密/ 授权/ 的/ 功能/ ./ 2/ 基础知识/ 2.1/ 双线性/ 对设/ G1/ 为/ 大/ 素数/ q/ 阶/ 的/ 加法/ 循环群/ ;/ G2/ 为/ q/ 阶/ 的/ 乘法/ 循环群/ ,/ 双线性/ 对/ 是/ 满足/ 以下/ 性质/ 的/ 映射/ e/ ^/ :/ G1/ ×/ G1/ →/ G2/ :/ (/ 1/ )/ 双线性/ 性/ ./ 对于/ 任意/ 的/ P/ ,/ Q/ ∈/ G1/ 和/ 所有/ 的/ a/ ,/ b/ ∈/ Z/ / 以/ 在/ 多项式/ 时间/ 内/ 有效/ 计算出来/ ./ Diffie/ -/ Hellman/ 问题/ (/ Weak/ -/ BDH/ 问题/ )/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ 存在/ P/ ,/ Q/ ∈/ G1/ ,/ 使得/ e/ ^/ (/ P/ ,/ Q/ )/ ≠/ 1/ ./ (/ 3/ )/ 可计算性/ ./ 对/ 所有/ 的/ P/ ,/ Q/ ∈/ G1/ ,/ e/ ^/ (/ P/ ,/ Q/ )/ 可/ 本文/ 方案/ 的/ 安全性/ 基于/ CDH/ 问题/ 及弱/ 双线性/ 定义/ 1/ ./ CDH/ 问题/ ./ 设/ P/ 是/ G1/ 的/ 生成元/ ,/ 群/ G1/ 中/ 的/ CDH/ 问题/ 是/ :/ 给定/ (/ P/ ,/ aP/ ,/ bP/ )/ ,/ 其中/ a/ ,/ b/ ∈/ q/ ,/ 求解/ abP/ ./ Z/ / 定义/ 2/ ./ Weak/ -/ BDH/ 问题/ ./ 设/ (/ G1/ ,/ G2/ ,/ q/ ,/ e/ ^/ )/ 是/ 双线性/ 对系统/ ,/ P/ 是/ G1/ 的/ 生成元/ ,/ Weak/ -/ BDH/ 问题/ 是/ :/ 给定/ (/ P/ ,/ aP/ ,/ bP/ ,/ cP/ ,/ cw1/ ,/ …/ ,/ cwl/ )/ ,/ 其中/ a/ ,/ b/ ,/ c/ ,/ l/ ∈/ q/ ,/ wi/ ∈/ G1/ ,/ 求解/ e/ ^/ (/ P/ ,/ P/ )/ abc/ ./ Z/ / 2.2/ 具有/ 代/ 理解/ 签密/ 功能/ 无/ 证书/ 签密/ 的/ 形式化/ 定义/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 无/ 证书/ 签密/ ,/ 记为/ PUCLSC/ ,/ 由/ 以下/ 7/ 个/ 算法/ 组成/ :/ (/ 1/ )/ 系统/ 初始化/ (/ Setup/ )/ ./ 给定/ 安全/ 参数/ 1k/ ,/ 该/ 算法/ 生成/ 系统/ 的/ 公开/ 参数/ Params/ 和/ 主/ 密钥/ s/ ./ 记为/ (/ Params/ ,/ s/ )/ ←/ Setup/ (/ 1k/ )/ ./ (/ 2/ )/ 部分/ 私钥/ 生成/ (/ PartialSecretKeyGener/ -/ ate/ )/ ./ 给定/ 身份/ IDU/ ,/ KGC/ 为/ 用户/ 生成/ 部分/ 私钥/ PSKU/ ./ 记为/ PSKU/ ←/ PSKG/ (/ IDU/ ,/ s/ ,/ Params/ )/ ./ (/ 3/ )/ 公钥/ 生成/ (/ PublicKeyGenerate/ )/ ./ 用户/ IDU/ 选取/ 秘密/ 值/ xU/ ,/ 结合/ Params/ 以及/ 身份/ 生成/ 对应/ 公钥/ PU/ ./ 记为/ PU/ ←/ PKG/ (/ IDU/ ,/ xU/ ,/ Params/ )/ ./ (/ 4/ )/ 完全/ 私钥/ 生成/ (/ FullSecretKeyGenerate/ )/ ./ IDU/ 利用/ 秘密/ 值/ xU/ 及/ 部分/ 私钥/ PSKU/ 生成/ 完全/ 私钥/ FSKU/ ./ 记为/ FSKU/ ←/ FSKG/ (/ IDU/ ,/ xU/ ,/ PSKU/ ,/ Params/ )/ ./ (/ 5/ )/ 代理/ 私钥/ 生成/ (/ ProxySecretKeyGenerate/ )/ ./ 原始/ 解签/ 密者/ ,/ Alice/ ,/ 要/ 把/ 解/ 签密/ 权力/ 分别/ 授权/ 给/ l/ 个代/ 理解/ 签密者/ P1/ ,/ …/ ,/ Pl/ ,/ 首先/ 他/ 把/ 消息/ 分成/ l/ 类/ ,/ 并/ 为/ 每/ 一类/ 定义/ 主题/ subi/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ ./ 然后/ ,/ Alice/ 利用/ 完全/ 私钥/ FSKA/ 为/ 主题/ subi/ 生成/ 代理/ 私钥/ Ssubi/ ,/ 并/ 把/ 代理/ 私钥/ Ssubi/ 秘密/ 发送给/ 代理/ 者/ Pi/ ./ 记为/ Ssubi/ ←/ PRSKG/ (/ subi/ ,/ FSKA/ ,/ Params/ )/ ./ (/ 6/ )/ 签密/ (/ Signcrypt/ )/ ./ 发送/ 消息/ m/ ∈/ subi/ 给/ 原始/ 解签/ 密者/ IDA/ ,/ 发送者/ IDB/ 利用/ IDA/ 的/ 公钥/ PA/ 及/ 自己/ 的/ 完全/ 私钥/ FSKB/ 生成/ 密文/ δ/ ./ 记为/ δ/ ←/ SC/ (/ IDB/ ,/ FSKB/ ,/ IDA/ ,/ PA/ ,/ subi/ ,/ m/ )/ ./ (/ 7/ )/ 解/ 签密/ (/ Unsigncrypt/ )/ ./ 收到/ 密文/ δ/ ,/ 原始/ 解签/ 密者/ Alice/ 以及/ 该/ 主题/ 的/ 代/ 理解/ 签密者/ 分别/ 利用/ 完全/ 私钥/ FSKA/ 或/ 代理/ 私钥/ Ssubi/ 恢复/ 消息/ m/ ∈/ subi/ ,/ 或/ 输出/ “/ ⊥/ ”/ 表示/ 解/ 签密/ 失败/ ./ 记为/ m/ ←/ USC/ (/ IDB/ ,/ PB/ ,/ IDA/ ,/ FSKA/ (/ Ssubi/ )/ ,/ subi/ ,/ δ/ )/ ./ 2.3/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 无/ 证书/ 签密/ 的/ 安全/ 模型/ 我们/ 的/ 安全/ 模型/ 基于/ Barbosa/ 和/ Farshim/ [/ 3/ ]/ 提出/ 的/ 无/ 证书/ 签密/ 的/ 安全/ 模型/ ./ 对于/ 无/ 证书/ 公钥/ 密码/ 体制/ ,/ 存在/ 两种/ 类型/ 攻击/ ,/ I/ 型/ 攻击/ 和/ II/ 型/ 攻击/ ,/ 对应/ 着/ 两种/ 敌手/ ,/ AI/ 和/ AII/ ./ AI/ 代表/ 着/ 第三方/ 攻击/ ,/ AI/ 不能/ 得到/ KGC/ 的/ 主/ 密钥/ 但是/ 可以/ 随意/ 替换/ 用户/ 的/ 公钥/ ;/ AII/ 代表/ 着/ 恶意/ 的/ KGC/ 攻击/ ,/ AII/ 知道/ 主/ 密钥/ 但是/ 不/ 允许/ 替换/ 任何/ 公钥/ ./ 定义/ 3/ ./ 机密性/ ./ PUCLSC/ 称作/ 是/ 适应性/ 选择/ 密文/ 攻击/ 安全/ (/ IND/ -/ PUCLSC/ -/ CCA2/ )/ ,/ 如果/ 不/ 存在/ 任何/ 多项式/ 有界/ 的/ 攻击者/ (/ 包括/ AI/ 和/ AII/ )/ 以/ 不可/ Page3/ 其中/ ,/ m/ β/ i0/ 和/ m/ β/ i1/ (/ 1/ / i/ / k/ )/ 是/ 相同/ 长度/ 的/ 消息/ ;/ ID/ / S/ 和/ ID/ / R/ 是/ 不同/ 身份/ ;/ 当/ x/ =/ I/ 时/ ,/ aux/ 为空/ ,/ 当/ x/ =/ II/ 时/ ,/ aux/ =/ s/ ./ 在/ 上述/ 游戏/ 的/ 阶段/ 1/ 和/ 阶段/ 2/ 中/ ,/ 敌手/ 可以/ 向/ 挑战者/ C/ 进行/ 以下/ 询问/ :/ (/ 1/ )/ 部分/ 私钥/ 询问/ ./ 敌手/ 询问/ 用户/ IDU/ 的/ 部分/ 私钥/ PSKU/ ,/ C/ 返回/ 对应/ 的/ 部分/ 私钥/ PSKU/ ./ (/ 2/ )/ 公钥/ 询问/ ./ 敌手/ 询问/ 用户/ IDU/ 的/ 公钥/ ,/ C/ 返回/ 对应/ 的/ 公钥/ PU/ ./ (/ 3/ )/ 完全/ 私钥/ 询问/ ./ 敌手/ 询问/ 用户/ IDU/ 的/ 完全/ 私钥/ FSKU/ ,/ 如果/ IDU/ 的/ 公钥/ 没有/ 被/ 敌手/ 替换/ ,/ C/ 返回/ 对应/ 的/ 完全/ 私钥/ FSKU/ ./ (/ 4/ )/ 公钥/ 替换/ ./ 敌手/ 可以/ 向/ 挑战者/ 要求/ 把/ 用户/ 忽略/ 的/ 概率/ 赢得/ 下面/ 的/ 游戏/ :/ IND/ -/ PUCLSC/ -/ CCA2/ -/ x/ ./ (/ s/ ,/ Params/ )/ ←/ Setup/ (/ 1k/ )/ (/ ID/ / S/ ,/ ID/ / R/ ,/ (/ m/ β/ 10/ ,/ m/ β/ 11/ )/ ,/ …/ ,/ (/ m/ β/ k0/ ,/ m/ β/ k1/ )/ )/ ←/ AO1Phase1/ (/ Params/ ,/ aux/ )/ ,/ 1/ / i/ / k/ / l/ ,/ m/ β/ i0/ ,/ m/ β/ i1/ ∈/ {/ subi/ }/ ,/ γ/ ←/ {/ 0/ ,/ 1/ }/ ,/ δ/ / i/ ←/ SC/ (/ ID/ / S/ ,/ FSK/ / S/ ,/ ID/ / R/ ,/ P/ / R/ ,/ subi/ ,/ m/ β/ i/ γ/ )/ ,/ γ/ ←/ AO2Phase2/ (/ δ/ / 1/ ,/ …/ ,/ δ/ / k/ )/ ,/ Adv/ (/ AIND/ -/ PUCLSC/ -/ CCA2/ -/ x/ )/ =/ |/ 2P/ [/ γ/ =/ γ/ ]/ -/ 1/ |/ ,/ IDU/ 的/ 公钥/ PU/ 替换/ 为/ PU/ ./ (/ 5/ )/ 代理/ 私钥/ 询问/ ./ 敌手/ 可以/ 询问/ 主题/ subi/ 下/ 的/ 代理/ 私钥/ ,/ C/ 返回/ 对应/ 的/ 代理/ 私钥/ Ssubi/ ./ 这里/ 敌手/ 至多/ 询问/ l/ -/ 1/ 个/ 代理/ 私钥/ ./ (/ 6/ )/ 签密/ 询问/ ./ 敌手/ 给定/ 发送者/ 身份/ IDS/ 、/ 接收者/ 身份/ IDR/ 、/ 公钥/ PR/ 和/ 消息/ m/ ∈/ subi/ ,/ C/ 返回/ 密文/ δ/ ./ (/ 7/ )/ 解/ 签密/ 询问/ ./ 敌手/ 给定/ 密文/ δ/ 、/ 发送者/ 身份/ IDS/ 、/ 公钥/ PS/ 、/ 接收者/ 身份/ IDR/ 、/ C/ 返回/ 消息/ m/ 或者/ ⊥/ ./ 此外/ ,/ 在/ 上述/ 游戏/ 中/ ,/ AI/ 需要/ 遵守/ 以下/ 限制/ :/ (/ 1/ )/ AI/ 不能/ 询问/ ID/ / R/ 的/ 完全/ 私钥/ 以及/ 挑战/ 主题/ subi/ / 对应/ 的/ 代理/ 私钥/ Ssubi/ / ./ 私钥/ ./ (/ 2/ )/ 敌手/ AI/ 不能/ 询问/ 公钥/ 被/ 替换/ 用户/ 的/ 完全/ (/ 3/ )/ 敌手/ AI/ 不能/ 同时/ 在/ 挑战/ 阶段/ 结束/ 前/ 替换/ ID/ / R/ 的/ 公钥/ 和/ 在/ 某/ 一/ 阶段/ 询问/ ID/ / R/ 的/ 部分/ 私钥/ ./ (/ 4/ )/ 敌手/ 不能/ 对/ 挑战/ 密文/ δ/ / 1/ ,/ …/ ,/ δ/ / k/ 执行/ 解/ 签密/ AII/ 需要/ 遵守/ 以下/ 限制/ :/ 询问/ 除非/ 发送者/ 或者/ 接收者/ 的/ 公钥/ 被/ 替换/ ./ (/ 1/ )/ 敌手/ AII/ 不能/ 替换/ 任何/ 公钥/ ./ (/ 2/ )/ 敌手/ AII/ 不能/ 询问/ ID/ / R/ 的/ 完全/ 私钥/ 以及/ 挑战/ 主题/ subi/ / 对应/ 的/ 代理/ 私钥/ Ssubi/ / ./ (/ 3/ )/ 敌手/ AII/ 不能/ 对/ 挑战/ 密文/ δ/ / 1/ ,/ …/ ,/ δ/ / k/ 进行/ 解/ 签密/ 询问/ ./ 定义/ 4/ ./ 不可/ 伪造/ 性/ ./ PUCLSC/ 称作/ 是/ 适应性/ 选择/ 消息/ 攻击/ 下/ 存在/ 性/ 不可/ 伪造/ (/ EUF/ -/ PU/ -/ CLSC/ -/ ACMA/ )/ 的/ ,/ 如果/ 不/ 存在/ 任何/ 多项式/ 有界/ 的/ 攻击者/ 以/ 不可/ 忽略/ 的/ 概率/ 赢得/ 如下/ 定义/ 的/ 游戏/ :/ EUF/ -/ PUCLSC/ -/ ACMA/ -/ x/ (/ s/ ,/ Params/ )/ ←/ Setup/ (/ 1k/ )/ ,/ (/ ID/ / S/ ,/ ID/ / R/ ,/ δ/ / ,/ subi/ / )/ ←/ AO/ (/ Params/ ,/ aux/ )/ ,/ Adv/ (/ AEUF/ -/ PUCLSC/ -/ ACMA/ -/ x/ )/ =/ Pr/ {/ AEUF/ -/ PUCLSC/ -/ ACMA/ -/ x/ 成功/ }/ ,/ 其中/ ,/ 当/ x/ =/ I/ 时/ ,/ aux/ 为空/ ,/ 当/ x/ =/ II/ 时/ ,/ aux/ =/ s/ ./ 如果/ 密文/ ID/ / S/ 、/ ID/ / R/ 、/ δ/ / 、/ subi/ / 不是/ 签密/ 询问/ 产生/ 的/ ,/ 也/ 没/ 询问/ ID/ / S/ 的/ 完全/ 私钥/ ,/ 那么/ 敌手/ 成功/ 当且/ 仅/ 当/ 对/ 密文/ 解/ 签密/ 的/ 结果/ 不是/ ⊥/ ./ 同/ 游戏/ IND/ -/ PUCLSC/ -/ CCA2/ -/ x/ ,/ 敌手/ 可以/ 获得/ C/ 的/ 预言/ 服务/ ./ 此外/ ,/ 在/ 上述/ 游戏/ 中/ ,/ AI/ 需要/ 遵守/ 以下/ 限制/ :/ (/ 1/ )/ 敌手/ AI/ 不能/ 询问/ ID/ / S/ 的/ 完全/ 私钥/ ;/ 敌手/ AI/ 不能/ 询问/ 公钥/ 被/ 替换/ 的/ 用户/ 的/ 完全/ 私钥/ ./ (/ 2/ )/ 敌手/ AI/ 不能/ 同时/ 在/ 挑战/ 阶段/ 结束/ 前/ 替换/ ID/ / S/ 的/ 公钥/ 和/ 在/ 某/ 一/ 阶段/ 询问/ ID/ / S/ 的/ 部分/ 私钥/ ./ AII/ 需要/ 遵守/ 以下/ 限制/ :/ (/ 1/ )/ 敌手/ AII/ 不能/ 替换/ 任何/ 公钥/ ./ (/ 2/ )/ 敌手/ AII/ 不能/ 询问/ ID/ / S/ 的/ 完全/ 私钥/ ./ 3PUCLSC/ 方案/ 本/ 节/ ,/ 首先/ 基于/ 无/ 证书/ 公钥/ 密码/ 体制/ 给出/ 一个/ 基础/ 方案/ :/ B/ -/ PUCLSC/ ;/ 然后/ ,/ 基于/ 公告牌/ 提出/ 一个/ 拓展/ 方案/ :/ F/ -/ PUCLSC/ ./ F/ -/ PUCLSC/ 中/ 原始/ 解签/ 密者/ 可以/ 通过/ 公告牌/ 随时/ 终止/ 代/ 理解/ 签密者/ 的/ 解/ 签密/ 授权/ ,/ 即使/ 代/ 理解/ 签密者/ 仍/ 处在/ 合法/ 授权/ 期内/ ./ 3.1/ 基础/ 方案/ B/ -/ PUCLSC/ 系统/ 初始化/ ./ 设/ G1/ 为/ 大/ 素数/ q/ 阶/ 的/ 加法/ 循环群/ ,/ 生成元/ 为/ P/ ;/ G2/ 为/ q/ 阶/ 的/ 乘法/ 循环群/ ;/ e/ ^/ :/ G1/ ×/ G1/ →/ G2/ 为/ 双线性/ 对/ ;/ 定义/ 4/ 个/ 安全/ 的/ Hash/ 函数/ :/ H0/ :/ {/ 0/ ,/ 1/ }/ n1/ →/ G/ / 1/ ,/ H1/ :/ {/ 0/ ,/ 1/ }/ n2/ →/ G/ / 1/ ,/ H2/ :/ G1/ ×/ G1/ ×/ {/ 0/ ,/ 1/ }/ n3/ ×/ {/ 0/ ,/ 1/ }/ n1/ ×/ G1/ ×/ {/ 0/ ,/ 1/ }/ n1/ ×/ G1/ →/ Z/ / G2/ →/ G/ / 1/ ×/ {/ 0/ ,/ 1/ }/ n3/ ×/ {/ 0/ ,/ 1/ }/ n1/ ,/ n1/ ,/ n2/ ,/ n3/ 分别/ 表示/ 身份/ 、/ 主题/ 和/ 消息/ 的/ 比特/ 长度/ ;/ KGC/ 随机/ 选择/ 主/ 密钥/ q/ ,/ 计算/ 系统/ 公钥/ PPub/ =/ sP/ ./ 最后/ ,/ KGC/ 秘密/ 保/ s/ ∈/ Z/ / Page4/ 存/ s/ ,/ 公开/ 系统/ 参数/ Params/ =/ {/ G1/ ,/ G2/ ,/ q/ ,/ e/ ^/ ,/ P/ ,/ PPub/ ,/ H0/ ,/ H1/ ,/ H2/ ,/ H3/ }/ ./ 部分/ 私钥/ 生成/ ./ 用户/ 将/ 身份/ IDU/ 提交/ 给/ KGC/ ,/ KGC/ 计算/ 对应/ 的/ 部分/ 私钥/ PSKU/ =/ sQU/ ,/ 其中/ QU/ =/ H0/ (/ IDU/ )/ ,/ 并/ 将/ PSKU/ 秘密/ 发送给/ IDU/ ./ 公钥/ 生成/ ./ 用户/ IDU/ ,/ 生成/ 其公钥/ PU/ =/ (/ XU/ ,/ YU/ )/ 如下/ :/ ①/ 随机/ 选择/ xU/ ∈/ Z/ / ②/ 计算/ XU/ =/ xUP/ ,/ YU/ =/ xUPPub/ ,/ 并/ 公开/ PU/ =/ (/ XU/ ,/ YU/ )/ ./ 任何人/ 可以/ 通过/ 等式/ :/ e/ ^/ (/ XU/ ,/ PPub/ )/ =/ e/ ^/ (/ YU/ ,/ P/ )/ 验证/ 其/ 形式/ 上/ 的/ 正确性/ ./ 完全/ 私钥/ 生成/ ./ 用户/ IDU/ 的/ 完全/ 私钥/ 为/ FSKU/ =/ xUPSKU/ =/ xU/ ·/ s/ ·/ QU/ ./ 代理/ 私钥/ 生成/ ./ 假设/ 用户/ ,/ Alice/ (/ 原始/ 解签/ 密者/ )/ ,/ 其/ 身份/ IDA/ 、/ 公钥/ PA/ 、/ 完全/ 私钥/ FSKA/ ,/ 要/ 把/ 解/ 签密/ 权力/ 分别/ 授权/ 给/ l/ ∈/ Zq/ 个代/ 理解/ 签密者/ P1/ ,/ …/ ,/ Pl/ ,/ 执行/ 以下/ 步骤/ :/ 主题/ subi/ ∈/ {/ 0/ ,/ 1/ }/ n2/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ ,/ 公布/ subi/ ./ 1/ ./ 将/ 所有/ 消息/ m/ ∈/ {/ 0/ ,/ 1/ }/ n3/ 划分/ 为/ l/ 类/ ,/ 对/ 每/ 一类/ 定义/ 2/ ./ 对于/ 主题/ subi/ ∈/ {/ sub1/ ,/ …/ ,/ subl/ }/ ,/ Alice/ 生成/ 该/ 主题/ 下/ 的/ 代/ 理解/ 签密/ 密钥/ :/ 2.1/ ./ 随机/ 选择/ di/ ∈/ Z/ / q/ ./ 2.2/ ./ 计算/ Ssubi/ =/ (/ Ssubi1/ ,/ Ssubi2/ )/ =/ (/ diwi/ +/ FSKA/ ,/ diP/ )/ ,/ 其中/ wi/ =/ H1/ (/ subi/ )/ ./ 解签/ 密者/ Pi/ ./ 3/ ./ Alice/ 将/ Ssubi/ 通过/ 安全/ 方式/ 秘密/ 分/ 发给/ 相应/ 的/ 代理/ 签密/ ./ 发送者/ Bob/ (/ 身份/ ID/ _/ B/ 、/ 完全/ 私钥/ FSK/ _/ B/ )/ ,/ 执行/ 以下/ 步骤/ :/ H1/ (/ subi/ )/ ./ 1/ ./ 随机/ 选择/ r/ ∈/ Z/ / q/ ,/ 计算/ U/ =/ rP/ 和/ W/ =/ rwi/ ,/ 其中/ wi/ =/ 2/ ./ 计算/ h/ =/ H2/ (/ U/ ,/ W/ ,/ m/ ,/ IDA/ ,/ XA/ ,/ IDB/ ,/ XB/ )/ ./ 3/ ./ 计算/ V/ =/ rQB/ +/ h/ ·/ FSKB/ ./ 4/ ./ 计算/ kt/ =/ H3/ (/ e/ ^/ (/ YA/ ,/ QA/ )/ r/ )/ 和/ z/ =/ V/ ‖/ m/ ‖/ IDB/ / kt/ ./ 5/ ./ 密文/ 为/ 〈/ subi/ ,/ U/ ,/ W/ ,/ z/ 〉/ ./ 解/ 签密/ ./ Alice/ 收到/ 密文/ 〈/ subi/ ,/ U/ ,/ W/ ,/ z/ 〉/ 后/ ,/ 1/ ./ 计算/ 会话/ 密钥/ kt/ :/ 1.1/ ./ 原始/ 解签/ 密者/ ,/ Alice/ ,/ 计算/ :/ kt/ =/ H3/ (/ e/ ^/ (/ U/ ,/ FSKA/ )/ )/ ./ H3e/ ^/ (/ Ssubi2/ ,/ W/ (/ )/ )/ ./ 1.2/ ./ 代/ 理解/ 签密者/ ,/ Pi/ ,/ 计算/ :/ wi/ =/ H1/ (/ subi/ )/ ,/ kt/ =/ e/ ^/ (/ Ssubi1/ ,/ U/ )/ 2/ ./ 恢复/ 明文/ 消息/ V/ ‖/ m/ ‖/ IDB/ =/ z/ / kt/ ./ 3/ ./ 验证/ Bob/ 对/ 消息/ 的/ 签名/ ./ e/ ^/ (/ V/ ,/ P/ )/ =/ e/ ^/ (/ U/ +/ hYB/ ,/ QB/ )/ ,/ 其中/ h/ =/ H2/ (/ U/ ,/ W/ ,/ m/ ,/ IDA/ ,/ XA/ ,/ IDB/ ,/ XB/ )/ ./ 注/ ./ 如果/ Bob/ 希望/ 该/ 消息/ 由/ Alice/ 本人/ 恢复/ 消息/ ,/ 可以/ 设置/ W/ =/ 0/ ./ 基础/ 方案/ 中/ ,/ 如果/ 发送者/ 正常/ 签密/ ,/ 原始/ 解签/ 密者/ 不能/ 终止/ 代/ 理解/ 签密者/ 在/ 合法/ 授权/ 下/ 恢复/ 消息/ ./ 3.2/ 拓展/ 方案/ F/ -/ PUCLSC/ 系统/ 初始化/ ./ 除/ Hash/ 函数/ H2/ 略微/ 改变/ ,/ 变为/ H2/ :/ G31/ ×/ {/ 0/ ,/ 1/ }/ n3/ ×/ {/ 0/ ,/ 1/ }/ n1/ ×/ G1/ ×/ {/ 0/ ,/ 1/ }/ n1/ ×/ G1/ →/ q/ 外/ ,/ 其它/ 参数/ 同/ 基础/ 方案/ 一样/ ./ Z/ / 部分/ 私钥/ 生成/ 、/ 公钥/ 生成/ 、/ 完全/ 私钥/ 生成/ ,/ 同/ 基础/ 方案/ ./ 代理/ 私钥/ 生成/ ./ 1/ ./ 代理/ 私钥/ 生成/ :/ 1.1/ ./ 将/ 消息/ m/ ∈/ {/ 0/ ,/ 1/ }/ n3/ 划分/ 为/ l/ 类/ ,/ 对/ 每/ 一类/ 定义/ 主题/ subi/ ∈/ {/ 0/ ,/ 1/ }/ n2/ ,/ i/ =/ 1/ ,/ 2/ ,/ …/ ,/ l/ ,/ 公布/ subi/ ./ 1.2/ ./ 对于/ 主题/ subi/ ∈/ {/ sub1/ ,/ …/ ,/ subl/ }/ ,/ Alice/ 如下/ 生成/ 代/ 理解/ 签密/ 密钥/ Ssubi/ :/ 1.2/ ./ 1/ ./ 随机/ 选择/ b0/ ,/ b1/ ,/ di/ ∈/ Z/ / q/ ,/ 其中/ b0/ +/ b1/ =/ 1modq/ ./ 1.2/ ./ 2/ ./ 计算/ Ssubi/ =/ (/ Ssubi1/ ,/ Ssubi2/ )/ =/ (/ diwi/ +/ b0/ -/ FSKA/ ,/ diP/ )/ ,/ 其中/ wi/ =/ H1/ (/ subi/ )/ ∈/ G1/ ./ 1.3/ ./ Alice/ 将/ Ssubi/ 通过/ 安全/ 方式/ 秘密/ 分/ 发给/ 代/ 理解/ 签/ 2/ ./ 公告牌/ 参数/ 更新/ :/ 2.1/ ./ 对/ 某/ 一时/ 段/ τ/ j/ ∈/ {/ τ/ 1/ ,/ τ/ 2/ ,/ …/ }/ ,/ τ/ j/ ∈/ {/ 0/ ,/ 1/ }/ n1/ ,/ 选择/ 密者/ Pi/ ./ d/ τ/ ji/ ∈/ Z/ / q/ ./ i/ Γ/ j/ ,/ d/ τ/ jd/ τ/ j2/ ./ 2/ ./ 计算/ P/ (/ τ/ ji/ )/ =/ (/ x/ (/ τ/ ji/ )/ ,/ y/ (/ τ/ ji/ )/ )/ =/ (/ b1/ ·/ FSKA/ +/ iP/ )/ ,/ 其中/ Γ/ j/ =/ H0/ (/ τ/ j/ )/ ./ 2.3/ ./ Bob/ 在/ 公告牌/ 上为/ 其代/ 理解/ 签密者/ 更新/ P/ (/ τ/ ji/ )/ ./ 签密/ ./ 发送者/ Bob/ (/ 身份/ ID/ _/ B/ 、/ 完全/ 私钥/ FSK/ _/ B/ )/ ,/ 执行/ 以下/ 步骤/ :/ 中/ wi/ =/ H1/ (/ subi/ )/ 、/ Γ/ j/ =/ H0/ (/ τ/ j/ )/ ./ 1/ ./ 随机/ 选择/ r/ ∈/ Z/ / q/ ,/ 计算/ U/ =/ rP/ 、/ W/ =/ rwi/ 和/ T/ =/ r/ Γ/ j/ ,/ 其/ 2/ ./ 计算/ h/ =/ H2/ (/ U/ ,/ W/ ,/ T/ ,/ m/ ,/ IDA/ ,/ XA/ ,/ IDB/ ,/ XB/ )/ ./ 3/ ./ 计算/ V/ =/ rQB/ +/ h/ ·/ FSKB/ ./ 4/ ./ 计算/ kt/ =/ H3/ (/ e/ ^/ (/ YA/ ,/ QA/ )/ r/ )/ 和/ z/ =/ V/ ‖/ m/ ‖/ IDB/ / kt/ ./ 5/ ./ 密文/ 为/ 〈/ subi/ ,/ U/ ,/ W/ ,/ T/ ,/ z/ 〉/ ./ 解/ 签密/ ./ Alice/ 收到/ 密文/ 〈/ subi/ ,/ U/ ,/ W/ ,/ T/ ,/ z/ 〉/ 后/ ,/ 1/ ./ 计算/ 会话/ 密钥/ kt/ :/ 1.1/ ./ 原始/ 解签/ 密者/ Alice/ 计算/ kt/ =/ H3/ (/ e/ ^/ (/ U/ ,/ FSKA/ )/ )/ ./ 1.2/ ./ 代/ 理解/ 签密者/ ,/ Pi/ ,/ 计算/ :/ wi/ =/ H1/ (/ subi/ )/ ,/ kt/ =/ e/ ^/ (/ Ssubi1/ +/ x/ (/ τ/ ji/ )/ ,/ U/ )/ e/ ^/ (/ Ssubi2/ ,/ W/ )/ e/ ^/ (/ y/ (/ τ/ ji/ )/ ,/ T2/ ./ 恢复/ 明文/ 消息/ V/ ‖/ m/ ‖/ IDB/ =/ z/ / kt/ ./ 3/ ./ 验证/ Bob/ 对/ 消息/ 的/ 签名/ :/ e/ ^/ (/ V/ ,/ P/ )/ =/ e/ ^/ (/ U/ +/ hYB/ ,/ QB/ )/ ,/ 注/ ./ 如果/ 发送者/ 希望/ 该/ 消息/ 由/ 原始/ 解签/ 密者/ 本人/ 恢复/ 消息/ ,/ 可以/ 设置/ W/ =/ 0/ 和/ T/ =/ 0/ ./ 拓展/ 方案/ 中/ ,/ 其中/ h/ =/ H2/ (/ U/ ,/ W/ ,/ T/ ,/ m/ ,/ IDA/ ,/ XA/ ,/ IDB/ ,/ XB/ )/ ./ (/ H3Page5/ 如果/ 主题/ subi/ 下/ 的/ 代/ 理解/ 签密者/ 被/ 腐化/ ,/ 原始/ 解签/ 密者/ 把/ 原来/ 的/ b0/ ,/ b1/ ,/ di/ ,/ d/ τ/ ji/ ∈/ Z/ / q/ ,/ 其中/ bi/ ≠/ bi/ ,/ i/ =/ 0/ ,/ 1/ ,/ di/ ≠/ di/ ,/ d/ τ/ ji/ ≠/ d/ τ/ ji/ ,/ b0/ +/ b1/ =/ Z/ / 1modq/ ./ 然后/ 在/ 公告牌/ 上/ 更新/ P/ (/ τ/ ji/ )/ ,/ 并/ 把/ 新/ 的/ 代理/ 解密/ 私钥/ 秘密/ 发送给/ 新/ 的/ 代理/ 者/ ./ 4/ 安全/ 分析/ 本节/ 对/ 基础/ 方案/ ,/ B/ -/ PUCLSC/ 的/ 安全性/ 做/ 简单/ 分析/ ,/ 拓展/ 方案/ 安全/ 分析/ 类似/ ./ 假设/ 敌手/ 最/ 多/ 进行/ qi/ 次/ Hi/ 询问/ (/ i/ =/ 0/ ,/ 1/ ,/ 2/ ,/ 3/ )/ ,/ qs/ 次/ 签密/ 询问/ 、/ qu/ 次解/ 签密/ 询问/ ./ 机密性/ ./ 在/ Weak/ -/ BDH/ 难题/ 假设/ 下/ ,/ B/ -/ PU/ -/ CLSC/ 方案/ 是/ 适应性/ 选择/ 密文/ 攻击/ 安全/ 的/ ./ B/ -/ PUCLSC/ 的/ 机密性/ 可以/ 由/ 以下/ 两个/ 引理/ 得到/ ./ 引理/ 1/ ./ 假设/ 存在/ I/ 类/ 敌手/ AIND/ -/ PUCLSC/ -/ CCA2/ -/ I/ 能够/ 以/ 优势/ Adv/ (/ AIND/ -/ PUCLSC/ -/ CCA2/ -/ I/ )/ 赢得/ 游戏/ IND/ -/ PU/ -/ CLSC/ -/ CCA2/ -/ I/ ,/ 则/ 存在/ 挑战者/ C/ 以/ 优势/ ε/ 解决/ Weak/ -/ BDH/ 问题/ ,/ 其中/ :/ ε/ / 1/ -/ qsq3/ (/ )/ q/ ·/ 1/ -/ qs/ ·/ (/ q2/ +/ q3/ +/ 2qs/ )/ 证明/ 见/ 附录/ 1/ ./ 引理/ 2/ ./ 假设/ 存在/ II/ 类/ 敌手/ AIND/ -/ PUCLSC/ -/ CCA2/ -/ II/ 能够/ 以/ 优势/ Adv/ (/ AIND/ -/ PUCLSC/ -/ CCA2/ -/ II/ )/ 赢得/ 游戏/ IND/ -/ PUCLSC/ -/ CCA2/ -/ II/ ,/ 则/ 存在/ 挑战者/ C/ 以/ 优势/ ε/ 解决/ Weak/ -/ BDH/ 问题/ ,/ 其中/ :/ 证明/ 见/ 附录/ 2/ ./ 不可/ 伪造/ 性/ ./ 在/ CDH/ 难题/ 假设/ 下/ ,/ B/ -/ PUCLSC/ 方案/ 在/ 适应性/ 选择/ 消息/ 攻击/ 下抗/ 存在/ 性/ 伪造/ ./ B/ -/ PUCLSC/ 方案/ 中/ 的/ 签名/ 本质/ 上/ 是/ Hess/ 提出/ 的/ 基于/ 身份/ 签名/ [/ 13/ ]/ 在/ 无/ 证书/ 环境/ 下/ 的/ 变体/ ./ 具体/ 签名/ 及/ 验证/ 算法/ 如下/ :/ 个/ 安全/ 的/ Hash/ 函数/ ./ 首先/ H2/ :/ G1/ ×/ {/ 0/ ,/ 1/ }/ n3/ ×/ {/ 0/ ,/ 1/ }/ n1/ ×/ G1/ →/ Z/ / 签名/ ./ 签名者/ Bob/ ,/ 其/ 身份/ 为/ IDB/ ,/ 公钥/ 为/ PB/ =/ (/ XB/ ,/ YB/ )/ ,/ 完全/ 私钥/ 为/ FSKB/ =/ xB/ ·/ s/ ·/ QB/ ,/ 给定/ 消息/ m/ 后/ ,/ 执行/ 以下/ 步骤/ 生成/ 签名/ σ/ =/ (/ U/ ,/ V/ )/ :/ 随机/ 选择/ r/ ∈/ Z/ / V/ =/ rQB/ +/ h/ ·/ FSKB/ ,/ 消息/ m/ 的/ 签名/ 为/ σ/ =/ (/ U/ ,/ V/ )/ ./ 验证/ ./ 任何人/ 可以/ 计算/ h/ =/ H2/ (/ U/ ,/ m/ ,/ IDB/ ,/ 上述/ 签名/ 在/ 适应性/ 选择/ 消息/ 攻击/ 下抗/ 存在/ 性伪仅/ 当/ 等式/ 成立/ 时/ 签名/ σ/ =/ (/ U/ ,/ V/ )/ 有效/ ./ 造性/ ,/ 证明/ 见/ 附录/ 3/ ./ 考虑/ 到/ B/ -/ PUCLSC/ 方案/ 中/ 恶意/ 的/ 代/ 理解/ 签密者/ 也/ 存在/ 伪造/ 签名/ 的/ 可能/ ,/ 附录/ 3/ 证明/ 中/ 额外/ 地/ 考虑/ 了/ 敌手/ 对/ 代理/ 私钥/ 的/ 询问/ ,/ 模拟/ 了/ 恶意/ 的/ 代/ 理解/ 签密者/ 伪造/ 签名/ 的/ 攻击方式/ ,/ 从而/ B/ -/ PUCLSC/ 方案/ 抗/ 存在/ 性/ 伪造/ ./ 5/ 结论/ 本文/ 首先/ 提出/ 一个/ 新/ 的/ 密码/ 模型/ —/ —/ —/ 具有/ 代/ 理解/ 签密/ 功能/ 的/ 签密/ ,/ 并/ 给出/ 其/ 安全/ 模型/ ./ 然后/ 基于/ 无/ 证书/ 密码/ 体制/ 提出/ 一个/ 基础/ 方案/ ,/ 又/ 通过/ 公告牌/ 给出/ 一个/ 拓展/ 方案/ ,/ 实现/ 代理/ 授权/ 的/ 任意/ 终止/ ./ 最后/ ,/ 基于/ Weak/ -/ BDH/ 和/ CDH/ 难题/ 分析/ 了/ 方案/ 的/ 安全性/ ./ 

