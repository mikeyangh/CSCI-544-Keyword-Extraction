Page1/ 基于/ 强化/ 学习/ 的/ SBS/ 云/ 应用/ 自适应性/ 能/ 优化/ 方法/ 闫/ 永明/ 张斌/ 郭军/ 孟煜/ (/ 东北大学/ 计算机科学/ 与/ 工程学院/ 沈阳/ 110819/ )/ 摘要/ 自/ 适应/ 的/ 调整/ 云/ 应用/ 所/ 占用/ 的/ 资源/ 是/ 一种/ 有效/ 的/ 保障/ 云/ 应用/ 性能/ 的/ 方法/ ,/ 但/ 传统/ 的/ 决策/ 方法/ 面向/ 基于/ 服务/ 的/ 系统/ (/ Service/ -/ BasedSystem/ ,/ SBS/ )/ 时会/ 存在/ 一些/ 问题/ ,/ 例如/ 基于/ 应用/ 系统/ 性能/ 模型/ 的/ 决策/ 方法/ 不能/ 很/ 好/ 适应/ 云/ 环境/ 下/ SBS/ 的/ 动态变化/ ,/ 基于/ 智能/ 优化/ 算法/ 的/ 决策/ 方法/ 效率/ 较/ 低/ ./ 该文/ 提出/ 了/ 一种/ 基于/ 强化/ 学习/ 的/ SBS/ 云/ 应用/ 自适应性/ 能/ 优化/ 方法/ ./ 在/ 该/ 方法/ 中/ ,/ 该文/ 建立/ 了/ 自/ 适应/ 基本要素/ 之间/ 相互/ 关系/ 的/ 特征描述/ 框架/ ,/ 利用/ 高层次/ 的/ 系统/ 行为/ 指标/ (/ 如/ 响应/ 时间/ 、/ 用户/ 并发/ 量/ 、/ 资源量/ 等/ )/ 来/ 描述/ 系统/ 性能/ 的/ 优化/ 目标/ 等/ ./ 为了/ 应对/ 云/ 环境/ 以及/ SBS/ 的/ 动态变化/ ,/ 该文/ 的/ 方法/ 采用/ 了/ 无/ 模型/ (/ model/ -/ free/ )/ 的/ 在线/ 学习/ 算法/ ,/ 当/ 用户/ 并发/ 量/ 发生变化/ 导致系统/ 的/ 预期/ 行为/ 发生/ 偏差/ 时/ ,/ 该/ 方法/ 通过/ 不断/ 重复/ “/ 执行/ -/ 积累/ -/ 学习/ -/ 决策/ ”/ 的/ 过程/ ,/ 可以/ 不断/ 的/ 积累/ 经验/ 数据/ 并/ 优化/ 决策/ 结果/ ./ 为了/ 保证/ 自/ 适应/ 优化/ 的/ 高效性/ ,/ 该文/ 提出/ 了/ 一种/ 引导/ 算子/ ,/ 可以/ 有效/ 的/ 缩小/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ ,/ 提高/ 算法/ 的/ 学习/ 效率/ ./ 该文/ 实现/ 了/ 以/ 一个/ SBS/ 为例/ 的/ 原型/ 框架/ ,/ 使用/ 该/ 框架/ 的/ 实验/ 结果/ 证明/ 了/ 该文/ 提出/ 方法/ 的/ 有效性/ ./ 关键词/ 自/ 适应/ ;/ 强化/ 学习/ ;/ 资源/ 调整/ ;/ 云/ 应用/ ;/ 基于/ 服务/ 的/ 系统/ ;/ 云/ 计算/ 1/ 引言/ 当前/ 很多/ 云/ 计算/ 平台/ (/ AmazonEC2/ 、/ MicrosoftAzure/ 、/ Rackspace/ 、/ 阿里/ 云/ 等/ )/ 都/ 为/ 部署/ 在/ 上面/ 的/ 应用/ 系统/ 提供/ 了/ 通过/ 资源/ 调整/ 进行/ 云/ 应用/ 系统/ 性能/ 优化/ 的/ 能力/ ,/ 这种/ 能力/ 使得/ 云/ 应用/ 系统/ 可以/ 更加/ 有效/ 地/ 应对/ 云/ 环境/ 以及/ 用户/ 请求/ 的/ 实时/ 变化/ ,/ 为云/ 应用/ 系统/ 的/ 性能/ 保障/ 提供/ 了/ 更加/ 有效/ 的/ 支持/ [/ 1/ -/ 3/ ]/ ./ 基于/ 服务/ 的/ 系统/ (/ Service/ -/ BasedSystem/ ,/ SBS/ )/ 在/ 各种/ 应用领域/ (/ 如/ 科研/ 、/ 通信/ 、/ 金融/ )/ 发挥/ 着/ 越来越/ 重要/ 的/ 作用/ [/ 4/ ]/ ./ 同时/ ,/ 也/ 有/ 越来越/ 多/ 的/ 服务提供者/ 选择/ 将/ SBS/ 部署/ 在/ 云/ 环境/ 中/ (/ 通常/ 采用/ 将/ 具体/ 组件/ 服务/ 部署/ 到/ 多台/ 虚拟机/ (/ VirtualMachine/ ,/ VM/ )/ 上/ 的/ 方式/ [/ 5/ ]/ )/ ,/ 以/ 减少/ 硬件/ 的/ 运营/ 成本/ ./ 为了/ 保障/ 部署/ 在/ 云/ 环境/ 下/ 的/ SBS/ 的/ 服务质量/ ,/ 则/ 可以/ 通过/ 调整/ 组件/ 服务/ 所在/ 的/ 虚拟机/ 的/ 资源/ (/ CPU/ 、/ 内存/ 等/ )/ 来/ 改善/ 组件/ 服务/ 的/ 服务/ 能力/ ,/ 从而/ 实现/ 保障/ SBS/ 整体/ 性能/ 的/ 目的/ [/ 6/ -/ 7/ ]/ ./ 然而/ 对/ 组件/ 资源/ 进行/ 自/ 适应/ 调整/ 需要/ 确定/ 调整/ 动作/ (/ 如/ 组件/ 服务/ 需要/ 增加/ 内存/ 或/ 增加/ CPU/ 、/ 给/ 组件/ 服务/ 增加/ 300MB/ 或/ 500MB/ 内存/ )/ ./ 但云/ 环境/ 下/ 资源/ 的/ 使用/ 状态/ 是/ 动态变化/ 的/ ,/ 一个/ 虚拟机/ 能够/ 增加/ 多少/ 资源/ (/ 如/ CPU/ 、/ 内存/ 等/ )/ 是/ 受/ 其/ 所在/ 物理/ 机/ 的/ 资源/ 使用/ 情况/ 所/ 左右/ 的/ ,/ 如果/ 在/ 系统/ 运行/ 之前/ 预定/ 义自/ 适应/ 调整/ ,/ 很/ 有/ 可能/ 会/ 出现/ 自/ 适应/ 调整/ 无法/ 执行/ 、/ 不能/ 实现/ 预期/ 优化/ 目标/ 等/ 情况/ ./ 例如/ 预定/ 义/ 的/ 自/ 适应/ 调整/ 是/ 给/ 组件/ S1/ 增加/ 300MB/ 内存/ ,/ 若/ S1/ 所在/ 物理/ 机/ 的/ 剩余/ 内存不足/ 300MB/ 时/ ,/ 则/ 该/ 自/ 适应/ 调整/ 无法/ 执行/ ;/ 若/ S1/ 需要/ 增加/ 500MB/ 内存/ 才能/ 使/ 系统/ 的/ 响应/ 时间/ 满足/ 服务/ 等级/ 协议/ (/ ServiceLevelAgreement/ ,/ SLA/ )/ 的/ 要求/ ,/ 则/ 该/ 自/ 适应/ 调整/ 不能/ 实现/ 预期/ 的/ 优化/ 目标/ ./ 所以/ ,/ 为了/ 在/ 云/ 环境/ 下/ 对/ SBS/ 进行/ 更/ 有效/ 的/ 自适应性/ 能/ 优化/ ,/ 需要/ 基于/ 动态/ 的/ 自/ 适应/ 决策/ ./ 动态/ 的/ 自/ 适应/ 决策/ 通常/ 可以/ 利用/ 应用/ 系统/ 性能/ 模型/ [/ 8/ -/ 11/ ]/ 或者/ 智能/ 优化/ 算法/ [/ 12/ -/ 15/ ]/ 来/ 实现/ ./ 其中/ ,/ 利用/ 应用/ 系统/ 性能/ 模型/ 进行/ 自/ 适应/ 决策/ 是/ 在/ 离线/ 阶段/ 建立/ 应用/ 系统资源/ 、/ 负载/ 、/ 性能/ 三者/ 关系/ 的/ 模型/ ,/ 然后/ 在线/ 阶段/ 以/ 系统/ 当前/ 的/ 负载/ 和/ 性能/ 目标/ 作为/ 性能/ 模型/ 的/ 输入/ ,/ 计算/ 得到/ 资源/ 的/ 调整/ 量/ ;/ 采用/ 智能算法/ 进行/ 决策/ 是/ 将/ 自/ 适应/ 方案/ 的/ 生成/ 转换/ 为/ 最优化/ 问题/ ,/ 即/ 从/ 所有/ 可能/ 的/ 调整/ 动作/ 中/ 选出/ 满足/ 优化/ 目标/ 且/ 调整/ 代价/ 最小/ 的/ 动作/ 组合/ ./ 但是/ 云/ 环境/ 以及/ 部署/ 在/ 云/ 环境/ 中/ 的/ SBS/ 是/ 动态变化/ 的/ (/ 如/ 虚拟机/ 资源/ 增减/ 、/ 组件/ 服务/ 发生/ 替换/ 等/ )/ ,/ 离线/ 模型/ 可能/ 会/ 存在/ 不能/ 很/ 好/ 地/ 适应/ 变化/ 后/ 环境/ 的/ 情况/ ./ 而/ 利用/ 智能/ 优化/ 算法/ 求解/ 的/ 效率/ 通常/ 很难/ 满足/ 在线/ 自/ 适应/ 调整/ 在/ 高效性/ 方面/ 的/ 要求/ (/ 尽量减少/ SLA/ 违例/ 的/ 时间/ )/ ,/ 例如/ 一个/ SBS/ 由/ i/ 个/ 组件/ 服务/ 组成/ ,/ 每个/ 组件/ 服务/ 所在/ 的/ 虚拟机/ 都/ 可以/ 调整/ CPU/ 和/ 内存/ 资源/ ,/ CPU/ 的/ 调整/ 方案/ 为/ P/ 种/ (/ 可/ 调整/ 的/ CPU/ 数量/ 为/ 0/ ~/ P/ )/ ,/ 内存/ 的/ 调整/ 方案/ 为/ Q/ // M/ 种/ (/ 可/ 调整/ 的/ 内存/ 总量/ 为/ Q/ ,/ 最小/ 调整/ 量/ 为/ M/ )/ ./ 那么/ 智能/ 优化/ 算法/ 需要/ 在/ (/ P/ ×/ Q/ // M/ )/ i/ 种/ 动作/ 组合/ 中/ 进行/ 选择/ ,/ 这/ 将/ 耗费/ 大量/ 的/ 计算/ 时间/ ./ 针对/ 这些/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 强化/ 学习/ 的/ 云/ 应用/ 自/ 适应/ 方法/ ,/ 该/ 方法/ 在/ 动态/ 决策/ 的/ 过程/ 中/ 积累/ 相应/ 的/ 经验/ 数据/ ,/ 并/ 利用/ 历史/ 经验/ 在线/ 学习/ 到/ 资源/ 调整/ 的/ 效果/ ,/ 通过/ 不断/ 重复/ “/ 执行/ -/ 积累/ -/ 学习/ -/ 决策/ ”/ 的/ 过程/ ,/ 从而/ 生成/ 更好/ 的/ 资源/ 调整/ 方案/ ,/ 即/ 通过/ 在线/ 学习/ 不断/ 优化/ 决策/ 结果/ ./ 本文/ 采用/ 了/ Q/ -/ learning/ 算法/ ,/ 该/ 算法/ 是/ 一种/ 无/ 模型/ (/ model/ -/ free/ )/ 的/ 在线/ 学习/ 算法/ ,/ 在/ 自/ 适应/ 的/ 过程/ 中/ 不/ 需要/ 建立/ 应用/ 系统/ 的/ 性能/ 模型/ ,/ 可以/ 更好/ 地/ 应对/ 自/ 适应/ 过程/ 中/ 的/ 动态变化/ ./ 此外/ ,/ 本文/ 提出/ 了/ 一种/ 引导/ 算子/ ,/ 可以/ 有效/ 地/ 缩小/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ ,/ 从而/ 提高/ 算法/ 的/ 学习/ 效率/ ,/ 保证/ 自/ 适应/ 优化/ 的/ 高效性/ ./ 本文/ 的/ 主要/ 贡献/ 有/ :/ Page3/ (/ 1/ )/ 本文/ 提出/ 了/ 一种/ 基于/ 强化/ 学习/ 的/ 自/ 适应/ 方法/ ,/ 可以/ 在/ 动态/ 决策/ 的/ 过程/ 中/ 积累/ 相应/ 的/ 经验/ 数据/ ,/ 并/ 通过/ 经验/ 数据/ 不断/ 地/ 优化/ 决策/ 结果/ ,/ 能够/ 在/ 自/ 适应/ 优化/ 的/ 过程/ 中/ 更好/ 地/ 应对/ 云/ 环境/ 以及/ SBS/ 的/ 动态性/ ;/ (/ 2/ )/ 本文/ 采用/ 形式化/ 的/ 描述/ 方法/ 构建/ 了/ 云/ 服务/ 运行/ 时自/ 适应/ 优化/ 的/ 表示/ 模型/ ,/ 建立/ 了/ 可以/ 完备/ 描述/ 自/ 适应/ 基本要素/ 之间/ 相互/ 关系/ 的/ 特征描述/ 框架/ ;/ (/ 3/ )/ 为了/ 保证/ 应用/ 系统/ 运行/ 时自/ 适应/ 优化/ 的/ 高效性/ ,/ 本文/ 提出/ 了/ 一种/ 引导/ 算子/ ,/ 该/ 算子/ 通过/ 自/ 适应/ 动作/ 所/ 包含/ 的/ 特征/ 对/ 自/ 适应/ 动作/ 进行/ 筛选/ ,/ 可以/ 有效/ 地/ 缩小/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ ,/ 达到/ 提高/ 算法/ 学习/ 效率/ 的/ 目的/ ./ 本文/ 第/ 2/ 节对/ 所/ 提出/ 的/ 方法/ 进行/ 了/ 概述/ ;/ 第/ 3/ 、/ 4/ 、/ 5/ 节/ 分别/ 对/ 自/ 适应/ 基础/ 信息/ 、/ 自/ 适应/ 动态/ 决策/ 和/ 在线/ 学习/ 过程/ 进行/ 描述/ ;/ 第/ 6/ 节/ 给出/ 相关/ 的/ 实例/ 分析/ ;/ 第/ 7/ 节为/ 实验/ 及其/ 结果/ 分析/ ;/ 第/ 8/ 节/ 介绍/ 本文/ 相关/ 研究/ 的/ 现状/ ;/ 最后/ 总结/ 全文/ ./ 2/ 基于/ 强化/ 学习/ 的/ 自/ 适应/ 2.1/ 基于/ 强化/ 学习/ 的/ 自/ 适应/ 模型/ 基于/ 强化/ 学习/ 的/ 决策/ 可以/ 看作/ 是/ 一个/ Agent/ (/ 应用/ 系统/ 也/ 可以/ 扮演/ Agent/ 的/ 角色/ )/ 与/ 部署/ 环境/ 之间/ 的/ 互动/ 模型/ (/ interactionmodel/ )/ [/ 16/ ]/ ,/ 如图/ 1/ 所示/ ./ 在/ 该/ 模型/ 中/ ,/ Agent/ 可以/ 立即/ 监测/ 到/ 软件系统/ 运行/ 环境/ 的/ 状态/ ,/ 并/ 获得/ 当前/ 环境/ 的/ 回报/ 值/ (/ 根据/ 当前/ 环境/ 状态/ 计算/ 得到/ 的/ 一个/ 数值/ )/ ./ 基于/ 当前/ 的/ 环境/ 状态/ (/ State/ )/ st/ 和/ 回报/ 值/ rt/ ,/ Agent/ 选择/ 一个/ 动作/ (/ Action/ )/ at/ ,/ 并/ 通过/ 执行/ 动作/ at/ 来/ 影响/ 环境/ ./ 在/ 动作/ 执行/ 完成/ 后/ ,/ 环境/ 将/ 转换/ 到/ 下/ 一/ 状态/ st/ +/ 1/ ,/ 对应/ 一个/ 新/ 的/ 回报/ 值/ rt/ +/ 1/ ,/ Agent/ 将/ 基于/ st/ +/ 1/ 和/ rt/ +/ 1/ 选出/ 一个/ 新/ 的/ 动作/ at/ +/ 1/ ./ 这种/ Agent/ 和/ 环境/ 之间/ 周期性/ 的/ 持续/ 互动/ 是/ 实现/ 自/ 适应/ 自主性/ 的/ 基础/ ./ 但是/ 上述/ 模型/ 应用/ 在/ 面向/ 云/ 应用/ 的/ 自适应性/ 能/ 优化/ 中/ 会/ 存在/ 以下/ 问题/ :/ (/ 1/ )/ 在/ 云/ 应用/ 系统/ 性能/ 符合/ SLA/ 要求/ 时/ ,/ 持续/ 的/ 频繁/ 调整/ 会/ 导致/ 不必要/ 的/ 成本/ ,/ 包括/ 决策/ 和/ 执行/ 时所/ 使用/ 的/ 计算资源/ 和/ 额外/ 增加/ 的/ 资源/ 的/ 成本/ ;/ (/ 2/ )/ 由于/ 基于/ 资源/ 调整/ 的/ 自/ 适应/ 优化/ 过程/ 中/ 存在/ 数量/ 众多/ 的/ 调整/ 动作/ ,/ 且/ 在/ 动作/ 选择/ 时有/ 可能/ 会/ 选择/ 对云/ 应用/ 系统/ 性能/ 造成/ 不良影响/ 的/ 动作/ (/ 例如/ 在/ SBS/ 系统/ 正常/ 运行/ 时/ ,/ 选择/ 并/ 执行/ 减少/ VM/ 资源/ 的/ 动作/ 可能/ 会/ 导致/ 云/ 应用/ 系统/ 性能/ 下降/ ,/ 发生/ SLA/ 违例/ )/ ,/ 从而/ 影响/ 强化/ 学习/ 算法/ 的/ 收敛/ 速度/ 和/ 自/ 适应/ 的/ 优化/ 效果/ ./ 为了/ 解决/ 上述/ 问题/ ,/ 本文/ 采用/ 如图/ 2/ 所示/ 的/ 模型/ ./ 针对/ 第一个/ 问题/ ,/ 该/ 模型/ 采用/ 了/ 事件/ 触发/ 机制/ (/ 如图/ 2/ 中/ 的/ |/ E/ |/ 所示/ )/ ,/ 即/ Agent/ 根据/ 环境/ 状态/ st/ 和/ 回报/ 值/ rt/ 选择/ 一个/ 动作/ at/ 前/ ,/ 需要/ 先/ 判断/ 是否/ 有/ 触发/ 事件/ (/ Event/ )/ 被/ 触发/ ,/ 如果/ 触发/ 事件/ 被/ 触发/ ,/ 则/ 开始/ 执行/ 系统/ 的/ 自/ 适应/ 调整/ ,/ 从而/ 避免/ 了/ 云/ 应用/ 系统/ 的/ 性能/ 符合/ SLA/ 要求/ 后/ ,/ 还/ 继续/ 进行/ “/ 无效/ ”/ 的/ 调整/ ./ 针对/ 第/ 2/ 个/ 问题/ ,/ 本文/ 利用/ 被/ 触发/ 的/ 事件/ 对/ 所有/ 可/ 执行/ 的/ Action/ 进行/ 筛选/ ,/ 保留/ 与/ 触发/ 事件/ 有/ 相同/ 目标/ 趋势/ 的/ Action/ 作为/ 候选/ 集/ (/ 例如/ 云/ 应用/ 的/ 响应/ 时间/ 超过/ SLA/ 规定/ 的/ 上限/ 时/ 触发/ 事件/ e/ 被/ 触发/ ,/ e/ 的/ 目标/ 趋势/ 是/ 提升/ 组件/ 服务/ 的/ 性能/ ,/ 所以/ 将/ 增加/ 资源/ 类/ 的/ Action/ 作为/ 候选/ 集/ )/ ,/ 即/ 对/ Agent/ 进行/ 了/ 引导/ (/ shaping/ )/ ,/ 限定/ 其/ 在/ 特定/ 范围/ 的/ Action/ 集合/ 中/ 进行/ 选择/ ,/ 从而/ 提升/ 强化/ 学习/ 算法/ 的/ 学习/ 效率/ ./ 为了/ 将/ 上述/ 的/ Agent/ -/ 环境/ 互动/ 模型/ 应用/ 到/ 面向/ SBS/ 云/ 应用/ 的/ 自/ 适应/ 资源/ 调整/ 中/ ,/ 本文/ 假设/ SBS/ 系统/ 是/ 由/ i/ 个/ 组件/ 服务/ c1/ ,/ c2/ ,/ …/ ,/ ci/ 构成/ ,/ 其/ 部署/ 的/ 云/ 环境/ 包含/ j/ 个/ 物理/ 机/ pm1/ ,/ pm2/ ,/ …/ ,/ pmj/ ,/ 各/ 物理/ 机上/ 的/ 可/ 分配/ 的/ 资源量/ 为/ R/ α/ 为/ 资源类型/ ./ 并设/ 触发/ 事件/ 的/ 有限/ 集合/ 为/ E/ ,/ 自/ 适应/ 方案/ 的/ 有限/ 集合/ 为/ P/ ,/ 每个/ 自/ 适应/ 方案/ (/ p/ ∈/ P/ )/ 包含/ m/ 个/ 自/ 适应/ 调整/ {/ a1/ ,/ a2/ ,/ …/ ,/ am/ }/ ,/ 对于/ 每/ 一个/ am/ ,/ 其/ 调整/ 的/ 资源量/ 为/ rm/ ,/ k/ (/ 即/ am/ 调整/ 的/ 资源/ 需要/ 由/ 物理/ 机/ pmk/ 提供/ )/ ./ 当/ 一个/ 触发/ 事件/ (/ e/ ∈/ E/ )/ 被/ 触发/ 时/ ,/ 如果/ Agent/ 总是/ 可以/ 选出/ 一个/ 最佳/ 的/ 自/ 适应/ 方案/ (/ p/ ∈/ P/ )/ ,/ 那么/ 可以/ 认为/ Agent/ 拥有/ 一组/ 最优/ 的/ 自/ 适应/ 方案/ ,/ 使得/ SBS/ 系统/ 的/ 响应/ 时间/ 满足/ SLA/ 的/ 约束/ 时/ ,/ 自/ 适应/ 调整/ 的/ 资源量/ 满足/ 当前/ 云/ 环境/ 的/ 可用/ Page4D/ :/ E/ →/ Ps/ ./ t/ ./ RTsla/ _/ low/ / RT/ / RTsla/ _/ up/ ∑/ ml/ =/ 1/ 资源/ 约束/ ./ 则/ 该/ 模型/ 的/ 形式化/ 描述/ 如下/ :/ 式/ (/ 1/ )/ 中/ 的/ D/ 为/ 一个/ 决策/ 器/ ,/ 表示/ 在/ SBS/ 运行/ 期间/ 可以/ 将/ 每/ 一种/ 触发/ 事件/ (/ e/ ∈/ E/ )/ 映射/ 到/ 一个/ 合适/ 的/ 自/ 适应/ 方案/ 上/ (/ p/ ∈/ P/ )/ ;/ 式/ (/ 2/ )/ 为/ SBS/ 系统/ 响应/ 时间/ RT/ 的/ 约束/ ;/ 式/ (/ 3/ )/ 表示/ 一台/ 物理/ 机内/ 的/ 自/ 适应/ 调整/ 的/ 资源量/ 不能/ 超过/ 其/ 最大/ 可用/ 资源/ 数量/ ./ 所以/ ,/ 面向/ SBS/ 云/ 应用/ 的/ 自/ 适应/ 决策/ 的/ 主要/ 目标/ 是/ 找到/ 一个/ 最优/ 的/ 决策/ 器/ D/ ,/ 在/ 面对/ 环境/ 和/ 用户/ 访问/ 动态变化/ 时/ ,/ 决策/ 器/ D/ 可以/ 自动/ 地/ 制定/ 自/ 适应/ 优化/ 方案/ ./ 2.2/ 方法/ 概述/ 在/ Agent/ -/ 环境/ 互动/ 模型/ 的/ 基础/ 上/ ,/ 本文/ 提出/ 的/ 基于/ 强化/ 学习/ 的/ SBS/ 云/ 应用/ 自/ 适应/ 的/ 基本/ 过程/ 如图/ 3/ 所示/ ./ 主要/ 分为/ 监测/ 、/ 触发/ 、/ 决策/ 、/ 执行/ 、/ 评估/ 和/ 学习/ 6/ 个/ 阶段/ :/ 监测/ 阶段/ 主要/ 是/ 获得/ 与/ SBS/ 系统/ 相关/ 的/ 云/ 环境/ 状态/ 信息/ (/ 如/ VM/ 占用/ 的/ 资源量/ 等/ )/ 以及/ SBS/ 系统/ 的/ 运行/ 状态/ 信息/ (/ 如/ 响应/ 时间/ 、/ 用户/ 并发/ 量/ 等/ )/ ,/ 然后/ 将/ 这些/ 信息/ 传递/ 到/ 触发/ 阶段/ ./ 在/ 触发/ 阶段/ 时/ ,/ 需要/ 判断/ 监测/ 信息/ 是否/ 满足/ 触发/ 事件/ 中/ 的/ 触发/ 条件/ ,/ 若/ 满足/ 触发/ 条件/ 则/ 进入/ 决策/ 阶段/ ./ 另外/ ,/ 如果/ 有/ 自/ 适应/ 调整/ 动作/ 未/ 执行/ 完成/ 时/ ,/ 则/ 不/ 触发/ 新/ 的/ 触发/ 事件/ ./ 图/ 3/ 自/ 适应/ 基本/ 过程/ 3.1/ 关键/ 性能指标/ 假设/ 预期/ 系统/ 行为/ 可以/ 通过/ 一系列/ 的/ 指标/ 来/ 进行/ 描述/ ,/ 这些/ 指标/ 通过/ 获取/ 系统/ 性能/ 特定/ 的/ 方面/ 获得/ ,/ 例如/ CPU/ 利用率/ 、/ 内存/ 占用率/ 、/ 系统/ 响应/ 时间/ 、/ 服务/ 等级/ (/ SLA/ )/ 等/ [/ 6/ ]/ ,/ 并/ 将/ 这些/ 指标/ 称为/ 关键/ 性能指标/ ./ KPI/ 可以/ 用来/ 描述/ 单个/ 组件/ 或/ 整个/ 系统/ 的/ 状态/ ,/ 例如/ 可以/ 使用/ c/ ./ KPI/ 来/ 表示/ 组件/ 服务/ c/ 的/ KPI/ 值/ ./ 在/ 决策/ 阶段/ 时/ ,/ Agent/ 根据/ 监测/ 信息/ 和/ 决策/ 经验/ 信息/ 选出/ 最优/ 的/ 自/ 适应/ 调整/ 动作/ ./ 在/ 执行/ 阶段/ 时/ ,/ Agent/ 执行/ 上一阶段/ 选择/ 的/ 自/ 适应/ 调整/ 动作/ ,/ 完成/ 对云/ 环境/ 中/ 虚拟机/ 资源/ 的/ 调整/ ./ 当自/ 适应/ 调整/ 动作/ 执行/ 完成/ 后/ ,/ Agent/ 将/ 利用/ 适应度/ 函数/ (/ fitnessfunction/ )/ 评估/ 调整/ 后/ 的/ 云/ 环境/ 所/ 能/ 获得/ 的/ 回报/ ,/ 并/ 利用/ Q/ -/ learning/ 对/ 所/ 执行/ 的/ 自/ 适应/ 调整/ 的/ 经验/ (/ 即/ 评估/ 阶段/ 获得/ 的/ 回报/ 值/ )/ 进行/ 累积/ ,/ 为/ 以后/ 的/ 决策/ 提供/ 经验/ ./ 在/ 上述/ 过程/ 中/ ,/ 监测/ 和/ 执行/ 均/ 可以/ 通过/ 使用/ 现有/ 的/ 软件/ 来/ 完成/ ,/ 例如/ 利用/ collectd/ 获得/ 应用/ 系统/ 性能/ 信息/ ,/ 利用/ libvirtAPI/ 获得/ VM/ 资源/ 占/ 用量/ 和/ 调整/ VM/ 的/ 资源/ ./ 触发/ 则/ 是/ 依次/ 判断/ 监测/ 的/ 数据/ 是否/ 满足/ 相应/ 触发/ 事件/ ./ 所以/ ,/ 在/ 接下来/ 的/ 第/ 3/ 、/ 4/ 、/ 5/ 节/ 中将/ 重点/ 介绍/ 自/ 适应/ 基础/ 信息/ 形式化/ 描述/ 、/ 如何/ 在/ 决策/ 的/ 过程/ 中/ 使用/ Q/ -/ learning/ 学习/ 到/ 的/ 经验/ 和/ 如何/ 累积/ 自/ 适应/ 调整/ 之后/ 的/ 经验/ ./ 3/ 自/ 适应/ 基础/ 信息/ 本/ 节/ 介绍/ 了/ 基于/ 强化/ 学习/ 自/ 适应/ 过程/ 中/ 的/ 基础/ 信息/ ,/ 包括/ :/ 系统/ 行为/ 的/ 描述/ 指标/ (/ KeyPerformanceIndicator/ ,/ KPI/ )/ 、/ SBS/ 系统/ 的/ 部署/ 信息/ (/ 包括/ 物理/ 机/ 、/ 虚拟机/ 和/ 组件/ 服务/ 的/ 部署/ 信息/ )/ 、/ 自/ 适应/ 优化/ 目标/ (/ Goal/ )/ 和/ 触发/ 事件/ (/ Event/ )/ ,/ 并/ 在/ 此基础/ 上/ 对/ Q/ -/ learning/ 的/ State/ 和/ Action/ 进行/ 了/ 形式化/ 描述/ ./ KPI/ 的/ 定义/ 包括/ 名称/ 、/ 数据类型/ 、/ 组合/ 方程/ 和/ 边界值/ (/ RelevanceMargin/ )/ ./ 其中/ 组合/ 方程/ 用来/ 说明/ 如何/ 计算/ 系统/ 全局/ 或/ 部署/ 了/ 组件/ 服务/ 的/ 单个/ 虚拟机/ 的/ KPI/ 值/ ,/ 而/ 边界值/ 则/ 用来/ 说明/ 两个/ 同/ 类型/ 的/ KPI/ 值/ 是否/ 相同/ ,/ 即当/ 两个/ 同/ 类型/ 的/ KPI/ 值/ 的/ 差值/ 小于/ 边界值/ 时/ ,/ 认为/ 这/ 两个/ KPI/ 值/ 相同/ ./ 本文/ 中/ 所/ 定义/ 的/ KPI/ 如下/ 所示/ :/ Page5KPIcpu/ _/ use/ :/ doubleCombFuncSumRMargin0/ ./ 01KPImem/ _/ use/ :/ doubleCombFuncSumRMargin0/ ./ 1KPIuser/ _/ con/ :/ intCombFuncSumRMargin0KPIresp/ _/ time/ :/ doubleCombFuncTreeRMargin0/ ./ 01/ 在/ 本文/ 中/ ,/ 我们/ 假设/ 系统/ 级/ 的/ KPI/ 值/ 都/ 可以/ 通过/ 系统/ 中/ 每个/ 单独/ 的/ 组件/ 服务/ 的/ KPI/ 值/ 组合/ 获得/ ,/ 即/ 系统/ 级/ 的/ KPI/ 值/ 可以/ 通过/ c/ ./ KPI/ 对应/ 的/ 组合/ 方程/ 计算/ 得到/ ,/ 其中/ 组合/ 方程/ 是/ 单调/ 递增/ 或/ 单调/ 递减/ 的/ ,/ 如/ CPU/ 、/ 内存/ 、/ 网络/ 和/ 用户/ 并发/ 量/ 的/ KPI/ 值/ ./ 但/ 对于/ 响应/ 时间/ 的/ KPI/ 值/ ,/ 由于/ 本文/ 讨论/ 的/ 云/ 应用/ 系统/ 是/ 由/ 多个/ 组件/ 服务/ 构成/ 的/ SBS/ 系统/ ,/ 其/ 业务流程/ 中/ 会/ 存在/ 顺序/ 、/ 循环/ 、/ 并行/ 和/ 选择/ 这/ 4/ 种/ 结构/ ,/ 可以/ 采用/ 标记/ 树对/ SBS/ 的/ 组合/ 流程/ 进行/ 等价/ 转换/ 并/ 计算/ 其/ 响应/ 时间/ [/ 9/ ]/ ./ 3.2/ 系统/ 部署/ 信息系统/ 部署/ 信息/ 描述/ 了/ 云/ 环境/ 中/ 与/ SBS/ 云/ 服务/ 部署/ 相关/ 的/ 物理/ 机/ 、/ 虚拟机/ 以及/ SBS/ 系统/ 中/ 组件/ 服务/ 的/ 部署/ 信息/ ,/ 以/ 虚拟机/ 的/ 部署/ 信息/ 为例/ ,/ 其/ 具体/ 形式/ 如下/ :/ VirtualMachineSpecificationVM/ _/ nameDeployment/ :/ (/ component1/ ,/ …/ ,/ componentn/ )/ Resource/ :/ (/ (/ Resource1/ ,/ Count/ )/ ,/ …/ ,/ (/ Resourcen/ ,/ Status/ :/ [/ RUNNING/ // UNUSED/ // UNALLOCATED/ ]/ Deployment/ 和/ Resource/ 分别/ 描述/ 了/ 该/ 虚拟机/ 上/ 部署/ 的/ 组件/ 服务/ 的/ 情况/ 和/ 该/ 虚拟机/ 的/ 资源/ 信息/ ./ Status/ 描述/ 了/ 虚拟机/ 的/ 运行/ 状态/ ,/ 共有/ 3/ 种/ 类型/ :/ RUNNING/ 、/ UNUSED/ 和/ UNALLOCATED/ ,/ 分别/ 表示/ 该/ 虚拟机/ 处于/ 运行/ 、/ 停止/ 和/ 未/ 分配/ 状态/ ,/ 其中/ ,/ 处于/ UNALLOCATED/ 状态/ 表示/ 未/ 创建/ 该/ 虚拟机/ 的/ 运行/ 实例/ ./ 3.3/ 自/ 适应/ 优化/ 目标/ 和/ 触发/ 事件/ 每个/ 自/ 适应/ 目标/ 使用/ KPI/ 来/ 描述/ 特定/ 的/ 自/ 适应/ 优化/ 目标/ ,/ 并/ 使用/ Above/ 、/ Below/ 和/ Between/ 关键字/ 来/ 确定/ 自/ 适应/ 目标/ 可/ 接受/ 的/ 指标/ 的/ 范围/ ,/ 每个/ 自/ 适应/ 目标/ 可以/ 通过/ 人工/ 设定/ 或/ 从/ SLA/ 约束/ 中/ 自动/ 抽取/ 等/ 方式/ 获得/ ,/ 本文/ 采用/ 人工/ 设定/ 的/ 方式/ ./ 具体/ 形式/ 如下/ :/ Goalgoal/ _/ name/ :/ kpi/ _/ nameAbovethr/ _/ lowerGoalgoal/ _/ name/ :/ kpi/ _/ nameBelowthr/ _/ upperGoalgoal/ _/ name/ :/ kpi/ _/ nameBetweenthr/ _/ lower/ 其中/ :/ Above/ 目标/ 表示/ 应该/ 使/ KPI/ 的/ 值/ 高于/ 所/ 给定/ 的/ 阈值/ thr/ _/ lower/ ;/ Below/ 目标/ 表示/ 应该/ 使/ KPI/ 的/ 值/ 低于/ 所/ 给定/ 的/ 阈值/ thr/ _/ upper/ ;/ between/ 目标/ 表示/ 应该/ 使/ KPI/ 的/ 值/ 保持/ 在/ 所/ 给定/ 的/ 阈值/ 区间/ ./ 触发/ 事件/ 为/ 自/ 适应/ 调整/ 的/ 触发/ 条件/ ,/ 每/ 一个/ 触发/ 事件/ 关联/ 着/ 一个/ 特定/ 的/ 自/ 适应/ 目标/ ,/ 并/ 说明/ 事件/ 触发/ 后/ 自/ 适应/ 调整/ 所/ 应/ 达到/ 的/ 目标/ 趋势/ ,/ 具体/ 形式/ 如下/ :/ Eventgoal/ _/ name/ ./ event/ _/ name/ :/ kpi/ _/ name/ [/ >/ // </ ]/ thrTargettarget/ _/ name/ 其中/ :/ goal/ _/ name/ ./ event/ _/ name/ 为/ 自/ 适应/ 目标/ 和/ 触发/ 事件/ 名称/ 的/ 组合/ ,/ 描述/ 了/ 两者/ 的/ 对应/ 关系/ ;/ kpi/ _/ name/ [/ >/ // </ ]/ thr/ 为/ 判定/ 条件/ ,/ 表示/ 当/ KPI/ 的/ 值/ 大于/ // 小于/ 阈值/ thr/ 时/ 满足/ 触发/ 条件/ ;/ Target/ 表示/ 触发/ 事件/ 触发/ 后/ 自/ 适应/ 调整/ 所/ 应/ 达到/ 的/ 目标/ 趋势/ ,/ 包括/ 两种/ 类型/ :/ IMPR/ _/ PERF/ 和/ DEGR/ _/ PERF/ ,/ 分别/ 表示/ 触发/ 事件/ 触发/ 后应/ 执行/ 提升/ 或/ 降低/ 组件/ 服务/ 性能/ 的/ 自/ 适应/ 调整/ ./ 在/ 实际/ 系统/ 中/ 使用/ 上述/ 触发/ 事件/ 时/ ,/ 为了/ 避免/ 系统/ KPI/ 值/ 在/ 短时间/ 内/ 超过/ 阈值/ 所/ 造成/ 的/ 不必要/ 的/ 触发/ ./ 本文/ 的/ 触发/ 机制/ 采用/ 基于/ 时间/ 窗/ 的/ 方法/ ,/ 即当/ 时间/ 窗内/ 的/ 系统/ KPI/ 值有/ x/ %/ 超过/ 触发/ 事件/ 中/ 的/ 阈值/ 时/ ,/ 才/ 认为/ 触发/ 事件/ 会/ 被/ 触发/ ./ 其中/ ,/ 时间/ 窗/ 的/ 宽度/ 和/ x/ 的/ 值/ 可以/ 根据/ 经验/ 来/ 设定/ ./ 根据/ 自/ 适应/ 目标/ 抽取/ 对应/ 的/ 触发/ 事件/ ,/ 触发/ 事件/ 的/ 判定/ 条件/ 可以/ 依据/ 自/ 适应/ 目标/ 中/ 的/ 关键字/ (/ Above/ 、/ Below/ 和/ Between/ )/ 和/ 阈值/ 来/ 确定/ ,/ 具体/ 的/ 对应/ 规则/ 如表/ 1/ 所示/ ./ 在/ 确定/ 触发/ 事件/ 的/ 判定/ 条件/ 后/ ,/ 可以/ 根据/ 判定/ 条件/ 确定/ 触发/ 事件/ 的/ 目标/ 趋势/ ,/ 具体/ 为/ 当/ 判定/ 条件/ 为/ “/ >/ ”/ 时/ ,/ 目标/ 趋势/ 为/ “/ IMPR/ _/ PERF/ ”/ ;/ 当/ 判定/ 条件/ 为/ “/ </ ”/ 时/ ,/ 目标/ 趋势/ 为/ “/ DEGR/ _/ PERF/ ”/ ./ Betweenthr/ _/ lowerthr/ _/ upper/ </ thr/ _/ lower/ >/ thr/ _/ upper3/ ./ 4State/ 和/ Action/ 的/ 形式化/ 表示/ State/ 和/ Action/ 的/ 形式化/ 表示/ 定义/ 了/ 系统/ 的/ 问题/ 空间/ 和/ 解决方案/ 空间/ ,/ 是/ 设计/ 性能/ 优化/ 方法/ 中/ 基于/ Q/ -/ learning/ 动态/ 决策/ 的/ 关键步骤/ ./ 本文/ 设/ 环境/ 状态/ 的/ 集合/ 为/ S/ =/ {/ s1/ ,/ s2/ ,/ …/ ,/ sn/ }/ ,/ 每个/ 环境/ 状态/ si/ 包括/ 云/ 环境/ 中/ 与/ SBS/ 系统/ 相关/ 的/ VM/ 的/ 资源/ 拥有量/ 和/ SBS/ 系统/ 当前/ 的/ 负载/ 所处/ 的/ 区间/ ,/ 其/ 形式/ 可以/ 表示/ 为/ Statestate/ _/ nameResource/ :/ (/ Resourcevm1/ ,/ Resourcevm2/ ,/ …/ ,/ Resourcevmn/ )/ Page6Load/ :/ load/ _/ type/ 其中/ ,/ Resource/ 为/ 与/ SBS/ 系统/ 相关/ 的/ VM/ 的/ 资源/ 拥有量/ ,/ 本文/ 为了/ 减少/ 环境/ 状态/ 的/ 数量/ ,/ 将/ VM/ 的/ 资源/ 拥有量/ 设定/ 为/ 固定/ 的/ 6/ 种/ :/ NANO/ 、/ MICRO/ 、/ SMALL/ 、/ MEDIUM/ 、/ LARGE/ 和/ EXLARGE/ ./ 采用/ 这种/ 设定/ ,/ 一方面/ 是/ 参考/ 亚马逊/ EC2/ 中/ 虚拟机/ 实例/ 的/ 设定/ ,/ 另一方面/ 是/ 通过/ 对/ SBS/ 系统/ 进行/ 基准/ 测试/ ,/ 参考/ 基准/ 测试数据/ 所/ 设定/ 给/ 的/ (/ 例如/ ,/ 通过/ 基准/ 测试/ 可以/ 得到/ 当/ VM/ 的/ CPU/ 数量/ 为/ 8/ ,/ 内存/ 为/ 8GB/ 时/ ,/ 再/ 继续/ 增加/ VM/ 的/ 资源/ 不会/ 使/ SBS/ 的/ 性能/ 有/ 明显/ 的/ 提升/ )/ ,/ 具体/ 如表/ 2/ 所示/ ./ Load/ 是/ SBS/ 系统/ 当前/ 的/ 负载/ 类型/ ,/ 即/ 当前/ 的/ 并发/ 用户数量/ 所处/ 的/ 区间/ ,/ 其/ 设定/ 类似/ 于/ 虚拟机/ 资源类型/ 的/ 设定/ ,/ 具体/ 如表/ 3/ 所示/ ./ NANOMICROSMALLMEDIUMLARGEEXLARGE/ 对于/ Action/ ,/ 本文/ 设自/ 适应/ 动作/ 的/ 集合/ 为/ A/ =/ {/ a1/ ,/ a2/ ,/ …/ ,/ am/ }/ ,/ 每个/ 自/ 适应/ 动作/ aj/ 包括/ 自/ 适应/ 原语/ 和/ 动作/ 执行/ 后/ 的/ 目标/ 趋势/ ,/ 具体/ 形式/ 如下/ :/ Actionaction/ _/ namePrimitive/ :/ primitive/ _/ name/ (/ object/ ,/ ori/ _/ res/ ,/ des/ _/ res/ )/ Target/ :/ [/ IMPR/ _/ PERF/ // DEGR/ _/ PERF/ ]/ 其中/ ,/ Primitive/ 为/ 自/ 适应/ 原语/ ,/ 即/ 每个/ 自/ 适应/ 调整/ 方式/ 的/ 具体/ 执行/ 指令/ ,/ 其/ 第/ 1/ 个/ 参数/ 为/ 调整/ 的/ 目标/ VM/ ,/ 第/ 2/ 、/ 3/ 个/ 参数/ 分别/ 为/ VM/ 调整/ 前后/ 所/ 占有/ 的/ 资源/ 数量/ ,/ 例如/ addRes/ (/ VM1/ ,/ SMALL/ ,/ MEDIUM/ 是/ 将/ VM1/ 的/ 资源/ 从/ SMALL/ 调整/ 为/ MEDIUM/ ./ Target/ 是/ 自/ 适应/ 原语/ 执行/ 后/ 所/ 实现/ 的/ 目标/ 趋势/ ,/ 与/ 触发/ 事件/ 中/ 的/ 目标/ 趋势/ 相同/ ./ 当/ SBS/ 由/ i/ 个/ 组件/ 服务/ 构成/ 时/ ,/ 环境/ 状态/ 的/ 集合/ S/ 中共/ 有/ xi/ ×/ y/ 个/ 环境/ 状态/ ,/ 动作/ 集合/ A/ 中共/ 有/ i/ ×/ x/ (/ x/ -/ 1/ )/ ×/ y/ 个/ 自/ 适应/ 动作/ ./ 其中/ ,/ x/ 为/ 虚拟机/ 资源类型/ ,/ y/ 为/ 负载/ 类型/ ./ 在/ 本文/ 中/ x/ 和/ y/ 的/ 值/ 分别/ 为/ 6/ 和/ 5/ ,/ 即/ 根据/ 本文/ 的/ 设定/ ,/ 共有/ 6i/ ×/ 5/ 个/ 环境/ 状态/ 以及/ 30i/ ×/ 5/ 个/ 自/ 适应/ 动作/ ./ 在/ 确定/ 所有/ 环境/ 状态/ 和/ 自/ 适应/ 动作/ 后/ ,/ Agent/ 需要/ 生成/ (/ 6i/ ×/ 5/ )/ ×/ (/ 30i/ ×/ 5/ )/ 维/ 的/ 矩阵/ 犙/ ,/ 其/ 元素/ 犙/ (/ s/ ,/ a/ )/ 为/ 环境/ 处于/ 环境/ 状态/ s/ 时/ 选择/ 自/ 适应/ 动作/ a/ 的/ 经验值/ ./ 在/ 选择/ 自/ 适应/ 动作/ 时/ ,/ 由于/ 计算/ 所有/ 自/ 适应/ 动作/ 的/ 选择/ 概率/ 需要/ 耗费/ 大量/ 时间/ 和/ 资源/ ,/ 所以/ 本文/ 通过/ 两个/ 步骤/ 来/ 减少/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ :/ 首先/ 在/ 确定/ 当前/ 的/ 环境/ 状态/ 后/ ,/ 可以/ 选出/ 当前/ 环境/ 状态/ 下/ 可以/ 执行/ 的/ 自/ 适应/ 动作/ 作为/ 候选/ 自/ 适应/ 动作/ 集/ ,/ 该/ 候选/ 集中/ 共有/ 30i/ 个/ 自/ 适应/ 动作/ ;/ 然后/ 利用/ 引导/ 算子/ (/ 具体/ 见/ 第/ 4/ 节/ )/ 对/ 候选/ 集/ 进行/ 筛选/ ,/ 最终/ 的/ 候选/ 集中/ 共/ 包括/ 15i/ 个/ 自/ 适应/ 动作/ ./ 4/ 自/ 适应/ 动态/ 决策/ 当/ 触发/ 条件/ 被/ 触发/ 后/ ,/ 自/ 适应/ 动态/ 决策/ 过程/ 开始/ 执行/ ,/ 即/ 根据/ 当前/ 的/ 环境/ 状态/ 和/ 决策/ 经验/ 选择/ 合适/ 的/ Action/ ,/ 主要/ 分为/ 两个/ 步骤/ :/ 首先/ ,/ 利用/ 环境/ 状态/ 和/ 引导/ 算子/ 从/ 自/ 适应/ 动作/ 集合/ A/ 中/ 选出/ 候选/ 动作/ 集合/ Ac/ (/ Ac/ / A/ )/ ,/ 以/ 减少/ 候选/ Action/ 的/ 搜索/ 空间/ ./ 然后/ ,/ 利用/ 软/ 最大化/ (/ soft/ -/ max/ )/ 方法/ 在/ Ac/ 中/ 选择/ 合适/ 的/ 待/ 执行/ Action/ ./ 其中/ ,/ 引导/ 算子/ 从/ 自/ 适应/ 动作/ 集合/ A/ 中/ 选出/ 候选/ 动作/ 集合/ Ac/ (/ Ac/ / A/ )/ 的/ 原则/ 为/ :/ 对于/ 任意/ aj/ ∈/ A/ ,/ 若/ aj/ 中/ 的/ Target/ 与/ 被/ 触发/ 的/ 触发/ 事件/ 中/ 的/ Target/ 相同/ ,/ 则/ 将/ aj/ 加入/ 候选/ 集/ Ac/ 中/ ./ 例如/ ,/ 当/ 触发/ 事件/ Eventresp/ _/ time/ _/ goal1/ ./ event2/ :/ resp/ _/ time/ >/ 19sTargetIMPR/ _/ PERF/ 被/ 触发/ 时/ ,/ 从/ 集合/ A/ 中/ 挑选/ Target/ 为/ IMPR/ _/ PERF/ 的/ Action/ 放入/ 候选/ 动作/ 集合/ Ac/ ./ 构建/ 候选/ 集/ Ac/ 可以/ 视为/ 对/ Agent/ 进行/ 引导/ (/ shaping/ )/ ,/ 限定/ 了/ Agent/ 在/ 特定/ 范围/ 内/ 选择/ Action/ ,/ 避免/ 随机/ 选择/ Action/ 降低/ Q/ -/ learning/ 的/ 学习/ 效率/ ./ 利用/ 软/ 最大化/ 方法/ 选择/ 待/ 执行/ Action/ 时/ ,/ 认为/ 在/ 环境/ 状态/ s/ 时/ 选择/ 自/ 适应/ 动作/ a/ (/ a/ ∈/ Ac/ )/ 的/ 概率/ 与/ eQ/ (/ s/ ,/ a/ )/ τ/ 成正比/ ,/ 具体/ 为式/ 中/ :/ 犙/ (/ s/ ,/ a/ )/ 为/ 环境/ 处于/ 环境/ 状态/ s/ 时/ 选择/ 自/ 适应/ 动作/ a/ 的/ 经验值/ ;/ τ/ (/ τ/ >/ 0/ )/ 是/ 选择/ 参数/ ,/ 当/ τ/ 较大/ 时/ 表示/ 任意/ 自/ 适应/ 调整/ 被/ 选中/ 的/ 概率/ 几乎/ 一样/ ,/ 减少/ τ/ 则/ 拥有/ 最大值/ 的/ 自/ 适应/ 调整/ 被/ 选中/ 的/ 可能性/ 更大/ ,/ 若/ τ/ →/ 0/ 则/ 总是/ 选择/ 最优/ 的/ 行为/ ./ 利用/ 式/ (/ 4/ )/ ,/ Page7Agent/ 将/ 计算/ 动作/ 候选/ 集/ Ac/ 中/ 每个/ 自/ 适应/ 动作/ 的/ 选择/ 概率/ ,/ 并/ 选择/ 概率/ 值/ 最大/ 的/ 自/ 适应/ 动作/ 作为/ 结果/ ./ 若/ 多个/ 自/ 适应/ 动作/ 的/ 选择/ 概率/ 相同/ 时/ ,/ 则/ 随机/ 选择/ 一个/ 自/ 适应/ 动作/ ,/ 被/ 选择/ 的/ 自/ 适应/ 动作/ 将/ 在/ 执行/ 阶段/ 被/ 执行/ ./ 5/ 在线/ 学习/ 当/ 选择/ 的/ 自/ 适应/ 动作/ a/ 执行/ 完成/ 后/ ,/ 环境/ 状态/ 由/ s/ 转换/ 为/ s/ ,/ Agent/ 可以/ 利用/ 适应度/ 函数/ 来/ 获得/ 相应/ 的/ 回报/ r/ (/ s/ ,/ a/ )/ ,/ 并/ 利用/ 获得/ 的/ 回报/ r/ (/ s/ ,/ a/ )/ 来/ 更新/ Q/ 值/ (/ Q/ -/ values/ )/ ,/ 以/ 完成/ 在线/ 学习/ 过程/ ./ 在线/ 学习/ 过程/ 中/ ,/ 合理/ 高效/ 的/ 适应度/ 函数/ 使自/ 适应/ 动作/ 的/ 选择/ 准确/ 、/ 高效/ ,/ 本文/ 将/ 自/ 适应/ 动作/ a/ 执行/ 后/ 的/ 代价/ 和/ 收益/ 作为/ 其/ 执行/ 后/ 的/ 回报/ ,/ 即/ 利用/ 自/ 适应/ 动作/ 执行/ 所/ 需要/ 付出/ 的/ 成本/ 和/ 对系统/ 性能/ 影响/ 来/ 评价/ 自/ 适应/ 动作/ 是否/ 合理/ ./ 适应度/ 函数/ 跟/ 所/ 调整/ 的/ 资源/ 的/ 成本/ 、/ 系统/ 性能/ 的/ 变化/ 量/ 以及/ 所/ 调整/ 资源/ 是否/ 满足/ 资源量/ 的/ 约束/ 这/ 3/ 个/ 属相/ 相关/ ,/ 可以/ 定义/ 为/ 其中/ :/ ω/ c/ 和/ ω/ w/ 是/ 适应度/ 函数/ 相关/ 属性/ 的/ 权重/ ;/ c/ Δ/ R/ 是/ 调整/ 资源/ 的/ 成本/ ;/ Δ/ W/ 是/ SBS/ 系统/ 性能/ 的/ 变化/ 量/ ;/ RP/ 是/ 资源/ 调整/ 量/ 超过/ 可/ 利用/ 资源量/ 时/ 的/ 惩罚/ ./ 调整/ 资源/ 的/ 成本/ c/ Δ/ R/ 是/ 指自/ 适应/ 调整/ 在/ 执行/ 前后/ 不同/ 资源/ 变化/ 量/ 的/ 费用/ 之/ 和/ ,/ 即式/ 中/ :/ CPU/ 、/ Mem/ 分别/ 表示/ 处理器/ 、/ 内存/ 等/ 资源/ ;/ Ur/ 表示/ 每种/ 资源/ 的/ 单位/ 价格/ ,/ 可/ 通过/ 建立/ 资源/ 的/ 定价/ 模型/ 来/ 确定/ ,/ 如/ 市场/ 上/ 一条/ 容量/ 为/ 4GB/ 的/ DDR3/ 内存条/ 的/ 价格/ 是/ 220/ 元/ 左右/ ,/ 则/ 可以/ 算/ 出/ 内存/ 的/ 单位/ 价格/ 为/ 220/ 元/ // 4096MB/ =/ 0.054/ 元/ // MB/ ;/ m/ ,/ m/ 分别/ 图/ 4/ 地/ 听/ 服务器端/ 业务流程/ 表示/ 自/ 适应/ 调整/ 在/ 执行/ 前/ 和/ 执行/ 后/ VM/ 占有/ 的/ 各类/ 资源/ 的/ 总量/ ./ 当/ 增加/ 资源/ 时/ ,/ c/ Δ/ R/ 为/ 负数/ ,/ 释放/ 资源/ 时/ ,/ c/ Δ/ R/ 为/ 正数/ ./ SBS/ 系统/ 性能/ 变化/ 量/ Δ/ W/ 是/ 指自/ 适应/ 调整/ 导致/ 的/ SBS/ 系统/ 的/ 不同/ 性能指标/ (/ 如/ 响应/ 时间/ 、/ 可靠性/ 和/ 吞吐量/ 等/ )/ 的/ 变化/ ,/ 在/ 本文/ 中/ 主要/ 是/ 指/ 响应/ 时间/ 的/ 变化/ 量/ ./ 当自/ 适应/ 动作/ 调整/ 的/ 资源量/ 超过/ 可用/ 的/ 资源量/ 时/ ,/ 惩罚/ 量/ RP/ 为/ 一个/ 负数/ ,/ 否则/ RP/ 为/ 0/ ./ 在/ 学习/ 阶段/ ,/ 利用/ 获得/ 的/ 回报/ r/ (/ s/ ,/ a/ )/ 来/ 更新/ Q/ 值/ 的/ 过程/ 如式/ (/ 7/ )/ 所示/ :/ Q/ (/ s/ ,/ a/ )/ =/ (/ 1/ -/ α/ )/ Q/ (/ s/ ,/ a/ )/ +/ α/ (/ R/ (/ s/ ,/ a/ )/ +/ 式/ 中/ :/ α/ (/ 0/ / α/ / 1/ )/ 是/ 一个/ 常数/ 步长/ 参数/ ,/ 用来/ 控制/ 已有/ 经验/ 和/ 当前/ 所/ 获得/ 经验/ 之间/ 的/ 权重/ ,/ 其中/ ,/ (/ 1/ -/ α/ )/ Q/ (/ s/ ,/ a/ )/ 为/ 已有/ 经验/ ,/ α/ (/ R/ (/ s/ ,/ a/ )/ +/ γ/ maxaQ/ (/ s/ ,/ a/ )/ )/ 目前/ 回报/ 和/ 未来/ 经验/ 折扣/ 估计值/ 的/ 和/ ,/ 即/ 当前/ 所/ 获得/ 的/ 经验/ ;/ γ/ (/ 0/ / γ/ / 1/ )/ 是/ 折扣/ 因子/ ,/ 用来/ 控制/ 未来/ 动作/ 选择/ 的/ 权重/ ./ 更新/ 后/ 的/ Q/ 值/ 将/ 会/ 在/ 下/ 一次/ 决策/ 中/ 被/ 使用/ ,/ 使/ Agent/ 能够/ 选出/ 最优/ 的/ 自/ 适应/ 动作/ ./ 6/ 实例/ 分析/ 本文/ 以/ 一个/ 景点/ 语音/ 导游/ 系统/ (/ 地/ 听/ )/ 为例/ ,/ 该/ 系统/ 分为/ 服务器端/ 和/ 移动/ 端/ 两/ 部分/ ,/ 其中/ 服务器端/ 是/ 一套/ SBS/ 系统/ ,/ 共/ 由/ 7/ 个/ 组件/ 服务/ 构成/ ,/ 分别/ 是/ :/ 景区/ 定位/ (/ c1/ )/ 、/ 上传/ 图像/ 解析/ (/ c2/ )/ 、/ 图像/ 特征/ 匹配/ (/ c3/ )/ 、/ GPS/ 定位/ 识别/ 景点/ (/ c4/ )/ 、/ 当前/ 景点/ 语音/ 播放列表/ 确定/ (/ c5/ )/ 、/ 当前/ 景点/ 语音/ 播放/ 传送/ (/ c6/ )/ 和/ 后续/ 路线/ 推荐/ (/ c7/ )/ ,/ 整体/ 的/ 业务流程/ 如图/ 4/ 所示/ ./ 在/ 本文/ 中/ ,/ 将/ 重点/ 关注/ 地/ 听/ 系统/ 服务器端/ 的/ 自适应性/ 能/ 优化/ 过程/ ./ Page86/ ./ 1/ 系统/ 部署/ 信息系统/ 部署/ 在/ 由/ 6/ 台/ 物理/ 机/ (/ PhysicalMachine/ ,/ PM/ )/ 组成/ 的/ 云/ 环境/ 中/ ,/ 其中/ 3/ 台/ 物理/ 机为/ 配置/ 相同/ 的/ 服务器/ ,/ 标记/ 为/ PM1/ ~/ PM3/ ,/ 并/ 在/ 这/ 3/ 台/ 物理/ 机上/ 共/ 创建/ 7/ 台/ 配置/ 相同/ 的/ 虚拟机/ ,/ 分别/ 标记/ 为/ VM1/ ~/ VM7/ (/ 在/ PM1/ 上/ 创建/ VM1/ 和/ VM2/ ,/ 在/ PM2/ 上/ 创建/ VM3/ ~/ VM5/ ,/ 在/ PM3/ 上/ 创建/ VM6/ 和/ VM7/ )/ ,/ 然后/ 在/ 每台/ 虚拟机/ 上/ 分别/ 部署/ SBS/ 系统/ 的/ 1/ 个/ 组件/ 服务/ ,/ 如/ 在/ VM1/ 上/ 部署/ c1/ ./ 另外/ 3/ 台/ 物理/ 机则/ 分别/ 用来/ 进行/ 自/ 适应/ 决策/ 、/ 存储/ SBS/ 系统/ 的/ 业务/ 数据/ 及/ 运行/ 状态/ 的/ 监控/ 数据/ 和/ 产生/ 访问/ 负载/ 及/ 监测/ SBS/ 系统/ 的/ 运行/ 状态/ ./ 以/ PM1/ ,/ VM1/ 和/ c1/ 为例/ ,/ 相关/ 的/ 系统/ 部署/ 信息/ 如下/ 所示/ :/ PhysicalMachineSpecificationPM1Deployment/ :/ (/ VM1/ ,/ VM2/ )/ Resource/ :/ (/ (/ CPU/ ,/ 2.5/ GHz/ ×/ 2/ ×/ 4/ )/ ,/ (/ MEM/ ,/ 8GB/ )/ )/ VirtualMachineSpecificationVM1Deployment/ :/ (/ c1/ )/ Resource/ :/ (/ (/ CPU/ ,/ 1/ ×/ 2/ )/ ,/ (/ MEM/ ,/ 2GB/ )/ )/ ComponentSpecificationc1Deployment/ :/ VM1/ ,/ Status/ :/ [/ USING/ ]/ 6.2/ 自/ 适应/ 优化/ 目标/ 设定/ 和/ 触发/ 事件/ 生成/ 在/ 地/ 听/ 系统/ 自/ 适应/ 优化/ 的/ 过程/ 中/ ,/ 自/ 适应/ 优化/ 的/ 目标/ 是/ 要/ 保证系统/ 的/ 响应/ 时间/ 不能/ 超过/ SLA/ 中/ 规定/ 的/ 阈值/ ./ 而/ 与/ 该/ 目标/ 相关/ 的/ 指标/ ,/ 除了/ 系统/ 的/ 响应/ 时间/ 外/ ,/ 还有/ 用户/ 的/ 并发/ 访问量/ 以及/ 虚拟机/ 的/ 资源/ 利用率/ ,/ 如/ CPU/ 和/ 内存/ 的/ 占用率/ ./ 对于/ 用户/ 并发/ 访问量/ ,/ 当/ 系统/ 当前/ 的/ 用户/ 并发/ 访问量/ 超过/ 系统/ 所/ 能/ 承受/ 的/ 上限/ 时/ ,/ 则/ 很/ 容易/ 导致系统/ 的/ 响应/ 时间/ 变/ 长/ ,/ 所以/ 需要/ 设定/ 用户/ 并发/ 量/ 相关/ 的/ 自/ 适应/ 目标/ ,/ 以/ 保证/ 在/ 出现/ 并发/ 用户数/ 超过/ 系统/ 当前/ 承载能力/ 的/ 时候/ 可以/ 进行/ 及时/ 的/ 调优/ ./ 对于/ 虚拟机/ 的/ 资源/ 利用率/ ,/ 若/ 虚拟机/ 的/ 资源/ 利用率/ 一段时间/ 内/ 都/ 处于/ 较/ 高/ 的/ 状态/ 时/ ,/ 如/ CPU/ 利用率/ 大于/ 80/ %/ ,/ 则/ 说明/ 部署/ 在/ 虚拟机/ 上/ 的/ 组件/ 服务/ 已经/ 处于/ 较/ 高/ 的/ 负载/ 状态/ ,/ 很/ 有/ 可能/ 会/ 出现/ 或/ 已经/ 出现/ 过载/ 的/ 情况/ ,/ 从而/ 导致/ 服务/ 响应/ 时间/ 违反/ SLA/ 规定/ ,/ 所以/ 也/ 需要/ 设定/ 虚拟机/ 资源/ 利用率/ 的/ 自/ 适应/ 目标/ ,/ 使/ 虚拟机/ 可以/ 保持/ 在/ 适当/ 的/ 负载/ 状态/ ./ 根据上述/ 因素/ ,/ 本文/ 将/ 设定/ 3/ 类自/ 适应/ 目标/ :/ 响应/ 时间/ 类/ 、/ 用户/ 并发/ 量类/ 和/ 虚拟机/ 资源/ 利用率/ 类/ ./ 其中/ ,/ 响应/ 时间/ 类/ 的/ 自/ 适应/ 目标/ 可以/ 根据/ SLA/ 中/ 关于/ 系统/ 响应/ 时间/ 的/ 约束/ 进行/ 设定/ ,/ 以/ 生成/ 系统/ 级/ 的/ 自/ 适应/ 目标/ ./ 以/ 系统/ 的/ 响应/ 时间/ 自/ 适应/ 目标/ 为例/ :/ Goalsys/ _/ resp/ _/ time/ _/ goal/ :/ resp/ _/ timeBetween7s19s/ 用户/ 并发/ 量类/ 的/ 自/ 适应/ 目标/ 可以/ 分为/ 系统/ 级/ 和/ 组件/ 服务/ 级/ 两类/ ,/ 每类/ 的/ 设定/ 方式/ 也/ 与/ 响应/ 时间/ 类/ 的/ 自/ 适应/ 目标/ 类似/ ./ 以/ 系统/ 的/ 用户/ 并发/ 量/ 自/ 适应/ 目标/ 和/ 组件/ 服务/ c1/ 的/ 用户/ 并发/ 量/ 自/ 适应/ 目标/ 为例/ :/ Goalsys/ _/ user/ _/ con/ _/ goal/ :/ user/ _/ conBelow300Goalcomp/ _/ user/ _/ con/ _/ goal1/ :/ c1/ ./ user/ _/ conBelow300/ 对于/ 虚拟机/ 资源/ 利用率/ 的/ 自/ 适应/ 目标/ ,/ 其/ 设定/ 完全/ 是/ 根据/ 专家/ 经验/ ,/ 例如/ 服务器/ 的/ CPU/ 利用率/ 应/ 保持/ 在/ 20/ %/ ~/ 80/ %/ 之间/ ./ 此外/ ,/ 本文/ 中/ 主要/ 考虑/ CPU/ 和/ 内存/ 指标/ ,/ 结合/ 系统/ 部署/ 信息/ ,/ 可以/ 为/ 每/ 一个/ 虚拟机/ 设定/ 相应/ 的/ 自/ 适应/ 目标/ ,/ 即/ 人工/ 设定/ 每/ 类/ 资源/ 利用率/ 的/ 具体/ 范围/ ,/ 所有/ 虚拟机/ 的/ 资源/ 利用率/ 类/ 的/ 自/ 适应/ 目标/ 都/ 以/ 该/ 范围/ 为/ 标准/ 进行/ 设定/ ./ 以/ 虚拟机/ VM1/ 为例/ ,/ 其/ 资源/ 利用率/ 类/ 的/ 自/ 适应/ 目标/ 如下/ :/ Goalvm/ _/ cpu/ _/ usage/ _/ goal1/ :/ vm1/ ./ cpu/ _/ usageBetween20/ %/ 80/ %/ Goalvm/ _/ mem/ _/ usage/ _/ goal1/ :/ vm1/ ./ mem/ _/ usageBetween20/ %/ 80/ %/ 根据上述/ 的/ 自/ 适应/ 目标/ ,/ 按照/ 3.3/ 节/ 所述/ 的/ 自/ 适应/ 触发/ 事件/ 抽取/ 规则/ ,/ 可以/ 生成/ 相应/ 的/ 触发/ 事件/ ./ 以/ 系统/ 响应/ 时间/ 的/ 自/ 适应/ 目标/ 为例/ ,/ 抽取/ 的/ 自/ 适应/ 触发/ 事件/ 如下/ :/ Eventsys/ _/ resp/ _/ time/ _/ goal/ ./ event1/ :/ resp/ _/ time/ </ 7sTargetDEGR/ _/ PERFEventsys/ _/ resp/ _/ time/ _/ goal/ ./ event2/ :/ resp/ _/ time/ >/ 19sTargetIMPR/ _/ PERF/ 当/ 运行/ 阶段/ 所/ 获得/ 监测/ 指标/ 使得/ 多个/ 触发/ 事件/ 被/ 触发/ 时/ ,/ 将/ 按照/ 响应/ 时间/ 类/ 、/ 用户/ 并发/ 量类/ 和/ 虚拟机/ 资源/ 利用率/ 的/ 优先级/ 进行/ 触发/ ./ 若/ 还/ 存在/ 系统/ 级/ 和/ 组件/ 服务/ 级/ 的/ 触发/ 事件/ 同时/ 被/ 触发/ ,/ 则/ 系统/ 级/ 的/ 自/ 适应/ 目标/ 相关/ 的/ 触发/ 事件/ 将/ 优先/ 触发/ ,/ 例如/ :/ 当/ 通过/ 监测/ 发现/ 系统/ 的/ 用户/ 并发/ 量/ 和/ 组件/ 服务/ c1/ 的/ 用户/ 并发/ 量/ 都/ 不/ 符合要求/ 时/ ,/ 则/ 优先/ 触发/ 系统/ 级/ 的/ 触发/ 事件/ (/ resp/ _/ user/ _/ con/ _/ goal/ ./ event/ )/ ,/ 首先/ 保证系统/ 的/ 整体/ 性能/ ./ 此外/ ,/ 为了/ 避免/ 由于/ KPI/ 的/ 瞬时/ 变化/ 所/ 导致/ 的/ 不必要/ 的/ 优化/ ,/ 本文/ 将/ 根据/ 一段时间/ 内/ KPI/ 值/ 的/ 变化/ 情况/ 对/ 触发/ 事件/ 进行/ 触发/ ,/ 例如/ 在/ 30s/ 内/ ,/ 如果/ 有/ 80/ %/ 以上/ 的/ 系统/ 响应/ 时间/ 监测/ 值/ 超过/ 了/ 19s/ ,/ 则/ 触发/ resp/ _/ time/ _/ goal1/ ./ event2/ 事件/ ,/ 开始/ 对系统/ 进行/ 优化/ ./ Page9/ 对于/ Action/ ,/ 以/ 增加/ 和/ 减少/ VM1/ 资源/ 的/ 自/ 适应/ 6.3/ State/ 和/ Action/ 根据/ 3.4/ 节中/ State/ 的/ 形式/ 定义/ 和/ 所/ 设定/ 的/ 虚拟机/ 资源类型/ 以及/ 负载/ 类型/ ,/ 可以/ 生成/ 环境/ 状态/ 的/ 集合/ ./ 假设/ 所有/ 虚拟机/ 的/ 初始/ 资源类型/ 为/ MICRO/ ,/ 负载/ 为/ TYPE/ _/ I/ 时/ ,/ 环境/ 状态/ 为/ States1Resource/ :/ (/ MICRO/ ,/ MICRO/ ,/ MICRO/ ,/ MICRO/ ,/ Load/ :/ TYPE/ _/ I/ 动作/ 为例/ :/ Actiona1Primitive/ :/ addRes/ (/ VM1/ ,/ MICRO/ ,/ SMALL/ )/ Target/ :/ [/ IMPR/ _/ PERF/ ]/ Actiona2Primitive/ :/ reduceRes/ (/ VM1/ ,/ MICRO/ ,/ NANO/ )/ Target/ :/ [/ DEGR/ _/ PERF/ ]/ 其中/ :/ 自/ 适应/ 动作/ a1/ 是/ 将/ VM1/ 的/ 资源/ 从/ MICRO/ 类型/ 增加/ 至/ SMALL/ 类型/ ,/ 由于/ 增加/ 资源/ ,/ 所以/ 可以/ 提升/ 系统/ 的/ 性能/ ,/ 即/ Target/ 为/ IMPR/ _/ PERF/ ;/ 而/ 自/ 适应/ 动作/ a2/ 是/ 将/ VM1/ 的/ 资源/ 从/ MICRO/ 类型/ 减少/ 至/ NANO/ 类型/ ,/ 降低/ 系统/ 的/ 性能/ ,/ Target/ 为/ DEGR/ _/ PERF/ ./ 其它/ State/ 与/ Action/ 与/ 上述/ 例子/ 类似/ ./ 7/ 实验/ 本节/ 将/ 通过/ 实验/ 分析/ 不同/ 参数/ 对/ 本文/ 提出/ 的/ 方法/ 的/ 性能/ 的/ 影响/ ,/ 以及/ 应用/ 于/ 部署/ 在/ 云/ 环境/ 中/ 的/ SBS/ 系统/ 时/ 的/ 有效性/ ,/ 主要/ 包括/ 实验/ 环境/ 配置/ 、/ 实验设计/ 和/ 实验/ 结果/ 与/ 分析/ 三/ 部分/ 内容/ ./ 7.1/ 实验/ 环境/ 配置/ 实验/ 所用/ 的/ 云/ 环境/ 与/ 第/ 6/ 节中/ 的/ 系统/ 部署/ 环境/ 一致/ ,/ 共/ 包括/ 6/ 台/ 物理/ 机/ (/ PhysicalMachine/ ,/ PM/ )/ ,/ 各/ 物理/ 机/ 通过/ 带宽/ 1GB/ // s/ 的/ 局域网/ 相连/ ,/ 其中/ 物理/ 机/ 1/ ~/ 3/ 为/ 硬件/ 配置/ 相同/ 的/ 服务器/ (/ CPU/ :/ IntelXeonE5/ -/ 2620v224/ 核/ ,/ 64GB/ 内存/ ,/ 1000Mbps/ 网卡/ ,/ 1TB/ 磁盘/ )/ ,/ 并/ 在/ 这些/ 服务器/ 上/ 创建/ 大小/ 相同/ 的/ 虚拟机/ (/ 类型/ 为/ MICRO/ )/ ,/ 用于/ 部署/ SBS/ 系统/ 的/ 组件/ 服务/ ./ 物理/ 机/ 4/ 用于/ 分析/ SBS/ 系统/ 的/ 监控/ 数据/ ,/ 并/ 根据/ 系统/ 的/ 运行/ 状态/ 进行/ 自/ 适应/ 决策/ ,/ 生成/ 相应/ 的/ 自/ 适应/ 调整/ 方案/ ./ 物理/ 机/ 5/ 用于/ 存储/ SBS/ 系统/ 的/ 业务/ 数据/ 及/ 运行/ 状态/ 的/ 监控/ 数据/ ./ 物理/ 机/ 6/ 用于/ 监测/ SBS/ 系统/ 的/ 运行/ 状态/ 并/ 产生/ 访问/ 负载/ ./ 具体/ 部署/ 结构/ 如图/ 5/ 所示/ ./ 7.2/ 实验设计/ 本文/ 的/ 实验/ 主要/ 是/ 为了/ 分析/ 不同/ 参数/ 对/ 基于/ Q/ -/ learning/ 的/ 自适应性/ 能/ 优化/ 方法/ 性能/ 的/ 影响/ 以及/ 在/ SBS/ 自适应性/ 能/ 优化/ 中/ 应用/ 的/ 有效性/ ,/ 具体/ 如下/ :/ (/ 1/ )/ 分析/ 不同/ 因素/ 对/ 算法/ 收敛性/ 的/ 影响/ ./ ①/ 分析/ 参数/ 设定/ 对/ 算法/ 收敛性/ 的/ 影响/ ./ 对/ SBS/ 系统/ 施加/ 恒定/ 的/ 压力/ ,/ 对比/ 在/ 不同/ 参数/ (/ α/ ,/ γ/ ,/ τ/ )/ 情况/ 下/ 基于/ Q/ -/ learning/ 方法/ 的/ 回报/ 累积/ 情况/ ,/ 以/ 选出/ 较优/ 的/ 参数/ ;/ ②/ 分析/ 引导/ 对/ 算法/ 收敛性/ 的/ 影响/ ./ 对/ SBS/ 系统/ 施加/ 恒定/ 的/ 压力/ ,/ 对比/ 方法/ 在/ 是否/ 采用/ 引导/ 的/ 情况/ 下/ 的/ 回报/ 累积/ 情况/ ./ 法/ 的/ 有效性/ :/ (/ 2/ )/ 验证/ 基于/ Q/ -/ learning/ 的/ 自适应性/ 能/ 优化/ 方/ ①/ 在/ 不同/ 压力/ 的/ 场景/ 下/ ,/ 检验/ 本文/ 提出/ 的/ 方法/ 能否/ 使/ SBS/ 系统/ 的/ 响应/ 时间/ 恢复/ 到/ SLA/ 的/ 约束/ 范围/ 内/ (/ 7s/ ~/ 19s/ )/ ,/ 并/ 对比/ 同样/ 情况/ 下/ 不/ 使用/ 自/ 适应/ 优化/ 方法/ 时/ SBS/ 系统/ 的/ 响应/ 时间/ 状态/ ;/ ②/ 在/ 不同/ 压力/ 的/ 场景/ 下/ ,/ 对比/ 本文/ 提出/ 的/ 方法/ 和/ 另外/ 两种/ 动态/ 决策/ 方法/ (/ 分别/ 为/ 文献/ [/ 8/ ]/ 中/ 利用/ 应用/ 系统/ 性能/ 模型/ 的/ 方法/ ;/ 文献/ [/ 12/ ]/ 中/ 基于/ 遗传算法/ 的/ 方法/ )/ 作用/ 下/ 的/ 系统/ 响应/ 时间/ 的/ 情况/ 以及/ 使用/ 的/ 资源/ 成本/ co/ ./ 对于/ 实验/ 内容/ 2/ 的/ 压力/ 场景/ ,/ 本文/ 根据/ 数理统计/ [/ 17/ ]/ 中/ 对/ 时间/ 序列/ (/ 用户/ 访问/ 序列/ 可以/ 视为/ 一个/ 时间/ 序列/ )/ 的/ 分类/ 来/ 设计/ 负载/ 场景/ ./ 数理统计/ 中将/ 时间/ 序列/ 分为/ 平稳/ 型/ 和/ 非/ 平稳/ 型/ ,/ 其中/ 非/ 平稳/ 型/ 又/ 可以/ 根据/ 序列/ 变化/ 的/ 趋势/ 分为/ 随机/ 型/ 和/ 具有/ 一定/ 变化规律/ 的/ 类型/ (/ 如/ 具有/ 线性/ 递增/ 特征/ 的/ 类型/ 、/ 具有/ 线性/ 递减/ 特征/ 的/ 类型/ 和/ 具有/ 季节/ 特征/ 的/ 类型/ )/ ./ 对于/ 非/ 平稳/ 随机/ 型/ 场景/ ,/ 本文/ 在/ 0/ ~/ 60min/ 的/ 时间/ 内/ 随机/ 生成/ 100/ ~/ 200/ 区间/ 的/ 任意/ 并发/ 数/ ,/ 且/ 持续/ 很/ 短/ 的/ 时间/ ,/ 具体/ 如图/ 6/ 所示/ ./ 在/ 随机/ 型/ 负载/ 场景/ 中/ ,/ 本文/ 对比/ 了/ 使用/ 本文/ 的/ 方法/ 和/ 不/ 使用/ 时/ SBS/ 系统/ 的/ 响应/ 时间/ 状态/ ,/ 具体/ 如图/ 7/ 所示/ ./ Page10/ 在/ 图/ 7/ 中/ ,/ 上方/ 的/ 虚线/ 为/ 负载/ 随/ 时间/ 变化/ 的/ 情况/ ,/ 下方/ 为/ SBS/ 的/ 响应/ 时间/ 的/ 变化/ 情况/ ,/ 其中/ 标注/ “/ ▲/ ”/ 的/ 位置/ 为/ 该/ 时刻/ 进行/ 了/ 资源/ 调整/ ./ 由于/ 本文/ 提出/ 的/ 自/ 适应/ 方法/ 为了/ 避免/ 由于/ KPI/ 瞬间/ 变化/ 所/ 导致/ 的/ 不必要/ 的/ 优化/ ,/ 所以/ 在/ 随机/ 型/ 场景/ 中/ 很多/ 时刻/ 并未/ 触发/ 自/ 适应/ 优化/ ./ 在/ 不/ 触发/ 自/ 适应/ 优化/ 的/ 情况/ 下/ ,/ 系统/ 的/ 响应/ 时间/ (/ ResponseTime/ ,/ RT/ )/ 会/ 随着/ 负载/ 的/ 随机/ 变化/ 而/ 变化/ ,/ 具体/ 分布/ 情况/ 如表/ 4/ 所示/ ./ 表/ 4/ 随机/ 型/ 场景/ 中/ SBS/ 的/ 响应/ 时间/ 分布/ 情况/ (/ 单位/ :/ %/ )/ 有/ 自/ 适应/ 18.3/ 无自/ 适应/ 26.7/ 如表/ 4/ 所示/ ,/ 在/ 随机/ 型/ 场景/ 中/ ,/ 有无/ 自/ 适应/ 优化/ 的/ 情况/ 下/ ,/ 系统/ 响应/ 时间/ 符合/ SLA/ 要求/ 的/ 比例/ (/ 7/ / RT/ / 19/ )/ 分别/ 为/ 68.3/ %/ 和/ 63.3/ %/ ,/ 满足用户要求/ (/ RT/ / 19/ )/ 的/ 比例/ 分别/ 为/ 81.7/ %/ 和/ 73.3/ %/ ./ 采用/ 自/ 适应/ 优化/ 使/ SBS/ 系统/ 响应/ 时间/ 符合/ SLA/ 约束/ 和/ 用户/ 要求/ 的/ 比例/ 分别/ 提升/ 了/ 5/ %/ 和/ 8.4/ %/ ./ 可见/ ,/ 本文/ 提出/ 的/ 自/ 适应/ 优化/ 方法/ 在/ 随机/ 型/ 负载/ 场景/ 中/ 对/ SBS/ 系统/ 的/ 性能/ 改善/ 不大/ ./ 所以/ ,/ 根据/ 随机/ 型/ 场景/ 的/ 实验/ 结果/ ,/ 本文/ 将/ 重点/ 验证/ 所/ 提出/ 的/ 方法/ 在/ 其它/ 负载/ 场景/ 中/ 的/ 有效性/ ,/ 分别/ 是/ :/ 具有/ 平稳/ 型/ 特征/ 的/ 负载/ 场景/ (/ 简称/ 平稳/ 型/ 场景/ )/ 、/ 具有/ 线性/ 递增/ 非/ 平稳/ 型/ 特征/ 的/ 负载/ 场景/ (/ 简称/ 线性/ 递增/ 型/ 场景/ )/ 、/ 具有/ 线性/ 递减/ 非/ 平稳/ 型/ 特征/ 的/ 负载/ 场景/ (/ 简称/ 线性/ 递减/ 型/ 场景/ )/ 和/ 具有/ 季节性/ 非/ 平稳/ 型/ 特征/ 的/ 负载/ 场景/ (/ 简称/ 季节/ 型/ 场景/ )/ ./ 其中/ ,/ 平稳/ 型/ 场景/ 包括/ 4/ 种/ 负载/ 方式/ ,/ 分别/ 标记/ 为/ 负载/ I/ 、/ 负载/ II/ 、/ 负载/ III/ 和/ 负载/ IV/ ./ 在/ 虚拟机/ 资源/ 为/ 初始/ 分配/ 量/ 的/ 情况/ 下/ ,/ 负载/ I/ 将/ 使得/ SBS/ 系统/ 的/ 响应/ 时间/ 低于/ SLA/ 约束/ 的/ 下限/ 阈值/ ;/ 负载/ II/ 将/ 使得/ SBS/ 系统/ 的/ 响应/ 时间/ 保持/ 在/ SLA/ 的/ 约束/ 范围/ 之内/ ;/ 负载/ III/ 将/ 使得/ SBS/ 系统/ 的/ 响应/ 时间/ 超过/ SLA/ 约束/ 的/ 上限/ 阈值/ ;/ 负载/ IV/ 将/ 使得/ SBS/ 系统/ 的/ 响应/ 时间/ 比/ 在/ 负载/ III/ 情况/ 下/ 更/ 多/ 地/ 超过/ SLA/ 约束/ 的/ 上限/ 阈值/ ./ 具体/ 并发/ 数量/ 见表/ 5/ ./ 负载/ I/ 负载/ II/ 负载/ III/ 负载/ IV100/ 对于/ 平稳/ 型/ 场景/ ,/ 将/ 按照/ II/ →/ III/ →/ IV/ →/ I/ 的/ 顺序/ 对/ SBS/ 系统/ 进行/ 施压/ ,/ 且/ 一段时间/ 内/ 一直/ 持续/ 施加/ 一种/ 负载/ ;/ 线性/ 递增/ 型/ 场景/ 是/ 在/ 0/ ~/ 60min/ 期间/ 内/ ,/ 用户/ 并发/ 量/ 从/ 负载/ I/ 增长/ 到/ 负载/ IV/ ,/ 总体/ 处于/ 线性/ 递增/ 的/ 趋势/ ./ 线性/ 递减/ 型/ 则/ 与/ 之/ 相反/ ,/ 总体/ 处于/ 线性/ 递减/ 的/ 趋势/ ;/ 季节/ 型/ 场景/ 是/ 用户/ 并发/ 量/ 具有/ 季节/ 波动性/ ,/ 一个/ 周期/ 为/ 30min/ ./ 在/ 一个/ 周期/ 内/ ,/ 两种/ 类型/ 的/ 用户/ 并发/ 量/ 的/ 最小值/ 为/ 负载/ I/ ,/ 最大值/ 为/ 负载/ IV/ ,/ 具体/ 如图/ 8/ 所示/ ./ 对于/ 使用/ 的/ 资源/ 成本/ co/ ,/ 具体/ 如式/ (/ 8/ )/ 所示/ ./ 其中/ :/ RV/ α/ 用/ 的/ 资源量/ ;/ Ur/ 表示/ 每种/ 资源/ 的/ 单位/ 价格/ ;/ T/ 为/ 使用/ 该/ 虚拟机/ 资源/ 的/ 时间/ ./ 7.3/ 实验/ 结果/ 与/ 分析/ 7.3/ ./ 1/ 收敛性/ 分析/ 算法/ 的/ 收敛性/ 对于/ 是否/ 能够/ 在/ 合理/ 时间/ 内/ 找到/ 近似/ 最优/ 解/ 至关重要/ ,/ 直接/ 影响/ 算法/ 的/ 可用性/ ./ 本组/ 实验/ 考察/ 了/ 影响/ Q/ -/ learning/ 算法/ 收敛/ 速度/ 的/ 主要参数/ (/ 学习/ 步长/ 参数/ α/ 、/ 折扣/ 因子/ γ/ 和/ 选择/ 参数/ τ/ )/ 在/ 取/ 不同/ 值时/ 以及/ 是否/ 对/ 算法/ 进行/ 引导/ 时/ ,/ 算法/ 的/ 回报/ 累积/ 情况/ ./ Page11/ 图/ 84/ 种/ 负载/ 场景/ (/ 1/ )/ 参数/ 设定/ 对/ 算法/ 收敛性/ 的/ 影响/ 本/ 实验/ 对于/ 参数/ 的/ 设定/ 将/ 分为/ 6/ 种/ 情况/ ,/ 具体/ 如表/ 6/ 所示/ ./ 设定/ I0/ ./ 3/ 设定/ II0/ ./ 3/ 设定/ III0/ ./ 3/ 设定/ IV0/ ./ 5/ 设定/ V0/ ./ 5/ 设定/ VI0/ ./ 5/ 在/ 实验/ 中/ ,/ 将/ 对/ SBS/ 系统/ 施加/ 恒定/ 的/ 压力/ (/ 用户/ 并发/ 量/ 为/ 200/ )/ ,/ SBS/ 系统/ 的/ 响应/ 时间/ 将会/ 超过/ SLA/ 的/ 约束/ ,/ 使得/ 自/ 适应/ 优化/ 被/ 触发/ ,/ 在/ 迭代/ 30/ 次后/ 累积/ 回报/ 值/ 的/ 具体情况/ 如图/ 9/ 所示/ ./ 从图/ 9/ 中/ 可以/ 看出/ ,/ 参数/ 设定/ 为/ (/ 0.3/ ,/ 0.7/ ,/ 0.8/ )/ 时/ 算法/ 的/ 回报/ 值/ 累积/ 曲线/ 在/ 其它/ 参数/ 设定/ 曲线/ 的/ 上方/ ,/ 则/ 认为/ 该/ 参数/ 设定/ 使得/ 算法/ 具有/ 较/ 好/ 的/ 收敛性/ ,/ 所以/ 本文/ 将/ 采用/ 设定/ I/ ./ (/ 2/ )/ 引导/ 对/ 算法/ 收敛性/ 的/ 影响/ 本/ 实验/ 主要/ 是/ 在/ 恒定/ 负载/ 的/ 情况/ 下/ ,/ 所有/ 虚拟机/ 的/ 初始/ 资源类型/ 为/ SMALL/ 时/ ,/ 对比/ 有无/ 引导/ 时/ 基于/ Q/ -/ learning/ 决策/ 算法/ 的/ 回报/ 累积/ 情况/ ./ 其中/ ,/ 无/ 引导/ 是/ 指/ 在/ 选择/ Action/ 时/ ,/ 从/ 当前/ State/ 对应/ 的/ 所有/ action/ 中/ 进行/ 选择/ ;/ 有/ 引导/ 是/ 指/ 在/ 选择/ Action/ 时/ ,/ 从/ 与/ 被/ 触发/ Event/ 有/ 相同/ Target/ 的/ Action/ 集合/ 中/ 进行/ 选择/ ./ 在/ 迭代/ 30/ 次后/ 回报/ 的/ 具体情况/ 如图/ 10/ 所示/ ./ 从图/ 10/ 中/ 可以/ 看出/ ,/ 有/ 引导/ 时/ 的/ 算法/ 的/ 回报/ 值/ 累积/ 曲线/ 在/ 没有/ 引导/ 的/ 回报/ 值/ 累积/ 曲线/ 上方/ ,/ 则/ 说明/ 有/ 引导/ 时/ 算法/ 具有/ 更好/ 的/ 收敛性/ ./ Page127/ ./ 3.2/ 有效性/ 验证/ 为了/ 验证/ 本文/ 提出/ 的/ 自/ 适应/ 优化/ 方法/ 的/ 有效性/ ,/ 本文/ 将/ 对比/ 4/ 种/ 压力/ 场景/ 中/ ,/ 有/ 自/ 适应/ 优化/ 和/ 无自/ 适应/ 优化/ 情况/ 下/ SBS/ 系统/ 的/ 响应/ 时间/ RT/ ,/ 以及/ 对比/ 本文/ 提出/ 的/ 方法/ 和/ 另外/ 两种/ 动态/ 决策/ 方法/ 作用/ 下/ 的/ 系统/ 响应/ 时间/ 的/ 情况/ 以及/ 使用/ 的/ 资源/ 成本/ ,/ 具体/ 如下/ :/ (/ 1/ )/ 有无/ 自/ 适应/ 情况/ 对比/ 在/ 4/ 种/ 压力/ 场景/ 中/ ,/ SBS/ 系统/ 在/ 有/ 自/ 适应/ 优化/ 和/ 无自/ 适应/ 优化/ 情况/ 下/ 的/ 系统/ 响应/ 时间/ 情况/ 如图/ 11/ 有无/ 自/ 适应/ 时/ SBS/ 的/ 响应/ 时间/ 对比/ 图/ 11/ 所示/ ./ 与/ 图/ 7/ 类似/ ,/ 在/ 图/ 11/ (/ a/ )/ ~/ (/ d/ )/ 中/ ,/ 上方/ 的/ 虚线/ 为/ 负载/ 随/ 时间/ 变化/ 的/ 情况/ ,/ 下方/ 为/ SBS/ 的/ 响应/ 时间/ 的/ 变化/ 情况/ ,/ 其中/ 标注/ “/ ▲/ ”/ 的/ 位置/ 为/ 该/ 时刻/ 进行/ 了/ 资源/ 调整/ ./ 从图/ 11/ (/ a/ )/ 中/ 可以/ 看出/ ,/ 在/ 平稳/ 型/ 的/ 负载/ 场景/ 下/ ,/ 当/ SBS/ 系统/ 的/ 并发/ 访问量/ 从/ 负载/ II/ 增加/ 到/ 负载/ III/ 后/ ,/ 系统/ 的/ 响应/ 时间/ 也/ 随之/ 增加/ ,/ 并/ 超过/ 了/ SLA/ 约束/ 的/ 上限/ 阈值/ ./ 在/ 对/ SBS/ 系统/ 进行/ 优化/ 后/ ,/ 其/ 响应/ 时间/ 在/ 第/ 14min/ 时/ 恢复/ 到/ SLA/ 的/ 约束/ 范围/ 内/ ./ 当/ SBS/ 系统/ 的/ 并发/ 访问量/ 从/ 负载/ III/ 增加/ 到/ 负载/ IV/ 时/ ,/ 以及/ 并发/ 访问量/ 从/ 负载/ IV/ 减少/ 到/ 负载/ I/ 后/ ,/ 对系统/ 进行/ 自/ 适应/ 优化/ 后均/ 可以/ 使/ 系统/ 的/ 响应/ 时间/ 恢复/ 到/ SLA/ 的/ 约束/ 范围/ 内/ ./ 而/ 未/ 进行/ 自/ 适应/ 优化/ 时/ ,/ 在/ 施加/ 负载/ III/ 、/ 负载/ IV/ 和/ 负载/ I/ 期间/ ,/ 系统/ 响应/ 时间/ 一直/ 处于/ 高于/ 上限/ 阈值/ 和/ 低于/ 下限/ 阈值/ 的/ 状态/ ./ 与/ 在/ 平稳/ 型/ 场景/ 中/ 的/ 情况/ 类似/ ,/ SBS/ 系统/ 的/ 响应/ 时间/ 在/ 其它/ 3/ 种/ 场景/ 中/ 的/ 情况/ 如图/ 11/ (/ b/ )/ 、/ (/ c/ )/ 和/ (/ d/ )/ 所示/ ,/ 当有/ 自/ 适应/ 优化/ 发挥作用/ 时/ ,/ SBS/ 系统/ 的/ 响应/ 时间/ 会/ 很快/ 地/ 恢复/ 到/ SLA/ 的/ 约束/ 范围/ 内/ ,/ 而/ 没有/ 自/ 适应/ 优化/ 时/ ,/ SBS/ 系统/ 的/ 响应/ 时间/ 会长/ 时间/ 地/ 处于/ SLA/ 违例/ 状态/ ./ 每种/ 场景/ 中/ 响应/ 时间/ 的/ 具体/ 分/ Page13/ 布/ 情况/ 如表/ 7/ 所示/ ./ 如表/ 7/ 所示/ ,/ 在/ 不同/ 的/ 负载/ 场景/ 中/ ,/ 采用/ 自/ 适应/ 优化/ 时/ ,/ SBS/ 系统/ 响应/ 时间/ 符合/ SLA/ 约束/ (/ 7/ / RT/ / 19/ )/ 的/ 比例/ 分别/ 提升/ 了/ 75/ %/ 、/ 38.3/ %/ 、/ 40/ %/ 和/ 15/ %/ ,/ 符合/ SBS/ 系统/ 使用/ 用户/ 要求/ (/ RT/ / 19/ )/ 的/ 比例/ 分别/ 提升/ 了/ 43.4/ %/ 、/ 35/ %/ 、/ 38.4/ 和/ 10/ %/ ./ 可见/ ,/ 本文/ 提出/ 的/ 方法/ 是/ 有效/ 的/ ./ 表/ 7/ 有无/ 自/ 适应/ 时/ SBS/ 响应/ 时间/ 分布/ 情况/ (/ 单位/ :/ %/ )/ 平稳/ 型/ 有/ 自/ 适应/ 3.395/ ./ 01.7/ 线性/ 递增/ 型/ 有/ 自/ 适应/ 8.390/ ./ 01.7/ 线性/ 递减/ 型/ 有/ 自/ 适应/ 3.393/ ./ 33.4/ 季节/ 型/ 有/ 自/ 适应/ 5.088/ ./ 36.7/ (/ 2/ )/ 不同/ 决策/ 方法/ 对比/ 在/ 本/ 小节/ 实验/ 中/ ,/ 将/ 在/ 不同/ 的/ 压力/ 场景/ 下/ ,/ 对比/ 本文/ 提出/ 的/ 方法/ 和/ 另外/ 两种/ 动态/ 决策/ 方法/ (/ 分别/ 为/ 图/ 12/ 不同/ 方法/ 作用/ 下/ SBS/ 的/ 响应/ 时间/ 对比/ 文献/ [/ 8/ ]/ 中/ 利用/ 应用/ 系统/ 性能/ 模型/ 的/ 方法/ ,/ 简称/ PEM/ ;/ 文献/ [/ 12/ ]/ 中/ 基于/ 遗传算法/ 的/ 方法/ ,/ 简称/ GA/ )/ 作用/ 下/ 的/ 系统/ 响应/ 时间/ 的/ 情况/ 以及/ 使用/ 的/ 资源/ 成本/ co/ ,/ 具体/ 见图/ 12/ 、/ 表/ 8/ 和表/ 9/ ./ 表/ 8/ 不同/ 方法/ 作用/ 下/ SBS/ 响应/ 时间/ 分布/ 情况/ (/ 单位/ :/ %/ )/ 平稳/ 型/ 线性/ 递增/ 型/ 线性/ 递减/ 型/ 季节/ 型/ 从/ 图/ 12/ 可以/ 看出/ ,/ 在/ 4/ 种/ 不同/ 的/ 压力/ 场景/ 中/ ,/ 本文/ 提出/ 方法/ 和/ 其它/ 两种/ 方法/ 均/ 可以/ 使/ SBS/ 系统/ 的/ 响应/ 时间/ 满足/ SLA/ 的/ 约束/ ./ 其中/ ,/ 本文/ 提出/ 的/ 方/ Page14/ 法/ 和/ 基于/ PEM/ 的/ 方法/ 都/ 可以/ 很快/ 地使/ 系统/ 响应/ 时间/ 恢复/ 到/ SLA/ 的/ 约束/ 范围/ 内/ ,/ 如表/ 8/ 所示/ ,/ 两种/ 方法/ 使得/ SBS/ 系统/ 响应/ 时间/ 符合/ SLA/ 约束/ 和/ SBS/ 系统/ 使用/ 用户/ 要求/ 的/ 比例/ 相差/ 不大/ ./ 但/ 基于/ PEM/ 的/ 方法/ 由于/ 离线/ 建立/ 的/ 性能/ 模型/ 不能/ 很/ 好/ 地/ 适应环境/ 的/ 动态变化/ ,/ 每次/ 调整/ 后/ 系统/ 的/ 响应/ 时间/ 变化/ 幅度/ 都/ 较大/ ,/ 而/ 这/ 也/ 代表/ 着/ 使用/ 了/ 更/ 多/ 的/ 资源/ ./ 如表/ 9/ 所示/ ,/ 在/ 4/ 种/ 场景/ 中/ ,/ 基于/ PEM/ 的/ 方法/ 的/ 资源/ 成本/ co/ 比/ 本文/ 方法/ 分别/ 高出/ 57.74/ %/ 、/ 55.22/ %/ 、/ 69.64/ %/ 和/ 83.35/ %/ ./ 可以/ 看出/ ,/ 本文/ 提出/ 的/ 方法/ 对比/ 基于/ PEM/ 的/ 方法/ 在/ 决策/ 效率/ 方面/ 相差/ 不/ 大/ ,/ 但/ 使用/ 的/ 资源/ 成本/ 更/ 低/ ./ 平稳/ 型/ 359756743368/ 线性/ 递增/ 型/ 261740622482/ 线性/ 递减/ 型/ 454677124340/ 季节/ 型/ 294959072781/ 综上/ ,/ 本文/ 提出/ 的/ 方法/ 在/ 4/ 种/ 典型/ 负载/ 场景/ 中均/ 可以/ 达到/ 优化/ 系统/ 响应/ 时间/ 的/ 目的/ ,/ 且/ 在/ 拥有/ 较/ 高/ 决策/ 效率/ 的/ 同时/ ,/ 可以/ 保证/ 云/ 应用/ 占用/ 较少/ 的/ 资源/ 即/ 可以/ 满足/ 性能需求/ ./ 综合/ 考虑/ 效率/ 和/ 资源/ 成本/ 时/ ,/ 本文/ 提出/ 的/ 方法/ 优于/ 其它/ 两种/ 方法/ ./ 8/ 相关/ 研究/ 自/ 适应/ 决策/ 是/ 自/ 适应/ 过程/ 中/ 的/ 关键步骤/ ,/ 可以/ 通过/ 多种/ 方式/ 实现/ ,/ 一种/ 方式/ 是/ 依据/ 预先/ 设定/ 的/ 自/ 适应/ 策略/ 进行/ 决策/ ,/ 还/ 可以/ 利用/ 人工智能/ 、/ 控制论/ 等/ 技术/ 进行/ 决策/ ./ (/ 1/ )/ 基于/ 策略/ 的/ 自/ 适应/ 决策/ 方面/ 自/ 适应/ 策略/ 的/ 描述/ 通常/ 采用/ ECA/ (/ Event/ -/ Condition/ -/ Action/ )/ 的/ 形式/ [/ 18/ ]/ ,/ 或者/ 采用/ 更为/ 简单/ 的/ if/ -/ else/ 形式/ ,/ 连同/ 系统/ 的/ 因果/ 网络/ 一起/ 构建/ 基于/ 模型/ 的/ 推理/ 机制/ [/ 19/ ]/ ./ 此外/ ,/ IBM/ 还/ 提出/ 了/ ACPL/ (/ AutomaticComputingPolicyLanguage/ )/ 语言/ ,/ 用来/ 描述/ 自主/ 计算/ 中/ 的/ 策略/ [/ 20/ ]/ ./ 在/ 此基础/ 上/ ,/ 文献/ [/ 6/ ]/ 的/ 自/ 适应/ 决策/ 机制/ 包括/ 离线/ 和/ 在线/ 两个/ 阶段/ ,/ 在/ 离线/ 阶段/ 生成/ 一组/ ECA/ 形式/ 的/ 自/ 适应/ 规则/ ,/ 在线/ 阶段/ 时/ 根据/ 当前/ 的/ 系统/ 状态/ 和/ 策略/ 中/ 所/ 定义/ 的/ 目标/ 对/ 自/ 适应/ 规则/ 集合/ 进行/ 匹配/ 的/ 方式/ 生成/ 自/ 适应/ 调整/ 方案/ ./ 文献/ [/ 9/ ]/ 提出/ 了/ 一种/ SBS/ 运行/ 时自/ 适应/ 框架/ MOSES/ (/ MOdel/ -/ basedSElf/ -/ adaptationofSOASystems/ )/ ,/ 利用/ 为/ 每个/ 抽象/ 服务/ 建立/ 的/ 最优/ 自/ 适应/ 策略/ 模型/ 选取/ 动作/ 模式/ ,/ 从而/ 达到最佳/ 性能/ ./ 文献/ [/ 10/ ]/ 提出/ 了/ 一种/ 可/ 执行/ 的/ 建模语言/ EUREMA/ (/ ExecUtableRuntimEMegAmodels/ )/ ,/ 可以/ 按照/ 模型/ 驱动/ 的/ 工程/ 方法/ 来/ 简化/ 自/ 适应/ 工程/ 的/ 开发/ ./ 文献/ [/ 11/ ]/ 给出/ 了/ 一组/ 特定/ 的/ MAPE/ -/ K/ 模板/ (/ Monitor/ -/ Analyze/ -/ Plan/ -/ ExecuteplusKnowledge/ )/ ,/ 这些/ 模板/ 包括/ 特定/ 行为/ 模板/ 和/ 特定/ 属性/ 模板/ ,/ 前者/ 用来/ 对/ MAPE/ -/ K/ 循环/ 回路/ 中/ 的/ 不同/ 的/ 组件/ 进行/ 建模/ ,/ 后者/ 用来/ 验证/ 自/ 适应/ 行为/ 的/ 正确性/ ,/ 并/ 利用/ 这些/ 模板/ 构建/ 了/ 一个/ 自/ 适应/ 系统/ ./ 文献/ [/ 8/ ]/ 则/ 通过/ 建立/ 应用/ 系统/ 的/ 负载/ 、/ 资源/ 和/ 性能/ 之间/ 的/ 关系/ 模型/ ,/ 来/ 制定/ 应用/ 系统/ 的/ 优化/ 策略/ ./ 但是/ 这/ 类/ 方法/ 大多/ 需要/ 对系统/ 或者/ 环境/ 进行/ 建模/ ,/ 而/ 在/ 离线/ 阶段/ 建立/ 的/ 模型/ 不能/ 很/ 好/ 地/ 适应/ 发生变化/ 后/ 的/ 环境/ 或/ 应用/ 系统/ ./ (/ 2/ )/ 结合/ 人工智能/ 技术/ 进行/ 自/ 适应/ 决策/ 方面/ 智能/ 优化/ 算法/ 在/ 自/ 适应/ 决策/ 中/ 得到/ 了/ 较/ 多/ 的/ 应用/ ,/ 例如/ 文献/ [/ 13/ ]/ 在/ 决策/ 时/ 考虑/ 了/ 工作/ 流/ 使用/ 资源/ 的/ 成本/ 和/ 所/ 花费/ 时间/ 之间/ 的/ 平衡/ ,/ 采用/ 基于/ 启发式/ 的/ 多/ 完整/ 关键/ 路径/ 方法/ 进行/ 求解/ ;/ 文献/ [/ 14/ ]/ 通过/ 提出/ 的/ 声明/ 式/ 服务/ 编排/ 语言/ DSOL/ (/ DeclarativeServiceOrchestrationLanguage/ )/ 将/ 自/ 适应/ 调整/ 方案/ 的/ 生成/ 问题/ 表示/ 为/ 自动/ 规划/ 问题/ ,/ 采用/ 智能/ 规划/ 技术/ 进行/ 求解/ ;/ 文献/ [/ 12/ ]/ 在/ 自/ 适应/ 决策/ 过程/ 中/ 同时/ 考虑/ 了/ 违反/ SLA/ 约束/ 的/ 代价/ 及/ 执行/ 自/ 适应/ 调整/ 动作/ 的/ 代价/ ,/ 将/ 自/ 适应/ 调整/ 方案/ 的/ 生成/ 问题/ 建模/ 为单/ 目标/ 优化/ 问题/ ,/ 通过/ 智能算法/ 对/ 该/ 问题/ 进行/ 求解/ ./ 文献/ [/ 15/ ]/ 提出/ 了/ 一种/ 基于/ 服务/ 选取/ 的/ SBS/ 资源分配/ 模型/ ,/ 并/ 采用/ 支持/ 向量/ 回归/ (/ SupportVectorRegression/ ,/ SVR/ )/ 构建/ 组件/ 服务/ 的/ 性能/ 模型/ ,/ 并/ 以/ 性能/ 模型/ 为/ 基础/ 进行/ 分配/ 方案/ 的/ 求解/ ./ 但/ 利用/ 智能/ 优化/ 算法/ 求解/ 通常/ 都/ 会/ 存在/ 计算/ 效率/ 问题/ ,/ 需要/ 进行/ 相应/ 的/ 优化/ ./ 还有/ 学者/ 利用/ 规划/ 、/ 模糊推理/ 和/ 基于/ 用例/ 的/ 推理/ (/ Case/ -/ BasedReasoning/ ,/ CBR/ )/ 方法/ 来/ 进行/ 自/ 适应/ 决策/ ,/ 例如/ 文献/ [/ 21/ ]/ 将/ 特征/ 模型/ 和/ 在线/ 机器/ 学习/ 结合/ 起来/ ,/ 即将/ 领域专家/ 的/ 知识/ 体现/ 在/ 特征/ 模型/ 中/ ,/ 然后/ 通过/ 在线/ 学习/ 来/ 改进/ 自/ 适应/ 决策/ 的/ 准确性/ 和/ 效率/ ;/ 文献/ [/ 22/ ]/ 构建/ 了/ 一种/ 自/ 调整/ 的/ 模糊/ 控制器/ (/ Self/ -/ TuningFuzzyController/ ,/ STFC/ )/ 方法/ ,/ STFC/ 利用/ 模糊/ 规则/ 推理/ 得到/ 资源/ 的/ 调整/ 量/ ;/ 文献/ [/ 23/ ]/ 通过/ 计算/ 监测/ 到/ 的/ 系统/ 状态/ 和/ 用/ 例库/ 中用例/ 的/ 相似/ 度/ ,/ 找到/ 最/ 相似/ 的/ 用例/ ,/ 并/ 执行/ 用例/ 中/ 的/ 自/ 适应/ 动作/ 来/ 对系统/ 进行/ 优化/ ,/ 然后/ 将/ 优化/ 的/ 结果/ 更新/ 至用/ 例库/ 中/ ./ 而/ 这类/ 方法/ 优化/ 效果/ 的/ 好坏/ 很大/ 程度/ 取决于/ 人工/ 设定/ 知识/ (/ 如/ 规则/ 、/ 用/ 例库/ 等/ )/ 的/ 质量/ ./ Page15/ 与/ 本文/ 的/ 方法/ 类似/ 的/ 还有/ 文献/ [/ 24/ -/ 26/ ]/ ,/ 这些/ 方法/ 都/ 采用/ 了/ 基于/ 强化/ 学习/ 的/ 方法/ 来/ 调整/ 系统/ 的/ 资源/ ,/ 达到/ 保障/ 应用/ 系统/ 性能/ 的/ 目的/ ./ 其中/ ,/ 文献/ [/ 24/ ]/ 所/ 调整/ 的/ 资源/ 是/ 以/ 虚拟机/ 为/ 粒度/ ,/ 即/ 增加/ 、/ 减少/ 虚拟机/ 的/ 个数/ ,/ 而/ 文献/ [/ 25/ -/ 26/ ]/ 是/ 通过/ 调整/ 单个/ 虚拟机/ 的/ 资源/ 来/ 增加/ 其/ 处理/ 能力/ ./ 但是/ 这些/ 方法/ 都/ 是/ 将/ 优化/ 的/ 对象/ 视为/ 一个/ 整体/ ,/ 当/ 这些/ 方法/ 应用/ 于/ 由/ 多个/ 组件/ 服务/ 组成/ 的/ SBS/ 时/ ,/ 由于/ 环境/ 状态/ 和/ 自/ 适应/ 动作/ 的/ 增加/ ,/ 可能/ 会/ 出现/ 决策/ 效率/ 较/ 低/ 的/ 情况/ ./ 而/ 本文/ 通过/ 环境/ 状态/ 和/ 引导/ 算子/ 对/ 自/ 适应/ 动作/ 集合/ 进行/ 筛选/ ,/ 有效/ 地/ 缩小/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ ,/ 保证/ 自/ 适应/ 决策/ 的/ 高效性/ ./ 在/ 针对/ SBS/ 的/ 自/ 适应/ 资源分配/ 方面/ ,/ 文献/ [/ 27/ ]/ 采用/ 了/ 基于/ 反馈/ 控制/ 的/ 方法/ ,/ 并/ 利用/ 径向/ 基/ 函数/ (/ RadialBasisFunction/ ,/ RBF/ )/ 神经网络/ 在/ 应用/ 系统/ 运行/ 时自/ 适应/ 的/ 调整/ 控制参数/ ;/ 文献/ [/ 28/ ]/ 首先/ 建立/ 每个/ 组件/ 服务/ 的/ RAT/ (/ Resource/ -/ Allocation/ -/ Throughput/ )/ 模型/ ,/ 并/ 将/ 模型/ 扩展/ 至/ 整个/ SBS/ ,/ 从而/ 分析/ SBS/ 所/ 承受/ 的/ 负载/ 和/ 分配/ 的/ 资源/ 之间/ 的/ 关系/ ,/ 然后/ 将/ 资源分配/ 问题/ 转化/ 为/ 线性规划/ 的/ 优化/ 问题/ 并/ 进行/ 求解/ ./ 但/ 在/ 这/ 两个/ 方法/ 中/ ,/ 都/ 需要/ 在/ 离线/ 阶段/ 建立/ 与/ SBS/ 相关/ 的/ 模型/ ,/ 当/ SBS/ 的/ 组件/ 服务/ 发生/ 动态变化/ 时/ ,/ 离线/ 模型/ 可能/ 需要/ 重新/ 训练/ ,/ 而/ 采用/ Q/ -/ learning/ 这种/ 无/ 模型/ 的/ 方法/ 则/ 可以/ 避免/ 此类/ 问题/ ./ 所以/ ,/ 针对/ 现有/ 的/ 方法/ 中/ 存在/ 的/ 一些/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 基于/ 强化/ 学习/ 的/ 云/ 应用/ 自/ 适应/ 方法/ ,/ 而/ 强化/ 学习/ 可以/ 较/ 好/ 的/ 满足/ 自/ 适应/ 决策/ 过程/ 对于/ 动态性/ 、/ 高效性/ 等/ 方面/ 的/ 要求/ [/ 29/ ]/ ./ 本文/ 采用/ 了/ Q/ -/ learning/ 算法/ ,/ 该/ 算法/ 是/ 一种/ 无/ 模型/ (/ model/ -/ free/ )/ 的/ 在线/ 学习/ 算法/ ,/ 在/ 自/ 适应/ 的/ 过程/ 中/ 不/ 需要/ 建立/ 应用/ 系统/ 的/ 性能/ 模型/ ,/ 可以/ 更好/ 地/ 应对/ 自/ 适应/ 过程/ 中/ 的/ 动态变化/ ./ 此外/ ,/ 本文/ 还/ 提出/ 了/ 一种/ 引导/ 算子/ ,/ 可以/ 有效/ 地/ 缩小/ 候选/ 自/ 适应/ 动作/ 的/ 范围/ ,/ 从而/ 保障/ 算法/ 的/ 学习/ 效率/ ./ 9/ 结论/ 本文/ 提出/ 了/ 一种/ 基于/ 强化/ 学习/ 的/ SBS/ 云/ 应用/ 自/ 适应/ 优化/ 方法/ ,/ 建立/ 了/ 自/ 适应/ 基本要素/ 之间/ 相互/ 关系/ 的/ 特征描述/ 框架/ ,/ 并/ 详细描述/ 了/ 如何/ 在/ 决策/ 的/ 过程/ 中/ 使用/ 经验/ 和/ 如何/ 累积/ 自/ 适应/ 调整/ 之后/ 的/ 经验/ ./ 通过/ 实验/ 表明/ ,/ 本文/ 提出/ 的/ 方法/ 是/ 有效/ 的/ ,/ 并/ 具有/ 以下/ 优点/ :/ (/ 1/ )/ 采用/ 了/ 事件/ 触发/ 机制/ ,/ 可以/ 避免/ 云/ 应用/ 系统/ 的/ 性能/ 符合/ SLA/ 要求/ 后/ 进行/ “/ 无效/ ”/ 的/ 调整/ ;/ (/ 2/ )/ 采用/ 了/ 无/ 模型/ 的/ 在线/ 学习/ 算法/ (/ Q/ -/ learning/ 算法/ )/ ,/ 可以/ 更好/ 地/ 应对/ 自/ 适应/ 过程/ 中/ 的/ 动态变化/ ;/ (/ 3/ )/ 提出/ 了/ 一种/ 引导/ 算子/ ,/ 利用/ 被/ 触发/ 的/ Event/ 对/ 所有/ 可/ 执行/ 的/ Action/ 进行/ 筛选/ ,/ 限定/ 其/ 在/ 特定/ 范围/ 的/ Action/ 集合/ 中/ 进行/ 选择/ ,/ 从而/ 提升/ 学习/ 算法/ 的/ 效率/ ./ 

