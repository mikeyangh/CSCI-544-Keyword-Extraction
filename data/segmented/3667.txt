Page1/ 云/ 环境/ 下/ 一种/ 隐私/ 保护/ 的/ 高效/ 密文/ 排序/ 查询方法/ 程芳权/ 彭智勇/ 宋伟王/ 书林/ 崔一辉/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430072/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 摘要/ 数据/ 前端/ 加密/ 是/ 保护/ 云/ 环境/ 下外/ 包/ 数据/ 隐私/ 的/ 一种/ 有效/ 手段/ ,/ 但/ 却/ 给/ 数据/ 查询/ 等/ 操作/ 带来/ 挑战/ ./ 针对/ 云/ 环境/ 下多/ 数据/ 拥有者/ 数据/ 外/ 包及/ 选择性/ 访问/ 授权/ 特征/ ,/ 为/ 支持/ 大规模/ 加/ 密云/ 数据/ 上/ 高效/ 且/ 隐私/ 保护/ 的/ 用户/ 个性化/ 密文/ 查询/ ,/ 文中/ 提出/ 了/ 一种/ 隐私/ 保护/ 的/ 高效/ 密文/ 排序/ 查询方法/ RQED/ ./ 通过/ 设计/ 无/ 证书/ 认证/ 的/ PKES/ (/ 支持/ 关键词/ 检索/ 的/ 公钥/ 加密/ )/ ,/ 并/ 构建/ RQED/ 框架/ 来/ 实现/ 强/ 隐私/ 保护/ 的/ 密文/ 查询/ ./ 基于/ 该/ 框架/ ,/ 设计/ 了/ 更/ 合理/ 的/ 多/ 属性/ 多/ 关键词/ 密文/ 查询/ 排序/ 函数/ ,/ 并/ 提出/ 了/ 基于/ 层次/ 动态/ 布隆/ 过滤器/ 的/ RQED/ 索引/ 机制/ ,/ 提高/ 密文/ 查询/ 时空/ 效率/ ./ 理论/ 分析/ 和/ 实验/ 性能/ 对比/ 证明/ :/ RQED/ 在/ 确保/ 查询/ 强/ 隐私/ 保护/ 和/ 高/ 准确性/ 的/ 同时/ ,/ 具有/ 较/ 明显/ 的/ 时空/ 效率/ 优势/ ./ 关键词/ 云/ 计算/ ;/ 布隆/ 过滤器/ ;/ 排序/ 查询/ ;/ 层次/ 索引/ ;/ 无/ 证书/ 认证/ 1/ 引言/ 云/ 计算/ 是/ 一种/ 新型/ 网络/ 计算/ 模式/ 并/ 被/ 喻为/ 信息/ 领域/ 的/ 工业化/ 革命/ [/ 1/ ]/ ./ 云/ 环境/ 下/ ,/ 以/ “/ X/ -/ as/ -/ a/ -/ Serv/ -/ ice/ ”/ 和/ “/ Pay/ -/ as/ -/ you/ -/ go/ ”/ 为/ 核心理念/ ,/ 驱动/ 企业/ 或/ 用户/ 将/ 本地/ 数据/ 及其/ 复杂/ 管理/ 外包/ 给/ 云/ 服务提供商/ [/ 2/ -/ 3/ ]/ (/ CloudServiceProvider/ ,/ CSP/ )/ ,/ 从而/ 利用/ “/ 云/ ”/ 充足/ 的/ 计算/ 、/ 存储/ 和/ 网络/ 等/ 资源/ ,/ 使/ 用户/ 只/ 需较/ 小/ 的/ 代价/ 就/ 能/ 快速/ 获得/ 高质量/ 的/ 数据服务/ 及/ 应用/ ./ 但/ 数据安全/ 和/ 隐私/ 保护/ 在/ 云/ 计算/ 问题/ 中/ 首当其冲/ ./ 外/ 包于/ 云端/ 的/ 隐私/ 数据/ 完全/ 脱离/ 其/ 拥有者/ 的/ 直接/ 物理/ 控制/ ,/ 将/ 面临/ 外部/ 网络/ 攻击者/ 和/ CSP/ 中/ 不可/ 信/ (/ 诚实/ 而/ 好奇/ [/ 4/ ]/ )/ 管理员/ 的/ 双重/ 威胁/ ./ 采用/ 前端/ 加密/ 是/ 解决/ 上述/ 安全/ 问题/ 的/ 一种/ 有效/ 方法/ [/ 2/ -/ 4/ ]/ ,/ 即/ 数据/ 拥有者/ 在/ 本地/ 可信/ 前端/ 对/ 数据/ 加密/ 后/ 再/ 外包/ 给/ CSP/ ,/ 查询/ 时则/ 从/ CSP/ 获取/ 满足/ 请求/ 的/ 密文/ 数据/ 并/ 在/ 前端/ 解密/ ./ 如此一来/ ,/ 密文/ 数据/ 查询/ 则/ 不再/ 具有/ 明文/ 查询/ 特性/ 而/ 成为/ 重要/ 挑战/ ,/ 且/ 云/ 环境/ 下/ 密文/ 查询/ 有/ 以下/ 两/ 方面/ 需求/ :/ 一方面/ ,/ 面向/ 云端/ 海量/ 数据/ 特征/ 和/ 用户/ 个性化/ 查询/ 需求/ ,/ 有/ 必要/ 提供/ 针对/ 多/ 关键词/ 、/ 多/ 属性/ 请求/ 的/ 高效/ 密文/ 排序/ 查询/ [/ 3/ ]/ ,/ 充分/ 表达/ 用户/ 查询/ 兴趣/ ,/ 高效/ 返回/ 更能/ 精确/ 满足用户/ 需求/ 且/ 具有/ 重要/ 度/ 区分/ 的/ 所有/ 排序/ 结果/ 或/ Top/ -/ k/ 排序/ 结果/ ,/ 使/ 用户/ 能/ 快速/ 定位/ 与/ 查询/ 最/ 相关/ 密文/ 数据/ ,/ 同时/ 也/ 减小/ 网络/ 传输/ 开销/ ./ 另一方面/ ,/ 不同于/ 传统/ 企业级/ 单/ 数据/ 拥有者/ 数据/ 外/ 包/ ,/ 云/ 环境/ 下/ 数据/ 外/ 包/ 应用/ 更/ 具有/ 多/ 数据/ 拥有者/ 数据/ 发布/ 及/ 选择性/ 访问/ 授权/ 、/ 多源/ 数据/ 查询/ 等/ 特征/ ./ 如/ Email/ 系统/ 等/ ,/ 任何/ 用户/ 都/ 可以/ 作为/ 数据/ 拥有者/ 外/ 包/ 数据/ 并/ 选择性/ 授权/ 其/ 所有/ 或/ 部分/ 数据/ 给/ 任何/ 其他/ 用户/ 查询/ 访问/ ,/ 用户/ 查询/ 则/ 执行/ 其/ 被/ 授权/ 的/ 来源于/ 不同/ 数据/ 拥有者/ 的/ 所有/ 数据/ ./ 该/ 特征/ 下/ ,/ 将/ 使/ 用户/ 面临/ 更具/ 威胁/ 的/ 攻击/ ,/ 如/ 不可/ 信/ CSP/ 与/ 部分/ 恶意/ 数据/ 拥有者/ 之间/ 合谋/ 对/ 其他/ 任何/ 用户/ 隐私/ 的/ 攻击/ ./ 同时/ 考虑/ 到/ 云/ 环境/ 下/ 的/ “/ Pay/ -/ as/ -/ you/ -/ go/ ”/ 理念/ 、/ 轻量级/ 用户/ 查询/ 客户端/ 及/ 高/ 要求/ 用户/ 体验/ 等/ 特征/ ,/ 极有/ 必要/ 提供/ 针对/ 上述/ 特征/ 的/ 时空/ 高效/ 密文/ 查询/ 及/ 查询/ 授权/ 控制/ ,/ 并/ 确保/ 其/ 针对/ 各种/ 攻击/ 的/ 强/ 隐私/ 保护/ 能力/ ./ 其/ 时空/ 高效/ 表现/ 为/ :/ 数据/ 发布/ 时/ 数据/ 、/ 索引/ 等/ 的/ 低/ 传输/ // 存储/ 代价/ ,/ 数据/ 查询/ 时/ 请求/ 转换/ 的/ 客户端/ 低/ 计算/ 代价/ 以及/ 云端/ 密文/ 查询/ 的/ 低/ 执行/ 代价/ ./ 而/ 隐私/ 保护/ 则/ 要求/ 除了/ 保护/ 数据/ 隐私/ ,/ 还/ 需/ 确保/ 密文/ 索引/ 和/ 查询/ 过程/ 无/ 隐私/ 泄露/ ./ 目前/ 针对/ 数值/ 型/ 数据/ [/ 4/ ]/ 和/ 字符/ 型/ 数据/ [/ 5/ -/ 12/ ]/ 的/ 密文/ 查询/ 都/ 有/ 大量/ 的/ 方法/ 提出/ ,/ Cao/ 等/ 人/ [/ 3/ ]/ 也/ 在/ 2011/ 年/ 第一次/ 提出/ 并/ 解决/ 了/ 单/ 数据/ 拥有者/ 云/ 环境/ 下/ 的/ 隐私/ 保护/ 多/ 关键词/ 密文/ 排序/ 查询/ ./ 然而/ ,/ 现有/ 方法/ 仍/ 无法/ 满足/ 上述/ 云/ 环境/ 下/ 的/ 密文/ 查询/ 需求/ :/ 首先/ ,/ 未/ 全面/ 考虑/ 多/ 关键词/ 查询/ 相似/ 度/ 计算/ 的/ 贡献/ 因素/ ,/ 如多/ 属性数据/ 查询/ 、/ 关键词/ 隐私/ 保护/ 权重/ 、/ 用户/ 被/ 授权/ 可/ 访问/ 的/ 数据/ 范围/ 等/ ,/ 无法/ 有效/ 实现/ 更/ 客观/ 、/ 合理/ 的/ 密文/ 排序/ 查询/ ./ 其次/ ,/ 无法/ 在/ 支持/ 多/ 数据/ 拥有者/ 数据/ 外/ 包/ 及其/ 选择性/ 数据/ 查询/ 授权/ 的/ 同时/ ,/ 兼顾/ 密文/ 查询/ 的/ 强/ 隐私/ 保护/ 能力/ 、/ 时空/ 高效性/ 、/ 查询/ 及/ 结果/ 排序/ 准确性/ ,/ 如/ 无法/ 在/ 保证/ 查询/ 隐私/ 前提/ 下/ ,/ 支持/ 大规模/ 数据/ 高效/ 、/ 准确/ 的/ 多/ 关键词/ 密文/ 排序/ 查询/ 并/ 保持/ 较/ 低/ 索引/ 空间/ (/ 传输/ // 存储/ )/ 开销/ 等/ ./ 针对/ 以上/ 问题/ ,/ 本文/ 提出/ 了/ 一种/ 支持/ 隐私/ 保护/ 的/ 高效/ 密文/ 排序/ 查询方法/ (/ RQED/ )/ ,/ 旨在/ 满足/ 上述/ 云/ 环境/ 下/ 密文/ 查询/ 需求/ ,/ 主要/ 贡献/ :/ (/ 1/ )/ 提出/ 了/ 针对/ 云/ 环境/ 下多/ 数据/ 拥有者/ 数据/ 外/ 包及/ 选择性/ 数据/ 查询/ 授权/ 特征/ 的/ 多/ 属性/ 多/ 关键词/ 密文/ 排序/ 查询/ ,/ 并/ 定义/ 其/ 系统/ 模型/ 和/ 攻击/ 模型/ ./ 基于/ 无/ 证书/ 认证/ 思想/ [/ 13/ -/ 14/ ]/ 设计/ 不/ 依赖于/ 可信/ 第三方/ 和/ 安全/ 传输/ 信道/ 的/ 可/ 认证/ PKES/ (/ 支持/ 关键词/ 检索/ 的/ 公钥/ 加密/ [/ 8/ -/ 9/ ]/ )/ ,/ 并/ 构建/ 支持系统/ 模型/ 的/ RQED/ 框架/ 以/ 增强/ 查询/ 隐私/ 保护/ ./ (/ 2/ )/ 基于/ RQED/ 框架/ ,/ 设计/ 支持/ 多/ 属性数据/ 隐私/ 保护/ 词/ 权重/ 、/ 查询/ 词/ 权重/ 及/ 用户/ 被/ 授权/ 可/ 访问/ 数据/ 范围/ 等/ 更/ 客观/ 、/ 合理/ 的/ 密文/ 查询/ 排序/ 函数/ ./ (/ 3/ )/ 考虑/ 到/ 单/ 数据量/ 不确定性/ 、/ 数据/ 和/ 授权/ 更新/ 不确定性/ 以及/ 大规模/ 密文/ 数据/ 查询/ ,/ 为/ 提高/ 密文/ 查询/ 执行/ 与/ 密文/ 索引/ 的/ 时空/ 效率/ ,/ 提出/ 了/ 基于/ 层次/ 动态/ 布隆/ 过滤器/ 的/ RQED/ 索引/ 机制/ ./ (/ 4/ )/ 理论/ 分析/ 了/ RQED/ 机制/ 对/ 密文/ 查询/ 各种/ 隐私/ 的/ 保障/ ,/ 并/ 通过/ 真实/ 数据/ 集上/ 的/ 实验/ 分析/ 展示/ 出/ RQED/ 机制/ 在/ 兼顾/ 查询/ 高/ 准确性/ 和/ 强/ 隐私/ 保护/ 的/ 同时/ ,/ 还/ 具备/ 了/ 较/ 高/ 的/ 时空/ 效率/ 优势/ ./ 2/ 相关/ 工作/ 目前/ 国内外/ 学者/ 和/ 研究/ 人员/ 针对/ 加密/ 数据/ 查询/ 方面/ 做/ 了/ 大量/ 工作/ ,/ 旨在/ 实现/ 密文/ 数据/ 查询/ 的/ 功能丰富/ 、/ 高/ 执行/ 效率/ 、/ 低/ 空间/ 开销/ 和/ 强/ 隐私/ 保护/ ,/ 本文/ 相关/ 工作/ 大致/ 分为/ 以下/ 方面/ :/ (/ 1/ )/ 关键词/ 密文/ 查询/ ./ 现有/ 基于/ 关键词/ 的/ 密文/ Page3/ 查询方法/ 主要/ 分为/ 单/ 关键词/ 查询/ 和/ 多/ 关键词/ 查询/ ,/ 其/ 目的/ 都/ 是/ 通过/ 索引/ 关键词/ 构建/ 密文/ 数据/ 索引/ 以/ 实现/ 相关/ 查询/ ,/ 并/ 确保/ 其/ 针对/ 无/ 查询/ 密钥/ 的/ 非/ 授权/ 用户/ 不/ 泄露/ 数据/ 隐私/ ./ Song/ 等/ 人/ [/ 5/ ]/ 第一次/ 提出/ 基于/ 对称/ 密钥/ 的/ 单/ 关键词/ 可/ 检索/ 加密/ 方法/ ,/ Goh/ [/ 7/ ]/ 基于/ 布隆/ 过滤器/ 对/ 其/ 效率/ 进行/ 改进/ ,/ 同时/ Curtmola/ 等/ 人/ [/ 10/ ]/ 在/ Song/ 的/ 基础/ 上/ 给出/ 更/ 严格/ 的/ 安全性/ 定义/ 和/ 更/ 高效/ 的/ 对称/ 密钥/ 可/ 检索/ 加密/ 方法/ 构造/ ./ Wang/ 等/ 人/ [/ 11/ ]/ 考虑/ 关键词/ 词频/ 信息/ ,/ 提出/ 基于/ 对称/ 密钥/ 保序/ 加密技术/ OPSE/ 的/ 单/ 关键词/ 分级/ 密文/ 排序/ 查询方法/ ,/ 该/ 方法/ 对/ 相似/ 度/ 计算/ 并未/ 全面/ 考虑/ ,/ 因为/ 需要/ 扫描/ 所有/ 文档/ 而/ 不易/ 进行/ 索引/ 更新/ ./ 然而/ ,/ 单/ 关键词/ 查询/ 不足以/ 表达/ 和/ 满足用户/ 的/ 个性化/ 查询/ 需求/ ,/ 且/ 涉及/ 过多/ 查询/ 结果/ 而/ 导致/ 巨大/ 的/ 网络通信/ 负载/ ./ Li/ 等/ 人/ [/ 12/ ]/ 针对/ 关键词/ 精确/ 匹配/ 的/ 不足/ 提出/ 基于/ 编辑/ 距离/ 的/ 加密/ 字符串/ 模糊/ 检索/ 方案/ ./ 然而/ 这些/ 方法/ 却/ 仅仅/ 针对/ “/ all/ -/ or/ -/ nothing/ ”/ 的/ 查询/ 方式/ ,/ 并/ 返回/ 给/ 用户/ 完全/ 无/ 区分/ 性/ 的/ 查询/ 结果/ ./ 为了/ 进一步/ 满足用户/ 个性化/ 查询/ 需求/ ,/ Cao/ 等/ [/ 3/ ]/ 第一次/ 提出/ 多/ 关键词/ 密文/ 排序/ 查询/ 问题/ ,/ 并/ 基于/ 安全/ KNN/ 查询/ 技术/ [/ 6/ ]/ 中/ 索引/ 向量/ 与/ 查询/ 向量/ 间/ “/ 内积/ 相似/ 度/ ”/ 来/ 实现/ 排序/ 查询/ 并/ 进行/ 隐私/ 保护/ 增强/ ./ 然而/ ,/ 该/ 方法/ 并未/ 考虑/ 数据/ 中/ 索引/ 关键词/ 权重/ 及/ 查询/ 关键词/ 权重/ 等/ 因素/ ,/ 从而/ 不能/ 返回/ 满足用户/ 查询/ 请求/ 的/ 准确/ 排序/ 结果/ ;/ 并且/ 该/ 方法/ 需要/ 构建/ 系统/ 枚举/ 索引/ 关键词/ 词典/ 并/ 在/ 用户端/ 存储/ ,/ 这/ 无疑/ 不/ 符合实际/ 应用/ 且/ 造成/ 较大/ 客户端/ 负担/ ./ 例如/ ,/ 当/ 词典/ 规模/ 为/ N/ 时/ ,/ 其/ 用户/ 需要/ 安全/ 传输/ 和/ 存储/ 的/ 密钥/ 矩阵/ 空间/ 开销/ 为/ O/ (/ N2/ )/ 则/ 随着/ N/ 增大/ 将/ 带给/ 客户端/ 难以承受/ 的/ 负担/ ./ (/ 2/ )/ 密文/ 查询/ 隐私/ 保护/ ./ 事实上/ ,/ 现有/ 方法/ 都/ 试图/ 在/ 具有/ 一定/ 攻击能力/ 的/ 特定/ 攻击/ 模型/ 下/ 执行/ 查询/ 图/ 1/ 云/ 环境/ 下/ 隐私/ 保护/ 的/ 密文/ 排序/ 查询/ 结构图/ 隐私/ 保护/ ./ 基于/ 对称/ 密钥/ 加密/ 的/ 查询/ 隐私/ 保护/ [/ 3/ ,/ 5/ -/ 6/ ]/ 具有/ 较/ 高/ 的/ 执行/ 效率/ ,/ 然而/ 一方面/ ,/ 若/ 采用/ 同一个/ 密钥/ 进行/ 所有/ 用户/ 的/ 查询/ 授权/ 控制/ ,/ 则/ 完全/ 无法/ 抵御/ 内部/ 用户/ 与/ CSP/ 的/ 合谋/ 攻击/ ;/ 若/ 实施/ 选择性/ 查询/ 授权/ 控制/ ,/ 即/ 数据/ 拥有者/ 对/ 不同/ 用户/ 授权/ 不同/ 的/ 查询/ 密钥/ ,/ 显然/ 将/ 带来/ 复杂/ 的/ 密钥/ 安全/ 分发/ 和/ 管理/ 问题/ (/ 随着/ 系统/ 数据/ 和/ 用户/ 规模/ 扩大/ ,/ 其/ 密钥/ 安全/ 管理/ 极具/ 挑战/ [/ 15/ ]/ 且/ 近似于/ NP/ 完全/ 困难/ 问题/ )/ ./ 文献/ [/ 3/ ]/ 试图/ 通过/ 扰乱/ 排序/ 实现/ 查询/ 隐私/ 保护/ ,/ 但/ 其/ 内部/ 用户/ 完全/ 可以/ 根据/ 自己/ 所/ 掌握/ 的/ 密钥/ 与/ CSP/ 合谋/ 推理/ 出/ 其他/ 用户/ 的/ 查询/ 请求/ 隐私/ ./ 针对/ 上述/ 缺陷/ ,/ Boneh/ 等/ 人/ [/ 8/ ]/ 首次/ 基于/ DH/ 密钥/ 交换/ 协议/ 提出/ 关键词/ 可/ 检索/ 的/ 公钥/ 加密/ 方法/ (/ PKES/ )/ ,/ 通过/ 公钥/ 加密/ 和/ 私钥/ 查询/ 很/ 好/ 的/ 避免/ 了/ 上述/ 选择性/ 查询/ 授权/ 中/ 的/ 复杂/ 密钥/ 管理/ 问题/ ./ Boneh/ 等/ 人/ [/ 9/ ]/ 在/ 此基础/ 上/ ,/ 进一步/ 提出/ 了/ 支持/ PIR/ 查询/ 的/ 公钥/ 加密/ 方法/ ,/ 但/ 需要/ 繁重/ 的/ 客户端/ 与/ 服务器端/ 间/ 交互/ ./ 相对/ 于/ 基于/ 对称/ 密钥/ 的/ 方法/ ,/ PKES/ 显然/ 更/ 具有/ 优势/ ./ 然而/ ,/ 现有/ PKES/ 方法/ 存在/ 局限性/ :/ 算法/ 构造/ 中/ 忽视/ 公钥/ 的/ 认证/ ;/ 当/ 存在/ 多/ 数据/ 拥有者/ 查询/ 授权/ 时/ ,/ 用户/ 查询/ 过程/ 难以/ 抵御/ 恶意/ 数据/ 拥有者/ 与/ CSP/ 的/ 合谋/ 攻击/ ;/ 索引/ 缺乏/ 动态/ 伸缩性/ 致使/ 空间/ 开销/ 较大/ ;/ 查询/ 时/ 直接/ 匹配/ 每个/ 数据/ 索引/ 导致/ 查询/ 效率/ 低下/ ;/ 无法/ 高效/ 支持/ 云/ 环境/ 下/ 大规模/ 数据/ 的/ 多/ 关键词/ 排序/ 查询/ ./ 3/ 问题/ 定义/ 3.1/ 系统/ 模型/ 如图/ 1/ 所示/ ,/ 我们/ 认为/ 一个/ 典型/ 的/ 云/ 环境/ 下/ 多数/ 拥有者/ 数据/ 外/ 包/ 服务/ 系统/ 主要/ 包括/ 以下/ 3/ 个/ 实体/ :/ 云/ 服务提供商/ CSP/ 、/ 数据/ 拥有者/ 用户/ 和/ 被/ 授权/ Page4/ 用户/ ./ 系统/ 任何/ 用户/ 都/ 可以/ 作为/ 数据/ 拥有者/ 发布/ 数据/ ,/ 也/ 可以/ 同时/ 作为/ 被/ 授权/ 用户/ 获得/ 其他/ 用户/ 的/ 数据/ 访问/ 权限/ ./ 假设/ 数据/ 拥有者/ 用户/ 珘/ u/ 有/ 数据/ 集/ / 珘/ u/ 需要/ 外包/ 给/ CSP/ ,/ 为/ 保障/ 数据安全/ ,/ 首先/ 将/ / 珘/ u/ 加密/ 为/ 密文/ 数据/ / 珘/ u/ ./ 而/ 珘/ u/ 可以/ 根据/ 自己/ 的/ 需求/ 选择性/ 地/ 授权/ / 珘/ u/ 中/ 所有/ 或/ 部分/ 数据/ 给/ 被/ 授权/ 用户/ u/ 进行/ 访问/ ./ 为了/ 实现/ 在/ 密文/ 数据/ / 珘/ u/ 上/ 的/ 查询/ 能力/ ,/ 珘/ u/ 在外/ 包/ 数据/ 前/ 还/ 需要/ 根据/ / 珘/ u/ 构建/ 其/ 密文/ 索引/ / 珘/ u/ ./ 然后/ 再/ 将/ 密文/ 数据/ 及/ 对应/ 密文/ 索引/ {/ / 珘/ u/ ,/ / 珘/ u/ }/ 外包/ 给/ CSP/ ./ 当/ 被/ 授权/ 用户/ u/ 提交/ 查询/ / 时/ ,/ 通过/ 如图/ 1/ 中/ 所示/ 查询/ 授权/ 控制/ 机制/ ,/ u/ 能够/ 正确/ 转换/ / 为/ 查询/ / (/ 又/ 称为/ Trapdoor/ )/ ,/ 并/ 提交/ CSP/ ./ CSP/ 利用/ 陷门/ / / 在/ 系统/ 所有/ 密文/ 索引/ 集/ / 和/ 密文/ 数据/ 集/ / 上/ 执行/ 查询/ ,/ 并/ 返回/ 满足/ 查询/ 条件/ 且/ 按/ 查询/ 相关度/ 排序/ 的/ 所有/ 结果/ 或/ Top/ -/ k/ 结果/ ./ 最终/ ,/ 通过/ 如图/ 1/ 所示/ 的/ 数据/ 访问控制/ 机制/ [/ 15/ ]/ ,/ u/ 从/ 相应/ 数据/ 拥有者/ 获取/ 结果/ 数据/ 对应/ 密钥/ 安全/ 解密/ 数据/ 内容/ ./ 本文/ 旨在/ 设计/ 上述/ 系统/ 模型/ 下强/ 隐私/ 保护/ 且/ 时/ / 空/ 高效/ 的/ 多/ 属性/ 多/ 关键词/ 密文/ 排序/ 查询方法/ ./ 3.2/ 攻击/ 模型/ 攻击者/ ./ 按照/ 其/ 攻击能力/ 由弱/ 至/ 强/ 分为/ :/ (/ 1/ )/ 外部/ 攻击者/ ,/ 即/ 网络/ 攻击者/ ,/ 在/ 系统/ 中/ 最/ 普遍/ 且/ 攻击能力/ 最/ 弱/ ;/ (/ 2/ )/ CSP/ ,/ 即/ 不可/ 信/ (/ 诚实/ 而/ 好奇/ )/ 系统管理员/ ,/ 他/ 承诺/ 正确/ 执行/ 与/ 用户/ 的/ 数据/ 托管/ 协议/ ,/ 但/ 无法/ 避免/ 其/ 恶意/ 窥窃/ 或/ 分析/ 用户/ 数据/ 、/ 索引/ 及/ 查询/ 请求/ ,/ 从而/ 获取/ 用户/ 隐私/ 信息/ ;/ (/ 3/ )/ 内部/ 攻击者/ ,/ 包括/ 恶意/ 数据/ 拥有者/ 和/ 被/ 授权/ 用户/ ,/ 通过/ 其/ 已/ 掌握/ 的/ 部分/ 信息/ (/ 如/ 部分/ 数据/ 、/ 索引/ 、/ Trapdoor/ 、/ 密钥/ 等/ )/ 来/ 试图/ 攻击/ 其他/ 用户/ 隐私/ 信息/ ;/ (/ 4/ )/ 合谋/ 攻击者/ ,/ 包括/ 被/ 授权/ 用户/ 与/ CSP/ 合谋/ 和/ 数据/ 拥有者/ 与/ CSP/ 合谋/ ,/ 后者/ 较/ 前者/ 有/ 更/ 强/ 的/ 攻击能力/ ./ 攻击方式/ ./ 正如/ 文献/ [/ 3/ ]/ 所述/ ,/ 存在/ 两种/ 攻击方式/ :/ (/ 1/ )/ 已知/ 密文/ 攻击/ ,/ 攻击者/ 仅仅/ 掌握/ 密文/ 数据/ / 、/ 密文/ 索引/ / 及/ 密文/ 查询/ 请求/ Trapdoor/ ;/ (/ 2/ )/ 已知/ 背景/ 攻击/ ,/ 攻击者/ 在/ 已知/ 密文/ 基础/ 上/ ,/ 还/ 掌握/ 部分/ 关键词/ 或/ 关键词/ 频等/ 静态/ 信息/ 、/ 部分/ 给定/ 关键词/ 与/ 数据/ 的/ 关联/ 信息/ 以及/ 部分/ 给定/ Trapdoor/ 间/ 的/ 关联/ 信息/ 等/ ./ 后者/ 有/ 更/ 强/ 攻击能力/ ,/ 而/ 外部/ 攻击者/ 只能/ 执行/ 前者/ ./ 本文/ 目标/ 是/ 在/ 上述/ 攻击/ 模型/ 下/ ,/ 保障/ 密文/ 排序/ 查询/ 的/ 隐私/ 需求/ [/ 3/ ]/ ,/ 详见/ 5.1/ 节/ 安全性/ 分析/ ./ 3.3/ 主要/ 符号/ 说明/ u/ ;/ U/ / 任何/ 一个/ 用户/ ;/ 系统/ 所有/ 用户/ 集合/ ./ 珘/ u/ ;/ OU/ / 任何/ 数据/ 拥有者/ ;/ 所有/ 数据/ 拥有者/ 集合/ ./ OU/ / U/ ./ 引集/ ./ / ;/ / ;/ / / 系统/ 明文/ 数据/ 集/ ;/ 密文/ 数据/ 集/ ;/ 密文/ 索/ / ;/ / / 任何/ 一个/ 数据/ 属性/ 标识/ ;/ 所有/ 属性/ 集合/ ./ / 珘/ u/ ;/ / 珘/ u/ ;/ / 珘/ u/ / 珘/ u/ 外包/ 的/ 明文/ 数据/ 集/ ;/ 密文/ 数据/ 集/ ;/ 密文/ 索引/ 集/ ./ / =/ ∪/ 珘/ u/ ∈/ OU/ / 珘/ u/ ;/ / =/ ∪/ 珘/ u/ ∈/ OU/ / 珘/ u/ ;/ / =/ ∪/ 珘/ u/ ∈/ OU/ / 珘/ u/ ./ / 珘/ u/ ;/ / 珘/ u/ ;/ / 珘/ u/ / 珘/ u/ 外包/ 的/ 其中/ 一条/ 明文/ 数据/ ;/ 密文/ 数据/ ;/ 密文/ 索引/ ./ 即/ / / 珘/ u/ ∈/ / 珘/ u/ ;/ / / 珘/ u/ ∈/ / 珘/ u/ ;/ / / 珘/ u/ ∈/ / 珘/ u/ ./ / 珘/ u/ ,/ / / / 珘/ u/ 中/ 属性/ / 上/ 的/ 数据/ 值/ ,/ 即/ / / 珘/ u/ ,/ / ∈/ / 珘/ u/ ./ W/ / / / 珘/ u/ ,/ / 中/ 所/ 包含/ 的/ 索引/ 关键词/ 集合/ ./ W/ / ,/ l/ / W/ / 中/ 第/ l/ 个/ 索引/ 关键词/ ./ EW/ / ,/ l/ / W/ / ,/ l/ 加密/ 后/ 的/ 密文/ 索引/ 词/ ./ EW/ / / W/ / 加密/ 后/ 的/ 密文/ 索引/ 词/ 集合/ ./ EW/ / / 珘/ u/ 经/ 处理/ 后/ 的/ 所有/ 密文/ 索引/ 词/ 集合/ ./ / / u/ 的/ 查询/ 请求/ ./ / / / 的/ 查询/ Trapdoor/ ./ ~/ ;/ / W/ / W/ / / 珘/ u/ ,/ W/ / / Trapdoor/ ./ HBFi/ =/ [/ 1/ ,/ K/ ]/ / 布隆/ 过滤器/ 的/ K/ 个/ Hash/ 函数/ 簇/ ./ HBFi/ =/ [/ 1/ ,/ K/ ]/ (/ x/ )/ / x/ 映射/ 到/ 布隆/ 过滤器/ 的/ K/ 个位/ BF/ [/ HBFi/ =/ [/ 1/ ,/ K/ ]/ (/ )/ x/ ]/ / 位于/ 布隆/ 过滤器/ BF/ 中/ K/ 游标/ ./ 个位/ 游标/ 处/ 的/ K/ 个值/ ./ 4RQED/ 机制/ 4.1/ RQED/ 框架/ 概念/ 1/ ./ 双线性/ 配对/ 映射/ [/ 13/ -/ 14/ ]/ ./ 假设/ G1/ 和/ G2/ 是/ 两个/ 阶都/ 为/ 大/ 素数/ p/ 的/ 乘法/ 群/ ,/ 映射/ e/ ^/ :/ G1/ ×/ G1/ →/ G2/ 称为/ 双线性/ 配对/ 映射/ ,/ 则/ 映射/ e/ ^/ 满足/ 如下/ 性质/ :/ (/ 1/ )/ 双线性/ ./ 对于/ / P/ ,/ Q/ ∈/ G1/ 和/ / a/ ,/ b/ ∈/ Zp/ ,/ 都/ 有/ e/ ^/ (/ Pa/ ,/ Qb/ )/ =/ e/ ^/ (/ P/ ,/ Q/ )/ ab/ ./ (/ 2/ )/ 非/ 退化/ 性/ ./ / P/ ,/ Q/ ∈/ G1/ ,/ 使得/ e/ ^/ (/ P/ ,/ Q/ )/ ≠/ 1/ ./ (/ 3/ )/ 可计算性/ ./ 对于/ / P/ ,/ Q/ ∈/ G1/ ,/ 都/ 会/ 有/ 一个/ 有效/ 的/ 多项式/ 时间/ 算法/ 来/ 计算/ e/ ^/ (/ P/ ,/ Q/ )/ ./ 针对/ 上述/ 系统/ 模型/ 和/ 安全/ 模型/ ,/ 我们/ 首先/ 构造/ RQED/ 框架/ ./ 该/ 框架/ 中/ ,/ 通过/ 设计/ 不/ 依赖于/ 可信/ 第三方/ 和/ 安全/ 传输/ 信道/ 的/ 无/ 证书/ 认证/ PKES/ 来/ 实施/ 复杂/ 的/ 多/ 数据/ 拥有者/ 选择性/ 查询/ 授权/ 控制/ 并/ 增强/ 查/ Page5/ 询/ 隐私/ 保护/ ./ 基于/ 该/ 框架/ ,/ 我们/ 设计/ 多/ 属性/ 、/ 多/ 关键词/ 的/ 隐私/ 保护/ RQED/ 排序/ 函数/ ,/ 并/ 进一步/ 提出/ 基于/ 层次/ 动态/ 布隆/ 过滤器/ 索引/ 的/ RQED/ 机制/ ./ 无/ 证书/ 公钥/ 密码/ [/ 13/ -/ 14/ ]/ 的/ 基本/ 思想/ 即/ 通过/ 引入/ 半/ 可信/ 第三方/ KGC/ 来/ 辅助/ 用户/ 公私/ 钥对/ 生成/ 及公钥/ 认证/ ,/ 但/ KGC/ 却/ 并/ 不能/ 掌握/ 威胁/ 用户/ 私钥/ 的/ 相关/ 信息/ ./ 本文/ 在/ VipulGoyal/ [/ 14/ ]/ 所/ 提出/ 的/ 无/ 证书/ 思想/ 基础/ 上/ ,/ 构造/ 高效/ 的/ 可/ 认证/ PKES/ ./ 在/ 本文/ 系统/ 模型/ 和/ 框架/ 中/ ,/ 我们/ 认为/ CSP/ 是/ 一个/ 典型/ 的/ 半/ 可信/ 第三方/ 实体/ (/ 诚实/ 而/ 好奇/ )/ ,/ 可以/ 充当/ KGC/ 角色/ ./ RQED/ 框架/ 由/ 以下/ 部分/ 组成/ :/ Scenario/ ./ 为了/ 阐述/ 更为/ 清晰/ ,/ 我们/ 这里/ 仅以/ 数据/ 拥有者/ 珘/ u/ 的/ 单条/ 数据/ / 珘/ u/ 为例/ ,/ 而/ 珘/ u/ 的/ 其它/ 数据处理/ 过程/ 完全相同/ ./ / 珘/ u/ 对应/ 的/ 密文/ 数据/ 及/ 索引/ 分别/ 为/ / 珘/ u/ 、/ / 珘/ u/ ,/ 且/ / 珘/ u/ =/ {/ / 珘/ u/ ,/ / |/ / ∈/ / }/ ./ 同时/ 假设/ 珘/ u/ 将/ 数据/ / 珘/ u/ 的/ 访问/ 权限/ 授权/ 给/ 用户/ u/ ./ 然后/ ,/ 用户/ u/ 提交/ 查询/ 请求/ / ,/ 且/ / 包含/ 有/ 属性/ 集/ / 个/ 查询/ 关键词/ W/ / KGC/ →/ u/ :/ KGC/ 接收/ 到/ (/ Ru/ ,/ IDu/ )/ ,/ 首先/ 对/ 其/ 进行/ 零/ 知识/ 证明/ [/ 14/ ]/ ,/ 若/ 证明/ 失败/ 则/ 放弃/ 交互/ ,/ 否则/ 计算/ QIDu/ =/ H1/ (/ IDu/ )/ 以及/ 用户/ u/ 的/ 部分/ 公钥/ Hu/ =/ (/ Ru/ )/ 1/ // (/ α/ -/ QIDuu/ :/ u/ 获得/ Hu/ 后/ 首先/ 对/ 其/ 进行/ 真实性/ 认证/ ,/ 即/ 判断/ e/ ^/ (/ H1/ // auu/ ,/ g1g/ -/ QIDu/ )/ =/ ?/ e/ ^/ (/ h/ ,/ g/ )/ ./ 若/ 等式/ 成立/ ,/ 则/ 确定/ 其/ 公私/ 钥对/ Ku/ 生成/ 失败/ ./ Setup/ (/ 1/ / )/ ./ KGC/ 生成/ 系统/ 主/ 密钥/ α/ 并/ 秘密/ 保存/ ,/ 同时/ 选取/ 阶都/ 为/ p/ 的/ 乘法/ 群/ G1/ 和/ G2/ 以及/ 满足/ 概念/ 1/ 所述/ 性质/ 的/ 双线性/ 映射/ e/ ^/ :/ G1/ ×/ G1/ →/ G2/ ./ 令/ g/ 、/ h/ 是/ G1/ 的/ 两个/ 生成元/ ,/ 并/ 设置/ g1/ =/ g/ α/ ./ 同时/ ,/ 选取/ 一个/ Hash/ 函数/ H1/ :/ {/ 0/ ,/ 1/ }/ / →/ Z/ / HBFi/ =/ [/ 1/ ,/ K/ ]/ =/ {/ HBFi/ |/ i/ =/ [/ 1/ ,/ K/ ]/ }/ ,/ 且/ / HBFi/ :/ {/ 0/ ,/ 1/ }/ / →/ m/ (/ 针对/ 后面/ 4.3/ 节/ ,/ K/ 为/ Hash/ 函数/ 个数/ ,/ m/ 为/ 任何/ 标准/ 布隆/ 过滤器/ [/ 16/ -/ 17/ ]/ 的/ 位/ 长度/ )/ ./ 最终/ 系统/ 公开/ 参数/ 为/ ppub/ =/ {/ G1/ ,/ G2/ ,/ e/ ^/ ,/ g/ ,/ g1/ ,/ α/ ,/ H1/ ,/ m/ ,/ HBFi/ =/ [/ 1/ ,/ K/ ]/ }/ ./ KeyGen/ (/ α/ ,/ Ppub/ )/ ./ 任何/ 用户/ u/ 加入/ 系统/ 时/ ,/ 该/ 算法/ 通过/ u/ 与/ KGC/ 的/ 交互/ 生成/ u/ 的/ 公私/ 钥对/ pub/ ,/ Ku/ (/ Kuu/ →/ KGC/ :/ u/ 随机/ 选取/ 一个/ 大/ 整数/ 作为/ 秘密/ 值/ au/ 并/ 秘密/ 保存/ ,/ 同时/ 计算/ 其/ 公开/ 值/ Ru/ =/ hau/ ./ 然后/ 传输/ 对值/ (/ Ru/ ,/ IDu/ )/ 给/ KGC/ ,/ 其中/ IDu/ 是/ 用户/ u/ 的/ 身份/ 标识/ ./ PreProcData/ (/ / 珘/ u/ )/ ./ 对于/ / / 珘/ u/ ,/ / ∈/ / 珘/ u/ ,/ 将/ 其/ 预处理/ 为/ 索引/ 关键词/ 的/ 集合/ W/ / ./ 并/ 对/ / W/ / ,/ l/ ∈/ W/ / ,/ 计算/ 其/ 权重/ 相关/ 信息/ ./ PKES/ (/ / 珘/ u/ ,/ IDu/ ,/ Hu/ ,/ a/ 珘/ u/ )/ ./ 对于/ / / ∈/ / ,/ / W/ / ,/ l/ ∈/ W/ / ,/ 数据/ 拥有者/ 珘/ u/ 对/ W/ / ,/ l/ 进行/ PKES/ 加密/ 成为/ 密文/ 索引/ 词/ EW/ / ,/ l/ ./ 该/ 加密/ 处理/ 涉及/ 珘/ u/ 的/ 私钥/ K/ 珘/ u/ 被/ 授权/ 用户/ u/ 的/ 可/ 认证/ 公钥/ Ku/ 如下/ :/ (/ 1/ )/ 计算/ QID/ 珘/ u/ =/ H1/ (/ ID/ 珘/ u/ )/ 和/ QIDu/ =/ H1/ (/ IDu/ )/ ./ (/ 2/ )/ 判断/ e/ ^/ (/ Hu/ ,/ g1g/ -/ QIDu/ )/ =/ ?/ e/ ^/ (/ Ru/ ,/ g/ )/ ./ 若/ 等式/ 成立/ ,/ 执行/ 对/ u/ 授权/ ,/ 否则/ 放弃/ 授权/ ./ (/ 3/ )/ 计算/ EW/ / ,/ l/ =/ e/ ^/ (/ (/ Hu/ )/ a/ 珘/ u/ ·/ H1/ (/ W/ 最终/ 得/ / 珘/ u/ ,/ / 对应/ 的/ 所有/ 密文/ 索引/ 词为/ EW/ / ,/ / 珘/ u/ 对应/ 的/ 所有/ 密文/ 索引/ 词为/ EW/ =/ {/ EW/ / |/ / ∈/ / }/ ./ RQED/ 机制/ 中/ ,/ 我们/ 将/ 属性/ 标识/ / 引入/ PKES/ 加密/ 及/ 下面/ 的/ Trapdoor/ 计算/ ,/ 以此/ 来/ 区分/ 数据/ 及/ 查询/ 请求/ 中/ 的/ 不同/ 属性/ 关键词/ ./ 相对/ 于/ 传统/ 单/ 属性/ 查询/ ,/ 如此/ 处理/ 的/ 优势/ 是/ 多/ 属性数据/ 仅/ 需/ 采用/ 同一个/ 索引/ ,/ 提高/ 索引/ 空间/ 效率/ ./ 法/ 输出/ / 珘/ u/ 的/ 密文/ 索引/ / 珘/ u/ ./ BuildIndex/ (/ EW/ )/ ./ 输入/ 密文/ 索引/ 词/ EW/ ,/ 该算/ PreProcQuery/ (/ / )/ ./ 令/ / 中/ 任何/ 属性/ / 个/ 查询/ 关键词/ 集合/ W/ / ~/ ,/ 为/ W/ / W/ / Trapdoor/ (/ / ,/ au/ )/ ./ 令/ 已/ 授权/ 给/ u/ 的/ 数据/ 拥有者/ 集合/ 为/ OUu/ ,/ 则/ 对于/ / / OUu/ ,/ 利用/ u/ 的/ 私钥/ Ku/ 询子/ Trapdoor/ / 珘/ u/ ,/ W/ / 最终/ 得/ 查询/ / 的/ 查询/ 陷门/ Trapdoor/ :/ / =/ {/ / 珘/ u/ ,/ WQuery/ (/ / 法/ 并/ 返回/ 满足条件/ 的/ 所有/ 排序/ 结果/ 或/ Top/ -/ k/ 结果/ ./ 4.2/ RQED/ 排序/ 函数/ 基于/ 上述/ RQED/ 框架/ ,/ 我们/ 设计/ 了/ 更/ 合理/ 且/ 隐私/ 保护/ 的/ 多/ 属性/ 多/ 关键词/ 密文/ 查询/ 排序/ 函数/ ./ 信息检索/ (/ IR/ )/ 领域/ ,/ 数据/ (/ 文档/ )/ 与/ 给定/ 查询/ 请求/ 间/ 的/ 相似/ 度/ 是/ 用于/ 查询/ 排序/ 的/ 最/ 常用/ 标准/ ,/ 相似/ 度越/ 高则/ 越/ 满足用户/ 的/ 查询/ 兴趣/ ./ 单/ 关键词/ 排序/ 查询/ 中/ 相似/ 度/ 计算/ 广泛/ 采用/ 的/ 是/ TF/ ×/ IDF/ 规则/ ,/ 其中/ TF/ 指/ 数据/ 中/ 的/ 简单/ 关键词/ 频/ ,/ 反映/ 关键词/ 在/ 数据/ 中/ 的/ 重要/ 度/ ;/ IDF/ 指反/ 数据/ (/ 文档/ )/ 词频/ ,/ 反映/ 关键词/ 在/ 整/ Page6/ 个/ 数据/ 集中/ 的/ 区分度/ ./ 然而/ ,/ 在/ 本文/ 系统/ 模型/ 下/ ,/ 仅仅/ 考虑/ 单/ 关键词/ 与/ 数据/ 间/ 的/ 相似/ 度/ 是/ 不/ 可行/ 的/ [/ 3/ ,/ 11/ ]/ ,/ 特别/ 是/ 针对/ 隐私/ 保护/ 的/ 多/ 关键词/ 排序/ 查询/ (/ 例如/ ,/ 关键词/ 词频/ 泄露/ 会/ 导致/ 遭受/ 已知/ 背景/ 统计/ 攻击/ [/ 3/ ]/ )/ ./ RQED/ 机制/ 中/ ,/ 在/ 保护/ 隐私/ 前提/ 下/ 全面/ 分析/ 相似/ 度/ 计算/ 的/ 贡献/ 因素/ ,/ 涉及/ 两个/ 重要/ 概念/ :/ 一方面/ 最/ 重要/ 的/ 是/ 针对/ 数据/ 不同/ 属性/ 的/ 隐私/ 保护/ 关键词/ 权重/ (/ Privacy/ -/ preservingDataKeywordWeight/ ,/ PDKW/ )/ ,/ 另一方面/ 则/ 是/ 用户/ 自定义/ 的/ 查询/ 请求/ 不同/ 属性/ 关键词/ 权重/ (/ QueryKeywordWeight/ ,/ QKW/ )/ ./ 归纳起来/ ,/ RQED/ 机制/ 的/ 关键点/ 体现/ 在/ :/ (/ 1/ )/ 数据/ 发布/ 时/ 如何/ 计算/ PDKW/ ;/ (/ 2/ )/ 构建/ 索引/ 时/ 如何/ 存储/ PDKW/ ;/ (/ 3/ )/ 查询/ 时/ 如何/ 获取/ PDKW/ ;/ (/ 4/ )/ 如何/ 利用/ PDKW/ 和/ QKW/ 计算/ 查询/ 结果/ 相似/ 度/ 并/ 排序/ ./ 考虑/ 到/ 多/ 关键词/ 查询/ 中/ “/ OR/ ”/ 查询/ 逻辑/ 更为/ 普遍/ ,/ 且/ “/ AND/ ”/ 查询/ 逻辑/ 可以/ 通过/ “/ OR/ ”/ 实现/ ,/ 因此/ 本文/ 仅以/ “/ OR/ ”/ 查询/ 为例/ 进行/ 阐述/ ./ RQED/ 框架/ 的/ PreProcData/ 中/ ,/ 所/ 做/ 的/ 主要/ 处理/ 任务/ 是/ 计算/ 数据/ / 珘/ u/ 中/ 每/ 一个/ 关键词/ 的/ PDKW/ ,/ 对于/ / W/ / ,/ l/ ∈/ W/ / ,/ 定义/ 其/ PDKW/ 为/ / / W/ 于/ 对/ 传统/ 经典/ 方法/ 的/ 分析/ 设计/ 了/ 更/ 合理/ 的/ PDKW/ 计算/ 函数/ ,/ 如下/ / / W/ (/ TFW/ / ,/ l/ =/ δ/ / ·/ ε/ W/ / ,/ l/ // (/ lg/ (/ max/ 式/ (/ 1/ )/ 中/ ,/ δ/ / 和/ ε/ WPDKW/ 计算/ 客观性/ 而/ 设计/ 的/ 调整/ 因子/ ./ 在/ 数据挖掘/ 领域/ 的/ 文摘/ 抽取/ 、/ QA/ 等/ 技术/ 中/ 也/ 有/ 类似/ 思路/ ,/ 而/ 现有/ 安全/ 云/ 数据/ 排序/ 查询方法/ 却/ 完全/ 未/ 考虑/ ./ δ/ / 用于/ 关键词/ 在/ 不同/ 属性/ 中/ 的/ 重要/ 度/ 区分/ ,/ 即/ 数据/ 属性/ 特/ 

