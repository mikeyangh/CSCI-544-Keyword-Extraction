Page1/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ BGP/ 路由/ 属性/ 保护/ 机制/ 李道/ 丰/ 1/ )/ ,/ 3/ )/ 王高才/ 1/ )/ ,/ 3/ )/ 王志伟/ 2/ )/ 钟诚/ 1/ )/ ,/ 3/ )/ 李陶/ 深/ 1/ )/ ,/ 3/ )/ 1/ )/ (/ 广西大学/ 计算机/ 与/ 电子信息/ 学院/ 南宁/ 530004/ )/ 2/ )/ (/ 南京/ 邮电大学/ 计算机/ 学院/ 南京/ 210003/ )/ 3/ )/ (/ 广西/ 高校/ 并行/ 分布式计算/ 技术/ 重点/ 实验室/ 南宁/ 530004/ )/ 摘要/ BGP/ 路由/ 协议/ 是/ 目前/ 大多数/ 网络/ 基础设施/ 所/ 采用/ 的/ 重要/ 协议/ 之一/ ./ 随着/ 网络攻击/ 技术/ 的/ 发展/ ,/ 如何/ 构造/ 安全/ 且/ 容易/ 部署/ 的/ BGP/ 协议/ 保护/ 机制/ ,/ 仍然/ 是/ 安全/ 路由/ 协议/ 研究/ 中/ 的/ 热点问题/ ./ 文中/ 提出/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ BGP/ 协议/ 的/ 路由/ 属性/ 保护/ 机制/ —/ —/ —/ Identity/ -/ basedSanitizableSignaturePathVerification/ (/ 简称/ IDSPV/ )/ ./ IDSPV/ 机制/ 采用/ 基于/ 身份/ 的/ 密码学/ 思想/ 以及/ 可/ 净化/ 签名/ 方案/ 的/ 优点/ ./ 并/ 结合/ BGP/ 路由/ 协议/ 特征/ ,/ 在/ 无需/ 证书/ 的/ 条件/ 下/ ,/ 仅/ 需/ 将/ 自己/ 的/ 更新/ 报文/ 签名/ 后/ 再/ 添加/ 到/ AS/ _/ PATH/ 路径/ 中/ ,/ 为/ BGP/ 路由/ 属性/ 完整性/ 和/ 真实性/ 提供/ 保护/ ./ 避免/ 证书/ 存储/ 和/ 管理/ 开销/ ./ 另外/ ,/ 文中/ 给出/ 保护/ AS/ _/ PATH/ 路由/ 属性/ 的/ 安全/ 模型/ ,/ 利用/ 规约/ 技术/ ,/ 在/ 标准/ 模型/ 下/ 给出/ IDSPV/ 机制/ 的/ 安全/ 证明/ ./ 通过/ 安全性/ 和/ 性能/ 方面/ 的/ 分析/ 可知/ ,/ 与/ 现有/ 方案/ 相比/ ,/ IDSPV/ 机制/ 更/ 易于/ 在/ 实际/ 网络/ 中/ 部署/ ./ 关键词/ 标准/ 模型/ ;/ 边界/ 网关/ 协议/ ;/ 可/ 证明/ 安全/ ;/ 路由/ 属性/ 保护/ ;/ 可/ 净化/ 签名/ 1/ 引言/ BGP/ 路由/ 协议/ ①/ 是/ 当前/ 唯一/ 使用/ 的/ 域间/ 路由/ 协议/ ,/ 而/ 构建/ 安全/ 的/ BGP/ 协议/ 一直/ 是/ 近/ 十多年/ 以来/ 互联网/ 研究/ 的/ 热点问题/ ./ 随着/ 互联网/ 技术/ 的/ 发展/ 和/ 网络攻击/ 技术/ 的/ 提高/ ,/ BGP/ 协议/ 的/ 安全/ 问题/ 日益/ 凸出/ ,/ 严重/ 影响/ 着/ 网络/ 的/ 正常/ 运营/ [/ 1/ ]/ ,/ 阻碍/ 到/ 互联网/ 的/ 进一步/ 发展/ ./ 目前/ BGP/ 路由/ 协议/ 所/ 存在/ 的/ 安全/ 问题/ 是/ 源地址/ 真实性/ 问题/ 和/ 更新/ 报文/ AS/ _/ PATH/ 路由/ 属性/ 的/ 安全/ 问题/ [/ 2/ ]/ ./ 源地址/ 真实性/ 问题/ 是/ 指路/ 由/ 信息/ 发起者/ AS/ (/ AutonomousSystem/ ,/ AS/ )/ 是否/ 真正/ 拥有/ 所/ 声称/ 的/ IP地址/ 前缀/ ;/ AS/ _/ PATH/ 路由/ 属性/ 安全/ 问题/ 则/ 是/ AS/ 所/ 更新/ 的/ 报文/ AS/ _/ PATH/ 是否/ 具有/ 完整性/ 和/ 真实性/ ,/ 亦/ 即/ 是否/ 被/ 纂/ 改/ ./ 具体/ 而言/ ,/ 所有/ 参与/ 路由/ 的/ AS/ 是否/ 诚实/ 地/ 传播/ AS/ _/ PATH/ 并/ 正确/ 地/ 添加/ 相应/ 的/ 路由/ 信息/ 到/ AS/ _/ PATH/ 中/ ./ 这/ 两个/ 安全/ 问题/ 将/ 引起/ 非法/ 的/ 路由/ 攻击/ ./ 前缀/ 劫持/ 就是/ 由于/ 上述/ 安全/ 问题/ 而/ 导致/ 的/ 破坏性/ 巨大/ 的/ 一种/ 攻击方式/ ,/ 而且/ BGP/ 路由器/ 能够/ 自主/ 地/ 宣告/ 任意/ 错误/ // 恶意/ 路由/ 信息/ ,/ 同时/ 这些/ 路由/ 信息/ 不/ 加/ 任何/ 检测/ 措施/ 就/ 传播/ 到/ 整个/ 互联网/ ,/ 造成/ 全球/ 网络/ 不/ 稳定/ ,/ 甚至/ 瘫痪/ ./ 因此/ ,/ 在/ 可信/ 可控/ 可管/ 的/ 网络/ 基础设施/ 课题/ 研究/ 中/ ,/ BGP/ 路由/ 协议/ 的/ 安全/ 问题/ 仍然/ 是/ 不可/ 回避/ 的/ 研究课题/ [/ 3/ -/ 4/ ]/ ./ BGP/ 路由/ 协议/ 的/ 安全/ 问题/ 主要/ 包括/ BGP/ 会话/ 安全/ 、/ 前缀/ 源地址/ 认证/ 和/ AS/ _/ PATH/ 路由/ 属性/ 信息/ 的/ 真实性/ 和/ 完整性/ 认证/ 等/ 问题/ ./ AS/ _/ PATH/ 路由/ 属性/ 是/ BGP/ 最/ 重要/ 的/ 属性/ 之一/ ,/ 其/ 主要/ 任务/ 是/ 按/ 顺序/ 记录/ 一条/ BGP/ 路由/ 从源/ AS/ 到/ 目的/ AS/ 所/ 经过/ 的/ 路径/ ,/ 且/ 可以/ 用于/ 避免/ 环路/ ,/ 提供/ 选路/ 标准/ ./ 若/ AS/ _/ PATH/ 路由/ 属性/ 信息/ 未/ 得到/ 安全/ 保护/ ,/ 将会/ 遭到/ 篡改/ 攻击/ 而/ 引起/ 路由/ 欺骗/ 、/ 窃取/ 秘密/ 信息/ 和/ 流量/ 以及/ 路由/ 黑洞/ 等/ 危及/ 网络空间/ 安全/ 的/ 严重/ 安全事件/ ./ 因此/ ,/ AS/ _/ PATH/ 路由/ 属性/ 的/ 保护/ 是/ BGP/ 安全/ 研究/ 中/ 首先/ 需要/ 解决/ 的/ 关键问题/ 之一/ ./ 在/ AS/ _/ PATH/ 路由/ 属性/ 信息/ 保护/ 的/ 研究/ 过程/ 中/ ,/ 首先/ 要/ 认识/ 到/ 在/ BGP/ 上/ 部署/ 任何/ 安全/ 机制/ 都/ 会/ 对/ 其/ 工作/ 性能/ 造成/ 影响/ 这个/ 事实/ ./ 因此/ ,/ 所/ 研究/ 的/ AS/ _/ PATH/ 路由/ 属性/ 信息/ 保护/ 机制/ 需/ 满足/ 容易/ 部署/ 且/ 能/ 提供/ 安全/ 保护/ 的/ 功能/ ./ 所谓/ 容易/ 部署/ 是/ 指/ 要求/ 所/ 部署/ 的/ 安全/ 机制/ 能/ 尽量减少/ 对/ BGP/ 工作/ 性能/ 的/ 影响/ ,/ 如能/ 考虑/ 到/ 存储/ 和/ 资源/ 开销/ 、/ 路由/ 收敛/ 时间/ 影响/ 以及/ 可扩展性/ 等/ ;/ 安全/ 保护/ 要求/ 所/ 部署/ 的/ 安全/ 机制/ 确实/ 能/ 保护/ AS/ _/ PATH/ 路由/ 属性/ 信息/ 的/ 完整性/ 和/ 真实性/ ./ 针对/ BGP/ 存在/ 更新/ 报文/ AS/ _/ PATH/ 路由/ 属性/ 的/ 安全/ 问题/ 的/ 研究/ ,/ 目前/ 已有/ 很多/ 研究成果/ ,/ 大致/ 可/ 分为/ 基于/ 密码学/ 技术/ 的/ 保护/ 机制/ [/ 5/ -/ 10/ ]/ 、/ 非/ 基于/ 密码学/ 技术/ 的/ 保护/ 机制/ [/ 11/ -/ 16/ ]/ 以及/ 这/ 两种/ 机制/ 的/ 整合/ 机制/ [/ 17/ ]/ ./ 尽管/ 这些/ 方案/ 具有/ 很/ 高/ 的/ 理论/ 研究/ 价值/ 和/ 实际意义/ ,/ 但/ 在/ 现有/ 的/ 众多/ 方案/ 中/ ,/ 容易/ 部署/ 的/ 安全/ 方案/ 未能/ 很/ 好/ 的/ 解决/ BGP/ 路由/ 安全/ 问题/ ;/ 安全/ 强度/ 高/ 的/ 方案/ 又/ 因/ 计算能力/ 和/ 存储资源/ 等/ 问题/ 而/ 难以/ 部署/ 于/ 互联网/ 中/ ./ 如/ 路由/ 检测/ 方案/ [/ 11/ ]/ ,/ 虽然/ 引入/ 了/ 异常/ 检测/ 机制/ ,/ 但/ 检测/ 结果/ 本身/ 存在/ 一定/ 的/ 不确定性/ ,/ 因而/ 很难/ 得到/ 更/ 准确/ 的/ 安全/ 保证/ ;/ 而/ S/ -/ BGP/ 协议/ [/ 5/ ]/ 利用/ 基于/ 证书/ 和/ 数字签名/ 机制/ 给出/ 了/ AS/ _/ PATH/ 路由/ 属性/ 的/ 保护/ 方案/ ,/ 提供/ 了/ 很/ 好/ 的/ 完整性/ 和/ 真实性/ 保护/ 功能/ ,/ 但/ 其/ 所用/ 的/ 部分/ 密码/ 组件/ 运算/ 较为/ 复杂/ ,/ 且/ 增加/ 证书/ 管理负担/ 和/ 存储/ 开销/ ./ 另外/ ,/ 现有/ 的/ 方案/ 均/ 未/ 给出/ 在/ 标准/ 模型/ 或/ 随机/ 预言/ 机/ 模型/ 下/ 的/ 安全/ 证明/ ./ 因此/ ,/ 研究/ 既/ 易于/ 部署/ 又/ 能/ 提供/ 很/ 好/ 安全/ 保护/ 的/ 可/ 证明/ 安全/ 的/ BGP/ 协议/ AS/ _/ PATH/ 路由/ 属性/ 安全/ 机制/ 具有/ 重要/ 的/ 理论/ 价值/ 和/ 实际意义/ ,/ 这/ 也/ 是/ 路由/ 协议/ 安全/ 方面/ 的/ 一个/ 研究/ 方向/ ./ 密码学/ 理论/ 具有/ 保护/ 信息/ 完整性/ 和/ 真实性/ 的/ 良好/ 属性/ ./ 同时/ ,/ 根据/ 不同/ 的/ 应用/ 场合/ 和/ 需求/ ,/ 利用/ 密码学/ 理论/ 可以/ 构造/ 出/ 满足/ 不同/ 应用/ 需求/ 的/ 轻量/ 型/ 的/ 密码/ 方案/ [/ 8/ ,/ 18/ -/ 19/ ]/ ./ 由于/ 目前/ 用于/ 保护/ BGP/ 协议/ 安全/ 的/ 公钥/ 密码保护/ 方案/ 大都/ 是/ 基于/ PKI/ 证书/ 的/ 设计方案/ (/ 如/ S/ -/ BGP/ 等/ )/ ,/ PKI/ 体系/ 是/ 集中式/ 的/ 架构/ ,/ 但/ BGP/ 是/ 分布式/ 的/ 工作/ 架构/ ,/ 若/ 采用/ 基于/ 证书/ 的/ 方案/ ,/ 不仅/ 需要/ 承担/ 证书/ 存储/ 开销/ ,/ 而且/ 使得/ BGP/ 的/ 部署/ 难以/ 扩展/ ./ 为此/ ,/ 我们/ 采用/ 基于/ 身份/ 的/ 思想/ ,/ 能够/ 避免/ 证书/ 的/ 使用/ ,/ 从而/ 能/ 使/ 我们/ 的/ 设计方案/ 无需/ 承担/ 证书/ 存储/ 开销/ ./ 同时/ ,/ 可/ 净化/ 签名/ 方案/ 的/ 优点/ 是/ 具有/ 允许/ 签名/ 的/ 文档/ 可以/ 指定/ 被/ 授权/ 者/ 不/ 需/ 与/ 消息/ 签名者/ 进行/ 交互/ 即可/ 修改/ 文档/ 指定/ 的/ 部分/ ,/ 且/ 修改/ 后/ 的/ 文档/ 的/ 签名/ 仍然/ 有效/ 的/ 属性/ ./ 因此/ ,/ 在/ BGP/ 协议/ 中/ ,/ 我们/ 采用/ 可/ 净化/ 签名/ 方案/ ,/ 在/ 更新/ 报文/ 过程/ 中/ ,/ 路由/ 属性/ 更新/ 者/ (/ AS/ )/ 不/ 需要/ 与/ 路由/ 前缀/ 拥有者/ ①/ RekhterY/ ,/ LiT/ ,/ HaresS/ ./ Abordergatewayprotocol4Page3/ 以及/ 上/ 一/ 跳/ 的/ 路由/ 属性/ 更新/ 者/ 进行/ 交互/ ,/ 就/ 可以/ 生成/ 更新/ 部分/ 的/ 有效/ 路由/ 属性/ 证明/ ,/ 并/ 直接/ 添加/ 到/ 原来/ 的/ 路由/ 属性/ 证明/ 中/ ,/ 无需/ 重新/ 对/ 整个/ AS/ _/ PATH/ 路由/ 属性/ 进行/ 签名/ ./ 因此/ ,/ 本文/ 采用/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ ,/ 在/ 标准/ 模型/ 下/ 提出/ 了/ 一种/ 可/ 证明/ 安全/ 的/ 保护/ BGPAS/ _/ PATH/ 路由/ 属性/ 的/ 安全/ 机制/ —/ —/ —/ IDSPV/ 机制/ (/ Identity/ -/ basedSanitizableSignaturePathVerification/ )/ ./ IDSPV/ 机制/ 利用/ AS/ 的/ 身份/ 作为/ AS/ 的/ 公开密钥/ ,/ 运用/ 可/ 净化/ 签名/ 的/ 特点/ ,/ 允许/ 被/ 授权/ 的/ AS/ 在/ 更新/ AS/ _/ PATH/ 报文/ 时/ ,/ 仅/ 需/ 对/ 自己/ 更新/ 的/ 部分/ 进行/ 签名/ ,/ 生成/ AS/ _/ PATH/ 路由/ 属性/ 证明/ ,/ 同时/ 能/ 确保/ 更新/ 后/ 的/ AS/ _/ PATH/ 路由/ 属性/ 证明/ 仍然/ 有效/ ./ 另外/ ,/ 我们/ 在/ 标准/ 模型/ 下/ 给出/ 了/ IDSPV/ 机制/ 的/ 安全/ 证明/ ./ IDSPV/ 机制/ 的/ 优点/ 有/ :/ (/ 1/ )/ IDSPV/ 机制/ 无需/ 证书/ 部署/ ,/ 从而/ 避免/ 证书/ 存储/ 和/ 管理/ 开销/ ;/ (/ 2/ )/ 在/ 更新/ 报文/ 时/ ,/ IDSPV/ 机制/ 无需/ 重新/ 对/ 整个/ AS/ _/ PATH/ 路由/ 属性/ 进行/ 签名/ ;/ (/ 3/ )/ IDSPV/ 机制/ 是/ 一种/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 机制/ ./ 目前/ 已有/ 的/ BGP/ 路由/ 保护/ 安全/ 机制/ 和/ 方案/ 均/ 不是/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ 机制/ 和/ 方案/ ./ 基于/ 上述/ 的/ 优点/ ,/ 在/ 低端/ 设备/ 的/ 存储/ 能力/ 和/ 计算能力/ 不断/ 提高/ 的/ 背景/ 下/ ,/ 与/ 现有/ 的/ BGP/ 保护/ 机制/ 和/ 方案/ 相比/ ,/ IDSPV/ 机制/ 更/ 具有/ 重要/ 的/ 理论意义/ 和/ 应用/ 价值/ ./ 本文/ 第/ 2/ 节/ 讨论/ BGP/ 协议/ 安全/ 保护/ 机制/ 的/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节/ 介绍/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 模型/ ,/ 提出/ 一种/ 采用/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 机制/ 保护/ BGP/ 协议/ AS/ _/ PATH/ 路由/ 属性/ 安全/ 的/ 机制/ ;/ 在/ 第/ 4/ 节中/ 给出/ 机制/ 的/ 安全/ 证明/ ;/ 第/ 5/ 节中/ 给出/ 机制/ 的/ 效率/ 分析/ ;/ 最后/ 在/ 第/ 6/ 节中/ 总结/ 全文/ 并/ 给出/ 进一步/ 的/ 工作/ 展望/ ./ 2/ 相关/ 研究/ 工作/ 目前/ ,/ 面向/ BGP/ 协议/ 在/ 更新/ 报文/ AS/ _/ PATH/ 路由/ 属性/ 方面/ 容易/ 部署/ 且/ 安全/ 强度/ 高/ 的/ 保护/ 机制/ 的/ 研究/ 工作/ 仍/ 在/ 不断/ 的/ 探索/ 之中/ ,/ 尚未/ 出现/ 成熟/ 且/ 系统化/ 的/ 方案/ ,/ 已有/ 相关/ 领域/ 的/ 研究/ 工作/ 概括/ 如下/ :/ 自从/ BGP/ 协议/ 提出/ 以后/ ,/ 其/ 安全/ 问题/ 得到/ 了/ 广泛/ 地/ 关注/ ./ 首先/ ,/ Kent/ 等/ 人/ 在/ 2000/ 年/ 提出/ S/ -/ BGP/ 协议/ [/ 5/ ]/ ,/ 其/ 思想/ 是/ 采用/ PKI/ 技术/ 来/ 确保/ 网络地址/ 前缀/ 和/ AS/ _/ PATH/ 路由/ 属性/ 的/ 真实性/ 和/ 完整性/ ,/ 通过/ 4/ 种/ “/ 证书/ ”/ 来/ 解决/ 路由/ 信息/ 的/ 安全/ 保护/ ,/ 但/ 未能/ 给出/ 安全/ 证明/ ,/ 而且/ 路由/ 资源/ 开销/ 较大/ ./ 随后/ ,/ 各种/ 基于/ 证书/ 和/ 密码/ 技术/ 的/ 保护/ 方案/ 相继/ 提出/ ./ Kranankis/ 等/ 人/ [/ 6/ ]/ 在/ S/ -/ BGP/ 优点/ 的/ 基础/ 上/ 提出/ 了/ psBGP/ ,/ 它/ 主要/ 利用/ 集中式/ 的/ 信任/ 模型/ 来/ 认证/ AS/ 号码/ ,/ 并/ 利用/ 分布式/ 的/ 信任/ 模型/ 来/ 验证/ IP地址/ 前缀/ 的/ 所有权/ ./ 在/ 网络地址/ 前缀/ 信任/ 方面/ ,/ 通过/ 邻居/ AS/ 的/ 信誉/ 评价/ 程度/ 来/ 刻画/ ,/ 但是/ 由于/ 网络/ 规模/ 很大/ ,/ 若/ 采用/ 证书/ 机制/ 来/ 确保/ 信任/ ,/ 将/ 严重/ 影响/ 路由/ 协议/ 的/ 正常/ 运行/ ,/ 同时/ 证书/ 的/ 管理/ 也/ 是/ 一个/ 很/ 刺手/ 的/ 问题/ ,/ 难于/ 部署/ ./ 胡/ 湘江/ 等/ 提出/ 的/ SE/ -/ BGP/ [/ 20/ ]/ ,/ 结合/ PKI/ 认证/ 中心/ ,/ 建立/ “/ 安全/ AS/ 联盟/ (/ SecureASAlliance/ )/ ”/ ,/ 以/ AS/ 联盟/ 为/ 单位/ 建立/ PKI/ 认证/ 中心/ ,/ 设计/ 一种/ 新/ 的/ BGP/ 安全/ 协议/ 机制/ ,/ 该/ 机制/ 采用/ 基于/ AS/ 联盟/ 的/ 安全/ 体系/ 架构/ ./ 并/ 提出/ 一种/ 分布式/ 的/ 转换/ 者/ 信任/ 模型/ (/ TranslatorTrustModel/ ,/ TTM/ )/ ,/ 只/ 需/ 局部/ 信息/ 就/ 可/ 进行/ 全局/ 认证/ ,/ 在/ 很大/ 程度/ 上/ 简化/ 了/ 证书/ 的/ 管理/ ./ 王娜/ 等/ 人/ [/ 7/ ]/ 提出/ 的/ 基于/ 身份/ 的/ 域间/ 路由/ 协议/ 安全/ 机制/ ,/ 进一步/ 简化/ 证书/ 使用/ 和/ 管理工作/ ./ 赵宸/ 等/ 人/ [/ 8/ ]/ 提出/ 的/ 一种/ 轻量化/ 的/ 边界/ 网关/ 协议/ 路径/ 验证/ 机制/ FTAPV/ (/ First/ -/ Two/ -/ ASbasedPathVerification/ )/ ,/ 主要/ 借助/ 人类/ 社会/ 中排/ 直线/ 队列/ 的/ 思想/ ,/ 通过/ 验证/ AS/ _/ PATH/ 中前/ 两个/ AS/ 的/ 签名/ 信息/ 的/ 有效性/ 来/ 确认/ 路径/ 信息/ 的/ 真实性/ ./ Raimagia/ 等/ 人/ [/ 9/ ]/ 提出/ 了/ 采用/ 对称/ 密码学/ 技术/ 对/ BGP/ 路由/ 信息/ 进行/ 加密/ 以/ 确保/ BGP/ 路由/ 信息/ 的/ 安全/ ,/ 其/ 核心思想/ 是/ 在/ 对/ 等/ BGP/ 实体/ 建立/ 连接/ 时/ ,/ 采用/ 一种/ 循环/ 移位/ 算法/ 来/ 产生/ 加密/ 密钥/ ,/ 并用/ SHA/ -/ 1/ 算法/ 对/ 密钥/ 求/ Hash/ 值/ ,/ 再/ 将/ 密钥/ 的/ Hash/ 值/ 通过/ open/ 消息/ 发给/ 邻居/ 对/ 等/ BGP/ 实体/ ./ 其/ 邻居/ 对/ 等/ BGP/ 实体/ 收到/ 密钥/ Hash/ 值后/ ,/ 也/ 利用/ 相同/ 的/ 循环/ 移位/ 算法/ 产生/ 密钥/ 并/ 生成/ 新/ 的/ 密钥/ Hash/ 值/ ,/ 再/ 与/ 接收/ 到/ 的/ 密钥/ Hash/ 值/ 进行/ 比较/ ,/ 若/ 匹配/ 则/ 建立/ 安全/ 连接/ ,/ 否则/ 中断/ ./ 该/ 方案/ 能/ 减少/ 签名/ 操作/ 次数/ 和/ 密钥/ 存储/ 需求/ ,/ 但/ 经常出现/ 未能/ 成功/ 连接/ 的/ 情况/ ./ 最近/ Boldyreva/ 等/ 人/ [/ 10/ ]/ 借鉴/ 密码学/ 中/ 可/ 证明/ 安全/ 理论/ 和/ 方法/ ,/ 提出/ 了/ 路径/ 向量/ 路由/ 协议/ 的/ 安全/ 模型/ ,/ 通过/ 规约/ 的/ 方法/ 给出/ S/ -/ BGP/ 的/ 安全/ 证明/ ,/ 指出/ S/ -/ BGP/ 未能/ 完全/ 满足/ 其所/ 提出/ 的/ 安全/ 模型/ 中/ 定义/ 的/ 三个/ 安全/ 目标/ ,/ 并/ 对/ S/ -/ BGP/ 进行/ 改进/ ,/ 是/ 开展/ BGP/ 协议/ 安全/ 机制/ 研究/ 的/ 关键/ 和/ 突破点/ ./ 3IDSPV/ 的/ BGP/ 协议/ 路径/ 属性/ 保护/ 机制/ 3.1/ 预备/ 知识/ 设阶均/ 为/ q/ 的/ 加法/ 群/ G1/ 和/ 乘法/ 群/ G2/ ,/ g/ 为/ G1/ 的/ 生成元/ ,/ 存在/ 映射/ e/ :/ G1/ ×/ G1/ →/ G2/ ,/ 具有/ 以下/ 性质/ :/ (/ 1/ )/ 双线性/ ./ 对于/ / a/ ,/ b/ ∈/ Ζ/ q/ ,/ P/ ,/ Q/ ∈/ G1/ ,/ 有/ Page4e/ (/ Pa/ ,/ Qb/ )/ =/ e/ (/ P/ ,/ Q/ )/ ab/ ;/ (/ 2/ )/ 非/ 退化/ 性/ ./ 存在/ P/ ,/ Q/ ∈/ G1/ ,/ 使得/ e/ (/ P/ ,/ Q/ )/ ≠/ 1/ ;/ (/ 3/ )/ 可计算性/ ./ / P/ ,/ Q/ ∈/ G1/ ,/ 存在/ 计算/ e/ (/ P/ ,/ Q/ )/ 的/ 有效/ 算法/ ./ 定义/ 1/ ./ 计算/ Diffie/ -/ Hellman/ (/ ComputationalDiffie/ -/ Hellman/ ,/ CDH/ )/ 问题/ :/ 已知/ 有限/ 的/ 加法/ 群/ G1/ ,/ 给定/ 元素/ g/ ,/ ga/ ,/ gb/ ∈/ G1/ ,/ 其中/ a/ ,/ b/ ∈/ / 未知/ ,/ 求/ gab/ ./ 定义/ 2/ ./ (/ ε/ ,/ t/ )/ -/ CDH/ 假定/ ./ 若/ 不/ 存在/ 任何/ 概率/ 多项式/ 算法/ 能/ 在/ 时间/ t/ 内/ ,/ 以/ 至少/ 概率/ 为/ ε/ 解决/ 群/ G1/ 上/ 的/ CDH/ 问题/ ,/ 则/ 称群/ G1/ 上/ 的/ (/ ε/ ,/ t/ )/ -/ CDH/ 假定/ 成立/ ./ 可知/ ,/ 在/ Diffie/ -/ Hellman/ 的/ 假设/ 下/ ,/ CDH/ 问题/ 是/ 一个/ 非常/ 困难/ 的/ 问题/ [/ 21/ ]/ ./ 3.2/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 模型/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 方案/ [/ 19/ ]/ (/ IDSSA/ )/ 具有/ 对/ 披露/ 文档/ 进行/ 认证/ 的/ 功能/ ,/ 主要/ 由/ 4/ 个/ 参与者/ 参与/ 操作/ :/ 私钥/ 生成器/ (/ PKG/ )/ 、/ 签名者/ (/ signer/ )/ 、/ 可/ 净化/ 者/ (/ sanitizer/ )/ 和/ 验证/ 者/ (/ verifier/ )/ ./ 一个/ IDSSA/ 方案/ 主要/ 由/ 5/ 个/ 步骤/ 组成/ :/ 系统/ 参数/ 建立/ (/ Setup/ )/ 、/ 密钥/ 抽取/ (/ Extract/ )/ 、/ 签名/ (/ Sign/ )/ 、/ 净化/ 签名/ (/ Sanitize/ )/ 和/ 验证/ (/ Verify/ )/ ./ 设/ ID/ =/ (/ ID1/ ,/ ID2/ ,/ …/ ,/ IDn/ )/ ∈/ {/ 0/ ,/ 1/ }/ λ/ ,/ M/ =/ (/ M1/ ,/ M2/ ,/ …/ ,/ Mn/ )/ ∈/ {/ 0/ ,/ 1/ }/ λ/ ,/ 给出/ 算法/ 定义/ 如下/ :/ (/ 1/ )/ 系统/ 参数/ 建立/ (/ Setup/ )/ ./ 给定/ 一个/ 安全/ 参数/ k/ ,/ 私钥/ 生成器/ (/ PKG/ )/ 生成/ 系统/ 参数/ params/ 和/ 主/ 密钥/ msk/ ,/ 其中/ params/ 公开/ ,/ msk/ 保密/ ./ (/ 2/ )/ 密钥/ 抽取/ (/ Extract/ )/ ./ 给定/ 一个/ 身份/ ID/ ,/ PKG/ 利用/ 主/ 密钥/ msk/ 计算/ ID/ 的/ 私有/ 密钥/ dID/ ,/ 并/ 将/ dID/ 通过/ 安全/ 信道/ 秘密/ 发送给/ 用户/ ID/ ./ (/ 3/ )/ 签名/ 运算/ (/ Sign/ )/ ./ 给定/ 系统/ 参数/ params/ ,/ 签名者/ 身份/ ID/ ,/ 消息/ M/ 以及/ 签名者/ 的/ 私钥/ dID/ ,/ 签名者/ 输出/ 签名/ σ/ 以及/ 秘密/ 信息/ ψ/ ./ (/ 4/ )/ 净化/ 运算/ (/ Sanitize/ )/ ./ 给定/ 系统/ 参数/ params/ ,/ 签名者/ 身份/ ID/ ,/ 秘密/ 信息/ ψ/ 以及/ 消息/ M/ 的/ 签名/ σ/ ./ 净化/ 者/ 输出/ 新/ 的/ 消息/ M/ 及其/ 签名/ σ/ ./ (/ 5/ )/ 验证/ 运算/ (/ Verify/ )/ ./ 给定/ 系统/ 参数/ params/ ,/ 签名者/ 身份/ IDi/ ,/ 以及/ 消息/ // 签名/ (/ Mi/ ,/ σ/ i/ )/ 和/ (/ Mi/ ,/ σ/ i/ )/ ,/ 利用/ 签名/ 验证/ 算法/ 进行/ 验证/ ,/ 输出/ 有效/ “/ True/ ”/ 或/ 无效/ “/ False/ ”/ ./ 3.3/ 安全/ 模型/ 针对/ 目前/ AS/ _/ PATH/ 路由/ 属性/ 已有/ 的/ 攻击方式/ ,/ 我们/ 给出/ 安全/ 模型/ ./ 在/ 所/ 给/ 的/ 安全/ 模型/ 中/ ,/ 假定/ 攻击者/ 拥有/ 很强/ 的/ 攻击/ 条件/ 和/ 能力/ ,/ 既/ 能/ 知道/ 网络/ N/ 的/ 拓扑/ ,/ 同时/ 能/ 根据/ 自己/ 的/ 攻击/ 需要/ 来/ 腐化/ 除了/ 攻击/ 对象/ 之外/ 的/ 任意/ AS/ ./ 而且/ 攻击者/ 能/ 代表/ 已/ 被/ 腐化/ 的/ AS/ 执行/ 任意/ 攻击行为/ ,/ 可以/ 修改/ 路由/ 宣告/ 中/ 的/ AS/ _/ PATH/ 路径/ 属性/ ,/ 例如/ 在/ AS/ _/ PATH/ 路由/ 属性/ 中/ 增减/ AS/ ./ 在/ 攻击/ 过程/ 中/ ,/ 假定/ 挑战者/ C/ 和/ 攻击者/ A/ 之间/ 进行/ 如下/ 的/ 交互/ 游戏/ :/ (/ 1/ )/ 参数/ 建立/ ./ 给定/ 一个/ 安全/ 参数/ k/ ,/ 挑战者/ C/ 利用/ 私钥/ 生成器/ (/ PKG/ )/ 生成/ 系统/ 参数/ params/ 和/ 主/ 密钥/ msk/ ./ 并/ 将/ params/ 发送给/ 攻击者/ A/ ,/ msk/ 保密/ ./ (/ 2/ )/ 请求/ ./ 攻击者/ A/ 进行/ 有/ 界/ 多项式/ 次数/ 的/ 请求/ ,/ 而且/ 每次/ 请求/ 都/ 是/ 有/ 记忆/ 、/ 自/ 适应/ 的/ ./ 具体/ 如下/ :/ ①/ 密钥/ 抽取/ 请求/ ./ 攻击者/ A/ 指定/ 一个/ 身份/ 为/ ID/ 的/ AS/ ,/ 挑战者/ C/ 运行/ 密钥/ 抽取/ 算法/ 得到/ 身份/ 为/ ID/ 的/ AS/ 的/ 私钥/ dID/ ,/ 并/ 将/ dID/ 发送给/ 攻击者/ A/ ;/ ②/ 签名/ 请求/ ./ 攻击者/ A/ 指定/ 一个/ 身份/ 为/ ID/ 的/ AS/ 以及/ 路由/ 属性/ 消息/ M/ 以及/ 签名者/ 的/ 私钥/ dID/ ,/ 挑战者/ C/ 运行/ 密钥/ 抽取/ 算法/ 和/ 签名/ 算法/ 得到/ (/ ID/ ,/ M/ )/ 的/ 签名/ σ/ 并/ 发给/ 攻击者/ A/ ./ (/ 3/ )/ 伪造/ ./ 攻击者/ A/ 能/ 成功/ 宣告/ 关于/ 一个/ 身份/ 为/ ID/ 的/ AS/ 对/ 自己/ 更新/ 的/ 路由/ 信息/ AS/ _/ PATH/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ AS/ )/ 及其/ 签名/ σ/ ,/ 使得/ ①/ 攻击者/ A/ 未/ 进行/ 过/ 关于/ 身份/ 为/ ID/ 的/ AS/ 私/ ②/ 攻击者/ A/ 未/ 对/ AS/ _/ PATH/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ AS/ )/ 进行/ 过/ 签名/ 请求/ ;/ ③/ 攻击者/ A/ 所/ 宣告/ 的/ AS/ _/ PATH/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ AS/ )/ 及其/ 签名/ σ/ 有效/ ,/ 即使/ 得/ 未/ 腐化/ 的/ AS/ 接收/ 到/ 该/ 路由/ 属性/ 时/ 认为/ 是/ 有效/ 的/ 路径/ ./ 若/ 攻击者/ A/ 成功/ 伪造/ 有效/ 的/ AS/ _/ PATH/ 路由/ 属性/ 证明/ ,/ 则/ 其/ 可以/ 解决/ CDH/ 问题/ 的/ 实例/ ./ 3.4/ IDSPV/ 保护/ 机制/ 3.4/ ./ 1IDSPV/ 机制/ 原理/ 本文/ 提出/ 的/ IDSPV/ 机制/ 和/ S/ -/ BGP/ 的/ 目标/ 一样/ ,/ 主要/ 用于/ 保护/ AS/ _/ PATH/ 路由/ 属性/ 的/ 完整性/ 和/ 真实性/ 以及/ 前缀/ 地址/ 的/ 真实性/ ./ 我们/ 利用/ 上面/ 提到/ 的/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 方案/ 模型/ ,/ 提出/ 了/ 一种/ 简称/ 为/ IDSPV/ 的/ BGP/ 路由/ 协议/ AS/ _/ PATH/ 路由/ 属性/ 保护/ 机制/ ./ IDSPV/ 机制/ 的/ 工作/ 流程/ 如下/ :/ (/ 1/ )/ 系统/ 初始化/ ./ 包括/ 系统/ 参数/ 建立/ 和/ 每个/ AS/ 及其/ 相应/ 的/ BGP/ 路由器/ 密钥/ 的/ 生成/ 阶段/ ./ (/ 2/ )/ 路由/ 更新/ ./ 更新过程/ 包括/ 添加/ 路由/ 、/ 路由/ 属性/ 证明/ 生成/ 、/ 路由/ 属性/ 证明/ 验证/ 3/ 个/ 主要/ 操作/ ,/ 具体操作/ 流程/ 如图/ 1/ 所示/ ./ 在/ 路由/ 更新过程/ 中/ ,/ 主要/ 分/ 如下/ 两种/ 情况/ 来/ 实现/ :/ 钥/ 抽取/ 请求/ ;/ Page5/ / 图/ 1IDSPV/ 机制/ 工作/ 流程/ 当/ |/ AS/ _/ PATH/ |/ =/ 0/ 时/ ,/ 意味着/ 由/ 拥有/ IP地址/ 前缀/ 的/ AS/ 发起/ 路由/ 宣告/ ./ 首先/ 将/ 自己/ 的/ AS/ 号/ (/ ASNumber/ ,/ ASN/ )/ 以及/ 下/ 一/ 跳/ 的/ AS/ 号/ 添加/ 到/ AS/ _/ PATH/ 中/ ;/ 其次/ 利用/ 自己/ 的/ 私钥/ dID/ 对/ AS/ _/ PATH/ 路由/ 信息/ 进行/ 签名/ ,/ 生成/ 路由/ 属性/ 证明/ ./ 并/ 将/ 生成/ 的/ AS/ _/ PATH/ 路由/ 信息/ 和/ 路由/ 属性/ 证明/ 传递/ 给/ 下/ 一/ 跳/ 信任/ 的/ 邻居/ AS/ ./ 当/ |/ AS/ _/ PATH/ |/ / 1/ 时/ ,/ 表明/ AS/ 收到/ 上/ 一/ 跳/ AS/ 发来/ 的/ AS/ _/ PATH/ 路由/ 信息/ ./ 在/ 收到/ 路由/ 消息/ 后/ ,/ AS/ 首先/ 利用/ 上/ 一/ 跳/ AS/ 的/ 公钥来/ 验证/ 路由/ 属性/ 证明/ 的/ 真实性/ 和/ 有效性/ ;/ 其次/ ,/ 添加/ 下/ 一/ 跳/ 的/ AS/ 号/ 到/ AS/ _/ PATH/ 中/ ;/ 最后/ ,/ 利用/ 可/ 净化/ 签名/ 算法/ 对/ 更新/ 后/ 的/ AS/ _/ PATH/ 路由/ 信息/ 进行/ 签名/ ,/ 生成/ 新/ 的/ 路由/ 属性/ 证明/ ./ 再/ 将/ 新/ 的/ AS/ _/ PATH/ 路由/ 信息/ 及其/ 路由/ 属性/ 证明/ 发送给/ 下/ 一/ 跳/ 信任/ 的/ 邻居/ AS/ ./ 图/ 1/ 中/ |/ AS/ _/ PATH/ |/ 表示/ AS/ _/ PATH/ 的/ 长度/ ./ 所/ 涉及/ 的/ 函数/ 描述/ 如下/ :/ (/ 1/ )/ Add/ (/ AS/ _/ PATH/ ,/ ASN/ ,/ Next/ _/ ASNumber/ )/ ./ 表示/ 某个/ AS/ 将/ 自己/ 的/ AS/ 号/ ASN/ 以及/ 它/ 所/ 信任/ 的/ 下/ 一/ 跳/ AS/ 号/ Next/ _/ ASNumber/ 添加/ 到/ AS/ _/ PATH/ 中/ ./ (/ 2/ )/ Sig/ (/ AS/ _/ PATH/ ,/ dID/ )/ ./ 表示/ 某个/ AS/ 利用/ 自己/ 的/ 私钥/ dID/ 对要/ 宣告/ 的/ AS/ _/ PATH/ 进行/ 签名/ 生成/ 路由/ 属性/ 证明/ ./ (/ 3/ )/ Sig/ _/ San/ (/ AS/ _/ PATH/ ,/ dID/ )/ ./ 表示/ 某个/ AS/ 利用/ 自己/ 的/ 私钥/ dID/ 对/ 更新/ 后/ 的/ AS/ _/ PATH/ 进行/ 可/ 净化/ 签名/ 生成/ 新/ 的/ 路由/ 属性/ 证明/ ./ (/ 4/ )/ Ver/ (/ σ/ ,/ ID/ )/ ./ 表示/ 某个/ AS/ 利用/ 公钥/ ID/ 对/ / / )/ ./ 7C/ +/ 	/ / 5/ / / / C/ +/ / / / / / / ?/ / =/ LY/ /  / / / 0/ +/ / ;/ / / A/ */ 1/ 	/ PA1/ "/ PAC/ +/ / / A/ / ,/ / / / ;/ / / / / / (/ :/ 5/ \/ TILY/ / "/ #/ / / (/ :/ F7/ (/ ;/ // / / / / /  / / :/ PNF/ :/ HU/ / (/ :/ F7/ (/ ;/ // / / / ,/ C/ +/ / / A/ / 路由/ 属性/ 证明/ σ/ 的/ 真实性/ 和/ 有效性/ 进行/ 验证/ ./ 3.4/ ./ 2IDSPV/ 机制/ 实现/ 具体/ 实现/ 方法/ ./ 在/ 本节/ 中/ 主要/ 给出/ IDSPV/ 机制/ 中/ 每个/ 操作/ 的/ (/ 1/ )/ 系统/ 初始化/ 在/ 系统/ 初始化/ 阶段/ 中/ ,/ 主要/ 建立/ IDSPV/ 机制/ 的/ 系统/ ,/ 包括/ 系统/ 参数/ 建立/ 和/ 系统/ 中/ 每个/ AS/ 及其/ 相应/ 的/ BGP/ 路由器/ 密钥/ 生成/ ./ (/ 1/ )/ 系统/ 参数/ 建立/ ./ 给定/ 安全/ 参数/ k/ ,/ PKG/ 选取/ 阶为/ q/ 的/ 两个/ 群/ G1/ 和/ G2/ ,/ 一个/ 生成元/ g/ 以及/ 可/ 允许/ 的/ 双线性/ 配对/ e/ :/ G1/ ×/ G1/ →/ G2/ ./ 而后/ 随机/ 选取/ 整数/ q/ ,/ 计算/ g1/ =/ g/ α/ 并/ 选取/ g2/ ∈/ G1/ ./ PKG/ 选择/ 两个/ α/ ∈/ / / 元素/ u/ ,/ m/ ∈/ G1/ 以及/ 两个/ 含有/ n/ 个/ 元素/ 的/ 向量/ 犝/ =/ (/ ui/ )/ ,/ 犞/ =/ (/ vi/ )/ ,/ 其中/ 向量/ 的/ 元素/ 均/ 随机/ 取自/ 于群/ G1/ ./ 从而/ 得到/ 系统/ 参数/ 为/ params/ =/ (/ G1/ ,/ G2/ ,/ e/ ,/ q/ ,/ g/ ,/ g1/ ,/ g2/ ,/ u/ ,/ m/ ,/ 犝/ ,/ 犞/ )/ ,/ 以及/ 系统/ 主/ 密钥/ 为/ g/ α/ (/ 2/ )/ BGP/ 路由器/ 密钥/ 生成/ ./ 每个/ 路由器/ 将/ 自己/ 的/ 身份/ 信息/ IDi/ =/ Hash/ (/ IPR/ (/ i/ )/ ‖/ ASi/ ‖/ ti/ )/ 做/ 为/ 自己/ 的/ 公钥/ ,/ 将/ IDi/ 表示/ 为/ IDi/ =/ {/ ID1/ 并/ 发给/ PKG/ ,/ 其中/ IPR/ (/ i/ )/ 为/ ASi/ 中/ 第/ i/ 个/ 边界/ 路由器/ 的/ IP地址/ 或/ MAC/ 地址/ ,/ ASi/ 为/ 第/ i/ 个/ 边界/ 路由器/ 所属/ 的/ 第/ i/ 个/ AS/ 域/ ;/ ti/ 为/ BGP/ 路由器/ 公钥/ 的/ 有效期/ ./ 其/ 私钥/ dIDi/ 生成/ 如下/ :/ PKG/ 随机/ 选取/ 一个/ 整数/ rIDi/ ,/ 并/ 按式/ (/ 1/ )/ 计算/ :/ dIDi/ =/ (/ d/ (/ 1/ )/ 其中/ j/ =/ 1/ ,/ 2/ ,/ …/ ,/ n/ ./ 此步/ 中/ 包括/ 宣告/ 前缀/ 消息/ 签名/ Page6AS/ 的/ 公钥/ 、/ 宣告/ 前缀/ 消息/ 签名/ AS/ 的/ 私钥/ 、/ 更新/ AS/ _/ PATH/ 的/ AS/ 公钥/ 以及/ 更新/ AS/ _/ PATH/ 的/ AS/ 私钥/ 的/ 生成/ ./ 限于/ 篇幅/ ,/ 我们/ 这里/ 不/ 做/ 详细/ 地/ 说明/ ./ (/ 2/ )/ 路由/ 更新/ 在/ 路由/ 更新/ 阶段/ 中/ ,/ 主要/ 给/ 出路/ 由/ 属性/ 证明/ 生成/ 、/ 路由/ 属性/ 证明/ 验证/ 的/ 3/ 个/ 操作/ :/ Sig/ (/ AS/ _/ PATH/ ,/ dID/ )/ 、/ Sig/ _/ San/ (/ AS/ _/ PATH/ ,/ dID/ )/ 、/ Ver/ (/ σ/ ,/ ID/ )/ 的/ 实现/ ./ ①/ 源/ 路由/ 宣告/ 的/ 属性/ 证明/ 生成/ Sig/ (/ AS/ _/ PATH/ ,/ dID/ )/ 函数/ 实现/ ,/ 即/ 生成/ 路由/ 属性/ 证明/ (/ AS/ _/ PATH/ 路径/ 签名/ ,/ 文后/ 涉及/ 到/ 的/ 签名/ 均/ 指路/ 由/ 属性/ 证明/ )/ ./ 假定/ 源/ 路由/ 宣告/ (/ 前缀/ )/ 的/ 发起者/ 为/ AS1/ ,/ 其/ 发布/ 路由/ 通告/ 信息/ NLRI/ (/ IP1/ )/ ,/ 并/ 通过/ 其/ 路由器/ 将/ 该/ 信息/ 发送给/ 其/ 信任/ 的/ 邻居/ AS/ ,/ 这样/ 的/ AS/ 可能/ 有/ 很多/ 个/ ./ 为了/ 方便/ 描述/ ,/ 我们/ 仅/ 讨论/ 一个/ AS/ 的/ 情形/ ,/ 同时/ 不/ 对/ AS/ 和/ 它/ 下面/ 负责/ 宣告/ 路由/ 信息/ 的/ BGP/ 路由器/ 作/ 区分/ ,/ 也/ 可/ 将/ 负责/ 宣告/ 路由/ 的/ BGP/ 路由器/ 看作/ 其/ 所在/ 的/ AS/ ./ 设/ 邻居/ AS/ 为/ AS2/ ,/ 并/ 生成/ AS/ _/ PATH/ 路径/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ )/ ,/ 同时/ 计算/ :/ H1/ =/ Hash/ (/ dID1/ ‖/ IP1/ ‖/ AS1/ ‖/ ID1/ )/ ;/ h1/ =/ Hash/ (/ H1/ ‖/ AS2/ ‖/ ID2/ )/ ,/ 并/ 将/ h1/ 分成/ n/ 份/ ,/ 表示/ 为/ h1/ =/ {/ h11/ ,/ h21/ ,/ …/ ,/ hn1/ }/ ,/ 其中/ Hash/ (/ )/ 为/ Hash/ 函数/ ./ AS1/ 随机/ 选取/ 一个/ 整数/ r/ -/ 计算/ AS/ _/ PATH/ 路由/ 属性/ 证明/ :/ ID1v/ ∏/ n/ σ/ 1/ =/ d/ (/ 1/ )/ ID1/ =/ gr/ -/ ID1/ ,/ σ/ 3/ =/ grID1/ σ/ 2/ =/ d/ (/ 2/ )/ 并/ 可/ 将/ NLRI/ (/ IP1/ )/ 、/ AS/ _/ PATH/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ )/ 、/ 路由/ 属性/ 证明/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 以及/ H1/ 一起/ 发给/ 信任/ 的/ 邻居/ AS2/ ./ ②/ 更新/ 路由/ 的/ 属性/ 证明/ 生成/ Sig/ _/ San/ (/ AS/ _/ PATH/ ,/ dID/ )/ 函数/ 实现/ ,/ 即下/ 一个/ AS/ 进行/ 的/ AS/ _/ PATH/ 路由/ 属性/ 证明/ ./ 在/ 实现/ 过程/ 中/ ,/ 我们/ 采用/ 可/ 净化/ 签名/ 技术/ ,/ 将/ 更新/ 的/ 路由/ 信息/ 部分/ 直接/ 添加/ 到/ 原来/ 的/ 路由/ 属性/ 证明/ σ/ 中/ ,/ 生成/ 新/ 的/ 路由/ 属性/ 证明/ ,/ 而且/ 保持/ 新/ 的/ 路由/ 属性/ 证明/ 有效/ ,/ 同时/ 起到/ 聚合/ 签名/ 的/ 作用/ ./ 以下/ 给出/ 具体/ 实现/ 过程/ ./ 当/ 邻居/ ASi/ 接收/ ASi/ -/ 1/ 发来/ 的/ 信息/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 以及/ Hi/ -/ 1/ 时/ ,/ 进行/ 如下/ 操作/ :/ (/ i/ )/ 首先/ 根据/ AS/ _/ PATH/ 信息/ 以及/ 自己/ 的/ 身份/ IDi/ 来/ 验证/ 路由/ 路径/ 证明/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 的/ 有效性/ ,/ 验证/ 方法/ 详见/ 路由/ 属性/ 证明/ 验证/ Ver/ (/ σ/ ,/ ID/ )/ 函数/ 的/ 实现/ ,/ 若/ 路由/ 证明/ 无效/ ,/ 则/ 丢弃/ 该/ 路由/ 信息/ ./ 否则/ 进入/ 下/ 一步/ ;/ (/ ii/ )/ 指定/ 要/ 更新/ 的/ 路由/ 属性/ 以及/ 下/ 一/ 跳/ 信任/ 的/ AS/ ./ ASi/ 在/ 自己/ 的/ 信任/ 邻居/ 列表/ 中/ 选取/ 信任/ 的/ AS/ ,/ 记为/ ASi/ +/ 1/ ,/ 以及/ 该域/ 的/ 身份/ IDi/ +/ 1/ ,/ 并/ 计算/ :/ 并/ 将/ hi/ 表示/ 为/ hi/ =/ {/ h1i/ ,/ h2i/ ,/ …/ ,/ hni/ }/ ;/ (/ iii/ )/ ASi/ 更新/ 自己/ 要/ 宣告/ 的/ AS/ _/ PATH/ 路由/ 属性/ 为/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ ASi/ +/ 1/ )/ ,/ 随机/ 选取/ 两个/ 整数/ r/ -/ 运算/ :/ 将/ NLRI/ (/ IP1/ )/ 、/ AS/ _/ PATH/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ ASi/ +/ 1/ )/ 、/ 路由/ 属性/ 证明/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 以及/ Hi/ 一起/ 发给/ 下/ 一个/ 信任/ 的/ 邻居/ ASi/ +/ 1/ ./ 如/ 步骤/ (/ iii/ )/ 中/ 所示/ ,/ ASi/ 仅/ 需/ 将要/ 宣告/ 的/ AS/ _/ PATH/ 路由/ 属性/ 中/ 的/ 更新/ 部分/ 的/ 路由/ 属性/ 证明/ 按式/ (/ 3/ )/ 添加/ 至/ 原来/ 的/ 路由/ 属性/ 证明/ 中/ ,/ 无需/ 重新/ 对/ 整个/ AS/ _/ PATH/ 路由/ 属性/ 进行/ 签名/ ./ (/ 3/ )/ 路由/ 属性/ 证明/ 验证/ Ver/ (/ σ/ ,/ ID/ )/ 函数/ 的/ 实现/ ./ 当/ 邻居/ ASi/ 接收/ ASi/ -/ 1/ 发来/ 的/ 信息/ NLRI/ (/ IP1/ )/ 、/ AS/ _/ PATH/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ )/ 、/ 路由/ 属性/ 证明/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 以及/ Hk/ -/ 1/ 时/ ,/ 进行/ 如下/ 计算/ :/ ①/ 对于/ 每/ 一个/ ASk/ ,/ 其中/ k/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ i/ }/ ,/ 计算/ Hash/ 值/ :/ hk/ =/ Hash/ (/ Hk/ -/ 1/ ‖/ ASk/ ‖/ IDk/ )/ ,/ 并/ 将/ hk/ 表示/ 为/ hk/ =/ {/ h1k/ ,/ h2k/ ,/ …/ ,/ hnk/ }/ ;/ ②/ 对于/ k/ ∈/ {/ 1/ ,/ 2/ ,/ …/ ,/ i/ }/ ,/ 判断/ 式/ (/ 4/ )/ 是否/ 成立/ :/ e/ (/ σ/ 1/ ,/ g/ )/ =/ e/ (/ g1/ ,/ g2/ )/ ∏/ i/ 若式/ (/ 4/ )/ 成立/ ,/ 意味着/ 接收/ 到/ 的/ 路由/ 信息/ 有效/ ./ e/ (/ σ/ 1/ ,/ g/ )/ =/ e/ σ/ 1u/ ∏/ n/ 正确性/ 分析/ :/ 由式/ (/ 4/ )/ 的/ 左边/ 等式/ 有/ Page7/ 因此/ ,/ 只要/ BGP/ 协议/ 遵循/ 上述/ 保护/ 机制/ ,/ 即可/ σ/ 2/ =/ g/ ∑/ i/ 保证/ AS/ _/ PATH/ 路由/ 属性/ 的/ 完整性/ 和/ 真实性/ ./ 4/ 安全性/ 分析/ 本/ 节/ 主要/ 对/ IDSPV/ 机制/ 的/ 安全性/ 进行/ 分析/ ./ 我们/ 利用/ 密码学/ 中/ 的/ 规约/ 技术/ 和/ 可/ 证明/ 安全/ 的/ 方法/ ,/ 给出/ IDSPV/ 机制/ 在/ 标准/ 模型/ 下/ 的/ 安全/ 证明/ ./ 定义/ 3/ ./ 假设/ 网络/ I/ 中/ 的/ AS/ 规模/ 大小/ 为/ N/ ,/ 称/ 攻击者/ A/ 是/ 一个/ 具有/ (/ t/ ,/ qe/ ,/ qs/ ,/ ε/ )/ 能力/ 的/ 攻击者/ :/ 在/ IDSPV/ 机制/ 中/ ,/ A/ 可以/ 进行/ qe/ 次/ 私钥/ 抽取/ 请求/ 和/ qs/ 次/ 的/ 签名/ 请求/ ,/ 在/ 运行/ 时间/ 为/ t/ 内能/ 以/ 不可/ 忽略/ 的/ 优势/ ε/ 成功/ 伪造/ 有效/ 的/ AS/ _/ PATH/ 路由/ 属性/ ./ 定义/ 4/ ./ 若/ IDSPV/ 机制/ 能/ 抵御/ 定义/ 了/ 的/ 攻击/ ,/ 则/ 称/ IDSPV/ 机制/ 为/ (/ t/ ,/ qe/ ,/ qs/ ,/ ε/ )/ 安全/ ./ 定理/ 1/ ./ 如果/ (/ ε/ ,/ t/ )/ -/ CDH/ 假定/ 成立/ ,/ 上述/ 的/ IDSPV/ 机制/ 是/ (/ t/ ,/ qe/ ,/ qs/ ,/ ε/ )/ 安全/ ./ 证明/ ./ 假定/ IDSPV/ 机制/ 不是/ (/ t/ ,/ qe/ ,/ qs/ ,/ ε/ )/ 安全/ ,/ 则/ 存在/ 一个/ 攻击者/ A/ ,/ A/ 进行/ qe/ 次/ 私钥/ 抽取/ 请求/ 和/ qs/ 次/ 的/ 签名/ 请求/ ,/ 在/ 运行/ 时间/ 为/ t/ 内能/ 以/ ε/ 的/ 优势/ 根据/ IDSPV/ 机制/ 的/ 步骤/ 能/ 成功/ 伪造/ 有效/ 的/ AS/ _/ PATH/ 路由/ 属性/ ./ 在/ 这样/ 的/ 假定/ 下/ ,/ 给定/ 群/ G1/ 和/ 它/ 的/ 生成元/ g/ ,/ 则/ 存在/ 一个/ 求解/ 算法/ B/ 能/ 在/ 运行/ 时间/ t/ 内以/ ε/ 的/ 优势/ 解决/ CDH/ 问题/ 的/ 一个/ 实例/ ,/ 即/ 在/ 收到/ ga/ 、/ gb/ 后/ ,/ 能/ 用/ 算法/ B/ 求解/ gab/ ,/ 其中/ 其中/ tG1/ 为群/ G1/ 中/ 指数/ 运算/ 所花/ 的/ 总/ 时间/ ./ 对于/ 给定/ 运行/ IDSPV/ 机制/ 的/ 网络/ I/ ,/ 而且/ 网络/ I/ 中/ 的/ AS/ 域/ 的/ 个数/ |/ AS/ |/ =/ N/ >/ 2/ ,/ 在/ 攻击/ 过程/ 中/ ,/ 算法/ B/ 充当/ 挑战者/ 的/ 角色/ 与/ 攻击者/ A/ 进行/ 交互/ ,/ 两者/ 掌握/ 共同/ 的/ 资源/ ,/ 在/ 攻击者/ A/ 能/ 攻击/ IDSPV/ 机制/ 成功/ 伪造/ 合法/ 的/ AS/ _/ PATH/ 路由/ 属性/ 时/ ,/ 算法/ B/ 也/ 能/ 成功/ 求解/ 攻击/ 场景/ 中/ 涉及/ 到/ 的/ 具体/ CDH/ 问题/ 的/ 一个/ 实例/ ./ 具体/ 攻击/ 步骤/ 如下/ :/ 首先/ ,/ 算法/ B/ 构造/ 用于/ 求解/ CDH/ 问题/ 实例/ 的/ 部分/ 数据/ 和/ 系统/ 参数/ ./ 随机/ 选取/ 以下/ 整数/ 和/ 参数/ :/ 整数/ ru/ 和/ rm/ ,/ 其中/ 要求/ 0/ </ ru/ </ q/ ,/ 0/ </ rm/ </ q/ ;/ 整数/ su/ 和/ sm/ ,/ 其中/ 要求/ 0/ </ su/ </ n/ ,/ 0/ </ sm/ </ n/ (/ ru/ (/ n/ +/ 1/ )/ </ q/ ,/ rm/ (/ n/ +/ 1/ )/ </ q/ )/ ;/ 令/ ru/ =/ 2/ (/ qe/ +/ qs/ )/ ,/ rm/ =/ 2qs/ ./ 整数/ x/ ∈/ / ru/ ,/ y/ ∈/ / rm/ ,/ z/ ∈/ / q/ ,/ w/ ∈/ / q/ ;/ n/ 维/ 向量/ (/ x1/ ,/ x2/ ,/ …/ ,/ xn/ )/ ,/ 其中/ xi/ ∈/ / ru/ ;/ n/ 维/ 向量/ (/ y1/ ,/ y2/ ,/ …/ ,/ yn/ )/ ,/ 其中/ yi/ ∈/ / rm/ ;/ n/ 维/ 向量/ (/ z1/ ,/ z2/ ,/ …/ ,/ zn/ )/ ,/ 其中/ zi/ ∈/ / q/ ;/ n/ 维/ 向量/ (/ w1/ ,/ w2/ ,/ …/ ,/ wn/ )/ ,/ 其中/ wi/ ∈/ / q/ ;/ 同时/ ,/ 对于/ 网络/ I/ 中/ 的/ 任意/ 身份/ 为/ ID/ / 的/ AS/ / ,/ 将/ 其/ 身份/ 表示/ 为/ ID/ / =/ {/ ID/ / 1/ ,/ ID/ / 2/ ,/ …/ ,/ ID/ / n/ }/ ,/ 并/ 构造/ 与/ 身份/ 为/ ID/ / 的/ AS/ / 相关/ 的/ AS/ _/ PATH/ 路由/ 信息/ AS/ / ‖/ ID/ / ,/ h/ / =/ Hash/ (/ AS/ / ‖/ ID/ / )/ ,/ 表示/ 为/ h/ / =/ {/ h/ / 1/ ,/ h/ / 2/ ,/ …/ ,/ h/ / n/ }/ ./ 利用/ 这些/ 信息/ 构造/ 如下/ 4/ 个/ 函数/ :/ 并/ 构造/ 以下/ 系统/ 参数/ :/ u/ =/ g/ -/ rusu/ +/ xu/ =/ g/ -/ rmsm/ +/ yuIDii/ =/ gF/ (/ ID/ )/ 且/ 有/ u/ ∏/ ni/ =/ 1/ 然后/ 将/ 网络/ I/ 以及/ 上面/ 的/ 信息/ 发给/ 攻击者/ A/ ./ 其次/ ,/ 在/ 攻击/ IDSPV/ 机制/ 过程/ 中/ ,/ 当/ 攻击者/ A/ 在/ 任何/ 时间/ 内/ 进行/ 询问/ AS/ 私钥/ 抽取/ oracle/ 和/ AS/ _/ PATH/ 签名/ oracle/ 时/ ,/ 算法/ B/ 给/ 以/ 如下/ 响应/ :/ (/ 1/ )/ 私钥/ 抽取/ 请求/ ./ 当/ 攻击者/ A/ 向/ 算法/ B/ 提交/ 关于/ 身份/ 为/ ID/ / 的/ AS/ / 的/ 私钥/ 抽取/ 请求/ 时/ ,/ 算法/ B/ 进行/ 如下/ 操作/ :/ ①/ 若/ F/ (/ ID/ / )/ =/ 0mod/ (/ ru/ )/ ,/ 则/ 算法/ B/ 终止/ 并/ 输出/ “/ 失败/ ”/ ;/ Page8/ 一个/ 整数/ rID/ / ∈/ / dID/ / =/ (/ d/ (/ 1/ )/ =/ (/ g/ -/ J/ (/ ID/ / )/ ②/ 若/ F/ (/ ID/ / )/ ≠/ 0mod/ (/ ru/ )/ ,/ 则/ 算法/ B/ 随机/ 选取/ 并/ 将/ 身份/ 为/ ID/ / 的/ AS/ / 的/ 私钥/ (/ d/ (/ 1/ )/ 击者/ ./ 由于/ ID/ / =/ g/ -/ J/ (/ ID/ / )/ d/ (/ 1/ )/ ID/ / =/ g/ -/ 1d/ (/ 2/ )/ 其中/ 狉/ ID/ / =/ rID/ / -/ a/ 因此/ 所/ 构造/ 的/ 私钥/ (/ d1/ ,/ d2/ )/ 是/ 有效/ 的/ ./ (/ 2/ )/ AS/ _/ PATH/ 路由/ 属性/ 证明/ (/ 签名/ )/ 请求/ ./ 当/ 攻击者/ A/ 向/ 签名/ oracles/ 提出/ 关于/ 身份/ 为/ ID/ / 的/ AS/ / 生成/ 的/ AS/ _/ PATH/ 路由/ 属性/ 证明/ ,/ 即/ 对/ 自己/ 更新/ 的/ 路由/ 属性/ 的/ 签名/ ./ 自己/ 更新/ 的/ 路由/ 信息/ 就是/ 所/ 信任/ 的/ 下/ 一/ 跳/ 的/ AS/ 域/ 及其/ 身份/ ID/ ,/ 记为/ AS/ ‖/ ID/ ./ 算法/ B/ 操作/ 如下/ :/ ①/ 若/ F/ (/ ID/ / )/ ≠/ 0mod/ (/ ru/ )/ ,/ 算法/ B/ 调用/ 前面/ 给出/ 的/ 私钥/ 抽取/ 请求/ 来/ 构造/ 身份/ 为/ ID/ / 的/ AS/ / 的/ 私钥/ ,/ 再用/ 私钥/ 对/ 更新/ 的/ AS/ _/ PATH/ 信息/ 进行/ 签名/ 即可/ ;/ ②/ 若/ F/ (/ ID/ / )/ =/ 0mod/ (/ ru/ )/ 且/ K/ (/ h/ / )/ ≠/ 0mod/ (/ rm/ )/ ,/ 则/ 算法/ B/ 选取/ r/ ,/ r/ ∈/ / σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ i/ (/ )/ i/ (/ =/ u/ ∏/ n/ ③/ 若/ F/ (/ ID/ / )/ =/ 0mod/ (/ ru/ )/ 且/ K/ (/ h/ / )/ =/ 0mod/ (/ rm/ )/ ,/ 则/ 算法/ B/ 终止/ 并/ 输出/ “/ 失败/ ”/ ./ (/ 3/ )/ AS/ _/ PATH/ 路由/ 属性/ 证明/ (/ 签名/ )/ 伪造/ ./ 倘若/ 算法/ B/ 在/ 求解/ 过程/ 中未/ 终止/ ,/ 则/ 攻击者/ A/ 能/ 成功/ 输出/ 一个/ 身份/ 为/ ID/ 的/ AS/ 生成/ 的/ 路由/ 属性/ 证明/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ ,/ 从而/ 能/ 成功/ 伪造/ 有效/ 的/ AS/ _/ PATH/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ ,/ AS/ )/ ./ 最后/ ,/ 算法/ B/ 对/ CDH/ 问题/ 实例/ 进行/ 求解/ ./ 若/ F/ (/ ID/ )/ ≠/ 0mod/ (/ q/ )/ 且/ K/ (/ h/ )/ ≠/ 0mod/ (/ q/ )/ ,/ 算法/ B/ 终止/ 操作/ ./ 否则/ ,/ 若/ F/ (/ ID/ )/ =/ 0mod/ (/ q/ )/ 且/ K/ (/ h/ )/ =/ 0mod/ (/ q/ )/ ,/ 那么/ 算法/ B/ 可求/ 出/ CDH/ 问题/ 的/ 实例/ 的/ 一个/ 解为/ 为了/ 确保/ 算法/ B/ 能以/ 至少/ ε/ 的/ 概率/ 成功/ 解决/ CDH/ 问题/ 实例/ ,/ 算法/ B/ 需在/ 同时/ 满足/ 如下/ 3/ 个/ 事件/ 的/ 条件/ 下/ 进行/ :/ ①/ Evt1/ ./ 当/ 攻击者/ A/ 进行/ AS/ / 私钥/ 抽取/ 请求/ 时/ 算法/ B/ 不会/ 终止/ ,/ 即/ 要求/ F/ (/ ID/ / )/ ≠/ 0mod/ (/ ru/ )/ ;/ ②/ Evt2/ ./ 攻击者/ A/ 能/ 生成/ 身份/ 为/ ID/ 的/ AS/ 对/ 自己/ 更新/ 的/ 路由/ 信息/ 的/ 一个/ 有效/ 的/ 路由/ 属性/ 证明/ (/ 签名/ )/ σ/ =/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ ;/ 即/ 至少/ 要求/ K/ (/ h/ / )/ ≠/ 0mod/ (/ rm/ )/ ;/ ③/ Evt3/ ./ 路由/ 属性/ 证明/ 伪造/ 成功/ ,/ 同时/ 要求/ F/ (/ ID/ )/ =/ 0mod/ (/ q/ )/ 且/ K/ (/ h/ )/ =/ 0mod/ (/ q/ )/ ,/ 其中/ 1/ / i/ / n/ ./ 为了/ 便于/ 计算/ ,/ 定义/ Ui/ :/ F/ (/ ID/ / )/ ≠/ 0mod/ (/ ru/ )/ ;/ U/ / :/ F/ (/ ID/ )/ =/ 0mod/ (/ q/ )/ ;/ Vj/ :/ K/ (/ h/ / )/ ≠/ 0mod/ (/ rm/ )/ ;/ V/ / :/ K/ (/ h/ )/ =/ 0mod/ (/ q/ )/ ./ 则/ 算法/ B/ 成功/ 的/ 概率/ 等价/ 于/ Pr/ [/ Bsucc/ ]/ / Pr/ ∩/ qe/ +/ qs/ =/ Pr/ ∩/ qe/ +/ qs/ =/ Pr/ ∩/ qe/ +/ qs/ 式/ (/ 7/ )/ 、/ (/ 8/ )/ 均/ 由/ Ui/ 、/ U/ / 、/ Vj/ 、/ Vj/ 相互/ 独立/ 而/ 得到/ ,/ 其中/ Pr/ [/ U/ / ]/ 以及/ Pr/ [/ ∩/ qe/ +/ qsPr/ [/ U/ / ]/ =/ Pr/ [/ F/ (/ ID/ )/ =/ 0mod/ (/ q/ )/ ∧/ F/ (/ ID/ )/ =/ 0mod/ (/ ru/ )/ ]/ Pr/ ∩/ qe/ +/ qsi/ =/ 1U/ [/ ]/ i/ =/ 1/ -/ Pr/ ∪/ qe/ +/ qs/ 因此/ ,/ 我们/ 得到/ Pr/ ∩/ qe/ +/ qsi/ =/ 1Ui/ ∧/ U/ [/ 同理/ 可/ 得/ 从而/ 有/ Page9/ 得到/ ε/ 的/ 值/ 为/ 算法/ B/ 的/ 运行/ 时间/ 为/ 攻击者/ A/ 的/ 运行/ 时间/ 加上/ qE/ 次/ 私钥/ 询问/ 以及/ qS/ 次/ 签名/ 询问/ 的/ 响应/ 时间/ ,/ 且/ 将/ 攻击者/ A/ 的/ 伪造/ 签名/ 转化/ 为/ 解决/ CDH/ 问题/ 的/ 时间/ ./ 在/ 攻击/ 游戏/ 中/ ,/ 每次/ 私钥/ 抽取/ 询问/ 中/ ,/ 总共/ 进行/ 了/ 5/ 次群/ G1/ 中/ 的/ 指数/ 运算/ ;/ 每次/ 签名/ 询问/ 中/ 进行/ 了/ (/ 2N/ +/ 4/ )/ 次群/ G1/ 中/ 的/ 指数/ 运算/ ./ 因此/ 总/ 的/ 运行/ 时间/ 有/ 如下/ 关系/ :/ 其中/ ,/ tG1/ 是/ 群/ G1/ 中/ 指数/ 运算/ 所花/ 的/ 总/ 时间/ ./ 当然/ ,/ 在/ 算法/ B/ 的/ 模拟/ 过程/ 中/ ,/ 若/ 事件/ Xi/ :/ F/ (/ ID/ / )/ =/ 0mod/ (/ ru/ )/ 或者/ 事件/ Yj/ :/ F/ (/ ID/ / )/ =/ 0mod/ (/ ru/ )/ 且/ K/ (/ h/ / )/ =/ 0mod/ (/ rm/ )/ 发生/ ,/ 则/ 会/ 导致/ 攻击/ 失败/ 而/ 终止/ ./ 易知/ ,/ 攻击/ 失败/ 的/ 概率/ 为/ Pr/ ∪/ qei/ =/ 1Xi/ ∨/ ∪/ qsj/ =/ 1Y/ [/ 其中/ 式/ (/ 9/ )/ 的/ 结果/ 由/ Xi/ 、/ Yj/ 相互/ 独立/ 得到/ ,/ 式/ (/ 10/ )/ 根据/ 前面/ 的/ 参数设置/ 得到/ ./ 若/ N/ 、/ qe/ 和/ qs/ 都/ 很大/ 时/ ,/ 攻击者/ A/ 攻击/ 失败/ 的/ 概率/ 一定/ 程度/ 上/ 不/ 影响/ 我们/ 模拟/ 攻击/ 的/ 完成/ ./ 证毕/ ./ 假定/ 在/ 参与/ 路由/ 宣告/ 过程/ 中/ 的/ AS/ 既/ 是/ 签名者/ 又/ 是/ 可/ 净化/ 签名者/ ,/ 实际上/ 在/ IDSPV/ 机制/ 中/ 就是/ 如此/ ./ 任何/ AS/ 均/ 不能/ 修改/ 前面/ AS/ 所/ 更新/ 的/ 路由/ 属性/ ./ 具体/ 地/ ,/ 若/ 攻击者/ A/ 已/ 攻陷/ 了/ 自治/ 域/ ASi/ ,/ 攻击者/ A/ 能/ 篡改/ ASi/ 接收/ 到/ 的/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ )/ ,/ 则/ 意味着/ 我们/ 的/ 保护/ 机制/ 未能/ 达到/ 存在/ 不可/ 伪造/ 签名/ 安全/ ./ 因此/ 得出/ 如下/ 结论/ ./ 定理/ 2/ ./ 假定/ 存在/ 有/ 界/ 多项式/ 攻击者/ A/ 能/ 在/ 时间/ t/ 内/ 经过/ 至多/ qe/ 次/ 的/ 密钥/ 提取/ 询问/ 和/ qs/ 次/ 的/ 签名/ 询问/ 后以/ 优势/ ε/ 来/ 攻破/ IDSPV/ 机制/ 中/ AS/ _/ PATH/ 路由/ 属性/ 的/ 不可/ 改变/ 性/ ,/ 则/ 存在/ 一个/ 算法/ B/ 能/ 在/ 时间/ t/ 内以/ 优势/ ε/ 来/ 产生/ 一个/ 有效/ 的/ 签名/ ./ ASi/ -/ 1/ 的/ 私钥/ ,/ 并/ 获得/ 私钥/ (/ d/ (/ 1/ )/ ②/ 算法/ B/ 令/ 犱/ (/ 1/ )/ 证明/ ./ AS/ _/ PATH/ 路由/ 属性/ 的/ 不可/ 改变/ 性是/ 指/ 即使/ 攻击者/ A/ 未能/ 合法/ 地/ 将/ 路由/ 属性/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ ASi/ )/ 修改/ 为/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ AS/ / i/ )/ ,/ 即将/ ASi/ 替换/ 为/ AS/ / i/ ,/ 其中/ AS/ / i/ 为/ 未/ 授权/ 的/ 自治/ 域/ ./ 若/ 攻击者/ A/ 将/ 接收/ 到/ 的/ 路由/ 属性/ 中/ 插入/ 路由/ 信息/ 如/ AS/ / i/ ,/ 则/ 更/ 改为/ (/ IP1/ ,/ AS1/ ,/ AS2/ ,/ …/ ,/ AS/ / i/ )/ ,/ 而且/ 更改/ 后/ 的/ 路由/ 属性/ 有效/ ,/ 意味着/ 算法/ B/ 可以/ 产生/ 一个/ 有效/ 的/ 路由/ 属性/ 证明/ (/ 签名/ )/ ./ 具体分析/ 如下/ :/ (/ 1/ )/ 参数/ 建立/ ./ 攻击者/ A/ 在/ 游戏/ 中/ 与/ 算法/ B/ 及其/ 挑战者/ C/ 进行/ 如下/ 交互/ :/ ①/ 算法/ B/ 向/ 挑战者/ C/ 提交/ 一个/ 请求/ ,/ 挑战者/ C/ 给/ 算法/ B/ 返回/ 系统/ 的/ 参数/ 如下/ (/ G1/ ,/ G2/ ,/ e/ ,/ q/ ,/ g/ ,/ g1/ ,/ g2/ ,/ u/ ,/ v/ ,/ u1/ ,/ …/ ,/ un/ ,/ v1/ ,/ …/ ,/ vn/ )/ ;/ ui/ =/ gti/ ,/ 并/ 添加/ 到/ 发给/ 算法/ B/ 的/ 系统/ 参数/ 之中/ ;/ vi/ =/ gsi/ ,/ 并/ 添加/ 到/ 发给/ 算法/ B/ 的/ 系统/ 参数/ 之中/ ./ 于/ 身份/ 为/ IDi/ 的/ ASi/ 的/ 私钥/ ,/ 算法/ B/ 如下/ 响应/ :/ ②/ 对于/ i/ =/ 1/ ,/ …/ ,/ n/ ,/ 算法/ B/ 选择/ ti/ ∈/ / ③/ 对于/ i/ =/ 1/ ,/ …/ ,/ n/ ,/ 算法/ B/ 选择/ si/ ∈/ / (/ 2/ )/ 私钥/ 抽取/ 请求/ ./ 攻击者/ A/ 向/ 算法/ B/ 提交/ 关/ ①/ 算法/ B/ 向/ 挑战者/ C/ 请求/ 身份/ 为/ IDi/ -/ 1/ 的/ IDi/ -/ 1/ ,/ 并/ 将/ (/ 犱/ (/ 1/ )/ d/ (/ 2/ )/ (/ 3/ )/ 路由/ 属性/ 证明/ (/ 签名/ )/ 请求/ ./ 当/ 攻击者/ A/ 向/ 算法/ B/ 提交/ 关于/ 身份/ IDi/ 的/ ASi/ 对/ 路由/ 信息/ ASi/ +/ 1/ ‖/ IDi/ +/ 1/ 的/ 路由/ 属性/ 证明/ (/ 签名/ )/ 询问/ 时/ ,/ 算法/ B/ 进行/ 如下/ 操作/ :/ ①/ 算法/ B/ 计算/ Hi/ =/ Hash/ (/ 犱/ IDi/ ‖/ ASi/ ‖/ IDi/ )/ ,/ h/ =/ Hash/ (/ Hi/ ‖/ ASi/ +/ 1/ ‖/ IDi/ +/ 1/ )/ ,/ 并/ 将/ h/ 表示/ 为/ h/ =/ {/ h1/ ,/ h2/ ,/ …/ ,/ hn/ }/ ;/ ②/ 算法/ B/ 向/ 挑战者/ C/ 询问/ 关于/ 身份/ IDi/ -/ 1/ 的/ ASi/ -/ 1/ 对/ 路由/ 信息/ ASi/ ‖/ IDi/ 的/ 路由/ 属性/ 证明/ ,/ 并/ 得到/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ ;/ 攻击者/ A/ ./ ③/ 算法/ B/ 令/ σ/ 1/ =/ σ/ 1/ ·/ σ/ IDiti2/ ∏/ n/ ④/ 算法/ B/ 将/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ ∪/ (/ σ/ h1si3/ ,/ …/ ,/ σ/ hnsi3/ )/ 发给/ (/ 4/ )/ 路由/ 属性/ 证明/ (/ 签名/ )/ 伪造/ ./ 假定/ 攻击者/ A/ 能/ 输出/ 一个/ 由/ 身份/ ID/ ⌒/ 的/ AS/ ⌒/ 对/ 相关/ 的/ AS/ _/ PATH/ 路由/ 信息/ AS/ ‖/ ID/ 的/ 一个/ 有效/ 路由/ 属性/ 证明/ (/ σ/ ^/ 1/ ,/ σ/ ^/ 2/ ,/ σ/ ^/ 3/ )/ ,/ 则/ 算法/ B/ 在/ 攻击者/ A/ 伪造/ 的/ 签名/ 的/ 基础/ 上/ 也/ 能/ 获得/ 一个/ 有效/ 路由/ 属性/ 证明/ ,/ 具体/ 如下/ :/ ①/ 攻击者/ A/ 将/ 路由/ 相关/ 信息/ AS/ ‖/ ID/ 及其/ 路/ Page10/ 由/ 属性/ 证明/ (/ σ/ ^/ 1/ ,/ σ/ ^/ 2/ ,/ σ/ ^/ 3/ )/ 发给/ 算法/ B/ ,/ 其中/ AS/ ‖/ ID/ 不是/ ASi/ 指定/ 的/ 合法/ 消息/ ./ ②/ B/ 构造/ 身份/ 为/ ID/ / 的/ AS/ / i/ 对/ 相关/ 的/ AS/ _/ PATH/ 路由/ 信息/ AS/ / ‖/ ID/ / 的/ 有效/ 路由/ 属性/ 证明/ ,/ 其中/ AS/ / ‖/ ID/ / 不是/ ASi/ 指定/ 的/ 合法/ 消息/ ./ 具体/ 计算/ 如下/ :/ 很/ 容易/ 验证/ ,/ σ/ / =/ (/ σ/ / 1/ ,/ σ/ / 2/ ,/ σ/ / 3/ )/ 是/ 身份/ 为/ ID/ / 的/ AS/ / i/ 对/ 相关/ 的/ AS/ _/ PATH/ 路由/ 信息/ AS/ / ‖/ ID/ / 的/ 有效/ 路由/ 属性/ 证明/ ./ 从/ 定理/ 1/ 的/ 证明/ 可知/ ,/ 算法/ B/ 能/ 求解/ CDH/ 问题/ 的/ 一个/ 实例/ ./ 显然/ ,/ 算法/ B/ 成功/ 伪造/ 有效/ 路由/ 属性/ 证明/ 的/ 前提条件/ 是/ 攻击者/ A/ 能/ 改变/ 了/ IDSPV/ 机制/ 的/ AS/ _/ PATH/ 路由/ 属性/ 的/ 不可/ 改变/ 性/ ,/ 因此/ B/ 成功/ 的/ 概率/ ε/ / ε/ ./ 同时/ ,/ 算法/ B/ 运行/ 的/ 时间/ t/ 等于/ 攻击者/ A/ 运行/ 的/ 时间/ t/ 再/ 加上/ 它/ 响应/ qe/ 次/ 的/ 密钥/ 提取/ 询问/ 和/ qs/ 次/ 的/ 签名/ 询问/ 所花/ 的/ 时间/ ./ 而/ 每次/ 密钥/ 抽取/ 询问/ 需要/ 算法/ B/ 在/ 群/ G1/ 中/ 进行/ n/ 次/ 的/ 指数/ 运算/ ;/ 每次/ 签名/ 询问/ 需要/ 算法/ B/ 在/ 群/ G1/ 中/ 进行/ 2n/ 次/ 的/ 指数/ 运算/ ./ 假定/ 群/ G1/ 中/ 进行/ 指数/ 运算/ 所花/ 的/ 时间/ 为/ te/ ,/ 则/ 有/ t/ =/ t/ +/ (/ n/ ·/ qe/ +/ 2n/ ·/ qs/ )/ ./ 5/ 效率/ 分析/ 针对/ 第/ 3/ 节/ 提出/ 的/ IDSPV/ 保护/ 机制/ ,/ 本/ 节/ 给出/ 了/ 存储/ 和/ 平均收敛/ 时间/ 两个/ 指标/ 的/ 效率/ 分析/ ./ 在/ 存储/ 方面/ ,/ 我们/ 主要/ 考虑/ 保护/ 机制/ 中/ 更新/ 路由/ 信息/ 的/ 大小/ 增量/ 以及/ 证书/ 存储/ 开销/ ;/ 在/ 平均收敛/ 时间/ 方面/ ,/ 主要/ 考虑/ 更新/ 路由/ 信息/ 总数/ 、/ 签名/ 运算/ 次数/ 及/ 所花/ 的/ 时间/ 以及/ 签名/ 验证/ 运算/ 次数/ 及/ 所花/ 的/ 时间/ ./ 在/ 测试/ 过程/ 中/ ,/ 所/ 采用/ 的/ 测试/ 网络/ 场景/ 参数/ 是/ :/ 假定/ 有/ m/ 个/ AS/ ,/ 每个/ AS/ 均/ 有/ a/ 个/ ASspeaker/ ,/ 且/ 与/ b/ 个/ AS/ 对/ 等/ 链接/ ,/ 同时/ 每个/ ASspeaker/ 发布/ c/ 个/ 前缀/ 信息/ ,/ 该/ 信息/ 传播/ 到/ 整个/ 网络/ ,/ 在/ 传播/ 过程/ 中/ 接收/ 到/ 宣告/ 信息/ 的/ AS/ 进行/ 更新/ ,/ 直至/ 路由/ 稳定/ 收敛/ ./ 5.1/ 存储/ 增量/ 在/ 考察/ 存储/ 增量/ 中/ ,/ 主要/ 考虑/ IDSPV/ 机制/ 和/ S/ -/ BGP/ 中/ 的/ 报文/ 长度/ 分别/ 比/ BGP/ 更新/ 报文/ 长度/ 的/ 增加量/ ./ 由于/ IDSPV/ 机制/ 采用/ 了/ 可/ 净化/ 签名/ 方案/ ,/ 在/ 更新/ 报文/ 中/ 增加/ 了/ 路由/ 属性/ 证明/ (/ σ/ 1/ ,/ σ/ 2/ ,/ σ/ 3/ )/ 属性/ ,/ 因此/ IDSPV/ 机制/ 中/ 的/ 更新/ 报文/ 长度/ 比/ BGP/ 协议/ 的/ 更新/ 报文/ 长度/ 约/ 增加/ 92.6/ 字节/ ./ 若/ 在/ 有限/ 域/ F397/ 上/ 进行/ ,/ 则/ IDSPV/ 机制/ 中/ 更新/ 报文/ 的/ 大小/ 增量/ 为/ Δ/ Update/ _/ IDSPV/ =/ 92.6/ (/ L/ / 1/ )/ ./ 而/ 采用/ 1024/ 比特/ 的/ RSA/ 算法/ 的/ S/ -/ BGP/ 中/ 更新/ 报文/ 的/ 大小/ 增量/ 为/ Δ/ Update/ _/ RSA/ =/ 128L/ ,/ FTAPV/ 机制/ 中/ 更新/ 报文/ 的/ 大小/ 增量/ 为/ Δ/ Update/ _/ FTAPV/ =/ 81/ (/ L/ / 1/ )/ ,/ 其中/ L/ 为/ BGP/ 中/ AS/ _/ PATH/ 的/ 长度/ ./ 图/ 2/ 所示/ 的/ 结果/ 是/ 随着/ AS/ _/ PATH/ 长度/ L/ 不断/ 增加/ ,/ IDSPV/ 机制/ 、/ FTAPV/ 机制/ 以及/ 采用/ 1024/ 比特/ 的/ RSA/ 机制/ 的/ S/ -/ BGP/ 中/ 更新/ 报文/ 长度/ 增量/ 的/ 变化/ ./ 图/ 2IDSPV/ 、/ S/ -/ BGP/ 和/ FTAPV/ 更新/ 报文/ 长度/ 增量/ 我们/ 从图/ 2/ 观察/ 到/ :/ S/ -/ BGP/ 机制/ 的/ 更新/ 报文/ 长度/ 增量/ 随着/ AS/ _/ PATH/ 长度/ L/ 不断/ 增加/ 而/ 增加/ ,/ 而/ IDSPV/ 机制/ 和/ FTAPV/ 机制/ 并未/ 发生变化/ ./ 尽管/ IDSPV/ 机制/ 中/ 更新/ 报文/ 新/ 增加/ 了/ 一个/ 属性/ ,/ 相当于/ 3/ 个/ 签名/ 长度/ ,/ 但/ 在/ 每次/ 生成/ 路由/ 属性/ 证明/ 过程/ 中/ 采用/ 可/ 净化/ 签名/ 技术/ ,/ 只/ 需/ 按照/ 3.4/ ./ 2/ 节/ 的/ 式/ (/ 4/ )/ 对/ 更新/ 的/ 报文/ 进行/ 聚合/ 添加/ ,/ 起到/ 了/ 聚合/ 签名/ 作用/ ,/ 占用/ 较少/ 的/ 存储空间/ ,/ 而且/ 增量/ 未/ 随着/ AS/ _/ PATH/ 长度/ L/ 的/ 变化/ 而/ 改变/ ./ 因此/ 采用/ IDSPV/ 机制/ 的/ 路由/ 更新/ 报文/ 增加/ 的/ 长度/ 比/ 采用/ RSA/ 机制/ 的/ S/ -/ BGP/ 的/ 路由/ 更新/ 报文/ 增加/ 的/ 长度/ 小/ ;/ 对于/ FTAPV/ 机制/ ,/ IDSPV/ 机制/ 报文/ 长度/ 增量/ 略/ 高/ ,/ 但/ 如/ 下面/ 表/ 1/ 所示/ ,/ IDSPV/ 机制/ 不/ 需要/ 存储/ 证书/ ./ 从/ 存储/ 开销/ 方面/ 来说/ ,/ 由于/ IDSPV/ 机制/ 主要/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 方案/ ,/ 避免/ 了/ 使用/ 证书/ ,/ 因此/ 不/ 需承担/ 证书/ 存储/ 开销/ ,/ 仅/ 需承担/ 系统/ 参数/ 和/ 更新/ 报文/ 长度/ 增量/ 的/ 存储/ 开销/ ./ 但/ 目前/ 基于/ 密码学/ 的/ BGP/ 路由/ 属性/ 保护/ 方案/ 多数/ 采用/ 了/ 证书/ ,/ 比如/ 在/ S/ -/ BGP/ 中/ ,/ 总/ 证书/ 规模/ 为/ N2/ ,/ 单个/ BGP/ 路由器/ 的/ 证书/ 规模/ 为/ N/ ;/ 在/ IDPV/ [/ 7/ ]/ 中/ ,/ 总/ 证书/ 规模/ 为/ 0.027/ N2/ ,/ 单个/ Page11/ 节点/ 证书/ 规模/ 为/ 0.027/ N/ ;/ 其中/ N/ 是/ 网络拓扑/ I/ 中/ 的/ AS/ 规模/ ;/ FTAPV/ [/ 8/ ]/ 中/ ,/ 总/ 证书/ 规模/ 为/ 珚/ O/ ×/ (/ 1/ +/ 珚/ O/ )/ ,/ 单个/ 节点/ 证书/ 规模/ 为/ 珚/ O/ ×/ (/ 1/ +/ 珚/ O/ )/ ×/ N/ ,/ 其中/ 珚/ O/ =/ avg/ _/ p/ ×/ (/ 1/ +/ avg/ _/ p/ )/ ,/ avg/ _/ p/ 为/ 每个/ AS/ 拥有/ 的/ 平均/ 邻居/ 数目/ ./ X/ ./ 509/ 证书/ 的/ 大小/ 约/ 为/ 600byte/ [/ 22/ ]/ ,/ 若/ N/ 很大/ 时/ ,/ 如/ CIDRReport/ ①/ 数据/ 给出/ ,/ 2014/ 年/ 2/ 月/ 14/ 日/ 在/ Internet/ 中约/ 有/ 46351/ 个/ AS/ ,/ 会/ 导致/ 每个/ BGP/ 路由器/ 承担/ 的/ 证书/ 存储/ 开销/ 很大/ ,/ 再/ 加上/ 承担/ 系统/ 参数/ 和/ 更新/ 报文/ 长度/ 增量/ 的/ 存储/ 开销/ ,/ 将会/ 占用/ 很多/ 的/ 路由器/ 存储空间/ ,/ 因而/ 影响/ BGP/ 路由器/ 的/ 工作/ 性能/ ./ 表/ 1/ 给出/ 各/ 方案/ 采用/ 证书/ 的/ 规模/ ./ 方案/ 每个/ 路由器/ 需/ 存储/ 的/ 证书/ 规模/ 全网/ 需/ 存储/ 的/ 证书/ 规模/ IDSPVFTAPV/ 珚/ O/ ×/ (/ 1/ +/ 珚/ O/ )/ IDPVS/ -/ BGP/ 表/ 1/ 中/ 给出/ 了/ IDSPV/ 、/ FTAPV/ 、/ IDPV/ 以及/ S/ -/ BGP/ 等/ 方案/ 中/ 需要/ 存储/ 的/ 证书/ 规模/ ./ 从表中/ 可知/ ,/ IDSPV/ 机制/ 由于/ 采用/ 了/ 基于/ 身份/ 的/ 密码学/ ,/ 不再/ 需要/ 证书/ 机制/ ./ 因此/ ,/ 在/ 证书/ 方面/ IDSPV/ 机制/ 比/ 其他/ 方案/ 更优/ ./ 5.2/ 平均收敛/ 时间/ 我们/ 所/ 考虑/ 的/ 路由/ 平均收敛/ 时间/ 与/ 产生/ 的/ 更新/ 报文/ 总数/ #/ Update/ 、/ 生成/ 路由/ 属性/ 证明/ 运算/ 次数/ #/ Sign/ 及/ 所/ 耗时间/ tSign/ 、/ 路由/ 属性/ 证明/ 验证/ 次数/ #/ Verif/ 及/ 所/ 耗时间/ tVerif/ 等/ 因素/ 有关/ ,/ 当然/ 还/ 与/ CPU/ 处理/ 信息/ 的/ 能力/ 、/ 所/ 采用/ 的/ 路由/ 属性/ 证明/ 生成/ 算法/ 等/ 有关/ ./ 根据/ 前面/ 的/ 实验/ 场景/ 和/ 参数设置/ ,/ 获得/ 更新/ 报文/ 的/ 总数/ 为/ #/ Update/ =/ m/ ×/ a/ ×/ b/ ×/ c/ ./ 由于/ 在/ 更新/ 的/ 报文/ 中/ ,/ AS/ 仅/ 选择/ 与/ 自己/ 的/ 路由/ 策略/ 相符合/ 的/ 报文/ ,/ 因此/ 在/ 签名/ 验证/ 时/ ,/ 并/ 不是/ 对/ 所有/ 接收/ 到/ 的/ 更新/ 报文/ 进行/ 验证/ ,/ 而是/ 仅/ 对/ 自己/ 所/ 选择/ 的/ 报文/ 的/ 合法性/ 和/ 完整性/ 进行/ 验证/ ./ 类似/ 的/ ,/ AS/ 也/ 仅/ 对/ 所/ 选择/ 的/ 更新/ 报文/ 进行/ 更新/ 并/ 生成/ 路由/ 属性/ 证明/ ./ 由于/ AS/ 都/ 是/ 自治/ 域/ ,/ 均/ 可/ 自主/ 地/ 根据/ 自己/ 的/ 路由/ 策略/ 来/ 选取/ 路由/ ,/ 因此/ 对/ 更新/ 报文/ 的/ 选择/ 、/ 路由/ 属性/ 证明/ 生成/ 和/ 路由/ 属性/ 证明/ 验证/ 均/ 具有/ 一定/ 的/ 概率/ 性/ ./ 在/ 相同/ 的/ 最小/ 路由/ 宣告/ 间隔/ (/ MRAI/ )/ 下/ ,/ 假定/ 每个/ AS/ 选择/ 更新/ 报文/ 的/ 概率/ 均/ 为/ Pr/ {/ AS/ _/ PATHpreferred/ }/ ,/ 则/ 给/ 出路/ 由/ 收敛/ 时间/ 增量/ 模型/ 如下/ :/ Δ/ Time/ _/ Conver/ =/ Pr/ {/ AS/ _/ PATHpreferred/ }/ ×/ #/ Update/ ×/ 其中/ 参数/ Δ/ Time/ _/ Conver/ 表示/ 路由/ 收敛/ 时间/ 增量/ ,/ 其余/ 参数/ 已/ 由/ 上面/ 给出/ ./ 我们/ 在/ 测试/ 中/ 采用/ SSFNet/ ②/ 生成/ 网络拓扑/ ,/ 根据/ SSFNet/ 生成/ 的/ 网络拓扑/ ,/ 搭建/ 了/ 60/ 个/ AS/ 域/ ,/ 总共/ 120/ 台/ BGP/ 路由器/ ./ 我们/ 的/ IDSPV/ 机制/ 是/ 基于/ 2.4/ GHz/ 的/ 处理器/ 及/ Ubuntu11/ ./ 04/ 操作系统/ ,/ 采用/ PBCLibrary/ ③/ 来/ 实现/ ./ 在/ 我们/ 的/ 原型/ 系统/ 中/ 每个/ AS/ 有/ 1/ 个/ speaker/ ,/ 且/ 有/ 12/ 个/ 邻居/ ,/ 同时/ 每个/ speaker/ 生成/ 2/ 个/ 前缀/ ,/ 即/ a/ =/ 1/ ,/ b/ =/ 12/ ,/ c/ =/ 2/ ./ 具体/ 参数/ 如下/ 设置/ :/ 最小/ 路由/ 宣告/ 间隔/ (/ MRAI/ )/ 为/ 30s/ ,/ 链路/ 延迟/ 为/ 0.1/ ms/ ,/ L/ =/ 16/ ,/ Pr/ {/ AS/ _/ PATHpreferred/ }/ =/ 0.8/ ./ 根据/ 文献/ [/ 23/ -/ 24/ ]/ ,/ 1024/ 比特/ 的/ RSA/ 的/ 签名/ 所/ 花/ 时间/ 为/ 50ms/ ,/ 签名/ 验证/ 所花/ 的/ 时间/ 为/ 2.5/ ms/ ;/ 而/ 有限/ 域/ F397/ 上/ 的/ 配对/ 运算/ 所/ 花/ 时间/ 为/ 43ms/ ;/ 主要/ 考察/ 随着/ AS/ 规模/ 大小/ 的/ 变化/ ,/ 采用/ IDSPV/ 机制/ 的/ BGP/ 协议/ 、/ 采用/ RSA/ 机制/ 的/ S/ -/ BGP/ 协议/ 以及/ 未/ 采用/ 任何/ 安全/ 机制/ 的/ BGP/ 协议/ 的/ 路由/ 平均收敛/ 时间/ ,/ 实验/ 结果/ 如图/ 3/ 所示/ ./ 图/ 3/ 中/ 表明/ ,/ 采用/ IDSPV/ 机制/ 的/ BGP/ 协议/ 的/ 路由/ 平均收敛/ 时间/ 比/ 采用/ S/ -/ BGP/ 的/ BGP/ 协议/ 的/ 路由/ 平均收敛/ 时间/ 少/ ,/ 而/ 与/ BGP/ 协议/ 的/ 路由/ 平均收敛/ 时间/ 略/ 多/ ./ 目前/ 互联网/ 中/ 绝大多数/ 的/ BGP/ 路由器/ 处理/ 一次/ UPDATE/ 消息/ 平均/ 需要/ 的/ 时间/ 为/ 1s/ ,/ 在/ 200MHz/ 的/ CPU/ (/ 接近/ 目前/ 路由器/ 的/ 计算能力/ )/ 中/ ,/ 实现/ 有限/ 域/ F397/ 的/ 配对/ 运算/ 中所/ 需/ 的/ 时间/ 是/ 43ms/ ,/ 而/ IDSPV/ 机制/ 中/ 进行/ 了/ 1/ 次/ 签名/ 操作/ 和/ 1/ 次/ 验证/ 操作/ ,/ 总/ 耗时/ 为/ 86ms/ ./ 若/ 遇到/ 高峰期/ ,/ 峰值/ 扩大/ 10/ 倍/ ,/ 也/ 仅/ 耗时/ 860ms/ ./ 因此/ ,/ IDSPV/ 机制/ 对/ BGP/ 路/ ①/ ②/ ③/ Page12/ 由/ 的/ 平均收敛/ 时间/ 不/ 造成/ 太/ 大/ 影响/ ./ 6/ 结论/ BGP/ 路由/ 协议/ 中/ AS/ _/ PATH/ 路由/ 属性/ 的/ 认证/ 问题/ 是/ BGP/ 路由/ 协议/ 安全/ 的/ 一个/ 重要/ 课题/ ,/ 研究/ 资源/ 开销/ 少/ 、/ 易/ 部署/ 的/ AS/ _/ PATH/ 路由/ 属性/ 安全/ 保护/ 方案/ 仍/ 是/ 重要/ 的/ 研究/ 方向/ ./ 基于/ 此/ ,/ 本文/ 提出/ 了/ 一种/ 标准/ 模型/ 下/ 可/ 证明/ 安全/ 的/ BGP/ 路由/ 属性/ 保护/ 机制/ —/ —/ —/ IDSPV/ 机制/ ,/ 采用/ 基于/ 身份/ 的/ 可/ 净化/ 签名/ 技术/ 来/ 保护/ BGP/ 路由/ 属性/ 完整性/ 和/ 合法性/ 的/ 安全/ 机制/ ,/ 同时/ 在/ 标准/ 模型/ 下/ 给出/ 了/ IDSPV/ 机制/ 的/ 安全/ 证明/ ./ 在/ 文中/ 详细/ 讨论/ 了/ IDSPV/ 机制/ 的/ 安全性/ 和/ 性能/ ,/ 与/ 现有/ 方案/ 相比/ ,/ IDSPV/ 机制/ 更/ 易于/ 在/ 实际/ 中/ 部署/ 实现/ ./ 由于/ 所/ 采用/ 的/ 可/ 净化/ 签名/ 方案/ 是/ 一种/ 轻量/ 型/ 的/ 签名/ 方案/ ,/ 该/ 机制/ 是/ 可以/ 结合/ BGP/ 自身/ 的/ 路由/ 策略/ 来/ 决定/ 将/ 路由/ 信息/ 转发给/ 更/ 信任/ 的/ 下/ 一个/ AS/ 域/ ,/ 从/ 安全性/ 和/ 负载/ 均衡/ 方面/ 来说/ ,/ 具有/ 一定/ 的/ 灵活性/ 和/ 可扩展性/ ./ 今后/ 的/ 研究/ 工作/ 将/ 进一步/ 研究/ 如何/ 结合/ BGP/ 自身/ 的/ 路由/ 策略/ 来/ 确定/ 和/ 刻画/ AS/ 域/ 的/ 信任度/ ,/ 以便/ 更好/ 地/ 确保/ 新机制/ 的/ 有效性/ ./ 致谢/ 审稿人/ 提出/ 的/ 修改意见/ 对/ 提高/ 论文/ 水平/ 有/ 很大/ 的/ 帮助/ ,/ 在/ 此/ 表示感谢/ !/ 

