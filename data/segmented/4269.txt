Page1Mimir/ :/ 一种/ 基于/ 密文/ 的/ 全文检索/ 服务/ 系统/ 宋伟/ 1/ )/ ,/ 2/ )/ 彭智勇/ 2/ )/ 王骞/ 2/ )/ 李瑞轩/ 3/ )/ 程芳权/ 2/ )/ 崔一辉/ 2/ )/ 1/ )/ (/ 武汉大学/ 软件工程/ 国家/ 重点/ 实验室/ 武汉/ 430072/ )/ 2/ )/ (/ 武汉大学/ 计算机/ 学院/ 武汉/ 430072/ )/ 3/ )/ (/ 华中科技大学/ 计算机科学/ 与/ 技术/ 学院/ 武汉/ 430074/ )/ 摘要/ 针对/ 海量/ 涉密/ 隐私/ 数据/ 高效/ 安全/ 检索/ 的/ 需求/ ,/ 提出/ 了/ 一种/ 基于/ 密文/ 的/ 全文检索/ 系统/ —/ —/ —/ Mimir/ ./ Mimir/ 基于/ B/ +/ 树/ 构建/ 了/ 一种/ 安全/ 密文/ 全文索引/ 结构/ ,/ Mimir/ 检索/ 过程/ 完全/ 在/ 密文/ 环境/ 下/ 进行/ ,/ 保证/ 了/ 系统/ 的/ 安全性/ 和/ 存储/ 信息/ 的/ 私密性/ ./ 与/ 传统/ 的/ 全文检索/ 系统/ 相比/ ,/ Mimir/ 密文/ 索引/ 中/ 没有/ 存储/ 索引/ 词/ 的/ 位置/ 信息/ 和/ 词频/ 信息/ ,/ 可以/ 有效/ 地/ 抵御/ 已知/ 明文/ 攻击/ 、/ 选择/ 明文/ 攻击/ 和/ 词频/ 统计/ 攻击/ ./ 对/ Mimir/ 密文/ 全文检索/ 系统/ 进行/ 了/ 性能/ 测试/ ,/ 实验/ 结果/ 数据/ 表明/ ,/ Mimir/ 密文/ 全文检索/ 系统/ 在/ 确保/ 高/ 安全性/ 的/ 同时/ ,/ 也/ 具有/ 很/ 好/ 的/ 检索/ 时间/ 和/ 存储空间/ 性能/ ./ 关键词/ 密文/ 全文检索/ ;/ 密文/ 索引/ ;/ Mimir/ ;/ 中文/ 分词/ ;/ B/ +/ 树/ ;/ 信息安全/ ;/ 网络安全/ 1/ 引言/ 随着/ 计算机信息/ 规模/ 的/ 不断/ 增长/ 以及/ 网络通信/ 技术/ 的/ 飞速发展/ ,/ 很多/ 涉密/ 单位/ (/ 党政机关/ 、/ 财政金融/ 、/ 国防/ 军工/ 、/ 科研/ 高校/ 等/ )/ 相关/ 部门/ 中/ ,/ 信息/ 的/ 保有量/ 和/ 交流/ 量/ 都/ 达到/ 了/ 前所未有/ 的/ 数量级/ ./ 如何/ 在/ 这些/ 海量/ 信息/ 中/ 快速/ 地/ 检索/ 自己/ 需要/ 的/ 信息/ 已/ 成为/ 一种/ 迫切/ 的/ 需求/ ./ 与此同时/ ,/ 大量/ 涉密/ 信息/ 往往/ 非常/ 敏感/ ,/ 不/ 允许/ 在/ 明文/ 状态/ 下/ 存储/ 和/ 检索/ ./ 尽管/ 全文检索/ 和/ 信息安全/ 技术/ 都/ 已/ 相当/ 成熟/ ,/ 并且/ 都/ 有/ 了/ 较/ 好/ 的/ 商业/ 产品/ 出现/ ,/ 但是/ 如何/ 在/ 加密/ 、/ 可信/ 的/ 环境/ 下/ 实现/ 海量/ 文本/ 数据/ 的/ 高效/ 、/ 安全/ 检索/ ,/ 仍然/ 是/ 一个/ 急待/ 解决/ 的/ 研究课题/ ./ 为了/ 实现/ 海量/ 涉密/ 文本/ 信息/ 的/ 高效/ 、/ 安全/ 全文检索/ ,/ 我们/ 结合/ 信息/ 加密/ 和/ 全文检索/ 技术/ ,/ 研究/ 了/ 安全/ 、/ 高效/ 的/ 密文/ 数据/ 查询方法/ ,/ 并/ 实现/ 了/ 一种/ 基于/ 密文/ 的/ 全文检索/ 系统/ —/ —/ —/ Mimir/ 密文/ 全文检索/ 系统/ ./ Mimir/ 中/ 所有/ 的/ 文档/ 和/ 全文索引/ 都/ 采用/ 安全/ 的/ 加密算法/ 进行/ 加密/ 处理/ ,/ 而且/ 为/ 保证/ 检索/ 过程/ 的/ 安全可靠/ ,/ 整个/ 检索/ 过程/ 都/ 不/ 对/ 密文/ 索引/ 和/ 检索/ 词/ 进行/ 解密/ 操作/ ,/ 实现/ 高/ 安全性/ 的/ 密文/ 全文检索/ 服务/ ./ 针对/ 传统/ 明文/ 全文索引/ 结构/ 中/ 存在/ 的/ 安全隐患/ ,/ 我们/ 设计/ 了/ Mimir/ 密文/ 全文索引/ 结构/ ,/ 理论/ 分析/ 了/ Mimir/ 密文/ 索引/ 结构/ 可以/ 抵御/ 已知/ 明文/ 攻击/ 、/ 选择/ 明文/ 攻击/ 和/ 词频/ 统计/ 攻击/ ,/ 具有/ 很/ 好/ 的/ 安全/ 保密性/ ./ 我们/ 对/ Mimir/ 系统/ 进行/ 了/ 实验/ 分析/ ,/ 实验/ 结果表明/ Mimir/ 密文/ 全文检索/ 系统/ 在/ 保证系统/ 高/ 安全性/ 的/ 同时/ ,/ 也/ 具有/ 很/ 好/ 的/ 全文检索/ 服务/ 性能/ ./ 本文/ 第/ 2/ 节将/ 分析/ 近年来/ 国内外/ 的/ 相关/ 研究/ 工作/ ;/ 第/ 3/ 节/ 详细/ 介绍/ Mimir/ 密文/ 全文检索/ 系统/ ,/ 包括/ Mimir/ 密文/ 索引/ 结构/ 和/ 相应/ 的/ 查询/ 、/ 排序/ 算法/ ;/ 第/ 4/ 节/ 给出/ 实验/ 结果/ 和/ 分析/ ;/ 最后/ 在/ 第/ 5/ 节/ 总结/ 全文/ 并/ 提出/ 下/ 一步/ 需要/ 继续/ 深入研究/ 的/ 工作/ ./ 2/ 相关/ 工作/ 随着/ 信息系统/ 在/ 各个领域/ 的/ 广泛应用/ ,/ 它/ 在/ 给/ 人们/ 带来/ 极大/ 方便/ 的/ 同时/ ,/ 也/ 带来/ 了/ 诸多/ 安全/ 方面/ 的/ 问题/ ./ 因此/ ,/ 如何/ 高效/ 且/ 安全/ 地/ 存储/ 和/ 查询/ 文本/ 、/ 网页/ 等/ 非/ 结构化/ 数据/ 是/ 一个/ 很/ 值得/ 关注/ 和/ 研究/ 的/ 问题/ ./ 这/ 其中/ 的/ 全文检索/ (/ Full/ -/ TextRetrieval/ )/ 技术/ 和/ 全文/ 数据库/ (/ Full/ -/ TextDatabase/ )/ 技术/ 成为/ 了/ 国内外/ 学者/ 研究/ 的/ 热点/ ./ 目前/ 虽然/ 全文检索/ 技术/ 和/ 信息/ 加密技术/ 都/ 已经/ 得到/ 了/ 飞速/ 的/ 发展/ ,/ 并且/ 也/ 都/ 有/ 了/ 很/ 好/ 的/ 商业/ 产品/ 出现/ ,/ 但是/ 如何/ 在/ 加密/ 环境/ 下/ 实现/ 密文/ 全文检索/ ,/ 仍然/ 是/ 一个/ 没有/ 解决/ 的/ 难题/ ./ 加密/ 数据检索/ 的/ 相关/ 研究/ 主要/ 集中/ 在外/ 包/ 数据库/ 环境/ 下/ 如何/ 实现/ 安全/ 的/ 数据/ 存储/ 和/ 加密/ 数据检索/ ./ 数据/ 加密/ 后/ 会/ 失去/ 原始数据/ 本身/ 所/ 具有/ 的/ 一些/ 特性/ [/ 1/ -/ 2/ ]/ ,/ 如/ 有序性/ 、/ 相似性/ 等/ ,/ 难以/ 在/ 密文/ 数据/ 上/ 直接/ 进行/ 查询/ ./ Hacg/ ü/ m/ ü/ 等/ 人/ [/ 3/ ]/ 提出/ 了/ DAS/ (/ DatabaseasService/ )/ 服务/ 模型/ ,/ DAS/ 模型/ 对/ 数据库/ 数据/ 按照/ 不同/ 粒度/ 进行/ 加密/ ,/ 检索/ 过程/ 中/ 需要/ 进行/ 解密/ ,/ 由于/ 解密/ 操作/ 开销/ 很大/ ,/ 对/ 实际/ 的/ 查询/ 性能/ 会/ 造成/ 较大/ 影响/ ./ 近年来/ 数据/ 隐私/ 保护/ 的/ 需求/ 越来越/ 迫切/ ,/ 为了/ 加强/ 数据库/ 的/ 安全性/ 和/ 可信性/ ,/ 提高/ 加密/ 数据/ 的/ 可操作性/ 能/ ,/ 国内外/ 研究/ 人员/ 在/ 这个/ 方面/ 做/ 了/ 大量/ 研究/ 工作/ ./ Rivest/ 等/ 人/ [/ 4/ ]/ 使用/ 同态/ 加密/ 函数/ 加密/ 数据/ ,/ 实现/ 加密/ 数据/ 的/ 直接/ 算术/ 运算/ ./ 这种/ 方法/ 可以/ 实现/ 加密/ 数据/ 的/ 算术/ 比较/ ,/ 但是/ 同态/ 加密/ 方法/ 本身/ 在/ 安全性/ 上/ 有/ 一定/ 的/ 隐患/ ,/ 而且/ 目前/ 构建/ 一个/ 可行/ 的/ 同态/ 加密/ 函数/ 仍然/ 非常/ 困难/ ./ 2009/ 年/ IBM/ 研究员/ Gentry/ [/ 5/ ]/ 宣布/ 找到/ 了/ 一种/ 全/ 同态/ 加密算法/ ,/ 但/ 其/ 仍然/ 存在/ 诸多/ 的/ 应用/ 限制/ ./ IBM/ 研究/ 中心/ 的/ Agrawal/ 等/ 人/ [/ 6/ ]/ 提出/ 了/ 一种/ 保持/ 有序/ 的/ 加密/ 方法/ OPES/ (/ OrderPreservingEncryp/ -/ tionScheme/ )/ ,/ 但/ 密文/ 保持/ 有序性/ 都/ 具有/ 一定/ 安全隐患/ ./ 另一类/ 方法/ 主要/ 是/ 对/ 加密/ 方法/ 本身/ 进行/ 改造/ ,/ 使/ 之/ 适应/ 加密/ 安全/ 数据库/ 的/ 应用环境/ ,/ 包括/ Ge/ 等/ 人/ [/ 7/ ]/ 提出/ 了/ 一种/ 轻量级/ 的/ 数据库/ 数据/ 加密/ 机制/ FCE/ ,/ Bouganim/ 等/ 人/ [/ 8/ ]/ 采取/ 智能卡/ 技术/ 快速/ 实现/ 加密/ 数据/ 的/ 查询/ ./ 还有/ 一类/ 方法/ 主要/ 利用/ 过滤/ 和/ 索引/ 技术/ 来/ 缩小/ 解密/ 范围/ ,/ 以/ 提高/ 加密/ 数据库/ 的/ 检索/ 效率/ ./ Hacg/ ü/ m/ ü/ 等/ 人/ [/ 9/ ]/ 基于/ 提出/ 的/ DAS/ 模型/ 给出/ 了/ 一种/ 使用/ 过滤/ 技术/ 缩小/ 解密/ 范围/ ,/ 从而/ 提高/ 加密/ 数据检索/ 效率/ 的/ 方法/ ./ 这种/ 方法/ 返回/ 一个/ 比/ 正确/ 结果/ 集合/ 更大/ 一些/ 的/ 集合/ ,/ 其中/ 可能/ 包含/ 一些/ 并/ 不/ 匹配/ 查询/ 条件/ 的/ 密文/ 元组/ ,/ 因此/ 需要/ 再/ 对/ 这个/ 结果/ 集合/ 进行/ 解密/ 和/ 过滤/ 处理/ ./ 之后/ Hacg/ ü/ m/ ü/ 等/ 人/ [/ 10/ ]/ 又/ 深入研究/ 了/ 采用/ 这种/ 方法/ 后/ 实现/ 加密/ 数据/ 的/ 聚集/ 操作/ ,/ 文献/ [/ 11/ ]/ 依据/ 数据库/ 数据分布/ 实现/ 最优化/ 桶/ 划分/ 以/ 减小/ 解密/ 代价/ ./ 文献/ [/ 12/ ]/ 在/ 研究/ 查询/ 分布/ 、/ 查询/ 类型/ 对/ 密文/ 数据/ 查询/ 影响/ 的/ 基础/ 上/ ,/ 提出/ 了/ 一种/ 自/ 适应/ 密文/ 分桶/ 更新/ 策略/ ,/ 针对/ 密文/ 数据库/ 中/ 数据/ 动态/ 更新/ 和/ 非/ 均匀/ 查询/ 分布/ 进行/ 优化/ ./ 目前/ 加密/ 数据库/ 主要/ 研究/ 加密/ 数据/ 的/ 检索/ 方法/ 和/ 在/ 不可/ 信/ 应用环境/ 下/ 如何/ 保证/ 数据库/ 数据/ 的/ 安全性/ ,/ 并/ 没有/ 解决/ 检索/ 过程/ 的/ 安全性/ 和/ 基于/ 密文/ 的/ 数据/ 全文检索/ ./ 以上/ 研究/ 主要/ 研究/ 解决/ 加密/ 数值/ 型/ 数据/ 的/ 安全/ 检索/ 问题/ ,/ 与/ 数值/ 型/ 数据/ 的/ 比较/ 查询/ 不同/ ,/ 字符/ 型/ 数据/ 需要/ 处理/ 的/ 大量/ 是/ 匹配/ 查询/ ,/ 而且/ 近年来/ 随着/ 云/ Page3/ 计算/ 的/ 兴起/ ,/ 外/ 包/ 数据服务/ 成为/ 一种/ 趋势/ ,/ 为/ 解决/ 外/ 包/ 服务/ 环境/ 下/ 的/ 隐私/ 数据安全/ ,/ 近年/ 国内外/ 很多/ 研究/ 学者/ 开始/ 研究/ 云/ 计算环境/ 下/ 的/ 密文/ 数据/ 查询方法/ ,/ 云/ 环境/ 下/ 密文/ 数据/ 查询/ 研究/ 重点/ 关注/ 字符/ 型/ 加密/ 数据/ 的/ 安全/ 查询/ 问题/ ./ 目前/ 密文/ 字符/ 型/ 数据检索/ 主要/ 是/ 通过/ 对/ 字符/ 数据/ 建立/ 安全/ 索引/ ,/ 从而/ 实施/ 快速/ 查询/ ./ 哈佛大学/ 的/ Chang/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 一种/ 解决/ 在/ 远程/ 服务器/ 上/ 检索/ 加密/ 数据/ 的/ 方法/ ,/ 但是/ 这种/ 方案/ 基于/ 词频/ 的/ 查询/ 会/ 极大/ 地/ 导致/ 服务器端/ 开销/ ,/ 同时/ 也/ 没有/ 解决/ 删除/ 操作/ 带来/ 的/ 安全更新/ 问题/ ./ Boneh/ 等/ 人/ [/ 14/ ]/ 基于/ 非对称/ 加密/ 提出/ 了/ 一种/ 公钥/ 加密/ 的/ 关键词/ 搜索/ 方法/ PEKS/ (/ PubicEncryptionwithKeywordSearch/ )/ ,/ 但是/ PEKS/ 需要/ 查询/ 对象/ 和/ 查询/ 关键词/ 逐个/ 比/ 对/ ,/ 不/ 适合/ 于/ 大/ 数据量/ 的/ 加密/ 文本检索/ ./ 斯坦福大学/ 的/ Goh/ [/ 15/ ]/ 提出/ 了/ 一种/ 加密/ 文本/ 搜索/ 方法/ ,/ 但/ 其/ 使用/ 的/ Bloom/ 过滤器/ 会/ 导致/ 错误/ 结果/ 的/ 产生/ ,/ 因为/ 它们/ 会/ 潜在地/ 使/ 远程/ 用户/ 下载/ 一些/ 不/ 包含/ 查询/ 关键词/ 的/ 额外/ 文件/ ./ 加利福/ 利亚/ 大学/ 的/ Song/ 等/ 人/ [/ 16/ ]/ 采取/ 了/ 序列/ 加密/ (/ streamcipher/ )/ 方法/ 对/ 文本/ 数据/ 进行/ 加密/ 处理/ ,/ 这样/ 无需/ 解密/ 就/ 可以/ 直接/ 对/ 加密/ 文本/ 搜索/ 关键词/ ./ 但是/ 其/ 方法/ 有/ 一些/ 问题/ :/ 第一/ ,/ 它/ 与/ 当前/ 已有/ 的/ 一些/ 文件/ 加密/ 方案/ 不/ 兼容/ ;/ 第二/ ,/ 它/ 在/ 针对/ 加密/ 数据/ 的/ 统计/ 分析攻击/ 下/ 并/ 不/ 安全/ ./ 尽管/ 提出/ 了/ 一些/ 有/ 启发性/ 的/ 补救/ 方法/ ,/ 但是/ 其/ 安全性/ 证据/ 在/ 理论/ 上/ 是/ 不够/ 健壮/ 的/ ./ Curtmola/ 等/ 人/ [/ 17/ ]/ 利用/ 加密/ Hash/ 表/ 存储/ 关键词/ 和/ 密文/ 文件/ 标识/ 的/ 映射/ 关系/ 实现/ 密文/ 数据/ 查询/ ./ 2010/ 年/ Li/ 等/ 人/ [/ 18/ ]/ 基于/ 关键词/ 编辑/ 距离/ ,/ 研究/ 了/ 云/ 计算环境/ 下/ 的/ 加密/ 字符/ 型/ 数据/ 的/ 模糊/ 匹配/ 查询/ ,/ 但是/ 其/ 需要/ 语义/ 库/ 的/ 支持/ ./ 黄汝维/ 等/ 人/ [/ 19/ ]/ 基于/ 关键词/ 字符串/ 向量/ 的/ 欧几里德/ 距离/ 实现/ 隐私/ 数据/ 的/ 模糊/ 查询/ ./ 除/ 上述/ 研究/ 外/ ,/ 近年/ 还/ 出现/ 了/ 密文/ 检索/ 结果/ 排序/ 、/ 授权/ 访问/ 、/ 安全/ 分析/ 等/ 相关/ 研究/ ,/ Wang/ 等/ 人/ [/ 20/ ]/ 基于/ 文本/ 词频/ 研究/ 云/ 计算环境/ 下/ 密文/ 数据/ 查询/ 的/ 结果/ 集/ 排序/ ./ 但/ 这种/ 方法/ 仅/ 支持/ 单/ 关键词/ 的/ 排序/ 查询/ ./ 2011/ 年/ Cao/ 等/ 人/ [/ 21/ ]/ 在/ 安全/ kNN/ 密文/ 查询方法/ 的/ 基础/ 上/ ,/ 基于/ 向量/ 内积/ 相似/ 度/ 研究/ 了/ 多/ 关键词/ 的/ 隐私/ 保护/ 排序/ 查询/ ,/ 但/ 由于/ 需要/ 存储/ 关键词/ 词典/ 而/ 给/ 客户端/ 造成/ 较大/ 负担/ ./ Wang/ 等/ 人/ [/ 22/ ]/ 基于/ ABE/ (/ Attribute/ -/ BasedEncryption/ )/ 加密/ 研究/ 了/ 云/ 存储/ 数据/ 访问/ 授权/ 方法/ ./ Li/ 等/ 人/ [/ 23/ ]/ 针对/ 传统/ 密文/ 检索/ 过程/ 的/ 粗粒度/ 授权/ 问题/ ,/ 提出/ 了/ 一种/ 支持/ 密文/ 查询/ 的/ 细粒度/ 授权/ 与/ 撤销/ 机制/ ./ 现有/ 相关/ 研究/ 主要/ 关注/ 了/ 密文/ 数据/ 的/ 查询方法/ 以及/ 提高/ 密文/ 查询/ 效率/ ,/ 但/ 现有/ 研究/ 在/ 查询/ 功能/ 上/ 还/ 不能/ 满足/ 海量/ 文本/ 数据/ 的/ 高效/ 全文检索/ 服务/ 要求/ ./ 随着/ 网络/ 和/ 信息技术/ 的/ 飞速发展/ ,/ 数据/ 的/ 安全性/ 和/ 私密性/ 越来越/ 受到重视/ ,/ 但是/ 目前/ 加密/ 信息/ 的/ 全文检索/ 仍然/ 没有/ 得到/ 解决/ ,/ 主要/ 问题/ 是/ 没有/ 解决/ 加密/ 策略/ 和/ 全文检索/ 技术/ 结合/ 的/ 问题/ ./ 本文/ 提出/ 了/ Mimir/ :/ 一种/ 基于/ B/ +/ 树/ 的/ 密文/ 全文索引/ 结构/ 和/ 相应/ 的/ 归档/ 、/ 检索/ 策略/ ,/ 在/ 具有/ 较/ 高/ 安全性/ 的/ 同时/ ,/ 也/ 保证/ 具有/ 很/ 好/ 的/ 全文检索/ 服务/ 性能/ ./ 3Mimir/ 密文/ 全文检索/ 系统/ 3.1/ 传统/ 全文索引/ 结构/ 及其/ 安全性/ 问题/ 实现/ 密文/ 全文检索/ 一个/ 很/ 自然/ 的/ 思路/ 是/ 对/ 目前/ 流行/ 的/ 全文索引/ 进行/ 加密/ ,/ 以/ 实现/ 密文/ 全文检索/ ./ 按照/ 加密/ 粒度/ 的/ 不同/ ,/ 可以/ 将/ 加密/ 分为/ 两个/ 层次/ :/ 索引/ 级/ (/ IndexLevel/ )/ 和/ 索引/ 词级/ (/ TokenLevel/ )/ 的/ 信息/ 加密/ ./ 索引/ 级/ 的/ 密文/ 索引/ 直接/ 对/ 明文/ 全文索引/ 进行/ 加密/ ,/ 信息检索/ 时/ 需要/ 先对/ 密文/ 全文索引/ 进行/ 解密/ 或者/ 部分/ 解密/ ,/ 再/ 在/ 解密/ 的/ 明文/ 全文索引/ 基础/ 上/ 进行/ 全文检索/ ,/ 这种/ 方式/ 最大/ 的/ 问题/ 是/ 检索/ 过程/ 中/ 需要/ 解密/ ,/ 本质/ 上/ 仍然/ 是/ 明文/ 全文检索/ ,/ 存在/ 很大/ 的/ 安全隐患/ ,/ 而且/ 在/ 索引/ 的/ 增量/ 构建/ 过程/ 中/ 加解密/ 代价/ 很大/ ./ 基于/ 索引/ 词/ 级别/ 加密/ 的/ 信息检索/ 采用/ 原有/ 的/ 明文/ 索引/ 结构/ ,/ 利用/ 一致/ 加密算法/ 对/ 索引/ 词/ 进行/ 加密/ ,/ 从而/ 直接/ 在/ 密文/ 基础/ 上/ 进行/ 索引/ 词比/ 对/ 而/ 实现/ 密文/ 全文检索/ ./ 目前/ 各种/ 主要/ 的/ IR/ 模型/ 的/ 全文索引/ 都/ 是/ 基于/ 索引/ 词/ (/ Token/ )/ 偏移/ 地址/ 和/ 词频/ 信息/ 构建/ 的/ ,/ 若/ 这些/ 信息/ 也/ 进行/ 加密/ 处理/ ,/ 由于/ 在/ 查询/ 过程/ 中/ 需要/ 大量/ 的/ 运算/ 操作/ ,/ 会/ 极大/ 地/ 影响/ 全文检索/ 系统/ 的/ 检索/ 效率/ ,/ 若/ 采用/ 明文/ 形式/ 存放/ 又/ 会/ 带来/ 很大/ 的/ 安全隐患/ ,/ 下面/ 详细分析/ 明文/ 索引/ 词/ 偏移/ 地址/ 和/ 词频/ 统计/ 信息/ 所/ 带来/ 的/ 安全隐患/ ./ 我们/ 首先/ 定义/ 信息检索/ 模型/ :/ 定义/ 1/ ./ 一个/ 全文/ 信息检索/ 系统/ ,/ 可以/ 用/ 一个/ 四元组/ {/ D/ ,/ Q/ ,/ F/ ,/ R/ (/ qi/ ,/ dj/ )/ }/ 来/ 定义/ ,/ 其中/ D/ 是/ 信息检索/ 系统/ 的/ 文档/ 集合/ ,/ Q/ 是/ 用户/ 查询/ 请求/ 的/ 一组/ 逻辑/ 视图/ ,/ F/ 是/ 对/ 文档/ 进行/ 表达/ 、/ 信息提取/ 和/ 查询/ 的/ 逻辑/ 框架/ ,/ R/ (/ qi/ ,/ dj/ )/ 是/ 针对/ 查询/ qi/ 返回/ 的/ 文档/ 结果/ 集合/ dj/ 的/ 排序/ 策略/ ./ 基于/ 定义/ 1/ 描述/ 的/ 信息检索/ 系统/ ,/ 对/ 索引/ 词/ 加密/ ,/ 构建/ 密文/ 索引/ 的/ 方法/ 可以/ 描述/ 如下/ :/ 对于/ 信息检索/ 系统/ 中/ 的/ 某/ 一/ 文档/ di/ ,/ 设其/ 在/ 归档/ 规则/ F/ 下/ ,/ 映射/ 为/ 一组/ 索引/ 词/ 集合/ Ti/ (/ (/ t1/ ,/ p1/ )/ ,/ (/ t2/ ,/ p2/ )/ ,/ …/ ,/ (/ tk/ ,/ pk/ )/ )/ ,/ 其中/ 对于/ 任意/ 索引/ 词/ 单元/ (/ tj/ ,/ pj/ )/ ,/ tj/ 为/ 索引/ 词/ ,/ 偏移/ 位置/ pj/ 表示/ 了/ 索引/ 词/ tj/ 在/ 文档/ Di/ 中/ 的/ 相对/ 偏移/ 地址/ ./ 获得/ 明文/ 索引/ 词后/ ,/ 利用/ 加密/ 算/ Page4/ 法对/ 索引/ 词/ ti/ 进行/ 加密/ ,/ 得到/ 密文/ 索引/ 词/ 集合/ ETi/ (/ (/ e1/ ,/ p1/ )/ ,/ (/ e2/ ,/ p2/ )/ ,/ …/ ,/ (/ ek/ ,/ pk/ )/ )/ ,/ 并/ 构建/ 密文/ 索引/ EIndex/ ,/ 其/ 处理过程/ 如式/ (/ 1/ )/ 所示/ ./ di/ →/ / / FTi/ (/ (/ t1/ ,/ p1/ )/ ,/ (/ t2/ ,/ p2/ )/ ,/ …/ ,/ (/ tk/ ,/ pk/ )/ )/ Encryp/ →/ / / / tETi/ (/ (/ e1/ ,/ p1/ )/ ,/ (/ e2/ ,/ p2/ )/ ,/ …/ ,/ (/ ek/ ,/ pk/ )/ )/ →/ / / / IndexEIndex/ 在/ 已知/ 明文/ 的/ 攻击/ 环境/ 下/ ,/ 假定/ 攻击者/ 知道/ 某个/ 文档/ di/ 的/ 明文/ 信息/ ,/ 也/ 知道/ 全文检索/ 的/ 归档/ 规则/ F/ ,/ 则/ 攻击者/ 很/ 容易/ 完成/ 式/ (/ 1/ )/ 中/ 由/ di/ →/ Ti/ 的/ 处理/ ./ 由于/ 偏移/ 地址/ pj/ 在/ 检索/ 过程/ 中/ 需要/ 进行/ 大量/ 的/ 运算/ 操作/ ,/ 为了/ 保证/ 全文检索/ 效率/ ,/ 难以/ 进行/ 加密/ ./ 因此/ 攻击者/ 通过/ 对/ 密文/ 索引/ 进行/ 分析/ ,/ 基于/ 偏移/ 地址/ 进行/ 对照/ 就/ 可以/ 获得/ 全部/ 或者/ 部分/ 的/ 明文/ 索引/ 词/ 和/ 密文/ 索引/ 词/ 的/ 映射/ 关系/ ti/ →/ ei/ ./ 因此/ 这种/ 密文/ 索引/ 构建/ 方法/ 具有/ 很大/ 的/ 安全隐患/ ,/ 攻击者/ 不/ 需要/ 攻击/ 密文/ 全文检索/ 的/ 加密算法/ 和/ 密钥/ 本身/ ,/ 直接/ 利用/ 明文/ 索引/ 词/ 和/ 密文/ 索引/ 词/ 的/ 映射/ 关系/ ,/ 就/ 可以/ 通过/ 分析/ 密文/ 索引/ 推导/ 出/ 整个/ 检索系统/ 的/ 明文/ 文档/ 内容/ ,/ 从而/ 完全/ 破坏/ 整个/ 密文/ 检索系统/ 的/ 安全性/ ./ 索引/ 词/ 位置/ 信息/ 会/ 给/ 密文/ 全文检索/ 系统/ 带来/ 很大/ 的/ 安全/ 风险/ ,/ 索引/ 词/ 词频/ 信息/ 同样/ 也/ 存在/ 着/ 严重/ 的/ 安全隐患/ ./ 现有/ 的/ 全文检索/ 系统/ 存储/ 索引/ 词/ t/ 的/ 频率/ 信息/ ft/ 是/ 排序/ 处理/ 的/ 重要/ 参考/ 指标/ 之一/ ,/ 但是/ 这种/ 词频/ 信息/ 也/ 很/ 容易/ 受到/ 统计/ 攻击/ ./ 针对/ 一个/ 信图/ 1/ 基于/ B/ +/ 树/ 的/ 密文/ 全文索引/ 结构/ 息/ 检索系统/ 的/ 文档/ 集合/ Di/ ,/ 攻击者/ 可以/ 针对/ 现有/ 已知/ 文档/ 进行/ 词频/ 统计分析/ ,/ 获得/ 敏感/ 词汇/ 的/ 统计/ 分布/ 规律/ ,/ 再/ 分析/ 密文/ 索引/ 词/ 的/ 频率/ 分布/ ,/ 攻击者/ 可以/ 猜测/ 部分/ 敏感/ 密文/ 索引/ 词/ 对应/ 的/ 明文/ 信息/ ,/ 并/ 进而/ 攻击/ 加密算法/ 和/ 密钥/ ./ 若/ 对/ 词频/ 信息/ 进行/ 加密/ ,/ 则/ 在/ 排序/ 和/ 归档/ 过程/ 中/ 也/ 会/ 增加/ 大量/ 的/ 加/ 、/ 解密/ 操作/ ,/ 从而/ 极大/ 地/ 影响/ 密文/ 全文检索/ 系统/ 效率/ ./ 综上/ ,/ 目前/ 的/ 全文检索/ 模型/ (/ 包括/ 索引/ 结构/ 、/ 归档/ 机制/ 、/ 检索/ 策略/ )/ 都/ 是/ 基于/ 明文/ 状态/ 设计/ 的/ ,/ 并/ 没有/ 考虑/ 检索/ 安全性/ 及/ 信息/ 私密性/ 的/ 要求/ ./ 因此/ 基于/ 现有/ 明文/ 全文索引/ 结构/ 创建/ 的/ 密文/ 索引/ 难以/ 满足/ 安全性/ 和/ 检索/ 效率/ 的/ 要求/ ,/ 有/ 必要/ 设计/ 一种/ 适应/ 密文/ 全文检索/ 需要/ 的/ 安全/ 可信/ 的/ 密文/ 索引/ 结构/ ./ 3.2/ 基于/ B/ +/ 树/ 的/ Mimir/ 密文/ 全文索引/ 全文检索/ 系统/ 的/ 文档/ 资源/ 都/ 是/ 海量/ 的/ ,/ 全文索引/ 都/ 采用/ 增量/ 方式/ 构建/ ,/ 因此/ 采用/ 一种/ 稳定/ 、/ 高效/ 的/ 数据结构/ 构建/ 全文索引/ 对于/ 实现/ 高效/ 的/ 密文/ 全文检索/ 是/ 非常/ 重要/ 的/ ./ 由于/ B/ +/ 树当/ 节点/ 分裂/ 时/ 只/ 影响/ 原/ 节点/ 和/ 父亲/ 节点/ ,/ 因此/ 对于/ 全文索引/ 的/ 增量/ 构建/ 在/ 插入/ 索引/ 词时/ 可以/ 有效/ 地/ 保持/ 索引/ B/ +/ 树/ 的/ 平衡性/ ,/ 保障/ 全文检索/ 效率/ ./ 为了/ 保证/ 密文/ 索引/ 服务/ 的/ 安全性/ 和/ 高效性/ ,/ 给出/ 了/ 一种/ 基于/ B/ +/ 树/ 密文/ 全文索引/ 结构/ 如图/ 1/ 所示/ ./ Page5Mimir/ 密文/ 索引/ 树/ 基于/ 密文/ 索引/ 词/ 构建/ ,/ 对于/ 某个/ 待/ 归档/ 文档/ di/ ,/ 首先/ 对/ 其/ 进行/ 分词/ 映射/ (/ 归档/ 策略/ 将/ 详细/ 介绍/ )/ ,/ 映射/ 为/ 一组/ 索引/ 词/ 集合/ Ti/ (/ t1/ ,/ t2/ ,/ …/ ,/ tk/ )/ ,/ 与/ 传统/ 的/ 明文/ 全文检索/ 系统/ 不同/ ,/ Mimir/ 密文/ 检索系统/ 中/ 并/ 不/ 记录/ 每个/ 索引/ 词/ 的/ 偏移/ 地址/ ,/ 而/ 只/ 记录/ 归档/ 文档/ 出现/ 的/ 不同/ 索引/ 词/ ./ 获得/ 明文/ 索引/ 词后/ ,/ 利用/ 加密算法/ 对/ 每个/ 索引/ 词/ ti/ 进行/ 加密/ ,/ 得到/ 密文/ 索引/ 词/ 集合/ ETi/ (/ e1/ ,/ e2/ ,/ …/ ,/ ek/ )/ ,/ 并/ 插入/ 到/ 图/ 1/ 所示/ 的/ Mimir/ 密文/ 索引/ 树中/ ,/ 构建/ 密文/ 索引/ EncryptedIndex/ ,/ Mimir/ 的/ 文档/ 归档/ 过程/ 如式/ (/ 2/ )/ 所示/ ./ diET/ (/ e1/ ,/ e2/ ,/ …/ ,/ en/ )/ →/ / / / indexEncryptedIndex/ (/ 2/ )/ Mimir/ 的/ 检索/ 过程/ 中/ 没有/ 解密/ 操作/ ,/ 检索/ 基于/ 密文/ 索引/ 词/ 的/ 直接/ 匹配/ 实现/ ./ Mimir/ 系统/ 收到/ 检索/ 请求/ 后/ ,/ 将/ 检索/ 请求/ 转换/ 为/ 密文/ 检索/ 词/ 的/ 析取/ 或者/ 合取范式/ ,/ 基于/ Mimir/ 密文/ 全文索引/ 查询/ 到/ 密文/ 检索/ 词/ 命中/ 的/ 文档/ ,/ 再/ 排序/ 处理/ (/ 排序/ 算法/ 见/ 3.3/ 节/ )/ 返回/ ./ 为了/ 保证系统/ 安全性/ ,/ Mimir/ 采用/ 成熟/ 可靠/ 的/ 加密算法/ 对/ 索引/ 词/ 进行/ 加密/ 处理/ ./ 在/ 常用/ 的/ 分组/ 加密算法/ 中/ ,/ 对称/ 加密算法/ 具有/ 比/ 非对称/ 加密算法/ 更/ 高/ 的/ 加密/ 效率/ ,/ 同时/ 若/ 针对/ 每个/ Mimir/ 用户/ 都/ 发布/ 公私/ 密钥/ 对/ ,/ 针对/ 每个/ 密钥/ 对/ 将/ 会/ 产生/ 非常/ 巨大/ 的/ 密文/ 索引/ 量/ ,/ 因此/ 在/ Mimir/ 密文/ 全文检索/ 系统/ 中/ ,/ 索引/ 词/ 的/ 加密/ 采用/ 对称/ 密钥/ 的/ 分组/ 加密算法/ ,/ 如/ DES/ 、/ 3DES/ 、/ AES/ 等/ ./ 在/ 明文/ 全文检索/ 系统/ 中/ ,/ 基于/ 明文/ 索引/ 中/ 的/ 索引/ 词/ 位置/ 的/ 递增/ 关系/ ,/ 检索系统/ 可以/ 方便/ 地/ 判断/ 一个/ 较长/ 的/ 检索/ 词/ 是否/ 出现/ 在/ 某个/ 文档/ 中/ ,/ 因此/ 在/ 全文检索/ 系统/ 中/ ,/ 索引/ 词/ 的/ 位置/ 信息/ 对于/ 较长/ 检索/ 词/ 的/ 判断/ 是/ 非常/ 重要/ 的/ ./ 与/ 式/ (/ 1/ )/ 直接/ 加密/ 索引/ 词/ 改造/ 明文/ 索引/ 的/ 方法/ 不同/ ,/ 为了/ 保证/ 密文/ 索引/ 本身/ 的/ 高/ 安全性/ ,/ Mimir/ 密文/ 全文检索/ 系统/ 中/ 并/ 没有/ 标识/ 每个/ 索引/ 词/ 的/ 位置/ 信息/ ,/ 因此/ 如何/ 实现/ 较长/ 检索/ 词/ 的/ 匹配/ 就/ 成为/ 了/ 一个/ 关键问题/ ./ 如果/ 能够/ 在/ 密文/ 全文索引/ 中/ 存储/ 文档/ 所有/ 可能/ 出现/ 的/ 检索/ 词/ ,/ 则/ 就/ 可以/ 不/ 需要/ 索引/ 词/ 的/ 位置/ 信息/ ./ 但是/ 首先/ 不/ 可能/ 穷举/ 用户/ 可能/ 提出/ 所有/ 查询/ 关键词/ ,/ 而且/ 大量/ 地/ 插入/ 较长/ 的/ 组合/ 索引/ 词/ 也/ 会/ 极大/ 地/ 增加/ 密文/ 索引/ 的/ 空间/ 规模/ ,/ 而/ 导致/ 密文/ 全文检索/ 效率/ 的/ 下降/ ./ 同时/ 由于/ 被/ 查询/ 命中/ 的/ 概率/ 很小/ ,/ 词长/ 太长/ 的/ 索引/ 词/ 对于/ 全文检索/ 的/ 贡献/ 也/ 比较/ 小/ ./ 因此/ 有/ 必要/ 针对/ Mimir/ 系统/ 特点/ 设计/ 一种/ 不/ 需要/ 索引/ 词/ 位置/ 信息/ 支持/ 的/ 文档/ 归档/ 索引/ 词/ 提取策略/ ,/ 即/ 定义/ 1/ 中/ 的/ F/ 部分/ ./ Mimir/ 设计/ 了/ 一种/ 限制/ 最大/ 归档/ 索引/ 词长/ 的/ 文档/ 归档/ 策略/ ,/ Mimir/ 归档/ 索引/ 词/ 提取策略/ 如/ 算法/ 1/ 所示/ ,/ 算法/ 1/ 可以/ 提取/ 文档/ 中/ 所有/ 词/ 长不大/ 于/ k/ 的/ 索引/ 词/ ./ 算法/ 1/ ./ Mimir/ 文档/ 归档/ 索引/ 词/ 构建/ 算法/ ./ 输入/ :/ 待/ 归档/ 的/ 文档/ d/ ,/ 最长/ 索引/ 词长/ k/ 输出/ :/ 待/ 归档/ 索引/ 词/ 集合/ TDocumentToToken/ (/ d/ )/ BEGIN1/ ./ T/ (/ t1/ ,/ t2/ ,/ …/ ,/ tn/ )/ =/ Segment/ (/ d/ )/ ;/ // // 将/ 文档/ d/ 分割/ 为/ 2/ ./ for/ (/ inti/ =/ 1/ ;/ i/ </ n/ ;/ i/ ++/ )/ {/ 3/ ./ for/ (/ intj/ =/ i/ ;/ ∑/ j4/ ./ if/ (/ (/ ti/ +/ ti/ +/ 1/ +/ …/ +/ tj/ )/ notinT/ )/ // // 新/ 的/ 索引/ 词/ 5/ ./ put/ (/ ti/ +/ ti/ +/ 1/ +/ …/ +/ tj/ )/ intoT/ ;/ // // 将/ ti/ 到/ tj/ 的/ 6/ ./ }/ 7/ ./ }/ 8/ ./ ReturnT/ ;/ END/ 在/ 全文检索/ 系统/ 中/ ,/ 中文/ 的/ 分词/ 和/ 西文/ 的/ 分词/ 有/ 较大/ 的/ 区别/ ,/ 西文/ 单词/ 之间/ 有/ 天然/ 的/ 分割/ 标识/ ,/ 而/ 中文/ 分词/ 相对来说/ 需要/ 结合/ 上下文/ 进行/ 处理/ ./ 现在/ 部分/ 全文检索/ 系统/ 的/ 文档/ 索引/ 词/ 提取/ 方法/ 仍然/ 是/ 基于/ 单字/ 的/ ,/ 在/ 全文索引/ 中/ 通过/ 地址/ 信息/ 判断/ 文档/ 中较/ 长词/ 的/ 存在/ ./ 基于/ 算法/ 1/ ,/ 对于/ 一篇/ 字数/ 为/ N/ (/ N/ / k/ )/ 的/ 文档/ d/ 采用/ 单字/ 划分/ 的/ 分词/ 策略/ Segment/ (/ d/ )/ 构建/ 索引/ 词/ 集合/ ,/ 则/ 其/ 归档/ 索引/ 词/ T/ 的/ 规模/ 可以/ 表示/ 为/ Size/ (/ T/ )/ =/ (/ N/ -/ k/ +/ 1/ )/ k/ +/ (/ k/ -/ 1/ )/ k/ // 2/ ≈/ O/ (/ Nk/ )/ ./ 因此/ 若/ 基于/ 单字/ 划分/ 的/ 分词/ 策略/ 利用/ 算法/ 1/ 构建/ 索引/ 词/ ,/ 则/ 文档/ 的/ 索引/ 词/ 规模/ 将会/ 非常/ 巨大/ ,/ 而且/ 采用/ 单字/ 划分/ 会/ 有/ 很多/ 组合/ 索引/ 词/ 没有/ 实际/ 语义/ ,/ 因此/ 有/ 必要/ 对/ 归档/ 索引/ 词/ 构建/ 策略/ 进行/ 改进/ ./ 为了/ 控制/ 索引/ 词/ 规模/ ,/ 提高/ 检索/ 效率/ ,/ Mimir/ 对/ 算法/ 1/ 进行/ 了/ 改进/ ./ 改进/ 算法/ 中/ 首先/ 利用/ 现有/ 的/ 中文/ 分词/ 算法/ 对/ 文档/ 进行/ 分词/ ,/ 以/ 减少/ 待处理/ 的/ 单元/ ,/ 并/ 使得/ 所有/ 归档/ 关键词/ 都/ 有/ 实际意义/ ./ 改进/ 算法/ 中/ 进一步/ 利用/ 停/ 用词/ 来/ 控制/ 索引/ 词/ 规模/ ./ 所谓/ 停/ 用词/ 是/ 被/ 认为/ 不会/ 被/ 用户/ 检索/ 到/ 的/ 内容/ ,/ 主要/ 包括/ 标点/ 、/ 虚词/ 、/ 连接/ 助词/ 等/ ./ Mimir/ 系统/ 中/ 把/ 停/ 用词/ 认为/ 是/ 文章/ 语义/ 的/ 局部/ 中断/ ,/ 从而/ 中断/ 归档/ 索引/ 词/ 的/ 提取/ 工作/ ,/ 改进/ 算法/ Page6/ 如/ 算法/ 2/ 所示/ ./ 算法/ ./ 算法/ 2/ ./ Mimir/ 文档/ 归档/ 索引/ 词/ 构建/ 改进/ 输入/ :/ 待/ 归档/ 的/ 文档/ d/ ,/ 最大/ 索引/ 词长/ k/ ,/ 停/ 用词/ 列表/ 输出/ :/ 待/ 归档/ 索引/ 词/ 集合/ TDocumentToToken/ (/ d/ )/ BEGIN1/ ./ T/ (/ t1/ ,/ t2/ ,/ …/ ,/ tn/ )/ =/ Segment/ (/ d/ )/ ;/ // // 利用/ 中文/ 分词/ 策略/ 2/ ./ for/ (/ inti/ =/ 1/ ;/ i/ </ n/ ;/ i/ ++/ )/ {/ 3/ ./ if/ (/ tiinStopWordsList/ )/ continue/ ;/ 4/ ./ for/ (/ intj/ =/ i/ ;/ ∑/ j5/ ./ if/ (/ tjinStopWordsList/ )/ 6/ ./ break/ ;/ 7/ ./ else8/ ./ if/ (/ (/ ti/ +/ ti/ +/ 1/ +/ …/ +/ tj/ )/ notinT/ )/ // // 新/ 的/ 索引/ 词/ 9/ ./ put/ (/ ti/ +/ ti/ +/ 1/ +/ …/ +/ tj/ )/ intoT/ ;/ // // 将/ ti/ 到/ tj/ 的/ 10/ ./ }/ 11/ ./ }/ 12/ ./ ReturnT/ ;/ END/ 下面/ 分析/ 一下/ 采用/ 改进/ 归档/ 策略/ 后/ 的/ 密文/ 索引/ 词/ 规模/ ./ 中文/ 分词/ 领域/ 学者/ 对/ 中文/ 语库/ 统计分析/ 后/ 得到/ 中文/ 词/ 长/ 比例/ 数据/ 如表/ 1/ 所示/ ①/ ./ 可以/ 认为/ 中文/ 词汇/ 的/ 平均/ 字长/ 如式/ (/ 3/ )/ 所示/ 约/ 为/ 2.73/ (/ 表/ 1/ 中五字/ 以上/ 词/ 按/ 词长/ 五/ 进行/ 计算/ )/ ./ 对于/ 一篇/ 字数/ 为/ N/ (/ N/ / k/ )/ 的/ 文档/ d/ ,/ 其/ 经过/ 分词/ 处理/ 后/ 的/ 分词/ 单元/ 总数/ 为/ N/ // 2.73/ ,/ 设定/ 其中/ 停/ 用词/ 比例/ 为/ p/ ,/ 且/ 均匀分布/ 在/ 文档/ d/ 中/ ,/ 最大/ 归档/ 词长/ 为/ k/ ,/ 则/ 其/ 归档/ 索引/ 词/ T/ 的/ 规模/ Size/ (/ T/ )/ 如式/ (/ 4/ )/ 所示/ ./ 其中/ N2/ ./ 73/ ×/ k/ 用词/ 时/ 的/ 文档/ 索引/ 词/ 规模/ ,/ N/ 示/ 考虑/ 停/ 用词/ 后/ 减少/ 的/ 索引/ 词/ 规模/ ./ 由式/ (/ 4/ )/ 可以/ 发现/ 采用/ 改进/ 归档/ 策略/ 后/ 文档/ 索引/ 词/ 规模/ 远远/ 小于/ 由/ 五/ 字词/ 及/ 以上/ 算法/ 1/ 处理/ 得到/ 的/ 索引/ 词/ 规模/ ,/ 同时/ 两种/ 归档/ 算法/ 在/ 有/ 意义/ 的/ 索引/ 词/ 规模/ 上/ 是/ 相同/ 的/ ,/ 对于/ 检索系统/ 的/ 贡献/ 也/ 是/ 等价/ 的/ ./ 实验/ 4.2/ 节/ 中将/ 对/ 两种/ 归档/ 策略/ 的/ 索引/ 词/ 规模/ 进行/ 测试/ 分析/ ./ AVG/ _/ chinesewordlength/ =/ ∑/ k/ ×/ proportionofk/ _/ lengthword/ =/ 1/ ×/ 3.61/ %/ +/ 2/ ×/ 47.74/ %/ +/ …/ +/ 5/ ×/ 7.26/ %/ =/ 2.73/ Size/ (/ T/ )/ =/ NMimir/ 密文/ 全文检索/ 系统/ 的/ 检索/ 流程/ 如式/ (/ 5/ )/ 所示/ ,/ 当/ 用户/ 提交/ 查询/ 请求/ Q/ 后/ ,/ 首先/ 对/ 查询/ 请求/ Q/ 进行/ 分解/ ,/ 获得/ 若干/ 查询/ 条件/ 子/ 单元/ 的/ 析取/ 或/ 合取范式/ q1/ (/ ∧/ ,/ ∨/ )/ q2/ (/ ∧/ ,/ ∨/ )/ q3/ ,/ …/ ,/ qn/ ,/ 例如/ 用户/ 提出/ 的/ 查询/ 请求/ 为/ 文档/ 内容/ 中/ 包括/ 武汉大学/ 和/ 密文/ 处理/ 的/ 所有/ 文档/ ,/ 则/ 分解/ 得到/ 的/ 查询/ 条件/ 子/ 单元/ 为/ “/ 武汉大学/ ”/ ∧/ “/ 密文/ 处理/ ”/ ./ 再/ 利用/ 与/ 归档/ 过程/ 中/ 相同/ 的/ 分词/ 算法/ 对/ 每个/ 查询/ 子/ 单元/ 进行/ 分词/ 处理/ ,/ 将/ 每个/ 查询/ 条件/ 子/ 单元/ 解析/ 成为/ 分词/ 的/ 析取/ 表达式/ ./ 最后/ 得到/ 整个/ 查询/ 请求/ Q/ 的/ 分词/ 析取/ 与/ 合取范式/ W/ (/ w1/ ,/ w2/ ,/ …/ ,/ wn/ )/ ./ 再/ 利用/ 构建/ 索引/ 过程/ 一致/ 的/ 加密算法/ 对/ 明文/ 查询/ 请求/ 分词/ 进行/ 加密/ 得到/ 密文/ 检索/ 条件/ EW/ (/ ew1/ ,/ ew2/ ,/ …/ ,/ ewn/ )/ ,/ 并/ 基于/ 图/ 1/ 所示/ 密文/ 索引/ 进行/ 全文检索/ ,/ 得到/ 整个/ 检索系统/ 中/ 所有/ 密文/ 检索/ 词/ 命中/ 的/ 全部/ 文档/ ./ 最后/ 通过/ 排序/ 策略/ 对/ 全部/ 命中/ 文档/ 集/ 进行/ 排序/ 处理/ 后/ 最终/ 返回/ 给/ 用户/ ,/ 排序/ 策略/ 在/ 3.3/ 节中/ 做/ 详细/ 介绍/ ./ Q/ →/ q1/ (/ ∧/ ,/ ∨/ )/ q2/ ,/ …/ ,/ qnEncryp/ →/ / / / / tionEW/ (/ ew1/ ,/ ew2/ ,/ …/ ,/ ewn/ )/ →/ / / / SearchResults/ (/ 5/ )/ 3.3/ Mimir/ 排序/ 算法/ 全文检索/ 系统/ 中/ 需要/ 处理/ 的/ 文档/ 都/ 是/ 海量/ 的/ ,/ 对于/ 一个/ 查询/ 条件/ 来说/ 命中/ 的/ 文档/ 数量/ 也/ 非常/ 大/ ,/ 结果/ 排序/ 就是/ 将/ 用户/ 最/ 感兴趣/ 的/ 内容/ 优先/ 呈现/ 给/ 用户/ ,/ 对于/ 一个/ 全文检索/ 系统/ 的/ 可用性/ 来说/ 是/ 非常/ 重要/ 的/ ./ 目前/ 的/ 全文检索/ 系统/ 中/ 通常/ 都/ 采用/ 基于/ 检索/ 关键词/ 词频/ 的/ 评分/ 机制/ ,/ 其/ 排序/ 评分/ 策略/ 通常/ 如/ 

