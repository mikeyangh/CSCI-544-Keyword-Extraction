Page1/ 一种/ 求解/ MPMGOOC/ 问题/ 的/ 启发式/ 算法/ 武优西/ 1/ )/ ,/ 5/ )/ 吴信东/ 2/ )/ ,/ 5/ )/ 江贺/ 3/ )/ ,/ 5/ )/ 闵帆/ 4/ )/ ,/ 5/ )/ 1/ )/ (/ 河北/ 工业/ 大学/ 计算机科学/ 与/ 软件/ 学院/ 天津/ 300130/ )/ 2/ )/ (/ 合肥工业大学/ 计算机科学/ 与/ 信息/ 工程学院/ 合肥/ 230009/ )/ 3/ )/ (/ 大连理工大学/ 软件/ 学院/ 辽宁大连/ 116621/ )/ 4/ )/ (/ 漳州/ 师范学院/ 粒/ 计算/ 重点/ 实验室/ 福建/ 漳州/ 363000/ )/ 5/ )/ (/ 佛蒙特/ 大学/ 计算机系/ 佛蒙特州/ 伯灵顿/ 05405/ 美国/ )/ 摘要/ 具有/ 间隙/ 约束/ 和/ 一次性/ 条件/ 的/ 最大/ 模式匹配/ (/ MaximumPatternMatchingwithGapsandOne/ -/ OffCondition/ ,/ MPMGOOC/ )/ 是/ 一种/ 具有/ 通配符/ 长度/ 约束/ 的/ 模式匹配/ 问题/ ,/ 其/ 任务/ 是/ 寻找/ 彼此/ 互不/ 相关/ 的/ 最/ 多/ 出现/ ./ 文中/ 基于/ 一种/ 新/ 的/ 非线性/ 数据结构/ —/ —/ —/ 网树/ ,/ 提出/ 了/ 一种/ 解决/ MPMGOOC/ 问题/ 的/ 启发式/ 算法/ ./ 与/ 树结构/ 不同之处/ 在于/ ,/ 除根/ 结点/ 外/ ,/ 网树中/ 任何/ 结点/ 可以/ 多于/ 1/ 个/ 双亲/ 结点/ ./ 文中/ 给出/ 了/ 网树/ 的/ 定义/ 及其/ 相关/ 的/ 概念/ 和/ 性质/ ./ 基于/ 这些/ 概念/ 和/ 性质/ ,/ 提出/ 了/ 一种/ 选择/ 较优/ 出现/ (/ SelectingBetterOccurrence/ ,/ SBO/ )/ 的/ 启发式/ 算法/ ./ 该/ 算法/ 在/ 搜索/ 一个/ 出现/ 的/ 循环/ 中/ ,/ 采用/ 了/ 贪婪/ 搜索/ 双亲/ 策略/ (/ StrategyofGreedy/ -/ SearchParent/ ,/ SGSP/ )/ 和/ 最右/ 双亲/ 策略/ (/ StrategyofRightMostParent/ ,/ SRMP/ )/ 寻找/ 相同/ 叶子/ 的/ 两个/ 出现/ 并/ 选择/ 其中/ 较/ 好/ 的/ 出现/ 作为/ SBO/ 算法/ 的/ 结果/ ./ SGSP/ 策略/ 的/ 核心思想/ 是/ 每/ 一步/ 都/ 寻找/ 当前/ 结点/ 的/ 一个/ 近似/ 最优/ 双亲/ (/ ApproximatelyOptimimalParent/ ,/ AOP/ )/ ;/ SRMP/ 策略/ 的/ 核心思想/ 是/ 每/ 一步/ 都/ 寻找/ 当前/ 结点/ 的/ 最右/ 双亲/ 结点/ ./ 实验/ 结果表明/ ,/ 在/ 多数/ 情况/ 下/ SBO/ 算法/ 可以/ 获得/ 更好/ 的/ 解且/ 解/ 的/ 质量/ 较/ 其它/ 算法/ 有/ 显著/ 的/ 提高/ ./ 文中/ 不但/ 提供/ 了/ 一个/ 解决/ MPMGOOC/ 问题/ 的/ 启发式/ 算法/ ,/ 更/ 重要/ 的/ 是/ 对于/ 求解/ 其它/ 复杂/ 问题/ 具有/ 一定/ 的/ 参考价值/ ./ 关键词/ 模式匹配/ ;/ 通配符/ ;/ 一次性/ 条件/ ;/ 网树/ ;/ 启发式/ 算法/ 1/ 引言/ 模式匹配/ 问题/ (/ 也/ 称串/ 匹配/ 问题/ )/ 是/ 计算机科学/ 的/ 基本/ 问题/ 之一/ ,/ 它/ 是/ 网络安全/ [/ 1/ ]/ 、/ 信息检索/ 与/ 过滤/ [/ 2/ ]/ 、/ 文字处理/ [/ 3/ ]/ 、/ 计算/ 生物学/ [/ 4/ ]/ 等/ 重要/ 领域/ 的/ 核心/ 问题/ ,/ 同时/ 也/ 是/ 模式/ 挖掘/ 技术/ 的/ 核心/ 与/ 基础/ [/ 5/ -/ 7/ ]/ ./ 而/ 带有/ 通配符/ 的/ 模式匹配/ 与/ 模式/ 挖掘/ 使得/ 问题/ 变得/ 更加/ 复杂/ [/ 8/ ]/ ./ 在/ 带有/ 通配符/ 的/ 模式匹配/ 研究/ 中/ ,/ 主要/ 有/ 两类/ 研究成果/ ,/ 一类/ 偏向/ 于/ 通配符/ 通配/ 的/ 字符/ 长度/ 是/ 固定/ 的/ ;/ 另一类/ 偏向/ 于/ 通配符/ 通配/ 的/ 长度/ 是/ 有/ 约束/ 的/ ./ Fischer/ 和/ Paterson/ [/ 9/ ]/ 在/ 1974/ 年/ 第一次/ 从/ 理论/ 复杂性/ 角度/ 对/ 带有/ 通配符/ 的/ 模式匹配/ 问题/ 进行/ 了/ 研究/ ./ 近年来/ ,/ 通配符/ 通配/ 的/ 长度/ 是/ 可变/ 的/ 问题/ 正/ 引起/ 人们/ 的/ 广泛/ 关注/ ./ Manber/ 等/ 人/ [/ 10/ ]/ 提出/ 的/ 算法/ 有效/ 地/ 解决/ 了/ 只有/ 单个/ 可变/ 长度/ 通配符/ 的/ 模式匹配/ 问题/ ;/ He/ 等/ 人/ [/ 8/ ]/ 致力于/ 通配/ 长度/ 小于/ 指定/ 值/ 的/ 频度/ 模式/ 挖掘/ 问题/ ;/ Huang/ 等/ 人/ [/ 11/ ]/ 致力于/ 具有/ 多个/ 可变/ 长度/ 通配符/ 和/ 一次性/ 条件/ 的/ 频度/ 模式/ 挖掘/ 问题/ ;/ Min/ 等/ 人/ [/ 12/ ]/ 提出/ 了/ 一个/ 算法/ PAIG/ -/ RST/ (/ ReducedSpaceandTime/ )/ ,/ 该/ 算法/ 有效/ 地/ 解决/ 了/ 具有/ 多个/ 可变/ 长度/ 通配符/ 的/ 模式匹配/ 问题/ ;/ Chen/ 等/ 人/ [/ 13/ ]/ 提出/ 了/ 用于/ 在线/ 求解/ 具有/ 间隙/ 约束/ 和/ 一次性/ 条件/ 的/ 最大/ 模式匹配/ 问题/ (/ MaximumPatternMatchingwithGapandOne/ -/ OffConstraints/ ,/ MPMGOOC/ )/ 的/ SAIL/ 算法/ ,/ 然而/ 该/ 算法/ 不是/ 一个/ 完备/ 的/ 离线/ 算法/ [/ 11/ ]/ ./ 本文/ 提出/ 的/ 基于/ 网树/ 的/ 启发式/ 算法/ ,/ 可/ 很/ 好/ 地/ 求解/ 离线/ MPMGOOC/ 问题/ ./ 网/ 树结构/ (/ 简称/ 网树/ )/ [/ 14/ ]/ 是/ 对/ 树结构/ 进行/ 拓展/ 的/ 一种/ 新/ 的/ 非线性/ 数据结构/ ./ 网树/ 不但/ 具有/ 很多/ 树结构/ 的/ 概念/ ,/ 如/ 树根/ 结点/ 、/ 叶子/ 结点/ 、/ 双亲/ 、/ 孩子/ 、/ 路径/ 、/ 层/ 等/ 概念/ ,/ 而且/ 除根/ 结点/ 外/ 网/ 树结构/ 中/ 任何/ 结点/ 可以/ 有/ 多个/ 双亲/ 结点/ ./ 为了/ 解决/ MPMGOOC/ 问题/ ,/ 本文/ 先/ 将/ 该/ 问题/ 转化/ 为/ 一棵/ 网树/ ,/ 并/ 在/ 网/ 树上/ 构造/ 了/ 许多/ 新/ 的/ 概念/ 和/ 性质/ ,/ 基于/ 这些/ 概念/ 和/ 性质/ ,/ 提出/ 了/ 一个/ 选择/ 较优/ 出现/ SBO/ (/ SelectingBetterOccur/ -/ rence/ )/ 的/ 启发式/ 算法/ ./ SBO/ 算法/ 在/ 计算/ 一个/ 出现/ 的/ 循环/ 中/ ,/ 利用/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ 的/ 概念/ 和/ 性质/ 对/ 问题/ 的/ 全局/ 约束/ 进行/ 了/ 考虑/ ;/ 利用/ 结点/ 的/ 树根/ 路径/ 数/ 、/ 叶子/ 路径/ 数/ 和/ 树根/ -/ 叶子/ 路径/ 数等/ 概念/ 与/ 性质/ 实现/ 对/ 位置/ 出现/ 数/ 的/ 计算/ ./ 在/ 此基础/ 上/ 形成/ 了/ 一个/ 寻找/ 出现/ 的/ 策略/ —/ —/ —/ 贪婪/ 搜索/ 双亲/ 策略/ SGSP/ (/ StrategyofGreedySearchParent/ )/ ,/ 该/ 策略/ 的/ 核心思想/ 是/ 每/ 一步/ 都/ 寻找/ 当前/ 结点/ 的/ 近似/ 最优/ 双亲/ 结点/ AOP/ (/ ApproximateOptimizationParent/ )/ ./ 此外/ ,/ 本文/ 利用/ 结点/ 的/ 最右/ 双亲/ 结点/ 、/ 最小/ 根/ 和/ 最大/ 根等/ 概念/ 实现/ 了/ 另外/ 一个/ 寻找/ 出现/ 的/ 策略/ —/ —/ —/ 最右/ 双亲/ 策略/ SRMP/ (/ StrategyofRightMostParent/ )/ ./ SBO/ 算法/ 择优/ 使用/ SGSP/ 和/ SRMP/ 策略/ 的/ 结果/ 并/ 以此/ 求解/ MPMGOOC/ 问题/ ./ SBO/ 算法/ 的/ 空间/ 复杂度/ 和/ 时间/ 复杂度/ 分别/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ 和/ O/ (/ W/ ×/ n/ ×/ (/ n/ +/ m/ ×/ m/ )/ )/ ,/ 这里/ m/ ,/ n/ 和/ W/ 分别/ 是/ 模式/ 串/ P/ 和/ 序列/ 串/ S/ 的/ 长度/ 以及/ 模式/ 串/ P/ 的/ 最大/ 间距/ ./ 本文/ 在/ 实际/ 生物/ 数据/ 上/ 进行/ 了/ 72/ 组/ 对比性/ 实验/ ,/ 实验/ 结果显示/ :/ (/ 1/ )/ 在/ 其中/ 69/ 个/ 实例/ 中/ ,/ SBO/ 算法/ 的/ 结果/ 好于/ 或/ 持平/ 于/ SAIL/ 算法/ 的/ 结果/ ;/ (/ 2/ )/ SBO/ 算法/ 较/ 大幅度/ 地/ 提高/ 了/ SAIL/ 算法/ 的/ 解/ 的/ 质量/ ;/ (/ 3/ )/ 在/ 其中/ 56/ 个/ 实例/ 上/ SBO/ 算法/ 取得/ 了/ 4/ 个/ 算法/ 中/ 最好/ 的/ 结果/ ,/ 而/ 另外/ 16/ 个/ 实例/ 均/ 十分/ 接近/ 最好/ 解/ ./ 因此/ 通常/ 情况/ 下/ ,/ SBO/ 算法/ 不但/ 可以/ 获得/ 更好/ 的/ 解/ ,/ 而且/ 解/ 的/ 质量/ 较/ SAIL/ 算法/ 有/ 较为/ 显著/ 的/ 提高/ ./ 本文/ 第/ 2/ 节/ 论述/ 问题/ 的/ 定义/ 并/ 通过/ 实例/ 来/ 解释/ MPMGOOC/ 问题/ 及其/ 相关/ 概念/ ;/ 第/ 3/ 节/ 给出/ 网树/ 的/ 概念/ 和/ 性质/ ;/ 第/ 4/ 节/ 给出/ SBO/ 算法/ 同时/ 对/ SBO/ 算法/ 的/ 时间/ 复杂度/ 和/ 空间/ 复杂度/ 进行/ 分析/ ,/ 用/ 实例/ 说明/ 算法/ 的/ 工作/ 原理/ ;/ 第/ 5/ 节/ 给出/ 实际/ 生物/ 数据/ 的/ 测试/ 结果/ 并/ 对/ 结果/ 加以分析/ ;/ 第/ 6/ 节/ 给出/ 本文/ 结论/ ./ Page32/ 问题/ 定义/ 尽管/ Chen/ 等/ 人/ [/ 13/ ]/ 最早/ 提出/ 了/ 该/ 问题/ ,/ 但/ 本节/ 对/ 该/ 问题/ 的/ 定义/ 进行/ 重新/ 描述/ ,/ 并/ 增加/ 一些/ 新/ 的/ 概念/ 和/ 符号/ ./ 通过/ 一些/ 实例/ 对/ 这些/ 定义/ 、/ 概念/ 和/ 符号/ 进行/ 解释/ ./ 定义/ 1/ ./ 给定/ 一个/ 模式/ 串/ P/ =/ p0/ [/ min0/ ,/ max0/ ]/ p1/ …/ [/ minj/ -/ 1/ ,/ maxj/ -/ 1/ ]/ pj/ …/ [/ minm/ -/ 2/ ,/ maxm/ -/ 2/ ]/ pm/ -/ 1/ 和/ 一个/ 序列/ 串/ S/ =/ s0s1/ …/ si/ …/ sn/ -/ 1/ 以及/ 两个/ 整数/ 值/ 最小/ 长度/ Minlen/ 和/ 最大/ 长度/ Maxlen/ ,/ 这里/ m/ 和/ n/ 分别/ 是/ 模式/ 串/ P/ 和/ 序列/ 串/ S/ 的/ 长度/ ,/ pj/ ≠/ / (/ 0/ </ j/ / m/ -/ 1/ )/ ,/ si/ ≠/ / (/ 0/ / i/ / n/ -/ 1/ )/ ./ / 是/ 通配符/ ,/ 可以/ 匹配/ 任何/ 给定/ 的/ 字符/ ./ minj/ -/ 1/ 和/ maxj/ -/ 1/ 是/ 给定/ 整数/ 值/ ,/ 代表/ 模式/ 字符/ pj/ -/ 1/ 和/ pj/ 之间/ 通配符/ 可以/ 匹配/ 的/ 最小/ 和/ 最大/ 长度/ ,/ 这里/ 0/ / minj/ / maxj/ ./ W/ =/ max/ (/ maxj/ -/ minj/ +/ 1/ )/ 称为/ 模式/ 串/ P/ 的/ 最大/ 间距/ ./ Minlen/ 和/ Maxlen/ 称为/ 全局/ 约束/ ,/ minj/ 和/ maxj/ 称为/ 局部/ 约束/ [/ 13/ ]/ ./ 定义/ 2/ ./ 如果/ 一个/ 位置/ 索引/ 序列/ A/ =/ 〈/ a0/ ,/ …/ ,/ aj/ ,/ …/ ,/ am/ -/ 1/ 〉/ 服从/ 如下/ 约束条件/ 这里/ 0/ / j/ / m/ -/ 1/ 且/ 0/ / aj/ / n/ -/ 1/ ,/ 则/ 称/ A/ 是/ P/ 在/ S/ 中/ 的/ 一个/ 出现/ [/ 13/ ]/ ./ 定义/ 3/ ./ 令/ 集合/ T/ (/ S/ ,/ P/ )/ 代表/ 模式/ 串/ P/ 在/ 序列/ 串/ S/ 中/ 的/ 所有/ 出现/ ,/ 集合/ T/ (/ S/ ,/ P/ )/ 的/ 长度/ 用/ |/ T/ (/ S/ ,/ P/ )/ |/ 来/ 表示/ ./ 定义/ 4/ ./ 给定/ 两个/ 出现/ B/ =/ 〈/ b0/ ,/ …/ ,/ bj/ ,/ …/ ,/ bm/ -/ 1/ 〉/ 和/ C/ =/ 〈/ c0/ ,/ …/ ,/ ck/ ,/ …/ ,/ cm/ -/ 1/ 〉/ ,/ 如果/ 存在/ bj/ =/ ck/ ,/ 则/ 称/ 出现/ B/ 与/ 出现/ C/ 相关/ 并称/ 出现/ B/ 和/ C/ 都/ 包含/ 位置/ bj/ ,/ 这里/ 0/ / j/ </ m/ 且/ 0/ / k/ </ m/ ;/ 否则/ 称/ 出现/ B/ 和/ C/ 互不/ 相关/ ./ 定义/ 5/ ./ T/ (/ S/ ,/ P/ )/ 中/ 子集/ T1/ (/ S/ ,/ P/ )/ 满足/ 的/ 任何/ 两个/ 出现/ 都/ 是/ 彼此/ 不/ 相关/ 的/ ,/ 则/ 称/ 子集/ T1/ (/ S/ ,/ P/ )/ 是/ 具有/ 间隙/ 约束/ 和/ 一次性/ 条件/ 的/ 模式匹配/ PMGOOC/ (/ PatternMatchingwithGapsandOne/ -/ OffCondi/ -/ tion/ )/ ./ 满足/ PMGOOC/ 的/ 最大/ 子集/ T1/ (/ S/ ,/ P/ )/ 称为/ 具有/ 间隙/ 约束/ 和/ 一次性/ 条件/ 的/ 最大/ 模式匹配/ MPMGOOC/ (/ MaximumPatternMatchingwithGapsandOne/ -/ OffCondition/ )/ ./ 定义/ 6/ ./ 给定/ 一个/ 出现/ B/ =/ 〈/ b0/ ,/ …/ ,/ bj/ ,/ …/ ,/ bm/ -/ 1/ 〉/ 和/ 一个/ 集合/ D/ =/ {/ d0/ ,/ …/ ,/ dr/ ,/ …/ ,/ dl/ -/ 1/ }/ ,/ 如果/ bj/ =/ dr/ ,/ 则/ 称/ 出现/ B/ 与/ 集合/ D/ 相关/ ,/ 这里/ 0/ / j/ </ m/ 且/ 0/ / r/ </ l/ ./ 与/ 集合/ D/ 相关/ 的/ 所有/ 出现/ 的/ 数目/ 称为/ 集合/ 相关/ 数/ ,/ 用/ RS/ (/ D/ )/ 来/ 表示/ ./ 定义/ 7/ ./ 与/ 出现/ B/ 相关/ 的/ 所有/ 出现/ 的/ 数目/ 称为/ 出现/ 相关/ 数/ ,/ 用/ RO/ (/ B/ )/ 表示/ ;/ 包含/ 位置/ i/ (/ 0/ / i/ / |/ S/ |/ -/ 1/ )/ 的/ 所有/ 出现/ 的/ 数目/ 称为/ 位置/ 相关/ 数/ ,/ 用/ RP/ (/ i/ )/ 来/ 表示/ ./ 定义/ 8/ ./ 假定/ e/ / D1/ 且/ D2/ =/ D1/ ∪/ {/ e/ }/ ,/ 增加/ e/ 后/ ,/ 多/ 增加/ 的/ 相关/ 出现/ 的/ 数目/ 称为/ 新增/ 数/ ,/ 用/ I/ (/ e/ ,/ D1/ )/ 来/ 表示/ ,/ 其/ 计算方法/ 为/ I/ (/ e/ ,/ D1/ )/ =/ RS/ (/ D2/ )/ -/ RS/ (/ D1/ )/ ./ 定义/ 9/ ./ 令/ B/ =/ 〈/ b0/ ,/ …/ ,/ bj/ ,/ …/ ,/ bm/ -/ 1/ 〉/ 是/ 给定/ 模式/ 串/ P/ 和/ 序列/ 串/ S/ 下/ 的/ 一个/ 出现/ ,/ 在/ 一次性/ 条件/ (/ One/ -/ OffCondition/ )/ 下/ ,/ 新/ 序列/ 串/ S/ / =/ s/ / 0s/ / 1/ …/ s/ / k/ …/ s/ / n/ -/ 1/ 是/ 在/ 出现/ B/ 下/ 的/ 新/ 序列/ ,/ 记/ 为/ (/ S/ -/ B/ )/ ,/ 其/ s/ / k/ 计算方法/ 如下/ :/ 这里/ X/ 表示/ 为/ 一个/ 不可/ 匹配/ 的/ 字符/ ./ 下面/ 给出/ 3/ 个/ 实例/ 对/ 问题/ 的/ 定义/ 及其/ 相关/ 概念/ 与/ 符号/ 进行/ 解释/ ./ 例/ 1/ ./ 给定/ 模式/ 串/ P/ =/ a/ [/ 0/ ,/ 1/ ]/ b/ [/ 0/ ,/ 1/ ]/ c/ ,/ 序列/ 串/ S/ =/ aabbcc/ 以及/ 最小/ 和/ 最大/ 长度/ 分别/ 为/ MinLen/ =/ 3/ ,/ MaxLen/ =/ 5/ ./ 依据/ 给定/ 条件/ 可知/ ,/ 模式/ 串/ P/ 在/ 序列/ 串/ S/ 中/ 所有/ 出现/ T/ (/ S/ ,/ P/ )/ 是/ {/ 〈/ 0/ ,/ 2/ ,/ 4/ 〉/ ,/ 〈/ 1/ ,/ 2/ ,/ 4/ 〉/ ,/ 〈/ 1/ ,/ 3/ ,/ 4/ 〉/ ,/ 〈/ 1/ ,/ 3/ ,/ 5/ 〉/ }/ ,/ 故/ |/ T/ (/ S/ ,/ P/ )/ |/ 为/ 4/ ./ 依据/ 定义/ 5/ 可知/ ,/ MPMGOOC/ 问题/ 的/ 解是/ {/ 〈/ 0/ ,/ 2/ ,/ 4/ 〉/ ,/ 〈/ 1/ ,/ 3/ ,/ 5/ 〉/ }/ ,/ 因为/ 这/ 两个/ 出现/ 是/ T/ (/ S/ ,/ P/ )/ 中/ 互不/ 相关/ 最大/ 子集/ ./ 例/ 2/ ./ 与/ 例/ 1/ 相同/ 的/ P/ ,/ S/ 及/ 全局/ 约束条件/ ,/ 并令/ 两个/ 出现/ B/ =/ 〈/ 0/ ,/ 2/ ,/ 4/ 〉/ 和/ C/ =/ 〈/ 1/ ,/ 3/ ,/ 4/ 〉/ ,/ D/ =/ {/ 2/ ,/ 3/ }/ 和/ i/ =/ 2/ ./ 依据/ 定义/ 4/ 可知/ ,/ 出现/ B/ 和/ C/ 是/ 相关/ 的/ ,/ 因为/ 出现/ B/ 和/ C/ 中/ 都/ 包含/ 位置/ 4/ ;/ 依据/ 定义/ 6/ 可知/ ,/ 出现/ B/ 和/ C/ 都/ 与/ 集合/ D/ 是/ 相关/ 的/ ,/ 因为/ 出现/ B/ 和/ C/ 分别/ 包含/ 2/ 和/ 3/ ,/ 而/ 2/ 和/ 3/ 是/ 集合/ D/ 的/ 两个/ 元素/ ./ 依据/ 定义/ 6/ 和/ 7/ 可知/ ,/ RO/ (/ B/ )/ =/ 3/ ,/ RO/ (/ C/ )/ =/ 4/ ,/ RP/ (/ i/ )/ =/ 2/ 以及/ RS/ (/ D/ )/ =/ 4/ ./ 依据/ 定义/ 9/ 可知/ ,/ 在/ one/ -/ off/ 条件/ 下/ ,/ 在/ 出现/ B/ 下/ 的/ 新/ 序列/ 串为/ aXbXcX/ ./ 例/ 3/ ./ 与/ 例/ 1/ 相同/ 的/ P/ ,/ S/ 及/ 全局/ 约束条件/ ,/ 并令/ e/ =/ 3/ 且/ D1/ =/ {/ 2/ ,/ 4/ }/ ./ 依据/ 定义/ 6/ 和/ 8/ 可知/ ,/ RS/ (/ D1/ )/ =/ 3/ 且/ I/ (/ b/ ,/ D1/ )/ =/ RS/ (/ {/ 2/ ,/ 3/ ,/ 4/ }/ )/ -/ RS/ (/ {/ 2/ ,/ 4/ }/ )/ =/ 1/ ./ Page43/ 网树/ 的/ 定义/ 及/ 性质/ 文献/ [/ 14/ ]/ 最早/ 给出/ 了/ 网树/ 的/ 定义/ ,/ 但是/ 为了/ 求解/ MPMGOOC/ 问题/ ,/ 本节/ 在/ 网树/ 定义/ 的/ 基础/ 上/ ,/ 给出/ 了/ 网树/ 的/ 一些/ 新/ 概念/ 和/ 性质/ 并/ 对/ 这些/ 概念/ 和/ 性质/ 进行/ 了/ 解释/ ./ 定义/ 10/ ./ 网树/ [/ 14/ ]/ 是/ 一种/ 每条/ 边/ 具有/ “/ 双亲/ -/ 孩子/ 关系/ ”/ 或/ “/ 孩子/ -/ 双亲/ 关系/ ”/ 边/ 标签/ 的/ 有/ 向/ 无/ 环图/ DAG/ (/ DirectedAcyclicGraph/ )/ 且/ 网树中/ 每个/ 结点/ 都/ 可以/ 有/ 0/ 个/ 或/ 多个/ 孩子/ 结点/ 以及/ 0/ 个/ 或/ 多个/ 双亲/ 结点/ ./ 网树/ 还/ 具有/ 如下/ 5/ 个/ 性质/ :/ (/ 1/ )/ 网树/ 是/ 树结构/ 的/ 拓展/ ,/ 它/ 具备/ 很多/ 与/ 树/ 相似/ 的/ 概念/ ,/ 如根/ 结点/ 、/ 叶子/ 结点/ 、/ 层/ 、/ 双亲/ 、/ 孩子/ 等/ 概念/ ;/ 双亲/ 结点/ ;/ 路径/ 数/ 可以/ 不/ 唯一/ ;/ (/ 2/ )/ 一棵/ 网树/ 可以/ 有/ 多个/ 根/ 结点/ ;/ (/ 3/ )/ 除根/ 结点/ 之外/ 网树/ 的/ 其它/ 结点/ 可以/ 有/ 多个/ (/ 4/ )/ 从/ 任意/ 一个/ 结点/ 到达/ 网树/ 的/ 一个/ 根/ 结点/ 的/ (/ 5/ )/ 相同/ 结点/ 名称/ 的/ 结点/ 可以/ 在/ 网树/ 的/ 不同/ 层上/ 多次/ 出现/ ./ 定义/ 11/ ./ 如果/ 网树中/ 所有/ 结点/ 都/ 仅/ 出现/ 一次/ ,/ 可以/ 直接/ 使用/ 结点/ 的/ 名称/ 来/ 表示/ 该/ 结点/ ;/ 否则/ 如果/ 结点/ i/ 在/ 不同/ 层上/ 多次/ 出现/ ,/ 用/ ni/ 的/ 结点/ i/ ./ 定义/ 12/ ./ 如果/ 结点/ b/ 在/ 结点/ c/ 与/ 某/ 一根/ 结点/ 的/ 路径/ 上/ ,/ 则/ 称/ 结点/ b/ 是/ 结点/ c/ 的/ 祖先/ ./ 当前/ 结点/ 看作/ 是/ 自身/ 的/ 一个/ 祖先/ ./ 结点/ c/ 的/ 祖先/ 集是/ 由/ 结点/ c/ 的/ 所有/ 祖先/ 构成/ 的/ ,/ 用/ A/ (/ c/ )/ 表示/ ./ 定义/ 13/ ./ 给定/ 一个/ 结点/ 集合/ D/ =/ {/ d0/ ,/ d1/ ,/ …/ ,/ dl/ -/ 1/ }/ ,/ 集合/ D/ 的/ 所有/ 元素/ 的/ 祖先/ 集/ 的/ 交集/ 称为/ 集合/ D/ 的/ 共同/ 祖先/ 集/ (/ Commonascendant/ )/ ,/ 用/ C/ (/ D/ )/ 表示/ ,/ 其/ 计算方法/ 为/ C/ (/ D/ )/ =/ A/ (/ d0/ )/ ∩/ A/ (/ d1/ )/ ∩/ …/ ∩/ A/ (/ dl/ -/ 1/ )/ (/ 3/ )/ 定义/ 14/ ./ 从/ 结点/ ni/ 树根/ 路径/ 数/ RPN/ (/ RootPathNumber/ )/ ,/ 用/ Nr/ (/ ni/ 来/ 表示/ ./ 根/ 结点/ ni1/ 的/ 树根/ 路径/ 数为/ 1/ ,/ 即/ Nr/ (/ ni1/ )/ =/ 1/ ./ 结点/ 的/ 树根/ 路径/ 数/ 之/ 和/ ,/ 即/ 性质/ 1/ ./ 结点/ ni/ 这里/ nikj/ -/ 1/ 是/ 结点/ ni/ 亲数/ ./ 定义/ 15/ ./ 从/ 结点/ ni/ 径数/ 称为/ 叶子/ 路径/ 数/ LPN/ (/ LeafPathNumber/ )/ ,/ 用/ Nl/ (/ nij/ )/ 来/ 表示/ ,/ 这里/ m/ 是/ 网树/ 的/ 深度/ ./ 叶子/ nim/ 的/ 叶子/ 路径/ 数为/ 1/ ,/ 即/ Nl/ (/ nim/ )/ =/ 1/ ./ 性质/ 2/ ./ 结点/ ni/ 结点/ 的/ 叶子/ 路径/ 数/ 之/ 和/ ,/ 即/ 这里/ nikj/ +/ 1/ 是/ 结点/ ni/ 子数/ ./ 定义/ 16/ ./ 从/ 所有/ 根/ 结点/ 到/ 第/ m/ 层/ 叶子/ 结点/ 的/ 所有/ 路径/ 中/ 包含/ 结点/ ni/ 径数/ RLPN/ (/ Root/ -/ LeafPathNumber/ )/ ,/ 用/ Np/ (/ ni/ 表示/ ./ 性质/ 3/ ./ 结点/ ni/ 路径/ 数/ 与其/ 叶子/ 路径/ 数之积/ ,/ 即/ 性质/ 4/ ./ 位置/ i/ 的/ 位置/ 相关/ 数是/ 网树中/ 结点/ 名称/ 是/ i/ 的/ 结点/ 的/ 树根/ -/ 叶子/ 路径/ 数/ 之/ 和/ ,/ 即/ 这里/ m/ 是/ 网树/ 的/ 深度/ ./ 定义/ 17/ ./ 位置/ i/ 在/ 集合/ D/ 的/ 共同/ 祖先/ 集中/ 的/ 所有/ 树根/ 路径/ 数/ 称为/ 位置/ i/ 在/ 集合/ D/ 的/ 路径/ 分支/ 数/ ,/ 用/ pb/ (/ i/ ,/ D/ )/ 来/ 表示/ ./ 性质/ 5/ ./ 位置/ i/ 在/ 集合/ D/ 的/ 路径/ 分支/ 数是/ 共同/ 祖先/ 集/ C/ (/ D/ )/ 中/ 结点/ 名称/ 是/ i/ 的/ 结点/ 的/ 树根/ 路径/ 数/ 之/ 和/ ,/ 即/ 这里/ l/ 是/ 共同/ 祖先/ 集/ 的/ 深度/ ./ 为了/ 解决/ MPMGOOC/ 问题/ 的/ 全局/ 约束/ ,/ 本文/ 定义/ 了/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ 的/ 概念/ ./ 定义/ 18/ ./ 一个/ 结点/ 可以/ 抵达/ 的/ 最小/ 根/ 结点/ 名称/ 称为/ 该/ 结点/ 的/ 最小/ 根/ ;/ 其/ 可以/ 抵达/ 的/ 最大/ 根/ 结点/ 名称/ 称为/ 该/ 结点/ 的/ 最大/ 根/ ./ 一个/ 网/ 树根/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根都/ 是/ 其/ 自身/ ./ 性质/ 6/ ./ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ 分别/ 是/ 其/ 所有/ 双亲/ 结点/ 的/ 最小/ 根/ 集合/ 中/ 的/ 最小值/ 和/ 最大/ 根/ 集合/ 中/ 的/ 最大值/ ./ 亲/ 结点/ 称为/ 该/ 结点/ 的/ 最右/ 双亲/ 结点/ ./ 定义/ 19/ ./ 结点/ 的/ 所有/ 双亲/ 结点/ 中/ 最后/ 一个双/ 图/ 1/ 给出/ 了/ 一棵/ 网树/ ./ 在/ 这棵网/ 树上/ ,/ 有/ 一些/ 结点/ 名称/ 多次/ 出现/ ./ 例如/ 结点/ 3/ 既/ 在/ 第/ 1/ 层上/ 出现/ 又/ Page5/ 在/ 第/ 2/ 层中/ 出现/ ./ 本文/ 采用/ n31/ 和/ n32/ 来/ 分别/ 描述/ 第/ 1/ 层/ 和/ 第/ 2/ 层/ 的/ 结点/ 3/ ./ 结点/ n11/ 、/ n21/ 和/ n31/ 是/ 图/ 1/ 中网/ 树/ 的/ 3/ 个根/ 结点/ ;/ n22/ 、/ n53/ 和/ n63/ 是/ 网树/ 的/ 3/ 个/ 叶子/ 结点/ ./ 结点/ n32/ 有/ 两个/ 双亲/ 结点/ ,/ 分别/ 是/ n11/ 和/ n21/ ./ 网树中/ ,/ 每条/ 边/ 具有/ “/ 双亲/ -/ 孩子/ 关系/ ”/ 或/ “/ 孩子/ -/ 双亲/ 关系/ ”/ 的/ 标签/ ./ 从/ 其中/ 任何/ 一种/ 边/ 标签/ 看/ 网树/ ,/ 网树/ 都/ 是/ 一种/ 有/ 向/ 无/ 环图/ ,/ 因此/ 网树/ 是/ 一种/ 具有/ 边/ 标签/ 的/ 有/ 向/ 无/ 环图/ ./ 如果/ 不/ 考虑/ 边/ 标签/ ,/ 图/ 1/ 中网/ 树/ 将/ 有/ 一个/ 环路/ {/ n21/ ,/ n32/ ,/ n63/ ,/ n42/ ,/ n21/ }/ ./ 网树/ 的/ 另外/ 一个/ 特征/ 是从/ 一个/ 结点/ 到达/ 网树/ 的/ 一个/ 根/ 结点/ 的/ 路径/ 数/ 可以/ 不/ 唯一/ ./ 例如/ 图/ 1/ 中/ ,/ 叶子/ 结点/ n63/ 访问/ 根/ 结点/ n21/ 有/ 两条/ 不同/ 的/ 路径/ ,/ 分别/ 为/ {/ n21/ ,/ n32/ ,/ n63/ }/ 和/ {/ n21/ ,/ n42/ ,/ n63/ }/ ./ 在/ 图/ 1/ 中/ ,/ 结点/ n63/ 的/ 祖先/ 集/ (/ A/ (/ n63/ )/ )/ 为/ {/ n11/ ,/ n21/ ,/ n31/ ,/ n32/ ,/ n42/ ,/ n63/ }/ ./ 集合/ {/ n53/ ,/ n63/ }/ 的/ 共同/ 祖先/ 集是/ {/ n11/ ,/ n21/ ,/ n32/ }/ ./ 结点/ n32/ 的/ 树根/ 路径/ 数/ Nr/ (/ n32/ )/ 为/ 2/ ,/ 因为/ 结点/ n32/ 有/ 两个/ 双亲/ 结点/ n11/ 和/ n21/ 且/ Nr/ (/ n11/ )/ =/ Nr/ (/ n21/ )/ =/ 1/ ./ Nl/ (/ n32/ )/ =/ 2/ ,/ 因为/ 结点/ n32/ 有/ 两个/ 孩子/ 结点/ n53/ 和/ n63/ 且/ Nl/ (/ n53/ )/ =/ Nl/ (/ n63/ )/ =/ 1/ ./ Nl/ (/ n22/ )/ =/ 0/ ,/ 因为/ 结点/ n22/ 不能到达/ 第/ 3/ 层/ 结点/ ./ Np/ (/ n32/ )/ =/ Nr/ (/ n32/ )/ ×/ Nl/ (/ n32/ )/ =/ 4/ ,/ 因为/ 图/ 1/ 的/ 网树中/ ,/ 有/ 4/ 条/ 不同/ 的/ 树根/ -/ 叶子/ 路径/ 包含/ 结点/ n32/ ,/ 即/ {/ n11/ ,/ n32/ ,/ n53/ }/ ,/ {/ n11/ ,/ n32/ ,/ n63/ }/ ,/ {/ n21/ ,/ n32/ ,/ n53/ }/ 和/ {/ n21/ ,/ n32/ ,/ n63/ }/ ./ 同理/ ,/ Np/ (/ n22/ )/ =/ Nr/ (/ n22/ )/ ×/ Nl/ (/ n22/ )/ =/ 0/ ,/ 因为/ Nl/ (/ n22/ )/ =/ 0/ ./ 依据/ 性质/ 4/ 可以/ 计算/ ,/ 包含/ 3/ 的/ 位置/ 相关/ 数/ RP/ (/ 3/ )/ =/ Np/ (/ n31/ )/ +/ Np/ (/ n32/ )/ =/ 5/ ./ pb/ (/ 3/ ,/ {/ n63/ }/ )/ =/ Nr/ (/ n31/ )/ +/ Nr/ (/ n32/ )/ =/ 3/ ,/ 因为/ 结点/ 名称/ 为/ 3/ 的/ 结点/ 在/ 集合/ {/ n63/ }/ 的/ 共同/ 祖先/ 集中/ 出现/ 两次/ ;/ pb/ (/ 2/ ,/ {/ n63/ }/ )/ =/ Nr/ (/ n21/ )/ =/ 1/ ,/ 因为/ 结点/ 名称/ 为/ 2/ 的/ 结点/ 在/ 集合/ {/ n63/ }/ 的/ 共同/ 祖先/ 集中/ 仅/ 出现/ 一次/ ;/ 结点/ n63/ 的/ 最小/ 根为/ 1/ ,/ 因为/ 结点/ n63/ 有/ 两个/ 双亲/ 结点/ n32/ 和/ n42/ 且/ 它们/ 的/ 最小/ 根/ 分别/ 为/ 1/ 和/ 2/ ;/ 结点/ n63/ 的/ 最大/ 根是/ 3/ ;/ 结点/ n63/ 的/ 最右/ 双亲/ 结点/ 是/ 结点/ n42/ ./ 4/ 算法/ 设计/ 为了/ 求解/ MPMGOOC/ 问题/ ,/ 一个/ 合理/ 的/ 启发式/ 策略/ 是/ 每次/ 选择/ 出现/ 相关/ 数较/ 小/ 的/ 出现/ B/ 作为/ 结果/ ./ 而/ 为了/ 找到/ 这个/ 出现/ B/ ,/ 第/ 2/ 个/ 合理/ 的/ 启发式/ 策略/ 是/ 每次/ 选择/ 新增/ 数较/ 小/ 的/ 点/ 以便/ 形成/ 出现/ B/ ./ 而/ 每次/ 查找/ 并/ 计算/ 新增/ 数较/ 小/ 的/ 点/ 的/ 时间/ 复杂度/ 较/ 高/ ,/ 第/ 3/ 个/ 启发式/ 策略/ 是/ 用/ 位置/ 相关/ 数较/ 小/ 的/ 点/ 来/ 替代/ 新增/ 数较/ 小/ 的/ 点/ ./ 本文/ 利用/ 每个/ 结点/ 的/ 树根/ 路径/ 数/ RPN/ 、/ 叶子/ 路径/ 数/ LPN/ 及/ 树根/ -/ 叶子/ 路径/ 数/ RLPN/ 等/ 网树/ 的/ 特殊/ 概念/ 及其/ 性质/ 实现/ 对/ 位置/ 相关/ 数/ 的/ 计算/ ./ 本文/ 还/ 利用/ 了/ 网树/ 的/ 最大/ 根/ 和/ 最小/ 根/ 的/ 概念/ 与/ 性质/ ,/ 对/ MPMGOOC/ 问题/ 的/ 全局/ 约束条件/ 进行/ 考虑/ ./ 这样/ 将/ MPMGOOC/ 问题/ 等价/ 地/ 转换/ 为/ 一棵/ 网树/ ,/ 并/ 在/ 此基础/ 上/ 设计/ 出/ SGSP/ 策略/ ,/ 实现/ 了/ 计算/ 一个/ 出现/ B1/ ./ 因此/ 在/ SGSP/ 策略/ 中/ 应用/ 了/ 第/ 2/ 和/ 第/ 3/ 个/ 启发式/ 策略/ ./ 此外/ ,/ 本文/ 还/ 利用/ 最右/ 双亲/ 结点/ 、/ 最小/ 根/ 和/ 最大/ 根等/ 概念设计/ 了/ SRMP/ 策略/ ,/ 实现/ 了/ 求解/ 一个/ 出现/ B2/ ./ SBO/ 算法/ 是/ 择优/ 使用/ B1/ 或/ B2/ ,/ 进而/ 进一步/ 实现/ 每次/ 选择/ 出现/ 相关/ 数较/ 小/ 的/ 出现/ 这个/ 启发式/ 策略/ ./ 4.1/ 提出/ 算法/ 4.1/ ./ 1SBO/ 算法/ SBO/ 算法/ 的/ 第/ 1/ 步是/ 将/ 模式匹配/ 问题/ 转化/ 为/ 一棵/ 网树/ ,/ 即/ 依据/ P/ 和/ S/ 创建/ 一棵/ 网树/ [/ 14/ ]/ ./ 当/ 接收/ 一个/ 字符/ si/ (/ 0/ / i/ </ n/ )/ ,/ 检查/ si/ 是否/ 满足/ 如下/ 3/ 条/ 规则/ ,/ 如果/ 满足/ 相应/ 规则/ ,/ 则/ 按照/ 对应/ 规则/ 创建/ 一个/ 结点/ 或/ 一条/ 边/ ,/ 具体/ 如下/ ./ 规则/ 1/ ./ 如果/ si/ =/ p0/ ,/ 则/ 在/ 第/ 1/ 层/ 创建/ 结点/ ni1/ ;/ 规则/ 2/ ./ 如果/ si/ =/ pj/ 且/ i/ 与/ 第/ j/ 层/ 某个/ 结点/ j/ -/ 1/ 的/ 距离/ 满足/ 局部/ 约束条件/ (/ minj/ -/ 1/ / i/ -/ e/ -/ 1/ / nemaxj/ -/ 1/ )/ ,/ 则/ 在/ 第/ j/ 层/ 创建/ 结点/ ni/ 新建/ 结点/ ni/ 亲/ 关系/ ”/ ;/ 规则/ 3/ ./ 如果/ 结点/ ni/ 局部/ 约束条件/ (/ minj/ -/ 1/ / i/ -/ q/ -/ 1/ / maxj/ -/ 1/ )/ ,/ 则/ 可以/ 在/ 这/ 两个/ 结点/ 之间/ 建立/ “/ 双亲/ -/ 孩子/ 关系/ ”/ 和/ “/ 孩子/ -/ 双亲/ 关系/ ”/ ./ SBO/ 算法/ 的/ 第/ 2/ 步是/ 依据/ 定义/ 18/ 和/ 性质/ 6/ 计算/ 每个/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ ./ 之后/ ,/ SBO/ 算法/ 在/ 该/ 网树下/ 解决/ MPMGOOC/ 问题/ ,/ 具体/ 方案/ 如下/ :/ 如果/ 出现/ B/ 的/ 相关/ 出现/ 数越/ 小/ ,/ 则/ 出现/ B/ 越有/ 可能/ 是/ 一个/ 最优/ 出现/ ./ 为了/ 找到/ 相关/ 出现/ 数较/ 小/ 的/ 出现/ ,/ SBO/ 算法/ 从/ 网树/ 最后/ 一个/ 叶子/ 结点/ 开始/ 依次/ 向前/ 查找/ 包含/ 该/ 叶子/ 结点/ 的/ 出现/ ./ 为了/ 找到/ 局部/ 最优/ 解/ ,/ SBO/ 算法/ 采用/ 了/ SGSPPage6/ 和/ SRMP/ 两种/ 策略/ 寻找/ 具有/ 相同/ 叶子/ 结点/ 的/ 两个/ 出现/ ,/ 并/ 在/ 两个/ 出现/ 中/ 选择/ 相关/ 出现/ 数较/ 小/ 的/ 出现/ 作为/ SBO/ 算法/ 的/ 一个/ 最优/ 出现/ ./ 之后/ 依据/ 定义/ 9/ 重新/ 计算/ 新/ 序列/ 串/ ,/ 并/ 在/ 新/ 序列/ 串中/ 寻找/ 下/ 一个/ 最优/ 出现/ ./ 迭代/ 此/ 过程/ ,/ 直至/ 所有/ 叶子/ 结点/ 都/ 被/ 检测/ 一遍/ 为止/ ./ 因此/ SBO/ 算法/ 给出/ 如下/ ./ 算法/ 1/ ./ SBO/ ./ 输入/ :/ P/ =/ p0/ [/ min0/ ,/ max0/ ]/ p1/ …/ [/ minm/ -/ 2/ ,/ maxm/ -/ 2/ ]/ pm/ -/ 1/ ,/ 输出/ :/ 解/ C1/ ./ 依据/ P/ 和/ S/ 建立/ 一棵/ 网树/ ;/ 2/ ./ 计算/ 每个/ 结点/ 的/ 最小/ 和/ 最大/ 根/ ;/ 3/ ./ fork/ =/ 第/ m/ 层/ 叶子/ 结点/ 数/ downto1step/ -/ 14/ ./ B1/ =/ SGSP/ (/ 第/ k/ 个/ 叶子/ 结点/ )/ ;/ 5/ ./ y1/ =/ RO/ (/ B1/ )/ ;/ 6/ ./ B2/ =/ SRMP/ (/ 第/ k/ 个/ 叶子/ 结点/ )/ ;/ 7/ ./ y2/ =/ RO/ (/ B2/ )/ ;/ 8/ ./ if/ (/ y1/ </ y2/ )/ B/ =/ B1elseB/ =/ B2/ ;/ 9/ ./ C/ =/ C/ ∪/ B/ ;/ 10/ ./ S/ =/ S/ -/ B/ ;/ 11/ ./ 依据/ 新/ 的/ S/ 重新/ 计算/ 各个/ 结点/ 的/ RPN/ ;/ 12/ ./ nextk13/ ./ returnC/ ./ 4.1/ ./ 2SGSP/ 策略/ 为了/ 找到/ 包含/ 第/ m/ 层/ 叶子/ 结点/ f/ 的/ 出现/ B/ ,/ SGSP/ 的/ 核心思想/ 是/ 采用/ 贪婪/ 策略/ 寻找/ 局部/ 最优/ 解/ ,/ 即/ m/ -/ 1/ 次/ 寻找/ 当前/ 结点/ 的/ 近似/ 优化/ 双亲/ 结点/ AOP/ ./ 所谓/ 当前/ 结点/ 的/ AOP/ 是/ 指/ 在/ 满足/ 全局/ 约束/ 的/ 双亲/ 结点/ 中/ 查找/ 位置/ 相关/ 数/ 最小/ 的/ 双亲/ 结点/ 作为/ 当前/ 结点/ 的/ AOP/ ;/ 若/ 两个/ 双亲/ 结点/ 的/ 位置/ 相关/ 数/ 同样/ 小/ ,/ 则/ 在/ 已/ 获得/ 路径/ B/ 的/ 共同/ 祖先/ 集中/ 选择/ 路径/ 分支/ 数/ 最大/ 的/ 双亲/ 结点/ 作为/ 当前/ 结点/ 的/ AOP/ ./ 因此/ SGSP/ 策略/ 可/ 描述/ 为/ :/ 首先/ 计算/ 每个/ 结点/ 的/ RPN/ 、/ LPN/ 和/ RLPN/ ,/ 然后/ 计算/ 每个/ 位置/ 的/ 位置/ 相关/ 数/ ,/ 之后/ SGSP/ 迭代/ m/ -/ 1/ 次/ 寻找/ 当前/ 结点/ 的/ AOP/ ,/ 具体/ 给出/ 如下/ ./ 算法/ 2/ ./ SGSP/ ./ 输入/ :/ 叶子/ 结点/ f/ 输出/ :/ 出现/ B1/ ./ 依据/ 性质/ 1/ 计算/ 每个/ 结点/ 的/ 树根/ 路径/ 数/ ;/ 2/ ./ 依据/ 性质/ 2/ 计算/ 每个/ 结点/ 的/ 叶子/ 路径/ 数/ ;/ 3/ ./ 依据/ 性质/ 3/ 计算/ 每个/ 结点/ 的/ 树根/ -/ 叶子/ 路径/ 数/ ;/ 4/ ./ 依据/ 性质/ 4/ 计算/ 每个/ 位置/ 的/ 位置/ 相关/ 数/ ;/ 5/ ./ B/ [/ m/ -/ 1/ ]/ =/ f/ ;/ 6/ ./ forj/ =/ m/ -/ 2downto0step/ -/ 1do7/ ./ 依据/ 性质/ 5/ 计算/ 每个/ 位置/ x/ 的/ 在/ 已有/ 路径/ B/ 下/ 8/ ./ r/ =/ B/ [/ j/ +/ 1/ ]/ ./ number/ _/ of/ _/ parents/ ;/ 9/ ./ B/ [/ j/ ]/ =/ B/ [/ j/ +/ 1/ ]/ ./ parent/ [/ r/ -/ 1/ ]/ ;/ 10/ ./ fork/ =/ r/ -/ 2downto0step/ -/ 1do11/ ./ ifB/ [/ j/ +/ 1/ ]/ ./ parent/ [/ k/ ]/ 满足/ 全局/ 约束/ then12/ ./ if/ (/ RP/ (/ B/ [/ j/ ]/ )/ >/ RP/ (/ B/ [/ j/ +/ 1/ ]/ ./ parent/ [/ k/ ]/ )/ )/ 13/ ./ if/ (/ (/ RP/ (/ B/ [/ j/ ]/ )/ =/ RP/ (/ B/ [/ j/ +/ 1/ ]/ ./ parent/ [/ k/ ]/ )/ 14/ ./ endif15/ ./ endfor16/ ./ endfor17/ ./ returnB4/ ./ 1.3/ SRMP/ 策略/ 为了/ 找到/ 包含/ 第/ m/ 层/ 叶子/ 结点/ f/ 的/ 出现/ B/ ,/ SRMP/ 算法/ 核心思想/ 是/ 每次/ 迭代/ 过程/ 中/ 都/ 选择/ 满足/ 全局/ 约束/ 的/ 最右/ 双亲/ 结点/ ,/ 具体/ 给出/ 如下/ ./ 算法/ 3/ ./ SRMP/ ./ 输入/ :/ 叶子/ 结点/ f/ 输出/ :/ 一个/ 出现/ B1/ ./ B/ [/ m/ -/ 1/ ]/ =/ f/ ;/ 2/ ./ forj/ =/ m/ -/ 2downto0step/ -/ 1do3/ ./ 迭代/ 查找/ 一个/ 满足/ 全局/ 约束/ 的/ 最右/ 双亲/ 结点/ 作/ 4/ ./ endfor5/ :/ returnB4/ ./ 2/ 复杂性/ 分析/ SBO/ 算法/ 的/ 空间/ 复杂度/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ,/ 因为/ 网树/ 的/ 深度/ 为/ m/ ,/ 网/ 树上/ 每层/ 最多/ 有/ n/ 个/ 结点/ ,/ 每个/ 结点/ 最多/ 有/ m/ 个/ 双亲/ 结点/ ,/ 这里/ m/ 、/ n/ 和/ W/ 分别/ 是/ 模式/ 串/ P/ 和/ 序列/ 串/ S/ 的/ 长度/ 以及/ 模式/ 串/ P/ 的/ 最大/ 间距/ ./ 在/ 讨论/ SBO/ 算法/ 的/ 时间/ 复杂度/ 之前/ 首先/ 讨论/ SGSP/ 和/ SRMP/ 策略/ 的/ 时间/ 复杂度/ ./ 易知/ 策略/ SRMP/ 的/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ m/ )/ ./ 而/ SGSP/ 的/ 时间/ 复杂度/ 分析/ 如下/ :/ SGSP/ 的/ 第/ 1/ 行/ 和/ 第/ 2/ 行/ (/ 为/ 每个/ 结点/ 计算/ RPN/ 和/ LPN/ )/ 的/ 时间/ 复杂度/ 都/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ,/ 由于/ 每个/ 双亲/ -/ 孩子/ 关系/ 都/ 需要/ 考虑/ ,/ 而/ 按照/ 算法/ 的/ 空间/ 复杂度/ 分析/ 可知/ 网树/ 最/ 多/ 有/ W/ ×/ m/ ×/ n/ 个/ 双亲/ -/ 孩子/ 关系/ ;/ SGSP/ 的/ 第/ 3/ 行/ 和/ 第/ 4/ 行/ 的/ 时间/ 复杂度/ 都/ 是/ O/ (/ m/ ×/ n/ )/ ,/ 因为/ 每个/ 结点/ 都/ 需要/ 被/ 计算/ ,/ 而网/ 树上/ 最多/ 有/ m/ ×/ n/ 个/ 结点/ ;/ 第/ 7/ 行/ 的/ 时间/ 复杂度/ 为/ O/ (/ m2/ ×/ W/ )/ ,/ 因为/ 计算/ pb/ (/ x/ ,/ B/ )/ 的/ 时间/ 复杂度/ 是/ B/ 的/ 共同/ 祖先/ 集下/ 结点/ 的/ 数量/ (/ 其为/ O/ (/ m2/ ×/ W/ )/ )/ ,/ 这样/ 第/ 6/ ~/ 16/ 行/ 的/ 时间/ 复杂度/ 为/ O/ (/ m3/ ×/ W/ )/ ./ 故/ SGSP/ 策略/ 的/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ Page7m/ ×/ (/ n/ +/ m2/ )/ )/ ./ SBO/ 算法/ 的/ 时间/ 复杂度/ 分析/ 如下/ :/ 由/ 算法/ 的/ 空间/ 复杂度/ 分析/ 易知/ ,/ SBO/ 算法/ 的/ 第/ 1/ 行/ 和/ 第/ 2/ 行/ 的/ 时间/ 复杂度/ 都/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ;/ 算法/ 的/ 第/ 4/ 行/ 的/ 时间/ 复杂度/ 是/ O/ (/ W/ ×/ m/ ×/ (/ n/ +/ m2/ )/ )/ ;/ 而/ 给定/ 一个/ 出现/ B/ ,/ 计算/ S/ / =/ S/ -/ B/ 的/ 时间/ 复杂度/ 是/ O/ (/ m/ )/ ;/ RO/ (/ B/ )/ 的/ 计算方法/ 采用/ |/ T/ (/ S/ ,/ P/ )/ |/ -/ |/ T/ (/ S/ / ,/ P/ )/ |/ 的/ 方法/ ,/ 因为/ 计算/ |/ T/ (/ S/ ,/ P/ )/ |/ 的/ 时间/ 复杂度/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ,/ 所以/ 计算/ RO/ (/ B/ )/ 的/ 时间/ 复杂度/ 也/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ./ SBO/ 算法/ 第/ 6/ 行/ 的/ 时间/ 复杂度/ 是/ O/ (/ W/ ×/ m/ )/ ;/ 第/ 8/ ~/ 10/ 行/ 的/ 时间/ 复杂度/ 均/ 是/ O/ (/ m/ )/ ,/ 因为/ 模式/ 串/ P/ 的/ 长度/ 为/ m/ ;/ 第/ 11/ 行/ 的/ 时间/ 复杂度/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ ./ 这样/ 算法/ 从/ 第/ 3/ 行到/ 第/ 12/ 行/ 的/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ m/ ×/ (/ n/ +/ m2/ )/ ×/ n/ // m/ )/ =/ O/ (/ W/ ×/ n/ ×/ (/ n/ +/ m2/ )/ )/ ,/ 因为/ 该/ 问题/ 的/ 出现/ 数最多/ 为/ n/ // m/ 个/ ./ 故/ 算法/ SBO/ 的/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ n/ ×/ (/ n/ +/ m2/ )/ )/ ./ 图/ 2/ 实例/ 求解/ 示意图/ 网树/ 第/ 4/ 层/ 的/ 最后/ 叶子/ 结点/ 是/ n74/ ,/ 因此/ SBO/ 算法/ 调用/ SGSP/ 和/ SRMP/ 两种/ 策略/ 来/ 分别/ 计算/ 两个/ 包含/ 结点/ n74/ 的/ 出现/ ./ SGSP/ 策略/ 工作/ 过程/ 如下/ :/ 第/ 1/ 行/ 按照/ 性质/ 1/ 计算/ 每个/ 结点/ 的/ RPN/ 值/ ./ 例如/ Nr/ (/ n32/ )/ 是/ 2/ ,/ 因为/ 结点/ n32/ 有/ 两个/ 双亲/ 结点/ n11/ 和/ n21/ 且/ Nr/ (/ n11/ )/ =/ Nr/ (/ n21/ )/ =/ 1/ ,/ 每个/ 结点/ 的/ RPN/ 值/ 在/ 图/ 2/ (/ b/ )/ 中/ 每个/ 结点/ 的/ 上方/ 给出/ ./ 第/ 2/ 行/ 按照/ 性质/ 2/ 计算/ 4.3/ 运行/ 实例/ 例/ 4/ ./ 给定/ 模式/ 串/ P/ =/ a/ [/ 0/ ,/ 1/ ]/ a/ [/ 0/ ,/ 1/ ]/ a/ [/ 0/ ,/ 1/ ]/ b/ ,/ 序列/ 串/ S/ =/ aaaaaabb/ 以及/ 最小/ 和/ 最大/ 长度/ Minlen/ =/ 4/ ,/ Maxlen/ =/ 7/ ./ 依据/ 网树/ 的/ 创建/ 规则/ ,/ 创建/ 结果/ 如图/ 2/ (/ a/ )/ 所示/ ./ 从图/ 中/ 可以/ 看出/ ,/ 某些/ 位置/ 索引/ 被/ 创建/ 为/ 多个/ 网树/ 结点/ ,/ 例如/ :/ 位置/ 索引/ 2/ 被/ 创建/ 为/ 3/ 个/ 网树/ 结点/ ,/ 分别/ 位于/ 网树/ 的/ 第/ 1/ 、/ 2/ 和/ 3/ 层/ ,/ 因为/ s2/ =/ a/ 可以/ 与/ p0/ =/ a/ ,/ p1/ =/ a/ 和/ p2/ =/ a/ 分别/ 匹配/ ./ 依据/ 性质/ 6/ 对/ 每个/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ 进行/ 了/ 计算/ ,/ 其/ 结果/ 给出/ 在/ 每个/ 结点/ 的/ 上方/ ./ 使用/ 结点/ 的/ 最小/ 根/ 和/ 最大/ 根/ 可以/ 判断/ 当前/ 结点/ 及其/ 祖先/ 集结/ 点/ 是否/ 满足/ 全局/ 约束/ ./ 例如/ 因为/ 结点/ 7/ 的/ 最小/ 根/ 和/ 最大/ 根/ 分别/ 为/ 1/ 和/ 3/ 且/ 4/ =/ Minlen/ / 7/ -/ 3/ +/ 1/ / 7/ -/ 1/ +/ 1/ / Maxlen/ =/ 7/ ,/ 所以/ 结点/ 7/ 及其/ 祖先/ 集结/ 点/ 都/ 满足/ 全局/ 约束/ ./ 易知本/ 实例/ 中/ 所有/ 匹配/ 都/ 满足/ 全局/ 约束/ ./ 每个/ 结点/ 的/ LPN/ 值/ ./ 例如/ Nl/ (/ n23/ )/ =/ Nl/ (/ n33/ )/ =/ 0/ ,/ 因为/ 结点/ n23/ 和/ n33/ 都/ 不能/ 抵达/ 网树/ 的/ 第/ 4/ 层/ 叶子/ 结点/ ;/ Nl/ (/ n32/ )/ =/ 3/ ,/ 因为/ 结点/ n32/ 有/ 两个/ 孩子/ 结点/ n43/ 和/ n53/ 且/ Nl/ (/ n43/ )/ =/ 1/ ,/ Nl/ (/ n53/ )/ =/ 2/ ,/ 每个/ 结点/ 的/ LPN/ 值/ 在/ 图/ 2/ (/ b/ )/ 中/ 每个/ 结点/ 的/ 右边/ 给出/ ./ 第/ 3/ 行/ 按照/ 性质/ 3/ 计算/ 每个/ 结点/ 的/ RLPN/ 值/ ./ 例如/ Np/ (/ n32/ )/ =/ Nr/ (/ n32/ )/ ×/ Nl/ (/ n32/ )/ =/ 6/ ,/ 每个/ 结点/ 的/ RLPN/ 值/ 在/ 图/ 2/ (/ b/ )/ 中/ 每个/ Page8/ 结点/ 的/ 左边/ 给出/ ./ 第/ 4/ 行/ 按照/ 性质/ 4/ 计算/ 每个/ 位置/ 的/ 位置/ 相关/ 数/ ./ 例如/ RP/ (/ 2/ )/ =/ NP/ (/ n21/ )/ +/ NP/ (/ n22/ )/ +/ NP/ (/ n23/ )/ =/ 7/ ;/ 同理/ RP/ (/ 0/ )/ =/ 1/ ,/ RP/ (/ 1/ )/ =/ 3/ ,/ RP/ (/ 3/ )/ =/ 8/ ,/ RP/ (/ 4/ )/ =/ 8/ ,/ RP/ (/ 5/ )/ =/ 8/ ,/ RP/ (/ 6/ )/ =/ 8/ 且/ RP/ (/ 7/ )/ =/ 4/ ./ 第/ 6/ ~/ 16/ 行是/ 迭代/ 寻找/ 一个/ 包含/ 叶子/ 结点/ n74/ 的/ 出现/ B/ ./ SGSP/ 首先/ 找/ 结点/ n74/ 的/ 近似/ 优化/ 双亲/ 结点/ AOP/ ,/ 结点/ n53/ 是/ 结点/ n74/ 的/ AOP/ ,/ 因为/ 结点/ n74/ 只有/ 一个/ 双亲/ 结点/ n53/ ./ 接下来/ 寻找/ 结点/ n53/ 的/ AOP/ ,/ 从/ 结点/ n53/ 的/ 双亲/ 结点/ 中/ 选择/ 位置/ 相关/ 数/ 最小/ 的/ 结点/ 作为/ 其/ AOP/ ,/ 结点/ n53/ 有/ 两个/ 双亲/ 结点/ ,/ 分别/ 是/ 结点/ n32/ 和/ n42/ 且/ RP/ (/ 3/ )/ =/ RP/ (/ 4/ )/ =/ 8/ ./ 在/ 这种/ 情况/ 下/ ,/ 需要/ 比较/ 位置/ 3/ 和/ 4/ 在/ 结点/ 集/ {/ n53/ ,/ n74/ }/ 的/ 共同/ 祖先/ 集中/ 的/ 路径/ 分支/ 数/ ,/ 即/ pb/ (/ 3/ ,/ {/ n53/ ,/ n74/ }/ )/ 和/ pb/ (/ 4/ ,/ {/ n53/ ,/ n74/ }/ )/ ./ 图/ 2/ (/ c/ )/ 给出/ 了/ 结点/ 集/ {/ n53/ ,/ n74/ }/ 的/ 共同/ 祖先/ 集/ ,/ 由于/ pb/ (/ 3/ ,/ {/ n53/ ,/ n74/ }/ )/ =/ Nr/ (/ n32/ )/ +/ Nr/ (/ n31/ )/ =/ 3/ 且/ pb/ (/ 4/ ,/ {/ n53/ ,/ n74/ }/ )/ =/ Nr/ (/ n42/ )/ =/ 2/ ,/ 这样/ 结点/ n32/ 被/ 看作/ 是/ 结点/ n53/ 的/ AOP/ ,/ 因为/ SGSP/ 策略/ 选择/ 路径/ 分支/ 数/ 较大/ 的/ 双亲/ 结点/ 作为/ 当前/ 结点/ 的/ AOP/ 且/ I/ (/ 3/ ,/ {/ n53/ ,/ n74/ }/ )/ </ I/ (/ 4/ ,/ {/ n53/ ,/ n74/ }/ )/ ./ 最后/ SGSP/ 计算/ 结点/ n32/ 的/ AOP/ ,/ 结点/ n32/ 有/ 两个/ 双亲/ 结点/ n11/ 和/ n21/ ./ 结点/ n32/ 的/ AOP/ 是/ 结点/ n11/ 因为/ RP/ (/ 1/ )/ =/ 3/ </ RP/ (/ 2/ )/ =/ 7/ ./ 因此/ SGSP/ 策略/ 计算结果/ 为/ 〈/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 〉/ ./ 依据/ SRMP/ 策略/ ,/ 当/ 叶子/ 结点/ n74/ 给定/ 后/ ,/ 容易/ 找到/ 结点/ n53/ 是/ 结点/ n74/ 的/ 最右/ 双亲/ 结点/ ;/ 而/ 结点/ n42/ 是/ 结点/ n53/ 的/ 最右/ 双亲/ 结点/ ;/ 而/ 结点/ n31/ 是/ 结点/ n42/ 的/ 最右/ 双亲/ 结点/ ./ 因此/ SRMP/ 策略/ 计算结果/ 为/ 〈/ 3/ ,/ 4/ ,/ 5/ ,/ 7/ 〉/ ./ SBO/ 算法/ 选择/ SGSP/ 和/ SRMP/ 策略/ 的/ 结果/ 中/ 相关/ 出现/ 数较/ 小/ 的/ 出现/ 作为/ 算法/ 的/ 一个/ 出现/ ./ 易知/ RO/ (/ 〈/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 〉/ )/ 和/ RO/ (/ 〈/ 3/ ,/ 4/ ,/ 5/ ,/ 7/ 〉/ )/ 分别/ 是/ 7/ 和/ 8/ ,/ 所以/ SBO/ 算法/ 选择/ 〈/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 〉/ 作为/ 算法/ 的/ 一个/ 出现/ ./ 在/ 出现/ 〈/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 〉/ 不再/ 被/ 使用/ 的/ 情况/ 下/ ,/ 新/ 序列/ 串为/ aXaXaXbX/ ./ SBO/ 算法/ 的/ 第/ 11/ 行/ 重新/ 计算/ 了/ 在/ 新/ 序列/ 串下/ 各个/ 结点/ 的/ RPN/ ./ 图/ 2/ (/ d/ )/ 中/ 给出/ 了/ 在/ 新/ 序列/ 串下/ 的/ 网树/ ,/ 此时/ SBO/ 算法/ 的/ 结果/ 为/ 〈/ 0/ ,/ 2/ ,/ 4/ ,/ 6/ 〉/ ./ 故/ SBO/ 算法/ 针对/ 本/ 问题/ 找到/ 的/ 解为/ 〈/ 0/ ,/ 2/ ,/ 4/ ,/ 6/ 〉/ 和/ 〈/ 1/ ,/ 3/ ,/ 5/ ,/ 7/ 〉/ ./ 5/ 实验/ 结果/ 与/ 分析/ 5.1/ 实验/ 结果/ 本/ 节/ 采用/ 真实/ 生物/ 数据/ 用来/ 对比/ SAIL/ 算法/ [/ 13/ ]/ 和/ SBO/ 算法/ 的/ 性能/ ./ 此外/ ,/ 本文/ 还/ 将/ SGSP/ 和/ SRMP/ 两种/ 策略/ 分别/ 形成/ 了/ 两个/ 可以/ 单独/ 计算/ MPMGOOC/ 问题/ 的/ 算法/ ,/ 并/ 分别/ 命名/ 为/ 贪婪/ 搜索/ 双亲/ 算法/ AGSP/ (/ AlgorithmofGreedySearchParent/ )/ 和/ 最右/ 双亲/ 算法/ ARMP/ (/ AlgorithmofRightMostParent/ )/ ./ 所有/ 4/ 种/ 算法/ 的/ 源代码/ 已/ 全部/ 公开/ ①/ ./ 实验/ 运行/ 的/ 软硬件/ 环境/ 为/ :/ 酷睿/ 2/ 双核/ T7100/ 、/ 主频/ 1.80/ GHZ/ 、/ 内存/ 1.0/ GB/ 、/ WindowsXPSP2/ 操作系统/ 的/ 笔记本/ ./ 猪/ 流感/ H1N1/ 病毒/ 在/ 2009/ 年/ 大/ 流行/ ,/ 其/ 病毒/ 的/ DNA/ 序列/ 可/ 在/ 美国/ 国家/ 生物/ 计算/ 信息中心/ 的/ 网上/ 下载/ ②/ ./ 该/ 病毒/ 有/ 很多/ 候选/ 序列/ ,/ 本文/ 选择/ 于/ 2010/ 年/ 3/ 月/ 30/ 日/ 公布/ 的/ 一个/ 结果/ (/ A/ // Managua/ // 2093.01/ // 2009/ (/ H1N1/ )/ )/ 中/ 的/ 全部/ 8/ 个/ 片段/ ③/ 作为/ 测试/ 序列/ (/ 见表/ 1/ )/ ./ 序号/ 片段/ 名称/ S1Segment1CY0585632286S2Segment2CY0585622299S3Segment3CY0585612169S4Segment4CY0585561720S5Segment5CY0585591516S6Segment6CY0585581418S7Segment7CY058557982S8Segment8CY058560844Min/ 等/ 人/ [/ 12/ ]/ 在/ 其/ 研究/ 工作/ 中/ 给出/ 了/ 一些/ 模式/ 串/ ,/ 由于/ 其中/ P5/ 模式/ 串/ 不能/ 在/ DNA/ 序列/ 中/ 应用/ ,/ 所以/ 本文/ 选择/ 其余/ 的/ 4/ 个/ 模式/ 串/ (/ P1/ ~/ P4/ )/ 作为/ 本文/ 的/ 部分/ 测试/ 模式/ 串/ ./ 此外/ 本文/ 又/ 另外/ 构造/ 了/ 5/ 个/ 新/ 的/ 模式/ 串/ ,/ 表/ 2/ 给出/ 了/ 本文/ 的/ 全部/ 9/ 种/ 模式/ 串/ ./ 序号/ P1a/ [/ 0/ ,/ 3/ ]/ t/ [/ 0/ ,/ 3/ ]/ a/ [/ 0/ ,/ 3/ ]/ t/ [/ 0/ ,/ 3/ ]/ a/ [/ 0/ ,/ 3/ ]/ t/ [/ 0/ ,/ 3/ ]/ P2g/ [/ 1/ ,/ 5/ ]/ t/ [/ 0/ ,/ 6/ ]/ a/ [/ 2/ ,/ 7/ ]/ g/ [/ 3/ ,/ 9/ ]/ t/ [/ 2/ ,/ 5/ ]/ a/ [/ 4/ ,/ 9/ ]/ P3g/ [/ 1/ ,/ 9/ ]/ t/ [/ 1/ ,/ 9/ ]/ a/ [/ 1/ ,/ 9/ ]/ g/ [/ 1/ ,/ 9/ ]/ t/ [/ 1/ ,/ 9/ ]/ a/ [/ 1/ ,/ 9/ ]/ P4g/ [/ 1/ ,/ 5/ ]/ t/ [/ 0/ ,/ 6/ ]/ a/ [/ 2/ ,/ 7/ ]/ g/ [/ 3/ ,/ 9/ ]/ t/ [/ 2/ ,/ 5/ ]/ a/ [/ 4/ ,/ 9/ ]/ P5a/ [/ 0/ ,/ 10/ ]/ a/ [/ 0/ ,/ 10/ ]/ t/ [/ 0/ ,/ 10/ ]/ c/ [/ 0/ ,/ 10/ ]/ g/ [/ 0/ ,/ 10/ ]/ g656P6a/ [/ 0/ ,/ 5/ ]/ t/ [/ 0/ ,/ 7/ ]/ c/ [/ 0/ ,/ 9/ ]/ g/ [/ 0/ ,/ 11/ ]/ gP7a/ [/ 0/ ,/ 5/ ]/ t/ [/ 0/ ,/ 7/ ]/ c/ [/ 0/ ,/ 6/ ]/ g/ [/ 0/ ,/ 8/ ]/ t/ [/ 0/ ,/ 7/ ]/ c/ [/ 0/ ,/ 9/ ]/ g749P8a/ [/ 5/ ,/ 6/ ]/ c/ [/ 4/ ,/ 7/ ]/ g/ [/ 3/ ,/ 8/ ]/ t/ [/ 2/ ,/ 8/ ]/ a/ [/ 1/ ,/ 7/ ]/ c/ [/ 0/ ,/ 9/ ]/ g2252P9c/ [/ 0/ ,/ 5/ ]/ t/ [/ 0/ ,/ 5/ ]/ g/ [/ 0/ ,/ 5/ ]/ a/ [/ 0/ ,/ 5/ ]/ a/ ①/ ②/ ③/ Page9/ 表/ 3/ 给出/ 了/ 这/ 4/ 种/ 算法/ 的/ 运行/ 时间/ 复杂度/ ./ 4/ 种/ 算法/ 在/ S2/ 这个/ 最长/ 序列/ 上/ 的/ 全部/ 9/ 种/ 模式/ 下/ 的/ 运行/ 时间/ 对比/ 表/ 以及/ 在/ P1/ 模式/ 下/ 的/ 全部/ 8/ 种/ 序列/ 上/ 的/ 运行/ 时间/ 对比/ 表/ 分别/ 见表/ 4/ 和表/ 5/ ./ 算法/ 名称/ SAIL/ [/ 13/ ]/ ARMP/ 注/ :/ ①/ 文献/ [/ 13/ ]/ 给出/ SAIL/ 算法/ 时间/ 复杂度/ 为/ O/ (/ n/ +/ klmW/ )/ ,/ k/ 和/ l/ 分别/ 为/ pm/ -/ 1/ 在/ S/ 中/ 出现/ 的/ 频度/ 和/ 出现/ 的/ 最大/ 跨度/ ./ 由于/ k/ 的/ 数量级/ 为/ O/ (/ n/ )/ ,/ l/ 的/ 数量级/ 为/ O/ (/ W/ ×/ m/ )/ ,/ 因此/ SAIL/ 算法/ 时间/ 复杂度/ 可以/ 描述/ 为/ O/ (/ W2/ ×/ n/ ×/ m2/ )/ ./ ②/ 尽管/ SRMP/ 策略/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ m/ )/ ,/ 但是/ 在/ 形成/ ARMP/ 算法/ 后/ ,/ 在/ 每次/ 求解/ 一个/ 出现/ 前/ ,/ 需要/ 执行/ 依据/ 新/ 的/ S/ 重新/ 计算/ 各个/ 结点/ 的/ RPN/ 操作/ ,/ 所以/ ARMP/ 算法/ 时间/ 复杂度/ 为/ O/ (/ W/ ×/ n2/ )/ ./ 表/ 4S2/ 序列/ 上/ 的/ 全部/ 9/ 种/ 模式/ 下/ 的/ 运行/ 时间/ 算法/ 名称/ SAIL474763473116323116ARMP47297609437735656344234562AGSP47438875563844735421265656SBO61468922594969797469282687/ 表/ 5P1/ 模式/ 下/ 的/ 全部/ 8/ 种/ 序列/ 上/ 的/ 运行/ 时间/ 算法/ 名称/ SAIL3147313131/ / 16/ / 16/ / 16ARMP6347637963/ / 16/ / 16/ / 16AGSP7847639447/ / 16/ / 16/ / 16SBO7861639463/ / 16/ / 16/ / 16/ ①/ 注/ :/ 当/ 运行/ 时间/ 过/ 短/ 情况/ 下/ ,/ 计算机/ 不能/ 准确/ 报告/ 运行/ 时间/ ,/ 所以/ 本文/ 采用/ “/ / 16/ ”/ 表示/ 运行/ 时间/ 小于/ 或/ 等于/ 16ms/ ./ 这/ 4/ 种/ 算法/ 在/ 全部/ 的/ 72/ 个/ 实例/ 上/ 的/ 测试/ 结果/ 见表/ 6/ ./ 为了/ 直观/ 地/ 显示/ 每个/ 问题/ 的/ 最好/ 解/ ,/ 表/ 6/ 中/ 最好/ 解都/ 采用/ 加粗/ 方式/ 显示/ ./ 模式/ 算法/ 名称/ P1P2P3P4/ 模式/ 算法/ 名称/ P5P6P7P8P95/ ./ 2/ 实验/ 结果/ 分析/ (/ 1/ )/ 在/ 解较/ 少/ 的/ 情况/ 下/ ,/ SAIL/ 算法/ 可以/ 取得/ 较/ 好/ 的/ 性能/ 且/ ARMP/ 、/ AGSP/ 和/ SBO/ 算法/ 的/ 运行/ 时间/ 较/ 短/ ./ 由表/ 6/ 可以/ 看出/ ,/ P1/ 模式/ 在/ 8/ 个/ 测试/ 序列/ 上解/ 较少/ ./ 在/ 此/ 情况/ 下/ ,/ SAIL/ 算法/ 都/ 能够/ 取得/ 最好/ 解/ ;/ 然而/ 当解/ 较/ 多/ 的/ 情况/ 下/ ,/ SAIL/ 算法/ 很难/ 取得/ 最好/ 解/ ./ 尽管/ ARMP/ 、/ AGSP/ 和/ SBO/ 等/ 3/ 种/ 算法/ 时间/ 复杂度/ 较/ 高/ ,/ 但是/ 在/ 解较/ 少/ 的/ 情况/ 下/ ,/ 这/ 3/ 种/ 算法/ 实际/ 运行/ 时间/ 较/ 短/ ;/ 然而/ 当解/ 较/ 多/ 的/ 情况/ 下/ ,/ 这/ 3/ 种/ 算法/ 实际/ 运行/ 时间/ 较长/ 并/ 与/ 算法/ 的/ 时间/ 复杂度/ 相吻合/ ./ 这是/ 由于/ 当解/ 较/ 少/ 的/ 情况/ 下/ ,/ 问题/ 相对/ 较为简单/ ,/ 对应/ 的/ 网/ 树结构/ 也/ 比较简单/ ,/ 这样/ SAIL/ 算法/ 就/ 能够/ 取得/ 最好/ 解/ 并且/ 基于/ 网树/ 的/ 3/ 种/ 算法/ 也/ 能/ 很快/ 找到/ 解/ ./ 因此/ P1/ 模式/ 不/ 具有/ 普遍意义/ ,/ 在/ 后面/ 的/ 讨论/ 中/ ,/ 将/ 忽略/ P1/ 模式/ 下/ 的/ 8/ 个/ 实例/ 的/ 结果/ ./ (/ 2/ )/ SAIL/ 算法/ 不/ 适合/ 求解/ 离线/ MPMGOOC/ 问题/ ./ 表/ 3/ 和表/ 4/ 可以/ 看出/ ,/ SAIL/ 算法/ 的/ 时间/ 复杂度/ 最低/ 且/ SAIL/ 算法/ 的/ 实际/ 求解/ 速度/ 最快/ ,/ 这/ 充分说明/ SAIL/ 算法/ 适用/ 于/ 求解/ 在线/ 问题/ ./ 但是/ 在/ 求解/ 离线/ 问题/ 时/ ,/ SAIL/ 算法/ 解/ 的/ 质量/ 差/ ./ 在/ 64/ 个/ 实例/ 中/ ,/ SAIL/ 算法/ 仅/ 有/ 3/ 次/ 取得/ 了/ 最好/ 解/ ,/ 说明/ SAIL/ 算法/ 在/ 求解/ 复杂/ 的/ 离线/ 问题/ 时较/ 难/ 获得/ 最好/ 解/ ./ 此外/ ,/ SAIL/ 算法/ 解/ 的/ 质量/ 相对/ 较差/ ,/ 例如/ 在/ “/ P8/ -/ S2/ ”/ 实例/ 上/ ,/ SAIL/ 算法/ 的/ 解为/ 66/ ,/ 但是/ 求解/ 到/ 的/ 最好/ 解为/ 78/ ./ 在/ 64/ 个/ 实例/ 中/ ,/ SAIL/ 算法/ 的/ 解/ 与/ 最好/ 解之差/ 大于/ 或/ 等于/ 4/ 的/ 实例/ 共有/ 26/ 个/ ./ 这些/ 都/ 充分/ 地/ 说明/ 了/ SAIL/ 算法/ 解/ 的/ 质量/ 较差/ ,/ 所以/ SAIL/ 算法/ 不适/ Page10/ 合/ 求解/ 离线/ MPMGOOC/ 问题/ ./ (/ 3/ )/ 在/ 运行/ 时间/ 增加/ 不大/ 的/ 情况/ 下/ ,/ SBO/ 算法/ 的/ 质量/ 最好/ ,/ 说明/ 了/ SBO/ 算法/ 可以/ 较/ 好/ 地/ 求解/ 离线/ MPMGOOC/ 问题/ ./ 尽管/ SBO/ 算法/ 中/ 包含/ SGSP/ 和/ SRMP/ 两种/ 策略/ 并/ 择优/ 使用/ 其/ 结果/ ,/ 但是/ 从表/ 4/ 可以/ 看出/ 这样/ 的/ 时间/ 开销/ 并不大/ ./ 而/ 在/ 解/ 的/ 质量/ 方面/ ,/ SBO/ 算法/ 较/ 其它/ 3/ 种/ 算法/ 都/ 有/ 显著/ 提高/ ./ 具体分析/ 如下/ :/ 与/ SAIL/ 算法/ 相比/ ,/ 在/ 64/ 个/ 实例/ 中/ ,/ 有/ 60/ 个/ 实例/ SBO/ 算法/ 的/ 解/ 结果/ 好于/ SAIL/ 算法/ 且/ 其中/ 23/ 个/ 实例/ 两种/ 算法/ 解之差/ 大于/ 或/ 等于/ 4/ ;/ 在/ “/ P3/ -/ S5/ ”/ 实例/ 上/ ,/ SBO/ 算法/ 与/ SAIL/ 算法/ 同时/ 取得/ 了/ 最好/ 解/ ;/ 在/ “/ P3/ -/ S7/ ”/ 、/ “/ P3/ -/ S8/ ”/ 和/ “/ P6/ -/ S4/ ”/ 实例/ 上/ ,/ SBO/ 算法/ 的/ 解较/ SAIL/ 算法/ 的/ 解/ 都/ 只/ 差/ 1/ ./ 此外/ ,/ 在/ 很多/ 实例/ 上/ SBO/ 算法/ 大幅度/ 地/ 提高/ 了/ SAIL/ 解/ 的/ 质量/ ./ 例如/ 在/ 实例/ “/ P8/ -/ S2/ ”/ 上/ ,/ 采用/ SAIL/ 算法/ 的/ 结果/ 仅为/ 66/ ,/ 而/ 采用/ SBO/ 算法/ 的/ 结果/ 为/ 77/ ,/ 提高/ 幅度/ 非常/ 显著/ ./ 这/ 充分/ 地/ 说明/ 了/ SBO/ 算法/ 显著/ 地/ 改善/ 了/ SAIL/ 算法/ 的/ 解/ 的/ 质量/ ./ 与/ ARMP/ 算法/ 相比/ ,/ 有/ 32/ 个/ 实例/ SBO/ 算法/ 的/ 解好/ 于/ ARMP/ 算法/ 且/ 其中/ 有/ 9/ 个/ 实例/ 两种/ 算法/ 解之差/ 大于/ 或/ 等于/ 3/ ;/ 在/ 18/ 个/ 实例/ 上/ SBO/ 算法/ 的/ 解/ 与/ ARMP/ 算法/ 同/ 为/ 最好/ 解/ ;/ 在/ 余下/ 的/ 14/ 个/ 实例/ 中/ ,/ 仅/ 在/ “/ P6/ -/ S4/ ”/ 实例/ 上/ 差距/ 显著/ (/ SBO/ 算法/ 的/ 解为/ 143/ ,/ 而/ ARMP/ 算法/ 的/ 解为/ 147/ )/ ,/ 在/ “/ P4/ -/ S2/ ”/ 实例/ 上/ SBO/ 算法/ 较/ ARMP/ 算法/ 差/ 2/ ,/ 而/ 其余/ 的/ 12/ 个/ 实例/ SBO/ 算法/ 较/ ARMP/ 算法/ 都/ 仅/ 差/ 1/ ./ 这/ 充分/ 地/ 说明/ 了/ SBO/ 算法/ 解/ 的/ 质量/ 好于/ ARMP/ 算法/ ./ 与/ AGSP/ 算法/ 相比/ ,/ 有/ 41/ 个/ 实例/ SBO/ 算法/ 的/ 解好/ 于/ AGSP/ 算法/ 且/ 其中/ 有/ 15/ 个/ 实例/ 两种/ 算法/ 解之差/ 大于/ 或/ 等于/ 3/ ;/ 在/ 21/ 个/ 实例/ 上/ SBO/ 算法/ 的/ 解/ 与/ AGSP/ 算法/ 相同/ ;/ 在/ “/ P3/ -/ S1/ ”/ 和/ “/ P3/ -/ S8/ ”/ 两个/ 实例/ SBO/ 算法/ 的/ 解比/ AGSP/ 算法/ 差/ 1/ ./ 这/ 充分/ 地/ 说明/ 了/ SBO/ 算法/ 解/ 的/ 质量/ 好于/ AGSP/ 算法/ ./ (/ 4/ )/ SBO/ 算法/ 之所以/ 能够/ 取得/ 良好/ 的/ 解/ 是因为/ SBO/ 算法/ 多次/ 运用/ 启发式/ 策略/ ,/ 实现/ 了/ 每次/ 选择/ 出现/ 相关/ 数较/ 小/ 的/ 出现/ 这个/ 启发式/ 策略/ ./ 但是/ 本文/ 注意/ 到/ ,/ 应用/ 这个/ 启发式/ 策略/ 在/ 求解/ MPMGOOC/ 问题/ 时/ ,/ 不/ 一定/ 都/ 能/ 得到/ 最好/ 解/ ./ 实验/ 结果显示/ ,/ SBO/ 算法/ 在/ 16/ 个/ 实例/ 上/ 未能/ 取得/ 最好/ 解/ ./ 因此/ 即使/ 存在/ 第/ 3/ 种/ 策略/ 求解/ 出现/ 并/ 择优/ 使用/ 这/ 3/ 种/ 策略/ 结果/ 的/ 算法/ ,/ 也/ 不能/ 保证/ 其/ 结果/ 一定/ 优于/ SBO/ 算法/ ./ 综上所述/ ,/ 与/ 其它/ 3/ 种/ 算法/ 相比/ ,/ SBO/ 算法/ 的/ 解/ 的/ 质量/ 最好/ 且/ 与/ 基于/ 网树/ 的/ SRMP/ 和/ SGSP/ 两种/ 算法/ 相比/ ,/ 时间/ 开销/ 增加/ 不/ 大/ ,/ 充分说明/ 了/ SBO/ 算法/ 适用/ 于/ 求解/ 离线/ MPMGOOC/ 问题/ ./ 6/ 结论/ 由于/ 网树/ 是/ 一个/ 新/ 的/ 数据结构/ ,/ 其/ 区别/ 于/ 树结构/ 的/ 概念/ 在于/ :/ 一个/ 非根/ 网树/ 结点/ 可以/ 有/ 多个/ 双亲/ 结点/ ./ 因此/ 网树有/ 许多/ 特有/ 概念/ 和/ 性质/ ,/ 如/ 最小/ 根/ 、/ 最大/ 根/ 、/ 树根/ 路径/ 数/ 、/ 叶子/ 路径/ 数/ 、/ 树根/ -/ 叶子/ 路径/ 数/ 、/ 共同/ 祖先/ 集/ 、/ 最右/ 双亲/ 结点/ 等/ 概念/ ./ 为了/ 求解/ MPMGOOC/ 问题/ ,/ 一个/ 合理/ 的/ 启发式/ 策略/ 是/ 每次/ 选择/ 一个/ 出现/ 相关/ 数较/ 小/ 的/ 出现/ B/ 作为/ 结果/ ,/ 而/ 为了/ 找到/ 这个/ 出现/ B/ ,/ 一个/ 合理/ 的/ 启发式/ 策略/ 是/ 选择/ 新增/ 数较/ 小/ 的/ 双亲/ 结点/ 作为/ 当前/ 结点/ 的/ 双亲/ 结点/ ,/ 但是/ 由于/ 计算/ 新增/ 数/ 的/ 时间/ 复杂度/ 较/ 高/ ,/ 所以/ 采用/ 位置/ 相关/ 数/ 最小/ 的/ 双亲/ 结点/ 作为/ 当前/ 结点/ 的/ AOP/ ./ 本文/ 利用/ 了/ 网树/ 的/ 每个/ 结点/ 的/ RPN/ 、/ LPN/ 和/ RLPN/ 等/ 概念/ 和/ 性质/ 对/ 位置/ 相关/ 数/ 进行/ 了/ 计算/ ./ 在/ 此基础/ 上/ ,/ 本文/ 又/ 利用/ 共同/ 祖先/ 集/ 、/ 最小/ 根/ 、/ 最大/ 根/ 、/ 最右/ 双亲/ 结点/ 等/ 概念设计/ 出/ SGSP/ 策略/ 和/ SRMP/ 策略/ 用来/ 计算/ 出现/ ./ 本文/ 提出/ 的/ SBO/ 算法/ 择优/ 地/ 使用/ 这/ 两种/ 策略/ 的/ 结果/ ./ 通过/ 实际/ 的/ 生物医学/ 数据/ 测试表明/ ,/ SBO/ 算法/ 的/ 解/ 的/ 质量/ 明显/ 优于/ AGSP/ 、/ ARMP/ 和/ SAIL/ 等/ 算法/ ,/ 这是/ 由于/ 在/ SBO/ 算法/ 中/ 多次/ 运用/ 了/ 启发式/ 策略/ ./ SBO/ 算法/ 的/ 空间/ 复杂度/ 和/ 时间/ 复杂度/ 分别/ 是/ O/ (/ W/ ×/ m/ ×/ n/ )/ 和/ O/ (/ W/ ×/ n/ ×/ (/ n/ +/ m2/ )/ )/ ,/ 这里/ m/ 、/ n/ 和/ W/ 分别/ 是/ 模式/ 串/ P/ 和/ 序列/ 串/ S/ 的/ 长度/ 以及/ 模式/ 串/ P/ 的/ 最大/ 间距/ ./ 我们/ 相信/ 网树/ 将/ 在/ 更/ 多/ 的/ 领域/ 得到/ 应用/ ,/ 并/ 引起/ 更/ 广泛/ 的/ 理论/ 研究/ ./ 

